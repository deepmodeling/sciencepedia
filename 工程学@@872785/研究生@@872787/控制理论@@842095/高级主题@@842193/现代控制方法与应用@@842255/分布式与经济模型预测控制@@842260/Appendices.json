{"hands_on_practices": [{"introduction": "在分布式模型预测控制中，核心挑战之一是如何协调多个子系统的决策以实现全局最优。对偶分解是一种基于价格的经典方法，它通过引入拉格朗日乘子（即“价格”）来解耦耦合约束。通过这个练习[@problem_id:2701668]，您将亲手计算一次对偶上升迭代，直观地理解价格信号如何引导局部决策，从而为掌握更复杂的分布式算法奠定基础。", "problem": "考虑一个分布式经济模型预测控制 (MPC) 方案中针对两个具有标量输入的子系统的单次协调步骤。在给定的预测步，集中式阶段问题是在共享资源平衡的条件下最小化局部经济成本之和。局部经济阶段成本是严格凸二次型，由 $J_{1}(u_{1})=\\tfrac{1}{2} q_{1} u_{1}^{2}+r_{1} u_{1}$ 和 $J_{2}(u_{2})=\\tfrac{1}{2} q_{2} u_{2}^{2}+r_{2} u_{2}$ 给出，且具有各自的输入约束 $u_{1} \\in [u_{1}^{\\min},u_{1}^{\\max}]$ 和 $u_{2} \\in [u_{2}^{\\min},u_{2}^{\\max}]$。智能体通过资源平衡等式约束 $u_{1}+u_{2}=\\bar{u}$ 相互耦合。\n\n从等式约束凸规划的拉格朗日函数定义以及使用耦合约束残差作为次梯度的对偶函数次梯度上升法出发，执行一次对偶上升迭代，步骤如下：\n- 对于给定的当前价格（对偶变量）$\\lambda_{k}$，通过最小化关于 $u_{1}$ 和 $u_{2}$ 的局部拉格朗日函数并满足各自的箱式约束，来计算局部最优输入。\n- 使用一个恒定的步长 $\\alpha$ 更新价格。\n\n在此步骤中使用以下数据：\n- $q_{1}=2$， $r_{1}=-3$， $u_{1}^{\\min}=0$， $u_{1}^{\\max}=2$。\n- $q_{2}=1$， $r_{2}=2$， $u_{2}^{\\min}=-3$， $u_{2}^{\\max}=1$。\n- 耦合参数 $\\bar{u}=-\\tfrac{3}{2}$。\n- 当前价格 $\\lambda_{k}=\\tfrac{6}{5}$。\n- 步长 $\\alpha=\\tfrac{1}{2}$。\n\n将这一次对偶上升迭代的结果以行向量 $\\big(u_{1,k}^{\\star},\\,u_{2,k}^{\\star},\\,\\lambda_{k+1}\\big)$ 的形式报告。\n\n你的最终答案必须是一个单行矩阵。无需四舍五入，你必须给出精确值（可接受分数形式）。不要包含任何单位。", "solution": "所给问题是一个有效且适定的凸优化练习，具体来说是对偶分解在分布式经济模型预测控制场景中的一个应用。所有必要的参数都已提供，并且问题在科学上是合理的。我们接下来进行求解。\n\n集中式优化问题是在满足局部约束和耦合约束的条件下，最小化总经济成本，即局部成本 $J_{1}(u_{1})$ 和 $J_{2}(u_{2})$ 之和。\n该问题被表述为：\n$$\n\\min_{u_{1}, u_{2}} \\quad J_{1}(u_{1}) + J_{2}(u_{2}) = \\left(\\frac{1}{2} q_{1} u_{1}^{2} + r_{1} u_{1}\\right) + \\left(\\frac{1}{2} q_{2} u_{2}^{2} + r_{2} u_{2}\\right)\n$$\n约束条件为：\n$$\nu_{1} + u_{2} = \\bar{u} \\\\\nu_{1} \\in [u_{1}^{\\min}, u_{1}^{\\max}] \\\\\nu_{2} \\in [u_{2}^{\\min}, u_{2}^{\\max}]\n$$\n这是一个凸优化问题，因为目标函数是严格凸二次函数之和（由于 $q_{1} > 0$ 且 $q_{2} > 0$），并且约束定义了一个凸集。\n\n为了使用对偶分解以分布式方式解决此问题，我们通过引入一个拉格朗日乘子（或称对偶变量）$\\lambda$ 来松弛耦合约束 $u_{1} + u_{2} - \\bar{u} = 0$。拉格朗日函数 $L(u_{1}, u_{2}, \\lambda)$ 为：\n$$\nL(u_{1}, u_{2}, \\lambda) = J_{1}(u_{1}) + J_{2}(u_{2}) + \\lambda(u_{1} + u_{2} - \\bar{u})\n$$\n该拉格朗日函数可以分解为对应于每个子系统的部分：\n$$\nL(u_{1}, u_{2}, \\lambda) = \\left( J_{1}(u_{1}) + \\lambda u_{1} \\right) + \\left( J_{2}(u_{2}) + \\lambda u_{2} \\right) - \\lambda \\bar{u}\n$$\n我们为每个子系统 $i \\in \\{1, 2\\}$ 定义局部拉格朗日函数：\n$$\nL_{i}(u_{i}, \\lambda) = J_{i}(u_{i}) + \\lambda u_{i}\n$$\n对偶上升算法在每次迭代 $k$ 中按以下两个步骤进行：\n$1$. 对于给定的价格 $\\lambda_{k}$，每个子系统独立求解其局部优化问题，以找到最优输入 $u_{1,k}^{\\star}$ 和 $u_{2,k}^{\\star}$：\n$$\nu_{i,k}^{\\star} = \\arg\\min_{u_{i} \\in [u_{i}^{\\min}, u_{i}^{\\max}]} L_{i}(u_{i}, \\lambda_{k})\n$$\n$2$. 使用次梯度上升法更新价格 $\\lambda_{k}$，其中次梯度是松弛耦合约束的残差。更新规则为：\n$$\n\\lambda_{k+1} = \\lambda_{k} + \\alpha (u_{1,k}^{\\star} + u_{2,k}^{\\star} - \\bar{u})\n$$\n其中 $\\alpha > 0$ 是步长。\n\n现在我们使用给定的数据执行一次迭代：\n- $q_{1}=2$, $r_{1}=-3$, $u_{1}^{\\min}=0$, $u_{1}^{\\max}=2$.\n- $q_{2}=1$, $r_{2}=2$, $u_{2}^{\\min}=-3$, $u_{2}^{\\max}=1$.\n- $\\bar{u}=-\\frac{3}{2}$.\n- 初始价格 $\\lambda_{k}=\\frac{6}{5}$.\n- 步长 $\\alpha=\\frac{1}{2}$.\n\n首先，我们求解关于 $u_{1}$ 和 $u_{2}$ 的局部最小化问题。\n对于子系统 1：\n$$\nL_{1}(u_{1}, \\lambda_{k}) = \\frac{1}{2} q_{1} u_{1}^{2} + r_{1} u_{1} + \\lambda_{k} u_{1} = \\frac{1}{2} (2) u_{1}^{2} + (-3) u_{1} + \\frac{6}{5} u_{1} = u_{1}^{2} - \\frac{9}{5} u_{1}\n$$\n为了找到无约束最小值，我们将关于 $u_{1}$ 的导数设为零：\n$$\n\\frac{\\partial L_{1}}{\\partial u_{1}} = 2 u_{1} - \\frac{9}{5} = 0 \\implies u_{1}^{\\text{unc}} = \\frac{9}{10}\n$$\n$u_{1}$ 的局部约束为 $[0, 2]$。由于 $0 \\le \\frac{9}{10} \\le 2$，该无约束最小值是可行的。因此，最优局部输入为：\n$$\nu_{1,k}^{\\star} = \\frac{9}{10}\n$$\n\n对于子系统 2：\n$$\nL_{2}(u_{2}, \\lambda_{k}) = \\frac{1}{2} q_{2} u_{2}^{2} + r_{2} u_{2} + \\lambda_{k} u_{2} = \\frac{1}{2} (1) u_{2}^{2} + (2) u_{2} + \\frac{6}{5} u_{2} = \\frac{1}{2} u_{2}^{2} + \\frac{16}{5} u_{2}\n$$\n为了找到无约束最小值，我们将关于 $u_{2}$ 的导数设为零：\n$$\n\\frac{\\partial L_{2}}{\\partial u_{2}} = u_{2} + \\frac{16}{5} = 0 \\implies u_{2}^{\\text{unc}} = -\\frac{16}{5} = -3.2\n$$\n$u_{2}$ 的局部约束为 $[-3, 1]$。由于 $u_{2}^{\\text{unc}} = -3.2  -3$，凸函数 $L_{2}$ 在该区间上的最小值位于下界。因此，最优局部输入为：\n$$\nu_{2,k}^{\\star} = u_{2}^{\\min} = -3\n$$\n\n接下来，我们更新价格 $\\lambda$。耦合约束的残差为：\n$$\ns_{k} = u_{1,k}^{\\star} + u_{2,k}^{\\star} - \\bar{u} = \\frac{9}{10} + (-3) - \\left(-\\frac{3}{2}\\right) = \\frac{9}{10} - \\frac{30}{10} + \\frac{15}{10} = \\frac{9 - 30 + 15}{10} = -\\frac{6}{10} = -\\frac{3}{5}\n$$\n更新后的价格 $\\lambda_{k+1}$ 计算如下：\n$$\n\\lambda_{k+1} = \\lambda_{k} + \\alpha s_{k} = \\frac{6}{5} + \\frac{1}{2} \\left(-\\frac{3}{5}\\right) = \\frac{6}{5} - \\frac{3}{10} = \\frac{12}{10} - \\frac{3}{10} = \\frac{9}{10}\n$$\n\n这一次对偶上升迭代的结果是行向量 $(u_{1,k}^{\\star}, u_{2,k}^{\\star}, \\lambda_{k+1})$。代入计算出的值，我们得到：\n$$\n\\left( \\frac{9}{10}, -3, \\frac{9}{10} \\right)\n$$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{9}{10}  -3  \\frac{9}{10} \\end{pmatrix}}$$", "id": "2701668"}, {"introduction": "虽然对偶上升法在概念上很直观，但其收敛性有时并不理想。交替方向乘子法 (ADMM) 是一种更强大且在实践中广泛应用的分布式优化算法，它结合了对偶分解和增广拉格朗日方法的优点。本练习[@problem_id:2701685]将引导您完成一次完整的ADMM迭代，并计算评估算法收敛性的关键指标——原始残差和对偶残差，从而深入理解ADMM的运作机制。", "problem": "考虑一个在经济模型预测控制 (eMPC) 中由单步预测范围产生的双智能体资源分配子问题。每个智能体 $i \\in \\{1,2\\}$ 选择一个标量决策变量 $x_i$（局部输入），总资源使用量必须满足一个强制共享容量的线性耦合约束。集中式二次规划问题是在约束条件 $x_1 + x_2 = s$ 下，对 $x_1, x_2$ 最小化函数 $\\frac{1}{2} q_1 x_1^2 + p_1 x_1 + \\frac{1}{2} q_2 x_2^2 + p_2 x_2$，\n其中 $q_1, q_2  0$ 和 $p_1, p_2 \\in \\mathbb{R}$ 分别代表局部的二次和线性经济惩罚，而 $s \\in \\mathbb{R}$ 是总资源设定点。\n\n为模拟分布式模型预测控制 (dMPC)，请对上述问题执行一次（从 $k=0$ 到 $k=1$）缩放交替方向乘子法 (ADMM) 迭代，将线性约束视为 $A x_1 + B x_2 = s$（其中 $A = 1$ 且 $B = 1$），并使用缩放对偶变量 $u$ 和惩罚参数 $\\rho  0$。\n\n使用以下数值数据：\n- $q_1 = 2$, $p_1 = 1$,\n- $q_2 = 4$, $p_2 = -2$,\n- $s = 1$,\n- $\\rho = 1$,\n- 初始值 $x_1^{(0)} = 0$，$x_2^{(0)} = 0.5$，$u^{(0)} = 0$。\n\n在执行这次单次 ADMM 迭代后，计算与 $k=1$ 时的缩放 ADMM 迭代相关的原始残差 $r^{(1)}$ 和对偶残差 $s^{(1)}$。然后，取两个残差的欧几里得范数（对于这些标量，即绝对值）中的较大者。将最终答案四舍五入到四位有效数字。将最终答案表示为一个无单位的标量。", "solution": "该问题的一般形式是在约束 $A x_1 + B x_2 = s$ 下最小化 $f_1(x_1) + f_2(x_2)$，其中 $f_1(x_1) = \\frac{1}{2} q_1 x_1^2 + p_1 x_1$ 且 $f_2(x_2) = \\frac{1}{2} q_2 x_2^2 + p_2 x_2$。\n缩放 ADMM 算法在迭代 $k$ 次时包含以下更新序列：\n1. $x_1^{(k+1)} := \\arg\\min_{x_1} \\left( f_1(x_1) + \\frac{\\rho}{2} \\| A x_1 + B x_2^{(k)} - s + u^{(k)} \\|_2^2 \\right)$\n2. $x_2^{(k+1)} := \\arg\\min_{x_2} \\left( f_2(x_2) + \\frac{\\rho}{2} \\| A x_1^{(k+1)} + B x_2 - s + u^{(k)} \\|_2^2 \\right)$\n3. $u^{(k+1)} := u^{(k)} + A x_1^{(k+1)} + B x_2^{(k+1)} - s$\n\n对于这个具体问题，$A=1$，$B=1$，且所有变量都是标量。更新步骤变为：\n1. $x_1^{(k+1)} := \\arg\\min_{x_1} \\left( \\frac{1}{2} q_1 x_1^2 + p_1 x_1 + \\frac{\\rho}{2} (x_1 + x_2^{(k)} - s + u^{(k)})^2 \\right)$\n2. $x_2^{(k+1)} := \\arg\\min_{x_2} \\left( \\frac{1}{2} q_2 x_2^2 + p_2 x_2 + \\frac{\\rho}{2} (x_1^{(k+1)} + x_2 - s + u^{(k)})^2 \\right)$\n3. $u^{(k+1)} := u^{(k)} + x_1^{(k+1)} + x_2^{(k+1)} - s$\n\n为了找到 $x_1$ 和 $x_2$ 更新的最小值点，我们将相应目标函数的导数设为零。\n对于 $x_1$ 的更新：\n$q_1 x_1 + p_1 + \\rho (x_1 + x_2^{(k)} - s + u^{(k)}) = 0$\n$(q_1 + \\rho) x_1 = -p_1 - \\rho (x_2^{(k)} - s + u^{(k)})$\n$x_1^{(k+1)} = \\frac{-p_1 - \\rho (x_2^{(k)} - s + u^{(k)})}{q_1 + \\rho}$\n\n对于 $x_2$ 的更新：\n$q_2 x_2 + p_2 + \\rho (x_1^{(k+1)} + x_2 - s + u^{(k)}) = 0$\n$(q_2 + \\rho) x_2 = -p_2 - \\rho (x_1^{(k+1)} - s + u^{(k)})$\n$x_2^{(k+1)} = \\frac{-p_2 - \\rho (x_1^{(k+1)} - s + u^{(k)})}{q_2 + \\rho}$\n\n我们现在使用提供的数值数据，执行一次从 $k=0$ 到 $k=1$ 的迭代：\n$q_1 = 2, q_2 = 4, p_1 = 1, p_2 = -2, s = 1, \\rho = 1$。\n初始条件：$x_1^{(0)} = 0, x_2^{(0)} = 0.5, u^{(0)} = 0$。\n\n首先，计算 $x_1^{(1)}$：\n$$x_1^{(1)} = \\frac{-p_1 - \\rho (x_2^{(0)} - s + u^{(0)})}{q_1 + \\rho} = \\frac{-1 - 1 (0.5 - 1 + 0)}{2 + 1} = \\frac{-1 - (-0.5)}{3} = \\frac{-0.5}{3} = -\\frac{1}{6}$$\n\n接下来，使用新计算出的 $x_1^{(1)}$ 计算 $x_2^{(1)}$：\n$$x_2^{(1)} = \\frac{-p_2 - \\rho (x_1^{(1)} - s + u^{(0)})}{q_2 + \\rho} = \\frac{-(-2) - 1 (-\\frac{1}{6} - 1 + 0)}{4 + 1} = \\frac{2 - (-\\frac{7}{6})}{5} = \\frac{2 + \\frac{7}{6}}{5} = \\frac{\\frac{12+7}{6}}{5} = \\frac{19/6}{5} = \\frac{19}{30}$$\n\n最后，计算对偶变量更新 $u^{(1)}$：\n$$u^{(1)} = u^{(0)} + x_1^{(1)} + x_2^{(1)} - s = 0 + (-\\frac{1}{6}) + \\frac{19}{30} - 1 = -\\frac{5}{30} + \\frac{19}{30} - \\frac{30}{30} = \\frac{14 - 30}{30} = -\\frac{16}{30} = -\\frac{8}{15}$$\n\n现在，我们计算在迭代 $k=1$ 时的残差。\n原始残差 $r^{(k+1)}$ 定义为 $A x_1^{(k+1)} + B x_2^{(k+1)} - s$。\n$$r^{(1)} = x_1^{(1)} + x_2^{(1)} - s = -\\frac{1}{6} + \\frac{19}{30} - 1 = -\\frac{5}{30} + \\frac{19}{30} - \\frac{30}{30} = -\\frac{16}{30} = -\\frac{8}{15}$$\n原始残差的欧几里得范数是其绝对值：\n$$\\|r^{(1)}\\| = \\left|-\\frac{8}{15}\\right| = \\frac{8}{15}$$\n\n缩放 ADMM 的对偶残差 $s^{(k+1)}$ 定义为 $\\rho A^T B (x_2^{(k+1)} - x_2^{(k)})$。\n$$s^{(1)} = \\rho A^T B (x_2^{(1)} - x_2^{(0)}) = 1 \\cdot 1 \\cdot 1 \\cdot (\\frac{19}{30} - 0.5) = \\frac{19}{30} - \\frac{1}{2} = \\frac{19}{30} - \\frac{15}{30} = \\frac{4}{30} = \\frac{2}{15}$$\n对偶残差的欧几里得范数是其绝对值：\n$$\\|s^{(1)}\\| = \\left|\\frac{2}{15}\\right| = \\frac{2}{15}$$\n\n最后一步是找出两个残差范数中较大的一个。\n$$\\max(\\|r^{(1)}\\|, \\|s^{(1)}\\|) = \\max\\left(\\frac{8}{15}, \\frac{2}{15}\\right) = \\frac{8}{15}$$\n换算成小数，即为 $\\frac{8}{15} \\approx 0.533333...$。四舍五入到四位有效数字得到 $0.5333$。", "answer": "$$\\boxed{0.5333}$$", "id": "2701685"}, {"introduction": "经济模型预测控制 (eMPC) 的一个核心思想是，最优的长期经济性能未必对应于一个稳态工作点。在许多实际系统中，动态的、周期性的操作模式可能更具经济效益。本练习[@problem_id:2701639]是一个深刻的概念探索，要求您从第一性原理出发，推导出周期性策略优于任何可行稳态的条件，从而揭示eMPC为何以及如何在超越传统设定点跟踪的框架下寻找最优经济效益。", "problem": "考虑一个由状态动力学 $x_{k+1} = a x_{k} + b u_{k}$ 控制的单输入离散时间线性时不变过程，其中 $x_{k} \\in \\mathbb{R}$ 是标量状态，$u_{k} \\in \\mathbb{R}$ 是标量输入，$0  a  1$ 且 $b  0$。运行约束如下：\n- 逐点输入约束 $u_{k} \\in \\{0, u_{\\max}\\}$，其中 $u_{\\max}  0$，\n- 执行器冷却约束：每当 $u_{k} = u_{\\max}$ 时，其后必须跟至少 $m \\in \\mathbb{N}$ 个 $u = 0$ 的连续时间步（即 $u_{k+1} = \\cdots = u_{k+m} = 0$）。\n\n经济阶段成本为 $l(x,u) = c_{u} u - r x$，其中 $c_{u}  0$ 且 $r  0$，一个策略的长期性能通过时间平均成本来评估。当考虑周期控制时，假设过程在其对应的周期轨道上初始化。\n\n从时间平均成本和稳态可行性的定义以及系统动力学出发。仅使用这些定义，从第一性原理推导，在何种条件下以下情况成立：无约束经济最优稳态（即在不强制执行冷却和 $\\{0,u_{\\max}\\}$ 限制的情况下计算出的稳态）在给定约束下是不可行的，但存在一个满足约束条件的周期性输入序列，其实现的长期平均成本严格低于任何可行稳态。\n\n重点关注最快的可容许周期性策略，该策略重复一个由一个输入脉冲 $u_{\\max}$ 和紧随其后的 $m$ 个零组成的循环。计算经济回报系数 $r$ 的唯一临界值 $r^{\\star}$ 的精确解析表达式，使得当 $r  r^{\\star}$ 时，该周期性策略的时间平均成本严格低于任何可行稳态。将最终答案表示为关于 $a$、$b$ 和 $c_{u}$ 的闭式符号表达式。不要对结果进行四舍五入或近似。最终答案必须是无单位的单一解析表达式。", "solution": "问题要求经济回报系数的临界值，记为 $r^{\\star}$，使得对于任何 $r  r^{\\star}$，一个特定的周期性控制策略能产生比任何可行稳态操作都严格更低的时间平均成本。推导必须从第一性原理出发。\n\n首先，我们分析在给定约束下可行的稳态操作。一个稳态 $(x_{ss}, u_{ss})$ 必须满足平衡状态下的系统动力学，$x_{ss} = a x_{ss} + b u_{ss}$，这意味着 $(1-a)x_{ss} = b u_{ss}$。由于 $0  a  1$，我们有 $1-a \\neq 0$，因此稳态由 $x_{ss} = \\frac{b}{1-a} u_{ss}$ 给出。输入 $u_{ss}$ 在所有时间步 $k$ 都必须是常数。对输入的约束是 $u_{k} \\in \\{0, u_{\\max}\\}$ 和一个冷却动态。\n\n对于一个稳态，我们必须从允许的集合中选择一个恒定的输入。两种可能性是 $u_{ss} = 0$ 和 $u_{ss} = u_{\\max}$。\n1.  如果我们选择 $u_{ss} = 0$，那么 $x_{ss} = \\frac{b}{1-a} \\cdot 0 = 0$。输入始终为 $0$，因此冷却约束（仅当 $u_k = u_{\\max}$ 时触发）永远不会被违反。因此，$(x_{ss}, u_{ss}) = (0, 0)$ 是一个可行的稳态。\n2.  如果我们选择 $u_{ss} = u_{\\max}$，这意味着对所有 $k$ 都有 $u_k = u_{\\max}$。然而，冷却约束规定输入 $u_k = u_{\\max}$ 之后必须跟随 $m$ 步零输入，即 $u_{k+1} = 0$。这与稳态要求 $u_{k+1} = u_{\\max}$ 相矛盾。因此，具有 $u_{ss} = u_{\\max}$ 的稳态是不可行的。\n\n唯一的可行稳态是 $(x_{ss}, u_{ss}) = (0, 0)$。该稳态的时间平均成本是恒定的阶段成本 $l(0, 0) = c_u (0) - r (0) = 0$。设其为 $J_{ss}$。所以，$J_{ss} = 0$。\n\n接下来，我们分析指定的周期性策略。该策略的周期为 $N = m+1$ 个时间步。一个周期内的输入序列是 $u_0 = u_{\\max}$ 和对于 $k \\in \\{1, 2, \\dots, m\\}$ 有 $u_k = 0$。根据其构造，这个策略是可容许的，因为 $u_{\\max}$ 的脉冲之后紧跟着 $m$ 个零输入步。\n\n任何策略的时间平均成本由 $J = \\lim_{T \\to \\infty} \\frac{1}{T} \\sum_{k=0}^{T-1} l(x_k, u_k)$ 给出。对于一个周期为 $N$ 且系统在周期轨道上运行的周期性策略，这可以简化为在一个周期内的平均值：\n$$J_{p} = \\frac{1}{N} \\sum_{k=0}^{N-1} l(x_k, u_k) = \\frac{1}{N} \\sum_{k=0}^{N-1} (c_u u_k - r x_k)$$\n这可以用平均输入 $\\bar{u} = \\frac{1}{N} \\sum_{k=0}^{N-1} u_k$ 和平均状态 $\\bar{x} = \\frac{1}{N} \\sum_{k=0}^{N-1} x_k$ 表示为 $J_p = c_u \\bar{u} - r \\bar{x}$。\n\n对于任何周期性轨迹，平均状态和平均输入之间存在一个关键关系。将状态动力学 $x_{k+1} = a x_k + b u_k$ 在一个完整周期内从 $k=0$ 到 $k=N-1$ 求和：\n$$\\sum_{k=0}^{N-1} x_{k+1} = a \\sum_{k=0}^{N-1} x_k + b \\sum_{k=0}^{N-1} u_k$$\n在周期轨道上，$x_N = x_0$。左边的和是 $\\sum_{j=1}^{N} x_j = x_N + \\sum_{j=1}^{N-1} x_j = x_0 + \\sum_{j=1}^{N-1} x_j = \\sum_{k=0}^{N-1} x_k$。\n因此，方程变为：\n$$\\sum_{k=0}^{N-1} x_k = a \\sum_{k=0}^{N-1} x_k + b \\sum_{k=0}^{N-1} u_k$$\n$$(1-a) \\sum_{k=0}^{N-1} x_k = b \\sum_{k=0}^{N-1} u_k$$\n两边同时除以周期 $N$，我们得到平均值之间的关系：\n$$(1-a) \\bar{x} = b \\bar{u} \\implies \\bar{x} = \\frac{b}{1-a} \\bar{u}$$\n这个简洁的结果适用于系统的任何周期轨道。\n\n现在，我们将其代入平均成本 $J_p$ 的表达式中：\n$$J_p = c_u \\bar{u} - r \\left( \\frac{b}{1-a} \\bar{u} \\right) = \\left( c_u - \\frac{rb}{1-a} \\right) \\bar{u}$$\n对于周期为 $N = m+1$ 且输入序列为 $\\{u_{\\max}, 0, \\dots, 0\\}$ 的特定周期性策略，平均输入为：\n$$\\bar{u} = \\frac{1}{m+1} (u_{\\max} + 0 + \\dots + 0) = \\frac{u_{\\max}}{m+1}$$\n因此，该周期性策略的平均成本为：\n$$J_p = \\left( c_u - \\frac{rb}{1-a} \\right) \\frac{u_{\\max}}{m+1}$$\n问题要求的是该周期性策略严格优于任何可行稳态的条件。正如我们所发现的，最优（也是唯一）的可行稳态策略的成本为 $J_{ss} = 0$。因此，条件是 $J_p  J_{ss}$，即 $J_p  0$。\n$$\\left( c_u - \\frac{rb}{1-a} \\right) \\frac{u_{\\max}}{m+1}  0$$\n考虑到 $u_{\\max} > 0$ 且 $m+1 > 0$，表达式的符号完全由括号内的项决定。不等式简化为：\n$$c_u - \\frac{rb}{1-a}  0$$\n我们试图找到关于 $r$ 的条件。整理不等式：\n$$c_u  \\frac{rb}{1-a}$$\n由于 $b > 0$ 且 $1-a > 0$（因为 $0  a  1$），我们可以在不等式两边同乘以 $\\frac{1-a}{b}$ 而不改变不等号的方向：\n$$c_u \\frac{1-a}{b}  r$$\n这个不等式，$r > c_u \\frac{1-a}{b}$，定义了回报系数 $r$ 的范围，在此范围内，周期性策略比零稳态在经济上严格更优。临界值 $r^{\\star}$ 是这种转变发生时的值。\n\n因此，临界值为：\n$$r^{\\star} = c_u \\frac{1-a}{b}$$\n当 $r > r^{\\star}$ 时，周期性策略实现了负的平均成本，使其严格优于零成本的稳态。无约束经济最优稳态（在 $c_u - \\frac{rb}{1-a}  0$ 时会试图通过使用大的 $u$ 来最大化 $x$）确实是不可行的，这符合问题陈述中对 $r > r^{\\star}$ 的要求。", "answer": "$$\\boxed{c_{u} \\frac{1-a}{b}}$$", "id": "2701639"}]}