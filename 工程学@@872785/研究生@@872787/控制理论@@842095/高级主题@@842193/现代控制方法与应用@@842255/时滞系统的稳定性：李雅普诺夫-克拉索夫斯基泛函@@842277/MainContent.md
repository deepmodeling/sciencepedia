## 引言
时滞，即信息或物质的[传输延迟](@entry_id:274283)，是物理、工程、生物和经济系统中普遍存在的现象。从网络通信的延迟到[化学反应](@entry_id:146973)过程的滞后，时滞的存在会极大地改变系统的动态行为，甚至导致原本稳定的系统变得[振荡](@entry_id:267781)或不稳定。因此，对[时滞系统](@entry_id:262890)进行精确的[稳定性分析](@entry_id:144077)是现代控制理论面临的一项核心挑战。与由[常微分方程](@entry_id:147024)描述的系统不同，[时滞系统](@entry_id:262890)的状态并不能由一个有限维向量完全刻画，而需要考虑一段历史信息，这使其数学本质变为无限维系统，传统的稳定性分析工具也因此失效。

为解决这一难题，[Lyapunov-Krasovskii泛函](@entry_id:172749)方法应运而生。它巧妙地将经典的[Lyapunov稳定性](@entry_id:147734)思想推广到无限维函数空间，通过构造一个能够度量系统“总能量”（包含历史状态信息）的泛函，为判断[时滞系统的稳定性](@entry_id:172423)提供了强大而系统的理论框架。本文旨在全面而深入地介绍[Lyapunov-Krasovskii泛函](@entry_id:172749)方法，引导读者从基本原理走向前沿应用。

在接下来的内容中，我们将分三个章节展开讨论。第一章**“原理与机制”**将为您奠定坚实的理论基础，从[时滞系统](@entry_id:262890)的无限维状态空间描述出发，详细阐述[Lyapunov-Krasovskii泛函](@entry_id:172749)的定义、稳定性定理，并展示如何将抽象理论转化为可计算的[线性矩阵不等式](@entry_id:174484)（LMI）[稳定性判据](@entry_id:755304)。第二章**“应用与交叉学科联系”**将视野拓宽至实际工程问题，展示LKF方法如何在[控制器综合](@entry_id:261816)、[状态观测器设计](@entry_id:168017)、[网络化控制](@entry_id:168556)及[采样数据系统](@entry_id:166645)等领域发挥关键作用，揭示其作为统一分析框架的强大能力。最后，在**“动手实践”**部分，您将通过解决具体的计算问题，亲手实现稳定性分析算法，从而将理论知识内化为解决实际问题的技能。

## 原理与机制

本章旨在深入探讨时滞[系统稳定性](@entry_id:273248)分析的核心理论与技术机制。我们将从[时滞系统](@entry_id:262890)状态的数学描述出发，建立适用于无限维空间的状态稳定性定义，并详细阐述[Lyapunov-Krasovskii泛函](@entry_id:172749)方法这一关键工具。最后，我们将展示如何将抽象的理论转化为可计算的、基于[线性矩阵不等式](@entry_id:174484)（LMI）的[稳定性判据](@entry_id:755304)，并讨论延迟独立与延迟依赖两类分析方法的原理与差异。

### [时滞系统](@entry_id:262890)的状态空间

对于由[常微分方程](@entry_id:147024)（ODE）描述的系统，其在任一时刻的状态可以由一个$\mathbb{R}^n$空间中的向量完全刻画。然而，对于[时滞系统](@entry_id:262890)，仅知道当前时刻的状态$x(t)$是不足以确定系统未来演化的，因为系统的动态（即$\dot{x}(t)$）还依赖于过去某一时刻或某一段历史的状态。因此，我们需要一个更丰富的数学对象来描述[时滞系统](@entry_id:262890)的“状态”。

这个对象就是**历史函数段（history segment）**。对于一个具有最大时滞$h > 0$的系统，其在时刻$t$的状态由函数$x_t$定义，该函数描绘了系统在区间$[t-h, t]$上的完整轨迹。形式上，我们将历史函数段$x_t$视为一个从$[-h, 0]$到$\mathbb{R}^n$的映射，定义为：
$$
x_t(\theta) = x(t+\theta), \quad \forall \theta \in [-h, 0]
$$
所有这些可能的历史函数段构成了一个**状态空间**。对于具有连续解的[时滞系统](@entry_id:262890)，这个[状态空间](@entry_id:177074)自然地被选择为巴拿赫空间$C([-h, 0], \mathbb{R}^n)$，即定义在$[-h, 0]$上的所有连续$n$维[向量值函数](@entry_id:261164)的集合。该空间配备了**[上确界范数](@entry_id:145717)（supremum norm）**：
$$
\|x_t\|_h := \sup_{\theta \in [-h, 0]} \|x_t(\theta)\|
$$
其中$\|\cdot\|$是$\mathbb{R}^n$中的欧几里得范数。这个范数量化了历史函数段的“大小”。

在这一框架下，一个[时滞系统](@entry_id:262890)的初始条件不再是$t=0$时刻的一个点$x(0)$，而是一个定义在$[-h, 0]$上的初始函数$\phi \in C([-h, 0], \mathbb{R}^n)$。只要给定一个连续的初始函数，我们就可以采用“[步进法](@entry_id:203249)”（method of steps）来确保解的存在性和唯一性。例如，对于系统$\dot{x}(t) = A x(t) + A_d x(t-h)$，在第一个时间段$[0, h]$内，$x(t-h) = \phi(t-h)$是已知的[连续函数](@entry_id:137361)。方程变为一个非齐次[线性常微分方程](@entry_id:276013)，其在初始点$x(0)=\phi(0)$下有唯一解。得到$[0, h]$上的解后，我们又可以利用它来确定$[h, 2h]$时间段内$x(t-h)$的值，如此迭代，便可将解唯一地延拓下去 [@problem_id:2747700]。

根据系统动态对历史的依赖方式，泛函[微分方程](@entry_id:264184)（FDE）可分为不同类型。如果$\dot{x}(t)$仅依赖于状态的历史$x_t$（即$x$在过去和现在的值），则该方程称为**滞后型泛函[微分方程](@entry_id:264184)（Retarded Functional Differential Equation, RFDE）**。其一般形式为$\dot{x}(t) = F(t, x_t)$。我们之前讨论的系统以及形如$\dot{x}(t) = f(x(t), x(t-\tau(t)))$的系统都属于此类。然而，如果$\dot{x}(t)$还依赖于其自身导数的历史值（例如$\dot{x}(t-h)$），则该方程称为**中立型泛函[微分方程](@entry_id:264184)（Neutral Functional Differential Equation, NFDE）**，例如$\dot{x}(t) - E\dot{x}(t-h) = A x(t) + A_h x(t-h)$。中立型系统的分析更为复杂，通常需要更高级的工具来处理导数时滞项。本章将主要聚焦于滞后型系统 [@problem_id:2747640]。

### 无限维空间中的稳定性概念

与[常微分方程](@entry_id:147024)类似，我们可以为[时滞系统](@entry_id:262890)定义[Lyapunov稳定性](@entry_id:147734)、[渐近稳定性](@entry_id:149743)和[指数稳定性](@entry_id:169260)。关键区别在于，这些定义必须基于无限维[状态空间](@entry_id:177074)$C([-h, 0], \mathbb{R}^n)$及其范数$\|\cdot\|_h$。我们考虑零解$x_t \equiv 0$的稳定性。

- **[Lyapunov稳定性](@entry_id:147734)**：如果对于任意给定的$\varepsilon > 0$，总能找到一个$\delta(\varepsilon) > 0$，使得任何满足$\|\phi\|_h < \delta$的初始函数$\phi$，其对应的解$x_t(\phi)$对于所有$t \ge 0$都存在且满足$\|x_t(\phi)\|_h < \varepsilon$，那么零解是Lyapunov稳定的。这意味着小的初始扰动（在整个历史区间上）只会导致解在所有未来时间里保持在一个小的邻域内。

- **[渐近稳定性](@entry_id:149743)**：如果零解是Lyapunov稳定的，并且存在一个$\delta_0 > 0$，使得任何满足$\|\phi\|_h < \delta_0$的初始函数$\phi$所对应的解都满足$\lim_{t\to\infty} \|x_t(\phi)\|_h = 0$，那么零解是[渐近稳定](@entry_id:168077)的。这不仅要求解保持有界，还要求其最终收敛到零状态。

- **[指数稳定性](@entry_id:169260)**：如果存在正常数$M \ge 1$, $\alpha > 0$和$\delta > 0$，使得任何满足$\|\phi\|_h < \delta$的初始函数$\phi$所对应的解都满足不等式$\|x_t(\phi)\|_h \le M e^{-\alpha t} \|\phi\|_h$对于所有$t \ge 0$成立，那么零解是指数稳定的。这为收敛提供了最小速率的保证。

值得强调的是，这些定义中的范数是$\|x_t\|_h$，即$\sup_{\theta \in [-h, 0]} \|x(t+\theta)\|$。[稳定性分析](@entry_id:144077)的对象是整个函数段，而不仅仅是瞬时状态$x(t)$ [@problem_id:2747696]。

### Lyapunov-Krasovskii方法

Lyapunov第二方法（或称直接法）为常微分方程提供了一个无需直接求解即可判断稳定性的强大工具。这一思想可以推广到[时滞系统](@entry_id:262890)，其核心是从使用**[Lyapunov函数](@entry_id:273986)** $V(x(t))$转变为使用**[Lyapunov-Krasovskii泛函](@entry_id:172749)（Lyapunov-Krasovskii Functional, LKF）** $V(x_t)$。泛函是以函数为自变量的函数，这里的$V$即以历史函数段$x_t \in C([-h, 0], \mathbb{R}^n)$为输入，输出一个实数值。

一个设计良好的LKF可以看作是系统在时刻$t$的总能量的度量，它不仅包含了当前状态$x(t)$的能量，还包含了存储在时滞环节中的能量。如果这个“总能量”是正定的，并且沿着系统的轨迹是耗散的，那么系统就应该是稳定的。

**Lyapunov-Krasovskii稳定性定理**

为了严格叙述，我们需要定义泛函的性质。我们用$\mathcal{K}$表示所有连续、严格递增且$\alpha(0)=0$的函数$\alpha: \mathbb{R}_{\ge 0} \to \mathbb{R}_{\ge 0}$构成的集合。若一个$\mathcal{K}$类函数还是无界的（即当$s \to \infty$时$\alpha(s) \to \infty$），则称其属于$\mathcal{K}_\infty$类。

考虑自治滞后系统$\dot{x}(t) = f(x_t)$，并假设$f(0)=0$。如果存在一个连续泛函$V: C([-h, 0], \mathbb{R}^n) \to \mathbb{R}_{\ge 0}$以及函数$\alpha_1, \alpha_2 \in \mathcal{K}_\infty$和$\alpha_3 \in \mathcal{K}$，满足以下条件：
1.  **[正定性](@entry_id:149643)与径向无界性**：$\alpha_1(\|x(t)\|) \le V(x_t) \le \alpha_2(\|x_t\|_h)$
2.  **导数负定性**：$D^+V(x_t) \le -\alpha_3(\|x(t)\|)$

则系统的零解是全局渐近稳定的。

这里有几个关键点需要解释：
- 第一个条件用两个$\mathcal{K}_\infty$类函数将泛函$V(x_t)$的值“夹住”。下界$\alpha_1(\|x(t)\|)$保证了当系统状态偏离原点时，$V$是正的。上界$\alpha_2(\|x_t\|_h)$提供了所谓的“递减性”，这在证明稳定性时至关重要。$\alpha_1$和$\alpha_2$的径向无界性（$\mathcal{K}_\infty$属性）是保证**全局**稳定性的关键 [@problem_id:2747695]。
- 第二个条件要求$V$沿着系统轨迹的导数是负定的。由于$V$可能不是处处可微的，我们使用**右上Dini导数（upper right Dini derivative）**，其定义为：
$$
D^+V(x_t) := \limsup_{\tau \to 0^+} \frac{V(x_{t+\tau}) - V(x_t)}{\tau}
$$
这个导数刻画了泛函沿解轨迹的瞬时最大增長率。当$V$光滑时，它就退化为通常的导数$\frac{d}{dt}V(x_t)$。计算该导数本质上是在无限维[函数空间](@entry_id:143478)中，沿着由系统动态确定的方向（由函数段的平移和在$\theta=0$处由$f(x_t)$注入的新值共同决定）计算方向导数 [@problem_id:2747669]。

与Lyapunov-Krasovskii方法相比，另一种经典方法是**Lyapunov-Razumikhin方法**。该方法仍然使用定义在$\mathbb{R}^n$上的Lyapunov函数$V(x(t))$，但其稳定性定理要求$\dot{V}$的负定性仅需在一个额外的“Razumikhin条件”下成立，例如，当过去的“能量”$V(x(t+\theta))$不超过当前能量$V(x(t))$的某个倍数时。这种方法避免了处理泛函，但因为它只利用了当前[状态和](@entry_id:193625)历史状态的模长比较信息，而没有像LKF那样利用历史状态的积分信息，所以通常会得出更为保守的结论 [@problem_id:2747690]。

### [Lyapunov-Krasovskii泛函](@entry_id:172749)的构造

LK[F理论](@entry_id:184208)的威力在于其灵活性，但如何构造一个满足稳定性条件的LKF是核心挑战。对于线性[时滞系统](@entry_id:262890)$\dot{x}(t) = A x(t) + A_d x(t-h)$，一类最常用也最基础的LKF形式是：
$$
V(x_t) = x(t)^{\top} P x(t) + \int_{t-h}^{t} x(s)^{\top} Q x(s) ds
$$
其中$P$和$Q$是待定的对称矩阵。

这个泛函直观地包含了当前状态的二次型能量项$x(t)^{\top} P x(t)$和一个表示时滞段内状态轨迹能量的积分项。为了使这个泛函成为一个有效的LKF，它必须是正定的，即$V(x_t) \ge 0$且$V(x_t)=0$当且仅当$x_t \equiv 0$。

让我们分析其[正定性](@entry_id:149643)条件。为了使$V(x_t) \ge 0$对任意历史函数段成立，两个组成项都必须非负。这意味着$P$必须是**正半定**的（$P \succeq 0$），$Q$也必须是**正半定**的（$Q \succeq 0$）。

然而，这还不够。我们还需要满足$V(x_t)=0 \iff x_t \equiv 0$。如果$V(x_t)=0$，则$x(t)^{\top} P x(t) = 0$且$\int_{t-h}^{t} x(s)^{\top} Q x(s) ds = 0$。由于积分项的被积函数非负且连续，积分为零意味着被积函数恒为零，即$x(s)^{\top} Q x(s) = 0$对所有$s \in [t-h, t]$成立。

- 如果$Q$只是正半定而非正定，那么存在非[零向量](@entry_id:156189)$v$使得$v^\top Q v = 0$。我们可以构造一个非零的历史函数段（例如，在$[t-h, t]$区间内部不为零，但在端点$t$处为零的函数），使得$x(t)=0$且$x(s)$始终位于$Q$的[零空间](@entry_id:171336)中。对于这样的非零$x_t$，我们得到$V(x_t)=0$，这违反了[正定性](@entry_id:149643)的定义。
- 因此，为了保证$x(s)^{\top} Q x(s) = 0 \implies x(s)=0$，矩阵$Q$必须是**严格正定**的（$Q \succ 0$）。
- 如果$Q \succ 0$，那么$\int_{t-h}^{t} x(s)^{\top} Q x(s) ds = 0$直接意味着$x(s) \equiv 0$对$s \in [t-h,t]$成立，这自然也包含了$x(t)=0$。此时，对$P$的要求仅为$P \succeq 0$即可。

综上所述，上述形式的LKF是正定的充要条件是$P \succeq 0$且$Q \succ 0$ [@problem_id:2747665]。

### 从理论到实践：基于LMI的稳定性分析

Lyapunov-Krasovskii定理给出了抽象的条件。对于线性系统，我们可以将这些条件转化为可通过数值有效求解的**[线性矩阵不等式](@entry_id:174484)（Linear Matrix Inequality, LMI）**。

#### 延迟独立稳定性 (Delay-Independent Stability)

首先，我们区分两种稳定性概念。如果一个系统对于任意非负时滞$h \ge 0$都是[渐近稳定](@entry_id:168077)的，则称其具有**延迟独立稳定性**。如果系统仅在时滞$h$属于某个特定范围（通常是$[0, h_{\max})$）时才稳定，则称其具有**延迟依赖稳定性** [@problem_id:2747642]。

我们可以使用之前构造的简单LKF来推导延迟独立的稳定性条件。计算$V(x_t) = x(t)^{\top} P x(t) + \int_{t-h}^{t} x(s)^{\top} Q x(s) ds$的导数：
$$
\dot{V}(x_t) = 2x(t)^{\top} P \dot{x}(t) + x(t)^{\top} Q x(t) - x(t-h)^{\top} Q x(t-h)
$$
代入系统动态$\dot{x}(t) = A x(t) + A_d x(t-h)$，并将结果整理成关于向量$\zeta(t) = \begin{pmatrix} x(t) \\ x(t-h) \end{pmatrix}$的二次型，我们得到：
$$
\dot{V}(x_t) = \zeta(t)^{\top} \begin{pmatrix} A^{\top} P + PA + Q  P A_d \\ A_d^{\top} P  -Q \end{pmatrix} \zeta(t)
$$
为了保证$\dot{V}(x_t)  0$，我们需要上式中的矩阵是负定的。因此，如果存在对称矩阵$P \succ 0$和$Q \succ 0$使得以下LMI成立，则系统是延迟无关稳定的：
$$
\begin{pmatrix} A^{\top} P + PA + Q  P A_d \\ A_d^{\top} P  -Q \end{pmatrix} \prec 0
$$
这个条件不包含时滞$h$，因此它若成立，则对所有$h \ge 0$都成立 [@problem_id:2747624]。

这类延迟独立条件通常是**保守的**。因为它要求LKF的[能量耗散](@entry_id:147406)对任意大的时滞都成立，这在很多情况下过于严苛。例如，系统$\dot{x}(t) = -x(t) - 2x(t-h)$在$h=0$时是稳定的（特征根为-3）。但随着$h$的增加，在$h \approx 1.209$时系统会失稳。延迟独立分析方法无法捕捉到系统在$[0, 1.209)$区间内的稳定行为，可能会直接判定系统不稳定 [@problem_id:2747642]。

#### 延迟依赖稳定性 (Delay-Dependent Stability)

为了得到更精确、不那么保守的结果，我们需要发展延迟依赖的分析方法。其核心思想在于构造更精巧的LKF，并使用更精细的不等式来估计其导数，从而在最终的[稳定性判据](@entry_id:755304)中显式地包含时滞$h$。

一个关键的数学工具是**[Jensen不等式](@entry_id:144269)**。对于任意凸函数$\phi$和定义在$[a,b]$上的函数$f(s)$，有：
$$
\frac{1}{b-a} \int_a^b \phi(f(s)) ds \ge \phi\left( \frac{1}{b-a} \int_a^b f(s) ds \right)
$$
考虑一个更复杂的LKF，例如包含$\dot{x}$的积分项：$V_3(t) = \int_{-h}^{0}\int_{t+\theta}^{t} \dot{x}(s)^{\top} R \dot{x}(s)\,ds\,d\theta$ ($R \succ 0$)。其导数中会包含一项负积分项：$-\int_{t-h}^{t} \dot{x}(s)^{\top} R \dot{x}(s) ds$。

由于函数$z \mapsto z^{\top} R z$是凸函数，我们可以利用[Jensen不等式](@entry_id:144269)来对这一项进行放缩：
$$
-\int_{t-h}^{t} \dot{x}(s)^{\top} R \dot{x}(s) ds = -h \left( \frac{1}{h} \int_{t-h}^{t} \dot{x}(s)^{\top} R \dot{x}(s) ds \right) \le -h \left( \frac{1}{h} \int_{t-h}^{t} \dot{x}(s) ds \right)^{\top} R \left( \frac{1}{h} \int_{t-h}^{t} \dot{x}(s) ds \right)
$$
利用微积分基本定理，$\int_{t-h}^{t} \dot{x}(s) ds = x(t) - x(t-h)$，我们得到一个至关重要的不等式：
$$
-\int_{t-h}^{t} \dot{x}(s)^{\top} R \dot{x}(s) ds \le -\frac{1}{h} (x(t) - x(t-h))^{\top} R (x(t) - x(t-h))
$$
这个不等式将一个难以处理的积分项，用一个关于$x(t)$和$x(t-h)$的二次型项来[上界](@entry_id:274738)。最关键的是，这个上界中出现了因子$1/h$。当这个不等式被用于$\dot{V}$的放缩时，时滞$h$就自然地进入到了最终的LMI判据中，使得该判据成为延迟依赖的。

值得注意的是，我们无法用类似方法为$\int_{t-h}^{t} x(s)^{\top} Q x(s) ds$找到一个有意义的、与$x(t)-x(t-h)$相关的正的下界。事实上，可以证明，对于任意给定的$h$和$Q \succ 0$，能使不等式$\int_{t-h}^{t} x(s)^{\top} Q x(s) ds \ge c(h,Q) (x(t)-x(t-h))^{\top} Q (x(t)-x(t-h))$对所有[连续函数](@entry_id:137361)成立的最大的$c(h,Q)$只能是0 [@problem_id:2747661]。这也从侧面说明了LKF构造和不等式放缩的技巧性与方向性。

通过引入更复杂的LKF以及[Jensen不等式](@entry_id:144269)等[积分不等式](@entry_id:139182)，我们可以推导出一系列依赖于$h$的LMI条件。这些条件通常可以用来计算一个系统保持稳定的最大时滞上界$h_{\max}$。此外，为了进一步降低保守性，还可以引入**自由权矩阵（free-weighting matrices）**或[松弛变量](@entry_id:268374)，它们作为额外的决策变量，可以在不改变$\dot{V}$的值的前提下，为LMI提供更多的自由度，从而更容易找到[可行解](@entry_id:634783) [@problem_id:2747661]。这些高级技术构成了现代[时滞系统](@entry_id:262890)稳定性分析的核心机制。