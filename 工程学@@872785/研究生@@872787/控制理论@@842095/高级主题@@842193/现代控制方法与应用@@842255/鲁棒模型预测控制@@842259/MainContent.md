## 引言
[模型预测控制](@entry_id:146965)（MPC）是现代控制理论的基石，它通过[在线优化](@entry_id:636729)为具有约束的系统提供了卓越的性能。然而，当现实世界的[模型不确定性](@entry_id:265539)和外部扰动不可避免地出现时，仅为理想化模型设计的MPC控制器，其性能可能急剧下降，甚至违反关键安全约束。[鲁棒模型预测控制](@entry_id:174393)（RMPC）正是为了应对这一核心挑战而生，它提供了一套系统性的方法论，用以设计即使在最坏情况的不确定性下，也能严格保证系统安全和稳定性的高级控制器。本文旨在填补从标称MPC到能够应对现实复杂性的[鲁棒MPC](@entry_id:174393)之间的理论与实践鸿沟，带领读者掌握在不确定性下进行约束决策的系统性方法。首先，我们将深入 **“原理与机制”**，剖析RMPC的核心数学原理，重点介绍如[管束](@entry_id:148450)MPC等关键技术，并理解其如何提供确定性的安全保证。随后，我们将在 **“应用与跨学科联系”** 中探索RMPC如何在工程实践、大规模网络化系统乃至生物医学等前沿领域解决真实世界的复杂问题，展示其强大的灵活性。最后，通过 **“动手实践”** 部分提供的计算练习，您将有机会将理论知识转化为实际的设计能力。现在，让我们正式开始，深入探讨RMPC的基石。

## 原理与机制

在上一章中，我们介绍了[模型预测控制](@entry_id:146965)（MPC）的基本概念，它通过在每个采样时刻求解一个有限时域[最优控制](@entry_id:138479)问题来为[约束系统](@entry_id:164587)提供高性能的控制。该框架在系统模型精确已知（即“标称”情况）时表现出色。然而，现实世界中的物理系统不可避免地会受到扰动、[测量噪声](@entry_id:275238)和[模型参数不确定性](@entry_id:752081)的影响。一个仅为标称[系统设计](@entry_id:755777)的MPC控制器在面对这些不确定性时，其性能可能会严重下降，甚至更关键的是，可能会违反系统约束，导致不安全的操作或控制任务的失败。

本章旨在深入探讨[鲁棒模型预测控制](@entry_id:174393)（RMPC）的核心原理与机制。我们将阐述如何从数学上严谨地刻画不确定性，并介绍确保在不确定性存在的情况下严格满足约束和保持稳定性的关键策略。我们的重点将放在理解这些机制“为何”以及“如何”有效，从而为设计能够应对现实世界复杂性的高级控制系统奠定坚实的基础。

### MPC面临的不确定性挑战

为了理解鲁棒控制的必要性，我们首先简要回顾一下标称MPC的结构。对于一个离散时间线性时不变（LTI）系统 $x_{k+1} = Ax_k + Bu_k$，在满足[状态和](@entry_id:193625)输入约束 $(x_k, u_k) \in \mathcal{X} \times \mathcal{U}$ 的前提下，一个典型的有限时域MPC控制器旨在最小化一个二次[代价函数](@entry_id:138681)：
$$ J_N(x_k) = \sum_{i=0}^{N-1} (x_{i|k}^{\top}Qx_{i|k} + u_{i|k}^{\top}Ru_{i|k}) + x_{N|k}^{\top}Px_{N|k} $$
其中，预测的状态序列 $\{x_{i|k}\}$ 和输入序列 $\{u_{i|k}\}$ 受制于[系统动力学](@entry_id:136288)、状态/输入约束以及一个关键的[终端约束](@entry_id:176488) $x_{N|k} \in \mathcal{X}_f$。终端代价 $x_{N|k}^{\top}Px_{N|k}$ 和[终端集](@entry_id:163892) $\mathcal{X}_f$ 经过精心设计，以保证闭环系统的[递归可行性](@entry_id:167169)和[渐近稳定性](@entry_id:149743) [@problem_id:2741130]。这种方法的核心是**[滚动时域](@entry_id:181425)**（receding horizon）原理：在每个时刻 $k$，求解上述[优化问题](@entry_id:266749)得到最优输入序列 $\{u_{i|k}^\star\}_{i=0}^{N-1}$，但只将第一个输入 $u_k = u_{0|k}^\star$ 应用于系统。然后在下一时刻 $k+1$，测量新的系统状态并重复此过程。

当不确定性进入画面时，这一优雅的框架便面临严峻挑战。假设系统实际上遵循 $x_{k+1} = Ax_k + Bu_k + w_k$，其中 $w_k$ 是一个未知的、有界的扰动。MPC控制器基于标称模型 $x_{k+1} = Ax_k + Bu_k$ 进行预测，它所预测的状态轨迹将偏离系统的实际轨迹。即使控制器在名义上满足了约束，实际状态也可能漂移出允许的范围 $\mathcal{X}$。更糟糕的是，这种偏差可能导致在未来的某个时刻，[优化问题](@entry_id:266749)变得不可行，因为从当前被扰动的状态出发，控制器找不到任何能够在时域内满足约束的控制序列。

为了系统地处理这些问题，我们首先需要对不确定性的类型进行分类。主要有两种模型 [@problem_id:2736375]：
1.  **有界加性扰动**：系统动力学表示为 $x_{k+1} = Ax_k + Bu_k + w_k$，其中系统矩阵 $(A,B)$ 已知，而扰动 $w_k$ 是一个未知但属于某个已知紧集 $\mathcal{W}$（例如，$\mathcal{W} = \{w \mid \|w\|_\infty \le \bar{w}\}$）的向量。这种模型常用于表示外部扰动、过程噪声或[建模误差](@entry_id:167549)的综合影响。
2.  **[参数不确定性](@entry_id:264387)**：系统动力学表示为 $x_{k+1} = A(\theta_k)x_k + B(\theta_k)u_k$，其中参数 $\theta_k$ 未知，但属于一个已知的集合。例如，系统矩阵对 $(A(\theta_k), B(\theta_k))$ 可能位于一个由顶点 $\{(A_i, B_i)\}_{i=1}^p$ 定义的凸包内。这种模型适用于描述系统物理参数（如质量、摩擦系数）随时间变化或本身不精确的情况。

虽然两种不确定性都需要鲁棒的设计方法，但它们的处理方式在技术上有显著差异。[参数不确定性](@entry_id:264387)通常会导致更复杂的、与状态相关的误差动态，其分析和控制也更具挑战性。在本章中，我们将主要聚焦于更为基础和广泛应用的加性扰动模型，以阐明[鲁棒MPC](@entry_id:174393)的核心原理。

### 鲁棒性：从概念到约束

[鲁棒控制](@entry_id:260994)的核心思想是放弃对最佳性能的追求，转而寻求在所有可能的不确定性实现下都能保证系统安全（即满足约束）和稳定。这种“最坏情况”的理念与随机性方法（如[机会约束](@entry_id:166268)MPC）形成了鲜明对比 [@problem_id:2741106]。

#### 最坏情况约束与概率约束

假设在预测的未来某一步，我们关心一个标量输出 $y = c^\top x$ 是否满足约束 $y \le y_{\max}$。由于扰动的影响，这个输出值可以表示为 $y = \mu + g^\top w$，其中 $\mu$ 是基于标称预测的部分，而 $g^\top w$ 则捕获了扰动 $w$ 对输出的线性影响。

-   **鲁棒约束**（Worst-case Constraint）要求该约束对扰动集 $\mathcal{W}$ 中的**所有**可能扰动都成立。这可以形式化为：
    $$ y \le y_{\max}, \quad \forall w \in \mathcal{W} $$
    这等价于要求 $y$ 在 $\mathcal{W}$ 上的最大值不超过 $y_{\max}$：
    $$ \mu + \max_{w \in \mathcal{W}} (g^\top w) \le y_{\max} $$
    这个最大化问题将无穷维的鲁棒约束转化为一个有限维的确定性约束。例如，如果扰动集是超立方体 $\mathcal{W} = \{w \in \mathbb{R}^p \mid \|w\|_\infty \le \bar{w}\}$，那么 $\max_{w \in \mathcal{W}} (g^\top w) = \bar{w} \|g\|_1$。因此，鲁棒约束就变成了一个[线性不等式](@entry_id:174297) $\mu + \bar{w} \|g\|_1 \le y_{\max}$ [@problem_id:2741106]。这种方法的优点是提供确定性的硬保证，但代价可能是保守性，因为它为极不可能发生的最坏情况组合进行了规划。

-   **[机会约束](@entry_id:166268)**（Chance Constraint）则采用了一种概率性的方法。它不要求约束100%满足，而是要求其满足的概率不低于某个给定的[置信水平](@entry_id:182309) $1-\alpha$，其中 $\alpha$ 是一个小的风险水平（如 $0.05$）。这可以形式化为：
    $$ \mathbb{P}(y \le y_{\max}) \ge 1-\alpha $$
    如果扰动 $w$ 被建模为一个[随机变量](@entry_id:195330)，例如高斯分布 $w \sim \mathcal{N}(0, \Sigma)$，那么 $y$ 也服从[高斯分布](@entry_id:154414) $y \sim \mathcal{N}(\mu, g^\top\Sigma g)$。[机会约束](@entry_id:166268)可以被精确地转化为一个确定性约束：
    $$ \mu + \Phi^{-1}(1-\alpha) \sqrt{g^\top\Sigma g} \le y_{\max} $$
    其中 $\Phi^{-1}$ 是[标准正态分布](@entry_id:184509)的[逆累积分布函数](@entry_id:266870)（或[分位数函数](@entry_id:271351)）。[机会约束](@entry_id:166268)方法通常没有鲁棒方法那么保守，允许偶尔（以概率 $\alpha$）违反约束，这在某些应用中是可以接受的。

    **示例**：考虑 [@problem_id:2741106] 中的数值例子，其中 $\mu=0.5$, $g=\begin{pmatrix} 0.2  -0.1 \end{pmatrix}^\top$。
    -   在**鲁棒**情况下，设 $\bar{w}=0.8$。约束边界为 $y_{\max} \ge 0.5 + \|g\|_1 \times 0.8 = 0.5 + (0.2+0.1) \times 0.8 = 0.5 + 0.24 = 0.74$。
    -   在**随机**情况下，设 $\Sigma=\mathrm{diag}(0.25, 0.09)$ 且 $\alpha=0.05$。标准差为 $\sigma_y = \sqrt{g^\top\Sigma g} \approx 0.1044$。由于 $\Phi^{-1}(0.95) \approx 1.645$，约束边界为 $y_{\max} \ge 0.5 + 1.645 \times 0.1044 \approx 0.5 + 0.172 \approx 0.672$。

    这个例子清晰地表明，为了获得确定性的最坏情况保证，鲁棒方法要求一个更严格的约束边界（$y_{\max} \ge 0.74$）相比于接受5%违规风险的[机会约束](@entry_id:166268)方法（$y_{\max} \ge 0.672$）。在本章的其余部分，我们将专注于提供确定性保证的鲁棒方法。

### 机制一：最小-最大[模型[预测控](@entry_id:146965)制](@entry_id:265552)

处理不确定性最直接的方法之一是**最小-最大（Min-Max）MPC**。其核心思想是在线求解一个最小-最大[优化问题](@entry_id:266749)：控制器选择一个控制序列，以最小化在**最坏情况**扰动序列下产生的代价。

#### 公式化

在每个时刻 $k$，给定当前状态 $x_k$，Min-Max MPC 求解以下问题 [@problem_id:2746618]：
$$ \min_{u_{0:N-1}} \left( \max_{w_{0:N-1} \in \mathcal{W}^N} \left[ \sum_{i=0}^{N-1} \ell(x_i, u_i) + V_f(x_N) \right] \right) $$
该优化受制于以下约束，这些约束必须对**所有**扰动序列 $w_{0:N-1} \in \mathcal{W}^N$ 均成立：
1.  [系统动力学](@entry_id:136288)：$x_{i+1} = Ax_i + Bu_i + w_i$
2.  状态约束：$x_i \in \mathcal{X}$
3.  输入约束：$u_i \in \mathcal{U}$
4.  [终端约束](@entry_id:176488)：$x_N \in \mathcal{X}_f$

这里的 $u_{0:N-1}$ 是一个**开环**输入序列，即它不依赖于在[预测时域](@entry_id:261473)内发生的扰动。找到一个单一的输入序列，能够抵抗未来所有可能的扰动组合，这通常导致非常保守的解决方案。

#### 挑战与变体

尽管概念上很直观，但解决上述 min-max 问题在计算上极具挑战性。这是一个半无限[优化问题](@entry_id:266749)，因为它涉及对无穷多个（如果 $\mathcal{W}$ 是[连续集](@entry_id:186725)）扰动序列的约束。

为了降低保守性和改善性能，可以采用**闭环**或**反馈**策略，其中未来的控制输入可以依赖于未来扰动的实现。几种重要的变体包括 [@problem_id:2741076]：
-   **仿射扰动反馈（Affine Disturbance Feedback）**：将控制策略[参数化](@entry_id:272587)为 $u_j = v_j + \sum_{i=0}^{j-1} L_{j,i} w_i$，其中标称输入 $v_j$ 和[反馈增益](@entry_id:271155) $L_{j,i}$ 成为[在线优化](@entry_id:636729)的决策变量。这在保持[凸优化](@entry_id:137441)结构（通常是二次规划或[半定规划](@entry_id:268613)）的同时，显著降低了保守性。其计算复杂度与时域长度 $N$ 呈多项式关系。
-   **多阶段MPC（Multi-stage MPC）**：将[不确定性建模](@entry_id:268420)为一个场景树。在每个阶段，不确定性从有限个离散值中实现一个，形成一个不断分支的树。控制器在树的所有节点上进行优化，并带有非预见性约束（即在不确定性揭示之前，控制决策必须相同）。这种方法能够更精确地模拟信息结构，从而获得更优的性能，但其计算复杂度随[预测时域](@entry_id:261473) $N$ 呈指数增长，这限制了其实际应用。

由于在线计算的巨大负担，纯粹的min-max方法，特别是其闭环形式，通常用于需要高性能且计算资源充足的慢速系统。这促使了另一种更具计算效率的[鲁棒MPC](@entry_id:174393)机制的发展。

### 机制二：[管束](@entry_id:148450)[模型预测控制](@entry_id:146965)

**[管束](@entry_id:148450)[模型预测控制](@entry_id:146965)（Tube-based MPC）** 是一种[计算效率](@entry_id:270255)高且极具影响力的RMPC方法。其核心思想是将复杂的鲁棒控制[问题分解](@entry_id:272624)为一个离线的鲁棒性分析任务和一个在线的标称（非鲁棒）MPC任务。在线控制器只需为一个不含扰动的标称系统规划轨迹，但必须在一个被“收紧”或“压缩”的约束集内进行。

#### 核心思想：状态分解

[管束](@entry_id:148450)MPC的关键是将实际状态 $x_k$ 分解为一个**标称状态** $\bar{x}_k$ 和一个**误差状态** $e_k$ [@problem_id:2741077]：
$$ x_k = \bar{x}_k + e_k $$
我们为这个分解设计相应的动力学：
1.  **标称动力学**：我们定义标称状态由一个标称输入 $\bar{u}_k$ 驱动，并且不受扰动影响：
    $$ \bar{x}_{k+1} = A\bar{x}_k + B\bar{u}_k $$
    这个模型是确定性的，因此适合用于[在线优化](@entry_id:636729)和预测。

2.  **误差动力学**：为了控制误差的演化，我们引入一个辅助的**线性反馈控制器** $K$。实际施加到系统上的控制输入由标称输入和对误差的反馈校正组成：
    $$ u_k = \bar{u}_k + K(x_k - \bar{x}_k) = \bar{u}_k + Ke_k $$
    将此控制律代入实际[系统动力学](@entry_id:136288) $x_{k+1} = Ax_k + Bu_k + w_k$ 并减去标称动力学，我们得到误差的演化规律：
    $$ e_{k+1} = x_{k+1} - \bar{x}_{k+1} = (A+BK)e_k + w_k $$
    这表明，误差 $e_k$ 的演化由一个自治的[LTI系统](@entry_id:271946)驱动，该系统由闭环矩阵 $A+BK$ 和系统扰动 $w_k$ 决定。

通过预先选择一个使 $A+BK$ 稳定的增益 $K$（即 $A+BK$ 是舒尔矩阵），我们可以确保在没有扰动的情况下误差会收敛到零。在有扰动的情况下，误差将保持有界。

#### 误差[管束](@entry_id:148450)与[不变集](@entry_id:275226)

我们的目标是确保误差 $e_k$ 始终保持在一个紧凑的、预先计算好的集合 $\mathcal{E}$ 内。这个集合 $\mathcal{E}$ 必须是**鲁棒正不变（Robust Positive Invariant, RPI）**的 [@problem_id:2741213]。

-   一个集合 $\mathcal{S}$ 对于标称系统 $e_{k+1}=(A+BK)e_k$ 是**正不变（PI）**的，如果从该集合出发的任何轨迹都将永远保留在该集合内。形式上，这意味着 $(A+BK)\mathcal{S} \subseteq \mathcal{S}$。

-   一个集合 $\mathcal{E}$ 对于受扰动的误差系统 $e_{k+1}=(A+BK)e_k+w_k$ 是**鲁棒正不变（RPI）**的，如果从该集合出发的任何轨迹，在**任何**允许的扰动 $w_k \in \mathcal{W}$ 的作用下，都将永远保留在该集合内。

这个鲁棒性要求可以用两种等价的方式来表达 [@problem_id:2741213]：
1.  **逐点定义**：对于所有的 $e \in \mathcal{E}$ 和所有的 $w \in \mathcal{W}$，都有 $(A+BK)e+w \in \mathcal{E}$。
2.  **集合定义**：使用**[闵可夫斯基和](@entry_id:176841)（Minkowski Sum）**，这可以更紧凑地写成：
    $$ (A+BK)\mathcal{E} \oplus \mathcal{W} \subseteq \mathcal{E} $$
    其中，两个集合的[闵可夫斯基和](@entry_id:176841) $C \oplus D$ 定义为 $\{c+d \mid c \in C, d \in D\}$。[闵可夫斯基和](@entry_id:176841)是描述[加性不确定性](@entry_id:266977)传播的自然语言 [@problem_id:2741208]。

如果 $A+BK$ 是稳定的，那么对于任何有界扰动集 $\mathcal{W}$，总存在一个有界的RPI集 $\mathcal{E}$。最小的RPI集可以被计算为无限[闵可夫斯基和](@entry_id:176841) $\mathcal{E}_{\min} = \bigoplus_{i=0}^{\infty} (A+BK)^i \mathcal{W}$。在实际应用中，我们会计算这个集合的一个紧凑的外近似。这个集合 $\mathcal{E}$ 定义了一个“[管束](@entry_id:148450)”的[横截面](@entry_id:154995)，实际状态 $x_k$ 被保证停留在这个以标称轨迹 $\bar{x}_k$ 为中心的[管束](@entry_id:148450)内。

#### 约束收紧

既然我们能保证误差 $e_k$ 被限制在RPI集 $\mathcal{E}$ 内，我们就可以通过对标称轨迹施加更严格的约束来保证原始约束的满足。这个过程被称为**约束收紧（Constraint Tightening）**。

-   **状态约束**：为保证实际状态 $x_k = \bar{x}_k + e_k$ 满足 $x_k \in \mathcal{X}$，我们必须对标称状态 $\bar{x}_k$ 施加一个更严格的约束，使得无论误差 $e_k \in \mathcal{E}$ 是什么，$\bar{x}_k+e_k$ 总在 $\mathcal{X}$ 内。这要求 $\bar{x}_k \oplus \mathcal{E} \subseteq \mathcal{X}$。满足此条件的 $\bar{x}_k$ 的集合，正是**庞特里亚金差（Pontryagin Difference）**的定义 [@problem_id:2741173]：
    $$ \bar{x}_k \in \mathcal{X} \ominus \mathcal{E} $$
    其中 $\mathcal{A} \ominus \mathcal{B} = \{a \mid a \oplus \mathcal{B} \subseteq \mathcal{A}\}$。因此，收紧后的状态约束集为 $\bar{\mathcal{X}} = \mathcal{X} \ominus \mathcal{E}$。

-   **输入约束**：同样，为保证实际输入 $u_k = \bar{u}_k + Ke_k$ 满足 $u_k \in \mathcal{U}$，我们必须要求 $\bar{u}_k \oplus K\mathcal{E} \subseteq \mathcal{U}$，其中 $K\mathcal{E} = \{Ke \mid e \in \mathcal{E}\}$ 是所有可能控制校正的集合。收紧后的输入约束集为 [@problem_id:2741077]：
    $$ \bar{u}_k \in \mathcal{U} \ominus K\mathcal{E} $$
    
对于由[线性不等式](@entry_id:174297)定义的约束和多胞形RPI集，收紧后的约束集仍然是多胞形，其计算可以通过**[支撑函数](@entry_id:755667)（Support Function）** $h_C(s) = \sup_{x \in C} s^\top x$ 来完成。一个[线性约束](@entry_id:636966) $c^\top x \le d$ 的收紧量恰好是 $h_{\mathcal{E}}(c)$，即收紧后的约束为 $c^\top \bar{x} \le d - h_{\mathcal{E}}(c)$ [@problem_id:2741208]。

**示例计算**：考虑 [@problem_id:2741246] 中的例子，系统误差动态由矩阵 $A_{cl} = A+BK$ 驱动，扰动集为 $\|w\|_\infty \le 0.05$。若我们选择一个 $\ell_\infty$-球作为[管束](@entry_id:148450)[截面](@entry_id:154995) $\mathcal{E} = \{e \mid \|e\|_\infty \le \varepsilon\}$，则RPI条件 $\|A_{cl}\|_\infty \varepsilon + \|w\|_{\max} \le \varepsilon$ 给出了最小[管束](@entry_id:148450)半径。经计算，$A_{cl} = \begin{pmatrix} 0.2  0 \\ 0.1  0.25 \end{pmatrix}$，其 $\ell_\infty$ 范数为 $\|A_{cl}\|_\infty = 0.35$。因此，最小半径 $\varepsilon$ 满足 $0.35\varepsilon + 0.05 = \varepsilon$，解得 $\varepsilon = \frac{0.05}{1-0.35} = \frac{1}{13}$。如果原始状态约束为 $|x_i| \le 1.2$，那么收紧后的标称状态约束就是 $|\bar{x}_i| \le 1.2 - \frac{1}{13}$。

至此，[管束](@entry_id:148450)MPC的完整框架已经清晰：
1.  **离线阶段**：选择辅助增益 $K$，计算RPI集 $\mathcal{E}$，并计算收紧后的约束集 $\mathcal{X}\ominus\mathcal{E}$ 和 $\mathcal{U}\ominus K\mathcal{E}$。
2.  **在线阶段**：在每个时刻 $k$，测量实际状态 $x_k$，求解一个标准的标称MPC问题（如前文所述），但使用收紧后的约束集。这个[优化问题](@entry_id:266749)为标称系统规划出最优的 $(\bar{x}_{i|k}^\star, \bar{u}_{i|k}^\star)$ 序列。
3.  **实施**：计算当前误差 $e_k = x_k - \bar{x}_{0|k}^\star$（注意：$\bar{x}_{0|k}^\star$ 是[优化问题](@entry_id:266749)的解的一部分，需满足 $x_k \in \bar{x}_{0|k}^\star \oplus \mathcal{E}$），并应用控制律 $u_k = \bar{u}_{0|k}^\star + Ke_k$。

### [鲁棒MPC](@entry_id:174393)的保证

一个设计良好的RMPC方案不仅仅是在实践中有效，它还必须提供关于可行性和稳定性的严格数学保证。

#### [递归可行性](@entry_id:167169)

**[递归可行性](@entry_id:167169)（Recursive Feasibility）** 是指如果[优化问题](@entry_id:266749)在当前时刻 $k$ 是可行的，那么在控制器所产生的[闭环系统](@entry_id:270770)作用下，对于任何可能的扰动 $w_k \in \mathcal{W}$，[优化问题](@entry_id:266749)在下一时刻 $k+1$ 仍然是可行的。这是控制器能够长期运行的基本要求。

在[管束](@entry_id:148450)MPC中，[递归可行性](@entry_id:167169)的证明依赖于一个巧妙的“候选解”构造 [@problem_id:2741149]。假设在时刻 $k$，我们得到了一个可行的标称计划 $\{\bar{u}_i^\star, \bar{x}_i^\star\}_{i=0}^N$。为了证明在时刻 $k+1$ 问题是可行的，我们只需构造一个（不一定最优，但）可行的解。这个候选解通常是这样构建的：
1.  将时刻 $k$ 的最优计划向左“移动”一步，即使用 $\{\bar{u}_1^\star, \dots, \bar{u}_{N-1}^\star\}$ 作为新计划的前 $N-1$ 步。
2.  在计划的末尾，追加一步由一个预先设计的**终端控制器** $\bar{u}_N = \kappa_f(\bar{x}_N^\star)$ 生成的控制。

由于时刻 $k$ 的计划在收[紧约束](@entry_id:635234)下是可行的，并且[终端集](@entry_id:163892) $\mathcal{Z}_f$ 和终端控制器 $\kappa_f$ 被设计为在标称意义下是不变的，这个构造出来的候选解可以被证明在时刻 $k+1$ 仍然满足所有的收[紧约束](@entry_id:635234)。RPI集 $\mathcal{E}$ 的[不变性](@entry_id:140168)保证了误差始终有界，从而保证了收紧策略的持续有效性。

#### [鲁棒稳定性](@entry_id:268091)

在存在持续有界扰动的情况下，我们通常无法期望系统状态精确收敛到原点。取而代之的稳定性概念是**输入到状态稳定（Input-to-State Stability, ISS）** [@problem_id:2741150]。一个系统被称为ISS，如果其状态的范数可以被一个随时间衰减的项（与初始状态有关）和一个与扰动范数[上界](@entry_id:274738)成正比的项所界定：
$$ \|x_k\| \le \beta(\|x_0\|, k) + \gamma(\sup_{j \ge 0} \|w_j\|) $$
其中 $\beta$ 是一个 $\mathcal{KL}$ [类函数](@entry_id:146970)（第一项单调递减至零，第二项单调递增），$\gamma$ 是一个 $\mathcal{K}$ [类函数](@entry_id:146970)（单调递增且 $\gamma(0)=0$）。这个定义优美地捕捉了[鲁棒稳定性](@entry_id:268091)的本质：
-   如果扰动为零（$w_k \equiv 0$），则系统是**渐近稳定**的（$\|x_k\| \to 0$）。
-   如果扰动非零，状态最终将进入一个以原点为中心的邻域，其大小由扰动的幅度决定。

在RMPC中，ISS通常通过证明MPC[优化问题](@entry_id:266749)的最[优值函数](@entry_id:173036) $V_N(x)$ 是一个**ISS-[李雅普诺夫函数](@entry_id:273986)**来建立。这意味着 $V_N(x)$ 满足一个[耗散不等式](@entry_id:188634) [@problem_id:2741150]：
$$ V_N(x_{k+1}) - V_N(x_k) \le -\underline{\alpha}(\|x_k\|) + \sigma(\|w_k\|) $$
对于某些 $\mathcal{K}_\infty$ 函数 $\underline{\alpha}$ 和 $\mathcal{K}$ 函数 $\sigma$。这个不等式表明，状态的范数越大，[李雅普诺夫函数](@entry_id:273986)的下降就越显著，而扰动则可能使其增加。通过精心的终端成本和[终端集](@entry_id:163892)设计，可以确保RMPC的[价值函数](@entry_id:144750)满足此条件，从而证明闭环系统的ISS。

### RMPC方法谱系：比较与展望

我们已经探讨了[鲁棒MPC](@entry_id:174393)的几种关键机制。在实践中，选择哪种方法取决于特定应用对性能、计算复杂性和保证强度的权衡 [@problem_id:2741076]。

-   **[管束](@entry_id:148450)MPC**：这是计算成本最低的方法之一。其在线计算负担与标称MPC相当，因为它将鲁棒性设计的复杂性转移到了离线计算阶段。然而，由于它使用固定的[反馈增益](@entry_id:271155) $K$ 和固定的[管束](@entry_id:148450)形状 $\mathcal{E}$，它必须为所有未来可能的扰动做好准备，这往往导致其解决方案相对**保守**（即，[可行域](@entry_id:136622)较小，性能次优）。

-   **仿射反馈MPC**：通过[在线优化](@entry_id:636729)[反馈增益](@entry_id:271155)，该方法能够更好地适应系统的具体状态，从而减少保守性。它提供了一个在性能和计算复杂度之间的良好折衷，其复杂度通常是[预测时域](@entry_id:261473)的多项式函数。

-   **多阶段MPC**：这是性能最好但计算成本最高的方法。通过在场景树上进行规划，它能够利用在[预测时域](@entry_id:261473)内揭示的扰动信息，从而显著降低保守性。然而，其计算量随[预测时域](@entry_id:261473)呈[指数增长](@entry_id:141869)，使其仅适用于短时域或慢动态系统。

总的来说，从[管束](@entry_id:148450)MPC到多阶段MPC，我们看到了一个清晰的谱系：随着控制器在线利用更多关于不确定性实现的信息，其保守性降低，但计算复杂度急剧增加。为特定问题选择合适的RMPC方法是现代控制工程中的一项关键设计决策。