{"hands_on_practices": [{"introduction": "本练习将单传感器更新的场景，推广到更贴近实际的多传感器融合问题。通过从线性最小均方误差 (LMMSE) 估计的第一性原理出发，为堆叠的测量值推导更新方程，您将巩固对卡尔曼滤波器如何最优地组合来自独立信息源以提高估计精度的理解。该实践对于导航、机器人和集成传感系统等应用至关重要。[@problem_id:2753313]", "problem": "考虑一个线性高斯状态估计问题中卡尔曼滤波器的单次测量更新步骤。设先验状态被建模为一个随机向量 $x \\in \\mathbb{R}^{2}$，其先验均值为 $\\hat{x}^{-} \\in \\mathbb{R}^{2}$，先验协方差为 $P \\in \\mathbb{R}^{2 \\times 2}$。根据以下线性模型同时获得两个独立的测量值\n$$\ny_{1} = H_{1} x + v_{1}, \\quad y_{2} = H_{2} x + v_{2},\n$$\n其中 $H_{1} \\in \\mathbb{R}^{1 \\times 2}$ 和 $H_{2} \\in \\mathbb{R}^{1 \\times 2}$ 是测量矩阵，$v_{1} \\sim \\mathcal{N}(0, R_{1})$ 和 $v_{2} \\sim \\mathcal{N}(0, R_{2})$ 是相互独立的、零均值的高斯噪声，且独立于 $x$，其协方差分别为 $R_{1} \\in \\mathbb{R}$ 和 $R_{2} \\in \\mathbb{R}$。将测量值堆叠为 $y = \\begin{bmatrix} y_{1} \\\\ y_{2} \\end{bmatrix}$，并有相应的堆叠测量矩阵 $H \\in \\mathbb{R}^{2 \\times 2}$ 和块对角噪声协方差 $R \\in \\mathbb{R}^{2 \\times 2}$。仅使用联合高斯变量的线性最小均方误差（LMMSE）估计的基本原理——即正交性原理和条件高斯性质——推导联合最优线性更新的表达式 $ \\hat{x}^{+} = \\hat{x}^{-} + K (y - H \\hat{x}^{-})$，确定最优联合卡尔曼增益 $K \\in \\mathbb{R}^{2 \\times 2}$，并推导相应的后验协方差 $P^{+} \\in \\mathbb{R}^{2 \\times 2}$（用 $P$、$H$ 和 $R$ 表示）。\n\n然后，针对以下具体数值情况评估这些表达式\n$$\nP = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix}, \\quad H_{1} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad R_{1} = 1, \\quad H_{2} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}, \\quad R_{2} = 4,\n$$\n已知 $v_{1}$ 和 $v_{2}$ 相互独立，并且独立于 $x$。计算此数值实例的联合卡尔曼增益 $K$ 和后验协方差 $P^{+}$。\n\n你最终报告的答案必须是单个标量：后验协方差 $P^{+}$ 的行列式。不需要四舍五入。", "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n- 状态向量：$x \\in \\mathbb{R}^{2}$\n- 先验状态估计：$\\hat{x}^{-} \\in \\mathbb{R}^{2}$\n- 先验协方差：$P \\in \\mathbb{R}^{2 \\times 2}$\n- 测量模型：$y_{1} = H_{1} x + v_{1}$ 和 $y_{2} = H_{2} x + v_{2}$\n- 测量矩阵：$H_{1} \\in \\mathbb{R}^{1 \\times 2}$，$H_{2} \\in \\mathbb{R}^{1 \\times 2}$\n- 测量噪声：$v_{1} \\sim \\mathcal{N}(0, R_{1})$，$v_{2} \\sim \\mathcal{N}(0, R_{2})$，其中 $R_1, R_2 \\in \\mathbb{R}$\n- 噪声属性：$v_{1}$ 和 $v_{2}$ 相互独立、零均值、高斯分布，并且独立于 $x$。\n- 堆叠模型：$y = \\begin{bmatrix} y_{1} \\\\ y_{2} \\end{bmatrix}$，$H = \\begin{bmatrix} H_{1} \\\\ H_{2} \\end{bmatrix}$，$R$ 是一个块对角噪声协方差矩阵。\n- 后验估计形式：$ \\hat{x}^{+} = \\hat{x}^{-} + K (y - H \\hat{x}^{-})$\n- 目标1（推导）：根据LMMSE原理推导最优联合卡尔曼增益 $K \\in \\mathbb{R}^{2 \\times 2}$ 和后验协方差 $P^{+} \\in \\mathbb{R}^{2 \\times 2}$。\n- 目标2（计算）：对情况 $P = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix}$，$H_{1} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$，$R_{1} = 1$，$H_{2} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}$，$R_{2} = 4$ 进行评估。\n- 最终答案：计算 $\\det(P^{+})$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是线性估计理论中的一个标准问题。问题定义明确，为获得唯一解提供了所有必要的数据和定义。语言客观、精确。问题表述没有违反任何数学或物理学的基本原理。所提供的数值是一致且有效的（例如，协方差矩阵是对称半正定的，方差是非负的）。\n\n**步骤3：结论与行动**\n该问题有效。将提供解答。\n\n**卡尔曼滤波器更新方程的推导**\n\n给定一个具有联合高斯变量的线性系统。状态 $x$ 的先验分布均值为 $\\mathbb{E}[x] = \\hat{x}^{-}$，协方差为 $\\text{cov}(x) = P$。测量模型被堆叠成一个单一的方程：\n$$y = Hx + v$$\n其中 $y = \\begin{bmatrix} y_1 \\\\ y_2 \\end{bmatrix}$，$H = \\begin{bmatrix} H_1 \\\\ H_2 \\end{bmatrix}$，以及 $v = \\begin{bmatrix} v_1 \\\\ v_2 \\end{bmatrix}$。噪声 $v$ 是零均值的，$\\mathbb{E}[v] = 0$，其协方差为 $R = \\mathbb{E}[vv^T]$。由于 $v_1$ 和 $v_2$ 是独立的，$R$ 是块对角矩阵：\n$$R = \\begin{bmatrix} R_1 & 0 \\\\ 0 & R_2 \\end{bmatrix}$$\n噪声 $v$ 独立于状态 $x$。在给定测量值 $y$ 的情况下，$x$ 的最优LMMSE估计，记为 $\\hat{x}^{+}$，是条件均值 $\\mathbb{E}[x|y]$。问题指定了线性估计器的形式：\n$$\\hat{x}^{+} = \\hat{x}^{-} + K(y - H\\hat{x}^{-})$$\n向量 $\\tilde{y} = y - H\\hat{x}^{-}$ 是测量新息。最优增益矩阵 $K$ 是通过应用正交性原理求得的，该原理指出后验估计误差 $e^{+} = x - \\hat{x}^{+}$ 必须与新息 $\\tilde{y}$ 正交。\n$$\\mathbb{E}[e^{+} \\tilde{y}^T] = 0$$\n首先，让我们用先验误差 $e^{-} = x - \\hat{x}^{-}$ 和噪声 $v$ 来表示误差 $e^{+}$ 和新息 $\\tilde{y}$。\n新息为：\n$$\\tilde{y} = y - H\\hat{x}^{-} = (Hx + v) - H\\hat{x}^{-} = H(x - \\hat{x}^{-}) + v = He^{-} + v$$\n后验误差为：\n$$e^{+} = x - \\hat{x}^{+} = x - (\\hat{x}^{-} + K\\tilde{y}) = (x - \\hat{x}^{-}) - K\\tilde{y} = e^{-} - K(He^{-} + v) = (I - KH)e^{-} - Kv$$\n现在，应用正交性条件：\n$$\\mathbb{E}[((I - KH)e^{-} - Kv)(He^{-} + v)^T] = 0$$\n展开表达式：\n$$\\mathbb{E}[(I - KH)e^{-}(e^{-})^T H^T + (I - KH)e^{-}v^T - Kve^{-T}H^T - Kvv^T] = 0$$\n先验误差 $e^{-}$ 均值为零，且与测量噪声 $v$不相关。因此，$\\mathbb{E}[e^{-}v^T] = 0$ 且 $\\mathbb{E}[ve^{-T}] = 0$。协方差为 $\\mathbb{E}[e^{-}(e^{-})^T] = P$ 和 $\\mathbb{E}[vv^T] = R$。方程简化为：\n$$(I - KH)\\mathbb{E}[e^{-}(e^{-})^T]H^T - K\\mathbb{E}[vv^T] = 0$$\n$$(I - KH)PH^T - KR = 0$$\n$$PH^T - K H P H^T - KR = 0$$\n$$PH^T = K(H P H^T + R)$$\n求解增益 $K$，假设新息协方差矩阵 $S = H P H^T + R$ 是可逆的：\n$$K = P H^T (H P H^T + R)^{-1}$$\n这就是最优卡尔曼增益的表达式。\n\n接下来，我们推导后验协方差 $P^{+} = \\mathbb{E}[e^{+}(e^{+})^T]$。\n$$P^{+} = \\mathbb{E}[((I - KH)e^{-} - Kv)((I - KH)e^{-} - Kv)^T]$$\n展开并利用 $e^{-}$ 和 $v$ 的不相关性：\n$$P^{+} = \\mathbb{E}[(I - KH)e^{-}(e^{-})^T(I - KH)^T] + \\mathbb{E}[Kvv^T K^T]$$\n$$P^{+} = (I - KH) \\mathbb{E}[e^{-}(e^{-})^T] (I - KH)^T + K \\mathbb{E}[vv^T] K^T$$\n$$P^{+} = (I - KH) P (I - KH)^T + K R K^T$$\n这是协方差更新的 Joseph 形式。它可以被简化。\n代入 $KR = PH^T - K H P H^T$：\n$$P^{+} = P - KHP - PH^T(I-KH)^T + K R K^T = P - KHP - PH^T + PH^T H^T K^T + KRK^T$$\n这不是最直接的路径。相反，我们用另一种方式代入增益方程来简化 Joseph 形式。\n$K(HPH^T + R) = PH^T \\implies K(HPH^T + R)K^T = PH^T K^T$。\n$K H P H^T K^T + K R K^T = P H^T K^T$。\n将 $K R K^T = P H^T K^T - K H P H^T K^T$ 代入 Joseph 形式：\n$$P^{+} = (I - KH)P(I - KH)^T + P H^T K^T - K H P H^T K^T$$\n$$P^{+} = (P-KHP)(I-H^T K^T) + P H^T K^T - K H P H^T K^T$$\n$$P^{+} = P - PH^T K^T - KHP + KHP H^T K^T + P H^T K^T - K H P H^T K^T$$\n各项相消，剩下：\n$$P^{+} = P - KHP$$\n这可以因式分解为：\n$$P^{+} = (I - KH)P$$\n这就是所求的后验协方差表达式。\n\n**数值计算**\n\n给定具体数值：\n$$P = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix}, \\quad H_{1} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad R_{1} = 1, \\quad H_{2} = \\begin{bmatrix} 0 & 1 \\end{bmatrix}, \\quad R_{2} = 4$$\n首先，我们构造堆叠的测量矩阵 $H$ 和堆叠的噪声协方差矩阵 $R$：\n$$H = \\begin{bmatrix} H_1 \\\\ H_2 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} = I_2$$\n$$R = \\begin{bmatrix} R_1 & 0 \\\\ 0 & R_2 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix}$$\n现在，我们计算卡尔曼增益 $K = P H^T (H P H^T + R)^{-1}$。\n由于 $H = I_2$，这简化为 $K = P (P + R)^{-1}$。\n新息协方差 $S = P+R$ 是：\n$$S = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} + \\begin{bmatrix} 1 & 0 \\\\ 0 & 4 \\end{bmatrix} = \\begin{bmatrix} 4 & 0 \\\\ 0 & 6 \\end{bmatrix}$$\n$S$ 的逆是：\n$$S^{-1} = \\begin{bmatrix} 4 & 0 \\\\ 0 & 6 \\end{bmatrix}^{-1} = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{6} \\end{bmatrix}$$\n现在我们计算卡尔曼增益 $K$：\n$$K = P S^{-1} = \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{1}{6} \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{2}{6} \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{1}{3} \\end{bmatrix}$$\n接下来，我们计算后验协方差 $P^{+} = (I - KH)P$。\n由于 $H = I_2$，这等于 $P^{+} = (I - K)P$。\n$$I - K = \\begin{bmatrix} 1 & 0 \\\\ 0 & 1 \\end{bmatrix} - \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{1}{3} \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{3}{4} & 0 \\\\ 0 & 1 - \\frac{1}{3} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{2}{3} \\end{bmatrix}$$\n$$P^{+} = (I - K)P = \\begin{bmatrix} \\frac{1}{4} & 0 \\\\ 0 & \\frac{2}{3} \\end{bmatrix} \\begin{bmatrix} 3 & 0 \\\\ 0 & 2 \\end{bmatrix} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}$$\n后验协方差矩阵是 $P^{+} = \\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}$。\n\n问题要求计算后验协方差的行列式，$\\det(P^{+})$。\n由于 $P^{+}$ 是一个对角矩阵，其行列式是对角元素的乘积。\n$$\\det(P^{+}) = \\det\\left(\\begin{bmatrix} \\frac{3}{4} & 0 \\\\ 0 & \\frac{4}{3} \\end{bmatrix}\\right) = \\left(\\frac{3}{4}\\right) \\times \\left(\\frac{4}{3}\\right) = 1$$\n行列式恰好为 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2753313"}, {"introduction": "一个功能正常的卡尔曼滤波器依赖于能检测性 (detectability) 这一基本系统属性。本问题挑战您通过分析一个具有不稳定、不可观测模式的系统，来探索当此条件被违反时会发生什么。通过推导出发散的协方差递归，您将对为何能检测性是滤波器稳定性的一个不可或缺的前提，获得深刻而实践性的理解。[@problem_id:2753278]", "problem": "考虑离散时间线性时不变 (LTI) 随机状态空间模型\n$$\nx_{k+1} = A x_{k} + w_{k}, \\quad y_{k} = H x_{k} + v_{k},\n$$\n其中 $x_{k} \\in \\mathbb{R}^{2}$，$y_{k} \\in \\mathbb{R}$，并且\n$$\nA = \\begin{pmatrix} \\tfrac{3}{2} & 0 \\\\ 0 & \\tfrac{1}{2} \\end{pmatrix}, \\quad H = \\begin{pmatrix} 0 & 1 \\end{pmatrix}.\n$$\n假设过程噪声 $w_{k} \\sim \\mathcal{N}(0,Q)$，其中 $Q = \\operatorname{diag}(1,1)$，测量噪声 $v_{k} \\sim \\mathcal{N}(0,R)$，其中 $R = 1$。假设 $w_{k}$ 和 $v_{k}$ 相互独立且在时间上独立，并且先验是高斯的，即 $x_{0} \\sim \\mathcal{N}(\\hat{x}_{0|0}, P_{0|0})$，其中 $P_{0|0} = I_{2}$。\n\n仅使用线性高斯模型的基本性质、贝叶斯法则以及全期望和全协方差定律（不先验地假设任何卡尔曼滤波器的特定公式），完成以下任务：\n\n1) 使用离散时间系统的可观测性和可检测性的定义，论证系统对 $(A,H)$ 是否是可检测的。您的论证必须明确指出任何不可观测的特征模态，并将其特征值的模与 $1$ 进行比较。\n\n2) 从模型所蕴含的联合高斯结构以及条件均值和协方差的定义出发，推导状态估计误差协方差的预测和更新递推式，并将其具体化到给定的 $(A,H,Q,R)$。证明对于这些数据，协方差递推沿坐标轴解耦，并且第一坐标的协方差不受测量更新的影响。\n\n3) 求解第一坐标后验协方差 $P_{11,k|k}$ 的标量递推式，并将其表示为离散时间索引 $k \\in \\mathbb{N}$ 的闭式解，给定 $P_{11,0|0} = 1$。\n\n提供 $P_{11,k|k}$ 的精确、简化的解析表达式作为您的最终答案。无需四舍五入。将协方差视为无单位量。", "solution": "在尝试任何解答之前，首先评估问题陈述的有效性。给定一个离散时间 LTI 随机状态空间模型：\n$x_{k+1} = A x_{k} + w_{k}$\n$y_{k} = H x_{k} + v_{k}$\n其中 $x_{k} \\in \\mathbb{R}^{2}$，$y_{k} \\in \\mathbb{R}$。矩阵和噪声统计数据如下：\n$A = \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix}$，$H = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$。\n过程噪声 $w_{k} \\sim \\mathcal{N}(0,Q)$，其中 $Q = \\operatorname{diag}(1,1) = I_{2}$。\n测量噪声 $v_{k} \\sim \\mathcal{N}(0,R)$，其中 $R = 1$。\n噪声 $w_k$ 和 $v_k$ 是独立的白噪声。\n先验为 $x_{0} \\sim \\mathcal{N}(\\hat{x}_{0|0}, P_{0|0})$，其中 $P_{0|0} = I_{2}$。\n\n该问题具有科学依据，提法恰当且客观。这是一个线性系统理论和状态估计领域的标准练习，要求从基本原理出发进行推导。所有必要信息均已提供，问题内部一致且无歧义。因此，我们着手进行解答。\n\n1) 可检测性分析\n当且仅当所有不可观测模态都是稳定的，离散时间线性时不变系统才被定义为可检测的。如果一个模态的相关特征值的模小于 $1$，则该模态是稳定的。我们首先确定系统对 $(A,H)$ 的不可观测子空间。\n对于状态维度 $n=2$ 的系统，其可观测性矩阵为 $\\mathcal{O} = \\begin{pmatrix} H \\\\ HA \\end{pmatrix}$。\n我们计算乘积 $HA$：\n$$ HA = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{1}{2} \\end{pmatrix} $$\n可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} 0 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} $$\n$\\mathcal{O}$ 的秩为 $1$，小于状态维度 $n=2$。因此，该系统是不可观测的。\n不可观测子空间是 $\\mathcal{O}$ 的零空间。设 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 是该子空间中的一个向量。条件 $\\mathcal{O}v = 0$ 意味着：\n$$ \\begin{pmatrix} 0 & 1 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} v_2 \\\\ \\frac{1}{2}v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies v_2 = 0 $$\n零空间由向量 $e_1 = \\begin{pmatrix} 1 & 0 \\end{pmatrix}^T$ 张成，它对应于第一个状态变量 $x_{1,k}$。这就是不可观测子空间。\n\n接下来，我们识别与该子空间相关的模态。如果一个模态对应的特征向量位于不可观测子空间内，则该模态是不可观测的。矩阵 $A$ 是对角的，所以其特征向量是标准基向量。与不可观测子空间相关的特征向量是 $e_1$。我们检验其对应的特征值：\n$$ A e_1 = \\begin{pmatrix} \\frac{3}{2} & 0 \\\\ 0 & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{3}{2} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n这个不可观测模态的特征值为 $\\lambda_1 = \\frac{3}{2}$。对于离散时间系统，如果一个模态的特征值的模大于或等于 $1$，则该模态是不稳定的。此处，$|\\lambda_1| = |\\frac{3}{2}| > 1$。\n由于系统存在一个不稳定的不可观测模态，因此系统对 $(A,H)$ 是不可检测的。\n\n2) 协方差递推式的推导\n我们从第一性原理出发，推导状态估计误差协方差 $P_{k|k} = E[(x_k - \\hat{x}_{k|k})(x_k - \\hat{x}_{k|k})^T]$ 的预测和更新方程。\n\n预测步骤：在时间 $k+1$ 的先验协方差为 $P_{k+1|k} = E[(x_{k+1} - \\hat{x}_{k+1|k})(x_{k+1} - \\hat{x}_{k+1|k})^T]$。预测误差为 $x_{k+1} - \\hat{x}_{k+1|k} = (A x_k + w_k) - A \\hat{x}_{k|k} = A(x_k - \\hat{x}_{k|k}) + w_k$。\n$$ P_{k+1|k} = E[ (A(x_k - \\hat{x}_{k|k}) + w_k) (A(x_k - \\hat{x}_{k|k}) + w_k)^T ] $$\n交叉项 $E[A(x_k - \\hat{x}_{k|k})w_k^T]$ 为零，因为误差 $x_k - \\hat{x}_{k|k}$ 是直到时间 $k$ 的信息的函数，而 $w_k$ 与过去无关。因此：\n$$ P_{k+1|k} = A E[(x_k - \\hat{x}_{k|k})(x_k - \\hat{x}_{k|k})^T] A^T + E[w_k w_k^T] = A P_{k|k} A^T + Q $$\n\n更新步骤：更新依赖于联合高斯分布的性质。在给定过去数据的条件下，预测状态 $x_{k+1}$ 和新测量值 $y_{k+1}$ 是联合高斯的。后验协方差 $P_{k+1|k+1}$ 由条件高斯分布的标准公式给出：\n$P_{k+1|k+1} = \\Sigma_{xx} - \\Sigma_{xy} \\Sigma_{yy}^{-1} \\Sigma_{yx}$，其中 $\\Sigma_{xx} = P_{k+1|k}$，$\\Sigma_{xy} = P_{k+1|k}H^T$，以及 $\\Sigma_{yy} = HP_{k+1|k}H^T + R$。\n$$ P_{k+1|k+1} = P_{k+1|k} - P_{k+1|k} H^T (H P_{k+1|k} H^T + R)^{-1} H P_{k+1|k} $$\n\n具体到给定系统：由于 $A$ 和 $Q$ 是对角矩阵，且初始协方差 $P_{0|0}=I_2$ 也是对角的，因此对于所有 $k \\ge 0$，协方差矩阵 $P_{k|k}$ 和 $P_{k+1|k}$ 始终保持对角。设 $P_{k|k} = \\text{diag}(P_{11,k|k}, P_{22,k|k})$。\n预测递推式为：\n$$ P_{k+1|k} = \\begin{pmatrix} \\frac{9}{4} & 0 \\\\ 0 & \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} P_{11,k|k} & 0 \\\\ 0 & P_{22,k|k} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{9}{4}P_{11,k|k} + 1 & 0 \\\\ 0 & \\frac{1}{4}P_{22,k|k} + 1 \\end{pmatrix} $$\n对于更新步骤，我们计算卡尔曼增益的各分量。新息协方差 $S_{k+1} = H P_{k+1|k} H^T + R$ 为：\n$$ S_{k+1} = \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + 1 = P_{22,k+1|k} + 1 $$\n卡尔曼增益为 $K_{k+1} = P_{k+1|k} H^T S_{k+1}^{-1}$：\n$$ K_{k+1} = \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} (P_{22,k+1|k} + 1)^{-1} = \\begin{pmatrix} 0 \\\\ \\frac{P_{22,k+1|k}}{P_{22,k+1|k} + 1} \\end{pmatrix} $$\n$P_{k+1|k+1} = (I - K_{k+1}H)P_{k+1|k}$ 的更新方程为：\n$$ P_{k+1|k+1} = \\left( I_2 - \\begin{pmatrix} 0 \\\\ \\frac{P_{22,k+1|k}}{P_{22,k+1|k} + 1} \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\end{pmatrix} \\right) P_{k+1|k} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1-\\frac{P_{22,k+1|k}}{P_{22,k+1|k}+1} \\end{pmatrix} P_{k+1|k} $$\n$$ P_{k+1|k+1} = \\begin{pmatrix} 1 & 0 \\\\ 0 & \\frac{1}{P_{22,k+1|k}+1} \\end{pmatrix} \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & P_{22,k+1|k} \\end{pmatrix} = \\begin{pmatrix} P_{11,k+1|k} & 0 \\\\ 0 & \\frac{P_{22,k+1|k}}{P_{22,k+1|k}+1} \\end{pmatrix} $$\n这表明协方差递推是解耦的。第一坐标的协方差不受测量更新的影响（$P_{11,k+1|k+1} = P_{11,k+1|k}$），因为 $H$ 只提供关于第二状态的信息。这直接对应于第一状态的不可观测性。\n\n3) $P_{11,k|k}$ 的闭式解\n我们必须求解第一坐标后验协方差的标量递推式。结合预测和更新步骤中关于 $(1,1)$ 分量的结果，可得：\n$$ P_{11,k+1|k+1} = P_{11,k+1|k} = \\frac{9}{4} P_{11,k|k} + 1 $$\n令 $p_k = P_{11,k|k}$。递推关系为 $p_{k+1} = \\frac{9}{4} p_k + 1$，初始条件为 $p_0 = P_{11,0|0} = 1$。\n这是一个线性一阶非齐次递推关系。其解是特解与齐次方程解的和。\n齐次解为 $p_h(k) = C(\\frac{9}{4})^k$。\n对于特解，我们假设一个常数 $p^*$，即不动点：\n$$ p^* = \\frac{9}{4} p^* + 1 \\implies (1 - \\frac{9}{4})p^* = 1 \\implies -\\frac{5}{4}p^* = 1 \\implies p^* = -\\frac{4}{5} $$\n通解为 $p_k = C(\\frac{9}{4})^k - \\frac{4}{5}$。\n我们使用初始条件 $p_0 = 1$ 来求常数 $C$：\n$$ p_0 = 1 = C \\left(\\frac{9}{4}\\right)^0 - \\frac{4}{5} = C - \\frac{4}{5} \\implies C = 1 + \\frac{4}{5} = \\frac{9}{5} $$\n将 $C$ 代回，得到 $P_{11,k|k}$ 的闭式表达式为：\n$$ P_{11,k|k} = \\frac{9}{5} \\left(\\frac{9}{4}\\right)^k - \\frac{4}{5} $$\n该方差呈指数增长，这与相关状态由噪声驱动、不稳定且不可观测的事实相符。", "answer": "$$\\boxed{\\frac{9}{5} \\left(\\frac{9}{4}\\right)^{k} - \\frac{4}{5}}$$", "id": "2753278"}, {"introduction": "在现实世界的应用中，卡尔曼滤波器中使用的模型绝非完美。本练习聚焦于一个常见且关键的问题：对过程噪声的低估，这会导致滤波器“过度自信”和糟糕的跟踪性能。通过分析其对滤波器延迟和新息统计特性的影响，您将培养出调整滤波器和确保其统计一致性所必需的关键诊断技能。[@problem_id:2753317]", "problem": "考虑一个离散时间线性时不变系统，其具有由未建模加速度驱动的恒速运动学状态，通过含噪声的位置测量进行观测。其状态和测量模型为\n$$\n\\mathbf{x}_{k+1} = \\mathbf{F}\\,\\mathbf{x}_{k} + \\mathbf{w}_{k}, \\quad \\mathbf{z}_{k} = \\mathbf{H}\\,\\mathbf{x}_{k} + \\mathbf{v}_{k},\n$$\n其中 $\\mathbf{x}_{k} \\in \\mathbb{R}^{2}$ 堆叠了位置和速度，$\\mathbf{z}_{k} \\in \\mathbb{R}$ 是位置测量值，$\\mathbf{F} = \\begin{bmatrix} 1 & T \\\\ 0 & 1 \\end{bmatrix}$，采样周期 $T>0$，$\\mathbf{H} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$，$\\mathbf{w}_{k} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{Q}_{\\text{true}})$ 代表驱动运动学的白噪声加速度的影响，$\\mathbf{v}_{k} \\sim \\mathcal{N}(0,R)$ 是测量噪声，其方差 $R>0$ 已知。假设 $\\mathbf{w}_{k}$ 和 $\\mathbf{v}_{k}$ 相互独立，在时间上独立，且与初始状态独立。\n\n一位实践者实现了一个线性高斯卡尔曼滤波器，使用了与上述相同的 $\\mathbf{F}$ 和 $\\mathbf{H}$ 以及正确的 $R$，但低估了过程噪声协方差，使用了 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$，其中 $0<\\alpha<1$。令 $\\widehat{\\mathbf{x}}_{k|k-1}$ 和 $\\widehat{\\mathbf{x}}_{k|k}$ 分别表示先验和后验估计，定义新息为 $\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1}$，其预测新息协方差为 $S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$，其中 $\\mathbf{P}_{k|k-1}$ 是由滤波器计算的先验误差协方差。归一化新息平方 (NIS) 为 $\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$，在正确建模的情况下，其理论均值等于测量维度，即 $\\mathbb{E}[\\epsilon_{k}] = 1$。\n\n仅使用线性高斯卡尔曼滤波器的基本性质（状态空间模型、预测和更新递归、以及新息定义），推理分析相对于真实的未建模动态低估 $\\mathbf{Q}$ 如何影响滤波器的响应性以及新息统计量。选择在此场景下所有必须成立的陈述，尤其是在真实运动表现出持续加速从而违反恒速假设的时期。\n\nA. 滤波器对状态真实变化的响应表现出更大的滞后，因为当假定的 $\\mathbf{Q}$ 减小时，卡尔曼增益会减小。\n\nB. 新息的样本方差变得小于预测的 $S_{k}$，因此归一化新息平方倾向于小于其理论均值。\n\nC. 在机动期间，新息序列在时间上变为正相关，违反了白噪声假设。\n\nD. 滤波器过分看重测量值（卡尔曼增益更大），减少了滞后，但增加了对测量噪声的敏感度。\n\nE. 对于 $\\mathbf{Q}$ 的足够严重的低估，滤波器会变得统计上不一致，其平均归一化新息平方会超过其理论均值。", "solution": "用户提供了一个关于当过程噪声协方差被低估时卡尔曼滤波器行为的问题。我将首先验证问题陈述，然后进行严谨的推导和选项评估。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   离散时间线性时不变系统模型：\n    -   状态模型：$\\mathbf{x}_{k+1} = \\mathbf{F}\\,\\mathbf{x}_{k} + \\mathbf{w}_{k}$\n    -   测量模型：$\\mathbf{z}_{k} = \\mathbf{H}\\,\\mathbf{x}_{k} + \\mathbf{v}_{k}$\n-   状态向量 $\\mathbf{x}_{k} \\in \\mathbb{R}^{2}$ （位置，速度）。\n-   测量值 $\\mathbf{z}_{k} \\in \\mathbb{R}$ （位置）。\n-   状态转移矩阵：$\\mathbf{F} = \\begin{bmatrix} 1 & T \\\\ 0 & 1 \\end{bmatrix}$，采样周期 $T>0$。\n-   测量矩阵：$\\mathbf{H} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$。\n-   真实过程噪声：$\\mathbf{w}_{k} \\sim \\mathcal{N}(\\mathbf{0},\\mathbf{Q}_{\\text{true}})$，代表白噪声加速度。\n-   测量噪声：$\\mathbf{v}_{k} \\sim \\mathcal{N}(0,R)$，已知方差 $R>0$。\n-   噪声属性：$\\mathbf{w}_{k}$、$\\mathbf{v}_{k}$ 是零均值、相互独立、在时间上独立，并且与初始状态独立。\n-   卡尔曼滤波器实现细节：\n    -   使用正确的 $\\mathbf{F}$、$\\mathbf{H}$ 和 $R$。\n    -   使用一个假定的过程噪声协方差 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$，其中 $0<\\alpha<1$。\n-   定义：\n    -   新息：$\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1}$。\n    -   滤波器计算的（预测的）新息协方差：$S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$。\n    -   归一化新息平方 (NIS)：$\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$。\n    -   在正确建模下 NIS 的理论均值：$\\mathbb{E}[\\epsilon_{k}] = 1$。\n-   场景：分析应考虑滤波器性能，特别是在持续加速期间，此时违反了滤波器底层的恒速运动模型。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，是适定且客观的。它描述了估计理论中的一个典型问题：对不匹配的卡尔曼滤波器进行分析。该系统模型是一个标准的恒速模型，而对新息的分析（特别是 NIS 及其白噪声特性）是诊断滤波器性能和一致性的基本技术。低估过程噪声（$\\mathbf{Q}_{\\text{assumed}} < \\mathbf{Q}_{\\text{true}}$）的前提是一个常见的实际问题，会导致已被充分理解的、非平凡的后果。问题陈述不含科学或逻辑上的缺陷，对于定性分析是完整的，并且与指定主题直接相关。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。将推导解答。\n\n### 推导与选项分析\n\n问题的核心是在卡尔曼滤波器递归中使用 $\\mathbf{Q}_{\\text{assumed}} = \\alpha\\,\\mathbf{Q}_{\\text{true}}$（其中 $0 < \\alpha < 1$）所带来的后果。让我们用不带上标的符号表示滤波器计算的量，用带上标 `true` 的符号表示真实的潜在量。\n\n卡尔曼滤波器的协方差预测（时间更新）为：\n$$\n\\mathbf{P}_{k|k-1} = \\mathbf{F}\\,\\mathbf{P}_{k-1|k-1}\\,\\mathbf{F}^{\\top} + \\mathbf{Q}_{\\text{assumed}}\n$$\n由于 $\\mathbf{Q}_{\\text{assumed}}$ 小于真实的协方差 $\\mathbf{Q}_{\\text{true}}$，滤波器计算出的先验协方差 $\\mathbf{P}_{k|k-1}$ 将会是对真实先验误差协方差 $\\mathbf{P}^{\\text{true}}_{k|k-1} = \\mathbb{E}[(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})^{\\top}]$ 的一个低估。滤波器对其模型预测变得过于自信，认为状态不确定性比实际要小。\n\n让我们分析其对卡尔曼增益 $\\mathbf{K}_{k}$ 的影响：\n$$\n\\mathbf{K}_{k} = \\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top}\\,S_{k}^{-1} = \\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top}\\,(\\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R)^{-1}\n$$\n卡尔曼增益平衡了模型预测的不确定性（由 $\\mathbf{P}_{k|k-1}$ 代表）和测量的不确定性（由 $R$ 代表）。因为滤波器计算的 $\\mathbf{P}_{k|k-1}$ 人为地变小了，滤波器会低估测量的贡献。一个较小的 $\\mathbf{P}_{k|k-1}$ 会导致一个较小的卡尔曼增益 $\\mathbf{K}_{k}$。在一个简化的标量类比中，增益为 $P/(P+R)$，减小 $P$ 明显会减小增益。这个原理对矩阵情况同样适用。滤波器过于相信自己（有缺陷的）模型，而对输入的测量值信任不足。\n\n现在我们来评估每个陈述。\n\n**A. 滤波器对状态真实变化的响应表现出更大的滞后，因为当假定的 Q 减小时，卡尔曼增益会减小。**\n状态更新为 $\\widehat{\\mathbf{x}}_{k|k} = \\widehat{\\mathbf{x}}_{k|k-1} + \\mathbf{K}_{k}\\,\\tilde{y}_{k}$。如前所述，低估 $\\mathbf{Q}$ 会导致卡尔曼增益 $\\mathbf{K}_{k}$ 变小。在机动（持续加速）期间，真实状态 $\\mathbf{x}_{k}$ 会偏离恒速预测 $\\widehat{\\mathbf{x}}_{k|k-1}$。这会产生一个大的、系统性的新息 $\\tilde{y}_{k}$。然而，由于 $\\mathbf{K}_{k}$ 很小，应用于状态估计的修正量也很小。滤波器在融合来自测量的新信息时很慢，无法及时跟踪机动。这种行为被描述为增大的滞后。该陈述中提供的推理完全正确。\n**结论：正确。**\n\n**B. 新息的样本方差变得小于预测的 $S_{k}$，因此归一化新息平方倾向于小于其理论均值。**\n新息为 $\\tilde{y}_{k} = \\mathbf{z}_{k} - \\mathbf{H}\\,\\widehat{\\mathbf{x}}_{k|k-1} = \\mathbf{H}(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1}) + \\mathbf{v}_{k}$。真实新息将比预期要大，因为模型误差 $(\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1})$ 大于滤波器协方差 $\\mathbf{P}_{k|k-1}$ 所隐含的误差。因此，新息的真实方差 $S^{\\text{true}}_{k} = \\mathbb{E}[\\tilde{y}_{k}^{2}]$ 将大于滤波器预测的方差 $S_{k} = \\mathbf{H}\\,\\mathbf{P}_{k|k-1}\\,\\mathbf{H}^{\\top} + R$。作为 $S^{\\text{true}}_{k}$ 的估计，新息的样本方差因此会*大于* $S_{k}$。这使得平均归一化新息平方 (NIS)，即 $\\mathbb{E}[\\tilde{y}_{k}^{2}/S_{k}] = S^{\\text{true}}_{k}/S_{k}$，大于 1。该陈述声称的正好相反。\n**结论：不正确。**\n\n**C. 在机动期间，新息序列在时间上变为正相关，违反了白噪声假设。**\n一个正确建模的卡尔曼滤波器会产生一个零均值、白色（不相关）的新息序列。在这个问题中，模型是不正确的，尤其是在持续机动期间。该滤波器由于其低增益，会持续滞后于真实轨迹。这意味着在时刻 $k$ 的估计误差没有被完全修正。因此，时刻 $k+1$ 的误差将与时刻 $k$ 的误差相关。由于新息 $\\tilde{y}_k$ 是先验估计误差 $\\mathbf{x}_{k} - \\widehat{\\mathbf{x}}_{k|k-1}$ 的直接反映，状态估计中一个系统性的、缓慢修正的误差将导致一个系统性的、在时间上相关的新息序列。具体来说，持续的滞后将导致 $\\tilde{y}_k$ 和 $\\tilde{y}_{k+1}$ 具有相同的符号，表明存在时间上的正相关。这违反了白噪声特性，而白噪声特性是模型不匹配的一个关键指标。\n**结论：正确。**\n\n**D. 滤波器过分看重测量值（卡尔曼增益更大），减少了滞后，但增加了对测量噪声的敏感度。**\n该陈述描述的是过程噪声 $\\mathbf{Q}$ 被*高估*时滤波器的行为。高估 $\\mathbf{Q}$ 会导致滤波器不信任其模型，从而产生大的 $\\mathbf{P}_{k|k-1}$、大的卡尔曼增益 $\\mathbf{K}_{k}$，以及对测量值的严重依赖。这与问题中描述的场景正好相反。低估 $\\mathbf{Q}$ 会导致*更小*的增益和*更大*的滞后。\n**结论：不正确。**\n\n**E. 对于 Q 的足够严重的低估，滤波器会变得统计上不一致，其平均归一化新息平方会超过其理论均值。**\n统计一致性意味着滤波器自身对其不确定性的评估是正确的。对此的一个关键检验是 NIS 检验。NIS 为 $\\epsilon_{k} = \\tilde{y}_{k}^{2}/S_{k}$。其理论期望是测量的维度，在本例中为 1。而实际期望是 $\\mathbb{E}[\\epsilon_{k}] = \\mathbb{E}[\\tilde{y}_{k}^{2}]/S_{k} = S^{\\text{true}}_{k}/S_k$。如在选项 B 的分析中所确立的，低估 $\\mathbf{Q}$ 会导致滤波器低估其预测误差，因此 $S_{k} < S^{\\text{true}}_{k}$。这直接意味着 $\\mathbb{E}[\\epsilon_{k}] > 1$。平均 NIS 与其理论均值的持续偏离即为统计不一致性的定义。因此，该陈述是正确的。\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "2753317"}]}