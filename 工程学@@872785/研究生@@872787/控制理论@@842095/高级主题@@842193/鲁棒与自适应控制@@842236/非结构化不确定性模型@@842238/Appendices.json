{"hands_on_practices": [{"introduction": "选择一个合适的不确定性模型是鲁棒控制分析中的关键第一步。不同的模型结构，例如加性不确定性与乘性不确定性，即使基于相同的原始模型误差数据进行校准，也可能得出关于系统鲁棒性截然不同的结论。本练习 [@problem_id:2757047] 提供了一个具体的数值算例，通过分析一个具有轻阻尼特性的系统，清晰地揭示了这一重要概念，展示了乘性模型在某些情况下如何能够提供一个比加性模型远不保守的鲁棒性保证。", "problem": "考虑单输入单输出标称对象 $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1\\,s + 1}$，其具有弱阻尼复极点，与静态控制器 $K(s) = 2$ 构成单位负反馈。假设在谐振频率 $\\omega_{0} = 1$ rad/s 处的频率响应测试产生一个单一的原始误差数据点：此频率下的加性模型误差幅值为 $|E(\\mathrm{j}\\omega_{0})| = 1$。仅使用此数据点，定义两个恒定的非结构化不确定性权重，它们对在 $\\omega_{0}$ 处的相同原始误差数据点进行插值：\n- 加性权重 $W_{a}(s) \\equiv 1$，满足 $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$。\n- (输出)乘性权重 $W_{m}(s) \\equiv \\rho_{0}$，其中 $\\rho_{0}$ 是在 $\\omega_{0}$ 处的相对误差，由 $\\rho_{0} = \\dfrac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|}$ 给出。\n\n使用小增益定理以及标准的灵敏度函数和补灵敏度函数定义，\n$$\nS(s) = \\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1}, \n\\qquad\nT(s) = P_{0}(s)K(s)\\,\\bigl(1 + P_{0}(s)K(s)\\bigr)^{-1},\n$$\n来构建逐频率的鲁棒稳定性保证：\n- 对于加性对象不确定性 $P(s) = P_{0}(s) + W_{a}(s)\\Delta_{a}(s)$，其中 $\\|\\Delta_{a}\\|_{\\infty} \\leq 1$，在频率 $\\omega$ 处的充分小增益条件为 $|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)| \\le 1$。\n- 对于(输出)乘性对象不确定性 $P(s) = \\bigl(1 + W_{m}(s)\\Delta_{m}(s)\\bigr)P_{0}(s)$，其中 $\\|\\Delta_{m}\\|_{\\infty} \\leq 1$，在频率 $\\omega$ 处的充分小增益条件为 $|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)| \\le 1$。\n\n为了基于相同的原始误差数据点获得一个具体、独立的对比示例，请在频率集合 $\\Omega = \\{\\omega_{0}, \\infty\\}$ 上评估这些小增益不等式。对此回路而言，该集合捕捉了谐振时 $|T|$ 的峰值以及高频时 $|K S|$ 的峰值。在此频率集合上，定义原始误差数据点的最大允许均匀缩放因子 $\\sigma_{a}$ 和 $\\sigma_{m}$，使得相应的不等式对所有 $\\omega \\in \\Omega$ 均成立：\n- 加性模型：对所有 $\\omega \\in \\Omega$，$\\sigma_{a}\\,|W_{a}(\\mathrm{j}\\omega)\\,K(\\mathrm{j}\\omega)\\,S(\\mathrm{j}\\omega)| \\le 1$。\n- 乘性模型：对所有 $\\omega \\in \\Omega$，$\\sigma_{m}\\,|W_{m}(\\mathrm{j}\\omega)\\,T(\\mathrm{j}\\omega)| \\le 1$。\n\n计算比率\n$$\nR \\;=\\; \\frac{\\sigma_{m}}{\\sigma_{a}}\n$$\n的精确值。无需四舍五入；请以精确解析形式给出您的答案，不带单位。", "solution": "所述问题提法恰当、内部一致，并基于鲁棒控制理论的既定原理，具有科学依据。我们可以直接进行计算。\n\n标称对象由传递函数 $P_{0}(s) = \\dfrac{1}{s^{2} + 0.1s + 1}$ 给出。控制器是一个静态增益 $K(s) = 2$。分析集中在谐振频率 $\\omega_{0} = 1$ rad/s 上。\n\n首先，我们计算标称对象在 $s = \\mathrm{j}\\omega_{0} = \\mathrm{j}1$ 处的频率响应：\n$$\nP_{0}(\\mathrm{j}1) = \\frac{1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1} = \\frac{1}{-1 + 0.1\\mathrm{j} + 1} = \\frac{1}{0.1\\mathrm{j}} = -10\\mathrm{j}\n$$\n其幅值为 $|P_{0}(\\mathrm{j}1)| = |-10\\mathrm{j}| = 10$。\n\n问题陈述了在该频率下有一个单一的误差数据点 $|E(\\mathrm{j}\\omega_{0})| = 1$。该数据点用于定义不确定性权重。\n加性权重为 $W_{a}(s) \\equiv 1$，这与条件 $|W_{a}(\\mathrm{j}\\omega_{0})| = |E(\\mathrm{j}\\omega_{0})|$ 一致，因为 $|1| = 1$。\n乘性权重是一个常数 $W_{m}(s) \\equiv \\rho_{0}$，其中 $\\rho_{0}$ 是在 $\\omega_{0}$ 处的相对误差：\n$$\n\\rho_{0} = \\frac{|E(\\mathrm{j}\\omega_{0})|}{|P_{0}(\\mathrm{j}\\omega_{0})|} = \\frac{1}{10} = 0.1\n$$\n因此，$W_{m}(s) \\equiv 0.1$。\n\n接下来，我们确定灵敏度函数 $S(s)$ 和补灵敏度函数 $T(s)$。回路传递函数为 $L_{0}(s) = P_{0}(s)K(s) = \\dfrac{2}{s^{2} + 0.1s + 1}$。\n$$\nS(s) = \\bigl(1 + L_{0}(s)\\bigr)^{-1} = \\left(1 + \\frac{2}{s^{2} + 0.1s + 1}\\right)^{-1} = \\left(\\frac{s^{2} + 0.1s + 3}{s^{2} + 0.1s + 1}\\right)^{-1} = \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3}\n$$\n$$\nT(s) = L_{0}(s)S(s) = \\frac{2}{s^{2} + 0.1s + 1} \\cdot \\frac{s^{2} + 0.1s + 1}{s^{2} + 0.1s + 3} = \\frac{2}{s^{2} + 0.1s + 3}\n$$\n鲁棒稳定性条件必须在频率集合 $\\Omega = \\{\\omega_{0}, \\infty\\} = \\{1, \\infty\\}$ 上进行评估。\n\n对于加性不确定性模型，条件为 $\\sigma_{a} |W_{a}(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)S(\\mathrm{j}\\omega)| \\le 1$。由于 $W_{a}(s) \\equiv 1$ 且 $K(s) = 2$，这变为 $\\sigma_{a} |2S(\\mathrm{j}\\omega)| \\le 1$。最大允许的 $\\sigma_{a}$ 由下式给出：\n$$\n\\sigma_{a} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |2S(\\mathrm{j}\\omega)|}\n$$\n我们计算 $|2S(\\mathrm{j}\\omega)|$ 在 $\\omega=1$ 和 $\\omega \\to \\infty$ 时的值。\n在 $\\omega = 1$ 时：\n$$\n|2S(\\mathrm{j}1)| = \\left|2 \\frac{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 1}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|2 \\frac{-1 + 0.1\\mathrm{j} + 1}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2\\mathrm{j}}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\n当 $\\omega \\to \\infty$ 时：\n$$\n\\lim_{\\omega \\to \\infty} |2S(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|2 \\frac{-\\omega^2 + 0.1\\mathrm{j}\\omega + 1}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = \\left|2 \\cdot \\lim_{\\omega \\to \\infty} \\frac{-\\omega^2}{-\\omega^2}\\right| = |2 \\cdot 1| = 2\n$$\n最大值为 $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 2\\right\\} = 2$。因此，$\\sigma_{a} = \\dfrac{1}{2}$。\n\n对于乘性不确定性模型，条件为 $\\sigma_{m} |W_{m}(\\mathrm{j}\\omega)T(\\mathrm{j}\\omega)| \\le 1$。由于 $W_{m}(s) \\equiv 0.1$，这变为 $\\sigma_{m} |0.1T(\\mathrm{j}\\omega)| \\le 1$。最大允许的 $\\sigma_{m}$ 由下式给出：\n$$\n\\sigma_{m} = \\frac{1}{\\max_{\\omega \\in \\{1, \\infty\\}} |0.1T(\\mathrm{j}\\omega)|}\n$$\n我们计算 $|0.1T(\\mathrm{j}\\omega)|$ 在 $\\omega=1$ 和 $\\omega \\to \\infty$ 时的值。\n在 $\\omega = 1$ 时：\n$$\n|0.1T(\\mathrm{j}1)| = \\left|0.1 \\frac{2}{(\\mathrm{j}1)^{2} + 0.1(\\mathrm{j}1) + 3}\\right| = \\left|\\frac{0.2}{-1 + 0.1\\mathrm{j} + 3}\\right| = \\left|\\frac{0.2}{2 + 0.1\\mathrm{j}}\\right| = \\frac{0.2}{\\sqrt{2^2 + (0.1)^2}} = \\frac{0.2}{\\sqrt{4.01}} = \\frac{2}{\\sqrt{401}}\n$$\n当 $\\omega \\to \\infty$ 时：\n$$\n\\lim_{\\omega \\to \\infty} |0.1T(\\mathrm{j}\\omega)| = \\lim_{\\omega \\to \\infty} \\left|0.1 \\frac{2}{-\\omega^2 + 0.1\\mathrm{j}\\omega + 3}\\right| = 0.1 \\cdot \\lim_{\\omega \\to \\infty} \\frac{2}{\\omega^2} = 0\n$$\n最大值为 $\\max\\left\\{\\dfrac{2}{\\sqrt{401}}, 0\\right\\} = \\dfrac{2}{\\sqrt{401}}$。因此，$\\sigma_{m} = \\dfrac{1}{2/\\sqrt{401}} = \\dfrac{\\sqrt{401}}{2}$。\n\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\sigma_{m}}{\\sigma_{a}} = \\frac{\\sqrt{401}/2}{1/2} = \\sqrt{401}\n$$\n这个结果表明，基于同一个单一的原始误差测量值，不确定性模型结构的选择（加性与乘性）会导致关于不确定性允许大小的结论截然不同。具体而言，乘性模型表明对于不确定性权重的整体缩放有更大的容忍度。", "answer": "$$\n\\boxed{\\sqrt{401}}\n$$", "id": "2757047"}, {"introduction": "在上一练习所揭示的见解基础上，我们将分析从单个频率点扩展到整个频域的完整计算流程。本练习 [@problem_id:2757100] 要求你编写代码，基于“真实”对象和标称模型之间的经验数据，对加性与乘性不确定性模型进行系统性的比较。这项任务旨在培养实施鲁棒性分析的实践技能，并学习如何量化地判断哪种模型结构能为给定的建模误差提供更“紧凑”或更有效的表示。", "problem": "给定连续时间、单输入单输出系统在哈代空间无穷范数（$\\mathcal{H}_\\infty$）下的非结构化不确定性的频域公式。对于一个由稳定控制器 $K(s)$ 控制的标称对象 $G(s)$，定义灵敏度函数 $S(s) = (1 + G(s)K(s))^{-1}$ 和补灵敏度函数 $T(s) = G(s)K(s)(1 + G(s)K(s))^{-1}$。考虑两种带加权函数的非结构化不确定性模型：权重为 $W_a(s)$ 的加性不确定性和权重为 $W_m(s)$ 的乘性不确定性。对于从真实对象 $P(s)$ 和标称对象 $G(s)$ 计算出的经验模型误差数据，使用 $\\mathcal{H}_\\infty$ 范数 $\\|W_a S K\\|_\\infty$ 和 $\\|W_m T\\|_\\infty$ 来构建小增益鲁棒性条件。任务是，对于指定的有理模板 $W_{a0}(s)$ 和 $W_{m0}(s)$，计算能作为经验误差数据上界的最小非负缩放因子 $\\alpha_a$ 和 $\\alpha_m$，然后评估缩放后的鲁棒性度量 $\\mu_a = \\alpha_a \\|W_{a0} S K\\|_\\infty$ 和 $\\mu_m = \\alpha_m \\|W_{m0} T\\|_\\infty$。\n\n使用以下基本定义：\n- 加性不确定性模型：$P(s) = G(s) + W_a(s)\\Delta_a(s)$，其中 $\\|\\Delta_a\\|_\\infty \\leq 1$。鲁棒稳定的小增益充分条件是 $\\|W_a S K\\|_\\infty  1$。\n- 乘性不确定性模型：$P(s) = G(s)\\big(1 + W_m(s)\\Delta_m(s)\\big)$，其中 $\\|\\Delta_m\\|_\\infty \\leq 1$。鲁棒稳定的小增益充分条件是 $\\|W_m T\\|_\\infty  1$。\n- 单输入单输出传递函数 $H(s)$ 的哈代空间无穷范数（$\\mathcal{H}_\\infty$ 范数）为 $\\|H\\|_\\infty = \\sup_{\\omega \\in \\mathbb{R}} |H(\\mathrm{j}\\omega)|$。\n\n你的程序必须：\n- 在区间 $[10^{-2}, 10^{3}]$ 内以对数方式采样频率 $\\omega$（单位：弧度/秒），共计 $N = 2000$ 个点。\n- 对每个测试用例，根据 $P$ 和 $G$ 计算经验误差数据：\n  - 加性误差 $E_a(\\mathrm{j}\\omega) = P(\\mathrm{j}\\omega) - G(\\mathrm{j}\\omega)$。\n  - 乘性误差 $E_m(\\mathrm{j}\\omega) = \\dfrac{P(\\mathrm{j}\\omega) - G(\\mathrm{j}\\omega)}{G(\\mathrm{j}\\omega)}$。\n- 给定权重模板 $W_{a0}(s)$ 和 $W_{m0}(s)$，计算在所有采样频率上能作为经验误差上界的最小非负缩放因子 $\\alpha_a$ 和 $\\alpha_m$：\n  - $\\alpha_a = \\sup_{\\omega} \\dfrac{|E_a(\\mathrm{j}\\omega)|}{|W_{a0}(\\mathrm{j}\\omega)|}$。\n  - $\\alpha_m = \\sup_{\\omega} \\dfrac{|E_m(\\mathrm{j}\\omega)|}{|W_{m0}(\\mathrm{j}\\omega)|}$。\n- 根据 $G$ 和 $K$ 计算闭环函数：\n  - $S(\\mathrm{j}\\omega) = \\dfrac{1}{1 + G(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)}$。\n  - $T(\\mathrm{j}\\omega) = \\dfrac{G(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)}{1 + G(\\mathrm{j}\\omega)K(\\mathrm{j}\\omega)}$。\n- 使用离散上确界近似来评估缩放后的 $\\mathcal{H}_\\infty$ 鲁棒性度量：\n  - $\\mu_a = \\alpha_a \\cdot \\sup_{\\omega} |W_{a0}(\\mathrm{j}\\omega) S(\\mathrm{j}\\omega) K(\\mathrm{j}\\omega)|$。\n  - $\\mu_m = \\alpha_m \\cdot \\sup_{\\omega} |W_{m0}(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|$。\n- 判定哪个模型对相同的经验模型误差数据产生更紧的界：即 $\\mu_a$ 和 $\\mu_m$ 中值较小的那个模型。使用相等容差 $\\varepsilon = 10^{-6}$，如果 $|\\mu_a - \\mu_m| \\le \\varepsilon$，则判定为相等。\n\n角度和频率必须分别以弧度和弧度/秒表示和解释。\n\n测试套件。使用以下三个测试用例，每个用例都由 $G(s)$、$P(s)$、$K(s)$、$W_{a0}(s)$ 和 $W_{m0}(s)$ 的真有理实系数传递函数定义。每个传递函数由其分子和分母多项式给出，系数按 $s$ 的降幂排列。\n\n- 测试用例 1 (一般情况)：\n  - $G(s) = \\dfrac{1}{s + 1}$，即，分子 [1]，分母 [1, 1]。\n  - $P(s) = \\dfrac{0.2 s + 1}{s + 1.5}$，即，分子 [0.2, 1]，分母 [1, 1.5]。\n  - $K(s) = 5$，即，分子 [5]，分母 [1]。\n  - $W_{a0}(s) = 0.1 \\dfrac{s + 1}{s + 10}$，即，分子 [0.1, 0.1]，分母 [1, 10]。\n  - $W_{m0}(s) = 0.2 \\dfrac{s + 0.5}{s + 5}$，即，分子 [0.2, 0.1]，分母 [1, 5]。\n\n- 测试用例 2 (更宽带宽的模板和二阶标称模型)：\n  - $G(s) = \\dfrac{2}{s^{2} + 0.2 s + 2}$，即，分子 [2]，分母 [1, 0.2, 2]。\n  - $P(s) = \\dfrac{2.2}{s^{2} + 0.4 s + 1.8}$，即，分子 [2.2]，分母 [1, 0.4, 1.8]。\n  - $K(s) = 1.5 \\dfrac{s + 1}{s + 5}$，即，分子 [1.5, 1.5]，分母 [1, 5]。\n  - $W_{a0}(s) = 0.05 \\dfrac{0.5 s + 1}{0.05 s + 1}$，即，分子 [0.025, 0.05]，分母 [0.05, 1]。\n  - $W_{m0}(s) = 0.15 \\dfrac{\\tfrac{1}{3} s + 1}{\\tfrac{1}{30} s + 1}$，即，分子 [0.05, 0.15]，分母 [1/30.0, 1]。\n\n- 测试用例 3 (近似相等的整形)：\n  - $G(s) = \\dfrac{0.5 s + 1}{s^{2} + 1.5 s + 1}$，即，分子 [0.5, 1]，分母 [1, 1.5, 1]。\n  - $P(s) = \\dfrac{0.55 s + 1}{s^{2} + 1.2 s + 1.1}$，即，分子 [0.55, 1]，分母 [1, 1.2, 1.1]。\n  - $K(s) = 3$，即，分子 [3]，分母 [1]。\n  - $W_{a0}(s) = 0.08 \\dfrac{s + 0.2}{s + 2}$，即，分子 [0.08, 0.016]，分母 [1, 2]。\n  - $W_{m0}(s) = 0.12 \\dfrac{s + 0.1}{s + 1}$，即，分子 [0.12, 0.012]，分母 [1, 1]。\n\n对于每个测试用例，按所述方法计算 $\\mu_a$ 和 $\\mu_m$，然后判定哪个模型更紧。最终输出必须为单行，包含一个含三个列表的列表，每个内部列表对应一个测试用例，包含三个条目：浮点数值 $\\mu_a$ 和 $\\mu_m$，以及一个整数指示符 $b$。如果 $\\mu_a  \\mu_m - \\varepsilon$，则 $b=1$；如果 $\\mu_m  \\mu_a - \\varepsilon$，则 $b=0$；否则 $b=-1$。其中 $\\varepsilon = 10^{-6}$。最后一行必须采用以下格式：\n`[$[ \\mu_{a,1}, \\mu_{m,1}, b_1 ],[ \\mu_{a,2}, \\mu_{m,2}, b_2 ],[ \\mu_{a,3}, \\mu_{m,3}, b_3 ]$]`", "solution": "所提出的问题是鲁棒控制理论中一个明确定义的练习，特别是关于非结构化不确定性模型的分析和比较。任务是量化两种标准模型——加性不确定性和乘性不确定性——在表示标称对象模型 $G(s)$ 和真实对象 $P(s)$ 之间测量到的差异方面的适用性。分析在频域中进行，采用哈代空间无穷范数 ($\\mathcal{H}_{\\infty}$) 框架，最终比较源自小增益定理的鲁棒性裕度。该问题在科学上是合理的，逻辑上是一致的，并为其解决提供了所有必要的数据和程序。\n\n基本原理是刻画作为频率函数的模型误差，然后找到一个简单的加权不确定性模型来“覆盖”这个误差。目标是找到能覆盖误差的最小模型，然后评估在该不确定性下闭环系统的鲁棒稳定性。\n\n让我们定义标称对象 $G(s)$、真实对象 $P(s)$、控制器 $K(s)$ 以及不确定性加权模板 $W_{a0}(s)$ 和 $W_{m0}(s)$ 的有理传递函数。所有函数都在频域中通过代入 $s = \\mathrm{j}\\omega$ 进行评估，其中 $\\mathrm{j} = \\sqrt{-1}$，$\\omega$ 是角频率，单位为弧度/秒。\n\n第一步是以加性和乘性两种形式量化经验建模误差。\n加性误差定义为真实对象响应与标称对象响应之间的直接差值：\n$$E_a(\\mathrm{j}\\omega) = P(\\mathrm{j}\\omega) - G(\\mathrm{j}\\omega)$$\n乘性误差定义为相对差值：\n$$E_m(\\mathrm{j}\\omega) = \\frac{P(\\mathrm{j}\\omega) - G(\\mathrm{j}\\omega)}{G(\\mathrm{j}\\omega)}$$\n只要对于任何 $\\omega$ 都有 $G(\\mathrm{j}\\omega) \\neq 0$，这个定义就是明确的，对于给定的测试用例，该条件成立。\n\n下一步是使用不确定性加权函数来拟合这些经验误差曲线。不确定性模型由 $W_a(s)\\Delta_a(s)$ 和 $W_m(s)\\Delta_m(s)$ 给出，其中 $\\|\\Delta_a\\|_{\\infty} \\le 1$ 和 $\\|\\Delta_m\\|_{\\infty} \\le 1$。为了使模型成为误差的有效表示，加权函数的幅值必须在所有频率上都大于等于经验误差的幅值。我们使用缩放后的模板 $W_a(s) = \\alpha_a W_{a0}(s)$ 和 $W_m(s) = \\alpha_m W_{m0}(s)$，其中 $\\alpha_a$ 和 $\\alpha_m$ 是满足以下边界条件的最小非负标量：\n$$|E_a(\\mathrm{j}\\omega)| \\le |\\alpha_a W_{a0}(\\mathrm{j}\\omega)| \\quad \\forall \\omega$$\n$$|E_m(\\mathrm{j}\\omega)| \\le |\\alpha_m W_{m0}(\\mathrm{j}\\omega)| \\quad \\forall \\omega$$\n为了找到最小的缩放因子，我们重新整理这些不等式，并对所有频率取上确界：\n$$\\alpha_a = \\sup_{\\omega} \\frac{|E_a(\\mathrm{j}\\omega)|}{|W_{a0}(\\mathrm{j}\\omega)|}$$\n$$\\alpha_m = \\sup_{\\omega} \\frac{|E_m(\\mathrm{j}\\omega)|}{|W_{m0}(\\mathrm{j}\\omega)|}$$\n在数值上，上确界通过在足够密集的离散频率网格 $\\omega_k$ 上取最大值来近似。\n\n在通过 $W_a(s) = \\alpha_a W_{a0}(s)$ 和 $W_m(s) = \\alpha_m W_{m0}(s)$ 量化不确定性模型后，我们应用小增益定理来评估闭环系统的鲁棒稳定性。该定理提供了稳定性的充分条件。对于加性不确定性，条件是 $\\|W_a K S\\|_{\\infty}  1$；对于乘性不确定性，条件是 $\\|W_m T\\|_{\\infty}  1$。函数 $S(s)$ 和 $T(s)$ 分别是灵敏度函数和补灵敏度函数：\n$$S(s) = \\frac{1}{1 + G(s)K(s)}$$\n$$T(s) = \\frac{G(s)K(s)}{1 + G(s)K(s)}$$\n待计算的量 $\\mu_a$ 和 $\\mu_m$ 是这些不等式左边的值。它们代表缩放后的 $\\mathcal{H}_{\\infty}$ 范数，并作为鲁棒性指标。小于 1 的值表示在导出的不确定性模型下，鲁棒稳定性得到保证。\n$$\\mu_a = \\|W_a K S\\|_{\\infty} = \\|\\alpha_a W_{a0} K S\\|_{\\infty} = \\alpha_a \\cdot \\|W_{a0} K S\\|_{\\infty}$$\n$$\\mu_m = \\|W_m T\\|_{\\infty} = \\|\\alpha_m W_{m0} T\\|_{\\infty} = \\alpha_m \\cdot \\|W_{m0} T\\|_{\\infty}$$\n$\\mathcal{H}_{\\infty}$ 范数同样通过在离散频率网格上取最大幅值来近似：\n$$\\mu_a \\approx \\alpha_a \\cdot \\max_k |W_{a0}(\\mathrm{j}\\omega_k) K(\\mathrm{j}\\omega_k) S(\\mathrm{j}\\omega_k)|$$\n$$\\mu_m \\approx \\alpha_m \\cdot \\max_k |W_{m0}(\\mathrm{j}\\omega_k) T(\\mathrm{j}\\omega_k)|$$\n\n最后一步是比较 $\\mu_a$ 和 $\\mu_m$。产生较小 $\\mu$ 值的模型被认为是“更紧”的，因为它对于相同的经验误差数据意味着更大的稳定裕度。比较时使用 $\\varepsilon = 10^{-6}$ 的容差来处理数值误差。根据此比较分配一个整数指示符 $b$：如果加性模型更紧（$\\mu_a  \\mu_m - \\varepsilon$），则 $b=1$；如果乘性模型更紧（$\\mu_m  \\mu_a - \\varepsilon$），则 $b=0$；如果两者相等，则 $b=-1$。\n\n每个测试用例的计算过程包括以下步骤：\n1. 生成一个从 $10^{-2}$ 到 $10^3$ rad/s 的对数间隔频率向量 $\\omega$，包含 $N=2000$ 个点。构建复频率向量 $s = \\mathrm{j}\\omega$。\n2. 在 $s$ 的每个点上评估所有传递函数（$G, P, K, W_{a0}, W_{m0}$）。\n3. 计算误差函数 $E_a$ 和 $E_m$ 的频率响应。\n4. 计算缩放因子 $\\alpha_a$ 和 $\\alpha_m$。\n5. 计算闭环函数 $S$ 和 $T$ 的频率响应。\n6. 计算鲁棒性度量 $\\mu_a$ 和 $\\mu_m$。\n7. 比较 $\\mu_a$ 和 $\\mu_m$ 以确定指示符 $b$。\n对所提供的三个测试用例中的每一个都执行此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the robust control analysis problem for the given test cases.\n    \"\"\"\n\n    def eval_tf(num_coeffs, den_coeffs, s_values):\n        \"\"\"\n        Evaluates a rational transfer function H(s) = num(s) / den(s)\n        for a given array of complex s-values.\n        \n        Args:\n            num_coeffs: Array-like, coefficients of the numerator polynomial.\n            den_coeffs: Array-like, coefficients of the denominator polynomial.\n            s_values: Numpy array of complex numbers where the TF is evaluated.\n        \n        Returns:\n            Numpy array of complex numbers representing the frequency response.\n        \"\"\"\n        num_val = np.polyval(num_coeffs, s_values)\n        den_val = np.polyval(den_coeffs, s_values)\n        # To avoid division by zero, though problem analysis suggests it's not an issue.\n        # Add a small epsilon to den_val where it is zero. This should not happen\n        # for jw-axis evaluation of the given stable/stabilizable systems.\n        den_val[den_val == 0] = 1e-150 \n        return num_val / den_val\n\n    # Define problem constants\n    N = 2000\n    omega = np.logspace(-2, 3, N)\n    s = 1j * omega\n    epsilon = 1e-6\n\n    # Test cases defined by transfer function coefficients (numerator, denominator)\n    test_cases = [\n        # Test case 1\n        {\n            \"G\": (np.array([1.0]), np.array([1.0, 1.0])),\n            \"P\": (np.array([0.2, 1.0]), np.array([1.0, 1.5])),\n            \"K\": (np.array([5.0]), np.array([1.0])),\n            \"Wa0\": (np.array([0.1, 0.1]), np.array([1.0, 10.0])),\n            \"Wm0\": (np.array([0.2, 0.1]), np.array([1.0, 5.0])),\n        },\n        # Test case 2\n        {\n            \"G\": (np.array([2.0]), np.array([1.0, 0.2, 2.0])),\n            \"P\": (np.array([2.2]), np.array([1.0, 0.4, 1.8])),\n            \"K\": (np.array([1.5, 1.5]), np.array([1.0, 5.0])),\n            \"Wa0\": (np.array([0.025, 0.05]), np.array([0.05, 1.0])),\n            \"Wm0\": (np.array([0.05, 0.15]), np.array([1/30.0, 1.0])),\n        },\n        # Test case 3\n        {\n            \"G\": (np.array([0.5, 1.0]), np.array([1.0, 1.5, 1.0])),\n            \"P\": (np.array([0.55, 1.0]), np.array([1.0, 1.2, 1.1])),\n            \"K\": (np.array([3.0]), np.array([1.0])),\n            \"Wa0\": (np.array([0.08, 0.016]), np.array([1.0, 2.0])),\n            \"Wm0\": (np.array([0.12, 0.012]), np.array([1.0, 1.0])),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        # Step B: Evaluate all transfer functions at s = j*omega\n        G_jw = eval_tf(case[\"G\"][0], case[\"G\"][1], s)\n        P_jw = eval_tf(case[\"P\"][0], case[\"P\"][1], s)\n        K_jw = eval_tf(case[\"K\"][0], case[\"K\"][1], s)\n        Wa0_jw = eval_tf(case[\"Wa0\"][0], case[\"Wa0\"][1], s)\n        Wm0_jw = eval_tf(case[\"Wm0\"][0], case[\"Wm0\"][1], s)\n        \n        # Step C: Compute empirical error frequency responses\n        Ea_jw = P_jw - G_jw\n        Em_jw = (P_jw - G_jw) / G_jw\n        \n        # Step D: Compute minimal scaling factors alpha_a and alpha_m\n        alpha_a = np.max(np.abs(Ea_jw) / np.abs(Wa0_jw))\n        alpha_m = np.max(np.abs(Em_jw) / np.abs(Wm0_jw))\n        \n        # Step E: Compute closed-loop functions S and T\n        L_jw = G_jw * K_jw\n        S_jw = 1.0 / (1.0 + L_jw)\n        T_jw = L_jw / (1.0 + L_jw)\n        \n        # Step F: Evaluate robustness measures mu_a and mu_m\n        mu_a = alpha_a * np.max(np.abs(Wa0_jw * S_jw * K_jw))\n        mu_m = alpha_m * np.max(np.abs(Wm0_jw * T_jw))\n        \n        # Step G: Compare measures and determine indicator b\n        if mu_a  mu_m - epsilon:\n            b = 1\n        elif mu_m  mu_a - epsilon:\n            b = 0\n        else:\n            b = -1\n\n        results.append([mu_a, mu_m, b])\n\n    # Final print statement in the exact required format\n    # Using a custom formatter to avoid trailing zeros and ensure readability\n    def format_float(f):\n        return f'{f:.10f}'.rstrip('0').rstrip('.')\n\n    result_str_parts = []\n    for res in results:\n        mu_a_str = format_float(res[0])\n        mu_m_str = format_float(res[1])\n        b_str = str(res[2])\n        result_str_parts.append(f\"[{mu_a_str}, {mu_m_str}, {b_str}]\")\n    \n    final_str = f\"[{','.join(result_str_parts)}]\"\n    print(final_str)\n\nsolve()\n```", "id": "2757100"}, {"introduction": "本节的最终练习将分析与设计融为一体。在学会了如何分析和比较不确定性模型之后，现在的任务是设计一个控制器，主动地管理标称性能与鲁棒稳定性之间的权衡。这项回路成形练习 [@problem_id:2757056] 要求你综合一个控制器，使其同时满足对灵敏度函数 ($S$) 的性能界限和对加权互补灵敏度函数 ($W_m T$) 的鲁棒性界限，从而提供一个完整的设计与验证闭环体验。", "problem": "给定一个单输入单输出（SISO）标称对象模型和一个非结构化乘性输出不确定性权重，以及表示为灵敏度函数和加权补灵敏度函数的无穷范数边界的性能和鲁棒稳定性规范。您的任务是构建一个指定形式的回路成形控制器，计算闭环频率响应，并验证是否满足规范。所有计算都是无量纲的，并且必须以弧度/秒为单位进行。没有物理单位；频率单位为弧度/秒，所有幅值均为无量纲。\n\n背景和使用的定义：\n- 设标称对象表示为 $G(s)$，控制器表示为 $K(s)$。开环传递函数为 $L(s) = G(s)K(s)$。\n- 灵敏度函数为 $S(s) = \\frac{1}{1 + L(s)}$，补灵敏度函数为 $T(s) = \\frac{L(s)}{1 + L(s)}$。\n- 非结构化乘性输出不确定性模型假设实际对象为 $G_{\\text{act}}(s) = G(s) \\left(1 + \\Delta_m(s) W_m(s)\\right)$，其中 $\\Delta_m(s)$ 是稳定的且满足 $\\|\\Delta_m\\|_\\infty \\leq 1$，$W_m(s)$ 是一个已知的稳定加权函数。\n- 源自小增益定理（SGT）的乘性输出不确定性的鲁棒稳定性条件为 $\\|W_m T\\|_\\infty  1$。\n- 标称性能条件指定为 $\\|S\\|_\\infty \\leq M_S$，其中 $M_S > 0$ 为给定值。\n\n要使用的控制器结构：\n- 您必须使用以下形式的回路成形控制器\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f},\n$$\n其中 $k > 0$，$z_g > 0$，$p_g > 0$，以及 $p_f > 0$。\n- 对于选定的目标穿越频率 $\\omega_c > 0$，设置 $z_g = \\omega_c/4$，$p_g = 4 \\omega_c$，以及 $p_f = 50 \\omega_c$。\n- 选择增益 $k$ 以精确满足单位增益穿越条件 $|L(\\mathrm{j}\\omega_c)| = 1$，其中 $L(s) = G(s)K(s)$。\n\n数值评估要求：\n- 通过在对数间隔的频率网格 $\\omega \\in [10^{-3}, 10^{3}]$ 上计算最大幅值来近似无穷范数，该网格至少包含 $N = 2000$ 个点。\n- 对于SISO系统，使用复频率响应的绝对值来计算幅值。也就是说，对于 $S(\\mathrm{j}\\omega)$ 和 $T(\\mathrm{j}\\omega)$，取 $|S(\\mathrm{j}\\omega)|$ 和 $|T(\\mathrm{j}\\omega)|$；对于加权补灵敏度，计算 $|W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|$。\n\n对象、不确定性权重和规范（测试套件）：\n所有系统均为SISO、真分有理且稳定。每个测试用例提供一个标称对象、一个乘性不确定性权重、一个目标穿越频率和一个性能规范 $M_S$。\n\n- 测试用例 1：\n  - 对象：$G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$。\n  - 权重：$W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$。\n  - 目标：$\\omega_{c,1} = 2$。\n  - 性能目标：$M_{S,1} = 2.0$。\n\n- 测试用例 2：\n  - 对象：$G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$。\n  - 权重：$W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$。\n  - 目标：$\\omega_{c,2} = 5$。\n  - 性能目标：$M_{S,2} = 1.5$。\n\n- 测试用例 3：\n  - 对象：$G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$。\n  - 权重：$W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$。\n  - 目标：$\\omega_{c,3} = 2$。\n  - 性能目标：$M_{S,3} = 2.0$。\n\n对于每个测试用例，您必须：\n1. 使用指定的结构和参数化构建 $K(s)$，其中 $z_g = \\omega_c/4$，$p_g = 4\\omega_c$，$p_f = 50\\omega_c$，并选择 $k$ 以使 $|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)| = 1$。\n2. 在指定的频率网格上计算 $S(\\mathrm{j}\\omega)$、$T(\\mathrm{j}\\omega)$，并评估\n   $$\n   \\|S\\|_\\infty \\approx \\max_{\\omega} |S(\\mathrm{j}\\omega)|,\\quad \\|W_m T\\|_\\infty \\approx \\max_{\\omega} |W_m(\\mathrm{j}\\omega) T(\\mathrm{j}\\omega)|.\n   $$\n3. 检查条件：\n   - 标称性能：$\\|S\\|_\\infty \\leq M_S$。\n   - 鲁棒稳定性（乘性不确定性）：$\\|W_m T\\|_\\infty  1$。\n\n要求的最终输出格式：\n- 对于每个测试用例，按顺序 $\\big[\\text{performance\\_ok}, \\text{robust\\_stability\\_ok}\\big]$ 输出一对布尔值。\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来，不含空格，格式如下\n  `[[b_{1,1},b_{1,2}],[b_{2,1},b_{2,2}],[b_{3,1},b_{3,2}]]`\n  其中每个 $b_{i,j}$ 为 $\\text{True}$ 或 $\\text{False}$。", "solution": "所述问题是有效的。这是一个在SISO鲁棒控制系统设计与分析中定义明确的练习，它基于控制理论的基本原理。所有定义、参数和规范都以清晰、一致且科学合理的方式提供，从而能够得出唯一且可验证的解。该方法将涉及为每个指定情况设计一个控制器，然后数值验证其性能是否符合给定标准。\n\n核心任务是为一个标称对象 $G(s)$ 设计一个控制器 $K(s)$，以满足两个条件：\n1. 标称性能（NP）：灵敏度函数 $S(s) = (1+G(s)K(s))^{-1}$ 的无穷范数必须有界。具体来说，$\\|S\\|_\\infty \\le M_S$。\n2. 鲁棒稳定性（RS）：对于一个受乘性输出不确定性 $G_{\\text{act}}(s) = G(s)(1 + \\Delta_m(s)W_m(s))$ 影响的对象，其中 $\\|\\Delta_m\\|_\\infty \\le 1$，闭环系统必须对所有这类不确定性保持稳定。小增益定理为此提供了充分条件：$\\|W_m T\\|_\\infty  1$，其中 $T(s) = G(s)K(s)(1+G(s)K(s))^{-1}$ 是补灵敏度函数，$W_m(s)$ 是不确定性权重。\n\n控制器具有规定的结构：\n$$\nK(s) = k \\cdot \\frac{1 + s/z_g}{1 + s/p_g} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/p_f}\n$$\n参数 $z_g$、$p_g$ 和 $p_f$ 由目标穿越频率 $\\omega_c$ 决定，即 $z_g = \\omega_c/4$，$p_g = 4\\omega_c$，$p_f = 50\\omega_c$。选择增益 $k>0$ 以强制执行单位增益穿越条件 $|G(\\mathrm{j}\\omega_c)K(\\mathrm{j}\\omega_c)| = 1$。\n\n无穷范数通过在离散频率网格 $\\omega \\in [10^{-3}, 10^3]$ rad/s（包含 $N=2000$ 个对数间隔点）上的最大幅值来近似。设 $s = \\mathrm{j}\\omega$。\n\n### 测试用例 1\n\n**给定参数：**\n- 对象：$G_1(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- 权重：$W_{m,1}(s) = 0.2 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- 目标穿越频率：$\\omega_{c,1} = 2.0$ rad/s\n- 性能目标：$M_{S,1} = 2.0$\n\n**控制器设计：**\n控制器参数由 $\\omega_{c,1} = 2.0$ 确定：\n- $z_{g,1} = \\omega_{c,1}/4 = 2.0/4 = 0.5$\n- $p_{g,1} = 4\\omega_{c,1} = 4 \\cdot 2.0 = 8.0$\n- $p_{f,1} = 50\\omega_{c,1} = 50 \\cdot 2.0 = 100.0$\n\n控制器为 $K_1(s) = k_1 \\cdot \\frac{1 + s/0.5}{1 + s/8.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/100.0}$。\n增益 $k_1$ 由条件 $|G_1(\\mathrm{j}2) K_1(\\mathrm{j}2)| = 1$ 求得。设 $K_{1,0}(s) = K_1(s)/k_1$。\n首先，在 $s = \\mathrm{j}\\omega_{c,1} = 2\\mathrm{j}$ 处计算 $G_1(s)$ 和 $K_{1,0}(s)$ 的频率响应。\n$G_1(2\\mathrm{j}) = \\frac{1}{(0.2(2\\mathrm{j}) + 1)(2\\mathrm{j} + 1)} = \\frac{1}{(1 + 0.4\\mathrm{j})(1 + 2\\mathrm{j})} = \\frac{1}{0.2 + 2.4\\mathrm{j}}$。\n其幅值为 $|G_1(2\\mathrm{j})| = \\frac{1}{\\sqrt{0.2^2 + 2.4^2}} = \\frac{1}{\\sqrt{5.8}} \\approx 0.41499$。\n$K_{1,0}(2\\mathrm{j}) = \\frac{1 + 2\\mathrm{j}/0.5}{1 + 2\\mathrm{j}/8.0} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 2\\mathrm{j}/100.0} = \\frac{1 + 4\\mathrm{j}}{1 + 0.25\\mathrm{j}} \\cdot \\frac{1}{2\\mathrm{j}} \\cdot \\frac{1}{1 + 0.02\\mathrm{j}}$。\n其幅值为 $|K_{1,0}(2\\mathrm{j})| = \\frac{\\sqrt{1^2+4^2}}{\\sqrt{1^2+0.25^2}} \\cdot \\frac{1}{2} \\cdot \\frac{1}{\\sqrt{1^2+0.02^2}} = \\frac{\\sqrt{17}}{\\sqrt{1.0625}} \\cdot 0.5 \\cdot \\frac{1}{\\sqrt{1.0004}} \\approx 1.99950$。\n增益 $k_1$ 计算如下：$k_1 = \\frac{1}{|G_1(2\\mathrm{j})| |K_{1,0}(2\\mathrm{j})|} = \\frac{1}{0.41499 \\cdot 1.99950} \\approx \\frac{1}{0.82977} \\approx 1.20516$。\n\n**分析与验证：**\n使用设计的控制器 $K_1(s)$（其中 $k_1 \\approx 1.20516$），我们构建开环传递函数 $L_1(s) = G_1(s)K_1(s)$ 并数值计算其范数。\n- $\\|S_1\\|_\\infty \\approx \\max_{\\omega}|(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 1.488$。\n- $\\|W_{m,1}T_1\\|_\\infty \\approx \\max_{\\omega}|W_{m,1}(\\mathrm{j}\\omega)L_1(\\mathrm{j}\\omega)(1+L_1(\\mathrm{j}\\omega))^{-1}| \\approx 0.584$。\n\n**测试用例 1 的结论：**\n- 标称性能：$\\|S_1\\|_\\infty \\leq M_{S,1}$ 是否成立？$1.488 \\leq 2.0$。成立。\n- 鲁棒稳定性：$\\|W_{m,1}T_1\\|_\\infty  1$ 是否成立？$0.584  1$。成立。\n布尔结果是 $[\\text{True}, \\text{True}]$。\n\n### 测试用例 2\n\n**给定参数：**\n- 对象：$G_2(s) = \\dfrac{3}{(0.5 s + 1)(0.05 s + 1)}$\n- 权重：$W_{m,2}(s) = 0.8 \\cdot \\dfrac{s/5 + 1}{s/50 + 1}$\n- 目标穿越频率：$\\omega_{c,2} = 5.0$ rad/s\n- 性能目标：$M_{S,2} = 1.5$\n\n**控制器设计：**\n控制器参数由 $\\omega_{c,2} = 5.0$ 确定：\n- $z_{g,2} = \\omega_{c,2}/4 = 5.0/4 = 1.25$\n- $p_{g,2} = 4\\omega_{c,2} = 4 \\cdot 5.0 = 20.0$\n- $p_{f,2} = 50\\omega_{c,2} = 50 \\cdot 5.0 = 250.0$\n控制器为 $K_2(s) = k_2 \\cdot \\frac{1 + s/1.25}{1 + s/20.0} \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s/250.0}$。\n增益 $k_2$ 由条件 $|G_2(\\mathrm{j}5) K_2(\\mathrm{j}5)| = 1$ 求得。设 $K_{2,0}(s) = K_2(s)/k_2$。\n在 $s = \\mathrm{j}\\omega_{c,2} = 5\\mathrm{j}$ 处：\n$G_2(5\\mathrm{j}) = \\frac{3}{(0.5(5\\mathrm{j}) + 1)(0.05(5\\mathrm{j}) + 1)} = \\frac{3}{(1 + 2.5\\mathrm{j})(1 + 0.25\\mathrm{j})} = \\frac{3}{0.375 + 2.75\\mathrm{j}}$。\n其幅值为 $|G_2(5\\mathrm{j})| = \\frac{3}{\\sqrt{0.375^2 + 2.75^2}} = \\frac{3}{\\sqrt{7.703125}} \\approx 1.08093$。\n$|K_{2,0}(5\\mathrm{j})| \\approx 0.79980$。\n增益 $k_2$ 计算如下：$k_2 = \\frac{1}{|G_2(5\\mathrm{j})| |K_{2,0}(5\\mathrm{j})|} = \\frac{1}{1.08093 \\cdot 0.79980} \\approx \\frac{1}{0.86453} \\approx 1.15671$。\n\n**分析与验证：**\n使用设计的控制器 $K_2(s)$（其中 $k_2 \\approx 1.15671$）：\n- $\\|S_2\\|_\\infty \\approx \\max_{\\omega}|(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.579$。\n- $\\|W_{m,2}T_2\\|_\\infty \\approx \\max_{\\omega}|W_{m,2}(\\mathrm{j}\\omega)L_2(\\mathrm{j}\\omega)(1+L_2(\\mathrm{j}\\omega))^{-1}| \\approx 1.259$。\n\n**测试用例 2 的结论：**\n- 标称性能：$\\|S_2\\|_\\infty \\leq M_{S,2}$ 是否成立？$1.579 \\leq 1.5$。不成立。\n- 鲁棒稳定性：$\\|W_{m,2}T_2\\|_\\infty  1$ 是否成立？$1.259  1$。不成立。\n布尔结果是 $[\\text{False}, \\text{False}]$。\n\n### 测试用例 3\n\n**给定参数：**\n- 对象：$G_3(s) = \\dfrac{1}{(0.2 s + 1)(s + 1)}$\n- 权重：$W_{m,3}(s) = 1.5 \\cdot \\dfrac{s/3 + 1}{s/30 + 1}$\n- 目标穿越频率：$\\omega_{c,3} = 2.0$ rad/s\n- 性能目标：$M_{S,3} = 2.0$\n\n**控制器设计：**\n对象 $G_3(s)$、穿越频率 $\\omega_{c,3}$ 和性能目标 $M_{S,3}$ 与测试用例 1 完全相同。因此，设计的控制器 $K_3(s)$ 与 $K_1(s)$ 相同，开环 $L_3(s)$ 与 $L_1(s)$ 相同，灵敏度函数 $S_3(s)$ 与 $S_1(s)$ 相同。\n$K_3(s) = K_1(s)$，其中 $k_3 = k_1 \\approx 1.20516$。\n\n**分析与验证：**\n- 由于 $S_3(s) = S_1(s)$，我们有 $\\|S_3\\|_\\infty = \\|S_1\\|_\\infty \\approx 1.488$。\n- 不确定性权重不同：$W_{m,3}(s) = 1.5 \\cdot \\frac{s/3+1}{s/30+1}$。注意 $W_{m,3}(s) = \\frac{1.5}{0.2} W_{m,1}(s) = 7.5 \\cdot W_{m,1}(s)$。\n- 加权补灵敏度检查是针对 $\\|W_{m,3} T_3\\|_\\infty$。由于 $T_3(s) = T_1(s)$，其范数为 $\\|W_{m,3} T_3\\|_\\infty = \\|7.5 \\cdot W_{m,1} T_1\\|_\\infty = 7.5 \\cdot \\|W_{m,1} T_1\\|_\\infty$。\n- 使用案例 1 的结果，$\\|W_{m,3}T_3\\|_\\infty \\approx 7.5 \\cdot 0.584 = 4.38$。\n\n**测试用例 3 的结论：**\n- 标称性能：$\\|S_3\\|_\\infty \\leq M_{S,3}$ 是否成立？$1.488 \\leq 2.0$。成立。\n- 鲁棒稳定性：$\\|W_{m,3}T_3\\|_\\infty  1$ 是否成立？$4.38  1$。不成立。\n布尔结果是 $[\\text{True}, \\text{False}]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the control design and verification problem for three test cases.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 0.2 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n        {\n            \"G_func\": lambda s: 3.0 / ((0.5 * s + 1.0) * (0.05 * s + 1.0)),\n            \"Wm_func\": lambda s: 0.8 * (s / 5.0 + 1.0) / (s / 50.0 + 1.0),\n            \"omega_c\": 5.0,\n            \"M_S\": 1.5,\n        },\n        {\n            \"G_func\": lambda s: 1.0 / ((0.2 * s + 1.0) * (s + 1.0)),\n            \"Wm_func\": lambda s: 1.5 * (s / 3.0 + 1.0) / (s / 30.0 + 1.0),\n            \"omega_c\": 2.0,\n            \"M_S\": 2.0,\n        },\n    ]\n\n    # Frequency grid for numerical evaluation of infinity norms\n    omega = np.logspace(-3, 3, 2000)\n    s = 1j * omega\n\n    results = []\n    for case in test_cases:\n        G_func = case[\"G_func\"]\n        Wm_func = case[\"Wm_func\"]\n        omega_c = case[\"omega_c\"]\n        M_S = case[\"M_S\"]\n\n        # 1. Construct the controller K(s)\n        # Controller parameters based on target crossover frequency\n        z_g = omega_c / 4.0\n        p_g = 4.0 * omega_c\n        p_f = 50.0 * omega_c\n\n        # Function for the controller without the gain k\n        K0_func = lambda s_val: ((1.0 + s_val / z_g) / (1.0 + s_val / p_g)) * \\\n                                (1.0 / s_val) * \\\n                                (1.0 / (1.0 + s_val / p_f))\n\n        # Calculate gain k to satisfy |L(j*omega_c)| = 1\n        s_c = 1j * omega_c\n        G_at_omega_c = G_func(s_c)\n        K0_at_omega_c = K0_func(s_c)\n        \n        # Ensure the magnitude is not zero to avoid division by zero\n        L0_mag_at_omega_c = np.abs(G_at_omega_c * K0_at_omega_c)\n        if L0_mag_at_omega_c  1e-9:\n             # This case should not happen for the given problems\n             k = 0.0\n        else:\n             k = 1.0 / L0_mag_at_omega_c\n\n        # Full controller function\n        K_func = lambda s_val: k * K0_func(s_val)\n\n        # 2. Compute frequency responses and evaluate norms\n        # Evaluate transfer functions over the frequency grid\n        G_s = G_func(s)\n        K_s = K_func(s)\n        L_s = G_s * K_s\n        Wm_s = Wm_func(s)\n\n        # Sensitivity and Complementary Sensitivity functions\n        S_s = 1.0 / (1.0 + L_s)\n        T_s = L_s / (1.0 + L_s)\n\n        # Approximate infinity norms\n        S_inf_norm = np.max(np.abs(S_s))\n        WmT_inf_norm = np.max(np.abs(Wm_s * T_s))\n\n        # 3. Check the conditions\n        performance_ok = S_inf_norm = M_S\n        robust_stability_ok = WmT_inf_norm  1.0\n        \n        # Format the result string for the current case as [Bool,Bool]\n        # str() on a bool produces 'True' or 'False'\n        results.append(f\"[{str(performance_ok)},{str(robust_stability_ok)}]\")\n\n    # Final print statement in the exact required format: [[b1,b2],[b3,b4],...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2757056"}]}