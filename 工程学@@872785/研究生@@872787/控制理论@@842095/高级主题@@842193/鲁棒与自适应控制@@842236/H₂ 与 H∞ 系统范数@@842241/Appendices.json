{"hands_on_practices": [{"introduction": "本练习将引导你完成计算$\\mathcal{H}_2$范数的基本步骤。它将系统的传递函数与其$\\mathcal{H}_2$范数（衡量其脉冲响应的总能量）联系起来。通过解决这个问题 [@problem_id:2711596]，你将练习建立状态空间实现，求解相关的李雅普诺夫方程以获得可控性格拉姆矩阵，并用它来计算范数，从而巩固核心计算流程。", "problem": "考虑一个连续时间、线性时不变 (LTI) 系统的实有理、严格真、单输入单输出 (SISO) 传递函数\n$$\nG(s) \\;=\\; \\frac{k}{(s+a)(s+b)} \\,,\n$$\n其真实参数满足 $a0$，$b0$，$k\\in\\mathbb{R}$，且直接馈通项 $D=0$。$G(s)$ 的极点是单极点且严格位于开放的左半平面，因此该系统是渐近稳定的。\n\n从一个稳定的、严格真的、SISO LTI 系统的平方$\\mathcal{H}_{2}$范数的定义出发，即总脉冲响应能量，\n$$\n\\|G\\|_{2}^{2} \\;=\\; \\int_{0}^{\\infty} |g(t)|^{2}\\,dt \\,,\n$$\n其中 $g(t)$ 是标量脉冲响应，推导 $\\|G\\|_{2}^{2}$ 关于能控性格拉姆矩阵的状态空间表达式，该格拉姆矩阵解一个李雅普诺夫方程。然后，在不引入任何频域积分的情况下，执行以下操作：\n\n1. 为 $G(s)$ 构建一个显式的最小状态空间实现 $(A,B,C,D)$，其中 $D=0$，使用一个对角矩阵 $A$，其对角线上的元素为系统极点。\n2. 推导能控性格拉姆矩阵 $P$ 所满足的连续时间李雅普诺夫方程，并为您选择的实现解析地求解它。\n3. 使用您求解的 $P$ 来评估平方$\\mathcal{H}_{2}$范数 $\\|G\\|_{2}^{2}$，并完全简化该表达式。\n4. 根据您得到的 $\\|G\\|_{2}^{2}$ 的结果，将$\\mathcal{H}_{2}$范数 $\\|G\\|_{2}$ 表示为关于 $a$、$b$ 和 $k$ 的单一闭式解析表达式。\n\n您的最终答案必须是单一的解析表达式。不要引入任何数值近似或四舍五入。", "solution": "所述问题在科学上是合理的、适定的、客观的和完整的。这是线性系统理论中的一个标准问题，没有不一致或缺陷。因此，我们可以开始求解。\n\n一个稳定的、严格真、单输入单输出 (SISO) 线性时不变 (LTI) 系统，其状态空间实现为 $(A, B, C, D=0)$，其平方$\\mathcal{H}_2$范数由其脉冲响应 $g(t)$ 的总能量定义。脉冲响应由 $g(t) = C \\exp(At) B$ 给出，其中 $t \\ge 0$。由于 $g(t)$ 是一个标量，其幅值的平方为 $|g(t)|^2 = g(t)^T g(t)$。\n\n平方$\\mathcal{H}_2$范数可以使用迹算子表示：\n$$\n\\|G\\|_{2}^{2} \\;=\\; \\int_{0}^{\\infty} |g(t)|^{2}\\,dt \\;=\\; \\int_{0}^{\\infty} \\text{Tr}\\left( g(t) g(t)^{T} \\right) dt\n$$\n代入 $g(t)$ 的表达式，我们有：\n$$\n\\|G\\|_{2}^{2} \\;=\\; \\int_{0}^{\\infty} \\text{Tr}\\left( C \\exp(At) B B^{T} \\exp(A^{T}t) C^{T} \\right) dt\n$$\n利用迹的线性和循环性质，我们可以将积分移到内部：\n$$\n\\|G\\|_{2}^{2} \\;=\\; \\text{Tr}\\left( C \\left( \\int_{0}^{\\infty} \\exp(At) B B^{T} \\exp(A^{T}t) dt \\right) C^{T} \\right)\n$$\n积分项是能控性格拉姆矩阵 $P$ 的定义：\n$$\nP \\;=\\; \\int_{0}^{\\infty} \\exp(At) B B^{T} \\exp(A^{T}t) dt\n$$\n这个格拉姆矩阵 $P$ 是连续时间代数李雅普诺夫方程 $AP + PA^{T} + BB^{T} = 0$ 的唯一、对称、半正定解，前提是矩阵 $A$ 是赫尔维茨矩阵（其所有特征值都具有负实部）。题目说明该系统是渐近稳定的，所以这个条件成立。\n因此，平方$\\mathcal{H}_2$范数可以用状态空间矩阵和能控性格拉姆矩阵 $P$ 表示为：\n$$\n\\|G\\|_{2}^{2} \\;=\\; \\text{Tr}\\left( C P C^{T} \\right)\n$$\n对于一个 SISO 系统，$C P C^T$ 是一个标量，所以我们可以写成 $\\|G\\|_{2}^{2} = C P C^{T}$。我们现在按照指定的步骤进行。\n\n1. 构建最小状态空间实现。\n传递函数为 $G(s) = \\frac{k}{(s+a)(s+b)}$。由于在 $s=-a$ 和 $s=-b$ 的极点是单极点，我们必须有 $a \\neq b$。我们进行部分分式展开：\n$$\nG(s) \\;=\\; \\frac{R_1}{s+a} + \\frac{R_2}{s+b}\n$$\n留数计算如下：\n$$\nR_1 \\;=\\; \\lim_{s \\to -a} (s+a) G(s) \\;=\\; \\frac{k}{-a+b} \\;=\\; \\frac{k}{b-a}\n$$\n$$\nR_2 \\;=\\; \\lim_{s \\to -b} (s+b) G(s) \\;=\\; \\frac{k}{-b+a} \\;=\\; \\frac{k}{a-b}\n$$\n这个展开直接导出一个对角（或模态）状态空间实现。我们定义状态空间矩阵 $(A, B, C, D)$ 如下：\n$$\nA = \\begin{pmatrix} -a  0 \\\\ 0  -b \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} R_1  R_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{k}{b-a}  \\frac{k}{a-b} \\end{pmatrix}, \\quad D = 0\n$$\n这个实现是 $n=2$ 阶的，并且是最小的，因为当 $a \\neq b$ 和 $k \\neq 0$ 时，系统是能控且能观的。矩阵 $A$ 是对角矩阵，其对角线上的元素为系统极点，符合要求。\n\n2. 李雅普诺夫方程的推导与求解。\n能控性格拉姆矩阵 $P$ 满足李雅普诺夫方程 $AP + PA^{T} + BB^{T} = 0$。我们代入我们实现中的矩阵。设 $P$ 是一个对称的 $2 \\times 2$ 矩阵：\n$$\nP = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}\n$$\n矩阵 $A$ 是对角矩阵，所以 $A^T=A$。项 $BB^T$ 是：\n$$\nBB^{T} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n李雅普诺夫方程变为：\n$$\n\\begin{pmatrix} -a  0 \\\\ 0  -b \\end{pmatrix} \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix} \\begin{pmatrix} -a  0 \\\\ 0  -b \\end{pmatrix} + \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n进行矩阵乘法得到：\n$$\n\\begin{pmatrix} -ap_{11}  -ap_{12} \\\\ -bp_{12}  -bp_{22} \\end{pmatrix} + \\begin{pmatrix} -ap_{11}  -bp_{12} \\\\ -ap_{12}  -bp_{22} \\end{pmatrix} + \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -2ap_{11} + 1  -(a+b)p_{12} + 1 \\\\ -(a+b)p_{12} + 1  -2bp_{22} + 1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n将各元素置零，得到关于 $P$ 的分量的方程组：\n\\begin{itemize}\n    \\item $ -2ap_{11} + 1 = 0 \\quad \\implies \\quad p_{11} = \\frac{1}{2a} $\n    \\item $ -2bp_{22} + 1 = 0 \\quad \\implies \\quad p_{22} = \\frac{1}{2b} $\n    \\item $ -(a+b)p_{12} + 1 = 0 \\quad \\implies \\quad p_{12} = \\frac{1}{a+b} $\n\\end{itemize}\n因此，能控性格拉姆矩阵为：\n$$\nP = \\begin{pmatrix} \\frac{1}{2a}  \\frac{1}{a+b} \\\\ \\frac{1}{a+b}  \\frac{1}{2b} \\end{pmatrix}\n$$\n\n3. 平方$\\mathcal{H}_2$范数的评估。\n我们现在计算 $\\|G\\|_{2}^{2} = C P C^{T}$：\n$$\n\\|G\\|_{2}^{2} = \\begin{pmatrix} \\frac{k}{b-a}  \\frac{k}{a-b} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2a}  \\frac{1}{a+b} \\\\ \\frac{1}{a+b}  \\frac{1}{2b} \\end{pmatrix} \\begin{pmatrix} \\frac{k}{b-a} \\\\ \\frac{k}{a-b} \\end{pmatrix}\n$$\n我们可以提出标量项：\n$$\nC = \\frac{k}{a-b} \\begin{pmatrix} -1  1 \\end{pmatrix} \\quad \\text{和} \\quad C^{T} = \\frac{k}{a-b} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n\\|G\\|_{2}^{2} = \\frac{k^2}{(a-b)^2} \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2a}  \\frac{1}{a+b} \\\\ \\frac{1}{a+b}  \\frac{1}{2b} \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}\n$$\n让我们评估这个二次型：\n$$\n\\begin{pmatrix} -1  1 \\end{pmatrix} P \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = p_{11} - 2p_{12} + p_{22} = \\frac{1}{2a} - \\frac{2}{a+b} + \\frac{1}{2b}\n$$\n将这些项通分合并：\n$$\n\\frac{b(a+b) - 4ab + a(a+b)}{2ab(a+b)} = \\frac{ab+b^2 - 4ab + a^2+ab}{2ab(a+b)} = \\frac{a^2 - 2ab + b^2}{2ab(a+b)} = \\frac{(a-b)^2}{2ab(a+b)}\n$$\n将此结果代回 $\\|G\\|_{2}^{2}$ 的表达式中：\n$$\n\\|G\\|_{2}^{2} = \\frac{k^2}{(a-b)^2} \\cdot \\frac{(a-b)^2}{2ab(a+b)} = \\frac{k^2}{2ab(a+b)}\n$$\n项 $(a-b)^2$ 被消去，这对于一个在 $a$ 和 $b$ 中应对称的表达式是预期的。\n\n4. $\\mathcal{H}_2$范数。\n$\\mathcal{H}_2$范数是上述表达式的平方根。由于范数必须是非负的，我们取 $k$ 的绝对值：\n$$\n\\|G\\|_{2} = \\sqrt{\\frac{k^2}{2ab(a+b)}} = \\frac{|k|}{\\sqrt{2ab(a+b)}}\n$$\n这是以 $a$，$b$ 和 $k$ 表示的最终闭式表达式。", "answer": "$$\n\\boxed{\\frac{|k|}{\\sqrt{2ab(a+b)}}}\n$$", "id": "2711596"}, {"introduction": "在第一个练习的基础上，本实践引入了范数计算中的一个关键细节。并非所有状态空间表示都适用于此目的，因为内部稳定性是一个关键先决条件。这个问题 [@problem_id:2711598] 阐明了带有隐藏不稳定模式的非最小实现会如何产生误导，并要求你在应用范数公式之前，正确识别系统的稳定、最小子系统。", "problem": "考虑一个连续时间、单输入单输出的线性时不变实现，其状态空间矩阵为\n$$\nA \\;=\\; \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}, \n\\quad B \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \n\\quad C \\;=\\; \\begin{pmatrix} 1  0 \\end{pmatrix}, \n\\quad D \\;=\\; 0.\n$$\n因此，从输入 $u$ 到输出 $y$ 的传递函数是严格真传递函数。请分析该实现所表示的输入-输出映射 $G$ 的哈代空间$\\mathcal{H}_{2}$范数，并强调使用非最小实现时的陷阱。\n\n任务：\n1. 使用能达性和能观性（通过能达性矩阵和能观性矩阵）以及内部稳定性（$A$ 的赫尔维茨性质）的基本定义，确定哪些模式是能达和能观的，以及完整的实现是否是内部稳定的。解释为什么在此示例中，对完整的 $A$ 使用可控性格拉姆矩阵来计算$\\mathcal{H}_{2}$范数的简单尝试可能会失败或产生误导。\n2. 确定与给定输入-输出映射相关的最小（能达且能观）内部稳定实现，并写出其状态空间矩阵。\n3. 从第一性原理出发，推导最小实现的可控性格拉姆矩阵所对应的李雅普诺夫方程（利用赫尔维茨性质证明其解的存在性），求解其闭式解，然后计算由该最小实现所表示的传递函数的 $\\|G\\|_{2}$。将你的最终答案表示为一个精确的实数（不进行四舍五入）。", "solution": "问题陈述经过审阅，被认为是有效的。这是一个线性控制理论中提法得当的问题，展示了一个带有隐藏不稳定模式的非最小实现的经典案例。该问题科学合理、客观，并包含了完整求解所需的所有信息。\n\n现在将按顺序解决这三个任务。\n\n给定的连续时间线性时不变（LTI）系统由以下状态空间实现描述：\n$$\nA \\;=\\; \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix}, \n\\quad B \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \n\\quad C \\;=\\; \\begin{pmatrix} 1  0 \\end{pmatrix}, \n\\quad D \\;=\\; 0.\n$$\n\n**1. 能达性、能观性和稳定性分析**\n\n首先，我们分析该实现的内部稳定性。一个系统是内部稳定的，当且仅当其状态矩阵 $A$ 是赫尔维茨矩阵，即其所有特征值的实部都严格为负。对角矩阵 $A$ 的特征值是其对角元素，$\\lambda_1 = -2$ 和 $\\lambda_2 = 1$。由于 $\\text{Re}(\\lambda_2) = 1  0$，矩阵 $A$ 不是赫尔维茨矩阵。因此，该实现是**非内部稳定的**。\n\n接下来，我们研究能达性。一个实现是能达的，当且仅当其能达性矩阵 $\\mathcal{R}$ 是满秩的。状态维度为 $n=2$。能达性矩阵由 $\\mathcal{R} = \\begin{pmatrix} B  AB \\end{pmatrix}$ 给出。\n$$\nAB = \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathcal{R} = \\begin{pmatrix} 1  -2 \\\\ 0  0 \\end{pmatrix}\n$$\n$\\mathcal{R}$ 的秩为 $1$，小于 $n=2$。因此，该实现是**不能达的**。Popov-Hautus-Belevitch (PHB) 测试可以识别哪个模式是不能达的。一个模式 $\\lambda$ 是能达的，当且仅当 $\\text{rank}\\begin{pmatrix} A - \\lambda I  B \\end{pmatrix} = n$。\n对于 $\\lambda_1 = -2$：$\\text{rank}\\begin{pmatrix} A+2I  B \\end{pmatrix} = \\text{rank}\\begin{pmatrix} -2+2  0  1 \\\\ 0  1+2  0 \\end{pmatrix} = \\text{rank}\\begin{pmatrix} 0  0  1 \\\\ 0  3  0 \\end{pmatrix} = 2$。位于 $\\lambda_1=-2$ 的稳定模式是能达的。\n对于 $\\lambda_2 = 1$：$\\text{rank}\\begin{pmatrix} A-I  B \\end{pmatrix} = \\text{rank}\\begin{pmatrix} -2-1  0  1 \\\\ 0  1-1  0 \\end{pmatrix} = \\text{rank}\\begin{pmatrix} -3  0  1 \\\\ 0  0  0 \\end{pmatrix} = 1$。位于 $\\lambda_2=1$ 的不稳定模式是不能达的。\n\n接下来，我们研究能观性。一个实现是能观的，当且仅当其能观性矩阵 $\\mathcal{O}$ 是满秩的。能观性矩阵由 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$ 给出。\n$$\nCA = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} -2  0 \\end{pmatrix}\n$$\n$$\n\\mathcal{O} = \\begin{pmatrix} 1  0 \\\\ -2  0 \\end{pmatrix}\n$$\n$\\mathcal{O}$ 的秩为 $1$，小于 $n=2$。因此，该实现是**不能观的**。关于能观性的 PHB 测试指出，一个模式 $\\lambda$ 是能观的，当且仅当 $\\text{rank}\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = n$。\n对于 $\\lambda_1 = -2$：$\\text{rank}\\begin{pmatrix} A+2I \\\\ C \\end{pmatrix} = \\text{rank}\\begin{pmatrix} 0  0 \\\\ 0  3 \\\\ 1  0 \\end{pmatrix} = 2$。位于 $\\lambda_1=-2$ 的稳定模式是能观的。\n对于 $\\lambda_2 = 1$：$\\text{rank}\\begin{pmatrix} A-I \\\\ C \\end{pmatrix} = \\text{rank}\\begin{pmatrix} -3  0 \\\\ 0  0 \\\\ 1  0 \\end{pmatrix} = 1$。位于 $\\lambda_2=1$ 的不稳定模式是不能观的。\n\n对于这个实现，简单地计算$\\mathcal{H}_2$范数的陷阱如下。$\\mathcal{H}_2$范数从根本上是为**稳定**系统定义的。对于一个稳定的系统 $(A, B, C, D)$，其中 $A$ 是赫尔维茨矩阵，可控性格拉姆矩阵 $P_c$ 由收敛积分定义：\n$$\nP_c = \\int_{0}^{\\infty} \\exp(At) B B^T \\exp(A^T t) \\, dt\n$$\n该格拉姆矩阵是代数李雅普诺夫方程 $AP_c + P_cA^T + BB^T = 0$ 的唯一半正定解。然后$\\mathcal{H}_2$范数为 $\\|G\\|_2^2 = \\text{Tr}(CP_cC^T)$。在给定的问题中，$A$ 不是赫尔维茨矩阵，因此定义 $P_c$ 的积分是发散的。因此，可控性格拉姆矩阵在标准意义下对该系统没有定义，因此，根据第一性原理，$\\mathcal{H}_2$范数对这个不稳定的实现也没有定义。尽管代数李雅普诺夫方程可能拥有唯一解（在本例中确实如此，因为对于所有 $i,j$，$\\lambda_i(A)+\\lambda_j(A) \\neq 0$），但在范数公式中使用此解是一个无效的过程。该过程之所以意外地给出了*传递函数*的正确范数，仅仅是因为不稳定模式既不能达也不能观，意味着它与输入-输出映射解耦，并在传递函数中被消去。在一般的不稳定系统中，这种盲目计算会产生一个无意义的有限数，或者李雅普诺夫方程的解甚至不是半正定的，而这是格拉姆矩阵的一个必要属性。\n\n**2. 最小内部稳定实现**\n\n为了找到最小实现，我们首先计算传递函数 $G(s) = C(sI-A)^{-1}B+D$。\n$$\nG(s) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\left( s \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} -2  0 \\\\ 0  1 \\end{pmatrix} \\right)^{-1} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nG(s) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} s+2  0 \\\\ 0  s-1 \\end{pmatrix}^{-1} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s+2}  0 \\\\ 0  \\frac{1}{s-1} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nG(s) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s+2} \\\\ 0 \\end{pmatrix} = \\frac{1}{s+2}\n$$\n与不稳定模式相关的极点 $s=1$ 被消去了，因为它既不能达也不能观。输入-输出映射由稳定的一阶传递函数 $G(s) = \\frac{1}{s+2}$ 描述。\n\n最小实现是系统的能达且能观部分，它对应于这个传递函数。对于一个标量传递函数 $G(s) = \\frac{b}{s-a}$，一个最小实现是 $(A_{min}, B_{min}, C_{min}, D_{min}) = (a, k, b/k, 0)$，其中 $k \\neq 0$。对于 $G(s) = \\frac{1}{s+2}$，我们有 $a=-2$ 和 $b=1$。一个规范的选择是设 $k=1$。因此，最小实现是：\n$$\nA_{min} = -2, \\quad B_{min} = 1, \\quad C_{min} = 1, \\quad D_{min} = 0\n$$\n该实现是最小的（对于一阶传递函数来说是一阶的），并且是内部稳定的，因为其唯一的特征值是 $-2  0$。\n\n**3. $\\mathcal{H}_2$范数计算**\n\n我们现在使用最小的、内部稳定的实现 $(A_{min}, B_{min}, C_{min})$ 来计算$\\mathcal{H}_2$范数。由于 $A_{min}=-2$ 是赫尔维茨的，可控性格拉姆矩阵 $P_{c,min}$ 存在，并且是李雅普诺夫方程的唯一正定解：\n$$\nA_{min} P_{c,min} + P_{c,min} A_{min}^T + B_{min} B_{min}^T = 0\n$$\n由于这些都是标量，我们将 $P_{c,min}$ 表示为 $p_c$：\n$$\n(-2)p_c + p_c(-2) + (1)(1) = 0\n$$\n$$\n-4p_c + 1 = 0 \\implies p_c = \\frac{1}{4}\n$$\n可控性格拉姆矩阵为 $P_{c,min} = \\frac{1}{4}$。\n$\\mathcal{H}_2$范数的平方由公式 $\\|G\\|_2^2 = \\text{Tr}(C_{min} P_{c,min} C_{min}^T)$ 给出。\n$$\n\\|G\\|_2^2 = \\text{Tr}\\left((1)\\left(\\frac{1}{4}\\right)(1)\\right) = \\text{Tr}\\left(\\frac{1}{4}\\right) = \\frac{1}{4}\n$$\n$\\mathcal{H}_2$范数是该值的平方根：\n$$\n\\|G\\|_2 = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}\n$$\n这个结果与对 $G(s) = \\frac{1}{s+2}$ 进行直接频域计算的结果一致。\n$$\n\\|G\\|_2^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |G(j\\omega)|^2 d\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{\\omega^2 + 4} d\\omega = \\frac{1}{2\\pi} \\left[ \\frac{1}{2}\\arctan\\left(\\frac{\\omega}{2}\\right) \\right]_{-\\infty}^{\\infty} = \\frac{1}{2\\pi} \\left(\\frac{1}{2} (\\pi)\\right) = \\frac{1}{4}\n$$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2711598"}, {"introduction": "最后的这个实践将我们的重点转移到多输入多输出（MIMO）系统和$\\mathcal{H}_{\\infty}$范数上。通过比较一个耦合系统及其对角化版本，你将探索$\\mathcal{H}_{\\infty}$范数作为跨所有输入方向和频率的最大放大增益的物理意义。本练习 [@problem_id:2711616] 通过奇异值分析，突显了输入方向和通道耦合在决定系统峰值响应中的关键作用，而这一概念是鲁棒控制的核心。", "problem": "考虑以下严格真、稳定的多输入多输出 (MIMO) 线性时不变 (LTI) 传递矩阵，两者具有相同的对角项。定义\n$$\nG(s) \\;=\\; \\frac{1}{s+1}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix},\n\\qquad\nG_{d}(s) \\;=\\; \\begin{bmatrix} \\dfrac{1}{s+1}  0 \\\\ 0  \\dfrac{1}{s+1} \\end{bmatrix}.\n$$\n您将从第一性原理出发，计算 $G(s)$ 和 $G_{d}(s)$ 的 Hardy 空间$\\mathcal{H}_{2}$系统范数和$\\mathcal{H}_{\\infty}$系统范数。仅使用以下基本定义：对于严格真、稳定的 LTI 系统，$\\mathcal{H}_{2}$范数定义为 $G(\\mathrm{j}\\omega)G(\\mathrm{j}\\omega)^{*}$ 的迹的频域能量积分的平方根，而$\\mathcal{H}_{\\infty}$范数定义为 $G(\\mathrm{j}\\omega)$ 的最大奇异值在所有频率上的上确界。解释为什么 $G(s)$ 中的非对角耦合会产生跨频率的奇异向量方向对齐，从而导致其 $\\|G\\|_{\\infty}$ 严格大于具有相同对角项的对角系统 $G_{d}(s)$ 的范数。\n\n您的最终答案必须是包含这四个量的单行向量，顺序如下：\n$$\n\\bigl\\|G\\bigr\\|_{\\mathcal{H}_{2}},\\quad \\bigl\\|G\\bigr\\|_{\\infty},\\quad \\bigl\\|G_{d}\\bigr\\|_{\\mathcal{H}_{2}},\\quad \\bigl\\|G_{d}\\bigr\\|_{\\infty}.\n$$\n无需四舍五入。请以精确值的形式表示最终答案。", "solution": "所述问题是有效的。它在科学上基于线性系统和控制理论的原理，问题提法恰当，并且提供了求解所需的所有信息。我们将着手进行分析。\n\n该问题要求计算两个系统 $G(s)$ 和 $G_d(s)$ 的$\\mathcal{H}_2$和$\\mathcal{H}_{\\infty}$范数，并解释它们$\\mathcal{H}_{\\infty}$范数的差异。我们将根据所提供的第一性原理，依次处理每个系统。\n\n我们定义矩阵 $M(s)$ 的复共轭转置（Hermitian 共轭）为 $M(s)^* \\triangleq M(-\\bar{s})^T$。对于频率响应 $M(\\mathrm{j}\\omega)$，这变为 $M(\\mathrm{j}\\omega)^* = M(-\\mathrm{j}\\omega)^T$。\n\n对于一个严格真、稳定的 LTI 系统 $G(s)$，其$\\mathcal{H}_2$范数由以下公式给出：\n$$\n\\|G\\|_{\\mathcal{H}_2}^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{trace}\\left(G(\\mathrm{j}\\omega)G(\\mathrm{j}\\omega)^*\\right) d\\omega\n$$\n$\\mathcal{H}_{\\infty}$范数定义为在所有频率上的峰值增益：\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(G(\\mathrm{j}\\omega))\n$$\n其中 $\\bar{\\sigma}(\\cdot)$ 表示矩阵的最大奇异值。\n\n首先，我们分析耦合系统 $G(s) = \\frac{1}{s+1}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。\n其频率响应为 $G(\\mathrm{j}\\omega) = \\frac{1}{\\mathrm{j}\\omega+1}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。\n其共轭转置为 $G(\\mathrm{j}\\omega)^* = \\left(\\frac{1}{-\\mathrm{j}\\omega+1}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}\\right)^T = \\frac{1}{1-\\mathrm{j}\\omega}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。\n\n为计算 $G(s)$ 的$\\mathcal{H}_2$范数，我们首先计算乘积 $G(\\mathrm{j}\\omega)G(\\mathrm{j}\\omega)^*$：\n$$\nG(\\mathrm{j}\\omega)G(\\mathrm{j}\\omega)^* = \\left(\\frac{1}{\\mathrm{j}\\omega+1}\\right)\\left(\\frac{1}{1-\\mathrm{j}\\omega}\\right) \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix} = \\frac{1}{1+\\omega^2} \\begin{bmatrix} 2  2 \\\\ 2  2 \\end{bmatrix}\n$$\n该矩阵的迹为：\n$$\n\\mathrm{trace}\\left(G(\\mathrm{j}\\omega)G(\\mathrm{j}\\omega)^*\\right) = \\mathrm{trace}\\left(\\frac{1}{1+\\omega^2} \\begin{bmatrix} 2  2 \\\\ 2  2 \\end{bmatrix}\\right) = \\frac{2}{1+\\omega^2} + \\frac{2}{1+\\omega^2} = \\frac{4}{1+\\omega^2}\n$$\n现在我们对该表达式进行积分，以求得$\\mathcal{H}_2$范数的平方：\n$$\n\\|G\\|_{\\mathcal{H}_2}^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{4}{1+\\omega^2} d\\omega = \\frac{4}{2\\pi} \\left[ \\arctan(\\omega) \\right]_{-\\infty}^{\\infty} = \\frac{2}{\\pi} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{2}{\\pi}(\\pi) = 2\n$$\n因此，$G(s)$ 的$\\mathcal{H}_2$范数为 $\\|G\\|_{\\mathcal{H}_2} = \\sqrt{2}$。\n\n为计算 $G(s)$ 的$\\mathcal{H}_{\\infty}$范数，我们必须找到 $G(\\mathrm{j}\\omega)$ 的最大奇异值，并取其在 $\\omega$ 上的上确界。$G(\\mathrm{j}\\omega)$ 的奇异值由下式给出：\n$$\n\\sigma_i(G(\\mathrm{j}\\omega)) = \\left|\\frac{1}{\\mathrm{j}\\omega+1}\\right| \\sigma_i\\left(\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}\\right) = \\frac{1}{\\sqrt{1+\\omega^2}} \\sigma_i\\left(\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}\\right)\n$$\n设 $A = \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。$A$ 的奇异值是 $A^T A$ 的特征值的平方根。\n$$\nA^T A = \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix} = \\begin{bmatrix} 2  2 \\\\ 2  2 \\end{bmatrix}\n$$\n特征方程为 $\\det(A^T A - \\lambda I) = (2-\\lambda)^2 - 4 = 0$，解得特征值为 $\\lambda_1 = 4$ 和 $\\lambda_2 = 0$。\n$A$ 的奇异值为 $\\sigma_1(A) = \\sqrt{4} = 2$ 和 $\\sigma_2(A) = \\sqrt{0} = 0$。\n$A$ 的最大奇异值为 $\\bar{\\sigma}(A) = 2$。\n因此，$G(\\mathrm{j}\\omega)$ 作为 $\\omega$ 的函数，其最大奇异值为：\n$$\n\\bar{\\sigma}(G(\\mathrm{j}\\omega)) = \\frac{2}{\\sqrt{1+\\omega^2}}\n$$\n$\\mathcal{H}_{\\infty}$范数是该函数的上确界，出现在 $\\omega = 0$ 处：\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega} \\frac{2}{\\sqrt{1+\\omega^2}} = \\frac{2}{\\sqrt{1+0^2}} = 2\n$$\n\n接下来，我们分析对角系统 $G_d(s) = \\begin{bmatrix} \\frac{1}{s+1}  0 \\\\ 0  \\frac{1}{s+1} \\end{bmatrix} = \\frac{1}{s+1} I$。\n其频率响应为 $G_d(\\mathrm{j}\\omega) = \\frac{1}{\\mathrm{j}\\omega+1} I$。\n其共轭转置为 $G_d(\\mathrm{j}\\omega)^* = \\frac{1}{1-\\mathrm{j}\\omega} I$。\n\n对于 $G_d(s)$ 的$\\mathcal{H}_2$范数，我们计算乘积：\n$$\nG_d(\\mathrm{j}\\omega)G_d(\\mathrm{j}\\omega)^* = \\left(\\frac{1}{\\mathrm{j}\\omega+1}\\right)\\left(\\frac{1}{1-\\mathrm{j}\\omega}\\right) I \\cdot I = \\frac{1}{1+\\omega^2} I = \\begin{bmatrix} \\frac{1}{1+\\omega^2}  0 \\\\ 0  \\frac{1}{1+\\omega^2} \\end{bmatrix}\n$$\n该矩阵的迹为：\n$$\n\\mathrm{trace}\\left(G_d(\\mathrm{j}\\omega)G_d(\\mathrm{j}\\omega)^*\\right) = \\frac{1}{1+\\omega^2} + \\frac{1}{1+\\omega^2} = \\frac{2}{1+\\omega^2}\n$$\n对该表达式积分得到$\\mathcal{H}_2$范数的平方：\n$$\n\\|G_d\\|_{\\mathcal{H}_2}^2 = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\frac{2}{1+\\omega^2} d\\omega = \\frac{2}{2\\pi} \\left[ \\arctan(\\omega) \\right]_{-\\infty}^{\\infty} = \\frac{1}{\\pi}(\\pi) = 1\n$$\n因此，$G_d(s)$ 的$\\mathcal{H}_2$范数为 $\\|G_d\\|_{\\mathcal{H}_2} = \\sqrt{1} = 1$。\n\n对于 $G_d(s)$ 的$\\mathcal{H}_{\\infty}$范数，我们考察其奇异值。由于 $G_d(\\mathrm{j}\\omega)$ 是单位矩阵的标量倍，其奇异值就是该标量的模：\n$$\n\\bar{\\sigma}(G_d(\\mathrm{j}\\omega)) = \\bar{\\sigma}\\left(\\frac{1}{\\mathrm{j}\\omega+1} I\\right) = \\left|\\frac{1}{\\mathrm{j}\\omega+1}\\right| \\bar{\\sigma}(I) = \\frac{1}{\\sqrt{1+\\omega^2}} \\cdot 1 = \\frac{1}{\\sqrt{1+\\omega^2}}\n$$\n$\\mathcal{H}_{\\infty}$范数是该函数的上确界，出现在 $\\omega = 0$ 处：\n$$\n\\|G_d\\|_{\\infty} = \\sup_{\\omega} \\frac{1}{\\sqrt{1+\\omega^2}} = \\frac{1}{\\sqrt{1+0^2}} = 1\n$$\n\n最后，我们必须解释为什么 $\\|G\\|_{\\infty} = 2$ 严格大于 $\\|G_d\\|_{\\infty} = 1$。\n$\\mathcal{H}_{\\infty}$范数表示系统在所有频率和所有输入方向上可以施加于输入信号的最大放大倍数或增益。\n对于解耦系统 $G_d(s)$，其传递矩阵为 $G_d(\\mathrm{j}\\omega) = c(\\omega)I$，其中 $c(\\omega) = 1/(\\mathrm{j}\\omega+1)$。该系统是各向同性的；它将任何输入向量 $u$ 按复标量 $c(\\omega)$ 进行缩放，而不改变其方向。对于所有输入方向，增益均为 $|c(\\omega)|$。最大可能增益就是 $|c(\\omega)|$ 的最大值，即 $\\sup_{\\omega} |c(\\omega)| = 1$。\n\n对于耦合系统 $G(s)$，其传递矩阵为 $G(\\mathrm{j}\\omega) = c(\\omega)A$，其中 $A=\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。该系统的增益取决于输入方向。$G(\\mathrm{j}\\omega)$ 的奇异值分解揭示了这种方向依赖性。$G(\\mathrm{j}\\omega)$ 的右奇异向量确定了输入方向，而相应的奇异值给出了这些方向上的放大倍数。$G(\\mathrm{j}\\omega)$ 的奇异值是 $|c(\\omega)|$ 乘以常数矩阵 $A$ 的奇异值。正如我们所计算的，$A$ 的最大奇异值为 $\\bar{\\sigma}(A) = 2$。\n这个最大奇异值对应于右奇异向量 $v_1 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。对于与此方向对齐的输入信号 $u(\\omega)$，系统增益为 $|c(\\omega)|\\bar{\\sigma}(A) = 2|c(\\omega)|$。\n\n关键的观察是矩阵 $A$ 的奇异向量是常数。这意味着 $G(\\mathrm{j}\\omega)$ 的右奇异向量也相对于频率 $\\omega$ 是常数。具体来说，$G(s)$ 的最大放大方向 $v_1 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$ 在所有频率上都是相同的。这就是所谓的“跨频率的奇异向量方向对齐”。该系统有一个固定的、它放大最多的首选输入方向。总的系统增益 $\\|G\\|_{\\infty}$ 是这个峰值方向增益在所有频率上的最大值：\n$$\n\\|G\\|_{\\infty} = \\sup_{\\omega} \\left( \\bar{\\sigma}(A) \\left|\\frac{1}{\\mathrm{j}\\omega+1}\\right| \\right) = 2 \\cdot \\sup_{\\omega} \\frac{1}{\\sqrt{1+\\omega^2}} = 2 \\cdot 1 = 2\n$$\n$G(s)$ 中的非对角耦合为方向 $v_1$ 上的输入创造了相长干涉。输入 $u_1$ 和 $u_2$ 同相，它们通过相同的动态系统，输出被相加，在直流（$\\omega=0$）处产生 2 的增益。相比之下，$G_d(s)$ 缺乏这种在通道之间产生相长干涉的耦合机制，因此其增益受限于单个通道的最大增益，即 1。\n\n因此，这四个量为：$\\|G\\|_{\\mathcal{H}_{2}} = \\sqrt{2}$，$\\|G\\|_{\\infty}=2$，$\\|G_{d}\\|_{\\mathcal{H}_{2}}=1$ 和 $\\|G_{d}\\|_{\\infty}=1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{2}  2  1  1 \\end{pmatrix}}\n$$", "id": "2711616"}]}