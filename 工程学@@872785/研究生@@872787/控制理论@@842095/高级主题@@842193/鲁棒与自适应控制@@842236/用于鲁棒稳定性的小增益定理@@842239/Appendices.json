{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，以建立你的计算技能。该问题要求你根据定义直接计算一个简单的二阶系统的 $\\mathcal{H}_{\\infty}$ 范数。通过这个实践[@problem_id:2754153]，你将巩固对小增益定理核心机制的理解：即确保环路增益在所有频率下都小于1，从而保证鲁棒稳定性。", "problem": "考虑一个稳定的单输入单输出 (SISO) 线性时不变 (LTI) 对象，其传递函数为 $G(s)=\\dfrac{k}{(s+a)(s+b)}$，其中 $a>0$，$b>0$ 且 $k \\in \\mathbb{R}$。该对象与一个稳定的、因果的不确定性 $\\Delta(s)$ 连接在一个标准的负反馈回路中，该不确定性满足 Hardy 空间无穷范数 ($\\mathcal{H}_{\\infty}$) 界 $\\|\\Delta\\|_{\\infty} \\leq 1$。小增益定理断言，如果环路增益满足 $\\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty}  1$，则闭环系统是鲁棒稳定的。仅使用 $\\mathcal{H}_{\\infty}$ 范数的基本定义，即频率响应在所有频率上的最大奇异值的最小上界，计算 $\\|G\\|_{\\infty}$ 的闭式解，表示为 $a$，$b$ 和 $k$ 的函数。然后确定 $k$ 的幅值的上确界 $k_{\\max}$，使得对于每个 $|k|  k_{\\max}$，闭环系统都是鲁棒稳定的。", "solution": "此问题已经过验证，被认为是有效的。这是一个在鲁棒控制理论领域中提法恰当、有科学依据的问题。所有必要的数据和定义都已提供，没有矛盾或含糊之处。我将开始解题。\n\n该问题分为两部分。首先，我们必须计算给定对象传递函数 $G(s)$ 的 $\\mathcal{H}_{\\infty}$ 范数。其次，我们必须利用此结果，通过小增益定理找到保证鲁棒稳定性的增益幅值上确界 $k_{\\max}$。\n\n**第一部分：$\\|G\\|_{\\infty}$ 的计算**\n\n该对象是一个单输入单输出 (SISO) 线性时不变 (LTI) 系统，其传递函数为：\n$$G(s) = \\frac{k}{(s+a)(s+b)}$$\n其中 $a > 0$，$b > 0$ 且 $k \\in \\mathbb{R}$。关于 $a$ 和 $b$ 的条件确保了系统的极点（位于 $s=-a$ 和 $s=-b$）处于复平面的开左半平面，这证实了所述的对象稳定性。\n\n一个稳定的 SISO LTI 系统的 $\\mathcal{H}_{\\infty}$ 范数定义为其频率响应幅值的上确界。对于传递函数 $G(s)$，其定义为：\n$$ \\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(j\\omega)| $$\n我们通过将 $s=j\\omega$ 代入 $G(s)$ 来获得频率响应函数 $G(j\\omega)$：\n$$G(j\\omega) = \\frac{k}{(j\\omega+a)(j\\omega+b)}$$\n频率响应的幅值为：\n$$|G(j\\omega)| = \\frac{|k|}{|j\\omega+a| |j\\omega+b|}$$\n分母中复数的模分别为 $|j\\omega+a| = \\sqrt{a^2+\\omega^2}$ 和 $|j\\omega+b| = \\sqrt{b^2+\\omega^2}$。因此：\n$$|G(j\\omega)| = \\frac{|k|}{\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}}$$\n为了找到 $|G(j\\omega)|$ 的上确界，我们必须找到分母项 $\\sqrt{(a^2+\\omega^2)(b^2+\\omega^2)}$ 关于频率 $\\omega$ 的最小值。最大化一个正函数等同于最大化它的平方，这通常更简单。我们定义函数 $M(\\omega)$ 为幅值的平方：\n$$M(\\omega) = |G(j\\omega)|^2 = \\frac{k^2}{(a^2+\\omega^2)(b^2+\\omega^2)}$$\n最大化 $M(\\omega)$ 等价于最小化其分母，我们将其记为 $D(\\omega)$：\n$$D(\\omega) = (a^2+\\omega^2)(b^2+\\omega^2) = \\omega^4 + (a^2+b^2)\\omega^2 + a^2b^2$$\n为了找到 $D(\\omega)$ 在 $\\omega \\in \\mathbb{R}$ 上的最小值，我们计算它关于 $\\omega$ 的导数并令其为零。\n$$\\frac{dD}{d\\omega} = 4\\omega^3 + 2(a^2+b^2)\\omega = 2\\omega(2\\omega^2 + a^2+b^2)$$\n我们将导数设为零以找到临界点：\n$$2\\omega(2\\omega^2 + a^2+b^2) = 0$$\n由于 $a > 0$ 和 $b > 0$，因此 $a^2 > 0$ 且 $b^2 > 0$。对于任何实数 $\\omega$，$\\omega^2 \\ge 0$。因此，项 $(2\\omega^2 + a^2+b^2)$ 恒为正。所以该方程唯一的实数解是 $\\omega = 0$。\n\n为了确认该临界点对应于 $D(\\omega)$ 的最小值，我们检查其二阶导数：\n$$\\frac{d^2D}{d\\omega^2} = 12\\omega^2 + 2(a^2+b^2)$$\n在 $\\omega=0$ 处，二阶导数为 $\\left.\\frac{d^2D}{d\\omega^2}\\right|_{\\omega=0} = 2(a^2+b^2)$。由于 $a^2 > 0$ 且 $b^2 > 0$，该值恒为正，确认了 $D(\\omega)$ 在 $\\omega=0$ 处有一个局部最小值。由于这是 $\\omega \\ge 0$ 的唯一临界点，并且当 $\\omega \\to \\infty$ 时 $D(\\omega) \\to \\infty$，所以这是全局最小值。\n\n因此，$|G(j\\omega)|$ 的最大值出现在 $\\omega=0$ 处。我们在此频率下计算 $|G(j\\omega)|$ 的值：\n$$ \\|G\\|_{\\infty} = |G(j0)| = \\frac{|k|}{\\sqrt{(a^2+0)(b^2+0)}} = \\frac{|k|}{\\sqrt{a^2b^2}} $$\n由于 $a > 0$ 且 $b > 0$，我们有 $ab > 0$，因此 $\\sqrt{a^2b^2} = ab$。对象的 $\\mathcal{H}_{\\infty}$ 范数为：\n$$ \\|G\\|_{\\infty} = \\frac{|k|}{ab} $$\n\n**第二部分：$k_{\\max}$ 的确定**\n\n小增益定理指出，如果环路增益小于1，则 $G(s)$ 和 $\\Delta(s)$ 的负反馈互联系统是鲁棒稳定的：\n$$ \\|G\\|_{\\infty} \\|\\Delta\\|_{\\infty}  1 $$\n我们已知稳定的、因果的不确定性 $\\Delta(s)$ 满足界 $\\|\\Delta\\|_{\\infty} \\le 1$。为了对所有满足此界的不确定性保证稳定性，我们必须满足最坏情况下的不确定性条件，即 $\\|\\Delta\\|_{\\infty}$ 达到最大值，也就是 $\\|\\Delta\\|_{\\infty} = 1$。因此，鲁棒稳定性的条件变为：\n$$ \\|G\\|_{\\infty} \\cdot 1  1 \\implies \\|G\\|_{\\infty}  1 $$\n代入第一部分中推导出的 $\\|G\\|_{\\infty}$ 表达式：\n$$ \\frac{|k|}{ab}  1 $$\n解出 $|k|$，我们得到：\n$$ |k|  ab $$\n问题要求的是一个正数 $k_{\\max}$ 的上确界，使得对于每个 $|k|  k_{\\max}$，鲁棒稳定性条件 $|k|  ab$ 都得到保证。这意味着区间 $(-k_{\\max}, k_{\\max})$ 必须是区间 $(-ab, ab)$ 的一个子集。因此，最大的 $k_{\\max}$ 是 $ab$。\n换句话说，使系统鲁棒稳定的 $|k|$ 的值集合是 $[0, ab)$。这个集合的上确界（最小上界）是 $ab$。\n$$k_{\\max} = ab$$\n\n最终答案应以包含 $\\|G\\|_{\\infty}$ 和 $k_{\\max}$ 的双元素行矩阵形式给出。\n\n第一个元素：$\\|G\\|_{\\infty} = \\frac{|k|}{ab}$\n第二个元素：$k_{\\max} = ab$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{|k|}{ab}  ab\n\\end{pmatrix}\n}\n$$", "id": "2754153"}, {"introduction": "小增益定理虽然功能强大，但有时可能过于保守。本练习通过将定理推导出的稳定性边界与一个具有特定不确定性（实数静态增益）的系统的精确边界进行比较，来阐释这一点。这个练习[@problem_id:2754190]至关重要，它能帮助你理解该定理的优势（普适性）也正是其保守性的来源，尤其是在我们对不确定性有更多了解时。", "problem": "考虑单输入单输出 (SISO) 稳定系统\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 0.4\\,s + 1}.\n$$\n构建一个标准的正反馈互联，其中反馈部分为一个不确定的、实数的、静态增益块 $\\Delta = k$，使得闭环特征方程为\n$$\n1 - k\\,G(s) \\;=\\; 0,\n$$\n并假设不确定性满足 $|k| \\le \\gamma$。您需要比较小增益定理的充分界与基于奈奎斯特的精确鲁棒稳定性界，并量化其保守性差距。\n\n任务：\n1) 使用$\\mathcal{H}_\\infty$范数的定义，\n$$\n\\|G\\|_{\\infty} \\;=\\; \\sup_{\\omega \\in \\mathbb{R}} |G(\\mathrm{j}\\,\\omega)|,\n$$\n计算 $\\|G\\|_{\\infty}$。\n\n2) 使用小增益定理，确定充分界 $\\gamma_{\\mathrm{SG}}$，使得对于所有 $|k| \\le \\gamma_{\\mathrm{SG}}$，该互联系统都是内部稳定的。\n\n3) 使用精确的基于奈奎斯特的推理（您也可以等效地使用劳斯-赫尔维茨稳定性判据），确定最大的实数 $\\gamma_{\\mathrm{exact}}$，使得对于所有满足 $|k| \\le \\gamma_{\\mathrm{exact}}$ 的实数 $k$，闭环系统都是内部稳定的。\n\n4) 将保守性差距量化为因子\n$$\nr \\;=\\; \\frac{\\gamma_{\\mathrm{exact}}}{\\gamma_{\\mathrm{SG}}}.\n$$\n报告单个数值 $r$，四舍五入到四位有效数字。无需单位。", "solution": "我们从基本定义开始。$\\mathcal{H}_{\\infty}$ 范数定义为 $\\|G\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |G(\\mathrm{j}\\,\\omega)|$。小增益定理指出，一个稳定的线性时不变系统 $G$ 和一个有界算子 $\\Delta$ 的正反馈互联，如果 $\\|G\\|_{\\infty}\\,\\|\\Delta\\|_{\\infty}  1$，则是内部稳定的。对于一个实数静态增益 $\\Delta = k$ 且 $|k| \\le \\gamma$，这给出了充分界 $\\gamma_{\\mathrm{SG}} = 1/\\|G\\|_{\\infty}$。为了获得对于实数 $k$ 的精确最大允许 $\\gamma$，我们可以使用针对实数标量反馈的奈奎斯特判据，或者等效地通过劳斯-赫尔维茨判据分析闭环特征多项式。\n\n步骤 1：计算 $\\|G\\|_{\\infty}$。\n\n对于\n$$\nG(s) \\;=\\; \\frac{1}{s^{2} + 0.4\\,s + 1},\n$$\n在 $s = \\mathrm{j}\\,\\omega$ 处的频率响应为\n$$\nG(\\mathrm{j}\\,\\omega) \\;=\\; \\frac{1}{-\\omega^{2} + 1 + \\mathrm{j}\\,(0.4)\\,\\omega}.\n$$\n因此，幅值的平方为\n$$\n|G(\\mathrm{j}\\,\\omega)|^{2} \\;=\\; \\frac{1}{\\left(1 - \\omega^{2}\\right)^{2} + \\left(0.4\\,\\omega\\right)^{2}} \\;=\\; \\frac{1}{\\left(1 - \\omega^{2}\\right)^{2} + 0.16\\,\\omega^{2}}.\n$$\n为了找到 $|G(\\mathrm{j}\\,\\omega)|$ 的上确界，只需最小化分母\n$$\nD(\\omega) \\;=\\; \\left(1 - \\omega^{2}\\right)^{2} + 0.16\\,\\omega^{2}.\n$$\n令 $u = \\omega^{2} \\ge 0$。则\n$$\nD(u) \\;=\\; (1 - u)^{2} + 0.16\\,u \\;=\\; u^{2} + u\\,(0.16 - 2) + 1 \\;=\\; u^{2} - 1.84\\,u + 1.\n$$\n对 $u$ 求导并令其为零：\n$$\n\\frac{\\mathrm{d}D}{\\mathrm{d}u} \\;=\\; 2u - 1.84 \\;=\\; 0 \\;\\;\\Rightarrow\\;\\; u^{\\star} \\;=\\; 0.92.\n$$\n由于 $u^{\\star} \\ge 0$ 且 $D(u)$ 是关于 $u$ 的凸函数，因此这是全局最小值点。在 $u^{\\star}$ 处计算 $D$ 的值：\n$$\nD(u^{\\star}) \\;=\\; (1 - 0.92)^{2} + 0.16\\cdot 0.92 \\;=\\; (0.08)^{2} + 0.1472 \\;=\\; 0.0064 + 0.1472 \\;=\\; 0.1536.\n$$\n因此\n$$\n\\|G\\|_{\\infty} \\;=\\; \\sup_{\\omega} |G(\\mathrm{j}\\,\\omega)| \\;=\\; \\frac{1}{\\sqrt{D(u^{\\star})}} \\;=\\; \\frac{1}{\\sqrt{0.1536}}.\n$$\n计算平方根：\n$$\n\\sqrt{0.1536} = 0.4\\,\\sqrt{0.96} \\approx 0.3919183588453085,\n$$\n所以\n$$\n\\|G\\|_{\\infty} \\;=\\; \\frac{1}{0.4\\,\\sqrt{0.96}} \\;\\approx\\; 2.5515518526.\n$$\n为完整起见，注意到这与阻尼比 $\\zeta = 0.2$ 的欠阻尼二阶系统的著名峰值增益一致，即\n$$\n\\|G\\|_{\\infty} \\;=\\; \\frac{1}{2\\,\\zeta\\,\\sqrt{1 - \\zeta^{2}}} \\;=\\; \\frac{1}{0.4\\,\\sqrt{0.96}}.\n$$\n\n步骤 2：小增益充分界。\n\n根据小增益定理，只要满足\n$$\n\\|G\\|_{\\infty}\\,\\gamma_{\\mathrm{SG}}  1,\n$$\n对于所有 $|k| \\le \\gamma_{\\mathrm{SG}}$，鲁棒内部稳定性就得到保证。\n因此，紧的充分界为\n$$\n\\gamma_{\\mathrm{SG}} \\;=\\; \\frac{1}{\\|G\\|_{\\infty}} \\;=\\; 0.4\\,\\sqrt{0.96} \\;\\approx\\; 0.3919183588.\n$$\n\n步骤 3：对于实数 $k$ 的精确奈奎斯特界。\n\n正反馈互联的特征方程为\n$$\n1 - k\\,G(s) \\;=\\; 0 \\;\\;\\Longleftrightarrow\\;\\; s^{2} + 0.4\\,s + 1 - k \\;=\\; 0.\n$$\n根据二阶多项式 $s^{2} + a_{1}\\,s + a_{0}$ 的劳斯-赫尔维茨稳定性判据，内部稳定性要求 $a_{1} > 0$ 且 $a_{0} > 0$。此处 $a_{1} = 0.4 > 0$ 且 $a_{0} = 1 - k$。因此，系统稳定的充要条件是\n$$\n1 - k \\;\\; 0 \\;\\;\\Longleftrightarrow\\;\\; k  1.\n$$\n对于负数 $k$，常数项变为 $1 - k > 1$，这不会违反劳斯-赫尔维茨条件。因此，包含在稳定区域内、关于原点对称的 $k$ 的最大区间是 $|k| \\le 1$，精确的鲁棒半径为\n$$\n\\gamma_{\\mathrm{exact}} \\;=\\; 1.\n$$\n这个精确的结果与奈奎斯特观点一致：$G$ 的奈奎斯特图在 $\\omega = 0$ 处穿过正实轴，其值为 $G(0) = 1$，并且在有限频率下没有穿过负实轴；因此，在正反馈中，稳定性的首次丧失发生在 $k = 1$ 时。\n\n步骤 4：保守性因子。\n\n所求的比值为\n$$\nr \\;=\\; \\frac{\\gamma_{\\mathrm{exact}}}{\\gamma_{\\mathrm{SG}}} \\;=\\; \\gamma_{\\mathrm{exact}}\\,\\|G\\|_{\\infty} \\;=\\; 1 \\cdot \\frac{1}{0.4\\,\\sqrt{0.96}} \\;\\approx\\; 2.5515518526.\n$$\n四舍五入到四位有效数字，\n$$\nr \\;\\approx\\; 2.552.\n$$\n这量化了保守性：对于本例，小增益定理对 $|k|$ 的界限比基于奈奎斯特的精确界限小了大约 $2.552$ 倍。", "answer": "$$\\boxed{2.552}$$", "id": "2754190"}, {"introduction": "我们如何才能获得不那么保守的结果？答案在于利用关于不确定性结构的先验知识。这个计算练习[@problem_id:2754167]介绍了结构化奇异值（$\\mu$），它是小增益条件的一个强大推广。通过实现一个基本的$\\mu$分析，你将亲眼看到利用结构信息如何能够对鲁棒稳定性做出更精确、更不保守的评估。", "problem": "给定一个线性时不变 (LTI) 复值传递矩阵函数 $M(s)$ 以及一个结构化不确定性 $\\Delta$，其模型为一个大小为 $n$ 的单一重复复标量全块，即 $\\Delta = \\delta I_n$，其中 $\\delta \\in \\mathbb{C}$ 且 $I_n$ 是大小为 $n \\times n$ 的单位矩阵。与此结构相关的结构奇异值（也称为 $\\mu$），对于每个固定频率 $\\omega \\in \\mathbb{R}_{\\ge 0}$，由标准定义给出\n$$\n\\mu_{\\Delta}\\big(M(j\\omega)\\big) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det\\big(I - M(j\\omega)\\Delta\\big) = 0 \\right\\} \\right)^{-1}.\n$$\n对于指定结构 $\\Delta = \\delta I_n$，由 $\\mu$ 导出的鲁棒稳定性裕度为\n$$\n\\gamma_{\\mu} \\triangleq \\left( \\sup_{\\omega \\in [0,\\infty)} \\mu_{\\Delta}\\big(M(j\\omega)\\big) \\right)^{-1}.\n$$\n非结构化小增益裕度为\n$$\n\\gamma_{\\mathrm{sg}} \\triangleq \\left\\| M \\right\\|_{\\infty}^{-1} = \\left( \\sup_{\\omega \\in [0,\\infty)} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1},\n$$\n其中 $\\overline{\\sigma}(\\cdot)$ 表示最大奇异值。您的任务是建立针对给定块结构的 $\\mu_{\\Delta}\\big(M(j\\omega)\\big)$ 的逐频率计算，计算 $\\gamma_{\\mu}$，并将其与 $\\gamma_{\\mathrm{sg}}$ 进行比较。\n\n您可以假定的基本原理包括：结构奇异值 $\\mu$ 的定义、复矩阵的特征值和奇异值的性质，以及通过代入 $s = j\\omega$（其中 $j^2 = -1$）来评估有理传递函数 $G(s) = N(s)/D(s)$ 的频率响应。请勿使用任何预打包的 $\\mu$ 分析程序。\n\n所有计算请使用以下频率网格：$\\omega$ 在 $\\omega \\in [10^{-2}, 10^{3}]$（单位：$\\mathrm{rad/s}$）上对数均匀分布，共 1000 个点。对于每个测试用例，计算\n- $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho\\big(M(j\\omega)\\big) \\right)^{-1}$，其中 $\\rho(\\cdot)$ 表示谱半径（特征值的最大模），\n- $\\gamma_{\\mathrm{sg}} = \\left( \\sup_{\\omega} \\overline{\\sigma}\\big(M(j\\omega)\\big) \\right)^{-1}$。\n\n如果某个情况下的分母中的上确界为 $0$，则对应的裕度返回 $+\\infty$。\n\n实现一个程序，通过有理函数求值，逐项计算 $M(j\\omega)$，使用为每个传递函数项提供的分子和分母系数数组，其中每个项的形式为 $G_{ij}(s) = \\dfrac{N_{ij}(s)}{D_{ij}(s)}$，其中 $N_{ij}(s)$ 和 $D_{ij}(s)$ 是实系数多项式。系数数组按从最高次到最低次的顺序排列。所有答案必须表示为无量纲量（输出中不出现物理单位）。角频率单位为 $\\mathrm{rad/s}$。\n\n测试套件：\n对于以下每种情况，$M(s)$ 是 $2 \\times 2$ 矩阵，不确定性结构是单一重复标量全块 $\\Delta = \\delta I_2$。\n\n- 情况 A（耦合，非正规）：\n  - $M_{11}(s) = \\dfrac{1.2}{s + 1}$，分子 $[\\,1.2\\,]$，分母 $[\\,1,\\,1\\,]$。\n  - $M_{12}(s) = \\dfrac{0.4}{s + 0.5}$，分子 $[\\,0.4\\,]$，分母 $[\\,1,\\,0.5\\,]$。\n  - $M_{21}(s) = \\dfrac{-0.6}{s + 2}$，分子 $[\\,{-0.6}\\,]$，分母 $[\\,1,\\,2\\,]$。\n  - $M_{22}(s) = \\dfrac{0.9 s + 0.3}{(s + 1.5)(s + 3)}$，分子 $[\\,0.9,\\,0.3\\,]$，分母 $[\\,1,\\,4.5,\\,4.5\\,]$。\n\n- 情况 B（对角，正规）：\n  - $M_{11}(s) = \\dfrac{0.7}{s + 0.7}$，分子 $[\\,0.7\\,]$，分母 $[\\,1,\\,0.7\\,]$。\n  - $M_{12}(s) = 0$，分子 $[\\,0\\,]$，分母 $[\\,1\\,]$。\n  - $M_{21}(s) = 0$，分子 $[\\,0\\,]$，分母 $[\\,1\\,]$。\n  - $M_{22}(s) = \\dfrac{0.5}{s + 2.0}$，分子 $[\\,0.5\\,]$，分母 $[\\,1,\\,2.0\\,]$。\n\n- 情况 C（弱耦合）：\n  - $M_{11}(s) = \\dfrac{0.2}{s + 0.2}$，分子 $[\\,0.2\\,]$，分母 $[\\,1,\\,0.2\\,]$。\n  - $M_{12}(s) = \\dfrac{0.05}{s + 5}$，分子 $[\\,0.05\\,]$，分母 $[\\,1,\\,5\\,]$。\n  - $M_{21}(s) = \\dfrac{0.1}{s + 5}$，分子 $[\\,0.1\\,]$，分母 $[\\,1,\\,5\\,]$。\n  - $M_{22}(s) = \\dfrac{0.3}{s + 0.3}$，分子 $[\\,0.3\\,]$，分母 $[\\,1,\\,0.3\\,]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个情况的结果列表，每个情况由一个二元列表 $[\\,\\gamma_{\\mu},\\,\\gamma_{\\mathrm{sg}}\\,]$ 表示，每个浮点数四舍五入到小数点后六位。总输出必须是包含三个情况结果的单个列表，例如 $[[a_1,b_1],[a_2,b_2],[a_3,b_3]]$，精确打印在一行上，无额外文本。", "solution": "所呈现的问题陈述经过验证，被认为是科学上合理、适定且自洽的。它描述了鲁棒控制理论中一个关于带结构化不确定性系统稳定性分析的标准问题。结构奇异值 $\\mu$、结构化稳定性裕度 $\\gamma_{\\mu}$ 和非结构化小增益裕度 $\\gamma_{\\mathrm{sg}}$ 的定义是正确的。提供的测试用例已足够详细，可以进行唯一的计算求解。因此，我们着手进行分析。\n\n核心任务是比较从结构化和非结构化不确定性分析中得出的稳定性裕度。非结构化裕度 $\\gamma_{\\mathrm{sg}}$ 基于小增益定理，该定理考虑任何范数有界的稳定扰动 $\\Delta$。结构化裕度 $\\gamma_{\\mu}$ 利用了不确定性的特定结构知识，在本例中为重复复标量块 $\\Delta = \\delta I_n$，其中 $\\delta \\in \\mathbb{C}$。\n\n首先，我们必须为指定结构形式化 $\\mu_{\\Delta}(M(j\\omega))$ 的计算。根据定义，\n$$\n\\mu_{\\Delta}(M) \\triangleq \\left( \\inf \\left\\{ \\|\\Delta\\| : \\det(I - M\\Delta) = 0 \\text{ for some } \\Delta \\text{ with the given structure} \\right\\} \\right)^{-1}.\n$$\n如果不存在这样的 $\\Delta$，则下确界为 $\\infty$，且 $\\mu_{\\Delta}(M) = 0$。对于结构 $\\Delta = \\delta I_n$，不稳定的条件变为 $\\det(I - M(\\delta I_n)) = \\det(I - \\delta M) = 0$。此方程成立当且仅当 $1$ 是矩阵 $\\delta M$ 的一个特征值，这等价于说 $\\frac{1}{\\delta}$ 是 $M$ 的一个非零特征值。设 $M$ 的特征值集合为 $\\{\\lambda_i(M)\\}$。那么，对于某个 $i$，必须有 $\\frac{1}{\\delta} = \\lambda_i(M)$。这意味着对于任何非零特征值 $\\lambda_i(M)$，有 $\\delta = \\frac{1}{\\lambda_i(M)}$。扰动的范数为 $\\|\\Delta\\| = \\|\\delta I_n\\|_2 = |\\delta|$。为了找到最小的失稳扰动，我们寻求 $|\\delta|$ 的下确界：\n$$\n\\inf \\{|\\delta|\\} = \\inf_{i} \\left\\{ \\left| \\frac{1}{\\lambda_i(M)} \\right| \\text{ where } \\lambda_i(M) \\neq 0 \\right\\} = \\frac{1}{\\max_{i} |\\lambda_i(M)|}.\n$$\n量 $\\max_i |\\lambda_i(M)|$ 根据定义是矩阵 $M$ 的谱半径，记作 $\\rho(M)$。因此，扰动范数的下确界是 $(\\rho(M))^{-1}$。将此代入 $\\mu$ 的定义：\n$$\n\\mu_{\\Delta}(M) = \\left( (\\rho(M))^{-1} \\right)^{-1} = \\rho(M).\n$$\n这个基本结果证实，对于重复标量块不确定性结构，结构奇异值恰好是矩阵的谱半径。因此，问题中关于计算 $\\gamma_{\\mu} = \\left( \\sup_{\\omega} \\rho(M(j\\omega)) \\right)^{-1}$ 的指令是正确的。\n\n计算流程如下：\n1.  建立一个包含 $N=1000$ 个点的频率网格 $\\omega_k$，在区间 $[10^{-2}, 10^{3}]\\,\\mathrm{rad/s}$ 上对数均匀分布。\n2.  对于每个测试用例，以及网格中的每个频率 $\\omega_k$：\n    a. 在 $s = j\\omega_k$ 处计算传递矩阵的每个元素 $M_{ij}(s)$ 以构建复矩阵 $M(j\\omega_k)$。有理函数 $G(s) = N(s)/D(s)$（其多项式系数按 $s$ 的降幂次序给出）的求值是通过计算多项式值的比率 $N(j\\omega_k)/D(j\\omega_k)$ 来执行的。\n    b. 计算所得复矩阵 $M(j\\omega_k)$ 的特征值 $\\lambda_i(M(j\\omega_k))$。\n    c. 则谱半径为 $\\rho(M(j\\omega_k)) = \\max_i |\\lambda_i(M(j\\omega_k))|$。\n    d. 计算 $M(j\\omega_k)$ 的奇异值。最大奇异值为 $\\overline{\\sigma}(M(j\\omega_k)) = \\|M(j\\omega_k)\\|_2$。\n3.  确定谱半径和最大奇异值在频率网格上的上确界：\n    $$\n    \\rho_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\rho(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\rho(M(j\\omega_k))\n    $$\n    $$\n    \\overline{\\sigma}_{\\text{sup}} = \\sup_{\\omega \\in [10^{-2}, 10^3]} \\overline{\\sigma}(M(j\\omega)) \\approx \\max_{k \\in \\{1, \\dots, N\\}} \\overline{\\sigma}(M(j\\omega_k))\n    $$\n4.  通过取这些上确界的倒数来计算稳定性裕度。如果上确界为零，则相应的裕度为无穷大。\n    $$\n    \\gamma_{\\mu} = (\\rho_{\\text{sup}})^{-1}\n    $$\n    $$\n    \\gamma_{\\mathrm{sg}} = (\\overline{\\sigma}_{\\text{sup}})^{-1}\n    $$\n根据矩阵范数的一个已知性质，对于任何矩阵 $M$，其谱半径受其诱导 2-范数（最大奇异值）的限制：$\\rho(M) \\le \\overline{\\sigma}(M)$。这意味着 $\\rho_{\\text{sup}} \\le \\overline{\\sigma}_{\\text{sup}}$，因此有 $\\gamma_{\\mu} \\ge \\gamma_{\\mathrm{sg}}$。这个不等式表明，结构化分析提供的稳定性裕度通常比非结构化小增益分析不那么保守（即更大或相等）。当且仅当 $M$ 是一个正规矩阵（即 $M^*M = MM^*$）时，等式 $\\rho(M) = \\overline{\\sigma}(M)$ 成立。我们预计将在测试用例的结果中观察到这种关系。具体来说，对于情况 B 中的对角矩阵（它是正规的），我们预计 $\\gamma_{\\mu} = \\gamma_{\\mathrm{sg}}$。对于情况 A 和 C 中的非正规矩阵，我们预计 $\\gamma_{\\mu} > \\gamma_{\\mathrm{sg}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the robust stability margin problem for the given test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: coupled, non-normal\n        {\n            \"M11\": ([1.2], [1.0, 1.0]),\n            \"M12\": ([0.4], [1.0, 0.5]),\n            \"M21\": ([-0.6], [1.0, 2.0]),\n            \"M22\": ([0.9, 0.3], [1.0, 4.5, 4.5]),\n        },\n        # Case B: diagonal, normal\n        {\n            \"M11\": ([0.7], [1.0, 0.7]),\n            \"M12\": ([0.0], [1.0]),\n            \"M21\": ([0.0], [1.0]),\n            \"M22\": ([0.5], [1.0, 2.0]),\n        },\n        # Case C: weakly coupled\n        {\n            \"M11\": ([0.2], [1.0, 0.2]),\n            \"M12\": ([0.05], [1.0, 5.0]),\n            \"M21\": ([0.1], [1.0, 5.0]),\n            \"M22\": ([0.3], [1.0, 0.3]),\n        }\n    ]\n\n    # Frequency grid setup\n    omega_grid = np.logspace(-2, 3, 1000)\n    s_grid = 1j * omega_grid\n\n    results = []\n    \n    for case in test_cases:\n        # Extract numerator and denominator coefficients for each entry\n        M11_coeffs = case[\"M11\"]\n        M12_coeffs = case[\"M12\"]\n        M21_coeffs = case[\"M21\"]\n        M22_coeffs = case[\"M22\"]\n\n        # Evaluate transfer functions over the frequency grid\n        M11_freq = np.polyval(M11_coeffs[0], s_grid) / np.polyval(M11_coeffs[1], s_grid)\n        M12_freq = np.polyval(M12_coeffs[0], s_grid) / np.polyval(M12_coeffs[1], s_grid)\n        M21_freq = np.polyval(M21_coeffs[0], s_grid) / np.polyval(M21_coeffs[1], s_grid)\n        M22_freq = np.polyval(M22_coeffs[0], s_grid) / np.polyval(M22_coeffs[1], s_grid)\n        \n        rhos = []\n        sigmas = []\n\n        # Iterate through each frequency point to compute spectral radius and max singular value\n        for i in range(len(omega_grid)):\n            M_jw = np.array([\n                [M11_freq[i], M12_freq[i]],\n                [M21_freq[i], M22_freq[i]]\n            ])\n            \n            # Compute spectral radius (rho)\n            eigvals = np.linalg.eigvals(M_jw)\n            rho = np.max(np.abs(eigvals))\n            rhos.append(rho)\n            \n            # Compute maximum singular value (sigma_bar)\n            sigma_max = np.linalg.norm(M_jw, ord=2)\n            sigmas.append(sigma_max)\n\n        # Compute suprema over the frequency grid\n        sup_rho = np.max(rhos)\n        sup_sigma = np.max(sigmas)\n        \n        # Calculate margins, handling the case of a zero supremum\n        gamma_mu = np.inf if sup_rho == 0 else 1.0 / sup_rho\n        gamma_sg = np.inf if sup_sigma == 0 else 1.0 / sup_sigma\n        \n        results.append([gamma_mu, gamma_sg])\n\n    # Format the final output string as specified\n    result_strings = [f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in results]\n    final_output = f\"[[{result_strings[0][1:-1]}],[{result_strings[1][1:-1]}],[{result_strings[2][1:-1]}]]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2754167"}]}