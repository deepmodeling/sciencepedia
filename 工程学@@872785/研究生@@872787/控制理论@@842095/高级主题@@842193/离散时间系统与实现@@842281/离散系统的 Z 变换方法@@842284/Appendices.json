{"hands_on_practices": [{"introduction": "要真正掌握Z变换，关键在于理解收敛域 (Region of Convergence, ROC) 如何决定时间序列的特性。本练习将通过逆变换一个具有环状收敛域的有理函数，带你亲手实践这一核心概念。你将看到同一个Z变换表达式如何根据收敛域的不同，分解为因果和反因果部分，从而构成一个双边序列 [@problem_id:2757909]。", "problem": "考虑一个离散时间信号的双边Z变换（ZT），其定义为 $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$，并指定了收敛域（ROC）。设\n$$\nX(z) = \\frac{1 + 3 z^{-1}}{\\left(1 - 0.5\\, z^{-1}\\right)^{2} \\left(1 - 2\\, z^{-1}\\right)} ,\n$$\n这是一个关于 $z^{-1}$ 的真有理函数，其极点位于 $z = 0.5$（二重）和 $z = 2$（单重）。收敛域（ROC）指定为 $0.5  |z|  2$。\n\n仅使用Z变换反演的第一性原理（双边Z变换的定义以及与ROC一致的幂级数展开），执行以下操作：\n- 将 $X(z)$ 分解为部分分式。\n- 对每个部分分式项，根据ROC选择正确的时域展开式，并对各部分求和以得到 $x[n]$。\n- 判断得到的 $x[n]$ 是因果的、反因果的还是双边的。\n\n将最终的 $x[n]$ 表示为关于 $n$ 的单个闭式解析表达式，使用单位阶跃序列 $u[n]$ 和 $u[-n-1]$，其中当 $n \\ge 0$ 时 $u[n] = 1$，当 $n  0$ 时 $u[n] = 0$。不需要进行数值取整。", "solution": "在尝试求解之前，将根据所需标准对所述问题进行验证。\n\n### 第1步：提取已知条件\n离散时间信号 $x[n]$ 的双边Z变换为：\n$$\nX(z) = \\frac{1 + 3 z^{-1}}{\\left(1 - 0.5\\, z^{-1}\\right)^{2} \\left(1 - 2\\, z^{-1}\\right)}\n$$\n收敛域（ROC）指定为：\n$$\n0.5  |z|  2\n$$\n任务是通过使用部分分式展开和与给定ROC相关的适当幂级数展开来求时域信号 $x[n]$。最后的任务是将 $x[n]$ 分类为因果、反因果或双边信号。$x[n]$ 的结果必须使用单位阶跃函数 $u[n]$ 和 $u[-n-1]$ 来表示。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学基础**：该问题是离散时间信号处理中的一个标准练习，具体涉及Z变换反演。Z变换、极点、收敛域和因果性的概念在控制理论和数字信号处理领域是基础且成熟的。该问题在数学上和科学上都是合理的。\n2.  **适定性**：Z变换是一个有理函数，并且提供了一个特定的、有效的ROC。这种设置保证了存在唯一、稳定且有意义的反变换 $x[n]$。指令清晰明确。\n3.  **客观性**：问题以精确的数学语言陈述，没有任何主观性、观点或偏见。\n\n### 第3步：结论与行动\n该问题是有效的。这是一个适定的标准问题，旨在检验复分析在离散时间系统中的应用基本原理。我将继续进行求解。\n\n求解需要对 $X(z)$ 进行部分分式展开（PFE）。为便于分析，我们将 $0.5$ 表示为分数 $\\frac{1}{2}$。$X(z)$ 的表达式为：\n$$\nX(z) = \\frac{1 + 3 z^{-1}}{\\left(1 - \\frac{1}{2} z^{-1}\\right)^{2} \\left(1 - 2 z^{-1}\\right)}\n$$\n我们提出如下形式的部分分式展开：\n$$\nX(z) = \\frac{A}{1 - 2 z^{-1}} + \\frac{B}{1 - \\frac{1}{2} z^{-1}} + \\frac{C}{\\left(1 - \\frac{1}{2} z^{-1}\\right)^{2}}\n$$\n为简化系数计算，令 $v = z^{-1}$。\n$$\nX(v) = \\frac{1 + 3v}{\\left(1 - \\frac{1}{2}v\\right)^{2} (1 - 2v)} = \\frac{A}{1 - 2v} + \\frac{B}{1 - \\frac{1}{2}v} + \\frac{C}{\\left(1 - \\frac{1}{2}v\\right)^{2}}\n$$\n我们确定系数 $A$、$B$ 和 $C$。\n\n系数 $A$ 可通过Heaviside留数法（也称覆盖法）计算，对应于 $v = 1/2$（即 $z=2$）的单极点：\n$$\nA = \\left. (1 - 2v) X(v) \\right|_{v=1/2} = \\left. \\frac{1 + 3v}{\\left(1 - \\frac{1}{2}v\\right)^{2}} \\right|_{v=1/2} = \\frac{1 + 3\\left(\\frac{1}{2}\\right)}{\\left(1 - \\frac{1}{2}\\left(\\frac{1}{2}\\right)\\right)^{2}} = \\frac{1 + \\frac{3}{2}}{\\left(1 - \\frac{1}{4}\\right)^{2}} = \\frac{\\frac{5}{2}}{\\left(\\frac{3}{4}\\right)^{2}} = \\frac{\\frac{5}{2}}{\\frac{9}{16}} = \\frac{5}{2} \\cdot \\frac{16}{9} = \\frac{40}{9}\n$$\n系数 $C$ 对应于 $v=2$（即 $z=0.5$）的重极点的最高次幂：\n$$\nC = \\left. \\left(1 - \\frac{1}{2}v\\right)^{2} X(v) \\right|_{v=2} = \\left. \\frac{1 + 3v}{1 - 2v} \\right|_{v=2} = \\frac{1 + 3(2)}{1 - 2(2)} = \\frac{1+6}{1-4} = \\frac{7}{-3} = -\\frac{7}{3}\n$$\n为求系数 $B$，我们可以通分并令分子相等：\n$$\n1 + 3v = A\\left(1 - \\frac{1}{2}v\\right)^{2} + B(1 - 2v)\\left(1 - \\frac{1}{2}v\\right) + C(1 - 2v)\n$$\n代入一个方便的值，例如 $v=0$，可得到一个关于 $B$ 的简单线性方程：\n$$\n1 + 3(0) = A(1)^2 + B(1)(1) + C(1) \\implies 1 = A + B + C\n$$\n求解 $B$：\n$$\nB = 1 - A - C = 1 - \\frac{40}{9} - \\left(-\\frac{7}{3}\\right) = 1 - \\frac{40}{9} + \\frac{21}{9} = \\frac{9}{9} - \\frac{40}{9} + \\frac{21}{9} = \\frac{9 - 40 + 21}{9} = \\frac{-10}{9}\n$$\n因此，$X(z)$ 的部分分式展开为：\n$$\nX(z) = \\frac{\\frac{40}{9}}{1 - 2 z^{-1}} - \\frac{\\frac{10}{9}}{1 - \\frac{1}{2} z^{-1}} - \\frac{\\frac{7}{3}}{\\left(1 - \\frac{1}{2} z^{-1}\\right)^{2}}\n$$\n现在，我们必须根据收敛域 $0.5  |z|  2$ 对每一项求Z变换反演。基本变换对如下：\n1. $a^n u[n] \\quad \\Leftrightarrow \\quad \\frac{1}{1-az^{-1}}$，ROC为 $|z|  |a|$ (因果序列)。\n2. $-a^n u[-n-1] \\quad \\Leftrightarrow \\quad \\frac{1}{1-az^{-1}}$，ROC为 $|z|  |a|$ (反因果序列)。\n3. $(n+1)a^n u[n] \\quad \\Leftrightarrow \\quad \\frac{1}{(1-az^{-1})^2}$，ROC为 $|z|  |a|$ (因果序列)。\n4. $-(n+1)a^n u[-n-1] \\quad \\Leftrightarrow \\quad \\frac{1}{(1-az^{-1})^2}$，ROC为 $|z|  |a|$ (反因果序列)。\n\n我们对 $X(z) = X_1(z) + X_2(z) + X_3(z)$ 的每一项进行反演。\n\n第1项：$X_1(z) = \\frac{40/9}{1 - 2 z^{-1}}$。极点位于 $|z|=2$。收敛域为 $|z|  2$，因此我们必须使用反因果形式（变换对2），其中 $a=2$。\n$$\nx_1[n] = \\frac{40}{9} \\left( -(2)^n u[-n-1] \\right) = -\\frac{40}{9} (2)^n u[-n-1]\n$$\n第2项：$X_2(z) = \\frac{-10/9}{1 - \\frac{1}{2} z^{-1}}$。极点位于 $|z|=0.5$。收敛域为 $|z|  0.5$，因此我们必须使用因果形式（变换对1），其中 $a=1/2$。\n$$\nx_2[n] = -\\frac{10}{9} \\left(\\frac{1}{2}\\right)^n u[n]\n$$\n第3项：$X_3(z) = \\frac{-7/3}{(1 - \\frac{1}{2} z^{-1})^2}$。极点位于 $|z|=0.5$。收敛域为 $|z|  0.5$，因此我们必须使用因果形式（变换对3），其中 $a=1/2$。\n$$\nx_3[n] = -\\frac{7}{3} (n+1) \\left(\\frac{1}{2}\\right)^n u[n]\n$$\n总信号 $x[n]$ 是这些分量的和：$x[n] = x_1[n] + x_2[n] + x_3[n]$。\n$$\nx[n] = -\\frac{40}{9} (2)^n u[-n-1] - \\frac{10}{9} \\left(\\frac{1}{2}\\right)^n u[n] - \\frac{7}{3} (n+1) \\left(\\frac{1}{2}\\right)^n u[n]\n$$\n我们合并乘以 $u[n]$ 的项：\n$$\nx[n] = -\\frac{40}{9} (2)^n u[-n-1] + \\left( -\\frac{10}{9} - \\frac{7}{3}(n+1) \\right) \\left(\\frac{1}{2}\\right)^n u[n]\n$$\n简化因果部分的系数：\n$$\n-\\frac{10}{9} - \\frac{21}{9}(n+1) = -\\frac{1}{9} [10 + 21(n+1)] = -\\frac{1}{9} (10 + 21n + 21) = -\\frac{1}{9}(21n + 31)\n$$\n因此，信号的最终表达式为：\n$$\nx[n] = -\\frac{40}{9} (2)^n u[-n-1] - \\frac{21n + 31}{9} \\left(\\frac{1}{2}\\right)^n u[n]\n$$\n最后，我们确定信号的性质。包含 $u[-n-1]$ 的项在 $n \\le -1$ 时非零，代表一个反因果分量。包含 $u[n]$ 的项在 $n \\ge 0$ 时非零，代表一个因果分量。由于信号 $x[n]$ 在 $n  0$ 和 $n \\ge 0$ 时都有非零值，因此它是一个**双边**信号。这与给定的收敛域（一个环形区域）是一致的。", "answer": "$$\n\\boxed{-\\frac{40}{9} (2)^{n} u[-n-1] - \\frac{21n+31}{9} \\left(\\frac{1}{2}\\right)^{n} u[n]}\n$$", "id": "2757909"}, {"introduction": "在系统分析中，Z变换表达式中出现重极点是很常见的情况。本练习要求你从第一性原理出发，处理一个含有高阶重极点的函数，而不是简单套用现成的变换对 [@problem_id:2757913]。通过推导，你将深刻理解为何Z域中的 $m$ 阶极点对应于时域中一个乘以 $n$ 的 $m-1$ 次多项式的序列，从而建立起数学形式与系统行为之间的直观联系。", "problem": "一个具有双边Z变换 $X(z)$ 的右侧离散时间信号存在重极点。已知 $X(z)$ 是有理的，其收敛域为 $|z|  \\rho$，且该信号是因果且绝对可和的。考虑以下具体情况\n$$\nX(z) \\;=\\; \\frac{1}{\\bigl(1 - \\tfrac{1}{2}\\,z^{-1}\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}\\,z^{-1}\\bigr)^{2}},\n$$\n其收敛域为 $|z|  \\tfrac{1}{2}$。从双边Z变换的定义出发，\n$$\n\\mathcal{Z}\\{x[n]\\}(z) \\;=\\; X(z) \\;=\\; \\sum_{n=-\\infty}^{\\infty} x[n]\\,z^{-n},\n$$\n并且仅使用诸如线性性质、几何级数及其通过重复求和或微分得到的推广形式等基本结果（但不借助任何预先记好的逆变换捷径），完成以下任务：\n\n- 通过确定与在 $p=\\tfrac{1}{2}$ 处阶数为 $m=3$ 和在 $p=-\\tfrac{1}{3}$ 处阶数为 $m=2$ 的重极点相关联的系数 $C$，将 $X(z)$ 分解为形如 $\\dfrac{C}{\\bigl(1 - p\\,z^{-1}\\bigr)^{m}}$ 的项的和。\n\n- 从第一性原理出发，通过展开成 $z^{-1}$ 的幂级数并识别关于 $n$ 的系数，为每个重极点项推导其对应的时域序列。将你的推导与二项式展开明确联系起来，以表明这些系数是乘以 $p^{n}$ 的、关于 $n$ 的 $m-1$ 次多项式，并解释这与和 $n^{m-1}\\,p^{n}$ 成正比的主阶行为有何关系。\n\n使用单位阶跃函数 $u[n]$ 来表示因果性，将你的最终结果表示为对所有 $n \\in \\mathbb{Z}$ 有效的 $x[n]$ 的单一闭合形式解析表达式。不要将答案保留为求和形式。无需四舍五入，也不涉及物理单位。", "solution": "该问题要求确定一个具有重极点的给定有理函数 $X(z)$ 的Z反变换。求解过程必须从第一性原理出发，避免直接使用Z变换对的查找表。该过程包括两个主要阶段：对 $X(z)$ 进行部分分式展开，以及对每一项进行基于原理的逆变换。\n\n给定的Z变换为：\n$$\nX(z) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}\\,z^{-1}\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}\\,z^{-1}\\bigr)^{2}}\n$$\n给定的收敛域 (ROC) 为 $|z|  \\frac{1}{2}$。$X(z)$ 的极点位于 $z = \\frac{1}{2}$ (3阶) 和 $z = -\\frac{1}{3}$ (2阶)。由于收敛域是包含所有极点的圆的外部，信号 $x[n]$ 是因果的、右侧的，这与问题陈述一致。收敛域包含单位圆 $|z|=1$ 这一事实证实了信号是绝对可和的陈述。\n\n让我们定义一个变量 $v = z^{-1}$。该函数变为：\n$$\nF(v) = X(z) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}v\\bigr)^{3}\\,\\bigl(1 + \\tfrac{1}{3}v\\bigr)^{2}}\n$$\n这是关于 $v$ 的一个真有理函数。我们寻求以下形式的部分分式展开：\n$$\nF(v) = \\frac{A_1}{1 - \\frac{1}{2}v} + \\frac{A_2}{\\bigl(1 - \\frac{1}{2}v\\bigr)^2} + \\frac{A_3}{\\bigl(1 - \\frac{1}{2}v\\bigr)^3} + \\frac{B_1}{1 + \\frac{1}{3}v} + \\frac{B_2}{\\bigl(1 + \\frac{1}{3}v\\bigr)^2}\n$$\n为了求出与极点 $v=2$ 相关联的系数 $A_k$，我们通过移除极点因子来定义函数 $G_A(v)$：\n$$\nG_A(v) = \\bigl(1 - \\tfrac{1}{2}v\\bigr)^3 F(v) = \\frac{1}{\\bigl(1 + \\tfrac{1}{3}v\\bigr)^2} = \\bigl(1 + \\tfrac{1}{3}v\\bigr)^{-2}\n$$\n系数 $A_k$ 与 $G_A(v)$ 在点 $v=2$ 附近的泰勒级数展开有关。我们有：\n$$\nG_A(v) = A_3 + A_2\\bigl(1 - \\tfrac{1}{2}v\\bigr) + A_1\\bigl(1 - \\tfrac{1}{2}v\\bigr)^2 + \\dots\n$$\n通过令 $v=p' = 1/(1/2) = 2$，并注意到展开变量是 $x = (1 - v/p')$，系数由公式 $A_{3-k} = \\frac{(-p')^k}{k!} G_A^{(k)}(p')$ 给出，其中 $G_A^{(k)}$ 是 $G_A$ 的 $k$ 阶导数。\n\n对于 $k=0$：\n$A_3 = G_A(2) = \\bigl(1 + \\frac{2}{3}\\bigr)^{-2} = \\bigl(\\frac{5}{3}\\bigr)^{-2} = \\frac{9}{25}$。\n\n对于 $k=1$：\n$G_A'(v) = -2\\bigl(1 + \\frac{1}{3}v\\bigr)^{-3} \\cdot \\frac{1}{3} = -\\frac{2}{3}\\bigl(1 + \\frac{1}{3}v\\bigr)^{-3}$。\n$G_A'(2) = -\\frac{2}{3}\\bigl(\\frac{5}{3}\\bigr)^{-3} = -\\frac{2}{3} \\cdot \\frac{27}{125} = -\\frac{18}{125}$。\n$A_2 = \\frac{(-2)^1}{1!} G_A'(2) = -2 \\cdot \\bigl(-\\frac{18}{125}\\bigr) = \\frac{36}{125}$。\n\n对于 $k=2$：\n$G_A''(v) = -\\frac{2}{3} \\cdot (-3)\\bigl(1 + \\frac{1}{3}v\\bigr)^{-4} \\cdot \\frac{1}{3} = \\frac{2}{3}\\bigl(1 + \\frac{1}{3}v\\bigr)^{-4}$。\n$G_A''(2) = \\frac{2}{3}\\bigl(\\frac{5}{3}\\bigr)^{-4} = \\frac{2}{3} \\cdot \\frac{81}{625} = \\frac{54}{625}$。\n$A_1 = \\frac{(-2)^2}{2!} G_A''(2) = \\frac{4}{2} \\cdot \\frac{54}{625} = \\frac{108}{625}$。\n\n类似地，对于与极点 $v=-3$ 相关联的系数 $B_k$：\n$$\nG_B(v) = \\bigl(1 + \\tfrac{1}{3}v\\bigr)^2 F(v) = \\frac{1}{\\bigl(1 - \\tfrac{1}{2}v\\bigr)^3} = \\bigl(1 - \\tfrac{1}{2}v\\bigr)^{-3}\n$$\n展开点是 $p' = 1/(-1/3) = -3$。\n对于 $k=0$：\n$B_2 = G_B(-3) = \\bigl(1 - \\frac{1}{2}(-3)\\bigr)^{-3} = \\bigl(1 + \\frac{3}{2}\\bigr)^{-3} = \\bigl(\\frac{5}{2}\\bigr)^{-3} = \\frac{8}{125}$。\n\n对于 $k=1$：\n$G_B'(v) = -3\\bigl(1 - \\frac{1}{2}v\\bigr)^{-4} \\cdot (-\\frac{1}{2}) = \\frac{3}{2}\\bigl(1 - \\frac{1}{2}v\\bigr)^{-4}$。\n$G_B'(-3) = \\frac{3}{2}\\bigl(1 - \\frac{1}{2}(-3)\\bigr)^{-4} = \\frac{3}{2}\\bigl(\\frac{5}{2}\\bigr)^{-4} = \\frac{3}{2} \\cdot \\frac{16}{625} = \\frac{24}{625}$。\n$B_1 = \\frac{(-p')^1}{1!} G_B'(-3) = \\frac{-(-3)}{1} \\cdot \\frac{24}{625} = 3 \\cdot \\frac{24}{625} = \\frac{72}{625}$。\n\n部分分式展开为：\n$$\nX(z) = \\frac{108/625}{1 - \\frac{1}{2}z^{-1}} + \\frac{36/125}{\\bigl(1 - \\frac{1}{2}z^{-1}\\bigr)^2} + \\frac{9/25}{\\bigl(1 - \\frac{1}{2}z^{-1}\\bigr)^3} + \\frac{72/625}{1 + \\frac{1}{3}z^{-1}} + \\frac{8/125}{\\bigl(1 + \\frac{1}{3}z^{-1}\\bigr)^2}\n$$\n接下来，我们从第一性原理出发，推导每一项的Z反变换。其基本构成单元是因果信号的几何级数：\n$$\n\\frac{1}{1 - pz^{-1}} = \\sum_{n=0}^{\\infty} (pz^{-1})^n = \\sum_{n=0}^{\\infty} p^n z^{-n}\n$$\n将其与定义 $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$ 进行比较，我们识别出对应的时域序列为 $p^n u[n]$，其中 $u[n]$ 是单位阶跃函数。\n\n为了求出具有重极点项的Z反变换，我们使用微分法。对几何级数关系式关于 $p$ 求导：\n$$\n\\frac{\\partial}{\\partial p}\\left(\\frac{1}{1 - pz^{-1}}\\right) = \\frac{z^{-1}}{(1 - pz^{-1})^2} \\quad \\text{和} \\quad \\frac{\\partial}{\\partial p}\\left(\\sum_{n=0}^{\\infty} p^n z^{-n}\\right) = \\sum_{n=0}^{\\infty} n p^{n-1} z^{-n}\n$$\n令两者相等可得 $\\frac{1}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} n p^{n-1} z^{-(n-1)} = z \\sum_{n=0}^{\\infty} n p^{n-1} z^{-n}$。这条路径不直接。一个更好的方法是关于 $z^{-1}$ 求导：\n$$\n\\frac{d}{d(z^{-1})} \\left(\\frac{1}{1-pz^{-1}}\\right) = \\frac{p}{(1-pz^{-1})^2} \\quad \\text{和} \\quad \\frac{d}{d(z^{-1})} \\left(\\sum_{n=0}^{\\infty} p^n (z^{-1})^n \\right) = \\sum_{n=1}^{\\infty} n p^n (z^{-1})^{n-1}\n$$\n令 $k=n-1$，级数为 $\\sum_{k=0}^{\\infty} (k+1) p^{k+1} (z^{-1})^k$。因此，\n$$\n\\frac{p}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} (n+1) p^{n+1} z^{-n} \\implies \\frac{1}{(1-pz^{-1})^2} = \\sum_{n=0}^{\\infty} (n+1) p^n z^{-n}\n$$\n对应的序列是 $(n+1)p^n u[n]$。\n\n或者，使用广义二项式定理 $(1-x)^{-m} = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{n} x^n$：\n$$\n\\frac{1}{(1-pz^{-1})^m} = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{n} (pz^{-1})^n = \\sum_{n=0}^{\\infty} \\binom{n+m-1}{m-1} p^n z^{-n}\n$$\nZ反变换是 $\\binom{n+m-1}{m-1} p^n u[n]$。二项式系数 $\\binom{n+m-1}{m-1} = \\frac{(n+m-1)\\dots(n+1)}{(m-1)!}$ 是一个关于 $n$ 的 $m-1$ 次多项式。其首项是 $\\frac{n^{m-1}}{(m-1)!}$，因此当 $n$ 很大时，序列的行为类似于 $n^{m-1}p^n$。\n\n对于 $m=2$，我们有 $\\binom{n+1}{1} = n+1$，这证实了我们的微分结果。\n对于 $m=3$，我们有 $\\binom{n+2}{2} = \\frac{(n+2)(n+1)}{2}$。\n\n使用这些推导出的变换对和Z变换的线性性质，我们求得 $x[n]$：\n$x[n] = \\mathcal{Z}^{-1}\\{X(z)\\} = x_1[n] + x_2[n] + x_3[n] + x_4[n] + x_5[n]$。\n$x_1[n] = \\frac{108}{625} (\\frac{1}{2})^n u[n]$\n$x_2[n] = \\frac{36}{125} (n+1) (\\frac{1}{2})^n u[n]$\n$x_3[n] = \\frac{9}{25} \\binom{n+2}{2} (\\frac{1}{2})^n u[n] = \\frac{9}{50} (n+2)(n+1) (\\frac{1}{2})^n u[n]$\n$x_4[n] = \\frac{72}{625} (-\\frac{1}{3})^n u[n]$\n$x_5[n] = \\frac{8}{125} (n+1) (-\\frac{1}{3})^n u[n]$\n\n合并各项：\n$x[n] = \\left[ \\frac{108}{625} + \\frac{36}{125}(n+1) + \\frac{9}{50}(n^2+3n+2) \\right] \\left(\\frac{1}{2}\\right)^n u[n] \\\\ \\qquad + \\left[ \\frac{72}{625} + \\frac{8}{125}(n+1) \\right] \\left(-\\frac{1}{3}\\right)^n u[n]$\n\n化简多项式系数。对于第一项：\n$P_1(n) = \\frac{9}{50}n^2 + \\left(\\frac{36}{125} + \\frac{27}{50}\\right)n + \\left(\\frac{108}{625} + \\frac{36}{125} + \\frac{18}{50}\\right)$\n$P_1(n) = \\frac{225}{1250}n^2 + \\left(\\frac{360}{1250} + \\frac{675}{1250}\\right)n + \\left(\\frac{216}{1250} + \\frac{360}{1250} + \\frac{450}{1250}\\right)$\n$P_1(n) = \\frac{225 n^2 + 1035 n + 1026}{1250} = \\frac{9}{1250}(25n^2 + 115n + 114)$\n\n对于第二项：\n$P_2(n) = \\frac{8}{125}n + \\left(\\frac{72}{625} + \\frac{8}{125}\\right) = \\frac{40}{625}n + \\left(\\frac{72}{625} + \\frac{40}{625}\\right)$\n$P_2(n) = \\frac{40n + 112}{625} = \\frac{8}{625}(5n + 14)$\n\n$x[n]$ 的最终表达式为：\n$x[n] = \\left( \\frac{9}{1250}(25n^2 + 115n + 114) \\left(\\frac{1}{2}\\right)^n + \\frac{8}{625}(5n + 14) \\left(-\\frac{1}{3}\\right)^n \\right) u[n]$\n这是对所有 $n \\in \\mathbb{Z}$ 的序列 $x[n]$ 的完整闭合形式表达式。", "answer": "$$\n\\boxed{\\left( \\frac{9}{1250}(25n^2 + 115n + 114) \\left(\\frac{1}{2}\\right)^n + \\frac{8}{625}(5n + 14) \\left(-\\frac{1}{3}\\right)^n \\right) u[n]}\n$$", "id": "2757913"}, {"introduction": "在工程实践中，终值定理 (Final Value Theorem) 是一个预测系统稳态行为的快捷工具，但其应用有严格的前提条件。本练习旨在通过两个精心设计的反例，揭示在不满足稳定性条件时滥用该定理的风险 [@problem_id:2757911]。通过分析系统极点位置与实际时域响应之间的关系，你将学会如何批判性地使用分析工具，避免得出错误的结论。", "problem": "考虑两个因果离散时间线性时不变 (LTI) 系统，其输入为单位阶跃输入 $u[k]$，定义为当 $k0$ 时 $u[k]=0$ 且当 $k\\ge 0$ 时 $u[k]=1$。设它们的传递函数（脉冲响应的Z变换）为\n- 系统 $\\mathcal{S}_1$：$H_1(z)=\\dfrac{z}{z-1.1}$，\n- 系统 $\\mathcal{S}_2$：$H_2(z)=\\dfrac{z}{z+1}$。\n\n一个常用但有风险的捷径是，在不检查其适用条件的情况下，应用Z变换的终值定理来推断输出 $y[k]$ 的稳态值 $\\lim_{k\\to\\infty} y[k]$。具体来说，即使稳定​​性或极点位置的要求未被满足，人们也可能通过计算输出来自Z域表示的在 $z=1$ 处的极限，从而得到一个有限的候选数值。\n\n仅使用关于Z变换、因果性、收敛域和极点位置的基本定义和事实，判断对于每个系统，这种幼稚的捷径是否会产生一个有限的“终值”预测，以及实际的时域输出 $y[k]$ 是否在 $k\\to\\infty$ 时收敛。然后，根据相关Z域表达式的极点相对于单位圆的位置，找出正确的解释。\n\n哪个选项是正确的？\n\nA. $\\mathcal{S}_1$ 和 $\\mathcal{S}_2$ 都是反例：对每个系统，幼稚的“终值”计算都得出一个有限的数值，即 $\\mathcal{S}_1$ 为 $-10$，$\\mathcal{S}_2$ 为 $\\tfrac{1}{2}$，然而实际的 $y_1[k]$ 在幅值上发散（指数增长），而 $y_2[k]$ 不收敛（持续振荡）。失败的原因是，相关的Z域表达式分别在单位圆外的 $z=1.1$ 处有一个极点，以及在单位圆上的 $z=-1$ 处有一个极点。\n\nB. 只有 $\\mathcal{S}_1$ 是反例：幼稚的“终值”是有限的（$-10$），但 $y_1[k]$ 收敛到另一个不同的有限值；对于 $\\mathcal{S}_2$，幼稚的“终值” ($\\tfrac{1}{2}$) 与 $\\lim_{k\\to\\infty} y_2[k]$ 一致。\n\nC. 只有 $\\mathcal{S}_2$ 是反例：幼稚的“终值”是有限的（$\\tfrac{1}{2}$），但 $y_2[k]$ 在幅值上发散；对于 $\\mathcal{S}_1$，幼稚的“终值”（$-10$）与 $\\lim_{k\\to\\infty} y_1[k]$ 一致。\n\nD. $\\mathcal{S}_1$ 和 $\\mathcal{S}_2$ 都不是反例：在两种情况下，幼稚的“终值”都等于真实的 $\\lim_{k\\to\\infty} y[k]$，因为只要该极限在代数操作中作为有限数存在，代入 $z\\to 1$ 就是合理的。", "solution": "在尝试任何解决方案之前，对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 因果离散时间线性时不变 (LTI) 系统 $\\mathcal{S}_1$ 和 $\\mathcal{S}_2$。\n- 输入：单位阶跃 $u[k]$，其中当 $k0$ 时 $u[k]=0$，当 $k\\ge 0$ 时 $u[k]=1$。\n- 系统 $\\mathcal{S}_1$ 的传递函数：$H_1(z)=\\dfrac{z}{z-1.1}$。\n- 系统 $\\mathcal{S}_2$ 的传递函数：$H_2(z)=\\dfrac{z}{z+1}$。\n- 任务：分析终值定理的一种幼稚应用，即在不检查适用条件的情况下，通过计算在 $z=1$ 处的极限来得到一个“终值”。对每个系统，将这个幼稚的结果与输出 $y[k]$ 的实际极限行为进行比较，并根据极点位置解释结果。\n\n**步骤 2：使用提取的已知条件进行验证**\n- 该问题在离散时间控制系统和Z变换的既定理论上具有**科学依据**。\n- 该问题是**适定的**，提供了所有必要的函数 ($H_1(z), H_2(z)$) 和输入 ($u[k]$) 以唯一确定输出 ($y_1[k], y_2[k]$) 及其属性。术语“因果”明确定义了系统的收敛域 (ROC)。\n- 该问题是**客观的**，以精确的数学语言陈述。\n- 问题设定是**完整且一致的**。\n\n**步骤 3：结论和行动**\n问题陈述被认定为有效。现在将进行严谨的求解推导。\n\n分析基于基本原理。输入单位阶跃函数 $u[k]$ 的Z变换由下式给出\n$$U(z) = \\mathcal{Z}\\{u[k]\\} = \\sum_{k=0}^{\\infty} (1)z^{-k} = \\frac{1}{1-z^{-1}} = \\frac{z}{z-1}, \\quad |z|1$$\nLTI 系统的输出 $Y(z)$ 的Z变换是传递函数 $H(z)$ 和输入Z变换 $U(z)$ 的乘积，即 $Y(z) = H(z)U(z)$。Z变换的终值定理指出，如果序列 $y[k]$ 收敛到一个有限极限，则 $\\lim_{k\\to\\infty} y[k] = \\lim_{z\\to 1} (z-1)Y(z)$。该定理适用的一个充分条件是，函数 $(z-1)Y(z)$ 的所有极点必须严格位于单位圆内部，即其模长小于1。问题中提到的“幼稚的捷径”包括计算极限 $\\lim_{z\\to 1} (z-1)Y(z)$ 而不考虑此条件。\n\n**系统 $\\mathcal{S}_1$ 的分析**\n\n传递函数为 $H_1(z) = \\dfrac{z}{z-1.1}$。\n输出的Z变换为\n$$Y_1(z) = H_1(z)U(z) = \\left( \\frac{z}{z-1.1} \\right) \\left( \\frac{z}{z-1} \\right) = \\frac{z^2}{(z-1.1)(z-1)}$$\n幼稚的“终值”计算如下：\n$$y_{1,ss}^{\\text{naive}} = \\lim_{z\\to 1} (z-1)Y_1(z) = \\lim_{z\\to 1} (z-1)\\frac{z^2}{(z-1.1)(z-1)} = \\lim_{z\\to 1} \\frac{z^2}{z-1.1} = \\frac{1^2}{1-1.1} = \\frac{1}{-0.1} = -10$$\n这个计算得出一个有限数-10。\n\n现在，我们检查终值定理的条件。需要检查的函数是 $(z-1)Y_1(z) = \\dfrac{z^2}{z-1.1}$。该函数的极点是分母的根，即 $z-1.1=0$，得到一个极点在 $z=1.1$。该极点的模长是 $|1.1|  1$，位于单位圆之外。该定理不适用。\n\n为了找到输出 $y_1[k]$ 的实际行为，我们必须计算 $Y_1(z)$ 的Z反变换。我们对 $Y_1(z)/z$ 进行部分分式展开：\n$$\\frac{Y_1(z)}{z} = \\frac{z}{(z-1.1)(z-1)} = \\frac{A}{z-1.1} + \\frac{B}{z-1}$$\n系数为：\n$$A = \\left. \\frac{z}{z-1} \\right|_{z=1.1} = \\frac{1.1}{1.1-1} = \\frac{1.1}{0.1} = 11$$\n$$B = \\left. \\frac{z}{z-1.1} \\right|_{z=1} = \\frac{1}{1-1.1} = \\frac{1}{-0.1} = -10$$\n因此，\n$$Y_1(z) = 11 \\left( \\frac{z}{z-1.1} \\right) - 10 \\left( \\frac{z}{z-1} \\right)$$\n使用Z变换对 $\\mathcal{Z}\\{a^k u[k]\\} = \\frac{z}{z-a}$ (对于 $|z||a|$)，反变换为：\n$$y_1[k] = \\left( 11(1.1)^k - 10(1)^k \\right) u[k] = (11(1.1)^k - 10)u[k]$$\n当 $k \\to \\infty$ 时，由于其底数 $1.1$ 大于 $1$，项 $(1.1)^k$ 无界增长。因此，$\\lim_{k\\to\\infty} y_1[k] = \\infty$。输出呈指数增长并发散。\n\n对 $\\mathcal{S}_1$ 的结论：幼稚的计算得出一个有限值-10，但实际输出是发散的。这是对幼稚捷径的一个反例。失败的原因可以正确地归因于 $(z-1)Y_1(z)$ 在 $z=1.1$ 处的极点，该极点位于单位圆之外。\n\n**系统 $\\mathcal{S}_2$ 的分析**\n\n传递函数为 $H_2(z) = \\dfrac{z}{z+1}$。\n输出的Z变换为\n$$Y_2(z) = H_2(z)U(z) = \\left( \\frac{z}{z+1} \\right) \\left( \\frac{z}{z-1} \\right) = \\frac{z^2}{(z+1)(z-1)}$$\n幼稚的“终值”计算如下：\n$$y_{2,ss}^{\\text{naive}} = \\lim_{z\\to 1} (z-1)Y_2(z) = \\lim_{z\\to 1} (z-1)\\frac{z^2}{(z+1)(z-1)} = \\lim_{z\\to 1} \\frac{z^2}{z+1} = \\frac{1^2}{1+1} = \\frac{1}{2}$$\n这个计算得出一个有限数 $\\frac{1}{2}$。\n\n我们检查终值定理的条件。需要检查的函数是 $(z-1)Y_2(z) = \\dfrac{z^2}{z+1}$。其极点是 $z+1=0$ 的根，即 $z=-1$。模长为 $|-1|=1$。单位圆上的极点（除了 $Y(z)$ 中在 $z=1$ 处被消掉的单个极点外）违反了极点必须在单位圆*内部*的严格要求。该定理不适用。\n\n为了找到 $y_2[k]$ 的实际行为，我们对 $Y_2(z)/z$ 进行部分分式展开：\n$$\\frac{Y_2(z)}{z} = \\frac{z}{(z+1)(z-1)} = \\frac{A}{z+1} + \\frac{B}{z-1}$$\n系数为：\n$$A = \\left. \\frac{z}{z-1} \\right|_{z=-1} = \\frac{-1}{-1-1} = \\frac{1}{2}$$\n$$B = \\left. \\frac{z}{z+1} \\right|_{z=1} = \\frac{1}{1+1} = \\frac{1}{2}$$\n因此，\n$$Y_2(z) = \\frac{1}{2} \\left( \\frac{z}{z+1} \\right) + \\frac{1}{2} \\left( \\frac{z}{z-1} \\right)$$\nZ反变换为：\n$$y_2[k] = \\left( \\frac{1}{2}(-1)^k + \\frac{1}{2}(1)^k \\right) u[k] = \\frac{1}{2}(1 + (-1)^k)u[k]$$\n对于 $k \\ge 0$，$y_2[k]$ 序列为 $1, 0, 1, 0, 1, \\dots$。该序列在0和1之间振荡，不收敛于单一值。因此，$\\lim_{k\\to\\infty} y_2[k]$ 不存在。\n\n对 $\\mathcal{S}_2$ 的结论：幼稚的计算得出一个有限值 $\\frac{1}{2}$，但实际输出不收敛。这也是对幼稚捷径的一个反例。失败的原因可以正确地归因于 $(z-1)Y_2(z)$ 在 $z=-1$ 处的极点，该极点位于单位圆上。\n\n**选项评估**\n\nA. **正确**。该选项正确地指出两个系统都是反例。它提供了正确的幼稚终值：$\\mathcal{S}_1$ 为 $-10$，$\\mathcal{S}_2$ 为 $\\frac{1}{2}$。它准确地描述了输出的真实行为：$y_1[k]$ 指数发散，$y_2[k]$ 表现出持续振荡（不收敛）。至关重要的是，它通过指出相关表达式 $(z-1)Y_1(z)$ 在 $z=1.1$ 处（单位圆外）和 $(z-1)Y_2(z)$ 在 $z=-1$ 处（单位圆上）的极点，为终值定理的失败提供了正确的理由。\n\nB. **不正确**。该选项在多个方面都是错误的。它声称 $y_1[k]$ 收敛，而实际上它发散。它还声称 $\\mathcal{S}_2$ 的幼稚终值和实际终值一致，而实际上 $y_2[k]$ 根本不收敛。\n\nC. **不正确**。该选项错误地声称 $\\mathcal{S}_1$ 的幼稚值与其极限一致，这是错误的，因为输出是发散的。它还错误地将 $y_2[k]$ 的行为描述为幅值发散，而实际上它是有界振荡的。\n\nD. **不正确**。该选项错误地声称两个系统都不是反例。根据上面的推导，这显然是错误的。所提供的理由恰恰是该问题旨在揭示的谬误：终值定理的有效性不是由代数极限的存在保证的，而是取决于极点的位置。", "answer": "$$\\boxed{A}$$", "id": "2757911"}]}