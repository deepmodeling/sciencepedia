## 引言
在现代控制理论中，状态空间方法为描述、分析和设计动态系统提供了强有力的框架。然而，同一个物理系统可以通过无穷多组[状态变量](@entry_id:138790)来描述，导致其[状态空间表示](@entry_id:147149)并非唯一。这种表示上的不确定性给比较不同系统或系统化地设计控制器带来了挑战。规范型（Normal Form）或典范型（Canonical Form）表示的提出，正是为了解决这一问题。它旨在通过特定的坐标变换，将系统转化为一种具有标准、简洁结构的数学形式，从而揭示出系统固有的、与坐标选择无关的本质属性。

本文旨在系统性地梳理控制领域中核心的规范型理论。通过学习本文，读者将深入理解不同规范型的构建原理、[代数结构](@entry_id:137052)及其在[控制工程](@entry_id:149859)中的深刻意义。文章将分为三个核心部分：第一章“原理与机制”将奠定理论基础，详细介绍基于[相似变换](@entry_id:152935)和反馈等价的各类经典规范型，如可控/可观规范型、[Kalman分解](@entry_id:144281)、Brunovsky型及其理论局限性。第二章“应用与跨学科联系”将理论与实践相结合，探讨这些规范型在[控制器设计](@entry_id:274982)、[模型降阶](@entry_id:171175)、[非线性](@entry_id:637147)控制及数值计算等领域的具体应用和[交叉](@entry_id:147634)。最后，第三章“动手实践”将提供一系列精心设计的问题，帮助读者巩固理论知识并提升解决实际问题的能力。

## 原理与机制

在控制理论中，一个给定的线性或非线性系统通常可以通过多种状态空间表达式来描述。规范型（Normal Form）或典范型（Canonical Form）是一种特殊的、结构化的[状态空间表示](@entry_id:147149)，它能够揭示系统内在的、坐标无关的性质。通过将系统变换到其规范型，我们不仅可以简化[控制系统分析](@entry_id:261228)与设计的复杂性，还能更深刻地理解系统的结构特性，如[可控性](@entry_id:148402)、[可观测性](@entry_id:152062)、解耦能力以及内在的性能局限。本章将深入探讨几种核心规范型的基本原理、构造方法及其在控制工程中的意义。

### 规范型的基本概念：等价变换与坐标选择

规范型的核心思想在于定义一种“[等价关系](@entry_id:138275)”，如果两个系统表示可以通过该关系相互转换，则它们被认为是等价的。同一等价类中的所有系统共享某些关键特性，而规范型就是这个[等价类](@entry_id:156032)中一个结构最简、最具[代表性](@entry_id:204613)的成员。

最基础的等价关系是**相似变换**（Similarity Transformation）。对于一个[线性时不变](@entry_id:276287)（LTI）系统 $(\dot{x} = Ax + Bu, y = Cx + Du)$，如果我们引入一个新的状态向量 $z = Tx$，其中 $T$ 是一个可逆矩阵，那么在新的 $z$ [坐标系](@entry_id:156346)下，系统由 $(\dot{z} = A'z + B'u, y = C'z + D'u)$ 描述，其中 $A' = TAT^{-1}$, $B' = TB$, $C' = CT^{-1}$, $D' = D$。相似变换保持了系统的外部特性，即[传递函数矩阵](@entry_id:271746) $G(s) = C(sI - A)^{-1}B + D$ 在变换下不变。许多经典规范型，如可控和可观测规范型，都是在相似变换的框架下定义的。

然而，仅仅改变状态坐标有时不足以揭示系统的全部控制潜力。一种更强大的[等价关系](@entry_id:138275)是**静态[状态反馈](@entry_id:151441)等价**（Static State-Feedback Equivalence）。这种变换不仅包括状态坐标变换 $z=Tx$，还允许通过静态[状态反馈](@entry_id:151441) $u = Fx + Kv$ 来重新定义系统的输入，其中 $F$ 是[反馈增益](@entry_id:271155)矩阵，$K$ 是一个可逆矩阵，$v$ 是新的外部输入。这种复合变换 $(x, u) \mapsto (z, v) = (Tx, Fx+Ku)$ 形成了一个变换群，它保持了系统的[可控性](@entry_id:148402)指数等更深层次的[结构不变量](@entry_id:145830)。

在这种变换下，原系统 $(A, B, C, D)$ 被转化为一个新的系统 $(A', B', C', D')$，其矩阵形式为 [@problem_id:2728125]：
$$
A' = T(A - BK^{-1}F)T^{-1}
$$
$$
B' = TBK^{-1}
$$
$$
C' = (C - DK^{-1}F)T^{-1}
$$
$$
D' = DK^{-1}
$$
值得注意的是，[状态反馈](@entry_id:151441)改变了系统的[闭环极点](@entry_id:274094)，因此[传递函数](@entry_id:273897)会发生改变。新的[传递函数](@entry_id:273897) $G'(s)$ 与原[传递函数](@entry_id:273897) $G(s)$ 的关系为 $G'(s) = G(s)R(s)^{-1}$，其中 $R(s) = K - F(sI-A)^{-1}B$ 是一个可逆的有理矩阵，称为预补偿器。这种变换保持了系统的“输入-输出行为，直到预补偿” [@problem_id:2728125]。Brunovsky规范型正是在这种更广泛的[等价关系](@entry_id:138275)下定义的。

### 基于相似变换的经典规范型

在仅允许相似变换的框架下，我们可以根据系统的[可控性](@entry_id:148402)或[可观测性](@entry_id:152062)，将其变换为具有特定[稀疏结构](@entry_id:755138)的规范型。

#### 可控规范型

对于一个单输入单输出（SISO）[LTI系统](@entry_id:271946) $(\dot{x} = Ax + bu)$，如果系统是状态可控的，即其[可控性矩阵](@entry_id:271824) $\mathcal{C} = \begin{pmatrix} b  Ab  \cdots  A^{n-1}b \end{pmatrix}$ 满秩，那么总存在一个相似变换 $x=Tx_c$，能将系统转化为**可控规范型**（Controllable Canonical Form, CCF）。

一种常见的可控规范型形式 $(A_c, b_c)$ 为 [@problem_id:2728112]：
$$
A_c = \begin{bmatrix}
0   1  0  \cdots  0 \\
0   0  1  \cdots  0 \\
\vdots  \vdots  \vdots  \ddots  \vdots \\
0   0  0  \cdots  1 \\
-a_0  -a_1  -a_2  \cdots  -a_{n-1}
\end{bmatrix}, \quad b_c = \begin{bmatrix}
0 \\ 0 \\ \vdots \\ 0 \\ 1
\end{bmatrix}
$$
其中 $a_0, a_1, \dots, a_{n-1}$ 是系统矩阵 $A$ 的特征多项式 $p(\lambda) = \det(\lambda I - A) = \lambda^n + a_{n-1}\lambda^{n-1} + \cdots + a_1\lambda + a_0$ 的系数。这种形式也被称为“[友矩阵](@entry_id:148203)”（Companion Matrix）形式。其结构清晰地展示了系统的特征多项式系数。

这个变换的构造基于一个特定的基选择，即“[可控性](@entry_id:148402)基”。变换矩阵 $T$ 的逆 $T^{-1}$ 可以由[可控性矩阵](@entry_id:271824) $\mathcal{C}$ 和一个与[特征多项式](@entry_id:150909)系数相关的上三角[Toeplitz矩阵](@entry_id:271334)的乘积给出。这个变换的背后是深刻的代数原理，即[Cayley-Hamilton定理](@entry_id:150551)。该定理指出，任何方阵都满足其自身的[特征方程](@entry_id:265849)，即 $p(A)=0$。将这个矩阵多项式作用于输入向量 $b$ 上，我们得到 $p(A)b = (A^n + a_{n-1}A^{n-1} + \cdots + a_0I)b = 0$。这个向量方程正是可控规范型最后一行的代数基础。

#### 可观测规范型与[对偶原理](@entry_id:276615)

与[可控性](@entry_id:148402)对偶（dual）的概念是可观测性。对于一个SISO系统 $(\dot{x}=Ax, y=cx)$，如果系统是可观测的，即其[可观测性矩阵](@entry_id:165052) $\mathcal{O} = \begin{pmatrix} c \\ cA \\ \vdots \\ cA^{n-1} \end{pmatrix}$ 满秩，那么系统可以被[相似变换](@entry_id:152935)到**可观测规范型**（Observable Canonical Form, OCF）。

可观测规范型 $(A_o, c_o)$ 的结构是可控规范型 $(A_c, b_c)$ 的转置，即 $A_o = A_c^\top$，$c_o = b_c^\top$ [@problem_id:2728127]：
$$
A_o = \begin{bmatrix}
0   0  \cdots  0  -a_0 \\
1   0  \cdots  0  -a_1 \\
0   1  \cdots  0  -a_2 \\
\vdots  \vdots  \ddots  \vdots  \vdots \\
0   0  \cdots  1  -a_{n-1}
\end{bmatrix}, \quad c_o = \begin{pmatrix} 0  0  \cdots  0  1 \end{pmatrix}
$$
这种形式的优越性在设计[状态观测器](@entry_id:268642)时体现得淋漓尽致。一个[Luenberger观测器](@entry_id:150581)的误差动态由矩阵 $(A-Lc)$ 的[特征值](@entry_id:154894)决定，其中 $L$ 是[观测器增益](@entry_id:267562)。在可观测规范型坐标下，误差动态矩阵为 $(A_o - L_o c_o)$。由于 $c_o$ 的特殊结构，矩阵 $L_o c_o$ 只有一个非零列（最后一列），其元素就是增益向量 $L_o$ 的分量。这使得闭环误差系统的特征多项式可以直接通过选择 $L_o$ 的分量来任意配置。例如，如果想要的误差[特征多项式](@entry_id:150909)为 $d(s) = s^n + d_{n-1}s^{n-1} + \cdots + d_0$，只需选择增益 $L_o = \begin{pmatrix} l_1  \cdots  l_n \end{pmatrix}^\top$ 使得 $l_k = d_{k-1} - a_{k-1}$，就可以精确地实现期望的误差动态 [@problem_id:2728127]。这极大地简化了[观测器设计](@entry_id:263404)的过程。

### 系统的结构分解：[Kalman分解](@entry_id:144281)

可控和可观测规范型适用于完全可控或完全可观测的系统。然而，一般的线性系统可能只部分可控或部分可观测。**[Kalman分解](@entry_id:144281)**提供了一个深刻的视角，它通过一次相似变换，将任何[LTI系统](@entry_id:271946)的[状态空间](@entry_id:177074) $\mathbb{F}^n$ 分解为四个相互正交的[子空间](@entry_id:150286)，从而揭示其完整的内部结构 [@problem_id:2728072]。

这四个[子空间](@entry_id:150286)是：
1.  **可控且可观测的[子空间](@entry_id:150286) ($\mathcal{X}_{co}$)**：这部分动态既能被输入影响，也能从输出中观测到，构成了系统的“核心”。
2.  **可控但不可观测的[子空间](@entry_id:150286) ($\mathcal{X}_{c\bar{o}}$)**：这部分动态可以被输入控制，但其状态演化对输出没有影响。
3.  **不可控但可观测的[子空间](@entry_id:150286) ($\mathcal{X}_{\bar{c}o}$)**：这部分动态不受输入影响，但其内部状态可以从输出中推断出来。
4.  **不可控且不可观测的[子空间](@entry_id:150286) ($\mathcal{X}_{\bar{c}\bar{o}}$)**：这部分动态完全与输入输出[解耦](@entry_id:637294)，是系统的“孤岛”。

这些[子空间](@entry_id:150286)由可达[子空间](@entry_id:150286) $\mathcal{R} = \mathrm{Im}(\mathcal{C})$ 和[不可观测子空间](@entry_id:176289) $\mathcal{N} = \ker(\mathcal{O})$ 的[交与并](@entry_id:271980)组合而成。选取一组与这个子[空间分解](@entry_id:755142)相适应的基，[系统矩阵](@entry_id:172230) $(A, B, C)$ 可变换为如下的块三角结构：
$$
A' = \begin{bmatrix}
A_{co}   A_{12}  A_{13}  A_{14} \\
0   A_{c\bar{o}}   0  A_{24} \\
0   0   A_{\bar{c}o}   A_{34} \\
0   0   0  A_{\bar{c}\bar{o}}
\end{bmatrix}, \quad
B' = \begin{bmatrix}
B_{co} \\ B_{c\bar{o}} \\ 0 \\ 0
\end{bmatrix}, \quad
C' = \begin{bmatrix}
C_{co}  0  C_{\bar{c}o}  0
\end{bmatrix}
$$
这个形式清晰地表明：输入 $u$ 只能影响可控部分（前两个块），而输出 $y$ 只能由可观测部分（第一和第三个块）产生。系统的[传递函数](@entry_id:273897)仅由可控且可观测的子系统 $(A_{co}, B_{co}, C_{co})$ 决定。[Kalman分解](@entry_id:144281)因此是理解系统[传递函数](@entry_id:273897)与状态空间模型之间关系的基石。

### 基于反馈等价的规范型：Brunovsky型

当我们允许使用[状态反馈](@entry_id:151441)时，可以达到的规范型结构更为简洁。对于任何可控的[LTI系统](@entry_id:271946) $(\dot{x}=Ax+Bu)$，通过[状态反馈](@entry_id:151441)等价变换，可以将其转化为**Brunovsky规范型**。该形式将[系统分解](@entry_id:274870)为一组并联的、纯粹的积分器链。

对于一个具有 $m$ 个输入和[可控性](@entry_id:148402)指数 $\{\nu_1, \nu_2, \dots, \nu_m\}$ 的多输入多输出（MIMO）系统（其中 $\sum \nu_i = n$），Brunovsky规范型 $(A_b, B_b)$ 具有[块对角结构](@entry_id:746869)，每个块对应一个输入通道和一条[积分器](@entry_id:261578)链。例如，对于一个双输入系统，[可控性](@entry_id:148402)指数为 $\nu_1=3$ 和 $\nu_2=2$，其Brunovsky型为 [@problem_id:2728113]：
$$
A_b = \begin{bmatrix}
0   1  0  0  0 \\
0   0  1  0  0 \\
0   0  0  0  0 \\
0   0  0  0  1 \\
0   0  0  0  0
\end{bmatrix}, \quad
B_b = \begin{bmatrix}
0  0 \\
0  0 \\
1  0 \\
0  0 \\
0  1
\end{bmatrix}
$$
在初始变换到Brunovsky型时，$A_b$ 的非零行（本例中为第3和第5行）可能包含耦合项。然而，通过施加[状态反馈](@entry_id:151441) $u = Kz + v$，我们可以精确地消除这些耦合项，并任意配置每条链的特征多项式。这是因为反馈项 $B_b K$ 只会修改 $A_b$ 中与输入直接关联的行（第 $\nu_1, \nu_1+\nu_2, \dots$ 行），而这些行恰好是决定系统特征多项式的行。这使得我们可以实现**输入解耦**和**任意[极点配置](@entry_id:155523)** [@problem_id:2728113]。新的输入 $v$ 可以独立地控制每一条积分器链。

对于SISO系统，只有一个[可控性](@entry_id:148402)指数，其长度必然为 $n$。此时的Brunovsky型就是一个长度为 $n$ 的[积分器](@entry_id:261578)链。SISO的可控规范型（CCF）可以看作是Brunovsky型的一个特例：它是在Brunovsky型的基础上施加了一个特定的[状态反馈](@entry_id:151441)，该反馈将系统的极点从原点（纯积分器）移动到了由特征多项式 $\{a_i\}$ 定义的位置 [@problem_id:2697128]。

### 规范型的现实考量与局限性

虽然规范型在理论上极为强大，但在实际应用中必须考虑其局限性，特别是[数值鲁棒性](@entry_id:188030)和系统内在的物理约束。

#### 对角规范型与[数值鲁棒性](@entry_id:188030)

对于状态矩阵 $A$ 可[对角化](@entry_id:147016)的情况，我们可以通过相似变换 $x=Vz$ 将其变换为**对角规范型**（或称**[模态规范型](@entry_id:266273)**），其中 $A' = \Lambda = V^{-1}AV = \mathrm{diag}(\lambda_1, \dots, \lambda_n)$。在这个[坐标系](@entry_id:156346)下，系统动态完全解耦为 $n$ 个一阶标量方程 $\dot{z}_i = \lambda_i z_i$，每个方程对应一个系统模式。

这种形式在概念上最为清晰，但其在实际应用中的有效性严重依赖于[特征向量](@entry_id:151813)矩阵 $V$ 的**条件数** $\kappa(V) = \|V\|\|V^{-1}\|$。当系统矩阵 $A$ 是非正规的（$A A^* \neq A^* A$）且存在**聚集的[特征值](@entry_id:154894)**（即 $\lambda_i \approx \lambda_j$ for $i \neq j$）时，[特征向量](@entry_id:151813)矩阵 $V$ 会变得病态（ill-conditioned），即 $\kappa(V) \gg 1$。

在存在[模型不确定性](@entry_id:265539)或扰动 $\Delta A$ 的情况下，变换到模态[坐标系](@entry_id:156346)后的等效扰动 $E = V^{-1}\Delta A V$ 的范数被放大了 $\kappa(V)$ 倍，即 $\|E\| \le \kappa(V)\|\Delta A\|$。这意味着，即使原始扰动 $\Delta A$ 很小，在病态的模态[坐标系](@entry_id:156346)下，模式间的耦合效应也可能非常巨大，使得名义上解耦的[对角形式](@entry_id:264850)完全失去意义。此外，[特征向量](@entry_id:151813)本身对扰动也变得极其敏感，其一阶扰动量级与[特征值](@entry_id:154894)间距 $\lambda_i - \lambda_j$ 的倒数成正比 [@problem_id:2700337]。因此，对于具有聚集[特征值](@entry_id:154894)的[非正规系统](@entry_id:270295)，对角规范型是一种数值上不鲁棒的表示。

#### 不变零点与内部动力学

规范型变换虽然可以改变系统的极点（通过反馈），但某些系统特性是不可改变的，其中最重要的就是**不变零点**（invariant zeros）。这些零点是系统[传递函数矩阵](@entry_id:271746)在特定复频率 $s$ 下[秩亏](@entry_id:754065)的点，它们在[状态反馈](@entry_id:151441)等价变换下保持不变 [@problem_id:2728133]。

位于复平面[右半平面](@entry_id:277010)的零点被称为**[非最小相位零点](@entry_id:164181)**。它们对控制系统构成了基本的性能限制。在规范型（如Byrnes-Isidori规范型）的框架下，不变零点表现为系统**内部动力学**（或称[零动态](@entry_id:177017)）的[特征值](@entry_id:154894)。内部动力学描述了当控制输入被选择以精确维持输出为零（$y(t) \equiv 0$）时，系统状态的内部演化。

如果系统存在一个[非最小相位零点](@entry_id:164181)（例如在 $s=+1$），则其内部动力学包含一个不稳定模式（如 $e^t$）。这意味着，任何试图强制输出为零（或跟踪一个恒定参考值）的控制策略，都会激发这个不稳定的内部模式，导致部分[状态变量](@entry_id:138790)无界增长，最终破坏系统的内部稳定性 [@problem_id:2728133]。因此，[非最小相位零点](@entry_id:164181)的存在，从根本上限制了系统实现高精度跟踪的能力。

### 规范型理论的扩展

规范型的思想不仅限于[LTI系统](@entry_id:271946)，它已被成功地推广到更广泛的系统类别中。

#### 非线性系统：Byrnes-Isidori规范型

对于输入仿射的[非线性系统](@entry_id:168347) $\dot{x} = f(x) + g(x)u, y=h(x)$，可以定义**[相对阶](@entry_id:171358)**（relative degree）$r$ 的概念。它表示需要对输出 $y$ 求导多少次，输入 $u$ 才会显式地出现。如果[相对阶](@entry_id:171358) $r$ 在一个区域内是常数，且满足某些[正则性条件](@entry_id:166962)，那么就可以找到一个[局部坐标](@entry_id:181200)变换，将系统转化为**Byrnes-Isidori规范型** [@problem_id:2728081]。

这种规范型将[系统分解](@entry_id:274870)为一个 $r$ 维的线性部分和一个 $(n-r)$ 维的（通常为[非线性](@entry_id:637147)的）内部动力学部分。线性部分的形式类似于一条积分器链，其动态可以通过[反馈线性化](@entry_id:163432)技术轻松控制。而内部动力学的稳定性则由系统的不变零点决定，再次揭示了零点对系统性能的根本性影响。

#### 描述符系统：Weierstrass规范型

对于由[矩阵束](@entry_id:751760) $(\lambda E - A)$ 描述的**描述符系统**（或称[奇异系统](@entry_id:140614)） $E\dot{x} = Ax+Bu$，当矩阵 $E$ 是奇异时，标准的状态空间理论不再适用。若[行列式](@entry_id:142978) $\det(\lambda E - A)$ 不恒为零，则称该系统是**正则的**（regular）。对于正则描述符系统，**Weierstrass规范型**（WCF）提供了一种标准分解。

通过等价变换 $P(\lambda E - A)Q$，[矩阵束](@entry_id:751760)可以被分解为两个对角块：$\mathrm{diag}(\lambda I_r - J, \lambda N - I_s)$ [@problem_id:2728069]。
- 第一块 $(\lambda I_r - J)$ 描述了系统的**慢子系统**，其动态由有限[特征值](@entry_id:154894)决定，行为类似于常规状态空间系统。
- 第二块 $(\lambda N - I_s)$，其中 $N$ 是一个[幂零矩阵](@entry_id:152732)，描述了系统的**快子系统**。它与无限[特征值](@entry_id:154894)相关，代表了纯代数约束和可能存在的脉冲行为。

Weierstrass规范型因此提供了一个分离和研究描述符系统中[微分](@entry_id:158718)动态和代数约束的有力工具。

总之，规范型是控制理论中一个强大而统一的框架。它不仅为控制器和[观测器设计](@entry_id:263404)提供了系统化的方法，而且通过揭示系统的[结构不变量](@entry_id:145830)和内在局限性，加深了我们对动态系统本质的理解。