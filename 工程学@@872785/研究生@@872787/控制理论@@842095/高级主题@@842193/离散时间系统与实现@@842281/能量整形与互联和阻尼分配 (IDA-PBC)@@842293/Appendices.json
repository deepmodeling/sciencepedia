{"hands_on_practices": [{"introduction": "本练习聚焦于哈密顿耗散系统框架的一个基石：回转力（gyroscopic forces）的本质。通过构建一个斜对称的互联矩阵 $J_d(x)$，你将严格证明它所产生的力是无功的，即它们只改变运动方向而不对系统做功。这项实践 [@problem_id:2704637] 对于理解IDA-PBC如何在受控地保持或耗散能量的同时重塑系统动力学至关重要。", "problem": "考虑一个光滑系统，其状态空间维度为 $3$，其互联与阻尼配置-基于无源性的控制 (Interconnection and Damping Assignment–Passivity-Based Control, IDA-PBC) 目标闭环动力学由期望的哈密顿量 $H_{d} : \\mathbb{R}^{3} \\to \\mathbb{R}$ 给出：\n$$\nH_{d}(x) \\triangleq \\frac{1}{2}\\,x^{\\top} x,\n$$\n其中 $x \\in \\mathbb{R}^{3}$。假设目标闭环动力学具有端口-哈密顿形式，其互联矩阵为 $J_{d}(x)$，阻尼矩阵为 $R_{d}(x)$，\n$$\n\\dot{x} = \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\n其中 $J_{d}(x)$ 是一个 $3 \\times 3$ 矩阵场，$R_{d}(x)$ 是一个对称半正定矩阵场，而 $\\nabla H_{d}(x)$ 是 $H_{d}$ 的梯度。在此框架下，当 $J_{d}(x)$ 是斜对称矩阵时，向量场\n$$\nf_{g}(x) \\triangleq J_{d}(x)\\,\\nabla H_{d}(x)\n$$\n被解释为陀螺力场。\n\n您的任务是：\n- 构建一个光滑的、状态依赖的、非平凡（即不恒为零）的斜对称互联矩阵 $J_{d}(x)$，从而对一般的 $x$ 引入非零的陀螺力。为此，请使用叉积（帽映射）参数化：\n$$\nJ_{d}(x) \\triangleq \\widehat{\\omega(x)} \\quad \\text{其中} \\quad \\omega(x) \\triangleq \\begin{pmatrix} x_{1}^{2} + \\exp\\!\\big(-x_{3}^{2}\\big) \\\\ x_{1} x_{2} \\\\ \\cos(x_{2}) \\end{pmatrix},\n$$\n以及由下式定义的标准帽映射 $\\widehat{\\omega}$：\n$$\n\\widehat{\\omega} \\triangleq \\begin{pmatrix}\n0  -\\omega_{3}  \\omega_{2} \\\\\n\\omega_{3}  0  -\\omega_{1} \\\\\n-\\omega_{2}  \\omega_{1}  0\n\\end{pmatrix}.\n$$\n- 从第一性原理（梯度的定义、时间导数的链式法则以及斜对称矩阵的性质）出发，严格证明由该 $J_{d}(x)$ 产生的陀螺力不会改变期望哈密顿量 $H_{d}$ 沿闭环系统轨迹的时间导数，即它们既不产生能量耗散，也不注入能量。\n- 计算由陀螺力提供的净功率，\n$$\nP_{g}(x) \\triangleq \\nabla H_{d}(x)^{\\top}\\, J_{d}(x)\\, \\nabla H_{d}(x),\n$$\n并将其报告为单个简化的解析表达式。\n\n答案格式要求：以单个闭式解析表达式的形式提供 $P_{g}(x)$ 的最终值。无需单位。不要提供不等式或方程式。如果需要近似，题目会明确指出，但此处无需四舍五入。", "solution": "问题陈述已经过验证，被认为是非线性控制理论领域中一个提法恰当、有科学依据的问题。该问题是自洽的、一致的，并遵循标准的数学形式。因此，我们可以着手求解。\n\n该问题要求证明端口-哈密顿系统中陀螺力的能量守恒性质，并计算与这些力相关的功率。让我们从第一性原理开始。\n\n状态向量为 $x \\in \\mathbb{R}^{3}$。期望的哈密顿函数给定为\n$$\nH_{d}(x) = \\frac{1}{2} x^{\\top}x = \\frac{1}{2} (x_{1}^{2} + x_{2}^{2} + x_{3}^{2}).\n$$\n为了分析该能量函数的时间演化，我们必须首先计算其梯度。$H_{d}(x)$ 相对于状态向量 $x$ 的梯度为\n$$\n\\nabla H_{d}(x) = \\frac{\\partial H_{d}}{\\partial x} = \\begin{pmatrix} \\frac{\\partial H_{d}}{\\partial x_{1}} \\\\ \\frac{\\partial H_{d}}{\\partial x_{2}} \\\\ \\frac{\\partial H_{d}}{\\partial x_{3}} \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} = x.\n$$\n目标闭环动力学由下式给出\n$$\n\\dot{x} = \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\n其中 $J_{d}(x)$ 是互联矩阵，$R_{d}(x)$ 是阻尼矩阵。\n\n哈密顿量 $H_{d}(x(t))$ 沿系统轨迹的时间导数可使用链式法则求得：\n$$\n\\frac{d}{dt} H_{d}(x(t)) = \\left(\\nabla H_{d}(x)\\right)^{\\top} \\dot{x}.\n$$\n将系统动力学中的 $\\dot{x}$ 表达式代入，我们得到：\n$$\n\\frac{d}{dt} H_{d}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} \\big(J_{d}(x) - R_{d}(x)\\big)\\,\\nabla H_{d}(x).\n$$\n通过分配项，我们可以将来自互联矩阵和阻尼矩阵的贡献分离开来：\n$$\n\\frac{d}{dt} H_{d}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x) - \\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x).\n$$\n第一个任务是证明与项 $J_{d}(x) \\nabla H_{d}(x)$ 相关的陀螺力不改变能量 $H_{d}$。这等价于证明它们对 $H_{d}$ 时间导数的贡献为零。由陀螺力提供的功率是项 $P_{g}(x) \\triangleq \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x)$。我们必须证明 $P_{g}(x) = 0$。\n\n矩阵 $J_{d}(x)$ 是通过帽映射构建的，$J_{d}(x) = \\widehat{\\omega(x)}$，其中\n$$\n\\widehat{\\omega} = \\begin{pmatrix} 0  -\\omega_{3}  \\omega_{2} \\\\ \\omega_{3}  0  -\\omega_{1} \\\\ -\\omega_{2}  \\omega_{1}  0 \\end{pmatrix}.\n$$\n根据其定义，帽映射产生一个斜对称矩阵。让我们来验证这个性质。$J_{d}(x)$ 的转置是：\n$$\nJ_{d}(x)^{\\top} = \\begin{pmatrix} 0  \\omega_{3}  -\\omega_{2} \\\\ -\\omega_{3}  0  \\omega_{1} \\\\ \\omega_{2}  -\\omega_{1}  0 \\end{pmatrix} = - \\begin{pmatrix} 0  -\\omega_{3}  \\omega_{2} \\\\ \\omega_{3}  0  -\\omega_{1} \\\\ -\\omega_{2}  \\omega_{1}  0 \\end{pmatrix} = -J_{d}(x).\n$$\n由于 $J_{d}(x)^{\\top} = -J_{d}(x)$，矩阵 $J_{d}(x)$ 对于任何向量场 $\\omega(x)$（包括问题陈述中提供的特定光滑函数）确实是斜对称的。因此，$\\omega(x)$ 的显式形式与这部分证明无关。\n\n现在，让我们分析二次型 $P_{g}(x)$。令 $v(x) = \\nabla H_{d}(x) = x$。陀螺功率的表达式为 $P_{g}(x) = v(x)^{\\top} J_{d}(x) v(x)$。由于 $P_{g}(x)$ 是一个标量，它必须等于其自身的转置：\n$$\nP_{g}(x) = \\left(v(x)^{\\top} J_{d}(x) v(x)\\right)^{\\top}.\n$$\n使用矩阵乘积转置的性质 $(ABC)^{\\top} = C^{\\top}B^{\\top}A^{\\top}$，我们有：\n$$\n\\left(v(x)^{\\top} J_{d}(x) v(x)\\right)^{\\top} = v(x)^{\\top} J_{d}(x)^{\\top} \\left(v(x)^{\\top}\\right)^{\\top} = v(x)^{\\top} J_{d}(x)^{\\top} v(x).\n$$\n我们已经确定 $J_{d}(x)$ 是斜对称的，所以 $J_{d}(x)^{\\top} = -J_{d}(x)$。将此代入表达式中，得到：\n$$\nP_{g}(x) = v(x)^{\\top} \\left(-J_{d}(x)\\right) v(x) = - \\left(v(x)^{\\top} J_{d}(x) v(x)\\right) = -P_{g}(x).\n$$\n得到的方程是 $P_{g}(x) = -P_{g}(x)$，这意味着 $2 P_{g}(x) = 0$。满足此条件的唯一实数是 $0$。因此，\n$$\nP_{g}(x) = \\left(\\nabla H_{d}(x)\\right)^{\\top} J_{d}(x) \\nabla H_{d}(x) = 0.\n$$\n这个基于斜对称矩阵基本性质的严格证明表明，陀螺力不做功。因此，它们对系统能量 $H_{d}$ 的任何变化都没有贡献。哈密顿量的时间导数简化为：\n$$\n\\frac{d}{dt} H_{d}(x) = - \\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x).\n$$\n由于 $R_{d}(x)$ 给定为半正定，二次型 $\\left(\\nabla H_{d}(x)\\right)^{\\top} R_{d}(x) \\nabla H_{d}(x) \\ge 0$，这保证了 $\\frac{d}{dt} H_{d}(x) \\le 0$。该系统是无源的，非零的陀螺项不改变此性质。\n\n最后一个任务是计算由陀螺力提供的净功率，这正是我们刚才分析的量 $P_{g}(x)$。上述计算是通用的，不依赖于 $x$ 或 $\\omega(x)$ 的具体分量。结果是一个常数函数。\n\n功率为 $P_{g}(x) = x^{\\top} J_{d}(x) x$。因为对于任何 $x$，$J_{d}(x)$ 都是斜对称的，所以这个二次型恒为零。\n\n因此，所要求的解析表达式就是 $0$。", "answer": "$$\\boxed{0}$$", "id": "2704637"}, {"introduction": "在掌握了目标动力学的基本特性之后，本练习将展示IDA-PBC在塑造系统局部行为方面的实际威力。你将设计互联矩阵 ($J_d$) 和阻尼矩阵 ($R_d$)，首先在平衡点周围创造轨道运动，然后将其转变为一个渐近稳定点。这项实践 [@problem_id:2704607] 让你具体地洞察设计者如何通过赋予闭环系统特定的物理结构来操控特征值和暂态响应。", "problem": "考虑一个全驱动二维系统，已对其应用互联与阻尼分配-基于无源性的控制 (IDA-PBC) 以构建闭环端口哈密顿 (pH) 形式。其闭环动力学为\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x),\n$$\n其中 $x \\in \\mathbb{R}^{2}$，$J_{d}(x)$ 是一个斜对称互联矩阵，$R_{d}(x)$ 是一个半正定阻尼矩阵，$H_{d}(x)$ 是期望的哈密顿量。假设期望平衡点位于 $x^{\\star}=\\mathbf{0}$，且期望的哈密顿量是二次形式，其Hessian矩阵为\n$$\n\\nabla^{2} H_{d}(0) = K = \\mathrm{diag}(k_{1},k_{2}), \\quad k_{1}>0,\\;k_{2}>0.\n$$\n假设在 $x^{\\star}$ 的一个邻域内，$J_{d}(x)$ 被选为常数，并且初始设置 $R_{d}(x) \\equiv 0$。您的任务是塑造互联结构，使得在 $x^{\\star}$ 处的线性化系统是一个中心点，并具有预设的小振幅振荡频率 $\\omega_{0}>0$。\n\n1. 仅使用哈密顿向量场和线性化的基本性质，构建一个显式的常数斜对称矩阵 $J_{d}$，使得当 $R_{d}\\equiv 0$ 时，在 $x^{\\star}$ 处的线性化系统是一个中心点，其特征值为纯虚数 $\\pm \\mathrm{j}\\,\\omega_{0}$。\n\n2. 然后，添加各向同性阻尼 $R_{d}(x)\\equiv r I_{2}$（其中 $r>0$），并通过计算线性化来确定带阻尼闭环系统的特征值。解释在关于 $r$ 的什么条件下，平衡点会从中心点转变为渐近稳定焦点。\n\n请将您在第1项中构建的 $J_{d}$ 的显式解析表达式作为最终答案。无需进行数值代入，也无需四舍五入。最终答案中不要包含单位。", "solution": "所提出的问题是控制理论中的一个标准练习，具体是在端口哈密顿系统的互联与阻尼分配-基于无源性的控制 (IDA-PBC) 框架内。该问题具有科学依据、提法恰当，并包含了所有必要信息。因此，我们开始进行求解。\n\n闭环动力学由以下方程给出：\n$$\n\\dot{x} = \\big(J_{d}(x)-R_{d}(x)\\big)\\,\\nabla H_{d}(x)\n$$\n期望的平衡点在 $x^{\\star}=\\mathbf{0}$。要使平衡点存在于此点，必须满足 $\\dot{x}|_{x=\\mathbf{0}} = \\mathbf{0}$。由于 $H_d(x)$ 在稳定平衡点 $x^{\\star}$ 处达到最小值，我们必须有 $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$。因此，$H_d(x)$ 在 $x^{\\star}=\\mathbf{0}$ 附近的泰勒展开为 $H_d(x) = H_d(\\mathbf{0}) + \\frac{1}{2}x^T \\nabla^2 H_d(\\mathbf{0}) x + \\mathcal{O}(\\|x\\|^3)$。设定势能基准 $H_d(\\mathbf{0})=0$ 并使用给定的Hessian矩阵 $\\nabla^2 H_d(\\mathbf{0}) = K$，对于小的 $x$，我们有 $H_d(x) = \\frac{1}{2}x^T K x$。梯度则为 $\\nabla H_d(x) = Kx + \\mathcal{O}(\\|x\\|^2)$。\n\n问题分为两个部分。\n\n第1部分：互联矩阵 $J_d$ 的构建。\n\n我们的任务是找到一个常数斜对称矩阵 $J_d$，使得无阻尼系统（$R_d(x) \\equiv 0$）在原点处的线性化是一个中心点，其振荡频率为 $\\omega_0$。无阻尼系统为：\n$$\n\\dot{x} = J_d(x) \\nabla H_d(x)\n$$\n为了分析平衡点 $x^{\\star} = \\mathbf{0}$ 周围的局部行为，我们对系统进行线性化。令 $f(x) = J_d(x) \\nabla H_d(x)$。线性化系统 $\\dot{\\delta x} = A \\delta x$ 的矩阵是 $f(x)$ 在 $x = \\mathbf{0}$ 处求值的雅可比矩阵：\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{x=\\mathbf{0}} = \\left. \\frac{\\partial}{\\partial x} \\big(J_d(x) \\nabla H_d(x)\\big) \\right|_{x=\\mathbf{0}}\n$$\n鉴于 $J_d(x)$ 被选为常数矩阵 $J_d$，并且 $\\nabla H_d(\\mathbf{0}) = \\mathbf{0}$，根据微分学的乘法法则可得：\n$$\nA = \\left( \\frac{\\partial J_d(x)}{\\partial x} \\nabla H_d(x) \\right)\\bigg|_{x=\\mathbf{0}} + J_d(\\mathbf{0}) \\left( \\frac{\\partial \\nabla H_d(x)}{\\partial x} \\right)\\bigg|_{x=\\mathbf{0}} = \\mathbf{0} + J_d \\nabla^2 H_d(\\mathbf{0})\n$$\n我们已知 $\\nabla^2 H_d(\\mathbf{0}) = K = \\mathrm{diag}(k_1, k_2)$。因此，线性化系统的状态矩阵是：\n$$\nA = J_d K\n$$\n对于一个二维系统，常数斜对称矩阵 $J_d$ 必须具有以下形式：\n$$\nJ_d = \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix}\n$$\n其中 $\\alpha$ 为某个实标量。矩阵 $K$ 给出为：\n$$\nK = \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix}\n$$\n其中 $k_1 > 0$ 且 $k_2 > 0$。乘积 $A = J_d K$ 是：\n$$\nA = \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix} \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix} = \\begin{pmatrix} 0  \\alpha k_2 \\\\ -\\alpha k_1  0 \\end{pmatrix}\n$$\n$A$ 的特征值 $\\lambda$ 可通过特征方程 $\\det(A - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{pmatrix} -\\lambda  \\alpha k_2 \\\\ -\\alpha k_1  -\\lambda \\end{pmatrix} = (-\\lambda)^2 - (\\alpha k_2)(-\\alpha k_1) = \\lambda^2 + \\alpha^2 k_1 k_2 = 0\n$$\n这得到 $\\lambda^2 = -\\alpha^2 k_1 k_2$，所以特征值为 $\\lambda = \\pm i |\\alpha| \\sqrt{k_1 k_2}$，其中 $i$ 是虚数单位。问题要求线性化系统是一个中心点，其特征值为 $\\pm i \\omega_0$，其中 $\\omega_0 > 0$。将两个特征值表达式相等，我们得到：\n$$\n|\\alpha| \\sqrt{k_1 k_2} = \\omega_0\n$$\n由于 $k_1, k_2, \\omega_0$ 均为正数，我们可以解出 $|\\alpha|$：\n$$\n|\\alpha| = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}\n$$\n对于 $\\alpha$ 我们有两个选择。不失一般性地，我们选择正根，即 $\\alpha = \\frac{\\omega_0}{\\sqrt{k_1 k_2}}$。期望的互联矩阵 $J_d$ 于是被唯一指定为：\n$$\nJ_d = \\begin{pmatrix} 0  \\frac{\\omega_0}{\\sqrt{k_1 k_2}} \\\\ -\\frac{\\omega_0}{\\sqrt{k_1 k_2}}  0 \\end{pmatrix}\n$$\n\n第2部分：带阻尼系统的分析。\n\n现在，添加各向同性阻尼 $R_d(x) \\equiv r I_2$，$r > 0$。动力学变为：\n$$\n\\dot{x} = (J_d - rI_2) \\nabla H_d(x)\n$$\n新的线性化系统矩阵 $A_d$ 为：\n$$\nA_d = (J_d - rI_2) K = \\left( \\begin{pmatrix} 0  \\alpha \\\\ -\\alpha  0 \\end{pmatrix} - \\begin{pmatrix} r  0 \\\\ 0  r \\end{pmatrix} \\right) \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix}\n$$\n$$\nA_d = \\begin{pmatrix} -r  \\alpha \\\\ -\\alpha  -r \\end{pmatrix} \\begin{pmatrix} k_1  0 \\\\ 0  k_2 \\end{pmatrix} = \\begin{pmatrix} -r k_1  \\alpha k_2 \\\\ -\\alpha k_1  -r k_2 \\end{pmatrix}\n$$\n$A_d$ 的特征值 $\\lambda$ 的特征方程为 $\\det(A_d - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -r k_1 - \\lambda  \\alpha k_2 \\\\ -\\alpha k_1  -r k_2 - \\lambda \\end{pmatrix} = (-r k_1 - \\lambda)(-r k_2 - \\lambda) + \\alpha^2 k_1 k_2 = 0\n$$\n$$\n\\lambda^2 + (r k_1 + r k_2)\\lambda + r^2 k_1 k_2 + \\alpha^2 k_1 k_2 = 0\n$$\n将第1部分的结果 $\\alpha^2 = \\frac{\\omega_0^2}{k_1 k_2}$ 代入：\n$$\n\\lambda^2 + r(k_1+k_2)\\lambda + (r^2 k_1 k_2 + \\omega_0^2) = 0\n$$\n特征值由二次求根公式给出：\n$$\n\\lambda_{1,2} = \\frac{-r(k_1+k_2) \\pm \\sqrt{ (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) }}{2}\n$$\n如果特征值是一对具有负实部的共轭复数，则平衡点是渐近稳定焦点。特征值的实部为 $\\mathrm{Re}(\\lambda) = -\\frac{r(k_1+k_2)}{2}$。由于 $r > 0$，$k_1 > 0$ 且 $k_2 > 0$，实部总是负的，这保证了渐近稳定性。\n如果二次方程的判别式为负，则特征值是复数。设 $\\Delta$ 为判别式：\n$$\n\\Delta = (r(k_1+k_2))^2 - 4(r^2 k_1 k_2 + \\omega_0^2) = r^2(k_1^2 + 2k_1 k_2 + k_2^2) - 4r^2 k_1 k_2 - 4\\omega_0^2\n$$\n$$\n\\Delta = r^2(k_1^2 - 2k_1 k_2 + k_2^2) - 4\\omega_0^2 = r^2(k_1-k_2)^2 - 4\\omega_0^2\n$$\n对于焦点，我们要求 $\\Delta  0$：\n$$\nr^2(k_1-k_2)^2 - 4\\omega_0^2  0 \\implies r^2(k_1-k_2)^2  4\\omega_0^2\n$$\n对两边开平方根得到：\n$$\nr |k_1 - k_2|  2\\omega_0\n$$\n这就是平衡点成为渐近稳定焦点时对 $r$ 的条件。如果 $k_1 \\neq k_2$，这等价于 $0  r  \\frac{2\\omega_0}{|k_1-k_2|}$。如果 $k_1=k_2$，条件变为 $0  2\\omega_0$，对于 $\\omega_0 > 0$ 这总是成立的，意味着对于任何 $r>0$ 系统都是一个焦点。\n问题要求提供 $J_d$ 的显式表达式作为最终答案。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}} \\\\ -\\frac{\\omega_{0}}{\\sqrt{k_{1} k_{2}}}  0 \\end{pmatrix}}\n$$", "id": "2704607"}, {"introduction": "一个成功的能量重塑设计，不仅仅是确保期望的平衡点是所设计势能函数的一个极小值点。本练习深入探讨了一个常见且关键的设计陷阱：意外产生的“伪”平衡点（spurious equilibria）。通过分析一个欠驱动系统的零动态，你将学习到在期望势能 $V_d(q)$ 中不当的参数选择会如何破坏全局稳定性，以及如何建立条件来避免这种情况 [@problem_id:2704604]。", "problem": "考虑一个保守的二自由度欠驱动机械系统，其广义坐标为 $q \\in \\mathbb{R}^{2}$，共轭动量为 $p \\in \\mathbb{R}^{2}$。其哈密顿量为\n$$\nH(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M^{-1}(q)\\,p \\;+\\; V(q),\n$$\n其中 $M(q) \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定惯性矩阵，$V(q)$ 是势能。该系统仅在第二个坐标处由一个控制输入 $u \\in \\mathbb{R}$ 驱动，该输入通过一个满秩输入矩阵 $G(q) \\in \\mathbb{R}^{2 \\times 1}$ 注入，该矩阵的第二行为非零，第一行为零。您的任务是设计一个互联与阻尼分配基于无源性的控制（IDA-PBC），以渐近稳定平衡点 $(q^{\\star},p^{\\star}) = (0,0)$。\n\n假设您采用标准的能量整形路径，并指定一个期望的哈密顿量，形式如下\n$$\nH_{d}(q,p) \\;=\\; \\tfrac{1}{2}\\,p^{\\top} M_{d}^{-1}(q)\\,p \\;+\\; V_{d}(q),\n$$\n其中 $M_{d}(q)$ 是对称正定的，整形后的势能选择为\n$$\nV_{d}(q) \\;=\\; k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,q_{2}^{2},\n$$\n其中 $k_{1}  0$，$k_{3}  0$，以及待选的 $k_{2} \\in \\mathbb{R}$。假设互联与阻尼分配以及相关的匹配条件均得到满足，使得与输出 $y := \\partial H_{d}/\\partial p_{2}$ 相关的零动态流形由下式给出\n$$\n\\mathcal{Z} \\;=\\; \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\},\n$$\n并且 $\\mathcal{Z}$ 在闭环动力学下是不变的。在 $\\mathcal{Z}$ 上，降维闭环动力学在 $q_{1}$ 中演化，其有效势能等于 $V_{d}(q)$ 在 $\\{q_{2}=0\\}$ 上的限制。\n\n仅从上述定义和基本微积分出发，完成以下任务：\n\n1.  通过计算 $q_{1}$ 中降维势能的驻点，推导出 $\\mathcal{Z}$ 上降维零动态的临界点（平衡点）集合，并明确展示当 $k_{2} \\neq 0$ 选择不当时，除了期望的 $q_{1}=0$ 构型外，如何出现额外的临界点（伪平衡点）。\n\n2.  根据您的推导，推断出一个关于 $k_{2}$ 的定量条件，该条件保证除了由 $\\sin q_{1} = 0$ 产生的平凡解外，降维势能不存在任何其他临界点。然后，提出一个关于 $k_{2}$ 的设计调整，以消除伪平衡点，同时保持 $k_{1}  0$。\n\n计算 $k_2$ 的最大允许幅值 $c_{\\star}$，表示为关于 $k_{1}$ 的闭式符号表达式，使得对于任何满足 $\\lvert k_{2} \\rvert  c_{\\star}$ 的 $k_2$，在零动态流形上都不存在伪平衡点。请以 $c_{\\star}$ 关于 $k_{1}$ 的闭式符号表达式形式给出您的最终答案。不需要数值取整。最终表达式中不需要物理单位。", "solution": "所述问题具有科学依据，提法恰当，客观且内部一致。它提出了非线性控制理论领域的一个标准任务，具体涉及互联与阻尼分配基于无源性的控制（IDA-PBC）方案中零动态的分析。所有必要的定义和假设均已提供，可以进行严格的数学分析。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是分析指定零动态流形 $\\mathcal{Z}$ 上降维闭环动力学的平衡点。该流形由 $\\mathcal{Z} = \\{(q,p)\\in \\mathbb{R}^{4} \\,:\\, q_{2}=0,\\; p_{2}=0\\}$ 给出。问题指出，在此流形上，坐标 $q_{1}$ 的动力学由一个有效势能函数 $V_{red}(q_{1})$ 控制，该函数是期望势能 $V_{d}(q)$ 在 $\\mathcal{Z}$ 上的限制。\n\n我们通过将 $q_{2}=0$ 代入 $V_{d}(q)$ 的表达式来找到 $V_{red}(q_{1})$：\n$$\nV_{red}(q_{1}) = V_{d}(q_{1}, 0) = k_{1}\\,\\big(1 - \\cos q_{1}\\big) \\;+\\; k_{2}\\,\\big(1 - \\cos(2 q_{1})\\big) \\;+\\; \\tfrac{1}{2}\\,k_{3}\\,(0)^{2}\n$$\n$$\nV_{red}(q_{1}) = k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1}))\n$$\n降维系统的临界点（平衡点）对应于此势能的驻点，这些驻点位于 $V_{red}(q_{1})$ 相对于 $q_{1}$ 的一阶导数为零的地方。我们计算这个导数：\n$$\n\\frac{d V_{red}}{d q_{1}} = \\frac{d}{d q_{1}} \\left[ k_{1}\\,(1 - \\cos q_{1}) + k_{2}\\,(1 - \\cos(2q_{1})) \\right] = k_{1} \\sin q_{1} + 2k_{2} \\sin(2q_{1})\n$$\n使用三角倍角公式 $\\sin(2q_{1}) = 2 \\sin q_{1} \\cos q_{1}$，我们简化导数：\n$$\n\\frac{d V_{red}}{d q_{1}} = k_{1} \\sin q_{1} + 4k_{2} \\sin q_{1} \\cos q_{1} = (\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1})\n$$\n将此导数设为零，$\\frac{d V_{red}}{d q_{1}} = 0$，得到平衡点方程：\n$$\n(\\sin q_{1})(k_{1} + 4k_{2} \\cos q_{1}) = 0\n$$\n如果其两个因子中至少有一个为零，则该方程成立：\n1.  $\\sin q_{1} = 0$：此条件对于任何整数 $n \\in \\mathbb{Z}$，在 $q_{1} = n\\pi$ 处产生一组预期的或平凡的平衡点。该集合包括期望的平衡构型 $q_{1} = 0$。\n2.  $k_{1} + 4k_{2} \\cos q_{1} = 0$：此条件可以重新整理以求解 $\\cos q_{1}$：\n    $$\n    \\cos q_{1} = -\\frac{k_{1}}{4k_{2}}\n    $$\n    这第二个方程是“伪”平衡点的来源。要使该方程存在关于 $q_{1}$ 的实数解，右侧的值必须在余弦函数的有效范围内，即在区间 $[-1, 1]$ 内。因此，当且仅当以下条件满足时，会出现伪平衡点：\n    $$\n    \\left| -\\frac{k_{1}}{4k_{2}} \\right| \\leq 1\n    $$\n    鉴于问题规定 $k_{1}  0$，我们可以简化此条件：\n    $$\n    \\frac{k_{1}}{4|k_{2}|} \\leq 1 \\quad \\implies \\quad k_{1} \\leq 4|k_{2}| \\quad \\implies \\quad |k_{2}| \\geq \\frac{k_{1}}{4}\n    $$\n    这表明，如果所选参数 $k_{2}$ 的幅值不适当地大，特别是当 $|k_{2}| \\geq \\frac{k_{1}}{4}$ 时，将在零动态流形上产生额外的临界点。这完成了问题的第一部分。\n\n对于问题的第二部分，我们必须推导出一个关于 $k_{2}$ 的条件，以确保不存在这些伪平衡点。这可以通过要求方程 $\\cos q_{1} = -k_{1}/(4k_{2})$ 没有实数解来实现。如果右侧的绝对值严格大于 $1$，则可以保证这一点：\n$$\n\\left| -\\frac{k_{1}}{4k_{2}} \\right|  1\n$$\n遵循与之前相同的逻辑，此不等式变为：\n$$\n\\frac{k_{1}}{4|k_{2}|}  1 \\quad \\implies \\quad k_{1}  4|k_{2}| \\quad \\implies \\quad |k_{2}|  \\frac{k_{1}}{4}\n$$\n因此，建议的设计调整是选择参数 $k_{2}$，使其幅值相对于 $k_{1}$ 遵守这一严格不等式。通过这样做，因子 $(k_{1} + 4k_{2} \\cos q_{1})$ 永远不能为零，降维系统的唯一平衡点是由 $\\sin q_{1} = 0$ 决定的那些平衡点。\n\n最后，我们被要求找到 $k_{2}$ 的最大允许幅值 $c_{\\star}$，使得对于任何满足 $|k_{2}|  c_{\\star}$ 的 $k_{2}$，都不存在伪平衡点。我们推导出的不存在此类平衡点的条件恰好是这种形式：$|k_{2}|  k_{1}/4$。通过直接比较，我们确定 $c_{\\star}$ 的值：\n$$\nc_{\\star} = \\frac{k_{1}}{4}\n$$\n该值代表参数 $k_{2}$ 的临界阈值。对于所有 $|k_{2}|  c_{\\star}$，期望势能 $V_{d}(q)$ 在零动态流形上于 $q_1=n\\pi$ 处具有单一族的临界点，从而防止了可能危及期望工作点稳定性的分岔。", "answer": "$$\\boxed{\\frac{k_{1}}{4}}$$", "id": "2704604"}]}