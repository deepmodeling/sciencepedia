{"hands_on_practices": [{"introduction": "数字控制的第一步是将连续时间对象精确地转换为离散时间模型。本练习将引导你从第一性原理出发，为一个一阶系统推导其零阶保持器 (ZOH) 等效模型 [@problem_id:2743064]。通过这个过程，你将加深对描述系统动态的微分方程与差分方程之间内在联系的理解。", "problem": "考虑一个连续时间标量一阶系统，其传递函数为 $P(s)=\\frac{1}{s+a}$，其中 $a0$。该系统由一个采样数据互联驱动，该互联由一个采样周期为 $T0$ 的理想采样器和一个零阶保持器 (ZOH) 组成，零阶保持器在每个采样区间内将每个输入采样值保持为常数。令 $u[k]$ 表示施加于 ZOH 的离散时间输入，因此连续时间输入 $u(t)$ 是分段常数，满足在 $t\\in[kT,(k+1)T)$ 区间内 $u(t)=u[k]$。令 $y[k]$ 表示采样输出 $y(kT)$。\n\n从线性时不变 (LTI) 系统的第一性原理出发——即状态空间表示、通过矩阵指数求解线性微分方程以及零阶保持器 (ZOH) 的定义——推导在采样周期为 $T$ 的采样器-系统-ZOH互联下，与连续时间系统保持器等效的精确离散时间输入输出关系，其形式为 $y[k+1]=\\alpha\\,y[k]+\\beta\\,u[k]$。\n\n您的任务是计算系数 $\\alpha$ 和 $\\beta$ 的闭式解，使其表示为 $a$ 和 $T$ 的函数。请以单行向量 $\\begin{pmatrix}\\alpha  \\beta\\end{pmatrix}$ 的形式提供您的最终答案（无单位）。", "solution": "问题陈述经过严格评估并确认为有效。它在科学上基于线性系统和控制理论的原理，问题设定良好，具有唯一且可推导的解，并且陈述客观，没有歧义。此任务是数字控制系统中的一个标准问题，要求在零阶保持器作用下，推导一个连续时间系统的离散时间等效模型。我们将按照要求从第一性原理开始推导。\n\n该连续时间系统由传递函数 $P(s) = \\frac{Y(s)}{U(s)} = \\frac{1}{s+a}$ 描述。这对应于线性常微分方程：\n$$\n\\frac{d}{dt}y(t) + a y(t) = u(t)\n$$\n我们将此系统表述为状态空间形式。对于这个一阶系统，我们可以选择状态变量 $x(t)$ 为输出本身，即 $x(t) = y(t)$。其状态空间表示为：\n$$\n\\dot{x}(t) = A x(t) + B u(t)\n$$\n$$\ny(t) = C x(t) + D u(t)\n$$\n通过与微分方程 $\\dot{y}(t) = -a y(t) + u(t)$ 进行比较，并注意到 $x(t) = y(t)$，我们可以确定系统矩阵（在本例中为标量）：\n$A = -a$, $B = 1$, $C = 1$, $D = 0$。\n\n对于线性时不变 (LTI) 系统，在时间区间 $[t_0, t]$ 内的状态方程的解由常数变易公式给出：\n$$\nx(t) = \\exp(A(t-t_0)) x(t_0) + \\int_{t_0}^{t} \\exp(A(t-\\tau)) B u(\\tau) d\\tau\n$$\n我们关心的是状态从一个采样时刻 $t_0 = kT$ 到下一个采样时刻 $t = (k+1)T$ 的演变。将这些代入解中得到：\n$$\nx((k+1)T) = \\exp(A((k+1)T - kT)) x(kT) + \\int_{kT}^{(k+1)T} \\exp(A((k+1)T - \\tau)) B u(\\tau) d\\tau\n$$\n我们定义离散时间状态为 $x[k] \\equiv x(kT)$。该方程变为：\n$$\nx[k+1] = \\exp(AT) x[k] + \\int_{kT}^{(k+1)T} \\exp(A((k+1)T - \\tau)) B u(\\tau) d\\tau\n$$\n问题指明了使用零阶保持器 (ZOH)，这意味着连续时间输入 $u(t)$ 在每个采样区间内是分段常数。具体来说，对于区间 $[kT, (k+1)T)$ 内的任何 $\\tau$，输入都保持为离散时间采样值 $u[k]$，即 $u(\\tau) = u[k]$。由于 $u[k]$ 是一个常数，我们可以将其从积分中提出：\n$$\nx[k+1] = \\exp(AT) x[k] + \\left( \\int_{kT}^{(k+1)T} \\exp(A((k+1)T - \\tau)) B d\\tau \\right) u[k]\n$$\n为了计算该积分，我们进行变量替换。令 $\\lambda = (k+1)T - \\tau$。这意味着 $d\\lambda = -d\\tau$。积分上下限相应改变：当 $\\tau = kT$ 时，$\\lambda = T$；当 $\\tau = (k+1)T$ 时，$\\lambda = 0$。积分变为：\n$$\n\\int_{T}^{0} \\exp(A\\lambda) B (-d\\lambda) = \\int_{0}^{T} \\exp(A\\lambda) B d\\lambda\n$$\n这样就得到了精确的离散时间状态空间模型：\n$$\nx[k+1] = F_d x[k] + G_d u[k]\n$$\n其中离散时间系统矩阵 $F_d$ 和输入矩阵 $G_d$ 定义为：\n$F_d = \\exp(AT)$\n$G_d = \\left( \\int_{0}^{T} \\exp(A\\lambda) d\\lambda \\right) B$\n\n现在，我们将我们特定系统的标量值 $A = -a$ 和 $B = 1$ 代入。\n矩阵 $F_d$ 为：\n$F_d = \\exp(-aT)$\n矩阵 $G_d$ 通过计算积分得到：\n$G_d = \\left( \\int_{0}^{T} \\exp(-a\\lambda) d\\lambda \\right) \\cdot 1 = \\left[ -\\frac{1}{a} \\exp(-a\\lambda) \\right]_0^T$\n计算积分在上下限的值得到：\n$G_d = -\\frac{1}{a} (\\exp(-aT) - \\exp(0)) = -\\frac{1}{a} (\\exp(-aT) - 1) = \\frac{1 - \\exp(-aT)}{a}$\n因此，离散时间状态方程为：\n$$\nx[k+1] = \\exp(-aT) x[k] + \\frac{1-\\exp(-aT)}{a} u[k]\n$$\n问题将采样输入 $u[k]$ 与采样输出 $y[k] \\equiv y(kT)$ 联系起来。根据我们的状态空间定义，$y(t) = C x(t) + D u(t)$。由于 $C=1$ 和 $D=0$，我们有 $y(t) = x(t)$。因此，采样输出等于离散时间状态：$y[k] = y(kT) = x(kT) = x[k]$。\n将离散状态方程中的 $x[k]$ 替换为 $y[k]$，我们得到最终的输入输出关系：\n$$\ny[k+1] = \\exp(-aT) y[k] + \\frac{1-\\exp(-aT)}{a} u[k]\n$$\n此方程符合所要求的形式 $y[k+1] = \\alpha y[k] + \\beta u[k]$。通过直接比较，我们确定系数 $\\alpha$ 和 $\\beta$：\n$$\n\\alpha = \\exp(-aT)\n$$\n$$\n\\beta = \\frac{1-\\exp(-aT)}{a}\n$$\n这些系数是系统参数 $a$ 和采样周期 $T$ 的函数，符合要求。", "answer": "$$\\boxed{\\begin{pmatrix} \\exp(-aT)  \\frac{1-\\exp(-aT)}{a} \\end{pmatrix}}$$", "id": "2743064"}, {"introduction": "离散时间等效模型只保证系统在采样时刻的行为与原系统一致，但这并不意味着在采样点之间的行为也同样理想。本练习旨在探讨采样点间行为这一关键概念，揭示即使系统在采样点上表现完美，也可能在采样点之间出现不希望的超调 [@problem_id:2743043]。这个思想实验强调了零阶保持器的一个核心局限性，并为设计更先进的控制器提供了动机。", "problem": "考虑一个连续时间系统，其传递函数为 $G(s) = \\frac{1}{s^{2}}$，因此输出 $y(t)$ 满足双重积分器动态特性 $y''(t) = u(t)$，其中 $u(t)$ 是施加的控制。该系统由一个采样周期为 $h  0$ 的离散时间控制器和一个位于输入端的零阶保持器 (ZOH) 控制。参考信号是在 $t=0$ 时施加的单位阶跃信号。您将比较两种在离散时间意义上保持等效（即采样响应相同）但在采样点间行为上不同的实现方式：\n\n- 基准零阶保持器 (ZOH)：ZOH 在 $[0,h)$ 上施加分段恒定输入 $u_{0}$，在 $[h,2h)$ 上施加 $u_{1}$，此后为 $0$。离散时间控制器选择 $u_{0}$ 和 $u_{1}$ 以确保采样响应满足 $y(h) = 1$ 和 $y(2h) = 1$。\n\n- 分数延迟补偿 ZOH：在数字控制器中使用一个严格真分的分数延迟补偿器来模拟连续时间中的相位超前。根据保持等效性，其在系统输入端的净效应可以建模为施加相同的分段恒定值 $u_{0}$、$u_{1}$、$0$，但每个分段都提前了一个分数 $\\delta \\in (0,h)$：$u(t)=u_{0}$ 在 $[-\\delta,\\,h-\\delta)$ 上，$u(t)=u_{1}$ 在 $[h-\\delta,\\,2h-\\delta)$ 上，以及 $u(t)=0$ 在 $[2h-\\delta,\\,\\infty)$ 上。假设控制器对参考信号有预见，并有一个内部模型，因此该实现在采样数据意义上是因果的，并且仍然能达到相同的采样约束 $y(h)=1$ 和 $y(2h)=1$。\n\n对于每种情况，将 $[0,2h]$ 上的采样点间超调量定义为\n$$\nM \\;=\\; \\max_{t \\in [0,\\,2h]} \\bigl(y(t) - 1\\bigr).\n$$\n从 $y(0)=0$ 和 $y'(0)=0$ 开始，通过在每个子区间上积分 $y''(t)=u(t)$ 并使用适当的边界条件，从第一性原理推导出 $y(t)$，施加采样约束 $y(h)=1$ 和 $y(2h)=1$ 来确定每种情况下的 $u_{0}$ 和 $u_{1}$，并计算 $M$。\n\n然后，在 $h = 1\\,\\text{s}$ 和分数超前量 $\\delta = \\frac{h}{2}$ 的情况下，量化改善因子\n$$\n\\rho \\;=\\; \\frac{M_{\\text{baseline}}}{M_{\\text{fractional}}}.\n$$\n将您的 $\\rho$ 最终答案表示为一个精确数（不要四舍五入）。最终答案中不要包含单位。", "solution": "该问题要求对控制双重积分器系统的两种不同零阶保持器 (ZOH) 实现的采样点间超调量进行比较分析。系统动态特性由 $y''(t) = u(t)$ 给出，初始条件为 $y(0)=0$ 和 $y'(0)=0$。控制器必须确保输出在采样时刻 $t=h$ 和 $t=2h$ 与单位阶跃参考信号相匹配，即 $y(h)=1$ 和 $y(2h)=1$。\n\n我们将分别分析每种情况，以求出控制输入 $u_0$ 和 $u_1$、产生的输出轨迹 $y(t)$ 以及采样点间超调量 $M$。\n\n**情况1：基准ZOH**\n\n在基准情况下，控制输入 $u(t)$ 在区间 $[kh, (k+1)h)$ 上是分段恒定的。具体来说，$u(t) = u_0$ 对于 $t \\in [0, h)$，$u(t) = u_1$ 对于 $t \\in [h, 2h)$。对于 $t \\geq 2h$，$u(t)=0$。\n\n首先，我们从 $y(0)=0$ 和 $y'(0)=0$ 开始，通过积分 $y''(t)=u(t)$ 来求得输出 $y(t)$。\n对于 $t \\in [0, h)$：\n$y''(t) = u_0$\n$y'(t) = \\int_0^t u_0 \\,d\\tau = u_0 t$\n$y(t) = \\int_0^t u_0 \\tau \\,d\\tau = \\frac{1}{2} u_0 t^2$\n\n在 $t=h$ 时，我们有状态：\n$y(h) = \\frac{1}{2} u_0 h^2$\n$y'(h) = u_0 h$\n\n对于 $t \\in [h, 2h)$：\n$y''(t) = u_1$\n$y'(t) = y'(h) + \\int_h^t u_1 \\,d\\tau = u_0 h + u_1(t-h)$\n$y(t) = y(h) + \\int_h^t y'(\\tau) \\,d\\tau = \\frac{1}{2} u_0 h^2 + \\int_h^t [u_0 h + u_1(\\tau-h)] \\,d\\tau$\n$y(t) = \\frac{1}{2} u_0 h^2 + u_0 h (t-h) + \\frac{1}{2} u_1 (t-h)^2$\n\n现在我们应用采样约束 $y(h)=1$ 和 $y(2h)=1$ 来求出 $u_0$ 和 $u_1$。\n由 $y(h)=1$ 可得：\n$\\frac{1}{2} u_0 h^2 = 1 \\implies u_0 = \\frac{2}{h^2}$\n\n由 $y(2h)=1$ 可得：\n$y(2h) = \\frac{1}{2} u_0 h^2 + u_0 h (2h-h) + \\frac{1}{2} u_1 (2h-h)^2 = 1$\n$1 + u_0 h^2 + \\frac{1}{2} u_1 h^2 = 1$\n使用 $u_0 h^2 = 2$：\n$1 + 2 + \\frac{1}{2} u_1 h^2 = 1 \\implies 3 + \\frac{1}{2} u_1 h^2 = 1 \\implies \\frac{1}{2} u_1 h^2 = -2 \\implies u_1 = -\\frac{4}{h^2}$\n\n控制输入为 $u_0 = \\frac{2}{h^2}$ 和 $u_1 = -\\frac{4}{h^2}$。\n现在我们求采样点间超调量 $M_{\\text{baseline}} = \\max_{t \\in [0,2h]} (y(t)-1)$。\n在 $[0, h)$ 上，$y(t) = \\frac{1}{2} (\\frac{2}{h^2}) t^2 = \\frac{t^2}{h^2}$。该函数从 $y(0)=0$ 增加到 $y(h)=1$。超调量为非正。\n在 $[h, 2h]$ 上，$y(t) = 1 + u_0 h(t-h) + \\frac{1}{2}u_1(t-h)^2 = 1 + \\frac{2}{h}(t-h) - \\frac{2}{h^2}(t-h)^2$。\n为了求最大值，我们将导数设为零：\n$y'(t) = u_0 h + u_1(t-h) = \\frac{2}{h} - \\frac{4}{h^2}(t-h) = 0$\n$\\frac{2}{h} = \\frac{4}{h^2}(t-h) \\implies t-h = \\frac{2h^2}{4h} = \\frac{h}{2}$。最大值出现在 $t = h + \\frac{h}{2} = \\frac{3h}{2}$。\n最大值为：\n$y(\\frac{3h}{2}) = 1 + \\frac{2}{h}(\\frac{h}{2}) - \\frac{2}{h^2}(\\frac{h}{2})^2 = 1 + 1 - \\frac{2}{h^2}\\frac{h^2}{4} = 2 - \\frac{1}{2} = \\frac{3}{2}$。\n最大超调量为 $M_{\\text{baseline}} = y(\\frac{3h}{2}) - 1 = \\frac{3}{2} - 1 = \\frac{1}{2}$。\n\n**情况2：分数延迟补偿ZOH**\n\n控制输入为 $u(t) = u_0$ 对于 $t \\in [-\\delta, h-\\delta)$，$u(t) = u_1$ 对于 $t \\in [h-\\delta, 2h-\\delta)$，此后 $u(t)=0$。我们分析 $t \\geq 0$ 时的系统。\n在给定 $y(0)=0, y'(0)=0$ 的情况下，$y(t)$ 的通解为 $y(t) = \\int_0^t (t-\\tau)u(\\tau)d\\tau$。\n\n对于 $y(h) = 1$：\n$1 = \\int_0^h (h-\\tau) u(\\tau)d\\tau = \\int_0^{h-\\delta} (h-\\tau)u_0 d\\tau + \\int_{h-\\delta}^h (h-\\tau)u_1 d\\tau$\n$1 = u_0 \\left[-\\frac{(h-\\tau)^2}{2}\\right]_0^{h-\\delta} + u_1 \\left[-\\frac{(h-\\tau)^2}{2}\\right]_{h-\\delta}^h$\n$1 = u_0 \\left(-\\frac{\\delta^2}{2} + \\frac{h^2}{2}\\right) + u_1 \\left(0 + \\frac{\\delta^2}{2}\\right) = \\frac{u_0(h^2-\\delta^2)}{2} + \\frac{u_1\\delta^2}{2}$\n$u_0(h^2-\\delta^2) + u_1\\delta^2 = 2$ (方程 1)\n\n对于 $y(2h) = 1$：\n$1 = \\int_0^{2h} (2h-\\tau) u(\\tau)d\\tau = \\int_0^{h-\\delta} (2h-\\tau)u_0 d\\tau + \\int_{h-\\delta}^{2h-\\delta} (2h-\\tau)u_1 d\\tau + \\int_{2h-\\delta}^{2h} (2h-\\tau) \\cdot 0 d\\tau$\n$1 = u_0 \\left[-\\frac{(2h-\\tau)^2}{2}\\right]_0^{h-\\delta} + u_1 \\left[-\\frac{(2h-\\tau)^2}{2}\\right]_{h-\\delta}^{2h-\\delta}$\n$1 = u_0 \\left(-\\frac{(h+\\delta)^2}{2} + \\frac{(2h)^2}{2}\\right) + u_1 \\left(-\\frac{\\delta^2}{2} + \\frac{(h+\\delta)^2}{2}\\right)$\n$1 = u_0 \\frac{4h^2 - (h^2+2h\\delta+\\delta^2)}{2} + u_1 \\frac{h^2+2h\\delta+\\delta^2-\\delta^2}{2}$\n$u_0(3h^2-2h\\delta-\\delta^2) + u_1(h^2+2h\\delta) = 2$ (方程 2)\n\n给定 $h = 1$ 和 $\\delta = \\frac{h}{2} = \\frac{1}{2}$。代入这些值：\n$h^2=1, \\delta^2=1/4$。\n方程 1 变为：$u_0(1-\\frac{1}{4}) + u_1(\\frac{1}{4}) = 2 \\implies \\frac{3}{4}u_0 + \\frac{1}{4}u_1 = 2 \\implies 3u_0 + u_1 = 8$。\n方程 2 变为：$u_0(3(1)-2(1)(\\frac{1}{2}) - \\frac{1}{4}) + u_1(1+2(1)(\\frac{1}{2})) = 2$\n$u_0(3-1-\\frac{1}{4}) + u_1(1+1) = 2 \\implies \\frac{7}{4}u_0 + 2u_1 = 2 \\implies 7u_0 + 8u_1 = 8$。\n\n求解该方程组：\n由 $3u_0 + u_1 = 8$，我们得到 $u_1 = 8 - 3u_0$。\n代入第二个方程：$7u_0 + 8(8 - 3u_0) = 8 \\implies 7u_0 + 64 - 24u_0 = 8 \\implies -17u_0 = -56 \\implies u_0 = \\frac{56}{17}$。\n那么 $u_1 = 8 - 3(\\frac{56}{17}) = \\frac{136 - 168}{17} = -\\frac{32}{17}$。\n\n现在我们求采样点间超调量 $M_{\\text{fractional}}$。我们必须求出 $y(t)$ 在 $[0, 2]$ 上的最大值。输入在 $t=h-\\delta=1/2$ 和 $t=2h-\\delta=3/2$ 时发生变化。\n在 $[0, 1/2)$ 上，$u(t) = u_0 = 56/17$。$y(t) = \\frac{1}{2}u_0 t^2 = \\frac{28}{17}t^2$。$y(t)$ 从 $y(0)=0$ 增加到 $y(1/2) = \\frac{28}{17}(\\frac{1}{4}) = \\frac{7}{17}  1$。\n在 $[1/2, 3/2)$ 上，$u(t) = u_1 = -32/17$。我们需要求出 $y(t)$ 在此区间上的表达式。\n在 $t=1/2$ 时，$y(1/2)=\\frac{7}{17}$ 且 $y'(1/2) = u_0(1/2) = \\frac{28}{17}$。\n对于 $t \\in [1/2, 3/2)$：\n$y'(t) = y'(1/2) + u_1(t-1/2) = \\frac{28}{17} - \\frac{32}{17}(t-1/2)$。\n为了求最大值，令 $y'(t)=0$：$\\frac{28}{17} = \\frac{32}{17}(t-1/2) \\implies t-1/2 = \\frac{28}{32} = \\frac{7}{8}$。\n最大值出现在 $t = 1/2 + 7/8 = 11/8 = 1.375$。该时刻在区间 $[1/2, 3/2)$ 内，也在问题定义的域 $[0, 2]$ 内。\n此时的 $y(t)$ 值通过对 $y'(t)$ 积分得到：\n$y(t) = y(1/2) + \\int_{1/2}^t y'(\\tau)d\\tau = \\frac{7}{17} + \\frac{28}{17}(t-1/2) - \\frac{16}{17}(t-1/2)^2$。\n在 $t=11/8$ 时，$t-1/2 = 7/8$：\n$y(\\frac{11}{8}) = \\frac{7}{17} + \\frac{28}{17}(\\frac{7}{8}) - \\frac{16}{17}(\\frac{7}{8})^2 = \\frac{7}{17} + \\frac{7 \\cdot 7}{17 \\cdot 2} - \\frac{16 \\cdot 49}{17 \\cdot 64} = \\frac{7}{17} + \\frac{49}{34} - \\frac{49}{68}$。\n$y(\\frac{11}{8}) = \\frac{28+98-49}{68} = \\frac{77}{68} = 1 + \\frac{9}{68}$。\n在 $[3/2, 2]$ 上，$u(t)=0$。\n$y'(3/2) = y'(1/2) + u_1(3/2-1/2) = \\frac{28}{17} - \\frac{32}{17}(1) = -\\frac{4}{17}$。\n由于在 $[3/2, 2]$ 上 $y'(t)0$，该函数是递减的。$y(t)$ 在 $[0, 2]$ 上的最大值为 $y(11/8) = 1 + \\frac{9}{68}$。\n超调量为 $M_{\\text{fractional}} = y(\\frac{11}{8}) - 1 = \\frac{9}{68}$。\n\n**改善因子**\n\n最后，我们计算改善因子 $\\rho$：\n$\\rho = \\frac{M_{\\text{baseline}}}{M_{\\text{fractional}}} = \\frac{1/2}{9/68} = \\frac{1}{2} \\cdot \\frac{68}{9} = \\frac{34}{9}$。", "answer": "$$\\boxed{\\frac{34}{9}}$$", "id": "2743043"}, {"introduction": "采样过程并非总是无损的；它可能深刻地改变系统的基本特性。本练习通过一个编程实践，探讨了“病态采样”这一现象，即一个完全可控的连续系统在离散化后可能会失去其可控性 [@problem_id:2743060]。通过分析离散系统的能达性并寻找更优的采样周期，你将获得关于如何选择合适的采样率以保持系统结构完整性的宝贵实践经验。", "problem": "考虑一个在输入端带有采样器和零阶保持器 (ZOH) 的连续时间线性时不变状态空间模型。该系统由状态方程 $\\dot{x}(t) = A x(t) + B u(t)$ 和输出方程 $y(t) = C x(t)$ 给出，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$C \\in \\mathbb{R}^{p \\times n}$。在周期为 $T  0$ 秒的采样器和输入端的零阶保持器作用下，其精确（保持等效）的离散时间模型为 $x_{k+1} = A_d x_k + B_d u_k$, $y_k = C x_k$，其中 $A_d = e^{A T}$ 且 $B_d = \\int_{0}^{T} e^{A \\tau} B \\, d\\tau$。\n\n定义离散时间能达矩阵为\n$$\n\\mathcal{R}_d(A_d,B_d) = \\left[ B_d \\; , \\; A_d B_d \\; , \\; \\dots \\; , \\; A_d^{n-1} B_d \\right] \\in \\mathbb{R}^{n \\times (n m)},\n$$\n以及离散时间能观矩阵为\n$$\n\\mathcal{O}_d(A_d,C) = \\begin{bmatrix}\nC \\\\\nC A_d \\\\\n\\vdots \\\\\nC A_d^{n-1}\n\\end{bmatrix} \\in \\mathbb{R}^{(n p) \\times n}。\n$$\n当 $\\operatorname{rank}(\\mathcal{R}_d) = n$ 时，该离散时间模型是能达的；当 $\\operatorname{rank}(\\mathcal{O}_d) = n$ 时，该模型是能观的。\n\n您的任务是编写一个完整的程序，对每个测试用例执行以下所有操作：\n- 对于给定的 $(A,B)$ 和采样周期 $T$，计算 ZOH 等效的离散时间系统对 $(A_d,B_d)$。\n- 构建 $\\mathcal{R}_d$ 和 $\\mathcal{O}_d$，并使用基于机器精度的容差，通过数值稳定的奇异值分解计算它们的矩阵秩。\n- 如果 $\\operatorname{rank}(\\mathcal{R}_d) = n$，则报告扰动 $\\delta T = 0$（单位：秒）。如果 $\\operatorname{rank}(\\mathcal{R}_d)  n$，则确定在均匀搜索网格内恢复满秩能达性所需的最小量级扰动 $\\delta T$（单位：秒），并遵循以下规则：\n  1. 在离散对称集合 $\\{\\delta T = k \\Delta \\mid k \\in \\mathbb{Z}, 1 \\le |k| \\le K_{\\max} \\}$ 上搜索扰动，步长 $\\Delta = 10^{-3}$ 秒，界限 $K_{\\max} = 1000$。\n  2. 接受搜索过程中遇到的第一个使得 $\\operatorname{rank}(\\mathcal{R}_d(A_d(T+\\delta T), B_d(T+\\delta T))) = n$ 成立的最小非零量级 $\\delta T$。如果 $\\pm k \\Delta$ 出现量级相同的情况，选择负扰动（即，优先选择 $\\delta T = -k \\Delta$）。\n  3. 如果在搜索集合内不存在这样的 $\\delta T$，或者连续时间系统对 $(A,B)$ 本身不是能达的（即 $\\operatorname{rank}([B, AB, \\dots, A^{n-1} B])  n$），则报告 $\\delta T = -1$（一个表示在给定约束下不可能实现的哨兵值）。\n\n所有时间都必须以秒为单位。角度量（如有）以弧度为单位。所有秩均为整数。扰动 $\\delta T$ 必须报告为四舍五入到六位小数的实数。\n\n使用以下测试套件。对于每个案例，使用给定的 $(A,B,C,T)$：\n- 案例 1：$n = 2$, $m = 1$, $p = 1$, $A = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1  0 \\end{bmatrix}$, $T = 2\\pi$。\n- 案例 2：$n = 2$, $m = 1$, $p = 1$, $A = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1  0 \\end{bmatrix}$, $T = \\pi$。\n- 案例 3：$n = 2$, $m = 1$, $p = 1$, $A = \\begin{bmatrix} 0  1 \\\\ 0  0 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1  0 \\end{bmatrix}$, $T = 0.1$。\n- 案例 4：$n = 2$, $m = 1$, $p = 1$, $A = \\begin{bmatrix} 0  0 \\\\ 0  0 \\end{bmatrix}$, $B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$, $C = \\begin{bmatrix} 0  1 \\end{bmatrix}$, $T = 0.3$。\n- 案例 5：$n = 3$, $m = 1$, $p = 1$, $A = \\begin{bmatrix} 0  1  0 \\\\ -4  0  0 \\\\ 0  0  -1 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$, $C = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$, $T = \\pi$。\n\n您的程序必须输出单行内容，该行包含一个逗号分隔的扁平列表，按顺序汇总所有案例的结果。对于每个案例，依次输出三个值：整数能达秩 $\\operatorname{rank}(\\mathcal{R}_d)$、整数能观秩 $\\operatorname{rank}(\\mathcal{O}_d)$ 和四舍五入到六位小数的扰动 $\\delta T$。例如，输出格式必须严格为\n$[r_{c,1},r_{o,1},\\delta T_1,r_{c,2},r_{o,2},\\delta T_2,\\dots,r_{c,5},r_{o,5},\\delta T_5]$，\n其中 $\\delta T_i$ 打印为六位小数（例如，$0.001000$），适用时哨兵值打印为 $-1.000000$。", "solution": "所呈现的问题陈述经过了严格的验证。\n\n步骤 1：提取给定条件\n- 连续时间状态空间模型：$\\dot{x}(t) = A x(t) + B u(t)$，$y(t) = C x(t)$，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$，$C \\in \\mathbb{R}^{p \\times n}$。\n- 零阶保持器 (ZOH) 离散时间等效模型：$x_{k+1} = A_d x_k + B_d u_k$，$y_k = C x_k$。\n- 离散化公式：$A_d = e^{A T}$ 和 $B_d = \\int_{0}^{T} e^{A \\tau} B \\, d\\tau$，其中 $T  0$ 是采样周期。\n- 离散时间能达矩阵：$\\mathcal{R}_d(A_d,B_d) = \\left[ B_d \\; , \\; A_d B_d \\; , \\; \\dots \\; , \\; A_d^{n-1} B_d \\right] \\in \\mathbb{R}^{n \\times (n m)}$。\n- 离散时间能观矩阵：$\\mathcal{O}_d(A_d,C) = \\begin{bmatrix} C \\\\ C A_d \\\\ \\vdots \\\\ C A_d^{n-1} \\end{bmatrix} \\in \\mathbb{R}^{(n p) \\times n}$。\n- 秩条件：当 $\\operatorname{rank}(\\mathcal{R}_d) = n$ 时，离散系统是能达的；当 $\\operatorname{rank}(\\mathcal{O}_d) = n$ 时，是能观的。\n- 针对能达性的扰动搜索任务：\n    1. 如果 $\\operatorname{rank}(\\mathcal{R}_d(T)) = n$，报告 $\\delta T = 0$。\n    2. 如果 $\\operatorname{rank}(\\mathcal{R}_d(T))  n$，搜索最小量级的扰动 $\\delta T$ 以恢复满秩。\n    3. $\\delta T$ 的搜索网格是离散集合 $\\{\\delta T = k \\Delta \\mid k \\in \\mathbb{Z}, 1 \\le |k| \\le K_{\\max} \\}$。\n    4. 搜索参数：步长 $\\Delta = 10^{-3}$ 秒，最大步长乘数 $K_{\\max} = 1000$。\n    5. 平局打破规则：对于量级 $|k \\Delta|$ 相同的平局情况，优先选择负扰动 $-k\\Delta$。\n    6. 哨兵值：如果连续时间系统对 $(A,B)$ 不是能达的，或者在指定的搜索集合内未找到合适的扰动，则报告 $\\delta T = -1$。\n- 数值方法：矩阵秩将通过奇异值分解 (SVD) 计算，其容差基于机器精度。\n- 测试用例：提供了五组不同的 $(A, B, C, T)$。\n- 输出格式：一个扁平的结果列表 $[r_{c,1},r_{o,1},\\delta T_1, \\dots, r_{c,5},r_{o,5},\\delta T_5]$，其中 $\\delta T$ 值四舍五入到六位小数。\n\n步骤 2：使用提取的给定条件进行验证\n该问题在科学上基于线性系统和控制理论的既定原则，特别是关于连续时间系统的离散化及系统结构特性的分析。ZOH 等效模型、能达性矩阵和能观性矩阵的定义都是标准的。因病态采样而导致系统特性丢失的现象是一个有据可查的课题。该问题是适定的 (well-posed)，提供了明确的目标、所有必要的数据以及一个用于寻找扰动 $\\delta T$ 的确定性算法。语言客观且明确。该问题未违反任何无效性标准。\n\n步骤 3：结论与行动\n该问题被判定为 **有效**。将开发一个解决方案。\n\n解决方案按以下步骤进行。对于由参数 $(A, B, C, T)$ 定义的每个测试用例，我们必须执行一系列计算。\n\n首先，必须为给定的采样周期 $T$ 计算 ZOH 等效的离散时间系统矩阵 $(A_d, B_d)$。一种稳健且标准的计算方法涉及增广分块矩阵的矩阵指数。定义矩阵 $M$ 如下：\n$$\nM = \\begin{bmatrix} A  B \\\\ \\mathbf{0}  \\mathbf{0} \\end{bmatrix} \\in \\mathbb{R}^{(n+m) \\times (n+m)}\n$$\n$M T$ 的指数在其上部分块中产生所需的离散时间矩阵：\n$$\ne^{M T} = \\exp\\left( \\begin{bmatrix} AT  BT \\\\ \\mathbf{0}  \\mathbf{0} \\end{bmatrix} \\right) = \\begin{bmatrix} e^{AT}  \\left(\\int_0^T e^{A\\sigma} d\\sigma\\right) B \\\\ \\mathbf{0}  I \\end{bmatrix} = \\begin{bmatrix} A_d  B_d \\\\ \\mathbf{0}  I \\end{bmatrix}\n$$\n此计算可由数值库高效处理，例如使用 Padé 近似。\n\n其次，利用离散时间系统对 $(A_d, B_d)$ 和矩阵 $C$，我们构建离散时间能达矩阵 $\\mathcal{R}_d$ 和能观矩阵 $\\mathcal{O}_d$。\n$$\n\\mathcal{R}_d = \\begin{bmatrix} B_d  A_d B_d  \\dots  A_d^{n-1} B_d \\end{bmatrix}\n$$\n$$\n\\mathcal{O}_d = \\begin{bmatrix} C \\\\ CA_d \\\\ \\vdots \\\\ CA_d^{n-1} \\end{bmatrix}\n$$\n这些矩阵的秩决定了系统特性。秩定义为非零奇异值的数量，为保证数值稳定性，最好通过 SVD 计算，并统计大于基于机器精度导出的容差的奇异值数量。\n\n第三，我们分析能达性并确定扰动 $\\delta T$。\n首先评估使用初始采样周期 $T$ 计算出的 $\\mathcal{R}_d$ 的秩。如果此秩等于状态维度 $n$，则系统是能达的，所需扰动为 $\\delta T = 0$。\n\n如果秩小于 $n$，则发生了能达性损失。这可能是因为原始的连续时间系统本身就是不能达的，也可能是采样过程中的病态现象。我们首先通过计算连续时间能达矩阵 $\\mathcal{R}_c$ 的秩来检查连续时间的能达性：\n$$\n\\mathcal{R}_c = \\begin{bmatrix} B  AB  \\dots  A^{n-1}B \\end{bmatrix}\n$$\n如果 $\\operatorname{rank}(\\mathcal{R}_c)  n$，则系统是根本不能达的，任何采样周期的改变都无法纠正这一点。根据问题规则，我们报告 $\\delta T = -1$。\n\n如果 $\\operatorname{rank}(\\mathcal{R}_c) = n$ 但 $\\operatorname{rank}(\\mathcal{R}_d)  n$，则能达性的损失是由病态采样引起的。这通常发生在采样周期 $T$ 与系统的固有频率（与 $A$ 的特征值的虚部相关）发生破坏性相互作用时。我们必须搜索一个最小扰动 $\\delta T$ 来恢复能达性。搜索在离散网格上进行，对于从 $1$ 到 $K_{\\max} = 1000$ 的整数 $k$：\n1. 测试负扰动。令 $T_{\\text{new}} = T - k \\Delta$，其中 $\\Delta = 10^{-3}$。如果 $T_{\\text{new}}  0$，计算新的离散系统 $(A_d(T_{\\text{new}}), B_d(T_{\\text{new}}))$ 及其对应能达矩阵的秩。如果秩为 $n$，则找到最小扰动：$\\delta T = -k \\Delta$。搜索终止。\n2. 如果未测试负扰动或负扰动不成功，则测试正扰动。令 $T_{\\text{new}} = T + k \\Delta$。计算新的离散系统及其能达秩。如果秩为 $n$，则找到最小扰动：$\\delta T = +k \\Delta$。搜索终止。\n此搜索顺序内在地满足了优先选择负扰动的平局打破规则。如果循环完成仍未找到合适的扰动，则在给定约束内不存在解决方案，我们报告 $\\delta T = -1$。\n\n整个过程被封装在一个程序中，并应用于每个指定的测试用例以生成所需的输出。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef compute_rank(matrix):\n    \"\"\"\n    Computes the rank of a matrix using SVD-based method from numpy.\n    This method is numerically stable and uses a tolerance based on machine precision.\n    \"\"\"\n    if matrix.size == 0:\n        return 0\n    return np.linalg.matrix_rank(matrix)\n\ndef get_discrete_system(A, B, T):\n    \"\"\"\n    Computes the ZOH-equivalent discrete-time system (Ad, Bd) for a given\n    continuous-time system (A, B) and sampling period T.\n    \"\"\"\n    n = A.shape[0]\n    m = B.shape[1]\n\n    # Handle invalid sampling period\n    if T = 0:\n        raise ValueError(\"Sampling period T must be positive.\")\n\n    # Augmented matrix method\n    M = np.zeros((n + m, n + m))\n    M[:n, :n] = A\n    M[:n, n:] = B\n    \n    phi = expm(M * T)\n    \n    Ad = phi[:n, :n]\n    Bd = phi[:n, n:]\n    \n    return Ad, Bd\n\ndef get_reachability_matrix(A_mat, B_mat, n):\n    \"\"\"\n    Constructs the reachability matrix R = [B, AB, A^2B, ..., A^(n-1)B].\n    \"\"\"\n    if B_mat.size == 0:\n        return np.zeros((n, 0))\n    m = B_mat.shape[1]\n    R_d = np.zeros((n, n * m))\n    \n    current_power_B = B_mat\n    R_d[:, 0:m] = current_power_B\n    \n    for i in range(1, n):\n        current_power_B = A_mat @ current_power_B\n        R_d[:, i * m:(i + 1) * m] = current_power_B\n        \n    return R_d\n\ndef get_observability_matrix(A_mat, C_mat, n):\n    \"\"\"\n    Constructs the observability matrix O = [C^T, (CA)^T, ..., (CA^(n-1))^T]^T.\n    \"\"\"\n    p = C_mat.shape[0]\n    O_d = np.zeros((n * p, n))\n    \n    current_power_C = C_mat\n    O_d[0:p, :] = current_power_C\n    \n    for i in range(1, n):\n        current_power_C = current_power_C @ A_mat\n        O_d[i * p:(i + 1) * p, :] = current_power_C\n        \n    return O_d\n\ndef process_case(A, B, C, T):\n    \"\"\"\n    Analyzes a single test case according to the problem description.\n    \"\"\"\n    A = np.array(A, dtype=float)\n    B = np.array(B, dtype=float)\n    C = np.array(C, dtype=float)\n    \n    n = A.shape[0]\n    \n    # 1. Compute discrete system and initial ranks\n    Ad, Bd = get_discrete_system(A, B, T)\n    \n    R_d = get_reachability_matrix(Ad, Bd, n)\n    O_d = get_observability_matrix(Ad, C, n)\n    \n    rank_r_d = compute_rank(R_d)\n    rank_o_d = compute_rank(O_d)\n    \n    # 2. Determine delta_T\n    delta_T = 0.0\n    \n    if rank_r_d  n:\n        # Check continuous-time reachability\n        R_c = get_reachability_matrix(A, B, n)\n        if compute_rank(R_c)  n:\n            delta_T = -1.0\n        else:\n            # Search for a perturbation\n            delta_T = -1.0  # Default to sentinel if not found\n            DELTA = 1e-3\n            K_MAX = 1000\n            \n            found = False\n            for k in range(1, K_MAX + 1):\n                # Try negative perturbation first\n                T_neg = T - k * DELTA\n                if T_neg  0:\n                    Ad_neg, Bd_neg = get_discrete_system(A, B, T_neg)\n                    R_d_neg = get_reachability_matrix(Ad_neg, Bd_neg, n)\n                    if compute_rank(R_d_neg) == n:\n                        delta_T = -k * DELTA\n                        found = True\n                        break\n                \n                # Try positive perturbation\n                T_pos = T + k * DELTA\n                Ad_pos, Bd_pos = get_discrete_system(A, B, T_pos)\n                R_d_pos = get_reachability_matrix(Ad_pos, Bd_pos, n)\n                if compute_rank(R_d_pos) == n:\n                    delta_T = k * DELTA\n                    found = True\n                    break\n            \n    return rank_r_d, rank_o_d, delta_T\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"A\": [[0, 1], [-1, 0]], \"B\": [[0], [1]], \n            \"C\": [[1, 0]], \"T\": 2 * np.pi\n        },\n        {\n            \"A\": [[0, 1], [-1, 0]], \"B\": [[0], [1]], \n            \"C\": [[1, 0]], \"T\": np.pi\n        },\n        {\n            \"A\": [[0, 1], [0, 0]], \"B\": [[0], [1]], \n            \"C\": [[1, 0]], \"T\": 0.1\n        },\n        {\n            \"A\": [[0, 0], [0, 0]], \"B\": [[1], [0]], \n            \"C\": [[0, 1]], \"T\": 0.3\n        },\n        {\n            \"A\": [[0, 1, 0], [-4, 0, 0], [0, 0, -1]], \"B\": [[0], [1], [1]],\n            \"C\": [[1, 0, 0]], \"T\": np.pi\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        r_c, r_o, dt = process_case(case[\"A\"], case[\"B\"], case[\"C\"], case[\"T\"])\n        results.extend([r_c, r_o, f\"{dt:.6f}\"])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2743060"}]}