{"hands_on_practices": [{"introduction": "掌握线性化的第一步是熟练进行基本计算。这个练习 [@problem_id:1590122] 提供了一个简单的一阶非线性系统，旨在帮助你练习围绕一个工作点计算雅可比矩阵 $A$ 和 $B$ 的核心技能。通过这个直接的例子，你将巩固将泰勒展开应用于动力学系统以获得其线性近似的过程。", "problem": "一个简单的单变量非线性动力系统用于模拟一个组件的热行为。其温度的变化率，由状态变量 $x(t)$ 表示，受到控制输入 $u(t)$ 的影响。该系统由以下一阶非线性微分方程描述：\n\n$$ \\dot{x} = -x^3 + \\tan(u) $$\n\n为了设计一个局部控制器，需要围绕一个特定的工作点对此模型进行线性化。所选的工作点为 $(x_0, u_0) = (1, \\frac{\\pi}{4})$，其中所有角度均以弧度为单位。\n\n线性化后的模型具有状态空间方程的形式：\n$$ \\Delta \\dot{x} = A \\Delta x + B \\Delta u $$\n其中 $\\Delta x = x - x_0$ 表示状态对其工作值的偏差，$\\Delta u = u - u_0$ 表示输入的偏差。\n\n确定该线性化模型中常数 $A$ 和 $B$ 的值。从以下选项中选择正确的数对 $(A, B)$。\n\nA. $(A, B) = (-3, 2)$\n\nB. $(A, B) = (3, 2)$\n\nC. $(A, B) = (-3, \\sqrt{2})$\n\nD. $(A, B) = (-1, 2)$\n\nE. $(A, B) = (-3, 1)$", "solution": "我们从非线性系统 $\\dot{x}=f(x,u)$ 开始，其中 $f(x,u)=-x^{3}+\\tan(u)$。为了获得在 $(x_{0},u_{0})=(1,\\frac{\\pi}{4})$ 附近的局部线性模型，我们使用一阶泰勒展开（雅可比线性化）：\n$$\n\\Delta \\dot{x}=\\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_{0},u_{0})}\\Delta x+\\left.\\frac{\\partial f}{\\partial u}\\right|_{(x_{0},u_{0})}\\Delta u,\n$$\n因此 $A=\\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_{0},u_{0})}$ 且 $B=\\left.\\frac{\\partial f}{\\partial u}\\right|_{(x_{0},u_{0})}$。\n\n计算偏导数：\n$$\n\\frac{\\partial f}{\\partial x}=-3x^{2},\\qquad \\frac{\\partial f}{\\partial u}=\\frac{d}{du}\\tan(u)=1+\\tan^{2}(u).\n$$\n在点 $(x_{0},u_{0})=(1,\\frac{\\pi}{4})$ 处求值：\n$$\nA=-3(1)^{2}=-3,\\qquad B=1+\\tan^{2}\\!\\left(\\frac{\\pi}{4}\\right)=1+1^{2}=2.\n$$\n因此 $(A,B)=(-3,2)$，对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1590122"}, {"introduction": "线性化不仅是一种数学工具，它还为理解复杂物理系统提供了深刻的洞察力。本练习 [@problem_id:2720555] 将线性化技术应用于一个更真实的场景：飞行器的三维空气动力学阻力模型。通过处理这个多变量问题，你将学习到线性化矩阵中的各个元素如何对应于物理量（如阻尼系数），并揭示系统在不同方向上动态响应的差异。", "problem": "考虑一个被建模为质点的刚性飞行器的平动动力学。设惯性速度矢量为 $v \\in \\mathbb{R}^{3}$，质量为 $m0$。作用在飞行器上的非线性气动阻力模型为\n$$\nF_{d}(v) = \\frac{1}{2}\\,\\rho\\,C_{D}\\,S\\,\\|v\\|\\,v,\n$$\n其中 $\\rho$ 是空气密度，$C_{D}$ 是一个恒定的阻力系数，$S$ 是参考面积。其平动动力学方程为\n$$\nm\\,\\dot{v} \\,=\\, F_{\\text{ext}}(t) \\;-\\; F_{d}(v),\n$$\n其中 $F_{\\text{ext}}(t)$ 包括所有其他力（例如，推力和重力），并使得在恒定速度下存在一个稳定的直线飞行工作点\n$$\nv_{0} \\;=\\; \\begin{pmatrix} V_{0} \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad V_{0} \\,\\, 0,\n$$\n此时加速度为零（即，在 $v=v_{0}$ 时，由于与 $F_{\\text{ext}}$ 精确平衡，$\\dot{v}=0$）。你需要围绕该工作点，对速度 $v$ 的扰动进行速度动力学的线性化，并在 $v_{0}$ 的一个足够小的邻域内将 $\\rho$、$C_{D}$ 和 $S$ 视作常数。\n\n使用非线性系统 $\\dot{x} = f(x)$ 在 $x_{0}$ 附近的线性化定义，即 $\\dot{\\delta x} \\approx A\\,\\delta x$，其中 $A = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x_{0}}$。仅关注气动阻力 $F_{d}(v)$ 对线性化动力学的贡献，并计算系统矩阵 $A$ 中与 $\\delta \\dot{v}$ 和 $\\delta v$ 相关的对应项。具体来说，确定三个对角线元素\n$$\nA_{11},\\; A_{22},\\; A_{33} \\quad \\text{其中} \\quad A_{ij} \\;=\\; \\left.\\frac{\\partial \\dot{v}_{i}}{\\partial v_{j}}\\right|_{v=v_{0}},\n$$\n这些元素仅由阻力项产生。\n\n用 $\\rho$、$C_{D}$、$S$、$m$ 和 $V_{0}$ 的符号形式给出你的最终结果。将你的答案表示为单个 $1 \\times 3$ 的行矩阵 $[A_{11},\\,A_{22},\\,A_{33}]$。不要代入数值。无需四舍五入。最终答案中不要包含单位。", "solution": "该问题要求围绕一个指定的工作点对飞行器的平动动力学进行线性化。运动方程给出如下\n$$\nm\\,\\dot{v} \\,=\\, F_{\\text{ext}}(t) \\;-\\; F_{d}(v)\n$$\n其中 $m$ 是质量，$v \\in \\mathbb{R}^3$ 是速度，$F_{\\text{ext}}(t)$ 是外力，$F_{d}(v)$ 是非线性气动阻力。对于速度动力学，这可以改写为\n$$\n\\dot{v} \\,=\\, \\frac{1}{m} F_{\\text{ext}}(t) \\;-\\; \\frac{1}{m} F_{d}(v).\n$$\n我们被要求围绕稳态工作点 $v_0 = \\begin{pmatrix} V_{0} \\\\ 0 \\\\ 0 \\end{pmatrix}$（其中 $V_0  0$）对该系统进行线性化。一个系统 $\\dot{x} = f(x, u)$ 围绕工作点 $(x_0, u_0)$ 的线性化结果为线性系统 $\\dot{\\delta x} \\approx A \\delta x + B \\delta u$，其中 $\\delta x = x - x_0$，$\\delta u = u - u_0$，系统矩阵 $A$ 是雅可比矩阵 $A = \\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_0, u_0)}$。\n\n问题指明，我们必须只关注气动阻力 $F_d(v)$ 对线性化动力学的贡献。这意味着我们要计算 $\\dot{v}$ 表达式中与阻力相关的项的雅可比矩阵。设状态为 $x=v$。动力学函数中与速度相关的部分是 $f(v) = -\\frac{1}{m} F_d(v)$。因此，阻力贡献的系统矩阵 $A$ 为\n$$\nA = \\left.\\frac{\\partial}{\\partial v}\\left(-\\frac{1}{m} F_d(v)\\right)\\right|_{v = v_0}.\n$$\n阻力由下式给出\n$$\nF_{d}(v) = \\frac{1}{2}\\rho C_{D} S \\|v\\| v,\n$$\n其中 $\\rho$、$C_{D}$ 和 $S$ 是正常数，且 $\\|v\\| = \\sqrt{v_1^2 + v_2^2 + v_3^2}$。\n为简化符号，我们定义一个常数 $k = \\frac{\\rho C_{D} S}{2m}$。阻力对动力学的贡献为\n$$\nf(v) = -k \\|v\\| v.\n$$\n该矢量函数的分量为 $f_i(v) = -k \\|v\\| v_i$，其中 $i=1, 2, 3$。雅可比矩阵 $A$ 的元素由 $A_{ij} = \\left.\\frac{\\partial f_i}{\\partial v_j}\\right|_{v=v_0}$ 给出。使用乘法法则求导，我们有：\n$$\n\\frac{\\partial f_i}{\\partial v_j} = -k \\frac{\\partial}{\\partial v_j} (\\|v\\| v_i) = -k \\left( \\left(\\frac{\\partial \\|v\\|}{\\partial v_j}\\right) v_i + \\|v\\| \\left(\\frac{\\partial v_i}{\\partial v_j}\\right) \\right).\n$$\n所需的偏导数为：\n$$\n\\frac{\\partial v_i}{\\partial v_j} = \\delta_{ij} \\quad (\\text{克罗内克δ函数})\n$$\n$$\n\\frac{\\partial \\|v\\|}{\\partial v_j} = \\frac{\\partial}{\\partial v_j} \\left( \\sum_{l=1}^{3} v_l^2 \\right)^{1/2} = \\frac{1}{2} \\left( \\sum_{l=1}^{3} v_l^2 \\right)^{-1/2} (2 v_j) = \\frac{v_j}{\\|v\\|}.\n$$\n代入这些表达式，得到雅可比元素的一般形式：\n$$\n\\frac{\\partial f_i}{\\partial v_j} = -k \\left( \\frac{v_j}{\\|v\\|} v_i + \\|v\\| \\delta_{ij} \\right).\n$$\n我们必须在工作点 $v_0 = (V_0, 0, 0)^T$ 处计算这些元素的值。在该点，速度分量为 $v_1 = V_0$，$v_2 = 0$，$v_3 = 0$，速率为 $\\|v_0\\| = \\sqrt{V_0^2 + 0^2 + 0^2} = V_0$。\n\n问题要求矩阵 $A$ 的对角线元素：$A_{11}$、$A_{22}$ 和 $A_{33}$。通过在一般公式中令 $j=i$ 并在 $v_0$ 处求值来得到这些元素。\n对于一般的对角线元素 $A_{ii}$：\n$$\nA_{ii} = \\left.\\frac{\\partial f_i}{\\partial v_i}\\right|_{v_0} = \\left. -k \\left( \\frac{v_i^2}{\\|v\\|} + \\|v\\| \\right) \\right|_{v=v_0}.\n$$\n现在我们计算每个所需的元素。\n\n对于 $A_{11}$（$i=1$）：\n$$\nA_{11} = -k \\left( \\frac{V_0^2}{V_0} + V_0 \\right) = -k (V_0 + V_0) = -2 k V_0.\n$$\n代回 $k = \\frac{\\rho C_{D} S}{2m}$：\n$$\nA_{11} = -2 \\left(\\frac{\\rho C_{D} S}{2m}\\right) V_0 = -\\frac{\\rho C_{D} S V_0}{m}.\n$$\n\n对于 $A_{22}$（$i=2$）：\n$$\nA_{22} = -k \\left( \\frac{0^2}{V_0} + V_0 \\right) = -k (0 + V_0) = -k V_0.\n$$\n代回 $k = \\frac{\\rho C_{D} S}{2m}$：\n$$\nA_{22} = -\\left(\\frac{\\rho C_{D} S}{2m}\\right) V_0 = -\\frac{\\rho C_{D} S V_0}{2m}.\n$$\n\n对于 $A_{33}$（$i=3$）：\n$$\nA_{33} = -k \\left( \\frac{0^2}{V_0} + V_0 \\right) = -k (0 + V_0) = -k V_0.\n$$\n代回 $k = \\frac{\\rho C_{D} S}{2m}$：\n$$\nA_{33} = -\\left(\\frac{\\rho C_{D} S}{2m}\\right) V_0 = -\\frac{\\rho C_{D} S V_0}{2m}.\n$$\n纵向阻尼项 $A_{11}$ 与横向-航向阻尼项 $A_{22}$ 和 $A_{33}$ 之间相差一个因子2，这在物理上是正确的。前向速度的扰动会影响速度矢量的大小和阻力公式中的速度分量，产生二次依赖关系，这在线性化后导致一个因子2。从零开始的横向速度扰动，对阻力分量的影响仅为一阶线性，因为它们对速度大小的贡献是二阶的。\n\n最终结果是这三个对角线元素，以行矩阵的形式呈现。\n$$\n[A_{11}, A_{22}, A_{33}] = \\left[ -\\frac{\\rho C_{D} S V_0}{m}, -\\frac{\\rho C_{D} S V_0}{2m}, -\\frac{\\rho C_{D} S V_0}{2m} \\right].\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\rho C_{D} S V_{0}}{m}  -\\frac{\\rho C_{D} S V_{0}}{2m}  -\\frac{\\rho C_{D} S V_{0}}{2m}\n\\end{pmatrix}\n}\n$$", "id": "2720555"}, {"introduction": "在实际的控制系统中，饱和等非线性环节无处不在，深刻影响着系统的行为。这个练习 [@problem_id:2720584] 探讨了执行器饱和对系统线性化模型的影响，这是一个至关重要的实践课题。通过比较在非饱和区和饱和区得到的线性化模型，你将直观地理解为何线性化是“局部”有效的，以及工作点的选择如何从根本上改变系统的局部动态特性和可控性。", "problem": "考虑一个单输入单状态系统，其动态由 $\\dot{x} = f(x,u)$ 给出，其中 $f(x,u) = -x + u^{3}$。控制输入 $u$ 由一个具有饱和非线性 $u = \\mathrm{sat}(v)$ 的执行器生成，其中\n$$\n\\mathrm{sat}(v) = \n\\begin{cases}\n-2,  v \\le -2, \\\\\nv,  -2  v  2, \\\\\n2,  v \\ge 2.\n\\end{cases}\n$$\n您需要将从执行器指令 $v$ 到状态 $x$ 的闭环映射在两个稳态工作点附近进行线性化。稳态工作点 $(x^{\\star},u^{\\star},v^{\\star})$ 满足 $0 = f(x^{\\star},u^{\\star})$ 和 $u^{\\star} = \\mathrm{sat}(v^{\\star})$。\n\n1) 一个非饱和工作点由 $v^{\\star} = 1$ 指定。确定该点的 $u^{\\star}$ 和 $x^{\\star}$。\n\n2) 一个饱和工作点由 $v^{\\star} = 3$ 指定。确定该点的 $u^{\\star}$ 和 $x^{\\star}$。\n\n从一阶泰勒展开和基础微积分（包括链式法则）出发，推导每个工作点附近形如\n$$\n\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta v,\n$$\n的一阶线性化模型，其中 $\\delta x = x - x^{\\star}$ 且 $\\delta v = v - v^{\\star}$。计算每个工作点对应的输入增益 $B$。\n\n将您的最终答案以单行矩阵的形式表示为一对值 $\\big(B_{\\text{unsat}},\\,B_{\\text{sat}}\\big)$。给出精确值，不要四舍五入。", "solution": "问题陈述已经过评估，被认为是有效的。这是一个关于非线性系统线性化的适定问题，也是控制理论中的一个基本课题。所有必要的数据和定义都已提供，不存在科学或逻辑上的不一致之处。我们将开始求解。\n\n系统动态由以下非线性微分方程给出：\n$$\n\\dot{x} = f(x,u) = -x + u^{3}\n$$\n系统输入 $u$ 由执行器指令 $v$ 通过一个饱和函数确定：\n$$\nu = \\mathrm{sat}(v) = \n\\begin{cases}\n-2,  v \\le -2 \\\\\nv,  -2  v  2 \\\\\n2,  v \\ge 2\n\\end{cases}\n$$\n将这些结合起来，从指令 $v$ 到状态 $x$ 的闭环系统动态为：\n$$\n\\dot{x} = g(x,v) = -x + (\\mathrm{sat}(v))^{3}\n$$\n我们的任务是在指定的工作点 $(x^{\\star}, v^{\\star})$ 附近对该系统进行线性化。将 $\\dot{x} = g(x,v)$ 在 $(x^{\\star}, v^{\\star})$ 附近进行一阶泰勒展开，得到：\n$$\n\\dot{x} \\approx g(x^{\\star}, v^{\\star}) + \\frac{\\partial g}{\\partial x}\\bigg|_{(x^{\\star}, v^{\\star})} (x - x^{\\star}) + \\frac{\\partial g}{\\partial v}\\bigg|_{(x^{\\star}, v^{\\star})} (v - v^{\\star})\n$$\n根据定义，在稳态工作点处，$\\dot{x}^{\\star} = g(x^{\\star}, v^{\\star}) = 0$。令 $\\delta x = x - x^{\\star}$ 且 $\\delta v = v - v^{\\star}$。线性化动态为：\n$$\n\\delta \\dot{x} = \\frac{\\partial g}{\\partial x}\\bigg|_{(x^{\\star}, v^{\\star})} \\delta x + \\frac{\\partial g}{\\partial v}\\bigg|_{(x^{\\star}, v^{\\star})} \\delta v\n$$\n这符合所需的形式 $\\delta \\dot{x} = A\\,\\delta x + B\\,\\delta v$，其中：\n$$\nA = \\frac{\\partial g}{\\partial x}\\bigg|_{(x^{\\star}, v^{\\star})} \\quad \\text{和} \\quad B = \\frac{\\partial g}{\\partial v}\\bigg|_{(x^{\\star}, v^{\\star})}\n$$\n问题要求计算输入增益 $B$。我们计算 $g(x,v)$ 关于 $v$ 的偏导数：\n$$\nB = \\frac{\\partial}{\\partial v} \\left( -x + (\\mathrm{sat}(v))^{3} \\right)\n$$\n使用链式法则，可得：\n$$\nB = 3(\\mathrm{sat}(v))^{2} \\cdot \\frac{d}{dv}(\\mathrm{sat}(v))\n$$\n该表达式必须在每个工作点处求值。饱和函数的导数是分段常数：\n$$\n\\frac{d}{dv}(\\mathrm{sat}(v)) = \n\\begin{cases}\n0,  v  -2 \\text{ 或 } v > 2 \\\\\n1,  -2  v  2\n\\end{cases}\n$$\n导数在 $v = \\pm 2$ 处未定义，但指定的工作点不在这些边界上。\n\n情况1：非饱和工作点\n给定 $v^{\\star} = 1$。该值位于区域 $(-2, 2)$ 内。\n首先，我们确定相应的稳态值 $u^{\\star}$ 和 $x^{\\star}$。\n对于 $v^{\\star} = 1$，执行器处于其线性区：\n$$\nu^{\\star} = \\mathrm{sat}(v^{\\star}) = \\mathrm{sat}(1) = 1\n$$\n稳态条件为 $\\dot{x} = 0$，因此 $f(x^{\\star}, u^{\\star}) = 0$：\n$$\n-x^{\\star} + (u^{\\star})^{3} = 0 \\implies x^{\\star} = (u^{\\star})^{3} = (1)^{3} = 1\n$$\n非饱和工作点为 $(x^{\\star}, u^{\\star}, v^{\\star}) = (1, 1, 1)$。\n现在，我们计算该点的增益 $B_{\\text{unsat}}$。由于 $v^{\\star}=1$ 处于非饱和区，饱和函数的导数为：\n$$\n\\frac{d}{dv}(\\mathrm{sat}(v))\\bigg|_{v=1} = 1\n$$\n将 $v^{\\star} = 1$ 和 $u^{\\star} = \\mathrm{sat}(1) = 1$ 代入 $B$ 的表达式中：\n$$\nB_{\\text{unsat}} = 3(\\mathrm{sat}(1))^{2} \\cdot \\left(\\frac{d}{dv}(\\mathrm{sat}(v))\\bigg|_{v=1}\\right) = 3(1)^{2} \\cdot 1 = 3\n$$\n\n情况2：饱和工作点\n给定 $v^{\\star} = 3$。该值位于区域 $v \\ge 2$ 内。\n首先，我们确定相应的稳态值 $u^{\\star}$ 和 $x^{\\star}$。\n对于 $v^{\\star} = 3$，执行器处于饱和状态：\n$$\nu^{\\star} = \\mathrm{sat}(v^{\\star}) = \\mathrm{sat}(3) = 2\n$$\n稳态条件 $f(x^{\\star}, u^{\\star}) = 0$ 给出：\n$$\n-x^{\\star} + (u^{\\star})^{3} = 0 \\implies x^{\\star} = (u^{\\star})^{3} = (2)^{3} = 8\n$$\n饱和工作点为 $(x^{\\star}, u^{\\star}, v^{\\star}) = (8, 2, 3)$。\n现在，我们计算该点的增益 $B_{\\text{sat}}$。由于 $v^{\\star}=3$ 处于饱和区，饱和函数的导数为：\n$$\n\\frac{d}{dv}(\\mathrm{sat}(v))\\bigg|_{v=3} = 0\n$$\n将 $v^{\\star} = 3$ 和 $u^{\\star} = \\mathrm{sat}(3) = 2$ 代入 $B$ 的表达式中：\n$$\nB_{\\text{sat}} = 3(\\mathrm{sat}(3))^{2} \\cdot \\left(\\frac{d}{dv}(\\mathrm{sat}(v))\\bigg|_{v=3}\\right) = 3(2)^{2} \\cdot 0 = 0\n$$\n增益为零，这在预料之中。在饱和状态下，指令 $v$ 的微小变化不影响执行器输出 $u$，因此也不影响状态动态。\n\n最终答案是这对值 $(B_{\\text{unsat}}, B_{\\text{sat}})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  0\n\\end{pmatrix}\n}\n$$", "id": "2720584"}]}