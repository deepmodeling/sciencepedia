{"hands_on_practices": [{"introduction": "差分平坦性的一个核心优势在于它能够将复杂的非线性系统动力学转化为更简单的形式。在利用这一特性之前，我们必须首先确定一个系统是否具备必要的结构。本练习将引导你通过计算一个非线性系统的相对阶来迈出第一步，这是判断系统是否可以通过状态反馈线性化的关键指标 [@problem_id:2700623]。掌握这一基础分析是应用更高级的平坦性概念的前提。", "problem": "考虑一个单输入单输出（SISO）非线性系统，其状态向量为 $x=\\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$，控制输入为 $u$，输出为 $y$，由以下方程给出：\n$$\n\\dot{x}_{1}=x_{2},\\qquad \\dot{x}_{2}=\\sin(x_{1})+u,\\qquad y=x_{1}.\n$$\n从非线性控制中使用的基本原理和核心定义出发，利用李导数的概念来确定该系统相对于输出 $y$ 的相对阶 $r$，并利用该结果判断在所有相对阶有良好定义的点附近，静态输入-输出线性化是否可行。你的推导过程应从标量场沿向量场的李导数定义以及SISO系统的相对阶定义开始，并逐步进行，不使用任何未经证明的简化公式。\n\n答案规格：\n- 将最终答案表示为一个 $1\\times 2$ 的行矩阵 $\\begin{pmatrix}r  I\\end{pmatrix}$，其中 $r$ 是相对阶，$I$ 是静态输入-输出线性化的可行性指标，若可行（对于所有相对阶有良好定义的状态），则 $I=1$，否则 $I=0$。\n- 不包含任何单位。\n- 无需四舍五入。", "solution": "所给问题是非线性控制理论中的一个标准练习。该问题是良定义的，具有科学依据，并包含唯一解所需的所有信息。我们将开始进行分析。\n\n该系统由以下状态方程给出：\n$$\n\\dot{x}_{1} = x_{2}\n$$\n$$\n\\dot{x}_{2} = \\sin(x_{1}) + u\n$$\n其状态向量为 $x = \\begin{pmatrix} x_{1}  x_{2} \\end{pmatrix}^{\\top}$，输出为 $y = x_{1}$。该系统可以写成标准仿射形式 $\\dot{x} = f(x) + g(x)u$，输出方程为 $y = h(x)$，其中：\n$$\nf(x) = \\begin{pmatrix} x_{2} \\\\ \\sin(x_{1}) \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_{1}\n$$\n问题要求我们使用李导数确定相对阶 $r$，然后评估静态输入-输出线性化的可能性。\n\n按照指示，我们从基本原理开始。标量场 $h(x)$ 沿向量场 $f(x)$ 的李导数定义为 $h(x)$ 在 $f(x)$ 方向上的方向导数：\n$$\nL_f h(x) = \\frac{\\partial h}{\\partial x} f(x) = \\sum_{i=1}^{n} \\frac{\\partial h}{\\partial x_i} f_i(x)\n$$\n其中 $n$ 是状态空间的维度，本例中为 $2$。\n\n单输入单输出（SISO）系统在点 $x_0$ 处的相对阶 $r$ 定义为满足以下条件的最小整数 $r \\ge 1$：\n1. 对于 $x_0$ 邻域内的所有 $x$ 以及所有整数 $k  r-1$，$L_g L_f^k h(x) = 0$。\n2. $L_g L_f^{r-1} h(x_0) \\neq 0$。\n此处，$L_f^k h$ 表示 $k$ 阶迭代李导数，其中 $L_f^0 h = h$ 且 $L_f^k h = L_f(L_f^{k-1} h)$。\n\n为求相对阶，我们将输出 $y$ 对时间求导，直到输入 $u$ 显式出现。所需求导的次数即为相对阶。\n\n输出 $y$ 的一阶时间导数为：\n$$\n\\dot{y} = \\frac{d}{dt}h(x) = \\frac{\\partial h}{\\partial x} \\dot{x} = \\frac{\\partial h}{\\partial x} (f(x) + g(x)u) = L_f h(x) + L_g h(x) u\n$$\n我们必须计算 $L_g h(x)$ 和 $L_f h(x)$ 这两项。$h(x) = x_1$ 的梯度为：\n$$\n\\frac{\\partial h}{\\partial x} = \\begin{pmatrix} \\frac{\\partial x_1}{\\partial x_1}  \\frac{\\partial x_1}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n现在我们计算 $L_g h(x)$：\n$$\nL_g h(x) = \\frac{\\partial h}{\\partial x} g(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = (1)(0) + (0)(1) = 0\n$$\n由于 $L_g h(x) = L_g L_f^0 h(x) = 0$，相对阶必有 $r > 1$。$\\dot{y}$ 的表达式简化为 $\\dot{y} = L_f h(x)$。我们计算这一项：\n$$\nL_f h(x) = \\frac{\\partial h}{\\partial x} f(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} x_{2} \\\\ \\sin(x_{1}) \\end{pmatrix} = (1)(x_{2}) + (0)(\\sin(x_{1})) = x_{2}\n$$\n所以，我们有 $\\dot{y} = x_2$。输入 $u$ 未出现，这证实了 $r > 1$。\n\n我们继续求输出的二阶时间导数：\n$$\n\\ddot{y} = \\frac{d}{dt} \\dot{y} = \\frac{d}{dt} (L_f h(x)) = \\frac{\\partial (L_f h(x))}{\\partial x} \\dot{x} = \\frac{\\partial (L_f h(x))}{\\partial x} (f(x) + g(x)u)\n$$\n该表达式可以用李导数写为：\n$$\n\\ddot{y} = L_f(L_f h(x)) + L_g(L_f h(x)) u = L_f^2 h(x) + L_g L_f^1 h(x) u\n$$\n我们需要检查 $u$ 的系数，即 $L_g L_f h(x)$，是否非零。设 $\\psi(x) = L_f h(x) = x_2$。$\\psi(x)$ 的梯度为：\n$$\n\\frac{\\partial \\psi}{\\partial x} = \\begin{pmatrix} \\frac{\\partial x_2}{\\partial x_1}  \\frac{\\partial x_2}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix}\n$$\n现在，我们计算 $L_g L_f h(x)$：\n$$\nL_g L_f h(x) = L_g \\psi(x) = \\frac{\\partial \\psi}{\\partial x} g(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = (0)(0) + (1)(1) = 1\n$$\n由于 $L_g L_f^{2-1} h(x) = 1$ 对所有状态 $x \\in \\mathbb{R}^2$ 均不为零，我们根据定义得出结论，系统的相对阶为 $r=2$。\n\n接下来，我们判断静态输入-输出线性化是否可行。该过程旨在寻找一个静态状态反馈控制律 $u = \\alpha(x) + \\beta(x)v$，其中 $v$ 是一个新的外部输入，使得输入-输出映射是线性的。输入-输出动态由 $y$ 的 $r$ 阶导数给出：\n$$\ny^{(r)} = L_f^r h(x) + L_g L_f^{r-1} h(x) u\n$$\n对于我们的系统，其中 $r=2$，该方程为：\n$$\n\\ddot{y} = L_f^2 h(x) + L_g L_f h(x) u\n$$\n我们已经求得 $L_g L_f h(x) = 1$。现在计算 $L_f^2 h(x)$：\n$$\nL_f^2 h(x) = L_f(\\psi(x)) = \\frac{\\partial \\psi}{\\partial x} f(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} x_{2} \\\\ \\sin(x_{1}) \\end{pmatrix} = (0)(x_{2}) + (1)(\\sin(x_{1})) = \\sin(x_{1})\n$$\n将这些结果代入 $\\ddot{y}$ 的方程中，得到：\n$$\n\\ddot{y} = \\sin(x_{1}) + (1)u\n$$\n为实现线性输入-输出响应，例如 $\\ddot{y} = v$，我们设置：\n$$\nv = \\sin(x_{1}) + u\n$$\n解出控制输入 $u$，得到静态状态反馈律：\n$$\nu = v - \\sin(x_{1})\n$$\n该控制律使系统表现为 $\\ddot{y} = v$，这是新输入 $v$ 与输出 $y$ 之间的线性关系。\n\n静态输入-输出线性化的可行性取决于该反馈律是否为良定义的。该控制律的一般形式为 $u = \\frac{1}{L_g L_f^{r-1} h(x)}(v - L_f^r h(x))$。该控制律在所有相对阶 $r$ 有良好定义的状态 $x$ 处都是良定义的，即在 $L_g L_f^{r-1} h(x) \\neq 0$ 的地方。\n在我们的例子中，$r=2$，关键项是 $L_g L_f h(x) = 1$。由于该项是一个非零常数，它对所有状态 $x \\in \\mathbb{R}^2$ 都不为零。这意味着相对阶 $r=2$ 在整个状态空间上都是良定义的。因此，反馈律 $u = v - \\sin(x_{1})$ 对所有 $x \\in \\mathbb{R}^2$ 都是良定义的。\n因此，静态输入-输出线性化对所有状态都是可行的。这对应于指标值 $I=1$。\n\n综合我们的发现，相对阶为 $r=2$，线性化可行性指标为 $I=1$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2  1 \\end{pmatrix}}\n$$", "id": "2700623"}, {"introduction": "在确认了系统的反馈线性化潜力后，下一步是设计一个能利用该特性的控制器。本练习从单输入系统扩展到多输入系统，要求你不仅要验证系统的平坦性，还要显式地构建状态反馈控制律和坐标变换 [@problem_id:2700596]。通过这个实践，你将学会如何将一个耦合的非线性系统转化为一组解耦的积分器链（即 Brunovský 范式），从而极大地简化控制设计。", "problem": "考虑一个输入仿射、线性时不变 (LTI) 系统，其状态为 $x=\\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$，输入为 $u=\\begin{pmatrix}u_{1}  u_{2}\\end{pmatrix}^{\\top}$，由下式给出\n$$\n\\dot{x}_{1}=x_{2}+u_{1},\\qquad \\dot{x}_{2}=u_{2}.\n$$\n设测量输出为 $y=\\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$。从第一性原理出发，使用相对阶、解耦矩阵和反馈线性化的定义来：\n- 判断 $y$ 在微分平坦意义下是否为平坦输出，\n- 构建形式为 $u=\\alpha(x)+\\beta(x)\\,v$ 的静态状态反馈和一个光滑微分同胚 $z=\\phi(x)$，将系统转换成由独立积分器链组成的 Brunovský 范式，以及\n- 将状态和输入表示为平坦输出及其有限阶时间导数的代数函数。\n\n答案规格：将您的最终答案报告为按顺序包含以下元素的单行矩阵：\n$$\n\\big[z_{1},\\,z_{2},\\,u_{1},\\,u_{2},\\,y_{f,1},\\,y_{f,2}\\big],\n$$\n该矩阵纯粹用 $x$、$v=\\begin{pmatrix}v_{1}  v_{2}\\end{pmatrix}^{\\top}$ 和常数表示。无需进行数值取整，也不涉及物理单位。若有角度，则必须以弧度为单位，但本题不涉及角度。", "solution": "对题目陈述进行验证。\n\n步骤1：提取已知条件。\n- 系统动力学：$\\dot{x}_{1}=x_{2}+u_{1}$，$\\dot{x}_{2}=u_{2}$。\n- 状态向量：$x=\\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$。\n- 输入向量：$u=\\begin{pmatrix}u_{1}  u_{2}\\end{pmatrix}^{\\top}$。\n- 测量输出：$y=\\begin{pmatrix}y_{1}  y_{2}\\end{pmatrix}^{\\top}=\\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$。\n- 反馈律形式：$u=\\alpha(x)+\\beta(x)\\,v$。\n- 微分同胚形式：$z=\\phi(x)$。\n- 目标表示：Brunovský 范式。\n- 任务1：判断 $y$ 是否为平坦输出。\n- 任务2：构建反馈律和微分同胚。\n- 任务3：将状态和输入表示为平坦输出及其导数的函数。\n- 最终答案格式：一个单行矩阵 $[z_{1},\\,z_{2},\\,u_{1},\\,u_{2},\\,y_{f,1},\\,y_{f,2}]$，作为 $x$ 和 $v=\\begin{pmatrix}v_{1}  v_{2}\\end{pmatrix}^{\\top}$ 的函数。\n\n步骤2：使用提取的已知条件进行验证。\n- **科学性：** 该问题是非线性控制理论中的一个标准练习，专门处理输入仿射系统的反馈线性化和微分平坦问题。该系统本身是一个简单的线性时不变 (LTI) 系统。所有概念在该领域都是公认的。\n- **适定性：** 该问题是适定的。系统已完全定义，目标是明确的数学任务。状态数 ($n=2$)、输入数 ($m=2$) 和输出数 ($m=2$) 对于探究反馈线性化和平坦性是一致的。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **不完整或矛盾的设置：** 问题是自洽的，没有矛盾。要求将状态和输入用平坦输出及其导数表示是确认平坦性的标准程序，而最终答案格式要求变换和控制律的分量，这是一个一致的要求。\n- **其他缺陷：** 该问题没有指定列表中的其他缺陷（不切实际、不适定、微不足道等）。它是基本原理的直接应用。\n\n步骤3：结论和行动。\n问题有效。将提供解答。\n\n系统由以下状态空间方程给出：\n$$ \\begin{cases} \\dot{x}_{1} = x_{2}+u_{1} \\\\ \\dot{x}_{2} = u_{2} \\end{cases} $$\n这可以写成输入仿射形式 $\\dot{x} = f(x) + g(x)u$，其中：\n$$ f(x) = \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} g_{1}(x)  g_{2}(x) \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n输出为 $y = h(x) = \\begin{pmatrix} h_{1}(x) \\\\ h_{2}(x) \\end{pmatrix} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$。\n\n为了判断系统是否是反馈可线性化的以及 $y$ 是否为平坦输出，我们必须计算每个输出分量的相对阶。相对阶 $r_{i}$ 是使得输出 $y_{i}$ 的 $r_{i}$ 阶时间导数显式地依赖于输入 $u$ 的最小整数。这等价于找到最小的整数 $r_{i}$，使得对于至少一个 $j \\in \\{1, 2\\}$，有 $L_{g_j} L_f^{r_i-1} h_i(x) \\neq 0$ 成立，其中 $L$ 表示李导数。\n\n对于第一个输出，$y_{1} = h_{1}(x) = x_{1}$：\n我们计算其一阶时间导数：\n$$ \\dot{y}_{1} = \\frac{\\partial h_{1}}{\\partial x} \\dot{x} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} x_{2}+u_{1} \\\\ u_{2} \\end{pmatrix} = x_{2} + u_{1} $$\n输入 $u_{1}$ 出现在一阶导数中。因此，第一个输出的相对阶为 $r_{1} = 1$。\n使用李导数：\n$L_{f}h_{1}(x) = \\frac{\\partial h_{1}}{\\partial x}f(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix} = x_{2}$。\n$L_{g_{1}}h_{1}(x) = \\frac{\\partial h_{1}}{\\partial x}g_{1}(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$。\n$L_{g_{2}}h_{1}(x) = \\frac{\\partial h_{1}}{\\partial x}g_{2}(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0$。\n由于 $L_{g_{1}}h_{1}(x) \\neq 0$，相对阶为 $r_{1}=1$。\n\n对于第二个输出，$y_{2} = h_{2}(x) = x_{2}$：\n我们计算其一阶时间导数：\n$$ \\dot{y}_{2} = \\frac{\\partial h_{2}}{\\partial x} \\dot{x} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} x_{2}+u_{1} \\\\ u_{2} \\end{pmatrix} = u_{2} $$\n输入 $u_{2}$ 出现在一阶导数中。因此，第二个输出的相对阶为 $r_{2} = 1$。\n使用李导数：\n$L_{f}h_{2}(x) = \\frac{\\partial h_{2}}{\\partial x}f(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix} = 0$。\n$L_{g_{1}}h_{2}(x) = \\frac{\\partial h_{2}}{\\partial x}g_{1}(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 0$。\n$L_{g_{2}}h_{2}(x) = \\frac{\\partial h_{2}}{\\partial x}g_{2}(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 1$。\n由于 $L_{g_{2}}h_{2}(x) \\neq 0$，相对阶为 $r_{2}=1$。\n\n相对阶之和为 $r_{1} + r_{2} = 1 + 1 = 2$。这个和等于状态空间的维数 $n=2$。这是一个输入仿射系统可反馈线性化的充要条件。这也意味着输出向量 $y = \\begin{pmatrix}x_{1}  x_{2}\\end{pmatrix}^{\\top}$ 是该系统的一个平坦输出。\n\n接下来，我们构建反馈线性化控制律 $u = \\alpha(x) + \\beta(x)v$。我们定义一个新的输入 $v = \\begin{pmatrix}v_{1}  v_{2}\\end{pmatrix}^{\\top}$，使得动力学系统变为线性和解耦的。标准的选择是令 $y_{i}^{(r_{i})} = v_{i}$。\n对于我们的系统，这意味着 $\\dot{y}_{1}=v_{1}$ 和 $\\dot{y}_{2}=v_{2}$。\n我们从输出的导数得到以下方程组：\n$$ \\begin{pmatrix} \\dot{y}_{1} \\\\ \\dot{y}_{2} \\end{pmatrix} = \\begin{pmatrix} L_{f}h_{1}(x) \\\\ L_{f}h_{2}(x) \\end{pmatrix} + \\begin{pmatrix} L_{g_{1}}h_{1}(x)  L_{g_{2}}h_{1}(x) \\\\ L_{g_{1}}h_{2}(x)  L_{g_{2}}h_{2}(x) \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} $$\n乘以输入 $u$ 的矩阵是解耦矩阵 $B(x)$：\n$$ B(x) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n由于 $B(x)$ 是单位矩阵，它对所有 $x$ 都是非奇异的，这进一步证实了系统是反馈可线性化的。\n漂移项向量为 $A(x) = \\begin{pmatrix} L_{f}h_{1}(x) \\\\ L_{f}h_{2}(x) \\end{pmatrix} = \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix}$。\n我们令 $\\begin{pmatrix} \\dot{y}_{1} \\\\ \\dot{y}_{2} \\end{pmatrix} = v$，因此有 $v = A(x) + B(x)u$。\n$$ \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} = \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix} = \\begin{pmatrix} x_{2} + u_{1} \\\\ u_{2} \\end{pmatrix} $$\n解出 $u$，我们得到静态状态反馈律：\n$$ u = B(x)^{-1}(v - A(x)) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{-1} \\left( \\begin{pmatrix} v_{1} \\\\ v_{2} \\end{pmatrix} - \\begin{pmatrix} x_{2} \\\\ 0 \\end{pmatrix} \\right) = \\begin{pmatrix} v_{1} - x_{2} \\\\ v_{2} \\end{pmatrix} $$\n因此，$u_{1} = v_{1} - x_{2}$ 且 $u_{2} = v_{2}$。\n\n微分同胚 $z = \\phi(x)$ 将状态坐标变换为 Brunovský 范式坐标。对于一个相对阶为 $(r_{1}, ..., r_{m})$ 的系统，新的坐标由输出及其最高到 $r_{i}-1$ 阶的逐次时间导数定义。\n由于 $r_{1}=1$ 且 $r_{2}=1$，变换就是：\n$$ z_{1} = \\phi_{1}(x) = h_{1}(x) = x_{1} $$\n$$ z_{2} = \\phi_{2}(x) = h_{2}(x) = x_{2} $$\n所以微分同胚为 $z = \\phi(x) = x$。\n通过这个变换和反馈，系统变为：\n$$ \\dot{z}_{1} = \\dot{x}_{1} = x_{2} + u_{1} = x_{2} + (v_{1} - x_{2}) = v_{1} $$\n$$ \\dot{z}_{2} = \\dot{x}_{2} = u_{2} = v_{2} $$\n这就是由两个独立的积分器链组成的 Brunovský 范式，符合要求。\n\n最后，我们将原始状态和输入表示为平坦输出 $y_{f} = y$ 及其时间导数的函数。设平坦输出的分量为 $y_{f,1}$ 和 $y_{f,2}$。\n$$ y_{f,1} = x_{1}, \\quad y_{f,2} = x_{2} $$\n状态可以很直接地表示：\n$$ x_{1} = y_{f,1}, \\quad x_{2} = y_{f,2} $$\n输入可以从原始动力学方程中找到：\n$$ u_{1} = \\dot{x}_{1} - x_{2} = \\dot{y}_{f,1} - y_{f,2} $$\n$$ u_{2} = \\dot{x}_{2} = \\dot{y}_{f,2} $$\n由于所有状态和输入都可以用 $y$ 的分量及其有限阶时间导数进行代数表示，因此 $y$ 被确认为平坦输出。\n\n最终答案要求行矩阵 $[z_{1},\\,z_{2},\\,u_{1},\\,u_{2},\\,y_{f,1},\\,y_{f,2}]$ 用 $x$ 和 $v$ 表示。\n- $z_{1} = x_{1}$\n- $z_{2} = x_{2}$\n- $u_{1} = v_{1} - x_{2}$\n- $u_{2} = v_{2}$\n- $y_{f,1} = x_{1}$ (平坦输出的第一个分量)\n- $y_{f,2} = x_{2}$ (平坦输出的第二个分量)\n得到的行矩阵为 $[x_{1}, x_{2}, v_{1} - x_{2}, v_{2}, x_{1}, x_{2}]$。", "answer": "$$ \\boxed{ \\begin{pmatrix} x_{1}  x_{2}  v_{1} - x_{2}  v_{2}  x_{1}  x_{2} \\end{pmatrix} } $$", "id": "2700596"}, {"introduction": "差分平坦性的真正威力体现在其对轨迹规划的简化上，这是其在机器人学和航空航天领域广泛应用的核心原因。本练习将展示如何通过为一个标量平坦输出规划一条简单的多项式路径，来生成一个满足特定起始和终止约束的复杂高维状态空间轨迹 [@problem_id:2700537]。这个过程将复杂的动力学约束问题转化为一个简单的代数插值问题，凸显了平坦性在运动规划中的巨大价值。", "problem": "考虑一个单输入单输出系统，已知其为微分平坦系统，其标量平坦输出为 $z(t)$。在微分平坦系统的轨迹生成中，通常会对平坦输出及其时间导数指定端点约束，然后拟合一个满足这些约束的最小阶多项式。令 $r=4$，因此约束施加在 $z$ 及其前三阶导数上。给定边界数据\n$$\nz^{(k)}(0)=z_{0}^{(k)},\\quad z^{(k)}(T)=z_{T}^{(k)},\\quad k=0,1,2,3,\n$$\n其中 $T0$。仅使用导数的定义以及一个 $n$ 阶多项式有 $n+1$ 个自由系数这一事实，解决以下问题：\n\n1. 从第一性原理出发，论证为何能够满足所有 8 个约束的最小阶多项式的阶数必须为 7。\n\n2. 构造一个 7 阶多项式轨迹 $z(t)$，\n$$\nz(t)=a_{0}+a_{1}t+a_{2}t^{2}+a_{3}t^{3}+a_{4}t^{4}+a_{5}t^{5}+a_{6}t^{6}+a_{7}t^{7},\n$$\n使其满足特定的边界条件\n$$\nz_{0}^{(0)}=0,\\quad z_{0}^{(1)}=0,\\quad z_{0}^{(2)}=0,\\quad z_{0}^{(3)}=0,\\qquad z_{T}^{(0)}=1,\\quad z_{T}^{(1)}=0,\\quad z_{T}^{(2)}=0,\\quad z_{T}^{(3)}=0.\n$$\n将系数 $\\{a_{i}\\}_{i=0}^{7}$ 显式地计算为 $T$ 的函数。\n\n答案规格：将你的最终答案表示为 $1\\times 8$ 的系数行向量 $(a_{0},a_{1},a_{2},a_{3},a_{4},a_{5},a_{6},a_{7})$。无需进行数值舍入。答案中请勿包含单位。", "solution": "该问题是有效的，因为它具有科学依据、是适定且客观的。它提出了一个控制理论和应用数学中标准的、可解的问题，没有内部矛盾或信息缺失。\n\n第1部分：确定最小多项式阶数。\n\n一个 $n$ 阶多项式由 $n+1$ 个独立系数确定。设该多项式为 $z(t) = \\sum_{i=0}^{n} a_i t^i$。系数 $\\{ a_i \\}_{i=0}^n$ 构成了可用于满足一组约束的 $n+1$ 个自由度。\n\n问题陈述规定了 8 个边界约束。这些约束是关于函数及其前三阶导数在两个不同时间点 $t=0$ 和 $t=T$ 的值。具体来说，对于 $k \\in \\{0, 1, 2, 3\\}$，我们在 $t=0$ 处有 4 个约束：\n$$z^{(k)}(0) = z_0^{(k)}$$\n以及在 $t=T$ 处有 4 个约束：\n$$z^{(k)}(T) = z_T^{(k)}$$\n这总共是对多项式系数的 $4+4=8$ 个线性约束。\n\n为了满足 8 个独立的线性约束，必须至少有 8 个自由参数。因此，系数的数量 $n+1$ 必须至少为 8。\n$$n+1 \\ge 8 \\implies n \\ge 7$$\n满足此条件的最小整数阶数 $n$ 是 $n=7$。一个 7 阶多项式恰好提供了 8 个系数（$a_0, \\dots, a_7$），这正是满足给定的 8 个约束所需的精确数量。这会导出一个包含 8 个未知数的 8 个线性方程组，如果约束矩阵非奇异，则该方程组有唯一解。一个 6 阶或更低阶的多项式将有 7 个或更少的系数，不足以满足 8 个任意的边界条件。因此，最小阶数为 7。\n\n第2部分：构造多项式轨迹。\n\n我们寻找一个 7 阶多项式：\n$$z(t) = a_0 + a_1 t + a_2 t^2 + a_3 t^3 + a_4 t^4 + a_5 t^5 + a_6 t^6 + a_7 t^7$$\n其直到三阶的导数是：\n$$z^{(1)}(t) = a_1 + 2 a_2 t + 3 a_3 t^2 + 4 a_4 t^3 + 5 a_5 t^4 + 6 a_6 t^5 + 7 a_7 t^6$$\n$$z^{(2)}(t) = 2 a_2 + 6 a_3 t + 12 a_4 t^2 + 20 a_5 t^3 + 30 a_6 t^4 + 42 a_7 t^5$$\n$$z^{(3)}(t) = 6 a_3 + 24 a_4 t + 60 a_5 t^2 + 120 a_6 t^3 + 210 a_7 t^4$$\n\n指定的边界条件是：\n$z^{(k)}(0) = 0$ 对于 $k=0, 1, 2, 3$。\n$z^{(0)}(T) = 1$ 且 $z^{(k)}(T) = 0$ 对于 $k=1, 2, 3$。\n\n首先，我们应用在 $t=0$ 处的约束：\n$z^{(0)}(0) = a_0 = 0$\n$z^{(1)}(0) = a_1 = 0$\n$z^{(2)}(0) = 2 a_2 = 0 \\implies a_2 = 0$\n$z^{(3)}(0) = 6 a_3 = 0 \\implies a_3 = 0$\n这四个条件立即确定了前四个系数为零。因此，多项式简化为：\n$$z(t) = a_4 t^4 + a_5 t^5 + a_6 t^6 + a_7 t^7$$\n\n接下来，我们应用在 $t=T$（其中 $T>0$）处的约束。\n简化后的多项式及其导数是：\n$z(t) = a_4 t^4 + a_5 t^5 + a_6 t^6 + a_7 t^7$\n$z^{(1)}(t) = 4 a_4 t^3 + 5 a_5 t^4 + 6 a_6 t^5 + 7 a_7 t^6$\n$z^{(2)}(t) = 12 a_4 t^2 + 20 a_5 t^3 + 30 a_6 t^4 + 42 a_7 t^5$\n$z^{(3)}(t) = 24 a_4 t + 60 a_5 t^2 + 120 a_6 t^3 + 210 a_7 t^4$\n\n将这些在 $t=T$ 处求值，得到以下关于剩余四个系数 $a_4, a_5, a_6, a_7$ 的四个线性方程组：\n1. $z(T) = a_4 T^4 + a_5 T^5 + a_6 T^6 + a_7 T^7 = 1$\n2. $z^{(1)}(T) = 4 a_4 T^3 + 5 a_5 T^4 + 6 a_6 T^5 + 7 a_7 T^6 = 0$\n3. $z^{(2)}(T) = 12 a_4 T^2 + 20 a_5 T^3 + 30 a_6 T^4 + 42 a_7 T^5 = 0$\n4. $z^{(3)}(T) = 24 a_4 T + 60 a_5 T^2 + 120 a_6 T^3 + 210 a_7 T^4 = 0$\n\n我们可以将此系统写成矩阵形式。设未知数向量为 $\\mathbf{a} = \\begin{pmatrix} a_4  a_5  a_6  a_7 \\end{pmatrix}^T$。\n$$\n\\begin{pmatrix}\nT^4  T^5  T^6  T^7 \\\\\n4T^3  5T^4  6T^5  7T^6 \\\\\n12T^2  20T^3  30T^4  42T^5 \\\\\n24T  60T^2  120T^3  210T^4\n\\end{pmatrix}\n\\begin{pmatrix}\na_4 \\\\ a_5 \\\\ a_6 \\\\ a_7\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\n为了求解这个系统，我们引入新变量 $b_i$ 以简化代数运算：\n$b_4 = a_4 T^4$, $b_5 = a_5 T^5$, $b_6 = a_6 T^6$, $b_7 = a_7 T^7$。\n系统变为：\n1. $b_4 + b_5 + b_6 + b_7 = 1$\n2. $4 b_4 + 5 b_5 + 6 b_6 + 7 b_7 = 0$\n3. $12 b_4 + 20 b_5 + 30 b_6 + 42 b_7 = 0$\n4. $24 b_4 + 60 b_5 + 120 b_6 + 210 b_7 = 0$\n\n从(1)式，我们得到 $b_4 = 1 - b_5 - b_6 - b_7$。将其代入其他三个方程，得到：\n2'. $4(1-b_5-b_6-b_7) + 5b_5 + 6b_6 + 7b_7 = 0 \\implies 4+b_5+2b_6+3b_7 = 0$\n3'. $12(1-b_5-b_6-b_7) + 20b_5 + 30b_6 + 42b_7 = 0 \\implies 12+8b_5+18b_6+30b_7=0 \\implies 6+4b_5+9b_6+15b_7=0$\n4'. $24(1-b_5-b_6-b_7) + 60b_5 + 120b_6 + 210b_7 = 0 \\implies 24+36b_5+96b_6+186b_7=0 \\implies 4+6b_5+16b_6+31b_7=0$\n\n我们现在得到一个关于 $b_5, b_6, b_7$ 的 $3 \\times 3$ 方程组：\nA. $b_5 + 2b_6 + 3b_7 = -4$\nB. $4b_5 + 9b_6 + 15b_7 = -6$\nC. $6b_5 + 16b_6 + 31b_7 = -4$\n\n从(A)式，我们得到 $b_5 = -4 - 2b_6 - 3b_7$。代入(B)和(C)式：\nB'. $4(-4-2b_6-3b_7) + 9b_6 + 15b_7 = -6 \\implies -16-8b_6-12b_7+9b_6+15b_7=-6 \\implies b_6+3b_7 = 10$\nC'. $6(-4-2b_6-3b_7) + 16b_6 + 31b_7 = -4 \\implies -24-12b_6-18b_7+16b_6+31b_7=-4 \\implies 4b_6+13b_7 = 20$\n\n从(B')式，我们得到 $b_6=10-3b_7$。代入(C')式：\n$4(10-3b_7)+13b_7 = 20 \\implies 40-12b_7+13b_7=20 \\implies b_7 = -20$。\n\n回代，我们得到：\n$b_6 = 10 - 3(-20) = 10 + 60 = 70$。\n$b_5 = -4 - 2(70) - 3(-20) = -4 - 140 + 60 = -84$。\n$b_4 = 1 - b_5 - b_6 - b_7 = 1 - (-84) - (70) - (-20) = 1 + 84 - 70 + 20 = 35$。\n\n最后，我们使用 $a_i$ 的定义来求解原始系数：\n$a_4 = \\frac{b_4}{T^4} = \\frac{35}{T^4}$\n$a_5 = \\frac{b_5}{T^5} = -\\frac{84}{T^5}$\n$a_6 = \\frac{b_6}{T^6} = \\frac{70}{T^6}$\n$a_7 = \\frac{b_7}{T^7} = -\\frac{20}{T^7}$\n\n多项式 $z(t)$ 的完整系数集为：\n$a_0=0$, $a_1=0$, $a_2=0$, $a_3=0$, $a_4 = \\frac{35}{T^4}$, $a_5 = -\\frac{84}{T^5}$, $a_6 = \\frac{70}{T^6}$, $a_7 = -\\frac{20}{T^7}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0  0  \\frac{35}{T^4}  -\\frac{84}{T^5}  \\frac{70}{T^6}  -\\frac{20}{T^7} \\end{pmatrix}}\n$$", "id": "2700537"}]}