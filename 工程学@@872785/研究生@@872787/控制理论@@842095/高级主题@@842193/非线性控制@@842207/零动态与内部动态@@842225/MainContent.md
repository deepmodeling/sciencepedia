## 引言
在[非线性](@entry_id:637147)控制理论的宏伟蓝图中，[零动态](@entry_id:177017)（zero dynamics）与内动态（internal dynamics）是揭示系统内在行为的两个基石性概念。对于任何旨在超越简单线性近似、实现高性能控制的系统而言，理解输入如何影响输出仅仅是第一步。更深层次的挑战在于，当系统的部分行为（即输出）被精确控制或约束时，其内部那些“不可见”的状态会如何演化？这一问题正是本系列文章所要解决的核心知识缺口，它直接关系到控制策略的成败与系统稳定性的根本保障。

本文将通过三个层层递进的章节，带领读者系统性地掌握[零动态](@entry_id:177017)与内动态的理论与实践。在第一章“原理与机制”中，我们将建立严格的数学框架，从[相对阶](@entry_id:171358)的概念出发，详细推导[零动态](@entry_id:177017)和内动态的定义，并借助Byrnes-Isidori正规形揭示二者之间的深刻联系。接下来的第二章“应用与[交叉](@entry_id:147634)学科联系”将理论付诸实践，展示这些概念如何在机器人学、[过程控制](@entry_id:271184)和生物系统等前沿领域中解释复杂的物理现象，并阐明它们如何决定了系统不可逾越的性能极限。最后，在第三章“动手实践”中，您将通过一系列精心设计的计算练习，将抽象的理论转化为具体的分析与设计能力。

## 原理与机制

在上一章引言之后，本章将深入探讨控制仿射非线性系统的核心结构特性：[零动态](@entry_id:177017)（zero dynamics）与内动态（internal dynamics）。理解这些概念对于设计先进的控制器，尤其是那些旨在实现精确输出跟踪的控制器，至关重要。我们将从基本原理出发，通过严格的数学定义和具体的计算实例，揭示这些“隐藏”动态的性质及其在系统行为中的决定性作用。

### 非线性系统中的输入-输出关系：[相对阶](@entry_id:171358)

对于一个线性时不变（LTI）系统，输入与输出之间的动态关系可以通过[传递函数](@entry_id:273897)直观地理解。然而，在[非线性](@entry_id:637147)领域，这种关系变得更加复杂。考虑一个单输入单输出（SISO）[控制仿射系统](@entry_id:168741)：
$$
\dot{x} = f(x) + g(x)u, \quad y = h(x)
$$
其中 $x \in \mathbb{R}^n$ 是状态， $u \in \mathbb{R}$ 是输入， $y \in \mathbb{R}$ 是输出。一个基本问题是：输入 $u$ 何时以及如何影响输出 $y$？为了回答这个问题，我们对输出 $y$ 进行时间求导。利用[链式法则](@entry_id:190743)和[李导数](@entry_id:171745)（Lie derivative）的记法，$L_f h(x) = \frac{\partial h}{\partial x}f(x)$，我们得到：
$$
\dot{y} = \frac{d}{dt}h(x(t)) = \frac{\partial h}{\partial x}\dot{x} = \frac{\partial h}{\partial x}(f(x) + g(x)u) = L_f h(x) + L_g h(x) u
$$

如果 $L_g h(x)$ 在我们关心的点 $x_0$ 附近不为零，那么输入 $u$ 直接出现在[一阶导数](@entry_id:749425)中。然而，如果 $L_g h(x)$ 在该点附近恒等于零，我们就必须继续求导：
$$
\ddot{y} = \frac{d}{dt}(L_f h(x)) = L_f(L_f h(x)) + L_g(L_f h(x)) u = L_f^2 h(x) + L_g L_f h(x) u
$$

这个过程引出了**[相对阶](@entry_id:171358)（relative degree）**的概念。对于一个SISO系统，在点 $x_0$ 的[相对阶](@entry_id:171358) $r$ 被定义为使得输入 $u$ 首次显式出现在输出的 $r$ 阶时间导数中的最小正整数。形式上，这意味着 [@problem_id:2758190]：
1.  在 $x_0$ 的一个邻域内，对于所有整数 $k$ 满足 $0 \le k \le r-2$，都有 $L_g L_f^k h(x) = 0$。
2.  $L_g L_f^{r-1} h(x_0) \neq 0$。

当[相对阶](@entry_id:171358)为 $r$ 时，输出的前 $r-1$ 阶导数均与输入无关，而第 $r$ 阶导数则具有如下形式：
$$
y^{(r)} = L_f^r h(x) + L_g L_f^{r-1} h(x) u
$$
这个方程是输入-输出[反馈线性化](@entry_id:163432)的基础。其中，乘以输入 $u$ 的标量函数 $a(x) = L_g L_f^{r-1} h(x)$ 通常被称为[解耦](@entry_id:637294)项。[相对阶](@entry_id:171358)定义中的第二个条件 $a(x_0) \neq 0$ 保证了在点 $x_0$ 附近，我们可以通过选择 $u$ 来任意指定 $y^{(r)}$ 的值。

这个概念可以推广到多输入多输出（MIMO）系统，其中 $u \in \mathbb{R}^p, y \in \mathbb{R}^p$ [@problem_id:2758153]。对于每个输出分量 $y_i = h_i(x)$，我们都可以定义一个[相对阶](@entry_id:171358) $r_i$。这是使得至少有一个输入分量 $u_j$ 出现在 $y_i$ 的 $r_i$ 阶导数中的最小整数。此时，输入-输出关系可以用矩阵形式表示：
$$
\begin{pmatrix} y_1^{(r_1)} \\ \vdots \\ y_p^{(r_p)} \end{pmatrix} = \begin{pmatrix} L_f^{r_1} h_1(x) \\ \vdots \\ L_f^{r_p} h_p(x) \end{pmatrix} + A(x) \begin{pmatrix} u_1 \\ \vdots \\ u_p \end{pmatrix}
$$
其中 $p \times p$ 的**[解耦](@entry_id:637294)矩阵（decoupling matrix）** $A(x)$ 的元素为 $A_{ij}(x) = L_{g_j} L_f^{r_i-1} h_i(x)$。要实现对所有输出的独立控制，解耦矩阵 $A(x)$ 必须是非奇异的，即 $\det(A(x)) \neq 0$。

### [零动态](@entry_id:177017)：当输出被约束为零时

[相对阶](@entry_id:171358)揭示了系统的输入-输出结构，但一个更深层次的问题是：当系统的输出被强制保持为零时，系统内部会发生什么？研究这种受约束的动态，即**[零动态](@entry_id:177017)（zero dynamics）**，对于理解系统的内在稳定性和控制极限至关重要。

为了使输出 $y(t)$ 对所有时间 $t \ge 0$ 恒等于零，即 $y(t) \equiv 0$，不仅 $y(t)$ 自身必须为零，它的所有时间导数也必须为零。对于一个[相对阶](@entry_id:171358)为 $r$ 的SISO系统，这意味着状态 $x$ 必须满足以下 $r$ 个约束条件 [@problem_id:2758175]：
$$
y(t) = h(x) = 0 \\
\dot{y}(t) = L_f h(x) = 0 \\
\vdots \\
y^{(r-1)}(t) = L_f^{r-1} h(x) = 0
$$
这些方程共同定义了[状态空间](@entry_id:177074)中的一个 $(n-r)$ 维[流形](@entry_id:153038)，称为**[零动态](@entry_id:177017)[流形](@entry_id:153038)（zero dynamics manifold）** $\mathcal{Z}$：
$$
\mathcal{Z} := \{x \in \mathbb{R}^n \mid h(x) = 0, L_f h(x) = 0, \dots, L_f^{r-1} h(x) = 0\}
$$
为了将系统轨迹维持在 $\mathcal{Z}$ 上，我们还必须确保更高阶的导数也为零。特别地，$y^{(r)}(t)$ 必须为零。根据[相对阶](@entry_id:171358)的定义，我们有：
$$
y^{(r)} = L_f^r h(x) + L_g L_f^{r-1} h(x) u = 0
$$
由于 $L_g L_f^{r-1} h(x) \neq 0$，我们可以求解出维持零输出所必需的唯一[状态反馈控制](@entry_id:271611)律 $u^\star(x)$：
$$
u^\star(x) = -\frac{L_f^r h(x)}{L_g L_f^{r-1} h(x)}
$$
将此控制律代入原系统，我们得到在[流形](@entry_id:153038) $\mathcal{Z}$ 上受约束的系统动态，这就是[零动态](@entry_id:177017)：
$$
\dot{x} = f(x) + g(x) u^\star(x), \quad \text{for } x \in \mathcal{Z}
$$
可以验证，在反馈 $u^\star(x)$ 的作用下，[流形](@entry_id:153038) $\mathcal{Z}$ 是一个[不变集](@entry_id:275226)：如果系统的初始状态 $x(0)$ 在 $\mathcal{Z}$ 上，那么在 $u(t) = u^\star(x(t))$ 的作用下，整个轨迹 $x(t)$ 都将保留在 $\mathcal{Z}$ 内，从而保证 $y(t) \equiv 0$。[零动态](@entry_id:177017)描述了系统在输出“不可见”的情况下，其内部状态的演化行为。

### 正规形与内动态

[零动态](@entry_id:177017)提供了一个特定场景（$y \equiv 0$）下的内部行为视图。一个更广义的概念是**内动态（internal dynamics）**，它描述了对于任意输出轨迹，系统内部状态的演化规律。为了揭示内动态，我们需要引入一种特殊的坐标变换，将系统转化为所谓的**Byrnes-Isidori正规形（Byrnes-Isidori normal form）**。

假设系统在某邻域内具有良好定义的[相对阶](@entry_id:171358) $r \le n$。我们可以找到一个[局部坐标](@entry_id:181200)变换（微分同胚）$T: x \mapsto (\xi, \eta)$，其中 $\xi \in \mathbb{R}^r$ 被称为**外部状态**，$\eta \in \mathbb{R}^{n-r}$ 被称为**内部状态**。这些新坐标的定义如下 [@problem_id:2758170]：
- **外部坐标 $\xi$** 直接与输出及其导数相关联：
$$
\xi_1 = h(x) = y \\
\xi_2 = L_f h(x) = \dot{y} \\
\vdots \\
\xi_r = L_f^{r-1} h(x) = y^{(r-1)}
$$
- **内部坐标 $\eta$** 由 $n-r$ 个函数 $\eta_i = \phi_i(x)$ 构成，它们的选择需要满足两个条件：(1) 整个坐标变换是可逆的；(2) 它们对输入 $u$ 是[解耦](@entry_id:637294)的，即 $L_g \phi_i(x) = 0$。

在这个新[坐标系](@entry_id:156346)下，原系统 $(f, g, h)$ 的动态方程呈现出一种标准化的、[解耦](@entry_id:637294)的结构：
$$
\begin{cases}
\dot{\xi}_1 = \xi_2 \\
\dot{\xi}_2 = \xi_3 \\
\vdots \\
\dot{\xi}_{r-1} = \xi_r \\
\dot{\xi}_r = L_f^r h(x) + L_g L_f^{r-1} h(x) u \\
\dot{\eta} = L_f \eta(x)
\end{cases}
$$
将上式中的 $x$ 替换为 $(\xi, \eta)$ 的函数，系统可以被写为 Byrnes-Isidori 正规形：
$$
\begin{cases}
\dot{\xi} = A_c \xi + B_c (\alpha(\xi, \eta) + \beta(\xi, \eta) u) \\
\dot{\eta} = q(\xi, \eta)
\end{cases}
$$
或者更常见地写作：
$$
\dot{\xi}_1 = \xi_2, \dots, \dot{\xi}_{r-1} = \xi_r, \quad \dot{\xi}_r = \alpha(\xi, \eta) + \beta(\xi, \eta) u \\
\dot{\eta} = q(\xi, \eta)
$$
其中 $\beta(\xi, \eta) = L_g L_f^{r-1} h(x)$ 并且在所考虑的区域内非零。

[方程组](@entry_id:193238) $\dot{\eta} = q(\xi, \eta)$ 描述了内部状态 $\eta$ 的演化，它不受控制输入 $u$ 的直接影响，但会受到外部状态 $\xi$（即输出轨迹）的驱动。这组动态方程被称为系统的**内动态**。

### [零动态](@entry_id:177017)与内动态的关系

通过正规形的视角，[零动态](@entry_id:177017)和内动态之间的关系变得清晰明了 [@problem_id:2758223]。
- **内动态** $\dot{\eta} = q(\xi, \eta)$ 是一个广义的概念，它描述了对于任意输出轨迹（由 $\xi(t)$ 体现），内部状态如何演化。
- **[零动态](@entry_id:177017)** 则是内动态在一种特定约束下的表现。当我们强制输出 $y(t) \equiv 0$ 时，根据 $\xi$ 的定义，这意味着外部[状态向量](@entry_id:154607) $\xi(t)$ 必须恒等于[零向量](@entry_id:156189)，即 $\xi(t) \equiv 0$。

将 $\xi = 0$ 代入内动态方程，我们得到：
$$
\dot{\eta} = q(0, \eta)
$$
这个自治（无外部驱动）的动力系统 $\dot{\eta} = q(0, \eta)$ 正是我们在前文通过约束法定义的[零动态](@entry_id:177017)。因此，**[零动态](@entry_id:177017)是当外部动态被“关闭”（即 $\xi \equiv 0$）时的内动态** [@problem_id:2758170]。对于非零的输出轨迹，内动态会受到 $\xi(t)$ 的驱动，其行为可能与[零动态](@entry_id:177017)大相径庭。

### 计算实例：从理论到实践

为了巩固上述抽象概念，我们通过具体的计算实例来演示如何确定一个系统的[零动态](@entry_id:177017)。

#### SISO 系统实例

考虑以下三维SISO系统 [@problem_id:2758198]：
$$
f(x) = \begin{pmatrix} x_{2} \\ x_{3} \\ -x_{3} + x_{1}^{3} \end{pmatrix}, \quad g(x) = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}, \quad h(x) = x_{1}
$$
1.  **确定[相对阶](@entry_id:171358)**：
    $y = h(x) = x_1$
    $\dot{y} = L_f h(x) + L_g h(x) u = x_2 + 0 \cdot u = x_2$。由于输入未出现，[相对阶](@entry_id:171358) $r > 1$。
    $\ddot{y} = L_f^2 h(x) + L_g L_f h(x) u = L_f(x_2) + L_g(x_2) u = x_3 + 1 \cdot u$。
    由于 $L_g L_f h(x) = 1 \neq 0$，[相对阶](@entry_id:171358) $r=2$。

2.  **构造[坐标变换](@entry_id:172727)**：
    外部坐标为 $\xi_1 = h(x) = x_1$ 和 $\xi_2 = L_f h(x) = x_2$。
    内部坐标 $\eta$ 需要满足 $L_g \eta(x) = 0$。选择 $\eta = x_3$ 满足 $\frac{\partial x_3}{\partial x}g(x) = \begin{pmatrix} 0  0  1 \end{pmatrix} g(x) = 0$。坐标变换 $T(x) = (x_1, x_2, x_3)$ 是一个（全局）[微分同胚](@entry_id:147249)。

3.  **推导正规形与[零动态](@entry_id:177017)**：
    在新坐标 $(\xi_1, \xi_2, \eta) = (x_1, x_2, x_3)$ 下，系统动态为：
    $\dot{\xi}_1 = \dot{x}_1 = x_2 = \xi_2$
    $\dot{\xi}_2 = \dot{x}_2 = x_3 + u = \eta + u$
    $\dot{\eta} = \dot{x}_3 = -x_3 + x_1^3 = -\eta + \xi_1^3$
    内动态为 $\dot{\eta} = -\eta + \xi_1^3$。
    为了求[零动态](@entry_id:177017)，我们设置 $\xi \equiv 0$，即 $\xi_1 = x_1 = 0$ 和 $\xi_2 = x_2 = 0$。代入内动态方程，得到[零动态](@entry_id:177017)为：
    $$
    \dot{\eta} = -\eta
    $$
    这是一个稳定的一阶线性系统。

#### MIMO 系统实例

考虑一个五维、双输入双输出的[MIMO系统](@entry_id:268566) [@problem_id:2758144]：
$$
f(x) = \begin{pmatrix} x_2 \\ -x_1-x_2 \\ x_4 \\ -x_3-2x_4 \\ -x_5 + x_1x_3 + \sin(x_1) + x_3^2 \end{pmatrix}, \quad g_1(x) = \begin{pmatrix}0\\1\\0\\0\\0\end{pmatrix}, \quad g_2(x) = \begin{pmatrix}0\\0\\0\\1\\0\end{pmatrix}
$$
$$
y_1 = h_1(x) = x_1, \quad y_2 = h_2(x) = x_3
$$
1.  **确定向量[相对阶](@entry_id:171358)与解耦矩阵**：
    对于 $y_1=x_1$，我们计算 $\dot{y}_1 = x_2$ 和 $\ddot{y}_1 = -x_1 - x_2 + u_1$。因此[相对阶](@entry_id:171358) $r_1=2$。
    对于 $y_2=x_3$，我们计算 $\dot{y}_2 = x_4$ 和 $\ddot{y}_2 = -x_3 - 2x_4 + u_2$。因此[相对阶](@entry_id:171358) $r_2=2$。
    向量[相对阶](@entry_id:171358)为 $(2, 2)$。总[相对阶](@entry_id:171358) $r_1+r_2=4  n=5$，所以存在一维内动态。
    [解耦](@entry_id:637294)矩阵 $A(x)$ 的元素为 $A_{ij}(x) = L_{g_j} L_f^{r_i-1} h_i(x)$。
    $A_{11} = L_{g_1}L_f h_1 = L_{g_1}(x_2) = 1$, $A_{12} = L_{g_2}L_f h_1 = L_{g_2}(x_2) = 0$
    $A_{21} = L_{g_1}L_f h_2 = L_{g_1}(x_4) = 0$, $A_{22} = L_{g_2}L_f h_2 = L_{g_2}(x_4) = 1$
    因此，$A(x) = \begin{pmatrix} 1  0 \\ 0  1 \end{pmatrix}$，处处非奇异。

2.  **构造[坐标变换](@entry_id:172727)**：
    外部坐标为两个积分链：
    $\xi_{11} = h_1(x) = x_1, \quad \xi_{12} = L_f h_1(x) = x_2$
    $\xi_{21} = h_2(x) = x_3, \quad \xi_{22} = L_f h_2(x) = x_4$
    内部坐标 $\eta$ 需要满足 $L_{g_1} \eta(x) = 0$ 和 $L_{g_2} \eta(x) = 0$，即 $\eta$ 不依赖于 $x_2$ 和 $x_4$。最简单的选择是 $\eta = x_5$。

3.  **推导[零动态](@entry_id:177017)**：
    内动态由 $\dot{\eta} = \dot{x}_5$ 给出：
    $\dot{\eta} = -x_5 + x_1 x_3 + \sin(x_1) + x_3^2$
    用新坐标表示为：
    $\dot{\eta} = -\eta + \xi_{11}\xi_{21} + \sin(\xi_{11}) + \xi_{21}^2$
    [零动态](@entry_id:177017)是在 $\xi \equiv 0$ 的约束下得到的，即 $\xi_{11}=\xi_{12}=\xi_{21}=\xi_{22}=0$：
    $$
    \dot{\eta} = -\eta
    $$
    同样，我们得到了一个稳定的线性[零动态](@entry_id:177017)。

### 为何[零动态](@entry_id:177017)至关重要？

[零动态](@entry_id:177017)并非纯粹的数学构造，它深刻地影响着系统的控制性能和基本属性。

#### [反馈线性化](@entry_id:163432)与内部稳定性

[反馈线性化](@entry_id:163432)是一种强大的控制策略，它利用形如 $u = \beta^{-1}(- \alpha + v)$ 的反馈，将[非线性](@entry_id:637147)的输入-输出关系（$\dot{\xi}_r = \alpha + \beta u$）转化为一个简单的[线性关系](@entry_id:267880)（$\dot{\xi}_r = v$）。这使得我们可以使用线性控制技术，如[极点配置](@entry_id:155523)，来设计虚拟输入 $v$，从而使输出 $y(t)$ 精确地跟踪期望的参考轨迹 $y_d(t)$。

然而，这种控制策略只作用于外部动态 $\xi$。与此同时，内部动态 $\dot{\eta} = q(\xi, \eta)$ 仍在后台运行，并由外部状态 $\xi(t)$（即输出轨迹）驱动。如果[零动态](@entry_id:177017) $\dot{\eta} = q(0, \eta)$ 本身是不稳定的，那么即使 $\xi(t)$ 是有界的（例如，成功跟踪一个有界轨迹），内部状态 $\eta(t)$ 也可能发散到无穷大。这会导致整个系统状态 $x$ 的不稳定，即使输出看起来完美受控。这种现象称为**内部不稳定性**。

#### [最小相位](@entry_id:273619)特性

一个系统的[零动态](@entry_id:177017)的稳定性是其固有属性。如果一个系统的[零动态](@entry_id:177017)在其[平衡点](@entry_id:272705)附近是（局部指数）稳定的，我们称该系统为**[最小相位系统](@entry_id:268223)（minimum-phase system）** [@problem_id:2758229]。反之，如果[零动态](@entry_id:177017)不稳定，则称为**[非最小相位系统](@entry_id:167094)（non-minimum-phase system）**。

从上一节的讨论可以看出，**[最小相位](@entry_id:273619)特性是实现稳定输出跟踪的必要条件**。对于[非最小相位系统](@entry_id:167094)，试图通过[反馈线性化](@entry_id:163432)实现精确的输出跟踪将不可避免地导致内部状态的发散。这揭示了控制的一个深刻限制：我们无法任意改变系统的[零动态](@entry_id:177017)，它的稳定性决定了某些控制目标的根本可行性。

#### [系统可逆性](@entry_id:272250)

[零动态](@entry_id:177017)的稳定性也与系统的**可逆性（invertibility）**密切相关。系统求逆问题是指：给定一个输出轨迹 $y(t)$，能否唯一确定产生该轨迹的输入 $u(t)$？

从正规形可以看出，为了从 $y(t)$（及其导数，即 $\xi(t)$）计算出 $u(t)$，我们需要的公式 $u = \beta^{-1}(\dot{\xi}_r - \alpha)$ 中包含了内部状态 $\eta$。由于 $\eta$ 是不可测量的，任何实际的求逆器都必须包含一个内部模型（观测器）来估计 $\eta(t)$ 的行为。这个内部模型的动态方程正是 $\dot{\eta} = q(\xi, \eta)$。

如果我们要构造一个**稳定的**左[逆系统](@entry_id:271994)，那么当输入为参考输出 $y^\star(t)$ 时（对应于 $\xi \equiv 0$），逆系统的内部状态必须收敛。这意味着逆系统的动态 $\dot{z} = q(0, z)$ 必须是稳定的。这恰好就是系统零[动态稳定](@entry_id:173587)的要求 [@problem_id:2758189]。因此，**只有[最小相位系统](@entry_id:268223)才存在稳定的因果[左逆](@entry_id:153819)**。[非最小相位系统](@entry_id:167094)本质上是“难以”或“不稳定地”求逆的。

### 与[线性系统理论](@entry_id:172825)的联系：传递零点

对于熟悉[线性系统理论](@entry_id:172825)的学生来说，[零动态](@entry_id:177017)的概念可能听起来与**传递零点（transmission zeros）**有关。事实上，[零动态](@entry_id:177017)是传递零点在[非线性](@entry_id:637147)领域的直接推广。

对于一个[LTI系统](@entry_id:271946) $\dot{x} = Ax+Bu, y=Cx+Du$，其传递零点是使[罗森布罗克系统矩阵](@entry_id:164744) $R(s) = \begin{pmatrix} sI-A  -B \\ C  D \end{pmatrix}$ 降秩的复数 $s$。从物理意义上讲，一个传递零点 $s_0$ 是一个特定的复频率，在该频率下，系统可以“阻塞”一个特定方向的输入信号，使其不产生任何输出。

可以证明，对于一个[LTI系统](@entry_id:271946)，其**[零动态](@entry_id:177017)的[特征值](@entry_id:154894)集合恰好等于其传递零点的集合** [@problem_id:2758142]。[线性系统理论](@entry_id:172825)中的“最小相位”定义（所有传递零点都位于左半复平面）与我们对[非线性系统](@entry_id:168347)基于零[动态稳定](@entry_id:173587)性的定义完全一致。

因此，[零动态](@entry_id:177017)不仅为分析和控制非线性系统提供了关键工具，也为[线性系统理论](@entry_id:172825)中的核心概念提供了更深刻、更一般化的视角。它揭示了独立于具体控制律的、系统固有的动态特性，这些特性最终决定了控制性能的极限。