{"hands_on_practices": [{"introduction": "系统范数是量化MIMO系统动态特性的核心指标，但不同的范数揭示了系统行为的不同侧面。本练习通过一个特殊的二阶系统族，探讨了 $H_2$ 范数（与系统对白噪声输入的总能量响应或脉冲响应能量相关）和 $H_\\infty$ 范数（系统的峰值频率增益）之间的深刻差异。通过分析阻尼趋于零的极限情况，你将揭示为何一个系统的总能量可以很小，而其在特定频率下的放大能力却可能无穷大 [@problem_id:2745042]。", "problem": "考虑一个稳定、严格真、线性时不变、多输入多输出传递矩阵族 $G_{\\zeta}(s) \\in \\mathbb{C}^{2 \\times 2}$，该族由阻尼因子 $\\zeta \\in (0,1/4)$、自然频率 $\\omega_{0}  0$ 以及一个固定的非零标量 $\\kappa  0$ 参数化，由下式给出\n$$\nG_{\\zeta}(s) \\;=\\; \\kappa\\, \\zeta^{3/4}\\, \\frac{\\omega_{0}^{2}}{s^{2} + 2 \\zeta \\omega_{0} s + \\omega_{0}^{2}}\\, u v^{\\top},\n$$\n其中 $u = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$ 且 $v = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$。令 $\\bar{\\sigma}(X)$ 表示矩阵 $X$ 的最大奇异值。哈代空间范数定义如下\n$$\n\\|G_{\\zeta}\\|_{2}^{2} \\;=\\; \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{trace}\\!\\left(G_{\\zeta}(\\mathrm{j}\\omega)\\, G_{\\zeta}(\\mathrm{j}\\omega)^{*}\\right)\\, \\mathrm{d}\\omega,\n\\quad\n\\|G_{\\zeta}\\|_{\\infty} \\;=\\; \\sup_{\\omega \\in \\mathbb{R}}\\, \\bar{\\sigma}\\!\\left(G_{\\zeta}(\\mathrm{j}\\omega)\\right).\n$$\n仅使用这些定义和秩一传递矩阵奇异值分析的基本原理，完成以下任务：\n\n1. 推导 $\\|G_{\\zeta}\\|_{2}$ 关于 $\\kappa$、$\\zeta$ 和 $\\omega_{0}$ 的显式闭式表达式。\n2. 推导 $\\|G_{\\zeta}\\|_{\\infty}$ 关于 $\\kappa$、$\\zeta$ 和 $\\omega_{0}$ 的显式表达式，并确定达到最大值时的频率。\n3. 利用你的结果，分析当 $\\zeta \\to 0^{+}$ 时 $\\|G_{\\zeta}\\|_{2}$ 和 $\\|G_{\\zeta}\\|_{\\infty}$ 的标度变化，并解释为何在此族中 $\\|G_{\\zeta}\\|_{2} \\to 0$ 而 $\\|G_{\\zeta}\\|_{\\infty} \\to \\infty$ 是可能的。\n4. 计算有限常数\n$$\nL \\;=\\; \\lim_{\\zeta \\to 0^{+}} \\; \\zeta^{1/2}\\, \\frac{\\|G_{\\zeta}\\|_{\\infty}}{\\|G_{\\zeta}\\|_{2}}.\n$$\n\n你的最终答案必须是仅含 $\\omega_{0}$ 的 $L$ 的单一符号表达式。不包括单位。无需数值四舍五入。", "solution": "对所述问题进行验证。\n\n逐字提取给定条件：\n- 一个传递矩阵族 $G_{\\zeta}(s) \\in \\mathbb{C}^{2 \\times 2}$ 由 $G_{\\zeta}(s) \\;=\\; \\kappa\\, \\zeta^{3/4}\\, \\frac{\\omega_{0}^{2}}{s^{2} + 2 \\zeta \\omega_{0} s + \\omega_{0}^{2}}\\, u v^{\\top}$ 给出。\n- 参数为阻尼因子 $\\zeta \\in (0,1/4)$、自然频率 $\\omega_{0}  0$ 和一个固定的非零标量 $\\kappa  0$。\n- 向量为 $u = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$ 和 $v = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}$。\n- 矩阵 $X$ 的最大奇异值表示为 $\\bar{\\sigma}(X)$。\n- 哈代空间范数定义为 $\\|G_{\\zeta}\\|_{2}^{2} \\;=\\; \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{trace}\\!\\left(G_{\\zeta}(\\mathrm{j}\\omega)\\, G_{\\zeta}(\\mathrm{j}\\omega)^{*}\\right)\\, \\mathrm{d}\\omega$ 和 $\\|G_{\\zeta}\\|_{\\infty} \\;=\\; \\sup_{\\omega \\in \\mathbb{R}}\\, \\bar{\\sigma}\\!\\left(G_{\\zeta}(\\mathrm{j}\\omega)\\right)$。\n- 任务是：1. 推导 $\\|G_{\\zeta}\\|_{2}$。2. 推导 $\\|G_{\\zeta}\\|_{\\infty}$。3. 分析当 $\\zeta \\to 0^{+}$ 时的标度变化。4. 计算 $L \\;=\\; \\lim_{\\zeta \\to 0^{+}} \\; \\zeta^{1/2}\\, \\frac{\\|G_{\\zeta}\\|_{\\infty}}{\\|G_{\\zeta}\\|_{2}}$。\n\n验证结论：该问题在科学上基于线性控制理论，特别是使用标准 $H_2$ 和 $H_\\infty$ 范数对多输入多输出 (MIMO) 系统进行分析。系统模型是一个经典的二阶传递函数。所有术语都有精确定义，参数约束确保了系统的稳定性和良好性态。该问题是自洽、一致且适定的。它需要对基本原理进行不平凡的应用。因此，该问题是有效的。\n\n我们继续进行求解。\n\n传递矩阵 $G_{\\zeta}(s)$ 可以分解为一个标量传递函数 $g_{\\zeta}(s)$ 和一个常数矩阵 $M$：\n$$\nG_{\\zeta}(s) = g_{\\zeta}(s) M, \\quad \\text{其中} \\quad g_{\\zeta}(s) = \\kappa \\zeta^{3/4} \\frac{\\omega_{0}^{2}}{s^{2} + 2 \\zeta \\omega_{0} s + \\omega_{0}^{2}} \\quad \\text{且} \\quad M = uv^{\\top}.\n$$\n矩阵 $M$ 计算如下：\n$$\nM = u v^{\\top} = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} \\begin{bmatrix}1  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix}.\n$$\n这种结构显著简化了分析，因为 $G_{\\zeta}(s)$ 的性质与标量函数 $g_{\\zeta}(s)$ 直接相关。\n\n1. $\\|G_{\\zeta}\\|_{2}$ 的推导：\n$H_2$ 范数由 $\\|G_{\\zeta}\\|_{2}^{2} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{trace}(G_{\\zeta}(\\mathrm{j}\\omega)G_{\\zeta}(\\mathrm{j}\\omega)^{*}) \\, \\mathrm{d}\\omega$ 定义。\n频率响应矩阵为 $G_{\\zeta}(\\mathrm{j}\\omega) = g_{\\zeta}(\\mathrm{j}\\omega)M$。其共轭转置为 $G_{\\zeta}(\\mathrm{j}\\omega)^{*} = \\overline{g_{\\zeta}(\\mathrm{j}\\omega)}M^{*}$，其中 $\\overline{g_{\\zeta}(\\mathrm{j}\\omega)}$ 是 $g_{\\zeta}(\\mathrm{j}\\omega)$ 的复共轭。\n乘积为 $G_{\\zeta}(\\mathrm{j}\\omega)G_{\\zeta}(\\mathrm{j}\\omega)^{*} = |g_{\\zeta}(\\mathrm{j}\\omega)|^{2} M M^{*}$。\n由于 $u$ 和 $v$ 是实向量， $M = uv^{\\top}$ 是一个实矩阵，因此 $M^{*}=M^{\\top}$。\n$M M^{\\top} = (uv^{\\top})(uv^{\\top})^{\\top} = u v^{\\top} v u^{\\top} = u (v^{\\top}v) u^{\\top}$。\n内积 $v^{\\top}v = \\|v\\|_2^2 = 1^2+0^2 = 1$。\n所以，$M M^{\\top} = u u^{\\top} = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix} \\begin{bmatrix}1  0\\end{bmatrix} = \\begin{bmatrix}1  0 \\\\ 0  0\\end{bmatrix} = M$。\n那么迹为：\n$$\n\\mathrm{trace}(G_{\\zeta}(\\mathrm{j}\\omega)G_{\\zeta}(\\mathrm{j}\\omega)^{*}) = \\mathrm{trace}(|g_{\\zeta}(\\mathrm{j}\\omega)|^{2} M) = |g_{\\zeta}(\\mathrm{j}\\omega)|^{2} \\mathrm{trace}(M).\n$$\n由于 $\\mathrm{trace}(M) = 1+0=1$，我们得到 $\\mathrm{trace}(G_{\\zeta}(\\mathrm{j}\\omega)G_{\\zeta}(\\mathrm{j}\\omega)^{*}) = |g_{\\zeta}(\\mathrm{j}\\omega)|^{2}$。\n因此，MIMO 系统的 $H_2$ 范数平方与标量系统 $g_{\\zeta}(s)$ 的 $H_2$ 范数平方相同：\n$$\n\\|G_{\\zeta}\\|_{2}^{2} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |g_{\\zeta}(\\mathrm{j}\\omega)|^{2} \\, \\mathrm{d}\\omega.\n$$\n对于一个形如 $H(s) = \\frac{A}{s^2+as+b}$ 的稳定二阶系统，其 $H_2$ 范数平方由标准积分公式 $\\|H\\|_2^2 = \\frac{A^2}{2ab}$ 给出。对于 $g_{\\zeta}(s)$，我们确定 $A = \\kappa \\zeta^{3/4} \\omega_{0}^{2}$，$a = 2\\zeta\\omega_{0}$，和 $b = \\omega_{0}^{2}$。\n将这些代入公式：\n$$\n\\|G_{\\zeta}\\|_{2}^{2} = \\frac{(\\kappa \\zeta^{3/4} \\omega_{0}^{2})^{2}}{2(2\\zeta\\omega_{0})(\\omega_{0}^{2})} = \\frac{\\kappa^{2} \\zeta^{3/2} \\omega_{0}^{4}}{4\\zeta\\omega_{0}^{3}} = \\frac{\\kappa^{2} \\omega_{0}}{4} \\zeta^{1/2}.\n$$\n取平方根得到 $H_2$ 范数：\n$$\n\\|G_{\\zeta}\\|_{2} = \\frac{\\kappa \\sqrt{\\omega_{0}}}{2} \\zeta^{1/4}.\n$$\n\n2. $\\|G_{\\zeta}\\|_{\\infty}$ 的推导：\n$H_\\infty$ 范数是频率响应矩阵的峰值奇异值：$\\|G_{\\zeta}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(G_{\\zeta}(\\mathrm{j}\\omega))$。\n$G_{\\zeta}(\\mathrm{j}\\omega) = g_{\\zeta}(\\mathrm{j}\\omega) uv^{\\top}$ 的奇异值由 $|g_{\\zeta}(\\mathrm{j}\\omega)|$ 乘以 $uv^{\\top}$ 的奇异值给出。矩阵 $uv^{\\top}$ 的秩为一。其唯一的非零奇异值为 $\\|u\\|_{2}\\|v\\|_{2} = 1 \\times 1 = 1$。\n因此，$G_{\\zeta}(\\mathrm{j}\\omega)$ 的最大奇异值为 $\\bar{\\sigma}(G_{\\zeta}(\\mathrm{j}\\omega)) = |g_{\\zeta}(\\mathrm{j}\\omega)|$。\n$H_\\infty$ 范数是标量频率响应的峰值幅度：\n$$\n\\|G_{\\zeta}\\|_{\\infty} = \\sup_{\\omega \\in \\mathbb{R}} |g_{\\zeta}(\\mathrm{j}\\omega)|.\n$$\n$g_{\\zeta}(\\mathrm{j}\\omega)$ 的幅度为：\n$$\n|g_{\\zeta}(\\mathrm{j}\\omega)| = \\left| \\kappa \\zeta^{3/4} \\frac{\\omega_{0}^{2}}{(\\omega_{0}^{2}-\\omega^2) + \\mathrm{j}(2\\zeta\\omega_{0}\\omega)} \\right| = \\kappa \\zeta^{3/4} \\frac{\\omega_{0}^{2}}{\\sqrt{(\\omega_{0}^{2}-\\omega^2)^2 + (2\\zeta\\omega_{0}\\omega)^2}}.\n$$\n这是一个标准二阶系统的幅频响应，由 $\\kappa\\zeta^{3/4}$ 缩放。最大值（谐振峰）出现在谐振频率 $\\omega_{r} = \\omega_{0}\\sqrt{1-2\\zeta^2}$ 处，对于 $\\zeta \\in (0, 1/\\sqrt{2})$ 该频率为实数，这一条件由给定约束 $\\zeta \\in (0, 1/4)$ 满足。未缩放的\n传递函数 $\\frac{\\omega_{0}^{2}}{s^2+2\\zeta\\omega_{0}s+\\omega_{0}^2}$ 的峰值幅度为 $\\frac{1}{2\\zeta\\sqrt{1-\\zeta^2}}$。\n因此，$H_\\infty$ 范数为：\n$$\n\\|G_{\\zeta}\\|_{\\infty} = (\\kappa \\zeta^{3/4}) \\left( \\frac{1}{2\\zeta\\sqrt{1-\\zeta^2}} \\right) = \\frac{\\kappa \\zeta^{-1/4}}{2\\sqrt{1-\\zeta^2}}.\n$$\n最大值在 $\\omega = \\omega_{r} = \\omega_{0}\\sqrt{1-2\\zeta^2}$ 处达到。\n\n3. 当 $\\zeta \\to 0^{+}$ 时的标度分析与解释：\n当 $\\zeta \\to 0^{+}$ 时，我们分析这两个范数的行为：\n$$\n\\|G_{\\zeta}\\|_{2} = \\frac{\\kappa \\sqrt{\\omega_{0}}}{2} \\zeta^{1/4} \\longrightarrow 0.\n$$\n$$\n\\|G_{\\zeta}\\|_{\\infty} = \\frac{\\kappa}{2\\sqrt{1-\\zeta^2}} \\zeta^{-1/4} \\longrightarrow \\infty, \\quad \\text{因为} \\quad \\lim_{\\zeta \\to 0^{+}} \\frac{1}{\\sqrt{1-\\zeta^2}} = 1.\n$$\n$\\|G_{\\zeta}\\|_{\\infty}$ 的发散和 $\\|G_{\\zeta}\\|_{2}$ 收敛到零并不矛盾。$H_\\infty$ 范数衡量系统的峰值增益，而 $H_2$ 范数衡量系统的总能量（幅频响应平方的积分）。当 $\\zeta \\to 0^{+}$ 时，系统的谐振变得极其尖锐。频率响应 $|g_{\\zeta}(\\mathrm{j}\\omega)|$ 在 $\\omega \\approx \\omega_{0}$ 处形成一个非常高但也非常窄的峰。\n- 峰高决定了 $\\|G_{\\zeta}\\|_{\\infty}$，其标度为 $\\zeta^{-1/4}$，因此趋于无穷大。\n- 曲线 $|g_{\\zeta}(\\mathrm{j}\\omega)|^2$ 下的面积决定了 $\\|G_{\\zeta}\\|_{2}^2$，它取决于峰高和峰宽。幅值平方的峰高标度为 $(\\zeta^{-1/4})^2 = \\zeta^{-1/2}$，而谐振峰的宽度与阻尼成正比，即标度为 $\\zeta$。因此，总面积实际上与 $(\\text{高度}) \\times (\\text{宽度}) \\propto \\zeta^{-1/2} \\times \\zeta = \\zeta^{1/2}$ 成正比。这解释了为什么 $\\|G_{\\zeta}\\|_{2}^{2} \\propto \\zeta^{1/2}$，并收敛到零。\n$G_{\\zeta}(s)$ 定义中的预缩放因子 $\\zeta^{3/4}$ 至关重要。即使系统在单一频率上能够实现无限放大，该因子也足以使系统脉冲响应的总能量在极限情况下趋于零。\n\n4. 极限 $L$ 的计算：\n我们需要计算 $L = \\lim_{\\zeta \\to 0^{+}} \\zeta^{1/2} \\frac{\\|G_{\\zeta}\\|_{\\infty}}{\\|G_{\\zeta}\\|_{2}}$。我们代入推导出的范数表达式：\n$$\n\\frac{\\|G_{\\zeta}\\|_{\\infty}}{\\|G_{\\zeta}\\|_{2}} = \\frac{\\frac{\\kappa \\zeta^{-1/4}}{2\\sqrt{1-\\zeta^2}}}{\\frac{\\kappa \\sqrt{\\omega_{0}}}{2} \\zeta^{1/4}} = \\frac{\\kappa}{2\\sqrt{1-\\zeta^2}} \\cdot \\frac{2}{\\kappa \\sqrt{\\omega_{0}}} \\cdot \\frac{\\zeta^{-1/4}}{\\zeta^{1/4}} = \\frac{1}{\\sqrt{\\omega_{0}}\\sqrt{1-\\zeta^2}} \\zeta^{-1/2}.\n$$\n现在，我们乘以 $\\zeta^{1/2}$ 并取极限：\n$$\nL = \\lim_{\\zeta \\to 0^{+}} \\zeta^{1/2} \\left( \\frac{1}{\\sqrt{\\omega_{0}}\\sqrt{1-\\zeta^2}} \\zeta^{-1/2} \\right) = \\lim_{\\zeta \\to 0^{+}} \\frac{1}{\\sqrt{\\omega_{0}}\\sqrt{1-\\zeta^2}}.\n$$\n通过代入 $\\zeta=0$ 来计算极限：\n$$\nL = \\frac{1}{\\sqrt{\\omega_{0}}\\sqrt{1-0^2}} = \\frac{1}{\\sqrt{\\omega_{0}}}.\n$$\n这可以写成 $\\omega_{0}^{-1/2}$。", "answer": "$$\n\\boxed{\\omega_{0}^{-1/2}}\n$$", "id": "2745042"}, {"introduction": "小增益定理是鲁棒控制中一个简洁而强大的工具，它指出如果环路增益的峰值奇异值小于1，则稳定闭环系统能够容忍特定大小的不确定性。然而，一个常见的误解是将其直接用于判断标称系统的稳定性。本练习提供了一个关键的反例，旨在阐明当开环系统本身不稳定时，仅仅满足 $\\sup_{\\omega} \\bar{\\sigma}(L(j\\omega)) \\lt 1$ 并不能保证闭环稳定性 [@problem_id:2745053]。这个思想实验强调了应用MIMO奈奎斯特准则进行全面稳定性评估的必要性，防止对奇异值图的片面解读。", "problem": "考虑以下用于负反馈互联的严格真、有理、方形、双输入/双输出回路传递矩阵：\n$$\nL(s) \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{2}\\,\\frac{1}{s-1}  0 \\\\\n0  0\n\\end{pmatrix}.\n$$\n回差矩阵定义为 $I+L(s)$，闭环极点与 $\\det(I+L(s))$ 在复平面内的零点重合。仅使用基本定义和经过充分验证的事实（例如奇异值的定义、回差和矩阵回路的广义奈奎斯特理论），完成以下任务：\n\n- 从奇异值的定义出发，确定 $\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega))$，并验证其严格小于 $1$。\n\n- 使用回差矩阵 $I+L(s)$ 及其行列式作为广义奈奎斯特测试的标量映射，确定开右半平面内闭环极点的数量 $Z$。从第一性原理出发：确定 $L(s)$ 在开右半平面内的开环极点数量 $P$，以及在 $\\det(I+L(s))$ 映射下标准奈奎斯特围线的像关于原点的奈奎斯特环绕数 $N$，然后通过广义奈奎斯特理论关联 $Z$、$P$ 和 $N$。\n\n你的最终答案必须是单个数字 $Z$（无单位）。不要提供任何中间值。无需四舍五入。", "solution": "所述问题具有科学依据、适定且客观。这是多输入多输出（MIMO）控制理论中的一个标准问题，通过两种基本方法来解决系统稳定性：奇异值分析和广义奈奎斯特准则。所有提供的数据和定义都与既定原则一致。该问题有效且可解。\n\n按要求，分析分为两部分。\n\n首先，我们确定频率响应矩阵 $L(j\\omega)$ 的最大奇异值的上确界。\n回路传递矩阵为\n$$\nL(s) = \\begin{pmatrix} \\frac{1}{2(s-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n通过代入 $s=j\\omega$（其中 $\\omega \\in \\mathbb{R}$）获得频率响应。\n$$\nL(j\\omega) = \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n矩阵 $A$ 的奇异值（记为 $\\sigma_i(A)$）定义为矩阵乘积 $A^H A$ 的特征值的平方根，其中 $A^H$ 是 $A$ 的共轭转置。这里，$A = L(j\\omega)$。\n首先，我们求共轭转置 $L(j\\omega)^H$：\n$$\nL(j\\omega)^H = \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}^H = \\begin{pmatrix} \\overline{\\left(\\frac{1}{2(j\\omega-1)}\\right)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2(-j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n接下来，我们计算乘积 $L(j\\omega)^H L(j\\omega)$：\n$$\nL(j\\omega)^H L(j\\omega) = \\begin{pmatrix} \\frac{1}{2(-j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} \\frac{1}{4(-j\\omega-1)(j\\omega-1)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4(-(j\\omega)^2 - (-1)^2)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4(\\omega^2+1)}  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这个对角矩阵的特征值 $\\lambda$ 是其对角元素：$\\lambda_1 = \\frac{1}{4(\\omega^2+1)}$ 和 $\\lambda_2 = 0$。\n$L(j\\omega)$ 的奇异值为 $\\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{1}{4(\\omega^2+1)}} = \\frac{1}{2\\sqrt{\\omega^2+1}}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2} = 0$。\n最大奇异值，记为 $\\bar{\\sigma}$，是这些值中的最大值。\n$$\n\\bar{\\sigma}(L(j\\omega)) = \\max\\left(\\frac{1}{2\\sqrt{\\omega^2+1}}, 0\\right) = \\frac{1}{2\\sqrt{\\omega^2+1}}\n$$\n我们需要找到此函数在所有 $\\omega \\in \\mathbb{R}$ 上的上确界：\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega)) = \\sup_{\\omega \\in \\mathbb{R}} \\frac{1}{2\\sqrt{\\omega^2+1}}\n$$\n当分母最小时，该函数取得最大值。项 $\\omega^2+1$ 在 $\\omega=0$ 时取得最小值 $1$。因此，上确界在 $\\omega=0$ 时取得。\n$$\n\\sup_{\\omega \\in \\mathbb{R}} \\bar{\\sigma}(L(j\\omega)) = \\frac{1}{2\\sqrt{0^2+1}} = \\frac{1}{2}\n$$\n我们必须验证该值严格小于 $1$。确实，$\\frac{1}{2}  1$。这完成了问题的第一部分。关键要注意的是，小增益定理要求开环系统稳定，才能用此条件保证闭环稳定性。此处，$L(s)$ 在 $s=1$ 处有一个极点，因此开环系统不稳定，小增益定理不适用。\n\n第二，我们使用广义奈奎斯特理论来确定开右半平面 (ORHP) 内的闭环极点数量。不稳定闭环极点的数量 $Z$ 等于 $\\det(I+L(s))$ 在 ORHP 内的零点数量。\n广义奈奎斯特理论（或称幅角原理）表明 $Z = P + N$，其中 $P$ 是 $\\det(I+L(s))$ 在 ORHP 内的极点数量，而 $N$ 是 $\\det(I+L(s))$ 的奈奎斯特图对原点的逆时针 (CCW) 环绕次数。\n\n首先，我们计算特征函数 $g(s) = \\det(I+L(s))$：\n$$\nI+L(s) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} \\frac{1}{2(s-1)}  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{1}{2(s-1)}  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\ng(s) = \\det(I+L(s)) = 1 \\cdot \\left(1 + \\frac{1}{2(s-1)}\\right) = \\frac{2(s-1)+1}{2(s-1)} = \\frac{2s-1}{2s-2}\n$$\n为了求 $P$，我们确定 $g(s)$ 在 ORHP 内的极点。极点是分母 $2s-2=0$ 的根，这给出了一个位于 $s=1$ 的单极点。由于 $1  0$，该极点位于 ORHP 内。因此，$P=1$。\n\n为了求 $N$，我们通过映射标准奈奎斯特 D-围线来构建 $g(s)$ 的奈奎斯特图。此围线包围整个 ORHP。它由从 $s=-j\\infty$ 到 $s=+j\\infty$ 的虚轴以及在 RHP 内半径为 $R \\to \\infty$ 的大半圆组成。\n1.  映射虚轴，$s=j\\omega$，其中 $\\omega \\in (-\\infty, \\infty)$：\n    $$\n    g(j\\omega) = \\frac{2j\\omega-1}{2j\\omega-2} = \\frac{1}{2} \\cdot \\frac{1-2j\\omega}{1-j\\omega}\n    $$\n    我们求出其实部和虚部：\n    $$\n    g(j\\omega) = \\frac{1}{2} \\frac{(1-2j\\omega)(1+j\\omega)}{(1-j\\omega)(1+j\\omega)} = \\frac{1}{2} \\frac{1-j\\omega+2\\omega^2}{1+\\omega^2} = \\frac{1+2\\omega^2}{2(1+\\omega^2)} + j \\frac{-\\omega}{2(1+\\omega^2)}\n    $$\n    设 $x = \\text{Re}[g(j\\omega)]$ 和 $y = \\text{Im}[g(j\\omega)]$。可以证明，这些坐标满足一个圆的方程：$(x - \\frac{3}{4})^2 + y^2 = (\\frac{1}{4})^2$。这是一个以 $(\\frac{3}{4}, 0)$ 为圆心，半径为 $\\frac{1}{4}$ 的圆。\n    在 $\\omega=0$ 时，$g(0) = \\frac{-1}{-2} = \\frac{1}{2}$。这对应于点 $(\\frac{1}{2}, 0)$。\n    当 $\\omega \\to \\pm\\infty$ 时，$g(j\\omega) \\to \\frac{2j\\omega}{2j\\omega} = 1$。这对应于点 $(1, 0)$。\n    当 $\\omega$ 从 $-\\infty$ 变化到 $+\\infty$ 时，点 $g(j\\omega)$ 顺时针遍历这个圆，从 $(1,0)$ 开始，经过 $(\\frac{1}{2},0)$，然后返回到 $(1,0)$。\n2.  映射大半圆，$s = R e^{j\\theta}$，其中 $R\\to\\infty$ 且 $\\theta \\in [\\frac{\\pi}{2}, -\\frac{\\pi}{2}]$：\n    当 $|s| \\to \\infty$ 时，$g(s) = \\frac{2s-1}{2s-2} \\approx \\frac{2s}{2s} = 1$。整个大半圆映射到单点 $(1,0)$。\n\n$g(s)$ 的完整奈奎斯特图是一个以 $(\\frac{3}{4}, 0)$ 为圆心，半径为 $\\frac{1}{4}$ 的圆。该圆到原点的最小距离位于点 $(\\frac{1}{2},0)$。由于整个轮廓位于 RHP 内且不包含原点，因此对原点的环绕次数为零。因此，$N=0$。\n\n最后，我们应用公式 $Z = P + N$：\n$$\nZ = 1 + 0 = 1\n$$\n在开右半平面内有 $1$ 个闭环极点。这可以通过直接求解 $g(s) = \\frac{2s-1}{2s-2}$ 的零点来验证，其零点位于 $s=\\frac{1}{2}$。由于 $\\frac{1}{2}  0$，确实存在一个不稳定的闭环极点。计算结果是一致的。", "answer": "$$\\boxed{1}$$", "id": "2745053"}, {"introduction": "奇异值分析在评估闭环系统性能方面发挥着至关重要的作用，尤其是通过分析灵敏度函数 $S(s)$ 的奇异值。本练习将引导你通过计算 $S(j\\omega)$ 的奇异值图来直观地评估反馈设计的性能，并揭示非最小相位特性（如时间延迟）如何对可实现的性能带宽施加基本限制。这项实践将理论与工程现实联系起来，展示了如何量化由纯时间延迟引起的设计瓶颈，这对于任何高性能控制系统的设计都是一个核心考量 [@problem_id:2745127]。", "problem": "给定一个连续时间、线性时不变、双输入双输出（二乘二）的反馈回路，其对象传递矩阵为 $G(s)$，控制器传递矩阵为 $K(s)$。其（闭环）灵敏度函数定义为 $S(s) = (I + L(s))^{-1}$，其中 $L(s) = G(s)K(s)$，$I$ 是 $2 \\times 2$ 单位矩阵。对于每个实数频率 $\\omega \\ge 0$，灵敏度频率响应为 $S(j\\omega)$，其奇异值 $\\sigma_i(S(j\\omega))$（其中 $i \\in \\{1,2\\}$）定义为 $S(j\\omega)^* S(j\\omega)$ 的特征值的非负平方根，其中 $^*$ 表示共轭转置。在本问题中，您需要在一个频率网格上计算 $\\sigma_i(S(j\\omega))$，并识别出由于非最小相位特性（特别是纯时间延迟）而导致灵敏度降低从根本上不可能实现的频率区域。时间延迟被视为一种非最小相位特性，因为它在具有单位幅度的同时，会带来一个与频率相关的相位滞后 $-\\omega \\tau$，并且它对可实现的闭环带宽施加了经过充分验证的限制。\n\n给定三个测试用例。每个用例指定了一个对象 $G(s)$，并共用一个控制器 $K(s)$：\n- 控制器（所有用例通用）：$K(s) = \\operatorname{diag}(K_{11}(s), K_{22}(s))$，其中 $K_{11}(s) = 5\\,\\dfrac{s + 2}{s}$ 且 $K_{22}(s) = 4\\,\\dfrac{s + 1}{s}$。\n\n对于每个用例，定义 $s = j\\omega$，其中 $\\omega$ 的单位为弧度/秒，在一个对数间隔的网格 $\\omega \\in \\{\\omega_k\\}_{k=1}^N$ 上采样，其中 $N = 500$，$\\omega_1 = 10^{-2}$，$\\omega_N = 10^2$。\n\n用例 A（最小相位，无延迟）：\n- $G_{11}(s) = \\dfrac{1}{(s + 1)(s + 3)}$, $G_{12}(s) = \\dfrac{0.3}{s + 2}$,\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$, $G_{22}(s) = \\dfrac{2}{(s + 1)(s + 4)}$。\n\n用例 B（一个通道中存在右半平面零点，无延迟）：\n- $G_{11}(s) = \\dfrac{s - 1}{(s + 2)(s + 3)}$, $G_{12}(s) = \\dfrac{0.3}{s + 2}$,\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$, $G_{22}(s) = \\dfrac{2}{(s + 1)(s + 4)}$。\n\n用例 C（一个通道中存在时间延迟）：\n- $G_{11}(s) = \\dfrac{1}{(s + 1)(s + 3)}$, $G_{12}(s) = \\dfrac{0.3}{s + 2}$,\n- $G_{21}(s) = \\dfrac{0.5}{s + 2}$, $G_{22}(s) = e^{-0.25 s}\\,\\dfrac{2}{(s + 1)(s + 4)}$。\n\n任务：\n1) 对于每个用例，计算网格上所有 $\\omega_k$ 处的 $S(j\\omega_k)$，并计算每个 $\\omega_k$ 处的奇异值 $\\sigma_1(S(j\\omega_k))$ 和 $\\sigma_2(S(j\\omega_k))$。\n2) 识别出由于纯时间延迟这种非最小相位特性而导致灵敏度降低从根本上不可能实现的频率区域。使用以下经过充分验证的工程事实作为基本依据：对于反馈回路中一个 $\\tau$ 秒的纯输入-输出延迟，可实现的闭环带宽被保守地限制在 $\\omega_b \\tau  \\dfrac{\\pi}{2}$ 之内，这意味着试图在 $\\omega \\approx \\dfrac{\\pi}{2\\tau}$ 之外保持 $S(j\\omega)$ 很小从根本上是不可行的，因为由延迟引起的相位滞后 $-\\omega\\tau$ 在大环路增益下排除了足够的相位裕度。对于每个用例，对所有存在延迟的通道，将其对应的禁止频率半线 $[\\dfrac{\\pi}{2\\tau}, +\\infty)$（单位为弧度/秒）求并集。如果一个用例没有延迟，则由延迟引起的禁止区域为空。\n3) 对于每个用例，返回一个标量：基于延迟的禁止区域开始的最小频率 $\\omega_{\\text{forbid}}$（单位为弧度/秒）。如果禁止区域为空，则返回 $-1.0$。\n\n角度规定：所有频率必须以弧度/秒为单位处理。\n\n您的程序应生成一行输出，其中包含一个列表，内含三个浮点数 $[\\omega_{\\text{forbid}}^{(A)}, \\omega_{\\text{forbid}}^{(B)}, \\omega_{\\text{forbid}}^{(C)}]$，分别对应于用例 A、B 和 C。如果某个用例没有基于延迟的禁止区域，则使用 $-1.0$。输出必须格式化为单行的 Python 列表字面量，元素之间用逗号分隔。\n\n测试套件：\n- 用例 A：最小相位对象，无延迟。预期没有基于延迟的禁止区域。\n- 用例 B：带有右半平面零点的对象，无延迟。预期没有基于延迟的灵敏度禁止区域。\n- 用例 C：在 $G_{22}(s)$ 中存在一个纯时间延迟 $\\tau = 0.25$ 秒的对象，因此存在一个从 $\\omega = \\dfrac{\\pi}{2\\tau}$ 开始的基于延迟的禁止区域。\n\n注意：计算核心必须实现对每个用例在频率网格上 $G(j\\omega)$、$K(j\\omega)$、$S(j\\omega)$ 的求值以及奇异值 $\\sigma_i(S(j\\omega))$ 的计算。这些值不直接打印，但必须作为求解过程的一部分进行计算。最终输出必须是包含三个所要求的浮点数结果（单位为弧度/秒）的单行文本。", "solution": "问题陈述经过验证，确认有效。它在科学上基于线性多变量控制理论的原理，表述清晰且提供了所有必要信息，并在其形式上是客观的。该问题要求分析一个多输入多输出（MIMO）反馈系统，并理解由非最小相位特性（特别是时间延迟）所施加的性能限制。\n\n所考虑的系统是一个 $2 \\times 2$ 的反馈回路，其对象为 $G(s)$，控制器为 $K(s)$。环路传递函数为 $L(s) = G(s)K(s)$，灵敏度函数为 $S(s) = (I + L(s))^{-1}$，其中 $I$ 是 $2 \\times 2$ 单位矩阵。在频率 $s=j\\omega$ 处评估时，灵敏度函数的大小表示反馈系统在该频率下抑制扰动和跟踪参考的能力。对于 MIMO 系统，这由灵敏度矩阵的奇异值 $\\sigma_i(S(j\\omega))$ 来体现。小的奇异值（$\\sigma_i \\ll 1$）表示性能良好（灵敏度降低），而大的奇异值（$\\sigma_i \\ge 1$）表示性能不佳，甚至会放大扰动（灵敏度增加）。\n\n反馈控制中的一个基本原则是，开环传递函数 $L(s)$ 中的非最小相位元件会对可实现的性能施加限制。这些元件包括右半平面（RHP）零点和时间延迟。时间延迟项 $e^{-s\\tau}$ 对于所有实数频率 $\\omega$ 的幅值为 $1$（因为 $|e^{-j\\omega\\tau}|=1$），但会引入一个随频率线性增长的相位滞后 $-\\omega\\tau$。如果环路增益不衰减，这个相位滞后最终会在高频下使反馈回路不稳定，从而限制了可实现的闭环带宽。\n\n该问题要求一个两步过程。首先，它强制要求在指定的频率网格上计算灵敏度矩阵 $S(j\\omega)$ 及其奇异值。其次，它要求根据一个与时间延迟相关的特定给定规则来识别一个“禁止”频率区域：一个 $\\tau$ 秒的纯时间延迟在频率区域 $[\\frac{\\pi}{2\\tau}, +\\infty)$ 内施加了根本性的性能限制。每个用例的最终输出是这样一个基于延迟的禁止区域开始的最低频率，记为 $\\omega_{\\text{forbid}}$。如果没有时间延迟，该区域为空，结果应报告为 $-1.0$。\n\n让我们按规定分析每个用例。控制器对所有用例都是通用的：\n$$ K(s) = \\begin{pmatrix} K_{11}(s)  0 \\\\ 0  K_{22}(s) \\end{pmatrix} = \\begin{pmatrix} 5\\,\\dfrac{s + 2}{s}  0 \\\\ 0  4\\,\\dfrac{s + 1}{s} \\end{pmatrix} $$\n分析将逐个用例进行。\n\n用例 A：最小相位对象。\n对象传递矩阵 $G(s)$ 由下式给出：\n$$ G(s) = \\begin{pmatrix} \\dfrac{1}{(s + 1)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  \\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n$G(s)$ 所有元素的所有极点和零点都位于复平面的左半部分，并且没有 $e^{-s\\tau}$ 形式的时间延迟项。因此，该系统是最小相位的。根据问题指令，该指令专门关注来自*时间延迟*的限制，因此由延迟引起的禁止频率区域为空。\n因此，对于此用例，$\\omega_{\\text{forbid}}^{(A)} = -1.0$。\n\n用例 B：带有右半平面（RHP）零点的对象。\n对象传递矩阵 $G(s)$ 为：\n$$ G(s) = \\begin{pmatrix} \\dfrac{s - 1}{(s + 2)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  \\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n元素 $G_{11}(s)$ 在 $s = +1$ 处有一个零点，该零点位于 RHP 中。这个 RHP 零点是一个非最小相位特性，并施加了根本性的性能限制，正如 Bode 灵敏度积分所描述的那样。然而，问题明确指示*仅*根据纯时间延迟的存在来识别禁止区域，并使用提供的公式。由于该对象没有时间延迟项 $e^{-s\\tau}$，因此基于延迟的禁止区域为空。RHP 零点的存在与所问的具体问题无关。\n因此，对于此用例，$\\omega_{\\text{forbid}}^{(B)} = -1.0$。\n\n用例 C：带时间延迟的对象。\n对象传递矩阵 $G(s)$ 为：\n$$ G(s) = \\begin{pmatrix} \\dfrac{1}{(s + 1)(s + 3)}  \\dfrac{0.3}{s + 2} \\\\ \\dfrac{0.5}{s + 2}  e^{-0.25 s}\\,\\dfrac{2}{(s + 1)(s + 4)} \\end{pmatrix} $$\n元素 $G_{22}(s)$ 包含一个时间延迟项 $e^{-0.25s}$，对应于 $\\tau = 0.25$ 秒的延迟。根据问题陈述中提供的规则，此延迟创建了一个从 $\\omega = \\frac{\\pi}{2\\tau}$ 开始的灵敏度降低的禁止频率区域。系统中没有其他时间延迟。\n该区域的起始频率计算如下：\n$$ \\omega_{\\text{forbid}}^{(C)} = \\frac{\\pi}{2 \\times 0.25} = \\frac{\\pi}{0.5} = 2\\pi $$\n以弧度/秒为单位，该值约为 $6.283$。\n\n计算实现将涉及在指定的频率网格上评估复数矩阵 $G(j\\omega)$ 和 $K(j\\omega)$，计算 $L(j\\omega)$ 和 $S(j\\omega)$，并按任务 1 的要求对 $S(j\\omega)$ 进行奇异值分解。然后通过应用上述为每个用例推导的简单规则来确定最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the start of the delay-based forbidden frequency region for three\n    MIMO control system test cases.\n    \"\"\"\n    # Define problem parameters: frequency grid and identity matrix.\n    N = 500\n    omega = np.logspace(-2, 2, N)\n    s = 1j * omega\n    I = np.identity(2)\n\n    # --- Common Controller K(s) ---\n    # The controller is diagonal and common to all cases.\n    # We create a stack of 500 2x2 matrices, one for each frequency point.\n    K = np.zeros((N, 2, 2), dtype=complex)\n    K[:, 0, 0] = 5 * (s + 2) / s\n    K[:, 1, 1] = 4 * (s + 1) / s\n\n    def compute_sensitivity_svd(G_matrix):\n        \"\"\"\n        Performs the core computation as required by Task 1:\n        Calculates the loop transfer matrix L(jw), the sensitivity matrix S(jw),\n        and its singular values over the frequency grid.\n        \n        Args:\n            G_matrix: A (N, 2, 2) array of plant frequency responses.\n\n        Returns:\n            A (N, 2) array of singular values of S(jw).\n        \"\"\"\n        # L(jw) = G(jw)K(jw)\n        # The @ operator handles the stacked matrix multiplication correctly.\n        L = G_matrix @ K\n        # S(jw) = (I + L(jw))^-1\n        S = np.linalg.inv(I + L)\n        # Compute singular values of S(jw)\n        singular_values = np.linalg.svd(S, compute_uv=False)\n        return singular_values\n\n    results = []\n\n    # --- Case A: Minimum-phase plant, no delays ---\n    G_A = np.zeros((N, 2, 2), dtype=complex)\n    G_A[:, 0, 0] = 1 / ((s + 1) * (s + 3))\n    G_A[:, 0, 1] = 0.3 / (s + 2)\n    G_A[:, 1, 0] = 0.5 / (s + 2)\n    G_A[:, 1, 1] = 2 / ((s + 1) * (s + 4))\n    \n    # Task 1: Compute SVD as required, though not used in final answer.\n    _ = compute_sensitivity_svd(G_A)\n    \n    # Task 2  3: Determine omega_forbid. No delays are present.\n    omega_forbid_A = -1.0\n    results.append(omega_forbid_A)\n\n    # --- Case B: Plant with RHP zero, no delays ---\n    G_B = np.zeros((N, 2, 2), dtype=complex)\n    G_B[:, 0, 0] = (s - 1) / ((s + 2) * (s + 3))\n    G_B[:, 0, 1] = G_A[:, 0, 1]  # Reuse from Case A\n    G_B[:, 1, 0] = G_A[:, 1, 0]  # Reuse from Case A\n    G_B[:, 1, 1] = G_A[:, 1, 1]  # Reuse from Case A\n\n    # Task 1: Compute SVD as required.\n    _ = compute_sensitivity_svd(G_B)\n\n    # Task 2  3: Determine omega_forbid. No time delays are present.\n    # The RHP zero is ignored per the problem's specific instruction.\n    omega_forbid_B = -1.0\n    results.append(omega_forbid_B)\n\n    # --- Case C: Plant with time delay ---\n    tau_C = 0.25\n    G_C = np.zeros((N, 2, 2), dtype=complex)\n    G_C[:, 0, 0] = G_A[:, 0, 0]  # Reuse from Case A\n    G_C[:, 0, 1] = G_A[:, 0, 1]  # Reuse from Case A\n    G_C[:, 1, 0] = G_A[:, 1, 0]  # Reuse from Case A\n    G_C[:, 1, 1] = np.exp(-tau_C * s) * (2 / ((s + 1) * (s + 4)))\n\n    # Task 1: Compute SVD as required.\n    _ = compute_sensitivity_svd(G_C)\n\n    # Task 2  3: Determine omega_forbid. A time delay tau = 0.25s is present.\n    omega_forbid_C = np.pi / (2 * tau_C)\n    results.append(omega_forbid_C)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2745127"}]}