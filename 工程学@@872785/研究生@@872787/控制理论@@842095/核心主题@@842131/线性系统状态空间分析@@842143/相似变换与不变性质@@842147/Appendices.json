{"hands_on_practices": [{"introduction": "理解系统动态的几何本质是控制理论中的一个核心环节。本练习将引导您探索如何通过相似变换，将具有复数特征值的系统状态矩阵转换为其实数约当标准型，从而揭示其内在的旋转与缩放行为。通过从第一性原理出发构建此变换，您将亲手实践并加深对抽象代数属性（如特征值、迹和行列式）与系统具体动态行为之间联系的理解。[@problem_id:2744704]", "problem": "考虑实线性时不变(LTI)状态空间模型 $\\dot{x} = A x$，其中状态矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 是一个实 $2 \\times 2$ 矩阵。回顾基本定义：如果存在一个可逆矩阵 $S$ 使得 $S^{-1} A S = J$，则两个矩阵 $A$ 和 $J$ 是相似的；矩阵 $A$ 的一个特征对 $(\\lambda, v)$ 满足 $A v = \\lambda v$，其中 $\\lambda \\in \\mathbb{C}$ 且 $v \\in \\mathbb{C}^{2} \\setminus \\{0\\}$。对于实矩阵 $A$，其非实数特征值以共轭复数对的形式出现。这种复数对的实若尔当标准型是一个表示旋转缩放的实 $2 \\times 2$ 块。\n\n仅使用这些定义以及相似变换和特征对的性质，完成以下任务：\n\n1. 从 $A v = \\lambda v$ 出发，其中 $\\lambda = \\alpha + \\mathrm{i} \\beta$（$\\alpha, \\beta \\in \\mathbb{R}$）且 $v = p + \\mathrm{i} q$（$p, q \\in \\mathbb{R}^{2}$），推导一个实可逆相似变换 $S \\in \\mathbb{R}^{2 \\times 2}$，使得 $S^{-1} A S$ 是对应于特征值 $\\alpha \\pm \\mathrm{i} \\beta$ 的实若尔当块。用 $\\alpha$ 和 $\\beta$ 明确表示出所得的实若尔当块，并用 $A$ 的实不变量来确定 $\\alpha$ 和 $\\beta$。\n\n2. 将您的构造应用于特定矩阵\n$$\nA = \\begin{pmatrix}\n3 & -5 \\\\\n2 & 1\n\\end{pmatrix},\n$$\n并得出一个明确的实可逆矩阵 $S$，使其满足 $S^{-1} A S$ 等于与 $A$ 的特征值相关联的实若尔当块。您给出的 $S$ 必须具有精确的整数元素。\n\n3. 仅使用相似不变量（如迹和行列式），证明存在一个实矩阵 $S$ 将 $A$ 转换为单个实 $2 \\times 2$ 旋转缩放块的充要条件。用 $\\operatorname{tr}(A)$ 和 $\\det(A)$ 来表述这个条件。\n\n答案规格：最终答案只提供您在第2部分中得到的特定矩阵 $S$，写成一个 $2 \\times 2$ 矩阵。无需四舍五入，不涉及单位。", "solution": "该问题提法恰当，有科学依据，并包含了完整求解所需的所有信息。我们将按要求进行推导和计算。问题分为三个部分，我们将依次解决。\n\n第1部分：实相似变换和实若尔当型的推导。\n\n我们从实矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 的特征对 $(\\lambda, v)$ 的定义方程开始，即 $A v = \\lambda v$。\n问题指定了一个非实数特征值 $\\lambda = \\alpha + \\mathrm{i} \\beta$，其中 $\\alpha, \\beta \\in \\mathbb{R}$ 且 $\\beta \\neq 0$，以及对应的特征向量 $v = p + \\mathrm{i} q$，其中 $p, q \\in \\mathbb{R}^{2}$。由于 $v$ 是一个特征向量，所以 $v \\neq 0$，这意味着 $p$ 和 $q$ 不能同时为零向量。\n\n将 $\\lambda$ 和 $v$ 的复数形式代入特征值方程：\n$$A (p + \\mathrm{i} q) = (\\alpha + \\mathrm{i} \\beta) (p + \\mathrm{i} q)$$\n利用矩阵乘法的线性性质并展开右侧，我们得到：\n$$A p + \\mathrm{i} A q = (\\alpha p - \\beta q) + \\mathrm{i} (\\beta p + \\alpha q)$$\n由于 $A$、$p$ 和 $q$ 都是实的，我们可以令此方程的实部和虚部相等。这得到两个独立的实向量方程：\n1. $A p = \\alpha p - \\beta q$\n2. $A q = \\beta p + \\alpha q$\n\n这两个方程描述了 $A$ 对实向量 $p$ 和 $q$ 的作用。我们可以用矩阵形式表示这种关系。我们定义一个实矩阵 $S$，其列向量为 $p$ 和 $q$：$S = \\begin{pmatrix} p & q \\end{pmatrix}$。那么，$A$ 对 $S$ 的列向量的作用由下式给出：\n$$A S = A \\begin{pmatrix} p & q \\end{pmatrix} = \\begin{pmatrix} A p & A q \\end{pmatrix}$$\n代入我们关于 $A p$ 和 $A q$ 的表达式：\n$$A S = \\begin{pmatrix} \\alpha p - \\beta q & \\beta p + \\alpha q \\end{pmatrix}$$\n我们现在试图将右侧写成 $S$ 与一个我们称之为 $J$ 的实 $2 \\times 2$ 矩阵的乘积。\n$$\\begin{pmatrix} p & q \\end{pmatrix} \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix} = \\begin{pmatrix} p(\\alpha) + q(-\\beta) & p(\\beta) + q(\\alpha) \\end{pmatrix} = \\begin{pmatrix} \\alpha p - \\beta q & \\beta p + \\alpha q \\end{pmatrix}$$\n通过比较，我们发现：\n$$A S = S \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$$\n要使其成为一个相似变换，矩阵 $S$ 必须是可逆的。这要求其列向量 $p$ 和 $q$ 线性无关。我们来证明这一点。\n我们用反证法，假设 $p$ 和 $q$ 线性相关。由于 $v = p + \\mathrm{i} q \\neq 0$，所以 $p$ 和 $q$ 不能都为零。此外，如果 $p=0$ 或 $q=0$，特征值 $\\lambda$ 必须为实数，这与 $\\beta \\neq 0$ 矛盾。例如，如果 $q=0$，那么 $v=p$，且 $Ap = \\lambda p$。由于 $A$ 和 $p$ 都是实的，$\\lambda$ 必须是实数。因此，$p$ 和 $q$ 都必须是非零向量。\n如果它们线性相关，那么存在一个非零标量 $k \\in \\mathbb{R}$ 使得 $q = k p$。\n特征向量变为 $v = p + \\mathrm{i}(k p) = (1 + \\mathrm{i} k) p$。\n将此代入特征值方程：\n$$A ((1 + \\mathrm{i} k) p) = \\lambda ((1 + \\mathrm{i} k) p)$$\n由于 $k$ 是实数，$(1 + \\mathrm{i} k)$ 是一个非零复标量，我们可以从两边消去它：\n$$A p = \\lambda p$$\n这个方程中，$A$ 和 $p \\in \\mathbb{R}^{2} \\setminus \\{0\\}$ 都是实的，这意味着特征值 $\\lambda$ 必须是实数。这与我们的初始前提 $\\lambda$ 是非实数（即 $\\beta \\neq 0$）相矛盾。因此，线性相关的假设是错误的。向量 $p$ 和 $q$ 必须线性无关。\n\n由于 $p, q \\in \\mathbb{R}^2$ 线性无关，所以 $2 \\times 2$ 矩阵 $S = \\begin{pmatrix} p & q \\end{pmatrix}$ 是可逆的。因此，我们可以用 $S^{-1}$ 左乘方程 $A S = S J$：\n$$S^{-1} A S = J = \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$$\n这个矩阵 $J$ 就是对应于共轭复特征值 $\\alpha \\pm \\mathrm{i} \\beta$ 的实若尔当块。\n\n参数 $\\alpha$ 和 $\\beta$ 由 $A$ 的不变量决定。由于特征值为 $\\lambda_1 = \\alpha + \\mathrm{i}\\beta$ 和 $\\lambda_2 = \\alpha - \\mathrm{i}\\beta$：\n迹为 $\\operatorname{tr}(A) = \\lambda_1 + \\lambda_2 = (\\alpha + \\mathrm{i}\\beta) + (\\alpha - \\mathrm{i}\\beta) = 2\\alpha$。\n因此，$\\alpha = \\frac{1}{2} \\operatorname{tr}(A)$。\n行列式为 $\\det(A) = \\lambda_1 \\lambda_2 = (\\alpha + \\mathrm{i}\\beta)(\\alpha - \\mathrm{i}\\beta) = \\alpha^2 + \\beta^2$。\n因此，$\\beta^2 = \\det(A) - \\alpha^2 = \\det(A) - \\frac{1}{4} (\\operatorname{tr}(A))^2$。我们可以选择 $\\beta = \\sqrt{\\det(A) - \\frac{1}{4} (\\operatorname{tr}(A))^2}$，其中正根对应于选择特征值 $\\lambda = \\alpha + \\mathrm{i}\\beta$（$\\beta > 0$）。\n\n第2部分：应用于特定矩阵 $A = \\begin{pmatrix} 3 & -5 \\\\ 2 & 1 \\end{pmatrix}$。\n\n首先，我们通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来找到 $A$ 的特征值。\n$$\\det \\begin{pmatrix} 3 - \\lambda & -5 \\\\ 2 & 1 - \\lambda \\end{pmatrix} = (3 - \\lambda)(1 - \\lambda) - (2)(-5) = 0$$\n$$\\lambda^2 - 4\\lambda + 3 + 10 = 0$$\n$$\\lambda^2 - 4\\lambda + 13 = 0$$\n使用二次求根公式，特征值为：\n$$\\lambda = \\frac{4 \\pm \\sqrt{16 - 4(13)}}{2} = \\frac{4 \\pm \\sqrt{16 - 52}}{2} = \\frac{4 \\pm \\sqrt{-36}}{2} = \\frac{4 \\pm 6\\mathrm{i}}{2} = 2 \\pm 3\\mathrm{i}$$\n我们确定 $\\alpha = 2$ 并选择 $\\beta = 3$。让我们找到对应于特征值 $\\lambda = 2 + 3\\mathrm{i}$ 的特征向量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。\n$$(A - \\lambda I) v = \\begin{pmatrix} 3 - (2 + 3\\mathrm{i}) & -5 \\\\ 2 & 1 - (2 + 3\\mathrm{i}) \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 1 - 3\\mathrm{i} & -5 \\\\ 2 & -1 - 3\\mathrm{i} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n从第一行，我们得到 $(1 - 3\\mathrm{i}) v_1 - 5 v_2 = 0$，这给出 $v_1 = \\frac{5}{1 - 3\\mathrm{i}} v_2$。\n$$v_1 = \\frac{5(1 + 3\\mathrm{i})}{(1 - 3\\mathrm{i})(1 + 3\\mathrm{i})} v_2 = \\frac{5(1 + 3\\mathrm{i})}{1^2 + 3^2} v_2 = \\frac{5(1 + 3\\mathrm{i})}{10} v_2 = \\frac{1 + 3\\mathrm{i}}{2} v_2$$\n为了得到一个实部和虚部都为整数的特征向量，我们可以选择 $v_2 = 2$。\n这给出 $v_1 = 1 + 3\\mathrm{i}$。\n特征向量是 $v = \\begin{pmatrix} 1 + 3\\mathrm{i} \\\\ 2 \\end{pmatrix}$。\n现在我们将 $v$ 分解为其实部和虚部，$v = p + \\mathrm{i} q$：\n$$v = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} + \\mathrm{i} \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$$\n所以，$p = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 且 $q = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$。\n根据第1部分的构造，相似变换矩阵 $S$ 由这些向量构成：\n$$S = \\begin{pmatrix} p & q \\end{pmatrix} = \\begin{pmatrix} 1 & 3 \\\\ 2 & 0 \\end{pmatrix}$$\n这是一个具有精确整数元素的实可逆矩阵，符合要求。其行列式为 $\\det(S) = (1)(0) - (3)(2) = -6 \\neq 0$。\n\n第3部分：变换为旋转缩放块的条件。\n\n一个实 $2 \\times 2$ 矩阵 $A$ 可以通过一个实相似变换 $S$ 变换为一个旋转缩放块 $J = \\begin{pmatrix} \\alpha & \\beta \\\\ -\\beta & \\alpha \\end{pmatrix}$，当且仅当 $A$ 和 $J$ 相似。相似的一个必要条件是这两个矩阵具有相同的特征值。\n$J$ 的特征值是其特征多项式的根：\n$$\\det(J - \\lambda I) = (\\alpha - \\lambda)^2 - (\\beta)(-\\beta) = (\\alpha - \\lambda)^2 + \\beta^2 = 0$$\n这给出 $\\lambda - \\alpha = \\pm \\mathrm{i}\\beta$，所以 $\\lambda = \\alpha \\pm \\mathrm{i}\\beta$。\n要使 $J$ 成为一个真正的旋转缩放块，必须存在旋转分量，这要求 $\\beta \\neq 0$。这意味着特征值必须是一对非实数的共轭复数。\n由于特征值在相似变换下是不变的，矩阵 $A$ 也必须有一对非实数的共轭复特征值。\n\n$A$ 的特征值是其特征多项式 $p(\\lambda) = \\lambda^2 - \\operatorname{tr}(A)\\lambda + \\det(A) = 0$ 的根。这些根的性质由该二次方程的判别式 $\\Delta = (\\operatorname{tr}(A))^2 - 4\\det(A)$ 决定。\n要使特征值为一对非实数的共轭复数，判别式必须为负：\n$$\\Delta = (\\operatorname{tr}(A))^2 - 4\\det(A) < 0$$\n这是必要条件。\n\n为了证明充分性，如果 $(\\operatorname{tr}(A))^2 - 4\\det(A) < 0$，那么 $A$ 的特征值是 $\\lambda = \\frac{\\operatorname{tr}(A) \\pm \\mathrm{i}\\sqrt{4\\det(A) - (\\operatorname{tr}(A))^2}}{2}$。这些特征值的形式为 $\\alpha \\pm \\mathrm{i}\\beta$，其中 $\\alpha = \\frac{1}{2}\\operatorname{tr}(A)$ 且 $\\beta = \\frac{1}{2}\\sqrt{4\\det(A) - (\\operatorname{tr}(A))^2} \\neq 0$。\n由于特征值是不同的，矩阵 $A$ 在 $\\mathbb{C}$ 上是可对角化的。如第1部分所示，这种复特征对的存在保证了存在线性无关的实向量 $p$ 和 $q$，由此可以构造一个可逆实矩阵 $S = \\begin{pmatrix}p & q\\end{pmatrix}$，使得 $S^{-1}AS$ 是一个实若尔当块。\n因此，一个实 $2 \\times 2$ 矩阵 $A$ 与一个单独的实 $2 \\times 2$ 旋转缩放块相似的充要条件是 $(\\operatorname{tr}(A))^2 < 4\\det(A)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 3 \\\\ 2 & 0 \\end{pmatrix}}\n$$", "id": "2744704"}, {"introduction": "同一个输入-输出系统可以由无穷多个状态空间模型来表示，而标准型则为此提供了统一的描述框架。本练习将指导您推导连接两种最基本标准型——能控标准型和能观标准型——的相似变换矩阵。[@problem_id:2744720] 完成此练习后，您将对“所有最小实现都通过相似变换相关联”这一线性系统理论的基石，获得一个深刻且具构造性的理解，这一过程完全依赖于能控性矩阵在相似变换下的变换规律。", "problem": "考虑一个单输入单输出 (SISO) 的严格真有理传递函数\n$$\nG(s) \\;=\\; \\frac{b_{n-1}s^{n-1} + b_{n-2}s^{n-2} + \\cdots + b_{1}s + b_{0}}{s^{n} + a_{n-1}s^{n-1} + \\cdots + a_{1}s + a_{0}},\n$$\n其系数为实数，分母为 $n \\ge 1$ 阶的首一多项式。设 $\\left(A_{c}, B_{c}, C_{c}, 0\\right)$ 是 $G(s)$ 的可控标准型实现，$\\left(A_{o}, B_{o}, C_{o}, 0\\right)$ 是同一个 $G(s)$ 的可观测标准型实现。假设两种实现都是最小实现。根据标准型的定义，$\\left(A_{c}, B_{c}\\right)$ 是可控的，$\\left(C_{o}, A_{o}\\right)$ 是可观测的。\n\n请仅使用线性系统与控制中的基本定义，即相似变换、可控性矩阵和可观测性矩阵的定义，并且不借助任何预先给定的变换公式，构造性地推导出一个唯一的相似变换矩阵 $T \\in \\mathbb{R}^{n \\times n}$ 的闭式表达式。该矩阵将同一传递函数的可控标准型实现映射到其可观测标准型实现，即满足\n$$\nA_{o} \\;=\\; T A_{c} T^{-1}, \\qquad B_{o} \\;=\\; T B_{c}, \\qquad C_{o} \\;=\\; C_{c} T^{-1}.\n$$\n请用 $A_{c}$、$B_{c}$、$A_{o}$ 和 $B_{o}$ 明确表示您关于 $T$ 的最终结果，且仅使用基于第一性原理证明的操作。您的答案必须是单一的闭式解析表达式。无需进行数值计算，也无需单位。", "solution": "本题要求推导连接给定传递函数 $G(s)$ 的可控标准型实现 $\\left(A_{c}, B_{c}, C_{c}\\right)$ 和可观测标准型实现 $\\left(A_{o}, B_{o}, C_{o}\\right)$ 的唯一相似变换矩阵 $T$。推导过程必须是构造性的，并且仅基于相似变换、可控性矩阵和可观测性矩阵的基本定义。最终表达式必须用 $A_{c}$、$B_{c}$、$A_{o}$ 和 $B_{o}$ 表示。\n\n首先，我们验证问题陈述。\n给定条件如下：\n1. 一个单输入单输出 (SISO) 的严格真有理传递函数 $G(s) = \\frac{b_{n-1}s^{n-1} + \\cdots + b_{0}}{s^{n} + a_{n-1}s^{n-1} + \\cdots + a_{0}}$。\n2. 可控标准型实现 $\\left(A_{c}, B_{c}, C_{c}, 0\\right)$。\n3. 可观测标准型实现 $\\left(A_{o}, B_{o}, C_{o}, 0\\right)$。\n4. 对于一个维度为 $n$ 的状态空间，两种实现都是最小的。\n5. 相似变换关系：$A_{o} = T A_{c} T^{-1}$，$B_{o} = T B_{c}$，以及 $C_{o} = C_{c} T^{-1}$。\n\n该问题具有科学依据，提法恰当且客观。它是线性控制理论中的一个标准问题。已知同一传递函数的最小实现之间通过一个唯一的相似变换相联系。问题陈述是自洽和一致的，提供了所有必要的信息。它没有违反任何科学原理，也不包含任何歧义。因此，该问题是有效的，我们可以继续进行求解。\n\n推导的核心依赖于可控性矩阵在相似变换下的性质。设一个一般的线性时不变系统由矩阵对 $(A, B)$ 描述，其中 $A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times 1}$。该系统的可控性矩阵定义为：\n$$\n\\mathcal{C}(A, B) = \\begin{pmatrix} B & AB & A^{2}B & \\cdots & A^{n-1}B \\end{pmatrix}\n$$\n这是一个 $n \\times n$ 矩阵。\n\n给定联系两种实现的相似变换方程：\n1. $A_{o} = T A_{c} T^{-1}$\n2. $B_{o} = T B_{c}$\n\n我们的目标是找到 $T$ 的表达式。我们将分析可观测实现的的可控性矩阵 $\\mathcal{C}_{o} = \\mathcal{C}(A_{o}, B_{o})$ 与可控实现的可控性矩阵 $\\mathcal{C}_{c} = \\mathcal{C}(A_{c}, B_{c})$ 之间的关系。\n\n我们来考察 $\\mathcal{C}_{o}$ 的各列。\n第一列是 $B_{o}$。使用关系式(2)，我们有：\n$$\nB_{o} = T B_{c}\n$$\n第二列是 $A_{o} B_{o}$。代入关系式(1)和(2)：\n$$\nA_{o} B_{o} = \\left( T A_{c} T^{-1} \\right) \\left( T B_{c} \\right) = T A_{c} \\left( T^{-1} T \\right) B_{c} = T A_{c} I B_{c} = T (A_{c} B_{c})\n$$\n第三列是 $A_{o}^{2} B_{o}$。我们可以将其写成 $A_{o} (A_{o} B_{o})$ 并使用前面的结果：\n$$\nA_{o}^{2} B_{o} = A_{o} (T A_{c} B_{c}) = \\left( T A_{c} T^{-1} \\right) \\left( T A_{c} B_{c} \\right) = T A_{c}^{2} B_{c}\n$$\n我们可以通过归纳法建立一个通用公式。假设对于某个整数 $k \\ge 0$，有 $A_{o}^{k} B_{o} = T A_{c}^{k} B_{c}$。然后我们证明该式对 $k+1$ 也成立：\n$$\nA_{o}^{k+1} B_{o} = A_{o} (A_{o}^{k} B_{o}) = \\left( T A_{c} T^{-1} \\right) \\left( T A_{c}^{k} B_{c} \\right) = T A_{c} \\left( T^{-1} T \\right) A_{c}^{k} B_{c} = T A_{c}^{k+1} B_{c}\n$$\n对于 $k=0$ 的基本情况是 $A_{o}^{0} B_{o} = I B_{o} = B_o$ 和 $T A_{c}^{0} B_{c} = T I B_c = T B_c$，根据关系式(2)可知这是成立的。因此，公式 $A_{o}^{k} B_{o} = T A_{c}^{k} B_{c}$ 对所有整数 $k \\ge 0$ 均成立。\n\n现在，我们可以利用此性质为 $\\mathcal{C}_{o}$ 的每一列写出其完整的可控性矩阵：\n$$\n\\mathcal{C}_{o} = \\mathcal{C}(A_{o}, B_{o}) = \\begin{pmatrix} B_{o} & A_{o}B_{o} & \\cdots & A_{o}^{n-1}B_{o} \\end{pmatrix}\n$$\n$$\n\\mathcal{C}_{o} = \\begin{pmatrix} T B_{c} & T(A_{c}B_{c}) & \\cdots & T(A_{c}^{n-1}B_{c}) \\end{pmatrix}\n$$\n根据矩阵乘法的性质，我们可以从左侧提出矩阵 $T$：\n$$\n\\mathcal{C}_{o} = T \\begin{pmatrix} B_{c} & A_{c}B_{c} & \\cdots & A_{c}^{n-1}B_{c} \\end{pmatrix}\n$$\n右侧的矩阵根据定义是可控实现的可控性矩阵 $\\mathcal{C}_{c} = \\mathcal{C}(A_{c}, B_{c})$。因此，我们推导出了基本关系：\n$$\n\\mathcal{C}(A_{o}, B_{o}) = T \\mathcal{C}(A_{c}, B_{c})\n$$\n\n为了求解 $T$，我们必须能够对矩阵 $\\mathcal{C}(A_{c}, B_{c})$ 求逆。问题陈述指出实现 $(A_{c}, B_{c}, C_{c})$ 是最小的。对于一个维度为 $n$ 的状态空间系统，最小性意味着同时具有可控性和可观测性。矩阵对 $(A_c, B_c)$ 的可控性等价于其可控性矩阵 $\\mathcal{C}(A_{c}, B_{c})$ 具有满秩的条件，即 $\\text{rank}(\\mathcal{C}(A_{c}, B_{c})) = n$。由于 $\\mathcal{C}(A_{c}, B_{c})$ 是一个 $n \\times n$ 矩阵，满秩意味着它是非奇异的，因而是可逆的。\n\n鉴于 $\\mathcal{C}(A_{c}, B_{c})^{-1}$ 存在，我们可以用该逆矩阵右乘我们推导的方程的两边，以分离出 $T$：\n$$\n\\mathcal{C}(A_{o}, B_{o}) \\left( \\mathcal{C}(A_{c}, B_{c}) \\right)^{-1} = T \\mathcal{C}(A_{c}, B_{c}) \\left( \\mathcal{C}(A_{c}, B_{c}) \\right)^{-1}\n$$\n$$\n\\mathcal{C}(A_{o}, B_{o}) \\left( \\mathcal{C}(A_{c}, B_{c}) \\right)^{-1} = T I\n$$\n这就给出了相似变换矩阵 $T$ 的最终闭式表达式：\n$$\nT = \\mathcal{C}(A_{o}, B_{o}) \\left( \\mathcal{C}(A_{c}, B_{c}) \\right)^{-1}\n$$\n该表达式按要求从第一性原理构造性地推导得出，并且完全由给定的矩阵 $A_{c}$、$B_{c}$、$A_{o}$ 和 $B_{o}$ 表示。", "answer": "$$\n\\boxed{\\mathcal{C}(A_{o}, B_{o}) \\left( \\mathcal{C}(A_{c}, B_{c}) \\right)^{-1}}\n$$", "id": "2744720"}, {"introduction": "在实际应用中，系统模型并非总是“最小”的，它们可能包含无法控制或无法观测的部分，而Kalman分解是分析此类系统的关键工具。此问题挑战您应用相似变换，将一个非最小系统分解为四个基本子空间，从而有效地将系统的核心部分（即既能控又能观的部分）与其他部分分离开来。[@problem_id:2744735] 掌握这种分解方法对于高级控制设计和模型降阶至关重要，因为它使我们能够从一个复杂的系统中精准地分离出其核心的输入-输出动态。", "problem": "考虑一个线性时不变状态空间系统，其状态向量为 $x \\in \\mathbb{R}^{5}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$：\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix}\n-4 & 0 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & -2 & 0 \\\\\n0 & 0 & 7 & 0 & 0 \\\\\n0 & 0 & 0 & -2 & 0 \\\\\n0 & 0 & 0 & 0 & 5\n\\end{pmatrix},\\quad\nB = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix},\\quad\nC = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix}.\n$$\n从能控性和能观性的基本定义出发，构建一个相似变换 $T$，将该实现变换为Kalman分解形式，分离出四个规范子空间：能控能观子空间、能控不能观子空间、不能控能观子空间和不能控不能观子空间。你的构建过程必须明确指出能控子空间、不能观子空间、它们的交集，以及一组基的选择，该选择应在变换 $\\tilde{x} = T^{-1} x$ 下得到Kalman形式的分块上三角实现。\n\n在得到Kalman分解后，报告 $T^{-1} A T$ 的能控能观分块的特征多项式（以不定元 $s$ 表示）。请以单一解析表达式的形式给出最终答案。无需四舍五入。不涉及物理单位。", "solution": "该问题要求为一个给定的线性时不变（LTI）系统构建一个相似变换，以将其转换为Kalman规范型，然后确定能控且能观子系统的特征多项式。\n\n该系统由以下状态空间方程定义：\n$$ \\dot{x} = Ax + Bu, \\quad y = Cx $$\n其中矩阵如下：\n$$ A = \\begin{pmatrix} -4 & 0 & 0 & 0 & 0 \\\\ 0 & -1 & 0 & -2 & 0 \\\\ 0 & 0 & 7 & 0 & 0 \\\\ 0 & 0 & 0 & -2 & 0 \\\\ 0 & 0 & 0 & 0 & 5 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix} $$\n\n首先，我们验证问题的有效性。给定的是矩阵 $A$、$B$ 和 $C$，状态维度 $n=5$，输入维度 $m=1$，输出维度 $p=1$。问题陈述是自洽的，科学上基于成熟的控制理论，并且是客观的。它提出了一个标准的、适定的问题。该问题是有效的。\n\n求解过程首先识别状态空间 $\\mathbb{R}^5$ 的四个基本子空间：能控子空间 $\\mathcal{C}$，不能观子空间 $\\mathcal{O}^\\perp$，以及它们的交集，这些交集定义了Kalman分解。\n\n步骤 1：确定能控子空间 $\\mathcal{C}$。\n能控子空间是能控性矩阵 $\\mathcal{C}_M = \\begin{pmatrix} B & AB & A^2B & A^3B & A^4B \\end{pmatrix}$ 的列空间。\n我们计算其各列：\n$B = \\begin{pmatrix} 0 & 1 & 0 & 1 & 1 \\end{pmatrix}^T$\n$AB = \\begin{pmatrix} 0 & -3 & 0 & -2 & 5 \\end{pmatrix}^T$\n$A^2B = \\begin{pmatrix} 0 & 7 & 0 & 4 & 25 \\end{pmatrix}^T$\n$A^3B = \\begin{pmatrix} 0 & -15 & 0 & -8 & 125 \\end{pmatrix}^T$\n$A^4B = \\begin{pmatrix} 0 & 31 & 0 & 16 & 625 \\end{pmatrix}^T$\n能控性矩阵为：\n$$ \\mathcal{C}_M = \\begin{pmatrix} 0 & 0 & 0 & 0 & 0 \\\\ 1 & -3 & 7 & -15 & 31 \\\\ 0 & 0 & 0 & 0 & 0 \\\\ 1 & -2 & 4 & -8 & 16 \\\\ 1 & 5 & 25 & 125 & 625 \\end{pmatrix} $$\n第一行和第三行为零。矩阵的秩由其余各行的线性无关性决定。我们考察前三列。由第2、4、5行和第1、2、3列构成的子矩阵是 $\\begin{pmatrix} 1 & -3 & 7 \\\\ 1 & -2 & 4 \\\\ 1 & 5 & 25 \\end{pmatrix}$，其行列式为 $42 \\neq 0$。因此，$\\mathcal{C}_M$ 的秩为3，且 $\\dim(\\mathcal{C}) = 3$。$\\mathcal{C}_M$ 的所有列向量都位于第一和第三分量为零的子空间中，即 $\\text{span}\\{e_2, e_4, e_5\\}$，其中 $e_i$ 是标准基向量。由于 $\\dim(\\mathcal{C})=3$，我们必然有 $\\mathcal{C} = \\text{span}\\{e_2, e_4, e_5\\}$。\n\n步骤 2：确定不能观子空间 $\\mathcal{O}^\\perp$。\n不能观子空间是能观性矩阵 $\\mathcal{O}_M$ 的零空间：\n$$ \\mathcal{O}_M = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\\\ CA^4 \\end{pmatrix} $$\n我们计算其各行：\n$C = \\begin{pmatrix} 1 & -1 & 0 & 1 & 0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} -4 & -1 & 0 & 2 & 0 \\end{pmatrix}$\n$CA^2 = \\begin{pmatrix} 16 & -3 & 0 & -4 & 0 \\end{pmatrix}$\n$CA^3 = \\begin{pmatrix} -64 & -5 & 0 & 8 & 0 \\end{pmatrix}$\n$CA^4 = \\begin{pmatrix} 256 & -11 & 0 & -16 & 0 \\end{pmatrix}$\n如果 $\\mathcal{O}_M x = 0$，则向量 $x = (x_1, x_2, x_3, x_4, x_5)^T$ 属于 $\\mathcal{O}^\\perp$。对应于 $x_3$ 和 $x_5$ 的列为零，因此 $\\text{span}\\{e_3, e_5\\}$ 中的任何向量都是一个候选。由第1、2、4列构成的子矩阵秩为3，因为其顶部的 $3 \\times 3$ 行列式为 $-86 \\neq 0$。因此，对于任何 $x \\in \\mathcal{O}^\\perp$，我们必须有 $x_1=x_2=x_4=0$。因此，零空间由仅 $x_3$ 和 $x_5$ 可以非零的向量张成。\n因此，不能观子空间是 $\\mathcal{O}^\\perp = \\text{span}\\{e_3, e_5\\}$，且 $\\dim(\\mathcal{O}^\\perp) = 2$。\n能观子空间是 $\\mathcal{O} = (\\mathcal{O}^\\perp)^\\perp = \\text{span}\\{e_1, e_2, e_4\\}$。\n\n步骤 3：为Kalman分解的子空间构建基。\n状态空间 $\\mathbb{R}^5$ 被分解为四个子空间直和。\n1. 能控能观：$S_1 = \\mathcal{C} \\cap \\mathcal{O} = \\text{span}\\{e_2, e_4, e_5\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_2, e_4\\}$。一组基是 $\\{e_2, e_4\\}$。$\\dim(S_1) = 2$。\n2. 能控不能观：$S_2 = \\mathcal{C} \\cap \\mathcal{O}^\\perp = \\text{span}\\{e_2, e_4, e_5\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_5\\}$。一组基是 $\\{e_5\\}$。$\\dim(S_2) = 1$。\n3. 不能控能观：$S_3 = \\mathcal{C}^\\perp \\cap \\mathcal{O}$。首先，$\\mathcal{C}^\\perp = (\\text{span}\\{e_2, e_4, e_5\\})^\\perp = \\text{span}\\{e_1, e_3\\}$。所以，$S_3 = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_1, e_2, e_4\\} = \\text{span}\\{e_1\\}$。一组基是 $\\{e_1\\}$。$\\dim(S_3) = 1$。\n4. 不能控不能观：$S_4 = \\mathcal{C}^\\perp \\cap \\mathcal{O}^\\perp = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_3, e_5\\} = \\text{span}\\{e_3\\}$。一组基是 $\\{e_3\\}$。$\\dim(S_4) = 1$。\n\n步骤 4：构建相似变换。\n变换矩阵 $T$ 是通过按 $S_1, S_2, S_3, S_4$ 的顺序拼接基向量而形成的。\n$$ T = \\begin{pmatrix} e_2 & e_4 & e_5 & e_1 & e_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 0 \\end{pmatrix} $$\n这是一个置换矩阵，因此其逆矩阵是其转置：$T^{-1} = T^T$。新状态是 $\\tilde{x} = T^{-1}x = (x_2, x_4, x_5, x_1, x_3)^T$。\n\n步骤 5：计算变换后的系统。\n变换后的状态矩阵是 $\\tilde{A} = T^{-1}AT$。$AT$ 的列是 $Ae_2, Ae_4, Ae_5, Ae_1, Ae_3$。\n$AT = A\\begin{pmatrix} e_2 & e_4 & e_5 & e_1 & e_3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 & -4 & 0 \\\\ -1 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 & 7 \\\\ 0 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 5 & 0 & 0 \\end{pmatrix}$。\n然后 $\\tilde{A} = T^{-1}(AT)$ 将 $AT$ 的行重新排序为 $(2, 4, 5, 1, 3)$：\n$$ \\tilde{A} = \\begin{pmatrix} -1 & -2 & 0 & 0 & 0 \\\\ 0 & -2 & 0 & 0 & 0 \\\\ 0 & 0 & 5 & 0 & 0 \\\\ 0 & 0 & 0 & -4 & 0 \\\\ 0 & 0 & 0 & 0 & 7 \\end{pmatrix} $$\n该矩阵是分块对角的，这是所要求的分块上三角形式的一个特例。这些分块对应于四个子空间：\n$$\n\\tilde{A} =\n\\left(\n\\begin{array}{cc|c|c|c}\n-1 & -2 & 0 & 0 & 0 \\\\\n0 & -2 & 0 & 0 & 0 \\\\\n\\hline\n0 & 0 & 5 & 0 & 0 \\\\\n\\hline\n0 & 0 & 0 & -4 & 0 \\\\\n\\hline\n0 & 0 & 0 & 0 & 7\n\\end{array}\n\\right)\n= \\begin{pmatrix} A_{co} & 0 & 0 & 0 \\\\ 0 & A_{c\\bar{o}} & 0 & 0 \\\\ 0 & 0 & A_{\\bar{c}o} & 0 \\\\ 0 & 0 & 0 & A_{\\bar{c}\\bar{o}} \\end{pmatrix}\n$$\n能控且能观的分块是左上角的 $2 \\times 2$ 矩阵：\n$$ A_{co} = \\begin{pmatrix} -1 & -2 \\\\ 0 & -2 \\end{pmatrix} $$\n\n步骤 6：确定特征多项式。\n能控且能观分块的特征多项式是 $p(s) = \\det(sI - A_{co})$。\n$$ sI - A_{co} = s\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} -1 & -2 \\\\ 0 & -2 \\end{pmatrix} = \\begin{pmatrix} s+1 & 2 \\\\ 0 & s+2 \\end{pmatrix} $$\n行列式是：\n$$ p(s) = (s+1)(s+2) - (2)(0) = s^2 + 3s + 2 $$\n这就是所求的特征多项式。", "answer": "$$\\boxed{s^2 + 3s + 2}$$", "id": "2744735"}]}