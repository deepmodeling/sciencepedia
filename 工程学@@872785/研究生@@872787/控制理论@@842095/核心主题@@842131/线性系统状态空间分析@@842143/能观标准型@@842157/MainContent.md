## 引言
在[控制系统理论](@entry_id:270306)中，[状态空间表示](@entry_id:147149)法为分析和设计多输入多输出（MIMO）系统提供了强大的框架。然而，对于一个给定的系统，存在无限多种可能的[状态空间实现](@entry_id:166670)，这给系统化的分析和设计带来了挑战。可观测规范型（Observable Canonical Form, OCF）应运而生，它不仅提供了一种从外部[传递函数](@entry_id:273897)到内部状态空间模型的标准路径，其独特的结构还深刻揭示了系统的可观测性本质，并极大地简化了[状态观测器](@entry_id:268642)的设计。本文旨在全面解析可观测规范型，弥合[传递函数](@entry_id:273897)与[状态空间模型](@entry_id:137993)之间的理论鸿沟。

在接下来的内容中，我们将分三步深入探索可观测规范型。首先，在“原理与机制”章节中，我们将从可观测性的基本定义出发，利用优美的[对偶原理](@entry_id:276615)，系统地学习如何构建可观测规范型，并探讨其与[最小实现](@entry_id:176932)等核心概念的关联。接着，在“应用与[交叉](@entry_id:147634)学科联系”章节中，我们将聚焦于其最重要的应用——[状态观测器设计](@entry_id:168017)，并展示其在[系统分解](@entry_id:274870)、故障诊断及数字控制等领域的价值。最后，通过一系列精心设计的“动手实践”练习，您将有机会将理论知识转化为实际的计算与分析能力，从而真正掌握这一强大的控制理论工具。

## 原理与机制

在上一章介绍线性时不变（LTI）系统的[状态空间表示](@entry_id:147149)之后，本章将深入探讨一种至关重要的标准形式——**可观测规范型**（Observable Canonical Form, OCF）。这种规范形式不仅为从外部[传递函数](@entry_id:273897)到内部状态空间模型的转换提供了系统化的途径，而且其结构本身也深刻地揭示了系统的**[可观测性](@entry_id:152062)**（observability）本质。我们将从[可观测性](@entry_id:152062)的基本概念出发，通过[对偶原理](@entry_id:276615)构建可观测规范型，并探讨其在[系统分析](@entry_id:263805)、[最小实现](@entry_id:176932)和离散时间系统中的应用。

### 可观测性的概念

系统理论中的一个核心问题是：我们能否仅通过观察系统的外部输出，并结合已知的输入信息，来完全确定系统内部所有状态变量的当前值？这个问题的答案，便是可观测性的概念。

一个由[状态空间方程](@entry_id:266994) $\dot{x}(t) = Ax(t) + Bu(t)$ 和 $y(t) = Cx(t) + Du(t)$ 描述的系统，如果对于任意初始状态 $x(0)$，我们都可以在任意有限时间区间 $[0, T]$（其中 $T > 0$）内，根据该区间上的输入记录 $u(t)$ 和输出记录 $y(t)$ 唯一地确定出初始状态 $x(0)$，那么该系统（或者说状态与输出矩阵对 $(A, C)$）就是**可观测的**。[@problem_id:2729191]

为了推导出一个代数判据，我们首先考虑零输入情况，此时输出为 $y(t) = Ce^{At}x(0)$。为了从 $y(t)$ 确定 $x(0)$，我们需要考察映射 $x(0) \mapsto y(t)$ 的唯一性。我们可以对输出 $y(t)$ 反复求导，并在 $t=0$ 时进行评估：
$y(0) = Cx(0)$
$\dot{y}(0) = CAx(0)$
$\ddot{y}(0) = CA^2x(0)$
...
$y^{(n-1)}(0) = CA^{n-1}x(0)$

我们将这些[方程组](@entry_id:193238)合成一个矩阵方程：
$$
\begin{pmatrix}
y(0) \\
\dot{y}(0) \\
\vdots \\
y^{(n-1)}(0)
\end{pmatrix}
=
\begin{pmatrix}
C \\
CA \\
\vdots \\
CA^{n-1}
\end{pmatrix}
x(0)
$$

这个[方程组](@entry_id:193238)对于未知量 $x(0)$ 有唯一解的充分必要条件是，其[系数矩阵](@entry_id:151473)具有列满秩。这个 $pn \times n$（其中 $p$ 是输出的数量，$n$ 是状态的数量）的矩阵被称为**[可观测性矩阵](@entry_id:165052)**（Observability Matrix），记为 $\mathcal{O}$：
$$
\mathcal{O} = \begin{pmatrix} C \\ CA \\ \vdots \\ CA^{n-1} \end{pmatrix}
$$

这就是著名的**卡尔曼可观测性秩判据**（Kalman observability rank condition）：系统对 $(A,C)$ 是可观测的，当且仅当[可观测性矩阵](@entry_id:165052) $\mathcal{O}$ 的秩为 $n$。值得注意的是，即使在有输入的情况下，输入项 $Bu(t)$ 和前馈项 $Du(t)$ 都是已知量，可以从输出信号 $y(t)$ 中减去，因此[可观测性](@entry_id:152062)是系统内在的结构属性，由矩阵对 $(A, C)$ 唯一确定，与 $B$ 和 $D$ 无关。[@problem_id:2729191]

### [可控性与可观测性](@entry_id:174003)的[对偶原理](@entry_id:276615)

可观测性与我们在其他章节中讨论过的**可控性**（controllability）之间存在一种深刻而优美的对称关系，即**[对偶原理](@entry_id:276615)**（duality principle）。[对偶原理](@entry_id:276615)指出，系统对 $(A, C)$ 是可观测的，当且仅当其对偶系统对 $(A^T, C^T)$ 是可控的。[@problem_id:2729191] [@problem_id:2729204]

对偶关系不仅仅是理论上的巧合。我们可以通过比较[可观测性矩阵](@entry_id:165052)和[可控性矩阵](@entry_id:271824)来验证这一点。对偶系统 $(A^T, C^T)$ 的[可控性矩阵](@entry_id:271824) $\mathcal{C}(A^T, C^T)$ 为：
$$
\mathcal{C}(A^T, C^T) = \begin{pmatrix} C^T  A^T C^T  \cdots  (A^T)^{n-1} C^T \end{pmatrix}
$$
对该矩阵进行转置，我们得到：
$$
\mathcal{C}(A^T, C^T)^T = \begin{pmatrix} (C^T)^T \\ (A^T C^T)^T \\ \vdots \\ ((A^T)^{n-1} C^T)^T \end{pmatrix} = \begin{pmatrix} C \\ C A \\ \vdots \\ C A^{n-1} \end{pmatrix} = \mathcal{O}(A, C)
$$
由于矩阵的秩等于其[转置](@entry_id:142115)的秩，因此 $\text{rank}(\mathcal{C}(A^T, C^T)) = \text{rank}(\mathcal{O}(A, C))$。这[直接证明](@entry_id:141172)了 $(A, C)$ 的可观测性等价于 $(A^T, C^T)$ 的可控性。

[对偶原理](@entry_id:276615)的强大之处在于，它允许我们将关于[可控性](@entry_id:148402)的所有结论“翻译”成关于[可观测性](@entry_id:152062)的结论。更重要的是，它为我们构建可观测规范型提供了一条捷径：我们可以先构建一个标准的可控系统，然后通过[矩阵转置](@entry_id:155858)操作得到其对偶的可观测系统。

### 构建可观测规范型

对于一个给定的[传递函数](@entry_id:273897) $G(s) = \frac{N(s)}{D(s)}$，其中 $D(s) = s^n + a_{n-1}s^{n-1} + \dots + a_0$ 是一个 $n$ 次的[首一多项式](@entry_id:152311)，我们的目标是找到一个与之对应的、具有标准结构且保证可观测的[状态空间实现](@entry_id:166670) $(A_o, B_o, C_o)$。

#### 基于[对偶原理](@entry_id:276615)的构建方法

最常见的可观测规范型（也称为**观测器规范型**）正是通过[对偶原理](@entry_id:276615)从**可控规范型**（Controllable Canonical Form, CCF）派生而来的。一个标准的CCF实现 $(A_c, B_c, C_c)$ 如下：
$$
A_c = \begin{pmatrix}
0  1  0  \cdots  0 \\
0  0  1  \cdots  0 \\
\vdots  \vdots  \vdots  \ddots  \vdots \\
0  0  0  \cdots  1 \\
-a_0  -a_1  -a_2  \cdots  -a_{n-1}
\end{pmatrix}, \quad
B_c = \begin{pmatrix}
0 \\ 0 \\ \vdots \\ 0 \\ 1
\end{pmatrix}
$$
对于严格真[传递函数](@entry_id:273897) $G(s) = \frac{b_{n-1}s^{n-1} + \dots + b_0}{D(s)}$，其 $C_c$ 矩阵为：
$$
C_c = \begin{pmatrix} b_0  b_1  \cdots  b_{n-1} \end{pmatrix}
$$
根据[对偶原理](@entry_id:276615)，其对偶系统 $(A_c^T, C_c^T, B_c^T)$ 具有相同的[传递函数](@entry_id:273897)，并且因为 $(A_c, B_c)$ 是可控的，所以 $(A_c^T, B_c^T)$ 必定是可观测的。这就给出了可观测规范型（OCF）的矩阵：
$$
A_o = A_c^T = \begin{pmatrix}
0  0  \cdots  0  -a_0 \\
1  0  \cdots  0  -a_1 \\
0  1  \cdots  0  -a_2 \\
\vdots  \vdots  \ddots  \vdots  \vdots \\
0  0  \cdots  1  -a_{n-1}
\end{pmatrix}
$$
$$
B_o = C_c^T = \begin{pmatrix}
b_0 \\ b_1 \\ \vdots \\ b_{n-1}
\end{pmatrix}, \quad
C_o = B_c^T = \begin{pmatrix}
0  0  \cdots  0  1
\end{pmatrix}
$$
这组 $(A_o, B_o, C_o)$ 就是与[传递函数](@entry_id:273897) $G(s)$ 对应的一种可观测规范型。[@problem_id:2729204] 同样的结构也适用于离散时间系统，只需将 $s$ 替换为 $z$ 即可。[@problem_id:2729202]

#### 其他约定形式

值得注意的是，“可观测规范型”并非仅有一种形式。它通常指代任何一种 $(A, C)$ 具有固定[伴随矩阵](@entry_id:148203)结构、从而保证可观测性的实现形式。具体的 $A$ 和 $C$ 的结构会因教科书和文献的约定而异。

例如，在另一个常见的约定中，状态矩阵 $A_o$ 仍然是可控[伴随矩阵](@entry_id:148203)的[转置](@entry_id:142115)，但输出矩阵被固定为 $C_o = \begin{pmatrix} 1  0  \cdots  0 \end{pmatrix}$。在这种情况下，为了匹配给定的[传递函数](@entry_id:273897)，输入矩阵 $B_o$ 就不再是分子系数的简单[排列](@entry_id:136432)，而需要通过求解[传递函数](@entry_id:273897)恒等式 $G(s) = C_o(sI - A_o)^{-1}B_o$ 来确定。

考虑[传递函数](@entry_id:273897) $G(s) = \frac{3s^2+s+7}{s^3+4s^2+5s+2}$。其分母系数为 $a_2=4, a_1=5, a_0=2$。如果我们采用 $A$ 为可控伴随矩阵的转置，即
$$
A = \begin{pmatrix} 0  0  -2 \\ 1  0  -5 \\ 0  1  -4 \end{pmatrix}, \quad C = \begin{pmatrix} 1  0  0 \end{pmatrix}
$$
通过计算并匹配[传递函数](@entry_id:273897)分子，我们可以唯一地解出输入矩阵 $B = \begin{pmatrix} 3 \\ 4 \\ \frac{11}{2} \end{pmatrix}$。这个过程虽然计算稍显复杂，但它清晰地表明，一旦系统的 $(A, C)$ 结构被规范化，输入矩阵 $B$ 就必须“吸收”所有与系统零点（即[传递函数](@entry_id:273897)分子）相关的信息。[@problem_id:2729220]

### 可观测规范型的性质

#### [最小实现](@entry_id:176932)与麦克米伦度

当一个[状态空间实现](@entry_id:166670)既是可控的又是可观测的，我们称之为**[最小实现](@entry_id:176932)**（minimal realization）。[最小实现](@entry_id:176932)的维度（状态变量的个数）是所有能够实现该[传递函数](@entry_id:273897)的线性系统中的最低维度。这个维度被称为[传递函数](@entry_id:273897)的**麦克米伦度**（McMillan degree）。对于单输入单输出（SISO）系统，麦克米伦度等于将[传递函数](@entry_id:273897)分子分母化为互质多项式后，分母的阶数。[@problem_id:2729241]

如果一个可观测规范型是从一个分子分母互质的[传递函数](@entry_id:273897) $G(s)$ 构建的，那么这个实现不仅是可观测的（由其结构保证），而且也是可控的，因此它是一个[最小实现](@entry_id:176932)。

例如，考虑[传递函数](@entry_id:273897) $G(s) = \frac{(s+1)(s+2)^2}{(s+1)^2(s+2)(s+3)(s+4)}$。首先，我们进行[极零点对消](@entry_id:261496)，得到互质形式 $G_{red}(s) = \frac{s+2}{(s+1)(s+3)(s+4)} = \frac{s+2}{s^3+8s^2+19s+12}$。该[传递函数](@entry_id:273897)的麦克米伦度为3。我们为 $G_{red}(s)$ 构建一个3阶可观测规范型，可以验证该实现是可控且可观测的，因此是[最小实现](@entry_id:176932)。这表明实现该[传递函数](@entry_id:273897)所需的最少[状态变量](@entry_id:138790)数量为3。[@problem_id:2729241]

反之，如果我们从一个包含可对消极零点的非最小[传递函数](@entry_id:273897)（如 $G(s) = \frac{s+2}{s^2+3s+2} = \frac{s+2}{(s+1)(s+2)}$）出发，直接构建一个2阶可观测规范型，我们会发现该实现是可观测的，但却是**不可控的**。通过PBH（Popov-Belevitch-Hautus）测试可以发现，与被对消的极点（$s=-2$）对应的模式是不可控的。通过状态变换，我们可以将这个不可控的状态分离出来并剔除，从而得到一个1阶的[最小实现](@entry_id:176932)，其[传递函数](@entry_id:273897)为 $G_{min}(s) = \frac{1}{s+1}$。被消除的模式正是那个不影响输入输出关系的冗余状态。[@problem_id:2729182]

#### [可观测性](@entry_id:152062)指数

**可观测性指数** $\nu$ 定义为使得截断的[可观测性矩阵](@entry_id:165052) $\mathcal{O}_\nu = \begin{pmatrix} C \\ CA \\ \vdots \\ CA^{\nu-1} \end{pmatrix}$ 的秩首次达到 $n$ 的最小正整数。对于任何单输出可观测系统，其可观测性指数必然等于系统的阶数 $n$。