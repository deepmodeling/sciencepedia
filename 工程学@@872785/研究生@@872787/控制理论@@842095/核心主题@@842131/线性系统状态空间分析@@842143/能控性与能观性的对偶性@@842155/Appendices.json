{"hands_on_practices": [{"introduction": "对偶原理最直接和最实际的应用之一是在状态反馈控制和观测器设计中。这个练习将带你通过一个具体的设计过程，让你亲手体验如何利用对偶性来简化设计。你将首先为一个系统设计一个状态反馈控制器增益 $K$ 以配置闭环极点，然后，你将面对为同一个系统设计观测器增益 $L$ 的任务。通过利用可控性与可观性的对偶关系 [@problem_id:2703047]，你会发现观测器设计问题可以被巧妙地转化为一个等效的控制器设计问题，从而统一你的设计方法并加深对该原理实际价值的理解。", "problem": "考虑以下单输入单输出线性时不变（LTI）状态空间模型，其状态为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$：\n$$\n\\dot{x} = A x + B u,\\quad y = C x,\n$$\n其中\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n您需要设计一个全状态反馈和一个全阶Luenberger观测器。仅使用可控性和可观测性的核心定义，以及状态反馈 $u = -K x$ 产生闭环矩阵 $A - B K$、观测器误差动力学由 $A - L C$ 控制这两个基本事实。\n\n任务：\n- 首先，从基本原理出发，验证系统对 $(A,B)$ 是可控的，系统对 $(A,C)$ 是可观测的。\n- 然后，为状态反馈选择期望的闭环极点为共轭复数对 $-1 \\pm 2 i$，并推导唯一的实数行向量 $K = \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix}$，该向量将这些极点配置给 $A - B K$。\n- 最后，为观测器误差动力学选择相同的期望极点为共轭复数对 $-1 \\pm 2 i$，并推导唯一的实数列向量 $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$，该向量将这些极点配置给 $A - L C$。您的推理过程应在矩阵和特征多项式层面上明确利用可控性与可观测性之间的对偶性。\n\n将您的最终答案以单个行向量 $\\big(k_{1},\\,k_{2},\\,l_{1},\\,l_{2}\\big)$ 的形式报告。无需进行数值四舍五入，也不涉及单位。最终答案必须是按指定顺序排列的单行。", "solution": "在尝试求解之前，必须严格验证问题陈述。\n\n逐字提取给定条件：\n一个单输入单输出线性时不变（LTI）状态空间模型由 $\\dot{x} = A x + B u$ 和 $y = C x$ 给出。\n状态为 $x \\in \\mathbb{R}^{2}$，输入为 $u \\in \\mathbb{R}$，输出为 $y \\in \\mathbb{R}$。\n系统矩阵指定如下：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix},\\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n待设计一个全状态反馈控制器，其控制律为 $u = -K x$，其中增益是一个实数行向量 $K = \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix}$。状态反馈的期望闭环极点为共轭复数对 $-1 \\pm 2 i$。\n待设计一个全阶Luenberger观测器，其增益为一个实数列向量 $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$。期望的观测器误差动力学极点也为 $-1 \\pm 2 i$。\n任务是：1) 从基本原理验证 $(A,B)$ 的可控性和 $(A,C)$ 的可观测性；2) 推导唯一的增益 $K$；以及 3) 明确利用可控性与可观测性之间的对偶性来推导唯一的增益 $L$。\n\n问题陈述的验证：\n该问题是线性控制系统理论中的一个标准、定义明确的练习。它具有科学依据，使用了诸如状态空间表示、可控性、可观测性、极点配置和对偶性等基本概念。所有必要信息都已提供，并且矩阵的维度（$A$ 是 $2 \\times 2$，$B$ 是 $2 \\times 1$，$C$ 是 $1 \\times 2$）是一致的。该问题是客观的、无歧义的，并且可以数学形式化。没有违反物理原理或逻辑不一致之处。因此，该问题被判定为**有效**。我们继续进行求解。\n\n按要求，解答分为三个部分构建。\n\n首先，我们从基本原理验证可控性和可观测性。\n系统可控当且仅当其可控性矩阵 $\\mathcal{C}$ 满秩。对于一个维度为 $n=2$ 的系统，其可控性矩阵为 $\\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix}$。\n我们计算乘积 $AB$：\n$$ AB = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} (0)(0) + (1)(1) \\\\ (-2)(0) + (-3)(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -3 \\end{pmatrix} $$\n然后构成可控性矩阵：\n$$ \\mathcal{C} = \\begin{pmatrix} B  AB \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  -3 \\end{pmatrix} $$\n$\\mathcal{C}$ 的秩由其行列式决定。\n$$ \\det(\\mathcal{C}) = (0)(-3) - (1)(1) = -1 $$\n由于 $\\det(\\mathcal{C}) = -1 \\neq 0$，矩阵 $\\mathcal{C}$ 的秩为 2，即状态空间的维度。因此，系统对 $(A,B)$ 是可控的。\n\n系统可观测当且仅当其可观测性矩阵 $\\mathcal{O}$ 满秩。对于 $n=2$，可观测性矩阵为 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$。\n我们计算乘积 $CA$：\n$$ CA = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} = \\begin{pmatrix} (1)(0) + (0)(-2)  (1)(1) + (0)(-3) \\end{pmatrix} = \\begin{pmatrix} 0  1 \\end{pmatrix} $$\n可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_{2} $$\n其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。行列式为 $\\det(\\mathcal{O}) = 1 \\neq 0$。因此，$\\mathcal{O}$ 满秩，系统对 $(A,C)$ 是可观测的。\n\n其次，我们为极点配置设计状态反馈增益 $K$。\n带有状态反馈 $u=-Kx$ 的闭环系统的动力学由矩阵 $A_{cl} = A-BK$ 控制。$A_{cl}$ 的特征值是其特征多项式 $\\chi_{cl}(s) = \\det(sI - (A-BK))$ 的根。\n我们计算矩阵 $A-BK$：\n$$ A-BK = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} k_{1}  k_{2} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ k_{1}  k_{2} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -2-k_{1}  -3-k_{2} \\end{pmatrix} $$\n特征多项式为：\n$$ \\chi_{cl}(s) = \\det \\begin{pmatrix} s  -1 \\\\ 2+k_{1}  s+3+k_{2} \\end{pmatrix} = s(s+3+k_{2}) - (-1)(2+k_{1}) = s^{2} + (3+k_{2})s + (2+k_{1}) $$\n期望的极点是 $-1+2i$ 和 $-1-2i$。对应的期望特征多项式是：\n$$ \\chi_{des}(s) = (s - (-1+2i))(s - (-1-2i)) = ((s+1)-2i)((s+1)+2i) = (s+1)^{2} - (2i)^{2} = s^{2}+2s+1 - (-4) = s^{2}+2s+5 $$\n令 $\\chi_{cl}(s)$ 和 $\\chi_{des}(s)$ 的系数相等：\n对于 $s^{1}$ 项：$3+k_{2} = 2$，这意味着 $k_{2} = -1$。\n对于 $s^{0}$ 项：$2+k_{1} = 5$，这意味着 $k_{1} = 3$。\n状态反馈增益向量为 $K = \\begin{pmatrix} 3  -1 \\end{pmatrix}$。\n\n第三，我们利用对偶性原理设计观测器增益 $L$。\n观测器误差动力学由矩阵 $A_{obs} = A-LC$ 控制。观测器的极点配置问题是选择 $L$，使得 $A-LC$ 的特征值位于期望的位置。对偶性原理断言，系统对 $(A,C)$ 可观测当且仅当其对偶系统对 $(A^{T}, C^{T})$ 可控。为系统 $(A,C)$ 寻找观测器增益 $L$ 的问题，与为矩阵为 $(A^{T}, C^{T})$ 的系统寻找状态反馈增益 $K_{dual}$ 的问题是对偶的。$A-LC$ 的特征值与其转置 $(A-LC)^{T} = A^{T} - C^{T}L^{T}$ 的特征值相同。\n我们可以通过为由状态矩阵 $A' = A^{T}$ 和输入矩阵 $B' = C^{T}$ 定义的对偶系统寻找状态反馈增益 $K_{dual} = L^{T}$ 来解决观测器问题。\n对偶系统矩阵为：\n$$ A' = A^{T} = \\begin{pmatrix} 0  -2 \\\\ 1  -3 \\end{pmatrix}, \\quad B' = C^{T} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n我们为此对偶系统寻找一个增益 $K' = \\begin{pmatrix} k'_{1}  k'_{2} \\end{pmatrix}$，其中 $L^{T} = \\begin{pmatrix} l_{1}  l_{2} \\end{pmatrix} = K'$。对偶系统的闭环矩阵为 $A' - B'K'$。\n$$ A' - B'K' = \\begin{pmatrix} 0  -2 \\\\ 1  -3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} l_{1}  l_{2} \\end{pmatrix} = \\begin{pmatrix} 0  -2 \\\\ 1  -3 \\end{pmatrix} - \\begin{pmatrix} l_{1}  l_{2} \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} -l_{1}  -2-l_{2} \\\\ 1  -3 \\end{pmatrix} $$\n观测器误差的特征多项式 $\\chi_{obs}(s)$ 是此对偶闭环系统的特征多项式：\n$$ \\chi_{obs}(s) = \\det(sI - (A' - B'K')) = \\det \\begin{pmatrix} s+l_{1}  2+l_{2} \\\\ -1  s+3 \\end{pmatrix} = (s+l_{1})(s+3) + (2+l_{2}) = s^{2}+(3+l_{1})s+(3l_{1}+l_{2}+2) $$\n期望的观测器极点为 $-1 \\pm 2i$，这对应于相同的期望特征多项式 $\\chi_{des}(s) = s^{2}+2s+5$。\n令系数相等：\n对于 $s^{1}$ 项：$3+l_{1} = 2$，这意味着 $l_{1} = -1$。\n对于 $s^{0}$ 项：$3l_{1}+l_{2}+2 = 5$。\n将 $l_{1}=-1$ 代入第二个方程，得到 $3(-1)+l_{2}+2 = 5$，这可以简化为 $-3+l_{2}+2 = 5$，或者 $-1+l_{2}=5$。由此得到 $l_{2} = 6$。\n对偶问题的增益是 $L^{T} = K' = \\begin{pmatrix} -1  6 \\end{pmatrix}$。观测器增益是该向量的转置：\n$$ L = (L^{T})^{T} = \\begin{pmatrix} -1 \\\\ 6 \\end{pmatrix} $$\n因此，各分量为 $l_{1}=-1$ 和 $l_{2}=6$。\n\n问题要求最终答案为单个行向量 $(k_{1}, k_2, l_{1}, l_{2})$。\n根据我们的推导，$k_{1}=3$，$k_{2}=-1$，$l_{1}=-1$，$l_{2}=6$。\n结果向量为 $\\begin{pmatrix} 3  -1  -1  6 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 3  -1  -1  6 \\end{pmatrix}}\n$$", "id": "2703047"}, {"introduction": "理论上的可控性/可观性测试在实际数值计算中可能会遇到挑战。这个练习探讨了一个微妙但重要的问题：当系统的可控性矩阵变得病态（ill-conditioned）时，经典的Kalman秩测试可能会因为数值不稳定性而给出错误的结论。通过这个案例 [@problem_id:2703025]，你将学习并应用更为可靠的Popov-Belevitch-Hautus (PBH) 测试，它是一种基于系统特征值 $\\lambda$ 的频域方法。你将亲手验证PBH测试如何明确地证实系统的可控性，并利用其对偶形式来评估可观性，从而理解为什么在实际工程应用中，选择正确的分析工具至关重要。", "problem": "考虑由状态方程 $\\dot{x}(t) = A x(t) + B u(t)$ 给出的连续时间线性时不变状态空间系统，其中\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix},\n$$\n$\\varepsilon$ 是一个非零实参数，且 $|\\varepsilon| \\ll 1$。令 $S(\\varepsilon)$ 表示由 $(A,B)$ 构造的 Kalman 可控性矩阵，并令 $C = B^{\\top}$，因此输出方程为 $y(t) = C x(t)$。\n\n仅使用线性系统理论中的基本定义和标准秩检验，完成以下操作：\n\n1. 从第一性原理出发，构造 $S(\\varepsilon)$ 并分析其在 $|\\varepsilon| \\to 0$ 时的条件数。解释为什么即使系统是可控的，对于小的 $|\\varepsilon|$ 值，对 $S(\\varepsilon)$ 进行数值秩检验也可能不可靠。\n2. 对 $(A,B)$ 应用 Popov-Belevitch-Hautus (PBH) 可控性检验，并通过检查 $A$ 的特征值处的相应秩条件，严格证明对于所有允许的 $\\varepsilon$ 系统都是可控的。\n3. 对 $(A,C)$ 应用对偶 Popov-Belevitch-Hautus 可观测性检验，并通过检查 $A$ 的特征值处的相应秩条件，严格证明对于所有允许的 $\\varepsilon$ 系统都是可观测的。\n\n答案规格：报告 $\\det\\!\\big(S(\\varepsilon)\\big)$ 作为 $\\varepsilon$ 的函数的精确闭式符号表达式。不需要数值舍入，也不需要单位。最终答案必须是单个表达式。", "solution": "所述问题在科学上是合理的、自洽的，并且在线性系统控制理论领域内是适定的。它要求对一个特定的线性时不变系统的可控性和可观测性进行分析。问题的前提在事实上是正确的，问题是客观且可形式化的。因此，将提供一个解答。\n\n该系统由状态方程 $\\dot{x}(t) = A x(t) + B u(t)$ 描述，其中状态为 $x(t) \\in \\mathbb{R}^{2}$，输入为 $u(t) \\in \\mathbb{R}$。给定的矩阵是：\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}, \\qquad B = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}\n$$\n参数 $\\varepsilon$ 是一个非零实数，条件 $|\\varepsilon| \\ll 1$ 为有关数值稳定性的分析提供了背景。输出矩阵定义为 $C = B^{\\top} = \\begin{pmatrix} 1  \\varepsilon \\end{pmatrix}$。\n\n我们继续进行三项所需的分析。\n\n1.  Kalman 可控性矩阵 $S(\\varepsilon)$ 的构造与分析。\n    对于一个状态维数 $n=2$ 的系统，Kalman 可控性矩阵构造为 $S(\\varepsilon) = \\begin{pmatrix} B  AB \\end{pmatrix}$。我们必须首先计算乘积 $AB$：\n    $$\n    AB = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 1 \\cdot \\varepsilon \\\\ 0 \\cdot 1 + 1 \\cdot \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1 + \\varepsilon \\\\ \\varepsilon \\end{pmatrix}\n    $$\n    现在，我们通过拼接向量 $B$ 和 $AB$ 来构造矩阵 $S(\\varepsilon)$：\n    $$\n    S(\\varepsilon) = \\begin{pmatrix} 1  1+\\varepsilon \\\\ \\varepsilon  \\varepsilon \\end{pmatrix}\n    $$\n    控制理论的一个基本定理指出，系统可控的充要条件是可控性矩阵满秩。对于这个 $2 \\times 2$ 矩阵，该条件等价于其行列式不为零。我们计算其行列式：\n    $$\n    \\det\\!\\big(S(\\varepsilon)\\big) = (1)(\\varepsilon) - (1+\\varepsilon)(\\varepsilon) = \\varepsilon - \\varepsilon - \\varepsilon^2 = -\\varepsilon^2\n    $$\n    问题指明 $\\varepsilon$ 是一个非零实参数。因此，对于所有允许的 $\\varepsilon$ 值，$\\det\\!\\big(S(\\varepsilon)\\big) = -\\varepsilon^2 \\neq 0$。从解析上看，该系统是可控的。\n\n    然而，问题要求分析在 $|\\varepsilon| \\to 0$ 时的条件数。当 $\\varepsilon$ 趋近于 $0$ 时，行列式 $\\det\\!\\big(S(\\varepsilon)\\big)$ 也趋近于 $0$。行列式接近于零的矩阵被称为近奇异矩阵或病态矩阵。在采用有限精度算术的数值计算中，秩通常通过检查奇异值来确定。$S(\\varepsilon)$ 的奇异值是 $S(\\varepsilon)^{\\top}S(\\varepsilon)$ 特征值的平方根。让我们检查 $S(\\varepsilon)$ 的列向量：$v_1 = \\begin{pmatrix} 1 \\\\ \\varepsilon \\end{pmatrix}$ 和 $v_2 = \\begin{pmatrix} 1+\\varepsilon \\\\ \\varepsilon \\end{pmatrix}$。当 $\\varepsilon \\to 0$ 时，$v_1 \\to \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 且 $v_2 \\to \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。两个列向量变得几乎共线。一个试图为极小的 $\\varepsilon$ (例如，小于机器精度) 计算 $S(\\varepsilon)$ 的秩的数值算法可能会计算出其中一个奇异值实际上为零，从而错误地断定该矩阵是秩亏的，系统是不可控的。这是一个经典例子，说明了即使系统在解析上是可控的，由于病态性，直接对 Kalman 矩阵应用数值秩检验也可能失败。\n\n2.  Popov-Belevitch-Hautus (PBH) 可控性检验的应用。\n    PBH 检验为评估可控性提供了一种数值上更稳定的替代方法。矩阵对 $(A,B)$ 是可控的，当且仅当对于 $A$ 的每一个特征值 $\\lambda$，矩阵 $\\begin{pmatrix} \\lambda I - A  B \\end{pmatrix}$ 行满秩。其秩必须等于状态维数，即 $n=2$。\n\n    首先，我们求 $A$ 的特征值。由于 $A$ 是一个上三角矩阵，其特征值是其对角线元素。因此，我们有一个重复的特征值 $\\lambda_1 = \\lambda_2 = 1$。我们只需要检查 $\\lambda=1$ 时的 PBH 秩条件。\n\n    我们为 $\\lambda=1$ 构造 PBH 矩阵：\n    $$\n    M_c = \\begin{pmatrix} 1 \\cdot I - A  B \\end{pmatrix} = \\left( \\begin{array}{cc|c} 1 - 1  -1  1 \\\\ 0  1-1  \\varepsilon \\end{array} \\right) = \\left( \\begin{array}{cc|c} 0  -1  1 \\\\ 0  0  \\varepsilon \\end{array} \\right)\n    $$\n    这是一个 $2 \\times 3$ 的矩阵。我们必须检查它的秩是否为 $2$。矩阵的秩是线性无关行的数量。这些行是 $r_1 = \\begin{pmatrix} 0  -1  1 \\end{pmatrix}$ 和 $r_2 = \\begin{pmatrix} 0  0  \\varepsilon \\end{pmatrix}$。由于 $\\varepsilon \\neq 0$，第二行 $r_2$ 不是零向量。第一行 $r_1$ 也不是零向量。此外，$r_1$ 不是 $r_2$ 的标量倍数（反之亦然）。因此，这两行是线性无关的。$M_c$ 的秩为 $2$。\n    由于对于 $A$ 的唯一特征值，PBH 矩阵是行满秩的，因此严格证明了该系统对于所有 $\\varepsilon \\neq 0$ 都是可控的。这个检验不会遇到与 Kalman 矩阵检验相同的数值问题，因为它不涉及构造一个近奇异矩阵。\n\n3.  对偶 PBH 可观测性检验的应用。\n    对偶性概念指出，矩阵对 $(A, C)$ 是可观测的，当且仅当对偶对 $(A^{\\top}, C^{\\top})$ 是可控的。PBH 可观测性检验指出，矩阵对 $(A, C)$ 是可观测的，当且仅当对于 $A$ 的每一个特征值 $\\lambda$，矩阵 $\\begin{pmatrix} \\lambda I - A \\\\ C \\end{pmatrix}$ 列满秩（等于 $n=2$）。\n\n    输出矩阵为 $C = B^{\\top} = \\begin{pmatrix} 1  \\varepsilon \\end{pmatrix}$。$A$ 的特征值为 $\\lambda=1$。\n    我们为 $\\lambda=1$ 构造可观测性 PBH 矩阵：\n    $$\n    M_o = \\begin{pmatrix} 1 \\cdot I - A \\\\ C \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 0  0 \\\\ \\hline 1  \\varepsilon \\end{pmatrix}\n    $$\n    这是一个 $3 \\times 2$ 的矩阵。我们必须检查它的秩是否为 $2$。秩是线性无关列的数量。这些列是 $w_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 和 $w_2 = \\begin{pmatrix} -1 \\\\ 0 \\\\ \\varepsilon \\end{pmatrix}$。\n    为了检查线性无关性，我们寻求方程 $c_1 w_1 + c_2 w_2 = 0$ 的解：\n    $$\n    c_1 \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + c_2 \\begin{pmatrix} -1 \\\\ 0 \\\\ \\varepsilon \\end{pmatrix} = \\begin{pmatrix} -c_2 \\\\ 0 \\\\ c_1 + c_2 \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n    $$\n    从第一个分量，我们必须有 $-c_2 = 0$，这意味着 $c_2 = 0$。将此代入第三个分量方程，得到 $c_1 + 0 \\cdot \\varepsilon = 0$，这意味着 $c_1 = 0$。\n    唯一的解是平凡解，$c_1 = 0$ 且 $c_2 = 0$。因此，这些列是线性无关的，$M_o$ 的秩为 $2$。\n    由于对于 $A$ 的唯一特征值，可观测性 PBH 矩阵是列满秩的，因此矩阵对 $(A,C)$ 是可观测的。这对所有实数 $\\varepsilon$ 值都成立，包括 $\\varepsilon = 0$。该系统的可观测性不会随着 $|\\varepsilon| \\to 0$ 而退化。\n\n最终要求的答案是 $\\det\\!\\big(S(\\varepsilon)\\big)$ 的符号表达式。根据第一部分的计算，结果为 $-\\varepsilon^2$。", "answer": "$$\n\\boxed{-\\varepsilon^{2}}\n$$", "id": "2703025"}, {"introduction": "对偶原理的意义超越了简单的测试等价性，它揭示了系统内部结构的深刻对称性。这个练习 [@problem_id:2703050] 将引导你对一个线性系统及其对偶系统进行Kalman分解。通过将状态空间分解为四个基本子空间（可控可观、可控不可观、不可控可观、不可控不可观），你将不仅仅是验证系统是否可控或可观。更重要的是，你将亲眼见证原始系统的子空间结构如何在其对偶系统中以一种精确而优美的方式被“镜像”过来，从而对对偶性获得一种更加深入和结构化的认识。", "problem": "考虑由状态空间矩阵定义的线性时不变 (LTI) 系统\n$$\nA=\\begin{pmatrix}\n2  0  0  0\\\\\n0  -1  0  0\\\\\n0  0  3  0\\\\\n0  0  0  7\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n1  0  1  0\n\\end{pmatrix}.\n$$\n仅使用线性时不变系统的能控性和能观性的基本定义，以及根据能达子空间和不能观子空间构造 Kalman 分解的方法，执行以下任务，不使用超出这些定义的任何简化公式：\n\n1) 确定给定系统的能控子空间和能观子空间的维度及显式生成集。\n\n2) 由此，确定四个 Kalman 子空间：能控-能观、能控-不能观、不能控-能观以及不能控-不能观。构造一个基变换矩阵 $T$，其列向量构成的基按照能控-能观、能控-不能观、不能控-能观、不能控-不能观的顺序排列。\n\n3) 计算变换后的三元组 $(A_{k},B_{k},C_{k})$，其中 $A_{k}=T^{-1}AT$, $B_{k}=T^{-1}B$, $C_{k}=CT$，并展示与此顺序下的 Kalman 分解相对应的分块结构。\n\n4) 构建对偶系统 $(A^{\\top},C^{\\top},B^{\\top})$。使用相同的第一性原理方法，确定对偶系统对应的四个子空间，并验证对偶性下的分块对应关系，即原系统中能控-不能观分块的维数对应于对偶系统中不能控-能观分块的维数，反之亦然，而能控-能观和不能控-不能观分块在对偶变换下与自身对应。\n\n最后，设 $A_{co}$ 和 $A_{uu}$ 分别表示 $A_{k}$ 的能控-能观和不能控-不能观对角分块。计算标量\n$$\ns \\equiv \\det(A_{co})\\cdot \\det(A_{uu}).\n$$\n仅报告 $s$ 的值作为最终答案。无需四舍五入。", "solution": "本题是线性系统理论中关于能控性、能观性和 Kalman 规范分解的一个标准练习。题目科学严谨，问题明确，所有必要信息均已提供。我们将按照要求，基于基本原理进行严格的、分步的求解。状态空间的维数为 $n=4$。\n\n首先，我们确定给定线性时不变 (LTI) 系统的能控子空间和能观子空间。\n系统由以下矩阵定义：\n$$\nA=\\begin{pmatrix}\n2  0  0  0\\\\\n0  -1  0  0\\\\\n0  0  3  0\\\\\n0  0  0  7\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1\\\\\n1\\\\\n0\\\\\n0\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n1  0  1  0\n\\end{pmatrix}\n$$\n\n能控子空间，记为 $\\mathcal{C}$，是从原点出发的能达子空间，对于 LTI 系统，它是能控性矩阵 $\\mathcal{M}_c = \\begin{pmatrix} B  AB  A^2B  \\dots  A^{n-1}B \\end{pmatrix}$ 的像。对于 $n=4$，我们计算其列向量：\n$B = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$AB = \\begin{pmatrix} 2  0  0  0\\\\ 0  -1  0  0\\\\ 0  0  3  0\\\\ 0  0  0  7 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} 4 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n$A^3B = A(A^2B) = \\begin{pmatrix} 8 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}$\n因此，能控性矩阵为：\n$$ \\mathcal{M}_c = \\begin{pmatrix} 1  2  4  8 \\\\ 1  -1  1  -1 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n$\\mathcal{M}_c$ 的像是其线性无关的列向量生成的空间。前两列线性无关，其余列是前两列的线性组合。该子空间由向量 $(1, 1, 0, 0)^\\top$ 和 $(2, -1, 0, 0)^\\top$ 生成。这等价于由标准基向量 $e_1 = (1, 0, 0, 0)^\\top$ 和 $e_2 = (0, 1, 0, 0)^\\top$ 生成的空间。\n因此，能控子空间为 $\\mathcal{C} = \\text{span}\\{e_1, e_2\\}$，其维数为 $\\dim(\\mathcal{C})=2$。\n\n接下来，我们求解不能观子空间 $\\mathcal{N}$，其定义为能观性矩阵 $\\mathcal{M}_o = \\begin{pmatrix} C^\\top  (CA)^\\top  (CA^2)^\\top  \\dots  (CA^{n-1})^\\top \\end{pmatrix}^\\top$ 的核空间。我们计算其行向量：\n$C = \\begin{pmatrix} 1  0  1  0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} 1  0  1  0 \\end{pmatrix}A = \\begin{pmatrix} 2  0  3  0 \\end{pmatrix}$\n$CA^2 = (CA)A = \\begin{pmatrix} 4  0  9  0 \\end{pmatrix}$\n$CA^3 = (CA^2)A = \\begin{pmatrix} 8  0  27  0 \\end{pmatrix}$\n能观性矩阵为：\n$$ \\mathcal{M}_o = \\begin{pmatrix} 1  0  1  0 \\\\ 2  0  3  0 \\\\ 4  0  9  0 \\\\ 8  0  27  0 \\end{pmatrix} $$\n不能观子空间 $\\mathcal{N}$ 是所有满足 $\\mathcal{M}_o x = 0$ 的向量 $x = (x_1, x_2, x_3, x_4)^\\top$ 的集合。该方程组意味着 $x_1+x_3=0$ 和 $2x_1+3x_3=0$，其唯一解为 $x_1=0, x_3=0$。对 $x_2$ 和 $x_4$ 没有约束。因此，$\\mathcal{N}$ 中的任意向量形式为 $(0, x_2, 0, x_4)^\\top$。\n不能观子空间为 $\\mathcal{N} = \\text{span}\\{e_2, e_4\\}$，其维数为 $\\dim(\\mathcal{N})=2$。\n能观子空间 $\\mathcal{O}$ 是不能观子空间的正交补空间，即 $\\mathcal{O}=\\mathcal{N}^\\perp$。因此，$\\mathcal{O} = (\\text{span}\\{e_2, e_4\\})^\\perp = \\text{span}\\{e_1, e_3\\}$，其维数为 $\\dim(\\mathcal{O})=2$。\n\n确定了 $\\mathcal{C}$ 和 $\\mathcal{N}$ 后，我们构造四个 Kalman 子空间：\n1. 能控-能观子空间： $S_{co} = \\mathcal{C} \\cap \\mathcal{O} = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_1\\}$。\n2. 能控-不能观子空间： $S_{cu} = \\mathcal{C} \\cap \\mathcal{N} = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_2\\}$。\n3. 不能控-能观子空间： $S_{uo} = \\mathcal{C}^\\perp \\cap \\mathcal{O} = \\text{span}\\{e_3, e_4\\} \\cap \\text{span}\\{e_1, e_3\\} = \\text{span}\\{e_3\\}$。\n4. 不能控-不能观子空间： $S_{uu} = \\mathcal{C}^\\perp \\cap \\mathcal{N} = \\text{span}\\{e_3, e_4\\} \\cap \\text{span}\\{e_2, e_4\\} = \\text{span}\\{e_4\\}$。\n每个子空间的维数都为 1。根据 Kalman 分解 $\\{S_{co}, S_{cu}, S_{uo}, S_{uu}\\}$ 的顺序，整个状态空间的一组基为 $\\{e_1, e_2, e_3, e_4\\}$。由这些列向量构成的基变换矩阵 $T$ 是单位矩阵 $T=I_4$。\n\n变换后的状态空间表示 $(A_k, B_k, C_k)$ 由 $A_k=T^{-1}AT$，$B_k=T^{-1}B$ 和 $C_k=CT$ 给出。由于 $T=I_4$，变换后的系统与原系统相同：$(A_k, B_k, C_k) = (A, B, C)$。状态变量已经根据 Kalman 子空间解耦。我们展示其分块结构：\n$$ A_k = A = \\begin{pmatrix} 2  0  0  0 \\\\ \\hline 0  -1  0  0 \\\\ \\hline 0  0  3  0 \\\\ \\hline 0  0  0  7 \\end{pmatrix} = \\begin{pmatrix} A_{co}  0  0  0 \\\\ 0  A_{cu}  0  0 \\\\ 0  0  A_{uo}  0 \\\\ 0  0  0  A_{uu} \\end{pmatrix} $$\n$$ B_k = B = \\begin{pmatrix} 1 \\\\ \\hline 1 \\\\ \\hline 0 \\\\ \\hline 0 \\end{pmatrix} = \\begin{pmatrix} B_{co} \\\\ B_{cu} \\\\ 0 \\\\ 0 \\end{pmatrix} \\quad C_k = C = \\begin{pmatrix} 1  0  1  0 \\end{pmatrix} = \\begin{pmatrix} C_{co}  0  C_{uo}  0 \\end{pmatrix} $$\n各个分块为：\n$A_{co} = (2)$, $A_{cu} = (-1)$, $A_{uo} = (3)$, $A_{uu} = (7)$。\n$B_{co} = (1)$, $B_{cu} = (1)$。\n$C_{co} = (1)$, $C_{uo} = (1)$。\n该结构是分块对角阵，因为 Kalman 子空间是 A-不变的，这是由于 $A$ 是对角矩阵的结果。\n\n现在我们分析对偶系统 $(\\tilde{A}, \\tilde{B}, \\tilde{C})=(A^\\top, C^\\top, B^\\top)$。\n$\\tilde{A} = A^\\top = A$。\n$\\tilde{B} = C^\\top = (1, 0, 1, 0)^\\top$。\n$\\tilde{C} = B^\\top = (1, 1, 0, 0)$。\n对偶系统的能控子空间 $\\tilde{\\mathcal{C}}$ 是 $\\tilde{\\mathcal{M}}_c = \\begin{pmatrix} \\tilde{B}  \\tilde{A}\\tilde{B}  \\dots \\end{pmatrix}$ 的像。\n$\\tilde{A}\\tilde{B} = A C^\\top = (2, 0, 3, 0)^\\top$。\n$\\tilde{\\mathcal{M}}_c$ 的列向量生成的子空间与 $(1, 0, 1, 0)^\\top$ 和 $(2, 0, 3, 0)^\\top$ 生成的子空间相同，即 $\\text{span}\\{e_1, e_3\\}$。所以，$\\tilde{\\mathcal{C}} = \\text{span}\\{e_1, e_3\\}$。这与原系统的能观子空间 $\\mathcal{O}$ 相同，正如对偶理论所预测的。$\\dim(\\tilde{\\mathcal{C}}) = 2$。\n对偶系统的不能观子空间 $\\tilde{\\mathcal{N}}$ 是其能观性矩阵 $\\tilde{\\mathcal{M}}_o$ 的核空间，其行向量为 $\\tilde{C}, \\tilde{C}\\tilde{A}, \\dots$。\n$\\tilde{C}\\tilde{A} = B^\\top A = (2, -1, 0, 0)$。\n核空间是满足 $x_1+x_2=0$ 和 $2x_1-x_2=0$ 的向量 $x$ 的集合，这意味着 $x_1=0, x_2=0$。因此 $\\tilde{\\mathcal{N}} = \\text{span}\\{e_3, e_4\\}$。对偶系统的能观子空间为 $\\tilde{\\mathcal{O}} = \\tilde{\\mathcal{N}}^\\perp = \\text{span}\\{e_1, e_2\\}$，这与原系统的能控子空间 $\\mathcal{C}$ 相同。\n\n对偶系统的 Kalman 子空间为：\n$\\tilde{S}_{co} = \\tilde{\\mathcal{C}} \\cap \\tilde{\\mathcal{O}} = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_1\\}$。\n$\\tilde{S}_{cu} = \\tilde{\\mathcal{C}} \\cap \\tilde{\\mathcal{N}} = \\text{span}\\{e_1, e_3\\} \\cap \\text{span}\\{e_3, e_4\\} = \\text{span}\\{e_3\\}$。\n$\\tilde{S}_{uo} = \\tilde{\\mathcal{C}}^\\perp \\cap \\tilde{\\mathcal{O}} = \\text{span}\\{e_2, e_4\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_2\\}$。\n$\\tilde{S}_{uu} = \\tilde{\\mathcal{C}}^\\perp \\cap \\tilde{\\mathcal{N}} = \\text{span}\\{e_2, e_4\\} \\cap \\text{span}\\{e_3, e_4\\} = \\text{span}\\{e_4\\}$。\n维数都为 1。我们验证其对应关系：\n$\\dim(S_{co})=1$ 对应于 $\\dim(\\tilde{S}_{co})=1$。\n$\\dim(S_{cu})=1$ 对应于 $\\dim(\\tilde{S}_{uo})=1$。\n$\\dim(S_{uo})=1$ 对应于 $\\dim(\\tilde{S}_{cu})=1$。\n$\\dim(S_{uu})=1$ 对应于 $\\dim(\\tilde{S}_{uu})=1$。\n对偶对应关系得到确认。\n\n最后，我们计算标量 $s \\equiv \\det(A_{co})\\cdot \\det(A_{uu})$。\n从 $A_k$ 的分解中，我们得到 $1\\times1$ 矩阵 $A_{co}=(2)$ 和 $A_{uu}=(7)$。\n行列式的值分别为 $\\det(A_{co}) = 2$ 和 $\\det(A_{uu}) = 7$。\n乘积为 $s = 2 \\cdot 7 = 14$。", "answer": "$$\n\\boxed{14}\n$$", "id": "2703050"}]}