{"hands_on_practices": [{"introduction": "我们的第一个练习旨在通过让您手动应用和比较线性时不变（LTI）系统的两个基本可观测性检验方法，为后续学习打下坚实基础。通过一个具体的 $2 \\times 2$ 例子，您将计算Kalman能观测性矩阵的秩，然后独立地在每个特征值处应用Popov-Belevitch-Hautus (PBH) 检验。这项动手计算旨在帮助您建立对两种方法工作原理的扎实直觉，并在实践中验证它们的等价性 [@problem_id:2735989]。", "problem": "考虑一个状态维度为 $n=2$ 的连续时间线性时不变状态空间模型，由下式给出\n$$\\dot{x}(t)=A x(t), \\quad y(t)=C x(t),$$\n其中\n$$A=\\begin{pmatrix}4  -5\\\\ 2  -3\\end{pmatrix}, \\qquad C=\\begin{pmatrix}1  1\\end{pmatrix}.$$\n从系统的可观测性基本定义出发，即当且仅当不同的初始状态 $x(0)$ 产生不同的输出轨迹 $y(t)$（对于所有 $t \\ge 0$），完成以下操作：\n\n1. 仅使用此定义和线性性质，构建一个有限维线性映射，该映射将初始状态 $x(0)$ 映至在 $t=0$ 时求值的前 $n$ 个输出时间导数的堆叠向量，并针对给定的 $(A,C)$ 手动确定其秩。\n\n2. 独立地，根据相同的定义推断，满足 $\\dot{x}(t)=A x(t)$ 的齐次状态动态的任何非零模态都不能隐藏在输出 $y(t)$ 中，并将其转化为一个与 $A$ 的特征结构相关的可计算秩条件。针对给定的 $(A,C)$，为 $A$ 的每个特征值手动显式评估此条件。\n\n确认通过两种独立方法获得的整数秩相等。报告共同的秩值作为最终答案。无需四舍五入，不涉及物理单位。最终答案必须是单个整数。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统模型：连续时间线性时不变 (LTI)。\n- 状态空间方程：$\\dot{x}(t)=A x(t)$，$y(t)=C x(t)$。\n- 状态维度：$n=2$。\n- 系统矩阵：$A=\\begin{pmatrix}4  -5\\\\ 2  -3\\end{pmatrix}$，$C=\\begin{pmatrix}1  1\\end{pmatrix}$。\n- 可观测性的基本定义：当且仅当不同的初始状态 $x(0)$ 产生不同的输出轨迹 $y(t)$（对于所有 $t \\ge 0$）时，系统是可观测的。\n- 任务1：构建一个从 $x(0)$ 到在 $t=0$ 时的前 $n$ 个输出时间导数向量的线性映射，并为给定的 $(A, C)$ 确定其秩。\n- 任务2：根据相同的定义推断，齐次动态的任何非零模态都不能隐藏在输出中，将其转化为与 $A$ 的特征结构相关的秩条件，并为给定的 $(A, C)$ 的每个特征值评估此条件。\n- 目标：确认两种方法得到的秩一致，并报告共同的秩值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是线性控制理论中的一个标准练习。问题陈述清晰，提供了计算唯一整数结果所需的所有数据（$A$, $C$, $n$）。语言客观精确。问题不违反任何基本原理，不不完整或矛盾，并且与指定的可观测性秩检验主题直接相关。这是一个可形式化和可验证的问题。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n可观测性的基本定义指出，不同的初始状态 $x_1(0)$ 和 $x_2(0)$ 必须导致不同的输出轨迹 $y_1(t)$ 和 $y_2(t)$。根据线性系统的叠加原理，这等价于非零初始状态 $x(0) \\neq 0$ 必须在某个 $t \\ge 0$ 时产生非零输出轨迹 $y(t) \\neq 0$ 的条件。状态方程的解是 $x(t) = \\exp(At)x(0)$，它给出的输出是 $y(t) = C \\exp(At) x(0)$。因此，可观测性意味着 $C \\exp(At) x(0) = 0$ 对所有 $t \\ge 0$ 成立，当且仅当 $x(0) = 0$。\n\n**第1部分：通过输出导数判断可观测性 (Kalman秩条件)**\n如果输出 $y(t)$ 对所有 $t \\ge 0$ 恒为零，那么它的所有时间导数也必须对所有 $t \\ge 0$ 为零。我们在 $t=0$ 时对这些导数进行求值。\n输出为 $y(t) = C x(t)$。\n输出的一阶导数为 $\\dot{y}(t) = \\frac{d}{dt}(C x(t)) = C \\dot{x}(t) = C A x(t)$。\n一般地，第 $k$ 阶导数为 $y^{(k)}(t) = C A^k x(t)$。\n\n对于具有初始状态 $x(0)$ 的不可观测系统，其输出及其所有导数在 $t=0$ 时必须为零：\n$y(0) = C x(0) = 0$\n$\\dot{y}(0) = C A x(0) = 0$\n$\\ddot{y}(0) = C A^2 x(0) = 0$\n...\n根据 Cayley-Hamilton 定理，对于 $k \\ge n$ 的任何 $A^k$ 次幂都可以表示为 $\\{I, A, \\dots, A^{n-1}\\}$ 的线性组合。因此，仅需检查前 $n$ 个条件（从0阶到 $n-1$ 阶导数）。\n对于 $n=2$，我们需要在 $t=0$ 时求值的前 $n=2$ 个导数（0阶和1阶）的向量。这给出了从初始状态 $x(0)$ 到该导数向量的线性映射：\n$$ \\begin{pmatrix} y(0) \\\\ \\dot{y}(0) \\end{pmatrix} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} x(0) $$\n此映射由可观测性矩阵 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$ 表示。系统是可观测的，当且仅当唯一映射到零向量的 $x(0)$ 是 $x(0)=0$。这成立的充要条件是矩阵 $\\mathcal{O}$ 具有满列秩，即 $\\text{rank}(\\mathcal{O}) = n = 2$。\n\n我们现在为给定系统计算这个秩。\n给定 $A=\\begin{pmatrix}4  -5\\\\ 2  -3\\end{pmatrix}$ 和 $C=\\begin{pmatrix}1  1\\end{pmatrix}$。\n首先，我们计算乘积 $CA$：\n$$ CA = \\begin{pmatrix}1  1\\end{pmatrix} \\begin{pmatrix}4  -5\\\\ 2  -3\\end{pmatrix} = \\begin{pmatrix}(1)(4)+(1)(2)  (1)(-5)+(1)(-3)\\end{pmatrix} = \\begin{pmatrix}6  -8\\end{pmatrix} $$\n因此，可观测性矩阵 $\\mathcal{O}$ 为：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 6  -8 \\end{pmatrix} $$\n为了求这个 $2 \\times 2$ 矩阵的秩，我们计算它的行列式：\n$$ \\det(\\mathcal{O}) = (1)(-8) - (1)(6) = -8 - 6 = -14 $$\n由于 $\\det(\\mathcal{O}) = -14 \\neq 0$，该矩阵是可逆的，因此具有满秩。秩为 $2$。\n\n**第2部分：通过特征模态判断可观测性 (Popov-Belevitch-Hautus (PBH) 条件)**\n我们研究系统的一个动态模态被“隐藏”在输出中的条件。系统的一个模态对应于由 $A$ 的一个特征向量引发的轨迹。设 $v$ 是 $A$ 的一个特征向量，对应特征值为 $\\lambda$，使得 $Av = \\lambda v$ 且 $v \\neq 0$。\n如果初始状态为 $x(0) = v$，状态轨迹为 $x(t) = \\exp(At)v = \\exp(\\lambda t)v$。\n相应的输出为 $y(t) = C x(t) = C (\\exp(\\lambda t) v) = \\exp(\\lambda t) (Cv)$。\n为了使这个模态不可观测，其输出必须恒为零，即 $y(t)=0$ 对所有 $t$ 成立。由于 $\\exp(\\lambda t) \\neq 0$，这要求 $Cv = 0$。\n因此，系统是不可观测的，当且仅当存在一个 $A$ 的特征向量 $v$ 位于 $C$ 的零空间中。反之，系统是可观测的，当且仅当对于 $A$ 的每一个特征值 $\\lambda_i$，没有相应的特征向量 $v_i$ 满足 $Cv_i=0$。\n\n这个条件可以表示为一个秩检验。两个条件 $(\\lambda I - A)v = 0$（特征向量的定义）和 $Cv = 0$ 意味着向量 $v$ 同时位于 $(\\lambda I - A)$ 和 $C$ 的零空间中。这成立的充要条件是由这两个矩阵堆叠而成的矩阵不具有满列秩。因此，可观测性的条件是，对于 $A$ 的每个特征值 $\\lambda_i$，以下矩阵具有满列秩 $n$：\n$$ \\begin{pmatrix} \\lambda_i I - A \\\\ C \\end{pmatrix} $$\n我们对给定系统（其中 $n=2$）评估此条件。首先，我们通过求解特征方程 $\\det(\\lambda I - A)=0$ 来找到 $A$ 的特征值。\n$$ \\det\\left(\\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} - \\begin{pmatrix} 4  -5 \\\\ 2  -3 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} \\lambda-4  5 \\\\ -2  \\lambda+3 \\end{pmatrix} = 0 $$\n$$ (\\lambda-4)(\\lambda+3) - (5)(-2) = \\lambda^2 - \\lambda - 12 + 10 = \\lambda^2 - \\lambda - 2 = 0 $$\n对二次方程进行因式分解得到 $(\\lambda-2)(\\lambda+1)=0$。特征值为 $\\lambda_1=2$ 和 $\\lambda_2=-1$。\n\n我们现在为每个特征值检查秩条件。\n情况1：$\\lambda_1 = 2$。\n待检验的矩阵是：\n$$ M_1 = \\begin{pmatrix} 2I - A \\\\ C \\end{pmatrix} = \\begin{pmatrix} 2-4  5 \\\\ -2  2+3 \\\\ \\hline 1  1 \\end{pmatrix} = \\begin{pmatrix} -2  5 \\\\ -2  5 \\\\ 1  1 \\end{pmatrix} $$\n这是一个 $3 \\times 2$ 的矩阵。它的秩最多为 $2$。为了检查秩是否为 $2$，我们找一个行列式不为零的 $2 \\times 2$ 子矩阵。考虑由第一行和第三行组成的子矩阵：\n$$ \\det\\begin{pmatrix} -2  5 \\\\ 1  1 \\end{pmatrix} = (-2)(1) - (5)(1) = -2 - 5 = -7 \\neq 0 $$\n由于我们找到了一个非奇异的 $2 \\times 2$ 子矩阵，所以 $M_1$ 的秩为 $2$。对于 $\\lambda_1=2$，该条件满足。\n\n情况2：$\\lambda_2 = -1$。\n待检验的矩阵是：\n$$ M_2 = \\begin{pmatrix} -1I - A \\\\ C \\end{pmatrix} = \\begin{pmatrix} -1-4  5 \\\\ -2  -1+3 \\\\ \\hline 1  1 \\end{pmatrix} = \\begin{pmatrix} -5  5 \\\\ -2  2 \\\\ 1  1 \\end{pmatrix} $$\n同样，我们通过找一个非奇异的 $2 \\times 2$ 子矩阵来检查秩。使用第一行和第三行：\n$$ \\det\\begin{pmatrix} -5  5 \\\\ 1  1 \\end{pmatrix} = (-5)(1) - (5)(1) = -5 - 5 = -10 \\neq 0 $$\n$M_2$ 的秩也为 $2$。对于 $\\lambda_2=-1$，该条件满足。\n\n两种方法都证实了系统的可观测性。可观测性矩阵 $\\mathcal{O}$ 的秩为 $2$。PBH 检验确认对于每个特征值，检验矩阵的秩都为 $2$。共同的秩值为 $2$。", "answer": "$$\\boxed{2}$$", "id": "2735989"}, {"introduction": "在掌握了LTI系统的检验方法后，我们必须认识到它们的局限性。本练习提出了一个关键的反例：一个线性时变（LTV）系统，其动态特性与输出矩阵“同步”，从而隐藏了某个状态。您会发现，简单地“冻结时间”来应用PBH检验会错误地得出系统可观测的结论，然后您将通过计算可观测性格拉姆矩阵（适用于LTV系统的正确工具）来推翻这一结论 [@problem_id:2735982]。这个练习突显了检验理论工具背后假设条件的至关重要性。", "problem": "考虑一个状态为 $x(t) \\in \\mathbb{R}^{2}$、无输入动态且有输出的线性时变（LTV）系统\n$$\n\\dot{x}(t) = A(t)\\,x(t), \n\\qquad \ny(t) = C(t)\\,x(t),\n$$\n其中\n$$\nA(t) \\equiv \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}, \n\\qquad \nC(t) \\equiv \\begin{bmatrix} \\cos t  -\\sin t \\end{bmatrix}.\n$$\n你可以使用线性时变系统 $\\dot{x}(t)=A(t)x(t)$ 的状态转移矩阵 $\\Phi(t,s)$ 和有限时域可观测性格拉姆矩阵的标准定义\n$$\nW_{o}(t_{0},t_{1}) \\equiv \\int_{t_{0}}^{t_{1}} \\Phi(\\tau,t_{0})^{\\top}\\, C(\\tau)^{\\top} C(\\tau)\\, \\Phi(\\tau,t_{0}) \\, \\mathrm{d}\\tau.\n$$\n任务：\n- 仅使用基本定义，对每个固定的时间 $t \\in \\mathbb{R}$ 和所有复数 $\\lambda \\in \\mathbb{C}$，分析在冻结时间下的 Popov-Belevitch-Hautus (PBH) 检验矩阵的秩，即 $\\mathrm{rank}\\,\\begin{bmatrix} \\lambda I - A(t) \\\\ C(t) \\end{bmatrix}$，并解释这个冻结时间检查对于每个瞬间的可观测性会得出什么结论。\n- 然后，计算有限时域可观测性格拉姆矩阵 $W_{o}(0,2\\pi)$ 的行列式。\n\n将你的最终答案表示为 $W_{o}(0,2\\pi)$ 的行列式。无需单位，也无需四舍五入。你的推导过程必须从基本原理（$\\Phi$ 和 $W_{o}$ 的定义，以及标准的秩概念）出发，并且不应假定超出这些基础的任何专门的捷径条件。", "solution": "该问题提出了一个线性时变（LTV）系统，并要求进行两种不同的分析：使用 Popov-Belevitch-Hautus (PBH) 检验进行冻结时间可观测性检查，以及计算有限时域可观测性格拉姆矩阵的行列式。问题陈述在科学上是合理的且定义明确的。我们将开始进行求解。\n\n系统由 $\\dot{x}(t) = A(t)x(t)$ 和 $y(t) = C(t)x(t)$ 给出，矩阵为\n$$\nA(t) = A = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}, \\qquad C(t) = \\begin{bmatrix} \\cos t  -\\sin t \\end{bmatrix}.\n$$\n状态维度为 $n=2$。请注意，状态动态矩阵 $A(t)$ 实际上是常数。\n\n首先，我们分析在任意固定时间 $t \\in \\mathbb{R}$ 和任意复数 $\\lambda \\in \\mathbb{C}$ 下的冻结时间 PBH 矩阵的秩。对于配对 $(A, C(t))$ 的 PBH 矩阵是\n$$\nM(\\lambda, t) = \\begin{bmatrix} \\lambda I - A \\\\ C(t) \\end{bmatrix} = \\begin{bmatrix} \\lambda  -1 \\\\ 1  \\lambda \\\\ \\cos t  -\\sin t \\end{bmatrix}.\n$$\n这是一个 $3 \\times 2$ 的矩阵。为了使冻结时间系统可观测，该矩阵必须对于所有 $\\lambda \\in \\mathbb{C}$ 具有满列秩，即秩为 2。一个矩阵不满列秩当且仅当其列是线性相关的。$M(\\lambda, t)$ 的秩只有在 $\\det(\\lambda I - A) = 0$ 的情况下才会小于 2，这意味着 $\\lambda$ 必须是 $A$ 的一个特征值。$A$ 的特征方程是\n$$\n\\det(\\lambda I - A) = \\det \\begin{pmatrix} \\lambda  -1 \\\\ 1  \\lambda \\end{pmatrix} = \\lambda^2 + 1 = 0.\n$$\n特征值为 $\\lambda_1 = i$ 和 $\\lambda_2 = -i$。我们必须检查当 $\\lambda$ 取这些值时 $M(\\lambda, t)$ 的秩。\n\n情况 1：$\\lambda = i$。\nPBH 矩阵变为\n$$\nM(i, t) = \\begin{bmatrix} i  -1 \\\\ 1  i \\\\ \\cos t  -\\sin t \\end{bmatrix}.\n$$\n第一行是第二行的 $i$ 倍，因此前两行是线性相关的，正如预期的那样。该矩阵的秩小于 2 当且仅当第三行 $[\\cos t, -\\sin t]$ 也是前两行的线性组合。由于前两行张成一个由向量 $[1, i]$ 生成的一维子空间，秩亏的条件是 $[\\cos t, -\\sin t]$ 必须是 $[1, i]$ 的标量倍。\n$$\n[\\cos t, -\\sin t] = k [1, i] \\quad \\text{对于某个 } k \\in \\mathbb{C}.\n$$\n这意味着 $\\cos t = k$ 且 $-\\sin t = ki = (\\cos t)i$。为了使此式成立，我们必须有 $\\sin t = -i \\cos t$。如果 $\\cos t \\neq 0$，这给出 $\\tan t = -i$。实数 $t$ 的正切值不能是非实数的复数。如果 $\\cos t = 0$，则 $t = \\frac{\\pi}{2} + m\\pi$ 对于某个整数 $m$，这意味着 $\\sin t = \\pm 1$。该方程变为 $\\pm 1 = -i \\cdot 0$，或 $\\pm 1 = 0$，这是一个矛盾。因此，对于任何实数 $t$，向量 $[\\cos t, -\\sin t]$ 永远不是 $[1, i]$ 的倍数。$M(i, t)$ 的秩恒为 2。\n\n情况 2：$\\lambda = -i$。\nPBH 矩阵变为\n$$\nM(-i, t) = \\begin{bmatrix} -i  -1 \\\\ 1  -i \\\\ \\cos t  -\\sin t \\end{bmatrix}.\n$$\n类似地，前两行是线性相关的。秩小于 2 的条件是 $[\\cos t, -\\sin t]$ 是 $[1, -i]$ 的标量倍。\n$$\n[\\cos t, -\\sin t] = k [1, -i] \\quad \\text{对于某个 } k \\in \\mathbb{C}.\n$$\n这意味着 $\\cos t = k$ 且 $-\\sin t = -ki = -(\\cos t)i$，即 $\\sin t = i \\cos t$。如果 $\\cos t \\neq 0$，这给出 $\\tan t = i$，这对于实数 $t$ 是不可能的。如果 $\\cos t = 0$，我们再次得到矛盾 $\\pm 1 = 0$。$M(-i, t)$ 的秩恒为 2。\n\n由于 PBH 矩阵对于所有 $\\lambda \\in \\mathbb{C}$ 和所有 $t \\in \\mathbb{R}$ 都是满秩的，冻结时间分析得出的结论是，该系统在每个时刻都是可观测的。\n\n接下来，我们计算在区间 $[0, 2\\pi]$ 上的有限时域可观测性格拉姆矩阵 $W_o(t_0, t_1)$ 的行列式。定义为\n$$\nW_{o}(0, 2\\pi) = \\int_{0}^{2\\pi} \\Phi(\\tau, 0)^{\\top} C(\\tau)^{\\top} C(\\tau) \\Phi(\\tau, 0) \\, \\mathrm{d}\\tau.\n$$\n由于 $A$ 是一个常数矩阵，状态转移矩阵 $\\Phi(t, s)$ 由 $\\Phi(t, s) = \\exp(A(t-s))$ 给出。我们需要 $\\Phi(\\tau, 0) = \\exp(A\\tau)$。$A$ 的幂是 $A^2 = -I$，$A^3 = -A$，$A^4 = I$。使用矩阵指数的泰勒级数展开：\n$$\n\\exp(A\\tau) = I + A\\tau + \\frac{(A\\tau)^2}{2!} + \\frac{(A\\tau)^3}{3!} + \\dots = I \\left(1 - \\frac{\\tau^2}{2!} + \\frac{\\tau^4}{4!} - \\dots\\right) + A \\left(\\tau - \\frac{\\tau^3}{3!} + \\frac{\\tau^5}{5!} - \\dots\\right).\n$$\n这可以简化为 $\\exp(A\\tau) = I \\cos\\tau + A \\sin\\tau$。\n$$\n\\Phi(\\tau, 0) = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\cos\\tau + \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix} \\sin\\tau = \\begin{bmatrix} \\cos\\tau  \\sin\\tau \\\\ -\\sin\\tau  \\cos\\tau \\end{bmatrix}.\n$$\n被积函数的形式为 $K(\\tau) = (\\cdots)^\\top(\\cdots)$。先计算乘积 $C(\\tau)\\Phi(\\tau, 0)$ 在计算上更简单。\n$$\nC(\\tau)\\Phi(\\tau, 0) = \\begin{bmatrix} \\cos\\tau  -\\sin\\tau \\end{bmatrix} \\begin{bmatrix} \\cos\\tau  \\sin\\tau \\\\ -\\sin\\tau  \\cos\\tau \\end{bmatrix}.\n$$\n执行矩阵乘法得到：\n$$\nC(\\tau)\\Phi(\\tau, 0) = \\begin{bmatrix} \\cos^2\\tau + \\sin^2\\tau  \\cos\\tau\\sin\\tau - \\sin\\tau\\cos\\tau \\end{bmatrix} = \\begin{bmatrix} 1  0 \\end{bmatrix}.\n$$\n这个结果对所有 $\\tau$ 都是常数。这意味着输出 $y(\\tau)$ 仅依赖于初始状态 $x(0)$ 的第一个分量，因为 $y(\\tau) = C(\\tau)\\Phi(\\tau, 0)x(0) = [1, 0]x(0) = x_1(0)$。任何形式为 $[0, \\alpha]^\\top$ 的初始状态都会产生零输出，使得第二个状态分量不可观测。\n现在，我们可以计算格拉姆矩阵的被积矩阵：\n$$\n\\Phi(\\tau, 0)^{\\top} C(\\tau)^{\\top} C(\\tau) \\Phi(\\tau, 0) = \\left( C(\\tau) \\Phi(\\tau, 0) \\right)^{\\top} \\left( C(\\tau) \\Phi(\\tau, 0) \\right) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n被积函数是一个常数矩阵。可观测性格拉姆矩阵是在区间 $[0, 2\\pi]$ 上对这个常数矩阵的积分：\n$$\nW_{o}(0, 2\\pi) = \\int_{0}^{2\\pi} \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix} \\mathrm{d}\\tau = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix} \\int_{0}^{2\\pi} \\mathrm{d}\\tau = \\begin{bmatrix} 1  0 \\\\ 0  0 \\end{bmatrix} (2\\pi) = \\begin{bmatrix} 2\\pi  0 \\\\ 0  0 \\end{bmatrix}.\n$$\n问题要求计算这个格拉姆矩阵的行列式。\n$$\n\\det(W_{o}(0, 2\\pi)) = \\det\\left(\\begin{bmatrix} 2\\pi  0 \\\\ 0  0 \\end{bmatrix}\\right) = (2\\pi)(0) - (0)(0) = 0.\n$$\n一个奇异的可观测性格拉姆矩阵证实了该系统在区间 $[0, 2\\pi]$ 上是不可观测的。这为线性时变系统冻结时间分析的可靠性提供了一个关键的反例，因为 $C(t)$ 的时变与系统动态完美同步，从而掩盖了其中一个状态。", "answer": "$$\\boxed{0}$$", "id": "2735982"}, {"introduction": "我们最后的练习将从纸笔理论过渡到计算工程的现实。在浮点运算中，判断矩阵的秩是否满足条件是一项微妙的任务，对所选的数值容差高度敏感。通过一个引导性的编程练习，您将实现Kalman和PBH两种检验，并比较使用朴素的固定阈值与使用稳健的相对容差时的结果，从而揭示可靠的数值方法对于系统可观测性的可靠分析是何等重要 [@problem_id:2735971]。", "problem": "考虑一个线性时不变状态空间系统，其状态矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，输出矩阵为 $C \\in \\mathbb{R}^{p \\times n}$。可观测性是矩阵对 $(A,C)$ 的一个结构性质，定义为在零输入下，能否根据有限时间区间内的输出 $y(t)$ 重构出初始状态 $x(0)$。两个经典的可观测性秩检验如下：\n\n- Kalman能观测性矩阵检验：构建可观测性矩阵 $O = \\begin{bmatrix} C \\\\ C A \\\\ \\cdots \\\\ C A^{n-1} \\end{bmatrix} \\in \\mathbb{R}^{np \\times n}$。矩阵对 $(A,C)$ 是可观测的，当且仅当 $\\operatorname{rank}(O) = n$。\n\n- Popov-Belevitch-Hautus (PBH) 检验：对于 $A$ 的每个特征值 $\\lambda$，构建堆叠矩阵 $\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix} \\in \\mathbb{C}^{(n+p) \\times n}$。矩阵对 $(A,C)$ 是可观测的，当且仅当 $\\operatorname{rank}\\!\\left(\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix}\\right) = n$ 对 $A$ 的每个特征值 $\\lambda$（计入代数重数）都成立。\n\n在浮点运算中，确定矩阵的秩需要一个阈值来判断奇异值何时应被视为零。一种朴素的方法是使用一个固定的绝对阈值 $\\tau_{\\text{abs}} = 10^{-8}$，但这种方法在数据缩放的情况下可能会失效。一种更具原则性的方法是使用按矩阵范数缩放的相对容差；一个标准的选择是将矩阵 $M \\in \\mathbb{C}^{m \\times n}$ 的奇异值 $s_i$ 声明为非零，如果 $s_i  \\tau_{\\text{rel}}$，其中 $\\tau_{\\text{rel}} = s_{\\max}(M) \\cdot \\max(m,n) \\cdot \\epsilon_{\\text{mach}}$，$s_{\\max}(M)$ 是 $M$ 的最大奇异值，$\\epsilon_{\\text{mach}}$ 是双精度浮点数的机器 epsilon。\n\n任务：编写一个完整的程序，为每个提供的测试用例 $(A,C)$ 计算四个布尔值结果：\n1. 使用朴素绝对阈值的 Kalman检验。\n2. 使用按矩阵 2-范数缩放的原则性相对容差的 Kalman检验。\n3. 使用朴素绝对阈值的 PBH检验。\n4. 使用按矩阵 2-范数缩放的原则性相对容差的 PBH检验。\n\n你的程序必须通过奇异值分解和上述两种阈值策略来实现秩的计算。程序应使用双精度算术及其对应的机器 epsilon $\\epsilon_{\\text{mach}}$。\n\n测试套件：\n- 测试用例 1（良态，可观测）：\n  - $A_1 = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$，$C_1 = \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n- 测试用例 2（可观测，但输出被缩放到接近下溢以展示绝对阈值的失效）：\n  - $A_2 = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$，$C_2 = 10^{-12} \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n- 测试用例 3（精确不可观测）：\n  - $A_3 = \\begin{bmatrix} 0  1 \\\\ 0  0 \\end{bmatrix}$，$C_3 = \\begin{bmatrix} 0  1 \\end{bmatrix}$。\n- 测试用例 4（3 维，良态，可观测的友矩阵形式）：\n  - $A_4 = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -1  -1 \\end{bmatrix}$，$C_4 = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$。\n\n计算要求：\n- 通过奇异值实现数值秩的计算。对于朴素绝对阈值，当奇异值 $s  \\tau_{\\text{abs}}$ 且 $\\tau_{\\text{abs}} = 10^{-8}$ 时，将其视为非零。对于原则性准则，使用 $\\tau_{\\text{rel}} = s_{\\max}(M) \\cdot \\max(m,n) \\cdot \\epsilon_{\\text{mach}}$，其中 $M$ 是待评估秩的矩阵。\n- 对于 PBH 检验，数值计算 $A$ 的所有特征值 $\\lambda$，并对每个 $\\lambda$ 检查秩条件。\n-所有数学结果必须以双精度计算。不涉及物理单位或角度。\n\n最终输出格式：\n- 按顺序聚合四个测试用例的结果，每个测试用例按上述顺序列出四个布尔值，并将它们展平为一个长度为 16 的列表。\n- 你的程序应生成单行输出，其中包含用方括号括起来、以逗号分隔且不含空格的结果，例如：$[{\\rm True},{\\rm False},{\\rm True},{\\rm True},\\ldots]$。", "solution": "首先必须对问题陈述进行严格验证。\n\n**第 1 步：提取已知条件**\n\n- **系统模型**：一个线性时不变（LTI）系统，由状态矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和输出矩阵 $C \\in \\mathbb{R}^{p \\times n}$ 定义。\n- **Kalman能观测性检验**：矩阵对 $(A,C)$ 是可观测的，当且仅当可观测性矩阵 $O = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix}$ 具有满列秩，即 $\\operatorname{rank}(O) = n$。\n- **Popov-Belevitch-Hautus (PBH) 检验**：矩阵对 $(A,C)$ 是可观测的，当且仅当对于 $A$ 的每个特征值 $\\lambda$，矩阵 $\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix}$ 具有满列秩，即 $\\operatorname{rank}\\!\\left(\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix}\\right) = n$。\n- **数值秩计算**：\n  1. **朴素绝对阈值**：如果奇异值 $s  \\tau_{\\text{abs}}$，则认为其非零，其中 $\\tau_{\\text{abs}} = 10^{-8}$。\n  2. **原则性相对容差**：对于矩阵 $M \\in \\mathbb{C}^{m \\times n}$，如果奇异值 $s_i  \\tau_{\\text{rel}}$，则认为其非零，其中 $\\tau_{\\text{rel}} = s_{\\max}(M) \\cdot \\max(m,n) \\cdot \\epsilon_{\\text{mach}}$。这里 $s_{\\max}(M)$ 是 $M$ 的最大奇异值，$\\epsilon_{\\text{mach}}$ 是双精度浮点运算的机器 epsilon。\n- **任务**：为提供的四个测试用例中的每一个，计算四个布尔值结果，对应于两种检验（Kalman, PBH）分别使用两种秩计算方法（朴素法，原则法）进行评估。\n- **测试用例**：\n  - 用例 1：$A_1 = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$，$C_1 = \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n  - 用例 2：$A_2 = \\begin{bmatrix} 0  1 \\\\ -2  -3 \\end{bmatrix}$，$C_2 = 10^{-12} \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n  - 用例 3：$A_3 = \\begin{bmatrix} 0  1 \\\\ 0  0 \\end{bmatrix}$，$C_3 = \\begin{bmatrix} 0  1 \\end{bmatrix}$。\n  - 用例 4：$A_4 = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -1  -1  -1 \\end{bmatrix}$，$C_4 = \\begin{bmatrix} 1  0  0 \\end{bmatrix}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n对问题的有效性进行审查。\n- **科学依据**：该问题基于控制理论（Kalman 和 PBH 可观测性检验）和数值线性代数（数值秩，SVD）中的基本和标准结果。这些是已确立并被普遍接受的原则。该问题在科学上是合理的。\n- **适定性**：问题提供了所有必要的信息：每个测试用例的系统矩阵、检验的精确定义，以及数值秩阈值的确切公式。任务定义清晰，可以计算出唯一解。\n- **客观性**：问题使用客观的数学语言表达，没有歧义或主观论断。\n\n问题没有表现出任何指定的缺陷，例如科学上不合理、不完整或矛盾。它是在指定控制理论领域内一个定义明确的计算问题。\n\n**第 3 步：结论与行动**\n\n问题被判定为**有效**。我们将继续提供完整的解决方案。\n\n**解法推导**\n\n解决方案需要实现 Kalman 和 PBH 可观测性检验。对于每个检验，必须计算特定矩阵的秩，并与状态维度 $n$ 进行比较。问题的核心在于使用两种不同的容差策略进行秩的数值计算。\n\n**通过 SVD 计算数值秩**\n\n矩阵 $M \\in \\mathbb{C}^{m \\times n}$ 的秩是其非零奇异值的数量。在浮点运算中，解析上为零的奇异值可能会被计算为小的非零数。因此，需要一个阈值来确定数值秩。$M$ 的奇异值分解（SVD）提供了其奇异值 $s_1 \\geq s_2 \\geq \\dots \\geq s_{\\min(m,n)} \\geq 0$。数值秩是大于所选容差 $\\tau$ 的奇异值 $s_i$ 的数量。\n\n1.  **朴素绝对阈值**：容差是一个固定值，$\\tau_{\\text{abs}} = 10^{-8}$。秩是 $s_i  \\tau_{\\text{abs}}$ 的数量。这种方法简单但对缩放不鲁棒，因为一个缩小尺度矩阵的小奇异值即使矩阵是满秩的，也可能低于阈值。\n\n2.  **原则性相对容差**：容差相对于矩阵属性进行缩放：$\\tau_{\\text{rel}} = s_1 \\cdot \\max(m,n) \\cdot \\epsilon_{\\text{mach}}$，其中 $s_1 = s_{\\max}(M)$ 是最大奇异值，$\\epsilon_{\\text{mach}}$ 是机器 epsilon（从 $1.0$ 到下一个可表示的更大数之间的距离）。这种方法能适应矩阵元素的大小，是高质量数值软件中的标准方法。\n\n我们将实现一个函数，使用这两种方法来计算秩。\n\n**Kalman能观测性检验**\n\n对于一个状态维度为 $n$、输出维度为 $p$ 的系统 $(A,C)$，可观测性矩阵构建如下：\n$$ O = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix} \\in \\mathbb{R}^{np \\times n} $$\n如果 $\\operatorname{rank}(O) = n$，则系统是可观测的。\nKalman 检验的算法如下：\n1.  给定 $A$ 和 $C$，确定 $n = \\operatorname{dim}(A)$。\n2.  通过计算矩阵幂 $A^k$ 和乘积 $CA^k$（其中 $k = 0, \\dots, n-1$），并垂直堆叠结果来构建矩阵 $O$。\n3.  使用朴素阈值计算 $\\operatorname{rank}(O)$，并检查它是否等于 $n$。\n4.  使用原则性阈值计算 $\\operatorname{rank}(O)$，并检查它是否等于 $n$。\n\n**Popov-Belevitch-Hautus (PBH) 可观测性检验**\n\nPBH 检验为可观测性提供了另一种频域条件。系统是可观测的，当且仅当对于矩阵 $A$ 的每个特征值 $\\lambda \\in \\mathbb{C}$，以下秩条件成立：\n$$ \\operatorname{rank}\\left(\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix}\\right) = n $$\n矩阵 $\\begin{bmatrix} \\lambda I - A \\\\ C \\end{bmatrix}$ 是一个 $(n+p) \\times n$ 的矩阵。由于特征值 $\\lambda$ 可能是复数，该矩阵通常是复值矩阵。SVD 对复数矩阵定义良好，其奇异值是实数且非负。\nPBH 检验的算法如下：\n1.  给定 $A$ 和 $C$，确定 $n = \\operatorname{dim}(A)$。\n2.  数值计算 $A$ 的所有特征值 $\\lambda_1, \\dots, \\lambda_n$。\n3.  对于每种秩方法（朴素法，原则法），将可观测性标志初始化为 `True`。\n4.  遍历每个特征值 $\\lambda_j$：\n    a. 构建 PBH 矩阵 $M_j = \\begin{bmatrix} \\lambda_j I - A \\\\ C \\end{bmatrix}$。\n    b. 使用所选方法计算 $M_j$ 的秩。\n    c. 如果秩小于 $n$，则该特征值的检验失败。将相应的可观测性标志设置为 `False`，并且可以终止该方法的循环。\n5.  检查完所有特征值后，每种方法的最终结果是其可观测性标志的值。\n\n**每个测试用例的算法步骤**\n\n对于测试套件中提供的每一对 $(A, C)$：\n1.  令 $n$ 为 $A$ 的行数/列数。\n2.  **Kalman 检验（朴素法）**：构建 $O$。使用 $\\tau_{\\text{abs}}$ 计算其秩。如果秩等于 $n$，结果为 `True`，否则为 `False`。\n3.  **Kalman 检验（原则法）**：构建 $O$。使用 $\\tau_{\\text{rel}}$ 计算其秩。如果秩等于 $n$，结果为 `True`，否则为 `False`。\n4.  **PBH 检验（朴素法）**：计算 $A$ 的特征值。对于每个特征值 $\\lambda$，构建 $M_\\lambda$ 并使用 $\\tau_{\\text{abs}}$ 计算其秩。如果所有特征值的秩都为 $n$，则最终结果为 `True`，否则为 `False`。\n5.  **PBH 检验（原则法）**：计算 $A$ 的特征值。对于每个特征值 $\\lambda$，构建 $M_\\lambda$ 并使用 $\\tau_{\\text{rel}}$ 计算其秩。如果所有特征值的秩都为 $n$，则最终结果为 `True`，否则为 `False`。\n6.  按指定顺序收集四个布尔值结果。\n\n此过程将应用于所有四个测试用例，结果将汇总到一个列表中作为最终输出。实现将使用双精度浮点数 (`numpy.double`) 和相应的机器 epsilon。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rank(M, method, abs_tol=1e-8):\n    \"\"\"\n    Computes the numerical rank of a matrix using SVD and a specified tolerance method.\n\n    Args:\n        M (np.ndarray): The matrix (real or complex) whose rank is to be computed.\n        method (str): The method for thresholding. Must be 'naive' or 'principled'.\n        abs_tol (float): The absolute tolerance for the 'naive' method.\n\n    Returns:\n        int: The numerical rank of the matrix.\n    \"\"\"\n    if M.size == 0:\n        return 0\n\n    s = np.linalg.svd(M, compute_uv=False)\n    \n    # s is sorted in descending order. s[0] is the largest singular value.\n    if s.size == 0:\n        return 0\n\n    if method == 'naive':\n        tol = abs_tol\n    elif method == 'principled':\n        eps_mach = np.finfo(s.dtype).eps\n        m, n = M.shape\n        # According to standard literature (e.g., Golub  Van Loan), the tolerance is\n        # relative to the largest singular value and matrix dimensions.\n        tol = s[0] * max(m, n) * eps_mach\n    else:\n        raise ValueError(\"Unknown method for rank computation. Must be 'naive' or 'principled'.\")\n\n    return np.sum(s > tol)\n\ndef check_observability(A, C):\n    \"\"\"\n    Performs four observability checks on the pair (A, C) and returns the boolean results.\n    \n    The four checks are:\n    1. Kalman test with naive absolute threshold.\n    2. Kalman test with principled relative tolerance.\n    3. PBH test with naive absolute threshold.\n    4. PBH test with principled relative tolerance.\n    \n    Args:\n        A (np.ndarray): The state matrix (n x n).\n        C (np.ndarray): The output matrix (p x n).\n        \n    Returns:\n        list[bool]: A list of four boolean values representing the outcomes of the tests.\n    \"\"\"\n    n, _ = A.shape\n    p = C.shape[0] if C.ndim > 1 else 1\n\n    # --- Kalman Test ---\n    # Construct observability matrix O\n    O = np.zeros((n * p, n), dtype=np.double)\n    O[0:p, :] = C\n    CA_power = C\n    for i in range(1, n):\n        CA_power = CA_power @ A\n        O[i*p:(i+1)*p, :] = CA_power\n\n    # 1. Kalman test with naive threshold\n    rank_kalman_naive = compute_rank(O, method='naive')\n    is_obs_kalman_naive = (rank_kalman_naive == n)\n\n    # 2. Kalman test with principled threshold\n    rank_kalman_principled = compute_rank(O, method='principled')\n    is_obs_kalman_principled = (rank_kalman_principled == n)\n    \n    # --- PBH Test ---\n    eigenvalues = np.linalg.eigvals(A)\n    \n    # 3. PBH test with naive threshold\n    is_obs_pbh_naive = True\n    for lam in eigenvalues:\n        # Construct PBH matrix for eigenvalue lam\n        M_lam = np.vstack((lam * np.eye(n, dtype=np.complex128) - A, C))\n        if compute_rank(M_lam, method='naive')  n:\n            is_obs_pbh_naive = False\n            break\n            \n    # 4. PBH test with principled threshold\n    is_obs_pbh_principled = True\n    for lam in eigenvalues:\n        # Construct PBH matrix for eigenvalue lam\n        M_lam = np.vstack((lam * np.eye(n, dtype=np.complex128) - A, C))\n        if compute_rank(M_lam, method='principled')  n:\n            is_obs_pbh_principled = False\n            break\n            \n    return [is_obs_kalman_naive, is_obs_kalman_principled, is_obs_pbh_naive, is_obs_pbh_principled]\n\n\ndef solve():\n    \"\"\"\n    Defines test cases, runs observability checks, and prints the aggregated results.\n    \"\"\"\n    # Define the test cases from the problem statement using double precision.\n    test_cases = [\n        # Case 1: well-conditioned, observable\n        (np.array([[0, 1], [-2, -3]], dtype=np.double), \n         np.array([[1, 0]], dtype=np.double)),\n        # Case 2: observable, scaled near underflow\n        (np.array([[0, 1], [-2, -3]], dtype=np.double), \n         1e-12 * np.array([[1, 0]], dtype=np.double)),\n        # Case 3: exactly unobservable\n        (np.array([[0, 1], [0, 0]], dtype=np.double), \n         np.array([[0, 1]], dtype=np.double)),\n        # Case 4: dimension 3, observable companion form\n        (np.array([[0, 1, 0], [0, 0, 1], [-1, -1, -1]], dtype=np.double), \n         np.array([[1, 0, 0]], dtype=np.double)),\n    ]\n\n    all_results = []\n    for A, C in test_cases:\n        results = check_observability(A, C)\n        all_results.extend(results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2735971"}]}