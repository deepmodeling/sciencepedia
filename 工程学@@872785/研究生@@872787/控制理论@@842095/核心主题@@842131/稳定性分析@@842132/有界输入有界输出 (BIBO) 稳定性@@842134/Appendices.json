{"hands_on_practices": [{"introduction": "本章的第一个练习旨在为有界输入有界输出（BIBO）稳定性奠定理论基石。我们将通过分析一个简单的离散时间系统，从第一性原理出发，严格推导BIBO稳定性的核心条件。这项实践清晰地揭示了，若一个系统的脉冲响应是绝对可加的（其 $\\ell_1$ 范数有限），则该系统是BIBO稳定的，并且这个范数本身恰好是输出的最紧上界 [@problem_id:2691125]。", "problem": "考虑一个因果离散时间线性时不变（LTI）系统，其冲激响应定义为 $h[k]=\\alpha^{k}$（当 $k \\ge 0$ 时）和 $h[k]=0$（当 $k0$ 时），其中 $\\alpha \\in \\mathbb{C}$ 满足 $|\\alpha|1$。对于任何在上确界范数下有界的输入 $u[n]$，其输出由卷积 $y[n]=\\sum_{k=-\\infty}^{\\infty}h[k]\\,u[n-k]$ 给出。请仅使用卷积的定义、三角不等式、上确界范数的性质以及关于几何级数的熟知事实，完成以下任务：\n\n1) 计算冲激响应的 $\\ell_{1}$ 范数，即 $\\sum_{k=0}^{\\infty}|h[k]|$。\n\n2) 从卷积表示和有界输入有界输出（BIBO）稳定性的定义出发，推导出一个边界常数 $K$，使得对于每个满足 $\\|u\\|_{\\infty}\\le 1$ 的输入 $u[n]$，其产生的输出满足 $\\|y\\|_{\\infty}\\le K$。请确定这种最小的 $K$ 的闭式解。\n\n将你的最终答案表示为一个双元素行矩阵，其中第一个元素是 $\\sum_{k=0}^{\\infty}|h[k]|$ 的值，第二个元素是最小的 $K$。无需数值取整，也不涉及单位。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- 系统类型：因果、离散时间、线性时不变（LTI）。\n- 冲激响应：$h[k]=\\alpha^{k}$ (当 $k \\ge 0$) 且 $h[k]=0$ (当 $k0$)。\n- 参数 $\\alpha$：一个复数，$\\alpha \\in \\mathbb{C}$，满足条件 $|\\alpha|1$。\n- 输入：$u[n]$ 是一个在上确界范数下有界的信号，$\\|u\\|_{\\infty} = \\sup_{n \\in \\mathbb{Z}} |u[n]|  \\infty$。\n- 输出：卷积和 $y[n]=\\sum_{k=-\\infty}^{\\infty}h[k]\\,u[n-k]$。\n- 方法限制：仅使用卷积的定义、三角不等式、上确界范数的性质以及关于几何级数的熟知事实。\n- 任务 1：计算冲激响应的 $\\ell_{1}$ 范数，其定义为 $\\sum_{k=0}^{\\infty}|h[k]|$。\n- 任务 2：对于任意满足 $\\|u\\|_{\\infty}\\le 1$ 的输入 $u[n]$，找到最小常数 $K$，使得输出满足 $\\|y\\|_{\\infty}\\le K$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是控制理论和信号处理中的一个基础练习，特别涉及 LTI 系统的 BIBO 稳定性。冲激响应的 $\\ell_1$ 范数与系统算子的诱导 $\\ell_\\infty$ 范数之间的关系是该领域的基石。所有定义和前提都是标准的、科学上合理的。\n- **适定性**：该问题是适定的。条件 $|\\alpha|1$ 确保了所涉及级数的收敛，从而保证了唯一且有限的解。任务定义清晰，在数学上是可解的。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何歧义或主观性。\n\n**第 3 步：结论与行动**\n- **结论**：问题有效。它在科学上是合理的、适定的且客观的。\n- **行动**：继续求解。\n\n根据要求，解题过程分为两部分。\n\n**第 1 部分：计算冲激响应的 $\\ell_{1}$ 范数**\n冲激响应 $h[k]$ 的 $\\ell_1$ 范数定义为 $\\|h\\|_1 = \\sum_{k=-\\infty}^{\\infty} |h[k]|$。\n已知系统是因果的，因此对于所有 $k0$，$h[k]=0$。求和可以限制在非负索引上：\n$$ \\|h\\|_1 = \\sum_{k=0}^{\\infty} |h[k]| $$\n对于 $k \\ge 0$ 的冲激响应为 $h[k]=\\alpha^k$。将其代入求和式中得到：\n$$ \\|h\\|_1 = \\sum_{k=0}^{\\infty} |\\alpha^k| $$\n使用复数模的性质 $|\\alpha^k| = |\\alpha|^k$，我们有：\n$$ \\|h\\|_1 = \\sum_{k=0}^{\\infty} |\\alpha|^k $$\n这是一个首项为 $|\\alpha|^0 = 1$、公比为 $r=|\\alpha|$ 的几何级数。问题陈述中说明了 $|\\alpha|1$。当且仅当 $|r|1$ 时，几何级数 $\\sum_{k=0}^{\\infty} r^k$ 收敛于 $\\frac{1}{1-r}$。由于此条件已满足，级数和收敛于：\n$$ \\sum_{k=0}^{\\infty} |h[k]| = \\frac{1}{1 - |\\alpha|} $$\n\n**第 2 部分：推导最小边界常数 K**\n我们寻找最小常数 $K$，使得对于任何满足 $\\|u\\|_{\\infty} \\le 1$ 的输入 $u[n]$，输出 $y[n]$ 满足 $\\|y\\|_{\\infty} \\le K$。范数 $\\|y\\|_{\\infty}$ 定义为 $\\sup_{n \\in \\mathbb{Z}} |y[n]|$。\n\n输出 $y[n]$ 由卷积和给出：\n$$ y[n] = \\sum_{k=-\\infty}^{\\infty} h[k] u[n-k] $$\n由于系统是因果的，该和变为：\n$$ y[n] = \\sum_{k=0}^{\\infty} h[k] u[n-k] $$\n为了找到 $\\|y\\|_{\\infty}$ 的一个界，我们首先找到对于任意整数 $n$ 的 $|y[n]|$ 的一个界。对两边取绝对值：\n$$ |y[n]| = \\left| \\sum_{k=0}^{\\infty} h[k] u[n-k] \\right| $$\n应用三角不等式 $|\\sum_{i} z_i| \\le \\sum_{i} |z_i|$，我们得到：\n$$ |y[n]| \\le \\sum_{k=0}^{\\infty} |h[k] u[n-k]| $$\n使用性质 $|ab| = |a||b|$，这变为：\n$$ |y[n]| \\le \\sum_{k=0}^{\\infty} |h[k]| |u[n-k]| $$\n输入有界，满足 $\\|u\\|_{\\infty} \\le 1$，这意味着对于所有整数 $m$，$|u[m]| \\le 1$。因此，对于任何 $n$ 和 $k$，都有 $|u[n-k]| \\le 1$。将此代入不等式：\n$$ |y[n]| \\le \\sum_{k=0}^{\\infty} |h[k]| \\cdot 1 = \\sum_{k=0}^{\\infty} |h[k]| $$\n右侧是冲激响应的 $\\ell_1$ 范数 $\\|h\\|_1$，我们在第 1 部分中已经计算过。这个界对任何 $n$ 都成立。因此，$|y[n]|$ 对所有 $n$ 的上确界也必须小于或等于此值：\n$$ \\|y\\|_{\\infty} = \\sup_{n \\in \\mathbb{Z}} |y[n]| \\le \\sum_{k=0}^{\\infty} |h[k]| = \\frac{1}{1-|\\alpha|} $$\n这就确定了 $K = \\frac{1}{1-|\\alpha|}$ 是一个有效的界。\n\n为了证明这是最小（即最紧）的可能界，我们必须证明对于某个满足 $\\|u\\|_{\\infty} \\le 1$ 的输入 $u[n]$，可以达到这个界。根据定义，所有有效输入的输出范数的上确界是系统算子的诱导范数，已知该范数为 $\\|h\\|_1$。我们将构造一个输入来达到这个输出幅度。\n\n考虑一个特定时刻的输出，例如 $n=0$：\n$$ y[0] = \\sum_{k=0}^{\\infty} h[k] u[-k] $$\n我们希望选择输入序列 $u[-k]$ 以最大化 $|y[0]|$。如果我们选择使得所有项 $h[k]u[-k]$ 都具有相同的相位，那么之前使用的三角不等式 $|y[0]| \\le \\sum_{k=0}^{\\infty} |h[k]||u[-k]|$ 将变为等式。\n我们选择输入 $u[-k]$ 为 $h[k]$ 符号（sign）的复共轭，即当 $h[k] \\neq 0$ 时，$u[-k] = \\frac{h^*[k]}{|h[k]|}$。\n因此，我们定义输入信号 $u[m]$ 如下：\n$$ u[m] = \\begin{cases} \\frac{h^*[-m]}{|h^*[-m]|}  \\text{当 } m \\le 0 \\text{ 且 } h[-m] \\neq 0 \\\\ 0  \\text{其他情况} \\end{cases} $$\n对于我们特定的冲激响应 $h[k]=\\alpha^k$，我们有对于所有 $k \\ge 0$，$h[k] \\neq 0$。因此对于 $m \\le 0$，我们有 $-m \\ge 0$，可以定义输入为：\n$$ u[m] = \\frac{(\\alpha^{-m})^*}{|\\alpha^{-m}|} = \\frac{(\\alpha^*)^{-m}}{|\\alpha|^{-m}} \\quad \\text{当 } m \\le 0 $$\n并且对于 $m > 0$，$u[m]=0$。对于此输入，当 $m \\le 0$ 时 $|u[m]|=1$，当 $m > 0$ 时 $|u[m]|=0$。因此，$\\|u\\|_{\\infty} = 1$，这是一个用于我们分析的有效输入。\n\n现在，我们计算这个特定输入下的输出 $y[0]$：\n$$ y[0] = \\sum_{k=0}^{\\infty} h[k] u[-k] = \\sum_{k=0}^{\\infty} h[k] \\frac{h^*[k]}{|h^*[k]|} = \\sum_{k=0}^{\\infty} \\frac{|h[k]|^2}{|h[k]|} = \\sum_{k=0}^{\\infty} |h[k]| $$\n这表明对于这个特定的输入，在时刻 $n=0$ 的输出幅度恰好等于 $\\|h\\|_1$。\n由于 $\\|y\\|_{\\infty} = \\sup_n |y[n]| \\ge |y[0]|$，我们有 $\\|y\\|_{\\infty} \\ge \\sum_{k=0}^{\\infty} |h[k]|$。\n\n结合我们的两个发现：\n1. 对于所有满足 $\\|u\\|_{\\infty} \\le 1$ 的输入，有 $\\|y\\|_{\\infty} \\le \\sum_{k=0}^{\\infty} |h[k]|$。\n2. 存在一个满足 $\\|u\\|_{\\infty} = 1$ 的输入，使得 $\\|y\\|_{\\infty} \\ge \\sum_{k=0}^{\\infty} |h[k]|$。\n\n这证明了边界常数 $K$ 的最小可能值恰好是冲激响应的 $\\ell_1$ 范数。\n$$ K_{\\min} = \\sum_{k=0}^{\\infty} |h[k]| = \\frac{1}{1-|\\alpha|} $$\n第一个要求的值是 $\\sum_{k=0}^{\\infty}|h[k]|$，即 $\\frac{1}{1-|\\alpha|}$。第二个要求的值是最小的 $K$，也是 $\\frac{1}{1-|\\alpha|}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{1-|\\alpha|}  \\frac{1}{1-|\\alpha|} \\end{pmatrix}}\n$$", "id": "2691125"}, {"introduction": "在建立了稳定性的核心条件后，我们接下来将探索当该条件被违反时的情形。这个练习将展示一个极点位于虚轴上的系统，这是一个典型的临界稳定案例。通过施加一个简单的有界输入并利用卷积积分显式地计算输出，你将亲眼见证这样一个系统如何产生一个无界输出，从而证明它不具备BIBO稳定性 [@problem_id:2691088]。", "problem": "考虑一个由有理传递函数描述的连续时间线性时不变 (LTI) 系统。你需要构建一个明确的例子，其极点位于闭合左半复平面，并在原点处包含一个单极点，然后运用第一性原理证明有界输入可以产生无界输出，从而表明该系统不是有界输入有界输出 (BIBO) 稳定的。完全基于基本定义进行推导：LTI 系统的卷积表示和拉普拉斯逆变换。除了这些定义之外，不要假定任何稳定性判据。\n\n执行以下步骤：\n\n1. 定义传递函数为 $G(s) = \\dfrac{s+2}{s(s+1)}$，并验证所有极点都位于闭合左半平面，且在 $s=0$ 处存在一个单极点。\n\n2. 通过对 $G(s)$ 进行拉普拉斯逆变换来计算冲激响应 $h(t)$，并使用亥维赛阶跃函数 $H(t)$（其中当 $t \\ge 0$ 时，$H(t)=1$，当 $t0$ 时，$H(t)=0$）明确写出其在 $t \\ge 0$ 时的表达式。\n\n3. 选择有界输入 $x(t) = H(t)$，并使用卷积积分显式计算出在 $t \\ge 0$ 时的相应输出 $y(t) = (h * x)(t)$。根据你的表达式直接证明当 $t \\to \\infty$ 时，$y(t)$ 是无界的。\n\n将你最终的答案以适用于 $t \\ge 0$ 的单一闭式表达式 $y(t)$ 给出。不需要进行数值舍入，也不涉及物理单位。", "solution": "对问题陈述进行验证。\n\n**第1步：提取的已知条件**\n- 系统描述：连续时间线性时不变 (LTI)。\n- 传递函数: $G(s) = \\dfrac{s+2}{s(s+1)}$。\n- 任务1：验证极点位于闭合左半复平面，且在 $s=0$ 处有一个单极点。\n- 任务2：使用 $G(s)$ 的拉普拉斯逆变换计算在 $t \\ge 0$ 时的冲激响应 $h(t)$。亥维赛阶跃函数定义为当 $t \\ge 0$ 时，$H(t)=1$；当 $t0$ 时，$H(t)=0$。\n- 任务3：使用有界输入 $x(t) = H(t)$ 和卷积积分 $y(t) = (h * x)(t)$ 来计算在 $t \\ge 0$ 时的输出 $y(t)$。\n- 任务4：从 $y(t)$ 的表达式中证明当 $t \\to \\infty$ 时输出是无界的。\n- 要求的最终答案：适用于 $t \\ge 0$ 的 $y(t)$ 的闭式表达式。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确，且客观。这是LTI系统和控制理论研究中的一个标准、基础的练习，特别涉及有界输入有界输出 (BIBO) 稳定性的概念。传递函数、输入和分析方法都已明确指定。问题不包含任何科学矛盾、歧义或缺失的信息。它要求从第一性原理进行论证，这是一项合理且具有指导意义的教学任务。\n\n**第3步：结论与行动**\n问题被判定为**有效**。现在将构建一个严谨的解答。\n\n我们开始分析。该问题是基本原理的直接应用，不需要高级定理，只需要细致的计算。\n\n首先，我们分析给定传递函数 $G(s) = \\dfrac{s+2}{s(s+1)}$ 的极点。极点是分母多项式 $s(s+1) = 0$ 的根。该方程产生两个极点：$s_1 = 0$ 和 $s_2 = -1$。$s_1 = 0$ 处的极点是位于虚轴上原点处的单极点。$s_2 = -1$ 处的极点是位于开左半复平面的单极点。因此，该系统的所有极点都位于包含虚轴的闭合左半平面。问题陈述的条件得到满足。\n\n接下来，我们计算冲激响应 $h(t)$，它是 $G(s)$ 的拉普拉斯逆变换。为此，我们首先对 $G(s)$ 进行部分分式展开：\n$$ G(s) = \\frac{s+2}{s(s+1)} = \\frac{A}{s} + \\frac{B}{s+1} $$\n系数 $A$ 和 $B$ 使用留数法求得。\n对于系数 $A$：\n$$ A = \\lim_{s \\to 0} s G(s) = \\lim_{s \\to 0} s \\frac{s+2}{s(s+1)} = \\lim_{s \\to 0} \\frac{s+2}{s+1} = \\frac{0+2}{0+1} = 2 $$\n对于系数 $B$：\n$$ B = \\lim_{s \\to -1} (s+1) G(s) = \\lim_{s \\to -1} (s+1) \\frac{s+2}{s(s+1)} = \\lim_{s \\to -1} \\frac{s+2}{s} = \\frac{-1+2}{-1} = -1 $$\n因此，展开后的传递函数是：\n$$ G(s) = \\frac{2}{s} - \\frac{1}{s+1} $$\n现在，我们求冲激响应 $h(t) = \\mathcal{L}^{-1}\\{G(s)\\}$。利用标准的拉普拉斯变换对和变换的线性性质，并应用给定的亥维赛函数 $H(t)$ 的定义：\n$$ h(t) = \\mathcal{L}^{-1}\\left\\{\\frac{2}{s}\\right\\} - \\mathcal{L}^{-1}\\left\\{\\frac{1}{s+1}\\right\\} = 2 H(t) - \\exp(-t) H(t) $$\n对于 $t \\ge 0$，这可简化为：\n$$ h(t) = 2 - \\exp(-t) $$\n\n下一步是证明有界输入可以产生无界输出。我们选择有界输入 $x(t) = H(t)$，即单位阶跃函数。对于所有 $t$，该输入的幅值都有界，即 $|x(t)| \\le 1$。输出 $y(t)$ 是冲激响应 $h(t)$ 与输入 $x(t)$ 的卷积：\n$$ y(t) = (h * x)(t) = \\int_{-\\infty}^{\\infty} h(\\tau) x(t-\\tau) d\\tau $$\n代入 $h(t)$ 和 $x(t)$ 的表达式：\n$$ y(t) = \\int_{-\\infty}^{\\infty} [ (2 - \\exp(-\\tau))H(\\tau) ] [ H(t-\\tau) ] d\\tau $$\n亥维赛函数之积 $H(\\tau)H(t-\\tau)$ 仅在 $\\tau \\ge 0$ 且 $t-\\tau \\ge 0$ 时等于 $1$，这等价于区间 $0 \\le \\tau \\le t$。这对 $t \\ge 0$ 成立。对于 $t  0$，积分为 $0$。我们关心的是系统在 $t \\ge 0$ 时的行为。积分变为：\n$$ y(t) = \\int_{0}^{t} (2 - \\exp(-\\tau)) d\\tau \\quad \\text{for } t \\ge 0 $$\n我们计算这个初等积分：\n$$ y(t) = \\left[ 2\\tau - (-\\exp(-\\tau)) \\right]_{0}^{t} = \\left[ 2\\tau + \\exp(-\\tau) \\right]_{0}^{t} $$\n$$ y(t) = (2t + \\exp(-t)) - (2(0) + \\exp(-0)) = (2t + \\exp(-t)) - (0 + 1) $$\n$$ y(t) = 2t + \\exp(-t) - 1 $$\n这就是在 $t \\ge 0$ 时输出 $y(t)$ 的闭式表达式。\n\n最后，我们必须证明该输出是无界的。我们考察当 $t \\to \\infty$ 时 $y(t)$ 的极限：\n$$ \\lim_{t \\to \\infty} y(t) = \\lim_{t \\to \\infty} (2t + \\exp(-t) - 1) $$\n当 $t \\to \\infty$ 时，项 $2t$ 无界增长 ($2t \\to \\infty$)，而项 $\\exp(-t)$ 衰减到零 ($\\exp(-t) \\to 0$)。因此：\n$$ \\lim_{t \\to \\infty} y(t) = \\infty $$\n输出 $y(t)$ 是无界的。我们使用了一个有界输入 $x(t) = H(t)$，并产生了一个无界输出。这通过构造并从第一性原理证明了该系统不是有界输入有界输出 (BIBO) 稳定的。这个结果是位于原点的极点的直接后果，该极点起着积分器的作用。阶跃输入提供了一个恒定值，该值随时间积分，从而产生一个线性增长的斜坡函数，因此是无界的。\n适用于 $t \\ge 0$ 的输出 $y(t)$ 的最终表达式就是所求的答案。", "answer": "$$\n\\boxed{2t + \\exp(-t) - 1}\n$$", "id": "2691088"}, {"introduction": "最后的这项实践将我们从纯粹的解析推导带入计算分析的领域，这是现代工程师的一项关键技能。你将设计一个程序来估算两个关键的系统增益：决定了对一般有界输入的BIBO稳定性界的脉冲响应 $L^1$ 范数，以及刻画了对正弦输入峰值响应的 $\\mathcal{H}_{\\infty}$ 范数。这个练习将突显时域和频域稳定性度量之间的实际联系与区别 [@problem_id:2691131]。", "problem": "给定一个连续时间、稳定、真的（proper）、单输入单输出 (SISO) 线性时不变 (LTI) 系统，其传递函数为 $G(s)$，设计一个程序，通过频率网格化估计 $G(s)$ 的哈代空间无穷范数（$\\mathcal{H}_{\\infty}$ 范数），然后使用此估计来限定两类输入的有界输入有界输出 (BIBO) 增益：(i) 指定频率的有界正弦输入，以及 (ii) 具有指定本性上确界的一般有界输入。\n\n您的设计必须仅从以下基本依据出发：\n- LTI 系统的输入输出映射的卷积表示：如果 $g(t)$ 是 $G(s)$ 的脉冲响应，$u(t)$ 是输入，则在标准因果性假设下，对于 $t \\ge 0$，有 $y(t) = (g * u)(t) = \\int_{0}^{\\infty} g(\\tau) u(t - \\tau) \\, d\\tau$。\n- 稳态正弦输入的频率响应解释：对于 $u(t) = A \\sin(\\omega_0 t)$，稳态输出是同频率的正弦波，其幅值为 $A \\lvert G(j \\omega_0) \\rvert$，其中 $G(j \\omega)$ 是在广义函数意义下理解的 $g(t)$ 的傅里叶变换，适用于稳定、真的 LTI 系统。\n- 通过脉冲响应绝对可积性表征的 BIBO 稳定性：如果 $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt  \\infty$，则 $\\lVert y \\rVert_{\\infty} \\le \\left( \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt \\right) \\lVert u \\rVert_{\\infty}$，其中 $\\lVert \\cdot \\rVert_{\\infty}$ 表示时域信号的本性上确界范数。\n\n基于这些依据，推导并实现：\n1) 用于 $G(s)$ 的 $\\mathcal{H}_{\\infty}$ 范数的频率网格化估计器，对于 SISO 系统，该范数定义为 $\\lvert G(j \\omega) \\rvert$ 在 $\\omega \\in [0,\\infty)$ 上的上确界，在预设的频率网格上进行近似。该网格必须包括 $\\omega = 0$ 以及一组对数间隔的正频率。使用 $\\omega_{\\min} = 10^{-3}$ 弧度/秒，$\\omega_{\\max} = 10^{3}$ 弧度/秒，以及在 $[\\omega_{\\min}, \\omega_{\\max}]$ 区间内的 $N_{\\omega} = 20000$ 个对数间隔点，并增补 $\\omega = 0$。\n2) 使用在有限时域 $[0, T_{\\mathrm{end}}]$ 上计算的脉冲响应 $g(t)$ 和梯形法则对 $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt$ 进行数值估计。通过 $G(s)$ 的极点位置 $\\{ p_k \\}$ 来确定 $T_{\\mathrm{end}}$，首先计算最大时间常数 $\\tau_{\\max} = \\max_{k} \\left( 1 / \\lvert \\operatorname{Re}(p_k) \\rvert \\right)$，然后设置 $T_{\\mathrm{end}} = \\alpha \\, \\tau_{\\max}$，其中 $\\alpha = 12$。在 $[0, T_{\\mathrm{end}}]$ 上使用均匀时间网格，步长为 $\\Delta t = \\tau_{\\max} / 200$。明确指出频率的角度单位为弧度/秒。\n\n对于每个测试用例，您的程序必须计算并返回以下六个标量：\n- 估计的 $\\mathcal{H}_{\\infty}$ 范数，$\\widehat{\\lVert G \\rVert_{\\infty}}$。\n- 网格上出现最大幅值的频率 $\\widehat{\\omega}_{\\mathrm{pk}}$（单位：弧度/秒）。\n- 针对指定正弦输入的稳态输出幅值界限，计算为 $\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$，其中 $A$ 是输入幅值。\n- 在指定频率 $\\omega_0$ 下，针对指定正弦输入的精确稳态输出幅值，计算为 $A \\lvert G(j \\omega_0) \\rvert$。\n- 估计的脉冲响应 $L^{1}$ 范数 $\\widehat{\\lVert g \\rVert_{1}} \\approx \\int_{0}^{T_{\\mathrm{end}}} \\lvert g(t) \\rvert \\, dt$。\n- 针对 $\\lVert u \\rVert_{\\infty} \\le U_{\\max}$ 的一般有界输入的 BIBO 界限，计算为 $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$。\n\n角度单位必须是弧度/秒。除此频率单位外，没有其他物理单位。\n\n测试套件：\n- 案例 1：\n  - 分子系数：$[20]$。\n  - 分母系数：$[1, 12, 20]$。\n  - 正弦输入幅值：$A = 1.0$。\n  - 正弦频率：$\\omega_0 = 1.0$ 弧度/秒。\n  - 一般输入界限：$U_{\\max} = 0.8$。\n- 案例 2：\n  - 分子系数：$[1, -1]$ (即 $s - 1$)。\n  - 分母系数：$[1, 4, 3]$ (即 $(s + 1)(s + 3)$)。\n  - 正弦输入幅值：$A = 1.5$。\n  - 正弦频率：$\\omega_0 = 2.0$ 弧度/秒。\n  - 一般输入界限：$U_{\\max} = 1.2$。\n- 案例 3：\n  - 分子系数：$[25]$ (即 $\\omega_n^2$，其中 $\\omega_n = 5$)。\n  - 分母系数：$[1, 0.5, 25]$ (即 $s^2 + 2 \\zeta \\omega_n s + \\omega_n^2$，其中 $\\zeta = 0.05$ 且 $\\omega_n = 5$)。\n  - 正弦输入幅值：$A = 0.5$。\n  - 正弦频率：$\\omega_0 = 5.0$ 弧度/秒。\n  - 一般输入界限：$U_{\\max} = 0.6$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有三个测试用例的结果，格式为逗号分隔的列表的列表，每个内部列表包含按上述顺序排列的六个浮点数。整个结果必须包含在一对单独的方括号内，不得有任何附加文本。例如，打印的行必须看起来像一个包含三个内部列表的 Python 列表字面量。", "solution": "我们从线性时不变 (LTI) 系统的卷积表示开始。如果 $g(t)$ 表示一个稳定、真的单输入单输出 (SISO) 系统的脉冲响应，其传递函数为 $G(s)$，那么对于输入 $u(t)$，输出为 $y(t) = (g * u)(t) = \\int_{0}^{\\infty} g(\\tau) u(t - \\tau) \\, d\\tau$。通过取绝对值并使用 Hölder 不等式，可以得到有界输入有界输出 (BIBO) 稳定性条件：如果 $\\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt  \\infty$，则 $\\lVert y \\rVert_{\\infty} \\le \\left( \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt \\right) \\lVert u \\rVert_{\\infty}$。这为一般有界输入提供了一个保守的界限，以脉冲响应的 $L^{1}$ 范数表示。\n\n对于稳态正弦输入，考虑 $u(t) = A \\sin(\\omega_0 t)$，其幅值为 $A$，频率为 $\\omega_0$ (弧度/秒)。稳定、真的 LTI 系统的傅里叶变换形式在广义函数意义下给出 $Y(j \\omega) = G(j \\omega) U(j \\omega)$；特别地，对于正弦输入的稳态输出是同频率的正弦波，其幅值为 $A \\lvert G(j \\omega_0) \\rvert$。将 SISO 系统的哈代空间无穷范数（$\\mathcal{H}_{\\infty}$ 范数）表示为 $\\lVert G \\rVert_{\\infty} = \\sup_{\\omega \\in [0,\\infty)} \\lvert G(j \\omega) \\rvert$。由此可知 $A \\lvert G(j \\omega_0) \\rvert \\le A \\lVert G \\rVert_{\\infty}$，这为正弦波的稳态输出幅值提供了一个界限。\n\n因此，从第一性原理出发，可以得到两个互补的诱导增益：\n- 使用脉冲响应绝对可积性的 $L^{\\infty} \\to L^{\\infty}$ 界限：$\\lVert y \\rVert_{\\infty} \\le \\lVert g \\rVert_{1} \\lVert u \\rVert_{\\infty}$，其中 $\\lVert g \\rVert_{1} = \\int_{0}^{\\infty} \\lvert g(t) \\rvert \\, dt$。\n- 使用 $\\mathcal{H}_{\\infty}$ 范数的正弦（单频）界限：稳态输出幅值为 $A \\lvert G(j \\omega_0) \\rvert \\le A \\lVert G \\rVert_{\\infty}$。\n\n算法设计：\n1) 通过频率网格化估计 $\\lVert G \\rVert_{\\infty}$。对于 SISO 系统，$\\lVert G \\rVert_{\\infty} = \\sup_{\\omega \\ge 0} \\lvert G(j \\omega) \\rvert$。我们构建一个频率网格，包括 $\\omega = 0$ 和在 $\\omega_{\\min}$ 与 $\\omega_{\\max}$ 之间对数间隔的 $N_{\\omega}$ 个点。使用指定的值，设置 $\\omega_{\\min} = 10^{-3}$，$\\omega_{\\max} = 10^{3}$，以及 $N_{\\omega} = 20000$。通过多项式比 $G(s) = N(s)/D(s)$，在该网格上以 $s = j \\omega$ 计算 $G(j \\omega)$，计算幅值 $\\lvert G(j \\omega) \\rvert$，并取其最大值。同时记录出现此最大值的网格频率，作为峰值位置的估计值 $\\widehat{\\omega}_{\\mathrm{pk}}$。\n2) 通过数值积分估计 $\\lVert g \\rVert_{1}$。从分母多项式中提取极点 $\\{ p_k \\}$。对于稳定系统，所有极点都满足 $\\operatorname{Re}(p_k)  0$。设置 $\\tau_{\\max} = \\max_{k} 1 / \\lvert \\operatorname{Re}(p_k) \\rvert$，这是主导 $g(t)$ 长尾的最慢时间常数。选择一个最终时间 $T_{\\mathrm{end}} = \\alpha \\tau_{\\max}$，其中 $\\alpha = 12$，这样指数尾部 $\\mathrm{e}^{-t/\\tau_{\\max}}$ 大约减小到 $\\mathrm{e}^{-\\alpha}$。构建一个均匀时间网格，步长为 $\\Delta t = \\tau_{\\max} / 200$，这大约为每个最大时间常数提供了 200 个样本，从而为瞬态和尾部提供了足够的分辨率。使用脉冲响应求解器在该网格上计算 $g(t)$，并通过梯形法则近似积分 $\\int_{0}^{T_{\\mathrm{end}}} \\lvert g(t) \\rvert \\, dt$。由于稳定性所隐含的指数衰减，从 $T_{\\mathrm{end}}$ 到 $\\infty$ 的剩余积分可以忽略不计，其相对误差保守地在 $\\mathrm{e}^{-\\alpha}$ 的数量级。\n3) 在界限中使用这些估计。对于指定的正弦输入幅值 $A$ 和频率 $\\omega_0$，计算精确的稳态输出幅值 $A \\lvert G(j \\omega_0) \\rvert$ 和界限 $\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$。对于满足 $\\lVert u \\rVert_{\\infty} \\le U_{\\max}$ 的一般有界输入，计算界限 $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$。\n\n测试套件的数值细节：\n- 案例 1：$G(s) = \\dfrac{20}{s^{2} + 12 s + 20}$；$A = 1.0$；$\\omega_0 = 1.0$ 弧度/秒；$U_{\\max} = 0.8$。\n- 案例 2：$G(s) = \\dfrac{s - 1}{s^{2} + 4 s + 3}$；$A = 1.5$；$\\omega_0 = 2.0$ 弧度/秒；$U_{\\max} = 1.2$。\n- 案例 3：$G(s) = \\dfrac{25}{s^{2} + 0.5 s + 25}$；$A = 0.5$；$\\omega_0 = 5.0$ 弧度/秒；$U_{\\max} = 0.6$。\n\n程序实现：\n- 一个通过在 $s = j \\omega$ 进行多项式求值来计算 $\\lvert G(j \\omega) \\rvert$ 的函数。\n- 一个通过指定网格来估计 $\\lVert G \\rVert_{\\infty}$ 和 $\\widehat{\\omega}_{\\mathrm{pk}}$ 的函数。\n- 一个使用 $T_{\\mathrm{end}} = 12 \\tau_{\\max}$ 和 $\\Delta t = \\tau_{\\max} / 200$ 来估计 $\\lVert g \\rVert_{1}$ 的函数，其中 $\\tau_{\\max}$ 从分母根计算得出。\n- 对于每个案例，计算六个输出：$\\widehat{\\lVert G \\rVert_{\\infty}}$、$\\widehat{\\omega}_{\\mathrm{pk}}$、$\\widehat{\\lVert G \\rVert_{\\infty}} \\, A$、$A \\lvert G(j \\omega_0) \\rvert$、$\\widehat{\\lVert g \\rVert_{1}}$ 和 $\\widehat{\\lVert g \\rVert_{1}} \\, U_{\\max}$。\n\n最终输出是单行，由一个包含三个内部列表的列表组成（每个案例一个），每个内部列表包含按上述顺序排列的六个浮点值，角度单位为弧度/秒。不打印任何附加文本。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import signal\n\ndef eval_Gjw_mag(num, den, w):\n    \"\"\"\n    Compute |G(jw)| for a SISO transfer function G(s) = N(s)/D(s)\n    at frequencies w (array), where s = j*w.\n    \"\"\"\n    s = 1j * w\n    num_eval = np.polyval(num, s)\n    den_eval = np.polyval(den, s)\n    H = num_eval / den_eval\n    return np.abs(H)\n\ndef hinf_estimate(num, den, wmin=1e-3, wmax=1e3, npts=20000):\n    \"\"\"\n    Estimate ||G||_inf = sup_w |G(jw)| by frequency gridding.\n    Includes w=0 and a log-spaced grid from wmin to wmax.\n    Returns (hinf_est, w_peak_est).\n    \"\"\"\n    # Construct frequency grid with w=0 and log-spaced positive frequencies\n    w_log = np.logspace(np.log10(wmin), np.log10(wmax), npts)\n    w_grid = np.concatenate(([0.0], w_log))\n    mags = eval_Gjw_mag(num, den, w_grid)\n    idx = int(np.argmax(mags))\n    return float(mags[idx]), float(w_grid[idx])\n\ndef impulse_l1_norm(num, den, alpha=12.0, samples_per_tau=200):\n    \"\"\"\n    Estimate ||g||_1 = ∫_0^∞ |g(t)| dt by computing the impulse response g(t)\n    on [0, T_end] with T_end = alpha * tau_max, where tau_max is the largest time constant\n    inferred from the real parts of the poles. Use a uniform grid with Δt = tau_max / samples_per_tau\n    and trapezoidal rule.\n    \"\"\"\n    # Compute poles from denominator polynomial\n    poles = np.roots(den)\n    re = np.real(poles)\n    # For stability, all real parts must be negative\n    if np.any(re >= 0):\n        # Not asymptotically stable; L1 norm diverges\n        return np.inf\n    tau_max = 1.0 / np.min(np.abs(re))  # largest time constant = 1 / min(|Re(p)|) for stable poles\n    T_end = alpha * tau_max\n    dt = tau_max / samples_per_tau\n    # Number of points; ensure at least 2 points\n    n_points = max(int(np.ceil(T_end / dt)) + 1, 2)\n    t = np.linspace(0.0, T_end, n_points)\n    # Impulse response using scipy.signal.impulse for analog system\n    tout, g = signal.impulse((num, den), T=t)\n    # Numerical integration of |g(t)| over [0, T_end]\n    l1 = float(np.trapz(np.abs(g), tout))\n    return l1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (num, den, A_sin, omega0, Umax)\n    test_cases = [\n        (np.array([20.0]),            np.array([1.0, 12.0, 20.0]), 1.0, 1.0, 0.8),\n        (np.array([1.0, -1.0]),       np.array([1.0, 4.0, 3.0]),   1.5, 2.0, 1.2),\n        (np.array([25.0]),            np.array([1.0, 0.5, 25.0]),  0.5, 5.0, 0.6),\n    ]\n\n    # Frequency grid parameters for H-infinity estimate\n    wmin = 1e-3\n    wmax = 1e3\n    npts = 20000\n\n    results = []\n    for num, den, A, w0, Umax in test_cases:\n        # Estimate H-infinity norm and peak frequency\n        hinf, wpk = hinf_estimate(num, den, wmin=wmin, wmax=wmax, npts=npts)\n        # Bound on sinusoidal output amplitude using H-infinity\n        bound_sinusoid = hinf * A\n        # Exact steady-state sinusoidal output amplitude at w0\n        exact_sinusoid = A * eval_Gjw_mag(num, den, np.array([w0]))[0]\n        # Estimate L1 norm of impulse response\n        l1 = impulse_l1_norm(num, den, alpha=12.0, samples_per_tau=200)\n        # BIBO bound for general bounded input\n        bound_general = l1 * Umax if np.isfinite(l1) else float('inf')\n\n        # Collect results per case: [hinf, wpk, bound_sinusoid, exact_sinusoid, l1, bound_general]\n        results.append([hinf, wpk, bound_sinusoid, exact_sinusoid, l1, bound_general])\n\n    # Format the output as a single line: list of lists, no extra text.\n    formatted_cases = []\n    for lst in results:\n        formatted = \"[\" + \",\".join(f\"{x:.6f}\" if np.isfinite(x) else \"inf\" for x in lst) + \"]\"\n        formatted_cases.append(formatted)\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nsolve()\n```", "answer": "[[1.000000,0.000000,1.000000,0.891176,1.000000,0.800000],[1.010363,1.732104,1.515544,0.416025,1.444444,1.733333],[10.006249,4.996833,5.003125,5.000000,20.930419,12.558252]]", "id": "2691131"}]}