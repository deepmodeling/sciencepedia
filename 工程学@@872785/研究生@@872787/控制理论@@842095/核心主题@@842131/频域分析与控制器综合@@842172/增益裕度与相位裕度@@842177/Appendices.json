{"hands_on_practices": [{"introduction": "本练习旨在巩固增益裕度的基本定义。它将引导您把在相位交越频率下的直接测量值，即环路增益的幅值，转化为一个标准的稳定性指标——增益裕度。通过这个计算，您可以亲身体会增益裕度是如何量化系统在变得不稳定之前所能容忍的额外增益的。[@problem_id:1307075]", "problem": "一名电气工程专业的学生正在实验室中对一个负反馈放大器进行特性分析。为了评估其稳定性，他们测量了放大器的开环传递函数，通常称为环路增益，记为 $L(j\\omega)$。该学生使用函数发生器仔细调节输入信号的频率，并在示波器上观察输出。他们确定了一个特定的角频率，称为相位交越频率，在该频率下，环路增益的相移恰好为 $-180$ 度。在此精确频率下，学生测量了环路增益的幅度，发现输出电压幅度恰好是输入电压幅度的 0.5 倍。\n\n根据这一实验测量结果，计算放大器的增益裕度。将您的答案以分贝 (dB) 表示，并四舍五入到三位有效数字。", "solution": "我们通过条件 $\\angle L(j\\omega_{pc})=-\\pi$ 定义相位交越频率 $\\omega_{pc}$。根据定义，增益裕度（线性因子）是此频率下环路增益幅度的倒数：\n$$\nG_{m}=\\frac{1}{|L(j\\omega_{pc})|}.\n$$\n以分贝表示，增益裕度为\n$$\nG_{m,\\mathrm{dB}}=20\\log_{10}\\left(G_{m}\\right)=20\\log_{10}\\left(\\frac{1}{|L(j\\omega_{pc})|}\\right)=-20\\log_{10}\\left(|L(j\\omega_{pc})|\\right).\n$$\n已知 $|L(j\\omega_{pc})|=0.5$，我们代入可得\n$$\nG_{m,\\mathrm{dB}}=-20\\log_{10}(0.5)=20\\log_{10}(2).\n$$\n计算并四舍五入到三位有效数字，得到\n$$\nG_{m,\\mathrm{dB}}=6.02.\n$$", "answer": "$$\\boxed{6.02}$$", "id": "1307075"}, {"introduction": "掌握了基本定义之后，下一个关键步骤是将其应用于系统设计中。本练习模拟了一个典型的工程任务：调整控制器增益以达到期望的相位裕度，从而确保系统具有良好的动态响应和稳定性。这个问题将挑战您逆向思考，从期望的性能指标出发，反推出所需的系统参数。[@problem_id:1307131]", "problem": "一位控制工程师的任务是调节一个负反馈系统，以达到特定的稳定性特征。该系统的环路增益由以下传递函数建模：\n$$T(s) = \\frac{K}{(s+a)(s+b)}$$\n其中 $K$ 是一个正的、实数的、可调的增益常数。该系统具有两个实极点，由参数 $a = 1.00 \\text{ rad/s}$ 和 $b = 10.0 \\text{ rad/s}$ 确定。\n\n为确保理想的瞬态响应，工程师必须调节增益 $K$，使得系统满足一个特定准则：在增益交越频率 $\\omega_{gc}$ 处，即环路增益的幅值为1（即 $|T(j\\omega_{gc})| = 1$）时，环路增益的相移 $\\angle T(j\\omega_{gc})$ 必须恰好为 $-135^\\circ$。\n\n确定满足此条件的增益 $K$ 的数值。将您的最终答案四舍五入到三位有效数字。", "solution": "环路传递函数为 $T(s) = \\frac{K}{(s+a)(s+b)}$，其中 $a0$，$b0$ 且 $K0$。在虚轴上，$s = j\\omega$，所以\n$$\nT(j\\omega) = \\frac{K}{(j\\omega + a)(j\\omega + b)}.\n$$\n对于 $\\omega0$，各因子的幅值和相位为 $|j\\omega + a| = \\sqrt{a^{2} + \\omega^{2}}$，其相位为 $\\angle(j\\omega + a) = \\arctan\\!\\left(\\frac{\\omega}{a}\\right)$，对于 $b$ 也类似。因此\n$$\n|T(j\\omega)| = \\frac{K}{\\sqrt{a^{2} + \\omega^{2}}\\,\\sqrt{b^{2} + \\omega^{2}}}, \\qquad \\angle T(j\\omega) = -\\left[\\arctan\\!\\left(\\frac{\\omega}{a}\\right) + \\arctan\\!\\left(\\frac{\\omega}{b}\\right)\\right].\n$$\n在增益交越频率 $\\omega_{gc}$ 处，有 $|T(j\\omega_{gc})| = 1$，且相位条件为 $\\angle T(j\\omega_{gc}) = -\\frac{3\\pi}{4}$。因此，\n$$\n\\arctan\\!\\left(\\frac{\\omega_{gc}}{a}\\right) + \\arctan\\!\\left(\\frac{\\omega_{gc}}{b}\\right) = \\frac{3\\pi}{4}.\n$$\n使用正切和角恒等式 $\\tan(\\alpha + \\beta) = \\frac{\\tan\\alpha + \\tan\\beta}{1 - \\tan\\alpha\\,\\tan\\beta}$，并注意到 $\\tan\\!\\left(\\arctan\\!\\left(\\frac{\\omega_{gc}}{a}\\right)\\right) = \\frac{\\omega_{gc}}{a}$，我们得到\n$$\n\\tan\\!\\left(\\arctan\\!\\left(\\frac{\\omega_{gc}}{a}\\right) + \\arctan\\!\\left(\\frac{\\omega_{gc}}{b}\\right)\\right)\n= \\frac{\\frac{\\omega_{gc}}{a} + \\frac{\\omega_{gc}}{b}}{1 - \\frac{\\omega_{gc}^{2}}{ab}}\n= \\frac{\\omega_{gc}(a+b)}{ab - \\omega_{gc}^{2}}.\n$$\n由于 $\\tan\\!\\left(\\frac{3\\pi}{4}\\right) = -1$，可得\n$$\n\\frac{\\omega_{gc}(a+b)}{ab - \\omega_{gc}^{2}} = -1 \\;\\;\\Longrightarrow\\;\\; \\omega_{gc}^{2} - (a+b)\\,\\omega_{gc} - ab = 0.\n$$\n其正根为\n$$\n\\omega_{gc} = \\frac{(a+b) + \\sqrt{(a+b)^{2} + 4ab}}{2}.\n$$\n单位增益条件 $|T(j\\omega_{gc})| = 1$ 给出\n$$\n\\frac{K}{\\sqrt{a^{2} + \\omega_{gc}^{2}}\\,\\sqrt{b^{2} + \\omega_{gc}^{2}}} = 1\n\\;\\;\\Longrightarrow\\;\\;\nK = \\sqrt{\\left(a^{2} + \\omega_{gc}^{2}\\right)\\left(b^{2} + \\omega_{gc}^{2}\\right)}.\n$$\n使用 $\\omega_{gc}^{2} = (a+b)\\,\\omega_{gc} + ab$，我们化简：\n$$\na^{2} + \\omega_{gc}^{2} = (a+b)(a+\\omega_{gc}), \\quad b^{2} + \\omega_{gc}^{2} = (a+b)(b+\\omega_{gc}),\n$$\n所以\n$$\nK^{2} = (a+b)^{2}(a+\\omega_{gc})(b+\\omega_{gc}).\n$$\n此外，\n$$\n(a+\\omega_{gc})(b+\\omega_{gc}) = ab + (a+b)\\omega_{gc} + \\omega_{gc}^{2}\n= ab + (a+b)\\omega_{gc} + \\left[(a+b)\\omega_{gc} + ab\\right]\n= 2\\,\\omega_{gc}^{2},\n$$\n因此\n$$\nK = \\sqrt{2}\\,(a+b)\\,\\omega_{gc}\n= \\frac{\\sqrt{2}}{2}\\,(a+b)\\left[(a+b) + \\sqrt{(a+b)^{2} + 4ab}\\right].\n$$\n代入 $a = 1.00$ 和 $b = 10.0$，\n$$\nK = \\frac{\\sqrt{2}}{2}\\cdot 11 \\cdot \\left(11 + \\sqrt{161}\\right)\n\\approx \\frac{\\sqrt{2}}{2}\\cdot 11 \\cdot 23.6885827\n\\approx 184.254,\n$$\n四舍五入到三位有效数字为 $184$。", "answer": "$$\\boxed{184}$$", "id": "1307131"}, {"introduction": "虽然增益和相位裕度是评估系统鲁棒性的经典工具，但它们并非总是万无一失的。本练习旨在揭示这些经典指标的局限性，特别是在处理非最小相位系统时。您将分析两个具有相同相位裕度的系统，但会发现它们对时间延迟的鲁棒性却截然不同，从而深刻理解为何需要更广义的鲁棒性度量，以及非最小相位特性对系统性能的深远影响。[@problem_id:2709743]", "problem": "考虑两个单位负反馈单输入单输出被控对象，它们具有相同的严格真分塑形控制器，但在期望的增益穿越频率附近具有不同的被控对象因式分解。设控制器为 $C(s) = \\dfrac{k}{1 + s}$ 并定义\n- 被控对象 A：$P_{A}(s) = \\dfrac{1}{1 + s}$（最小相位）。\n- 被控对象 B：$P_{B}(s) = \\dfrac{1 - s/z}{1 + s}$，在 $s = z$ 处有一个右半平面零点，其中 $z = \\sqrt{3}$（在期望的穿越频率附近为非最小相位）。\n\n令 $L_{A}(s) = C(s) P_{A}(s)$ 和 $L_{B}(s) = C(s) P_{B}(s)$ 表示开环传递函数，并令单位负反馈闭环互补灵敏度函数为 $T_{A}(s) = \\dfrac{L_{A}(s)}{1 + L_{A}(s)}$ 和 $T_{B}(s) = \\dfrac{L_{B}(s)}{1 + L_{B}(s)}$。\n\n任务：\n1) 使用相位裕度的标准定义，选择增益 $k_{A}$ 和 $k_{B}$，使得两个回路具有相同的相位裕度 $\\varphi_{m} = \\pi/3$ 弧度。从第一性原理推导它们相应的单位增益穿越频率 $\\omega_{c,A}$ 和 $\\omega_{c,B}$。\n\n2) 将被控对象中一个未知的小纯输入时间延迟 $\\tau$ 建模为乘性扰动，形式为 $P_{\\tau}(s) = P(s) \\exp(-s \\tau) = P(s) \\left( 1 + \\Delta(s) \\right)$，其中 $\\Delta(j \\omega) = \\exp(-j \\omega \\tau) - 1$。使用小增益定理以及在 $\\omega \\tau \\leq 1$ 时成立的界 $|\\Delta(j \\omega)| \\leq \\omega \\tau$，推导保守的鲁棒稳定性充分条件\n$$\n\\tau \\leq \\frac{1}{\\sup_{\\omega \\geq 0} \\, \\omega \\, |T(j \\omega)|}.\n$$\n应用此条件计算精确值\n$$\n\\tau_{\\max,A} = \\frac{1}{\\sup_{\\omega \\geq 0} \\, \\omega \\, |T_{A}(j \\omega)|}\n\\quad \\text{和} \\quad\n\\tau_{\\max,B} = \\frac{1}{\\sup_{\\omega \\geq 0} \\, \\omega \\, |T_{B}(j \\omega)|}.\n$$\n\n3) 最后，以闭式形式计算比率 $\\rho = \\dfrac{\\tau_{\\max,B}}{\\tau_{\\max,A}}$。提供 $\\rho$ 的最终答案，形式为单个精确的解析表达式。无需数值舍入。角度以弧度为单位。", "solution": "该问题要求计算两个反馈控制系统的最大允许时间延迟之比，其中一个是最小相位系统，另一个是非最小相位系统，约束条件是两者具有相同的相位裕度。分析按指定分为三部分进行。\n\n第1部分：确定增益和穿越频率。\n\n相位裕度 $\\varphi_{m}$ 定义在增益穿越频率 $\\omega_{c}$ 处，在该频率下开环传递函数的幅值为1。条件是 $\\varphi_{m} = \\pi + \\angle L(j\\omega_{c})$。给定 $\\varphi_{m} = \\pi/3$，这意味着在穿越频率处开环系统的相位必须是 $\\angle L(j\\omega_{c}) = \\varphi_{m} - \\pi = \\pi/3 - \\pi = -2\\pi/3$ 弧度。\n\n对于系统 A（最小相位）：\n开环传递函数为 $L_{A}(s) = C(s)P_{A}(s) = \\left(\\dfrac{k_{A}}{1 + s}\\right) \\left(\\dfrac{1}{1 + s}\\right) = \\dfrac{k_{A}}{(1+s)^2}$。\n频率响应为 $L_{A}(j\\omega) = \\dfrac{k_{A}}{(1+j\\omega)^2}$。\n$L_{A}(j\\omega)$ 的相位为 $\\angle L_{A}(j\\omega) = -2\\arctan(\\omega)$。\n在穿越频率 $\\omega_{c,A}$ 处，相位条件为 $-2\\arctan(\\omega_{c,A}) = -2\\pi/3$。\n这得出 $\\arctan(\\omega_{c,A}) = \\pi/3$，因此穿越频率为 $\\omega_{c,A} = \\tan(\\pi/3) = \\sqrt{3}$。\n在此频率下，幅值必须为1：$|L_{A}(j\\omega_{c,A})| = 1$。\n$|L_{A}(j\\sqrt{3})| = \\left| \\dfrac{k_{A}}{(1+j\\sqrt{3})^2} \\right| = \\dfrac{k_{A}}{|1+j\\sqrt{3}|^2} = \\dfrac{k_{A}}{(\\sqrt{1^2+(\\sqrt{3})^2})^2} = \\dfrac{k_{A}}{4}$。\n将幅值设为 $1$ 可得 $\\dfrac{k_{A}}{4} = 1$，这意味着 $k_{A}=4$。\n\n对于系统 B（非最小相位）：\n开环传递函数为 $L_{B}(s) = C(s)P_{B}(s) = \\left(\\dfrac{k_{B}}{1 + s}\\right) \\left(\\dfrac{1 - s/z}{1 + s}\\right) = \\dfrac{k_{B}(1-s/z)}{(1+s)^2}$，其中 $z=\\sqrt{3}$。\n频率响应为 $L_{B}(j\\omega) = \\dfrac{k_{B}(1-j\\omega/\\sqrt{3})}{(1+j\\omega)^2}$。\n相位为 $\\angle L_{B}(j\\omega) = \\angle(1-j\\omega/\\sqrt{3}) - \\angle((1+j\\omega)^2) = -\\arctan(\\omega/\\sqrt{3}) - 2\\arctan(\\omega)$。\n在穿越频率 $\\omega_{c,B}$ 处，相位条件为 $-\\arctan(\\omega_{c,B}/\\sqrt{3}) - 2\\arctan(\\omega_{c,B}) = -2\\pi/3$。\n通过观察，我们测试 $\\omega_{c,B}=1$。\n$\\arctan(1/\\sqrt{3}) + 2\\arctan(1) = \\pi/6 + 2(\\pi/4) = \\pi/6 + \\pi/2 = 4\\pi/6 = 2\\pi/3$。\n这与所需的相位滞后相匹配，因此穿越频率为 $\\omega_{c,B}=1$。\n在此频率下，幅值必须为1：$|L_{B}(j\\omega_{c,B})| = 1$。\n$|L_{B}(j1)| = \\left| \\dfrac{k_{B}(1-j/\\sqrt{3})}{(1+j)^2} \\right| = \\dfrac{k_{B}|1-j/\\sqrt{3}|}{|1+j|^2} = \\dfrac{k_{B}\\sqrt{1^2+(-1/\\sqrt{3})^2}}{(\\sqrt{1^2+1^2})^2} = \\dfrac{k_{B}\\sqrt{1+1/3}}{2} = \\dfrac{k_{B}\\sqrt{4/3}}{2} = \\dfrac{k_{B}(2/\\sqrt{3})}{2} = \\dfrac{k_{B}}{\\sqrt{3}}$。\n将幅值设为 $1$ 可得 $\\dfrac{k_{B}}{\\sqrt{3}} = 1$，这意味着 $k_{B}=\\sqrt{3}$。\n\n第2部分：计算最大允许时间延迟。\n\n鲁棒稳定性条件由下式给出 $\\tau \\leq \\dfrac{1}{\\sup_{\\omega \\geq 0} \\, \\omega \\, |T(j \\omega)|}$。我们必须为两个系统找到这个上确界。\n\n对于系统 A：\n互补灵敏度函数为 $T_{A}(s) = \\dfrac{L_{A}(s)}{1+L_{A}(s)} = \\dfrac{k_{A}/(1+s)^2}{1+k_{A}/(1+s)^2} = \\dfrac{k_{A}}{(1+s)^2+k_{A}}$。\n代入 $k_{A}=4$：$T_{A}(s) = \\dfrac{4}{s^2+2s+1+4} = \\dfrac{4}{s^2+2s+5}$。\n我们需要最大化 $f_{A}(\\omega) = \\omega |T_{A}(j\\omega)| = \\omega \\left|\\dfrac{4}{-\\omega^2+2j\\omega+5}\\right| = \\dfrac{4\\omega}{\\sqrt{(5-\\omega^2)^2+(2\\omega)^2}}$。\n为简化计算，我们最大化该函数的平方，$g_{A}(\\omega) = (f_{A}(\\omega))^2 = \\dfrac{16\\omega^2}{(5-\\omega^2)^2+4\\omega^2}$。令 $x=\\omega^2$。\n$g_{A}(x) = \\dfrac{16x}{(5-x)^2+4x} = \\dfrac{16x}{25-10x+x^2+4x} = \\dfrac{16x}{x^2-6x+25}$。\n为了找到最大值，我们将关于 $x$ 的导数设为零：\n$\\dfrac{d g_{A}}{dx} = 16 \\dfrac{(x^2-6x+25)(1) - x(2x-6)}{(x^2-6x+25)^2} = 0$。\n分子必须为零：$x^2-6x+25 - 2x^2+6x = 0 \\implies 25-x^2=0$。\n因为 $x=\\omega^2 \\ge 0$，所以我们有 $x=5$。因此最大值出现在 $\\omega^2=5$ 处。\n最大值为 $g_{A}(5) = \\dfrac{16(5)}{5^2-6(5)+25} = \\dfrac{80}{25-30+25} = \\dfrac{80}{20} = 4$。\n因此，$\\sup_{\\omega \\geq 0} \\, \\omega \\, |T_{A}(j \\omega)| = \\sqrt{4} = 2$。\n系统 A 的最大延迟为 $\\tau_{\\max,A} = \\dfrac{1}{2}$。\n\n对于系统 B：\n互补灵敏度函数为 $T_{B}(s) = \\dfrac{L_{B}(s)}{1+L_{B}(s)} = \\dfrac{k_{B}(1-s/z)/(1+s)^2}{1+k_{B}(1-s/z)/(1+s)^2} = \\dfrac{k_{B}(1-s/z)}{(1+s)^2+k_{B}(1-s/z)}$。\n代入 $k_{B}=z=\\sqrt{3}$：\n$T_{B}(s) = \\dfrac{\\sqrt{3}(1-s/\\sqrt{3})}{s^2+2s+1+\\sqrt{3}(1-s/\\sqrt{3})} = \\dfrac{\\sqrt{3}-s}{s^2+2s+1+\\sqrt{3}-s} = \\dfrac{\\sqrt{3}-s}{s^2+s+1+\\sqrt{3}}$。\n我们需要最大化 $f_{B}(\\omega) = \\omega |T_{B}(j\\omega)| = \\omega \\left|\\dfrac{\\sqrt{3}-j\\omega}{-\\omega^2+j\\omega+1+\\sqrt{3}}\\right| = \\dfrac{\\omega\\sqrt{3+\\omega^2}}{\\sqrt{(1+\\sqrt{3}-\\omega^2)^2+\\omega^2}}$。\n同样，我们最大化其平方，$g_{B}(\\omega) = (f_{B}(\\omega))^2 = \\dfrac{\\omega^2(3+\\omega^2)}{((1+\\sqrt{3})-\\omega^2)^2+\\omega^2}$。令 $x=\\omega^2$。\n$g_{B}(x) = \\dfrac{x(3+x)}{((1+\\sqrt{3})-x)^2+x} = \\dfrac{x^2+3x}{x^2 - 2(1+\\sqrt{3})x + (1+\\sqrt{3})^2+x} = \\dfrac{x^2+3x}{x^2-(1+2\\sqrt{3})x+(4+2\\sqrt{3})}$。\n为了找到最大值，我们将关于 $x$ 的导数设为零。$\\dfrac{d g_{B}}{dx}$ 的分子是：\n$(2x+3)(x^2-(1+2\\sqrt{3})x+(4+2\\sqrt{3})) - (x^2+3x)(2x-(1+2\\sqrt{3})) = 0$。\n这可以简化为 $(-4-2\\sqrt{3})x^2 + (8+4\\sqrt{3})x + (12+6\\sqrt{3}) = 0$。\n除以 $-(2+\\sqrt{3})$ 得到 $2x^2 - 4x - 6 = 0$，或 $x^2-2x-3=0$。\n因式分解得到 $(x-3)(x+1)=0$。因为 $x=\\omega^2 \\ge 0$，所以我们有 $x=3$。\n最大值出现在 $\\omega^2=3$ 处。最大值为：\n$g_{B}(3) = \\dfrac{3(3+3)}{((1+\\sqrt{3})-3)^2+3} = \\dfrac{18}{(\\sqrt{3}-2)^2+3} = \\dfrac{18}{(3-4\\sqrt{3}+4)+3} = \\dfrac{18}{10-4\\sqrt{3}}$。\n因此，$\\sup_{\\omega \\geq 0} \\, \\omega \\, |T_{B}(j \\omega)| = \\sqrt{\\dfrac{18}{10-4\\sqrt{3}}} = \\dfrac{3\\sqrt{2}}{\\sqrt{10-4\\sqrt{3}}}$。\n系统 B 的最大延迟为 $\\tau_{\\max,B} = \\dfrac{\\sqrt{10-4\\sqrt{3}}}{3\\sqrt{2}}$。\n\n第3部分：计算比率 $\\rho$。\n比率为 $\\rho = \\dfrac{\\tau_{\\max,B}}{\\tau_{\\max,A}}$。\n$\\rho = \\dfrac{\\left( \\dfrac{\\sqrt{10-4\\sqrt{3}}}{3\\sqrt{2}} \\right)}{\\left( \\dfrac{1}{2} \\right)} = \\dfrac{2\\sqrt{10-4\\sqrt{3}}}{3\\sqrt{2}} = \\dfrac{\\sqrt{4}\\sqrt{10-4\\sqrt{3}}}{3\\sqrt{2}} = \\dfrac{\\sqrt{2}\\sqrt{10-4\\sqrt{3}}}{3}$。\n$\\rho = \\dfrac{\\sqrt{2(10-4\\sqrt{3})}}{3} = \\dfrac{\\sqrt{20-8\\sqrt{3}}}{3}$。\n这就是最终的精确解析表达式。", "answer": "$$\n\\boxed{\\frac{\\sqrt{20 - 8\\sqrt{3}}}{3}}\n$$", "id": "2709743"}]}