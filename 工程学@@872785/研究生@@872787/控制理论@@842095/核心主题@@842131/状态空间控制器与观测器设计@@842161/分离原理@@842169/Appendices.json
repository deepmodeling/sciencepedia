{"hands_on_practices": [{"introduction": "分离原理是现代控制理论的基石之一，它极大地简化了输出反馈控制器的设计。该原理允许我们独立地设计状态反馈控制器和状态观测器，然后将它们组合起来。这个练习通过一个确定性线性系统，直观地验证了这一核心思想：组合系统的闭环极点恰好是控制器极点和观测器极点的集合。[@problem_id:1601329]", "problem": "考虑一个二阶线性时不变（LTI）系统。该系统的状态无法直接测量，因此设计了一个全阶Luenberger观测器来估计状态向量。然后使用这些估计的状态实现一个状态反馈控制器。\n\n控制系统设计者有两个目标：\n1.  状态反馈控制器的期望闭环动态特性应对应于位于 $\\{-3, -5\\}$ 的极点。\n2.  状态观测器的误差动态应显著快于控制器动态。为实现这一点，将观测器极点放置在 $\\{-30, -50\\}$。\n\n假设控制器和观测器是独立设计的，然后结合起来形成完整的调节系统，那么整个闭环系统的极点是什么？\n\n从以下选项中选择正确的极点集合。\n\nA. $\\{-3, -5\\}$\n\nB. $\\{-30, -50\\}$\n\nC. $\\{-33, -55\\}$\n\nD. $\\{-3, -5, -30, -50\\}$\n\nE. 如果没有系统矩阵 $A$、$B$ 和 $C$，则无法确定极点。", "solution": "设LTI被控对象由 $\\dot{x} = A x + B u$, $y = C x$ 给出，其中 $x \\in \\mathbb{R}^{2}$ 无法直接测量。设计全阶Luenberger观测器和状态反馈控制器如下：\n- 使用估计状态的状态反馈控制律：$u = -K \\hat{x}$，期望的闭环极点位于 $\\{-3,-5\\}$，因此 $A - B K$ 的特征值为 $\\{-3,-5\\}$。\n- 观测器：$\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$，观测器极点位于 $\\{-30,-50\\}$，因此 $A - L C$ 的特征值为 $\\{-30,-50\\}$。\n\n定义估计误差 $e = x - \\hat{x}$。然后，使用 $u = -K \\hat{x}$，\n$$\n\\dot{x} = A x + B u = A x + B(-K \\hat{x}) = A x - B K (x - e) = (A - B K) x + B K e.\n$$\n观测器误差动态推导如下\n$$\n\\dot{e} = \\dot{x} - \\dot{\\hat{x}} = \\left(A x + B u\\right) - \\left(A \\hat{x} + B u + L(y - C \\hat{x})\\right) = A(x - \\hat{x}) - L(C x - C \\hat{x}) = (A - L C) e.\n$$\n将系统状态和误差堆叠成 $z = \\begin{pmatrix} x \\\\ e \\end{pmatrix}$。组合后的闭环动态变为\n$$\n\\begin{pmatrix} \\dot{x} \\\\ \\dot{e} \\end{pmatrix}\n=\n\\begin{pmatrix}\nA - B K  B K \\\\\n0  A - L C\n\\end{pmatrix}\n\\begin{pmatrix} x \\\\ e \\end{pmatrix}.\n$$\n这个闭环系统矩阵是块上三角矩阵。其特征值是其对角块特征值的并集。因此，闭环极点是控制器极点（$A - B K$ 的特征值）和观测器误差极点（$A - L C$ 的特征值）的并集，即\n$$\n\\{-3,-5\\} \\cup \\{-30,-50\\} = \\{-3,-5,-30,-50\\}.\n$$\n根据分离原理，当控制器和观测器独立设计然后结合时，这个结果成立。\n\n因此，正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1601329"}, {"introduction": "在确定性系统的基础上，分离原理在随机控制领域，特别是在线性二次高斯（LQG）问题中，得到了最完美的应用。这个练习将带你亲手设计一个完整的LQG控制器，包括求解用于最优控制的LQR增益和用于最优估计的卡尔曼增益。通过具体的数值计算，你将验证组合系统的特征值确实由控制器和估计器的特征值构成，从而深化对随机分离原理的理解。[@problem_id:2753856]", "problem": "考虑一个带有过程噪声和测量噪声的连续时间线性时不变系统\n$$\\dot{x}(t) = A x(t) + B u(t) + G w(t), \\quad y(t) = C x(t) + v(t),$$\n其中 $x(t) \\in \\mathbb{R}^{2}$，$u(t) \\in \\mathbb{R}^{2}$，$y(t) \\in \\mathbb{R}^{2}$。过程噪声 $w(t)$ 和测量噪声 $v(t)$ 是零均值、相互独立的白噪声信号，其协方差分别为 $W \\succ 0$ 和 $V \\succ 0$。矩阵由下式给出\n$$\nA = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix},\\quad\nB = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\\quad\nC = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\\quad\nG = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\n$$\n$$\nQ = \\begin{pmatrix} 3  0 \\\\ 0  3 \\end{pmatrix},\\quad\nR = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix},\\quad\nW = \\begin{pmatrix} 3  0 \\\\ 0  7 \\end{pmatrix},\\quad\nV = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix}.\n$$\n所有矩阵对均满足通常的能稳性和能检测性条件。设计：\n- 稳态线性二次调节器（LQR）状态反馈 $u(t) = -F x(t)$，其最小化二次型代价 $\\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + u(t)^{\\top} R u(t) \\right) \\, dt$，\n- 稳态卡尔曼-布西滤波器（连续时间）$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - C \\hat{x}(t)\\big)$。\n\n仅使用基本原理以及关于代数黎卡提方程和基于估计器的控制的公认事实，完成以下任务：\n1. 计算稳态 LQR 增益 $F$ 和稳态卡尔曼增益 $L$。\n2. 形成误差 $e(t) = x(t) - \\hat{x}(t)$，并在坐标 $\\xi(t) = \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ 下，为了进行特征值分析，写出 $v(t) \\equiv 0$ 时的自治增广确定性动力学。确定相关的系统矩阵 $M$。\n3. 通过显式特征值计算，验证分离原理成立：$M$ 的谱等于 $A - B F$ 的谱与 $A - L C$ 的谱的多重集并集，并且增广闭环是稳定的。\n\n将增广闭环矩阵 $M$ 的特征多项式以因式分解形式，作为关于不定元 $\\lambda$ 的单个解析表达式报告为最终答案。不要包含单位。无需四舍五入。", "solution": "所提出的问题是关于连续时间线性时不变（LTI）系统的线性二次高斯（LQG）控制的一个标准练习。它要求设计一个稳态线性二次调节器（LQR）和一个稳态卡尔曼-布西滤波器，然后分析组合的闭环系统以验证分离原理。该问题定义明确，科学上合理，并包含唯一解所需的所有必要信息。我们将开始推导。\n\n系统动力学由下式给出：\n$$ \\dot{x}(t) = A x(t) + B u(t) + G w(t) $$\n$$ y(t) = C x(t) + v(t) $$\n矩阵、代价函数权重和噪声协方差为：\n$$ A = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix},\\ B = I_{2}, \\ C = I_{2}, \\ G = I_{2} $$\n$$ Q = 3 I_{2},\\ R = 4 I_{2},\\ W = \\begin{pmatrix} 3  0 \\\\ 0  7 \\end{pmatrix},\\ V = 4 I_{2} $$\n其中 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。\n\n首先，我们计算稳态 LQR 增益 $F$。增益由 $F = R^{-1} B^{\\top} P$ 给出，其中 $P$ 是连续时间代数黎卡提方程（CARE）的唯一、对称、半正定解：\n$$ A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0 $$\n鉴于 $A$、$B$、$R$ 和 $Q$ 都是对角矩阵，解 $P$ 也必须是对角矩阵。设 $P = \\text{diag}(p_1, p_2)$。该矩阵方程解耦为两个独立的标量代数黎卡提方程。\n由于 $R^{-1} = \\frac{1}{4}I_2$ 且 $B=I_2$，我们有 $B R^{-1} B^{\\top} = \\frac{1}{4}I_2$。\n\n对于第一个对角元素 $p_1$：\n$$ 2(0.5)p_1 - p_1(\\frac{1}{4})p_1 + 3 = 0 \\implies \\frac{1}{4}p_1^2 - p_1 - 3 = 0 \\implies p_1^2 - 4p_1 - 12 = 0 $$\n因式分解得到 $(p_1 - 6)(p_1 + 2) = 0$。为使 $P$ 是半正定的，我们必须选择非负根，因此 $p_1 = 6$。\n\n对于第二个对角元素 $p_2$：\n$$ 2(-1.5)p_2 - p_2(\\frac{1}{4})p_2 + 3 = 0 \\implies \\frac{1}{4}p_2^2 + 3p_2 - 3 = 0 \\implies p_2^2 + 12p_2 - 12 = 0 $$\n使用二次方程求根公式，$p_2 = \\frac{-12 \\pm \\sqrt{12^2 - 4(1)(-12)}}{2} = \\frac{-12 \\pm \\sqrt{144 + 48}}{2} = \\frac{-12 \\pm \\sqrt{192}}{2}$。由于 $\\sqrt{192} = \\sqrt{64 \\times 3} = 8\\sqrt{3}$，我们有 $p_2 = \\frac{-12 \\pm 8\\sqrt{3}}{2} = -6 \\pm 4\\sqrt{3}$。为了半正定性，我们必须选择 $p_2 = 4\\sqrt{3} - 6 > 0$。\n因此，$P = \\begin{pmatrix} 6  0 \\\\ 0  4\\sqrt{3} - 6 \\end{pmatrix}$。\nLQR 增益为 $F = R^{-1} B^{\\top} P = \\frac{1}{4}I_2 \\cdot I_2 \\cdot P = \\frac{1}{4}P$。\n$$ F = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\sqrt{3} - \\frac{3}{2} \\end{pmatrix} $$\n\n接下来，我们计算稳态卡尔曼增益 $L$。增益由 $L = S C^{\\top} V^{-1}$ 给出，其中 $S$ 是稳态误差协方差，它是滤波器代数黎卡提方程（ARE）的唯一、对称、半正定解：\n$$ A S + S A^{\\top} - S C^{\\top} V^{-1} C S + G W G^{\\top} = 0 $$\n等效过程噪声协方差为 $Q_{noise} = G W G^{\\top} = I_2 W I_2 = W$。由于 $A$、$C$、$V$ 和 $Q_{noise}$ 都是对角矩阵，$S$ 也必须是对角矩阵。设 $S = \\text{diag}(s_1, s_2)$。由于 $V^{-1} = \\frac{1}{4}I_2$ 且 $C=I_2$，我们有 $C^{\\top} V^{-1} C = \\frac{1}{4}I_2$。该矩阵方程解耦。\n\n对于第一个对角元素 $s_1$：\n$$ 2(0.5)s_1 - s_1(\\frac{1}{4})s_1 + 3 = 0 \\implies \\frac{1}{4}s_1^2 - s_1 - 3 = 0 \\implies s_1^2 - 4s_1 - 12 = 0 $$\n这与 $p_1$ 的方程相同，所以 $s_1 = 6$。\n\n对于第二个对角元素 $s_2$：\n$$ 2(-1.5)s_2 - s_2(\\frac{1}{4})s_2 + 7 = 0 \\implies \\frac{1}{4}s_2^2 + 3s_2 - 7 = 0 \\implies s_2^2 + 12s_2 - 28 = 0 $$\n因式分解得到 $(s_2 + 14)(s_2 - 2) = 0$。为使 $S$ 是半正定的，我们必须选择非负根，因此 $s_2 = 2$。\n因此，$S = \\begin{pmatrix} 6  0 \\\\ 0  2 \\end{pmatrix}$。\n卡尔曼增益为 $L = S C^{\\top} V^{-1} = S \\cdot I_2 \\cdot \\frac{1}{4}I_2 = \\frac{1}{4}S$。\n$$ L = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n\n现在，我们构建自治增广系统。控制律为 $u(t) = -F \\hat{x}(t)$。状态方程变为 $\\dot{x} = Ax - BF\\hat{x}$。估计误差为 $e(t) = x(t) - \\hat{x}(t)$。误差的动力学由 $\\dot{e} = \\dot{x} - \\dot{\\hat{x}}$ 导出。\n对于分析的确定性部分（设 $w(t)=0, v(t)=0$），我们有 $y(t) = C x(t)$。\n$$ \\dot{\\hat{x}} = A\\hat{x} + Bu + L(y-C\\hat{x}) = A\\hat{x} - BF\\hat{x} + L(Cx - C\\hat{x}) $$\n$$ \\dot{e} = (Ax-BF\\hat{x}) - (A\\hat{x} - BF\\hat{x} + LCx - LC\\hat{x}) = A(x-\\hat{x}) - LC(x-\\hat{x}) = (A-LC)e $$\n通过代入 $\\hat{x} = x-e$，状态动力学可以表示为 $x$ 和 $e$ 的函数：\n$$ \\dot{x} = Ax - BF(x-e) = (A-BF)x + BFe $$\n状态为 $\\xi(t) = \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ 的增广系统为：\n$$ \\dot{\\xi}(t) = \\begin{pmatrix} \\dot{x} \\\\ \\dot{e} \\end{pmatrix} = \\begin{pmatrix} A-BF  BF \\\\ \\mathbf{0}  A-LC \\end{pmatrix} \\begin{pmatrix} x \\\\ e \\end{pmatrix} $$\n系统矩阵为 $M = \\begin{pmatrix} A-BF  BF \\\\ \\mathbf{0}  A-LC \\end{pmatrix}$。\n块三角矩阵的特征值是其对角块的特征值。这证明了分离原理：基于观测器的闭环控制器的特征值集合是状态反馈控制器的特征值与观测器误差动力学特征值的并集。\n$\\text{spectrum}(M) = \\text{spectrum}(A-BF) \\cup \\text{spectrum}(A-LC)$。\n\n我们计算所需的矩阵及其谱。\n控制器闭环矩阵为：\n$$ A - BF = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\sqrt{3} - \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 0.5 - 1.5  0 \\\\ 0  -1.5 - (\\sqrt{3} - 1.5) \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -\\sqrt{3} \\end{pmatrix} $$\n$A-BF$ 的特征值为 $\\lambda_{c1} = -1$ 和 $\\lambda_{c2} = -\\sqrt{3}$。\n\n估计器闭环矩阵为：\n$$ A - LC = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.5 - 1.5  0 \\\\ 0  -1.5 - 0.5 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix} $$\n$A-LC$ 的特征值为 $\\lambda_{o1} = -1$ 和 $\\lambda_{o2} = -2$。\n\n增广系统矩阵 $M$ 的特征值集合为 $\\{-1, -\\sqrt{3}, -1, -2\\}$。所有特征值都具有负实部，因此增广闭环系统是稳定的。分离原理得到了明确的验证。\n\n最后的任务是报告 $M$ 的特征多项式，即 $p(\\lambda) = \\det(\\lambda I - M)$。根据 $M$ 的特征值，因式分解形式的多项式为：\n$$ p(\\lambda) = (\\lambda - (-1)) (\\lambda - (-1)) (\\lambda - (-\\sqrt{3})) (\\lambda - (-2)) $$\n$$ p(\\lambda) = (\\lambda + 1)^2 (\\lambda + \\sqrt{3}) (\\lambda + 2) $$\n这就是最终结果。", "answer": "$$ \\boxed{(\\lambda+1)^{2}(\\lambda+2)(\\lambda+\\sqrt{3})} $$", "id": "2753856"}, {"introduction": "深刻理解一个科学原理不仅要知道它何时成立，更要明白其失效的边界，这对于解决实际工程问题至关重要。这个高级练习旨在探索分离原理的局限性。通过在系统中引入常见的控制输入硬约束，我们将看到原本独立的估计与控制问题变得相互耦合，最优决策不再仅仅依赖于状态的最优估计值，而是依赖于整个信念状态（即状态的概率分布），这直接揭示了分离原理在非LQG设定下的失效。[@problem_id:2753828]", "problem": "考虑一个带有高斯噪声的部分可观测、标量、线性、时不变（LTI）随机控制系统。系统动力学由状态方程 $x_{t+1} = a x_t + b u_t + w_t$ 和观测方程 $y_t = c x_t + v_t$ 给出，其中 $w_t$ 和 $v_t$ 分别是方差为 $\\sigma_w^2$ 和 $\\sigma_v^2$ 的独立零均值高斯随机变量。对 $x_0$ 的初始信念是均值为 $\\hat{x}_0$、方差为 $s_0$ 的高斯分布。在每个时间步 $t$，控制输入都受到硬幅值约束 $u_t \\in [-u_{\\max}, u_{\\max}]$ 的限制。\n\n该决策问题是一个时域为 $T=2$ 且具有二次目标的有限时域、部分可观测随机最优控制问题。目标是期望的终端状态二次代价和控制二次代价的总和。具体来说，在两个步骤中都使用终端状态代价权重 $q_T  0$ 和每步控制代价权重 $r  0$。为使问题具体化，使用以下参数值：\n- $a = 1$, $b = 1$, $c = 1$,\n- $\\sigma_w = 0.2$, $\\sigma_v = 0.5$,\n- $q_T = 1$, $r = 0.05$,\n- $u_{\\max} = 0.4$.\n\n您必须按如下方式从基本原理出发。\n\n1. 使用线性高斯系统的贝叶斯状态估计更新。时间 $t$ 的信念状态完全由一个均值为 $\\hat{x}_t$、方差为 $s_t$ 的高斯分布来表征。给定当前信念 $(\\hat{x}_t, s_t)$ 和所选的控制 $u_t$，一步预测的状态分布是均值为 $a \\hat{x}_t + b u_t$、方差为 $a^2 s_t + \\sigma_w^2$ 的高斯分布。观测到 $y_{t+1}$ 后，应用贝叶斯更新，使用针对标量情况的卡尔曼滤波器方程来获得后验信念 $(\\hat{x}_{t+1}, s_{t+1})$。后验方差为 $s_{t+1} = (1 - K_{t+1}) P_{t+1|t}$，其中 $P_{t+1|t} = a^2 s_t + \\sigma_w^2$ 且 $K_{t+1} = \\dfrac{P_{t+1|t} c}{c^2 P_{t+1|t} + \\sigma_v^2}$ 是卡尔曼增益。后验均值 $\\hat{x}_{t+1}$ 是先验均值、控制和新息的仿射函数。\n\n2. 建立关于信念状态的动态规划递推。在时间 $t=1$（剩余一步），将价值 $V_1(\\hat{x}_1, s_1)$ 定义为选择 $u_1 \\in [-u_{\\max}, u_{\\max}]$ 时的最优期望终端代价加上时间-1 的控制代价。在时间 $t=0$，将价值 $V_0(\\hat{x}_0, s_0)$ 定义为时间-0 的控制代价加上在给定 $(\\hat{x}_0, s_0)$ 和 $u_0 \\in [-u_{\\max}, u_{\\max}]$ 的情况下，考虑下一次观测的随机性时 $V_1(\\hat{x}_1, s_1)$ 的期望值。\n\n3. 利用期望和高斯信念更新的基本原理证明，在 $t=1$ 时，最小化期望二次终端代价加控制代价（在硬约束下）的最优控制 $u_1^\\star$ 是 $\\hat{x}_1$ 的一个饱和仿射函数，该函数通过将无约束仿射最小化器裁剪到 $[-u_{\\max}, u_{\\max}]$ 区间内得到。因此，$V_1(\\hat{x}_1, s_1)$ 是一个关于 $\\hat{x}_1$ 的分段二次函数，在与 $u_{\\max}$ 成正比的阈值处有一个拐点。\n\n4. 证明由于 $\\hat{x}_1$ 是一个高斯随机变量（因测量更新而产生），其分布依赖于 $(\\hat{x}_0, s_0)$ 和 $u_0$，因此期望值 $\\mathbb{E}[V_1(\\hat{x}_1, s_1) \\mid \\hat{x}_0, s_0, u_0]$ 依赖于 $\\hat{x}_1$ 的完整分布，而不仅仅是其均值。特别地，$\\hat{x}_1$ 的方差通过卡尔曼更新依赖于 $s_0$，并且该方差与由输入约束引起的 $V_1(\\hat{x}_1, s_1)$ 中的非线性（拐点）相互作用。因此，最小化时间-0 总期望代价的最优控制 $u_0^\\star$ 通过 $\\hat{x}_0$ 和 $s_0$ 两者依赖于 $(\\hat{x}_0, s_0)$。这违背了分离原理，该原理要求只依赖于 $\\hat{x}_0$。\n\n5. 数值求解一个小实例以说明这种违背。使用高斯求积法计算关于 $\\hat{x}_1$ 的高斯分布的期望 $\\mathbb{E}[V_1(\\hat{x}_1, s_1) \\mid \\hat{x}_0, s_0, u_0]$。使用足够精确的求积法（例如，阶数至少为 $N=41$ 的高斯-埃尔米特求积法）并在 $u_0 \\in [-u_{\\max}, u_{\\max}]$ 上进行密集的一维搜索，为每个测试用例确定一个近最优的 $u_0^\\star$。不要使用任何随机采样；计算应该是确定性的。\n\n测试套件。使用上面列出的固定参数和以下四个初始信念 $(\\hat{x}_0, s_0)$：\n- 案例 A（理想路径，低不确定性）：$(\\hat{x}_0, s_0) = (0.8, 0.01)$。\n- 案例 B（与 A 均值相同，高不确定性）：$(\\hat{x}_0, s_0) = (0.8, 2.0)$。这对案例旨在测试对完整信念的依赖性：如果 A 和 B 的最优 $u_0^\\star$ 不同，则分离原理失效。\n- 案例 C（对称性边缘情况）：$(\\hat{x}_0, s_0) = (0.0, 1.0)$。根据对称性，预期最优控制接近于零。\n- 案例 D（边界情况，强偏差）：$(\\hat{x}_0, s_0) = (3.0, 0.5)$，预期在输入边界处达到饱和。\n\n您的程序必须为每种情况计算在时间 $t=0$ 时的最优约束控制 $u_0^\\star \\in [-u_{\\max}, u_{\\max}]$，该控制在硬输入约束下最小化期望的两步代价。要求的最终输出格式是一行包含四个浮点数的列表，顺序为 [A,B,C,D]，代表四个最优控制 $[u_{0,A}^\\star, u_{0,B}^\\star, u_{0,C}^\\star, u_{0,D}^\\star]$，以方括号括起来的逗号分隔列表形式打印（例如，“[$x_1,x_2,x_3,x_4$]”）。不涉及物理单位；不使用角度；不需要百分比。", "solution": "该问题是有效的。它构成了一个随机最优控制理论中适定的问题，旨在展示当控制输入受到硬约束时，线性高斯系统中分离原理的失效。所有必要的参数和条件都已指定，并且问题在科学上是合理的。我们开始进行求解。\n\n问题是在有限时域 $T=2$ 内，为一个部分可观测的随机系统寻找最优控制 $u_0^\\star$。该系统由线性状态空间模型描述：\n$$x_{t+1} = a x_t + b u_t + w_t$$\n$$y_t = c x_t + v_t$$\n其中 $x_t$ 是标量状态， $u_t$ 是控制输入， $y_t$ 是在时间 $t$ 的观测值。过程噪声 $w_t \\sim \\mathcal{N}(0, \\sigma_w^2)$ 和测量噪声 $v_t \\sim \\mathcal{N}(0, \\sigma_v^2)$ 是独立的零均值高斯白噪声过程。关于状态 $x_0$ 的初始信念是高斯的，$x_0 \\sim \\mathcal{N}(\\hat{x}_0, s_0)$。控制是受约束的：$u_t \\in [-u_{\\max}, u_{\\max}]$。\n\n目标是最小化总期望代价，该代价是二次控制代价和终端二次状态代价之和：\n$$J(u_0, u_1) = \\mathbb{E}\\left[q_T x_2^2 + r u_0^2 + r u_1^2\\right]$$\n我们使用基于信念状态 $(\\hat{x}_t, s_t)$ 的动态规划来解决此问题，信念状态是在给定截至时间 $t$ 的所有信息下，状态 $x_t$ 的高斯分布的均值和方差。\n\n参数值为：$a = 1$，$b = 1$，$c = 1$，$\\sigma_w = 0.2$（因此 $\\sigma_w^2 = 0.04$），$\\sigma_v = 0.5$（因此 $\\sigma_v^2 = 0.25$），$q_T = 1$，$r = 0.05$，$u_{\\max} = 0.4$。\n\n**1. 贝叶斯状态估计（卡尔曼滤波器）**\n\n信念状态 $(\\hat{x}_t, s_t)$ 根据标量卡尔曼滤波器方程演化。给定一个信念 $(\\hat{x}_t, s_t)$ 和一个控制 $u_t$：\n- **预测步骤：** 在观测到 $y_{t+1}$ 之前，$x_{t+1}$ 的预测（先验）分布是 $\\mathcal{N}(\\hat{x}_{t+1|t}, P_{t+1|t})$，其中：\n  $$\\hat{x}_{t+1|t} = a \\hat{x}_t + b u_t$$\n  $$P_{t+1|t} = a^2 s_t + \\sigma_w^2$$\n- **更新步骤：** 接收到观测值 $y_{t+1}$ 后，信念更新为后验分布 $\\mathcal{N}(\\hat{x}_{t+1}, s_{t+1})$，其中：\n  $$\\hat{x}_{t+1} = \\hat{x}_{t+1|t} + K_{t+1}(y_{t+1} - c \\hat{x}_{t+1|t})$$\n  $$s_{t+1} = (1 - K_{t+1}c)P_{t+1|t}$$\n  卡尔曼增益 $K_{t+1}$ 由下式给出：\n  $$K_{t+1} = \\frac{c P_{t+1|t}}{c^2 P_{t+1|t} + \\sigma_v^2}$$\n关键在于，后验方差 $s_{t+1}$ 是确定性的，仅依赖于 $s_t$，而不依赖于观测 $y_{t+1}$ 的实现。\n\n**2. 动态规划解法**\n\n我们从 $t=1$ 到 $t=0$ 按时间倒序求解问题。\n\n**步骤 1：时间 $t=1$（最后阶段）**\n在时间 $t=1$ 时的价值函数是最小期望未来总代价：\n$$V_1(\\hat{x}_1, s_1) = \\min_{u_1 \\in [-u_{\\max}, u_{\\max}]} \\mathbb{E}\\left[ r u_1^2 + q_T x_2^2 \\mid \\hat{x}_1, s_1, u_1 \\right]$$\n终端状态代价的期望是基于 $x_2$ 的分布计算的：\n$$\\mathbb{E}[x_2^2 \\mid \\hat{x}_1, s_1, u_1] = (\\mathbb{E}[x_2])^2 + \\text{Var}(x_2)$$\n$$ \\mathbb{E}[x_2] = a \\hat{x}_1 + b u_1 $$\n$$ \\text{Var}(x_2) = a^2 \\text{Var}(x_1) + \\text{Var}(w_1) = a^2 s_1 + \\sigma_w^2 $$\n因此，要最小化的目标是：\n$$ J_1(u_1) = r u_1^2 + q_T \\left( (a \\hat{x}_1 + b u_1)^2 + a^2 s_1 + \\sigma_w^2 \\right) $$\n这是 $u_1$ 的一个二次函数：$J_1(u_1) = (r + q_T b^2)u_1^2 + (2q_T ab\\hat{x}_1)u_1 + \\text{const}$。通过将导数设为零找到无约束的最小化器：\n$$ u_1^{\\text{unc}} = -\\frac{q_T ab}{r + q_T b^2} \\hat{x}_1 = -L_1 \\hat{x}_1 $$\n根据给定参数，反馈增益为 $L_1 = \\frac{1 \\cdot 1 \\cdot 1}{0.05 + 1 \\cdot 1^2} = \\frac{1}{1.05} \\approx 0.95238$。\n由于约束 $u_1 \\in [-u_{\\max}, u_{\\max}]$，最优控制 $u_1^\\star$ 是状态估计 $\\hat{x}_1$ 的一个饱和线性函数：\n$$ u_1^\\star(\\hat{x}_1) = \\text{sat}_{u_{\\max}}(-L_1 \\hat{x}_1) = \\text{clip}(-L_1 \\hat{x}_1, -u_{\\max}, u_{\\max}) $$\n当 $|-L_1 \\hat{x}_1| > u_{\\max}$ 时发生饱和，这意味着 $|\\hat{x}_1| > u_{\\max}/L_1 = 0.4 / (1/1.05) = 0.42$。\n将 $u_1^\\star(\\hat{x}_1)$ 代入 $J_1(u_1)$ 即可得到价值函数 $V_1(\\hat{x}_1, s_1)$。因为 $u_1^\\star$ 是分段线性的，所以 $V_1(\\hat{x}_1, s_1)$ 是一个关于 $\\hat{x}_1$ 的分段二次凸函数。\n\n**步骤 2：时间 $t=0$**\n在时间 $t=0$ 时的价值函数是：\n$$ V_0(\\hat{x}_0, s_0) = \\min_{u_0 \\in [-u_{\\max}, u_{\\max}]} \\left\\{ r u_0^2 + \\mathbb{E}\\left[V_1(\\hat{x}_1, s_1) \\mid \\hat{x}_0, s_0, u_0\\right] \\right\\} $$\n关键部分是期望 $\\mathbb{E}[V_1(\\hat{x}_1, s_1)]$。该期望是针对随机变量 $\\hat{x}_1$ 计算的，其分布由随机观测 $y_1$ 引起。我们必须找到这个分布。\n在给定 $t=0$ 时的信息和 $u_0$ 的选择下，后验均值 $\\hat{x}_1$ 是高斯随机变量 $y_1$ 的仿射函数。因此，$\\hat{x}_1$ 也是高斯的。其均值和方差为：\n$$ \\mu_{\\hat{x}_1} = \\mathbb{E}[\\hat{x}_1 \\mid \\hat{x}_0, s_0, u_0] = a \\hat{x}_0 + b u_0 $$\n$$ \\sigma^2_{\\hat{x}_1} = \\text{Var}(\\hat{x}_1 \\mid \\hat{x}_0, s_0, u_0) = K_1^2 \\text{Var}(y_1) = K_1 c P_{1|0} $$\n其中 $P_{1|0} = a^2 s_0 + \\sigma_w^2$ 且 $K_1 = \\frac{c P_{1|0}}{c^2 P_{1|0} + \\sigma_v^2}$。\n要对 $u_0$ 最小化的目标函数是：\n$$ J_0(u_0) = r u_0^2 + \\int_{-\\infty}^{\\infty} V_1(z, s_1) \\cdot p(z; \\mu_{\\hat{x}_1}, \\sigma^2_{\\hat{x}_1}) \\, dz $$\n其中 $p(z; \\mu, \\sigma^2)$ 是高斯概率密度函数。\n\n**3. 分离原理的失效**\nLQG 控制的分离原理指出，最优控制律为 $u_t = -L_t \\hat{x}_t$，其中增益 $L_t$ 独立于状态估计及其不确定性。控制器设计（寻找 $L_t$）与状态估计问题（寻找 $\\hat{x}_t$）是分离的。\n在这里，这个原理失效了。积分项 $\\mathbb{E}[V_1]$ 同时依赖于未来信念状态 $\\hat{x}_1$ 的均值 $\\mu_{\\hat{x}_1}$ 和方差 $\\sigma^2_{\\hat{x}_1}$。由于 $V_1$ 不是一个简单的二次函数（因为控制饱和），该期望不能被简化为仅与均值 $\\mu_{\\hat{x}_1}$ 相关的二次函数。\n方差 $\\sigma^2_{\\hat{x}_1}$ 依赖于 $P_{1|0}$，而后者又依赖于初始不确定性 $s_0$。因此，代价函数 $J_0(u_0)$ 的结构依赖于 $s_0$，不仅仅是通过 $V_1$ 内部的确定性项 $s_1$，还通过被积函数本身的形式。因此，最小化 $J_0(u_0)$ 的最优控制 $u_0^\\star$ 将同时依赖于 $\\hat{x}_0$（通过 $\\mu_{\\hat{x}_1}$）和 $s_0$（通过 $\\sigma^2_{\\hatx_1}$）。通过比较案例 A 和 B 可以证明这种违背，它们具有相同的 $\\hat{x}_0$ 但不同的 $s_0$。\n\n**4. 数值解**\n我们为每个测试案例数值计算最优控制 $u_0^\\star$。\n$\\mathbb{E}[V_1]$ 的积分使用高斯-埃尔米特求积法计算，该方法近似计算 $\\int e^{-x^2}f(x)dx$。通过变量替换 $z = \\mu_{\\hat{x}_1} + \\sqrt{2}\\sigma_{\\hat{x}_1}x$，期望变为：\n$$ \\mathbb{E}[V_1(\\hat{x}_1, s_1)] = \\frac{1}{\\sqrt{\\pi}} \\int_{-\\infty}^\\infty e^{-x^2} V_1(\\mu_{\\hat{x}_1} + \\sqrt{2}\\sigma_{\\hat{x}_1}x, s_1) \\, dx \\approx \\frac{1}{\\sqrt{\\pi}} \\sum_{i=1}^N w_i V_1(\\mu_{\\hat{x}_1} + \\sqrt{2}\\sigma_{\\hat{x}_1}x_i, s_1) $$\n其中 $(x_i, w_i)$ 是高斯-埃尔米特求积的节点和权重。我们使用高阶求积（$N=41$）以确保精度。\n对于每个测试案例 $(\\hat{x}_0, s_0)$，我们定义函数 $J_0(u_0)$ 并在紧凑区间 $u_0 \\in [-0.4, 0.4]$ 上进行密集的一维搜索以找到其最小值。产生最小代价的 $u_0$ 值即为最优控制 $u_0^\\star$。\n\n测试案例的结果证实了理论分析。具体来说，案例 A $(\\hat{x}_0=0.8, s_0=0.01)$ 的最优控制与案例 B $(\\hat{x}_0=0.8, s_0=2.0)$ 的最优控制不同，这为分离原理的失效提供了一个具体的数值证明。正如对称性所预测的，案例 C 的最优控制为零。对于案例 D，较大的初始状态误差将控制器推向其边界。\n```python\nimport numpy as np\nfrom numpy.polynomial.hermite import hermgauss\n\ndef solve():\n    \"\"\"\n    Solves the constrained stochastic optimal control problem to demonstrate\n    the failure of the separation principle.\n    \"\"\"\n    \n    # System and cost parameters\n    a = 1.0\n    b = 1.0\n    c = 1.0\n    sigma_w = 0.2\n    sigma_v = 0.5\n    q_T = 1.0\n    r = 0.05\n    u_max = 0.4\n    \n    sigma_w_sq = sigma_w**2\n    sigma_v_sq = sigma_v**2\n    \n    # Numerical parameters\n    N_quad = 41\n    N_search = 2001 # A dense grid for u0 search\n\n    # Test cases: (x0_hat, s0)\n    test_cases = [\n        (0.8, 0.01),  # Case A: Low uncertainty\n        (0.8, 2.0),   # Case B: High uncertainty\n        (0.0, 1.0),   # Case C: Symmetry\n        (3.0, 0.5),   # Case D: Large initial state\n    ]\n\n    results = []\n\n    # Pre-calculate time-1 controller gain and threshold\n    L1 = (q_T * a * b) / (r + q_T * b**2)\n\n    # Get Gauss-Hermite quadrature nodes and weights\n    quad_nodes, quad_weights = hermgauss(N_quad)\n\n    def v1_func(x1_hat, s1):\n        \"\"\"\n        Computes the value function V1(x1_hat, s1) for a given belief.\n        x1_hat can be a numpy array of quadrature points.\n        \"\"\"\n        # Optimal control at t=1\n        u1_star = np.clip(-L1 * x1_hat, -u_max, u_max)\n        \n        # Cost at t=1\n        cost_u1 = r * u1_star**2\n        \n        # Expected state cost at t=2\n        expected_x2_sq = (a * x1_hat + b * u1_star)**2 + a**2 * s1 + sigma_w_sq\n        cost_x2 = q_T * expected_x2_sq\n        \n        return cost_u1 + cost_x2\n\n    for x0_hat, s0 in test_cases:\n        # Calculate time-1 belief parameters that depend on s0\n        P10 = a**2 * s0 + sigma_w_sq\n        K1 = (c * P10) / (c**2 * P10 + sigma_v_sq)\n        s1 = (1 - K1 * c) * P10\n        sigma_hat_x1_sq = K1 * c * P10\n        sigma_hat_x1 = np.sqrt(sigma_hat_x1_sq)\n\n        def j0_func(u0):\n            \"\"\"\n            Computes the total expected cost J0 for a given control u0.\n            \"\"\"\n            # Mean of the posterior belief x1_hat ~ N(mu, sigma^2)\n            mu_hat_x1 = a * x0_hat + b * u0\n            \n            # Use Gauss-Hermite quadrature to compute E[V1(x1_hat, s1)]\n            quad_points_x1_hat = mu_hat_x1 + np.sqrt(2) * sigma_hat_x1 * quad_nodes\n            \n            v1_values_at_points = v1_func(quad_points_x1_hat, s1)\n            \n            expected_v1 = (1 / np.sqrt(np.pi)) * np.sum(quad_weights * v1_values_at_points)\n            \n            # Total cost at time 0\n            return r * u0**2 + expected_v1\n\n        # Perform a dense 1D search for optimal u0\n        u0_grid = np.linspace(-u_max, u_max, N_search)\n        costs = np.array([j0_func(u0) for u0 in u0_grid])\n        \n        # Find the optimal control\n        min_idx = np.argmin(costs)\n        u0_star = u0_grid[min_idx]\n        \n        results.append(round(u0_star, 3))\n\n    return results\n\n# The function call is not part of the solution, but the code block is.\n# The code above calculates the values: [-0.388, -0.276, 0.0, -0.4]\n```", "answer": "$$\\boxed{[-0.388, -0.276, 0.0, -0.4]}$$", "id": "2753828"}]}