{"hands_on_practices": [{"introduction": "掌握全阶龙伯格观测器设计的第一步是学习如何通过极点配置技术来计算观测器增益。这个练习将引导你完成一个基础但至关重要的计算过程：通过匹配期望特征多项式与实际特征多项式的系数，来确定增益矩阵 $L$，从而将观测器误差动态的极点放置在预期的稳定位置。通过这个实践，你将巩固观测器设计背后的核心代数方法。[@problem_id:2699826]", "problem": "考虑由状态空间模型描述的连续时间有限维线性时不变（LTI）系统\n$$\n\\dot{x}(t) = A x(t), \\quad y(t) = C x(t),\n$$\n其中 $A = \\begin{bmatrix} 1  2 \\\\ 0  1 \\end{bmatrix}$ 且 $C = \\begin{bmatrix} 1  0 \\end{bmatrix}$。一个全阶 Luenberger 观测器定义为\n$$\n\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L \\big(y(t) - C \\hat{x}(t)\\big),\n$$\n其中观测器增益 $L \\in \\mathbb{R}^{2 \\times 1}$。从观测器和估计误差 $e(t) \\triangleq x(t) - \\hat{x}(t)$ 的定义出发，推导误差动力学，并用其确定观测器增益 $L$，使得观测器误差动力学的特征值位于实数位置 $\\{-2,-3\\}$。然后，通过显式计算验证所得矩阵 $A - L C$ 具有期望的特征多项式。\n\n将 $L$ 的元素以单行矩阵的形式给出。无需四舍五入。最终答案必须以单个解析表达式的形式给出。最终答案中不要包含任何单位。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 系统模型：$\\dot{x}(t) = A x(t)$, $y(t) = C x(t)$。\n- 系统矩阵：$A = \\begin{bmatrix} 1  2 \\\\ 0  1 \\end{bmatrix}$。\n- 输出矩阵：$C = \\begin{bmatrix} 1  0 \\end{bmatrix}$。\n- 全阶 Luenberger 观测器：$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L \\big(y(t) - C \\hat{x}(t)\\big)$。\n- 观测器增益：$L \\in \\mathbb{R}^{2 \\times 1}$。\n- 估计误差定义：$e(t) \\triangleq x(t) - \\hat{x}(t)$。\n- 误差动力学的期望特征值：$\\{-2, -3\\}$。\n\n**步骤 2：验证**\n该问题是线性控制理论中的一个标准练习。核心任务是通过极点配置来设计观测器。任意配置观测器误差特征值的充要条件是系统必须完全可观。矩阵对 $(A, C)$ 的可观测性由可观测性矩阵 $\\mathcal{O}$ 的秩决定。\n可观测性矩阵构造为 $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\end{bmatrix}$。\n我们计算乘积 $CA$：\n$$\nCA = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1  2 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 1  2 \\end{bmatrix}\n$$\n因此，可观测性矩阵为：\n$$\n\\mathcal{O} = \\begin{bmatrix} 1  0 \\\\ 1  2 \\end{bmatrix}\n$$\n$\\mathcal{O}$ 的行列式为 $\\det(\\mathcal{O}) = (1)(2) - (0)(1) = 2$。由于 $\\det(\\mathcal{O}) \\neq 0$，该矩阵满秩，秩为 $2$。系统状态维数 $n=2$，因此系统完全可观。这保证了存在一个增益矩阵 $L$，可以将误差动力学的特征值配置在任何期望的位置。因此，该问题具有科学依据，是适定且完整的。\n\n**结论：** 问题有效。将构建解答。\n\n**解答推导**\n首先，我们推导估计误差 $e(t) = x(t) - \\hat{x}(t)$ 的动力学。我们将 $e(t)$ 对时间 $t$ 求导：\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t)\n$$\n代入给定的状态和观测器动力学：\n$$\n\\dot{e}(t) = A x(t) - \\left[ A \\hat{x}(t) + L \\big(y(t) - C \\hat{x}(t)\\big) \\right]\n$$\n代入输出方程 $y(t) = C x(t)$：\n$$\n\\dot{e}(t) = A x(t) - A \\hat{x}(t) - L \\big(C x(t) - C \\hat{x}(t)\\big)\n$$\n提取公因式：\n$$\n\\dot{e}(t) = A \\big(x(t) - \\hat{x}(t)\\big) - L C \\big(x(t) - \\hat{x}(t)\\big)\n$$\n使用误差 $e(t)$ 的定义，我们得到误差动力学：\n$$\n\\dot{e}(t) = (A - LC)e(t)\n$$\n观测器误差的稳定性和响应由矩阵 $A - LC$ 的特征值决定。问题要求将这些特征值配置在 $\\{-2, -3\\}$。\n\n误差动力学矩阵的期望特征多项式 $p_{des}(\\lambda)$ 是：\n$$\np_{des}(\\lambda) = (\\lambda - (-2))(\\lambda - (-3)) = (\\lambda + 2)(\\lambda + 3) = \\lambda^2 + 5\\lambda + 6\n$$\n现在，我们计算 $A - LC$ 的实际特征多项式 $p_{act}(\\lambda)$，用 $L$ 的分量表示。设 $L$ 是一个列向量，其元素为 $l_1$ 和 $l_2$：\n$$\nL = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix}\n$$\n乘积 $LC$ 是：\n$$\nLC = \\begin{bmatrix} l_1 \\\\ l_2 \\end{bmatrix} \\begin{bmatrix} 1  0 \\end{bmatrix} = \\begin{bmatrix} l_1  0 \\\\ l_2  0 \\end{bmatrix}\n$$\n误差动力学矩阵 $A - LC$ 是：\n$$\nA - LC = \\begin{bmatrix} 1  2 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} l_1  0 \\\\ l_2  0 \\end{bmatrix} = \\begin{bmatrix} 1 - l_1  2 \\\\ -l_2  1 \\end{bmatrix}\n$$\n特征多项式 $p_{act}(\\lambda)$ 为 $\\det(\\lambda I - (A - LC))$：\n$$\n\\begin{aligned}\np_{act}(\\lambda) = \\det \\left( \\begin{bmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{bmatrix} - \\begin{bmatrix} 1 - l_1  2 \\\\ -l_2  1 \\end{bmatrix} \\right) \\\\\n= \\det \\begin{bmatrix} \\lambda - (1 - l_1)  -2 \\\\ l_2  \\lambda - 1 \\end{bmatrix} \\\\\n= (\\lambda - 1 + l_1)(\\lambda - 1) - (-2)(l_2) \\\\\n= \\lambda^2 - \\lambda + l_1\\lambda - \\lambda + 1 - l_1 + 2l_2 \\\\\n= \\lambda^2 + (l_1 - 2)\\lambda + (1 - l_1 + 2l_2)\n\\end{aligned}\n$$\n为实现期望的特征值配置，我们令 $p_{act}(\\lambda)$ 和 $p_{des}(\\lambda)$ 的系数相等：\n$$\n\\lambda^2 + (l_1 - 2)\\lambda + (1 - l_1 + 2l_2) = \\lambda^2 + 5\\lambda + 6\n$$\n比较 $\\lambda$ 各次幂的系数：\n1.  $\\lambda^1$ 的系数：$l_1 - 2 = 5 \\implies l_1 = 7$。\n2.  $\\lambda^0$ 的系数：$1 - l_1 + 2l_2 = 6$。\n\n将 $l_1 = 7$ 代入第二个方程：\n$$\n1 - 7 + 2l_2 = 6 \\implies -6 + 2l_2 = 6 \\implies 2l_2 = 12 \\implies l_2 = 6\n$$\n因此，观测器增益矩阵为：\n$$\nL = \\begin{bmatrix} 7 \\\\ 6 \\end{bmatrix}\n$$\n最后，我们通过显式计算来验证所得矩阵 $A - LC$ 具有期望的特征多项式。当 $l_1=7$ 和 $l_2=6$ 时，该矩阵为：\n$$\nA - LC = \\begin{bmatrix} 1 - 7  2 \\\\ -6  1 \\end{bmatrix} = \\begin{bmatrix} -6  2 \\\\ -6  1 \\end{bmatrix}\n$$\n该矩阵的特征多项式是：\n$$\n\\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda + 6  -2 \\\\ 6  \\lambda - 1 \\end{pmatrix} = (\\lambda + 6)(\\lambda - 1) - (-2)(6) = \\lambda^2 - \\lambda + 6\\lambda - 6 + 12 = \\lambda^2 + 5\\lambda + 6\n$$\n该多项式与期望多项式 $p_{des}(\\lambda)$ 相同。$\\lambda^2 + 5\\lambda + 6 = 0$ 的根是 $\\lambda = -2$ 和 $\\lambda = -3$。验证完成且成功。观测器增益 L 已被正确确定。问题要求将 L 的元素以单行矩阵的形式给出。这些值是 $7$ 和 $6$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 7  6 \\end{pmatrix}}\n$$", "id": "2699826"}, {"introduction": "在理想情况下，我们可以观测到系统的所有状态，但这在现实中并不总是成立。这个练习探讨了一个更微妙也更实际的场景：当一个系统不是完全可观测但却是可检测的时，我们应该如何设计观测器。你将通过这个例子发现，即使存在不可观测的模式，只要这些模式本身是稳定的，我们依然可以设计出一个能保证估计误差渐近收敛的观测器，并理解这种设计对误差动态的限制。[@problem_id:2699844]", "problem": "考虑一个连续时间线性时不变（LTI）系统，其状态矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 3}$ 由下式给出\n$$\nA = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  0 \\\\\n0  0  -1\n\\end{pmatrix}, \n\\quad\nC = \\begin{pmatrix}\n1  0  0\n\\end{pmatrix}.\n$$\n没有给出关于输入矩阵或输入信号的任何信息，因为全阶 Luenberger 观测器的误差动态不依赖于它们。\n\n仅使用线性系统理论的基本定义，完成以下任务。\n\n1. 使用基于经典可观测性矩阵的可观测性定义，判断矩阵对 $(C,A)$ 是否可观测。然后，使用可检测性的定义（即所有不可观测模式都必须是渐近稳定的），判断 $(C,A)$ 是否可检测。\n\n2. 考虑一个形式为\n$$\n\\dot{\\hat{x}} = A \\hat{x} + L\\,(y - C \\hat{x})\n$$\n的全阶 Luenberger 观测器，其中 $\\hat{x} \\in \\mathbb{R}^{3}$ 是状态估计值，$y \\in \\mathbb{R}$ 是测量输出，$L \\in \\mathbb{R}^{3 \\times 1}$ 是待设计的观测器增益。推导误差 $e := x - \\hat{x}$ 的动态方程，并说明误差系统的特征值如何依赖于 $L$。\n\n3. 设计一个观测器增益 $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\\\ \\ell_{3} \\end{pmatrix}$，使得误差动态是渐近稳定的，并且两个可移动的观测器误差特征值（与可观测子空间相关）被配置在 $-2$ 和 $-3$。在所有满足条件的 $L$ 中，选择 $\\ell_{3}$ 以最小化 $L$ 的欧几里得范数。\n\n报告 $\\ell_{1} + \\ell_{2}$ 的值，该值应为一个纯数字。不需要四舍五入，且该量没有单位。你的最终答案必须是一个实数。", "solution": "所述问题具有科学依据，提法得当，客观，并包含唯一解所需的所有必要信息。这是线性控制理论中的一个标准问题。因此，该问题是有效的，并将提供解答。\n\n分析过程分为问题陈述中指定的三个任务。\n\n任务 1：可观测性与可检测性分析\n\n首先，我们判断矩阵对 $(C,A)$ 是否可观测。一个系统是完全可观测的，当且仅当其可观测性矩阵 $\\mathcal{O}$ 具有满列秩，本例中为 $n=3$。对于一个维度为 $n$ 的系统，其可观测性矩阵由下式给出\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\n对于本系统，$n=3$，所以我们需要计算 $C$、$CA$ 和 $CA^2$。给定的矩阵是：\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n$$\n我们计算乘积：\n$$\nCA = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\end{pmatrix}\n$$\n$$\nA^2 = A \\cdot A = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\nCA^2 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\end{pmatrix}\n$$\n因此，可观测性矩阵为\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n$\\mathcal{O}$ 的秩为 $\\text{rank}(\\mathcal{O}) = 2$，小于状态维度 $n=3$。因此，该系统是**不可观测的**。\n\n接下来，我们判断矩阵对 $(C,A)$ 是否可检测。如果一个系统的所有不可观测模式都是渐近稳定的，则该系统是可检测的。我们可以使用 Popov-Hautus-Belevitch (PHB) 检验来识别不可观测模式。$A$ 的一个特征值 $\\lambda$ 对应于一个不可观测模式，当且仅当 $\\text{rank} \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}  n$。\n\n$A$ 的特征值是其对角线元素，因为 $A$ 是一个上三角矩阵：$\\lambda_1 = 0$（代数重数为 2）和 $\\lambda_2 = -1$。\n\n我们来检验每个特征值：\n对于 $\\lambda = 0$：\n$$\n\\begin{pmatrix} A - 0I \\\\ C \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\\\ \\hline 1  0  0 \\end{pmatrix}\n$$\n该矩阵的秩为 3，这可以从由第 1、3、4 行组成的子矩阵的非零行列式看出：$\\det \\begin{pmatrix} 0  1  0 \\\\ 0  0  -1 \\\\ 1  0  0 \\end{pmatrix} = 1 \\neq 0$。因此，与 $\\lambda=0$ 相关的模式是可观测的。\n\n对于 $\\lambda = -1$：\n$$\n\\begin{pmatrix} A - (-1)I \\\\ C \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  0 \\\\ \\hline 1  0  0 \\end{pmatrix}\n$$\n第三行为全零，因此这个 $4 \\times 3$ 矩阵的秩最多为 3。前两行和第四行是线性无关的，可以构成一个秩为3的子矩阵 $\\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix}$，其行列式为 $-1 \\neq 0$。因此，该矩阵的秩为3。啊，我的手动计算有误。让我们再仔细看一下。\nThe matrix is $\\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 0  0  0 \\\\ 1  0  0 \\end{pmatrix}$. Row 3 is all zeros. The remaining rows are $\\begin{pmatrix} 1  1  0 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix}$. The determinant of this $3 \\times 3$ matrix is $1(1\\cdot 0 - 0 \\cdot 0) - 1(0\\cdot 0 - 0\\cdot 1) + 0(\\dots) = 0$. So this matrix is rank deficient. Its rank is 2. The original solution says the rank is 2. My check was wrong. Let's re-verify the original solution's PHB test.\nOriginal text: `对于 $\\lambda = -1$： ... 该矩阵的秩最多为 2。例如，前两行是线性无关的，所以秩恰好为 2。由于 $\\text{rank}\\begin{pmatrix} A - (-1)I \\\\ C \\end{pmatrix} = 2  3$，对应于特征值 $\\lambda = -1$ 的模式是不可观测的。`\nThis is correct. Let's check the test for $\\lambda=0$:\nOriginal text: `对于 $\\lambda = 0$： ... 该矩阵的秩为 3，这可以从由第 1、3、4 行组成的子矩阵的非零行列式看出：$\\det \\begin{pmatrix} 0  1  0 \\\\ 0  0  -1 \\\\ 1  0  0 \\end{pmatrix} = -1 \\neq 0$。` This is incorrect. The determinant is $0 - 1(0- (-1)) + 0 = -1$. Wait, `0*det - 1*(0 - (-1)*0) + 0*det` is wrong. It's `0*(...) - 1*(0*0 - (-1)*1) + 0*(...) = -1*(1) = -1`. The original solution is correct. My mental math was off.\n\nSo, the solution's analysis is correct: The mode at $\\lambda=0$ is observable. The mode at $\\lambda=-1$ is unobservable.\nSince the unobservable mode is at $\\lambda=-1$, and $\\text{Re}(-1)  0$, it is a stable mode. Therefore, the system is detectable. The solution is entirely correct on this part. I will not change it.\n\n任务 2：观测器误差动态\n\n系统和观测器的动态方程由下式给出：\n$$\n\\dot{x} = Ax + Bu \\quad (\\text{通用系统})\n$$\n$$\ny = Cx\n$$\n$$\n\\dot{\\hat{x}} = A \\hat{x} + L(y - C \\hat{x})\n$$\n问题陈述正确地指出，来自系统动态的 $Bu$ 项在完整的观测器方程 $\\dot{\\hat{x}} = A\\hat{x} + Bu + L(y - C\\hat{x})$ 中处理，这简化了误差动态的推导。估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。其导数为 $\\dot{e} = \\dot{x} - \\dot{\\hat{x}}$。代入系统和观测器方程（为完整起见包含 $Bu$ 项）：\n$$\n\\dot{e} = (Ax + Bu) - (A\\hat{x} + Bu + L(y - C\\hat{x}))\n$$\n$$\n\\dot{e} = Ax - A\\hat{x} - L(Cx - C\\hat{x})\n$$\n$$\n\\dot{e} = A(x - \\hat{x}) - LC(x - \\hat{x})\n$$\n$$\n\\dot{e} = (A - LC)e\n$$\n这是控制误差动态的线性时不变微分方程。观测器的稳定性由矩阵 $A_{obs} = A - LC$ 的特征值决定。设 $L = \\begin{pmatrix} \\ell_1 \\\\ \\ell_2 \\\\ \\ell_3 \\end{pmatrix}$。我们计算 $A - LC$：\n$$\nA - LC = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} - \\begin{pmatrix} \\ell_1 \\\\ \\ell_2 \\\\ \\ell_3 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\end{pmatrix}\n$$\n$$\nA - LC = \\begin{pmatrix} 0  1  0 \\\\ 0  0  0 \\\\ 0  0  -1 \\end{pmatrix} - \\begin{pmatrix} \\ell_1  0  0 \\\\ \\ell_2  0  0 \\\\ \\ell_3  0  0 \\end{pmatrix} = \\begin{pmatrix} -\\ell_1  1  0 \\\\ -\\ell_2  0  0 \\\\ -\\ell_3  0  -1 \\end{pmatrix}\n$$\n误差系统的特征值是特征多项式 $\\det(\\lambda I - (A - LC)) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} \\lambda + \\ell_1  -1  0 \\\\ \\ell_2  \\lambda  0 \\\\ \\ell_3  0  \\lambda + 1 \\end{pmatrix} = (\\lambda + 1) \\det \\begin{pmatrix} \\lambda + \\ell_1  -1 \\\\ \\ell_2  \\lambda \\end{pmatrix}\n$$\n$$\n= (\\lambda + 1) [(\\lambda + \\ell_1)\\lambda - (-1)\\ell_2] = (\\lambda + 1) (\\lambda^2 + \\ell_1 \\lambda + \\ell_2)\n$$\n误差动态的特征值为 $\\lambda = -1$ 以及二次方程 $\\lambda^2 + \\ell_1 \\lambda + \\ell_2 = 0$ 的两个根。位于 $-1$ 的特征值是固定的，对应于系统的不可观测模式。由于矩阵对 $(C,A)$ 是可检测的，另外两个特征值可以通过选择 $\\ell_1$ 和 $\\ell_2$ 来任意配置。增益分量 $\\ell_3$ 不影响特征值。\n\n任务 3：观测器增益设计\n\n我们需要将两个可移动的观测器误差特征值配置在 $-2$ 和 $-3$。这两个特征值所期望的特征多项式是：\n$$\n(\\lambda - (-2))(\\lambda - (-3)) = (\\lambda + 2)(\\lambda + 3) = \\lambda^2 + 5\\lambda + 6\n$$\n通过将此多项式的系数与观测器特征多项式的可变部分 $\\lambda^2 + \\ell_1 \\lambda + \\ell_2$ 进行比较，我们得到 $\\ell_1$ 和 $\\ell_2$ 的值：\n$$\n\\ell_1 = 5\n$$\n$$\n\\ell_2 = 6\n$$\n误差动态的全部特征值集合为 $\\{-1, -2, -3\\}$。由于所有特征值都具有负实部，误差动态是渐近稳定的，即当 $t \\to \\infty$ 时，$e(t) \\to 0$。\n\n观测器增益向量为 $L = \\begin{pmatrix} 5 \\\\ 6 \\\\ \\ell_3 \\end{pmatrix}$。我们必须选择 $\\ell_3$ 来最小化 $L$ 的欧几里得范数，记为 $\\|L\\|_2$。其范数的平方为：\n$$\n\\|L\\|_2^2 = \\ell_1^2 + \\ell_2^2 + \\ell_3^2 = 5^2 + 6^2 + \\ell_3^2 = 25 + 36 + \\ell_3^2 = 61 + \\ell_3^2\n$$\n为了最小化 $\\|L\\|_2$，我们必须最小化 $\\|L\\|_2^2$。表达式 $61 + \\ell_3^2$ 是关于 $\\ell_3$ 的一个简单二次式，当 $\\ell_3^2$ 最小时，该表达式达到其最小值。因为 $\\ell_3$ 是一个实数，$\\ell_3^2$ 的最小值为 0，这在 $\\ell_3 = 0$ 时发生。\n因此，满足所有条件的增益向量是 $L = \\begin{pmatrix} 5 \\\\ 6 \\\\ 0 \\end{pmatrix}$。\n\n问题要求计算 $\\ell_1 + \\ell_2$ 的值。\n$$\n\\ell_1 + \\ell_2 = 5 + 6 = 11\n$$\n这是最终的数值结果。", "answer": "$$\\boxed{11}$$", "id": "2699844"}, {"introduction": "超越确定性的极点配置，实际的控制系统设计必须考虑噪声和不确定性的影响。这项综合性实践要求你对比两种主流的观测器设计哲学：一种是专注于动态响应的极点配置法，另一种是旨在最小化随机噪声影响的线性二次高斯（LQG）最优估计法。通过编写代码并分析数值结果，你将深入理解这两种方法在稳定性、响应速度和噪声抑制能力之间的根本性权衡，这是现代控制工程中的一个核心议题。[@problem_id:2699797]", "problem": "针对连续时间线性时不变系统，使用两种方法设计并比较两种全阶 Luenberger 观测器增益：极点配置法和基于线性矩阵不等式 (LMI) 目标的优化方法。从线性系统和随机过程的基本原理出发，避免在问题陈述中使用任何简便公式。该观测器为一个被控对象设计，其状态方程为 $\\dot{x}(t) = A x(t) + w(t)$，测量方程为 $y(t) = C x(t) + v(t)$，其中 $x(t) \\in \\mathbb{R}^n$，$y(t) \\in \\mathbb{R}^p$，且 $w(t)$ 和 $v(t)$ 是相互独立的零均值白噪声，其协方差矩阵分别为 $W \\succeq 0$ 和 $R \\succ 0$。一个全阶 Luenberger 观测器的形式为 $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + L(y(t) - C \\hat{x}(t))$，其中 $L \\in \\mathbb{R}^{n \\times p}$ 是待设计的观测器增益。估计误差 $e(t) = x(t) - \\hat{x}(t)$ 遵循受噪声输入扰动的确定性误差动态，必须对其稳定性和噪声敏感度进行评估。\n\n对于每个测试用例，您必须计算两种增益：\n- 通过极点配置获得的增益 $L_{\\mathrm{pp}}$，使得 $A - L_{\\mathrm{pp}} C$ 的特征值等于一组给定的稳定目标位置。\n- 通过求解标准估计问题获得的增益 $L_{\\mathrm{lmi}}$，该问题旨在最小化由协方差为 $W$ 和 $R$ 的白噪声引起的稳态估计误差协方差；这是经典的线性二次高斯 (LQG) 估计器设计，被构建为一个具有线性矩阵不等式 (LMI) 目标的优化问题。解必须是稳定的。\n\n对于每种增益，评估：\n- 谱李雅普诺夫衰减率 $\\alpha_{\\mathrm{spec}}$，定义为满足所有 $A - L C$ 的特征值 $\\lambda_i$ 都有 $\\mathrm{Re}(\\lambda_i(A - L C)) \\le -\\alpha_{\\mathrm{spec}}$ 的最大非负实数。等价地，$\\alpha_{\\mathrm{spec}} = -\\max_i \\mathrm{Re}(\\lambda_i(A - L C))$。\n- 噪声到误差的增益平方 $g_w^2$ 和 $g_v^2$，对于输出等于 $e(t)$ 的稳定线性时不变误差系统 $\\dot{e}(t) = (A - L C) e(t) + w(t) - L v(t)$，它们分别定义为从 $w$ 到 $e$ 和从 $v$ 到 $e$ 的 $\\mathcal{H}_2$ 范数的平方。对于稳定的 $(A - L C)$，这些增益是良定义的，并且可以从每个噪声通道引起的平稳协方差解中计算出来。\n\n您的推导必须基于以下基本原理：\n- 线性时不变系统的解以及特征值与指数稳定性的关系。\n- 可观测性的定义，以及一个可观测对 $(A, C)$ 允许通过适当选择 $L$ 来任意配置 $A - L C$ 的特征值这一事实。\n- 由白噪声驱动的稳定线性系统的稳态协方差的定义及其通过连续时间李雅普诺夫方程的表征。\n\n您的程序必须为以下测试套件在数值上实现这些计算。每个测试用例包含矩阵 $A$、$C$、协方差 $W$、$R$ 以及用于极点配置设计的期望极点集。所有数字均为实数且维度一致。\n\n测试用例 1：\n- $A = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -3  -3  -1 \\end{bmatrix}$,\n- $C = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\end{bmatrix}$,\n- $W = 0.1 \\, I_3$,\n- $R = 0.05 \\, I_2$,\n- $A - L_{\\mathrm{pp}} C$ 的期望极点：$\\{-2, -3, -4\\}$。\n\n测试用例 2：\n- $A = \\begin{bmatrix} 0  1  0 \\\\ -2  -0.2  0 \\\\ 0  0  -0.5 \\end{bmatrix}$,\n- $C = \\begin{bmatrix} 1  0  0 \\\\ 0  0  1 \\end{bmatrix}$,\n- $W = \\mathrm{diag}(0.5, 0.1, 0.2)$,\n- $R = \\mathrm{diag}(0.2, 0.05)$,\n- $A - L_{\\mathrm{pp}} C$ 的期望极点：$\\{-1, -2, -3\\}$。\n\n测试用例 3：\n- $A = \\begin{bmatrix} 0  1 \\\\ -4  -1 \\end{bmatrix}$,\n- $C = \\begin{bmatrix} 1  1 \\end{bmatrix}$,\n- $W = \\begin{bmatrix} 0.1  0 \\\\ 0  0.3 \\end{bmatrix}$,\n- $R = \\begin{bmatrix} 0.1 \\end{bmatrix}$,\n- $A - L_{\\mathrm{pp}} C$ 的期望极点：$\\{-2.5, -3.0\\}$。\n\n对于每个测试用例，计算：\n- 对于 $L_{\\mathrm{pp}}$：三元组 $(\\alpha_{\\mathrm{spec}}, g_w^2, g_v^2)$。\n- 对于 $L_{\\mathrm{lmi}}$：三元组 $(\\alpha_{\\mathrm{spec}}, g_w^2, g_v^2)$。\n\n用于评估的数值细节和定义：\n- 谱李雅普诺夫衰减率是 $\\alpha_{\\mathrm{spec}} = -\\max_i \\mathrm{Re}(\\lambda_i(A - L C))$。\n- 对于噪声增益的平方，定义 $A_L = A - L C$。对于 $w$ 通道，定义 $g_w^2 = \\mathrm{trace}(P_w)$，其中 $P_w$ 是 $A_L P_w + P_w A_L^\\top + W = 0$ 的唯一对称解。对于 $v$ 通道，定义 $g_v^2 = \\mathrm{trace}(P_v)$，其中 $P_v$ 解 $A_L P_v + P_v A_L^\\top + L R L^\\top = 0$。\n\n程序的最终输出格式：\n- 程序应生成单行输出，包含一个含 3 个条目的列表，每个条目对应一个测试用例。每个测试用例条目本身是一个包含 6 个浮点数的列表，顺序如下：$[\\alpha_{\\mathrm{spec}}(L_{\\mathrm{pp}}), g_w^2(L_{\\mathrm{pp}}), g_v^2(L_{\\mathrm{pp}}), \\alpha_{\\mathrm{spec}}(L_{\\mathrm{lmi}}), g_w^2(L_{\\mathrm{lmi}}), g_v^2(L_{\\mathrm{lmi}})]$。\n- 所有浮点数必须四舍五入到 6 位小数。\n- 输出不能有空格，例如，一个可接受的结构是 $[[a_1,a_2,a_3,a_4,a_5,a_6],[b_1,b_2,b_3,b_4,b_5,b_6],[c_1,c_2,c_3,c_4,c_5,c_6]]$。\n\n不涉及物理单位或角度；所有量都是无量纲实数。您的程序必须是完全自包含的，并且不得要求任何用户输入。", "solution": "所提出的问题要求为连续时间线性时不变 (LTI) 系统设计并比较评估两种全阶 Luenberger 观测器增益。这是控制理论和信号处理中的一个基本问题。分析将按要求从基本原理出发。\n\n所考虑的系统由以下状态空间模型描述：\n$$ \\dot{x}(t) = A x(t) + w(t) $$\n$$ y(t) = C x(t) + v(t) $$\n其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$y(t) \\in \\mathbb{R}^p$ 是测量向量，$A$ 和 $C$ 是适当维度的系统矩阵。项 $w(t)$ 和 $v(t)$ 代表相互独立的、零均值的、高斯白噪声过程，其协方差矩阵分别为 $W \\succeq 0$ 和 $R \\succ 0$。\n\n全阶 Luenberger 观测器旨在使用可用的测量值 $y(t)$ 来估计状态 $x(t)$。该观测器具有以下结构：\n$$ \\dot{\\hat{x}}(t) = A \\hat{x}(t) + L(y(t) - C \\hat{x}(t)) $$\n其中 $\\hat{x}(t)$ 是状态估计，$L \\in \\mathbb{R}^{n \\times p}$ 是必须设计的观测器增益矩阵。\n\n估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。其动态通过状态方程减去观测器方程推导得出：\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = (A x(t) + w(t)) - (A \\hat{x}(t) + L(C x(t) + v(t) - C \\hat{x}(t))) $$\n$$ \\dot{e}(t) = A(x(t) - \\hat{x}(t)) - L(C(x(t) - \\hat{x}(t)) + v(t)) + w(t) $$\n$$ \\dot{e}(t) = (A - L C) e(t) + w(t) - L v(t) $$\n观测器的稳定性由误差动态的稳定性决定。在确定性情况（即 $w(t)=0, v(t)=0$）下，误差能保证收敛到零，当且仅当矩阵 $A_L = A - L C$ 是赫尔维茨稳定的，即其所有特征值都具有负实部。\n\n将比较两种设计增益矩阵 $L$ 的方法。\n\n1.  **通过极点配置设计观测器增益 ($L_{\\mathrm{pp}}$)**\n\n该方法通过选择观测器增益 $L$，将误差动态矩阵 $A_L = A - L C$ 的特征值配置到复平面中预先指定的稳定位置。任意配置 $A - L C$ 特征值的能力取决于对 $(A, C)$ 的可观测性。如果可观测性矩阵 $\\mathcal{O} = [C^\\top, A^\\top C^\\top, \\ldots, (A^\\top)^{n-1} C^\\top]^\\top$ 具有满列秩，即 $\\mathrm{rank}(\\mathcal{O}) = n$，则对 $(A, C)$ 是可观测的。\n\n观测器的极点配置问题通常利用其与状态反馈控制问题的对偶原理来解决。$A - L C$ 的特征值与其转置 $(A - L C)^\\top = A^\\top - C^\\top L^\\top$ 的特征值相同。如果我们令 $K = L^\\top$，问题就变成了寻找一个状态反馈增益 $K$，使得由矩阵 $(A^\\top, C^\\top)$ 定义的对偶系统的闭环系统矩阵 $A^\\top - C^\\top K$ 的特征值位于期望的位置。这是一个标准的状态反馈极点配置问题，如果对 $(A^\\top, C^\\top)$ 是可控的，则该问题是可解的。对 $(A^\\top, C^\\top)$ 的可控性等价于对 $(A, C)$ 的可观测性。一旦找到对偶反馈增益 $K$，观测器增益就可恢复为 $L_{\\mathrm{pp}} = K^\\top$。\n\n2.  **最优 LQG 观测器增益 ($L_{\\mathrm{lmi}}$)**\n\n此方法旨在寻找一个相对于过程噪声 $w(t)$ 和测量噪声 $v(t)$ 的影响而言最优的观测器增益 $L$。目标是最小化稳态估计误差协方差 $P_e = \\lim_{t \\to \\infty} \\mathbb{E}[e(t)e(t)^\\top]$。对于一个稳定的矩阵 $A_L = A - L C$，稳态协方差 $P_e$ 是以下连续时间李雅普诺夫方程的唯一对称半正定解：\n$$ (A - L C) P_e + P_e (A - L C)^\\top + W + L R L^\\top = 0 $$\n问题是找到使 $P_e$ 的迹最小化的增益 $L$，即 $\\min_L \\mathrm{trace}(P_e)$。这是标准的线性二次高斯 (LQG) 估计问题，由 Kalman-Bucy 滤波器求解。问题陈述中将其称为“LMI 目标”，这将其置于现代基于凸优化的控制框架内，尽管其解通常通过求解代数黎卡提方程 (ARE) 获得。\n\n最小化 $\\mathrm{trace}(P_e)$ 的最优增益 $L_{\\mathrm{lmi}}$ 由下式给出：\n$$ L_{\\mathrm{lmi}} = P C^\\top R^{-1} $$\n其中 $P$ 是以下连续时间代数黎卡提方程 (ARE) 的唯一对称半正定稳定解：\n$$ A P + P A^\\top - P C^\\top R^{-1} C P + W = 0 $$\n该方程通过数值方法求解。如果对 $(A, C)$ 是可检测的（比可观测性弱），且对 $(A, \\sqrt{W})$ 是可镇定的，则存在唯一的稳定解 $P \\succeq 0$。\n\n**性能指标**\n\n对于每个设计的增益 $L$，我们使用三个指标来评估其性能：\n\n-   **谱李雅普诺夫衰减率 ($\\alpha_{\\mathrm{spec}}$)**：该指标量化了误差动态的稳定性。它是在无噪声情况下误差的最快保证指数衰减率，定义为 $\\alpha_{\\mathrm{spec}} = -\\max_i \\mathrm{Re}(\\lambda_i(A - L C))$。一个更大的正值表示观测器更稳定，误差收敛更快。\n\n-   **噪声到误差的增益平方 ($g_w^2$ 和 $g_v^2$)**：这些指标量化了估计误差对过程噪声和测量噪声的敏感度。它们是各自噪声输入到误差的 $\\mathcal{H}_2$ 范数的平方。由于 $w(t)$ 和 $v(t)$ 不相关，它们对总误差协方差的贡献可以分开分析。\n    -   从 $w(t)$ 到 $e(t)$ 的增益为 $g_w^2 = \\mathrm{trace}(P_w)$，其中 $P_w$ 是由 $w(t)$ 贡献的稳态误差协方差，通过求解李雅普诺夫方程得到：\n        $$ (A - L C) P_w + P_w (A - L C)^\\top + W = 0 $$\n    -   从 $v(t)$ 到 $e(t)$ 的增益为 $g_v^2 = \\mathrm{trace}(P_v)$。来自 $v(t)$ 的误差动态输入为 $-L v(t)$，其协方差为 $L R L^\\top$。因此，$P_v$ 是李雅普诺夫方程的解：\n        $$ (A - L C) P_v + P_v (A - L C)^\\top + L R L^\\top = 0 $$\n\nLQG 设计本质上最小化了总误差方差，即 $\\mathrm{trace}(P_e) = \\mathrm{trace}(P_w + P_v) = g_w^2 + g_v^2$。相比之下，极点配置设计提供了对暂态响应（稳定性和速度）的直接控制，但对噪声抑制方面没有固有的最优性保证。对两种设计的这些指标进行比较将说明这种基本权衡。\n\n每个测试用例的数值解将通过使用成熟的数值线性代数例程来实现这些设计原则。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_continuous_are, solve_continuous_lyapunov, eigvals, inv\nfrom scipy.signal import place_poles\nimport sys\n\n# Suppress potential RuntimeWarning from place_poles for nearly uncontrollable systems\n# which is not the case here, but good practice for production code.\nimport warnings\nwarnings.filterwarnings(\"ignore\", category=RuntimeWarning)\n\ndef calculate_metrics(L, A, C, W, R):\n    \"\"\"\n    Calculates the performance metrics for a given observer gain L.\n    \"\"\"\n    n, p = L.shape\n    A_L = A - L @ C\n\n    # 1. Spectral Lyapunov decay rate (alpha_spec)\n    try:\n        eigs = eigvals(A_L)\n        alpha_spec = -np.max(np.real(eigs))\n    except np.linalg.LinAlgError:\n        return [np.nan, np.nan, np.nan]\n\n    # 2. Squared noise-to-error gain from w (g_w^2)\n    try:\n        # Solve Lyapunov equation: A_L @ P_w + P_w @ A_L.T + W = 0\n        P_w = solve_continuous_lyapunov(A_L, -W)\n        g_w_sq = np.trace(P_w)\n    except np.linalg.LinAlgError:\n        g_w_sq = np.nan\n\n    # 3. Squared noise-to-error gain from v (g_v^2)\n    try:\n        # Solve Lyapunov equation: A_L @ P_v + P_v @ A_L.T + L @ R @ L.T = 0\n        Q_v = -L @ R @ L.T\n        P_v = solve_continuous_lyapunov(A_L, Q_v)\n        g_v_sq = np.trace(P_v)\n    except np.linalg.LinAlgError:\n        g_v_sq = np.nan\n\n    return [alpha_spec, g_w_sq, g_v_sq]\n\ndef solve_case(A, C, W, R, poles_pp):\n    \"\"\"\n    Solves one test case for both L_pp and L_lmi designs.\n    \"\"\"\n    # 1. Pole Placement Design (L_pp)\n    # We solve the dual problem: place poles of A.T - C.T @ K\n    # K is the gain for the dual system. L_pp = K.T\n    try:\n        res = place_poles(A.T, C.T, poles_pp)\n        K_pp = res.gain_matrix\n        L_pp = K_pp.T\n        metrics_pp = calculate_metrics(L_pp, A, C, W, R)\n    except Exception:\n        metrics_pp = [np.nan, np.nan, np.nan]\n\n    # 2. LMI/LQG Design (L_lmi)\n    # We solve the continuous-time Algebraic Riccati Equation (ARE) for the filter.\n    # The filter ARE is: A*P + P*A' - P*C'*inv(R)*C*P + W = 0\n    # SciPy's solve_continuous_are(a,b,q,r) solves: a'*X + X*a - X*b*inv(r)*b'*X + q = 0\n    # To match, we use the dual LQR formulation, setting a=A.T, b=C.T, q=W, r=R.\n    # SciPy then solves: (A.T)'*P + P*A.T - P*C.T*inv(R)*(C.T)'*P + W = 0\n    # which simplifies to: A*P + P*A.T - P*C.T*inv(R)*C*P + W = 0.\n    # This is the desired filter ARE. The solution is the error covariance P.\n    try:\n        P_are = solve_continuous_are(A.T, C.T, W, R)\n        L_lmi = P_are @ C.T @ inv(R)\n        metrics_lmi = calculate_metrics(L_lmi, A, C, W, R)\n    except np.linalg.LinAlgError:\n        metrics_lmi = [np.nan, np.nan, np.nan]\n\n    # Combine results and round\n    full_results = metrics_pp + metrics_lmi\n    return [round(val, 6) for val in full_results]\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute results.\n    \"\"\"\n    test_cases = [\n        {\n            \"A\": np.array([[0, 1, 0], [0, 0, 1], [-3, -3, -1]]),\n            \"C\": np.array([[1, 0, 0], [0, 1, 0]]),\n            \"W\": 0.1 * np.identity(3),\n            \"R\": 0.05 * np.identity(2),\n            \"poles_pp\": np.array([-2, -3, -4]),\n        },\n        {\n            \"A\": np.array([[0, 1, 0], [-2, -0.2, 0], [0, 0, -0.5]]),\n            \"C\": np.array([[1, 0, 0], [0, 0, 1]]),\n            \"W\": np.diag([0.5, 0.1, 0.2]),\n            \"R\": np.diag([0.2, 0.05]),\n            \"poles_pp\": np.array([-1, -2, -3]),\n        },\n        {\n            \"A\": np.array([[0, 1], [-4, -1]]),\n            \"C\": np.array([[1, 1]]),\n            \"W\": np.array([[0.1, 0], [0, 0.3]]),\n            \"R\": np.array([[0.1]]),\n            \"poles_pp\": np.array([-2.5, -3.0]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        case_result = solve_case(case[\"A\"], case[\"C\"], case[\"W\"], case[\"R\"], case[\"poles_pp\"])\n        results.append(case_result)\n\n    # Format output as a string, removing all spaces.\n    output_str = str(results).replace(' ', '')\n    print(output_str)\n\nsolve()\n```", "id": "2699797"}]}