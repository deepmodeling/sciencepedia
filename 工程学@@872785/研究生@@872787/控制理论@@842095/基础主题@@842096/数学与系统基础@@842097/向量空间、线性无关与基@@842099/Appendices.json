{"hands_on_practices": [{"introduction": "系统的可控性问题本质上是其状态能否被驱动到状态空间中的任何一点。这一关键属性完全由系统动力学生成的向量集合（即可控性矩阵的列向量）的线性代数性质决定。本练习将引导你从可控性矩阵中直接构建状态空间的一个有效基，从而将基和线性无关性这些抽象概念与系统可达性这一核心控制属性紧密联系起来 [@problem_id:2757663]。", "problem": "设 $\\dot{x}(t) = A x(t) + B u(t)$ 是一个有限维线性时不变（LTI）系统，其中 $A \\in \\mathbb{R}^{n \\times n}$ 且 $B \\in \\mathbb{R}^{n \\times m}$。在任意非平凡时间区间上，从原点出发的可达子空间等于形如 $A^{k} b_{j}$ 的向量的线性张成，其中 $k \\in \\{0,1,\\dots,n-1\\}$ 且 $b_{j}$ 是 $B$ 的第 $j$ 列。如果可达子空间等于 $\\mathbb{R}^{n}$，则称对 $(A,B)$ 是可控的。\n\n1) 从向量空间中可达性和线性张成的定义出发，并且仅使用线性的基本性质，证明当 $(A,B)$ 可控时，可控性矩阵\n$$\n\\mathcal{C}(A,B) \\coloneqq \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; \\dots \\;\\; A^{n-1} B \\,\\big]\n$$\n的列集合张成 $\\mathbb{R}^{n}$，因此从 $\\mathcal{C}(A,B)$ 中任意选取 $n$ 个线性无关的列都构成 $\\mathbb{R}^{n}$ 的一个基。\n\n2) 根据线性无关性和分级子空间序列 $\\mathcal{R}_{k} \\coloneqq \\operatorname{span}\\{B,AB,\\dots,A^{k}B\\}$，描述从 $\\mathcal{C}(A,B)$ 的列中选取的基是唯一的条件。你的讨论应指出导致唯一性或非唯一性的结构特征（例如，输入的数量和秩增量 $\\operatorname{rank}(\\mathcal{R}_{k}) - \\operatorname{rank}(\\mathcal{R}_{k-1})$ 的模式），并明确说明排序和归一化选择如何影响结果。\n\n3) 考虑一个具体的4状态、2输入的系统，其矩阵为\n$$\nA \\,=\\, \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  -2  -3  -4\n\\end{bmatrix},\n\\qquad\nB \\,=\\, \\begin{bmatrix}\n0  0 \\\\\n0  0 \\\\\n1  0 \\\\\n0  1 \n\\end{bmatrix}.\n$$\n构建可控性矩阵 $\\mathcal{C}(A,B)$，并从左到右选取前 $n=4$ 个线性无关的列来构成一个基矩阵 $T \\in \\mathbb{R}^{4 \\times 4}$（即，$T$ 的列就是这四个列，并保持相同顺序）。计算行列式 $\\det(T)$。将最终答案表示为一个精确整数（无需四舍五入）。", "solution": "所述问题具有科学依据，提法恰当且完整。它提出了线性控制理论中的一组标准问题。我将着手解决它。\n\n### 第1部分：可控性秩条件的证明\n\n问题定义了一个线性时不变（LTI）系统 $\\dot{x}(t) = A x(t) + B u(t)$，其中 $x \\in \\mathbb{R}^n$，$A \\in \\mathbb{R}^{n \\times n}$，$B \\in \\mathbb{R}^{n \\times m}$。设输入矩阵 $B$ 的列向量为 $b_j$，其中 $j \\in \\{1, 2, \\dots, m\\}$。\n\n问题给出了两个关键定义作为前提：\n1.  从原点出发的可达子空间，记为 $\\mathcal{R}$，定义为向量集合 $S = \\{A^k b_j \\mid k \\in \\{0, 1, \\dots, n-1\\}, j \\in \\{1, \\dots, m\\}\\}$ 的线性张成。用数学符号表示，$\\mathcal{R} \\coloneqq \\operatorname{span}(S)$。\n2.  当且仅当可达子空间为整个状态空间时，即 $\\mathcal{R} = \\mathbb{R}^n$，对 $(A, B)$ 是可控的。\n\n可控性矩阵定义为\n$$\n\\mathcal{C}(A,B) \\coloneqq \\big[\\, B \\;\\; A B \\;\\; A^{2} B \\;\\; \\dots \\;\\; A^{n-1} B \\,\\big]\n$$\n该矩阵由拼接块 $A^k B$（$k = 0, \\dots, n-1$）构成。每个块 $A^k B$ 由列 $A^k b_1, A^k b_2, \\dots, A^k b_m$ 组成。\n\n可控性矩阵 $\\mathcal{C}(A,B)$ 的所有列的集合恰好是前提中定义的集合 $S$。也就是说，$\\mathcal{C}(A,B)$ 的列是对于所有 $k \\in \\{0, \\dots, n-1\\}$ 和 $j \\in \\{1, \\dots, m\\}$ 的向量 $\\{A^k b_j\\}$。\n\n根据线性张成的定义，$\\mathcal{C}(A,B)$ 的列所张成的空间是 $\\operatorname{span}(S)$。根据问题的第一个前提，这就是可达子空间 $\\mathcal{R}$。\n$$\n\\operatorname{span}(\\text{columns of } \\mathcal{C}(A,B)) = \\operatorname{span}(S) = \\mathcal{R}\n$$\n\n问题陈述我们要假设对 $(A,B)$ 是可控的。根据第二个前提，这意味着 $\\mathcal{R} = \\mathbb{R}^n$。\n将此代入我们之前的发现，我们得出结论：\n$$\n\\operatorname{span}(\\text{columns of } \\mathcal{C}(A,B)) = \\mathbb{R}^n\n$$\n这证明了当 $(A,B)$ 可控时，可控性矩阵 $\\mathcal{C}(A,B)$ 的列张成状态空间 $\\mathbb{R}^n$。\n\n像 $\\mathbb{R}^n$ 这样的 $n$ 维向量空间的基被定义为任何一个由张成该空间的 $n$ 个线性无关向量组成的集合。由于 $\\mathcal{C}(A,B)$ 的列构成了 $\\mathbb{R}^n$ 的一个张成集，从基的定义可以推断出，这些列中任何包含恰好 $n$ 个线性无关向量的子集都构成 $\\mathbb{R}^n$ 的一个基。\n\n### 第2部分：从可控性矩阵选取的基的唯一性\n\n从可控性矩阵 $\\mathcal{C}(A,B)$ 的列中选取的基的唯一性关键取决于输入的数量 $m$。\n\n首先，考虑“从 $\\mathcal{C}(A,B)$ 的列中选取的基”这一说法。这意味着我们选择 $\\mathcal{C}(A,B)$ 的列向量的一个子集，其形式是给定的，不允许任意缩放（归一化）或线性组合。我们正在讨论这个选定的向量*集合*的唯一性。\n\n情况1：单输入系统 ($m=1$)\n如果系统是单输入的，$B$ 是一个 $n \\times 1$ 的列向量，我们记为 $b$。可控性矩阵是\n$$\n\\mathcal{C}(A,b) = \\big[\\, b \\;\\; Ab \\;\\; A^2 b \\;\\; \\dots \\;\\; A^{n-1}b \\,\\big]\n$$\n这是一个 $n \\times n$ 矩阵。为了使对 $(A,b)$ 可控，$\\mathcal{C}(A,b)$ 的列必须张成 $\\mathbb{R}^n$。由于恰好有 $n$ 个列，为了张成 $n$ 维空间 $\\mathbb{R}^n$，它们必须是线性无关的。\n在这种情况下，$\\mathcal{C}(A,b)$ 中恰好有 $n$ 个列，并且需要所有这 $n$ 个列来构成一个基。因此，只有一个可能的向量集可供选择：$\\mathcal{C}(A,b)$ 的全部列。基向量的选择是唯一的。\n排序和归一化：如果基中向量的顺序很重要，那么基 $[b, Ab, \\dots, A^{n-1}b]$ 也是唯一的。如果允许排列，则有 $n!$ 个可能的有序基。由于问题措辞未提及归一化，我们假设按原样取这些列。\n\n情况2：多输入系统 ($m>1$)\n如果系统是多输入的，可控性矩阵 $\\mathcal{C}(A,B)$ 是一个 $n \\times (nm)$ 矩阵。由于 $m>1$，列数 $nm$ 严格大于状态空间的维数 $n$。\n为了使对 $(A,B)$ 可控，这个 $n \\times (nm)$ 矩阵的秩必须为 $n$。这意味着这 $nm$ 个列张成 $\\mathbb{R}^n$。由于这个张成集中有多于 $n$ 个向量，所以该集合必须是线性相关的。\n$\\mathcal{C}(A,B)$ 的列之间存在线性相关性意味着有多种不同的方式来选择一个包含 $n$ 个线性无关列的子集。举一个简单的例子，如果列 $c_1, c_2, \\dots, c_n$ 构成一个基，并且另一个列 $c_{n+1}$ 可以写成其中一些列的线性组合，比如说 $c_{n+1} = \\alpha_1 c_1 + \\dots + \\alpha_n c_n$ 且 $\\alpha_1 \\neq 0$，那么我们可以用 $c_{n+1}$ 替换 $c_1$ 来构成一个新的基 $\\{c_{n+1}, c_2, \\dots, c_n\\}$。只要 $c_{n+1}$ 不是 $c_1$ 的标量倍，并且是 $\\mathcal{C}(A,B)$ 中一个不同的列，那么这个新的基向量集合就与原来的不同。当 $nm > n$ 时，这种相关性必然存在。因此，对于任何可控的多输入系统，从 $\\mathcal{C}(A,B)$ 的列中选择的基**绝不**是唯一的。\n\n分级子空间序列 $\\mathcal{R}_k = \\operatorname{span}\\{B, AB, \\dots, A^k B\\}$ 和秩增量 $\\nu_k = \\operatorname{rank}(\\mathcal{R}_k) - \\operatorname{rank}(\\mathcal{R}_{k-1})$（其中 $\\mathcal{R}_{-1}=\\{0\\}$）阐明了这种非唯一性。在每一步 $k$，我们必须从 $A^k B$ 的列中找到 $\\nu_k$ 个与 $\\mathcal{R}_{k-1}$ 线性无关的新基向量。对于 $m>1$ 的情况，通常 $A^k B$ 中可用于提供这些新方向的候选列的数量可能大于 $\\nu_k$，从而产生了选择。例如，在步骤 $k=0$ 时，我们必须选择 $\\nu_0 = \\operatorname{rank}(B)$ 个向量。如果 $m > \\operatorname{rank}(B)$，那么有多种方法可以从 $B$ 的列中为其像空间选择一个基。\n\n总之，决定唯一性的结构特征是输入的数量 $m$：\n-   当且仅当 $m=1$ 时，基向量集合的唯一性得到保证。\n-   当 $m>1$ 时，非唯一性得到保证。\n\n### 第3部分：具体示例与行列式计算\n\n给定一个 $n=4$ 个状态和 $m=2$ 个输入的系统：\n$$\nA \\,=\\, \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  -2  -3  -4\n\\end{bmatrix},\n\\qquad\nB \\,=\\, \\begin{bmatrix}\n0  0 \\\\\n0  0 \\\\\n1  0 \\\\\n0  1 \n\\end{bmatrix} \\,=\\, [b_1, b_2]\n$$\n可控性矩阵是 $\\mathcal{C}(A,B) = [B, AB, A^2 B, A^3 B]$。我们需要从左到右搜索，找到前4个线性无关的列。\n\n前两列是 $B$ 的列：\n$c_1 = b_1 = [0, 0, 1, 0]^T$\n$c_2 = b_2 = [0, 0, 0, 1]^T$\n这两个向量是线性无关的。到目前为止，我们的基是 $\\{c_1, c_2\\}$。\n\n接下来，我们计算 $AB$ 的列：\n$$\nAB = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  -2  -3  -4\n\\end{bmatrix}\n\\begin{bmatrix}\n0  0 \\\\\n0  0 \\\\\n1  0 \\\\\n0  1 \n\\end{bmatrix} = \\begin{bmatrix}\n0  0 \\\\\n1  0 \\\\\n0  1 \\\\\n-3  -4\n\\end{bmatrix}\n$$\n$\\mathcal{C}(A,B)$ 的下两列是：\n$c_3 = Ab_1 = [0, 1, 0, -3]^T$\n$c_4 = Ab_2 = [0, 0, 1, -4]^T$\n\n我们检查 $c_3$ 是否在 $\\{c_1, c_2\\}$ 的张成空间中。$\\operatorname{span}\\{c_1, c_2\\}$ 中的任何向量都具有 $[\\alpha \\cdot 0 + \\beta \\cdot 0, \\alpha \\cdot 0 + \\beta \\cdot 0, \\alpha \\cdot 1, \\beta \\cdot 1]^T = [0, 0, \\alpha, \\beta]^T$ 的形式。由于 $c_3$ 的第二个分量非零，它与 $c_1$ 和 $c_2$ 线性无关。我们将 $c_3$ 加入到我们的基中，现在基为 $\\{c_1, c_2, c_3\\}$。\n\n接下来，我们检查 $c_4$ 是否在 $\\{c_1, c_2, c_3\\}$ 的张成空间中。我们测试是否存在标量 $\\alpha, \\beta, \\gamma$ 使得 $c_4 = \\alpha c_1 + \\beta c_2 + \\gamma c_3$。\n$$\n\\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -4 \\end{bmatrix} = \\alpha \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + \\beta \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ \\gamma \\\\ \\alpha \\\\ \\beta - 3\\gamma \\end{bmatrix}\n$$\n比较分量可得 $\\gamma=0$，$\\alpha=1$，以及 $\\beta-3\\gamma = -4 \\Rightarrow \\beta = -4$。这是相容的。我们发现 $c_4 = 1 \\cdot c_1 - 4 \\cdot c_2$。所以，$c_4$ 与前面的列线性相关。我们必须跳过它。\n\n我们需要第四个线性无关的向量。我们继续处理 $\\mathcal{C}(A,B)$ 的下一列，即 $A^2 B$ 的第一列，也就是 $A^2 b_1 = A(Ab_1) = Ac_3$。\n$c_5 = A c_3 = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  1  0 \\\\\n0  0  0  1 \\\\\n-1  -2  -3  -4\n\\end{bmatrix}\n\\begin{bmatrix}\n0 \\\\\n1 \\\\\n0 \\\\\n-3\n\\end{bmatrix} = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n-3 \\\\\n-2+12\n\\end{bmatrix} = \\begin{bmatrix}\n1 \\\\\n0 \\\\\n-3 \\\\\n10\n\\end{bmatrix}$\n\n我们检查 $c_5$ 是否在 $\\{c_1, c_2, c_3\\}$ 的张成空间中。\n$$\n\\begin{bmatrix} 1 \\\\ 0 \\\\ -3 \\\\ 10 \\end{bmatrix} = \\alpha \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + \\beta \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix} + \\gamma \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -3 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ \\gamma \\\\ \\alpha \\\\ \\beta - 3\\gamma \\end{bmatrix}\n$$\n比较第一个分量得出 $1=0$，这是一个矛盾。因此，$c_5$ 与 $\\{c_1, c_2, c_3\\}$ 线性无关。\n\n我们已经找到了通过从左到右搜索按顺序选择的四个线性无关的列：$\\{c_1, c_2, c_3, c_5\\}$。基矩阵 $T$ 由这些列构成：\n$$\nT = [c_1, c_2, c_3, c_5] = \\begin{bmatrix}\n0  0  0  1 \\\\\n0  0  1  0 \\\\\n1  0  0  -3 \\\\\n0  1  -3  10\n\\end{bmatrix}\n$$\n我们计算 $T$ 的行列式。我们沿第一行进行余子式展开：\n$$\n\\det(T) = (-1)^{1+1} \\cdot 0 \\cdot M_{11} + (-1)^{1+2} \\cdot 0 \\cdot M_{12} + (-1)^{1+3} \\cdot 0 \\cdot M_{13} + (-1)^{1+4} \\cdot 1 \\cdot \\det \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  -3\n\\end{pmatrix}\n$$\n$$\n\\det(T) = -1 \\cdot \\det \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  -3\n\\end{pmatrix}\n$$\n为了计算这个 $3 \\times 3$ 矩阵的行列式，我们沿其第一行展开：\n$$\n\\det \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  -3\n\\end{pmatrix} = (-1)^{1+3} \\cdot 1 \\cdot \\det \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = 1 \\cdot (1 \\cdot 1 - 0 \\cdot 0) = 1\n$$\n将此结果代回，我们得到 $T$ 的行列式：\n$$\n\\det(T) = -1 \\cdot 1 = -1\n$$\n行列式是一个精确整数。", "answer": "$$\n\\boxed{-1}\n$$", "id": "2757663"}, {"introduction": "在构建了状态空间的基之后，一个自然而重要的问题是如何获得一个几何特性更优的基，即标准正交基。本练习将应用格拉姆-施密特（Gram-Schmidt）过程，将从可控性矩阵中选出的基向量转化为一组标准正交向量。此过程不仅能巩固标准正交化的方法，更重要的是，它揭示了在处理由动力学矩阵幂次迭代生成的、通常近似线性相关的克雷洛夫（Krylov）序列时，潜在的数值不稳定性问题 [@problem_id:2757650]。", "problem": "考虑一个处于可控标准型中的单输入线性时不变状态空间模型，其状态矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和输入矩阵 $B \\in \\mathbb{R}^{3 \\times 1}$ 如下所示：\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-6  -11  -6\n\\end{pmatrix}, \n\\qquad\nB \\;=\\; \\begin{pmatrix}\n0 \\\\\n0 \\\\\n1\n\\end{pmatrix}.\n$$\n在 $\\mathbb{R}^{3}$ 上使用标准的欧几里得内积，其定义为 $\\langle x,y\\rangle \\,=\\, x^{\\top} y$（对于 $x,y \\in \\mathbb{R}^{3}$）。将可控性矩阵 $C \\in \\mathbb{R}^{3 \\times 3}$ 构建为有序的克雷洛夫序列\n$$\nC \\;=\\; \\big[\\, B,\\, AB,\\, A^{2}B \\,\\big].\n$$\n对矩阵 $C$ 的列向量，按照给定顺序，关于标准内积应用经典的格拉姆-施密特正交化过程，从而产生一个标准正交基 $\\{q_{1},q_{2},q_{3}\\}$（这些基向量作为列向量构成矩阵 $Q \\in \\mathbb{R}^{3 \\times 3}$）和一个对角元为正的上三角矩阵 $R \\in \\mathbb{R}^{3 \\times 3}$，使得 $C \\,=\\, Q R$。在你的解答中，从可控性矩阵和格拉姆-施密特算法的定义出发，清晰地标明每一步中的每个投影、每个归一化前的中间向量以及所使用的范数。然后，讨论经典格拉姆-施密特过程在这种可控性/克雷洛夫设定下的数值条件问题，包括正交性损失是如何产生的，以及在何种情况下修正的格拉姆-施密特或豪斯霍尔德变换是更优的选择。\n\n标量 $r_{33}$，即 $R$ 的 $(3,3)$ 元素，其精确值是多少？请提供精确值，无需四舍五入。", "solution": "所提出的问题是有效的。这是一个在线性代数和控制论中定义明确的练习，基于既定的原理。它提供了所有必要的数据——状态矩阵 $A$、输入矩阵 $B$、可控性矩阵 $C$ 的定义以及要使用的算法（经典格拉姆-施密特）——以得出一个唯一的、可验证的解。该问题是客观的，没有歧义，并且不违反任何科学或数学定律。因此，将提供一个解答。\n\n第一步是根据给定的状态空间模型构建可控性矩阵 $C$。$C$ 的列向量，记为 $c_1, c_2, c_3$，构成一个克雷洛夫序列。\n给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n-6  -11  -6\n\\end{pmatrix}, \n\\qquad\nB = \\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}.\n$$\n可控性矩阵 $C = [\\ c_1 \\ c_2 \\ c_3 \\ ]$ 的列向量定义为 $c_1 = B$，$c_2 = AB$，和 $c_3 = A^2B$。\n\n第一列：\n$$\nc_1 = B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n第二列：\n$$\nc_2 = AB = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -6  -11  -6 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -6 \\end{pmatrix}.\n$$\n第三列：\n$$\nc_3 = A^2B = A(AB) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -6  -11  -6 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -6 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -6 \\\\ 0 \\cdot (-6) + 1 \\cdot (-11) + (-6) \\cdot (-6) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -6 \\\\ -11 + 36 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -6 \\\\ 25 \\end{pmatrix}.\n$$\n因此，可控性矩阵为：\n$$\nC = \\begin{pmatrix} 0  0  1 \\\\ 0  1  -6 \\\\ 1  -6  25 \\end{pmatrix}.\n$$\n接下来，我们对 $C$ 的列向量 $c_1, c_2, c_3$ 应用经典的格拉姆-施密特正交化过程。该过程生成一个标准正交基 $\\{q_1, q_2, q_3\\}$ 和一个上三角矩阵 $R = (r_{ij})$，使得 $C=QR$。对角元 $r_{kk}$ 要求为正。\n\n步骤 1：对 $c_1$ 进行正交化。\n归一化前的第一个中间向量 $v_1$ 就是 $c_1$：\n$$\nv_1 = c_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n$R$ 的相应对角元是 $v_1$ 的欧几里得范数：\n$$\nr_{11} = \\|v_1\\| = \\sqrt{0^2 + 0^2 + 1^2} = 1.\n$$\n由于要求 $r_{11}>0$，这是正确的。第一个标准正交向量 $q_1$ 是：\n$$\nq_1 = \\frac{v_1}{\\|v_1\\|} = \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n步骤 2：对 $c_2$ 进行正交化。\n我们找到 $c_2$ 与 $\\{q_1\\}$ 所张成的子空间正交的分量。$c_2$ 在 $q_1$ 上的投影由 $\\text{proj}_{q_1}(c_2) = \\langle q_1, c_2 \\rangle q_1$ 给出。系数 $\\langle q_1, c_2 \\rangle$ 是矩阵 $R$ 的元素 $r_{12}$：\n$$\nr_{12} = \\langle q_1, c_2 \\rangle = q_1^\\top c_2 = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -6 \\end{pmatrix} = -6.\n$$\n中间向量 $v_2$ 是通过从 $c_2$ 中减去这个投影得到的：\n$$\nv_2 = c_2 - r_{12} q_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ -6 \\end{pmatrix} - (-6) \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -6 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n对角元 $r_{22}$ 是 $v_2$ 的范数：\n$$\nr_{22} = \\|v_2\\| = \\sqrt{0^2 + 1^2 + 0^2} = 1.\n$$\n第二个标准正交向量 $q_2$ 是：\n$$\nq_2 = \\frac{v_2}{\\|v_2\\|} = \\frac{1}{1} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n\n步骤 3：对 $c_3$ 进行正交化。\n我们寻求 $c_3$ 与 $\\{q_1, q_2\\}$ 所张成的子空间正交的分量。这需要减去 $c_3$ 在 $q_1$ 和 $q_2$ 上的投影。\n$c_3$ 在 $q_1$ 上的投影是 $\\text{proj}_{q_1}(c_3) = \\langle q_1, c_3 \\rangle q_1$。系数是 $r_{13}$：\n$$\nr_{13} = \\langle q_1, c_3 \\rangle = q_1^\\top c_3 = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -6 \\\\ 25 \\end{pmatrix} = 25.\n$$\n$c_3$ 在 $q_2$ 上的投影是 $\\text{proj}_{q_2}(c_3) = \\langle q_2, c_3 \\rangle q_2$。系数是 $r_{23}$：\n$$\nr_{23} = \\langle q_2, c_3 \\rangle = q_2^\\top c_3 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -6 \\\\ 25 \\end{pmatrix} = -6.\n$$\n中间向量 $v_3$ 是通过从 $c_3$ 中减去这些投影得到的：\n$$\nv_3 = c_3 - r_{13} q_1 - r_{23} q_2 = \\begin{pmatrix} 1 \\\\ -6 \\\\ 25 \\end{pmatrix} - (25) \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} - (-6) \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\nv_3 = \\begin{pmatrix} 1 \\\\ -6 \\\\ 25 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 25 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 6 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n我们寻求的最终值是 $r_{33}$，即这个中间向量 $v_3$ 的范数：\n$$\nr_{33} = \\|v_3\\| = \\sqrt{1^2 + 0^2 + 0^2} = 1.\n$$\n\n问题已回答。然而，为完整起见，我们可以确定 $q_3$：\n$$\nq_3 = \\frac{v_3}{\\|v_3\\|} = \\frac{1}{1} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n\n现在进行所要求的关于数值条件的讨论。构成克雷洛夫序列 $[B, AB, \\dots, A^{n-1}B]$ 的可控性矩阵的列向量，随着维度的增加，通常会变得近似线性相关。这是因为矩阵 $A$ 的连续应用倾向于将向量与 $A$ 的主特征向量的方向对齐，这是幂迭代法所利用的一个原理。因此，可控性矩阵 $C$ 常常是病态的，意味着其列向量构成一个“几乎”线性相关的基。\n\n当一组病态的向量被用于经典格拉姆-施密特（CGS）过程时，会产生严重的数值不稳定性。CGS的核心操作是减去投影：$v_k = c_k - \\sum_{j=1}^{k-1} \\langle q_j, c_k \\rangle q_j$。如果 $c_k$ 几乎是前面向量 $c_1, \\dots, c_{k-1}$（因此也是 $q_1, \\dots, q_{k-1}$）的线性组合，那么 $v_k$ 将是通过减去一个非常接近 $c_k$ 本身的向量得到的结果。这会导致灾难性抵消，其中最高有效数字丢失，从而导致计算出的 $v_k$ 出现较大的相对误差。这种误差传播导致计算出的基 $\\{q_j\\}$ 严重丧失正交性；也就是说，当 $i \\neq j$ 时，$q_i^\\top q_j$ 的值将远非机器零。\n\n相比之下，修正的格拉姆-施密特（MGS）算法在数值上更稳定，尽管在精确算术中两者在数学上是等价的。MGS 重新排列了减法操作的顺序。在每一步 $k$ 中，它将当前向量与所有先前计算出的基向量正交化。然后，关键的是，它将相同的正交化过程应用于集合中所有*剩余*的向量。这种重复去除分量的做法可以防止误差的重新引入，并更有效地保持正交性。\n\n为了获得最大的数值稳定性，特别是对于像克雷洛夫矩阵这样的病态矩阵，豪斯霍尔德变换是更优越的方法。该方法通过应用一系列正交反射矩阵将矩阵 $C$ 的次对角线元素清零来计算 QR 分解。由于正交矩阵的乘积是完全正交的（在机器精度范围内），所得到的矩阵 $Q$ 在保持正交性方面远优于 CGS 或 MGS。在为克雷洛夫子空间构造标准正交基时，鲁棒的算法如阿诺德迭代（它基于 MGS 过程）是数值线性代数中的标准做法，其目的正是为了避免 CGS 的不稳定性。", "answer": "$$\n\\boxed{1}\n$$", "id": "2757650"}, {"introduction": "向量空间理论的强大之处在于其普适性，它不仅适用于 $\\mathbb{R}^n$ 中的几何向量，也适用于更抽象的对象，例如函数。本练习将经典控制理论的基石——传递函数——视为一个函数空间中的“向量”。通过计算一个传递函数在不同基（一种是多项式形式，另一种是部分分式形式）下的坐标，你将深刻理解基变换如何对应于工程中常用的不同数学表示形式之间的转换，例如部分分式展开 [@problem_id:2757652]。", "problem": "考虑由Laplace变量$s$中的单输入单输出传递函数构成的实向量空间，定义为\n$$\n\\mathcal{V} \\;=\\; \\left\\{\\, \\frac{P(s)}{Q(s)} \\;:\\; Q(s) \\,=\\, (s+1)^{2}(s+2),\\; P(s)\\in\\mathbb{R}[s],\\; \\deg P \\leq 2 \\,\\right\\}.\n$$\n根据其构造，$\\mathcal{V}$是线性时不变（LTI）控制理论中常用的实有理传递函数空间的一个有限维子空间。令$Q(s)=(s+1)^{2}(s+2)$。\n\n定义$\\mathcal{V}$的两个有序基：\n- 单项式分母基$\\mathcal{B}_{\\mathrm{mon}}=\\{\\, b_{1}(s),\\, b_{2}(s),\\, b_{3}(s)\\,\\}$，其中\n$$\nb_{1}(s)=\\frac{1}{Q(s)},\\quad b_{2}(s)=\\frac{s}{Q(s)},\\quad b_{3}(s)=\\frac{s^{2}}{Q(s)}.\n$$\n- 部分分式基$\\mathcal{B}_{\\mathrm{pf}}=\\{\\, c_{1}(s),\\, c_{2}(s),\\, c_{3}(s)\\,\\}$，其中\n$$\nc_{1}(s)=\\frac{1}{s+1},\\quad c_{2}(s)=\\frac{1}{(s+1)^{2}},\\quad c_{3}(s)=\\frac{1}{s+2}.\n$$\n\n令传递函数$G(s)\\in\\mathcal{V}$为\n$$\nG(s)\\;=\\;\\frac{5s^{2}-s+4}{(s+1)^{2}(s+2)}.\n$$\n\n仅使用向量空间、线性无关、基、坐标和基变换的线性代数定义：\n1) 计算$G(s)$关于基$\\mathcal{B}_{\\mathrm{mon}}$的坐标向量。\n2) 从基本定义出发，通过将基$\\mathcal{B}_{\\mathrm{pf}}$的基元素用基$\\mathcal{B}_{\\mathrm{mon}}$表示，并对得到的线性关系求逆，显式构造出将$\\mathcal{B}_{\\mathrm{mon}}$中的坐标映射到$\\mathcal{B}_{\\mathrm{pf}}$中的坐标的基变换映射。\n3) 应用此基变换以获得$G(s)$在基$\\mathcal{B}_{\\mathrm{pf}}$中的坐标向量。\n\n仅报告$G(s)$在基$\\mathcal{B}_{\\mathrm{pf}}$中的最终坐标向量作为答案，格式化为行向量。不需要四舍五入；请给出精确值。", "solution": "所给问题是线性代数中的一个标准练习，应用于与控制理论相关的有理函数向量空间。该问题是适定的、自洽的且科学上合理的。我们将着手解决它。\n\n该向量空间为$\\mathcal{V} = \\left\\{\\, \\frac{P(s)}{Q(s)} \\;:\\; Q(s) = (s+1)^{2}(s+2),\\; P(s)\\in\\mathbb{R}[s],\\; \\deg P \\leq 2 \\,\\right\\}$。该空间的维数为3，因为分子多项式由3个系数确定。我们已知该空间的两个基：\n单项式分母基$\\mathcal{B}_{\\mathrm{mon}}=\\{\\, b_{1}(s),\\, b_{2}(s),\\, b_{3}(s)\\,\\}$，其中$b_{1}(s)=\\frac{1}{Q(s)}$，$b_{2}(s)=\\frac{s}{Q(s)}$，$b_{3}(s)=\\frac{s^{2}}{Q(s)}$。\n部分分式基$\\mathcal{B}_{\\mathrm{pf}}=\\{\\, c_{1}(s),\\, c_{2}(s),\\, c_{3}(s)\\,\\}$，其中$c_{1}(s)=\\frac{1}{s+1}$，$c_{2}(s)=\\frac{1}{(s+1)^{2}}$，$c_{3}(s)=\\frac{1}{s+2}$。\n我们感兴趣的向量是$G(s) = \\frac{5s^{2}-s+4}{(s+1)^{2}(s+2)}$。\n\n我们的目标是找到$G(s)$关于基$\\mathcal{B}_{\\mathrm{pf}}$的坐标向量。我们将遵循指定的三个步骤。\n\n首先，我们计算$G(s)$关于基$\\mathcal{B}_{\\mathrm{mon}}$的坐标向量，记作$[G]_{\\mathcal{B}_{\\mathrm{mon}}}$。根据定义，我们必须找到标量$k_{1}$、$k_{2}$、$k_{3}$，使得$G(s) = k_{1}b_{1}(s) + k_{2}b_{2}(s) + k_{3}b_{3}(s)$。\n代入$G(s)$和基向量$b_{i}(s)$的定义：\n$$\n\\frac{5s^{2}-s+4}{Q(s)} = k_{1}\\frac{1}{Q(s)} + k_{2}\\frac{s}{Q(s)} + k_{3}\\frac{s^{2}}{Q(s)} = \\frac{k_{1} + k_{2}s + k_{3}s^{2}}{Q(s)}.\n$$\n为使这两个有理函数相等，它们的分子必须相等。通过比较分子多项式的系数，我们得到：\n$$\nk_{3}s^{2} + k_{2}s + k_{1} \\;=\\; 5s^{2} - 1s + 4.\n$$\n此等式必须对所有$s$成立，因此我们通过比较$s$的同次幂的系数得到：\n$k_{1} = 4$, $k_{2} = -1$, $k_{3} = 5$.\n因此，$G(s)$在基$\\mathcal{B}_{\\mathrm{mon}}$中的坐标向量是\n$$\n[G]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 4 \\\\ -1 \\\\ 5 \\end{pmatrix}.\n$$\n\n第二步，我们构造从$\\mathcal{B}_{\\mathrm{mon}}$到$\\mathcal{B}_{\\mathrm{pf}}$的基变换矩阵，我们将其记作$P_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}}$。问题指定了一种方法：将基$\\mathcal{B}_{\\mathrm{pf}}$的基向量用$\\mathcal{B}_{\\mathrm{mon}}$的基向量表示，这给出了矩阵$P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}}$，然后对其求逆。\n让我们将$\\mathcal{B}_{\\mathrm{pf}}$中的每个向量$c_{i}(s)$写成$\\mathcal{B}_{\\mathrm{mon}}$中向量的线性组合：\n对于$c_{1}(s)$:\n$$\nc_{1}(s) = \\frac{1}{s+1} = \\frac{(s+1)(s+2)}{(s+1)^{2}(s+2)} = \\frac{s^{2}+3s+2}{Q(s)} = 2\\frac{1}{Q(s)} + 3\\frac{s}{Q(s)} + 1\\frac{s^{2}}{Q(s)} = 2b_{1}(s) + 3b_{2}(s) + 1b_{3}(s).\n$$\n坐标向量为$[c_{1}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 1 \\end{pmatrix}$。\n对于$c_{2}(s)$:\n$$\nc_{2}(s) = \\frac{1}{(s+1)^{2}} = \\frac{s+2}{(s+1)^{2}(s+2)} = \\frac{s+2}{Q(s)} = 2\\frac{1}{Q(s)} + 1\\frac{s}{Q(s)} + 0\\frac{s^{2}}{Q(s)} = 2b_{1}(s) + 1b_{2}(s) + 0b_{3}(s).\n$$\n坐标向量为$[c_{2}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n对于$c_{3}(s)$:\n$$\nc_{3}(s) = \\frac{1}{s+2} = \\frac{(s+1)^{2}}{(s+1)^{2}(s+2)} = \\frac{s^{2}+2s+1}{Q(s)} = 1\\frac{1}{Q(s)} + 2\\frac{s}{Q(s)} + 1\\frac{s^{2}}{Q(s)} = 1b_{1}(s) + 2b_{2}(s) + 1b_{3}(s).\n$$\n坐标向量为$[c_{3}]_{\\mathcal{B}_{\\mathrm{mon}}} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 1 \\end{pmatrix}$。\n从$\\mathcal{B}_{\\mathrm{pf}}$到$\\mathcal{B}_{\\mathrm{mon}}$的基变换矩阵由这些坐标向量作为其列构成：\n$$\nP_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}} = \\begin{pmatrix} [c_{1}]_{\\mathcal{B}_{\\mathrm{mon}}}  [c_{2}]_{\\mathcal{B}_{\\mathrm{mon}}}  [c_{3}]_{\\mathcal{B}_{\\mathrm{mon}}} \\end{pmatrix} = \\begin{pmatrix} 2  2  1 \\\\ 3  1  2 \\\\ 1  0  1 \\end{pmatrix}.\n$$\n坐标的映射由$[v]_{\\mathcal{B}_{\\mathrm{mon}}} = P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}} [v]_{\\mathcal{B}_{\\mathrm{pf}}}$给出。为了找到从$\\mathcal{B}_{\\mathrm{mon}}$坐标到$\\mathcal{B}_{\\mathrm{pf}}$坐标的映射，我们必须计算该矩阵的逆：\n$$\nP_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} = (P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}})^{-1}.\n$$\n令$A = P_{\\mathcal{B}_{\\mathrm{mon}} \\leftarrow \\mathcal{B}_{\\mathrm{pf}}}$。$A$的行列式是：\n$$\n\\det(A) = 2(1\\cdot 1 - 2\\cdot 0) - 2(3\\cdot 1 - 2\\cdot 1) + 1(3\\cdot 0 - 1\\cdot 1) = 2(1) - 2(1) - 1 = -1.\n$$\n由于行列式不为零，该矩阵是可逆的。其逆矩阵为$A^{-1} = \\frac{1}{\\det(A)}\\mathrm{adj}(A)$。伴随矩阵$\\mathrm{adj}(A)$是代数余子矩阵的转置。\n代数余子矩阵是：\n$$\nC = \\begin{pmatrix} +\\begin{vmatrix} 1  2 \\\\ 0  1 \\end{vmatrix}  -\\begin{vmatrix} 3  2 \\\\ 1  1 \\end{vmatrix}  +\\begin{vmatrix} 3  1 \\\\ 1  0 \\end{vmatrix} \\\\ -\\begin{vmatrix} 2  1 \\\\ 0  1 \\end{vmatrix}  +\\begin{vmatrix} 2  1 \\\\ 1  1 \\end{vmatrix}  -\\begin{vmatrix} 2  2 \\\\ 1  0 \\end{vmatrix} \\\\ +\\begin{vmatrix} 2  1 \\\\ 1  2 \\end{vmatrix}  -\\begin{vmatrix} 2  1 \\\\ 3  2 \\end{vmatrix}  +\\begin{vmatrix} 2  2 \\\\ 3  1 \\end{vmatrix} \\end{pmatrix} = \\begin{pmatrix} 1  -1  -1 \\\\ -2  1  2 \\\\ 3  -1  -4 \\end{pmatrix}.\n$$\n伴随矩阵是$\\mathrm{adj}(A) = C^{T} = \\begin{pmatrix} 1  -2  3 \\\\ -1  1  -1 \\\\ -1  2  -4 \\end{pmatrix}$。\n因此，逆矩阵是：\n$$\nP_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} = \\frac{1}{-1} \\begin{pmatrix} 1  -2  3 \\\\ -1  1  -1 \\\\ -1  2  -4 \\end{pmatrix} = \\begin{pmatrix} -1  2  -3 \\\\ 1  -1  1 \\\\ 1  -2  4 \\end{pmatrix}.\n$$\n\n第三步，我们将此基变换矩阵应用于坐标向量$[G]_{\\mathcal{B}_{\\mathrm{mon}}}$以获得$[G]_{\\mathcal{B}_{\\mathrm{pf}}}$。\n变换法则是$[G]_{\\mathcal{B}_{\\mathrm{pf}}} = P_{\\mathcal{B}_{\\mathrm{pf}} \\leftarrow \\mathcal{B}_{\\mathrm{mon}}} [G]_{\\mathcal{B}_{\\mathrm{mon}}}$。\n$$\n[G]_{\\mathcal{B}_{\\mathrm{pf}}} = \\begin{pmatrix} -1  2  -3 \\\\ 1  -1  1 \\\\ 1  -2  4 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ -1 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} (-1)(4) + (2)(-1) + (-3)(5) \\\\ (1)(4) + (-1)(-1) + (1)(5) \\\\ (1)(4) + (-2)(-1) + (4)(5) \\end{pmatrix} = \\begin{pmatrix} -4 - 2 - 15 \\\\ 4 + 1 + 5 \\\\ 4 + 2 + 20 \\end{pmatrix} = \\begin{pmatrix} -21 \\\\ 10 \\\\ 26 \\end{pmatrix}.\n$$\n因此，$G(s)$关于基$\\mathcal{B}_{\\mathrm{pf}}$的坐标向量是$\\begin{pmatrix} -21 \\\\ 10 \\\\ 26 \\end{pmatrix}$。这对应于部分分式展开$G(s) = \\frac{-21}{s+1} + \\frac{10}{(s+1)^{2}} + \\frac{26}{s+2}$。\n\n按要求格式化为行向量的最终答案，是此列向量的转置。", "answer": "$$\n\\boxed{\\begin{pmatrix} -21  10  26 \\end{pmatrix}}\n$$", "id": "2757652"}]}