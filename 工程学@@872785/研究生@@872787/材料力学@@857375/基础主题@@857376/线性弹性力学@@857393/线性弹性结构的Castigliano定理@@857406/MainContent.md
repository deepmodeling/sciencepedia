## 引言
在结构力学领域，精确预测结构在荷载下的响应——即其位移和内力[分布](@entry_id:182848)——是设计的核心。传统方法往往依赖于建立并求解复杂的[微分方程](@entry_id:264184)，而基于能量的原理则为分析提供了另一条优雅而强大的途径。其中，由意大利工程师 Alberto Castigliano 提出的[卡氏定理](@entry_id:191013)，通过建立结构内部储存的[应变能](@entry_id:162699)与外部力和位移之间的直接联系，极大地简化了许多复杂问题的求解过程。该方法不仅在概念上具有深刻的物理意义，在工程实践中也展示出卓越的效率，特别是在处理复杂几何形状和静[不定系统](@entry_id:750604)时。本文旨在系统性地介绍[卡氏定理](@entry_id:191013)，填补理论知识与实际应用之间的鸿沟。

在接下来的内容中，我们将分三个章节深入探索[卡氏定理](@entry_id:191013)。第一章“原理与机制”将从应变能的基本概念入手，揭示其与应力和应变的内在关系，并在此基础上严谨地推导卡氏第一和第二定理，阐明其背后的能量对偶性。第二章“应用与跨学科联系”将展示该定理的强大实践价值，通过丰富的实例说明如何运用它计算位移、求解[静不定结构](@entry_id:185344)，并探讨其在[热弹性力学](@entry_id:158447)和[结构优化](@entry_id:176910)等交叉领域的应用。最后，在“动手实践”部分，我们将通过一系列精心设计的练习，引导读者亲手应用所学知识解决具体的工程问题，从而将理论理解转化为扎实的分析技能。

## 原理与机制

在对线弹性结构进行分析时，基于能量的原理提供了一种强大而优雅的替代方法，以补充或取代直接求解控制[微分方程](@entry_id:264184)的方法。本章深入探讨了[卡氏定理](@entry_id:191013) (Castigliano's theorems) 背后的基本原理与机制。这些定理将结构的[应变能](@entry_id:162699)与其位移和力联系起来，为计算位移和求解[静不定结构](@entry_id:185344)提供了高效的途径。我们将从[应变能](@entry_id:162699)的基本概念出发，建立其与力和位移的对偶关系，展示其在各种工程问题中的应用，并明确其[适用范围](@entry_id:636189)的边界。

### 弹性应变能

当弹性体受外力作用而变形时，外力所做的功以**[应变能](@entry_id:162699) (strain energy)** 的形式储存在物体内部。对于一个保守系统，卸载后，储存的能量可以完全释放，使物体恢复原状。这种[能量储存](@entry_id:264866)的路径无关性是弹性行为的核心特征。

从根本上说，做功的[路径无关性](@entry_id:163750)意味着应[力场](@entry_id:147325)在应变空间中是一个[保守场](@entry_id:137555)。这要求应力张量 $\boldsymbol{\sigma}$ 可以通过一个标量势函数——**[应变能密度函数](@entry_id:755490)** $W(\boldsymbol{\varepsilon})$ ——的梯度来表示：

$$
\sigma_{ij} = \frac{\partial W}{\partial \varepsilon_{ij}}
$$

其中 $\sigma_{ij}$ 是柯西应力张量 (Cauchy stress tensor) 的分量，$\varepsilon_{ij}$ 是[小应变张量](@entry_id:754968) (small strain tensor) 的分量。这种材料被称为**[超弹性材料](@entry_id:190241) (hyperelastic material)**。根据[克莱罗定理](@entry_id:139814) (Clairaut's theorem)，上述关系成立的充分必要条件是[混合偏导数相等](@entry_id:138898)，即：

$$
\frac{\partial \sigma_{ij}}{\partial \varepsilon_{kl}} = \frac{\partial \sigma_{kl}}{\partial \varepsilon_{ij}}
$$

对于线性弹性材料，其[本构关系](@entry_id:186508)为 $\sigma_{ij} = C_{ijkl}\varepsilon_{kl}$，其中 $C_{ijkl}$ 是[四阶弹性张量](@entry_id:188318)。将此关系代入上述条件，我们得到[弹性张量](@entry_id:170728)必须具有**主对称性 (major symmetry)** [@problem_id:2870226]：

$$
C_{ijkl} = C_{klij}
$$

这一对称性保证了[应变能密度函数](@entry_id:755490)的存在。对于满足 $\boldsymbol{\varepsilon}=0$ 时 $\boldsymbol{\sigma}=0$ 的线性材料，其[应变能密度函数](@entry_id:755490)必然是应变的二次齐次函数：

$$
W(\boldsymbol{\varepsilon}) = \frac{1}{2} C_{ijkl} \varepsilon_{ij} \varepsilon_{kl}
$$

总[应变能](@entry_id:162699) $U$ 是[应变能密度](@entry_id:200085)在整个物体体积 $V$ 上的积分：

$$
U = \int_V W(\boldsymbol{\varepsilon}) \, dV = \int_V \frac{1}{2} \sigma_{ij} \varepsilon_{ij} \, dV
$$

在梁、杆、轴等一维结构构件的分析中，将总应变能表示为沿构件长度的[内力](@entry_id:167605)（轴力 $N$、剪力 $V$、[弯矩](@entry_id:202968) $M$ 和扭矩 $T$）的积分通常更为方便。假设材料是均匀、各向同性的线弹性体，通过在[横截面](@entry_id:154995)上对应力[分布](@entry_id:182848)进行积分，可以推导出各种内力分量所储存的[应变能](@entry_id:162699)。对于一个一般的梁柱构件，总应变能可以分解为四种基本变形模式的能量之和 [@problem_id:2870269]：

$$
U = \int_{0}^{L} \left( \frac{N(x)^2}{2EA} + \frac{M(x)^2}{2EI} + \frac{V(x)^2}{2\kappa GA} + \frac{T(x)^2}{2GJ} \right) \, dx
$$

这里：
- $L$ 是构件的长度。
- $E$ 是[杨氏模量](@entry_id:140430) (Young's modulus)，$G$ 是剪切模量 (shear modulus)。
- $A$ 是[横截面](@entry_id:154995)积，$I$ 是关于弯曲中性轴的[截面](@entry_id:154995)二次矩，$J$ 是抗扭常数。
- $\kappa$ 是铁木辛柯剪切修正系数 (Timoshenko shear correction factor)，用于修正因剪应力在[截面](@entry_id:154995)上不[均匀分布](@entry_id:194597)而导致的剪切[应变能](@entry_id:162699)计算偏差。
- $N(x), M(x), V(x), T(x)$ 分别是沿构件轴线 $x$ [分布](@entry_id:182848)的轴力、[弯矩](@entry_id:202968)、[剪力](@entry_id:172634)和扭矩。

值得注意的是，与正应力（拉伸和弯曲）相关的项包含[杨氏模量](@entry_id:140430) $E$，而与剪应力（剪切和扭转）相关的项包含剪切模量 $G$。这种能量的[叠加原理](@entry_id:144649)是线性理论的一个直接推论。

### 卡氏第一和第二定理：能量的对偶性

[卡氏定理](@entry_id:191013)揭示了[应变能](@entry_id:162699)与[广义力](@entry_id:169699)及广义位移之间的深刻联系。这套理论包含两个对偶的定理。

#### 卡氏第一定理

考虑一个由一组广义位移 $\mathbf{q} = \{q_i\}$ 描述其构型的弹性系统。其内部储存的[应变能](@entry_id:162699)是这些位移的函数，记为 $U(\mathbf{q})$。系统的**总势能** $\Pi$ 是应变能与外力势能之和。对于一组[广义力](@entry_id:169699) $\mathbf{F} = \{F_i\}$，外力[势能](@entry_id:748988)为 $-\mathbf{F}^T\mathbf{q}$。因此：

$$
\Pi(\mathbf{q}) = U(\mathbf{q}) - \mathbf{F}^T\mathbf{q}
$$

根据[最小势能原理](@entry_id:173340)，系统处于稳定平衡状态时，其总[势能](@entry_id:748988) $\Pi$ 相对于任意容许的微小位移变化（[虚位移](@entry_id:168781)）取驻值。这意味着 $\Pi$ 对所有 $q_i$ 的偏导数必须为零：

$$
\frac{\partial \Pi}{\partial q_i} = \frac{\partial U}{\partial q_i} - F_i = 0
$$

由此得到**卡氏第一定理** [@problem_id:2870242]：

$$
F_i = \frac{\partial U}{\partial q_i}
$$

该定理表明，作用于某[广义坐标](@entry_id:156576)上的[广义力](@entry_id:169699)，等于[应变能函数](@entry_id:178435)对该[广义坐标](@entry_id:156576)的偏导数。这个定理是位移法（如有限元法）的理论基础，在这些方法中，位移是基本未知量。

#### [卡氏第二定理](@entry_id:176952)

与[应变能](@entry_id:162699) $U(\mathbf{q})$ 对偶的是**[余能](@entry_id:192009) (complementary energy)**，记为 $U^*$。余能被定义为力的函数 $U^*(\mathbf{F})$。对于[超弹性材料](@entry_id:190241)，[应变能](@entry_id:162699)和[余能](@entry_id:192009)通过[勒让德变换](@entry_id:146727) (Legendre transformation) 联系在一起：

$$
U^*(\mathbf{F}) = \mathbf{F}^T\mathbf{q} - U(\mathbf{q})
$$

通过对上式求导，可以得到与卡氏第一定理对偶的**[卡氏第二定理](@entry_id:176952)**：

$$
q_i = \frac{\partial U^*}{\partial F_i}
$$

该定理指出，在某[广义力](@entry_id:169699)作用点沿该力方向的广义位移，等于[余能](@entry_id:192009)函数对该[广义力](@entry_id:169699)的[偏导数](@entry_id:146280)。

对于**[线性弹性](@entry_id:166983)系统**，应力与应变成[线性关系](@entry_id:267880)，可以证明其[应变能](@entry_id:162699)与[余能](@entry_id:192009)在数值上是相等的，即 $U = U^*$ [@problem_id:2870248]。这是一个非常特殊且方便的性质。因此，在分析线性结构时，工程师们通常不严格区分[应变能](@entry_id:162699)和[余能](@entry_id:192009)，并习惯将[卡氏第二定理](@entry_id:176952)写作：

$$
\delta_i = \frac{\partial U}{\partial F_i}
$$

在此表达式中，$\delta_i$ 是力 $F_i$ 方向上的位移。**必须强调**，这里的 $U$ 必须被表达为**外力**的函数，而不是位移的函数 [@problem_id:2870269]。这个约定虽然在符号上不严谨，但在实践中被广泛采用。本章后续内容也将遵循此惯例来应用[卡氏第二定理](@entry_id:176952)于线性结构。

### 应用：计算位移

[卡氏第二定理](@entry_id:176952)为计算结构中任意点的线位移或[角位移](@entry_id:171094)提供了一个优雅而强大的工具。

#### 直接应用

如果要求解的位移（或转角）恰好位于一个已知的外力（或外力偶）的作用点，并且方向一致，那么可以直接应用定理。只需将总[应变能](@entry_id:162699) $U$ 表示为包括该力在内的所有外力的函数，然后对该力求[偏导数](@entry_id:146280)即可。

#### 虚力法（[单位荷载法](@entry_id:187966)）

在更多情况下，我们需要计算某点在某方向的位移，但该处并没有对应的外力作用。例如，我们可能需要计算梁上某点 $C$ 的转角 $\theta_C$，但该点并无外力偶作用。此时，我们可以采用一种称为**虚力法 (dummy load method)** 的技巧 [@problem_id:2870210]。

该方法的步骤如下：
1.  在要求解位移的点，沿该位移方向施加一个**虚构的（虚拟的）[广义力](@entry_id:169699)**。例如，为了求转角 $\theta_C$，我们在 $C$ 点施加一个虚拟力偶 $M_{dummy}$。
2.  将总应变能 $U$ 表示为所有真实外荷载和这个[虚拟力](@entry_id:165088)的函数。
3.  根据[卡氏第二定理](@entry_id:176952)，所求位移是应变能对该虚拟力的[偏导数](@entry_id:146280)。
4.  在求导完成后，将[虚拟力](@entry_id:165088)的大小设为零，即可得到仅由真实荷载引起的位移。

数学上，这一过程表示为：

$$
\theta_C = \left. \frac{\partial U}{\partial M_{dummy}} \right|_{M_{dummy}=0}
$$

作为一个具体的例子，考虑一个悬臂梁，在自由端 $x=L$ 处承受一个集中力 $P$。我们希望求出位于 $x=c$ ($c  L$) 处 $C$ 点的转角。梁的[抗弯刚度](@entry_id:180453)为 $EI$。

首先，在 $C$ 点施加一个逆时针的虚拟力偶 $M_{dummy}$。梁上任一点 $x$ 处的[弯矩](@entry_id:202968) $M(x)$ 为：

$$
M(x) = \begin{cases} P(L-x) + M_{dummy}  \text{for } 0 \le x  c \\ P(L-x)  \text{for } c \le x \le L \end{cases}
$$

（这里我们以使梁下部受拉的[弯矩](@entry_id:202968)为正）。总应变能（只考虑弯曲）为 $U = \int_0^L \frac{M(x)^2}{2EI} dx$。根据[求导法则](@entry_id:145443)，转角为：

$$
\theta_C = \frac{\partial U}{\partial M_{dummy}} = \int_0^L \frac{M(x)}{EI} \frac{\partial M(x)}{\partial M_{dummy}} dx
$$

注意到 $\partial M(x) / \partial M_{dummy}$ 在 $0 \le x  c$ 区间为 $1$，在其他区间为 $0$。因此，积分范围缩小到 $[0, c]$。

$$
\theta_C = \int_0^c \frac{P(L-x) + M_{dummy}}{EI} (1) dx
$$

现在，令[虚拟力](@entry_id:165088)偶为零 ($M_{dummy}=0$)：

$$
\theta_C = \int_0^c \frac{P(L-x)}{EI} dx = \frac{P}{EI} \left[ Lx - \frac{x^2}{2} \right]_0^c = \frac{P(2Lc - c^2)}{2EI}
$$

这个结果是通过系统地应用虚力法得到的。值得注意的是，在应用[卡氏定理](@entry_id:191013)时，我们隐式地使用了在积分号下求导的运算。这一操作的合法性基于[莱布尼茨积分法则](@entry_id:145735) (Leibniz integral rule)。对于线性弹性结构，其[应变能](@entry_id:162699)是外荷载的二次函数，这保证了求导运算的良好性质，只要结构的总应变能是有限的，这一操作就是有效且严谨的 [@problem_id:2870251]。

### 高级应用与倒易定理

除了计算位移，[卡氏定理](@entry_id:191013)在解决更复杂的问题和揭示结构的深刻性质方面也扮演着核心角色。

#### 求解[静不定结构](@entry_id:185344)

对于[静不定结构](@entry_id:185344)，[静力平衡](@entry_id:163498)方程不足以确定所有的未知反力或内力。多出的未知力被称为**冗余力 (redundant forces)**。[卡氏第二定理](@entry_id:176952)为求解这些冗余力提供了基于**变形协调条件 (compatibility conditions)** 的系统方法，这通常被称为**力法 (force method)**。

其基本步骤如下 [@problem_id:2870258]：
1.  确定结构的[静不定](@entry_id:178116)次数 $n$。
2.  选择 $n$ 个力（通常是反力或内力）作为冗余力。移除这些冗余力对应的约束，使结构变为静定的**基本体系 (primary structure)**。
3.  将原结构的荷载和这些未知的冗余力 $R_1, R_2, \dots, R_n$ 共同作用于基[本体](@entry_id:264049)系上。
4.  计算基[本体](@entry_id:264049)系的内力[分布](@entry_id:182848)，并将其表示为外荷载和冗余力 $R_i$ 的函数。
5.  写出总[应变能](@entry_id:162699) $U$ 作为冗余力 $R_i$ 的函数。
6.  对每一个冗余力 $R_i$，应用[卡氏第二定理](@entry_id:176952)。在原结构中，冗余力作用处的位移是已知的（例如，刚性支座处的位移为零）。这就提供了一个方程：
    $$
    \delta_i = \frac{\partial U}{\partial R_i}
    $$
    其中 $\delta_i$ 是在冗余力 $R_i$ 对应的约束处的已知位移（对于固定的支座，通常 $\delta_i=0$）。
7.  这样可以得到一个包含 $n$ 个方程的线性方程组，求解这个[方程组](@entry_id:193238)即可得到所有冗余力。

例如，对于一个长度为 $L$，一端固定、另一端简支的梁（静定次数为1），在均布荷载 $w$ 作用下，我们可以选择简支端的反力 $R_B$ 作为冗余力。将[应变能](@entry_id:162699) $U$ 表示为 $w$ 和 $R_B$ 的函数，然后利用简支端位移为零的协调条件 $\partial U / \partial R_B = 0$，就可以解出 $R_B = \frac{3}{8}wL$ [@problem_id:2870258]。

#### 影响系数与麦克斯韦倒易定理

[卡氏定理](@entry_id:191013)还自然地引出了线弹性结构的一个基本性质——倒易性。定义**影响系数 (influence coefficient)** 或柔度系数 $a_{ij}$ 为作用在 $j$ 点的单位力在 $i$ 点沿特定方向引起的位移。根据[卡氏第二定理](@entry_id:176952)的定义：

$$
a_{ij} = \frac{\partial \delta_i}{\partial F_j} = \frac{\partial}{\partial F_j} \left( \frac{\partial U}{\partial F_i} \right) = \frac{\partial^2 U}{\partial F_i \partial F_j}
$$

由于对于一个光滑的[应变能函数](@entry_id:178435)，[二阶偏导数](@entry_id:635213)的顺序可以交换，我们立即得到 [@problem_id:2870224]：

$$
a_{ij} = \frac{\partial^2 U}{\partial F_i \partial F_j} = \frac{\partial^2 U}{\partial F_j \partial F_i} = a_{ji}
$$

这就是**麦克斯韦倒易定理 (Maxwell's reciprocal theorem)**。它指出：作用在 $j$ 点的单位力在 $i$ 点引起的位移，等于作用在 $i$ 点的单位力在 $j$ 点引起的位移。这是一个非凡的结论，例如，它意味着如果一座桥梁的 $A$ 点上施加 $1$ 千牛的力导致 $B$ 点下沉 $1$ 毫米，那么在 $B$ 点施加 $1$ 千牛的力也必将导致 $A$ 点下沉 $1$ 毫米。

更一般地，**贝蒂倒易定理 (Betti's reciprocal theorem)** 指出，对于一个线弹性体，两组不同的荷载系统 $\{ \mathbf{b}^{(1)}, \mathbf{t}^{(1)} \}$ 和 $\{ \mathbf{b}^{(2)}, \mathbf{t}^{(2)} \}$ 及其产生的位移场 $\mathbf{u}^{(1)}$ 和 $\mathbf{u}^{(2)}$，存在如下关系：

$$
\int_{\Omega} \mathbf{b}^{(1)} \cdot \mathbf{u}^{(2)} dV + \int_{\partial \Omega} \mathbf{t}^{(1)} \cdot \mathbf{u}^{(2)} dS = \int_{\Omega} \mathbf{b}^{(2)} \cdot \mathbf{u}^{(1)} dV + \int_{\partial \Omega} \mathbf{t}^{(2)} \cdot \mathbf{u}^{(1)} dS
$$

这个定理的物理根源在于内部[虚功](@entry_id:176403)的双线性形式的对称性。即，第一组荷载产生的应[力场](@entry_id:147325)在第二组荷载产生的应变场上做的功，等于第二组荷载产生的应[力场](@entry_id:147325)在第一组荷载产生的应变场上做的功。这种对称性最终可以追溯到[弹性张量](@entry_id:170728)的主对称性，即材料的[超弹性](@entry_id:159356)（保守）本质 [@problem_id:2870230]。

### 局限性：线性的角色

[卡氏定理](@entry_id:191013)，特别是其第二定理的常用形式 $\delta = \partial U / \partial F$，其有效性严格依赖于系统的**线性**。这里的线性包含两个层面：材料线性和[几何线性](@entry_id:203076)。

- **材料线性**：应力与应变成正比（胡克定律）。
- **[几何线性](@entry_id:203076)**：位移和转动足够小，以至于可以在未变形的结构构型上建立平衡方程和几何关系（小变形假设）。

当[几何非线性](@entry_id:169896)变得显著时，即发生大位移或大转动时，情况会变得复杂。在这种情况下，结构的平衡构型本身依赖于荷载的大小。[应变能](@entry_id:162699) $U$ 是构型（即应变场）的函数，而不再是外力 $F$ 的显式函数。因此，直接对一个以几何参数为变量的[应变能函数](@entry_id:178435) $U$ 求关于力 $F$ 的偏导数是无效的 [@problem_id:2870259]。

考虑一个经历大挠度的悬臂梁（弹性线问题）。其应变能 $U$ 是梁的弯曲形状（例如，用尖端转角 $\theta$ [参数化](@entry_id:272587)）的函数 $U(\theta)$。力 $F$ 并不直接出现在 $U$ 的表达式中，所以 $(\partial U / \partial F)_\theta = 0$。然而，尖端位移 $\delta(\theta)$ 显然不为零。这表明经典的[卡氏第二定理](@entry_id:176952)失效了。

失败的根本原因在于**构型依赖性**：力 $F$ 通过[平衡方程](@entry_id:172166)确定了平衡构型 $\theta_{eq}(F)$，[应变能](@entry_id:162699)和位移都依赖于这个构型。正确的能量关系需要通过更广义的[变分原理](@entry_id:198028)（如[最小势能原理](@entry_id:173340)的包络定理）来建立，它会导出 $\delta = -d\Pi^*/dF$，其中 $\Pi^*$ 是总余势能。对于[线性系统](@entry_id:147850)，几何构型不随荷载变化，上述复杂性消失，[卡氏第二定理](@entry_id:176952)的简洁形式得以恢复。因此，深刻理解[卡氏定理](@entry_id:191013)的适用边界对于避免在[非线性](@entry_id:637147)问题中误用它们至关重要。