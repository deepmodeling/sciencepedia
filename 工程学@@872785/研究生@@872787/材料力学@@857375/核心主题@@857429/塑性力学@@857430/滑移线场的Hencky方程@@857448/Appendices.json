{"hands_on_practices": [{"introduction": "亨基方程是滑移线场理论的基石，它揭示了平面应变塑性流动中平均应力 $p$ 与主应力方向角 $\\theta$ 之间的内在联系。本练习将引导你直接应用亨基方程，计算当滑移线转过一个已知角度时平均应力的变化。通过这个基本计算，你将能够巩固对材料变形过程中应力如何随几何变化而演变的理解。", "problem": "一个处于平面应变状态的刚性理想塑性金属遵循冯·米塞斯屈服条件。在滑移线场理论中，定义平均应力为 $p = (\\sigma_{1} + \\sigma_{2})/2$，其中 $\\sigma_{1}$ 和 $\\sigma_{2}$ 是平面内主应力，并令 $k$ 表示恒定的剪切屈服应力。考虑一个由从 $O$ 点辐射出的直线组成的中心滑移线扇。该扇形区域由两个直线边界（记为边界 $\\mathcal{A}$ 和边界 $\\mathcal{B}$）界定，并且有一条 $\\alpha$ 滑移线穿过该扇形区域连接 $\\mathcal{A}$ 和 $\\mathcal{B}$。在边界 $\\mathcal{A}$ 上的点，主应力方向角 $\\theta$ 为 $\\theta_{1} = 15^\\circ$；在边界 $\\mathcal{B}$ 上的点，该角度为 $\\theta_{2} = 65^\\circ$。边界 $\\mathcal{A}$ 上的平均应力为 $p_{1} = 210\\,\\mathrm{MPa}$。材料参数为 $k = 95\\,\\mathrm{MPa}$。\n\n从平面基本平衡方程、 $p$ 和 $\\theta$ 的定义，以及 $k$ 为常数的刚性理想塑性冯·米塞斯响应出发，使用亨基特征关系式来确定沿连接的 $\\alpha$ 滑移线上边界 $\\mathcal{B}$ 处的平均应力。给定数据中的所有角度均以度为单位；确保任何涉及 $\\theta$ 的计算都将其视为弧度。将最终的平均应力 $p_{2}$ 以 $\\mathrm{MPa}$ 表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求根据边界 $\\mathcal{A}$ 上的状态和中心滑移线扇的几何形状，确定边界 $\\mathcal{B}$ 上的平均应力。材料是刚性理想塑性的，处于平面应变状态，并遵循冯·米塞斯屈服条件。求解过程通过应用亨基特征关系式来进行，这是滑移线场理论的基础。\n\n首先，我们建立理论框架。对于在平面应变条件下满足屈服准则的刚性理想塑性材料，任何发生塑性变形的点的应力状态可以由两个量来规定：平均应力 $p$ 和主应力方向角 $\\theta$。问题将平均应力定义为 $p = \\frac{\\sigma_{1} + \\sigma_{2}}{2}$。平面应变中的屈服准则可以用恒定的剪切屈服应力 $k$ 表示为 $\\frac{|\\sigma_{1} - \\sigma_{2}|}{2} = k$。\n\n当平衡控制方程与屈服准则相结合，并用 $p$ 和主应力方向角 $\\theta$ 表示时，它们构成一个双曲型偏微分方程组。该方程组的特征线就是滑移线本身，记为 $\\alpha$ 线和 $\\beta$ 线。沿着这些特征线，必须满足特定的关系，即所谓的亨基关系。对于以平均应力 $p$ 和主应力方向角 $\\theta$ 表示的系统，这些关系是：\n沿 $\\alpha$ 滑移线：\n$$ p + 2k\\theta = \\text{constant} $$\n沿 $\\beta$ 滑移线：\n$$ p - 2k\\theta = \\text{constant} $$\n在这些关系中，表示主应力方向的角度 $\\theta$ 必须以弧度为单位进行测量。\n\n问题陈述，一条 $\\alpha$ 族滑移线连接了边界 $\\mathcal{A}$ 上的一个点和边界 $\\mathcal{B}$ 上的一个点。我们将边界 $\\mathcal{A}$ 上的点记为点1，边界 $\\mathcal{B}$ 上的点记为点2。我们已知以下信息：\n在点1：平均应力 $p_{1} = 210\\,\\mathrm{MPa}$，主应力方向角 $\\theta_{1} = 15^\\circ$。\n在点2：主应力方向角为 $\\theta_{2} = 65^\\circ$，我们需要求出平均应力 $p_{2}$。\n材料参数为剪切屈服应力 $k = 95\\,\\mathrm{MPa}$。\n\n由于两点位于同一条 $\\alpha$ 滑移线上，亨基关系式 $p + 2k\\theta = \\text{constant}$ 必须对两点都成立。因此，我们可以写出：\n$$ p_{1} + 2k\\theta_{1} = p_{2} + 2k\\theta_{2} $$\n我们的目标是确定 $p_{2}$。重新整理方程以求解 $p_{2}$ 得：\n$$ p_{2} = p_{1} - 2k\\theta_{2} + 2k\\theta_{1} $$\n$$ p_{2} = p_{1} - 2k(\\theta_{2} - \\theta_{1}) $$\n\n在代入数值之前，我们必须按照亨基关系式的要求，将角度从度转换为弧度。\n角度的变化量是 $\\Delta\\theta = \\theta_{2} - \\theta_{1}$。\n$$ \\Delta\\theta = 65^\\circ - 15^\\circ = 50^\\circ $$\n为了将其转换为弧度，我们使用转换因子 $\\pi\\,\\mathrm{radians} = 180^\\circ$：\n$$ \\Delta\\theta_{\\text{rad}} = 50^\\circ \\times \\frac{\\pi}{180^\\circ} = \\frac{5\\pi}{18}\\,\\mathrm{radians} $$\n\n现在，我们将给定的 $p_{1}$、$k$ 和角度差 $\\Delta\\theta$ 的值代入 $p_{2}$ 的方程中：\n$$ p_{2} = 210\\,\\mathrm{MPa} - 2 \\times (95\\,\\mathrm{MPa}) \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 - 190 \\times \\left(\\frac{5\\pi}{18}\\right) $$\n$$ p_{2} = 210 - \\frac{950\\pi}{18} $$\n化简分数得：\n$$ p_{2} = 210 - \\frac{475\\pi}{9} $$\n\n为了得到最终的数值答案，我们计算这个表达式的值，并按要求四舍五入到四位有效数字。\n$$ p_{2} \\approx 210 - \\frac{475 \\times 3.14159265}{9} $$\n$$ p_{2} \\approx 210 - 165.806278... $$\n$$ p_{2} \\approx 44.193721... \\,\\mathrm{MPa} $$\n四舍五入到四位有效数字，我们得到：\n$$ p_{2} = 44.19\\,\\mathrm{MPa} $$\n这个值代表了在指定的 $\\alpha$ 滑移线上，边界 $\\mathcal{B}$ 处的平均应力。", "answer": "$$\n\\boxed{44.19}\n$$", "id": "2685849"}, {"introduction": "在掌握了Hencky方程的基本力学原理后，理解它如何与材料的本构模型相互作用至关重要。本练习旨在探讨两种最常见的金属塑性模型——Tresca屈服准则和von Mises屈服准则——之间的定量差异。通过计算在相同几何形状下这两种模型预测的极限载荷之比，你将深刻体会到屈服准则的选择如何直接影响工程预测的结果。", "problem": "考虑一个非常长的、理想塑性、不可压缩的条带，其高度为$H$，在两个刚性、完全粗糙的压板之间受到经典的 Prandtl 平面应变压缩。该条带是均匀且各向同性的，遵循关联流动法则，并且在 Tresca 和 von Mises (J$_{2}$) 两种屈服假设下，具有相同的单轴拉伸屈服应力 $\\sigma_{y}$。设 $\\bar{p}$ 表示传递到压板上的平均压缩压力（等效地，单位平面外厚度的总载荷除以压板接触长度）。\n\n使用二维刚性理想塑性流动的滑移线场理论：\n- 从二维平衡方程、塑性不可压缩性以及相应的屈服条件（Tresca 或 von Mises）出发，建立用平均应力 $p$ 和主应力方向角 $\\theta$ 表示的特征（滑移线）方程。\n- 通过无量纲化论证，确定归一化压力 $p/k$ 的场解是否依赖于 $k$ 的大小，其中 $k$ 是所选屈服准则下纯剪切中的剪切屈服应力。\n- 仔细解释从单轴屈服应力 $\\sigma_{y}$ 到剪切屈服应力 $k$ 的映射关系在 Tresca 和 von Mises 假设下有何不同。\n\n然后，在不引用任何预先制表的滑移线解中的特定问题数值常数的情况下，推导出对于相同的 $\\sigma_{y}$，平均压板压力的精确比值\n$$\n\\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}},\n$$\n并简要讨论两种预测之间任何差异的物理根源。将最终答案表示为一个精确的数字（无单位）。无需四舍五入。", "solution": "该问题是塑性力学中的一个经典问题，要求基于滑移线场理论的基本原理进行顺序推导。\n\n首先，我们建立特征方程。在平面应变条件下，处于屈服状态的刚性理想塑性材料中，应力状态由平均应力 $p = \\frac{1}{2}(\\sigma_{xx} + \\sigma_{yy})$ 和恒定的剪切屈服应力 $k$ 描述。应力分量可以用 $p$ 和主应力方向角 $\\theta$ 表示：\n$$ \\sigma_{xx} = p + k \\cos(2\\theta) $$\n$$ \\sigma_{yy} = p - k \\cos(2\\theta) $$\n$$ \\sigma_{xy} = k \\sin(2\\theta) $$\n这些分量必须满足无体力情况下的二维平衡方程 $\\frac{\\partial \\sigma_{ij}}{\\partial x_j} = 0$。将应力表达式代入平衡方程，我们得到关于 $p(x,y)$ 和 $\\theta(x,y)$ 的一阶偏微分方程组。这个双曲型方程组具有实特征线，即滑移线。\n\n沿着这些特征线，可以找到相容性关系式，即亨基方程。沿着一条 $\\alpha$-线（切线方向与 $x$ 轴夹角为 $\\theta - \\pi/4$），我们发现 $dp + 2k d\\theta = 0$，积分后得到：\n$$ p + 2k\\theta = C_1 \\quad (\\text{沿着一条 } \\alpha \\text{-线}) $$\n沿着一条 $\\beta$-线（切线方向与 $x$ 轴夹角为 $\\theta + \\pi/4$），我们发现 $dp - 2k d\\theta = 0$，积分后得到：\n$$ p - 2k\\theta = C_2 \\quad (\\text{沿着一条 } \\beta \\text{-线}) $$\n这些就是所求的特征方程。\n\n第二，我们使用无量纲化论证。我们定义一个归一化平均应力 $P = p/k$ 和归一化平均压缩压力 $\\bar{P} = \\bar{p}/k$。亨基方程变为：\n$$ P + 2\\theta = C_1 / k = C_1^* \\quad (\\text{沿着一条 } \\alpha \\text{-线}) $$\n$$ P - 2\\theta = C_2 / k = C_2^* \\quad (\\text{沿着一条 } \\beta \\text{-线}) $$\n滑移线场的几何形状由角度 $\\theta$ 和几何边界条件（如压板位置）决定。任何应力边界条件也可以归一化。例如，自由表面上的条件 $p=k$ 在归一化形式下变为 $P=1$。整个关于无量纲场 $P(x/H, y/H)$ 和 $\\theta(x/H, y/H)$ 的边值问题与 $H$ 和 $k$ 的具体值无关。因此，归一化压力 $p/k$ 和 $\\bar{p}/k$ 的解场是归一化坐标的一个普适函数，不依赖于 $k$ 的大小。\n\n第三，我们解释从单轴屈服应力 $\\sigma_y$ 到剪切屈服应力 $k$ 的映射关系。这种映射关系取决于所选择的屈服准则。\n对于 Tresca 准则，当最大剪切应力等于 $k_T$ 时发生屈服。在单轴拉伸试验中，主应力为 $(\\sigma_y, 0, 0)$，所以最大剪切应力为 $\\tau_{\\max} = (\\sigma_y - 0)/2 = \\sigma_y/2$。因此，对于 Tresca 准则：\n$$ k_T = \\frac{\\sigma_y}{2} $$\n对于 von Mises 准则，当偏应力张量的第二不变量 $J_2$ 达到临界值 $\\sigma_y^2/3$ 时发生屈服。在平面应变条件下，von Mises 准则等效于 $|\\sigma_1-\\sigma_2| = 2 \\sigma_y/\\sqrt{3}$。由于我们定义 $k = (\\sigma_1-\\sigma_2)/2$ 为面内最大剪应力，我们得到 $k_{VM} = \\sigma_y/\\sqrt{3}$。因此，对于 von Mises 准则：\n$$ k_{VM} = \\frac{\\sigma_y}{\\sqrt{3}} $$\n\n最后，我们推导平均压板压力的比值 $\\bar{p}_{\\text{Mises}}/\\bar{p}_{\\text{Tresca}}$。\n平均压力 $\\bar{p}$ 是施加在压板上的总压力。根据我们的无量纲化论证，归一化平均压力 $\\bar{p}/k$ 必定是一个常数，我们称之为 $C$，该常数仅取决于问题的几何形状和边界条件（完全粗糙的压板）。问题陈述指明了两种情况下几何形状和边界条件是相同的。\n$$ \\frac{\\bar{p}}{k} = C \\implies \\bar{p} = kC $$\n对于 Tresca 和 von Mises 分析，常数 $C$ 是相同的。因此，平均压力分别为：\n$$ \\bar{p}_{\\text{Tresca}} = k_T C $$\n$$ \\bar{p}_{\\text{Mises}} = k_{VM} C $$\n该比值就是各自剪切屈服应力的比值：\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{k_{VM}C}{k_T C} = \\frac{k_{VM}}{k_T} $$\n代入相同 $\\sigma_y$ 下的 $k_T$ 和 $k_{VM}$ 的表达式：\n$$ \\frac{\\bar{p}_{\\text{Mises}}}{\\bar{p}_{\\text{Tresca}}} = \\frac{\\sigma_y/\\sqrt{3}}{\\sigma_y/2} = \\frac{2}{\\sqrt{3}} $$\n\n这种差异的物理根源在于 von Mises 和 Tresca 屈服准则并不相同。在主应力空间中，von Mises 圆柱面外接于 Tresca 六角棱柱面。它们仅在特定的应力状态下重合。对于一般的多轴应力状态，例如平面应变压缩中存在的状态，von Mises 准则预测了更高的弹性极限。在 von Mises 假设下，材料实际上“更强”，这体现在 $k_{VM} \\approx 0.577\\sigma_y$ 大于 $k_T = 0.5\\sigma_y$。因此，需要更高的压力来引发并维持整个条带的塑性流动。", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{3}}}\n$$", "id": "2685824"}, {"introduction": "滑移线场的解析解非常罕见，仅限于一些简单的几何问题。本练习将引导你从理论走向实际计算，构建一个用于求解滑移线场的数值算法。通过实现龙格-库塔（Runge-Kutta）方法来积分控制微分方程，你将学会如何追踪滑移线的路径并确定沿线的应力分布，这是解决复杂实际问题的关键技术。", "problem": "要求您设计并实现一个数值推进算法，该算法需与固体力学中的平面理想塑性流动理论一致，用于从给定的初始数据沿$\\alpha$-滑移线积分平均应力场。该算法必须遵循经典的Hencky和Geiringer滑移线关系，适用于具有恒定剪切屈服应力的理想塑性、不可压缩的平面应变材料。\n\n从以下基本原理出发：\n\n- 本构和屈服假设：理想塑性，具有恒定的剪切屈服应力 $k$；平面应变，不可压缩流动；滑移线场理论适用。\n- 特征方向：在每个点上，存在两个正交的滑移线族，$\\alpha$ 和 $\\beta$。$\\alpha$-线的切线相对于固定的 $x$ 轴成 $\\theta - \\pi/4$ 角，其中 $\\theta$ 是主应力方向的旋转角度。\n- Hencky方程（特征应力关系）：沿 $\\alpha$-线，平均应力 $p$ 和主应力方向 $\\theta$ 满足 $dp = -2 k\\, d\\theta$。\n- 沿曲线运动的几何关系：如果 $s$ 表示沿 $\\alpha$-线的弧长，那么局部切线与 $x$ 轴的夹角为 $\\theta - \\pi/4$，因此 $dx/ds = \\cos(\\theta - \\pi/4)$ 且 $dy/ds = \\sin(\\theta - \\pi/4)$，其中 $x$ 和 $y$ 是笛卡尔坐标。\n- 曲率定义：$\\alpha$-线的曲率 $\\kappa_{\\alpha}$ 满足 $d\\theta/ds = \\kappa_{\\alpha}$，因为$\\alpha$-线的切线角是 $\\theta - \\pi/4$，而主应力方向角对弧长的导数等于曲率。在本问题中，沿 $\\alpha$-线的曲率 $\\kappa_{\\alpha}$ 作为 $\\theta$ 的一个给定函数给出，记为 $\\kappa(\\theta)$。\n\n由此，推导出一个以主应力方向 $\\theta$ 为自变量的常微分方程组。使用 $d\\theta/ds = \\kappa(\\theta)$ 得到 $ds/d\\theta = 1/\\kappa(\\theta)$，并与几何关系结合，得到\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta - \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta - \\pi/4)}{\\kappa(\\theta)}, \\qquad\n\\frac{dp}{d\\theta} = -2 k.\n$$\n角度必须以弧度处理。位置必须以米为单位，压力以帕斯卡为单位。\n\n您的任务是实现一个四阶Runge–Kutta推进算法，该算法沿 $\\alpha$-线从初始状态 $\\{x_0,y_0,p_0,\\theta_0\\}$ 积分上述方程组，直到达到最终方向 $\\theta_f$，其中给定恒定的屈服参数 $k$ 和规定的曲率函数 $\\kappa(\\theta)$。您必须确保 $\\kappa(\\theta)$ 在积分区间 $\\left[\\theta_0,\\theta_f\\right]$ 上不为零，以避免奇点。该算法应对正曲率和负曲率以及 $\\theta$ 的增加或减少都具有鲁棒性。\n\n测试套件规范：\n实现您的程序以解决以下三种情况。角度使用弧度，$x$ 和 $y$ 使用米，$p$ 和 $k$ 使用帕斯卡。\n\n- 情况1（恒定正曲率，解析基准）：\n  - $k = 1.0 \\times 10^{6}$，\n  - $\\kappa(\\theta) = 0.5$，\n  - $\\theta_0 = 0.0$，$\\theta_f = 0.5$，\n  - $x_0 = 0.0$, $y_0 = 0.0$, $p_0 = 5.0 \\times 10^{6}$。\n- 情况2（非均匀正曲率）：\n  - $k = 2.5 \\times 10^{6}$，\n  - $\\kappa(\\theta) = 0.2 + 0.1 \\cos(\\theta)$，\n  - $\\theta_0 = 0.2$，$\\theta_f = 1.0$，\n  - $x_0 = 1.0$, $y_0 = -0.5$, $p_0 = 1.0 \\times 10^{6}$。\n- 情况3（恒定负曲率，$\\theta$ 递减）：\n  - $k = 1.5 \\times 10^{6}$，\n  - $\\kappa(\\theta) = -0.3$，\n  - $\\theta_0 = 1.2$，$\\theta_f = 0.7$，\n  - $x_0 = -2.0$, $y_0 = 2.0$, $p_0 = 0.0$。\n\n数值和输出要求：\n\n- 为 $x(\\theta)$、$y(\\theta)$ 和 $p(\\theta)$ 的耦合系统实现一个关于 $\\theta$ 的四阶Runge–Kutta积分器。\n- 所有三角函数求值均使用弧度。\n- 确保在每种情况下选择的步长能充分解析区间 $\\left[\\theta_0,\\theta_f\\right]$；您可以选择对 $\\theta$ 进行均匀划分。\n- 对于每种情况，返回最终状态 $\\{x(\\theta_f), y(\\theta_f), p(\\theta_f)\\}$。\n- 将报告的每个 $x$、$y$ 和 $p$ 四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个Python风格的列表的列表，内含与上述三种情况相对应的三个三元组，顺序与上文一致，不含多余的空格或文本。例如：`[[x1,y1,p1],[x2,y2,p2],[x3,y3,p3]]`。\n\n注意：您不得假设超出所述基本原理的任何“捷径”公式；推导和实现必须基于给定的关系进行。通过检查确保 $\\kappa(\\theta)$ 在测试套件提供的积分区间上不为零，以保证科学真实性。", "solution": "问题陈述经确认为科学上合理、适定且完整。它提出了一个标准的初值问题，该问题源于固体力学中滑移线场理论的基本原理。任务是使用四阶Runge-Kutta方法对一个常微分方程组（ODEs）进行数值积分。\n\n该物理系统是在平面应变条件下的理想塑性、不可压缩材料。沿$\\alpha$-滑移线的材料状态由笛卡尔坐标 $(x, y)$、平均应力 $p$ 和主应力方向 $\\theta$ 描述。根据问题陈述，这些变量的演化由以下一阶常微分方程组控制，其中 $\\theta$ 为自变量：\n$$\n\\frac{dx}{d\\theta} = \\frac{\\cos(\\theta - \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dy}{d\\theta} = \\frac{\\sin(\\theta - \\pi/4)}{\\kappa(\\theta)}\n$$\n$$\n\\frac{dp}{d\\theta} = -2k\n$$\n其中 $k$ 是恒定的剪切屈服应力，$\\kappa(\\theta)$ 是作为 $\\theta$ 函数的$\\alpha$-滑移线的给定曲率。\n\n我们可以将此方程组写成向量形式。设状态向量为 $\\mathbf{y}(\\theta) = [x(\\theta), y(\\theta), p(\\theta)]^T$。该系统可表示为：\n$$\n\\frac{d\\mathbf{y}}{d\\theta} = \\mathbf{F}(\\theta)\n$$\n其中向量函数 $\\mathbf{F}(\\theta)$ 由下式给出：\n$$\n\\mathbf{F}(\\theta) = \\begin{pmatrix} \\frac{\\cos(\\theta - \\pi/4)}{\\kappa(\\theta)} \\\\ \\frac{\\sin(\\theta - \\pi/4)}{\\kappa(\\theta)} \\\\ -2k \\end{pmatrix}\n$$\n这是一个初值问题，我们在 $\\theta = \\theta_0$ 时给定初始状态 $\\mathbf{y}_0 = [x_0, y_0, p_0]^T$，并寻求在 $\\theta = \\theta_f$ 时的最终状态 $\\mathbf{y}_f$。\n\n为数值求解此系统，我们实现四阶Runge-Kutta（RK4）方法。积分区间 $[\\theta_0, \\theta_f]$ 被离散化为 $N$ 个步长为 $h = (\\theta_f - \\theta_0) / N$ 的步骤。一个关键的观察是函数 $\\mathbf{F}$ 仅依赖于 $\\theta$，而不依赖于状态向量 $\\mathbf{y}$。这使得RK4方法简化为对向量函数 $\\mathbf{F}(\\theta)$ 的每个分量应用辛普森1/3法则（Simpson's 1/3 rule）进行数值积分。从 $\\theta_n$ 处的状态 $\\mathbf{y}_n$ 开始，$\\theta_{n+1} = \\theta_n + h$ 处的状态 $\\mathbf{y}_{n+1}$ 计算如下：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6} \\left( \\mathbf{F}(\\theta_n) + 4\\mathbf{F}(\\theta_n + h/2) + \\mathbf{F}(\\theta_n + h) \\right)\n$$\n实现将包含一个通用函数，该函数针对给定的函数 $\\mathbf{F}(\\theta)$、初始条件、积分范围和步数 $N$ 执行此积分。为确保高精度并满足四舍五入到 $6$ 位小数的要求，将使用大量的步数，例如 $N=10000$。选择这样的 $N$ 会使步长 $h$ 很小，并且由于该方法的全局误差是 $O(h^4)$ 阶的，数值解将非常接近真实解。\n\n该算法将应用于所提供的三个测试用例中的每一个。对于每种情况，使用特定的参数 $k$、$x_0$、$y_0$、$p_0$、$\\theta_0$、$\\theta_f$ 和函数 $\\kappa(\\theta)$ 来定义相应的 $\\mathbf{F}(\\theta)$。该算法能够适应积分路径的增加（$\\theta_f > \\theta_0$）和减少（$\\theta_f < \\theta_0$），因为步长 $h$ 会相应地为正或为负。有效性检查确认了在所有测试用例的积分区间上 $\\kappa(\\theta)$ 均不为零，从而确保了右侧函数 $\\mathbf{F}(\\theta)$ 的良定义性。每种情况下计算出的 $x(\\theta_f)$、$y(\\theta_f)$ 和 $p(\\theta_f)$ 的最终值都将四舍五入到 $6$ 位小数，并按指定格式进行格式化。", "answer": "```python\nimport numpy as np\n\ndef rk4_integrator(F_theta, y0, theta0, theta_f, N):\n    \"\"\"\n    Integrates the ODE system dy/d(theta) = F(theta) using a fourth-order Runge-Kutta method.\n    The method simplifies to Simpson's rule because F is independent of y.\n\n    Args:\n        F_theta (callable): The vector function F(theta) = [dx/dtheta, dy/dtheta, dp/dtheta].\n        y0 (list or np.ndarray): Initial state vector [x0, y0, p0].\n        theta0 (float): Initial value of the independent variable theta.\n        theta_f (float): Final value of the independent variable theta.\n        N (int): Number of integration steps.\n\n    Returns:\n        np.ndarray: The final state vector y(theta_f).\n    \"\"\"\n    h = (theta_f - theta0) / N\n    theta = theta0\n    y = np.array(y0, dtype=float)\n\n    for _ in range(N):\n        F1 = F_theta(theta)\n        F2 = F_theta(theta + h / 2.0)\n        F4 = F_theta(theta + h)\n        \n        y += (h / 6.0) * (F1 + 4.0 * F2 + F4)\n        theta += h\n        \n    return y\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three specified test cases.\n    \"\"\"\n    test_cases = [\n        {\n            \"k\": 1.0e6,\n            \"kappa_func\": lambda theta: 0.5,\n            \"theta0\": 0.0,\n            \"theta_f\": 0.5,\n            \"initial_state\": [0.0, 0.0, 5.0e6]\n        },\n        {\n            \"k\": 2.5e6,\n            \"kappa_func\": lambda theta: 0.2 + 0.1 * np.cos(theta),\n            \"theta0\": 0.2,\n            \"theta_f\": 1.0,\n            \"initial_state\": [1.0, -0.5, 1.0e6]\n        },\n        {\n            \"k\": 1.5e6,\n            \"kappa_func\": lambda theta: -0.3,\n            \"theta0\": 1.2,\n            \"theta_f\": 0.7,\n            \"initial_state\": [-2.0, 2.0, 0.0]\n        }\n    ]\n\n    all_results = []\n    num_steps = 10000\n\n    for case in test_cases:\n        k = case[\"k\"]\n        kappa_func = case[\"kappa_func\"]\n\n        def F_theta(theta):\n            kappa_val = kappa_func(theta)\n            cos_term = np.cos(theta - np.pi / 4.0)\n            sin_term = np.sin(theta - np.pi / 4.0)\n            return np.array([\n                cos_term / kappa_val,\n                sin_term / kappa_val,\n                -2.0 * k\n            ])\n\n        y_final = rk4_integrator(\n            F_theta,\n            case[\"initial_state\"],\n            case[\"theta0\"],\n            case[\"theta_f\"],\n            num_steps\n        )\n\n        x_f_rounded = round(y_final[0], 6)\n        y_f_rounded = round(y_final[1], 6)\n        p_f_rounded = round(y_final[2], 6)\n        \n        all_results.append([x_f_rounded, y_f_rounded, p_f_rounded])\n        \n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "2646134"}]}