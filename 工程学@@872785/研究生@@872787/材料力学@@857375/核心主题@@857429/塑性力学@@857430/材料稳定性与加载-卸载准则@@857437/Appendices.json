{"hands_on_practices": [{"introduction": "本练习旨在建立材料本构属性与其稳定性之间的基础联系。通过为一个简单的单轴情形推导一致弹塑性切线模量，我们将能直接考察 Drucker 稳定性公设，并理解材料硬化如何确保响应的稳定性 [@problem_id:2899889]。", "problem": "一个具有线性各向同性硬化的小应变、率无关的单轴弹塑性实体，在从时间步 $n$ 到 $n+1$ 的单个荷载增量作用下。弹性定律为 $ \\sigma = E \\left( \\varepsilon - \\varepsilon^{p} \\right)$，其中杨氏模量 $E  0$。屈服函数为 $ f(\\sigma,\\alpha) = |\\sigma| - \\left( \\sigma_{y0} + H \\alpha \\right)$，其中 $\\sigma_{y0}  0$ 是初始屈服应力，$H \\ge 0$ 是线性硬化模量，$\\alpha$ 是累积塑性应变。假设为单调拉伸，因此 $\\sigma \\ge 0$ 且 $|\\sigma| = \\sigma$，并采用具有正交性和一致性的相关流动法则：$d\\varepsilon^{p} = d\\lambda \\, \\partial f / \\partial \\sigma$ 和 $d\\alpha = d\\lambda$，其中 $d\\lambda \\ge 0$ 是塑性乘子。使用回映算法：首先形成一个弹性预测值 $\\sigma_{\\mathrm{tr}} = E \\left( \\varepsilon_{n+1} - \\varepsilon^{p}_{n} \\right)$，如果 $f(\\sigma_{\\mathrm{tr}},\\alpha_{n})  0$，则执行塑性修正，使得最终状态满足 $f(\\sigma_{n+1},\\alpha_{n+1}) = 0$。假设试探状态处于过应力状态并发生塑性修正，且在该步中应力符号始终保持非负。\n\n任务：\n1) 仅从小时变运动学、弹性定律、屈服函数以及相关流动和一致性条件出发，推导回映步结束时的一致弹塑性切线 $ C^{ep} = \\partial \\sigma_{n+1} / \\partial \\varepsilon_{n+1}$。\n2) 使用在更新状态下对任意虚应变增量 $\\delta \\varepsilon$ 求值的二阶功定义 $\\delta^{2} W = \\delta \\sigma \\, \\delta \\varepsilon$，将 $\\delta^{2} W$ 用 $C^{ep}$ 和 $\\delta \\varepsilon$ 表示。然后，确定在所有单位范数（即 $|\\delta \\varepsilon| = 1$）的虚应变增量中 $\\delta^{2} W$ 的可能最小值。陈述在该状态下，根据 Drucker 材料稳定性公设，材料增量稳定的条件。\n\n请提供在所有 $|\\delta \\varepsilon| = 1$ 条件下最小二阶功的闭式解析表达式作为最终答案。不包括单位，也不要进行近似。", "solution": "该问题经过严格的验证过程。所有给定条件均被提取并审查其科学合理性、一致性和完整性。\n\n**提取的已知条件：**\n-   **模型**：具有线性各向同性硬化的小应变、率无关的单轴弹塑性实体。\n-   **弹性定律**：$ \\sigma = E \\left( \\varepsilon - \\varepsilon^{p} \\right)$，其中杨氏模量 $E  0$。\n-   **屈服函数**：$ f(\\sigma,\\alpha) = |\\sigma| - \\left( \\sigma_{y0} + H \\alpha \\right)$，其中初始屈服应力 $\\sigma_{y0}  0$，硬化模量 $H \\ge 0$，累积塑性应变 $\\alpha$。\n-   **假设**：单调拉伸（$\\sigma \\ge 0$，因此 $|\\sigma| = \\sigma$），相关流动法则，发生塑性修正步。\n-   **流动法则**：$d\\varepsilon^{p} = d\\lambda \\, \\partial f / \\partial \\sigma$。\n-   **硬化定律**：$d\\alpha = d\\lambda$，其中 $d\\lambda \\ge 0$。\n-   **回映算法**：使用弹性预测值 $\\sigma_{\\mathrm{tr}} = E \\left( \\varepsilon_{n+1} - \\varepsilon^{p}_{n} \\right)$，并通过塑性修正确保 $f(\\sigma_{n+1},\\alpha_{n+1}) = 0$。\n-   **任务1**：推导一致弹塑性切线 $ C^{ep} = \\partial \\sigma_{n+1} / \\partial \\varepsilon_{n+1}$。\n-   **任务2**：分析二阶功 $\\delta^{2} W = \\delta \\sigma \\, \\delta \\varepsilon$ 以找到其在 $|\\delta \\varepsilon| = 1$ 条件下的最小值，并陈述材料稳定性条件。\n\n**验证结论：**\n该问题具有科学依据，是良定且客观的。它描述了塑性理论中的一个标准模型，并提出了一个标准的、非平凡的任务。问题表述自洽，没有矛盾或模糊之处。该问题被判定为 **有效**。我们开始求解。\n\n解答按要求分为两部分。\n\n**第1部分：一致弹塑性切线 $C^{ep}$ 的推导**\n\n对于率无关材料，状态变量是增量演化的。我们考虑在塑性加载事件中本构方程的率（或增量）形式。\n\n总应变率 $d\\varepsilon$ 可加法分解为一个弹性部分 $d\\varepsilon^{e}$ 和一个塑性部分 $d\\varepsilon^{p}$：\n$$d\\varepsilon = d\\varepsilon^{e} + d\\varepsilon^{p}$$\n应力率 $d\\sigma$ 通过弹性模量 $E$ 与弹性应变率相关：\n$$d\\sigma = E \\, d\\varepsilon^{e} = E(d\\varepsilon - d\\varepsilon^{p})$$\n在单调拉伸假设下（$\\sigma \\ge 0$），屈服函数为 $f(\\sigma, \\alpha) = \\sigma - (\\sigma_{y0} + H\\alpha)$。\n相关流动法则规定塑性应变率垂直于屈服面：\n$$d\\varepsilon^{p} = d\\lambda \\frac{\\partial f}{\\partial \\sigma}$$\n对于我们的屈服函数，$\\partial f / \\partial \\sigma = 1$。因此，\n$$d\\varepsilon^{p} = d\\lambda$$\n硬化定律为 $d\\alpha = d\\lambda$。由于材料正在进行塑性加载，其状态必须保持在屈服面上。这由一致性条件 $df = 0$ 强制执行：\n$$df = \\frac{\\partial f}{\\partial \\sigma} d\\sigma + \\frac{\\partial f}{\\partial \\alpha} d\\alpha = 0$$\n偏导数为 $\\partial f / \\partial \\sigma = 1$ 和 $\\partial f / \\partial \\alpha = -H$。将这些以及 $d\\alpha = d\\lambda$ 代入一致性条件，得到：\n$$(1) d\\sigma + (-H) d\\lambda = 0 \\implies d\\sigma = H \\, d\\lambda$$\n这个方程将应力增量与塑性乘子增量联系起来。对于硬化材料（$H  0$），需要增加应力才能产生进一步的塑性流动。对于理想塑性材料（$H=0$），$d\\sigma = 0$。\n\n我们现在有了一个方程组。从 $d\\sigma = H \\, d\\lambda$，对于 $H0$ 我们得到 $d\\lambda = d\\sigma / H$。我们将 $d\\varepsilon^p=d\\lambda=d\\sigma/H$ 代入应力-应变率方程：\n$$d\\sigma = E \\left(d\\varepsilon - \\frac{d\\sigma}{H}\\right)$$\n$$d\\sigma = E \\, d\\varepsilon - \\frac{E}{H} d\\sigma$$\n我们重排方程以求解比率 $d\\sigma / d\\varepsilon$：\n$$d\\sigma \\left(1 + \\frac{E}{H}\\right) = E \\, d\\varepsilon$$\n$$d\\sigma \\left(\\frac{H+E}{H}\\right) = E \\, d\\varepsilon$$\n$$\\frac{d\\sigma}{d\\varepsilon} = \\frac{EH}{E+H}$$\n这个比率就是弹塑性切线模量。对于应用于线性硬化问题的简单后向欧拉积分方案，一致切线模量 $C^{ep}$ 与连续介质切线模量相同。\n$$C^{ep} = \\frac{\\partial \\sigma_{n+1}}{\\partial \\varepsilon_{n+1}} = \\frac{EH}{E+H}$$\n该公式也适用于理想塑性情况（$H=0$），此时它正确地得出 $C^{ep} = 0$。\n\n**第2部分：二阶功与稳定性分析**\n\n二阶功 $\\delta^{2} W$ 定义为在状态 $(\\sigma_{n+1}, \\varepsilon_{n+1})$ 下虚应力增量 $\\delta \\sigma$ 和虚应变增量 $\\delta \\varepsilon$ 的乘积：\n$$\\delta^{2} W = \\delta \\sigma \\, \\delta \\varepsilon$$\n问题要求我们将 $\\delta^{2} W$ 用 $C^{ep}$ 表示。这意味着我们要使用推导出的切线模量来线性化对虚应变增量的响应，这对于引起持续塑性加载的扰动是合适的。\n$$\\delta \\sigma = C^{ep} \\delta \\varepsilon$$\n将此代入二阶功的定义：\n$$\\delta^{2} W = (C^{ep} \\delta \\varepsilon) \\delta \\varepsilon = C^{ep} (\\delta \\varepsilon)^2$$\n我们被要求找到在所有单位范数（$|\\delta \\varepsilon| = 1$）的虚应变增量下 $\\delta^{2} W$ 的最小值。在这个单轴问题中，应变 $\\delta \\varepsilon$ 是一个标量，所以它的范数是其绝对值。条件 $|\\delta \\varepsilon| = 1$ 意味着 $\\delta \\varepsilon = 1$ 或 $\\delta \\varepsilon = -1$。在这两种情况下，$(\\delta \\varepsilon)^2 = 1$。\n因此，对于任何此类虚增量，二阶功为：\n$$\\delta^{2} W = C^{ep} (1) = C^{ep}$$\n由于对于所有容许的虚增量，该值是恒定的，所以其最小值就是 $C^{ep}$。\n$$\\min_{|\\delta \\varepsilon|=1} (\\delta^{2} W) = C^{ep} = \\frac{EH}{E+H}$$\nDrucker 的材料稳定性公设要求，对于从平衡状态开始的任何过程，二阶功必须为正。用率形式表示为 $\\delta \\sigma \\, \\delta \\varepsilon > 0$。\n材料的稳定性通过考虑从当前塑性状态出发的所有可能的虚扰动 $\\delta\\varepsilon$ 来评估。\n-   如果扰动对应于持续加载（在此情况下，$\\delta\\varepsilon > 0$），则相关的切线是 $C^{ep}$。稳定性要求 $\\delta^{2} W = C^{ep}(\\delta\\varepsilon)^2 > 0$。由于 $(\\delta\\varepsilon)^2>0$，这意味着 $C^{ep} > 0$。\n-   如果扰动对应于弹性卸载（在此情况下，$\\delta\\varepsilon  0$），则相关的切线是弹性模量 $E$。稳定性要求 $\\delta^{2} W = E(\\delta\\varepsilon)^2 > 0$。由于给定 $E>0$，此条件对于卸载总是满足的。\n\n材料的整体稳定性由“最弱”路径决定。由于我们知道 $0 \\le C^{ep} \\le E$（因为 $E>0, H \\ge 0$），临界条件是 $C^{ep} > 0$。这导致：\n$$\\frac{EH}{E+H} > 0$$\n给定 $E>0$，这个不等式成立当且仅当 $H>0$。因此，如果材料表现出硬化（$H>0$），则它是稳定的；如果是理想塑性（$H=0$，导致 $C^{ep}=0$ 和 $\\delta^2W=0$），则是中性稳定的。软化（$H0$）将导致不稳定性（$C^{ep}0$）。问题限制 $H \\ge 0$。严格稳定性的条件是 $H>0$。\n\n最终要求的答案是在 $|\\delta \\varepsilon| = 1$ 条件下的最小二阶功。", "answer": "$$\\boxed{\\frac{EH}{E+H}}$$", "id": "2899889"}, {"introduction": "在稳定性的概念基础上，本练习将探讨在离散数值模拟中错误应用加载-卸载准则时会发生什么。这个使用带有屈服面角点的二维模型的思想实验将演示算法层面的错误如何导致物理上不可能出现的结果，例如负的塑性耗散 [@problem_id:2899914]。这突显了在算法中正确识别材料状态的至关重要性。", "problem": "在广义应力空间中，考虑一个关联理想塑性材料的二维理想化模型，其应力向量为 $\\boldsymbol{\\sigma} = (\\sigma_{1}, \\sigma_{2})$。屈服函数是分段线性映射\n$$\nf(\\boldsymbol{\\sigma}) = \\max\\left(|\\sigma_{1}|,\\,|\\sigma_{2}|\\right) - k \\le 0,\n$$\n其中 $k0$ 为屈服应力。弹性定律是线性的，并且在分量上是对角的，\n$$\n\\Delta \\boldsymbol{\\sigma} = \\mathbf{C}\\,(\\Delta \\boldsymbol{\\varepsilon} - \\Delta \\boldsymbol{\\varepsilon}^{p}), \\quad \\mathbf{C} = \\operatorname{diag}(K_{1}, K_{2}),\n$$\n塑性流动是关联的，流动方向 $\\boldsymbol{n} = \\partial f/\\partial \\boldsymbol{\\sigma}$ 等于激活面的外单位法向量（例如，如果激活面是 $\\sigma_{1}=k$ 且 $\\sigma_{1}0$，则 $\\boldsymbol{n}=(1,0)$；如果是 $\\sigma_{2}=k$ 且 $\\sigma_{2}0$，则 $\\boldsymbol{n}=(0,1)$）。从时间 $t^{n}$ 到 $t^{n+1}$ 的一个时间步长内，后向欧拉（Backward Euler (BE)）时域离散更新使用试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}^{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}$，并且在发生屈服时，使用返回映射算法。该算法在 $t^{n+1}$ 时刻强制执行激活面的一致性条件，并结合 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\boldsymbol{n}$，其中 $\\Delta \\gamma$ 是塑性乘子增量。\n\n考虑以下数据：\n- 屈服应力 $k = 200\\,\\text{MPa}$。\n- 弹性模量 $K_{1} = K_{2} = 200{,}000\\,\\text{MPa}$。\n- 上一步应力 $\\boldsymbol{\\sigma}^{n} = (200,\\,190)\\,\\text{MPa}$，该应力点位于 $\\sigma_{1}=k$ 且 $\\sigma_{1}0$ 的面上。\n- 应变增量 $\\Delta \\boldsymbol{\\varepsilon} = \\big(-1.5\\times 10^{-4},\\,1.0\\times 10^{-4}\\big)$。\n\n算法中使用的一个时域离散塑性耗散度量定义为\n$$\nD^{n+1} := \\boldsymbol{\\sigma}^{n+1} : \\Delta \\boldsymbol{\\varepsilon}^{p}.\n$$\n对于关联的稳定材料和正确识别的激活面，$D^{n+1}$ 预计为非负值。\n\n使用上述数据，计算当算法违背正确的物理原理，错误地将 $t^{n+1}$ 时刻的激活面识别为 $\\sigma_{1}=k$ 且 $\\sigma_{1}0$（即，保留了上一步的面），而非由试探应力实际激活的面时，所得到的 $D^{n+1}$ 值。使用带有这个错误识别面的后向欧拉返回映射来确定 $\\Delta \\boldsymbol{\\varepsilon}^{p}$ 和 $\\boldsymbol{\\sigma}^{n+1}$，然后计算 $D^{n+1}$。用 $\\text{MPa}$ 表示你的最终答案。最终答案中不要包含单位，并提供一个单一的数字。除了给定数字所隐含的精确算术外，不需要进行四舍五入。", "solution": "所述问题是有效的。它提出了一个定义明确的计算塑性力学练习，对具有分段线性屈服面的理想塑性材料使用了标准的后向欧拉返回映射算法。所提供的数据是完整且科学上一致的。问题的核心是计算一个故意错误的算法选择（具体来说，是错误识别激活的屈服面）所带来的后果——这是分析数值方案性质和稳定性的正当方法。我们将按要求进行计算。\n\n目标是计算在假设 $t^{n+1}$ 时刻的激活屈服面被错误地假定为 $\\sigma_{1}=k$（与 $t^{n}$ 时刻应力状态所在的屈服面相同）的条件下，塑性耗散度量 $D^{n+1} := \\boldsymbol{\\sigma}^{n+1} : \\Delta \\boldsymbol{\\varepsilon}^{p}$。\n\n首先，我们计算试探应力 $\\boldsymbol{\\sigma}^{\\text{tr}}$，这是如果增量内的响应是纯弹性的，将会达到的应力状态。\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\boldsymbol{\\sigma}^{n} + \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}\n$$\n给定条件如下：\n- 上一步应力：$\\boldsymbol{\\sigma}^{n} = (200, 190)\\,\\text{MPa}$。\n- 弹性矩阵：$\\mathbf{C} = \\operatorname{diag}(K_{1}, K_{2})$，其中 $K_{1} = K_{2} = 200{,}000\\,\\text{MPa}$。\n- 应变增量：$\\Delta \\boldsymbol{\\varepsilon} = (-1.5\\times 10^{-4}, 1.0\\times 10^{-4})$。\n\n弹性应力增量为：\n$$\n\\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix} 200000  0 \\\\ 0  200000 \\end{pmatrix} \\begin{pmatrix} -1.5\\times 10^{-4} \\\\ 1.0\\times 10^{-4} \\end{pmatrix} = \\begin{pmatrix} -30 \\\\ 20 \\end{pmatrix}\\,\\text{MPa}\n$$\n因此，试探应力为：\n$$\n\\boldsymbol{\\sigma}^{\\text{tr}} = \\begin{pmatrix} 200 \\\\ 190 \\end{pmatrix} + \\begin{pmatrix} -30 \\\\ 20 \\end{pmatrix} = \\begin{pmatrix} 170 \\\\ 210 \\end{pmatrix}\\,\\text{MPa}\n$$\n接下来，我们检查这个试探应力状态是否违反了屈服条件 $f(\\boldsymbol{\\sigma}) = \\max(|\\sigma_{1}|, |\\sigma_{2}|) - k \\le 0$，其中 $k = 200\\,\\text{MPa}$。\n$$\nf(\\boldsymbol{\\sigma}^{\\text{tr}}) = \\max(|170|, |210|) - 200 = 210 - 200 = 10\n$$\n由于 $f(\\boldsymbol{\\sigma}^{\\text{tr}}) > 0$，发生了塑性屈服，需要进行返回映射将应力状态恢复到屈服面上。\n\n题目要求我们假设激活面为 $\\sigma_{1}=k$ 来继续计算。对于这个面，其外单位法向量为 $\\boldsymbol{n} = (1, 0)$。根据关联流动法则，塑性应变增量由 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\boldsymbol{n}$ 给出，其中 $\\Delta \\gamma$ 是塑性乘子。应力的后向欧拉更新为：\n$$\n\\boldsymbol{\\sigma}^{n+1} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\mathbf{C}\\,\\Delta \\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{\\sigma}^{\\text{tr}} - \\Delta \\gamma\\,\\mathbf{C}\\,\\boldsymbol{n}\n$$\n代入已知量：\n$$\n\\boldsymbol{\\sigma}^{n+1} = \\begin{pmatrix} 170 \\\\ 210 \\end{pmatrix} - \\Delta \\gamma \\begin{pmatrix} 200000  0 \\\\ 0  200000 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 170 - 200000\\,\\Delta \\gamma \\\\ 210 \\end{pmatrix}\n$$\n一致性条件要求最终应力 $\\boldsymbol{\\sigma}^{n+1}$ 位于假定的激活面上，即其第一个分量必须等于 $k$。\n$$\n\\sigma_{1}^{n+1} = 200\n$$\n通过令分量相等，我们求解塑性乘子 $\\Delta \\gamma$：\n$$\n170 - 200000\\,\\Delta \\gamma = 200\n$$\n$$\n-200000\\,\\Delta \\gamma = 30\n$$\n$$\n\\Delta \\gamma = -\\frac{30}{200000} = -1.5 \\times 10^{-4}\n$$\n塑性乘子为负值，即 $\\Delta \\gamma  0$，表明激活面的选择是错误的。对于一个物理上一致的过程，必须有 $\\Delta \\gamma \\ge 0$。然而，题目要求我们用这个结果继续计算。\n\n使用这个 $\\Delta\\gamma$ 值，我们确定塑性应变增量和最终应力状态。\n塑性应变增量为：\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\gamma\\,\\boldsymbol{n} = (-1.5 \\times 10^{-4}) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1.5 \\times 10^{-4} \\\\ 0 \\end{pmatrix}\n$$\n最终应力状态为：\n$$\n\\boldsymbol{\\sigma}^{n+1} = \\begin{pmatrix} 170 - 200000(-1.5 \\times 10^{-4}) \\\\ 210 \\end{pmatrix} = \\begin{pmatrix} 170 + 30 \\\\ 210 \\end{pmatrix} = \\begin{pmatrix} 200 \\\\ 210 \\end{pmatrix}\\,\\text{MPa}\n$$\n我们注意到，这个最终应力状态 $\\boldsymbol{\\sigma}^{n+1}$ 本身也违反了屈服条件，因为 $f(\\boldsymbol{\\sigma}^{n+1}) = \\max(|200|,|210|) - 200 = 10 > 0$。这证实了使用错误面的算法是失败的。\n\n最后，我们计算塑性耗散 $D^{n+1}$：\n$$\nD^{n+1} = \\boldsymbol{\\sigma}^{n+1} : \\Delta \\boldsymbol{\\varepsilon}^{p} = \\sigma_{1}^{n+1}\\,\\Delta\\varepsilon_{1}^{p} + \\sigma_{2}^{n+1}\\,\\Delta\\varepsilon_{2}^{p}\n$$\n代入计算出的值：\n$$\nD^{n+1} = (200) \\times (-1.5 \\times 10^{-4}) + (210) \\times (0)\n$$\n$$\nD^{n+1} = -300 \\times 10^{-4} = -0.03\n$$\n结果的单位是 MPa。耗散的负值违反了应用于塑性变形的热力学第二定律（Drucker稳定性公设的一个推论），该定律要求任何塑性过程的耗散都为非负。这是强制返回到一个并非由试探应力实际激活的屈服面所导致的预期结果。", "answer": "$$\n\\boxed{-0.03}\n$$", "id": "2899914"}, {"introduction": "最后的这项实践将前面的概念综合成一个完整的计算任务。你将为一个广泛用于岩土材料的三维 Drucker-Prager 模型推导并实现一个预测-校正算法。此练习通过将返回映射、一致性条件和加载-卸载逻辑转化为可工作的代码，来巩固对这些核心概念的理解 [@problem_id:2899915]。", "problem": "实现一个计算算法塑性乘子增量的小应变相关Drucker–Prager预测-校正步。从弹性试应力出发，并强制执行离散一致性方程以及Drucker稳定性公设所蕴含的加载-卸载条件。您的程序必须为每个测试用例返回该荷载步的塑性乘子增量 $\\Delta \\lambda$。\n\n定义与假设：\n- 小应变线性各向同性弹性，其刚度张量为 $\\mathbb{C}$，体积模量为 $K$，剪切模量为 $G$。弹性预测器定义为 $\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\mathbb{C} : \\left(\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_{n}^{p} \\right)$，校正器更新为 $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon}^{p}$。\n- 相关的流动法则和理想塑性，采用Drucker–Prager屈服函数 $f(\\boldsymbol{\\sigma}) = \\alpha I_{1}(\\boldsymbol{\\sigma}) + \\sqrt{J_{2}(\\boldsymbol{\\sigma})} - k$，其中 $I_{1}(\\boldsymbol{\\sigma}) = \\mathrm{tr}(\\boldsymbol{\\sigma})$，$J_{2}(\\boldsymbol{\\sigma}) = \\frac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3} I_{1}(\\boldsymbol{\\sigma}) \\boldsymbol{I}$ 是偏应力。标量参数为 $\\alpha \\ge 0$ 和 $k \\ge 0$。\n- 热力学一致性和Drucker稳定性公设强制要求塑性功增量非负，其离散形式要求满足互补条件：对于该步，$\\Delta \\lambda \\ge 0$，$f(\\boldsymbol{\\sigma}) \\le 0$ 以及 $\\Delta \\lambda \\, f(\\boldsymbol{\\sigma}) = 0$。\n- 离散正交性（相关流动）为 $\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\lambda \\, \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，在更新后的应力处求值。\n\n计算任务：\n- 给定弹性试应力 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$ 和参数 $K$、$G$、$\\alpha$ 和 $k$，当发生塑性加载时，通过强制执行离散一致性方程 $f(\\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon}^{p}) = 0$ 来计算塑性乘子增量 $\\Delta \\lambda$，并应用Drucker稳定性公设的加载-卸载准则（即，如果试探状态是严格弹性的，则 $\\Delta \\lambda = 0$）。\n- 在计算中使用应力不变量：$I_{1}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$ 和 $J_{2}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$。您可以假设 $K  0$ 和 $G  0$。\n- 每个测试用例的输入应力将以帕斯卡（Pa）为单位，作为对称张量的$6$个独立分量 $(\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{12}, \\sigma_{23}, \\sigma_{13})$ 提供。您的程序必须在内部使用 $\\sigma_{ij} = \\sigma_{ji}$ 重构 $3 \\times 3$ 张量。\n- 您必须实现预测-校正逻辑，以根据试探状态判断是弹性响应还是塑性响应，并相应地计算 $\\Delta \\lambda$。每个用例的输出是标量 $\\Delta \\lambda$（无量纲）。\n\n角度单位不适用。所有输入均以帕斯卡（Pa）表示。输出 $\\Delta \\lambda$ 是无量纲的。最终输出必须是单行文本，包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表。\n\n测试套件（为以下所有案例提供结果）：\n- 案例1（弹性，中等静水拉伸伴有小剪切）：$K = 166 \\times 10^{9}$ Pa, $G = 80 \\times 10^{9}$ Pa, $\\alpha = 0.2$, $k = 200 \\times 10^{6}$ Pa，应力分量 $(50 \\times 10^{6},\\, 50 \\times 10^{6},\\, 50 \\times 10^{6},\\, 10 \\times 10^{6},\\, 0,\\, 0)$。\n- 案例2（塑性，偏应力主导）：$K = 166 \\times 10^{9}$ Pa, $G = 80 \\times 10^{9}$ Pa, $\\alpha = 0.2$, $k = 200 \\times 10^{6}$ Pa，应力分量 $(50 \\times 10^{6},\\, 50 \\times 10^{6},\\, 50 \\times 10^{6},\\, 250 \\times 10^{6},\\, 0,\\, 0)$。\n- 案例3（塑性，静水拉伸）：$K = 166 \\times 10^{9}$ Pa, $G = 80 \\times 10^{9}$ Pa, $\\alpha = 0.2$, $k = 200 \\times 10^{6}$ Pa，应力分量 $(400 \\times 10^{6},\\, 400 \\times 10^{6},\\, 400 \\times 10^{6},\\, 0,\\, 0,\\, 0)$。\n- 案例4（中性，位于屈服面上）：$K = 166 \\times 10^{9}$ Pa, $G = 80 \\times 10^{9}$ Pa, $\\alpha = 0.2$, $k = 200 \\times 10^{6}$ Pa，应力分量 $\\left(\\frac{10^{9}}{3},\\, \\frac{10^{9}}{3},\\, \\frac{10^{9}}{3},\\, 0,\\, 0,\\, 0\\right)$。\n- 案例5（弹性，静水压缩）：$K = 166 \\times 10^{9}$ Pa, $G = 80 \\times 10^{9}$ Pa, $\\alpha = 0.2$, $k = 200 \\times 10^{6}$ Pa，应力分量 $(-400 \\times 10^{6},\\, -400 \\times 10^{6},\\, -400 \\times 10^{6},\\, 0,\\, 0,\\, 0)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3},r_{4},r_{5}]$），其中每个 $r_{i}$ 是按上述顺序列出的案例 $i$ 所计算出的 $\\Delta \\lambda$。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、适定且完整的。它描述了计算固体力学中的一个典型问题：为率无关的相关Drucker-Prager塑性模型实现回映算法。所提供的数据和定义是一致且充分的，足以获得唯一且稳定的解。因此，我们可以进行形式推导。\n\n问题的核心是确定给定荷载步的塑性乘子增量 $\\Delta \\lambda$。这由Karush-Kuhn-Tucker (KKT) 互补条件决定，对于该率无关模型，这些条件为：\n$$\n\\Delta \\lambda \\ge 0, \\quad f(\\boldsymbol{\\sigma}_{n+1}) \\le 0, \\quad \\Delta \\lambda \\, f(\\boldsymbol{\\sigma}_{n+1}) = 0\n$$\n此处，$f$ 是Drucker-Prager屈服函数 $f(\\boldsymbol{\\sigma}) = \\alpha I_{1}(\\boldsymbol{\\sigma}) + \\sqrt{J_{2}(\\boldsymbol{\\sigma})} - k$，$\\boldsymbol{\\sigma}_{n+1}$ 是时间步 $t_{n+1}$ 结束时的应力张量。\n\n预测-校正算法首先计算一个弹性试应力 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$，假设整个应变增量都是弹性的。\n$$\n\\boldsymbol{\\sigma}_{\\mathrm{tr}} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}_{n}^{p})\n$$\n使用该试应力评估加载-卸载准则。我们计算屈服函数在试探状态下的值，$f_{\\mathrm{tr}} = f(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$。\n\n情况1：弹性步或中性加载\n如果 $f_{\\mathrm{tr}} \\le 0$，则试应力状态在弹性域内或其边界上。根据KKT条件，不发生塑性流动。此前的假设是正确的。\n$$\nf_{\\mathrm{tr}} \\le 0 \\implies \\Delta \\lambda = 0\n$$\n在这种情况下，塑性应变增量 $\\Delta \\boldsymbol{\\varepsilon}^{p}$ 为零，最终应力与试应力相同：$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}}$。\n\n情况2：塑性步（回映）\n如果 $f_{\\mathrm{tr}} > 0$，则试应力状态位于弹性域之外，这在物理上是不可接受的。这表示在该步中必定发生了塑性变形。KKT条件规定 $\\Delta \\lambda > 0$，并且最终应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 必须位于屈服面上，满足一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}) = 0$。\n\n应力通过流动法则被校正回屈服面：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\Delta \\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\mathbb{C} : \\Delta \\boldsymbol{\\varepsilon}^{p}\n$$\n对于相关流动法则，塑性应变增量与屈服面正交：\n$$\n\\Delta \\boldsymbol{\\varepsilon}^{p} = \\Delta \\lambda \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} \\bigg|_{\\boldsymbol{\\sigma}_{n+1}}\n$$\n屈服函数的梯度为：\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\alpha \\frac{\\partial I_{1}}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial \\sqrt{J_{2}}}{\\partial \\boldsymbol{\\sigma}} = \\alpha \\boldsymbol{I} + \\frac{\\boldsymbol{s}}{2\\sqrt{J_{2}}}\n$$\n其中 $\\boldsymbol{I}$ 是二阶单位张量，$\\boldsymbol{s}$ 是偏应力张量。\n\n对于线性各向同性弹性材料，作用于二阶张量上的四阶刚度张量 $\\mathbb{C}$ 可用体积模量 $K$ 和剪切模量 $G$ 表示为：\n$$\n\\mathbb{C} : \\boldsymbol{A} = 3K \\left(\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{A})\\right) \\boldsymbol{I} + 2G \\left(\\boldsymbol{A} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{A})\\boldsymbol{I}\\right)\n$$\n我们将此应用于梯度张量 $\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$：\n$$\n\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\mathbb{C} : \\left(\\alpha \\boldsymbol{I} + \\frac{\\boldsymbol{s}_{n+1}}{2\\sqrt{J_{2,n+1}}}\\right)\n$$\n$\\alpha\\boldsymbol{I}$ 的迹是 $3\\alpha$，偏量部分 $\\frac{\\boldsymbol{s}_{n+1}}{2\\sqrt{J_{2,n+1}}}$ 的迹为零。\n$$\n\\mathbb{C} : \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\left(3K \\alpha\\right) \\boldsymbol{I} + 2G \\left(\\frac{\\boldsymbol{s}_{n+1}}{2\\sqrt{J_{2,n+1}}}\\right) = 3K\\alpha\\boldsymbol{I} + \\frac{G}{\\sqrt{J_{2,n+1}}} \\boldsymbol{s}_{n+1}\n$$\n将此代入应力更新方程，得到：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\mathrm{tr}} - \\Delta \\lambda \\left( 3K\\alpha\\boldsymbol{I} + \\frac{G}{\\sqrt{J_{2,n+1}}}\\boldsymbol{s}_{n+1} \\right)\n$$\n这个关于 $\\boldsymbol{\\sigma}_{n+1}$ 的隐式方程可以通过将其分解为体积部分和偏量部分来求解。\n\n分解：\n$\\boldsymbol{\\sigma}_{n+1}$ 的迹给出了第一不变量 $I_{1,n+1}$：\n$$\nI_{1,n+1} = \\mathrm{tr}(\\boldsymbol{\\sigma}_{n+1}) = \\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}}) - \\Delta \\lambda \\left( 3K\\alpha \\cdot \\mathrm{tr}(\\boldsymbol{I}) \\right) = I_{1,\\mathrm{tr}} - 9K\\alpha \\Delta \\lambda\n$$\n通过分离偏量张量得到偏量部分：\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\mathrm{tr}} - \\Delta \\lambda \\frac{G}{\\sqrt{J_{2,n+1}}}\\boldsymbol{s}_{n+1}\n$$\n对 $\\boldsymbol{s}_{n+1}$ 进行整理：\n$$\n\\boldsymbol{s}_{n+1} \\left(1 + \\frac{G\\Delta\\lambda}{\\sqrt{J_{2,n+1}}}\\right) = \\boldsymbol{s}_{\\mathrm{tr}}\n$$\n该方程表明，更新后的偏应力 $\\boldsymbol{s}_{n+1}$ 与试探偏应力 $\\boldsymbol{s}_{\\mathrm{tr}}$ 共线。我们可以对两边取 von Mises 等效范数（$\\sqrt{J_2}$）。\n$$\n\\sqrt{J_{2,n+1}} \\left(1 + \\frac{G\\Delta\\lambda}{\\sqrt{J_{2,n+1}}}\\right) = \\sqrt{J_{2,\\mathrm{tr}}}\n$$\n$$\n\\sqrt{J_{2,n+1}} + G\\Delta\\lambda = \\sqrt{J_{2,\\mathrm{tr}}} \\implies \\sqrt{J_{2,n+1}} = \\sqrt{J_{2,\\mathrm{tr}}} - G\\Delta\\lambda\n$$\n现在我们得到了用 $\\Delta\\lambda$ 表示的更新后不变量 $I_{1,n+1}$ 和 $\\sqrt{J_{2,n+1}}$ 的显式表达式。我们强制执行一致性条件 $f(\\boldsymbol{\\sigma}_{n+1})=0$：\n$$\n\\alpha I_{1,n+1} + \\sqrt{J_{2,n+1}} - k = 0\n$$\n代入我们推导出的表达式：\n$$\n\\alpha \\left(I_{1,\\mathrm{tr}} - 9K\\alpha\\Delta\\lambda\\right) + \\left(\\sqrt{J_{2,\\mathrm{tr}}} - G\\Delta\\lambda\\right) - k = 0\n$$\n我们重新排列各项以求解 $\\Delta\\lambda$：\n$$\n\\left(\\alpha I_{1,\\mathrm{tr}} + \\sqrt{J_{2,\\mathrm{tr}}} - k\\right) - 9K\\alpha^2\\Delta\\lambda - G\\Delta\\lambda = 0\n$$\n括号中的项正是在试探状态下计算的屈服函数值 $f_{\\mathrm{tr}}$。\n$$\nf_{\\mathrm{tr}} - (9K\\alpha^2 + G)\\Delta\\lambda = 0\n$$\n这给出了塑性乘子增量的闭式解：\n$$\n\\Delta\\lambda = \\frac{f_{\\mathrm{tr}}}{9K\\alpha^2 + G}\n$$\n\n计算算法总结：\n1.  给定试应力分量 $(\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{12}, \\sigma_{23}, \\sigma_{13})$，构造试应力张量 $\\boldsymbol{\\sigma}_{\\mathrm{tr}}$。\n2.  计算试探不变量：$I_{1,\\mathrm{tr}} = \\mathrm{tr}(\\boldsymbol{\\sigma}_{\\mathrm{tr}})$ 和 $J_{2,\\mathrm{tr}} = \\frac{1}{2}\\boldsymbol{s}_{\\mathrm{tr}}:\\boldsymbol{s}_{\\mathrm{tr}}$。\n3.  计算试探屈服函数 $f_{\\mathrm{tr}} = \\alpha I_{1,\\mathrm{tr}} + \\sqrt{J_{2,\\mathrm{tr}}} - k$。\n4.  如果 $f_{\\mathrm{tr}} \\le 0$，则该步为弹性步，$\\Delta\\lambda = 0$。\n5.  如果 $f_{\\mathrm{tr}} > 0$，则该步为塑性步。使用推导出的公式计算 $\\Delta\\lambda$：\n    $$\n    \\Delta\\lambda = \\frac{f_{\\mathrm{tr}}}{9K\\alpha^2 + G}\n    $$\n该算法被用于所提供的测试用例。对于塑性步，所有用例的分母都是一个常数：$9K\\alpha^2 + G = 9(166 \\times 10^9)(0.2)^2 + (80 \\times 10^9) = 1.3976 \\times 10^{11}$ Pa。\n\n- 案例1：$f_{\\mathrm{tr}} = 0.2(150 \\times 10^6) + \\sqrt{1 \\times 10^{14}} - 200 \\times 10^6 = -160 \\times 10^6  0$，因此 $\\Delta\\lambda=0$。\n- 案例2：$f_{\\mathrm{tr}} = 0.2(150 \\times 10^6) + \\sqrt{6.25 \\times 10^{16}} - 200 \\times 10^6 = 80 \\times 10^6 > 0$，因此 $\\Delta\\lambda = \\frac{80 \\times 10^6}{1.3976 \\times 10^{11}} \\approx 0.00057241$。\n- 案例3：$f_{\\mathrm{tr}} = 0.2(1200 \\times 10^6) + 0 - 200 \\times 10^6 = 40 \\times 10^6 > 0$，因此 $\\Delta\\lambda = \\frac{40 \\times 10^6}{1.3976 \\times 10^{11}} \\approx 0.000286205$。\n- 案例4：$f_{\\mathrm{tr}} = 0.2(10^9) + 0 - 200 \\times 10^6 = 0$，因此 $\\Delta\\lambda=0$。\n- 案例5：$f_{\\mathrm{tr}} = 0.2(-1200 \\times 10^6) + 0 - 200 \\times 10^6 = -440 \\times 10^6  0$，因此 $\\Delta\\lambda=0$。\n最终的程序将执行此逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_delta_lambda(K, G, alpha, k, sigma_vec):\n    \"\"\"\n    Computes the plastic multiplier increment for a Drucker-Prager material.\n\n    Args:\n        K (float): Bulk modulus in Pa.\n        G (float): Shear modulus in Pa.\n        alpha (float): Drucker-Prager material parameter (dimensionless).\n        k (float): Drucker-ager material parameter (cohesion) in Pa.\n        sigma_vec (list or tuple): 6 independent components of the trial stress\n                                    tensor (s11, s22, s33, s12, s23, s13) in Pa.\n\n    Returns:\n        float: The plastic multiplier increment, delta_lambda (dimensionless).\n    \"\"\"\n    s11, s22, s33, s12, s23, s13 = sigma_vec\n\n    # 1. Construct the 3x3 trial stress tensor\n    sigma_tr = np.array([\n        [s11, s12, s13],\n        [s12, s22, s23],\n        [s13, s23, s33]\n    ])\n\n    # 2. Calculate trial invariants I1_tr and J2_tr\n    I1_tr = np.trace(sigma_tr)\n    \n    # Deviatoric trial stress tensor\n    s_tr = sigma_tr - (I1_tr / 3.0) * np.eye(3)\n    \n    # Second invariant of the deviatoric stress tensor\n    # J2 = 0.5 * s_ij * s_ij\n    J2_tr = 0.5 * np.sum(s_tr * s_tr)\n\n    # 3. Evaluate the trial yield function f_tr\n    # A small epsilon is added to sqrt(J2_tr) for numerical stability in edge cases where J2_tr is near zero,\n    # though for the given test cases it's not strictly necessary.\n    sqrt_J2_tr = np.sqrt(J2_tr)\n    f_tr = alpha * I1_tr + sqrt_J2_tr - k\n\n    # 4. Apply loading-unloading criterion\n    # A small tolerance for floating point comparisons near zero.\n    if f_tr = 1e-9:\n        # Elastic or neutral loading step\n        delta_lambda = 0.0\n    else:\n        # Plastic step: Compute delta_lambda using the derived formula\n        denominator = 9.0 * K * alpha**2 + G\n        delta_lambda = f_tr / denominator\n        \n    return delta_lambda\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: (K, G, alpha, k, [s11, s22, s33, s12, s23, s13])\n        (166e9, 80e9, 0.2, 200e6, [50e6, 50e6, 50e6, 10e6, 0.0, 0.0]),\n        # Case 2\n        (166e9, 80e9, 0.2, 200e6, [50e6, 50e6, 50e6, 250e6, 0.0, 0.0]),\n        # Case 3\n        (166e9, 80e9, 0.2, 200e6, [400e6, 400e6, 400e6, 0.0, 0.0, 0.0]),\n        # Case 4\n        (166e9, 80e9, 0.2, 200e6, [1e9/3.0, 1e9/3.0, 1e9/3.0, 0.0, 0.0, 0.0]),\n        # Case 5\n        (166e9, 80e9, 0.2, 200e6, [-400e6, -400e6, -400e6, 0.0, 0.0, 0.0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        K, G, alpha, k, sigma_vec = case\n        result = compute_delta_lambda(K, G, alpha, k, sigma_vec)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Using 'g' format specifier for clean representation of small numbers.\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```", "id": "2899915"}]}