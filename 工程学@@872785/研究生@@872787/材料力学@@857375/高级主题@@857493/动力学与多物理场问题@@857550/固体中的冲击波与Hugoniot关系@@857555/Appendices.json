{"hands_on_practices": [{"introduction": "本练习是应用朗金-雨贡尼奥（Rankine–Hugoniot）跳跃关系的一项基本练习。通过给定的冲击波速度（$U_s$）和粒子速度（$u_p$）的实验测量值，我们可以直接计算冲击波后的热力学状态，如压力和密度。这是解释冲击波实验数据、理解材料在极端条件下响应的第一步。[@problem_id:2917190]", "problem": "一道平面定常激波传播进入一个初始无应力、静止的晶体金属中。其初始质量密度为 $\\rho_{0}=2700\\ \\mathrm{kg/m^{3}}$，初始压力为 $P_{0}=0$。测得的激波速度和粒子速度分别为 $U_{s}=6.4\\ \\mathrm{km/s}$ 和 $u_{p}=1.0\\ \\mathrm{km/s}$。从跨越与激波阵面重合的静止控制面的质量守恒和动量守恒（即从守恒律的积分形式得到的 Rankine–Hugoniot 跳跃条件）出发，推导确定激波后方压缩态的密度 $\\rho$ 和压力 $P$ 所需的关系式。然后，计算比容变化 $\\Delta v$，其定义为 $\\Delta v \\equiv v-v_{0}$，其中 $v=1/\\rho$ 且 $v_{0}=1/\\rho_{0}$。\n\n在整个计算过程中使用物理上一致的单位，将速度转换为 $\\mathrm{m/s}$。最终压力以吉帕斯卡（GPa）表示，密度以 $\\mathrm{kg/m^{3}}$ 表示，比容变化以 $\\mathrm{m^{3}/kg}$ 表示。将所有数值结果四舍五入至 $4$ 位有效数字。将最终数值结果以单个有序三元组 $(\\rho,\\ P,\\ \\Delta v)$ 的形式报告，其中 $P$ 的单位是吉帕斯卡（GPa）。", "solution": "适当的基本出发点是，在激波静止的参考系中，描述均匀固体中一维平面定常激波的质量守恒和动量守恒。设状态 $0$ 表示上游（初始）状态，状态 $1$ 表示下游（激波后）状态。在激波固定的参考系中，上游材料以速度 $u_{0}=U_{s}$ 流入激波，下游材料以速度 $u_{1}=U_{s}-u_{p}$ 流出。\n\n跨越激波的质量守恒给出\n$$\n\\rho_{0}\\,u_{0}=\\rho\\,u_{1},\n$$\n也就是，\n$$\n\\rho_{0}\\,U_{s}=\\rho\\,(U_{s}-u_{p}).\n$$\n求解激波后的密度 $\\rho$，\n$$\n\\rho=\\rho_{0}\\,\\frac{U_{s}}{U_{s}-u_{p}}.\n$$\n\n跨越激波的线性动量守恒表明，动量通量加压力是连续的：\n$$\nP+\\rho\\,u_{1}^{2}=P_{0}+\\rho_{0}\\,u_{0}^{2}.\n$$\n代入 $u_{0}=U_{s}$ 和 $u_{1}=U_{s}-u_{p}$，并使用质量跳跃关系消去 $\\rho$，可以得到标准的 Rankine–Hugoniot 压力关系式\n$$\nP-P_{0}=\\rho_{0}\\,U_{s}\\,u_{p}.\n$$\n当 $P_{0}=0$ 时，上式简化为\n$$\nP=\\rho_{0}\\,U_{s}\\,u_{p}.\n$$\n\n比容分别为 $v_{0}=1/\\rho_{0}$ 和 $v=1/\\rho$，因此比容变化为\n$$\n\\Delta v=v-v_{0}=\\frac{1}{\\rho}-\\frac{1}{\\rho_{0}}.\n$$\n\n现在代入给定数据，并转换为一致的单位。将速度转换为 $\\mathrm{m/s}$：\n$$\nU_{s}=6.4\\times 10^{3}\\ \\mathrm{m/s},\\qquad u_{p}=1.0\\times 10^{3}\\ \\mathrm{m/s}.\n$$\n计算激波后的密度：\n$$\n\\rho=\\rho_{0}\\,\\frac{U_{s}}{U_{s}-u_{p}}=2700\\ \\mathrm{kg/m^{3}}\\times \\frac{6.4\\times 10^{3}}{6.4\\times 10^{3}-1.0\\times 10^{3}}=2700\\times \\frac{6400}{5400}\\ \\mathrm{kg/m^{3}}.\n$$\n由于 $\\frac{6400}{5400}=\\frac{32}{27}$，这得到\n$$\n\\rho=2700\\times \\frac{32}{27}=3200\\ \\mathrm{kg/m^{3}}.\n$$\n\n计算激波后的压力：\n$$\nP=\\rho_{0}\\,U_{s}\\,u_{p}=(2700\\ \\mathrm{kg/m^{3}})\\,(6.4\\times 10^{3}\\ \\mathrm{m/s})\\,(1.0\\times 10^{3}\\ \\mathrm{m/s}).\n$$\n乘积为\n$$\nP=17.28\\times 10^{9}\\ \\mathrm{Pa}=17.28\\ \\mathrm{GPa}.\n$$\n\n计算比容变化：\n$$\nv_{0}=\\frac{1}{\\rho_{0}}=\\frac{1}{2700}\\ \\mathrm{m^{3}/kg},\\qquad v=\\frac{1}{\\rho}=\\frac{1}{3200}\\ \\mathrm{m^{3}/kg},\n$$\n所以\n$$\n\\Delta v=\\frac{1}{3200}-\\frac{1}{2700}=\\frac{2700-3200}{2700\\times 3200}\\ \\mathrm{m^{3}/kg}=-\\frac{500}{8.64\\times 10^{6}}\\ \\mathrm{m^{3}/kg}.\n$$\n数值上，\n$$\n\\Delta v\\approx -5.787037\\ldots\\times 10^{-5}\\ \\mathrm{m^{3}/kg}.\n$$\n\n四舍五入至 $4$ 位有效数字，并用所要求的单位表示这些量，\n$$\n\\rho=3.200\\times 10^{3}\\ \\mathrm{kg/m^{3}},\\qquad P=17.28\\ \\mathrm{GPa},\\qquad \\Delta v=-5.787\\times 10^{-5}\\ \\mathrm{m^{3}/kg}.\n$$\n\n因此，有序三元组 $(\\rho,\\ P,\\ \\Delta v)$ 如上所示，其中 $P$ 的单位为吉帕斯卡（GPa）。", "answer": "$$\\boxed{(3.200 \\times 10^3, 17.28, -5.787 \\times 10^{-5})}$$", "id": "2917190"}, {"introduction": "在单个数据点的基础上，通过多次实验建立的$U_s$和$u_p$之间的关系能揭示更深层次的材料特性。本练习旨在探索这种经验关系的低压极限，阐明经验参数$c_0$如何与材料的体积模量$K$相关联。这个过程将非线性的冲击动力学与我们熟悉的线弹性理论联系起来，展示了冲击实验如何用于测定材料的基本弹性常数。[@problem_id:2917217]", "problem": "一个致密的、各向同性的多晶固体，在其环境、无应力状态下，参考质量密度为 $\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$。平面撞击实验产生的主雨贡纽关系可以很好地用一个线性的冲击波-粒子速度关系来表示，形式为 $U_s = c_0 + s\\,u_p$，测得的参数为 $c_0 = 5.2\\ \\mathrm{km/s}$ 和 $s = 1.3$。考虑进入初始无应力材料的一维冲击波，并假设绝热条件适用于高速率加载。\n\n仅使用跨越稳定平面冲击波阵面的质量和动量守恒，以及线性弹性中针对无穷小应变的模量定义，完成以下任务：\n\n1. 从 Rankine–Hugoniot 跳跃关系（质量和动量）出发，取小振幅极限 $u_p \\to 0$，并确定截距 $c_0$ 在固体中代表何种物理波速。由此，推导出小应变绝热体积模量 $K$ 关于 $\\rho_0$ 和 $c_0$ 的表达式。\n\n2. 使用给定数据数值计算体积模量。最终模量以吉帕斯卡（GPa）为单位表示，并将答案四舍五入至三位有效数字。\n\n3. 使用各向同性固体的线性弹性理论，简要论证有限剪切模量 $\\mu$ 的存在如何影响小应变极限下纵波波速与体积波波速的解释。写出如果错误地将 $c_0$ 等同于线性弹性固体的纵波波速，将会得到的 $K$ 的备选表达式（符号形式）。此备选表达式无需进行数值计算。\n\n给出体积模量的最终数值答案，以吉帕斯卡（GPa）为单位，四舍五入至三位有效数字。", "solution": "所提出的问题是材料力学中的一个标准练习，具体涉及冲击波的非线性动力学与线性弹性理论之间的联系。该问题提法恰当，有科学依据，并为获得唯一解提供了足够的信息。因此，我们着手进行分析。\n\n分析基于稳定一维平面冲击波的 Rankine–Hugoniot 跳跃条件。设冲击波以速度 $U_s$ 传播进入一个静止材料中，该材料的参考状态由密度 $\\rho_0$、压力 $p_0$ 和粒子速度 $u_0 = 0$ 定义。问题指出材料初始无应力，因此初始纵向应力 $\\sigma_{xx,0}$ 为零。冲击波后的状态由密度 $\\rho$、纵向应力 $\\sigma_{xx}$ 和粒子速度 $u_p$ 描述。\n\n跨越冲击波阵面的质量和动量守恒由以下公式给出：\n$$ \\rho_0 U_s = \\rho (U_s - u_p) \\quad \\text{(质量)} $$\n$$ \\sigma_{xx} - \\sigma_{xx,0} = \\rho_0 U_s (u_p - u_0) \\quad \\text{(动量)} $$\n在初始条件 $\\sigma_{xx,0} = 0$ 和 $u_0 = 0$ 下，动量方程简化为：\n$$ \\sigma_{xx} = \\rho_0 U_s u_p $$\n\n问题提供了一个冲击波速度 $U_s$ 和粒子速度 $u_p$ 之间的经验线性关系：\n$$ U_s = c_0 + s u_p $$\n其中 $c_0$ 和 $s$ 是材料常数。\n\n**第1部分：$c_0$ 的确定及体积模量 $K$ 的推导**\n\n我们被要求考虑小振幅极限，即 $u_p \\to 0$。在此极限下，经验关系式表明冲击波速度趋近于截距值：\n$$ \\lim_{u_p \\to 0} U_s = c_0 $$\n根据定义，无穷小振幅的冲击波即为声波。因此，$c_0$ 代表在零压条件下材料中的声波速度。\n\n为了推导体积模量 $K$ 的表达式，我们必须将应力与应变联系起来。跨越冲击波的纵向应变为 $\\epsilon_{xx} = 1 - \\frac{\\rho_0}{\\rho}$。从质量守恒方程，我们发现 $\\frac{\\rho_0}{\\rho} = \\frac{U_s - u_p}{U_s} = 1 - \\frac{u_p}{U_s}$。因此，纵向应变为：\n$$ \\epsilon_{xx} = \\frac{u_p}{U_s} $$\n\n在冲击物理学的背景下，尤其是在高压下，一个常见且有用的近似是将纵向应力 $\\sigma_{xx}$ 等同于静水压力 $P$。这就是流体动力学近似，其中应力的偏量（剪切）分量被认为与平均应力相比可以忽略不计。采用此近似，我们有 $P \\approx \\sigma_{xx}$。体积应变 $\\theta$ 定义为 $\\theta = 1 - V/V_0 = 1 - \\rho_0/\\rho$，对于一维应变，它等于纵向应变，即 $\\theta=\\epsilon_{xx}$。\n\n绝热体积模量定义为 $K = -V \\left(\\frac{\\partial P}{\\partial V}\\right)_S$。用密度表示，即 $K = \\rho \\left(\\frac{\\partial P}{\\partial \\rho}\\right)_S$。在小应变极限下，这可以写成 $K \\approx \\frac{\\Delta P}{\\Delta V/V_0} \\approx \\frac{P}{\\theta}$。\n我们将压力 $P$ 表示为体积应变 $\\theta$ 的函数：\n$$ P \\approx \\sigma_{xx} = \\rho_0 U_s u_p = \\rho_0 U_s^2 \\left(\\frac{u_p}{U_s}\\right) = \\rho_0 U_s^2 \\theta $$\n在零应变极限下（$\\theta \\to 0$），对应于 $u_p \\to 0$，冲击波速度 $U_s$ 趋近于 $c_0$。压力-应变关系变为线性：\n$$ P \\approx \\rho_0 c_0^2 \\theta $$\n零压下的体积模量 $K_0$ 是压力-应变曲线在原点的斜率：\n$$ K \\equiv K_0 = \\left.\\frac{dP}{d\\theta}\\right|_{\\theta=0} = \\rho_0 c_0^2 $$\n在此流体动力学近似下，参数 $c_0$ 被确定为零压体积声速，通常记为 $c_B$，其中 $c_B = \\sqrt{K/\\rho_0}$。\n\n**第2部分：体积模量的数值计算**\n\n使用推导出的表达式和给定的数据，我们计算体积模量 $K$。\n给定的值为：\n$\\rho_0 = 2.70 \\times 10^3\\ \\mathrm{kg/m^3}$\n$c_0 = 5.2\\ \\mathrm{km/s} = 5.2 \\times 10^3\\ \\mathrm{m/s}$\n将这些值代入 $K$ 的公式中：\n$$ K = (2.70 \\times 10^3\\ \\mathrm{kg/m^3}) \\times (5.2 \\times 10^3\\ \\mathrm{m/s})^2 $$\n$$ K = 2.70 \\times 10^3 \\times (5.2)^2 \\times 10^6\\ \\mathrm{kg/(m \\cdot s^2)} $$\n$$ K = 2.70 \\times 27.04 \\times 10^9\\ \\mathrm{Pa} $$\n$$ K = 73.008 \\times 10^9\\ \\mathrm{Pa} = 73.008\\ \\mathrm{GPa} $$\n根据要求，将结果四舍五入至三位有效数字：\n$$ K \\approx 73.0\\ \\mathrm{GPa} $$\n\n**第3部分：剪切模量的影响及备选表达式**\n\n第1部分的分析依赖于流体动力学近似，该近似忽略了材料的剪切刚度。一个各向同性的线性弹性固体由两个独立的模量表征，例如体积模量 $K$ 和剪切模量 $\\mu$。这种固体支持两种类型的声波。\n1. 纵波（P波），其中粒子运动方向与波的传播方向平行。这些波涉及体积变形和剪切变形。其速度由 $c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}}$ 给出。\n2. 横波（S波），其中粒子运动方向与波的传播方向垂直。这些波只涉及剪切变形，并以速度 $c_S = \\sqrt{\\frac{\\mu}{\\rho_0}}$ 传播。\n\n平面冲击波引起一维应变状态。在小振幅极限下，这变成了一维弹性波，即纵波。因此，对于固体而言，一个物理上更严谨的解释是，实验测得的零振幅波速 $c_0$ 对应于纵波波速 $c_L$。\n有限剪切模量（$\\mu  0$）的存在为单轴应变下的压缩提供了额外的阻力，这就是为什么纵向模量 $M = K + \\frac{4}{3}\\mu$ 大于体积模量 $K$ 的原因。因此，纵波波速 $c_L$ 总是大于体积声速 $c_B = \\sqrt{K/\\rho_0}$（假设 $\\mu0$）。因此，第1部分中将 $c_0$ 确定为 $c_B$ 的解释是一种简化，只有对于流体（$\\mu=0$）才是精确的。\n\n问题接着要求通过将 $c_0$ 等同于纵波波速来获得 $K$ 的备选表达式。尽管问题将这种方法标记为“不正确”，但从纯粹的弹性角度来看，这是正确的识别。我们按要求进行：\n$$ c_0 = c_L = \\sqrt{\\frac{K + \\frac{4}{3}\\mu}{\\rho_0}} $$\n为了找到 $K$ 的表达式，我们重新排列这个方程：\n$$ c_0^2 = \\frac{K + \\frac{4}{3}\\mu}{\\rho_0} $$\n$$ \\rho_0 c_0^2 = K + \\frac{4}{3}\\mu $$\n求解 $K$ 得到备选的符号表达式：\n$$ K = \\rho_0 c_0^2 - \\frac{4}{3}\\mu $$\n这个表达式明确表明，如果考虑到固体的剪切刚度，体积模量 $K$ 将小于根据流体动力学近似计算出的值 $\\rho_0 c_0^2$。这是一致的，因为 $\\rho_0 c_0^2$ 将代表纵向模量 $M = K + \\frac{4}{3}\\mu$。", "answer": "$$\n\\boxed{73.0}\n$$", "id": "2917217"}, {"introduction": "在实际研究中，实验数据总是伴随着噪声和不确定性。本练习将引导你完成一项真实的研究任务：如何从一组具有不同不确定性的测量数据中，使用加权最小二乘法来确定线性$U_s-u_p$关系的最佳拟合参数（$c_0$和$s$）。掌握这项技能对于定量表征材料的雨贡尼奥曲线至关重要，是冲击物理领域研究人员的核心能力之一。[@problem_id:2684944]", "problem": "给定各向同性固体中稳态平面冲击波的实验测量数据，其中冲击波速度 $U_s$ 和粒子速度 $u_p$ 通过一个经验线性关系相关联。该关系通常用于在中等压力下参数化 Rankine–Hugoniot 轨迹。假设主要测量不确定度存在于测量的冲击波速度 $U_s$ 中，并且为此拟合目的，粒子速度 $u_p$ 的不确定度可以忽略不计。$U_s$ 的测量误差是独立的、服从高斯分布的，并且具有已知的、不相等的标准差，即异方差误差。\n\n从最小二乘法的定义、独立测量的高斯似然以及参数线性模型 $U_s = c_0 + s\\,u_p$ 出发，您必须在已知异方差的情况下推导出参数 $c_0$ 和 $s$ 的估计量，并计算相关的参数协方差矩阵。在测量方差精确已知且估计量服从高斯分布的假设下，使用此结果为 $c_0$ 和 $s$ 构建置信水平为 $0.95$ 的双边置信区间。解释权重矩阵在估计量中的作用，以及为什么它能正确处理异方差性。\n\n实现一个程序，将您的推导应用于以下测试套件。在每个测试案例中，您会获得粒子速度 $u_p$（单位：m/s）、冲击波速度 $U_s$（单位：m/s）以及 $U_s$ 测量对应的标准差 $\\sigma_{U_s}$（单位：m/s）的数组。对于每个测试案例，使用加权最小二乘法拟合线性模型 $U_s = c_0 + s\\,u_p$，其中权重等于 $1/\\sigma_{U_s}^2$，并报告参数估计值及其 $0.95$ 置信区间。\n\n测试套件：\n- 案例 $1$（良态，中等异方差性）：\n  - $u_p$ (m/s): $[400, 800, 1200, 1600, 2000]$\n  - $U_s$ (m/s): $[5893, 6416, 6962, 7480, 8041]$\n  - $\\sigma_{U_s}$ (m/s): $[12, 14, 16, 18, 20]$\n- 案例 $2$（边界情况，恰好有两个数据点且不确定度不等）：\n  - $u_p$ (m/s): $[1000, 2500]$\n  - $U_s$ (m/s): $[7112, 8884]$\n  - $\\sigma_{U_s}$ (m/s): $[15, 35]$\n- 案例 $3$（包含 $u_p = 0$ 以强力约束 $c_0$，且不确定度具有高动态范围）：\n  - $u_p$ (m/s): $[0, 300, 900, 1800, 2400]$\n  - $U_s$ (m/s): $[3810, 4363, 5527, 7211, 8340]$\n  - $\\sigma_{U_s}$ (m/s): $[8, 12, 20, 26, 32]$\n\n数值报告要求：\n- 报告 $c_0$ 及其置信区间界限（单位：m/s）。\n- 报告 $s$ 及其置信区间界限（无量纲量）。\n- 使用基于尾部概率 $0.025$ 对应的高斯分位数的 $0.95$ 双边置信水平。\n- 将所有报告的数值四舍五入到 $3$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试案例的结果必须是 $[c_0, s, c_{0,\\mathrm{lower}}, c_{0,\\mathrm{upper}}, s_{\\mathrm{lower}}, s_{\\mathrm{upper}}]$ 形式的列表。因此，对于所有三个案例，最终输出必须是包含三个此类列表的列表，例如 `[[\\dots],[\\dots],[\\dots]]`。", "solution": "所提出的问题是有效的。它在科学上基于固体力学和统计数据分析的原理，特别是关于冲击波的线性 Hugoniot 关系以及用于处理异方差误差的参数估计的加权最小二乘法。该问题是良定的、客观的，并包含获得唯一且有意义解所需的所有信息。我们继续进行推导和实现。\n\n基本任务是将形式为 $U_s = c_0 + s\\,u_p$ 的线性模型拟合到一组 $N$ 个实验数据点 $(u_{p,i}, U_{s,i})$，其中 $i = 1, \\dots, N$。冲击波速度的测量值 $U_{s,i}$ 被假设为独立的，并受到均值为零、方差已知且不相等的 $\\sigma_i^2 = \\sigma_{U_s, i}^2$ 的高斯噪声的干扰。粒子速度 $u_{p,i}$ 被视为不确定度可忽略的自变量。\n\n我们可以用矩阵表示法来表达该模型。令 $\\boldsymbol{y}$ 为观测到的冲击波速度 $U_{s,i}$ 组成的 $N \\times 1$ 列向量，$\\boldsymbol{\\beta}$ 为待估计参数组成的 $2 \\times 1$ 列向量，$\\boldsymbol{\\beta} = [c_0, s]^T$，$\\boldsymbol{X}$ 为 $N \\times 2$ 的设计矩阵。该模型写作：\n$$\n\\boldsymbol{y} = \\boldsymbol{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}\n$$\n其中 $\\boldsymbol{\\epsilon}$ 是测量误差组成的 $N \\times 1$ 向量。这些向量和矩阵的分量为：\n$$\n\\boldsymbol{y} = \\begin{pmatrix} U_{s,1} \\\\ U_{s,2} \\\\ \\vdots \\\\ U_{s,N} \\end{pmatrix}, \\quad\n\\boldsymbol{X} = \\begin{pmatrix} 1  u_{p,1} \\\\ 1  u_{p,2} \\\\ \\vdots  \\vdots \\\\ 1  u_{p,N} \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} c_0 \\\\ s \\end{pmatrix}, \\quad\n\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\vdots \\\\ \\epsilon_N \\end{pmatrix}\n$$\n误差 $\\epsilon_i$ 是独立的，因此它们的协方差矩阵 $\\boldsymbol{\\Sigma}$ 是对角矩阵。误差的期望为 $E[\\boldsymbol{\\epsilon}] = \\boldsymbol{0}$，协方差由下式给出：\n$$\n\\boldsymbol{\\Sigma} = \\text{Cov}(\\boldsymbol{\\epsilon}) = E[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] = \\begin{pmatrix} \\sigma_1^2  0  \\dots  0 \\\\ 0  \\sigma_2^2  \\dots  0 \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ 0  0  \\dots  \\sigma_N^2 \\end{pmatrix}\n$$\n问题在于找到参数向量 $\\boldsymbol{\\beta}$ 的最佳估计，记为 $\\hat{\\boldsymbol{\\beta}}$。鉴于误差服从高斯分布，最优估计量可从最大似然原理推导得出。单个观测值 $y_i$ 的概率密度函数为：\n$$\np(y_i | u_{p,i}, \\boldsymbol{\\beta}, \\sigma_i) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (c_0 + s u_{p,i}))^2}{2\\sigma_i^2}\\right)\n$$\n由于测量是独立的，整个数据集 $\\boldsymbol{y}$ 的似然函数是各个概率的乘积：\n$$\nL(\\boldsymbol{\\beta}; \\boldsymbol{y}) = \\prod_{i=1}^{N} p(y_i) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left(-\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{2\\sigma_i^2}\\right)\n$$\n最大化似然函数 $L$ 等价于最大化其对数，即对数似然函数 $\\ln L$：\n$$\n\\ln L(\\boldsymbol{\\beta}; \\boldsymbol{y}) = -\\frac{N}{2}\\ln(2\\pi) - \\frac{1}{2}\\sum_{i=1}^{N}\\ln(\\sigma_i^2) - \\frac{1}{2}\\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\n为了最大化关于 $\\boldsymbol{\\beta}$ 的 $\\ln L$，我们必须最小化加权残差平方和，通常表示为 $\\chi^2$：\n$$\n\\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^{N}\\frac{(y_i - (\\boldsymbol{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2}\n$$\n这是加权最小二乘法 (WLS) 的核心准则。我们引入权重矩阵 $\\boldsymbol{W}$，其定义为误差协方差矩阵的逆：\n$$\n\\boldsymbol{W} = \\boldsymbol{\\Sigma}^{-1} = \\text{diag}\\left(\\frac{1}{\\sigma_1^2}, \\frac{1}{\\sigma_2^2}, \\dots, \\frac{1}{\\sigma_N^2}\\right)\n$$\n权重矩阵的作用是给予具有较小不确定度的测量值更大的重要性。每个残差平方 $(y_i - \\text{model}_i)^2$ 都由 $w_i = 1/\\sigma_i^2$ 进行加权。高精度（小 $\\sigma_i$）的数据点获得较大的权重，从而对拟合产生更强的影响。相反，噪声大的数据点（大 $\\sigma_i$）的权重则被降低。此过程确保估计量最大程度地利用最可靠的数据，正如从最大似然推导所示，这是解决此问题的统计最优方法。\n\n以矩阵形式，$\\chi^2$ 函数为：\n$$\n\\chi^2(\\boldsymbol{\\beta}) = (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})^T \\boldsymbol{W} (\\boldsymbol{y} - \\boldsymbol{X}\\boldsymbol{\\beta})\n$$\n为求最小值，我们计算 $\\chi^2$ 相对于 $\\boldsymbol{\\beta}$ 的梯度并将其设为零：\n$$\n\\nabla_{\\boldsymbol{\\beta}} \\chi^2 = -2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y} + 2\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}\\boldsymbol{\\beta} = \\boldsymbol{0}\n$$\n这给出了加权最小二乘法的“正规方程”：\n$$\n(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})\\hat{\\boldsymbol{\\beta}} = \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\n求解参数估计量 $\\hat{\\boldsymbol{\\beta}}$ 可得：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y}\n$$\n估计量的协方差矩阵 $\\boldsymbol{C}_{\\beta} = \\text{Cov}(\\hat{\\boldsymbol{\\beta}})$ 通过误差传播得到。\n$$\n\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\text{Cov}((\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{y})\n$$\n因为 $\\boldsymbol{X}$ 和 $\\boldsymbol{W}$ 是常数，且 $\\text{Cov}(\\boldsymbol{y}) = \\boldsymbol{\\Sigma} = \\boldsymbol{W}^{-1}$：\n$$\n\\boldsymbol{C}_{\\beta} = [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}] \\boldsymbol{\\Sigma} [(\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} \\boldsymbol{X}^T\\boldsymbol{W}]^T\n$$\n由于 $\\boldsymbol{W}$ 是对角矩阵，所以它是对称的（$\\boldsymbol{W}^T = \\boldsymbol{W}$）。这可以简化为：\n$$\n\\boldsymbol{C}_{\\beta} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X}) (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1} = (\\boldsymbol{X}^T\\boldsymbol{W}\\boldsymbol{X})^{-1}\n$$\n参数估计值 $\\hat{c}_0$ 和 $\\hat{s}$ 的方差是该协方差矩阵的对角元素：\n$$\n\\sigma_{\\hat{c}_0}^2 = (\\boldsymbol{C}_{\\beta})_{11}, \\quad \\sigma_{\\hat{s}}^2 = (\\boldsymbol{C}_{\\beta})_{22}\n$$\n标准误是这些方差的平方根。\n对于置信水平为 $1-\\alpha$ 的双边置信区间，我们使用公式 $\\hat{\\theta} \\pm z_{1-\\alpha/2} \\sigma_{\\hat{\\theta}}$。问题指定置信水平为 $0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。我们需要标准正态分位数 $z_{0.975}$，其近似值为 $1.96$。在计算中将使用一个精确值。测量方差精确已知的假设证明了使用正态分布分位数而非 t 分布分位数的合理性。\n置信区间为：\n$$\nc_{0, \\text{interval}} = \\hat{c}_0 \\pm z_{0.975} \\sigma_{\\hat{c}_0}\n$$\n$$\ns_{\\text{interval}} = \\hat{s} \\pm z_{0.975} \\sigma_{\\hat{s}}\n$$\n实现部分将把这些公式应用于所提供的三个测试案例。所有数值结果将按要求四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Applies weighted least squares to fit a linear Hugoniot relation\n    and computes parameter confidence intervals.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-conditioned, moderate heteroscedasticity)\n        {\n            \"up_ms\": np.array([400, 800, 1200, 1600, 2000]),\n            \"Us_ms\": np.array([5893, 6416, 6962, 7480, 8041]),\n            \"sigma_Us_ms\": np.array([12, 14, 16, 18, 20]),\n        },\n        # Case 2 (boundary case with exactly two data points)\n        {\n            \"up_ms\": np.array([1000, 2500]),\n            \"Us_ms\": np.array([7112, 8884]),\n            \"sigma_Us_ms\": np.array([15, 35]),\n        },\n        # Case 3 (includes up=0 and high dynamic range in uncertainties)\n        {\n            \"up_ms\": np.array([0, 300, 900, 1800, 2400]),\n            \"Us_ms\": np.array([3810, 4363, 5527, 7211, 8340]),\n            \"sigma_Us_ms\": np.array([8, 12, 20, 26, 32]),\n        }\n    ]\n\n    all_results = []\n    \n    # Critical value z for 95% confidence interval (two-sided)\n    alpha = 0.05\n    z_critical = norm.ppf(1 - alpha / 2)\n\n    for case in test_cases:\n        up = case[\"up_ms\"]\n        Us = case[\"Us_ms\"]\n        sigma_Us = case[\"sigma_Us_ms\"]\n\n        # 1. Construct the design matrix X\n        # X has a column of ones for the intercept c0\n        # and a column of up values for the slope s.\n        X = np.vstack([np.ones_like(up), up]).T\n\n        # 2. Construct the observation vector y\n        y = Us\n\n        # 3. Construct the weight matrix W\n        # W is diagonal with entries 1 / sigma_i^2\n        # For matrix operations, we can form it as a diagonal matrix.\n        W = np.diag(1.0 / sigma_Us**2)\n\n        # 4. Calculate the parameter estimates beta_hat = (c0_hat, s_hat)\n        # beta_hat = (X^T * W * X)^-1 * X^T * W * y\n        # We compute the parts separately for clarity.\n        XT_W = X.T @ W\n        XT_W_X = XT_W @ X\n        XT_W_y = XT_W @ y\n        \n        # Invert the matrix (X^T * W * X)\n        XT_W_X_inv = np.linalg.inv(XT_W_X)\n\n        beta_hat = XT_W_X_inv @ XT_W_y\n        c0_hat = beta_hat[0]\n        s_hat = beta_hat[1]\n\n        # 5. Calculate the parameter covariance matrix C_beta\n        # C_beta = (X^T * W * X)^-1\n        C_beta = XT_W_X_inv\n\n        # 6. Extract standard errors for the parameters\n        # These are the square roots of the diagonal elements of C_beta\n        var_c0 = C_beta[0, 0]\n        var_s = C_beta[1, 1]\n        std_err_c0 = np.sqrt(var_c0)\n        std_err_s = np.sqrt(var_s)\n        \n        # 7. Calculate confidence intervals\n        c0_lower = c0_hat - z_critical * std_err_c0\n        c0_upper = c0_hat + z_critical * std_err_c0\n        s_lower = s_hat - z_critical * std_err_s\n        s_upper = s_hat + z_critical * std_err_s\n\n        # 8. Round all results to 3 decimal places and collect them.\n        case_results = [\n            round(c0_hat, 3),\n            round(s_hat, 3),\n            round(c0_lower, 3),\n            round(c0_upper, 3),\n            round(s_lower, 3),\n            round(s_upper, 3)\n        ]\n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list of lists is used, removing spaces.\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2684944"}]}