{"hands_on_practices": [{"introduction": "非局部弹性理论与经典弹性理论的一个根本区别在于材料如何响应不同长度尺度下的动态载荷。本练习将探讨波在近场动力学杆中的传播。通过从基本原理推导波的频率 $\\omega$ 与其波数 $k$ 之间的关系[@problem_id:2905383]，您将揭示材料的“色散”现象，这是由近场动力学视域 $\\delta$ 所定义的非局部相互作用的直接结果。", "problem": "考虑一根由基于键的线性近场动力学 (PD) 建模的无限长、均匀的一维弹性杆。设质量密度为 $\\,\\rho\\,$，近场范围为 $\\,\\delta>0\\,$。微模量函数指定为\n$$\nc(|\\xi|)=\n\\begin{cases}\nc_{0}, & |\\xi|\\le \\delta,\\\\\n0, & |\\xi|>\\delta,\n\\end{cases}\n$$\n其中 $\\,c_{0}>0\\,$ 为常数。在点 $\\,x\\,$ 和时间 $\\,t\\,$ 的近场动力学内力密度定义为\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi,\n$$\n运动方程（体力为零）为\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t).\n$$\n假设一个空间谐波位移场\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t),\n$$\n其振幅为 $\\,u_{0}\\in\\mathbb{R}\\,$，波数为 $\\,k>0\\,$，角频率为 $\\,\\omega>0\\,$。此处 $\\,k\\,$ 的单位为弧度/米，$\\,\\omega\\,$ 的单位为弧度/秒。\n\n仅使用上述定义和定律，首先计算在任意点 $\\,x\\,$ 处的近场动力学内力密度 $\\,f_{\\text{int}}(x,t)\\,$，然后通过应用运动方程推导出连接 $\\,\\omega\\,$ 和 $\\,k\\,$ 的色散关系。请以 $\\,\\omega^{2}(k)\\,$ 关于 $\\,\\rho\\,$, $\\,c_{0}\\,$, $\\,\\delta\\,$ 和 $\\,k\\,$ 的单个闭式解析表达式的形式给出最终答案。方框内的最终答案中请勿包含单位。无需四舍五入。", "solution": "问题陈述已经过验证，是自洽的、有科学依据且适定的。这是非局部介质力学中的一个标准练习。我们现在开始推导。\n\n目标是通过将假设的谐波位移场代入近场动力学运动方程，求出色散关系 $\\omega^{2}(k)$。\n\n运动方程如下：\n$$\n\\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t)=f_{\\text{int}}(x,t)\n$$\n其中 $\\rho$ 是质量密度。\n\n假设的位移场为：\n$$\nu(x,t)=u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n其振幅为 $u_{0}\\in\\mathbb{R}$，波数为 $k>0$，角频率为 $\\omega>0$。\n\n首先，我们计算运动方程的左侧 (LHS)。这需要计算 $u(x,t)$ 关于时间 $t$ 的二阶偏导数：\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = u_{0}\\,\\sin(k x)\\,\\frac{\\partial}{\\partial t}\\exp(-\\mathrm{i}\\,\\omega t) = u_{0}\\,\\sin(k x)\\,(-\\mathrm{i}\\,\\omega)\\,\\exp(-\\mathrm{i}\\,\\omega t) = -\\mathrm{i}\\,\\omega\\,u(x,t)\n$$\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = \\frac{\\partial}{\\partial t}(-\\mathrm{i}\\,\\omega\\,u(x,t)) = (-\\mathrm{i}\\,\\omega)^{2}\\,u(x,t) = -\\omega^{2}\\,u(x,t)\n$$\n因此，运动方程的左侧 (LHS) 变为：\n$$\n\\text{LHS} = \\rho\\,\\frac{\\partial^{2} u}{\\partial t^{2}}(x,t) = -\\rho\\,\\omega^{2}\\,u(x,t)\n$$\n\n接下来，我们计算右侧 (RHS)，也就是近场动力学内力密度 $f_{\\text{int}}(x,t)$：\n$$\nf_{\\text{int}}(x,t)=\\int_{-\\delta}^{\\delta} c(|\\xi|)\\,\\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\n根据微模量函数在 $|\\xi| \\le \\delta$ 时 $c(|\\xi|) = c_{0}$，该表达式简化为：\n$$\nf_{\\text{int}}(x,t)=c_{0}\\int_{-\\delta}^{\\delta} \\big(u(x+\\xi,t)-u(x,t)\\big)\\,d\\xi\n$$\n我们将谐波位移场代入被积函数中：\n$$\nu(x+\\xi,t)-u(x,t) = u_{0}\\,\\sin(k(x+\\xi))\\,\\exp(-\\mathrm{i}\\,\\omega t) - u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t)\n$$\n$$\n= u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\n$$\n现在，我们将此结果代回 $f_{\\text{int}}(x,t)$ 的积分式中：\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi\n$$\n为了计算该积分，我们可以将其分为两部分：\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi - \\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi\n$$\n第一个积分计算如下：\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x+k \\xi)\\,d\\xi = \\left[-\\frac{\\cos(k x+k \\xi)}{k}\\right]_{-\\delta}^{\\delta} = -\\frac{1}{k}\\big(\\cos(k x+k \\delta) - \\cos(k x-k \\delta)\\big)\n$$\n使用三角恒等式 $\\cos(A) - \\cos(B) = -2\\sin(\\frac{A+B}{2})\\sin(\\frac{A-B}{2})$，其中 $A=kx+k\\delta$ 且 $B=kx-k\\delta$，我们得到：\n$$\n\\cos(k x+k \\delta) - \\cos(k x-k \\delta) = -2\\sin(k x)\\sin(k \\delta)\n$$\n所以，第一个积分为：\n$$\n-\\frac{1}{k}\\big(-2\\sin(k x)\\sin(k \\delta)\\big) = \\frac{2}{k}\\sin(k x)\\sin(k \\delta)\n$$\n第二个积分为：\n$$\n\\int_{-\\delta}^{\\delta} \\sin(k x)\\,d\\xi = \\sin(k x) \\int_{-\\delta}^{\\delta} 1\\,d\\xi = \\sin(k x) [\\xi]_{-\\delta}^{\\delta} = 2\\delta\\sin(k x)\n$$\n结合这两个积分的结果：\n$$\n\\int_{-\\delta}^{\\delta} \\big(\\sin(k x+k \\xi) - \\sin(k x)\\big)\\,d\\xi = \\frac{2}{k}\\sin(k x)\\sin(k \\delta) - 2\\delta\\sin(k x) = 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n将此结果代回 $f_{\\text{int}}(x,t)$ 的表达式中：\n$$\nf_{\\text{int}}(x,t) = c_{0}\\,u_{0}\\,\\exp(-\\mathrm{i}\\,\\omega t) \\left[ 2\\sin(k x)\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right) \\right]\n$$\n注意到 $u_{0}\\,\\sin(k x)\\,\\exp(-\\mathrm{i}\\,\\omega t) = u(x,t)$，我们可以将右侧 (RHS) 写为：\n$$\n\\text{RHS} = f_{\\text{int}}(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\n现在我们通过令左侧 (LHS) 和右侧 (RHS) 相等来应用运动方程：\n$$\n-\\rho\\,\\omega^{2}\\,u(x,t) = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)u(x,t)\n$$\n由于 $u(x,t)$ 不恒为零，我们可以用它除以等式两边，从而得到色散关系：\n$$\n-\\rho\\,\\omega^{2} = 2c_{0}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n最后，求解 $\\omega^{2}$ 作为 $k$ 的函数：\n$$\n\\omega^{2}(k) = -\\frac{2c_{0}}{\\rho}\\left(\\frac{\\sin(k \\delta)}{k} - \\delta\\right)\n$$\n$$\n\\omega^{2}(k) = \\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k \\delta)}{k}\\right)\n$$\n这就是所要求的色散关系的闭式解析表达式。对于任何具有物理意义且 $k>0$ 的波，项 $\\delta - \\frac{\\sin(k \\delta)}{k}$ 为正，这确保了 $\\omega^{2} > 0$ 且 $\\omega$ 为实数，符合要求。", "answer": "$$\n\\boxed{\\frac{2c_{0}}{\\rho}\\left(\\delta - \\frac{\\sin(k\\delta)}{k}\\right)}\n$$", "id": "2905383"}, {"introduction": "为了解决现实世界中的工程问题，我们必须将连续的近场动力学积分方程转化为适合计算机求解的离散形式。本练习将指导您推导一维杆的离散刚度矩阵 $\\mathbf{K}$ [@problem_id:2905429]。通过这个练习，您将深入理解非局部力的抽象概念是如何转化为具体的数值模型，并体会该系统矩阵的对称性和稀疏性等关键特性，这些特性对于高效的数值计算至关重要。", "problem": "考虑一个在一维均匀网格上离散化的杆的非局部、键基、线性微弹性近场动力学模型。设材料占据一个周期性域，从而在视界边界处不会发生混叠，并设节点位于整数 $i$ 的位置 $x_i = i\\,h$ 处，其中 $h$ 是均匀的网格间距。近场动力学视界为 $\\delta = m\\,h$，其中整数 $m \\ge 1$。微模量函数取为\n$$\nc(|\\xi|) = \\begin{cases}\nc_0\\left(1 - \\dfrac{|\\xi|}{\\delta}\\right), & 0 \\le |\\xi| \\le \\delta, \\\\\n0, & |\\xi| > \\delta,\n\\end{cases}\n$$\n其中 $c_0 > 0$ 是一个常数。假设小变形和准静态设置，体力密度为 $b(x)$，从而线性动量平衡成立。\n\n从基本的微弹性近场动力学内力表达式和线性动量平衡出发，推导在每个节点上通过配置法和近场动力学积分的中点法则求积得到的节点位移向量 $\\mathbf{u}$ 的离散线性系统。通过将组装方程写成 $\\mathbf{K}\\,\\mathbf{u} = \\mathbf{f}_b$ 的形式来定义离散刚度矩阵 $\\mathbf{K}$，其中 $\\mathbf{f}_b$ 是离散体力向量。提供由此离散化产生的矩阵元素 $K_{ij}$ 关于 $i$、$j$、$h$、$m$ 和 $c_0$ 的显式闭式表达式。然后，基于第一性原理和 $\\mathbf{K}$ 的构造，讨论 $\\mathbf{K}$ 是否对称，并描述其稀疏模式。\n\n你最终报告的答案应为 $K_{ij}$ 作为 $i$ 和 $j$ 的函数的单个闭式解析表达式（它可能是关于 $|i-j|$ 的分段函数）。最终表达式中不包含单位。无需进行数值舍入。", "solution": "用户需要一个非局部力学问题的解，具体是一维键基近场动力学问题。该问题要求在给定特定微模量函数的情况下，推导周期性网格上杆的离散刚度矩阵。推导必须从基本原理开始。我还需要分析所得矩阵的性质。\n\n该问题经验证是科学上合理、适定且客观的。所有提供的信息在近场动力学理论中都是标准的。我将继续进行求解。\n\n对于保守力学系统，推导刚度矩阵最基本的方法是从势能出发。平衡状态对应于系统总势能的驻点。\n\n总势能 $\\Pi$ 是内部应变能 $\\mathcal{E}$ 和外力势能之和，对于体力密度 $b(x)$，外力势能为 $W_{ext} = - \\int b(x) u(x) dx$。因此，$\\Pi = \\mathcal{E} - W_{ext}$。\n\n对于键基近场动力学材料，应变能 $\\mathcal{E}$ 是储存在所有键中的能量之和。线性微弹性材料的键应变能密度由 $w = \\frac{1}{2} c(|\\boldsymbol{\\xi}|) s^2$ 给出，其中 $c$ 是微模量，$\\boldsymbol{\\xi} = \\mathbf{x}' - \\mathbf{x}$ 是键向量，$s$ 是键伸长。\n\n在一维情况下，$\\xi = x' - x$，小变形的伸长为 $s = \\frac{u(x') - u(x)}{x' - x}$。总应变能是通过在域上对应变能密度 $W(x) = \\frac{1}{2}\\int_{\\mathcal{H}_x} w(x',x) dx'$ 进行积分得到的。为避免重复计算键，表达式为：\n$$ \\mathcal{E} = \\frac{1}{2} \\int \\left( \\frac{1}{2} \\int_{\\mathcal{H}_x} c(|x'-x|) \\left( \\frac{u(x')-u(x)}{x'-x} \\right)^2 dx' \\right) dx $$\n\n我们对指定网格将此表达式离散化。节点位于 $x_i = i h$。域上的积分变为节点上的求和，每个节点有一个体积（长度）$h$。视界上的积分使用中点法则近似，这变为对间距为 $h$ 的相邻节点的求和。设 $u_i = u(x_i)$。\n离散应变能为：\n$$ \\mathcal{E}_{discrete} = \\frac{1}{2} \\sum_i h \\left( \\frac{1}{2} \\sum_{j \\neq i, |j-i|\\le m} h \\, c(|x_j-x_i|) \\left(\\frac{u_j-u_i}{x_j-x_i}\\right)^2 \\right) $$\n代入 $x_j - x_i = (j-i)h$ 并化简：\n$$ \\mathcal{E}_{discrete} = \\frac{h^2}{4} \\sum_{i} \\sum_{j \\neq i, |j-i|\\le m} c(|(j-i)h|) \\frac{(u_j-u_i)^2}{((j-i)h)^2} $$\n$$ \\mathcal{E}_{discrete} = \\frac{1}{4} \\sum_{i} \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} (u_j-u_i)^2 $$\n双重求和将每个键 $(i,j)$ 计算了两次（一次为 $(i,j)$，一次为 $(j,i)$），因此有因子 $1/4$。\n\n外力势能的离散形式为 $W_{ext, discrete} = \\sum_i b(x_i) u_i h$。通过将总势能 $\\Pi_{discrete} = \\mathcal{E}_{discrete} - W_{ext, discrete}$ 对每个节点位移 $u_k$ 的导数设为零，可以找到平衡方程：\n$$ \\frac{\\partial \\Pi_{discrete}}{\\partial u_k} = \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} - b_k h = 0 $$\n离散系统为 $\\mathbf{K}\\mathbf{u} = \\mathbf{f}_b$，其中刚度矩阵的元素由应变能的Hessian矩阵给出，$K_{kj} = \\frac{\\partial^2 \\mathcal{E}_{discrete}}{\\partial u_k \\partial u_j}$，体力向量的元素为 $f_{b,k} = b_k h$。\n\n我们来计算 $\\mathbf{K}$ 的元素：\n一阶导数（节点 $k$ 上的内力）：\n$$ \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} = \\frac{1}{2} \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k-u_j) + \\frac{1}{2} \\sum_{i \\neq k, |i-k|\\le m} \\frac{c(|(i-k)h|)}{(i-k)^2} (u_k-u_i) $$\n$$ \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} = \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k-u_j) $$\n\n二阶导数（刚度矩阵元素）：\n对于非对角元素（$j \\neq k$）：\n$$ K_{kj} = \\frac{\\partial}{\\partial u_j} \\left( \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} \\right) = \\frac{\\partial}{\\partial u_j} \\left( \\dots + \\frac{c(|(k-j)h|)}{(k-j)^2}(u_k - u_j) + \\dots \\right) = - \\frac{c(|(k-j)h|)}{(k-j)^2} $$\n这适用于 $1 \\le |k-j| \\le m$。如果 $|k-j| > m$，相互作用为零，因此 $K_{kj}=0$。\n\n对于对角元素（$j = k$）：\n$$ K_{kk} = \\frac{\\partial}{\\partial u_k} \\left( \\frac{\\partial \\mathcal{E}_{discrete}}{\\partial u_k} \\right) = \\frac{\\partial}{\\partial u_k} \\left( \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} (u_k - u_j) \\right) = \\sum_{j \\neq k, |j-k|\\le m} \\frac{c(|(k-j)h|)}{(k-j)^2} $$\n\n现在，我们代入给定的微模量函数：\n$$ c(|\\xi|) = c_0 \\left(1 - \\frac{|\\xi|}{\\delta}\\right) \\quad \\text{for } |\\xi| \\le \\delta $$\n当 $\\xi = (j-i)h$ 且 $\\delta=mh$ 时，对于 $|j-i| \\le m$：\n$$ c(|(j-i)h|) = c_0 \\left(1 - \\frac{|j-i|h}{mh}\\right) = c_0 \\left(1 - \\frac{|j-i|}{m}\\right) $$\n刚度矩阵元素变为：\n对于 $i \\neq j$ 且 $|i-j| \\le m$：\n$$ K_{ij} = - \\frac{c_0 \\left(1 - \\frac{|i-j|}{m}\\right)}{(i-j)^2} $$\n对于 $i=j$：\n$$ K_{ii} = \\sum_{p \\neq i, |p-i| \\le m} \\frac{c_0 \\left(1 - \\frac{|p-i|}{m}\\right)}{(p-i)^2} $$\n求和索引 $p$ 的范围是从 $i-m$ 到 $i+m$，不包括 $i$。令 $k=p-i$。\n$$ K_{ii} = \\sum_{k=-m, k \\neq 0}^{m} \\frac{c_0 \\left(1 - \\frac{|k|}{m}\\right)}{k^2} $$\n由于被加数是 $k$ 的偶函数，我们可以将其写为：\n$$ K_{ii} = 2c_0 \\sum_{k=1}^{m} \\frac{1 - \\frac{k}{m}}{k^2} = 2c_0 \\sum_{k=1}^{m} \\left( \\frac{1}{k^2} - \\frac{1}{mk} \\right) $$\n这是对角元素的闭式表达式。\n\n矩阵 $\\mathbf{K}$ 的性质现在是显而易见的：\n1.  **对称性**：非对角项 $K_{ij}$ 取决于 $(i-j)^2$ 和 $|i-j|$，它们在交换 $i$ 和 $j$ 时是对称的。因此，$K_{ij}=K_{ji}$。该矩阵是对称的。这由其定义为一个标量势能函数的Hessian矩阵所保证。\n2.  **稀疏性**：仅当节点 $i$ 和 $j$ 之间的距离在近场动力学视界之内时，元素 $K_{ij}$ 才为非零，即 $|i-j|h \\le \\delta = mh$，这意味着 $|i-j| \\le m$。这导致了一个带宽为 $2m+1$ 的带状矩阵结构。对于远大于 $m$ 的大量节点 $N$，该矩阵是稀疏的。\n3.  **结构**：由于 $K_{ij}$ 仅取决于差值 $i-j$，该矩阵是Toeplitz矩阵。对于周期性域，它是一个循环矩阵。\n4.  **奇异性**：任意一行的和为 $\\sum_j K_{ij} = K_{ii} + \\sum_{j \\neq i} K_{ij}$。\n    $$ \\sum_j K_{ij} = \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} - \\sum_{j \\neq i, |j-i|\\le m} \\frac{c(|(j-i)h|)}{(j-i)^2} = 0 $$\n    行和为零的性质表明该矩阵是奇异的。对应于刚体平移的全一向量 $\\mathbf{1}$ 位于 $\\mathbf{K}$ 的零空间中（$\\mathbf{K}\\mathbf{1} = \\mathbf{0}$）。这在物理上是正确的，因为刚体运动不引起应变，因此不产生内力。\n\n刚度矩阵 $\\mathbf{K}$ 的元素的最终表达式以基于距离 $|i-j|$ 的分段形式给出。", "answer": "$$\n\\boxed{\nK_{ij} = \n\\begin{cases}\n2c_0 \\sum_{p=1}^{m} \\left( \\frac{1}{p^2} - \\frac{1}{mp} \\right) & \\text{如果 } i=j \\\\\n- \\frac{c_0}{(i-j)^2} \\left(1 - \\frac{|i-j|}{m}\\right) & \\text{如果 } 1 \\le |i-j| \\le m \\\\\n0 & \\text{如果 } |i-j| > m\n\\end{cases}\n}\n$$", "id": "2905429"}, {"introduction": "非局部理论的一个关键优势是其能够自然地模拟断裂的萌生与扩展。这个实践问题将挑战您应用一个非局部失效准则来预测带缺口杆的临界载荷[@problem_id:2905433]，这是一个经典问题，而经典理论在该问题中会预测出无限大的应力奇异性。通过计算非局部的键拉伸，您将看到在视域 $\\delta$ 范围内对材料响应进行平均，是如何自然地使应力集中正规化，并得出一个有限且尺寸相关的失效预测。", "problem": "考虑一根长度为 $L$ 的一维拉伸杆，其中心 $x = L/2$ 处有一个对称切口。其横截面积是分段常数，定义为\n- $A(x) = A_{\\min}$ 对于 $|x - L/2| \\le a$，\n- $A(x) = A_0$ 对于 $|x - L/2| > a$，\n参数满足 $0 < A_{\\min} \\le A_0$，$0 < a \\ll L/2$，以及 $0 < \\delta \\le L/2$，其中 $\\delta$ 是非局域视界。该杆在小应变条件和准静态平衡下，两端承受轴向拉伸载荷 $P$。材料是线弹性的，杨氏模量为 $E$。将在点 $x$ 处的非局域键伸长量度定义为，在使用三角形影响函数时，作用范围内键轴向伸长的归一化加权平均值，\n$$w(r) = \\begin{cases}\n1 - \\dfrac{r}{\\delta}, & 0 \\le r \\le \\delta, \\\\\n0, & r > \\delta,\n\\end{cases}$$\n并对其进行对称延拓以适用于负值 $r$。对于位移为 $u(x)$、局部轴向应变为 $\\varepsilon(x) = \\dfrac{du}{dx}$ 的单调拉伸变形，将在点 $x$ 处的非局域键伸长近似为\n$$s(x) = \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\dfrac{|u(y)-u(x)|}{|y-x|}\\,dy \\approx \\dfrac{1}{M(\\delta)} \\int_{x-\\delta}^{x+\\delta} w(|y-x|)\\,\\varepsilon(y)\\,dy,$$\n其中归一化因子为 $M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr$。假设准静态力平衡意味着沿杆的轴向力 $P$ 是恒定的，因此局部应变满足 $\\varepsilon(x) = \\dfrac{P}{E\\,A(x)}$。令 $s_c$ 表示临界伸长。预测当在 $x_0 = L/2$ 处 $s(x_0) = s_c$ 时，断裂将在切口根部起始。\n\n任务：从上述基本定义和假设出发，通过强制施加 $s(L/2) = s_c$ 条件，推导出一个显式的计算程序，以预测起始载荷 $P_c$ 作为 $E$、$A_0$、$A_{\\min}$、$a$ 和 $\\delta$ 的函数。在一个程序中实现此过程，用于评估以下参数集测试套件的 $P_c$（每个元组按 $(E, A_0, A_{\\min}, a, \\delta, s_c, L)$ 的顺序排列）：\n- 情况1（$\\delta > a$ 的一般情况）：$(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况2（$\\delta < a$ 的情况）：$(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 3.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况3（大视界）：$(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-1}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况4（无切口，$A_{\\min} = A_0$）：$(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 2.0 \\times 10^{-2}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n- 情况5（非常小的视界）：$(200 \\times 10^{9}\\,\\mathrm{Pa},\\; 1.0 \\times 10^{-4}\\,\\mathrm{m}^2,\\; 2.0 \\times 10^{-5}\\,\\mathrm{m}^2,\\; 5.0 \\times 10^{-3}\\,\\mathrm{m},\\; 1.0 \\times 10^{-6}\\,\\mathrm{m},\\; 2.0 \\times 10^{-3},\\; 1.0\\,\\mathrm{m})$。\n\n你的程序必须：\n- 使用上述带有三角形影响函数的非局域定义，获得 $s(L/2)$ 的一个闭式解或数值精确解，并从 $s(L/2) = s_c$ 求解 $P_c$。\n- 对于每种情况，输出预测的起始载荷 $P_c$，单位为 $\\mathrm{N}$，并四舍五入到最接近的整数。\n- 生成单行输出，其中包含按上述情况顺序排列的结果，形式为方括号内以逗号分隔的列表（例如，格式为 [$p_1,p_2,p_3,p_4,p_5$]）。\n\n所有输入均采用国际单位制（SI）。最终载荷以 $\\mathrm{N}$ 为单位表示，四舍五入到最接近的整数，并确保在所有计算中 $0 < \\delta \\le L/2$。你的算法应具有通用性，不依赖任何非物理假设。", "solution": "问题陈述提出了一个在非局域连续介质力学领域中明确定义的问题，具体涉及具有几何不连续性的一维杆的断裂起始。该模型基于一种类近场动力学的键伸长量度。该问题具有科学依据，内容自洽，并且可以形式化。因此，它被认为是有效的。我们着手推导临界载荷 $P_c$ 的计算过程。\n\n目标是确定在切口中心 $x_0 = L/2$ 处引发断裂的临界拉伸载荷 $P_c$。断裂准则由该点的非局域键伸长 $s(x)$ 达到临界值 $s_c$ 的条件给出。\n$$s(L/2) = s_c$$\n为方便起见，我们平移空间坐标，使切口中心位于原点，即 $x' = x - L/2 = 0$。分析在 $x'=0$ 处进行。该点的非局域键伸长定义为：\n$$s(0) = \\dfrac{1}{M(\\delta)} \\int_{-\\delta}^{\\delta} w(|y|)\\,\\varepsilon(y)\\,dy$$\n其中 $\\delta$ 是非局域视界， $w(|y|)$ 是影响函数，$\\varepsilon(y)$ 是局部轴向应变。\n\n首先，我们必须确定归一化因子 $M(\\delta)$。影响函数被给定为一个对称的三角形函数：\n$$w(r) = 1 - \\dfrac{|r|}{\\delta} \\quad \\text{for } |r| \\le \\delta, \\text{ and } 0 \\text{ otherwise.}$$\n归一化因子是影响函数在作用范围内的积分：\n$$M(\\delta) = \\int_{-\\delta}^{\\delta} w(|r|)\\,dr = 2 \\int_{0}^{\\delta} \\left(1 - \\dfrac{r}{\\delta}\\right) dr = 2 \\left[ r - \\dfrac{r^2}{2\\delta} \\right]_0^\\delta = 2 \\left( \\delta - \\dfrac{\\delta^2}{2\\delta} \\right) = \\delta$$\n因此，归一化因子就是视界本身，$M(\\delta) = \\delta$。\n\n局部应变 $\\varepsilon(y)$ 由准静态平衡条件导出，该条件意味着整个杆的轴向力 $P$ 是恒定的。应变与局部横截面积 $A(y)$ 成反比：\n$$\\varepsilon(y) = \\dfrac{P}{E\\,A(y)}$$\n面积 $A(y)$ 是一个关于原点对称的分段常数函数：\n$$A(y) = \\begin{cases} A_{\\min} & \\text{for } |y| \\le a \\\\ A_0 & \\text{for } |y| > a \\end{cases}$$\n其中 $a$ 是切口的半宽度。\n\n将这些表达式代入 $s(0)$ 的公式，我们得到：\n$$s(0) = \\dfrac{1}{\\delta} \\int_{-\\delta}^{\\delta} \\left(1 - \\dfrac{|y|}{\\delta}\\right) \\dfrac{P}{E\\,A(y)} dy$$\n由于 $P$ 和 $E$ 是常数，我们可以将它们提出。此外，被积函数是 $y$ 的偶函数，因此我们可以简化积分：\n$$s(0) = \\dfrac{2P}{E\\delta} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A(y)} dy$$\n此积分的计算取决于视界 $\\delta$ 和切口半宽度 $a$ 的相对大小。我们必须考虑两种不同的情况。\n\n情况1：视界小于或等于切口半宽度（$\\delta \\le a$）。\n在这种情况下，对于整个积分域 $y \\in [0, \\delta]$，条件 $y \\le \\delta \\le a$ 成立。因此，横截面积是恒定的，$A(y) = A_{\\min}$。积分变为：\n$$\\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) \\dfrac{1}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\int_{0}^{\\delta} \\left(1 - \\dfrac{y}{\\delta}\\right) dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^\\delta = \\dfrac{1}{A_{\\min}} \\left( \\delta - \\dfrac{\\delta}{2} \\right) = \\dfrac{\\delta}{2A_{\\min}}$$\n将此结果代入 $s(0)$ 的表达式中：\n$$s(0) = \\dfrac{2P}{E\\delta} \\left( \\dfrac{\\delta}{2A_{\\min}} \\right) = \\dfrac{P}{E A_{\\min}}$$\n这恰好是切口根部的局部应变。对于 $\\delta \\le a$，非局域模型在最大应变点的预测与局部理论一致。对临界载荷 $P_c$ 应用断裂准则 $s(0) = s_c$：\n$$s_c = \\dfrac{P_c}{E A_{\\min}} \\implies P_c = s_c E A_{\\min}$$\n\n情况2：视界大于切口半宽度（$\\delta > a$）。\n在这种情况下，积分必须分成两部分，对应于视界内横截面积的两个区域：\n$$\\int_{0}^{\\delta} \\dfrac{1 - y/\\delta}{A(y)} dy = \\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy + \\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy$$\n计算第一个积分：\n$$\\int_{0}^{a} \\dfrac{1 - y/\\delta}{A_{\\min}} dy = \\dfrac{1}{A_{\\min}} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_0^a = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right)$$\n计算第二个积分：\n$$\\int_{a}^{\\delta} \\dfrac{1 - y/\\delta}{A_0} dy = \\dfrac{1}{A_0} \\left[ y - \\dfrac{y^2}{2\\delta} \\right]_a^\\delta = \\dfrac{1}{A_0} \\left[ \\left(\\delta - \\dfrac{\\delta^2}{2\\delta}\\right) - \\left(a - \\dfrac{a^2}{2\\delta}\\right) \\right] = \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\n结合这些结果，总积分为：\n$$I = \\dfrac{1}{A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{1}{A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right)$$\n现在我们通过代入这个积分 $I$ 来找到 $s(0)$：\n$$s(0) = \\dfrac{2P}{E\\delta} I = \\dfrac{P}{E} \\left[ \\dfrac{2}{\\delta A_{\\min}} \\left( a - \\dfrac{a^2}{2\\delta} \\right) + \\dfrac{2}{\\delta A_0} \\left( \\dfrac{\\delta}{2} - a + \\dfrac{a^2}{2\\delta} \\right) \\right]$$\n$$s(0) = \\dfrac{P}{E} \\left[ \\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{2a}{\\delta} + \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_0} \\right]$$\n对各项进行因式分解可以得到一个更紧凑的表达式：\n$$s(0) = \\dfrac{P}{E} \\left[ \\left(\\dfrac{a}{\\delta}\\left(2 - \\dfrac{a}{\\delta}\\right)\\right) \\dfrac{1}{A_{\\min}} + \\left(1 - \\dfrac{a}{\\delta}\\right)^2 \\dfrac{1}{A_0} \\right]$$\n应用断裂准则 $s(0) = s_c$ 并求解临界载荷 $P_c$：\n$$P_c = \\dfrac{s_c E}{\\left( \\dfrac{2a}{\\delta} - \\dfrac{a^2}{\\delta^2} \\right) \\dfrac{1}{A_{\\min}} + \\left( 1 - \\dfrac{a}{\\delta} \\right)^2 \\dfrac{1}{A_0}}$$\n此公式对 $\\delta > a$ 有效。可以验证，当 $\\delta \\to a^+$ 时，此表达式平滑地收敛到情况1的结果，从而确保了连续性。\n\n因此，计算过程是：对每个测试用例使用输入参数来确定是 $\\delta \\le a$ 还是 $\\delta > a$，应用相应的 $P_c$ 公式，并计算数值结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the critical fracture initiation load Pc for a notched bar\n    using a one-dimensional nonlocal bond-stretch model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is ordered as (E, A_0, A_min, a, delta, s_c, L) in SI units.\n    test_cases = [\n        # Case 1 (general case with delta > a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-2, 2.0e-3, 1.0),\n        # Case 2 (case with delta < a)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 3.0e-3, 2.0e-3, 1.0),\n        # Case 3 (large horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-1, 2.0e-3, 1.0),\n        # Case 4 (no notch, A_min = A_0)\n        (200e9, 1.0e-4, 1.0e-4, 5.0e-3, 2.0e-2, 2.0e-3, 1.0),\n        # Case 5 (very small horizon)\n        (200e9, 1.0e-4, 2.0e-5, 5.0e-3, 1.0e-6, 2.0e-3, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_mod, A_0, A_min, a_notch, delta_horizon, s_crit, _ = case\n\n        # The calculation depends on the relationship between the horizon (delta)\n        # and the notch half-width (a).\n        if delta_horizon = a_notch:\n            # Case for delta = a: Horizon is within the notch region.\n            # The nonlocal stretch equals the local strain at the notch root.\n            # This recovers the local theory prediction.\n            # Formula: Pc = s_c * E * A_min\n            P_c = s_crit * E_mod * A_min\n        else:\n            # Case for delta > a: Horizon extends beyond the notch region.\n            # The nonlocal stretch is a weighted average of strains from both\n            # the notched and un-notched regions.\n            # Formula: Pc = s_c * E / [ (2a/d - (a/d)^2)/A_min + (1-a/d)^2/A_0 ]\n            \n            # Ratio of notch half-width to horizon\n            ratio_a_delta = a_notch / delta_horizon\n            \n            # Geometric factor in the denominator of the Pc expression\n            geom_factor = ( (2 * ratio_a_delta - ratio_a_delta**2) / A_min \n                           + (1 - ratio_a_delta)**2 / A_0 )\n            \n            P_c = (s_crit * E_mod) / geom_factor\n        \n        # Round the result to the nearest integer as required.\n        results.append(int(np.round(P_c)))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2905433"}]}