{"hands_on_practices": [{"introduction": "绝热剪切带的形成源于一个关键假设：塑性变形产热的速率远超热量通过传导散失的速率。本练习旨在通过量化这一物理过程来巩固您的理解。通过推导和比较力学变形与热扩散的特征时间尺度，您将能够判断在特定高应变率条件下，“绝热”假设的合理性 [@problem_id:2613647]。", "problem": "在高应变率剪切局部化过程中，当机械变形产热的速率快于热量通过热扩散穿过剪切带厚度的速率时，会形成绝热剪切带 (ASB)。考虑一个厚度为 $h$ 的剪切带，其内部的温度根据具有恒定物性的一维热传导方程演化。设热扩散系数为 $\\alpha$，施加的剪切应变率为 $\\dot{\\gamma}$。从一维热方程和剪切应变率的定义出发，推导穿过剪切带的热扩散和机械变形的相应特征时间尺度。然后，使用 $h=50\\,\\mu\\mathrm{m}$，$\\alpha=1.2\\times 10^{-5}\\,\\mathrm{m}^{2}\\!/\\mathrm{s}$ 和 $\\dot{\\gamma}=10^{4}\\,\\mathrm{s}^{-1}$，计算热扩散时间尺度与变形时间尺度之比 $R$。将答案四舍五入至三位有效数字。以纯数（无量纲）的形式报告该比值。", "solution": "必须首先严格验证问题陈述的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n\n-   **主题**：高应变率剪切局部化和绝热剪切带 (ASB) 的形成。\n-   **物理模型**：厚度为 $h$ 的剪切带内具有恒定物性的一维热传导。\n-   **控制物理学**：一维热方程和剪切应变率 $\\dot{\\gamma}$ 的定义。\n-   **参数**：\n    -   剪切带厚度, $h = 50\\,\\mu\\mathrm{m}$。\n    -   热扩散系数, $\\alpha = 1.2\\times 10^{-5}\\,\\mathrm{m}^{2}\\!/\\mathrm{s}$。\n    -   施加的剪切应变率, $\\dot{\\gamma} = 10^{4}\\,\\mathrm{s}^{-1}$。\n-   **任务**：\n    1.  推导热扩散和机械变形的特征时间尺度。\n    2.  计算热扩散时间尺度与变形时间尺度之比 $R$。\n    3.  将最终数值答案四舍五入至三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题描述了绝热剪切带的形成，这是固体力学中一个公认的现象，尤其是在韧性材料高速变形的背景下。使用一维热方程是分析热量穿过剪切带狭窄维度的标准且合适的模型。其中的定义和物理量在连续介质力学和材料科学中都是标准的。所提供的剪切带厚度、热扩散系数和应变率的数值对于动态加载条件下的金属是物理上现实的。\n-   **适定性**：问题陈述清晰。它要求从基本原理出发推导特征时间尺度，并随后基于所提供的数据进行计算。目标是明确的，并且给出了足够的信息以得出唯一解。\n-   **客观性**：该问题以精确、客观、科学的语言表述，没有任何主观或模糊的术语。\n\n**步骤3：结论与行动**\n\n该问题被确定为有效。它在科学上是合理的、适定的，并且需要一个基于基本物理原理的解。我们将继续进行推导和计算。\n\n绝热剪切带的形成是由两个过程之间的竞争所决定的：机械功产生的热量和从剪切带传导出去的热量。我们的任务是找出每个过程的特征时间尺度。\n\n首先，我们考虑热扩散过程。剪切带内的温度演化 $T(x, t)$ 由一维热方程描述：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n在这里，$t$ 是时间，$x$ 是穿过剪切带厚度的空间坐标。一个特征时间尺度，我们记为 $\\tau_{th}$，可以通过对该方程进行量纲分析得到。我们使用特征量来近似导数。扩散的特征长度尺度是剪切带的厚度 $h$。时间导数可以近似为 $\\frac{\\partial T}{\\partial t} \\sim \\frac{\\Delta T}{\\tau_{th}}$，空间二阶导数可以近似为 $\\frac{\\partial^2 T}{\\partial x^2} \\sim \\frac{\\Delta T}{h^2}$，其中 $\\Delta T$ 是一个特征温度变化。\n将这些代入热方程，得到一个尺度平衡：\n$$\n\\frac{\\Delta T}{\\tau_{th}} \\sim \\alpha \\frac{\\Delta T}{h^2}\n$$\n求解热扩散时间尺度 $\\tau_{th}$，我们得到：\n$$\n\\tau_{th} = \\frac{h^2}{\\alpha}\n$$\n这代表了热量扩散穿过距离 $h$ 所需的特征时间。\n\n接下来，我们推导机械变形的特征时间尺度。问题提供了施加的剪切应变率 $\\dot{\\gamma}$。根据定义，应变率是应变 $\\gamma$ 的变化率：\n$$\n\\dot{\\gamma} = \\frac{d\\gamma}{dt}\n$$\n机械过程的特征时间尺度 $\\tau_{mech}$ 是累积显著应变所需的时间。在大塑性变形和流动局部化的背景下，通常考虑一个量级为1的特征应变，即 $\\Delta \\gamma \\sim 1$。使用有限差分近似，$\\dot{\\gamma} \\sim \\frac{\\Delta \\gamma}{\\tau_{mech}}$。当 $\\Delta \\gamma \\sim 1$ 时，我们发现机械变形时间尺度为：\n$$\n\\tau_{mech} = \\frac{1}{\\dot{\\gamma}}\n$$\n这代表了发生显著塑性应变所需的特征时间。\n\n问题要求计算热扩散时间尺度与变形时间尺度之比 $R$：\n$$\nR = \\frac{\\tau_{th}}{\\tau_{mech}} = \\frac{h^2 / \\alpha}{1 / \\dot{\\gamma}} = \\frac{h^2 \\dot{\\gamma}}{\\alpha}\n$$\n这个无量纲比值比较了热量逸出剪切带所需的时间与通过变形产生该热量所需的时间。如果 $R \\gg 1$，则变形远快于热扩散，导致温度升高和热软化，这正是*绝热*剪切的条件。\n\n我们现在将给定的数值代入 $R$ 的表达式中。必须保持单位一致（国际单位制单位）。\n已知：\n-   $h = 50\\,\\mu\\mathrm{m} = 50 \\times 10^{-6}\\,\\mathrm{m} = 5 \\times 10^{-5}\\,\\mathrm{m}$\n-   $\\alpha = 1.2 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$\n-   $\\dot{\\gamma} = 10^{4}\\,\\mathrm{s}^{-1}$\n\n计算过程如下：\n$$\nR = \\frac{(5 \\times 10^{-5}\\,\\mathrm{m})^2 (10^{4}\\,\\mathrm{s}^{-1})}{1.2 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}}\n$$\n$$\nR = \\frac{(25 \\times 10^{-10}\\,\\mathrm{m}^2) (10^{4}\\,\\mathrm{s}^{-1})}{1.2 \\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}}\n$$\n$$\nR = \\frac{25 \\times 10^{-6}\\,\\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}}{1.2 \\times 10^{-5}\\,\\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}}\n$$\n单位消去，证实 $R$ 是一个无量纲量。\n$$\nR = \\frac{25 \\times 10^{-6}}{12 \\times 10^{-6}} = \\frac{25}{12}\n$$\n$$\nR = 2.08333...\n$$\n问题要求答案四舍五入至三位有效数字。\n$$\nR \\approx 2.08\n$$\n值 $R \\approx 2.08$ 大于 1，这证实了条件有利于绝热剪切局部化，因为产热的速率快于热量传导出去的速率。", "answer": "$$\\boxed{2.08}$$", "id": "2613647"}, {"introduction": "当材料的强度因温升而减弱的速率超过其因应变而增强的速率时，便会发生剪切局部化。这个练习将带您深入探讨这一失稳临界点。通过建立一个包含应变硬化和热软化效应的本构关系，您将计算出在绝热条件下材料的实际应力-应变斜率，从而揭示导致绝热剪切带形成的根本力学机制 [@problem_id:2613637]。", "problem": "一个均匀、各向同性的金属试样在高剪切应变率下经受简单剪切。假设绝热条件，并且塑性功功率的一部分以恒定比例瞬时转化为热量。设剪切应力为 $\\,\\tau\\,$，剪切应变率为 $\\,\\dot{\\gamma}\\,$。体积热容为 $\\,\\rho c\\,$，泰勒-奎尼系数（塑性功转化为热量的比例）为 $\\,\\beta\\,$。瞬时等温硬化模量为 $\\,H = \\left(\\partial \\tau/\\partial \\gamma\\right)_{T}\\,$，流变应力的瞬时温度敏感性为 $\\,\\left(\\partial \\tau/\\partial T\\right)_{\\gamma} = -\\eta_{T}\\,$，其中 $\\,\\eta_{T} > 0\\,$。\n\n在所关注的瞬间，测量或指定了以下数值：$\\,H = 800\\,\\text{MPa}\\,$, $\\,\\eta_{T} = 2\\,\\text{MPa/K}\\,$, $\\,\\beta = 0.9\\,$, $\\,\\rho c = 3\\,\\text{MJ}/(\\text{m}^{3}\\,\\text{K})\\,$, $\\,\\tau = 1\\,\\text{GPa}\\,$，以及 $\\,\\dot{\\gamma} = 10^{4}\\,\\text{s}^{-1}\\,$。在足够小的增量范围内，将这些量视为局部常数。仅使用能量守恒和温度与应变的线性化本构关系，确定该瞬间单位剪切应变引起的绝热温升 $\\,\\partial T/\\partial \\gamma\\,$ 以及由此产生的增量应力-应变斜率 $\\,\\partial \\tau/\\partial \\gamma\\,$。\n\n请将您的答案表示为一个二元行向量 $\\,\\big[\\left(\\partial T/\\partial \\gamma\\right),\\ \\left(\\partial \\tau/\\partial \\gamma\\right)\\big]\\,$，其中第一个条目以开尔文（K）为单位，第二个条目以兆帕斯卡（MPa）为单位。将每个条目四舍五入至三位有效数字。", "solution": "首先对问题陈述进行严格的验证过程。\n\n步骤 1：提取已知条件\n提供了以下量和定义：\n- 剪切应力：$\\tau$\n- 剪切应变率：$\\dot{\\gamma}$\n- 体积热容：$\\rho c$\n- 泰勒-奎尼系数：$\\beta$\n- 等温硬化模量：$H = \\left(\\frac{\\partial \\tau}{\\partial \\gamma}\\right)_{T}$\n- 流变应力的温度敏感性：$\\left(\\frac{\\partial \\tau}{\\partial T}\\right)_{\\gamma} = -\\eta_{T}$，其中 $\\eta_{T} > 0$\n- 在所关注的瞬间，数值如下：\n  - $H = 800\\,\\text{MPa}$\n  - $\\eta_{T} = 2\\,\\text{MPa/K}$\n  - $\\beta = 0.9$\n  - $\\rho c = 3\\,\\text{MJ}/(\\text{m}^{3}\\,\\text{K})$\n  - $\\tau = 1\\,\\text{GPa}$\n  - $\\dot{\\gamma} = 10^{4}\\,\\text{s}^{-1}$\n- 问题假设为绝热条件，并且指定的量可以被视为局部常数。\n\n步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n- **科学依据：** 该问题基于连续介质力学的基本原理，特别是非等温条件下的塑性理论。绝热条件下的热力学第一定律（能量守恒）是其核心概念。本构模型是流变应力对应变和温度依赖性的线性化表示，这是分析材料不稳定性（如绝热剪切带）时使用的标准且有效的简化方法。给定的数值对于高速变形下的金属是物理上合理的。例如，$\\beta \\approx 0.9$ 是一个广泛接受的金属中塑性功转化为热量的比例值。应力、应变率和材料模量均在实验观察到的实际范围内。\n- **适定性：** 该问题提供了一套完整的参数和关系，足以确定所要求的两个量 $\\frac{\\partial T}{\\partial \\gamma}$ 和 $\\frac{\\partial \\tau}{\\partial \\gamma}$。数据中没有矛盾。单位系统是一致的，尽管在转换时必须小心。该问题的结构可以得出一个唯一的解。\n- **客观性：** 该问题以物理学和工程学科中典型的精确、定量和无偏见的语言陈述。\n\n步骤 3：结论与行动\n该问题具有科学性、适定性和客观性。这是一个固体力学中的有效问题。因此，我将继续进行解答。\n\n解答源于两个基本原理：能量守恒和材料的本构关系。\n\n1.  **能量守恒**\n在绝热条件下，单位体积内能的增加率等于转化为热量的塑性功功率的一部分。单位体积的塑性功功率为 $\\dot{W}_p = \\tau \\dot{\\gamma}$。因此，产热率为 $\\beta \\tau \\dot{\\gamma}$。这种产热导致温度升高，内能储存率为 $\\rho c \\dot{T}$，其中 $\\dot{T} = \\frac{dT}{dt}$。\n能量平衡方程为：\n$$\n\\rho c \\frac{dT}{dt} = \\beta \\tau \\dot{\\gamma}\n$$\n我们寻求单位剪切应变引起的温升，即 $\\frac{\\partial T}{\\partial \\gamma}$。使用链式法则，我们可以将温度的时间导数写为：\n$$\n\\frac{dT}{dt} = \\frac{\\partial T}{\\partial \\gamma} \\frac{d\\gamma}{dt} = \\frac{\\partial T}{\\partial \\gamma} \\dot{\\gamma}\n$$\n将此代入能量平衡方程，得到：\n$$\n\\rho c \\left( \\frac{\\partial T}{\\partial \\gamma} \\dot{\\gamma} \\right) = \\beta \\tau \\dot{\\gamma}\n$$\n由于应变率 $\\dot{\\gamma} = 10^{4}\\,\\text{s}^{-1}$ 非零，我们可以将方程两边同时除以 $\\dot{\\gamma}$，求得单位应变引起的绝热温升：\n$$\n\\frac{\\partial T}{\\partial \\gamma} = \\frac{\\beta \\tau}{\\rho c}\n$$\n\n2.  **本构关系**\n流变应力 $\\tau$ 是剪切应变 $\\gamma$ 和温度 $T$ 的函数，即 $\\tau = \\tau(\\gamma, T)$。应力的全微分为：\n$$\nd\\tau = \\left(\\frac{\\partial \\tau}{\\partial \\gamma}\\right)_{T} d\\gamma + \\left(\\frac{\\partial \\tau}{\\partial T}\\right)_{\\gamma} dT\n$$\n使用所给定义，$H = \\left(\\frac{\\partial \\tau}{\\partial \\gamma}\\right)_{T}$ 和 $\\left(\\frac{\\partial \\tau}{\\partial T}\\right)_{\\gamma} = -\\eta_{T}$，我们有：\n$$\nd\\tau = H d\\gamma - \\eta_{T} dT\n$$\n我们需要求解的是绝热条件下的总或有效应力-应变斜率，即 $\\frac{d\\tau}{d\\gamma}$（在问题陈述中记为 $\\frac{\\partial \\tau}{\\partial \\gamma}$）。将方程两边除以 $d\\gamma$ 得到：\n$$\n\\frac{\\partial \\tau}{\\partial \\gamma} = H - \\eta_{T} \\frac{\\partial T}{\\partial \\gamma}\n$$\n该表达式描述了由 $H$ 代表的等温应变硬化与由项 $-\\eta_{T} \\frac{\\partial T}{\\partial \\gamma}$ 代表的热软化之间的竞争。代入从能量平衡推导出的 $\\frac{\\partial T}{\\partial \\gamma}$ 表达式：\n$$\n\\frac{\\partial \\tau}{\\partial \\gamma} = H - \\eta_{T} \\left( \\frac{\\beta \\tau}{\\rho c} \\right)\n$$\n\n3.  **数值计算**\n我们必须使用一套一致的单位。我们将所有量转换为国际单位制基本单位（帕斯卡、米、开尔文）。\n- $\\tau = 1\\,\\text{GPa} = 1 \\times 10^{9}\\,\\text{Pa}$\n- $\\rho c = 3\\,\\text{MJ}/(\\text{m}^{3}\\,\\text{K}) = 3 \\times 10^{6}\\,\\text{J}/(\\text{m}^{3}\\,\\text{K})$。注意 $1\\,\\text{J/m}^3 = 1\\,\\text{Pa}$，所以 $\\rho c = 3 \\times 10^{6}\\,\\text{Pa/K}$。\n- $\\beta = 0.9$（无量纲）\n- $H = 800\\,\\text{MPa} = 800 \\times 10^{6}\\,\\text{Pa}$\n- $\\eta_{T} = 2\\,\\text{MPa/K} = 2 \\times 10^{6}\\,\\text{Pa/K}$\n\n首先，我们计算单位应变引起的温升：\n$$\n\\frac{\\partial T}{\\partial \\gamma} = \\frac{\\beta \\tau}{\\rho c} = \\frac{0.9 \\times (1 \\times 10^{9}\\,\\text{Pa})}{3 \\times 10^{6}\\,\\text{Pa/K}} = \\frac{0.9}{3} \\times 10^{3}\\,\\text{K} = 0.3 \\times 10^{3}\\,\\text{K} = 300\\,\\text{K}\n$$\n问题要求此答案以开尔文为单位。其值为 $300\\,\\text{K}$。四舍五入到三位有效数字，即为 $3.00 \\times 10^{2}\\,\\text{K}$。\n\n接下来，我们计算增量应力-应变斜率。由于单位一致，我们可以直接使用 MPa 单位进行计算。\n- $H = 800\\,\\text{MPa}$\n- $\\eta_{T} = 2\\,\\text{MPa/K}$\n- $\\frac{\\partial T}{\\partial \\gamma} = 300\\,\\text{K}$\n$$\n\\frac{\\partial \\tau}{\\partial \\gamma} = H - \\eta_{T} \\frac{\\partial T}{\\partial \\gamma} = 800\\,\\text{MPa} - (2\\,\\text{MPa/K}) \\times (300\\,\\text{K})\n$$\n$$\n\\frac{\\partial \\tau}{\\partial \\gamma} = 800\\,\\text{MPa} - 600\\,\\text{MPa} = 200\\,\\text{MPa}\n$$\n问题要求此答案以 MPa 为单位。其值为 $200\\,\\text{MPa}$。四舍五入到三位有效数字，即为 $2.00 \\times 10^{2}\\,\\text{MPa}$。\n\n这个二元行向量是 $\\big[\\left(\\partial T/\\partial \\gamma\\right),\\ \\left(\\partial \\tau/\\partial \\gamma\\right)\\big] = [3.00 \\times 10^{2}, 2.00 \\times 10^{2}]$。", "answer": "$$\n\\boxed{[3.00 \\times 10^{2}, \\quad 2.00 \\times 10^{2}]}\n$$", "id": "2613637"}, {"introduction": "在数值模拟中，由材料软化引起的应变局部化会导致一个棘手的难题：计算结果（如剪切带的厚度）会不切实际地依赖于网格尺寸。本计算实践将引导您直面并解决这一问题。您将实现一个包含梯度正则化策略的热-力耦合模型，并通过对比有无正则化以及不同网格密度下的结果，亲身体验并验证如何获得网格无关的、具有物理意义的剪切带厚度预测 [@problem_id:2613665]。", "problem": "您需要设计并实现一个一维、率相关、热机耦合的小应变剪切模型，该模型能展现绝热剪切带现象。您还需要嵌入一个基于等效塑性应变隐式梯度的正则化策略，以确保带厚的预测具有网格无关性。您的实现必须计算多种网格下的剪切带厚度，并展示正则化长度对网格无关性的影响。\n\n请从固体力学和热力学中的标准基本守恒和本构原理出发：\n\n- 小应变运动学：总工程剪切应变为 $ \\gamma(t) = \\gamma^{\\mathrm{e}}(t) + \\gamma^{\\mathrm{p}}(x,t) $，其中 $ \\gamma^{\\mathrm{e}} $ 是弹性剪切应变，$ \\gamma^{\\mathrm{p}} $ 是塑性剪切应变。\n- 均匀单剪加载下的准静态线性动量平衡：忽略惯性力和体力，并施加一个以恒定速率 $ \\dot{\\gamma} $ 增长的空间均匀宏观剪切；根据弹性定律计算局部剪切应力 $ \\tau(x,t) = G \\, \\gamma^{\\mathrm{e}}(x,t) = G \\, [\\gamma(t) - \\gamma^{\\mathrm{p}}(x,t)] $，其中 $ G $ 是剪切模量。\n- 绝热能量平衡（无热传导）：温升 $ T(x,t) - T_{0} $ 由塑性功转化而来，其转化因子为泰勒-奎尼因子 $ \\beta $，因此有 $ \\dot{T}(x,t) = \\beta \\, \\tau(x,t) \\, \\dot{\\gamma}^{\\mathrm{p}}(x,t) / (\\rho c) $，其中 $ \\rho c $ 是体积热容，$ T_{0} $ 是初始温度。\n- 率相关粘塑性流动（Perzyna型过应力）：定义过应力函数 $ f(x,t) = |\\tau(x,t)| - g(x,t) $，其中流动强度为 $ g(x,t) $；则对于单调正向剪切，塑性剪切应变率为 $ \\dot{\\gamma}^{\\mathrm{p}}(x,t) = \\dfrac{1}{\\eta} \\, \\langle f(x,t) \\rangle $，其中 $ \\eta $ 是粘度参数，$ \\langle \\cdot \\rangle $ 表示取正算子 $ \\langle a \\rangle = \\max(a,0) $。\n- 带应变硬化的热软化流动强度：设 $ g(x,t) = \\big(\\sigma_{y0}(x) + H \\, \\bar{\\varepsilon}^{\\mathrm{p}}(x,t)\\big) \\, \\phi\\big(T(x,t)\\big) $，其中 $ \\sigma_{y0}(x) $ 是初始屈服强度（带有一个小的局部缺陷以引发局部化），$ H $ 是硬化模量，$ \\bar{\\varepsilon}^{\\mathrm{p}} $ 是非局部等效塑性应变，$ \\phi(T) $ 是一个随温度升高而减小的软化因子。选择一个简单的线性软化因子 $ \\phi(T) = \\max\\big(1 - a_{T}\\,[T(x,t)-T_{0}], \\, \\varepsilon_{\\phi}\\big) $，其中 $ a_{T} > 0 $，$ \\varepsilon_{\\phi} \\in (0,1) $ 是一个小的截断值，以避免出现不符合物理实际的负强度。\n- 隐式梯度正则化（亥姆霍兹型非局部性）：将非局部等效塑性应变 $ \\bar{\\varepsilon}^{\\mathrm{p}}(x,t) $ 定义为标量亥姆霍兹方程 $ \\bar{\\varepsilon}^{\\mathrm{p}}(x,t) - \\ell^{2} \\, \\bar{\\varepsilon}^{\\mathrm{p}}_{,xx}(x,t) = \\varepsilon^{\\mathrm{p}}(x,t) $ 在周期性边界条件下的解，其中 $ \\ell $ 是内禀材料长度，$ \\varepsilon^{\\mathrm{p}}(x,t) $ 是局部累积塑性应变（在单剪中，$ \\varepsilon^{\\mathrm{p}} \\equiv \\gamma^{\\mathrm{p}} $），下标 $ x $ 表示空间微分。\n\n您必须在一个长度为 $ L $ 的一维周期性杆上实现均匀剪切试验。该杆被离散为 $ N $ 个节点，间距为 $ \\Delta x = L/N $，承受从 $ t=0 $ 到 $ t = t_{\\mathrm{f}} $ 的剪切应变历史 $ \\gamma(t) = \\dot{\\gamma} \\, t $，且 $ \\gamma(t_{\\mathrm{f}}) = \\gamma_{\\mathrm{f}} $。使用一个时间步长为 $ \\Delta t $ 的显式时间步进格式，在每一步更新 $ \\gamma^{\\mathrm{p}}(x,t) $、$ T(x,t) $ 和非局部变量 $ \\bar{\\varepsilon}^{\\mathrm{p}}(x,t) $。在 $ \\sigma_{y0}(x) $ 中引入一个位于杆中心附近的小的空间缺陷，以触发单个剪切带的形成。\n\n正则化策略要求：\n- 通过在周期性边界条件下使用谱方法求解亥姆霍兹方程来实施隐式梯度正则化，得到 $ \\bar{\\varepsilon}^{\\mathrm{p}} $。具体方法是使用傅里叶变换表示 $ \\widehat{\\bar{\\varepsilon}^{\\mathrm{p}}}(k) = \\widehat{\\varepsilon}^{\\mathrm{p}}(k) / \\big(1 + \\ell^{2} k^{2}\\big) $，其中 $ k $ 为波数。对于未正则化的基准情况，设置 $ \\ell = 0 $，此时 $ \\bar{\\varepsilon}^{\\mathrm{p}} \\equiv \\varepsilon^{\\mathrm{p}} $。\n\n验证与测量：\n- 在最终时刻 $ t_{\\mathrm{f}} $，通过计算 $ \\varepsilon^{\\mathrm{p}}(x,t_{\\mathrm{f}}) $ 在其全局最大值周围的空间分布的半峰全宽（FWHM）来确定剪切带厚度。将 FWHM 定义为峰值周围满足 $ \\varepsilon^{\\mathrm{p}} \\ge \\tfrac{1}{2} \\max_{x} \\varepsilon^{\\mathrm{p}} $ 的最大连续区域的长度。\n- 为验证网格无关性，请对多种网格运行模拟并比较测得的厚度。当 $ \\ell=0 $（无梯度正则化）时，厚度应随网格细化而缩小（网格依赖性）。当 $ \\ell > 0 $ 时，厚度应近似独立于网格尺寸（网格无关性）。\n\n参数值与无量纲化：\n- 全程使用无量纲单位；以无量纲长度单位报告带厚。使用 $ L = 1 $，$ G = 100 $，$ \\dot{\\gamma} = 1 $，$ \\gamma_{\\mathrm{f}} = 0.5 $，$ \\Delta t = 10^{-3} $，$ \\eta = 5 \\times 10^{-2} $，$ H = 0.2 $，$ \\sigma_{y0}(x) = 1 - d_{0}\\,\\exp\\!\\big(-\\tfrac{(x-0.5)^{2}}{2 w^{2}}\\big) $，其中 $ d_{0} = 0.02 $ 且 $ w = 0.01 $，$ \\beta = 0.9 $，$ \\rho c = 1 $，$ a_{T} = 1 $，$ T_{0} = 0 $，$ \\varepsilon_{\\phi} = 0.1 $。对亥姆霍兹滤波器使用周期性边界条件。\n- 您可以假设剪切为严格正向，因此 $ \\dot{\\gamma}^{\\mathrm{p}}(x,t) = \\max\\big(0, (|\\tau|-g)/\\eta \\big) $，没有符号模糊性。\n\n测试套件：\n- 提供四个以元组 $ (\\ell, N) $ 形式指定的测试用例：\n  1. $ (\\ell = 0, \\, N = 400) $\n  2. $ (\\ell = 0, \\, N = 1600) $\n  3. $ (\\ell = 0.01, \\, N = 400) $\n  4. $ (\\ell = 0.01, \\, N = 1600) $\n- 对每个测试用例，运行模拟至 $ \\gamma_{\\mathrm{f}} $，并以无量纲长度单位输出测得的 FWHM 带厚。此外，计算两个布尔值来总结网格无关性：\n  - 比较用例1和2的厚度，$ b_{\\mathrm{unreg}} $ 在相对差异超过容差 $ \\tau_{\\mathrm{rel}} = 0.2 $ 时应为 $ \\mathrm{False} $；定义 $ b_{\\mathrm{unreg}} = \\big|\\mathrm{FWHM}_{(0,400)} - \\mathrm{FWHM}_{(0,1600)}\\big| \\le \\tau_{\\mathrm{rel}} \\times \\mathrm{FWHM}_{(0,400)} $。\n  - 比较用例3和4的厚度，$ b_{\\mathrm{grad}} $ 在相对差异处于相同容差范围内时应为 $ \\mathrm{True} $；定义 $ b_{\\mathrm{grad}} = \\big|\\mathrm{FWHM}_{(0.01,400)} - \\mathrm{FWHM}_{(0.01,1600)}\\big| \\le \\tau_{\\mathrm{rel}} \\times \\mathrm{FWHM}_{(0.01,400)} $。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：$ [ \\mathrm{FWHM}_{(0,400)}, \\mathrm{FWHM}_{(0,1600)}, \\mathrm{FWHM}_{(0.01,400)}, \\mathrm{FWHM}_{(0.01,1600)}, b_{\\mathrm{unreg}}, b_{\\mathrm{grad}} ] $。带厚值必须是无量纲单位的浮点数。\n\n实现约束：\n- 程序必须是一个完整的、可运行的单一脚本，无需外部输入即可执行所有计算。对亥姆霍兹滤波器使用周期性谱方法求解。使用所述参数，并按规定以无量纲单位报告输出。通过遵循所述模型和参数，确保结果的数值稳定性和科学合理性。", "solution": "该问题陈述经过验证，被认为是科学上合理的、适定的且完整的。它提出了一个用于研究绝热剪切带（固体力学中的一个关键现象）的标准简化模型。该公式结合了连续介质力学、粘塑性力学和热耦合的既定原理。通过亥姆霍兹方程引入梯度正则化项，是在出现材料软化和应变局部化时确保结果具有网格无关性的一种公认且适当的方法。参数以无量纲形式提供，数值任务也已明确规定。因此，提供一个解是合理的。\n\n该模型建立在长度为 $L$、坐标为 $x$ 的一维域上。系统的演化由一组关于状态变量——塑性剪切应变 $\\gamma^{\\mathrm{p}}(x,t)$ 和温度 $T(x,t)$——的耦合微分方程描述。\n\n控制方程如下：\n\n1.  **运动学**：总剪切应变 $\\gamma(t)$ 被分解为弹性和塑性部分：\n    $$\n    \\gamma(t) = \\gamma^{\\mathrm{e}}(x,t) + \\gamma^{\\mathrm{p}}(x,t)\n    $$\n    物体承受均匀的剪切应变历史 $\\gamma(t) = \\dot{\\gamma}t$。\n\n2.  **动量平衡**：在忽略惯性的准静态近似下，剪切应力 $\\tau$ 在空间上是均匀的。然而，问题文本指定了从局部弹性应变计算局部应力，这意味着放宽了均匀应力的假设，这在此类模型中很常见，其中 $\\tau(x,t)$ 被认为是与 $\\gamma^{\\mathrm{p}}(x,t)$ 共轭的应力。\n    $$\n    \\tau(x,t) = G \\gamma^{\\mathrm{e}}(x,t) = G \\left( \\gamma(t) - \\gamma^{\\mathrm{p}}(x,t) \\right)\n    $$\n    这里，$G$ 是剪切模量。\n\n3.  **塑性本构律**：使用 Perzyna 型粘塑性模型。塑性剪切应变率 $\\dot{\\gamma}^{\\mathrm{p}}$ 由过应力驱动，过应力是剪切应力大小与当前流动强度 $g(x,t)$ 之间的差值。对于单调正向剪切，其表达式为：\n    $$\n    \\dot{\\gamma}^{\\mathrm{p}}(x,t) = \\frac{1}{\\eta} \\langle \\tau(x,t) - g(x,t) \\rangle\n    $$\n    其中 $\\eta$ 是粘度参数，$\\langle a \\rangle = \\max(a, 0)$。\n\n4.  **流动强度演化**：流动强度 $g$ 因应变硬化和热软化而演化：\n    $$\n    g(x,t) = \\left(\\sigma_{y0}(x) + H \\bar{\\varepsilon}^{\\mathrm{p}}(x,t)\\right) \\phi\\left(T(x,t)\\right)\n    $$\n    - $\\sigma_{y0}(x)$ 是初始屈服强度，带有一个小的缺陷以引发局部化：$\\sigma_{y0}(x) = 1 - d_{0}\\exp\\left(-\\frac{(x-0.5)^{2}}{2 w^{2}}\\right)$。\n    - $H$ 是常数硬化模量。\n    - $\\bar{\\varepsilon}^{\\mathrm{p}}$ 是非局部等效塑性应变，通过正则化过程获得。\n    - $\\phi(T)$ 是热软化函数：$\\phi(T) = \\max\\left(1 - a_{T}[T(x,t)-T_{0}], \\varepsilon_{\\phi}\\right)$。\n\n5.  **能量平衡**：在绝热条件下，温度升高是由于部分塑性功转化为热量所致：\n    $$\n    \\dot{T}(x,t) = \\frac{\\beta}{\\rho c} \\tau(x,t) \\dot{\\gamma}^{\\mathrm{p}}(x,t)\n    $$\n    其中 $\\beta$ 是泰勒-奎尼系数，$\\rho c$ 是体积热容。\n\n6.  **梯度正则化**：为确保网格无关性，使用隐式梯度模型对局部塑性应变 $\\varepsilon^{\\mathrm{p}} \\equiv \\gamma^{\\mathrm{p}}$ 进行正则化。非局部应变 $\\bar{\\varepsilon}^{\\mathrm{p}}$ 是亥姆霍兹方程的解：\n    $$\n    \\bar{\\varepsilon}^{\\mathrm{p}}(x,t) - \\ell^{2} \\frac{\\partial^2 \\bar{\\varepsilon}^{\\mathrm{p}}(x,t)}{\\partial x^2} = \\gamma^{\\mathrm{p}}(x,t)\n    $$\n    该方程具有周期性边界条件。参数 $\\ell$ 是一个内禀材料长度尺度。\n\n数值解法采用显式前向欧拉时间步进格式，在一个包含 $N$ 个节点、间距为 $\\Delta x = L/N$ 的均匀空间网格上实现。在每个时间步 $t_n = n\\Delta t$，对每个节点 $x_i$ 上的状态变量 $\\gamma^{\\mathrm{p}}(x_i, t_n)$ 和 $T(x_i, t_n)$ 进行更新。\n\n从 $t_n$ 到 $t_{n+1}$ 的单个时间步算法如下：\n1.  $t_n$ 时刻的已知状态：$\\gamma^{\\mathrm{p}}_n$, $T_n$, $\\bar{\\varepsilon}^{\\mathrm{p}}_n$。\n2.  计算总应变：$\\gamma_{n+1} = \\dot{\\gamma} t_{n+1}$。\n3.  计算应力：$\\tau_n = G(\\dot{\\gamma}t_n - \\gamma^{\\mathrm{p}}_n)$。\n4.  计算流动强度：$g_n = (\\sigma_{y0} + H \\barvarepsilon^{\\mathrm{p}}_n) \\max(1 - a_T(T_n - T_0), \\varepsilon_\\phi)$。\n5.  计算塑性应变率：$\\dot{\\gamma}^{\\mathrm{p}}_n = \\frac{1}{\\eta} \\max(0, \\tau_n - g_n)$。\n6.  更新塑性应变：$\\gamma^{\\mathrm{p}}_{n+1} = \\gamma^{\\mathrm{p}}_n + \\dot{\\gamma}^{\\mathrm{p}}_n \\Delta t$。\n7.  更新温度：$T_{n+1} = T_n + \\frac{\\beta}{\\rho c} \\tau_n \\dot{\\gamma}^{\\mathrm{p}}_n \\Delta t$。\n8.  更新非局部应变：由于其卷积性质和周期性边界条件，亥姆霍兹方程在傅里叶空间中求解。\n    - 计算更新后局部塑性应变的离散傅里叶变换 (DFT)：$\\widehat{\\gamma^{\\mathrm{p}}}_{n+1} = \\mathcal{F}\\{\\gamma^{\\mathrm{p}}_{n+1}\\}$。\n    - 微分算子 $\\frac{\\partial^2}{\\partial x^2}$ 在傅里叶空间中变为乘以 $-k^2$，其中 $k$ 是角波数。亥姆霍兹方程变为代数方程：$\\widehat{\\bar{\\varepsilon}^{\\mathrm{p}}}_{n+1} (1 + \\ell^2 k^2) = \\widehat{\\gamma^{\\mathrm{p}}}_{n+1}$。\n    - 求解非局部应变的 DFT：$\\widehat{\\bar{\\varepsilon}^{\\mathrm{p}}}_{n+1}(k) = \\frac{\\widehat{\\gamma^{\\mathrm{p}}}_{n+1}(k)}{1 + \\ell^2 k^2}$。波数 $k$ 由离散频率 $k_j = 2\\pi j/L$ 给出。当 $\\ell=0$ 时，这简化为 $\\widehat{\\bar{\\varepsilon}^{\\mathrm{p}}} = \\widehat{\\gamma^{\\mathrm{p}}}$，即 $\\bar{\\varepsilon}^{\\mathrm{p}} = \\gamma^{\\mathrm{p}}$，恢复为局部模型。\n    - 计算逆 DFT 以获得实空间中的非局部应变：$\\bar{\\varepsilon}^{\\mathrm{p}}_{n+1} = \\mathcal{F}^{-1}\\{\\widehat{\\bar{\\varepsilon}^{\\mathrm{p}}}_{n+1}\\}$。\n\n重复此时间步进过程，直到最终模拟时间 $t_f = \\gamma_f/\\dot{\\gamma}$。\n\n最后，在最终状态 $t_f$ 下测量剪切带厚度。厚度定义为最终塑性应变分布 $\\gamma^{\\mathrm{p}}(x, t_f)$ 的半峰全宽（FWHM）。我们首先确定最大值 $\\gamma^{\\mathrm{p}}_{\\max}$ 及其位置 $x_{\\max}$。然后，我们找到围绕 $x_{\\max}$ 的最大连续空间区域，其中 $\\gamma^{\\mathrm{p}}(x, t_f) \\ge \\frac{1}{2} \\gamma^{\\mathrm{p}}_{\\max}$。该区域的长度即为 FWHM。实现的算法从峰值向外搜索以找到该区域的边界。\n\n所提供的 Python 代码为四个指定的测试用例实现了这整个过程，计算了带厚，并评估了两个关于网格无关性的布尔条件。结果表明，在没有正则化（$\\ell=0$）的情况下，预测的带厚病态地依赖于网格尺寸，随着网格的细化而缩小。而采用梯度正则化（$\\ell>0$）后，带厚收敛到一个与内禀长度尺度 $\\ell$ 相关的、有限的、与网格无关的值。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the adiabatic shear banding problem\n    and print the results in the specified format.\n    \"\"\"\n    \n    test_cases = [\n        # (l, N)\n        (0.0, 400),\n        (0.0, 1600),\n        (0.01, 400),\n        (0.01, 1600),\n    ]\n\n    fwhm_results = []\n    for l_val, N_val in test_cases:\n        fwhm = run_simulation(l_val, N_val)\n        fwhm_results.append(fwhm)\n\n    # Unpack results for clarity\n    fwhm_0_400, fwhm_0_1600, fwhm_0p01_400, fwhm_0p01_1600 = fwhm_results\n    \n    # Define tolerance for mesh objectivity check\n    tau_rel = 0.2\n\n    # Check for mesh objectivity\n    # Unregularized case: expect False (thickness depends on mesh)\n    if fwhm_0_400 > 0:\n        b_unreg = abs(fwhm_0_400 - fwhm_0_1600) = tau_rel * fwhm_0_400\n    else:\n        b_unreg = fwhm_0_400 == fwhm_0_1600\n\n    # Gradient-regularized case: expect True (thickness is objective)\n    if fwhm_0p01_400 > 0:\n        b_grad = abs(fwhm_0p01_400 - fwhm_0p01_1600) = tau_rel * fwhm_0p01_400\n    else:\n        b_grad = fwhm_0p01_400 == fwhm_0p01_1600\n    \n    # Final print statement in the exact required format.\n    final_output = f\"[{fwhm_0_400},{fwhm_0_1600},{fwhm_0p01_400},{fwhm_0p01_1600},{b_unreg},{b_grad}]\"\n    print(final_output)\n\ndef run_simulation(l_val, N_val):\n    \"\"\"\n    Performs a 1D simulation of adiabatic shear banding for a given set of\n    regularization length (l) and number of nodes (N).\n    \n    Returns the full-width at half-maximum (FWHM) of the final plastic strain profile.\n    \"\"\"\n    # 1. Nondimensional Parameters\n    L = 1.0\n    G = 100.0\n    gamma_dot = 1.0\n    gamma_f = 0.5\n    dt = 1e-3\n    eta = 5e-2\n    H = 0.2\n    d0 = 0.02\n    w = 0.01\n    beta = 0.9\n    rho_c = 1.0\n    a_T = 1.0\n    T0 = 0.0\n    eps_phi = 0.1\n\n    # 2. Discretization\n    dx = L / N_val\n    x = np.linspace(0, L, N_val, endpoint=False) # Periodic domain\n    t_f = gamma_f / gamma_dot\n    timesteps = int(round(t_f / dt))\n\n    # 3. State variables and initial conditions\n    gamma_p = np.zeros(N_val)\n    T = np.full(N_val, T0)\n    ebar_p = np.zeros(N_val) # Nonlocal plastic strain\n    sigma_y0 = 1.0 - d0 * np.exp(-(x - L/2.0)**2 / (2.0 * w**2))\n\n    # 4. FFT setup for Helmholtz solver\n    # Wavenumber k in radians per unit length\n    k = 2.0 * np.pi * np.fft.fftfreq(N_val, d=dx)\n    helmholtz_denom = 1.0 + (l_val * k)**2\n\n    # 5. Time-stepping loop\n    for n in range(timesteps):\n        t = (n + 1) * dt\n        gamma_total = gamma_dot * t\n\n        # Stress field\n        tau = G * (gamma_total - gamma_p)\n\n        # Thermal softening factor\n        phi = np.maximum(1.0 - a_T * (T - T0), eps_phi)\n\n        # Flow strength\n        g = (sigma_y0 + H * ebar_p) * phi\n\n        # Plastic strain rate (assuming monotonic positive shear -> tau > 0)\n        overstress = tau - g\n        gamma_p_dot = np.maximum(0.0, overstress) / eta\n\n        # Update local plastic strain\n        gamma_p += gamma_p_dot * dt\n\n        # Update temperature\n        T += (beta / rho_c) * tau * gamma_p_dot * dt\n\n        # Update nonlocal strain using spectral solver\n        if l_val > 0:\n            gamma_p_hat = np.fft.fft(gamma_p)\n            ebar_p_hat = gamma_p_hat / helmholtz_denom\n            ebar_p = np.fft.ifft(ebar_p_hat).real\n        else: # l=0, local model\n            ebar_p = gamma_p\n\n    # 6. Post-processing: Calculate FWHM\n    return calculate_fwhm(gamma_p, dx)\n\ndef calculate_fwhm(data, dx):\n    \"\"\"\n    Calculates the full-width at half-maximum (FWHM) of a 1D data array.\n    \"\"\"\n    n_points = len(data)\n    max_val = np.max(data)\n    \n    if max_val == 0:\n        return 0.0\n        \n    half_max = 0.5 * max_val\n    above_half = data >= half_max\n\n    if not np.any(above_half):\n        return 0.0\n\n    # The imperfection is centered, so the band is localized far from boundaries.\n    # No need to handle periodic wrap-around for the FWHM measurement itself.\n    # Find the contiguous region of 'True' values around the peak.\n    idx_max = np.argmax(data)\n    \n    # Search left from the peak\n    left_idx = idx_max\n    while left_idx >= 0 and above_half[left_idx]:\n        left_idx -= 1\n    \n    # Search right from the peak\n    right_idx = idx_max\n    while right_idx  n_points and above_half[right_idx]:\n        right_idx += 1\n        \n    # Number of points in the FWHM region\n    # (right_idx - 1) is the last point in the region\n    # (left_idx + 1) is the first point in the region\n    fwhm_pixels = (right_idx - 1) - (left_idx + 1) + 1\n    \n    return fwhm_pixels * dx\n\n# Execute the simulation and print results\nsolve()\n```", "answer": "[0.025,0.00625,0.0275,0.026875,False,True]", "id": "2613665"}]}