{"hands_on_practices": [{"introduction": "本练习旨在巩固大变形分析所必需的运动学基础。通过研究简单剪切这一经典案例，我们将推导速度梯度张量 $L$，并将其分解为对称部分（变形率张量 $D$）和反对称部分（自旋张量 $W$）。理解如何计算这些张量是构建任何客观应力率之前的关键第一步，因为 $D$ 通常驱动材料的本构响应，而 $W$ 则捕捉了客观应力率必须考虑的刚体旋转部分 [@problem_id:2905933]。", "problem": "在 $\\mathbb{R}^{3}$ 中，一个均匀连续体的变形由简单剪切运动 $\\boldsymbol{x}(\\boldsymbol{X},t)=\\boldsymbol{X}+\\gamma(t)\\,X_{2}\\,\\boldsymbol{e}_{1}$ 指定，其中 $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ 是一个固定的标准正交基，$X_{2}$ 是物质点 $\\boldsymbol{X}$ 的第二个分量，$\\gamma(t)$ 是关于时间 $t$ 的连续可微标量函数。仅使用速度、速度梯度、对称变形率和自旋的基本运动学定义，完成以下任务：\n\n- 推导与此运动相关的空间速度梯度张量 $\\boldsymbol{L}(\\boldsymbol{x},t)$、变形率张量 $\\boldsymbol{D}(\\boldsymbol{x},t)$ 和自旋张量 $\\boldsymbol{W}(\\boldsymbol{x},t)$。\n- 指出 $\\boldsymbol{L}$、$\\boldsymbol{D}$ 和 $\\boldsymbol{W}$ 各自是对称的、反对称的，还是两者皆非，并用 $\\gamma(t)$ 描述它们在一般情况以及在 $\\dot{\\gamma}$ 为常数和 $\\dot{\\gamma}=0$ 的特殊情况下的时间依赖性。\n- 作为一个与客观应力率相关的标量诊断量，计算 $\\boldsymbol{D}$ 的偏量部分的第二不变量，其定义为 $J_{2}(\\boldsymbol{D})=\\tfrac{1}{2}\\,\\boldsymbol{D}^{\\prime}:\\boldsymbol{D}^{\\prime}$，其中 $\\boldsymbol{D}^{\\prime}=\\boldsymbol{D}-\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I}$，并用 $\\dot{\\gamma}(t)$ 完全表示你的最终结果。\n\n仅报告 $J_{2}(\\boldsymbol{D})$ 的表达式作为你的最终答案。最终表达式中无需指明单位，也无需进行数值计算。", "solution": "对所提出的问题陈述进行了严格的验证。\n\n**步骤1：提取已知条件**\n- 变形映射：$\\boldsymbol{x}(\\boldsymbol{X},t)=\\boldsymbol{X}+\\gamma(t)\\,X_{2}\\,\\boldsymbol{e}_{1}$，其中 $\\boldsymbol{x}$ 是空间位置，$\\boldsymbol{X}$ 是物质位置，$t$ 是时间。\n- 标准正交基：$\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$。\n- 物质坐标分量：$X_{2}$ 是 $\\boldsymbol{X}$ 的第二个分量。\n- 时间依赖函数：$\\gamma(t)$ 是关于时间的连续可微标量函数。\n- 要求推导的量：空间速度梯度张量 $\\boldsymbol{L}(\\boldsymbol{x},t)$、变形率张量 $\\boldsymbol{D}(\\boldsymbol{x},t)$ 和自旋张量 $\\boldsymbol{W}(\\boldsymbol{x},t)$。\n- 要求分析的内容：$\\boldsymbol{L}$、$\\boldsymbol{D}$ 和 $\\boldsymbol{W}$ 的对称性和时间依赖性。\n- 要求计算的量：$\\boldsymbol{D}$ 的偏量部分的第二不变量，$J_{2}(\\boldsymbol{D})=\\frac{1}{2}\\,\\boldsymbol{D}^{\\prime}:\\boldsymbol{D}^{\\prime}$，其中 $\\boldsymbol{D}^{\\prime}=\\boldsymbol{D}-\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于连续介质力学的基本原理。所指定的运动，即简单剪切，是用于研究材料行为的一个典型例子。所提供的所有定义（$\\boldsymbol{L}$、$\\boldsymbol{D}$、$\\boldsymbol{W}$、$J_{2}$）都是该领域的标准定义。\n- **适定性：** 该问题是适定的。变形被明确定义，任务包括直接应用已建立的运动学定义。存在唯一且有意义的解。\n- **客观性：** 该问题使用精确、客观的数学语言陈述，没有任何主观性或歧义。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。这是连续介质运动学中一个标准的、表述清晰的练习题。将推导求解。\n\n求解过程遵循所提供的定义。\n\n首先，我们确定速度场。物质速度 $\\boldsymbol{v}$ 是位置矢量 $\\boldsymbol{x}$ 对时间的物质导数，同时保持物质坐标 $\\boldsymbol{X}$ 不变。\n$$\n\\boldsymbol{v}(\\boldsymbol{X}, t) = \\frac{\\partial \\boldsymbol{x}(\\boldsymbol{X}, t)}{\\partial t}\\bigg|_{\\boldsymbol{X}} = \\frac{\\partial}{\\partial t} \\left(\\boldsymbol{X} + \\gamma(t) X_{2} \\boldsymbol{e}_{1}\\right) = \\dot{\\gamma}(t) X_{2} \\boldsymbol{e}_{1}\n$$\n其中 $\\dot{\\gamma}(t) = \\frac{d\\gamma}{dt}$。\n\n接下来，我们必须用空间坐标 $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3})$ 来表示速度场。运动的分量是：\n$x_{1} = X_{1} + \\gamma(t)X_{2}$\n$x_{2} = X_{2}$\n$x_{3} = X_{3}$\n由此，我们找到逆映射 $\\boldsymbol{X}(\\boldsymbol{x},t)$，它给出 $X_{2} = x_{2}$。将此代入速度表达式，得到空间速度场 $\\boldsymbol{v}(\\boldsymbol{x},t)$：\n$$\n\\boldsymbol{v}(\\boldsymbol{x},t) = \\dot{\\gamma}(t) x_{2} \\boldsymbol{e}_{1}\n$$\n速度矢量的分量是 $v_{1} = \\dot{\\gamma}(t)x_{2}$、$v_{2} = 0$ 和 $v_{3} = 0$。\n\n空间速度梯度张量 $\\boldsymbol{L}$ 定义为 $\\boldsymbol{L} = \\operatorname{grad}(\\boldsymbol{v})$，其分量为 $L_{ij} = \\frac{\\partial v_{i}}{\\partial x_{j}}$。\n唯一非零的分量是：\n$$\nL_{12} = \\frac{\\partial v_{1}}{\\partial x_{2}} = \\frac{\\partial}{\\partial x_{2}}(\\dot{\\gamma}(t)x_{2}) = \\dot{\\gamma}(t)\n$$\n所有其他分量 $L_{ij}$ 均为零。在关于基 $\\{\\boldsymbol{e}_{1}, \\boldsymbol{e}_{2}, \\boldsymbol{e}_{3}\\}$ 的矩阵表示中，速度梯度为：\n$$\n[\\boldsymbol{L}] = \\begin{pmatrix} 0 & \\dot{\\gamma}(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n在张量表示法中，$\\boldsymbol{L} = \\dot{\\gamma}(t) \\boldsymbol{e}_{1} \\otimes \\boldsymbol{e}_{2}$。\n\n变形率张量 $\\boldsymbol{D}$ 是 $\\boldsymbol{L}$ 的对称部分，定义为 $\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{T})$。\n$$\n[\\boldsymbol{D}] = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & \\dot{\\gamma}(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\dot{\\gamma}(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right] = \\begin{pmatrix} 0 & \\frac{1}{2}\\dot{\\gamma}(t) & 0 \\\\ \\frac{1}{2}\\dot{\\gamma}(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n在张量表示法中，$\\boldsymbol{D} = \\frac{1}{2}\\dot{\\gamma}(t)(\\boldsymbol{e}_{1} \\otimes \\boldsymbol{e}_{2} + \\boldsymbol{e}_{2} \\otimes \\boldsymbol{e}_{1})$。\n\n自旋张量 $\\boldsymbol{W}$ 是 $\\boldsymbol{L}$ 的反对称部分，定义为 $\\boldsymbol{W} = \\frac{1}{2}(\\boldsymbol{L} - \\boldsymbol{L}^{T})$。\n$$\n[\\boldsymbol{W}] = \\frac{1}{2} \\left[ \\begin{pmatrix} 0 & \\dot{\\gamma}(t) & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 & 0 \\\\ \\dot{\\gamma}(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right] = \\begin{pmatrix} 0 & \\frac{1}{2}\\dot{\\gamma}(t) & 0 \\\\ -\\frac{1}{2}\\dot{\\gamma}(t) & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n在张量表示法中，$\\boldsymbol{W} = \\frac{1}{2}\\dot{\\gamma}(t)(\\boldsymbol{e}_{1} \\otimes \\boldsymbol{e}_{2} - \\boldsymbol{e}_{2} \\otimes \\boldsymbol{e}_{1})$。\n\n性质分析：\n- $\\boldsymbol{L}$ 既不是对称的，也不是反对称的，除非 $\\dot{\\gamma}(t)=0$，此时 $\\boldsymbol{L}=\\boldsymbol{0}$。其分量与 $\\dot{\\gamma}(t)$ 成正比。\n- 根据定义和构造，$\\boldsymbol{D}$ 是对称的。其分量与 $\\dot{\\gamma}(t)$ 成正比。若 $\\dot{\\gamma}=0$，则 $\\boldsymbol{D}=\\boldsymbol{0}$（无变形）。若 $\\dot{\\gamma}$ 为非零常数，则 $\\boldsymbol{D}$ 是一个常张量。\n- 根据定义和构造，$\\boldsymbol{W}$ 是反对称的。其分量与 $\\dot{\\gamma}(t)$ 成正比。若 $\\dot{\\gamma}=0$，则 $\\boldsymbol{W}=\\boldsymbol{0}$（无旋转）。若 $\\dot{\\gamma}$ 为非零常数，则 $\\boldsymbol{W}$ 是一个常张量。\n\n最后，我们计算 $\\boldsymbol{D}$ 的偏量部分的第二不变量 $J_{2}(\\boldsymbol{D})$。首先，我们求出偏张量 $\\boldsymbol{D}^{\\prime} = \\boldsymbol{D} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I}$。\n$\\boldsymbol{D}$ 的迹是其对角分量之和：\n$$\n\\operatorname{tr}(\\boldsymbol{D}) = D_{11} + D_{22} + D_{33} = 0 + 0 + 0 = 0\n$$\n由于 $\\operatorname{tr}(\\boldsymbol{D})=0$，该运动是等容的（保体积的）。因此，$\\boldsymbol{D}$ 的偏量部分就是 $\\boldsymbol{D}$ 本身：\n$$\n\\boldsymbol{D}^{\\prime} = \\boldsymbol{D}\n$$\n不变量 $J_{2}(\\boldsymbol{D})$ 定义为 $J_{2}(\\boldsymbol{D}) = \\frac{1}{2}\\boldsymbol{D}^{\\prime}:\\boldsymbol{D}^{\\prime}$。代入 $\\boldsymbol{D}^{\\prime}=\\boldsymbol{D}$，我们计算：\n$$\nJ_{2}(\\boldsymbol{D}) = \\frac{1}{2}\\boldsymbol{D}:\\boldsymbol{D}\n$$\n双点积 $\\boldsymbol{D}:\\boldsymbol{D}$ 是 $\\boldsymbol{D}$ 的分量平方和：\n$$\n\\boldsymbol{D}:\\boldsymbol{D} = \\sum_{i,j=1}^{3} D_{ij}D_{ij} = (D_{12})^{2} + (D_{21})^{2} = \\left(\\frac{1}{2}\\dot{\\gamma}(t)\\right)^{2} + \\left(\\frac{1}{2}\\dot{\\gamma}(t)\\right)^{2}\n$$\n$$\n\\boldsymbol{D}:\\boldsymbol{D} = 2 \\left(\\frac{1}{4}\\dot{\\gamma}^{2}(t)\\right) = \\frac{1}{2}\\dot{\\gamma}^{2}(t)\n$$\n因此，不变量 $J_{2}(\\boldsymbol{D})$ 为：\n$$\nJ_{2}(\\boldsymbol{D}) = \\frac{1}{2} \\left( \\frac{1}{2}\\dot{\\gamma}^{2}(t) \\right) = \\frac{1}{4}\\dot{\\gamma}^{2}(t)\n$$\n此表达式仅依赖于剪切率 $\\dot{\\gamma}(t)$。", "answer": "$$\n\\boxed{\\frac{1}{4}\\dot{\\gamma}^{2}(t)}\n$$", "id": "2905933"}, {"introduction": "在掌握了运动学输入之后，本练习将探讨一个根本性的概念问题：不同的客观应力率公式是否会导出相同的物理预测？我们将通过对一个处于纯静水压力状态的材料施加任意变形，来检验这一问题，并比较使用 Jaumann、Truesdell 和 Green-Naghdi 定义计算出的应力率。这个富有启发性的思想实验突显了客观应力率的选择对本构模型行为的深远影响，特别是它如何耦合变形与应力响应 [@problem_id:2666128]。", "problem": "考虑一个经历有限变形的三维连续体，其速度场为 $\\boldsymbol{v}(\\boldsymbol{x},t)$，速度梯度为 $\\boldsymbol{L} = \\nabla \\boldsymbol{v}$。设变形梯度的极分解为 $\\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U}$，其中 $\\boldsymbol{R}(t)$ 是一个正常正交旋转，$\\boldsymbol{U}(t)$ 是右拉伸张量。用 $\\boldsymbol{D} = \\tfrac{1}{2}\\left(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}}\\right)$ 表示对称的变形率张量，用 $\\boldsymbol{W} = \\tfrac{1}{2}\\left(\\boldsymbol{L} - \\boldsymbol{L}^{\\mathsf{T}}\\right)$ 表示连续体自旋（速度梯度的斜对称部分），用 $\\boldsymbol{\\Omega} = \\dot{\\boldsymbol{R}}\\boldsymbol{R}^{\\mathsf{T}}$ 表示 Green–Naghdi 自旋（与 $\\boldsymbol{R}$ 相关的实际材料自旋）。Cauchy 应力用 $\\boldsymbol{\\sigma}(\\boldsymbol{x},t)$ 表示。\n\n在某一时刻 $t$，假设 Cauchy 应力是纯静水压力的，即 $\\boldsymbol{\\sigma}(t) = p(t)\\,\\boldsymbol{I}$，其中 $p(t)$ 是（可能随时间变化的）热力学压力，$\\boldsymbol{I}$ 是单位张量。除了标准连续体运动学所隐含的限制外，对 $\\boldsymbol{L}(t)$ 不施加任何限制。\n\n从叠加刚体运动下的标架无关性第一性原理和上述运动学定义出发（不假设任何特定的本构关系），推导并在此刻计算 $\\boldsymbol{\\sigma}$ 的以下客观应力率：\n- Jaumann 率，\n- Truesdell 率（Oldroyd 上随钻率），以及\n- Green–Naghdi 率。\n\n然后，根据得到的表达式，确定对于任意的 $\\boldsymbol{L}$，这些率中哪一个将静水压力 Cauchy 应力映射为静水压力应力率。\n\n你的最终答案必须是由三个率张量组成的三元组，按（Jaumann、Truesdell、Green–Naghdi）的顺序排列，并仅用 $p$、$\\dot{p}$、$\\boldsymbol{D}$、$\\boldsymbol{W}$、$\\operatorname{tr}(\\boldsymbol{D})$、$\\boldsymbol{\\Omega}$ 和 $\\boldsymbol{I}$ 表示。将此三元组以单行矩阵的形式给出。无需进行数值计算。不要包含单位。", "solution": "问题要求计算三种不同的客观应力率——Jaumann 率、Truesdell 率和 Green-Naghdi 率——对于一个在给定时刻是纯静水压力的 Cauchy 应力张量，即 $\\boldsymbol{\\sigma} = p\\boldsymbol{I}$。然后我们将分析这些结果，以确定对于任意速度梯度 $\\boldsymbol{L}$，哪种率能保持应力的静水压力性质。\n\nCauchy 应力张量 $\\boldsymbol{\\sigma}$ 的物质时间导数记为 $\\dot{\\boldsymbol{\\sigma}} = \\frac{D\\boldsymbol{\\sigma}}{Dt}$。鉴于 $\\boldsymbol{\\sigma}(t) = p(t)\\boldsymbol{I}$ 且单位张量 $\\boldsymbol{I}$ 在空间上是常数，其物质导数为 $\\dot{\\boldsymbol{I}} = \\boldsymbol{0}$。因此，使用乘积法则，应力张量的物质导数为：\n$$ \\dot{\\boldsymbol{\\sigma}} = \\frac{d}{dt}(p(t)\\boldsymbol{I}) = \\dot{p}(t)\\boldsymbol{I} + p(t)\\dot{\\boldsymbol{I}} = \\dot{p}\\boldsymbol{I} $$\n其中 $\\dot{p}$ 是压力 $p$ 的时间导数。\n\n三种客观应力率的一般定义如下：\n$1$. Jaumann 率，或相对于连续体自旋 $\\boldsymbol{W}$ 的共旋率：\n$$ \\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{W}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{W} $$\n$2$. Truesdell 率。问题陈述中的“Truesdell (Oldroyd upper-convected) rate”一词可能存在歧义。标准的上随钻 Oldroyd 率是 $\\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{L}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{L}^{\\mathsf{T}}$。Truesdell 率增加了一个与变形率的迹 $\\operatorname{tr}(\\boldsymbol{D})$ 成正比的项。在允许的变量列表中包含 $\\operatorname{tr}(\\boldsymbol{D})$ 表明意指的是完整的 Truesdell 率。我们将采用这个更完整的定义：\n$$ \\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{L}\\boldsymbol{\\sigma} - \\boldsymbol{\\sigma}\\boldsymbol{L}^{\\mathsf{T}} + \\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{\\sigma} $$\n$3$. Green-Naghdi 率，或相对于材料自旋 $\\boldsymbol{\\Omega}$ 的共旋率：\n$$ \\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{\\boldsymbol{\\sigma}} - \\boldsymbol{\\Omega}\\boldsymbol{\\sigma} + \\boldsymbol{\\sigma}\\boldsymbol{\\Omega} $$\n\n我们现在在条件 $\\boldsymbol{\\sigma} = p\\boldsymbol{I}$ 下计算每个率。\n\n**Jaumann 率的计算：**\n将 $\\boldsymbol{\\sigma} = p\\boldsymbol{I}$ 和 $\\dot{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I}$ 代入 Jaumann 率的定义：\n$$ \\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - \\boldsymbol{W}(p\\boldsymbol{I}) + (p\\boldsymbol{I})\\boldsymbol{W} $$\n由于标量乘法和与单位张量的张量乘法是可交换的，我们有：\n$$ \\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - p\\boldsymbol{W} + p\\boldsymbol{W} = \\dot{p}\\boldsymbol{I} $$\n\n**Truesdell 率的计算：**\n将 $\\boldsymbol{\\sigma} = p\\boldsymbol{I}$ 和 $\\dot{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I}$ 代入 Truesdell 率的定义：\n$$ \\overset{\\triangle}{\\boldsymbol{\\sigma}} = (\\dot{p}\\boldsymbol{I}) - \\boldsymbol{L}(p\\boldsymbol{I}) - (p\\boldsymbol{I})\\boldsymbol{L}^{\\mathsf{T}} + \\operatorname{tr}(\\boldsymbol{D})(p\\boldsymbol{I}) $$\n$$ \\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - p\\boldsymbol{L} - p\\boldsymbol{L}^{\\mathsf{T}} + p\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I} $$\n回顾变形率张量为 $\\boldsymbol{D} = \\frac{1}{2}(\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}})$，可得 $\\boldsymbol{L} + \\boldsymbol{L}^{\\mathsf{T}} = 2\\boldsymbol{D}$。将此代入表达式中得到：\n$$ \\overset{\\triangle}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - 2p\\boldsymbol{D} + p\\operatorname{tr}(\\boldsymbol{D})\\boldsymbol{I} $$\n这可以重排为：\n$$ \\overset{\\triangle}{\\boldsymbol{\\sigma}} = (\\dot{p} + p\\operatorname{tr}(\\boldsymbol{D}))\\boldsymbol{I} - 2p\\boldsymbol{D} $$\n\n**Green-Naghdi 率的计算：**\n将 $\\boldsymbol{\\sigma} = p\\boldsymbol{I}$ 和 $\\dot{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I}$ 代入 Green-Naghdi 率的定义：\n$$ \\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - \\boldsymbol{\\Omega}(p\\boldsymbol{I}) + (p\\boldsymbol{I})\\boldsymbol{\\Omega} $$\n材料自旋 $\\boldsymbol{\\Omega}$ 是一个斜对称张量。与 Jaumann 率的计算类似：\n$$ \\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I} - p\\boldsymbol{\\Omega} + p\\boldsymbol{\\Omega} = \\dot{p}\\boldsymbol{I} $$\n\n**对应力率结果的分析：**\n如果一个应力率张量是单位张量的标量倍数，即形式为 $k\\boldsymbol{I}$（其中 $k$ 为标量），则认为它是静水压力的。我们检查上面推导出的表达式。\n\n- Jaumann 率为 $\\overset{\\triangledown}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I}$。这是一个标量（$\\dot{p}$）乘以单位张量 $\\boldsymbol{I}$。因此，它总是静水压力的。\n\n- Green-Naghdi 率为 $\\overset{\\square}{\\boldsymbol{\\sigma}} = \\dot{p}\\boldsymbol{I}$。这也是单位张量的标量倍数，因此总是静水压力的。\n\n- Truesdell 率为 $\\overset{\\triangle}{\\boldsymbol{\\sigma}} = (\\dot{p} + p\\operatorname{tr}(\\boldsymbol{D}))\\boldsymbol{I} - 2p\\boldsymbol{D}$。该率是静水压力的，当且仅当项 $-2p\\boldsymbol{D}$ 与单位张量成比例。这将要求 $\\boldsymbol{D}$ 本身是一个球张量，即 $\\boldsymbol{D} = k\\boldsymbol{I}$（其中 $k$ 为某个标量）。然而，问题指明速度梯度 $\\boldsymbol{L}$ 是任意的。任意的 $\\boldsymbol{L}$ 会导致任意的变形率张量 $\\boldsymbol{D}$，而 $\\boldsymbol{D}$ 通常不是球张量。例如，任何涉及剪切变形的运动（如简单剪切流）都将导致非球形的 $\\boldsymbol{D}$。\n\n因此，对于任意运动，只有 Jaumann 率和 Green-Naghdi 率将静水压力 Cauchy 应力映射为静水压力应力率。Truesdell 率则不然，因为它的值取决于变形率张量 $\\boldsymbol{D}$ 的非静水压力部分。\n\n三个计算出的应力率，按要求的顺序（Jaumann、Truesdell、Green-Naghdi）排列为：\n$(\\dot{p}\\boldsymbol{I}, \\quad (\\dot{p} + p\\operatorname{tr}(\\boldsymbol{D}))\\boldsymbol{I} - 2p\\boldsymbol{D}, \\quad \\dot{p}\\boldsymbol{I})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\dot{p}\\boldsymbol{I} & (\\dot{p} + p\\operatorname{tr}(\\boldsymbol{D}))\\boldsymbol{I} - 2p\\boldsymbol{D} & \\dot{p}\\boldsymbol{I}\n\\end{pmatrix}\n}\n$$", "id": "2666128"}, {"introduction": "最后的这项练习将从解析推导过渡到计算实现，这是现代工程分析的一项关键技能。你将为使用 Green-Naghdi 率更新柯西应力的过程开发一个稳健的数值算法，这是一种在有限元软件中广泛应用的同旋方法。通过将连续介质理论转化为离散的、分步的程序，并针对具体案例进行测试，你将对框架无关的本构模型如何在模拟中得以实现获得实践性的理解 [@problem_id:2666098]。", "problem": "考虑一个三维连续体，其变形梯度为 $F(t) \\in \\mathbb{R}^{3 \\times 3}$，允许进行极分解 $F(t) = R(t) U(t)$，其中 $R(t) \\in \\mathrm{SO}(3)$ 是真正常交旋转，$U(t)$ 是右拉伸。令柯西应力为 $\\sigma(t) \\in \\mathbb{R}^{3 \\times 3}$，并定义空间速度梯度 $L(t) = \\dot{F}(t) F(t)^{-1}$，其对称部分为 $D(t) = \\tfrac{1}{2}(L(t) + L(t)^{T})$。Green–Naghdi 协同旋转自旋定义为 $\\Omega(t) = \\dot{R}(t) R(t)^{T}$，该张量是反对称的，对于各向同性次弹性固体，柯西应力的 Green–Naghdi 客观率满足：\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\dot{\\sigma}(t) + \\sigma(t) \\, \\Omega(t) - \\Omega(t) \\, \\sigma(t) = \\lambda \\, \\text{tr}\\big(D(t)\\big) I + 2 \\mu \\, D(t),\n$$\n其中 $\\lambda$ 和 $\\mu$ 是拉梅参数，$I$ 是单位矩阵，$\\text{tr}(\\cdot)$ 是迹。拉梅参数与杨氏模量 $E$ 和泊松比 $\\nu$ 的关系为 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$。\n\n您的任务是，从第一性原理出发，推导一个在时间步 $[t_n, t_{n+1}]$（时长为 $\\Delta t = t_{n+1} - t_{n}$）内的算法应力更新方法，该方法需要：\n- 使用极分解从中间点变形梯度 $F_{n+\\frac{1}{2}}$ 中提取中间点旋转 $R_{n+\\frac{1}{2}}$，并且\n- 将中间点的 Green–Naghdi 自旋计算为 $\\Omega_{n+\\frac{1}{2}} = \\dot{R} R^{T}$ 在中间点的近似值。您必须仅使用 $F_n$、$F_{n+1}$ 和 $F_{n+\\frac{1}{2}}$，不得使用任何角度参数化；用于测试构建的角度以弧度为单位。\n- 对于线性各向同性次弹性固体，通过在协同旋转坐标系中进行计算，使用与标架无关性一致的中点格式，将柯西应力从 $\\sigma_{n} = \\sigma(t_n)$ 更新至 $\\sigma_{n+1} = \\sigma(t_{n+1})$。\n\n您必须从上述定义和 $F(t)$ 运动学出发，系统地推导出一个在刚体运动下客观正确的中点算法。请提出一个由 $F_n$、$F_{n+1}$ 和 $F_{n+\\frac{1}{2}}$ 计算 $L_{n+\\frac{1}{2}}$ 的离散近似，以及一个由 $R_n$、$R_{n+1}$ 和 $R_{n+\\frac{1}{2}}$ 计算 $\\Omega_{n+\\frac{1}{2}}$ 的离散近似。请阐明您如何将应力和应变率映射到协同旋转坐标系以消除本构更新中的自旋，以及如何将其映射回 $t_{n+1}$ 时刻的空间坐标系。\n\n将您推导的算法实现为一个程序，为下述每个测试用例计算所需的输出。所有物理量必须使用指定单位处理。角度必须以弧度处理。除非另有说明，矩阵均为 $3 \\times 3$。所有输出必须以帕斯卡（Pascals）为单位表示（适用于应力分量或范数），并四舍五入到六位小数。最终程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表。\n\n请使用以下测试套件。对于每个用例，给定 $E$（单位：帕斯卡）、$\\nu$（无量纲）、$\\Delta t$（单位：秒）、$F_n$、$F_{n+1}$ 和 $\\sigma_n$（单位：帕斯卡）。将中间点变形梯度定义为 $F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$，并用它来提取 $R_{n+\\frac{1}{2}}$。对于每个用例，计算指定的标量输出：\n\n- A用例（刚性旋转客观性检查；角度单位为弧度）：令 $E = 200 \\times 10^{9}$，$\\nu = 0.30$，$\\Delta t = 0.02$。取 $F_n = I$， $F_{n+1} = R_z(\\theta)$，其中 $\\theta = \\dfrac{\\pi}{18}$，$R_z(\\theta)$ 是绕 $z$ 轴旋转 $\\theta$ 的旋转矩阵。令\n$$\n\\sigma_n = \\begin{bmatrix}\n100 \\times 10^{6} & 20 \\times 10^{6} & 0\\\\\n20 \\times 10^{6} & 50 \\times 10^{6} & 0\\\\\n0 & 0 & 10 \\times 10^{6}\n\\end{bmatrix}.\n$$\n用您的 Green–Naghdi 更新计算 $\\sigma_{n+1}$，并输出 $\\sigma_{n+1}$ 与 $\\sigma_n$ 在该步长内精确刚性旋转结果之间差值的弗罗贝尼乌斯范数，即 $\\left\\| \\sigma_{n+1} - Q \\, \\sigma_n \\, Q^{T} \\right\\|_F$，其中 $Q = R_{n+1} R_n^{T}$。以帕斯卡为单位输出这个浮点数，四舍五入到六位小数。\n\n- B用例（单轴拉伸，无旋转）：令 $E = 200 \\times 10^{9}$，$\\nu = 0.30$，$\\Delta t = 1.0$。取 $F_n = I$，$F_{n+1} = \\mathrm{diag}(1.01, 1, 1)$，且 $\\sigma_n = 0$。计算 $\\sigma_{n+1}$ 并以帕斯卡为单位输出 $\\sigma_{11}$ 的值，四舍五入到六位小数。\n\n- C用例（旋转与拉伸的组合）：令 $E = 100 \\times 10^{9}$，$\\nu = 0.25$，$\\Delta t = 0.1$。取 $F_n = I$，$F_{n+1} = R_z(\\vartheta) \\, \\mathrm{diag}(1.02, 0.99, 1)$，其中 $\\vartheta = 0.25$，且 $\\sigma_n = 0$。计算 $\\sigma_{n+1}$ 并以帕斯卡为单位输出 $\\mathrm{tr}(\\sigma_{n+1})$ 的值，四舍五入到六位小数。\n\n- D用例（近不可压缩简单剪切）：令 $E = 1.0 \\times 10^{6}$，$\\nu = 0.499$，$\\Delta t = 1.0$。取 $F_n = I$，$F_{n+1} = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix}$，其中 $\\gamma = 0.02$，且 $\\sigma_n = 0$。计算 $\\sigma_{n+1}$ 并以帕斯卡为单位输出 $\\sigma_{12}$ 的值，四舍五入到六位小数。\n\n实现约束和输出格式：\n- 角度必须以弧度处理。\n- 使用 $L_{n+\\frac{1}{2}} \\approx \\big(F_{n+1} - F_n\\big) F_{n+\\frac{1}{2}}^{-1} / \\Delta t$ 和 $D_{n+\\frac{1}{2}} = \\tfrac{1}{2}(L_{n+\\frac{1}{2}} + L_{n+\\frac{1}{2}}^{T})$。\n- 分别从 $F_n$、$F_{n+\\frac{1}{2}}$ 和 $F_{n+1}$ 的极分解中提取 $R_n$、$R_{n+\\frac{1}{2}}$ 和 $R_{n+1}$，使用 $R = F \\, (F^{T} F)^{-1/2}$，其中涉及正定逆平方根。\n- 计算 $\\Omega_{n+\\frac{1}{2}} \\approx \\big(R_{n+1} - R_n\\big) R_{n+\\frac{1}{2}}^{T} / \\Delta t$。\n- 在一个与 Green–Naghdi 率一致的协同旋转坐标系中更新时间步上的 $\\sigma$，并映射回 $t_{n+1}$ 时刻的空间构型。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，$[\\text{resultA},\\text{resultB},\\text{resultC},\\text{resultD}]$），每个结果以帕斯卡为单位，四舍五入到六位小数。", "solution": "在尝试提供解决方案之前，需对问题陈述进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n\n问题提供了以下定义和数据：\n- **运动学**：变形梯度 $F(t) \\in \\mathbb{R}^{3 \\times 3}$，其极分解为 $F(t) = R(t) U(t)$。其中 $R(t) \\in \\mathrm{SO}(3)$ 是旋转，$U(t)$ 是右拉伸。\n- **速度梯度**：空间速度梯度为 $L(t) = \\dot{F}(t) F(t)^{-1}$，其对称部分为 $D(t) = \\tfrac{1}{2}(L(t) + L(t)^{T})$。\n- **应力与应力率**：柯西应力为 $\\sigma(t)$。Green–Naghdi 客观应力率定义为：\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\dot{\\sigma}(t) + \\sigma(t) \\, \\Omega(t) - \\Omega(t) \\, \\sigma(t)\n$$\n其中协同旋转自旋为 $\\Omega(t) = \\dot{R}(t) R(t)^{T}$。\n- **本构定律**：对于各向同性次弹性固体：\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\lambda \\, \\text{tr}\\big(D(t)\\big) I + 2 \\mu \\, D(t)\n$$\n其中 $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$ 和 $\\mu = \\dfrac{E}{2(1+\\nu)}$ 是拉梅参数，$I$ 是单位矩阵。\n- **数值格式近似**：\n    - 中间点变形梯度：$F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$。\n    - 旋转提取：$R = F \\, (F^{T} F)^{-1/2}$。\n    - 中间点速度梯度：$L_{n+\\frac{1}{2}} \\approx \\big(F_{n+1} - F_n\\big) F_{n+\\frac{1}{2}}^{-1} / \\Delta t$。\n    - 中间点自旋：$\\Omega_{n+\\frac{1}{2}} \\approx \\big(R_{n+1} - R_n\\big) R_{n+\\frac{1}{2}}^{T} / \\Delta t$。注意，问题中的印刷错误 $\\Omega_{n+\\frac{1}{1}}$ 被解释为 $\\Omega_{n+\\frac{1}{2}}$。\n- **测试用例**：提供了四个具体的测试用例（A、B、C、D），包括所有必要的材料参数（$E$、$\\nu$）、时间步长（$\\Delta t$）、初始和最终变形梯度（$F_n$、$F_{n+1}$）以及初始柯西应力（$\\sigma_n$）。对每个用例都要求了特定的标量输出。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n- **科学上合理（关键）**：该问题植根于连续介质力学的基本原理，特别是次弹性材料的客观应力率理论。Green-Naghdi 率、极分解以及相关的本构模型是固体力学文献中标准且成熟的概念。该问题没有科学错误。\n- **适定的**：问题是适定的。它要求为给定的微分方程推导并实现一个特定的数值算法。所有必要的边界条件（在时间上，即初始状态）和运动学驱动（$F(t)$）都已提供。所需的数值近似被明确说明，这确保了遵循唯一的程序。\n- **客观的（关键）**：问题以精确的数学和物理语言表述，没有任何主观性或模糊性。\n- **不完整或矛盾的设置**：设置是完整的。对于每个测试用例，都提供了所有必需的输入数据。定义或要求中没有矛盾之处。\n- **不切实际或不可行**：所描述的材料属性和变形场景是学术和工程问题中的标准情况。这些值在物理上是合理的。\n- **伪深刻、琐碎、同义反复**：这是一个有实质内容的问题。它要求正确推导一个客观的应力积分算法，这在计算力学中是一项非凡的任务，并且需要仔细实现。\n\n#### 步骤3：结论与行动\n\n该问题是有效的。它是一个在计算固体力学领域中定义明确的问题，科学上合理、客观且内部一致。将提供解决方案。\n\n### 应力更新算法的推导\n\n目标是推导一个数值算法，用以将时间 $t_n$ 的柯西应力张量 $\\sigma_n$ 更新至时间 $t_{n+1} = t_n + \\Delta t$ 的 $\\sigma_{n+1}$。该算法必须是客观的，意味着在叠加刚体运动下，它必须产生正确变换的结果。这通过在协同旋转坐标系中进行计算来实现。\n\n控制本构关系为：\n$$\n\\overset{\\text{GN}}{\\sigma}(t) = \\dot{\\sigma}(t) + \\sigma(t) \\, \\Omega(t) - \\Omega(t) \\, \\sigma(t) = \\lambda \\, \\text{tr}\\big(D(t)\\big) I + 2 \\mu \\, D(t)\n$$\n表达式 $\\dot{\\sigma} + \\sigma \\Omega - \\Omega \\sigma$ 是 $\\sigma$ 关于速度场的李导数，其中使用了自旋 $\\Omega$。这通常写为 $\\dot{\\sigma} - [\\Omega, \\sigma]$。这种形式的应力率是客观的。\n\n协同旋转方法的核心思想是在一个随材料旋转的坐标系中执行本构更新，从而消除方程中的自旋项 $\\Omega$。我们通过使用 $R(t)^T$ 将柯西应力 $\\sigma(t)$ 旋转回一个固定的参考取向，来定义一个协同旋转应力张量 $\\sigma^R(t)$：\n$$\n\\sigma^R(t) = R(t)^T \\sigma(t) R(t)\n$$\n我们计算其物质时间导数：\n$$\n\\dot{\\sigma}^R = \\dot{R}^T \\sigma R + R^T \\dot{\\sigma} R + R^T \\sigma \\dot{R}\n$$\n使用定义 $\\Omega = \\dot{R} R^T$。属性 $R^T R = I$ 意味着 $\\dot{R}^T R + R^T \\dot{R} = 0$，所以 $\\dot{R}^T = -R^T \\dot{R} R^T = -R^T (\\Omega R) R^T = -R^T \\Omega$。代入导数中：\n$$\n\\dot{\\sigma}^R = (-R^T \\Omega) \\sigma R + R^T \\dot{\\sigma} R + R^T \\sigma (\\Omega R) = R^T \\left( \\dot{\\sigma} - \\Omega \\sigma + \\sigma \\Omega \\right) R\n$$\n问题陈述给出的 Green-Naghdi 率为 $\\overset{\\text{GN}}{\\sigma} = \\dot{\\sigma} + \\sigma \\Omega - \\Omega \\sigma$。我们的推导是 $\\dot{\\sigma}^R = R^T(\\dot{\\sigma} - \\Omega\\sigma + \\sigma\\Omega)R$。与问题定义相反，但这才是与 $\\sigma^R$ 定义一致的标准结果。然而，为了与问题定义一致，我们必须使用 $\\dot{\\sigma}^R = R^T(\\dot{\\sigma} + \\sigma \\Omega - \\Omega\\sigma)R$。\n\n将此代入本构方程得到：\n$$\nR \\dot{\\sigma}^R R^T = \\lambda \\, \\text{tr}(D) I + 2\\mu D\n$$\n从左边乘以 $R^T$，从右边乘以 $R$，并利用 $R^T R = I$，我们得到：\n$$\n\\dot{\\sigma}^R = R^T (\\lambda \\, \\text{tr}(D) I + 2\\mu D) R = \\lambda \\, \\text{tr}(D) (R^T I R) + 2\\mu (R^T D R)\n$$\n由于 $\\text{tr}(D) = \\text{tr}(R^T D R)$ 且 $R^T I R = I$，如果我们定义一个协同旋转变形率张量 $D^R = R^T D R$，方程可简化为：\n$$\n\\dot{\\sigma}^R(t) = \\lambda \\, \\text{tr}\\big(D^R(t)\\big) I + 2\\mu D^R(t)\n$$\n这是一个不含自旋项的常微分方程。我们可以使用中点法则在时间步 $[t_n, t_{n+1}]$ 上对其进行积分：\n$$\n\\sigma^R(t_{n+1}) - \\sigma^R(t_n) \\approx \\Delta t \\left[ \\lambda \\, \\text{tr}\\big(D^R_{n+\\frac{1}{2}}\\big) I + 2\\mu D^R_{n+\\frac{1}{2}} \\right]\n$$\n其中带下标 $n+\\frac{1}{2}$ 的量是在区间中点处评估的。我们称右侧为 $\\Delta \\sigma^R$。\n我们将协同旋转应力与柯西应力关联起来：$\\sigma^R_n = R_n^T \\sigma_n R_n$ 和 $\\sigma^R_{n+1} = R_{n+1}^T \\sigma_{n+1} R_{n+1}$。\n将这些代入积分后的方程：\n$$\nR_{n+1}^T \\sigma_{n+1} R_{n+1} \\approx R_n^T \\sigma_n R_n + \\Delta \\sigma^R\n$$\n求解 $\\sigma_{n+1}$，我们得到最终的更新公式：\n$$\n\\sigma_{n+1} = R_{n+1} \\left( R_n^T \\sigma_n R_n + \\Delta \\sigma^R \\right) R_{n+1}^T\n$$\n这个公式是客观的，因为它正确地将初始应力从构型 $n$ 旋转到 $n+1$，并加上在协同旋转坐标系中计算的材料响应。\n\n算法流程如下：\n1.  **材料属性**：根据给定的 $E$ 和 $\\nu$，计算拉梅参数 $\\lambda$ 和 $\\mu$。\n2.  **运动学**：\n    a. 给定 $F_n$ 和 $F_{n+1}$，计算中间点变形梯度 $F_{n+\\frac{1}{2}} = \\tfrac{1}{2}(F_n + F_{n+1})$。\n    b. 对 $F_n$、$F_{n+1}$ 和 $F_{n+\\frac{1}{2}}$ 进行极分解 $F = RU$ 以获得旋转张量 $R_n$、$R_{n+1}$ 和 $R_{n+\\frac{1}{2}}$。分解使用 $R = F (F^T F)^{-1/2}$ 进行，这需要计算右柯西-格林张量 $C=F^T F$ 的逆矩阵平方根。\n    c. 计算中间点空间速度梯度 $L_{n+\\frac{1}{2}} = \\frac{1}{\\Delta t} (F_{n+1} - F_n) F_{n+\\frac{1}{2}}^{-1}$。\n    d. 对称化得到变形率张量：$D_{n+\\frac{1}{2}} = \\tfrac{1}{2}(L_{n+\\frac{1}{2}} + L_{n+\\frac{1}{2}}^T)$。\n3.  **本构更新**：\n    a. 将变形率转换到由中间点旋转定义的协同旋转坐标系：$D^R_{n+\\frac{1}{2}} = R_{n+\\frac{1}{2}}^T D_{n+\\frac{1}{2}} R_{n+\\frac{1}{2}}$。\n    b. 计算协同旋转应力增量。利用属性 $\\text{tr}(D^R_{n+\\frac{1}{2}}) = \\text{tr}(D_{n+\\frac{1}{2}})$：\n    $$\n    \\Delta \\sigma^R = \\Delta t \\left( \\lambda \\, \\text{tr}(D_{n+\\frac{1}{2}}) I + 2\\mu D^R_{n+\\frac{1}{2}} \\right)\n    $$\n4.  **应力更新与映射**：\n    a. 使用推导出的更新公式计算最终应力 $\\sigma_{n+1}$：\n    $$\n    \\sigma_{n+1} = R_{n+1} \\left( R_n^T \\sigma_n R_n + \\Delta \\sigma^R \\right) R_{n+1}^T\n    $$\n该算法通过 $R_n^T(...)R_n$ 将初始应力张量 $\\sigma_n$ 映射到材料坐标系，加上在随材料旋转的坐标系中计算的因变形引起的应力增量，最后通过 $R_{n+1}(...)R_{n+1}^T$ 将结果映射回 $t_{n+1}$ 时刻的空间构型。\n\n问题还要求计算中点 Green-Naghdi 自旋 $\\Omega_{n+\\frac{1}{2}}$。提供了一个一致的离散近似：\n$$\n\\Omega_{n+\\frac{1}{2}} \\approx \\frac{1}{\\Delta t} (R_{n+1} - R_n) R_{n+\\frac{1}{2}}^{T}\n$$\n这个量并未在应力更新算法中显式使用，因为协同旋转公式专门设计用于在数值积分中绕过对显式自旋张量的需求。这是该方法的一个主要优点。实现将遵循推导的算法。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import sqrtm, inv, norm\n\ndef solve():\n    \"\"\"\n    Solves the problem by implementing the derived Green-Naghdi stress update algorithm\n    for the four given test cases.\n    \"\"\"\n\n    def get_lame_params(E, nu):\n        \"\"\"Computes Lamé parameters lambda and mu from Young's modulus and Poisson's ratio.\"\"\"\n        lam = (E * nu) / ((1 + nu) * (1 - 2 * nu))\n        mu = E / (2 * (1 + nu))\n        return lam, mu\n\n    def polar_decomposition(F):\n        \"\"\"\n        Performs polar decomposition F = RU using the specified method R = F * (F^T F)^(-1/2).\n        Returns the rotation matrix R.\n        \"\"\"\n        # Ensure F is a float matrix to avoid issues with integer arrays in sqrtm\n        F = np.asarray(F, dtype=float)\n        C = F.T @ F  # Right Cauchy-Green tensor\n        # U = sqrtm(C), so U_inv = inv(sqrtm(C))\n        U_inv = inv(sqrtm(C))\n        R = F @ U_inv\n        return R\n\n    def compute_stress_update(E, nu, dt, F_n, F_np1, sigma_n):\n        \"\"\"\n        Implements the derived corotational stress update algorithm for a single time step.\n        \"\"\"\n        # 1. Material Properties\n        lam, mu = get_lame_params(E, nu)\n\n        # 2. Kinematics\n        F_mid = 0.5 * (F_n + F_np1)\n\n        R_n = polar_decomposition(F_n)\n        R_np1 = polar_decomposition(F_np1)\n        R_mid = polar_decomposition(F_mid)\n\n        # Midpoint velocity gradient L and rate of deformation D\n        F_mid_inv = inv(F_mid)\n        L_mid = (F_np1 - F_n) @ F_mid_inv / dt\n        D_mid = 0.5 * (L_mid + L_mid.T)\n\n        # 3. Constitutive Update in Corotational Frame\n        # The rotation to the corotational frame uses the midpoint rotation R_mid\n        D_r_mid = R_mid.T @ D_mid @ R_mid\n        trace_D = np.trace(D_mid) # trace is invariant under rotation\n        \n        delta_sigma_r = dt * (lam * trace_D * np.eye(3) + 2 * mu * D_r_mid)\n\n        # 4. Stress Update and Mapping\n        # Rotate sigma_n to corotational frame at t_n\n        sigma_r_n = R_n.T @ sigma_n @ R_n\n        # Add the increment\n        sigma_r_np1 = sigma_r_n + delta_sigma_r\n        # Rotate the new corotational stress to the spatial frame at t_n+1\n        sigma_np1 = R_np1 @ sigma_r_np1 @ R_np1.T\n\n        return sigma_np1\n        \n    # --- Test Cases ---\n\n    # Case A: Rigid rotation objectivity check\n    E_A = 200e9\n    nu_A = 0.30\n    dt_A = 0.02\n    theta_A = np.pi / 18.0\n    c, s = np.cos(theta_A), np.sin(theta_A)\n    F_n_A = np.eye(3)\n    F_np1_A = np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n    sigma_n_A = np.array([\n        [100e6, 20e6, 0],\n        [20e6, 50e6, 0],\n        [0, 0, 10e6]\n    ])\n    \n    sigma_np1_A_computed = compute_stress_update(E_A, nu_A, dt_A, F_n_A, F_np1_A, sigma_n_A)\n    \n    # Exact rotation for comparison\n    R_n_A = polar_decomposition(F_n_A)\n    R_np1_A = polar_decomposition(F_np1_A)\n    Q = R_np1_A @ R_n_A.T\n    sigma_np1_A_exact = Q @ sigma_n_A @ Q.T\n    \n    result_A = norm(sigma_np1_A_computed - sigma_np1_A_exact, 'fro')\n\n    # Case B: Uniaxial stretch\n    E_B = 200e9\n    nu_B = 0.30\n    dt_B = 1.0\n    F_n_B = np.eye(3)\n    F_np1_B = np.diag([1.01, 1, 1])\n    sigma_n_B = np.zeros((3, 3))\n    \n    sigma_np1_B = compute_stress_update(E_B, nu_B, dt_B, F_n_B, F_np1_B, sigma_n_B)\n    result_B = sigma_np1_B[0, 0]\n\n    # Case C: Combined rotation and stretch\n    E_C = 100e9\n    nu_C = 0.25\n    dt_C = 0.1\n    theta_C = 0.25\n    c, s = np.cos(theta_C), np.sin(theta_C)\n    F_n_C = np.eye(3)\n    stretch_C = np.diag([1.02, 0.99, 1])\n    rot_C = np.array([[c, -s, 0], [s, c, 0], [0, 0, 1]])\n    F_np1_C = rot_C @ stretch_C\n    sigma_n_C = np.zeros((3, 3))\n\n    sigma_np1_C = compute_stress_update(E_C, nu_C, dt_C, F_n_C, F_np1_C, sigma_n_C)\n    result_C = np.trace(sigma_np1_C)\n\n    # Case D: Near-incompressible simple shear\n    E_D = 1.0e6\n    nu_D = 0.499\n    dt_D = 1.0\n    gamma_D = 0.02\n    F_n_D = np.eye(3)\n    F_np1_D = np.array([\n        [1, gamma_D, 0],\n        [0, 1, 0],\n        [0, 0, 1]\n    ])\n    sigma_n_D = np.zeros((3, 3))\n\n    sigma_np1_D = compute_stress_update(E_D, nu_D, dt_D, F_n_D, F_np1_D, sigma_n_D)\n    result_D = sigma_np1_D[0, 1]\n\n    # --- Final Output ---\n    results = [result_A, result_B, result_C, result_D]\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2666098"}]}