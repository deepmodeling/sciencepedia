{"hands_on_practices": [{"introduction": "本练习将带领我们回到离散时间系统可逆性的基本原理。我们将为一个简单的一阶因果稳定系统推导其逆系统。通过运用Z变换这一核心工具，我们不仅能在频域中找到逆系统的传递函数，还将被要求在时域中直接通过卷积运算来验证我们的结果，从而深刻理解时域与频域之间的对应关系。[@problem_id:2909246]", "problem": "考虑一个因果线性时不变 (LTI) 离散时间系统，其冲激响应为 $h[n]=\\alpha^{n}u[n]$，其中 $|\\alpha|  1$ 且 $u[n]$ 是单位阶跃序列。仅使用卷积、线性时不变系统的可逆性、双边 Z 变换 (ZT) 及其卷积-乘积性质的基本定义，确定一个逆系统的因果冲激响应 $g[n]$，使得 $(h*g)[n]=\\delta[n]$，其中 $\\delta[n]$ 是克罗内克 delta 函数。严格证明 $g[n]$ 的因果性和绝对可和性，并通过从基本定义出发直接计算卷积和，在时域中验证 $(h*g)[n]=\\delta[n]$。以 $\\delta[\\cdot]$ 和 $\\alpha$ 的形式，给出 $g[n]$ 的单一闭式表达式作为最终答案。不需要数值近似，也不涉及单位。", "solution": "问题陈述需经过验证。\n\n按如下方式逐字提取给定条件：\n1.  系统是因果线性时不变 (LTI) 离散时间系统。\n2.  冲激响应由 $h[n]=\\alpha^{n}u[n]$ 给出。\n3.  参数 $\\alpha$ 的约束条件是 $|\\alpha|  1$。\n4.  $u[n]$ 是单位阶跃序列。\n5.  必须找到一个具有因果冲激响应 $g[n]$ 的逆系统。\n6.  逆系统的条件是 $(h*g)[n]=\\delta[n]$。\n7.  $\\delta[n]$ 是克罗内克 delta 函数。\n8.  确定过程必须仅使用卷积、LTI 系统的可逆性、双边 Z 变换 (ZT) 及其卷积-乘积性质的基本定义。\n9.  必须严格证明 $g[n]$ 的因果性和绝对可和性。\n10. 必须通过直接计算卷积和在时域中验证结果 $(h*g)[n]=\\delta[n]$。\n11. 最终答案必须是关于 $\\delta[\\cdot]$ 和 $\\alpha$ 的 $g[n]$ 的单一闭式表达式。\n\n验证评估：\n该问题具有科学依据，是离散时间 LTI 系统理论中的一个基本练习。它的提法是适定的，提供了充分且一致的信息来确定一个唯一的、稳定的、因果的逆系统。语言客观而精确。该问题没有科学上的不健全性和模糊性，并且可以在指定的信号处理领域内形式化。这是一个标准的、非平凡的问题，需要按要求严格应用第一性原理。因此，该问题被认为是有效的，并将提供一个解。\n\n目标是找到一个因果 LTI 系统的冲激响应 $g[n]$，该系统是冲激响应为 $h[n] = \\alpha^n u[n]$ 的系统的逆系统。逆系统的定义属性是，原始冲激响应与逆冲激响应的卷积产生克罗内克 delta 函数，后者是卷积的单位元：\n$$ (h*g)[n] = \\delta[n] $$\n我们被要求使用 Z 变换。Z 变换的卷积性质指出，时域中的卷积对应于 Z 域中的乘法。设 $H(z) = \\mathcal{Z}\\{h[n]\\}$ 且 $G(z) = \\mathcal{Z}\\{g[n]\\}$。对定义方程应用 Z 变换可得：\n$$ H(z)G(z) = \\mathcal{Z}\\{\\delta[n]\\} $$\n克罗内克 delta 函数的 Z 变换是 $1$。因此，逆系统的传递函数 $G(z)$ 由下式给出：\n$$ G(z) = \\frac{1}{H(z)} $$\n首先，我们必须计算 $h[n] = \\alpha^n u[n]$ 的 Z 变换 $H(z)$。根据双边 Z 变换的定义：\n$$ H(z) = \\sum_{n=-\\infty}^{\\infty} h[n] z^{-n} = \\sum_{n=-\\infty}^{\\infty} \\alpha^n u[n] z^{-n} $$\n由于当 $n  0$ 时 $u[n] = 0$，当 $n \\ge 0$ 时 $u[n] = 1$，求和变为：\n$$ H(z) = \\sum_{n=0}^{\\infty} \\alpha^n z^{-n} = \\sum_{n=0}^{\\infty} (\\alpha z^{-1})^n $$\n这是一个几何级数，其收敛的充要条件是 $|\\alpha z^{-1}|  1$。这个条件定义了收敛域 (ROC) 为 $|z| > |\\alpha|$。鉴于 $|\\alpha|  1$，收敛域 $|z| > |\\alpha|$ 包含单位圆 $|z|=1$，这与原始系统是稳定的事实相符（一个冲激响应为 $h[n]=\\alpha^n u[n]$ 的因果系统在 $|\\alpha|  1$ 时是稳定的）。收敛几何级数的和为：\n$$ H(z) = \\frac{1}{1 - \\alpha z^{-1}}, \\quad \\text{ROC: } |z| > |\\alpha| $$\n现在我们可以确定逆系统的传递函数 $G(z)$：\n$$ G(z) = \\frac{1}{H(z)} = \\frac{1}{\\frac{1}{1 - \\alpha z^{-1}}} = 1 - \\alpha z^{-1} $$\n$G(z)$ 的表达式是关于 $z^{-1}$ 的有限多项式，所以它的收敛域是整个 z 平面，可能在 $z=0$ 处有一个极点。因此收敛域是 $|z|>0$。为了找到冲激响应 $g[n]$，我们计算 $G(z)$ 的逆 Z 变换。通过观察各项：\n$1$ 的逆 Z 变换是 $\\delta[n]$。\n$z^{-1}$ 的逆 Z 变换是 $\\delta[n-1]$。\n因此，利用 Z 变换的线性性质：\n$$ g[n] = \\mathcal{Z}^{-1}\\{1 - \\alpha z^{-1}\\} = \\mathcal{Z}^{-1}\\{1\\} - \\alpha \\mathcal{Z}^{-1}\\{z^{-1}\\} = \\delta[n] - \\alpha \\delta[n-1] $$\n这就给出了逆系统冲激响应的闭式表达式。\n\n接下来，我们必须证明 $g[n]$ 的因果性和绝对可和性。\n因果性：如果一个离散时间系统的冲激响应 $g[n]$ 对于所有 $n  0$ 都为零，则该系统是因果的。推导出的冲激响应是 $g[n] = \\delta[n] - \\alpha \\delta[n-1]$。\n对于任何 $n  0$，$\\delta[n]$ 和 $\\delta[n-1]$ 都为零。具体来说，对于 $n=-1$，$g[-1] = \\delta[-1] - \\alpha \\delta[-2] = 0 - 0 = 0$。对于任何 $n \\le -2$，所有项都为零。因此，对于所有 $n  0$，$g[n]=0$。该系统是因果的，符合要求。\n\n绝对可和性（稳定性）：如果一个系统的冲激响应是绝对可和的，即 $\\sum_{n=-\\infty}^{\\infty} |g[n]|  \\infty$，则该系统是稳定的。\n我们为推导出的 $g[n]$ 计算这个和：\n$$ \\sum_{n=-\\infty}^{\\infty} |g[n]| = \\sum_{n=-\\infty}^{\\infty} |\\delta[n] - \\alpha \\delta[n-1]| $$\n该表达式仅在 $n=0$ 和 $n=1$ 时非零。\n对于 $n=0$：$|g[0]| = |\\delta[0] - \\alpha \\delta[-1]| = |1 - \\alpha(0)| = 1$。\n对于 $n=1$：$|g[1]| = |\\delta[1] - \\alpha \\delta[0]| = |0 - \\alpha(1)| = |-\\alpha| = |\\alpha|$。\n对于所有其他整数 $n$，$g[n] = 0$。\n因此，和为：\n$$ \\sum_{n=-\\infty}^{\\infty} |g[n]| = |g[0]| + |g[1]| = 1 + |\\alpha| $$\n问题陈述 $|\\alpha|  1$。因此，和为 $1 + |\\alpha|  1 + 1 = 2$。由于和是有限的，冲激响应 $g[n]$ 是绝对可和的，逆系统是稳定的。\n\n最后，我们必须通过在时域中直接计算卷积和来验证结果 $(h*g)[n] = \\delta[n]$。\n$$ (h*g)[n] = \\sum_{k=-\\infty}^{\\infty} h[k] g[n-k] $$\n代入 $h[k] = \\alpha^k u[k]$ 和 $g[n-k] = \\delta[n-k] - \\alpha \\delta[n-k-1]$ 的表达式：\n$$ (h*g)[n] = \\sum_{k=-\\infty}^{\\infty} (\\alpha^k u[k]) (\\delta[n-k] - \\alpha \\delta[n-k-1]) $$\n根据求和的线性性质，我们可以将其分成两个和：\n$$ (h*g)[n] = \\sum_{k=-\\infty}^{\\infty} \\alpha^k u[k] \\delta[n-k] - \\alpha \\sum_{k=-\\infty}^{\\infty} \\alpha^k u[k] \\delta[n-k-1] $$\n我们使用克罗内克 delta 函数的筛选性质来计算每个和，该性质表明 $\\sum_k f[k]\\delta[k-k_0] = f[k_0]$。\n对于第一个和，delta 函数 $\\delta[n-k]$ 仅在 $k=n$ 时非零。应用筛选性质：\n$$ \\sum_{k=-\\infty}^{\\infty} \\alpha^k u[k] \\delta[n-k] = \\alpha^n u[n] $$\n对于第二个和，delta 函数 $\\delta[n-k-1]$ 仅在 $k=n-1$ 时非零。应用筛选性质：\n$$ \\sum_{k=-\\infty}^{\\infty} \\alpha^k u[k] \\delta[n-k-1] = \\alpha^{n-1} u[n-1] $$\n将这些结果代回卷积的表达式中：\n$$ (h*g)[n] = \\alpha^n u[n] - \\alpha (\\alpha^{n-1} u[n-1]) = \\alpha^n u[n] - \\alpha^n u[n-1] $$\n现在，我们必须对所有整数 $n$ 分析这个结果。\n情况 1：$n  0$。\n此时，$u[n] = 0$ 且 $u[n-1] = 0$。\n$(h*g)[n] = \\alpha^n (0) - \\alpha^n (0) = 0$。\n\n情况 2：$n = 0$。\n此时，$u[0] = 1$ 且 $u[-1] = 0$。\n$(h*g)[0] = \\alpha^0 u[0] - \\alpha^0 u[-1] = 1 \\cdot 1 - 1 \\cdot 0 = 1$。\n\n情况 3：$n > 0$。\n此时，$u[n] = 1$ 且 $u[n-1] = 1$。\n$(h*g)[n] = \\alpha^n (1) - \\alpha^n (1) = 0$。\n\n将这些结果与克罗内克 delta 函数 $\\delta[n]$ 的定义进行比较：\n$$ \\delta[n] = \\begin{cases} 1,  n=0 \\\\ 0,  n \\neq 0 \\end{cases} $$\n我们计算出的卷积 $(h*g)[n]$ 对所有 $n$ 都与 $\\delta[n]$ 相匹配。验证完成且成功。所确定的冲激响应 $g[n]$ 是正确的。", "answer": "$$\n\\boxed{\\delta[n] - \\alpha \\delta[n-1]}\n$$", "id": "2909246"}, {"introduction": "理论知识在面对实际挑战时才真正显示其价值，尤其是在处理非最小相位系统时。这类系统的直接因果逆是不稳定的，构成了信号处理中的一个经典难题。本编程练习要求你动手实现一种强大的“稳定逆”技术，通过构造一个非因果（需要预见）的滤波器来解决这一问题，这让你能够将抽象的理论概念转化为可工作的算法，并量化预见长度对精度的影响。[@problem_id:2909240]", "problem": "给定一系列离散时间、单输入单输出的线性时不变系统，其特征由复 $z$ 域中的传递函数 $H(z) = \\dfrac{B(z)}{A(z)}$ 描述，其中 $A(z)$ 和 $B(z)$ 是关于 $z^{-1}$ 的多项式，系数为实数且首项系数为 1。如果 $H(z)$ 的所有零点都严格位于单位圆内，则该系统称为最小相位系统；如果至少有一个零点严格位于单位圆外，则称为非最小相位系统；如果所有极点都严格位于单位圆内，则该系统是有界输入有界输出 (BIBO) 稳定的。对于此类系统，当零点位于单位圆外时，经典的因果求逆方法无法保证 BIBO 稳定。稳定求逆技术利用了这样一个事实：与非最小相位零点对应的逆是反因果的，但在反向时间上是稳定的。这可以通过使用期望输出的有限预见来近似非因果逆来实现。\n\n从 $z$ 域中线性时不变系统的卷积和可逆性的基本定义，以及根据零点和极点相对于单位圆的位置对其进行分类出发，设计并实现一个程序，完成以下任务：\n\n- 对于下面测试套件中指定的每个系统，使用基于预见的稳定求逆技术实现，计算能够产生给定的有限长度期望输出序列 $y_{\\mathrm{d}}[n]$ 的稳定逆输入序列 $u[n]$。您必须：\n  - 将分子多项式 $B(z)$ 分解为两个多项式 $B_{\\min}(z)$ 和 $B_{\\mathrm{nmp}}(z)$，其中 $B_{\\min}(z)$ 包含严格位于单位圆内的零点，$B_{\\mathrm{nmp}}(z)$ 包含严格位于单位圆外的零点。\n  - 构建一个因果、BIBO 稳定的分量 $G_{\\mathrm{c}}(z) = \\dfrac{A(z)}{B_{\\min}(z)}$ 和一个反因果、反向时间稳定的分量 $G_{\\mathrm{a}}(z) = \\dfrac{1}{B_{\\mathrm{nmp}}(z)}$，使得总的逆为 $H^{-1}(z) = G_{\\mathrm{c}}(z) \\, G_{\\mathrm{a}}(z)$。\n  - 使用时间反转和长度为 $L$ 个样本的有限预见来实现 $G_{\\mathrm{a}}(z)$。具体来说，假设在可用范围之外的期望输出为零，并使用 $L$ 个预见样本来近似反因果逆。然后应用因果稳定滤波器 $G_{\\mathrm{c}}(z)$ 来完成求逆过程。\n- 对于每个系统，量化所需的最小预见长度 $L_{\\min}$（样本的整数数量），以保证在有限预见下计算的逆输入与参考逆输入（使用足够大的预见计算）之间的最大绝对差不大于给定的容差 $\\varepsilon$。\n\n使用以下期望输出和测试套件。角度必须以弧度为单位。期望输出是一个有限长度信号，定义在 $n \\in \\{0,1,\\dots,T-1\\}$ 区间上，其中 $T = 256$，由下式给出：\n$$\ny_{\\mathrm{d}}[n] = \\sin(2\\pi f_1 n) + 0.5 \\sin(2\\pi f_2 n + \\varphi),\n$$\n其中 $f_1 = 0.05$，$f_2 = 0.12$，$\\varphi = 0.3$。在此区间外，期望输出假定为零。\n\n测试套件（每个测试用例包含以 $z^{-1}$ 的系数数组形式表示的分子和分母多项式，其首项系数为 1，以及容差 $\\varepsilon$）：\n- 用例 A：$B_{\\mathrm{A}}(z) = 1 - 1.5 z^{-1}$，$A_{\\mathrm{A}}(z) = 1 - 0.5 z^{-1}$，$\\varepsilon_{\\mathrm{A}} = 10^{-4}$。\n- 用例 B：$B_{\\mathrm{B}}(z) = 1 - 0.3 z^{-1}$，$A_{\\mathrm{B}}(z) = 1 - 0.5 z^{-1}$，$\\varepsilon_{\\mathrm{B}} = 10^{-6}$。\n- 用例 C：$B_{\\mathrm{C}}(z) = 1 - 2.45 z^{-1} + 1.5 z^{-2}$，$A_{\\mathrm{C}}(z) = 1 - 1.3 z^{-1} + 0.42 z^{-2}$，$\\varepsilon_{\\mathrm{C}} = 10^{-4}$。\n- 用例 D：$B_{\\mathrm{D}}(z) = 1 - 1.5 z^{-1} + 0.44 z^{-2}$，$A_{\\mathrm{D}}(z) = 1 - 1.1 z^{-1} + 0.18 z^{-2}$，$\\varepsilon_{\\mathrm{D}} = 10^{-4}$。\n\n在您的实现中需要遵守的定义和约束：\n- 多项式分解必须通过以下步骤执行：找到 $B(z)$ 的零点，根据其相对于单位圆的模进行分类，重构 $B_{\\min}(z)$ 和 $B_{\\mathrm{nmp}}(z)$，并在 $z^{-1}$ 表示法中保持首项系数为 1 的归一化。\n- 因果分量 $G_{\\mathrm{c}}(z)$ 必须实现为一个在正向时间方向上应用的稳定因果线性时不变滤波器。\n- 反因果分量 $G_{\\mathrm{a}}(z)$ 必须通过时间反转、在反转域中应用一个稳定的因果滤波器，然后再反转回来来实现。有限预见长度 $L$ 对应于在执行反转域因果滤波之前，在期望输出后附加 $L$ 个零。\n- 用于误差评估的参考逆必须使用一个足够大的预见长度 $L_{\\mathrm{ref}}$ 来计算，该长度的选择应确保进一步增加预见长度不会在数值精度范围内改变结果。您必须对所有用例使用相同的 $L_{\\mathrm{ref}}$。\n\n对于每个用例，您的程序必须搜索最小的整数预见长度 $L_{\\min} \\in \\{0,1,2,\\dots,L_{\\mathrm{ref}}\\}$，使得在所有 $n \\in \\{0,1,\\dots,T-1\\}$ 上，使用预见长度 $L_{\\min}$ 计算的逆输入与参考逆输入之间的最大绝对误差小于或等于 $\\varepsilon$。如果在 $L_{\\mathrm{ref}}$ 以内不存在这样的 $L_{\\min}$，则报告 $L_{\\min} = L_{\\mathrm{ref}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[L_{\\min,\\mathrm{A}},L_{\\min,\\mathrm{B}},L_{\\min,\\mathrm{C}},L_{\\min,\\mathrm{D}}]$。", "solution": "用户提供了一个有效的问题陈述。它在科学上基于数字信号处理的原理，问题定义清晰且客观。所有必要的数据和定义都已提供，且约束条件是一致的。任务是设计并实现一个用于线性时不变 (LTI) 系统稳定求逆的程序，并确定在给定精度下所需的最小预见长度。\n\n问题的核心在于以一种稳定的方式对非最小相位系统进行求逆。如果一个系统的传递函数 $H(z)$ 至少有一个零点 $z_0$ 满足 $|z_0| > 1$，则该系统是非最小相位的。直接的因果逆 $H^{-1}(z)$ 将在 $z_0$ 处有一个极点，该极点位于单位圆外，从而使逆滤波器成为有界输入有界输出 (BIBO) 不稳定的。稳定求逆技术通过反因果地实现逆滤波器的不稳定部分来克服这个问题。\n\n总体流程如下：\n\n1.  **系统分解**：将传递函数的分子多项式 $B(z)$ 分解为其最小相位和非最小相位分量。\n    $$\n    B(z) = B_{\\min}(z) B_{\\mathrm{nmp}}(z)\n    $$\n    该分解通过找到 $B(z)$ 的根（即系统 $H(z)$ 的零点）来实现。根据零点相对于单位圆的模的大小对其进行分类。\n    - 模 $|z_i|  1$ 的零点 $z_i$ 是最小相位的。多项式 $B_{\\min}(z)$ 由这些零点构成。\n    - 模 $|z_j|  1$ 的零点 $z_j$ 是非最小相位的。多项式 $B_{\\mathrm{nmp}}(z)$ 由这些零点构成。\n    鉴于原始多项式 $B(z)$ 具有实系数，任何复数根都将以共轭对的形式出现，这确保了最终生成的多项式 $B_{\\min}(z)$ 和 $B_{\\mathrm{nmp}}(z)$ 也具有实系数。\n\n2.  **逆系统构建**：将逆系统 $H^{-1}(z)$ 分为两个分量：\n    $$\n    H^{-1}(z) = \\frac{A(z)}{B(z)} = \\frac{A(z)}{B_{\\min}(z)} \\cdot \\frac{1}{B_{\\mathrm{nmp}}(z)} = G_{\\mathrm{c}}(z) G_{\\mathrm{a}}(z)\n    $$\n    - 因果分量 $G_{\\mathrm{c}}(z) = \\frac{A(z)}{B_{\\min}(z)}$ 是 BIBO 稳定的，因为它的极点（即 $B_{\\min}(z)$ 的零点）都位于单位圆内。它可以使用标准的前向时间递归滤波器来实现。\n    - 反因果分量 $G_{\\mathrm{a}}(z) = \\frac{1}{B_{\\mathrm{nmp}}(z)}$ 的极点对应于 $H(z)$ 的非最小相位零点，这些零点位于单位圆外。因果实现将是不稳定的。然而，一个稳定的反因果实现是可能的。\n\n3.  **反因果滤波实现**：$G_{\\mathrm{a}}(z)$ 的稳定实现是通过时间反转来完成的。用一个反因果滤波器 $G_{\\mathrm{a}}(z)$ 对序列 $x[n]$ 进行滤波，等效于执行以下三个步骤：\n    a. 对输入信号进行时间反转：$x_{\\mathrm{rev}}[n] = x[-n]$。\n    b. 使用一个因果、稳定的滤波器 $F(z) = G_{\\mathrm{a}}(1/z)$ 对 $x_{\\mathrm{rev}}[n]$ 进行滤波。\n    c. 对滤波器的输出进行时间反转。\n\n    反转滤波器的传递函数是 $F(z) = 1 / B_{\\mathrm{nmp}}(1/z)$。如果 $z_j$ 是 $B_{\\mathrm{nmp}}(z)$ 的一个根且 $|z_j| > 1$，那么 $1/z_j$ 就是 $B_{\\mathrm{nmp}}(1/z)$ 的一个根且 $|1/z_j|  1$。因此，$F(z)$ 的所有极点都在单位圆内，使其成为一个稳定、因果的滤波器。$F(z)$ 的分母多项式由根集合 $\\{1/z_j\\}$ 构成，其中 $\\{z_j\\}$ 是原始系统的非最小相位零点。\n\n4.  **有限预见近似**：在实践中，我们处理的是有限长度的信号。期望输出 $y_{\\mathrm{d}}[n]$ 在 $n \\in \\{0, 1, \\dots, T-1\\}$ 上给出，并假定在其他地方为零。反因果滤波步骤需要信号的未来值。我们通过使用长度为 $L$ 的有限预见来近似这一点，实际上是在一个由 $y_{\\mathrm{d}}[n]$ 后跟 $L$ 个零值样本组成的信号上操作。这种截断所产生的误差随着 $L$ 的增加而减小。误差衰减的速率取决于反转滤波器 $F(z)$ 的冲激响应，而这又由 $F(z)$ 模最大的极点决定，即 $\\max_j |1/z_j| = 1/\\min_j |z_j|$。\n\n5.  **最小预见长度 $L_{\\min}$ 的计算**：为了找到达到指定精度 $\\varepsilon$ 的最小预见长度 $L_{\\min}$，我们对每个测试用例执行以下步骤：\n    a. 使用一个足够大的预见长度 $L_{\\mathrm{ref}}$ 计算参考输入序列 $u_{\\mathrm{ref}}[n]$，选择该长度是为了确保截断误差可以忽略不计。选择 $L_{\\mathrm{ref}} = 500$，因为它显著大于所有测试用例中反因果动态的预期时间常数。\n    b. 对于递增的预见长度 $L = 0, 1, 2, \\dots$ 计算输入序列 $u_L[n]$。\n    c. 对于每个 $L$，在感兴趣的区间上计算最大绝对误差：\n       $$\n       E_L = \\max_{n \\in \\{0, \\dots, T-1\\}} |u_L[n] - u_{\\mathrm{ref}}[n]|\n       $$\n    d. 最小预见长度 $L_{\\min}$ 是使 $E_L \\le \\varepsilon$ 成立的最小整数 $L$。如果对于任何 $L \\le L_{\\mathrm{ref}}$ 都不满足此条件，则将 $L_{\\min}$ 报告为 $L_{\\mathrm{ref}}$。\n\n该实现将利用 `numpy` 进行多项式运算（通过 `numpy.roots` 找根，通过 `numpy.poly` 重构多项式）和 `scipy.signal.lfilter` 来实现因果数字滤波器。对于一个非最小相位系统，从期望输出 $y_{\\mathrm{d}}[n]$ 计算输入 $u[n]$ 的整体信号流是：\n$$\ny_{\\mathrm{d}}[n] \\xrightarrow{\\text{用 } L \\text{ 个零填充}} \\xrightarrow{\\text{时间反转}} \\xrightarrow{\\text{用 } F(z) \\text{ 滤波}} \\xrightarrow{\\text{时间反转}} y_{\\mathrm{c}}[n] \\xrightarrow{\\text{用 } G_{\\mathrm{c}}(z) \\text{ 滤波}} u[n]\n$$\n对于最小相位系统，反因果滤波阶段是一个单位操作，并且预计 $L_{\\min}$ 为 $0$。", "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef calculate_inverse_input(y_d, preview_L, b_coeffs, a_coeffs):\n    \"\"\"\n    Computes the stable inverse input for a given LTI system and desired output.\n\n    Args:\n        y_d (np.ndarray): The desired output sequence.\n        preview_L (int): The number of preview samples.\n        b_coeffs (np.ndarray): Numerator coefficients of the system H(z).\n        a_coeffs (np.ndarray): Denominator coefficients of the system H(z).\n\n    Returns:\n        np.ndarray: The computed stable inverse input sequence.\n    \"\"\"\n    # Step 1: Factor the numerator B(z) into minimum and non-minimum phase parts.\n    zeros = np.roots(b_coeffs)\n    min_phase_zeros = zeros[np.abs(zeros)  1.0]\n    non_min_phase_zeros = zeros[np.abs(zeros)  1.0]\n\n    b_min_coeffs = np.poly(min_phase_zeros).real if len(min_phase_zeros)  0 else np.array([1.0])\n\n    # Step 2: Apply the anti-causal filter G_a(z) = 1/B_nmp(z).\n    # This is implemented using time reversal.\n    y_extended = np.concatenate((y_d, np.zeros(preview_L)))\n\n    if len(non_min_phase_zeros)  0:\n        # The reversed filter F(z)=G_a(1/z) has poles at 1/z_j, which are stable.\n        reversed_poles = 1.0 / non_min_phase_zeros\n        a_rev = np.poly(reversed_poles).real\n\n        # Implement G_a(z) via time-reversal and filtering with F(z).\n        y_rev = y_extended[::-1]\n        w_rev = signal.lfilter([1.0], a_rev, y_rev)\n        y_c = w_rev[::-1]\n    else:\n        # If the system is minimum-phase, G_a(z) is identity.\n        y_c = y_extended\n\n    # Step 3: Apply the causal filter G_c(z) = A(z)/B_min(z).\n    u = signal.lfilter(a_coeffs, b_min_coeffs, y_c)\n\n    return u\n\ndef find_min_preview_length(y_d, b_coeffs, a_coeffs, epsilon, L_ref):\n    \"\"\"\n    Finds the minimum preview length L_min to meet a given error tolerance.\n\n    Args:\n        y_d (np.ndarray): The desired output sequence.\n        b_coeffs (np.ndarray): Numerator coefficients.\n        a_coeffs (np.ndarray): Denominator coefficients.\n        epsilon (float): The error tolerance.\n        L_ref (int): The reference preview length.\n\n    Returns:\n        int: The minimum required preview length L_min.\n    \"\"\"\n    T = len(y_d)\n\n    # If the system is minimum-phase, no preview is needed.\n    zeros = np.roots(b_coeffs)\n    if not np.any(np.abs(zeros)  1.0):\n        return 0\n\n    # Compute the reference input using a large preview length L_ref.\n    u_ref = calculate_inverse_input(y_d, L_ref, b_coeffs, a_coeffs)\n\n    # Search for the minimum L that satisfies the error criterion.\n    for L in range(L_ref + 1):\n        u_L = calculate_inverse_input(y_d, L, b_coeffs, a_coeffs)\n\n        # The error is the max absolute difference over the original signal duration.\n        error = np.max(np.abs(u_L[:T] - u_ref[:T]))\n\n        if error = epsilon:\n            return L\n\n    # If tolerance is not met, return L_ref.\n    return L_ref\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute the final results.\n    \"\"\"\n    # Define desired output signal parameters\n    T = 256\n    f1 = 0.05\n    f2 = 0.12\n    phi = 0.3\n    n = np.arange(T)\n    y_d = np.sin(2 * np.pi * f1 * n) + 0.5 * np.sin(2 * np.pi * f2 * n + phi)\n\n    # Define test suite\n    test_cases = [\n        # Case A: Nonminimum-phase (1 zero outside unit circle)\n        {'b': np.array([1.0, -1.5]), 'a': np.array([1.0, -0.5]), 'eps': 1e-4},\n        # Case B: Minimum-phase\n        {'b': np.array([1.0, -0.3]), 'a': np.array([1.0, -0.5]), 'eps': 1e-6},\n        # Case C: Nonminimum-phase (2 zeros outside unit circle)\n        {'b': np.array([1.0, -2.45, 1.5]), 'a': np.array([1.0, -1.3, 0.42]), 'eps': 1e-4},\n        # Case D: Mixed-phase (1 zero inside, 1 zero outside unit circle)\n        {'b': np.array([1.0, -1.5, 0.44]), 'a': np.array([1.0, -1.1, 0.18]), 'eps': 1e-4},\n    ]\n\n    # Reference preview length, chosen to be sufficiently large for all cases.\n    L_ref = 500\n\n    results = []\n    for case in test_cases:\n        L_min = find_min_preview_length(y_d, case['b'], case['a'], case['eps'], L_ref)\n        results.append(L_min)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2909240"}, {"introduction": "一个系统的逆系统的特性完全由原系统的零点决定。这个分析练习旨在深入探究这一核心关系。我们将分析一个有限冲激响应（FIR）滤波器，其零点靠近单位圆，并推导其逆系统冲激响应的渐近衰减率。通过这个练习，你将建立起关于系统零点位置如何决定逆滤波器响应“长度”或“慢度”的直观理解，这为你理解前一个练习中稳定逆的必要性提供了理论支持。[@problem_id:2909270]", "problem": "考虑一个因果线性时不变 (LTI) 离散时间系统，其具有有限脉冲响应 (FIR)，脉冲响应由下式给出：\n$$\nh[n] \\;=\\; \\delta[n] \\;-\\; 2(1-\\varepsilon)\\cos(\\theta)\\,\\delta[n-1] \\;+\\; (1-\\varepsilon)^{2}\\,\\delta[n-2],\n$$\n其中 $0  \\varepsilon  1$ 且 $\\theta \\in (-\\pi,\\pi]$。该系统在半径为 $1-\\varepsilon$ 处有一对共轭复零点，即在 $z=(1-\\varepsilon)\\exp(\\pm j\\theta)$ 处，这些零点严格位于单位圆内部。\n\n仅使用 LTI 系统可逆性的核心定义（即存在一个传递函数为 $G(z)$ 的因果逆系统，使得 $H(z)G(z)=1$）和几何级数的幂级数恒等式（对于 $|x|1$，有 $(1-x)^{-1}=\\sum_{n=0}^{\\infty}x^{n}$），推导通过 $G(z)=1/H(z)$ 的幂级数展开得到的因果逆系统的脉冲响应 $g[n]$，并分析其定性性质：判断 $g[n]$ 是有限支撑还是无限支撑，并确定其渐近指数衰减率。将渐近衰减因子定义为\n$$\n\\rho \\;=\\; \\limsup_{n\\to\\infty} |g[n]|^{1/n}.\n$$\n提供 $\\rho$ 作为 $\\varepsilon$ 的函数的精确闭式解析表达式。最终答案只给出该表达式。不要进行近似或四舍五入。", "solution": "在尝试任何解答之前，需要对所述问题进行验证。\n\n### 步骤 1：提取已知条件\n- **系统**：因果线性时不变 (LTI) 离散时间系统。\n- **脉冲响应**：$$h[n] = \\delta[n] - 2(1-\\varepsilon)\\cos(\\theta)\\,\\delta[n-1] + (1-\\varepsilon)^{2}\\,\\delta[n-2]$$\n- **系统类型**：有限脉冲响应 (FIR)。\n- **参数**：$0  \\varepsilon  1$ 且 $\\theta \\in (-\\pi,\\pi]$。\n- **系统零点**：一对位于 $z=(1-\\varepsilon)\\exp(\\pm j\\theta)$ 的共轭复零点。\n- **可逆性定义**：存在一个传递函数为 $G(z)$ 的因果逆系统，使得 $H(z)G(z)=1$。\n- **指定方法**：使用几何级数的幂级数恒等式 $(1-x)^{-1}=\\sum_{n=0}^{\\infty}x^{n}$（对于 $|x|1$），通过对 $G(z)=1/H(z)$ 进行幂级数展开来推导逆系统的脉冲响应 $g[n]$。\n- **要求分析**：\n    1.  判断 $g[n]$ 是有限支撑还是无限支撑。\n    2.  确定渐近指数衰减率 $\\rho$，其定义为 $\\rho = \\limsup_{n\\to\\infty} |g[n]|^{1/n}$。\n- **最终输出**：$\\rho$ 作为 $\\varepsilon$ 的函数的精确闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在信号处理的 LTI 系统理论标准框架内具有科学依据。脉冲响应、Z 变换、系统零点和可逆性等概念都得到了严格定义。问题是适定的：它提供了对一个 FIR 系统的完整描述，并要求其因果逆系统的明确定义的性质。对参数 $\\varepsilon$ 和 $\\theta$ 的约束是清晰的，并确保零点严格位于单位圆内部，这是因果逆系统稳定性的一个关键条件。该问题客观、无歧义，不包含任何科学或逻辑上的矛盾。所有求解所需的信息都已提供。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将根据指定的方法推导解答。\n\n### 解答推导\n系统的传递函数 $H(z)$ 是其脉冲响应 $h[n]$ 的 Z 变换。\n$$H(z) = \\mathcal{Z}\\{h[n]\\} = 1 - 2(1-\\varepsilon)\\cos(\\theta)z^{-1} + (1-\\varepsilon)^{2}z^{-2}$$\n这是关于 $z^{-1}$ 的一个二阶多项式。$H(z)$ 的零点是对应 $z$ 的多项式 $z^2 - 2(1-\\varepsilon)\\cos(\\theta)z + (1-\\varepsilon)^2 = 0$ 的根。如问题所述，根被确认为 $z = (1-\\varepsilon)\\exp(\\pm j\\theta)$。令 $p_1 = (1-\\varepsilon)\\exp(j\\theta)$ 和 $p_2 = (1-\\varepsilon)\\exp(-j\\theta)$。\n\n传递函数可以写成因式分解的形式：\n$$H(z) = (1 - p_1 z^{-1})(1 - p_2 z^{-1})$$\n逆系统的传递函数为 $G(z)$，使得 $H(z)G(z)=1$。\n$$G(z) = \\frac{1}{H(z)} = \\frac{1}{(1 - p_1 z^{-1})(1 - p_2 z^{-1})}$$\n$G(z)$ 的极点是 $H(z)$ 的零点，即 $p_1$ 和 $p_2$。系统 $H(z)$ 是 FIR 系统，因此 $h[n]$ 具有有限支撑。相反，$G(z)$ 含有极点，所以其脉冲响应 $g[n]$ 将具有无限支撑。这回答了第一个定性问题。\n\n为了求脉冲响应 $g[n]$，我们对 $G(z)$ 进行关于 $z^{-1}$ 的部分分式展开。\n$$G(z) = \\frac{A}{1 - p_1 z^{-1}} + \\frac{B}{1 - p_2 z^{-1}}$$\n系数 $A$ 和 $B$ 被求得为：\n$$A = \\frac{1}{1-p_2/p_1} = \\frac{p_1}{p_1-p_2}$$\n$$B = \\frac{1}{1-p_1/p_2} = \\frac{p_2}{p_2-p_1} = -A\\frac{p_2}{p_1}$$\n我们来计算 $p_1-p_2$：\n$$p_1 - p_2 = (1-\\varepsilon)(\\exp(j\\theta) - \\exp(-j\\theta)) = (1-\\varepsilon)(2j\\sin(\\theta))$$\n对于 $\\theta \\neq 0, \\pi$（即 $\\sin(\\theta) \\neq 0$）的情况，系数为：\n$$A = \\frac{(1-\\varepsilon)\\exp(j\\theta)}{(1-\\varepsilon)(2j\\sin(\\theta))} = \\frac{\\exp(j\\theta)}{2j\\sin(\\theta)}$$\n$$B = \\frac{(1-\\varepsilon)\\exp(-j\\theta)}{-(1-\\varepsilon)(2j\\sin(\\theta))} = \\frac{-\\exp(-j\\theta)}{2j\\sin(\\theta)}$$\n问题指定了一个因果逆系统。条件 $0  \\varepsilon  1$ 意味着极点 $p_1$ 和 $p_2$ 的模为 $|p_1| = |p_2| = 1-\\varepsilon  1$。它们严格位于单位圆内部，因此存在一个稳定且因果的逆系统。$G(z)$ 的收敛域 (ROC) 是 $|z| > 1-\\varepsilon$。在此收敛域内，我们可以使用几何级数展开式 $(1-x)^{-1} = \\sum_{n=0}^{\\infty}x^n$。\n$$G(z) = A \\sum_{n=0}^{\\infty} (p_1 z^{-1})^n + B \\sum_{n=0}^{\\infty} (p_2 z^{-1})^n = \\sum_{n=0}^{\\infty} (A p_1^n + B p_2^n) z^{-n}$$\n逆脉冲响应 $g[n]$ 是 $z^{-n}$ 的系数，对于所有 $n \\ge 0$，该系数均非零。\n$$g[n] = (A p_1^n + B p_2^n)u[n]$$\n代入 $A$、$B$、$p_1$ 和 $p_2$ 的表达式：\n$$g[n] = \\left( \\frac{\\exp(j\\theta)}{2j\\sin(\\theta)} ((1-\\varepsilon)\\exp(j\\theta))^n - \\frac{\\exp(-j\\theta)}{2j\\sin(\\theta)} ((1-\\varepsilon)\\exp(-j\\theta))^n \\right) u[n]$$\n$$g[n] = \\frac{(1-\\varepsilon)^n}{2j\\sin(\\theta)} (\\exp(j(n+1)\\theta) - \\exp(-j(n+1)\\theta)) u[n]$$\n使用正弦的欧拉公式 $\\sin(x) = (\\exp(jx)-\\exp(-jx))/(2j)$，我们得到当 $\\sin(\\theta) \\neq 0$ 时 $g[n]$ 的闭式表达式：\n$$g[n] = (1-\\varepsilon)^n \\frac{\\sin((n+1)\\theta)}{\\sin(\\theta)} u[n]$$\n现在，我们计算渐近衰减因子 $\\rho$。\n$$\\rho = \\limsup_{n\\to\\infty} |g[n]|^{1/n} = \\limsup_{n\\to\\infty} \\left| (1-\\varepsilon)^n \\frac{\\sin((n+1)\\theta)}{\\sin(\\theta)} \\right|^{1/n}$$\n$$\\rho = (1-\\varepsilon) \\limsup_{n\\to\\infty} \\left| \\frac{\\sin((n+1)\\theta)}{\\sin(\\theta)} \\right|^{1/n}$$\n项 $|\\sin((n+1)\\theta)/\\sin(\\theta)|$ 是一个有界序列。对于任意常数 $C > 0$，$\\lim_{n\\to\\infty} C^{1/n} = 1$。序列 $\\sin((n+1)\\theta)$ 不恒为零，所以其 `n` 次根的上极限是 $1$。一个更正式的论证是，对于任何满足 $\\limsup_{n\\to\\infty} |c_n| > 0$ 的有界序列 $c_n$，都有 $\\limsup_{n\\to\\infty} |c_n|^{1/n} = 1$ 成立。因此：\n$$\\rho = (1-\\varepsilon) \\times 1 = 1-\\varepsilon$$\n\n我们还必须考虑 $\\sin(\\theta) = 0$ 的特殊情况，即 $\\theta=0$ 或 $\\theta=\\pi$。\n如果 $\\theta=0$，则 $p_1=p_2=1-\\varepsilon$。这是一个二重极点。\n$$G(z) = \\frac{1}{(1-(1-\\varepsilon)z^{-1})^2}$$\n$(1-az^{-1})^{-2}$ 的 Z 逆变换是 $(n+1)a^n u[n]$。所以，\n$$g[n] = (n+1)(1-\\varepsilon)^n u[n]$$\n在这种情况下，$\\rho$ 是\n$$\\rho = \\lim_{n\\to\\infty} |(n+1)(1-\\varepsilon)^n|^{1/n} = (1-\\varepsilon) \\lim_{n\\to\\infty} (n+1)^{1/n}$$\n极限 $\\lim_{n\\to\\infty} (n+1)^{1/n} = 1$。因此，$\\rho = 1-\\varepsilon$。\n\n如果 $\\theta=\\pi$，则 $p_1=p_2=-(1-\\varepsilon)$。这也是一个二重极点。\n$$G(z) = \\frac{1}{(1+(1-\\varepsilon)z^{-1})^2}$$\n脉冲响应是：\n$$g[n] = (n+1)(-(1-\\varepsilon))^n u[n] = (-1)^n(n+1)(1-\\varepsilon)^n u[n]$$\n$\\rho$ 的计算保持不变，因为绝对值消去了 $(-1)^n$ 项：\n$$\\rho = \\lim_{n\\to\\infty} |(-1)^n(n+1)(1-\\varepsilon)^n|^{1/n} = (1-\\varepsilon) \\lim_{n\\to\\infty} (n+1)^{1/n} = 1-\\varepsilon$$\n在所有情况下，渐近衰减因子 $\\rho$ 都与 $\\theta$ 无关，而仅由逆系统极点的模决定。\n渐近衰减因子是 $\\rho = 1-\\varepsilon$。", "answer": "$$\\boxed{1-\\varepsilon}$$", "id": "2909270"}]}