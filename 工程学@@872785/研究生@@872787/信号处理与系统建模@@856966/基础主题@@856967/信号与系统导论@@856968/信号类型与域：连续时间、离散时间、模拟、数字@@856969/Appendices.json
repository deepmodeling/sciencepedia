{"hands_on_practices": [{"introduction": "连接连续信号和离散信号的桥梁是采样。一个关键问题是，信号能量和功率等基本属性在此过程中如何被保持或改变。本练习将运用连续和离散域中的帕塞瓦尔定理 (Parseval's relation)，严格推导连接两者的缩放因子[@problem_id:2904635]。这项实践有助于巩固对无混叠采样下信号与其采样点之间关系的理解，并为它们的能量和功率指标之间建立定量的联系。", "problem": "考虑一个实值连续时间信号 $x_{\\mathrm{c}}(t)$，它属于希尔伯特空间 $L^{2}(\\mathbb{R})$，并且是带限的，其带宽为 $|\\Omega| \\leq \\Omega_{\\mathrm{B}}$，即其连续时间傅里叶变换 (CTFT) $X_{\\mathrm{c}}(j\\Omega)$ 在 $|\\Omega| > \\Omega_{\\mathrm{B}}$ 时为零。设该信号以采样周期 $T_{\\mathrm{s}} > 0$ 进行均匀采样，形成离散时间序列 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$，并假设满足奈奎斯特条件 $\\Omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}} > 2 \\,\\Omega_{\\mathrm{B}}$，从而理想采样是无混叠的。用 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega})$ 表示 $x[n]$ 的离散时间傅里叶变换 (DTFT)。\n\n$x_{\\mathrm{c}}(t)$ 的连续时间能量定义为 $E_{\\mathrm{c}} = \\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$，而 $x[n]$ 的离散时间 $\\ell^{2}$-能量为 $E_{\\mathrm{d}} = \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$。一个（不一定平方可积的）信号 $x_{\\mathrm{c}}(t)$ 的连续时间时间平均功率为 $P_{\\mathrm{c}} = \\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$（当此极限存在时），而 $x[n]$ 的离散时间样本平均功率为 $P_{\\mathrm{d}} = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$（当此极限存在时）。\n\n仅从连续时间傅里叶变换和离散时间傅里叶变换的标准定义、理想采样模型（时域上乘以一个冲激串）以及各域中的帕塞瓦尔关系出发，推导在无混叠采样下，连续时间的能量和功率概念如何转换为离散时间的形式。特别地，证明存在仅依赖于 $T_{\\mathrm{s}}$ 的正常数比例常数 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$，使得\n对于所有带限的 $x_{\\mathrm{c}} \\in L^{2}(\\mathbb{R})$，有 $\\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = c_{E}(T_{\\mathrm{s}}) \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$，\n以及对于任何带限且无混叠采样的广义时间平均功率信号 $x_{\\mathrm{c}}(t)$，有\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = c_{P}(T_{\\mathrm{s}}) \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n\n计算 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$ 关于 $T_{\\mathrm{s}}$ 的显式解析表达式。以行矩阵 $\\begin{pmatrix} c_{E}(T_{\\mathrm{s}})  c_{P}(T_{\\mathrm{s}}) \\end{pmatrix}$ 的形式报告您的最终答案。最终答案中不需要进行数值计算，也不应包含单位。", "solution": "本题旨在建立一个连续时间带限信号的能量和功率与其通过均匀采样得到的无混叠离散时间对应信号之间的定量关系。我们需要找到比例常数 $c_{E}(T_{\\mathrm{s}})$ 和 $c_{P}(T_{\\mathrm{s}})$。整个推导过程必须从基本原理出发。\n\n我们首先建立信号 $x_{\\mathrm{c}}(t)$ 的连续时间傅里叶变换 (CTFT) 与序列 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$ 的离散时间傅里叶变换 (DTFT) 之间的基本关系。\n\n我们采用以下傅里叶变换的标准定义：\n信号 $g(t)$ 的CTFT为 $G(j\\Omega) = \\int_{-\\infty}^{\\infty} g(t) \\exp(-\\mathrm{j}\\Omega t)\\,\\mathrm{d}t$。\n逆CTFT为 $g(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} G(j\\Omega) \\exp(\\mathrm{j}\\Omega t)\\,\\mathrm{d}\\Omega$。\n序列 $h[n]$ 的DTFT为 $H(\\mathrm{e}^{\\mathrm{j}\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n] \\exp(-\\mathrm{j}\\omega n)$。\n逆DTFT为 $h[n] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H(\\mathrm{e}^{\\mathrm{j}\\omega}) \\exp(\\mathrm{j}\\omega n)\\,\\mathrm{d}\\omega$。\n\n理想采样的过程可以建模为将连续时间信号 $x_{\\mathrm{c}}(t)$ 乘以一个冲激串，得到采样信号 $x_{\\mathrm{s}}(t) = x_{\\mathrm{c}}(t) \\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}}) = \\sum_{n=-\\infty}^{\\infty} x_{\\mathrm{c}}(n T_{\\mathrm{s}}) \\delta(t - n T_{\\mathrm{s}})$。离散序列为 $x[n] = x_{\\mathrm{c}}(n T_{\\mathrm{s}})$。\n\n$x_{\\mathrm{s}}(t)$ 的CTFT，记为 $X_{\\mathrm{s}}(j\\Omega)$，可以通过两种方式求得。首先，利用时域乘法性质，它对应于频域的卷积：\n$X_{\\mathrm{s}}(j\\Omega) = \\frac{1}{2\\pi} \\left( X_{\\mathrm{c}}(j\\Omega) * \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}})\\right\\} \\right)$。\n冲激串的傅里叶变换是另一个冲激串：$\\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} \\delta(t - n T_{\\mathrm{s}})\\right\\} = \\Omega_{\\mathrm{s}} \\sum_{k=-\\infty}^{\\infty} \\delta(\\Omega - k \\Omega_{\\mathrm{s}})$，其中 $\\Omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}}$。\n与该冲激串进行卷积，得到 $X_{\\mathrm{c}}(j\\Omega)$ 的周期性复制：\n$X_{\\mathrm{s}}(j\\Omega) = \\frac{1}{2\\pi} X_{\\mathrm{c}}(j\\Omega) * \\left( \\frac{2\\pi}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} \\delta(\\Omega - k \\Omega_{\\mathrm{s}}) \\right) = \\frac{1}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(j(\\Omega - k \\Omega_{\\mathrm{s}}))$。\n\n其次，我们可以直接从 $x_{\\mathrm{s}}(t)$ 作为加权冲激之和的定义来计算其CTFT：\n$X_{\\mathrm{s}}(j\\Omega) = \\mathcal{F}\\left\\{\\sum_{n=-\\infty}^{\\infty} x[n] \\delta(t - n T_{\\mathrm{s}})\\right\\} = \\sum_{n=-\\infty}^{\\infty} x[n] \\exp(-\\mathrm{j}\\Omega n T_{\\mathrm{s}})$。\n\n将此与DTFT的定义 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega})$ 进行比较，我们发现 $X_{\\mathrm{s}}(j\\Omega)$ 正是 $x[n]$ 的DTFT在 $\\omega = \\Omega T_{\\mathrm{s}}$ 处的值。\n因此，我们得到了基本关系式：\n$$X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}}) = \\frac{1}{T_{\\mathrm{s}}} \\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(j(\\Omega - k \\Omega_{\\mathrm{s}}))$$\n\n现在我们来推导能量的比例常数 $c_{E}(T_{\\mathrm{s}})$。\n连续时间信号 $x_{\\mathrm{c}}(t)$ 的能量由CTFT的帕塞瓦尔关系给出：\n$E_{\\mathrm{c}} = \\int_{-\\infty}^{\\infty} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} |X_{\\mathrm{c}}(j\\Omega)|^{2}\\,\\mathrm{d}\\Omega$。\n离散时间序列 $x[n]$ 的能量由DTFT的帕塞瓦尔关系给出：\n$E_{\\mathrm{d}} = \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega})|^{2}\\,\\mathrm{d}\\omega$。\n\n题目说明 $x_{\\mathrm{c}}(t)$ 是带限的，带宽为 $|\\Omega| \\leq \\Omega_{\\mathrm{B}}$，这意味着当 $|\\Omega| > \\Omega_{\\mathrm{B}}$ 时 $X_{\\mathrm{c}}(j\\Omega)=0$。采样是无混叠的，这意味着 $\\Omega_{\\mathrm{s}} > 2 \\Omega_{\\mathrm{B}}$。这个条件确保了频谱副本 $X_{\\mathrm{c}}(j(\\Omega - k \\Omega_{\\mathrm{s}}))$ 不会重叠。\n对于主频率区间 $|\\Omega|  \\Omega_{\\mathrm{s}}/2$，求和式 $\\sum_{k=-\\infty}^{\\infty} X_{\\mathrm{c}}(j(\\Omega - k \\Omega_{\\mathrm{s}}))$ 得以简化。$k=0$ 的项是 $X_{\\mathrm{c}}(j\\Omega)$。对于任何 $k \\neq 0$，副本的中心 $k\\Omega_s$ 位于区间 $(-\\Omega_s, \\Omega_s)$ 之外。由于 $|\\Omega|\\Omega_s/2$，频率参数 $\\Omega-k\\Omega_s$ 的幅度将大于 $\\Omega_s/2$，而 $\\Omega_s/2$ 又大于 $\\Omega_{\\mathrm{B}}$。因此，当 $|\\Omega|  \\Omega_{\\mathrm{s}}/2$ 时，对于所有 $k \\ne 0$，都有 $X_{\\mathrm{c}}(j(\\Omega - k \\Omega_{\\mathrm{s}})) = 0$。\n该关系简化为 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}}) = \\frac{1}{T_{\\mathrm{s}}} X_{\\mathrm{c}}(j\\Omega)$，对于 $|\\Omega|  \\Omega_{\\mathrm{s}}/2$。\n这意味着对于 $|\\Omega|  \\Omega_{\\mathrm{s}}/2$，有 $|X_{\\mathrm{c}}(j\\Omega)|^{2} = T_{\\mathrm{s}}^{2} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}})|^{2}$。\n现在我们可以关联能量表达式。由于当 $|\\Omega| > \\Omega_{\\mathrm{B}}$ 且 $\\Omega_{\\mathrm{B}}  \\Omega_{\\mathrm{s}}/2$ 时 $X_{\\mathrm{c}}(j\\Omega) = 0$：\n$E_{\\mathrm{c}} = \\frac{1}{2\\pi} \\int_{-\\Omega_{\\mathrm{B}}}^{\\Omega_{\\mathrm{B}}} |X_{\\mathrm{c}}(j\\Omega)|^{2}\\,\\mathrm{d}\\Omega = \\frac{1}{2\\pi} \\int_{-\\Omega_{\\mathrm{B}}}^{\\Omega_{\\mathrm{B}}} T_{\\mathrm{s}}^{2} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}})|^{2}\\,\\mathrm{d}\\Omega$。\n由于当 $\\Omega_{\\mathrm{B}}  |\\Omega| \\leq \\Omega_{\\mathrm{s}}/2$ 时 $X_{\\mathrm{c}}(j\\Omega)$ 为零，所以 $X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}})$ 也为零。我们可以将积分限扩展到 $[-\\Omega_{\\mathrm{s}}/2, \\Omega_{\\mathrm{s}}/2] = [-\\pi/T_{\\mathrm{s}}, \\pi/T_{\\mathrm{s}}]$ 而不改变积分值：\n$E_{\\mathrm{c}} = \\frac{T_{\\mathrm{s}}^{2}}{2\\pi} \\int_{-\\pi/T_{\\mathrm{s}}}^{\\pi/T_{\\mathrm{s}}} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\Omega T_{\\mathrm{s}}})|^{2}\\,\\mathrm{d}\\Omega$。\n我们在积分中进行变量替换：令 $\\omega = \\Omega T_{\\mathrm{s}}$，这意味着 $\\mathrm{d}\\Omega = \\frac{1}{T_{\\mathrm{s}}}\\mathrm{d}\\omega$。积分限变为 $[-\\pi, \\pi]$。\n$E_{\\mathrm{c}} = \\frac{T_{\\mathrm{s}}^{2}}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega})|^{2} \\frac{1}{T_{\\mathrm{s}}}\\,\\mathrm{d}\\omega = \\frac{T_{\\mathrm{s}}}{2\\pi} \\int_{-\\pi}^{\\pi} |X_{\\mathrm{d}}(\\mathrm{e}^{\\mathrm{j}\\omega})|^{2}\\,\\mathrm{d}\\omega$。\n右边的积分等于 $2\\pi E_{\\mathrm{d}}$。因此：\n$E_{\\mathrm{c}} = T_{\\mathrm{s}} E_{\\mathrm{d}} = T_{\\mathrm{s}} \\sum_{n=-\\infty}^{\\infty} |x[n]|^{2}$。\n与题目陈述 $E_{\\mathrm{c}} = c_{E}(T_{\\mathrm{s}}) E_{\\mathrm{d}}$ 相比较，我们得到 $c_{E}(T_{\\mathrm{s}}) = T_{\\mathrm{s}}$。\n\n接下来，我们推导功率的比例常数 $c_{P}(T_{\\mathrm{s}})$。\n$P_{\\mathrm{c}} = \\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t$。\n$P_{\\mathrm{d}} = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n我们定义信号 $y(t) = |x_{\\mathrm{c}}(t)|^{2}$。问题是要将 $y(t)$ 的时间平均值与其样本 $y[n] = y(nT_{\\mathrm{s}}) = |x_{\\mathrm{c}}(nT_{\\mathrm{s}})|^{2} = |x[n]|^{2}$ 的样本平均值关联起来。\n信号 $x_{\\mathrm{c}}(t)$ 的带宽限制在 $\\Omega_{\\mathrm{B}}$ 内。时域中的平方运算对应于频域中的卷积。如果 $X_{\\mathrm{c}}(j\\Omega)$ 是 $x_{\\mathrm{c}}(t)$ 的CTFT，那么 $y(t)=|x_c(t)|^2$ 的CTFT是 $Y(j\\Omega) = \\frac{1}{2\\pi} (X_{\\mathrm{c}}(j\\Omega) * X_{\\mathrm{c}}^{*}(-j\\Omega))$。由于 $x_{\\mathrm{c}}(t)$ 是实信号，所以 $X_{\\mathrm{c}}^{*}(-j\\Omega)=X_{\\mathrm{c}}(j\\Omega)$，因此 $Y(j\\Omega) = \\frac{1}{2\\pi} (X_{\\mathrm{c}}(j\\Omega) * X_{\\mathrm{c}}(j\\Omega))$。两个支撑集为 $[-\\Omega_{\\mathrm{B}}, \\Omega_{\\mathrm{B}}]$ 的函数的卷积，其结果函数的支撑集为 $[-2\\Omega_{\\mathrm{B}}, 2\\Omega_{\\mathrm{B}}]$。因此，$y(t)$ 的带宽限制在 $2\\Omega_{\\mathrm{B}}$ 内。\n有一个定理指出，对于一个时间平均值为 $\\bar{g}_{\\mathrm{c}}$ 的信号 $g(t)$，其样本 $g[n]=g(nT_s)$ 的样本平均值（记为 $\\bar{g}_{\\mathrm{d}}$）等于 $\\bar{g}_{\\mathrm{c}}$ 的充要条件是，该信号的CTFT $G(j\\Omega)$ 在采样频率的所有非零整数倍处为零，即对于所有整数 $k \\neq 0$，有 $G(jk \\Omega_{\\mathrm{s}}) = 0$。\n在我们的情况下，信号是 $y(t)$，其CTFT为 $Y(j\\Omega)$。我们已经确定，当 $|\\Omega| > 2\\Omega_{\\mathrm{B}}$ 时，$Y(j\\Omega)=0$。采样频率为 $\\Omega_{\\mathrm{s}} = \\frac{2\\pi}{T_{\\mathrm{s}}}$。条件是对于 $k \\in \\mathbb{Z}, k \\neq 0$，$Y(jk \\Omega_{\\mathrm{s}}) = 0$。\n根据 $x_{\\mathrm{c}}(t)$ 的无混叠条件，我们有 $\\Omega_{\\mathrm{s}} > 2\\Omega_{\\mathrm{B}}$。\n对于任何非零整数 $k$，我们有 $|k \\Omega_{\\mathrm{s}}| \\geq \\Omega_{\\mathrm{s}} > 2\\Omega_{\\mathrm{B}}$。\n由于 $Y(j\\Omega)$ 在幅度大于 $2\\Omega_{\\mathrm{B}}$ 的频率处为零，因此可以肯定，对于所有 $k \\neq 0$，$Y(jk \\Omega_{\\mathrm{s}}) = 0$。\n该条件得到满足。因此，连续时间信号 $y(t)$ 的平均值等于其离散时间样本 $y[n]$ 的平均值。\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} y(t)\\,\\mathrm{d}t = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} y[n]$。\n将 $y(t) = |x_{\\mathrm{c}}(t)|^{2}$ 和 $y[n] = |x[n]|^{2}$ 代回：\n$\\lim_{T \\to \\infty} \\frac{1}{2T} \\int_{-T}^{T} |x_{\\mathrm{c}}(t)|^{2}\\,\\mathrm{d}t = \\lim_{N \\to \\infty} \\frac{1}{2N+1} \\sum_{n=-N}^{N} |x[n]|^{2}$。\n这恰好说明了 $P_{\\mathrm{c}} = P_{\\mathrm{d}}$。\n因此，比例常数 $c_{P}(T_{\\mathrm{s}})$ 为 $1$。\n\n这两个常数是 $c_{E}(T_{\\mathrm{s}}) = T_{\\mathrm{s}}$ 和 $c_{P}(T_{\\mathrm{s}}) = 1$。", "answer": "$$\\boxed{\\begin{pmatrix} T_{\\mathrm{s}}  1 \\end{pmatrix}}$$", "id": "2904635"}, {"introduction": "采样之后，量化是将模拟信号转换为数字信号的下一步。为了简化分析，量化误差通常被建模为加性白噪声 (additive white noise, AWN)，但这个模型有其局限性。本练习将探讨一种特定情况：当信号幅度相对于量化步长非常小时，量化器的行为会变得高度确定性和非线性。通过构建一个反例[@problem_id:2904665]，你将亲眼看到AWN模型在何种情况下会失效，并产生与输入完全相关的误差，从而更深刻地理解简化模型的适用条件。", "problem": "考虑一个理想的模数转换器 (ADC) 内部使用的理想中置型均匀量化器，且无抖动。该量化器将任何实数输入 $x$ 映射到输出 $Q(x)$，其定义为\n$$\nQ(x) = \\Delta \\,\\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor,\n$$\n其中 $\\Delta$ 是量化步长，$\\lfloor \\cdot \\rfloor$ 表示向下取整函数。假设量化器具有足够大的动态范围，以至于不会发生过载。\n\n一个振幅为 $A$ 的模拟正弦信号 $x_{a}(t) = A \\cos\\!\\left(2\\pi f_{0} t\\right)$ 以采样频率 $f_{s}$ 进行采样，形成离散时间输入 $x[n] = x_{a}(n/f_{s}) = A \\cos\\!\\left(\\omega_{0} n\\right)$，其中 $\\omega_{0} = 2\\pi f_{0}/f_{s}$。假设 $\\omega_{0} = 2\\pi p/M$，其中整数 $p$ 和 $M$ 互质，并且 $A$ 和 $\\Delta$ 满足 $0  A  \\Delta/2$。令量化误差为 $e[n] = Q\\!\\left(x[n]\\right) - x[n]$。\n\n从上述定义（量化器映射、采样和量化误差）出发，确定精确的时间平均量化误差均方值，\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left(e[n]\\right)^{2},\n$$\n并以 $A$ 和 $\\Delta$ 的闭合形式表达式表示。你的构建过程应清楚地说明，在这些条件下，为何加性白噪声 (AWN) 量化模型会失效，因为它产生的误差与输入相关，并表现出可见的谱线。\n\n将你的最终答案表示为单个无单位的闭合形式解析表达式。无需四舍五入。", "solution": "该问题要求计算量化正弦信号特定情况下的时间平均量化误差均方值。该问题定义明确且科学上合理，因此我们可以着手求解。\n\n已知条件如下：\n-   一个由 $Q(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor$ 定义的中置型均匀量化器。\n-   一个离散时间输入信号 $x[n] = A \\cos(\\omega_{0} n)$，它是周期性的。\n-   关于信号振幅 $A$ 和量化步长 $\\Delta$ 的一个关键条件：$0  A  \\frac{\\Delta}{2}$。\n-   量化误差为 $e[n] = Q(x[n]) - x[n]$。\n-   目标是求均方误差 (MSE)，其定义为 $\\text{MSE} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} (e[n])^{2}$。\n\n首先，我们必须分析在给定的振幅约束下量化器的行为。输入信号为 $x[n] = A \\cos(\\omega_{0} n)$。$x[n]$ 的取值范围是 $[-A, A]$。条件 $0  A  \\frac{\\Delta}{2}$ 意味着对于所有整数 $n$，输入样本 $x[n]$ 严格限制在区间 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 内。我们来考察对于此范围内的任何输入值 $x$，量化器定义中向下取整函数的参数：\n$$\n-\\frac{\\Delta}{2}  x  \\frac{\\Delta}{2}\n$$\n除以 $\\Delta$（因为 $\\Delta > 0$），我们得到：\n$$\n-\\frac{1}{2}  \\frac{x}{\\Delta}  \\frac{1}{2}\n$$\n不等式各部分都加上 $\\frac{1}{2}$，得到：\n$$\n0  \\frac{x}{\\Delta} + \\frac{1}{2}  1\n$$\n向下取整函数 $\\lfloor z \\rfloor$ 得到小于或等于 $z$ 的最大整数。对于任何满足 $0  z  1$ 的值 $z$，向下取整函数 $\\lfloor z \\rfloor$ 等于 $0$。因此，对于范围 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 内的任何输入 $x$，量化器输出为：\n$$\nQ(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} + \\frac{1}{2} \\right\\rfloor = \\Delta \\times 0 = 0\n$$\n由于对于所有的 $n$，输入样本 $x[n]$ 都在此范围内，量化器的输出恒为零：\n$$\nQ(x[n]) = 0 \\quad \\text{对于所有 } n\n$$\n这是小信号条件 $A  \\frac{\\Delta}{2}$ 的一个关键结果。信号太小，无法跨越任何量化阈值，因此它总是被映射到中心量化电平，对于中置型量化器而言，该电平为零。\n\n现在我们可以确定量化误差序列 $e[n]$：\n$$\ne[n] = Q(x[n]) - x[n] = 0 - x[n] = -x[n]\n$$\n代入 $x[n]$ 的表达式，我们有：\n$$\ne[n] = -A \\cos(\\omega_{0} n)\n$$\n问题要求的是时间平均均方误差。我们将 $e[n]$ 的表达式代入 MSE 的定义中：\n$$\n\\text{MSE} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left(-A \\cos(\\omega_{0} n)\\right)^{2} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} A^{2} \\cos^{2}(\\omega_{0} n)\n$$\n这恰好是信号 $x[n]$ 的平均功率的定义。为计算此极限，我们使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$：\n$$\n\\text{MSE} = A^{2} \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\left( \\frac{1 + \\cos(2\\omega_{0} n)}{2} \\right)\n$$\n$$\n\\text{MSE} = \\frac{A^{2}}{2} \\left( \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} 1 + \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\cos(2\\omega_{0} n) \\right)\n$$\n第一个极限很简单：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} 1 = \\lim_{N \\to \\infty} \\frac{N}{N} = 1\n$$\n第二个极限是余弦函数的时间平均值。正弦信号 $\\cos(\\Omega n)$ 的时间平均值为零，除非其频率 $\\Omega$ 是 $2\\pi$ 的整数倍（即它是一个直流信号）。在这里，频率是 $2\\omega_{0} = 4\\pi p/M$。这个频率是 $2\\pi$ 的整数倍当且仅当 $2p/M$ 是一个整数。考虑到 $p$ 和 $M$ 互质，这只在 $M=1$ 或 $M=2$ 时发生。这分别对应于直流输入或奈奎斯特频率输入的特殊情况。对于任何其他情况（即 $M>2$），$\\cos(2\\omega_{0} n)$ 的时间平均值为零。问题的表述意味着一般性，而非这些边缘情况。因此，我们采用标准结果：\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\cos(2\\omega_{0} n) = 0\n$$\n将这些结果代回 MSE 的表达式中，我们得到：\n$$\n\\text{MSE} = \\frac{A^{2}}{2} (1 + 0) = \\frac{A^{2}}{2}\n$$\n至此，均方误差的推导完成。\n\n问题还要求解释为什么加性白噪声 (AWN) 量化模型在这些条件下会失效。AWN 模型是一种常见的近似方法，其中量化误差 $e[n]$被建模为一个具有特定统计特性的随机噪声源。这些特性是：\n1.  误差与输入信号 $x[n]$ 不相关。\n2.  误差在区间 $(-\\frac{\\Delta}{2}, \\frac{\\Delta}{2})$ 上服从均匀概率分布。\n3.  误差功率谱是平坦的（白的）。\n\n在这些假设下，预测的均方误差为 $\\frac{\\Delta^{2}}{12}$。我们推导出的结果是 $\\frac{A^{2}}{2}$，这显然是不同的。我们严谨的构建过程通过违反其每一项核心假设，证明了 AWN 模型的失效：\n\n-   **违反不相关性**：我们发现 $e[n] = -x[n]$。误差是输入信号的缩放版本。误差与输入之间的互相关为 $R_{ex}[k] = E[e[n]x[n-k]] = E[(-x[n])x[n-k]] = -R_{xx}[k]$，其中 $R_{xx}[k]$ 是输入的自相关。误差与输入完全反相关，而不是不相关。\n\n-   **违反均匀分布**：误差信号 $e[n] = -A \\cos(\\omega_{0} n)$ 是一个正弦波。正弦信号的概率密度函数不是均匀的；它由 $p(y) = \\frac{1}{\\pi\\sqrt{A^2 - y^2}}$ 给出（对于 $|y|  A$）。这个分布在峰值 $\\pm A$ 附近高度集中，这与均匀分布相反。\n\n-   **违反白谱特性**：白噪声信号具有平坦的功率谱密度，意味着其功率分布在所有频率上。我们的误差信号 $e[n] = -A \\cos(\\omega_0 n)$ 是一个纯正弦波。其功率谱由位于频率 $\\pm\\omega_{0}$ 处的两个脉冲（离散谱线）组成。这是一个有音调的、高度结构化的谱，而不是白谱。这正是问题中提到的“可见的谱线”——误差的频谱是输入频谱的复制品。\n\n总而言之，对于低振幅输入 ($A  \\frac{\\Delta}{2}$)，量化器表现为一个非线性的“死区”设备，由此产生的误差完全由输入信号决定并与之相关。支撑 AWN 模型及其 $\\frac{\\Delta^{2}}{12}$ 功率公式的统计假设在这种情况下完全无效。", "answer": "$$\\boxed{\\frac{A^{2}}{2}}$$", "id": "2904665"}, {"introduction": "正如我们将信号从连续域转换到离散域一样，我们经常需要为连续时间系统创建离散时间的实现。一个至关重要的问题是，像稳定性这样的基本系统属性在转换过程中是否得以保留。本练习将研究在一种特定的离散化方法，即后向欧拉近似 (backward Euler approximation) 下，连续时间极点与离散时间极点之间的映射关系。这项实践[@problem_id:2904661]揭示了一个令人惊讶的事实：离散化方法的选择至关重要，因为某些方法可能将一个稳定的离散时间系统映射回一个不稳定的连续时间系统，这挑战了稳定性总是被保留的直观认识。", "problem": "一位工程师希望通过一种特定的离散化方法，将离散时间系统的稳定性与连续时间系统的稳定性联系起来。考虑一个由微分方程 $\\dot{x}(t) = s_{\\mathrm{c}}\\, x(t)$ 定义的标量线性时不变（LTI）连续时间系统，其中 $s_{\\mathrm{c}} \\in \\mathbb{C}$ 是连续时间极点。该工程师使用后向欧拉法对导数进行离散化，在时间 $(k+1)T$ 处，用 $\\left[x((k+1)T) - x(kT)\\right]/T$ 来近似 $\\dot{x}(t)$，其中采样周期 $T>0$。这产生了一个离散时间递推关系 $x[k+1] = z\\, x[k]$，其中的离散时间极点 $z \\in \\mathbb{C}$ 依赖于 $s_{\\mathrm{c}}$ 和 $T$。\n\n仅从连续时间的稳定性定义（所有极点 $s_{\\mathrm{c}}$ 满足 $\\operatorname{Re}(s_{\\mathrm{c}})  0$）和离散时间的稳定性定义（所有极点 $z$ 满足 $|z|  1$），以及上述的后向欧拉近似出发，完成以下任务：\n\n1. 推导由后向欧拉离散化所引出的从 $s_{\\mathrm{c}}$ 到 $z$ 的精确映射，并对其求逆，将 $s_{\\mathrm{c}}$ 表示为 $z$ 和 $T$ 的函数。\n2. 使用该逆映射，严格证明存在离散时间稳定极点 $z$（$|z|1$），其在该离散化下对应的连续时间极点 $s_{\\mathrm{c}}$ 满足 $\\operatorname{Re}(s_{\\mathrm{c}})>0$，从而为该方向上稳定性不被保持提供一个反例。\n3. 作为一个明确的反例，取 $T = 1\\,\\mathrm{s}$ 和一个在离散时间中稳定的极点 $z = -\\tfrac{1}{2}$。计算相应的连续时间极点 $s_{\\mathrm{c}}$，单位为 $\\mathrm{s}^{-1}$。无需四舍五入；请给出精确值。\n\n你的最终答案应该是计算出的 $s_{\\mathrm{c}}$ 所等于的单个实数，以 $\\mathrm{s}^{-1}$ 为单位（最终的方框答案中不要包含单位）。", "solution": "我们从标量连续时间线性时不变（LTI）系统 $\\dot{x}(t) = s_{\\mathrm{c}}\\, x(t)$ 开始，其中 $s_{\\mathrm{c}} \\in \\mathbb{C}$ 是连续时间极点。在时间 $(k+1)T$ 处，导数的后向欧拉近似由下式给出\n$$\n\\dot{x}((k+1)T) \\approx \\frac{x((k+1)T) - x(kT)}{T}.\n$$\n通过将 $\\dot{x}((k+1)T) \\approx s_{\\mathrm{c}}\\, x((k+1)T)$ 代入微分方程，我们得到\n$$\ns_{\\mathrm{c}}\\, x((k+1)T) = \\frac{x((k+1)T) - x(kT)}{T}.\n$$\n整理各项可得\n$$\nx((k+1)T) - T\\, s_{\\mathrm{c}}\\, x((k+1)T) = x(kT),\n$$\n因此\n$$\n\\bigl(1 - T\\, s_{\\mathrm{c}}\\bigr)\\, x((k+1)T) = x(kT).\n$$\n假设 $1 - T\\, s_{\\mathrm{c}} \\neq 0$，则可推出\n$$\nx((k+1)T) = \\frac{1}{1 - T\\, s_{\\mathrm{c}}}\\, x(kT).\n$$\n因此，离散时间递推关系为 $x[k+1] = z\\, x[k]$，其离散时间极点为\n$$\nz = \\frac{1}{1 - T\\, s_{\\mathrm{c}}}.\n$$\n这就是由后向欧拉离散化引出的从连续时间极点 $s_{\\mathrm{c}}$ 到离散时间极点 $z$ 的正向映射。\n\n为了对该关系求逆，并将 $s_{\\mathrm{c}}$ 表示为 $z$ 和 $T$ 的函数，我们求解 $s_{\\mathrm{c}}$：\n$$\nz = \\frac{1}{1 - T\\, s_{\\mathrm{c}}}\n\\;\\;\\Longrightarrow\\;\\;\n1 - T\\, s_{\\mathrm{c}} = \\frac{1}{z}\n\\;\\;\\Longrightarrow\\;\\;\nT\\, s_{\\mathrm{c}} = 1 - \\frac{1}{z}\n\\;\\;\\Longrightarrow\\;\\;\ns_{\\mathrm{c}}(z,T) = \\frac{1 - \\frac{1}{z}}{T} = \\frac{z - 1}{z\\, T}.\n$$\n\n我们现在证明，存在离散时间稳定的 $z$（$|z|1$），其对应的 $s_{\\mathrm{c}}(z,T)$ 具有正实部。考虑 $z$ 为实数且满足 $-1  z  0$ 的情况，此时 $z$ 严格位于单位圆盘内部，因此是离散时间稳定的。对于这样的 $z$，表达式简化为\n$$\ns_{\\mathrm{c}}(z,T) = \\frac{z - 1}{z\\, T}.\n$$\n当 $z \\in (-1,0)$ 且 $T>0$ 时，我们有 $z - 1  0$ 和 $z  0$，因此比值 $(z - 1)/z$ 是正数。更明确地说，\n$$\n\\frac{z - 1}{z} = 1 - \\frac{1}{z}.\n$$\n因为 $z \\in (-1,0)$，项 $\\frac{1}{z}$ 为负数且其绝对值大于 $1$，这意味着 $1 - \\frac{1}{z} > 0$。因此，对于任何 $T>0$，\n$$\n\\operatorname{Re}\\bigl(s_{\\mathrm{c}}(z,T)\\bigr) = \\frac{z - 1}{z\\, T} > 0.\n$$\n因此，存在离散时间极点 $z$（$|z|1$），在后向欧拉逆映射下，映射到具有正实部的连续时间极点。这为在该离散化下，从离散时间到连续时间的稳定性不被保持提供了所要求的反例。\n\n作为一个明确的数值实例，取 $T = 1$ 和 $z = -\\tfrac{1}{2}$。那么\n$$\ns_{\\mathrm{c}} = \\frac{z - 1}{z\\, T} = \\frac{-\\tfrac{1}{2} - 1}{\\left(-\\tfrac{1}{2}\\right)\\cdot 1} = \\frac{-\\tfrac{3}{2}}{-\\tfrac{1}{2}} = 3.\n$$\n该值为正，证实了尽管离散时间极点 $z = -\\tfrac{1}{2}$ 是稳定的，但相应的连续时间系统是不稳定的。所要求的最终答案是单个实数 $3$，单位为 $\\mathrm{s}^{-1}$。", "answer": "$$\\boxed{3}$$", "id": "2904661"}]}