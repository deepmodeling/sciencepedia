{"hands_on_practices": [{"introduction": "在分析复杂的量化系统之前，从第一性原理理解如何设计一个最优量化器至关重要。这个练习 [@problem_id:2898106] 将指导你为一个简单的均匀分布信源推导最优的判决边界和重建电平。通过这个过程，你将揭示出支配任何均方误差最优量化器的核心条件，为后续更高级的分析奠定基础。", "problem": "考虑一个无记忆的实值信源 $X$，其概率密度函数 (PDF) $f_{X}(x)$ 在有界区间 $\\left[-A, A\\right]$ 上均匀分布，其中 $A>0$ 已知，即当 $x\\in[-A,A]$ 时 $f_{X}(x)=\\frac{1}{2A}$，其他情况为 $0$。我们希望设计一个具有3个重建电平 $y_{1} < y_{2} < y_{3}$ 和两个判决边界 $t_1 < t_2$ 的标量量化器 $Q$。\n\n请找出能最小化均方误差 $D = \\mathbb{E}[(Q(X)-X)^2]$ 的最优判决边界、重建电平，并计算此最小失真 $D$。", "solution": "为了最小化均方误差 (MSE)，量化器必须满足两个条件（Lloyd-Max 条件）：\n1.  判决边界必须位于相邻重建电平的中点（最近邻原则）：$t_1 = \\frac{y_1+y_2}{2}$，$t_2 = \\frac{y_2+y_3}{2}$。\n2.  重建电平必须是其对应量化区间的质心（centroid）：\n    $y_1 = E[X | -A \\le X  t_1] = \\frac{-A+t_1}{2}$\n    $y_2 = E[X | t_1 \\le X  t_2] = \\frac{t_1+t_2}{2}$\n    $y_3 = E[X | t_2 \\le X \\le A] = \\frac{t_2+A}{2}$\n\n对于对称的均匀信源，最优量化器也是对称的。因此，$t_2 = -t_1$，$y_3 = -y_1$ 以及 $y_2 = 0$。\n将 $y_2=0$ 代入质心方程得到 $t_1+t_2=0$，这与对称性一致。\n将 $y_2=0$ 和 $t_2=-t_1$ 代入边界条件：$t_1 = y_1/2$，$t_2=y_3/2$。\n将 $t_1=y_1/2$ 代入第一个质心方程：$y_1 = \\frac{-A+y_1/2}{2} \\implies 2y_1 = -A + y_1/2 \\implies \\frac{3}{2}y_1 = -A \\implies y_1 = -\\frac{2A}{3}$。\n由此可得：\n-   重建电平：$y_1 = -2A/3$, $y_2 = 0$, $y_3 = 2A/3$。\n-   判决边界：$t_1 = y_1/2 = -A/3$, $t_2 = y_3/2 = A/3$。\n\n最小均方误差 $D$ 的计算如下：\n$D = \\frac{1}{2A} \\left[ \\int_{-A}^{-A/3} (x - (-\\frac{2A}{3}))^2 dx + \\int_{-A/3}^{A/3} (x - 0)^2 dx + \\int_{A/3}^{A} (x - \\frac{2A}{3})^2 dx \\right]$\n由于对称性，三个区域的误差积分是相等的。我们计算中间区域的积分：\n$\\int_{-A/3}^{A/3} x^2 dx = \\left[ \\frac{x^3}{3} \\right]_{-A/3}^{A/3} = \\frac{2A^3}{81}$。\n因此，总积分为 $3 \\times \\frac{2A^3}{81} = \\frac{2A^3}{27}$。\n最后，总失真为 $D = \\frac{1}{2A} \\left( \\frac{2A^3}{27} \\right) = \\frac{A^2}{27}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nt_1 = -A/3,  t_2 = A/3,  y_1 = -2A/3,  y_2 = 0,  y_3 = 2A/3,  D = A^2/27\n\\end{pmatrix}\n}\n$$", "id": "2898106"}, {"introduction": "在许多实际应用中，我们使用的并非是为特定信源完美定制的量化器，而是固定的、均匀的量化器，这引入了一个关键的权衡问题：如何设定量化器的动态范围。这个练习 [@problem_id:2898089] 将探讨在精细步长带来的颗粒噪声和信号削波引起的过载失真之间的平衡。掌握这种权衡是为高斯类信号（如语音、图像信号的变换系数）进行数字化时一个基本的设计考量。", "problem": "考虑一个实值、中置式、对称、均匀量化器，其饱和（限幅）阈值为 $\\pm X_{\\max}$，在粒化区域 $\\left[-X_{\\max},X_{\\max}\\right]$ 内总共有 $2^{N}$ 个量化区间。因此，量化器步长为 $\\Delta=2X_{\\max}/2^{N}$。输入信号 $x$ 是一个零均值、方差为 $\\sigma^{2}$ 的高斯随机变量，即 $x \\sim \\mathcal{N}(0,\\sigma^{2})$。当 $|x|\\leq X_{\\max}$ 时，输出 $y$ 等于量化值；当 $|x|X_{\\max}$ 时，输出 $y$ 等于 $\\operatorname{sgn}(x)\\,X_{\\max}$（过载硬限幅）。假设采用标准高分辨率粒化误差模型：在 $|x|\\leq X_{\\max}$ 的条件下，粒化误差 $e_{g}=y-x$ 在 $\\left(-\\Delta/2,\\Delta/2\\right)$ 上均匀分布且与 $x$ 独立；在过载情况下，$y=\\operatorname{sgn}(x)\\,X_{\\max}$ 且过载误差等于 $e_{o}=y-x=\\operatorname{sgn}(x)\\left(X_{\\max}-|x|\\right)$。\n\n定义归一化回退 $\\alpha=X_{\\max}/\\sigma$。使用高斯概率密度函数 (PDF) $\\varphi(z)=\\frac{1}{\\sqrt{2\\pi}}\\exp\\!\\left(-\\frac{z^{2}}{2}\\right)$ 和高斯尾部（互补累积分布）$Q(\\alpha)=\\int_{\\alpha}^{\\infty}\\varphi(z)\\,dz$。\n\n仅从这些定义和模型假设出发，并且除了所述的粒化误差模型外不引入任何额外的近似，对于固定的 $N$ 完成以下任务：\n- 计算过载概率 $P_{\\mathrm{ol}}=\\mathbb{P}(|x|X_{\\max})$，用 $\\alpha$ 表示。\n- 通过推导精确的总均方误差 $D(\\alpha;N,\\sigma)=\\mathbb{E}\\!\\left[(y-x)^{2}\\right]$，确定一个捕获回退 $\\alpha$（等效于 $X_{\\max}$）与粒化失真之间权衡的解析表达式。该表达式应是一个结合了粒化和过载贡献，并以 $\\alpha$、$N$ 和 $\\sigma$ 为变量的闭式函数。\n\n你的最终答案必须是单个闭式解析表达式，或一个包含过载概率和总均方误差（作为 $\\alpha$、$N$ 和 $\\sigma$ 的函数）的闭式解的单行矩阵。不要引入任何数值。不要提供不等式或待解方程；仅提供以 $\\alpha$、$N$、$\\sigma$、$\\varphi(\\cdot)$ 和 $Q(\\cdot)$ 表示的显式表达式。不需要四舍五入，也不需要单位。", "solution": "总均方误差 (MSE) $D$ 是粒化失真贡献 $D_g$ 和过载失真贡献 $D_o$ 的和。\n\n**1. 过载概率 $P_{\\mathrm{ol}}$**\n过载概率是输入 $|x|  X_{\\max}$ 的概率。对于零均值高斯输入，通过标准化变量 $z=x/\\sigma$，我们得到：\n$P_{\\mathrm{ol}} = \\mathbb{P}(|x/\\sigma| > X_{\\max}/\\sigma) = \\mathbb{P}(|z| > \\alpha) = 2Q(\\alpha)$，其中 $Q(\\cdot)$ 是标准高斯 Q 函数。\n\n**2. 总均方误差 $D(\\alpha; N, \\sigma)$**\n我们将总 MSE 分为两个部分计算。\n\n**粒化失真贡献 $D_g$**：\n这是在非过载区域 ($|x| \\le X_{\\max}$) 内的失真。根据高分辨率模型，此区域内的误差方差为 $\\Delta^2/12$。因此，粒化失真对总 MSE 的贡献是其方差乘以它发生的概率：\n$D_g = \\frac{\\Delta^2}{12} \\cdot \\mathbb{P}(|x| \\leq X_{\\max}) = \\frac{1}{12} \\left( \\frac{2X_{\\max}}{2^N} \\right)^2 (1 - P_{\\mathrm{ol}})$\n代入 $X_{\\max} = \\alpha\\sigma$ 和 $P_{\\mathrm{ol}} = 2Q(\\alpha)$，得到：\n$D_g = \\frac{4\\alpha^2\\sigma^2}{12 \\cdot 4^N} (1-2Q(\\alpha)) = \\frac{\\alpha^2\\sigma^2}{3 \\cdot 2^{2N}} (1-2Q(\\alpha))$\n\n**过载失真贡献 $D_o$**：\n这是在过载区域 ($|x| > X_{\\max}$) 内的失真，其中误差为 $e_o = \\operatorname{sgn}(x)X_{\\max} - x$。其期望平方为：\n$D_o = \\mathbb{E}[(e_o)^2 \\cdot \\mathbb{I}(|x| > X_{\\max})] = \\int_{|u|>X_{\\max}} (u - \\operatorname{sgn}(u)X_{\\max})^2 f_x(u) du$\n利用对称性，并进行变量替换 $z=u/\\sigma$:\n$D_o = 2 \\int_{X_{\\max}}^{\\infty} (u-X_{\\max})^2 \\frac{e^{-u^2/(2\\sigma^2)}}{\\sigma\\sqrt{2\\pi}} du = 2\\sigma^2 \\int_{\\alpha}^{\\infty} (z-\\alpha)^2 \\varphi(z) dz$\n该积分的结果是已知的：$\\int_{\\alpha}^{\\infty} (z-\\alpha)^2 \\varphi(z) dz = (\\alpha^2+1)Q(\\alpha) - \\alpha\\varphi(\\alpha)$。\n因此，$D_o = 2\\sigma^2 \\left( (\\alpha^2+1)Q(\\alpha) - \\alpha\\varphi(\\alpha) \\right)$。\n\n**总均方误差 $D$**：\n将两部分相加：\n$$ D(\\alpha; N, \\sigma) = D_g + D_o = \\frac{\\alpha^2\\sigma^2}{3 \\cdot 2^{2N}}(1 - 2Q(\\alpha)) + 2\\sigma^2 \\left( (\\alpha^2+1)Q(\\alpha) - \\alpha\\varphi(\\alpha) \\right) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2Q(\\alpha),  \\frac{\\alpha^2 \\sigma^2}{3 \\cdot 2^{2N}}(1 - 2Q(\\alpha)) + 2 \\sigma^2 \\left( (\\alpha^2+1)Q(\\alpha) - \\alpha \\varphi(\\alpha) \\right)\n\\end{pmatrix}\n}\n$$", "id": "2898089"}, {"introduction": "许多真实信号并非完全随机，而是具有显著的结构和时间相关性。这个练习 [@problem_id:2898103] 将演示我们如何利用这种相关性，通过预测编码来显著提高量化效率，正如在差分脉冲编码调制（DPCM）中所见。你将通过此例学习到，在量化前移除信号中的可预测信息，可以在保证同等失真水平的前提下，实现可观的比特率节省。", "problem": "考虑一个零均值、实数、宽平稳的一阶自回归信源，其模型由因果、稳定的递归式 $x[n] = a\\,x[n-1] + w[n]$ 给出，其中 $|a|  1$，$\\{w[n]\\}$ 是一个零均值、白色的高斯序列，其方差为 $\\sigma_{w}^{2}$。令 $S_{x}(\\omega)$ 表示 $x[n]$ 的功率谱密度。\n\n1) 设计一个因果、稳定的预滤波器 $P(z)$，它能白化 $x[n]$，即输出 $y[n] = (P\\star x)[n]$ 具有恒定的功率谱密度。您的设计必须从第一性原理出发，基于自回归定义和 $S_{x}(\\omega)$ 的分解进行论证。\n\n2) 现在比较在相同分辨率设计策略下运行的两个标量量化系统。两个系统都使用具有 $L = 2^{B}$ 个重构电平的均匀中升型标量量化器，并结合减性抖动（因此在高分辨率条件下，量化误差可以建模为方差为 $\\Delta^{2}/12$ 的加性、与输入无关的白噪声）。在两个系统中，量化器步长 $\\Delta$ 的选择是为了用 $L$ 个均匀步长覆盖量化器输入标准差的 $\\pm c$ 倍区间，即 $\\Delta = 2 c\\,\\sigma_{\\text{in}}/L$，其中 $c  0$ 是一个固定的过载裕度，$\\sigma_{\\text{in}}$ 是量化器输入信号的标准差。\n\n系统 (i) 是对 $x[n]$ 的直接标量量化（无预/后置滤波），产生重构信号 $\\hat{x}_{\\text{dir}}[n]$。\n\n系统 (ii) 是一个差分脉冲编码调制 (DPCM) 架构，它在闭环中采用了由您的 $P(z)$ 设计导出的一步线性预测器：编码器形成残差 $u[n] = x[n] - a\\,\\hat{x}[n-1]$，用相同的均匀量化器和减性抖动对 $u[n]$ 进行量化，解码器则重构 $\\hat{x}[n] = \\hat{u}[n] + a\\,\\hat{x}[n-1]$，其中 $\\hat{u}[n]$ 是量化器输出，预测器使用重构的过去样本。假设高分辨率加性噪声模型成立，并且所有相关过程都处于稳态。\n\n对于每个系统输出端给定的目标端到端均方误差失真 $D = \\mathbb{E}\\{|x[n] - \\hat{x}[n]|^{2}\\}$，请从第一性原理出发，推导所需比特数减少量\n$$\\Delta B \\triangleq B_{\\text{dir}} - B_{\\text{dpcm}},$$\n的一个显式闭式表达式，该表达式是 $a$、$\\sigma_{w}^{2}$ 和 $D$ 的函数。您的推导必须从自回归信源模型、您的 $P(z)$ 的白化性质以及带减性抖动的均匀量化的高分辨率加性噪声模型开始。在确定残差量化器输入端的方差时，您必须考虑 DPCM 环路中量化噪声的反馈。以比特为单位表示 $\\Delta B$。不需要进行数值代入，也不需要进行四舍五入。最终答案必须是单一的闭式解析表达式。", "solution": "该问题要求设计一个白化滤波器，然后比较直接标量量化 (SQ) 与差分脉冲编码调制 (DPCM) 的性能，推导在固定失真下的比特率节省量。\n\n**第一部分：白化预滤波器设计**\n\n信源是一个一阶自回归 (AR($1$)) 过程，$x[n] = a\\,x[n-1] + w[n]$，其中 $w[n]$ 是方差为 $\\sigma_{w}^{2}$ 的白噪声。其 Z 变换关系为 $X(z) = \\frac{W(z)}{1 - a z^{-1}}$。信源的功率谱密度 (PSD) 为 $S_{x}(\\omega) = \\frac{\\sigma_{w}^{2}}{|1 - a e^{-j\\omega}|^{2}}$。\n为了白化 $x[n]$，即得到一个具有恒定 PSD 的输出 $y[n]$，我们需要一个滤波器 $P(z)$ 使得 $|P(e^{j\\omega})|^2 S_x(\\omega)$ 为常数。选择 $P(z) = 1 - a z^{-1}$ 可以实现这一目标。这是一个因果、稳定的 FIR 滤波器。\n输出 $y[n]$ 的 Z 变换为 $Y(z) = P(z)X(z) = (1 - a z^{-1})\\frac{W(z)}{1 - a z^{-1}} = W(z)$。因此，输出 $y[n]$ 就是驱动噪声 $w[n]$，其 PSD 是常数 $\\sigma_w^2$。白化滤波器为 $P(z) = 1 - a z^{-1}$。\n\n**第二部分：比特率减少量分析**\n\n对于采用减性抖动的均匀量化器，高分辨率模型下的量化误差方差为 $\\sigma_{q}^{2} = \\Delta^{2}/12$。步长 $\\Delta = 2c\\,\\sigma_{\\text{in}}/2^{B}$，其中 $\\sigma_{\\text{in}}$ 是量化器输入的标准差。代入后得到率-失真-方差关系：\n$$\\sigma_{q}^{2} = \\frac{(2c\\,\\sigma_{\\text{in}}/2^{B})^{2}}{12} = \\frac{c^{2}}{3} \\sigma_{\\text{in}}^{2} 2^{-2B}$$\n\n**系统 (i)：直接标量量化 (SQ)**\n量化器的输入是 $x[n]$，因此 $\\sigma_{\\text{in}}^{2} = \\sigma_{x}^{2}$。AR(1) 过程的方差为 $\\sigma_{x}^{2} = \\frac{\\sigma_{w}^{2}}{1-a^{2}}$。\n端到端失真为 $D_{\\text{dir}} = \\sigma_{q,\\text{dir}}^{2}$。对于目标失真 $D$，我们有：\n$$D = \\frac{c^{2}}{3} \\sigma_{x}^{2} 2^{-2B_{\\text{dir}}} = \\frac{c^{2}}{3} \\left(\\frac{\\sigma_{w}^{2}}{1-a^{2}}\\right) 2^{-2B_{\\text{dir}}}$$\n求解 $2^{2B_{\\text{dir}}}$：\n$$2^{2B_{\\text{dir}}} = \\frac{c^{2}\\sigma_{w}^{2}}{3D(1-a^{2})}$$\n\n**系统 (ii)：差分脉冲编码调制 (DPCM)**\n在 DPCM 环路中，端到端误差 $e[n] = x[n] - \\hat{x}[n]$ 等于量化噪声的负值，即 $e[n] = -q_{\\text{dpcm}}[n]$。因此，失真 $D_{\\text{dpcm}} = \\sigma_{q,\\text{dpcm}}^{2}$。\n量化器的输入是残差信号 $u[n] = x[n] - a\\,\\hat{x}[n-1]$。我们计算其方差 $\\sigma_{u}^{2}$。\n$u[n] = x[n] - a(x[n-1] - e[n-1]) = (x[n] - a\\,x[n-1]) + a\\,e[n-1] = w[n] - a\\,q_{\\text{dpcm}}[n-1]$。\n由于驱动噪声 $w[n]$ 与过去的量化噪声 $q_{\\text{dpcm}}[n-1]$ 不相关，交叉项的期望为零。\n$$\\sigma_{u}^{2} = \\mathbb{E}[u[n]^2] = \\mathbb{E}[w[n]^2] + a^{2}\\mathbb{E}[q_{\\text{dpcm}}[n-1]^{2}] = \\sigma_{w}^{2} + a^{2}\\sigma_{q,\\text{dpcm}}^{2}$$\n对于目标失真 $D$，有 $\\sigma_{q,\\text{dpcm}}^{2} = D$，因此 DPCM 量化器输入信号的方差为 $\\sigma_{u}^{2} = \\sigma_{w}^{2} + a^{2}D$。\n代入率失真公式，其中 $\\sigma_{\\text{in}}^{2} = \\sigma_{u}^{2}$ 且 $\\sigma_{q}^{2} = D$：\n$$D = \\frac{c^{2}}{3} \\sigma_{u}^{2} 2^{-2B_{\\text{dpcm}}} = \\frac{c^{2}}{3}(\\sigma_{w}^{2} + a^{2}D) 2^{-2B_{\\text{dpcm}}}$$\n求解 $2^{2B_{\\text{dpcm}}}$：\n$$2^{2B_{\\text{dpcm}}} = \\frac{c^{2}(\\sigma_{w}^{2} + a^{2}D)}{3D}$$\n\n**比特率减少量 $\\Delta B$ 的计算**\n$\\Delta B = B_{\\text{dir}} - B_{\\text{dpcm}} = \\frac{1}{2} (\\log_2(2^{2B_{\\text{dir}}}) - \\log_2(2^{2B_{\\text{dpcm}} })) = \\frac{1}{2}\\log_{2}\\left(\\frac{2^{2B_{\\text{dir}}}}{2^{2B_{\\text{dpcm}}}}\\right)$\n代入前面推导的表达式：\n$$ \\Delta B = \\frac{1}{2}\\log_{2}\\left( \\frac{\\frac{c^{2}\\sigma_{w}^{2}}{3D(1-a^{2})}}{\\frac{c^{2}(\\sigma_{w}^{2} + a^{2}D)}{3D}} \\right) = \\frac{1}{2} \\log_{2}\\left( \\frac{\\sigma_{w}^{2}}{(1-a^{2})(\\sigma_{w}^{2} + a^{2}D)} \\right) $$", "answer": "$$\n\\boxed{\\frac{1}{2} \\log_{2}\\left( \\frac{\\sigma_{w}^{2}}{(1-a^{2})(\\sigma_{w}^{2} + a^{2}D)} \\right)}\n$$", "id": "2898103"}]}