{"hands_on_practices": [{"introduction": "在编写任何代码之前，我们必须首先牢固掌握信号重建背后的数学保证。这项练习 [@problem_id:2904354] 将挑战你从基本原理出发，推导奈奎斯特采样率，并证明香农插值级数的收敛性。这确保了重建公式不仅仅是一个“配方”，而是一个数学上严谨可靠的过程。", "problem": "一个实值连续时间信号 $x(t)$ 的连续时间傅里叶变换 $X(\\omega)$ 的支撑集为紧区间 $\\{\\,\\omega \\in \\mathbb{R} : |\\omega| \\leq 0.4\\pi/T_{0}\\,\\}$，其中 $T_{0}  0$ 是一个给定的时间尺度（单位为秒），$\\omega$ 的单位为弧度/秒。假设 $X(\\omega)$ 在 $\\mathbb{R}$ 上是二次连续可微的，对于 $|\\omega| \\geq 0.4\\pi/T_{0}$ 满足 $X(\\omega) = 0$，并具有边缘正则性 $X(\\pm 0.4\\pi/T_{0}) = 0$ 和 $X'(\\pm 0.4\\pi/T_{0}) = 0$。您以采样周期 $T$ 对 $x(t)$ 进行均匀采样，并尝试使用一个理想低通插值进行完美重构，其通带覆盖 $X(\\omega)$ 的基带支撑。\n\n任务：\n- 仅使用关于采样下的频谱复制和频谱副本不重叠的基本原理，确定仍能保证从均匀样本中完美重构的最大采样周期 $T_{\\max}$（单位为秒）。以 $T_{0}$ 的闭式表达式报告您的最终答案。\n- 在相同假设下，考虑香农插值级数 $x(t) = \\sum_{n\\in\\mathbb{Z}} x(nT)\\,\\operatorname{sinc}\\!\\big((t-nT)/T\\big)$，其中 $\\operatorname{sinc}(u) \\triangleq \\sin(\\pi u)/(\\pi u)$。从第一性原理和 $X(\\omega)$ 给定的正则性出发，严格验证对于每个固定的 $t \\in \\mathbb{R}$，当 $T = T_{\\max}$（如上求得）时，该级数绝对收敛。\n\n将您的最终答案表示为关于 $T_{\\max}$ 的、以 $T_{0}$ 表示的单一符号表达式（最终答案中不含单位）。无需进行数值四舍五入。", "solution": "所述问题具有科学依据、是适定且客观的。其中没有矛盾或谬误。我们直接进行求解。该问题包括两个任务。我们将按顺序解决它们。\n\n首先，我们确定保证完美重构的最大采样周期，记为 $T_{\\max}$。\n连续时间信号 $x(t)$ 的傅里叶变换 $X(\\omega)$ 仅在区间 $|\\omega| \\leq 0.4\\pi/T_{0}$ 上非零。这意味着该信号是带限的。信号的最大频率，或带宽，为 $\\omega_M = 0.4\\pi/T_{0}$。\n\n当以周期 $T$ 对 $x(t)$进行采样时，所得采样信号（可建模为 $x_s(t) = \\sum_{n \\in \\mathbb{Z}} x(nT)\\delta(t-nT)$）的傅里叶变换由 $X(\\omega)$ 的缩放和平移副本叠加而成：\n$$X_s(\\omega) = \\frac{1}{T} \\sum_{k \\in \\mathbb{Z}} X(\\omega - k\\omega_s)$$\n其中 $\\omega_s = 2\\pi/T$ 是采样频率，单位为弧度/秒。\n\n为实现完美重构，频谱副本之间不得重叠。此条件即为奈奎斯特准则。基带频谱的支撑集为 $[-\\omega_M, \\omega_M]$。对于 $k=1$，第一个频谱副本以 $\\omega_s$ 为中心，其支撑集为 $[\\omega_s - \\omega_M, \\omega_s + \\omega_M]$。为防止基带频谱与第一个副本重叠，基带频谱的上边缘必须小于或等于第一个副本的下边缘。用数学方式表示为：\n$$\\omega_M \\leq \\omega_s - \\omega_M$$\n该不等式可简化为：\n$$\\omega_s \\geq 2\\omega_M$$\n这是避免混叠的基本条件。满足此条件的最小采样频率是奈奎斯特率，$\\omega_{s, \\text{min}} = 2\\omega_M$。更低的采样频率会导致混叠，使完美重构无法实现。\n\n问题要求的是保证完美重构的最大采样周期 $T$。由于采样周期 $T$ 和采样频率 $\\omega_s$ 通过 $T = 2\\pi/\\omega_s$ 成反比关系，最大采样周期 $T_{\\max}$ 对应于最小采样频率 $\\omega_{s, \\text{min}}$。\n$$T_{\\max} = \\frac{2\\pi}{\\omega_{s, \\text{min}}} = \\frac{2\\pi}{2\\omega_M} = \\frac{\\pi}{\\omega_M}$$\n代入给定的 $\\omega_M$ 值：\n$$T_{\\max} = \\frac{\\pi}{0.4\\pi/T_{0}} = \\frac{1}{0.4} T_{0} = \\frac{1}{4/10} T_{0} = \\frac{10}{4} T_{0} = \\frac{5}{2} T_{0}$$\n\n其次，我们必须验证当 $T = T_{\\max} = \\frac{5}{2} T_{0}$ 时，香农插值级数的绝对收敛性。插值公式如下：\n$$x(t) = \\sum_{n\\in\\mathbb{Z}} x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)$$\n为验证绝对收敛性，我们必须证明对于任意固定的 $t \\in \\mathbb{R}$，各项绝对值之和是有限的：\n$$\\sum_{n\\in\\mathbb{Z}} \\left|x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right|  \\infty$$\n当 $|n|$ 很大时，此级数的收敛性取决于样本 $|x(nT)|$ 的衰减率。当 $|t| \\to \\infty$ 时，$x(t)$ 的衰减率由其傅里叶变换 $X(\\omega)$ 的光滑性决定。信号 $x(t)$ 由 $X(\\omega)$ 的傅里叶逆变换给出：\n$$x(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} X(\\omega) e^{j\\omega t} d\\omega = \\frac{1}{2\\pi} \\int_{-\\omega_M}^{\\omega_M} X(\\omega) e^{j\\omega t} d\\omega$$\n其中 $\\omega_M = 0.4\\pi/T_{0}$。我们使用分部积分法，注意到 $e^{j\\omega t} = \\frac{1}{jt} \\frac{d}{d\\omega}e^{j\\omega t}$：\n$$x(t) = \\frac{1}{2\\pi} \\left[ X(\\omega) \\frac{e^{j\\omega t}}{jt} \\right]_{-\\omega_M}^{\\omega_M} - \\frac{1}{2\\pi jt} \\int_{-\\omega_M}^{\\omega_M} X'(\\omega) e^{j\\omega t} d\\omega$$\n问题中指出 $X(\\pm \\omega_M) = 0$，因此边界项消失。\n$$x(t) = -\\frac{1}{2\\pi jt} \\int_{-\\omega_M}^{\\omega_M} X'(\\omega) e^{j\\omega t} d\\omega$$\n我们再次应用分部积分法：\n$$x(t) = -\\frac{1}{2\\pi jt} \\left( \\left[ X'(\\omega) \\frac{e^{j\\omega t}}{jt} \\right]_{-\\omega_M}^{\\omega_M} - \\frac{1}{jt} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right)$$\n问题中指出 $X'(\\pm \\omega_M) = 0$，因此该边界项也消失。\n$$x(t) = -\\frac{1}{2\\pi jt} \\left( -\\frac{1}{jt} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right) = \\frac{1}{2\\pi (jt)^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega = -\\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega$$\n现在，我们对 $x(t)$ 的大小进行界定：\n$$|x(t)| = \\left| -\\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} X''(\\omega) e^{j\\omega t} d\\omega \\right| \\leq \\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} |X''(\\omega) e^{j\\omega t}| d\\omega = \\frac{1}{2\\pi t^2} \\int_{-\\omega_M}^{\\omega_M} |X''(\\omega)| d\\omega$$\n由于 $X(\\omega)$ 是二次连续可微的，$X''(\\omega)$ 在紧区间 $[-\\omega_M, \\omega_M]$ 上是连续的。因此，它是有界的。令 $M_2 = \\max_{\\omega \\in [-\\omega_M, \\omega_M]} |X''(\\omega)|$。该积分有界：$\\int_{-\\omega_M}^{\\omega_M} |X''(\\omega)| d\\omega \\leq M_2 (2\\omega_M)$。\n因此，对于 $t \\neq 0$：\n$$|x(t)| \\leq \\frac{2\\omega_M M_2}{2\\pi t^2} = \\frac{\\omega_M M_2}{\\pi t^2}$$\n这表明 $|x(t)|$ 以 $O(1/t^2)$ 的速率衰减。对于样本 $x(nT)$，其中 $n \\in \\mathbb{Z}$ 且 $n \\neq 0$：\n$$|x(nT)| \\leq \\frac{\\omega_M M_2}{\\pi (nT)^2} = \\frac{C_1}{n^2}$$\n其中 $C_1 = \\frac{\\omega_M M_2}{\\pi T^2}$ 是一个常数。\n\n接下来，我们考察当 $|n|$ 很大时 sinc 项，假设 $t/T$ 不是整数：\n$$\\left|\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right| = \\left|\\operatorname{sinc}\\!\\left(\\frac{t}{T}-n\\right)\\right| = \\left| \\frac{\\sin(\\pi(t/T - n))}{\\pi(t/T - n)} \\right| = \\frac{|\\sin(\\pi t/T)|}{\\pi|t/T - n|}$$\n对于大的 $|n|$，此项表现为：\n$$\\frac{|\\sin(\\pi t/T)|}{\\pi|n|} = \\frac{C_2}{|n|}$$\n其中 $C_2 = \\frac{|\\sin(\\pi t/T)|}{\\pi}$ 是一个常数。\n\n现在可以对 $n \\neq 0$ 时绝对收敛级数的通项进行界定：\n$$|a_n| = \\left|x(nT)\\,\\operatorname{sinc}\\!\\left(\\frac{t-nT}{T}\\right)\\right| \\leq \\left(\\frac{C_1}{n^2}\\right) \\left(\\frac{C_2}{|n|}\\right) = \\frac{C_1 C_2}{|n|^3}$$\n和 $\\sum_{n\\in\\mathbb{Z}, n \\neq 0} |a_n|$ 由 $2 \\sum_{n=1}^\\infty \\frac{C_1 C_2}{n^3}$ 从上方界定。这是一个 p-级数，其中 $p=3$。由于 $p1$，该级数收敛。根据比较判别法，级数 $\\sum_{n\\in\\mathbb{Z}, n\\neq 0} |a_n|$ 收敛。当 $n=0$ 时的项是有限的，即 $|x(0)\\operatorname{sinc}(t/T)|$。因此，整个级数绝对收敛。\n\n如果 $t/T$ 是一个整数，例如 $t/T = k$，则 $t=kT$。级数变为 $\\sum_{n\\in\\mathbb{Z}} x(nT)\\operatorname{sinc}(k-n)$。由于当 $m=0$ 时 $\\operatorname{sinc}(m)=1$，而当 $m$ 为任意非零整数时 $\\operatorname{sinc}(m)=0$，所以该和只有一个非零项 $x(kT)$，因此是平凡收敛的。证明完毕。", "answer": "$$\\boxed{\\frac{5}{2} T_{0}}$$", "id": "2904354"}, {"introduction": "在建立了理论基础之后，让我们将其付诸实践。这个动手问题 [@problem_id:2904292] 将指导你完成惠特克-香农插值公式的数值实现。通过这个过程，你将能够从离散样本中重建连续时间信号，亲眼见证理想理论的实际效果。", "problem": "给定一个连续时间信号 $x(t)$，其严格带限于角频率 $|\\omega| \\le \\Omega_{\\mathrm{b}}$，其中 $\\Omega_{\\mathrm{b}}  \\pi/T$，$T  0$ 是一个固定的采样周期。以速率 $1/T$ 进行理想冲激采样，产生离散时间样本 $x[n] = x(nT)$（对所有整数 $n$），以及冲激串 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\,\\delta(t - nT)$。您将 $s(t)$ 输入一个稳定的线性时不变（LTI）重构系统，其冲激响应为 $h(t)$，以产生输出 $y(t)$。\n\n任务1（从基本原理推导）。从以下基本依据出发：\n- 连续时间傅里叶变换（CTFT）的定义：$X(\\omega) = \\int_{-\\infty}^{\\infty} x(t) e^{-j\\omega t}\\, dt$ 及其逆变换 $x(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega) e^{j\\omega t}\\, d\\omega$，\n- 冲激采样信号的频谱：$S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - \\frac{2\\pi k}{T})$，\n- 频域中的LTI输入-输出关系：$Y(\\omega) = H(\\omega) S(\\omega)$，\n\n在无混叠条件 $\\Omega_{\\mathrm{b}}  \\pi/T$ 下，推导出能够对所有 $|\\omega| \\le \\Omega_{\\mathrm{b}}$ 实现完美重构 $Y(\\omega) = X(\\omega)$ 的唯一理想低通滤波器 $H(\\omega)$，推导过程中不得假定任何插值快捷公式。然后，推导其对应的时域插值核 $h(t)$，并证明重构信号可以写成卷积叠加的形式\n$$\ny(t) = \\sum_{n\\in\\mathbb{Z}} x[n]\\, h(t - nT).\n$$\n您必须得到以归一化sinc函数 $\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$ 表示的 $h(t)$ 的闭合形式。\n\n任务2（重构的数值计算）。使用任务1的结果，在指定时刻数值计算 $y(t)$，方法是将无穷级数替换为对一个足够大的整数 $N$ 的对称截断 $|n| \\le N$。使用任务1中归一化sinc函数的定义。对于以下所有计算，设置 $N = 2000$，并将报告的每个 $y(t)$ 值使用标准的“四舍五入到最近，偶数优先”规则，四舍五入到小数点后9位。\n\n角度量必须以弧度为单位进行解释。本问题不涉及物理单位。\n\n测试套件。对于每个测试用例，离散时间序列 $x[n]$ 以 $n$、$T$ 和固定的实数参数直接给出。所有频率参数都严格在奈奎斯特极限 $1/(2T)$ 内，确保 $\\Omega_{\\mathrm{b}}  \\pi/T$。对于每个测试用例，使用 $N = 2000$ 的截断插值和，计算并报告在给定时间点的重构值列表 $[y(t_1),\\dots,y(t_m)]$。\n\n- 测试用例A（多音，单位采样周期）：\n  - 参数：$T = 1$, $\\phi = \\pi/7$。\n  - 序列：$x[n] = \\cos(2\\pi \\cdot 0.2 \\cdot nT) + 0.5 \\,\\sin(2\\pi \\cdot 0.3 \\cdot nT + \\phi)$。\n  - 求值时间：$t \\in \\{0, 0.25, 0.5, 1.25, 2\\}$。\n\n- 测试用例B（近奈奎斯特单音，单位采样周期）：\n  - 参数：$T = 1$。\n  - 序列：$x[n] = \\cos(2\\pi \\cdot 0.49 \\cdot nT)$。\n  - 求值时间：$t \\in \\{0, 0.5, 1, 1.5, 2\\}$。\n\n- 测试用例C（非单位采样周期，包含直流（DC）分量和相位）：\n  - 参数：$T = 0.8$, $\\theta = -\\pi/5$。\n  - 序列：$x[n] = 0.1 + 0.7 \\cos\\!\\big(2\\pi \\cdot 0.25 \\cdot (nT)\\big) + 0.4 \\sin\\!\\big(2\\pi \\cdot 0.6 \\cdot (nT) + \\theta\\big)$。\n  - 求值时间：$t \\in \\{0, 0.8, 1.6, 2.4, 4.0\\}$。\n\n计算说明。实现\n$$\ny(t) \\approx \\sum_{n=-N}^{N} x[n]\\, h(t - nT), \\quad h(t) = \\operatorname{sinc}\\!\\left(\\frac{t}{T}\\right)\n$$\n其中 $N = 2000$。尽可能使用向量化计算以避免不必要的数值误差并确保计算效率。使用连续性扩展 $\\operatorname{sinc}(0) = 1$ 来确保 $\\operatorname{sinc}(0)$ 的稳定求值。\n\n答案规格和输出格式。您的程序应生成单行输出，其中包含一个无空格的逗号分隔嵌套列表形式的结果，格式为\n$[[y\\_A(t\\_1),\\dots,y\\_A(t\\_5)],[y\\_B(t\\_1),\\dots,y\\_B(t\\_5)],[y\\_C(t\\_1),\\dots,y\\_C(t\\_5)]]$，\n其中每个内部列表分别对应于测试用例A、B和C，每个数值条目是一个四舍五入到小数点后9位的十进制字符串。例如，一个正确形状的输出行看起来会像 $[[0.000000000,1.234000000],[...],[...]]$，但其中包含的是三个测试用例的实际计算值。", "solution": "该问题是有效的，因为它基于信号处理的科学原理，是适定且客观的。它为理论推导和数值计算提供了所有必要的信息。我们将开始求解。\n\n**任务1：理想重构滤波器和插值公式的推导**\n\n目标是找到一个冲激响应为 $h(t)$ 的线性时不变（LTI）系统，该系统能从其样本 $x[n] = x(nT)$ 中完美重构连续时间信号 $x(t)$。该重构系统的输入是一个冲激串 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(t-nT)$。\n\n此推导的基础是给定的频域关系：\n1.  输出频谱 $Y(\\omega)$ 通过 $Y(\\omega) = H(\\omega) S(\\omega)$ 与输入频谱 $S(\\omega)$ 和系统的频率响应 $H(\\omega)$ 相关联。\n2.  冲激串的频谱 $S(\\omega)$ 是原始信号频谱 $X(\\omega)$ 的周期性复制：\n    $$S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X\\left(\\omega - \\frac{2\\pi k}{T}\\right)$$\n    其中 $T$ 是采样周期。令 $\\omega_s = 2\\pi/T$ 为采样角频率。因此，该关系为 $S(\\omega) = \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s)$。\n\n信号 $x(t)$ 严格带限于 $|\\omega| \\le \\Omega_{\\mathrm{b}}$，这意味着其连续时间傅里叶变换（CTFT）$X(\\omega)$ 对所有 $|\\omega|  \\Omega_{\\mathrm{b}}$ 均为零。问题陈述了无混叠条件 $\\Omega_{\\mathrm{b}}  \\pi/T$，这等价于 $\\Omega_{\\mathrm{b}}  \\omega_s/2$。此条件确保了 $S(\\omega)$ 中的频谱副本不会重叠。第 $k$ 个副本 $X(\\omega - k\\omega_s)$ 的频谱支撑区间是 $[k\\omega_s - \\Omega_{\\mathrm{b}}, k\\omega_s + \\Omega_{\\mathrm{b}}]$。由于无混叠条件，基带频谱（$k=0$ 时，以 $\\omega=0$ 为中心）与一阶谐波副本（$k=\\pm 1$ 时，以 $\\omega=\\pm\\omega_s$ 为中心）是不相交的。具体来说，基带频谱结束于 $\\Omega_{\\mathrm{b}}$，而第一个副本开始于 $\\omega_s - \\Omega_{\\mathrm{b}}$。因为 $\\Omega_{\\mathrm{b}}  \\omega_s/2$，我们有 $\\omega_s - \\Omega_{\\mathrm{b}} > \\omega_s - \\omega_s/2 = \\omega_s/2 > \\Omega_{\\mathrm{b}}$。\n\n完美重构要求输出信号 $y(t)$ 与原始信号 $x(t)$ 完全相同，这意味着它们的频谱必须相等：$Y(\\omega) = X(\\omega)$ 对所有 $\\omega$ 成立。\n\n结合给定的关系，我们要求：\n$$X(\\omega) = H(\\omega) S(\\omega) = H(\\omega) \\left[ \\frac{1}{T}\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s) \\right]$$\n\n为了满足这个等式，我们设计的滤波器 $H(\\omega)$ 需要执行两个功能：\n1.  隔离 $S(\\omega)$ 的基带分量（$k=0$ 项）。\n2.  缩放此分量以恢复原始频谱 $X(\\omega)$。\n\n让我们定义一个截止频率为 $\\omega_c$ 的理想低通滤波器。为了隔离仅在 $|\\omega| \\le \\Omega_{\\mathrm{b}}$ 内非零的基带分量，同时完全抑制所有更高频率的副本（其中第一个副本始于 $\\omega_s - \\Omega_{\\mathrm{b}}$），我们必须选择一个截止频率 $\\omega_c$ 满足 $\\Omega_{\\mathrm{b}} \\le \\omega_c \\le \\omega_s - \\Omega_{\\mathrm{b}}$。一个独立于具体 $\\Omega_{\\mathrm{b}}$ 的规范选择是奈奎斯特频率，$\\omega_c = \\omega_s/2 = \\pi/T$。\n\n在通带频率范围内，即 $|\\omega| \\le \\pi/T$，由于无混叠条件，所有其他 $k \\neq 0$ 的项在此范围内均为零，因此级数 $\\sum_{k\\in\\mathbb{Z}} X(\\omega - k\\omega_s)$ 简化为单项 $X(\\omega)$。因此，对于 $|\\omega| \\le \\pi/T$，重构方程变为：\n$$X(\\omega) = H(\\omega) \\left( \\frac{1}{T} X(\\omega) \\right)$$\n为了使此式对任何非平凡的 $X(\\omega)$ 都成立，滤波器在此频带内的响应必须是 $H(\\omega) = T$。\n\n对于此通带外的所有频率 $|\\omega|  \\pi/T$，滤波器必须具有零增益以消除不需要的频谱副本。因此，唯一的理想低通滤波器频率响应是：\n$$H(\\omega) = \\begin{cases} T,  \\text{if } |\\omega| \\le \\pi/T \\\\ 0,  \\text{if } |\\omega| > \\pi/T \\end{cases}$$\n这是一个宽度为 $2\\pi/T$、高度为 $T$ 的矩形函数。\n\n接下来，我们通过对 $H(\\omega)$ 进行连续时间傅里叶逆变换来推导其对应的冲激响应 $h(t)$：\n$$h(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} H(\\omega) e^{j\\omega t} \\,d\\omega$$\n代入 $H(\\omega)$ 的表达式：\n$$h(t) = \\frac{1}{2\\pi} \\int_{-\\pi/T}^{\\pi/T} T e^{j\\omega t} \\,d\\omega = \\frac{T}{2\\pi} \\left[ \\frac{e^{j\\omega t}}{jt} \\right]_{-\\pi/T}^{\\pi/T}$$\n对于 $t \\neq 0$：\n$$h(t) = \\frac{T}{2\\pi j t} \\left( e^{j\\pi t/T} - e^{-j\\pi t/T} \\right)$$\n使用欧拉公式 $e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$：\n$$h(t) = \\frac{T}{2\\pi j t} \\left( 2j \\sin\\left(\\frac{\\pi t}{T}\\right) \\right) = \\frac{T}{\\pi t} \\sin\\left(\\frac{\\pi t}{T}\\right)$$\n为了用归一化sinc函数 $\\operatorname{sinc}(u) = \\frac{\\sin(\\pi u)}{\\pi u}$ 来表示，我们重新整理 $h(t)$ 的表达式：\n$$h(t) = \\frac{\\sin\\left(\\pi \\frac{t}{T}\\right)}{\\frac{\\pi t}{T}} = \\operatorname{sinc}\\left(\\frac{t}{T}\\right)$$\n对于 $t=0$ 的情况，该值可以通过取极限或从积分中求得：$h(0) = \\frac{1}{2\\pi}\\int_{-\\pi/T}^{\\pi/T} T \\,d\\omega = \\frac{T}{2\\pi} \\left( \\frac{2\\pi}{T} \\right) = 1$。这对应于 $\\operatorname{sinc}(0)=1$。\n\n最后，我们证明重构信号 $y(t)$ 可以表示为卷积叠加。输出 $y(t)$ 是输入冲激串 $s(t)$ 与滤波器冲激响应 $h(t)$ 的卷积：\n$$y(t) = s(t) * h(t) = \\int_{-\\infty}^{\\infty} s(\\tau) h(t - \\tau) \\,d\\tau$$\n代入 $s(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(t - nT)$ 的定义：\n$$y(t) = \\int_{-\\infty}^{\\infty} \\left( \\sum_{n\\in\\mathbb{Z}} x[n] \\delta(\\tau - nT) \\right) h(t - \\tau) \\,d\\tau$$\n根据线性性质，我们可以交换求和与积分的顺序：\n$$y(t) = \\sum_{n\\in\\mathbb{Z}} x[n] \\int_{-\\infty}^{\\infty} \\delta(\\tau - nT) h(t - \\tau) \\,d\\tau$$\n利用狄拉克δ函数的筛选性质，$\\int_{-\\infty}^{\\infty} f(\\tau) \\delta(\\tau - a) \\,d\\tau = f(a)$，其中 $f(\\tau) = h(t-\\tau)$ 且 $a=nT$：\n$$y(t) = \\sum_{n\\in\\mathbb{Z}} x[n] h(t - nT)$$\n这就完成了惠特克-香农插值公式的推导。\n\n**任务2：数值计算**\n\n上面推导的公式通过将无穷级数截断为 $|n| \\le N$ 的对称窗口来实现，其中 $N=2000$。在时间 $t$ 的重构信号近似为：\n$$\ny(t) \\approx \\sum_{n=-N}^{N} x[n] \\operatorname{sinc}\\left(\\frac{t - nT}{T}\\right)\n$$\n提供的测试用例使用此公式进行评估。实现利用了向量化运算以提高效率，并使用 `numpy.sinc` 来稳定、精确地计算归一化sinc函数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the signal reconstruction problem for the three given test cases.\n    \"\"\"\n    N = 2000\n    n_range = np.arange(-N, N + 1)\n\n    # --- Test Case A ---\n    T_A = 1.0\n    phi_A = np.pi / 7.0\n    times_A = [0.0, 0.25, 0.5, 1.25, 2.0]\n    \n    # Generate the samples x[n] for case A\n    nT_A = n_range * T_A\n    x_n_A = np.cos(2 * np.pi * 0.2 * nT_A) + 0.5 * np.sin(2 * np.pi * 0.3 * nT_A + phi_A)\n    \n    results_A = []\n    for t in times_A:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_A = (t - nT_A) / T_A\n        h_vals_A = np.sinc(sinc_arg_A)\n        # Compute y(t) as the dot product (sum of products)\n        y_t = np.dot(x_n_A, h_vals_A)\n        results_A.append(y_t)\n\n    # --- Test Case B ---\n    T_B = 1.0\n    times_B = [0.0, 0.5, 1.0, 1.5, 2.0]\n    \n    # Generate the samples x[n] for case B\n    nT_B = n_range * T_B\n    x_n_B = np.cos(2 * np.pi * 0.49 * nT_B)\n    \n    results_B = []\n    for t in times_B:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_B = (t - nT_B) / T_B\n        h_vals_B = np.sinc(sinc_arg_B)\n        # Compute y(t)\n        y_t = np.dot(x_n_B, h_vals_B)\n        results_B.append(y_t)\n\n    # --- Test Case C ---\n    T_C = 0.8\n    theta_C = -np.pi / 5.0\n    times_C = [0.0, 0.8, 1.6, 2.4, 4.0]\n\n    # Generate the samples x[n] for case C\n    nT_C = n_range * T_C\n    x_n_C = 0.1 + 0.7 * np.cos(2 * np.pi * 0.25 * nT_C) + 0.4 * np.sin(2 * np.pi * 0.6 * nT_C + theta_C)\n\n    results_C = []\n    for t in times_C:\n        # Calculate kernel values h(t - nT)\n        sinc_arg_C = (t - nT_C) / T_C\n        h_vals_C = np.sinc(sinc_arg_C)\n        # Compute y(t)\n        y_t = np.dot(x_n_C, h_vals_C)\n        results_C.append(y_t)\n\n    all_results = [results_A, results_B, results_C]\n\n    # Format the output string according to the specification.\n    # The f-string format specifier .9f rounds to 9 decimal places using\n    # standard rounding (round half to even), as required.\n    output_str = f\"[{','.join([f'[{\",\".join([f\"{val:.9f}\" for val in res_list])}]' for res_list in all_results])}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2904292"}, {"introduction": "尽管Sinc插值对于带限信号是理论上完美的，但其无限长的脉冲响应使其在实际应用中并不可行。这项练习 [@problem_id:2904294] 介绍了一种流行且计算高效的替代方法：自然三次样条插值。通过实现该方法并分析其误差，你将深入了解不同实用插值方法之间的权衡。", "problem": "您的任务是评估自然三次样条插值应用于正弦信号时的插值误差。考虑区间 $[0,1]$ 上的函数 $x(t) = \\sin(\\omega t)$，其中角度以弧度为单位。设采样网格为 $t_k = k h$，$k \\in \\{0,1,\\dots,N\\}$，其中 $h = 1/N$。采样序列为 $x_k = x(t_k) = \\sin(\\omega t_k)$。仅使用样本点 $\\{(t_k, x_k)\\}_{k=0}^{N}$，构建自然三次样条插值函数 $S(t)$，它是 $[0,1]$ 上唯一的二次连续可微的分段三次函数，它插值于这些样本点并满足自然边界条件 $S''(0) = 0$ 和 $S''(1) = 0$。\n\n您的程序必须：\n- 实现自然三次样条插值，从 $\\{(t_k, x_k)\\}$ 获得 $S(t)$。\n- 对于 $[0,1]$ 上 $M$ 个等距点的密集评估网格，计算最大绝对插值误差\n$$\ne(\\omega) = \\max_{t \\in \\{0, \\frac{1}{M-1}, \\dots, 1\\}} \\left| \\sin(\\omega t) - S(t) \\right|.\n$$\n\n推理的基本依据：使用插值的定义和三次样条的标准平滑性质，结合具有连续导数的函数的泰勒定理，来论证光滑函数的插值误差的行为和界限。\n\n测试套件和参数：\n- 使用 $N = 64$ (因此 $h = 1/64$) 。\n- 在 $[0,1]$ 上使用 $M = 10001$ 个密集评估点。\n- 对以下 $\\omega$ 值（单位时间的弧度数）评估误差：$\\omega \\in \\{0, \\frac{\\pi}{4}, \\pi, 4\\pi, 12\\pi\\}$。\n\n输出规范：\n- 对于按给定顺序的每个 $\\omega$，计算如上定义的 $e(\\omega)$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[e(\\omega_1),e(\\omega_2),\\dots]$。\n- 在打印前将每个 $e(\\omega)$ 四舍五入到 $10$ 位小数。\n\n所有计算都是纯数学的，角度以弧度为单位。不涉及物理单位。最终输出必须是指定格式的单行文本。", "solution": "在尝试给出解决方案之前，需对问题进行验证。\n\n### 步骤1：提取给定信息\n- 待插值函数：$x(t) = \\sin(\\omega t)$\n- 插值区间：$[0, 1]$\n- 区间数量：$N = 64$\n- 采样步长：$h = 1/N = 1/64$\n- 采样网格（节点）：$t_k = k h$，对于 $k \\in \\{0, 1, \\dots, N\\}$\n- 样本值：$x_k = x(t_k) = \\sin(\\omega t_k)$\n- 插值函数：自然三次样条 $S(t)$\n- 边界条件：$S''(0) = 0$ 和 $S''(1) = 0$\n- 密集评估网格：$[0, 1]$ 上的 $M = 10001$ 个等距点\n- 误差度量：$e(\\omega) = \\max_{t \\in \\{0, \\frac{1}{M-1}, \\dots, 1\\}} \\left| \\sin(\\omega t) - S(t) \\right|$\n- 测试用例：$\\omega \\in \\{0, \\frac{\\pi}{4}, \\pi, 4\\pi, 12\\pi\\}$\n\n### 步骤2：使用提取的给定信息进行验证\n- **科学依据**：问题涉及正弦函数的自然三次样条插值，这是数值分析和信号处理中的一个标准且已得到充分理解的课题。函数 $x(t) = \\sin(\\omega t)$ 是无限可微的，不存在数学上的不规则性。这是科学上合理的。\n- **适定性**：为一组给定的不同节点构建唯一的自然三次样条是一个经典的适定问题。参数已完全指定，从而可以得出插值误差的唯一且可计算的解。\n- **客观性**：问题以精确的数学语言陈述，没有主观性或模糊性。\n- **完整性**：所有必要的数据（$N$、$M$、$\\omega$ 值、函数定义、边界条件）均已提供。问题是自包含的。\n- **不切实际或不可行**：该计算任务是标准的，并且可以使用现代数值库实现。参数是合理的。\n- **病态或结构不良**：问题结构清晰，并导向一个唯一的、稳定的解。\n- **琐碎性**：问题并非琐碎，需要实现或使用标准的数值算法来构建样条和评估误差。\n- **超出科学可验证性**：结果是数值上可计算和可验证的。\n\n### 步骤3：结论与行动\n问题有效。将提供解决方案。\n\n自然三次样条 $S(t)$ 是一个分段三次函数，它对一组给定的数据点 $\\{(t_k, x_k)\\}_{k=0}^N$ 进行插值，并且是二次连续可微的（$C^2$）。对于每个子区间 $[t_k, t_{k+1}]$（其中 $k \\in \\{0, 1, \\dots, N-1\\}$），样条 $S(t)$ 是一个三次多项式，我们记作 $S_k(t)$。\n\n构建 $S(t)$ 需要确定这 $N$ 个三次多项式的系数。这通过施加一组条件来实现：\n1.  **插值**：$S_k(t_k) = x_k$ 且 $S_k(t_{k+1}) = x_{k+1}$，对于 $k=0, \\dots, N-1$。\n2.  **导数连续性**：$S'_{k-1}(t_k) = S'_{k}(t_k)$ 且 $S''_{k-1}(t_k) = S''_{k}(t_k)$，对于 $k=1, \\dots, N-1$。\n\n令 $h = t_{k+1} - t_k$ 为均匀步长，并令 $M_k = S''(t_k)$ 为样条在节点 $t_k$ 处的二阶导数。由于 $S_k(t)$ 是三次的，$S''_k(t)$ 在 $[t_k, t_{k+1}]$ 上是线性的，可以写成：\n$$ S''_k(t) = M_k \\frac{t_{k+1} - t}{h} + M_{k+1} \\frac{t - t_k}{h} $$\n积分两次并应用插值条件 $S_k(t_k) = x_k$ 和 $S_k(t_{k+1}) = x_{k+1}$，得到第 $k$ 个区间上样条的表达式：\n$$ S_k(t) = M_k \\frac{(t_{k+1}-t)^3}{6h} + M_{k+1} \\frac{(t-t_k)^3}{6h} + \\left(\\frac{x_k}{h} - M_k\\frac{h}{6}\\right)(t_{k+1}-t) + \\left(\\frac{x_{k+1}}{h} - M_{k+1}\\frac{h}{6}\\right)(t-t_k) $$\n该表达式依赖于未知的二阶导数 $M_0, M_1, \\dots, M_N$。为了找到这些值，我们强制一阶导数连续，即 $S'_{k-1}(t_k) = S'_{k}(t_k)$，对于 $k=1, \\dots, N-1$。这导出一个线性方程组：\n$$ h M_{k-1} + 4h M_k + h M_{k+1} = \\frac{6}{h}(x_{k+1} - 2x_k + x_{k-1}) $$\n这给出了关于 $N+1$ 个未知数（$M_0, \\dots, M_N$）的 $N-1$ 个方程。还需要两个额外的约束。问题指定了*自然*边界条件，即：\n$$ S''(0) = M_0 = 0 \\quad \\text{和} \\quad S''(1) = M_N = 0 $$\n将这些代入方程组，剩下关于内部未知数 $M_1, \\dots, M_{N-1}$ 的 $N-1$ 个方程。得到的 $(N-1) \\times (N-1)$ 系统有一个严格对角占优的三对角矩阵，保证了 $M_k$ 值有唯一解。该系统可以被高效地求解。\n\n一旦 $M_k$ 的值已知，样条 $S(t)$ 就完全确定了。程序将在一个包含 $M$ 个点的密集网格上评估 $S(t)$，并计算其与真实函数 $x(t) = \\sin(\\omega t)$ 之间的最大绝对误差。\n\n对于一个四次连续可微的函数 $x(t)$，其插值误差 $e(t) = x(t) - S(t)$ 是有界的。对于夹持边界条件（$S'(t_0)=x'(t_0)$, $S'(t_N)=x'(t_N)$），误差为 $O(h^4)$ 阶：$\\max|e(t)| \\le C h^4 \\|x^{(4)}\\|_\\infty$。对于自然边界条件，由于 $S''(t_0), S''(t_N)$ 与 $x''(t_0), x''(t_N)$ 之间可能存在不匹配，误差通常为 $O(h^2)$ 阶。\n在我们的问题中，$x(t) = \\sin(\\omega t)$。其二阶导数为 $x''(t) = -\\omega^2 \\sin(\\omega t)$。\n在边界处：\n-   $x''(0) = -\\omega^2 \\sin(0) = 0$。自然边界条件 $S''(0)=0$ 与真实函数的二阶导数相匹配。\n-   $x''(1) = -\\omega^2 \\sin(\\omega)$。只有当 $\\omega = k\\pi$（对于某个整数 $k$）时，此值才为零。\n\n对于测试用例 $\\omega \\in \\{0, \\pi, 4\\pi, 12\\pi\\}$，我们有 $\\sin(\\omega) = 0$，因此 $x''(1)=0$。在这些情况下，自然边界条件与函数本身完全兼容，我们预期误差会更小，与 $O(h^4)$ 的收敛行为一致。误差幅度预计仍会随 $\\omega$ 变化，因为 $x^{(4)}(t) = \\omega^4 \\sin(\\omega t)$，所以 $\\|x^{(4)}\\|_\\infty = \\omega^4$。\n对于 $\\omega = \\frac{\\pi}{4}$，$x''(1) \\ne 0$。在 $t=1$ 处 $S''(1)=0$ 的不匹配将引入一个较大的边界误差，我们预计总体误差会比边界条件匹配的邻近情况要大。\n\n数值实现将利用 `scipy.interpolate.CubicSpline`，它通过指定 `bc_type='natural'` 提供了一种鲁棒且高效的构建自然三次样条的实现方式。", "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import CubicSpline\n\ndef solve():\n    \"\"\"\n    Computes the maximum absolute interpolation error of a natural cubic spline\n    for the function x(t) = sin(omega*t) for several values of omega.\n    \"\"\"\n    # Test suite and parameters from the problem statement\n    N = 64\n    M = 10001\n    omega_values = [0.0, np.pi/4, np.pi, 4*np.pi, 12*np.pi]\n\n    results = []\n\n    # Coarse grid for interpolation nodes\n    t_k = np.linspace(0, 1, N + 1)\n    \n    # Dense grid for error evaluation\n    t_eval = np.linspace(0, 1, M)\n\n    for omega in omega_values:\n        # Trivial case: sin(0*t) = 0. The natural spline for zero data is\n        # the zero function, so the error is exactly 0.\n        if omega == 0.0:\n            results.append(0.0)\n            continue\n\n        # Generate sample points from the true function\n        x_k = np.sin(omega * t_k)\n\n        # Construct the natural cubic spline interpolant.\n        # The 'natural' boundary condition sets the second derivatives\n        # at the endpoints to zero, as required by the problem.\n        cs = CubicSpline(t_k, x_k, bc_type='natural')\n\n        # Evaluate the spline and the true function on the dense grid\n        s_eval = cs(t_eval)\n        x_eval = np.sin(omega * t_eval)\n\n        # Compute the maximum absolute error\n        max_abs_error = np.max(np.abs(x_eval - s_eval))\n        \n        results.append(max_abs_error)\n\n    # Format the output as specified: a list of errors rounded to 10 decimal places.\n    # The f-string formatting ensures each number has 10 digits after the decimal point.\n    formatted_results = [f\"{r:.10f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2904294"}]}