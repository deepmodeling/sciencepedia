{"hands_on_practices": [{"introduction": "掌握混叠现象最直接的方法，是观察一个简单的正弦信号在采样率不足时其感知频率如何变化。这个练习 [@problem_id:2851263] 提供了一个具体的数值例子，来演示这种“频率折叠”现象，这是理解所有混叠效应的基石。通过计算，你将亲身体会到高于奈奎斯特频率的信号分量是如何“伪装”成一个低频信号的。", "problem": "一个单音连续时间信号 $x(t) = \\cos\\!\\left(2\\pi f_{0}\\, t\\right)$ 被一个理想采样器以采样频率 $f_{s}$ 采集，产生离散时间序列 $x[n] = x(n T_{s})$，其中 $T_{s} = 1/f_{s}$。测量前端缺少模拟抗混叠滤波器。已知 $f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$。\n\n仅从采样关系和频域中理想采样的标准频谱复制模型（即采样信号的连续时间傅里叶变换(CTFT)等于原始频谱以 $f_{s}$ 为间距的狄拉克梳状脉冲复制）出发，推导观测到的离散时间频率内容及其到奈奎斯特频带的混叠。具体而言：\n\n1) 当离散时间频谱显示在以赫兹为单位、区间为 $[0, f_{s})$ 的频率轴上时，确定该音调的观测离散时间频率（以赫兹为单位）。这是在将离散时间傅里叶变换(DTFT)的角频率 $\\omega$ 通过 $f = \\omega f_{s}/(2\\pi)$ 映射到赫兹后，直接对应于离散时间正弦波正频率分量的谱线位置。\n\n2) 确定在奈奎斯特区间 $[0, f_{s}/2]$ 内的混叠音调位置（以赫兹为单位），即，考虑到关于 $f_{s}/2$ 的频谱折叠，一个限制在 $[0, f_{s}/2]$ 内的理想离散时间频谱会显示出该音调的频率。\n\n以赫兹为单位表示这两个所求值。将您的最终答案以上述顺序表示为一个包含两个数字的单行矩阵。无需四舍五入。", "solution": "我们从理想采样的基本频域描述开始。设 $X(f)$ 表示 $x(t)$ 的连续时间傅里叶变换（CTFT）。以周期 $T_{s} = 1/f_{s}$ 进行理想采样，产生的采样信号的CTFT为\n$$\nX_{s}(f) \\;=\\; \\frac{1}{T_{s}} \\sum_{k\\in\\mathbb{Z}} X\\!\\left(f - k f_{s}\\right).\n$$\n对于单音输入 $x(t) = \\cos(2\\pi f_{0} t)$，其CTFT $X(f)$ 由位于频率 $\\pm f_{0}$ 处的两个权重相等的冲激组成。经过采样后，$X_{s}(f)$ 由位于 $\\pm f_{0} + k f_{s}$ 处的冲激组成，其中 $k$ 为所有整数。\n\n为了与离散时间序列 $x[n] = x(n T_{s})$ 建立联系，回想一下离散时间角频率 $\\omega$ （单位：弧度/样本）与连续频率 $f$ （单位：赫兹）的关系为\n$$\n\\omega \\;=\\; 2\\pi\\, \\frac{f}{f_{s}} \\quad \\Longleftrightarrow \\quad f \\;=\\; \\frac{\\omega}{2\\pi} \\, f_{s}.\n$$\n由于离散时间傅里叶变换（DTFT）在 $\\omega$ 上是 $2\\pi$ 周期的，当通过 $f = \\omega f_{s}/(2\\pi)$ 映射时，离散时间频谱在赫兹上是 $f_{s}$ 周期的。因此，任何位于 $f$ 处的谱线都可以被视为模 $f_{s}$。\n\n第1部分：在 $[0, f_{s})$ 上的观测离散时间频率（以赫兹为单位）。\n与该音调相关的正频率谱线出现在模位置\n$$\nf_{\\text{mod}} \\;=\\; f_{0} \\bmod f_{s}.\n$$\n这里，$f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$，所以 $f_{0} \\in [0, f_{s})$ 已经成立。因此，\n$$\nf_{\\text{obs},[0,f_{s})} \\;=\\; f_{0} \\;=\\; 3.2 \\times 10^{3}.\n$$\n\n第2部分：奈奎斯特区间 $[0, f_{s}/2]$ 内的混叠音调位置。\n奈奎斯特区间是 $[0, f_{s}/2] = [0, 2.5\\,\\text{kHz}]$。高于 $f_{s}/2$ 的频谱分量会关于 $f_{s}/2$ 折叠到这个区间内。对于一个位于 $f_{0}$ 处的单音，且 $f_{0} > f_{s}/2$，其折叠（混叠）频率可以通过关于 $f_{s}/2$ 的反射来找到，或者等效地，取其与 $f_{s}$ 的整数倍的最小距离。一种标准的表达方式是\n$$\nf_{\\text{alias}} \\;=\\; \\min_{k\\in\\mathbb{Z}} \\left| f_{0} - k f_{s} \\right|, \\quad \\text{subject to } f_{\\text{alias}} \\in [0, f_{s}/2].\n$$\n由于 $f_{0} = 3.2\\,\\text{kHz}$ 且 $f_{s} = 5\\,\\text{kHz}$，选择 $k = 1$：\n$$\n\\left| f_{0} - 1\\cdot f_{s} \\right| \\;=\\; \\left| 3.2\\,\\text{kHz} - 5\\,\\text{kHz} \\right| \\;=\\; 1.8\\,\\text{kHz} \\;\\in\\; [0, 2.5\\,\\text{kHz}].\n$$\n因此，奈奎斯特频带内的混叠音调位置是\n$$\nf_{\\text{alias}} \\;=\\; 1.8 \\times 10^{3}.\n$$\n\n通过离散时间角频率折叠进行一致性检验：对应于 $f_{0}$ 的离散时间角频率是\n$$\n\\omega_{0} \\;=\\; 2\\pi \\frac{f_{0}}{f_{s}} \\;=\\; 2\\pi \\cdot \\frac{3.2}{5} \\;=\\; 1.28\\pi.\n$$\n折叠到 $[0,\\pi]$ 利用了 $\\cos(\\omega n) = \\cos\\!\\big((2\\pi - \\omega)n\\big)$ 这一事实，因此在 $[0,\\pi]$ 内的观测角频率是 $\\omega_{\\text{obs}} = 2\\pi - \\omega_{0} = 0.72\\pi$。映射回赫兹，\n$$\nf_{\\text{alias}} \\;=\\; \\frac{\\omega_{\\text{obs}}}{2\\pi}\\, f_{s} \\;=\\; 0.36\\, f_{s} \\;=\\; 0.36 \\times 5\\,\\text{kHz} \\;=\\; 1.8\\,\\text{kHz},\n$$\n这与上面的结果一致。\n\n因此，所求的两个值是 $f_{\\text{obs},[0,f_{s})} = 3200$ 赫兹和 $f_{\\text{alias}} = 1800$ 赫兹。", "answer": "$$\\boxed{\\begin{pmatrix}3200  1800\\end{pmatrix}}$$", "id": "2851263"}, {"introduction": "在理解了确定性信号的混叠之后，我们将注意力转向在真实系统中无处不在的随机过程，例如噪声。这个练习 [@problem_id:2851296] 探讨了预滤波和采样如何影响噪声的统计特性，特别是其自相关性和“白度”。它揭示了在离散域中保持这些特性的微妙条件，加深了对带限白噪声采样后谱特性的理解。", "problem": "一个均值为零、连续时间、宽义平稳的高斯过程，其双边功率谱密度 (PSD) 为 $S_{x}(f)=N_{0}/2$。该过程通过一个理想低通滤波器，其频率响应 $H(f)$ 满足：当 $|f|\\leq B$ 时，$H(f)=1$；否则 $H(f)=0$。其中 $B  f_s/2$。该滤波器的输出以频率 $f_s$ 进行采样。求 $y[n]$ 的方差，以及使 $y[n]$ 成为白噪声序列的精确条件。将您的最终答案表示为方差的表达式。", "solution": "问题陈述经核实具有科学依据、问题明确且客观。这是随机过程和通信系统理论中的一个标准问题。我们将基于基本原理进行形式化推导。\n\n问题分为两部分。首先，我们必须推导采样序列 $y[n]$ 的方差。其次，我们必须确定该序列成为白噪声的条件。\n\n第一部分：$y[n]$ 的方差推导\n\n系统的输入是一个均值为零、连续时间、宽义平稳 (WSS) 的高斯过程 $x(t)$，其双边功率谱密度 (PSD) 为 $S_{x}(f) = N_{0}/2$。该过程通过一个理想低通滤波器 (LPF)，其频率响应 $H(f)$ 定义为：\n$$\nH(f) = \\begin{cases} 1  |f| \\leq B \\\\ 0  |f|  B \\end{cases}\n$$\n滤波器的输出是一个连续时间过程 $y(t)$。对于线性时不变系统，输出过程的功率谱密度 $S_{y}(f)$ 与输入功率谱密度 $S_{x}(f)$ 的关系如下式所示：\n$$\nS_{y}(f) = |H(f)|^{2} S_{x}(f)\n$$\n根据 $H(f)$ 的定义，其幅度的平方为：\n$$\n|H(f)|^{2} = \\begin{cases} 1^{2} = 1  |f| \\leq B \\\\ 0^{2} = 0  |f|  B \\end{cases}\n$$\n因此，输出过程 $y(t)$ 的功率谱密度为：\n$$\nS_{y}(f) = \\begin{cases} \\frac{N_{0}}{2}  |f| \\leq B \\\\ 0  |f|  B \\end{cases}\n$$\n过程 $y(t)$ 也是一个宽义平稳过程。由于输入 $x(t)$ 均值为零且滤波器是线性的，因此输出 $y(t)$ 的均值也为零。一个均值为零的宽义平稳过程的方差 $\\sigma_{y}^{2}$ 等于其平均功率。根据维纳-辛钦定理，平均功率是功率谱密度在所有频率上的积分。这也等价于自相关函数 $R_{y}(\\tau)$ 在 $\\tau=0$ 处的值。\n$$\n\\sigma_{y}^{2} = R_{y}(0) = \\int_{-\\infty}^{\\infty} S_{y}(f) df\n$$\n代入 $S_{y}(f)$ 的表达式，我们可以计算该积分：\n$$\n\\sigma_{y}^{2} = \\int_{-B}^{B} \\frac{N_{0}}{2} df = \\frac{N_{0}}{2} [f]_{-B}^{B} = \\frac{N_{0}}{2} (B - (-B)) = \\frac{N_{0}}{2} (2B) = N_{0}B\n$$\n滤波器的输出 $y(t)$ 随后以频率 $f_{s}$ 进行均匀采样，生成离散时间序列 $y[n] = y(nT_{s})$，其中 $T_{s} = 1/f_{s}$。由于 $y(t)$ 是一个均值为零的宽义平稳过程，因此采样序列 $y[n]$ 也是一个均值为零的宽义平稳过程。离散时间序列 $y[n]$ 的方差，记为 $\\sigma_{y[n]}^{2}$，由期望 $E[y[n]^{2}]$ 给出，这也就是离散时间自相关函数 $R_{y}[m]$ 在 $m=0$ 处的值。\n$$\n\\sigma_{y[n]}^{2} = E[y[n]^{2}] = R_{y}[0]\n$$\n离散时间自相关 $R_{y}[m]$ 是通过在 $\\tau = mT_{s}$ 处对连续时间自相关函数 $R_{y}(\\tau)$ 进行采样得到的。因此，$R_{y}[0] = R_{y}(0 \\cdot T_{s}) = R_{y}(0)$。\n我们已经计算出 $R_{y}(0) = \\sigma_{y}^{2} = N_{0}B$。因此，采样序列 $y[n]$ 的方差为：\n$$\n\\sigma_{y[n]}^{2} = N_{0}B\n$$\n\n第二部分：采样序列 $y[n]$ 的白性\n\n如果一个离散时间宽义平稳过程的样本是不相关的，则该过程被定义为“白”噪声。在数学上，这意味着其自相关函数 $R_{y}[m]$ 必须是一个缩放的克罗内克 δ 函数：\n$$\nR_{y}[m] = \\sigma^{2} \\delta[m]\n$$\n其中当 $m=0$ 时 $\\delta[m] = 1$，当 $m \\neq 0$ 时 $\\delta[m]=0$。\n\n为了研究 $y[n]$ 的白性，我们必须首先推导其自相关函数 $R_{y}[m]$。这是通过对连续时间自相关函数 $R_{y}(\\tau)$ 进行采样来完成的。我们通过对功率谱密度 $S_{y}(f)$ 进行傅里叶逆变换来求得 $R_{y}(\\tau)$：\n$$\nR_{y}(\\tau) = \\mathcal{F}^{-1}\\{S_{y}(f)\\} = \\int_{-\\infty}^{\\infty} S_{y}(f) e^{j2\\pi f \\tau} df\n$$\n代入 $S_{y}(f)$ 的表达式：\n$$\nR_{y}(\\tau) = \\int_{-B}^{B} \\frac{N_{0}}{2} e^{j2\\pi f \\tau} df = \\frac{N_{0}}{2} \\left[ \\frac{e^{j2\\pi f \\tau}}{j2\\pi \\tau} \\right]_{-B}^{B} = \\frac{N_{0}}{2} \\frac{e^{j2\\pi B \\tau} - e^{-j2\\pi B \\tau}}{j2\\pi \\tau}\n$$\n使用欧拉恒等式 $\\sin(x) = (e^{jx} - e^{-jx})/(2j)$，我们将其简化为：\n$$\nR_{y}(\\tau) = \\frac{N_{0}}{2\\pi \\tau} \\sin(2\\pi B \\tau)\n$$\n该表达式也可以用 sinc 函数写成 $R_{y}(\\tau) = N_{0}B \\frac{\\sin(2\\pi B \\tau)}{2\\pi B \\tau}$。\n\n离散时间序列 $y[n]$ 的自相关通过设置 $\\tau = mT_{s} = m/f_{s}$ 得到：\n$$\nR_{y}[m] = R_{y}(mT_{s}) = N_{0} \\frac{\\sin(2\\pi B m T_{s})}{2\\pi m T_{s}} = N_{0} \\frac{\\sin\\left(\\frac{2\\pi B m}{f_{s}}\\right)}{\\frac{2\\pi m}{f_{s}}}\n$$\n要使序列 $y[n]$ 成为白噪声，对于所有非零整数 $m$，我们需要 $R_{y}[m] = 0$。当 $m \\neq 0$ 时，分母不为零，因此白噪声的条件变为：\n$$\n\\sin\\left(\\frac{2\\pi B m}{f_{s}}\\right) = 0 \\quad \\forall m \\in \\mathbb{Z}, m \\neq 0\n$$\n正弦函数在其参数是 $\\pi$ 的整数倍时为零。因此，我们要求：\n$$\n\\frac{2\\pi B m}{f_{s}} = k\\pi \\quad \\text{对于某个整数 } k\n$$\n这可以简化为，对于所有非零整数 $m$，$\\frac{2Bm}{f_{s}}$ 都必须是一个整数。这个条件当且仅当 $\\frac{2B}{f_{s}}$ 本身是一个整数时才成立。设这个整数为 $p$，那么 $\\frac{2B}{f_{s}} = p$，这意味着对于某个正整数 $p$，$B = p \\frac{f_{s}}{2}$。\n\n问题陈述中明确了条件 $B  f_{s}/2$。如果我们将白噪声的条件代入这个不等式，我们得到 $p \\frac{f_{s}}{2}  \\frac{f_{s}}{2}$，这意味着 $p  1$。由于 $p$ 必须是正整数，因此没有整数 $p$ 能满足这个条件。因此，在严格条件 $B  f_{s}/2$ 下，采样序列 $y[n]$ 永远不是白噪声（排除了 $B=0$ 的平凡情况）。\n\n然而，问题要求的是使 $y[n]$ *成为*白噪声的精确条件。这个条件在给定约束的边界上得到满足。如果我们将严格不等式放宽到允许 $B = f_{s}/2$（对应于 $p=1$），那么白噪声的条件就满足了。\n使 $y[n]$ 成为白噪声序列的精确条件是：\n$$\nB = \\frac{f_{s}}{2}\n$$\n让我们来验证这一点。如果 $B = f_{s}/2$，自相关函数变为：\n$$\nR_{y}[m] = N_{0} \\frac{\\sin\\left(\\frac{2\\pi (f_{s}/2) m}{f_{s}}\\right)}{\\frac{2\\pi m}{f_{s}}} = N_{0} \\frac{\\sin(m\\pi)}{\\frac{2\\pi m}{f_{s}}}\n$$\n对于任何非零整数 $m$，$\\sin(m\\pi) = 0$，所以 $R_{y}[m] = 0$。\n对于 $m=0$，我们计算极限：\n$$\nR_{y}[0] = \\lim_{m \\to 0} N_{0} \\frac{\\sin\\left(\\frac{2\\pi B m}{f_{s}}\\right)}{\\frac{2\\pi m}{f_{s}}} = N_{0} B = N_{0} \\frac{f_{s}}{2}\n$$\n因此，当 $B = f_{s}/2$ 时，自相关为 $R_{y}[m] = (N_{0}B)\\delta[m]$，这正是方差为 $N_{0}B$ 的白噪声序列的定义。\n\n总结如下：\n1. 采样序列 $y[n]$ 的方差是 $N_{0}B$。\n2. 序列 $y[n]$ 通常不是白噪声。采样值是相关的。使该序列成为白噪声的精确条件是 $B = f_{s}/2$。", "answer": "$$\n\\boxed{N_{0}B}\n$$", "id": "2851296"}, {"introduction": "学习的高潮在于从分析转向设计。这个高级练习 [@problem_id:2851299] 挑战你设计一个最优的抗混叠滤波器，在给定的滤波器能量和性能等实际约束下，最大限度地减少由混叠引起的频谱失真。这个过程将理论知识与实际工程中的权衡取舍联系起来，是信号处理系统设计的核心技能。", "problem": "一个功率谱密度（PSD）为 $S_{x}(f)$ 的零均值广义平稳（WSS）连续时间过程，将以采样频率 $f_{s} = 10 \\times 10^{3}$ Hz 进行采样。在采样之前，该过程通过一个实的线性时不变抗混叠滤波器，其频率响应为 $H(f)$，其中 $|H(f)|$ 是偶函数且有界 $0 \\leq |H(f)| \\leq 1$。要求通带具有单位增益，即对于 $|f| \\leq 5 \\times 10^{3}$ Hz，有 $|H(f)| = 1$。由于硬件限制，该预滤波器是严格带限的：对于 $|f|  10 \\times 10^{3}$ Hz，有 $|H(f)| = 0$。\n\n该过程的功率谱密度是分段常数：\n- 对于 $|f| \\leq 5 \\times 10^{3}$ Hz，$S_{x}(f) = 1$，\n- 对于 $5 \\times 10^{3}  |f| \\leq 7 \\times 10^{3}$ Hz，$S_{x}(f) = \\tfrac{1}{2}$，\n- 对于 $7 \\times 10^{3}  |f| \\leq 10 \\times 10^{3}$ Hz，$S_{x}(f) = \\tfrac{3}{2}$，\n- 对于 $|f|  10 \\times 10^{3}$ Hz，$S_{x}(f) = 0$。\n\n设 $y(t)$ 是滤波后的信号，$y[n] = y(n T_{s})$，其中 $T_{s} = 1/f_{s}$。$y[n]$ 的离散时间功率谱密度（在 $|f| \\leq f_{s}/2$ 上的连续频率表示）等于采样引起的周期化频谱。将通过采样频谱估计连续时间基带二阶统计量的均方误差（MSE）定义为 $y[n]$ 的基带周期化频谱与原始基带 $S_{x}(f)$ 在 $|f| \\leq f_{s}/2$ 上的积分平方偏差。\n\n假设采样率和 $S_{x}(f)$ 满足：对于每个基带频率 $|f| \\leq 5 \\times 10^{3}$ Hz，最多只有一个来自 $|f| \\in (5 \\times 10^{3}, 10 \\times 10^{3}]$ 的混叠项折叠到基带中。\n\n你需要设计抗混叠预滤波器的幅度 $|H(f)|$，使其在满足所述约束条件和固定能量预算\n$$\n\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df \\;=\\; 12 \\times 10^{3}.\n$$\n的情况下，最小化上述均方误差。\n从第一性原理出发（滤波过程的功率谱密度定义、采样引起的周期化以及 $L^{2}$ 型均方误差的定义）。构建关于 $|H(f)|$ 的约束优化问题，并明确求解在三个区域 $|f| \\leq 5 \\times 10^{3}$ Hz、$5 \\times 10^{3}  |f| \\leq 7 \\times 10^{3}$ Hz 和 $7 \\times 10^{3}  |f| \\leq 10 \\times 10^{3}$ Hz 上的最优 $|H(f)|$。将你的最终答案表示为最优幅度响应 $|H(f)|$ 的单个分段定义的解析表达式。最终答案中不要包含单位。", "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤 1：提取的已知条件**\n-   一个零均值广义平稳（WSS）连续时间过程 $x(t)$ 具有功率谱密度（PSD） $S_{x}(f)$。\n-   对于 $|f| \\leq 5 \\times 10^{3}$ Hz，$S_{x}(f) = 1$。\n-   对于 $5 \\times 10^{3}  |f| \\leq 7 \\times 10^{3}$ Hz，$S_{x}(f) = \\frac{1}{2}$。\n-   对于 $7 \\times 10^{3}  |f| \\leq 10 \\times 10^{3}$ Hz，$S_{x}(f) = \\frac{3}{2}$。\n-   对于 $|f|  10 \\times 10^{3}$ Hz，$S_{x}(f) = 0$。\n-   该过程通过一个实的线性时不变（LTI）抗混叠滤波器，其频率响应为 $H(f)$。\n-   滤波器约束：$|H(f)|$ 是偶函数；$0 \\leq |H(f)| \\leq 1$；对于 $|f| \\leq 5 \\times 10^{3}$ Hz，有 $|H(f)| = 1$；对于 $|f|  10 \\times 10^{3}$ Hz，有 $|H(f)| = 0$。\n-   采样频率为 $f_{s} = 10 \\times 10^{3}$ Hz。采样周期为 $T_s = 1/f_s$。\n-   滤波后的信号是 $y(t)$，采样后的信号是 $y[n] = y(nT_s)$。\n-   均方误差（MSE）定义为 $y[n]$ 的基带周期化频谱与原始基带 $S_{x}(f)$ 在 $|f| \\leq f_{s}/2$ 上的积分平方偏差。\n-   假设对于任何基带频率，最多只有一个混叠项折叠到基带中。\n-   滤波器有固定的能量预算：$\\int_{-\\infty}^{\\infty} |H(f)|^{2} \\, df = 12 \\times 10^{3}$。\n\n**步骤 2：验证**\n该问题在科学上基于数字信号处理的原理。它是一个适定问题，有一个明确的目标函数（MSE）需要在满足一组明确定义的约束条件下最小化。给定的值和约束是自洽的。可以验证能量预算约束：在通带 $|f| \\leq 5 \\times 10^{3}$ Hz 上，其中 $|H(f)|=1$，积分为 $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$。这为剩余的频带留下了 $(12-10) \\times 10^3 = 2 \\times 10^3$ 的能量。由于 $|H(f)|$ 是偶函数，这意味着 $\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$。这些约束并不矛盾。关于混叠的假设对于给定的采样率和信号带宽是可验证且正确的。该问题是一个标准的、尽管不平凡的最优滤波器设计练习。\n\n**结论**\n问题有效。我们继续进行求解。\n\n**解答推导**\n滤波后信号 $y(t)$ 的功率谱密度为 $S_y(f) = |H(f)|^2 S_x(f)$。\n以速率 $f_s$ 对 $y(t)$ 进行采样的过程，会为离散时间信号 $y[n]$ 产生一个周期化的频谱。用连续频率 $f$ 表示，该频谱由下式给出\n$$S_y^p(f) = \\sum_{k=-\\infty}^{\\infty} S_y(f - kf_s) = \\sum_{k=-\\infty}^{\\infty} |H(f - kf_s)|^2 S_x(f - kf_s)$$\n我们关心的是基带，即 $|f| \\leq f_s/2$。采样频率为 $f_s = 10 \\times 10^3$ Hz，因此基带为 $|f| \\leq 5 \\times 10^3$ Hz。滤波器是带限的，使得对于 $|f|  10 \\times 10^3$ Hz，有 $|H(f)|=0$，这个频率等于 $f_s$。因此，对于基带中的任何 $f$，求和中只有 $k=0, \\pm 1$ 项可以非零。\n对于 $|f| \\leq f_s/2$：\n- $k=0$ 的参数是 $f$，它在基带内。\n- $k=1$ 的参数是 $f-f_s$，它在 $[-3f_s/2, -f_s/2]$ 内。$H$ 的支撑集是 $[-f_s, f_s]$，所以这一项有贡献。\n- $k=-1$ 的参数是 $f+f_s$，它在 $[f_s/2, 3f_s/2]$ 内。这一项也有贡献。\n- 对于 $|k| \\geq 2$，参数 $|f-kf_s|$ 大于 $f_s$，所以 $|H(f-kf_s)|=0$。\n\n基带 $|f| \\leq f_s/2$ 内的周期化频谱为：\n$$S_y^p(f) = |H(f)|^2 S_x(f) + |H(f-f_s)|^2 S_x(f-f_s) + |H(f+f_s)|^2 S_x(f+f_s)$$\n让我们分析 $f \\in [0, f_s/2]$ 的情况。由于所有函数都是偶函数，负频率的结果将是对称的。\n对于 $f \\in [0, f_s/2]$：\n- $|H(f)|=1$ 且 $S_x(f)=1$。\n- $f+f_s  f_s$，所以 $|H(f+f_s)|=0$。\n- $f-f_s$ 位于 $[-f_s, -f_s/2]$ 内。由于 $|H(f)|$ 和 $S_x(f)$ 是偶函数，所以 $|H(f-f_s)|^2 S_x(f-f_s) = |H(f_s-f)|^2 S_x(f_s-f)$。\n因此，对于 $f \\in [0, f_s/2]$：\n$$S_y^p(f) = 1 + |H(f_s-f)|^2 S_x(f_s-f)$$\n基带中的期望频谱是 $S_x(f) = 1$。误差频谱是混叠分量：\n$$E(f) = S_y^p(f) - S_x(f) = |H(f_s-f)|^2 S_x(f_s-f)$$\n均方误差（MSE）定义为 $J = \\int_{-f_s/2}^{f_s/2} E(f)^2 df$。由于 $E(f)$ 是 $f$ 的偶函数：\n$$J = 2 \\int_{0}^{f_s/2} \\left( |H(f_s-f)|^2 S_x(f_s-f) \\right)^2 df$$\n我们进行变量替换，令 $g = f_s-f$。则 $df = -dg$。当 $f=0$ 时，$g=f_s$。当 $f=f_s/2$ 时，$g=f_s/2$。\n$$J = 2 \\int_{f_s}^{f_s/2} \\left( |H(g)|^2 S_x(g) \\right)^2 (-dg) = 2 \\int_{f_s/2}^{f_s} \\left( |H(f)|^2 S_x(f) \\right)^2 df$$\n我们希望在能量约束下最小化这个泛函 $J$。总能量为 $12 \\times 10^3$。通带内的能量为 $\\int_{-5 \\times 10^3}^{5 \\times 10^3} 1^2 df = 10 \\times 10^3$。\n剩余的能量分配给阻带 $|f| \\in (5 \\times 10^3, 10 \\times 10^3]$。\n$\\int_{|f| \\in (5 \\times 10^3, 10 \\times 10^3]} |H(f)|^2 df = 2 \\times 10^3$。根据对称性，$\\int_{5 \\times 10^3}^{10 \\times 10^3} |H(f)|^2 df = 1 \\times 10^3$。\n设 $h(f) = |H(f)|$。为清晰起见，令 $f_1 = 5 \\times 10^3$，$f_2 = 7 \\times 10^3$，以及 $f_3 = 10 \\times 10^3$。\n优化问题是：最小化 $J = 2 \\int_{f_1}^{f_3} h(f)^4 S_x(f)^2 df$，约束条件为 $\\int_{f_1}^{f_3} h(f)^2 df = 10^3$ 和 $0 \\leq h(f) \\leq 1$。\n我们构造拉格朗日泛函：\n$$\\mathcal{L}[h] = \\int_{f_1}^{f_3} \\left( 2 h(f)^4 S_x(f)^2 - \\lambda h(f)^2 \\right) df + \\lambda \\cdot 10^3$$\n对 $h(f)$ 求泛函导数并令其为零，得到欧拉-拉格朗日方程：\n$$8 h(f)^3 S_x(f)^2 - 2 \\lambda h(f) = 0 \\implies 2h(f) (4 h(f)^2 S_x(f)^2 - \\lambda) = 0$$\n对于一个非平凡解 $h(f) \\neq 0$，我们有 $h(f)^2 = \\frac{\\lambda}{4 S_x(f)^2}$，所以 $h(f) = \\frac{\\sqrt{\\lambda}}{2 S_x(f)}$。令 $K = \\frac{\\sqrt{\\lambda}}{2}$。\n解的形式为 $h(f) = K/S_x(f)$，前提是 $K/S_x(f) \\leq 1$。\n在优化区域 $[f_1, f_3]$ 内，PSD $S_x(f)$ 是分段常数：\n- 对于 $f \\in (f_1, f_2]$，$S_x(f) = S_2 = 1/2$。\n- 对于 $f \\in (f_2, f_3]$，$S_x(f) = S_3 = 3/2$。\n所以，最优的 $h(f)$ 也必须是分段常数：\n- 对于 $f \\in (f_1, f_2]$，$h(f) = K/S_2 = 2K$。\n- 对于 $f \\in (f_2, f_3]$，$h(f) = K/S_3 = 2K/3$。\n我们使用能量约束来求解 $K$：\n$$\\int_{f_1}^{f_2} (2K)^2 df + \\int_{f_2}^{f_3} \\left(\\frac{2K}{3}\\right)^2 df = 10^3$$\n$$4K^2 (f_2 - f_1) + \\frac{4K^2}{9} (f_3 - f_2) = 10^3$$\n$$4K^2 (2 \\times 10^3) + \\frac{4K^2}{9} (3 \\times 10^3) = 10^3$$\n$$8 \\times 10^3 K^2 + \\frac{4}{3} \\times 10^3 K^2 = 10^3$$\n两边同除以 $10^3$：\n$$8K^2 + \\frac{4}{3}K^2 = 1 \\implies \\frac{28}{3}K^2 = 1 \\implies K^2 = \\frac{3}{28}$$\n所以，$K = \\sqrt{\\frac{3}{28}} = \\frac{\\sqrt{3}}{2\\sqrt{7}} = \\frac{\\sqrt{21}}{14}$。\n$h(f)$ 的最大值是 $2K = \\frac{\\sqrt{21}}{7}$。因为 $21  49$，所以 $\\sqrt{21}  7$，因此 $2K1$。约束条件 $h(f) \\leq 1$ 得到满足。\n最优滤波器幅值是：\n- 对于 $f \\in (5 \\times 10^3, 7 \\times 10^3]$: $h(f) = 2K = \\frac{\\sqrt{21}}{7}$。\n- 对于 $f \\in (7 \\times 10^3, 10 \\times 10^3]$: $h(f) = \\frac{2K}{3} = \\frac{\\sqrt{21}}{21} = \\frac{1}{\\sqrt{21}}$。\n\n综合所有部分，最优滤波器幅度响应 $|H(f)|$ 的完整表达式如下，它是一个关于 $f$ 的偶函数：\n- 对于 $0 \\leq |f| \\leq 5 \\times 10^3$ Hz，有 $|H(f)| = 1$。\n- 对于 $5 \\times 10^3  |f| \\leq 7 \\times 10^3$ Hz，有 $|H(f)| = \\frac{\\sqrt{21}}{7}$。\n- 对于 $7 \\times 10^3  |f| \\leq 10 \\times 10^3$ Hz，有 $|H(f)| = \\frac{\\sqrt{21}}{21}$。\n- 对于 $|f|  10 \\times 10^3$ Hz，有 $|H(f)| = 0$。\n这就是最终答案。", "answer": "$$\n\\boxed{\n|H(f)| = \n\\begin{cases} \n1  |f| \\leq 5 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{7}  5 \\times 10^3  |f| \\leq 7 \\times 10^3 \\\\\n\\frac{\\sqrt{21}}{21}  7 \\times 10^3  |f| \\leq 10 \\times 10^3 \\\\\n0  |f|  10 \\times 10^3\n\\end{cases}\n}\n$$", "id": "2851299"}]}