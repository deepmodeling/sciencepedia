{"hands_on_practices": [{"introduction": "这项基础练习旨在巩固时域脉冲响应与频域特性之间的联系。通过从离散时间傅里叶变换 (DTFT) 的定义出发，并利用给定FIR滤波器的对称性，我们可以推导出其关键的频率响应特性。这项实践将指导您显式地计算出实值振幅函数 $A(\\omega)$ 和恒定的群延迟 $\\tau_g$，从而加深对I型线性相位滤波器工作原理的理解。[@problem_id:2881290]", "problem": "考虑一个长度为 $N=7$ 的实值有限冲激响应 (FIR) 滤波器，其冲激响应对于所有整数 $n$ 具有偶对称性 $h[n]=h[6-n]$，并具有以下指定的系数：\n- $h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$，且根据对称性 $h[4]=\\frac{3}{16}$，$h[5]=-\\frac{1}{8}$，$h[6]=\\frac{1}{16}$。\n\n仅从冲激响应的离散时间傅里叶变换 (DTFT) 的定义和给定的对称性出发，推导频率响应的线性相位分解形式 $H(\\omega)=\\exp(-j \\omega M)\\,A(\\omega)$ 的显式表达式，将实幅度函数 $A(\\omega)$ 确定为余弦项之和。然后，使用以相位定义的群延迟的定义，确定此滤波器的恒定群延迟。\n\n所有角量均使用弧度，群延迟以采样点数为单位表示。请将最终答案以一个单行矩阵的两个条目的形式提供，其中第一个条目是 $A(\\omega)$ 的显式表达式，第二个条目是群延迟。无需进行舍入。", "solution": "问题陈述需要进行验证。\n\n已知条件提取如下：\n1.  该滤波器是一个实值有限冲激响应 (FIR) 滤波器。\n2.  滤波器的长度为 $N=7$。\n3.  冲激响应表现出偶对称性：对于所有整数 $n$，$h[n]=h[6-n]$。\n4.  系数指定为：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。剩余系数由对称性确定：$h[4]=h[6-4]=h[2]=\\frac{3}{16}$，$h[5]=h[6-5]=h[1]=-\\frac{1}{8}$，以及 $h[6]=h[6-6]=h[0]=\\frac{1}{16}$。\n\n该问题具有科学依据、适定且客观。它涉及数字信号处理中的标准概念，具体为 I 型线性相位 FIR 滤波器的分析。所有提供的数据都一致且足以得出唯一解。因此，该问题被视为有效。下面开始求解。\n\n具有冲激响应 $h[n]$ 的离散时间滤波器的频率响应 $H(\\omega)$ 由其离散时间傅里叶变换 (DTFT) 给出。对于长度为 $N$ 的滤波器，其定义为：\n$$H(\\omega) = \\sum_{n=0}^{N-1} h[n] \\exp(-j \\omega n)$$\n给定滤波器长度为 $N=7$，求和范围为从 $n=0$ 到 $n=6$：\n$$H(\\omega) = \\sum_{n=0}^{6} h[n] \\exp(-j \\omega n)$$\n展开此求和式得到：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[4]\\exp(-j4\\omega) + h[5]\\exp(-j5\\omega) + h[6]\\exp(-j6\\omega)$$\n问题陈述该冲激响应具有偶对称性 $h[n]=h[6-n]$。我们将此性质应用于系数：\n$h[6] = h[0]$，$h[5] = h[1]$，以及 $h[4] = h[2]$。\n将这些代入 $H(\\omega)$ 的表达式中：\n$$H(\\omega) = h[0] + h[1]\\exp(-j\\omega) + h[2]\\exp(-j2\\omega) + h[3]\\exp(-j3\\omega) + h[2]\\exp(-j4\\omega) + h[1]\\exp(-j5\\omega) + h[0]\\exp(-j6\\omega)$$\n为了揭示线性相位结构，我们必须围绕冲激响应的中心对称地对各项进行分组。对于长度为 $N=7$ 的滤波器，对称中心位于索引 $n=\\frac{N-1}{2} = \\frac{7-1}{2}=3$ 处。\n$$H(\\omega) = h[3]\\exp(-j3\\omega) + \\left( h[0] + h[0]\\exp(-j6\\omega) \\right) + \\left( h[1]\\exp(-j\\omega) + h[1]\\exp(-j5\\omega) \\right) + \\left( h[2]\\exp(-j2\\omega) + h[2]\\exp(-j4\\omega) \\right)$$\n我们提出对应于对称中心的相位项 $\\exp(-j3\\omega)$：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + h[0]\\left(\\exp(j3\\omega) + \\exp(-j3\\omega)\\right) + h[1]\\left(\\exp(j2\\omega) + \\exp(-j2\\omega)\\right) + h[2]\\left(\\exp(j\\omega) + \\exp(-j\\omega)\\right) \\right]$$\n使用欧拉恒等式 $2\\cos(\\theta) = \\exp(j\\theta) + \\exp(-j\\theta)$，我们可以将括号中的项表示为余弦：\n$$H(\\omega) = \\exp(-j3\\omega) \\left[ h[3] + 2h[0]\\cos(3\\omega) + 2h[1]\\cos(2\\omega) + 2h[2]\\cos(\\omega) \\right]$$\n该表达式符合所求的线性相位形式 $H(\\omega)=\\exp(-j \\omega M)A(\\omega)$，其中 $M=3$ 且 $A(\\omega)$ 是实值幅度函数：\n$$A(\\omega) = h[3] + 2h[2]\\cos(\\omega) + 2h[1]\\cos(2\\omega) + 2h[0]\\cos(3\\omega)$$\n现在，我们代入给定的系数值：$h[0]=\\frac{1}{16}$，$h[1]=-\\frac{1}{8}$，$h[2]=\\frac{3}{16}$，$h[3]=\\frac{1}{4}$。\n$$A(\\omega) = \\frac{1}{4} + 2\\left(\\frac{3}{16}\\right)\\cos(\\omega) + 2\\left(-\\frac{1}{8}\\right)\\cos(2\\omega) + 2\\left(\\frac{1}{16}\\right)\\cos(3\\omega)$$\n$$A(\\omega) = \\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega)$$\n这就是实幅度函数 $A(\\omega)$ 的显式表达式。\n\n接下来，我们确定群延迟 $\\tau_g(\\omega)$。群延迟定义为频率响应的相位对角频率 $\\omega$ 的导数的负值：\n$$\\tau_g(\\omega) = -\\frac{d}{d\\omega} \\arg\\{H(\\omega)\\}$$\n频率响应为 $H(\\omega) = A(\\omega)\\exp(-j3\\omega)$。函数 $A(\\omega)$ 是实数，因此其相位 $\\arg\\{A(\\omega)\\}$ 要么是 $0$ (如果 $A(\\omega)  0$)，要么是 $\\pi$ (如果 $A(\\omega)  0$）。\n$H(\\omega)$ 的总相位，记为 $\\phi(\\omega)$，为：\n$$\\phi(\\omega) = \\arg\\{H(\\omega)\\} = \\arg\\{A(\\omega)\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} + \\arg\\{\\exp(-j3\\omega)\\} = \\arg\\{A(\\omega)\\} - 3\\omega$$\n对于线性相位滤波器，群延迟通常由相位的线性分量定义。在 $A(\\omega)$ 不变号的 $\\omega$ 区域内，$\\arg\\{A(\\omega)\\}$ 是一个常数（$0$ 或 $\\pi$），其导数为零。因此，相位的导数为：\n$$\\frac{d\\phi(\\omega)}{d\\omega} = \\frac{d}{d\\omega}(-3\\omega) = -3$$\n因此，群延迟是恒定的：\n$$\\tau_g(\\omega) = -(-3) = 3$$\n群延迟为 3 个采样点。这与 I 型线性相位 FIR 滤波器的一般理论一致，对于该类滤波器，群延迟是恒定的且等于 $(N-1)/2$。\n\n最终答案由 $A(\\omega)$ 的表达式和群延迟的恒定值组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4} + \\frac{3}{8}\\cos(\\omega) - \\frac{1}{4}\\cos(2\\omega) + \\frac{1}{8}\\cos(3\\omega) \\quad 3\n\\end{pmatrix}\n}\n$$", "id": "2881290"}, {"introduction": "在掌握了如何分析线性相位滤波器之后，下一步是理解其结构如何影响实际应用。这项练习探讨了一个关键的设计约束：并非所有类型的线性相位滤波器都适用于所有任务。通过分析滤波器在直流频率 ($\\omega=0$) 处的响应，您将确定哪些类型的滤波器由于其固有的反对称性而无法实现低通滤波功能，这凸显了在设计之初选择正确滤波器结构的重要性。[@problem_id:1739206]", "problem": "在数字滤波器的设计中，线性相位有限脉冲响应（FIR）滤波器因其能够同等地延迟所有频率分量，从而保持信号波形的能力而经常被优先选用。这些滤波器根据其脉冲响应 $h[n]$ 的对称性和滤波器长度 $N$ 被分为四种类型。\n\n这四种类型是为从 $n=0$到 $N-1$ 的因果脉冲响应定义的：\n- **第一类：**对称脉冲响应（$h[n] = h[N-1-n]$），长度 $N$ 为奇数。\n- **第二类：**对称脉冲响应（$h[n] = h[N-1-n]$），长度 $N$ 为偶数。\n- **第三类：**反对称脉冲响应（$h[n] = -h[N-1-n]$），长度 $N$ 为奇数。\n- **第四类：**反对称脉冲响应（$h[n] = -h[N-1-n]$），长度 $N$ 为偶数。\n\n一位工程师的任务是设计一个低通滤波器。任何低通滤波器的一个基本要求是它在零频率（即对于直流（DC）信号）下必须有非零增益。就离散时间频率响应 $H(e^{j\\omega})$ 而言，这意味着 $|H(e^{j0})| \\neq 0$。\n\n根据其定义所固有的数学特性，无论选择何种特定的滤波器系数，下列哪几种类型的线性相位FIR滤波器从根本上不适合用于实现低通滤波器？选择所有适用的选项。\n\nA. 第一类\n\nB. 第二类\n\nC. 第三类\n\nD. 第四类", "solution": "低通滤波器必须满足其在零频率下的增益为非零的条件，这在离散时间中要求在零频率处的频率响应 $H(e^{j0})$ 非零。对于一个脉冲响应为 $h[n]$ 且在 $0 \\leq n \\leq N-1$ 上有定义的 $N$ 阶FIR滤波器，其离散时间傅里叶变换为\n$$\nH(e^{j\\omega})=\\sum_{n=0}^{N-1} h[n] e^{-j\\omega n}.\n$$\n在 $\\omega=0$ 处求值得到\n$$\nH(e^{j0})=\\sum_{n=0}^{N-1} h[n].\n$$\n因此，低通特性的一个必要条件是\n$$\n\\left|\\sum_{n=0}^{N-1} h[n]\\right|\\neq 0.\n$$\n\n考虑反对称脉冲响应，即 $h[n]=-h[N-1-n]$（第三类和第四类）。对于任意 $n$ 及其配对索引 $N-1-n$，\n$$\nh[n]+h[N-1-n]=h[n]-h[n]=0.\n$$\n如果 $N$ 是奇数（第三类），则存在一个中心索引 $m=(N-1)/2$，根据反对称性可得\n$$\nh[m]=-h[m]\\quad\\Rightarrow\\quad h[m]=0,\n$$\n因此中心项的贡献为零，所有剩余项成对抵消，从而得出\n$$\n\\sum_{n=0}^{N-1} h[n]=0\\quad\\Rightarrow\\quad H(e^{j0})=0.\n$$\n如果 $N$ 是偶数（第四类），则没有中心项，所有项成对抵消，同样得出\n$$\n\\sum_{n=0}^{N-1} h[n]=0\\quad\\Rightarrow\\quad H(e^{j0})=0.\n$$\n因此，对于反对称的第三类和第四类滤波器，无论如何选择系数，$H(e^{j0})=0$ 恒成立，这从根本上违反了低通滤波器的要求 $\\left|H(e^{j0})\\right|\\neq 0$。\n\n现在考虑对称脉冲响应，即 $h[n]=h[N-1-n]$（第一类和第二类）。将 $n$ 与 $N-1-n$ 配对可得\n$$\nh[n]+h[N-1-n]=2h[n],\n$$\n因此总和变成了一系列系数的两倍之和，并且如果 $N$ 是奇数，还会额外有一个单独的中心项 $h[(N-1)/2]$。因此，\n$$\n\\sum_{n=0}^{N-1} h[n] \\text{ 不会因为对称性而被强制为零，}\n$$\n并且可以选择系数使得 $H(e^{j0})\\neq 0$。因此，第一类和第二类滤波器并未从根本上被排除在低通设计之外。\n\n因此，只有反对称的第三类和第四类滤波器天生不适合用于低通滤波器。", "answer": "$$\\boxed{\\text{CD}}$", "id": "1739206"}, {"introduction": "理论知识最终需要通过计算工具在实践中得到验证，这项动手实践旨在连接理论与现代信号处理实践。您将学习如何使用快速傅里叶变换 (FFT) 这一核心算法，来高效地分析和验证四种线性相位FIR滤波器的特性。该练习涵盖了零填充、相位校正和斜率拟合等关键技术，以从计算结果中精确提取振幅响应和群延迟，从而提供一种验证滤波器设计的可靠方法。[@problem_id:2881267]", "problem": "您的任务是，使用离散角频率网格和零填充序列的快速傅里叶变换，以编程方式评估具有线性相位的实数有限冲激响应的离散时间傅里叶变换，同时保留其线性相位结构。目标是展示如何选择角频率网格以及如何校正固有的线性相位，以使残余谱揭示由时域对称性所蕴含的偶对称或奇对称结构。您必须实现该评估过程，并返回用以验证预期结构和群延迟的定量指标。角度必须以弧度为单位处理。不涉及物理单位。\n\n使用以下基本定义作为起点：\n- 序列 $h[n]$ 的离散时间傅里叶变换 (DTFT) 为 $H\\!\\left(e^{j\\omega}\\right)=\\sum_{n=0}^{M-1} h[n]\\,e^{-j\\omega n}$，其中 $M$ 是 $h[n]$ 的长度，$\\omega$ 是以弧度为单位的角频率。\n- 线性相位有限冲激响应 $h[n]$ 满足 $h[n]=h[M-1-n]$ (对称) 或 $h[n]=-h[M-1-n]$ (反对称)，这意味着 $H\\!\\left(e^{j\\omega}\\right)=e^{-j\\omega\\tau}\\,A(\\omega)$，其中群延迟 $\\tau=(M-1)/2$ 为实数，残余 $A(\\omega)$ 根据对称类型的不同，为实偶函数或纯虚奇函数。\n- 长度为 $N$ 的序列的快速傅里叶变换 (FFT) 会在网格 $\\omega_m=\\frac{2\\pi m}{N}$（其中 $m\\in\\{0,1,\\dots,N-1\\}$）上产生 $2\\pi$ 周期的离散时间傅里叶变换的采样点，将 $h[n]$ 零填充至长度 $N\\ge M$ 会增加频率采样密度，而不会改变其底层频谱。\n\n您的程序必须为每个测试用例，基于这些原则实现以下步骤：\n1. 设有限冲激响应的长度为 $M$。选择每个测试用例指定的整数填充因子 $S0$。将 FFT 长度 $N$ 定义为满足 $N\\ge S\\,M$ 的最小的2的次幂。这个 $N$ 决定了一个均匀的频率网格 $\\omega_m=\\frac{2\\pi m}{N}$，其中 $m\\in\\{0,1,\\dots,\\lfloor N/2\\rfloor\\}$，覆盖了 $[0,\\pi]$ 的弧度范围。角度以弧度为单位。\n2. 将 $h[n]$ 零填充到长度 $N$，并使用 FFT 计算索引为 $k$ 的离散傅里叶变换采样点 $H_k$，它对应于 $\\omega_k=\\frac{2\\pi k}{N}$ 处的 $H\\!\\left(e^{j\\omega_k}\\right)$。\n3. 设群延迟为 $\\tau=\\frac{M-1}{2}$。构建经线性相位校正的频谱 $G_k=H_k\\,e^{j\\omega_k\\tau}$。对于对称的 $h[n]$，理想的 $G_k$ 是实数值；对于反对称的 $h[n]$，理想的 $G_k$ 是纯虚数。\n4. 定义一个轴泄漏度量，用于量化与预期轴的偏差：\n   - 如果 $h[n]$ 是对称的，则将泄漏定义为 $\\frac{\\max_k |\\operatorname{Im}\\{G_k\\}|}{\\max_k |G_k|+\\varepsilon}$。\n   - 如果 $h[n]$ 是反对称的，则将泄漏定义为 $\\frac{\\max_k |\\operatorname{Re}\\{G_k\\}|}{\\max_k |G_k|+\\varepsilon}$。\n   使用 $\\varepsilon=10^{-12}$ 来避免除以零。\n5. 从 $H_k$ 在 $\\omega\\in[0,\\pi]$ 范围内的展开相位中估计线性相位斜率，需排除 $|H_k|$ 极小的索引：选择满足 $|H_k|\\ge 10^{-6}\\,\\max_k |H_k|$ 的索引。对所选索引的展开相位样本 $\\phi(\\omega_k)=\\arg H_k$ 使用最小二乘法拟合一条直线 $\\phi(\\omega)\\approx a+b\\,\\omega$。预期斜率为 $b\\approx -\\tau$。报告斜率误差 $|b+\\tau|$。\n\n为以下测试套件实现上述步骤。每个测试用例提供一个长度为 $M$ 的冲激响应 $h[n]$、一个对称性标签和一个过采样因子 $S$。序列明确给出如下：\n- 测试用例 1 (对称, I 型): $h[n]=[\\,0.2,\\,0.3,\\,0.4,\\,0.5,\\,0.4,\\,0.3,\\,0.2\\,]$, $S=16$.\n- 测试用例 2 (对称, II 型): $h[n]=[\\,0.1,\\,0.05,\\,0.2,\\,0.25,\\,0.25,\\,0.2,\\,0.05,\\,0.1\\,]$, $S=8$.\n- 测试用例 3 (反对称, III 型): $h[n]=[\\,0.3,\\,0.2,\\,-0.1,\\,0.0,\\,0.1,\\,-0.2,\\,-0.3\\,]$, $S=32$.\n- 测试用例 4 (反对称, IV 型): $h[n]=[\\,0.4,\\,0.1,\\,-0.2,\\,0.3,\\,-0.3,\\,0.2,\\,-0.1,\\,-0.4\\,]$, $S=4$.\n\n对于每个测试用例，您的程序必须计算并返回一对浮点数：\n- 步骤 4 中描述的轴泄漏度量。\n- 步骤 5 中描述的斜率误差 $|b+\\tau|$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身是一个双元素列表 $[\\,\\text{leakage},\\,\\text{slope\\_error}\\,]$。例如，格式必须类似于 $[[x_1,y_1],[x_2,y_2],[x_3,y_3],[x_4,y_4]]$，不含任何附加文本。所有角度必须以弧度为单位，所有报告的量都必须是十进制浮点数。", "solution": "所述问题是数字信号处理基本原理数值验证方面一个适定的练习。它具有科学依据，内部一致且完整。所有给定的定义和程序在该学科中都是标准且正确的。因此，解决方案不仅是可能的，而且是既有理论的直接应用。我们现在将对解决方案进行系统性的推导和解释。\n\n问题的核心在于表现出线性相位的实值有限冲激响应 (FIR) 滤波器 $h[n]$ 的特性。离散时间傅里叶变换 (DTFT) $H\\!\\left(e^{j\\omega}\\right) = \\sum_{n=0}^{M-1} h[n]\\,e^{-j\\omega n}$ 的相位是角频率 $\\omega$ 的线性函数。此特性源于长度为 $M$ 的冲激响应 $h[n]$ 的时域对称性。此类滤波器存在四种类型，按其对称性和长度分类。\n\n如果序列 $h[n]$ 是对称的 ($h[n] = h[M-1-n]$) 或反对称的 ($h[n] = -h[M-1-n]$)，则它具有线性相位。这种对称性意味着 DTFT 可以表示为：\n$$H\\!\\left(e^{j\\omega}\\right) = A(\\omega)\\,e^{-j\\omega\\tau}$$\n其中 $\\tau = \\frac{M-1}{2}$ 是滤波器的群延迟。函数 $A(\\omega)$ 是一个实值函数，通常被称为幅度函数或零相位响应。$A(\\omega)$ 的特性取决于滤波器类型：\n1.  **I 型**: 对称 ($h[n] = h[M-1-n]$)，奇数长度 ($M$) 。$\\tau$ 是整数。$A(\\omega)$ 是关于 $\\omega$ 的实偶函数。\n2.  **II 型**: 对称 ($h[n] = h[M-1-n]$)，偶数长度 ($M$) 。$\\tau$ 是半整数。$A(\\omega)$ 是关于 $\\omega$ 的实偶函数。\n3.  **III 型**: 反对称 ($h[n] = -h[M-1-n]$)，奇数长度 ($M$) 。$\\tau$ 是整数。$A(\\omega)$ 是关于 $\\omega$ 的纯虚奇函数。注意，对于为虚数的 $A(\\omega)$，我们可以写作 $A(\\omega)=jB(\\omega)$，其中 $B(\\omega)$ 是实奇函数。因此，$H\\!\\left(e^{j\\omega}\\right) = B(\\omega) e^{-j(\\omega\\tau - \\pi/2)}$。\n4.  **IV 型**: 反对称 ($h[n] = -h[M-1-n]$)，偶数长度 ($M$) 。$\\tau$ 是半整数。$A(\\omega)$ 是关于 $\\omega$ 的纯虚奇函数。\n\n该问题要求使用快速傅里叶变换 (FFT) 对这些特性进行编程验证。步骤如下。\n\n**步骤 1：FFT 长度和频率网格**\n对于长度为 $M$ 的冲激响应 $h[n]$ 和给定的整数填充因子 $S  0$，FFT 长度 $N$ 被选为满足 $N \\ge S \\cdot M$ 的最小的2的次幂。这一选择有两个目的：首先，2的次幂对于 FFT 算法来说计算效率高；其次，大的 $N$（通过零填充和足够大的 $S$ 实现）提供了对底层连续 DTFT 谱的细粒度采样。FFT 计算 DTFT 在均匀频率网格 $\\omega_k = \\frac{2\\pi k}{N}$（其中 $k \\in \\{0, 1, \\dots, N-1\\}$）上的采样点。由于 $h[n]$ 是实数，其 DTFT 是共轭对称的，$H(e^{j\\omega}) = H^*(e^{-j\\omega})$，所以我们只需要分析频率范围 $[0, \\pi]$，这对应于索引 $k \\in \\{0, 1, \\dots, \\lfloor N/2 \\rfloor\\}$。\n\n**步骤 2：FFT 计算**\n序列 $h[n]$ 被零填充至总长度为 $N$。然后对这个填充后的序列应用 FFT。这将产生离散频率采样点 $H_k = H\\!\\left(e^{j\\omega_k}\\right)$。使用为实值输入优化的 FFT（例如 `numpy.fft.rfft`）效率更高，因为它只计算非负频率的唯一频谱点。\n\n**步骤 3：线性相位校正**\n为了验证幅度函数 $A(\\omega)$ 的特性，我们必须从计算出的频谱 $H_k$ 中移除线性相位项 $e^{-j\\omega\\tau}$。这通过计算校正后的频谱 $G_k$ 来实现：\n$$G_k = H_k \\, e^{j\\omega_k\\tau}$$\n根据理论，对于对称滤波器 ($h[n] = h[M-1-n]$)，得到的 $G_k$ 应该是纯实数，因为它代表了实值函数 $A(\\omega)$ 的采样点。对于反对称滤波器 ($h[n] = -h[M-1-n]$)，得到的 $G_k$ 应该是纯虚数，因为它代表了虚值函数 $A(\\omega)$ 的采样点。由于有限精度算术，这些值不会是完美的实数或虚数。\n\n**步骤 4：轴泄漏度量**\n为了量化与理想实轴或虚轴的偏差，定义了一个泄漏度量。对于对称滤波器，其中 $G_k$ 预期为实数，任何非零的虚部 $\\operatorname{Im}\\{G_k\\}$ 都被视为泄漏。该度量被定义为最大绝对虚部，通过 $G_k$ 的最大幅值进行归一化，使其成为一个相对度量：\n$$\\text{leakage}_{\\text{sym}} = \\frac{\\max_k |\\operatorname{Im}\\{G_k\\}|}{\\max_k |G_k|+\\varepsilon}$$\n相反，对于反对称滤波器，其中 $G_k$ 预期为虚数，任何非零的实部 $\\operatorname{Re}\\{G_k\\}$ 都是泄漏。该度量为：\n$$\\text{leakage}_{\\text{anti}} = \\frac{\\max_k |\\operatorname{Re}\\{G_k\\}|}{\\max_k |G_k|+\\varepsilon}$$\n添加小的常数 $\\varepsilon = 10^{-12}$ 是为了数值稳定性，防止在滤波器是全零序列时出现除以零的情况。\n\n**步骤 5：群延迟估计和误差**\n系统的群延迟定义为 $\\tau(\\omega) = -\\frac{d}{d\\omega} \\arg\\{H(e^{j\\omega})\\}$。对于线性相位滤波器，相位近似为 $\\phi(\\omega) = \\phi_0 - \\omega\\tau$，其中 $\\phi_0$ 是一个恒定的相位偏移（$0$ 或 $\\pm\\pi/2$）。因此群延迟是恒定的，$\\tau(\\omega) = \\tau = \\frac{M-1}{2}$。我们可以通过估计相位响应的斜率来验证这一点。\n首先，我们必须计算 $H_k$ 的展开相位以消除 $2\\pi$ 的跳变。然后，我们对展开相位样本 $\\phi(\\omega_k)$ 与频率样本 $\\omega_k$ 进行线性最小二乘拟合，得到一个模型 $\\phi(\\omega) \\approx a + b\\,\\omega$。估计的斜率 $b$ 应约等于 $-\\tau$。然后计算斜率误差为 $|b+\\tau|$。\n至关重要的是，仅在幅值 $|H_k|$ 显著的频率索引上执行此拟合。在 $|H_k|$ 接近零的频率处（即在滤波器的阻带或谱零点处），相位是不良定义的并且数值不稳定。因此，我们仅使用满足 $|H_k| \\ge 10^{-6}\\,\\max_k |H_k|$ 的索引。此过程提供了对滤波器真实群延迟的鲁棒估计。\n\n为每个测试用例实现这些步骤，将定量地确认四种典范类型的线性相位 FIR 滤波器的理论特性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates the properties of linear-phase FIR filters based on the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'h': np.array([0.2, 0.3, 0.4, 0.5, 0.4, 0.3, 0.2]), 'symmetry': 'symmetric', 'S': 16},\n        {'h': np.array([0.1, 0.05, 0.2, 0.25, 0.25, 0.2, 0.05, 0.1]), 'symmetry': 'symmetric', 'S': 8},\n        {'h': np.array([0.3, 0.2, -0.1, 0.0, 0.1, -0.2, -0.3]), 'symmetry': 'antisymmetric', 'S': 32},\n        {'h': np.array([0.4, 0.1, -0.2, 0.3, -0.3, 0.2, -0.1, -0.4]), 'symmetry': 'antisymmetric', 'S': 4},\n    ]\n\n    results = []\n    for case in test_cases:\n        h_n = case['h']\n        symmetry = case['symmetry']\n        S = case['S']\n        \n        # FIR filter length M and group delay tau\n        M = len(h_n)\n        tau = (M - 1) / 2.0\n        \n        # Step 1: Choose FFT length N\n        min_N = S * M\n        if min_N == 0:\n            N = 1\n        else:\n            # Calculate the next power of two = min_N\n            N = 1  (min_N - 1).bit_length()\n\n        # Step 2: Compute FFT\n        # Use rfft for real-valued input, which is more efficient.\n        # It computes the transform for frequencies up to the Nyquist frequency.\n        H_k = np.fft.rfft(h_n, n=N)\n        # Corresponding angular frequencies\n        omega_k = 2 * np.pi * np.fft.rfftfreq(N)\n\n        # Step 3: Form the linear-phase-corrected spectrum G_k\n        G_k = H_k * np.exp(1j * omega_k * tau)\n\n        # Step 4: Calculate axis leakage metric\n        epsilon = 1e-12\n        max_abs_G = np.max(np.abs(G_k))\n        \n        if symmetry == 'symmetric':\n            # For symmetric filters, G_k should be real. Leakage is the imaginary part.\n            leakage = np.max(np.abs(np.imag(G_k))) / (max_abs_G + epsilon)\n        else:  # antisymmetric\n            # For antisymmetric filters, G_k should be purely imaginary. Leakage is the real part.\n            leakage = np.max(np.abs(np.real(G_k))) / (max_abs_G + epsilon)\n\n        # Step 5: Estimate slope error\n        abs_H_k = np.abs(H_k)\n        # Select indices where magnitude is significant to avoid noise in phase\n        threshold = 1e-6 * np.max(abs_H_k)\n        valid_indices = np.where(abs_H_k = threshold)[0]\n        \n        if len(valid_indices)  2:\n            # Cannot fit a line with less than 2 points; this case is unlikely with given filters\n            slope_error = float('nan') \n        else:\n            omega_filtered = omega_k[valid_indices]\n            # Unwrap phase to get a continuous phase curve\n            phase_filtered = np.unwrap(np.angle(H_k[valid_indices]))\n            \n            # Perform linear least-squares fit: phase = b*omega + a\n            # np.polyfit returns coefficients of highest power first: [slope, intercept]\n            b, a = np.polyfit(omega_filtered, phase_filtered, 1)\n            \n            # The expected slope is -tau. The error is |b - (-tau)| = |b + tau|.\n            slope_error = np.abs(b + tau)\n            \n        results.append([leakage, slope_error])\n\n    # Final print statement in the exact required format.\n    # Manually format the string to avoid extra spaces from str(list).\n    formatted_results = [f\"[{l},{s}]\" for l, s in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2881267"}]}