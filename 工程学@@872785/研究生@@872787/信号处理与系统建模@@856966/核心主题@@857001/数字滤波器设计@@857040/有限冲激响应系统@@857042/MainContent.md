## 引言
有限冲激响应（Finite Impulse Response, FIR）系统是数字信号处理领域的一块核心基石。因其固有的稳定性和实现无[相位失真](@entry_id:184482)信号处理的独特能力，[FIR滤波器](@entry_id:262292)在从通信、[音频处理](@entry_id:273289)到生物医学工程的众多应用中都扮演着不可或缺的角色。然而，对于许多学习者和工程师而言，在深刻的数学原理与复杂的实际应用之间建立一座坚实的桥梁仍然是一个挑战。如何将[传递函数](@entry_id:273897)、零极点[分布](@entry_id:182848)等抽象概念，转化为能够解决具体问题的[滤波器设计](@entry_id:266363)与高效实现，是掌握FIR系统的关键。

本文旨在系统性地填补这一空白。我们将通过三个章节的递进式探索，引领读者全面掌握FIR系统。在“原理与机制”一章中，我们将奠定坚实的理论基础，深入剖析其数学定义、核心性质和设计方法。随后，在“应用与跨学科联系”一章，我们将展示这些理论如何在多速率处理、数字通信等前沿领域中发挥作用。最后，“动手实践”部分将通过精选的练习，帮助您将理论知识转化为解决实际问题的能力。这段旅程将从FIR系统的基本构成要素开始，揭示其优雅而强大的内在机制。

## 原理与机制

本章在前一章介绍的基础上，深入探讨有限冲激响应（FIR）系统的基本原理和核心机制。我们将从其数学定义出发，系统地阐述其在[频域](@entry_id:160070)中的表示、固有的稳定性和[线性相位](@entry_id:274637)等关键特性。此外，我们还将探讨[FIR滤波器](@entry_id:262292)的实现结构、经典设计方法以及在实际数字系统中不可避免的[有限字长效应](@entry_id:201338)。

### 定义与[频域](@entry_id:160070)表示

一个离散时间、[线性时不变](@entry_id:276287)（LTI）系统，如果其冲激响应 $h[n]$ 仅在有限的时间内为非零值，则被称为**有限冲激响应（Finite Impulse Response, FIR）**系统。不失一般性，我们可以假设一个因果FIR系统的冲激响应仅在 $n \in \{0, 1, \dots, M\}$ 区间内有值，其中 $M$ 是一个非负整数，代表滤波器的阶数，而滤波器的长度为 $L = M+1$。对于所有其他时间索引， $h[n] = 0$。

根据[LTI系统](@entry_id:271946)的[卷积和](@entry_id:263238)定义，输入信号 $x[n]$ 和输出信号 $y[n]$ 之间的关系为：
$$
y[n] = \sum_{k=-\infty}^{\infty} h[k] x[n-k]
$$
由于 $h[k]$ 的有限支撑特性，该无限求和可以简化为一个有限和：
$$
y[n] = \sum_{k=0}^{M} h[k] x[n-k]
$$
这个公式是FIR系统最核心的时域表达式。

为了分析系统如何处理不同频率的[正弦信号](@entry_id:196767)，我们引入**频率响应** $H(e^{j\omega})$ 的概念。[频率响应](@entry_id:183149)定义为：当输入是[复指数信号](@entry_id:273867) $x[n] = e^{j\omega n}$ 时，系统输出 $y[n]$ 的复数增益。将此输入代入[卷积和](@entry_id:263238)：
$$
y[n] = \sum_{k=0}^{M} h[k] e^{j\omega(n-k)} = e^{j\omega n} \left( \sum_{k=0}^{M} h[k] e^{-j\omega k} \right)
$$
根据[频率响应](@entry_id:183149)的定义 $y[n] = H(e^{j\omega}) e^{j\omega n}$，我们可得：
$$
H(e^{j\omega}) = \sum_{n=0}^{M} h[n] e^{-j\omega n}
$$
这个表达式恰好是冲激响应序列 $h[n]$ 的**[离散时间傅里叶变换](@entry_id:196741)（Discrete-Time Fourier Transform, DTFT）**。因此，FIR系统的[频率响应](@entry_id:183149)就是其冲激响应的DTFT [@problem_id:2872199]。

由于[复指数函数](@entry_id:169796) $e^{-j\omega n}$ 对于任意整数 $n$ 都是关于角频率 $\omega$ 的周期函数，其周期为 $2\pi$，即 $e^{-j(\omega+2\pi)n} = e^{-j\omega n}e^{-j2\pi n} = e^{-j\omega n}$。因此，$H(e^{j\omega})$ 作为这些[周期函数](@entry_id:139337)的有限[线性组合](@entry_id:154743)，其自身也必然是 $2\pi$ 周期的。这意味着我们只需在任何一个长度为 $2\pi$ 的区间（如 $[-\pi, \pi]$）上分析频率响应，就可以了解其在整个频率轴上的行为。

### [传递函数](@entry_id:273897)、极点与零点

将频率响应的概念推广到整个复平面，我们得到系统的**[传递函数](@entry_id:273897)** $H(z)$，它是冲激响应 $h[n]$ 的[Z变换](@entry_id:157804)：
$$
H(z) = \sum_{n=-\infty}^{\infty} h[n] z^{-n}
$$
对于一个长度为 $L=M+1$ 的因果FIR系统，该和同样是有限的：
$$
H(z) = \sum_{n=0}^{M} h[n] z^{-n}
$$
[频率响应](@entry_id:183149) $H(e^{j\omega})$ 就是[传递函数](@entry_id:273897) $H(z)$ 在复平面单位圆 $z = e^{j\omega}$ 上的取值 [@problem_id:2872199]。

为了更深入地理解FIR系统的行为，我们可以将 $H(z)$ 表示为 $z$ 的有理函数。通过提取公分母 $z^M$，我们得到：
$$
H(z) = \frac{h[0]z^M + h[1]z^{M-1} + \dots + h[M]}{z^M} = \frac{B(z)}{z^M}
$$
其中 $B(z)$ 是一个关于 $z$ 的 $M$ 次多项式。从这个形式可以清楚地看出：
- **极点（Poles）**：[传递函数的极点](@entry_id:266427)是使分母为零的 $z$ 值。对于FIR系统，$H(z)$ 的分母是 $z^M$，因此它在 $z=0$ 处有 $M$ 个极点（除非分子 $B(z)$ 中有零点在 $z=0$ 处与之对消）。由于所有极点都位于[单位圆](@entry_id:267290)内部，这与系统的一个重要性质——稳定性——直接相关 [@problem_id:2872176]。
- **零点（Zeros）**：传递函数的零点是使分子 $B(z)$ 为零的 $z$ 值。$B(z)$ 是一个 $M$ 次多项式，因此它在复平面上有 $M$ 个根（零点），记为 $\{z_k\}$。这些零点的位置可以任意[分布](@entry_id:182848)，它们是塑造滤波器[频率响应](@entry_id:183149)特性的关键。

[传递函数](@entry_id:273897)可以写作零点-极点的形式：
$$
H(z) = h[0] \frac{\prod_{k=1}^{M} (z - z_k)}{z^M}
$$
（此处假设 $h[0] \neq 0$）。

[频率响应](@entry_id:183149)的幅度 $|H(e^{j\omega})|$ 可以从这种零点-极点的几何关系中直观地理解。在单位圆上，$z=e^{j\omega}$，分母 $|(e^{j\omega})^M|$ 的值为1。因此，[幅度响应](@entry_id:271115)完全由零点决定：
$$
|H(e^{j\omega})| = |h[0]| \prod_{k=1}^{M} |e^{j\omega} - z_k|
$$
这个表达式的几何意义是：在[单位圆](@entry_id:267290)上任一点 $e^{j\omega}$ 的[幅度响应](@entry_id:271115)，等于从该点到所有 $M$ 个零点 $z_k$ 的欧氏距离的乘积（再乘以一个常数 $|h[0]|$）[@problem_id:2872176]。这一观点为[滤波器设计](@entry_id:266363)提供了强大的直觉：
- 若想在某个特定频率 $\omega_0$ 处完全抑制信号，只需在单位圆上对应的位置 $z_k = e^{j\omega_0}$ 放置一个零点即可。在该频率点，距离 $|e^{j\omega_0} - z_k|$ 为零，从而使得 $|H(e^{j\omega_0})|=0$。
- 将一个零点沿径向移近单位圆，它将在其对应的[角频率](@entry_id:261565)附近产生一个更深、更尖锐的“凹口”。反之，将其移离单位圆，凹口会变得更浅、更平缓 [@problem_id:2872176]。

### FIR系统的核心性质

FIR系统因其两个突出的优点而在数字信号处理中被广泛应用：固有的稳定性和实现线性相位的简易性。

#### 固有稳定性

一个[LTI系统](@entry_id:271946)的**有界输入有界输出（BIBO）稳定性**是指，对于任何有界的输入信号 $|x[n]| \le X_{\max}  \infty$，其输出信号也总是有界的 $|y[n]| \le Y_{\max}  \infty$。对于[LTI系统](@entry_id:271946)，BIBO稳定的充分必要条件是其冲激响应 $h[n]$ 是绝对可和的，即：
$$
\sum_{n=-\infty}^{\infty} |h[n]|  \infty
$$
对于一个FIR系统，其冲激响应仅在有限个点上非零，所以这个和是一个有限项的和：
$$
\sum_{n=-\infty}^{\infty} |h[n]| = \sum_{n=0}^{M} |h[n]|
$$
只要冲激响应的每个系数都是有限值（在任何实际系统中都是如此），这个和就必然是有限的。因此，**在理想的无限精度算术下，所有FIR系统都是BIBO稳定的** [@problem_id:2872173]。

在真实的硬件实现中，情况变得更加复杂。[定点算术](@entry_id:170136)会引入量化噪声和[溢出](@entry_id:172355)两种[非线性](@entry_id:637147)效应。
- **量化噪声**：即使考虑了乘法和加法后的舍入误差，只要没有[溢出](@entry_id:172355)，FIR系统的输出仍然是有界的。输出可以看作是理想输出与一个有界的累积[量化误差](@entry_id:196306)之和，因此系统仍然是BIBO稳定的 [@problem_id:2872173]。
- **溢出**：[溢出](@entry_id:172355)是[定点算术](@entry_id:170136)中一个更严重的问题。然而，FIR系统的非递归结构在此展现了其鲁棒性。每次计算输出样本 $y[n]$ 都是基于一个全新的输入数据窗口 $x[n], \dots, x[n-M]$。即使在计算某个 $y[n]$ 时发生了[溢出](@entry_id:172355)（例如，采用二进制[补码](@entry_id:756269)的回卷[溢出](@entry_id:172355)），这个错误也仅限于该样本。它不会被反馈到后续样本的计算中。因此，输出值虽然可能因[溢出](@entry_id:172355)而出错，但其[数值范围](@entry_id:752817)仍然被硬件的字长所限制，不会无限增长。这与可能因溢出而进入[极限环振荡](@entry_id:275225)并导致不稳定的递归（IIR）系统形成鲜明对比。只要通过恰当的字长设计（例如，增加[累加器](@entry_id:175215)的保护位）来完全避免溢出，FIR系统的[BIBO稳定性](@entry_id:157773)就能得到保证 [@problem_id:2872173]。

#### 线性相位特性

在许多应用（如图像处理、[数据传输](@entry_id:276754)和生物医学[信号分析](@entry_id:266450)）中，保持信号的波形至关重要。这意味着滤波器不应对信号的不同频率成分引入不同的时间延迟，否则会导致**[相位失真](@entry_id:184482)**或**[色散](@entry_id:263750)**。具有[恒定群延迟](@entry_id:270357)的滤波器可以避免这种失真。

一个[LTI系统](@entry_id:271946)被称为具有**（广义）线性相位**，如果其[频率响应](@entry_id:183149)可以写成以下形式：
$$
H(e^{j\omega}) = A(\omega) e^{-j\omega D}
$$
其中 $A(\omega)$ 是一个纯实值函数（称为**[幅度响应](@entry_id:271115)**，可正可负），而 $D$ 是一个常数。对于实系数[FIR滤波器](@entry_id:262292)，这个条件与冲激响应的对称性密切相关 [@problem_id:2881264]。

系统的**相位响应** $\phi(\omega) = \arg H(e^{j\omega})$ 是：
$$
\phi(\omega) = \arg(A(\omega)) - \omega D
$$
在 $A(\omega)$ 符号不变的频段内，$\arg(A(\omega))$ 是一个常数（0或$\pi$），因此相位 $\phi(\omega)$ 是 $\omega$ 的线性函数。

**[群延迟](@entry_id:267197)（Group Delay）** $\tau_g(\omega)$ 定义为相位的负导数，它表示信号包络通过系统时的延迟：
$$
\tau_g(\omega) = -\frac{d\phi(\omega)}{d\omega}
$$
对于上述线性相位系统，在 $A(\omega) \neq 0$ 的频段内，[群延迟](@entry_id:267197)为：
$$
\tau_g(\omega) = -\frac{d}{d\omega} (\text{const} - \omega D) = D
$$
可见，线性相位系统的群延迟是一个常数 $D$ [@problem_id:2881264]。

**[相位延迟](@entry_id:186355)（Phase Delay）** $\tau_p(\omega)$ 定义为相位的负值除以频率，表示单个频率载波的延迟：
$$
\tau_p(\omega) = -\frac{\phi(\omega)}{\omega}
$$
对于一个满足 $h[n]=h[M-n]$ 对称性的[FIR滤波器](@entry_id:262292)（即Type I和Type II），其[群延迟](@entry_id:267197)恒为 $D = M/2 = (L-1)/2$。在[幅度响应](@entry_id:271115) $A(\omega)$ 为正的频段（如典型的低通滤波器通带），[相位偏移](@entry_id:276073)为零，此时[相位延迟](@entry_id:186355)也等于 $(L-1)/2$。当[相位延迟](@entry_id:186355)和群延迟相等且为常数时，所有频率成分经历相同的时延，信号波形得以无失真地传输，仅仅是被延迟了 $(L-1)/2$ 个采样周期 [@problem_id:2881265]。这正是[线性相位FIR滤波器](@entry_id:193022)备受青睐的核心原因。

### [线性相位FIR滤波器](@entry_id:193022)的分类

实系数[线性相位FIR滤波器](@entry_id:193022)可以根据其冲激响应的**对称性**（偶对称或奇对称）和**长度** $L$（奇数或偶数）分为四种标准类型。这些特性决定了群延迟是整数还是半整数，并对频率响应在 $\omega=0$ 和 $\omega=\pi$ 处的行为施加了特定约束。令 $M = L-1$。

- **Type I：$L$为奇数，偶对称**
  - 对称性：$h[n] = h[M-n]$。
  - 群延迟：$\tau_g = M/2$ 是一个整数。
  - 频响约束：在 $\omega=0$ 和 $\omega=\pi$ 处均无强制零点。适用于设计标准低通、高通、带通、[带阻滤波器](@entry_id:261721)。

- **Type II：$L$为偶数，偶对称**
  - 对称性：$h[n] = h[M-n]$。
  - [群延迟](@entry_id:267197)：$\tau_g = M/2$ 是一个半整数（例如，2.5个样本）。
  - 频响约束：在 $\omega=\pi$ 处有强制零点，即 $H(e^{j\pi})=0$。因此不适合设计[高通滤波器](@entry_id:274953)。

- **Type III：$L$为奇数，奇对称（反对称）**
  - 对称性：$h[n] = -h[M-n]$。这要求中心的样本 $h[M/2]$ 必须为0。
  - [群延迟](@entry_id:267197)：$\tau_g = M/2$ 是一个整数。
  - 频响约束：在 $\omega=0$ 和 $\omega=\pi$ 处均有强制零点。适用于设计[带通滤波器](@entry_id:271673)以及[希尔伯特变换器](@entry_id:180336)和[微分器](@entry_id:272992)等特殊滤波器。

- **Type IV：$L$为偶数，奇对称（反对称）**
  - 对称性：$h[n] = -h[M-n]$。
  - 群延迟：$\tau_g = M/2$ 是一个半整数。
  - 频响约束：在 $\omega=0$ 处有强制零点，即 $H(e^{j0})=0$。适用于设计[带通滤波器](@entry_id:271673)以及[希尔伯特变换器](@entry_id:180336)和微分器。

这个分类[@problem_id:2881293]为滤波器设计者提供了一个清晰的指南，帮助他们根据应用需求选择合适的滤波器类型。

### 实现结构与性能

#### 直接型横式结构

[FIR滤波器](@entry_id:262292)的时域卷积公式 $y[n] = \sum_{k=0}^{M} h[k] x[n-k]$ 直接映射到一个非常流行且直观的硬件结构，称为**直接型（Direct-Form）**或**横式（Transversal）**结构。我们可以从该公式中一步步推导出此结构 [@problem_id:2872209]：

1.  **延迟线**：要计算 $y[n]$，我们需要当前的输入样本 $x[n]$ 以及过去的 $M$ 个样本 $x[n-1], \dots, x[n-M]$。这可以通过一个由 $M$ 个单位延迟元件（通常是寄存器）级联而成的“抽头延迟线”来实现。输入信号 $x[n]$ 进入该延迟线，每经过一个寄存器，信号就被延迟一个采样周期。
2.  **抽头与乘法**：在延迟线的每个节点（包括输入端和每个寄存器的输出端），我们“抽头”取出信号 $x[n-k]$。每个抽头信号都与对应的滤波器系数 $h[k]$ 相乘。这需要 $L=M+1$ 个乘法器。
3.  **加法网络**：最后，所有 $L$ 个乘积项被加在一起，形成输出样本 $y[n]$。这可以通过一个加法器树或一个累加链来完成。

这个结构因其简单、模块化和固有的稳定性（无[反馈回路](@entry_id:273536)）而广受欢迎。

#### 同步实现与[时序分析](@entry_id:178997)

在同步[数字电路](@entry_id:268512)中，上述结构通常用寄存器和组合逻辑实现。其性能，特别是最大可达的[时钟频率](@entry_id:747385)，由最长的寄存器到寄存器路径的延迟（即**[关键路径](@entry_id:265231)**）决定。

考虑一个典型的同步横式[FIR滤波器](@entry_id:262292)实现 [@problem_id:2872209]：
- 输入样本 $x[n]$ 流经一个由 $M$ 个寄存器组成的延迟线。
- 在每个[时钟周期](@entry_id:165839)，所有抽头信号 $x[n-k]$ 被锁存并稳定下来。
- 这些信号通过并行的[组合逻辑](@entry_id:265083)乘法器，产生乘积 $h[k]x[n-k]$。每个乘法器有延迟 $T_M$。
- 所有乘积项通过一个高效的[组合逻辑](@entry_id:265083)加法器树（例如二叉树结构）进行求和。对于 $L$ 个输入，加法器树的深度为 $\lceil \log_2(L) \rceil$ 级，每级延迟为 $T_A$。
- 最终的和在下一个[时钟沿](@entry_id:171051)到来之前，必须稳定在输出寄存器的输入端。

关键路径的总延迟决定了最小的[时钟周期](@entry_id:165839) $T_{\text{clk}}^{\min}$。路径从一个延迟线寄存器开始，到输出寄存器结束：
$$
T_{\text{clk}}^{\min} = T_{\text{cq}} + T_M + \lceil \log_2(L) \rceil T_A + T_{\text{su}}
$$
其中 $T_{\text{cq}}$ 是寄存器的时钟到Q端延迟，$T_M$ 是乘法器延迟，$T_A$ 是[加法器延迟](@entry_id:176526)，$T_{\text{su}}$ 是寄存器的[建立时间](@entry_id:167213)。例如，一个 $L=17$ 的滤波器，其加法器树需要 $\lceil \log_2(17) \rceil = 5$ 级加法器。给定具体的延迟参数（如 $T_M = 1.15 \text{ ns}$, $T_A = 0.28 \text{ ns}$, $T_{cq} = 0.06 \text{ ns}$, $T_{su} = 0.07 \text{ ns}$），我们可以计算出最小周期为 $0.06 + 1.15 + 5 \times 0.28 + 0.07 = 2.68 \text{ ns}$ [@problem_id:2872209]。

### [FIR滤波器设计](@entry_id:272945)原理

设计[FIR滤波器](@entry_id:262292)的任务是确定一组冲激响应系数 $\{h[n]\}$，使其[频率响应](@entry_id:183149) $H(e^{j\omega})$ 尽可能逼近一个理想的（期望的）[频率响应](@entry_id:183149) $H_d(e^{j\omega})$。主要的设计方法包括[窗函数法](@entry_id:180307)和最[优化方法](@entry_id:164468)。

#### [窗函数法](@entry_id:180307)

[窗函数法](@entry_id:180307)是一种直观且易于实现的设计技术。其步骤如下 [@problem_id:2872220]：

1.  **确定理想响应**：首先定义一个理想的[频率响应](@entry_id:183149) $H_d(e^{j\omega})$，例如一个[理想低通滤波器](@entry_id:266159)，其在[通带](@entry_id:276907)内增益为1，阻带内为0。
2.  **计算理想冲激响应**：通过对 $H_d(e^{j\omega})$ 进行逆DTFT，得到理想的冲激响应 $h_d[n]$。对于[理想低通滤波器](@entry_id:266159)，其冲激响应是一个非因果、无限长的 `sinc` 函数：
    $$
    h_d[n] = \frac{\sin(\omega_c n)}{\pi n} \quad (n \neq 0), \quad h_d[0] = \frac{\omega_c}{\pi}
    $$
    其中 $\omega_c$ 是截止频率。
3.  **[加窗](@entry_id:145465)**：由于 $h_d[n]$ 是无限长的，我们必须将其截断以获得一个有限的冲激响应。直接截断等效于将 $h_d[n]$ 乘以一个[矩形窗](@entry_id:262826)函数。更一般地，我们可以将其乘以一个长度为 $L$ 的平滑窗函数 $w[n]$，得到最终的FIR系数：
    $$
    h[n] = h_d[n] w[n]
    $$
    为了保持线性相位，通常选择一个对称的[窗函数](@entry_id:139733)，并对 $h_d[n]$ 进行适当的移位，使其中心对准窗口中心。

时域的乘法对应于[频域](@entry_id:160070)的卷积。因此，最终滤波器的[频率响应](@entry_id:183149)是理想响应与窗函数[频率响应](@entry_id:183149)的卷积：
$$
H(e^{j\omega}) = \frac{1}{2\pi} H_d(e^{j\omega}) * W(e^{j\omega})
$$
这个卷积过程解释了窗函数设计的核心权衡：
- **过渡带宽度**：理想滤波器在截止频率处的突变，在卷积后被平滑为一个过渡带。这个过渡带的宽度主要由窗函数[频谱](@entry_id:265125) $W(e^{j\omega})$ 的**[主瓣宽度](@entry_id:275029)**决定。对于[矩形窗](@entry_id:262826)，[主瓣宽度](@entry_id:275029)约为 $4\pi/L$；对于其他更平滑的窗（如Hamming, Blackman），主瓣更宽。因此，更长的滤波器长度 $L$ 会产生更窄的过渡带。例如，若要求过渡带宽度不超过 $0.08\pi$，使用[矩形窗](@entry_id:262826)则需要 $L \ge 4\pi / (0.08\pi) = 50$，选择最小的奇数长度即为 $L=51$ [@problem_id:2872220]。
- **[阻带衰减](@entry_id:275401)**：[窗函数](@entry_id:139733)[频谱](@entry_id:265125)的**[旁瓣](@entry_id:270334)**会在阻带内引起不希望的波纹（涟漪）。[旁瓣](@entry_id:270334)的峰值决定了滤波器的最小[阻带衰减](@entry_id:275401)。矩形窗的[旁瓣](@entry_id:270334)最高（约-13 dB），导致[阻带衰减](@entry_id:275401)较差。而[Hamming窗](@entry_id:147426)或[Blackman窗](@entry_id:263102)等具有更低的[旁瓣](@entry_id:270334)，可以换取更好的[阻带衰减](@entry_id:275401)，但代价是更宽的过渡带。

#### 最优[等波纹](@entry_id:269856)设计：[Parks-McClellan算法](@entry_id:268436)

[窗函数法](@entry_id:180307)虽然简单，但并非最优。它无法独立控制[通带波纹](@entry_id:276510)、阻带波纹和过渡带宽度。为了在给定滤波器长度下获得最佳性能，需要采用最[优化方法](@entry_id:164468)。**[Parks-McClellan算法](@entry_id:268436)**是一种基于**[切比雪夫逼近](@entry_id:195867)理论**和**[Remez交换算法](@entry_id:198749)**的著名技术，用于设计最优的[线性相位FIR滤波器](@entry_id:193022)。

其核心思想是在一个加权的意义上，最小化期望响应 $D(\omega)$ 与实际[幅度响应](@entry_id:271115) $A(\omega)$ 之间的最大误差（即**minimax**准则）[@problem_id:2872247]。
$$
\min_{h[n]} \left( \max_{\omega \in \text{Bands}} |W(\omega) [A(\omega) - D(\omega)]| \right)
$$
其中 $W(\omega)$ 是一个权重函数，允许我们在不同频段（如通带和[阻带](@entry_id:262648)）对误差施加不同的惩罚。

根据**交错定理（Alternation Theorem）**，对于一个由 $R$ 阶余弦多项式构成的[幅度响应](@entry_id:271115)（例如，对于Type [I型滤波器](@entry_id:265192)，其长度 $L=2R+1$），最优解的充要条件是加权误差函数在逼近频带内至少达到其最大值（即峰值误差 $\delta$）$R+2$ 次，并且正负交替。这些点被称为**极值点**。

[Parks-McClellan算法](@entry_id:268436)是一个迭代过程，它通过以下步骤找到这组极值点和对应的滤波器系数：
1.  猜测一组初始的 $R+2$ 个[极值](@entry_id:145933)点频率。
2.  在这些点上，建立一个[线性方程组](@entry_id:148943)，强制加权误差等于 $\pm\delta$。例如，对于一个 $L=5$ 的Type I滤波器（$R=2$），需要 $R+2=4$ 个[极值](@entry_id:145933)点 $\{\omega_i\}$。[方程组](@entry_id:193238)形如：
    $$
    W(\omega_i)[A(\omega_i) - D(\omega_i)] = (-1)^i \delta, \quad i=0, 1, 2, 3
    $$
    这是一个关于滤波器系数和峰值误差 $\delta$ 的[线性系统](@entry_id:147850)，可以求解 [@problem_id:2872247]。
3.  用求得的系数构造当前的[幅度响应](@entry_id:271115) $A(\omega)$。
4.  在整个[频域](@entry_id:160070)上搜索新的误差[极值](@entry_id:145933)点。
5.  如果这些新的极值点与旧的极值点相同（或误差已收敛），则算法结束。否则，用新的 $R+2$ 个最大误差点作为新的极值点，返回第2步。

这种方法设计的滤波器在通带和[阻带](@entry_id:262648)内具有**[等波纹](@entry_id:269856)**特性，即误差在所有[极值](@entry_id:145933)点上都达到相同的最大值。在给定滤波器长度和过渡带宽度的条件下，它能提供最大的[阻带衰减](@entry_id:275401)，因此被称为“最优”滤波器。

### [有限字长效应](@entry_id:201338)

将理论上设计的[FIR滤波器](@entry_id:262292)在实际硬件上实现时，必须将无限精度的系数和信号值量化为有限的字长。这引入了不可避免的误差。

#### 系数量化

滤波器系数 $h[n]$ 在存入硬件之前必须被量化为 $h_q[n]$。我们可以将这个[过程建模](@entry_id:183557)为给理想系数加上一个误差项 [@problem_id:2872246]：
$$
h_q[n] = h[n] + \epsilon[n]
$$
其中 $\epsilon[n]$ 是[量化误差](@entry_id:196306)。如果采用 $B$ 位定点数量化，误差的大小通常有界，例如 $|\epsilon[n]| \leq \delta_n$。

系数量化会使实际的频率响应 $H_q(e^{j\omega})$ 偏离理想的设计 $H(e^{j\omega})$。这个偏差 $\Delta H(e^{j\omega})$ 是误差序列的DTFT：
$$
\Delta H(e^{j\omega}) = H_q(e^{j\omega}) - H(e^{j\omega}) = \sum_{n=0}^{L-1} \epsilon[n] e^{-j\omega n}
$$
我们可以通过分析这个表达式来评估[量化效应](@entry_id:198269)的严重程度。其幅度的最坏情况（最大可能偏差）可以通过三角不等式得到：
$$
|\Delta H(e^{j\omega})| \leq \sum_{n=0}^{L-1} |\epsilon[n] e^{-j\omega n}| = \sum_{n=0}^{L-1} |\epsilon[n]| \leq \sum_{n=0}^{L-1} \delta_n
$$
这个上界是通过选择误差项 $\epsilon[n]$，使其与[复指数](@entry_id:162635)项 $e^{-j\omega n}$ 的相位完全抵消（即 $\arg(\epsilon[n]) = \omega n$）来实现的。这意味着，在任何频率上，[频率响应](@entry_id:183149)的最大可能幅度偏差是所有系数最大量化误差之和 [@problem_id:2872246]。这个简单的界限对于评估滤波器对系数量化的鲁棒性非常有用，并表明更长的滤波器（更大的 $L$）可能对系数量化更敏感。