{"hands_on_practices": [{"introduction": "掌握从极零点图几何评估傅里叶变换的第一步是建立强大的直觉。第一个练习聚焦于一个经典的二阶系统——数字谐振器。通过分析其极零点图，你将运用几何推理来预测峰值响应频率与系统极点角度之间的关系 [@problem_id:1722830]。这个练习将锻炼你将单位圆到各极点的距离变化如何共同塑造整体频率响应的形象化思维能力。", "problem": "一个稳定的、因果的、二阶离散时间线性时不变（LTI）系统由传递函数 $H(z)$ 来表征。该系统有一对位于 $p_1 = re^{j\\theta_0}$ 和 $p_2 = re^{-j\\theta_0}$ 的共轭复极点，以及两个位于原点 $z=0$ 的零点。传递函数可以写为：\n$$\nH(z) = \\frac{K z^2}{(z - re^{j\\theta_0})(z - re^{-j\\theta_0})}\n$$\n其中 $K$ 是一个正实数常量。极点半径 $r$ 的约束条件为 $0  r  1$，极点角 $\\theta_0$ 的约束条件为 $0  \\theta_0  \\frac{\\pi}{2}$。\n\n该系统的频率响应由离散时间傅里叶变换（DTFT）$H(e^{j\\omega})$ 给出，其中 $\\omega$ 是实频率变量。令 $\\omega_{peak}$ 为在 $0 \\le \\omega \\le \\pi$ 范围内使频率响应的幅度 $|H(e^{j\\omega})|$ 达到最大值的频率。\n\n基于从系统的极零点图对DTFT进行的几何评估，确定峰值频率 $\\omega_{peak}$ 和极点角 $\\theta_0$ 之间的关系。\n\nA. $\\omega_{peak}  \\theta_0$\n\nB. $\\omega_{peak} = \\theta_0$\n\nC. $\\omega_{peak} > \\theta_0$\n\nD. 该关系取决于增益 $K$ 的值。\n\nE. 如果没有 $r$ 和 $\\theta_0$ 的具体数值，则无法确定该关系。", "solution": "为了找到幅度响应 $|H(e^{j\\omega})|$ 的峰值频率 $\\omega_{peak}$，我们只需要最小化其分母的幅度平方。分母是 $D(z) = (z - re^{j\\theta_0})(z - re^{-j\\theta_0}) = z^2 - (2r\\cos\\theta_0)z + r^2$。我们需要最小化在 $z=e^{j\\omega}$ 上的 $|D(z)|^2$。\n通过复共轭相乘和化简，该表达式可以被证明等于：\n$$ f(\\omega) = (1+r^2)^2 - 4r(1+r^2)\\cos(\\theta_0)\\cos(\\omega) + 4r^2\\cos^2(\\omega) $$\n这是一个关于 $\\cos(\\omega)$ 的二次函数。令 $X = \\cos(\\omega)$，我们得到一个开口向上的抛物线：\n$$ g(X) = 4r^2 X^2 - 4r(1+r^2)\\cos(\\theta_0) X + (1+r^2)^2 $$\n此抛物线的顶点（最小值点）位于：\n$$ X^* = \\frac{4r(1+r^2)\\cos(\\theta_0)}{2 \\cdot 4r^2} = \\frac{(1+r^2)}{2r}\\cos(\\theta_0) $$\n如果这个值在 $[-1, 1]$ 区间内，那么峰值频率 $\\omega_{peak}$ 就由 $\\cos(\\omega_{peak}) = X^*$ 给出。\n\n现在，我们来比较 $\\omega_{peak}$ 和 $\\theta_0$。\n我们知道对于 $0  r  1$，有 $(1-r)^2 > 0$，这意味着 $1 - 2r + r^2 > 0$，所以 $1+r^2 > 2r$。因此，系数 $\\frac{1+r^2}{2r} > 1$。\n于是，我们有：\n$$ \\cos(\\omega_{peak}) = X^* = \\left(\\frac{1+r^2}{2r}\\right)\\cos(\\theta_0) > \\cos(\\theta_0) $$\n由于题目中给出 $0  \\theta_0  \\frac{\\pi}{2}$，并且我们寻找的峰值 $\\omega_{peak}$ 通常也在此范围内（除非峰值在直流处），所以 $\\omega_{peak}$ 和 $\\theta_0$ 都在余弦函数单调递减的区间 $(0, \\pi)$ 内。\n因为 $\\cos(\\omega_{peak}) > \\cos(\\theta_0)$，所以必定有 $\\omega_{peak}  \\theta_0$。\n\n几何上，这意味着对于极点 $p_2 = re^{-j\\theta_0}$ 的“拉力”将峰值频率从 $\\theta_0$ 向 $\\omega=0$ 的方向轻微移动。因此，峰值频率总是略小于极点角。", "answer": "$$\\boxed{A}$$", "id": "1722830"}, {"introduction": "从定性直觉转向定量分析，本练习将研究一个简单而强大的系统：由单个零点产生的陷波滤波器。你将首先基于单位圆的几何关系，推导频率响应幅度的精确表达式 [@problem_id:2874556]。然后，你将应用这一技巧来计算一个关键的滤波器指标——半峰全宽（FWHM），从而将零点位置与陷波的锐度直接联系起来。", "problem": "考虑一个离散时间线性时不变系统，其有理传递函数通过离散时间傅里叶变换 (DTFT) 在复平面的单位圆上进行求值。几何求值原理指出，在角频率 $\\omega$ 处的频率响应幅度由复平面上点 $e^{j\\omega}$ 到传递函数零点和极点的欧几里得距离的乘积之比给出。\n\n1) 从该几何原理和三角学中的和角公式出发。对于一个在单位圆上 $z_{0}=e^{j\\omega_{0}}$ 处有单个零点的系统，利用复平面的几何特性推导以下恒等式\n$$\n\\left|e^{j\\omega}-e^{j\\omega_{0}}\\right| \\;=\\; 2\\left|\\sin\\!\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\n简要解释该恒等式，说明单位圆零点如何在频率响应的幅度上于 $\\omega=\\omega_{0}$ 处产生一个陷波。\n\n2) 现在将零点沿径向移动至 $z_{0}=r\\,e^{j\\omega_{0}}$（其中 $0  r \\le 1$）并考虑一个由单个零点产生的有限冲激响应 (FIR) 滤波器，其传递函数为 $H(z)=K(1-z_{0}z^{-1})$，其中 $K > 0$ 是一个实增益常数。滤波器被归一化，使得在与陷波频率相对的频率处，其响应幅度为 1，即 $|H(e^{j(\\omega_{0}+\\pi)})| = 1$。\n推导陷波的半峰全宽 (FWHM) 作为零点半径 $r$ 的函数的闭合形式表达式。FWHM 定义为幅度响应的半功率点之间的频率宽度。假设存在这样的点。", "solution": "首先，我们处理第 1 部分中恒等式的推导。题目要求我们证明，对于单位圆上的单个零点 $z_{0}=e^{j\\omega_{0}}$，从单位圆上的一点 $e^{j\\omega}$ 到该零点的欧几里得距离由 $|e^{j\\omega}-e^{j\\omega_{0}}| = 2|\\sin(\\frac{\\omega-\\omega_{0}}{2})|$ 给出。\n我们从表达式 $|e^{j\\omega}-e^{j\\omega_{0}}|$ 开始。直接的几何方法最为高效。我们提出一个对应于两个角度平均值的复指数项公因子：\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( e^{j\\frac{\\omega-\\omega_{0}}{2}} - e^{-j\\frac{\\omega-\\omega_{0}}{2}} \\right).\n$$\n使用欧拉公式，我们回顾恒等式 $\\sin(\\theta) = \\frac{e^{j\\theta} - e^{-j\\theta}}{2j}$，这意味着 $e^{j\\theta} - e^{-j\\theta} = 2j\\sin(\\theta)$。将此应用于我们的表达式，得到：\n$$\ne^{j\\omega}-e^{j\\omega_{0}} = e^{j\\frac{\\omega+\\omega_{0}}{2}} \\left( 2j\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right) \\right).\n$$\n现在我们计算两边的幅度。乘积的幅度等于幅度的乘积：\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = \\left|e^{j\\frac{\\omega+\\omega_{0}}{2}}\\right| |2j| \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\n任何复指数 $e^{j\\phi}$ 的幅度始终为 $1$，而 $2j$ 的幅度为 $|2j| = \\sqrt{0^2 + 2^2} = 2$。因此，我们得出所需的恒等式：\n$$\n|e^{j\\omega}-e^{j\\omega_{0}}| = 1 \\cdot 2 \\cdot \\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right| = 2\\left|\\sin\\left(\\frac{\\omega-\\omega_{0}}{2}\\right)\\right|.\n$$\n这个恒等式的解释很简单。一个系统的频率响应幅度 $|H(e^{j\\omega})|$ 与点 $e^{j\\omega}$ 到系统零点的距离成正比。对于在 $e^{j\\omega_0}$ 处的单个零点，幅度响应与 $2|\\sin(\\frac{\\omega-\\omega_0}{2})|$ 成正比。当频率 $\\omega$ 等于 $\\omega_0$ 时，这个距离为零，因为 $\\sin(0) = 0$。这会在频率响应中产生一个完美的零点或“陷波”，从而完全衰减频率为 $\\omega_0$ 的信号分量。随着 $\\omega$ 远离 $\\omega_0$，幅度增加，这是陷波滤波器的特征。\n\n接下来，对于第 2 部分，我们分析具有传递函数 $H(z) = K(1 - z_0 z^{-1})$ 的系统，其中零点为 $z_0 = r e^{j\\omega_0}$（$0  r \\le 1$ 且 $K > 0$）。频率响应为 $H(e^{j\\omega}) = K(1 - r e^{j\\omega_0} e^{-j\\omega})$。根据几何原理，频率响应的幅度由增益 $K$ 乘以点 $e^{j\\omega}$ 到零点 $z_0$ 的距离给出。\n$$\n|H(e^{j\\omega})| = K |e^{j\\omega} - z_0| = K |e^{j\\omega} - r e^{j\\omega_0}|.\n$$\n为了计算此幅度，我们求其平方：\n$$\n|e^{j\\omega} - r e^{j\\omega_0}|^2 = (e^{j\\omega} - r e^{j\\omega_0})(e^{-j\\omega} - r e^{-j\\omega_0}) = 1 - r e^{j(\\omega-\\omega_0)} - r e^{-j(\\omega-\\omega_0)} + r^2 = 1 + r^2 - 2r \\cos(\\omega - \\omega_0).\n$$\n令 $\\Delta\\omega = \\omega - \\omega_0$，则频率响应的幅度平方为 $|H(e^{j\\omega})|^2 = K^2 (1 + r^2 - 2r \\cos(\\Delta\\omega))$。\n增益 $K$ 由归一化条件 $|H(e^{j(\\omega_0+\\pi)})| = 1$ 确定。在此频率下，$\\Delta\\omega = (\\omega_0+\\pi) - \\omega_0 = \\pi$，且 $\\cos(\\pi) = -1$。\n$$\n|H(e^{j(\\omega_0+\\pi)})|^2 = 1^2 = K^2 (1 + r^2 - 2r(-1)) = K^2 (1 + 2r + r^2) = K^2(1+r)^2.\n$$\n取平方根并利用 $K>0, r>0$，我们得到 $1 = K(1+r)$，即 $K = \\frac{1}{1+r}$。\n因此，归一化的幅度响应为：\n$$\n|H(e^{j\\omega})| = \\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega)}}{1+r}.\n$$\n半峰全宽 (FWHM) 是幅度处于相对于归一化最大值的半功率水平时两个频率之间的宽度 $2\\Delta\\omega_{1/2}$。参考幅度为 $1$，因此半功率水平为 $1/\\sqrt{2}$。我们令 $|H(e^{j\\omega})| = \\frac{1}{\\sqrt{2}}$ 并求解相应的频率偏移，我们将其记为 $\\Delta\\omega_{1/2}$。\n$$\n\\frac{\\sqrt{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}}{1+r} = \\frac{1}{\\sqrt{2}}.\n$$\n两边平方得到：\n$$\n\\frac{1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})}{(1+r)^2} = \\frac{1}{2}.\n$$\n我们求解 $\\cos(\\Delta\\omega_{1/2})$：\n$$\n2(1 + r^2 - 2r \\cos(\\Delta\\omega_{1/2})) = (1+r)^2 = 1 + 2r + r^2\n$$\n$$\n2 + 2r^2 - 4r \\cos(\\Delta\\omega_{1/2}) = 1 + 2r + r^2\n$$\n$$\n4r \\cos(\\Delta\\omega_{1/2}) = (2 + 2r^2) - (1 + 2r + r^2) = 1 - 2r + r^2 = (1-r)^2\n$$\n$$\n\\cos(\\Delta\\omega_{1/2}) = \\frac{(1-r)^2}{4r}.\n$$\n为了使 $\\Delta\\omega_{1/2}$ 存在实数解，必须有 $|\\cos(\\Delta\\omega_{1/2})| \\le 1$。由于 $r > 0$ 且 $(1-r)^2 \\ge 0$，该表达式是非负的。我们只需检查条件：\n$$\n\\frac{(1-r)^2}{4r} \\le 1 \\implies (1-r)^2 \\le 4r \\implies 1 - 2r + r^2 \\le 4r \\implies r^2 - 6r + 1 \\le 0.\n$$\n二次方程 $x^2 - 6x + 1 = 0$ 的根为 $x = 3 \\pm 2\\sqrt{2}$。由于抛物线开口向上, 不等式在两个根之间成立：$3 - 2\\sqrt{2} \\le r \\le 3 + 2\\sqrt{2}$。考虑到题目的约束条件 $0  r \\le 1$，半功率穿越点存在的条件是这些范围的交集，即 $3 - 2\\sqrt{2} \\le r \\le 1$。\n\n在此条件下，通过取反余弦可以找到半宽度 $\\Delta\\omega_{1/2}$。根据余弦函数的对称性，存在两个解 $\\pm \\Delta\\omega_{1/2}$，对称地分布在 $\\Delta\\omega=0$ 的两侧。\n$$\n\\Delta\\omega_{1/2} = \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\n半峰全宽 (FWHM) 是总宽度，即这两个解之差：$\\Delta\\omega_{1/2} - (-\\Delta\\omega_{1/2}) = 2\\Delta\\omega_{1/2}$。\n因此，FWHM 为：\n$$\n\\text{FWHM} = 2 \\arccos\\left(\\frac{(1-r)^2}{4r}\\right).\n$$\n这就是陷波的 FWHM 作为零点径向位置 $r$ 的函数的最终闭合形式表达式。", "answer": "$$\\boxed{2\\arccos\\left(\\frac{(1-r)^{2}}{4r}\\right)}$$", "id": "2874556"}, {"introduction": "最后的练习将深入探讨一个在高性能滤波器设计中常见的高级且实用的场景：极零点对的近似抵消。当一个极点和一个零点位置非常接近时，它们会在频率响应中产生一个微小但尖锐的特征。本练习要求你运用几何洞察力和一阶近似来确定残余陷波的幅度，揭示距离的*比率*如何控制滤波器的精细行为 [@problem_id:2874530]。", "problem": "考虑一个稳定的、因果的、最小相位的离散时间线性时不变系统，其传递函数为\n$$\nH(z) \\;=\\; R(z)\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,z^{-1}}{1 - r\\,e^{j\\theta_p}\\,z^{-1}},\n$$\n其中 $0  r  1$，$0  \\rho  1$。系统包含一个“近似相消”的极零点对，这意味着它们的径向位置和角位置都非常接近：$r \\approx \\rho$ 且 $\\theta_p \\approx \\theta_z$。传递函数的其余部分 $R(z)$ 的幅度 $|R(e^{j\\omega})|$ 在所关注的频率 $\\omega \\approx \\theta_p \\approx \\theta_z$ 的窄带内近似平坦且等于 1。\n\n我们将位置失配量化为小量 $\\Delta r \\triangleq \\rho - r$ 和 $\\Delta\\theta \\triangleq \\theta_z - \\theta_p$，其中 $|\\Delta r| \\ll 1$ 且 $|\\Delta\\theta| \\ll 1$。\n具体来说，我们考虑一种情况，其中零点比极点更靠近单位圆，即 $\\rho > r$，这会在频率响应中产生一个局部的“陷波”或凹陷。\n\n利用傅里叶变换的几何解释（即复平面中的距离），确定在零点角频率 $\\omega = \\theta_z$ 处的陷波幅度 $|H(e^{j\\theta_z})|$ 的一个关于 $|\\Delta r|$ 和 $|\\Delta\\theta|$ 的一阶精确表达式。", "solution": "系统的传递函数由下式给出\n$$ H(z) \\;=\\; R(z)\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,z^{-1}}{1 - r\\,e^{j\\theta_p}\\,z^{-1}} $$\n这种形式对应于一个零点在 $z_0 = \\rho e^{j\\theta_z}$ 且极点在 $p_0 = r e^{j\\theta_p}$ 的系统。频率响应通过在单位圆 $z = e^{j\\omega}$ 上计算 $H(z)$ 得到。\n$$ H(e^{j\\omega}) \\;=\\; R(e^{j\\omega})\\,\\frac{1 - \\rho\\,e^{j\\theta_z}\\,e^{-j\\omega}}{1 - r\\,e^{j\\theta_p}\\,e^{-j\\omega}} $$\n频率响应的幅度可以用几何解释来表示。从分子和分母中提出 $e^{-j\\omega}$ 因子，我们得到：\n$$ H(e^{j\\omega}) \\;=\\; R(e^{j\\omega})\\,\\frac{e^{-j\\omega}(e^{j\\omega} - \\rho e^{j\\theta_z})}{e^{-j\\omega}(e^{j\\omega} - r e^{j\\theta_p})} \\;=\\; R(e^{j\\omega})\\,\\frac{e^{j\\omega} - z_0}{e^{j\\omega} - p_0} $$\n因此，幅度是残余因子的幅度与单位圆上的点 $e^{j\\omega}$ 到零点 $z_0$ 的距离以及到极点 $p_0$ 的距离之比的乘积。\n$$ |H(e^{j\\omega})| \\;=\\; |R(e^{j\\omega})|\\,\\frac{|e^{j\\omega} - z_0|}{|e^{j\\omega} - p_0|} $$\n我们被要求计算在标称陷波频率 $\\omega = \\theta_z$ 处的幅度。在此频率下，我们使用给定的近似 $|R(e^{j\\theta_z})| \\approx 1$：\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{|e^{j\\theta_z} - \\rho e^{j\\theta_z}|}{|e^{j\\theta_z} - r e^{j\\theta_p}|} $$\n让我们分别分析分子和分母。\n\n分子是单位圆上的点 $e^{j\\theta_z}$ 与零点 $\\rho e^{j\\theta_z}$ 之间的距离。由于这两个点都位于从原点出发、角度为 $\\theta_z$ 的同一条射线上，它们的距离就是其半径之差：\n$$ |e^{j\\theta_z} - \\rho e^{j\\theta_z}| \\;=\\; |(1-\\rho)e^{j\\theta_z}| \\;=\\; |1-\\rho|\\,|e^{j\\theta_z}| \\;=\\; 1-\\rho $$\n因为给定 $0  \\rho  1$。\n\n分母是单位圆上的点 $e^{j\\theta_z}$ 与极点 $r e^{j\\theta_p}$ 之间的距离。\n$$ |e^{j\\theta_z} - r e^{j\\theta_p}| $$\n为了简化此表达式，我们提出 $e^{j\\theta_z}$ 并使用定义 $\\Delta\\theta = \\theta_z - \\theta_p$：\n$$ |e^{j\\theta_z} - r e^{j\\theta_p}| \\;=\\; |e^{j\\theta_z}(1 - r e^{j(\\theta_p - \\theta_z)})| \\;=\\; |e^{j\\theta_z}|\\,|1 - r e^{-j\\Delta\\theta}| \\;=\\; |1 - r e^{-j\\Delta\\theta}| $$\n所以，幅度的精确表达式（假设 $|R|=1$）为：\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{1-\\rho}{|1 - r e^{-j\\Delta\\theta}|} $$\n问题要求一个对 $|\\Delta\\theta|$ 一阶精确的表达式。让我们分析分母项 $f(\\Delta\\theta) = |1 - r e^{-j\\Delta\\theta}|$。我们可以将其平方写为：\n$$ f(\\Delta\\theta)^2 = |1 - r(\\cos(\\Delta\\theta) - j\\sin(\\Delta\\theta))|^2 = (1-r\\cos(\\Delta\\theta))^2 + (r\\sin(\\Delta\\theta))^2 $$\n$$ = 1 - 2r\\cos(\\Delta\\theta) + r^2\\cos^2(\\Delta\\theta) + r^2\\sin^2(\\Delta\\theta) = 1 + r^2 - 2r\\cos(\\Delta\\theta) $$\n为了找到一阶近似，我们在 $\\Delta\\theta=0$ 附近对 $f(\\Delta\\theta)$ 进行泰勒展开。\n$$ f(0) = \\sqrt{1 + r^2 - 2r} = \\sqrt{(1-r)^2} = 1-r $$\n一阶导数是：\n$$ f'(\\Delta\\theta) = \\frac{d}{d(\\Delta\\theta)} \\left( (1 + r^2 - 2r\\cos(\\Delta\\theta))^{1/2} \\right) = \\frac{1}{2f(\\Delta\\theta)} (2r\\sin(\\Delta\\theta)) = \\frac{r\\sin(\\Delta\\theta)}{f(\\Delta\\theta)} $$\n在 $\\Delta\\theta=0$ 处，导数为 $f'(0) = \\frac{r\\sin(0)}{f(0)} = 0$。\n泰勒展开为 $f(\\Delta\\theta) \\approx f(0) + f'(0)\\Delta\\theta + \\mathcal{O}((\\Delta\\theta)^2)$。由于 $f'(0)=0$，一阶近似就是常数项：\n$$ |1 - r e^{-j\\Delta\\theta}| \\approx f(0) = 1-r $$\n这个近似对 $|\\Delta\\theta|$ 是一阶精确的，因为第一个修正项是二阶的。\n将此近似代入我们的幅度表达式中，得到：\n$$ |H(e^{j\\theta_z})| \\;\\approx\\; \\frac{1-\\rho}{1-r} $$\n该表达式对 $|\\Delta r|$ 和 $|\\Delta\\theta|$ 都是一阶精确的。它显式地是关于 $\\rho$（因此也是关于 $\\Delta r = \\rho-r$）线性的，而关于 $\\Delta\\theta$ 是零阶的（因为 $\\Delta\\theta$ 的一阶项为零）。这与选项 A 中的近似表达式相匹配。", "answer": "$$\\boxed{A}$$", "id": "2874530"}]}