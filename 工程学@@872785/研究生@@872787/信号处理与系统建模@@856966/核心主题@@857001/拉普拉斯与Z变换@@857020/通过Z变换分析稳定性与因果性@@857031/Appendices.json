{"hands_on_practices": [{"introduction": "在分析线性时不变（LTI）系统时，一个关键步骤是将其时域描述（如差分方程）转换为Z域中的系统函数 $H(z)$。本练习将引导你完成这一过程，并利用系统函数的极点和收敛域（ROC）来判定系统的两个基本属性：因果性和稳定性。通过这个实践，你将掌握从系统方程出发，运用Z变换分析其核心特性的基本方法。[@problem_id:2906555]", "problem": "考虑一个由混合阶差分方程 $y[n] + 0.4\\,y[n-2] = x[n-1]$ 控制的离散时间线性时不变（LTI）系统。使用双边 $z$ 变换定义和时移特性，在零状态条件下推导由 $H(z) = \\frac{Y(z)}{X(z)}$ 定义的系统函数 $H(z)$。找出 $H(z)$ 的所有极点和零点，并列出所有与有理 $z$ 变换一致的允许的收敛域（ROC）。仅使用收敛域、因果性（冲激响应 $h[n]$ 在 $n \\ge 0$ 上有支撑）以及有界输入有界输出（BIBO）稳定性（$h[n]$ 绝对可和，等价于单位圆 $|z|=1$ 属于收敛域）的基本定义，判断在每个允许的收敛域下，系统是否是因果的以及是否是稳定的。\n\n最后，令 $r$ 表示 $H(z)$ 极点的公共模值，令 $N$ 为使系统同时具有因果性和稳定性的允许收敛域的数量。定义标量 $Q$ 为 $Q = r + N$。以闭式解析表达式的形式报告 $Q$。无需四舍五入。", "solution": "我们从序列 $x[n]$ 的双边 $z$ 变换定义开始，\n$$\nX(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n},\n$$\n以及时移特性，\n$$\n\\mathcal{Z}\\{x[n-k]\\} = z^{-k} X(z),\n$$\n当这些和在一个共同的收敛域（ROC）内收敛时。在零状态条件下，对给定的差分方程两边应用 $z$ 变换，得到\n$$\nY(z) + 0.4\\,z^{-2} Y(z) = z^{-1} X(z).\n$$\n通过整理项，系统函数 $H(z)$ 为\n$$\nH(z) = \\frac{Y(z)}{X(z)} = \\frac{z^{-1}}{1 + 0.4\\,z^{-2}}.\n$$\n分子和分母同乘以 $z^{2}$，得到一个等价的真有理分式形式，\n$$\nH(z) = \\frac{z}{z^{2} + 0.4}.\n$$\n\n我们从这个有理表达式中找出极点和零点。极点是分母 $z^{2} + 0.4 = 0$ 的根，即\n$$\nz = \\pm j\\sqrt{0.4} = \\pm j\\sqrt{\\frac{2}{5}} = \\pm j\\,\\frac{\\sqrt{10}}{5}.\n$$\n因此，两个极点都位于虚轴上，具有相同的模值\n$$\nr = \\left|\\pm j\\,\\frac{\\sqrt{10}}{5}\\right| = \\frac{\\sqrt{10}}{5}.\n$$\n分子是 $z$，它在 $z = 0$ 处贡献一个零点。\n\n接下来，我们列举允许的收敛域。对于具有有限个极点的有理函数 $H(z)$，收敛域是一个以原点为中心、由圆界定的环形区域，且不能包含任何极点。由于两个极点具有相同的模值 $r$，因此存在两个典型的允许收敛域：\n1. 外部收敛域，由 $|z| > r$ 给出，它向外延伸至无穷大，且不包括极点。\n2. 内部收敛域，由 $|z|  r$ 给出，它向内延伸至原点，且不包括极点。\n\n因为两个极点都位于同一个圆 $|z|=r$ 上，所以不存在非平凡的“极点之间”的环形区域，即没有不同的内外极点半径来在它们之间形成一个严格正宽度的环。零点不限制收敛域，因此 $z=0$ 处的零点可以存在于收敛域内。\n\n我们现在根据定义来判断每个收敛域的因果性和稳定性：\n- LTI 系统的因果性要求冲激响应 $h[n]$ 是一个右边序列，即当 $n0$ 时 $h[n]=0$。对于有理函数 $H(z)$, 这对应于收敛域为 $|z| > r_{\\max}$ 的形式，即排除所有极点并向无穷大延伸的外部收敛域。\n- 有界输入有界输出（BIBO）稳定性要求 $h[n]$ 绝对可和，对于有理函数 $H(z)$，这等价于单位圆 $|z|=1$ 位于收敛域内。\n\n评估每个收敛域：\n1. 收敛域 $|z| > r$：因为它是一个向无穷大延伸且不包括极点的外部收敛域，它对应于一个右边冲激响应，因此系统是因果的。由于 $r = \\frac{\\sqrt{10}}{5}  1$，单位圆 $|z|=1$ 满足 $1 > r$，因此位于此收敛域内。故此，系统在此收敛域下也是稳定的。\n2. 收敛域 $|z|  r$：这是一个向原点延伸的内部收敛域，对应于一个左边冲激响应，所以系统不是因果的。此外，由于 $r  1$，单位圆 $|z|=1$ 不包含在 $|z|  r$ 内，因此系统在此收敛域下是不稳定的。\n\n因此，恰好有一个允许的收敛域能使系统同时是因果和稳定的（即外部收敛域 $|z| > r$）。用 $N$ 表示这样的收敛域的数量，我们得到 $N=1$。公共极点模值为 $r = \\frac{\\sqrt{10}}{5}$。所求的标量是\n$$\nQ = r + N = \\frac{\\sqrt{10}}{5} + 1.\n$$\n这已经是一个闭式表达式，无需进行四舍五入。", "answer": "$$\\boxed{\\frac{\\sqrt{10}}{5}+1}$$", "id": "2906555"}, {"introduction": "Z变换的一个核心思想是，单个Z变换表达式可以对应多个不同的时域序列，而区分这些序列的关键在于其收敛域（ROC）。本练习将让你亲手实践如何通过部分分式展开和几何级数，从同一个 $X(z)$ 推导出其对应的右边序列、左边序列和双边序列。这个过程将加深你对收敛域的几何形状与信号时域特性之间内在联系的理解。[@problem_id:2906629]", "problem": "考虑一个未知序列 $x[n]$ 的双边离散时间 $z$ 变换 $X(z)$，其中\n$$\nX(z) \\;=\\; \\frac{z}{\\left(z - 0.5\\right)\\left(z - 2\\right)}.\n$$\n从双边 $z$ 变换的定义和几何级数展开出发，确定 $X(z)$ 的所有可能收敛域 (ROC)，并对每个 ROC，通过将 $X(z)$ 表示为一阶项之和并进行适当展开，计算其逆 $z$ 变换 $x[n]$。对于每个 ROC，确定 $x[n]$ 是右边序列、左边序列还是双边序列，并从第一性原理出发证明你的分类。在你的推理中，明确地只引用核心定义和几何级数恒等式，不要将变换对作为已知事实来假设。\n\n令 $u[n]$ 表示单位阶跃序列，定义为当 $n \\ge 0$ 时 $u[n] = 1$，当 $n  0$ 时 $u[n] = 0$。你的最终答案必须仅包含与三种可能的 ROC 情况相对应的 $x[n]$ 的三个闭合形式表达式，并按以下顺序排列：\n- 第一个为 $\\lvert z \\rvert  2$ 的情况，\n- 第二个为 $0.5  \\lvert z \\rvert  2$ 的情况，\n- 第三个为 $\\lvert z \\rvert  0.5$ 的情况。\n\n使用 $\\mathrm{pmatrix}$ 环境将这三个结果合并为一个单行矩阵，并严格按照该顺序排列。不需要进行数值近似或四舍五入。", "solution": "该问题具有科学依据，提法明确，并基于离散时间信号处理的既定原则。这是 $z$ 变换理论中的一个典型练习。我们将给出一个完整的、有理有据的解答。\n\n离散时间序列 $x[n]$ 的双边 $z$ 变换由洛朗 (Laurent) 级数定义：\n$$X(z) = \\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$$\n使该求和收敛的所有 $z$ 值的集合称为收敛域 (Region of Convergence, ROC)。给定的变换为：\n$$X(z) = \\frac{z}{(z - 0.5)(z - 2)}$$\n$X(z)$ 的极点是分母的根，即 $z_1 = 0.5$ 和 $z_2 = 2$。ROC 是复平面上的一个环形区域，由半径为极点模值的圆界定。ROC 不能包含任何极点。因此，位于 $|z|=0.5$ 和 $|z|=2$ 的两个极点定义了三种可能的 ROC：\n1. 外部区域：$|z| > 2$。\n2. 环形区域：$0.5  |z|  2$。\n3. 内部区域：$|z|  0.5$。请注意，由于 $z$ 变换是洛朗级数，严格来说，ROC 不能包含 $z=0$，除非 $x[n]$ 仅在 $n \\ge 0$ 时非零且变换没有极点，而本题情况并非如此。我们将此 ROC 理解为 $0  |z|  0.5$。\n\n为了求出每种情况下的逆变换，我们首先对 $X(z)$ 进行部分分式展开。标准做法是展开 $X(z)/z$：\n$$\\frac{X(z)}{z} = \\frac{1}{(z - 0.5)(z - 2)} = \\frac{A}{z - 0.5} + \\frac{B}{z - 2}$$\n系数 $A$ 和 $B$ 可用留数法求得：\n$$A = \\lim_{z \\to 0.5} (z - 0.5) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{0.5 - 2} = \\frac{1}{-1.5} = -\\frac{2}{3}$$\n$$B = \\lim_{z \\to 2} (z - 2) \\frac{1}{(z - 0.5)(z - 2)} = \\frac{1}{2 - 0.5} = \\frac{1}{1.5} = \\frac{2}{3}$$\n两边乘以 $z$ 得到 $X(z)$ 的展开式：\n$$X(z) = -\\frac{2}{3} \\frac{z}{z - 0.5} + \\frac{2}{3} \\frac{z}{z - 2}$$\n为了方便使用几何级数恒等式，我们将每一项重写为 $z^{-1}$ 的函数：\n$$X(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}} + \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$$\n令 $X_1(z) = -\\frac{2}{3} \\frac{1}{1 - 0.5z^{-1}}$ 且 $X_2(z) = \\frac{2}{3} \\frac{1}{1 - 2z^{-1}}$。\n\n求逆过程依赖于几何级数的两种展开形式，这导致一阶项 $\\frac{1}{1-az^{-1}}$ 有两种不同的逆变换。\n1.  **右边序列**：使用恒等式 $\\sum_{n=0}^{\\infty} r^n = \\frac{1}{1-r}$ (其中 $|r|1$)。令 $r=az^{-1}$。收敛要求 $|az^{-1}|  1$，即 $|z| > |a|$。\n    $$ \\frac{1}{1-az^{-1}} = \\sum_{n=0}^{\\infty} (az^{-1})^n = \\sum_{n=0}^{\\infty} a^n z^{-n} $$\n    通过与 $z$ 变换的定义进行比较，我们确定相应的序列为 $a^n u[n]$。\n2.  **左边序列**：对于 $|z|  |a|$ 的情况，我们重写该项：\n    $$ \\frac{1}{1-az^{-1}} = \\frac{-1}{az^{-1}-1} = \\frac{-1}{az^{-1}(1-a^{-1}z)} = -a^{-1}z \\frac{1}{1-a^{-1}z} $$\n    由于 $|a^{-1}z|  1$，我们可以将该分式展开为几何级数。\n    $$ -a^{-1}z \\sum_{k=0}^{\\infty} (a^{-1}z)^k = -\\sum_{k=0}^{\\infty} a^{-k-1} z^{k+1} $$\n    令 $n = -(k+1)$。当 $k$ 从 $0$ 取到 $\\infty$ 时，$n$ 从 $-1$ 取到 $-\\infty$。\n    $$ -\\sum_{n=-1}^{-\\infty} a^{n} z^{-n} = \\sum_{n=-\\infty}^{-1} (-a^n) z^{-n} $$\n    对应的序列为 $-a^n u[-n-1]$。\n\n现在我们将这些原理应用于每一种 ROC。\n\n**情况 1：ROC 为 $|z| > 2$**\n该 ROC 位于两个极点的外部，即 $|z| > 2$ 且 $|z| > 0.5$。因此，$X_1(z)$ 和 $X_2(z)$ 两项都对应于右边序列。\n- 对于 $X_1(z)$，当 $a=0.5$ 且 ROC 为 $|z|>2$（这是 $|z|>0.5$ 的一个子集）时，其逆变换为：\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- 对于 $X_2(z)$，当 $a=2$ 且 ROC 为 $|z|>2$ 时，其逆变换为：\n  $$x_2[n] = \\frac{2}{3} (2)^n u[n]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n]$$\n**分类**：该序列对于所有 $n  0$ 均为零。根据定义，这是一个**右边序列**。\n\n**情况 2：ROC 为 $0.5  |z|  2$**\n该 ROC 位于极点 $z=0.5$ 的外部，但位于极点 $z=2$ 的内部。\n- 对于 $X_1(z)$，当 $a=0.5$ 且 ROC 为 $|z|>0.5$ 时，我们使用右边序列的逆变换：\n  $$x_1[n] = -\\frac{2}{3} (0.5)^n u[n]$$\n- 对于 $X_2(z)$，当 $a=2$ 且 ROC 为 $|z|2$ 时，我们使用左边序列的逆变换：\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1]$$\n**分类**：第一项在 $n \\ge 0$ 时非零，第二项在 $n \\le -1$ 时非零。该序列在正、负时间索引上均非零，延伸至 $n \\to \\infty$ 和 $n \\to -\\infty$。这是一个**双边序列**。\n\n**情况 3：ROC 为 $|z|  0.5$**\n该 ROC 位于两个极点的内部，即 $|z|  0.5$ 且 $|z|  2$。因此，两项都对应于左边序列。\n- 对于 $X_1(z)$，当 $a=0.5$ 且 ROC 为 $|z|0.5$ 时，其逆变换为：\n  $$x_1[n] = -\\frac{2}{3} \\left( -(0.5)^n u[-n-1] \\right) = \\frac{2}{3} (0.5)^n u[-n-1]$$\n- 对于 $X_2(z)$，当 $a=2$ 且 ROC 为 $|z|0.5$（这是 $|z|2$ 的一个子集）时，其逆变换为：\n  $$x_2[n] = \\frac{2}{3} \\left( -(2)^n u[-n-1] \\right) = -\\frac{2}{3} (2)^n u[-n-1]$$\n总序列为 $x[n] = x_1[n] + x_2[n]$：\n$$x[n] = \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1]$$\n**分类**：该序列对于所有 $n > -1$ 均为零。根据定义，这是一个**左边序列**。\n\n已按要求严格地从第一性原理确定了三种可能的序列。", "answer": "$$\\boxed{\\begin{pmatrix} \\left( \\frac{2}{3} (2)^n - \\frac{2}{3} (0.5)^n \\right) u[n]  -\\frac{2}{3} (0.5)^n u[n] - \\frac{2}{3} (2)^n u[-n-1]  \\left( \\frac{2}{3} (0.5)^n - \\frac{2}{3} (2)^n \\right) u[-n-1] \\end{pmatrix}}$$", "id": "2906629"}, {"introduction": "理论与实践之间的一大差异在于模型的精确性。在理想的数学世界中，一个不稳定的极点可以通过一个零点被精确抵消，从而使系统表现出稳定性，但这种稳定性是“结构脆弱”的。本练习将通过理论分析与编程实践，揭示微小的扰动如何“揭开”被隐藏的不稳定极点，从而破坏系统的稳定性，这对理解鲁棒系统设计的至关重要性是一次深刻的实践。[@problem_id:2906587]", "problem": "考虑 $z$ 域中的离散时间线性时不变系统，其传递函数为 $H(z) = \\dfrac{B(z)}{A(z)}$，其中 $A(z)$ 和 $B(z)$ 是关于 $z^{-1}$ 的多项式。对于因果有理系统，收敛域 (ROC) 是最外层极点的外部区域，并且系统是“有界输入有界输出”(BIBO) 稳定的，当且仅当单位圆包含在收敛域内。当收敛域包含单位圆时，频率响应 $H\\!\\left(e^{j\\omega}\\right)$ 的定义是在单位圆上对 $H(z)$ 求值得到。\n\n本问题旨在探究一个掩盖了不稳定极点的精确极点-零点对消，如何被任意小的系数扰动所破坏，以及这种扰动如何在被对消因子的相位附近引起频率响应幅度的巨大变化。\n\n设置。固定一个类极点的复数 $p = r e^{j \\omega_0}$（其中 $r > 1$）和一个稳定的严格因果因子 $A_s(z) = 1 - a z^{-1}$（其中 $|a|  1$）。定义标称传递函数\n$$\nH_0(z) \\;=\\; \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)} \\;=\\; \\frac{1}{1 - a z^{-1}},\n$$\n其中，不稳定因子 $(1 - p z^{-1})$ 被精确对消。现在，通过仅扰动分子因子来破坏这种精确对消，使得零点沿径向移动到 $p(1+\\varepsilon)$，同时保持其角度 $\\omega_0$ 不变，其中 $\\varepsilon$ 是一个小的实数。也就是说，考虑如下的扰动系统族\n$$\nH_{\\varepsilon}(z) \\;=\\; \\frac{(1 - p(1+\\varepsilon) z^{-1})}{(1 - p z^{-1}) \\, (1 - a z^{-1})},\n$$\n其中 $p = r e^{j \\omega_0}$，$r > 1$，且 $|a|  1$ 保持不变。\n\n任务。\n\n1) 仅使用 $z$ 变换、极点/零点、因果性以及通过收敛域定义的 BIBO 稳定性的核心定义，从第一性原理出发论证：\n- 当 $\\varepsilon = 0$ 时，精确对消移除了位于 $z = p$ 的极点，系统简化为 $H_0(z) = 1/(1 - a z^{-1})$，若 $|a|  1$，则该系统是 BIBO 稳定的。\n- 对于任何 $\\varepsilon \\neq 0$，分母在 $z=p$（其中 $|p| = r > 1$）处仍有一个极点，因此一个因果实现的收敛域为 $|z| > r$，该区域不包含单位圆，故系统不是 BIBO 稳定的。结论是，任意小的扰动 $\\varepsilon$ 都能揭示隐藏的不稳定极点并破坏系统的稳定性。\n\n2) 令 $C_{\\varepsilon}(\\omega)$ 表示在频率 $\\omega$ 处，扰动后与未扰动前频率响应的幅度比：\n$$\nC_{\\varepsilon}(\\omega) \\;\\triangleq\\; \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega}\\right)\\right|}\n\\;=\\; \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega}\\right|}{\\left|1 - p e^{-j\\omega}\\right|}.\n$$\n从该定义出发，并且不引用任何未经证明的“捷径”公式，推导出 $C_{\\varepsilon}(\\omega_0)$ 的一个关于小 $\\varepsilon$ 的一阶近似，即在对消角度 $\\omega_0$（其中 $p = r e^{j\\omega_0}$）处，其对 $\\varepsilon$ 的主导依赖关系。将你的近似表示为 $r$ 和 $\\varepsilon$ 的函数，并保留到 $\\varepsilon$ 的主导阶。\n\n3) 实现与测试套件。实现一个程序，对下面的每个测试用例，计算：\n- 一个布尔值，用于指示因果扰动系统的 BIBO 稳定性（根据任务1的理解），\n- 你在任务2中推导出的 $C_{\\varepsilon}(\\omega_0)$ 的一阶近似，并使用给定参数求值，\n- 根据上述定义公式计算的 $C_{\\varepsilon}(\\omega_0)$ 的精确值。\n\n角度使用弧度。不涉及物理单位。测试套件包含以下四组参数集，每组指定为 $(r,\\omega_0,a,\\varepsilon)$：\n- 测试A（一般情况）：$(1.2,\\; 1.0,\\; 0.5,\\; 10^{-3})$，\n- 测试B（极点靠近单位圆，微小扰动）：$(1.01,\\; 0.75,\\; 0.5,\\; 10^{-6})$，\n- 测试C（精确对消）：$(1.1,\\; 2.3,\\; 0.3,\\; 0)$，\n- 测试D（较大扰动，稳定部分靠近边界）：$(1.05,\\; 1.8,\\; 0.9,\\; 0.05)$。\n\n你的程序应该将所有测试用例的结果输出为单行，格式为列表的列表：\n- 对每个测试用例，输出一个列表 $[b,\\; s,\\; m]$，其中 $b$ 是稳定性布尔值， $s$ 是 $C_{\\varepsilon}(\\omega_0)$ 的一阶近似值， $m$ 是 $C_{\\varepsilon}(\\omega_0)$ 的精确值。\n- 最后一行必须是一个包含四个测试列表的单一列表，打印为由方括号括起来的逗号分隔列表，例如：$[[b_1,s_1,m_1],[b_2,s_2,m_2],[b_3,s_3,m_3],[b_4,s_4,m_4]]$。\n\n你的推导必须仅从 $z$ 变换、因果性与收敛域的定义以及上面给出的 $C_{\\varepsilon}(\\omega)$ 定义出发。不要先验地假设任何未经证明的灵敏度公式。", "solution": "所述问题具有科学依据，提法得当且完整。它是在离散时间线性时不变系统稳定性分析方面一个典型且具有说明性的练习，重点关注不精确极点-零点对消的实际后果。所有提供的信息充分且一致，足以进行严谨的解答。我将继续进行。\n\n解答分为三个部分，对应于问题陈述中定义的任务。\n\n### 任务1：稳定性分析\n\n此任务要求基于因果系统的极点位置及相应的收敛域 (ROC) 来分析系统的有界输入有界输出 (BIBO) 稳定性。\n\n**情况1：精确对消 ($\\varepsilon = 0$)**\n\n标称传递函数由下式给出\n$$\nH_0(z) = \\frac{(1 - p z^{-1})}{(1 - p z^{-1}) \\, A_s(z)}\n$$\n其中 $A_s(z) = 1 - a z^{-1}$。分子在 $z=p$ 处有一个零点，分母在 $z=p$ 和 $z=a$ 处有极点。在有理函数代数中，分子和分母中的公共因子 $(1 - p z^{-1})$ 可以被对消。这种对消在数学上是有效的，并反映了与极点 $z=p$ 对应的模式在输出端是不可观测的。\n\n对消后，系统由以下降阶传递函数描述：\n$$\nH_0(z) = \\frac{1}{A_s(z)} = \\frac{1}{1 - a z^{-1}}\n$$\n这个简化后的系统在 $z=a$ 处有一个单极点。对于因果系统，收敛域是最外层极点外部的复平面区域。在这里，收敛域是 $|z| > |a|$。\n\n一个离散时间LTI系统是BIBO稳定的，当且仅当其收敛域包含单位圆，即所有满足 $|z|=1$ 的 $z$ 的集合。如果 $|a|  1$，这个条件就得到满足。问题陈述中已指明 $|a|  1$，因此单位圆确实在收敛域 $|z|>|a|$ 内。所以，当 $\\varepsilon=0$ 时，系统是 BIBO 稳定的。\n\n**情况2：扰动系统 ($\\varepsilon \\neq 0$)**\n\n扰动后的传递函数由下式给出：\n$$\nH_{\\varepsilon}(z) = \\frac{1 - p(1+\\varepsilon) z^{-1}}{(1 - p z^{-1}) \\, (1 - a z^{-1})}\n$$\n$H_{\\varepsilon}(z)$ 的极点是分母的根，即 $z=p$ 和 $z=a$。零点是分子的根，即 $z=p(1+\\varepsilon)$。由于 $\\varepsilon \\neq 0$，位于 $z=p(1+\\varepsilon)$ 的零点与位于 $z=p$ 的极点是不同的，因此不会发生极点-零点对消。\n\n因此，系统有两个极点：一个在 $z=a$，一个在 $z=p$。已知 $|p| = r > 1$ 且 $|a|1$。这意味着极点 $z=p$ 位于单位圆外，而极点 $z=a$ 位于单位圆内。\n\n对于因果系统，收敛域必须是最外层极点外部的区域。这些极点的模为 $|p|=r$ 和 $|a|$。由于 $r>1$ 且 $|a|1$，最外层的极点是 $p$。因此，收敛域为 $|z| > |p| = r$。\n\n因为 $r>1$，收敛域 $|z| > r$ 不包含单位圆 $|z|=1$。因此，该系统不是 BIBO 稳定的。\n\n**任务1的结论**\n\n对于任何非零扰动 $\\varepsilon$，无论其多么小，精确的极点-零点对消都会被破坏。位于 $z=p$（其中 $|p|>1$）的不稳定极点被“揭示”出来，并决定了因果实现的系统收敛域。由于该收敛域不包含单位圆，系统变得不稳定。这表明，通过对消不稳定极点获得的稳定性是结构不稳定的；它可能被任意小的参数变化所破坏。\n\n### 任务2：一阶近似的推导\n\n我们需要推导在特定频率 $\\omega = \\omega_0$ 处求值的幅度比 $C_{\\varepsilon}(\\omega)$ 的一阶小 $\\varepsilon$ 近似。其定义为：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{\\left|H_{\\varepsilon}\\!\\left(e^{j\\omega_0}\\right)\\right|}{\\left|H_{0}\\!\\left(e^{j\\omega_0}\\right)\\right|} = \\frac{\\left|1 - p(1+\\varepsilon) e^{-j\\omega_0}\\right|}{\\left|1 - p e^{-j\\omega_0}\\right|}\n$$\n极点位置定义为 $p = r e^{j \\omega_0}$。我们将此式和 $e^{-j\\omega_0}$ 代入表达式中。\n\n让我们分别分析分子和分母。\n\n**分子：**\n绝对值内的项是 $1 - p(1+\\varepsilon) e^{-j\\omega_0}$。代入 $p=re^{j\\omega_0}$：\n$$\n1 - (r e^{j\\omega_0})(1+\\varepsilon) e^{-j\\omega_0} = 1 - r(1+\\varepsilon) (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r(1+\\varepsilon)\n$$\n这个表达式是纯实数。因此其绝对值为 $|1 - r(1+\\varepsilon)|$。\n给定 $r > 1$ 和一个小的实数 $\\varepsilon$，量 $r(1+\\varepsilon)$ 也将大于1。因此，$1 - r(1+\\varepsilon)$ 是负数。\n$$\n|1 - r(1+\\varepsilon)| = -(1 - r(1+\\varepsilon)) = r(1+\\varepsilon) - 1\n$$\n\n**分母：**\n绝对值内的项是 $1 - p e^{-j\\omega_0}$。代入 $p=re^{j\\omega_0}$:\n$$\n1 - (r e^{j\\omega_0}) e^{-j\\omega_0} = 1 - r (e^{j\\omega_0} e^{-j\\omega_0}) = 1 - r\n$$\n这个表达式也是纯实数。其绝对值为 $|1 - r|$。\n因为 $r > 1$，量 $1-r$ 是负数。\n$$\n|1 - r| = -(1 - r) = r - 1\n$$\n\n**结合结果：**\n现在我们可以写出 $C_{\\varepsilon}(\\omega_0)$ 的表达式：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r(1+\\varepsilon) - 1}{r - 1}\n$$\n我们可以简化这个表达式：\n$$\nC_{\\varepsilon}(\\omega_0) = \\frac{r + r\\varepsilon - 1}{r - 1} = \\frac{(r - 1) + r\\varepsilon}{r - 1} = \\frac{r-1}{r-1} + \\frac{r\\varepsilon}{r-1}\n$$\n这可以简化为：\n$$\nC_{\\varepsilon}(\\omega_0) = 1 + \\frac{r}{r-1}\\varepsilon\n$$\n这个表达式对 $\\varepsilon$ 是精确线性的。问题要求一个一阶小 $\\varepsilon$ 近似。一个线性函数在 $\\varepsilon=0$ 附近的一阶泰勒级数展开就是它本身。因此，推导出的公式不是一个近似值，而是 $C_{\\varepsilon}(\\omega_0)$ 的精确表达式。对 $\\varepsilon$ 的主导依赖关系由项 $\\frac{r}{r-1}\\varepsilon$ 捕获。当 $r \\to 1^+$ 时，灵敏度因子 $\\frac{r}{r-1}$ 会变得非常大，这表明当不稳定极点靠近单位圆时，系统对扰动极其敏感。\n\n### 任务3：实现逻辑\n\n该实现将为每个测试用例 $(r, \\omega_0, a, \\varepsilon)$ 计算三个值：\n1.  **BIBO 稳定性 ($b$)**：根据任务1的分析，因果系统是 BIBO 稳定的当且仅当 $\\varepsilon = 0$。因此，如果 $\\varepsilon = 0$，布尔值 $b$ 为 `True`，否则为 `False`。\n2.  **一阶近似值 ($s$)**：根据任务2的推导，近似值为 $s = 1 + \\frac{r}{r-1}\\varepsilon$。\n3.  **精确值 ($m$)**：如任务2所示，对于特定频率 $\\omega_0$，$C_{\\varepsilon}(\\omega_0)$ 的精确值与一阶近似值相同。因此，$m = s = 1 + \\frac{r}{r-1}\\varepsilon$。这一恒等关系将反映在代码的输出中。对于 $\\varepsilon=0$ 的特殊情况，两个公式都正确地得出1。\n\n程序将遍历所提供的测试用例，为每个用例计算这三个值，并将输出格式化为列表的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes stability and frequency response magnitude ratio for perturbed LTI systems.\n    \"\"\"\n    # Test cases are defined as tuples (r, omega_0, a, epsilon).\n    test_cases = [\n        # Test A (general case)\n        (1.2, 1.0, 0.5, 1e-3),\n        # Test B (near-unit circle pole, tiny perturbation)\n        (1.01, 0.75, 0.5, 1e-6),\n        # Test C (exact cancellation)\n        (1.1, 2.3, 0.3, 0.0),\n        # Test D (larger perturbation, stable part near boundary)\n        (1.05, 1.8, 0.9, 0.05)\n    ]\n\n    results = []\n    for case in test_cases:\n        r, omega_0, a, epsilon = case\n        \n        # 1. Determine BIBO stability of the causal system.\n        # The system is stable iff the pole-zero cancellation is exact (epsilon = 0).\n        # For any epsilon != 0, the unstable pole at z=p with |p|=r>1 is not cancelled,\n        # making the causal system unstable.\n        is_stable = (epsilon == 0)\n\n        # 2. Calculate the first-order approximation for C_epsilon(omega_0).\n        # From the derivation, s = 1 + (r / (r - 1)) * epsilon.\n        # This formula is valid for r > 1.\n        if r = 1:\n            # This case is excluded by the problem statement (r > 1) but handled for robustness.\n            # The sensitivity factor r/(r-1) would be undefined or negative.\n            # We'll set results to NaN to indicate an issue.\n            approx_C = np.nan\n            exact_C = np.nan\n        else:\n            sensitivity_factor = r / (r - 1)\n            approx_C = 1.0 + sensitivity_factor * epsilon\n            \n            # 3. Calculate the exact value of C_epsilon(omega_0).\n            # As derived in the solution, for the specific frequency omega_0, the\n            # first-order approximation is identical to the exact value.\n            # C_exact = (r*(1+epsilon) - 1) / (r - 1)\n            # This algebraically simplifies to 1 + (r / (r-1)) * epsilon.\n            exact_C = approx_C\n\n        results.append([is_stable, approx_C, exact_C])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\nsolve()\n```", "id": "2906587"}]}