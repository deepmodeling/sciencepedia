{"hands_on_practices": [{"introduction": "理解最小相位和最大相位系统的核心在于认识到系统的零点位置决定了其相位特性。本练习旨在通过亲手构建一个系统来加深这一理解[@problem_id:2883573]。你将从一组指定的单位圆外零点出发，构造一个最大相位有限冲激响应(FIR)滤波器，然后通过时间反转操作推导出其对应的最小相位系统，从而具体地揭示两者零点之间的互易关系。", "problem": "令一个有限脉冲响应 (FIR) 滤波器由长度为$4$的实系数脉冲响应 $\\{h[n]\\}_{n=0}^{3}$ 表征，其双边Z变换为 $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$。角度应以弧度为单位。仅使用Z变换、因果性的基本定义和性质，以及如下所述的最小相位和最大相位系统的定义：一个离散时间线性时不变系统是最小相位的，当且仅当其所有零点都严格位于单位圆内部；是最大相位的，当且仅当其所有零点都严格位于单位圆外部。\n\n通过指定一组零点来构造一个显式的实系数 $H(z)$，使得每个零点都严格位于单位圆外部，并且满足归一化条件 $h[0]=1$。具体地，取零点位于 $z = 2 \\exp(j\\pi/3)$、$z = 2 \\exp(-j\\pi/3)$ 和 $z = 3$，并据此构造 $H(z)$。从双边Z变换的定义 $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$ 和时间反转脉冲响应 $h_{\\mathrm{rev}}[n] \\triangleq h[3-n]$ 出发，根据第一性原理推导 $h_{\\mathrm{rev}}[n]$ 的Z变换 $H_{\\mathrm{rev}}(z)$。利用此推导，严格确定 $H_{\\mathrm{rev}}(z)$ 的零点与 $H(z)$ 的零点之间的关系，并利用此关系和给定的零点位置来判断 $h_{\\mathrm{rev}}[n]$ 是否为最小相位。然后，定义延迟对齐版本 $\\tilde{h}[n]$ 为经过归一化以满足 $\\tilde{h}[0]=1$ 的时间反转脉冲响应，并令 $\\tilde{H}(z)$ 为其Z变换。最后，提供 $\\tilde{H}(z)$ 的闭式解析表达式。\n\n你的最终答案必须是这个关于 $z^{-1}$ 的 $\\tilde{H}(z)$ 的单一表达式。不需要进行数值四舍五入。", "solution": "经评估，问题陈述有效。它具有科学依据，问题提法恰当，客观且内部一致，为获得唯一解提供了所有必要的定义和数据。我们将进行严格的推导。\n\n首先，我们为指定的长度为4的FIR滤波器构造传递函数 $H(z)$。该滤波器的脉冲响应为 $\\{h[n]\\}_{n=0}^{3}$，其Z变换为 $H(z) = \\sum_{n=0}^{3} h[n] z^{-n}$。这是一个关于变量 $z^{-1}$ 的3次多项式。一个3次多项式由其3个零点和一个比例常数所表征。\n\n问题陈述了零点位于 $z_1 = 2 \\exp(j\\pi/3)$、$z_2 = 2 \\exp(-j\\pi/3)$ 和 $z_3 = 3$。因此，$H(z)$ 的一般形式为：\n$$H(z) = C \\left(1 - z_1 z^{-1}\\right) \\left(1 - z_2 z^{-1}\\right) \\left(1 - z_3 z^{-1}\\right)$$\n常数 $C$ 由归一化条件 $h[0]=1$ 确定。通过展开 $H(z)$ 的表达式，我们看到不含 $z^{-1}$ 的项是 $C$。也就是说，$h[0] = C$。因此，我们必须有 $C=1$。\n\n当 $C=1$ 时，传递函数为：\n$$H(z) = \\left(1 - 2 \\exp(j\\pi/3) z^{-1}\\right) \\left(1 - 2 \\exp(-j\\pi/3) z^{-1}\\right) \\left(1 - 3 z^{-1}\\right)$$\n为验证系数是实数，我们将共轭复数对因子合并：\n$$ \\left(1 - 2 \\exp(j\\pi/3) z^{-1}\\right) \\left(1 - 2 \\exp(-j\\pi/3) z^{-1}\\right) = 1 - 2\\left(\\exp(j\\pi/3) + \\exp(-j\\pi/3)\\right)z^{-1} + 4\\exp(0)z^{-2} $$\n使用欧拉恒等式 $\\exp(j\\theta) + \\exp(-j\\theta) = 2 \\cos(\\theta)$，我们得到：\n$$ 1 - 2\\left(2\\cos(\\pi/3)\\right)z^{-1} + 4z^{-2} = 1 - 2\\left(2 \\cdot \\frac{1}{2}\\right)z^{-1} + 4z^{-2} = 1 - 2z^{-1} + 4z^{-2} $$\n乘以剩余的因子 $(1 - 3z^{-1})$ 得到：\n$$ H(z) = (1 - 2z^{-1} + 4z^{-2})(1 - 3z^{-1}) = 1 - 3z^{-1} - 2z^{-1} + 6z^{-2} + 4z^{-2} - 12z^{-3} $$\n$$ H(z) = 1 - 5z^{-1} + 10z^{-2} - 12z^{-3} $$\n由此，脉冲响应为 $\\{h[n]\\} = \\{1, -5, 10, -12\\}$。系数是实数，符合要求。零点的模为 $|z_1|=2 > 1$、$|z_2|=2 > 1$ 和 $|z_3|=3 > 1$。由于所有零点都严格位于单位圆外部，根据定义，系统 $H(z)$ 是最大相位的。\n\n接下来，我们推导时间反转脉冲响应 $h_{\\mathrm{rev}}[n] \\triangleq h[3-n]$ 的Z变换 $H_{\\mathrm{rev}}(z)$。根据双边Z变换的定义：\n$$ H_{\\mathrm{rev}}(z) = \\sum_{n=-\\infty}^{\\infty} h_{\\mathrm{rev}}[n] z^{-n} = \\sum_{n=-\\infty}^{\\infty} h[3-n] z^{-n} $$\n序列 $h[n]$ 仅在 $n \\in \\{0, 1, 2, 3\\}$ 时非零。因此，$h_{\\mathrm{rev}}[n]$ 也仅在 $n \\in \\{0, 1, 2, 3\\}$ 时非零。我们在求和中引入变量替换，$m = 3-n$，这意味着 $n = 3-m$。当 $n$ 从 $0$ 到 $3$ 时，$m$ 从 $3$ 到 $0$。\n$$ H_{\\mathrm{rev}}(z) = \\sum_{m=0}^{3} h[m] z^{-(3-m)} = \\sum_{m=0}^{3} h[m] z^{-3} z^m = z^{-3} \\sum_{m=0}^{3} h[m] (z^{-1})^{-m} $$\n该和式是 $H(z^{-1})$ 的定义，因此我们建立以下关系：\n$$ H_{\\mathrm{rev}}(z) = z^{-3} H(z^{-1}) $$\n为了找到 $H_{\\mathrm{rev}}(z)$ 的零点，设 $p$ 为一个零点。则 $H_{\\mathrm{rev}}(p)=0$。对于任意 $p \\neq 0$，这意味着 $p^{-3} H(p^{-1}) = 0$，这要求 $H(p^{-1}) = 0$。这意味着 $p^{-1}$ 必须是 $H(z)$ 的一个零点。因此，如果 $H(z)$ 的零点是 $\\{z_k\\}$，那么 $H_{\\mathrm{rev}}(z)$ 的零点就是 $\\{p_k\\} = \\{1/z_k\\}$。\n\n$H(z)$ 的零点是 $2 \\exp(j\\pi/3)$、$2 \\exp(-j\\pi/3)$ 和 $3$。因此，$H_{\\mathrm{rev}}(z)$ 的零点是：\n$$ p_1 = \\frac{1}{2 \\exp(j\\pi/3)} = \\frac{1}{2} \\exp(-j\\pi/3) $$\n$$ p_2 = \\frac{1}{2 \\exp(-j\\pi/3)} = \\frac{1}{2} \\exp(j\\pi/3) $$\n$$ p_3 = \\frac{1}{3} $$\n这些零点的模为 $|p_1|=1/2$、$|p_2|=1/2$ 和 $|p_3|=1/3$。所有三个模都严格小于 $1$。根据问题的定义，一个系统是最小相位的，当且仅当其所有零点都严格位于单位圆内部。因此，脉冲响应为 $h_{\\mathrm{rev}}[n]$ 的系统是最小相位的。\n\n最后，我们为延迟对齐序列 $\\tilde{h}[n]$ 构造传递函数 $\\tilde{H}(z)$。该序列被定义为经过归一化以满足 $\\tilde{h}[0]=1$ 的时间反转脉冲响应。时间反转序列为 $h_{\\mathrm{rev}}[n] = h[3-n]$。其系数为：\n$h_{\\mathrm{rev}}[0] = h[3] = -12$\n$h_{\\mathrm{rev}}[1] = h[2] = 10$\n$h_{\\mathrm{rev}}[2] = h[1] = -5$\n$h_{\\mathrm{rev}}[3] = h[0] = 1$\n所以，Z变换为 $H_{\\mathrm{rev}}(z) = -12 + 10z^{-1} - 5z^{-2} + z^{-3}$。\n序列 $\\tilde{h}[n]$ 是 $h_{\\mathrm{rev}}[n]$ 的一个缩放版本，即 $\\tilde{h}[n] = A \\cdot h_{\\mathrm{rev}}[n]$。归一化常数 $A$ 可由条件 $\\tilde{h}[0]=1$ 求得：\n$$ \\tilde{h}[0] = A \\cdot h_{\\mathrm{rev}}[0] = A \\cdot (-12) = 1 \\implies A = -\\frac{1}{12} $$\n因此，Z变换 $\\tilde{H}(z)$ 与 $H_{\\mathrm{rev}}(z)$ 呈线性关系：\n$$ \\tilde{H}(z) = \\mathcal{Z}\\{\\tilde{h}[n]\\} = -\\frac{1}{12} H_{\\mathrm{rev}}(z) $$\n代入 $H_{\\mathrm{rev}}(z)$ 的表达式：\n$$ \\tilde{H}(z) = -\\frac{1}{12} \\left(-12 + 10z^{-1} - 5z^{-2} + z^{-3}\\right) $$\n将常数分配进去，得到最终的解析表达式：\n$$ \\tilde{H}(z) = 1 - \\frac{10}{12}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3} = 1 - \\frac{5}{6}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3} $$\n这个函数 $\\tilde{H}(z)$ 对应一个实系数的最小相位系统，且经过归一化，使其第一个脉冲响应系数为 $1$。", "answer": "$$\n\\boxed{1 - \\frac{5}{6}z^{-1} + \\frac{5}{12}z^{-2} - \\frac{1}{12}z^{-3}}\n$$", "id": "2883573"}, {"introduction": "了解了最小和最大相位系统的定义之后，一个自然的问题是：这种分类在实践中为何重要？这个练习将引导你探究零点位置对系统可逆性的深远影响[@problem_id:2883515]。通过分析一个非最小相位系统，你将从第一性原理出发，证明其逆系统无法同时满足因果性和稳定性，这一基本权衡在通信均衡和控制系统设计等领域至关重要。", "problem": "考虑一个离散时间线性时不变系统，其传递函数为\n$$\nH(z) \\triangleq \\frac{1 - \\frac{3}{2} z^{-1}}{1 - \\frac{1}{2} z^{-1}}.\n$$\n仅使用复$z$域中因果性、收敛域和有界输入有界输出 (BIBO) 稳定性的基本定义，按如下步骤进行。\n\n1. 从基本原理出发，验证 $H(z)$ 是因果且 BIBO 稳定的，并且它是非最小相位的。您的验证应从以下定义开始：对于有理传递函数，因果系统的收敛域是其最外层极点的外部区域，而 BIBO 稳定性要求单位圆 $|z|=1$ 位于收敛域内。同时使用以下定义：一个稳定的因果系统是最小相位的，当且仅当其所有零点都严格位于单位圆内部。\n\n2. 显式地构建逆传递函数 $H^{-1}(z)$。仅使用因果和反因果系统的收敛域定义以及 BIBO 稳定性的要求，严格证明 $H^{-1}(z)$ 的任何因果实现都不是 BIBO 稳定的，而任何 BIBO 稳定的实现都不是因果的。\n\n3. 以克罗内克δ函数 $\\delta[n]$ 和单位阶跃函数 $u[n]$ 的形式，将 $H^{-1}(z)$ 的 BIBO 稳定实现的冲激响应 $h_{s}[n]$ 显式地计算为单个闭合形式表达式。请将此表达式作为您的最终答案。不需要数值近似或四舍五入；请给出精确的解析表达式。", "solution": "我们从复$z$域中有理离散时间线性时不变系统的基本定义开始。\n\n一个有理传递函数 $H(z)$ 是因果的，如果其收敛域的形式为 $|z| > r_{p}$，其中 $r_{p}$ 是模最大的极点的模。如果其收敛域的形式为 $|z| < r_{p, \\min}$，其中 $r_{p, \\min}$ 是模最小的极点的模，则它是反因果的。一个系统是有界输入有界输出 (BIBO) 稳定的，当且仅当其收敛域包含单位圆 $|z|=1$。一个稳定的因果系统是最小相位的，当且仅当其所有零点都严格位于单位圆内部。\n\n步骤1：分析 $H(z)$ 的因果性、稳定性和最小相位属性。\n\n给定\n$$\nH(z) = \\frac{1 - \\frac{3}{2} z^{-1}}{1 - \\frac{1}{2} z^{-1}}.\n$$\n极点位于 $1 - \\frac{1}{2} z^{-1} = 0$ 的根处，即 $z = \\frac{1}{2}$。零点位于 $1 - \\frac{3}{2} z^{-1} = 0$ 的根处，即 $z = \\frac{3}{2}$。\n\n- 因果性：一个在 $z = \\frac{1}{2}$ 处有单个极点的有理传递函数，其自然的因果收敛域为 $|z| > \\frac{1}{2}$。这与一阶因果系统的右边冲激响应是一致的。因此 $H(z)$ 是因果的。\n\n- BIBO 稳定性：因果收敛域 $|z| > \\frac{1}{2}$ 包含单位圆 $|z| = 1$，因为 $1 > \\frac{1}{2}$。因此该系统是 BIBO 稳定的。\n\n- 最小相位：当所有零点都严格位于单位圆内部时，一个稳定的因果系统是最小相位的。这里零点位于 $z = \\frac{3}{2}$，它在单位圆外部。因此 $H(z)$ 是非最小相位的。\n\n步骤2：构建 $H^{-1}(z)$ 并分析其可实现性和稳定性。\n\n计算逆传递函数：\n$$\nH^{-1}(z) = \\frac{1}{H(z)} = \\frac{1 - \\frac{1}{2} z^{-1}}{1 - \\frac{3}{2} z^{-1}}.\n$$\n$H^{-1}(z)$ 的极点位于 $H(z)$ 的零点处，即 $z = \\frac{3}{2}$。$H^{-1}(z)$ 的零点位于 $H(z)$ 的极点处，即 $z = \\frac{1}{2}$。\n\n- $H^{-1}(z)$ 的因果实现：如果我们坚持因果性，收敛域必须是最外层极点的外部，即 $|z| > \\frac{3}{2}$。然而， $|z| = 1$ 并不包含在 $|z| > \\frac{3}{2}$ 中，因为 $1$ 不大于 $\\frac{3}{2}$。因此单位圆被排除在外，$H^{-1}(z)$ 的因果实现不是 BIBO 稳定的。\n\n- $H^{-1}(z)$ 的 BIBO 稳定实现：BIBO 稳定性要求单位圆 $|z| = 1$ 被包含在收敛域内。由于极点在 $z = \\frac{3}{2}$（单位圆外），任何包含 $|z| = 1$ 但不穿过极点的收敛域都必须满足 $|z| < \\frac{3}{2}$。这是一个内部收敛域，是反因果实现的标志。因此，$H^{-1}(z)$ 的任何 BIBO 稳定实现必然是非因果的（具体来说，是反因果的）。\n\n这就证明了 $H^{-1}(z)$ 要么是非因果的（如果是 BIBO 稳定的），要么是不稳定的（如果是因果的）。\n\n步骤3：计算 $H^{-1}(z)$ 的 BIBO 稳定实现的冲激响应 $h_{s}[n]$。\n\n我们首先进行部分分式分解，以分离出一个与收敛域无关的项和一个一阶项：\n$$\nH^{-1}(z) = \\frac{1 - \\frac{1}{2} z^{-1}}{1 - \\frac{3}{2} z^{-1}}.\n$$\n我们可以通过长除法或代数操作来重写它：\n$$ H^{-1}(z) = \\frac{-\\frac{1}{2}z^{-1} + 1}{-\\frac{3}{2}z^{-1} + 1} = \\frac{\\frac{1}{3}(-\\frac{3}{2}z^{-1} + \\frac{3}{2}) + 1 - \\frac{1}{2}}{-\\frac{3}{2}z^{-1} + 1} = \\frac{1}{3} + \\frac{\\frac{2}{3}}{1 - \\frac{3}{2} z^{-1}} $$\n因此\n$$\nH^{-1}(z) = \\frac{1}{3} + \\frac{\\frac{2}{3}}{1 - \\frac{3}{2} z^{-1}}.\n$$\n\n对于 BIBO 稳定实现，收敛域为 $|z| < \\frac{3}{2}$。我们现在从几何级数回顾并推导反因果 $z$ 变换对。对于 $|z| < |a|$，\n$$\n\\frac{1}{1 - a z^{-1}} \\;\\;\\xleftrightarrow{\\mathcal{Z}^{-1}}\\;\\; - a^{n} u[-n-1],\n$$\n以及\n$$\n\\frac{1}{3} \\;\\;\\xleftrightarrow{\\mathcal{Z}^{-1}}\\;\\; \\frac{1}{3} \\,\\delta[n].\n$$\n\n将这些项线性组合，\n$$\nh_{s}[n] = \\frac{1}{3} \\,\\delta[n] + \\frac{2}{3} \\left[ - \\left(\\frac{3}{2}\\right)^{n} u[-n-1] \\right] = \\frac{1}{3} \\,\\delta[n] - \\frac{2}{3} \\left(\\frac{3}{2}\\right)^{n} u[-n-1].\n$$\n这个冲激响应是反因果的（对于 $n \\leq -1$ 以及可能在 $n=0$ 时非零），其收敛域 $|z| < \\frac{3}{2}$ 包含单位圆，从而保证了 BIBO 稳定性。因此，它就是 $H^{-1}(z)$ 的 BIBO 稳定实现。\n\n这就完成了一个稳定因果非最小相位系统 $H(z)$ 的构建，并明确证明了 $H^{-1}(z)$ 要么是非因果的（如果是 BIBO 稳定的），要么是不稳定的（如果是因果的），同时给出了所要求的 BIBO 稳定逆系统的冲激响应的精确表达式。", "answer": "$$\\boxed{\\frac{1}{3}\\,\\delta[n]\\;-\\;\\frac{2}{3}\\left(\\frac{3}{2}\\right)^{n}u[-n-1]}$$", "id": "2883515"}, {"introduction": "在理论探讨之后，我们将转向一种强大的计算实践，该实践能够处理更普遍的系统。本练习将指导你实现一种基于倒谱分析的算法，将任意稳定系统分解为其最小相位和全通分量，而无需直接求解零点[@problem_id:2883549]。这个动手实践不仅展示了如何利用频谱因式分解定理，还为你提供了一个在语音处理和地球物理学等领域广泛应用的实用工具。", "problem": "给定一个复、稳定、线性时不变离散时间系统，其传递函数为 $H(z)$，由分子系数 $\\{b_{n}\\}_{n=0}^{N_{b}-1}$ 和分母系数 $\\{a_{m}\\}_{m=0}^{N_{a}-1}$ 以标准有理形式表示\n$$\nH(z) \\;=\\; \\frac{\\sum_{n=0}^{N_{b}-1} b_{n} \\, z^{-n}}{\\sum_{m=0}^{N_{a}-1} a_{m} \\, z^{-m}}, \\quad a_{0} \\neq 0.\n$$\n目标是计算一个最小相位因子 $M(z)$ 和一个全通因子 $A(z)$，使得 $H(z) = M(z) \\, A(z)$，且不显式求解 $H(z)$ 的任何零点。您的构建必须基于单位圆上非负三角多项式 $|H(e^{j \\omega})|^{2}$ 的谱分解。角度必须以弧度为单位处理。\n\n从以下基本原理出发：\n- 离散时间傅里叶变换 (DTFT) 在单位圆上的定义：$H(e^{j \\omega}) = H(z)\\big|_{z=e^{j \\omega}}$。\n- 对于任何具有绝对可和脉冲响应的稳定 $H(z)$，其功率谱 $|H(e^{j \\omega})|^{2}$ 是一个关于 $\\omega$ 的非负 $2\\pi$ 周期函数。\n- 最小相位因子 $M(z)$ 是唯一的（在相差一个正常数和一个纯延迟的意义下）因果、稳定的外谱因子，其所有零点都严格位于单位圆内，且满足 $|M(e^{j \\omega})|^{2} = |H(e^{j \\omega})|^{2}$。剩余因子 $A(z) = H(z)/M(z)$ 必须是全通的，即对所有 $\\omega$ 都有 $|A(e^{j \\omega})| = 1$。\n- 在单位圆上，Kolmogorov 的谱分解保证了如果 $\\log |H(e^{j \\omega})|$ 是可积的，那么存在一个唯一（在相差一个常数和延迟的意义下）的外部分解 $M(z)$，满足 $\\log |M(e^{j \\omega})| = \\frac{1}{2} \\log |H(e^{j \\omega})|^{2}$，同时 $M(e^{j \\omega})$ 的相位是其对数幅度的谐波共轭（单位圆上的希尔伯特变换）。\n\n您的构造性算法必须是离散的、数值可实现的，并基于以下基本原理：\n\n- 在 $K$ 个频率 $\\omega_{k} = 2\\pi k/K$（$k \\in \\{0,1,\\dots,K-1\\}$）的均匀网格上对 $H(e^{j \\omega})$ 进行采样。\n- 构成 $R(\\omega_{k}) = |H(e^{j \\omega_{k}})|^{2}$，进行数值裁剪以避免零值，并计算 $L(\\omega_{k}) = \\tfrac{1}{2} \\log R(\\omega_{k})$。\n- 通过对 $L(\\omega_{k})$ 进行长度为 $K$ 的离散傅里叶逆变换 (IDFT) 来计算实倒谱 $c[n]$。通过构造 $c_{\\text{min}}[n]$ 来强制实现最小相位，该构造保留非负时间倒谱系数，对严格正索引应用适当的加倍规则，并保留直流分量以及（若适用）奈奎斯特项。\n- 对 $c_{\\text{min}}[n]$ 的 DFT 结果取指数，以在网格上获得 $M(e^{j \\omega_{k}})$。然后设置 $A(e^{j \\omega_{k}}) = H(e^{j \\omega_{k}})/M(e^{j \\omega_{k}})$。\n- 该方法避免了显式求零点，并生成与 $|H(e^{j \\omega})|^{2}$ 的谱分解一致的 $M(e^{j \\omega})$ 和 $A(e^{j \\omega})$。\n\n您的程序必须实现上述构造，并在以下测试套件上进行验证。对于每个测试，通过 $(\\mathbf{b}, \\mathbf{a})$ 定义 $H(z)$，并生成所要求的误差度量。在 $[0,2\\pi)$ 上使用 $K = 4096$ 个点的均匀网格，单位为弧度。\n\n测试套件：\n- 测试 $1$（理想情况，已知全通滤波器）：设 $M_{0}(z)$ 是一个已知的最小相位有限脉冲响应，其系数为 $\\mathbf{m}_{0} = [0.5,\\,0.3,\\,0.2]$。设一阶全通滤波器为 $A_{1}(z) = \\dfrac{a + z^{-1}}{1 + a z^{-1}}$，其中 $a = 0.8$。定义 $H(z) = M_{0}(z)\\,A_{1}(z)$。因此，$\\mathbf{b} = \\text{conv}(\\mathbf{m}_{0}, [a,\\,1])$ 且 $\\mathbf{a} = [1,\\,a]$。\n- 测试 $2$（边界情况：纯延迟作为全通滤波器）：设 $M_{1}(z)$ 是最小相位的，其系数为 $\\mathbf{m}_{1} = [0.6,\\,0.2,\\,0.1,\\,0.05]$，并带有一个 $d = 4$ 的纯延迟。定义 $H(z) = z^{-d} M_{1}(z)$，即 $\\mathbf{b} = [0,\\,0,\\,0,\\,0,\\,0.6,\\,0.2,\\,0.1,\\,0.05]$ 且 $\\mathbf{a} = [1]$。基准全通滤波器为 $A_{2}(e^{j \\omega}) = e^{-j \\omega d}$。\n- 测试 $3$（非最小相位有限脉冲响应）：通过 $\\mathbf{b} = \\text{conv}([1,\\,-1.2],\\,[0.7,\\,0.4,\\,0.2])$ 和 $\\mathbf{a} = [1]$ 定义一个非最小相位有限脉冲响应。该系统至少有一个零点严格位于单位圆外；算法仍必须生成一个有效的 $M(e^{j \\omega})$ 和一个全通 $A(e^{j \\omega})$。\n\n对于每个测试，计算：\n- $E_{1} = \\max_{\\omega_{k}} \\left|\\,|A(e^{j \\omega_{k}})|^{2} - 1\\,\\right|$,\n- $E_{2} = \\dfrac{\\left\\|\\,|M(e^{j \\omega_{k}})| - |H(e^{j \\omega_{k}})|\\,\\right\\|_{2}}{\\left\\|\\,|H(e^{j \\omega_{k}})|\\,\\right\\|_{2}}$,\n- $E_{3}$ 定义如下：\n  - 对于测试 1，令 $A_{\\text{true}}(e^{j \\omega}) = \\dfrac{a + e^{-j \\omega}}{1 + a e^{-j \\omega}}$ 并设置 $E_{3} = \\max_{\\omega_{k}} \\left|\\,A(e^{j \\omega_{k}}) - A_{\\text{true}}(e^{j \\omega_{k}})\\,\\right|$。\n  - 对于测试 2，令 $A_{\\text{true}}(e^{j \\omega}) = e^{-j \\omega d}$ 并设置 $E_{3} = \\max_{\\omega_{k}} \\left|\\,A(e^{j \\omega_{k}}) - A_{\\text{true}}(e^{j \\omega_{k}})\\,\\right|$。\n  - 对于测试 3，设置 $E_{3} = -1.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试对应一个子列表 $[E_{1},E_{2},E_{3}]$。例如，格式必须严格为\n$$\n\\big[\\,[E_{1}^{(1)},E_{2}^{(1)},E_{3}^{(1)}],[E_{1}^{(2)},E_{2}^{(2)},E_{3}^{(2)}],[E_{1}^{(3)},E_{2}^{(3)},E_{3}^{(3)}]\\,\\big].\n$$\n不应打印任何其他文本。", "solution": "问题陈述经过了严格的验证。\n\n### 步骤 1：提取已知信息\n- **系统模型**：一个复、稳定、线性时不变（LTI）离散时间系统，具有有理传递函数 $H(z) = \\frac{\\sum_{n=0}^{N_{b}-1} b_{n} z^{-n}}{\\sum_{m=0}^{N_{a}-1} a_{m} z^{-m}}$，其中 $a_0 \\neq 0$。\n- **目标**：将 $H(z)$ 分解为最小相位因子 $M(z)$ 和全通因子 $A(z)$，使得 $H(z) = M(z) A(z)$。\n- **方法论**：分解必须在不进行显式求根的情况下执行，使用基于实倒谱谱分解的数值算法。\n- **算法步骤**：\n    1. 在 $K$ 个点的均匀网格上对 $H(e^{j \\omega})$ 进行采样，$\\omega_k = 2\\pi k/K$。\n    2. 计算功率谱 $R(\\omega_k) = |H(e^{j \\omega_k})|^2$。\n    3. 裁剪 $R(\\omega_k)$ 以避免对数函数的数值问题，并计算对数幅度谱 $L(\\omega_k) = \\frac{1}{2} \\log R(\\omega_k)$。\n    4. 通过对 $L(\\omega_k)$ 进行离散傅里叶逆变换 (IDFT) 计算实倒谱 $c[n]$。\n    5. 使用特定的加窗和缩放规则从 $c[n]$ 构建最小相位倒谱 $c_{\\text{min}}[n]$。\n    6. 通过对 $c_{\\text{min}}[n]$ 的 DFT 取指数，计算最小相位因子 $M(e^{j \\omega_k})$ 的频率响应。\n    7. 计算全通因子的频率响应为 $A(e^{j \\omega_k}) = H(e^{j \\omega_k}) / M(e^{j \\omega_k})$。\n- **参数**：网格大小 $K = 4096$。\n- **测试用例**：提供了三个由分子（$\\mathbf{b}$）和分母（$\\mathbf{a}$）系数定义的特定系统用于验证。\n    - 测试 1：已知的最小相位和全通因子，$H(z) = M_0(z)A_1(z)$。\n    - 测试 2：带纯延迟的最小相位 FIR，$H(z) = z^{-d}M_1(z)$。\n    - 测试 3：非最小相位 FIR 滤波器。\n- **误差度量**：对于每个测试，计算 $E_1 = \\max_{\\omega_k} \\left|\\,|A(e^{j \\omega_k})|^{2} - 1\\,\\right|$、$E_2 = \\frac{\\left\\|\\,|M(e^{j \\omega_k})| - |H(e^{j \\omega_k}})|\\,\\right\\|_{2}}{\\left\\|\\,|H(e^{j \\omega_k}})|\\,\\right\\|_{2}}$ 和一个特定于用例的度量 $E_3$。\n\n### 步骤 2：使用提取的已知信息进行验证\n- **科学基础**：该问题牢固地建立在数字信号处理的既定原则之上，特别是最小相位系统理论、全通分解和同态信号处理（倒谱分析）。所描述的算法是执行此类分解的标准、正确方法。作为基础提及的 Kolmogorov 定理是谱分解理论的基石。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。算法是构造性的和确定性的。输入（滤波器系数）和输出（误差度量）定义清晰。裁剪频谱的指令解决了潜在的数值不稳定性问题，确保了过程的鲁棒性。\n- **客观性**：问题以精确、客观的数学语言陈述，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：该问题是自包含的。它提供了所有必要的信息，包括理论基础、确切的数值程序、测试用例的所有参数以及所需的输出格式。没有矛盾之处。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是一个清晰、一致且科学合理的计算信号处理练习。将提供一个解决方案。\n\n### 解决方案\n\n任务是执行给定有理传递函数 $H(z)$ 的最小相位/全通分解，而不进行显式求根。所规定的方法基于复倒谱的性质，并使用离散傅里叶变换（DFT）进行数值实现。\n\n基本原理是任何有理传递函数 $H(z)$ 都可以分解为 $H(z) = M(z) A(z)$，其中 $M(z)$ 是一个最小相位系统（其所有极点和零点都在单位圆内），而 $A(z)$ 是一个全通系统（其极点是其零点的倒数，其幅度响应是恒定的）。这种分解在相差一个尺度因子和一个纯延迟的意义下是唯一的。\n\n在单位圆上，$z = e^{j\\omega}$，幅度响应之间的关系为 $|H(e^{j\\omega})| = |M(e^{j\\omega})| |A(e^{j\\omega})|$。由于对于全通滤波器 $|A(e^{j\\omega})|$ 是常数（可以归一化为 $1$），我们有 $|M(e^{j\\omega})| = |H(e^{j\\omega})|$。因此，它们的对数幅度也相等：\n$$\n\\log|M(e^{j\\omega})| = \\log|H(e^{j\\omega})|\n$$\n对于最小相位系统，其相位由其对数幅度通过希尔伯特变换唯一确定。其频率响应的复对数，$\\log M(e^{j\\omega}) = \\log|M(e^{j\\omega})| + j \\arg\\{M(e^{j\\omega})\\}$，的实部和虚部构成一个希尔伯特变换对。$\\log M(e^{j\\omega})$ 的傅里叶逆变换是复倒谱，记为 $\\hat{m}[n]$，它必须是因果的（即，对于 $n < 0$，$\\hat{m}[n] = 0$），因为 $M(z)$ 是最小相位的。\n\n指定的算法在离散频域中利用了这些性质。\n\n1.  **频率响应评估**：在 $K=4096$ 个等距频率 $\\omega_k = 2\\pi k/K$（$k=0, 1, \\dots, K-1$）的离散网格上评估频率响应 $H(e^{j\\omega})$。这是通过对给定的分子系数 $\\mathbf{b}$ 和分母系数 $\\mathbf{a}$ 使用 `scipy.signal.freqz` 函数来实现的。我们获得复数值 $H_k = H(e^{j\\omega_k})$。\n\n2.  **对数幅度谱**：我们计算对数幅度谱 $L_k = \\log|H_k|$。为了防止在任何 $|H_k|$ 为零的情况下出现 $\\log(0)$ 的数值失败，在取对数之前，会向 $|H_k|$ 添加一个小的正常数 $\\epsilon$（机器精度）。所以，$L_k = \\log(\\max(|H_k|, \\epsilon))$。\n\n3.  **实倒谱**：实倒谱 $c[n]$ 是对数幅度谱 $L_k$ 的离散傅里叶逆变换。\n    $$\n    c[n] = \\text{IDFT}\\{L_k\\} = \\frac{1}{K} \\sum_{k=0}^{K-1} L_k e^{j 2\\pi nk/K}\n    $$\n    由于 $L_k$ 是一个实偶序列（因为 $|H(e^{j\\omega})|$ 是 $\\omega$ 的偶函数），其 IDFT，$c[n]$，是一个实对称序列：对于 $n \\in \\{1, \\dots, K-1\\}$，$c[n] = c[K-n]$。\n\n4.  **最小相位倒谱**：从实倒谱 $c[n]$，我们构建最小相位因子的倒谱 $c_{\\text{min}}[n]$。该序列必须是因果的，以对应于一个最小相位系统。标准构造如下：\n    $$\n    c_{\\text{min}}[n] = \\begin{cases}\n    c[0] & \\text{for } n=0 \\\\\n    2c[n] & \\text{for } 1 \\le n < K/2 \\\\\n    c[n] & \\text{for } n = K/2 \\text{ (since } K \\text{ is even)} \\\\\n    0 & \\text{for } K/2 < n < K\n    \\end{cases}\n    $$\n    此操作有效地从实倒谱中分离出复倒谱的因果部分。\n\n5.  **因子重构**：$c_{\\text{min}}[n]$ 的 DFT 产生最小相位因子频率响应的复对数，$\\log M_k = \\text{DFT}\\{c_{\\text{min}}[n]\\}$。$\\log M_k$ 的实部与原始对数幅度谱 $L_k$ 相同，而其虚部是 $L_k$ 的离散希尔伯特变换。\n    然后通过取指数恢复最小相位频率响应 $M_k$：\n    $$\n    M_k = \\exp(\\log M_k)\n    $$\n    最后，通过除法计算全通因子的频率响应 $A_k$：\n    $$\n    A_k = H_k / M_k\n    $$\n\n6.  **误差计算**：使用指定的误差度量 $E_1$、$E_2$ 和 $E_3$ 对计算出的因子 $M_k$ 和 $A_k$ 与其理论性质进行评估。$E_1$ 验证 $|A_k|^2 \\approx 1$。$E_2$ 验证 $|M_k| \\approx |H_k|$。$E_3$ 量化了计算出的全通因子与部分测试中已知真实值相比的准确性。\n\n对问题陈述中指定的三个测试用例中的每一个都实施此过程。", "answer": "```python\nimport numpy as np\nfrom scipy import signal\n\ndef solve():\n    \"\"\"\n    Implements the minimum-phase/all-pass decomposition using cepstral analysis\n    and validates it on the given test suite.\n    \"\"\"\n    K = 4096  # Number of points on the frequency grid\n\n    # Define test cases\n    m0 = np.array([0.5, 0.3, 0.2])\n    a_param = 0.8\n    test1_b = np.convolve(m0, [a_param, 1])\n    test1_a = np.array([1, a_param])\n\n    m1 = np.array([0.6, 0.2, 0.1, 0.05])\n    delay = 4\n    test2_b = np.concatenate((np.zeros(delay), m1))\n    test2_a = np.array([1.0])\n\n    test3_b = np.convolve([1, -1.2], [0.7, 0.4, 0.2])\n    test3_a = np.array([1.0])\n\n    test_cases = [\n        {'b': test1_b, 'a': test1_a, 'e3_type': 'test1', 'params': {'a': a_param}},\n        {'b': test2_b, 'a': test2_a, 'e3_type': 'test2', 'params': {'d': delay}},\n        {'b': test3_b, 'a': test3_a, 'e3_type': 'test3', 'params': {}},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        b = case['b']\n        a = case['a']\n        e3_type = case['e3_type']\n        params = case['params']\n\n        # 1. Sample H(e^jω) on a uniform grid\n        omega, h = signal.freqz(b, a, worN=K, whole=True)\n\n        # 2. Form L(ωk)\n        abs_h = np.abs(h)\n        log_magnitude_h = np.log(np.maximum(abs_h, np.finfo(float).eps))\n\n        # 3. Compute real cepstrum c[n]\n        c = np.fft.ifft(log_magnitude_h).real\n\n        # 4. Construct minimum-phase cepstrum c_min[n]\n        c_min = np.zeros(K, dtype=float)\n        c_min[0] = c[0]\n        c_min[1:K//2] = 2 * c[1:K//2]\n        c_min[K//2] = c[K//2]\n\n        # 5. Exponentiate DFT of c_min[n] to get M(e^jω)\n        log_M = np.fft.fft(c_min)\n        M = np.exp(log_M)\n\n        # 6. Compute A(e^jω) = H(e^jω) / M(e^jω)\n        A = h / M\n\n        # 7. Compute error metrics\n        # E1 = max| |A(e^jωk)|² - 1 |\n        E1 = np.max(np.abs(np.abs(A)**2 - 1))\n\n        # E2 = |||M(e^jωk)| - |H(e^jωk)|||₂ / |||H(e^jωk)|||₂\n        numerator_e2 = np.linalg.norm(np.abs(M) - abs_h)\n        denominator_e2 = np.linalg.norm(abs_h)\n        if denominator_e2 > np.finfo(float).eps:\n            E2 = numerator_e2 / denominator_e2\n        else:\n            E2 = numerator_e2\n        \n        # E3 calculation depends on the test case\n        if e3_type == 'test1':\n            a_val = params['a']\n            z_inv = np.exp(-1j * omega)\n            A_true = (a_val + z_inv) / (1 + a_val * z_inv)\n            E3 = np.max(np.abs(A - A_true))\n        elif e3_type == 'test2':\n            d_val = params['d']\n            A_true = np.exp(-1j * omega * d_val)\n            E3 = np.max(np.abs(A - A_true))\n        elif e3_type == 'test3':\n            E3 = -1.0\n        else:\n            E3 = -1.0\n\n        results.append([E1, E2, E3])\n\n    sub_results_str = [f\"[{e1},{e2},{e3}]\" for e1, e2, e3 in results]\n    final_output = f\"[[{','.join(sub_results_str)}]]\"\n    # The required format is [[...],[...],[...]], not [[...], [...], [...]]\n    final_output = f\"[{','.join(sub_results_str)}]\"\n\n    print(final_output)\n\nsolve()\n```", "id": "2883549"}]}