{"hands_on_practices": [{"introduction": "在理想情况下，我们希望输入信号能完全利用ADC的整个动态范围以获得最佳的信噪比。然而在实际应用中，为了避免削波（clipping）并为具有高峰均功率比（crest factor）的信号留出裕量，输入信号的幅度通常会从满量程（full-scale）回退。这个练习将引导您从第一性原理出发，推导当输入正弦波幅度减小时，信噪比（$\\mathrm{SQNR}$）会如何变化，从而量化这种性能上的权衡 [@problem_id:2898438]。", "problem": "一台模数转换器 (ADC) 采用分辨率为 $B$ 位的均匀中置型量化器，其对称满量程范围为 $\\left[-A_{\\mathrm{FS}},\\,A_{\\mathrm{FS}}\\right]$。该量化器使用四舍五入法，并且未过载。假设采用经典的加性、白色、与信号无关的量化噪声模型，其中量化误差在单个量化步长内均匀分布。输入端施加一个单音正弦信号 $x(t)=A\\cos(\\omega_{0}t)$。\n\n将量化信噪比 (SQNR) 定义为输入信号的平均功率与量化误差功率之比，并通过 $10\\log_{10}(\\cdot)$ 定义其分贝 (dB) 度量。设 $\\mathrm{SQNR}_{\\mathrm{dB,ref}}$ 为正弦信号使用全部可用峰值幅度 $A=A_{\\mathrm{FS}}$ 时的分贝值 SQNR，设 $\\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma)$ 为正弦信号幅度回退至 $A=\\gamma A_{\\mathrm{FS}}$ 以提供波峰因数裕量时的分贝值 SQNR，其中 $\\gamma\\in(0,1)$。\n\n从均匀量化、正弦信号平均功率和所述噪声模型的第一性原理出发，推导分贝偏移量\n$$\\Delta_{\\mathrm{dB}}=\\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma)-\\mathrm{SQNR}_{\\mathrm{dB,ref}}$$\n的闭式表达式，该表达式仅依赖于 $\\gamma$。最终答案以分贝表示。不需要进行数值计算，也不需要进行舍入。最终答案必须是一个单一的闭式解析表达式。", "solution": "所述问题是有效的。它有科学依据、提法得当、客观，并包含了严谨推导所需的所有必要信息。这是模数转换分析中的一个标准问题。我将按要求从第一性原理出发进行求解。\n\n问题要求计算分贝偏移量 $\\Delta_{\\mathrm{dB}} = \\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma) - \\mathrm{SQNR}_{\\mathrm{dB,ref}}$。我们必须首先推导出量化信噪比 (SQNR) 的表达式。\n\n首先，我们确定量化步长 $\\Delta$。量化器的分辨率为 $B$ 位，对应于 $L = 2^B$ 个量化电平。满量程范围指定为 $[-A_{\\mathrm{FS}}, A_{\\mathrm{FS}}]$，因此总跨度为 $A_{\\mathrm{FS}} - (-A_{\\mathrm{FS}}) = 2A_{\\mathrm{FS}}$。对于均匀量化器，步长 $\\Delta$ 是总范围除以电平数：\n$$\n\\Delta = \\frac{2A_{\\mathrm{FS}}}{L} = \\frac{2A_{\\mathrm{FS}}}{2^B}\n$$\n\n接下来,我们计算量化噪声功率 $P_q$。问题指出，量化误差（我们用 $e$ 表示）被建模为一个在单个量化步长上均匀分布的随机变量。对于一个使用四舍五入的中置型量化器，任何给定样本的误差位于区间 $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$ 内。因此，误差 $e$ 的概率密度函数 (PDF) 为：\n$$\np_e(x) = \\begin{cases} \\frac{1}{\\Delta} & \\text{for } -\\frac{\\Delta}{2} \\le x \\le \\frac{\\Delta}{2} \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n噪声功率 $P_q$ 是量化误差的方差, $\\sigma_e^2 = E[e^2] - (E[e])^2$。由于 PDF 关于零点对称，平均误差为 $E[e] = 0$。因此，功率等于均方值 $E[e^2]$：\n$$\nP_q = E[e^2] = \\int_{-\\infty}^{\\infty} x^2 p_e(x) \\,dx = \\int_{-\\Delta/2}^{\\Delta/2} x^2 \\frac{1}{\\Delta} \\,dx\n$$\n计算该积分：\n$$\nP_q = \\frac{1}{\\Delta} \\left[ \\frac{x^3}{3} \\right]_{-\\Delta/2}^{\\Delta/2} = \\frac{1}{3\\Delta} \\left( \\left(\\frac{\\Delta}{2}\\right)^3 - \\left(-\\frac{\\Delta}{2}\\right)^3 \\right) = \\frac{1}{3\\Delta} \\left( \\frac{\\Delta^3}{8} + \\frac{\\Delta^3}{8} \\right) = \\frac{1}{3\\Delta} \\left( \\frac{2\\Delta^3}{8} \\right) = \\frac{\\Delta^2}{12}\n$$\n这是均匀分布量化噪声功率的著名结果。\n\n现在，我们确定输入信号的平均功率 $P_x$。信号是一个单音正弦信号 $x(t) = A\\cos(\\omega_0 t)$。平均功率是信号的均方值，在一个周期 $T_0 = 2\\pi/\\omega_0$ 上计算得出：\n$$\nP_x = \\frac{1}{T_0} \\int_{0}^{T_0} x^2(t) \\,dt = \\frac{1}{T_0} \\int_{0}^{T_0} \\left( A\\cos(\\omega_0 t) \\right)^2 \\,dt = \\frac{A^2}{T_0} \\int_{0}^{T_0} \\cos^2(\\omega_0 t) \\,dt\n$$\n使用三角恒等式 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$：\n$$\nP_x = \\frac{A^2}{T_0} \\int_{0}^{T_0} \\frac{1}{2}(1 + \\cos(2\\omega_0 t)) \\,dt = \\frac{A^2}{2T_0} \\left[ t + \\frac{\\sin(2\\omega_0 t)}{2\\omega_0} \\right]_{0}^{T_0}\n$$\n正弦项在 $t=0$ 和 $t=T_0$ 时均为零。因此，表达式简化为：\n$$\nP_x = \\frac{A^2}{2T_0} (T_0) = \\frac{A^2}{2}\n$$\n\nSQNR 定义为信号功率与量化噪声功率之比：\n$$\n\\mathrm{SQNR} = \\frac{P_x}{P_q} = \\frac{A^2 / 2}{\\Delta^2 / 12} = \\frac{6A^2}{\\Delta^2}\n$$\n我们代入 $\\Delta$ 的表达式：\n$$\n\\mathrm{SQNR} = \\frac{6A^2}{\\left( \\frac{2A_{\\mathrm{FS}}}{2^B} \\right)^2} = \\frac{6A^2 \\cdot (2^B)^2}{4A_{\\mathrm{FS}}^2} = \\frac{3}{2} \\left( \\frac{A}{A_{\\mathrm{FS}}} \\right)^2 2^{2B}\n$$\n这是均匀量化器中正弦信号 SQNR 的通用表达式。\n\n现在我们将其转换为分贝 (dB) 并对两种指定情况进行求值。dB 度量由 $10\\log_{10}(\\cdot)$ 给出。\n$$\n\\mathrm{SQNR}_{\\mathrm{dB}} = 10\\log_{10}(\\mathrm{SQNR}) = 10\\log_{10}\\left( \\frac{3}{2} \\left( \\frac{A}{A_{\\mathrm{FS}}} \\right)^2 2^{2B} \\right)\n$$\n利用对数的性质：\n$$\n\\mathrm{SQNR}_{\\mathrm{dB}} = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 10\\log_{10}\\left(\\left(\\frac{A}{A_{\\mathrm{FS}}}\\right)^2\\right) + 10\\log_{10}\\left(2^{2B}\\right)\n$$\n$$\n\\mathrm{SQNR}_{\\mathrm{dB}} = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20\\log_{10}\\left(\\frac{A}{A_{\\mathrm{FS}}}\\right) + 20B\\log_{10}(2)\n$$\n\n对于参考情况，正弦信号使用全部峰值幅度，即 $A = A_{\\mathrm{FS}}$。\n$$\n\\mathrm{SQNR}_{\\mathrm{dB,ref}} = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20\\log_{10}\\left(\\frac{A_{\\mathrm{FS}}}{A_{\\mathrm{FS}}}\\right) + 20B\\log_{10}(2)\n$$\n由于 $\\log_{10}(1)=0$，上式变为：\n$$\n\\mathrm{SQNR}_{\\mathrm{dB,ref}} = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20B\\log_{10}(2)\n$$\n\n对于回退情况，幅度为 $A = \\gamma A_{\\mathrm{FS}}$，其中 $\\gamma \\in (0,1)$。\n$$\n\\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma) = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20\\log_{10}\\left(\\frac{\\gamma A_{\\mathrm{FS}}}{A_{\\mathrm{FS}}}\\right) + 20B\\log_{10}(2)\n$$\n$$\n\\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma) = 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20\\log_{10}(\\gamma) + 20B\\log_{10}(2)\n$$\n\n最后，我们计算所需的分贝偏移量 $\\Delta_{\\mathrm{dB}}$：\n$$\n\\Delta_{\\mathrm{dB}} = \\mathrm{SQNR}_{\\mathrm{dB}}(\\gamma) - \\mathrm{SQNR}_{\\mathrm{dB,ref}}\n$$\n$$\n\\Delta_{\\mathrm{dB}} = \\left( 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20\\log_{10}(\\gamma) + 20B\\log_{10}(2) \\right) - \\left( 10\\log_{10}\\left(\\frac{3}{2}\\right) + 20B\\log_{10}(2) \\right)\n$$\n除含 $\\gamma$ 的项外，所有其他项都相互抵消。\n$$\n\\Delta_{\\mathrm{dB}} = 20\\log_{10}(\\gamma)\n$$\n该表达式仅依赖于 $\\gamma$，符合要求。由于 $\\gamma \\in (0,1)$，$\\log_{10}(\\gamma)$ 为负值，这正确地表明回退信号幅度会降低 SQNR。", "answer": "$$\n\\boxed{20\\log_{10}(\\gamma)}\n$$", "id": "2898438"}, {"introduction": "在许多数字信号处理（DSP）系统中，为了效率和成本，运算都是在固定点算术下进行的，而非理想的实数运算。这要求在乘法等操作后进行截位（truncation）或舍入，而这些操作本身就是一种量化过程。此练习模拟了一个多级信号处理链，旨在揭示截位操作引入的确定性偏差（非零均值误差）是如何在系统中累积和传播的，并最终影响线性滤波器的输出 [@problem_id:2898430]。", "problem": "我们构建了一个离散时间信号链，以研究乘法后截断所产生的确定性偏差如何在线性滤波器中传播。输入是一个零均值、具有有限二阶矩的广义平稳过程，记为 $x[n]$，并满足 $\\mathbb{E}\\{x[n]\\}=0$。处理链如下：\n\n1) 第一次乘法和截断：信号乘以一个实系数 $c_{1}$ 形成 $w[n]=c_{1}x[n]$，然后通过一个步长为 $\\Delta_{1}$ 的均匀中步长截断量化器 $Q_{\\Delta_{1}}$，其定义为\n$$\nQ_{\\Delta}(u) \\triangleq \\Delta \\left\\lfloor \\frac{u}{\\Delta} \\right\\rfloor,\n$$\n因此截断后的信号为 $w_{t}[n]=Q_{\\Delta_{1}}(w[n])$，截断误差为 $e_{1}[n]=w_{t}[n]-w[n]$。\n\n2) 第二次乘法和截断：然后信号乘以一个实系数 $c_{2}$ 形成 $v[n]=c_{2}w_{t}[n]$，再通过一个步长为 $\\Delta_{2}$ 的第二均匀截断量化器 $Q_{\\Delta_{2}}$，得到 $v_{t}[n]=Q_{\\Delta_{2}}(v[n])$ 和截断误差 $e_{2}[n]=v_{t}[n]-v[n]$。\n\n3) 线性时不变滤波：最后，$v_{t}[n]$ 由一个长度为 3 的有限冲激响应滤波器（一个线性时不变（LTI）系统）处理，其冲激响应系数为 $h[0],h[1],h[2]$，得到输出\n$$\ny[n] \\triangleq \\sum_{k=0}^{2} h[k]\\, v_{t}[n-k].\n$$\n\n假设没有发生饱和。进一步假设，由于高分辨率建模或使用独立减性抖动，对于所有的 $n$ 和 $i\\in\\{1,2\\}$，每个截断误差 $e_{i}[n]$ 都与其输入统计独立，并在区间 $[-\\Delta_{i},0)$ 上均匀分布。\n\n给定数值 $c_{1}=0.9$, $c_{2}=1.1$, $\\Delta_{1}=2^{-12}$, $\\Delta_{2}=2^{-10}$，以及 $h[0]=0.8$, $h[1]=0.7$, $h[2]=0.5$，确定精确的稳态输出均值 $\\mathbb{E}\\{y[n]\\}$。\n\n请以最简形式的单个精确有理数提供您的最终答案。不要四舍五入。不要包含单位。", "solution": "目标是确定输出信号的精确稳态均值 $\\mathbb{E}\\{y[n]\\}$。输出 $y[n]$ 是对信号 $v_t[n]$ 应用有限冲激响应（FIR）滤波器的结果。该关系由卷积和给出：\n$$\ny[n] = \\sum_{k=0}^{2} h[k]\\, v_{t}[n-k].\n$$\n由于期望算子的线性特性，我们可以将输出的均值写为：\n$$\n\\mathbb{E}\\{y[n]\\} = \\mathbb{E}\\left\\{\\sum_{k=0}^{2} h[k]\\, v_{t}[n-k]\\right\\} = \\sum_{k=0}^{2} h[k]\\, \\mathbb{E}\\{v_{t}[n-k]\\}.\n$$\n得到 $v_t[n]$ 的信号链涉及对广义平稳输入 $x[n]$ 的操作，并且量化误差模型被假设为平稳过程。这意味着 $v_t[n]$ 的均值不随时间变化，即对于所有整数 $n$ 和 $k$，有 $\\mathbb{E}\\{v_t[n-k]\\} = \\mathbb{E}\\{v_t[n]\\} = \\mu_{v_t}$。因此，输出均值的表达式简化为：\n$$\n\\mathbb{E}\\{y[n]\\} = \\mu_{v_t} \\sum_{k=0}^{2} h[k].\n$$\n我们的任务简化为求均值 $\\mu_{v_t}$ 和滤波器系数的和。\n\n我们追踪信号路径来确定 $\\mu_{v_t}$。信号 $v_t[n]$ 是第二个量化器的输出，它通过加性误差模型与其输入 $v[n]$ 相关：\n$$\nv_t[n] = v[n] + e_2[n].\n$$\n取期望可得：\n$$\n\\mu_{v_t} = \\mathbb{E}\\{v_t[n]\\} = \\mathbb{E}\\{v[n]\\} + \\mathbb{E}\\{e_2[n]\\}.\n$$\n问题陈述截断误差 $e_2[n]$ 在区间 $[-\\Delta_2, 0)$ 上均匀分布。在区间 $[a, b]$ 上的均匀随机变量的均值是 $\\frac{a+b}{2}$。因此，第二个误差的均值是：\n$$\n\\mathbb{E}\\{e_2[n]\\} = \\frac{-\\Delta_2 + 0}{2} = -\\frac{\\Delta_2}{2}.\n$$\n接下来，我们求 $v[n]$ 的均值。该信号是通过将 $w_t[n]$ 乘以系数 $c_2$ 生成的：\n$$\nv[n] = c_2 w_t[n].\n$$\n其均值为：\n$$\n\\mathbb{E}\\{v[n]\\} = \\mathbb{E}\\{c_2 w_t[n]\\} = c_2 \\mathbb{E}\\{w_t[n]\\}.\n$$\n类似地，$w_t[n]$ 是第一个量化器的输出：\n$$\nw_t[n] = w[n] + e_1[n],\n$$\n其中 $w[n] = c_1 x[n]$。$w_t[n]$ 的均值是：\n$$\n\\mathbb{E}\\{w_t[n]\\} = \\mathbb{E}\\{w[n]\\} + \\mathbb{E}\\{e_1[n]\\} = \\mathbb{E}\\{c_1 x[n]\\} + \\mathbb{E}\\{e_1[n]\\}.\n$$\n输入信号 $x[n]$ 是一个零均值过程，所以 $\\mathbb{E}\\{x[n]\\} = 0$。这意味着 $\\mathbb{E}\\{c_1 x[n]\\} = c_1 \\mathbb{E}\\{x[n]\\} = c_1 \\cdot 0 = 0$。\n第一个截断误差 $e_1[n]$ 在 $[-\\Delta_1, 0)$ 上均匀分布。其均值是：\n$$\n\\mathbb{E}\\{e_1[n]\\} = \\frac{-\\Delta_1 + 0}{2} = -\\frac{\\Delta_1}{2}.\n$$\n因此，$w_t[n]$ 的均值是：\n$$\n\\mathbb{E}\\{w_t[n]\\} = 0 + \\left(-\\frac{\\Delta_1}{2}\\right) = -\\frac{\\Delta_1}{2}.\n$$\n将其代回，我们得到 $v[n]$ 的均值：\n$$\n\\mathbb{E}\\{v[n]\\} = c_2 \\left(-\\frac{\\Delta_1}{2}\\right) = -\\frac{c_2\\Delta_1}{2}.\n$$\n现在我们可以计算 $v_t[n]$ 的均值：\n$$\n\\mu_{v_t} = \\mathbb{E}\\{v[n]\\} + \\mathbb{E}\\{e_2[n]\\} = -\\frac{c_2\\Delta_1}{2} - \\frac{\\Delta_2}{2} = -\\frac{1}{2}(c_2\\Delta_1 + \\Delta_2).\n$$\n最后，我们通过将 $\\mu_{v_t}$ 与滤波器冲激响应系数之和相乘来计算输出均值 $\\mathbb{E}\\{y[n]\\}$，该和代表了滤波器的直流增益：\n$$\n\\sum_{k=0}^{2} h[k] = h[0] + h[1] + h[2].\n$$\n$$\n\\mathbb{E}\\{y[n]\\} = \\left( -\\frac{1}{2}(c_2\\Delta_1 + \\Delta_2) \\right) \\left( h[0] + h[1] + h[2] \\right).\n$$\n我们代入给定的数值：$c_1=0.9$, $c_2=1.1$, $\\Delta_{1}=2^{-12}$, $\\Delta_{2}=2^{-10}$，以及 $h[0]=0.8$, $h[1]=0.7$, $h[2]=0.5$。将这些写成有理数形式为 $c_2 = \\frac{11}{10}$, $\\Delta_1 = \\frac{1}{4096}$, $\\Delta_2 = \\frac{1}{1024}$, $h[0]=\\frac{8}{10}$, $h[1]=\\frac{7}{10}$, $h[2]=\\frac{5}{10}$。\n\n首先，计算滤波器系数的和：\n$$\n\\sum_{k=0}^{2} h[k] = 0.8 + 0.7 + 0.5 = 2.0.\n$$\n现在，将此代入均值的表达式中：\n$$\n\\mathbb{E}\\{y[n]\\} = \\left( -\\frac{1}{2}(c_2\\Delta_1 + \\Delta_2) \\right) \\cdot 2 = -(c_2\\Delta_1 + \\Delta_2).\n$$\n我们使用有理数运算来计算括号中的项以保持精度：\n$$\nc_2\\Delta_1 + \\Delta_2 = \\frac{11}{10} \\cdot \\frac{1}{4096} + \\frac{1}{1024} = \\frac{11}{40960} + \\frac{1}{1024}.\n$$\n为了将这些分数相加，我们找到一个公分母，即 $40960$：\n$$\n\\frac{1}{1024} = \\frac{40}{40 \\cdot 1024} = \\frac{40}{40960}.\n$$\n所以，和是：\n$$\nc_2\\Delta_1 + \\Delta_2 = \\frac{11}{40960} + \\frac{40}{40960} = \\frac{51}{40960}.\n$$\n因此，精确的稳态输出均值是：\n$$\n\\mathbb{E}\\{y[n]\\} = -\\frac{51}{40960}.\n$$\n这个分数是最简形式，因为分子的素因子是 $51 = 3 \\times 17$，分母的素因子是 $40960 = 4096 \\times 10 = 2^{12} \\times 2 \\times 5 = 2^{13} \\times 5$。没有共同的素因子。", "answer": "$$\n\\boxed{-\\frac{51}{40960}}\n$$", "id": "2898430"}, {"introduction": "工程设计的核心在于权衡与优化。在ADC前端设计中，一个经典的挑战是如何设置输入增益：提高增益可以放大信号，使其远离量化噪声的本底，从而改善“颗粒”信噪比（granular $\\mathrm{SQNR}$）；但过高的增益会增加信号超出量化器范围的风险，导致严重的削波失真。这个练习将此权衡形式化为一个约束优化问题，要求您在限制削波概率的前提下，为高斯输入信号找到能最大化$\\mathrm{SQNR}$的最优增益 [@problem_id:2898405]。", "problem": "一个均值为零、方差为 $\\sigma_{x}^{2}$ 的宽平稳高斯随机过程 $x[n]$，通过一个实标量预增益 $g>0$ 产生 $u[n]=g\\,x[n]$。序列 $u[n]$ 被输入到一个具有 $B$ 比特、满量程范围为 $[-A, A]$ 的均匀、对称、中置饱和量化器。该量化器有 $2^{B}$ 个判决区间，覆盖 $[-A, A]$，因此步长为 $\\Delta = \\dfrac{2A}{2^{B}}$。量化器在 $[-A, A]$ 范围外会饱和。量化后，输出通过因子 $1/g$进行反缩放，以产生估计值 $\\hat{x}[n]=\\dfrac{1}{g}\\,Q(g\\,x[n])$。\n\n在非过载区域内采用高分辨率颗粒噪声模型：对于未饱和的样本，量化器输入端的颗粒量化误差被建模为独立、零均值，并在 $[-\\Delta/2,\\Delta/2]$ 上均匀分布，其方差为 $\\Delta^{2}/12$。系统设计者将量化信噪比（SQNR）定义为信号方差 $\\sigma_{x}^{2}$ 与仅输出颗粒噪声方差之比（即，过载失真不计入SQNR），同时施加一个硬约束，即削波概率（过载概率）不得超过目标值 $\\varepsilon \\in (0,1)$：\n$$\n\\mathbb{P}\\!\\left(|g\\,x[n]|>A\\right)\\le \\varepsilon.\n$$\n\n仅使用第一性原理和给定的建模假设（不要使用任何预先推导的“捷径”公式来获得答案），执行以下操作：\n\n- 建立约束优化问题，其决策变量为 $g$，目标是最大化反缩放输出端的SQNR。\n- 从基本单调性和建模假设出发，论证最优解相对于削波概率约束必须位于何处。\n- 针对高斯输入 $x[n]\\sim\\mathcal{N}(0,\\sigma_{x}^{2})$ 进行特化，并以闭合形式求解最优预增益 $g^{\\star}$，用 $A$, $\\sigma_{x}$ 和 $\\varepsilon$ 表示。您可以使用由下式定义的高斯尾概率函数（$Q$函数）\n$$\nQ(z)=\\frac{1}{\\sqrt{2\\pi}}\\int_{z}^{\\infty}\\exp\\!\\left(-\\frac{t^{2}}{2}\\right)\\,\\mathrm{d}t,\n$$\n及其反函数 $Q^{-1}(\\cdot)$。\n\n将您的最终结果表示为 $g^{\\star}$ 的单个符号表达式。无需进行数值计算，最终答案也无需单位。", "solution": "所述问题构成了信号处理领域中约束优化的一个有效练习。我们将对其进行形式化分析。\n\n目标是最大化量化信噪比（SQNR）。信号功率给定为 $\\sigma_{x}^{2}$。需要考虑的噪声仅为输出颗粒噪声。量化器输入端的量化误差，我们记为 $e_{u}[n]$，由 $e_{u}[n] = Q(u[n]) - u[n]$ 给出，其中 $u[n] = g\\,x[n]$。在非饱和（颗粒）区域，即对于 $|u[n]| \\le A$，此误差被建模为一个独立、零均值的随机过程，在 $[-\\frac{\\Delta}{2}, \\frac{\\Delta}{2}]$ 上均匀分布。因此，该颗粒误差的方差为 $\\sigma_{e_{u}}^{2} = \\frac{(\\Delta/2 - (-\\Delta/2))^{2}}{12} = \\frac{\\Delta^{2}}{12}$。\n\n最终输出为 $\\hat{x}[n] = \\frac{1}{g}Q(g\\,x[n])$。输出端的误差为 $\\hat{e}[n] = \\hat{x}[n] - x[n] = \\frac{1}{g}Q(g\\,x[n]) - x[n] = \\frac{1}{g} \\left( Q(g\\,x[n]) - g\\,x[n] \\right) = \\frac{1}{g}e_{u}[n]$。因此，输出颗粒噪声的方差 $\\sigma_{n_{q}}^{2}$ 与输入颗粒误差的方差通过因子 $\\frac{1}{g^2}$ 相关联：\n$$\n\\sigma_{n_{q}}^{2} = \\text{Var}\\left( \\frac{1}{g} e_{u}[n] \\right) = \\frac{1}{g^{2}} \\sigma_{e_{u}}^{2} = \\frac{\\Delta^{2}}{12g^{2}}.\n$$\n量化器步长给定为 $\\Delta = \\frac{2A}{2^{B}}$。将此代入噪声方差的表达式中，得到：\n$$\n\\sigma_{n_{q}}^{2} = \\frac{1}{12g^{2}} \\left( \\frac{2A}{2^{B}} \\right)^{2} = \\frac{4A^{2}}{12g^{2}(2^{B})^{2}} = \\frac{A^{2}}{3g^{2}2^{2B}}.\n$$\nSQNR被定义为信号方差与此输出颗粒噪声方差之比。\n$$\n\\text{SQNR}(g) = \\frac{\\sigma_{x}^{2}}{\\sigma_{n_{q}}^{2}} = \\frac{\\sigma_{x}^{2}}{A^{2}/(3g^{2}2^{2B})} = \\frac{3 \\cdot 2^{2B}\\sigma_{x}^{2}}{A^{2}} g^{2}.\n$$\n现在，我们建立约束优化问题。决策变量是预增益 $g$。目标是在削波概率的约束下最大化 $\\text{SQNR}(g)$。\n$$\n\\underset{g>0}{\\text{maximize}} \\quad \\text{SQNR}(g) = \\left( \\frac{3 \\cdot 2^{2B}\\sigma_{x}^{2}}{A^{2}} \\right) g^{2}\n$$\n$$\n\\text{subject to} \\quad \\mathbb{P}\\left(|g\\,x[n]|>A\\right)\\le \\varepsilon.\n$$\n项 $\\frac{3 \\cdot 2^{2B}\\sigma_{x}^{2}}{A^{2}}$ 是一个正常数。因此，最大化 $\\text{SQNR}(g)$ 等价于最大化 $g^{2}$，或者由于 $g > 0$ 而等价于最大化 $g$。目标函数是关于 $g$ 严格单调递增的。\n\n让我们考察约束函数 $C(g) = \\mathbb{P}(|g\\,x[n]|>A) = \\mathbb{P}(|x[n]|>A/g)$。随着增益 $g$ 增加，阈值 $A/g$ 减小。对于一个零均值的连续随机变量 $x[n]$，其幅值超过一个正常数阈值的概率 $\\mathbb{P}(|x[n]|>c)$ 是该阈值 $c$ 的单调递减函数。因此，随着 $g$ 增加，$A/g$ 减小，这反过来又导致 $C(g)$ 增加。所以，约束函数 $C(g)$ 是关于 $g$ 的单调递增函数。\n\n我们的任务是在一个由单调递增函数定义的上界约束下，最大化一个单调递增的目标函数。因此，最优解必须位于可行域的边界上，在该边界上不等式约束以等式形式成立。任何小于此边界值的 $g$ 都会产生较小的SQNR，而任何更大的值都会违反约束。因此，最优增益 $g^{\\star}$ 必须满足：\n$$\n\\mathbb{P}\\left(|g^{\\star}\\,x[n]|>A\\right) = \\varepsilon.\n$$\n输入信号被指定为零均值高斯过程，$x[n]\\sim\\mathcal{N}(0,\\sigma_{x}^{2})$。为了分析该概率，我们通过定义 $Z = x[n]/\\sigma_{x}$ 来标准化随机变量 $x[n]$，其中 $Z \\sim \\mathcal{N}(0,1)$ 是一个标准正态变量。约束方程变为：\n$$\n\\mathbb{P}\\left(\\left|\\frac{x[n]}{\\sigma_{x}}\\right| > \\frac{A}{g^{\\star}\\sigma_{x}}\\right) = \\varepsilon \\implies \\mathbb{P}\\left(|Z| > \\frac{A}{g^{\\star}\\sigma_{x}}\\right) = \\varepsilon.\n$$\n对于关于零对称的标准正态分布，其两侧尾部的概率由 $\\mathbb{P}(|Z|>z) = \\mathbb{P}(Z>z) + \\mathbb{P}(Z < -z) = 2\\mathbb{P}(Z>z)$ 给出（对于任何 $z>0$）。使用所提供的高斯尾概率函数 $Q(z) = \\mathbb{P}(Z>z)$，该方程变为：\n$$\n2Q\\left(\\frac{A}{g^{\\star}\\sigma_{x}}\\right) = \\varepsilon.\n$$\n解出 $Q$ 函数项，我们得到：\n$$\nQ\\left(\\frac{A}{g^{\\star}\\sigma_{x}}\\right) = \\frac{\\varepsilon}{2}.\n$$\n为了求出 $Q$ 函数的自变量，我们应用其反函数 $Q^{-1}(\\cdot)$:\n$$\n\\frac{A}{g^{\\star}\\sigma_{x}} = Q^{-1}\\left(\\frac{\\varepsilon}{2}\\right).\n$$\n最后，我们求解最优预增益 $g^{\\star}$：\n$$\ng^{\\star} = \\frac{A}{\\sigma_{x}Q^{-1}\\left(\\frac{\\varepsilon}{2}\\right)}.\n$$\n这个表达式用给定的参数 $A$、$\\sigma_{x}$ 和 $\\varepsilon$ 给出了最优增益，从而完成了推导。", "answer": "$$\\boxed{\\frac{A}{\\sigma_{x} Q^{-1}\\left(\\frac{\\varepsilon}{2}\\right)}}$$", "id": "2898405"}]}