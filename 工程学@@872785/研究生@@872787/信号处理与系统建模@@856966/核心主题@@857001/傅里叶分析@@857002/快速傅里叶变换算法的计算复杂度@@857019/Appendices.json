{"hands_on_practices": [{"introduction": "快速傅里叶变换 (FFT) 最显著的优势在于其计算效率。与离散傅里叶变换 (DFT) 的 $O(N^2)$ 复杂度相比，FFT 通过分治策略将复杂度降低到 $O(N \\log N)$。这个练习旨在通过一个具体的例子，让您亲手剖析一个 $N=8$ 的基-2 时间抽取 (DIT) FFT 的计算过程，并与朴素 DFT 的运算量进行直接比较，从而直观地理解其运算节省的来源 [@problem_id:2859618]。", "problem": "考虑长度为 $N$ 的离散傅里叶变换 (DFT)，其对于序列 $x[n]$（$0 \\leq n \\leq N-1$）的定义如下：\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n]\\, W_{N}^{kn}, \\quad 0 \\leq k \\leq N-1,\n$$\n其中 $W_{N} \\triangleq \\exp\\!\\left(-\\mathrm{j}\\,\\frac{2\\pi}{N}\\right)$ 是 $N$ 次单位主根，且 $\\mathrm{j}^2=-1$。假设采用标准算术成本模型，其中每次复数加法计为一次复数加法，每次复数与复常数（包括任何整数 $m$ 的旋转因子 $W_{N}^{m}$）的乘法计为一次复数乘法；不利用任何简化，例如 $W_{N}^{0}=1$、$W_{N}^{N/2}=-1$ 或 $\\pm \\mathrm{j}$ 等特殊值。\n\n对于 $N=8$，使用基-2 时间抽取快速傅里叶变换 (FFT)，其具有原位蝶形运算，该运算组合由步长分隔的索引，且步长在每个后续阶段减半，完成以下任务：\n\n- 对于三个阶段中的每一个阶段，明确列出所有被组合的时间索引的蝶形运算对 $(p,q)$ 以及相应的旋转因子指数 $e$，使得蝶形运算在适当的分支上使用 $W_{8}^{e}$。\n- 根据第一性原理和上述定义，推导当 $N=8$ 时，此基-2 时间抽取 FFT 所执行的复数加法和复数乘法的总数。\n- 使用上面给出的 DFT 定义和相同的算术成本模型，推导当 $N=8$ 时，DFT 的朴素直接计算所需的复数加法和复数乘法的总数。\n- 通过将所有四个计数一起报告来比较这两个总数。\n\n将最终答案以 LaTeX $\\texttt{pmatrix}$ 环境中的单行矩阵形式报告，顺序为 $\\big(A_{\\text{FFT}}, M_{\\text{FFT}}, A_{\\text{DFT}}, M_{\\text{DFT}}\\big)$，其中 $A$ 表示复数加法总数，$M$ 表示复数乘法总数。无需四舍五入，且答案无单位。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和自洽的。它提出了一个数字信号处理领域的标准问题，涉及离散傅里叶变换 (DFT) 和快速傅里叶变换 (FFT) 的计算复杂度。所有定义、常数和约束都已提供，从而可以得到一个唯一且可验证的解。我们继续进行分析。\n\n问题要求推导两种计算长度为 $N=8$ 的序列的 DFT 的方法的计算成本，并详细分解基-2 时间抽取 (DIT) FFT 算法。\n\n成本模型明确定义如下：\n1.  一次复数加法或减法计为 1 次复数加法。\n2.  一个复数与任何旋转因子 $W_N^m$ 的乘法计为 1 次复数乘法，不论 $m$ 的值如何。禁止对 $m=0$ 或其他特殊情况进行简化。\n\n令 $A$ 表示复数加法总数，$M$ 表示复数乘法总数。\n\n**第一部分：直接 DFT 计算成本**\n\nDFT 的定义如下：\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] W_{N}^{kn}\n$$\n对于一个固定的输出索引 $k$，$X[k]$ 的计算涉及 $N$ 项之和。\n每一项 $x[n]W_N^{kn}$ 需要一次复数乘法。在严格的成本模型下，即使 $kn=0$ 或 $N$ 的其他整数倍时也是如此。因此，对于每个 $k$ 值，都有 $N$ 次复数乘法。\n这 $N$ 个复数项的求和需要 $N-1$ 次复数加法。\n\n由于 $k$ 的取值范围是 $0$ 到 $N-1$，因此需要计算 $N$ 个这样的输出值。所以，直接 DFT 计算的总成本为：\n- 复数乘法总数：$M_{\\text{DFT}} = N \\times N = N^2$。\n- 复数加法总数：$A_{\\text{DFT}} = N \\times (N-1)$。\n\n对于 $N=8$：\n$$\nM_{\\text{DFT}} = 8^2 = 64\n$$\n$$\nA_{\\text{DFT}} = 8 \\times (8-1) = 8 \\times 7 = 56\n$$\n\n**第二部分：基-2 DIT FFT 分析**\n\n基-2 FFT 算法将一个大小为 $N$ 的 DFT 递归地分解为两个大小为 $N/2$ 的 DFT。对于 $N=2^v$，这将产生 $v = \\log_2(N)$ 个计算阶段。对于 $N=8$，我们有 $\\log_2(8) = 3$ 个阶段。\n\n每个阶段的核心计算是“蝶形”运算，它将两个中间值（比如 $A$ 和 $B$）组合起来，生成两个新值 $A'$ 和 $B'$：\n$$\nA' = A + W_N^e B\n$$\n$$\nB' = A - W_N^e B\n$$\n其中 $W_N^e$ 是相应的旋转因子。这个计算可以通过先计算乘积 $P = W_N^e B$ 来实现，这需要 1 次复数乘法。然后，计算 $A' = A + P$ 和 $B' = A - P$，这需要 2 次复数加法。因此，在指定的成本模型下，每次蝶形运算恰好需要 1 次复数乘法和 2 次复数加法。\n\n在一个大小为 $N$ 的基-2 FFT 中，$\\log_2(N)$ 个阶段中的每一个都包含 $N/2$ 次这样的蝶形运算。\n\n**$N=8$ DIT-FFT 的蝶形运算细节**\n\nDIT-FFT 算法要求输入序列 $x[n]$ 通过对索引进行比特反转来重排。然后计算通过 3 个阶段原位进行。在蝶形运算中组合的一对索引 $(p,q)$ 由阶段和步长决定。\n\n**阶段 1：** 计算四个 2 点 DFT。步长为 1。旋转因子为 $W_2^0 = W_8^0$。\n- 蝶形运算对 $(p,q)$：$(0,1), (2,3), (4,5), (6,7)$。\n- 旋转因子指数 $e$：对于所有四对，指数均为 $e=0$。\n\n**阶段 2：** 计算两个 4 点 DFT。步长为 2。\n- 第一个 4 点 DFT 组合了来自蝶形运算 $(0,1)$ 和 $(2,3)$ 的输出。运算对是 $(0,2)$ 和 $(1,3)$。\n  - 对 $(0,2)$：使用旋转因子 $W_4^0 = W_8^0$。指数 $e=0$。\n  - 对 $(1,3)$：使用旋转因子 $W_4^1 = W_8^2$。指数 $e=2$。\n- 第二个 4 点 DFT 组合了来自蝶形运算 $(4,5)$ 和 $(6,7)$ 的输出。运算对是 $(4,6)$ 和 $(5,7)$。\n  - 对 $(4,6)$：使用旋转因子 $W_4^0 = W_8^0$。指数 $e=0$。\n  - 对 $(5,7)$：使用旋转因子 $W_4^1 = W_8^2$。指数 $e=2$。\n- 阶段 2 总结：运算对为 $(0,2), (1,3), (4,6), (5,7)$。对应的指数为 $e \\in \\{0, 2, 0, 2\\}$。\n\n**阶段 3：** 计算一个 8 点 DFT。步长为 4。此阶段组合两个 4 点 DFT 的结果。运算对是 $(0,4), (1,5), (2,6), (3,7)$。\n- 对 $(0,4)$：使用旋转因子 $W_8^0$。指数 $e=0$。\n- 对 $(1,5)$：使用旋转因子 $W_8^1$。指数 $e=1$。\n- 对 $(2,6)$：使用旋转因子 $W_8^2$。指数 $e=2$。\n- 对 $(3,7)$：使用旋转因子 $W_8^3$。指数 $e=3$。\n- 阶段 3 总结：运算对为 $(0,4), (1,5), (2,6), (3,7)$。对应的指数为 $e \\in \\{0, 1, 2, 3\\}$。\n\n**FFT 计算成本**\n\n对于 $N=8$，有 $\\log_2(8) = 3$ 个阶段。每个阶段有 $N/2 = 8/2 = 4$ 个蝶形运算。\n- 蝶形运算总数 = $(\\text{阶段数}) \\times (\\text{每阶段蝶形运算数}) = 3 \\times 4 = 12$。\n\n每个蝶形运算需要 1 次复数乘法和 2 次复数加法。\n- FFT 的复数乘法总数：$M_{\\text{FFT}} = 12 \\times 1 = 12$。\n这与通用公式 $M_{\\text{FFT}} = \\frac{N}{2} \\log_2(N) = \\frac{8}{2} \\log_2(8) = 4 \\times 3 = 12$ 一致。\n\n- FFT 的复数加法总数：$A_{\\text{FFT}} = 12 \\times 2 = 24$。\n这与通用公式 $A_{\\text{FFT}} = N \\log_2(N) = 8 \\log_2(8) = 8 \\times 3 = 24$ 一致。\n\n**第三部分：总数比较**\n\n所要求的四个计数是：\n- FFT 加法：$A_{\\text{FFT}} = 24$\n- FFT 乘法：$M_{\\text{FFT}} = 12$\n- 直接 DFT 加法：$A_{\\text{DFT}} = 56$\n- 直接 DFT 乘法：$M_{\\text{DFT}} = 64$\n\n最终答案以行矩阵 $(A_{\\text{FFT}}, M_{\\text{FFT}}, A_{\\text{DFT}}, M_{\\text{DFT}})$ 的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n24  12  56  64\n\\end{pmatrix}\n}\n$$", "id": "2859618"}, {"introduction": "在掌握了 FFT 的基本结构后，我们可以进一步利用其内部数据流来针对特定类型的输入信号进行优化。本练习提出了一个常见且实际的场景：当输入信号末尾包含大量零时，许多蝶形运算会变得冗余。您的任务是设计一个“剪枝”后的 FFT 算法，并精确计算与完整 FFT 相比所节省的运算量，这能加深您对算法内部依赖关系的理解 [@problem_id:2859641]。", "problem": "考虑一个长度为 $N$ 的离散傅里叶变换 (DFT)，其中 $N = 2^{m}$，$m \\in \\mathbb{N}$。设输入序列为 $x[0], x[1], \\ldots, x[N-1]$，并假设存在一个整数 $p$（$0 \\leq p \\leq m$），使得对于所有 $n \\geq 2^{p}$ 都有 $x[n] = 0$；也就是说，最后的 $N - 2^{p}$ 个样本恒为零。你需要计算 DFT 的所有 $N$ 个频域输出 $X[k]$，其定义为\n$$\nX[k] \\triangleq \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-2\\pi \\mathrm{i}\\,\\frac{n k}{N}\\right), \\quad k=0,1,\\ldots,N-1.\n$$\n假设使用基2时间抽取 (DIT) 快速傅里叶变换 (FFT)，这是标准的 Cooley–Tukey 二进制分解算法。在此算法中，计算过程被组织为 $m$ 个顺序的蝶形运算级。每个蝶形运算结合两个复数输入，并通过一次与级相关的旋转因子的复数乘法和两次复数加法，产生两个复数输出。在完整的、未经剪枝的实现中，每一级的每一个蝶形运算都会被执行，并且每一次这样的乘法和加法都会被计数。在本问题中，算术运算次数定义为复数乘法总数与复数加法总数之和。内存移动和索引置换不计入运算次数。\n\n设计一个截断的 FFT 算法，利用 $n \\geq 2^{p}$ 时 $x[n]=0$ 这一事实，以避免执行任何因其一个或两个输入已知为零而在数学上冗余的蝶形运算。仅使用 DFT 定义和基2时间抽取分解的结构特性，推导出一个关于 $m$ 和 $p$ 的精确闭式表达式，表示这种截断 FFT 相对于在长度为 $N$ 的序列上运行的完整、未经剪枝的基2 FFT 所节省的算术运算次数。\n\n你的最终答案必须是仅依赖于 $m$ 和 $p$ 的单个闭式解析表达式。不包含单位。不需要进行数值取整。", "solution": "我们从 DFT 的定义开始\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\!\\left(-2\\pi \\mathrm{i}\\,\\frac{n k}{N}\\right),\n$$\n其中 $N=2^{m}$ 且当 $n \\geq 2^{p}$ 时 $x[n]=0$。一个基2时间抽取 (DIT) 快速傅里叶变换 (FFT) 通过将输入递归地划分为偶数和奇数索引的子序列，并在 $m$ 个蝶形运算级中将它们组合起来，来计算这个和。每一级都包含通过蝶形运算对中间值进行的成对组合，其中每个蝶形运算执行一次复数乘法（乘以形式为 $\\exp(-2\\pi \\mathrm{i}\\,\\ell/N)$ 的旋转因子）和两次复数加法。在完整的基2 FFT 中，每级有 $N/2$ 个蝶形运算，共 $m$ 级。因此，如果我们将每次复数乘法和每次复数加法都算作一次运算，那么每个蝶形运算恰好贡献 $3$ 次运算。因此，完整 FFT 的总算术运算次数为\n$$\nC_{\\text{full}} = 3 \\cdot \\frac{N}{2} \\cdot m = 3 \\cdot 2^{m-1} \\cdot m.\n$$\n\n为了量化尾部零值所带来的节省，我们来描述蝶形运算在何种情况下实际需要进行算术运算。在基2 DIT 流程图中，一个蝶形运算在给定级的两个输入是由原始输入样本的不相交子集形成的。如果一个蝶形运算的两个输入都为零，则其输出也为零，该蝶形运算不执行任何有用的算术运算。如果恰好有一个输入为零，那么非零输入将传递到两个输出（可能伴有已知的平凡符号变化或路由），同样不需要复数乘法或加法来确定输出；可以绕过算术运算，直接路由该值。因此，在利用零值的截断实现中，一个蝶形运算仅当其两个输入都非零时才产生算术运算。\n\n现在我们逐级计算，在假设仅当 $n \\in \\{0,1,\\ldots,2^{p}-1\\}$ 时 $x[n]\\neq 0$ 的情况下，有多少个蝶形运算的两个输入都非零。在基2 DIT FFT 中，第 $s$ 级（$s \\in \\{1,2,\\ldots,m\\}$）将索引分组为大小为 $2^{s}$ 的连续块，在每个块内，每个蝶形运算将块前半部分的一个元素与块后半部分的相应元素连接起来。因此，在第 $s$ 级，一个蝶形运算的两个输入都非零，当且仅当其对应的两个位置都位于非零前缀 $\\{0,1,\\ldots,2^{p}-1\\}$ 内。\n\n令 $L \\triangleq 2^{p}$。在第 $s$ 级，完全包含在 $\\{0,\\ldots,L-1\\}$ 内的大小为 $2^{s}$ 的完整块的数量是 $\\left\\lfloor L / 2^{s} \\right\\rfloor$。每个完整块贡献 $2^{s-1}$ 个两个输入都非零的蝶形运算。此外，还有一个大小为 $r \\triangleq L \\bmod 2^{s}$ 的部分块，它贡献了 $\\max\\{r - 2^{s-1}, 0\\}$ 个两个输入都非零的蝶形运算（因为在部分块内，一个蝶形运算连接位置 $j$ 和 $j+2^{s-1}$，而这两个位置都小于 $r$ 的条件恰好是 $j  r - 2^{s-1}$）。因此，在第 $s$ 级，两个输入都非零的蝶形运算数量为\n$$\nB_{s} \\;=\\; \\left\\lfloor \\frac{L}{2^{s}} \\right\\rfloor \\cdot 2^{s-1} \\;+\\; \\max\\!\\left\\{ \\left(L \\bmod 2^{s}\\right) - 2^{s-1},\\, 0 \\right\\}.\n$$\n\n将 $L=2^{p}$ 代入可得到简化。对于 $s \\leq p$，我们有 $L/2^{s} = 2^{p-s}$（一个整数）且 $L \\bmod 2^{s} = 0$，所以\n$$\nB_{s} \\;=\\; 2^{p-s} \\cdot 2^{s-1} + 0 \\;=\\; 2^{p-1}.\n$$\n对于 $s \\geq p+1$，我们有 $\\left\\lfloor L/2^{s} \\right\\rfloor = 0$ 且 $L \\bmod 2^{s} = L = 2^{p}$，所以\n$$\nB_{s} \\;=\\; 0 \\cdot 2^{s-1} + \\max\\{2^{p} - 2^{s-1}, 0\\} \\;=\\; 0,\n$$\n因为对于 $s \\geq p+1$，$2^{s-1} \\geq 2^{p}$。因此，\n$$\n\\sum_{s=1}^{m} B_{s} \\;=\\; \\sum_{s=1}^{p} 2^{p-1} \\;=\\; p \\cdot 2^{p-1}.\n$$\n\n在截断的 FFT 中，除了那些两个输入都非零的蝶形运算外，所有其他蝶形运算都被剪枝，因此执行的蝶形运算总数为 $\\sum_{s=1}^{m} B_{s} = p \\cdot 2^{p-1}$。每个被执行的蝶形运算仍然需要一次复数乘法和两次复数加法，即 $3$ 次运算。因此，截断后的算术运算次数为\n$$\nC_{\\text{trunc}} \\;=\\; 3 \\sum_{s=1}^{m} B_{s} \\;=\\; 3 \\, p \\, 2^{p-1}.\n$$\n\n相对于完整 FFT 所节省的精确运算次数是两者之差\n$$\nC_{\\text{save}} \\;=\\; C_{\\text{full}} - C_{\\text{trunc}} \\;=\\; 3 \\cdot 2^{m-1} \\cdot m \\;-\\; 3 \\cdot p \\cdot 2^{p-1}.\n$$\n\n这个表达式仅依赖于 $m$ 和 $p$，并给出了当输入有尾部零，使得只有前 $2^{p}$ 个样本非零时，所能精确节省的算术运算次数。", "answer": "$$\\boxed{3\\left(2^{m-1} m - 2^{p-1} p\\right)}$$", "id": "2859641"}, {"introduction": "理论上的运算次数与真实硬件上的执行时间之间存在差距，后者还受到内存访问模式、缓存大小和指令集等多种因素的影响。这个综合性练习将您置于一个实际的算法规划场景中，要求您根据给定的测量数据拟合一个性能模型，并用它来预测新变换长度下的最优执行方案。这项实践是连接理论分析与高性能计算中实际问题的关键一步 [@problem_id:2859656]。", "problem": "一个实验室团队正在一个固定架构上，探索混合基Cooley–Tukey快速傅里叶变换（FFT）算法的规划空间。这些算法用于一维离散傅里叶变换（DFT），其变换长度可分解为基数$2$、$3$和$5$的乘积。该算法是时域抽取（decimation-in-time）的，并以非原地（out-of-place）方式实现。该团队假设以下有科学依据的事实作为建模基础：(i) 每个FFT级执行的蝶形运算次数与变换长度$N$成正比，(ii) 级的数量等于$N$的素数分解中各指数的和，以及 (iii) 在时域抽取过程中，第$t$级之前的步幅（以元素为单位）等于前$t-1$个所选基数的乘积，这会影响内存局部性。\n\n采用以下简单的、级可加的成本模型，该模型捕捉了计算成本和由步幅驱动的内存惩罚。对于一个应用于长度为$N$（其素数分解为$N=2^{s_{2}} 3^{s_{3}} 5^{s_{5}}$）的计划（即基数级的排序），总执行时间为\n$$\nT(N,\\text{plan}) \\;=\\; c \\;+\\; N\\big(a_{2}\\,s_{2} \\;+\\; a_{3}\\,s_{3} \\;+\\; a_{5}\\,s_{5}\\big) \\;+\\; N\\,b\\,m(N,\\text{plan};S_{0}),\n$$\n其中，$c$是仿射开销，$a_{2}$、$a_{3}$、$a_{5}$分别是基-2、基-3和基-5级的每元素、每级计算系数，$b$是每元素惩罚系数，而$m(N,\\text{plan};S_{0})$是其级前步幅严格超过一个固定阈值$S_{0}$的级的数量，该阈值$S_{0}$代表一个依赖于架构的局部性限制。第$t$级的级前步幅等于前面$(t-1)$个级的基数的乘积。定义$S_{0}=16$（以元素为单位）。\n\n给定此架构上几个FFT的无噪声测量执行时间（单位：微秒）。每次测量都指定了$N$、使用的有序基数序列（从第一级到最后一级）以及测量的时间$T$：\n- $N=120=2^{3}\\cdot 3^{1}\\cdot 5^{1}$，顺序 $\\langle 2,2,2,3,5\\rangle$，$T=3.74$。\n- $N=120=2^{3}\\cdot 3^{1}\\cdot 5^{1}$，顺序 $\\langle 5,3,2,2,2\\rangle$，$T=4.10$。\n- $N=90=2^{1}\\cdot 3^{2}\\cdot 5^{1}$，顺序 $\\langle 2,3,3,5\\rangle$，$T=2.63$。\n- $N=150=2^{1}\\cdot 3^{1}\\cdot 5^{2}$，顺序 $\\langle 2,3,5,5\\rangle$，$T=4.97$。\n- $N=180=2^{2}\\cdot 3^{2}\\cdot 5^{1}$，顺序 $\\langle 2,2,3,3,5\\rangle$，$T=5.96$。\n\n仅使用上述模型以及Cooley–Tukey FFT级结构和步幅的基本性质，完成以下任务：\n1. 根据$N=120$的两次测量，利用排序如何改变计数$m(N,\\text{plan};S_{0})$而计算项保持不变的特点，确定$b$。\n2. 使用余下的测量数据以及$N=120$的其中一次测量数据，精确拟合$a_{2}$、$a_{3}$、$a_{5}$和$c$。\n3. 对于新的变换长度$N_{\\text{new}}=360=2^{3}\\cdot 3^{2}\\cdot 5^{1}$，确定使$m(N_{\\text{new}},\\text{plan};S_{0})$最小化的计划（6个级的排序），并使用拟合的模型预测可实现的最小时间$T_{\\min}(360)$。\n\n将你的最终答案表示为预测的最小执行时间（单位：微秒），四舍五入到四位有效数字。不要在最终答案框中包含单位。", "solution": "所述问题需经过验证。\n\n**步骤1：提取已知信息**\n- 总执行时间模型：$T(N,\\text{plan}) = c + N(a_{2}s_{2} + a_{3}s_{3} + a_{5}s_{5}) + Nbm(N,\\text{plan};S_{0})$\n- 变换长度分解：$N=2^{s_{2}} 3^{s_{3}} 5^{s_{5}}$\n- $c$：仿射开销\n- $a_{2}$、$a_{3}$、$a_{5}$：每元素、每级计算系数\n- $b$：每元素内存惩罚系数\n- $m(N,\\text{plan};S_{0})$：级前步幅超过$S_{0}$的级的数量\n- 步幅阈值：$S_{0}=16$\n- 第$t$级的级前步幅：前$t-1$个级的基数之积。\n- 测量数据（时间$T$单位为微秒）：\n    1. $N=120=2^{3}\\cdot 3^{1}\\cdot 5^{1}$，顺序 $\\langle 2,2,2,3,5\\rangle$，$T=3.74$。\n    2. $N=120=2^{3}\\cdot 3^{1}\\cdot 5^{1}$，顺序 $\\langle 5,3,2,2,2\\rangle$，$T=4.10$。\n    3. $N=90=2^{1}\\cdot 3^{2}\\cdot 5^{1}$，顺序 $\\langle 2,3,3,5\\rangle$，$T=2.63$。\n    4. $N=150=2^{1}\\cdot 3^{1}\\cdot 5^{2}$，顺序 $\\langle 2,3,5,5\\rangle$，$T=4.97$。\n    5. $N=180=2^{2}\\cdot 3^{2}\\cdot 5^{1}$，顺序 $\\langle 2,2,3,3,5\\rangle$，$T=5.96$。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题具有科学依据，植根于已建立的Cooley-Tukey FFT算法理论和标准性能建模技术。该模型是计算和内存访问成本的一个简化但物理上合理的表示。该问题是适定的，提供了五个测量值来确定五个未知的模型参数（$c, a_{2}, a_{3}, a_{5}, b$），这构成了一个可解的方程组。该问题以精确的定义和定量数据客观陈述。它不违反任何无效性标准。\n\n**步骤3：结论与行动**\n问题有效。将推导解答。\n\n**解答推导**\n\n解答按规定的三个任务进行。\n\n**任务1：确定参数$b$**\n模型为$T = c + N(\\sum_{r} a_{r}s_{r}) + Nbm$。对于固定的$N$，无论计划（级的排序）如何，项$C_{\\text{compute}} = c + N(\\sum_{r} a_{r}s_{r})$是恒定的。对于$N=120$的两次测量仅在计划上有所不同，这影响了内存惩罚项$Nbm$。设$T_{1}$，$m_{1}$对应于计划$\\langle 2,2,2,3,5\\rangle$，$T_{2}$，$m_{2}$对应于计划$\\langle 5,3,2,2,2\\rangle$。\n我们有：\n$T_{1} = C_{\\text{compute}} + 120 b m_{1}$\n$T_{2} = C_{\\text{compute}} + 120 b m_{2}$\n将两式相减得到$T_{2} - T_{1} = 120 b (m_{2} - m_{1})$。\n\n我们通过检查级前步幅与阈值$S_{0}=16$的对比来计算$m_{1}$和$m_{2}$。\n对于计划1：$\\langle 2,2,2,3,5\\rangle$。步幅为：\n- 第2级（基数2）：步幅 = $2$\n- 第3级（基数2）：步幅 = $2 \\cdot 2 = 4$\n- 第4级（基数3）：步幅 = $2 \\cdot 2 \\cdot 2 = 8$\n- 第5级（基数5）：步幅 = $2 \\cdot 2 \\cdot 2 \\cdot 3 = 24  16$。产生惩罚。\n初始步幅为$1$，不大于$16$。只有最后一级的步幅超过$16$。因此，$m_{1}=1$。\n\n对于计划2：$\\langle 5,3,2,2,2\\rangle$。步幅为：\n- 第2级（基数3）：步幅 = $5$\n- 第3级（基数2）：步幅 = $5 \\cdot 3 = 15$\n- 第4级（基数2）：步幅 = $5 \\cdot 3 \\cdot 2 = 30  16$。产生惩罚。\n- 第5级（基数2）：步幅 = $5 \\cdot 3 \\cdot 2 \\cdot 2 = 60  16$。产生惩罚。\n因此，$m_{2}=2$。\n\n代入数值：\n$4.10 - 3.74 = 120 \\cdot b \\cdot (2 - 1)$\n$0.36 = 120 b$\n$b = \\frac{0.36}{120} = 0.003$。\n\n**任务2：确定参数$c, a_{2}, a_{3}, a_{5}$**\n我们使用已知的$b$值和四次测量数据来构成一个四元线性方程组。模型可以写成$T - Nbm = c + N \\sum_{r} a_{r}s_{r}$。\n\n1. $N=120$，顺序$\\langle 2,2,2,3,5\\rangle$：$s_2=3, s_3=1, s_5=1$, $m=1$, $T=3.74$。\n$3.74 - 120(0.003)(1) = c + 120(3a_{2} + a_{3} + a_{5})$\n$3.38 = c + 360a_{2} + 120a_{3} + 120a_{5}$ (I)\n\n2. $N=90$，顺序$\\langle 2,3,3,5\\rangle$：$s_2=1, s_3=2, s_5=1$, $T=2.63$。步幅：$2$，$2\\cdot3=6$，$2\\cdot3\\cdot3=18  16$。所以$m=1$。\n$2.63 - 90(0.003)(1) = c + 90(a_{2} + 2a_{3} + a_{5})$\n$2.36 = c + 90a_{2} + 180a_{3} + 90a_{5}$ (II)\n\n3. $N=150$，顺序$\\langle 2,3,5,5\\rangle$：$s_2=1, s_3=1, s_5=2$, $T=4.97$。步幅：$2$，$2\\cdot3=6$，$2\\cdot3\\cdot5=30  16$。所以$m=1$。\n$4.97 - 150(0.003)(1) = c + 150(a_{2} + a_{3} + 2a_{5})$\n$4.52 = c + 150a_{2} + 150a_{3} + 300a_{5}$ (III)\n\n4. $N=180$，顺序$\\langle 2,2,3,3,5\\rangle$：$s_2=2, s_3=2, s_5=1$, $T=5.96$。步幅：$2$，$2\\cdot2=4$，$2\\cdot2\\cdot3=12$，$2\\cdot2\\cdot3\\cdot3=36  16$。所以$m=1$。\n$5.96 - 180(0.003)(1) = c + 180(2a_{2} + 2a_{3} + a_{5})$\n$5.42 = c + 360a_{2} + 360a_{3} + 180a_{5}$ (IV)\n\n我们解这个方程组。用(IV)减去(I)：\n$(c + 360a_{2} + 360a_{3} + 180a_{5}) - (c + 360a_{2} + 120a_{3} + 120a_{5}) = 5.42 - 3.38$\n$240a_{3} + 60a_{5} = 2.04 \\implies 4a_{3} + a_{5} = 0.034$。 (A)\n\n用(I), (III)和(IV)分别减去(II)以消去$c$：\n(I)-(II)：$270a_{2} - 60a_{3} + 30a_{5} = 1.02 \\implies 9a_{2} - 2a_{3} + a_{5} = 0.034$。 (B)\n(IV)-(II)：$270a_{2} + 180a_{3} + 90a_{5} = 3.06 \\implies 3a_{2} + 2a_{3} + a_{5} = 0.034$。 (C)\n\n由(B)和(C)得：$9a_{2} - 2a_{3} + a_{5} = 3a_{2} + 2a_{3} + a_{5} \\implies 6a_{2} = 4a_{3} \\implies a_{3} = 1.5 a_{2}$。\n将$a_{3}=1.5a_2$代入(A)：$4(1.5a_{2}) + a_{5} = 0.034 \\implies 6a_{2} + a_{5} = 0.034 \\implies a_{5} = 0.034 - 6a_{2}$。\n将$a_3$和$a_5$代入(C)：\n$3a_{2} + 2(1.5a_{2}) + (0.034 - 6a_{2}) = 0.034$\n$3a_{2} + 3a_{2} - 6a_{2} + 0.034 = 0.034$，得到$0=0$。这意味着方程组不是线性无关的，表明我必须使用第三个方程。让我们使用(III)-(II)：\n(III)-(II)：$60a_{2} - 30a_{3} + 210a_{5} = 2.16 \\implies 2a_{2} - a_{3} + 7a_{5} = 0.072$。 (D)\n\n现在将$a_3=1.5a_2$和$a_5=0.034-6a_2$代入(D)：\n$2a_{2} - (1.5a_{2}) + 7(0.034 - 6a_{2}) = 0.072$\n$0.5a_{2} + 0.238 - 42a_{2} = 0.072$\n$-41.5a_{2} = 0.072 - 0.238 = -0.166$\n$a_{2} = \\frac{0.166}{41.5} = 0.004$。\n\n由此，我们求得：\n$a_{3} = 1.5 \\cdot a_{2} = 1.5 \\cdot 0.004 = 0.006$。\n$a_{5} = 0.034 - 6 \\cdot a_{2} = 0.034 - 6 \\cdot 0.004 = 0.034 - 0.024 = 0.010$。\n\n最后，将这些值代入(II)以求出$c$：\n$2.36 = c + 90(0.004) + 180(0.006) + 90(0.010)$\n$2.36 = c + 0.36 + 1.08 + 0.90$\n$2.36 = c + 2.34 \\implies c = 0.02$。\n\n拟合的参数为：$c=0.02$，$a_{2}=0.004$，$a_{3}=0.006$，$a_{5}=0.010$，以及$b=0.003$。\n\n**任务3：预测$N_{\\text{new}}=360$的最小时间**\n对于$N_{\\text{new}}=360=2^{3} \\cdot 3^{2} \\cdot 5^{1}$，我们有$s_2=3, s_3=2, s_5=1$。\n总执行时间由下式给出：\n$T(360, \\text{plan}) = c + 360(3a_{2} + 2a_{3} + a_{5}) + 360 b m(360, \\text{plan}; 16)$。\n\n为了达到最小时间$T_{\\min}(360)$，我们必须选择使$m(360, \\text{plan}; 16)$最小化的计划。每一级的步幅是所有前面级的基数之积。为了让这个乘积在尽可能多的级中保持尽可能小，必须将基数从小到大排序。\n可用的基数是三个$2$，两个$3$，和一个$5$。最优计划是$\\langle 2,2,2,3,3,5 \\rangle$。\n让我们为此计划计算$m$：\n- 第1级（基数2）：步幅 = $1$\n- 第2级（基数2）：步幅 = $2$\n- 第3级（基数2）：步幅 = $2 \\cdot 2 = 4$\n- 第4级（基数3）：步幅 = $2 \\cdot 2 \\cdot 2 = 8$\n- 第5级（基数3）：步幅 = $2 \\cdot 2 \\cdot 2 \\cdot 3 = 24  16$。产生惩罚。\n- 第6级（基数5）：步幅 = $2 \\cdot 2 \\cdot 2 \\cdot 3 \\cdot 3 = 72  16$。产生惩罚。\n带有惩罚步幅的最小级数为$m_{\\min}=2$。\n\n现在，我们使用拟合的参数和$m_{\\min}=2$来计算$T_{\\min}(360)$：\n$T_{\\min}(360) = 0.02 + 360(3 \\cdot 0.004 + 2 \\cdot 0.006 + 1 \\cdot 0.010) + 360 \\cdot 0.003 \\cdot 2$\n$T_{\\min}(360) = 0.02 + 360(0.012 + 0.012 + 0.010) + 1.08 \\cdot 2$\n$T_{\\min}(360) = 0.02 + 360(0.034) + 2.16$\n$T_{\\min}(360) = 0.02 + 12.24 + 2.16$\n$T_{\\min}(360) = 14.42$。\n\n预测的最小执行时间为$14.42$微秒。该值按要求给出四位有效数字。", "answer": "$$\\boxed{14.42}$$", "id": "2859656"}]}