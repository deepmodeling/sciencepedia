{"hands_on_practices": [{"introduction": "快速卷积方法的核心，是通过使用快速傅里叶变换（FFT）来高效计算循环卷积，从而实现线性卷积。然而，这两种卷积只有在特定条件下才能等价。本练习旨在通过一个具体的反例，揭示当FFT长度 $N$ 选择不当时所产生的时域混叠（time-domain aliasing）现象，这对于理解重叠相加法和重叠保留法的设计原理至关重要 [@problem_id:2870370]。", "problem": "考虑在重叠相加法 (OLA) 或重叠保留法 (OLS) 框架下，通过离散傅里叶变换 (DFT) 实现快速卷积。设有限冲激响应 (FIR) 滤波器的长度为 $M=4$，其冲激响应 $h[n]$ 的支撑集为 $n \\in \\{0,1,2,3\\}$。设输入数据块的长度为 $L=5$，其样本 $x[n]$ 的支撑集为 $n \\in \\{0,1,2,3,4\\}$。你将研究选择低于无混叠阈值的 DFT 长度 $N$ 与选择恰好为该阈值的 DFT 长度 $N$ 对圆周卷积结果的影响。\n\n给定具体序列如下：\n- $x[0]=2$, $x[1]=-1$, $x[2]=0$, $x[3]=3$, $x[4]=1$ (其他情况下 $x[n]=0$),\n- $h[0]=1$, $h[1]=-2$, $h[2]=1$, $h[3]=-1$ (其他情况下 $h[n]=0$)。\n\n仅从线性卷积和圆周卷积的核心定义，以及 N 点周期性延拓的圆周卷积实现了模 N 卷积这一事实出发，完成以下任务：\n\n1) 计算线性卷积 $y_{\\text{lin}}[n]=(x*h)[n]$，其中 $n \\in \\{0,1,\\dots,7\\}$。\n\n2) 解释为什么对于这对序列 $(x,h)$，选择 $N=8$ 可以避免时域混叠，并验证当 $N=8$ 时，其圆周卷积结果在 $n \\in \\{0,1,\\dots,7\\}$ 范围内与 $y_{\\text{lin}}[n]$ 相等。\n\n3) 计算当 $N=6$ 时的圆周卷积输出 $y_{6}[n]$，其中 $n \\in \\{0,1,2,3,4,5\\}$，并利用模 N 结构，准确指出哪些线性卷积样本发生了折叠（混叠），以及它们出现在 $y_{6}[n]$ 中的什么位置。\n\n4) 定义混叠误差向量 $e[n]=y_{6}[n]-y_{\\text{lin}}[n]$，其中 $n \\in \\{0,1,2,3,4,5\\}$，并计算其欧几里得范数的平方\n$$\nE=\\sum_{n=0}^{5} \\big(e[n]\\big)^{2}.\n$$\n\n给出实数 $E$ 作为你的最终答案。无需单位。除非必要，否则不要四舍五入；如果需要四舍五入，则保留4位有效数字。", "solution": "如上所述，该问题具有科学依据、自成体系且定义明确。这是数字信号处理中的一个标准练习，旨在测试对线性卷积和圆周卷积之间关系的基本理解，该关系是重叠相加法和重叠保留法等快速卷积方法的理论基础。所有必要的数据和定义均已提供，问题明确无误。该问题是有效的，我们可以开始解答。\n\n连接线性卷积和圆周卷积的核心原理是，两个有限长序列 $x[n]$ 和 $h[n]$ 的 $N$ 点圆周卷积等同于其线性卷积 $y_{\\text{lin}}[n]$ 的时域混叠版本。更正式地讲，如果 $y_N[n]$ 表示 $N$ 点圆周卷积，其与线性卷积 $y_{\\text{lin}}[n] = (x*h)[n]$ 的关系由下式给出：\n$$\ny_N[n] = \\sum_{l=-\\infty}^{\\infty} y_{\\text{lin}}[n+lN]\n$$\n对于 $n \\in \\{0, 1, \\dots, N-1\\}$。\n\n$1$) 首先，我们计算线性卷积 $y_{\\text{lin}}[n] = (x*h)[n]$。输入序列 $x[n]$ 的长度为 $L=5$，支撑集为 $n \\in \\{0,1,2,3,4\\}$，冲激响应 $h[n]$ 的长度为 $M=4$，支撑集为 $n \\in \\{0,1,2,3\\}$。得到的线性卷积 $y_{\\text{lin}}[n]$ 的长度为 $L+M-1 = 5+4-1 = 8$，支撑集为 $n \\in \\{0, 1, \\dots, 7\\}$。卷积和为 $y_{\\text{lin}}[n] = \\sum_{k=0}^{4} x[k]h[n-k]$。\n\n- 对于 $n=0$: $y_{\\text{lin}}[0] = x[0]h[0] = (2)(1) = 2$。\n- 对于 $n=1$: $y_{\\text{lin}}[1] = x[0]h[1] + x[1]h[0] = (2)(-2) + (-1)(1) = -4 - 1 = -5$。\n- 对于 $n=2$: $y_{\\text{lin}}[2] = x[0]h[2] + x[1]h[1] + x[2]h[0] = (2)(1) + (-1)(-2) + (0)(1) = 2 + 2 = 4$。\n- 对于 $n=3$: $y_{\\text{lin}}[3] = x[0]h[3] + x[1]h[2] + x[2]h[1] + x[3]h[0] = (2)(-1) + (-1)(1) + (0)(-2) + (3)(1) = -2 - 1 + 3 = 0$。\n- 对于 $n=4$: $y_{\\text{lin}}[4] = x[1]h[3] + x[2]h[2] + x[3]h[1] + x[4]h[0] = (-1)(-1) + (0)(1) + (3)(-2) + (1)(1) = 1 - 6 + 1 = -4$。\n- 对于 $n=5$: $y_{\\text{lin}}[5] = x[2]h[3] + x[3]h[2] + x[4]h[1] = (0)(-1) + (3)(1) + (1)(-2) = 3 - 2 = 1$。\n- 对于 $n=6$: $y_{\\text{lin}}[6] = x[3]h[3] + x[4]h[2] = (3)(-1) + (1)(1) = -3 + 1 = -2$。\n- 对于 $n=7$: $y_{\\text{lin}}[7] = x[4]h[3] = (1)(-1) = -1$。\n\n因此，线性卷积序列为 $y_{\\text{lin}}[n] = \\{2, -5, 4, 0, -4, 1, -2, -1\\}$，其中 $n \\in \\{0, 1, \\dots, 7\\}$。\n\n$2$) 为使圆周卷积产生与线性卷积相同的结果，必须选择 DFT 长度 $N$，以确保不发生时域混叠。这要求长度 $N$ 至少与线性卷积输出的长度一样大。如计算所得，$y_{\\text{lin}}[n]$ 的长度为 $L+M-1=8$。因此，避免混叠的条件是 $N \\ge 8$。选择 $N=8$ 满足此最低要求。\n\n为了验证这一点，我们使用 $N=8$ 的混叠公式：\n$$\ny_8[n] = \\sum_{l=-\\infty}^{\\infty} y_{\\text{lin}}[n+8l]\n$$\n对于 $n \\in \\{0, 1, \\dots, 7\\}$，索引 $n+8l$ 仅在 $l=0$ 时才落在 $y_{\\text{lin}}[n]$ 的支撑集（即 $\\{0, 1, \\dots, 7\\}$）内。对于任何其他整数 $l$， $n+8l$ 都在此范围之外，因此 $y_{\\text{lin}}[n+8l]$ 将为零。因此，该求和简化为 $l=0$ 时的单项，我们发现对于所有 $n \\in \\{0, 1, \\dots, 7\\}$，都有 $y_8[n] = y_{\\text{lin}}[n]$。这证实了 $N=8$ 可以避免混叠。\n\n$3$) 现在我们计算 $N=6$ 时的圆周卷积 $y_6[n]$。由于 $N=6  8$，我们预计会发生时域混叠。我们对 $n \\in \\{0, 1, \\dots, 5\\}$ 应用混叠公式：\n$$\ny_6[n] = \\sum_{l=-\\infty}^{\\infty} y_{\\text{lin}}[n+6l]\n$$\n$y_{\\text{lin}}[n]$ 中的非零项的索引范围是从 $0$ 到 $7$。我们计算 $y_6[n]$：\n- 对于 $n=0$: $y_6[0] = y_{\\text{lin}}[0] + y_{\\text{lin}}[0+6] = y_{\\text{lin}}[0] + y_{\\text{lin}}[6] = 2 + (-2) = 0$。样本 $y_{\\text{lin}}[6]$ 发生混叠（折叠）并与 $y_{\\text{lin}}[0]$ 相加。\n- 对于 $n=1$: $y_6[1] = y_{\\text{lin}}[1] + y_{\\text{lin}}[1+6] = y_{\\text{lin}}[1] + y_{\\text{lin}}[7] = -5 + (-1) = -6$。样本 $y_{\\text{lin}}[7]$ 与 $y_{\\text{lin}}[1]$ 发生混叠。\n- 对于 $n=2$: $y_6[2] = y_{\\text{lin}}[2] + y_{\\text{lin}}[2+6] = y_{\\text{lin}}[2] + y_{\\text{lin}}[8] = 4 + 0 = 4$。\n- 对于 $n=3$: $y_6[3] = y_{\\text{lin}}[3] + y_{\\text{lin}}[3+6] = y_{\\text{lin}}[3] + y_{\\text{lin}}[9] = 0 + 0 = 0$。\n- 对于 $n=4$: $y_6[4] = y_{\\text{lin}}[4] + y_{\\text{lin}}[4+6] = y_{\\text{lin}}[4] + y_{\\text{lin}}[10] = -4 + 0 = -4$。\n- 对于 $n=5$: $y_6[5] = y_{\\text{lin}}[5] + y_{\\text{lin}}[5+6] = y_{\\text{lin}}[5] + y_{\\text{lin}}[11] = 1 + 0 = 1$。\n得到的 $N=6$ 圆周卷积序列为 $y_6[n] = \\{0, -6, 4, 0, -4, 1\\}$，其中 $n \\in \\{0, 1, \\dots, 5\\}$。样本 $y_{\\text{lin}}[6]$ 和 $y_{\\text{lin}}[7]$ 是发生折叠的样本，它们分别出现在索引 $6 \\pmod 6 = 0$ 和 $7 \\pmod 6 = 1$ 处。\n\n$4$) 混叠误差向量定义为 $e[n] = y_6[n] - y_{\\text{lin}}[n]$，其中 $n \\in \\{0, 1, \\dots, 5\\}$。使用上述结果：\n- $e[0] = y_6[0] - y_{\\text{lin}}[0] = 0 - 2 = -2$。\n- $e[1] = y_6[1] - y_{\\text{lin}}[1] = -6 - (-5) = -1$。\n- $e[2] = y_6[2] - y_{\\text{lin}}[2] = 4 - 4 = 0$。\n- $e[3] = y_6[3] - y_{\\text{lin}}[3] = 0 - 0 = 0$。\n- $e[4] = y_6[4] - y_{\\text{lin}}[4] = -4 - (-4) = 0$。\n- $e[5] = y_6[5] - y_{\\text{lin}}[5] = 1 - 1 = 0$。\n误差向量为 $e[n] = \\{-2, -1, 0, 0, 0, 0\\}$。该误差向量的非零元素正是混叠项：$e[0] = y_{\\text{lin}}[6]$ 和 $e[1] = y_{\\text{lin}}[7]$。\n\n最后，我们计算误差向量的欧几里得范数的平方，$E$：\n$$\nE = \\sum_{n=0}^{5} \\big(e[n]\\big)^{2} = (e[0])^2 + (e[1])^2 + (e[2])^2 + (e[3])^2 + (e[4])^2 + (e[5])^2\n$$\n$$\nE = (-2)^2 + (-1)^2 + 0^2 + 0^2 + 0^2 + 0^2 = 4 + 1 + 0 + 0 + 0 + 0 = 5.\n$$\n总混叠误差能量为 $5$。", "answer": "$$\\boxed{5}$$", "id": "2870370"}, {"introduction": "在理解了循环卷积可能引入的混叠问题后，我们可以进一步探究像重叠保留（Overlap-Save）这样的算法是如何巧妙地规避这个问题的。本练习将引导你逐步完成单个数据块的处理过程。通过亲手构建输入块、计算卷积并识别出有效的输出样本，你将对该算法的内部工作机制获得具体而深入的认识 [@problem_id:2870379]。", "problem": "一个冲激响应长度为 $L=5$ 的离散时间线性时不变 (LTI) 系统将使用块长度为 $N=16$ 的重叠保留法通过快速卷积来实现。令冲激响应为 $$h[n] = \\begin{cases} 1,  n=0 \\\\ 2,  n=1 \\\\ 3,  n=2 \\\\ 2,  n=3 \\\\ 1,  n=4 \\\\ 0,  \\text{其它} \\end{cases}$$ 并且令输入为 $$x[n] = \\begin{cases} n,  n \\ge 0 \\\\ 0,  n  0 \\end{cases}$$ 第一个重叠保留块由拼接 $L-1$ 个过去的样本（重叠部分）和 $B$ 个新样本形成，使得总块长度为 $N$，其中 $B = N - L + 1 = 12$。该块通过对与 $x[n]$ 和 $h[n]$ 对应的 $N$ 点序列（就像它们为基于快速傅里叶变换 (FFT) 的实现而形成的那样）进行 $16$ 点循环卷积来处理。在重叠保留法中，前 $L-1$ 个循环卷积输出被丢弃，余下的 $B$ 个输出被保留。\n\n任务：\n- 明确列出用于第一个块的重叠输入样本，以及为形成 $N=16$ 输入块而附加的 $B=12$ 个新输入样本。\n- 明确列出此块产生的 $B=12$ 个保留输出的全局时间索引。\n- 仅使用线性卷积的定义，以及重叠保留法在保留区域上循环卷积与线性卷积的等价性，计算最后一个保留输出样本的值（此块的第十二个保留输出）。以精确数的形式提供最终答案。无需四舍五入。", "solution": "问题陈述经过审查，被认为是有效的。这是一个数字信号处理中的适定问题，提供了所有必要的参数和定义。它具有科学依据，是客观且内部一致的。我们将继续进行解答。\n\n该问题指定了一个使用重叠保留法进行快速卷积的离散时间线性时不变 (LTI) 系统。关键参数如下：\n- 冲激响应长度：$L=5$。\n- FFT/块长度：$N=16$。\n- 每块新样本数：$B = N - L + 1 = 16 - 5 + 1 = 12$。\n- 重叠样本数：$L-1 = 4$。\n\n冲激响应给出为：\n$$h[n] = h[0]\\delta[n] + h[1]\\delta[n-1] + h[2]\\delta[n-2] + h[3]\\delta[n-3] + h[4]\\delta[n-4]$$\n系数为 $h[0]=1$，$h[1]=2$，$h[2]=3$，$h[3]=2$，$h[4]=1$。\n\n输入信号是一个从 $n=0$ 开始的斜坡函数：\n$$x[n] = \\begin{cases} n,  n \\ge 0 \\\\ 0,  n  0 \\end{cases}$$\n\n解答将按顺序处理这三个任务。\n\n第一个任务：列出第一个块的输入样本。\n重叠保留法通过从前一个输入数据段的末尾取 $L-1$ 个样本，并附加来自输入信号的 $B$ 个新样本，来构造每个长度为 $N$ 的输入块。对于第一个块，“先前”的样本对应于输入信号的负时间索引。\n\n第一个输入块，我们将其表示为序列 $x_1[k]$（其中 $k=0, 1, \\dots, N-1$），对应于全局输入信号 $x[n]$ 在时间区间从 $n=-(L-1)$ 到 $n=B-1$ 的部分。\n这里，$L-1 = 4$ 且 $B-1 = 11$。因此，该块对应于 $n \\in \\{-4, -3, \\dots, 11\\}$ 的 $x[n]$。\n\n重叠样本是该块的前 $L-1=4$ 个样本。它们对应的全局时间索引为 $n = -4, -3, -2, -1$。其值为：\n- $x[-4] = 0$\n- $x[-3] = 0$\n- $x[-2] = 0$\n- $x[-1] = 0$\n\n新输入样本是随后的 $B=12$ 个样本。它们对应的全局时间索引为 $n = 0, 1, \\dots, 11$。其值为：\n- $x[0] = 0$\n- $x[1] = 1$\n- $x[2] = 2$\n- $x[3] = 3$\n- $x[4] = 4$\n- $x[5] = 5$\n- $x[6] = 6$\n- $x[7] = 7$\n- $x[8] = 8$\n- $x[9] = 9$\n- $x[10] = 10$\n- $x[11] = 11$\n\n第二个任务：列出保留输出的全局时间索引。\n在重叠保留法中，对输入块和补零的冲激响应执行长度为 $N$ 的循环卷积。前 $L-1$ 个输出样本因受到时域混叠（循环卷积的环绕效应）的破坏而被丢弃。余下的 $B = N-L+1$ 个样本是有效的，并精确地对应于输入信号 $x[n]$ 与冲激响应 $h[n]$ 的线性卷积。\n\n对于第一个块，“新”数据从全局时间索引 $n=0$ 开始。$B=12$ 个保留的输出样本对应于与新输入样本相同的全局时间索引的线性卷积输出 $y[n] = (x*h)[n]$。因此，第一个块的 $B=12$ 个保留输出的全局时间索引是：\n$$n = 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11$$\n\n第三个任务：计算最后一个保留输出样本的值。\n第一个块的最后一个保留输出样本是第 $12$ 个，对应于全局时间索引 $n=11$。我们必须计算线性卷积输出 $y[11]$ 的值。\n\n线性卷积由以下求和定义：\n$$y[n] = (x*h)[n] = \\sum_{k=-\\infty}^{\\infty} h[k]x[n-k]$$\n由于冲激响应 $h[k]$ 仅在 $k \\in \\{0, 1, 2, 3, 4\\}$ 时非零，该和简化为：\n$$y[n] = \\sum_{k=0}^{4} h[k]x[n-k]$$\n我们需要为 $n=11$ 计算这个值：\n$$y[11] = \\sum_{k=0}^{4} h[k]x[11-k]$$\n展开求和得到：\n$$y[11] = h[0]x[11] + h[1]x[10] + h[2]x[9] + h[3]x[8] + h[4]x[7]$$\n我们代入冲激响应 $h[k]$ 和输入信号 $x[n]=n$ 的给定值（因为所有自变量 $11, 10, \\dots, 7$ 都是非负的）：\n- $h[0]=1, h[1]=2, h[2]=3, h[3]=2, h[4]=1$\n- $x[11]=11, x[10]=10, x[9]=9, x[8]=8, x[7]=7$\n\n将这些值代入 $y[11]$ 的表达式中：\n$$y[11] = (1)(11) + (2)(10) + (3)(9) + (2)(8) + (1)(7)$$\n进行算术运算：\n$$y[11] = 11 + 20 + 27 + 16 + 7$$\n$$y[11] = 31 + 27 + 16 + 7$$\n$$y[11] = 58 + 16 + 7$$\n$$y[11] = 74 + 7$$\n$$y[11] = 81$$\n最后一个保留输出样本的值是 $81$。", "answer": "$$\\boxed{81}$$", "id": "2870379"}, {"introduction": "从理论走向应用，最后一个练习将让你扮演系统设计者的角色。在现实世界的信号处理任务中，算法的实现通常受到严格的性能约束，如处理速度（吞吐量）和信号延迟（时延）。本练习将挑战你在满足这些约束的条件下，选择最优的算法参数（如块大小 $B$ 和FFT长度 $N$），从而揭示在快速卷积的实际部署中所涉及的权衡与优化 [@problem_id:2870437]。", "problem": "一个长度为 $L$ 个采样点的因果、时不变有限脉冲响应滤波器将通过重叠相加法实现的快速卷积应用于实时输入流。输入以每秒 $R$ 个采样点的实时吞吐量进行采样，端到端延迟预算为 $D$ 秒。在重叠相加法中，每个块使用长度为 $N$ 的补零离散傅里叶变换 (DFT) 来处理 $B$ 个新采集的样本，其中 $N$ 满足 $N \\geq B + L - 1$。为了利用高效的基于基数的实现，DFT 长度 $N$ 必须是 2 的幂。使用快速傅里叶变换 (FFT) 和逆快速傅里叶变换 (IFFT) 来计算 DFT。\n\n假设以下实现和平台条件，这些条件代表了经过良好测试的基准行为：\n- 长度为 $N$ 的复数快速傅里叶变换 (FFT) 的运行时间为 $t_{\\mathrm{FFT}}(N) = \\alpha \\, N \\log_{2} N + \\beta \\, N$ 秒；逆 FFT 具有相同的运行时间 $t_{\\mathrm{IFFT}}(N) = \\alpha \\, N \\log_{2} N + \\beta \\, N$ 秒。\n- $N$ 点频谱的逐点复数乘法耗时 $t_{\\times}(N) = \\gamma \\, N$ 秒。\n- 恒定的每块开销（缓冲、加窗和杂项操作）耗时 $t_{0}$ 秒。\n- 滤波器的 DFT 是离线预计算的，不计入每块的运行时间。\n\n因此，重叠相加法的每块处理时间为\n$$\nt_{\\mathrm{proc}}(N) = 2\\big(\\alpha \\, N \\log_{2} N + \\beta \\, N\\big) + \\gamma \\, N + t_{0}.\n$$\n\n实时可行性要求，对于每个块，其计算必须在采集接下来的 $B$ 个样本的时间内完成。这得出了吞吐量约束\n$$\nt_{\\mathrm{proc}}(N) \\leq \\frac{B}{R}.\n$$\n在块实时处理中，一个保守且广泛使用的端到端延迟上界是通过将最坏情况下的块缓冲延迟与每块的计算时间相加得到的，这得出了延迟约束\n$$\n\\frac{B}{R} + t_{\\mathrm{proc}}(N) \\leq D.\n$$\n\n给定具体参数\n- $R = 4.8 \\times 10^{4}$ 采样点/秒，\n- $D = 1.0 \\times 10^{-2}$ 秒，\n- $L = 5.13 \\times 10^{2}$ 采样点，\n- $\\alpha = 3.2 \\times 10^{-8}$ 秒，\n- $\\beta = 2.0 \\times 10^{-9}$ 秒，\n- $\\gamma = 1.0 \\times 10^{-9}$ 秒，\n- $t_{0} = 8.0 \\times 10^{-6}$ 秒，\n\n确定使 $B$ 最大化的数对 $(B^{\\star}, N^{\\star})$，并满足以下条件：\n- $N$ 是 2 的幂，\n- $N \\geq B + L - 1$，\n- $t_{\\mathrm{proc}}(N) \\leq \\frac{B}{R}$，\n- $\\frac{B}{R} + t_{\\mathrm{proc}}(N) \\leq D$。\n\n你的答案应以整数对 $(B^{\\star}, N^{\\star})$ 的形式报告，不带单位。如果多个数对达到相同的最大 $B$ 值，请选择 $N$ 值最小的那个。你的最终答案必须是单行矩阵。除了此处声明的整数约束外，无需进行四舍五入。", "solution": "目标是确定整数对 $(B^{\\star}, N^{\\star})$，在满足一组与实时快速卷积相关的约束条件下，使块大小 $B$ 最大化。约束条件如下：\n1. $N$ 必须是 2 的幂。\n2. 重叠相加法的结构约束：$N \\geq B + L - 1$。\n3. 实时吞吐量约束：$t_{\\mathrm{proc}}(N) \\leq \\frac{B}{R}$。\n4. 端到端延迟约束：$\\frac{B}{R} + t_{\\mathrm{proc}}(N) \\leq D$。\n\n每块处理时间由下式给出\n$$t_{\\mathrm{proc}}(N) = 2\\big(\\alpha N \\log_{2} N + \\beta N\\big) + \\gamma N + t_{0}$$\n可以简化为\n$$t_{\\mathrm{proc}}(N) = (2\\alpha) N \\log_{2} N + (2\\beta + \\gamma) N + t_{0}$$\n\n吞吐量和延迟约束可以合并。根据约束 3，我们有 $B \\geq R \\cdot t_{\\mathrm{proc}}(N)$。根据约束 4，我们有 $B \\leq R(D - t_{\\mathrm{proc}}(N))$。对于给定的 $N$，要使 $B$ 存在可行解，必须满足\n$$R \\cdot t_{\\mathrm{proc}}(N) \\leq R(D - t_{\\mathrm{proc}}(N))$$\n这可以简化为必要条件\n$$2 t_{\\mathrm{proc}}(N) \\leq D$$\n该不等式为 $N$ 的允许值提供了一个上界。\n\n给定的参数是：\n- $R = 4.8 \\times 10^{4}$\n- $D = 1.0 \\times 10^{-2}$\n- $L = 513$\n- $\\alpha = 3.2 \\times 10^{-8}$\n- $\\beta = 2.0 \\times 10^{-9}$\n- $\\gamma = 1.0 \\times 10^{-9}$\n- $t_{0} = 8.0 \\times 10^{-6}$\n\n首先，我们计算处理时间函数的系数：\n$$2\\alpha = 2 \\times (3.2 \\times 10^{-8}) = 6.4 \\times 10^{-8}$$\n$$2\\beta + \\gamma = 2 \\times (2.0 \\times 10^{-9}) + 1.0 \\times 10^{-9} = 5.0 \\times 10^{-9}$$\n所以，处理时间为\n$$t_{\\mathrm{proc}}(N) = (6.4 \\times 10^{-8}) N \\log_{2} N + (5.0 \\times 10^{-9}) N + 8.0 \\times 10^{-6}$$\n必要条件变为 $t_{\\mathrm{proc}}(N) \\leq D/2$，即\n$$t_{\\mathrm{proc}}(N) \\leq \\frac{1.0 \\times 10^{-2}}{2} = 5.0 \\times 10^{-3}$$\n\n我们必须搜索满足此条件的、作为 2 的幂的 $N$ 值。结构约束 $N \\geq B + L - 1$ 意味着 $N \\geq B + 513 - 1 = B + 512$。由于 $B$ 必须是正整数，所以 $B \\geq 1$，这意味着 $N \\geq 513$。大于或等于 513 的最小的 2 的幂是 $N = 1024$。\n\n让我们从 1024 开始测试 $N$ 的候选值：\n\n对于 $N = 1024 = 2^{10}$：\n$t_{\\mathrm{proc}}(1024) = (6.4 \\times 10^{-8})(1024)(10) + (5.0 \\times 10^{-9})(1024) + 8.0 \\times 10^{-6}$\n$t_{\\mathrm{proc}}(1024) = 6.5536 \\times 10^{-4} + 5.12 \\times 10^{-6} + 8.0 \\times 10^{-6} = 6.6848 \\times 10^{-4}$ 秒。\n检查必要条件：$t_{\\mathrm{proc}}(1024) = 6.6848 \\times 10^{-4} \\leq 5.0 \\times 10^{-3}$。该条件满足。\n\n对于 $N = 2048 = 2^{11}$：\n$t_{\\mathrm{proc}}(2048) = (6.4 \\times 10^{-8})(2048)(11) + (5.0 \\times 10^{-9})(2048) + 8.0 \\times 10^{-6}$\n$t_{\\mathrm{proc}}(2048) = 1.441792 \\times 10^{-3} + 1.024 \\times 10^{-5} + 8.0 \\times 10^{-6} = 1.460032 \\times 10^{-3}$ 秒。\n检查必要条件：$t_{\\mathrm{proc}}(2048) = 1.460032 \\times 10^{-3} \\leq 5.0 \\times 10^{-3}$。该条件满足。\n\n对于 $N = 4096 = 2^{12}$：\n$t_{\\mathrm{proc}}(4096) = (6.4 \\times 10^{-8})(4096)(12) + (5.0 \\times 10^{-9})(4096) + 8.0 \\times 10^{-6}$\n$t_{\\mathrm{proc}}(4096) = 3.145728 \\times 10^{-3} + 2.048 \\times 10^{-5} + 8.0 \\times 10^{-6} = 3.174208 \\times 10^{-3}$ 秒。\n检查必要条件：$t_{\\mathrm{proc}}(4096) = 3.174208 \\times 10^{-3} \\leq 5.0 \\times 10^{-3}$。该条件满足。\n\n对于 $N = 8192 = 2^{13}$：\n$t_{\\mathrm{proc}}(8192) = (6.4 \\times 10^{-8})(8192)(13) + (5.0 \\times 10^{-9})(8192) + 8.0 \\times 10^{-6}$\n$t_{\\mathrm{proc}}(8192) = 6.815744 \\times 10^{-3} + 4.096 \\times 10^{-5} + 8.0 \\times 10^{-6} = 6.864704 \\times 10^{-3}$ 秒。\n检查必要条件：$t_{\\mathrm{proc}}(8192) = 6.864704 \\times 10^{-3}  5.0 \\times 10^{-3}$。该条件不满足。\n\n因此，$N$ 的唯一可能值为 $\\{1024, 2048, 4096\\}$。对于这些值中的每一个，我们必须找到最大可能的整数 $B$。$B$ 的约束条件是：\n- $B \\leq N - L + 1 = N - 512$\n- $B \\geq R \\cdot t_{\\mathrm{proc}}(N)$\n- $B \\leq R(D - t_{\\mathrm{proc}}(N))$\n\n这意味着对于给定的 $N$，$B$ 的最大整数值为\n$$B_{max}(N) = \\min\\left( N - 512, \\lfloor R(D - t_{\\mathrm{proc}}(N)) \\rfloor \\right)$$\n我们还必须确保该值与下界一致，即 $B_{max}(N) \\geq \\lceil R \\cdot t_{\\mathrm{proc}}(N) \\rceil$。\n\n现在我们为每个有效的 $N$ 计算 $B_{max}(N)$：\n\n情况 $N = 1024$：\n- $B \\leq 1024 - 512 = 512$。\n- $B \\geq (4.8 \\times 10^4) \\times (6.6848 \\times 10^{-4}) = 32.08704$。所以，$B \\geq 33$。\n- $B \\leq (4.8 \\times 10^4) \\times (1.0 \\times 10^{-2} - 6.6848 \\times 10^{-4}) = (4.8 \\times 10^4) \\times (9.33152 \\times 10^{-3}) = 447.91296$。所以，$B \\leq 447$。\n结合约束条件，$33 \\leq B \\leq \\min(512, 447) = 447$。最大值为 $B_{max}(1024) = 447$。\n\n情况 $N = 2048$：\n- $B \\leq 2048 - 512 = 1536$。\n- $B \\geq (4.8 \\times 10^4) \\times (1.460032 \\times 10^{-3}) = 70.081536$。所以，$B \\geq 71$。\n- $B \\leq (4.8 \\times 10^4) \\times (1.0 \\times 10^{-2} - 1.460032 \\times 10^{-3}) = (4.8 \\times 10^4) \\times (8.539968 \\times 10^{-3}) = 409.918464$。所以，$B \\leq 409$。\n结合约束条件，$71 \\leq B \\leq \\min(1536, 409) = 409$。最大值为 $B_{max}(2048) = 409$。\n\n情况 $N = 4096$：\n- $B \\leq 4096 - 512 = 3584$。\n- $B \\geq (4.8 \\times 10^4) \\times (3.174208 \\times 10^{-3}) = 152.361984$。所以，$B \\geq 153$。\n- $B \\leq (4.8 \\times 10^4) \\times (1.0 \\times 10^{-2} - 3.174208 \\times 10^{-3}) = (4.8 \\times 10^4) \\times (6.825792 \\times 10^{-3}) = 327.638016$。所以，$B \\leq 327$。\n结合约束条件，$153 \\leq B \\leq \\min(3584, 327) = 327$。最大值为 $B_{max}(4096) = 327$。\n\n比较每个有效 $N$ 对应的 $B$ 的最大值：\n- 对于 $N=1024$，$B_{max}=447$。\n- 对于 $N=2048$，$B_{max}=409$。\n- 对于 $N=4096$，$B_{max}=327$。\n\n$B$ 的全局最大值为 $B^{\\star} = 447$，这是在 $N^{\\star} = 1024$ 时达到的。题目要求，如果多个数对达到相同的最大 $B$ 值，则选择 $N$ 最小的那个。在这里，最大值 $B$ 对应唯一的 $N$，所以这个平局决胜规则不是严格必要的，但该解与其一致。\n\n最优对为 $(B^{\\star}, N^{\\star}) = (447, 1024)$。", "answer": "$$\\boxed{\\begin{pmatrix} 447  1024 \\end{pmatrix}}$$", "id": "2870437"}]}