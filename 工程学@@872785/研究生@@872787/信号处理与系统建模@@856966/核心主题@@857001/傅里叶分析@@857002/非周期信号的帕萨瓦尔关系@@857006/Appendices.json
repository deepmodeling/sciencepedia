{"hands_on_practices": [{"introduction": "理论知识的掌握最终需要通过实践来巩固。我们从信号处理中最基本也最重要的信号之一——矩形脉冲开始。这个练习将引导你为矩形脉冲信号验证帕塞瓦尔关系，通过直接的积分计算来证明其时域能量等于其频域能量。这个过程将带你回顾矩形脉冲与 $sinc$ 函数这对经典的傅里叶变换对，并让你对能量如何在两个域中分布有一个直观的认识 ([@problem_id:2889866])。", "problem": "设 $T0$ 并定义非周期信号 $x(t)$ 为矩形脉冲\n$$\nx(t) \\triangleq \\operatorname{rect}\\!\\left(\\frac{t}{T}\\right) \\equiv \\begin{cases}\n1,  |t|  \\frac{T}{2} \\\\\n0,  |t| > \\frac{T}{2}\n\\end{cases}\n$$\n端点 $t=\\pm T/2$ 处的取值可以任意选择，因为它不影响任何积分。采用角频率傅里叶变换的约定\n$$\nX(\\omega) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-\\mathrm{j}\\,\\omega t)\\,dt,\\qquad\nx(t) \\triangleq \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega)\\,\\exp(\\mathrm{j}\\,\\omega t)\\,d\\omega,\n$$\n其中 $\\mathrm{j}$ 是虚数单位。仅使用这些定义和经过充分验证的积分事实，完成以下任务：\n- 直接根据傅里叶变换的定义推导 $X(\\omega)$ 的闭式表达式。您可以使用未归一化的 sinc 函数 $\\mathrm{sinc}(u)\\triangleq \\sin(u)/u$ 及其连续延拓 $\\mathrm{sinc}(0)\\triangleq 1$ 来表示您的答案。\n- 计算时域能量 $E_{t}\\triangleq \\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt$。\n- 通过直接积分计算频域量 $E_{\\omega}\\triangleq \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega$，不要引用任何能量守恒定理。您可以使用 $\\mathrm{sinc}$ 函数的标准积分恒等式，这些恒等式可以独立于任何帕塞瓦尔类型的结果得到证明。\n- 报告 $E_{t}$ 和 $E_{\\omega}$ 的共同值 $E$ 作为 $T$ 的函数。\n\n答案格式要求：最终答案只提供 $E$ 的解析表达式（一个关于 $T$ 的实值函数）。无需四舍五入，也不包含单位。", "solution": "该问题陈述是傅里叶分析基础中一个适定（well-posed）的练习。它在科学上是合理的、自洽的，并且没有歧义。因此，我们开始进行求解。\n\n该问题要求对矩形脉冲信号 $x(t) \\triangleq \\operatorname{rect}\\!\\left(\\frac{t}{T}\\right)$ 进行四部分的推导。\n\n首先，我们推导 $x(t)$ 的傅里叶变换 $X(\\omega)$。根据给定的定义：\n$$\nX(\\omega) \\triangleq \\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-\\mathrm{j}\\,\\omega t)\\,dt\n$$\n根据 $x(t)$ 的定义，被积函数仅在 $|t|  T/2$ 时非零，此时 $x(t)=1$。因此积分为：\n$$\nX(\\omega) = \\int_{-T/2}^{T/2} 1 \\cdot \\exp(-\\mathrm{j}\\,\\omega t)\\,dt\n$$\n对于 $\\omega \\neq 0$ 的情况，我们直接计算积分：\n$$\nX(\\omega) = \\left[ \\frac{\\exp(-\\mathrm{j}\\,\\omega t)}{-\\mathrm{j}\\,\\omega} \\right]_{t=-T/2}^{t=T/2} = \\frac{\\exp(-\\mathrm{j}\\,\\omega T/2) - \\exp(\\mathrm{j}\\,\\omega T/2)}{-\\mathrm{j}\\,\\omega}\n$$\n使用恒等式 $\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta) = 2\\mathrm{i}\\sin(\\theta)$，我们将分子用正弦函数表示：\n$$\nX(\\omega) = \\frac{-\\left( \\exp(\\mathrm{j}\\,\\omega T/2) - \\exp(-\\mathrm{j}\\,\\omega T/2) \\right)}{-\\mathrm{j}\\,\\omega} = \\frac{-2\\mathrm{j}\\sin(\\omega T/2)}{-\\mathrm{j}\\omega} = \\frac{2\\sin(\\omega T/2)}{\\omega}\n$$\n为了符合使用未归一化 sinc 函数 $\\mathrm{sinc}(u) \\triangleq \\sin(u)/u$ 的要求格式，我们对表达式进行整理：\n$$\nX(\\omega) = T \\cdot \\frac{\\sin(\\omega T/2)}{\\omega T/2} = T \\, \\mathrm{sinc}\\left(\\frac{\\omega T}{2}\\right)\n$$\n对于 $\\omega = 0$ 的情况，我们必须计算在该点的积分：\n$$\nX(0) = \\int_{-T/2}^{T/2} \\exp(0) \\, dt = \\int_{-T/2}^{T/2} 1 \\, dt = [t]_{-T/2}^{T/2} = \\frac{T}{2} - \\left(-\\frac{T}{2}\\right) = T\n$$\n这个结果与我们通用表达式在 $\\omega \\to 0$ 时的极限是一致的，因为根据定义 $\\mathrm{sinc}(0)\\triangleq 1$，有 $\\lim_{\\omega\\to 0} X(\\omega) = \\lim_{\\omega\\to 0} T\\,\\mathrm{sinc}(\\frac{\\omega T}{2}) = T \\cdot 1 = T$。因此，表达式 $X(\\omega)$ 对所有实数 $\\omega$ 均有效。\n\n其次，我们计算时域能量 $E_t$。其定义为：\n$$\nE_{t}\\triangleq \\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt\n$$\n由于 $x(t)$ 是一个取值为 $0$ 和 $1$ 的实函数，我们有 $|x(t)|^2 = x(t)^2 = x(t)$。积分变得非常简单：\n$$\nE_{t} = \\int_{-T/2}^{T/2} 1^2\\,dt = \\int_{-T/2}^{T/2} 1\\,dt = [t]_{-T/2}^{T/2} = T\n$$\n所以，时域能量为 $E_t = T$。\n\n第三，我们按照规定通过直接积分计算频域量 $E_\\omega$。其定义为：\n$$\nE_{\\omega}\\triangleq \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n我们代入推导出的 $X(\\omega)$ 表达式。由于 $T$ 和 $\\omega$ 是实数参数，$X(\\omega)$ 是一个实值函数。因此， $|X(\\omega)|^2 = (X(\\omega))^2$。\n$$\n|X(\\omega)|^2 = \\left(T \\, \\mathrm{sinc}\\left(\\frac{\\omega T}{2}\\right)\\right)^2 = T^2 \\, \\mathrm{sinc}^2\\left(\\frac{\\omega T}{2}\\right)\n$$\n$E_\\omega$ 的积分则为：\n$$\nE_{\\omega} = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} T^2 \\, \\mathrm{sinc}^2\\left(\\frac{\\omega T}{2}\\right) \\,d\\omega = \\frac{T^2}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{sinc}^2\\left(\\frac{\\omega T}{2}\\right) \\,d\\omega\n$$\n为了计算这个积分，我们采用换元法。令 $u = \\frac{\\omega T}{2}$。可得 $d u = \\frac{T}{2} d\\omega$，所以 $d\\omega = \\frac{2}{T} du$。由于 $T  0$，$\\omega$ 的积分限 $(-\\infty, \\infty)$ 对于 $u$ 保持不变。\n$$\nE_{\\omega} = \\frac{T^2}{2\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{sinc}^2(u) \\left(\\frac{2}{T} \\, du\\right) = \\frac{T^2}{2\\pi} \\cdot \\frac{2}{T} \\int_{-\\infty}^{\\infty} \\mathrm{sinc}^2(u) \\, du = \\frac{T}{\\pi} \\int_{-\\infty}^{\\infty} \\mathrm{sinc}^2(u) \\, du\n$$\n问题允许使用标准的积分恒等式。微积分中一个著名的结果是：\n$$\n\\int_{-\\infty}^{\\infty} \\mathrm{sinc}^2(u)\\,du = \\int_{-\\infty}^{\\infty} \\left(\\frac{\\sin u}{u}\\right)^2\\,du = \\pi\n$$\n该恒等式可以通过复变函数的围道积分等方法严格证明，而无需依赖帕塞瓦尔定理。代入此值：\n$$\nE_{\\omega} = \\frac{T}{\\pi} \\cdot (\\pi) = T\n$$\n频域计算得出 $E_\\omega = T$。\n\n第四，我们报告 $E_t$ 和 $E_\\omega$ 的共同值 $E$。\n我们的计算表明 $E_t = T$ 且 $E_\\omega = T$。它们确实相等，这成功地验证了该信号的帕塞瓦尔定理。共同值 $E$ 就是 $T$。", "answer": "$$\n\\boxed{T}\n$$", "id": "2889866"}, {"introduction": "接下来，我们探讨一个在无限时间上定义的信号：单边指数衰减信号。这个例子至关重要，因为它突出强调了帕塞瓦尔定理的一个关键前提：信号必须具有有限能量，即是平方可积的（属于 $L^2(\\mathbb{R})$ 空间）。通过这个练习，你将计算一个复数值的傅里叶变换，并理解为何信号参数必须满足特定条件才能保证能量守恒等式的成立，从而加深对定理适用边界的理解 ([@problem_id:2889877])。", "problem": "设 $x(t)=\\exp(-a t)\\,u(t)$，其中 $a0$，$u(t)$ 是单位阶跃函数，定义为当 $t\\ge 0$ 时 $u(t)=1$，当 $t  0$ 时 $u(t)=0$。使用以下傅里叶变换 (FT) 定义：\n$$\nX(\\omega)=\\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-j\\omega t)\\,dt,\\qquad\nx(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega)\\,\\exp(j\\omega t)\\,d\\omega.\n$$\n任务：\n- 仅根据上述定义，计算 $x(t)$ 的傅里叶变换 $X(\\omega)$，并将其简化为闭式解。\n- 证明 $x(t)\\in L^{2}(\\mathbb{R})$（在勒贝格意义下平方可积）当且仅当 $a0$，并计算时域能量\n$$\nE_{t}=\\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt.\n$$\n- 使用你得到的 $X(\\omega)$，在相同的傅里叶变换定义下，计算频域量\n$$\nE_{\\omega}=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n请根据第一性原理和标准的实分析事实精确计算该积分。\n- 判断对于 $a0$ 是否有 $E_{t}=E_{\\omega}$，并简要解释为什么条件 $x\\in L^{2}(\\mathbb{R})$ 是使该等式有意义所必需的。\n\n$E_{t}$ 和 $E_{\\omega}$ 的共同值表示为 $a$ 的函数是什么？请用一个关于 $a$ 的单一闭式表达式给出你的最终答案。无需四舍五入，不涉及物理单位。", "solution": "所给问题是傅里叶分析中的一个标准练习，是适定的、科学上合理的，并包含了求解所需的所有信息。我们将按要求进行系统推导。\n\n第一个任务是计算信号 $x(t) = \\exp(-a t)\\,u(t)$ 的傅里叶变换 (FT)，其中 $a  0$，$u(t)$ 是亥维赛德单位阶跃函数。傅里叶变换定义如下：\n$$\nX(\\omega) = \\int_{-\\infty}^{\\infty} x(t)\\,\\exp(-j\\omega t)\\,dt\n$$\n代入 $x(t)$ 的表达式：\n$$\nX(\\omega) = \\int_{-\\infty}^{\\infty} \\exp(-a t)\\,u(t)\\,\\exp(-j\\omega t)\\,dt\n$$\n单位阶跃函数 $u(t)$ 在 $t  0$ 时为零，在 $t \\ge 0$ 时为一。该性质将积分下限从 $-\\infty$ 变为 $0$。\n$$\nX(\\omega) = \\int_{0}^{\\infty} \\exp(-a t)\\,(1)\\,\\exp(-j\\omega t)\\,dt\n$$\n合并指数项：\n$$\nX(\\omega) = \\int_{0}^{\\infty} \\exp(-(a + j\\omega)t)\\,dt\n$$\n这是一个标准的反常积分。我们计算如下：\n$$\nX(\\omega) = \\left[ \\frac{\\exp(-(a + j\\omega)t)}{-(a + j\\omega)} \\right]_{0}^{\\infty} = \\lim_{T \\to \\infty} \\left[ \\frac{\\exp(-(a + j\\omega)t)}{-(a + j\\omega)} \\right]_{0}^{T}\n$$\n$$\nX(\\omega) = \\frac{1}{-(a + j\\omega)} \\left( \\lim_{T \\to \\infty} \\exp(-(a + j\\omega)T) - \\exp(0) \\right)\n$$\n为了计算该极限，我们考察指数项的模：\n$$\n|\\exp(-(a + j\\omega)T)| = |\\exp(-aT)\\exp(-j\\omega T)| = |\\exp(-aT)| \\cdot |\\exp(-j\\omega T)| = \\exp(-aT) \\cdot 1 = \\exp(-aT)\n$$\n因为题目说明 $a  0$，当 $T \\to \\infty$ 时，项 $\\exp(-aT)$ 趋近于 $0$。因此，该极限为零。\n$$\n\\lim_{T \\to \\infty} \\exp(-(a + j\\omega)T) = 0\n$$\n将此结果代回 $X(\\omega)$ 的表达式中：\n$$\nX(\\omega) = \\frac{1}{-(a + j\\omega)} (0 - 1) = \\frac{1}{a + j\\omega}\n$$\n这就是 $x(t)$ 的傅里叶变换的闭式表达式。\n\n第二个任务是证明 $x(t)$ 是平方可积的，即 $x(t) \\in L^{2}(\\mathbb{R})$，当且仅当 $a  0$，并计算时域能量 $E_{t}$。条件 $x(t) \\in L^{2}(\\mathbb{R})$ 意味着其模的平方的积分是有限的。这个积分正是能量 $E_{t}$ 的定义。\n$$\nE_{t} = \\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt = \\int_{-\\infty}^{\\infty} |\\exp(-a t)\\,u(t)|^{2}\\,dt\n$$\n由于 $t$ 是实变量，$a$ 是正常数，且 $u(t)$ 是实数，模的平方是：\n$$\n|\\exp(-a t)\\,u(t)|^{2} = (\\exp(-a t))^{2} (u(t))^{2} = \\exp(-2a t)\\,u(t)\n$$\n最后一步成立是因为 $u(t)$ 的值是 $0$ 或 $1$，所以 $u(t)^2 = u(t)$。积分变为：\n$$\nE_{t} = \\int_{-\\infty}^{\\infty} \\exp(-2a t)\\,u(t)\\,dt = \\int_{0}^{\\infty} \\exp(-2a t)\\,dt\n$$\n该积分收敛的充要条件是指数中的系数 $-2a$ 严格为负。这要求 $2a  0$，可简化为 $a  0$。这证实了 $x(t) \\in L^{2}(\\mathbb{R})$ 当且仅当 $a  0$。\n现在我们计算 $a  0$ 时积分的值：\n$$\nE_{t} = \\left[ \\frac{\\exp(-2a t)}{-2a} \\right]_{0}^{\\infty} = \\lim_{T \\to \\infty} \\left( \\frac{\\exp(-2a T)}{-2a} \\right) - \\frac{\\exp(0)}{-2a}\n$$\n因为 $a  0$，极限项为 $0$。因此：\n$$\nE_{t} = 0 - \\frac{1}{-2a} = \\frac{1}{2a}\n$$\n这就是信号的时域能量。\n\n第三个任务是使用推导出的 $X(\\omega)$ 计算频域量 $E_{\\omega}$。\n$$\nE_{\\omega} = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n首先，我们计算 $|X(\\omega)|^{2}$。\n$$\n|X(\\omega)|^{2} = \\left| \\frac{1}{a + j\\omega} \\right|^{2} = \\frac{|1|^{2}}{|a + j\\omega|^{2}} = \\frac{1}{a^{2} + \\omega^{2}}\n$$\n现在我们将其代入 $E_{\\omega}$ 的积分中：\n$$\nE_{\\omega} = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\frac{1}{a^{2} + \\omega^{2}}\\,d\\omega\n$$\n这是实分析中的一个标准积分。$\\frac{1}{k^{2} + y^{2}}$ 关于 $y$ 的原函数是 $\\frac{1}{k}\\arctan(\\frac{y}{k})$。在我们的例子中，$y=\\omega$ 且 $k=a$。\n$$\nE_{\\omega} = \\frac{1}{2\\pi} \\left[ \\frac{1}{a} \\arctan\\left(\\frac{\\omega}{a}\\right) \\right]_{-\\infty}^{\\infty}\n$$\n我们在上下限处计算该值：\n$$\nE_{\\omega} = \\frac{1}{2\\pi a} \\left( \\lim_{\\omega \\to \\infty} \\arctan\\left(\\frac{\\omega}{a}\\right) - \\lim_{\\omega \\to -\\infty} \\arctan\\left(\\frac{\\omega}{a}\\right) \\right)\n$$\n由于 $a  0$，当 $\\omega \\to \\infty$ 时，$\\frac{\\omega}{a} \\to \\infty$；当 $\\omega \\to -\\infty$ 时，$\\frac{\\omega}{a} \\to -\\infty$。反正切函数的极限是众所周知的：\n$$\n\\lim_{z \\to \\infty} \\arctan(z) = \\frac{\\pi}{2} \\quad \\text{and} \\quad \\lim_{z \\to -\\infty} \\arctan(z) = -\\frac{\\pi}{2}\n$$\n代入这些值：\n$$\nE_{\\omega} = \\frac{1}{2\\pi a} \\left( \\frac{\\pi}{2} - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{2\\pi a} \\left( \\frac{\\pi}{2} + \\frac{\\pi}{2} \\right) = \\frac{1}{2\\pi a} (\\pi)\n$$\n$$\nE_{\\omega} = \\frac{1}{2a}\n$$\n\n最后，我们需要判断是否 $E_{t} = E_{\\omega}$ 并解释条件 $x \\in L^{2}(\\mathbb{R})$ 的必要性。\n我们的计算表明，对于 $a  0$：\n$$\nE_{t} = \\frac{1}{2a} \\quad \\text{and} \\quad E_{\\omega} = \\frac{1}{2a}\n$$\n因此，我们得出结论 $E_{t} = E_{\\omega}$。这个结果是非周期信号的帕塞瓦尔定理的一个具体体现，在给定的傅里叶变换定义下，该定理表述为：\n$$\n\\int_{-\\infty}^{\\infty} |x(t)|^{2}\\,dt = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |X(\\omega)|^{2}\\,d\\omega\n$$\n条件 $x \\in L^{2}(\\mathbb{R})$ 是基础性的。空间 $L^{2}(\\mathbb{R})$ 是有限能量信号的空间。定义能量 $E_{t}$ 的积分必须收敛，能量才是一个有意义的有限量。如果 $x(t)$ 不在 $L^{2}(\\mathbb{R})$ 中，其能量 $E_{t}$ 就是无限的。在这种情况下，等式 $E_{t} = E_{\\omega}$ 变得没有意义，因为它将等同于两个发散的积分，这不是一个有效的数学陈述。帕塞瓦尔定理是关于傅里叶变换作为希尔伯特空间 $L^{2}(\\mathbb{R})$ 上的一个酉算子（在相差一个缩放因子的情况下）的性质的陈述。它本质上说明了傅里叶变换保留了信号的范数（或能量）。这个性质仅对该空间内的信号有定义和保证。对于一个不在 $L^2(\\mathbb{R})$ 中的信号，其傅里叶变换的存在性和性质更为复杂，并且通常不符合这种能量守恒的恒等式。\n\n$E_{t}$ 和 $E_{\\omega}$ 的共同值是 $\\frac{1}{2a}$。", "answer": "$$\n\\boxed{\\frac{1}{2a}}\n$$", "id": "2889877"}, {"introduction": "最后一个练习将挑战你对傅里叶分析更深层次的理解，它旨在连接傅里叶级数（用于周期信号）和傅里叶变换（用于非周期信号）的世界。通过将非周期信号视为周期无限大的周期信号的极限情况，我们将推导出傅里叶级数的帕塞瓦尔关系如何收敛于傅里叶变换的帕塞瓦尔关系。这项实践不仅揭示了傅里叶分析理论的内在统一性，还通过一个数值计算任务，让你直观地观察到离散的频谱样本如何最终构成了连续的能量谱密度积分 ([@problem_id:2889897])。", "problem": "设 $x(t)$ 为实值、偶、绝对可积且平方可积的信号 $x(t)=e^{-a\\lvert t\\rvert}$，其中 $a0$。考虑以下基本定义。信号 $x(t)$ 的连续时间傅里叶变换 (CTFT) 为 $X(\\omega)=\\int_{-\\infty}^{\\infty} x(t)e^{-j\\omega t}\\,dt$，其逆变换为 $x(t)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} X(\\omega)e^{j\\omega t}\\,d\\omega$。CTFT 的 Parseval 关系指出 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^{2}\\,dt=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^{2}\\,d\\omega$。对于一个周期为 $T$、基波角频率为 $\\Omega_{0}=\\frac{2\\pi}{T}$ 的周期信号 $s_{T}(t)$，其傅里叶级数系数为 $c_{k}=\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T} s_{T}(t)e^{-jk\\Omega_{0} t}\\,dt$，傅里叶级数的 Parseval 关系为 $\\frac{1}{T}\\int_{t_{0}}^{t_{0}+T} \\lvert s_{T}(t)\\rvert^{2}\\,dt=\\sum_{k=-\\infty}^{\\infty} \\lvert c_{k}\\rvert^{2}$。为了连接傅里叶级数和 CTFT，定义周期求和 $s_{T}(t)=\\sum_{n\\in\\mathbb{Z}} x(t-nT)$，其傅里叶级数系数满足 $c_{k}=\\frac{1}{T}X(k\\Omega_{0})$。您必须仅使用这些定义和事实，解析地证明，当 $T\\to\\infty$ 时，由 $X(\\omega)$ 的采样点构成的傅里叶级数 Parseval 和收敛于 $x(t)=e^{-a\\lvert t\\rvert}$ 的 CTFT Parseval 积分。然后，您必须通过构造适当的黎曼和并为一组给定的参数值评估其误差，以数值方式证明这一点。\n\n任务：\n- 从 $X(\\omega)$ 的 CTFT 定义和能量的积分定义出发，推导 $X(\\omega)$ 以及信号 $x(t)=e^{-a\\lvert t\\rvert}$ 的能量 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^{2}\\,dt$ 作为 $a$ 的函数的闭式表达式。另外，计算 $\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^{2}\\,d\\omega$ 并通过解析计算验证其与时域能量相等。\n- 仅使用傅里叶级数和 CTFT 的定义，推导出一个关系，该关系用 $\\lvert X(\\omega)\\rvert^{2}$ 在网格 $\\omega=k\\Omega_{0}$（其中 $\\Omega_{0}=\\frac{2\\pi}{T}$）上的采样点来表示傅里叶级数 Parseval 和。由此论证，当 $T\\to\\infty$ 时，由这些采样点构建的频域黎曼和的极限如何恢复为 CTFT Parseval 积分。您的推导应清楚地解释为什么在极限情况下，采样步长 $\\Omega_{0}$ 充当了积分增量。\n- 实现一个程序，对于下面的每个测试用例 $(a,T,K)$，计算截断的黎曼和\n$$\nS_{T,K}=\\frac{\\Omega_{0}}{2\\pi}\\sum_{k=-K}^{K} \\left\\lvert X\\!\\left(k\\Omega_{0}\\right)\\right\\rvert^{2},\\quad \\Omega_{0}=\\frac{2\\pi}{T},\n$$\n使用您得到的 $X(\\omega)$ 的闭式表达式，并返回绝对误差\n$$\nE_{T,K}=\\left\\lvert S_{T,K}-\\int_{-\\infty}^{\\infty}\\lvert x(t)\\rvert^{2}\\,dt\\right\\rvert.\n$$\n您必须为每个测试用例计算出 $E_{T,K}$ 的实数值。\n- 您的程序不得读取任何输入。它必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例一个条目，按下列顺序排列。\n\n测试套件：\n- 用例 1：$a=1.0$， $T=40.0$， $K=500$。\n- 用例 2：$a=1.0$， $T=4.0$， $K=500$。\n- 用例 3：$a=0.2$， $T=80.0$， $K=1000$。\n- 用例 4：$a=5.0$， $T=6.0$， $K=80$。\n- 用例 5：$a=1.0$， $T=40.0$， $K=50$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含列表 $[E_{1},E_{2},E_{3},E_{4},E_{5}]$，其中 $E_{i}$ 是用例 $i$ 的 $E_{T,K}$ 值，形式为用方括号括起来的逗号分隔列表（例如，$[r_{1},r_{2},r_{3}]$，但用五个数值结果代替 $r_{i}$）。不应打印任何其他文本。\n- 不涉及物理单位。角度（若使用）以弧度为单位。\n- 每个结果必须是一个实数（浮点值）。", "solution": "问题陈述是有效的。这是一个傅里叶分析中适定的问题，需要标准的解析推导及其数值验证。所提供的定义和关系与信号处理中的既定理论一致。\n\n解决方案分三部分进行。首先，我们对信号 $x(t)=e^{-a\\lvert t\\rvert}$ 进行所需的解析推导。其次，我们按要求证明离散和收敛到连续积分。第三，我们基于这些解析结果开发数值实现。\n\n**第一部分：解析推导**\n\n设信号为 $x(t) = e^{-a|t|}$，其中实常数 $a  0$。\n\n1.  **连续时间傅里叶变换 (CTFT)**\n    CTFT $X(\\omega)$ 定义为 $X(\\omega) = \\int_{-\\infty}^{\\infty} x(t)e^{-j\\omega t}\\,dt$。\n    由于 $x(t)$ 是一个偶函数，我们可以将积分拆分为：\n    $$\n    X(\\omega) = \\int_{-\\infty}^{0} e^{at}e^{-j\\omega t}\\,dt + \\int_{0}^{\\infty} e^{-at}e^{-j\\omega t}\\,dt\n    $$\n    $$\n    X(\\omega) = \\int_{-\\infty}^{0} e^{(a-j\\omega)t}\\,dt + \\int_{0}^{\\infty} e^{-(a+j\\omega)t}\\,dt\n    $$\n    计算积分：\n    $$\n    X(\\omega) = \\left[ \\frac{e^{(a-j\\omega)t}}{a-j\\omega} \\right]_{-\\infty}^{0} + \\left[ \\frac{e^{-(a+j\\omega)t}}{-(a+j\\omega)} \\right]_{0}^{\\infty}\n    $$\n    由于 $a  0$，当 $t \\to -\\infty$ 时 $e^{at}$ 项和当 $t \\to \\infty$ 时 $e^{-at}$ 项都趋近于 $0$。\n    $$\n    X(\\omega) = \\left( \\frac{1}{a-j\\omega} - 0 \\right) + \\left( 0 - \\frac{1}{-(a+j\\omega)} \\right) = \\frac{1}{a-j\\omega} + \\frac{1}{a+j\\omega}\n    $$\n    $$\n    X(\\omega) = \\frac{(a+j\\omega) + (a-j\\omega)}{(a-j\\omega)(a+j\\omega)} = \\frac{2a}{a^2 + \\omega^2}\n    $$\n    CTFT 的闭式表达式为 $X(\\omega) = \\frac{2a}{a^2 + \\omega^2}$。\n\n2.  **时域中的信号能量**\n    信号的能量 $E_x$ 由积分 $E_x = \\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^2\\,dt$ 给出。\n    对于给定的信号，这变为：\n    $$\n    E_x = \\int_{-\\infty}^{\\infty} \\left\\lvert e^{-a|t|} \\right\\rvert^2\\,dt = \\int_{-\\infty}^{\\infty} e^{-2a|t|}\\,dt\n    $$\n    由于被积函数是偶函数：\n    $$\n    E_x = 2 \\int_{0}^{\\infty} e^{-2at}\\,dt = 2 \\left[ \\frac{e^{-2at}}{-2a} \\right]_{0}^{\\infty} = 2 \\left( 0 - \\frac{1}{-2a} \\right) = \\frac{1}{a}\n    $$\n    信号能量的闭式表达式为 $E_x = \\frac{1}{a}$。\n\n3.  **Parseval 关系的验证**\n    我们必须验证 $\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega = E_x$。\n    首先，求 $\\lvert X(\\omega)\\rvert^2$：\n    $$\n    \\lvert X(\\omega)\\rvert^2 = \\left\\lvert \\frac{2a}{a^2 + \\omega^2} \\right\\rvert^2 = \\frac{4a^2}{(a^2 + \\omega^2)^2}\n    $$\n    现在，计算该积分：\n    $$\n    \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\frac{4a^2}{(a^2 + \\omega^2)^2}\\,d\\omega = \\frac{2a^2}{\\pi} \\int_{-\\infty}^{\\infty} \\frac{1}{(a^2 + \\omega^2)^2}\\,d\\omega\n    $$\n    令 $\\omega = a\\tan\\theta$，则 $d\\omega = a\\sec^2\\theta\\,d\\theta$。积分限 $\\omega \\in (-\\infty, \\infty)$ 对应于 $\\theta \\in (-\\pi/2, \\pi/2)$。\n    $$\n    \\int_{-\\infty}^{\\infty} \\frac{1}{(a^2 + \\omega^2)^2}\\,d\\omega = \\int_{-\\pi/2}^{\\pi/2} \\frac{1}{(a^2 + a^2\\tan^2\\theta)^2} (a\\sec^2\\theta)\\,d\\theta = \\int_{-\\pi/2}^{\\pi/2} \\frac{a\\sec^2\\theta}{a^4(\\sec^2\\theta)^2}\\,d\\theta\n    $$\n    $$\n    = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\frac{1}{\\sec^2\\theta}\\,d\\theta = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\cos^2\\theta\\,d\\theta = \\frac{1}{a^3} \\int_{-\\pi/2}^{\\pi/2} \\frac{1+\\cos(2\\theta)}{2}\\,d\\theta\n    $$\n    $$\n    = \\frac{1}{2a^3} \\left[ \\theta + \\frac{\\sin(2\\theta)}{2} \\right]_{-\\pi/2}^{\\pi/2} = \\frac{1}{2a^3} \\left( \\left(\\frac{\\pi}{2} + 0\\right) - \\left(-\\frac{\\pi}{2} + 0\\right) \\right) = \\frac{\\pi}{2a^3}\n    $$\n    将此结果代回能量表达式：\n    $$\n    \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega = \\frac{2a^2}{\\pi} \\left( \\frac{\\pi}{2a^3} \\right) = \\frac{1}{a}\n    $$\n    此结果与时域能量 $E_x$ 匹配，从而验证了该信号的 Parseval 关系。\n\n**第二部分：和收敛到积分的证明**\n\n问题要求通过关联傅里叶级数 (FS) 和 CTFT 来证明和收敛到积分。\n我们从周期信号 $s_T(t) = \\sum_{n\\in\\mathbb{Z}} x(t-nT)$ 的 FS Parseval 关系开始：\n$$\n\\frac{1}{T}\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\sum_{k=-\\infty}^{\\infty} \\lvert c_k\\rvert^2\n$$\n使用提供的关于 FS 系数 $c_k$ 与 CTFT 采样点之间关系的恒等式 $c_k = \\frac{1}{T}X(k\\Omega_0)$，其中 $\\Omega_0 = 2\\pi/T$：\n$$\n\\sum_{k=-\\infty}^{\\infty} \\lvert c_k\\rvert^2 = \\sum_{k=-\\infty}^{\\infty} \\left\\lvert \\frac{1}{T} X(k\\Omega_0) \\right\\rvert^2 = \\frac{1}{T^2} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n将此代入 FS Parseval 关系：\n$$\n\\frac{1}{T}\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{1}{T^2} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n两边同乘以 $T$：\n$$\n\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{1}{T} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n现在，代入 $1/T = \\Omega_0/(2\\pi)$：\n$$\n\\int_{-T/2}^{T/2} \\lvert s_T(t)\\rvert^2\\,dt = \\frac{\\Omega_0}{2\\pi} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2\n$$\n右侧 (RHS) 是一个无限和，可作为定积分的近似。令 $\\Delta\\omega = \\Omega_0$。RHS 为 $\\sum_{k=-\\infty}^{\\infty} \\frac{1}{2\\pi}\\lvert X(k\\Delta\\omega)\\rvert^2 \\Delta\\omega$。这是函数 $f(\\omega) = \\frac{1}{2\\pi}\\lvert X(\\omega)\\rvert^2$ 在整个实轴上的积分的黎曼和。\n\n当 $T \\to \\infty$ 时，频率采样间隔 $\\Omega_0 = 2\\pi/T \\to 0$。在此极限下，黎曼和收敛于对应的定积分：\n$$\n\\lim_{T \\to \\infty} \\left( \\frac{\\Omega_0}{2\\pi} \\sum_{k=-\\infty}^{\\infty} \\lvert X(k\\Omega_0)\\rvert^2 \\right) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} \\lvert X(\\omega)\\rvert^2\\,d\\omega\n$$\n根据 CTFT Parseval 关系，该积分等于总信号能量 $\\int_{-\\infty}^{\\infty} \\lvert x(t)\\rvert^2\\,dt$。这完成了分析论证。问题陈述中的和 $S_{T,K}$ 是此黎曼和的截断版本，预期它会近似于总信号能量。\n\n**第三部分：数值方案**\n\n数值任务是计算绝对误差 $E_{T,K} = \\left\\lvert S_{T,K}-E_x\\right\\rvert$，其中 $E_x = 1/a$ 且\n$$\nS_{T,K}=\\frac{\\Omega_{0}}{2\\pi}\\sum_{k=-K}^{K} \\left\\lvert X(k\\Omega_{0})\\right\\rvert^{2}\n$$\n代入 $\\Omega_0 = 2\\pi/T$ 和 $\\lvert X(\\omega)\\rvert^2 = \\frac{4a^2}{(a^2 + \\omega^2)^2}$：\n$$\nS_{T,K} = \\frac{1}{T}\\sum_{k=-K}^{K} \\frac{4a^2}{\\left(a^2 + (k\\frac{2\\pi}{T})^2\\right)^2}\n$$\n程序将为每组给定的参数 $(a, T, K)$ 实现此公式，计算精确能量 $E_x = 1/a$，并求出绝对差值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute error between the exact energy of a signal and its\n    approximation via a truncated Riemann sum of its power spectral density.\n    \"\"\"\n    # Test suite: (a, T, K)\n    test_cases = [\n        (1.0, 40.0, 500),\n        (1.0, 4.0, 500),\n        (0.2, 80.0, 1000),\n        (5.0, 6.0, 80),\n        (1.0, 40.0, 50)\n    ]\n\n    results = []\n\n    for a, T, K in test_cases:\n        # Analytically derived exact energy of the signal x(t) = exp(-a*|t|)\n        # E_x = integral from -inf to inf of |x(t)|^2 dt = 1/a\n        exact_energy = 1.0 / a\n\n        # Fundamental angular frequency for the frequency-domain sampling\n        Omega0 = 2.0 * np.pi / T\n\n        # The term |X(omega)|^2, where X(omega) is the CTFT of x(t)\n        # |X(omega)|^2 = (2a / (a^2 + omega^2))^2 = 4a^2 / (a^2 + omega^2)^2\n        def x_spectrum_sq(omega, a_val):\n            return (4.0 * a_val**2) / (a_val**2 + omega**2)**2\n\n        # Compute the truncated Riemann sum S_T,K\n        # S_T,K = (Omega0 / (2*pi)) * sum_{k=-K to K} |X(k*Omega0)|^2\n        # Since Omega0 / (2*pi) = 1/T, this simplifies to:\n        # S_T,K = (1/T) * sum_{k=-K to K} |X(k*Omega0)|^2\n        \n        sum_val = 0.0\n        for k in range(-K, K + 1):\n            omega_k = k * Omega0\n            sum_val += x_spectrum_sq(omega_k, a)\n\n        s_tk = (1.0 / T) * sum_val\n\n        # Calculate the absolute error\n        error = np.abs(s_tk - exact_energy)\n        results.append(error)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2889897"}]}