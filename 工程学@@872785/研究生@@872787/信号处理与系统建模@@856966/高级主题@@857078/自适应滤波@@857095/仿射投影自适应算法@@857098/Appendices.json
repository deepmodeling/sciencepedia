{"hands_on_practices": [{"introduction": "仿射投影算法 (APA) 不仅仅是一个给定的公式，它源于一个明确的优化问题：在满足最新数据约束的同时，对滤波器权重进行最小的改动。本练习将引导您完成这个针对 $P=2$ 情况的基础推导，并通过一个数值计算来巩固您对概念的理解。这将揭示 APA 更新规则背后的几何直觉。[@problem_id:2850728]", "problem": "考虑一个实值单输入单输出线性有限脉冲响应系统辨识问题，其中自适应滤波器的长度为 $M$。设当前权重向量为 $\\mathbf{w}(n) \\in \\mathbb{R}^{M}$，并定义回归向量 $\\mathbf{x}(n), \\mathbf{x}(n-1) \\in \\mathbb{R}^{M}$ 及其对应的期望输出 $d(n), d(n-1) \\in \\mathbb{R}$。阶数为 $P=2$ 的仿射投影算法 (APA) 旨在寻找一个更新增量 $\\Delta \\mathbf{w}(n) \\in \\mathbb{R}^{M}$，该增量在协调最近两个误差方程的同时，对当前估计的扰动最小。最小扰动原则要求更新后的估计 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\,\\Delta \\mathbf{w}(n)$ 在欧几里得范数意义下尽可能接近 $\\mathbf{w}(n)$，同时在一个由非负正则化参数 $\\delta \\ge 0$ 和正常数步长 $\\mu > 0$ 控制的正则化意义下，将时刻 $n$ 和 $n-1$ 的一对后验方程驱动至对应的期望值。\n\n1) 从“更新增量 $\\Delta \\mathbf{w}(n)$ 在满足最近两个数据方程所隐含的仿射约束条件下应具有最小欧几里得范数”这一基本优化原则出发，构建一个正则化约束优化问题，其解可产生 $P=2$ 阶仿射投影算法 (APA) 的更新。引入拉格朗日乘子来施加这两个仿射约束，并在乘子上加入一个参数为 $\\delta$ 的 Tikhonov 正则化项，以保证数值稳定性。从第一性原理出发，推导 $\\Delta \\mathbf{w}(n)$ 的闭式表达式，该表达式应使用 $M \\times 2$ 的数据矩阵 $\\mathbf{X}(n) \\triangleq [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,]$、双样本先验误差向量 $\\mathbf{e}(n) \\triangleq \\begin{bmatrix} d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) \\\\ d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) \\end{bmatrix}$ 和正则化参数 $\\delta$ 来表示。明确展示更新增量如何是两个回归向量的线性组合，从而结合了两个误差方程中的信息。\n\n2) 对于以下数据：$M=3$，$\\mathbf{w}(n) = \\mathbf{0}_{3\\times 1}$，$\\mathbf{x}(n) = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$，$\\mathbf{x}(n-1) = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$，$d(n) = 2$，$d(n-1)=1$，步长 $\\mu = 1$，正则化参数 $\\delta = 1$，使用你推导的表达式计算更新后权重向量 $\\mathbf{w}(n+1)$ 的精确数值。将你关于 $\\mathbf{w}(n+1)$ 的最终答案表示为单个行向量。\n\n你的最终答案必须是作为行矩阵的单个更新后权重向量。不需要四舍五入，也不涉及任何单位。", "solution": "所述问题具有科学依据、适定且客观。这是自适应信号处理中的一个标准问题，需要推导和应用仿射投影算法 (APA)。所提供的参数是一致的，并且足以求得唯一解。因此，该问题是有效的，我将着手进行解答。\n\n该问题分为两部分。第一部分要求推导阶数为 $P=2$ 的仿射投影算法的更新增量 $\\Delta \\mathbf{w}(n)$。第二部分要求针对一组特定数据，对更新后的权重向量 $\\mathbf{w}(n+1)$ 进行数值计算。\n\n第 1 部分：APA 更新增量的推导\n\nAPA 的核心原则是找到一个更新后的权重向量 $\\mathbf{w}(n+1)$，它与当前向量 $\\mathbf{w}(n)$ 的差异最小，同时满足一组约束条件。更新由 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)$ 给出，其中 $\\mu > 0$ 是步长，$\\Delta\\mathbf{w}(n)$ 是更新增量。最小化扰动意味着最小化权重向量变化的欧几里得范数，即 $\\|\\mathbf{w}(n+1) - \\mathbf{w}(n)\\|^2 = \\|\\mu \\Delta\\mathbf{w}(n)\\|^2$。由于 $\\mu$ 是一个正常数，这等价于最小化 $\\|\\Delta\\mathbf{w}(n)\\|^2$。\n\n约束条件是更新后的滤波器应满足最近两个期望输出关系。即，对于时刻 $n$ 和 $n-1$：\n$$ \\mathbf{x}^{\\top}(n)\\mathbf{w}(n+1) = d(n) $$\n$$ \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n+1) = d(n-1) $$\n代入 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)$，我们可以用更新增量 $\\Delta\\mathbf{w}(n)$ 来表示这些约束：\n$$ \\mathbf{x}^{\\top}(n)(\\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)) = d(n) \\implies \\mu \\mathbf{x}^{\\top}(n) \\Delta\\mathbf{w}(n) = d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) $$\n$$ \\mathbf{x}^{\\top}(n-1)(\\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n)) = d(n-1) \\implies \\mu \\mathbf{x}^{\\top}(n-1) \\Delta\\mathbf{w}(n) = d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) $$\n使用为数据矩阵 $\\mathbf{X}(n) \\triangleq [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,]$ 和先验误差向量 $\\mathbf{e}(n) \\triangleq \\begin{bmatrix} d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) \\\\ d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) \\end{bmatrix}$ 提供的定义，这两个标量约束可以紧凑地写成一个单一的向量方程：\n$$ \\mu \\mathbf{X}(n)^{\\top} \\Delta\\mathbf{w}(n) = \\mathbf{e}(n) $$\n因此，优化问题是在线性约束 $\\mu \\mathbf{X}(n)^{\\top} \\Delta\\mathbf{w}(n) = \\mathbf{e}(n)$ 下，找到使成本函数 $J(\\Delta\\mathbf{w}(n)) = \\frac{1}{2}\\|\\Delta\\mathbf{w}(n)\\|^2$ 最小的 $\\Delta\\mathbf{w}(n)$。包含因子 $\\frac{1}{2}$ 是为了代数计算上的方便。\n\n我们使用拉格朗日乘子法来解决这个约束优化问题。我们引入一个拉格朗日乘子向量 $\\boldsymbol{\\lambda} \\in \\mathbb{R}^2$ 并构造拉格朗日函数：\n$$ L(\\Delta\\mathbf{w}(n), \\boldsymbol{\\lambda}) = \\frac{1}{2} \\Delta\\mathbf{w}(n)^{\\top}\\Delta\\mathbf{w}(n) + \\boldsymbol{\\lambda}^{\\top}(\\mathbf{e}(n) - \\mu \\mathbf{X}(n)^{\\top}\\Delta\\mathbf{w}(n)) $$\n为了找到最小值，我们首先通过将 $L$ 对 $\\Delta\\mathbf{w}(n)$ 的梯度设为零来找到其驻点：\n$$ \\nabla_{\\Delta\\mathbf{w}(n)} L = \\Delta\\mathbf{w}(n) - \\mu \\mathbf{X}(n)\\boldsymbol{\\lambda} = \\mathbf{0} $$\n这给出了最优更新增量的结构：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n这个方程表明，更新增量 $\\Delta\\mathbf{w}(n)$ 是回归向量 $\\mathbf{x}(n)$ 和 $\\mathbf{x}(n-1)$（即 $\\mathbf{X}(n)$ 的列）的线性组合。\n\n问题陈述了应在乘子上引入正则化。这可以通过对偶问题正则化来实现。将 $\\Delta\\mathbf{w}(n)$ 的表达式代回拉格朗日函数，得到对偶目标函数 $L_D(\\boldsymbol{\\lambda})$：\n$$ L_D(\\boldsymbol{\\lambda}) = \\frac{1}{2}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda})^{\\top}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda}) + \\boldsymbol{\\lambda}^{\\top}(\\mathbf{e}(n) - \\mu \\mathbf{X}(n)^{\\top}(\\mu \\mathbf{X}(n)\\boldsymbol{\\lambda})) $$\n$$ L_D(\\boldsymbol{\\lambda}) = \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} + \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\mu^2 \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n$$ L_D(\\boldsymbol{\\lambda}) = \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} $$\n最大化此对偶函数可得出拉格朗日乘子。为按要求在乘子上引入 Tikhonov 正则化，我们从对偶目标中减去一个二次惩罚项 $\\frac{\\delta}{2}\\|\\boldsymbol{\\lambda}\\|^2$，其中 $\\delta \\ge 0$ 是正则化参数。正则化的对偶目标是：\n$$ L_{D,reg}(\\boldsymbol{\\lambda}) = \\boldsymbol{\\lambda}^{\\top}\\mathbf{e}(n) - \\frac{\\mu^2}{2} \\boldsymbol{\\lambda}^{\\top}\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} - \\frac{\\delta}{2} \\boldsymbol{\\lambda}^{\\top}\\boldsymbol{\\lambda} $$\n为了最大化 $L_{D,reg}(\\boldsymbol{\\lambda})$，我们将其关于 $\\boldsymbol{\\lambda}$ 的梯度设为零：\n$$ \\nabla_{\\boldsymbol{\\lambda}} L_{D,reg} = \\mathbf{e}(n) - \\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n)\\boldsymbol{\\lambda} - \\delta \\boldsymbol{\\lambda} = \\mathbf{0} $$\n重新整理以求解 $\\boldsymbol{\\lambda}$：\n$$ (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I}) \\boldsymbol{\\lambda} = \\mathbf{e}(n) $$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 的单位矩阵。对于 $\\delta > 0$，矩阵 $(\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})$ 保证是正定的，因此是可逆的。拉格朗日乘子是：\n$$ \\boldsymbol{\\lambda} = (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n最后，我们将 $\\boldsymbol{\\lambda}$ 的这个表达式代回 $\\Delta\\mathbf{w}(n)$ 的方程中：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n) (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n这就是更新增量的闭式表达式，表明了它是 $\\mathbf{X}(n)$ 的列的线性组合。\n\n第 2 部分：数值计算\n\n我们有以下给定数据：\n- 滤波器长度 $M=3$。\n- 初始权重 $\\mathbf{w}(n) = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n- 回归向量 $\\mathbf{x}(n) = \\begin{bmatrix} 1 \\\\ 0 \\\\ 1 \\end{bmatrix}$ 和 $\\mathbf{x}(n-1) = \\begin{bmatrix} 0 \\\\ 1 \\\\ 1 \\end{bmatrix}$。\n- 期望输出 $d(n) = 2$ 和 $d(n-1)=1$。\n- 步长 $\\mu = 1$。\n- 正则化参数 $\\delta = 1$。\n\n首先，我们构造数据矩阵 $\\mathbf{X}(n)$ 和先验误差向量 $\\mathbf{e}(n)$。\n$$ \\mathbf{X}(n) = [\\,\\mathbf{x}(n)\\ \\ \\mathbf{x}(n-1)\\,] = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} $$\n先验误差向量的分量是：\n$$ e(n) = d(n) - \\mathbf{x}^{\\top}(n)\\mathbf{w}(n) = 2 - \\begin{bmatrix} 1  0  1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = 2 $$\n$$ e(n-1) = d(n-1) - \\mathbf{x}^{\\top}(n-1)\\mathbf{w}(n) = 1 - \\begin{bmatrix} 0  1  1 \\end{bmatrix}\\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = 1 $$\n所以，误差向量是 $\\mathbf{e}(n) = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n\n接下来，我们计算矩阵乘积 $\\mathbf{X}(n)^{\\top}\\mathbf{X}(n)$：\n$$ \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(0)+(1)(1)  (1)(0)+(0)(1)+(1)(1) \\\\ (0)(1)+(1)(0)+(1)(1)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $$\n现在我们利用 $\\mu=1$ 和 $\\delta=1$ 构造待求逆的矩阵：\n$$ \\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I} = (1)^2 \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} + (1) \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} + \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} 3  1 \\\\ 1  3 \\end{bmatrix} $$\n这个 $2 \\times 2$ 矩阵的逆是：\n$$ \\left(\\begin{bmatrix} 3  1 \\\\ 1  3 \\end{bmatrix}\\right)^{-1} = \\frac{1}{(3)(3)-(1)(1)} \\begin{bmatrix} 3  -1 \\\\ -1  3 \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 3  -1 \\\\ -1  3 \\end{bmatrix} $$\n现在我们可以计算更新增量 $\\Delta\\mathbf{w}(n)$：\n$$ \\Delta\\mathbf{w}(n) = \\mu \\mathbf{X}(n) (\\mu^2 \\mathbf{X}(n)^{\\top}\\mathbf{X}(n) + \\delta \\mathbf{I})^{-1} \\mathbf{e}(n) $$\n$$ \\Delta\\mathbf{w}(n) = (1) \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\left( \\frac{1}{8} \\begin{bmatrix} 3  -1 \\\\ -1  3 \\end{bmatrix} \\right) \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} $$\n$$ \\Delta\\mathbf{w}(n) = \\frac{1}{8} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} (3)(2)+(-1)(1) \\\\ (-1)(2)+(3)(1) \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} 5 \\\\ 1 \\end{bmatrix} $$\n$$ \\Delta\\mathbf{w}(n) = \\frac{1}{8} \\begin{bmatrix} (1)(5)+(0)(1) \\\\ (0)(5)+(1)(1) \\\\ (1)(5)+(1)(1) \\end{bmatrix} = \\frac{1}{8} \\begin{bmatrix} 5 \\\\ 1 \\\\ 6 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 6/8 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} $$\n最后，我们计算更新后的权重向量 $\\mathbf{w}(n+1)$：\n$$ \\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\Delta\\mathbf{w}(n) = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix} + (1) \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} = \\begin{bmatrix} 5/8 \\\\ 1/8 \\\\ 3/4 \\end{bmatrix} $$\n最终答案要求以单个行向量的形式给出。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{5}{8}  \\frac{1}{8}  \\frac{3}{4} \\end{pmatrix} } $$", "id": "2850728"}, {"introduction": "从数学公式到实际的有限精度计算，我们需要考虑数值稳定性。直接计算格拉姆矩阵 $\\mathbf{X}(n)^{\\top} \\mathbf{X}(n)$ 的方法虽然直观，但在数值上可能不稳定，尤其是在输入信号相关时。本练习探讨了一种更优越的实现方法，它利用 QR 分解来安全高效地执行 APA 更新，这是稳健数值线性代数中的一个基石。[@problem_id:2850737]", "problem": "考虑一个长度为 $M$、投影阶数为 $P$ 的仿射投影算法 (APA) 自适应滤波器，该滤波器使用最近的 $P$ 个输入回归量来更新权重向量 $\\mathbf{w}(n) \\in \\mathbb{R}^{M}$。在每次迭代中，更新的直接形式需要求解一个维度为 $P$ 的对称正定线性系统，其系数矩阵由最近的输入回归量的内积以及一个用于正则化的小对角加载构成，其右端项是 $P$ 个先验误差组成的向量。您需要选择一种实现方式，该方式避免计算任何显式矩阵逆，并利用正交三角 (QR) 分解来增强数值鲁棒性。\n\n仅从以下基本原理出发：\n- 对于一个高矩阵 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$，$m \\ge n$，其最小二乘法方程为 $\\mathbf{A}^{\\top} \\mathbf{A} \\mathbf{x} = \\mathbf{A}^{\\top} \\mathbf{b}$，并且构建 $\\mathbf{A}^{\\top} \\mathbf{A}$ 会使 $\\mathbf{A}$ 的条件数平方。\n- 一个高矩阵 $\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$，$m \\ge n$ 的瘦 QR 分解写作 $\\mathbf{B} = \\mathbf{Q} \\mathbf{R}$，其中 $\\mathbf{Q} \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，$\\mathbf{R} \\in \\mathbb{R}^{n \\times n}$ 是上三角矩阵，并且满足 $\\mathbf{B}^{\\top} \\mathbf{B} = \\mathbf{R}^{\\top} \\mathbf{R}$。\n- 通过回代求解一个大小为 $P$ 的三角系统需要大约 $\\mathcal{O}(P^{2})$ 次运算，而对一个 $m \\times n$（其中 $m \\ge n$）的矩阵进行 Householder QR 分解大约需要 $2 m n^{2} - \\tfrac{2}{3} n^{3}$ 次浮点运算。\n\n哪个选项最佳地描述了一种基于 QR 的 APA 每次迭代的实现方式，该方式避免了显式矩阵求逆，并说明了其主要的数值优势和计算成本？\n\nA. 构建 $M \\times P$ 的回归量矩阵 $\\mathbf{X}(n)$ 和 $P \\times 1$ 的先验误差向量 $\\mathbf{e}(n)$。用一个小的对角加载 $\\epsilon > 0$ 构成 $(M+P) \\times P$ 的增广矩阵 $\\mathbf{B}(n) \\triangleq \\begin{bmatrix} \\mathbf{X}(n) \\\\ \\sqrt{\\epsilon} \\mathbf{I}_{P} \\end{bmatrix}$。使用正交变换（例如 Householder 反射或 Givens 旋转）计算瘦 QR 分解 $\\mathbf{B}(n) = \\mathbf{Q}(n) \\mathbf{R}(n)$，使得 $\\mathbf{R}(n)^{\\top} \\mathbf{R}(n) = \\mathbf{B}(n)^{\\top} \\mathbf{B}(n) = \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}$。求解两个三角系统 $\\mathbf{R}(n)^{\\top} \\mathbf{z}(n) = \\mathbf{e}(n)$ 和 $\\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{z}(n)$，然后用步长 $\\mu \\in (0,1]$ 更新 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\mathbf{X}(n) \\mathbf{g}(n)$。每次迭代从头计算的成本大约为 QR 分解的 $2 (M+P) P^{2} - \\tfrac{2}{3} P^{3}$，加上三角求解的 $\\mathcal{O}(P^{2})$ 和投影的 $\\mathcal{O}(M P)$，即 $\\mathcal{O}(M P^{2} + P^{3})$，但通过 Givens 旋转进行滑动窗口 QR 更新/降级，摊销成本可以降低到 $\\mathcal{O}(M P)$。优点：没有显式求逆，没有显式构造 $\\mathbf{X}(n)^{\\top} \\mathbf{X}(n)$，在共线性下具有更好的数值稳定性，并通过正则化优雅地处理近秩亏的情况；权衡：比朴素方法的常数项更高，且需要为 $\\mathbf{R}(n)$ 和更新算子提供额外存储。\n\nB. 在每次迭代中，构造 $P \\times P$ 的格拉姆矩阵 $\\mathbf{G}(n) \\triangleq \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}$，计算其特征值分解 $\\mathbf{G}(n) = \\mathbf{U}(n) \\boldsymbol{\\Lambda}(n) \\mathbf{U}(n)^{\\top}$，然后设置 $\\mathbf{g}(n) = \\mathbf{U}(n) \\boldsymbol{\\Lambda}(n)^{-1} \\mathbf{U}(n)^{\\top} \\mathbf{e}(n)$ 以避免显式求逆。这种方法与 QR 一样稳定，但每次迭代的成本更低，因为对角矩阵求逆占主导地位且成本仅为 $\\mathcal{O}(P)$；每次迭代的总成本为 $\\mathcal{O}(P^{2})$，与 $M$ 无关。\n\nC. 构造 $P \\times P$ 的格拉姆矩阵 $\\mathbf{G}(n) \\triangleq \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}$ 并计算其 Cholesky 分解 $\\mathbf{G}(n) = \\mathbf{L}(n) \\mathbf{L}(n)^{\\top}$。通过对 $\\mathbf{L}(n)$ 求逆来计算显式逆 $\\mathbf{G}(n)^{-1}$，然后计算 $\\mathbf{g}(n) = \\mathbf{G}(n)^{-1} \\mathbf{e}(n)$。这样每次迭代的复杂度为 $\\mathcal{O}(P^{2})$，因为三角矩阵求逆成本低廉，并且在数值上等同于 QR，而没有正交变换的开销。\n\nD. 维护一个瘦 QR 分解 $\\mathbf{X}(n) = \\tilde{\\mathbf{Q}}(n) \\tilde{\\mathbf{R}}(n)$，并在每次迭代中，通过附加最新的列并移除最旧的列（使用 Givens 旋转）来更新 $\\tilde{\\mathbf{R}}(n)$。然后通过单次回代求解 $\\tilde{\\mathbf{R}}(n) \\mathbf{g}(n) = \\mathbf{e}(n)$ 并更新 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\mathbf{X}(n) \\mathbf{g}(n)$。如果维护了 QR 分解，则正则化是不必要的，由于三角求解，每次迭代的成本为 $\\mathcal{O}(P^{2})$，与 $M$ 无关。", "solution": "题目要求分析一种仿射投影算法 (APA) 的数值鲁棒、基于 QR 且避免显式矩阵求逆的实现。我将首先验证问题陈述，然后在假设其有效的情况下，从提供的基本原理出发推导出正确的方法，并评估每个选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **算法**：仿射投影算法 (APA) 自适应滤波器。\n- **滤波器长度**：$M$。\n- **投影阶数**：$P$。\n- **权重向量**：$\\mathbf{w}(n) \\in \\mathbb{R}^{M}$。\n- **更新规则**：基于求解一个 $P$ 维对称正定线性系统。\n- **系统矩阵**：由最近的 $P$ 个输入回归量的内积加上一个用于正则化的小对角加载构成。\n- **系统右端项**：$P$ 个先验误差组成的向量。\n- **约束**：避免显式矩阵求逆；使用 QR 分解以保证鲁棒性。\n- **已知原理 1**：对于一个高矩阵 $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$ ($m \\ge n$)，其最小二乘法方程为 $\\mathbf{A}^{\\top} \\mathbf{A} \\mathbf{x} = \\mathbf{A}^{\\top} \\mathbf{b}$。构建 $\\mathbf{A}^{\\top} \\mathbf{A}$ 会使 $\\mathbf{A}$ 的条件数平方。\n- **已知原理 2**：一个高矩阵 $\\mathbf{B} \\in \\mathbb{R}^{m \\times n}$ ($m \\ge n$) 的瘦 QR 分解为 $\\mathbf{B} = \\mathbf{Q} \\mathbf{R}$，其中 $\\mathbf{Q} \\in \\mathbb{R}^{m \\times n}$ 具有标准正交列，$\\mathbf{R} \\in \\mathbb{R}^{n \\times n}$ 是上三角矩阵。这蕴含了 $\\mathbf{B}^{\\top} \\mathbf{B} = \\mathbf{R}^{\\top} \\mathbf{R}$。\n- **已知原理 3**：求解一个大小为 $P$ 的三角系统需要 $\\mathcal{O}(P^{2})$ 次运算。\n- **已知原理 4**：对于一个 $m \\times n$ 的矩阵，当 $m \\ge n$ 时，Householder QR 分解的成本大约为 $2 m n^{2} - \\tfrac{2}{3} n^{3}$ 次浮点运算。\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的、适定的和客观的。它描述了自适应信号处理领域中的一个标准问题：正则化 APA 的实现。所给条件是数值线性代数中的标准定义和结果。任务是应用这些原理来从选项中确定正确的实现策略。问题设置中没有矛盾、歧义或事实错误。上下文纯粹是科学性的且可形式化的。\n\n**步骤 3：结论与行动**\n该问题是**有效的**。我将继续进行解决方案的推导。\n\n### 基于 QR 的 APA 实现的推导\n\nAPA 权重更新由 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\mathbf{X}(n) \\mathbf{g}(n)$ 给出，其中 $\\mathbf{X}(n) \\in \\mathbb{R}^{M \\times P}$ 是最近 $P$ 个输入回归量组成的矩阵。向量 $\\mathbf{g}(n) \\in \\mathbb{R}^{P}$ 是正则化法方程的解：\n$$ (\\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}) \\mathbf{g}(n) = \\mathbf{e}(n) $$\n其中 $\\mathbf{e}(n) \\in \\mathbb{R}^{P}$ 是先验误差向量，$\\epsilon > 0$ 是正则化参数，$\\mathbf{I}_{P}$ 是 $P \\times P$ 的单位矩阵。\n\n主要目标是在不显式构造矩阵 $\\mathbf{X}(n)^{\\top} \\mathbf{X}(n)$ 的情况下求解该系统的 $\\mathbf{g}(n)$，因为该操作会使条件数平方，导致潜在的数值不稳定性（如原理 1 所述）。我们必须使用基于 QR 的方法。\n\n让我们构造一个增广矩阵 $\\mathbf{B}(n)$，使其格拉姆矩阵 $\\mathbf{B}(n)^{\\top} \\mathbf{B}(n)$ 正好是我们线性系统的系数矩阵。考虑 $(M+P) \\times P$ 矩阵：\n$$ \\mathbf{B}(n) = \\begin{bmatrix} \\mathbf{X}(n) \\\\ \\sqrt{\\epsilon} \\mathbf{I}_{P} \\end{bmatrix} $$\n计算其格拉姆矩阵得到：\n$$ \\mathbf{B}(n)^{\\top} \\mathbf{B}(n) = \\begin{bmatrix} \\mathbf{X}(n)^{\\top}  \\sqrt{\\epsilon} \\mathbf{I}_{P} \\end{bmatrix} \\begin{bmatrix} \\mathbf{X}(n) \\\\ \\sqrt{\\epsilon} \\mathbf{I}_{P} \\end{bmatrix} = \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + (\\sqrt{\\epsilon} \\mathbf{I}_{P})(\\sqrt{\\epsilon} \\mathbf{I}_{P}) = \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P} $$\n这成功地将我们的问题映射到法方程的结构上，而无需显式构造该乘积。原始系统现在可以写成：\n$$ \\mathbf{B}(n)^{\\top} \\mathbf{B}(n) \\mathbf{g}(n) = \\mathbf{e}(n) $$\n为了使用 QR 分解（原理 2）来求解，我们计算 $\\mathbf{B}(n)$ 的瘦 QR 分解：\n$$ \\mathbf{B}(n) = \\mathbf{Q}(n) \\mathbf{R}(n) $$\n其中 $\\mathbf{Q}(n)$ 是一个 $(M+P) \\times P$ 的矩阵，其列是标准正交的（$\\mathbf{Q}(n)^{\\top} \\mathbf{Q}(n) = \\mathbf{I}_{P}$），$\\mathbf{R}(n)$ 是一个 $P \\times P$ 的上三角矩阵。\n\n将此代入我们的系统：\n$$ (\\mathbf{Q}(n) \\mathbf{R}(n))^{\\top} (\\mathbf{Q}(n) \\mathbf{R}(n)) \\mathbf{g}(n) = \\mathbf{e}(n) $$\n$$ \\mathbf{R}(n)^{\\top} \\mathbf{Q}(n)^{\\top} \\mathbf{Q}(n) \\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{e}(n) $$\n$$ \\mathbf{R}(n)^{\\top} \\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{e}(n) $$\n该系统可以通过使用涉及三角求解的两步过程高效求解，而无需任何矩阵求逆：\n1. 定义一个中间向量 $\\mathbf{z}(n) = \\mathbf{R}(n) \\mathbf{g}(n)$。系统变为 $\\mathbf{R}(n)^{\\top} \\mathbf{z}(n) = \\mathbf{e}(n)$。由于 $\\mathbf{R}(n)^{\\top}$ 是下三角矩阵，我们可以使用前向代入法求解 $\\mathbf{z}(n)$。\n2. 在已知 $\\mathbf{z}(n)$ 的情况下，我们求解 $\\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{z}(n)$ 以得到 $\\mathbf{g}(n)$。由于 $\\mathbf{R}(n)$ 是上三角矩阵，我们可以使用回代法。\n\n此过程的计算成本主要由 $(M+P) \\times P$ 矩阵 $\\mathbf{B}(n)$ 的 QR 分解决定。使用所提供的公式（原理 4），令 $m = M+P$ 和 $n = P$，成本大约为 $2(M+P)P^2 - \\frac{2}{3}P^3$，其数量级为 $\\mathcal{O}(MP^2 + P^3)$。两个三角求解各需要 $\\mathcal{O}(P^2)$ 次运算（原理 3）。最终的权重更新 $\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu \\mathbf{X}(n) \\mathbf{g}(n)$ 涉及一个矩阵-向量乘法，成本为 $\\mathcal{O}(MP)$。因此，如果每次迭代都从头计算，总成本为 $\\mathcal{O}(MP^2 + P^3)$。对于滑动窗口回归量矩阵 $\\mathbf{X}(n)$，QR 分解的高效更新/降级过程（例如，使用 Givens 旋转）可以将摊销成本降低到 $\\mathcal{O}(MP)$。\n\n### 选项评估\n\n**选项 A：**\n该选项描述了上面推导的精确过程。它正确地构造了增广矩阵 $\\mathbf{B}(n) = \\begin{bmatrix} \\mathbf{X}(n) \\\\ \\sqrt{\\epsilon} \\mathbf{I}_{P} \\end{bmatrix}$，计算其瘦 QR 分解 $\\mathbf{B}(n) = \\mathbf{Q}(n) \\mathbf{R}(n)$，并通过两步三角求解来求解系统 $\\mathbf{R}(n)^{\\top} \\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{e}(n)$：首先是 $\\mathbf{R}(n)^{\\top} \\mathbf{z}(n) = \\mathbf{e}(n)$，然后是 $\\mathbf{R}(n) \\mathbf{g}(n) = \\mathbf{z}(n)$。其对数值优势（避免显式求逆和格拉姆矩阵构造，提高稳定性）的分析是正确的。其计算成本分析，无论是从头计算的版本（$\\mathcal{O}(M P^{2} + P^{3})$）还是快速更新的版本（$\\mathcal{O}(M P)$），也都是正确的。其权衡取舍也陈述得很准确。\n**结论：正确**\n\n**选项 B：**\n此选项建议显式构造格拉姆矩阵 $\\mathbf{G}(n) = \\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}$。这与避免条件数平方这个数值上有问题的操作的目标相矛盾。它使用了特征值分解 (EVD) 而不是要求的 QR 分解。成本分析不正确：构造 $\\mathbf{G}(n)$ 的成本为 $\\mathcal{O}(MP^2)$，因此总成本并非与 $M$ 无关。一个 $P \\times P$ 矩阵的 EVD 成本为 $\\mathcal{O}(P^3)$，而非 $\\mathcal{O}(P^2)$。\n**结论：不正确**\n\n**选项 C：**\n此选项也建议显式构造格拉姆矩阵 $\\mathbf{G}(n)$，这是不可取的。它建议使用 Cholesky 分解，而非 QR 分解。最重要的是，它建议“计算显式逆 $\\mathbf{G}(n)^{-1}$”，这直接违反了问题的核心约束。此外，其声称“在数值上等同于 QR”是错误的；对数据矩阵 $\\mathbf{B}(n)$ 进行 QR 分解比对格拉姆矩阵 $\\mathbf{B}(n)^{\\top}\\mathbf{B}(n)$ 进行 Cholesky 分解更稳定。其复杂度也错误地表述为 $\\mathcal{O}(P^2)$，忽略了构造 $\\mathbf{G}(n)$ 所需的 $\\mathcal{O}(MP^2)$ 成本。\n**结论：不正确**\n\n**选项 D：**\n此选项正确地建议维护 $\\mathbf{X}(n)$ 的 QR 分解并使用快速更新。然而，它在构建待解系统时犯了一个关键错误。它声称系统是 $\\tilde{\\mathbf{R}}(n) \\mathbf{g}(n) = \\mathbf{e}(n)$，但从 $(\\mathbf{X}(n)^{\\top} \\mathbf{X}(n) + \\epsilon \\mathbf{I}_{P}) \\mathbf{g}(n) = \\mathbf{e}(n)$ 推导出的正确系统是 $(\\tilde{\\mathbf{R}}(n)^{\\top} \\tilde{\\mathbf{R}}(n) + \\epsilon \\mathbf{I}_{P}) \\mathbf{g}(n) = \\mathbf{e}(n)$。选项 D 在求解步骤中完全忽略了正则化项 $\\epsilon \\mathbf{I}_P$，并作出了“如果维护了 QR，则正则化是不必要的”的错误断言。正则化对于处理回归量中的共线性至关重要，QR 分解可以诊断出这个问题，但如果不修改问题本身，它并不能解决这个问题。其复杂度分析也有缺陷；更新成本为 $\\mathcal{O}(MP)$，而不是与 $M$ 无关的成本。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "2850737"}, {"introduction": "在理解了如何推导和实现算法之后，关键的下一步是分析其性能。本练习着重于在理想的白噪声输入条件下，推导稳态超量均方误差 (EMSE)，这会揭示一个关于投影阶数 $P$ 影响的重要（甚至可能出乎意料）的特性。这有助于我们理解算法在不同条件下的理论极限。[@problem_id:2850820]", "problem": "考虑辨识一个由零均值白噪声输入驱动的长度为 $M$ 的线性时不变系统。期望响应由以下模型给出\n$$\nd(n) \\;=\\; \\mathbf{x}^{\\top}(n)\\,\\mathbf{w}_{o} \\;+\\; v(n),\n$$\n其中 $\\mathbf{x}(n)\\in\\mathbb{R}^{M}$ 是零均值白噪声输入，其协方差为 $\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\}=\\sigma_{x}^{2}\\mathbf{I}_{M}$，$\\mathbf{w}_{o}\\in\\mathbb{R}^{M}$ 是未知参数向量，而 $v(n)$ 是方差为 $\\sigma_{v}^{2}$ 的零均值白噪声扰动，且独立于 $\\mathbf{x}(n)$。\n\n使用一个阶数为 $P$ 的仿射投影算法（APA）（无对角加载）来更新估计值 $\\mathbf{w}(n)$。定义 $M\\times P$ 的回归矩阵和 $P\\times 1$ 的期望响应矢量\n$$\n\\mathbf{X}(n) \\;=\\; \\big[\\mathbf{x}(n),\\,\\mathbf{x}(n-1),\\,\\ldots,\\,\\mathbf{x}(n-P+1)\\big],\\qquad\n\\mathbf{d}(n) \\;=\\; \\big[d(n),\\,d(n-1),\\,\\ldots,\\,d(n-P+1)\\big]^{\\top},\n$$\n以及 $P\\times 1$ 的先验误差矢量\n$$\n\\mathbf{e}(n) \\;=\\; \\mathbf{d}(n) \\;-\\; \\mathbf{X}^{\\top}(n)\\,\\mathbf{w}(n).\n$$\nAPA 的更新方程为\n$$\n\\mathbf{w}(n+1) \\;=\\; \\mathbf{w}(n) \\;+\\; \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{e}(n),\n$$\n其中 $\\mu\\in(0,2)$ 是一个恒定的步长，并假设 $P\\leq M$，因此对于白噪声输入，$\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 几乎必然可逆。将稳态超量均方误差（EMSE）定义为\n$$\n\\mathrm{EMSE} \\;\\triangleq\\; \\mathbb{E}\\big\\{\\big(\\mathbf{x}^{\\top}(n)\\big(\\mathbf{w}_{o}-\\mathbf{w}(n)\\big)\\big)^{2}\\big\\}.\n$$\n\n从更新方程的定义、$\\mathbf{x}(n)$ 的白噪声特性以及自适应滤波器稳态分析中使用的标准独立性假设出发，推导稳态EMSE作为 $\\mu$ 和 $\\sigma_{v}^{2}$ 的函数的闭式表达式，该表达式适用于任意投影阶数 $P$。然后，将您的表达式具体化到 $P\\in\\{1,2,4\\}$ 的情况，并按此顺序报告这三个EMSE值。\n\n您必须：\n- 从给定的定义和白噪声输入模型出发；不要在没有推导的情况下直接引用目标结果。\n- 对您使用的任何近似进行论证，包括对随机矩阵使用期望。\n- 明确说明在所述假设下，稳态EMSE是否依赖于 $P$，并解释原因。\n\n将您的最终答案表示为三个（分别对应 $P=1,2,4$）仅包含 $\\mu$ 和 $\\sigma_{v}^{2}$ 的闭式解析表达式。不需要进行数值计算。", "solution": "对问题陈述的科学有效性、完整性和客观性进行审视。\n\n**步骤1：提取已知条件**\n- 系统模型：$d(n) = \\mathbf{x}^{\\top}(n)\\mathbf{w}_{o} + v(n)$。\n- 输入矢量：$\\mathbf{x}(n) \\in \\mathbb{R}^{M}$ 是一个零均值白噪声矢量过程。\n- 输入协方差：$\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\} = \\sigma_{x}^{2}\\mathbf{I}_{M}$。\n- 未知系统矢量：$\\mathbf{w}_{o} \\in \\mathbb{R}^{M}$。\n- 扰动：$v(n)$ 是一个零均值白噪声过程，方差为 $\\sigma_{v}^{2}$，独立于 $\\mathbf{x}(n)$。\n- APA投影阶数：$P$。\n- 回归矩阵：$\\mathbf{X}(n) = [\\mathbf{x}(n), \\mathbf{x}(n-1), \\ldots, \\mathbf{x}(n-P+1)]$。\n- 期望响应矢量：$\\mathbf{d}(n) = [d(n), d(n-1), \\ldots, d(n-P+1)]^{\\top}$。\n- 先验误差矢量：$\\mathbf{e}(n) = \\mathbf{d}(n) - \\mathbf{X}^{\\top}(n)\\mathbf{w}(n)$。\n- APA更新方程：$\\mathbf{w}(n+1) = \\mathbf{w}(n) + \\mu\\,\\mathbf{X}(n)(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}\\mathbf{e}(n)$。\n- 步长：$\\mu \\in (0,2)$。\n- 可逆性条件：$P \\le M$，且 $\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 可逆。\n- EMSE定义：$\\mathrm{EMSE} \\triangleq \\mathbb{E}\\{(\\mathbf{x}^{\\top}(n)(\\mathbf{w}_{o}-\\mathbf{w}(n)))^{2}\\}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是自适应滤波器分析中的一个标准练习，具体涉及仿射投影算法（APA）。所有定义和模型均源于信号处理领域的既定理论。\n- **适定性：** 该问题提供了推导特定量（EMSE）所需的所有必要定义和统计特性。它要求一个唯一的解析表达式。\n- **客观性：** 该问题以精确的数学语言陈述，没有主观或模糊的术语。\n- **结论：** 问题陈述是有效的。它是自洽的、科学合理的且适定的。可以进行严格的推导。\n\n**步骤3：判定与行动**\n问题有效。现在开始推导解。\n\n我们首先定义权向量误差为 $\\tilde{\\mathbf{w}}(n) \\triangleq \\mathbf{w}(n) - \\mathbf{w}_{o}$。从APA更新方程两边减去 $\\mathbf{w}_{o}$，得到权向量误差的更新方程：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{e}(n).\n$$\n先验误差矢量 $\\mathbf{e}(n)$ 可以用权向量误差表示。期望响应矢量 $\\mathbf{d}(n)$ 的第 $i$ 个元素是 $d(n-i) = \\mathbf{x}^{\\top}(n-i)\\mathbf{w}_{o} + v(n-i)$。用矩阵形式表示为：\n$$\n\\mathbf{d}(n) = \\mathbf{X}^{\\top}(n)\\mathbf{w}_{o} + \\mathbf{v}(n),\n$$\n其中 $\\mathbf{v}(n) = [v(n), v(n-1), \\ldots, v(n-P+1)]^{\\top}$。将此代入 $\\mathbf{e}(n)$ 的定义中：\n$$\n\\mathbf{e}(n) = \\mathbf{X}^{\\top}(n)\\mathbf{w}_{o} + \\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\mathbf{w}(n) = \\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\tilde{\\mathbf{w}}(n).\n$$\n将此结果代回误差向量的更新方程中：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\big(\\mathbf{v}(n) - \\mathbf{X}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\big).\n$$\n整理各项，我们得到：\n$$\n\\tilde{\\mathbf{w}}(n+1) = \\left[\\mathbf{I}_{M} - \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{X}^{\\top}(n)\\right]\\tilde{\\mathbf{w}}(n) + \\mu\\,\\mathbf{X}(n)\\big(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\big)^{-1}\\mathbf{v}(n).\n$$\n为了分析稳态行为，我们采用能量守恒法。我们取两边的欧几里得范数的平方：\n$$\n\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2} = \\tilde{\\mathbf{w}}^{\\top}(n+1)\\tilde{\\mathbf{w}}(n+1).\n$$\n在稳态下取期望，我们有 $\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n)\\|^{2}\\}$。这意味着能量变化的期望为零。对更新方程的范数平方取期望并消去这些项，可以得到一个稳态能量平衡方程。一个更直接的方法是先求 $\\tilde{\\mathbf{w}}(n+1)$ 的范数平方，然后取期望。\n我们来分析平方后的各项。为简化起见，我们定义矩阵 $\\mathbf{A}(n) = (\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}$ 和投影矩阵 $\\mathbf{P}_{\\mathbf{X}}(n) = \\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{X}^{\\top}(n)$。更新方程为 $\\tilde{\\mathbf{w}}(n+1) = (\\mathbf{I}_M - \\mu\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n) + \\mu\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)$。\n平方产生的交叉项是 $2\\mu\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_M - \\mu\\mathbf{P}_{\\mathbf{X}}(n))^{\\top}\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)$。\n在稳态下，我们引用标准独立性假设：权向量误差 $\\tilde{\\mathbf{w}}(n)$ 与输入回归矩阵 $\\mathbf{X}(n)$ 和噪声矢量 $\\mathbf{v}(n)$ 统计独立。由于 $\\mathbf{v}(n)$ 是零均值，此交叉项的期望为零。\n因此，对范数平方取期望得到：\n$$\n\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|(\\mathbf{I}_{M} - \\mu\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n)\\|^{2}\\} + \\mu^{2}\\mathbb{E}\\{\\|\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\|^{2}\\}.\n$$\n在稳态下，$\\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n+1)\\|^{2}\\} = \\mathbb{E}\\{\\|\\tilde{\\mathbf{w}}(n)\\|^{2}\\} \\triangleq \\xi$。\n$$\n\\xi = \\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_{M} - \\mu\\mathbf{P}_{\\mathbf{X}}(n))^{2}\\tilde{\\mathbf{w}}(n)\\} + \\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n由于 $\\mathbf{P}_{\\mathbf{X}}(n)$ 是一个投影矩阵，所以 $\\mathbf{P}_{\\mathbf{X}}^{2}(n)=\\mathbf{P}_{\\mathbf{X}}(n)$。第一项变为：\n$$\n\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)(\\mathbf{I}_{M} - (2\\mu-\\mu^2)\\mathbf{P}_{\\mathbf{X}}(n))\\tilde{\\mathbf{w}}(n)\\} = \\xi - (2\\mu-\\mu^2)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\}.\n$$\n第二项简化为 $\\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}$。平衡方程为：\n$$\n(2\\mu-\\mu^2)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mu^{2}\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n当 $\\mu \\neq 0$ 时，我们可以两边除以 $\\mu$：\n$$\n(2-\\mu)\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mu\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\}.\n$$\n现在我们计算期望值。我们使用迹算子和独立性假设。令 $\\mathbf{C} = \\mathbb{E}\\{\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\}$ 为稳态权向量误差协方差矩阵。\n右侧（RHS）的期望为：\n$$\n\\mathbb{E}\\{\\mathbf{v}^{\\top}(n)\\mathbf{A}(n)\\mathbf{v}(n)\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{A}(n)\\mathbf{v}(n)\\mathbf{v}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{A}(n)\\}\\mathbb{E}\\{\\mathbf{v}(n)\\mathbf{v}^{\\top}(n)\\}).\n$$\n由于 $v(n)$ 是白噪声过程，$\\mathbb{E}\\{\\mathbf{v}(n)\\mathbf{v}^{\\top}(n)\\} = \\sigma_{v}^{2}\\mathbf{I}_{P}$。\n对于白噪声输入矢量过程 $\\mathbf{x}(n)$，当 $i \\neq j$ 时，矢量 $\\mathbf{x}(n-i)$ 和 $\\mathbf{x}(n-j)$ 是不相关的。$\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)$ 的 $(i,j)$ 项是 $\\mathbf{x}^{\\top}(n-i+1)\\mathbf{x}(n-j+1)$。其期望为 $\\mathbb{E}\\{\\mathbf{x}^{\\top}(n-i+1)\\mathbf{x}(n-j+1)\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{x}(n-j+1)\\mathbf{x}^{\\top}(n-i+1)\\}) = \\delta_{ij}\\mathrm{Tr}(\\sigma_{x}^{2}\\mathbf{I}_{M}) = M\\sigma_{x}^{2}\\delta_{ij}$。\n因此，$\\mathbb{E}\\{\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\} = M\\sigma_{x}^{2}\\mathbf{I}_{P}$。我们使用一个常见的近似 $\\mathbb{E}\\{\\mathbf{A}(n)\\} = \\mathbb{E}\\{(\\mathbf{X}^{\\top}(n)\\mathbf{X}(n))^{-1}\\} \\approx (\\mathbb{E}\\{\\mathbf{X}^{\\top}(n)\\mathbf{X}(n)\\})^{-1} = (M\\sigma_{x}^{2})^{-1}\\mathbf{I}_{P}$。对于小步长 $\\mu$，这个近似是合理的。\n右侧的期望变为：\n$$\n\\mathrm{Tr}((M\\sigma_{x}^{2})^{-1}\\mathbf{I}_{P} \\cdot \\sigma_{v}^{2}\\mathbf{I}_{P}) = \\frac{\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}\\mathrm{Tr}(\\mathbf{I}_{P}) = \\frac{P\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}.\n$$\n左侧（LHS）的期望为：\n$$\n\\mathbb{E}\\{\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{P}_{\\mathbf{X}}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}\\mathbf{C}).\n$$\n对于白噪声输入，其统计特性是各向同性的。期望投影矩阵 $\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}$ 必须与单位矩阵成正比，即 $\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\} = c\\mathbf{I}_{M}$。常数 $c$ 可以通过迹来求得：$\\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\}) = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{P}_{\\mathbf{X}}(n))\\} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{I}_{P})\\} = P$。所以，$cM = P$，这意味着 $c = P/M$。\n因此，$\\mathbb{E}\\{\\mathbf{P}_{\\mathbf{X}}(n)\\} = \\frac{P}{M}\\mathbf{I}_{M}$。\n左侧的期望为 $\\mathrm{Tr}(\\frac{P}{M}\\mathbf{I}_{M}\\mathbf{C}) = \\frac{P}{M}\\mathrm{Tr}(\\mathbf{C})$。\n将这些结果代回能量平衡方程：\n$$\n(2-\\mu)\\frac{P}{M}\\mathrm{Tr}(\\mathbf{C}) = \\mu\\frac{P\\sigma_{v}^{2}}{M\\sigma_{x}^{2}}.\n$$\n两边的项 $P$ 和 $M$ 可以消去，这是一个关键的观察。\n$$\n(2-\\mu)\\mathrm{Tr}(\\mathbf{C}) = \\frac{\\mu\\sigma_{v}^{2}}{\\sigma_{x}^{2}}.\n$$\n解出 $\\mathrm{Tr}(\\mathbf{C})$：\n$$\n\\mathrm{Tr}(\\mathbf{C}) = \\frac{\\mu}{(2-\\mu)}\\frac{\\sigma_{v}^{2}}{\\sigma_{x}^{2}}.\n$$\nEMSE 定义为 $\\mathrm{EMSE} = \\mathbb{E}\\{(\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n))^{2}\\} = \\mathbb{E}\\{\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\mathbf{x}(n)\\}$。利用稳态下 $\\mathbf{x}(n)$ 和 $\\tilde{\\mathbf{w}}(n)$ 的独立性：\n$$\n\\mathrm{EMSE} = \\mathbb{E}\\{\\mathrm{Tr}(\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n))\\} = \\mathrm{Tr}(\\mathbb{E}\\{\\mathbf{x}(n)\\mathbf{x}^{\\top}(n)\\}\\mathbb{E}\\{\\tilde{\\mathbf{w}}(n)\\tilde{\\mathbf{w}}^{\\top}(n)\\}).\n$$\n$$\n\\mathrm{EMSE} = \\mathrm{Tr}(\\sigma_{x}^{2}\\mathbf{I}_{M}\\mathbf{C}) = \\sigma_{x}^{2}\\mathrm{Tr}(\\mathbf{C}).\n$$\n代入 $\\mathrm{Tr}(\\mathbf{C})$ 的表达式：\n$$\n\\mathrm{EMSE} = \\sigma_{x}^{2} \\left( \\frac{\\mu}{(2-\\mu)}\\frac{\\sigma_{v}^{2}}{\\sigma_{x}^{2}} \\right) = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}.\n$$\n这个稳态EMSE的最终表达式与投影阶数 $P$ 无关。这是针对白噪声输入信号的一个特定结果，其原因在于，在所述统计假设下，$P$ 对滤波器学习动态的缩放效应与其对噪声的敏感性相互抵消。对于相关输入，这种抵消不会发生，EMSE确实会依赖于 $P$。\n\n题目要求 $P \\in \\{1, 2, 4\\}$ 时的EMSE值。根据推导出的结果，这三种情况的表达式是相同的。\n\n当 $P=1$ 时：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。\n当 $P=2$ 时：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。\n当 $P=4$ 时：$\\mathrm{EMSE} = \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}  \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}  \\frac{\\mu}{2-\\mu}\\sigma_{v}^{2}\n\\end{pmatrix}\n}\n$$", "id": "2850820"}]}