## 引言
在信号处理领域，宽义平稳 (WSS) 模型长期以来是分析随机信号的基石。然而，许多人造系统产生的信号，如通信、雷达和[机械振动](@entry_id:167420)信号，其统计特性并非恒定不变，而是随着时间呈现出周期性变化。循环平稳信号处理提供了一个更强大、更精细的分析框架，专门用于揭示和利用这些隐藏的周期性结构，从而在众多应用中获得超越传统方法的性能。

本文旨在系统性地介绍循环平稳信号处理的核心理论及其应用。我们首先将解决一个关键的知识缺口：为何以及何时传统的[平稳性假设](@entry_id:272270)会失效，以及这种失效会带来怎样的误导性结论。通过深入探讨[循环平稳性](@entry_id:186382)的数学基础，本文将为读者构建一个坚实的理论根基。

在接下来的章节中，您将学习到：第一，在“原理与机制”部分，我们将从第一性原理出发，定义循环[平稳过程](@entry_id:196130)，引入循环自相关函数和谱[相关函数](@entry_id:146839)等关键工具，并阐明其物理意义。第二，在“应用与跨学科联系”部分，我们将展示这些理论如何在通信信号参数估计、[频谱](@entry_id:265125)感知和机械故障诊断等实际问题中发挥关键作用。最后，通过“动手实践”环节，您将有机会应用所学知识解决具体问题。现在，让我们从构建[循环平稳性](@entry_id:186382)的基本原理开始。

## 原理与机制

本章旨在深入探讨循环平稳信号处理的核心原理与基本机制。在前一章介绍其广泛应用背景的基础上，我们将从第一性原理出发，系统地构建[循环平稳性](@entry_id:186382)的理论框架。我们将首先定义循环[平稳过程](@entry_id:196130)，并将其与更常见的[平稳过程](@entry_id:196130)进行对比。随后，我们将引入用于表征和分析这些过程的关键统计工具——循环[自相关函数](@entry_id:138327)与谱[相关函数](@entry_id:146839)。本章的重点在于阐明这些工具的数学构造、物理意义，以及它们如何揭示信号中隐藏的周期性结构。最后，我们将讨论将这些理论概念应用于实际数据分析时所涉及的[各态历经性](@entry_id:146461)问题。

### 从平稳性到[循环平稳性](@entry_id:186382)

在信号处理领域，**宽义平稳 (Wide-Sense Stationary, WSS)** 过程是分析随机信号的基石。一个[随机过程](@entry_id:159502) $x(t)$ 被称为宽义平稳的，如果其一阶和二阶[统计矩](@entry_id:268545)满足以下两个条件：
1.  其[均值函数](@entry_id:264860) $m_x(t) = \mathbb{E}\{x(t)\}$ 为一个与时间无关的常数。
2.  其自相关函数 $R_x(t_1, t_2) = \mathbb{E}\{x(t_1)x^*(t_2)\}$ 仅依赖于时间差 $\tau = t_1 - t_2$。采用中心化时滞形式，即 $R_x(t, \tau) = \mathbb{E}\{x(t+\tau/2)x^*(t-\tau/2)\}$，该条件等价于 $R_x(t, \tau)$ 不依赖于中心时间 $t$，即 $R_x(t, \tau) = R_x(\tau)$。

然而，许[多源](@entry_id:170321)自人造系统的信号，例如通信、雷达和[机械振动](@entry_id:167420)信号，其统计特性并非完全时不变。这些信号通常由于采样、调制、编码或机械旋转等周期性操作而表现出一种更广义的平稳性——它们的统计特性会随时间周期性地变化。这类过程被称为**循环平稳 (Cyclostationary)** 过程。

一个[随机过程](@entry_id:159502) $x(t)$ 被称为**宽义循环平稳 (Wide-Sense Cyclostationary, WSCS)** 的，如果存在一个周期 $T_0 > 0$，使得其[均值函数](@entry_id:264860) $m_x(t)$ 和[自相关函数](@entry_id:138327) $R_x(t, \tau)$ 均是关于时间变量 $t$ 的[周期函数](@entry_id:139337)，且周期为 $T_0$：
1.  $m_x(t+T_0) = m_x(t)$ 对所有 $t \in \mathbb{R}$ 成立。
2.  $R_x(t+T_0, \tau) = R_x(t, \tau)$ 对所有 $(t, \tau) \in \mathbb{R}^2$ 成立。

从定义可以看出，WSS 过程是 WSCS 过程的一个特例，其[统计矩](@entry_id:268545)的周期可以是任意值。在概率论文献中，WSCS 过程通常被称为**周期相关 (Periodically Correlated, PC)** 过程，这两个术语在二阶统计的层面上是等价的 [@problem_id:2862541]。

我们可以进一步区分[循环平稳性](@entry_id:186382)的阶次。如果一个过程的[均值函数](@entry_id:264860) $m_x(t)$ 是周期的，我们称其为**一阶循环平稳**。如果其自相关函数 $R_x(t, \tau)$ 是关于 $t$ 周期的，则称其为**二阶循环平稳**。一个过程可以是一阶循环平稳但非二阶循环平稳。例如，考虑一个由确定性[周期信号](@entry_id:266688)与一个具有非周期时变功率的噪声相加构成的过程 $x(t) = A\cos(2\pi t/T_0) + n(t)$。设 $n(t)$ 的均值为零，自相关为 $R_n(t, \tau) = \sigma^2(t)\delta(\tau)$，其中功率 $\sigma^2(t)$ 是非周期的。此过程的均值为 $m_x(t) = A\cos(2\pi t/T_0)$，是周期的，故其为一阶循环平稳。然而，其自相关函数 $R_x(t, \tau)$ 包含非周期的项 $R_n(t, \tau)$，因此该过程不是二阶循环平稳的 [@problem_id:2862554]。

一个典型的既是 WSCS 但又不是 WSS 的例子是[幅度调制](@entry_id:266006)过程。考虑一个零均值的 WSS 过程 $y(t)$，其自相关函数为 $R_y(\tau)$。我们用一个周期为 $T_0$ 的确定性函数 $a(t)$ 对其进行[幅度调制](@entry_id:266006)，得到 $x(t) = a(t)y(t)$。该过程的均值 $m_x(t) = a(t)\mathbb{E}\{y(t)\} = 0$，是周期的。其[自相关函数](@entry_id:138327)为：
$$
R_x(t, \tau) = \mathbb{E}\{a(t+\tau/2)y(t+\tau/2) a(t-\tau/2)y^*(t-\tau/2)\} = a(t+\tau/2)a(t-\tau/2)R_y(\tau)
$$
由于 $a(t)$ 是周期为 $T_0$ 的函数，其乘积项 $a(t+\tau/2)a(t-\tau/2)$ 同样是关于 $t$ 周期的，周期也为 $T_0$。因此，$R_x(t, \tau)$ 是关于 $t$ 周期的。只要 $a(t)$ 不是常数，那么 $R_x(t, \tau)$ 通常会依赖于 $t$，从而使得 $x(t)$ 不是 WSS 过程，而是一个 WSCS 过程 [@problem_id:2862516]。

### 误用[平稳性假设](@entry_id:272270)的后果：一个启发性示例

理解[循环平稳性](@entry_id:186382)的重要性，最好的方式莫过于考察当它被忽略时会发生什么。让我们考虑一个离散时间[幅度调制](@entry_id:266006)模型，它是在实践中产生循环平稳信号的典型方式。设信号 $x[n]$ 由一个确定性的[周期序列](@entry_id:159194) $a[n]$（周期为 $M$）与一个零均值的 WSS 过程 $s[n]$ 相乘得到：
$$
x[n] = a[n] s[n]
$$
其中，$s[n]$ 的真实功率谱密度 (PSD) 为 $S_s(e^{j\omega})$。

过程 $x[n]$ 的自相关函数为 $R_x[n, \tau] = a[n+\tau]a^*[n]R_s[\tau]$，它明显随时间 $n$ 周期性变化，因此 $x[n]$ 是循环平稳的。如果我们忽略这一点，并试图通过标准 WSS 方法估计其 PSD，例如，首先计算样本[自相关函数](@entry_id:138327)：
$$
\widehat{R}_{x}^{(\mathrm{WSS})}[\tau] \triangleq \frac{1}{N}\sum_{n=0}^{N-1-|\tau|} x[n+\tau]x^*[n]
$$
然后对其进行[傅里叶变换](@entry_id:142120)得到 PSD 估计值 $\widehat{S}_{x}^{(\mathrm{WSS})}(e^{j\omega})$。

在大的观测长度 $N \to \infty$ 的极限下，这个估计量的[期望值](@entry_id:153208)会收敛到什么呢？该样本自相关函数的[期望值](@entry_id:153208)为：
$$
\mathbb{E}\{\widehat{R}_{x}^{(\mathrm{WSS})}[\tau]\} \approx \left( \frac{1}{N}\sum_{n=0}^{N-1} a[n+\tau]a^*[n] \right) R_s[\tau]
$$
由于 $a[n]$ 的周期性，括号内的项会收敛到 $a[n+\tau]a^*[n]$ 在一个周期内的平均值，我们记为 $R_{a,0}[\tau]$。可以证明，$R_{a,0}[\tau] = \sum_k |A_k|^2 e^{j\frac{2\pi}{M}k\tau}$，其中 $A_k$ 是 $a[n]$ 的[傅里叶级数](@entry_id:139455)系数。因此，PSD 估计量的[期望值](@entry_id:153208)为：
$$
\mathbb{E}\{\widehat{S}_{x}^{(\mathrm{WSS})}(e^{j\omega})\} \approx \mathcal{F}\{R_{a,0}[\tau] R_s[\tau]\} = \sum_k |A_k|^2 S_s(e^{j(\omega - \frac{2\pi k}{M})})
$$
这个结果表明，**天真地将循环[平稳过程](@entry_id:196130)当作[平稳过程](@entry_id:196130)处理，会导致一个有偏的 PSD 估计**。估计出的谱不是真实的谱 $S_s(e^{j\omega})$，而是真实谱的多个[移位](@entry_id:145848)副本的加权和。这种现象将不同频率的信息混叠在一起，可能完全掩盖信号的真实谱结构 [@problem_id:2899132]。这清晰地揭示了，为了正确地分析循环平稳信号，我们必须采用专门为此设计的工具。

### 二阶循环统计量：[时域与频域](@entry_id:268132)工具

循环[平稳过程](@entry_id:196130)的核心特征是其二阶[统计矩](@entry_id:268545)的周期性。为了利用这一特征，我们需要引入一套新的统计量来描述它。

#### 循环[自相关函数](@entry_id:138327)

由于宽义循环[平稳过程](@entry_id:196130) $x(t)$ 的自相关函数 $R_x(t, \tau)$ 是关于时间 $t$ 的周期函数（周期为 $T_0$），我们可以将其展开成傅里叶级数：
$$
R_x(t, \tau) = \sum_{k \in \mathbb{Z}} R_x^{\alpha}(\tau) e^{j2\pi\alpha t}
$$
其中，频率 $\alpha$ 被限制在一个[离散集](@entry_id:146023)合内，称为**循环频率 (cyclic frequencies)**，它们是[基频](@entry_id:268182) $f_0 = 1/T_0$ 的整数倍，即 $\alpha = k/T_0$，$k \in \mathbb{Z}$ [@problem_id:2862541]。

这个级数展开的[傅里叶系数](@entry_id:144886) $R_x^{\alpha}(\tau)$ 被称为**循环[自相关函数](@entry_id:138327) (cyclic autocorrelation function)**。它是一个关于时滞变量 $\tau$ 的函数，并通过对 $R_x(t, \tau)$ 在一个周期上进行积分来计算：
$$
R_x^{\alpha}(\tau) = \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} R_x(t, \tau) e^{-j2\pi\alpha t} dt
$$
更广义地，对于几乎周期相关的情况，该定义可以推广为一个无穷[时间平均](@entry_id:267915)极限 [@problem_id:2862556] [@problem_id:2862487]：
$$
R_x^{\alpha}(\tau) = \lim_{T \to \infty} \frac{1}{T} \int_{-T/2}^{T/2} R_x(t, \tau) e^{-j2\pi\alpha t} dt
$$
循环自相关函数 $R_x^{\alpha}(\tau)$ 描述了信号中相隔时滞 $\tau$ 的采样点之间相关性的周期性分量。每一个非零的 $R_x^{\alpha}(\tau)$ (对于 $\alpha \neq 0$) 都对应于信号中存在的一个特定的二阶周期性。

#### 谱[相关函数](@entry_id:146839)

将循环自相关函数 $R_x^{\alpha}(\tau)$ 关于时滞变量 $\tau$ 进行[傅里叶变换](@entry_id:142120)，我们得到**谱[相关函数](@entry_id:146839) (Spectral Correlation Function, SCF)**，也称为谱相关密度 (Spectral Correlation Density, SCD)：
$$
S_x^{\alpha}(f) = \int_{-\infty}^{\infty} R_x^{\alpha}(\tau) e^{-j2\pi f \tau} d\tau
$$
这个关系是循环[平稳过程](@entry_id:196130)的**广义[维纳-辛钦定理](@entry_id:188017) (Generalized Wiener-Khinchin Theorem)** [@problem_id:2914612]。SCF $S_x^{\alpha}(f)$ 是一个二维函数，依赖于普通频率 $f$ 和循环频率 $\alpha$，它构成了循环平稳信号[频域分析](@entry_id:265642)的核心。

- **$\alpha = 0$ 的情况**：当循环频率为零时，循环[自相关函数](@entry_id:138327) $R_x^0(\tau)$ 就是时变[自相关函数](@entry_id:138327) $R_x(t, \tau)$ 的[时间平均](@entry_id:267915)值 $\bar{R}_x(\tau)$。其[傅里叶变换](@entry_id:142120) $S_x^0(f)$ 就是该过程的**平均[功率谱密度](@entry_id:141002) (PSD)**。这与 WSS 过程的[维纳-辛钦定理](@entry_id:188017)完全对应，建立了与传统谱分析的直接联系 [@problem_id:2862487] [@problem_id:2862541]。

- **$\alpha \neq 0$ 的情况**：当循环频率非零时，$S_x^{\alpha}(f)$ 的物理意义尤为重要。它可以被证明等价于以下形式：
$$
S_x^{\alpha}(f) = \lim_{T\to\infty} \frac{1}{T} \mathbb{E} \left\{ X_T\left(f + \frac{\alpha}{2}\right) X_T^*\left(f - \frac{\alpha}{2}\right) \right\}
$$
其中 $X_T(f)$ 是信号在长度为 $T$ 的窗口上的[傅里叶变换](@entry_id:142120)。这个表达式表明，**非零循环频率的谱相关函数 $S_x^{\alpha}(f)$ 度量了信号在两个不同频率 $f + \alpha/2$ 和 $f - \alpha/2$ 的谱分量之间的相关性** [@problem_id:2862487]。对于一个 WSS 过程，不同频率的谱分量是不相关的，因此其所有 $\alpha \neq 0$ 的 SCF 均为零。所以，在 $\alpha \neq 0$ 处出现非零的 SCF 是[循环平稳性](@entry_id:186382)存在的明确标志，它揭示了信号中由周期性操作引起的谱冗余。

从更深层的数学角度看，一个周期相关过程的[谱测度](@entry_id:201693)（Loève 谱）并非在整个二维频率平面 $(f_1, f_2)$ 上任意[分布](@entry_id:182848)，而是被约束在一些离散的直线上，这些直线满足 $f_1 - f_2 = k/T_0$。这正是谱相关性存在的根本原因 [@problem_id:2862541]。

### 完备的二阶统计描述

对于复值信号或多信号场景，循环统计工具可以进一步推广，以提供更全面的描述。

对于一个复值[随机过程](@entry_id:159502) $x(t)$，除了标准的自相关函数 $\mathbb{E}\{x(t_1)x^*(t_2)\}$，还存在**共轭相关函数 (conjugate correlation function)**，定义为 $C_x(t_1, t_2) = \mathbb{E}\{x(t_1)x(t_2)\}$（注意没有复共轭）。如果一个过程的共轭[相关函数](@entry_id:146839)恒为零，则称该过程是**圆性的 (circular)** 或**纯正的 (proper)**。对于非纯正的复值循环[平稳过程](@entry_id:196130)，其共轭相关函数 $C_x(t,\tau) = \mathbb{E}\{x(t+\tau/2)x(t-\tau/2)\}$ 也可能是关于 $t$ 周期的。

我们可以类似地定义**共轭循环自相关函数** $\tilde{R}_x^{\alpha}(\tau)$ 和**共轭谱相关函数** $\tilde{S}_x^{\alpha}(f)$：
$$
\tilde{R}_x^{\alpha}(\tau) = \lim_{T \to \infty} \frac{1}{T} \int_{-T/2}^{T/2} C_x(t, \tau) e^{-j2\pi\alpha t} dt
$$
$$
\tilde{S}_x^{\alpha}(f) = \int_{-\infty}^{\infty} \tilde{R}_x^{\alpha}(\tau) e^{-j2\pi f \tau} d\tau
$$
对于实值过程，$x(t) = x^*(t)$，因此共轭循环统计量与标准循环统计量是完全相同的。然而对于复值信号，例如某些[通信系统](@entry_id:265921)中采用的调制方式，共轭谱相关函数提供了关于信号结构的额外信息 [@problem_id:2862494]。

此外，这些概念也可以自然地推广到多个[联合循环](@entry_id:185995)[平稳过程](@entry_id:196130) $x(t)$ 和 $y(t)$。通过分析时变[互相关函数](@entry_id:147301) $R_{xy}(t, \tau) = \mathbb{E}\{x(t+\tau/2)y^*(t-\tau/2)\}$ 的周期性，我们可以定义**循环[互相关函数](@entry_id:147301)** $R_{xy}^{\alpha}(\tau)$ 和**交叉谱[相关函数](@entry_id:146839) (Cross-SCF)** $S_{xy}^{\alpha}(f)$，它们用于度量两个信号在不同频带之间存在的相关性 [@problem_id:2862506]。

### 从理论到实践：[各态历经性](@entry_id:146461)与估计

我们已经定义了一套完备的理论统计量，但一个关键的实践问题是：我们能否从单次观测到的[有限长信号](@entry_id:272352)中可靠地估计这些量？这引出了**[各态历经性](@entry_id:146461) (ergodicity)** 的概念。

对于循环[平稳过程](@entry_id:196130)，我们关心的是**二阶[各态历经性](@entry_id:146461)**，即时间平均是否收敛于系综平均。具体来说，对于每一个循环频率 $\alpha$，我们是否能用[时间平均](@entry_id:267915)估计量 $\widehat{R}_x^{\alpha}(\tau; T)$ 来代替理论上的系综平均 $R_x^{\alpha}(\tau)$？
$$
\widehat{R}_x^{\alpha}(\tau; T) = \frac{1}{T}\int_{-T/2}^{T/2} x(t+\tau/2) x^{*}(t-\tau/2) e^{-j 2\pi \alpha t} dt \quad \xrightarrow{T \to \infty} \quad R_x^{\alpha}(\tau)
$$
这个收敛性并不是无条件成立的。一个关键的阻碍是信号中确定性周期分量的存在。如果信号 $x(t)$ 包含一个或多个具有未知随机相位的[正弦波](@entry_id:274998)（这种分量会在谱[相关函数](@entry_id:146839)中产生离散的[谱线](@entry_id:193408)），那么对该信号进行[时间平均](@entry_id:267915)的结果将依赖于这个未知的相位，导致时间平均不收敛于（不含相位的）系综平均。

因此，循环[平稳过程](@entry_id:196130)二阶[各态历经性](@entry_id:146461)的一个**必要条件**是，其所有的谱[相关函数](@entry_id:146839) $S_x^{\alpha}(f)$ 都不包含离散的[谱线](@entry_id:193408)成分。反之，一个**充分条件**是，所有的[循环谱](@entry_id:186083)测度都是关于频率 $f$ 绝对连续的 [@problem_id:2862521]。

回到本章开头的[幅度调制](@entry_id:266006)示例 $x[n] = a[n]s[n]$，如果我们知道调制序列 $a[n]$，我们可以设计一种更智能的估计算法来绕过这个问题并恢复出底层[平稳过程](@entry_id:196130) $s[n]$ 的统计特性。这个方法被称为**循环平均 (cyclic averaging)** 或**相移同步平均 (phase-synchronous averaging)**。其思想是，不把所有时间的数据混在一起平均，而是根据周期 $M$ 将数据分组，对每个相位 $m \in \{0, \dots, M-1\}$ 分别进行平均，然后对调制效应进行补偿。例如，我们可以通过如下方式得到 $R_s[\tau]$ 的一个[无偏估计](@entry_id:756289)：
$$
\widehat{R}_s[\tau] = \frac{1}{M} \sum_{m=0}^{M-1} \frac{\widehat{R}_x^{(m)}[\tau]}{a[m+\tau]a^*[m]}
$$
其中 $\widehat{R}_x^{(m)}[\tau]$ 是在相位 $m$ 上的样本[自相关](@entry_id:138991)。这种方法有效地利用了关于[循环平稳性](@entry_id:186382)的先验知识，将被视为“偏差”的周期性结构转化为有用的信息，从而实现对信号更深层次的分析 [@problem_id:2899132]。这正是循环平稳信号处理强大能力的体现。