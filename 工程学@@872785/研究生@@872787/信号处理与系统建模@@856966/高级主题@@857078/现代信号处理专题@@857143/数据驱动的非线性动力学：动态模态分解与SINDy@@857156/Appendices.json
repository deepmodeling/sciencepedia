{"hands_on_practices": [{"introduction": "在将动态模式分解（DMD）应用于复杂系统之前，通过一个简单而典型的信号——正弦波——来理解其基本原理是至关重要的。本练习 [@problem_id:2862877] 将引导您将信号的结构与延迟嵌入空间所需的维度联系起来。通过这个过程，您将建立起信号复杂度（即模式数量）与汉克尔矩阵的秩之间的联系，这是许多系统辨识技术的核心基石。", "problem": "您观测到一个由单个正弦波和附加噪声生成的实值、均匀采样的时间序列，\n$$y_k = A \\cos(\\omega k \\Delta t + \\phi) + \\eta_k,$$\n其中 $A \\neq 0$，$\\omega \\in \\mathbb{R}$，$\\Delta t > 0$，$\\phi \\in \\mathbb{R}$，且 $\\{\\eta_k\\}$ 是一个均值为零、方差有限的扰动。假设为非简并振荡情况，其中离散时间弧度频率 $\\theta := \\omega \\Delta t$ 满足 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 和 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。您从 $N$ 个样本中构建一个具有 $m$ 个延迟的汉克尔矩阵，\n$$\\mathbf{H} = \n\\begin{bmatrix}\ny_0  y_1  \\cdots  y_{N-m} \\\\\ny_1  y_2  \\cdots  y_{N-m+1} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\ny_{m-1}  y_m  \\cdots  y_{N-1}\n\\end{bmatrix} \\in \\mathbb{R}^{m \\times (N-m+1)},$$\n并应用汉克尔动态模态分解（延迟嵌入动态模态分解），该方法旨在寻找一个将延迟嵌入状态推进一个时间步长的线性映射。仅从正弦波的复指数基本表示和汉克尔矩阵的定义出发，推导无噪声信号满足的最小线性递推阶数，并用它来确定汉克尔动态模态分解在噪声消失的极限下唯一识别振荡频率 $\\omega$ 所需的最小延迟数 $m$。明确地将这个最小 $m$ 与无噪声汉克尔矩阵的秩联系起来。陈述您所使用的关于底层模态和采样的独特性假设。以最小整数 $m$ 的形式提供您的最终答案；无需四舍五入，也无需单位。", "solution": "问题陈述需经过验证。\n\n步骤1：提取已知条件\n- 观测到的时间序列为 $y_k = A \\cos(\\omega k \\Delta t + \\phi) + \\eta_k$。\n- 参数为 $A \\neq 0$，$\\omega \\in \\mathbb{R}$，$\\Delta t > 0$，$\\phi \\in \\mathbb{R}$。\n- 噪声 $\\{\\eta_k\\}$ 是一个均值为零、方差有限的扰动。\n- 离散时间弧度频率定义为 $\\theta := \\omega \\Delta t$。\n- 假设为非简并振荡情况，其中 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 和 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。\n- 从 $N$ 个样本 $\\{y_k\\}_{k=0}^{N-1}$ 中构建一个具有 $m$ 个延迟的汉克尔矩阵 $\\mathbf{H} \\in \\mathbb{R}^{m \\times (N-m+1)}$。该矩阵由下式给出：\n$$ \\mathbf{H} = \n\\begin{bmatrix}\ny_0  y_1  \\cdots  y_{N-m} \\\\\ny_1  y_2  \\cdots  y_{N-m+1} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\ny_{m-1}  y_m  \\cdots  y_{N-1}\n\\end{bmatrix} $$\n- 任务是推导无噪声信号的最小线性递推阶数，用它来找到在噪声消失的极限下汉克尔DMD唯一识别 $\\omega$ 所需的最小延迟数 $m$，并将这个最小 $m$ 与无噪声汉克尔矩阵的秩联系起来。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，植根于信号处理和系统辨识这两个成熟的领域。带附加噪声的正弦波模型是一个典型问题。使用汉克尔矩阵和延迟嵌入进行系统辨识是一项基本技术（与 Takens 的嵌入定理以及 ESPRIT 和 DMD 等方法相关）。该问题是客观的，使用了精确的数学语言。关于 $\\theta$ 的条件对于确保系统是具有不同模态的真正振荡至关重要，这是在此背景下问题适定性的一个必要条件。该问题并非不完整，因为它要求推导中间步骤（最小递推阶数）才能得出最终答案。该问题并非微不足道，因为它要求在信号结构、其递推关系、其关联汉克尔矩阵的秩以及辨识所需的最小状态空间维数之间建立正确的逻辑联系。该问题是有效的。\n\n继续进行求解。\n\n问题要求在噪声消失的极限下的行为，因此我们分析无噪声信号 $x_k = A \\cos(\\omega k \\Delta t + \\phi)$。首先，我们按照指示，使用欧拉公式将这个实值正弦波表示为复指数的和。\n设 $\\theta = \\omega \\Delta t$。信号为：\n$$ x_k = A \\left( \\frac{\\exp(i(k \\theta + \\phi)) + \\exp(-i(k \\theta + \\phi))}{2} \\right) $$\n$$ x_k = \\left( \\frac{A \\exp(i\\phi)}{2} \\right) \\exp(ik\\theta) + \\left( \\frac{A \\exp(-i\\phi)}{2} \\right) \\exp(-ik\\theta) $$\n这是一个形式为 $x_k = c_1 \\lambda_1^k + c_2 \\lambda_2^k$ 的信号，其中模态为 $\\lambda_1 = \\exp(i\\theta)$ 和 $\\lambda_2 = \\exp(-i\\theta)$，系数为 $c_1 = \\frac{A}{2}\\exp(i\\phi)$ 和 $c_2 = \\overline{c_1}$。由于 $A \\neq 0$，所以 $c_1$ 和 $c_2$ 均不为零。\n\n一个由 $p$ 个不同指数项线性组合而成的信号，满足一个唯一的、阶数为 $p$ 的最小阶线性常系数递推关系。我们必须确定模态 $\\lambda_1$ 和 $\\lambda_2$ 是否不同。如果 $\\exp(i\\theta) = \\exp(-i\\theta)$，则模态相等，这意味着 $\\exp(i2\\theta) = 1$。这种情况发生在 $2\\theta$ 是 $2\\pi$ 的整数倍时，即 $2\\theta = 2n\\pi$（其中 $n \\in \\mathbb{Z}$），可简化为 $\\theta = n\\pi$。问题陈述明确给出了非简并性条件，即 $\\theta \\not\\equiv 0 \\ (\\mathrm{mod}\\ 2\\pi)$ 和 $\\theta \\not\\equiv \\pi \\ (\\mathrm{mod}\\ 2\\pi)$。这等价于陈述 $\\theta$ 不是 $\\pi$ 的整数倍。因此，$\\lambda_1 \\neq \\lambda_2$，模态是不同的。\n\n由于信号由两个不同的模态组成，最小线性递推阶数为 $p=2$。这个递推关系的特征多项式有根 $\\lambda_1$ 和 $\\lambda_2$。\n$$ P(z) = (z - \\lambda_1)(z - \\lambda_2) = z^2 - (\\lambda_1 + \\lambda_2)z + \\lambda_1\\lambda_2 = 0 $$\n系数为：\n$$ \\lambda_1 + \\lambda_2 = \\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta) $$\n$$ \\lambda_1 \\lambda_2 = \\exp(i\\theta)\\exp(-i\\theta) = 1 $$\n特征多项式为 $z^2 - 2\\cos(\\theta)z + 1 = 0$。这对应于线性递推关系：\n$$ x_{k+2} - 2\\cos(\\theta)x_{k+1} + x_k = 0 $$\n该关系表明，无噪声信号的任意三个连续样本都是线性相关的。\n\n现在，我们将其与汉克尔矩阵联系起来。设 $\\mathbf{X}$ 为无噪声信号 $x_k$ 的汉克尔矩阵。它的列是延迟向量 $\\mathbf{x}_j = [x_j, x_{j+1}, \\dots, x_{j+m-1}]^T$。每个列向量都可以表示为与模态相关的两个固定范德蒙德向量的线性组合：\n$$ \\mathbf{x}_j = c_1 \\lambda_1^j \\begin{pmatrix} 1 \\\\ \\lambda_1 \\\\ \\vdots \\\\ \\lambda_1^{m-1} \\end{pmatrix} + c_2 \\lambda_2^j \\begin{pmatrix} 1 \\\\ \\lambda_2 \\\\ \\vdots \\\\ \\lambda_2^{m-1} \\end{pmatrix} $$\n$\\mathbf{X}$ 的整个列空间由这两个范德蒙德向量张成。由于 $\\lambda_1 \\neq \\lambda_2$，只要 $m \\ge 2$，这两个向量就是线性无关的。根据 Kronecker 定理，无限汉克尔矩阵的秩等于生成信号中不同指数模态的数量。对于有限汉克尔矩阵 $\\mathbf{X} \\in \\mathbb{R}^{m \\times (N-m+1)}$，只要维度足够，即 $m \\ge 2$ 且列数 $N-m+1 \\ge 2$，秩就为 $2$。\n\n汉克尔 DMD 旨在找到一个线性算子，该算子对延迟嵌入状态 $\\mathbf{x}_k \\in \\mathbb{R}^{m}$ 的演化进行建模。这个延迟向量的维度 $m$ 必须足够大，以嵌入动力学。要捕获一个其底层状态空间维度为 $r$ 的系统，嵌入维度 $m$ 必须至少为 $r$。在这里，无噪声数据矩阵的秩为 $r=2$，代表一个二维系统（一对复共轭模态）。因此，延迟数 $m$ 必须至少为 $2$。\n\n我们来检验一下充分性。\n如果 $m=1$，状态是标量 $x_k$。模型为 $x_{k+1} = a x_k$。这只能对单个实模态建模，而不能对产生振荡的复共轭对建模。因此，$m=1$ 是不够的。\n\n如果 $m=2$，状态为 $\\mathbf{x}_k = [x_k, x_{k+1}]^T$。一步演化为 $\\mathbf{x}_{k+1} = [x_{k+1}, x_{k+2}]^T$。我们寻求一个算子 $\\mathbf{A}$，使得 $\\mathbf{x}_{k+1} = \\mathbf{A}\\mathbf{x}_k$。\n$$ \\begin{pmatrix} x_{k+1} \\\\ x_{k+2} \\end{pmatrix} = \\mathbf{A} \\begin{pmatrix} x_k \\\\ x_{k+1} \\end{pmatrix} $$\n第一行意味着 $x_{k+1} = A_{11}x_k + A_{12}x_{k+1}$，这要求 $A_{11}=0$ 和 $A_{12}=1$。\n第二行是 $x_{k+2} = A_{21}x_k + A_{22}x_{k+1}$。从我们的递推关系中，我们知道 $x_{k+2} = -x_k + 2\\cos(\\theta)x_{k+1}$。\n因此，唯一的线性算子是友矩阵：\n$$ \\mathbf{A} = \\begin{pmatrix} 0  1 \\\\ -1  2\\cos(\\theta) \\end{pmatrix} $$\n该算子 $\\mathbf{A}$ 的特征值由特征方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = \\lambda^2 - 2\\cos(\\theta)\\lambda + 1 = 0$ 求得，其解为 $\\lambda = \\exp(\\pm i\\theta)$。这些恰好是底层系统的模态。\n汉克尔 DMD 作用于由 $\\mathbf{x}_k$ 构成的数据矩阵，将计算出该矩阵 $\\mathbf{A}$ 的一个近似值。计算出的算子的特征值将近似于 $\\exp(\\pm i\\theta)$，从中可以唯一确定 $\\theta = \\omega\\Delta t$，进而唯一确定频率 $\\omega$（符号除外，在没有更多信息的情况下，其物理意义是模糊的）。\n\n因此，$m=2$ 足以捕获动力学。由于 $m=1$ 不足，所需的最小延迟数是 $m=2$。假设有足够的数据，这个 $m$ 的最小值等于信号的最小线性递推阶数，也等于无噪声汉克尔矩阵的秩。关于采样的假设是，样本数量 $N$ 足够大，以使 DMD 中使用的矩阵具有正确的秩，这最低要求 $N-m+1 \\geq 2$。对于 $m=2$，这意味着 $N \\geq 3$，这是一个微不足道的要求。", "answer": "$$\n\\boxed{2}\n$$", "id": "2862877"}, {"introduction": "在无噪声的理想世界中建立了理论上的最低要求之后，我们现在转向现实世界，在这里数据总是受到噪声的干扰。本实践 [@problem_id:2862855] 探讨了 DMD 的精度如何受到测量噪声和所用数据量的影响。通过推导并实现一个关于频率估计误差的公式，您将为设计实验和选择如窗口长度等分析参数建立起定量的直觉。", "problem": "给定一个在加性噪声中观测到的单模离散时间线性动力学系统。其底层的纯净状态序列被建模为一个具有恒定幅度和单一角频率的复指数函数。用于动态模态分解 (DMD) 的数据矩阵由该状态的等间距时间采样构建，具体如下。\n\n假设纯净信号为 $x_k = A \\, e^{i (\\omega k \\Delta t + \\phi_0)}$，其中 $k \\in \\{0,1,2,\\dots\\}$，$A > 0$ 是一个未知的恒定振幅，$\\omega$ 是以弧度/秒为单位的真实角频率，$\\Delta t$ 是以秒为单位的采样间隔，$\\phi_0$ 是一个任意的初始相位。离散时间特征值为 $\\lambda = e^{i \\theta}$，其中 $\\theta = \\omega \\Delta t$。观测数据由零均值、方差为 $\\sigma^2$ 的加性复值高斯白噪声 $\\eta_k$ 生成，因此测量到的快照为 $\\tilde{x}_k = x_k + \\eta_k$。信噪比 (SNR) 定义为 $\\mathrm{SNR} = A^2 / \\sigma^2$，是一个无量纲的线性尺度量。考虑一个秩-1 DMD 估计器，它使用一个包含 $m$ 个连续快照对的窗口来构成\n$$\nX = \\begin{bmatrix} \\tilde{x}_0  \\tilde{x}_1  \\dots  \\tilde{x}_{m-1} \\end{bmatrix}, \\quad\nY = \\begin{bmatrix} \\tilde{x}_1  \\tilde{x}_2  \\dots  \\tilde{x}_m \\end{bmatrix},\n$$\n并通过 $\\hat{\\lambda} = (X^* Y)/(X^* X)$ 计算最小二乘 DMD 特征值估计 $\\hat{\\lambda}$，其中 $X^*$ 表示共轭转置。\n\n您的任务是：\n\n- 从上述定义、小噪声线性化以及加性高斯白噪声的性质出发，推导 DMD 特征值相位误差 $\\delta \\theta = \\arg(\\hat{\\lambda}) - \\theta$ 的方差对窗口长度 $m$ 和信噪比 $\\mathrm{SNR}$ 的主阶依赖关系。您的推导必须基于基本原理，从最小二乘估计器和噪声扰动开始，不得引用任何现成的方差公式。然后，用 $m$、$\\mathrm{SNR}$ 和 $\\Delta t$ 表示连续时间频率估计误差 $\\delta \\omega$（单位为弧度/秒）的隐含标准差，其中 $\\omega = \\theta / \\Delta t$。最后，提出一个经验法则，该法则能够根据 $\\mathrm{SNR}$ 和 $\\Delta t$，返回为使频率估计误差 $\\delta \\omega$ 达到目标标准差 $\\varepsilon_\\omega$（单位为弧度/秒）所需的最小窗口长度 $m_{\\min}$。该经验法则必须是一个显式的代数表达式 $m_{\\min} = f(\\mathrm{SNR}, \\Delta t, \\varepsilon_\\omega)$，并带有一个明确的常数因子。\n\n- 实现一个完整的、可运行的程序来评估您推导出的表达式。该程序必须在一组固定的测试集上计算两类输出：\n  1. 对于给定的 $(m, \\mathrm{SNR}, \\Delta t)$，预测频率误差 $\\delta \\omega$ 的标准差（单位为弧度/秒）。\n  2. 对于给定的 $(\\mathrm{SNR}, \\Delta t, \\varepsilon_\\omega)$，为达到目标频率标准差 $\\varepsilon_\\omega$（单位为弧度/秒）所需的最小整数窗口长度 $m_{\\min}$。强制要求下界 $m_{\\min} \\geq 3$ 以确保 DMD 窗口有意义。\n\n使用以下测试集：\n\n- 预测案例（计算频率标准差，单位为弧度/秒）：\n  - 案例 A$1$：$m = 50$，$\\mathrm{SNR} = 25$，$\\Delta t = 0.01$ 秒。\n  - 案例 A$2$：$m = 10$，$\\mathrm{SNR} = 4$，$\\Delta t = 0.02$ 秒。\n  - 案例 A$3$：$m = 3$，$\\mathrm{SNR} = 100$，$\\Delta t = 0.001$ 秒。\n- 设计案例（计算最小窗口长度 $m_{\\min}$，为整数）：\n  - 案例 B$1$：$\\mathrm{SNR} = 25$，$\\Delta t = 0.01$ 秒，$\\varepsilon_\\omega = 0.5$ 弧度/秒。\n  - 案例 B$2$：$\\mathrm{SNR} = 4$，$\\Delta t = 0.02$ 秒，$\\varepsilon_\\omega = 2.0$ 弧度/秒。\n  - 案例 B$3$：$\\mathrm{SNR} = 0.5$，$\\Delta t = 0.01$ 秒，$\\varepsilon_\\omega = 1.0$ 弧度/秒。\n  - 案例 B$4$：$\\mathrm{SNR} = 100$，$\\Delta t = 0.001$ 秒，$\\varepsilon_\\omega = 5.0$ 弧度/秒。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。该列表必须按顺序包含预测案例的三个预测频率标准差（单位为弧度/秒，浮点数），后跟设计案例的四个最小窗口长度（整数）：$[\\text{A1}, \\text{A2}, \\text{A3}, \\text{B1}, \\text{B2}, \\text{B3}, \\text{B4}]$。\n\n角度单位必须是弧度，频率单位必须是弧度/秒。所有输出都必须使用这些单位。不需要外部输入；所有参数均如上所述并嵌入程序中。每个测试案例的最终输出必须是浮点数或整数，具体取决于规定。", "solution": "所述问题需要经过验证。\n\n**步骤1：提取已知条件**\n- 纯净状态信号：$x_k = A \\, e^{i (\\omega k \\Delta t + \\phi_0)}$，其中 $k \\in \\{0, 1, \\dots\\}$。\n- 离散时间特征值：$\\lambda = e^{i\\theta}$，其中 $\\theta = \\omega \\Delta t$。\n- 观测信号：$\\tilde{x}_k = x_k + \\eta_k$。\n- 噪声：$\\eta_k$ 是复高斯白噪声，满足 $\\mathbb{E}[\\eta_k] = 0$ 和 $\\mathbb{E}[|\\eta_k|^2] = \\sigma^2$。噪声样本是独立的，即 $\\mathbb{E}[\\eta_k \\eta_j^*] = \\sigma^2 \\delta_{kj}$。\n- 信噪比：$\\mathrm{SNR} = A^2 / \\sigma^2$。\n- 数据矩阵：$X = \\begin{bmatrix} \\tilde{x}_0  \\tilde{x}_1  \\dots  \\tilde{x}_{m-1} \\end{bmatrix}$，$Y = \\begin{bmatrix} \\tilde{x}_1  \\tilde{x}_2  \\dots  \\tilde{x}_m \\end{bmatrix}$。\n- $\\lambda$ 的估计器：$\\hat{\\lambda} = (X^* Y)/(X^* X)$。\n\n**步骤2：验证**\n该问题具有科学依据，是客观的，并且在很大程度上是适定的。它探讨了系统辨识中使用动态模态分解 (DMD) 的一个标准问题。然而，存在一个显著的符号歧义。$X$ 和 $Y$ 被定义为 $1 \\times m$ 的行向量。对于此类矩阵，$X^*$ 是一个 $m \\times 1$ 的列向量，而 $X^* Y$ 和 $X^* X$ 都是 $m \\times m$ 矩阵，矩阵除法对此没有定义。\n\n在这种情况下，一个能够解决此歧义的标准解释是将数据视为列向量，即 $X = [\\tilde{x}_0, \\dots, \\tilde{x}_{m-1}]^T$ 和 $Y = [\\tilde{x}_1, \\dots, \\tilde{x}_m]^T$。在这种情况下，$X^*$ 是一个行向量，而 $X^*Y$ 和 $X^*X$ 都是标量，使得它们的比值成为一个明确定义的标量。这对应于标量时间序列的标准最小二乘问题 $\\min_{\\hat{\\lambda}} \\|Y - \\hat{\\lambda} X\\|_2^2$。其解为 $\\hat{\\lambda} = (X^*Y)/(X^*X) = (\\sum_{k=0}^{m-1} \\tilde{x}_k^* \\tilde{x}_{k+1}) / (\\sum_{k=0}^{m-1} |\\tilde{x}_k|^2)$。\n\n另一种可能性是，问题意在采用估计器 $\\hat{\\lambda} = Y X^\\dagger = YX^*(XX^*)^{-1}$，对于行向量 $X$ 和 $Y$，该估计器也产生一个标量，并计算出相同的结果。\n\n假设采用这种标准解释，则该问题是有效的，并且可以解决。其中一个测试案例 (B3) 使用了 $\\mathrm{SNR}=0.5$，这不属于“小噪声”范畴。基于线性化推导出的公式被应用，但推导过程本身并不保证其在该范畴下的准确性。这并不使问题无效，但值得一提。\n\n**结论：有效，但需澄清符号表示。**\n\n**推导**\n\n我们从离散时间特征值 $\\lambda$ 的最小二乘估计器开始：\n$$\n\\hat{\\lambda} = \\frac{\\sum_{k=0}^{m-1} \\tilde{x}_k^* \\tilde{x}_{k+1}}{\\sum_{k=0}^{m-1} |\\tilde{x}_k|^2}\n$$\n代入观测模型 $\\tilde{x}_k = x_k + \\eta_k$。分子 $N$ 和分母 $D$ 变为：\n$$\nN = \\sum_{k=0}^{m-1} (x_k^* + \\eta_k^*) (x_{k+1} + \\eta_{k+1}) = \\sum_{k=0}^{m-1} ( x_k^* x_{k+1} + x_k^* \\eta_{k+1} + \\eta_k^* x_{k+1} + \\eta_k^* \\eta_{k+1} )\n$$\n$$\nD = \\sum_{k=0}^{m-1} |x_k + \\eta_k|^2 = \\sum_{k=0}^{m-1} ( |x_k|^2 + x_k^* \\eta_k + \\eta_k^* x_k + |\\eta_k|^2 )\n$$\n对于纯净信号，有 $x_{k+1} = \\lambda x_k$。$N$ 和 $D$ 的纯净部分为 $N_0 = \\sum x_k^* x_{k+1} = \\lambda \\sum |x_k|^2$ 和 $D_0 = \\sum |x_k|^2$。因此，无噪声估计是精确的：$\\hat{\\lambda}_0 = N_0/D_0 = \\lambda$。\n\n我们在小噪声假设（$\\sigma^2 \\ll A^2$，或 $\\mathrm{SNR} \\gg 1$）下进行一阶扰动分析，只保留噪声 $\\eta_k$ 的线性项。\n$$\n\\hat{\\lambda} = \\frac{N_0 + \\delta N}{D_0 + \\delta D} \\approx \\frac{N_0}{D_0} \\left(1 + \\frac{\\delta N}{N_0} - \\frac{\\delta D}{D_0}\\right) = \\lambda + \\frac{\\delta N - \\lambda \\delta D}{D_0}\n$$\n一阶扰动为：\n$$\n\\delta N \\approx \\sum_{k=0}^{m-1} (x_k^* \\eta_{k+1} + \\eta_k^* x_{k+1})\n$$\n$$\n\\delta D \\approx \\sum_{k=0}^{m-1} (x_k^* \\eta_k + \\eta_k^* x_k)\n$$\n特征值的扰动 $\\delta \\lambda = \\hat{\\lambda} - \\lambda$ 为：\n$$\n\\delta \\lambda \\approx \\frac{1}{D_0} \\sum_{k=0}^{m-1} [ (x_k^* \\eta_{k+1} + \\eta_k^* x_{k+1}) - \\lambda (x_k^* \\eta_k + \\eta_k^* x_k) ]\n$$\n使用 $x_{k+1} = \\lambda x_k$，可以进行化简。项 $\\eta_k^* x_{k+1} = \\eta_k^* \\lambda x_k = \\lambda \\eta_k^* x_k$ 与 $-\\lambda \\eta_k^* x_k$ 相抵消。\n$$\n\\delta \\lambda \\approx \\frac{1}{D_0} \\sum_{k=0}^{m-1} (x_k^* \\eta_{k+1} - \\lambda x_k^* \\eta_k)\n$$\n这个和具有伸缩结构。我们来检查每个噪声项 $\\eta_k$ 的系数。对于 $k \\in \\{1, \\dots, m-1\\}$，系数为 $x_{k-1}^* - \\lambda x_k^*$。根据信号模型，$x_k = \\lambda x_{k-1}$，所以 $x_k^* = \\lambda^* x_{k-1}^* = \\lambda^{-1} x_{k-1}^*$ (因为 $|\\lambda|=1$)。因此，$x_{k-1}^* = \\lambda x_k^*$，系数为零。唯一不抵消的项在求和的边界处：\n$$\n\\sum_{k=0}^{m-1} (x_k^* \\eta_{k+1} - \\lambda x_k^* \\eta_k) = x_{m-1}^* \\eta_m - \\lambda x_0^* \\eta_0\n$$\n纯净信号的分母为 $D_0 = \\sum_{k=0}^{m-1} |x_k|^2 = \\sum_{k=0}^{m-1} A^2 = m A^2$。\n所以，特征值扰动为：\n$$\n\\delta \\lambda \\approx \\frac{1}{m A^2} (x_{m-1}^* \\eta_m - \\lambda x_0^* \\eta_0)\n$$\n相位误差为 $\\delta \\theta = \\arg(\\hat{\\lambda}) - \\theta = \\arg(\\lambda + \\delta\\lambda) - \\arg(\\lambda) = \\arg(1 + \\lambda^{-1}\\delta\\lambda)$。对于小扰动，$\\arg(1+z) \\approx \\mathrm{Im}(z)$。\n$$\n\\delta \\theta \\approx \\mathrm{Im}(\\lambda^{-1} \\delta \\lambda) \\approx \\mathrm{Im}\\left( \\frac{\\lambda^{-1}}{m A^2} (x_{m-1}^* \\eta_m - \\lambda x_0^* \\eta_0) \\right) = \\mathrm{Im}\\left( \\frac{1}{m A^2} (\\lambda^{-1} x_{m-1}^* \\eta_m - x_0^* \\eta_0) \\right)\n$$\n为了求方差 $\\mathrm{Var}(\\delta\\theta) = \\mathbb{E}[(\\delta\\theta)^2]$（因为 $\\mathbb{E}[\\delta\\theta] = 0$），我们使用以下性质：对于一个零均值复随机变量 $Z$，如果 $\\mathbb{E}[Z^2]=0$（对于圆对称复高斯噪声成立），则 $\\mathbb{E}[(\\mathrm{Im}(Z))^2] = \\frac{1}{2}\\mathbb{E}[|Z|^2]$。\n$$\n\\mathrm{Var}(\\delta\\theta) \\approx \\frac{1}{2} \\mathbb{E}[|\\lambda^{-1} \\delta \\lambda|^2] = \\frac{1}{2} \\mathbb{E}[|\\delta \\lambda|^2]\n$$\n我们计算 $\\delta \\lambda$ 的方差。由于 $\\eta_0$ 和 $\\eta_m$ 是独立的（对于 $m>0$）且均值为零：\n$$\n\\mathbb{E}[|\\delta \\lambda|^2] \\approx \\frac{1}{(m A^2)^2} \\mathbb{E}[|x_{m-1}^* \\eta_m - \\lambda x_0^* \\eta_0|^2] = \\frac{1}{m^2 A^4} \\left( |x_{m-1}|^2 \\mathbb{E}[|\\eta_m|^2] + |\\lambda|^2 |x_0|^2 \\mathbb{E}[|\\eta_0|^2] \\right)\n$$\n由于 $|x_k|^2 = A^2$, $|\\lambda|^2=1$ 且 $\\mathbb{E}[|\\eta_k|^2] = \\sigma^2$：\n$$\n\\mathbb{E}[|\\delta \\lambda|^2] \\approx \\frac{1}{m^2 A^4} (A^2 \\sigma^2 + A^2 \\sigma^2) = \\frac{2 A^2 \\sigma^2}{m^2 A^4} = \\frac{2 \\sigma^2}{m^2 A^2} = \\frac{2}{m^2 \\mathrm{SNR}}\n$$\n因此，相位误差的方差为：\n$$\n\\mathrm{Var}(\\delta\\theta) \\approx \\frac{1}{2} \\mathbb{E}[|\\delta\\lambda|^2] = \\frac{1}{m^2 \\mathrm{SNR}}\n$$\n分析表明，方差与 $\\mathrm{SNR}$ 成反比，与窗口长度 $m$ 的平方成反比。\n\n接下来，我们求连续时间频率误差 $\\delta \\omega$ 的标准差。频率估计为 $\\hat{\\omega} = \\arg(\\hat{\\lambda})/\\Delta t = (\\theta+\\delta\\theta)/\\Delta t = \\omega + \\delta\\theta/\\Delta t$。所以，$\\delta\\omega = \\delta\\theta / \\Delta t$。标准差 $\\sigma_{\\delta\\omega}$ 为：\n$$\n\\sigma_{\\delta\\omega} = \\sqrt{\\mathrm{Var}(\\delta\\omega)} = \\frac{\\sqrt{\\mathrm{Var}(\\delta\\theta)}}{\\Delta t} \\approx \\frac{1}{\\Delta t} \\sqrt{\\frac{1}{m^2 \\mathrm{SNR}}} = \\frac{1}{m \\Delta t \\sqrt{\\mathrm{SNR}}}\n$$\n这就是频率误差标准差所要求的表达式。\n\n最后，我们提出了一个为达到目标频率标准差 $\\varepsilon_\\omega$ 所需的最小窗口长度 $m_{\\min}$ 的经验法则。我们设定 $\\sigma_{\\delta\\omega} \\le \\varepsilon_\\omega$：\n$$\n\\frac{1}{m_{\\min} \\Delta t \\sqrt{\\mathrm{SNR}}} \\le \\varepsilon_\\omega \\implies m_{\\min} \\ge \\frac{1}{\\varepsilon_\\omega \\Delta t \\sqrt{\\mathrm{SNR}}}\n$$\n最小整数长度是该值的向上取整。考虑到问题中 $m_{\\min} \\geq 3$ 的约束：\n$$\nm_{\\min} = \\max\\left(3, \\left\\lceil \\frac{1}{\\varepsilon_\\omega \\Delta t \\sqrt{\\mathrm{SNR}}} \\right\\rceil\\right)\n$$\n这个经验法则的常数因子为 1。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem by first implementing the derived formulas for frequency error\n    standard deviation and minimal window length, then applying them to the given test cases.\n    \"\"\"\n\n    # --- Part 1: Prediction Cases ---\n    \n    # Test cases for predicting the standard deviation of the frequency error.\n    # Format: (m, SNR, dt)\n    prediction_cases = [\n        (50, 25, 0.01),  # Case A1\n        (10, 4, 0.02),   # Case A2\n        (3, 100, 0.001)  # Case A3\n    ]\n\n    predicted_std_devs = []\n    for m, snr, dt in prediction_cases:\n        # Formula for standard deviation of frequency error (sigma_delta_omega)\n        # sigma_delta_omega = 1 / (m * dt * sqrt(SNR))\n        std_dev = 1.0 / (m * dt * np.sqrt(snr))\n        predicted_std_devs.append(std_dev)\n\n    # --- Part 2: Design Cases ---\n\n    # Test cases for designing the minimal window length m_min.\n    # Format: (SNR, dt, epsilon_omega)\n    design_cases = [\n        (25, 0.01, 0.5),    # Case B1\n        (4, 0.02, 2.0),     # Case B2\n        (0.5, 0.01, 1.0),   # Case B3\n        (100, 0.001, 5.0)   # Case B4\n    ]\n\n    minimal_lengths = []\n    for snr, dt, epsilon_omega in design_cases:\n        # The small-noise approximation might be less accurate for low SNR (e.g., Case B3).\n        # However, we apply the formula as derived.\n        \n        # Formula for minimal required window length (m_min)\n        # m_min_raw = 1 / (epsilon_omega * dt * sqrt(SNR))\n        m_min_raw = 1.0 / (epsilon_omega * dt * np.sqrt(snr))\n        \n        # The minimal length is the ceiling of this value, with a lower bound of 3.\n        m_min = max(3, math.ceil(m_min_raw))\n        minimal_lengths.append(m_min)\n\n    # --- Final Output Formatting ---\n\n    # Combine all results into a single list\n    all_results = predicted_std_devs + minimal_lengths\n    \n    # Format the output string as required by the problem statement\n    result_str = \"[\" + \",\".join(map(str, all_results)) + \"]\"\n    \n    print(result_str)\n\nsolve()\n```", "id": "2862855"}, {"introduction": "现在，我们将焦点转向稀疏非线性动力学辨识（SINDy），这是一种从数据中发现控制方程的强大工具。SINDy 的一个关键挑战是设置稀疏性阈值，特别是当候选函数库包含具有不同物理单位和量级的项时。本实践 [@problem_id:2862870] 通过探索特征归一化如何使阈值化过程变得稳健且具有物理意义，从而解决了这个关键的实现细节，确保所选模型不是任意缩放造成的人为结果。", "problem": "您正在使用稀疏非线性动力学辨识（SINDy）方法对一个状态为 $x(t)$ 的单状态连续时间系统进行建模。您收集了快照对 $\\{x(t_k), \\dot{x}(t_k)\\}_{k=1}^{m}$，并构建了一个库矩阵 $\\Theta(X) \\in \\mathbb{R}^{m \\times p}$，其列由 $x$ 的候选函数组成，以及一个目标向量 $y \\in \\mathbb{R}^{m}$，其中包含 $\\dot{x}(t_k)$。对于每个状态，SINDy 求解一个形如 $y \\approx \\Theta(X)\\,\\xi$ 的线性回归问题，并使用序列阈值最小二乘法（STLSQ），该方法在最小二乘估计和基于阈值对 $\\xi$ 的条目进行硬阈值处理之间交替进行。\n\n为了使 STLSQ 中的阈值处理在具有不同物理单位和量级的特征之间具有物理意义和鲁棒性，您决定通过一个对角矩阵 $S = \\mathrm{diag}(s_1,\\dots,s_p)$ 来重新缩放 $\\Theta(X)$ 的列，以形成一个归一化的库 $Z = \\Theta(X)\\,S^{-1}$。您的设计要求是，归一化应 (i) 通过除以基于每个特征的量纲和为数据集选择的特征基本单位尺度而得到的适当特征单位尺度，来消除 $Z$ 的每一列的单位，以及 (ii) 通过将现在无量纲的每一列除以其在 $m$ 个快照上的样本标准差来平衡量级。在此归一化之后，您在 STLSQ 内部对与归一化库相关的系数应用单个硬阈值 $\\Lambda$。\n\n仅从最小二乘回归和硬阈值处理的定义出发，完成以下任务：\n\n1) 以闭合形式推导，在通过 $S$ 进行列缩放的情况下，系数向量如何变化，以及应用于归一化系数的单个硬阈值 $\\Lambda$ 如何转化为对原始未缩放系数的依赖于特征的有效硬阈值。您的推导必须从最小二乘法的正规方程、硬阈值处理的定义以及列缩放下预测的线性代数不变性出发，而不假设任何连接缩放和阈值的预知公式。\n\n2) 考虑一个具体案例，从一个包含两列 $[x, x^2]$ 的库中对 $\\dot{x}(t)$ 进行建模。状态 $x$ 的单位是米。您选择一个特征长度尺度 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$ 来对 $x$ 进行无量纲化，并估计无量纲列在 $m$ 个快照上的样本标准差如下：$\\mathrm{std}(x/L_{\\mathrm{c}}) = 0.80$ 和 $\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。您决定在对与归一化库 $Z$ 相关的系数进行阈值处理时，使用单个硬阈值 $\\Lambda = 0.15\\,\\mathrm{m/s}$。\n\n根据您在第 1) 部分中推导的表达式，乘以 $x^2$ 列的未缩放系数的最终有效硬阈值是多少？请以 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$ 为单位表示最终数值，并将您的答案四舍五入到四位有效数字。", "solution": "所陈述的问题具有科学依据、提法恰当、客观且内部一致。它在动力系统的数据驱动建模这一既定领域内提出了一个有效的问题，特别是关于 SINDy 算法的实际实现。所提供的信息足以得出一个完整且唯一的解。因此，我将继续进行推导和计算。\n\n这个问题的核心在于理解特征空间（库矩阵的列）的线性变换如何影响线性回归模型中的系数，以及因此，像硬阈值处理这样的非线性操作在这些系数上的应用。\n\n设未缩放的回归问题为\n$$ y \\approx \\Theta \\xi $$\n其中 $y \\in \\mathbb{R}^{m}$ 是时间导数向量，$\\Theta \\in \\mathbb{R}^{m \\times p}$ 是候选函数库，$\\xi \\in \\mathbb{R}^{p}$ 是我们试图辨识的系数向量。普通最小二乘估计 $\\xi_{LS}$ 最小化残差的欧几里得范数的平方 $\\|y - \\Theta \\xi\\|_{2}^{2}$，并通过求解正规方程得到：\n$$ \\Theta^{T} \\Theta \\xi_{LS} = \\Theta^{T} y $$\n\n问题引入了一个缩放后的库 $Z = \\Theta S^{-1}$，其中 $S = \\mathrm{diag}(s_1, \\dots, s_p)$ 是一个对角缩放因子矩阵。现在，回归是针对缩放后库的一个新系数向量 $\\zeta \\in \\mathbb{R}^{p}$ 进行的：\n$$ y \\approx Z \\zeta $$\n$\\zeta$ 的最小二乘解，我们记作 $\\zeta_{LS}$，由相应的正规方程给出：\n$$ Z^{T} Z \\zeta_{LS} = Z^{T} y $$\n\n被辨识的物理模型与为库选择的基无关。因此，预测必须在这种重新缩放下保持不变：\n$$ \\Theta \\xi = Z \\zeta $$\n代入定义 $Z = \\Theta S^{-1}$，我们有：\n$$ \\Theta \\xi = (\\Theta S^{-1}) \\zeta $$\n假设 $\\Theta$ 的列是线性无关的（这是一个适定最小二乘问题的标准要求，意味着 $\\Theta^{T} \\Theta$ 是可逆的），我们可以通过左乘 $(\\Theta^{T} \\Theta)^{-1} \\Theta^{T}$ 来找到系数向量之间的唯一关系：\n$$ \\xi = S^{-1} \\zeta $$\n或者，等价地，\n$$ \\zeta = S \\xi $$\n这直接显示了在库的列缩放下，系数向量是如何变换的。缩放后系数向量的第 $j$ 个分量 $\\zeta_j$ 与未缩放向量的第 $j$ 个分量 $\\xi_j$ 通过 $\\zeta_j = s_j \\xi_j$ 相关联。\n\n现在，我们考虑在序列阈值最小二乘法（STLSQ）算法中使用的硬阈值处理步骤。将单个阈值 $\\Lambda$ 应用于与归一化库 $Z$ 相关联的系数向量 $\\zeta$ 的分量。如果系数 $\\zeta_j$ 的绝对值小于该阈值，则将其设为零：\n$$ \\text{若 } |\\zeta_j|  \\Lambda \\text{，则令 } \\zeta_j \\to 0 $$\n为了找到对原始未缩放系数 $\\xi_j$ 的等效、依赖于特征的阈值，我们将关系 $\\zeta_j = s_j \\xi_j$ 代入阈值条件中：\n$$ |s_j \\xi_j|  \\Lambda $$\n由于缩放因子 $s_j$ 是正实数（代表物理尺度和标准差），我们可以写成：\n$$ |\\xi_j|  \\frac{\\Lambda}{s_j} $$\n这表明，在缩放域中应用统一阈值 $\\Lambda$ 等同于在原始未缩放域中应用依赖于特征的阈值 $\\lambda_j = \\Lambda/s_j$。这就完成了问题的第一部分。\n\n对于第二部分，我们必须将此结果应用于给定的具体案例。未缩放的库是 $\\Theta = [x, x^2]$，所以特征列是 $\\theta_1(x) = x$ 和 $\\theta_2(x) = x^2$。我们关心的是乘以 $x^2$ 列的系数 $\\xi_2$ 的有效阈值。根据我们的推导，这个有效阈值是 $\\lambda_2 = \\Lambda/s_2$。\n\n我们必须确定缩放因子 $s_2$。问题陈述了归一化包含两个步骤。首先，使用特征尺度使特征无量纲化。其次，将得到的无量纲特征除以其样本标准差。\n\n第二列中的特征是 $\\theta_2 = x^2$。状态 $x$ 的单位是米 ($\\mathrm{m}$)。因此，$\\theta_2$ 的单位是 $\\mathrm{m}^2$。\n1.  **无量纲化**：特征长度尺度是 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$。为了使 $x^2$ 无量纲化，我们必须除以一个单位为 $\\mathrm{m}^2$ 的量。使用 $L_c$，这个量是 $L_c^2$。无量纲特征是 $\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2$。\n2.  **量级平衡**：然后将得到的无量纲列除以其样本标准差。问题提供了这个值：$\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。\n\n结合这两个步骤，完全归一化的第二列 $z_2$ 是：\n$$ z_2 = \\frac{\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2}{\\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right)} = \\frac{\\theta_2}{L_{\\mathrm{c}}^2 \\cdot \\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right)} $$\n根据缩放库的定义，我们有 $z_2 = \\theta_2 / s_2$。通过比较 $z_2$ 的两个表达式，我们辨识出缩放因子 $s_2$：\n$$ s_2 = L_{\\mathrm{c}}^2 \\cdot \\mathrm{std}\\left(\\left(\\frac{x}{L_{\\mathrm{c}}}\\right)^2\\right) $$\n我们已知数值 $L_{\\mathrm{c}} = 2\\,\\mathrm{m}$ 和 $\\mathrm{std}((x/L_{\\mathrm{c}})^2) = 0.70$。我们现在可以计算 $s_2$ 的数值：\n$$ s_2 = (2\\,\\mathrm{m})^2 \\cdot 0.70 = 4\\,\\mathrm{m}^2 \\cdot 0.70 = 2.8\\,\\mathrm{m}^2 $$\n现在我们求有效阈值 $\\lambda_2$。我们已知在缩放域中的阈值是 $\\Lambda = 0.15\\,\\mathrm{m/s}$。\n$$ \\lambda_2 = \\frac{\\Lambda}{s_2} = \\frac{0.15\\,\\mathrm{m/s}}{2.8\\,\\mathrm{m}^2} $$\n数值为：\n$$ \\lambda_2 = \\frac{0.15}{2.8} \\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} \\approx 0.0535714... \\,\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1} $$\n单位 $\\mathrm{s}^{-1}\\,\\mathrm{m}^{-1}$ 与模型方程 $\\dot{x} = \\dots + \\xi_2 x^2$ 中系数 $\\xi_2$ 的单位是一致的，其中 $\\dot{x}$ 的单位是 $\\mathrm{m/s}$，$x^2$ 的单位是 $\\mathrm{m}^2$。\n按要求将结果四舍五入到四位有效数字，得到 $0.05357$。", "answer": "$$\n\\boxed{0.05357}\n$$", "id": "2862870"}]}