{"hands_on_practices": [{"introduction": "第一个实践为理解空间滤波奠定了基础。我们将从窄带信号模型和无失真响应约束等基本原理出发，实现传统的巴特利特（Bartlett）波束形成器。通过推导权重向量并计算输出信干噪比（$\\mathrm{SINR}$）和干扰衰减等关键性能指标，您将获得关于简单阵列如何增强期望信号同时抑制不必要信号的实践经验。这项练习 [@problem_id:2853623] 对于掌握所有波束形成技术的核心机制至关重要。", "problem": "考虑一个窄带平面波信号模型，以时间频率 $f_0$ 入射到由 $M$ 个传感器组成的均匀线性阵列 (ULA) 上。该阵列的阵元间距为 $d$，信号传播速度为 $c$。设波数为 $k = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda = \\frac{c}{f_0}$。定义方位角 $\\theta$（从法线方向算起，单位为度）对应的阵列导向矢量为\n$$\n\\mathbf{a}(\\theta) = \\begin{bmatrix}\n1 & e^{-j k d \\sin(\\theta\\,\\pi/180)} & \\cdots & e^{-j k d (M-1) \\sin(\\theta\\,\\pi/180)}\n\\end{bmatrix}^{\\mathsf{T}} \\in \\mathbb{C}^{M}.\n$$\n假设窄带阵列数据模型为\n$$\n\\mathbf{x} = \\mathbf{a}(\\theta_0)\\, s + \\mathbf{a}(\\theta_i)\\, u + \\mathbf{n},\n$$\n其中 $s$ 和 $u$ 分别是功率为 $\\sigma_s^2$ 和 $\\sigma_u^2$ 的零均值、圆对称复高斯随机变量，而 $\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$ 是功率为 $\\sigma_n^2$ 的空间和时间白噪声。角度单位为度，三角函数内部使用弧度。\n\n你需要通过构建一个权重矢量 $\\mathbf{w}$ 来为期望的观测方向 $\\theta_0$ 实现Bartlett（常规延迟求和）波束形成器，该权重矢量需要满足对 $\\theta_0$ 方向的无失真响应约束，即 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$。从窄带平面波模型和无失真约束出发，仅使用这些基本原理来构建 $\\mathbf{w}$。\n\n将波束形成器的输出信干噪比 (SINR) 定义为\n$$\n\\mathrm{SINR}_{\\text{out}} = \\frac{\\text{输出信号功率}}{\\text{输出干扰功率} + \\text{输出噪声功率}},\n$$\n该值由 $s、u、\\mathbf{n}$ 的二阶矩以及线性形式 $y = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}$ 直接计算得出。同样，将以分贝 (dB) 为单位的干扰衰减定义为波束形成器在干扰方向上的功率增益的负值，\n$$\nA_i \\text{ (dB)} = -10 \\log_{10}\\!\\left(\\left|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)\\right|^2\\right).\n$$\n报告以分贝 (dB) 为单位的 $\\mathrm{SINR}_{\\text{out}}$ 和以分贝 (dB) 为单位的 $A_i$。角度单位为度。所有对数均以 10 为底。将所有报告的数字四舍五入到恰好四位小数。\n\n实现一个程序，对于下方的每个测试案例，依次计算并输出数对 $\\left[\\mathrm{SINR}_{\\text{out}}\\ \\text{(dB)},\\ A_i\\ \\text{(dB)}\\right]$。将所有案例的所有结果聚合到一个扁平列表中，并按照最终输出格式的要求在一行上打印。\n\n对每个测试案例都使用半波长阵元间距 $d = \\lambda/2$。\n\n测试套件（角度单位为度；$c$ 单位为米/秒；$f_0$ 单位为赫兹；功率为线性单位）：\n- 案例 1：$M=8$, $f_0=1500$, $c=1500$, $\\theta_0=20$, $\\theta_i=-30$, $\\sigma_s^2=1.0$, $\\sigma_u^2=10.0$, $\\sigma_n^2=1.0$。\n- 案例 2：$M=8$, $f_0=1500$, $c=1500$, $\\theta_0=10$, $\\theta_i=10$, $\\sigma_s^2=1.0$, $\\sigma_u^2=1.0$, $\\sigma_n^2=1.0$。\n- 案例 3：$M=1$, $f_0=1500$, $c=1500$, $\\theta_0=0$, $\\theta_i=30$, $\\sigma_s^2=2.0$, $\\sigma_u^2=3.0$, $\\sigma_n^2=4.0$。\n- 案例 4：$M=16$, $f_0=3000$, $c=1500$, $\\theta_0=0$, $\\theta_i=60$, $\\sigma_s^2=1.0$, $\\sigma_u^2=100.0$, $\\sigma_n^2=1.0$。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个方括号括起来的、以逗号分隔的数字列表，该列表是按给定顺序将每个案例的数对扁平化得到的。也就是说，输出必须是 $[\\mathrm{SINR}_{1},A_{i,1},\\mathrm{SINR}_{2},A_{i,2},\\mathrm{SINR}_{3},A_{i,3},\\mathrm{SINR}_{4},A_{i,4}]$ 的形式，其中每个数字都四舍五入到恰好四位小数，并以分贝 (dB) 表示。", "solution": "该问题要求针对均匀线性阵列 (ULA) 推导并实现一个 Bartlett 波束形成器，并计算其性能，具体包括输出信干噪比 ($\\mathrm{SINR}_{\\text{out}}$) 和干扰衰减 ($A_i$)。分析将基于所提供的窄带平面波信号模型。\n\n首先，我们推导 Bartlett 波束形成器的权重矢量 $\\mathbf{w} \\in \\mathbb{C}^{M}$。Bartlett 波束形成器旨在期望观测方向 $\\theta_0$ 上具有最大响应，同时满足某些约束条件。问题中指定了该方向上的无失真响应约束，其表达式为 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$。常规（或 Bartlett）波束形成器可以通过在空间白噪声背景下，最大化来自期望方向 $\\theta_0$ 的信号的输出信噪比 (SNR) 来推导。\n\n来自方向 $\\theta_0$ 的阵列数据中的信号分量是 $\\mathbf{x}_s = \\mathbf{a}(\\theta_0)s$。该信号产生的波束形成器输出为 $y_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)s$。输出信号功率是 $P_s^{\\text{out}} = E[|y_s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 E[|s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2$。噪声分量是 $\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$，相应的输出噪声是 $y_n = \\mathbf{w}^{\\mathsf{H}} \\mathbf{n}$。输出噪声功率是 $P_n^{\\text{out}} = E[|y_n|^2] = E[\\mathbf{w}^{\\mathsf{H}} \\mathbf{n} \\mathbf{n}^{\\mathsf{H}} \\mathbf{w}] = \\mathbf{w}^{\\mathsf{H}} E[\\mathbf{n} \\mathbf{n}^{\\mathsf{H}}] \\mathbf{w} = \\mathbf{w}^{\\mathsf{H}} (\\sigma_n^2 \\mathbf{I}_M) \\mathbf{w} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$。\n\n因此，输出信噪比为 $\\mathrm{SNR} = \\frac{P_s^{\\text{out}}}{P_n^{\\text{out}}} = \\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2}{\\sigma_n^2 \\|\\mathbf{w}\\|_2^2}$。为最大化此信噪比，我们必须最大化项 $\\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|}{\\|\\mathbf{w}\\|_2}$。根据柯西-施瓦茨不等式，有 $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)| \\leq \\|\\mathbf{w}\\|_2 \\|\\mathbf{a}(\\theta_0)\\|_2$。当 $\\mathbf{w}$ 与 $\\mathbf{a}(\\theta_0)$ 共线时，即对于某个标量 $\\alpha$ 有 $\\mathbf{w} = \\alpha \\mathbf{a}(\\theta_0)$ 时，达到最大值。\n\n我们应用无失真响应约束 $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$ 来确定 $\\alpha$。\n$$ (\\alpha \\mathbf{a}(\\theta_0))^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\mathbf{a}(\\theta_0)^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\|\\mathbf{a}(\\theta_0)\\|_2^2 = 1 $$\n导向矢量的元素为 $a_m(\\theta_0) = e^{-j k d (m-1) \\sin(\\theta_0\\pi/180)}$，其模为 1。因此，$\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\sum_{m=0}^{M-1} |a_m(\\theta_0)|^2 = \\sum_{m=0}^{M-1} 1 = M$。由此可得 $\\bar{\\alpha} M = 1$，所以 $\\alpha = 1/M$。因此，Bartlett 权重矢量为：\n$$ \\mathbf{w} = \\frac{1}{M} \\mathbf{a}(\\theta_0) $$\n\n接下来，我们计算输出信干噪比。波束形成器输出为 $y = \\mathbf{w}^{\\mathsf{H}}\\mathbf{x}$。给定数据模型 $\\mathbf{x} = \\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}$，输出为：\n$$ y = \\mathbf{w}^{\\mathsf{H}}(\\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}) = (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0))s + (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i))u + \\mathbf{w}^{\\mathsf{H}}\\mathbf{n} $$\n由于 $s$、$u$ 和 $\\mathbf{n}$ 是零均值且不相关的，总输出功率是信号、干扰和噪声分量功率之和。\n使用无失真约束，输出信号功率为 $P_s^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0)|^2 \\sigma_s^2 = 1^2 \\cdot \\sigma_s^2 = \\sigma_s^2$。输出干扰功率为 $P_u^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2$。输出噪声功率为 $P_n^{\\text{out}} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$。代入 $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$，我们得到 $P_n^{\\text{out}} = \\sigma_n^2 \\|\\frac{1}{M}\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}M = \\frac{\\sigma_n^2}{M}$。\n\n输出信干噪比定义为 $\\mathrm{SINR}_{\\text{out}} = \\frac{P_s^{\\text{out}}}{P_u^{\\text{out}} + P_n^{\\text{out}}}$。代入推导出的各项：\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{|\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2 + \\frac{\\sigma_n^2}{M}} $$\n代入 $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$：\n$$ |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 = \\left|\\left(\\frac{1}{M}\\mathbf{a}(\\theta_0)\\right)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)\\right|^2 = \\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 $$\n所以，SINR 表达式变为：\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{\\frac{\\sigma_u^2}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + \\frac{\\sigma_n^2}{M}} = \\frac{M^2 \\sigma_s^2}{\\sigma_u^2 |\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + M \\sigma_n^2} $$\n该值通过 $\\mathrm{SINR}_{\\text{out}} \\text{ (dB)} = 10 \\log_{10}(\\mathrm{SINR}_{\\text{out}})$ 转换为分贝 (dB)。\n\n干扰衰减 $A_i$ 定义为 $A_i \\text{ (dB)} = -10 \\log_{10}(|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2)$。代入增益项 $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2$ 的表达式：\n$$ A_i \\text{ (dB)} = -10 \\log_{10}\\left(\\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2\\right) $$\n\n对于所有测试案例，阵元间距为 $d = \\lambda/2$。波数为 $k = 2\\pi/\\lambda$。因此，乘积 $kd = (2\\pi/\\lambda)(\\lambda/2) = \\pi$。导向矢量 $\\mathbf{a}(\\theta)$ 的第m个元素（从0开始索引）为 $e^{-j \\pi m \\sin(\\theta\\pi/180)}$。项 $|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2$ 的计算方法是：首先构建矢量 $\\mathbf{a}(\\theta_0)$ 和 $\\mathbf{a}(\\theta_i)$，然后计算它们矢量内积的模的平方。将每个测试案例的参数代入这些推导出的公式中即可得到最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the output SINR and interference attenuation for a Bartlett beamformer\n    for a set of test cases.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2)\n    test_cases = [\n        (8, 1500, 1500, 20, -30, 1.0, 10.0, 1.0),\n        (8, 1500, 1500, 10, 10, 1.0, 1.0, 1.0),\n        (1, 1500, 1500, 0, 30, 2.0, 3.0, 4.0),\n        (16, 3000, 1500, 0, 60, 1.0, 100.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2 = case\n        \n        # The problem specifies half-wavelength spacing d = lambda/2.\n        # Wavelength lambda = c / f0.\n        # Wavenumber k = 2*pi/lambda.\n        # The term kd in the steering vector exponent becomes:\n        # kd = (2*pi/lambda) * (lambda/2) = pi.\n        # This holds true for all cases where M > 1.\n        kd = np.pi\n        \n        # Steering vector is a(theta) = [1, exp(-j*kd*sin(theta)), ..., exp(-j*kd*(M-1)*sin(theta))]\n        # We compute the inner product term |a(theta0)^H a(theta_i)|^2\n        m_indices = np.arange(M)\n        \n        # Angles need to be in radians for numpy's trigonometric functions.\n        theta0_rad = np.deg2rad(theta0_deg)\n        thetai_rad = np.deg2rad(thetai_deg)\n        \n        # Construct steering vectors\n        a_theta0 = np.exp(-1j * kd * m_indices * np.sin(theta0_rad))\n        a_thetai = np.exp(-1j * kd * m_indices * np.sin(thetai_rad))\n        \n        # Calculate a(theta0)^H * a(thetai) using numpy's vdot for hermitian dot product.\n        inner_product = np.vdot(a_theta0, a_thetai)\n        inner_product_sq = np.abs(inner_product)**2\n        \n        # Calculate output SINR in linear scale\n        # SINR_out = (M^2 * sigma_s^2) / (sigma_u^2 * |a_h^H a_i|^2 + M * sigma_n^2)\n        numerator_sinr = (M**2) * sigma_s2\n        denominator_sinr = sigma_u2 * inner_product_sq + M * sigma_n2\n        sinr_linear = numerator_sinr / denominator_sinr\n        \n        # Convert SINR to dB\n        sinr_db = 10 * np.log10(sinr_linear)\n        \n        # Calculate Interference Attenuation in dB\n        # A_i = -10 * log10(|w^H a_i|^2)\n        # |w^H a_i|^2 = |(1/M * a_0^H) a_i|^2 = (1/M^2) * |a_0^H a_i|^2\n        interferer_gain_sq = inner_product_sq / (M**2)\n        Ai_db = -10 * np.log10(interferer_gain_sq)\n\n        # Append rounded results to the list\n        results.append(sinr_db)\n        results.append(Ai_db)\n\n    # Format the final output string as per requirements\n    # Each number must be represented with exactly four decimal places.\n    output_str = \"[\" + \",\".join(f\"{x:.4f}\" for x in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2853623"}, {"introduction": "虽然窄带模型很有用，但许多现实世界的信号都是宽带的，这对简单的移相器构成了挑战。这项实践 [@problem_id:2853637] 通过探索真延时（True Time-Delay, TTD）波束形成器的设计来应对这一挑战，该波束形成器可在很宽的频率范围内保持一致的波束方向图。您将学习如何将所需的时间延迟转化为实际的有限脉冲响应（FIR）滤波器，并确定满足严格性能指标所需的滤波器复杂度，从而弥合阵列理论与数字滤波器设计之间的鸿沟。", "problem": "考虑一个由 $K$ 个各向同性传感器组成的均匀线性阵列（ULA），阵元间距为 $d$，置于传播速度为 $c$ 的声学介质中。一个远场、平面波、宽带源从俯仰角 $\\theta_0$（从侧射方向测量）入射。接收信号的采样率为 $f_s$。要求您通过为每个传感器实现离散时间分数延迟滤波器来施加与传感器相关的传播延迟 $\\{\\tau_m\\}_{m=0}^{K-1}$，从而在信号频带 $[f_1,f_2]$ 内，在视向 $\\theta_0$ 上实现一个真实时间延迟波束形成器。目标是在整个频带 $[f_1,f_2]$ 内，在视向方向上保持无失真（单位幅度）响应，直至达到预设的通带波纹容限。\n\n从基本原理出发，使用以下基础：\n- 真实时间延迟波束形成器在视向上的波束方向图等于传感器输出的相干和，如果每个传感器所需的连续时间延迟由频率响应为 $H_m(\\omega)$ 的离散时间滤波器实现，那么当所有传感器使用相同的分数延迟滤波器时，在视向上的总体幅度响应等于每个传感器共同的幅度 $|H_m(\\omega)|$。\n- 一个 $D$ 采样点的理想离散时间分数延迟的频率响应为 $H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$，其幅度是全通的。\n- 在预设通带上近似 $H_{\\text{ideal}}(\\omega)$ 的一种标准且经过充分测试的方法是，使用Kaiser窗对理想脉冲响应进行加窗截断，从而得到一个实系数、线性相位的有限脉冲响应（FIR）近似，其通带波纹和过渡带宽度由窗参数控制。对于通带和阻带波纹均为 $\\delta$、过渡带宽度为 $\\Delta\\Omega$（单位：弧度/采样点）的Kaiser窗FIR设计，保证指定波纹的常用长度估计为\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad A \\triangleq -20\\log_{10}(\\delta).\n$$\n\n利用此框架论证，当通带波纹受 $\\delta$ 限制时，每个传感器的分数延迟FIR滤波器如何确保波束形成器的视向响应是无失真的，然后确定所需的最小整数滤波器阶数 $N_{\\min}$，以保证在 $[f_1,f_2]$ 范围内，视向波束方向图的幅度与1的偏差不超过 $\\delta$。\n\n用于评估的数值规格：\n- 传感器数量 $K=16$。\n- 传播速度 $c=343\\,\\text{m/s}$。\n- 视向 $\\theta_0=30^\\circ$。\n- 采样频率 $f_s=48{,}000\\,\\text{Hz}$。\n- 信号频带 $[f_1,f_2]=[3{,}000,\\,7{,}000]\\,\\text{Hz}$。\n- 在两个频带边缘，强制与相邻阻带之间有相等的过渡带宽度 $\\Delta f=1{,}000\\,\\text{Hz}$。\n- 通带波纹容限 $\\delta=0.005$（即，允许的最大幅度偏差为 $0.005$）。\n\n假设使用相同的每传感器分数延迟滤波器，每个滤波器都（通过对理想分数延迟脉冲响应进行Kaiser加窗）设计为在频带 $[f_1,f_2]$ 上满足上述波纹和过渡带宽度规格。计算保证无失真视向约束的最小整数滤波器阶数 $N_{\\min}$。最终答案必须是单个整数 $N_{\\min}$。不需要单位。如果需要对任何中间的非整数长度进行取整，请取仍能保证规格的最小整数（即，向上取整到下一个整数）。", "solution": "首先，我们必须严格审查问题陈述的有效性。我们通过形式化给定的信息和约束条件来进行。\n\n给定条件如下：\n- 阵列配置：由 `$K=16$` 个各向同性传感器组成的均匀线性阵列（ULA），阵元间距为 `$d$`。\n- 声学介质传播速度：`$c=343\\,\\text{m/s}$`。\n- 感兴趣的源方向（视向）：`$\\theta_0=30^\\circ$`。\n- 系统采样率：`$f_s=48{,}000\\,\\text{Hz}$`。\n- 期望的工作频带：`$[f_1, f_2] = [3{,}000, 7{,}000]\\,\\text{Hz}$`。\n- 波束形成器实现：通过每个传感器的分数延迟有限脉冲响应（FIR）滤波器实现真实时间延迟。\n- 滤波器设计通带波纹容限：`$\\delta=0.005$`。\n- 滤波器设计过渡带宽度：`$\\Delta f=1{,}000\\,\\text{Hz}$`。\n- 基本前提1：波束形成器的视向幅度响应等于相同传感器滤波器的共同幅度响应 `$|H_m(\\omega)|$`。\n- 基本前提2：理想离散时间分数延迟滤波器的频率响应为 `$H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$`，其幅度为单位幅度。\n- 基本前提3：FIR滤波器是通过使用Kaiser窗对理想脉冲响应进行加窗来设计的。所需的滤波器长度 `$L$` 通过以下公式估算：\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad \\text{where } A = -20\\log_{10}(\\delta).\n$$\n\n对这些前提的批判性审视表明，这是一个科学上合理、内部一致且适定的问题。该场景是阵列信号处理中的一个标准应用。使用Kaiser窗的滤波器设计方法以及相关的滤波器长度经验公式在数字信号处理中是经典方法。计算所需滤波器阶数的所有必要数值都已提供。问题明确且客观。因此，该问题被认为是有效的，我们将着手构建解决方案。\n\n第一个目标是论证滤波器设计约束如何确保一个近乎无失真的视向响应。\n视向上的无失真响应意味着，对于信号频带内的所有频率，波束形成器频率响应的幅度均为1。问题陈述指出，总体的视向幅度响应等于单个FIR滤波器的幅度响应 `$|H_m(\\omega)|$`。我们试图近似的理想滤波器是一个分数延迟滤波器，它具有恒定的单位幅度响应。通带波纹容限 `$\\delta$` 量化了我们实际滤波器的幅度响应与理想单位增益之间的最大允许偏差。具体来说，对于通带 `$f \\in [f_1, f_2]$` 内的任何频率 `$f$`，滤波器的幅度响应 `$|H_m(\\omega)|$`（其中 `$\\omega = 2\\pi f$`）被限制在 `$[1-\\delta, 1+\\delta]$` 范围内。由于波束形成器的视向响应与此相同，直接可以得出，视向上的波束方向图幅度与1的偏差将不超过 `$\\delta$`。这正是实现“在预设通带波纹容限内无失真”响应的直接含义。\n\n第二个目标是计算满足指定约束所需的最小整数滤波器阶数 `$N_{\\min}$`。FIR滤波器的阶数 `$N$` 与其长度 `$L$` 的关系为 `$N = L-1$`。我们必须首先使用给定的公式找到所需的最小长度 `$L_{\\min}$`。\n\n步骤1：计算衰减参数 `$A$`。\n参数 `$A$` 由通带波纹 `$\\delta = 0.005$` 确定。\n$$A = -20\\log_{10}(\\delta) = -20\\log_{10}(0.005)$$\n$$A = -20\\log_{10}(5 \\times 10^{-3}) = -20(\\log_{10}(5) - 3)$$\n使用值 `$\\log_{10}(5) \\approx 0.698970$`：\n$$A \\approx -20(0.698970 - 3) = -20(-2.301030) \\approx 46.0206$$\n\n步骤2：计算归一化过渡带宽度 `$\\Delta\\Omega$`。\n过渡带宽度以赫兹为单位给出，为 `$\\Delta f = 1{,}000\\,\\text{Hz}$`。采样频率为 `$f_s = 48{,}000\\,\\text{Hz}$`。归一化角频率（单位：弧度/采样点）下的过渡带宽度为：\n$$\\Delta\\Omega = 2\\pi \\frac{\\Delta f}{f_s} = 2\\pi \\frac{1{,}000}{48{,}000} = \\frac{2\\pi}{48} = \\frac{\\pi}{24}$$\n\n步骤3：计算最小滤波器长度 `$L_{\\min}$`。\n我们将 `$A$` 和 `$\\Delta\\Omega$` 的值代入给定的滤波器长度 `$L$` 的不等式中。\n$$L \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1$$\n$$L \\ge \\frac{46.0206 - 8}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1 = \\frac{38.0206}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1$$\n计算分母：`$2.285 \\times \\frac{\\pi}{24} \\approx 0.2990833$`。\n$$L \\ge \\frac{38.0206}{0.2990833} + 1 \\approx 127.1258 + 1 = 128.1258$$\n由于滤波器长度 `$L$` 必须是整数，我们必须选择满足此条件的最小整数值。这可以通过对计算出的下界进行向上取整得到。\n$$L_{\\min} = \\lceil 128.1258 \\rceil = 129$$\n\n步骤4：计算最小滤波器阶数 `$N_{\\min}$`。\n滤波器阶数 `$N$` 比其长度 `$L$` 小一。\n$$N_{\\min} = L_{\\min} - 1 = 129 - 1 = 128$$\n\n值得注意的是，参数 `$K$`、`$c$` 和 `$\\theta_0$` 与波束形成的物理问题相关，但对于滤波器阶数的具体计算并非必需。滤波器的复杂度由其频域规格（`$\\delta$` 和 `$\\Delta\\Omega$`）决定，而不是由其实现的具体分数延迟值决定。问题假设选择这些规格是为了适应整个阵列所需的延迟范围。", "answer": "$$\\boxed{128}$$", "id": "2853637"}, {"introduction": "超越固定波束形成器，像最小方差无失真响应（Minimum Variance Distortionless Response, MVDR）波束形成器这样的自适应技术可以通过从数据中学习来提供明显更好的干扰抑制能力。然而，这种能力伴随着实际挑战，最突出的是当样本协方差矩阵是病态的时出现的数值不稳定性。这项高级实践 [@problem_id:2853647] 直面这个现实世界的问题，引导您分析不稳定的根源，并评估对角加载、QR分解和基于特征值分解（EVD）的正则化等鲁棒的解决方案，这些都是构建可靠自适应系统的关键。", "problem": "一个由 $M$ 个传感器组成的均匀线性阵列采集了 $N$ 个复窄带数据的时间快照。目标是设计最小方差无失真响应 (MVDR) 波束形成器，该波束形成器在期望方向上保持无失真响应的同时，最小化输出功率。样本协方差矩阵为 $\\hat{R} = \\tfrac{1}{N} X X^{H}$，其中 $X \\in \\mathbb{C}^{M \\times N}$ 是由 $N$ 个阵列快照堆叠而成的矩阵。在一个有 $M=16$ 个传感器和 $N=40$ 个快照的场景中，相干干扰的存在导致估计的条件数 $\\kappa(\\hat{R}) \\approx 10^{10}$，并且在尝试直接对 $\\hat{R}$ 求逆时观察到了数值问题。要求您评估在此条件下计算 MVDR 解的数值稳定性，比较用于求解所需线性系统的 Cholesky 分解、正交三角 (QR) 分解和特征值分解 (EVD) 方法，并推荐能够在不违反无失真约束的情况下提高稳定性的正则化策略。\n\n选择所有正确的陈述。\n\nA. 在这种情况下，尝试通过对样本协方差矩阵进行 Cholesky 分解而不进行正则化来计算波束形成器，很可能会不稳定或在数值上失败；添加对角加载 $\\lambda I$（其中 $\\lambda$ 与噪声方差相当）会产生一个严格正定系统，并且在通过归一化强制执行约束后，能够精确地保持无失真响应。\n\nB. 使用数据矩阵 $X$ 的正交三角 (QR) 分解来求解所需的线性系统（从而避免了显式构造和求逆 $\\hat{R}=\\tfrac{1}{N} X X^{H}$）可以将条件数从 $\\kappa(\\hat{R})$ 降低到约 $\\kappa(X)=\\sqrt{\\kappa(\\hat{R})}$，从而提高数值稳定性。\n\nC. 采用特征值分解 (EVD) 并进行特征值保底（即用 $\\tilde{\\Lambda}_{ii}=\\max(\\Lambda_{ii},\\lambda)$ 的 $\\tilde{\\Lambda}$ 替换 $\\Lambda$）实现了一种 Tikhonov 正则化；另外，收缩估计 $\\hat{R}_{\\text{shr}}=(1-\\alpha)\\hat{R}+\\alpha \\sigma^{2} I$（其中 $\\alpha \\in (0,1)$ 由数据驱动）即使在 $N<M$ 的情况下也能提供良好条件的全秩估计。", "solution": "当前的问题涉及最小方差无失真响应 (MVDR) 波束形成器的数值稳定性。我将首先正式陈述该问题，然后对每个陈述进行严格评估。\n\nMVDR 波束形成器的目标是找到一个权重向量 $w \\in \\mathbb{C}^{M}$，该向量解决以下优化问题：\n$$ \\min_{w} w^H \\hat{R} w \\quad \\text{subject to} \\quad w^H a(\\theta_0) = 1 $$\n此处，$w^H \\hat{R} w$ 是输出功率，$\\hat{R} = \\frac{1}{N} X X^{H}$ 是从 $N$ 个数据快照 $X \\in \\mathbb{C}^{M \\times N}$ 导出的 $M \\times M$ 样本协方差矩阵 (SCM)，而 $a(\\theta_0)$ 是对应于期望观测方向 $\\theta_0$ 的导向矢量。约束 $w^H a(\\theta_0) = 1$ 确保了对于从 $\\theta_0$ 方向到达的信号具有无失真响应。\n\n该问题的解析解由拉格朗日乘子法给出：\n$$ w_{MVDR} = \\frac{\\hat{R}^{-1} a(\\theta_0)}{a(\\theta_0)^H \\hat{R}^{-1} a(\\theta_0)} $$\n核心的数值任务是计算向量 $y = \\hat{R}^{-1} a(\\theta_0)$，这等价于求解线性方程组 $\\hat{R} y = a(\\theta_0)$。\n\n问题陈述，对于 $M=16$ 个传感器和 $N=40$ 个快照，SCM 是严重病态的，条件数 $\\kappa(\\hat{R}) \\approx 10^{10}$。由于 $N > M$，理论上 $\\hat{R}$ 是一个满秩矩阵。然而，相干干扰的存在导致 $\\hat{R}$ 的某些特征值极小，从而导致了观察到的病态问题。对于具有大约 $16$ 位十进制精度的标准双精度浮点运算来说， $10^{10}$ 的条件数是有问题的。因此，直接对 $\\hat{R}$ 求逆是不稳定的，并且会放大数值误差。\n\n现在，我将分析每个陈述。\n\nA. 在这种情况下，尝试通过对样本协方差矩阵进行 Cholesky 分解而不进行正则化来计算波束形成器，很可能会不稳定或在数值上失败；添加对角加载 $\\lambda I$（其中 $\\lambda$ 与噪声方差相当）会产生一个严格正定系统，并且在通过归一化强制执行约束后，能够精确地保持无失真响应。\n\nCholesky 分解 $\\hat{R} = L L^H$（其中 $L$ 是下三角矩阵）仅对 Hermitian 正定矩阵有定义。虽然精确的 SCM 是半正定的，但在有限精度算术中，一个条件数 $\\kappa(\\hat{R}) \\approx 10^{10}$ 的病态矩阵很容易因舍入误差而失去其数值上的正定性，导致算法失败（例如，尝试计算负对角元素的平方根）。因此，该陈述的第一部分是正确的。\n添加一个对角加载项 $\\lambda I$，其中 $I$ 是单位矩阵且 $\\lambda > 0$，得到正则化矩阵 $\\hat{R}_{reg} = \\hat{R} + \\lambda I$。设 $\\hat{R}$ 的特征值为 $\\sigma_i \\ge 0$。$\\hat{R}_{reg}$ 的特征值为 $\\sigma_i + \\lambda$。由于 $\\lambda > 0$，$\\hat{R}_{reg}$ 的所有特征值都严格为正。因此，$\\hat{R}_{reg}$ 是严格正定的，非常适合进行 Cholesky 分解。选择与噪声方差相当的 $\\lambda$ 是一种常见且有效的启发式方法，通常被称为 Tikhonov 正则化或鲁棒 Capon 波束形成。\n正则化的权重向量计算为 $w_{reg} = \\frac{\\hat{R}_{reg}^{-1} a(\\theta_0)}{a(\\theta_0)^H \\hat{R}_{reg}^{-1} a(\\theta_0)}$。分母是一个标量归一化因子。此波束形成器在期望方向上的响应为 $w_{reg}^H a(\\theta_0) = \\frac{a(\\theta_0)^H (\\hat{R}_{reg}^{-1})^H a(\\theta_0)}{a(\\theta_0)^H \\hat{R}_{reg}^{-1} a(\\theta_0)}$。由于 $\\hat{R}_{reg}$ 是 Hermitian 矩阵，$(\\hat{R}_{reg}^{-1})^H = \\hat{R}_{reg}^{-1}$，该表达式简化为 $1$。无失真约束通过归一化被精确地保持。该陈述的所有论断都是正确的。\n**结论：正确**\n\nB. 使用数据矩阵 $X$ 的正交三角 (QR) 分解来求解所需的线性系统（从而避免了显式构造和求逆 $\\hat{R}=\\tfrac{1}{N} X X^{H}$）可以将条件数从 $\\kappa(\\hat{R})$ 降低到约 $\\kappa(X)=\\sqrt{\\kappa(\\hat{R})}$，从而提高数值稳定性。\n\n样本协方差矩阵是 $\\hat{R} = \\frac{1}{N} X X^H$。这种形式的矩阵乘积的条件数与原始矩阵 $X$ 的条件数相关，关系为 $\\kappa(\\hat{R}) = \\kappa(X X^H) = (\\kappa(X))^2$。问题陈述 $\\kappa(\\hat{R}) \\approx 10^{10}$，这意味着 $\\kappa(X) \\approx \\sqrt{10^{10}} = 10^5$。$10^5$ 的条件数比 $10^{10}$ 容易处理得多。\n该陈述声称，在数据矩阵 $X$ 上使用基于 QR 的方法可以避免条件数的“平方”效应。这是数值线性代数的一个基本原则。求解法方程 $A^H A x = A^H b$ 的稳定性低于使用 $A$ 的 QR 分解来求解最小二乘问题 $\\min \\|Ax-b\\|$。在我们的背景下，MVDR 问题等价于线性约束最小二乘问题 $\\min_{w} \\|X^H w\\|^2$ subject to $w^H a(\\theta_0) = 1$。此类问题可以使用基于从 $X$ 和 $a(\\theta_0)$ 导出的矩阵的 QR 分解的方法来解决，而无需显式地构造乘积 $X X^H$。这些方法操作的矩阵，其条件数与 $\\kappa(X)$ 相关，而不是 $\\kappa(X)^2$。因此，这种方法确实减轻了病态问题，并提供了一个更稳定的数值解。\n**结论：正确**\n\nC. 采用特征值分解 (EVD) 并进行特征值保底（即用 $\\tilde{\\Lambda}_{ii}=\\max(\\Lambda_{ii},\\lambda)$ 的 $\\tilde{\\Lambda}$ 替换 $\\Lambda$）实现了一种 Tikhonov 正则化；另外，收缩估计 $\\hat{R}_{\\text{shr}}=(1-\\alpha)\\hat{R}+\\alpha \\sigma^{2} I$（其中 $\\alpha \\in (0,1)$ 由数据驱动）即使在 $N<M$ 的情况下也能提供良好条件的全秩估计。\n\nEVD 方法：$\\hat{R} = V \\Lambda V^H$。$\\hat{R}$ 的逆是 $\\hat{R}^{-1} = V \\Lambda^{-1} V^H$。如果 $\\Lambda$ 有非常小的元素，$\\Lambda^{-1}$ 会有非常大的元素，导致不稳定。特征值保底用对角矩阵 $\\tilde{\\Lambda}$ 替换 $\\Lambda$，其中 $\\tilde{\\Lambda}_{ii} = \\max(\\Lambda_{ii}, \\lambda)$。这直接限制了逆特征值的大小，等价于对 $\\hat{R}$ 的一种正则化。这与 Tikhonov 正则化（对角加载）密切相关，两者都旨在通过提升小特征值来改善矩阵的条件。因此，陈述的第一部分是正确的。\n收缩估计：$\\hat{R}_{\\text{shr}} = (1-\\alpha)\\hat{R} + \\alpha \\sigma^2 I$ 是一种正则化 SCM 的著名方法，在随机矩阵理论中有坚实的基础。它将 SCM $\\hat{R}$ 向一个缩放的单位矩阵“收缩”。结果是一个加权平均，它总是正定的（只要 $\\alpha > 0$ 且 $\\sigma^2 > 0$），并且通常比原始 SCM 或任意选择加载水平的对角加载矩阵有更好的条件数。它特别有效，因为最优收缩参数 $\\alpha$ 可以直接从数据中估计（例如，使用 Ledoit-Wolf 估计器）。这种方法在 $N<M$ 的情况下尤其强大，此时 $\\hat{R}$ 是奇异的（秩亏），但 $\\hat{R}_{\\text{shr}}$ 仍然是满秩且条件良好的。该陈述的第二部分也是正确的。\n**结论：正确**", "answer": "$$\\boxed{ABC}$$", "id": "2853647"}]}