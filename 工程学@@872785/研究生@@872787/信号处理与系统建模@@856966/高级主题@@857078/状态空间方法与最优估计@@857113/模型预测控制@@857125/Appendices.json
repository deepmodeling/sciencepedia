{"hands_on_practices": [{"introduction": "本练习聚焦于模型预测控制的核心——预测模型。通过手动展开状态演化方程[@problem_id:2884328]，您将具体理解未来状态如何表示为当前状态和未来控制输入序列的函数，这为后续的优化奠定了基础。", "problem": "在为源于信号处理和系统建模的离散时间、线性时不变状态空间模型设计有限时域模型预测控制（MPC）律的背景下，考虑由基本状态演化定律给出的状态更新方程\n$$x_{k+1}=A x_{k} + B u_{k},$$\n其中状态为 $x_{k} \\in \\mathbb{R}^{2}$，控制输入为 $u_{k} \\in \\mathbb{R}$。MPC中使用的预测模型是通过从当前测量的状态 $x_{0}$ 开始，随时间向前重复应用此基本定律而获得的。给定\n$$A=\\begin{bmatrix}0.9  0 \\\\ 0.1  0.95\\end{bmatrix}, \\quad B=\\begin{bmatrix}1 \\\\ 0\\end{bmatrix}.$$\n仅使用基本递推关系 $x_{k+1}=A x_{k} + B u_{k}$ 和基本原理（不使用预先简化的预测公式），推导出未来三步的预测状态 $x_{3}$ 的闭式解析表达式，该表达式仅依赖于 $x_{0}$ 和输入 $u_{0}, u_{1}, u_{2}$。将您的最终答案表示为单个闭式解析表达式。不需要四舍五入，且变量没有关联单位。", "solution": "该问题陈述具有科学依据、提法恰当、客观且自洽。它提出了线性系统理论中的一个标准任务，是模型预测控制领域的基础。该问题是有效的。\n\n目标是基于初始状态 $x_{0}$ 和控制输入序列 $u_{0}$、$u_{1}$ 和 $u_{2}$，推导出未来三个时间步的状态向量 $x_{3}$ 的表达式。推导必须从基本原理出发，使用离散时间线性时不变系统的基本状态演化定律。\n\n状态更新方程给定为：\n$$x_{k+1} = A x_{k} + B u_{k}$$\n其中 $k$ 是离散时间索引。$k=0$ 时的初始状态是 $x_{0}$。我们将通过递推代入来推导后续时间步的状态。\n\n对于 $k=0$，下一个时间步的状态 $x_{1}$ 为：\n$$x_{1} = A x_{0} + B u_{0}$$\n\n对于 $k=1$，通过对 $x_{1}$ 应用演化定律找到状态 $x_{2}$：\n$$x_{2} = A x_{1} + B u_{1}$$\n将 $x_{1}$ 的表达式代入此方程，得到：\n$$x_{2} = A (A x_{0} + B u_{0}) + B u_{1}$$\n根据矩阵乘法的分配律，上式变为：\n$$x_{2} = A^{2} x_{0} + A B u_{0} + B u_{1}$$\n\n对于 $k=2$，通过对 $x_{2}$ 应用该定律找到状态 $x_{3}$：\n$$x_{3} = A x_{2} + B u_{2}$$\n代入 $x_{2}$ 的表达式，得出：\n$$x_{3} = A (A^{2} x_{0} + A B u_{0} + B u_{1}) + B u_{2}$$\n对矩阵 $A$ 使用分配律，得到未来三步预测的通用闭式表达式：\n$$x_{3} = A^{3} x_{0} + A^{2} B u_{0} + A B u_{1} + B u_{2}$$\n\n问题要求给出给定系统矩阵的特定解析表达式：\n$$A = \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$$\n为了得到最终表达式，我们必须计算矩阵的幂 $A^{2}$、$A^{3}$ 以及乘积 $A B$、$A^{2} B$。\n\n首先，我们计算矩阵 $A$ 的幂：\n$$A^{2} = A A = \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix} \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix} = \\begin{bmatrix} (0.9)(0.9) + (0)(0.1)  (0.9)(0) + (0)(0.95) \\\\ (0.1)(0.9) + (0.95)(0.1)  (0.1)(0) + (0.95)(0.95) \\end{bmatrix} = \\begin{bmatrix} 0.81  0 \\\\ 0.185  0.9025 \\end{bmatrix}$$\n$$A^{3} = A A^{2} = \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix} \\begin{bmatrix} 0.81  0 \\\\ 0.185  0.9025 \\end{bmatrix} = \\begin{bmatrix} (0.9)(0.81) + (0)(0.185)  (0.9)(0) + (0)(0.9025) \\\\ (0.1)(0.81) + (0.95)(0.185)  (0.1)(0) + (0.95)(0.9025) \\end{bmatrix} = \\begin{bmatrix} 0.729  0 \\\\ 0.25675  0.857375 \\end{bmatrix}$$\n\n接下来，我们计算涉及 $B$ 的矩阵-向量乘积：\n$$A B = \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.9 \\\\ 0.1 \\end{bmatrix}$$\n$$A^{2} B = A (A B) = \\begin{bmatrix} 0.9  0 \\\\ 0.1  0.95 \\end{bmatrix} \\begin{bmatrix} 0.9 \\\\ 0.1 \\end{bmatrix} = \\begin{bmatrix} (0.9)(0.9) + (0)(0.1) \\\\ (0.1)(0.9) + (0.95)(0.1) \\end{bmatrix} = \\begin{bmatrix} 0.81 \\\\ 0.185 \\end{bmatrix}$$\n\n将这些计算出的矩阵代入 $x_{3}$ 的通用表达式中：\n$$x_{3} = \\begin{bmatrix} 0.729  0 \\\\ 0.25675  0.857375 \\end{bmatrix} x_{0} + \\begin{bmatrix} 0.81 \\\\ 0.185 \\end{bmatrix} u_{0} + \\begin{bmatrix} 0.9 \\\\ 0.1 \\end{bmatrix} u_{1} + \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} u_{2}$$\n\n通过将依赖于控制输入序列 $U = \\begin{bmatrix} u_{0} \\\\ u_{1} \\\\ u_{2} \\end{bmatrix}$ 的项组合在一起，该表达式可以写得更紧凑：\n$$x_{3} = \\begin{bmatrix} 0.729  0 \\\\ 0.25675  0.857375 \\end{bmatrix} x_{0} + \\begin{bmatrix} 0.81  0.9  1 \\\\ 0.185  0.1  0 \\end{bmatrix} \\begin{bmatrix} u_{0} \\\\ u_{1} \\\\ u_{2} \\end{bmatrix}$$\n这就是所要求的未来三步预测状态 $x_{3}$ 的单个闭式解析表达式。", "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n0.729  0 \\\\\n0.25675  0.857375\n\\end{bmatrix}\nx_{0} + \n\\begin{bmatrix}\n0.81  0.9  1 \\\\\n0.185  0.1  0\n\\end{bmatrix}\n\\begin{bmatrix}\nu_{0} \\\\\nu_{1} \\\\\nu_{2}\n\\end{bmatrix}\n}\n$$", "id": "2884328"}, {"introduction": "在预测模型的基础上，本练习旨在搭建系统动力学与数值优化之间的桥梁。您将通过推导“压缩Hessian矩阵”，把带有二次代价的MPC问题转化为标准的二次规划（QP）形式[@problem_id:2884304]，这是实现高效MPC算法的关键一步。", "problem": "考虑一个标准模型预测控制 (MPC) 框架下的离散时间、线性时不变标量系统：\n$$x_{k+1} = A x_{k} + B u_{k},$$\n其中给定参数 $A = 0.8$ 和 $B = 1$。设长度为 $N = 3$ 的有限时域代价为\n$$J = \\sum_{k=0}^{N-1} \\left( x_{k}^{\\top} Q x_{k} + u_{k}^{\\top} R u_{k} \\right),$$\n其中 $Q = 1$ 且 $R = 0.1$。不存在终端状态惩罚，即终端权重为零。引入堆叠输入向量\n$$U = \\begin{pmatrix} u_{0} \\\\ u_{1} \\\\ u_{2} \\end{pmatrix},$$\n并将代价写成标准二次规划 (QP) 形式\n$$J(U) = \\frac{1}{2} U^{\\top} H U + f^{\\top} U + c,$$\n其中 $H$ 是仅取决于系统矩阵和代价权重的紧凑 Hessian 矩阵，$f$ 取决于初始条件 $x_{0}$，$c$ 是一个与 $U$ 无关的常数。仅从状态更新方程和有限时域代价定义出发，为时域内的堆叠状态建立预测模型，并针对给定的数值显式地推导紧凑 Hessian 矩阵 $H$。你可以假设堆叠预测状态为\n$$X = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix},$$\n并且终端权重为零。将 $H$ 计算为一个 $3 \\times 3$ 的数值矩阵。无需四舍五入；请报告精确的小数值。最终答案必须是显式矩阵 $H$。", "solution": "所提出的问题是模型预测控制 (MPC) 中的一个标准表述，它具有科学依据、是良定的且客观的。它包含了获得唯一解所需的所有必要信息。因此，该问题被认为是有效的，下面提供了完整的解答。\n\n目标是为给定的离散时间系统和二次代价函数推导紧凑 Hessian 矩阵 $H$。代价函数 $J$ 必须表示为二次规划 (QP) 形式 $J(U) = \\frac{1}{2} U^{\\top} H U + f^{\\top} U + c$，其中 $U$ 是预测时域内控制输入的堆叠向量。\n\n系统动态由下式给出：\n$$x_{k+1} = A x_{k} + B u_{k}$$\n其中标量参数为 $A = 0.8$ 和 $B = 1$。状态 $x_k$ 和控制输入 $u_k$ 也都是标量。\n\n有限时域代价在时域 $N=3$ 上定义为：\n$$J = \\sum_{k=0}^{N-1} \\left( x_{k}^{\\top} Q x_{k} + u_{k}^{\\top} R u_{k} \\right) = \\sum_{k=0}^{2} \\left( x_{k}^{2} Q + u_{k}^{2} R \\right)$$\n其中权重 $Q = 1$ 和 $R = 0.1$。终端权重为零。\n\n待优化的控制输入向量为：\n$$U = \\begin{pmatrix} u_{0} \\\\ u_{1} \\\\ u_{2} \\end{pmatrix}$$\n对代价有贡献的状态是 $x_0$、$x_1$ 和 $x_2$。我们必须用初始状态 $x_0$ 和控制输入 $u_0, u_1, u_2$ 来表示这些状态。\n状态演化如下：\n$x_0$ 是初始条件。\n$$x_{1} = A x_{0} + B u_{0}$$\n$$x_{2} = A x_{1} + B u_{1} = A (A x_{0} + B u_{0}) + B u_{1} = A^2 x_{0} + A B u_{0} + B u_{1}$$\n\n我们可以将与代价相关的状态序列 $\\mathbf{X}_{\\text{cost}} = \\begin{pmatrix} x_0 \\\\ x_1 \\\\ x_2 \\end{pmatrix}$ 表示为堆叠矩阵形式：\n$$\\begin{pmatrix} x_{0} \\\\ x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ A \\\\ A^2 \\end{pmatrix} x_{0} + \\begin{pmatrix} 0  0  0 \\\\ B  0  0 \\\\ AB  B  0 \\end{pmatrix} \\begin{pmatrix} u_{0} \\\\ u_{1} \\\\ u_{2} \\end{pmatrix}$$\n让我们将这些矩阵记为 $\\mathbf{S}_{x}$ 和 $\\mathbf{S}_{u}$，从而有 $\\mathbf{X}_{\\text{cost}} = \\mathbf{S}_{x} x_{0} + \\mathbf{S}_{u} U$。\n\n代价函数可以写成矩阵形式：\n$$J = \\mathbf{X}_{\\text{cost}}^{\\top} \\bar{Q} \\mathbf{X}_{\\text{cost}} + U^{\\top} \\bar{R} U$$\n其中 $\\bar{Q}$ 和 $\\bar{R}$ 是权重的分块对角矩阵：\n$$\\bar{Q} = \\begin{pmatrix} Q  0  0 \\\\ 0  Q  0 \\\\ 0  0  Q \\end{pmatrix}, \\quad \\bar{R} = \\begin{pmatrix} R  0  0 \\\\ 0  R  0 \\\\ 0  0  R \\end{pmatrix}$$\n将 $\\mathbf{X}_{\\text{cost}}$ 的表达式代入代价函数 $J$：\n$$J = (\\mathbf{S}_{x} x_{0} + \\mathbf{S}_{u} U)^{\\top} \\bar{Q} (\\mathbf{S}_{x} x_{0} + \\mathbf{S}_{u} U) + U^{\\top} \\bar{R} U$$\n展开此表达式：\n$$J = x_{0}^{\\top} \\mathbf{S}_{x}^{\\top} \\bar{Q} \\mathbf{S}_{x} x_{0} + 2 x_{0}^{\\top} \\mathbf{S}_{x}^{\\top} \\bar{Q} \\mathbf{S}_{u} U + U^{\\top} \\mathbf{S}_{u}^{\\top} \\bar{Q} \\mathbf{S}_{u} U + U^{\\top} \\bar{R} U$$\n该表达式与 QP 形式 $J(U) = c + f^{\\top} U + \\frac{1}{2} U^{\\top} H U$ 相匹配。\n关于 $U$ 的二次项是 $U^{\\top} (\\mathbf{S}_{u}^{\\top} \\bar{Q} \\mathbf{S}_{u} + \\bar{R}) U$。\n通过与 $\\frac{1}{2} U^{\\top} H U$ 进行比较，我们确定紧凑 Hessian 矩阵 $H$ 为：\n$$H = 2 \\left( \\mathbf{S}_{u}^{\\top} \\bar{Q} \\mathbf{S}_{u} + \\bar{R} \\right)$$\n现在，我们代入给定的数值：$A = 0.8$，$B = 1$，$Q = 1$，$R = 0.1$。\n矩阵 $\\mathbf{S}_u$、$\\bar{Q}$ 和 $\\bar{R}$ 变为：\n$$\\mathbf{S}_{u} = \\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ (0.8)(1)  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ 0.8  1  0 \\end{pmatrix}$$\n$$\\bar{Q} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = I_{3}$$\n$$\\bar{R} = \\begin{pmatrix} 0.1  0  0 \\\\ 0  0.1  0 \\\\ 0  0  0.1 \\end{pmatrix}$$\n由于 $\\bar{Q}$ 是单位矩阵，因此 $\\mathbf{S}_{u}^{\\top} \\bar{Q} \\mathbf{S}_{u} = \\mathbf{S}_{u}^{\\top} \\mathbf{S}_{u}$。\n首先，我们计算 $\\mathbf{S}_{u}^{\\top} \\mathbf{S}_{u}$：\n$$\\mathbf{S}_{u}^{\\top} \\mathbf{S}_{u} = \\begin{pmatrix} 0  1  0.8 \\\\ 0  0  1 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  0  0 \\\\ 1  0  0 \\\\ 0.8  1  0 \\end{pmatrix} = \\begin{pmatrix} (1)(1)+(0.8)(0.8)  (0.8)(1)  0 \\\\ (1)(0.8)  (1)(1)  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1.64  0.8  0 \\\\ 0.8  1  0 \\\\ 0  0  0 \\end{pmatrix}$$\n接下来，我们加上 $\\bar{R}$：\n$$\\mathbf{S}_{u}^{\\top} \\bar{Q} \\mathbf{S}_{u} + \\bar{R} = \\begin{pmatrix} 1.64  0.8  0 \\\\ 0.8  1  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0.1  0  0 \\\\ 0  0.1  0 \\\\ 0  0  0.1 \\end{pmatrix} = \\begin{pmatrix} 1.74  0.8  0 \\\\ 0.8  1.1  0 \\\\ 0  0  0.1 \\end{pmatrix}$$\n最后，我们通过乘以 2 来计算 $H$：\n$$H = 2 \\begin{pmatrix} 1.74  0.8  0 \\\\ 0.8  1.1  0 \\\\ 0  0  0.1 \\end{pmatrix} = \\begin{pmatrix} 3.48  1.6  0 \\\\ 1.6  2.2  0 \\\\ 0  0  0.2 \\end{pmatrix}$$\n这就是给定 MPC 问题的紧凑 Hessian 矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.48  1.6  0 \\\\\n1.6  2.2  0 \\\\\n0  0  0.2\n\\end{pmatrix}\n}\n$$", "id": "2884304"}, {"introduction": "现实世界中的系统总是受到各种约束，而优雅地处理约束是MPC的一大优势。本练习将深入探讨约束优化的数学原理，通过应用Karush-Kuhn-Tucker（KKT）条件[@problem_id:2884356]来分析状态约束被激活的场景，阐明拉格朗日乘子如何量化这些限制所带来的影响。", "problem": "考虑一个用于模型预测控制 (MPC) 的单输入单输出线性时不变离散时间系统，其预测步长为一步，\n$$\nx_{k+1} = a\\,x_{k} + b\\,u_{k},\n$$\n以及一个二次阶段成本\n$$\nJ = \\frac{1}{2}\\,q\\,(x_{k+1} - r)^{2} + \\frac{1}{2}\\,r_{u}\\,u_{k}^{2},\n$$\n受限于硬状态边界\n$$\nx_{k+1} \\in [\\underline{x}, \\overline{x}].\n$$\n设参数为\n$$\na = 0.7,\\quad b = 2.0,\\quad x_{k} = 3.0,\\quad q = 5.0,\\quad r_{u} = 0.5,\\quad r = 6.0,\\quad \\underline{x} = -1.0,\\quad \\overline{x} = 4.0.\n$$\n通过系统动力学将控制输入 $u_{k}$ 表示为 $x_{k+1}$ 的函数，从而消去控制输入，得到一个关于决策变量 $x_{k+1}$ 的标量有界约束优化问题。然后，从 Karush-Kuhn-Tucker (KKT) 条件和互补松弛性出发，在预测状态达到上界饱和（即 $x_{k+1}^{\\star} = \\overline{x}$）的情况下，确定最优解处与状态下界和上界相关联的拉格朗日乘子。您的最终答案必须是 $(\\mu_{\\ell}, \\mu_{u})$ 对，其中 $\\mu_{\\ell}$ 是下界乘子，$\\mu_{u}$ 是上界乘子，并表示为行矩阵。无需四舍五入。", "solution": "所述问题是模型预测控制框架内一个约束优化任务的有效表述。该问题具有科学依据、是适定的、客观且自洽的，并提供了所有必需的参数。这是一个带有线性不等式约束的标准凸二次规划问题，保证存在唯一解。因此，我们可以开始推导。\n\n目标是在最优预测状态 $x_{k+1}^{\\star}$ 在其上界 $\\overline{x}$ 处饱和的指定条件下，求出单步预测时域下与状态约束相关联的拉格朗日乘子 $(\\mu_{\\ell}, \\mu_{u})$。\n\n首先，我们将优化问题完全用决策变量 $x_{k+1}$ 来表述。系统动力学由下式给出\n$$\nx_{k+1} = a\\,x_{k} + b\\,u_{k}.\n$$\n假设 $b \\neq 0$（对于 $b=2.0$ 这是成立的），我们可以将控制输入 $u_k$ 表示为 $k+1$ 时刻状态的函数：\n$$\nu_{k} = \\frac{1}{b}(x_{k+1} - a\\,x_{k}).\n$$\n将此式代入二次阶段成本函数\n$$\nJ = \\frac{1}{2}\\,q\\,(x_{k+1} - r)^{2} + \\frac{1}{2}\\,r_{u}\\,u_{k}^{2}\n$$\n可得到仅与 $x_{k+1}$ 相关的成本函数：\n$$\nJ(x_{k+1}) = \\frac{1}{2}\\,q\\,(x_{k+1} - r)^{2} + \\frac{1}{2}\\,r_{u}\\,\\left(\\frac{1}{b}(x_{k+1} - a\\,x_{k})\\right)^{2}.\n$$\n优化问题是在硬状态边界 $x_{k+1} \\in [\\underline{x}, \\overline{x}]$ 的约束下最小化 $J(x_{k+1})$。这些边界可以写成两个不等式约束：\n$$\ng_1(x_{k+1}) = x_{k+1} - \\overline{x} \\leq 0,\n$$\n$$\ng_2(x_{k+1}) = \\underline{x} - x_{k+1} \\leq 0.\n$$\n为求解此约束优化问题，我们使用 Karush-Kuhn-Tucker (KKT) 条件。我们定义拉格朗日函数 $\\mathcal{L}$，其中 $\\mu_{u}$ 和 $\\mu_{\\ell}$ 是分别对应上界和下界约束的非负拉格朗日乘子：\n$$\n\\mathcal{L}(x_{k+1}, \\mu_{u}, \\mu_{\\ell}) = J(x_{k+1}) + \\mu_{u}(x_{k+1} - \\overline{x}) + \\mu_{\\ell}(\\underline{x} - x_{k+1}).\n$$\n最优解 $(x_{k+1}^{\\star}, \\mu_{u}^{\\star}, \\mu_{\\ell}^{\\star})$ 的 KKT 条件如下：\n1.  **平稳性：** $\\nabla_{x_{k+1}} \\mathcal{L} = \\frac{\\partial J}{\\partial x_{k+1}} + \\mu_{u}^{\\star} - \\mu_{\\ell}^{\\star} = 0$。\n2.  **原始可行性：** $\\underline{x} \\leq x_{k+1}^{\\star} \\leq \\overline{x}$。\n3.  **对偶可行性：** $\\mu_{u}^{\\star} \\geq 0$ 且 $\\mu_{\\ell}^{\\star} \\geq 0$。\n4.  **互补松弛性：** $\\mu_{u}^{\\star}(x_{k+1}^{\\star} - \\overline{x}) = 0$ 且 $\\mu_{\\ell}^{\\star}(\\underline{x} - x_{k+1}^{\\star}) = 0$。\n\n问题指明解位于上界上，即 $x_{k+1}^{\\star} = \\overline{x}$。我们利用这一事实来确定乘子。\n\n根据第二个互补松弛性条件 $\\mu_{\\ell}^{\\star}(\\underline{x} - x_{k+1}^{\\star}) = 0$，我们代入 $x_{k+1}^{\\star} = \\overline{x}$：\n$$\n\\mu_{\\ell}^{\\star}(\\underline{x} - \\overline{x}) = 0.\n$$\n使用给定的数值 $\\underline{x} = -1.0$ 和 $\\overline{x} = 4.0$，括号中的项为 $\\underline{x} - \\overline{x} = -1.0 - 4.0 = -5.0$。由于此项非零，因此乘子 $\\mu_{\\ell}^{\\star}$ 必须为 0。这是预料之中的，因为在解处下界约束未激活。\n\n第一个互补松弛性条件 $\\mu_{u}^{\\star}(x_{k+1}^{\\star} - \\overline{x}) = 0$ 变为 $\\mu_{u}^{\\star}(\\overline{x} - \\overline{x}) = 0$，此式平凡满足，无法确定 $\\mu_{u}^{\\star}$。\n\n因此我们必须使用在最优解 $x_{k+1}^{\\star} = \\overline{x}$ 和 $\\mu_{\\ell}^{\\star}=0$ 处求值的平稳性条件：\n$$\n\\frac{\\partial J}{\\partial x_{k+1}}\\bigg|_{x_{k+1}=\\overline{x}} + \\mu_{u}^{\\star} - 0 = 0.\n$$\n这使我们能够解出 $\\mu_{u}^{\\star}$：\n$$\n\\mu_{u}^{\\star} = -\\frac{\\partial J}{\\partial x_{k+1}}\\bigg|_{x_{k+1}=\\overline{x}}.\n$$\n首先，我们计算 $J(x_{k+1})$ 的导数：\n$$\n\\frac{\\partial J}{\\partial x_{k+1}} = q(x_{k+1} - r) + \\frac{r_{u}}{b^2}(x_{k+1} - a\\,x_{k}).\n$$\n现在，我们在 $x_{k+1} = \\overline{x}$ 处计算该导数的值：\n$$\n\\frac{\\partial J}{\\partial x_{k+1}}\\bigg|_{x_{k+1}=\\overline{x}} = q(\\overline{x} - r) + \\frac{r_{u}}{b^2}(\\overline{x} - a\\,x_{k}).\n$$\n因此，上界乘子为：\n$$\n\\mu_{u}^{\\star} = - \\left( q(\\overline{x} - r) + \\frac{r_{u}}{b^2}(\\overline{x} - a\\,x_{k}) \\right).\n$$\n我们代入给定的数值参数：\n$a = 0.7$, $b = 2.0$, $x_{k} = 3.0$, $q = 5.0$, $r_{u} = 0.5$, $r = 6.0$, $\\overline{x} = 4.0$.\n$$\n\\mu_{u}^{\\star} = - \\left( 5.0(4.0 - 6.0) + \\frac{0.5}{(2.0)^{2}}(4.0 - (0.7)(3.0)) \\right)\n$$\n$$\n\\mu_{u}^{\\star} = - \\left( 5.0(-2.0) + \\frac{0.5}{4.0}(4.0 - 2.1) \\right)\n$$\n$$\n\\mu_{u}^{\\star} = - \\left( -10.0 + (0.125)(1.9) \\right)\n$$\n$$\n\\mu_{u}^{\\star} = - \\left( -10.0 + 0.2375 \\right)\n$$\n$$\n\\mu_{u}^{\\star} = -(-9.7625) = 9.7625.\n$$\n该值满足对偶可行性条件 $\\mu_{u}^{\\star} \\geq 0$。为了提供精确答案，我们将其转换为分数：\n$$\n\\mu_{u}^{\\star} = 9.7625 = \\frac{97625}{10000} = \\frac{19525}{2000} = \\frac{3905}{400} = \\frac{781}{80}.\n$$\n拉格朗日乘子对为 $(\\mu_{\\ell}, \\mu_{u}) = (0, \\frac{781}{80})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  \\frac{781}{80} \\end{pmatrix}}\n$$", "id": "2884356"}]}