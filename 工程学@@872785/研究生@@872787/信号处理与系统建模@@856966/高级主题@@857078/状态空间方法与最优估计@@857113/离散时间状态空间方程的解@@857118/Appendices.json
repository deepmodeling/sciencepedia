{"hands_on_practices": [{"introduction": "求解离散时间线性时不变（LTI）系统的核心在于理解状态如何随时间演化，这由状态转移矩阵 $A$ 的幂决定。对于可对角化的系统，这个过程可以通过模态分解被优雅地理解。该练习 [@problem_id:2905338] 将指导您从第一性原理出发，推导系统的输出，提供一个具体的例子，说明特征值和特征向量如何决定长期行为，以及初始条件如何激发特定的系统模态。", "problem": "考虑一个离散时间线性时不变 (LTI) 状态空间模型，由递推式 $x[k+1] = A x[k]$ 定义，其初始条件为 $x[0] = b$，标量输出为 $y[k] = c^{\\top} x[k]$。假设状态转移矩阵 $A$ 有三个不同的特征值，并以分解形式 $A = V \\Lambda V^{-1}$ 给出，其中\n$$\nV = \\begin{pmatrix}\n1  1  1 \\\\\n0  1  2 \\\\\n1  0  1\n\\end{pmatrix}, \\quad\n\\Lambda = \\operatorname{diag}\\!\\left(2,\\, -1,\\, \\frac{1}{2}\\right), \\quad\nb = \\begin{pmatrix}1 \\\\ 0 \\\\ -1\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}1 \\\\ -1 \\\\ 2\\end{pmatrix}.\n$$\n从求解线性时不变离散时间状态递推式的基本原理出发，并且不使用任何预先给出的关于 $A^{k}$ 的闭式表达式，推导出一个关于非负整数 $k$ 的 $y[k]$ 的闭式表达式。你的推导应从状态递推解的定义开始，并仅使用所提供的系统描述。将最终答案表示为关于 $k$ 的单个闭式解析表达式。不需要进行数值取整。", "solution": "该问题要求推导一个离散时间线性时不变系统输出 $y[k]$ 的闭式表达式。推导过程必须从基本原理出发。\n\n该系统由以下状态空间方程描述：\n$$x[k+1] = A x[k]$$\n$$y[k] = c^{\\top} x[k]$$\n初始状态为 $x[0] = b$。\n\n首先，我们确定状态向量 $x[k]$ 的通解。状态方程是一个一阶齐次线性递推关系。我们可以从初始条件 $x[0]$ 开始，通过直接迭代来求其解：\n对于 $k=1$，我们有 $x[1] = A x[0]$。\n对于 $k=2$，我们有 $x[2] = A x[1] = A (A x[0]) = A^2 x[0]$。\n对于 $k=3$，我们有 $x[3] = A x[2] = A (A^2 x[0]) = A^3 x[0]$。\n通过数学归纳法，可以很容易地证明在任意时间步 $k \\ge 0$ 的状态向量由下式给出：\n$$x[k] = A^k x[0]$$\n给定初始条件 $x[0] = b$，状态向量为 $x[k] = A^k b$。\n\n然后将 $x[k]$ 的表达式代入输出方程，得到输出 $y[k]$：\n$$y[k] = c^{\\top} x[k] = c^{\\top} A^k b$$\n\n核心任务是计算 $A^k$。我们已知矩阵 $A$ 的特征分解为 $A = V \\Lambda V^{-1}$。我们可以利用这个分解来找到 $A^k$ 的表达式。再次从基本原理出发：\n$$A^2 = (V \\Lambda V^{-1})(V \\Lambda V^{-1}) = V \\Lambda (V^{-1}V) \\Lambda V^{-1} = V \\Lambda I \\Lambda V^{-1} = V \\Lambda^2 V^{-1}$$\n其中 $I$ 是单位矩阵。通过归纳法推广，我们得到 $A$ 的 $k$ 次幂的通式：\n$$A^k = V \\Lambda^k V^{-1}$$\n这不是一个预先给出的公式，而是矩阵乘法和求逆性质的直接结果。\n\n将此代入我们关于 $y[k]$ 的表达式中：\n$$y[k] = c^{\\top} (V \\Lambda^k V^{-1}) b$$\n为了高效地计算这个标量值，我们按如下方式组合各项：\n$$y[k] = (c^{\\top} V) \\Lambda^k (V^{-1} b)$$\n这种方法避免了对矩阵 $A^k$ 的完全计算，而只需要进行向量和矩阵-向量乘法。\n\n所提供的矩阵和向量如下：\n$$V = \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\\\ 1  0  1 \\end{pmatrix}, \\quad \\Lambda = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  \\frac{1}{2} \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 1 \\\\ -1 \\\\ 2 \\end{pmatrix}$$\n\n我们现在来计算 $y[k]$ 表达式的各个组成部分。\n\n步骤1：计算矩阵 $V$ 的逆。\n$V$ 的行列式为：\n$$\\det(V) = 1(1 \\cdot 1 - 2 \\cdot 0) - 1(0 \\cdot 1 - 2 \\cdot 1) + 1(0 \\cdot 0 - 1 \\cdot 1) = 1(1) - 1(-2) + 1(-1) = 1 + 2 - 1 = 2$$\n由于 $\\det(V) = 2 \\neq 0$，该矩阵是可逆的。其逆矩阵由 $V^{-1} = \\frac{1}{\\det(V)}\\operatorname{adj}(V)$ 给出，其中 $\\operatorname{adj}(V)$ 是 $V$ 的伴随矩阵。\n代数余子式矩阵为：\n$$C = \\begin{pmatrix} \\left|\\begin{matrix} 1  2 \\\\ 0  1 \\end{matrix}\\right|  -\\left|\\begin{matrix} 0  2 \\\\ 1  1 \\end{matrix}\\right|  \\left|\\begin{matrix} 0  1 \\\\ 1  0 \\end{matrix}\\right| \\\\ -\\left|\\begin{matrix} 1  1 \\\\ 0  1 \\end{matrix}\\right|  \\left|\\begin{matrix} 1  1 \\\\ 1  1 \\end{matrix}\\right|  -\\left|\\begin{matrix} 1  1 \\\\ 1  0 \\end{matrix}\\right| \\\\ \\left|\\begin{matrix} 1  1 \\\\ 1  2 \\end{matrix}\\right|  -\\left|\\begin{matrix} 1  1 \\\\ 0  2 \\end{matrix}\\right|  \\left|\\begin{matrix} 1  1 \\\\ 0  1 \\end{matrix}\\right| \\end{pmatrix} = \\begin{pmatrix} 1  2  -1 \\\\ -1  0  1 \\\\ 1  -2  1 \\end{pmatrix}$$\n伴随矩阵是代数余子式矩阵的转置：\n$$\\operatorname{adj}(V) = C^{\\top} = \\begin{pmatrix} 1  -1  1 \\\\ 2  0  -2 \\\\ -1  1  1 \\end{pmatrix}$$\n因此，逆矩阵为：\n$$V^{-1} = \\frac{1}{2}\\begin{pmatrix} 1  -1  1 \\\\ 2  0  -2 \\\\ -1  1  1 \\end{pmatrix}$$\n\n步骤2：计算向量 $V^{-1}b$。\n该向量表示在 $A$ 的特征向量基下的初始条件 $b$。\n$$V^{-1}b = \\frac{1}{2}\\begin{pmatrix} 1  -1  1 \\\\ 2  0  -2 \\\\ -1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 1(1) + (-1)(0) + 1(-1) \\\\ 2(1) + 0(0) + (-2)(-1) \\\\ -1(1) + 1(0) + 1(-1) \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 0 \\\\ 4 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\\\ -1 \\end{pmatrix}$$\n\n步骤3：计算向量 $c^{\\top}V$。\n该向量决定了系统各模式如何对输出做出贡献。\n$$c^{\\top}V = \\begin{pmatrix} 1  -1  2 \\end{pmatrix} \\begin{pmatrix} 1  1  1 \\\\ 0  1  2 \\\\ 1  0  1 \\end{pmatrix} = \\begin{pmatrix} 1(1)+(-1)(0)+2(1)  1(1)+(-1)(1)+2(0)  1(1)+(-1)(2)+2(1) \\end{pmatrix}$$\n$$c^{\\top}V = \\begin{pmatrix} 1+0+2  1-1+0  1-2+2 \\end{pmatrix} = \\begin{pmatrix} 3  0  1 \\end{pmatrix}$$\n\n步骤4：计算 $\\Lambda^k$。\n由于 $\\Lambda$ 是一个对角矩阵，其 $k$ 次幂可以通过将其对角元素提升到 $k$ 次幂来得到。\n$$\\Lambda^k = \\begin{pmatrix} 2^k  0  0 \\\\ 0  (-1)^k  0 \\\\ 0  0  (\\frac{1}{2})^k \\end{pmatrix} = \\begin{pmatrix} 2^k  0  0 \\\\ 0  (-1)^k  0 \\\\ 0  0  2^{-k} \\end{pmatrix}$$\n\n步骤5：组合得到 $y[k]$ 的最终表达式。\n现在我们结合前面步骤的结果：\n$$y[k] = (c^{\\top} V) \\Lambda^k (V^{-1} b) = \\begin{pmatrix} 3  0  1 \\end{pmatrix} \\begin{pmatrix} 2^k  0  0 \\\\ 0  (-1)^k  0 \\\\ 0  0  2^{-k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2 \\\\ -1 \\end{pmatrix}$$\n首先，我们将行向量与矩阵相乘：\n$$\\begin{pmatrix} 3  0  1 \\end{pmatrix} \\begin{pmatrix} 2^k  0  0 \\\\ 0  (-1)^k  0 \\\\ 0  0  2^{-k} \\end{pmatrix} = \\begin{pmatrix} 3 \\cdot 2^k  0 \\cdot (-1)^k  1 \\cdot 2^{-k} \\end{pmatrix} = \\begin{pmatrix} 3 \\cdot 2^k  0  2^{-k} \\end{pmatrix}$$\n然后，我们用列向量完成乘法：\n$$y[k] = \\begin{pmatrix} 3 \\cdot 2^k  0  2^{-k} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2 \\\\ -1 \\end{pmatrix} = (3 \\cdot 2^k)(0) + (0)(2) + (2^{-k})(-1)$$\n$$y[k] = 0 + 0 - 2^{-k} = -2^{-k}$$\n这代表了输出的模态展开。初始条件在对应于特征值 $\\lambda_1 = 2$ 的特征向量方向上没有分量。在变换后的坐标系中，输出向量 $c$ 与对应于特征值 $\\lambda_2 = -1$ 的特征向量正交。因此，只有与特征值 $\\lambda_3 = 1/2$ 相关的模式被激励并在输出中被观察到。对于任意非负整数 $k$，输出的最终闭式表达式为 $y[k] = -2^{-k}$。", "answer": "$$\\boxed{-2^{-k}}$$", "id": "2905338"}, {"introduction": "虽然可对角化系统提供了一幅清晰的图景，但许多现实世界中的系统更适合用非正规矩阵来描述，这些矩阵无法被对角化。该练习 [@problem_id:2905370] 探索了最简单的非平凡情况：一个 $2 \\times 2$ 的约旦块。通过显式计算矩阵的幂 $J^k$，您将揭示暂态增长的来源——即使在渐近稳定系统中，状态范数也可能暂时增大的现象——并分析矩阵的幂零部分如何从根本上改变系统的暂态响应。", "problem": "考虑由递推关系 $x_{k+1} = J x_{k}$ 定义的离散时间线性时不变状态空间系统，其中 $x_{k} \\in \\mathbb{R}^{2}$ 且状态转移矩阵 $J \\in \\mathbb{R}^{2 \\times 2}$ 是一个与特征值 $\\lambda = \\frac{9}{10}$ 相关联的 $2 \\times 2$ 单一若尔当块：\n$$\nJ = \\begin{pmatrix}\n\\frac{9}{10}  1 \\\\\n0  \\frac{9}{10}\n\\end{pmatrix}.\n$$\n从适用于离散时间状态空间解和若尔当块结构的基本原理出发，推导 $J^{k}$ 对任意整数 $k \\geq 0$ 的显式表达式。然后，在初始条件 $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 下，使用你得到的 $J^{k}$ 表达式，求出状态 $x_{k}$ 的第一个分量作为 $k$ 的函数的闭式表达式。最后，分析状态的渐近衰减率，并解释在渐近衰减占主导地位之前，$J$ 的幂零部分对暂态行为的影响。\n\n你最终报告的答案必须是 $x_{k}$ 的第一个分量关于 $k$ 的单一闭式解析表达式。无需进行数值舍入。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 该系统是一个由递推关系 $x_{k+1} = J x_{k}$ 描述的离散时间线性时不变状态空间系统。\n- 状态向量为 $x_{k} \\in \\mathbb{R}^{2}$。\n- 状态转移矩阵是一个 $2 \\times 2$ 的若尔当块：\n$$\nJ = \\begin{pmatrix}\n\\frac{9}{10}  1 \\\\\n0  \\frac{9}{10}\n\\end{pmatrix}\n$$\n- 相关特征值为 $\\lambda = \\frac{9}{10}$。\n- 初始条件为 $x_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n- 任务是：\n    1. 推导 $J^{k}$ 对任意整数 $k \\geq 0$ 的显式表达式。\n    2. 求出状态的第一个分量 $x_{k,1}$ 作为 $k$ 的函数的闭式表达式。\n    3. 分析渐近衰减率以及 $J$ 的幂零部分对暂态行为的影响。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于线性代数和离散时间系统理论的基本原理，特别是通过若尔当标准型分析非对角化矩阵的系统。这是工程学和数学中一个标准且成熟的课题。\n- **适定性**：该问题是适定的。矩阵、初始条件和目标都已明确规定，保证了唯一且稳定的解。特征值幅度 $|\\lambda| = |\\frac{9}{10}|  1$ 确保了系统是渐近稳定的。\n- **客观性**：该问题以精确、客观的数学语言陈述，不含任何主观或推测性内容。\n\n**步骤 3：结论与行动**\n该问题科学上合理、适定、客观且自洽。因此，判定为**有效**。我们继续进行求解。\n\n离散时间系统 $x_{k+1} = J x_k$ 的解由 $x_k = J^k x_0$ 给出。主要任务是计算矩阵的幂 $J^k$。矩阵 $J$可以分解为其对角部分和其幂零部分之和。该分解为 $J = D + N$，其中 $D$ 是包含特征值的对角矩阵，$N$ 是一个严格上三角矩阵。\n\n对于给定的若尔当块，我们有：\n$$\nJ = \\lambda I + N = \\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n其中 $\\lambda = \\frac{9}{10}$，$I$ 是 $2 \\times 2$ 的单位矩阵，且 $N = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$。\n\n矩阵 $D = \\lambda I$ 是一个数量矩阵，它与任何矩阵都可交换。具体来说，$DN = (\\lambda I)N = \\lambda N$ 且 $ND = N(\\lambda I) = \\lambda N$，所以 $DN=ND$。因为 $D$ 和 $N$ 可交换，我们可以应用二项式定理来计算 $J^k$：\n$$\nJ^k = (D+N)^k = \\sum_{i=0}^{k} \\binom{k}{i} D^{k-i} N^i\n$$\n我们必须计算幂零矩阵 $N$ 的幂：\n$$\nN^0 = I = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nN^1 = N = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n$$\nN^2 = N \\cdot N = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} = \\mathbf{0}\n$$\n由于 $N^2$ 是零矩阵，所有对于 $i \\ge 2$ 的更高次幂 $N^i$ 也都是零矩阵。这个性质简化了二项式展开，它现在在 $i=1$ 项之后截断：\n$$\nJ^k = \\binom{k}{0} D^k N^0 + \\binom{k}{1} D^{k-1} N^1\n$$\n该公式对 $k \\ge 1$ 有效。对于 $k=0$，$J^0=I$。该公式给出 $\\binom{0}{0} D^0 N^0 = I$。对于 $k=1$，它给出 $\\binom{1}{0}D^1 N^0 + \\binom{1}{1}D^0 N^1 = D+N=J$。该公式对所有 $k \\ge 0$ 都有效。\n代入各项：\n- $\\binom{k}{0} = 1$\n- $\\binom{k}{1} = k$\n- $D^j = (\\lambda I)^j = \\lambda^j I$\n因此，$J^k$ 的表达式变为：\n$$\nJ^k = 1 \\cdot (\\lambda^k I) \\cdot I + k \\cdot (\\lambda^{k-1} I) \\cdot N = \\lambda^k I + k \\lambda^{k-1} N\n$$\n代入 $I$ 和 $N$ 的矩阵形式：\n$$\nJ^k = \\lambda^k \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + k \\lambda^{k-1} \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} \\lambda^k  0 \\\\ 0  \\lambda^k \\end{pmatrix} + \\begin{pmatrix} 0  k \\lambda^{k-1} \\\\ 0  0 \\end{pmatrix}\n$$\n这得到了 $J^k$ 的显式表达式：\n$$\nJ^k = \\begin{pmatrix} \\lambda^k  k \\lambda^{k-1} \\\\ 0  \\lambda^k \\end{pmatrix}\n$$\n现在，我们使用这个结果，结合初始条件 $x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，来求状态向量 $x_k = J^k x_0$：\n$$\nx_k = \\begin{pmatrix} \\lambda^k  k \\lambda^{k-1} \\\\ 0  \\lambda^k \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^k \\cdot 1 + k \\lambda^{k-1} \\cdot 1 \\\\ 0 \\cdot 1 + \\lambda^k \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} \\lambda^k + k \\lambda^{k-1} \\\\ \\lambda^k \\end{pmatrix}\n$$\n问题要求 $x_k$ 的第一个分量 $x_{k,1}$ 的闭式表达式。\n$$\nx_{k,1} = \\lambda^k + k \\lambda^{k-1}\n$$\n代入 $\\lambda = \\frac{9}{10}$ 的值：\n$$\nx_{k,1} = \\left(\\frac{9}{10}\\right)^k + k \\left(\\frac{9}{10}\\right)^{k-1}\n$$\n这个表达式可以被因式分解以获得更紧凑的表示：\n$$\nx_{k,1} = \\left(\\frac{9}{10}\\right)^{k-1} \\left(\\frac{9}{10} + k\\right) = \\left(\\frac{9}{10}\\right)^k \\left(1 + \\frac{k}{9/10}\\right) = \\left(1 + \\frac{10}{9}k\\right) \\left(\\frac{9}{10}\\right)^k\n$$\n这就是所要求的解析表达式。\n\n最后，我们分析系统的行为。状态向量为 $x_k = \\begin{pmatrix} (\\lambda^k + k \\lambda^{k-1}) \\\\ \\lambda^k \\end{pmatrix}$。当 $k \\to \\infty$ 时，$x_k$ 的两个分量都趋近于 $0$，因为 $|\\lambda| = \\frac{9}{10}  1$，并且指数衰减超过了多项式增长。系统的渐近衰减率由特征值 $\\lambda$ 的大小决定。具体来说，$\\lim_{k\\to\\infty} \\frac{\\|x_{k+1}\\|}{\\|x_k\\|} = |\\lambda| = \\frac{9}{10}$。\n\n幂零部分 $N$ 的影响体现在解 $x_k = (\\lambda^k I + k \\lambda^{k-1}N)x_0$ 中的项 $k \\lambda^{k-1} N x_0$。如果系统是可对角化的（$N = \\mathbf{0}$），状态将是 $x_k = \\lambda^k x_0$，其大小将对所有 $k \\ge 0$ 单调递减。然而，项 $k \\lambda^{k-1}$ 的存在引入了一种以初始增长为特征的暂态行为。函数 $f(k) = k \\lambda^{k-1}$ 从 $k=0$ 开始并非单调衰减。它最初会增加，达到一个最大值（对于连续的 $k$，大约在 $k = -1/\\ln(\\lambda) \\approx 9.49$ 附近），然后衰减。这意味着状态向量的大小会先增长，呈现一个暂态的“驼峰”，然后由 $\\lambda^k$ 控制的渐近指数衰减才成为主导行为。这种暂态增长是系统不可对角化性质的直接结果，该性质由若尔当块的幂零部分所体现。", "answer": "$$\n\\boxed{\\left(1 + \\frac{10}{9}k\\right)\\left(\\frac{9}{10}\\right)^k}\n$$", "id": "2905370"}, {"introduction": "解析解能提供深刻的洞察，但它们的直接实现可能在数值上不稳定，尤其对于非正规系统。该练习 [@problem_id:2905355] 将焦点转移到实用且稳健的计算上，通过探索使用舒尔分解来计算 $A^k b$。您将分析和比较不同的算法策略，从而体会到在计算复杂度和数值稳定性之间的权衡，这是现代科学计算的核心问题。", "problem": "给定一个离散时间线性时不变状态转移矩阵 $A \\in \\mathbb{C}^{n \\times n}$，一个向量 $b \\in \\mathbb{C}^{n}$，以及一个整数指数 $k \\ge 0$。在离散时间状态空间系统的分析与仿真中，一个核心运算是计算 $A^k b$ 而不显式地构造矩阵 $A^k$。从第一性原理出发，仅使用以下基本事实：(i) 每个矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 都允许进行 Schur 分解 $A = Q T Q^*$，其中 $Q$ 是酉矩阵，$T$ 是上三角矩阵；(ii) 酉相似变换保持幂运算，即 $(Q T Q^*)^k = Q T^k Q^*$；以及 (iii) 一个 $n \\times n$ 上三角矩阵与向量的乘法需要 $n^2$ 数量级的算术运算，而计算 Schur 分解需要 $n^3$ 数量级的算术运算。请选择最准确地概述了一种计算 $A^k b$ 而不显式构造 $A^k$ 的数值稳定算法，并正确分析了其关于 $n$ 和 $k$ 的渐进计算复杂度的选项。\n\nA. 计算复 Schur 分解 $A = Q T Q^*$，构造 $z = Q^* b$，然后使用混合策略计算 $y = T^k z$ 而不构造 $T^k$：或者执行 $k$ 次连续的三角矩阵向量乘法 $z \\leftarrow T z$ (代价为 $k n^2$ 数量级)，或者使用平方乘算法，首先通过重复平方构造幂序列 $\\{T^{2^j}\\}$ (每次平方的代价为 $n^3$ 数量级；平方次数为 $\\log k$ 数量级)，然后将每个选定的幂矩阵应用于该向量 (每次应用的代价为 $n^2$ 数量级；应用次数为 $\\log k$ 数量级)，选择两者中代价更低的一个。最后，输出 $x = Q y$。总代价为 $n^3 + \\min\\{k n^2, n^3 \\log k\\}$ 数量级 (当 $n$ 很大时，$n^2 \\log k$ 的向量应用项被 $n^3 \\log k$ 项主导)，再加上应用 $Q$ 和 $Q^*$ 的 $n^2$ 数量级代价。\n\nB. 计算实 Schur 分解 $A = Q R Q^\\top$，构造 $z = Q^\\top b$，然后通过 $k$ 次连续乘法 $z \\leftarrow R z$ 来计算 $y = R^k z$。因为 $R$ 是实数且是准上三角矩阵，每次乘法的代价为 $n$ 数量级。因此总代价为 $n^3 + k n$ 数量级，然后是一次与 $Q$ 相乘，代价为 $n$ 数量级。\n\nC. 计算特征值分解 $A = V \\Lambda V^{-1}$，构造 $c = V^{-1} b$，然后得到 $A^k b = V \\Lambda^k c$。这避免了构造 $A^k$，代价为 $n^2 \\log k$ 数量级，因为将对角矩阵 $\\Lambda$ 进行 $k$ 次幂运算的代价为 $\\log k$ 数量级，而通过 $V$ 和 $V^{-1}$ 的变换每次代价为 $n^2$ 数量级。\n\nD. 使用 $A$ 和 $b$ 通过 Arnoldi 过程构建一个维数为 $m = \\lfloor \\log_2 k \\rfloor$ 的 Krylov 子空间，然后使用得到的 Hessenberg 矩阵精确地评估投影的 $m$ 步幂，并提升回全空间，从而得到 $A^k b$ 而不构造 $A^k$。总代价为 $n^2 \\log k$ 数量级，并且当 $m = \\lfloor \\log_2 k \\rfloor$ 时，对于每个 $A$ 和 $b$ 都保证是精确的。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取给定条件**\n\n*   一个离散时间线性时不变状态转移矩阵 $A \\in \\mathbb{C}^{n \\times n}$。\n*   一个向量 $b \\in \\mathbb{C}^{n}$。\n*   一个整数指数 $k \\ge 0$。\n*   计算任务是找到向量 $x = A^k b$ 而不显式地构造矩阵幂 $A^k$。\n*   事实(i)：任何矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 都有一个 Schur 分解 $A = Q T Q^*$，其中 $Q$ 是一个酉矩阵（$Q^* Q = I$），$T$ 是一个上三角矩阵。\n*   事实(ii)：对于酉相似变换，$(Q T Q^*)^k = Q T^k Q^*$。\n*   事实(iii)：Schur 分解的计算代价是 $n^3$ 数量级的运算。一个 $n \\times n$ 上三角矩阵与向量的乘法代价是 $n^2$ 数量级的运算。\n\n**步骤2：使用提取的给定条件进行验证**\n\n该问题具有科学依据。它解决的是数值线性代数和系统理论中的一个基本问题——高效且稳定地计算矩阵幂对向量的作用。所提供的基本事实（Schur 分解的存在性、酉变换的性质、标准的计算复杂度估计）是正确且直接相关的。该问题是适定的、客观的、自洽的并且可形式化的。没有矛盾、歧义或伪科学主张。该问题是有效的。\n\n**步骤3：结论与行动**\n\n问题有效。将推导解答。\n\n**数值稳定算法的推导**\n\n目标是计算 $x = A^k b$。我们被告知可以使用 Schur 分解这一原则。\n设 $A$ 的 Schur 分解为 $A = Q T Q^*$。根据给定的相似变换幂的性质，我们有 $A^k = (Q T Q^*)^k = Q T^k Q^*$。\n\n将此代入 $x$ 的表达式中：\n$$x = (Q T^k Q^*) b$$\n\n利用矩阵乘法的结合律，我们可以对运算进行分组，以避免构造任何稠密矩阵的幂：\n$$x = Q (T^k (Q^* b))$$\n\n这个表达式自然地定义了一个三阶段算法：\n1.  **预处理：** 计算 Schur 分解 $A = Q T Q^*$。对于给定的矩阵 $A$，这是一次性代价。该代价被说明为 $O(n^3)$。\n2.  **变换：** 计算变换后的向量 $z = Q^* b$。由于 $Q^*$ 是一个 $n \\times n$ 矩阵，这个矩阵向量乘法需要 $O(n^2)$ 次运算。\n3.  **核心计算：** 计算向量 $y = T^k z$。这里，$T$ 是一个上三角矩阵。此步骤必须在不显式构造矩阵 $T^k$ 的情况下执行。\n4.  **逆变换：** 计算最终结果 $x = Q y$。这是另一次矩阵向量乘法，代价为 $O(n^2)$ 次运算。\n\n关键部分是计算 $y = T^k z$。存在两种主要策略。\n\n**策略1：连续乘法**\n我们可以通过将矩阵 $T$ 连续应用于向量 $z$ 共 $k$ 次来计算 $y$。\n令 $y_0 = z$。\n对于从 $1$ 到 $k$ 的 $j$，计算 $y_j = T y_{j-1}$。\n最终结果是 $y = y_k$。\n每一步都涉及上三角矩阵 $T$ 与一个向量的一次乘法。此操作的代价为 $O(n^2)$。执行 $k$ 次，该策略的总代价为 $O(k n^2)$。\n\n**策略2：二进制幂（平方-乘）**\n对于大的 $k$，连续乘法效率低下。我们可以使用二进制幂。然而，这种方法通常用于计算矩阵幂 $T^k$ 本身，这涉及到矩阵-矩阵乘法。对一个上三角矩阵进行平方的代价是 $O(n^3)$ 次运算。为了计算 $T^k$，我们将需要大约 $\\log_2 k$ 次这样的平方运算，导致构造必要的矩阵幂 $T^{2^j}$ 的代价为 $O(n^3 \\log k)$。一旦这些幂可用，就将它们与向量相乘。\n该算法的更精确描述如下：令 $k = \\sum_{j=0}^{m} c_j 2^j$ 为 $k$ 的二进制展开，其中 $m = \\lfloor \\log_2 k \\rfloor$。那么 $T^k z = (\\prod_{j: c_j=1} T^{2^j})z$。该算法涉及生成矩阵 $T, T^2, T^4, \\dots, T^{2^m}$，然后将那些 $c_j=1$ 对应的矩阵应用于向量。\n代价主要由矩阵平方决定。有 $m = O(\\log k)$ 次平方，每次代价为 $O(n^3)$，总计为 $O(n^3 \\log k)$。随后的矩阵向量乘积（最多 $m+1$ 个）代价为 $O(n^2 \\log k)$，这是一个低阶项。因此，该策略的总代价为 $O(n^3 \\log k)$。\n\n**最优策略和总复杂度**\n一个稳健的算法会为核心计算选择两种策略中更有效的一种。\n因此，计算 $y = T^k z$ 的代价是 $\\min\\{O(k n^2), O(n^3 \\log k)\\}$。\n\n整个算法的总复杂度是所有阶段代价的总和：\n$$C_{total} = C_{Schur} + C_{transform} + C_{core} + C_{back-transform}$$\n$$C_{total} = O(n^3) + O(n^2) + \\min\\{O(k n^2), O(n^3 \\log k)\\} + O(n^2)$$\n在渐进意义上，$O(n^2)$ 项被 $O(n^3)$ 项吸收。总复杂度为：\n$$C_{total} = O(n^3 + \\min\\{k n^2, n^3 \\log k\\})$$\n\n使用酉矩阵 $Q$ 确保了变换和逆变换步骤是数值稳定的，因为酉矩阵是完美条件的（条件数为1）。这使得基于 Schur 的方法成为稳定计算矩阵函数的标准方法。\n\n**选项评估**\n\n**选项 A：** 该选项建议计算复 Schur 分解 $A = Q T Q^*$，将向量 $b$ 变换为 $z = Q^* b$，使用混合策略计算 $y = T^k z$，然后逆变换得到 $x = Q y$。混合策略包括在连续乘法（代价 $O(k n^2)$）和平方乘方法（代价 $O(n^3 \\log k)$）之间选择代价最小的方法。总复杂度被表述为 $O(n^3 + \\min\\{k n^2, n^3 \\log k\\})$。此描述和复杂度分析与我们的推导完全一致。该算法是数值稳定的。\n**结论：正确。**\n\n**选项 B：** 该选项错误地建议对复矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 使用实 Schur 分解。实 Schur 分解仅适用于实矩阵 $A \\in \\mathbb{R}^{n \\times n}$，并产生一个准上三角矩阵 $R$，而不一定是上三角矩阵。此外，它声称与 $R$ 的矩阵向量乘法代价为 $O(n)$，这是一个严重错误；代价应为 $O(n^2)$。因此，$O(n^3 + k n)$ 的总复杂度分析是错误的。\n**结论：不正确。**\n\n**选项 C：** 该选项建议使用特征值分解 $A = V \\Lambda V^{-1}$。该方法有两个关键缺陷。首先，它仅适用于 $A$ 可对角化的情况；并非所有矩阵都可对角化。对于一般矩阵，必须求助于 Jordan 标准型，而其计算是数值不稳定的。其次，即使 $A$ 可对角化，对于非正规矩阵，特征向量矩阵 $V$ 也可能高度病态，使得计算在数值上不稳定。问题要求的是一个稳定的算法。最后，$O(n^2 \\log k)$ 的复杂度分析是完全错误的，因为它完全忽略了分解本身的 $O(n^3)$ 代价。\n**结论：不正确。**\n\n**选项 D：** 该选项描述了一种 Krylov 子空间方法（Arnoldi 过程）。虽然这些方法在近似计算 $A^k b$ 时很强大，特别是对于大型稀疏矩阵，但该选项提出了一个根本上错误的断言。它声称当子空间维数为 $m = \\lfloor \\log_2 k \\rfloor$ 时，该方法是“保证精确的”。Krylov 方法提供的是一个*近似值*，只有当子空间维数 $m$ 大于或等于 $A$ 关于 $b$ 的最小多项式的次数时，结果才精确。没有普遍的理由表明 $m = \\lfloor \\log_2 k \\rfloor$ 足以保证精确性。该说法没有根据，并且通常是错误的。\n**结论：不正确。**\n\n基于这一严谨分析，只有选项A提出了一个普遍适用、数值稳定且分析正确的算法。", "answer": "$$\\boxed{A}$$", "id": "2905355"}]}