## 引言
在现代科学与工程的诸多领域，从机器人[自主导航](@entry_id:274071)到复杂生态系统的动态建模，准确估计系统内部的不可观测量（即“状态”）是一个核心挑战。当系统动态或测量过程呈现[非线性](@entry_id:637147)时，经典的线性卡尔曼滤波器由于其高斯闭合假设被打破而不再适用，这构成了一个重大的知识鸿沟。为了解决这一难题，研究者们开发了多种近似[贝叶斯滤波](@entry_id:137269)方法，其中[扩展卡尔曼滤波器](@entry_id:199333) (Extended Kalman Filter, EKF) 和[无迹卡尔曼滤波器](@entry_id:166733) (Unscented Kalman Filter, UKF) 是最为突出和广泛应用的两种技术。本文旨在为读者提供一个关于这两种[非线性滤波器](@entry_id:271726)变体的全面而深入的理解。

本文将系统性地引导您穿越[非线性滤波](@entry_id:201008)的理论与实践。在“原理与机制”一章中，我们将深入剖析[非线性](@entry_id:637147)如何从根本上改变了状态估计问题，并详细推导 EKF 基于线性化的近似方法与 UKF 基于[无迹变换](@entry_id:163212)的[采样策略](@entry_id:188482)，对比它们的精度、鲁棒性与局限性。随后，在“应用与跨学科连接”一章中，我们将展示这些滤波器如何在机器人学、航空航天、生态学、化学等多个领域解决真实世界的问题，探讨姿态估计、SLAM、[参数辨识](@entry_id:275549)等高级应用场景。最后，在“动手实践”部分，我们将通过具体的编程练习，帮助您将理论知识转化为解决实际问题的能力。通过这一结构化的学习路径，您将能够掌握在非线性系统中进行稳健状态估计的核心技能。

## 原理与机制

在上一章中，我们介绍了[非线性状态空间模型](@entry_id:144729)在众多科学与工程领域中的普遍性，[并指](@entry_id:276731)出了经典[卡尔曼滤波器](@entry_id:145240)在这些[非线性](@entry_id:637147)问题上的局限性。本章将深入探讨应对这一挑战的两种主流方法——[扩展卡尔曼滤波器](@entry_id:199333) (Extended Kalman Filter, EKF) 和[无迹卡尔曼滤波器](@entry_id:166733) (Unscented Kalman Filter, UKF)——背后的核心原理与运作机制。我们将从[贝叶斯滤波](@entry_id:137269)的递归框架出发，阐明[非线性](@entry_id:637147)如何从根本上改变了问题的性质，并系统地推导 EKF 与 UKF 作为近似解的理论基础与实现细节。

### [非线性](@entry_id:637147)带来的挑战：高斯闭合特性的失效

为了理解[非线性滤波](@entry_id:201008)的复杂性，我们首先回顾[贝叶斯滤波](@entry_id:137269)的基本递归过程。该过程包含两个步骤：预测 (prediction) 和更新 (update)。

1.  **预测**: 通过状态转移模型，将上一时刻的后验概率密度 $p(x_{k-1} | y_{1:k-1})$ 传播为当前时刻的[先验概率](@entry_id:275634)密度 $p(x_k | y_{1:k-1})$。这一步由 Chapman-Kolmogorov 方程描述：
    $p(x_k | y_{1:k-1}) = \int p(x_k | x_{k-1}) \, p(x_{k-1} | y_{1:k-1}) \, dx_{k-1}$

2.  **更新**: 利用当前时刻的测量值 $y_k$，通过贝叶斯准则，将[先验概率](@entry_id:275634)密度 $p(x_k | y_{1:k-1})$ 转化为[后验概率](@entry_id:153467)密度 $p(x_k | y_{1:k})$：
    $p(x_k | y_{1:k}) \propto p(y_k | x_k) \, p(x_k | y_{1:k-1})$

对于[线性高斯系统](@entry_id:200183)，即状态[转移函数](@entry_id:273897) $f$ 和测量函数 $h$ 均为线性，且[过程噪声](@entry_id:270644) $w_k$ 和[测量噪声](@entry_id:275238) $v_k$ 均为[高斯噪声](@entry_id:260752)时，这一递归过程具有一个优雅的**高斯闭合特性** (Gaussian closure property)。具体而言，如果初始状态 $x_0$ 是[高斯分布](@entry_id:154414)的，那么在每一步的预测和更新之后，得到的先验和后验[概率密度函数](@entry_id:140610)都将保持为高斯分布。这是因为：(1) 高斯[随机变量](@entry_id:195330)经过线性变换后仍然是[高斯分布](@entry_id:154414)；(2) 两个高斯概率密度的乘积（在更新步骤中）正比于另一个高斯[概率密度](@entry_id:175496)。由于[高斯分布](@entry_id:154414)完全由其均值和[协方差矩阵](@entry_id:139155)确定，因此整个滤波问题简化为对均值和协[方差](@entry_id:200758)的递归计算，这就是经典[卡尔曼滤波器](@entry_id:145240)的推导基础。[@problem_id:2886785]

然而，当系统模型中的 $f$ 或 $h$ 之一为**[非线性](@entry_id:637147)函数**时，这种闭合特性便会失效。将一个高斯[随机变量](@entry_id:195330)输入一个[非线性](@entry_id:637147)函数，其输出的[分布](@entry_id:182848)通常不再是高斯分布。例如，在预测步骤中，即使 $p(x_{k-1} | y_{1:k-1})$ 是高斯的，经过[非线性变换](@entry_id:636115) $f(x_{k-1})$ 后得到的[分布](@entry_id:182848) $p(f(x_{k-1}) | y_{1:k-1})$ 通常也是非高斯的。与[高斯过程](@entry_id:182192)噪声 $w_k$ 进行卷积虽然会使[分布](@entry_id:182848)平滑，但通常无法将其变回高斯分布。同样，在更新步骤中，如果 $h$ 是[非线性](@entry_id:637147)的，那么似然函数 $p(y_k | x_k)$ 作为 $x_k$ 的函数，其形状也可能是非高斯的。将一个非高斯形状的[似然函数](@entry_id:141927)与（可能已经是非高斯的）先验分布相乘，得到的结果几乎不可能是[高斯分布](@entry_id:154414)。[@problem_id:2886785]

这意味着，对于[非线性系统](@entry_id:168347)，最优[贝叶斯滤波](@entry_id:137269)需要我们精确地传递和更新整个概率密度函数，而不仅仅是其前两阶矩（均值和协[方差](@entry_id:200758)）。这在计算上通常是不可行的，因为它可能需要无限维度的参数来描述[概率密度函数](@entry_id:140610)。正是这种根本性的困难，催生了各种近似滤波方法，其中 EKF 和 UKF 是最杰出的代表。

### 高斯矩闭合：一种统一的近似策略

EKF 和 UKF 的核心思想可以被概括为**高斯矩闭合** (Gaussian moment-closure) [@problem_id:2886814]。既然无法精确地传递真实的、非高斯的后验分布，我们退而求其次：在每个时间步，我们都用一个高斯分布来*近似*真实的[后验分布](@entry_id:145605)。这个[高斯分布](@entry_id:154414)的选择标准是，它的均值和协[方差](@entry_id:200758)尽可能地与真实[分布](@entry_id:182848)的均值和协[方差](@entry_id:200758)相匹配。

通过这种方式，整个滤波问题被强行[拉回](@entry_id:160816)到一个只涉及均值和协[方差](@entry_id:200758)递归的框架中，从而保持了与经典卡尔曼滤波器相似的计算结构。EKF 和 UKF 的根本区别，就在于它们**如何近似计算[非线性变换](@entry_id:636115)后[分布](@entry_id:182848)的均值和协[方差](@entry_id:200758)**。EKF 采用的是基于[局部线性化](@entry_id:169489)的解析近似，而 UKF 采用的是基于确定性采样的统计近似。

### [扩展卡尔曼滤波器 (EKF)](@entry_id:192508)：以线性化进行近似

EKF 是对[卡尔曼滤波器](@entry_id:145240)最直接的扩展。它的核心策略是在每个时间步，围绕当前的最佳状态估计值，对[非线性](@entry_id:637147)函数进行一阶[泰勒级数展开](@entry_id:138468)，从而将[非线性](@entry_id:637147)问题局部近似为线性问题。

#### 机制：EKF 的递归方程

EKF 的算法流程同样分为预测和更新两个步骤。我们用 $\hat{x}_{k}^{+}$ 和 $P_{k}^{+}$ 表示在 $k$ 时刻融合了测量值 $y_k$ 后的后验状态估计及其协[方差](@entry_id:200758)；用 $\hat{x}_{k+1}^{-}$ 和 $P_{k+1}^{-}$ 表示在 $k+1$ 时刻尚未融合测量值 $y_{k+1}$ 的先验状态估计及其协[方差](@entry_id:200758)。

**预测 (Prediction)**

1.  **状态预测**: 将上一时刻的后验[状态估计](@entry_id:169668) $\hat{x}_{k}^{+}$ 直接通过[非线性](@entry_id:637147)状态[转移函数](@entry_id:273897) $f$ 进行传播，得到当前时刻的先验状态估计：
    $\hat{x}_{k+1}^{-} = f(\hat{x}_{k}^{+}, u_k)$

2.  **协[方差](@entry_id:200758)预测**: 协[方差](@entry_id:200758)的传播则通过*线性化*的模型进行。首先，计算状态[转移函数](@entry_id:273897) $f$ 关于状态 $x$ 的[雅可比矩阵](@entry_id:264467) $F_k$，并在上一时刻的后验估计点 $(\hat{x}_{k}^{+}, u_k)$ 进行求值：
    $F_k = \left. \frac{\partial f}{\partial x} \right|_{x = \hat{x}_{k}^{+},\, u = u_k}$
    然后，使用类似于线性卡尔曼滤波器的形式来传播协[方差](@entry_id:200758)，并加上过程噪声的协[方差](@entry_id:200758) $Q_k$：
    $P_{k+1}^{-} = F_k P_{k}^{+} F_k^{\top} + Q_k$

**更新 (Update)**

1.  **计算[雅可比矩阵](@entry_id:264467)**: 计算测量函数 $h$ 关于状态 $x$ 的雅可比矩阵 $H_k$，并在当前时刻的*先验*估计点 $\hat{x}_{k}^{-}$ 进行求值：
    $H_k = \left. \frac{\partial h}{\partial x} \right|_{x = \hat{x}_{k}^{-}}$

2.  **计算新息与新息协[方差](@entry_id:200758)**: 新息（innovation）是实际测量值与预测测量值之差。预测测量值是通过将先验状态估计代入[非线性](@entry_id:637147)测量函数得到的：
    $\tilde{y}_k = y_k - h(\hat{x}_{k}^{-})$
    新息的协[方差](@entry_id:200758) $S_k$ 则通过线性化的模型计算：
    $S_k = H_k P_{k}^{-} H_k^{\top} + R_k$

3.  **计算[卡尔曼增益](@entry_id:145800)**:
    $K_k = P_{k}^{-} H_k^{\top} S_k^{-1}$

4.  **状态更新**: 用带有权重的创新来修正[先验估计](@entry_id:186098)，得到后验估计：
    $\hat{x}_{k}^{+} = \hat{x}_{k}^{-} + K_k \tilde{y}_k = \hat{x}_{k}^{-} + K_k \big(y_k - h(\hat{x}_{k}^{-})\big)$

5.  **协[方差](@entry_id:200758)更新**: 更新协方差矩阵以反映测量信息带来的不确定性减少。有两种等价但[数值稳定性](@entry_id:146550)不同的常用形式：
    *   简化形式: $P_{k}^{+} = (I - K_k H_k) P_{k}^{-}$
    *   Joseph 形式（数值上更稳健）: $P_{k}^{+} = (I - K_k H_k) P_{k}^{-} (I - K_k H_k)^{\top} + K_k R_k K_k^{\top}$

以上两组方程（预测和更新）完整地定义了 EKF 的一次递归。[@problem_id:2886807]

#### 线性化的局限性与失效模式

尽管 EKF 实现简单，但其基于[局部线性化](@entry_id:169489)的思想也带来了固有的局限性，在某些情况下会导致滤波器性能下降甚至发散。

**局部可观测性 vs. 全局不[可观测性](@entry_id:152062)**: EKF 的性能依赖于线性化模型所反映的系统特性。然而，一个[局部线性化](@entry_id:169489)模型可能无法捕捉系统的全局特性。一个经典的例子是静态系统 $x_{k+1}=x_k$ 配合二次测量模型 $y_k = x_k^2 + v_k$。在该模型中，对任意非零状态估计 $m \neq 0$ 进行线性化，得到的测量雅可比 $H=2m$ 是非零的，表明系统在局部是可观测的。然而，从全局来看，状态 $c$ 和 $-c$ 会产生完全相同的测量值 ($c^2$)，这意味着仅凭测量值无法区分状态的符号。EKF 的线性化模型“看”不到这种符号模糊性，它会错误地低估预测测量的真实不确定性。具体来说，EKF 计算出的新息协[方差](@entry_id:200758) $S_{\mathrm{EKF}} = 4m^2P + R$，而真实的[方差](@entry_id:200758)（由 UKF 精确计算）为 $S_{\mathrm{UKF}} = 4m^2P + 2P^2 + R$。EKF 的结果总是偏小 ($S_{\mathrm{EKF}}  S_{\mathrm{UKF}}$)，这导致了过大的[卡尔曼增益](@entry_id:145800)，使滤波器对其（可能错误的）状态估计过于自信，一旦估计符号错误，就很容易走向发散。[@problem_id:2886784]

**近似精度**: EKF 对[非线性变换](@entry_id:636115)后均值的估计，本质上是泰勒展开的零阶项，即 $\bar{g}^{\mathrm{EKF}} = g(\mu)$。而真实均值的泰勒展开为 $\bar{g}^{\mathrm{true}} = g(\mu) + \frac{1}{2}g''(\mu)P + O(P^2)$。因此，EKF 的均值估计存在一个与[二阶导数](@entry_id:144508)相关的、量级为 $O(P)$ 的偏差。例如，对于测量函数 $h(x)=x^2$，其[二阶导数](@entry_id:144508)为常数 $2$，EKF 的估计偏差为 $-P$。对于状态[转移函数](@entry_id:273897) $f(x) = x + \frac{1}{2}\sin(x)$，其[二阶导数](@entry_id:144508)为 $-\frac{1}{2}\sin(x)$，EKF 的估计偏差为 $\frac{1}{4}P\sin(\mu)$。当系统[非线性](@entry_id:637147)较强（即二阶及以上导数较大）或状态不确定性较大（即 $P$ 较大）时，这种偏差会变得非常显著。[@problem_id:2886769]

**几何示例：纯[方位角](@entry_id:164011)测量**: 考虑一个平面机器人，其位置状态为 $x = (x_1, x_2)$，传感器只能测量目标相对于原点的[方位角](@entry_id:164011) $h(x) = \arctan2(x_2, x_1)$。该函数的[雅可比矩阵](@entry_id:264467)为 $H(x) = \begin{pmatrix} \frac{-x_2}{x_1^2 + x_2^2}  \frac{x_1}{x_1^2 + x_2^2} \end{pmatrix}$。通过分析该雅可比[矩阵的[零空](@entry_id:152429)间](@entry_id:171336)，我们发现 $H(x) \cdot x = 0$，这意味着线性化模型对沿径向方向（即从原点到目标的方向）的状态变化不敏感。换言之，单次纯方位角测量无法提供关于目标距离的信息。此外，当机器人位置接近原点 $(0,0)$ 时，[雅可比矩阵](@entry_id:264467)的分母趋于零，导致数值不稳定，这对应于物理上方位角未定义的[奇点](@entry_id:137764)。[@problem_id:2886760]

**量化[线性化误差](@entry_id:751298)**: 我们可以进一步量化 EKF 的[线性化误差](@entry_id:751298)。对于上述纯方位角[测量问题](@entry_id:189139)，假设状态均值位于 $\mu=(r, 0)$，[协方差矩阵](@entry_id:139155)为 $\Sigma = \operatorname{diag}(\sigma_r^2, \sigma_t^2)$，表示径向和切向的不确定性。通过分析泰勒展开的二阶项，可以推导出 EKF [方差估计](@entry_id:268607)中的一个主要误差项（即真实[方差](@entry_id:200758)中的[二阶修正](@entry_id:199233)项）为 $\Delta P_y^{(2)} = \frac{\sigma_r^2 \sigma_t^2}{r^4}$。这个误差项随着距离 $r$ 的减小或不确定性（特别是切向不确定性 $\sigma_t^2$）的增大而急剧增加。我们可以设定一个误差容忍度 $\tau^2$，当 $\Delta P_y^{(2)} \ge \tau^2$ 时，就认为 EKF 的线性化近似失效。由此可以解出一个临界的“[椭圆度](@entry_id:199972)” $\kappa_{\mathrm{crit}} = (\sigma_t^2/\sigma_r^2)_{\mathrm{crit}} = (\frac{\tau r^2}{\sigma_r^2})^2$。这个结果为判断 EKF 在特定条件下是否适用提供了一个定量的标准。[@problem_id:2886757]

### [无迹卡尔曼滤波器 (UKF)](@entry_id:191842)：以确定性采样进行近似

面对 EKF 的种种局限，[无迹卡尔曼滤波器 (UKF)](@entry_id:191842) 提供了一种截然不同的解决思路。其核心理念是：**近似一个[概率分布](@entry_id:146404)，通常比近似一个任意的[非线性](@entry_id:637147)函数要容易**。UKF 绕过了对[非线性](@entry_id:637147)函数本身的解析线性化，转而采用一种名为**[无迹变换](@entry_id:163212)** (Unscented Transform, UT) 的确定性[采样方法](@entry_id:141232)来直接近似变换后[分布的矩](@entry_id:156454)。

#### 机制：[无迹变换](@entry_id:163212) (UT)

[无迹变换](@entry_id:163212)是一种计算经过[非线性](@entry_id:637147)[函数变换](@entry_id:141095)后[随机变量](@entry_id:195330)统计特性的方法。对于一个 $n$ 维高斯[随机变量](@entry_id:195330) $x \sim \mathcal{N}(\hat{x}, P)$ 和一个[非线性](@entry_id:637147)函数 $y=g(x)$，UT 的步骤如下：

1.  **选择 Sigma 点**: 首先，根据均值 $\hat{x}$ 和协[方差](@entry_id:200758) $P$ 构造一组 $2n+1$ 个被称为 **Sigma 点** 的确定性样本 $\{\chi_i\}$。在一个被称为“缩放[无迹变换](@entry_id:163212)”的标准形式中，这组点由三个参数 $\alpha, \beta, \kappa$ 控制。首先定义一个[复合缩放](@entry_id:633992)参数 $\lambda = \alpha^2(n+\kappa) - n$。然后计算矩阵的平方根 $S$，使得 $SS^\top = (n+\lambda)P$（通常使用 [Cholesky分解](@entry_id:147066)）。Sigma 点的生成规则为：
    *   $\chi_0 = \hat{x}$
    *   $\chi_i = \hat{x} + S_{:,i} \quad \text{for } i \in \{1, \dots, n\}$
    *   $\chi_{i+n} = \hat{x} - S_{:,i} \quad \text{for } i \in \{1, \dots, n\}$
    其中 $S_{:,i}$ 是矩阵 $S$ 的第 $i$ 列。这组点被对称地[分布](@entry_id:182848)在均值的周围，其[分布](@entry_id:182848)形状由[协方差矩阵](@entry_id:139155)决定。

2.  **计算权重**: 为这些 Sigma 点分配两组权重：一组用于计算均值 ($W_i^{(m)}$)，另一组用于计算协[方差](@entry_id:200758) ($W_i^{(c)}$)。
    *   均值权重:
        $W_0^{(m)} = \frac{\lambda}{n+\lambda}$,
        $W_i^{(m)} = \frac{1}{2(n+\lambda)} \quad \text{for } i \in \{1, \dots, 2n\}$
    *   协[方差](@entry_id:200758)权重:
        $W_0^{(c)} = \frac{\lambda}{n+\lambda} + (1 - \alpha^2 + \beta)$,
        $W_i^{(c)} = \frac{1}{2(n+\lambda)} \quad \text{for } i \in \{1, \dots, 2n\}$
    中心点 $\chi_0$ 的协[方差](@entry_id:200758)权重 $W_0^{(c)}$ 中包含的项 $(1-\alpha^2+\beta)$ 用于引入关于[分布](@entry_id:182848)峰度的额外信息，对于高斯分布，最优选择是 $\beta=2$。

3.  **传播 Sigma 点**: 将每个 Sigma 点代入[非线性](@entry_id:637147)函数 $g$，得到一组变换后的点 $\mathcal{Y}_i = g(\chi_i)$。

4.  **重构均值和协[方差](@entry_id:200758)**: 将变换后的点 $\mathcal{Y}_i$ 按照预设的权重进行加权平均，得到变换后[分布](@entry_id:182848)的均值 $\hat{y}$ 和协[方差](@entry_id:200758) $P_{yy}$ 的近似值：
    *   $\hat{y} \approx \sum_{i=0}^{2n} W_i^{(m)} \mathcal{Y}_i$
    *   $P_{yy} \approx \sum_{i=0}^{2n} W_i^{(c)} (\mathcal{Y}_i - \hat{y})(\mathcal{Y}_i - \hat{y})^\top$

UKF 算法就是将 EKF 中的线性化[传播步骤](@entry_id:204825)替换为上述的[无迹变换](@entry_id:163212)过程。在预测步骤中，使用 UT 传播[状态和](@entry_id:193625)协[方差](@entry_id:200758)；在更新步骤中，再次使用 UT 计算预测测量、新息协[方差](@entry_id:200758)和状态-测量互协[方差](@entry_id:200758)。[@problem_id:2886801]

#### UKF 的优势

与 EKF 相比，UKF 在多个方面展现出显著的优势。

**更高的精度**: 通过[泰勒级数分析](@entry_id:171242)可以证明，[无迹变换](@entry_id:163212)估计的均值偏差是 $O(P^2)$ 量级，这比 EKF 的 $O(P)$ 量级要小得多。这意味着在不确定性较小时，UKF 的估计偏差会更快地趋于零。对于前面提到的例子 $f(x)=x+\frac{1}{2}\sin(x)$，UKF 的偏差为 $\frac{\lambda-2}{48}P^2\sin(\mu)$。更重要的是，对于任意二次[非线性](@entry_id:637147)函数（如 $h(x)=x^2$），[无迹变换](@entry_id:163212)可以**精确地**捕捉其变换后的均值和协[方差](@entry_id:200758)，因此其偏差为零。这解释了为什么在二次测量模型问题中，UKF 能够正确计算新息[方差](@entry_id:200758)，而 EKF 不能。[@problem_id:2886769]

**无需计算[雅可比矩阵](@entry_id:264467)**: 这是 UKF 在实践中最大的一个优点。它避免了对复杂[非线性](@entry_id:637147)函数进行解析求导的需要，这些求导工作不仅繁琐、容易出错，而且对于某些函数（如[黑箱模型](@entry_id:637279)）来说根本不可行。UKF 的实现只需要能够调用函数本身即可。

**更强的鲁棒性**: 由于 UKF 不依赖于[局部线性化](@entry_id:169489)，它对强[非线性](@entry_id:637147)和[奇点](@entry_id:137764)附近的表现通常更好。在纯[方位角](@entry_id:164011)[测量问题](@entry_id:189139)中，UKF 不会遇到雅可比矩阵在原点“爆炸”的问题。更重要的是，对于具有周期性或“环绕” (wrap-around) 特性的函数，如 $\arctan2$，UKF 可以通过在重构步骤中使用适当的平均方法（如循环统计学）来自然地处理。例如，在计算平均角度时，可以将角度转换为二维[单位向量](@entry_id:165907)，对向量进行平均，然后将结果向量转换回角度。这是 EKF 的线性近似完全无法做到的。[@problem_id:2886760]

### 实践考量与模型假设

要正确应用 EKF 和 UKF，必须满足一系列关于模型和噪声的假设。

#### 适用性与基本假设

1.  **公共概率假设**: 两种滤波器的递归结构都依赖于噪声的统计特性。标准推导要求[过程噪声](@entry_id:270644) $\{w_k\}$ 和[测量噪声](@entry_id:275238) $\{v_k\}$ 均为**零均值、[白噪声](@entry_id:145248)**（即时间上不相关）、**[高斯分布](@entry_id:154414)**序列。此外，过程噪声、测量噪声和初始状态 $x_0$ 必须是**[相互独立](@entry_id:273670)**的。初始状态 $x_0$ 本身也假设为[高斯分布](@entry_id:154414)。违反这些假设（如存在[有色噪声](@entry_id:265434)或噪声之间存在相关性）需要对标准算法进行修改。

2.  **[函数正则性](@entry_id:184255)要求的差异**: 两种方法对[非线性](@entry_id:637147)函数 $f$ 和 $h$ 的要求不同。
    *   **EKF** 要求 $f$ 和 $h$ 在工作点附近是**连续可微的**（$C^1$），这样才能计算[雅可比矩阵](@entry_id:264467)。
    *   **UKF** 不要求函数可微，只需要函数在 Sigma 点处是**可评估的**。为了保证数值稳定，通常要求函数是连续的。

[@problem_id:2886825]

#### 噪声的处理：加性与非加性模型

噪声如何进入系统模型，对滤波器的设计有重要影响。

**[加性噪声](@entry_id:194447) (Additive Noise)**: 噪声在[线性变换](@entry_id:149133)后被加到确定性函数的结果上。模型形式为：
$x_{k+1} = f(x_k, u_k) + G_k w_k$
$y_k = h(x_k) + M_k v_k$
在这种情况下，由于[状态和](@entry_id:193625)噪声是独立地通过各自的变换，均值和协[方差](@entry_id:200758)的计算可以解耦。例如，预测协[方差](@entry_id:200758)可以分为两部分：先计算 $f(x_k, u_k)$ 经过[非线性变换](@entry_id:636115)后的协[方差](@entry_id:200758)，然后直接加上噪声的协[方差](@entry_id:200758) $G_k Q_k G_k^\top$。对于 UKF，这意味着我们可以只用状态的 Sigma 点通过 $f$ 进行传播，然后将噪声协[方差](@entry_id:200758)加到结果上，而无需将噪声向量也包含在 Sigma 点的生成过程中，这大大降低了计算维度。可以证明，对于[加性噪声](@entry_id:194447)，这种简化方法与将[状态和](@entry_id:193625)噪声一起增广进行[无迹变换](@entry_id:163212)得到的结果是完全等价的。[@problem_id:2886782]

**非[加性噪声](@entry_id:194447) (Non-additive Noise)**: 噪声和状态一起进入[非线性](@entry_id:637147)函数。模型形式为：
$x_{k+1} = f(x_k, u_k, w_k)$
$y_k = h(x_k, v_k)$
在这种情况下，[状态和](@entry_id:193625)噪声之间存在[非线性](@entry_id:637147)耦合，不能简单地将它们的协[方差](@entry_id:200758)相加。
*   对于 **EKF**，线性化必须同时对状态 $x_k$ 和噪声 $w_k$ 进行，因此需要计算函数关于噪声的[雅可比矩阵](@entry_id:264467) $\frac{\partial f}{\partial w}$。
*   对于 **UKF**，必须将[状态向量](@entry_id:154607)和噪声向量**增广** (augment) 成一个更大的向量 $x_a = [x^\top, w^\top]^\top$，然后对这个增广向量进行[无迹变换](@entry_id:163212)。这会增加 Sigma 点的数量和计算的复杂度，但这是正确捕捉[非线性](@entry_id:637147)交互作用所必需的。

错误地将[加性噪声](@entry_id:194447)的简化处理方法用于非加性模型，会导致严重错误，因为这忽略了状态与噪声在[非线性](@entry_id:637147)函数内部的交叉影响。[@problem_id:2886782]

综上所述，EKF 和 UKF 都是在[贝叶斯滤波](@entry_id:137269)框架下，通过高斯矩闭合思想解决[非线性](@entry_id:637147)问题的强大工具。EKF 凭借其简单性而被广泛使用，但其性能受限于线性化近似的准确性。UKF 通过更高阶的近似和对雅可比矩阵的无依赖性，在精度和鲁棒性方面通常表现更优，尤其是在处理强[非线性](@entry_id:637147)或特殊函数结构时。选择哪种滤波器，取决于对系统[非线性](@entry_id:637147)程度、模型复杂性、计算资源以及所需精度的综合考量。