## 引言
在信号处理、控制理论、经济学和生物学等众多科学与工程领域，准确估计动态系统的[隐藏状态](@entry_id:634361)是一项核心任务。然而，当系统表现出[非线性](@entry_id:637147)行为或受到非[高斯噪声](@entry_id:260752)干扰时，传统的线性方法（如[卡尔曼滤波](@entry_id:145240)）便失去了效力，这为理解和预测复杂的现实世界现象带来了巨大挑战。[粒子滤波](@entry_id:140084)作为一种强大而灵活的贝叶斯推断工具，正是为了填补这一知识鸿沟而生，它通过基于模拟的[序贯蒙特卡洛](@entry_id:147384)方法，为解决这类难题提供了通用的计算框架。

本文旨在为读者提供一个关于[粒子滤波](@entry_id:140084)的全面而深入的指南。在接下来的内容中，我们将分三步展开：首先，在“原理与机制”一章中，我们将剖析算法的数学基础，从[贝叶斯滤波](@entry_id:137269)的基本递归讲起，揭示[粒子滤波](@entry_id:140084)如何通过[重要性采样](@entry_id:145704)和[重采样](@entry_id:142583)来近似求解。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章，我们将展示[粒子滤波](@entry_id:140084)在状态平滑、[参数估计](@entry_id:139349)以及宏观经济、量化金融等多个领域的强大应用，并探讨其高级变体。最后，通过“动手实践”部分，您将有机会将理论知识应用于具体编程问题，从而巩固学习成果。

现在，让我们首先深入探讨[粒子滤波算法](@entry_id:202446)背后的核心原理与关键机制。

## 原理与机制

在上一章引言的基础上，本章将深入探讨[粒子滤波算法](@entry_id:202446)背后的核心原理与关键机制。我们将从一般的[贝叶斯滤波](@entry_id:137269)问题出发，阐明为何经典方法（如[卡尔曼滤波](@entry_id:145240)）在处理[非线性](@entry_id:637147)、非高斯系统时会失效。随后，我们将系统地介绍作为[粒子滤波](@entry_id:140084)基础的[蒙特卡洛方法](@entry_id:136978)，特别是重要性采样。最后，我们将详细剖析[序贯蒙特卡洛](@entry_id:147384)（SMC）方法的具体实现，即标准[粒子滤波算法](@entry_id:202446)，并讨论其在实践中面临的挑战，如粒子退化、路径退化以及[维度灾难](@entry_id:143920)等问题。

### 一般[贝叶斯滤波](@entry_id:137269)问题

动态[状态空间模型](@entry_id:137993)为描述一个随[时间演化](@entry_id:153943)的系统提供了一个强大的数学框架。该模型包含两个核心部分：一个描述系统状态如何从一个时间步转移到下一个时间步的**状态转移模型**，以及一个描述在给定当前系统状态下如何生成观测值的**观测模型**。

形式上，我们假设一个[隐藏状态](@entry_id:634361)过程 $\{x_t\}_{t \ge 0}$，其中 $x_t \in \mathbb{R}^{d_x}$ 是在时间 $t$ 的[状态向量](@entry_id:154607)。该过程是马尔可夫的，其动态由**转移概率密度** $p(x_t | x_{t-1})$ 描述。同时，我们拥有一系列观测值 $\{y_t\}_{t \ge 1}$，其中 $y_t \in \mathbb{R}^{d_y}$。观测值 $y_t$ 的生成依赖于当前状态 $x_t$，其关系由**观测[概率密度](@entry_id:175496)**（或**似然**）$p(y_t | x_t)$ 描述。我们假定在给定当前状态 $x_t$ 的条件下，观测值 $y_t$ 与所有过去的[状态和](@entry_id:193625)观测值均是独立的。

滤波的目标是根据截至时间 $t$ 的所有可用观测值 $y_{1:t} = (y_1, \dots, y_t)$，实时地推断当前状态 $x_t$ 的后验概率[分布](@entry_id:182848)，即**滤波[分布](@entry_id:182848)** $p(x_t | y_{1:t})$。这个问题可以通过一个递归的两步过程来解决，即**预测**和**更新**。

1.  **预测 (Prediction)**：假设我们已经拥有在 $t-1$ 时刻的滤波[分布](@entry_id:182848) $p(x_{t-1} | y_{1:t-1})$。预测步骤的目标是计算在获得新观测 $y_t$ 之前，对状态 $x_t$ 的先验分布，即**[预测分布](@entry_id:165741)** $p(x_t | y_{1:t-1})$。这可以通过[全概率公式](@entry_id:194231)（或查普曼-科尔莫戈罗夫方程）实现：
    $$
    p(x_t | y_{1:t-1}) = \int p(x_t | x_{t-1}) \, p(x_{t-1} | y_{1:t-1}) \, \mathrm{d}x_{t-1}
    $$
    该积分将上一时刻的后验知识通过系统动态模型 $p(x_t | x_{t-1})$ 向前传播，从而得到对当前状态的预测。

2.  **更新 (Update)**：一旦接收到新的观测值 $y_t$，我们就可以使用贝叶斯定理来更新[预测分布](@entry_id:165741)，从而得到当前时刻的[后验分布](@entry_id:145605) $p(x_t | y_{1:t})$：
    $$
    p(x_t | y_{1:t}) = \frac{p(y_t | x_t) \, p(x_t | y_{1:t-1})}{p(y_t | y_{1:t-1})}
    $$
    其中，分母 $p(y_t | y_{1:t-1})$ 是观测的**[边际似然](@entry_id:636856)**或**证据 (evidence)**，它是一个归一化常数，确保后验分布的积分为1。其计算方式如下：
    $$
    p(y_t | y_{1:t-1}) = \int p(y_t | x_t) \, p(x_t | y_{1:t-1}) \, \mathrm{d}x_t
    $$

这个递归过程构成了[贝叶斯滤波](@entry_id:137269)的理论核心 [@problem_id:2890402]。然而，上述的预测和更新步骤都涉及到[高维积分](@entry_id:143557)。除了少数特殊情况，这些积分通常没有解析解，这使得直接计算滤波[分布](@entry_id:182848)变得不可行。

### 解析解的局限性：以[卡尔曼滤波](@entry_id:145240)为例

在状态空间模型的一个重要特例——**[线性高斯模型](@entry_id:268963)**中，[贝叶斯滤波](@entry_id:137269)问题存在一个著名的解析解，即**[卡尔曼滤波](@entry_id:145240)**。理解卡尔曼滤波的适用条件及其局限性，是理解[粒子滤波](@entry_id:140084)等更普适方法动机的关键。

一个[线性高斯模型](@entry_id:268963)假设：
1.  **线性状态转移**：状态转移由[线性方程](@entry_id:151487)和加性高斯噪声描述：$x_t = F_t x_{t-1} + w_t$，其中 $w_t \sim \mathcal{N}(0, Q_t)$。这意味着转移密度 $p(x_t | x_{t-1})$ 是一个[高斯分布](@entry_id:154414)。
2.  **线性观测模型**：观测值同样由线性方程和加性[高斯噪声](@entry_id:260752)生成：$y_t = H_t x_t + v_t$，其中 $v_t \sim \mathcal{N}(0, R_t)$。这意味着似然函数 $p(y_t | x_t)$ 也是一个高斯函数。
3.  **高斯初始先验**：初始状态的先验分布 $p(x_0)$ 是高斯分布。

在这些假设下，卡尔曼滤波之所以能够提供精确的解析解，其根本在于**高斯分布的[闭包性质](@entry_id:136899)** [@problem_id:2890466]。具体而言：
-   在**预测步骤**中，如果 $p(x_{t-1} | y_{1:t-1})$ 是[高斯分布](@entry_id:154414)，那么经过[线性变换](@entry_id:149133) $F_t x_{t-1}$ 后它仍然是[高斯分布](@entry_id:154414)。随后，与另一个独立的[高斯噪声](@entry_id:260752) $w_t$ 进行卷积（即相加），其结果依然是高斯分布。因此，[预测分布](@entry_id:165741) $p(x_t | y_{1:t-1})$ 保持了高斯性。
-   在**更新步骤**中，[后验分布](@entry_id:145605)与[预测分布](@entry_id:165741)（高斯）和[似然函数](@entry_id:141927)（也是高斯）的乘积成正比。两个高斯函数的乘积（在归一化后）仍然是一个高斯函数。因此，滤波[分布](@entry_id:182848) $p(x_t | y_{1:t})$ 也保持了高斯性。

通过[数学归纳法](@entry_id:138544)可知，只要系统是线性高斯的，所有时刻的滤波[分布](@entry_id:182848)都将是高斯分布。[卡尔曼滤波](@entry_id:145240)算法正是通过递归地计算这些高斯分布的均值和协方差矩阵来实现的。

然而，一旦模型的线性或[高斯假设](@entry_id:170316)被打破，这种优美的[闭包性质](@entry_id:136899)便不复存在 [@problem_id:2890466]。
-   **[非线性](@entry_id:637147) (Nonlinearity)**：如果状态[转移函数](@entry_id:273897) $f(\cdot)$ 或观测函数 $h(\cdot)$ 是[非线性](@entry_id:637147)的（例如，$x_t = \sin(x_{t-1}) + w_t$ 或 $y_t = x_t^2 + v_t$），那么一个高斯分布经过[非线性变换](@entry_id:636115)后通常不再是[高斯分布](@entry_id:154414)。例如，若 $X \sim \mathcal{N}(0, 1)$，则 $X^2$ 服从卡方分布，而非[高斯分布](@entry_id:154414)。这会破坏预测或更新步骤中的高斯性。
-   **非高斯性 (Non-Gaussianity)**：即使[系统函数](@entry_id:267697)是线性的，如果过程噪声 $w_t$ 或观测噪声 $v_t$ 服从非[高斯分布](@entry_id:154414)（如[拉普拉斯分布](@entry_id:266437)或多峰[分布](@entry_id:182848)），滤波过程同样会产生非[高斯分布](@entry_id:154414)。例如，在预测步骤中，一个[高斯分布](@entry_id:154414)与一个非高斯[分布的卷积](@entry_id:195954)通常是非高斯的 [@problem_id:2890402]。

当滤波[分布](@entry_id:182848)不再是[高斯分布](@entry_id:154414)时，仅用均值和协[方差](@entry_id:200758)已不足以描述其完整形态（例如，[分布](@entry_id:182848)可能是多峰的或偏斜的）。因此，卡尔曼滤波及其变体（如扩展卡尔曼滤波 EKF 和无迹卡尔曼滤波 UKF，它们本质上仍是[高斯近似](@entry_id:636047)）将不再是精确解，其性能也可能严重下降。这就为能够处理任意[分布](@entry_id:182848)的数值方法——[粒子滤波](@entry_id:140084)——的出现铺平了道路。

### 基于[蒙特卡洛](@entry_id:144354)的[近似推断](@entry_id:746496)

既然解析积分不可行，一个自然的想法是采用数值方法来近似。**[蒙特卡洛方法](@entry_id:136978)**为此提供了一个强大而通用的框架。其核心思想是，用从目标分布中抽取的大量随机样本来近似该[分布](@entry_id:182848)，并用样本均值来估算期望。

在滤波问题中，我们通常关心的是关于状态的某个函数 $\varphi(x_t)$ 的[期望值](@entry_id:153208)，例如状态的均值（此时 $\varphi(x_t) = x_t$）或[方差](@entry_id:200758)。根据期望的定义，这个条件期望可以写成一个积分 [@problem_id:2890451]：
$$
\mathbb{E}[\varphi(x_t) | y_{1:t}] = \int \varphi(x_t) \, p(x_t | y_{1:t}) \, \mathrm{d}x_t
$$
如果我们能够从后验分布 $p(x_t | y_{1:t})$ 中抽取 $N$ 个[独立同分布](@entry_id:169067) (i.i.d.) 的样本（或称为**粒子**）$\{x_t^{(i)}\}_{i=1}^N$，那么根据[大数定律](@entry_id:140915)，我们可以通过计算这些样本的经验平均来近似这个积分：
$$
\mathbb{E}[\varphi(x_t) | y_{1:t}] \approx \frac{1}{N} \sum_{i=1}^N \varphi(x_t^{(i)})
$$
当粒子数 $N \to \infty$ 时，这个近似值将收敛到真实的[期望值](@entry_id:153208)，这表明该估计量是**一致的 (consistent)** [@problem_id:2890451]。

然而，一个核心的困难在于，[后验分布](@entry_id:145605) $p(x_t | y_{1:t})$ 通常形式复杂，我们无法直接从中进行采样。**[重要性采样](@entry_id:145704) (Importance Sampling)** 巧妙地解决了这个问题。其思想是，从一个我们能够采样的、相对简单的**[提议分布](@entry_id:144814) (proposal distribution)** $q(x_t)$ 中抽取样本，然后对这些样本进行加权，以修正因[采样分布](@entry_id:269683)与目标分布不匹配所带来的偏差。

具体来说，我们可以将期望的积分重写为：
$$
\mathbb{E}[\varphi(x_t) | y_{1:t}] = \int \varphi(x_t) \frac{p(x_t | y_{1:t})}{q(x_t)} q(x_t) \, \mathrm{d}x_t = \mathbb{E}_{x_t \sim q} \left[ \varphi(x_t) w(x_t) \right]
$$
其中，**重要性权重** $w(x_t)$ 定义为[目标分布](@entry_id:634522)与提议分布的比值：
$$
w(x_t) = \frac{p(x_t | y_{1:t})}{q(x_t)}
$$
这个等式表明，我们可以通过从提议分布 $q(x_t)$ 中抽取样本 $\{x_t^{(i)}\}_{i=1}^N$，计算每个样本的权重 $w_t^{(i)} = p(x_t^{(i)} | y_{1:t})/q(x_t^{(i)})$，然后计算加权平均来近似期望。

在贝叶斯推断中，后验分布 $p(x_t | y_{1:t})$ 通常只知道其与 $p(y_t | x_t)p(x_t | y_{1:t-1})$ 成正比，而归一化常数是未知的。幸运的是，我们可以使用**[自归一化](@entry_id:636594) (self-normalized)** 的[重要性采样](@entry_id:145704)。我们计算非归一化的权重 $\tilde{w}_t^{(i)} \propto p(x_t^{(i)} | y_{1:t}) / q(x_t^{(i)})$，然后将它们归一化：
$$
W_t^{(i)} = \frac{\tilde{w}_t^{(i)}}{\sum_{j=1}^N \tilde{w}_t^{(j)}}
$$
这样，未知[归一化常数](@entry_id:752675)在分子和分母中被抵消了 [@problem_id:2890408]。最终的估计量为：
$$
\mathbb{E}[\varphi(x_t) | y_{1:t}] \approx \sum_{i=1}^N W_t^{(i)} \varphi(x_t^{(i)})
$$
这个[自归一化](@entry_id:636594)的估计量对于有限的 $N$ 是有偏的，但在温和的条件下，它仍然是一致的，即当 $N \to \infty$ 时收敛到真值 [@problem_id:2890451]。

### [序贯重要性采样](@entry_id:754702)与重采样

[粒子滤波](@entry_id:140084)的本质，就是将重要性采样的思想应用到序贯的[贝叶斯滤波](@entry_id:137269)框架中，形成一种称为**[序贯重要性采样](@entry_id:754702) (Sequential Importance Sampling, SIS)** 的方法。

假设在 $t-1$ 时刻，我们有一组带权重的粒子 $\{(x_{t-1}^{(i)}, W_{t-1}^{(i)})\}_{i=1}^N$，它们近似地表示了滤波[分布](@entry_id:182848) $p(x_{t-1} | y_{1:t-1})$。为了得到在 $t$ 时刻的粒[子表示](@entry_id:141094)，我们执行以下步骤：
1.  **传播 (Propagation)**：为每个已有的粒子 $x_{t-1}^{(i)}$，从一个提议分布 $q(x_t | x_{t-1}^{(i)}, y_t)$ 中采样一个新的状态 $x_t^{(i)}$。
2.  **加权 (Weighting)**：更新每个粒子的权重。权重更新的[递归公式](@entry_id:160630)为：
    $$
    W_t^{(i)} \propto W_{t-1}^{(i)} \frac{p(y_t | x_t^{(i)}) p(x_t^{(i)} | x_{t-1}^{(i)})}{q(x_t^{(i)} | x_{t-1}^{(i)}, y_t)}
    $$
    然后对所有权重进行归一化，使其总和为1。

最简单且最常见的[粒子滤波算法](@entry_id:202446)是**自助[粒子滤波](@entry_id:140084) (Bootstrap Particle Filter)** 或称**[序贯重要性重采样](@entry_id:754701) (Sequential Importance Resampling, SIR)** 滤波。它做出一个关键的简化选择：使用状态转移先验 $p(x_t | x_{t-1})$ 作为[提议分布](@entry_id:144814)，即 $q(x_t | x_{t-1}^{(i)}, y_t) = p(x_t | x_{t-1}^{(i)})$ [@problem_id:2890365]。这个选择虽然不是最优的（因为它没有利用最新的观测值 $y_t$ 来指导粒子的传播），但极大地简化了权重更新公式。代入该提议分布后，权重更新因子变为：
$$
\frac{p(y_t | x_t^{(i)}) p(x_t^{(i)} | x_{t-1}^{(i)})}{p(x_t^{(i)} | x_{t-1}^{(i)})} = p(y_t | x_t^{(i)})
$$
因此，权重更新非常直观：$W_t^{(i)} \propto W_{t-1}^{(i)} p(y_t | x_t^{(i)})$。这意味着，旧粒子的权重乘以它所产生的新粒子与新观测的匹配程度（即[似然](@entry_id:167119)），就得到了新粒子的权重 [@problem_id:2890451]。

然而，纯粹的[序贯重要性采样](@entry_id:754702)有一个致命的缺陷：**权重退化 (Weight Degeneracy)**。随着时间的推移，权重的[方差](@entry_id:200758)会不断增大。几轮迭代之后，绝大多数粒子的权重会变得非常接近于零，只有一个或少数几个粒子的权重接近于1 [@problem_id:2890369]。这意味着大量的计算资源被浪费在更新那些几乎对[后验分布](@entry_id:145605)没有贡献的粒子上。

为了量化权重[退化现象](@entry_id:183258)，我们引入**[有效样本量](@entry_id:271661) (Effective Sample Size, ESS)** 的概念，其一个常用估计为：
$$
N_{\text{eff}} = \frac{1}{\sum_{i=1}^N (W_t^{(i)})^2}
$$
其中 $W_t^{(i)}$ 是归一化权重。$N_{\text{eff}}$ 的取值范围是 $[1, N]$。当所有权重都相等时（$W_t^{(i)} = 1/N$），$N_{\text{eff}} = N$，表示没有退化。当只有一个粒子的权重为1时，$N_{\text{eff}} = 1$，表示完全退化。在实践中，我们可以设定一个阈值（例如 $N/2$），当 $N_{\text{eff}}$ 低于此阈值时，就认为发生了严重的权重退化 [@problem_id:2890369]。

解决权重退化问题的标准方法是**重采样 (Resampling)**。其核心思想是，根据当前粒子的权重，有放回地从粒[子集](@entry_id:261956)中重新抽取 $N$ 个粒子。高权重的粒子有更大概率被多次选中，而低权重的粒子则可能被丢弃。[重采样](@entry_id:142583)之后，所有新抽出的粒子的权重都被重置为均等的 $1/N$。这样，计算资源就集中到了后验分布中[概率密度](@entry_id:175496)较高的区域，[有效样本量](@entry_id:271661)也恢复到最大值 $N$ [@problem_id:2890369]。

结合了[重采样](@entry_id:142583)的SIR/自助[粒子滤波算法](@entry_id:202446)的完整流程如下 [@problem_id:2890365]：
1.  **初始化 ($t=0$)**：从[先验分布](@entry_id:141376) $p(x_0)$ 中抽取 $N$ 个粒子 $\{x_0^{(i)}\}_{i=1}^N$，并设置初始权重 $W_0^{(i)} = 1/N$。
2.  **对于 $t=1, 2, \dots$**：
    a. **[重采样](@entry_id:142583) (可选)**：如果 $N_{\text{eff}}$ 过低，则从当前的粒[子集](@entry_id:261956) $\{x_{t-1}^{(i)}\}_{i=1}^N$ 中根据权重 $\{W_{t-1}^{(i)}\}_{i=1}^N$ 进行重采样，得到一个新的粒[子集](@entry_id:261956) $\{\tilde{x}_{t-1}^{(i)}\}_{i=1}^N$，并重置权重为 $W_{t-1}^{(i)} \leftarrow 1/N$。
    b. **传播**：对于每个粒子 $\tilde{x}_{t-1}^{(i)}$，从状态转移模型中采样一个新的状态：$x_t^{(i)} \sim p(x_t | \tilde{x}_{t-1}^{(i)})$。
    c. **加权**：根据新的观测 $y_t$，计算每个新粒子的非归一化权重：$\tilde{W}_t^{(i)} = p(y_t | x_t^{(i)})$。（如果上一步没有[重采样](@entry_id:142583)，则 $\tilde{W}_t^{(i)} = W_{t-1}^{(i)} p(y_t | x_t^{(i)})$）。
    d. **归一化**：归一化权重：$W_t^{(i)} = \tilde{W}_t^{(i)} / \sum_{j=1}^N \tilde{W}_t^{(j)}$。

有多种[重采样](@entry_id:142583)算法可供选择，如**[多项式重采样](@entry_id:752299) (Multinomial Resampling)**、**分层重采样 (Stratified Resampling)**、**系统重采样 (Systematic Resampling)** 和 **残差重采样 (Residual Resampling)**。其中，分层和系统重采样通常能提供比基本的[多项式重采样](@entry_id:752299)更低的[方差](@entry_id:200758)，因此在实践中更为常用 [@problem_id:2890427]。

### 理论保证与局限性

[粒子滤波](@entry_id:140084)作为一个近似算法，其有效性建立在坚实的理论基础之上，但同时也存在固有的局限性。

#### 一致性
[粒子滤波](@entry_id:140084)的一个关键理论保证是其**一致性 (Consistency)**。对于一个固定的时间范围 $t$，只要粒子数 $N$ 趋于无穷大，[粒子滤波](@entry_id:140084)得到的[后验分布近似](@entry_id:753632)就会收敛到真实的后验分布 [@problem_id:2890470]。这个结论可以通过对时间 $t$ 的[数学归纳法](@entry_id:138544)来证明。其基础在于，每一步的重要性采样和[重采样](@entry_id:142583)在作为[随机过程](@entry_id:159502)的近似操作时都是“正确”的，并且[大数定律](@entry_id:140915)保证了当 $N$ 足够大时，由样本构成的[经验分布](@entry_id:274074)会逼近真实的连续分布。

#### 长期退化问题：路径退化
尽管重采样解决了权重退化问题，但它也引入了一个更为微妙的长期问题——**路径退化 (Path Degeneracy)** [@problem_id:2890415]。每次[重采样](@entry_id:142583)都会复制一些粒子路径（祖先），同时消除另一些。随着时间不断累积，如果频繁地进行[重采样](@entry_id:142583)，粒[子群](@entry_id:146164)的“家谱”会不断合并。追溯回去，当前时刻的所有 $N$ 个粒子可能都起源于过去某个时刻的同一个祖先粒子。这种现象称为**谱系合并 (Coalescence of Ancestry)**。

其结果是，虽然在当前时刻 $t$，粒子 $\{x_t^{(i)}\}$ 可能在[状态空间](@entry_id:177074)中散布得很好，但它们所代表的整个历史轨迹 $\{x_{0:t}^{(i)}\}_{i=1}^N$ 的多样性已经丧失。这对于需要估计整个状态轨迹的平滑 (smoothing) 问题是致命的。谱系合并的速度与粒子数 $N$ 相关，回溯 $s$ 步后不同祖先数量的减少发生在一个与 $N$ 成正比的时间尺度上 [@problem_id:2890415]。

#### 维度灾难
[粒子滤波](@entry_id:140084)最根本的局限性之一是**[维度灾难](@entry_id:143920) (Curse of Dimensionality)** [@problem_id:2890433]。随着[状态向量](@entry_id:154607) $x_t$ 的维度 $d$ 增加，算法的性能会急剧下降。其根本原因在于，高维空间的大部分体积都集中在“角落”里，而典型区域（如[后验分布](@entry_id:145605)的峰值所在）的体积占比极小。

对于像自助[粒子滤波](@entry_id:140084)这样采用“盲目”提议分布（即不依赖于观测 $y_t$ 的转移先验）的算法，在高维空间中，从先验[随机采样](@entry_id:175193)的粒子，恰好落在由观测所确定的高[似然](@entry_id:167119)区域的概率会随着维度 $d$ 的增加而指数级下降。这导致重要性权重的[方差](@entry_id:200758)随维度 $d$ [线性增长](@entry_id:157553)。更具体地说，可以证明在某些典型模型中，$\text{Var}[\log(W_t)]$ 正比于 $d$。

权重的巨大[方差](@entry_id:200758)直接导致[有效样本量](@entry_id:271661) ESS 的指数级衰减，其形式近似为 $\text{ESS} \propto N \exp(-c \cdot d)$，其中 $c$ 是一个与模型相关的正常数 [@problem_id:2890433]。这意味着，为了在更高维度的空间中维持相同的估计精度，所需的粒子数 $N$ 必须随维度 $d$ 呈指数增长。这使得基本的[粒子滤波算法](@entry_id:202446)在处理高维问题时（通常 $d$ 大于10就被认为是高维）变得不切实际。克服[维度灾难](@entry_id:143920)是[粒子滤波](@entry_id:140084)研究领域一个持续活跃的前沿方向，催生了诸如辅助[粒子滤波](@entry_id:140084)、块状采样和基于梯度的提议分布等更先进的技术。