{"hands_on_practices": [{"introduction": "原型滤波器的设计是滤波器组理论的核心。本练习从最基本的频率采样法入手，要求你推导出一个有限冲激响应（FIR）原型滤波器的连续频率响应，并量化其性能。通过这个过程，你将深入理解滤波器长度 $M$ 与滤波器最重要的性能指标之一——过渡带宽度之间的基本权衡关系 [@problem_id:2881785]。", "problem": "考虑一个临界抽取的 $M$ 通道均匀离散傅里叶变换 (DFT) 分析滤波器组，其中每个分析通道 $k \\in \\{0,1,\\dots,M-1\\}$ 是通过对单个低通原型进行复调制得到的，即 $H_k(e^{j\\omega}) \\triangleq H\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right)$。目标是近似宽度约为 $2\\pi/M$ 的理想砖墙带通通道响应，每个响应的中心位于 $2\\pi k/M$。\n\n仅使用有限冲激响应 (FIR) 设计中的频率采样法的基本原理以及离散时间傅里叶变换 (DTFT) 的调制特性，完成以下任务：\n\n1) 从频率采样设计的定义出发，该定义在 $\\omega_r \\triangleq 2\\pi r/M$（其中 $r \\in \\{0,1,\\dots,M-1\\}$）处指定了 $M$ 个等间隔的期望采样点 $H_{d}[r] \\triangleq H\\!\\left(e^{j\\omega_r}\\right)$。当时域原型 $h[n]$ 被选为 $\\{H_{d}[r]\\}_{r=0}^{M-1}$ 的逆 DFT 时，推导所得到的连续频率原型响应 $H(e^{j\\omega})$。您得出的 $H(e^{j\\omega})$ 表达式必须是闭式形式，并且必须明确展示出对有限几何级数求和所产生的插值核。\n\n2) 解释您在第 (1) 部分中推导出的插值核，并假设一个标准的 $H_{d}[r]$ 选择，即在对应于 $\\omega=0$ 附近低通频带的一组连续 DFT 索引上其值为 1，而在其他地方为 0（这样 $H_k(e^{j\\omega})$ 就近似一个以 $2\\pi k/M$ 为中心的砖墙频带），确定将标称平坦的通带区域（接近于 1）与阻带的第一个零点分开的最小可实现过渡带宽 $\\Delta\\omega_{\\min}$，将其表示为 $M$ 的函数。此处，将过渡带宽定义为通带波瓣峰值与该波瓣一侧的第一个过零点之间的频率间隔。您的答案必须是仅用 $M$ 表示的单一闭式解析表达式。\n\n无需进行数值代入。最终答案必须仅为 $\\Delta\\omega_{\\min}$ 的解析表达式，不带单位。", "solution": "所述问题具有科学依据、提法恰当、客观，并包含足够的信息以得出唯一解。这是数字信号处理中一个关于使用频率采样法设计 FIR 滤波器的标准问题。我将开始推导。\n\n问题分为两部分。首先，我们必须推导通过频率采样法设计的原型滤波器的连续频率响应 $H(e^{j\\omega})$。其次，我们必须确定此原型的最小可实现过渡带宽。\n\n第 1 部分：原型滤波器频率响应的推导\n\n问题指出，原型滤波器的冲激响应 $h[n]$ 长度有限，是通过对一组 $M$ 个期望频率采样点 $\\{H_d[r]\\}_{r=0}^{M-1}$ 进行离散傅里叶逆变换 (IDFT) 得到的。因此，FIR 滤波器的长度隐含为 $M$。根据 $M$ 点 IDFT 的定义，$h[n]$ 对于 $n \\in \\{0, 1, \\dots, M-1\\}$ 可表示为：\n$$\nh[n] = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] e^{j \\frac{2\\pi r n}{M}}\n$$\n在此区间之外，$h[n]$ 为零。连续频率响应 $H(e^{j\\omega})$ 是这个有限长度序列 $h[n]$ 的离散时间傅里叶变换 (DTFT)。DTFT 的定义为：\n$$\nH(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n] e^{-j\\omega n}\n$$\n代入 $h[n]$ 的表达式，并注意到其支撑域为从 $n=0$ 到 $n=M-1$：\n$$\nH(e^{j\\omega}) = \\sum_{n=0}^{M-1} \\left( \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] e^{j \\frac{2\\pi r n}{M}} \\right) e^{-j\\omega n}\n$$\n我们可以交换有限求和的顺序：\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\left( \\sum_{n=0}^{M-1} e^{j \\frac{2\\pi r n}{M}} e^{-j\\omega n} \\right)\n$$\n让我们合并第二个求和内的指数项：\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\left( \\sum_{n=0}^{M-1} \\left( e^{j(\\frac{2\\pi r}{M} - \\omega)} \\right)^n \\right)\n$$\n内部求和是一个形式为 $\\sum_{n=0}^{N-1} a^n$ 的有限几何级数，其中 $N=M$ 且 $a = e^{j(\\frac{2\\pi r}{M} - \\omega)}$。当 $a \\neq 1$ 时，该级数的和有闭式表达式 $\\frac{1-a^N}{1-a}$。\n问题陈述中要求的插值核正是这个和，我们将其记为 $K_r(\\omega)$：\n$$\nK_r(\\omega) \\triangleq \\sum_{n=0}^{M-1} \\left( e^{j(\\frac{2\\pi r}{M} - \\omega)} \\right)^n = \\frac{1 - \\left(e^{j(\\frac{2\\pi r}{M} - \\omega)}\\right)^M}{1 - e^{j(\\frac{2\\pi r}{M} - \\omega)}}\n$$\n化简分子中的项：\n$$\n\\left(e^{j(\\frac{2\\pi r}{M} - \\omega)}\\right)^M = e^{j(2\\pi r - M\\omega)} = e^{j2\\pi r} e^{-jM\\omega}\n$$\n由于 $r$ 是整数，$e^{j2\\pi r} = 1$。分子变为 $1 - e^{-jM\\omega}$。因此，核函数为：\n$$\nK_r(\\omega) = \\frac{1 - e^{-jM\\omega}}{1 - e^{j(\\frac{2\\pi r}{M} - \\omega)}} = \\frac{1 - e^{-jM\\omega}}{1 - e^{-j(\\omega - \\frac{2\\pi r}{M})}}\n$$\n将此核函数代回 $H(e^{j\\omega})$ 的表达式，我们便得到了连续频率原型响应的闭式表达式。此表达式明确地显示了频率采样点 $H_d[r]$ 是如何通过核函数 $K_r(\\omega)$ 进行插值的。\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\sum_{r=0}^{M-1} H_d[r] \\frac{1 - e^{-jM\\omega}}{1 - e^{-j(\\omega - \\frac{2\\pi r}{M})}}\n$$\n这就完成了问题的第一部分。该表达式表明，最终的频率响应是多个插值函数的叠加，每个插值函数都以一个频率采样点 $\\omega_r = 2\\pi r / M$ 为中心，并由该点处的期望响应 $H_d[r]$ 加权。\n\n第 2 部分：最小可实现过渡带宽\n\n第二部分要求我们找到最小可实现过渡带宽 $\\Delta\\omega_{\\min}$。过渡带宽定义为通带波瓣的峰值与阻带的第一个零点之间的频率间隔。这个最小值需要通过考虑“一个标准的 $H_d[r]$ 选择，即在对应于 $\\omega=0$ 附近低通频带的一组连续 DFT 索引上其值为 1，而在其他地方为 0”来找到。\n\n频率响应 $H(e^{j\\omega})$ 的结构是一个基本插值函数的多个频移版本的线性组合。为了实现最窄的特征，特别是最窄的过渡带宽，必须为 $H_d[r]$ 选择最集中的可能设定。扩大 $H_d[r]$ 的支撑域（即使用一个更大的“连续的 1 的集合”）对应于对多个移位的插值核求和。这个操作会“填补”单个核函数的零点，从而展宽整体通带，并将第一个阻带零点推向更高的频率。这会增加过渡带宽。\n\n因此，对于 $H_d[r]$ 的最窄可能的非平凡通带设定，可以实现最小过渡带宽。对于一个以 $\\omega=0$ 为中心的低通滤波器，最集中的（或最小的）非零采样点的“连续集合”是在 $r=0$ 处的单个采样点。这个选择对应于：\n$$\nH_d[r] = \\delta[r] = \\begin{cases} 1  r=0 \\\\ 0  r \\in \\{1, 2, \\dots, M-1\\} \\end{cases}\n$$\n在此选择下，$H(e^{j\\omega})$ 的求和简化为 $r=0$ 的单个项：\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\cdot (1) \\cdot \\frac{1 - e^{-jM\\omega}}{1 - e^{-j\\omega}}\n$$\n这是长度为 $M$、幅度为 $1/M$ 的矩形窗的 DTFT。为了分析其特性，我们用三角函数来表示它。\n$$\nH(e^{j\\omega}) = \\frac{1}{M} \\frac{e^{-j\\frac{M\\omega}{2}}(e^{j\\frac{M\\omega}{2}} - e^{-j\\frac{M\\omega}{2}})}{e^{-j\\frac{\\omega}{2}}(e^{j\\frac{\\omega}{2}} - e^{-j\\frac{\\omega}{2}})} = \\frac{1}{M} e^{-j(M-1)\\frac{\\omega}{2}} \\frac{\\sin(M\\omega/2)}{\\sin(\\omega/2)}\n$$\n此响应的幅度为：\n$$\n|H(e^{j\\omega})| = \\frac{1}{M} \\left| \\frac{\\sin(M\\omega/2)}{\\sin(\\omega/2)} \\right|\n$$\n这个函数是缩放的周期性 sinc 函数，也称为狄利克雷核。\n通带波瓣的峰值出现在 $\\omega = 0$ 处。使用洛必达法则或小角度近似，峰值为：\n$$\n\\lim_{\\omega \\to 0} |H(e^{j\\omega})| = \\frac{1}{M} \\left| \\frac{M/2}{1/2} \\right| = 1\n$$\n所以，峰值位于 $\\omega_p = 0$。\n\n阻带的第一个零点出现在最小的非零频率 $\\omega_z$ 处，在该频率处分子 $\\sin(M\\omega/2)$ 为零，而分母 $\\sin(\\omega/2)$ 不为零。分子在以下情况为零：\n$$\n\\frac{M\\omega}{2} = k\\pi \\quad \\text{for any non-zero integer } k\n$$\n$$\n\\omega = \\frac{2\\pi k}{M}\n$$\n在 $\\omega=0$ 处主瓣一侧的第一个零点对应于 $k=1$。在此频率下，分母为 $\\sin(\\pi/M)$，对于 $M > 1$ 其值非零。因此，第一个过零点位于：\n$$\n\\omega_z = \\frac{2\\pi}{M}\n$$\n过渡带宽 $\\Delta\\omega_{\\min}$ 是峰值与这第一个零点之间的间隔：\n$$\n\\Delta\\omega_{\\min} = |\\omega_z - \\omega_p| = \\left|\\frac{2\\pi}{M} - 0\\right| = \\frac{2\\pi}{M}\n$$\n对于 $H_d[r]$ 的任何其他标准选择都将涉及更宽的通带设定（更多的非零采样点），这将导致更大的过渡带宽。因此，这是在给定设计约束下的最小可实现值。", "answer": "$$\\boxed{\\frac{2\\pi}{M}}$$", "id": "2881785"}, {"introduction": "理想的“砖墙”滤波器在现实中无法实现，实际的滤波器总存在带外衰减不完全的问题。本练习通过一个简化的分段常数响应模型，让你能够定量分析这种不完美性所带来的后果。你将推导在临界采样系统中，有限的阻带衰减（用 $\\alpha$ 表示）如何导致信道间泄漏，并最终产生重建信号中的混叠失真 [@problem_id:2881813]。", "problem": "考虑一个临界采样的均匀离散傅里叶变换（DFT）$M$通道分析-综合滤波器组，该滤波器组由一个单一的实数、线性相位原型分析低通滤波器通过复调制构建，其离散时间频率响应为 $H_{0}(\\exp(j\\omega))$。第 $k$ 个分析滤波器为 $H_{k}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - 2\\pi k/M)))$，相应的综合滤波器取为 $G_{k}(\\exp(j\\omega)) = H_{k}^{\\ast}(\\exp(j\\omega))$，之后对综合求和结果应用一个全局实数标量增益 $\\beta$。每个分析支路的输出被 $M$ 倍下采样，每个综合支路的输入被 $M$ 倍上采样。所有角频率的单位都是弧度/样本。\n\n假设原型滤波器的幅度响应是分段常数且严格以 $2\\pi$ 为周期的：\n- $|H_{0}(\\exp(j\\omega))| = 1$ 对于 $|\\omega| \\le \\pi/M$，\n- $|H_{0}(\\exp(j\\omega))| = \\alpha$ 对于 $\\pi/M  |\\omega| \\le \\pi$，\n其中 $0  \\alpha \\ll 1$。因此，每个调制后的分析滤波器 $H_{k}(\\exp(j\\omega))$ 的通带宽度为 $2\\pi/M$，中心频率在 $\\omega = 2\\pi k/M$，其自身通带内的幅度为单位1，其他地方的幅度为 $\\alpha$。\n\n设输入信号 $x[n]$ 为零均值、宽平稳、白噪声，其双边功率谱密度为 $S_{x}(\\omega) = \\sigma_{x}^{2}$，适用于所有 $\\omega \\in [-\\pi, \\pi)$。\n\n您将分析由于有限阻带引起的相邻通道之间的泄漏，并预测重建输出中存在的净混叠污染。\n\n任务：\n1) 仅使用上述定义以及以下事实：线性时不变滤波器从白噪声输入中通过某一频率区域的功率，等于该区域上幅度平方响应的积分乘以 $\\sigma_{x}^{2}$。计算从第 $(k+1)$ 通道的通带泄漏到第 $k$ 分析支路的泄漏功率。将此泄漏表示为相邻幅度响应重叠区域上的积分，并以闭合形式计算其值。\n\n2) 从多速率信号处理的第一性原理出发，即下采样和上采样的精确离散时间傅里叶变换关系：\n- 如果 $v[n] \\xrightarrow{\\mathcal{F}} V(\\omega)$ 且 $d[n] = v[nM]$，则 $D(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V\\!\\left(\\frac{\\omega - 2\\pi r}{M}\\right)$，\n- 如果 $u[n]$ 是由 $d[n]$ 经 $M$ 倍上采样得到，则 $U(\\omega) = D(M\\omega)$，\n推导重建输出频谱 $Y(\\omega)$，其形式为\n$$\nY(\\omega) = \\sum_{r=0}^{M-1} T_{r}(\\omega)\\, X\\!\\left(\\omega - \\frac{2\\pi r}{M}\\right),\n$$\n并明确地用 $\\{H_{k}(\\exp(j\\omega))\\}$ 和 $\\{G_{k}(\\exp(j\\omega))\\}$ 表示混叠传递函数 $T_{r}(\\omega)$。\n\n3) 在所述的幅度模型下，对于位于任何分析通带内的 $\\omega$，将 $T_{0}(\\omega)$ 和 $T_{r}(\\omega)$ (对于 $r \\neq 0$) 近似为常数（在通带内与 $\\omega$ 无关），并用 $M$ 和 $\\alpha$ 以闭合形式表示它们。然后选择综合标量增益 $\\beta$，使得期望的（非混叠）项等于1，即在通带内 $\\beta\\, T_{0}(\\omega) = 1$。\n\n4) 将重建输出端的总混叠信号功率比定义为\n$$\n\\mathrm{ASR} \\triangleq \\frac{\\sum_{r=1}^{M-1} \\left|\\beta\\, T_{r}\\right|^{2}\\, \\sigma_{x}^{2}}{\\left|\\beta\\, T_{0}\\right|^{2}\\, \\sigma_{x}^{2}},\n$$\n在所采用的近似下，该比值与 $\\omega$ 和 $\\sigma_{x}^{2}$ 无关。推导出 $\\mathrm{ASR}$ 仅作为 $M$ 和 $\\alpha$ 函数的单一闭合形式解析表达式。提供你的最终结果为这个单一的解析表达式。不需要数值代入，$\\mathrm{ASR}$ 也没有单位。", "solution": "所述问题具有科学依据、提法明确、客观，并包含足够的信息以获得唯一解。这是多速率滤波器组分析中的一个标准练习。我将开始进行解答。\n\n问题分为四个连续的任务。我将依次解决每个任务，并基于前面任务的结果。每个数学符号、变量、函数和数字都将按要求使用 LaTeX 格式。\n\n首先，我们计算泄漏功率。分析滤波器由原型低通滤波器 $H_{0}(\\exp(j\\omega))$ 通过复调制定义为 $H_{k}(\\exp(j\\omega)) = H_{0}(\\exp(j(\\omega - 2\\pi k/M)))$。原型滤波器 $H_{0}(\\exp(j\\omega))$ 的通带被给定为频率范围 $|\\omega| \\le \\pi/M$。因此，第 $(k+1)$ 个分析滤波器 $H_{k+1}(\\exp(j\\omega))$ 的通带是满足 $|\\omega - 2\\pi(k+1)/M| \\le \\pi/M$ 的频率 $\\omega$ 的集合。这定义了区间 $\\omega \\in [\\frac{2\\pi(k+1)}{M} - \\frac{\\pi}{M}, \\frac{2\\pi(k+1)}{M} + \\frac{\\pi}{M}]$，简化后为 $[\\frac{\\pi(2k+1)}{M}, \\frac{\\pi(2k+3)}{M}]$。\n\n问题定义了滤波器在某一频率区域内从白噪声输入通过的功率为该区域上幅度平方响应的积分，再乘以输入功率谱密度 $\\sigma_{x}^{2}$。我们需要计算从第 $k+1$ 通道的通带中，通过第 $k$ 通道滤波器的功率。这个泄漏功率，记为 $P_{\\text{leak}}$，因此由以下积分给出：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\int_{\\frac{\\pi(2k+1)}{M}}^{\\frac{\\pi(2k+3)}{M}} \\left|H_{k}(\\exp(j\\omega))\\right|^{2} d\\omega\n$$\n为了计算这个积分，我们必须确定被积函数 $|H_{k}(\\exp(j\\omega))|^2$ 在积分区间上的值。我们代入 $H_{k}(\\exp(j\\omega))$ 的定义：\n$$\n|H_{k}(\\exp(j\\omega))|^2 = |H_{0}(\\exp(j(\\omega - 2\\pi k/M)))|^2\n$$\n我们进行变量替换，令 $\\omega' = \\omega - 2\\pi k/M$。当 $\\omega$ 遍历积分区间 $[\\frac{\\pi(2k+1)}{M}, \\frac{\\pi(2k+3)}{M}]$ 时，新变量 $\\omega'$ 遍历区间 $[\\frac{\\pi}{M}, \\frac{3\\pi}{M}]$。原型幅度响应被给定为 $|H_{0}(\\exp(j\\omega'))| = \\alpha$，适用于 $\\pi/M  |\\omega'| \\le \\pi$。对于任何合理的通道数，例如 $M \\ge 3$，区间 $[\\pi/M, 3\\pi/M]$ 是 $|\\omega'| \\le \\pi$ 区域的子集。因此，对于该区间内的任何 $\\omega'$，都有 $|H_{0}(\\exp(j\\omega'))| = \\alpha$。因此，被积函数在整个积分域上是常数，即 $|H_{k}(\\exp(j\\omega))|^2 = \\alpha^2$。\n\n积分变得很简单：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\int_{\\frac{\\pi(2k+1)}{M}}^{\\frac{\\pi(2k+3)}{M}} \\alpha^2 d\\omega = \\sigma_{x}^{2} \\alpha^2 \\left( \\frac{\\pi(2k+3)}{M} - \\frac{\\pi(2k+1)}{M} \\right)\n$$\n计算积分限可得区间宽度为 $2\\pi/M$。因此，泄漏功率为：\n$$\nP_{\\text{leak}} = \\sigma_{x}^{2} \\alpha^2 \\frac{2\\pi}{M}\n$$\n\n第二，我们推导重建输出频谱 $Y(\\omega)$ 的表达式。过程如下：\n1. 输入信号 $x[n]$（频谱为 $X(\\omega)$）被 $M$ 个分析滤波器中的每一个进行滤波。第 $k$ 个滤波器的输出是 $v_k[n]$，其频谱为 $V_k(\\omega) = X(\\omega)H_k(\\exp(j\\omega))$。\n2. 每个 $v_k[n]$ 被 $M$ 倍下采样以产生 $d_k[n] = v_k[nM]$。使用所提供的恒等式，其频谱为 $D_k(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V_k\\left(\\frac{\\omega - 2\\pi r}{M}\\right)$。\n3. 每个 $d_k[n]$ 被 $M$ 倍上采样以产生 $u_k[n]$。其频谱为 $U_k(\\omega) = D_k(M\\omega)$。代入前面步骤的表达式：\n$$\nU_k(\\omega) = \\frac{1}{M} \\sum_{r=0}^{M-1} V_k\\left(\\frac{M\\omega - 2\\pi r}{M}\\right) = \\frac{1}{M} \\sum_{r=0}^{M-1} X\\left(\\omega - \\frac{2\\pi r}{M}\\right) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right)\n$$\n4. 每个 $u_k[n]$ 被一个综合滤波器 $G_k(\\exp(j\\omega))$ 滤波。得到的频谱是 $Y_k(\\omega) = U_k(\\omega)G_k(\\exp(j\\omega))$。\n5. 最终输出 $y[n]$ 是所有综合滤波器输出的总和，并乘以一个增益 $\\beta$：$Y(\\omega) = \\beta \\sum_{k=0}^{M-1} Y_k(\\omega)$。\n合并这些步骤可得：\n$$\nY(\\omega) = \\beta \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) \\left[ \\frac{1}{M} \\sum_{r=0}^{M-1} X\\left(\\omega - \\frac{2\\pi r}{M}\\right) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right) \\right]\n$$\n为了匹配所需的形式，我们交换求和顺序：\n$$\nY(\\omega) = \\sum_{r=0}^{M-1} \\left[ \\frac{\\beta}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right) \\right] X\\left(\\omega - \\frac{2\\pi r}{M}\\right)\n$$\n由此，我们确定总传递函数 $T_r(\\omega)$（根据结构，它包含了 $\\beta$，尽管第3部分的问题对此稍有重新定义）。为了与第3部分的措辞保持一致，我们定义不含 $\\beta$ 的 $T_r(\\omega)$：\n$$\nT_r(\\omega) = \\frac{1}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k\\left(\\exp\\left(j\\left(\\omega - \\frac{2\\pi r}{M}\\right)\\right)\\right)\n$$\n这样就有 $Y(\\omega) = \\beta \\sum_{r=0}^{M-1} T_r(\\omega) X(\\omega - 2\\pi r/M)$。\n\n第三，我们将 $T_r(\\omega)$ 在通带内（具体为 $|\\omega| \\le \\pi/M$）近似为常数。综合滤波器为 $G_k(\\exp(j\\omega)) = H_k^*(\\exp(j\\omega))$。\n对于 $r=0$，函数 $T_0(\\omega)$ 是失真传递函数：\n$$\nT_0(\\omega) = \\frac{1}{M} \\sum_{k=0}^{M-1} G_k(\\exp(j\\omega)) H_k(\\exp(j\\omega)) = \\frac{1}{M} \\sum_{k=0}^{M-1} |H_k(\\exp(j\\omega))|^2\n$$\n对于 $|\\omega| \\le \\pi/M$：\n- $k=0$ 项为 $|H_0(\\exp(j\\omega))|^2 = 1^2 = 1$。\n- 对于 $k \\in \\{1, \\dots, M-1\\}$，原型滤波器的参数为 $\\omega - 2\\pi k/M$。其大小位于 $[\\frac{(2k-1)\\pi}{M}, \\frac{(2k+1)\\pi}{M}]$ 内，该区域在阻带中。因此， $|H_k(\\exp(j\\omega))|^2 = \\alpha^2$。\n因此，在这个频带内，和为常数：\n$$\nT_0 = \\frac{1}{M} (1 + (M-1)\\alpha^2)\n$$\n对于 $r \\neq 0$，$T_r(\\omega)$ 是混叠传递函数。利用 $h_0[n]$ 的线性相位特性，$H_0(\\exp(j\\theta)) = |H_0(\\exp(j\\theta))|\\exp(-j\\theta t_g)$， $T_r(\\omega)$ 求和内的乘积包含一个相位项，可简化为 $\\exp(j \\frac{2\\pi r t_g}{M})$。\n$$\nT_r(\\omega) = \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) \\sum_{k=0}^{M-1} |H_0(\\exp(j(\\omega-\\frac{2\\pi k}{M})))| |H_0(\\exp(j(\\omega-\\frac{2\\pi(k+r)}{M})))|\n$$\n对于 $|\\omega| \\le \\pi/M$，我们分析每个 $k$ 的幅度乘积：\n- 当 $k=0$ 时，乘积为 $|H_0(\\exp(j\\omega))| \\cdot |H_0(\\exp(j(\\omega-\\frac{2\\pi r}{M})))| = 1 \\cdot \\alpha = \\alpha$。\n- 第二项 $|H_0(\\exp(j(\\omega-\\frac{2\\pi(k+r)}{M})))|$ 的通带贡献发生在 $k+r$ 是 $M$ 的倍数时。给定 $k \\in \\{0, \\dots, M-1\\}$ 和 $r \\in \\{1, \\dots, M-1\\}$，这仅在 $k = M-r$ 时发生。对于这个 $k$ 值，乘积为 $|H_0(\\exp(j(\\omega-\\frac{2\\pi(M-r)}{M})))| \\cdot |H_0(\\exp(j(\\omega-2\\pi)))| = \\alpha \\cdot 1 = \\alpha$。\n- 对于所有其他 $M-2$ 个 $k$ 值，两个参数都落在阻带内，所以乘积为 $\\alpha \\cdot \\alpha = \\alpha^2$。\n和为常数：$2\\alpha + (M-2)\\alpha^2$。\n$$\nT_r = \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) (2\\alpha + (M-2)\\alpha^2) \\quad \\text{对于 } r \\neq 0\n$$\n选择增益 $\\beta$ 使得总失真项为1：$\\beta T_0 = 1$。\n$$\n\\beta = \\frac{1}{T_0} = \\frac{M}{1 + (M-1)\\alpha^2}\n$$\n\n第四，我们推导混叠信号功率比（ASR）。其定义为：\n$$\n\\mathrm{ASR} \\triangleq \\frac{\\sum_{r=1}^{M-1} \\left|\\beta\\, T_{r}\\right|^{2}\\, \\sigma_{x}^{2}}{\\left|\\beta\\, T_{0}\\right|^{2}\\, \\sigma_{x}^{2}}\n$$\n根据我们对 $\\beta$ 的选择，分母为 $1^2 \\cdot \\sigma_x^2 = \\sigma_x^2$。$\\sigma_x^2$ 项相互抵消。\n$$\n\\mathrm{ASR} = \\frac{\\sum_{r=1}^{M-1} |\\beta T_r|^2}{|\\beta T_0|^2} = \\sum_{r=1}^{M-1} |\\beta T_r|^2\n$$\n我们计算 $r \\neq 0$ 时的 $|\\beta T_r|$：\n$$\n|\\beta T_r| = |\\beta| \\cdot |T_r| = \\frac{M}{1 + (M-1)\\alpha^2} \\cdot \\left| \\frac{1}{M} \\exp(j \\frac{2\\pi r t_g}{M}) (2\\alpha + (M-2)\\alpha^2) \\right|\n$$\n指数项的幅度为 $1$。由于 $\\alpha > 0$ 且 $M \\ge 2$，$(2\\alpha + (M-2)\\alpha^2)$ 是正数。\n$$\n|\\beta T_r| = \\frac{M}{1 + (M-1)\\alpha^2} \\cdot \\frac{1}{M} (2\\alpha + (M-2)\\alpha^2) = \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2}\n$$\n这个值与混叠指数 $r$ 无关。ASR 表达式中的求和包含 $M-1$ 个相同的项：\n$$\n\\mathrm{ASR} = \\sum_{r=1}^{M-1} \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2\n$$\n这给出了 ASR 的最终闭合形式表达式：\n$$\n\\mathrm{ASR} = (M-1) \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2\n$$\n此表达式仅依赖于通道数 $M$ 和阻带衰减因子 $\\alpha$，符合要求。", "answer": "$$\\boxed{(M-1) \\left( \\frac{2\\alpha + (M-2)\\alpha^2}{1 + (M-1)\\alpha^2} \\right)^2}$$", "id": "2881813"}, {"introduction": "理论分析之后，我们转向实际的工程设计。本练习是一个动手编程任务，指导你完成一个典型的高性能原型滤波器设计流程。你将使用Kaiser窗函数法来设计一个 $M=32$ 通道的滤波器组原型，目标是达到 $60$ dB 的鄰道洩漏抑制，并编写代码来验证不同滤波器长度下的性能指标 [@problem_id:2881712]。", "problem": "要求您使用一个调制低通原型滤波器，设计并验证一个具有 $M=32$ 个通道的均匀离散傅里叶变换 (DFT) 分析滤波器组。设计目标是实现约 $60$ 分贝 (dB) 的邻道泄漏，该泄漏通过一个根据分析滤波器计算的、明确定义的隔离度指标进行量化。您必须实现一个自包含的程序，该程序使用 Kaiser 窗加权的理想低通滤波器来设计原型，并为一组给定的原型滤波器长度测试集计算指定的通道隔离度指标。\n\n定义和基本原理：\n- 考虑一个均匀的 $M$ 通道 DFT 分析滤波器组，其分析滤波器 $\\{H_k(e^{j\\omega})\\}_{k=0}^{M-1}$ 是通过对一个实数低通原型 $H_0(e^{j\\omega})$ 进行复调制得到的：\n  $$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\n- 通道中心频率为 $\\omega_k = \\frac{2\\pi k}{M}$ (弧度)。\n- 原型滤波器 $h[n]$ 是一个长度为 $L=K M$ 的有限冲激响应 (FIR) 滤波器，其中 $K$ 是一个正整数。它被设计为一个经 Kaiser 窗加权的理想低通滤波器，其截止频率为\n  $$\\omega_c = \\frac{\\pi}{M},$$\n  其过渡带的设计意图由通带边缘 $\\omega_p = \\frac{3\\pi}{4M}$ 和阻带边缘 $\\omega_s = \\frac{5\\pi}{4M}$ (弧度) 指导，因此名义上的过渡带宽度为\n  $$\\Delta\\omega = \\omega_s - \\omega_p = \\frac{\\pi}{2M}.$$\n  对于期望的旁瓣衰减 $A$ (以 dB 为单位)，Kaiser 窗参数 $\\beta$ 满足以下广泛使用的经验关系式：\n  $$\\beta =\n  \\begin{cases}\n  0,  A \\le 21,\\\\\n  0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21),  21  A \\le 50,\\\\\n  0.1102\\,(A-8.7),  A > 50,\n  \\end{cases}$$\n  对于 $A=60$ dB，该式将得到一个固定的 $\\beta$ 值。\n- 长度为 $L$、截止频率为 $\\omega_c$ 的理想低通原型 (加窗前) 的离散时间冲激响应为：\n  $$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\n  其中 $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$，且 $\\mathrm{sinc}(0)=1$。加窗后的原型为 $h[n] = h_d[n]\\,w[n]$，其中 $w[n]$ 是长度为 $L$ 的 Kaiser 窗。对 $h[n]$ 进行归一化，使得\n  $$H_0(e^{j0}) = \\sum_{n=0}^{L-1} h[n] = 1,$$\n  以确保在每个调制后通道的通带中心处具有单位增益。\n\n需要计算的隔离度指标：\n- 将分析滤波器组的邻道泄漏 (ACL) 定义为所有通道中，在相邻通道中心处的幅度响应与通道内中心处的幅度响应之比的最大值：\n  $$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k\\in\\{0,\\dots,M-1\\}} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg).$$\n- 对于一个均匀调制的滤波器组，该指标可简化为基于原型滤波器的评估：\n  $$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right),$$\n  因为 $H_k(e^{j\\omega_{k\\pm1}})=H_0(e^{\\pm j\\frac{2\\pi}{M}})$ 且 $H_k(e^{j\\omega_k})=H_0(e^{j0})$。\n\n您的任务：\n1. 针对固定的 $M=32$，实现上述原型滤波器设计，使用的 Kaiser 窗参数由 $A=60$ dB 的目标衰减推导得出。\n2. 对于每个给定的 $K$ 值，构建长度为 $L=K\\,M$ 的 $h[n]$，将其在 $\\omega=0$ 处的增益归一化为 1，并使用上述基于原型滤波器的恒等式计算以 dB 为单位的邻道泄漏，所有角度计算均使用弧度制。\n3. 汇总指定测试集的结果，并以确切要求的格式打印出来。\n\n测试集：\n- 使用 $M=32$ 和以下三个 $K$ 值：\n  - $K=6$ (短原型；重要的边缘情况)，\n  - $K=10$ (中等长度；类边界情况)，\n  - $K=18$ (长原型；理想路径)。\n- 对于每个 $K$ 值，计算并返回以 dB 为单位的标量 $\\mathrm{ACL}$ 值，该值应为四舍五入到两位小数的浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试用例 $[K=6, K=10, K=18]$ 顺序排列的三个结果，格式为用方括号括起来的逗号分隔列表 (例如 `[a,b,c]`)。所有内部角度计算均使用弧度制，且不应包含任何额外文本。", "solution": "我们从均匀离散傅里叶变换 (DFT) 调制分析滤波器组的基本定义开始。设有 $M$ 个分析滤波器 $\\{H_k(e^{j\\omega})\\}$，它们由单个低通原型 $H_0(e^{j\\omega})$ 通过复调制生成：\n$$H_k(e^{j\\omega}) = H_0\\!\\left(e^{j(\\omega - 2\\pi k/M)}\\right),\\quad k=0,1,\\dots,M-1.$$\n通道中心频率为 $\\omega_k = \\frac{2\\pi k}{M}$，单位是弧度/采样点。根据设计，原型 $H_0(e^{j\\omega})$ 的能量集中在 $\\omega=0$ 附近，而调制操作将这个低通滤波器的中心移至每个 $\\omega_k$ 处。\n\n邻道泄漏量化了为通道 $k$ 设计的滤波器对相邻通道中心频率的抑制程度。仅考虑分析滤波器，一个自然的定义是：\n$$\\mathrm{ACL} = 20\\log_{10}\\Bigg(\\max_{k} \\frac{\\left|H_k\\!\\left(e^{j\\omega_{k\\pm 1}}\\right)\\right|}{\\left|H_k\\!\\left(e^{j\\omega_k}\\right)\\right|}\\Bigg),$$\n其中 $k\\pm 1$ 表示在频率圆上 $k$ 的任一直接相邻通道。使用调制恒等式，\n$$H_k(e^{j\\omega_{k}}) = H_0(e^{j0}),\\quad H_k(e^{j\\omega_{k\\pm 1}}) = H_0\\!\\left(e^{\\pm j\\frac{2\\pi}{M}}\\right).$$\n因此，对于均匀滤波器组，最差情况下的比率与 $k$ 无关，并简化为：\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\frac{\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|}{\\left|H_0\\!\\left(e^{j0}\\right)\\right|}\\right).$$\n因此，只需设计 $H_0$ 并评估上述比率即可。\n\n我们通过对理想的离散时间低通滤波器进行加窗来设计 $H_0$。设滤波器长度为 $L=K M$，其中整数 $K\\ge 1$。选择截止频率 $\\omega_c = \\frac{\\pi}{M}$ 以将理想通带置于通道带宽之内。为了容纳过渡带并减少在相邻中心频率 $\\omega=\\frac{2\\pi}{M}$ 处的泄漏，我们采用通带和阻带标记 $\\omega_p=\\frac{3\\pi}{4M}$ 和 $\\omega_s=\\frac{5\\pi}{4M}$，从而得到名义上的过渡带宽度 $\\Delta\\omega=\\frac{\\pi}{2M}$。虽然设置在 $\\omega_c = \\frac{\\pi}{M}$ 的理想低通滤波器具有砖墙式的过渡特性，但实际的有限长度加窗响应将呈现一个过渡带，其宽度和旁瓣由长度 $L$ 和所用的窗函数共同决定。\n\n长度为 $L$、截止频率为 $\\omega_c$ 的理想低通滤波器的冲激响应是：\n$$h_d[n] = \\frac{\\omega_c}{\\pi}\\,\\mathrm{sinc}\\!\\left(\\frac{\\omega_c}{\\pi}\\left(n - \\frac{L-1}{2}\\right)\\right),\\quad n=0,1,\\dots,L-1,$$\n其中 $\\mathrm{sinc}(x) = \\frac{\\sin(\\pi x)}{\\pi x}$ 且 $\\mathrm{sinc}(0)=1$。我们应用一个 Kaiser 窗 $w[n]$，它由零阶第一类修正贝塞尔函数 $I_0(\\cdot)$ 定义如下：\n$$w[n] = \\frac{I_0\\!\\left(\\beta\\,\\sqrt{1 - \\left(\\frac{2n}{L-1}-1\\right)^2}\\right)}{I_0(\\beta)},\\quad n=0,1,\\dots,L-1.$$\nKaiser 窗参数 $\\beta$ 根据期望的旁瓣衰减 $A$ (以分贝为单位)，通过经过充分检验的经验公式来选择：\n$$\\beta =\n\\begin{cases}\n0,  A \\le 21,\\\\\n0.5842\\,(A-21)^{0.4} + 0.07886\\,(A-21),  21  A \\le 50,\\\\\n0.1102\\,(A-8.7),  A > 50.\n\\end{cases}$$\n对于 $A=60$ dB，我们处于 $A>50$ 的情况，得到 $\\beta = 0.1102\\,(60-8.7)$，这在数值上设定了 $60$ dB Kaiser 设计典型的旁瓣衰减特性。\n\n于是加窗后的原型为\n$$h[n] = h_d[n]\\cdot w[n],$$\n我们对其进行归一化，使得\n$$\\sum_{n=0}^{L-1} h[n] = 1,$$\n这意味着 $H_0(e^{j0})=1$，从而在每个调制通道的中心处获得单位增益。这种归一化使得邻道泄漏的计算简化为：\n$$\\mathrm{ACL} = 20\\log_{10}\\left(\\left|H_0\\!\\left(e^{j\\frac{2\\pi}{M}}\\right)\\right|\\right).$$\n\n算法规划：\n1. 固定 $M=32$，目标衰减 $A=60$ dB，并相应地计算 $\\beta$。\n2. 对每个给定 $K$ 的测试用例，设置 $L=K M$ 并生成 $\\omega_c=\\frac{\\pi}{M}$ 的 $h_d[n]$。\n3. 乘以参数为 $\\beta$ 的 Kaiser 窗 $w[n]$；然后将 $h[n]$ 归一化至单位直流增益。\n4. 使用一个数值稳定的 FIR 滤波器频率响应计算程序，计算在 $\\omega=0$ 和 $\\omega=\\frac{2\\pi}{M}$ 处的离散时间频率响应采样值 $H_0(e^{j\\omega})$。\n5. 通过上述定义的对数比率评估以分贝为单位的 $\\mathrm{ACL}$。所有角度均使用弧度制。\n6. 对测试集中的所有 $K$ 值重复以上步骤，将每个结果四舍五入到两位小数，并以指定的格式在单行列表中打印。\n\n测试集原理说明：\n- $K=6$ 产生一个相对较短的原型 ($L=192$)，这对过渡带宽度构成了压力，通常会产生更高的泄漏 (边缘情况)。\n- $K=10$ 产生一个中等长度的原型 ($L=320$)，对于 $60$ dB 的目标，其性能通常接近边界 (类边界情况)。\n- $K=18$ 产生一个较长的原型 ($L=576$)，这应能提供更好的隔离度 (理想路径)。\n\n最终的程序遵循这些原则，使用均匀调制恒等式直接从第一性原理计算指标，并以单行列表的形式输出指定 $K$ 值对应的三个邻道泄漏值 (以 dB 为单位)。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import freqz\n\ndef kaiser_beta(A):\n    # Kaiser window beta from attenuation A (dB)\n    if A = 21:\n        return 0.0\n    elif A = 50:\n        return 0.5842 * (A - 21) ** 0.4 + 0.07886 * (A - 21)\n    else:\n        return 0.1102 * (A - 8.7)\n\ndef design_prototype_kaiser(M, K, A_dB=60.0):\n    \"\"\"\n    Design a low-pass prototype h[n] of length L=K*M using a Kaiser-windowed ideal low-pass\n    with cutoff wc = pi/M. Normalize to unit DC gain.\n    \"\"\"\n    L = K * M\n    wc = np.pi / M  # cutoff in radians/sample\n    n = np.arange(L, dtype=float)\n    m = n - (L - 1) / 2.0\n    # Ideal low-pass impulse response: hd[n] = (wc/pi) * sinc((wc/pi) * m)\n    # np.sinc(x) = sin(pi x)/(pi x)\n    hd = (wc / np.pi) * np.sinc((wc / np.pi) * m)\n    beta = kaiser_beta(A_dB)\n    w = np.kaiser(L, beta)\n    h = hd * w\n    # Normalize to unit DC gain\n    s = np.sum(h)\n    if s == 0.0:\n        # Avoid division by zero; fallback to tiny normalization to keep numerical stability\n        s = 1e-16\n    h /= s\n    return h\n\ndef adjacent_channel_leakage_dB(h, M):\n    \"\"\"\n    Compute ACL in dB: 20*log10(|H0(exp(j*2*pi/M))| / |H0(exp(j*0))|)\n    After normalization, H0(0) ~ 1, but we compute both for robustness.\n    \"\"\"\n    # Evaluate frequency response at omega=0 and omega=2*pi/M\n    omegas = np.array([0.0, 2.0 * np.pi / M], dtype=float)\n    w, H = freqz(h, worN=omegas)\n    H0 = H[0]\n    H_adj = H[1]\n    denom = np.abs(H0)\n    num = np.abs(H_adj)\n    # Guard against numerical zeros\n    eps = 1e-20\n    ratio = (num + eps) / (denom + eps)\n    acl_db = 20.0 * np.log10(ratio)\n    return float(acl_db)\n\ndef solve():\n    # Define the test cases from the problem statement: M=32, K in [6, 10, 18]\n    M = 32\n    test_cases = [6, 10, 18]  # K values\n\n    results = []\n    for K in test_cases:\n        h = design_prototype_kaiser(M=M, K=K, A_dB=60.0)\n        acl_db = adjacent_channel_leakage_dB(h, M)\n        # Round to two decimals for final reporting\n        results.append(f\"{acl_db:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2881712"}]}