{"hands_on_practices": [{"introduction": "在应用任何估计算法之前，我们必须首先确保我们的实验设计能够唯一地确定系统参数。本练习 [@problem_id:2878418] 将通过一个反例来探讨“持续激励”这一核心概念。你将看到，当输入信号过于简单（例如一个常数）时，会导致信息矩阵秩亏，从而无法唯一地辨识所有参数，这突显了实验设计与系统可辨识性之间的关键联系。", "problem": "考虑一个单输入单输出线性时不变系统，采用二阶有限脉冲响应结构进行辨识建模。测量方程为\n$$\ny(t) \\;=\\; b_{1}\\,u(t-1) \\;+\\; b_{2}\\,u(t-2) \\;+\\; v(t),\n$$\n其中 $u(t)$ 是一个确定性输入，$v(t)$ 是一个与所有过去输入不相关的零均值扰动，而 $\\theta \\triangleq \\begin{pmatrix} b_{1}  b_{2} \\end{pmatrix}^{\\top}$ 是待辨识的未知参数矢量。定义回归量\n$$\n\\varphi(t) \\;\\triangleq\\; \\begin{pmatrix} u(t-1)  u(t-2) \\end{pmatrix},\n$$\n使得 $y(t) = \\varphi(t)\\,\\theta + v(t)$。为避免 $v(t)$ 带来的内生性问题，使用工具变量法，其工具矢量为\n$$\nz(t) \\;\\triangleq\\; \\begin{pmatrix} u(t-2)  u(t-3) \\end{pmatrix},\n$$\n以及堆叠数据矩阵\n$$\n\\Phi \\;\\triangleq\\; \\begin{pmatrix} \\varphi(3)^{\\top} \\\\ \\varphi(4)^{\\top} \\\\ \\varphi(5)^{\\top} \\\\ \\varphi(6)^{\\top} \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 2}, \n\\qquad\nZ \\;\\triangleq\\; \\begin{pmatrix} z(3)^{\\top} \\\\ z(4)^{\\top} \\\\ z(5)^{\\top} \\\\ z(6)^{\\top} \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 2}.\n$$\n在实验条件 $u(t) \\equiv c$（对于所有整数 $t \\leq 6$）下，采集时间点 $t \\in \\{3,4,5,6\\}$ 的数据，其中 $c$ 是一个已知的非零常数 $c = 3$。工具变量法正规方程为\n$$\n\\big(Z^{\\top}\\Phi\\big)\\,\\theta \\;=\\; Z^{\\top} y,\n$$\n且 $\\theta$ 的可辨识性要求 $Z^{\\top}\\Phi$ 具有满列秩。\n\n仅从上述回归形式和工具变量构造出发，利用给定的激励，明确地构造出 $Z^{\\top}\\Phi$，确定其秩，并根据 $Z^{\\top}\\Phi$ 的零空间来刻画本次实验中不可辨识的参数组合集合。然后，按照以下约定报告一个定量识别不可辨识方向的单一矢量：提供张成 $\\operatorname{Null}(Z^{\\top}\\Phi)$ 的、第一个分量为正的、唯一的单位范数矢量 $v \\in \\mathbb{R}^{2}$。\n\n你的最终答案必须是写成单个 $1 \\times 2$ 矩阵的行矢量 $v^{\\top}$。不需要四舍五入，也不涉及单位。", "solution": "所述问题是有效的。它在科学上是合理的、适定的和客观的，呈现了系统辨识中的一个标准场景。所有必要的信息都已提供，任务是在一个特定的实验条件下对参数可辨识性进行具体分析。\n\n目标是刻画参数矢量 $\\theta = \\begin{pmatrix} b_{1}  b_{2} \\end{pmatrix}^{\\top}$ 的不可辨识方向。在工具变量估计的背景下，可辨识性要求矩阵 $Z^{\\top}\\Phi$ 是满列秩的。如果不满足这个条件，该矩阵就是秩亏的，其零空间 $\\operatorname{Null}(Z^{\\top}\\Phi)$ 定义了实验无法检测到的参数变化子空间。该零空间中的任何矢量都代表一种参数组合，这种组合不会导致观测到的工具变量正规方程发生变化。任务是找到这个零空间的一个特定基矢量。\n\n首先，我们必须根据给定的输入信号构造数据矩阵 $\\Phi$ 和 $Z$。问题指明，在所有相关时间点 $t \\leq 6$，$u(t)$ 是一个常数，$u(t) = c = 3$。\n\n回归量矢量为 $\\varphi(t) = \\begin{pmatrix} u(t-1)  u(t-2) \\end{pmatrix}$。给定常数输入，对于数据矩阵中使用的任何 $t$，我们有 $\\varphi(t) = \\begin{pmatrix} 3  3 \\end{pmatrix}$。堆叠回归量矩阵 $\\Phi$ 定义在 $t \\in \\{3,4,5,6\\}$ 上：\n$$\n\\Phi = \\begin{pmatrix} \\varphi(3)^{\\top} \\\\ \\varphi(4)^{\\top} \\\\ \\varphi(5)^{\\top} \\\\ \\varphi(6)^{\\top} \\end{pmatrix} = \\begin{pmatrix} u(2)  u(1) \\\\ u(3)  u(2) \\\\ u(4)  u(3) \\\\ u(5)  u(4) \\end{pmatrix} = \\begin{pmatrix} 3  3 \\\\ 3  3 \\\\ 3  3 \\\\ 3  3 \\end{pmatrix}.\n$$\n\n工具变量矢量为 $z(t) = \\begin{pmatrix} u(t-2)  u(t-3) \\end{pmatrix}$。类似地，对于常数输入，我们对任何 $t$ 都有 $z(t) = \\begin{pmatrix} 3  3 \\end{pmatrix}$。堆叠工具矩阵 $Z$ 为：\n$$\nZ = \\begin{pmatrix} z(3)^{\\top} \\\\ z(4)^{\\top} \\\\ z(5)^{\\top} \\\\ z(6)^{\\top} \\end{pmatrix} = \\begin{pmatrix} u(1)  u(0) \\\\ u(2)  u(1) \\\\ u(3)  u(2) \\\\ u(4)  u(3) \\end{pmatrix} = \\begin{pmatrix} 3  3 \\\\ 3  3 \\\\ 3  3 \\\\ 3  3 \\end{pmatrix}.\n$$\n\n接下来，我们计算矩阵乘积 $Z^{\\top}\\Phi$。$Z$ 的转置是：\n$$\nZ^{\\top} = \\begin{pmatrix} 3  3  3  3 \\\\ 3  3  3  3 \\end{pmatrix}.\n$$\n那么乘积是：\n$$\nZ^{\\top}\\Phi = \\begin{pmatrix} 3  3  3  3 \\\\ 3  3  3  3 \\end{pmatrix} \\begin{pmatrix} 3  3 \\\\ 3  3 \\\\ 3  3 \\\\ 3  3 \\end{pmatrix}.\n$$\n执行矩阵乘法：位置 $(1,1)$ 的元素是 $(3)(3)+(3)(3)+(3)(3)+(3)(3) = 4 \\times 9 = 36$。由于矩阵的结构，所得乘积的所有元素都相同。\n$$\nZ^{\\top}\\Phi = \\begin{pmatrix} 36  36 \\\\ 36  36 \\end{pmatrix}.\n$$\n\n现在我们确定这个矩阵的秩。一个 $2 \\times 2$ 矩阵当其秩为 $2$ 时具有满列秩。$Z^{\\top}\\Phi$ 的秩可以通过观察其列是线性相关的来确定；具体来说，第二列与第一列相同。其行列式为 $\\det(Z^{\\top}\\Phi) = (36)(36) - (36)(36) = 0$。由于该矩阵非零且奇异，其秩为 $1$。这不是满列秩，这证实了参数矢量 $\\theta$ 在此实验设置下是不可辨识的。\n\n不可辨识的方向由 $Z^{\\top}\\Phi$ 的零空间给出。我们寻找一个矢量 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 使得 $(Z^{\\top}\\Phi)v=0$。\n$$\n\\begin{pmatrix} 36  36 \\\\ 36  36 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这个矩阵方程可以简化为单个线性方程 $36v_1 + 36v_2 = 0$，即 $v_1 + v_2 = 0$，或 $v_1 = -v_2$。因此，零空间中的任何矢量都具有形式 $\\begin{pmatrix} -v_2 \\\\ v_2 \\end{pmatrix} = v_2 \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$，其中 $v_2$ 是某个标量。该零空间是 $\\mathbb{R}^2$ 的一个一维子空间，由矢量 $\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ 张成。\n\n问题要求一个特定的矢量：张成该零空间的、第一个分量为正的、唯一的单位范数矢量 $v$。我们当前的张成矢量 $\\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$ 的第一个分量为负。为了获得一个第一个分量为正的张成矢量，我们可以乘以任何负标量。乘以 $-1$ 得到矢量 $w = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n最后，我们将 $w$ 归一化以获得单位范数。其范数为 $\\|w\\| = \\sqrt{1^2 + (-1)^2} = \\sqrt{2}$。所要求的单位范数矢量 $v$ 是：\n$$\nv = \\frac{w}{\\|w\\|} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\end{pmatrix}.\n$$\n将分母有理化得到：\n$$\nv = \\begin{pmatrix} \\frac{\\sqrt{2}}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\end{pmatrix}.\n$$\n这个矢量满足所有条件：它张成 $\\operatorname{Null}(Z^{\\top}\\Phi)$，其第一个分量为正，且具有单位范数。问题要求的是行矢量 $v^{\\top}$。\n$$\nv^{\\top} = \\begin{pmatrix} \\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2} \\end{pmatrix}.\n$$\n这个矢量定量地识别了参数空间 $\\{b_1, b_2\\}$ 中的不可辨识方向。参数矢量 $\\theta$ 沿此方向的任何变化都是无法检测的。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2}  -\\frac{\\sqrt{2}}{2} \\end{pmatrix}}\n$$", "id": "2878418"}, {"introduction": "一旦我们获得了合适的实验数据，下一步便是计算参数估计值。本练习 [@problem_id:2878432] 提供了一个具体、动手的计算过程，引导你完成核心的估计步骤。通过处理一个小型数据集，你将亲眼见证基于正交性条件的工具变量(IV)原理，如何与基于几何投影的两阶段最小二乘法(2SLS)殊途同归，从而深化对IV估计算法内在机理的理解。", "problem": "考虑一个具有潜在内生回归量的离散时间、有限样本系统辨识问题的线性回归形式：对于样本索引 $k \\in \\{1,\\dots,n\\}$，测量输出 $y_k$ 和回归量行向量 $\\varphi_k^{\\top}$ 满足 $y_k = \\varphi_k^{\\top}\\theta + v_k$，其中扰动项 $v_k$ 可能与 $\\varphi_k$ 的分量相关，但存在一个工具变量向量 $z_k$ 使得 $\\mathbb{E}[z_k v_k] = 0$ 且 $\\mathbb{E}[z_k \\varphi_k^{\\top}]$ 具有满列秩。将 $n$ 个样本收集到堆叠的向量和矩阵中，得到 $y \\in \\mathbb{R}^{n}$，$\\Phi \\in \\mathbb{R}^{n \\times p}$， $Z \\in \\mathbb{R}^{n \\times m}$，以及一个未知参数 $\\theta \\in \\mathbb{R}^{p}$。工具变量（IV）法和两阶段最小二乘（2SLS）法都基于将回归量投影到工具变量空间以消除内生性。\n\n给定一个具体的数据集，$n=4$, $p=2$, $m=2$：\n$$\n\\Phi=\\begin{bmatrix}\n1  2\\\\\n2  1\\\\\n1  1\\\\\n0  1\n\\end{bmatrix},\\quad\nZ=\\begin{bmatrix}\n1  0\\\\\n1  0\\\\\n0  1\\\\\n0  1\n\\end{bmatrix},\\quad\ny=\\begin{bmatrix}\n5\\\\\n4\\\\\n3\\\\\n2\n\\end{bmatrix}.\n$$\n仅使用正交投影算子和正交三角（QR）分解的定义和线性代数事实，按以下步骤进行：\n\n1) 计算 $Z$ 的QR分解，将关联的到 $Z$ 列空间上的正交投影算子写为 $P_Z$，并通过 $P_Z = QQ^{\\top}$ 从 $Q$ 因子显式地构造 $P_Z$。\n\n2) 利用工具变量原理，即工具变量强制残差与工具变量空间正交，形成工具变量空间中的正规方程，并使用投影算子 $P_Z$ 为该数据集获得一个显式估计量 $\\hat{\\theta}_{\\mathrm{IV}}$。\n\n3) 单独地，执行两阶段最小二乘法：首先将回归量投影到工具变量空间以获得拟合回归量，然后通过普通最小二乘法将 $y$ 对这些拟合回归量进行回归。推导出最终的估计量 $\\hat{\\theta}_{\\mathrm{2SLS}}$。\n\n4) 仅使用正交投影算子的性质和 $Q$ 的标准正交性，证明对于满列秩的 $Z$，有 $\\hat{\\theta}_{\\mathrm{IV}}=\\hat{\\theta}_{\\mathrm{2SLS}}$，并数值验证对于给定数据它们是一致的。\n\n将最终的估计量向量 $\\hat{\\theta}_{\\mathrm{IV}}$ 报告为单个 $1\\times 2$ 的行向量。无需四舍五入。", "solution": "所陈述的问题具有科学依据、适定、客观，并包含了求解所需的所有数据。它构成了线性系统辨识理论中的一个标准练习。因此，我们可以按要求分四个部分进行求解。\n\n给定的数据是回归量矩阵 $\\Phi$、工具变量矩阵 $Z$ 和输出向量 $y$：\n$$\n\\Phi=\\begin{bmatrix}\n1  2\\\\\n2  1\\\\\n1  1\\\\\n0  1\n\\end{bmatrix},\\quad\nZ=\\begin{bmatrix}\n1  0\\\\\n1  0\\\\\n0  1\\\\\n0  1\n\\end{bmatrix},\\quad\ny=\\begin{bmatrix}\n5\\\\\n4\\\\\n3\\\\\n2\n\\end{bmatrix}\n$$\n维度为 $n=4$，$p=2$，$m=2$。\n\n首先，我们计算工具变量矩阵 $Z$ 的正交三角（QR）分解。$Z$ 的列，记为 $z_1$ 和 $z_2$，是：\n$$\nz_1 = \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad z_2 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}\n$$\n我们观察到这些列已经正交，因为它们的内积是 $z_1^{\\top}z_2 = 1 \\cdot 0 + 1 \\cdot 0 + 0 \\cdot 1 + 0 \\cdot 1 = 0$。因此，Gram-Schmidt 过程简化为单位化。模长的平方为 $\\|z_1\\|^2 = 1^2+1^2 = 2$ 和 $\\|z_2\\|^2 = 1^2+1^2 = 2$。\n$Z$ 的列空间的标准正交基由矩阵 $Q$ 的列给出：\n$$\nq_1 = \\frac{z_1}{\\|z_1\\|} = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad q_2 = \\frac{z_2}{\\|z_2\\|} = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 1 \\end{bmatrix}\n$$\n$$\nQ = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  0 \\\\ 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix}\n$$\n上三角矩阵 $R$ 通过 $R = Q^{\\top}Z$ 求得：\n$$\nR = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  1  0  0 \\\\ 0  0  1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix} = \\frac{1}{\\sqrt{2}}\\begin{bmatrix} 2  0 \\\\ 0  2 \\end{bmatrix} = \\begin{bmatrix} \\sqrt{2}  0 \\\\ 0  \\sqrt{2} \\end{bmatrix}\n$$\n到 $Z$ 列空间上的正交投影算子 $P_Z$ 由 $Q$ 构造为 $P_Z = QQ^{\\top}$：\n$$\nP_Z = \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  0 \\\\ 1  0 \\\\ 0  1 \\\\ 0  1 \\end{bmatrix}\\right) \\left(\\frac{1}{\\sqrt{2}}\\begin{bmatrix} 1  1  0  0 \\\\ 0  0  1  1 \\end{bmatrix}\\right) = \\frac{1}{2}\\begin{bmatrix} 1  1  0  0 \\\\ 1  1  0  0 \\\\ 0  0  1  1 \\\\ 0  0  1  1 \\end{bmatrix}\n$$\n\n其次，我们推导工具变量（IV）估计量 $\\hat{\\theta}_{\\mathrm{IV}}$。IV 原理要求残差 $y-\\Phi\\hat{\\theta}$ 与工具变量所张成的空间正交。这表示为 $Z^{\\top}(y-\\Phi\\hat{\\theta}_{\\mathrm{IV}}) = 0$。此条件等价于要求残差在 $Z$ 的列空间上的投影为零：$P_Z(y-\\Phi\\hat{\\theta}_{\\mathrm{IV}}) = 0$。这导出了方程组 $P_Z \\Phi \\hat{\\theta}_{\\mathrm{IV}} = P_Z y$。$\\hat{\\theta}_{\\mathrm{IV}}$ 的最小二乘解是 $\\hat{\\theta}_{\\mathrm{IV}} = ((P_Z\\Phi)^{\\top} P_Z\\Phi)^{-1} (P_Z\\Phi)^{\\top} P_Z y$。由于 $P_Z$ 是一个正交投影算子，它是对称的（$P_Z^{\\top}=P_Z$）和幂等的（$P_Z^2=P_Z$）。该表达式简化为：\n$$\n\\hat{\\theta}_{\\mathrm{IV}} = (\\Phi^{\\top}P_Z\\Phi)^{-1} \\Phi^{\\top}P_Z y\n$$\n我们计算所需的矩阵：\n$$\nP_Z \\Phi = \\frac{1}{2}\\begin{bmatrix} 1  1  0  0 \\\\ 1  1  0  0 \\\\ 0  0  1  1 \\\\ 0  0  1  1 \\end{bmatrix} \\begin{bmatrix} 1  2\\\\ 2  1\\\\ 1  1\\\\ 0  1 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} 3  3 \\\\ 3  3 \\\\ 1  2 \\\\ 1  2 \\end{bmatrix}\n$$\n$$\nP_Z y = \\frac{1}{2}\\begin{bmatrix} 1  1  0  0 \\\\ 1  1  0  0 \\\\ 0  0  1  1 \\\\ 0  0  1  1 \\end{bmatrix} \\begin{bmatrix} 5\\\\ 4\\\\ 3\\\\ 2 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} 9 \\\\ 9 \\\\ 5 \\\\ 5 \\end{bmatrix}\n$$\n接下来，我们形成与 $\\Phi^{\\top}$ 的乘积：\n$$\n\\Phi^{\\top}P_Z \\Phi = \\begin{bmatrix} 1  2  1  0 \\\\ 2  1  1  1 \\end{bmatrix} \\left(\\frac{1}{2}\\begin{bmatrix} 3  3 \\\\ 3  3 \\\\ 1  2 \\\\ 1  2 \\end{bmatrix}\\right) = \\frac{1}{2}\\begin{bmatrix} 3+6+1  3+6+2 \\\\ 6+3+1+1  6+3+2+2 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} 10  11 \\\\ 11  13 \\end{bmatrix}\n$$\n$$\n\\Phi^{\\top}P_Z y = \\begin{bmatrix} 1  2  1  0 \\\\ 2  1  1  1 \\end{bmatrix} \\left(\\frac{1}{2}\\begin{bmatrix} 9 \\\\ 9 \\\\ 5 \\\\ 5 \\end{bmatrix}\\right) = \\frac{1}{2}\\begin{bmatrix} 9+18+5 \\\\ 18+9+5+5 \\end{bmatrix} = \\frac{1}{2}\\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix}\n$$\n现在，我们求解 $\\hat{\\theta}_{\\mathrm{IV}}$：\n$$\n\\hat{\\theta}_{\\mathrm{IV}} = \\left(\\frac{1}{2}\\begin{bmatrix} 10  11 \\\\ 11  13 \\end{bmatrix}\\right)^{-1} \\left(\\frac{1}{2}\\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix}\\right) = \\begin{bmatrix} 10  11 \\\\ 11  13 \\end{bmatrix}^{-1} \\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix}\n$$\n该矩阵的行列式是 $10 \\cdot 13 - 11 \\cdot 11 = 130 - 121 = 9$。其逆矩阵是 $\\frac{1}{9}\\begin{bmatrix} 13  -11 \\\\ -11  10 \\end{bmatrix}$。\n$$\n\\hat{\\theta}_{\\mathrm{IV}} = \\frac{1}{9}\\begin{bmatrix} 13  -11 \\\\ -11  10 \\end{bmatrix} \\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix} = \\frac{1}{9}\\begin{bmatrix} 13 \\cdot 32 - 11 \\cdot 37 \\\\ -11 \\cdot 32 + 10 \\cdot 37 \\end{bmatrix} = \\frac{1}{9}\\begin{bmatrix} 416 - 407 \\\\ -352 + 370 \\end{bmatrix} = \\frac{1}{9}\\begin{bmatrix} 9 \\\\ 18 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\n\n第三，我们推导两阶段最小二乘（2SLS）估计量 $\\hat{\\theta}_{\\mathrm{2SLS}}$。\n在第一阶段，可能内生的回归量 $\\Phi$ 被投影到工具变量空间。拟合回归量为 $\\hat{\\Phi} = P_Z \\Phi$。我们已经计算过这个矩阵：\n$$\n\\hat{\\Phi} = \\frac{1}{2}\\begin{bmatrix} 3  3 \\\\ 3  3 \\\\ 1  2 \\\\ 1  2 \\end{bmatrix}\n$$\n在第二阶段，使用普通最小二乘法（OLS）将输出 $y$ 对拟合回归量 $\\hat{\\Phi}$ 进行回归：\n$$\n\\hat{\\theta}_{\\mathrm{2SLS}} = (\\hat{\\Phi}^{\\top}\\hat{\\Phi})^{-1}\\hat{\\Phi}^{\\top}y\n$$\n我们计算各个分量：\n$$\n\\hat{\\Phi}^{\\top}\\hat{\\Phi} = (P_Z\\Phi)^{\\top}(P_Z\\Phi) = \\Phi^{\\top}P_Z^{\\top}P_Z\\Phi = \\Phi^{\\top}P_Z\\Phi = \\frac{1}{2}\\begin{bmatrix} 10  11 \\\\ 11  13 \\end{bmatrix}\n$$\n$$\n\\hat{\\Phi}^{\\top}y = (P_Z\\Phi)^{\\top}y = \\Phi^{\\top}P_Z^{\\top}y = \\Phi^{\\top}P_Z y = \\frac{1}{2}\\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix}\n$$\n$\\hat{\\Phi}^{\\top}\\hat{\\Phi}$ 和 $\\hat{\\Phi}^{\\top}y$ 的表达式与为IV估计量计算的表达式相同。因此，得到的估计量必定相同：\n$$\n\\hat{\\theta}_{\\mathrm{2SLS}} = \\left(\\frac{1}{2}\\begin{bmatrix} 10  11 \\\\ 11  13 \\end{bmatrix}\\right)^{-1} \\left(\\frac{1}{2}\\begin{bmatrix} 32 \\\\ 37 \\end{bmatrix}\\right) = \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}\n$$\n\n第四，我们证明一般等价性 $\\hat{\\theta}_{\\mathrm{IV}}=\\hat{\\theta}_{\\mathrm{2SLS}}$ 并进行数值验证。\n2SLS 估计量定义为 $\\hat{\\theta}_{\\mathrm{2SLS}} = (\\hat{\\Phi}^{\\top}\\hat{\\Phi})^{-1}\\hat{\\Phi}^{\\top}y$，其中 $\\hat{\\Phi}=P_Z\\Phi$。使用 $P_Z=QQ^{\\top}$ 和性质 $Q^{\\top}Q=I_m$：\n$$\n\\hat{\\Phi}^{\\top}\\hat{\\Phi} = (QQ^{\\top}\\Phi)^{\\top}(QQ^{\\top}\\Phi) = \\Phi^{\\top}QQ^{\\top}QQ^{\\top}\\Phi = \\Phi^{\\top}Q(Q^{\\top}Q)Q^{\\top}\\Phi = \\Phi^{\\top}Q I_m Q^{\\top}\\Phi = (Q^{\\top}\\Phi)^{\\top}(Q^{\\top}\\Phi)\n$$\n以及\n$$\n\\hat{\\Phi}^{\\top}y = (QQ^{\\top}\\Phi)^{\\top}y = \\Phi^{\\top}QQ^{\\top}y = (Q^{\\top}\\Phi)^{\\top}(Q^{\\top}y)\n$$\n将这些代入 2SLS 公式中得到：\n$$\n\\hat{\\theta}_{\\mathrm{2SLS}} = [(Q^{\\top}\\Phi)^{\\top}(Q^{\\top}\\Phi)]^{-1} (Q^{\\top}\\Phi)^{\\top}(Q^{\\top}y)\n$$\n这是变换后模型 $Q^{\\top}y = (Q^{\\top}\\Phi)\\theta + Q^{\\top}v$ 中 $\\theta$ 的 OLS 解。\n\nIV 估计量 $\\hat{\\theta}_{\\mathrm{IV}}$ 源于正交条件 $Z^{\\top}(y-\\Phi\\hat{\\theta})=0$。由于 $Q$ 的列构成了 $Z$ 列空间的一个标准正交基，这等价于 $Q^{\\top}(y-\\Phi\\hat{\\theta})=0$，从而得到方程组 $Q^{\\top}\\Phi\\hat{\\theta}_{\\mathrm{IV}}=Q^{\\top}y$。\n\n在恰好识别情况下，即工具变量数量 $m$ 等于参数数量 $p$ 时，矩阵 $Q^{\\top}\\Phi$ 是一个方阵（$p \\times p$），并且在假设工具变量相关性的情况下是可逆的。唯一解是：\n$$\n\\hat{\\theta}_{\\mathrm{IV}} = (Q^{\\top}\\Phi)^{-1}Q^{\\top}y\n$$\n在同样的情况下（$m=p$），2SLS 表达式得以简化，因为 $(Q^{\\top}\\Phi)$ 是可逆的方阵：\n$$\n\\hat{\\theta}_{\\mathrm{2SLS}} = [(Q^{\\top}\\Phi)^{\\top}(Q^{\\top}\\Phi)]^{-1} (Q^{\\top}\\Phi)^{\\top}(Q^{\\top}y) = (Q^{\\top}\\Phi)^{-1}((Q^{\\top}\\Phi)^{\\top})^{-1}(Q^{\\top}\\Phi)^{\\top}(Q^{\\top}y) = (Q^{\\top}\\Phi)^{-1}Q^{\\top}y\n$$\n因此，我们证明了当 $m=p$ 时，$\\hat{\\theta}_{\\mathrm{IV}} = \\hat{\\theta}_{\\mathrm{2SLS}}$。\n所提供的数据集具有 $m=p=2$，因此该等价性成立。我们的数值计算证实了这一点，因为我们得到 $\\hat{\\theta}_{\\mathrm{IV}} = \\hat{\\theta}_{\\mathrm{2SLS}} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n\n最终的估计量向量报告为 $1 \\times 2$ 的行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  2 \\end{pmatrix}}\n$$", "id": "2878432"}, {"introduction": "获得参数估计值并非终点，我们还必须验证模型以及在估计过程中所做的假设。本练习 [@problem_id:2878466] 聚焦于IV方法中的一个关键验证步骤：检验工具变量的外生性。你将学习如何构建并计算一个统计检验量，用以检查模型残差与工具变量之间是否存在相关性，这是保证IV估计量一致性的一个必要条件。", "problem": "考虑一个通过工具变量法估计的单输入单输出线性时不变系统，得到残差序列 $\\{\\hat{e}(t)\\}_{t=1}^{T}$ 和工具变量序列 $\\{z(t)\\}_{t=1}^{T}$。在模型设定正确和工具变量外生性的条件下，一个基本的正交性条件表明，对于所有非负整数 $\\ell$，$\\mathbb{E}[\\hat{e}(t) z(t-\\ell)] = 0$。您的任务是使用一个跨多个滞后阶的残差-工具变量相关性检验来验证此条件。\n\n从正交性条件 $\\mathbb{E}[\\hat{e}(t) z(t-\\ell)] = 0$ 出发，并仅使用随机过程的期望、协方差和相关性的核心定义，构建一个检验统计量。该统计量对于一个给定的有限正整数 $L$，能够汇总在滞后阶 $\\ell = 0, 1, \\dots, L$ 上反对这些矩条件的样本证据。您的构建应是无量纲的，并且应被证明为检验所有这些矩条件同时成立的原假设的样本模拟。\n\n然后，对于 $T = 12$ 和 $L = 3$，假设残差和工具变量已去均值，使得 $\\frac{1}{T}\\sum_{t=1}^{T}\\hat{e}(t) = 0$ 和 $\\frac{1}{T}\\sum_{t=1}^{T}z(t) = 0$，并且已从数据中计算出以下样本能量和交叉和的汇总值：\n$$\n\\sum_{t=1}^{T}\\hat{e}(t)^{2} = 24,\\quad \\sum_{t=1}^{T}z(t)^{2} = 36,\n$$\n$$\n\\sum_{t=1}^{T} \\hat{e}(t) z(t) = 2,\\quad \\sum_{t=2}^{T} \\hat{e}(t) z(t-1) = -1,\\quad \\sum_{t=3}^{T} \\hat{e}(t) z(t-2) = 0,\\quad \\sum_{t=4}^{T} \\hat{e}(t) z(t-3) = 1.\n$$\n使用您构建的统计量，计算其对于这些数据的数值。您的最终答案应为 $L = 3$ 时检验统计量的值，以单一标量的形式给出。如果您选择给出数值近似值，请将答案四舍五入到四位有效数字；否则，请给出精确值。", "solution": "对于一个设定正确的模型和一个有效的工具变量，其工具变量正交性条件为 $\\mathbb{E}[\\hat{e}(t) z(t-\\ell)] = 0$ 对所有 $\\ell \\geq 0$ 成立。该条件表明，在时间 $t-\\ell$ 的工具变量与时间 $t$ 的估计后残差不相关。为了凭经验评估这一点，可以用它们的样本模拟替代总体期望，并进行归一化，以获得可在不同尺度上比较的无量纲量。\n\n量化两个零均值序列 $\\{x(t)\\}$ 和 $\\{y(t)\\}$ 之间线性关系强度的一种标准方法是滞后阶为 $\\ell$ 的样本互相关：\n$$\n\\hat{\\rho}_{xy}(\\ell) \\triangleq \\frac{\\sum_{t=\\ell+1}^{T} x(t)\\, y(t-\\ell)}{\\left(\\sum_{t=1}^{T} x(t)^{2}\\right)^{1/2}\\left(\\sum_{t=1}^{T} y(t)^{2}\\right)^{1/2}}.\n$$\n当 $x(t) = \\hat{e}(t)$ 和 $y(t) = z(t)$ 且两个序列都已去均值时，$\\hat{\\rho}_{\\hat{e}z}(\\ell)$ 是 $\\hat{e}(t)$ 和 $z(t-\\ell)$ 之间样本相关性的一个无量纲度量。在工具变量外生性的原假设下，对于每个非负滞后阶 $\\ell$，$\\hat{\\rho}_{\\hat{e}z}(\\ell)$ 应接近于零。\n\n为了同时汇总多个滞后阶上对零的偏离，可使用一个定义如下的波特曼图型统计量：\n$$\nQ_{L} \\triangleq T \\sum_{\\ell=0}^{L} \\hat{\\rho}_{\\hat{e}z}(\\ell)^{2}.\n$$\n该统计量是无量纲、非负的，并且随着样本互相关值的集合偏离零而增大。在标准正则性条件和较大 $T$ 的情况下，根据工具变量外生性的原假设，$Q_{L}$ 渐近服从自由度为 $L+1$ 的卡方分布，这证明了其可作为跨滞后阶的全局检验。\n\n我们现在根据提供的汇总数据计算 $Q_{3}$。首先，计算公共归一化项\n$$\nD \\triangleq \\left(\\sum_{t=1}^{T} \\hat{e}(t)^{2}\\right)^{1/2}\\left(\\sum_{t=1}^{T} z(t)^{2}\\right)^{1/2} = \\left(24\\right)^{1/2}\\left(36\\right)^{1/2} = \\sqrt{24 \\cdot 36} = \\sqrt{864} = 12\\sqrt{6}.\n$$\n对于每个滞后阶 $\\ell \\in \\{0,1,2,3\\}$，使用给定的交叉和：\n- 对于 $\\ell = 0$，\n$$\n\\hat{\\rho}_{\\hat{e}z}(0) = \\frac{\\sum_{t=1}^{T} \\hat{e}(t) z(t)}{D} = \\frac{2}{12\\sqrt{6}}.\n$$\n- 对于 $\\ell = 1$，\n$$\n\\hat{\\rho}_{\\hat{e}z}(1) = \\frac{\\sum_{t=2}^{T} \\hat{e}(t) z(t-1)}{D} = \\frac{-1}{12\\sqrt{6}}.\n$$\n- 对于 $\\ell = 2$，\n$$\n\\hat{\\rho}_{\\hat{e}z}(2) = \\frac{\\sum_{t=3}^{T} \\hat{e}(t) z(t-2)}{D} = \\frac{0}{12\\sqrt{6}} = 0.\n$$\n- 对于 $\\ell = 3$，\n$$\n\\hat{\\rho}_{\\hat{e}z}(3) = \\frac{\\sum_{t=4}^{T} \\hat{e}(t) z(t-3)}{D} = \\frac{1}{12\\sqrt{6}}.\n$$\n\n计算样本互相关的平方和：\n$$\n\\sum_{\\ell=0}^{3} \\hat{\\rho}_{\\hat{e}z}(\\ell)^{2} = \\left(\\frac{2}{12\\sqrt{6}}\\right)^{2} + \\left(\\frac{-1}{12\\sqrt{6}}\\right)^{2} + 0^{2} + \\left(\\frac{1}{12\\sqrt{6}}\\right)^{2}.\n$$\n逐项计算，\n$$\n\\left(\\frac{2}{12\\sqrt{6}}\\right)^{2} = \\frac{4}{(12)^{2}\\cdot 6} = \\frac{4}{864},\\quad \\left(\\frac{-1}{12\\sqrt{6}}\\right)^{2} = \\frac{1}{864},\\quad \\left(\\frac{1}{12\\sqrt{6}}\\right)^{2} = \\frac{1}{864}.\n$$\n因此，\n$$\n\\sum_{\\ell=0}^{3} \\hat{\\rho}_{\\hat{e}z}(\\ell)^{2} = \\frac{4 + 1 + 1}{864} = \\frac{6}{864} = \\frac{1}{144}.\n$$\n\n最后，乘以 $T = 12$ 以获得检验统计量\n$$\nQ_{3} = T \\sum_{\\ell=0}^{3} \\hat{\\rho}_{\\hat{e}z}(\\ell)^{2} = 12 \\cdot \\frac{1}{144} = \\frac{1}{12}.\n$$\n这是一个精确值，因此无需四舍五入。", "answer": "$$\\boxed{\\frac{1}{12}}$$", "id": "2878466"}]}