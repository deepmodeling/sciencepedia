## 引言
在信号处理、控制理论和[时间序列分析](@entry_id:178930)等领域，使用数学模型来描述和预测动态系统的行为是一项核心任务。其中，线性参数模型，如自回归（AR）、移动平均（MA）及其扩展形式，因其简洁性和强大的解释能力而成为应用最广泛的工具之一。然而，面对 ARX, ARMAX, OE, Box-Jenkins 等纷繁复杂的模型结构，初学者乃至有经验的工程师常常感到困惑：它们之间有何本质区别？各自适用于何种场景？如何系统地选择、估计和验证一个合适的模型？

本文旨在填补这一知识鸿沟，为读者提供一份关于线性参数模型结构的系统性指南。我们将从最基本的[随机过程](@entry_id:159502)理论出发，逐步构建起一个清晰、连贯的知识框架。文章分为三个核心部分，旨在带领读者从理论走向实践：第一章**“原理与机制”**将深入剖析各类模型背后的数学原理、统计特性及[可辨识性](@entry_id:194150)条件；第二章**“应用与跨学科联系”**将展示这些模型在[系统辨识](@entry_id:201290)、预测以及与状态空间、[连续时间系统](@entry_id:276553)等其他领域的联系中的实际应用；最后，第三章**“动手实践”**将通过具体的计算和分析问题，巩固所学知识。

现在，让我们从构建这些模型所需的基本原理和内在机制开始。

## 原理与机制

本章旨在深入探讨用于[系统辨识](@entry_id:201290)的线性参数模型的数学原理和内在机制。继前一章对[系统辨识](@entry_id:201290)基本概念的介绍之后，我们将从基本原理出发，系统地构建描述动态系统的各类模型结构。我们将首先建立[随机过程](@entry_id:159502)的理论基础，特别是[平稳过程](@entry_id:196130)的[沃尔德分解定理](@entry_id:142743)，它为使用线性滤波器模型提供了理论依据。随后，我们将引入[滞后算子](@entry_id:266398)这一核心工具，并用它来定义自回归（AR）、[移动平均](@entry_id:203766)（MA）以及更复杂的模型。本章的核心目标是阐明包括 ARX、ARMAX、输出误差（OE）和 Box-Jenkins（BJ）在内的标准模型族的结构、特性、区别与联系，并讨论保证模型唯一性和可辨识性的关键条件。

### [随机过程](@entry_id:159502)基础：[平稳性](@entry_id:143776)、[白噪声](@entry_id:145248)与[沃尔德分解](@entry_id:197953)

在[系统辨识](@entry_id:201290)领域，我们通常将未建模的动态或测量噪声抽象为[随机过程](@entry_id:159502)。其中最核心的一类是**协[方差](@entry_id:200758)[平稳过程](@entry_id:196130)（Covariance-Stationary Process）**，也称作**宽感平稳（Wide-Sense Stationary, WSS）过程**。一个[离散时间随机过程](@entry_id:136881) $\\{y_t\\}$ 若满足以下三个条件，则称为协[方差](@entry_id:200758)平稳：
1.  其均值 $\mathbb{E}[y_t]$ 为一个与时间 $t$ 无关的常数。
2.  其二阶矩有限，即 $\mathbb{E}[y_t^2] < \infty$。
3.  其[自协方差函数](@entry_id:262114) $\mathbb{E}[(y_t - \mathbb{E}[y_t])(y_s - \mathbb{E}[y_s])]$ 仅依赖于时间差（滞后） $\tau = t - s$，而与具体时间 $t$ 和 $s$ 无关。

最简单的[平稳过程](@entry_id:196130)是**[白噪声](@entry_id:145248)（White Noise）**。一个序列 $\\{e_t\\}$ 被称为二阶[白噪声](@entry_id:145248)，如果它满足 [@problem_id:2884731]：
-   零均值：$\mathbb{E}[e_t] = 0$ 对所有 $t$ 成立。
-   恒定[方差](@entry_id:200758)：$\operatorname{Var}(e_t) = \mathbb{E}[e_t^2] = \sigma^2$，其中 $0 < \sigma^2 < \infty$ 是一个与 $t$ 无关的常数。
-   不相关性：$\operatorname{Cov}(e_t, e_s) = \mathbb{E}[e_t e_s] = 0$ 对所有 $t \neq s$ 成立。

需要强调的是，此定义仅约束了过程的前两阶矩，并未要求序列是独立同分布的（独立同分布的序列被称为“强白噪声”）。在大多数[线性系统理论](@entry_id:172825)中，二阶白噪声的定义已足够。

白噪声构成了构建更复杂[随机过程](@entry_id:159502)的基石。这一思想由**[沃尔德分解定理](@entry_id:142743)（Wold Decomposition Theorem）**精炼而成。该定理是[时间序列分析](@entry_id:178930)的基石，它指出，任何零均值的协[方差](@entry_id:200758)[平稳过程](@entry_id:196130) $\\{y_t\\}$ 都可以唯一地分解为一个随机[部分和](@entry_id:162077)一个确定性部分之和 [@problem_id:2884661] [@problem_id:2884684]：
$$ y_t = \sum_{k=0}^{\infty} h_k e_{t-k} + d_t $$
其中：
-   $\\{e_t\\}$ 是一个白噪声序列，被称为过程 $\\{y_t\\}$ 的**新息（Innovations）**序列。新息 $e_t$ 是 $y_t$ 中无法由其无穷过去 $\\{y_{t-1}, y_{t-2}, \dots\\}$ [线性预测](@entry_id:180569)的部分。
-   $\\{h_k\\}$ 是一个平方可和（$\sum_{k=0}^{\infty} h_k^2 < \infty$）的[实数序列](@entry_id:141090)，通常进行归一化处理（如 $h_0 = 1$）。
-   随机部分 $\sum_{k=0}^{\infty} h_k e_{t-k}$ 是一个无穷阶的[移动平均](@entry_id:203766)（MA($\infty$)）过程，它本身是平稳的。
-   确定性部分 $\\{d_t\\}$ 是一个可以被 $\\{y_t\\}$ 的过去完全[线性预测](@entry_id:180569)的过程。对于大多数物理系统，我们通常假设不存在确定性部分，即 $d_t \equiv 0$，这类过程被称为**纯粹非确定性过程（Purely Nondeterministic Process）**。

[沃尔德分解定理](@entry_id:142743)的深刻之处在于它保证了任何平稳的随机扰动都可以被视为由[白噪声](@entry_id:145248)通过一个[线性时不变滤波器](@entry_id:271149) $\\{h_k\\}$ 生成。这为我们使用有理[传递函数](@entry_id:273897)模型（如 ARMA）来近似这个滤波器提供了理论依据。

理解新息的精确含义至关重要。在理论上，新息 $e_t$ 是 $y_t$ 相对于其无穷过去的[希尔伯特空间](@entry_id:261193) $\mathcal{H}_{t-1} = \overline{\operatorname{span}}\\{y_{t-1}, y_{t-2}, \dots\\}$ 的正交投影残差 [@problem_id:2884731]。这意味着 $e_t$ 不仅与 $y_{t-1}$ 不相关，而且与过去的所有值 $\\{y_{t-k} | k \ge 1\\}$ 都不相关 [@problem_id:2884661]。然而，在实际应用中，我们处理的是有限样本数据，并且模型的真实参数是未知的。我们计算的是**一步预测误差**或**残差** $\\{\hat{\varepsilon}_t\\}$，它们是基于有限过去信息和*估计*出的模型参数 $\hat{\theta}_N$ 得到的。由于[参数估计](@entry_id:139349)误差、有限历史数据截断以及初始条件的影响，这些残差通常只是对真实[新息序列](@entry_id:181232) $\\{e_t\\}$ 的一种近似 [@problem_id:2884731]。

### 线性模型的语言：算子与多项式

为了简洁地表示和操作[线性时不变](@entry_id:276287)模型，我们引入**[滞后算子](@entry_id:266398)（Backshift Operator）** $q^{-1}$。其定义为对任意时间序列 $x_t$，有 $q^{-1} x_t = x_{t-1}$。类似地， $q^{-k} x_t = x_{t-k}$。

利用[滞后算子](@entry_id:266398)，[线性差分方程](@entry_id:178777)可以被优雅地写作多项式形式。以一个**[自回归移动平均](@entry_id:143076)（Autoregressive Moving-Average, ARMA）** 模型为例。一个 ARMA(p,q) 过程由以下[差分方程](@entry_id:262177)定义：
$$ y_t + a_1 y_{t-1} + \dots + a_p y_{t-p} = e_t + c_1 e_{t-1} + \dots + c_q e_{t-q} $$
使用[滞后算子](@entry_id:266398)，该方程可以重写为：
$$ (1 + a_1 q^{-1} + \dots + a_p q^{-p}) y_t = (1 + c_1 q^{-1} + \dots + c_q q^{-q}) e_t $$
若定义自回归多项式 $A(q^{-1}) = \sum_{k=0}^{p} a_k q^{-k}$ (其中 $a_0 = 1$) 和[移动平均](@entry_id:203766)多项式 $C(q^{-1}) = \sum_{k=0}^{q} c_k q^{-k}$ (其中 $c_0 = 1$)，则上述方程可以极为紧凑地表示为 [@problem_id:2884683]：
$$ A(q^{-1}) y_t = C(q^{-1}) e_t $$
这个方程描述了一个由[白噪声](@entry_id:145248) $e_t$ 驱动生成 $y_t$ 的系统。通过形式上求解 $y_t$，我们可以得到该系统的**[传递函数](@entry_id:273897)（Transfer Function）** $H(q^{-1})$：
$$ y_t = \frac{C(q^{-1})}{A(q^{-1})} e_t = H(q^{-1}) e_t $$
其中 $H(q^{-1})$ 是一个关于 $q^{-1}$ 的[有理函数](@entry_id:154279)。这种多项式算[子表示](@entry_id:141094)法是现代系统辨识中描述各类模型的标准语言。

### 参数模型的[内禀性质](@entry_id:273674)

一个有效的参数模型必须满足某些基本性质，以确保其在数学上是良定义的，并且其参数具有明确的物理或统计意义。

#### [平稳性](@entry_id:143776) (Stationarity)

对于一个 ARMA 过程 $y_t = H(q^{-1}) e_t = \frac{C(q^{-1})}{A(q^{-1})} e_t$ 而言，其宽感[平稳性](@entry_id:143776)取决于[传递函数](@entry_id:273897) $H(q^{-1})$ 的脉冲响应 $\\{h_k\\}$。只有当脉冲响应是平方可和的（$\sum_{k=0}^{\infty} h_k^2 < \infty$），过程的[方差](@entry_id:200758) $\operatorname{Var}(y_t) = \sigma_e^2 \sum_{k=0}^{\infty} h_k^2$ 才是有限的。

对于一个有理[传递函数](@entry_id:273897)，这一条件与其[极点位置](@entry_id:271565)直接相关。为了保证系统是**因果的**（即当前输出只依赖于当前和过去的输入）且**稳定的**，其[传递函数](@entry_id:273897)的所有极点必须严格位于[单位圆](@entry_id:267290)内部。[传递函数的极点](@entry_id:266427)是使分母 $A(z^{-1})$ 为零的复数值 $z$。如果我们将自回归多项式写为 $A(\lambda) = 1 + a_1 \lambda + \dots + a_p \lambda^p$，其根为 $\lambda_r$，那么系统的极点 $z_p$ 满足 $z_p^{-1} = \lambda_r$，即 $z_p = 1/\lambda_r$。因此，极点在单位圆内的条件 $|z_p| < 1$ 等价于 $|1/\lambda_r| < 1$，即 $|\lambda_r| > 1$。

由此，我们得到 ARMA 模型存在唯一因果宽感平稳解的充要条件：**自回归多项式 $A(z)$ 的所有根必须严格位于[单位圆](@entry_id:267290)外部** [@problem_id:2884688]。值得注意的是，[移动平均](@entry_id:203766)多项式 $C(z)$ 的根（即系统的零点）的位置不影响系统的稳定性，因此也不影响过程的平稳性。

#### 可逆性 (Invertibility)

[可逆性](@entry_id:143146)是[移动平均](@entry_id:203766)（MA）和 ARMA 模型的一个重要性质。一个 MA 模型是可逆的，如果其当前的[白噪声](@entry_id:145248)输入 $e_t$ 可以表示为当前和过去观测值 $y_t, y_{t-1}, \dots$ 的一个收敛的线性组合。这等价于该 MA 模型可以表示为一个收敛的无穷阶 AR 模型。

[可逆性](@entry_id:143146)的重要性在于它保证了对于给定的自相关函数（ACF），存在一个唯一的 MA 模型。以一个 MA(1) 过程为例：$y_t = e_t + c_1 e_{t-1}$。其滞后为1的自相关系数为 $\rho_y(1) = \frac{c_1}{1+c_1^2}$。对于给定的 $\rho_y(1)$（例如 $\rho_y(1)=0.4$），解这个关于 $c_1$ 的二次方程会得到两个解：$c_1$ 和 $1/c_1$。例如，当 $\rho_y(1)=0.4$ 时，两个解是 $c_1=0.5$ 和 $c_1=2$。这两个模型具有完全相同的二阶统计特性（即相同的 ACF），但只有一个是可逆的 [@problem_id:2884724]。

[可逆性](@entry_id:143146)的条件与[平稳性条件](@entry_id:191085)类似，但适用于移动平均多项式 $C(z)$：**MA 或 ARMA 模型是可逆的，当且仅当其[移动平均](@entry_id:203766)多项式 $C(z)$ 的所有根都严格位于[单位圆](@entry_id:267290)外部**。对于 MA(1) 的例子，这意味着 $|c_1| < 1$。因此，在 $c_1=0.5$ 和 $c_1=2$ 两个选项中，我们选择 $c_1=0.5$ 作为唯一的、符合惯例的可逆模型参数。

#### 因果性、稳定性与[平稳性](@entry_id:143776)之辨

在讨论因果 ARMA 模型时，有界输入有界输出（BIBO）稳定性和宽感[平稳性](@entry_id:143776)是等价的，两者都要求自回归[多项式的根](@entry_id:154615)在单位圆外。然而，从更根本的层面看，这两个概念有所不同 [@problem_id:2884729]。BIBO 稳定性是描述一个（确定性）滤波器特性的，要求其脉冲响应绝对可和。而宽感平稳性是描述一个[随机过程](@entry_id:159502)统计特性的，要求其脉冲响应平方可和。

虽然对于因果有理系统，这两个条件等价，但一个 ARMA 方程可以存在不满足因果 BIBO 稳定性的平稳解。例如，对于 AR(1) 模型 $y_t - a y_{t-1} = e_t$ 且 $|a|>1$，其因果解释是不稳定的。然而，存在一个非因果（双边）的平稳解 $y_t = -\sum_{k=1}^{\infty} a^{-k} e_{t+k}$。这提醒我们，平稳性是过程的固有属性，而因果性是我们为了物理[可实现性](@entry_id:193701)而施加的额外约束。

### 线性系统模型分类法

[沃尔德分解定理](@entry_id:142743)告诉我们，[平稳过程](@entry_id:196130)可以用一个 MA($\infty$) 模型表示。在实践中，我们寻求用有限阶的参数模型来近似这个可能无限阶的表示。这些模型统称为 ARMA 类模型，它们构成了[系统辨识](@entry_id:201290)的工具箱。

#### 时间序列模型（无外部输入）

当系统没有可测量的外部输入 $u(t)$ 时，我们处理的是纯时间序列模型。
- **AR(p) 模型**: $A(q^{-1})y_t = e_t$。过程的当前值是其过去值和白噪声的[线性组合](@entry_id:154743)。
- **MA(q) 模型**: $y_t = C(q^{-1})e_t$。过程是过去[白噪声](@entry_id:145248)项的线性组合。
- **ARMA(p,q) 模型**: $A(q^{-1})y_t = C(q^{-1})e_t$。这是最通用的结构，结合了 AR 和 MA 的特点。

选择哪种模型结构通常基于对数据的初步分析，特别是观察其样本[自相关函数](@entry_id:138327)（ACF）和[偏自相关函数](@entry_id:143703)（PACF）。这些函数的行为模式为底层过程结构提供了线索 [@problem_id:2884684]：
- 如果一个过程是 **MA(q)**，其理论 ACF 将在滞后 $q$ 之后“截尾”（变为零）。
- 如果一个过程是 **AR(p)**，其理论 PACF 将在滞后 $p$ 之后“截尾”。
- 如果一个过程是 **ARMA(p,q)**，其 ACF 和 PACF 通常都表现出“拖尾”行为（例如，指数衰减或[阻尼正弦波](@entry_id:271710)）。其中，ACF 的拖尾行为主要反映了 AR 部分的动态特性（极点），而 PACF 的拖尾行为则反映了 MA 部分的动态特性（零点）。

因此，通过检查样本 ACF 和 PACF 的截尾或拖尾特性，我们可以初步判断一个适合的模型类别及其阶次。

#### 包含外部输入的模型

当系统存在可测量的输入 $u(t)$ 时，模型需要同时描述输入到输出的路径和噪声的动态。一般形式为：
$$ y(t) = G(q^{-1})u(t) + H(q^{-1})e(t) $$
其中 $G(q^{-1})$ 是过程[传递函数](@entry_id:273897)， $H(q^{-1})$ 是噪声[传递函数](@entry_id:273897)。不同的模型族对 $G(q^{-1})$ 和 $H(q^{-1})$ 的结构施加了不同的约束 [@problem_id:2878937] [@problem_id:2883893]。

- **ARX (Autoregressive with Exogenous Input)** 模型：
  $$ A(q^{-1})y(t) = B(q^{-1})u(t) + e(t) $$
  其[传递函数](@entry_id:273897)结构为 $G(q^{-1}) = \frac{B(q^{-1})}{A(q^{-1})}$ 和 $H(q^{-1}) = \frac{1}{A(q^{-1})}$。ARX 模型的主要特点是过程动态和噪声动态共享相同的极点（由 $A(q^{-1})$ 定义）。这是一种结构性约束，使得模型估计相对简单（[线性回归](@entry_id:142318)），但也限制了其灵活性。

- **ARMAX (Autoregressive Moving-Average with Exogenous Input)** 模型：
  $$ A(q^{-1})y(t) = B(q^{-1})u(t) + C(q^{-1})e(t) $$
  其结构为 $G(q^{-1}) = \frac{B(q^{-1})}{A(q^{-1})}$ 和 $H(q^{-1}) = \frac{C(q^{-1})}{A(q^{-1})}$。与 ARX 类似，ARMAX 模型也强制过程和噪声共享相同的极点。但它通过 $C(q^{-1})$ 多项式为[噪声模型](@entry_id:752540)提供了更大的灵活性。

- **OE (Output Error)** 模型：
  $$ y(t) = \frac{B(q^{-1})}{F(q^{-1})}u(t) + e(t) $$
  其结构为 $G(q^{-1}) = \frac{B(q^{-1})}{F(q^{-1})}$ 和 $H(q^{-1}) = 1$。OE 模型假设噪声是直接叠加在系统输出端的[白噪声](@entry_id:145248)。它将过程动态的建模与噪声完全分离，当噪声的来源与系统动态无关时，这是一个非常有效的模型。

- **BJ (Box-Jenkins)** 模型：
  $$ y(t) = \frac{B(q^{-1})}{F(q^{-1})}u(t) + \frac{C(q^{-1})}{D(q^{-1})}e(t) $$
  其结构为 $G(q^{-1}) = \frac{B(q^{-1})}{F(q^{-1})}$ 和 $H(q^{-1}) = \frac{C(q^{-1})}{D(q^{-1})}$。BJ 模型是这几类模型中最灵活的结构，它为过程动态和噪声动态提供了完全独立的参数化。

**ARMAX 与 BJ 的比较**：ARMAX 模型是 BJ 模型的一个特例，即当 $F(q^{-1})=D(q^{-1})=A(q^{-1})$ 时。BJ 模型的灵活性是其主要优势。当物理系统的动态（例如，一个[化学反应](@entry_id:146973)釜的动态）和噪声的动态（例如，由传感器滤波或下游扰动引起的动态）来源不同时，它们的极点结构很可能也不同。在这种情况下，强迫它们共享极点的 ARMAX 模型可能会导致对过程或噪声（或两者）的描述产生偏差。因此，当有理由相信过程和噪声动态不相关时，更灵活的 BJ 模型是更优的选择 [@problem_id:2884674]。

### 唯一性与[可辨识性](@entry_id:194150)

最后一个关键问题是确保我们估计的模型参数是唯一的。对于一个给定的系统，可能存在多种参数组合，它们能产生相同的输入输出行为。为了得到一个确定的模型，我们需要施加规范化约束，定义一个**典范形式（Canonical Form）**。对于 BJ 这样的复杂模型，主要存在以下几类模糊性 [@problem_id:2884725]：

1.  **公因[子模](@entry_id:148922)糊性**：如果[传递函数](@entry_id:273897) $\frac{B(q^{-1})}{F(q^{-1})}$ 的分子和分母有一个公因子 $K(q^{-1})$，那么这个因子可以被约去，但其参数却无法唯一确定。解决方法是要求分子和分母多项式**[互质](@entry_id:143119)（Coprime）**。

2.  **延迟表示模糊性**：系统的纯延迟可以由一个显式的延迟项 $q^{-n_k}$ 表示，也可以隐含在 $B(q^{-1})$ 多项式的前导零系数中。例如，$B(q^{-1})=0+b_2 q^{-2}+\dots = q^{-1}(b_2 q^{-1}+\dots)$。为了消除这种模糊性，标准做法是要求多项式 $B(q^{-1})$ 和 $C(q^{-1})$ 的常数项不为零（即 $B(0) \neq 0, C(0) \neq 0$），并将所有纯延迟都集中在显式的 $n_k$ 和 $n_d$ 中。

3.  **尺度模糊性**：首先，[传递函数](@entry_id:273897)的分母多项式 $F(q^{-1})$ 和 $D(q^{-1})$ 的尺度是任意的，因为任何非零常数可以同时乘以分子和分母而不改变其值。标准做法是将其规范化为**[首一多项式](@entry_id:152311)（Monic Polynomial）**，即令其常数项为1（$F(0)=1, D(0)=1$）。其次，[噪声模型](@entry_id:752540) $H(q^{-1})e(t)$ 的二阶特性不受变换 $H \rightarrow \alpha H, \sigma_e^2 \rightarrow \sigma_e^2/\alpha^2$ 的影响。解决方法是固定其中一个的尺度。通常采用的方法是，将 $C(q^{-1})$ 也规范化为[首一多项式](@entry_id:152311)（$C(0)=1$），然后自由估计噪声[方差](@entry_id:200758) $\sigma_e^2$。

通过施加这些关于互质性、延迟和尺度的规范化约束，我们可以为参数模型定义一个唯一的典范形式，从而确保在理想条件下（即数据信息充分且模型结构正确），辨识结果是唯一的。