## 引言
在从数据中学习和理解动态世界的征途上，一个根本性问题始终横亘在科学家与工程师面前：我们能否仅通过观察系统的输入和输出，就能准确地揭示其内部的运作机理？系统辨识领域致力于回答这一问题，而其答案的核心在于两个紧密相连的支柱概念：**可辨识性 (Identifiability)** 与 **[持续激励](@entry_id:263834) (Persistency of Excitation)**。可辨识性关注模型结构本身是否允许参数被唯一确定，而[持续激励](@entry_id:263834)则审视我们用于探测系统的实验信号是否足够“丰富”，以揭示其全部动态特性。许多辨识任务的失败，并非源于算法的缺陷，而是源于对这两个前提条件的忽视——即实验数据本身在信息层面存在先天不足。

本文旨在系统性地扫清这一认知[盲区](@entry_id:262624)。我们将引领读者穿越理论的深层结构，直达应用的广阔天地。在“**原理与机制**”一章中，我们将奠定坚实的理论基础，精确定义[可辨识性](@entry_id:194150)的不同层次，并揭示[持续激励](@entry_id:263834)作为信息量度量的数学本质。随后，在“**应用与跨学科连接**”一章中，我们将展示这些理论如何在[系统辨识](@entry_id:201290)、[自适应控制](@entry_id:262887)、[鲁棒设计](@entry_id:269442)乃至系统生物学等前沿领域中，成为解决实际挑战的关键钥匙。最后，通过“**动手实践**”部分，读者将有机会将理论知识转化为解决具体问题的实践技能。现在，让我们从最基本的问题开始：一个模型在理论上可被辨识的条件是什么？又是什么样的输入信号，才具备揭示系统秘密的“魔力”？

## 原理与机制

在[系统辨识](@entry_id:201290)领域，一个核心问题是：我们能否仅通过观测一个系统的输入和输出来唯一地确定其内部参数？这个问题的答案并非总是肯定的，它取决于两个相互关联的核心概念：**可辨识性 (Identifiability)** 和 **[持续激励](@entry_id:263834) (Persistency of Excitation)**。[可辨识性](@entry_id:194150)研究的是模型结构本身是否允许参数的唯一确定，而[持续激励](@entry_id:263834)则关注我们用于“探查”系统的输入信号是否足够“丰富”，从而能够揭示系统的所有动态特性。本章将深入探讨这两个概念的基本原理与核心机制。

### 可辨识性：模型固有属性的探究

在开始任何辨识实验之前，我们必须首先确定所选择的模型结构在理论上是否是可辨识的。一个不可辨识的模型意味着，即使在理想的无噪声情况下，拥有无限长的观测数据，我们也无法唯一地确定其参数。

#### 结构[可辨识性](@entry_id:194150)

**结构可辨识性** 是模型类的一个固有属性，它描述了从模型参数到其所产生的输入-输出行为的映射是否是[单射](@entry_id:183792)的（一对一的）。如果一个模型结构是可辨识的，那么不同的参数集必然会产生不同的输入-输出行为。

考虑一个由参数 $\theta$ 决定的[非线性状态空间模型](@entry_id:144729) [@problem_id:2876715]：
$$
\begin{align*}
\dot{x}(t) = f(x(t), u(t), \theta) \\
y(t) = h(x(t), u(t), \theta)
\end{align*}
$$
对于一个给定的初始条件 $x_0$，该模型为每一个参数 $\theta \in \Theta$ 定义了一个从输入函数 $u(\cdot)$ 到输出函数 $y(\cdot)$ 的映射，我们称之为输入-输出映射 $\mathcal{M}_{\theta}$。

**全局结构可辨识性 (Global Structural Identifiability)** 是指，对于[参数空间](@entry_id:178581) $\Theta$ 中的任意两个不同参数 $\theta_1 \neq \theta_2$，它们对应的输入-输出映射也必须不同，即 $\mathcal{M}_{\theta_1} \neq \mathcal{M}_{\theta_2}$。换言之，我们总能找到至少一个容许的输入信号 $u(\cdot)$，使得在相同[初始条件](@entry_id:152863)下，这两个参数产生的输出 $y_{\theta_1}(\cdot; u)$ 和 $y_{\theta_2}(\cdot; u)$ 是可区分的。形式上，这意味着从参数到输入-输出映射的函数 $\theta \mapsto \mathcal{M}_{\theta}$ 是单射的。

与全局可辨识性相对的是 **局部结构可辨识性 (Local Structural Identifiability)**。一个模型在某个标称参数点 $\theta_0$ 处是局部结构可辨识的，如果存在一个包含 $\theta_0$ 的邻域，在该邻域内，除了 $\theta_0$ 本身，没有其他参数能产生与 $\theta_0$ 完全相同的输入-输出行为 [@problem_id:2876781]。

为了更清晰地理解这一区别，我们来看一个简单的静态模型：
$$y(t;\theta) = \theta_{1}^{2} u(t) + \theta_{2} u(t)^{2}$$
其中参数为 $\theta = (\theta_1, \theta_2) \in \mathbb{R}^2$。假设我们施加一个足够丰富的输入信号，例如 $u(t) = \cos(t) + \cos(2t)$，使得函数 $u(t)$ 和 $u(t)^2$ 是[线性无关](@entry_id:148207)的。现在，考虑两组不同的参数 $\theta_a = (\theta_{1,a}, \theta_{2,a})$ 和 $\theta_b = (\theta_{1,b}, \theta_{2,b})$。如果它们产生相同的输出，即 $y(t;\theta_a) = y(t;\theta_b)$ 对所有 $t$ 成立，那么我们必然有：
$$
(\theta_{1,a}^{2} - \theta_{1,b}^{2}) u(t) + (\theta_{2,a} - \theta_{2,b}) u(t)^{2} = 0
$$
由于 $u(t)$ 和 $u(t)^2$ [线性无关](@entry_id:148207)，这要求它们的系数必须为零，即 $\theta_{2,a} = \theta_{2,b}$ 且 $\theta_{1,a}^2 = \theta_{1,b}^2$。后一个条件意味着 $\theta_{1,a} = \pm \theta_{1,b}$。因为存在例如 $\theta_a = (1, 3)$ 和 $\theta_b = (-1, 3)$ 这样不同的参数[对产生](@entry_id:154125)完全相同的输出，所以该模型在 $\mathbb{R}^2$ 上不是全局结构可辨识的。

然而，在任意一个不包含原点的点 $\theta_0 = (\theta_{1,0}, \theta_{2,0})$（即 $\theta_{1,0} \neq 0$）附近，情况则不同。我们总可以取一个足够小的邻域，使得该邻域内所有点的 $\theta_1$ 分量都与 $\theta_{1,0}$ 同号。在这个邻域内，$\theta_1^2 = \theta_{1,0}^2$ 的唯一解就是 $\theta_1 = \theta_{1,0}$。因此，该模型在任何 $\theta_{1,0} \neq 0$ 的点都是局部结构可辨识的 [@problem_id:2876781]。

#### 基于[灵敏度分析](@entry_id:147555)的局部可辨识性检验

检验局部[可辨识性](@entry_id:194150)的一个强大工具是 **[灵敏度分析](@entry_id:147555)**。其思想是，如果一个参数的微小变化能够引起输出的显著变化，那么这个参数就更容易被辨识。我们将输出对每个参数的[偏导数](@entry_id:146280)称为 **[灵敏度函数](@entry_id:271212)**：
$$
s_i(t) = \frac{\partial y(t;\theta)}{\partial \theta_i}
$$
对于一个线性无关的[灵敏度函数](@entry_id:271212)集合 $\{s_i(t)\}_{i=1}^p$，任何参数的微小变化 $\Delta\theta$ 都会在输出上产生一个近似为 $\sum_i s_i(t) \Delta\theta_i$ 的变化，从而使得参数扰动是可观测的。

为了量化这一点，我们构建 **[费雪信息矩阵](@entry_id:750640) (Fisher Information Matrix, FIM)**。在[加性高斯白噪声](@entry_id:269320)的假设下，FIM (忽略一个常数因子) 等价于灵敏度向量 $s(t) = [s_1(t), \dots, s_p(t)]^\top$ 在观测区间上的[格拉姆矩阵](@entry_id:203297)（Gramian matrix）：
$$
G(\theta_0) = \int_{0}^{T} s(t) s(t)^{\top} dt
$$
局部结构可辨识性的一个充分条件是费雪信息矩阵 $G(\theta_0)$ 在标称参数 $\theta_0$ 处是**非奇异的**（即可逆的）。

回到之前的例子 $y(t;\theta) = \theta_{1}^{2} u(t) + \theta_{2} u(t)^{2}$ [@problem_id:2876781]，其[灵敏度函数](@entry_id:271212)在 $\theta_0 = (\theta_{1,0}, \theta_{2,0})$ 处为：
$$
s_1(t) = 2\theta_{1,0} u(t), \quad s_2(t) = u(t)^2
$$
对应的费雪信息矩阵为：
$$
G(\theta_0) = \int_{0}^{2\pi} \begin{pmatrix} 4\theta_{1,0}^2 u(t)^2  2\theta_{1,0} u(t)^3 \\ 2\theta_{1,0} u(t)^3  u(t)^4 \end{pmatrix} dt
$$
通过计算（使用 $u(t) = \cos(t) + \cos(2t)$），我们可以得到其[行列式](@entry_id:142978)为 $\det G(\theta_0) = 27\pi^2\theta_{1,0}^2$。该[行列式](@entry_id:142978)非零的条件是 $\theta_{1,0} \neq 0$，这与我们之前通过代数方法得到的局部[可辨识性](@entry_id:194150)条件完全一致。

#### 实践[可辨识性](@entry_id:194150)：超越结构

结构可辨识性是一个理想化的概念，它假设数据无噪声且可无限获取。然而在实践中，我们总是处理有限且带噪声的数据。这就引出了 **实践[可辨识性](@entry_id:194150) (Practical Identifiability)** 的概念。一个模型可能在结构上是可辨识的，但在实践中由于参数间的强相关性而变得几乎不可辨识。

这种情况可以通过一个例子来生动说明 [@problem_id:2876778]。考虑如下模型：
$$
y(t;\theta) = \theta_1 \exp(-t) + \theta_2 \exp(-(1+\varepsilon)t) + v(t)
$$
其中 $\varepsilon > 0$ 是一个很小的已知常数。由于[基函数](@entry_id:170178) $\exp(-t)$ 和 $\exp(-(1+\varepsilon)t)$ 是线性无关的，该模型对于任何 $\varepsilon > 0$ 都是全局结构可辨识的。然而，当 $\varepsilon \to 0^+$ 时，这两个指数函数变得非常相似，难以区分。

这种“相似性”可以通过费雪信息矩阵的**条件数** $\kappa = \lambda_{\max}/\lambda_{\min}$ 来量化。一个巨大的条件数意味着 FIM 接近奇异，这表明[参数估计](@entry_id:139349)问题是**病态的 (ill-conditioned)**。对于上述模型，使用在 $t_1=0$ 和 $t_2=\tau$ 两个时间点的采样数据，可以计算出当 $\varepsilon \to 0^+$ 时，FIM 的条件数呈如下渐进行为：
$$\kappa \approx \frac{16\cosh^{2}(\tau)}{\varepsilon^{2}\tau^{2}}$$
可以看到，当 $\varepsilon$ 趋于零时，[条件数](@entry_id:145150)以 $1/\varepsilon^2$ 的速度急剧增长。这意味着，尽[管模型](@entry_id:140303)在理论上是可辨识的，但要从实际数据中可靠地分离 $\theta_1$ 和 $\theta_2$ 将需要极高的[信噪比](@entry_id:185071)和极大的数据量。这个问题提醒我们，仅仅满足结构可辨识性是不够的，我们还需要保证实验数据能够有力地、清晰地揭示参数之间的差异。这正是“[持续激励](@entry_id:263834)”概念要解决的问题。

### [持续激励](@entry_id:263834)：输入信号的“丰富性”要求

[持续激励 (PE)](@entry_id:189611) 是对输入信号“信息量”或“丰富性”的一种数学刻画。一个具有[持续激励](@entry_id:263834)性质的输入信号能够充分“激发”系统的所有动态模式，从而使得我们能够从输出中观测到这些模式并辨识出相应的参数。

#### [离散时间系统](@entry_id:263935)的[持续激励](@entry_id:263834)

让我们从最简单的[线性回归](@entry_id:142318)模型开始。对于一个 $n$ 阶[有限脉冲响应](@entry_id:192542) (FIR) 系统，其输出可以写成 $y(k) = \theta^\top \phi_n(k)$，其中 $\phi_n(k) = [u(k), u(k-1), \dots, u(k-n+1)]^\top$ 是由输入信号及其延迟构成的**回归向量 (regressor vector)** [@problem_id:2876713]。如果我们从 $t$ 时刻开始收集 $N$ 个数据点，辨识问题就等价于求解一个线性方程组。唯一解存在的条件是[信息矩阵](@entry_id:750640)（即[格拉姆矩阵](@entry_id:203297)）$\sum_{k=t}^{t+N-1} \phi_n(k) \phi_n(k)^\top$ 是正定的。

**定义 ([持续激励](@entry_id:263834))**：如果存在整数 $N \ge n$ 和标量 $\alpha > 0$，使得对于所有时间 $t$，以下条件均成立，则称输入信号 $u(k)$ 是 **$n$ 阶[持续激励](@entry_id:263834)的**：
$$
\sum_{k=t}^{t+N-1} \phi_n(k) \phi_n(k)^\top \succeq \alpha I_n
$$
其中 $\succeq$ 表示矩阵半正定序。这个条件保证了在任何长度为 $N$ 的滑动窗口上，[信息矩阵](@entry_id:750640)的最小特征值都有一个正的下界 $\alpha$。$N$ 是保证激励性的最小窗口长度，而 $\alpha$ 则量化了激励的“强度”。

**一个反例**：什么样的信号不满足 PE 条件？考虑一个二阶 FIR 模型 $y(k) = \theta_1 u(k-1) + \theta_2 u(k-2)$。如果输入是指数信号 $u(k) = A\alpha^k$ (其中 $A, \alpha \neq 0$)，那么回归向量为 [@problem_id:2876760]：
$$\phi(k) = \begin{pmatrix} u(k-1) \\ u(k-2) \end{pmatrix} = \begin{pmatrix} A\alpha^{k-1} \\ A\alpha^{k-2} \end{pmatrix} = A\alpha^{k-2} \begin{pmatrix} \alpha \\ 1 \end{pmatrix}$$
显然，对于所有时刻 $k$，回归向量 $\phi(k)$ 都是共线的，它们只能张成 $\mathbb{R}^2$ 中的一个一维[子空间](@entry_id:150286)。因此，[信息矩阵](@entry_id:750640)的秩最多为 1，是奇异的。这意味着该输入不是 2 阶 PE 的。此时，任何满足 $(\theta_1 - \phi_1)\alpha + (\theta_2 - \phi_2) = 0$ 的不同参数对 $(\theta_1, \theta_2)$ 和 $(\phi_1, \phi_2)$ 都会产生完全相同的输出，导致参数不可辨识。例如，若 $\alpha=2$，参数集 $(3, -1)$ 和 $(1, 3)$ 就是不可区分的。

#### PE 与输入信号的谱特性

PE 条件与输入信号的[频谱](@entry_id:265125)密切相关。直观上，一个信号要能激励 $n$ 阶系统，其[频谱](@entry_id:265125)必须足够丰富。对于自回归外源输入 (ARX) 模型 $A(q^{-1})y(k) = B(q^{-1})u(k)$，辨识所有 $n_a+n_b$ 个参数需要回归向量（包含输入的延迟和输出的延迟）是 $n_a+n_b$ 阶 PE 的 [@problem_id:2876717]（注：如果包含$b_0$，则为 $n_a+n_b+1$ 阶）。

一个著名的结论是，要辨识一个包含 $n_a+n_b$ 个未知参数的 ARX 模型，输入信号 $u(k)$ 必须至少包含 $\lceil(n_a+n_b)/2\rceil$ 个不同频率的[正弦波](@entry_id:274998)分量 [@problem_id:2876753]。其根本原因在于，回归向量中的线性相关性会等价于存在一个非零的[多项式滤波](@entry_id:753578)器 $P(q^{-1})$ 能够“湮灭”输入信号，即 $P(q^{-1})u(k)=0$。该多项式 $P$ 的最高阶数受限于 $n_a+n_b-1$。另一方面，一个包含 $L$ 个正弦分量的信号在单位圆上对应 $2L$ 个不同的[特征值](@entry_id:154894)（频率点）。为了保证不存在任何非零的 $P(q^{-1})$ 能湮灭输入，必须使得 $2L$ 大于 $P$ 可能的最高阶数，即 $2L > n_a+n_b-1$，由此可得所需的最少正弦分量数 $L_{\min} = \lceil(n_a+n_b)/2\rceil$。

#### PE 概念的推广

PE 的思想可以自然地推广到更广泛的系统类别：
*   **[连续时间系统](@entry_id:276553)**：对于[连续时间系统](@entry_id:276553)，PE 的定义与离散时间类似，只是求和被积分取代。回归向量 $\phi_n(t)$ 由输入 $u(t)$ 与一组固定的稳定[基函数](@entry_id:170178)（如脉冲、拉盖尔函数等）卷积而成。如果存在 $T>0, \alpha>0$ 使得 $\int_{t}^{t+T} \phi_n(\tau)\phi_n(\tau)^\top d\tau \succeq \alpha I_n$ 对所有 $t$ 成立，则称输入对于该[基函数](@entry_id:170178)是 $n$ 阶[持续激励](@entry_id:263834)的 [@problem_id:2876752]。
*   **多输入多输出 (MIMO) 系统**：对于输入维度为 $m$ 的 MIMO ARX 系统，PE 的定义则与输入的块[托普利茨矩阵](@entry_id:271334) (block Toeplitz matrix) $T_{u,L}$ 相关。输入 $\mathbf{u}(k) \in \mathbb{R}^m$ 被认为是 $L$ 阶[持续激励](@entry_id:263834)的，如果由 $L$ 个延迟的输入块构成的矩阵 $T_{u,L}$ 在足够长的数据窗口上具有[满列秩](@entry_id:749628)，即秩为 $mL$。为了辨识一个阶数为 $n_a, n_b$ 的 MIMO ARX 系统，输入的 PE 阶数需要满足 $L \ge n_a+n_b$ [@problem_id:2876718]。

### 高级主题：闭环系统中的可辨识性

当系统在闭环中运行时，辨识问题会变得更加复杂和微妙。主要挑战在于，通过[反馈控制](@entry_id:272052)器，输入 $u(t)$ 与[过程噪声](@entry_id:270644) $v(t)$ 之间产生了**相关性**。

考虑一个闭环系统，其输出为 $y(t) = G(q^{-1})u(t) + v(t)$。在开环实验中，$u(t)$ 与 $v(t)$ 无关，因此它们的互功率谱 $\Phi_{uv}(\omega)$ 为零。这使得我们可以通过简单的谱除法得到系统[传递函数](@entry_id:273897) $G(e^{j\omega}) = \Phi_{uy}(\omega) / \Phi_{uu}(\omega)$。然而，在闭环中，$u(t)$ 是 $y(t)$ 的函数，而 $y(t)$ 又依赖于 $v(t)$，因此 $\Phi_{uv}(\omega) \neq 0$。此时，直接使用开环公式将得到一个有偏的、错误的结果：
$$\frac{\Phi_{uy}(\omega)}{\Phi_{uu}(\omega)} \neq G(e^{j\omega})$$
在最极端的情况下，如果反馈是完全由噪声驱动的（即没有外部参考信号），那么输入-输出数据将变得**无信息量 (uninformative)**。此时，无论系统的真实[传递函数](@entry_id:273897) $G$ 是什么，我们从数据中能辨识出的只是[反馈控制](@entry_id:272052)器 $K$ 的特性 [@problem_id:2876710]。

为了在闭环中成功辨识系统 $G$，必须打破 $u(t)$ 和 $v(t)$ 之间的相关性僵局。这通常通过以下两种方式实现：

1.  **引入外部激励**：在[反馈回路](@entry_id:273536)中加入一个与过程噪声 $v(t)$ 无关的外部参考信号 $r(t)$。如果这个参考信号是[持续激励](@entry_id:263834)的（即其功率谱 $\Phi_{rr}(\omega)$ 在一个非零测度的频率集合上大于零），它就会在输入 $u(t)$ 中引入一个与 $v(t)$ 无关的分量。这个分量足以让系统 $G$ 变得可辨识。
2.  **利用已知控制器信息**：如果反馈控制器 $K$ 的动态是已知的，即使没有外部参考信号，我们也可以通过计算重构出等效的参考信号，从而辨识出 $G$。

总结来说，一个实验（无论是开环还是闭环）对于辨识 $G$ 具有**[信息量](@entry_id:272315)**，当且仅当输入 $u(t)$ 中存在一个与噪声 $v(t)$ 无关且[持续激励](@entry_id:263834)的分量 [@problem_id:2876710]。在开环中，这个分量就是输入本身。在闭环中，这个分量必须由外部信号提供。这一原理是进行可靠系统辨识的基石。