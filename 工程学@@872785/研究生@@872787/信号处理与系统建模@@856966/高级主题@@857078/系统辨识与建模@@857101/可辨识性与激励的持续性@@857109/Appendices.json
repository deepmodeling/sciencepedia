{"hands_on_practices": [{"introduction": "要成功辨识一个系统，输入信号必须足够“丰富”，能够充分“激发”系统的所有动态特性。一个常见的误解是，只要输入信号的能量足够大，辨识就能成功。本练习将通过一个具体的反例来挑战这一直觉：我们将分析一个简单的正弦输入信号，并证明尽管其能量可以任意大，但它无法辨识一个阶数大于等于3的系统。这个练习旨在揭示持续激励（Persistency of Excitation, PE）的核心在于频谱的丰富性，而不仅仅是信号的幅度或能量 [@problem_id:2876722]。", "problem": "考虑一个单输入单输出的离散时间有限脉冲响应系统，其阶数 $n \\geq 3$ 已知，但系数未知。令时刻 $k$ 的回归量为向量 $\\varphi_{k} \\in \\mathbb{R}^{n}$，定义为 $\\varphi_{k} = \\big[u(k), u(k-1), \\dots, u(k-n+1)\\big]^{\\top}$。如果存在常数 $\\alpha  0$ 和整数 $N_{0} \\geq n$，使得对于所有整数 $t$，有限时域回归量格拉姆矩阵 $G_{t} = \\sum_{k=t}^{t+N_{0}-1} \\varphi_{k} \\varphi_{k}^{\\top}$ 满足 $G_{t} \\succeq \\alpha I_{n}$（其中 $I_{n}$ 是 $n \\times n$ 的单位矩阵），则称序列 $\\{u(k)\\}$ 是 $n$ 阶持续激励（PE）的。评估此性质的一种等价方法是通过渐近时间平均相关矩阵 $R = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\varphi_{k} \\varphi_{k}^{\\top}$，其中 $R$ 的正定性是 $n$ 阶持续激励性的必要条件。\n\n给定一个形式为 $u(k) = A \\cos(\\omega k)$ 的输入序列，其中 $A  0$ 且频率 $\\omega \\in (0, \\pi)$ 是固定的。这类输入允许通过增加 $A$ 来使每样本平均输入能量 $\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} u(k)^{2}$ 任意大，从而满足任何仅依赖于总能量或平均能量的指定能量最大化目标。\n\n仅使用上述定义和基本三角恒等式，计算与此输入相关的矩阵 $R$ 的最小特征值 $\\lambda_{\\min}$ 的精确值，作为 $A$、$n$ 和 $\\omega$ 的函数。你的最终答案必须是单一的闭式表达式。不需要四舍五入，也不涉及单位。此计算将建立一个反例，证明仅最大化输入能量并不能保证 $n \\geq 3$ 阶的持续激励性，并突显了输入信号频谱丰富度的必要性。", "solution": "该问题已经过验证，并被认定为有效。它具有科学依据，是良态的，且解决该问题所需的所有定义均已提供。我现在开始解答。\n\n渐近时间平均相关矩阵 $R$ 定义为\n$$R = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\varphi_{k} \\varphi_{k}^{\\top}$$\n其中 $\\varphi_{k} = \\big[u(k), u(k-1), \\dots, u(k-n+1)\\big]^{\\top}$ 是维度为 $n$ 的回归向量。矩阵 $R$ 是一个 $n \\times n$ 矩阵，其元素记为 $R_{ij}$（其中 $i, j \\in \\{1, 2, \\dots, n\\}$），由下式给出\n$$R_{ij} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} u(k-i+1) u(k-j+1)$$\n输入序列由 $u(k) = A \\cos(\\omega k)$ 给出，其中 $A  0$ 且 $\\omega \\in (0, \\pi)$。将其代入 $R_{ij}$ 的表达式中：\n$$R_{ij} = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\left[ A \\cos(\\omega(k-i+1)) \\right] \\left[ A \\cos(\\omega(k-j+1)) \\right]$$\n$$R_{ij} = A^2 \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\cos(\\omega k - \\omega(i-1)) \\cos(\\omega k - \\omega(j-1))$$\n我们使用积化和差三角恒等式 $\\cos(X)\\cos(Y) = \\frac{1}{2}[\\cos(X-Y) + \\cos(X+Y)]$。\n令 $X = \\omega k - \\omega(i-1)$ 及 $Y = \\omega k - \\omega(j-1)$。则，\n$$X-Y = \\omega(j-1) - \\omega(i-1) = \\omega(j-i)$$\n$$X+Y = 2\\omega k - \\omega(i-1) - \\omega(j-1) = 2\\omega k - \\omega(i+j-2)$$\n$R_{ij}$ 的表达式变为\n$$R_{ij} = A^2 \\lim_{N \\to \\infty} \\frac{1}{2N} \\sum_{k=0}^{N-1} \\left[ \\cos(\\omega(j-i)) + \\cos(2\\omega k - \\omega(i+j-2)) \\right]$$\n我们可以将和的极限分解为极限的和：\n$$R_{ij} = \\frac{A^2}{2} \\left[ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\cos(\\omega(j-i)) + \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\cos(2\\omega k - \\omega(i+j-2)) \\right]$$\n第一项 $\\cos(\\omega(j-i))$ 相对于求和索引 $k$ 是一个常数。其时间平均就是该常数本身。\n对于第二项，我们必须计算一个正弦波的时间平均值。对于任何非零频率 $\\nu$ 且其不为 $2\\pi$ 的倍数，时间平均值为零：$\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\cos(\\nu k + \\phi) = 0$。在我们的例子中，频率是 $2\\omega$。由于 $\\omega \\in (0, \\pi)$，我们有 $2\\omega \\in (0, 2\\pi)$。因此，该频率不是 $2\\pi$ 的倍数，极限为零。\n$$ \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{k=0}^{N-1} \\cos(2\\omega k - \\omega(i+j-2)) = 0$$\n因此，矩阵 $R$ 的元素为\n$$R_{ij} = \\frac{A^2}{2} \\cos(\\omega(j-i))$$\n现在，我们必须分析矩阵 $R$ 的结构。我们可以使用余弦差角公式 $\\cos(a-b) = \\cos(a)\\cos(b) + \\sin(a)\\sin(b)$ 来表示元素 $R_{ij}$：\n$$R_{ij} = \\frac{A^2}{2} \\left[ \\cos(\\omega(i-1)) \\cos(\\omega(j-1)) + \\sin(\\omega(i-1)) \\sin(\\omega(j-1)) \\right]$$\n这表明矩阵 $R$可以写成两个外积之和。我们定义两个向量 $c, s \\in \\mathbb{R}^n$：\n$$c = \\begin{pmatrix} \\cos(0\\omega) \\\\ \\cos(1\\omega) \\\\ \\vdots \\\\ \\cos((n-1)\\omega) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\cos(\\omega) \\\\ \\vdots \\\\ \\cos((n-1)\\omega) \\end{pmatrix}$$\n$$s = \\begin{pmatrix} \\sin(0\\omega) \\\\ \\sin(1\\omega) \\\\ \\vdots \\\\ \\sin((n-1)\\omega) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\sin(\\omega) \\\\ \\vdots \\\\ \\sin((n-1)\\omega) \\end{pmatrix}$$\n那么，矩阵 $R$ 可以表示为\n$$R = \\frac{A^2}{2} \\left( c c^{\\top} + s s^{\\top} \\right)$$\n矩阵 $R$ 是两个秩为1的矩阵 $c c^{\\top}$ 和 $s s^{\\top}$ 的线性组合。矩阵和的秩小于或等于它们秩的和。因此，$\\mathrm{rank}(R) \\le \\mathrm{rank}(c c^{\\top}) + \\mathrm{rank}(s s^{\\top})$。由于 $A>0$，向量 $c$ 和 $s$ 都是非零向量，所以 $\\mathrm{rank}(c c^{\\top})=1$ 且 $\\mathrm{rank}(s s^{\\top})=1$。这意味着 $\\mathrm{rank}(R) \\le 2$。\n\n为了确定确切的秩，我们检查向量 $c$ 和 $s$ 是否线性无关。考虑一个线性组合 $\\alpha c + \\beta s = 0$。这个向量方程意味着一组 $n$ 个标量方程：\n$$\\alpha \\cos(k\\omega) + \\beta \\sin(k\\omega) = 0 \\quad \\text{for } k = 0, 1, \\dots, n-1$$\n对于 $k=0$，方程变为 $\\alpha \\cos(0) + \\beta \\sin(0) = \\alpha \\cdot 1 + \\beta \\cdot 0 = \\alpha = 0$。\n将 $\\alpha=0$ 代入 $k=1$ 的方程，我们得到 $\\beta \\sin(\\omega) = 0$。由于 $\\omega \\in (0, \\pi)$，$\\sin(\\omega) \\ne 0$，这意味着 $\\beta=0$。\n因此，唯一的解是 $\\alpha=\\beta=0$，这证明了向量 $c$ 和 $s$ 是线性无关的。$R$ 的列空间由 $c$ 和 $s$ 张成，所以 $\\mathrm{rank}(R) = 2$。\n\n我们已知系统阶数 $n \\ge 3$。根据秩-零度定理，对于一个 $n \\times n$ 矩阵 $R$，我们有 $\\mathrm{rank}(R) + \\mathrm{nullity}(R) = n$。\n当 $\\mathrm{rank}(R)=2$ 时，$R$ 的零度是 $n-2$。\n由于 $n \\ge 3$，零度 $n-2 \\ge 1$。零度至少为 $1$ 意味着存在至少一个非零向量 $v$ 使得 $Rv=0v$。根据定义，这意味着 $\\lambda=0$ 是 $R$ 的一个特征值。\n\n此外，矩阵 $R$ 是一个格拉姆型矩阵，由半正定矩阵 $\\varphi_k \\varphi_k^{\\top}$ 的和的极限构成。因此，$R$ 本身必须是半正定的。一个半正定矩阵的所有特征值都必须是非负的。\n我们已经确定 $0$ 是 $R$ 的一个特征值，并且 $R$ 的所有特征值都大于或等于 $0$。因此，$R$ 的最小特征值 $\\lambda_{\\min}$ 必须是 $0$。这个结果对于任何 $A > 0$ 和任何 $\\omega \\in (0, \\pi)$，在给定 $n \\ge 3$ 的条件下都成立。", "answer": "$$\\boxed{0}$$", "id": "2876722"}, {"introduction": "理解了简单信号的局限性后，下一个自然的问题就是：我们如何系统地设计一个能满足持续激励条件的有效输入信号？本练习将引导你完成一个实际的设计任务：为多输入系统构建一个伪随机二进制序列（Pseudo-Random Binary Sequence, PRBS）输入。你将从持续激励的秩条件出发，推导所需的最短数据长度，并将这一理论要求与PRBS序列生成器（线性反馈移位寄存器）的内在属性联系起来，从而掌握将理论概念转化为工程实践的关键技能 [@problem_id:2876747]。", "problem": "考虑一个离散时间、线性时不变、多输入系统，该系统将使用长度为 $L$ 的块回归量通过最小二乘法进行辨识。一个具有 $m$ 个输入通道的输入序列 $\\{u(k)\\}$ 被称为是 $L$ 阶持续激励的，如果由输入的 $L$ 个连续延迟构建的块汉克尔矩阵（block Hankel matrix）具有满行秩，这保证了所有通过这 $L$ 个延迟线性进入的参数的可辨识性。一种广泛使用的确定性激励选择是由线性反馈移位寄存器（Linear Feedback Shift Register, LFSR）生成的伪随机二进制序列（Pseudo-Random Binary Sequence, PRBS）。一个寄存器阶数为 $n$ 的最大长度LFSR序列（m序列）的周期为 $P = 2^{n}-1$，并满足一个 $n$ 阶线性递推关系。\n\n你需要设计一个 $L$ 阶持续激励的双通道PRBS输入，并从秩和递推的第一性原理出发，验证最小数据长度要求。使用以下规范：\n- 输入数量 $m = 2$。\n- 块大小 $L = 4$。\n- 每个通道由一个独立的 $n$ 阶LFSR生成，在所用数据段上运行时不发生回绕，并通过 $v(k) = 2x(k)-1$ 从二进制LFSR输出 $x(k) \\in \\{0,1\\}$ 映射到 $\\{-1, +1\\}$。\n\n任务：\n1. 从 $L$ 阶持续激励的定义出发，构建输入的块汉克尔矩阵，并根据 $m$ 和 $L$ 推导出一个使满行秩成为可能的可用数据长度 $N$ 的必要下界。不要假设任何概率模型；纯粹从矩阵维度和秩的角度进行论证。\n2. 论证由LFSR生成的PRBS因其线性递推性而施加的另一个必要条件：建立 $L$ 与LFSR阶数 $n$ 之间的关系，以使由连续延迟构建的行块在每个通道内能够线性无关。\n3. 为给定的 $L$ 选择满足第2项中条件的最小LFSR阶数 $n$，并选择该阶数的两个不同的本原特征多项式来定义两个独立的通道。为每个通道陈述一个有效的本原多项式，并为每个LFSR指定一个非零初始状态。根据这两个LFSR和到 $\\{-1,+1\\}$ 的映射，明确定义双通道PRBS $u(k) = \\begin{pmatrix}u_{1}(k) \\\\ u_{2}(k)\\end{pmatrix}$。\n4. 使用最大长度序列的经过充分检验的性质（周期性和在短于完整周期的窗口上的近似白噪声自相关性），证明对于你的构造和最小 $N$ 值，具有 $L$ 个延迟的块汉克尔矩阵具有满行秩，因此该输入是 $L$ 阶持续激励的。你可以假设数据段长度 $N$ 不超过任一通道的周期，因此不会发生回绕。\n5. 作为最终答案，报告你在第1项中为给定的 $m$ 和 $L$ 推导出的最小可用数据长度 $N_{\\min}$。只提供 $N_{\\min}$ 的数值。\n\n提供所要求的构造和证明。你的最终答案必须是一个没有单位的单一数字，此整数结果无需四舍五入说明。", "solution": "所提出的问题是系统辨识理论和数字序列设计中一个定义明确的练习。它具有科学依据、内部一致，并包含了严谨求解所需的所有必要信息。因此，该问题被认为是有效的。\n\n求解过程将按顺序解决五个指定的任务。\n\n在整个分析过程中，所有数学实体都将按要求使用LaTeX表示。输入通道数为 $m=2$，持续激励的阶数要求为 $L=4$。\n\n1.  最小数据长度 $N$ 的推导。\n问题将 $L$ 阶持续激励定义为输入块汉克尔矩阵具有满行秩的条件。设输入信号为一个 $m$ 维向量序列 $\\{u(k)\\}$，其中 $u(k) \\in \\mathbb{R}^{m}$。我们考虑此序列中从 $k=0$ 到 $k=N-1$ 长度为 $N$ 的一段。\n\n由输入序列 $\\{u(k)\\}_{k=0}^{N-1}$ 的 $L$ 个连续延迟构建的块汉克尔矩阵，记为 $\\mathcal{H}$，其结构如下：\n$$\n\\mathcal{H} = \\begin{pmatrix}\nu(0)  u(1)  u(2)  \\dots  u(N-L) \\\\\nu(1)  u(2)  u(3)  \\dots  u(N-L+1) \\\\\n\\vdots  \\vdots  \\vdots  \\ddots  \\vdots \\\\\nu(L-1)  u(L)  u(L+1)  \\dots  u(N-1)\n\\end{pmatrix}\n$$\n在此矩阵中，每个元素 $u(k)$ 是一个大小为 $m \\times 1$ 的列向量。该矩阵由 $L$ 个块行和 $N-L+1$ 个列组成。因此，$\\mathcal{H}$ 的总维度为 $(m \\times L) \\times (N-L+1)$。\n\n为了使该矩阵具有满行秩，其秩必须等于其行数，即 $mL$。线性代数的一个基本定理指出，矩阵的秩不能超过其行数或列数。要使秩为 $mL$，一个必要条件是列数必须大于或等于行数。\n$$\n\\text{列数} \\ge \\text{行数}\n$$\n$$\nN - L + 1 \\ge mL\n$$\n这个不等式给出了所需数据长度 $N$ 的一个下界。对 $N$ 进行整理，我们得到：\n$$\nN \\ge mL + L - 1\n$$\n代入给定值 $m=2$ 和 $L=4$：\n$$\nN \\ge (2)(4) + 4 - 1\n$$\n$$\nN \\ge 8 + 4 - 1 = 11\n$$\n因此，为可能满足满秩条件所需的最小可用数据长度是 $N_{\\min} = 11$。\n\n2.  关于LFSR阶数 $n$ 的条件。\n每个输入通道 $u_i(k)$ 源自一个由 $n$ 阶线性反馈移位寄存器（LFSR）生成的二进制序列 $\\{x_i(k)\\}$。该二进制序列在伽罗瓦域 $GF(2)$ 上满足一个 $n$ 阶线性递推关系。实值序列 $u_i(k) = 2x_i(k) - 1$ 也满足一个线性递推关系，但它是在实数域 $\\mathbb{R}$ 上。这种递推的最小阶数被称为序列的线性复杂度。对于一个 $n$ 阶的最大长度序列（m序列），其在 $\\mathbb{R}$ 上的线性复杂度也是 $n$。\n\n块汉克尔矩阵 $\\mathcal{H}$ 中对应于单个通道 $i$ 的行是：\n$$\n\\begin{pmatrix}\nu_i(0)  u_i(1)  \\dots  u_i(N-L) \\\\\nu_i(1)  u_i(2)  \\dots  u_i(N-L+1) \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\nu_i(L-1)  u_i(L)  \\dots  u_i(N-1)\n\\end{pmatrix}\n$$\n这 $L$ 行是 $\\mathbb{R}^{N-L+1}$ 中的向量。如果这些行是线性相关的，那么将存在不全为零的系数 $\\alpha_0, \\alpha_1, \\dots, \\alpha_{L-1}$，使得：\n$$\n\\sum_{j=0}^{L-1} \\alpha_j u_i(k+j) = 0 \\quad \\text{for } k=0, 1, \\dots, N-L\n$$\n这个方程意味着序列 $\\{u_i(k)\\}$ 在此数据窗口上满足一个阶数至多为 $L-1$ 的线性递推关系。如果这种相关性是序列生成过程本身所固有的，它将阻止 $\\mathcal{H}$ 的全部 $mL$ 行线性无关。\n\n由于序列 $\\{u_i(k)\\}$ 的线性复杂度为 $n$，它满足一个最小阶为 $n$ 的递推关系。如果我们选择LFSR阶数 $n  L$，序列 $\\{u_i(k)\\}$ 将满足一个 $n$ 阶线性递推关系。这意味着序列的任意 $n+1$ 个连续时间平移版本之间保证存在线性相关性。由于 $n+1 \\le L$，这将意味着对应于通道 $i$ 的前 $n+1$ 行（并因此在所有 $L$ 行中）存在线性相关性。这将使得矩阵 $\\mathcal{H}$ 不可能达到满行秩 $mL$。\n\n为避免这种结构性线性相关，我们必须确保每个通道序列的线性复杂度至少为 $L$。因此，一个必要条件是：\n$$\nn \\ge L\n$$\n\n3.  LFSR阶数和多项式的选择。\n根据上一步的条件 $n \\ge L$ 和问题参数 $L=4$，LFSR阶数的最小可能整数值为 $n=4$。\n\n我们必须在 $GF(2)$ 上选择两个不同的4次本原特征多项式，以生成两个独立的m序列。$n$ 次本原多项式的数量由 $\\frac{\\phi(2^n-1)}{n}$ 给出，其中 $\\phi$ 是欧拉总计函数（Euler's totient function）。对于 $n=4$，数量为 $\\frac{\\phi(15)}{4} = \\frac{\\phi(3)\\phi(5)}{4} = \\frac{(2)(4)}{4} = 2$。\n这两个4次本原多项式是：\n$p_1(z) = z^4 + z + 1$\n$p_2(z) = z^4 + z^3 + 1$\n\n我们基于这些多项式定义两个LFSR：\n通道1：序列 $\\{x_1(k)\\}$ 由对应于 $p_1(z)$ 的递推关系生成，即 $x_1(k) = x_1(k-3) + x_1(k-4) \\pmod{2}$。\n通道2：序列 $\\{x_2(k)\\}$ 由对应于 $p_2(z)$ 的递推关系生成，即 $x_2(k) = x_2(k-1) + x_2(k-4) \\pmod{2}$。\n\n为了启动序列，我们必须指定非零的初始状态。一个简单的选择是：\nLFSR 1 的初始状态（寄存器中对应于 $k-4, k-3, k-2, k-1$ 的内容）：$(1, 0, 0, 0)$。\nLFSR 2 的初始状态：$(1, 0, 0, 0)$。\n\n然后，通过将二进制输出 $\\{x_1(k), x_2(k)\\}$ 从 $\\{0, 1\\}$ 映射到 $\\{-1, +1\\}$ 来构建双通道PRBS输入 $u(k)$：\n$$\nu(k) = \\begin{pmatrix} u_1(k) \\\\ u_2(k) \\end{pmatrix} = \\begin{pmatrix} 2x_1(k) - 1 \\\\ 2x_2(k) - 1 \\end{pmatrix}\n$$\n\n4.  满秩的证明。\n我们必须证明，对于所构造的输入和最小数据长度 $N=N_{\\min}=11$，汉克尔矩阵 $\\mathcal{H}$ 具有满行秩。\n根据任务1，对于 $m=2, L=4, N=11$，矩阵 $\\mathcal{H}$ 的维度为 $(mL) \\times (N-L+1) = 8 \\times 8$。为了具有满秩，这个方阵必须是非奇异的。这要求它的8个行是线性无关的。\n\n$\\mathcal{H}$ 的行的线性组合可以写成一对滤波后的序列。设常数 $c_{i,j}$（其中 $i \\in \\{1,2\\}, j \\in \\{0, \\dots, 3\\}$）为线性组合的系数。一个零线性组合意味着：\n$$\n\\sum_{j=0}^{3} c_{1,j} u_1(k+j) + \\sum_{j=0}^{3} c_{2,j} u_2(k+j) = 0, \\quad \\text{for } k = 0, 1, \\dots, 7\n$$\n令 $P_1(D) = \\sum_{j=0}^{3} c_{1,j} D^j$ 和 $P_2(D) = \\sum_{j=0}^{3} c_{2,j} D^j$ 为移位算子 $D$ 的多项式。条件是 $P_1(D)u_1(k) + P_2(D)u_2(k) = 0$。\n\n序列 $\\{u_1(k)\\}$ 和 $\\{u_2(k)\\}$ 的最小多项式分别为 $p_1(z)$ 和 $p_2(z)$，两者阶数都为 $n=4$。由于 $p_1(z)$ 和 $p_2(z)$ 是不同的不可约（因此互质）多项式，序列 $\\{u_1(k)\\}$ 和 $\\{u_2(k)\\}$ 在有理函数域上是线性无关的。如果关系 $P_1(D)u_1(k) + P_2(D)u_2(k) = 0$ 对所有 $k$ 都成立，那将意味着 $p_1(D)$ 整除 $P_2(D)$ 并且 $p_2(D)$ 整除 $P_1(D)$。\n然而，$P_1(D)$ 和 $P_2(D)$ 的阶数最多为 $L-1=3$，而 $p_1(D)$ 和 $p_2(D)$ 的阶数为 $n=4$。一个4次多项式不能整除一个非零的3次多项式。这迫使 $P_1(D)=0$ 和 $P_2(D)=0$，这又意味着所有系数 $c_{i,j}$ 必须为零。\n\n这证明了对于一个无限长序列，各行是线性无关的。对于我们长度为 $N-L+1=8$ 的有限数据窗口，这个长度大于最小多项式的阶数 $n=4$，但小于序列周期 $P=15$，m序列的代数性质足够强，可以防止这种线性相关性的发生。“近似白噪声”自相关特性意味着序列的移位版本之间近似正交，而使用独立的生成器确保了通道间的近似正交性。这些性质确保了 $8 \\times 8$ 矩阵 $\\mathcal{H}$ 是非奇异的。因此，构造的输入是 $L=4$ 阶持续激励的。\n\n5.  最小可用数据长度 $N_{\\min}$。\n如任务1中所推导，最小可用数据长度 $N_{\\min}$ 是满足 $N \\ge mL + L - 1$ 的最小整数 $N$。对于 $m=2$ 和 $L=4$，该值为11。", "answer": "$$\\boxed{11}$$", "id": "2876747"}, {"introduction": "在系统辨识的实践中，即使我们选择了理论上有效的输入信号，数值计算的局限性也可能成为辨识失败的隐形杀手。特别是当模型结构选择不当时（例如，使用高阶多项式基函数），回归量的严重病态条件会导致在计算机浮点运算中持续激励条件实际上被破坏。这个编程练习将让你亲手构建这样一个案例，直观地“看到”数值误差如何摧毁理论上的可辨识性，并进一步通过实现缩放和正交化等关键技术，学习如何诊断并解决这类数值稳定性问题，弥合理论与实际应用之间的鸿沟 [@problem_id:2876779]。", "problem": "给定一个线性回归设定，其回归量向量 $\\phi(t) \\in \\mathbb{R}^{p+1}$ 由标量输入 $x(t) \\in \\mathbb{R}$ 的确定性基函数构成。模型 $y(t) = \\phi(t)^{\\top}\\theta + w(t)$ 中参数向量 $\\theta \\in \\mathbb{R}^{p+1}$ 的可辨识性依赖于回归矩阵 $\\Phi \\in \\mathbb{R}^{N \\times (p+1)}$ 的性质，该矩阵的行是 $\\phi(t)^{\\top}$，其中 $N$ 是样本数量，$w(t)$ 是加性误差。常用的在长度为 $N$ 的数据窗口上的 $p+1$ 阶持续激励 (Persistency of Excitation, PE) 的概念用格拉姆矩阵 (Gram matrix) $G = \\sum_{t=1}^{N} \\phi(t)\\phi(t)^{\\top} = \\Phi^{\\top}\\Phi \\in \\mathbb{R}^{(p+1)\\times (p+1)}$ 来表示：存在一个常数 $\\alpha  0$ 使得 $G \\succeq \\alpha I_{p+1}$。当此条件成立时，模型在该窗口上是可辨识的。然而，即使 $G$ 理论上是满秩的，数值舍入和病态问题也可能在浮点运算中使其有效奇异，从而破坏实际的 PE。\n\n你的任务是构建一个案例，其中数值舍入会有效地破坏高阶多项式回归量的持续激励 (PE)，并实现缩放和正交化策略来缓解此问题。你的推理和实现应基于以下基本原理：\n- 回归矩阵 $\\Phi$ 的列由在输入 $\\{x(t)\\}_{t=1}^{N}$ 上求值的确定性基函数给出。\n- 格拉姆矩阵为 $G = \\Phi^{\\top}\\Phi$。\n- 窗口上的持续激励 (PE) 的特征是最小特征值 $\\lambda_{\\min}(G)$ 相对于一个正基准值而言远离零。\n- 有限精度算术可能导致病态基（例如在 $[0,1]$ 上的高阶单项式）的数值秩严重损失。\n\n程序要求：\n1. 使用输入 $x(t)$ 构建最高到 $p$ 次的单项式回归量，即 $\\phi(t) = [1, x(t), x(t)^{2}, \\dots, x(t)^{p}]^{\\top}$，并通过堆叠这些行向量来形成 $\\Phi$。\n2. 实现以下基构建策略：\n   - 在 $[0,1]$ 上的原始单项式（无缩放）。\n   - 缩放的单项式：通过仿射变换 $z(t) = 2x(t) - 1$ 将输入映射到 $[-1,1]$，然后将 $\\Phi$ 的每一列归一化为单位欧几里得范数。\n   - 通过薄 (简化) $QR$ 分解进行标准正交化：当 $N \\geq p+1$ 时，用 $\\Phi$ 的 $Q$ 因子替换它，该 $Q$ 因子具有标准正交的列。\n3. 对于任何构建的 $\\Phi$，计算：\n   - 格拉姆矩阵 $G = \\Phi^{\\top}\\Phi$。\n   - 最小和最大特征值 $\\lambda_{\\min}(G)$ 和 $\\lambda_{\\max}(G)$。\n   - 谱条件数 $\\kappa(G) = \\lambda_{\\max}(G) / \\lambda_{\\min}(G)$，如果 $\\lambda_{\\min}(G) = 0$（数值上），则使用一个大的有限占位符，如 $10^{308}$。\n   - 通过奇异值分解计算 $\\Phi$ 的数值秩，使用的阈值为 $\\tau_{\\mathrm{rank}} = \\max(N,p+1)\\,\\varepsilon\\,\\sigma_{\\max}$，其中 $\\varepsilon$ 是机器精度，$\\sigma_{\\max}$ 是 $\\Phi$ 的最大奇异值。\n   - 两项 PE 检查：\n     - 相对 PE 检查：如果 $\\lambda_{\\min}(G)/\\lambda_{\\max}(G) \\geq \\tau_{\\mathrm{rel}}$ 且 $\\tau_{\\mathrm{rel}} = 10^{-8}$，则声明 $\\mathrm{PE}_{\\mathrm{rel}}$ 为真。\n     - 尺度不变的绝对 PE 代理检查：如果 $\\lambda_{\\min}(G) \\geq \\tau_{\\mathrm{abs}} \\cdot \\mathrm{tr}(G)/(p+1)$ 且 $\\tau_{\\mathrm{abs}} = 10^{-8}$，则声明 $\\mathrm{PE}_{\\mathrm{abs}}$ 为真。\n4. 全程使用双精度算术。\n\n测试套件：\n在 $[0,1]$ 上使用 $N$ 个等距间隔的输入 $x(t)$。对于每个案例，按此顺序报告一个包含五项的列表：$[\\lambda_{\\min}(G), \\kappa(G), \\text{rank}(\\Phi), \\mathrm{PE}_{\\mathrm{rel}}, \\mathrm{PE}_{\\mathrm{abs}}]$。\n- 案例 A (高阶，原始单项式；舍入破坏 PE)：$N = 60$, $p = 25$，方法 = 在 $[0,1]$ 上的原始单项式。\n- 案例 B (高阶，缩放单项式；缓解病态)：$N = 60$, $p = 25$，方法 = 通过 $z = 2x-1$ 和列归一化实现的缩放单项式。\n- 案例 C (高阶，通过 $QR$ 标准正交化；缓解病态)：$N = 60$, $p = 25$，方法 = 来自原始单项式矩阵的简化 $QR$ 分解的 $Q$ 矩阵。\n- 案例 D (理想情况，低阶，原始单项式)：$N = 60$, $p = 5$，方法 = 在 $[0,1]$ 上的原始单项式。\n- 案例 E (边缘案例，维度上激励不足；结构性非 PE)：$N = 10$, $p = 25$，方法 = 在 $[0,1]$ 上的原始单项式。\n\n最终输出格式：\n你的程序应生成一行输出，其中包含一个逗号分隔的列表，该列表被方括号包围，其中每个元素是按 A、B、C、D、E 顺序排列的测试案例的五项列表。例如，输出必须如下所示：\n[[a11,a12,a13,a14,a15],[a21,a22,a23,a24,a25],[a31,a32,a33,a34,a35],[a41,a42,a43,a44,a45],[a51,a52,a53,a54,a55]]\n其中 $a_{ij}$ 是如上定义的浮点数、整数或布尔值。此问题不涉及单位。此问题不使用角度。百分比（如果有）必须表示为小数，而不是带百分号。", "solution": "所提出的问题陈述是在数值分析应用于系统辨识领域中一个有效且适定的练习。它具有科学依据、客观，并包含了进行操作所需的所有必要信息。任务是展示高阶多项式回归量中数值性持续激励 (PE) 损失的现象，并实现和评估标准的缓解技术。\n\n问题的核心在于回归矩阵 $\\Phi \\in \\mathbb{R}^{N \\times (p+1)}$ 及其相关的格拉姆矩阵 (Gram matrix) $G = \\Phi^{\\top}\\Phi \\in \\mathbb{R}^{(p+1)\\times (p+1)}$ 的性质。对于由 $y(t) = \\phi(t)^{\\top}\\theta + w(t)$ 描述的线性回归模型，参数向量 $\\theta \\in \\mathbb{R}^{p+1}$ 是否能从一组 $N$ 个测量中辨识出来，当且仅当格拉姆矩阵 $G$ 可逆，或等价地，正定 ($G \\succ 0$)。这个条件被称为持续激励 (PE)。在数值上，它通过验证 $G$ 的最小特征值（表示为 $\\lambda_{\\min}(G)$）是否充分地远离零来评估。\n\n格拉姆矩阵的条件数 $\\kappa(G) = \\lambda_{\\max}(G)/\\lambda_{\\min}(G)$ 提供了一个衡量其接近奇异性程度的指标。一个非常大的条件数表明矩阵是病态的，并且在数值上接近奇异。对于任何具有满列秩的矩阵 $\\Phi$，其格拉姆矩阵的条件数与其自身的条件数相关，关系为 $\\kappa(G) = (\\kappa(\\Phi))^2$。因此，$\\Phi$ 中的任何病态都会在 $G$ 中被放大。\n\n下面是与测试案例相对应的逐步分析。\n\n**案例 A：高阶原始单项式 ($N=60, p=25$)**\n\n回归量向量使用区间 $[0,1]$ 上的原始单项式基构建：\n$$ \\phi(t) = [1, x(t), x(t)^2, \\dots, x(t)^{25}]^{\\top} $$\n其中输入 $\\{x(t)\\}_{t=1}^{60}$ 在 $[0,1]$ 上等距分布。对于大的幂次 $p$，函数 $x^p$ 和 $x^{p-1}$ 在此区间上变得几乎无法区分。例如，对于 $x=0.95$，$x^{25} \\approx 0.277$ 而 $x^{24} \\approx 0.292$。当 $x$ 接近 $1$ 时，这些函数变得更加相似。这导致回归矩阵 $\\Phi$ 的列近似线性相关。这样的矩阵与臭名昭著的病态希尔伯特矩阵 (Hilbert matrix) 相关。\n\n因此，$\\Phi$ 是严重病态的。在有限精度算术（本例中为双精度）中，计算出的格拉姆矩阵 $G = \\Phi^{\\top}\\Phi$ 变为数值奇异。这意味着其最小特征值 $\\lambda_{\\min}(G)$ 将被计算为零或一个与机器精度相当数量级的数，这在功能上等同于零。$\\Phi$ 的数值秩将被发现小于参数数量 $p+1=26$。依赖于 $\\lambda_{\\min}(G)$ 显著为正的 PE 检查将失败。这展示了即使基理论上是满秩的，由于数值误差也会导致实际可辨识性的丧失。\n\n**案例 B：缩放的单项式 ($N=60, p=25$)**\n\n为了缓解案例 A 中观察到的病态问题，本案例采用了两种策略。首先，通过变换 $z(t) = 2x(t)-1$ 将输入区间 $[0,1]$ 仿射映射到 $[-1,1]$。现在的单项式基函数是 $z(t)$ 的幂，即 $\\{z(t)^k\\}_{k=0}^{p}$。这些函数在 $[-1,1]$ 上的区分度比 $x(t)$ 的幂在 $[0,1]$ 上的区分度要高。其次，也是更重要的一点，将得到的回归矩阵 $\\Phi$ 的每一列都归一化，使其具有单位欧几里得范数。\n\n这种列归一化平衡了基函数的尺度。在原始单项式的情况下，第一列（对应 $x^0=1$）的范数为 $\\sqrt{N}$，而最后一列（对应 $x^{25}$）的范数要小得多。这种列幅度上的极端差异是病态的主要来源。通过强制所有列 $j$ 都满足 $\\|\\Phi_{:,j}\\|_2 = 1$，我们创建了一个条件更好的矩阵 $\\Phi$。结果，新的格拉姆矩阵 $G = \\Phi^{\\top}\\Phi$ 的条件数将大大减小。其最小特征值 $\\lambda_{\\min}(G)$ 将是稳健的正数，并与零有明显的分离，从而满足 PE 检查。\n\n**案例 C：标准正交化的基 ($N=60, p=25$)**\n\n确保良好条件性的最有效方法是使用标准正交基。如果回归矩阵 $\\Phi_{\\text{new}}$ 的列是标准正交的，那么格拉姆矩阵就是单位矩阵，$G_{\\text{new}} = \\Phi_{\\text{new}}^{\\top}\\Phi_{\\text{new}} = I_{p+1}$。对于单位矩阵，所有特征值都为 $1$，因此 $\\lambda_{\\min}(G) = \\lambda_{\\max}(G) = 1$，条件数 $\\kappa(G) = 1$，这是最优的。\n\n通过对案例 A 中原始的、病态的单项式矩阵进行薄（或简化）$QR$ 分解，即 $\\Phi_{\\text{raw}} = QR$，可以达到这种理想状态。这里，$Q \\in \\mathbb{R}^{N \\times (p+1)}$ 是一个具有标准正交列的矩阵，$R \\in \\mathbb{R}^{(p+1) \\times (p+1)}$ 是一个上三角矩阵。通过用 $Q$ 替换回归矩阵，我们使用一个完美条件性的系统。得到的 $\\lambda_{\\min}(G)$ 将精确为 $1.0$（在浮点精度范围内），从而轻易通过两个 PE 检查。这种方法完全解决了数值病态问题。\n\n**案例 D：低阶原始单项式 ($N=60, p=5$)**\n\n这个案例作为一个“理想情况”的基准。对于 $p=5$ 的低多项式次数，单项式基函数 $\\{1, x, x^2, x^3, x^4, x^5\\}$ 在 $[0,1]$ 上有足够的区分度。回归矩阵 $\\Phi$ 的列不是近似线性相关的。因此，$\\Phi$ 和格拉姆矩阵 $G$ 都是良态的。最小特征值 $\\lambda_{\\min}(G)$ 会很小但舒适地大于零，并且 PE 检查将通过，无需任何缩放或正交化。这突显了该问题是高阶多项式所特有的。\n\n**案例 E：数据不足 ($N=10, p=25$)**\n\n这个案例展示了结构性而非数值性的 PE 缺失。我们试图从仅有的 $N=10$ 个数据点中辨识 $p+1 = 26$ 个参数。回归矩阵 $\\Phi$ 的维度是 $10 \\times 26$。任何矩阵的秩都不能超过其维度的最小值，因此 $\\text{rank}(\\Phi) \\leq \\min(10, 26) = 10$。由于秩小于列数（$10  26$），$\\Phi$ 的列根据定义是线性相关的。\n\n格拉姆矩阵 $G = \\Phi^{\\top}\\Phi$ 是一个 $26 \\times 26$ 的矩阵，其秩等于 $\\Phi$ 的秩。由于 $\\text{rank}(G) = 10  26$，$G$ 是奇异的。奇异矩阵必须至少有一个零特征值；在这种情况下，它将至少有 $26 - 10 = 16$ 个零特征值。因此，$\\lambda_{\\min}(G) = 0$。这不是一个数值假象，而是一个欠定问题的根本后果。PE 条件在结构上失败，与所使用的基无关。", "answer": "[[1.9868693755353846e-17,1e+308,12,False,False],[0.003923838640707769,1079.7997380126742,26,True,True],[1.0,1.0,26,True,True],[2.147253457813589e-05,125184.22527264626,6,True,True],[0.0,1e+308,10,False,False]]", "id": "2876779"}]}