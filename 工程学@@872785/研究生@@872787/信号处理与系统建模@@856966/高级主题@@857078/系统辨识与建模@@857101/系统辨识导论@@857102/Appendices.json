{"hands_on_practices": [{"introduction": "在我们尝试估计模型参数之前，必须首先确保我们选择的模型结构能够导出一个唯一的解。本练习将探讨结构辨识性的概念，通过一个常见的输出误差（OE）模型，揭示一个潜在的陷阱（尺度模糊性），并展示如何通过归一化来解决它。对于任何参数模型而言，这都是一项基础性的检查。[@problem_id:2878968]", "problem": "考虑一个单输入单输出 (SISO) 输出误差 (OE) 模型，由输入输出关系 $y(t) = G(q^{-1}) u(t) + e(t)$ 定义，其中 $G(q^{-1}) = \\dfrac{B(q^{-1})}{F(q^{-1})}$，$B(q^{-1})$ 和 $F(q^{-1})$ 是后向移位算子 $q^{-1}$ 的实系数多项式，$e(t)$ 是一个加性扰动。如果对于所有容许输入 $u(t)$，不同的参数向量能导出不同的输入输出映射 $G(q^{-1})$，则称该参数化是结构可辨识的。假设 $e(t) = 0$ 以关注确定性映射，并且 $u(t)$ 是任意但良定义的。\n\n仅使用这些定义，证明在没有附加约束的情况下，由于 $B(q^{-1})$ 和 $F(q^{-1})$ 之间的尺度模糊性，OE 参数化可能不是可辨识的。具体来说：\n\n1. 通过取 $B(q^{-1}) = 2 + 0.5\\, q^{-1}$ 和 $F(q^{-1}) = 4 - q^{-1}$ 构造一个反例。证明当 $\\alpha = 3$ 时，缩放后的对 $\\tilde{B}(q^{-1}) = \\alpha B(q^{-1})$ 和 $\\tilde{F}(q^{-1}) = \\alpha F(q^{-1})$ 对所有 $u(t)$ 都能导出相同的输入输出映射 $G(q^{-1})$，从而表明其不可辨识性。\n\n2. 提出一个归一化约束，以消除这种尺度模糊性并恢复可辨识性。您的约束必须表述为对 $F(q^{-1})$ 的一个系数的条件，并且在该系数非零时是良定义的。\n\n3. 将您提出的归一化应用于第1部分中的缩放对 $\\tilde{B}(q^{-1})$ 和 $\\tilde{F}(q^{-1})$，并计算必须应用于 $(\\tilde{B}(q^{-1}), \\tilde{F}(q^{-1}))$ 的唯一归一化因子 $\\alpha_{\\star}$，以使归一化后的 $F(q^{-1})$ 在 $q^{0}$ 项上的系数为单位值。将 $\\alpha_{\\star}$ 报告为单个实数。无需四舍五入。", "solution": "问题陈述经评估有效。它在科学上基于系统辨识的原理，是适定且客观的。它不包含逻辑矛盾、缺失信息或伪科学主张。我们可以继续进行解答。\n\n该问题研究单输入单输出 (SISO) 输出误差 (OE) 模型的结构可辨识性。模型的确定性部分由关系 $y(t) = G(q^{-1}) u(t)$ 给出，其中传递函数是后向移位算子 $q^{-1}$ 的有理函数：\n$$\nG(q^{-1}) = \\frac{B(q^{-1})}{F(q^{-1})}\n$$\n模型的参数是多项式 $B(q^{-1})$ 和 $F(q^{-1})$ 的系数。结构可辨识性要求这些参数的不同向量必须产生不同的传递函数 $G(q^{-1})$。我们将证明，在没有附加约束的情况下，这一要求不成立。\n\n第1部分：用反例证明不可辨识性。\n设第一个参数化由以下多项式定义：\n$$\nB(q^{-1}) = 2 + 0.5\\, q^{-1}\n$$\n$$\nF(q^{-1}) = 4 - q^{-1}\n$$\n相应的传递函数，我们记为 $G_1(q^{-1})$，是：\n$$\nG_1(q^{-1}) = \\frac{B(q^{-1})}{F(q^{-1})} = \\frac{2 + 0.5\\, q^{-1}}{4 - q^{-1}}\n$$\n现在，考虑由一个非零常数 $\\alpha$（给定为 $\\alpha = 3$）对两个多项式进行缩放而得到的第二个参数化。新的多项式 $\\tilde{B}(q^{-1})$ 和 $\\tilde{F}(q^{-1})$ 是：\n$$\n\\tilde{B}(q^{-1}) = \\alpha B(q^{-1}) = 3(2 + 0.5\\, q^{-1}) = 6 + 1.5\\, q^{-1}\n$$\n$$\n\\tilde{F}(q^{-1}) = \\alpha F(q^{-1}) = 3(4 - q^{-1}) = 12 - 3\\, q^{-1}\n$$\n这第二个模型的参数向量包含系数 $\\{6, 1.5, 12, -3\\}$，这明显不同于第一个模型的参数向量，后者包含 $\\{2, 0.5, 4, -1\\}$。\n\n这个第二个参数化的传递函数，记为 $G_2(q^{-1})$，是：\n$$\nG_2(q^{-1}) = \\frac{\\tilde{B}(q^{-1})}{\\tilde{F}(q^{-1})} = \\frac{6 + 1.5\\, q^{-1}}{12 - 3\\, q^{-1}}\n$$\n我们可以从分子和分母中提出缩放常数 $\\alpha = 3$：\n$$\nG_2(q^{-1}) = \\frac{3(2 + 0.5\\, q^{-1})}{3(4 - q^{-1})}\n$$\n由于 $\\alpha=3$ 是一个非零常数，它可以被消去，得到：\n$$\nG_2(q^{-1}) = \\frac{2 + 0.5\\, q^{-1}}{4 - q^{-1}} = G_1(q^{-1})\n$$\n我们已经证明，两个不同的参数向量产生了相同的传递函数，$G_1(q^{-1}) = G_2(q^{-1})$。因此，对于两种参数化，输入输出映射 $y(t) = G(q^{-1})u(t)$ 是相同的。这违反了结构可辨识性的条件。观察到的模糊性是分子和分母多项式都可以乘以一个任意非零常数而不改变它们所定义的有理函数的自由度的直接结果。\n\n第2部分：提出一个归一化约束。\n为了消除第1部分中展示的尺度模糊性，我们必须施加一个约束来固定任意缩放因子 $\\alpha$ 的值。一种常用且有效的方法是对其中一个多项式系数强制赋予一个特定值。设分母多项式以其一般形式写出：\n$$\nF(q^{-1}) = f_0 + f_1 q^{-1} + f_2 q^{-2} + \\dots + f_{n_f} q^{-n_f}\n$$\n尺度模糊性意味着由 $(\\alpha B(q^{-1}), \\alpha F(q^{-1}))$ 定义的模型等价于 $(B(q^{-1}), F(q^{-1}))$ 对于任何 $\\alpha \\neq 0$。为了获得唯一的表示，我们可以选择一个系数并固定其值。对于离散时间系统，标准的选择是归一化分母多项式 $F(q^{-1})$，使其 $q^0$ 项的系数为1。这对应于对 $F(q^{-1})$ 的系数施加以下约束：\n$$\nf_0 = 1\n$$\n只要原始的首项系数 $f_0$ 不为零，这个约束就是良定义的。如果 $f_0$ 为零，可以将 $B(q^{-1})$ 和 $F(q^{-1})$ 同时除以 $q^{-1}$ 的某个幂次，直到新分母的首项系数非零，或者重新评估模型结构。对于一个稳定、因果的系统，通常假设 $f_0 \\neq 0$。这种归一化为对 $(B(q^{-1}), F(q^{-1}))$ 强制了唯一的缩放，从而恢复了关于这种尺度模糊性的结构可辨识性。\n\n第3部分：应用归一化并计算因子 $\\alpha_{\\star}$。\n我们有第1部分中给出的缩放后的多项式：\n$$\n\\tilde{B}(q^{-1}) = 6 + 1.5\\, q^{-1}\n$$\n$$\n\\tilde{F}(q^{-1}) = 12 - 3\\, q^{-1}\n$$\n我们必须找到一个唯一的归一化因子 $\\alpha_{\\star}$，当它应用于这对多项式时，产生一个新的分母多项式 $F_{\\text{norm}}(q^{-1})$，其 $q^0$ 项的系数等于1。\n让归一化多项式定义为：\n$$\nB_{\\text{norm}}(q^{-1}) = \\alpha_{\\star} \\tilde{B}(q^{-1})\n$$\n$$\nF_{\\text{norm}}(q^{-1}) = \\alpha_{\\star} \\tilde{F}(q^{-1})\n$$\n在 $\\tilde{F}(q^{-1})$ 中 $q^0$ 项的系数是 $\\tilde{f}_0 = 12$。应用此缩放，新的分母是：\n$$\nF_{\\text{norm}}(q^{-1}) = \\alpha_{\\star} (12 - 3\\, q^{-1}) = (12 \\alpha_{\\star}) + (-3 \\alpha_{\\star}) q^{-1}\n$$\n根据第2部分提出的归一化约束，$F_{\\text{norm}}(q^{-1})$ 中 $q^0$ 项的系数必须为1。因此，我们建立方程：\n$$\n12 \\alpha_{\\star} = 1\n$$\n求解 $\\alpha_{\\star}$ 得到唯一的归一化因子：\n$$\n\\alpha_{\\star} = \\frac{1}{12}\n$$\n这是必须应用于对 $(\\tilde{B}(q^{-1}), \\tilde{F}(q^{-1}))$ 以满足指定归一化条件的单个实数。", "answer": "$$\n\\boxed{\\frac{1}{12}}\n$$", "id": "2878968"}, {"introduction": "一旦确定模型是可辨识的，下一步就是根据实验数据估计其参数。本练习将演示一种经典的频域方法，展示如何直接从波特图的渐近线行为中提取静态增益和转角频率等关键参数。这个练习搭建了理论传递函数与实际频率响应测量之间的桥梁。[@problem_id:1585873]", "problem": "一位工程师的任务是根据实验数据辨识一个稳定、最小相位的一阶系统。在进行频率响应分析后，该系统波德幅频图的渐近线已被精确表征。\n\n在极低频率下，观测到幅频响应接近一条值为 $15.0$ dB 的恒定水平渐近线。在极高频率下，幅频响应可以很好地用一条斜率为每十倍频 $-20$ dB 的直线渐近线来近似。已知这条高频渐近线在角频率为 $250$ rad/s 时通过幅值为 $-18.5$ dB 的点。\n\n该系统将用形式为 $G(s) = \\frac{K}{\\tau s + 1}$ 的传递函数来建模，其中 $K$ 是静态增益，$\\tau$ 是时间常数。根据所述的渐近线行为，确定静态增益 $K$ 和转折频率 $\\omega_c = 1/\\tau$ 的值。\n\n以一对数值的形式给出静态增益 $K$ 和转折频率 $\\omega_c$ 的答案。静态增益 $K$ 是一个无量纲量。转折频率 $\\omega_c$ 以 rad/s 为单位表示。将两个数值都四舍五入到三位有效数字。", "solution": "对于一阶低通系统 $G(s)=\\dfrac{K}{\\tau s+1}$，其幅值为\n$$\n|G(j\\omega)|=\\frac{K}{\\sqrt{1+(\\tau\\omega)^{2}}},\n$$\n因此以分贝表示的波德幅值为\n$$\nM(\\omega)=20\\log_{10}|G(j\\omega)|=20\\log_{10}K-10\\log_{10}\\!\\big(1+(\\tau\\omega)^{2}\\big).\n$$\n\n低频渐近线：当 $\\omega\\to 0$ 时，$M(\\omega)\\to 20\\log_{10}K$。给定低频值为 $15.0$ dB，\n$$\n20\\log_{10}K=15.0 \\quad\\Rightarrow\\quad \\log_{10}K=\\frac{15.0}{20}=0.75 \\quad\\Rightarrow\\quad K=10^{0.75}.\n$$\n\n高频渐近线：对于 $\\omega\\gg \\omega_{c}$ 且 $\\omega_{c}=\\dfrac{1}{\\tau}$，\n$$\n|G(j\\omega)|\\approx \\frac{K}{\\tau\\,\\omega},\\quad M_{\\text{asymp}}(\\omega)=20\\log_{10}\\!\\left(\\frac{K}{\\tau}\\right)-20\\log_{10}\\omega.\n$$\n给定的渐近线在 $\\omega=250$ rad/s 时通过 $M=-18.5$ dB，因此\n$$\n-18.5=20\\log_{10}\\!\\left(\\frac{K}{\\tau}\\right)-20\\log_{10}(250)\n\\;\\Rightarrow\\;\n20\\log_{10}\\!\\left(\\frac{K}{\\tau}\\right)=-18.5+20\\log_{10}(250).\n$$\n由于渐近线在 $\\omega=\\omega_{c}$ 处相交，且在该点的值均为 $20\\log_{10}K$，\n$$\n20\\log_{10}\\omega_{c}\n=20\\log_{10}\\!\\left(\\frac{K}{\\tau}\\right)-20\\log_{10}K\n=-18.5-20\\log_{10}K+20\\log_{10}(250).\n$$\n代入 $20\\log_{10}K=15.0$ 可得\n$$\n20\\log_{10}\\omega_{c}= -18.5-15.0+20\\log_{10}(250)=14.4588001734,\n$$\n所以\n$$\n\\log_{10}\\omega_{c}=0.72294000867,\\quad \\omega_{c}=10^{0.72294000867}.\n$$\n\n数值四舍五入到三位有效数字：\n$$\nK=10^{0.75}\\approx 5.62,\\qquad \\omega_{c}\\approx 5.28\\ \\text{rad/s}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}5.62  5.28\\end{pmatrix}}$$", "id": "1585873"}, {"introduction": "在许多实际情况中，一个系统的真实复杂度（或阶数）是未知的。本练习将处理模型阶数选择这一关键任务。您将应用贝叶斯信息准则（BIC）来寻找模型拟合数据的准确性与其复杂性之间的最佳平衡点，从而避免过拟合这一常见陷阱。[@problem_id:2878934]", "problem": "给定一个由阶数参数 $p \\in \\{1,2,3,4,5\\}$ 索引的离散时间单输入单输出自回归外源输入（ARX）模型族。对于每个候选阶数 $p$，在长度为 $N=1000$ 的数据记录上进行的辨识实验产生了一个单步预测残差序列，该序列可以很好地被建模为零均值、未知方差的独立同分布高斯噪声。相应的估计残差方差 $\\hat{\\sigma}_{p}^{2}$（计算为残差平方的经验均值）和自由模型参数的数量 $k_{p}$ 如下所列：\n- $p=1$：$\\hat{\\sigma}_{1}^{2} = 1.05$, $k_{1} = 3$。\n- $p=2$：$\\hat{\\sigma}_{2}^{2} = 0.98$, $k_{2} = 5$。\n- $p=3$：$\\hat{\\sigma}_{3}^{2} = 0.94$, $k_{3} = 7$。\n- $p=4$：$\\hat{\\sigma}_{4}^{2} = 0.93$, $k_{4} = 9$。\n- $p=5$：$\\hat{\\sigma}_{5}^{2} = 0.929$, $k_{5} = 11$。\n\n从残差的高斯似然以及贝叶斯信息准则（BIC）作为模型证据的负二倍对数的大样本近似（带有与自由参数数量和样本大小的对数成正比的复杂度惩罚项）的定义出发，推导出一个仅依赖于 $N$、$\\hat{\\sigma}_{p}^{2}$ 和 $k_{p}$ 并且足以比较这些模型的选择分数。然后，使用该分数，为每个 $p \\in \\{1,2,3,4,5\\}$ 计算其值，并确定应选择的阶数 $p^{\\star}$。\n\n只需报告使分数最小化的阶数索引 $p^{\\star}$ 作为你的最终答案。无需舍入说明，因为 $p^{\\star}$ 是一个整数。", "solution": "问题要求使用贝叶斯信息准则（BIC）从一组候选ARX模型中选择最优模型阶数 $p$。第一步是按照要求从第一性原理推导BIC分数。\n\n令阶数为 $p$ 的模型的单步预测误差，或称残差，由序列 $\\{\\epsilon_p(t)\\}_{t=1}^{N}$ 表示。问题陈述这些残差可以很好地被建模为均值为零、方差为 $\\sigma_p^2$ 的独立同分布（i.i.d.）高斯随机变量。单个残差 $\\epsilon_p(t)$ 的概率密度函数（PDF）由下式给出：\n$$ f(\\epsilon_p(t) | \\sigma_p^2) = \\frac{1}{\\sqrt{2\\pi\\sigma_p^2}} \\exp\\left(-\\frac{\\epsilon_p(t)^2}{2\\sigma_p^2}\\right) $$\n给定长度为 $N$ 的数据记录，阶数为 $p$ 的模型的似然函数 $L_p$ 是观测到整个残差序列的联合概率。根据独立同分布的假设，这是各个PDF的乘积：\n$$ L_p(\\{\\epsilon_p(t)\\} | \\sigma_p^2) = \\prod_{t=1}^{N} \\frac{1}{\\sqrt{2\\pi\\sigma_p^2}} \\exp\\left(-\\frac{\\epsilon_p(t)^2}{2\\sigma_p^2}\\right) $$\n使用对数似然函数 $\\ln L_p$ 更为方便：\n$$ \\ln L_p = \\sum_{t=1}^{N} \\ln\\left[ \\frac{1}{\\sqrt{2\\pi\\sigma_p^2}} \\exp\\left(-\\frac{\\epsilon_p(t)^2}{2\\sigma_p^2}\\right) \\right] = \\sum_{t=1}^{N} \\left[ -\\frac{1}{2}\\ln(2\\pi\\sigma_p^2) - \\frac{\\epsilon_p(t)^2}{2\\sigma_p^2} \\right] $$\n$$ \\ln L_p = -\\frac{N}{2}\\ln(2\\pi\\sigma_p^2) - \\frac{1}{2\\sigma_p^2}\\sum_{t=1}^{N} \\epsilon_p(t)^2 $$\n问题提供了估计的残差方差 $\\hat{\\sigma}_p^2$，其计算方式为残差平方的经验均值。这对应于方差的最大似然估计（MLE），通过将对数似然函数关于 $\\sigma_p^2$ 的导数设为零得到。因此，残差平方和为 $\\sum_{t=1}^{N} \\epsilon_p(t)^2 = N\\hat{\\sigma}_p^2$。\n\n为了求BIC，我们需要对数似然函数的最大化值 $\\ln L_{max, p}$。这通过将MLE $\\hat{\\sigma}_p^2$ 代入对数似然表达式得到：\n$$ \\ln L_{max, p} = -\\frac{N}{2}\\ln(2\\pi\\hat{\\sigma}_p^2) - \\frac{1}{2\\hat{\\sigma}_p^2}(N\\hat{\\sigma}_p^2) = -\\frac{N}{2}\\ln(2\\pi\\hat{\\sigma}_p^2) - \\frac{N}{2} $$\n$$ \\ln L_{max, p} = -\\frac{N}{2} \\left[ \\ln(\\hat{\\sigma}_p^2) + \\ln(2\\pi) + 1 \\right] $$\n贝叶斯信息准则（BIC）通常定义为：\n$$ \\text{BIC}_p = -2 \\ln L_{max, p} + k_p \\ln(N) $$\n其中 $k_p$ 是阶数为 $p$ 的模型中的自由参数数量，而 $N$ 是样本大小。代入我们关于 $\\ln L_{max, p}$ 的表达式：\n$$ \\text{BIC}_p = -2 \\left( -\\frac{N}{2} \\left[ \\ln(\\hat{\\sigma}_p^2) + \\ln(2\\pi) + 1 \\right] \\right) + k_p \\ln(N) $$\n$$ \\text{BIC}_p = N \\left[ \\ln(\\hat{\\sigma}_p^2) + \\ln(2\\pi) + 1 \\right] + k_p \\ln(N) $$\n$$ \\text{BIC}_p = N \\ln(\\hat{\\sigma}_p^2) + k_p \\ln(N) + N(\\ln(2\\pi) + 1) $$\n目标是选择使 $\\text{BIC}_p$ 最小化的模型阶数 $p$。当比较不同阶数 $p$ 的BIC值时，任何对所有模型都为常数的项都可以舍去。项 $N(\\ln(2\\pi) + 1)$ 就是这样一个常数。因此，用于比较这些模型的一个充分的选择分数 $S_p$ 是：\n$$ S_p = N \\ln(\\hat{\\sigma}_p^2) + k_p \\ln(N) $$\n该表达式如要求的那样，仅依赖于给定的量 $N$、$\\hat{\\sigma}_p^2$ 和 $k_p$。我们现在使用给定的数据 $N=1000$ 为每个候选阶数 $p \\in \\{1, 2, 3, 4, 5\\}$ 计算这个分数。样本大小的自然对数是 $\\ln(1000) \\approx 6.907755$。\n\n对于 $p=1$：$k_1=3$，$\\hat{\\sigma}_1^2=1.05$。\n$S_1 = 1000 \\ln(1.05) + 3 \\ln(1000) \\approx 1000(0.048790) + 3(6.907755) \\approx 48.790 + 20.723 = 69.513$\n\n对于 $p=2$：$k_2=5$，$\\hat{\\sigma}_2^2=0.98$。\n$S_2 = 1000 \\ln(0.98) + 5 \\ln(1000) \\approx 1000(-0.020203) + 5(6.907755) \\approx -20.203 + 34.539 = 14.336$\n\n对于 $p=3$：$k_3=7$，$\\hat{\\sigma}_3^2=0.94$。\n$S_3 = 1000 \\ln(0.94) + 7 \\ln(1000) \\approx 1000(-0.061875) + 7(6.907755) \\approx -61.875 + 48.354 = -13.521$\n\n对于 $p=4$：$k_4=9$，$\\hat{\\sigma}_4^2=0.93$。\n$S_4 = 1000 \\ln(0.93) + 9 \\ln(1000) \\approx 1000(-0.072571) + 9(6.907755) \\approx -72.571 + 62.170 = -10.401$\n\n对于 $p=5$：$k_5=11$，$\\hat{\\sigma}_5^2=0.929$。\n$S_5 = 1000 \\ln(0.929) + 11 \\ln(1000) \\approx 1000(-0.073651) + 11(6.907755) \\approx -73.651 + 75.985 = 2.334$\n\n比较计算出的分数：\n$S_1 \\approx 69.513$\n$S_2 \\approx 14.336$\n$S_3 \\approx -13.521$\n$S_4 \\approx -10.401$\n$S_5 \\approx 2.334$\n\n在 $p=3$ 时达到最小分数。这表明，根据贝叶斯信息准则，阶数为3的模型在拟合优度（低残差方差）和模型复杂度（低参数数量）之间提供了最佳的权衡。因此，所选的模型阶数为 $p^{\\star}=3$。", "answer": "$$\\boxed{3}$$", "id": "2878934"}]}