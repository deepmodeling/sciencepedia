{"hands_on_practices": [{"introduction": "在拟合时间序列模型后，首要的验证步骤是检查残差是否表现为白噪声。Ljung-Box检验是实现此目的的基本工具，它通过检查多个滞后项的总体自相关性来进行综合判断。本练习的核心不仅在于应用该检验，更在于理解一个关键的理论细节：模型参数的估计过程会如何影响检验统计量的自由度，掌握这一点是正确应用此检验的关键。[@problem_id:2885037]", "problem": "一个离散时间、宽义平稳的随机过程在线性时间序列框架中建模，并由一个自回归移动平均 (ARMA) 模型拟合。您使用标准最大似然技术，对一个长度为 $N=500$ 的标量时间序列估计了一个阶数为 $(2,1)$ 的自回归移动平均 (ARMA) 模型。令 $\\{e_t\\}_{t=1}^{N}$ 表示由此产生的单步预测残差。为了评估残差的白噪声性，您计划使用基于滞后阶数最高为 $m=20$ 的自相关的 Ljung–Box (LB) 联合检验统计量 $Q_{\\mathrm{LB}}(m)$。\n\n从关于残差白噪声性的第一性原理以及在原假设（即 $\\{e_t\\}$ 是均值为零、方差有限的独立同分布 (i.i.d.) 序列）下样本自相关的大样本行为出发，并利用一个经过充分检验的渐近事实——即在没有估计动态参数时，$m$ 个经过适当缩放的平方残差自相关之和近似服从自由度为 $m$ 的卡方分布——推导出当从相同数据估计 ARMA$(2,1)$ 模型时，$Q_{\\mathrm{LB}}(m)$ 的参考卡方分布应使用的适当自由度。\n\n然后，使用此参考分布，以卡方分布的上分位数为基础，陈述一个在显著性水平 $\\alpha=0.05$ 下检验残差是独立同分布（即白噪声）的原假设的决策规则。请勿计算任何数值分位数。\n\n报告自由度作为您的最终答案。无需四舍五入，最终答案中不应包含任何单位。", "solution": "该问题要求推导 Ljung-Box 检验应用于已估计的自回归移动平均 (ARMA) 模型残差时的自由度。推导必须从第一性原理出发。\n\n设观测到的时间序列为 $\\{y_t\\}$。我们拟合了一个阶数为 $(p,q)$ 的 ARMA 模型，其定义如下：\n$$ y_t - \\sum_{i=1}^p \\phi_i y_{t-i} = \\epsilon_t + \\sum_{j=1}^q \\theta_j \\epsilon_{t-j} $$\n其中，$\\{\\epsilon_t\\}$ 被假设为一个均值为零、恒定方差为 $\\sigma^2$ 的白噪声过程。白噪声过程是一系列独立同分布 (i.i.d.) 的随机变量。在本问题中，模型阶数指定为 ARMA($2,1$)，因此我们有 $p=2$ 和 $q=1$。\n\n问题要求从真实白噪声过程的样本自相关的渐近行为开始。如果我们有一个来自白噪声过程 $\\{\\epsilon_t\\}$ 的 $N$ 个观测值的序列，对于较大的 $N$，滞后阶为 $k$ 的样本自相关（表示为 $\\hat{\\rho}_k$）近似服从均值为 $0$、方差为 $1/N$ 的正态分布。此外，不同滞后阶的样本自相关近似独立。\n$$ \\hat{\\rho}_k \\stackrel{\\text{approx}}{\\sim} N(0, 1/N) \\quad \\text{for } k>0 $$\n由此可知，量 $N\\hat{\\rho}_k^2$ 近似服从自由度为 $1$ 的卡方分布，即 $\\chi^2(1)$。$m$ 个这样的独立量的总和，即被称为 Box-Pierce 统计量的检验统计量，由 $Q_{\\mathrm{BP}}(m) = N \\sum_{k=1}^m \\hat{\\rho}_k^2$ 给出。该统计量渐近服从自由度为 $m$ 的卡方分布，即 $\\chi^2(m)$。\n\nLjung-Box 统计量 $Q_{\\mathrm{LB}}(m)$ 是对 Box-Pierce 统计量的修正，它在有限样本中提供了更好的近似：\n$$ Q_{\\mathrm{LB}}(m) = N(N+2) \\sum_{k=1}^m \\frac{\\hat{\\rho}_k^2}{N-k} $$\n在序列是白噪声的原假设下，当 $N \\to \\infty$ 时，$Q_{\\mathrm{LB}}(m)$ 也收敛于一个 $\\chi^2(m)$ 分布。这是未从数据中估计任何模型参数的基准情况。\n\n然而，本问题关注的是在估计了 ARMA($2,1$) 模型参数后得到的残差 $\\{e_t\\}$。这些参数是 $p=2$ 个自回归系数 $\\{\\phi_1, \\phi_2\\}$ 和 $q=1$ 个移动平均系数 $\\{\\theta_1\\}$。估计的动态参数总数为 $p+q$。设估计值为 $\\{\\hat{\\phi}_1, \\hat{\\phi}_2\\}$ 和 $\\{\\hat{\\theta}_1\\}$。残差计算如下：\n$$ e_t = y_t - \\hat{\\phi}_1 y_{t-1} - \\hat{\\phi}_2 y_{t-2} - \\hat{\\theta}_1 e_{t-1} $$\n估计过程（如最大似然法）旨在找到使残差 $\\{e_t\\}$ 的行为尽可能接近白噪声序列的参数值。这个过程对残差施加了约束。本质上，估计过程迫使残差平方和最小化，这反过来又减小了残差样本自相关（我们用 $\\hat{r}_k$ 表示）的大小。这种效应在小滞后阶上最为显著。\n\n由于 $p+q$ 个参数的估计引入了依赖性和约束，所得到的残差自相关 $\\{\\hat{r}_k\\}_{k=1}^m$ 不再是渐近独立的。由 Box and Pierce (1970) 发展的理论表明，估计 $p+q$ 个参数会使卡方分布的自由度减少 $p+q$。每个估计的参数可以被看作“解释”了数据相关性结构中的一个自由度，从而为检验统计量留下了更少的自由度。\n\n因此，当对一个正确设定的 ARMA($p,q$) 模型的残差计算 Ljung-Box 统计量时，其渐近分布不是 $\\chi^2(m)$，而是一个卡方分布，其自由度 ($df$) 由以下公式给出：\n$$ df = m - (p+q) $$\n这一结果成立的条件是，滞后阶数 $m$ 相对于 $p$ 和 $q$ 足够大。\n\n对于给定的具体问题：\n- 模型是 ARMA($2,1$)，所以 $p=2$ 且 $q=1$。\n- 估计的参数数量为 $p+q = 2+1 = 3$。\n- Ljung-Box 检验的滞后阶数最高为 $m=20$。\n\n将这些值代入自由度公式：\n$$ df = 20 - (2+1) = 20 - 3 = 17 $$\n因此，检验统计量 $Q_{\\mathrm{LB}}(20)$ 的参考分布是自由度为 17 的卡方分布。\n\n该问题还要求在显著性水平 $\\alpha=0.05$ 下，为检验原假设 $H_0$（即残差是独立同分布的白噪声）陈述一个决策规则。备择假设 $H_1$ 是残差不是白噪声，这意味着存在序列相关性。$Q_{\\mathrm{LB}}(m)$ 统计量的高值表明存在显著的自相关，为反对 $H_0$ 提供了证据。因此，采用单边上尾检验是合适的。\n\n决策规则是：如果计算出的检验统计量 $Q_{\\mathrm{LB}}(20)$ 大于来自 $\\chi^2(17)$ 分布的临界值，则拒绝 $H_0$。临界值是该分布的上 $(1-\\alpha)$ 分位数，记为 $\\chi^2_{1-\\alpha, df}$。\n当 $\\alpha=0.05$ 且 $df=17$ 时，决策规则正式陈述为：\n如果 $Q_{\\mathrm{LB}}(20)  \\chi^2_{0.95, 17}$，则拒绝 $H_0$。\n如果计算出的统计量没有超过这个值，我们就不拒绝原假设，并且认为该模型在残差白噪声性方面是充分的。最终答案是所推导出的自由度。", "answer": "$$\n\\boxed{17}\n$$", "id": "2885037"}, {"introduction": "如果Ljung-Box检验表明残差并非白噪声，那么下一步就是诊断问题所在。一个常见的原因是“欠拟合”，即模型过于简单，未能捕捉到数据中潜在的动态结构。本练习将引导你完成一个强大的诊断流程：通过计算残差的偏自相关函数(PACF)，你可以揭示残余相关的结构，并确定模型所遗漏的自回归部分的阶数。[@problem_id:2884970]", "problem": "一个离散时间、零均值、二阶平稳的残差过程 $\\{e_t\\}$ 是通过对一个稳定线性时不变系统的输入输出数据进行模型拟合得到的。假设拟合的模型参数不足，导致残差中保留了线性相关性，该相关性可以由一个未知阶数 $m$ 的有限阶自回归（AR）过程表示。考虑从 $e_t$ 的 $m$ 个最近的过去值对其进行的一步线性最小均方误差（MMSE）预测，即 $\\hat{e}_t = \\sum_{k=1}^{m} a_k e_{t-k}$，并将预测误差表示为 $\\varepsilon_t = e_t - \\hat{e}_t$。\n\n1) 从 MMSE 预测的正交性原理出发，即 $\\varepsilon_t$ 与过去的回归量 $\\{e_{t-i}\\}_{i=1}^{m}$ 正交，推导联系自协方差函数 $\\gamma(i) = \\mathbb{E}[e_t e_{t-i}]$ 与 AR 系数 $\\{a_k\\}_{k=1}^{m}$ 的正规方程。将结果表示为关于 $\\mathbf{a} = [a_1,\\dots,a_m]^{\\top}$ 的托普利兹（Toeplitz）线性系统形式，并用 $\\{\\gamma(k)\\}_{k=0}^{m}$ 和 $\\{a_k\\}_{k=1}^{m}$ 表示残差新息方差 $\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t^2]$。\n\n2) 现在使用这些方程进行残差分析和模型验证。给定 $N = 400$ 个残差样本，其（有偏）样本自协方差为\n$$\\hat{\\gamma}(0) = 1.0000,\\quad \\hat{\\gamma}(1) = 0.5000,\\quad \\hat{\\gamma}(2) = 0.1000,\\quad \\hat{\\gamma}(3) = -0.0400,\\quad \\hat{\\gamma}(4) = -0.0440.$$\n计算 $k=1,2,3,4$ 时的样本自相关系数 $\\hat{r}(k) = \\hat{\\gamma}(k)/\\hat{\\gamma}(0)$。使用您推导的方程所蕴含的 Durbin–Levinson 递推算法，计算前四个样本偏自相关系数（偏自相关函数，PACF）$\\{\\hat{\\alpha}(k)\\}_{k=1}^{4}$。\n\n3) 在大样本近似下，对于一个真实阶数为 $m$ 的自回归过程，当 $km$ 时 $\\hat{\\alpha}(k)$ 的抽样分布近似为均值为 $0$、标准差为 $1/\\sqrt{N}$ 的正态分布。使用双边显著性水平 $0.05$（即，将 $|\\hat{\\alpha}(k)|$ 与阈值 $1.96/\\sqrt{N}$ 进行比较），选择最小的阶数 $m$，使得所有超过 $m$ 且不高于 4 的滞后阶数在统计上都不显著。将此 $m$ 解释为因欠拟合而缺失的估计阶数。\n\n仅报告该估计的缺失階数，以单个整数形式。无需单位。", "solution": "所提出的问题是时间序列分析应用于模型验证的一个标准练习。它在科学上是合理的，问题提法清晰，并包含了所有必要的信息。我将着手解决它。\n\n第1部分：正规方程和新息方差的推导\n\n平稳过程 $\\{e_t\\}$ 的一步线性最小均方误差（MMSE）预测器由 $\\hat{e}_t = \\sum_{k=1}^{m} a_k e_{t-k}$ 给出。预测误差为 $\\varepsilon_t = e_t - \\hat{e}_t$。正交性原理规定，对于MMSE预测器，误差向量与观测子空间正交。这意味着误差与任何回归量乘积的期望为零：\n$$\n\\mathbb{E}[\\varepsilon_t e_{t-i}] = 0 \\quad \\text{for } i \\in \\{1, 2, \\dots, m\\}\n$$\n代入 $\\varepsilon_t$ 的表达式：\n$$\n\\mathbb{E}\\left[\\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right) e_{t-i}\\right] = 0\n$$\n根据期望算子的线性性质：\n$$\n\\mathbb{E}[e_t e_{t-i}] - \\sum_{k=1}^{m} a_k \\mathbb{E}[e_{t-k} e_{t-i}] = 0\n$$\n设过程的自协方差函数为 $\\gamma(j) = \\mathbb{E}[e_t e_{t-j}]$。对于平稳过程，$\\mathbb{E}[e_{t-k} e_{t-i}] = \\gamma((t-i)-(t-k)) = \\gamma(k-i)$。方程变为：\n$$\n\\gamma(i) - \\sum_{k=1}^{m} a_k \\gamma(k-i) = 0 \\quad \\text{for } i \\in \\{1, 2, \\dots, m\\}\n$$\n由于平穩性，$\\gamma(j) = \\gamma(-j)$，因此我们可以写成 $\\gamma(k-i) = \\gamma(i-k)$。这就得到了 Yule-Walker 方程：\n$$\n\\sum_{k=1}^{m} a_k \\gamma(i-k) = \\gamma(i)\n$$\n这是一个关于 $m$ 个未知系数 $\\{a_k\\}_{k=1}^{m}$ 的 $m$ 个线性方程组。以矩阵形式表示，这是一个托普利兹（Toeplitz）系统 $\\boldsymbol{\\Gamma}_m \\mathbf{a} = \\boldsymbol{\\gamma}_m$，其中 $\\mathbf{a} = [a_1, \\dots, a_m]^\\top$，$\\boldsymbol{\\gamma}_m = [\\gamma(1), \\dots, \\gamma(m)]^\\top$，且 $\\boldsymbol{\\Gamma}_m$ 是一个 $m \\times m$ 对称托普利兹自协方差矩阵，其元素为 $(\\boldsymbol{\\Gamma}_m)_{ij} = \\gamma(i-j)$:\n$$\n\\begin{pmatrix}\n\\gamma(0)  \\gamma(1)  \\cdots  \\gamma(m-1) \\\\\n\\gamma(1)  \\gamma(0)  \\cdots  \\gamma(m-2) \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n\\gamma(m-1)  \\gamma(m-2)  \\cdots  \\gamma(0)\n\\end{pmatrix}\n\\begin{pmatrix}\na_1 \\\\\na_2 \\\\\n\\vdots \\\\\na_m\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\gamma(1) \\\\\n\\gamma(2) \\\\\n\\vdots \\\\\n\\gamma(m)\n\\end{pmatrix}\n$$\n接下来，推导残差新息方差 $\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t^2]$。\n$$\n\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t \\cdot \\varepsilon_t] = \\mathbb{E}\\left[\\varepsilon_t \\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right)\\right] = \\mathbb{E}[\\varepsilon_t e_t] - \\sum_{k=1}^{m} a_k \\mathbb{E}[\\varepsilon_t e_{t-k}]\n$$\n根据正交性原理，第二项为零。因此：\n$$\n\\sigma_{\\varepsilon}^{2} = \\mathbb{E}[\\varepsilon_t e_t] = \\mathbb{E}\\left[\\left(e_t - \\sum_{k=1}^{m} a_k e_{t-k}\\right) e_t\\right] = \\mathbb{E}[e_t^2] - \\sum_{k=1}^{m} a_k \\mathbb{E}[e_{t-k} e_t]\n$$\n这给出了新息方差的最终表达式：\n$$\n\\sigma_{\\varepsilon}^{2} = \\gamma(0) - \\sum_{k=1}^{m} a_k \\gamma(k)\n$$\n\n第2部分：样本自相关和偏自相关的计算\n\n给定样本自协方差：$\\hat{\\gamma}(0) = 1.0000$，$\\hat{\\gamma}(1) = 0.5000$，$\\hat{\\gamma}(2) = 0.1000$，$\\hat{\\gamma}(3) = -0.0400$，$\\hat{\\gamma}(4) = -0.0440$。\n样本自相关系数 $\\hat{r}(k) = \\hat{\\gamma}(k)/\\hat{\\gamma}(0)$ 为：\n$$\n\\hat{r}(1) = \\frac{0.5000}{1.0000} = 0.5, \\quad \\hat{r}(2) = \\frac{0.1000}{1.0000} = 0.1, \\quad \\hat{r}(3) = \\frac{-0.0400}{1.0000} = -0.04, \\quad \\hat{r}(4) = \\frac{-0.0440}{1.0000} = -0.044\n$$\n样本偏自相关函数（PACF）$\\{\\hat{\\alpha}(k)\\}$ 使用 Durbin-Levinson 递推算法计算。系数 $\\hat{\\alpha}(p)$ 是一个 $p$ 阶模型中的最后一个 AR 系数 $\\hat{a}_{p,p}$。\n以预测误差方差 $\\hat{v}_0 = \\hat{\\gamma}(0) = 1.0$ 进行初始化。\n\n对于阶数 $p=1$：\n$$\n\\hat{\\alpha}(1) = \\hat{a}_{1,1} = \\hat{r}(1) = 0.5\n$$\n$$\n\\hat{v}_1 = \\hat{v}_0(1 - \\hat{\\alpha}(1)^2) = 1.0(1 - 0.5^2) = 0.75\n$$\n\n对于阶数 $p=2$：\n$$\n\\hat{\\alpha}(2) = \\hat{a}_{2,2} = \\frac{\\hat{\\gamma}(2) - \\hat{a}_{1,1} \\hat{\\gamma}(1)}{\\hat{v}_1} = \\frac{0.1 - (0.5)(0.5)}{0.75} = \\frac{-0.15}{0.75} = -0.2\n$$\nAR(2) 系数为 $\\hat{a}_{2,1} = \\hat{a}_{1,1} - \\hat{\\alpha}(2)\\hat{a}_{1,1} = 0.5 - (-0.2)(0.5) = 0.6$ 和 $\\hat{a}_{2,2} = -0.2$。\n方差为 $\\hat{v}_2 = \\hat{v}_1(1 - \\hat{\\alpha}(2)^2) = 0.75(1 - (-0.2)^2) = 0.75(0.96) = 0.72$。\n\n对于阶数 $p=3$：\nAR(2) 模型的系数为 $\\{\\hat{a}_{2,1}, \\hat{a}_{2,2}\\} = \\{0.6, -0.2\\}$。\n$$\n\\hat{\\alpha}(3) = \\hat{a}_{3,3} = \\frac{\\hat{\\gamma}(3) - (\\hat{a}_{2,1}\\hat{\\gamma}(2) + \\hat{a}_{2,2}\\hat{\\gamma}(1))}{\\hat{v}_2} = \\frac{-0.04 - (0.6(0.1) + (-0.2)(0.5))}{0.72} = \\frac{-0.04 - (0.06 - 0.1)}{0.72} = \\frac{0}{0.72} = 0\n$$\n\n对于阶数 $p=4$：\n由于 $\\hat{\\alpha}(3)=0$，AR(3) 系数为 $\\{\\hat{a}_{3,1}, \\hat{a}_{3,2}, \\hat{a}_{3,3}\\} = \\{0.6, -0.2, 0\\}$ 且 $\\hat{v}_3 = \\hat{v}_2(1 - 0^2) = 0.72$。\n$$\n\\hat{\\alpha}(4) = \\hat{a}_{4,4} = \\frac{\\hat{\\gamma}(4) - (\\hat{a}_{3,1}\\hat{\\gamma}(3) + \\hat{a}_{3,2}\\hat{\\gamma}(2) + \\hat{a}_{3,3}\\hat{\\gamma}(1))}{\\hat{v}_3} = \\frac{-0.044 - (0.6(-0.04) + (-0.2)(0.1) + 0(0.5))}{0.72} = \\frac{-0.044 - (-0.024 - 0.02)}{0.72} = \\frac{0}{0.72} = 0\n$$\n计算得出的滞后阶数最高到 4 的样本 PACF 值为 $\\{\\hat{\\alpha}(1), \\hat{\\alpha}(2), \\hat{\\alpha}(3), \\hat{\\alpha}(4)\\} = \\{0.5, -0.2, 0, 0\\}$。\n\n第3部分：模型阶数选择\n\n我们对滞后阶数 $k=1, 2, 3, 4$ 检验原假设 $H_0: \\alpha(k) = 0$。对于一个真实阶数为 $m$ 的 AR 过程，当 $km$ 时，样本 PACF 系数 $\\hat{\\alpha}(k)$ 近似服从均值为 $0$、方差为 $1/N$ 的正态分布。当 $N=400$ 时，标准差为 $1/\\sqrt{400} = 0.05$。\n对于 $0.05$ 的显著性水平，临界值为 $z_{0.025} \\approx 1.96$。统计显著性的阈值为 $1.96/\\sqrt{N} = 1.96 \\times 0.05 = 0.098$。\n我们将每个样本 PACF 系数的绝对值与此阈值进行比较：\n- 对于 $k=1$：$|\\hat{\\alpha}(1)| = |0.5| = 0.5$。由于 $0.5  0.098$，该系数在统计上是显著的。阶数 $m$ 至少为 $1$。\n- 对于 $k=2$：$|\\hat{\\alpha}(2)| = |-0.2| = 0.2$。由于 $0.2  0.098$，该系数在统计上是显著的。阶数 $m$ 至少为 $2$。\n- 对于 $k=3$：$|\\hat{\\alpha}(3)| = |0| = 0$。由于 $0  0.098$，该系数在统计上不显著。\n- 对于 $k=4$：$|\\hat{\\alpha}(4)| = |0| = 0$。由于 $0  0.098$，该系数在统计上不显著。\n\nPACF 据说在最后一个显著的滞后阶数后“截尾”。在本例中，最后一个显著的滞后阶数是 $k=2$。所有后续测试的滞后阶数（直到 4）在统计上都是不显著的。这种行为是 2 阶自回归过程的特征。因此，因欠拟合而缺失的估计阶数为 $m=2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2884970"}, {"introduction": "除了欠拟合，ARIMA建模中的另一个常见陷阱是“过度差分”，它会向残差中引入人为的动态结构。这种错误操作会使残差不再是白噪声，从而降低模型的预测能力。本练习从第一性原理出发，探讨过度差分在残差中留下的特征“指纹”，通过推导其在时域和频域中的理论性质，您将学会如何识别并纠正这一普遍的建模错误。[@problem_id:2885077]", "problem": "一位工程师正在为一个标量离散时间过程验证一个时间序列模型。真实的数据生成机制是一个阶数为 $(0,1,0)$ 的自回归积分移动平均（ARIMA）过程，由基本差分方程 $(1 - B) x_t = w_t$ 定义，其中 $B$ 是滞后算子，$w_t$ 是一个均值为零、方差为 $\\sigma^{2}$ 的白噪声过程。该工程师在不知道真实差分阶数的情况下，拟合了一个不含确定性常数项的 ARIMA$(0,2,0)$ 模型，并计算了残差 $\\hat{e}_t$，其等于二次差分后的序列 $\\hat{e}_t = (1 - B)^{2} x_t$。\n\n从差分算子、白噪声、线性时不变滤波以及自协方差与功率谱密度之间的 Wiener–Khinchin 关系的基本定义出发，推导在这种过度差分设定下所隐含的预期残差过程。具体而言：\n- 用 $w_t$ 表示 $\\hat{e}_t$，并确定相应的线性滤波器。\n- 用 $\\sigma^{2}$ 推导残差 $\\hat{e}_t$ 的自协方差函数 $\\gamma_{\\hat{e}}(k)$ 和功率谱密度 $S_{\\hat{e}}(\\omega)$ 的闭式表达式。\n- 解释在时域和频域中的预期残差模式，并提出能够检测过度差分的严谨诊断方法，包括在过度差分情况下，滞后1阶的残差自相关以及频谱在零频率附近的行为预计会如何表现。\n\n将残差功率谱密度 $S_{\\hat{e}}(\\omega)$ 作为 $\\omega \\in [-\\pi,\\pi]$ 和 $\\sigma^{2}$ 的函数的闭式表达式作为最终答案。无需四舍五入，最终答案中不应包含任何单位。", "solution": "对问题陈述进行验证。\n\n提取的已知条件如下：\n- 真实数据生成过程：阶数为 $(0,1,0)$ 的自回归积分移动平均（ARIMA）过程。\n- 真实过程的差分方程：$(1 - B) x_t = w_t$。\n- $B$ 是滞后算子，满足 $B x_t = x_{t-1}$。\n- $w_t$ 是一个均值为零、方差为 $\\sigma^{2}$ 的白噪声过程，因此 $E[w_t] = 0$，$E[w_t^2] = \\sigma^2$，且当 $t \\neq s$ 时 $E[w_t w_s] = 0$。\n- 拟合模型为不含常数项的 ARIMA$(0,2,0)$。\n- 计算出的残差为 $\\hat{e}_t = (1 - B)^{2} x_t$。\n- 任务是推导残差过程 $\\hat{e}_t$ 的性质，包括其以 $w_t$ 表示的表达式、其自协方差函数 $\\gamma_{\\hat{e}}(k)$、其功率谱密度 $S_{\\hat{e}}(\\omega)$，以及相应的过度差分诊断检验。\n- 要求的最终答案是 $S_{\\hat{e}}(\\omega)$ 的闭式表达式。\n\n验证结论：\n该问题是有效的。它在科学上基于公认的随机过程和时间序列分析理论。所描述的情景——对一个积分过程进行过度差分——是模型识别中的一个标准且重要的课题。该问题提法明确、客观、自洽，为得出唯一且有意义的解提供了所有必要信息。它要求对基本原理进行严谨的应用。\n\n解题推导：\n\n首先，我们用底层的白噪声过程 $w_t$ 来表示残差过程 $\\hat{e}_t$。\n残差的定义为：\n$$\n\\hat{e}_t = (1 - B)^{2} x_t\n$$\n我们可以通过对算子进行因式分解来重写此表达式：\n$$\n\\hat{e}_t = (1 - B) \\left[ (1 - B) x_t \\right]\n$$\n真实的数据生成过程由方程 $(1 - B) x_t = w_t$ 给出。将此代入 $\\hat{e}_t$ 的表达式中，我们得到：\n$$\n\\hat{e}_t = (1 - B) w_t\n$$\n展开此表达式得到残差过程的显式形式：\n$$\n\\hat{e}_t = w_t - w_{t-1}\n$$\n这表明残差过程 $\\hat{e}_t$ 不是白噪声。相反，它是一个1阶移动平均过程，即 MA(1) 过程。将输入白噪声 $w_t$ 转换为输出残差 $\\hat{e}_t$ 的线性时不变滤波器由滞后算子多项式 $H(B) = 1 - B$ 表示。\n\n第二，我们推导残差过程 $\\hat{e}_t$ 的自协方差函数 $\\gamma_{\\hat{e}}(k)$。滞后 $k$ 阶的自协方差定义为 $\\gamma_{\\hat{e}}(k) = E[\\hat{e}_t \\hat{e}_{t-k}]$。我们使用表达式 $\\hat{e}_t = w_t - w_{t-1}$。\n\n对于滞后 $k=0$，我们计算方差：\n$$\n\\gamma_{\\hat{e}}(0) = E[\\hat{e}_t^2] = E[(w_t - w_{t-1})^2] = E[w_t^2 - 2w_t w_{t-1} + w_{t-1}^2]\n$$\n根据期望的线性性质以及白噪声的性质（$E[w_t^2] = \\sigma^2$ 且当 $t \\neq s$ 时 $E[w_t w_s] = 0$）：\n$$\n\\gamma_{\\hat{e}}(0) = E[w_t^2] - 2E[w_t w_{t-1}] + E[w_{t-1}^2] = \\sigma^2 - 2(0) + \\sigma^2 = 2\\sigma^2\n$$\n\n对于滞后 $k=1$：\n$$\n\\gamma_{\\hat{e}}(1) = E[\\hat{e}_t \\hat{e}_{t-1}] = E[(w_t - w_{t-1})(w_{t-1} - w_{t-2})] = E[w_t w_{t-1} - w_t w_{t-2} - w_{t-1}^2 + w_{t-1} w_{t-2}]\n$$\n再次应用白噪声的性质：\n$$\n\\gamma_{\\hat{e}}(1) = E[w_t w_{t-1}] - E[w_t w_{t-2}] - E[w_{t-1}^2] + E[w_{t-1} w_{t-2}] = 0 - 0 - \\sigma^2 + 0 = -\\sigma^2\n$$\n由于自协方差函数的对称性，$\\gamma_{\\hat{e}}(-1) = \\gamma_{\\hat{e}}(1) = -\\sigma^2$。\n\n对于滞后 $|k| \\geq 2$：\n$$\n\\gamma_{\\hat{e}}(k) = E[\\hat{e}_t \\hat{e}_{t-k}] = E[(w_t - w_{t-1})(w_{t-k} - w_{t-k-1})]\n$$\n对于 $|k| \\geq 2$，第一个因子中的白噪声项的下标（$t$, $t-1$）与第二个因子中的下标（$t-k$, $t-k-1$）是不同的。因此，任何交叉乘积的期望均为零。\n$$\n\\gamma_{\\hat{e}}(k) = 0 \\quad \\text{for } |k| \\geq 2\n$$\n总而言之，残差过程的自协方差函数是：\n$$\n\\gamma_{\\hat{e}}(k) =\n\\begin{cases}\n2\\sigma^2  k=0 \\\\\n-\\sigma^2  |k|=1 \\\\\n0  |k| \\ge 2\n\\end{cases}\n$$\n\n第三，我们推导残差的功率谱密度 (PSD) $S_{\\hat{e}}(\\omega)$。我们利用以下性质：对于一个过程 $y_t = H(B)w_t$，其中 $w_t$ 是功率谱密度为 $S_w(\\omega)=\\sigma^2$ 的白噪声，则 $y_t$ 的功率谱密度为 $S_y(\\omega) = |H(e^{-i\\omega})|^2 S_w(\\omega)$。\n在这里，$\\hat{e}_t = (1-B)w_t$，所以滤波器是 $H(B) = 1 - B$。通过代入 $B = e^{-i\\omega}$ 找到频率响应：\n$$\nH(e^{-i\\omega}) = 1 - e^{-i\\omega}\n$$\n频率响应的幅度平方是：\n$$\n|H(e^{-i\\omega})|^2 = |1 - e^{-i\\omega}|^2 = (1 - \\cos(\\omega))^2 + (\\sin(\\omega))^2 = 1 - 2\\cos(\\omega) + \\cos^2(\\omega) + \\sin^2(\\omega)\n$$\n使用恒等式 $\\cos^2(\\omega) + \\sin^2(\\omega) = 1$：\n$$\n|H(e^{-i\\omega})|^2 = 1 - 2\\cos(\\omega) + 1 = 2 - 2\\cos(\\omega) = 2(1 - \\cos(\\omega))\n$$\n输入白噪声 $w_t$ 的功率谱密度是常数，$S_w(\\omega) = \\sigma^2$。因此，残差过程 $\\hat{e}_t$ 的功率谱密度是：\n$$\nS_{\\hat{e}}(\\omega) = |H(e^{-i\\omega})|^2 S_w(\\omega) = 2\\sigma^2(1 - \\cos(\\omega))\n$$\n这个表达式在频率区间 $\\omega \\in [-\\pi, \\pi]$ 内有效。\n\n最后，我们解释其诊断意义。一个正确设定的时间序列模型应该产生与白噪声无法区分的残差。\n- **时域诊断**：白噪声的自协方差函数对于所有非零滞后都为零。推导出的 $\\hat{e}_t$ 的自协方差在滞后 $k=1$ 时不为零。残差的理论自相关函数（ACF）是：\n$$\n\\rho_{\\hat{e}}(k) = \\frac{\\gamma_{\\hat{e}}(k)}{\\gamma_{\\hat{e}}(0)}\n$$\n具体来说，对于滞后1阶：\n$$\n\\rho_{\\hat{e}}(1) = \\frac{-\\sigma^2}{2\\sigma^2} = -0.5\n$$\n对于模型诊断，工程师会检查残差 $\\hat{e}_t$ 的样本 ACF。在过度差分的情况下，ACF 图将在滞后1阶处表现出一个单一、巨大、统计上显著的负向尖峰，其值接近-0.5。所有大于1阶的滞后的 ACF 将不显著。这是多余差分的典型特征信号。\n\n- **频域诊断**：白噪声的功率谱密度对于所有频率都是恒定的（平坦的），即 $S(\\omega) = \\sigma^2$。推导出的 $\\hat{e}_t$ 的功率谱密度为 $S_{\\hat{e}}(\\omega) = 2\\sigma^2(1 - \\cos(\\omega))$。这个函数不是平坦的。关键地，我们来评估在零频率处的频谱：\n$$\nS_{\\hat{e}}(0) = 2\\sigma^2(1 - \\cos(0)) = 2\\sigma^2(1 - 1) = 0\n$$\n差分算子 $(1-B)$ 充当一个高通滤波器，衰减低频。应用两次会导致在零频率附近的功率过度衰减，在 $\\omega=0$ 处产生一个“谱洞”或凹陷。对于模型诊断，工程师会计算残差的周期图或平滑谱估计。一个在原点处显示出向零的显著凹陷的频谱是过度差分的明确迹象。", "answer": "$$\n\\boxed{2\\sigma^{2}(1 - \\cos(\\omega))}\n$$", "id": "2885077"}]}