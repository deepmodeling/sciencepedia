{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。本节将通过一系列精心设计的练习，帮助你掌握定常简单波的核心概念。这些练习将从基本原理的应用开始，逐步深入到更复杂的场景中，旨在锻炼你将理论应用于解决实际问题的能力。我们首先从一个直接应用普朗特-迈耶函数（Prandtl-Meyer function）概念的练习开始。普朗特-迈耶函数是分析超音速绕角膨胀流动的基石。在此练习 [@problem_id:607945] 中，你将为一种假设性的“夏普利金气体”推导该函数，尽管其状态方程很特殊，但其推导过程清晰地揭示了流动转角、速度和马赫数之间的基本关系，有助于你在新情境下巩固核心方法。", "problem": "查普里金气体是一种在某些宇宙学模型中使用的假设性物质，其特征在于状态方程 $p = -A/\\rho$，其中 $p$ 是压力，$\\rho$ 是密度，$A$ 是一个正常数。考虑这种气体的稳态、二维、超音速、等熵流。这种流动可以经历一种中心膨胀，类似于理想气体的普朗特-迈耶流。\n\n对于查普里金气体，能量守恒方程导出了流速 $q$ 和马赫数 $M=q/c$（其中 $c$ 是当地声速）之间的一个特定关系。该关系由下式给出：\n$$q^2 = \\frac{M^2 K}{M^2-1}$$\n其中 $K$ 是由流动的总能量决定的正常数。此关系仅对超音速流（$M>1$）有效。\n\n在任何二维、等熵、无旋流中，流向角的变化量 $d\\theta$ 与流速的变化量 $dq$ 和当地马赫数 $M$ 通过速端图特征方程相关联：\n$$d\\theta = \\sqrt{M^2-1} \\frac{dq}{q}$$\n这对应于一个膨胀波，其中气流偏离其初始方向。\n\n普朗特-迈耶函数 $\\nu(M)$ 量化了从参考状态开始膨胀的总转向角。对于查普里金气体，将参考状态选择在马赫数无穷大处是方便的。\n\n推导查普里金气体的普朗特-迈耶函数 $\\nu(M)$ 的表达式，边界条件为 $\\nu(M \\to \\infty) = 0$。", "solution": "1. 相关方程：\n   a. 流量关系：\n$$q^2 = \\frac{M^2K}{M^2-1}.$$\n   b. 速端图特征：\n$$d\\theta = \\sqrt{M^2-1}\\,\\frac{dq}{q}.$$\n2. 用 $M$ 表示 $q$：\n$$q = \\sqrt{K}\\,\\frac{M}{\\sqrt{M^2-1}}.$$\n3. 计算对数导数：\n$$\\ln q = \\tfrac12\\ln K + \\ln M - \\tfrac12\\ln(M^2-1),$$\n$$\\frac{dq}{q} = d(\\ln q) = \\frac{dM}{M} - \\frac{M\\,dM}{M^2-1}\n= -\\frac{dM}{M\\,(M^2-1)}.$$\n4. 代入速端图方程：\n$$d\\theta = \\sqrt{M^2-1}\\,\\Bigl(-\\frac{dM}{M\\,(M^2-1)}\\Bigr)\n= -\\frac{dM}{M\\sqrt{M^2-1}}.$$\n5. 从参考状态 $M\\to\\infty$ (此处 $\\nu=0$) 积分到有限的 $M$：\n$$\\nu(M)=\\int_{\\infty}^{M}d\\theta\n=-\\int_{\\infty}^{M}\\frac{dM}{M\\sqrt{M^2-1}}\n=\\int_{M}^{\\infty}\\frac{dM}{M\\sqrt{M^2-1}}.$$\n6. 通过设 $M=\\sec\\phi$, $dM=\\sec\\phi\\tan\\phi\\,d\\phi$ 来计算积分：\n$$\\int\\frac{dM}{M\\sqrt{M^2-1}}\n=\\int d\\phi\n\\quad\\Longrightarrow\\quad\n\\nu(M)=\\Bigl[\\phi\\Bigr]_{\\phi=\\arcsec M}^{\\phi=\\pi/2}\n=\\frac{\\pi}{2}-\\arcsec M\n=\\arcsin\\!\\Bigl(\\frac{1}{M}\\Bigr).$$", "answer": "$$\\boxed{\\arcsin\\!\\bigl(\\tfrac{1}{M}\\bigr)}$$", "id": "607945"}, {"introduction": "理解了点函数（如普朗特-迈耶函数）的计算后，我们来探讨流动属性如何在空间中演化。下一个练习 [@problem_id:607955] 旨在连接一维非定常简单波与定常准一维流动这两个看似不同的领域。黎曼不变量（Riemann invariants）通常在一维非定常简单波中保持恒定，但在具有变化的外部条件（如变化的通道截面积）的定常流中则会发生改变。通过推导黎曼不变量随截面积变化的规律，你将能更深刻地理解气体在喷管、扩压管等实际装置中的行为，并体会到不同流动模型之间的内在联系。", "problem": "考虑多方气体通过一个横截面积 $A(x)$ 缓慢变化的通道的定常、等熵、准一维流动。该气体的绝热指数 $\\gamma$ 为常数。该流动由以下方程组控制：\n\n1.  连续性方程：$\\frac{d}{dx}(\\rho u A) = 0$\n2.  动量方程：$\\rho u \\frac{du}{dx} + \\frac{dp}{dx} = 0$\n3.  状态方程（等熵）：$p = K\\rho^\\gamma$，其中 $K$ 是一个常数。\n\n当地声速由 $c = \\sqrt{\\gamma p / \\rho}$ 给出。对于一维非定常流，黎曼不变量定义为 $R_\\pm = u \\pm \\frac{2c}{\\gamma-1}$。在简单波中，这些量沿着特征线是恒定的。在定常、准一维流动中，它们的空间梯度不为零，并取决于面积的变化。可以证明，它们的导数具有以下形式：\n$$\n\\frac{dR_+}{dx} = F(u, M, \\gamma) \\frac{1}{A}\\frac{dA}{dx}\n$$\n$$\n\\frac{dR_-}{dx} = G(u, M, \\gamma) \\frac{1}{A}\\frac{dA}{dx}\n$$\n其中 $M=u/c$ 是马赫数。\n\n您的任务是推导比值 $\\frac{F(u, M, \\gamma)}{G(u, M, \\gamma)}$ 的表达式。请用马赫数 $M$ 来唯一表示您的最终答案。", "solution": "问题要求解比例因子 $F$ 和 $G$ 的比值，这两个因子将黎曼函数 $R_\\pm$ 的空间导数与通道面积 $A(x)$ 的对数导数联系起来。\n\n首先，我们将根据面积梯度找到 $\\frac{du}{dx}$ 的表达式。这就是著名的面积-速度关系。\n从连续性方程 $\\frac{d}{dx}(\\rho u A) = 0$ 出发，我们使用乘法法则进行微分：\n$$\nuA\\frac{d\\rho}{dx} + \\rho A\\frac{du}{dx} + \\rho u\\frac{dA}{dx} = 0\n$$\n两边同除以 $\\rho u A$ 得：\n$$\n\\frac{1}{\\rho}\\frac{d\\rho}{dx} + \\frac{1}{u}\\frac{du}{dx} + \\frac{1}{A}\\frac{dA}{dx} = 0\n$$\n(1)\n\n接下来，我们使用动量方程和等熵关系，将 $\\frac{d\\rho}{dx}$ 与 $\\frac{du}{dx}$ 联系起来。动量方程为 $\\rho u \\frac{du}{dx} + \\frac{dp}{dx} = 0$。\n使用链式法则和声速的定义 $c^2 = \\frac{dp}{d\\rho}$：\n$$\n\\frac{dp}{dx} = \\frac{dp}{d\\rho}\\frac{d\\rho}{dx} = c^2 \\frac{d\\rho}{dx}\n$$\n将此代入动量方程：\n$$\n\\rho u \\frac{du}{dx} + c^2 \\frac{d\\rho}{dx} = 0\n$$\n这就得到了密度梯度的关系式：\n$$\n\\frac{d\\rho}{dx} = -\\frac{\\rho u}{c^2}\\frac{du}{dx}\n$$\n(2)\n\n现在将方程 (2) 代入方程 (1)：\n$$\n\\frac{1}{\\rho}\\left(-\\frac{\\rho u}{c^2}\\frac{du}{dx}\\right) + \\frac{1}{u}\\frac{du}{dx} + \\frac{1}{A}\\frac{dA}{dx} = 0\n$$\n$$\n\\left(\\frac{1}{u} - \\frac{u}{c^2}\\right)\\frac{du}{dx} = -\\frac{1}{A}\\frac{dA}{dx}\n$$\n$$\n\\left(\\frac{c^2 - u^2}{uc^2}\\right)\\frac{du}{dx} = -\\frac{1}{A}\\frac{dA}{dx}\n$$\n引入马赫数 $M = u/c$：\n$$\n\\frac{u}{u^2}\\left(\\frac{1 - M^2}{M^2}\\right)\\frac{du}{dx} = -\\frac{1}{A}\\frac{dA}{dx}\n$$\n$$\n(1 - M^2)\\frac{1}{u}\\frac{du}{dx} = -\\frac{1}{A}\\frac{dA}{dx}\n$$\n这就得到了面积-速度关系：\n$$\n\\frac{du}{dx} = \\frac{u}{M^2-1}\\frac{1}{A}\\frac{dA}{dx}\n$$\n(3)\n\n接下来，我们需要求黎曼函数的导数 $\\frac{dR_\\pm}{dx}$。它们定义为 $R_\\pm = u \\pm \\frac{2c}{\\gamma-1}$。\n它们的导数是：\n$$\n\\frac{dR_\\pm}{dx} = \\frac{du}{dx} \\pm \\frac{2}{\\gamma-1}\\frac{dc}{dx}\n$$\n我们需要一个用 $\\frac{du}{dx}$ 表示 $\\frac{dc}{dx}$ 的表达式。我们使用等熵能量方程（伯努利方程），该方程指出滞止焓是恒定的：$h + \\frac{1}{2}u^2 = \\text{const}$。对于多方气体，焓为 $h = \\frac{c^2}{\\gamma-1}$。\n所以，$\\frac{c^2}{\\gamma-1} + \\frac{1}{2}u^2 = \\text{const}$。\n对 $x$ 微分：\n$$\n\\frac{2c}{\\gamma-1}\\frac{dc}{dx} + u\\frac{du}{dx} = 0\n$$\n$$\n\\frac{dc}{dx} = -\\frac{(\\gamma-1)u}{2c}\\frac{du}{dx}\n$$\n(4)\n\n现在我们可以计算 $\\frac{dR_+}{dx}$：\n$$\n\\frac{dR_+}{dx} = \\frac{du}{dx} + \\frac{2}{\\gamma-1}\\frac{dc}{dx} = \\frac{du}{dx} + \\frac{2}{\\gamma-1}\\left(-\\frac{(\\gamma-1)u}{2c}\\frac{du}{dx}\\right)\n$$\n$$\n\\frac{dR_+}{dx} = \\frac{du}{dx} - \\frac{u}{c}\\frac{du}{dx} = (1 - M)\\frac{du}{dx}\n$$\n将方程 (3) 代入 $\\frac{du}{dx}$：\n$$\n\\frac{dR_+}{dx} = (1-M)\\left(\\frac{u}{M^2-1}\\right)\\frac{1}{A}\\frac{dA}{dx} = (1-M)\\left(\\frac{u}{(M-1)(M+1)}\\right)\\frac{1}{A}\\frac{dA}{dx}\n$$\n$$\n\\frac{dR_+}{dx} = -\\frac{u}{M+1}\\frac{1}{A}\\frac{dA}{dx}\n$$\n将其与给定形式 $\\frac{dR_+}{dx} = F \\frac{1}{A}\\frac{dA}{dx}$ 进行比较，我们确定 $F(u, M, \\gamma) = -\\frac{u}{M+1}$。\n\n类似地，我们计算 $\\frac{dR_-}{dx}$：\n$$\n\\frac{dR_-}{dx} = \\frac{du}{dx} - \\frac{2}{\\gamma-1}\\frac{dc}{dx} = \\frac{du}{dx} - \\frac{2}{\\gamma-1}\\left(-\\frac{(\\gamma-1)u}{2c}\\frac{du}{dx}\\right)\n$$\n$$\n\\frac{dR_-}{dx} = \\frac{du}{dx} + \\frac{u}{c}\\frac{du}{dx} = (1 + M)\\frac{du}{dx}\n$$\n将方程 (3) 代入 $\\frac{du}{dx}$：\n$$\n\\frac{dR_-}{dx} = (1+M)\\left(\\frac{u}{M^2-1}\\right)\\frac{1}{A}\\frac{dA}{dx} = (1+M)\\left(\\frac{u}{(M-1)(M+1)}\\right)\\frac{1}{A}\\frac{dA}{dx}\n$$\n$$\n\\frac{dR_-}{dx} = \\frac{u}{M-1}\\frac{1}{A}\\frac{dA}{dx}\n$$\n将其与给定形式 $\\frac{dR_-}{dx} = G \\frac{1}{A}\\frac{dA}{dx}$ 进行比较，我们确定 $G(u, M, \\gamma) = \\frac{u}{M-1}$。\n\n最后，我们计算所要求的比值 $\\frac{F}{G}$：\n$$\n\\frac{F(u, M, \\gamma)}{G(u, M, \\gamma)} = \\frac{-\\frac{u}{M+1}}{\\frac{u}{M-1}} = -\\frac{M-1}{M+1}\n$$\n此表达式仅取决于马赫数 $M$，符合题目要求。", "answer": "$$\n\\boxed{-\\frac{M-1}{M+1}}\n$$", "id": "607955"}, {"introduction": "最后，我们将挑战从理想气体模型拓展到更贴近现实的非理想气体。在非理想气体中，热力学性质变得更加复杂，这直接影响了波的传播特性。这个练习 [@problem_id:607992] 要求你为一个遵循维里状态方程（virial equation of state）的非理想气体推导其普朗特-迈耶函数。解决这个问题需要你巧妙地融合热力学和气体动力学原理，它不仅是对计算能力的考验，更是对你综合分析和解决复杂问题能力的提升，展示了基本物理原理在更广泛场景下的适用性。", "problem": "一种非理想气体遵循以下状态方程：\n$$p(v, T) = \\frac{RT}{v} \\left(1 + \\frac{B_0}{Tv}\\right)$$\n其中$p$是压力，$v$是比容，$T$是温度，$R$是比气体常数，$B_0$是表征与理想气体行为偏差的常数参数。该气体具有恒定的比热容$c_p$和$c_v$，它们之间的关系为$c_p - c_v = R$和$c_p = 2c_v$。\n\n这种气体从一个均匀流动区域经历一个稳定的二维等熵超音速膨胀。这个过程产生一个简单膨胀波，也称为普朗特-迈耶扇 (Prandtl-Meyer fan)。Prandtl-Meyer 函数 $\\nu(M)$ 量化了气流从音速状态（马赫数 $M=1$）膨胀到马赫数 $M > 1$ 的超音速状态所必须转过的角度。\n\n推导该特定气体的 Prandtl-Meyer 函数 $\\nu(M)$ 的闭式解析表达式。", "solution": "Prandtl-Meyer 函数 $\\nu(M)$ 由关联流动角度变化 $d\\theta$ 与流速变化 $V$ 的微分方程定义：\n$$d\\nu = d\\theta = \\sqrt{M^2-1} \\frac{dV}{V}$$\n为了求得 $\\nu(M)$，我们必须将此表达式从马赫数 1 积分到 $M$。这需要将等式右边表示为 $M$ 的函数。\n\n首先，我们确定该气体的热力学性质。比热比由热容之比给出：\n$$\\gamma = \\frac{c_p}{c_v}$$\n使用给定关系式 $c_p = 2c_v$ 和 $c_p - c_v = R$，我们得到 $2c_v - c_v = R \\implies c_v = R$。因此，$c_p = 2R$，比热比为：\n$$\\gamma = \\frac{2c_v}{c_v} = 2$$\n\n接下来，我们建立等熵过程的关系式。热力学第一定律结合熵 $s$ 的定义为 $Tds = de + pdv$，其中 $e$ 是比内能。对于等熵过程，$ds=0$，因此 $de = -pdv$。内能可以通过积分 $de = c_v dT + (\\frac{\\partial e}{\\partial v})_T dv$ 求得。使用热力学关系式 $(\\frac{\\partial e}{\\partial v})_T = T(\\frac{\\partial p}{\\partial T})_v - p$：\n$$p = \\frac{RT}{v} + \\frac{RB_0}{v^2}$$\n$$\\left(\\frac{\\partial p}{\\partial T}\\right)_v = \\frac{R}{v}$$\n$$(\\frac{\\partial e}{\\partial v})_T = T\\left(\\frac{R}{v}\\right) - \\left(\\frac{RT}{v} + \\frac{RB_0}{v^2}\\right) = -\\frac{RB_0}{v^2}$$\n所以，$de = c_v dT - \\frac{RB_0}{v^2} dv$。对于等熵过程：\n$$c_v dT - \\frac{RB_0}{v^2} dv = -pdv = -\\left(\\frac{RT}{v} + \\frac{RB_0}{v^2}\\right)dv$$\n$$c_v dT = -\\frac{RT}{v}dv \\implies \\frac{dT}{T} = -\\frac{R}{c_v}\\frac{dv}{v}$$\n因为 $R/c_v = (\\gamma-1)$，我们有 $\\frac{dT}{T} = -(\\gamma-1)\\frac{dv}{v}$。对此积分，得到标准的等熵关系式：\n$$T v^{\\gamma-1} = \\text{constant}$$\n\n现在，我们求比焓 $h$ 和声速 $c$ 的表达式。\n$h = e + pv$。内能为 $e = \\int (c_v dT - \\frac{RB_0}{v^2} dv) = c_v T + \\frac{RB_0}{v} + e_{\\text{ref}}$。\n$$h = \\left(c_v T + \\frac{RB_0}{v}\\right) + v\\left(\\frac{RT}{v} + \\frac{RB_0}{v^2}\\right) = (c_v+R)T + \\frac{2RB_0}{v} = c_p T + \\frac{2RB_0}{v}$$\n声速为 $c^2 = (\\frac{\\partial p}{\\partial \\rho})_s = -v^2(\\frac{\\partial p}{\\partial v})_s$。使用通用公式 $c^2 = -v^2 \\left[ (\\frac{\\partial p}{\\partial v})_T - \\frac{T}{c_v} (\\frac{\\partial p}{\\partial T})_v^2 \\right]$：\n$$(\\frac{\\partial p}{\\partial v})_T = -\\frac{RT}{v^2} - \\frac{2RB_0}{v^3}$$\n$$c^2 = -v^2 \\left[ -\\frac{RT}{v^2} - \\frac{2RB_0}{v^3} - \\frac{T}{c_v}\\left(\\frac{R}{v}\\right)^2 \\right] = RT + \\frac{2RB_0}{v} + \\frac{R^2T}{c_v} = (1+\\frac{R}{c_v})RT + \\frac{2RB_0}{v}$$\n$$c^2 = \\gamma RT + \\frac{2RB_0}{v}$$\n当 $\\gamma=2$，$c_p=2R$ 时，我们有 $h = 2RT + \\frac{2RB_0}{v}$ 和 $c^2 = 2RT + \\frac{2RB_0}{v}$。因此，对于这种特定气体，我们发现焓和声速之间存在一个简单的关系：\n$$h = c^2$$\n对于稳定、绝热、无粘性流动，能量方程为 $h + \\frac{1}{2}V^2 = h_0$，其中 $h_0$ 是恒定的总焓。代入 $h=c^2$：\n$$c^2 + \\frac{1}{2}V^2 = h_0$$\n对 $V$ 求导：\n$$2c \\frac{dc}{dV} + V = 0 \\implies \\frac{dc}{dV} = -\\frac{V}{2c}$$\n我们现在可以关联 $c$ 和 $V$ 的微分变化：\n$$\\frac{dc}{c} = -\\frac{V}{2c^2}dV = -\\frac{V^2}{2c^2}\\frac{dV}{V} = -\\frac{M^2}{2}\\frac{dV}{V}$$\n马赫数是 $M=V/c$。对其对数求导：\n$$\\frac{dM}{M} = \\frac{dV}{V} - \\frac{dc}{c} = \\frac{dV}{V} - \\left(-\\frac{M^2}{2}\\frac{dV}{V}\\right) = \\left(1 + \\frac{M^2}{2}\\right)\\frac{dV}{V}$$\n解出 $\\frac{dV}{V}$：\n$$\\frac{dV}{V} = \\frac{dM/M}{1 + M^2/2}$$\n现在将此式代入 $d\\nu$ 的表达式中：\n$$d\\nu = \\frac{\\sqrt{M^2-1}}{1+M^2/2} \\frac{dM}{M}$$\nPrandtl-Meyer 函数是从 $M=1$ 到 $M$ 的积分：\n$$\\nu(M) = \\int_1^M \\frac{\\sqrt{M'^2-1}}{M'(1+M'^2/2)} dM'$$\n为了求解该积分，我们使用换元法，令 $x = \\sqrt{M'^2-1}$。这得到 $M'^2 = x^2+1$ 和 $2M'dM' = 2xdx$，因此 $\\frac{dM'}{M'} = \\frac{xdx}{x^2+1}$。积分上下限变为：当 $M'=1$ 时，$x=0$；当 $M'=M$ 时，$x=\\sqrt{M^2-1}$。\n$$\\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\frac{x}{1+(x^2+1)/2} \\frac{xdx}{x^2+1} = \\int_0^{\\sqrt{M^2-1}} \\frac{2x^2}{(x^2+3)(x^2+1)} dx$$\n使用部分分式分解法：\n$$\\frac{2x^2}{(x^2+3)(x^2+1)} = \\frac{A}{x^2+1} + \\frac{B}{x^2+3}$$\n令 $u=x^2$：$2u = A(u+3) + B(u+1)$。\n当 $u=-1$ 时：$-2 = 2A \\implies A = -1$。\n当 $u=-3$ 时：$-6 = -2B \\implies B = 3$。\n所以被积函数是 $\\frac{3}{x^2+3} - \\frac{1}{x^2+1}$。\n$$\\nu(M) = \\int_0^{\\sqrt{M^2-1}} \\left(\\frac{3}{x^2+3} - \\frac{1}{x^2+1}\\right) dx$$\n$$\\nu(M) = \\left[ 3 \\left(\\frac{1}{\\sqrt{3}}\\arctan\\left(\\frac{x}{\\sqrt{3}}\\right)\\right) - \\arctan(x) \\right]_0^{\\sqrt{M^2-1}}$$\n$$\\nu(M) = \\left[ \\sqrt{3}\\arctan\\left(\\frac{x}{\\sqrt{3}}\\right) - \\arctan(x) \\right]_0^{\\sqrt{M^2-1}}$$\n计算在积分上下限处的值：\n$$\\nu(M) = \\left( \\sqrt{3}\\arctan\\left(\\sqrt{\\frac{M^2-1}{3}}\\right) - \\arctan(\\sqrt{M^2-1}) \\right) - (\\sqrt{3}\\arctan(0) - \\arctan(0))$$\n最终表达式为：\n$$\\nu(M) = \\sqrt{3}\\arctan\\left(\\sqrt{\\frac{M^2-1}{3}}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right)$$", "answer": "$$\n\\boxed{\\sqrt{3}\\arctan\\left(\\sqrt{\\frac{M^2-1}{3}}\\right) - \\arctan\\left(\\sqrt{M^2-1}\\right)}\n$$", "id": "607992"}]}