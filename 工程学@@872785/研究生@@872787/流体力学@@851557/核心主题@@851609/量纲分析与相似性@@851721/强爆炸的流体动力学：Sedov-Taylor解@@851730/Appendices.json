{"hands_on_practices": [{"introduction": "掌握了基本概念后，我们首先通过量纲分析这一强大工具来实践。量纲分析使我们能够在不求解复杂的流体力学方程组的情况下，揭示物理规律的内在标度关系。这个练习 [@problem_id:516889] 将挑战你将该方法应用于非均匀介质中的爆炸，推导出环境密度分布与冲击波轨迹之间的深刻联系。", "problem": "考虑一个强点状爆炸，在时间 $t=0$ 和位置 $r=0$ 处释放有限的能量 $E$。爆炸发生在一个非均匀、初始静止的冷气体中。该气体的环境密度 $\\rho_0(r)$ 不是恒定的，而是根据幂律随距爆炸中心的径向距离 $r$ 变化：\n$$\n\\rho_0(r) = C r^{-\\omega}\n$$\n其中 $C$ 和 $\\omega$ 是正常数。\n\n爆炸向外驱动一个强的球形激波。假设激波后的压力远大于环境压力，因此环境压力和气体的初始内能可以忽略不计。在这些条件下，流动是自相似的。激波前沿的半径 $R(t)$ 可以通过量纲分析找到。已知激波轨迹也遵循时间的幂律：\n$$\nR(t) \\propto t^\\alpha\n$$\n其中 $\\alpha$ 是一个常数指数。\n\n假设在时间 $t$ 的激波半径 $R$ 仅取决于爆炸能量 $E$、爆炸后的时间 $t$以及环境密度参数 $C$，推导环境密度分布所需的幂律指数 $\\omega$ 作为激波前沿轨迹的时间指数 $\\alpha$ 的函数。", "solution": "1. 通过量纲分析，令激波半径的标度关系为\n$$\nR\\propto E^a\\,C^b\\,t^c.\n$$\n量纲：$[E]=M\\,L^2\\,T^{-2}$，$[C]=M\\,L^{-3+\\omega}$，$[t]=T$，$[R]=L$。\n因此\n$$\nL:\\;1=2a+(-3+\\omega)b,\n\\quad\nM:\\;0=a+b,\n\\quad\nT:\\;0=-2a+c.\n$$\n\n2. 从 $a+b=0$ 我们得到 $b=-a$。从 $-2a+c=0$ 我们得到 $c=2a$。\n\n3. 代入 $2a+(-3+\\omega)(-a)=1$ 得到\n$$\n2a+a(3-\\omega)=1\n\\;\\Longrightarrow\\;\na\\,(5-\\omega)=1\n\\;\\Longrightarrow\\;\na=\\frac1{5-\\omega},\n\\quad\nc=2a=\\frac{2}{5-\\omega}.\n$$\n\n4. 时间指数 $\\alpha$ 是 $c$，所以\n$$\n\\alpha=\\frac{2}{5-\\omega}\n\\;\\Longrightarrow\\;\n5-\\omega=\\frac{2}{\\alpha}\n\\;\\Longrightarrow\\;\n\\omega=5-\\frac{2}{\\alpha}.\n$$", "answer": "$$\\boxed{5 - \\frac{2}{\\alpha}}$$", "id": "516889"}, {"introduction": "理论的价值在于其应用。在下一个练习中，我们将把赛道夫-泰勒解的核心思想，如强冲击波条件和自相似性，应用于一个更复杂的物理情景：发生在两种不同介质界面上的爆炸。通过引入一个合理的物理近似——Kompaneets近似，这个问题 [@problem_id:516830] 旨在锻炼你如何运用物理直觉和边界条件来解决多介质问题。", "problem": "一个总能量为 $E$ 的强点爆炸发生在一个平面界面（$z=0$）上，该界面分隔了两种不同的、静止的、冷的理想气体。气体1填充在半空间 $z>0$ 中，其初始均匀密度为 $\\rho_{01}$，绝热指数为 $\\gamma_1$。气体2填充在半空间 $z<0$ 中，其初始均匀密度为 $\\rho_{02}$，绝热指数为 $\\gamma_2$。\n\n该爆炸产生两个分别向两种介质中传播的半球形冲击波。在介质1中，冲击波前的半径为 $R_1(t)$；在介质2中，其半径为 $R_2(t)$。根据量纲分析，在均匀介质中的强点爆炸导致的冲击波半径随时间增长的关系为 $R(t) \\propto t^{2/5}$。这个时间依赖关系对 $R_1(t)$ 和 $R_2(t)$ 都成立。\n\n对于强冲击波，紧邻冲击波前的压强 $p_s$ 与初始气体密度 $\\rho_0$ 及冲击波前速度 $u_s = dR/dt$ 之间的关系由朗金-雨贡纽跳跃条件给出：\n$$p_s = \\frac{2}{\\gamma+1} \\rho_0 u_s^2$$\n在 $z=0$ 的物质接触界面上，对于所有时间 $t>0$，压强必须是连续的。\n\n为了使问题能够解析处理，我们引入一个关键的简化物理模型，称为 Kompaneets 近似。该近似假设每个半球形爆炸波的整个体积内的压强在空间上是均匀的，且等于其各自冲击波前的压强。\n\n使用该近似，推导冲击波前半径之比 $\\frac{R_1(t)}{R_2(t)}$ 的表达式。你的最终答案应该是一个不依赖于时间的表达式，用两种气体的初始密度和绝热指数表示。", "solution": "本题要求在 Kompaneets 近似下，求解在两种理想气体界面处发生强爆炸时，冲击波半径之比 $\\frac{R_1(t)}{R_2(t)}$。\n\n**步骤1：将冲击波速度与冲击波半径联系起来。**\n题目指出，冲击波半径遵循自相似标度律 $R(t) \\propto t^{2/5}$。我们可以为每种介质写出：\n$$R_1(t) = C_1 t^{2/5}$$\n$$R_2(t) = C_2 t^{2/5}$$\n其中 $C_1$ 和 $C_2$ 是常数，取决于气体性质和分配到每个半球的能量。\n\n冲击波前速度 $u_{s1}$ 和 $u_{s2}$ 是半径对时间的导数：\n$$u_{s1} = \\frac{dR_1}{dt} = \\frac{d}{dt}(C_1 t^{2/5}) = \\frac{2}{5} C_1 t^{-3/5}$$\n$$u_{s2} = \\frac{dR_2}{dt} = \\frac{d}{dt}(C_2 t^{2/5}) = \\frac{2}{5} C_2 t^{-3/5}$$\n\n我们可以用半径来表示速度：\n由于 $C_1 = R_1(t)/t^{2/5}$，我们有 $u_{s1} = \\frac{2}{5} \\frac{R_1(t)}{t^{2/5}} t^{-3/5} = \\frac{2}{5} \\frac{R_1(t)}{t}$。\n类似地， $u_{s2} = \\frac{2}{5} \\frac{R_2(t)}{t}$。\n\n**步骤2：表示每种介质中的冲击波后压强。**\n使用给定的强冲击波朗金-雨贡纽跳跃条件 $p_s = \\frac{2}{\\gamma+1} \\rho_0 u_s^2$，我们可以写出每个冲击波前的压强。\n\n对于介质1：\n$$p_{s1} = \\frac{2}{\\gamma_1+1} \\rho_{01} u_{s1}^2 = \\frac{2}{\\gamma_1+1} \\rho_{01} \\left(\\frac{2}{5} \\frac{R_1}{t}\\right)^2 = \\frac{8}{25} \\frac{\\rho_{01}}{\\gamma_1+1} \\frac{R_1^2}{t^2}$$\n\n对于介质2：\n$$p_{s2} = \\frac{2}{\\gamma_2+1} \\rho_{02} u_{s2}^2 = \\frac{2}{\\gamma_2+1} \\rho_{02} \\left(\\frac{2}{5} \\frac{R_2}{t}\\right)^2 = \\frac{8}{25} \\frac{\\rho_{02}}{\\gamma_2+1} \\frac{R_2^2}{t^2}$$\n\n**步骤3：应用 Kompaneets 近似和界面条件。**\nKompaneets 近似指出，冲击波后的压强是均匀的。这意味着爆炸中心（原点，$r=0$，位于界面上）的压强等于冲击波后的压强。\n$$p_c(t) = p_{s1} \\quad \\text{（从介质1看）}$$\n$$p_c(t) = p_{s2} \\quad \\text{（从介质2看）}$$\n\n界面上的物理边界条件是压强连续。因此，无论从哪个介质考虑，中心的压强都必须相同。\n$$p_{s1} = p_{s2}$$\n\n**步骤4：求解半径之比。**\n我们将 $p_{s1}$ 和 $p_{s2}$ 的表达式设为相等：\n$$\\frac{8}{25} \\frac{\\rho_{01}}{\\gamma_1+1} \\frac{R_1^2}{t^2} = \\frac{8}{25} \\frac{\\rho_{02}}{\\gamma_2+1} \\frac{R_2^2}{t^2}$$\n\n公因式 $\\frac{8}{25}$ 和 $\\frac{1}{t^2}$ 消去，表明所得关系与时间无关。\n$$\\frac{\\rho_{01}}{\\gamma_1+1} R_1^2 = \\frac{\\rho_{02}}{\\gamma_2+1} R_2^2$$\n\n现在，我们重新整理方程以求解所需比率 $\\frac{R_1}{R_2}$。\n$$\\frac{R_1^2}{R_2^2} = \\frac{\\rho_{02}}{\\rho_{01}} \\frac{\\gamma_1+1}{\\gamma_2+1}$$\n\n对两边取平方根，得到最终表达式：\n$$\\frac{R_1}{R_2} = \\sqrt{\\frac{\\rho_{02}}{\\rho_{01}} \\frac{\\gamma_1+1}{\\gamma_2+1}}$$\n这就是在 Kompaneets 近似下冲击波前半径之比。", "answer": "$$\\boxed{\\sqrt{\\frac{\\rho_{02}}{\\rho_{01}} \\frac{\\gamma_1+1}{\\gamma_2+1}}}$$", "id": "516830"}, {"introduction": "在理论分析之后，我们进入计算实践，这是连接解析解与真实世界模拟的关键桥梁。本练习 [@problem_id:2437110] 要求你编写一个程序来模拟球对称爆炸，并通过数值方法验证经典的 $R \\propto t^{2/5}$ 标度律。这项实践不仅能加深你对欧拉方程和激波捕捉方法的理解，还将让你亲手验证物理理论的预测能力。", "problem": "您必须编写一个完整、可运行的程序，模拟由原点处的瞬时能量沉积驱动的一维球对称冲击波，并验证激波半径的自相似标度。从可压缩欧拉方程的守恒律、理想气体定律以及球坐标系中的几何关系出发。单位体积的守恒状态量为 $U = (\\rho, \\rho u, E)$，其中 $\\rho$ 是质量密度，$u$ 是径向速度，$E$ 是总能量密度，对于理想气体压力 $p$ 和热容比 $\\gamma$，其关系式为 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$。在球对称条件下，对于内半径为 $r_{i-1/2}$、外半径为 $r_{i+1/2}$、球壳体积为 $V_{i} = \\tfrac{4\\pi}{3}\\left(r_{i+1/2}^{3} - r_{i-1/2}^{3}\\right)$、界面面积为 $A_{i\\pm 1/2} = 4\\pi r_{i\\pm 1/2}^{2}$ 的球壳，其有限体积积分形式为\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(U_{i}V_{i}\\right) = - \\left(F_{i+1/2}A_{i+1/2} - F_{i-1/2}A_{i-1/2}\\right),\n$$\n其中径向的物理通量为 $F(U) = \\left(\\rho u,\\ \\rho u^{2} + p,\\ u(E + p)\\right)$。这种几何上精确的积分形式能自动处理球面几何效应。在每个界面上，使用 Local Lax-Friedrichs (LLF) 数值通量（也称为 Rusanov 通量）实现一个一阶、激波捕捉的有限体积方法，\n$$\nF^{\\ast} = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2} a_{\\max}\\left(U_{R} - U_{L}\\right),\n$$\n其中 $a_{\\max} = \\max\\left(\\lvert u_{L}\\rvert + c_{L}, \\lvert u_{R}\\rvert + c_{R}\\right)$ 且声速为 $c = \\sqrt{\\gamma p/\\rho}$。使用 Courant-Friedrichs-Lewy (CFL) 时间步长条件 $ \\Delta t = \\mathrm{CFL}\\,\\Delta r / \\max_{i}(\\lvert u_{i}\\rvert + c_{i})$，其中 $\\Delta r$ 是均匀的径向网格间距。在 $r = 0$ 处施加反射边界条件，在外半径处施加出流（零梯度）边界条件。\n\n以零速度初始化一个密度为 $\\rho_{0}$、压力为 $p_{0}$ 的均匀环境状态，并在 $t=0$ 时，将一个有限的爆炸能量 $E_{0}$（单位：焦耳）作为附加内能，均匀地沉积在原点周围一个半径为 $R_{\\mathrm{dep}} = 3\\Delta r$ 的小球内。理想气体的性质由比值 $\\gamma$ 指定，您必须使用理想气体定律在能量和压力之间进行转换。使用国际单位制（SI）：长度单位为米，密度单位为千克/立方米，压力单位为帕斯卡，时间单位为秒。\n\n令 $R(t)$ 表示数值推断出的激波半径，其定义为压力超过指定环境阈值（具体为：$p > 1.2\\,p_{0}$）的最外层单元的中心半径。在起始时间 $t_{\\mathrm{start}}$ 和结束时间 $t_{\\mathrm{end}}$ 之间以均匀的时间间隔记录 $R(t)$，然后通过对 $\\log R$ 与 $\\log t$ 进行线性回归来估计标度指数 $n$。经典的三维点爆炸 Sedov-Taylor 相似解在强激波极限下预测 $R \\propto t^{2/5}$。您的程序必须计算每个测试用例的绝对误差 $\\lvert n - 2/5\\rvert$。\n\n物理单位：所有输入和内部计算都必须以国际单位制（SI）进行解释。最终报告的误差是无量纲数。\n\n算法要求：\n- 将球形域 $[0, R_{\\max}]$ 离散为 $N$ 个均匀的径向单元，其边界位于 $r_{j+1/2} = j\\,\\Delta r$（其中 $j = 0,1,\\dots,N$），且 $\\Delta r = R_{\\max}/N$。\n- 使用 Rusanov 通量进行一阶有限体积更新，并采用受 CFL 条件约束的时间步长。\n- 使用 $\\gamma = 1.4$，$\\rho_{0} = 1.0$（单位 $\\mathrm{kg/m^{3}}$），$p_{0} = 100.0$（单位 $\\mathrm{Pa}$），并使用压力下限以确保正性。\n- 在采样时刻，将满足 $p > 1.2\\,p_{0}$ 的最外层单元的中心半径检测为 $R(t)$。\n\n测试套件：\n对于每个参数元组 $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max})$，使用 $t_{\\mathrm{start}} = 0.2\\,t_{\\mathrm{end}}$，并在 $t_{\\mathrm{start}}$ 和 $t_{\\mathrm{end}}$ 之间（含两端）的 20 个均匀分布的时间点上采样 $R(t)$。使用以下四个测试用例：\n- 用例 1：$(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (160, 0.5, 1.0, 0.05, 1.0)$。\n- 用例 2：$(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (100, 0.5, 1.0, 0.05, 1.0)$。\n- 用例 3：$(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (160, 0.4, 0.5, 0.05, 1.0)$。\n- 用例 4：$(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (200, 0.6, 2.0, 0.08, 1.2)$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含四个用例的绝对指数误差，以逗号分隔的列表形式并用方括号括起来（例如，$\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$），每个结果都是四舍五入到三位小数的十进制数。", "solution": "所述问题是计算流体动力学中的一个标准的、适定的问题。它要求对球对称冲击波进行数值模拟，这是一个在强激波极限下由 Sedov-Taylor 自相似解所描述的现象。该问题具有科学依据，使用了可压缩欧拉方程和理想气体定律。所有必要的参数、初始条件、边界条件和数值方法都已指定，从而可以得到唯一且有意义的解。网格定义中的微小歧义可以通过将其解释为标准的基于单元的网格结构来解决。因此，该问题被认为是有效的，并提供了一个严谨的解。\n\n该模拟对一维球坐标系中由欧拉方程控制的流体状态演化进行建模。单位体积的守恒状态向量为 $U = (\\rho, \\rho u, E)$，分别代表质量密度、径向动量密度和总能量密度。该系统由理想气体状态方程 $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$ 封闭，其中 $p$ 是压力，$\\gamma$ 是热容比。\n\n我们在均匀的径向网格上采用有限体积法。将域 $[0, R_{\\max}]$ 离散为 $N$ 个单元。对于 $i=0, \\dots, N-1$，单元 $i$ 占据半径 $r_i = i\\Delta r$ 和 $r_{i+1} = (i+1)\\Delta r$ 之间的球壳，其中 $\\Delta r = R_{\\max}/N$。单元体积为 $V_i = \\frac{4\\pi}{3}(r_{i+1}^3 - r_i^3)$，界面面积为 $A_k = 4\\pi r_k^2$。离散状态 $U_i$ 表示单元 $i$ 中守恒量的单元平均值。\n\n每个单元中状态的时间演化由守恒律的积分形式控制，这确保了几何源项得到正确处理。使用一阶前向欧拉时间步进格式，单元 $i$ 的更新公式为：\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{V_i} \\left( F^*_{i+1} A_{i+1} - F^*_{i} A_{i} \\right)\n$$\n此处，$U_i^n$ 是时间 $t_n$ 时的状态，$\\Delta t$ 是时间步长，$F^*_{k}$ 是半径为 $r_k$ 的界面上的数值通量。\n\n数值通量 $F^*$ 使用 Local Lax-Friedrichs (Rusanov) 格式计算，该格式对于涉及激波的问题是鲁棒的。在左状态 $U_L$ 和右状态 $U_R$ 之间的界面处，通量为：\n$$\nF^{\\ast}(U_L, U_R) = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2} a_{\\max}\\left(U_{R} - U_{L}\\right)\n$$\n其中 $F(U) = (\\rho u, \\rho u^2+p, u(E+p))^T$ 是物理通量。耗散项由 $a_{\\max} = \\max(\\lvert u_L \\rvert + c_L, \\lvert u_R \\rvert + c_R)$ 控制，其中 $c = \\sqrt{\\gamma p / \\rho}$ 是声速。\n\n时间步长 $\\Delta t$ 被动态调整以满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件：\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta r}{\\max_i(\\lvert u_i \\rvert + c_i)}\n$$\n其中 $\\mathrm{CFL}  1$ 是库朗数。\n\n初始状态是密度为 $\\rho_0$、压力为 $p_0$ 的均匀静止介质。通过在原点处将总能量 $E_0$ 均匀沉积到半径为 $R_{\\mathrm{dep}} = 3\\Delta r$ 的小球中来引发爆炸。这通过将受影响单元中的总能量密度 $E$ 增加一个恒定量 $\\Delta E = E_0 / V_{\\mathrm{dep}}$ 来建模，其中 $V_{\\mathrm{dep}} = \\frac{4\\pi}{3} R_{\\mathrm{dep}}^3$。\n\n边界条件使用虚拟单元处理。通过将虚拟单元的状态设置为 $(\\rho_0, -\\rho_0 u_0, E_0)$ 来强制执行原点（$r=0$）处的反射边界，其中 $(\\rho_0, u_0, E_0)$ 来自第一个物理单元。通过将最后一个物理单元的状态复制到其相邻的虚拟单元中，来强制执行 $r=R_{\\max}$ 处的出流（零梯度）边界。\n\n为进行验证，随时间追踪激波前沿半径 $R(t)$。它被定义为压力超过阈值 $p > 1.2 p_0$ 的最外层单元的中心。在指定的时间间隔 $[t_{\\mathrm{start}}, t_{\\mathrm{end}}]$ 内采集 $(t, R(t))$ 的样本。Sedov-Taylor 相似解预测了幂律标度关系 $R(t) \\propto t^n$，对于三维冲击波，指数为 $n=2/5$。对 $\\log(R)$ 与 $\\log(t)$ 进行线性回归，以数值方式估计指数 $n$。然后计算绝对误差 $|n - 2/5|$，以量化模拟与理论之间的一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef conserved_to_prim(U, gamma):\n    \"\"\"Converts a conserved state vector U to primitive variables (rho, u, p).\"\"\"\n    rho = U[..., 0]\n    mom = U[..., 1]\n    E_total = U[..., 2]\n    \n    # Add a floor for density to avoid division by zero\n    rho = np.maximum(rho, 1e-12)\n    \n    u = mom / rho\n    E_int = E_total - 0.5 * rho * u**2\n    p = (gamma - 1.0) * E_int\n    return rho, u, p\n\ndef prim_to_conserved(rho, u, p, gamma):\n    \"\"\"Converts primitive variables (rho, u, p) to a conserved state vector U.\"\"\"\n    mom = rho * u\n    E_total = p / (gamma - 1.0) + 0.5 * rho * u**2\n    return np.array([rho, mom, E_total])\n\ndef get_physical_flux(U, gamma):\n    \"\"\"Computes the physical flux F(U) for a given conserved state U.\"\"\"\n    rho, u, p = conserved_to_prim(U, gamma)\n    E_total = U[2]\n    return np.array([rho * u, rho * u**2 + p, u * (E_total + p)])\n\ndef rusanov_flux(UL, UR, gamma):\n    \"\"\"Computes the Rusanov (Local Lax-Friedrichs) numerical flux.\"\"\"\n    rho_L, u_L, p_L = conserved_to_prim(UL, gamma)\n    rho_R, u_R, p_R = conserved_to_prim(UR, gamma)\n    \n    # Ensure pressure and density are positive for sound speed calculation\n    p_L, p_R = max(p_L, 1e-9), max(p_R, 1e-9)\n    rho_L, rho_R = max(rho_L, 1e-12), max(rho_R, 1e-12)\n    \n    cs_L = np.sqrt(gamma * p_L / rho_L)\n    cs_R = np.sqrt(gamma * p_R / rho_R)\n    \n    a_max = max(abs(u_L) + cs_L, abs(u_R) + cs_R)\n    \n    F_L = get_physical_flux(UL, gamma)\n    F_R = get_physical_flux(UR, gamma)\n    \n    return 0.5 * (F_L + F_R) - 0.5 * a_max * (UR - UL)\n\ndef run_simulation(params):\n    \"\"\"Runs a single blast wave simulation for a given set of parameters.\"\"\"\n    N, CFL, E_blast, t_end, R_max = params\n    gamma = 1.4\n    rho0 = 1.0\n    p0 = 100.0\n\n    # Grid setup\n    dr = R_max / float(N)\n    r_interfaces = np.linspace(0.0, R_max, N + 1)\n    r_centers = r_interfaces[:-1] + dr / 2.0\n    V_cells = (4.0 / 3.0) * np.pi * (r_interfaces[1:]**3 - r_interfaces[:-1]**3)\n    V_cells = np.maximum(V_cells, 1e-12)\n    A_interfaces = 4.0 * np.pi * r_interfaces**2\n\n    # Initial conditions\n    U = np.zeros((N, 3))\n    E_internal_ambient = p0 / (gamma - 1.0)\n    U[:, 0] = rho0\n    U[:, 2] = E_internal_ambient\n    \n    R_dep = 3.0 * dr\n    V_dep_sphere = (4.0/3.0) * np.pi * R_dep**3\n    \n    dep_indices = np.where(r_centers  R_dep)[0]\n    if V_dep_sphere > 0 and len(dep_indices) > 0:\n        # Distribute energy density over the cells in the deposition sphere\n        total_cell_vol_in_dep_sphere = np.sum(V_cells[dep_indices])\n        if total_cell_vol_in_dep_sphere > 0:\n            dE = E_blast / total_cell_vol_in_dep_sphere\n            U[dep_indices, 2] += dE\n    \n    # Simulation loop\n    t = 0.0\n    t_start = 0.2 * t_end\n    t_samples = np.linspace(t_start, t_end, 20)\n    sample_idx = 0\n    recorded_t = []\n    recorded_R = []\n\n    while t  t_end:\n        rho, vel, p = conserved_to_prim(U, gamma)\n        p = np.maximum(p, 1e-6 * p0) # Pressure floor\n        U[:, 2] = p / (gamma - 1.0) + 0.5 * rho * vel**2\n\n        cs = np.sqrt(gamma * p / rho)\n        max_speed = np.max(np.abs(vel) + cs)\n        dt = CFL * dr / max_speed if max_speed > 0 else 1e-6\n\n        # Adjust dt to hit the next sample time exactly if it's close\n        if sample_idx  len(t_samples) and t  t_samples[sample_idx] and t + dt >= t_samples[sample_idx]:\n             dt = t_samples[sample_idx] - t\n\n        t += dt\n        \n        # Boundary conditions\n        U_ext = np.zeros((N + 2, 3))\n        U_ext[1:-1, :] = U\n        \n        rho_L_bnd, u_L_bnd, p_L_bnd = conserved_to_prim(U[0, :], gamma)\n        U_ext[0, :] = prim_to_conserved(rho_L_bnd, -u_L_bnd, p_L_bnd, gamma)\n        U_ext[-1, :] = U[-1, :]\n        \n        # Calculate fluxes at interfaces\n        F_star = np.zeros((N + 1, 3))\n        for i in range(N + 1):\n            F_star[i, :] = rusanov_flux(U_ext[i, :], U_ext[i + 1, :], gamma)\n            \n        # Update solution (vectorized)\n        flux_balance = F_star[1:, :] * A_interfaces[1:, np.newaxis] - F_star[:-1, :] * A_interfaces[:-1, np.newaxis]\n        U -= (dt / V_cells[:, np.newaxis]) * flux_balance\n        \n        # Record data\n        if sample_idx  len(t_samples) and t >= t_samples[sample_idx]:\n            rho, _, p = conserved_to_prim(U, gamma)\n            shock_indices = np.where(p > 1.2 * p0)[0]\n            if len(shock_indices) > 0:\n                shock_idx = shock_indices[-1]\n                R_shock = r_centers[shock_idx]\n                recorded_t.append(t_samples[sample_idx])\n                recorded_R.append(R_shock)\n\n            sample_idx += 1\n    \n    # Final analysis\n    if len(recorded_t)  2:\n        return 999.0\n\n    log_t = np.log(np.array(recorded_t))\n    log_R = np.log(np.array(recorded_R))\n    \n    valid_indices = np.isfinite(log_t)  np.isfinite(log_R)\n    if np.sum(valid_indices)  2:\n        return 999.0\n        \n    slope, _, _, _, _ = linregress(log_t[valid_indices], log_R[valid_indices])\n    \n    error = abs(slope - 2.0/5.0)\n    return error\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (160, 0.5, 1.0, 0.05, 1.0),\n        (100, 0.5, 1.0, 0.05, 1.0),\n        (160, 0.4, 0.5, 0.05, 1.0),\n        (200, 0.6, 2.0, 0.08, 1.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_simulation(case)\n        results.append(f\"{error:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2437110"}]}