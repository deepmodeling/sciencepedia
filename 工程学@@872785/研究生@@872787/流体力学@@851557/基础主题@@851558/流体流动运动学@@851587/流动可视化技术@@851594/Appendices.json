{"hands_on_practices": [{"introduction": "粒子图像测速技术（PIV）通过在有限的时间间隔 $\\Delta t$ 内测量位移来计算速度。本练习探讨了这个有限的时间间隔在流动存在加速度时如何引入系统性偏差。这是一个基本概念，揭示了 PIV 测量的是一个平均速度，而非瞬时速度，这对于准确解读非定常流动数据至关重要。[@problem_id:510747]", "problem": "粒子图像测速（Particle Image Velocimetry, PIV）是一种用于获取流体速度测量的流场可视化技术。标准的PIV算法通过测量在一个被称为查问窗口的流场小子区域内，示踪粒子在短时间间隔 $\\Delta t$ 内的平均位移 $\\Delta \\vec{r}$ 来确定速度矢量。测量得到的速度则计算为 $\\vec{u}_{PIV} = \\Delta \\vec{r} / \\Delta t$。\n\n在具有非零加速度的流场中，这个测量过程会引入一种偏差误差。我们考虑一个简化模型来分析这种偏差。假设PIV系统能完美地跟踪并测量单个示踪粒子的位移，该粒子在初始时刻 $t_0$ 位于查问窗口的几何中心 $\\vec{r}_c$。该粒子所在的流场使其经受一个恒定的拉格朗日加速度 $\\vec{a}_p$。\n\nPIV测量在从 $t_0$ 到 $t_0 + \\Delta t$ 的时间间隔内进行。与之进行比较的“真实”速度定义为初始时刻查问窗口中心的流体瞬时速度，即 $\\vec{u}_{true} = \\vec{u}(\\vec{r}_c, t_0)$。\n\n请推导速度偏差误差矢量，其定义为 $\\vec{\\epsilon}_u = \\vec{u}_{PIV} - \\vec{u}_{true}$，并用恒定的粒子加速度 $\\vec{a}_p$ 和时间间隔 $\\Delta t$ 来表示。", "solution": "相关方程：\n1. 恒定加速度下的粒子位移：\n$$\\Delta \\vec{r} = \\vec{u}(\\vec{r}_c,t_0)\\,\\Delta t + \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t^2.$$\n2. PIV测量的速度：\n$$\\vec{u}_{PIV} = \\frac{\\Delta \\vec{r}}{\\Delta t}.$$\n3. 在 $t_0$ 和 $\\vec{r}_c$ 处的真实速度：\n$$\\vec{u}_{true} = \\vec{u}(\\vec{r}_c,t_0).$$\n4. 速度偏差误差：\n$$\\vec{\\epsilon}_u = \\vec{u}_{PIV} - \\vec{u}_{true}.$$\n\n分步推导：\n根据(1)，\n$$\\Delta \\vec{r} = \\vec{u}(\\vec{r}_c,t_0)\\,\\Delta t + \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t^2.$$\n等式两边除以 $\\Delta t$ 得到 $\\vec{u}_{PIV}$：\n$$\\vec{u}_{PIV} = \\frac{\\Delta \\vec{r}}{\\Delta t}\n= \\vec{u}(\\vec{r}_c,t_0) + \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t.$$\n减去 $\\vec{u}_{true} = \\vec{u}(\\vec{r}_c,t_0)$:\n$$\\vec{\\epsilon}_u\n= \\vec{u}_{PIV} - \\vec{u}_{true}\n= \\bigl[\\vec{u}(\\vec{r}_c,t_0) + \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t\\bigr]\n  - \\vec{u}(\\vec{r}_c,t_0)\n= \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t.$$\n因此，偏差误差为\n$$\\vec{\\epsilon}_u = \\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t.$$", "answer": "$$\\boxed{\\tfrac{1}{2}\\,\\vec{a}_p\\,\\Delta t}$$", "id": "510747"}, {"introduction": "在理解了基本的测量偏差之后，本练习将探讨平面 PIV 中一个更复杂的三维误差来源：“粒子对丢失”效应。我们将分析一个假设情景，以理解当离面运动与速度梯度耦合时，如何系统性地扭曲测得的平面内速度。这个问题突显了在二维测量技术中考虑三维流动效应的重要性。[@problem_id:510794]", "problem": "**背景：**在平面粒子图像测速技术 (PIV) 中，一片薄薄的激光片光照亮流体中的示踪粒子。通过在很短的时间间隔 $\\Delta t$ 内捕获粒子的两幅图像，可以测量出平面内的速度场。一个已知的测量误差来源是由于离面速度分量导致的“粒子对丢失”，这会导致粒子在两次图像采集之间移出有限厚度的激光片光区域。如果离面方向存在速度梯度，这种效应会导致测量速度出现统计偏差。\n\n**问题：**考虑在 $x-y$ 平面对一个稳定的三维流场进行平面 PIV 测量。激光片光的厚度均匀，为 $\\Delta z_L$，且中心位于 $z=0$。假设在 $|z| \\le \\Delta z_L/2$ 范围内光照强度恒定，在其它区域为零。流场中播撒了浓度均匀的示踪粒子。速度场由下式给出：\n$$ \\vec{V}(x, y, z) = (U_0 + \\alpha z) \\hat{\\imath} + V_0 \\hat{\\jmath} + W_0 \\hat{k} $$\n其中 $U_0$、$V_0$、$W_0$ 和 $\\alpha$ 是常数。PIV 测量中两幅图像之间的时间间隔为 $\\Delta t$。假设粒子的离面位移小于片光厚度，即 $|W_0| \\Delta t  \\Delta z_L$，这确保了有一部分粒子在两次曝光中都停留在激光片光内。\n\nPIV 算法实际上计算的是在第一次和第二次曝光时都位于激光片光内的那部分粒子的平均速度。$x$ 方向的真实平均速度 $U_{\\rm true}$ 是在任意时刻，速度的 $x$ 分量在整个激光片光厚度上的空间平均值。测量速度 $\\hat{U}$ 是在两次成像中都保留在片光内的粒子子群的平均速度。\n\n推导速度 $x$ 分量的偏差误差表达式，其定义为 $\\epsilon_U = \\hat{U} - U_{\\rm true}$。", "solution": "我们有一个三维稳态流场\n$$\\vec V(x,y,z)=(U_0+\\alpha z)\\,\\hat\\imath+V_0\\,\\hat\\jmath+W_0\\,\\hat k$$\n和一个厚度均匀为 $\\Delta z_L$、中心在 $z=0$ 的激光片光。初始位置为 $z_0\\in[-\\tfrac{\\Delta z_L}{2},\\tfrac{\\Delta z_L}{2}]$ 的粒子在时间 0 被照亮。在两次曝光之间，它们的位移为\n$$\\delta z=W_0\\,\\Delta t\\,. $$\n要被成像两次，粒子必须满足\n$$z_0\\in[-\\tfrac{\\Delta z_L}{2},\\tfrac{\\Delta z_L}{2}]\\cap[-\\tfrac{\\Delta z_L}{2}-\\delta z,\\tfrac{\\Delta z_L}{2}-\\delta z]\\,. $$\n可以发现，这个交集是一个长度为 $L_s=\\Delta z_L-|\\delta z|$ 的区间，其端点关于 $z=-\\delta z/2$ 对称。\n\n1. 片光内的真实平均速度：\n$$U_{\\rm true}=\\frac1{\\Delta z_L}\\int_{-\\Delta z_L/2}^{\\Delta z_L/2}(U_0+\\alpha z)\\,dz\n=U_0\\,. $$\n\n2. 对存活粒子的测量平均值：它们占据的 z 坐标区间为 $z\\in[z_1,z_2]$，其中 $z_1+z_2=-\\delta z$，所以它们的平均 z 坐标为\n$$\\langle z\\rangle=\\frac{z_1+z_2}2=-\\frac{\\delta z}2\\,. $$\n因此\n$$\\hat U=U_0+\\alpha\\,\\langle z\\rangle\n=U_0-\\frac{\\alpha\\,\\delta z}2\n=U_0-\\frac{\\alpha\\,W_0\\,\\Delta t}2\\,. $$\n\n3. 因此，偏差误差为\n$$\\epsilon_U=\\hat U-U_{\\rm true}\n=-\\frac{\\alpha\\,W_0\\,\\Delta t}2\\,. $$", "answer": "$$\\boxed{-\\frac{\\alpha\\,W_0\\,\\Delta t}{2}}$$", "id": "510794"}, {"introduction": "我们的实践将从分析 PIV 误差转向一个建设性的过程：从二维投影图像重建三维流场，这是层析 PIV 的基石。本练习深入探讨了同步代数重建技术（SART），一种功能强大的迭代算法。我们将推导其核心更新规则，以理解如何从投影数据中逐步重建三维体数据，并考虑非负性等物理约束。[@problem_id:510851]", "problem": "在层析流动可视化技术中，例如层析粒子图像测速技术（Tomo-PIV），其目标是从一组二维投影图像中重建一个三维标量场。这个问题通常被表述为一个大型线性方程组 $\\mathbf{p} = \\mathbf{Wf}$，其中 $\\mathbf{f}$ 是未知体素值的向量，$\\mathbf{p}$ 是测得的投影数据的向量，$\\mathbf{W}$ 是投影矩阵。同步代数重建技术（SART）是用于求解该方程组的一种迭代算法。\n\n设 $f_j$ 为第 $j$ 个体素的标量值（$j=1, \\dots, N$），$p_i$ 为第 $i$ 条投影射线的测量积分值（$i=1, \\dots, M$）。矩阵元素 $w_{ij} \\ge 0$ 表示体素 $j$ 对射线 $i$ 的贡献；如果射线不穿过该体素，则 $w_{ij}$ 为零。SART 算法通过迭代来优化体素值的估计，第 $k$ 次迭代时的估计值记为 $f_j^{(k)}$。\n\n在第 $k+1$ 次迭代中对给定体素 $f_j$ 的更新由以下两个主要步骤导出：\n1.  **修正计算**：对于每条射线 $i$，计算其投影误差。该误差是测量投影 $p_i$ 与当前估计值的前向投影 $\\sum_{n=1}^N w_{in}f_n^{(k)}$ 之间的差值。然后，将此误差除以该射线上所有权重的总和 $\\sum_{n=1}^N w_{in}$ 进行归一化，以得到该射线的平均修正项。我们假设对于每条射线 $i$，至少存在一个体素 $n$ 使得 $w_{in}  0$。\n2.  **反投影**：体素 $j$ 的修正是所有穿过它的射线的修正项的加权和。每条射线的修正对该体素的贡献由其对应的矩阵元素 $w_{ij}$ 加权。这个聚合的修正量随后通过与体素 $j$ 相关的所有权重的总和（即 $\\sum_{i=1}^M w_{ij}$）进行归一化。将结果乘以一个松弛参数 $\\lambda$ 后，加到当前的体素值 $f_j^{(k)}$ 上。我们假设对于每个体素 $j$，至少存在一条射线 $i$ 使得 $w_{ij}  0$。\n\n在许多物理应用中，标量场 $f_j$ 代表一个非负量（例如密度、浓度）。为了施加这种物理约束，在每个更新步骤之后，会应用一个非负投影算子 $\\mathcal{P}_+(x) = \\max(0, x)$。\n\n使用包含此非负约束的 SART 算法，推导体素值 $f_j^{(k+1)}$ 的完整迭代更新规则。将结果表示为以 $f_j^{(k)}$、$p_i$、$w_{ij}$ 和 $\\lambda$ 表示的 $f_j^{(k+1)}$ 的单个方程。", "solution": "1. 射线 $i$ 的修正：\n\n$$\ne_i^{(k)} \\;=\\;\\frac{p_i \\;-\\;\\displaystyle\\sum_{n=1}^N w_{in}\\,f_n^{(k)}}{\\displaystyle\\sum_{n=1}^N w_{in}}.\n$$\n\n2. 体素 $j$ 的反投影修正：\n\n$$\nc_j^{(k)} \\;=\\;\\frac{\\displaystyle\\sum_{i=1}^M w_{ij}\\,e_i^{(k)}}{\\displaystyle\\sum_{i=1}^M w_{ij}}\n\\;=\\;\\frac{\\displaystyle\\sum_{i=1}^M w_{ij}\\,\\frac{p_i-\\sum_{n=1}^N w_{in}f_n^{(k)}}{\\sum_{n=1}^N w_{in}}}{\\displaystyle\\sum_{i=1}^M w_{ij}}.\n$$\n\n3. 带有松弛参数 $\\lambda$ 和非负性约束的 SART 更新：\n\n$$\nf_j^{(k+1)}\n=\\mathcal{P}_+\\!\\Bigl(f_j^{(k)}+\\lambda\\,c_j^{(k)}\\Bigr)\n=\\max\\!\\Bigl(0,\\;f_j^{(k)}+\\lambda\\,\\frac{\\sum_{i=1}^M w_{ij}\\,\\frac{p_i-\\sum_{n=1}^N w_{in}f_n^{(k)}}{\\sum_{n=1}^N w_{in}}}{\\sum_{i=1}^M w_{ij}}\\Bigr).\n$$", "answer": "$$\\boxed{f_j^{(k+1)}=\\max\\Bigl(0,\\;f_j^{(k)}+\\lambda\\,\\frac{\\sum_{i=1}^M w_{ij}\\,\\frac{p_i-\\sum_{n=1}^N w_{in}f_n^{(k)}}{\\sum_{n=1}^N w_{in}}}{\\sum_{i=1}^M w_{ij}}\\Bigr)}$$", "id": "510851"}]}