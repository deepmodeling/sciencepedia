## 引言
当声波的波长远小于其传播环境的特征尺度时，求解完整的[波动方程](@entry_id:139839)往往变得异常复杂且不必要。[几何声学](@entry_id:188385)作为一种强大的[高频近似](@entry_id:750288)方法应运而生，它将复杂的波动问题简化为更直观的射线追踪模型，为理解和预测声能的传播路径提供了深刻的见解。本文旨在系统地介绍[几何声学](@entry_id:188385)的理论框架及其广泛应用。

在接下来的内容中，我们将分三个章节展开探讨。在“原理与机制”一章中，我们将从波动[声学](@entry_id:265335)的第一性原理出发，推导出[几何声学](@entry_id:188385)的核心控制方程——程函方程与输运方程，并阐明声线与波阵面的基本几何关系。随后，在“应用与跨学科联系”一章中，我们将展示这些理论如何应用于[声学](@entry_id:265335)聚焦、海洋与大气[声学](@entry_id:265335)以及与广义相对论等前沿物理领域的交叉。最后，“动手实践”部分将通过具体问题，引导读者应用所学知识解决实际的[声线追踪](@entry_id:203094)与散射问题。

现在，让我们首先深入探讨构成[几何声学](@entry_id:188385)基础的物理原理与数学机制。

## 原理与机制

在理解了为何以及何时可以使用[几何声学](@entry_id:188385)的近似方法之后，我们现在转向其数学和物理基础。本章的目标是从波动[声学](@entry_id:265335)的基本方程出发，系统地推导出[几何声学](@entry_id:188385)的核心控制方程。我们将探讨这些方程的物理解释，揭示声线、[波阵面](@entry_id:197956)和振幅之间的几何关系。此外，我们还将此框架扩展到更复杂的场景，如运动介质和耗散流体中的声传播，从而为[几何声学](@entry_id:188385)提供一个坚实而全面的理论基础。

### [几何声学](@entry_id:188385)的控制方程

[几何声学](@entry_id:188385)的理论框架建立在两个基本方程之上：描述波相位传播的**程函方程 (Eikonal Equation)** 和描述波振幅变化的**[输运方程](@entry_id:756133) (Transport Equation)**。这两个方程都可以作为波动方程在高频极限下的近似而导出。

#### 程函方程

考虑一个均匀、各向同性、无耗散的介质，其中的[声学](@entry_id:265335)[标量势](@entry_id:276177) $\phi(\mathbf{x}, t)$ 满足标量波动方程：
$$
\nabla^2 \phi - \frac{1}{c^2} \frac{\partial^2 \phi}{\partial t^2} = 0
$$
其中 $c$ 是介质中恒定的声速。

[几何声学](@entry_id:188385)处理的是波长远小于介质特性变化尺度的极限情况。在这种情况下，波的行为可以被看作是沿着“射线”传播的。波的一个关键特征是**[波阵面](@entry_id:197956) (wavefront)**，即相位的[等值面](@entry_id:196027)。我们可以将一个尖锐的波阵面数学地描述为一个移动的间断[曲面](@entry_id:267450)，其位置由方程 $t = T(\mathbf{x})$ 给出。这里的函数 $T(\mathbf{x})$ 被称为**程函 (eikonal)** 或传播时间函数。

为了从波动方程推导出程函方程，我们可以寻找一种在[波阵面](@entry_id:197956) $t=T(\mathbf{x})$ 上具有奇异性的解。一个典型的模型是假设解的形式为：
$$
\phi(\mathbf{x}, t) = A(\mathbf{x}) H(t - T(\mathbf{x}))
$$
其中 $A(\mathbf{x})$ 是一个空间上缓变的振幅函数，而 $H(\xi)$ 是亥维赛德[阶跃函数](@entry_id:159192) (Heaviside step function)。这个解代表一个振幅为 $A(\mathbf{x})$ 的阶跃信号，其锋面在时刻 $t$ 到达位置 $\mathbf{x}$。

将此解代入波动方程，我们需要计算 $\phi$ 的[二阶导数](@entry_id:144508)。利用链式法则以及亥维赛德函数的导数是狄拉克 $\delta$ 函数 ($\frac{d H}{d\xi} = \delta(\xi)$) 及其导数 $\delta'(\xi)$ 的性质，我们可以得到：
$$
\frac{\partial^2\phi}{\partial t^2} = A(\mathbf{x})\,\delta'\bigl(t-T(\mathbf{x})\bigr)
$$
$$
\nabla^2\phi = (\nabla^2A) H - 2 \nabla A \cdot \nabla T \delta + A (\nabla T)^2 \delta' - A (\nabla^2 T) \delta
$$
将这些导数代入波动方程，我们得到一个包含 $H$, $\delta$, 和 $\delta'$ 函数的方程。在高频极限下，占主导地位的是奇异性最强的项，即与 $\delta'$ 成比例的项。收集这些项，我们得到：
$$
A(\mathbf{x}) (\nabla T)^2 \delta'\bigl(t-T(\mathbf{x})\bigr) - \frac{1}{c^2} A(\mathbf{x}) \delta'\bigl(t-T(\mathbf{x})\bigr) = 0
$$
为了使这个方程对任意非零振幅 $A(\mathbf{x})$ 都成立，括号内的系数必须为零。这就给出了程函方程 [@problem_id:547733]：
$$
(\nabla T)^2 = \nabla T \cdot \nabla T = \frac{1}{c^2}
$$
这个[非线性偏微分方程](@entry_id:169481)是[几何声学](@entry_id:188385)的基础。它将[波的传播](@entry_id:144063)时间 $T(\mathbf{x})$ 与介质的声速 $c$ 直接联系起来。如果介质非均匀，声速 $c$ 变为位置的函数 $c(\mathbf{x})$，程函方程的形式保持不变。通常，我们定义**[折射率](@entry_id:168910) (refractive index)** $n(\mathbf{x}) = c_0/c(\mathbf{x})$ (其中 $c_0$ 是一个参考声速)，以及**慢度矢量 (slowness vector)** $\mathbf{p} = \nabla T$。于是，程函方程可以写为 $|\mathbf{p}|^2 = n^2(\mathbf{x})$。

#### [输运方程](@entry_id:756133)

程函方程描述了[波的相位](@entry_id:171303)演化，但没有提供关于振幅 $A(\mathbf{x})$ 的信息。振幅的变化由[能量守恒](@entry_id:140514)定律决定，这引出了输运方程。

对于频率为 $\omega$ 的谐波，声学[速度势](@entry_id:262992)可以写为 $\phi(\mathbf{x}, t) = \text{Re}[ A(\mathbf{x}) e^{i(k_0 S(\mathbf{x}) - \omega t)} ]$，其中 $S(\mathbf{x})$ 是程函（有时也称为相[位函数](@entry_id:176105)），$k_0 = \omega/c_0$ 是波数。在静止、均匀、无粘性的流体中，[时间平均](@entry_id:267915)的声能强度矢量（能流密度）$\mathbf{I}$ 由 $\mathbf{I} = \langle p \mathbf{v} \rangle$ 给出，其中 $p = -\rho_0 \frac{\partial \phi}{\partial t}$ 是声压，$\mathbf{v} = \nabla\phi$ 是[质点](@entry_id:186768)速度。

在[高频近似](@entry_id:750288)下（$k_0$ 很大），$\nabla \phi \approx i k_0 A (\nabla S) e^{i(k_0S - \omega t)}$，而 $\nabla A$ 项被忽略。计算声压和质点速度的[复振幅](@entry_id:164138)，然后求其[时间平均](@entry_id:267915)的乘积，我们得到强度矢量：
$$
\mathbf{I} = \frac{1}{2} \text{Re}\{p_c \mathbf{v}_c^*\} = \frac{1}{2} \rho_0 \omega k_0 A^2 \nabla S
$$
对于[稳态](@entry_id:182458)声场，没有能量的源或汇，[能量流](@entry_id:142770)的发散必须为零，即 $\nabla \cdot \mathbf{I} = 0$。由于 $\rho_0, \omega, k_0$ 是常数，这直接导出了**[输运方程](@entry_id:756133)** [@problem_id:547698]：
$$
\nabla \cdot (A^2 \nabla S) = 0
$$
这个方程表明，量 $A^2 \nabla S$ 是一个无散度的矢量场。它描述了声能是如何沿着声线传播并[分布](@entry_id:182848)的，从而决定了声振幅在空间中的变化。

### 声线轨迹与波阵面几何

程函方程和[输运方程](@entry_id:756133)共同构成了[几何声学](@entry_id:188385)的数学框架。它们的核心概念是**声线 (rays)** 和[波阵面](@entry_id:197956)，这两者具有深刻的几何关系。

波阵面被定义为相位的[等值面](@entry_id:196027)，即 $S(\mathbf{x}) = \text{const}$。根据程函方程 $(\nabla S)^2 = n^2$，梯度矢量 $\nabla S$ 的模长等于[折射率](@entry_id:168910) $n$。声线则被定义为与 $\nabla S$ 相切的[积分曲线](@entry_id:161858)，即声能传播的路径。因此，声线的方向由 $\nabla S$ 给出。

一个基本且重要的性质是**声线与波阵面处处正交**。这是因为 $\nabla S$ 作为一个[标量场的梯度](@entry_id:270765)，根据向量微积分的知识，它必然垂直于该标量场的[等值面](@entry_id:196027)，即波阵面。我们可以通过考虑声线方程 $d\mathbf{r}/ds = \nabla S / n$ 来更形式化地证明这一点，其中 $\mathbf{r}(s)$ 是由弧长 $s$ [参数化](@entry_id:272587)的声线路径。波阵面的切向量 $\mathbf{t}_w$ 满足 $\mathbf{t}_w \cdot \nabla S = 0$。由于声线的切向量 $\mathbf{t}_r = d\mathbf{r}/ds$ 与 $\nabla S$平行，因此 $\mathbf{t}_r \cdot \mathbf{t}_w = 0$。这证实了声线与波阵面在每一点都是正交的 [@problem_id:547679]。

输运方程 $\nabla \cdot (A^2 \nabla S) = 0$ 的物理解释是声能[流管](@entry_id:182650)中的[能量守恒](@entry_id:140514)。考虑一个由一束相邻声线构成的无限小**声线管 (ray tube)**。由于声线不会交叉（除了在[焦点](@entry_id:174388)或[焦散面](@entry_id:158966)上），能量被限制在管内。方程表明，穿过声线管任意[截面](@entry_id:154995)的总能量通量是恒定的。如果声线管的[截面](@entry_id:154995)积为 $d\sigma$，那么 $I \cdot d\sigma$ 是常数。由于 $I \propto A^2$，这意味着 $A^2 d\sigma = \text{const}$，或者说 $A \propto 1/\sqrt{d\sigma}$。因此，声振幅的变化与声线管[截面](@entry_id:154995)积的平方根成反比。当声线汇聚时，[截面](@entry_id:154995)积减小，振幅增大；当声线发散时，[截面](@entry_id:154995)积增大，振幅减小。

振幅的变化可以通过波阵面的几何形状来更精确地量化。波阵面是一个二维[曲面](@entry_id:267450)，其局部几何可以用两个**主曲率半径** $R_1$ 和 $R_2$ 来描述。在一个均匀介质中，声线是直线。从初始位置 $s=0$ 处的[波阵面](@entry_id:197956)（主曲率半径为 $R_1$ 和 $R_2$）传播距离 $s$ 后，新的波阵面的主曲率半径变为 $R_{1,s} = R_1+s$ 和 $R_{2,s} = R_2+s$。声线管的[截面](@entry_id:154995)积正比于一个称为**几何扩展因子** $\mathcal{J}(s)$ 的平方，其定义为：
$$
\mathcal{J}(s) = \sqrt{\left(1 + \frac{s}{R_1}\right) \left(1 + \frac{s}{R_2}\right)}
$$
振幅 $A(s)$ 与此因子成反比，$A(s) = A(0) / \mathcal{J}(s)$。可以证明，几何扩展因子 $\mathcal{J}(s)$ 满足一个[二阶常微分方程](@entry_id:204212)，该方程仅依赖于波阵面在位置 $s$ 处的局部几何特性：**平均曲率** $K(s) = \frac{1}{2}(\frac{1}{R_{1,s}} + \frac{1}{R_{2,s}})$ 和**高斯曲率** $G(s) = \frac{1}{R_{1,s}R_{2,s}}$。
当几何扩展因子 $\mathcal{J}(s)$ 变为零时，[几何声学](@entry_id:188385)预测振幅将趋于无穷大。发生这种情况的点或线的集合称为**[焦散面](@entry_id:158966) (caustics)**。[焦散面](@entry_id:158966)是相邻声线的[包络线](@entry_id:174062)，代表声能高度集中的区域。例如，当声波从一个圆形[反射器](@entry_id:754193)的圆周上的一点发出时，反射声线的[包络线](@entry_id:174062)形成一个[心形线](@entry_id:162600)[焦散面](@entry_id:158966) [@problem_id:547693]。在[焦散面](@entry_id:158966)附近，[几何声学](@entry_id:188385)的近似失效，需要更精确的[波动理论](@entry_id:180588)来描述场。

### 哈密顿射线追踪

对于在[复杂介质](@entry_id:164088)（如非均匀、各向异性或运动的介质）中传播的声波，直接求解程函方程可能非常困难。一个更强大和通用的方法是**哈密顿射线追踪 (Hamiltonian ray tracing)**。这种方法源于光学和经典力学，将射线追踪问题表述为一个[哈密顿系统](@entry_id:143533)。

该方法的核心是**[哈密顿量](@entry_id:172864) (Hamiltonian)** $H(\mathbf{x}, \mathbf{p})$，它通常由介质的[色散关系](@entry_id:140395)给出。在这里，$\mathbf{x}$ 是位置矢量，$\mathbf{p}$ 是慢度矢量（在力学中类比于动量）。声线的演化由**哈密顿方程**决定：
$$
\frac{d\mathbf{x}}{ds} = \nabla_{\mathbf{p}} H, \quad \frac{d\mathbf{p}}{ds} = - \nabla_{\mathbf{x}} H
$$
其中 $s$ 是沿射线的某个参数（如[弧长](@entry_id:191173)或时间）。第一个方程定义了群速度（[能量传播](@entry_id:202589)方向），第二个方程描述了慢度矢量（波传播方向）如何因介质的不[均匀性](@entry_id:152612)而改变。

哈密顿形式化的一个巨大优势在于它与[守恒定律](@entry_id:269268)的深刻联系。根据诺特定理，如果[哈密顿量](@entry_id:172864)在某个坐标变换下保持不变（即具有某种对称性），那么就存在一个沿着射线路径守恒的量。例如，在一个具有[轴对称](@entry_id:173333)性的[横向各向同性](@entry_id:756140)介质中，其物理性质仅依赖于离[对称轴](@entry_id:177299)的径向距离 $\rho$ 和轴向坐标 $z$。其[哈密顿量](@entry_id:172864)可以写为 $H = \frac{1}{2}(A(\rho,z)(p_1^2+p_2^2) + B(\rho,z)p_3^2 - 1)$。由于[哈密顿量](@entry_id:172864)不显式依赖于方位角，可以推导出与该对称性相关的角动量分量 $L_z = x_1 p_2 - x_2 p_1$ 是守恒的 [@problem_id:547747]。这个[守恒量](@entry_id:150267)极大地简化了射线轨迹的计算。

### 在运动介质中的传播

当背景流体本身在运动时，声波的传播会受到[对流](@entry_id:141806)效应的影响。这在航空[声学](@entry_id:265335)和海洋声学等领域至关重要。

对于在以[速度场](@entry_id:271461) $\mathbf{v}(\mathbf{r})$ 运动的流体中传播的声波，其色散关系（即[哈密顿量](@entry_id:172864)）由[多普勒频移](@entry_id:158041)修正：
$$
\omega = H(\mathbf{r}, \mathbf{k}) = c(\mathbf{r})|\mathbf{k}| + \mathbf{v}(\mathbf{r}) \cdot \mathbf{k}
$$
这里我们使用[波数](@entry_id:172452)矢量 $\mathbf{k}$ 代替慢度矢量 $\mathbf{p}$。两者关系为 $\mathbf{k}=\omega \mathbf{p}$。

波包（能量）的[传播速度](@entry_id:189384)由**[群速度](@entry_id:147686) (group velocity)** $\mathbf{c}_g$ 给出，定义为 $\mathbf{c}_g = \nabla_{\mathbf{k}} \omega$。对于均匀流动 $\mathbf{v}=\mathbf{U}$ 且声速恒为 $c_0$ 的情况，群速度的计算结果为 [@problem_id:547766]：
$$
\mathbf{c}_g = \mathbf{U} + c_0 \frac{\mathbf{k}}{|\mathbf{k}|}
$$
这个表达式直观地表明，声能的传播速度是背景流速与相对于流体以声速 $c_0$ 沿波数矢量方向传播的速度之和。

当声波遇到两种不同介质的交界面时，会发生折射和反射。如果介质在运动，[斯涅尔定律](@entry_id:162003) (Snell's law) 需要修正。其推导基于在界面上相位匹配的边界条件，即频率 $\omega$ 和平行于界面的波数分量 $k_x$ 必须连续。考虑一个位于 $z=0$ 的平面，分隔两个分别以速度 $U_1\hat{\mathbf{x}}$ 和 $U_2\hat{\mathbf{x}}$ 运动的流体。利用各自的[色散关系](@entry_id:140395)和边界条件，可以推导出广义斯涅尔定律 [@problem_id:547721]：
$$
\sin(\theta_r) = \frac{c_2 \sin(\theta_i)}{c_1 + (U_1 - U_2) \sin(\theta_i)}
$$
其中 $\theta_i$ 和 $\theta_r$ 分别是入射角和折射角。此式表明，流速差会改变折射角。

哈密顿框架同样适用于复杂的运动介质。考虑一个以恒定[角速度](@entry_id:192539) $\mathbf{\Omega}$ 作刚体旋转的流体，其[速度场](@entry_id:271461)为 $\mathbf{v}(\mathbf{r}) = \mathbf{\Omega} \times \mathbf{r}$。即使声速 $c_0$ 恒定，该介质也是非均匀的（因为速度场依赖于位置）。应用哈密顿方程 $d\mathbf{k}/dt = -\nabla_{\mathbf{r}} H$，我们可以分析[波数](@entry_id:172452)矢量 $\mathbf{k}$ 的演化。一个有趣的结果是，在这种[旋转流](@entry_id:276737)中，[波数](@entry_id:172452)矢量的大小 $|\mathbf{k}|$ 沿着射线路径是守恒的，即 $d|\mathbf{k}|/dt = 0$ [@problem_id:547706]。这意味着尽管射线路径会因为流体的[涡旋运动](@entry_id:198769)而弯曲，但声波的波长保持不变。

### 耗散效应与衰减

到目前为止，我们都假设介质是理想的，即无粘性和无[热传导](@entry_id:147831)。在真实流体中，这些**耗散效应 (dissipative effects)** 会将声能转化为内能，导致声波振幅随传播距离而衰减。

这种衰减可以通过在[波动方程](@entry_id:139839)中引入与粘度和热导率相关的项来建模。对于频率为 $\omega$ 的平面[谐波](@entry_id:181533) $e^{i(kx - \omega t)}$，耗散效应使得[波数](@entry_id:172452) $k$ 变为一个复数：$k = k_R + i\alpha$。实部 $k_R$ 与相速度有关，而虚部 $\alpha$ 是**衰减系数 (attenuation coefficient)**。波的振幅项变为 $e^{-\alpha x}$，表明振幅随距离 $x$ 指数衰减。

假设耗散效应很弱（即粘度系数 $\mu$、$\mu_b$ 以及热导率 $\kappa$ 很小），我们可以从线性的[Navier-Stokes方程](@entry_id:161487)、连续性方程和能量方程出发，通过[微扰分析](@entry_id:178808)推导出衰减系数 $\alpha$ 的表达式。对于一维[纵波](@entry_id:172335)，结果为 [@problem_id:547697]：
$$
\alpha = \frac{\omega^2}{2\rho_0 c_0^3} \left( \frac{4}{3}\mu + \mu_b + \kappa \left( \frac{1}{C_v} - \frac{1}{C_p} \right) \right)
$$
其中 $\rho_0$ 是平衡密度，$c_0$ 是[绝热声速](@entry_id:204352)，$\mu$ 和 $\mu_b$ 分别是[剪切粘度](@entry_id:141046)系数和体粘度系数，$C_v$ 和 $C_p$ 是定容和定[压比](@entry_id:137698)热。

这个公式揭示了衰减的几个关键特征：
1.  **频率依赖性**：衰减系数与频率的平方 $\omega^2$ 成正比。这意味着高频声波比低频声波衰减得快得多。这也是[几何声学](@entry_id:188385)作为[高频近似](@entry_id:750288)的另一个侧面：在极高频率下，衰减可能变得非常显著，从而限制了其适用范围。
2.  **物理来源**：衰减由三部分贡献：由[剪切粘度](@entry_id:141046)引起的损失（$\frac{4}{3}\mu$ 项）、由体粘度（与分子内部弛豫过程有关）引起的损失（$\mu_b$ 项），以及由热传导引起的损失（$\kappa$ 项）。

将衰减效应纳入[几何声学](@entry_id:188385)框架，通常意味着在输运方程中增加一个能量耗散项，或者在计算振幅时乘以一个衰减因子 $e^{-\int \alpha ds}$。这使得[几何声学](@entry_id:188385)模型能够更准确地预测真实世界中的声传播。