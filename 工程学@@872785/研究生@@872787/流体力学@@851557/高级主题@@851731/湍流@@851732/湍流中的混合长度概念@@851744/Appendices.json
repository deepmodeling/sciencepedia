{"hands_on_practices": [{"introduction": "正确应用一个物理模型不仅需要了解其基本公式，更要深刻理解其背后的物理假设和数学约束。本练习探讨了混合长度模型在一个经典场景——圆管内的轴对称湍流——中的一个关键边界条件。通过分析为何混合长度在管道中心线必须为零，本练习促使我们深入思考对称性对湍流输运的运动学限制，这是精确建立模型不可或缺的一环。[@problem_id:1812839]", "problem": "在流体力学研究中，零方程湍流模型提供了一种简化的方法来估算湍流效应，而无需求解额外的输运方程。其中最早、最著名的模型之一是Prandtl的混合长度模型。该模型用于近似计算流场中的湍流切应力 $\\tau_t$。考虑一个在半径为 $R$ 的长直圆形管道中流动的充分发展的、不可压缩的、轴对称的湍流。\n\n混合长度 $\\ell_m$ 的物理解释是：一个相干的流体团（一个“涡”）在与周围流体混合并失去其独特动量之前，所行进的平均横向距离。对于管道中的轴对称流，该模型的一个基本要求是混合长度 $\\ell_m$ 在管道中心线处（即径向位置 $r=0$ 处）必须为零。\n\n下列哪个陈述为这一要求提供了最准确、最基本的物理解释？\n\nA. 管道壁面（$r=R$）处的无滑移条件规定了该处的速度为零，这个边界条件迫使速度梯度以及因此混合长度在中心线处也为零。\n\nB. 由于轴对称性，动量不能净穿过中心线。这意味着负责湍流混合的横向速度脉动在 $r=0$ 处必须为零，从而在运动学上阻止了涡旋穿过中心线，因此迫使其特征行进距离（混合长度）为零。\n\nC. 平均速度剖面在中心线处达到最大值。微积分规定，任何光滑函数在其最大值处的一阶导数必须为零，因此平均速度梯度在 $r=0$ 处为零，这反过来又要求混合长度为零。\n\nD. 在管道中心线处，粘性切应力达到最大值，超过了任何湍流效应。由于混合长度模型只描述湍流，因此在粘性效应完全占主导地位的地方，混合长度必须设置为零。\n\nE. 对于轴对称流，在任何给定的径向截面上压力是恒定的。没有径向压力梯度意味着没有力来驱动湍流涡旋穿过中心线，因此混合长度必须为零。", "solution": "对于圆形管道中充分发展的、不可压缩的、轴对称的湍流，平均轴向速度为 $U(r)$，相关的切应力分量为\n$$\n\\tau_{rz}(r)= -\\rho\\,\\overline{u'v_r'}+\\mu \\frac{dU}{dr}.\n$$\n在充分发展的管流中，总切应力随 $r$ 线性变化并满足\n$$\n\\tau_{rz}(r)=-\\frac{r}{2}\\frac{dp}{dz},\n$$\n因此 $\\tau_{rz}(0)=0$。在Prandtl的混合长度模型中，湍流切应力被封闭为\n$$\n\\tau_{t} \\equiv -\\rho\\,\\overline{u'v_r'}=\\rho\\,\\ell_{m}^{2}\\left|\\frac{dU}{dr}\\right|\\frac{dU}{dr}.\n$$\n因为中心线是一个对称点，平均速度 $U(r)$ 在该处达到最大值，所以\n$$\n\\left.\\frac{dU}{dr}\\right|_{r=0}=0.\n$$\n这立即得出 $\\tau_{t}(0)=0$，而与 $\\ell_{m}(0)$ 的值无关。因此，$r=0$ 处平均梯度的消失本身并不要求 $\\ell_{m}(0)=0$，所以仅仅引用 $\\frac{dU}{dr}(0)=0$（如陈述C）并不是一个充分或根本的原因。\n\n要确定 $\\ell_{m}$ 在轴线上的行为，必须使用由轴对称性和速度场在 $r=0$ 处的正则性所蕴含的运动学。设 $(u,v_r)$ 表示瞬时速度脉动的轴向和径向分量，其中 $v_r$ 是横向（径向）分量。在柱坐标系中，径向分量是 $v_r=v_x \\cos\\theta+v_y\\sin\\theta$，其中 $(v_x,v_y)$ 是垂直于管道轴线的平面中的笛卡尔分量，$\\theta$ 是极角。对于一个光滑、单值的速度场，$v_r$ 在 $r\\to 0$ 时的极限必须与 $\\theta$ 无关。对于任意 $\\theta$ 这都能成立的唯一方式是\n$$\nv_r(0)=0.\n$$\n因此，根据对称性和正则性，瞬时横向（径向）速度脉动在中心线处精确地消失，所以通过中心线的湍流输运在 $r=0$ 处是运动学上被禁止的。特别地，\n$$\n\\overline{u'v_r'}(0)=0,\n$$\n这反映了没有横向输运穿过轴线。\n\nPrandtl的混合长度 $\\ell_{m}$ 是一个涡（一个相干的流体团）在失去其特性并混合之前可以行进的特征横向距离。在 $r=0$ 处，由于轴对称性引起的运动学约束， $v_r'$ 精确地为 0，因此涡无法穿过中心线；其在该处的特征横向行进距离因此必须为零：\n$$\n\\ell_{m}(0)=0.\n$$\n这个论证是该要求的基本物理解释。相比之下：(A) 错误地将中心线的行为归因于壁面的无滑移条件；(C) 将由于 $\\frac{dU}{dr}(0)=0$ 导致的 $\\tau_{t}(0)=0$ 与对 $\\ell_{m}$ 的独立要求混淆；(D) 是错误的，因为粘性切应力在中心线处实际上为零；(E) 错误地将湍流输运归因于径向压力，而这并非湍流混合的机制。\n\n因此，最准确和最根本的原因是轴对称性施加的运动学约束，该约束禁止了轴线上的横向脉动和输运，从而迫使 $\\ell_{m}(0)=0$。", "answer": "$$\\boxed{B}$$", "id": "1812839"}, {"introduction": "在掌握了混合长度模型的基本应用之后，批判性地审视其局限性是通向更高级湍流理论的关键一步。任何模型都有其适用范围，而本练习旨在揭示代数混合长度模型的一个根本性弱点。通过一个全局非定常流动（振荡平板）的假设情景，我们探究为何一个不包含时间演化项的模型无法捕捉湍流的“记忆效应”，从而在处理快速变化的流动时失效。[@problem_id:1774532]", "problem": "一位工程师正在研究一块完全浸没在密度为常数 $\\rho$、运动粘度为 $\\nu$ 的广阔、静止的不可压缩流体中的很大、很薄的平板所产生的湍流。该平板被迫在其自身平面内振荡，其速度由 $U(t) = U_0 \\sin(\\omega t)$ 描述，其中 $U_0$ 和 $\\omega$ 分别是振荡的速度幅值和角频率。经过初始瞬态阶段后，一个统计非定常的湍流边界层在平板上发展起来。\n\n该工程师尝试使用 Prandtl 的不随时变混合长度假设来模拟湍流切应力 $\\tau_{turb}(y, t)$。该模型通过以下表达式将湍流应力与平均速度梯度联系起来：\n$$\n\\tau_{turb}(y, t) = \\rho l_m^2 \\left| \\frac{\\partial \\bar{u}(y, t)}{\\partial y} \\right| \\frac{\\partial \\bar{u}(y, t)}{\\partial y}\n$$\n此处，$\\bar{u}(y, t)$ 是在时间 $t$、距离平板 $y$ 处的平均流体速度，而 $l_m$ 是混合长度，它被假设仅为位置 $y$ 的函数，而不是时间 $t$ 的函数。\n\n在将模型的预测结果与实验测量值进行比较后，该工程师发现模型表现不佳，在湍流应力的幅值和相位上都存在显著误差，尤其是在较高的振荡频率 $\\omega$ 下。\n\n以下哪个陈述为这种简单的混合长度模型在这种全局非定常流中的根本性失效提供了最准确的物理解释？\n\nA. 混合长度模型仅对可近似为无粘的流动有效，但振荡流具有一个占主导地位的粘性子层，这使得该模型从一开始就不适用。\n\nB. 振荡平板附近流体的快速加速和减速导致了显著的局部密度变化，这违反了推导混合长度模型时使用的不可压缩性假设。\n\nC. 该模型是代数模型，意味着湍流应力场对平均速度梯度的任何变化都会瞬时响应。它之所以失效，是因为湍流具有有限的特征时间尺度（“记忆”），其结构无法瞬时适应平均流的快速振荡。\n\nD. 模型的失效源于一个错误的假设，即用于定义近壁区混合长度（$l_m = \\kappa y$）的 von Kármán 常数 $\\kappa$ 是一个普适常数。对于振荡流，$\\kappa$ 会成为时间和频率的复函数。\n\nE. 混合长度假设要求流动方向上不存在平均压力梯度。振荡平板会引起一个强的、时变的压力梯度来驱动边界层流动，而该模型在这种条件下是已知的无效的。", "solution": "给定的封闭模型是 Prandtl 的代数混合长度模型，\n$$\n\\tau_{turb}(y,t)=\\rho l_{m}^{2}\\left|\\frac{\\partial \\bar{u}(y,t)}{\\partial y}\\right|\\frac{\\partial \\bar{u}(y,t)}{\\partial y}\n\\equiv -\\rho \\nu_{t}(y,t)\\frac{\\partial \\bar{u}(y,t)}{\\partial y},\\quad \\nu_{t}(y,t)=l_{m}^{2}\\left|\\frac{\\partial \\bar{u}}{\\partial y}\\right|.\n$$\n该封闭模型的关键特性是：\n- 它是代数的和时间局部的：$\\tau_{turb}(y,t)$ 仅取决于在同一 $(y,t)$ 处的平均剪切 $\\partial \\bar{u}/\\partial y$ 的瞬时局部值，没有时间导数或时间历史项。\n- 由于 $l_{m}=l_{m}(y)$，模型系数中没有显式的时间依赖性。\n\n在本问题中，强迫是非定常的：$U(t)=U_{0}\\sin(\\omega t)$，因此在瞬态过程之后，平均剪切 $\\bar{S}(y,t)\\equiv \\partial \\bar{u}/\\partial y$ 以频率 $\\omega$ 振荡，并具有某种空间结构。一个物理上一致的湍流响应必须考虑有限的涡调整时间：当平均应变振荡时，具有特征时间尺度 $T_{t}(y)$ 的含能涡无法瞬时重组。当 $\\omega T_{t}(y)\\gtrsim 1$ 时，会出现两种普遍效应：\n- 相对于准稳态预测，$\\tau_{turb}$ 的幅值衰减。\n- 由于有限的松弛时间，$\\tau_{turb}$ 和 $\\bar{S}$ 之间存在相位滞后。\n\n这些效应要求封闭模型具有时间上的“记忆”。例如，一个最小松弛模型，\n$$\n\\frac{\\partial \\tau_{turb}}{\\partial t}+\\frac{1}{T_{t}(y)}\\,\\tau_{turb}=-\\frac{\\rho \\nu_{t0}(y)}{T_{t}(y)}\\,\\bar{S},\n$$\n对于谐波强迫 $\\propto \\exp(i\\omega t)$，在频域中得出，\n$$\n\\hat{\\tau}_{turb}(y,\\omega)=-\\rho\\,\\frac{\\nu_{t0}(y)}{1+i\\omega T_{t}(y)}\\,\\hat{S}(y,\\omega),\n$$\n因此，有效涡粘度是复数的且依赖于频率，产生一个非零的相位滞后 $\\phi(y,\\omega)=\\arctan\\!\\big(\\omega T_{t}(y)\\big)$ 和一个因子为 $\\big(1+\\omega^{2}T_{t}^{2}\\big)^{-1/2}$ 的幅值衰减。相比之下，代数混合长度模型强制一个瞬时映射 $\\tau_{turb}(y,t)=f\\!\\left(\\bar{S}(y,t)\\right)$，其系数是实值的、瞬时的，因此无法产生任何相对于 $\\bar{S}$ 的内禀相位滞后，故而随着 $\\omega$ 的增加而根本性地失效。\n\n现在评估各个选项：\n- A 是不正确的：混合长度假设不局限于无粘流；它是一个用于粘性壁面有界流的湍流封闭模型。粘性子层的存在本身并不会使模型在全局上失效。\n- B 是不正确的：流动被说明是不可压缩的，密度 $\\rho$ 为常数；在低马赫数下，不可压缩液体中的快速加速并不意味着密度变化。\n- C 是正确的：混合长度模型的代数、瞬时性质忽略了湍流记忆和有限的调整时间，因此它无法捕捉在较高 $\\omega$ 下 $\\tau_{turb}$ 的幅值衰减和相位滞后。\n- D 在前提和解决方法上都是不正确的：虽然 $\\kappa$ 的精确普适性尚有争议，但让 $\\kappa$ 依赖于时间或成为“复数”并非根本问题；即使是一个时变的代数系数也仍然是瞬时的，无法表示记忆效应。\n- E 是不正确的：混合长度方法不要求零压力梯度；它经常应用于存在非零流向压力梯度的情况。此外，平面内振荡的平板主要施加的是非定常剪切，而不是一个驱动性的平均压力梯度。\n\n因此，根本性的失效在于代数混合长度模型缺乏时间非局部性（“记忆”），这与 C 中的陈述完全一致。", "answer": "$$\\boxed{C}$$", "id": "1774532"}, {"introduction": "在理解了模型的物理约束和理论局限后，我们将通过一个综合性的计算实践来巩固所学。本练习将指导您在一个混合长度模型表现良好的经典定常流动——平面槽道流——中，从第一性原理出发，完整地实现一个数值求解过程。您将推导控制方程，实施数值积分，并将计算出的速度剖面与经典的壁面律进行定量比较，这不仅能加深对模型实际应用的理解，也为后续更复杂的计算流体动力学（CFD）模拟奠定了基础。[@problem_id:2381390]", "problem": "实现一个完整的、可运行的程序，该程序使用代数混合长度模型计算平面槽道中的湍流平均速度剖面，并将其与壁面普适律进行定量比较。该槽道为平面、充分发展、稳态、不可压缩流动，流向坐标为 $x$，壁面法向坐标为 $y$。流动由恒定的平均压力梯度驱动，平均速度为 $U(y)$。\n\n使用的起点和模型假设：\n- 从针对平面槽道中稳态、充分发展的一维平均流简化的雷诺平均动量平衡（流向的雷诺平均纳维-斯托克斯 (RANS) 方程）开始。平均动量方程简化为恒定压力梯度与总剪切应力壁面法向梯度之间的平衡。\n- 引入针对雷诺剪切应力的 Boussinesq 涡粘性假设，总剪切应力可写为\n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\mu \\,\\frac{dU}{dy} \\;-\\; \\rho \\,\\overline{u'v'} \\;=\\; \\rho\\left(\\nu + \\nu_t\\right)\\,\\frac{dU}{dy},\n$$\n其中 $\\mu$ 是动力粘度，$\\rho$ 是密度，$\\nu=\\mu/\\rho$ 是运动粘度，$\\nu_t$ 是涡粘性。\n- 使用一个经过充分检验的事实：对于充分发展的平面槽道流，总剪切应力在半个槽道宽度上呈线性变化：\n$$\n\\tau_{\\text{tot}}(y) \\;=\\; \\tau_w\\left(1-\\frac{y}{\\delta}\\right),\n$$\n其中 $\\tau_w$ 是 $y=0$ 处的壁面剪切应力，$\\delta$ 是槽道半高。通过 $\\tau_w=\\rho\\,u_\\tau^2$ 定义摩擦速度 $u_\\tau$。\n- 采用带近壁面阻尼（van Driest）的 Prandtl 混合长度模型：\n$$\n\\nu_t \\;=\\; \\ell_m^2 \\left|\\frac{dU}{dy}\\right|,\\qquad \n\\ell_m \\;=\\; \\kappa\\, y \\left[1-\\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right],\\qquad\ny^+ \\;=\\; \\frac{y\\,u_\\tau}{\\nu},\n$$\n其中 $\\kappa$ 是 von Kármán 常数， $A^+$ 是 van Driest 阻尼常数， $y^+$ 是以壁面单位表示的壁面坐标。\n\n任务要求：\n1. 从上述基本陈述出发，推导平均剪切 $g(y)=dU/dy$ 与已知量 $\\nu$、$\\ell_m(y)$、$u_\\tau$ 和 $\\delta$ 之间的代数关系。您的推导必须消除压力梯度，转而使用槽道内的总应力分布。不要假设任何 $g(y)$ 的目标公式；应从给定的定义和平衡关系中明确推导。\n2. 使用您推导的 $g(y)$ 代数关系中符合物理意义的正值分支，并实现一个数值程序，通过对 $g(y)$ 在满足无滑移边界条件 $U(0)=0$ 的情况下进行积分，来获得 $y\\in[0,\\delta]$ 上的 $U(y)$。计算无量纲剖面 $y^+=y\\,u_\\tau/\\nu$ 和 $U^+=U/u_\\tau$。\n3. 将计算出的 $U^+(y^+)$ 与对数区中的壁面普适律进行比较：\n$$\nU^+_{\\log}(y^+) \\;=\\; \\frac{1}{\\kappa}\\,\\ln y^+ \\;+\\; B,\n$$\n其中 $\\kappa$ 和 $B$ 是光滑壁面的给定常数。在指定的对数层窗口内，使用均方根 (RMS) 差异来量化偏差。\n4. 对所有情况使用以下物理常数：运动粘度 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m}^2/\\mathrm{s}$，槽道半高 $\\delta = 0.05\\,\\mathrm{m}$，von Kármán 常数 $\\kappa = 0.41$，对数律截距 $B=5.2$，以及 van Driest 常数 $A^+=26$。对于每种情况，通过给定的摩擦雷诺数 $Re_\\tau$ 和公式 $Re_\\tau = u_\\tau\\,\\delta/\\nu$ 来确定 $u_\\tau$。\n5. 在区间 $y^+ \\in [30,\\; 0.3\\,Re_\\tau]$ 上计算 $U^+$ 和 $U^+_{\\log}$ 之间的均方根误差。如果该区间不包含任何网格点，则在可用网格中 $y^+$ 值最接近 $30$ 的单个网格点上评估绝对差，并将此值作为该情况下的均方根误差返回。\n\n数值实现要求：\n- 对于每种情况，在 $y$ 方向上使用一个包含 $N$ 个点的均匀网格，这些点包括 $y=0$ 处的壁面和 $y=\\delta$ 处的中心线。使用二阶精度的梯形法则对 $g(y)$ 进行积分以获得 $U(y)$。\n- 此问题不涉及角度；因此，不需要角度单位。\n- 所有报告的比较都必须是无量纲的；最终误差无需报告物理单位。\n- 程序不得读取任何输入，并且必须逐字使用以下测试套件。\n\n测试套件（按此确切顺序使用）：\n- 情况 1：$Re_\\tau = 180$, $N=1500$。\n- 情况 2：$Re_\\tau = 395$, $N=2000$。\n- 情况 3：$Re_\\tau = 1000$, $N=4000$。\n- 情况 4（对数区间非常小的边缘情况）：$Re_\\tau = 90$, $N=1500$。\n\n最终输出规格：\n- 您的程序必须生成单行输出，其中包含一个 Python 风格的列表，内含与上述四种情况相对应的四个均方根误差，顺序与上文相同。每个均方根误差必须是四舍五入到恰好三位小数的浮点数。打印的行必须采用\n`[e_1,e_2,e_3,e_4]`\n的格式，其中不能有任何空格。例如，一个有效的输出应类似于 `[0.123,0.456,0.789,1.234]`。", "solution": "该问题要求使用代数混合长度模型计算湍流平面槽道流中的平均速度剖面。解决方案包括推导平均速度梯度的表达式，对其进行数值积分，并将得到的无量纲速度剖面与壁面普适律进行比较。\n\n起点是用于稳态、充分发展槽道流的雷诺平均动量方程，该方程可简化为平均压力梯度与总剪切应力 $\\tau_{\\text{tot}}$ 梯度之间的平衡。问题给出了总应力在槽道半高 $\\delta$ 上的线性剖面：\n$$\n\\tau_{\\text{tot}}(y) = \\tau_w \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n其中 $\\tau_w$ 是壁面（$y=0$）处的剪切应力。壁面剪切应力通过 $\\tau_w = \\rho u_\\tau^2$ 定义了摩擦速度 $u_\\tau$，其中 $\\rho$ 是流体密度。\n\nBoussinesq 假设将雷诺剪切应力与平均速度梯度联系起来，使得总应力可以表示为：\n$$\n\\tau_{\\text{tot}}(y) = \\rho (\\nu + \\nu_t) \\frac{dU}{dy}\n$$\n此处，$\\nu$ 是运动粘度，$\\nu_t$ 是湍流粘度或涡粘度。我们采用 Prandtl 混合长度模型来计算 $\\nu_t$，即 $\\nu_t = \\ell_m^2 |dU/dy|$，其中 $\\ell_m$ 是混合长度。对于半槽道 $y \\in [0, \\delta]$ 内的平均流，速度梯度 $dU/dy$ 是非负的，因此我们可以写成 $|dU/dy| = dU/dy$。令 $g(y) = dU/dy$，涡粘性变为 $\\nu_t = \\ell_m^2 g(y)$。\n\n将 $\\tau_{\\text{tot}}(y)$ 的两个表达式相等，并代入 $u_\\tau$ 的定义，可得：\n$$\n\\rho (\\nu + \\ell_m^2 g(y)) g(y) = \\rho u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n两边同除以 $\\rho$，我们得到一个关于速度梯度 $g(y)$ 的代数方程：\n$$\n(\\nu + \\ell_m^2 g(y)) g(y) = u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)\n$$\n这可以重新整理成一个关于 $g(y)$ 的二次方程：\n$$\n\\ell_m^2 [g(y)]^2 + \\nu g(y) - u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right) = 0\n$$\n这是一个标准形式为 $ax^2+bx+c=0$ 的二次方程，其中 $x=g(y)$, $a=\\ell_m^2$, $b=\\nu$, $c=-u_\\tau^2(1-y/\\delta)$。其解由二次公式给出：\n$$\ng(y) = \\frac{-\\nu \\pm \\sqrt{\\nu^2 - 4(\\ell_m^2)\\left[-u_\\tau^2\\left(1 - \\frac{y}{\\delta}\\right)\\right]}}{2\\ell_m^2} = \\frac{-\\nu \\pm \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2}\n$$\n由于速度从壁面向中心线增加，梯度 $g(y)$ 必须为非负。平方根下的项总是大于或等于 $\\sqrt{\\nu^2}=|\\nu|=\\nu$。因此，为确保 $g(y) \\ge 0$，我们必须选择正号。符合物理意义的根是：\n$$\ng(y) = \\frac{-\\nu + \\sqrt{\\nu^2 + 4\\ell_m^2 u_\\tau^2 \\left(1 - \\frac{y}{\\delta}\\right)}}{2\\ell_m^2}\n$$\n该关系对 $y0$ 有效。在壁面处 $y=0$，混合长度 $\\ell_m$ 为零。在此极限下，二次方程简化为 $\\nu g(0) - u_\\tau^2 = 0$，得到 $g(0) = u_\\tau^2/\\nu$。在中心线处 $y=\\delta$，项 $(1-y/\\delta)$ 为零，导致 $g(\\delta) = (-\\nu + \\sqrt{\\nu^2})/(2\\ell_m^2) = 0$，这正确地再现了由对称性引起的零斜率条件。混合长度 $\\ell_m$ 本身由 van Driest 阻尼模型给出：\n$$\n\\ell_m(y) = \\kappa y \\left[1 - \\exp\\left(-\\frac{y^+}{A^+}\\right)\\right]\n$$\n其中 $y^+ = yu_\\tau/\\nu$ 是以粘性壁面单位表示的壁面法向坐标，$\\kappa$ 是 von Kármán 常数， $A^+$ 是 van Driest 阻尼常数。\n\n数值解首先通过将半槽道高度 $y \\in [0, \\delta]$ 离散化为一个包含 $N$ 个点的均匀网格来获得，网格点为 $y_i = i \\cdot \\Delta y$（$i=0, \\dots, N-1$），网格间距为 $\\Delta y = \\delta/(N-1)$。在每个网格点上使用推导出的公式计算速度梯度 $g(y_i)$，并处理 $y_0=0$ 处的特殊情况。\n然后，通过从壁面开始对 $g(y)$ 进行数值积分来找到平均速度剖面 $U(y)$，积分时需满足无滑移边界条件 $U(0)=0$。我们采用二阶精度的梯形法则：\n$$\nU(y_{i+1}) = U(y_i) + \\frac{\\Delta y}{2}[g(y_i) + g(y_{i+1})], \\quad \\text{for } i=0, \\dots, N-2\n$$\n为提高效率，这被实现为一个累积和。\n\n计算出 $U(y)$ 后，将该剖面无量纲化为壁面单位：无量纲速度为 $U^+ = U/u_\\tau$，无量纲距离为 $y^+ = yu_\\tau/\\nu$。\n将计算出的剖面 $U^+(y^+)$ 与对数区的理论壁面律进行比较：\n$$\nU^+_{\\log}(y^+) = \\frac{1}{\\kappa}\\ln y^+ + B\n$$\n其中 $B$ 是对数律截距常数。偏差通过均方根 (RMS) 误差来量化，该误差在区间 $y^+ \\in [30, 0.3 Re_\\tau]$ 上计算，其中 $Re_\\tau = u_\\tau \\delta / \\nu$ 是摩擦雷诺数。如果该区间包含由集合 $J$ 索引的 $M$ 个网格点，则均方根误差为：\n$$\n\\text{Error}_{\\text{RMS}} = \\sqrt{\\frac{1}{M}\\sum_{i \\in J} \\left[U^+(y^+_i) - U^+_{\\log}(y^+_i)\\right]^2}\n$$\n对于网格未解析此区间（即其中没有任何网格点）的情况，问题规定在最接近 $y^+=30$ 的单个网格点 $y^+_k$ 处计算绝对差 $|U^+(y^+_k) - U^+_{\\log}(y^+_k)|$。然后将该值报告为该情况下的误差。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the turbulent mean velocity profile in a plane channel using a mixing length model\n    and compares it to the law of the wall to find the RMS error.\n    \"\"\"\n    # Physical and model constants\n    NU = 1.5e-5  # Kinematic viscosity (m^2/s)\n    DELTA = 0.05  # Channel half-height (m)\n    KAPPA = 0.41  # von Kármán constant\n    B = 5.2       # Log-law intercept\n    A_PLUS = 26.0 # van Driest damping constant\n\n    # Test cases: (Re_tau, N)\n    test_cases = [\n        (180, 1500),\n        (395, 2000),\n        (1000, 4000),\n        (90, 1500),\n    ]\n\n    results = []\n    \n    for Re_tau, N in test_cases:\n        # 1. Setup grid and flow parameters\n        u_tau = Re_tau * NU / DELTA\n        dy = DELTA / (N - 1)\n        y = np.linspace(0, DELTA, N, dtype=np.float64)\n        y_plus = y * u_tau / NU\n\n        # 2. Compute the mean velocity gradient g(y) = dU/dy\n        g = np.zeros(N, dtype=np.float64)\n\n        # At the wall (y=0), lm=0, the quadratic equation for g simplifies\n        g[0] = u_tau**2 / NU\n\n        # For y > 0\n        y_slice = y[1:]\n        y_plus_slice = y_plus[1:]\n        \n        # Mixing length with van Driest damping\n        lm = KAPPA * y_slice * (1.0 - np.exp(-y_plus_slice / A_PLUS))\n        \n        # Solve the quadratic equation for g(y): lm^2 * g^2 + nu * g - C = 0\n        # where C = u_tau^2 * (1 - y/delta)\n        # We use the positive root for g.\n        c_term = u_tau**2 * (1.0 - y_slice / DELTA)\n        discriminant = NU**2 + 4.0 * lm**2 * c_term\n        g[1:] = (-NU + np.sqrt(discriminant)) / (2.0 * lm**2)\n\n        # 3. Integrate g(y) to get U(y) using the trapezoidal rule\n        U = np.zeros(N, dtype=np.float64)\n        # U(0)=0 due to no-slip condition.\n        # U[i+1] = U[i] + 0.5 * dy * (g[i] + g[i+1])\n        # This is equivalent to a cumulative sum of the trapezoidal areas.\n        integrand = 0.5 * dy * (g[:-1] + g[1:])\n        U[1:] = np.cumsum(integrand)\n\n        # 4. Non-dimensionalize velocity\n        U_plus = U / u_tau\n\n        # 5. Compare with log law and compute RMS error\n        log_layer_start = 30.0\n        log_layer_end = 0.3 * Re_tau\n\n        # Find points within the logarithmic layer\n        log_mask = (y_plus >= log_layer_start)  (y_plus = log_layer_end)\n        \n        num_points_in_log_layer = np.sum(log_mask)\n\n        if num_points_in_log_layer > 0:\n            # Normal case: compute RMS error over the log-layer points\n            y_plus_log = y_plus[log_mask]\n            U_plus_log = U_plus[log_mask]\n            \n            U_log_analytic = (1.0 / KAPPA) * np.log(y_plus_log) + B\n            \n            error = np.sqrt(np.mean((U_plus_log - U_log_analytic)**2))\n        else:\n            # Edge case: no grid points in the log layer interval\n            # Find the single grid point closest to y+=30\n            # Note: y_plus[0] is 0. Exclude it to avoid issues with log(0) and to ensure\n            # the search is in the physically relevant region. The closest point will not be y=0.\n            idx_closest = np.argmin(np.abs(y_plus[1:] - log_layer_start)) + 1\n            \n            y_p_eval = y_plus[idx_closest]\n            U_p_eval = U_plus[idx_closest]\n            \n            U_log_analytic_eval = (1.0 / KAPPA) * np.log(y_p_eval) + B\n            \n            error = np.abs(U_p_eval - U_log_analytic_eval)\n\n        results.append(error)\n\n    # Format output as specified\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2381390"}]}