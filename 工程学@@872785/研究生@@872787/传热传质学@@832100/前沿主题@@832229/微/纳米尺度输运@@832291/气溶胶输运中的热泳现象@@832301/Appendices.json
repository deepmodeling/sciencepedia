{"hands_on_practices": [{"introduction": "在掌握稳态的热泳速度之前，我们首先需要理解粒子是如何达到该速度的。当一个温度梯度突然施加时，粒子并不会瞬间达到其最终速度，而是会经历一个加速过程。这个练习 [@problem_id:2533293] 引导我们探究这一瞬态行为，通过建立粒子的运动方程来推导和计算其特征响应时间，即粒子弛豫时间。理解这个基本时间尺度对于分析气溶胶在动态变化环境中的行为至关重要。", "problem": "一个单分散的、刚性的球形二氧化硅颗粒悬浮在静止的空气中，其所处环境满足克努森数 (Kn) $ \\text{Kn} \\ll 1 $，且颗粒周围的雷诺数 (Re) 始终保持 $ \\text{Re} \\ll 1 $。在时间 $ t=0 $ 时，突然施加一个空间均匀且稳定的温度梯度 $ \\nabla T $。此后，这在颗粒上产生了一个恒定的热泳驱动力，导致其产生一个随时间渐近达到的稳态漂移速度 $ v_{th} $。\n\n假设为连续介质、蠕动流条件，颗粒表面无滑移，并忽略重力和布朗涨落。设颗粒直径为 $ d_p = 2.0 \\times 10^{-6}\\,\\text{m} $，颗粒材料密度为 $ \\rho_p = 2.2 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3} $，在 $ T = 300\\,\\text{K} $ 时空气的动力粘度为 $ \\mu = 1.85 \\times 10^{-5}\\,\\text{Pa}\\,\\text{s} $。\n\n从牛顿第二定律和斯托克斯曳力定律出发，推导颗粒沿 $ \\nabla T $ 方向速度分量的线性一阶动力学方程，确定特征弛豫时间 $ \\tau_p $，并说明在阶跃施加 $ \\nabla T $ 后速度如何趋近于 $ v_{th} $。然后，根据以上数据数值计算 $ \\tau_p $，并确定在阶跃施加 $ \\nabla T $ 后，颗粒速度达到 $ 0.99\\,v_{th} $ 所需的时间 $ t_{0.99} $。\n\n将 $ t_{0.99} $ 的最终数值结果以微秒表示，并四舍五入到三位有效数字。作为最终答案，仅提供所要求单位的 $ t_{0.99} $ 的数值。", "solution": "问题陈述已经过评估，并被确定为有效。这是一个在经典流体动力学和颗粒输运领域中定义明确、有科学依据的问题，没有矛盾、歧义或事实上的不健全之处。所有必要的数据均已提供。我们可以继续进行求解。\n\n球形颗粒沿施加的温度梯度 $ \\nabla T $ 方向的运动遵循牛顿第二定律。作用在颗粒上的合力是热泳力 $ F_{th} $ 和流体动力曳力 $ F_D $ 的总和。\n设 $v(t)$ 为颗粒在时间 $ t $ 时沿 $ \\nabla T $ 方向的速度。牛顿第二定律写作：\n$$ m_p \\frac{dv}{dt} = F_{th} + F_D $$\n其中 $ m_p $ 是颗粒的质量。\n\n颗粒是球形的，直径为 $ d_p $，材料密度为 $ \\rho_p $，因此其质量为：\n$$ m_p = \\rho_p V_p = \\rho_p \\left( \\frac{1}{6} \\pi d_p^3 \\right) $$\n\n问题陈述指出，对于 $ t \\geq 0 $，会产生一个恒定的热泳力 $ F_{th} $。该力作用于温度降低的方向，我们将其定为运动的正方向。\n\n对于在无滑移连续介质条件下（$ \\text{Kn} \\ll 1 $）处于蠕动流（$ \\text{Re} \\ll 1 $）中的球体，其流体动力曳力由斯托克斯曳力定律给出。该力与运动方向相反，因此表示为：\n$$ F_D = -3 \\pi \\mu d_p v $$\n其中 $ \\mu $ 是周围空气的动力粘度。\n\n将力的表达式代入牛顿第二定律，得到运动方程：\n$$ m_p \\frac{dv}{dt} = F_{th} - 3 \\pi \\mu d_p v $$\n\n当时间趋于无穷大（$ t \\to \\infty $）时，颗粒达到稳态热泳漂移速度 $ v_{th} $。在此稳态下，加速度为零（$ \\frac{dv}{dt} = 0 $），热泳力与曳力完全平衡：\n$$ 0 = F_{th} - 3 \\pi \\mu d_p v_{th} $$\n这使我们能够用终端速度来表示恒定的热泳力：\n$$ F_{th} = 3 \\pi \\mu d_p v_{th} $$\n问题的构造使得我们不需要 $ F_{th} $ 以 $ \\nabla T $ 表示的显式公式。\n\n我们将 $ F_{th} $ 的这个表达式代回动力学运动方程：\n$$ m_p \\frac{dv}{dt} = 3 \\pi \\mu d_p v_{th} - 3 \\pi \\mu d_p v $$\n$$ m_p \\frac{dv}{dt} = 3 \\pi \\mu d_p (v_{th} - v) $$\n\n这是一个关于颗粒速度 $ v(t) $ 的线性一阶常微分方程。为了确定特征弛豫时间，我们将方程重排为标准形式：\n$$ \\frac{dv}{dt} + \\left( \\frac{3 \\pi \\mu d_p}{m_p} \\right) v = \\left( \\frac{3 \\pi \\mu d_p}{m_p} \\right) v_{th} $$\n该方程的形式为 $ \\frac{dy}{dt} + \\frac{1}{\\tau} y = C $。特征颗粒弛豫时间 $ \\tau_p $ 是 $ v $ 项系数的倒数：\n$$ \\tau_p = \\frac{m_p}{3 \\pi \\mu d_p} $$\n代入颗粒质量的表达式 $ m_p = \\rho_p (\\frac{1}{6} \\pi d_p^3) $：\n$$ \\tau_p = \\frac{\\rho_p \\left( \\frac{1}{6} \\pi d_p^3 \\right)}{3 \\pi \\mu d_p} = \\frac{\\rho_p d_p^2}{18 \\mu} $$\n\n现在，该微分方程可以紧凑地写作：\n$$ \\frac{dv}{dt} = \\frac{1}{\\tau_p} (v_{th} - v) $$\n我们用初始条件，即颗粒在时间 $ t=0 $ 时处于静止状态（$ v(0) = 0 $），来解这个方程。该方程是可分离的：\n$$ \\frac{dv}{v_{th} - v} = \\frac{dt}{\\tau_p} $$\n对两边从 $ t=0 $ 积分到任意时间 $t$：\n$$ \\int_0^{v(t)} \\frac{d v'}{v_{th} - v'} = \\int_0^t \\frac{dt'}{\\tau_p} $$\n$$ \\left[ -\\ln(v_{th} - v') \\right]_0^{v(t)} = \\frac{t}{\\tau_p} $$\n$$ -\\ln(v_{th} - v(t)) + \\ln(v_{th} - v(0)) = \\frac{t}{\\tau_p} $$\n使用初始条件 $ v(0)=0 $：\n$$ \\ln\\left( \\frac{v_{th}}{v_{th} - v(t)} \\right) = \\frac{t}{\\tau_p} $$\n对两边取指数，得到：\n$$ \\frac{v_{th}}{v_{th} - v(t)} = \\exp\\left( \\frac{t}{\\tau_p} \\right) $$\n求解 $ v(t) $：\n$$ v_{th} - v(t) = v_{th} \\exp\\left( -\\frac{t}{\\tau_p} \\right) $$\n$$ v(t) = v_{th} \\left( 1 - \\exp\\left( -\\frac{t}{\\tau_p} \\right) \\right) $$\n这个表达式表明，颗粒速度 $ v(t) $ 从 $ 0 $ 开始，并渐近地趋近于稳态速度 $ v_{th} $。\n\n接下来，我们使用给定数据计算弛豫时间 $ \\tau_p $ 的数值：\n$ d_p = 2.0 \\times 10^{-6}\\,\\text{m} $\n$ \\rho_p = 2.2 \\times 10^{3}\\,\\text{kg}\\,\\text{m}^{-3} $\n$ \\mu = 1.85 \\times 10^{-5}\\,\\text{Pa}\\,\\text{s} $\n\n$$ \\tau_p = \\frac{\\rho_p d_p^2}{18 \\mu} = \\frac{(2.2 \\times 10^{3}) (2.0 \\times 10^{-6})^2}{18 (1.85 \\times 10^{-5})} $$\n$$ \\tau_p = \\frac{(2.2 \\times 10^{3}) (4.0 \\times 10^{-12})}{33.3 \\times 10^{-5}} = \\frac{8.8 \\times 10^{-9}}{3.33 \\times 10^{-4}} \\approx 2.64264 \\times 10^{-5}\\,\\text{s} $$\n\n最后，我们确定颗粒速度达到其终端速度 $ 99\\% $ 所需的时间 $ t_{0.99} $，即 $ v(t_{0.99}) = 0.99 v_{th} $。\n使用速度随时间变化的公式：\n$$ 0.99 v_{th} = v_{th} \\left( 1 - \\exp\\left( -\\frac{t_{0.99}}{\\tau_p} \\right) \\right) $$\n$$ 0.99 = 1 - \\exp\\left( -\\frac{t_{0.99}}{\\tau_p} \\right) $$\n$$ \\exp\\left( -\\frac{t_{0.99}}{\\tau_p} \\right) = 1 - 0.99 = 0.01 $$\n对两边取自然对数：\n$$ -\\frac{t_{0.99}}{\\tau_p} = \\ln(0.01) = \\ln(10^{-2}) = -2 \\ln(10) $$\n或者，$ \\ln(0.01) = -\\ln(100) $。\n因此，所需的时间是：\n$$ t_{0.99} = \\tau_p \\ln(100) $$\n代入 $ \\tau_p $ 的值：\n$$ t_{0.99} \\approx (2.64264 \\times 10^{-5}\\,\\text{s}) \\times \\ln(100) \\approx (2.64264 \\times 10^{-5}) \\times 4.60517 $$\n$$ t_{0.99} \\approx 1.21693 \\times 10^{-4}\\,\\text{s} $$\n问题要求答案以微秒（$ \\mu\\text{s} $）为单位，其中 $ 1\\,\\text{s} = 10^6\\,\\mu\\text{s} $。\n$$ t_{0.99} \\approx 1.21693 \\times 10^{-4} \\times 10^6\\,\\mu\\text{s} = 121.693\\,\\mu\\text{s} $$\n将结果四舍五入到三位有效数字，我们得到：\n$$ t_{0.99} \\approx 122\\,\\mu\\text{s} $$\n这是颗粒加速到其最终热泳速度 $ 99\\% $ 所需的时间。", "answer": "$$\\boxed{122}$$", "id": "2533293"}, {"introduction": "在许多实际系统中，粒子的定向热泳漂移与随机的布朗运动同时存在，它们的相互竞争决定了粒子在壁面附近的浓度分布和沉积通量。这个练习 [@problem_id:2533358] 将我们带入一个更实际的工程场景：冷却壁面上的气溶胶沉积。通过求解一维输运方程，我们将学会如何量化这两种效应的平衡，并引入灵敏度分析这一强大工具，来评估关键参数（如努森数 $Kn$）对沉积过程的影响程度。", "problem": "考虑悬浮在平行板通道中静止气体里的稀疏、无相互作用的气溶胶颗粒，通道壁面为位于 $y=0$ 处的冷壁面。令 $y$ 表示指向气体内部且垂直于壁面的坐标。假设以下符合物理现实的理想化条件：(i) 颗粒相足够稀疏，以至于颗粒间的相互作用和惯性效应可以忽略不计；(ii) 气体处于稳态且静止，因此唯一的定向颗粒运动是热泳漂移；(iii) 在我们关心的近壁区域，温度分布是局部线性的，具有恒定梯度 $G \\equiv dT/dy\\big|_{0} > 0$（壁面较冷，远离壁面的气体较热），并且气体性质是均匀的。颗粒数浓度 $c(y)$ 满足布朗扩散和热泳漂移之间的一维稳態输运平衡，\n$$\nJ = - D_{p} \\,\\frac{dc}{dy} + c \\, v_{T},\n$$\n其中 $J$ 是恒定的垂直于壁面的颗粒通量，$D_{p}$ 是颗粒扩散系数。壁面是一个理想吸收壁，因此 $c(0)=0$，并且浓度在远场趋于一个均匀值 $\\lim_{y\\to\\infty} c(y) = c_{\\infty}$。热泳漂移速度使用一种标准的、受气体动理论启发的、在连续区和自由分子区极限之间的插值模型来描述，\n$$\nv_{T} = -\\, \\alpha_{T}\\, \\nu \\,\\frac{G}{T_{w}}\\, f(\\mathrm{Kn}),\n$$\n其中 $\\nu$ 是运动黏度，$T_{w}$ 是壁面温度，$\\alpha_{T}\\in(0,1]$ 是热适应系数，$\\mathrm{Kn} = \\lambda/a$ 是基于平均自由程 $\\lambda$ 和颗粒半径 $a$ 的克努森数，以及\n$$\nf(\\mathrm{Kn}) = \\frac{\\mathrm{Kn}}{1+\\mathrm{Kn}}。\n$$\n仅使用以上信息和基本输运原理，推导沉积通量 $J$ 关于 $c_{\\infty}$ 和 $v_{T}$ 的表达式，然后对 $J$ 进行关于 $\\alpha_{T}$ 和 $\\mathrm{Kn}$ 的局部归一化灵敏度分析。定义关于参数 $x$ 的归一化局部灵敏度系数为\n$$\nS_{x} \\equiv \\left.\\frac{x}{J}\\,\\frac{\\partial J}{\\partial x}\\right|_{(\\alpha_{T},\\,\\mathrm{Kn}) = (\\alpha_{T,0},\\,\\mathrm{Kn}_{0})}.\n$$\n在基准值 $\\alpha_{T,0} = 0.9$ 和 $\\mathrm{Kn}_{0} = 0.3$ 处，计算 $S_{\\alpha_{T}}$ 和 $S_{\\mathrm{Kn}}$。以行矩阵 $\\big(S_{\\alpha_{T}},\\, S_{\\mathrm{Kn}}\\big)$ 的形式报告你的最终答案，并四舍五入到四位有效数字。灵敏度系数是无量纲的；最终的数值无需单位。", "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤1：提取已知条件**\n- **控制方程**：$J = - D_{p} \\frac{dc}{dy} + c v_{T}$，其中 $J$ 是一个常数。\n- **物理系统**：静止气体中的稀疏、无相互作用的气溶胶颗粒。\n- **几何构型**：平行板通道，在 $y=0$ 处有冷壁面。\n- **边界条件**：$c(0)=0$ (理想吸收壁) 和 $\\lim_{y\\to\\infty} c(y) = c_{\\infty}$。\n- **假设**：稳态、静止气体、可忽略的颗粒间相互作用和惯性、近壁面处温度分布呈局部线性，梯度为常数 $G \\equiv dT/dy\\big|_{0} > 0$，气体性质均匀（意味着 $D_p$ 和 $v_T$ 是常数）。\n- **热泳速度模型**：$v_{T} = - \\alpha_{T} \\nu \\frac{G}{T_{w}} f(\\mathrm{Kn})$。\n- **$f(\\mathrm{Kn})$ 的本构关系**：$f(\\mathrm{Kn}) = \\frac{\\mathrm{Kn}}{1+\\mathrm{Kn}}$。\n- **参数**：热适应系数 $\\alpha_{T} \\in (0,1]$；克努森数 $\\mathrm{Kn} = \\lambda/a$。\n- **任务**：1. 推导沉积通量 $J$（用 $c_{\\infty}$ 和 $v_{T}$ 表示）。2. 对 $J$ 进行关于 $\\alpha_{T}$ 和 $\\mathrm{Kn}$ 的归一化灵敏度分析。\n- **灵敏度定义**：$S_{x} \\equiv \\left.\\frac{x}{J}\\,\\frac{\\partial J}{\\partial x}\\right|_{(\\alpha_{T},\\,\\mathrm{Kn}) = (\\alpha_{T,0},\\,\\mathrm{Kn}_{0})}$。\n- **计算点**：$\\alpha_{T,0} = 0.9$ 和 $\\mathrm{Kn}_{0} = 0.3$。\n- **最终答案格式**：行矩阵 $\\big(S_{\\alpha_{T}},\\, S_{\\mathrm{Kn}}\\big)$，数值四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题牢固地建立在热质传递原理，特别是气溶胶输运理论的基础上。控制方程是一个标准的一维对流-扩散方程。热泳速度模型是一个成熟的插值公式。\n- **适定性**：该问题包含一个带两个边界条件的一阶线性常微分方程。这个设定足以确定浓度分布 $c(y)$ 和通量 $J$ 的唯一解。\n- **客观性**：问题陈述使用了精确、客观和标准的科学术语。\n\n**步骤3：结论与行动**\n该问题在科学上是合理的、自洽的并且是适定的。未发现任何缺陷。问题被宣布为**有效**，现在将开始推导求解。\n\n第一个目标是求出颗粒沉积通量 $J$。控制输运方程为\n$$\nJ = - D_{p} \\frac{dc}{dy} + c v_{T}\n$$\n这是关于浓度 $c(y)$ 的一阶线性非齐次常微分方程。由于 $J$、$D_p$ 和 $v_T$ 均为常数，方程可以整理为：\n$$\n\\frac{dc}{dy} - \\frac{v_{T}}{D_{p}} c = -\\frac{J}{D_{p}}\n$$\n积分因子为 $I(y) = \\exp\\left(\\int -\\frac{v_{T}}{D_{p}} dy\\right) = \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right)$。用 $I(y)$ 乘以该微分方程得到：\n$$\n\\frac{d}{dy}\\left( c(y) \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right) \\right) = -\\frac{J}{D_{p}} \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right)\n$$\n对 $y$ 进行积分：\n$$\nc(y) \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right) = -\\frac{J}{D_{p}} \\int \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right) dy = -\\frac{J}{D_{p}} \\left( \\frac{\\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right)}{-v_{T}/D_{p}} \\right) + C_{1}\n$$\n其中 $C_1$ 是积分常数。化简后，我们得到：\n$$\nc(y) \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right) = \\frac{J}{v_{T}} \\exp\\left(-\\frac{v_{T}y}{D_{p}}\\right) + C_{1}\n$$\n浓度分布的通解为：\n$$\nc(y) = \\frac{J}{v_{T}} + C_{1} \\exp\\left(\\frac{v_{T}y}{D_{p}}\\right)\n$$\n常数 $C_1$ 和 $J$ 由边界条件确定。\n应用壁面边界条件 $c(0)=0$：\n$$\n0 = \\frac{J}{v_{T}} + C_{1} \\exp(0) \\implies C_{1} = -\\frac{J}{v_{T}}\n$$\n将 $C_1$ 代回通解得到：\n$$\nc(y) = \\frac{J}{v_{T}} \\left(1 - \\exp\\left(\\frac{v_{T}y}{D_{p}}\\right)\\right)\n$$\n为了应用远场边界条件 $\\lim_{y\\to\\infty} c(y) = c_{\\infty}$，我们必须确定 $v_{T}$ 的符号。壁面是冷的，并且当 $y>0$ 时温度升高，因此 $G > 0$。热泳现象驱动颗粒从高温区域向低温区域移动，所以漂移速度必须指向壁面，即沿负 $y$ 方向。因此，$v_{T} < 0$。这与给定的公式 $v_{T} = - \\alpha_{T} \\nu \\frac{G}{T_{w}} f(\\mathrm{Kn})$ 一致，因为右侧的所有量均为正。\n由于 $v_{T} < 0$ 且 $D_{p} > 0$，指数的参数 $\\frac{v_{T}y}{D_{p}}$ 为负。因此，当 $y \\to \\infty$ 时，指数项趋于零：\n$$\n\\lim_{y\\to\\infty} \\exp\\left(\\frac{v_{T}y}{D_{p}}\\right) = 0\n$$\n将此极限应用于 $c(y)$ 的解：\n$$\n\\lim_{y\\to\\infty} c(y) = \\frac{J}{v_{T}} (1 - 0) = \\frac{J}{v_{T}}\n$$\n将此结果与给定的远场条件相等，得到 $c_{\\infty} = \\frac{J}{v_{T}}$。\n求解沉积通量 $J$，我们得到第一个要求的结果：\n$$\nJ = c_{\\infty} v_{T}\n$$\n第二个目标是进行灵敏度分析。通量的完整表达式为：\n$$\nJ = - c_{\\infty} \\alpha_{T} \\nu \\frac{G}{T_{w}} f(\\mathrm{Kn}) = - c_{\\infty} \\alpha_{T} \\nu \\frac{G}{T_{w}} \\frac{\\mathrm{Kn}}{1+\\mathrm{Kn}}\n$$\n$J$ 对参数 $x$ 的归一化局部灵敏度为 $S_{x} = \\frac{x}{J} \\frac{\\partial J}{\\partial x}$。\n\n首先，我们计算关于 $\\alpha_{T}$ 的灵敏度：\n$$\nS_{\\alpha_{T}} = \\frac{\\alpha_{T}}{J} \\frac{\\partial J}{\\partial \\alpha_{T}}\n$$\n$J$ 关于 $\\alpha_{T}$ 的偏导数为：\n$$\n\\frac{\\partial J}{\\partial \\alpha_{T}} = \\frac{\\partial}{\\partial \\alpha_{T}} \\left( - c_{\\infty} \\alpha_{T} \\nu \\frac{G}{T_{w}} f(\\mathrm{Kn}) \\right) = - c_{\\infty} \\nu \\frac{G}{T_{w}} f(\\mathrm{Kn}) = \\frac{J}{\\alpha_{T}}\n$$\n将此代入灵敏度公式：\n$$\nS_{\\alpha_{T}} = \\frac{\\alpha_{T}}{J} \\left( \\frac{J}{\\alpha_{T}} \\right) = 1\n$$\n这个结果与参数值无关。通量与热适应系数成正比。\n\n接下来，我们计算关于 $\\mathrm{Kn}$ 的灵敏度：\n$$\nS_{\\mathrm{Kn}} = \\frac{\\mathrm{Kn}}{J} \\frac{\\partial J}{\\partial \\mathrm{Kn}}\n$$\n$J$ 关于 $\\mathrm{Kn}$ 的偏导数可使用 $f(\\mathrm{Kn})$ 的商法则求得：\n$$\n\\frac{\\partial J}{\\partial \\mathrm{Kn}} = \\left( - c_{\\infty} \\alpha_{T} \\nu \\frac{G}{T_{w}} \\right) \\frac{\\partial}{\\partial \\mathrm{Kn}} \\left( \\frac{\\mathrm{Kn}}{1+\\mathrm{Kn}} \\right) = \\left( \\frac{J}{f(\\mathrm{Kn})} \\right) \\left( \\frac{(1)(1+\\mathrm{Kn}) - (\\mathrm{Kn})(1)}{(1+\\mathrm{Kn})^{2}} \\right)\n$$\n$$\n\\frac{\\partial J}{\\partial \\mathrm{Kn}} = \\left( J \\frac{1+\\mathrm{Kn}}{\\mathrm{Kn}} \\right) \\left( \\frac{1}{(1+\\mathrm{Kn})^{2}} \\right) = \\frac{J}{\\mathrm{Kn}(1+\\mathrm{Kn})}\n$$\n将此代入灵敏度公式：\n$$\nS_{\\mathrm{Kn}} = \\frac{\\mathrm{Kn}}{J} \\left( \\frac{J}{\\mathrm{Kn}(1+\\mathrm{Kn})} \\right) = \\frac{1}{1+\\mathrm{Kn}}\n$$\n现在，我们必须在基准点 $\\alpha_{T,0} = 0.9$ 和 $\\mathrm{Kn}_{0} = 0.3$ 处计算这些灵敏度的值。\n灵敏度 $S_{\\alpha_{T}}$ 是恒定的：\n$$\nS_{\\alpha_{T}} = 1\n$$\n灵敏度 $S_{\\mathrm{Kn}}$ 在 $\\mathrm{Kn} = \\mathrm{Kn}_{0} = 0.3$ 处的值为：\n$$\nS_{\\mathrm{Kn}} = \\frac{1}{1+0.3} = \\frac{1}{1.3} \\approx 0.7692307...\n$$\n四舍五入到四位有效数字，我们得到 $S_{\\alpha_{T}} = 1.000$ 和 $S_{\\mathrm{Kn}} = 0.7692$。\n最终答案应以行矩阵 $(S_{\\alpha_{T}}, S_{\\mathrm{Kn}})$ 的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.0000  & 0.7692\n\\end{pmatrix}\n}\n$$", "id": "2533358"}, {"introduction": "最后的实践是一个综合性的计算任务，旨在将前面学到的物理概念应用于一个复杂的二维模拟场景中。这个练习 [@problem_id:2533303] 要求我们在一个给定的、非均匀的温度场中（类似于计算流体动力学(CFD)的输出结果），通过数值方法追踪单个粒子的运动轨迹。你需要建立粒子的拉格朗日运动方程，处理与复杂边界的相互作用，从而亲身体验高级工程和研究软件中使用的核心建模与仿真技术。", "problem": "给定一个代表计算流体动力学 (CFD) 解的二维温度欧拉场，您必须通过增加一个热泳漂移来增强粒子速度，从而将其与拉格朗日粒子追踪耦合。计算域是坐标以米为单位的方形区域 $[0,1] \\times [0,1]$。离散化的温度场在具有 $N_x = 201$ 和 $N_y = 201$ 个节点的均匀笛卡尔网格上指定，均匀间距为 $\\Delta x = \\Delta y = 0.005$ 米。网格节点的坐标为 $x_i = i \\Delta x$ 和 $y_j = j \\Delta y$，其中整数 $0 \\leq i \\leq 200$ 和 $0 \\leq j \\leq 200$。\n\n温度场（单位：开尔文）在网格节点上通过以下叠加定义：\n$$\nT(x,y) = T_0 + \\Delta T \\exp\\!\\Bigg(-\\frac{(x-x_c)^2}{\\sigma_x^2} - \\frac{(y-y_c)^2}{\\sigma_y^2} \\Bigg) + G_x x + G_y y,\n$$\n其中常数为 $T_0 = 300\\,\\mathrm{K}$，$\\Delta T = 200\\,\\mathrm{K}$，$x_c = 0.5\\,\\mathrm{m}$，$y_c = 0.5\\,\\mathrm{m}$，$\\sigma_x = 0.1\\,\\mathrm{m}$，$\\sigma_y = 0.15\\,\\mathrm{m}$，$G_x = 150\\,\\mathrm{K/m}$，以及 $G_y = -50\\,\\mathrm{K/m}$。应严格将此场视为网格上的采样数据；在非网格点位置的任何求值都必须使用网格值的双线性插值，任何温度梯度都必须通过在网格上进行中心有限差分然后进行双线性插值来获得。\n\n流体速度场（单位：米/秒）是均匀的并与 $x$ 轴对齐，$\\,\\boldsymbol{u}(x,y) = (U_0, 0)\\,$，其中 $U_0$ 在下方的每个测试用例中指定。\n\n几何结构包含一个内部固体障碍物，建模为中心在 $(x_c,y_c) = (0.5\\,\\mathrm{m}, 0.5\\,\\mathrm{m})$ 的椭圆，其半轴为 $a = 0.12\\,\\mathrm{m}$（$x$ 方向）和 $b = 0.20\\,\\mathrm{m}$（$y$ 方向）。其隐式水平集为\n$$\n\\phi(x,y) = \\frac{(x-x_c)^2}{a^2} + \\frac{(y-y_c)^2}{b^2} - 1.\n$$\n满足 $\\phi(x,y) < 0$ 的点位于固体内部，不是允许的粒子位置。如果一个建议的步长会穿过固体，则在障碍物边界处强制执行镜面反射。同样，位于 $x=0$，$x=1$，$y=0$ 和 $y=1$ 的外部盒子边界也是反射性的。\n\n从第一性原理推导出一个控制粒子轨迹 $\\boldsymbol{x}_p(t)$ 的常微分方程，该方程包括：\n- 在蠕动流极限下，由流体速度 $\\boldsymbol{u}(\\boldsymbol{x})$ 引起的平流，粒子惯性可忽略不计，以牛顿第二定律和斯托克斯阻力为基本基础。\n- 一个各向同性的热泳漂移，其方向与温度较低的方向一致，大小与从线性非平衡热力学导出的局部驱动力成正比。不要假设任何特定的经验性简化公式。引入一个具有适当物理量纲的热泳迁移率参数 $k_{\\mathrm{th}}$。用温度场及其梯度表示该漂移。\n\n通过在时间区间 $t \\in [0, t_{\\mathrm{end}}]$ 内对推导出的运动方程进行数值积分，为指定的测试用例计算粒子轨迹。使用至少二阶精度的显式时间步进方案。在每个时间步：\n- 通过中心差分和双线性插值从CFD网格计算温度及其梯度，\n- 根据您推导的方程计算总粒子速度，\n- 将粒子推进一个时间步，\n- 如果步长会穿过固体，则在外部盒子处强制执行反射边界条件，在椭圆障碍物处强制执行镜面反射。对于镜面反射，沿步长确定与障碍物边界的交点，在交点处通过 $\\nabla \\phi(x,y)$ 计算向外的单位法向量，将剩余位移绕切平面反射，并完成该步。\n\n所有物理量必须使用其给定单位进行处理。您必须为每个测试用例生成最终的粒子位置（单位：米），并四舍五入到六位小数。\n\n测试套件：\n- 案例1 (正常路径，中等漂移): $(x_0,y_0) = (0.10\\,\\mathrm{m}, 0.20\\,\\mathrm{m})$，$t_{\\mathrm{end}} = 0.50\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 1.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.020\\,\\mathrm{m/s}$。\n- 案例2 (无热泳，边缘情况): $(x_0,y_0) = (0.10\\,\\mathrm{m}, 0.20\\,\\mathrm{m})$，$t_{\\mathrm{end}} = 0.50\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 0.0\\,\\mathrm{m^2/s}$，$U_0 = 0.020\\,\\mathrm{m/s}$。\n- 案例3 (较强漂移，较慢流动，靠近热区): $(x_0,y_0) = (0.35\\,\\mathrm{m}, 0.50\\,\\mathrm{m})$，$t_{\\mathrm{end}} = 1.00\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 3.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.005\\,\\mathrm{m/s}$。\n- 案例4 (几何相互作用，反射): $(x_0,y_0) = (0.25\\,\\mathrm{m}, 0.50\\,\\mathrm{m})$，$t_{\\mathrm{end}} = 3.00\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 2.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.050\\,\\mathrm{m/s}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是一个包含测试用例最终粒子坐标（单位：米）的双元素列表，四舍五入到六位小数。例如，一个有效的输出格式是\n\"[[x1,y1],[x2,y2],[x3,y3],[x4,y4]]\"\n其中每个 $x_i$ 和 $y_i$ 都精确显示到小数点后六位。", "solution": "问题陈述已经过验证。\n\n已知条件提取如下：\n域：一个方形区域 $[0,1] \\times [0,1]$ 米。\n计算网格：一个具有 $N_x = 201$ 个节点和 $N_y = 201$ 个节点的均匀笛卡尔网格。网格间距为 $\\Delta x = \\Delta y = 0.005$ 米。节点坐标为 $x_i = i \\Delta x$（其中 $i \\in [0, 200]$）和 $y_j = j \\Delta y$（其中 $j \\in [0, 200]$）。\n温度场：$T(x,y) = T_0 + \\Delta T \\exp\\left(-\\frac{(x-x_c)^2}{\\sigma_x^2} - \\frac{(y-y_c)^2}{\\sigma_y^2} \\right) + G_x x + G_y y$。\n常数：$T_0 = 300\\,\\mathrm{K}$，$\\Delta T = 200\\,\\mathrm{K}$，$x_c = 0.5\\,\\mathrm{m}$，$y_c = 0.5\\,\\mathrm{m}$，$\\sigma_x = 0.1\\,\\mathrm{m}$，$\\sigma_y = 0.15\\,\\mathrm{m}$，$G_x = 150\\,\\mathrm{K/m}$，$G_y = -50\\,\\mathrm{K/m}$。\n数值计算说明：对非网格点值使用双线性插值。在网格上使用中心有限差分计算梯度，然后进行双线性插值。\n流体速度场：$\\boldsymbol{u}(x,y) = (U_0, 0)$，其中 $U_0$ 在每个用例中指定。\n障碍物几何：中心在 $(x_c,y_c)=(0.5, 0.5)\\,\\mathrm{m}$ 的椭圆，半轴为 $a = 0.12\\,\\mathrm{m}$（$x$ 方向）和 $b = 0.20\\,\\mathrm{m}$（$y$ 方向）。\n障碍物水平集：$\\phi(x,y) = \\frac{(x-x_c)^2}{a^2} + \\frac{(y-y_c)^2}{b^2} - 1$。如果 $\\phi(x,y)  0$，则点在内部。\n边界条件：在椭圆障碍物边界（$\\phi=0$）处进行镜面反射。在外部域边界（$x=0, x=1, y=0, y=1$）处为反射条件。\n粒子动力学：必须从第一性原理推导，包括平流（蠕动流，斯托克斯阻力）和热泳漂移（各向同性，朝向较冷区域，使用迁移率参数 $k_{\\mathrm{th}}$）。\n数值积分：显式，至少二阶精度。\n测试用例：\n$1$: $(x_0,y_0) = (0.10, 0.20)\\,\\mathrm{m}$，$t_{\\mathrm{end}} = 0.50\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 1.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.020\\,\\mathrm{m/s}$。\n$2$: $(x_0,y_0) = (0.10, 0.20)\\,\\mathrm{m}$，$t_{\\mathrm{end}} = 0.50\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 0.0\\,\\mathrm{m^2/s}$，$U_0 = 0.020\\,\\mathrm{m/s}$。\n$3$: $(x_0,y_0) = (0.35, 0.50)\\,\\mathrm{m}$，$t_{\\mathrm{end}} = 1.00\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 3.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.005\\,\\mathrm{m/s}$。\n$4$: $(x_0,y_0) = (0.25, 0.50)\\,\\mathrm{m}$，$t_{\\mathrm{end}} = 3.00\\,\\mathrm{s}$，$\\Delta t = 0.001\\,\\mathrm{s}$，$k_{\\mathrm{th}} = 2.0\\times 10^{-3}\\,\\mathrm{m^2/s}$，$U_0 = 0.050\\,\\mathrm{m/s}$。\n\n该问题已经过有效性评估。它具有科学依据，描述了计算流体动力学和传热学中的一个标准问题。它是一个适定问题，提供了所有必要的数据、初始条件和边界条件。其语言客观而精确。该问题是一项不平凡的计算物理任务，需要推导、数值实现以及对几何形状的仔细处理。它没有违反任何无效性标准。\n结论：问题有效。\n\n现给出解答。\n\n**1. 粒子运动方程的推导**\n\n悬浮在流体中的微小、无惯性粒子的运动由流体赋予的速度和外力赋予的速度之和决定。粒子位置为 $\\boldsymbol{x}_p(t)$。其速度为 $\\boldsymbol{v}_p = d\\boldsymbol{x}_p/dt$。\n\n问题指明了对粒子运动的两个贡献：\n- 由宿主流体速度 $\\boldsymbol{u}$ 引起的平流。\n- 由外力引起的漂移速度。\n\n在蠕动流（低雷诺数）和可忽略惯性的极限下，假定粒子的加速度为零。粒子的总速度是背景流体速度和由外力引起的滑移速度 $\\boldsymbol{v}_{slip}$ 的叠加。\n$$\n\\boldsymbol{v}_p = \\boldsymbol{u} + \\boldsymbol{v}_{slip}\n$$\n滑移速度源于外力 $\\boldsymbol{F}_{ext}$ 与斯托克斯阻力 $\\boldsymbol{F}_D = -\\gamma \\boldsymbol{v}_{slip}$ 之间的平衡，其中 $\\gamma$ 是摩擦系数。力平衡为 $\\boldsymbol{F}_{ext} + \\boldsymbol{F}_D = \\boldsymbol{0}$，得出 $\\boldsymbol{v}_{slip} = \\boldsymbol{F}_{ext} / \\gamma$。\n\n在此问题中，外力是热泳力 $\\boldsymbol{F}_{Th}$。由此产生的滑移速度称为热泳漂移速度 $\\boldsymbol{v}_{Th}$。因此，粒子的运动方程为：\n$$\n\\frac{d\\boldsymbol{x}_p}{dt} = \\boldsymbol{u}(\\boldsymbol{x}_p) + \\boldsymbol{v}_{Th}(\\boldsymbol{x}_p)\n$$\n\n问题要求从线性非平衡热力学推导热泳漂移速度。热泳是由温度梯度引起的粒子运动，通常从较热区域向较冷区域移动。传热的热力学驱动力与逆温度的梯度有关，即 $\\nabla(1/T) = -(\\nabla T)/T^2$。粒子通量，也即漂移速度，与此力成线性比例关系。一个常用且有物理依据的热泳速度模型是：\n$$\n\\boldsymbol{v}_{Th} = -K \\frac{\\nabla T}{T}\n$$\n其中 $K$ 是一个热泳系数。问题引入了一个迁移率参数 $k_{\\mathrm{th}}$，其单位为 $\\mathrm{m^2/s}$。我们将此参数与系数 $K$ 关联起来。为了确认这种关联，我们使用温度对数的梯度来写出速度表达式：\n$$\n\\boldsymbol{v}_{Th} = -k_{\\mathrm{th}} \\nabla(\\ln T) = -k_{\\mathrm{th}} \\frac{\\nabla T}{T}\n$$\n$\\nabla(\\ln T)$ 的单位是 $[(\\nabla T)/T] = (\\mathrm{K}/\\mathrm{m})/\\mathrm{K} = 1/\\mathrm{m}$。因此，$k_{\\mathrm{th}}$ 的单位必须是 $(\\mathrm{m/s}) / (1/\\mathrm{m}) = \\mathrm{m^2/s}$，这与问题陈述中提供的单位完全匹配。这证实了该函数形式。负号确保漂移朝向较冷的温度（与 $\\nabla T$ 的方向相反）。\n\n代入 $\\boldsymbol{u}$ 和 $\\boldsymbol{v}_{Th}$ 的表达式，粒子轨迹 $\\boldsymbol{x}_p(t) = (x_p(t), y_p(t))$ 的最终常微分方程为：\n$$\n\\frac{d\\boldsymbol{x}_p}{dt} = \\begin{pmatrix} U_0 \\\\ 0 \\end{pmatrix} - k_{\\mathrm{th}} \\frac{1}{T(\\boldsymbol{x}_p)} \\begin{pmatrix} \\frac{\\partial T}{\\partial x}(\\boldsymbol{x}_p) \\\\ \\frac{\\partial T}{\\partial y}(\\boldsymbol{x}_p) \\end{pmatrix}\n$$\n\n**2. 数值实现策略**\n\n解将通过对该常微分方程进行数值积分得到。\n\n**2.1. 场离散化与求值**\n首先在指定的 $201 \\times 201$ 网格上计算温度场 $T(x,y)$。\n然后计算每个网格节点上的梯度分量 $\\partial T/\\partial x$ 和 $\\partial T/\\partial y$。按照规定，内部节点使用二阶中心差分，为保证稳健性，边界节点使用一阶向前/向后差分。对于网格上的任意场 $f$：\n$$\n\\left(\\frac{\\partial f}{\\partial x}\\right)_{i,j} =\n\\begin{cases}\n    (f_{i+1,j} - f_{i-1,j}) / (2\\Delta x)  \\text{for } 0  i  N_x-1 \\\\\n    (f_{1,j} - f_{0,j}) / \\Delta x  \\text{for } i=0 \\\\\n    (f_{N_x-1,j} - f_{N_x-2,j}) / \\Delta x  \\text{for } i=N_x-1\n\\end{cases}\n$$\n类似公式适用于 $\\partial f/\\partial y$。这些预先计算的基于网格的 $T$、$\\partial T/\\partial x$ 和 $\\partial T/\\partial y$ 值将作为“CFD数据”。\n\n**2.2. 插值**\n为了在任意非网格粒子位置 $\\boldsymbol{x}_p$ 处求出 $T$ 和 $\\nabla T$，需要进行双线性插值。对于一个场 $f(x,y)$ 和一个位于以 $(x_i, y_j)$ 为角的网格单元内的位置 $(x,y)$，我们找到分数距离 $w_x = (x-x_i)/\\Delta x$ 和 $w_y = (y-y_j)/\\Delta y$。插值结果为：\n$$\nf(x,y) = (1-w_y)\\left[(1-w_x)f_{i,j} + w_x f_{i+1,j}\\right] + w_y\\left[(1-w_x)f_{i,j+1} + w_x f_{i+1,j+1}\\right]\n$$\n此过程独立地应用于场 $T$、$\\partial T/\\partial x$ 和 $\\partial T/\\partial y$。\n\n**2.3. 时间积分**\n问题要求使用至少二阶精度的显式积分器。选择Heun方法（显式梯形法则，或二阶Runge-Kutta方法）。给定在时间 $t_n$ 的粒子位置 $\\boldsymbol{x}_n$，在 $t_{n+1} = t_n + \\Delta t$ 的位置 $\\boldsymbol{x}_{n+1}$ 通过以下方式找到：\n1.  **预测步：**\n    $$\n    \\boldsymbol{v}_1 = \\boldsymbol{v}_p(\\boldsymbol{x}_n) = \\boldsymbol{u}(\\boldsymbol{x}_n) - k_{\\mathrm{th}} \\frac{\\nabla T(\\boldsymbol{x}_n)}{T(\\boldsymbol{x}_n)}\n    $$\n    $$\n    \\boldsymbol{x}^* = \\boldsymbol{x}_n + \\Delta t \\cdot \\boldsymbol{v}_1\n    $$\n2.  **校正步：**\n    $$\n    \\boldsymbol{v}_2 = \\boldsymbol{v}_p(\\boldsymbol{x}^*)\n    $$\n    $$\n    \\boldsymbol{x}_{n+1}^{\\text{proposed}} = \\boldsymbol{x}_n + \\frac{\\Delta t}{2} (\\boldsymbol{v}_1 + \\boldsymbol{v}_2)\n    $$\n在 $\\boldsymbol{x}_n$ 和 $\\boldsymbol{x}^*$ 处的场值使用上述双线性插值方法找到。\n\n**2.4. 边界和障碍物处理**\n在计算出建议的新位置 $\\boldsymbol{x}_{n+1}^{\\text{proposed}}$ 后，必须对照域和障碍物边界进行检查。\n\n**外盒反射：**如果从 $\\boldsymbol{x}_n$ 到 $\\boldsymbol{x}_{n+1}^{\\text{proposed}}$ 的建议步长穿过边界（例如 $x>1$），路径将在边界处被截断。计算交点，并将步长的剩余部分进行反射。对于位于 $x=x_b$ 的垂直边界，反射位移 $\\boldsymbol{d}_{refl}$ 的 $x$ 分量取反。\n$$\n\\boldsymbol{d}_{refl} = (-d_{rem,x}, d_{rem,y})\n$$\n最终位置是交点加上此反射位移。\n\n**椭圆障碍物反射：**如果路径穿入椭圆（即 $\\phi(\\boldsymbol{x}_n) \\ge 0$ 且 $\\phi(\\boldsymbol{x}_{n+1}^{\\text{proposed}})  0$），则执行镜面反射。\n1.  **求交点：**找到从 $\\boldsymbol{x}_n$到 $\\boldsymbol{x}_{n+1}^{\\text{proposed}}$ 的线段与椭圆边界 $\\phi=0$ 的交点。这需要求解路径参数 $s \\in [0,1]$ 的二次方程。设位移为 $\\boldsymbol{d} = \\boldsymbol{x}_{n+1}^{\\text{proposed}} - \\boldsymbol{x}_n$。我们求解 $\\phi(\\boldsymbol{x}_n+s\\boldsymbol{d})=0$ 以得到最小正根 $s_{int}$。交点是 $\\boldsymbol{x}_{int} = \\boldsymbol{x}_n + s_{int}\\boldsymbol{d}$。\n2.  **计算法线：**在 $\\boldsymbol{x}_{int}$ 处椭圆的向外单位法向量 $\\hat{\\boldsymbol{n}}$ 由水平集函数的梯度计算得出：$\\hat{\\boldsymbol{n}} = \\nabla\\phi(\\boldsymbol{x}_{int}) / \\|\\nabla\\phi(\\boldsymbol{x}_{int})\\|$。\n3.  **反射：**剩余的位移向量 $\\boldsymbol{d}_{rem} = (1-s_{int})\\boldsymbol{d}$ 绕交点处的切平面进行反射。反射后的向量是：\n    $$\n    \\boldsymbol{d}_{refl} = \\boldsymbol{d}_{rem} - 2(\\boldsymbol{d}_{rem} \\cdot \\hat{\\boldsymbol{n}})\\hat{\\boldsymbol{n}}\n    $$\n4.  **最终位置：**该时间步的最终位置是 $\\boldsymbol{x}_{n+1} = \\boldsymbol{x}_{int} + \\boldsymbol{d}_{refl}$。\n\n这个序列——时间步进、碰撞检查、反射——会一直重复，直到达到最终时间 $t_{\\mathrm{end}}$。假设每个时间步最多发生一次反射事件，这对于足够小的 $\\Delta t$ 是一个有效的近似。\n实现将使用 `scipy.interpolate.RectBivariateSpline` 来进行高效和准确的双线性插值。", "answer": "```python\nimport numpy as np\nfrom scipy.interpolate import RectBivariateSpline\n\ndef solve():\n    \"\"\"\n    Solves the particle trajectory problem with thermophoresis.\n    \"\"\"\n\n    # --- Constants and Domain Setup ---\n    # Grid parameters\n    Nx, Ny = 201, 201\n    domain_size = 1.0  # meters\n    dx = dy = domain_size / (Nx - 1)\n    x_coords = np.linspace(0, domain_size, Nx)\n    y_coords = np.linspace(0, domain_size, Ny)\n    xx, yy = np.meshgrid(x_coords, y_coords)\n\n    # Temperature field parameters\n    T0 = 300.0  # K\n    Delta_T = 200.0  # K\n    xc, yc = 0.5, 0.5  # m\n    sigma_x, sigma_y = 0.1, 0.15  # m\n    Gx, Gy = 150.0, -50.0  # K/m\n\n    # Obstacle parameters\n    a_ellipse, b_ellipse = 0.12, 0.20  # m\n\n    # --- Pre-computation of Fields ---\n    # Temperature field T(x,y)\n    T_grid = T0 + Delta_T * np.exp(-((xx - xc)**2 / sigma_x**2) - ((yy - yc)**2 / sigma_y**2)) + Gx * xx + Gy * yy\n\n    # Temperature gradient fields using second-order central differences (interior)\n    # and first-order differences (boundaries)\n    grad_Ty_grid, grad_Tx_grid = np.gradient(T_grid, dy, dx)\n\n    # Create interpolators for T and its gradient components\n    # kx=1, ky=1 enforces bilinear interpolation\n    interp_T = RectBivariateSpline(y_coords, x_coords, T_grid, kx=1, ky=1)\n    interp_grad_Tx = RectBivariateSpline(y_coords, x_coords, grad_Tx_grid, kx=1, ky=1)\n    interp_grad_Ty = RectBivariateSpline(y_coords, x_coords, grad_Ty_grid, kx=1, ky=1)\n\n    # --- Physics and Numerics Functions ---\n    def get_velocity(pos, k_th, U0):\n        \"\"\"Calculates particle velocity at a given position.\"\"\"\n        x, y = pos[0], pos[1]\n        \n        # Clamp position to grid bounds for interpolation to avoid errors\n        x = np.clip(x, 0, domain_size)\n        y = np.clip(y, 0, domain_size)\n\n        T_val = interp_T.ev(y, x)\n        grad_Tx_val = interp_grad_Tx.ev(y, x)\n        grad_Ty_val = interp_grad_Ty.ev(y, x)\n        \n        # Avoid division by zero, though T is always > 0 here\n        if T_val  1e-6: T_val = 1e-6\n\n        # Thermophoretic velocity v_th = -k_th * grad(T)/T\n        v_th_x = -k_th * grad_Tx_val / T_val\n        v_th_y = -k_th * grad_Ty_val / T_val\n        \n        # Total velocity = u_fluid + v_th\n        v_total_x = U0 + v_th_x\n        v_total_y = v_th_y\n        \n        return np.array([v_total_x, v_total_y])\n\n    def phi_ellipse(pos):\n        \"\"\"Level set function for the ellipse.\"\"\"\n        return ((pos[0] - xc)**2 / a_ellipse**2) + ((pos[1] - yc)**2 / b_ellipse**2) - 1\n\n    def handle_collisions(pos_old, pos_new):\n        \"\"\"Enforces reflective boundary conditions for box and ellipse.\"\"\"\n        pos_current = pos_new.copy()\n\n        # Chain of reflections, unlikely to happen more than once per step\n        for _ in range(2): \n            # Ellipse reflection\n            phi_old = phi_ellipse(pos_old)\n            phi_new = phi_ellipse(pos_current)\n            \n            if phi_old >= -1e-9 and phi_new  -1e-9:\n                disp = pos_current - pos_old\n                p0x, p0y = pos_old[0] - xc, pos_old[1] - yc\n                dx, dy = disp[0], disp[1]\n\n                A = dx**2 / a_ellipse**2 + dy**2 / b_ellipse**2\n                B = 2 * (p0x * dx / a_ellipse**2 + p0y * dy / b_ellipse**2)\n                C = phi_old\n\n                # Solve quadratic equation for intersection time\n                discriminant = B**2 - 4 * A * C\n                if discriminant >= 0:\n                    s1 = (-B - np.sqrt(discriminant)) / (2 * A)\n                    s = s1 if 0 = s1 = 1 else (-B + np.sqrt(discriminant)) / (2 * A)\n                    \n                    if 0 = s = 1:\n                        pos_intersect = pos_old + s * disp\n                        \n                        # Normal vector at intersection\n                        nx = 2 * (pos_intersect[0] - xc) / a_ellipse**2\n                        ny = 2 * (pos_intersect[1] - yc) / b_ellipse**2\n                        norm_vec = np.array([nx, ny])\n                        norm_mag = np.linalg.norm(norm_vec)\n                        if norm_mag > 0:\n                            n_hat = norm_vec / norm_mag\n                            \n                            # Reflect remaining displacement vector\n                            d_rem = (1 - s) * disp\n                            d_refl = d_rem - 2 * np.dot(d_rem, n_hat) * n_hat\n                            pos_current = pos_intersect + d_refl\n                            pos_old = pos_intersect # Update base for next potential reflection\n\n            # Box reflections\n            if pos_current[0]  0:\n                pos_current[0] = -pos_current[0]\n            elif pos_current[0] > domain_size:\n                pos_current[0] = 2 * domain_size - pos_current[0]\n\n            if pos_current[1]  0:\n                pos_current[1] = -pos_current[1]\n            elif pos_current[1] > domain_size:\n                pos_current[1] = 2 * domain_size - pos_current[1]\n\n        return pos_current\n\n    # --- Test Cases ---\n    test_cases = [\n        # (x0, y0), tend, dt, k_th, U0\n        ( (0.10, 0.20), 0.50, 0.001, 1.0e-3, 0.020 ),\n        ( (0.10, 0.20), 0.50, 0.001, 0.0,    0.020 ),\n        ( (0.35, 0.50), 1.00, 0.001, 3.0e-3, 0.005 ),\n        ( (0.25, 0.50), 3.00, 0.001, 2.0e-3, 0.050 ),\n    ]\n\n    final_positions = []\n    for case in test_cases:\n        x0, y0 = case[0]\n        t_end, dt, k_th, U0 = case[1], case[2], case[3], case[4]\n\n        pos = np.array([x0, y0])\n        t = 0.0\n        \n        num_steps = int(t_end / dt)\n\n        for _ in range(num_steps):\n            # Heun's method (2nd order Runge-Kutta)\n            v1 = get_velocity(pos, k_th, U0)\n            pos_pred = pos + dt * v1\n            \n            # Predictor step shouldn't be reflected, final position yes.\n            v2 = get_velocity(pos_pred, k_th, U0)\n            \n            pos_new_proposed = pos + (dt / 2.0) * (v1 + v2)\n            \n            # Enforce boundary conditions\n            pos_new_final = handle_collisions(pos, pos_new_proposed)\n\n            pos = pos_new_final\n            t += dt\n\n        final_positions.append([round(coord, 6) for coord in pos])\n    \n    # Format output as specified\n    output_str = \"[\" + \",\".join([f\"[{x:.6f},{y:.6f}]\" for x, y in final_positions]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2533303"}]}