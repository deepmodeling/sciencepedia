{"hands_on_practices": [{"introduction": "超临界流体最显著的特征之一是其在赝临界点附近剧烈变化的物性。本练习旨在通过一个具体的计算来量化这种独特性，即比较理想气体模型与精确状态方程（EOS）在预测超临界二氧化碳密度和定压比热容时的巨大偏差 [@problem_id:2527554]。这个实践将帮助你深刻理解为何在分析超临界流体传热时，必须使用能够捕捉真实流体行为的复杂物性模型。", "problem": "一股用于强制对流传热的超临界二氧化碳流，在接近赝临界温度的压力和温度下运行。考虑二氧化碳处于压力 $p = 8.00 \\ \\mathrm{MPa}$ 和温度 $T = 315.0 \\ \\mathrm{K}$（此压力下接近赝临界温度）的工况。来自高精度状态方程 (EOS) 的参考物性值为：密度 $\\rho_{\\mathrm{EOS}} = 560 \\ \\mathrm{kg \\cdot m^{-3}}$ 和定压热容（单位质量）$c_{p,\\mathrm{EOS}} = 7.00 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$。假设普适气体常数 $R_{u} = 8.314462618 \\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$，二氧化碳的摩尔质量为 $M = 44.01 \\ \\mathrm{g \\cdot mol^{-1}}$。将理想气体定压热容视为仅与温度相关，并取其在 $T = 315.0 \\ \\mathrm{K}$ 时的值为 $c_{p}^{0}(T) = 0.90 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$。\n\n仅使用理想气体的基本关系式和分数偏差（定义为模型预测值与参考值之间的分数差）的定义，计算在 $(T,p)$ 条件下，使用理想气体模型代替 EOS 所导致的密度和定压热容的建模偏差。将每个偏差表示为小数形式（无量纲），其中负值表示理想气体模型预测值低于 EOS 值。将每个偏差四舍五入至四位有效数字。\n\n按顺序 $\\left(e_{\\rho}, \\ e_{c_{p}}\\right)$ 提供两个偏差，其中 $e_{\\rho}$ 是密度偏差，$e_{c_{p}}$ 是定压热容偏差。最终答案必须是一对无单位的数字。", "solution": "首先对问题陈述进行验证。\n\n逐字提取已知条件：\n- 压力：$p = 8.00 \\ \\mathrm{MPa}$\n- 温度：$T = 315.0 \\ \\mathrm{K}$\n- 参考 (EOS) 密度：$\\rho_{\\mathrm{EOS}} = 560 \\ \\mathrm{kg \\cdot m^{-3}}$\n- 参考 (EOS) 定压热容：$c_{p,\\mathrm{EOS}} = 7.00 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$\n- 普适气体常数：$R_{u} = 8.314462618 \\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$\n- 二氧化碳的摩尔质量：$M = 44.01 \\ \\mathrm{g \\cdot mol^{-1}}$\n- 理想气体定压热容：$c_{p}^{0}(T) = 0.90 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$\n- 分数偏差的定义：模型预测值与参考值之差，除以参考值。\n\n该问题具有科学依据，提法恰当且客观。它提出了工程热力学中的一个标准任务：在非理想条件下，将真实流体的简化模型（理想气体）与高精度参考数据（EOS）进行比较。为二氧化碳指定的状态点位于靠近赝临界线的超临界区域，在该区域，预计会与理想气体行为产生巨大偏差，这使得本练习具有意义。所有必要数据均已提供，且不存在矛盾。因此，该问题是有效的，将构建一个解决方案。\n\n任务是计算在将超临界二氧化碳建模为理想气体时，密度 $e_{\\rho}$ 和定压热容 $e_{c_{p}}$ 的分数偏差。属性 $X$ 的分数偏差定义为：\n$$ e_X = \\frac{X_{\\mathrm{ideal}} - X_{\\mathrm{EOS}}}{X_{\\mathrm{EOS}}} $$\n\n首先，我们计算理想气体模型预测的密度 $\\rho_{\\mathrm{ideal}}$。以密度表示的理想气体定律由 $pV = nR_uT$ 推导而来。将摩尔数 $n = m/M$（其中 $m$ 是质量）代入，我们得到 $pV = (m/M)R_uT$。重新整理以求解密度 $\\rho = m/V$ 得：\n$$ \\rho_{\\mathrm{ideal}} = \\frac{pM}{R_uT} $$\n我们必须使用一组一致的单位。国际单位制 (SI) 是合适的。\n给定的值为：\n$p = 8.00 \\ \\mathrm{MPa} = 8.00 \\times 10^{6} \\ \\mathrm{Pa}$\n$M = 44.01 \\ \\mathrm{g \\cdot mol^{-1}} = 44.01 \\times 10^{-3} \\ \\mathrm{kg \\cdot mol^{-1}}$\n$R_u = 8.314462618 \\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}$\n$T = 315.0 \\ \\mathrm{K}$\n\n将这些值代入 $\\rho_{\\mathrm{ideal}}$ 的方程中：\n$$ \\rho_{\\mathrm{ideal}} = \\frac{(8.00 \\times 10^{6} \\ \\mathrm{Pa}) \\times (44.01 \\times 10^{-3} \\ \\mathrm{kg \\cdot mol^{-1}})}{(8.314462618 \\ \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}}) \\times (315.0 \\ \\mathrm{K})} \\approx 134.4357 \\ \\mathrm{kg \\cdot m^{-3}} $$\n\n现在，我们使用给定的参考值 $\\rho_{\\mathrm{EOS}} = 560 \\ \\mathrm{kg \\cdot m^{-3}}$ 计算密度的分数偏差 $e_{\\rho}$：\n$$ e_{\\rho} = \\frac{\\rho_{\\mathrm{ideal}} - \\rho_{\\mathrm{EOS}}}{\\rho_{\\mathrm{EOS}}} = \\frac{134.4357 - 560}{560} = \\frac{-425.5643}{560} \\approx -0.759936 $$\n四舍五入到四位有效数字，偏差为 $e_{\\rho} = -0.7599$。负号表示理想气体模型显著低估了密度。这是预料之中的，因为理想气体模型忽略了分子的有限体积和强大的分子间吸引力，而这些因素在高压和高密度下（例如在临界点附近的超临界状态下）变得占主导地位。\n\n接下来，我们计算定压热容的分数偏差 $e_{c_{p}}$。对于理想气体，定压热容 $c_{p}$ 仅是温度的函数，与压力无关。问题直接给出了这个理想气体值 $c_{p}^{0}(T) = 0.90 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$。因此，我们的模型预测值为：\n$$ c_{p,\\mathrm{ideal}} = 0.90 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}} $$\n参考值给定为 $c_{p,\\mathrm{EOS}} = 7.00 \\ \\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$。我们现在可以计算偏差：\n$$ e_{c_{p}} = \\frac{c_{p,\\mathrm{ideal}} - c_{p,\\mathrm{EOS}}}{c_{p,\\mathrm{EOS}}} = \\frac{0.90 - 7.00}{7.00} = \\frac{-6.10}{7.00} \\approx -0.871428 $$\n四舍五入到四位有效数字，偏差为 $e_{c_{p}} = -0.8714$。这种显著的低估是赝临界区域的一个标志，在该区域，真实流体的定压热容呈现一个尖峰，而这是理想气体模型从根本上无法捕捉的。这个峰值与温度微小变化引起的密度和焓的巨大变化有关，这种现象在理想气体中不存在。\n\n所求的偏差为 $(e_{\\rho}, e_{c_{p}})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -0.7599  -0.8714 \\end{pmatrix}}\n$$", "id": "2527554"}, {"introduction": "在了解了超临界流体物性的特殊性之后，下一步是表征其流动与传热的物理机制。这个练习将指导你计算一系列关键的无量纲参数，包括雷诺数（$Re_b$）、普朗特数（$Pr_b$）、格拉晓夫数（$Gr_q$）和理查森数（$Ri$）[@problem_id:2527543]。通过这些计算，你将学会如何定量评估流动中的惯性力、粘性力、浮升力以及强制对流与自然对流的相对重要性，这是预测和分析超临界流体传热行为的基础。", "problem": "一根内径为 $D$ 的竖直均匀加热圆管中，超临界流体在稳定工况下向上流动。壁面热通量在空间上是均匀的，其大小为 $q''$。流动的特征为恒定的质量通量 $G$ 和在主体温度下评估的主体热物理性质（用下标 $b$ 表示）。假设流体为物性恒定的牛顿流体，并在动量方程中对浮力项采用 Boussinesq 近似。\n\n使用以下主体性质和操作参数：$G = 500\\,\\mathrm{kg \\cdot m^{-2} \\cdot s^{-1}}$，$D = 6\\,\\mathrm{mm}$，$q'' = 250\\,\\mathrm{kW \\cdot m^{-2}}$，$k_b = 0.12\\,\\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$，$\\nu_b = 1.2\\times 10^{-7}\\,\\mathrm{m^2 \\cdot s^{-1}}$，$\\beta = 0.02\\,\\mathrm{K}^{-1}$，$c_{p,b} = 5\\,\\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}}$，以及 $\\mu_b = 4.5\\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$，并结合标准重力加速度 $g=9.81\\,\\mathrm{m \\cdot s^{-2}}$，确定在主体工况下评估的以下无量纲数群：\n- 主体雷诺数 $Re_b$，\n- 主体普朗特数 $Pr_b$，\n- 适用于内部流动中均匀壁面热通量的、基于热通量的格拉晓夫数 $Gr_q$，以及\n- 基于浮力与惯性力之比的相应理查森数 $Ri$。\n\n将您的最终结果以行向量 $[Re_b,\\;Pr_b,\\;Gr_q,\\;Ri]$ 的形式给出，并四舍五入到四位有效数字。所有量均为无量纲；报告最终答案时无需写出单位。", "solution": "问题陈述经过严格验证，并被确定是合理的。它在科学上基于流体力学和传热学原理，内部逻辑一致，并提供了计算所要求的无量纲参数所需的所有必要信息。该问题是热流体分析中的一个标准练习。\n\n任务是计算四个无量纲数：主体雷诺数（$Re_b$）、主体普朗特数（$Pr_b$）、基于热通量的格拉晓夫数（$Gr_q$）和理查森数（$Ri$）。\n\n首先，我们必须将所有给定参数用国际单位制（SI）基本单位表示。\n给定的参数如下：\n- 质量通量, $G = 500\\,\\mathrm{kg \\cdot m^{-2} \\cdot s^{-1}}$\n- 管内径, $D = 6\\,\\text{mm} = 6 \\times 10^{-3}\\,\\text{m}$\n- 壁面热通量, $q'' = 250\\,\\mathrm{kW \\cdot m^{-2}} = 2.5 \\times 10^5\\,\\mathrm{W \\cdot m^{-2}}$\n- 主体导热系数, $k_b = 0.12\\,\\mathrm{W \\cdot m^{-1} \\cdot K^{-1}}$\n- 主体运动粘度, $\\nu_b = 1.2 \\times 10^{-7}\\,\\mathrm{m^2 \\cdot s^{-1}}$\n- 体积热膨胀系数, $\\beta = 0.02\\,\\text{K}^{-1}$\n- 主体定压比热容, $c_{p,b} = 5\\,\\mathrm{kJ \\cdot kg^{-1} \\cdot K^{-1}} = 5 \\times 10^3\\,\\mathrm{J \\cdot kg^{-1} \\cdot K^{-1}}$\n- 主体动力粘度, $\\mu_b = 4.5 \\times 10^{-5}\\,\\mathrm{Pa \\cdot s}$\n- 重力加速度, $g = 9.81\\,\\mathrm{m \\cdot s^{-2}}$\n\n所需无量纲参数的定义如下：\n\n主体雷诺数 $Re_b$ 是惯性力与粘性力之比。它使用质量通量 $G$ 定义为：\n$$\nRe_b = \\frac{G D}{\\mu_b}\n$$\n\n主体普朗特数 $Pr_b$ 是动量扩散率（运动粘度）与热扩散率之比。其定义为：\n$$\nPr_b = \\frac{\\mu_b c_{p,b}}{k_b}\n$$\n\n用于内部流动和均匀壁面热通量的、基于热通量的格拉晓夫数 $Gr_q$ 表征了浮力与粘性力之比。其定义为：\n$$\nGr_q = \\frac{g \\beta q'' D^4}{k_b \\nu_b^2}\n$$\n\n理查森数 $Ri$ 表示自然对流（浮力）相对于强迫对流（惯性）的重要性。它被定义为格拉晓夫数与雷诺数平方之比：\n$$\nRi = \\frac{Gr_q}{Re_b^2}\n$$\n\n现在，我们将给定的数值代入这些定义中来计算这些数。\n\n1.  主体雷诺数 $Re_b$ 的计算：\n    $$\n    Re_b = \\frac{(500) \\cdot (6 \\times 10^{-3})}{4.5 \\times 10^{-5}} = \\frac{3}{4.5 \\times 10^{-5}} = \\frac{2}{3} \\times 10^5 = 66666.\\overline{6}\n    $$\n    四舍五入到四位有效数字，$Re_b \\approx 6.667 \\times 10^4$。\n\n2.  主体普朗特数 $Pr_b$ 的计算：\n    $$\n    Pr_b = \\frac{(4.5 \\times 10^{-5}) \\cdot (5 \\times 10^3)}{0.12} = \\frac{0.225}{0.12} = 1.875\n    $$\n    该值精确到四位有效数字。\n\n3.  基于热通量的格拉晓夫数 $Gr_q$ 的计算：\n    $$\n    Gr_q = \\frac{(9.81) \\cdot (0.02) \\cdot (2.5 \\times 10^5) \\cdot (6 \\times 10^{-3})^4}{(0.12) \\cdot (1.2 \\times 10^{-7})^2}\n    $$\n    $$\n    Gr_q = \\frac{(9.81) \\cdot (0.02) \\cdot (2.5 \\times 10^5) \\cdot (1.296 \\times 10^{-9})}{(0.12) \\cdot (1.44 \\times 10^{-14})}\n    $$\n    $$\n    Gr_q = \\frac{6.35688 \\times 10^{-5}}{1.728 \\times 10^{-15}} = 3.67875 \\times 10^{10}\n    $$\n    四舍五入到四位有效数字，$Gr_q \\approx 3.679 \\times 10^{10}$。\n\n4.  理查森数 $Ri$ 的计算：\n    为保持精度，我们使用 $Gr_q$ 和 $Re_b$ 未经四舍五入的值。\n    $$\n    Ri = \\frac{Gr_q}{Re_b^2} = \\frac{3.67875 \\times 10^{10}}{(66666.\\overline{6})^2} = \\frac{3.67875 \\times 10^{10}}{(\\frac{2}{3} \\times 10^5)^2} = \\frac{3.67875 \\times 10^{10}}{\\frac{4}{9} \\times 10^{10}}\n    $$\n    $$\n    Ri = \\frac{3.67875}{\\frac{4}{9}} = 3.67875 \\times \\frac{9}{4} = 8.2771875\n    $$\n    四舍五入到四位有效数字，$Ri \\approx 8.277$。\n\n最终结果四舍五入到四位有效数字后为：\n$Re_b = 6.667 \\times 10^4$\n$Pr_b = 1.875$\n$Gr_q = 3.679 \\times 10^{10}$\n$Ri = 8.277$\n这些结果将以行向量 $[Re_b,\\;Pr_b,\\;Gr_q,\\;Ri]$ 的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6.667 \\times 10^{4}  1.875  3.679 \\times 10^{10}  8.277 \\end{pmatrix}}\n$$", "id": "2527543"}, {"introduction": "真实工程系统中的传热过程往往是动态的，而非恒定不变。本综合性编程练习要求你从第一性原理出发，建立一个集总参数模型来模拟管道中超临界流体在经历热流密度阶跃变化时的瞬态响应 [@problem_id:2527537]。通过数值求解常微分方程组，你将能够捕捉因流体物性（尤其是比热容$c_p$）剧烈变化而导致的复杂现象，例如壁温超调，从而加深对系统动态行为和传热恶化机理的理解。", "problem": "考虑一个单程、充分混合的控制体模型，用于描述超临界流体在具有外部施加的热通量的受热管道内的流动。目标是计算壁面温度 $T_w(t)$ 和主流体温度 $T_b(t)$ 对施加的壁面热通量 $q''(t)$ 发生阶跃增加时的瞬态响应，同时考虑定压比热 $c_p(T)$ 在赝临界温度（$T_{pc}$）附近的强温度依赖性。您的模型应从能量守恒第一性原理推导得出，并实现为一个能够数值求解该初值问题的程序。然后，使用计算出的轨迹来评估在阶跃发生后，$T_w(t)$ 和 $T_b(t)$ 是否在 $T_{pc}$ 附近出现过冲现象。\n\n建模假设如下：\n- 控制体中的壁面和流体分别由单个集总热容表示，其温度分别为 $T_w(t)$ 和 $T_b(t)$。\n- 壁面与流体之间的热相互作用由对流换热系数 $h(T_b)$ 和界面面积 $A$ 表示。\n- 施加的热通量 $q''(t)$ 在空间上是均匀的，并在 $t=0$ 时从 $q_0''$ 阶跃变化到 $q_1''$。\n- 流体以恒定的质量流量 $\\dot{m}$ 和恒定的密度 $\\rho$ 流过体积为 $V_b$ 的控制体；入口流体温度 $T_{in}$ 是恒定的。\n- 定压比热 $c_p(T)$ 在 $T_{pc}$ 附近表现出一个峰值，并由一个基准值加上一个高斯峰来建模：\n$$\nc_p(T) = c_0 + c_1 \\exp\\!\\left(-\\frac{(T - T_{pc})^2}{2\\sigma^2}\\right),\n$$\n其中 $c_00$，$c_1 \\ge 0$，且 $\\sigma0$。\n- 对流系数 $h(T_b)$ 允许在 $T_{pc}$ 附近通过一个平滑凹陷模型退化：\n$$\nh(T_b) = \\frac{h_0}{1 + \\alpha \\exp\\!\\left(-\\frac{(T_b - T_{pc})^2}{2\\sigma_h^2}\\right)},\n$$\n其中 $h_00$，$\\alpha\\ge 0$，且 $\\sigma_h0$。设置 $\\alpha=0$ 可恢复为常数 $h(T_b)=h_0$。\n\n从壁面控制质量和流体控制体的能量守恒出发。使用比焓 $h_f(T)$ 的定义\n$$\nh_f(T) = \\int_{0}^{T} c_p(\\theta)\\, d\\theta,\n$$\n并用焓来表示主流体能量平衡。基于这些基本原理，推导控制 $T_w(t)$ 和 $T_b(t)$ 的耦合非线性常微分方程，其中 $c_p(T)$ 和 $h(T_b)$ 是唯二的温度依赖性物性。假设壁面具有恒定的热容 $m_w c_w$，流体的热惯性为 $m_b c_p(T_b)$，其中 $m_b = \\rho V_b$。\n\n通过将时间导数设为零来定义稳态。对于任意恒定的 $q''$，稳态主流体温度 $T_{b,ss}$ 满足焓平衡关系\n$$\nh_f(T_{b,ss}) - h_f(T_{in}) = \\frac{A\\,q''}{\\dot{m}},\n$$\n稳态壁面温度则由对流平衡得出\n$$\nT_{w,ss} = T_{b,ss} + \\frac{q''}{h(T_{b,ss})}.\n$$\n\n$t=0^-$ 时的初始条件是对应于 $q_0''$ 的稳态值。在 $t=0^+$ 时，$q''$ 瞬时阶跃至 $q_1''$，后续的瞬态过程由推导出的常微分方程控制，其中 $q''(t)=q_1''$。进行积分，直到系统足够接近新的稳态。然后，将过冲幅度定义为\n$$\n\\Delta T_{w,ov} = \\max_{t\\ge 0} T_w(t) - T_{w,ss}, \\quad\n\\Delta T_{b,ov} = \\max_{t\\ge 0} T_b(t) - T_{b,ss}.\n$$\n以开尔文为单位报告过冲幅度，四舍五入到三位小数。\n\n物理单位和数值要求：\n- 温度必须以开尔文为单位，热通量以 $\\mathrm{W/m^2}$ 为单位，面积以 $\\mathrm{m^2}$ 为单位，质量流量以 $\\mathrm{kg/s}$ 为单位，密度以 $\\mathrm{kg/m^3}$ 为单位，热容以 $\\mathrm{J/(kg·K)}$ 为单位，时间以秒为单位，$h$ 以 $\\mathrm{W/(m^2·K)}$ 为单位。\n- 您的程序必须通过求解焓方程来计算稳态，并且必须使用数值稳定的方法对非线性系统进行积分，直到状态与最终稳态的绝对容差在 $\\varepsilon = 10^{-4}\\ \\mathrm{K}$ 以内，或达到最大时间 $t_{max}$。如果先达到 $t_{max}$，则使用截至 $t_{max}$ 的计算轨迹来评估过冲。\n\n测试套件：\n实现您的程序，为以下四个参数集评估过冲幅度。在每种情况下，使用所提供的参数计算两个过冲幅度 $(\\Delta T_{w,ov}, \\Delta T_{b,ov})$。\n\n所有测试的通用参数（除非明确更改）：\n- $A = 0.1\\ \\mathrm{m^2}$，$h_0 = 2000\\ \\mathrm{W/(m^2·K)}$，$\\rho = 400\\ \\mathrm{kg/m^3}$，$V_b = 0.01\\ \\mathrm{m^3}$，$m_w = 5.0\\ \\mathrm{kg}$，$c_w = 500\\ \\mathrm{J/(kg·K)}$，$c_0 = 1500\\ \\mathrm{J/(kg·K)}$，$t_{max} = 200\\ \\mathrm{s}$，$\\varepsilon = 10^{-4}\\ \\mathrm{K}$。\n\n情况 1（靠近 $T_{pc}$ 且 $h$ 退化）：\n- $T_{in} = 300\\ \\mathrm{K}$，$T_{pc} = 307\\ \\mathrm{K}$，$c_1 = 12000\\ \\mathrm{J/(kg·K)}$，$\\sigma = 5\\ \\mathrm{K}$，\n- $\\alpha = 1.0$，$\\sigma_h = 5\\ \\mathrm{K}$，\n- $\\dot{m} = 0.5\\ \\mathrm{kg/s}$，$q_0'' = 20000\\ \\mathrm{W/m^2}$，$q_1'' = 60000\\ \\mathrm{W/m^2}$。\n\n情况 2（靠近 $T_{pc}$ 且 $h$ 恒定）：\n- 与情况 1 相同，除了 $\\alpha = 0$。\n\n情况 3（更宽的 $c_p$ 峰值， $h$ 退化）：\n- 与情况 1 相同，除了 $\\sigma = 20\\ \\mathrm{K}$。\n\n情况 4（小阶跃， $h$ 退化）：\n- 与情况 1 相同，除了 $q_1'' = 24000\\ \\mathrm{W/m^2}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个条目都应是一个方括号对，顺序为 $[\\Delta T_{w,ov}, \\Delta T_{b,ov}]$。例如，格式必须是\n$$\n\\big[\\,[x_{1},y_{1}],[x_{2},y_{2}],[x_{3},y_{3}],[x_{4},y_{4}]\\,\\big],\n$$\n其中每个 $x_i$ 和 $y_i$ 是以开尔文为单位的浮点数，按标准舍入规则保留三位小数。报告值的单位是开尔文。", "solution": "该问题要求分析超临界流体在管道中的瞬态传热过程。在进行求解之前，必须进行严格的验证。\n\n该问题被构建为一个集总参数模型，这是热工领域中分析系统动力学的标准且有效的简化方法。它基于能量守恒的基本原理。所有参数、物性（$c_p(T)$）和输运系数（$h(T_b)$）的函数形式以及边界条件都已明确定义。$c_p(T)$ 和 $h(T_b)$ 的模型，即在赝临界温度 $T_{pc}$ 附近包含一个高斯峰和一个凹陷，是对超临界状态下真实流体行为在唯象上合理的表示。该问题是适定的，提供了足够的信息来推导和求解一个常微分方程（ODE）组。数值是物理上合理的。该问题被认为是科学上合理、自洽且可解的。没有缺陷。我们继续。\n\n该系统通过两个耦合的非线性一阶常微分方程进行建模，分别描述壁面温度 $T_w(t)$ 和主流体温度 $T_b(t)$。这些方程由热力学第一定律推导得出。\n\n首先，考虑壁面的能量平衡，将其视为一个热容为 $m_w c_w$ 的单一热质量。其内能的变化率 $m_w c_w \\frac{dT_w}{dt}$ 等于净热量增加率。这等于外部热通量提供的热量 $q''(t)A$ 减去对流给流体的热量 $h(T_b) A (T_w - T_b)$。这里，$A$ 是传热表面积。得到的方程是：\n$$\nm_w c_w \\frac{dT_w}{dt} = q''(t)A - h(T_b) A (T_w - T_b)\n$$\n整理得到第一个控制方程：\n$$\n\\frac{dT_w}{dt} = \\frac{A}{m_w c_w} \\left( q''(t) - h(T_b) (T_w - T_b) \\right)\n$$\n\n其次，考虑控制体积 $V_b$ 内流体的能量平衡。对于一个开放系统，控制体内内能的变化率等于跨越其边界的净能量传递率。\n$$\n\\frac{dU_b}{dt} = \\dot{Q} + \\dot{m}(h_{f,in} - h_{f,out})\n$$\n根据指定的流体热惯性，内能变化率为 $\\frac{dU_b}{dt} = m_b c_p(T_b) \\frac{dT_b}{dt}$，其中 $m_b = \\rho V_b$ 是控制体积内的流体质量，$c_p(T_b)$ 是在主流体温度下计算的比热。从壁面到流体的传热率为 $\\dot{Q} = h(T_b) A (T_w - T_b)$。流体流动的净焓输运率为 $\\dot{m}(h_{f,in} - h_{f,out})$，其中 $\\dot{m}$ 是质量流量。对于一个充分混合的控制体，出口焓为 $h_{f,out} = h_f(T_b)$，入口焓为 $h_{f,in} = h_f(T_{in})$。这得出：\n$$\nm_b c_p(T_b) \\frac{dT_b}{dt} = h(T_b) A (T_w - T_b) + \\dot{m} (h_f(T_{in}) - h_f(T_b))\n$$\n整理得到第二个控制方程：\n$$\n\\frac{dT_b}{dt} = \\frac{1}{\\rho V_b c_p(T_b)} \\left( h(T_b) A (T_w - T_b) - \\dot{m} (h_f(T_b) - h_f(T_{in})) \\right)\n$$\n\n该常微分方程组需要 $c_p(T)$、$h(T_b)$ 和比焓 $h_f(T)$ 的表达式。函数 $c_p(T)$ 和 $h(T_b)$ 已给出：\n$$\nc_p(T) = c_0 + c_1 \\exp\\!\\left(-\\frac{(T - T_{pc})^2}{2\\sigma^2}\\right)\n$$\n$$\nh(T_b) = \\frac{h_0}{1 + \\alpha \\exp\\!\\left(-\\frac{(T_b - T_{pc})^2}{2\\sigma_h^2}\\right)}\n$$\n比焓 $h_f(T)$ 通过从一个参考温度（此处根据问题定义取为 $0\\ \\mathrm{K}$）积分 $c_p(T)$ 得到，$h_f(T) = \\int_{0}^{T} c_p(\\theta)\\, d\\theta$。高斯项的积分可以用误差函数 $\\mathrm{erf}(x)$ 表示。常微分方程中所需的焓差为：\n$$\nh_f(T_b) - h_f(T_{in}) = c_0(T_b - T_{in}) + c_1 \\sigma \\sqrt{\\frac{\\pi}{2}} \\left[ \\mathrm{erf}\\left(\\frac{T_b - T_{pc}}{\\sqrt{2}\\sigma}\\right) - \\mathrm{erf}\\left(\\frac{T_{in} - T_{pc}}{\\sqrt{2}\\sigma}\\right) \\right]\n$$\n\n为了解决这个问题，我们首先确定初始和最终的稳态。在稳态下，所有时间导数均为零。从流体和壁面的能量平衡中，我们得到问题陈述中规定的方程。首先，我们从非线性方程中求解主流体温度 $T_{b,ss}$：\n$$\nh_f(T_{b,ss}) - h_f(T_{in}) = \\frac{A\\,q''}{\\dot{m}}\n$$\n由于 $c_p(T)  0$，$h_f(T)$ 是一个严格单调函数，这保证了 $T_{b,ss}$ 有唯一解。该解通过使用求根算法进行数值求解。一旦 $T_{b,ss}$ 已知，壁面温度 $T_{w,ss}$ 可直接计算：\n$$\nT_{w,ss} = T_{b,ss} + \\frac{q''}{h(T_{b,ss})}\n$$\n此过程应用两次：一次使用 $q'' = q_0''$ 来找到初始状态 $(T_{w}(0), T_{b}(0))$，另一次使用 $q'' = q_1''$ 来找到用于计算过冲的最终稳态 $(T_{w,ss}, T_{b,ss})$。\n\n瞬态响应是通过从 $t=0$ 到最终时间 $t_{f}$ 对 ODE 系统进行数值积分来计算的。积分以初始条件 $(T_w(0), T_b(0))$ 和热通量固定在 $q'' = q_1''$ 的情况下进行。采用一个稳健的数值积分方案 `scipy.integrate.solve_ivp`，它适用于潜在的刚性系统。当系统状态 $(T_w(t), T_b(t))$ 与最终稳态的差值在指定的容差 $\\varepsilon = 10^{-4}\\ \\mathrm{K}$ 内时，或者当达到最大时间 $t_{max} = 200\\ \\mathrm{s}$ 时，积分终止。积分器内的事件检测机制处理此终止条件。\n\n最后，从计算出的轨迹 $T_w(t)$ 和 $T_b(t)$ 中确定温度过冲。它们被定义为超过最终稳态值的最大偏差：\n$$\n\\Delta T_{w,ov} = \\max\\left(0, \\max_{t\\ge 0} T_w(t) - T_{w,ss}\\right)\n$$\n$$\n\\Delta T_{b,ov} = \\max\\left(0, \\max_{t\\ge 0} T_b(t) - T_{b,ss}\\right)\n$$\n对四个指定的测试用例中的每一个都进行计算，并以要求的格式呈现结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.optimize import brentq\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Computes the transient temperature response and overshoot for a supercritical\n    fluid heat transfer problem.\n    \"\"\"\n    # Common physical parameters\n    A = 0.1  # m^2\n    h0 = 2000.0  # W/(m^2*K)\n    rho = 400.0  # kg/m^3\n    Vb = 0.01  # m^3\n    mw = 5.0  # kg\n    cw = 500.0  # J/(kg*K)\n    c0 = 1500.0  # J/(kg*K)\n    \n    # Numerical parameters\n    t_max = 200.0  # s\n    epsilon = 1e-4  # K\n\n    # Derived constants\n    mb = rho * Vb\n    mw_cw = mw * cw\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: near T_pc with degraded h\n        {'T_in': 300.0, 'T_pc': 307.0, 'c_1': 12000.0, 'sigma': 5.0,\n         'alpha': 1.0, 'sigma_h': 5.0, 'm_dot': 0.5, 'q0_pp': 20000.0, 'q1_pp': 60000.0},\n        # Case 2: near T_pc with constant h\n        {'T_in': 300.0, 'T_pc': 307.0, 'c_1': 12000.0, 'sigma': 5.0,\n         'alpha': 0.0, 'sigma_h': 5.0, 'm_dot': 0.5, 'q0_pp': 20000.0, 'q1_pp': 60000.0},\n        # Case 3: broader c_p peak, degraded h\n        {'T_in': 300.0, 'T_pc': 307.0, 'c_1': 12000.0, 'sigma': 20.0,\n         'alpha': 1.0, 'sigma_h': 5.0, 'm_dot': 0.5, 'q0_pp': 20000.0, 'q1_pp': 60000.0},\n        # Case 4: small step, degraded h\n        {'T_in': 300.0, 'T_pc': 307.0, 'c_1': 12000.0, 'sigma': 5.0,\n         'alpha': 1.0, 'sigma_h': 5.0, 'm_dot': 0.5, 'q0_pp': 20000.0, 'q1_pp': 24000.0},\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        # Unpack parameters for the current case\n        T_in, T_pc, c_1, sigma = params['T_in'], params['T_pc'], params['c_1'], params['sigma']\n        alpha, sigma_h, m_dot = params['alpha'], params['sigma_h'], params['m_dot']\n        q0_pp, q1_pp = params['q0_pp'], params['q1_pp']\n\n        # Define case-specific helper functions\n        def cp(T):\n            return c0 + c_1 * np.exp(-((T - T_pc)**2) / (2.0 * sigma**2))\n\n        def h_conv(Tb):\n            return h0 / (1.0 + alpha * np.exp(-((Tb - T_pc)**2) / (2.0 * sigma_h**2)))\n\n        def h_f_diff(T_end, T_start):\n            term1 = c0 * (T_end - T_start)\n            erf_factor = np.sqrt(np.pi / 2.0)\n            erf_arg_end = (T_end - T_pc) / (np.sqrt(2.0) * sigma)\n            erf_arg_start = (T_start - T_pc) / (np.sqrt(2.0) * sigma)\n            term2 = c_1 * sigma * erf_factor * (erf(erf_arg_end) - erf(erf_arg_start))\n            return term1 + term2\n\n        # Define steady-state solver\n        def solve_ss(q_pp):\n            target_h_diff = A * q_pp / m_dot\n            def root_func(Tb):\n                return h_f_diff(Tb, T_in) - target_h_diff\n            \n            # Find Tb_ss using a robust root-finding method\n            Tb_ss = brentq(root_func, T_in, T_in + 2000.0)\n            Tw_ss = Tb_ss + q_pp / h_conv(Tb_ss)\n            return Tw_ss, Tb_ss\n\n        # 1. Calculate initial steady state for q0_pp\n        Tw0, Tb0 = solve_ss(q0_pp)\n        y0 = np.array([Tw0, Tb0])\n\n        # 2. Calculate final steady state for q1_pp\n        Tw1_ss, Tb1_ss = solve_ss(q1_pp)\n\n        # 3. Define the ODE system for transient analysis (uses q1_pp)\n        def ode_system(t, y):\n            Tw, Tb = y\n            q_pp = q1_pp\n            \n            dTw_dt = (A / mw_cw) * (q_pp - h_conv(Tb) * (Tw - Tb))\n            enthalpy_flow = m_dot * h_f_diff(Tb, T_in)\n            dTb_dt = (1.0 / (mb * cp(Tb))) * (h_conv(Tb) * A * (Tw - Tb) - enthalpy_flow)\n            \n            return [dTw_dt, dTb_dt]\n\n        # 4. Define the termination event\n        def near_ss(t, y):\n            Tw, Tb = y\n            return max(abs(Tw - Tw1_ss), abs(Tb - Tb1_ss)) - epsilon\n        near_ss.terminal = True\n\n        # 5. Integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, t_max],\n            y0=y0,\n            method='Radau',  # A good choice for potentially stiff problems\n            dense_output=True,\n            events=near_ss\n        )\n\n        # 6. Calculate overshoots from the solution trajectory\n        if sol.y.shape[1] > 0:\n            max_Tw = np.max(sol.y[0, :])\n            max_Tb = np.max(sol.y[1, :])\n        else:  # This case should ideally not be reached\n            max_Tw, max_Tb = Tw0, Tb0\n        \n        dTw_ov = max(0.0, max_Tw - Tw1_ss)\n        dTb_ov = max(0.0, max_Tb - Tb1_ss)\n        \n        results.append([dTw_ov, dTb_ov])\n\n    # Final print statement in the exact required format.\n    str_parts = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in results]\n    print(f\"[[{','.join(str_parts)}]]\")\n\nsolve()\n```", "id": "2527537"}]}