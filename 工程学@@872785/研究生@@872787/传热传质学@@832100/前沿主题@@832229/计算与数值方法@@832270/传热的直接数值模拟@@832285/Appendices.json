{"hands_on_practices": [{"introduction": "在规划直接数值模拟（DNS）时，首要且最关键的步骤是确定所需的网格分辨率。这个分辨率必须足以精确地捕捉流场和标量场中最小的动态相关尺度。本练习 [@problem_id:2477585] 将指导您完成一个核心的DNS设计任务：根据给定的湍流耗散率和流体属性，计算速度场的Kolmogorov尺度（$\\eta$）和温度场的Batchelor尺度（$\\eta_B$），并将这些物理尺度转化为具体的网格间距要求，这是设计任何高保真度模拟的基础技能。", "problem": "计划在一种运动粘度为 $\\nu$、普朗特数为 $\\Pr$ 的牛顿流体中，对均匀各向同性湍流进行直接数值模拟 (DNS)，其中温度场被视为一个被动标量。单位质量的平均动能耗散率估计为 $\\epsilon$。模拟将使用均匀笛卡尔网格和二阶中心差分格式。在以往的DNS实践中，一个常用的精度目标是解析出最小的动态相关尺度，使得在速度场和标量场中，最大可解析波数与最小尺度的乘积至少达到一个预设的阈值。具体来说，设速度场和温度场的目标阈值分别为 $\\alpha_{u}$ 和 $\\alpha_{T}$，其中最大可解析波数由网格的奈奎斯特极限近似为 $k_{\\max} \\approx \\pi/\\Delta x$。从 Kolmogorov 长度尺度（用于速度）和 Batchelor 尺度（当 $\\Pr \\ge 1$ 时用于温度）的定义出发，并基于湍流与扩散时间尺度平衡的量纲推理，推导出满足上述解析目标的网格间距要求 $\\Delta x \\lesssim c_{1}\\,\\eta$ 和 $\\Delta x_{T} \\lesssim c_{2}\\,\\eta_{B}$ 中的常数 $c_{1}$ 和 $c_{2}$ 的符号表达式。然后，使用以下数据，\n- $\\nu = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}/s}$，\n- $\\epsilon = 1.0 \\times 10^{-1}\\ \\mathrm{m^{2}/s^{3}}$，\n- $\\Pr = 7$，\n- $\\alpha_{u} = 1.5$ 和 $\\alpha_{T} = 1.5$，\n计算这些要求所对应的两个上限值 $\\Delta x_{\\max}$ 和 $\\Delta x_{T,\\max}$ 的数值。根据以往的DNS实践，论证所选 $\\alpha_{u}$ 和 $\\alpha_{T}$ 的合理性，并解释为何当 $\\Pr \\ge 1$ 时，标量场的判据通常更为严格。将两个数值答案以米为单位表示，并四舍五入到三位有效数字。", "solution": "所提出的问题是一个确定带有被动标量的湍流直接数值模拟（DNS）网格分辨率要求的标准练习。该问题具有科学依据，是适定的，并包含足够的信息以获得唯一解。因此，该问题是有效的。\n\n分析过程分为三个部分。首先，推导网格间距要求的符号常数。其次，计算速度场和标量场的最大允许网格间距的数值。第三，对所给定的分辨率参数以及标量分辨率判据的相对严格性进行论证。\n\n速度场中最小的动态相关长度尺度是 Kolmogorov 长度尺度 $\\eta$，其定义为惯性力与粘性力量级相同的尺度。它由下式给出\n$$ \\eta = \\left( \\frac{\\nu^3}{\\epsilon} \\right)^{1/4} $$\n其中 $\\nu$ 是运动粘度，$\\epsilon$ 是单位质量的平均动能耗散率。\n\n对于普朗特数 $\\Pr = \\nu / \\kappa \\ge 1$ 的被动标量场，其中 $\\kappa$ 是热扩散率，标量脉动的最小长度尺度，即 Batchelor 尺度 $\\eta_B$，小于 Kolmogorov 尺度。在该尺度上，来自最小湍流涡的应变率与分子扩散相平衡。对于 $\\Pr \\ge 1$，该尺度由下式给出\n$$ \\eta_B = \\frac{\\eta}{\\sqrt{\\Pr}} = \\left( \\frac{\\nu \\kappa^2}{\\epsilon} \\right)^{1/4} $$\n\n数值模拟的分辨率判据是基于确保网格足够精细以解析这些最小尺度。一种常见的方法是要求最大可解析波数 $k_{\\max}$ 与相关物理尺度（$\\eta$ 或 $\\eta_B$）的乘积超过某个阈值 $\\alpha$。对于间距为 $\\Delta x$ 的均匀笛卡尔网格，最大可解析波数是奈奎斯特波数 $k_{\\max} = \\pi / \\Delta x$。\n\n对于速度场，分辨率要求为\n$$ k_{\\max} \\eta \\ge \\alpha_u $$\n代入 $k_{\\max} = \\pi / \\Delta x$，我们得到\n$$ \\frac{\\pi}{\\Delta x} \\eta \\ge \\alpha_u $$\n重新整理这个不等式以求出网格间距 $\\Delta x$ 的上限，得到\n$$ \\Delta x \\le \\frac{\\pi}{\\alpha_u} \\eta $$\n问题将此关系定义为 $\\Delta x \\lesssim c_1 \\eta$。通过直接比较，常数 $c_1$ 是\n$$ c_1 = \\frac{\\pi}{\\alpha_u} $$\n\n类似地，对于被动标量（温度）场，分辨率要求为\n$$ k_{\\max} \\eta_B \\ge \\alpha_T $$\n假设用于解析温度场的网格间距为 $\\Delta x_T$，则奈奎斯特波数为 $k_{\\max} = \\pi / \\Delta x_T$。注意，对于单网格模拟，必须使用一个同时满足速度场和标量场分辨率要求的单一 $\\Delta x$。该问题要求的是各自的上限，我们将其解释为每个场单独施加的约束。因此，\n$$ \\frac{\\pi}{\\Delta x_T} \\eta_B \\ge \\alpha_T $$\n重新整理得到对网格间距的要求：\n$$ \\Delta x_T \\le \\frac{\\pi}{\\alpha_T} \\eta_B $$\n问题将此关系定义为 $\\Delta x_T \\lesssim c_2 \\eta_B$。因此常数 $c_2$ 是\n$$ c_2 = \\frac{\\pi}{\\alpha_T} $$\n\n现在，我们使用给定的数据进行数值计算：$\\nu = 1.0 \\times 10^{-6}\\ \\mathrm{m^2/s}$，$\\epsilon = 1.0 \\times 10^{-1}\\ \\mathrm{m^2/s^3}$，$\\Pr = 7$，$\\alpha_u = 1.5$，以及 $\\alpha_T = 1.5$。\n\n首先，我们计算 Kolmogorov 长度尺度 $\\eta$：\n$$ \\eta = \\left( \\frac{(1.0 \\times 10^{-6}\\ \\mathrm{m^2/s})^3}{1.0 \\times 10^{-1}\\ \\mathrm{m^2/s^3}} \\right)^{1/4} = \\left( \\frac{1.0 \\times 10^{-18}}{1.0 \\times 10^{-1}} \\right)^{1/4}\\ \\mathrm{m} = (1.0 \\times 10^{-17})^{1/4}\\ \\mathrm{m} \\approx 5.6234 \\times 10^{-5}\\ \\mathrm{m} $$\n\n接着，我们计算 Batchelor 长度尺度 $\\eta_B$：\n$$ \\eta_B = \\frac{\\eta}{\\sqrt{\\Pr}} = \\frac{5.6234 \\times 10^{-5}\\ \\mathrm{m}}{\\sqrt{7}} \\approx \\frac{5.6234 \\times 10^{-5}}{2.64575}\\ \\mathrm{m} \\approx 2.1254 \\times 10^{-5}\\ \\mathrm{m} $$\n\n解析速度场的最大允许网格间距 $\\Delta x_{\\max}$ 为：\n$$ \\Delta x_{\\max} = c_1 \\eta = \\frac{\\pi}{\\alpha_u} \\eta = \\frac{\\pi}{1.5} (5.6234 \\times 10^{-5}\\ \\mathrm{m}) \\approx 1.1777 \\times 10^{-4}\\ \\mathrm{m} $$\n四舍五入到三位有效数字，$\\Delta x_{\\max} = 1.18 \\times 10^{-4}\\ \\mathrm{m}$。\n\n解析温度场的最大允许网格间距 $\\Delta x_{T,\\max}$ 为：\n$$ \\Delta x_{T,\\max} = c_2 \\eta_B = \\frac{\\pi}{\\alpha_T} \\eta_B = \\frac{\\pi}{1.5} (2.1254 \\times 10^{-5}\\ \\mathrm{m}) \\approx 4.4514 \\times 10^{-5}\\ \\mathrm{m} $$\n四舍五入到三位有效数字，$\\Delta x_{T, \\max} = 4.45 \\times 10^{-5}\\ \\mathrm{m}$。\n\n最后，需要对分辨率参数和标量判据的相对严格性进行论证。\n在DNS文献中，选择 $\\alpha_u = \\alpha_T = 1.5$ 是一个常见但并非普遍严格的标准。条件 $k_{\\max}\\eta=1$ 代表了绝对最低分辨率，此时网格仅能勉强表示尺度为 $\\eta$ 的结构。取值 1.5 提供了一个适度的安全裕度，对应的网格间距为 $\\Delta x \\approx (\\pi/1.5)\\eta \\approx 2.1\\eta$。这确保了最小的涡流至少由几个网格点解析，这对于保证精度至关重要，特别是对于像前面提到的二阶中心差分这样的低阶数值格式。更保守的模拟可能会使用 $\\alpha > 2$。\n\n当 $\\Pr > 1$ 时，标量分辨率判据比速度分辨率判据更严格。速度场所需的网格间距与 $\\eta$ 成正比，而标量场所需的网格间距与 $\\eta_B$ 成正比。这两个上限的比值为\n$$ \\frac{\\Delta x_{T, \\max}}{\\Delta x_{\\max}} = \\frac{(\\pi/\\alpha_T) \\eta_B}{(\\pi/\\alpha_u) \\eta} = \\frac{\\alpha_u}{\\alpha_T} \\frac{\\eta_B}{\\eta} = \\frac{\\alpha_u}{\\alpha_T} \\frac{1}{\\sqrt{\\Pr}} $$\n给定 $\\alpha_u = \\alpha_T = 1.5$ 和 $\\Pr = 7 > 1$，该比值为 $1/\\sqrt{7} \\approx 0.378  1$。因此，$\\Delta x_{T, \\max}  \\Delta x_{\\max}$。使用单一均匀网格的DNS必须满足最严格的要求，因此其网格间距 $\\Delta x$ 必须小于或等于 $\\Delta x_{T, \\max}$。其物理原因是，对于高 $\\Pr$ 数的流体（如水或油），动量的扩散远快于热量的扩散（$\\nu \\gg \\kappa$）。结果是，温度梯度会持续存在于比速度梯度小得多的尺度上，从而产生需要更精细网格才能准确解析的精细尺度热结构。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.18 \\times 10^{-4}  4.45 \\times 10^{-5} \\end{pmatrix} } $$", "id": "2477585"}, {"introduction": "在投入大量计算资源进行DNS并分析其结果之前，我们必须验证我们的数值代码是否已正确实现。制造解方法（Method of Manufactured Solutions, MMS）是一种严谨的、系统性的代码验证技术，用于确认代码是否能达到其设计的收敛精度。本练习 [@problem_id:2477527] 将让您亲身实践MMS的核心分析步骤：为一个给定的平流-扩散方程和一个人为构造的精确解，推导出必须添加到方程中的源项，这是执行MMS测试、确保代码可靠性的关键一步。", "problem": "在一个三周期性盒子中，不可压缩流体的温度场由平流-扩散方程控制。考虑使用直接数值模拟（DNS）来验证一个标量输运求解器的离散精度，该验证使用“制造解方法”（MMS）。从不可压缩流中被动标量的热能局部守恒和 Fourier 热传导定律出发。使用这些基本原理，为一个无量纲温度场 $T(x,y,z,t)$ 推导出控制偏微分方程，其中热扩散系数 $\\alpha$ 为常数，速度场 $\\boldsymbol{u}(x,y,z)$ 无散。区域为 $\\Omega=[0,2\\pi]^{3}$，所有边界面均为周期性边界条件。\n\n设不可压缩速度为\n$$\n\\boldsymbol{u}(x,y,z)=\\bigl(2\\sin x\\,\\cos y\\,\\cos z,\\,-2\\cos x\\,\\sin y\\,\\cos z,\\,0\\bigr),\n$$\n并设制造的温度为\n$$\nT(x,y,z,t)=\\cos(3x)\\,\\cos(2y)\\,\\cos(z)\\,\\exp(\\sigma t),\n$$\n其中 $\\sigma$ 是一个非零常数，$\\alpha>0$ 是常数。使用制造解方法（MMS），推导必须添加到平流-扩散方程右侧的时空源项 $S(x,y,z,t)$，以使 $T(x,y,z,t)$ 在区域 $\\Omega$ 内对所有 $t\\ge 0$ 都是一个精确解。陈述由此构造所蕴含的相应初始条件和边界条件，并从守恒定律和本构关系出发，证明每个建模步骤的合理性。你最终报告的结果必须是 $S(x,y,z,t)$ 的显式闭式解析表达式。不需要进行数值舍入。将你的最终答案表示为单个解析表达式。", "solution": "该问题已经过验证，被认为是科学上可靠、适定、客观且自洽的。所提供的速度场可被验证为无散场，从而证实了不可压缩条件。该问题是制造解方法（MMS）在计算流体力学中的一个标准应用，因此是有效的。\n\n解答过程从第一性原理出发。不可压缩流体中被动标量的热能守恒由平流-扩散方程控制。我们从任意控制体积 $V$（其表面为 $\\partial V$）内的热能积分守恒定律推导该方程：\n$$ \\frac{d}{dt}\\int_{V} \\rho c_p T \\,dV = -\\oint_{\\partial V} \\boldsymbol{q} \\cdot d\\boldsymbol{A} - \\oint_{\\partial V} \\rho c_p T \\boldsymbol{u} \\cdot d\\boldsymbol{A} + \\int_{V} S_{v} \\,dV $$\n此处，$\\rho$ 是流体密度，$c_p$ 是定压比热容，$T$ 是温度，$\\boldsymbol{q}$ 是热通量矢量，$\\boldsymbol{u}$ 是速度场，$S_v$ 是体积热源。使用散度定理，并认识到所得方程必须对任意 $V$ 均成立，我们得到其局部微分形式：\n$$ \\frac{\\partial}{\\partial t}(\\rho c_p T) + \\nabla \\cdot (\\rho c_p T \\boldsymbol{u}) = -\\nabla \\cdot \\boldsymbol{q} + S_v $$\n对于常数 $\\rho$ 和 $c_p$，该方程简化为：\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\nabla \\cdot (T \\boldsymbol{u}) \\right) = -\\nabla \\cdot \\boldsymbol{q} + S_v $$\n使用矢量恒等式 $\\nabla \\cdot (T \\boldsymbol{u}) = T(\\nabla \\cdot \\boldsymbol{u}) + \\boldsymbol{u} \\cdot \\nabla T$ 和不可压缩条件 $\\nabla \\cdot \\boldsymbol{u} = 0$，平流项变为 $\\boldsymbol{u} \\cdot \\nabla T$。\n热传导的本构关系是 Fourier 定律，$\\boldsymbol{q} = -k \\nabla T$，其中 $k$ 是热导率。假设 $k$ 是常数，我们有 $-\\nabla \\cdot \\boldsymbol{q} = \\nabla \\cdot (k \\nabla T) = k \\nabla^2 T$。\n将这些代入守恒方程，得到：\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T \\right) = k \\nabla^2 T + S_v $$\n两边同除以 $\\rho c_p$，并定义热扩散系数 $\\alpha = k/(\\rho c_p)$ 和归一化源项 $S(x,y,z,t) = S_v/(\\rho c_p)$，得到标准的平流-扩散方程：\n$$ \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T = \\alpha \\nabla^2 T + S $$\n对于制造解方法，我们重排此方程来定义必须添加的源项 $S$，以迫使制造的温度场成为一个精确解：\n$$ S(x,y,z,t) = \\frac{\\partial T}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla T - \\alpha \\nabla^2 T $$\n我们已知制造解 $T(x,y,z,t) = \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t)$ 和速度场 $\\boldsymbol{u}(x,y,z)=\\bigl(2\\sin x\\,\\cos y\\,\\cos z,\\,-2\\cos x\\,\\sin y\\,\\cos z,\\,0\\bigr)$。现在我们计算 $S$ 表达式中的每一项。\n\n1. 时间导数，$\\frac{\\partial T}{\\partial t}$：\n$$ \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = \\sigma \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) = \\sigma T $$\n\n2. 拉普拉斯算子，$\\nabla^2 T = \\frac{\\partial^2 T}{\\partial x^2} + \\frac{\\partial^2 T}{\\partial y^2} + \\frac{\\partial^2 T}{\\partial z^2}$：\n$$ \\frac{\\partial^2 T}{\\partial x^2} = \\frac{\\partial^2}{\\partial x^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -3^2 T = -9T $$\n$$ \\frac{\\partial^2 T}{\\partial y^2} = \\frac{\\partial^2}{\\partial y^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -2^2 T = -4T $$\n$$ \\frac{\\partial^2 T}{\\partial z^2} = \\frac{\\partial^2}{\\partial z^2} \\left[ \\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) \\right] = -1^2 T = -T $$\n因此，拉普拉斯算子为：\n$$ \\nabla^2 T = (-9 - 4 - 1)T = -14T = -14\\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) $$\n\n3. 平流项，$\\boldsymbol{u} \\cdot \\nabla T$：\n首先，我们求 $T$ 的梯度，$\\nabla T = \\left(\\frac{\\partial T}{\\partial x}, \\frac{\\partial T}{\\partial y}, \\frac{\\partial T}{\\partial z}\\right)$:\n$$ \\frac{\\partial T}{\\partial x} = -3\\sin(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) $$\n$$ \\frac{\\partial T}{\\partial y} = -2\\cos(3x)\\sin(2y)\\cos(z)\\exp(\\sigma t) $$\n$$ \\frac{\\partial T}{\\partial z} = -\\cos(3x)\\cos(2y)\\sin(z)\\exp(\\sigma t) $$\n现在，我们计算点积 $\\boldsymbol{u} \\cdot \\nabla T = u_x \\frac{\\partial T}{\\partial x} + u_y \\frac{\\partial T}{\\partial y} + u_z \\frac{\\partial T}{\\partial z}$：\n$$ u_x \\frac{\\partial T}{\\partial x} = (2\\sin x\\,\\cos y\\,\\cos z) \\cdot (-3\\sin(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t)) \\\\ = -6 \\exp(\\sigma t) \\sin x \\sin(3x) \\cos y \\cos(2y) \\cos^2(z) $$\n$$ u_y \\frac{\\partial T}{\\partial y} = (-2\\cos x\\,\\sin y\\,\\cos z) \\cdot (-2\\cos(3x)\\sin(2y)\\cos(z)\\exp(\\sigma t)) \\\\ = 4 \\exp(\\sigma t) \\cos x \\cos(3x) \\sin y \\sin(2y) \\cos^2(z) $$\n$$ u_z \\frac{\\partial T}{\\partial z} = 0 $$\n将这些相加得到平流项：\n$$ \\boldsymbol{u} \\cdot \\nabla T = \\exp(\\sigma t) \\cos^2(z) \\left[ -6 \\sin x \\sin(3x) \\cos y \\cos(2y) + 4 \\cos x \\cos(3x) \\sin y \\sin(2y) \\right] $$\n\n4. 组装源项 $S(x,y,z,t)$：\n将计算出的各项代入 $S$ 的表达式：\n$$ S = \\sigma T + \\boldsymbol{u} \\cdot \\nabla T - \\alpha(-14T) = (\\sigma + 14\\alpha)T + \\boldsymbol{u} \\cdot \\nabla T $$\n$$ S(x,y,z,t) = (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z)\\exp(\\sigma t) + \\exp(\\sigma t) \\cos^2(z) \\left[ -6 \\sin x \\sin(3x) \\cos y \\cos(2y) + 4 \\cos x \\cos(3x) \\sin y \\sin(2y) \\right] $$\n提出因子 $\\exp(\\sigma t)$，得到源项的最终表达式：\n$$ S(x,y,z,t) = \\exp(\\sigma t) \\left( (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z) + \\cos^2(z) \\left[ 4 \\cos x \\cos(3x) \\sin y \\sin(2y) - 6 \\sin x \\sin(3x) \\cos y \\cos(2y) \\right] \\right) $$\n\n初始条件，在 $t=0$ 时取值，直接从制造解中导出：\n$$ T(x,y,z,0) = \\cos(3x)\\cos(2y)\\cos(z) $$\n区域 $\\Omega=[0,2\\pi]^{3}$ 的边界条件是周期性的。制造解 $T(x,y,z,t)$ 和速度场 $\\boldsymbol{u}(x,y,z)$ 由三角函数构成，其自变量是空间坐标的整数倍。这些函数在区域 $[0,2\\pi]^{3}$ 上天然具有周期性（例如，$\\cos(3(x+2\\pi)) = \\cos(3x+6\\pi) = \\cos(3x)$）。因此，制造解天然满足周期性边界条件。\n所有建模步骤都得到了证明，从基本守恒定律出发，并导出了所需的源项。$S(x,y,z,t)$ 的最终结果是上面推导出的显式解析表达式。", "answer": "$$ \\boxed{\\exp(\\sigma t) \\left( (\\sigma + 14\\alpha)\\cos(3x)\\cos(2y)\\cos(z) + \\cos^2(z) \\left[ 4 \\cos(x) \\cos(3x) \\sin(y) \\sin(2y) - 6 \\sin(x) \\sin(3x) \\cos(y) \\cos(2y) \\right] \\right)} $$", "id": "2477527"}, {"introduction": "在模拟包含急剧温度梯度的传热问题时，数值格式的选择对结果的物理真实性至关重要。简单的线性高阶格式虽然在光滑区域表现良好，但在间断附近常常会引入虚假的、非物理的振荡（过冲和下冲）。本练习 [@problem_id:2477612] 通过一个经典的尖锐热锋流问题，直接对比了二阶中心格式（Lax-Wendroff）和先进的通量限制总变差递减（TVD）格式。通过亲手实现和比较这两种方法，您将深刻理解为什么在涉及尖锐界面的传热DNS中，复杂的非线性格式对于保证解的准确性和物理真实性是必不可少的。", "problem": "编写一个程序，对一维恒速热平流进行直接数值模拟 (DNS)，以比较在存在尖锐热锋面的情况下，中心格式与通量限制格式的行为。控制守恒律是线性平流方程\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0,\n$$\n在长度为 $L$ 的周期性域 $x \\in [0,L)$ 上，平流一个无量纲温度场 $T(x,t)$。平流速度 $a$ 是一个正常数，初始条件是一个由以下公式给出的黎曼问题（尖锐锋面）\n$$\nT(x,0) = \\begin{cases}\nT_{\\mathrm{L}},  0 \\le x  x_0,\\\\\nT_{\\mathrm{R}},  x_0 \\le x  L,\n\\end{cases}\n$$\n其中 $T_{\\mathrm{L}}=1$，$T_{\\mathrm{R}}=0$，$L=1$，$x_0 = 0.5$，$a=1$。模拟直至最终时间 $t_{\\mathrm{end}}=0.2$。\n\n使用有限体积半离散更新，\n$$\nT_i^{n+1} = T_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^n - F_{i-1/2}^n\\right),\n$$\n针对两种不同的数值通量：\n- 中心格式：使用用于线性平流的 Lax–Wendroff 通量，\n$$\nF_{i+1/2}^n = a\\left[\\frac{T_i^n + T_{i+1}^n}{2} - \\frac{a \\Delta t}{2 \\Delta x}\\left(T_{i+1}^n - T_i^n\\right)\\right].\n$$\n- 通量限制格式：使用带有 van Leer 总变差递减 (TVD) 限制器的守恒律单调上游中心格式 (MUSCL) 重构。对于正数 $a$，通过以下方式计算受限斜率\n$$\nr_i = \\frac{T_i - T_{i-1}}{T_{i+1} - T_i}, \\quad\n\\phi(r) = \\frac{r + |r|}{1 + |r|},\n$$\n约定如果分母为 $0$，则 $r=0$。将面 $i+\\tfrac{1}{2}$ 处的左状态重构为\n$$\nT_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\phi(r_i)\\,(T_{i+1} - T_i),\n$$\n并采用迎风 Godunov 通量\n$$\nF_{i+1/2} = a\\,T_{i+1/2}^{L}.\n$$\n使用二阶强稳定性保持龙格-库塔 (SSP-RK2) 方法推进此通量：\n$$\nT^{(1)} = T^n - \\frac{\\Delta t}{\\Delta x}\\nabla\\cdot F(T^n), \\quad\nT^{n+1} = \\frac{1}{2} T^n + \\frac{1}{2}\\left[T^{(1)} - \\frac{\\Delta t}{\\Delta x}\\nabla\\cdot F(T^{(1)})\\right].\n$$\n\n使用 $N$ 个均匀有限体积对区域进行离散化，其中心位于 $x_i$，宽度为 $\\Delta x = L/N$。施加周期性边界条件。根据 Courant–Friedrichs–Lewy (CFL) 条件选择时间步长，库朗数 $\\mathrm{CFL}=0.8$，即，\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{a},\n$$\n并使用一个恒定的 $\\Delta t$，该值通过将达到 $t_{\\mathrm{end}}$ 所需的步数向上取整，然后重置 $\\Delta t = t_{\\mathrm{end}}/N_t$ 以精确达到 $t_{\\mathrm{end}}$ 来设定。\n\n将时间 $t_{\\mathrm{end}}$ 时过冲的 $L_\\infty$ 范数定义为对物理边界 $[T_{\\min},T_{\\max}] = [0,1]$ 的最大违背：\n$$\n\\| \\text{overshoot} \\|_\\infty = \\max\\left(0, \\max_i(T_i - T_{\\max}), \\max_i(T_{\\min} - T_i)\\right).\n$$\n该量是无量纲的。\n\n测试套件：\n- 使用 $N \\in \\{32, 64, 128, 256\\}$，以及 $L=1$，$a=1$，$x_0=0.5$，$T_{\\mathrm{L}}=1$，$T_{\\mathrm{R}}=0$，$\\mathrm{CFL}=0.8$，和 $t_{\\mathrm{end}}=0.2$。\n- 对于每个 $N$，计算两个浮点数：在 $t_{\\mathrm{end}}$ 时，中心 Lax–Wendroff 格式的 $L_\\infty$ 过冲和通量限制 MUSCL–van Leer 格式的 $L_\\infty$ 过冲。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按以下顺序排列\n$$\n[\\text{LW}(32), \\text{MUSCL}(32), \\text{LW}(64), \\text{MUSCL}(64), \\text{LW}(128), \\text{MUSCL}(128), \\text{LW}(256), \\text{MUSCL}(256)],\n$$\n其中每个条目都是一个四舍五入到六位小数的浮点数。不应打印任何其他文本。", "solution": "所提出的问题是计算传热传质领域中一个有效且适定的数值练习。它要求实现并比较两种不同的数值格式，用于求解一维线性平流方程，这是输运现象的基石。任务是模拟一个尖锐热锋面（或黎曼问题）的平流，并量化每种格式产生的非物理振荡（过冲）。该问题具有科学依据，内部一致，并为完整和明确的实现提供了所有参数。\n\n该系统的控制偏微分方程 (PDE) 是关于无量纲温度场 $T(x,t)$ 的线性平流方程：\n$$\n\\frac{\\partial T}{\\partial t} + a \\frac{\\partial T}{\\partial x} = 0\n$$\n其中 $a$ 是恒定的正平流速度。空间域为 $x \\in [0,L)$，具有周期性边界条件。初始条件是一个阶跃函数，由于其无限梯度，这对数值格式提出了重大挑战。\n\n我们将使用有限体积法，该方法将域离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的单元。每个单元 $i$ 中的温度，记为 $T_i$，代表单元平均值。控制方程的半离散形式是每个单元平均值的常微分方程 (ODE)：\n$$\n\\frac{dT_i}{dt} = -\\frac{1}{\\Delta x}\\left(F_{i+1/2} - F_{i-1/2}\\right)\n$$\n此处，$F_{i+1/2}$ 是 $T$ 穿过单元 $i$ 和单元 $i+1$ 之间界面的数值通量。问题的核心在于为两种不同的格式定义此通量。\n\n**1. 中心格式：Lax–Wendroff**\n\nLax–Wendroff 格式是一种经典方法，在空间和时间上都具有二阶精度。它通过包含时间上的泰勒级数展开项来实现这一点。对于线性平流，这导致使用一个特殊构造的通量进行单步时间更新。问题直接提供了这个通量：\n$$\nF_{i+1/2}^n = a\\left[\\frac{T_i^n + T_{i+1}^n}{2} - \\frac{a \\Delta t}{2 \\Delta x}\\left(T_{i+1}^n - T_i^n\\right)\\right]\n$$\n第一项 $a(T_i^n + T_{i+1}^n)/2$ 是一个简单的中心差分通量，它在空间上是二阶的，但已知是不稳定的。第二项，与库朗数 $\\nu = a \\Delta t / \\Delta x$ 成正比，是一个数值扩散项，它能稳定格式并将时间精度提升到二阶。虽然对于光滑解是准确的，但 Lax–Wendroff 格式在尖锐梯度或不连续点附近会产生虚假的、非物理的振荡（吉布斯现象），我们预计会观察到显著的过冲。\n\n**2. 通量限制格式：带 van Leer 限制器的 MUSCL**\n\n为了克服像 Lax–Wendroff 这样的高阶线性格式的振荡行为，发展了非线性总变差递减 (TVD) 格式。守恒律的单调上游中心格式 (MUSCL) 是一个杰出的例子。关键思想是在每个单元内使用解的高阶重构，然后在不连续点附近“限制”该重构的梯度以防止振荡。这个过程涉及三个主要步骤：\n\n*   **重构**：在每个单元 $i$ 内，使用从相邻单元平均值导出的斜率，重构数据的分段线性表示。这种重构的质量决定了精度。\n*   **限制**：重构的斜率乘以一个限制器函数 $\\phi(r)$，该函数取决于连续梯度的比率 $r_i$：$r_i = (T_i - T_{i-1}) / (T_{i+1} - T_i)$。在变化剧烈的区域，限制器会减小斜率（从而将格式的阶数局部降低到一阶），以防止新极值的形成。问题指定了 van Leer 限制器：\n    $$\n    \\phi(r) = \\frac{r + |r|}{1 + |r|}\n    $$\n    这个限制器是光滑的，在流动的光滑区域提供二阶精度，同时保证单调性。界面 $i+1/2$ 左侧的重构温度值则为：\n    $$\n    T_{i+1/2}^{L} = T_i + \\frac{1}{2}\\,\\phi(r_i)\\,(T_{i+1} - T_i)\n    $$\n*   **通量更新**：界面处的通量使用重构值计算。对于正平流速度 $a > 0$，信息从左向右流动，因此迎风或 Godunov 通量就是：\n    $$\n    F_{i+1/2} = a\\,T_{i+1/2}^{L}\n    $$\n*   **时间积分**：为了保持 TVD 特性并在时间上达到二阶精度，需要一种合适的多级时间步进方法。问题指定了二阶强稳定性保持龙格-库塔 (SSP-RK2) 方法：\n    $$\n    \\begin{align*}\n    T^{(1)} = T^n - \\frac{\\Delta t}{\\Delta x}\\left( F(T^n)_{i+1/2} - F(T^n)_{i-1/2} \\right) \\\\\n    T^{n+1} = \\frac{1}{2} T^n + \\frac{1}{2}\\left[T^{(1)} - \\frac{\\Delta t}{\\Delta x}\\left( F(T^{(1)})_{i+1/2} - F(T^{(1)})_{i-1/2} \\right) \\right]\n    \\end{align*}\n    $$\nMUSCL 重构、van Leer 限制和 SSP-RK2 积分的这种组合旨在对平流锋面产生清晰、无振荡的解析。\n\n**实现与分析**\n\n模拟将在具有周期性边界条件的均匀网格上进行，这在计算上通过环绕数组索引来处理（例如，使用 `numpy.roll`）。初始条件是一个阶跃函数，通过计算每个有限体积上的单元平均值来进行离散化，这比简单的逐点采样提供了更准确的表示。时间步长 $\\Delta t$ 是根据库朗数为 $0.8$ 的 Courant–Friedrichs–Lewy (CFL) 条件确定的，并进行调整以确保模拟在 $t_{\\mathrm{end}}$ 精确结束。\n\n用于比较的主要度量是过冲的 $L_\\infty$ 范数，它测量数值解超出物理预期范围 $[T_{\\min}, T_{\\max}] = [0, 1]$ 的最大偏差。我们预计 Lax–Wendroff 格式将表现出显著的过冲，该过冲会随着网格加密而减小，而 MUSCL/van Leer 格式将几乎不显示或完全不显示过冲，从而证明其 TVD 特性。", "answer": "[0.100908,0.000000,0.098851,0.000000,0.098198,0.000000,0.097988,0.000000]", "id": "2477612"}]}