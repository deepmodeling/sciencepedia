{"hands_on_practices": [{"introduction": "掌握数值方法的稳定性是求解偏微分方程的基石。本练习将引导你分析应用于一维热传导方程的前向时间中心空间（FTCS）格式，这是最经典的显式差分方法之一。你将从第一性原理出发，运用冯·诺依曼稳定性分析推导出该格式的稳定性条件，并计算出在给定参数下的最大允许时间步长。[@problem_id:2524603] 这个实践不仅巩固了你对稳定性概念的理论理解，也为你设计可靠的数值模拟方案提供了基本技能。", "problem": "一个具有恒定热扩散系数 $\\alpha$ 的一维均质固体正在经历瞬态热传导。根据能量守恒和 Fourier 热传导定律，温度场 $T(x,t)$ 满足扩散方程 $\\frac{\\partial T}{\\partial t}=\\alpha \\frac{\\partial^2 T}{\\partial x^2}$。考虑一个间距为 $\\Delta x$ 的均匀空间网格，并使用前向时间中心空间（FTCS）有限差分格式来近似该方程。应用线性 Fourier (von Neumann) 稳定性分析于完全离散的更新过程，从第一性原理推导所有空间 Fourier 模态不被放大时，$\\Delta t$、$\\Delta x$ 和 $\\alpha$ 之间必须满足的稳定性要求。然后，对于 $\\alpha=1.4\\times 10^{-7}\\,\\text{m}^2/\\text{s}$ 和 $\\Delta x=0.5\\,\\text{mm}$，计算最大稳定时间步长。用秒表示你的最终数值答案，并四舍五入到三位有效数字。", "solution": "该问题是有效的。这是一个关于偏微分方程数值分析的标准适定问题，特别是在热传导的背景下。所有必要的信息都已提供，且问题在科学上是合理的。\n\n一维瞬态热传导的控制偏微分方程是扩散方程：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是恒定的热扩散系数。\n\n我们被要求分析前向时间中心空间（FTCS）有限差分格式。我们将连续域离散化为网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。令 $T_j^n$ 表示在空间节点 $j$ 和时间层 $n$ 的温度数值近似值，即 $T_j^n \\approx T(j\\Delta x, n\\Delta t)$。\n\n时间导数 $\\frac{\\partial T}{\\partial t}$ 使用一阶前向差分来近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j,n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\n空间二阶导数 $\\frac{\\partial^2 T}{\\partial x^2}$ 使用二阶中心差分来近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n将这些近似值代入控制方程，得到 FTCS 格式：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\alpha \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\n重新整理以求解下一时间步的温度 $T_j^{n+1}$，我们得到显式更新法则：\n$$\nT_j^{n+1} = T_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n让我们定义无量纲网格 Fourier 数 $r$ 为：\n$$\nr = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n更新方程简化为：\n$$\nT_j^{n+1} = T_j^n + r(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\n为了分析这个线性格式的稳定性，我们使用 von Neumann (或 Fourier) 稳定性分析。我们考虑数值解的单个 Fourier 模态的演化。在任何时间层 $n$ 的解都表示为一个 Fourier 级数。我们考察在空间节点 $j$ 处该级数的一个通用项：\n$$\nT_j^n = A^{(n)}(k) e^{i k x_j} = A^{(n)}(k) e^{i k j \\Delta x}\n$$\n其中 $i = \\sqrt{-1}$，$k$ 是 Fourier 模态的波数，$A^{(n)}(k)$ 是该模态在时间层 $n$ 的振幅。为使格式稳定，任何 Fourier 模态的振幅都不能随时间增长。这意味着放大因子 $G(k) = \\frac{A^{(n+1)}(k)}{A^{(n)}(k)}$ 必须对所有可能的波数 $k$ 满足条件 $|G(k)| \\le 1$。\n\n将 Fourier 模态表达式代入 FTCS 更新方程：\n$$\nA^{(n+1)} e^{i k j \\Delta x} = A^{(n)} e^{i k j \\Delta x} + r \\left( A^{(n)} e^{i k (j+1) \\Delta x} - 2A^{(n)} e^{i k j \\Delta x} + A^{(n)} e^{i k (j-1) \\Delta x} \\right)\n$$\n将整个方程除以 $A^{(n)} e^{i k j \\Delta x}$（非零），得到放大因子 $G = \\frac{A^{(n+1)}}{A^{(n)}}$ 的表达式：\n$$\nG = 1 + r \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right)\n$$\n使用 Euler 恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们可以简化括号中的表达式：\n$$\ne^{i k \\Delta x} + e^{-i k \\Delta x} - 2 = 2\\cos(k \\Delta x) - 2\n$$\n因此，放大因子变为：\n$$\nG = 1 + 2r(\\cos(k \\Delta x) - 1)\n$$\n我们可以使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$：\n$$\nG = 1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nvon Neumann 稳定性判据是 $|G| \\leq 1$，这等价于 $-1 \\leq G \\leq 1$。\n\n由于 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 是正数，且 $\\sin^2(\\frac{k \\Delta x}{2})$ 总是非负的，所以项 $4r\\sin^2(\\frac{k \\Delta x}{2})$ 总是非负的。因此，$G = 1 - (\\text{一个非负量})$，这意味着 $G \\le 1$。条件的这一部分总是满足的。\n\n稳定性条件的关键部分是 $G \\ge -1$：\n$$\n1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 成立。最严格的条件（“最坏情况”）发生在 $\\sin^2(\\frac{k \\Delta x}{2})$ 达到其最大值时。正弦平方函数的最大值是 $1$。这发生在网格能解析的最高频率模态，此时 $k \\Delta x = \\pi$。\n因此，稳定性判据简化为：\n$$\nr \\le \\frac{1}{2}\n$$\n代回 $r$ 的定义：\n$$\n\\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\n这就是应用于一维热方程的 FTCS 格式的稳定性要求。\n\n现在，我们计算最大稳定时间步长 $\\Delta t_{max}$。从推导出的判据，我们有：\n$$\n\\Delta t \\le \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n最大稳定时间步长是等式成立的极限情况：\n$$\n\\Delta t_{max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n问题提供了以下数值：\n$\\alpha = 1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s}$\n$\\Delta x = 0.5\\,\\text{mm}$\n\n首先，我们必须确保单位一致。我们将 $\\Delta x$ 从毫米转换为米：\n$\\Delta x = 0.5\\,\\text{mm} = 0.5 \\times 10^{-3}\\,\\text{m} = 5 \\times 10^{-4}\\,\\text{m}$。\n\n现在，我们将数值代入 $\\Delta t_{max}$ 的表达式中：\n$$\n\\Delta t_{max} = \\frac{(5 \\times 10^{-4}\\,\\text{m})^2}{2 \\times (1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s})} = \\frac{25 \\times 10^{-8}\\,\\text{m}^2}{2.8 \\times 10^{-7}\\,\\text{m}^2/\\text{s}}\n$$\n$$\n\\Delta t_{max} = \\frac{25}{2.8} \\times 10^{-1}\\,\\text{s} = \\frac{2.5}{2.8}\\,\\text{s} \\approx 0.892857... \\,\\text{s}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\n\\Delta t_{max} \\approx 0.893\\,\\text{s}\n$$\n对于给定的参数，这是 FTCS 格式保持数值稳定性的最大时间步长。", "answer": "$$\\boxed{0.893}$$", "id": "2524603"}, {"introduction": "在掌握了一维问题的稳定性分析后，下一个挑战是如何将这些概念推广到更符合真实物理世界的多维空间。本练习将探讨应用于 $d$ 维热扩散方程的显式差分格式，并引入一种不同于冯·诺依曼分析的强大工具——离散最大值原理。通过要求数值更新是其邻近格点值的凸组合，你将推导出保证解的单调性和稳定性的时间步长限制。[@problem_id:2524677] 这个过程让你能深刻理解空间维数如何加剧对稳定性的约束，这是进行多维数值模拟时的一个核心考量。", "problem": "考虑均匀介质中的瞬态热扩散，其由热方程控制\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha \\nabla^{2} u,\n$$\n其中 $u=u(\\mathbf{x},t)$ 是温度，$\\alpha>0$ 是热扩散系数。设空间域在 $d$ 维空间中被离散化为正交笛卡尔网格，沿坐标轴方向的均匀间距分别为 $\\Delta x_{1},\\dots,\\Delta x_{d}$。考虑使用时间步长为 $\\Delta t>0$ 的显式前向欧拉法进行时间离散，并对内部节点上每个坐标方向的拉普拉斯算子使用标准的二阶中心差分近似。假设没有内部源，边界数据随时间非负，并且所有网格点上的初始数据均为非负。\n\n从控制方程和所述的离散选择出发，写出内部节点的完全离散更新式，其形式应分离出当前节点值及其最近邻居值所乘的权重。施加以下要求：(i) 这些权重均为非负；(ii) 它们的总和为 $1$，从而使更新式成为当前值和邻居值的凸组合。推导 $\\Delta t$ 相应的精确上界，该上界保证这两个属性在每个内部节点都成立，并以 $\\alpha$ 和间距 $\\Delta x_{1},\\dots,\\Delta x_{d}$ 表示的最大允许时间步长 $\\Delta t_{\\max}$ 的单个闭式解析表达式给出。\n\n以函数 $\\Delta t_{\\max}=\\,$(表达式) 的形式报告您的答案。最终表达式中不要包含单位。", "solution": "所述问题具有科学依据、提法恰当、客观且自成体系。它代表了偏微分方程数值分析中的一个标准基本任务。其前提事实正确，术语精确，目标明确。该问题是有效的。我们现在开始解答。\n\n控制方程是在 $d$ 维空间中的瞬态热扩散方程，由下式给出\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\nabla^2 u\n$$\n其中 $u(\\mathbf{x}, t)$ 是温度，$\\mathbf{x} \\in \\mathbb{R}^d$，$t \\ge 0$，且 $\\alpha > 0$ 是常数热扩散系数。笛卡尔坐标系中的拉普拉斯算子是 $\\nabla^2 = \\sum_{k=1}^d \\frac{\\partial^2}{\\partial x_k^2}$。\n\n我们在正交笛卡尔网格上离散化此方程。设 $\\Delta t > 0$ 为均匀时间步长，$\\Delta x_k$ 为第 $k$ 个坐标方向上的均匀网格间距，其中 $k=1, \\dots, d$。令 $u_{\\mathbf{i}}^n$ 表示温度 $u(\\mathbf{x}_{\\mathbf{i}}, t_n)$ 的数值近似，其中 $\\mathbf{i} = (i_1, \\dots, i_d)$ 是网格节点的多重索引，且 $t_n = n \\Delta t$。\n\n时间导数 $\\frac{\\partial u}{\\partial t}$ 在 $(\\mathbf{x}_{\\mathbf{i}}, t_n)$ 处使用显式前向欧拉格式近似为：\n$$\n\\left. \\frac{\\partial u}{\\partial t} \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\frac{u_{\\mathbf{i}}^{n+1} - u_{\\mathbf{i}}^n}{\\Delta t}\n$$\n拉普拉斯算子 $\\nabla^2 u$ 使用标准的二阶中心差分格式近似。关于 $x_k$ 的二阶偏导数近似为：\n$$\n\\left. \\frac{\\partial^2 u}{\\partial x_k^2} \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n其中 $\\mathbf{e}_k$ 是索引空间中对应于第 $k$ 个方向的单位向量。因此，完整的拉普拉斯算子近似为：\n$$\n\\left. \\nabla^2 u \\right|_{\\mathbf{x}_{\\mathbf{i}}, t_n} \\approx \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n将这些离散近似代入控制方程，得到完全离散格式：\n$$\n\\frac{u_{\\mathbf{i}}^{n+1} - u_{\\mathbf{i}}^n}{\\Delta t} = \\alpha \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n为了找到 $u_{\\mathbf{i}}^{n+1}$ 的更新规则，我们解出该项：\n$$\nu_{\\mathbf{i}}^{n+1} = u_{\\mathbf{i}}^n + \\alpha \\Delta t \\sum_{k=1}^d \\frac{u_{\\mathbf{i}+\\mathbf{e}_k}^n - 2u_{\\mathbf{i}}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n}{(\\Delta x_k)^2}\n$$\n问题要求将此表达式写成一种形式，以分离当前节点值 $u_{\\mathbf{i}}^n$ 及其最近邻居的权重。我们通过重新排列各项来实现这一点：\n$$\nu_{\\mathbf{i}}^{n+1} = u_{\\mathbf{i}}^n - \\left( 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) u_{\\mathbf{i}}^n + \\sum_{k=1}^d \\left( \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} u_{\\mathbf{i}+\\mathbf{e}_k}^n + \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} u_{\\mathbf{i}-\\mathbf{e}_k}^n \\right)\n$$\n合并乘以 $u_{\\mathbf{i}}^n$ 的项，得到所需的形式：\n$$\nu_{\\mathbf{i}}^{n+1} = \\left( 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) u_{\\mathbf{i}}^n + \\sum_{k=1}^d \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} \\left( u_{\\mathbf{i}+\\mathbf{e}_k}^n + u_{\\mathbf{i}-\\mathbf{e}_k}^n \\right)\n$$\n此更新是在当前时间步 $n$ 时，节点 $\\mathbf{i}$ 处的值及其 $2d$ 个最近邻居值的线性组合。权重为：\n-   中心节点 $u_{\\mathbf{i}}^n$ 的权重：$C_0 = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}$\n-   每个邻居节点 $u_{\\mathbf{i}\\pm\\mathbf{e}_k}^n$ 的权重：$C_k = \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2}$，其中 $k=1, \\dots, d$。\n\n问题要求此更新必须是凸组合。这需要两个条件：\n(i) 所有权重必须为非负。\n(ii) 所有权重的总和必须等于 $1$。\n\n我们首先验证条件 (ii)。所有权重的总和是：\n$$\n\\sum (\\text{weights}) = C_0 + \\sum_{k=1}^d (\\text{weight of } u_{\\mathbf{i}+\\mathbf{e}_k}^n + \\text{weight of } u_{\\mathbf{i}-\\mathbf{e}_k}^n)\n$$\n$$\n\\sum (\\text{weights}) = \\left( 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\right) + \\sum_{k=1}^d \\left( \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} + \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2} \\right)\n$$\n$$\n\\sum (\\text{weights}) = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} + 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} = 1\n$$\n因此，条件 (ii) 是离散公式的内在属性，无论参数如何选择，它总是被满足。\n\n现在我们必须强制执行条件 (i)，即权重的非负性。\n邻居节点的权重 $C_k = \\frac{\\alpha \\Delta t}{(\\Delta x_k)^2}$ 总是非负的，因为 $\\alpha > 0$，$\\Delta t > 0$ 且 $(\\Delta x_k)^2 > 0$。\n关键的约束来自于中心节点权重 $C_0$：\n$$\nC_0 = 1 - 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2} \\ge 0\n$$\n为了使更新成为凸组合，此不等式必须成立。我们解出 $\\Delta t$：\n$$\n1 \\ge 2 \\alpha \\Delta t \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}\n$$\n由于 $\\alpha > 0$ 且求和项严格为正，我们可以直接相除而不改变不等式方向：\n$$\n\\Delta t \\le \\frac{1}{2 \\alpha \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}}\n$$\n这个不等式给出了时间步长 $\\Delta t$ 的上界。最大允许时间步长 $\\Delta t_{\\max}$ 是使该不等式成为等式的值。这是在给定约束下最精确的上界。\n\n因此，最大允许时间步长的表达式为：\n$$\n\\Delta t_{\\max} = \\frac{1}{2 \\alpha \\sum_{k=1}^d \\frac{1}{(\\Delta x_k)^2}}\n$$\n这是保证系数非负性的稳定性条件，它反过来又确保了数值解遵循离散极值原理，这是该抛物线型问题稳定性的一个充分条件。", "answer": "$$\n\\boxed{\\frac{1}{2\\alpha \\sum_{k=1}^{d} \\frac{1}{(\\Delta x_k)^{2}}}}\n$$", "id": "2524677"}, {"introduction": "理论上的稳定性分析往往基于理想化假设，然而在实际计算中，情况可能更为复杂。本练习深入探讨了 FTCS 格式在其稳定性边界，即傅里叶数 $\\mathrm{Fo}=1/2$ 时的微妙行为。你将分析为何一个在理论上被判定为（临界）稳定的格式，在面对有限精度计算中的舍入误差以及更真实的非周期边界条件时，可能会表现出误差增长的现象。[@problem_id:2524674] 这项实践揭示了非正规矩阵和瞬态增长等高级概念的重要性，帮助你从“理论稳定”迈向“实践可靠”，这对于成为一名严谨的计算科学家至关重要。", "problem": "考虑一维热方程，其中热扩散系数 $\\alpha>0$ 为常数，\n$$\n\\frac{\\partial u}{\\partial t}=\\alpha\\,\\frac{\\partial^2 u}{\\partial x^2},\n$$\n在均匀网格 $x_j=j\\,\\Delta x$（$j=0,1,\\dots,N-1$）和时间层 $t^n=n\\,\\Delta t$（$n\\in\\mathbb{N}$）上求解。前向时间中心空间（FTCS）格式通过以下方式更新节点值 $u_j^n\\approx u(x_j,t^n)$：\n$$\nu_j^{n+1}=u_j^n+\\mathrm{Fo}\\left(u_{j+1}^n-2\\,u_j^n+u_{j-1}^n\\right),\n$$\n其中傅里叶数 $\\mathrm{Fo}=\\alpha\\,\\Delta t/\\Delta x^2$。假设采用周期性边界条件，使得对所有的 $j$ 和 $n$ 都有 $u_{j+N}^n=u_j^n$。通过考虑形式为 $e_j^n=\\xi^n\\,\\mathrm{e}^{\\mathrm{i}\\,j\\,\\theta}$（其中 $\\theta\\in[-\\pi,\\pi]$）的误差模态，进行平面波误差分析，并以此来表征在 $\\mathrm{Fo}=1/2$ 时的稳定性。\n\n然后，讨论以下两个实际问题：\n（1）在有限精度算术下，假设每个时间步在更新过程中向每个网格点注入一个方差为 $\\sigma^2$ 的附加、零均值、不相关的舍入扰动（用于模拟浮点噪声）。\n（2）在非周期性问题中，假设周期性闭合被用于诺伊曼（Neumann）或罗宾（Robin）条件的常用单边、二阶精确边界闭合所取代，这些闭合避免了使用虚拟点，从而导致了非对称的放大矩阵。\n\n基于控制方程和线性FTCS更新的严谨推理，选择所有能正确解释为什么FTCS格式在 $\\mathrm{Fo}=1/2$ 时，在周期性边界下是临界稳定，但在实际情况下，在舍入和边界扰动下仍可能表现出增长的陈述。\n\nA. 对于周期性边界，离散空间算子是循环的，并且可以通过离散傅里叶变换对角化；在 $\\mathrm{Fo}=1/2$ 时，模态放大因子为 $G(\\theta)=\\cos\\theta$，因此 $|G(\\theta)|\\le 1$，但均值模态和奈奎斯特模态不被衰减。由于高频误差没有耗散，即使每个傅里叶模态都是非放大或衰减的，累积的舍入误差在 $n$ 步后也会产生均方根误差 $\\mathcal{O}(\\sqrt{n})$ 的增长。因此，该格式是临界稳定的，但在有限精度下仍可能显示出明显的增长。\n\nB. 在 $\\mathrm{Fo}=1/2$ 时，该格式违反了离散极值原理，因此在边界处引入的任何有界扰动都必须指数级增长。这解释了观察到的增长。\n\nC. 避免使用虚拟点的常用单边或基于通量的诺伊曼（Neumann）/罗宾（Robin）边界闭合会产生一个非正规（非正交对角化）的放大矩阵；即使所有特征值都满足 $|\\lambda|\\le 1$，其伪谱也可能延伸到单位圆盘之外，从而允许舍入和边界扰动的瞬时放大。这可能会植入持久的奈奎斯特成分，而这些成分在 $\\mathrm{Fo}=1/2$ 时是不被衰减的。\n\nD. 观察到的增长发生是因为FTCS格式在 $\\mathrm{Fo}=1/2$ 时失去了一致性；局部截断误差发散，因此即使在周期性域上，数值解也无法收敛。\n\nE. 在 $\\mathrm{Fo}=1/2$ 时，更新是邻近点的凸平均，这使得该格式对所有扰动都是无条件稳定的；因此，任何增长都必须完全归因于编程错误，而非数值分析的考虑。\n\n选择所有正确选项。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **控制方程**：一维热方程 $\\frac{\\partial u}{\\partial t}=\\alpha\\,\\frac{\\partial^2 u}{\\partial x^2}$，其中热扩散系数 $\\alpha>0$ 为常数。\n- **网格**：均匀网格 $x_j=j\\,\\Delta x$（$j=0,1,\\dots,N-1$）和时间层 $t^n=n\\,\\Delta t$（$n\\in\\mathbb{N}$）。\n- **数值格式**：前向时间中心空间（FTCS）格式，由 $u_j^{n+1}=u_j^n+\\mathrm{Fo}\\left(u_{j+1}^n-2\\,u_j^n+u_{j-1}^n\\right)$ 给出。\n- **傅里叶数**：$\\mathrm{Fo}=\\alpha\\,\\Delta t/\\Delta x^2$。\n- **边界条件**：周期性，$u_{j+N}^n=u_j^n$。\n- **分析方法**：平面波误差分析（冯·诺依曼分析），使用模态 $e_j^n=\\xi^n\\,\\mathrm{e}^{\\mathrm{i}\\,j\\,\\theta}$，其中 $\\theta\\in[-\\pi,\\pi]$。\n- **关心的条件**：在 $\\mathrm{Fo}=1/2$ 时的稳定性。\n- **实际考虑因素**：\n    1. 每个时间步在每个网格点上附加的、零均值、不相关的方差为 $\\sigma^2$ 的舍入扰动的影响。\n    2. 用适用于诺伊曼（Neumann）或罗宾（Robin）条件的单边、二阶精确边界闭合取代周期性边界条件的影响，这会导致一个非对称的放大矩阵。\n- **问题**：选择所有能正确解释为什么FTCS格式在 $\\mathrm{Fo}=1/2$ 时，在周期性边界下是临界稳定，但在指定的实际条件下仍可能表现出增长的陈述。\n\n### 第2步：使用提取的已知条件进行验证\n该问题陈述具有科学依据，表述清晰且客观。它涉及偏微分方程数值分析中的一个标准但细致入微的主题：FTCS格式的稳定性。所涉及的概念——冯·诺依曼稳定性分析、傅里叶数、临界稳定性、舍入误差累积以及由边界条件引起的非正规矩阵的作用——都是计算科学领域中公认的。问题是自洽的，没有矛盾或歧义。它提出了一个合理的问题，即在理想化设置（周期性边界、精确算术）中的理论稳定性与在更现实场景中的实际性能之间的区别。\n\n### 第3步：结论与行动\n问题有效。我将继续进行推导和评估。\n\n### 推导与分析\n热方程的FTCS格式由下式给出：\n$$\nu_j^{n+1}=u_j^n+\\mathrm{Fo}\\left(u_{j+1}^n-2\\,u_j^n+u_{j-1}^n\\right)\n$$\n我们通过将形式为 $e_j^n = G(\\theta)^n e^{\\mathrm{i} j \\theta}$ 的误差模态代入格式中，来进行冯·诺依曼稳定性分析。放大因子 $G(\\theta)$ 决定了该模态的增长或衰减。\n$$\nG(\\theta)^{n+1} e^{\\mathrm{i} j \\theta} = G(\\theta)^n e^{\\mathrm{i} j \\theta} + \\mathrm{Fo} \\left( G(\\theta)^n e^{\\mathrm{i} (j+1) \\theta} - 2 G(\\theta)^n e^{\\mathrm{i} j \\theta} + G(\\theta)^n e^{\\mathrm{i} (j-1) \\theta} \\right)\n$$\n两边同除以 $G(\\theta)^n e^{\\mathrm{i} j \\theta}$ 得到：\n$$\nG(\\theta) = 1 + \\mathrm{Fo} \\left( e^{\\mathrm{i} \\theta} - 2 + e^{-\\mathrm{i} \\theta} \\right)\n$$\n使用恒等式 $e^{\\mathrm{i} \\theta} + e^{-\\mathrm{i} \\theta} = 2\\cos\\theta$，我们得到：\n$$\nG(\\theta) = 1 + 2\\mathrm{Fo}(\\cos\\theta - 1)\n$$\n使用半角恒等式 $1-\\cos\\theta = 2\\sin^2(\\theta/2)$：\n$$\nG(\\theta) = 1 - 4\\mathrm{Fo}\\sin^2(\\theta/2)\n$$\n为保证稳定性，我们需要对所有波数 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。由于 $G(\\theta)$ 是实数，该条件变为 $-1 \\le G(\\theta) \\le 1$。\n条件 $G(\\theta) \\le 1$ 可简化为 $-4\\mathrm{Fo}\\sin^2(\\theta/2) \\le 0$，对于 $\\mathrm{Fo} > 0$ 恒成立。\n条件 $-1 \\le G(\\theta)$ 可简化为 $-1 \\le 1 - 4\\mathrm{Fo}\\sin^2(\\theta/2)$，这意味着 $4\\mathrm{Fo}\\sin^2(\\theta/2) \\le 2$，或 $\\mathrm{Fo}\\sin^2(\\theta/2) \\le 1/2$。\n由于 $\\sin^2(\\theta/2)$ 的最大值为 1（在 $\\theta = \\pm\\pi$ 时），稳定性条件是 $\\mathrm{Fo} \\le 1/2$。这是一个条件稳定性限制。\n\n在特定值 $\\mathrm{Fo}=1/2$ 时，放大因子变为：\n$$\nG(\\theta) = 1 - 4(1/2)\\sin^2(\\theta/2) = 1 - 2\\sin^2(\\theta/2) = \\cos\\theta\n$$\n在这种情况下，对所有 $\\theta$ 都有 $|G(\\theta)|=|\\cos\\theta| \\le 1$，因此根据冯·诺依曼判据，该格式是稳定的。然而，对于 $\\theta=0$（均值或常数模态），$G(0)=1$，对于 $\\theta=\\pi$（奈奎斯特频率模态），$G(\\pi)=-1$。由于这些模态的 $|G(\\theta)|=1$，它们不会被衰减。这就是临界稳定性的定义。\n\n现在我们来评估所提供的选项。\n\n**选项A评估**\n该陈述声称，对于周期性边界，离散算子是循环的，并且可以通过离散傅里叶变换（DFT）对角化。这是正确的；周期性边界条件使得更新矩阵成为一个循环矩阵，其特征向量是DFT的复指数。该陈述正确地指出，在 $\\mathrm{Fo}=1/2$ 时，$G(\\theta) = \\cos\\theta$，导致均值（$\\theta=0$）和奈奎斯特（$\\theta=\\pi$）模态不被衰减。\n论证的关键部分涉及舍入误差。如果在每一步 $k$，都添加一个分量方差为 $\\sigma^2$ 的零均值、不相关的噪声向量 $\\delta^k$，那么在 $n$ 步之后（假设初始误差为零），总误差为 $e^n = \\sum_{k=0}^{n-1} \\mathbf{A}^{n-1-k} \\delta^k$，其中 $\\mathbf{A}$ 是放大矩阵。对于周期性边界，$\\mathbf{A}$ 是正规的，所以 $\\|\\mathbf{A}^m\\|_2 = \\rho(\\mathbf{A})^m$，其中 $\\rho(\\mathbf{A})$ 是谱半径。这里，$\\rho(A) = \\max_\\theta|G(\\theta)| = 1$。误差的期望平方范数为 $E[\\|e^n\\|_2^2] = \\sum_{k=0}^{n-1} E[\\|\\mathbf{A}^{n-1-k} \\delta^k\\|_2^2]$。由于矩阵算子不会在范数上放大模态（$|G(\\theta)|\\le1$），和的方差表现得像随机游走。总误差的方差是每一步所加方差的总和。在 $N$ 个网格点上，每步增加的方差为 $N\\sigma^2$。经过 $n$ 步后，总误差方差与 $n \\times (N\\sigma^2)$ 成正比。均方根（RMS）误差为 $\\sqrt{E[\\|e^n\\|_2^2]/N}$，其尺度为 $\\sqrt{n\\sigma^2} = \\sigma\\sqrt{n}$。这种 $\\mathcal{O}(\\sqrt{n})$ 的增长是累积未衰减噪声的直接后果。该推理完全合理。\n结论：**正确**。\n\n**选项B评估**\n该陈述引用了离散极值原理（DMP）。FTCS更新公式为 $u_j^{n+1} = (1-2\\mathrm{Fo})u_j^n + \\mathrm{Fo}(u_{j+1}^n + u_{j-1}^n)$。DMP的一个充分条件是更新是一个凸组合，这要求所有系数都为非负。这意味着 $1-2\\mathrm{Fo} \\ge 0$，即 $\\mathrm{Fo} \\le 1/2$。在边界情况 $\\mathrm{Fo}=1/2$ 时，更新公式变为 $u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)$。系数为 $1/2$ 和 $1/2$，均为非负。因此，该格式在 $\\mathrm{Fo}=1/2$ 时*满足*非严格的DMP；它没有违反该原理。该陈述的前提在事实上是错误的。\n结论：**不正确**。\n\n**选项C评估**\n该陈述讨论了第二个实际问题：具有现实边界闭合的非周期性问题。它正确地指出，常用于近似诺伊曼（Neumann）或罗宾（Robin）边界条件且不引入虚拟点的单边差分格式，通常会导致一个非正规的放大矩阵 $\\mathbf{A}$（即 $\\mathbf{A}\\mathbf{A}^* \\ne \\mathbf{A}^*\\mathbf{A}$）。对于非正规矩阵，谱半径 $\\rho(\\mathbf{A}) = \\max(|\\lambda_i|)$ 不再是唯一决定系统短期动态的因素。矩阵幂的范数 $\\|\\mathbf{A}^n\\|_2$ 可能会经历显著的瞬时增长，即对于某些 $n>1$，即使 $\\rho(\\mathbf{A}) \\le 1$，也可能有 $\\|\\mathbf{A}^n\\|_2 \\gg \\rho(\\mathbf{A})^n$。这种行为由 $\\mathbf{A}$ 的伪谱来表征。如果伪谱在复平面上延伸到单位圆盘之外，就可能发生瞬时放大。这种放大可能足以激发误差模态。该陈述正确地将边界处的这种瞬时增长与植入高频内容（如奈奎斯特模态）联系起来。由于在 $\\mathrm{Fo}=1/2$ 时，奈奎斯特模态是不衰减的（$|G(\\pi)|=1$），任何在边界处产生的此类内容在传播到域内时都不会衰减，从而导致持续的振荡和明显的失稳。这是一个有详细记录的现象，称为Kreiss-Trefethen非模态不稳定性。该推理是合理的，并代表了对数值稳定性的一个高级、正确的理解。\n结论：**正确**。\n\n**选项D评估**\n该陈述声称该格式在 $\\mathrm{Fo}=1/2$ 时失去了一致性。FTCS格式的局部截断误差（$\\tau$）是通过将精确解代入差分算子得到的：$\\tau = \\frac{u_t - \\alpha u_{xx}}{=0} + \\frac{\\Delta t}{2}u_{tt} - \\alpha\\frac{\\Delta x^2}{12}u_{xxxx} + \\dots$。使用 $u_t = \\alpha u_{xx}$ 来得到 $u_{tt} = \\alpha^2 u_{xxxx}$，主导误差项为 $\\tau = \\alpha u_{xxxx} (\\frac{\\alpha\\Delta t}{2} - \\frac{\\Delta x^2}{12}) + \\dots = \\alpha u_{xxxx} \\Delta x^2 (\\frac{\\mathrm{Fo}}{2} - \\frac{1}{12}) + \\dots$。如果当 $\\Delta t, \\Delta x \\to 0$ 时 $\\tau \\to 0$，则格式是一致的。这总是成立的，因为 $\\tau$ 的阶数为 $O(\\Delta t, \\Delta x^2)$。傅里叶数 $\\mathrm{Fo}$ 的值在极限过程中是一个固定的比率；它不会导致截断误差发散。对于任何有限的 $\\mathrm{Fo}$，包括 $\\mathrm{Fo}=1/2$，该格式都是一致的。因此，该陈述是错误的。\n结论：**不正确**。\n\n**选项E评估**\n该陈述正确地注意到，在 $\\mathrm{Fo}=1/2$ 时，更新是邻近点的凸平均。然而，它错误地得出结论，认为这使得格式“无条件稳定”。FTCS格式是条件稳定的；对于任何 $\\mathrm{Fo} > 1/2$，它都是不稳定的。“无条件稳定”一词适用于对所有 $\\Delta t$ 和 $\\Delta x$ 的选择都稳定的格式，这对于FTCS来说是不成立的。此外，该陈述断言任何观察到的增长都必须归因于编程错误。这忽略了在选项A和C中正确描述的有效而微妙的数值现象（临界稳定系统中的舍入误差累积和非正规系统中的瞬时增长）。这些是数值分析中真实存在的问题，而不仅仅是实现错误。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "2524674"}]}