## 引言
在不可压缩流体的[数值模拟](@entry_id:137087)中，尤其是在传热传质和众多工程领域，压[力场](@entry_id:147325)与[速度场](@entry_id:271461)的耦合处理是核心挑战之一。与存在状态方程直接关联压力的[可压缩流](@entry_id:747589)不同，[不可压缩流](@entry_id:140301)动的控制[方程组](@entry_id:193238)中没有为压力提供一个独立的求解方程，压力更像是一个为满足[质量守恒](@entry_id:204015)约束而存在的“隐性”变量。这种独特的耦合机制给数值求解带来了巨大的困难，也是区分不同[计算流体力学](@entry_id:747620)（CFD）求解器效率与鲁棒性的关键所在。

本文旨在系统性地攻克这一难题，为读者构建一个从理论到实践的完整知识框架。在“原理与机制”一章中，我们将深入剖析[压力-速度耦合](@entry_id:155962)的物理本质，揭示[数值离散化](@entry_id:752782)带来的“棋盘格”压[力场](@entry_id:147325)等伪影，并详细阐述为解决这些问题而生的经典SIMPLE和[PISO算法](@entry_id:155035)的推导过程与工作机理。随后的“应用与跨学科联系”一章将理论联系实际，探讨这些算法在[湍流模型](@entry_id:190404)、[变密度流](@entry_id:756427)和[地球物理模拟](@entry_id:749873)等复杂场景下的扩展与应用，并揭示其与[数值线性代数](@entry_id:144418)等领域的深刻联系。最后，“动手实践”一章提供了一系列精心设计的练习，引导读者亲手推导关键方程，将理论知识转化为扎实的计算技能。

## 原理与机制

在对不可压缩流体流动进行数值模拟时，核心的挑战之一在于如何处理压力与速度场之间的耦合关系。与[可压缩流](@entry_id:747589)不同，[不可压缩流](@entry_id:140301)动的密度为常数，因此不存在直接通过[状态方程](@entry_id:274378)（如理想气体定律）来确定压力的代数关系。相反，压力在不可压缩流动的控制方程中扮演了一个更为微妙的角色。本章将深入探讨[压力-速度耦合](@entry_id:155962)的根本原因、[数值离散化](@entry_id:752782)带来的挑战，并详细阐述为解决这些问题而发展的经典算法，如 SIMPLE 和 PISO。

### 不可压缩流中[压力-速度耦合](@entry_id:155962)的基本挑战

对于一个等温、不可压缩牛顿流体，其运动由[质量守恒](@entry_id:204015)（[连续性方程](@entry_id:195013)）和[动量守恒](@entry_id:149964)（[Navier-Stokes](@entry_id:276387) 方程）共同描述：

$$
\nabla \cdot \mathbf{u} = 0
$$

$$
\rho \left( \frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla)\mathbf{u} \right) = -\nabla p + \mu \nabla^2 \mathbf{u} + \mathbf{f}
$$

其中 $\rho$ 是流体密度，$\mu$ 是[动力粘度](@entry_id:268228)，$\mathbf{u}$ 是[速度矢量](@entry_id:269648)， $p$ 是压力，$\mathbf{f}$ 代表体积力。

仔细审视这组方程，一个关键问题浮出水面：系统中没有一个独立的方程是用来求解压力 $p$ 的。连续性方程 $\nabla \cdot \mathbf{u} = 0$ 是一个关于速度场的[运动学](@entry_id:173318)约束，它本身不包含压力项。动量方程虽然包含了压力，但压力是以梯度 $\nabla p$ 的形式出现的。这意味着，如果一个压[力场](@entry_id:147325) $p(\mathbf{x}, t)$ 是解，那么任何加上一个空间上均匀、时间上任意的常数 $C$ 后得到的场 $p(\mathbf{x}, t) + C$ 同样是解，因为 $\nabla(p+C) = \nabla p$。这表明，仅通过控制方程，我们只能确定压力的相对差值，而无法确定其[绝对值](@entry_id:147688)。因此，在数值求解时，必须在域内的某一点或单元上指定一个参考压力值，以消除这种不确定性，从而确保离散代数系统的非奇异性 [@problem_id:2516608]。

更深层次地看，压力 $p$ 在不可压缩流体力学中的作用可以被理解为一个**拉格朗日乘子**（Lagrange multiplier）。它的存在是为了在流动的每一点上强制执行运动学约束 $\nabla \cdot \mathbf{u} = 0$ [@problem_id:2516608]。压[力场](@entry_id:147325)会自发地调整，以确保最终得到的速度场是无散的。

这种独特的耦合机制的数学本质可以通过对[动量方程](@entry_id:197225)求散度来揭示。对[动量方程](@entry_id:197225)两侧同时应用[散度算子](@entry_id:265975) $\nabla \cdot$，并利用 $\nabla \cdot \mathbf{u} = 0$ 这一条件（假设密度和粘度恒定），可以得到一个关于压力的[泊松方程](@entry_id:143763)（Poisson equation）：

$$
\nabla^2 p = -\rho \nabla \cdot ((\mathbf{u} \cdot \nabla)\mathbf{u}) + \nabla \cdot \mathbf{f}
$$

该方程清晰地表明，压[力场](@entry_id:147325)由速度场的[非线性](@entry_id:637147)[对流](@entry_id:141806)项和外力的散度决定。由于[拉普拉斯算子](@entry_id:146319) $\nabla^2$ 是一个**[椭圆算子](@entry_id:181616)**（elliptic operator），这意味着域内任何一点的压力值都受到整个计算域边界条件和内部[源项](@entry_id:269111)的全局影响。这种“瞬时”的全局耦合特性，正是[压力-速度耦合](@entry_id:155962)问题的核心所在，也是为什么需要设计专门的全局[迭代算法](@entry_id:160288)来求解的原因 [@problem_id:2516608]。

### 离散化与数值伪影的出现

当我们将连续的控制方程转化为离散的[代数方程](@entry_id:272665)组时（例如，使用[有限体积法](@entry_id:749372)，FVM），新的挑战随之而来，这些挑战与变量在网格上的排布方式密切相关。

#### [同位网格](@entry_id:175200)问题：压力棋盘格现象

在[计算流体力学](@entry_id:747620)中，最直观的变量存储方式是**[同位网格](@entry_id:175200)**（collocated grid），即将所有变量（如压力 $p$ 和速度分量 $u, v, w$）都存储在同一个位置，通常是[控制体](@entry_id:143882)的中心 [@problem_id:2516606]。这种方法在处理复杂几何和[非结构化网格](@entry_id:756356)时具有[数据结构](@entry_id:262134)简单的优势。然而，若采用标准的[中心差分格式](@entry_id:747203)来近似压力梯度和速度通量，会导致严重的数值问题。

考虑一个一维[同位网格](@entry_id:175200)，在控制体中心 $P$ 处的[压力梯度](@entry_id:274112)项 $\nabla p$ 通常被离散为 $\frac{p_E - p_W}{2\Delta x}$，其中 $E$ 和 $W$ 分别是 $P$ 的东、西相邻节点。而计算控制体界面（如 $e$ 面）上的速度时，最简单的方法是[线性插值](@entry_id:137092)，$u_e = \frac{u_P + u_E}{2}$。当这些离散格式组合在一起时，离散的[连续性方程](@entry_id:195013)和压力-校正方程可能无法“感知”到一种高频、非物理的压力[振荡](@entry_id:267781)模式，即**[棋盘格压力](@entry_id:164851)场**（checkerboard pressure field）[@problem_id:2516606, @problem_id:2516608]。在这种模式下，压力值在相邻节点间交替出现高低值（如 $p_i = p_0(-1)^i$）。这样的压[力场](@entry_id:147325)在[控制体](@entry_id:143882)界面上计算出的压力梯度可能为零或极小，从而无法驱动速度场来消除这种[振荡](@entry_id:267781)，导致压力和[速度场](@entry_id:271461)在空间上解耦。

#### 经典解决方案：[交错网格](@entry_id:147661)

解决棋盘格问题的经典方法是由 Harlow 和 Welch 提出的**[交错网格](@entry_id:147661)**（staggered grid）。在交错网格中，不同的变量存储在不同的位置：压力 $p$ 存储在控制体中心，而速度分量则存储在控制体的界面上（例如，$u$ 存储在东西界面中心，$v$ 存储在南北界面中心）[@problem_id:2516606]。

这种安排的精妙之处在于它在离散层面建立了压力与速度之间的紧密耦合。例如，控制东西向速度 $u_e$ 的[动量方程](@entry_id:197225)中，[压力梯度](@entry_id:274112)项自然地被离散为 $\frac{p_E - p_P}{\Delta x}$，直接使用了速度所在界面两侧的压力节点。同样，在为压力节点 $P$ 建立连续性方程时，所需要的界面速度 $u_e$ 和 $u_w$ 恰好是存储在这些位置上的基本变量，无需插值。这样一来，相邻压力节点之间的任何差异都会直接驱动界面速度，从而有力地抑制了任何非物理的压力[振荡](@entry_id:267781)模式 [@problem_id:2516595, @problem_id:2516606]。

#### [同位网格](@entry_id:175200)的现代解决方案：Rhie-Chow 动量插值

尽管交错网格在数值上非常稳健，但其复杂的数据结构给处理复杂几何和[非结构化网格](@entry_id:756356)带来了极大的不便。为了在保留[同位网格](@entry_id:175200)便利性的同时克服其数值缺陷，Rhie 和 Chow 提出了一种特殊的**动量插值**方法 [@problem_id:2516595, @problem_id:2516608]。

Rhie-Chow 插值的核心思想不是直接插值速度，而是通过插值离散动量方程的各项来构造界面速度。考虑一维情况，在节点 $P$ 处的离散[动量方程](@entry_id:197225)可以写为：

$$
a_P u_P = \sum_{nb} a_{nb} u_{nb} + S_u + A (p_W - p_E)
$$

其中 $a_P$ 是中心系数，$\sum a_{nb} u_{nb}$ 代表邻近节点速度的贡献，$S_u$ 是[源项](@entry_id:269111)，$A$ 是界面面积。我们可以将其改写为 $u_P = \hat{u}_P + d_P (p_W - p_E)$，其中 $\hat{u}_P = \frac{\sum a_{nb} u_{nb} + S_u}{a_P}$ 包含了除[压力梯度](@entry_id:274112)外所有项的贡献，而 $d_P = A/a_P$ 是一个与[动量方程](@entry_id:197225)对角占优性相关的系数 [@problem_id:2516548]。

Rhie-Chow 插值通过对 $\hat{u}$ 进行[线性插值](@entry_id:137092)，并显式地加入一个在界面上计算的压力梯度项来构造界面速度 $u_e$：

$$
u_e = \overline{\hat{u}}_e + \overline{d}_e (p_P - p_E)
$$

其中，$\overline{\hat{u}}_e = \frac{1}{2}(\hat{u}_P + \hat{u}_E)$ 和 $\overline{d}_e = \frac{1}{2}(d_P + d_E)$ 是通过算术平均插值得到的量。这个表达式中的最后一项 $\overline{d}_e (p_P - p_E)$ 是关键。它在界面速度的表达式中引入了一个高阶的压力耗散项，该项直接与界面两侧的中心压力 $p_P$ 和 $p_E$ 耦合。这个附加项使得界面速度能够“感知”到相邻压力节点间的差异，从而有效地抑制了棋盘格[振荡](@entry_id:267781) [@problem_id:2516548]。

### [预测-校正框架](@entry_id:753691)：SIMPLE 算法

为了解决压力-速度的耦合问题，Patankar 和 Spalding 提出了**SIMPLE**（Semi-Implicit Method for Pressure-Linked Equations）算法，它是一种基于预测-校正思想的迭代方法，已成为计算流体力学领域的基石。

#### 算法步骤

SIMPLE 算法主要用于求解[稳态](@entry_id:182458)问题，其在一个迭代步内的基本流程如下 [@problem_id:2516561, @problem_id:2516552]：

1.  **初始化/猜测压[力场](@entry_id:147325)**：首先，需要一个猜测的压[力场](@entry_id:147325) $p^*$。在第一次迭[代时](@entry_id:173412)，可以将其设为零或一个合理的初值。

2.  **动量预测**：使用猜测的压[力场](@entry_id:147325) $p^*$，求解离散的动量方程，得到一个临时的、不满足[连续性方程](@entry_id:195013)的[速度场](@entry_id:271461)，称为**预测速度场**（predicted velocity field）$\mathbf{u}^*$。

3.  **压力校正**：$\mathbf{u}^*$ 通常不满足[连续性方程](@entry_id:195013)，即 $\nabla \cdot \mathbf{u}^* \neq 0$。我们需要找到一个压力校正场 $p'$ 和一个相应的速度校正场 $\mathbf{u}'$，使得校正后的速度场 $\mathbf{u} = \mathbf{u}^* + \mathbf{u}'$ 满足连续性方程。

4.  **场量更新**：求解出 $p'$ 后，用它来校正压[力场](@entry_id:147325)和[速度场](@entry_id:271461)，得到本次迭代的新解。

5.  **迭代**：重复步骤 2-4，直到解收敛。

#### 压力-校正方程

SIMPLE 算法的精髓在于如何构建并求解压力校正场 $p'$。其推导过程如下 [@problem_id:2516561]：

首先，校正后的速度 $\mathbf{u}$ 应该满足动量方程，而预测速度 $\mathbf{u}^*$ 满足使用 $p^*$ 时的[动量方程](@entry_id:197225)。将两者相减并进行简化，可以得到速度校正 $\mathbf{u}'$ 和压力校正 $p'$ 之间的近似关系。SIMPLE 算法的核心近似是忽略邻近速度校正的影响，从而得到一个局部的、代数形式的关系：

$$
\mathbf{u}' \approx - \mathbf{D} \nabla p'
$$

其中 $\mathbf{D}$ 是一个对角张量，其分量由离散[动量方程](@entry_id:197225)的中心系数 $a_P$ 构造而来（例如，在简化形式中 $D \approx 1/a_P$）。

接下来，要求校正后的速度场满足[连续性方程](@entry_id:195013) $\nabla \cdot \mathbf{u} = 0$，即 $\nabla \cdot (\mathbf{u}^* + \mathbf{u}') = 0$。将上述 $\mathbf{u}'$ 与 $p'$ 的关系代入，我们得到一个关于压力校正 $p'$ 的泊松型方程：

$$
\nabla \cdot (\mathbf{D} \nabla p') = \nabla \cdot \mathbf{u}^*
$$

这个方程被称为**压力-校正方程**（pressure-correction equation）。它的[源项](@entry_id:269111) $\nabla \cdot \mathbf{u}^*$ 正是预测速度场在每个控制体中的质量不平衡量。通过求解这个方程得到 $p'$，我们就能计算出相应的 $\mathbf{u}'$，从而使得新的[速度场](@entry_id:271461)满足连续性。在一个具体的一维有限体积离散形式中，该方程表现为 [@problem_id:2516605]：

$$
(D_e + D_w)p_P' = D_e p_E' + D_w p_W' - (\dot{m}_e^* - \dot{m}_w^*)
$$

其中 $D_e, D_w$ 是从[动量方程](@entry_id:197225)导出的界面系数，而 $(\dot{m}_e^* - \dot{m}_w^*)$ 是预测质量通量造成的不平衡。对于固壁等不可穿透边界，校正后的法向速度必须为零，这自然地导出了压力校正方程在该边界上的**齐次[诺伊曼边界条件](@entry_id:142124)**（homogeneous Neumann boundary condition），即 $\partial p' / \partial n = 0$ [@problem_id:2516561]。

#### 实际应用与稳定性

SIMPLE 算法中的近似处理（特别是忽略邻居速度校正）意味着计算出的 $p'$ 往往会“过度校正”。如果直接使用完整的 $p'$ 来更新压力，迭代过程很容易发生[振荡](@entry_id:267781)甚至发散。为了保证迭代的稳定性，必须引入**[欠松弛](@entry_id:756302)**（under-relaxation）[@problem_id:2516595]。

- **压力[欠松弛](@entry_id:756302)**：在更新压力时，只采用一部分校正量：$p^{k+1} = p^k + \alpha_p p'$，其中 $\alpha_p$ 是压力松弛因子，通常取值在 $(0, 1)$ 之间，典型值为 $0.3$ 到 $0.8$。

- **速度[欠松弛](@entry_id:756302)**：同样地，在求解动量预测方程时，也需要对速度进行[欠松弛](@entry_id:756302)，通常通过隐式方法修改离散方程的对角系数和[源项](@entry_id:269111)来实现 [@problem_id:2516552]。

松弛因子的选择对收敛性至关重要。过大的松弛因子可能导致发散，而过小的松弛因子则会显著减慢收敛速度。理论分析和实践表明，通常存在一个最优的速度松弛因子 $\alpha_u^\star$，使得收敛最快。将 $\alpha_u$ 设置得过小会削弱压力与速度之间的信息传递，阻碍连续性误差的消除，从而减慢整体收敛 [@problem_id:2516586]。同样，如果将压力松弛因子 $\alpha_p$ 设置得趋近于零，压[力场](@entry_id:147325)将几乎不更新，导致质量守恒的收敛极其缓慢 [@problem_id:2516586]。

最后，判断 SIMPLE 迭代是否收敛需要一套稳健的准则，单纯依赖变量变化量是不够的。可靠的**[收敛判据](@entry_id:158093)**应包括 [@problem_id:2516552]：
1.  所有求解方程（质量、动量、能量等）的**[残差范数](@entry_id:754273)**（residual norm）降至预设的阈值以下。
2.  整个计算域的**全局质量、动量和[能量守恒](@entry_id:140514)**得到高精度满足。
3.  关心的工程量（如[总压](@entry_id:265293)降、传热系数、升阻力等）不再随迭代次数变化，达到稳定。

### SIMPLE 算法的扩展与替代方案

基于 SIMPLE 的基本思想，研究者们发展了多种改进算法，以适应不同的应用场景或提高计算效率。

#### 用于[瞬态流](@entry_id:756109)动的 PISO 算法

**PISO**（Pressure Implicit with Splitting of Operators）算法是 SIMPLE 的一个重要扩展，主要为**瞬态问题**设计 [@problem_id:2516563]。对于瞬态模拟，在每个时间步内精确地满足耦合关系至关重要。PISO 算法通过在每个时间步内执行多次压力校正来实现这一点。

一个典型的 PISO 循环包含一个预测步和两个或更多个校正步 [@problem_id:2516595, @problem_id:2516563]：
1.  **动量预测**：与 SIMPLE 类似，使用上一时间步的压力求解动量方程，得到预测速度 $\mathbf{u}^*$。
2.  **第一次校正**：求解压力校正方程 $\nabla \cdot (\mathbf{D} \nabla p') = \nabla \cdot \mathbf{u}^*$，得到 $p'$。更新压力和速度，得到 $p^{**}$ 和 $\mathbf{u}^{**}$。
3.  **第二次校正**：对第一次校正后的[速度场](@entry_id:271461) $\mathbf{u}^{**}$，再次检查其散度。由于 SIMPLE 近似的影响，$\nabla \cdot \mathbf{u}^{**}$ 可能仍不为零。因此，构建并求解第二个压力校正方程 $\nabla \cdot (\mathbf{D} \nabla p'') = \nabla \cdot \mathbf{u}^{**}$，得到 $p''$。再次更新压力和速度。

PISO 算法的关键优势和效率来源在于，后续的校正步骤**重复使用**第一次预测步中计算出的[动量方程](@entry_id:197225)[系数矩阵](@entry_id:151473)（特别是其对角部分 $\mathbf{D}$），而无需重新组装和求解庞大的动量方程组 [@problem_id:2516563]。这些额外的校正步更精确地考虑了被 SIMPLE 忽略的邻居节点影响，可以看作是更好地逼近了真实的[舒尔补](@entry_id:142780)（Schur complement）算子 [@problem_id:2516586]。

由于 PISO 在每个时间步内实现了更紧密的[压力-速度耦合](@entry_id:155962)，它通常允许使用比 SIMPLE 更大的时间步长，并且常常无需或只需非常小的[欠松弛](@entry_id:756302)（即 $\alpha_p \approx 1$）[@problem_id:2516595, @problem_id:2516586]。但需要澄清的是，PISO 解决的是与压力波传播相关的稳定性问题，它并不能消除由[对流](@entry_id:141806)项显式处理带来的 CFL 条件限制 [@problem_id:2516595, @problem_id:2516563]。

#### 其他变体：SIMPLEC 和 SIMPLER

- **SIMPLEC**（SIMPLE-Consistent）：该算法通过对速度校正与压力校正之间的关系式进行更“一致”的近似，来改进 SIMPLE。它部分地考虑了邻居速度校正的影响，使得压力校正方程的系数更大，从而导致压力校正量更小，迭代过程通常比 SIMPLE 更稳定，允许使用更大的压力松弛因子，收敛也更快 [@problem_id:2516549]。

- **SIMPLER**（SIMPLE-Revised）：该算法采用了不同的策略。在每个迭代步中，它首先求解一个用于预测**压[力场](@entry_id:147325)本身**的[泊松方程](@entry_id:143763)，而不是压力校正。这个得到的压[力场](@entry_id:147325)被用来求解[动量方程](@entry_id:197225)。之后，它仍然执行一个标准的压力-校正步骤，但这次校正只用来更新速度场以满足连续性，而不改变已经预测出的压[力场](@entry_id:147325)。SIMPLER 的主要优点是它为[动量方程](@entry_id:197225)提供了一个更好的压[力场](@entry_id:147325)，但代价是每轮迭代需要多求解一个泊松方程，计算成本更高 [@problem_id:2516549]。

综上所述，[压力-速度耦合](@entry_id:155962)算法是不可压缩流数值模拟的核心技术。从理解压力作为拉格朗日乘子的物理角色，到处理离散化带来的数值挑战，再到掌握 SIMPLE、PISO 及其变体的算法机制和应用细节，是通往高保真传热传质仿真的必经之路。