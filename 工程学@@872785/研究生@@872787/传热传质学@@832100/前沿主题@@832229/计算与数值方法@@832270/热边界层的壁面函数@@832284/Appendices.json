{"hands_on_practices": [{"introduction": "在我们深入研究热壁函数的计算细节之前，首先必须掌握其应用的边界。这个练习旨在磨练您的判断力，识别何时应该使用壁函数，以及何时必须采用更耗费计算资源的壁面解析方法。正确地做出这一选择是进行可靠的热流体分析的第一步，也是理解模型假设和局限性的关键实践。[@problem_id:2537357]", "problem": "对加热平板上方的湍流边界层进行计算热流体分析，该分析使用雷诺平均纳维-斯托克斯（RANS）方程和两方程湍流闭合模型。壁面热通量不为零。温度场的近壁处理可以是热壁面函数，也可以是解析到壁面的粘性子层和热子层的低雷诺数积分。设局部摩擦速度定义为$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$，运动粘度为$\\nu$，边界层厚度为$\\delta_{99}$，局部摩擦雷诺数为$Re_{\\tau} = u_{\\tau}\\,\\delta_{99}/\\nu$。第一个离壁单元中心点的法向壁面距离为$y_{P}$，对应的内尺度壁面距离为$y_{P}^{+} = u_{\\tau}\\,y_{P}/\\nu$。普朗特数是$\\mathrm{Pr} = \\nu/\\alpha$，其中$\\alpha$是热扩散率。无量纲温度基于摩擦温度$T_{\\tau} = q_{w}/(\\rho c_{p} u_{\\tau})$，因此$T^{+} = (T_{w} - T)/T_{\\tau}$。\n\n热壁面函数假设存在一个重叠区，在该区域内，动量和热量的湍流输运都主导分子输运，从而允许$U^{+}$和$T^{+}$具有相似性形式，而解析到壁面则要求$y_{P}^{+} \\lesssim \\mathcal{O}(1)$并且不依赖于对数律重叠区。下列哪个标准最能确定何时应禁用热壁面函数，转而采用解析到壁面的方法？\n\nA. 当局部重叠区未充分发展或第一个单元位于热子层内时，禁用热壁面函数；具体来说，如果$Re_{\\tau} \\lesssim 200$或$y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$，其中对于$\\mathrm{Pr} \\gtrsim 1$，有$y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-1}$，对于$\\mathrm{Pr} \\lesssim 1$，有$y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-2/3}$。在这些情况下，目标是使$y_{P}^{+} \\lesssim 1$并积分到壁面。\n\nB. 仅当$y_{P}^{+} \\gtrsim 200$（邻壁单元远离壁面）时才禁用热壁面函数，因为否则壁面函数对数律是$T^{+}$最准确的表示。\n\nC. 仅当$Re_{\\tau} \\gtrsim 1000$（非常高的摩擦雷诺数）时才禁用热壁面函数，因为在非常高的$Re_{\\tau}$下，热对数层会失效，需要低雷诺数积分。\n\nD. 不禁用热壁面函数，因为现代的$T^{+}(y^{+},\\mathrm{Pr})$关联式对所有$y^{+}$和所有$\\mathrm{Pr}$（包括$y^{+} \\rightarrow 0$）都有效。\n\nE. 无论$Re_{\\tau}$和$\\mathrm{Pr}$如何，只要$y_{P}^{+}  30$就禁用热壁面函数，因为缓冲层会使相似性失效；否则，壁面函数总是安全的。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知条件\n- **系统：** 加热平板上方的湍流边界层。\n- **控制方程：** 雷诺平均纳维-斯托克斯（RANS）方程和两方程湍流闭合模型。\n- **边界条件：** 非零壁面热通量$q_{w}$。\n- **建模方法：** 热壁面函数 vs. 解析到壁面的低雷诺数积分。\n- **定义：**\n    - 摩擦速度：$u_{\\tau} = \\sqrt{\\tau_{w}/\\rho}$\n    - 运动粘度：$\\nu$\n    - 边界层厚度：$\\delta_{99}$\n    - 摩擦雷诺数：$Re_{\\tau} = u_{\\tau}\\,\\delta_{99}/\\nu$\n    - 第一个单元中心的法向壁面距离：$y_{P}$\n    - 内尺度壁面距离：$y_{P}^{+} = u_{\\tau}\\,y_{P}/\\nu$\n    - 普朗特数：$\\mathrm{Pr} = \\nu/\\alpha$\n    - 摩擦温度：$T_{\\tau} = q_{w}/(\\rho c_{p} u_{\\tau})$\n    - 无量纲温度：$T^{+} = (T_{w} - T)/T_{\\tau}$\n- **前提：**\n    - 热壁面函数假设存在一个重叠区，该区域内无量纲速度$U^{+}$和温度$T^{+}$遵循相似律。\n    - 解析到壁面需要网格满足$y_{P}^{+} \\lesssim \\mathcal{O}(1)$。\n- **问题：** 什么标准决定何时应禁用热壁面函数，转而采用解析流动到壁面的方法？\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述在科学上基于计算流体力学（CFD）用于湍流传热的既定理论和实践。所有术语（$u_{\\tau}$, $y^{+}$, $T^{+}$, $Re_{\\tau}$, $\\mathrm{Pr}$）和概念（RANS、壁面函数、低雷诺数建模）都是标准的并且定义正确。问题针对两种不同的近壁建模策略的应用标准，提出了一个清晰、客观且适定（well-posed）的问题。前提准确地表述了这些方法所基于的假设。该问题是自洽的、一致的、科学上合理的。它没有违反任何无效性标准。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将推导解答。\n\n### 原理推导\n热壁面函数是 RANS 建模中的一种计算捷径。它们通过应用半经验定律来桥接壁面与第一个离壁计算单元中心点之间的间隙，从而避免了在近壁区域使用高度解析的网格。该方法建立在“壁面律”的基础上，该定律假定当使用内变量（$u_{\\tau}$，$\\nu$）进行缩放时，湍流边界层内部的平均速度和温度剖面具有普适结构。\n\n这种方法的有效性取决于两个关键假设：\n1.  **对数重叠区的存在：** 边界层必须足够湍流（即具有足够高的雷诺数），以形成一个独特的对数区，在该区域中速度和温度剖面都遵循对数律。这个区域通常要求摩擦雷诺数$Re_{\\tau} = u_{\\tau}\\delta_{99}/\\nu$至少为几百。如果$Re_{\\tau}$太低（例如$Re_{\\tau} \\lesssim 200 - 300$），这个对数区域要么是初生的，要么是不存在的，从而使壁面函数的基础失效。\n2.  **合适的单元放置：** 第一个离壁单元的中心点，用其无量纲距离$y_{P}^{+}$表示，必须位于这个对数区域内。动量的对数律通常被认为在$y^{+} \\gtrsim 30$时有效。如果$y_{P}^{+}$太小（例如$y_{P}^{+} \\lesssim 30$），单元中心会落入粘性子层（$y^{+} \\lesssim 5$）或缓冲层（$5 \\lesssim y^{+} \\lesssim 30$），在这些区域对数律不适用。\n\n对于热壁面函数，情况因普朗特数$\\mathrm{Pr} = \\nu/\\alpha$而变得复杂。热（导热）子层的厚度相对于粘性子层的厚度强烈依赖于$\\mathrm{Pr}$。\n-   对于$\\mathrm{Pr} \\approx 1$（气体），热子层和粘性子层的厚度相当。两者的边缘大约都在$y^{+} \\approx 10-12$。\n-   对于$\\mathrm{Pr} \\gg 1$（油、水），热子层比粘性子层薄得多。分子传导被限制在靠近壁面的一个非常薄的层内。\n-   对于$\\mathrm{Pr} \\ll 1$（液态金属），热子层比粘性子层厚得多。即使在动量上已经完全是湍流的区域，分子传导也可能很显著。\n\n如果第一个单元中心$y_{P}^{+}$位于热子层内，那么热壁面函数是无效的，因为物理过程由分子传导（$T^{+} \\approx \\mathrm{Pr}\\,y^{+}$）主导，而不是热对数律所假设的湍流输运。因此，这个热子层的边缘$y_{t}^{+}$是$\\mathrm{Pr}$的函数。\n\n因此，如果出现以下任一情况，就必须禁用热壁面函数，并转而解析边界层（低雷诺数建模，这要求$y_{P}^{+} \\lesssim 1$）：\n(a) 整体流动的雷诺数（$Re_{\\tau}$）太低，不足以形成对数律区域。\n(b) 第一个单元被放置在热子层内，即$y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$。\n\n### 逐项分析\n\n**A. 当局部重叠区未充分发展或第一个单元位于热子层内时，禁用热壁面函数；具体来说，如果$Re_{\\tau} \\lesssim 200$或$y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$，其中对于$\\mathrm{Pr} \\gtrsim 1$，有$y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-1}$，对于$\\mathrm{Pr} \\lesssim 1$，有$y_{t}^{+}(\\mathrm{Pr}) \\approx 11.8\\,\\mathrm{Pr}^{-2/3}$。在这些情况下，目标是使$y_{P}^{+} \\lesssim 1$并积分到壁面。**\n\n该选项正确地指出了放弃壁面函数的两个主要条件。首先，低摩擦雷诺数（$Re_{\\tau} \\lesssim 200$）表明对数区未充分发展，使得壁面函数的前提有误。其次，它认识到如果第一个单元中心位于热子层内（$y_{P}^{+} \\le y_{t}^{+}(\\mathrm{Pr})$），则局部违反了对数律假设。所提供的$y_{t}^{+}$随$\\mathrm{Pr}$的缩放关系正确地捕捉了物理趋势：热子层在高$\\mathrm{Pr}$时变得非常薄，在低$\\mathrm{Pr}$时变得非常厚。最后，所规定的措施——目标是使$y_{P}^{+} \\lesssim 1$以进行直接积分——是低雷诺数建模的正确程序。此选项全面且物理上合理。\n\n**结论：正确**\n\n**B. 仅当$y_{P}^{+} \\gtrsim 200$（邻壁单元远离壁面）时才禁用热壁面函数，因为否则壁面函数对数律是$T^{+}$最准确的表示。**\n\n这个陈述根本上是错误的。对壁面函数假设的主要违反发生在$y_{P}^{+}$*太低*（即在缓冲层或粘性/热子层中，$y_{P}^{+} \\lesssim 30$）时，而不是太高时。对数律明确地对小的$y^{+}$无效。声称它对于$y_{P}^{+} \\lesssim 200$是“最准确的表示”是错误的，因为它忽略了子层和缓冲层的物理机制。\n\n**结论：错误**\n\n**C. 仅当$Re_{\\tau} \\gtrsim 1000$（非常高的摩擦雷诺数）时才禁用热壁面函数，因为在非常高的$Re_{\\tau}$下，热对数层会失效，需要低雷诺数积分。**\n\n这个推理是颠倒的。高雷诺数（$Re_{\\tau} \\gg 1$）正是对数重叠区最广阔、定义最明确的区域。因此，壁面函数在高$Re_{\\tau}$时最适用和最准确，而不是反过来。对数层在高$Re_{\\tau}$时不会“失效”，反而会变得更加显著。\n\n**结论：错误**\n\n**D. 不禁用热壁面函数，因为现代的$T^{+}(y^{+},\\mathrm{Pr})$关联式对所有$y^{+}$和所有$\\mathrm{Pr}$（包括$y^{+} \\rightarrow 0$）都有效。**\n\n这指的是所谓的“all-$y^{+}$”或“混合”壁面函数。虽然这些高级模型提供了一个试图平滑桥接子层和对数律区域的单一关联式，但它们仍然是近壁行为的一种*模型*，而不是对控制输运方程的直接解析。问题区分了使用“热壁面函数”和“解析……子层到壁面”。后者意味着使用一个本身有效直到壁面的湍流模型（低雷诺数模型）并在精细网格（$y_{P}^{+} \\lesssim 1$）上求解方程，这与任何类型的壁面函数都有根本的不同。断言“不应禁用”它们是对其普适性和准确性的夸大，尤其是在复杂流动或低雷诺数下。\n\n**结论：错误**\n\n**E. 无论$Re_{\\tau}$和$\\mathrm{Pr}$如何，只要$y_{P}^{+}  30$就禁用热壁面函数，因为缓冲层会使相似性失效；否则，壁面函数总是安全的。**\n\n这个选项提供了一个常见但过于简化的经验法则。$y_{P}^{+}  30$的条件确实是禁用壁面函数的一个主要原因。然而，“无论$Re_{\\tau}$和$\\mathrm{Pr}$如何”以及“否则……总是安全”的限定词是不正确的。如前所述，即使$y_{P}^{+} > 30$，低的$Re_{\\tau}$也可以使壁面函数无效。此外，对于低$\\mathrm{Pr}$流体，热子层可以延伸到$y^{+} = 30$以外，这意味着例如$y_{P}^{+} = 40$的单元仍可能位于导热区内，从而使热对数律无效。此选项缺乏选项A中提供的必要细微差别。\n\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2537357"}, {"introduction": "这个练习将引导您从基本原理推导热壁函数，并用它来预测壁面热流。更进一步，我们将探讨模型中经验常数（如冯·卡门常数$\\kappa$）的不确定性如何影响预测结果。通过进行敏感性分析，您将量化这些不确定性的贡献，这是理解和评估湍流模型预测能力的一项高级技能。[@problem_id:2537406]", "problem": "在平衡重叠区，使用近壁热壁函数对等温光滑平板上的湍流边界层进行建模。考虑一个近壁计算节点$P$，其距壁面的法向距离为$y_P$。假设流动为稳定、完全湍流、高雷诺数流动，在重叠区内压力梯度效应可忽略不计，分子热传导与湍流热输运相比也可忽略不计。使用梯度输运假说、涡扩散率封闭以及经典的重叠区湍流动量和热量输运标度律。\n\n定义与数据：\n- $P$点的流体性质：密度$\\rho$, 比热$c_p$, 和运动粘度$\\nu$。\n- 摩擦速度$u_{\\tau}$, $P$点的当地平均速度$U_P$, 以及壁面与节点间的温差$T_w - T_P$均为已知。\n- 无量纲壁面距离$y^+ \\equiv y_P u_{\\tau}/\\nu$和无量纲温度$\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w$, 其中$q_w$是从壁面指向流体的壁面热通量。\n- 重叠区的热壁函数由von Kármán常数$\\kappa$, 捕捉内外层匹配的热附加常数$B_t$以及湍流普朗特数$Pr_t$来表征。\n- 当地斯坦顿数由量值定义为$St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。\n\n任务：\n1) 从近壁热通量封闭式$q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y$（其中$\\alpha$为分子热扩散率，$\\alpha_t$为湍流热扩散率）、平衡重叠区的形式$\\nu_t = \\kappa y u_{\\tau}$和$\\alpha_t = \\nu_t/Pr_t$, 以及上述$\\theta^+$和$y^+$的定义出发，推导$\\theta^+$与$y^+$之间的对数壁函数关系，其形式为$\\theta^+(y^+) = \\text{(斜率)}\\times \\ln y^+ + \\text{(常数)}$。然后，在节点$P$处对其进行求值，并将$q_w$显式解出为$\\kappa$, $B_t$和$Pr_t$的函数，同时将$y_P^+ \\equiv y_P u_{\\tau}/\\nu$和所有其他列出的量视为已知。\n2) 使用您得到的$q_w$表达式，写出以$\\kappa$, $B_t$和$Pr_t$表示的$St$。\n3) 对$q_w$和$St$关于$\\kappa$, $B_t$和$Pr_t$进行一阶基于方差的局部敏感性分析。假设这三个输入是独立的、高斯的，并且其不确定性仅通过以下标称值和一个标准差的不确定度给出：\n   - $\\kappa = 0.41$, $\\sigma_{\\kappa} = 0.02$,\n   - $B_t = 3.40$, $\\sigma_{B_t} = 0.50$,\n   - $Pr_t = 0.85$, $\\sigma_{Pr_t} = 0.05$.\n   所有其他量都是确定性的（没有不确定性）。\n4) 使用关于标称点的一阶泰勒展开，量化$\\kappa$, $B_t$和$Pr_t$对输出方差$\\operatorname{Var}(q_w)$和$\\operatorname{Var}(St)$的分数贡献。即，对于输出$f$，\n$$\n\\operatorname{Var}(f)\\,\\approx\\,\\left(\\frac{\\partial f}{\\partial \\kappa}\\right)^{\\!2}\\sigma_{\\kappa}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial B_t}\\right)^{\\!2}\\sigma_{B_t}^{2} \\;+\\; \\left(\\frac{\\partial f}{\\partial Pr_t}\\right)^{\\!2}\\sigma_{Pr_t}^{2},\n$$\n输入$x_i$的分数贡献等于其项除以$\\operatorname{Var}(f)$。在对$\\kappa$, $B_t$和$Pr_t$求导时，将$y_P^+$视为常数。\n5) 使用以下数值数据进行评估：\n   - $\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}$, $c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$,\n   - $\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$,\n   - $y_P = 1.00 \\times 10^{-3}\\,\\text{m}$,\n   - $u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}$,\n   - $U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}$,\n   - $T_w - T_P = 20.0\\,\\text{K}$.\n按以下顺序报告六个方差贡献分数\n$$\n\\kappa \\text{ in } q_w,\\; B_t \\text{ in } q_w,\\; Pr_t \\text{ in } q_w,\\; \\kappa \\text{ in } St,\\; B_t \\text{ in } St,\\; Pr_t \\text{ in } St.\n$$\n将每个分数表示为小数（无单位），并四舍五入到四位有效数字。将这六个数字表示为单行矩阵。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n步骤1：提取已知条件\n- **流动条件**：等温光滑平板上的稳定、完全湍流、高雷诺数流动。压力梯度效应可忽略。\n- **关注区域**：平衡重叠区。\n- **传热模型**：梯度输运假说与涡扩散率封闭。在重叠区，分子热传导$\\alpha$与湍流热输运$\\alpha_t$相比可忽略不计。\n- **本构关系**：$q_w = -\\rho c_p(\\alpha + \\alpha_t)\\,\\partial T/\\partial y$, $\\nu_t = \\kappa y u_{\\tau}$, $\\alpha_t = \\nu_t/Pr_t$。\n- **流体性质**：密度$\\rho$, 比热$c_p$, 运动粘度$\\nu$。\n- **已知变量**：摩擦速度$u_{\\tau}$, 节点$P$处的平均速度$U_P$, 温差$T_w - T_P$, 节点$P$距壁面的距离$y_P$。\n- **定义**：\n  - 无量纲壁面距离：$y^+ \\equiv y u_{\\tau}/\\nu$。\n  - 无量纲温度：$\\theta^+ \\equiv (T_w - T)\\,\\rho c_p u_{\\tau}/q_w$。\n  - 壁面热通量$q_w$从壁面指向流体。\n  - 当地斯坦顿数：$St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。\n- **模型参数**：von Kármán常数$\\kappa$, 热附加常数$B_t$, 湍流普朗特数$Pr_t$。\n- **敏感性分析输入**：\n  - $\\kappa = 0.41$, $\\sigma_{\\kappa} = 0.02$。\n  - $B_t = 3.40$, $\\sigma_{B_t} = 0.50$。\n  - $Pr_t = 0.85$, $\\sigma_{Pr_t} = 0.05$。\n  - 这些输入是独立的且呈高斯分布。\n- **敏感性分析公式**：$\\operatorname{Var}(f)\\,\\approx\\,\\sum_i \\left(\\frac{\\partial f}{\\partial x_i}\\right)^{\\!2}\\sigma_{x_i}^{2}$。\n- **敏感性分析约束**：在对$\\kappa$, $B_t$和$Pr_t$求导时，将$y_P^+$视为常数。\n- **用于评估的数值数据**：\n  - $\\rho = 1.20\\,\\text{kg}\\,\\text{m}^{-3}$, $c_p = 1005\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$, $\\nu = 1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n  - $y_P = 1.00 \\times 10^{-3}\\,\\text{m}$, $u_{\\tau} = 0.50\\,\\text{m}\\,\\text{s}^{-1}$, $U_P = 10.0\\,\\text{m}\\,\\text{s}^{-1}$, $T_w - T_P = 20.0\\,\\text{K}$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是关于壁函数的湍流传热和计算流体力学（CFD）中的一个标准练习。问题提法恰当，具有足够的信息和一致的定义以推导出唯一解。语言客观而精确。物理参数是现实的。该问题不违反任何基本原理，并且是完全可形式化的。\n\n步骤3：结论与行动\n该问题被判定为**有效**。将提供解答。\n\n**任务1：热壁函数的推导及$q_w$的表达式**\n\n起点是法向$y$上的近壁热通量封闭式：\n$$\nq_w = -\\rho c_p(\\alpha + \\alpha_t)\\frac{dT}{dy}\n$$\n在湍流重叠区，分子扩散率与湍流扩散率相比可以忽略不计，即$\\alpha \\ll \\alpha_t$。因此，方程简化为：\n$$\nq_w \\approx -\\rho c_p \\alpha_t \\frac{dT}{dy}\n$$\n使用给定的湍流扩散率关系式$\\alpha_t = \\nu_t/Pr_t$和涡粘度关系式$\\nu_t = \\kappa y u_{\\tau}$：\n$$\nq_w \\approx -\\rho c_p \\left( \\frac{\\kappa y u_{\\tau}}{Pr_t} \\right) \\frac{dT}{dy}\n$$\n我们重新整理以求解温度梯度：\n$$\n\\frac{dT}{dy} \\approx -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}}\n$$\n接下来，我们使用无量纲温度$\\theta^+$和壁面距离$y^+$的定义。将$\\theta^+ = (T_w - T)\\rho c_p u_{\\tau}/q_w$对$y$求导，得到：\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\frac{dT}{dy}\n$$\n代入$dT/dy$的表达式：\n$$\n\\frac{d\\theta^+}{dy} = -\\frac{\\rho c_p u_{\\tau}}{q_w} \\left( -\\frac{q_w Pr_t}{\\rho c_p \\kappa y u_{\\tau}} \\right) = \\frac{Pr_t}{\\kappa y}\n$$\n为了用壁面单位表示，我们使用链式法则和$y^+ = y u_{\\tau}/\\nu$：\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{d\\theta^+}{dy} \\frac{dy}{dy^+} = \\left( \\frac{Pr_t}{\\kappa y} \\right) \\left( \\frac{\\nu}{u_{\\tau}} \\right)\n$$\n代入$y = y^+ \\nu / u_{\\tau}$：\n$$\n\\frac{d\\theta^+}{dy^+} = \\frac{Pr_t}{\\kappa (y^+ \\nu / u_{\\tau})} \\frac{\\nu}{u_{\\tau}} = \\frac{Pr_t}{\\kappa y^+}\n$$\n对这个常微分方程积分，得到温度的对数律：\n$$\n\\theta^+(y^+) = \\int \\frac{Pr_t}{\\kappa y^+} dy^+ = \\frac{Pr_t}{\\kappa} \\ln(y^+) + C\n$$\n积分常数$C$是热附加常数，此处记为$B_t$。因此，壁函数为：\n$$\n\\theta^+(y^+) = \\frac{Pr_t}{\\kappa} \\ln(y^+) + B_t\n$$\n这与所要求的形式$\\theta^+(y^+) = \\text{(斜率)}\\times \\ln y^+ + \\text{(常数)}$相符，其中斜率为$Pr_t/\\kappa$，常数为$B_t$。\n为了求解$q_w$，我们在近壁节点$P$（其中$y=y_P$且$T=T_P$）处评估此关系：\n$$\n\\theta^+_P = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{q_w} = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t\n$$\n显式求解$q_w$：\n$$\nq_w = \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t}\n$$\n\n**任务2：斯坦顿数$St$的表达式**\n\n斯坦顿数定义为$St \\equiv |q_w|/\\big(\\rho c_p U_P\\,|T_P - T_w|\\big)$。给定$T_w - T_P  0$, 那么从壁面到流体的热通量$q_w$为正。因此，$|q_w| = q_w$且$|T_P - T_w| = T_w - T_P$。定义简化为：\n$$\nSt = \\frac{q_w}{\\rho c_p U_P (T_w - T_P)}\n$$\n代入任务1中$q_w$的表达式：\n$$\nSt = \\frac{1}{\\rho c_p U_P (T_w - T_P)} \\left( \\frac{(T_w - T_P)\\rho c_p u_{\\tau}}{\\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t} \\right)\n$$\n消去公因子$\\rho$, $c_p$和$(T_w - T_P)$，得到$St$的表达式：\n$$\nSt = \\frac{u_{\\tau}}{U_P \\left( \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t \\right)}\n$$\n\n**任务3和4：敏感性分析与方差贡献**\n\n令分母项为$D(\\kappa, B_t, Pr_t) = \\frac{Pr_t}{\\kappa} \\ln(y^+_P) + B_t$。那么我们有：\n$$\nq_w = \\frac{C_1}{D} \\quad \\text{其中} \\quad C_1 = (T_w - T_P)\\rho c_p u_{\\tau}\n$$\n$$\nSt = \\frac{C_2}{D} \\quad \\text{其中} \\quad C_2 = \\frac{u_{\\tau}}{U_P}\n$$\n问题陈述要求在对$\\kappa$, $B_t$和$Pr_t$求导时，将$y_P^+$视为常数。因此，$C_1$和$C_2$也被视为常数。\n对于一般函数$f = C/D$, 其对$D$的参数$x_i$的偏导数为$\\frac{\\partial f}{\\partial x_i} = -\\frac{C}{D^2} \\frac{\\partial D}{\\partial x_i} = -\\frac{f}{D} \\frac{\\partial D}{\\partial x_i}$。\n输入$x_i$的方差项为$\\left(\\frac{\\partial f}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\left(-\\frac{f}{D}\\right)^2 \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$。\n总的一阶方差为$\\operatorname{Var}(f) \\approx \\sum_i \\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2 = \\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2$。\n输入$x_k$对$f$方差的分数贡献为：\n$$\nF_{f, x_k} = \\frac{\\frac{f^2}{D^2} \\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\frac{f^2}{D^2} \\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2} = \\frac{\\left(\\frac{\\partial D}{\\partial x_k}\\right)^2 \\sigma_{x_k}^2}{\\sum_i \\left(\\frac{\\partial D}{\\partial x_i}\\right)^2 \\sigma_{x_i}^2}\n$$\n只要函数$f$的形式为$C/D$, 这个分数就与$f$（$q_w$或$St$）无关。因此，$q_w$和$St$的方差分数贡献是相同的。我们只需计算一次。\n\n令$L = \\ln(y^+_P)$。所需$D = \\frac{Pr_t}{\\kappa}L + B_t$的偏导数为：\n$$\n\\frac{\\partial D}{\\partial \\kappa} = -\\frac{Pr_t}{\\kappa^2}L\n$$\n$$\n\\frac{\\partial D}{\\partial B_t} = 1\n$$\n$$\n\\frac{\\partial D}{\\partial Pr_t} = \\frac{L}{\\kappa}\n$$\n构成总方差因子$\\sum_i (\\partial D/\\partial x_i)^2 \\sigma_{x_i}^2$的三项是：\n- $\\kappa$的项：$V_\\kappa = \\left(-\\frac{Pr_t L}{\\kappa^2}\\right)^2 \\sigma_\\kappa^2 = \\frac{Pr_t^2 L^2}{\\kappa^4} \\sigma_\\kappa^2$\n- $B_t$的项：$V_{B_t} = (1)^2 \\sigma_{B_t}^2 = \\sigma_{B_t}^2$\n- $Pr_t$的项：$V_{Pr_t} = \\left(\\frac{L}{\\kappa}\\right)^2 \\sigma_{Pr_t}^2 = \\frac{L^2}{\\kappa^2} \\sigma_{Pr_t}^2$\n\n总方差因子是$V_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t}$。分数贡献是$F_\\kappa = V_\\kappa/V_{tot}$, $F_{B_t} = V_{B_t}/V_{tot}$和$F_{Pr_t} = V_{Pr_t}/V_{tot}$。\n\n**任务5：数值计算**\n\n首先，计算无量纲壁面距离$y^+_P$：\n$$\ny^+_P = \\frac{y_P u_{\\tau}}{\\nu} = \\frac{(1.00 \\times 10^{-3}\\,\\text{m}) (0.50\\,\\text{m}\\,\\text{s}^{-1})}{1.50 \\times 10^{-5}\\,\\text{m}^{2}\\,\\text{s}^{-1}} = \\frac{0.5 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{1}{3} \\times 10^2 = \\frac{100}{3}\n$$\n现在，计算$L = \\ln(y^+_P)$：\n$$\nL = \\ln\\left(\\frac{100}{3}\\right) \\approx 3.5065579\n$$\n我们使用参数的标称值：$\\kappa = 0.41$, $B_t = 3.40$, $Pr_t = 0.85$。标准差为$\\sigma_\\kappa=0.02$, $\\sigma_{B_t}=0.50$, $\\sigma_{Pr_t}=0.05$。\n\n现在，计算方差分量：\n$$\nV_\\kappa = \\frac{0.85^2 \\times (\\ln(100/3))^2}{0.41^4} \\times 0.02^2\n= \\frac{0.7225 \\times 12.295946}{0.02825761} \\times 0.0004 \\approx 314.390 \\times 0.0004 \\approx 0.125756\n$$\n$$\nV_{B_t} = 0.50^2 = 0.25\n$$\n$$\nV_{Pr_t} = \\frac{(\\ln(100/3))^2}{0.41^2} \\times 0.05^2\n= \\frac{12.295946}{0.1681} \\times 0.0025 \\approx 73.1466 \\times 0.0025 \\approx 0.182867\n$$\n总方差分量为：\n$$\nV_{tot} = V_\\kappa + V_{B_t} + V_{Pr_t} \\approx 0.125756 + 0.25 + 0.182867 = 0.558623\n$$\n分数贡献为：\n$$\nF_\\kappa = \\frac{V_\\kappa}{V_{tot}} \\approx \\frac{0.125756}{0.558623} \\approx 0.22514\n$$\n$$\nF_{B_t} = \\frac{V_{B_t}}{V_{tot}} \\approx \\frac{0.25}{0.558623} \\approx 0.44755\n$$\n$$\nF_{Pr_t} = \\frac{V_{Pr_t}}{V_{tot}} \\approx \\frac{0.182867}{0.558623} \\approx 0.32731\n$$\n四舍五入到四位有效数字：\n- 来自$\\kappa$的贡献：$0.2251$\n- 来自$B_t$的贡献：$0.4476$\n- 来自$Pr_t$的贡献：$0.3273$\n总和为$0.2251 + 0.4476 + 0.3273 = 1.0000$。\n\n如前所述，对$q_w$方差的分数贡献与对$St$的分数贡献相同。所需的六个值是这三个数字的重复。\n最终值：\n- $F_{q_w,\\kappa} = F_{St,\\kappa} \\approx 0.2251$\n- $F_{q_w,B_t} = F_{St,B_t} \\approx 0.4476$\n- $F_{q_w,Pr_t} = F_{St,Pr_t} \\approx 0.3273$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2251  0.4476  0.3273  0.2251  0.4476  0.3273\n\\end{pmatrix}\n}\n$$", "id": "2537406"}, {"introduction": "在实际工程问题中，流体物性（如密度、粘度和导热系数）会随温度显著变化，这使得壁函数计算成为一个非线性问题。本练习要求您设计并实现一个迭代程序，以确保在计算壁面热流时，物性是在热力学一致的参考温度下计算的。这反映了在真实 CFD 软件中处理变物性流动的核心挑战。[@problem_id:2537356]", "problem": "考虑一个等温平壁上完全发展的、稳态的、湍流边界层，其近壁计算单元的中心距壁面的法向距离为$y_P$。设单元中心温度为$T_P$，壁面温度为$T_w$。假设空气为低马赫数流动，因此热物理性质可仅视为温度的函数。目标是使用热壁函数计算一个热力学上一致的壁面热通量$q_w$，同时在$T_P$和$T_w$之间迭代更新物性的评估值。\n\n从以下基本原理和经过充分检验的公式出发：\n\n- 恒定静压$p$下空气的理想气体定律：$\\rho(T) = \\dfrac{p}{R T}$，其中$R = 287.058\\ \\mathrm{J/(kg\\cdot K)}$。\n- 通过 Sutherland 定律计算动力粘度：\n$$\n\\mu(T) = \\mu_0 \\left(\\dfrac{T}{T_0}\\right)^{3/2} \\dfrac{T_0 + S}{T + S},\\quad \\mu_0 = 1.716\\times 10^{-5}\\ \\mathrm{Pa\\cdot s},\\ T_0 = 273.15\\ \\mathrm{K},\\ S = 110.4\\ \\mathrm{K}.\n$$\n- 热导率（空气在适中温度范围内的经验线性拟合）：\n$$\nk(T) = k_0 + a_k\\,(T - T_0),\\quad k_0 = 0.0241\\ \\mathrm{W/(m\\cdot K)},\\ a_k = 7.2\\times 10^{-5}\\ \\mathrm{W/(m\\cdot K^2)},\\ T_0 = 273.15\\ \\mathrm{K}.\n$$\n- 定压比热（经验线性拟合）：\n$$\nc_p(T) = c_{p0} + a_{cp}\\,(T - 300\\ \\mathrm{K}),\\quad c_{p0} = 1006.43\\ \\mathrm{J/(kg\\cdot K)},\\ a_{cp} = 0.1\\ \\mathrm{J/(kg\\cdot K^2)}.\n$$\n- 分子普朗特数：\n$$\n\\Pr(T) = \\dfrac{\\mu(T)\\,c_p(T)}{k(T)}.\n$$\n- 湍流普朗特数视为常数：$\\Pr_t = 0.85$。\n- 定义摩擦速度$u_\\tau$和无量纲壁面距离\n$$\ny^+ = \\dfrac{\\rho\\,u_\\tau\\,y_P}{\\mu}.\n$$\n- 通过下式定义温度尺度和壁面热通量\n$$\nT_\\tau = \\dfrac{q_w}{\\rho\\,c_p\\,u_\\tau},\\qquad q_w = \\rho\\,c_p\\,u_\\tau\\,T_\\tau,\n$$\n以及单元中心的内尺度温度\n$$\nT^+ = \\dfrac{T_P - T_w}{T_\\tau}.\n$$\n\n采用一个标准的分段热壁函数剖面，该剖面在匹配点上连续地连接粘性底层和对数区。令$\\kappa = 0.41$，$E = 9.8$，$y_0^+ = 11.81$。定义有效对数斜率为$\\kappa_t = \\kappa\\,\\Pr_t$。那么，对于给定的$y^+$和分子普朗特数$\\Pr$，\n$$\nT^+(y^+;\\Pr) =\n\\begin{cases}\n\\Pr\\,y^+,  y^+ \\le y_0^+, \\\\[4pt]\n\\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y^+\\big) + B_t(\\Pr),  y^+ > y_0^+,\n\\end{cases}\n$$\n其中加性常数确保在$y_0^+$处的连续性：\n$$\nB_t(\\Pr) = \\Pr\\,y_0^+ - \\dfrac{1}{\\kappa_t}\\ln\\!\\big(E\\,y_0^+\\big).\n$$\n\n任务 A（推导）。使用上述定义和壁面的能量平衡，推导一个不动点迭代，该迭代在壁函数循环内强制实现$T_P$和$T_w$之间物性评估的热力学一致性。你的迭代必须：\n- 使用参考温度$T_{\\mathrm{ref}}$来评估$\\rho(T_{\\mathrm{ref}})$、$\\mu(T_{\\mathrm{ref}})$、$k(T_{\\mathrm{ref}})$、$c_p(T_{\\mathrm{ref}})$和$\\Pr(T_{\\mathrm{ref}})$。\n- 计算$y^+ = \\rho(T_{\\mathrm{ref}})\\,u_\\tau\\,y_P/\\mu(T_{\\mathrm{ref}})$，然后计算$T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$，接着计算$T_\\tau = (T_P - T_w)/T^+(y^+;\\Pr(T_{\\mathrm{ref}}))$和$q_w = \\rho(T_{\\mathrm{ref}})\\,c_p(T_{\\mathrm{ref}})\\,u_\\tau\\,T_\\tau$。\n- 根据壁函数温度分布更新$T_{\\mathrm{ref}}$，以更好地表示$T_P$和$T_w$之间的热力学状态。一个有原则的选择是取基于剖面的中点温度：令$y_m^+ = y^+/2$并设置\n$$\nT_{\\mathrm{mid}} = T_w + T_\\tau\\,T^+(y_m^+;\\Pr(T_{\\mathrm{ref}})).\n$$\n构建一个松弛不动点更新$T_{\\mathrm{ref}} \\leftarrow (1-\\beta)\\,T_{\\mathrm{ref}} + \\beta\\,T_{\\mathrm{mid}}$，其中松弛因子$\\beta \\in (0,1]$，并迭代直至$T_{\\mathrm{ref}}$收敛。\n\n提供一个以$|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}|$表示的明确停止准则，并讨论如何防止发散，以及如何确保更新后的$T_{\\mathrm{ref}}$保持在$T_w$和$T_P$之间的物理允许区间内。\n\n任务 B（实现）。用代码实现所推导的迭代，对于每个测试工况，返回：\n- 收敛的壁面热通量$q_w$，单位为$\\mathrm{W/m^2}$，四舍五入到$3$位小数，\n- 收敛的$y^+$，四舍五入到$3$位小数，\n- 迭代次数（整数），\n- 一个整数形式的收敛标志，其中$1$表示收敛，$0$表示在迭代限制内未能收敛。\n\n使用以下测试套件，它涵盖了一个典型工况、一个粘性底层主导的工况、一个具有强物性变化的高$y^+$工况和一个小温差工况：\n\n- 工况 1：$p = 101325\\ \\mathrm{Pa}$，$T_w = 300\\ \\mathrm{K}$，$T_P = 600\\ \\mathrm{K}$，$u_\\tau = 0.5\\ \\mathrm{m/s}$，$y_P = 5.0\\times 10^{-4}\\ \\mathrm{m}$。\n- 工况 2：$p = 101325\\ \\mathrm{Pa}$，$T_w = 350\\ \\mathrm{K}$，$T_P = 400\\ \\mathrm{K}$，$u_\\tau = 0.3\\ \\mathrm{m/s}$，$y_P = 1.0\\times 10^{-4}\\ \\mathrm{m}$。\n- 工况 3：$p = 101325\\ \\mathrm{Pa}$，$T_w = 300\\ \\mathrm{K}$，$T_P = 1200\\ \\mathrm{K}$，$u_\\tau = 1.0\\ \\mathrm{m/s}$，$y_P = 3.0\\times 10^{-3}\\ \\mathrm{m}$。\n- 工况 4：$p = 101325\\ \\mathrm{Pa}$，$T_w = 320\\ \\mathrm{K}$，$T_P = 321\\ \\mathrm{K}$，$u_\\tau = 0.2\\ \\mathrm{m/s}$，$y_P = 1.0\\times 10^{-3}\\ \\mathrm{m}$。\n\n数值与实现要求：\n\n- 使用收敛容差$|T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}|  10^{-6}\\ \\mathrm{K}$，最大迭代次数为$100$次，并选择松弛因子$\\beta = 0.5$。\n- 在每次迭代中，将更新的$T_{\\mathrm{ref}}$限定在以$\\min(T_w,T_P)$和$\\max(T_w,T_P)$为端点的闭区间内。\n- 所有常数和系数必须与上面指定的完全一致。\n- 你的程序应生成单行输出，其中包含所有工况的结果，形式为无空格的、逗号分隔的列表之列表，并按测试工况的顺序排列。格式必须是：\n\"[ [q1,yplus1,it1,conv1], [q2,yplus2,it2,conv2], [q3,yplus3,it3,conv3], [q4,yplus4,it4,conv4] ]\"\n但没有空格，即：\n\"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],[q3,yplus3,it3,conv3],[q4,yplus4,it4,conv4]]\"\n其中每个$q_i$的单位为$\\mathrm{W/m^2}$，四舍五入到$3$位小数，每个$y^+_i$四舍五入到$3$位小数，而$it_i$和$conv_i$是整数。", "solution": "问题陈述经过验证，被认为是具有科学依据、提法恰当且完整的。它描述了计算传热学中一个标准且相关的问题：在湍流边界层中使用热壁函数计算壁面热通量，并增加了处理随温度变化的流体性质的复杂性。为获得唯一解所需的所有物理模型、常数和数值参数均已提供。任务是推导并实现一个不动点迭代，以确保流体性质在热力学上一致的参考温度下进行评估。\n\n推导与实现如下。\n\n目标是给定壁面温度$T_w$、距离$y_P$处的近壁单元中心温度$T_P$、静压$p$和摩擦速度$u_\\tau$，计算壁面热通量$q_w$。由于流体性质（$\\rho$、$\\mu$、$k$、$c_p$）是温度的强函数，它们必须在一个能正确反映近壁层热状态的代表性温度$T_{\\mathrm{ref}}$下进行评估。需要一个迭代过程来找到自洽的$T_{\\mathrm{ref}}$和相应的$q_w$。为此目的构建了一个不动点迭代方案。\n\n设迭代索引为$n$。过程始于对参考温度的初始猜测$T_{\\mathrm{ref}}^{(0)}$。一个稳健的初始猜测是壁面和单元中心温度的算术平均值：\n$$\nT_{\\mathrm{ref}}^{(0)} = \\frac{T_w + T_P}{2}\n$$\n\n对于$n = 0, 1, 2, \\dots$的迭代过程如下：\n\n1.  **评估热物理性质**：在当前的参考温度$T_{\\mathrm{ref}}^{(n)}$下，计算所有随温度变化的性质：\n    *   根据理想气体定律计算密度：$\\rho^{(n)} = \\rho(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{p}{R T_{\\mathrm{ref}}^{(n)}}$。\n    *   根据 Sutherland 定律计算动力粘度：$\\mu^{(n)} = \\mu(T_{\\mathrm{ref}}^{(n)})$。\n    *   根据线性拟合计算热导率：$k^{(n)} = k(T_{\\mathrm{ref}}^{(n)})$。\n    *   根据线性拟合计算定压比热：$c_p^{(n)} = c_p(T_{\\mathrm{ref}}^{(n)})$。\n    *   分子普朗特数：$\\Pr^{(n)} = \\Pr(T_{\\mathrm{ref}}^{(n)}) = \\dfrac{\\mu^{(n)} c_p^{(n)}}{k^{(n)}}$。\n\n2.  **计算无量纲参数**：计算位于$y_P$的单元中心的无量纲壁面距离：\n    $$\n    y^{+(n)} = \\frac{\\rho^{(n)} u_\\tau y_P}{\\mu^{(n)}}\n    $$\n\n3.  **评估无量纲温度$T^+$**：使用所提供的分段热壁面律，计算单元中心的无量纲温度$T_P^{+(n)} = T^+(y^{+(n)}; \\Pr^{(n)})$。有效对数斜率为$\\kappa_t = \\kappa \\Pr_t = 0.41 \\times 0.85 = 0.3485$。首先确定加性常数$B_t$以确保在匹配点$y_0^+ = 11.81$处的连续性：\n    $$\n    B_t^{(n)} = \\Pr^{(n)} y_0^+ - \\frac{1}{\\kappa_t}\\ln(E y_0^+)\n    $$\n    然后，由下式求得$T_P^{+(n)}$：\n    $$\n    T_P^{+(n)} =\n    \\begin{cases}\n    \\Pr^{(n)} y^{+(n)},  \\text{若 } y^{+(n)} \\le y_0^+ \\\\\n    \\dfrac{1}{\\kappa_t}\\ln(E y^{+(n)}) + B_t^{(n)},  \\text{若 } y^{+(n)}  y_0^+\n    \\end{cases}\n    $$\n\n4.  **计算热通量**：根据定义计算温度尺度$T_\\tau^{(n)}$：\n    $$\n    T_\\tau^{(n)} = \\frac{T_P - T_w}{T_P^{+(n)}}\n    $$\n    此迭代步的壁面热通量则为：\n    $$\n    q_w^{(n)} = \\rho^{(n)} c_p^{(n)} u_\\tau T_\\tau^{(n)}\n    $$\n\n5.  **更新参考温度**：基于当前解计算一个新的、更准确的参考温度。计算一个新温度$T_{\\mathrm{mid}}^{(n)}$，它代表近壁层中点$y_m = y_P/2$处的物理温度。首先，无量纲中点距离为$y_m^{+(n)} = y^{+(n)}/2$。使用与步骤 3 中相同的分段函数计算此点的无量纲温度$T_m^{+(n)} = T^+(y_m^{+(n)}; \\Pr^{(n)})$。则物理中点温度为：\n    $$\n    T_{\\mathrm{mid}}^{(n)} = T_w + T_\\tau^{(n)} T_m^{+(n)}\n    $$\n    使用松弛因子$\\beta = 0.5$通过松弛更新获得下一次迭代的参考温度$T_{\\mathrm{ref}}^{(n+1)}$：\n    $$\n    T_{\\mathrm{ref, cand}}^{(n+1)} = (1-\\beta)T_{\\mathrm{ref}}^{(n)} + \\beta T_{\\mathrm{mid}}^{(n)}\n    $$\n\n6.  **稳定化与收敛性检查**：\n    *   **防止发散**：为确保数值稳定性和物理可容许性，更新后的参考温度必须保持在壁面和单元中心温度所设定的界限内。因此，对$T_{\\mathrm{ref, cand}}^{(n+1)}$进行限定：\n      $$\n      T_{\\mathrm{ref}}^{(n+1)} = \\max(\\min(T_w, T_P), \\min(\\max(T_w, T_P), T_{\\mathrm{ref, cand}}^{(n+1)}))\n      $$\n      此步骤可防止迭代产生非物理温度，尤其是在温差较大或初始瞬态迭代期间。\n    *   **停止准则**：当连续参考温度之间的绝对差小于指定的容差$\\epsilon_T = 10^{-6}\\ \\mathrm{K}$时，认为迭代已收敛：\n      $$\n      |T_{\\mathrm{ref}}^{(n+1)} - T_{\\mathrm{ref}}^{(n)}|  \\epsilon_T\n      $$\n    *   **迭代次数限制**：设定最大迭代次数$N_{\\max} = 100$。如果在此限制内未达到收敛准则，则终止过程并标记为未收敛。\n\n收敛或达到迭代次数限制后，报告$q_w$、$y^+$的最终值、迭代次数以及一个收敛标志。这就完成了所需算法的逻辑，该算法在提供的 Python 代码中得以实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for wall heat flux using a thermal wall function with iterative property updates.\n    \"\"\"\n    # Constants\n    R = 287.058  # J/(kg.K), specific gas constant for air\n    # Sutherland's law for viscosity\n    MU0 = 1.716e-5  # Pa.s\n    T0_MU = 273.15  # K\n    S_MU = 110.4  # K\n    # Linear fit for thermal conductivity\n    K0 = 0.0241  # W/(m.K)\n    AK = 7.2e-5  # W/(m.K^2)\n    T0_K = 273.15 # K\n    # Linear fit for specific heat\n    CP0 = 1006.43  # J/(kg.K)\n    ACP = 0.1  # J/(kg.K^2)\n    T0_CP = 300.0 # K\n    # Turbulence model constants\n    PR_T = 0.85\n    KAPPA = 0.41\n    E = 9.8\n    Y0_PLUS = 11.81\n    KAPPA_T = KAPPA * PR_T\n\n    # Numerical parameters\n    BETA = 0.5  # Relaxation factor\n    TOL = 1e-6  # Convergence tolerance for T_ref\n    MAX_ITER = 100  # Maximum number of iterations\n\n    # Test cases\n    test_cases = [\n        # (p, Tw, Tp, u_tau, yP)\n        (101325.0, 300.0, 600.0, 0.5, 5.0e-4),\n        (101325.0, 350.0, 400.0, 0.3, 1.0e-4),\n        (101325.0, 300.0, 1200.0, 1.0, 3.0e-3),\n        (101325.0, 320.0, 321.0, 0.2, 1.0e-3),\n    ]\n\n    # --- Helper functions for thermophysical properties ---\n    def get_rho(T, p):\n        return p / (R * T)\n\n    def get_mu(T):\n        return MU0 * (T / T0_MU)**1.5 * (T0_MU + S_MU) / (T + S_MU)\n\n    def get_k(T):\n        return K0 + AK * (T - T0_K)\n\n    def get_cp(T):\n        return CP0 + ACP * (T - T0_CP)\n\n    def get_Pr(mu_val, cp_val, k_val):\n        return mu_val * cp_val / k_val\n\n    # --- Helper function for the piecewise wall function T+ ---\n    def get_T_plus(y_plus, pr_val):\n        # Calculate B_t, the additive constant for the log-law part\n        Bt_val = pr_val * Y0_PLUS - (1.0 / KAPPA_T) * np.log(E * Y0_PLUS)\n        if y_plus = Y0_PLUS:\n            return pr_val * y_plus\n        else:\n            return (1.0 / KAPPA_T) * np.log(E * y_plus) + Bt_val\n\n    results = []\n    for p, Tw, Tp, u_tau, yP in test_cases:\n        \n        # Initial guess for reference temperature\n        T_ref = (Tw + Tp) / 2.0\n        T_min = min(Tw, Tp)\n        T_max = max(Tw, Tp)\n        \n        converged = 0\n        iter_count = 0\n        q_w = 0.0\n        y_plus = 0.0\n        \n        for i in range(MAX_ITER):\n            iter_count = i + 1\n            T_ref_old = T_ref\n\n            # 1. Evaluate properties at T_ref\n            rho_val = get_rho(T_ref, p)\n            mu_val = get_mu(T_ref)\n            k_val = get_k(T_ref)\n            cp_val = get_cp(T_ref)\n            pr_val = get_Pr(mu_val, cp_val, k_val)\n            \n            # 2. Compute dimensionless parameters\n            y_plus = (rho_val * u_tau * yP) / mu_val\n\n            # 3. Evaluate dimensionless temperature at cell center\n            T_plus_P = get_T_plus(y_plus, pr_val)\n\n            # 4. Compute heat flux\n            delta_T = Tp - Tw\n            if abs(delta_T)  1e-9 or abs(T_plus_P)  1e-9:\n                T_tau = 0.0\n            else:\n                T_tau = delta_T / T_plus_P\n\n            q_w = rho_val * cp_val * u_tau * T_tau\n            \n            # 5. Update reference temperature\n            y_m_plus = y_plus / 2.0\n            T_plus_m = get_T_plus(y_m_plus, pr_val)\n            T_mid = Tw + T_tau * T_plus_m\n            \n            T_ref_cand = (1.0 - BETA) * T_ref + BETA * T_mid\n            \n            # 6. Clamp and check for convergence\n            T_ref = max(T_min, min(T_max, T_ref_cand))\n            \n            if abs(T_ref - T_ref_old)  TOL:\n                converged = 1\n                break\n\n        # Append results for this case\n        results.append([round(q_w, 3), round(y_plus, 3), iter_count, converged])\n    \n    # Format final output string as per requirement\n    # \"[[q1,yplus1,it1,conv1],[q2,yplus2,it2,conv2],...]\"\n    string_results = [f\"[{','.join(map(str, r))}]\" for r in results]\n    final_output = f\"[{','.join(string_results)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2537356"}]}