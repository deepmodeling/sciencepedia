## 引言
在[计算流体动力学](@entry_id:147500)（CFD）领域，精确模拟[湍流传热](@entry_id:189092)是众多工程与科学应用的核心挑战，从航空航天器的热防护设计到电子元件的散[热管理](@entry_id:146042)。然而，在[高雷诺数流](@entry_id:199822)动中，近壁区域存在着极其陡峭的速度和温度梯度，若要通过数值网格完全解析这些梯度，将导致难以承受的计算成本。为了解决这一难题，热壁函数（Thermal Wall Functions）应运而生，它作为一种高效的近壁模化方法，在工程模拟中扮演着至关重要的角色。本文旨在系统性地剖析热壁函数的理论与实践，填补理论知识与实际应用之间的鸿沟。

本文将引导读者踏上一条从基础到前沿的探索之旅。在“原则与机理”一章中，我们将深入[湍流边界层](@entry_id:267922)的核心，揭示其分层结构和普适的标度律，并在此基础上构建热壁函数的理论框架，同时审视其关键假设与固有限制。随后，在“应用与交叉学科联系”一章中，我们将探讨这些理论如何转化为CFD中的具体算法，并扩展到处理[可压缩性](@entry_id:144559)、[浮力](@entry_id:144145)、[表面粗糙度](@entry_id:171005)等复杂物理现象，展示其在[共轭传热](@entry_id:149857)和非平衡[边界层](@entry_id:139416)等前沿问题中的应用。最后，在“动手实践”一章中，读者将有机会通过一系列精心设计的问题，将理论知识应用于解决实际的计算挑战。通过本次学习，您将能够深刻理解并熟练运用热壁函数这一强大的建模工具。

## 原则与机理

本章旨在深入阐述热壁函数（Thermal Wall Functions）的理论基础、核心机理及其在计算流体动力学（CFD）中的应用。作为一种在[雷诺平均纳维-斯托克斯](@entry_id:173045)（RANS）模拟中处理壁面[湍流传热](@entry_id:189092)的重要方法，壁函数通过在[计算网格](@entry_id:168560)无法充分解析近壁区域时，建立壁面物理量与第一个离壁网格节点处变量之间的代数关系，从而极大地节省了计算资源。我们将从近壁区[湍流传热](@entry_id:189092)的基本标度律出发，系统地构建热壁函数的理论框架，探讨其核心假设、物理局限性，并进一步讨论[普朗特数](@entry_id:143303)、壁面粗糙度以及流动分离等复杂因素对壁函数模型的影响。

### 近壁区的[湍流传热](@entry_id:189092)与[标度律](@entry_id:139947)

理解热壁函数的前提是掌握[湍流边界层](@entry_id:267922)近壁区域的物理特性和标度律。在高[雷诺数](@entry_id:136372)下，壁面附近的[速度场](@entry_id:271461)和温度场表现出明显的分层结构，其行为受到粘性、湍流混合以及分子热传导的共同影响。

#### 内层结构

[湍流边界层](@entry_id:267922)的近壁区域，通常称为内层（Inner Layer），其厚度远小于整个[边界层厚度](@entry_id:269100)$\delta$。内层根据粘性效应和[湍流](@entry_id:151300)效应的相对重要性，可进一步划分为三个子层：

1.  **[粘性底层](@entry_id:269337) (Viscous Sublayer)**：紧邻壁面、极薄的一层（通常认为在$y^+ \lesssim 5$的范围内），其中[湍流](@entry_id:151300)脉动受到壁面的强烈抑制，动量和热量传递主要由分子粘性和分子热传导主导。
2.  **[缓冲层](@entry_id:160164) (Buffer Layer)**：位于[粘性底层](@entry_id:269337)和对数律层之间（约$5 \lesssim y^+ \lesssim 30$），[分子输运](@entry_id:195239)和[湍流输运](@entry_id:150198)的贡献相当，物理过程极为复杂。
3.  **惯性子层 (Inertial Sublayer)** 或 **对数律层 (Logarithmic Layer)**：位于[缓冲层](@entry_id:160164)之外（约$y^+ \gtrsim 30$且$y/\delta \ll 1$），[湍流输运](@entry_id:150198)占据绝对主导地位，而[分子输运](@entry_id:195239)的影响可以忽略不计。在这一层中，速度和温度剖面遵循普适的对数[分布](@entry_id:182848)规律。

#### 内层标度

为了描述近壁区物理量的普适行为，我们需要引入一套基于局部物理量的无量纲参数，即“内层标度”（Inner Scaling）。这套标度的核心思想是，在足够高的[雷诺数](@entry_id:136372)下，内层的流动和传热特性应仅由壁面剪切应力$\tau_w$、壁面热通量$q_w$、流体密度$\rho$、粘度$\nu$和热物性参数（如比热容$c_p$和热导率$k$）所决定，而与外部流动的宏观尺度（如[边界层厚度](@entry_id:269100)$\delta$或来流速度$U_\infty$）无关。

基于此，我们定义以下关键的内层标度变量 [@problem_id:2537369]：

*   **[摩擦速度](@entry_id:267882) (Friction Velocity)**, $u_\tau$：它代表了近壁区[湍流](@entry_id:151300)脉动的[特征速度](@entry_id:165394)尺度，定义为$u_\tau = \sqrt{\tau_w/\rho}$。
*   **摩擦温度 (Friction Temperature)**, $T_\tau$：它代表了近壁区温度变化的特征尺度，定义为$T_\tau = q_w / (\rho c_p u_\tau)$。这个定义源于壁面[热通量](@entry_id:138471)与[近壁湍流](@entry_id:194167)[对流输运](@entry_id:149512)能力（由$\rho c_p u_\tau$表征）之间的平衡。
*   **无量纲壁面距离 (Dimensionless Wall Distance)**, $y^+$：它使用粘性长度尺度$\nu/u_\tau$对壁面法向距离$y$进行无量纲化，$y^+ = y u_\tau / \nu$。
*   **无量纲温度 (Dimensionless Temperature)**, $T^+$：它使用摩擦温度$T_\tau$对壁面与流体的温差进行[无量纲化](@entry_id:136704)，$T^+ = (T_w - T) / T_\tau$，其中$T_w$是壁面温度，$T$是在距离$y$处的平均温度。

使用这些内层变量的目标，是希望找到一个普适的函数关系$T^+ = \mathcal{F}(y^+; Pr, Pr_t)$，它在高[雷诺数](@entry_id:136372)下不再依赖于全局雷诺数$Re$或壁面[热通量](@entry_id:138471)$q_w$的大小，仅保留[对流](@entry_id:141806)体物性（分子普朗特数$Pr$）和[湍流模型](@entry_id:190404)参数（[湍流普朗特数](@entry_id:153739)$Pr_t$）的依赖。正如我们将在后续推导中看到的，通过引入摩擦温度$T_\tau \propto q_w$，物理量$q_w$确实会从最终的无量纲温度剖面方程中抵消，使得$T^+(y^+)$的形状独立于[热通量](@entry_id:138471)的大小，这正是标度律成功的关键 [@problem_id:2537369] [@problem_id:2537382]。

#### 近壁区的温度[分布](@entry_id:182848)律

基于内层标度，我们可以推导出不同子层中的温度[分布](@entry_id:182848)规律。在近壁区域，总[热通量](@entry_id:138471)$q$（法向）可近似视为常数并等于壁面[热通量](@entry_id:138471)$q_w$。它由分子传导[热通量](@entry_id:138471)和[湍流热通量](@entry_id:151024)两部分组成：

$$ q_w \approx -k \frac{dT}{dy} + \rho c_p \overline{v'T'} $$

其中$\overline{v'T'}$是[雷诺平均](@entry_id:754341)后的[湍流热通量](@entry_id:151024)。

**[粘性底层](@entry_id:269337)**

在[粘性底层](@entry_id:269337)（$y^+ \to 0$），[湍流](@entry_id:151300)脉动几乎完全消失，因此$\overline{v'T'} \to 0$。热量传递完全由分子传导主导：

$$ q_w = -k \frac{dT}{dy} $$

将此方程用内层变量表示，我们有$dT = -T_\tau dT^+$和$dy = (\nu/u_\tau) dy^+$。代入并整理得：

$$ \frac{dT^+}{dy^+} = \frac{\rho c_p \nu}{k} = Pr $$

其中$Pr = \nu/\alpha = \nu/(k/\rho c_p)$是分子[普朗特数](@entry_id:143303)。积分上式并考虑到[壁面边界条件](@entry_id:756608)$T^+(0) = 0$，我们得到[粘性底层](@entry_id:269337)的线性温度剖面 [@problem_id:2537369]：

$$ T^+(y^+) = Pr \cdot y^+ $$

**对数律层**

在对数律层（$y^+$较大），[湍流输运](@entry_id:150198)远大于分子传导，因此总热通量近似等于[湍流热通量](@entry_id:151024)：

$$ q_w \approx \rho c_p \overline{v'T'} $$

为了封闭该方程，我们引入**[梯度扩散假说](@entry_id:156064) (Gradient Diffusion Hypothesis)**，该假说认为[湍流热通量](@entry_id:151024)与平均温度梯度成正比，类似于[分子扩散](@entry_id:154595) [@problem_id:2537382]：

$$ \overline{v'T'} = -\alpha_t \frac{dT}{dy} $$

其中$\alpha_t$是[湍流](@entry_id:151300)热扩散系数（或涡[扩散](@entry_id:141445)系数）。$\alpha_t$通常通过[湍流](@entry_id:151300)粘性系数$\nu_t$和**[湍流普朗特数](@entry_id:153739) (Turbulent Prandtl Number)**$Pr_t$建立联系：

$$ Pr_t = \frac{\nu_t}{\alpha_t} $$

在对数律层中，一个经典的湍流模型是基于混合长理论的涡粘模型，即$\nu_t = \kappa u_\tau y$，其中$\kappa$是[冯·卡门常数](@entry_id:261117)（$\kappa \approx 0.41$）。将这些关系代入[热通量](@entry_id:138471)方程，并假设$Pr_t$在对数律层中为常数，经过与[粘性底层](@entry_id:269337)类似的[无量纲化](@entry_id:136704)推导，可得：

$$ \frac{dT^+}{dy^+} = \frac{Pr_t}{\kappa y^+} $$

对上式积分，便得到温度的对数律[分布](@entry_id:182848) [@problem_id:2537369] [@problem_id:2537382]：

$$ T^+(y^+) = \frac{Pr_t}{\kappa} \ln(y^+) + B_t $$

其中$B_t$是一个积分常数，其值依赖于分子普朗特数$Pr$以及[缓冲层](@entry_id:160164)的具体过渡行为。

### 热壁函数：定义、目的与核心假设

#### 定义与目的

在CFD模拟中，若要精确求解[粘性底层](@entry_id:269337)和[缓冲层](@entry_id:160164)内的陡峭梯度，需要在近壁区布置极其密集的网格，这对于[高雷诺数流](@entry_id:199822)动而言计算成本极高。**热壁函数**正是一种为了规避这一难题而发展的近壁模化方法。

其核心定义是：一套基于近壁区温度[分布](@entry_id:182848)的普适或半经验规律（如前述的对数律），用于在[计算网格](@entry_id:168560)未能解析[粘性底层](@entry_id:269337)和[缓冲层](@entry_id:160164)的情况下，直接建立壁面热边界条件（如$q_w$或$T_w$）与第一个离壁网格节点上的平均温度$T_P$之间的代数关系 [@problem_id:2537365]。

其主要目的在于，当第一个网格节点$P$被放置在对数律层中（例如，$y_P^+$位于$30$到$200$之间）时，壁函数为能量方程提供了一个物理上合理的边界条件，从而“跨越”了未被解析的[粘性底层](@entry_id:269337)和[缓冲层](@entry_id:160164)，避免了对这些区域进行直接的数值求解。

#### [局部平衡假设](@entry_id:182180)

对数律的成立，以及壁函数方法的有效性，都依赖于一个关键的物理假设——**[局部平衡假设](@entry_id:182180) (Local Equilibrium Hypothesis)** [@problem_id:2537365]。该假设在惯性子层中成立，其内容是：

*   对于动量场，湍动能的生成率$\mathcal{P}_k$与其耗散率$\epsilon$在局部近似相等，即$\mathcal{P}_k \approx \epsilon$。这意味着[湍流](@entry_id:151300)能量的输运（由[对流](@entry_id:141806)和[扩散](@entry_id:141445)引起）相比于局部的产生和消耗可以忽略不计。
*   对于[标量场](@entry_id:151443)（如温度），这意味着[湍流热通量](@entry_id:151024)主要响应于局部的平均[温度梯度](@entry_id:136845)。这个假设使得采用一个近似恒定的[湍流普朗特数](@entry_id:153739)$Pr_t$来关联动量和热量输运成为可能。

[局部平衡假设](@entry_id:182180)是内层[相似律](@entry_id:189450)得以成立的基石，它意味着[湍流](@entry_id:151300)能够快速适应局部条件，其“记忆”和[非局部效应](@entry_id:198046)较弱。

#### 模型局限性与牺牲的物理过程

壁函数方法在大幅降低计算成本的同时，也必然以牺牲对近壁区复杂物理过程的精确描述为代价。采用壁函数意味着模型放弃了捕捉以下关键的近壁物理现象 [@problem_id:2537397]：

*   **陡峭的平均量梯度**：壁面附近的平均速度和平均[温度梯度](@entry_id:136845)极大，壁函数用一个代数关系替代了对这些梯度的直接计算。
*   **[近壁湍流](@entry_id:194167)的各向异性**：由于壁面的存在（“拍扁效应”），法向速度脉动受到强烈抑制，[近壁湍流](@entry_id:194167)呈现高度各向异性。标准的[RANS模型](@entry_id:754068)（尤其是基于涡粘假设的模型）本身难以描述这种各向异性，而壁函数方法则完全绕过了这个区域。
*   **[湍流生成](@entry_id:189980)与耗散的剖面**：[局部平衡假设](@entry_id:182180)在[缓冲层](@entry_id:160164)中并不成立。实际上，[湍动能](@entry_id:262712)的生成在[缓冲层](@entry_id:160164)（约$y^+ \approx 15$）达到峰值，并显著高于耗散。壁函数方法将第一个计算节点置于该峰值之外，因此完全无法捕捉到这一[湍流](@entry_id:151300)最为活跃的区域的真实物理。
*   **[相干结构](@entry_id:182915)**：近壁区充满了动态的、有组织的[湍流](@entry_id:151300)结构，如高速条带和低速条带、准流向涡，以及间歇性的“猝发”事件（如“上抛”和“下扫”）。这些结构是[湍流生成](@entry_id:189980)的主要机制。同样，温度场也表现出类似的间歇性“热流猝发”。RANS方法本身就是对这些脉动的统计平均，而壁函数法则更进一步，用一个简单的平衡对数律模型替代了对这些复杂[非平衡动力学](@entry_id:160262)过程的任何描述。

此外，标准热壁函数依赖于[雷诺类比](@entry_id:153007)思想和近似恒定的[湍流普朗特数](@entry_id:153739)，这在某些条件下会引入偏差，尤其是在分子普朗特数远离1的流体中 [@problem_id:2537397]。

### 热壁函数的高级课题

标准热壁函数建立在理想化的假设之上。在更复杂的物理情境下，需要对模型进行修正或认识其适用范围的边界。

#### [普朗特数](@entry_id:143303)的影响

分子普朗特数$Pr$对[热边界层](@entry_id:147903)的结构有至关重要的影响，而标准壁函数对此的描述能力有限。

我们推导出的无量纲[温度梯度](@entry_id:136845)方程清晰地揭示了这一点：
$$ \frac{dT^{+}}{dy^{+}} = \frac{1}{1/Pr + (\nu_t/\nu)/Pr_t} $$
该方程表明，温度剖面的局部斜率取决于分子传导（$1/Pr$项）和[湍流输运](@entry_id:150198)（$(\nu_t/\nu)/Pr_t$项）的相对大小 [@problem_id:2537388]。

*   **当$Pr \approx 1$时 (如空气)**：动量和热量的分子扩散能力相当。动量[边界层](@entry_id:139416)和[热边界层](@entry_id:147903)的厚度接近，[雷诺类比](@entry_id:153007)思想近似成立。在这种情况下，采用一个常数$Pr_t$（如$0.85$）的热壁函数模型，可以得到工程上可接受的壁面传热预测精度 [@problem_id:2537386]。

*   **当$Pr \gg 1$时 (如水、油等)**：分子[热扩散](@entry_id:148740)能力远弱于[动量扩散](@entry_id:157895)能力。这导致热边界层（特别是其传导主导的底层）比动量[粘性底层](@entry_id:269337)要薄得多。温度梯度主要集中在一个非常薄的层内。标准壁函数假设动量和热量的过渡行为相似，无法准确描述这个被压缩在[粘性底层](@entry_id:269337)深处的极陡峭[温度梯度](@entry_id:136845)，通常会高估[传热系数](@entry_id:155200)。为了获得准确结果，需要使用考虑了$Pr$变化的变$Pr_t(y^+, Pr)$模型 [@problem_id:2537386] [@problem_id:2537388]。

*   **当$Pr \ll 1$时 (如液态金属)**：分子热扩散能力远强于[动量扩散](@entry_id:157895)能力。[热边界层](@entry_id:147903)比动量[边界层](@entry_id:139416)厚得多。分子热传导的影响会延伸到离壁面很远的地方，甚至在速度场的[对数律区](@entry_id:264342)内仍然不可忽略。此时，恒定$Pr_t$的假设以及简单的对数律形式都会失效 [@problem_id:2537386] [@problem_id:2537388]。

这种由$Pr \neq 1$引起的[模型偏差](@entry_id:184783)，不仅影响平均温度的预测，还会传递到对温度脉动强度的预测中。在RANS框架下，温度[方差](@entry_id:200758)$\overline{T'^2}$的生成项正比于$(\partial \bar{T}/\partial y)^2$。壁函数施加了一个（可能不准确的）平均[温度梯度](@entry_id:136845)，从而直接决定了近壁区温度脉动的生成率。因此，一个有偏差的壁函数将导致对温度脉动强度的系统性预测错误 [@problem_id:2537358]。

#### 粗糙壁面的影响

当壁面不再光滑时，粗糙元会显著改变近壁区的流动和传热。这种效应通过引入**[粗糙度函数](@entry_id:276871) (Roughness Functions)**$\Delta U^+$和$\Delta T^+$来模化，它们表示相对于光滑壁面对数律的向下偏移 [@problem_id:2537374]：

$$ U^+(y^+) = \frac{1}{\kappa} \ln(y^+) + B_m - \Delta U^+(k_s^+) $$
$$ T^+(y^+) = \frac{Pr_t}{\kappa} \ln(y^+) + B_h - \Delta T^+(k_s^+, Pr) $$

这里的$k_s^+$是[无量纲化](@entry_id:136704)的[等效砂粒粗糙度](@entry_id:268742)高度。

*   **向下偏移的物理原因**：粗糙元增加了壁面的动量阻力（形态阻力）和[传热效率](@entry_id:153787)。在相同的[摩擦速度](@entry_id:267882)$u_\tau$下，粗糙壁面上的[流体速度](@entry_id:267320)$U$更低，因此$U^+$更小。在相同的壁面[热通量](@entry_id:138471)$q_w$下，[传热增强](@entry_id:150810)意味着壁面与流体的温差$(T_w-T)$更小，因此$T^+$也更小。所以，[粗糙度函数](@entry_id:276871)$\Delta U^+$和$\Delta T^+$均为正值，表示对数律曲线的向下平移 [@problem_id:2537374]。
*   **[雷诺类比](@entry_id:153007)的失效**：动量传递受形态阻力影响，而热量传递则不然。此外，$Pr$数值决定了传导底层与粗糙元的相对尺度。因此，动量和热量的[粗糙度函数](@entry_id:276871)通常不相等，即$\Delta T^+ \neq \Delta U^+$，且$\Delta T^+$强烈依赖于$Pr$。
*   **渐近行为**：在水力光滑极限下 ($k_s^+ \to 0$)，[粗糙度函数](@entry_id:276871)趋于零。在完全粗糙极限下 ($k_s^+ \to \infty$)，流动和传热不再依赖于分子粘性$\nu$和[热导率](@entry_id:147276)$k$，而仅依赖于粗糙度尺度$k_s$。此时，[粗糙度函数](@entry_id:276871)表现出对数增长的形式，例如$\Delta U^+(k_s^+) \sim \frac{1}{\kappa} \ln(k_s^+) + C$ [@problem_id:2537374]。

#### 壁函数的失效模式与应用条件

为了可靠地使用壁函数，必须了解其失效的边界并遵守其应用准则。

**[流动分离](@entry_id:143331)**

标准壁函数最典型的失效场景之一是靠近[流动分离](@entry_id:143331)点。分离点附近，壁面剪切应力趋于零，即$\tau_w \to 0$。这会导致灾难性的模型崩溃 [@problem_id:2537390]：

1.  **[标度律](@entry_id:139947)失效**：[摩擦速度](@entry_id:267882)$u_\tau = \sqrt{\tau_w/\rho} \to 0$。这使得所有基于$u_\tau$的内层标度变量失去意义。无量纲壁面距离$y_P^+ = y_P u_\tau/\nu \to 0$，使得第一个网格节点从对数律层“掉入”了[粘性底层](@entry_id:269337)，违背了壁函数的基本假设。
2.  **[温度标度](@entry_id:636417)奇异**：如果壁面[热通量](@entry_id:138471)$q_w$保持有限，摩擦温度$T_\tau = q_w/(\rho c_p u_\tau) \to \infty$。这使得无量纲温度$T^+$的定义变得奇异，壁函数无法提供有意义的温度边界条件。
3.  **物理假设破坏**：[分离流](@entry_id:754694)动的强逆压梯度和回流破坏了近壁区的[局部平衡假设](@entry_id:182180)，对数律本身已不再成立。

因此，一个稳健的CFD实践是：**当$\tau_w$接近或小于零，或者当计算出的$y_P^+$值落入规定范围（如$30 \le y_P^+ \le 200$）之外时，必须停用壁函数，转而采用能够解析[粘性底层](@entry_id:269337)的低雷诺数模型** [@problem_id:2537390]。

**一般应用准则**

综合以上讨论，标准热壁函数的有效应用需满足以下一系列条件 [@problem_id:2537399]：

1.  **网格布置**：第一个离壁网格节点的中心$y_P$必须位于对数律层内。一个普遍接受的范围是$30 \lesssim y_P^+ \lesssim 200$。$y_P^+$太小会进入[缓冲层](@entry_id:160164)，太大则会进入尾迹区，这两个区域对数律均不适用。
2.  **流动状态**：流动必须是充分发展的高[雷诺数](@entry_id:136372)[湍流](@entry_id:151300)。只有当[摩擦雷诺数](@entry_id:749598)$Re_\tau = u_\tau \delta / \nu$足够大时（例如$Re_\tau \gtrsim 200$），一个清晰的[对数律区](@entry_id:264342)才会形成。
3.  **流体物性**：标准热壁函数对分子普朗特数敏感，其有效性通常局限于$Pr$数值适中的流体，一个经验范围大约是$0.5 \le Pr \le 5$。对于此范围之外的流体，需要采用经过特殊校正的或基于变$Pr_t$的壁函数。
4.  **流动类型**：流动应为附体流，且压力梯度较弱，以保证[局部平衡假设](@entry_id:182180)和近壁恒定总应力/[热通量](@entry_id:138471)假设的近似成立。

遵循这些准则，是确保基于壁函数的[湍流传热](@entry_id:189092)模拟获得可靠结果的关键。