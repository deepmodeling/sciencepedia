{"hands_on_practices": [{"introduction": "在着手解决任何逆问题之前，我们必须首先确保其正演模型是可靠的。本练习探讨了热方程一种常用显式格式的数值稳定性，并要求您推导其稳定性判据。这项实践旨在强调，数值求解器中的选择会如何影响解的质量，并最终决定整个逆分析的可行性，因为逆问题的成功始于一个稳健的正向模拟。[@problem_id:2497720]", "problem": "一个一维（$1$D）半无限大固体占据 $x \\ge 0$ 的空间，并遵循热方程 $\\partial T/\\partial t = \\alpha\\,\\partial^{2}T/\\partial x^{2}$，其中热扩散系数 $\\alpha$ 为常数。在一个逆热传导问题（IHCP）中，需要通过重复求解正向模型并使用基于梯度的优化方法，根据固定位置 $x=x_{m}$ 的内部温度测量值来估计 $x=0$ 处未知的表面热通量 $q(t)$。正向模型在均匀空间网格 $x_{i}=i\\,\\Delta x$ 上进行离散化，并使用前向欧拉法在时间上推进，其中空间导数采用二阶中心差分近似。\n\n仅从热方程、所述的离散化方法以及线性常系数格式的傅里叶放大因子的定义出发，执行以下操作：\n\n- 通过 von Neumann 分析法，推导显式格式的充分必要稳定性条件，并将其表示为关于无量纲时间步长参数 $r=\\alpha\\,\\Delta t/\\Delta x^{2}$ 的不等式形式。据此，确定常数 $C$ 的最大允许值，使得 $\\Delta t_{\\max}=C\\,\\Delta x^{2}/\\alpha$。\n\n- 使用您的结果，计算在 $\\Delta x=8.0\\times 10^{-4}\\,\\text{m}$ 和 $\\alpha=8.5\\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$ 的条件下，最大稳定时间步长。将最终数值答案以秒为单位表示，并四舍五入到 $4$ 位有效数字。\n\n- 根据您推导出的放大因子，解释当对 $q(t)$ 采用标准的二次数据失配和 Tikhonov 正则化时，选择接近稳定性极限的 $\\Delta t$ 如何影响 (i) 正向解中空间温度梯度的准确性，以及 (ii) IHCP 反演中使用的梯度的稳定性和条件数。您的解释必须基于格式的光谱特性，并且不得假设任何无法从您的放大因子推导出的结果。\n\n最终答案仅提供按要求以秒为单位、四舍五入到 $4$ 位有效数字的最大稳定时间步长的数值。所有中间推导和讨论都应在您的解题过程中呈现。", "solution": "该问题需要一个包含三部分的回答：首先，推导一维热方程的前向时间、中心空间（FTCS）离散格式的稳定性条件；其次，计算给定参数下的最大稳定时间步长；第三，解释在逆热传导问题（IHCP）的背景下，在稳定性极限附近操作的后果。整个分析必须是自洽的，从控制偏微分方程开始。\n\n一维热方程为：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是常数热扩散系数。\n\n我们在一个均匀网格上离散化该方程，其中 $T(x_i, t_n) \\equiv T_i^n$，且 $x_i = i \\Delta x$，$t_n = n \\Delta t$。对时间导数使用前向欧拉格式，对空间导数使用二阶中心差分格式，我们得到 FTCS 格式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n为求出下一个时间步的温度 $T_i^{n+1}$，整理上式可得：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \\right)\n$$\n我们定义无量纲时间步长参数，或称傅里叶数，为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。方程于是简化为：\n$$\nT_i^{n+1} = T_i^n + r \\left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \\right)\n$$\n\n为了进行 von Neumann 稳定性分析，我们考虑温度场中单个傅里叶模式的演化。我们将时间步 $n$ 的温度表示为这些模式的叠加。一个典型的模式具有以下形式：\n$$\nT_i^n = A^n(k) \\exp(I k x_i)\n$$\n其中 $A^n(k)$ 是波数为 $k$ 的模式在时间步 $n$ 的振幅，$I$ 是虚数单位 ($I^2 = -1$)。为使格式稳定，任何模式的振幅都不能随时间增长，这意味着放大因子 $G(k) = A^{n+1}(k) / A^n(k)$ 的模必须对所有可能的波数 $k$ 满足 $|G(k)| \\le 1$。\n\n将傅里叶模式代入离散方程：\n$$\nA^{n+1} \\exp(I k i \\Delta x) = A^n \\exp(I k i \\Delta x) + r \\left( A^n \\exp(I k (i+1) \\Delta x) - 2A^n \\exp(I k i \\Delta x) + A^n \\exp(I k (i-1) \\Delta x) \\right)\n$$\n两边同除以非零项 $A^n \\exp(I k i \\Delta x)$，我们得到放大因子 $G(k)$ 的表达式：\n$$\nG(k) = \\frac{A^{n+1}}{A^n} = 1 + r \\left( \\exp(I k \\Delta x) - 2 + \\exp(-I k \\Delta x) \\right)\n$$\n使用欧拉恒等式 $\\exp(I\\theta) + \\exp(-I\\theta) = 2\\cos(\\theta)$，我们可以简化括号中的项：\n$$\nG(k) = 1 + r \\left( 2\\cos(k \\Delta x) - 2 \\right) = 1 - 2r \\left( 1 - \\cos(k \\Delta x) \\right)\n$$\n应用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$：\n$$\nG(k) = 1 - 4r \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n稳定性条件是 $|G(k)| \\le 1$。由于 $r > 0$ 且 $\\sin^2(\\cdot) \\ge 0$，所以项 $4r \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$ 是非负的。这意味着 $G(k)$ 始终为实数且 $G(k) \\le 1$。因此，稳定性条件简化为单个不等式：\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4r \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4r \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\nr \\le \\frac{2}{4 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)} = \\frac{1}{2 \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)}\n$$\n这个不等式必须对所有可能的波数 $k$ 成立。最严格或“最坏情况”的条件发生在分母达到其最小值时，这对应于 $\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$ 的最大值。$\\sin^2(\\cdot)$ 的最大值为 $1$。这发生在网格可以解析的最高频率模式下，即 $k \\Delta x = \\pi$。\n将此最大值代入不等式，得到充分必要稳定性条件：\n$$\nr \\le \\frac{1}{2}\n$$\n根据定义 $r=\\alpha\\,\\Delta t/\\Delta x^{2}$，这意味着：\n$$\n\\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2} \\implies \\Delta t \\le \\frac{1}{2} \\frac{(\\Delta x)^2}{\\alpha}\n$$\n由此可知，最大允许时间步长为 $\\Delta t_{\\max} = \\frac{1}{2} \\frac{(\\Delta x)^2}{\\alpha}$。将其与形式 $\\Delta t_{\\max}=C\\,\\Delta x^{2}/\\alpha$ 进行比较，我们发现常数的最大允许值为 $C = 1/2$。\n\n接下来，我们计算给定值的最大稳定时间步长：$\\Delta x = 8.0 \\times 10^{-4}\\,\\text{m}$ 和 $\\alpha = 8.5 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n$$\n\\Delta t_{\\max} = \\frac{1}{2} \\frac{(\\Delta x)^2}{\\alpha} = \\frac{1}{2} \\frac{(8.0 \\times 10^{-4}\\,\\text{m})^2}{8.5 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{2} \\frac{64.0 \\times 10^{-8}}{8.5 \\times 10^{-6}} \\,\\text{s} = \\frac{32.0 \\times 10^{-8}}{8.5 \\times 10^{-6}} \\,\\text{s} = \\frac{32.0}{8.5} \\times 10^{-2} \\,\\text{s}\n$$\n$$\n\\Delta t_{\\max} \\approx 3.764705... \\times 10^{-2} \\,\\text{s}\n$$\n四舍五入到 $4$ 位有效数字，我们得到 $\\Delta t_{\\max} = 0.03765\\,\\text{s}$。\n\n最后，我们基于推导出的放大因子 $G(k) = 1 - 4r \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)$，解释选择接近此稳定性极限的 $\\Delta t$ 所带来的后果。\n\n(i) 对正向解中空间温度梯度准确性的影响：\n当 $r$ 接近其极限 $1/2$ 时，最高频率模式（$k \\Delta x = \\pi$）的放大因子接近 $G(\\pi/\\Delta x) = 1 - 4(\\frac{1}{2}) \\sin^2(\\frac{\\pi}{2}) = 1 - 2 = -1$。放大因子为 $-1$ 意味着该模式的振幅不会衰减；相反，它会保持不变，但其符号在每个时间步都会翻转。这对应于一种非物理的高频“棋盘”振荡（例如，在相邻网格点上正负扰动交替出现的空间分布，且整个模式在每个时间步都翻转符号）。热方程的真实物理是扩散性的，这意味着高频分量应迅速衰减。当 $r \\approx 1/2$ 时，数值格式未能抑制这些模式，会引入显著误差，表现为空间振荡。使用有限差分（如 $\\frac{\\partial T}{\\partial x}|_i \\approx \\frac{T_{i+1} - T_{i-1}}{2\\Delta x}$）计算的空间梯度对此类高频内容极为敏感。这些数值振荡的存在会完全破坏计算出的梯度，使其被伪影噪声主导，而不是真实的物理梯度。因此，在稳定性极限附近操作会严重降低空间梯度的准确性。\n\n(ii) 对 IHCP 反演中使用的梯度的稳定性和条件数的影响：\nIHCP 本质上是病态的，因为从内部数据中找出边界条件 $q(t)$ 需要放大数据中被扩散过程自然且强烈衰减的高频信息。逆转这种衰减的过程对噪声高度敏感。\n如上所述，当用 $r \\approx 1/2$ 求解正向模型时，它会将自身的高频数值噪声引入计算出的温度场 $T(x_m, t)$ 中。用于 IHCP 的基于梯度的优化算法使用计算出的温度与测量温度之间的失配来更新 $q(t)$ 的估计值。梯度计算（通常通过伴随方法完成）会将正向解中的数值噪声解释为必须由边界通量 $q(t)$ 解释的真实信号。这迫使优化算法在 $q(t)$ 的估计中引入虚假的高频振荡，以试图匹配数值噪声。逆问题的条件数本已很差，正向求解器的数值不稳定性使其急剧恶化。虽然 Tikhonov 正则化旨在通过惩罚 $q(t)$ 的范数或半范数来抑制此类振荡解，但在稳定性边缘运行的正向求解器会产生如此强烈的数值伪影，以至于正则化可能不足，或者可能需要一个不切实际的大正则化参数，而这反过来又会过度平滑估计的通量并破坏任何有用的细节。总之，在 $r \\approx 1/2$ 时数值格式的光谱缺陷直接污染了数据失配梯度，导致不稳定和病态的反演过程。", "answer": "$$\n\\boxed{0.03765}\n$$", "id": "2497720"}, {"introduction": "逆热传导问题是典型的“不适定”(ill-posed)问题，这意味着测量中的微小误差可能导致解出现巨大的、无意义的振荡。本练习使用奇异值分解(SVD)这一强有力的工具来深入理解这种不稳定性。通过分析热方程如何衰减高频信号，您将看到这种物理行为如何被编码到系统矩阵的奇异值和奇异向量中，以及截断奇异值分解(TSVD)如何像一个低通滤波器一样，帮助我们恢复一个稳定且有物理意义的解。[@problem_id:2497780]", "problem": "当一个均匀半无限大固体 $x \\ge 0$ 边界 $x=0$ 上的未知瞬态表面热流 $q(t)$ 必须从内部温度测量值推断时，就会出现逆热传导问题 (IHCP)。考虑一维热传导方程 $\\partial T/\\partial t = \\alpha \\, \\partial^{2} T/\\partial x^{2}$，其中热扩散率 $\\alpha>0$，初始条件为零，控制边界条件为 $-k \\, \\partial T/\\partial x(0,t) = q(t)$，其中 $k>0$ 为热导率。在固定的内部位置 $x=x_{m}>0$ 处，对时间 $t \\in (0,T]$ 进行温度测量。在适当的时间基上对 $q(t)$ 进行离散化并对测得的温度进行采样后，从 $q$ 的系数到数据 $y \\in \\mathbb{R}^{m}$ 的正向映射是一个线性系统 $A q = y + \\varepsilon$，其中 $A \\in \\mathbb{R}^{m \\times n}$，$\\varepsilon$ 代表测量噪声。\n\n从热传导方程及其在半无限大域中的拉普拉斯变换解出发，论证 $q(t)$ 中的时间振荡如何传递到 $T(x_{m},t)$，以及这种传递如何依赖于频率。然后，在此背景下解释 $A$ 的奇异值分解 (SVD)，并说明哪些陈述正确地描述了截断指数为 $k$ 的截断奇异值分解 (TSVD) 相对于SVD展开的滤波特性。\n\n选择所有正确的陈述：\n\nA. 在SVD $A = U \\Sigma V^{\\top}$ 中，奇异值为 $\\sigma_{1} \\ge \\cdots \\ge \\sigma_{r} > 0$，右奇异向量为 $v_{i}$，则截断指数为 $k$ 时的TSVD解为 $\\widehat{q}_{k} = \\sum_{i=1}^{k} (u_{i}^{\\top} y/\\sigma_{i}) \\, v_{i}$。因为热传导方程会衰减高时间频率，所以随着 $i$ 的增加，右奇异向量 $v_{i}$ 趋于变得更具振荡性，因此在 $k$ 处截断会滤除 $q$ 的高频分量。\n\nB. TSVD 保留 $k$ 个最小的奇异值以避免过度平滑，从而强调高频内容，这是可取的，因为在IHCP中测量噪声主要是低频的。\n\nC. 对于由热传导方程产生的扩散型正算子，小的奇异值与愈加振荡的右奇异向量相关联。在 $k$ 处截断SVD展开会对 $q$ 施加一个有效的低通滤波器，其截止点由 $k$ 决定。\n\nD. 在谱展开中，TSVD的滤波因子为 $f_{i} = \\sigma_{i}/(\\sigma_{i}^{2}+\\lambda)$（对于某个 $\\lambda>0$），因此在 $k$ 处截断等效于在吉洪诺夫正则化中选择一个合适的 $\\lambda$。", "solution": "问题陈述需经过验证。\n\n### 步骤1：提取已知条件\n- **控制物理**：一维热传导方程 $\\partial T/\\partial t = \\alpha \\, \\partial^{2} T/\\partial x^{2}$，适用于均匀半无限大固体 $x \\ge 0$。\n- **常数**：热扩散率 $\\alpha > 0$，热导率 $k > 0$。\n- **初始条件**：对于所有 $x \\ge 0$，$T(x,0) = 0$。\n- **边界条件**：在 $x=0$ 处施加一个瞬态热流 $q(t)$，由 $-k \\, \\partial T/\\partial x(0,t) = q(t)$ 给出。这个 $q(t)$ 是待求的未知量。\n- **测量**：在内部点 $x = x_{m} > 0$ 处，对时间 $t \\in (0,T]$ 收集温度数据。\n- **离散化模型**：将热流 $q$ 的离散表示映射到温度测量向量 $y \\in \\mathbb{R}^{m}$ 的正问题是一个线性系统 $A q = y + \\varepsilon$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是正向算子（灵敏度矩阵），$\\varepsilon$ 是测量噪声。\n- **任务**：使用拉普拉斯变换解分析时间振荡从 $q(t)$ 到 $T(x_{m}, t)$ 的传递过程，在此物理背景下解释 $A$ 的奇异值分解 (SVD)，并评估关于截断奇异值分解 (TSVD) 的陈述。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述在科学上和数学上是合理的。\n1.  **科学依据**：该问题是逆热传导问题 (IHCP) 的一个典型示例，这是热传递和应用数学中一个成熟的研究课题。控制偏微分方程、边界条件和逆问题的提法都是标准的。\n2.  **问题的适定性**：问题是适定的。它要求对IHCP的物理和数值特性及其通过TSVD的正则化进行概念性分析，这些都可以从所提供的信息中推导出来。底层的物理逆问题已知是不适定的，这正是问题的核心所在。\n3.  **客观性与清晰度**：语言精确、技术性强，没有歧义或主观论断。所有术语在该领域都是标准的。\n4.  **一致性与完整性**：所提供的信息是自洽且足以进行所要求的分析的。没有矛盾之处。\n\n### 步骤3：结论与行动\n问题是**有效的**。将推导解答。\n\n### 推导与分析\n\n分析从连续问题开始，以理解正向算子的物理原理。一维热传导方程为 $\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}$。我们对时间 $t$ 应用拉普拉斯变换，$s$ 为变换变量。令 $\\bar{T}(x,s) = \\mathcal{L}\\{T(x,t)\\}$。给定零初始条件 $T(x,0)=0$，变换后的偏微分方程变为关于 $x$ 的常微分方程：\n$$ s\\bar{T}(x,s) = \\alpha \\frac{d^2 \\bar{T}}{dx^2} \\implies \\frac{d^2 \\bar{T}}{dx^2} - \\frac{s}{\\alpha}\\bar{T} = 0 $$\n其通解为 $\\bar{T}(x,s) = C_1 e^{\\sqrt{s/\\alpha}x} + C_2 e^{-\\sqrt{s/\\alpha}x}$。为使温度在 $x \\to \\infty$ 时保持有界，我们必须设 $C_1 = 0$，假设 $\\text{Re}(\\sqrt{s}) > 0$。因此，$\\bar{T}(x,s) = C_2 e^{-\\sqrt{s/\\alpha}x}$。\n\n常数 $C_2$ 由 $x=0$ 处的边界条件确定。变换后的边界条件为 $-k \\frac{d\\bar{T}}{dx}(0,s) = \\bar{q}(s)$，其中 $\\bar{q}(s) = \\mathcal{L}\\{q(t)\\}$。对 $\\bar{T}(x,s)$ 求导得到 $\\frac{d\\bar{T}}{dx} = -C_2 \\sqrt{s/\\alpha} e^{-\\sqrt{s/\\alpha}x}$。在 $x=0$ 处，这给出 $-k(-C_2\\sqrt{s/\\alpha}) = \\bar{q}(s)$，从而确定 $C_2 = \\frac{\\bar{q}(s)}{k\\sqrt{s/\\alpha}}$。\n\n拉普拉斯域中的完整解为：\n$$ \\bar{T}(x,s) = \\bar{q}(s) \\frac{e^{-\\sqrt{s/\\alpha}x}}{k\\sqrt{s/\\alpha}} $$\n该方程描述了从输入热流 $\\bar{q}(s)$ 到温度响应 $\\bar{T}(x,s)$ 的传递函数。为了理解频率依赖性，我们通过设置 $s = i\\omega$ 来考虑正弦输入，其中 $\\omega$ 是角频率。使用恒等式 $\\sqrt{i} = (1+i)/\\sqrt{2}$，我们有 $\\sqrt{i\\omega/\\alpha} = \\sqrt{\\omega/(2\\alpha)}(1+i)$。在位置 $x$ 处的响应则为：\n$$ \\bar{T}(x, i\\omega) = \\bar{q}(i\\omega) \\frac{e^{-\\sqrt{\\omega/(2\\alpha)}x \\cdot (1+i)}}{k\\sqrt{i\\omega/\\alpha}} = \\bar{q}(i\\omega) \\frac{e^{-\\sqrt{\\omega/(2\\alpha)}x} e^{-i\\sqrt{\\omega/(2\\alpha)}x}}{k\\sqrt{i\\omega/\\alpha}} $$\n在深度 $x$ 处，传递函数的幅值表现为 $|\\bar{T}(x,i\\omega)/\\bar{q}(i\\omega)| \\propto e^{-\\sqrt{\\omega/(2\\alpha)}x}$。这表明温度振荡的振幅随深度 $x$ 和频率 $\\omega$ 的平方根呈指数衰减。热流 $q(t)$ 的高频分量被严重衰减，在内部传感器位置 $x_m$ 处几乎记录不到。\n\n这种物理洞察直接揭示了离散化正向算子 $A$ 的结构。矩阵 $A$ 模拟了这种强阻尼（低通滤波）行为。我们考虑其奇异值分解 (SVD)，$A = U \\Sigma V^{\\top} = \\sum_{i=1}^r \\sigma_i u_i v_i^\\top$，其中 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_r > 0$ 是奇异值。\n- 右奇异向量 $v_i$ 构成了输入空间（离散化热流 $q$）的一组标准正交基。\n- 左奇异向量 $u_i$ 构成了输出空间（测量的温度 $y$）的一组标准正交基。\n- 奇异值 $\\sigma_i$ 是输入模式 $v_i$ 的放大因子。\n由于物理系统（热传导）会强烈衰减高频输入，一个高度振荡的输入热流 $q$ 将产生一个非常小的温度响应 $y$。在SVD框架中，这意味着代表愈加振荡（高频）的热流模式的右奇异向量 $v_i$ 必须与快速减小的奇异值 $\\sigma_i$ 相关联。因此，随着指数 $i$ 的增加，$\\sigma_i$ 减小，而 $v_i$ 趋于变得更具振荡性。\n\n逆问题是从 $y = Aq + \\varepsilon$ 中求解 $q$。形式解是 $q = A^{-1}(y-\\varepsilon)$。小奇异值的存在使得 $A$ 近乎奇异，其求逆过程不稳定。噪声 $\\varepsilon$ 被因子 $1/\\sigma_i$ 放大。解被与小 $\\sigma_i$ 对应的向量 $v_i$ 所引起的虚假高频振荡所主导。这就是不适定性的本质。\n\n截断奇异值分解 (TSVD) 是解决此问题的一种正则化方法。截断指数为 $k$ 的TSVD解是通过只包含逆的SVD展开的前 $k$ 项来构成的：\n$$ \\widehat{q}_{k} = \\sum_{i=1}^{k} \\frac{1}{\\sigma_i} (u_i^{\\top} y) v_i = \\sum_{i=1}^{k} \\frac{u_i^{\\top} y}{\\sigma_i} v_i $$\n通过截断求和，我们明确地丢弃了当 $i > k$ 时来自奇异三元组 $(u_i, \\sigma_i, v_i)$ 的贡献。这些恰好是与小奇异值和高度振荡的向量 $v_i$ 相关联的项，它们受噪声放大的影响最严重。因此，TSVD 起到低通滤波器的作用，保留解的“更平滑”分量，并抑制高频分量。\n\n### 选项评估\n\n**A. 在SVD $A = U \\Sigma V^{\\top}$ 中，奇异值为 $\\sigma_{1} \\ge \\cdots \\ge \\sigma_{r} > 0$，右奇异向量为 $v_{i}$，则截断指数为 $k$ 时的TSVD解为 $\\widehat{q}_{k} = \\sum_{i=1}^{k} (u_{i}^{\\top} y/\\sigma_{i}) \\, v_{i}$。因为热传导方程会衰减高时间频率，所以随着 $i$ 的增加，右奇异向量 $v_{i}$ 趋于变得更具振荡性，因此在 $k$ 处截断会滤除 $q$ 的高频分量。**\n- TSVD解 $\\widehat{q}_k$ 的公式是正确的。\n- 热传导对高频的阻尼导致与小奇异值（大 $i$）相关的右奇异向量 $v_i$ 具有振荡性的推理是正确的。\n- 在 $k$ 处截断求和会丢弃这些高频分量的结论是正确的。这是TSVD正则化解的机理。\n结论：**正确**。\n\n**B. TSVD 保留 $k$ 个最小的奇异值以避免过度平滑，从而强调高频内容，这是可取的，因为在IHCP中测量噪声主要是低频的。**\n- “TSVD 保留 $k$ 个最小的奇异值”：这是错误的。TSVD 保留 $k$ 个*最大*的奇异值，因为它们携带了关于解的最重要信息。\n- “强调高频内容”：这是错误的。TSVD是一种*抑制*高频内容以稳定解的正则化方法。\n- “测量噪声...主要是低频的”：通常不作此假设。传感器噪声通常被建模为宽带的白噪声。即使这是真的，陈述的其余部分也根本上是错误的。\n结论：**错误**。\n\n**C. 对于由热传导方程产生的扩散型正算子，小的奇异值与愈加振荡的右奇异向量相关联。在 $k$ 处截断SVD展开会对 $q$ 施加一个有效的低通滤波器，其截止点由 $k$ 决定。**\n- “小的奇异值与愈加振荡的右奇异向量相关联”：如推导中所述，这是SVD对于扩散（平滑）算子的一个正确且基本的性质。\n- “在 $k$ 处截断SVD展开会对 $q$ 施加一个有效的低通滤波器”：这是对TSVD机理的正确解释。\n- “其截止点由 $k$ 决定”：这是正确的。截断参数 $k$ 的选择决定了保留（低频）和丢弃（高频）分量之间的界限。\n结论：**正确**。\n\n**D. 在谱展开中，TSVD的滤波因子为 $f_{i} = \\sigma_{i}/(\\sigma_{i}^{2}+\\lambda)$（对于某个 $\\lambda>0$），因此在 $k$ 处截断等效于在吉洪诺夫正则化中选择一个合适的 $\\lambda$。**\n- 为滤波因子提供的公式 $f_{i} = \\sigma_{i}/(\\sigma_{i}^{2}+\\lambda)$ 对于TSVD是不正确的。TSVD的滤波因子是一个阶跃函数：当 $i \\le k$ 时 $f_i = 1$，当 $i > k$ 时 $f_i = 0$。选项中给出的函数形式与吉洪诺夫正则化的滤波因子相关（其标准形式为 $f_i = \\frac{\\sigma_i^2}{\\sigma_i^2+\\lambda^2}$），但它不等同于TSVD的“砖墙式”滤波。该陈述混淆了这两种方法的机理。\n- “在 $k$ 处截断等效于选择一个合适的 $\\lambda$”：这也是错误的。TSVD在奇异值谱中应用一个尖锐的“砖墙”滤波器。吉洪诺夫正则化应用一个平滑的锥形滤波器。虽然它们的目的相似，并且可以找到产生相似结果的参数 $(\\lambda, k)$，但它们的滤波机理根本不同，也不等效。\n结论：**错误**。", "answer": "$$\\boxed{AC}$$", "id": "2497780"}, {"introduction": "这项综合性练习将理论付诸实践，要求您设计一个虚拟实验来辨识层状固体中未知的材料属性。您将实现一个完整的分析流程：构建一个有限容积数值模型，通过求解正问题和微扰问题来计算灵敏度，并最终使用费雪信息矩阵(Fisher Information Matrix)来评估您的实验设计能否成功地区分感兴趣的参数。这项练习突出了实验设计、数值建模和逆问题结果的统计置信度之间的紧密联系。[@problem_id:2497727]", "problem": "考虑一个总厚度为 $L=L_1+L_2$ 的一维双层平壁固体，其左侧为第 1 层，热导率为 $k_1$，密度为 $\\rho_1$，比热容为 $c_{p,1}$，厚度为 $L_1$；右侧为第 2 层，热导率为 $k_2$，密度为 $\\rho_2$，比热容为 $c_{p,2}$，厚度为 $L_2$。两层之间以有限的热接触电阻 $R_{\\mathrm{int}}$（单位为 $\\mathrm{m^2\\,K/W}$）粘合。位于 $x=0$ 的左边界承受给定的、随时间变化的表面热通量 $q''(t)$，而位于 $x=L$ 的右边界则暴露于温度为 $T_{\\infty}$、对流系数为 $h$ 的环境空气中。初始温度均匀且等于 $T_{\\infty}$。假设横截面积为单位面积。\n\n从每层中的一维瞬态热传导方程开始，\n$$ \\rho_i c_{p,i}\\,\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(k_i\\,\\frac{\\partial T}{\\partial x}\\right) \\quad \\text{for} \\quad x\\in\\text{layer } i,\\; i\\in\\{1,2\\}, $$\n其边界条件为\n$$ -k_1 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q''(t),\\quad -k_2 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = h\\left(T(L,t)-T_{\\infty}\\right), $$\n以及位于 $x=L_1$ 接触面处的界面条件为\n$$ -k_1 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L_1^-} = -k_2 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L_1^+} = q_{\\mathrm{int}}(t),\\quad T(L_1^+,t) - T(L_1^-,t) = q_{\\mathrm{int}}(t) R_{\\mathrm{int}}. $$\n\n您需要提出并评估一个逆热传导识别实验，该实验使用多个瞬态热激励 $q''(t)$，在存在标准差为 $\\sigma_T$ 的附加、独立、同分布的高斯测量噪声的情况下，从背面温度 $T(L,t)$ 的测量值中解耦未知参数矢量 $ \\boldsymbol{\\theta}=\\big[k_1,\\,k_2,\\,R_{\\mathrm{int}}\\big]^{\\top} $。$ \\boldsymbol{\\theta} $ 的可识别性将通过 Fisher 信息矩阵进行评估。\n\n您的程序必须从第一性原理出发实现以下步骤，不得使用任何黑箱逆向求解器：\n\n- 空间半离散化：通过将每层 $i$ 划分为 $N_i$ 个宽度为 $\\Delta x_i=L_i/N_i$ 的均匀控制体积，将节点置于控制体积中心，并为每个节点编写瞬态能量平衡方程，来推导一个半离散状态空间模型。对于热导率分别为 $k_j$ 和 $k_{j+1}$、宽度分别为 $\\Delta x_j$ 和 $\\Delta x_{j+1}$ 的相邻节点 $j$ 和 $j+1$，节点间热阻必须离散化为\n$ R_{j+\\frac{1}{2}} = \\frac{\\Delta x_j}{2 k_j} + \\frac{\\Delta x_{j+1}}{2 k_{j+1}} + R_{\\mathrm{int},\\,j+\\frac{1}{2}}, $\n其中 $ R_{\\mathrm{int},\\,j+\\frac{1}{2}}=R_{\\mathrm{int}} $ 仅在材料界面处成立，对于所有其他面 $ R_{\\mathrm{int},\\,j+\\frac{1}{2}}=0 $。相应的热导为 $ G_{j+\\frac{1}{2}} = 1/R_{j+\\frac{1}{2}} $。组装全局容量矩阵 $ \\mathbf{C} $（其对角线元素为 $ C_j=\\rho_j c_{p,j}\\,\\Delta x_j $）和对称热导矩阵 $ \\mathbf{K} $（其三对角结构由 $ G_{j+\\frac{1}{2}} $ 定义）。通过在节点 $j=1$ 处添加热通量 $q''(t)$ 作为源项来应用左侧诺伊曼边界条件，并通过在最后一个节点处添加一个连接到 $T_{\\infty}$ 的边界热导 $h$ 来应用右侧对流边界条件。\n\n- 时间积分：从初始条件 $ T(x,0)=T_{\\infty} $ 开始，在每个实验持续时间内使用 Crank–Nicolson 方法对半离散系统 $ \\mathbf{C}\\,\\dot{\\mathbf{T}}(t) + \\mathbf{K}\\,\\mathbf{T}(t) = \\mathbf{f}(t) $ 进行时间推进，以获得在指定时间采样的背面温度 $ y(t)=T(L,t) $。对源项 $ \\mathbf{f}(t) $ 使用梯形法则。\n\n- 灵敏度和 Fisher 信息：对于一个给定的实验设计，该设计包含一个或多个激励信号 $ q''_m(t) $ 及相应的测量时间网格，通过对 $ \\boldsymbol{\\theta} $ 的每个分量 $ \\theta_\\ell $ 独立应用相对扰动步长 $ \\epsilon_\\ell $ 的前向有限差分来近似灵敏度矢量 $ \\partial y/\\partial \\theta_\\ell $，并为每次扰动重新计算正向模型。将所有激励下的所有测量值堆叠成一个矢量 $ \\mathbf{y} $，并将相应的灵敏度矢量堆叠成雅可比矩阵 $ \\mathbf{S} $。对于方差为 $ \\sigma_T^2 $ 的独立高斯噪声，计算 Fisher 信息矩阵\n$$ \\mathbf{F} = \\frac{1}{\\sigma_T^2}\\,\\mathbf{S}^{\\top}\\mathbf{S}. $$\n\n- 可识别性决策规则：将 Cramér–Rao 下界协方差定义为 $ \\mathbf{C}_{\\mathrm{CRLB}} = \\mathbf{F}^{-1} $（如果 $ \\mathbf{F} $ 非奇异），否则定义为 $ \\mathbf{C}_{\\mathrm{CRLB}} = \\mathbf{F}^{+} $（Moore–Penrose 伪逆）。使用真实参数值 $ \\boldsymbol{\\theta}_{\\star} $，如果以下两个条件均成立，则声明对于给定设计，参数三元组 $ \\boldsymbol{\\theta} $ 是可识别的：\n    - $ \\ell_2 $ 范数下的条件数 $ \\kappa(\\mathbf{F}) $ 满足 $ \\kappa(\\mathbf{F}) \\le 10^{12} $。\n    - 边际相对标准差，定义为 $ r_\\ell = \\sqrt{[\\mathbf{C}_{\\mathrm{CRLB}}]_{\\ell\\ell}}\\,/\\,\\max(|\\theta_{\\star,\\ell}|,\\,\\theta_{\\min}) $（其中 $ \\theta_{\\min}=10^{-12} $），对于所有 $ \\ell\\in\\{1,2,3\\} $ 均满足 $ r_\\ell \\le 0.2 $。\n\n所有测试用例均使用以下常数：\n- 环境温度 $ T_{\\infty} = 293\\ \\mathrm{K} $。\n- 对流系数 $ h = 15\\ \\mathrm{W\\,m^{-2}\\,K^{-1}} $。\n- 测量噪声标准差 $ \\sigma_T = 0.02\\ \\mathrm{K} $。\n- 离散化节点 $ N_1=20 $，$ N_2=30 $。\n- 时间步长 $ \\Delta t = 0.001\\ \\mathrm{s} $。\n- 测量采样间隔 $ \\Delta t_{\\mathrm{samp}} = 0.01\\ \\mathrm{s} $。\n- 有限差分相对步长 $ \\epsilon_{k_1}=\\epsilon_{k_2}=10^{-2} $，$ \\epsilon_{R}=10^{-2} $，绝对下限为 $ \\delta_{R}=10^{-7}\\ \\mathrm{m^2\\,K/W} $。\n\n将激励信号定义为方波脉冲：$ q''(t) = q_0 $（对于 $ 0 \\le t  t_{\\mathrm{on}} $）和 $ q''(t) = 0 $（对于 $ t \\ge t_{\\mathrm{on}} $），在总持续时间 $ t_{\\mathrm{end}} $ 内进行模拟。\n\n您的程序必须评估以下三种实验设计（测试套件），每种设计的材料属性均以国际单位制表示：\n\n- 测试用例 1（单次激励，中等接触电阻）：\n    - 材料和几何结构：$ L_1=2\\times 10^{-3}\\ \\mathrm{m} $，$ L_2=3\\times 10^{-3}\\ \\mathrm{m} $，$ k_1=200\\ \\mathrm{W\\,m^{-1}\\,K^{-1}} $，$ k_2=20\\ \\mathrm{W\\,m^{-1}\\,K^{-1}} $，$ \\rho_1=8000\\ \\mathrm{kg\\,m^{-3}} $，$ c_{p,1}=500\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}} $，$ \\rho_2=1200\\ \\mathrm{kg\\,m^{-3}} $，$ c_{p,2}=1400\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}} $，$ R_{\\mathrm{int}}=1\\times 10^{-4}\\ \\mathrm{m^2\\,K/W} $。\n    - 激励集：一个脉冲，其 $ q_0=8\\times 10^{4}\\ \\mathrm{W\\,m^{-2}} $，$ t_{\\mathrm{on}}=0.3\\ \\mathrm{s} $，$ t_{\\mathrm{end}}=1.2\\ \\mathrm{s} $。\n\n- 测试用例 2（多次激励以解耦参数）：\n    - 材料和几何结构与测试用例 1 相同。\n    - 激励集：三个脉冲，作为独立实验进行模拟并汇总：\n        - 激励 A：$ q_0=1.2\\times 10^{5}\\ \\mathrm{W\\,m^{-2}} $，$ t_{\\mathrm{on}}=0.05\\ \\mathrm{s} $，$ t_{\\mathrm{end}}=0.5\\ \\mathrm{s} $。\n        - 激励 B：$ q_0=7\\times 10^{4}\\ \\mathrm{W\\,m^{-2}} $，$ t_{\\mathrm{on}}=0.2\\ \\mathrm{s} $，$ t_{\\mathrm{end}}=1.0\\ \\mathrm{s} $。\n        - 激励 C：$ q_0=5\\times 10^{4}\\ \\mathrm{W\\,m^{-2}} $，$ t_{\\mathrm{on}}=0.6\\ \\mathrm{s} $，$ t_{\\mathrm{end}}=2.0\\ \\mathrm{s} $。\n\n- 测试用例 3（近乎完美接触，对 $ R_{\\mathrm{int}} $ 的可识别性构成挑战）：\n    - 与测试用例 2 相同，除了 $ R_{\\mathrm{int}}=1\\times 10^{-6}\\ \\mathrm{m^2\\,K/W} $。\n\n程序要求：\n- 严格按照描述实现半离散模型的组装和 Crank–Nicolson 时间积分器，使用热导 $ G_{j+\\frac{1}{2}} = 1/R_{j+\\frac{1}{2}} $，并在适当位置使用半单元电阻和界面电阻。\n- 使用指定的扰动大小，通过前向有限差分近似灵敏度。\n- 构建 Fisher 信息矩阵并评估可识别性决策规则。\n- 对于每个测试用例，计算一个布尔值，指示 $ \\big[k_1,k_2,R_{\\mathrm{int}}\\big] $ 在所述规则下是否可识别。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例 1 到 3 的顺序排列结果，其中每个条目是相应测试用例的布尔可识别性决策（例如，$[ \\mathrm{True}, \\mathrm{False}, \\mathrm{True} ]$）。不应打印任何附加文本。", "solution": "我们从每个均匀层 $i\\in\\{1,2\\}$ 中的一维瞬态热传导方程开始，\n$$ \\rho_i c_{p,i} \\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\!\\left(k_i \\frac{\\partial T}{\\partial x}\\right), $$\n其在 $x=0$ 和 $x=L$ 处的边界条件为\n$$ -k_1 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q''(t), \\quad -k_2 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L} = h \\left(T(L,t)-T_{\\infty}\\right), $$\n以及在 $x=L_1$ 接触面处，界面热通量连续，但存在一个与热通量成正比的有限温度跳跃，\n$$ -k_1 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L_1^-} = -k_2 \\left.\\frac{\\partial T}{\\partial x}\\right|_{x=L_1^+} = q_{\\mathrm{int}}(t), $$\n$$ T(L_1^+,t)-T(L_1^-,t) = q_{\\mathrm{int}}(t) R_{\\mathrm{int}}. $$\n我们假设横截面积为单位面积，初始条件为 $ T(x,0) = T_{\\infty} $。\n\n为了构建一个适用于逆向分析的、鲁棒且物理上忠实的数值正向模型，我们使用有限体积法。将层 $i$ 划分为 $N_i$ 个宽度均匀的控制体积 $ \\Delta x_i=L_i/N_i $，节点温度 $ T_j(t) $位于每个控制体积的中心。节点 $j$ 的能量平衡方程为\n$$ C_j \\frac{\\mathrm{d} T_j}{\\mathrm{d} t} = \\sum_{\\text{faces}} G_{j+\\frac{1}{2}} \\left( T_{j+1}-T_j \\right) + \\sum_{\\text{faces}} G_{j-\\frac{1}{2}} \\left( T_{j-1}-T_j \\right) + s_j(t), $$\n其中节点热容为 $ C_j = \\rho_j c_{p,j} \\Delta x_j $。在相邻控制体积 $j$ 和 $j+1$ 之间的每个内部面上，热阻包括两个半单元的传导热阻，并且如果该面恰好是材料界面，还包括界面热阻：\n$$ R_{j+\\frac{1}{2}} = \\frac{\\Delta x_j}{2 k_j} + \\frac{\\Delta x_{j+1}}{2 k_{j+1}} + R_{\\mathrm{int},\\,j+\\frac{1}{2}}, $$\n其中 $ R_{\\mathrm{int},\\,j+\\frac{1}{2}}=R_{\\mathrm{int}} $ 于 $ x=L_1 $ 处成立，而对于其他所有面 $ R_{\\mathrm{int},\\,j+\\frac{1}{2}}=0 $。相应的热导为 $ G_{j+\\frac{1}{2}} = 1/R_{j+\\frac{1}{2}} $。左侧诺伊曼边界在节点 $ j=1 $ 处贡献一个源项 $ s_1(t)=q''(t) $，而最后一个节点 $ j=N=N_1+N_2 $ 处的右侧对流边界被整合为一个额外的边界热导 $ G_{\\mathrm{conv}}=h $，连接到温度固定的环境节点 $ T_{\\infty} $。这将修改最后一行的平衡方程，使其包含 $ +h ( T_{\\infty} - T_N ) $ 项，在线性形式中通过将 $ h $ 加到热导矩阵的对角线上，并将 $ h T_{\\infty} $ 加到源矢量中来表示。\n\n将所有节点温度收集成 $ \\mathbf{T}(t)\\in\\mathbb{R}^N $，半离散系统为\n$$ \\mathbf{C} \\,\\dot{\\mathbf{T}}(t) + \\mathbf{K}\\,\\mathbf{T}(t) = \\mathbf{f}(t), $$\n其中 $ \\mathbf{C}=\\mathrm{diag}(C_1,\\dots,C_N) $ 是对角矩阵，$ \\mathbf{K} $ 是由 $ G_{j\\pm \\frac{1}{2}} $ 和对流贡献项组装而成的对称三对角矩阵，源矢量 $ \\mathbf{f}(t) $ 满足 $ f_1(t)=q''(t) $ 且 $ f_N(t) $ 包含 $ h T_{\\infty} $ 项。\n\n对于时间积分，我们采用 Crank–Nicolson 格式（即梯形法则），对于从 $ t^n $ 到 $ t^{n+1}=t^n+\\Delta t $ 的一个时间步长，其表达式为\n$$ \\left( \\mathbf{C} + \\frac{\\Delta t}{2}\\mathbf{K} \\right)\\mathbf{T}^{n+1} = \\left( \\mathbf{C} - \\frac{\\Delta t}{2}\\mathbf{K} \\right)\\mathbf{T}^{n} + \\frac{\\Delta t}{2}\\left( \\mathbf{f}^{n+1}+\\mathbf{f}^{n} \\right). $$\n定义 $ \\mathbf{A}=\\mathbf{C} + \\frac{\\Delta t}{2}\\mathbf{K} $ 和 $ \\mathbf{B}=\\mathbf{C} - \\frac{\\Delta t}{2}\\mathbf{K} $。由于在一个实验中 $ \\mathbf{A} $ 是常数，我们可以对 $ \\mathbf{A} $进行一次分解（例如，通过 $\\mathrm{LU}$ 分解），然后在每个时间步求解。测量值是背面温度 $ y(t)=T_N(t) $，该温度在规定的采样时间记录，并带有噪声 $ \\eta(t) \\sim \\mathcal{N}(0,\\sigma_T^2) $。\n\n对于一个给定的实验设计，其中包含 $ M $ 个激励 $ q''_m(t) $ 和相应的采样计划，我们从 $ \\mathbf{T}(0)=T_{\\infty}\\mathbf{1} $ 开始模拟每次激励，以获得一个堆叠的测量矢量 $ \\mathbf{y}\\in\\mathbb{R}^{n_y} $。为了构建关于 $ \\boldsymbol{\\theta}=\\big[k_1,k_2,R_{\\mathrm{int}}\\big]^{\\top} $ 的雅可比矩阵 $ \\mathbf{S}\\in\\mathbb{R}^{n_y\\times 3} $，我们计算前向有限差分：对于每个分量 $ \\theta_\\ell $，我们施加一个扰动 $ \\Delta \\theta_\\ell = \\epsilon_\\ell \\max(|\\theta_\\ell|,\\delta_\\ell) $，其中 $ \\epsilon_{k_1}=\\epsilon_{k_2}=10^{-2} $，$ \\epsilon_{R}=10^{-2} $，且 $ \\delta_R=10^{-7}\\ \\mathrm{m^2\\,K/W} $；然后我们用扰动后的参数重新运行所有激励以获得 $ \\mathbf{y}^{(\\ell)} $，并将 $ \\mathbf{S} $ 的第 $ \\ell $ 列设置为 $ \\big(\\mathbf{y}^{(\\ell)}-\\mathbf{y}\\big)/\\Delta \\theta_\\ell $。假设存在方差为 $ \\sigma_T^2 $ 的独立高斯噪声，Fisher 信息矩阵为\n$$ \\mathbf{F} = \\frac{1}{\\sigma_T^2}\\mathbf{S}^{\\top}\\mathbf{S}. $$\n\n可识别性通过两个标准来判断。首先，Fisher 矩阵不应是病态的：$ \\ell_2 $ 范数条件数 $ \\kappa(\\mathbf{F}) $应满足 $ \\kappa(\\mathbf{F}) \\le 10^{12} $。其次，Cramér–Rao 下界协方差 $ \\mathbf{C}_{\\mathrm{CRLB}} $（当 $ \\mathbf{F} $ 可逆时取 $ \\mathbf{F}^{-1} $，否则取 Moore–Penrose 伪逆 $ \\mathbf{F}^{+} $）所蕴含的边际标准差为 $ \\sigma_{\\theta_\\ell} = \\sqrt{[\\mathbf{C}_{\\mathrm{CRLB}}]_{\\ell\\ell}} $。我们通过 $ r_\\ell = \\sigma_{\\theta_\\ell} / \\max(|\\theta_{\\star,\\ell}|,\\theta_{\\min}) $（其中 $ \\theta_{\\min}=10^{-12} $）将其与真实量级进行比较，并要求对所有 $ \\ell\\in\\{1,2,3\\} $ 都有 $ r_\\ell \\le 0.2 $。两个条件必须同时满足，才为可识别性返回布尔值 $ \\mathrm{True} $。\n\n程序的算法设计：\n- 每个参数集组装一次空间离散化，使用指定的 $ N_1 $、$ N_2 $、$ L_1 $、$ L_2 $、$ k_1 $、$ k_2 $、$ R_{\\mathrm{int}} $、$ \\rho_i $、$ c_{p,i} $、$ h $ 和 $ T_{\\infty} $。\n- 对于每个由 $ q_0 $、$ t_{\\mathrm{on}} $ 和 $ t_{\\mathrm{end}} $ 定义的激励信号 $ q''(t) $，以 $ \\Delta t $ 从 $ t=0 $ 积分到 $ t=t_{\\mathrm{end}} $，并以 $ \\Delta t_{\\mathrm{samp}} $ 的增量采样 $ y(t) $。对每个扰动参数重复正向模拟，以填充灵敏度列。\n- 堆叠所有实验中的模拟测量值并计算 $ \\mathbf{S} $、$ \\mathbf{F} $、$ \\kappa(\\mathbf{F}) $ 和 $ \\mathbf{C}_{\\mathrm{CRLB}} $。\n- 使用双条件规则决定可识别性，并为每个测试用例返回一个布尔值。\n\n指定的三个测试用例探究了可识别性的互补方面。测试用例 1 使用单个中等持续时间的脉冲，这通常会使 $ k_1 $、$ k_2 $ 和 $ R_{\\mathrm{int}} $ 的影响纠缠在一起，可能导致 $ \\mathbf{F} $ 近乎奇异。测试用例 2 引入了具有不同时间尺度和量级的多个激励，从而丰富了灵敏度方向并改善了 $ \\mathbf{F} $ 的条件数。测试用例 3 将 $ R_{\\mathrm{int}} $ 减小了两个数量级，这削弱了界面的可测量影响，即使在多次激励下也对 $ R_{\\mathrm{int}} $ 的可识别性提出了挑战。程序实现了这一逻辑，并输出一个布尔值列表 $[b_1,b_2,b_3]$，对应于三种设计的可识别性结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import lu_factor, lu_solve\n\ndef assemble_matrices(L1, L2, N1, N2, k1, k2, rho1, cp1, rho2, cp2, R_int, h, T_inf):\n    \"\"\"\n    Assemble capacity matrix C (diagonal), conductance matrix K (tridiagonal),\n    and source vector template for convection contribution at the right boundary.\n    Unit area is assumed.\n    \"\"\"\n    # Grid\n    dx1 = L1 / N1\n    dx2 = L2 / N2\n    N = N1 + N2\n    dx = np.concatenate([np.full(N1, dx1), np.full(N2, dx2)])\n    k_cells = np.concatenate([np.full(N1, k1), np.full(N2, k2)])\n    rho_cells = np.concatenate([np.full(N1, rho1), np.full(N2, rho2)])\n    cp_cells = np.concatenate([np.full(N1, cp1), np.full(N2, cp2)])\n    C = (rho_cells * cp_cells * dx)\n\n    # Build tridiagonal K from face conductances\n    K = np.zeros((N, N), dtype=float)\n\n    # Faces between nodes: j between 0..N-2 for face j+1/2 between node j and j+1\n    for j in range(N - 1):\n        # Half-cell resistances on each side\n        R_face = dx[j] / (2.0 * k_cells[j]) + dx[j + 1] / (2.0 * k_cells[j + 1])\n        # Add interfacial resistance at the interface between layers\n        if j == N1 - 1:\n            R_face += R_int\n        G = 1.0 / R_face\n        K[j, j] += G\n        K[j + 1, j + 1] += G\n        K[j, j + 1] -= G\n        K[j + 1, j] -= G\n\n    # Right convective boundary at node N-1\n    K[-1, -1] += h\n    # Source template is zero except for adding h*T_inf at last node each step\n    f_conv = np.zeros(N, dtype=float)\n    f_conv[-1] = h * T_inf\n\n    return C, K, f_conv\n\ndef crank_nicolson_sim(C, K, f_conv, q_of_t, T_inf, dt, t_end, tsamp):\n    \"\"\"\n    Simulate T evolution under heat flux q_of_t(t) at left boundary using Crank-Nicolson.\n    Returns sampled back-face temperature vector y over sampling times.\n    \"\"\"\n    N = C.size\n    # Matrices\n    A = np.diag(C) + 0.5 * dt * K\n    B = np.diag(C) - 0.5 * dt * K\n    lu, piv = lu_factor(A)\n\n    # Time stepping\n    n_steps = int(np.round(t_end / dt))\n    n_samp = int(np.floor(t_end / tsamp)) + 1\n    y = np.zeros(n_samp, dtype=float)\n    T = np.full(N, T_inf, dtype=float)\n\n    # Sampling times\n    sample_times = np.linspace(0.0, t_end, n_samp)\n    next_sample_index = 0\n    next_sample_time = sample_times[next_sample_index]\n\n    t = 0.0\n    # Record initial measurement\n    y[next_sample_index] = T[-1]\n    next_sample_index += 1\n    next_sample_time = sample_times[next_sample_index] if next_sample_index  n_samp else None\n\n    for n in range(n_steps):\n        t_n = t\n        t_np1 = t + dt\n\n        # Build sources at t_n and t_np1\n        f_n = f_conv.copy()\n        f_np1 = f_conv.copy()\n        # Left Neumann flux as source at node 0\n        f_n[0] += q_of_t(t_n)\n        f_np1[0] += q_of_t(t_np1)\n\n        rhs = B @ T + 0.5 * dt * (f_n + f_np1)\n        T = lu_solve((lu, piv), rhs)\n\n        # Advance time\n        t = t_np1\n\n        # Sample as many times as needed within this step (account for dt being smaller than tsamp)\n        while next_sample_time is not None and t >= next_sample_time - 1e-12:\n            y[next_sample_index] = T[-1]\n            next_sample_index += 1\n            if next_sample_index  n_samp:\n                next_sample_time = sample_times[next_sample_index]\n            else:\n                next_sample_time = None\n\n    return y\n\ndef build_excitation(q0, t_on, t_end):\n    def q_of_t(t):\n        return q0 if (0.0 = t  t_on) else 0.0\n    return q_of_t, t_end\n\ndef fisher_information_and_identifiability(params, excitations, constants):\n    \"\"\"\n    Compute Fisher information matrix for the given parameter set and excitation design.\n    Return identifiability boolean based on the stated rule.\n    \"\"\"\n    # Unpack parameters and constants\n    L1, L2 = params['L1'], params['L2']\n    k1, k2, Rint = params['k1'], params['k2'], params['Rint']\n    rho1, cp1 = params['rho1'], params['cp1']\n    rho2, cp2 = params['rho2'], params['cp2']\n    N1, N2 = constants['N1'], constants['N2']\n    h, Tinf = constants['h'], constants['Tinf']\n    dt, tsamp, sigma_T = constants['dt'], constants['tsamp'], constants['sigma_T']\n    # Perturbation sizes\n    eps_k = constants['eps_k']\n    eps_R = constants['eps_R']\n    delta_R = constants['delta_R']\n\n    # Assemble base matrices once per parameter set\n    C, K, f_conv = assemble_matrices(L1, L2, N1, N2, k1, k2, rho1, cp1, rho2, cp2, Rint, h, Tinf)\n\n    # Simulate base outputs and build stack of measurements y\n    y_list = []\n    # Also store sample counts to reconstruct stacking for perturbed runs\n    sample_lengths = []\n    for (q0, t_on, t_end) in excitations:\n        qfun, tend = build_excitation(q0, t_on, t_end)\n        y = crank_nicolson_sim(C, K, f_conv, qfun, Tinf, dt, tend, tsamp)\n        y_list.append(y)\n        sample_lengths.append(len(y))\n    y_stack = np.concatenate(y_list, axis=0)\n    ny = y_stack.size\n\n    # Sensitivity matrix S (ny x 3)\n    S = np.zeros((ny, 3), dtype=float)\n\n    # Parameter perturbations and simulations\n    # 1) Perturb k1\n    dk1 = eps_k * max(abs(k1), 1e-20)\n    Ck1, Kk1, fcv = assemble_matrices(L1, L2, N1, N2, k1 + dk1, k2, rho1, cp1, rho2, cp2, Rint, h, Tinf)\n    y_cols = []\n    for (q0, t_on, t_end), slen in zip(excitations, sample_lengths):\n        qfun, tend = build_excitation(q0, t_on, t_end)\n        y_pert = crank_nicolson_sim(Ck1, Kk1, fcv, qfun, Tinf, dt, tend, tsamp)\n        y_cols.append(y_pert)\n    yk1 = np.concatenate(y_cols, axis=0)\n    S[:, 0] = (yk1 - y_stack) / dk1\n\n    # 2) Perturb k2\n    dk2 = eps_k * max(abs(k2), 1e-20)\n    Ck2, Kk2, fcv = assemble_matrices(L1, L2, N1, N2, k1, k2 + dk2, rho1, cp1, rho2, cp2, Rint, h, Tinf)\n    y_cols = []\n    for (q0, t_on, t_end), slen in zip(excitations, sample_lengths):\n        qfun, tend = build_excitation(q0, t_on, t_end)\n        y_pert = crank_nicolson_sim(Ck2, Kk2, fcv, qfun, Tinf, dt, tend, tsamp)\n        y_cols.append(y_pert)\n    yk2 = np.concatenate(y_cols, axis=0)\n    S[:, 1] = (yk2 - y_stack) / dk2\n\n    # 3) Perturb R_int\n    dR = max(eps_R * max(abs(Rint), delta_R), delta_R)\n    CR, KR, fcv = assemble_matrices(L1, L2, N1, N2, k1, k2, rho1, cp1, rho2, cp2, Rint + dR, h, Tinf)\n    y_cols = []\n    for (q0, t_on, t_end), slen in zip(excitations, sample_lengths):\n        qfun, tend = build_excitation(q0, t_on, t_end)\n        y_pert = crank_nicolson_sim(CR, KR, fcv, qfun, Tinf, dt, tend, tsamp)\n        y_cols.append(y_pert)\n    yR = np.concatenate(y_cols, axis=0)\n    S[:, 2] = (yR - y_stack) / dR\n\n    # Fisher information matrix\n    F = (S.T @ S) / (sigma_T ** 2)\n\n    # Condition number and CRLB\n    # Use SVD for condition number for numerical robustness\n    try:\n        svals = np.linalg.svd(F, compute_uv=False)\n    except np.linalg.LinAlgError:\n        # If SVD fails, mark as not identifiable\n        return False\n    smax = np.max(svals)\n    smin = np.min(svals)\n    # Avoid division by zero\n    if smin = 0.0:\n        kappa = np.inf\n    else:\n        kappa = smax / smin\n\n    # CRLB via inverse if possible, else pseudoinverse\n    if np.isfinite(kappa) and kappa  1e15:\n        try:\n            Finv = np.linalg.inv(F)\n        except np.linalg.LinAlgError:\n            Finv = np.linalg.pinv(F, rcond=1e-12)\n    else:\n        Finv = np.linalg.pinv(F, rcond=1e-12)\n\n    stds = np.sqrt(np.clip(np.diag(Finv), a_min=0.0, a_max=np.inf))\n\n    # Relative standard deviations\n    theta = np.array([k1, k2, Rint], dtype=float)\n    denom = np.maximum(np.abs(theta), 1e-12)\n    rel_stds = stds / denom\n\n    # Identifiability rule\n    identifiable = (kappa = 1e12) and np.all(rel_stds = 0.2)\n    return bool(identifiable)\n\ndef solve():\n    # Constants shared across cases\n    constants = {\n        'Tinf': 293.0,        # K\n        'h': 15.0,            # W/m^2-K\n        'N1': 20,\n        'N2': 30,\n        'dt': 0.001,          # s\n        'tsamp': 0.01,        # s\n        'sigma_T': 0.02,      # K\n        'eps_k': 1e-2,\n        'eps_R': 1e-2,\n        'delta_R': 1e-7\n    }\n\n    # Test case 1: single excitation\n    params1 = {\n        'L1': 2e-3, 'L2': 3e-3,\n        'k1': 200.0, 'k2': 20.0,\n        'rho1': 8000.0, 'cp1': 500.0,\n        'rho2': 1200.0, 'cp2': 1400.0,\n        'Rint': 1e-4\n    }\n    excitations1 = [\n        (8e4, 0.3, 1.2)  # q0, t_on, t_end\n    ]\n\n    # Test case 2: multiple excitations\n    params2 = params1.copy()\n    excitations2 = [\n        (1.2e5, 0.05, 0.5),\n        (7e4, 0.2, 1.0),\n        (5e4, 0.6, 2.0)\n    ]\n\n    # Test case 3: same as 2 but very small Rint\n    params3 = params2.copy()\n    params3['Rint'] = 1e-6\n    excitations3 = excitations2\n\n    test_cases = [\n        (params1, excitations1),\n        (params2, excitations2),\n        (params3, excitations3),\n    ]\n\n    results = []\n    for params, excitations in test_cases:\n        ident = fisher_information_and_identifiability(params, excitations, constants)\n        results.append(ident)\n\n    # Final print statement in the exact required format.\n    # Booleans will be printed as True/False with capital T/F per Python string conversion.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2497727"}]}