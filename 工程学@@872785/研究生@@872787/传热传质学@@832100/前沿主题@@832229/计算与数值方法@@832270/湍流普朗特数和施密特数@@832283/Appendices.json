{"hands_on_practices": [{"introduction": "在雷诺平均模拟（RANS）中，一个核心挑战在于如何对未知的湍流输运项进行建模。本练习将引导您通过基本推导，掌握如何利用梯度扩散假说和湍流普朗特数 $Pr_t$ 来构建湍流热通量的本构关系 [@problem_id:2536185]。这个过程将加深您对 $Pr_t$ 如何在湍流传热模型中扮演关键闭合角色的理解。", "problem": "在一种具有恒定密度 $\\rho$、恒定定压比热 $c_p$ 和恒定分子输运性质的单组分流体中，一个统计定常、完全湍流的零压力梯度边界层在光滑的等温平板上发展。设法向坐标为 $y$，时间平均场用波浪号表示，因此 $T=\\tilde{T}+T'$ 且 $v=\\tilde{v}+v'$，在薄剪切层近似下 $\\tilde{v}\\approx 0$。不存在体积热源，粘性耗散可忽略不计，压力功也可忽略不计。法向湍流热通量定义为 $q_{t,y}=\\rho c_p\\,\\overline{v' T'}$，其中上划线表示时间平均。\n\n从雷诺平均热能平衡方程出发，并采用：\n1) 用于边界层中湍流动量输运的布辛涅斯克（Boussinesq）涡粘性封闭，\n2) 用于被动标量输运的局部梯度扩散假设，\n3) 定义为湍流运动粘度与湍流热扩散率之比的恒定湍流普朗特数 $Pr_t$，\n\n推导法向湍流热通量分量 $q_{t,y}$ 的闭合形式本构关系，用 $\\rho$、$c_p$、$Pr_t$、湍流运动粘度 $\\nu_t$ 和平均温度梯度 $\\partial \\tilde{T}/\\partial y$ 来表示。将最终结果表示为单一解析表达式。不要在最终表达式中代入数值或包含单位。", "solution": "问题要求在一系列湍流边界层分析中常见的特定假设下，推导法向湍流热通量 $q_{t,y}$ 的闭合形式本构关系。该问题提法得当且科学合理，因此我们开始进行推导。\n\n出发点是问题陈述中给出的法向湍流热通量的定义：\n$$\nq_{t,y} = \\rho c_p \\overline{v' T'}\n$$\n在此，$\\rho$ 是恒定的流体密度，$c_p$ 是定压比热，$\\overline{v' T'}$ 是法向速度脉动 $v'$ 和温度脉动 $T'$ 之间的时间平均相关性。这种相关性也被称为 $y$ 方向上的湍流运动热通量。我们的目标是找到该项的表达式，使其不直接涉及脉动量，而是将它们与平均流场性质联系起来。\n\n为封闭该表达式，我们按照指示，采用被动标量输运的局部梯度扩散假设。该假设是雷诺平均湍流模型的基石，类似于分子扩散的菲克（Fick）定律或分子热传导的傅里叶（Fourier）定律。它假定标量的湍流通量与该标量平均值的梯度成正比。对于热能输运，其中温度 $T$ 作为被动标量，湍流运动热通量 $\\overline{v' T'}$ 被建模为：\n$$\n\\overline{v' T'} = - \\alpha_t \\frac{\\partial \\tilde{T}}{\\partial y}\n$$\n在此表达式中，$\\tilde{T}$ 是时间平均温度，$\\frac{\\partial \\tilde{T}}{\\partial y}$ 是法向的平均温度梯度，$\\alpha_t$ 是湍流热扩散率，也称为涡热扩散率。负号表示湍流热输运沿着平均温度梯度的反方向发生，即从平均温度较高的区域输运到平均温度较低的区域。\n\n湍流热扩散率 $\\alpha_t$ 不是流体性质，而是湍流状态的一个特征。它必须通过模型来确定。问题通过引入湍流普朗特数 $Pr_t$ 提供了实现这一目标的方法。湍流普朗特数定义为湍流（涡）运动粘度 $\\nu_t$ 与湍流（涡）热扩散率 $\\alpha_t$ 之比：\n$$\nPr_t = \\frac{\\nu_t}{\\alpha_t}\n$$\n湍流运动粘度 $\\nu_t$ 源于动量输运的布辛涅斯克（Boussinesq）涡粘性封闭，$-\\rho \\overline{u'v'} = \\rho \\nu_t (\\partial \\tilde{u}/\\partial y)$，该封闭以类似于我们建模湍流热通量的方式来建模湍流切应力。问题指明 $Pr_t$ 是一个常数。这是一个被称为雷诺（Reynolds）比拟的常见简化，它假设湍流动量和热量输运的机制是相似的。\n\n根据 $Pr_t$ 的定义，我们可以用湍流运动粘度 $\\nu_t$ 和湍流普朗特数 $Pr_t$ 来表示湍流热扩散率 $\\alpha_t$：\n$$\n\\alpha_t = \\frac{\\nu_t}{Pr_t}\n$$\n现在，我们将 $\\alpha_t$ 的这个表达式代回到湍流运动热通量的梯度扩散模型中：\n$$\n\\overline{v' T'} = - \\left( \\frac{\\nu_t}{Pr_t} \\right) \\frac{\\partial \\tilde{T}}{\\partial y}\n$$\n这就为相关项 $\\overline{v' T'}$ 提供了一个用平均流场量和湍流模型参数表示的封闭模型。\n\n最后一步是将此结果代入法向湍流热通量 $q_{t,y}$ 的原始定义中。\n$$\nq_{t,y} = \\rho c_p \\overline{v' T'} = \\rho c_p \\left( - \\frac{\\nu_t}{Pr_t} \\frac{\\partial \\tilde{T}}{\\partial y} \\right)\n$$\n整理各项，得到所需的闭合形式本构关系：\n$$\nq_{t,y} = - \\frac{\\rho c_p \\nu_t}{Pr_t} \\frac{\\partial \\tilde{T}}{\\partial y}\n$$\n该表达式将湍流热通量 $q_{t,y}$ 与局部平均温度梯度 $\\frac{\\partial \\tilde{T}}{\\partial y}$、流体性质 $\\rho$ 和 $c_p$ 以及湍流模型参数 $\\nu_t$ 和 $Pr_t$ 联系起来，正如问题陈述所要求的。这就是湍流热通量的布辛涅斯克（Boussinesq）近似。", "answer": "$$\n\\boxed{- \\frac{\\rho c_{p} \\nu_{t}}{Pr_{t}} \\frac{\\partial \\tilde{T}}{\\partial y}}\n$$", "id": "2536185"}, {"introduction": "在许多工程模型中，湍流普朗特数 $Pr_t$ 常被假定为一个常数（例如0.85），但这只是一个近似。本练习将逆转建模过程，利用模拟的湍流数据，直接根据湍流脉动通量和平均梯度计算出湍流粘度 $\\nu_t$ 和湍流热扩散率 $\\alpha_t$ [@problem_id:2536143]。通过计算它们的比值，您将亲手构建出 $Pr_t$ 的剖面，从而深刻理解其物理定义以及它在流场中随空间变化的特性。", "problem": "您将执行一项概念性和计算性任务，该任务基于壁面束缚湍流中的动量和热量输运。考虑充分发展的平面槽道流，其数据代表了在摩擦雷诺数 $Re_{\\tau}=1000$ 和分子普朗特数 $Pr=0.71$ 条件下的直接数值模拟结果。目标是在梯度扩散封闭框架内，利用局部湍流脉动通量和平均梯度来构建湍流普朗特数剖面 $Pr_{t}(y)$。\n\n从以下基本原理开始：\n- 雷诺平均动量方程包含由脉动产生的湍流动量通量 $-\\overline{u'v'}$，雷诺平均能量（或标量）方程包含湍流热（或标量）通量 $-\\overline{v'T'}$。\n- 梯度扩散假设假定这些湍流脉动通量与平均梯度之间存在线性本构关系，引入湍流运动黏度 $\\nu_{t}$ 和湍流热扩散率 $\\alpha_{t}$ 作为具有扩散率量纲的比例系数。\n- 湍流普朗特数是比值 $Pr_{t}=\\nu_{t}/\\alpha_{t}$，它是一个无量纲的度量，关联了湍流动量和热量输运的效率。\n\n对于每个给定的测试用例，您的程序必须为一组法向采样点 $y_{i}$ 执行以下操作：\n1. 根据梯度扩散假设所隐含的比例关系，利用湍流动量通量和平均速度梯度计算逐点的湍流运动黏度 $\\nu_{t,i}$。使用一个小的正容差 $\\epsilon=10^{-12}$ 来避免除以数量级过小的数：如果 $\\left|\\partial \\tilde{U}_{i}/\\partial y\\right| < \\epsilon$，则设置 $\\nu_{t,i}=\\mathrm{NaN}$。\n2. 以同样的方式，利用湍流热通量和平均温度梯度计算逐点的湍流热扩散率 $\\alpha_{t,i}$；如果 $\\left|\\partial \\tilde{T}_{i}/\\partial y\\right| < \\epsilon$，则设置 $\\alpha_{t,i}=\\mathrm{NaN}$。\n3. 在 $\\nu_{t,i}$ 和 $\\alpha_{t,i}$ 都有定义（即非 $\\mathrm{NaN}$）的位置，计算逐点的湍流普朗特数 $Pr_{t,i}=\\nu_{t,i}/\\alpha_{t,i}$。如果某个索引处的 $\\nu_{t,i}$ 或 $\\alpha_{t,i}$ 为 $\\mathrm{NaN}$，则该索引处的 $Pr_{t,i}$ 也设置为 $\\mathrm{NaN}$。\n\n对于每个测试用例，报告根据 $Pr_{t,i}$ 的有效值（非 $\\mathrm{NaN}$）计算出的三个标量：\n- 在有效索引上的算术平均值 $\\overline{Pr_{t}}$。\n- 在有效索引上的最小值 $\\min Pr_{t}$。\n- 在有效索引上的最大值 $\\max Pr_{t}$。\n\n如果某个测试用例不包含有效索引（所有值均为 $\\mathrm{NaN}$），则该用例的三个输出均应为 $\\mathrm{NaN}$。\n\n由于 $Pr_{t}$ 是无量纲的，因此输出中不需要物理单位。\n\n测试套件。您的程序必须使用以下三个测试用例，每个用例都由相同长度的数组指定，代表在相同的法向采样点 $y_{i}$ 处的量值：\n- 测试用例 A（各点湍流普朗特数恒定）：\n  - 湍流动量通量数组 $[-\\overline{u'v'}]$: $[0.5,1.0,1.5,2.0,2.5]$。\n  - 平均速度梯度数组 $\\left[\\partial \\tilde{U}/\\partial y\\right]$: $[1.0,1.0,1.0,1.0,1.0]$。\n  - 湍流热通量数组 $[-\\overline{v'T'}]$: $[0.5555555555555556,1.1111111111111112,1.6666666666666667,2.2222222222222223,2.7777777777777777]$。\n  - 平均温度梯度数组 $\\left[\\partial \\tilde{T}/\\partial y\\right]$: $[1.0,1.0,1.0,1.0,1.0]$。\n- 测试用例 B（存在零梯度导致局部系数未定义，预期在这些索引处出现 $\\mathrm{NaN}$；只有两个梯度都非零的索引才有效）：\n  - 湍流动量通量数组 $[-\\overline{u'v'}]$: $[0.2,0.4,0.6,0.8,1.0]$。\n  - 平均速度梯度数组 $\\left[\\partial \\tilde{U}/\\partial y\\right]$: $[1.0,0.0,2.0,0.0,3.0]$。\n  - 湍流热通量数组 $[-\\overline{v'T'}]$: $[0.28571428571428575,0.0,0.0,0.0,0.0]$。\n  - 平均温度梯度数组 $\\left[\\partial \\tilde{T}/\\partial y\\right]$: $[1.0,2.0,0.0,4.0,0.0]$。\n- 测试用例 C（梯度和通量中存在混合符号；没有零值，因此所有索引均有效，且湍流普朗特数随空间变化）：\n  - 湍流动量通量数组 $[-\\overline{u'v'}]$: $[-0.2,-0.2,-0.125,0.15,0.35,0.8]$。\n  - 平均速度梯度数组 $\\left[\\partial \\tilde{U}/\\partial y\\right]$: $[-2.0,-1.0,-0.5,0.5,1.0,2.0]$。\n  - 湍流热通量数组 $[-\\overline{v'T'}]$: $[0.05,-0.15,0.25,-0.4,0.2625,-0.2]$。\n  - 平均温度梯度数组 $\\left[\\partial \\tilde{T}/\\partial y\\right]$: $[1.0,-1.5,2.0,-2.0,1.5,-1.0]$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身是一个三元素列表 $[\\overline{Pr_{t}},\\min Pr_{t},\\max Pr_{t}]$，仅根据有效点计算，并按照测试用例 A、B、C 的顺序排列。例如，输出格式必须为 $[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],[x_{3},y_{3},z_{3}]]$ 的形式，其中数值取代 $x_{k},y_{k},z_{k}$。", "solution": "问题陈述经过了严格验证。\n\n**步骤1：提取已知条件**\n\n该问题为一项关于平面槽道流中湍流输运的计算任务提供了以下信息和定义：\n\n- **概念框架**：分析基于湍流脉动通量的梯度扩散假设。\n- **湍流动量通量**：$-\\overline{u'v'}$\n- **湍流热通量**：$-\\overline{v'T'}$\n- **湍流运动黏度定义**：$-\\overline{u'v'}$ 与平均速度梯度 $\\partial \\tilde{U}/\\partial y$ 之间的比例关系定义了湍流运动黏度 $\\nu_{t}$。\n- **湍流热扩散率定义**：$-\\overline{v'T'}$ 与平均温度梯度 $\\partial \\tilde{T}/\\partial y$ 之间的比例关系定义了湍流热扩散率 $\\alpha_{t}$。\n- **湍流普朗特数定义**：$Pr_{t} = \\nu_{t} / \\alpha_{t}$。\n- **$\\nu_{t,i}$的计算规则**：根据提供的数组计算 $\\nu_{t,i}$。如果 $|\\partial \\tilde{U}_{i}/\\partial y| < \\epsilon$，则设置 $\\nu_{t,i}=\\mathrm{NaN}$。容差为 $\\epsilon=10^{-12}$。\n- **$\\alpha_{t,i}$的计算规则**：根据提供的数组计算 $\\alpha_{t,i}$。如果 $|\\partial \\tilde{T}_{i}/\\partial y| < \\epsilon$，则设置 $\\alpha_{t,i}=\\mathrm{NaN}$。容差为 $\\epsilon=10^{-12}$。\n- **$Pr_{t,i}$的计算规则**：计算 $Pr_{t,i} = \\nu_{t,i}/\\alpha_{t,i}$。如果 $\\nu_{t,i}$ 或 $\\alpha_{t,i}$ 中任意一个为 $\\mathrm{NaN}$，则 $Pr_{t,i}$ 也为 $\\mathrm{NaN}$。\n- **输出指标**：对于每个测试用例，根据 $Pr_{t,i}$ 的所有有效值（非 $\\mathrm{NaN}$）计算算术平均值 $\\overline{Pr_{t}}$、最小值 $\\min Pr_{t}$ 和最大值 $\\max Pr_{t}$。如果不存在有效值，则所有三个指标均为 $\\mathrm{NaN}$。\n- **测试用例 A**：\n  - $[-\\overline{u'v'}]$: $[0.5, 1.0, 1.5, 2.0, 2.5]$\n  - $[\\partial \\tilde{U}/\\partial y]$: $[1.0, 1.0, 1.0, 1.0, 1.0]$\n  - $[-\\overline{v'T'}]$: $[0.5555555555555556, 1.1111111111111112, 1.6666666666666667, 2.2222222222222223, 2.7777777777777777]$\n  - $[\\partial \\tilde{T}/\\partial y]$: $[1.0, 1.0, 1.0, 1.0, 1.0]$\n- **测试用例 B**：\n  - $[-\\overline{u'v'}]$: $[0.2, 0.4, 0.6, 0.8, 1.0]$\n  - $[\\partial \\tilde{U}/\\partial y]$: $[1.0, 0.0, 2.0, 0.0, 3.0]$\n  - $[-\\overline{v'T'}]$: $[0.28571428571428575, 0.0, 0.0, 0.0, 0.0]$\n  - $[\\partial \\tilde{T}/\\partial y]$: $[1.0, 2.0, 0.0, 4.0, 0.0]$\n- **测试用例 C**：\n  - $[-\\overline{u'v'}]$: $[-0.2, -0.2, -0.125, 0.15, 0.35, 0.8]$\n  - $[\\partial \\tilde{U}/\\partial y]$: $[-2.0, -1.0, -0.5, 0.5, 1.0, 2.0]$\n  - $[-\\overline{v'T'}]$: $[0.05, -0.15, 0.25, -0.4, 0.2625, -0.2]$\n  - $[\\partial \\tilde{T}/\\partial y]$: $[1.0, -1.5, 2.0, -2.0, 1.5, -1.0]$\n\n**步骤2：已知条件验证**\n\n根据既定标准对问题进行评估：\n- **科学依据**：该问题基于标准的Boussinesq/梯度扩散假设，这是雷诺平均Navier-Stokes (RANS) 湍流模型的一个基石。湍流黏度 $\\nu_t$、湍流扩散率 $\\alpha_t$ 和湍流普朗特数 $Pr_t$ 的定义都是标准的。一个关键的物理要求是扩散率 $\\nu_t$ 和 $\\alpha_t$ 必须为非负值。这意味着湍流脉动通量必须与相应的平均梯度同号（即输运是“顺梯度”的）。对所有提供的测试数据的检查证实，在梯度非零的每个点，通量和梯度都具有相同的符号，从而产生正的扩散率。因此，数据没有违反所用模型的这一基本物理假设。该问题是科学合理的。\n- **适定性**：该问题是确定性的，并且在计算上是明确定义的。所有必需的输入均已提供。计算过程有明确的规定，包括使用容差 $\\epsilon$ 处理接近零的分母以及未定义值（$\\mathrm{NaN}$）的传播。所需的输出有清晰的描述。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性或个人观点。\n- **完整性和一致性**：问题是自洽的。没有缺失信息，所提供的数据或指令中也没有任何矛盾。\n- **可行性**：指定的计算是基本的，并且在计算上是可行的。测试数据中提供的数值对于此类分析来说大小合理。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。这是一个适定的、有科学依据的、客观的计算任务。我将继续进行完整解答。\n\n**基于原理的解答**\n\n目标是根据给定的湍流脉动通量和平均梯度的离散数据，计算湍流普朗特数 $Pr_{t}$ 的统计特性。该解答基于用于模拟湍流输运的梯度扩散假设。\n\n湍流运动黏度 $\\nu_t$ 由Boussinesq假设定义，该假设将湍流动量通量（雷诺剪应力）与平均速度梯度关联起来：\n$$ -\\overline{u'v'} = \\nu_t \\frac{\\partial \\tilde{U}}{\\partial y} $$\n在每个离散点 $i$ 求解 $\\nu_t$ 可得：\n$$ \\nu_{t,i} = \\frac{(-\\overline{u'v'})_i}{(\\partial \\tilde{U}/\\partial y)_i} $$\n当速度梯度为零时，此表达式无定义。问题规定，如果 $|\\partial \\tilde{U}_{i}/\\partial y| < \\epsilon = 10^{-12}$，我们必须将 $\\nu_{t,i}$ 视为未定义。\n\n类似地，湍流热扩散率 $\\alpha_t$ 通过将湍流热通量与平均温度梯度关联来定义：\n$$ -\\overline{v'T'} = \\alpha_t \\frac{\\partial \\tilde{T}}{\\partial y} $$\n在每个离散点 $i$ 求解 $\\alpha_t$ 可得：\n$$ \\alpha_{t,i} = \\frac{(-\\overline{v'T'})_i}{(\\partial \\tilde{T}/\\partial y)_i} $$\n同样，当温度梯度为零时，此表达式无定义。问题规定，如果 $|\\partial \\tilde{T}_{i}/\\partial y| < \\epsilon = 10^{-12}$，我们必须将 $\\alpha_{t,i}$ 视为未定义。\n\n湍流普朗特数 $Pr_t$ 是这两个湍流扩散率的比值：\n$$ Pr_{t,i} = \\frac{\\nu_{t,i}}{\\alpha_{t,i}} $$\n$Pr_t$ 是一个无量纲量，用于比较动量与热量的湍流输运效率。如果对于给定的点 $i$，$\\nu_{t,i}$ 或 $\\alpha_{t,i}$ 中任意一个未定义，则 $Pr_{t,i}$ 也未定义。\n\n最后一步是计算 $Pr_{t,i}$ 值的算术平均值、最小值和最大值，仅考虑 $Pr_t$ 有定义的点（即非 $\\mathrm{NaN}$）。\n\n**测试用例执行**\n\n**测试用例 A：**\n- $[\\partial \\tilde{U}/\\partial y]$ 和 $[\\partial \\tilde{T}/\\partial y]$ 只包含值 $1.0$，其绝对值均大于 $\\epsilon$。不会发生除以零的情况。\n- $\\nu_{t,i} = [0.5/1.0, 1.0/1.0, 1.5/1.0, 2.0/1.0, 2.5/1.0] = [0.5, 1.0, 1.5, 2.0, 2.5]$。\n- $[-\\overline{v'T'}]$ 中的值是 $5/9 \\approx 0.555...$ 的连续倍数。\n- $\\alpha_{t,i} = [(5/9)/1.0, (10/9)/1.0, (15/9)/1.0, (20/9)/1.0, (25/9)/1.0] = [5/9, 10/9, 15/9, 20/9, 25/9]$。\n- $Pr_{t,i} = \\nu_{t,i} / \\alpha_{t,i} = [0.5/(5/9), 1.0/(10/9), 1.5/(15/9), 2.0/(20/9), 2.5/(25/9)] = [0.9, 0.9, 0.9, 0.9, 0.9]$。\n- 所有5个值均有效。\n- $\\overline{Pr_{t}} = 0.9$, $\\min Pr_{t} = 0.9$, $\\max Pr_{t} = 0.9$。\n\n**测试用例 B：**\n- 对于索引 $i=1$，$|\\partial \\tilde{U}/\\partial y|_1 = 0 < \\epsilon \\implies \\nu_{t,1} = \\mathrm{NaN}$。\n- 对于索引 $i=3$，$|\\partial \\tilde{U}/\\partial y|_3 = 0 < \\epsilon \\implies \\nu_{t,3} = \\mathrm{NaN}$。\n- 对于索引 $i=2$，$|\\partial \\tilde{T}/\\partial y|_2 = 0 < \\epsilon \\implies \\alpha_{t,2} = \\mathrm{NaN}$。\n- 对于索引 $i=4$，$|\\partial \\tilde{T}/\\partial y|_4 = 0 < \\epsilon \\implies \\alpha_{t,4} = \\mathrm{NaN}$。\n- 逐点计算：\n  - $i=0$: $\\nu_{t,0} = 0.2/1.0 = 0.2$。$\\alpha_{t,0} = 0.2857.../1.0 = 2/7$。$Pr_{t,0} = 0.2 / (2/7) = 0.7$。\n  - $i=1$: $\\nu_{t,1} = \\mathrm{NaN} \\implies Pr_{t,1} = \\mathrm{NaN}$。\n  - $i=2$: $\\alpha_{t,2} = \\mathrm{NaN} \\implies Pr_{t,2} = \\mathrm{NaN}$。\n  - $i=3$: $\\nu_{t,3} = \\mathrm{NaN} \\implies Pr_{t,3} = \\mathrm{NaN}$。\n  - $i=4$: $\\alpha_{t,4} = \\mathrm{NaN} \\implies Pr_{t,4} = \\mathrm{NaN}$。\n- 有效的 $Pr_t$ 值集合为 $[0.7]$。\n- $\\overline{Pr_{t}} = 0.7$, $\\min Pr_{t} = 0.7$, $\\max Pr_{t} = 0.7$。\n\n**测试用例 C：**\n- 所有速度和温度梯度的绝对值都大于等于 $0.5$，所以没有分母接近零。所有 $\\nu_{t,i}$ 和 $\\alpha_{t,i}$ 都将有明确定义。\n- $\\nu_{t,i} = [-0.2/-2.0, -0.2/-1.0, -0.125/-0.5, 0.15/0.5, 0.35/1.0, 0.8/2.0] = [0.1, 0.2, 0.25, 0.3, 0.35, 0.4]$。\n- $\\alpha_{t,i} = [0.05/1.0, -0.15/-1.5, 0.25/2.0, -0.4/-2.0, 0.2625/1.5, -0.2/-1.0] = [0.05, 0.1, 0.125, 0.2, 0.175, 0.2]$。\n- $Pr_{t,i} = \\nu_{t,i} / \\alpha_{t,i} = [0.1/0.05, 0.2/0.1, 0.25/0.125, 0.3/0.2, 0.35/0.175, 0.4/0.2] = [2.0, 2.0, 2.0, 1.5, 2.0, 2.0]$。\n- 所有6个值均有效。\n- $\\overline{Pr_{t}} = (5 \\times 2.0 + 1.5) / 6 = 11.5 / 6 \\approx 1.91666...$\n- $\\min Pr_{t} = 1.5$。\n- $\\max Pr_{t} = 2.0$。\n\n实现将精确遵循此逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes statistics of the turbulent Prandtl number for a suite of test cases.\n    \"\"\"\n    # Define the small positive tolerance for gradient magnitudes.\n    epsilon = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case A\n        {\n            \"uv_flux\": np.array([0.5, 1.0, 1.5, 2.0, 2.5]),\n            \"du_dy\": np.array([1.0, 1.0, 1.0, 1.0, 1.0]),\n            \"vt_flux\": np.array([0.5555555555555556, 1.1111111111111112, 1.6666666666666667, 2.2222222222222223, 2.7777777777777777]),\n            \"dT_dy\": np.array([1.0, 1.0, 1.0, 1.0, 1.0]),\n        },\n        # Test case B\n        {\n            \"uv_flux\": np.array([0.2, 0.4, 0.6, 0.8, 1.0]),\n            \"du_dy\": np.array([1.0, 0.0, 2.0, 0.0, 3.0]),\n            \"vt_flux\": np.array([0.28571428571428575, 0.0, 0.0, 0.0, 0.0]),\n            \"dT_dy\": np.array([1.0, 2.0, 0.0, 4.0, 0.0]),\n        },\n        # Test case C\n        {\n            \"uv_flux\": np.array([-0.2, -0.2, -0.125, 0.15, 0.35, 0.8]),\n            \"du_dy\": np.array([-2.0, -1.0, -0.5, 0.5, 1.0, 2.0]),\n            \"vt_flux\": np.array([0.05, -0.15, 0.25, -0.4, 0.2625, -0.2]),\n            \"dT_dy\": np.array([1.0, -1.5, 2.0, -2.0, 1.5, -1.0]),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        uv_flux = case[\"uv_flux\"]  # This is already -u'v'\n        du_dy = case[\"du_dy\"]\n        vt_flux = case[\"vt_flux\"]  # This is already -v'T'\n        dT_dy = case[\"dT_dy\"]\n\n        # Compute turbulent kinematic viscosity (nu_t)\n        # Initialize with NaNs\n        nu_t = np.full_like(du_dy, np.nan, dtype=np.float64)\n        # Create a mask for valid gradients\n        valid_du_dy_mask = np.abs(du_dy) >= epsilon\n        # Compute nu_t only where the gradient is valid\n        nu_t[valid_du_dy_mask] = uv_flux[valid_du_dy_mask] / du_dy[valid_du_dy_mask]\n\n        # Compute turbulent thermal diffusivity (alpha_t)\n        # Initialize with NaNs\n        alpha_t = np.full_like(dT_dy, np.nan, dtype=np.float64)\n        # Create a mask for valid gradients\n        valid_dT_dy_mask = np.abs(dT_dy) >= epsilon\n        # Compute alpha_t only where the gradient is valid\n        alpha_t[valid_dT_dy_mask] = vt_flux[valid_dT_dy_mask] / dT_dy[valid_dT_dy_mask]\n\n        # Compute turbulent Prandtl number (Pr_t)\n        # NumPy's division automatically handles NaNs as required: x/NaN -> NaN, NaN/x -> NaN\n        pr_t = nu_t / alpha_t\n\n        # Filter out NaN values to compute statistics\n        valid_prt = pr_t[~np.isnan(pr_t)]\n\n        # Calculate statistics\n        if valid_prt.size == 0:\n            # If no valid Pr_t values, all statistics are NaN\n            mean_prt = np.nan\n            min_prt = np.nan\n            max_prt = np.nan\n        else:\n            mean_prt = np.mean(valid_prt)\n            min_prt = np.min(valid_prt)\n            max_prt = np.max(valid_prt)\n\n        results.append([mean_prt, min_prt, max_prt])\n    \n    # Format the final output string as specified\n    # e.g., [[x1,y1,z1],[x2,y2,z2],[x3,y3,z3]]\n    output_str = \"[\" + \",\".join([str(res) for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2536143"}, {"introduction": "我们已经了解到湍流普朗特数 $Pr_t$ 在理论上可以随空间变化，但这在实际工程预测中有多重要呢？本计算练习将让您直面这一问题，针对后台阶流动这一经典分离流场景，分别使用常数 $Pr_t$ 模型和更复杂的壁面修正可变 $Pr_t$ 模型进行传热计算 [@problem_id:2536139]。通过编程计算并比较两种模型预测的斯坦顿数（Stanton number），您将量化不同模型选择对工程结果的影响，并认识到发展更精细湍流模型的实际意义。", "problem": "一个具有充分发展的湍流再附着区的后台阶流动，在局部被建模为一个加热光滑壁面上的准一维壁面法向能量平衡。壁面是等温的，温度为 $T_w$，外部流的温度为 $T_b$。设局部外缘速度为 $U_e$。壁面法向坐标为 $y \\in [0,\\delta]$，其中 $\\delta$ 是局部边界层厚度，再附着区的特征是高壁面剪切应力（摩擦速度 $u_\\tau$）。工作流体是量热完全理想气体，具有恒定的物性：密度 $\\rho$、动力粘度 $\\mu$、定压比热 $c_p$ 和热导率 $k$。运动粘度为 $\\nu = \\mu / \\rho$，分子热扩散率为 $\\alpha = k / (\\rho c_p)$。您必须使用国际单位制（SI）表示所有输入。要求的输出是无量纲的。\n\n从雷诺平均纳维-斯托克斯（RANS）能量方程和湍流热通量的梯度扩散假设出发，执行以下步骤：\n\n1.  从壁面法向、稳态、二维能量平衡开始，不考虑体积热源，忽略流向扩散，并假设物性恒定。使用梯度扩散假设和湍流热扩散率 $\\alpha_t(y)$ 来模拟湍流热通量。\n2.  使用涡粘性封闭模型，通过 $\\alpha_t(y) = \\nu_t(y) / \\mathrm{Pr}_t(y)$ 将湍流热扩散率与湍流运动粘度 $\\nu_t(y)$ 和湍流普朗特数 $\\mathrm{Pr}_t(y)$ 联系起来。\n3.  采用适用于光滑壁面的 van Driest 阻尼混合长度涡粘性模型，\n    $$\n    \\nu_t(y) = \\kappa \\, u_\\tau \\, y \\left[1 - \\exp\\!\\left(-\\frac{y^+}{A^+}\\right)\\right]^2, \\quad y^+ = \\frac{y\\,u_\\tau}{\\nu},\n    $$\n    其中 $\\kappa = 0.41$ 且 $A^+ = 26$。\n4.  考虑两种湍流普朗特数模型：\n    -   常数模型：$\\mathrm{Pr}_t(y) \\equiv 0.85$。\n    -   变量模型，作为局部湍流雷诺数 $\\mathrm{Re}_t(y) = \\nu_t(y)/\\nu$ 的函数：\n        $$\n        \\mathrm{Pr}_t(y) = 0.85 + 0.15 \\exp\\!\\left(-\\frac{\\mathrm{Re}_t(y)}{5}\\right).\n        $$\n5.  施加边界条件 $T(0)=T_w$ 和 $T(\\delta)=T_b$，并使用上述封闭模型，得到局部斯坦顿数的公式，\n    $$\n    \\mathrm{St} = \\frac{q''}{\\rho c_p U_e (T_w - T_b)},\n    $$\n    其中 $q''$ 是由您的能量平衡预测的壁面热通量。您的推导必须从微分能量平衡方程开始，并得出一个以包含 $\\alpha$ 和 $\\alpha_t(y)$ 的壁面法向积分为形式的 $\\mathrm{St}$ 表达式。\n\n算法任务：\n- 使用您推导的表达式，通过对 $y \\in [0,\\delta]$ 区间上的壁面法向积分进行数值求积，计算常数和变量 $\\mathrm{Pr}_t$ 模型下的 $\\mathrm{St}$。\n- 对于每个测试案例，报告三个值：常数模型的斯坦顿数、变量模型的斯坦顿数，以及定义为 $(\\mathrm{St}_{\\text{var}} - \\mathrm{St}_{\\text{const}})/\\mathrm{St}_{\\text{const}}$ 的相对差异。每个报告值必须是四舍五入到六位小数的浮点数。\n\n您必须使用的基本原理：\n- 稳态下的雷诺平均能量方程，采用梯度扩散湍流封闭。\n- 湍流热扩散率的定义 $\\alpha_t = \\nu_t / \\mathrm{Pr}_t$。\n- 在壁面和 $y=\\delta$ 处的边界条件。\n\n数值和物理数据：\n- 使用 $\\kappa = 0.41$, $A^+ = 26$。\n- 流体属性（类似标准条件下的空气）：$\\rho = 1.2 \\ \\mathrm{kg/m^3}$，$\\mu = 1.8\\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$，$c_p = 1006 \\ \\mathrm{J/(kg \\cdot K)}$，$k = 0.026 \\ \\mathrm{W/(m \\cdot K)}$。\n\n测试套件（四个案例，代表近再附着区的可变性）：\n- 案例1（理想情况）：$U_e = 10 \\ \\mathrm{m/s}$，$u_\\tau = 0.8 \\ \\mathrm{m/s}$，$\\delta = 0.010 \\ \\mathrm{m}$。\n- 案例2（剪切减小，边界层增厚）：$U_e = 10 \\ \\mathrm{m/s}$，$u_\\tau = 0.4 \\ \\mathrm{m/s}$，$\\delta = 0.012 \\ \\mathrm{m}$。\n- 案例3（剪切增强，边界层变薄）：$U_e = 10 \\ \\mathrm{m/s}$，$u_\\tau = 1.2 \\ \\mathrm{m/s}$，$\\delta = 0.008 \\ \\mathrm{m}$。\n- 案例4（边界情况，低速弱剪切）：$U_e = 8 \\ \\mathrm{m/s}$，$u_\\tau = 0.2 \\ \\mathrm{m/s}$，$\\delta = 0.006 \\ \\mathrm{m}$。\n\n实现要求：\n- 以足够的分辨率数值计算壁面法向积分，以确保在整个测试套件中的稳定性和准确性。\n- 您的程序应生成单行输出，其中包含四个测试案例的结果，格式为用方括号括起来的逗号分隔列表，并按照上面给出的顺序将三元组展平，即，\n  $$\n  [\\mathrm{St}_{\\text{const},1},\\mathrm{St}_{\\text{var},1},\\Delta_1,\\mathrm{St}_{\\text{const},2},\\mathrm{St}_{\\text{var},2},\\Delta_2,\\mathrm{St}_{\\text{const},3},\\mathrm{St}_{\\text{var},3},\\Delta_3,\\mathrm{St}_{\\text{const},4},\\mathrm{St}_{\\text{var},4},\\Delta_4].\n  $$\n将每个浮点数四舍五入到六位小数。所有输出均为无量纲。", "solution": "问题需要进行验证。\n\n**步骤 1：提取已知条件**\n- **控制物理**：雷诺平均纳维-斯托克斯（RANS）能量方程，简化为局部的、一维的、稳态的壁面法向平衡。\n- **假设**：物性恒定（$\\rho, \\mu, c_p, k$），无体积热源，流向扩散可忽略。\n- **域**：壁面法向坐标 $y \\in [0, \\delta]$。\n- **边界条件**：$T(y=0) = T_w$, $T(y=\\delta) = T_b$。\n- **流动参数**：外缘速度 $U_e$，摩擦速度 $u_\\tau$。\n- **湍流封闭模型**：\n    - 湍流热通量：梯度扩散假设，$q''_t = - \\rho c_p \\alpha_t \\frac{dT}{dy}$。\n    - 湍流热扩散率：$\\alpha_t(y) = \\nu_t(y) / \\mathrm{Pr}_t(y)$。\n    - 涡粘性：van Driest 阻尼混合长度模型，$\\nu_t(y) = \\kappa \\, u_\\tau \\, y \\left[1 - \\exp(-y^+/A^+)\\right]^2$，其中 $y^+ = y u_\\tau / \\nu$。\n- **湍流普朗特数模型**：\n    - 常数：$\\mathrm{Pr}_t(y) = 0.85$。\n    - 变量：$\\mathrm{Pr}_t(y) = 0.85 + 0.15 \\exp(-\\mathrm{Re}_t(y)/5)$，其中 $\\mathrm{Re}_t(y) = \\nu_t(y)/\\nu$。\n- **目标量**：斯坦顿数，$\\mathrm{St} = q'' / (\\rho c_p U_e (T_w - T_b))$。\n- **常数**：$\\kappa = 0.41$, $A^+ = 26$。\n- **流体属性**：$\\rho = 1.2 \\ \\mathrm{kg/m^3}$，$\\mu = 1.8\\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$，$c_p = 1006 \\ \\mathrm{J/(kg \\cdot K)}$，$k = 0.026 \\ \\mathrm{W/(m \\cdot K)}$。\n- **测试案例**：提供了四组 $(U_e, u_\\tau, \\delta)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题进行有效性审查。\n- **科学基础**：该问题基于湍流传热的基本原理构建，使用了标准且成熟的模型（RANS、梯度扩散、带 van Driest 阻尼的混合长度模型）。所有概念在该领域都是规范的。\n- **适定性**：建立了一个具有足够边界条件和封闭模型的微分方程。输入是完整且一致的，确保了温度分布和斯坦顿数的唯一解。\n- **客观性**：问题以客观、定量的语言陈述，没有歧义或主观内容。\n\n该问题不违反任何有效性标准。为流体和流动指定的物理参数对于涉及湍流边界层的工程应用是现实的。所需的简化被明确说明为建模选择，并且在边界层分析中很常见。\n\n**步骤 3：结论和行动**\n该问题是**有效的**。将推导并实施一个解决方案。\n\n**斯坦顿数公式的推导**\n\n问题陈述，该流动被局部建模为一维壁面法向能量平衡。在给定的假设下（稳态、无源项、物性恒定、流向输运可忽略），RANS 能量方程简化为总壁面法向热通量在整个层内是恒定的：\n$$\n\\frac{d}{dy}\\left(q''_{\\text{mol}} + q''_{\\text{turb}}\\right) = 0\n$$\n其中 $q''_{\\text{mol}} = -k \\frac{dT}{dy}$ 是分子热通量，$q''_{\\text{turb}} = - \\rho c_p \\alpha_t \\frac{dT}{dy}$ 是根据梯度扩散假设的湍流热通量。因此，总热通量为：\n$$\nq''(y) = -k \\frac{dT}{dy} - \\rho c_p \\alpha_t \\frac{dT}{dy} = -(\\rho c_p \\alpha + \\rho c_p \\alpha_t) \\frac{dT}{dy}\n$$\n其中分子热扩散率定义为 $\\alpha = k/(\\rho c_p)$。由于总通量不随 $y$ 变化，它必须等于壁面热通量 $q''_w$。为简单起见，我们将 $q''_w$ 表示为 $q''$。\n$$\nq'' = -\\rho c_p (\\alpha + \\alpha_t(y)) \\frac{dT}{dy}\n$$\n这是一个关于温度分布 $T(y)$ 的一阶常微分方程。我们分离变量来求解 $T(y)$：\n$$\ndT = -\\frac{q''}{\\rho c_p} \\frac{1}{\\alpha + \\alpha_t(y)} dy\n$$\n我们在边界层上对该方程进行积分，从 $y=0$ 处的 $T(0)=T_w$ 到 $y=\\delta$ 处的 $T(\\delta)=T_b$：\n$$\n\\int_{T_w}^{T_b} dT' = \\int_0^\\delta \\left(-\\frac{q''}{\\rho c_p} \\frac{1}{\\alpha + \\alpha_t(y')}\\right) dy'\n$$\n$$\nT_b - T_w = -\\frac{q''}{\\rho c_p} \\int_0^\\delta \\frac{dy'}{\\alpha + \\alpha_t(y')}\n$$\n我们现在求解壁面热通量 $q''$：\n$$\nq'' = -\\frac{\\rho c_p (T_b - T_w)}{\\int_0^\\delta \\frac{dy}{\\alpha + \\alpha_t(y)}} = \\frac{\\rho c_p (T_w - T_b)}{\\int_0^\\delta \\frac{dy}{\\alpha + \\alpha_t(y)}}\n$$\n斯坦顿数定义为 $\\mathrm{St} = \\frac{q''}{\\rho c_p U_e (T_w - T_b)}$。代入我们推导出的 $q''$ 表达式得到：\n$$\n\\mathrm{St} = \\frac{1}{\\rho c_p U_e (T_w - T_b)} \\left[ \\frac{\\rho c_p (T_w - T_b)}{\\int_0^\\delta \\frac{dy}{\\alpha + \\alpha_t(y)}} \\right]\n$$\n项 $\\rho c_p (T_w - T_b)$ 消去，得到斯坦顿数的最终表达式：\n$$\n\\mathrm{St} = \\frac{1}{U_e \\int_0^\\delta \\frac{dy}{\\alpha + \\alpha_t(y)}}\n$$\n被积函数依赖于湍流热扩散率 $\\alpha_t(y)$，它通过封闭模型指定：\n$$\n\\alpha_t(y) = \\frac{\\nu_t(y)}{\\mathrm{Pr}_t(y)}\n$$\n其中涡粘性 $\\nu_t(y)$ 和湍流普朗特数 $\\mathrm{Pr}_t(y)$ 在问题陈述中给出。必须首先从给定的流体属性计算出派生属性，即运动粘度 $\\nu = \\mu/\\rho$ 和分子热扩散率 $\\alpha=k/(\\rho c_p)$。\n\n**数值实现**\n\n算法任务要求对每个测试案例和两种 $\\mathrm{Pr}_t$ 模型中的每一种进行积分的数值评估。\n1.  计算常数属性 $\\nu$ 和 $\\alpha$。\n2.  对于每个测试案例 $(U_e, u_\\tau, \\delta)$：\n3.  基于 van Driest 模型定义涡粘性函数 $\\nu_t(y)$。\n4.  对于常数 $\\mathrm{Pr}_t$ 模型，被积函数为 $f_1(y) = 1/(\\alpha + \\nu_t(y)/0.85)$。\n5.  对于变量 $\\mathrm{Pr}_t$ 模型，定义 $\\mathrm{Pr}_t(y) = 0.85 + 0.15 \\exp(-\\nu_t(y)/(5\\nu))$。被积函数为 $f_2(y) = 1/(\\alpha + \\nu_t(y)/\\mathrm{Pr}_t(y))$。\n6.  使用数值求积法计算积分 $I_1 = \\int_0^\\delta f_1(y) dy$ 和 $I_2 = \\int_0^\\delta f_2(y) dy$。\n7.  然后计算斯坦顿数，分别为 $\\mathrm{St}_{\\text{const}} = 1/(U_e I_1)$ 和 $\\mathrm{St}_{\\text{var}} = 1/(U_e I_2)$。\n8.  相对差异计算为 $(\\mathrm{St}_{\\text{var}} - \\mathrm{St}_{\\text{const}})/\\mathrm{St}_{\\text{const}}$。\n将每个案例的结果四舍五入并整理成指定的输出格式。此过程在提供的 Python 代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Derives and computes the Stanton number for turbulent flow over a heated wall\n    using two different models for the turbulent Prandtl number.\n    \"\"\"\n    \n    # Constants and Fluid Properties (SI units)\n    KAPPA = 0.41\n    A_PLUS = 26.0\n    \n    RHO = 1.2      # Density, kg/m^3\n    MU = 1.8e-5    # Dynamic viscosity, Pa.s\n    CP = 1006.0    # Specific heat at constant pressure, J/(kg.K)\n    K = 0.026      # Thermal conductivity, W/(m.K)\n    \n    # Derived properties\n    NU = MU / RHO                  # Kinematic viscosity, m^2/s\n    ALPHA = K / (RHO * CP)         # Molecular thermal diffusivity, m^2/s\n    \n    # Test suite from the problem statement\n    test_cases = [\n        # (Ue [m/s], u_tau [m/s], delta [m])\n        (10.0, 0.8, 0.010),  # Case 1\n        (10.0, 0.4, 0.012),  # Case 2\n        (10.0, 1.2, 0.008),  # Case 3\n        (8.0, 0.2, 0.006),   # Case 4\n    ]\n\n    def calculate_for_case(case):\n        \"\"\"\n        Performs the calculation for a single test case.\n        \"\"\"\n        Ue, u_tau, delta = case\n\n        # Eddy viscosity function, van Driest-damped mixing-length model\n        def nu_t(y):\n            if y == 0.0:\n                return 0.0\n            y_plus = y * u_tau / NU\n            damping_factor = 1.0 - np.exp(-y_plus / A_PLUS)\n            return KAPPA * u_tau * y * damping_factor**2\n\n        # --- Constant Pr_t model ---\n        PR_T_CONST = 0.85\n        def integrand_const(y):\n            # Turbulent thermal diffusivity for constant Pr_t\n            alpha_t_const = nu_t(y) / PR_T_CONST\n            return 1.0 / (ALPHA + alpha_t_const)\n        \n        integral_const, _ = quad(integrand_const, 0, delta)\n        st_const = 1.0 / (Ue * integral_const)\n\n        # --- Variable Pr_t model ---\n        def pr_t_var(y):\n            nut = nu_t(y)\n            # As y -> 0, nu_t -> 0, Re_t -> 0, Pr_t -> 1.0\n            if nut == 0.0:\n                return 1.0\n            re_t = nut / NU\n            return 0.85 + 0.15 * np.exp(-re_t / 5.0)\n\n        def integrand_var(y):\n            # Turbulent thermal diffusivity for variable Pr_t\n            alpha_t_var = nu_t(y) / pr_t_var(y)\n            return 1.0 / (ALPHA + alpha_t_var)\n\n        integral_var, _ = quad(integrand_var, 0, delta)\n        st_var = 1.0 / (Ue * integral_var)\n\n        # --- Relative Difference ---\n        # Handle st_const near zero to avoid division by zero error\n        if st_const == 0.0:\n            rel_diff = 0.0 \n        else:\n            rel_diff = (st_var - st_const) / st_const\n\n        return st_const, st_var, rel_diff\n\n    results = []\n    for case in test_cases:\n        st_const, st_var, rel_diff = calculate_for_case(case)\n        results.append(round(st_const, 6))\n        results.append(round(st_var, 6))\n        results.append(round(rel_diff, 6))\n\n    # Final print statement in the exact required format.\n    output_str = ','.join(map(str, results))\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2536139"}]}