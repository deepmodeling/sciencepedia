## 引言
[大涡模拟（LES）](@entry_id:273295)作为一种介于[直接数值模拟](@entry_id:149543)（DNS）与[雷诺平均纳维-斯托克斯](@entry_id:173045)（RANS）方法之间的高级[湍流模拟](@entry_id:187401)技术，在科学研究与工程设计中扮演着日益重要的角色。当[湍流](@entry_id:151300)与热量传递或物质混合等[标量输运](@entry_id:150360)过程耦合时，其复杂性进一步增加，准确预测这些现象对于优化燃烧效率、评估[污染物扩散](@entry_id:195534)以及理解地球物理过程至关重要。然而，LES的核心挑战在于如何精确地处理被滤波操作分离出去的、未被解析的亚格子尺度（SGS）运动对可解尺度标量场的影响——这便是著名的“亚格子尺度封闭问题”。

本文旨在系统性地阐述[标量输运](@entry_id:150360)[大涡模拟](@entry_id:153702)的理论与实践。在“原理与机制”一章中，我们将深入探讨滤波后的[标量输运](@entry_id:150360)方程，并详细介绍用于封闭该方程的核心思想，如涡[扩散模型](@entry_id:142185)和动态程序。随后，在“应用与跨学科连接”一章中，我们将通过环境科学、工程热物理和燃烧学等领域的生动案例，展示LES在解决前沿问题中的强大能力。最后，“动手实践”部分将提供具体的计算练习，帮助读者巩固理论知识并将其应用于实际问题中。

现在，让我们从构建[标量输运](@entry_id:150360)[大涡模拟](@entry_id:153702)的理论基石开始，深入探索其基本原理与核心机制。

## 原理与机制

在[大涡模拟 (LES)](@entry_id:751142) 中，我们的目标是直接求解大尺度、携带能量的[湍流](@entry_id:151300)运动，同时对小尺度、更具普遍性的亚格子尺度 (SGS) 运动的影响进行建模。本章将详细阐述将该思想应用于[标量输运](@entry_id:150360)（如热量或物质浓度传递）的基本原理，并探讨用于封闭经滤波后方程的关键机制。

### 滤波后的[标量输运](@entry_id:150360)方程

[大涡模拟](@entry_id:153702)的核心是一种[尺度分离](@entry_id:270204)方法，介于[雷诺平均纳维-斯托克斯](@entry_id:173045) (RANS) 方法（对所有[湍流](@entry_id:151300)尺度进行建模）和[直接数值模拟 (DNS)](@entry_id:263208) 方法（解析所有[湍流](@entry_id:151300)尺度）之间。LES 通过[空间滤波](@entry_id:202429)将流场变量 $\phi(\boldsymbol{x},t)$ 分解为可解的（或滤波的）尺度分量 $\bar{\phi}(\boldsymbol{x},t)$ 和不可解的亚格子尺度 (SGS) 分量 $\phi'(\boldsymbol{x},t)$ [@problem_id:2477608]。

#### 滤波操作及其性质

最基本的滤波操作是与滤波[核函数](@entry_id:145324) $G_{\Delta}(\boldsymbol{r})$ 的卷积，其特征宽度为 $\Delta$：
$$
\bar{\phi}(\boldsymbol{x},t) = \int_{\mathbb{R}^d} G_{\Delta}(\boldsymbol{r}) \phi(\boldsymbol{x}-\boldsymbol{r},t) \, \mathrm{d}\boldsymbol{r}
$$
其中 $\boldsymbol{x}$ 是空间位置， $t$ 是时间。为了使滤波后的方程具有良好的数学性质，并能准确反映可解尺度的物理过程，滤波核 $G_{\Delta}$ 应满足几个关键条件 [@problem_id:2500611]：

1.  **线性性**: 卷积操作本身是线性的，这意味着 $\overline{a\phi_1 + b\phi_2} = a\bar{\phi}_1 + b\bar{\phi}_2$。这是[积分算子](@entry_id:262332)固有的性质。

2.  **归一化**: 滤波操作不应改变一个常数场。这意味着如果 $\phi(\boldsymbol{x},t) = C$，那么 $\bar{\phi}(\boldsymbol{x},t) = C$。这要求滤波核的积分为1：
    $$
    \int_{\mathbb{R}^d} G_{\Delta}(\boldsymbol{r}) \, \mathrm{d}\boldsymbol{r} = 1
    $$
    此条件保证了滤波操作的守恒性。

3.  **与[常系数](@entry_id:269842)[微分](@entry_id:158718)的交换性**: 为了能够推导形式简洁的滤波后控制方程，我们希望滤波操作可以与时间及空间导数互换，即 $\overline{\partial \phi / \partial x_i} = \partial \bar{\phi} / \partial x_i$。当滤波核 $G_{\Delta}$ 不依赖于空间位置 $\boldsymbol{x}$（即空间不变性），并且在无界或周期性域中进行滤波以避免边界项时，此性质成立。

#### 亚格子尺度标量通量

我们从瞬时的不可压缩[标量输运](@entry_id:150360)方程出发：
$$
\frac{\partial \theta}{\partial t} + \frac{\partial (u_j \theta)}{\partial x_j} = \kappa \frac{\partial^2 \theta}{\partial x_j \partial x_j}
$$
其中 $\theta$ 是标量（如温度），$u_j$ 是速度分量，$\kappa$ 是[分子扩散系数](@entry_id:752110)。对该方程应用满足上述性质的滤波操作，我们得到：
$$
\frac{\partial \bar{\theta}}{\partial t} + \frac{\partial \overline{u_j \theta}}{\partial x_j} = \kappa \frac{\partial^2 \bar{\theta}}{\partial x_j \partial x_j}
$$
注意，由于[对流](@entry_id:141806)项 $u_j \theta$ 的[非线性](@entry_id:637147)，我们得到了滤波后的乘积项 $\overline{u_j \theta}$，它不等于滤波后变量的乘积 $\bar{u}_j \bar{\theta}$。为了得到关于可解变量 $\bar{u}_j$ 和 $\bar{\theta}$ 的方程，我们将 $\overline{u_j \theta}$ 分解：
$$
\overline{u_j \theta} = \bar{u}_j \bar{\theta} + (\overline{u_j \theta} - \bar{u}_j \bar{\theta})
$$
最后一项被称为**亚格子尺度 (SGS) 标量通量**，记作 $q_j^{\text{sgs}}$：
$$
q_j^{\text{sgs}} \equiv \overline{u_j \theta} - \bar{u}_j \bar{\theta}
$$
这个通量代表了不可解的亚格子尺度运动对可解尺度[标量场](@entry_id:151443)的输运效应。将这个定义代入滤波后的方程，我们得到[大涡模拟](@entry_id:153702)需求解的最终形式：
$$
\frac{\partial \bar{\theta}}{\partial t} + \frac{\partial (\bar{u}_j \bar{\theta})}{\partial x_j} = -\frac{\partial q_j^{\text{sgs}}}{\partial x_j} + \kappa \frac{\partial^2 \bar{\theta}}{\partial x_j \partial x_j}
$$
该方程中的 $q_j^{\text{sgs}}$ 是一个未知量，因为它依赖于未被解析的瞬时场。因此，LES 的核心挑战在于为 $q_j^{\text{sgs}}$ 构建一个**封闭模型**，即用可解场 $\bar{u}_j$ 和 $\bar{\theta}$ 来表示它。

#### 滤波操作的复杂性

在理想化的周期性或无界域中，使用空间不变的滤波器可以保证[交换性](@entry_id:140240)。然而，在更现实的流动中，会出现一些复杂情况。

**非均匀滤波**: 在[壁面束缚流](@entry_id:153603)动中，网格通常向壁面加密，导致滤波宽度 $\Delta$ 随空间位置变化，即 $\Delta = \Delta(y)$。此时，滤波与[微分](@entry_id:158718)不再交换。它们之间的差异，即**交换误差** $E(y) \equiv \partial \bar{\theta} / \partial y - \overline{\partial \theta / \partial y}$，可以通过[泰勒展开](@entry_id:145057)进行估计 [@problem_id:2500583]。对于一维顶帽滤波器，可以证明其主阶项为：
$$
E(y) \approx \frac{\Delta(y)}{12} \frac{\partial \Delta}{\partial y} \frac{\partial^2 \bar{\theta}}{\partial y^2}
$$
这个误差项依赖于滤波宽度的梯度和可解标量场的[二阶导数](@entry_id:144508)。在壁面附近，这两个量都可能很大，因此交换误差可能变得非常显著，需要更高级的[离散化方法](@entry_id:272547)或模型来处理。

**[可压缩流](@entry_id:747589)动**: 在密度 $\rho$ 变化的流动中（例如，燃烧或[高超声速流](@entry_id:263090)动），直接对[守恒变量](@entry_id:747720)进行滤波会导致复杂的未封闭项。为了简化方程，通常采用**法沃尔 (Favre) 滤波**或质量加权滤波，其定义为 $\tilde{\phi} \equiv \overline{\rho \phi} / \bar{\rho}$。在这种框架下，SGS 标量通量被定义为 $q_j^{\text{sgs}} = \overline{\rho u_j \theta} - \bar{\rho} \tilde{u}_j \tilde{\theta}$。这个定义与常规的雷诺滤波通量 $\tau_j^\theta = \overline{u_j \theta} - \bar{u}_j \bar{\theta}$ 不同。两者之间的关系依赖于密度与速度和标量的亚格子相关性 [@problem_id:2500541]。只有在不可压缩（常密度）流动中，$\rho' = 0$，法沃尔滤波才等同于雷诺滤波，两种 SGS 通量定义才趋于一致。

### 封闭问题：亚格子尺度标量通量的建模

如上所述，为了使滤波后的[标量输运](@entry_id:150360)方程可解，必须为 SGS 标量通量 $q_j^{\text{sgs}}$ 提供一个模型。SGS 模型的目标是利用已知的可解场信息来近似 $q_j^{\text{sgs}}$。这些模型大致可分为两类：功能型模型和结[构型模型](@entry_id:747676)。

#### 功能型模型：涡[扩散](@entry_id:141445)思想

最广泛使用的一类模型是**功能型模型**，它们基于涡[扩散](@entry_id:141445)假设。该假设认为，小尺度[湍流](@entry_id:151300)对大尺度标量的输运效应类似于[分子扩散](@entry_id:154595)，即通量与标量梯度成正比。这被称为**梯度[扩散](@entry_id:141445)假设**：
$$
q_j^{\text{sgs}} = - K_{ij}^{\text{sgs}} \frac{\partial \bar{\theta}}{\partial x_i}
$$
其中 $K_{ij}^{\text{sgs}}$ 是 SGS 涡[扩散](@entry_id:141445)系数张量。在最简单的情况下，假设亚格子尺度[湍流](@entry_id:151300)是各向同性的，该张量简化为一个标量 $\alpha_t$（涡[热扩散](@entry_id:148740)系数）乘以单位张量，即 $K_{ij}^{\text{sgs}} = \alpha_t \delta_{ij}$。模型变为：
$$
q_j^{\text{sgs}} = - \alpha_t \frac{\partial \bar{\theta}}{\partial x_j}
$$
这个模型的核心问题就转化为如何对涡[扩散](@entry_id:141445)系数 $\alpha_t$ 进行建模。

**亚格子尺度的雷诺比拟**: 解决 $\alpha_t$ 建模问题的一个常用方法是借助所谓的**亚格子尺度雷诺比拟** [@problem_id:2500578]。这种思想假设，输运标量（热量或物质）的亚格子[湍流](@entry_id:151300)机制与输运可解尺度动量的机制是相似的。动量的 SGS 输运由 SGS [应力张量](@entry_id:148973) $\tau_{ij}$ 描述，其模型通常引入一个涡粘性系数 $\nu_t$。通过定义一个**[湍流普朗特数](@entry_id:153739)** $Pr_t$ (对于热量) 或**[湍流施密特数](@entry_id:150226)** $Sc_t$ (对于物质)，我们可以将 $\alpha_t$ 与 $\nu_t$ 联系起来：
$$
Pr_t = \frac{\nu_t}{\alpha_t} \quad \text{and} \quad Sc_t = \frac{\nu_t}{D_t}
$$
其中 $D_t$ 是涡[质量扩散系数](@entry_id:149206)。值得强调的是，$Pr_t$ 和 $Sc_t$ 不是流体的基本属性，而是**模型参数** [@problem_id:2536156]。它们源于梯度[扩散](@entry_id:141445)的建模假设，其数值可以依赖于[流态](@entry_id:152820)、雷诺数和滤波宽度。尽管如此，在许多应用中，将它们视为常数（例如，空气中 $Pr_t \approx 0.85$）是一种有效且广泛采用的简化。

**Smagorinsky-Lilly 标量模型**: 一个经典的例子是将上述思想应用于 Smagorinsky 涡粘模型。该模型提出 $\nu_t = (C_s \Delta)^2 |\bar{S}|$，其中 $C_s$ 是 Smagorinsky 常数，$\Delta$ 是滤波宽度，$|\bar{S}| = (2\bar{S}_{ij}\bar{S}_{ij})^{1/2}$ 是可解[应变率张量](@entry_id:266108)的大小。结合常数 $Pr_t$ 假设，我们得到 SGS 标量通量模型：
$$
q_j^{\text{sgs}} = - \frac{(C_s \Delta)^2 |\bar{S}|}{Pr_t} \frac{\partial \bar{\theta}}{\partial x_j}
$$
这个模型虽然简单，但揭示了功能型模型的关键缺陷。例如，在一个槽道流中，即使在壁面处，平均剪切率也不为零，导致 $|\bar{S}|$ 和 $\nu_t$ 在壁面处为非零值 [@problem_id:2500586]。这不符合物理实际，因为所有[湍流输运](@entry_id:150198)都必须在固壁上消失。这表明，标准 Smagorinsky 模型需要修正，如引入壁面阻尼函数。

#### 动态模型

Smagorinsky 模型的主要缺点是模型系数 $C_s$（以及 $Pr_t$）需要用户预先指定，并且它不是普适的。**动态程序**通过利用模拟过程中可用的信息来实时、局部地[计算模型](@entry_id:152639)系数，从而克服了这一限制 [@problem_id:2500566]。

动态程序的基本思想是引入一个比网格滤波更粗的**测试滤波器**（用 $\hat{\cdot}$ 表示）。通过对滤波后的方程再次滤波，可以得到两个不同尺度上的 SGS 项之间的关系，即所谓的**Germano 恒等式**。对于[标量输运](@entry_id:150360)，该恒等式为 $L_j = T_j - \hat{q}_j$，其中：
- $L_j = \widehat{\bar{u}_j \bar{\theta}} - \hat{\bar{u}}_j \hat{\bar{\theta}}$ 是 **Leonard 项**，代表可解尺度之间的输运，完全由可解场计算得出。
- $T_j$ 和 $q_j$ 分别是测试尺度和网格尺度的 SGS 通量，是未知的。

假设 Smagorinsky 形式的模型在两个尺度上都成立，只是滤波宽度不同（$\Delta$ 和 $\hat{\Delta} = \alpha \Delta$），我们就可以建立一个关于模型系数 $C_\theta$（它整合了 $C_s^2/Pr_t$）的[代数方程](@entry_id:272665)：
$$
L_j \approx C_\theta M_j
$$
其中 $M_j$ 是一个包含可解场在两个尺度上组合的复杂表达式。由于这是一个[超定系统](@entry_id:151204)（在三维空间中有3个方程，1个未知数），可以通过[最小二乘法](@entry_id:137100)求解 $C_\theta$：
$$
C_\theta = \frac{L_j M_j}{M_k M_k}
$$
在实际操作中，为避免分母为零导致的[数值不稳定性](@entry_id:137058)，通常会在求比值之前对分子和分母进行[空间平均](@entry_id:203499)。此外，计算出的 $C_\theta$ 可能会出现物理上不合理的负值（代表能量从亚格子反传给可解尺度，即**[反向散射](@entry_id:142561)**），这可能导致模拟发散。因此，通常需要对系数进行**裁剪**（例如，强制 $C_\theta \ge 0$）以保证[数值稳定性](@entry_id:146550)。

### 高级主题与实际挑战

虽然涡[扩散模型](@entry_id:142185)（尤其是动态版本）在许多应用中非常成功，但在某些[复杂流动](@entry_id:747569)中，其底层的物理假设会受到挑战，从而引发了一系列高级建模问题。

#### 壁面建模

如前所述，标准模型在近壁区的行为是不正确的。除了使用动态模型或阻尼函数，另一个关键问题是壁面解析度。为了准确预测壁面[热通量](@entry_id:138471)，LES 网格必须足够细，以解析所谓的**粘性-传导子层**。该层的厚度 $y_T^+$ 不仅取决于雷诺数，还强烈依赖于流体的分子**[普朗特数](@entry_id:143303)** $Pr$ [@problem_id:2477608]。

对于高 $Pr$ 数流体（如水或油），标量场的最小尺度（[巴彻勒尺度](@entry_id:150497)）远小于动量场的最小尺度（柯尔莫哥洛夫尺度）。因此，解析速度场所需的网格对于解析温度场来说可能过于粗糙。通过对近壁区能量方程的[渐近分析](@entry_id:160416)，可以估算出第一个离壁网格点所需的最大高度 $\Delta y^+$ [@problem_id:2500543]。对于给定的壁面[热通量](@entry_id:138471)[预测误差](@entry_id:753692) $\varepsilon$，可以推导出如下关系：
$$
\Delta y^+ \approx \left(\frac{4\varepsilon(A^+)^2 Pr_t}{\kappa Pr}\right)^{1/3}
$$
其中 $\kappa$ 是[冯·卡门常数](@entry_id:261117)，$A^+$ 是范德里斯特阻尼常数。这个公式明确显示，对于高 $Pr$ 流体，要达到可接受的精度，需要极高的壁面法向解析度（即非常小的 $\Delta y^+$ 值）。

#### 各向异性效应

梯度扩散模型的基本假设是亚格子[湍流](@entry_id:151300)是局部各向同性的。然而，在许多流动中，这种假设不成立。

**物理各向异性**: 在受系统旋转或稳定分层影响的流动中（如地球物理或天体物理流动），[浮力](@entry_id:144145)和[科里奥利力](@entry_id:160096)会抑制垂直方向的运动，使湍流涡旋呈现出扁平的“薄饼状”或拉长的“柱状”结构。在这种强烈的[各向异性湍流](@entry_id:746462)中，SGS 标量通量的方向可能不再与负标量梯度方向平行。可能会出现**侧向梯度 (cross-gradient) 输运**，即[通量矢量](@entry_id:273577)垂直于梯度矢量，甚至出现**逆梯度 (counter-gradient) 输运** [@problem_id:2500591]。这使得简单的涡扩散模型完全失效。利用测试滤波和 Leonard 项，可以构造一个诊断量来检测和量化这种模型与物理现实的偏离。

**网格诱导的各向异性**: 即使在物理上各向同性的[湍流](@entry_id:151300)中，如果计算网格本身是各向异性的（例如，在[边界层](@entry_id:139416)中使用的[拉伸网格](@entry_id:755520)），模型也必须正确地反映这种几何各向异性，以保持**客观性**（即模型不应依赖于[坐标系](@entry_id:156346)的选择）。一个简单的、使用各向同性有效滤波宽度 $\Delta_e = (\Delta_1 \Delta_2 \Delta_3)^{1/3}$ 的模型虽然满足基本要求，但它错误地假设了涡扩散过程是各向同性的。一个更严谨的方法是构造一个张量形式的涡[扩散](@entry_id:141445)系数 $K_{ij}^{\text{sgs}}$，它直接依赖于网格[度规张量](@entry_id:160222)，以确保模型在[坐标旋转](@entry_id:164444)下具有正确的变换性质 [@problem_id:2500562]。

#### [反向散射](@entry_id:142561)与[模型稳定性](@entry_id:636221)

功能型模型通过设计保证了 SGS 耗散 $\epsilon_\theta^{\text{sgs}} \equiv -q_j^{\text{sgs}} \partial_j \bar{\theta}$ 总是非负的，这意味着标量[方差](@entry_id:200758)总是从可解尺度向亚格子尺度净转移。然而，真实的[湍流](@entry_id:151300)物理过程包含间歇性的**[反向散射](@entry_id:142561)**事件，即能量从 小尺度返回到大尺度。

另一类称为**结[构型模型](@entry_id:747676)**（如[尺度相似性](@entry_id:754548)模型）的模型，通过在可解尺度上重构通量结构来近似 $q_j^{\text{sgs}}$。这类模型能够更好地预测真实的 SGS 通量，并能自然地产生[反向散射](@entry_id:142561)。然而，过度的、不受控制的[反向散射](@entry_id:142561)可能导致[数值模拟](@entry_id:137087)的不稳定。因此，现代 LES [标量输运](@entry_id:150360)模型的发展趋势是**[混合模型](@entry_id:266571)** [@problem_id:2500546]，它结合了结[构型模型](@entry_id:747676)的高保真度和功能型模型的[数值稳定性](@entry_id:146550)，通过各种方式来控制[反向散射](@entry_id:142561)的强度，从而在保证物理真实性的同时维持计算的鲁棒性。