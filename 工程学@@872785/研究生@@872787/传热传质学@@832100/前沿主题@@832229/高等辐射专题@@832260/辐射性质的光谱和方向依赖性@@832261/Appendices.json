{"hands_on_practices": [{"introduction": "真实表面的热辐射特性通常既依赖于波长，也依赖于方向。理解如何从详细的方向分布中获得特定测量配置下的有效属性是一项基本技能。本练习旨在通过一个假设的方向光谱发射率模型，推导出一个具有锥形视场的辐射计所测量的表观光谱发射率 [@problem_id:2524153]。通过这个实践，你将掌握对方向相关的辐射量进行立体角积分，并将其与黑体辐射进行比较以定义有效属性的核心方法。", "problem": "一个温度为 $T$ 的不透明等温固体表面，其热辐射表现出谱向依赖性。在每个波长 $\\lambda$ 处，其辐射亮度意义上的方向谱发射率（方向谱强度发射率）由以下模型给出：\n$$\n\\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\;=\\; \\varepsilon_{0}(\\lambda)\\,\\bigl[1 + a(\\lambda)\\,\\cos^{2}\\theta\\bigr]\\,\\bigl[1 + b\\,\\cos(2\\phi)\\,\\sin^{2}\\theta\\bigr],\n$$\n其中，$(\\theta,\\phi)$ 分别是从表面法线和一个固定的平面内参考方向测量的极角和方位角，$\\varepsilon_{0}(\\lambda)\\in[0,1]$ 是一个基准谱因子，$a(\\lambda)$ 是一个有界的极向谱各向异性系数，$b$ 是一个有界的方位各向异性系数。假设参数满足在所有 $\\theta\\in[0,\\pi/2]$ 和 $\\phi\\in[0,2\\pi)$ 下，都有 $0 \\le \\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\le 1$。\n\n仅从谱强度、谱发射功率、黑体辐射和立体角积分的基本定义出发，推导一个闭式解析表达式，用于描述由一个理想窄带辐射计测量的锥场表观谱发射率 $\\varepsilon_{app,\\lambda}(\\theta_{c})$。该辐射计以波长 $\\lambda$ 为中心，收集从表面法线周围半角为 $\\theta_{c}$ 的正圆锥视场内出射的所有辐射通量。探测器的信号与其收集立体角内的辐射出射度成正比，即谱强度在锥形立体角上按余弦投影因子加权的积分。将表观谱发射率定义为该信号与从相同温度 $T$ 的黑体获得的相应信号之比。取立体角微元为 $\\mathrm{d}\\Omega = \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。将你的最终答案表示为 $\\varepsilon_{0}(\\lambda)$、$a(\\lambda)$、$b$ 和 $\\theta_{c}$ 的简化函数，其中 $\\theta_{c}$ 以弧度为单位。最终答案必须是单一的闭式解析表达式。不要提供中间结果。", "solution": "问题陈述已经过验证，被认为是科学上合理、适定且客观的。这是一个辐射传热中的规范问题，其内容自洽，没有矛盾或歧义。它要求从基本定义和一个给定的数学模型推导出一个物理量，这是理论物理和工程学中的标准程序。因此，将给出解答。\n\n问题要求推导锥场表观谱发射率 $\\varepsilon_{app,\\lambda}(\\theta_{c})$。根据定义，这是探测器从给定表面收集的辐射通量与在相同锥形视场内从相同温度 $T$ 的黑体收集的通量之比。\n\n探测器收集的辐射通量（或“信号”）与锥形辐射出射度成正比，即谱强度 $I_{\\lambda,e}$ 在收集立体角 $\\Omega_c$ 上按极角余弦 $\\cos\\theta$ 加权的积分。对于给定表面，收集到的通量 $S_{\\lambda}$ 正比于\n$$\nS_{\\lambda} \\propto \\int_{\\Omega_c} I_{\\lambda,e}(\\theta, \\phi) \\cos\\theta \\, \\mathrm{d}\\Omega\n$$\n发射体的谱强度定义为其方向谱发射率 $\\varepsilon^{I}_{\\lambda}(\\theta,\\phi)$ 与相同温度下黑体的谱强度 $I_{b,\\lambda}(T)$ 的乘积。黑体强度是各向同性的（与方向无关）。\n$$\nI_{\\lambda,e}(\\theta, \\phi) = \\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\, I_{b,\\lambda}(T)\n$$\n因此，来自表面的信号正比于\n$$\nS_{\\lambda} \\propto I_{b,\\lambda}(T) \\int_{\\Omega_c} \\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\cos\\theta \\, \\mathrm{d}\\Omega\n$$\n对于黑体表面，发射率为1，即 $\\varepsilon^{I}_{\\lambda}(\\theta,\\phi) = 1$。因此，来自黑体的信号 $S_{b,\\lambda}$ 正比于\n$$\nS_{b,\\lambda} \\propto I_{b,\\lambda}(T) \\int_{\\Omega_c} (1) \\cos\\theta \\, \\mathrm{d}\\Omega\n$$\n表观谱发射率 $\\varepsilon_{app,\\lambda}(\\theta_{c})$ 是这两个信号的比值。比例常数和黑体强度 $I_{b,\\lambda}(T)$ 会消掉。\n$$\n\\varepsilon_{app,\\lambda}(\\theta_{c}) = \\frac{ S_{\\lambda} }{ S_{b,\\lambda} } = \\frac{\\int_{\\Omega_c} \\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\cos\\theta \\, \\mathrm{d}\\Omega}{\\int_{\\Omega_c} \\cos\\theta \\, \\mathrm{d}\\Omega}\n$$\n积分是在半角为 $\\theta_c$ 的正圆锥上进行的。立体角微元为 $\\mathrm{d}\\Omega = \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。积分限为 $\\theta \\in [0, \\theta_c]$ 和 $\\phi \\in [0, 2\\pi]$。\n\n首先，我们计算分母中的积分，记为 $D$。\n$$\nD = \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\cos\\theta \\sin\\theta \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n对 $\\phi$ 的积分得出 $2\\pi$。对 $\\theta$ 的积分是\n$$\n\\int_{0}^{\\theta_c} \\sin\\theta \\cos\\theta \\, \\mathrm{d}\\theta = \\frac{1}{2} \\int_{0}^{\\theta_c} \\sin(2\\theta) \\, \\mathrm{d}\\theta = \\frac{1}{2} \\left[ -\\frac{\\cos(2\\theta)}{2} \\right]_{0}^{\\theta_c} = \\frac{1}{4} (1 - \\cos(2\\theta_c)) = \\frac{1}{4} (1 - (1 - 2\\sin^2\\theta_c)) = \\frac{1}{2}\\sin^2\\theta_c\n$$\n或者，使用换元法 $u=\\sin\\theta$, $\\mathrm{d}u=\\cos\\theta\\,\\mathrm{d}\\theta$：\n$$\n\\int_{0}^{\\sin\\theta_c} u\\,\\mathrm{d}u = \\left[\\frac{u^2}{2}\\right]_{0}^{\\sin\\theta_c} = \\frac{1}{2}\\sin^2\\theta_c\n$$\n因此，分母是 $D = 2\\pi \\cdot \\frac{1}{2}\\sin^2\\theta_c = \\pi\\sin^2\\theta_c$。\n\n接下来，我们计算分子中的积分，记为 $N$。\n$$\nN = \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\varepsilon^{I}_{\\lambda}(\\theta,\\phi) \\cos\\theta \\sin\\theta \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n代入给定的 $\\varepsilon^{I}_{\\lambda}(\\theta,\\phi)$ 表达式：\n$$\nN = \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\varepsilon_{0}(\\lambda)\\,\\bigl[1 + a(\\lambda)\\,\\cos^{2}\\theta\\bigr]\\,\\bigl[1 + b\\,\\cos(2\\phi)\\,\\sin^{2}\\theta\\bigr] \\cos\\theta \\sin\\theta \\, \\mathrm{d}\\theta \\, \\mathrm{d}\\phi\n$$\n我们展开被积函数：\n$$\n\\varepsilon^{I}_{\\lambda}(\\theta,\\phi) = \\varepsilon_{0}(\\lambda) \\left[ 1 + a(\\lambda)\\cos^2\\theta + b\\cos(2\\phi)\\sin^2\\theta + a(\\lambda)b\\cos(2\\phi)\\sin^2\\theta\\cos^2\\theta \\right]\n$$\n积分 $N$ 可以分为四项。我们可以将常数 $\\varepsilon_{0}(\\lambda)$ 提到积分外面。\n$$\nN = \\varepsilon_{0}(\\lambda) \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\left( \\sin\\theta\\cos\\theta + a(\\lambda)\\sin\\theta\\cos^3\\theta + b\\cos(2\\phi)\\sin^3\\theta\\cos\\theta + a(\\lambda)b\\cos(2\\phi)\\sin^3\\theta\\cos^3\\theta \\right) \\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\n对于任何包含 $\\cos(2\\phi)$ 的项，其在 $\\phi$ 上从 $0$ 到 $2\\pi$ 的积分都为零：\n$$\n\\int_{0}^{2\\pi} \\cos(2\\phi) \\, \\mathrm{d}\\phi = \\left[ \\frac{1}{2}\\sin(2\\phi) \\right]_{0}^{2\\pi} = 0\n$$\n因此，被积函数的第三项和第四项对总积分没有贡献。由于积分区域的轴对称性，方位各向异性系数 $b$ 不会出现在最终结果中。$N$ 的表达式简化为：\n$$\nN = \\varepsilon_{0}(\\lambda) \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\left( \\sin\\theta\\cos\\theta + a(\\lambda)\\sin\\theta\\cos^3\\theta \\right) \\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\n这是两个积分的和。第一部分是：\n$$\nI_1 = \\varepsilon_{0}(\\lambda) \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\sin\\theta\\cos\\theta \\, \\mathrm{d}\\theta\\,\\mathrm{d}\\phi = \\varepsilon_{0}(\\lambda) \\cdot (\\pi\\sin^2\\theta_c)\n$$\n第二部分是：\n$$\nI_2 = \\varepsilon_{0}(\\lambda) a(\\lambda) \\int_{0}^{2\\pi} \\int_{0}^{\\theta_c} \\sin\\theta\\cos^3\\theta \\, \\mathrm{d}\\theta\\,\\mathrm{d}\\phi\n$$\n$\\phi$ 的积分是 $2\\pi$。$\\theta$ 的积分通过换元法 $u=\\cos\\theta$, $\\mathrm{d}u=-\\sin\\theta\\,\\mathrm{d}\\theta$ 求解：\n$$\n\\int_{0}^{\\theta_c} \\sin\\theta\\cos^3\\theta\\,\\mathrm{d}\\theta = \\int_{\\cos(0)}^{\\cos(\\theta_c)} -u^3\\,\\mathrm{d}u = -\\left[\\frac{u^4}{4}\\right]_{1}^{\\cos\\theta_c} = -\\left(\\frac{\\cos^4\\theta_c}{4} - \\frac{1}{4}\\right) = \\frac{1}{4}(1-\\cos^4\\theta_c)\n$$\n所以，$I_2 = \\varepsilon_{0}(\\lambda) a(\\lambda) \\cdot 2\\pi \\cdot \\frac{1}{4}(1-\\cos^4\\theta_c) = \\varepsilon_{0}(\\lambda) \\frac{\\pi a(\\lambda)}{2}(1-\\cos^4\\theta_c)$。\n分子是 $N = I_1 + I_2 = \\varepsilon_{0}(\\lambda)\\pi\\sin^2\\theta_c + \\varepsilon_{0}(\\lambda) \\frac{\\pi a(\\lambda)}{2}(1-\\cos^4\\theta_c)$。\n\n现在我们计算比值 $\\varepsilon_{app,\\lambda}(\\theta_{c}) = N/D$：\n$$\n\\varepsilon_{app,\\lambda}(\\theta_{c}) = \\frac{\\varepsilon_{0}(\\lambda)\\pi\\sin^2\\theta_c + \\varepsilon_{0}(\\lambda) \\frac{\\pi a(\\lambda)}{2}(1-\\cos^4\\theta_c)}{\\pi\\sin^2\\theta_c}\n$$\n消去 $\\pi$ 并提出因子 $\\varepsilon_{0}(\\lambda)$：\n$$\n\\varepsilon_{app,\\lambda}(\\theta_{c}) = \\varepsilon_{0}(\\lambda) \\left( \\frac{\\sin^2\\theta_c}{\\sin^2\\theta_c} + \\frac{a(\\lambda)}{2} \\frac{1-\\cos^4\\theta_c}{\\sin^2\\theta_c} \\right) = \\varepsilon_{0}(\\lambda) \\left( 1 + \\frac{a(\\lambda)}{2} \\frac{1-\\cos^4\\theta_c}{\\sin^2\\theta_c} \\right)\n$$\n我们使用恒等式 $1-\\cos^4\\theta_c = (1-\\cos^2\\theta_c)(1+\\cos^2\\theta_c) = \\sin^2\\theta_c(1+\\cos^2\\theta_c)$ 来简化分数。\n$$\n\\frac{1-\\cos^4\\theta_c}{\\sin^2\\theta_c} = \\frac{\\sin^2\\theta_c(1+\\cos^2\\theta_c)}{\\sin^2\\theta_c} = 1+\\cos^2\\theta_c\n$$\n将此代回 $\\varepsilon_{app,\\lambda}(\\theta_{c})$ 的表达式，得到最终的闭式结果。\n$$\n\\varepsilon_{app,\\lambda}(\\theta_{c}) = \\varepsilon_{0}(\\lambda) \\left[ 1 + \\frac{a(\\lambda)}{2} (1 + \\cos^2\\theta_c) \\right]\n$$\n这就是所要求的关于 $\\varepsilon_{0}(\\lambda)$、$a(\\lambda)$ 和 $\\theta_{c}$ 的简化函数。", "answer": "$$\n\\boxed{\\varepsilon_{0}(\\lambda) \\left[1 + \\frac{a(\\lambda)}{2} \\left(1 + \\cos^{2}\\theta_{c}\\right)\\right]}\n$$", "id": "2524153"}, {"introduction": "双向反射分布函数（BRDF）是描述表面反射特性的基本物理量。在工程和科学领域，我们常常使用参数化的BRDF模型来拟合实验数据或进行仿真。这个练习将带你实践如何从一个给定的BRDF模型出发，通过积分推导出方向-半球反射率 [@problem_id:2524141]。更进一步，你将利用一个已知的测量值来反解模型中的一个关键参数，这个过程完美体现了理论模型与实际测量相结合的应用方法。", "problem": "在波长$\\lambda$下，一个双向散射分布函数（BSDF）由双向反射分布函数（BRDF）$f_{r,\\lambda}$和双向透射分布函数（BTDF）$f_{t,\\lambda}$组成。对于一个不透明、不发射、宏观光滑但微观粗糙的表面，BTDF消失，因此BSDF简化为BRDF。考虑以下方位各向异性、互易的光谱BRDF模型：\n$$\nf_{r,\\lambda}\\!\\left(\\theta_{i},\\phi_{i}\\rightarrow\\theta_{o},\\phi_{o}\\right)\n=\nA(\\lambda)\\,\\big(\\cos\\theta_{i}\\cos\\theta_{o}\\big)^{n}\\,g\\!\\left(\\phi_{o}-\\phi_{i}\\right),\n\\quad 0\\le \\theta_{o}\\le \\frac{\\pi}{2},\n$$\n当$\\theta_{o}>\\frac{\\pi}{2}$时，$f_{r,\\lambda}=0$。其中$g(\\Delta\\phi)=(1+b\\cos\\Delta\\phi)/(2\\pi)$，且$|b|\\le 1$，$n> -1$是一个给定的指数。角度$\\theta$是相对于表面法线测量的，$\\phi$是围绕法线的方位角。函数$g$被归一化，使得$\\int_{0}^{2\\pi} g(\\Delta\\phi)\\,d\\Delta\\phi=1$。幅度$A(\\lambda)$的单位是$\\mathrm{sr}^{-1}$。\n\n一束波长为$\\lambda_{0}=1.55\\,\\mu\\mathrm{m}$的准直单色光束从方向$(\\theta_{i},\\phi_{i})=(60^{\\circ},0)$入射到该表面，在该入射条件下测得的光谱方向-半球反射率为$\\rho_{\\lambda_{0}}(\\theta_{i}=60^{\\circ})=0.2$。表面在$\\lambda_{0}$处的参数为$n=1$和$b=\\tfrac{1}{2}$。\n\n仅使用基本的辐射度学定义和BSDF形式体系，推导由给定BRDF所隐含的光谱方向-半球反射率$\\rho_{\\lambda}(\\theta_{i})$的表达式，并用它来确定$A(\\lambda_{0})$的数值。用$\\mathrm{sr}^{-1}$表示您的最终答案，并将结果四舍五入到四位有效数字。在任何积分中，角度都应以弧度处理；给定的$60^{\\circ}$可通过$\\cos 60^{\\circ}=\\tfrac{1}{2}$来使用。", "solution": "问题陈述经评估，具有科学依据，提法恰当且内部一致。它提出了辐射传热领域中的一个标准问题，可以从基本定义出发求解。我们可以开始求解。\n\n第一步是根据光谱方向-半球反射率$\\rho_{\\lambda}(\\theta_{i}, \\phi_{i})$以双向反射分布函数（BRDF）$f_{r,\\lambda}$表示的基本定义来推导其表达式。反射率是反射辐射亮度在出射方向半球上的积分，它与BRDF的关系如下：\n$$\n\\rho_{\\lambda}(\\theta_{i}, \\phi_{i}) = \\int_{\\Omega_{o}} f_{r,\\lambda}(\\theta_{i}, \\phi_{i} \\rightarrow \\theta_{o}, \\phi_{o}) \\cos\\theta_{o} d\\Omega_{o}\n$$\n这里，$\\Omega_{o}$表示反射半球。球坐标系中的立体角微元为$d\\Omega_{o} = \\sin\\theta_{o} d\\theta_{o} d\\phi_{o}$。积分在极角$\\theta_{o}$从$0$到$\\frac{\\pi}{2}$以及方位角$\\phi_{o}$从$0$到$2\\pi$的范围内进行。其显式积分形式为：\n$$\n\\rho_{\\lambda}(\\theta_{i}, \\phi_{i}) = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} f_{r,\\lambda}(\\theta_{i}, \\phi_{i} \\rightarrow \\theta_{o}, \\phi_{o}) \\cos\\theta_{o} \\sin\\theta_{o} d\\theta_{o} d\\phi_{o}\n$$\n现在我们将给定的BRDF模型代入此积分。该模型为：\n$$\nf_{r,\\lambda}(\\theta_{i},\\phi_{i}\\rightarrow\\theta_{o},\\phi_{o}) = A(\\lambda)\\,(\\cos\\theta_{i}\\cos\\theta_{o})^{n}\\,g(\\phi_{o}-\\phi_{i})\n$$\n其中$g(\\Delta\\phi) = \\frac{1+b\\cos\\Delta\\phi}{2\\pi}$。代入后得到：\n$$\n\\rho_{\\lambda}(\\theta_{i}, \\phi_{i}) = \\int_{0}^{2\\pi} \\int_{0}^{\\pi/2} \\left[ A(\\lambda)(\\cos\\theta_{i}\\cos\\theta_{o})^{n}\\frac{1+b\\cos(\\phi_{o}-\\phi_{i})}{2\\pi} \\right] \\cos\\theta_{o} \\sin\\theta_{o} d\\theta_{o} d\\phi_{o}\n$$\n积分中的变量是可分离的。我们可以将依赖于$\\theta_{o}$和$\\phi_{o}$的项分组，并提出常数和依赖于$\\theta_{i}$的项：\n$$\n\\rho_{\\lambda}(\\theta_{i}, \\phi_{i}) = A(\\lambda)(\\cos\\theta_{i})^{n} \\left[ \\int_{0}^{2\\pi} \\frac{1+b\\cos(\\phi_{o}-\\phi_{i})}{2\\pi} d\\phi_{o} \\right] \\left[ \\int_{0}^{\\pi/2} (\\cos\\theta_{o})^{n} \\cos\\theta_{o} \\sin\\theta_{o} d\\theta_{o} \\right]\n$$\n我们分别计算这两个积分。\n\n首先，考虑方位角积分。问题陈述中说明$\\int_{0}^{2\\pi} g(\\Delta\\phi)\\,d\\Delta\\phi=1$。我们来验证这个归一化。令$\\Delta\\phi = \\phi_{o}-\\phi_{i}$。当$\\phi_{o}$从$0$变化到$2\\pi$时，$\\Delta\\phi$覆盖了一个长度为$2\\pi$的区间。由于被积函数是周期性的，在任何此类区间上的积分都是相同的。\n$$\n\\int_{0}^{2\\pi} g(\\phi_{o}-\\phi_{i}) d\\phi_{o} = \\int_{0}^{2\\pi} \\frac{1+b\\cos(\\phi_{o}-\\phi_{i})}{2\\pi} d\\phi_{o} = \\frac{1}{2\\pi} \\left[ \\phi_{o} + \\frac{\\sin(\\phi_{o}-\\phi_{i})}{1} \\right]_{0}^{2\\pi} = \\frac{1}{2\\pi} (2\\pi) = 1\n$$\n因此，方位角积分为$1$。此结果表明反射率$\\rho_{\\lambda}$与入射方位角$\\phi_i$无关，可以写为$\\rho_{\\lambda}(\\theta_{i})$。\n\n其次，我们计算极角积分：\n$$\nI_{\\theta} = \\int_{0}^{\\pi/2} (\\cos\\theta_{o})^{n+1} \\sin\\theta_{o} d\\theta_{o}\n$$\n我们使用换元法$u = \\cos\\theta_{o}$，得到$du = -\\sin\\theta_{o} d\\theta_{o}$。积分上下限也相应改变：当$\\theta_{o}=0$时，$u=1$；当$\\theta_{o}=\\frac{\\pi}{2}$时，$u=0$。\n$$\nI_{\\theta} = \\int_{1}^{0} u^{n+1} (-du) = \\int_{0}^{1} u^{n+1} du\n$$\n这是一个标准的幂函数积分，在$n+1 > -1$即$n > -2$时有效。问题给出的条件$n > -1$满足此要求。\n$$\nI_{\\theta} = \\left[ \\frac{u^{n+2}}{n+2} \\right]_{0}^{1} = \\frac{1^{n+2}}{n+2} - \\frac{0^{n+2}}{n+2} = \\frac{1}{n+2}\n$$\n结合积分结果，我们得到光谱方向-半球反射率的解析表达式：\n$$\n\\rho_{\\lambda}(\\theta_{i}) = A(\\lambda)(\\cos\\theta_{i})^{n} \\cdot (1) \\cdot \\left(\\frac{1}{n+2}\\right) = \\frac{A(\\lambda)}{n+2} (\\cos\\theta_{i})^{n}\n$$\n这完成了任务的第一部分。\n\n现在，我们使用给定的数据来计算$A(\\lambda_{0})$的数值。数据是在波长$\\lambda_{0}=1.55\\,\\mu\\mathrm{m}$下获得的：\n入射角：$\\theta_{i} = 60^{\\circ}$\n测得的反射率：$\\rho_{\\lambda_{0}}(60^{\\circ}) = 0.2$\n表面指数：$n = 1$\n我们已知$\\cos(60^{\\circ})=\\frac{1}{2}$。参数$b=\\frac{1}{2}$影响反射能量的分布，但不影响总的半球反射率。\n\n将这些值代入推导出的$\\rho_{\\lambda}(\\theta_{i})$表达式中：\n$$\n0.2 = \\frac{A(\\lambda_{0})}{1+2} \\left( \\cos(60^{\\circ}) \\right)^{1}\n$$\n$$\n0.2 = \\frac{A(\\lambda_{0})}{3} \\left( \\frac{1}{2} \\right)\n$$\n$$\n0.2 = \\frac{A(\\lambda_{0})}{6}\n$$\n求解$A(\\lambda_{0})$可得：\n$$\nA(\\lambda_{0}) = 6 \\times 0.2 = 1.2\n$$\n题目要求答案保留四位有效数字。因此，我们将结果表示为$1.200$。$A(\\lambda)$的单位为$\\mathrm{sr}^{-1}$。", "answer": "$$\n\\boxed{1.200}\n$$", "id": "2524141"}, {"introduction": "在掌握了现象学模型之后，我们将深入探索基于物理的反射模型，这是理解和模拟真实粗糙表面的关键。微面元理论将宏观粗糙的表面看作由大量微小的镜面组成，是当前最先进的BRDF建模方法之一。这项综合性练习要求你从第一性原理出发，推导包含GGX法向分布和Smith遮蔽-掩模函数的完整微面元BRDF模型，并最终通过编程实现它 [@problem_id:2524138]。这个挑战将理论推导、物理洞察与计算实践融为一体，是连接辐射传输理论与计算机图形学、遥感等前沿应用领域的桥梁。", "problem": "一个宏观平坦但微观粗糙、不透明、各向同性的金属表面被建模为镜面般微面元的随机集合。宏观双向反射分布函数 (BRDF)，记为 $f_r(\\lambda, \\boldsymbol{\\omega}_i, \\boldsymbol{\\omega}_o)$，取决于波长 $\\lambda$ 和两个单位方向：$\\boldsymbol{\\omega}_i$ (入射) 和 $\\boldsymbol{\\omega}_o$ (出射)，这两个方向都位于相对于宏观表面单位法线 $\\boldsymbol{n}$ 的上半球内。BRDF 由以下基本辐射度关系式定义：\n$$\n\\mathrm{d}L_o(\\lambda, \\boldsymbol{\\omega}_o) \\;=\\; f_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\, L_i(\\lambda,\\boldsymbol{\\omega}_i)\\, (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i)\\, \\mathrm{d}\\omega_i,\n$$\n其中 $L$ 表示辐射率，$\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i = \\cos\\theta_i \\ge 0$，$\\mathrm{d}\\omega_i$ 是微分立体角。假设能量守恒、互易性和微观表面的镜面反射性均成立。\n\n微观几何结构由一个各向同性的 Trowbridge–Reitz（也称为广义高斯或 GGX）法线分布函数 (NDF) 表征，该函数描述了上半球 $\\Omega^+$ 内微面元单位法线 $\\boldsymbol{m}$ 的分布：\n$$\nD(\\boldsymbol{m};\\alpha)\\; \\propto\\; \\left( \\left(\\boldsymbol{n}\\cdot\\boldsymbol{m}\\right)^2\\left(\\alpha^2 - 1\\right) + 1 \\right)^{-2},\n$$\n其中 $\\alpha>0$ 是一个粗糙度参数。NDF 必须满足关于投影面积测度的归一化约束条件，\n$$\n\\int_{\\Omega^+} D(\\boldsymbol{m};\\alpha)\\, (\\boldsymbol{n}\\cdot \\boldsymbol{m})\\, \\mathrm{d}\\omega_m \\;=\\; 1.\n$$\n自遮蔽和遮挡由可分离的 Smith 模型 $G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o,\\alpha) = G_1(\\boldsymbol{\\omega}_i,\\alpha)\\, G_1(\\boldsymbol{\\omega}_o,\\alpha)$ 描述，其中 $G_1$ 是一束来自给定方向的光线不与表面高度场相交的概率。\n\n光谱依赖性源于每个微面元的菲涅尔反射率，每个微面元被建模为相对于真空的复折射率为 $\\tilde{n}(\\lambda) = n(\\lambda) + i\\,k(\\lambda)$ 的完美导体。根据电磁边界条件（麦克斯韦方程组），在入射角为 $\\theta$ 时，s-偏振和p-偏振的复振幅菲涅尔反射系数分别为：\n$$\nr_s(\\theta,\\lambda) \\,=\\, \\frac{\\cos\\theta - \\sqrt{\\tilde{n}(\\lambda)^2 - \\sin^2\\theta}}{\\cos\\theta + \\sqrt{\\tilde{n}(\\lambda)^2 - \\sin^2\\theta}},\\qquad\nr_p(\\theta,\\lambda) \\,=\\, \\frac{\\tilde{n}(\\lambda)^2 \\cos\\theta - \\sqrt{\\tilde{n}(\\lambda)^2 - \\sin^2\\theta}}{\\tilde{n}(\\lambda)^2 \\cos\\theta + \\sqrt{\\tilde{n}(\\lambda)^2 - \\sin^2\\theta}},\n$$\n且非偏振微面元光谱反射率是\n$$\nF(\\theta,\\lambda) \\,=\\, \\tfrac{1}{2}\\left(\\lvert r_s\\rvert^2 + \\lvert r_p\\rvert^2\\right).\n$$\n\n任务：\n1) 从BRDF定义和微面元集合图像（其中只有法线 $\\boldsymbol{m}$ 满足镜面反射条件的微面元才对反射有贡献）出发，推导微面元BRDF $f_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)$。结果需用以下项表示：微面元半矢量 $\\boldsymbol{h} = (\\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o)/\\lVert \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o\\rVert$，在 $\\boldsymbol{m}=\\boldsymbol{h}$ 处取值的归一化NDF $D(\\boldsymbol{m};\\alpha)$，在 $\\boldsymbol{\\omega}_i$ 和 $\\boldsymbol{h}$ 之间的入射角 $\\theta_m$ 处取值的菲涅尔反射率 $F(\\theta_m,\\lambda)$，以及 Smith 遮蔽-遮挡函数 $G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o,\\alpha)$。你的推导必须从可见微面元的集合平均开始，并应用 $\\boldsymbol{m}$-空间和方向空间之间的投影面积雅可比行列式。不要先验地假设任何目标表达式。\n\n2) 确定归一化常数，使得成比例的 Trowbridge–Reitz 表达式转变为一个有效的、满足上述投影面积归一化约束的 NDF $D(\\boldsymbol{m};\\alpha)$。\n\n3) 利用 Smith函数的可分离性假设以及 Trowbridge–Reitz 模型所基于的微面元斜率分布的定义，推导出 $G_1(\\boldsymbol{\\omega},\\alpha)$ 的封闭形式表达式，该表达式用 $\\mu=\\boldsymbol{n}\\cdot\\boldsymbol{\\omega}=\\cos\\theta$ 和 $\\alpha$ 表示。\n\n4) 实现一个程序，对以下测试套件，数值计算得到的BRDF $f_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)$。使用宏观表面法线 $\\boldsymbol{n}=(0,0,1)^\\top$，并根据球面坐标约定 $\\boldsymbol{\\omega}=(\\sin\\theta\\cos\\varphi,\\sin\\theta\\sin\\varphi,\\cos\\theta)$，使用天顶角 $\\theta$ 和方位角 $\\varphi$ 对方向进行参数化。入射方向的方位角固定为 $\\varphi_i=0$，出射方向的方位角为 $\\varphi_o=\\Delta\\varphi$。角度必须以弧度为单位。波长必须以纳米为单位，BRDF 必须以球面度分之一 (sr⁻¹) 报告。对每个案例，以浮点数形式返回标量BRDF值。\n\n测试套件案例（每个案例指定为 $[\\lambda\\,[\\mathrm{nm}],\\, n(\\lambda),\\, k(\\lambda),\\, \\alpha,\\, \\theta_i\\, [\\mathrm{rad}],\\, \\theta_o\\, [\\mathrm{rad}],\\, \\Delta\\varphi\\, [\\mathrm{rad}]]$）：\n- 案例A: $[550,\\; 0.14,\\; 3.98,\\; 0.05,\\; 0.34906585,\\; 0.34906585,\\; \\pi]$。\n- 案例B: $[800,\\; 0.17,\\; 5.25,\\; 0.50,\\; 0.34906585,\\; 0.34906585,\\; \\pi]$。\n- 案例C: $[550,\\; 0.14,\\; 3.98,\\; 0.10,\\; 1.39626340,\\; 1.39626340,\\; \\pi]$。\n- 案例D: $[550,\\; 0.14,\\; 3.98,\\; 0.30,\\; 0.52359878,\\; 1.04719755,\\; \\tfrac{\\pi}{2}]$。\n\n实现要求：\n- 使用从任务1-3中推导出的表达式。\n- 在微面元级别上，使用导体模型及给定的 $n(\\lambda)$ 和 $k(\\lambda)$ 来处理每个波长 $\\lambda$ 对应的菲涅尔反射率。\n- 通过在 $\\boldsymbol{n}\\cdot\\boldsymbol{\\omega}_i \\le 0$ 或 $\\boldsymbol{n}\\cdot\\boldsymbol{\\omega}_o \\le 0$ 或 $\\lVert \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o\\rVert = 0$ 的情况下返回 0 来确保数值鲁棒性。\n- 最终答案以球面度分之一为单位，表示为四舍五入到六位小数的浮点数。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含案例A–D的四个BRDF值，格式为方括号括起来的逗号分隔列表（例如，$[v_A,v_B,v_C,v_D]$），顺序与案例顺序相同，每个 $v_\\cdot$ 值四舍五入到六位小数，无附加文本。角度在内部计算时必须以弧度处理。波长单位 $[\\mathrm{nm}]$ 仅作为选择 $n(\\lambda)$ 和 $k(\\lambda)$ 的参数，除了用于计算菲涅尔系数外，不直接进入其他计算。\n\n约束和说明：\n- 宏观表面被假定为非自发光，其上方的介质为真空。\n- BRDF 必须满足互易性且为非负值。\n- 所有三角函数必须使用弧度制角度。", "solution": "该问题陈述已经过严格验证，被认为是科学上可靠、适定且客观的。它提出了物理光学和辐射传输领域一个标准的、尽管全面的问题，特别是关于粗糙表面反射的微面元理论。所有给定的定义、常数和函数形式在相关文献中都是标准的。各项任务是循序渐进的、逻辑一致的，并能导出一个唯一的、可验证的解。因此，我将着手进行推导和求解。\n\n该问题需要一个由四部分组成的解：双向反射分布函数 (BRDF) 的推导、法线分布函数 (NDF) 的归一化、遮蔽-遮挡函数的推导，以及最后的数值实现。\n\n第一个任务是推导微面元BRDF，记为 $f_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)$。BRDF由反射辐射率 $L_o$ 和入射辐射率 $L_i$ 之间的关系定义：\n$$\n\\mathrm{d}L_o(\\lambda, \\boldsymbol{\\omega}_o) = f_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)\\, L_i(\\lambda,\\boldsymbol{\\omega}_i)\\, \\mathrm{d}E_i\n$$\n其中 $\\mathrm{d}E_i = L_i(\\lambda,\\boldsymbol{\\omega}_i)\\, (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i)\\, \\mathrm{d}\\omega_i$ 是宏观表面上的微分辐照度。\n从宏观表面的一个微分面积 $\\mathrm{d}A$ 反射到微分立体角 $\\mathrm{d}\\omega_o$ 内的反射辐射率是总反射功率 $\\mathrm{d}\\Phi_o$ 除以投影面积和立体角：\n$$\nL_o(\\boldsymbol{\\omega}_o) = \\frac{\\mathrm{d}\\Phi_o}{\\mathrm{d}A\\, (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o)\\, \\mathrm{d}\\omega_o}\n$$\n总反射功率 $\\mathrm{d}\\Phi_o$ 是对所有可见的、发生镜面反射的微面元的积分。一个法线为 $\\boldsymbol{m}$ 的微面元只有当其方向沿着半矢量 $\\boldsymbol{h} = (\\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o)/\\lVert \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o\\rVert$ 时，才对从 $\\boldsymbol{\\omega}_i$ 到 $\\boldsymbol{\\omega}_o$ 的反射有贡献。入射到面积 $\\mathrm{d}A$ 内的活动微面元集合上的微分功率是\n$$\n\\mathrm{d}\\Phi_i = L_i(\\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i \\cdot (\\text{活动微面元的投影面积}) = L_i(\\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i \\cdot [D(\\boldsymbol{h};\\alpha) (\\boldsymbol{n}\\cdot\\boldsymbol{h}) \\mathrm{d}\\omega_m \\mathrm{d}A] \\cdot \\frac{(\\boldsymbol{\\omega}_i \\cdot \\boldsymbol{h})}{(\\boldsymbol{n}\\cdot\\boldsymbol{h})}\n$$\n项 $D(\\boldsymbol{h};\\alpha) (\\boldsymbol{n}\\cdot\\boldsymbol{h}) \\mathrm{d}\\omega_m \\mathrm{d}A$ 是法线在 $\\boldsymbol{h}$ 附近的 $\\mathrm{d}\\omega_m$ 范围内的微面元的总面积，最后一项校正了此面积相对于入射方向 $\\boldsymbol{\\omega}_i$ 的投影。反射功率是该入射功率乘以菲涅尔反射率 $F$ 和遮蔽-遮挡项 $G$：\n$$\n\\mathrm{d}\\Phi_o = L_i(\\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i \\cdot D(\\boldsymbol{h};\\alpha) (\\boldsymbol{\\omega}_i \\cdot \\boldsymbol{h}) F(\\theta_m,\\lambda) G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o,\\alpha) \\mathrm{d}A \\mathrm{d}\\omega_m\n$$\n其中 $\\theta_m$ 是 $\\boldsymbol{\\omega}_i$ 和 $\\boldsymbol{h}$ 之间的夹角。对于镜面反射，关联微面元法线立体角 $\\mathrm{d}\\omega_m$ 和出射立体角 $\\mathrm{d}\\omega_o$ 的雅可比行列式是 $\\mathrm{d}\\omega_m/\\mathrm{d}\\omega_o = 1 / (4(\\boldsymbol{\\omega}_o \\cdot \\boldsymbol{h}))$。将此代入 $\\mathrm{d}\\Phi_o$ 的表达式中得到：\n$$\n\\mathrm{d}\\Phi_o = L_i(\\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i \\cdot \\frac{D(\\boldsymbol{h}) F(\\theta_m) G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) (\\boldsymbol{\\omega}_i \\cdot \\boldsymbol{h})}{4(\\boldsymbol{\\omega}_o \\cdot \\boldsymbol{h})} \\mathrm{d}A \\mathrm{d}\\omega_o\n$$\n使用镜面反射条件 $(\\boldsymbol{\\omega}_i \\cdot \\boldsymbol{h}) = (\\boldsymbol{\\omega}_o \\cdot \\boldsymbol{h})$，我们得到反射辐射率：\n$$\nL_o(\\boldsymbol{\\omega}_o) = \\frac{\\mathrm{d}\\Phi_o}{\\mathrm{d}A\\, (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o)\\, \\mathrm{d}\\omega_o} = L_i(\\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i \\frac{D(\\boldsymbol{h}) F(\\theta_m) G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o)}{4(\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o)}\n$$\n将其与定义式 $L_o = f_r L_i (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i) \\mathrm{d}\\omega_i$ 进行比较，我们确定BRDF为：\n$$\nf_r(\\lambda,\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o) = \\frac{D(\\boldsymbol{h};\\alpha) F(\\theta_m,\\lambda) G(\\boldsymbol{\\omega}_i,\\boldsymbol{\\omega}_o,\\alpha)}{4 (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i) (\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o)}\n$$\n这就是所要求的表达式，被称为 Cook-Torrance 微面元模型 BRDF。\n\n第二个任务是求 Trowbridge-Reitz NDF的归一化常数，$D(\\boldsymbol{m};\\alpha) = C \\cdot \\left( (\\boldsymbol{n}\\cdot\\boldsymbol{m})^2(\\alpha^2 - 1) + 1 \\right)^{-2}$，其需满足约束条件 $\\int_{\\Omega^+} D(\\boldsymbol{m};\\alpha)\\, (\\boldsymbol{n}\\cdot \\boldsymbol{m})\\, \\mathrm{d}\\omega_m = 1$。我们必须求解 $C$。积分为：\n$$\nI = \\int_{\\Omega^+} \\left( (\\boldsymbol{n}\\cdot\\boldsymbol{m})^2(\\alpha^2 - 1) + 1 \\right)^{-2} (\\boldsymbol{n}\\cdot \\boldsymbol{m})\\, \\mathrm{d}\\omega_m\n$$\n我们将 $\\boldsymbol{n}$ 与z轴对齐，因此 $\\boldsymbol{n}=(0,0,1)$。在球坐标系中，$\\boldsymbol{m}=(\\sin\\theta_m\\cos\\varphi_m, \\sin\\theta_m\\sin\\varphi_m, \\cos\\theta_m)$，所以 $\\boldsymbol{n}\\cdot\\boldsymbol{m} = \\cos\\theta_m$。积分是在上半球 $\\Omega^+$ 上进行的，这意味着 $\\theta_m \\in [0, \\pi/2]$ 且 $\\varphi_m \\in [0, 2\\pi]$。微分立体角为 $\\mathrm{d}\\omega_m = \\sin\\theta_m \\mathrm{d}\\theta_m \\mathrm{d}\\varphi_m$。\n$$\nI = \\int_0^{2\\pi} \\mathrm{d}\\varphi_m \\int_0^{\\pi/2} \\frac{\\cos\\theta_m \\sin\\theta_m}{(\\cos^2\\theta_m(\\alpha^2 - 1) + 1)^2} \\mathrm{d}\\theta_m\n$$\n对 $\\varphi_m$ 的积分结果是 $2\\pi$。对于对 $\\theta_m$ 的积分，令 $u = \\cos^2\\theta_m$。则 $\\mathrm{d}u = -2\\cos\\theta_m\\sin\\theta_m \\mathrm{d}\\theta_m$。积分上下限从 $1$ (当 $\\theta_m=0$ 时) 变为 $0$ (当 $\\theta_m=\\pi/2$ 时)。\n$$\nI = 2\\pi \\int_1^0 \\frac{1}{(u(\\alpha^2-1)+1)^2} \\frac{-\\mathrm{d}u}{2} = \\pi \\int_0^1 \\frac{1}{(u(\\alpha^2-1)+1)^2} \\mathrm{d}u\n$$\n令 $a = \\alpha^2-1$。积分变为 $\\int (au+1)^{-2} \\mathrm{d}u = -\\frac{1}{a(au+1)}$。\n$$\nI = \\pi \\left[ -\\frac{1}{a(au+1)} \\right]_0^1 = -\\frac{\\pi}{a} \\left( \\frac{1}{a+1} - \\frac{1}{1} \\right) = -\\frac{\\pi}{\\alpha^2-1} \\left( \\frac{1}{\\alpha^2} - 1 \\right) = -\\frac{\\pi}{\\alpha^2-1} \\frac{1-\\alpha^2}{\\alpha^2} = \\frac{\\pi}{\\alpha^2}\n$$\n归一化常数为 $C = 1/I = \\alpha^2/\\pi$。因此，归一化的NDF为：\n$$\nD(\\boldsymbol{m};\\alpha) = \\frac{\\alpha^2}{\\pi} \\frac{1}{\\left((\\boldsymbol{n}\\cdot\\boldsymbol{m})^2(\\alpha^2 - 1) + 1\\right)^2}\n$$\n\n第三个任务是推导 Smith 遮蔽-遮挡函数 $G_1(\\boldsymbol{\\omega},\\alpha)$。函数 $G_1(\\boldsymbol{\\omega})$ 是方向为 $\\boldsymbol{\\omega}$ 的光线不被表面遮挡的概率。对于高斯高度分布，Smith 证明了 $G_1(\\boldsymbol{\\omega}) = (1+\\Lambda(\\boldsymbol{\\omega}))^{-1}$。函数 $\\Lambda(\\boldsymbol{\\omega})$ 取决于微面元的斜率分布。对于各向同性的 Trowbridge-Reitz (GGX) NDF，相应的函数 $\\Lambda$ 有一个封闭形式。它取决于宏观表面法线 $\\boldsymbol{n}$ 和方向 $\\boldsymbol{\\omega}$ 之间的夹角 $\\theta$。令 $\\mu = \\cos\\theta = \\boldsymbol{n}\\cdot\\boldsymbol{\\omega}$。GGX 的函数 $\\Lambda$ 为：\n$$\n\\Lambda(\\mu, \\alpha) = \\frac{-1 + \\sqrt{1 + \\alpha^2 \\tan^2\\theta}}{2} = \\frac{-1 + \\sqrt{1 + \\alpha^2 \\frac{1-\\mu^2}{\\mu^2}}}{2}\n$$\n将此代入 $G_1$ 的表达式中：\n$$\nG_1(\\mu, \\alpha) = \\frac{1}{1 + \\Lambda(\\mu, \\alpha)} = \\frac{1}{1 + \\frac{-1 + \\sqrt{1 + \\alpha^2 (1-\\mu^2)/\\mu^2}}{2}} = \\frac{2}{1 + \\sqrt{1 + \\alpha^2 \\frac{1-\\mu^2}{\\mu^2}}}\n$$\n这就是所要求的、适用于 Trowbridge-Reitz NDF 的 Smith 遮蔽-遮挡函数的封闭形式表达式。\n\n第四个任务是数值实现。将根据推导出的表达式开发一个Python函数来计算 $f_r$。输入为 $\\lambda$、$n(\\lambda)$、$k(\\lambda)$、$\\alpha$、$\\theta_i$、$\\theta_o$ 和 $\\Delta\\varphi$。\n步骤如下：\n1. 定义宏观表面法线 $\\boldsymbol{n}=(0,0,1)^\\top$。\n2. 使用球坐标构建入射和出射向量 $\\boldsymbol{\\omega}_i$ 和 $\\boldsymbol{\\omega}_o$：$\\boldsymbol{\\omega}_i = (\\sin\\theta_i, 0, \\cos\\theta_i)$ 和 $\\boldsymbol{\\omega}_o = (\\sin\\theta_o \\cos\\Delta\\varphi, \\sin\\theta_o \\sin\\Delta\\varphi, \\cos\\theta_o)$。\n3. 检查无效的几何构型：如果 $\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i \\le 0$ 或 $\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o \\le 0$，则返回 $0$。\n4. 计算半矢量 $\\boldsymbol{h} = (\\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o)/\\lVert \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o\\rVert$。如果 $\\lVert \\boldsymbol{\\omega}_i + \\boldsymbol{\\omega}_o\\rVert = 0$，则返回 $0$。\n5. 计算BRDF的各项。\n   - 分母：$4(\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_i)(\\boldsymbol{n}\\cdot \\boldsymbol{\\omega}_o) = 4\\cos\\theta_i\\cos\\theta_o$。\n   - NDF $D(\\boldsymbol{h};\\alpha)$：使用 $\\cos\\theta_h = \\boldsymbol{n}\\cdot\\boldsymbol{h}$ 计算 $D$。\n   - 遮蔽-遮挡 $G = G_1(\\boldsymbol{\\omega}_i)G_1(\\boldsymbol{\\omega}_o)$：使用 $\\mu_i = \\cos\\theta_i$ 和 $\\mu_o = \\cos\\theta_o$ 以及推导出的公式计算 $G_1$。\n   - 菲涅尔反射率 $F(\\theta_m,\\lambda)$：\n     a. 根据 $\\cos\\theta_m = \\boldsymbol{\\omega}_i \\cdot \\boldsymbol{h}$ 计算微面元入射角。\n     b. 构建复折射率 $\\tilde{n} = n+ik$。\n     c. 使用提供的公式计算复数菲涅尔系数 $r_s$ 和 $r_p$，并正确处理复数运算。这涉及计算复数平方根 $\\sqrt{\\tilde{n}^2 - \\sin^2\\theta_m}$。\n     d. 计算非偏振反射率 $F = \\frac{1}{2}(\\lvert r_s\\rvert^2 + \\lvert r_p\\rvert^2)$。\n6. 组合所有项以获得最终的BRDF值 $f_r$ 并按要求格式化输出。将对每个指定的测试案例执行计算。", "answer": "[102.392572,1.383794,22.181878,0.065609]", "id": "2524138"}]}