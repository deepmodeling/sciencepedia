{"hands_on_practices": [{"introduction": "局部态密度（LDOS）是描述电磁环境在特定位置和频率下可支持模式数量的基本物理量，它支配着近场尺度下所有的光与物质相互作用，包括近场热辐射。本练习将通过计算一个简单但具有代表性的系统中（真空-金属界面附近）的局部态密度，来训练你使用并矢格林函数这一涨落电动力学的核心工具。掌握这项技能对于从第一性原理理解和量化近场现象至关重要。[@problem_id:2511618]", "problem": "一个由Drude模型描述的半无限非磁性金属占据半空间 $z0$，而 $z0$ 为真空。金属的相对介电常数为 $\\varepsilon(\\omega)=1-\\dfrac{\\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)}$，其中 $\\omega_{p}$ 是等离激元频率，$\\gamma$ 是碰撞频率。考虑真空中界面上方高度为 $z0$ 的一个点。沿垂直方向 $\\hat{\\mathbf{z}}$ 投影的电磁局域态密度 (LDOS) 通过真空中的电场并矢格林张量 $\\mathbf{G}(\\mathbf{r},\\mathbf{r}';\\omega)$ 定义为\n$$\\rho_{z}(\\omega,z)=\\frac{2\\omega}{\\pi c^{2}}\\,\\operatorname{Im}\\,G_{zz}(\\mathbf{r},\\mathbf{r};\\omega),$$\n其中 $c$ 是真空中的光速，$G_{zz}$ 是 $\\mathbf{G}$ 的 $zz$ 分量。使用麦克斯韦方程组、平面界面上的边界条件以及由面内波矢大小 $k_{\\parallel}$ 和菲涅耳反射系数参数化的 $\\mathbf{G}$ 的平面波分解，在极端近场区域 $z\\ll c/\\omega$ 中，计算 $G_{zz}(\\mathbf{r},\\mathbf{r};\\omega)$ 的反射（界面）贡献的 $k_{\\parallel}$ 积分，并保留主要的倏逝波贡献。\n\n据此，推导出一个关于 $\\omega$、$\\omega_{p}$、$\\gamma$、 $z$ 和基本常数的垂直投影局域态密度 $\\rho_{z}(\\omega,z)$ 的闭式解析表达式。将您的最终结果表示为单个简化的解析表达式。不包括任何附加的自由空间背景；只报告近场、界面引起的贡献。您的最终答案必须是单个解析表达式。不需要进行数值评估。", "solution": "所述问题是有效的。这是一个在近场电磁学领域中适定、有科学依据的问题，需要一个标准但严谨的推导。我们将着手求解。\n\n目标是计算在距离半无限金属 $z$ 处的真空中，垂直投影的局域态密度 (LDOS) $\\rho_{z}(\\omega,z)$。LDOS 由下式给出\n$$\n\\rho_{z}(\\omega,z) = \\frac{2\\omega}{\\pi c^{2}}\\,\\operatorname{Im}\\,G_{zz}(\\mathbf{r},\\mathbf{r};\\omega)\n$$\n其中 $\\mathbf{r}=(0,0,z)$，$G_{zz}$ 是并矢格林函数的一个分量。问题要求在极端近场 $z \\ll c/\\omega$ 下的界面诱导贡献。这一贡献来自格林函数的反射部分，我们将其表示为 $\\mathbf{G}^{\\text{ref}}$。\n\n对于平面几何结构，电并矢格林函数可以分解为对平面波的积分，由面内波矢 $\\mathbf{k}_{\\parallel} = (k_{x}, k_{y})$ 参数化。在同一源点和观察点 $\\mathbf{r}=(0,0,z)$ 处的格林函数反射分量由对 $\\mathbf{k}_{\\parallel}$ 的积分给出。对于 $zz$ 分量，只有 $p$ 偏振（TM）波有贡献。$G_{zz}^{\\text{ref}}$ 的表达式为：\n$$\nG_{zz}^{\\text{ref}}(\\mathbf{r}, \\mathbf{r}; \\omega) = \\frac{i}{8\\pi^{2}} \\int \\frac{d^{2}k_{\\parallel}}{k_{z,vac}} e^{2ik_{z,vac}z} \\left(\\frac{k_{\\parallel}^{2}}{k_{0}^{2}}\\right) r_{p}(k_{\\parallel}, \\omega)\n$$\n此处，$k_{0} = \\omega/c$ 是真空中的波矢大小。$k_{\\parallel} = |\\mathbf{k}_{\\parallel}|$ 是面内波矢的大小。$k_{z,vac} = \\sqrt{k_{0}^{2} - k_{\\parallel}^{2}}$ 是真空中（$z  0$）波矢的垂直分量。$r_{p}$ 是真空-金属界面处 $p$ 偏振波的菲涅耳反射系数。对 $\\mathbf{k}_{\\parallel}$ 的角度积分得到因子 $2\\pi$。\n$$\nG_{zz}^{\\text{ref}}(\\mathbf{r}, \\mathbf{r}; \\omega) = \\frac{i}{4\\pi} \\int_{0}^{\\infty} k_{\\parallel} dk_{\\parallel} \\frac{e^{2ik_{z,vac}z}}{k_{z,vac}} \\left(\\frac{k_{\\parallel}^{2}}{k_{0}^{2}}\\right) r_{p}(k_{\\parallel}, \\omega)\n$$\n问题指定了极端近场区域，$z \\ll c/\\omega$ 或 $k_{0}z \\ll 1$。在此区域，积分由倏逝波主导，其 $k_{\\parallel}  k_{0}$。对于这些波，垂直波矢是纯虚数：$k_{z,vac} = i\\sqrt{k_{\\parallel}^{2} - k_{0}^{2}}$。指数项变为衰减函数 $e^{-2z\\sqrt{k_{\\parallel}^{2} - k_{0}^{2}}}$。\n\n条件 $k_{0}z \\ll 1$ 意味着对积分的主要贡献来自大波矢，$k_{\\parallel} \\sim 1/z \\gg k_{0}$。这使得可以进行两个关键的简化：\n1. 垂直波矢可以近似为 $k_{z,vac} \\approx i k_{\\parallel}$。\n2. 菲涅耳反射系数 $r_{p}$ 可以用其准静态极限代替。$r_{p}$ 的一般形式是 $r_{p} = \\frac{\\varepsilon k_{z,vac} - k_{z,med}}{\\varepsilon k_{z,vac} + k_{z,med}}$，其中 $k_{z,med} = \\sqrt{\\varepsilon k_{0}^{2} - k_{\\parallel}^{2}}$。在 $k_{\\parallel} \\gg k_{0}$ 的极限下，这简化为：\n$$\nr_{p} \\approx \\frac{\\varepsilon (ik_{\\parallel}) - i\\sqrt{\\varepsilon}k_{\\parallel}}{\\varepsilon (ik_{\\parallel}) + i\\sqrt{\\varepsilon}k_{\\parallel}}\n$$\n这是不正确的。准静态极限对应于 $c \\to \\infty$ 或 $k_0 \\to 0$。在此极限下，$k_{z,vac} \\to ik_{\\parallel}$ 且 $k_{z,med} = \\sqrt{\\varepsilon k_0^2-k_\\parallel^2} \\to ik_\\parallel$（如果我们假设 $|\\varepsilon|$ 不是非常大）。一个更直接的方法是利用势理论，它能得出正确的准静态极限：\n$$\nr_{p} \\approx \\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1}\n$$\n这个表达式与 $k_{\\parallel}$ 无关。\n\n将这些近似代入 $G_{zz}^{\\text{ref}}$ 的积分中：\n$$\nG_{zz}^{\\text{ref}} \\approx \\frac{i}{4\\pi k_{0}^{2}} \\int_{k_{0}}^{\\infty} k_{\\parallel} dk_{\\parallel} \\frac{e^{-2zk_{\\parallel}}}{ik_{\\parallel}} k_{\\parallel}^{2} \\left(\\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1}\\right)\n$$\n$$\nG_{zz}^{\\text{ref}} \\approx \\frac{1}{4\\pi k_{0}^{2}} \\left(\\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1}\\right) \\int_{k_{0}}^{\\infty} k_{\\parallel}^{2} e^{-2zk_{\\parallel}} dk_{\\parallel}\n$$\n由于被积函数 $k_{\\parallel}^{2} e^{-2zk_{\\parallel}}$ 在 $k_{\\parallel} = 1/z$ 处达到峰值，且 $1/z \\gg k_{0}$，将积分下限从 $k_{0}$ 改为 $0$ 所引入的误差可以忽略不计。该积分是标准的伽马函数形式：\n$$\n\\int_{0}^{\\infty} x^{n} e^{-ax} dx = \\frac{n!}{a^{n+1}}\n$$\n当 $n=2$ 且 $a=2z$ 时，该积分的计算结果为：\n$$\n\\int_{0}^{\\infty} k_{\\parallel}^{2} e^{-2zk_{\\parallel}} dk_{\\parallel} = \\frac{2!}{(2z)^{3}} = \\frac{2}{8z^{3}} = \\frac{1}{4z^{3}}\n$$\n将此结果代回 $G_{zz}^{\\text{ref}}$ 的表达式中：\n$$\nG_{zz}^{\\text{ref}} \\approx \\frac{1}{4\\pi k_{0}^{2}} \\left(\\frac{\\varepsilon - 1}{\\varepsilon + 1}\\right) \\frac{1}{4z^{3}} = \\frac{1}{16\\pi z^{3} k_{0}^{2}} \\left(\\frac{\\varepsilon - 1}{\\varepsilon + 1}\\right)\n$$\n现在，我们使用 LDOS 的定义，并代入 $k_{0} = \\omega/c$ 来计算它：\n$$\n\\rho_{z}(\\omega,z) = \\frac{2\\omega}{\\pi c^{2}} \\operatorname{Im}\\left[ G_{zz}^{\\text{ref}} \\right] \\approx \\frac{2\\omega}{\\pi c^{2}} \\operatorname{Im}\\left[ \\frac{c^{2}}{16\\pi z^{3}\\omega^{2}} \\left(\\frac{\\varepsilon - 1}{\\varepsilon + 1}\\right) \\right]\n$$\n$$\n\\rho_{z}(\\omega,z) \\approx \\frac{1}{8\\pi^{2} \\omega z^{3}} \\operatorname{Im}\\left[\\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1}\\right]\n$$\n最后一步是计算包含介电常数 $\\varepsilon(\\omega) = 1 - \\frac{\\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)}$ 的项的虚部。\n令响应函数为 $R(\\omega) = \\frac{\\varepsilon - 1}{\\varepsilon + 1}$。\n分子是 $\\varepsilon-1 = - \\frac{\\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)}$。\n分母是 $\\varepsilon+1 = 2 - \\frac{\\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)} = \\frac{2\\omega(\\omega+i\\gamma) - \\omega_{p}^{2}}{\\omega(\\omega+i\\gamma)} = \\frac{2\\omega^{2} - \\omega_{p}^{2} + i2\\omega\\gamma}{\\omega(\\omega+i\\gamma)}$。\n因此，响应函数为：\n$$\nR(\\omega) = \\frac{- \\omega_{p}^{2}}{2\\omega^{2} - \\omega_{p}^{2} + i2\\omega\\gamma}\n$$\n为求虚部，我们将分子和分母同乘以分母的复共轭：\n$$\nR(\\omega) = \\frac{- \\omega_{p}^{2} (2\\omega^{2} - \\omega_{p}^{2} - i2\\omega\\gamma)}{(2\\omega^{2} - \\omega_{p}^{2})^{2} + (2\\omega\\gamma)^{2}}\n$$\n虚部为：\n$$\n\\operatorname{Im}[R(\\omega)] = \\frac{(- \\omega_{p}^{2})(-2\\omega\\gamma)}{(2\\omega^{2} - \\omega_{p}^{2})^{2} + 4\\omega^{2}\\gamma^{2}} = \\frac{2\\omega\\gamma\\omega_{p}^{2}}{(2\\omega^{2} - \\omega_{p}^{2})^{2} + 4\\omega^{2}\\gamma^{2}}\n$$\n将此结果代入 $\\rho_{z}(\\omega,z)$ 的表达式中：\n$$\n\\rho_{z}(\\omega,z) \\approx \\frac{1}{8\\pi^{2} \\omega z^{3}} \\left( \\frac{2\\omega\\gamma\\omega_{p}^{2}}{(2\\omega^{2} - \\omega_{p}^{2})^{2} + 4\\omega^{2}\\gamma^{2}} \\right)\n$$\n分子和分母中的因子 $\\omega$ 相互抵消，从而得到极端近场下界面诱导的垂直投影 LDOS 的最终表达式：\n$$\n\\rho_{z}(\\omega,z) = \\frac{\\gamma\\omega_{p}^{2}}{4\\pi^{2} z^{3} [(2\\omega^{2} - \\omega_{p}^{2})^{2} + (2\\omega\\gamma)^{2}]}\n$$\n这个结果展示了近场 LDOS 特有的 $1/z^{3}$ 依赖关系，并表明当分母最小时（这发生在表面等离激元频率 $\\omega = \\omega_{p}/\\sqrt{2}$ 附近）会出现共振增强。", "answer": "$$\n\\boxed{\\frac{\\gamma\\omega_{p}^{2}}{4\\pi^{2}z^{3}\\left(\\left(2\\omega^{2} - \\omega_{p}^{2}\\right)^{2} + 4\\omega^{2}\\gamma^{2}\\right)}}\n$$", "id": "2511618"}, {"introduction": "近场热传递的巨大增强通常源于材料支持的表面极化激元（如表面等离激元或声子极化激元）的共振耦合。本练习将从分析一个具体物理系统（极性电介质）出发，探索共振传热的光谱特性。通过推导传热谱峰的宽度与材料内在阻尼参数之间的直接关系，你将深入理解宏观可观测现象（光谱线宽）与微观材料属性之间的深刻联系。[@problem_id:2511634]", "problem": "考虑两个相同的半无限极性电介质半空间，被厚度为 $d$ 的真空间隙隔开，其中 $d \\ll c/\\omega_T$，因此静电极限适用于主导的倏逝波通道。每个电介质由单共振洛伦兹振子介电常数描述\n$$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty}\\left(1 + \\frac{\\omega_{L}^{2} - \\omega_{T}^{2}}{\\omega_{T}^{2} - \\omega^{2} - i \\Gamma\\, \\omega}\\right),\n$$\n其中 $\\varepsilon_{\\infty}  0$ 是高频介电常数，$\\omega_{T}$ 和 $\\omega_{L}$ 分别是横向和纵向光学声子角频率，而 $\\Gamma \\ll \\omega_{T}$ 是唯象阻尼（损耗）率。假设两种介质都是非磁性的，并且温度使得近场光谱热传递由 $p$ 偏振倏逝模式主导。\n\n使用基于涨落耗散定理 (FDT) 的涨落电动力学框架和静电极限下的菲涅耳反射系数，证明两个半空间之间的 $k$ 积分近场光谱传递在角频率 $\\omega$ 上，在由 $\\operatorname{Re}\\,\\varepsilon(\\omega_{s}) = -1$ 隐式定义的表面声子极化激元 (SPhP) 共振频率 $\\omega_{s}$ 附近出现尖锐峰值。将“光谱窗口”定义为该 $k$ 积分近场光谱透射相对于远场（黑体）极限的增强峰在角频率 $\\omega$ 上的半峰全宽 (FWHM)。\n\n在小损耗参数 $\\Gamma$ 的领头阶上，推导此 FWHM 的一个仅用 $\\varepsilon_{\\infty}$、$\\omega_{T}$、$\\omega_{L}$ 和 $\\Gamma$ 表示的闭合形式的解析表达式。你的推导必须从涨落电动力学和电磁边界响应的基本原理出发，并且必须明确使用 $\\omega_{s}$ 的共振条件和损耗参数。你可以假设，在静电极限下，真空-电介质界面上相关的 $p$ 偏振菲涅耳反射振幅为 $r_{p}(\\omega) = \\left(\\varepsilon(\\omega) - 1\\right)/\\left(\\varepsilon(\\omega) + 1\\right)$。\n\n你的最终答案必须是角频率 FWHM 的单一、闭合形式的解析表达式。不要将中间方程作为最终答案，也不要在最终表达式中包含任何单位。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **系统**：两个相同的半无限极性电介质半空间，由厚度为 $d$ 的真空间隙隔开。\n- **静电极限**：条件 $d \\ll c/\\omega_T$ 成立。\n- **介电常数**：每个电介质由 $\\varepsilon(\\omega) = \\varepsilon_{\\infty}\\left(1 + \\frac{\\omega_{L}^{2} - \\omega_{T}^{2}}{\\omega_{T}^{2} - \\omega^{2} - i \\Gamma\\, \\omega}\\right)$ 描述。\n- **参数**：高频介电常数 $\\varepsilon_{\\infty}  0$，横向光学声子角频率 $\\omega_{T}$，纵向光学声子角频率 $\\omega_{L}$，以及阻尼率 $\\Gamma \\ll \\omega_{T}$。\n- **磁性**：介质是非磁性的。\n- **主导机制**：近场光谱热传递由 $p$ 偏振倏逝模式主导。\n- **SPhP共振**：表面声子极化激元 (SPhP) 共振频率 $\\omega_{s}$ 由 $\\operatorname{Re}\\,\\varepsilon(\\omega_{s}) = -1$ 定义。\n- **任务**：在 $\\Gamma$ 的领头阶上，推导 $k$ 积分近场光谱透射增强峰的半峰全宽 (FWHM)，用 $\\varepsilon_{\\infty}$、$\\omega_{T}$、$\\omega_{L}$ 和 $\\Gamma$ 表示。\n- **给定公式**：静电极限下的 $p$ 偏振菲涅耳反射振幅为 $r_{p}(\\omega) = \\left(\\varepsilon(\\omega) - 1\\right)/\\left(\\varepsilon(\\omega) + 1\\right)$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于成熟的 Rytov 涨落电动力学理论用于近场热传递。介电常数的洛伦兹振子模型和表面声子极化激元的概念是凝聚态物理中的标准内容。所有前提在事实上和科学上都是合理的。\n- **适定性**：该问题设定了明确的目标：基于定义的物理模型、给定的参数和有效的近似（静电极限、低损耗），推导一个特定的量 (FWHM)。预期会有一个唯一的解。\n- **客观性**：该问题使用精确、客观和定量的语言表述。\n\n**步骤3：结论和行动**\n问题有效。将提供解答。\n\n**推导**\n\n在涨落电动力学框架内，两个物体之间单位面积的光谱热通量由 Landauer 公式给出。对于所述问题，仅考虑主导的 $p$ 偏振倏逝模式，光谱热传递系数（或透射增强）$H(\\omega)$ 由下式给出：\n$$\nH(\\omega) = \\int_{\\omega/c}^{\\infty} \\frac{k\\,dk}{2\\pi} \\mathcal{T}_p(\\omega, k)\n$$\n其中 $k$ 是平行于表面的波矢量的模。模式 $(\\omega, k)$ 的透射概率为：\n$$\n\\mathcal{T}_p(\\omega, k) = \\frac{4 (\\operatorname{Im}[r_p(\\omega,k)])^2 e^{-2 \\kappa d}}{|1 - r_p(\\omega,k)^2 e^{-2 \\kappa d}|^2}\n$$\n此处，$\\kappa = \\sqrt{k^2 - (\\omega/c)^2}$ 是真空间隙中的衰减常数。在静电极限 ($d \\ll c/\\omega_T$) 下，积分由大波矢量 $k \\gg \\omega/c$ 主导，此时 $\\kappa \\approx k$。菲涅耳反射系数 $r_p$ 也变得与 $k$ 无关，表示为 $r_p(\\omega) = (\\varepsilon(\\omega) - 1)/(\\varepsilon(\\omega) + 1)$。$k$ 积分的传递系数表达式变为：\n$$\nH(\\omega) = \\frac{2}{\\pi} (\\operatorname{Im}[r_p(\\omega)])^2 \\int_0^{\\infty} \\frac{k\\,e^{-2kd}}{|1 - r_p(\\omega)^2 e^{-2kd}|^2} \\, dk\n$$\n光谱热传递在表面声子极化激元 (SPhP) 共振附近出现尖锐峰值。这种共振发生在菲涅耳系数 $r_p(\\omega)$ 的分母趋近于零的频率处，即 $\\varepsilon(\\omega) \\to -1$。这个条件 $\\operatorname{Re}[\\varepsilon(\\omega_s)] = -1$ 定义了 SPhP 频率 $\\omega_s$。在此频率附近，$|r_p(\\omega)|$ 变得非常大，由于共振分母 $|1 - r_p^2 e^{-2kd}|^2$ 的存在，导致透射概率 $\\mathcal{T}_p$ 显著增强，该分母代表了跨越间隙的表面模式的耦合。对 $k$ 的积分将这些贡献加起来，导致 $H(\\omega)$ 在 $\\omega_s$ 附近出现一个峰值。\n\n为了在小损耗参数 $\\Gamma$ 的领头阶上找到此峰的 FWHM，我们分析其光谱形状。在强近场耦合（小 $d$）和低材料损耗（$\\Gamma$）的极限下，总热传递 $H(\\omega)$ 的光谱轮廓主要由材料表面模式的本征光谱响应决定。这些模式的光谱密度与函数 $g(\\omega) = \\operatorname{Im}[-1/(\\varepsilon(\\omega)+1)]$ 成正比。我们将推导这个函数的 FWHM，它为 $H(\\omega)$ 的 FWHM 提供了领头阶近似。\n$$\ng(\\omega) = \\operatorname{Im}\\left[\\frac{-1}{\\varepsilon(\\omega)+1}\\right] = \\operatorname{Im}\\left[\\frac{-1}{(\\operatorname{Re}[\\varepsilon]+1) + i\\operatorname{Im}[\\varepsilon]}\\right] = \\frac{\\operatorname{Im}[\\varepsilon]}{(\\operatorname{Re}[\\varepsilon]+1)^2 + (\\operatorname{Im}[\\varepsilon])^2}\n$$\n这个函数对于 $(\\operatorname{Re}[\\varepsilon]+1)$ 具有洛伦兹线型。峰值出现在 $\\operatorname{Re}[\\varepsilon(\\omega)] = -1$ 时，即在 $\\omega = \\omega_s$ 处。峰值为 $g_{max} = g(\\omega_s) = 1/\\operatorname{Im}[\\varepsilon(\\omega_s)]$。\n\nFWHM 可通过将 $g(\\omega)$ 设置为其最大值的一半，$g(\\omega_\\pm) = g_{max}/2$ 来找到。\n$$\n\\frac{\\operatorname{Im}[\\varepsilon(\\omega_\\pm)]}{(\\operatorname{Re}[\\varepsilon(\\omega_\\pm)]+1)^2 + (\\operatorname{Im}[\\varepsilon(\\omega_\\pm)])^2} = \\frac{1}{2\\operatorname{Im}[\\varepsilon(\\omega_s)]}\n$$\n由于对于小 $\\Gamma$ 峰是尖锐的，我们可以对于 FWHM 内的频率 $\\omega_\\pm$ 近似 $\\operatorname{Im}[\\varepsilon(\\omega_\\pm)] \\approx \\operatorname{Im}[\\varepsilon(\\omega_s)]$。该条件简化为：\n$$\n(\\operatorname{Re}[\\varepsilon(\\omega_\\pm)]+1)^2 + (\\operatorname{Im}[\\varepsilon(\\omega_s)])^2 = 2(\\operatorname{Im}[\\varepsilon(\\omega_s)])^2\n$$\n$$\n(\\operatorname{Re}[\\varepsilon(\\omega_\\pm)]+1)^2 = (\\operatorname{Im}[\\varepsilon(\\omega_s)])^2\n$$\n取平方根得到 $\\operatorname{Re}[\\varepsilon(\\omega_\\pm)]+1 = \\pm \\operatorname{Im}[\\varepsilon(\\omega_s)]$。\n\n在共振频率 $\\omega_s$ 附近，我们可以将 $\\operatorname{Re}[\\varepsilon(\\omega)]$ 在 $\\omega_s$ 附近进行泰勒展开：\n$\\operatorname{Re}[\\varepsilon(\\omega)] \\approx \\operatorname{Re}[\\varepsilon(\\omega_s)] + \\left.\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s}(\\omega - \\omega_s) = -1 + \\left.\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s}(\\omega - \\omega_s)$。\n所以，$\\operatorname{Re}[\\varepsilon(\\omega_\\pm)]+1 \\approx \\left.\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s}(\\omega_\\pm - \\omega_s)$。\n将此代入半峰值条件得到：\n$$\n\\left.\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s}(\\omega_\\pm - \\omega_s) = \\pm \\operatorname{Im}[\\varepsilon(\\omega_s)]\n$$\n因此，FWHM，$\\Delta\\omega = \\omega_+ - \\omega_-$ 为：\n$$\n\\Delta\\omega = 2\\frac{\\operatorname{Im}[\\varepsilon(\\omega_s)]}{\\left|\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s}}\n$$\n我们现在必须计算分子和分母。对于小 $\\Gamma$，$\\operatorname{Re}[\\varepsilon(\\omega)] \\approx \\varepsilon_{\\infty}(1 + \\frac{\\omega_{L}^{2} - \\omega_{T}^{2}}{\\omega_{T}^{2} - \\omega^{2}})$。\n对 $\\omega$ 的导数是：\n$$\n\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega} = \\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2) \\frac{-1}{(\\omega_T^2-\\omega^2)^2}(-2\\omega) = \\frac{2\\omega\\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2)}{(\\omega_T^2-\\omega^2)^2}\n$$\n从共振条件 $\\operatorname{Re}[\\varepsilon(\\omega_s)]=-1$，我们发现 $\\omega_T^2 - \\omega_s^2 = -\\frac{\\varepsilon_\\infty}{1+\\varepsilon_\\infty}(\\omega_L^2-\\omega_T^2)$。将此代入 $\\omega=\\omega_s$ 处的导数：\n$$\n\\left.\\frac{d(\\operatorname{Re}[\\varepsilon])}{d\\omega}\\right|_{\\omega_s} = \\frac{2\\omega_s\\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2)}{\\left(-\\frac{\\varepsilon_\\infty}{1+\\varepsilon_\\infty}(\\omega_L^2-\\omega_T^2)\\right)^2} = \\frac{2\\omega_s(1+\\varepsilon_\\infty)^2}{\\varepsilon_\\infty(\\omega_L^2-\\omega_T^2)}\n$$\n接下来，我们计算 $\\operatorname{Im}[\\varepsilon(\\omega_s)]$：\n$$\n\\operatorname{Im}[\\varepsilon(\\omega)] = \\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2) \\operatorname{Im}\\left[\\frac{1}{(\\omega_T^2-\\omega^2)-i\\Gamma\\omega}\\right] = \\frac{\\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2)\\Gamma\\omega}{(\\omega_T^2-\\omega^2)^2 + (\\Gamma\\omega)^2}\n$$\n在 $\\Gamma$ 的领头阶上，当 $\\omega = \\omega_s$ 时，我们可以忽略分母中的 $(\\Gamma\\omega_s)^2$ 项：\n$$\n\\operatorname{Im}[\\varepsilon(\\omega_s)] \\approx \\frac{\\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2)\\Gamma\\omega_s}{(\\omega_T^2-\\omega_s^2)^2} = \\frac{\\varepsilon_{\\infty}(\\omega_L^2-\\omega_T^2)\\Gamma\\omega_s}{\\left(-\\frac{\\varepsilon_\\infty}{1+\\varepsilon_\\infty}(\\omega_L^2-\\omega_T^2)\\right)^2} = \\frac{\\Gamma\\omega_s(1+\\varepsilon_\\infty)^2}{\\varepsilon_\\infty(\\omega_L^2-\\omega_T^2)}\n$$\n最后，我们计算 FWHM：\n$$\n\\Delta\\omega = 2 \\frac{\\frac{\\Gamma\\omega_s(1+\\varepsilon_\\infty)^2}{\\varepsilon_\\infty(\\omega_L^2-\\omega_T^2)}}{\\frac{2\\omega_s(1+\\varepsilon_\\infty)^2}{\\varepsilon_\\infty(\\omega_L^2-\\omega_T^2)}} = \\Gamma\n$$\n光谱峰的 FWHM，在阻尼参数的领头阶上，就是阻尼参数 $\\Gamma$ 本身。这个结果表明，材料的本征损耗决定了近场热发射共振的光谱宽度。", "answer": "$$\\boxed{\\Gamma}$$", "id": "2511634"}, {"introduction": "理论分析为我们提供了物理洞察力，而计算设计则让我们能够将这些洞察力转化为实际应用。本练习将引导你从分析转向综合，解决一个实际的材料优化问题。你将通过编写程序来优化一种具有多个共振峰的材料的介电函数，以在给定的热力学带宽内最大化总的热通量，从而亲身体验在窄带共振增强和宽带耦合性能之间的权衡与设计。[@problem_id:2511635]", "problem": "考虑两个相同的、局域响应的、各向同性的半无限介质，它们被厚度为 $d$ 的真空间隙隔开，支持近场辐射传热。从涨落-耗散定理和类 Landauer 的模式求和观点出发：对于由面内波矢大小 $q$ 和角频率 $\\omega$ 索引的每个倏逝模，净光谱热流由平均能量之差乘以一个透射因子给出。在针对 p 偏振倏逝波和相同介质的静电、大面内波矢近似下，对于一个固定的、满足 $q = \\alpha/d$ 的归一化面内衰减参数 $\\alpha$ 的代表性模式，其透射因子可以建模为\n$$\n\\mathcal{T}_{\\alpha}(\\omega) = \\frac{4 \\, \\left(\\operatorname{Im}\\, r_{p}(\\omega)\\right)^{2} \\, e^{-2 \\alpha}}{\\left| 1 - \\left(r_{p}(\\omega)\\right)^{2} e^{-2 \\alpha} \\right|^{2}}, \\quad r_{p}(\\omega) = \\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1},\n$$\n其中 $\\varepsilon(\\omega)$ 是材料的相对介电常数，$r_{p}(\\omega)$ 是准静态极限下的 Fresnel 反射系数。设角频率为 $\\omega$、绝对温度为 $T$ 的谐振子的平均能量为\n$$\n\\Theta(\\omega, T) = \\frac{\\hbar \\, \\omega}{\\exp\\!\\left(\\frac{\\hbar \\, \\omega}{k_{B} \\, T}\\right) - 1},\n$$\n其中 $\\hbar$ 是约化普朗克常数，$k_{B}$ 是玻尔兹曼常数。对于高温 $T_{h}$ 和低温 $T_{c}$，定义单模、带宽积分的无量纲性能指标\n$$\nJ = \\frac{1}{k_{B} \\, T_{h} \\, \\Delta \\omega} \\int_{\\omega_{\\min}}^{\\omega_{\\max}} \\left[ \\Theta(\\omega, T_{h}) - \\Theta(\\omega, T_{c}) \\right] \\, \\mathcal{T}_{\\alpha}(\\omega) \\, d\\omega,\n$$\n其中 $\\Delta \\omega = \\omega_{\\max} - \\omega_{\\min}$，所有符号的定义如上。根据其构造，指标 $J$ 是无量纲的。\n\n假设一个包含 $J_{r}$ 个振子的多共振 Lorentz 介电常数模型，\n$$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty} + \\sum_{j=1}^{J_{r}} \\frac{s_{j} \\, \\omega_{j}^{2}}{\\omega_{j}^{2} - \\omega^{2} - i \\, \\gamma_{j} \\, \\omega},\n$$\n其中 $\\varepsilon_{\\infty}$ 是高频背景介电常数，$\\omega_{j}$ 是共振角频率，$\\gamma_{j}$ 是阻尼率，$s_{j} \\ge 0$ 是待优化的无量纲振子强度，且受到总振子强度预算约束 $\\sum_{j=1}^{J_{r}} s_{j} \\le S_{\\mathrm{tot}}$ 的限制。除 $\\{s_{j}\\}_{j=1}^{J_{r}}$ 外，所有参数都是固定和给定的。\n\n你的任务是编写一个程序，为下方的每个测试案例求解以下约束优化问题：\n- 决策变量：$\\{ s_{j} \\}_{j=1}^{J_{r}}$，其边界为 $s_{j} \\in [0, S_{\\mathrm{tot}}]$，并满足线性约束 $\\sum_{j=1}^{J_{r}} s_{j} \\le S_{\\mathrm{tot}}$。\n- 目标：最大化上文定义的无量纲性能指标 $J$。\n- 模型：使用上文指定的透射因子 $\\mathcal{T}_{\\alpha}(\\omega)$ 和介电常数 $\\varepsilon(\\omega)$。\n\n将你的推理和公式建立在涨落-耗散定理、辐射传输的 Landauer 形式理论以及静电极限下的 Fresnel 反射系数之上，并仅清晰地编码所指定的最终模型。你必须以数值方式执行频率积分和优化，确保收敛到局部最大值。使用足够精细的频率采样来解析共振和热窗口。在内部处理时，所有常数均采用国际单位制 (SI)。最终答案必须是无量纲的，并以浮点数形式报告。\n\n测试套件（每行指定一个案例及其所有参数）：\n- 案例 A（理想路径，双共振，中等阻尼，中等间隙模式选择性）：\n  - $J_{r} = 2$, $\\varepsilon_{\\infty} = 1$, $S_{\\mathrm{tot}} = 6$, $\\alpha = 1$,\n  - $(\\omega_{1}, \\omega_{2}) = (1.2 \\times 10^{14}, \\, 2.0 \\times 10^{14})$ rad/s,\n  - $(\\gamma_{1}, \\gamma_{2}) = (0.05 \\, \\omega_{1}, \\, 0.05 \\, \\omega_{2})$,\n  - $T_{h} = 1200$ K, $T_{c} = 300$ K,\n  - $(\\omega_{\\min}, \\omega_{\\max}) = (0.6 \\times 10^{14}, \\, 3.0 \\times 10^{14})$ rad/s。\n- 案例 B（更宽的设计空间，三共振，稍高的阻尼，较小 $\\alpha$ 带来的每模式更强的耦合）：\n  - $J_{r} = 3$, $\\varepsilon_{\\infty} = 1$, $S_{\\mathrm{tot}} = 6$, $\\alpha = 0.5$,\n  - $(\\omega_{1}, \\omega_{2}, \\omega_{3}) = (0.8 \\times 10^{14}, \\, 1.6 \\times 10^{14}, \\, 2.4 \\times 10^{14})$ rad/s,\n  - $(\\gamma_{1}, \\gamma_{2}, \\gamma_{3}) = (0.08 \\, \\omega_{1}, \\, 0.08 \\, \\omega_{2}, \\, 0.08 \\, \\omega_{3})$,\n  - $T_{h} = 1200$ K, $T_{c} = 300$ K,\n  - $(\\omega_{\\min}, \\omega_{\\max}) = (0.4 \\times 10^{14}, \\, 2.4 \\times 10^{14})$ rad/s。\n- 案例 C（边界情况，强调宽带而非窄带：较少的振子，高阻尼，较大 $\\alpha$ 带来的较弱模态耦合）：\n  - $J_{r} = 2$, $\\varepsilon_{\\infty} = 1$, $S_{\\mathrm{tot}} = 3$, $\\alpha = 2$,\n  - $(\\omega_{1}, \\omega_{2}) = (1.0 \\times 10^{14}, \\, 1.4 \\times 10^{14})$ rad/s,\n  - $(\\gamma_{1}, \\gamma_{2}) = (0.15 \\, \\omega_{1}, \\, 0.15 \\, \\omega_{2})$,\n  - $T_{h} = 1200$ K, $T_{c} = 300$ K,\n  - $(\\omega_{\\min}, \\omega_{\\max}) = (0.8 \\times 10^{14}, \\, 2.0 \\times 10^{14})$ rad/s。\n\n本问题不涉及角度单位。所有物理常数和参数在内部均使用 SI 单位。要求的输出是无量纲浮点数。\n\n你的程序必须：\n- 实现上述模型，对给定的任何 $\\{ s_{j} \\}$ 通过对 $\\omega$ 进行数值积分来计算 $J$，并在规定约束下对每个案例进行数值最大化 $J$。\n- 对于数值积分，使用足够精细的频率网格以解析热窗口内的窄共振；你可以自适应或均匀地选择网格，但对每个案例必须是固定的。\n- 对于优化，使用带有多个确定性初始化的约束非线性优化器以缓解局部最大值问题；返回找到的最佳值。\n- 对每个案例，仅报告最优目标值 $J^{\\star}$，形式为无量纲浮点数，四舍五入到小数点后六位。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[xA,xB,xC]\"），其中 $xA$、$xB$ 和 $xC$ 分别是对应于案例 A、B 和 C 的三个四舍五入后的无量纲最优值。", "solution": "问题陈述已经过严格验证，并被认定为科学上合理、内部一致且良定的。它提出了纳米尺度传热领域，特别是近场热辐射范畴内的一个标准但非平凡的优化任务。解决方案从涨落电动力学和统计力学的基本原理出发，通过一个鲁棒的数值优化框架来实现。\n\n问题的核心是为一个由参数 $\\alpha$ 表征的单一倏逝模最大化无量纲传热指标 $J$。该指标定义为在指定频带 $[\\omega_{\\min}, \\omega_{\\max}]$ 上的积分：\n$$\nJ = \\frac{1}{k_{B} \\, T_{h} \\, \\Delta \\omega} \\int_{\\omega_{\\min}}^{\\omega_{\\max}} \\left[ \\Theta(\\omega, T_{h}) - \\Theta(\\omega, T_{c}) \\right] \\, \\mathcal{T}_{\\alpha}(\\omega) \\, d\\omega\n$$\n其中 $\\Delta \\omega = \\omega_{\\max} - \\omega_{\\min}$。优化变量是振子强度 $\\{s_{j}\\}_{j=1}^{J_{r}}$，它们决定了材料的介电响应。\n\n被积函数是两个关键部分的乘积：\n1. 每模式的净可用热能，由量子振子在高温 $T_h$ 和低温 $T_c$ 下的平均能量之差给出：\n$$\n\\Delta\\Theta(\\omega, T_h, T_c) = \\Theta(\\omega, T_{h}) - \\Theta(\\omega, T_{c}) = \\frac{\\hbar \\, \\omega}{\\exp\\!\\left(\\frac{\\hbar \\, \\omega}{k_{B} \\, T_{h}}\\right) - 1} - \\frac{\\hbar \\, \\omega}{\\exp\\!\\left(\\frac{\\hbar \\, \\omega}{k_{B} \\, T_{c}}\\right) - 1}\n$$\n该项由普朗克定律决定，定义了传热最显著的光谱窗口。\n\n2. 透射因子 $\\mathcal{T}_{\\alpha}(\\omega)$，它量化了一个 p 偏振倏逝模的能量转移概率。在静电极限下，它由下式给出：\n$$\n\\mathcal{T}_{\\alpha}(\\omega) = \\frac{4 \\, \\left(\\operatorname{Im}\\, r_{p}(\\omega)\\right)^{2} \\, e^{-2 \\alpha}}{\\left| 1 - \\left(r_{p}(\\omega)\\right)^{2} e^{-2 \\alpha} \\right|^{2}}\n$$\n这个因子取决于两个要素：几何耦合 $e^{-2 \\alpha}$（它随归一化波矢 $\\alpha$ 指数衰减），以及封装在 Fresnel 反射系数 $r_{p}(\\omega)$ 中的材料属性。对于准静态极限（$q \\gg \\omega/c$）下的 p 偏振波，该系数为：\n$$\nr_{p}(\\omega) = \\frac{\\varepsilon(\\omega) - 1}{\\varepsilon(\\omega) + 1}\n$$\n当满足表面极化激元共振的条件时（对于单个界面，该条件为 $\\varepsilon(\\omega) \\approx -1$），透射可以被显著增强。这一共振条件会导致 $r_p(\\omega)$ 的分母很小，并在 $\\mathcal{T}_{\\alpha}(\\omega)$ 中产生一个峰值，前提是材料具有一定的损耗（$\\operatorname{Im}\\,\\varepsilon(\\omega)  0$）。\n\n决策变量，即振子强度 $\\{s_{j}\\}$，通过多共振 Lorentz 模型直接控制材料的相对介电常数 $\\varepsilon(\\omega)$：\n$$\n\\varepsilon(\\omega) = \\varepsilon_{\\infty} + \\sum_{j=1}^{J_{r}} \\frac{s_{j} \\, \\omega_{j}^{2}}{\\omega_{j}^{2} - \\omega^{2} - i \\, \\gamma_{j} \\, \\omega}\n$$\n因此，优化问题是选择一组非负的振子强度 $\\{s_{j}\\}_{j=1}^{J_r}$，使其满足预算约束 $\\sum_{j=1}^{J_{r}} s_{j} \\le S_{\\mathrm{tot}}$，并最大化目标函数 $J(\\{s_j\\})$。\n\n由于积分对变量 $s_j$ 具有复杂的非线性依赖关系，该问题不存在闭式解析解。因此，需要采用数值方法。\n\n**数值方法：**\n1. **数值积分：** 使用梯形法则对定义 $J$ 的积分进行数值计算。在积分范围 $[\\omega_{\\min}, \\omega_{\\max}]$ 上采用一个包含 $4096$ 个点的精细、均匀的频率网格。选择此网格分辨率是为了确保其足够密集，能够精确解析最窄的光谱特征，即由阻尼参数 $\\gamma_j$ 决定宽度的 Lorentz 共振。\n\n2. **约束非线性优化：** 将 $J$ 的最大化问题表述为非线性规划问题。目标函数是 $-J(\\{s_j\\})$，需要将其最小化。约束条件是振子强度的非负性 $s_j \\ge 0$ 和总预算 $\\sum_{j=1}^{J_{r}} s_j \\le S_{\\mathrm{tot}}$。采用序列最小二乘规划 (SLSQP) 算法，因为它非常适合此类约束问题。\n\n3. **全局优化策略：** 目标函数 $J$ 不保证是凹函数，这意味着可能存在多个局部最大值。为了解决这个问题并增加找到全局最大值的可信度，我们实施了多起点优化策略。对于每个测试案例，优化器从一组确定性的 $\\{s_j\\}$ 初始点开始运行，这些初始点策略性地覆盖了可行域（一个单纯形）。该点集包括原点、重心以及边界框的顶点。在所有运行中找到的最高最大值将作为最优解 $J^{\\star}$ 进行报告。\n\n这种系统性的方法确保了对所提出的优化问题得到一个鲁棒且可验证的解，并将计算过程建立在近场传热的既有物理学基础之上。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the constrained optimization problem for near-field radiative heat transfer\n    for three distinct test cases.\n    \"\"\"\n    # Physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant (J*s)\n    KB = 1.380649e-23      # Boltzmann constant (J/K)\n    \n    # Numerical integration parameter\n    N_OMEGA = 4096  # Number of frequency points for integration\n\n    test_cases = [\n        {\n            'name': 'A',\n            'Jr': 2, 'eps_inf': 1, 'Stot': 6, 'alpha': 1,\n            'omega_j': np.array([1.2e14, 2.0e14]),\n            'gamma_j_factor': 0.05,\n            'Th': 1200, 'Tc': 300,\n            'omega_min': 0.6e14, 'omega_max': 3.0e14,\n        },\n        {\n            'name': 'B',\n            'Jr': 3, 'eps_inf': 1, 'Stot': 6, 'alpha': 0.5,\n            'omega_j': np.array([0.8e14, 1.6e14, 2.4e14]),\n            'gamma_j_factor': 0.08,\n            'Th': 1200, 'Tc': 300,\n            'omega_min': 0.4e14, 'omega_max': 2.4e14,\n        },\n        {\n            'name': 'C',\n            'Jr': 2, 'eps_inf': 1, 'Stot': 3, 'alpha': 2,\n            'omega_j': np.array([1.0e14, 1.4e14]),\n            'gamma_j_factor': 0.15,\n            'Th': 1200, 'Tc': 300,\n            'omega_min': 0.8e14, 'omega_max': 2.0e14,\n        },\n    ]\n\n    # Pre-process gamma_j values which are dependent on omega_j\n    for case in test_cases:\n        case['gamma_j'] = case['gamma_j_factor'] * case['omega_j']\n\n    def setup_objective_function(case):\n        \"\"\"Creates a closure for the objective function for a given case.\"\"\"\n        Jr = case['Jr']\n        eps_inf = case['eps_inf']\n        alpha = case['alpha']\n        omega_j_vec = case['omega_j']\n        gamma_j_vec = case['gamma_j']\n        Th, Tc = case['Th'], case['Tc']\n        omega_min, omega_max = case['omega_min'], case['omega_max']\n        \n        delta_omega = omega_max - omega_min\n        omega_grid = np.linspace(omega_min, omega_max, N_OMEGA)\n        \n        # Pre-calculate terms independent of the optimization variable 's'\n        term_h = HBAR * omega_grid / (KB * Th)\n        term_c = HBAR * omega_grid / (KB * Tc)\n        theta_h = (HBAR * omega_grid) / np.expm1(term_h)\n        theta_c = (HBAR * omega_grid) / np.expm1(term_c)\n        energy_diff = theta_h - theta_c\n        \n        norm_factor = 1.0 / (KB * Th * delta_omega)\n        \n        omega_grid_sq = omega_grid**2\n        lorentz_terms = np.array([\n            (omega_j**2) / (omega_j**2 - omega_grid_sq - 1j * gamma_j * omega_grid)\n            for omega_j, gamma_j in zip(omega_j_vec, gamma_j_vec)\n        ])\n        \n        exp_2alpha = np.exp(-2.0 * alpha)\n\n        def objective(s):\n            \"\"\"The objective function to be minimized (-J). `s` is the vector of oscillator strengths.\"\"\"\n            epsilon = eps_inf + np.tensordot(s, lorentz_terms, axes=1)\n            rp = (epsilon - 1.0) / (epsilon + 1.0)\n            transmission = (4.0 * np.imag(rp)**2 * exp_2alpha) / (np.abs(1.0 - rp**2 * exp_2alpha)**2 + 1e-40)\n            integrand = energy_diff * transmission\n            integral_val = np.trapz(integrand, omega_grid)\n            J = norm_factor * integral_val\n            return -J\n\n        return objective\n\n    final_results = []\n    for case in test_cases:\n        Jr, Stot = case['Jr'], case['Stot']\n        \n        objective_func = setup_objective_function(case)\n        \n        bounds = [(0, Stot)] * Jr\n        constraints = [{'type': 'ineq', 'fun': lambda s: Stot - np.sum(s)}]\n        \n        initial_points = []\n        initial_points.append(np.zeros(Jr))\n        initial_points.append(np.full(Jr, Stot / Jr))\n        for i in range(Jr):\n            p = np.zeros(Jr)\n            p[i] = Stot\n            initial_points.append(p)\n            \n        best_J = -np.inf\n        \n        for s0 in initial_points:\n            res = minimize(\n                objective_func, s0, method='SLSQP', bounds=bounds,\n                constraints=constraints, options={'ftol': 1e-9}\n            )\n            if res.success and -res.fun > best_J:\n                best_J = -res.fun\n        \n        final_results.append(round(best_J, 6))\n\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "2511635"}]}