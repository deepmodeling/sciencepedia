{"hands_on_practices": [{"introduction": "要真正掌握加权灰体气体总和模型（WSGGM），我们首先需要理解其核心的数学与物理行为。本练习将探讨气体发射率如何随气体层厚度变化，从而揭示模型中蕴含的基本物理原理。通过分析发射率对路径长度的导数，您将从数学上理解吸收饱和现象[@problem_id:2538223]，即将抽象的公式与具体的物理直觉联系起来，为后续应用打下坚实基础。", "problem": "一个厚度为 $L$ 的等温、等压、均匀的参与性气体层被限制在两个大的、等温的、黑色的平行板之间。气体混合物及其热力学状态是固定的，因此任何依赖于温度、压力或成分的辐射性质都可以被视为关于 $L$ 的常数。对于这样的配置，总气体发射率 $ \\varepsilon_{g}(L) $ 定义为从气体朝向一个黑体壁的半球普朗克平均发射，并用气体温度下的黑体发射进行归一化。\n\n从单色衰减的比尔-朗伯定律以及对于等温层在黑体壁之间，总发射率等于一减去总透射率的论述出发，灰体气体加权和模型将总透射率表示为指数的加权和。因此，总气体发射率被建模为\n$$\n\\varepsilon_{g}(L) \\;=\\; 1 \\;-\\; \\sum_{i=0}^{N} a_{i}\\,\\exp\\!\\big(-\\beta_{i}\\,L\\big),\n$$\n其中 $N$ 是一个正整数，权重满足 $a_{i}\\ge 0$ 和 $\\sum_{i=0}^{N} a_{i}=1$，并且组衰减参数满足 $\\beta_{0}=0$ 和对于所有 $i\\in\\{1,2,\\dots,N\\}$ 都有 $\\beta_{i}0$。常数 $a_{i}$ 和 $\\beta_{i}$ 可能依赖于气体温度和成分，但在所述条件下与 $L$ 无关。\n\n1) 计算一阶和二阶导数 $\\partial \\varepsilon_{g}/\\partial L$ 和 $\\partial^{2} \\varepsilon_{g}/\\partial L^{2}$，作为 $L$、$a_{i}$ 和 $\\beta_{i}$ 的函数。\n\n2) 基于您的表达式，用随着光学厚度增加吸收达到饱和的物理概念来解释当 $L0$ 时这些导数的符号。\n\n将您第1部分的最终答案表示为一对符号形式的闭式解析表达式。不需要数值计算，也不需要单位。表达式必须仅是 $L$、$a_{i}$ 和 $\\beta_{i}$ 的函数。", "solution": "问题陈述已提交进行验证。\n\n**第1步：提取已知条件**\n- 系统是一个厚度为 $L$ 的等温、等压、均匀的参与性气体层。\n- 该层位于两个大的、等温的、黑色的平行板之间。\n- 依赖于温度、压力或成分的辐射性质相对于 $L$ 是常数。\n- 总气体发射率由灰体气体加权和 (WSGG) 模型建模：\n$$ \\varepsilon_{g}(L) \\;=\\; 1 \\;-\\; \\sum_{i=0}^{N} a_{i}\\,\\exp\\!\\big(-\\beta_{i}\\,L\\big) $$\n- 模型参数的约束条件：\n  - $N$ 是一个正整数。\n  - 权重：对于所有 $i\\in\\{0, 1, \\dots, N\\}$，$a_{i}\\ge 0$，且 $\\sum_{i=0}^{N} a_{i}=1$。\n  - 衰减参数：$\\beta_{0}=0$，且对于所有 $i\\in\\{1,2,\\dots,N\\}$，$\\beta_{i}0$。\n- 常数 $a_{i}$ 和 $\\beta_{i}$ 与 $L$ 无关。\n- 任务是：\n  1. 计算导数 $\\partial \\varepsilon_{g}/\\partial L$ 和 $\\partial^{2} \\varepsilon_{g}/\\partial L^{2}$。\n  2. 解释当 $L0$ 时这些导数的符号。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在科学上是合理的。它描述了标准的一维灰体气体加权和模型，这是非灰体气体辐射传热工程分析中被广泛接受和基础的工具。物理设置和数学公式都是经典的。\n- **适定性**：该问题是适定的。它要求对一个定义明确、连续可微的函数进行微分，并对结果进行物理解释。所有必需的参数和约束都已提供，确保了唯一解的存在。\n- **客观性**：问题以精确、客观、技术性的语言陈述，没有歧义或主观内容。\n\n**第3步：结论与行动**\n问题有效。这是一个将微积分应用于辐射传热核心模型的标准练习。将提供解答。\n\n**第1部分：导数计算**\n\n总气体发射率 $\\varepsilon_{g}$ 作为层厚度 $L$ 的函数给出：\n$$\n\\varepsilon_{g}(L) = 1 - \\sum_{i=0}^{N} a_{i} \\exp(-\\beta_{i} L)\n$$\n为了求关于 $L$ 的一阶导数，我们对表达式逐项微分。常数 $1$ 的导数为零。和的微分是微分的和。\n$$\n\\frac{\\partial \\varepsilon_{g}}{\\partial L} = \\frac{\\partial}{\\partial L} \\left( 1 - \\sum_{i=0}^{N} a_{i} \\exp(-\\beta_{i} L) \\right)\n$$\n$$\n\\frac{\\partial \\varepsilon_{g}}{\\partial L} = 0 - \\sum_{i=0}^{N} a_{i} \\frac{\\partial}{\\partial L} \\left( \\exp(-\\beta_{i} L) \\right)\n$$\n使用微分的链式法则，其中 $\\frac{d}{dx} \\exp(kx) = k\\exp(kx)$，我们得到：\n$$\n\\frac{\\partial \\varepsilon_{g}}{\\partial L} = - \\sum_{i=0}^{N} a_{i} (-\\beta_{i}) \\exp(-\\beta_{i} L)\n$$\n$$\n\\frac{\\partial \\varepsilon_{g}}{\\partial L} = \\sum_{i=0}^{N} a_{i} \\beta_{i} \\exp(-\\beta_{i} L)\n$$\n这是一阶导数的表达式。\n\n为了求二阶导数，我们对一阶导数关于 $L$ 进行微分：\n$$\n\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}} = \\frac{\\partial}{\\partial L} \\left( \\sum_{i=0}^{N} a_{i} \\beta_{i} \\exp(-\\beta_{i} L) \\right)\n$$\n$$\n\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}} = \\sum_{i=0}^{N} a_{i} \\beta_{i} \\frac{\\partial}{\\partial L} \\left( \\exp(-\\beta_{i} L) \\right)\n$$\n再次应用链式法则：\n$$\n\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}} = \\sum_{i=0}^{N} a_{i} \\beta_{i} (-\\beta_{i}) \\exp(-\\beta_{i} L)\n$$\n$$\n\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}} = - \\sum_{i=0}^{N} a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L)\n$$\n这是二阶导数的表达式。\n\n**第2部分：符号的物理解释**\n\n我们分析当物理路径长度 $L  0$ 时导数的符号。\n\n**一阶导数的符号，$\\frac{\\partial \\varepsilon_{g}}{\\partial L}$：**\n表达式为 $\\frac{\\partial \\varepsilon_{g}}{\\partial L} = \\sum_{i=0}^{N} a_{i} \\beta_{i} \\exp(-\\beta_{i} L)$。\n让我们检查求和中的各项：\n- 权重是非负的：$a_{i} \\ge 0$。\n- 对于有限的 $L$ 和 $\\beta_i$，指数函数 $\\exp(-\\beta_{i} L)$ 总是正的。\n- 衰减参数满足 $\\beta_{0}=0$ 和当 $i \\ge 1$ 时 $\\beta_{i}0$。\n$i=0$ 的项是 $a_{0}\\beta_{0}\\exp(-\\beta_{0}L) = a_{0}(0)\\exp(0) = 0$。该项代表气体吸收光谱中的“光学透明窗口”，无论路径长度如何，它对吸收或发射都没有贡献。\n对于所有 $i \\in \\{1, 2, \\dots, N\\}$，我们有 $a_{i} \\ge 0$ 和 $\\beta_{i}  0$。因此，每一项 $a_{i} \\beta_{i} \\exp(-\\beta_{i} L)$ 都是非负的。\n这个和是非负项的和。假设气体不是完全透明的（即，对于 $i \\ge 1$ 至少有一个 $a_{i}  0$），那么这个和将是严格正的。\n$$\n\\frac{\\partial \\varepsilon_{g}}{\\partial L} > 0 \\quad (\\text{对于非透明气体})\n$$\n物理上，这个正号意味着气体层的总发射率 $\\varepsilon_{g}$ 随着其厚度 $L$ 的增加而增加。这是符合逻辑的：更厚的气体层包含更多的参与性分子来发射辐射，从而增加了体积的总发射，前提是气体尚未有效地变为黑体。\n\n**二阶导数的符号，$\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}}$：**\n表达式为 $\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}} = - \\sum_{i=0}^{N} a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L)$。\n让我们检查和 $\\sum_{i=0}^{N} a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L)$：\n- 如前所述，$a_{i} \\ge 0$ 且 $\\exp(-\\beta_{i} L)  0$。\n- 参数 $\\beta_{i}^{2}$ 是非负的，其中 $\\beta_{0}^{2} = 0$ 且当 $i \\ge 1$ 时 $\\beta_{i}^{2}  0$。\n$i=0$ 的项是 $a_{0}\\beta_{0}^{2}\\exp(-\\beta_{0}L) = 0$。\n对于所有 $i \\in \\{1, 2, \\dots, N\\}$，项 $a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L)$ 是非负的。\n因此，和 $\\sum_{i=0}^{N} a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L)$ 是非负项的和。对于非透明气体，这个和是严格正的。\n二阶导数是这个和的负值。\n$$\n\\frac{\\partial^{2} \\varepsilon_{g}}{\\partial L^{2}}  0 \\quad (\\text{对于非透明气体})\n$$\n物理上，二阶导数的负号表示函数 $\\varepsilon_{g}(L)$ 是向下凹的。这意味着发射率的增长率 $\\frac{\\partial \\varepsilon_{g}}{\\partial L}$ 随着层厚度 $L$ 的增加而减小。这种现象被称为**饱和**。\n对于薄气体层（小 $L$），随着 $L$ 的增长，发射率急剧增加，因为每个额外的气体子层都对发射有显著贡献。然而，随着气体层变得光学厚，源自气体深处的辐射在逸出之前越来越多地被气体本身重新吸收。这种自吸收效应意味着，向已经很厚的气体层中增加更多的气体，对观察到的总发射的影响会减小。在极限情况下，当 $L \\to \\infty$ 时，气体变得不透明（像黑体一样），其发射率接近一个最大值（小于或等于 $1-a_0$，因为 $a_0$ 是透明气体的权重），发射率的增长率接近于零。负的二阶导数是这种饱和行为的数学特征。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sum_{i=0}^{N} a_{i} \\beta_{i} \\exp(-\\beta_{i} L)  - \\sum_{i=0}^{N} a_{i} \\beta_{i}^{2} \\exp(-\\beta_{i} L) \\end{pmatrix}}\n$$", "id": "2538223"}, {"introduction": "现实世界中的辐射气体（如燃烧产物）总是混合物，因此正确处理多组分气体是应用WSGGM的关键。本练习将指导您计算水蒸气和二氧化碳混合物的总发射率。您将学习到处理混合物的标准方法，并量化一种常见简化假设所带来的误差[@problem_id:2538186]，从而掌握在实际工程问题中准确应用该模型的技能。", "problem": "一个厚度为 $L$ 的等温、均匀、非散射气体层被限制在两个大的、黑色的、冷的壁之间，因此只有来自气体的发射对离开该层的辐射热有贡献。该气体是水蒸气和二氧化碳的二元混合物，其分压分别为 $p_{\\text{H2O}}$ 和 $p_{\\text{CO2}}$。假设局部热力学平衡，并且对于这种几何形状，半球发射率等于法向吸收率。你需要使用加权灰体气体总和模型 (WSGGM) 对定向（法向）总发射率进行建模，下面给出了特定于物种的灰体气体参数。\n\n从 Beer–Lambert 衰减、通过 Kirchhoff 定律定义的气体发射率，以及谱带平均透射率可以表示为具有温度相关权重和物种特定灰体吸收系数的指数加权和的建模思想出发，推导你将用来计算混合物发射率的表达式。然后根据所提供的数据进行评估。\n\n数据：\n- 气体温度 $T = 1600\\,\\text{K}$。\n- 气体层厚度 $L = 1.2\\,\\text{m}$。\n- 分压 $p_{\\text{H2O}} = 0.25\\,\\text{bar}$ 和 $p_{\\text{CO2}} = 0.15\\,\\text{bar}$。\n- 对于 $T = 1600\\,\\text{K}$，使用三个灰体气体项和一个透明气体项。与温度相关的权重为 $a_{1} = 0.25$，$a_{2} = 0.35$，$a_{3} = 0.22$，透明气体权重为 $a_{0} = 0.18$。\n- 在 $T=1600\\,\\text{K}$ 时，物种特定的灰体吸收系数 $k_{j,s}$（单位为 $\\text{m}^{-1}\\,\\text{bar}^{-1}$）如下：\n  - 水蒸气：$k_{1,\\text{H2O}} = 0.10$，$k_{2,\\text{H2O}} = 1.20$，$k_{3,\\text{H2O}} = 10.0$。\n  - 二氧化碳：$k_{1,\\text{CO2}} = 0.050$，$k_{2,\\text{CO2}} = 0.70$，$k_{3,\\text{CO2}} = 6.0$。\n\n任务：\n1. 使用特定于物种的 WSGGM 参数，计算在给定 $L$、$p_{\\text{H2O}}$ 和 $p_{\\text{CO2}}$ 条件下，混合物在 $T = 1600\\,\\text{K}$ 时的法向总发射率。\n2. 现在假设一个“有效单物种”WSGGM，其中混合物被（不正确地）视为在总分压 $p_{\\text{tot}} = p_{\\text{H2O}} + p_{\\text{CO2}}$ 下的纯水蒸气，使用相同的灰体气体权重和水蒸气系数 $k_{j,\\text{H2O}}$。计算相应的发射率。\n3. 以第1部分的发射率作为参考，计算有效单物种模型的相对误差，定义为 $(\\varepsilon_{\\text{eff}} - \\varepsilon_{\\text{mix}})/\\varepsilon_{\\text{mix}}$。\n\n将你的最终答案以单行矩阵中的两个数字形式报告，顺序为 $(\\varepsilon_{\\text{mix}}, (\\varepsilon_{\\text{eff}} - \\varepsilon_{\\text{mix}})/\\varepsilon_{\\text{mix}})$，四舍五入到四位有效数字。这两个量都是无量纲的。不要在最终的方框答案中包含单位。", "solution": "首先将对所述问题的科学性和逻辑完整性进行验证。\n\n步骤1：提取已知条件\n-   几何：厚度为 $L$ 的等温、均匀、非散射气体层。\n-   边界：两个大的、黑色的、冷的壁。\n-   气体成分：水蒸气（$\\text{H}_2\\text{O}$）和二氧化碳（$\\text{CO}_2$）的二元混合物。\n-   气体状态：温度 $T = 1600\\,\\text{K}$，分压 $p_{\\text{H2O}} = 0.25\\,\\text{bar}$，分压 $p_{\\text{CO2}} = 0.15\\,\\text{bar}$。\n-   气体层厚度：$L = 1.2\\,\\text{m}$。\n-   模型：用于定向（法向）总发射率的加权灰体气体总和模型 (WSGGM)。\n-   假设：局部热力学平衡 (LTE)，半球发射率等于法向吸收率。\n-   $T = 1600\\,\\text{K}$ 时的 WSGGM 参数：\n    -   灰体气体数量：$N=3$，外加一个透明气体项 ($j=0$)。\n    -   与温度相关的权重：$a_{1} = 0.25$，$a_{2} = 0.35$，$a_{3} = 0.22$，$a_{0} = 0.18$。\n    -   物种特定的灰体吸收系数 $k_{j,s}$（单位 $\\text{m}^{-1}\\,\\text{bar}^{-1}$）：\n        -   水蒸气（$\\text{H}_2\\text{O}$）：$k_{1,\\text{H2O}} = 0.10$，$k_{2,\\text{H2O}} = 1.20$，$k_{3,\\text{H2O}} = 10.0$。\n        -   二氧化碳（$\\text{CO}_2$）：$k_{1,\\text{CO2}} = 0.050$，$k_{2,\\text{CO2}} = 0.70$，$k_{3,\\text{CO2}} = 6.0$。\n\n步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于 WSGGM，这是一种用于计算燃烧气体辐射特性的标准且广泛使用的工程模型。它牢固地建立在辐射传热原理之上。\n-   **适定性**：该问题提供了所有必要的数据和一组明确的任务，从而可以得到唯一的解。给定权重的总和为 $a_0 + a_1 + a_2 + a_3 = 0.18 + 0.25 + 0.35 + 0.22 = 1.00$，这是模型一致性的必要条件。\n-   **客观性**：语言精确且定量。\n-   **无缺陷**：该问题没有违反任何科学原理，不完整或矛盾，也不是微不足道的。它代表了 WSGGM 在气体混合物中的一个标准应用。\n\n步骤3：结论和行动\n问题是有效的。将提供一个完整的、有理有据的解答。\n\n**混合物发射率表达式的推导**\n\n问题要求从基本原理出发，推导混合物发射率的 WSGGM 表达式。\n\n1.  根据 Beer-Lambert 定律，厚度为 $L$、光谱吸收系数为 $\\kappa_{\\nu}$ 的均匀气体层的光谱透射率 $\\tau_{\\nu}$ 由下式给出：\n    $$ \\tau_{\\nu} = \\exp(-\\kappa_{\\nu} L) $$\n2.  对于处于局部热力学平衡 (LTE) 的气体，Kirchhoff 定律将光谱发射率 $\\varepsilon_{\\nu}$ 等同于光谱吸收率 $\\alpha_{\\nu}$。对于非散射介质，$\\alpha_{\\nu} = 1 - \\tau_{\\nu}$。因此：\n    $$ \\varepsilon_{\\nu} = \\alpha_{\\nu} = 1 - \\tau_{\\nu} = 1 - \\exp(-\\kappa_{\\nu} L) $$\n3.  总发射率 $\\varepsilon$ 是光谱发射率在所有波数 $\\nu$ 上按 Planck 函数加权的平均值：\n    $$ \\varepsilon = \\frac{\\int_0^\\infty \\varepsilon_{\\nu} E_{b\\nu}(T) d\\nu}{\\int_0^\\infty E_{b\\nu}(T) d\\nu} = \\frac{1}{\\sigma T^4} \\int_0^\\infty \\left(1 - \\exp(-\\kappa_{\\nu} L)\\right) E_{b\\nu}(T) d\\nu $$\n    其中 $E_{b\\nu}(T)$ 是光谱黑体发射功率。\n4.  WSGGM 通过将气体表示为 $N$ 个灰体气体和一个透明气体（$j=0$，$\\kappa_0=0$）的假设混合物来近似这个复杂的积分。总发射率表示为这些灰体气体发射率的加权和：\n    $$ \\varepsilon \\approx \\sum_{j=0}^{N} a_j(T) \\varepsilon_j $$\n    权重 $a_j(T)$ 代表由第 $j$ 个灰体气体建模的光谱区域中黑体发射功率的分数，根据定义，$\\sum_{j=0}^{N} a_j(T) = 1$。透明气体的发射率为 $\\varepsilon_0 = 1 - \\exp(-0 \\cdot L) = 0$。因此，求和是对吸收性灰体气体进行的（$j=1, \\dots, N$）：\n    $$ \\varepsilon = \\sum_{j=1}^{N} a_j(T) \\left(1 - \\exp(-\\kappa_j L)\\right) $$\n5.  对于非反应性气体混合物，第 $j$ 个灰体气体的吸收系数 $\\kappa_j$ 由物种特定系数的摩尔分数加权和给出。对于理想气体混合物，摩尔分数等于分压分数。吸收系数正确表示为：\n    $$ \\kappa_j = \\sum_{s} p_s k_{j,s} $$\n    其中 $p_s$ 是物种 $s$ 的分压，$k_{j,s}$ 是第 $j$ 个灰体气体的物种特定 WSGGM 吸收系数。$\\kappa_j$ 的单位是长度的倒数（$\\text{m}^{-1}$），因为 $p_s$ 的单位是 $\\text{bar}$，$k_{j,s}$ 的单位是 $\\text{m}^{-1}\\,\\text{bar}^{-1}$。\n6.  将 $\\kappa_j$ 的混合物法则代入 WSGGM 公式，得到气体混合物总发射率的最终表达式：\n    $$ \\varepsilon_{\\text{mix}} = \\sum_{j=1}^{N} a_j(T) \\left[ 1 - \\exp\\left(-L \\sum_{s} p_s k_{j,s}\\right) \\right] $$\n这是后续计算中使用的表达式。\n\n**第1部分：混合物发射率计算**\n\n混合物由物种 $s \\in \\{\\text{H}_2\\text{O}, \\text{CO}_2\\}$ 组成。我们首先为 $N=3$ 个灰体气体中的每一个计算混合物吸收系数 $\\kappa_j = p_{\\text{H2O}}k_{j,\\text{H2O}} + p_{\\text{CO2}}k_{j,\\text{CO2}}$。\n\n对于 $j=1$：\n$$ \\kappa_1 = (0.25\\,\\text{bar})(0.10\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) + (0.15\\,\\text{bar})(0.050\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 0.025 + 0.0075 = 0.0325\\,\\text{m}^{-1} $$\n对于 $j=2$：\n$$ \\kappa_2 = (0.25\\,\\text{bar})(1.20\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) + (0.15\\,\\text{bar})(0.70\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 0.30 + 0.105 = 0.405\\,\\text{m}^{-1} $$\n对于 $j=3$：\n$$ \\kappa_3 = (0.25\\,\\text{bar})(10.0\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) + (0.15\\,\\text{bar})(6.0\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 2.5 + 0.9 = 3.4\\,\\text{m}^{-1} $$\n\n接下来，我们使用 $L = 1.2\\,\\text{m}$ 计算每个灰体气体的光学深度 $\\kappa_j L$ 和发射率 $\\varepsilon_j = 1 - \\exp(-\\kappa_j L)$。\n\n对于 $j=1$：$\\kappa_1 L = 0.0325 \\times 1.2 = 0.039$。\n$$ \\varepsilon_1 = 1 - \\exp(-0.039) \\approx 0.038259 $$\n对于 $j=2$：$\\kappa_2 L = 0.405 \\times 1.2 = 0.486$。\n$$ \\varepsilon_2 = 1 - \\exp(-0.486) \\approx 0.384910 $$\n对于 $j=3$：$\\kappa_3 L = 3.4 \\times 1.2 = 4.08$。\n$$ \\varepsilon_3 = 1 - \\exp(-4.08) \\approx 0.983088 $$\n\n最后，总混合物发射率 $\\varepsilon_{\\text{mix}}$ 是使用权重 $a_1=0.25$、$a_2=0.35$、$a_3=0.22$ 的加权和。\n$$ \\varepsilon_{\\text{mix}} = a_1 \\varepsilon_1 + a_2 \\varepsilon_2 + a_3 \\varepsilon_3 $$\n$$ \\varepsilon_{\\text{mix}} = (0.25)(0.038259) + (0.35)(0.384910) + (0.22)(0.983088) $$\n$$ \\varepsilon_{\\text{mix}} = 0.009565 + 0.134719 + 0.216279 = 0.360563 $$\n四舍五入到四位有效数字，$\\varepsilon_{\\text{mix}} = 0.3606$。\n\n**第2部分：有效单物种发射率计算**\n\n这部分将混合物视为在总分压 $p_{\\text{tot}} = p_{\\text{H2O}} + p_{\\text{CO2}} = 0.25 + 0.15 = 0.40\\,\\text{bar}$ 下的纯水蒸气。此时吸收系数为 $\\kappa'_j = p_{\\text{tot}} k_{j,\\text{H2O}}$。\n\n对于 $j=1$：$\\kappa'_1 = (0.40\\,\\text{bar})(0.10\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 0.04\\,\\text{m}^{-1}$。\n对于 $j=2$：$\\kappa'_2 = (0.40\\,\\text{bar})(1.20\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 0.48\\,\\text{m}^{-1}$。\n对于 $j=3$：$\\kappa'_3 = (0.40\\,\\text{bar})(10.0\\,\\text{m}^{-1}\\,\\text{bar}^{-1}) = 4.0\\,\\text{m}^{-1}$。\n\n接下来，我们计算光学深度 $\\kappa'_j L$ 和发射率 $\\varepsilon'_j = 1 - \\exp(-\\kappa'_j L)$。\n\n对于 $j=1$：$\\kappa'_1 L = 0.04 \\times 1.2 = 0.048$。\n$$ \\varepsilon'_1 = 1 - \\exp(-0.048) \\approx 0.046857 $$\n对于 $j=2$：$\\kappa'_2 L = 0.48 \\times 1.2 = 0.576$。\n$$ \\varepsilon'_2 = 1 - \\exp(-0.576) \\approx 0.437862 $$\n对于 $j=3$：$\\kappa'_3 L = 4.0 \\times 1.2 = 4.8$。\n$$ \\varepsilon'_3 = 1 - \\exp(-4.8) \\approx 0.991770 $$\n\n有效发射率 $\\varepsilon_{\\text{eff}}$ 是使用相同权重 $a_j$ 的加权和。\n$$ \\varepsilon_{\\text{eff}} = a_1 \\varepsilon'_1 + a_2 \\varepsilon'_2 + a_3 \\varepsilon'_3 $$\n$$ \\varepsilon_{\\text{eff}} = (0.25)(0.046857) + (0.35)(0.437862) + (0.22)(0.991770) $$\n$$ \\varepsilon_{\\text{eff}} = 0.011714 + 0.153252 + 0.218189 = 0.383155 $$\n四舍五入到四位有效数字，$\\varepsilon_{\\text{eff}} = 0.3832$。\n\n**第3部分：相对误差计算**\n\n有效单物种模型的相对误差是相对于第1部分的混合物发射率计算的。\n$$ \\text{相对误差} = \\frac{\\varepsilon_{\\text{eff}} - \\varepsilon_{\\text{mix}}}{\\varepsilon_{\\text{mix}}} $$\n使用未四舍五入的值以获得更高精度：\n$$ \\text{相对误差} = \\frac{0.383155 - 0.360563}{0.360563} = \\frac{0.022592}{0.360563} \\approx 0.062657 $$\n四舍五入到四位有效数字，相对误差为 $0.06266$。\n\n最终报告的结果是 $\\varepsilon_{\\text{mix}}$ 和相对误差，两者都四舍五入到四位有效数字。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3606  0.06266 \\end{pmatrix}}\n$$", "id": "2538186"}, {"introduction": "WSGGM本身是一种近似，其精度与所用“灰体气体”的数量$N$密切相关。在工程实践中，我们必须在模型精度与计算效率之间做出权衡，那么$N$取多少才算“足够”呢？这个计算练习[@problem_id:2538226]将引导您进行一项参数化研究，通过将不同$N$值的截断模型与一个高精度参考模型进行比较，来量化模型误差。这项实践将让您直观地理解模型复杂度的“收益递减”效应，并培养您在实际应用中选择合适模型所需具备的分析能力。", "problem": "考虑一个温度为 $T=1500\\ \\text{K}$ 的非灰参与性介质，该介质仅由水蒸气组成，处于一个物理厚度为 $L$、总压力为 $p$ 的等温、等压、均质平板中，其中乘积 $pL$ 以 $\\text{atm}\\cdot\\text{m}$ 为单位。假设外壳为黑体且等温，并忽略散射。从比尔-朗伯定律和总发射率作为对波数的普朗克加权积分的定义出发，推导一个总气体发射率的计算上易于处理的近似，该近似用一组有限的灰体吸收分组来代替光谱吸收系数。您的推导必须从辐射传递的基本原理开始，并清楚地说明为得到由少数分组权重和吸收系数参数化的指数衰减求和形式所需的任何假设。\n\n使用以下在科学上合理且具有代表性的水蒸气在 $T=1500\\ \\text{K}$ 时的分组参数。每个灰体分组 $i$ 由一个权重 $a_i$ 和一个有效吸收系数 $k_i$（单位为 $\\text{atm}^{-1}\\cdot\\text{m}^{-1}$）来表征：\n- $i=1$: $(a_1,k_1)=(0.40,\\ 0.02)$\n- $i=2$: $(a_2,k_2)=(0.24,\\ 0.08)$\n- $i=3$: $(a_3,k_3)=(0.14,\\ 0.25)$\n- $i=4$: $(a_4,k_4)=(0.08,\\ 0.70)$\n- $i=5$: $(a_5,k_5)=(0.05,\\ 1.80)$\n- $i=6$: $(a_6,k_6)=(0.03,\\ 4.50)$\n- $i=7$: $(a_7,k_7)=(0.02,\\ 10.0)$\n- $i=8$: $(a_8,k_8)=(0.015,\\ 22.0)$\n- $i=9$: $(a_9,k_9)=(0.010,\\ 50.0)$\n- $i=10$: $(a_{10},k_{10})=(0.007,\\ 110.0)$\n- $i=11$: $(a_{11},k_{11})=(0.005,\\ 240.0)$\n- $i=12$: $(a_{12},k_{12})=(0.003,\\ 520.0)$\n\n假设气体为纯水蒸气，因此吸收物质的分压力-程长乘积等于总的 $pL$。设“参考”发射率是由全套 $N_{\\text{ref}}=12$ 个分组预测的值。考虑一个在 $pL\\in[0.1,10]\\ \\text{atm}\\cdot\\text{m}$ 范围内的对数间隔路径条件集，包含端点共 $M=41$ 个点。对于任何具有 $N$ 个灰体分组的截断模型，仅使用前 $N$ 对 $(a_i,k_i)$ 来定义模型发射率。\n\n将 $M$ 点路径集上的均方根绝对发射率误差定义为\n$$\n\\varepsilon_{\\text{RMS}}(N)=\\sqrt{\\frac{1}{M}\\sum_{m=1}^{M}\\left[\\varepsilon_N\\!\\left((pL)_m\\right)-\\varepsilon_{12}\\!\\left((pL)_m\\right)\\right]^2}\\,,\n$$\n其中 $\\varepsilon_{12}$ 表示由 $N_{\\text{ref}}=12$ 分组模型得到的参考发射率，$\\varepsilon_N$ 是从基本原理和您的灰气体近似推导出的 $N$ 分组模型发射率。将发射率视为无量纲，并以纯小数形式报告所有误差（不带百分号）。\n\n您的程序必须：\n- 基于您的推理，推导出一个可实现的 $\\varepsilon_N(pL)$ 表达式。\n- 使用 $N_{\\text{ref}}=12$ 的集合作为参考。\n- 对以下分组数测试套件评估 $\\varepsilon_{\\text{RMS}}(N)$：\n  - $N\\in\\{1,2,3,4,6,8,10,12\\}$。\n- 在连续序列 $N=1,2,\\ldots,12$ 中，确定最小的 $N_{\\star}$，使得误差的增量改善根据以下准则变得微不足道\n$$\n\\varepsilon_{\\text{RMS}}(N-1)-\\varepsilon_{\\text{RMS}}(N)  \\tau,\n$$\n阈值为 $\\tau=0.01$（无量纲）。如果在 $N=12$ 之前不存在这样的 $N$，则设 $N_{\\star}=12$。\n\n物理和数值单位：\n- 按规定使用 $pL$，单位为 $\\text{atm}\\cdot\\text{m}$。\n- 发射率和误差是无量纲的。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 该列表必须按顺序包含 $N\\in\\{1,2,3,4,6,8,10,12\\}$ 的均方根误差，每个误差四舍五入到六位小数，最后是整数 $N_{\\star}$ 作为最后一个元素。\n- 例如，输出应类似于 $[\\varepsilon_{\\text{RMS}}(1),\\varepsilon_{\\text{RMS}}(2),\\ldots,\\varepsilon_{\\text{RMS}}(12\\ \\text{仅当}\\ N=12),N_{\\star}]$，包含八个误差值，然后是 $N_{\\star}$。", "solution": "该问题要求从基本原理出发，推导用于均质气体层总发射率的灰气体加权和（WSGG）模型。然后，将此推导出的模型应用于一组特定的水蒸气参数，以分析模型截断引入的误差，并根据收敛准则确定最佳分组数。\n\n问题陈述在科学上是合理的、适定的，并包含了获得唯一且有意义解所需的所有信息。所提供的WSGG模型参数在物理上是可信的且内部一致，因为权重之和 $\\sum_{i=1}^{12} a_i$ 等于 $1.0$。\n\n推导过程如下。\n\n一个温度为 $T$ 的等温、均质气体层的总发射率 $\\varepsilon$ 定义为该气体的总发射功率与同温度下黑体的总发射功率之比。这表示为光谱发射率 $\\varepsilon_\\eta$ 经普朗克函数加权的光谱积分平均值：\n$$\n\\varepsilon(T, p, L) = \\frac{\\int_0^\\infty E_{b\\eta}(T) \\varepsilon_\\eta(p, L, T) \\, d\\eta}{\\int_0^\\infty E_{b\\eta}(T) \\, d\\eta}\n$$\n其中 $\\eta$ 是波数，$E_{b\\eta}(T)$ 是普朗克光谱发射功率，$p$ 是吸收气体的分压力，$L$ 是穿过介质的程长。\n\n根据基尔霍夫热辐射定律，对于处于局部热力学平衡的介质，光谱发射率等于其光谱吸收率，即 $\\varepsilon_\\eta = \\alpha_\\eta$。光谱吸收率 $\\alpha_\\eta$ 通过 $\\alpha_\\eta = 1 - \\tau_\\eta$ 与光谱透射率 $\\tau_\\eta$ 相关联。\n\n比尔-朗伯定律描述了辐射穿过均质介质时的衰减，给出了光谱透射率：\n$$\n\\tau_\\eta(pL) = \\exp(-\\kappa_\\eta pL)\n$$\n这里，$\\kappa_\\eta$ 是光谱吸收系数，它是温度、压力和波数的函数。问题将乘积 $pL$ 指定为自变量。\n\n将这些关系代入总发射率的定义中，得到：\n$$\n\\varepsilon(T, pL) = \\frac{\\int_0^\\infty E_{b\\eta}(T) [1 - \\exp(-\\kappa_\\eta pL)] \\, d\\eta}{E_b(T)}\n$$\n其中 $E_b(T) = \\int_0^\\infty E_{b\\eta}(T) \\, d\\eta = \\sigma T^4$ 是黑体总发射功率。\n\n像水蒸气这样的分子气体的光谱吸收系数 $\\kappa_\\eta$ 表现出极其复杂且快速变化的结构，使得直接对上述表达式进行数值积分在计算上非常耗时。WSGG模型通过将非灰气体建模为有限个灰气体的混合物，提供了一个易于处理的近似方法。这在概念上等同于将整个光谱域划分为有限数量的波段。在每个波段中，气体被假定为“灰体”，即其吸收系数是恒定的。\n\n总发射率随后被近似为这些假想灰气体的发射率之和，每个贡献都由其对应光谱区域内的黑体能量分数加权。对于一个 $N$ 分组的WSGG模型，总发射率的公式为：\n$$\n\\varepsilon(T, pL) \\approx \\sum_{i=1}^{N} a_i(T) \\left(1 - \\exp(-k_i pL)\\right)\n$$\n在此表达式中，$k_i$ 是第 $i$ 个灰气体分组的常数吸收系数，权重 $a_i(T)$ 代表由该分组有效表示的光谱部分中的黑体发射功率分数。根据定义，所有分组的权重之和必须为1，包括光谱中吸收系数为零的任何透明“窗口”。对于给定的具有 $N_{\\text{ref}}=12$ 个分组的参考模型，权重之和为 $\\sum_{i=1}^{12} a_i = 1$。这意味着没有单独的透明窗口，并且具有最小 $k_i$ 的分组代表了最透明的区域。因此，参考发射率为：\n$$\n\\varepsilon_{12}(pL) = \\sum_{i=1}^{12} a_i \\left[1 - \\exp(-k_i pL)\\right]\n$$\n对于一个具有 $N  12$ 个分组的截断模型，问题陈述要求仅使用前 $N$ 对 $(a_i, k_i)$。这意味着被忽略分组的贡献被省略了。在物理上，这等同于假设与被忽略分组对应的光谱部分（其总能量分数为 $1 - \\sum_{i=1}^{N} a_i$）表现为透明窗口（$k = 0$）。透明窗口的发射率为零。因此，截断的 $N$ 分组模型的发射率表达式为：\n$$\n\\varepsilon_N(pL) = \\sum_{i=1}^{N} a_i \\left[1 - \\exp(-k_i pL)\\right]\n$$\n这就是需要实现的计算上易于处理的表达式。\n\n问题的数值部分要求计算截断模型相对于12分组参考模型的均方根绝对发射率误差 $\\varepsilon_{\\text{RMS}}(N)$，计算范围是一系列指定的 $pL$ 值。公式如下：\n$$\n\\varepsilon_{\\text{RMS}}(N)=\\sqrt{\\frac{1}{M}\\sum_{m=1}^{M}\\left[\\varepsilon_N\\!\\left((pL)_m\\right)-\\varepsilon_{12}\\!\\left((pL)_m\\right)\\right]^2}\n$$\n其中 $M=41$ 是对数间隔路径条件乘积集 $(pL)_m \\in [0.1, 10]\\ \\text{atm}\\cdot\\text{m}$ 中的点数。\n\n最后，要确定最小分组数 $N_{\\star}$，使得精度的增量改善变得微不足道。这是通过找到在 $2 \\le N \\le 12$ 范围内满足以下条件的最小整数 $N$ 来确定的：\n$$\n\\varepsilon_{\\text{RMS}}(N-1)-\\varepsilon_{\\text{RMS}}(N)  \\tau\n$$\n阈值为 $\\tau=0.01$。如果对于任何 $N \\le 12$ 都不满足此条件，则将 $N_{\\star}$ 设置为12。以下程序实现了这个完整的流程。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating truncated weighted-sum-of-gray-gases (WSGG)\n    models for water vapor emissivity.\n    \"\"\"\n    \n    # Scientifically plausible representative group parameters for H2O at T=1500 K.\n    # Each tuple is (a_i, k_i) where a_i is the weight (dimensionless) and\n    # k_i is the absorption coefficient (atm^-1 m^-1).\n    wsgg_params = [\n        (0.40, 0.02), (0.24, 0.08), (0.14, 0.25),\n        (0.08, 0.70), (0.05, 1.80), (0.03, 4.50),\n        (0.02, 10.0), (0.015, 22.0), (0.010, 50.0),\n        (0.007, 110.0), (0.005, 240.0), (0.003, 520.0)\n    ]\n    \n    a = np.array([p[0] for p in wsgg_params])\n    k = np.array([p[1] for p in wsgg_params])\n    \n    # Define path conditions.\n    M = 41\n    # Logarithmically spaced set of pL from 0.1 to 10 atm.m.\n    pL_values = np.logspace(-1, 1, M)\n    \n    def calculate_emissivity(N, pL_arr, a_coeffs, k_coeffs):\n        \"\"\"\n        Calculates the WSGG emissivity for a model with N groups.\n        \n        Args:\n            N (int): The number of gray gas groups to include in the model.\n            pL_arr (np.ndarray): Array of pressure-path length products (atm.m).\n            a_coeffs (np.ndarray): Array of all weighting factors.\n            k_coeffs (np.ndarray): Array of all absorption coefficients.\n            \n        Returns:\n            np.ndarray: Array of total emissivity values corresponding to pL_arr.\n        \"\"\"\n        if N == 0:\n            return np.zeros_like(pL_arr)\n            \n        a_N = a_coeffs[:N]\n        k_N = k_coeffs[:N]\n        \n        # Vectorized calculation:\n        # k_N[:, np.newaxis] has shape (N, 1)\n        # pL_arr has shape (M,)\n        # Broadcasting k_N[:, np.newaxis] * pL_arr gives a matrix of shape (N, M)\n        # containing all k_i * (pL)_m combinations.\n        optical_depth_matrix = k_N[:, np.newaxis] * pL_arr\n        \n        # Calculate the sum of a_i * (1 - exp(-k_i * pL)) over i=1..N\n        # a_N[:, np.newaxis] has shape (N, 1)\n        # 1 - np.exp(-optical_depth_matrix) has shape (N, M)\n        # Broadcasting gives a matrix of shape (N, M)\n        # Summing along axis 0 aggregates the contributions from each group.\n        emissivity_arr = np.sum(a_N[:, np.newaxis] * (1 - np.exp(-optical_depth_matrix)), axis=0)\n        \n        return emissivity_arr\n\n    # Calculate the reference emissivity using the full 12-group model.\n    eps_ref = calculate_emissivity(12, pL_values, a, k)\n    \n    def calculate_rms_error(N, eps_ref_arr):\n        \"\"\"\n        Calculates the Root-Mean-Square absolute emissivity error for an N-group model.\n        \"\"\"\n        eps_N = calculate_emissivity(N, pL_values, a, k)\n        return np.sqrt(np.mean((eps_N - eps_ref_arr)**2))\n\n    # Calculate RMS errors for the specified test suite of N values.\n    test_N_values = [1, 2, 3, 4, 6, 8, 10, 12]\n    rms_errors_to_report = []\n    for N in test_N_values:\n        error = calculate_rms_error(N, eps_ref)\n        rms_errors_to_report.append(error)\n        \n    # Determine N_star by checking the incremental improvement criterion.\n    tau = 0.01\n    N_star = 12  # Default value if criterion is never met.\n    \n    # Calculate RMS errors for the consecutive sequence N=1 to N=12.\n    rms_errors_all = {N: calculate_rms_error(N, eps_ref) for N in range(1, 13)}\n\n    # Iterate from N=2 to 12 to find the smallest N that meets the criterion.\n    for N in range(2, 13):\n        improvement = rms_errors_all[N-1] - rms_errors_all[N]\n        if improvement  tau:\n            N_star = N\n            break\n            \n    return rms_errors_to_report, N_star\n\nif __name__ == '__main__':\n    rms_errors, n_star = solve()\n    formatted_errors = [f\"{err:.6f}\" for err in rms_errors]\n    final_results = formatted_errors + [str(n_star)]\n    print(f\"[{','.join(final_results)}]\")\n\n```", "answer": "$$\n\\boxed{[0.106886,0.063162,0.038162,0.021021,0.007137,0.001730,0.000197,0.000000,5]}\n$$", "id": "2538226"}]}