{"hands_on_practices": [{"introduction": "斯特藩-玻尔兹曼定律的核心在于其对温度的强烈依赖性，即辐射功率与绝对温度的四次方 $T^4$ 成正比。这种高度非线性的关系在实践中具有一个至关重要的推论：温度测量中的微小误差会在计算辐射功率时被显著放大。本练习将通过一阶不确定性分析来量化这种放大效应 [@problem_id:2526915]，这是一项对于处理热辐射测量的工程师和科研人员来说必不可少的技能。", "problem": "一个实验室通过测量一个校准腔的绝对温度来确定其总半球黑体辐射功率。该腔体表现为理想黑体表面，其总半球黑体辐射功率由斯特藩-玻尔兹曼关系式 $E_{b}(T)=\\sigma T^{4}$ 给出，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。测量系统报告的绝对温度相对不确定度为 $\\Delta T/T=0.010$（即 $\\pm 0.010$），这完全归因于温度计。为进行此分析，假设 $\\sigma$ 是精确的，黑体假设有效，并且温度不确定度足够小，可以使用一阶线性化。\n\n从一阶泰勒线性化的定义出发，即对于函数 $f(x)$ 和一个小的增量 $\\Delta x$，$f(x+\\Delta x)\\approx f(x)+f'(x)\\,\\Delta x$，推导由温度不确定度引起的一阶传播相对不确定度 $E_{b}$。然后，根据给定的温度不确定度计算其值。\n\n将最终 $E_{b}$ 的传播相对不确定度表示为小数，并四舍五入到三位有效数字。此外，简要解释这一结果对于设计通过温度测量来推断辐射热通量的辐射测量方法意味着什么。该解释不属于数值答案的一部分。", "solution": "该问题要求推导和评估由已知的测量绝对温度 $T$ 的相对不确定度所导致的黑体辐射功率 $E_b$ 的传播相对不确定度。这些量之间的关系由斯特藩-玻尔兹曼定律给出，$E_b(T) = \\sigma T^4$。\n\n分析从一阶不确定度传播原理开始。对于一个通用函数 $y = f(x)$，只要 $\\Delta x$ 足够小，就可以使用一阶泰勒级数展开，从 $x$ 的不确定度（记为 $\\Delta x$）来近似计算 $y$ 的不确定度（记为 $\\Delta y$）。该近似值由下式给出：\n$$ \\Delta y \\approx \\left| \\frac{df}{dx} \\right| \\Delta x $$\n为了求相对不确定度 $\\frac{\\Delta y}{y}$，我们除以函数值 $y = f(x)$：\n$$ \\frac{\\Delta y}{y} \\approx \\frac{1}{|f(x)|} \\left| \\frac{df}{dx} \\right| \\Delta x = \\left| \\frac{f'(x)}{f(x)} \\right| \\Delta x $$\n这可以表示为 $x$ 的相对不确定度 $\\frac{\\Delta x}{x}$ 的形式：\n$$ \\frac{\\Delta y}{y} \\approx \\left| \\frac{x f'(x)}{f(x)} \\right| \\frac{\\Delta x}{x} $$\n\n我们将这个通用形式应用于手头上的特定函数，即黑体辐射功率的斯特藩-玻尔兹曼定律：\n$$ E_b(T) = \\sigma T^4 $$\n在这里，辐射功率 $E_b$ 类似于 $y$，绝对温度 $T$ 类似于 $x$。函数为 $f(T) = \\sigma T^4$。斯特藩-玻尔兹曼常数 $\\sigma$ 被认为是精确常数，意味着其不确定度为零（$\\Delta \\sigma = 0$）。因此，不确定度仅从温度测量中传播。\n\n首先，我们必须计算 $E_b$ 对 $T$ 的导数：\n$$ \\frac{dE_b}{dT} = \\frac{d}{dT}(\\sigma T^4) $$\n由于 $\\sigma$ 是一个常数，我们有：\n$$ \\frac{dE_b}{dT} = 4 \\sigma T^3 $$\n\n现在，我们可以使用一阶近似来表示辐射功率的绝对不确定度 $\\Delta E_b$：\n$$ \\Delta E_b \\approx \\left| \\frac{dE_b}{dT} \\right| \\Delta T = (4 \\sigma T^3) \\Delta T $$\n为了通用性，我们使用绝对值，但由于功率和温度都是非负的，绝对值符号可以去掉。\n\n问题要求计算 $E_b$ 的*相对*不确定度，即 $\\frac{\\Delta E_b}{E_b}$。为了求得此值，我们将 $\\Delta E_b$ 的表达式除以原始函数 $E_b(T) = \\sigma T^4$：\n$$ \\frac{\\Delta E_b}{E_b} \\approx \\frac{4 \\sigma T^3 \\Delta T}{\\sigma T^4} $$\n\n通过约去公因子（$\\sigma$ 和 $T^3$）来简化此表达式，得到相对不确定度之间的符号关系：\n$$ \\frac{\\Delta E_b}{E_b} \\approx 4 \\frac{\\Delta T}{T} $$\n这就是推导出来的一阶传播相对不确定度。它表明辐射功率的相对不确定度恰好是绝对温度相对不确定度的四倍。这个因子 $4$ 直接来源于斯特藩-玻尔兹曼定律中的指数。\n\n问题给出了温度相对不确定度的数值：\n$$ \\frac{\\Delta T}{T} = 0.010 $$\n\n我们将这个值代入我们推导的表达式中，以求得辐射功率相对不确定度的数值：\n$$ \\frac{\\Delta E_b}{E_b} \\approx 4 \\times 0.010 = 0.040 $$\n问题要求答案四舍五入到三位有效数字。计算值为 $0.040$。为了用三位有效数字表示，我们写作 $0.0400$。\n\n这个结果的解释是直接的，并且在辐射测量学和高温测量学领域具有根本的重要性。$\\frac{\\Delta E_b}{E_b} \\approx 4 \\frac{\\Delta T}{T}$ 这个事实表明了测量不确定度的显著放大。温度测量中一个微小的 $1\\%$ 不确定度会导致推断的辐射功率有 $4\\%$ 的不确定度。这种高灵敏度意味着，对于依赖斯特藩-玻尔兹曼定律从温度确定辐射热通量的应用（例如，非接触式温度传感或熔炉分析），极高精度的温度测量是一项关键的设计要求。温度计的任何误差在最终计算的辐射量中都会被放大 4 倍，这使得温度成为此类系统中不确定度的主要来源。", "answer": "$$\\boxed{0.0400}$$", "id": "2526915"}, {"introduction": "斯特藩-玻尔兹曼定律给出了黑体辐射的总功率，但这些能量实际上是根据普朗克定律分布在一个波长谱上。本练习要求我们建立一个数值计算方法，以确定在特定波段（例如可见光或红外波段）内辐射的能量占总能量的比例 [@problem_id:2526932]。通过这个实践，我们将把斯特藩-玻尔兹曼积分定律与其光谱起源联系起来，并揭示物体的颜色、热探测器的效率等特性如何随温度变化。", "problem": "绝对温度为 $T$ 的黑体在所有波长上辐射能量。单位波长的半球光谱发射功率 $E_{b,\\lambda}(T)$ 由普朗克定律给出，而总半球发射功率则由斯特藩-玻尔兹曼定律描述。仅使用这两个基本定律，从第一性原理出发，推导出一个表达式，用于表示在有限波长带 $\\left[\\lambda_1,\\lambda_2\\right]$ 内发射的总黑体功率分数，该表达式应为一个无量纲的积分之比。然后，实现一个数值算法来评估特定测试用例的该分数，并解释其温度依赖性。\n\n基本原理：\n- 普朗克定律（单位波长的半球光谱发射功率）：$E_{b,\\lambda}(T)$ 作为 $\\lambda$ 和 $T$ 的函数。\n- 斯特藩-玻尔兹曼定律（总发射功率）：$E_b(T)$。\n- 使用的物理常数（国际单位制）：普朗克常数 $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$，真空中的光速 $c = 2.99792458\\times 10^{8}\\ \\mathrm{m/s}$，玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$，斯特藩-玻尔兹曼常数 $\\sigma = 5.670374419\\times 10^{-8}\\ \\mathrm{W/(m^2\\cdot K^4)}$。\n\n要求：\n1. 从普朗克定律的 $E_{b,\\lambda}(T)$ 和斯特藩-玻尔兹曼定律的 $E_b(T)$ 出发，推导一个无量纲表达式，证明在 $\\left[\\lambda_1,\\lambda_2\\right]$ 波段内的黑体功率分数仅取决于乘积 $\\lambda_1 T$ 和 $\\lambda_2 T$。不要假设任何预先制表的黑体辐射函数表；需从第一性原理出发明确展示必要的变量替换过程。\n2. 实现一个程序，对下面的每个测试用例，使用数值稳定的求积方法计算分数\n$$F_{(\\lambda_1,\\lambda_2)}(T) = \\frac{1}{\\sigma T^4}\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda$$\n。使用单位为米的 $\\lambda$ 和单位为开尔文的 $T$。如果提供的 $\\lambda$ 值以微米为单位，请使用 $1\\ \\mu\\mathrm{m} = 10^{-6}\\ \\mathrm{m}$ 将其转换为米。将 $+\\infty$ 的上界视为无界积分极限。您的算法必须对 $\\lambda=0$ 和 $\\lambda=+\\infty$ 的极限具有鲁棒性。\n3. 科学真实性：仅采用普朗克半球光谱发射功率定律和斯特藩-玻尔兹曼定律作为物理假设。所有量均保持国际单位制。计算出的分数 $F_{(\\lambda_1,\\lambda_2)}(T)$ 必须是无量纲的。\n4. 输出规范：对于每个测试用例，将 $F_{(\\lambda_1,\\lambda_2)}(T)$ 的数值输出为四舍五入到 $8$ 位小数的浮点数。将所有结果汇总到单行中，格式为逗号分隔的 Python 风格列表，严格不含空格，例如 `[0.12345678,0.87654321,...]`。\n\n测试套件：\n- 使用以下参数集，其中波长以微米为单位，温度以开尔文为单位。在内部将微米转换为米。符号 $+\\infty$ 表示无界波长上限。\n    1. $\\lambda_1 = 0\\ \\mu\\mathrm{m}$，$\\lambda_2 = +\\infty$，$T = 300\\ \\mathrm{K}$。\n    2. $\\lambda_1 = 0.38\\ \\mu\\mathrm{m}$，$\\lambda_2 = 0.78\\ \\mu\\mathrm{m}$，$T = 5800\\ \\mathrm{K}$。\n    3. $\\lambda_1 = 0.38\\ \\mu\\mathrm{m}$，$\\lambda_2 = 0.78\\ \\mu\\mathrm{m}$，$T = 3000\\ \\mathrm{K}$。\n    4. $\\lambda_1 = 8\\ \\mu\\mathrm{m}$，$\\lambda_2 = 14\\ \\mu\\mathrm{m}$，$T = 300\\ \\mathrm{K}$。\n    5. $\\lambda_1 = 0.1\\ \\mu\\mathrm{m}$，$\\lambda_2 = 0.4\\ \\mu\\mathrm{m}$，$T = 5800\\ \\mathrm{K}$。\n    6. $\\lambda_1 = 2.0\\ \\mu\\mathrm{m}$，$\\lambda_2 = 4.0\\ \\mu\\mathrm{m}$，$T = 1000\\ \\mathrm{K}$。\n    7. $\\lambda_1 = 1.0\\ \\mu\\mathrm{m}$，$\\lambda_2 = 2.0\\ \\mu\\mathrm{m}$，$T = 2000\\ \\mathrm{K}$。\n\n解释提示：\n- 根据推导出的无量纲表达式，解释为什么测试用例 6 和 7 的分数应（在数值精度范围内）相等。定性解释 $F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(T)$ 在 $T=3000\\ \\mathrm{K}$ 和 $T=5800\\ \\mathrm{K}$ 之间如何变化，并结合维恩位移峰值相对于可见光波段的位置进行说明。\n\n您的程序应生成单行输出，其中包含按上述顺序列出的测试用例的结果，格式为逗号分隔的列表，用方括号括起，不含空格，每个浮点数四舍五入到 8 位小数，例如 $[r_1,r_2,r_3,r_4,r_5,r_6,r_7]$，其中 $r_i$ 是按规定计算的分数。", "solution": "所提出的问题是热辐射和传热领域一个标准的、适定的练习题。它具有科学依据，要求从第一性原理进行推导，并为获得唯一解提供了充分的信息。该问题是有效的。\n\n目标是推导在指定波长带 $[\\lambda_1, \\lambda_2]$ 内的总黑体发射功率分数的表达式，然后为几个测试用例计算该分数。\n\n让我们从第一性原理开始。\n\n绝对温度为 $T$ 的黑体的半球光谱发射功率由普朗克定律给出：\n$$E_{b,\\lambda}(\\lambda, T) = \\frac{C_1}{\\lambda^5 \\left( \\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1 \\right)}$$\n其中 $\\lambda$ 是波长。常数 $C_1$ 和 $C_2$ 分别是第一和第二辐射常数。它们由基本物理常数定义：\n$C_1 = 2\\pi h c^2$\n$C_2 = \\frac{h c}{k_B}$\n这里，$h$ 是普朗克常数，$c$ 是真空中的光速，$k_B$ 是玻尔兹曼常数。\n\n总半球发射功率 $E_b(T)$ 是光谱发射功率在所有波长上（从 $\\lambda=0$到$\\lambda=\\infty$）的积分：\n$$E_b(T) = \\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda$$\n此积分可得到斯特藩-玻尔兹曼定律，$E_b(T) = \\sigma T^4$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n在波长带 $[\\lambda_1, \\lambda_2]$ 内的总发射功率分数，记为 $F_{(\\lambda_1, \\lambda_2)}(T)$，是该波段内发射的功率与总发射功率之比：\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda}{\\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda}{\\sigma T^4}$$\n问题要求将其表示为一种仅依赖于乘积 $\\lambda_1 T$ 和 $\\lambda_2 T$ 的形式。为实现此目的，我们在积分中进行变量替换。让我们定义一个无量纲变量 $x$ 如下：\n$$x = \\frac{C_2}{\\lambda T} = \\frac{hc}{\\lambda k_B T}$$\n通过这个替换，我们可以用 $x$ 来表示 $\\lambda$ 及其微分 $d\\lambda$：\n$$\\lambda = \\frac{C_2}{x T} \\implies d\\lambda = -\\frac{C_2}{x^2 T} \\, dx$$\n现在，将这些代入 $E_{b,\\lambda}(\\lambda, T)$ 的表达式中：\n$$E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\frac{C_1}{\\left(\\frac{C_2}{xT}\\right)^5 (\\exp(x) - 1)} \\left(-\\frac{C_2}{x^2 T} \\, dx\\right)$$\n简化此表达式：\n$$E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = -C_1 \\frac{(xT)^5}{C_2^5 (\\exp(x) - 1)} \\frac{C_2}{x^2 T} \\, dx = -\\frac{C_1 T^4}{C_2^4} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\n在波段 $[\\lambda_1, \\lambda_2]$ 内发射的功率是积分：\n$$\\int_{\\lambda_1}^{\\lambda_2} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\int_{x_1}^{x_2} \\left(-\\frac{C_1 T^4}{C_2^4} \\frac{x^3}{\\exp(x) - 1} \\, dx\\right) = \\frac{C_1 T^4}{C_2^4} \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\n其中用 $x$ 表示的积分限为 $x_1 = \\frac{C_2}{\\lambda_1 T}$ 和 $x_2 = \\frac{C_2}{\\lambda_2 T}$。注意，积分限的反转抵消了负号。\n\n总发射功率是所有波长的积分，对应于 $x$ 从 $\\infty$（对于 $\\lambda=0$）到 $0$（对于 $\\lambda=\\infty$）：\n$$\\sigma T^4 = \\int_{0}^{\\infty} E_{b,\\lambda}(\\lambda, T) \\, d\\lambda = \\frac{C_1 T^4}{C_2^4} \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\n定积分 $\\int_{0}^{\\infty} \\frac{x^3}{e^x - 1} \\, dx$ 是一种与玻色-爱因斯坦积分和黎曼zeta函数相关的标准形式，其值已知为 $\\frac{\\pi^4}{15}$。\n因此，我们可以将斯特藩-玻尔兹曼常数表示为：\n$$\\sigma = \\frac{C_1}{C_2^4} \\frac{\\pi^4}{15} = \\frac{2\\pi h c^2}{\\left(\\frac{hc}{k_B}\\right)^4} \\frac{\\pi^4}{15} = \\frac{2\\pi^5 k_B^4}{15 h^3 c^2}$$\n这证实了基本常数之间的关系。\n\n现在，我们可以将分数 $F_{(\\lambda_1, \\lambda_2)}(T)$ 写成无量纲积分的比值：\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{\\frac{C_1 T^4}{C_2^4} \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x) - 1} \\, dx}{\\frac{C_1 T^4}{C_2^4} \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx} = \\frac{\\int_{C_2/(\\lambda_2 T)}^{C_2/(\\lambda_1 T)} \\frac{x^3}{\\exp(x) - 1} \\, dx}{\\int_{0}^{\\infty} \\frac{x^3}{\\exp(x) - 1} \\, dx}$$\n代入分母积分的值：\n$$F_{(\\lambda_1, \\lambda_2)}(T) = \\frac{15}{\\pi^4} \\int_{C_2/(\\lambda_2 T)}^{C_2/(\\lambda_1 T)} \\frac{x^3}{\\exp(x) - 1} \\, dx$$\n该表达式明确地表明，分数 $F_{(\\lambda_1, \\lambda_2)}(T)$ 仅是乘积 $\\lambda_1 T$ 和 $\\lambda_2 T$ 的函数，正如所要求的那样。由于无量纲被积函数的良态性质，此框架非常适合数值计算。\n\n现在，针对解释提示部分：\n1.  **测试用例 6 和 7 的分数相等性**：\n    对于用例 6：$\\lambda_1 = 2.0 \\times 10^{-6}\\ \\mathrm{m}$，$\\lambda_2 = 4.0 \\times 10^{-6}\\ \\mathrm{m}$，$T = 1000\\ \\mathrm{K}$。\n    乘积为 $\\lambda_1 T = 2000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$ 和 $\\lambda_2 T = 4000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$。\n    对于用例 7：$\\lambda_1 = 1.0 \\times 10^{-6}\\ \\mathrm{m}$，$\\lambda_2 = 2.0 \\times 10^{-6}\\ \\mathrm{m}$，$T = 2000\\ \\mathrm{K}$。\n    乘积为 $\\lambda_1 T = 2000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$ 和 $\\lambda_2 T = 4000 \\times 10^{-6}\\ \\mathrm{m \\cdot K}$。\n    如推导所示，分数 $F_{(\\lambda_1, \\lambda_2)}(T)$ 仅取决于乘积 $\\lambda_1 T$ 和 $\\lambda_2 T$，这些乘积决定了无量纲变量 $x$ 的积分限。由于这两个用例的乘积相同，因此分数的值也必须相同，直至数值计算的精度。\n\n2.  **可见光波段 ($0.38 - 0.78\\ \\mu\\mathrm{m}$) 的分数随温度的变化**：\n    该分析涉及维恩位移定律，它是普朗克定律的直接推论。该定律指出，最大光谱发射波长 $\\lambda_{\\max}$ 与温度成反比：$\\lambda_{\\max} T = b$，其中 $b \\approx 2898\\ \\mu\\mathrm{m} \\cdot \\mathrm{K}$。\n    对于 $T = 3000\\ \\mathrm{K}$（用例 3），峰值发射发生在 $\\lambda_{\\max} \\approx \\frac{2898}{3000} \\approx 0.97\\ \\mu\\mathrm{m}$。该波长位于近红外区，刚好超出可见光谱带的红光端 ($0.78\\ \\mu\\mathrm{m}$)。因此，在 $3000\\ \\mathrm{K}$ 时，大部分辐射能量位于比可见光更长的波长处，只有一小部分落在可见光谱内。\n    对于 $T = 5800\\ \\mathrm{K}$（用例 2），这大约是太阳表面温度，峰值发射位于 $\\lambda_{\\max} \\approx \\frac{2898}{5800} \\approx 0.50\\ \\mu\\mathrm{m}$。该波长位于光谱的绿-黄部分，恰好在可见光波段 ($0.38-0.78\\ \\mu\\mathrm{m}$) 的中间。\n    随着温度从 $3000\\ \\mathrm{K}$ 升高到 $5800\\ \\mathrm{K}$，普朗克分布的峰值从红外区移动到可见光区。因此，总辐射能量中有更大比例是在可见波长内发射的。所以，$F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(5800\\ \\mathrm{K})$ 将显著大于 $F_{(0.38\\ \\mu\\mathrm{m},0.78\\ \\mu\\mathrm{m})}(3000\\ \\mathrm{K})$。物体看起来会更亮，颜色从微红色变为黄白色。\n\n数值实现将使用推导出的无量纲积分公式，以获得卓越的稳定性和准确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the fraction of blackbody radiation in a wavelength band for given test cases.\n    \"\"\"\n    # Define physical constants from the problem statement.\n    H = 6.62607015e-34  # Planck constant (J.s)\n    C = 2.99792458e8    # Speed of light in vacuum (m/s)\n    KB = 1.380649e-23     # Boltzmann constant (J/K)\n    # The Stefan-Boltzmann constant SIGMA is not needed due to the dimensionless integral formulation.\n\n    # Calculate the second radiation constant.\n    C2 = H * C / KB  # (m.K)\n\n    # Test suite: (lambda1_um, lambda2_um, T_K)\n    # Wavelengths are in micrometers and will be converted to meters.\n    test_cases = [\n        (0, np.inf, 300),        # Case 1: Full spectrum, should be 1.0\n        (0.38, 0.78, 5800),     # Case 2: Visible light at sun's temperature\n        (0.38, 0.78, 3000),     # Case 3: Visible light at lower temperature\n        (8, 14, 300),           # Case 4: Thermal infrared at room temperature\n        (0.1, 0.4, 5800),       # Case 5: Ultraviolet at sun's temperature\n        (2.0, 4.0, 1000),       # Case 6: Test for lambda*T scaling\n        (1.0, 2.0, 2000),       # Case 7: Test for lambda*T scaling\n    ]\n\n    results = []\n\n    # The dimensionless integrand from the derivation.\n    def integrand(x):\n        \"\"\"\n        Dimensionless integrand x^3 / (exp(x) - 1).\n        This form is numerically stable.\n        \"\"\"\n        # For very large x, exp(x) overflows, but the integrand approaches 0.\n        # np.exp(709.78) is the approximate float limit.\n        if x > 700:\n            return 0.0\n        # For very small x, the denominator approaches 0, but can be approximated.\n        # However, `quad` handles this endpoint singularity correctly.\n        if x == 0:\n            return 0.0 # Mathematically the limit is 0 as x^3 dominates.\n        return x**3 / (np.exp(x) - 1)\n\n    # The value of the total integral from 0 to infinity is known analytically.\n    # integral_0^inf [x^3 / (exp(x) - 1)] dx = pi^4 / 15\n    total_integral_val = np.pi**4 / 15\n\n    for l1_um, l2_um, T in test_cases:\n        # Convert wavelengths from micrometers to meters.\n        l1_m = l1_um * 1e-6\n        l2_m = l2_um * 1e-6\n\n        # Calculate the integration limits for the dimensionless variable x.\n        # x = C2 / (lambda * T)\n        # Handle boundary cases for lambda = 0 and lambda = +inf.\n        if l1_m == 0:\n            x1 = np.inf\n        else:\n            x1 = C2 / (l1_m * T)\n\n        if np.isinf(l2_m):\n            x2 = 0\n        else:\n            x2 = C2 / (l2_m * T)\n\n        # The integral is from x2 to x1, as d(lambda) introduces a negative sign.\n        # quad(func, a, b) integrates from a to b.\n        integral_val, _ = quad(integrand, x2, x1)\n\n        # The fraction is the ratio of the band integral to the total integral.\n        fraction = integral_val / total_integral_val\n        results.append(f\"{fraction:.8f}\")\n\n    # Final print statement must be a single-line, comma-separated list\n    # enclosed in square brackets with no spaces.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2526932"}, {"introduction": "在掌握了单个表面的辐射特性后，我们将转向更真实的工程系统，这些系统通常涉及多个表面之间的辐射交换，例如炉膛、燃烧室或航天器内部。本高级练习将指导您使用辐射度-辐照度法，为三表面封闭系统建立并求解方程组 [@problem_id:2526903]。这是一个综合性练习，它将视角系数、表面属性和斯特藩-玻尔兹曼定律融合成一个强大的分析框架，用于解决复杂的系统问题。", "problem": "给定一个闭合的、三表面的、等温的、漫灰体罩壳。对于每个表面 $i \\in \\{1,2,3\\}$，其有效辐射 $J_i$ 和辐照度 $G_i$ 在不透明条件下满足能量守恒和漫灰体特性。使用斯特藩-玻尔兹曼辐射定律，推导出一个线性系统，用于在给定表面绝对温度 $T_i$ 和表面发射率 $\\varepsilon_i$ 的情况下确定 $J_i$。然后，利用罩壳的角系数 $F_{ij}$ 和表面积 $A_i$ 计算离开每个表面的净辐射换热率 $q_i$。\n\n您的推导必须从以下基本基础和核心定义开始：\n- 斯特藩-玻尔兹曼定律：表面 $i$ 的黑体辐射力为 $E_{b,i} = \\sigma T_i^4$，其中 $\\sigma$ 是斯特藩-玻尔兹曼常数。\n- 对于不透明的漫灰体表面，根据 Kirchhoff 定律，发射率等于吸收率，且半球反射率为 $\\rho_i = 1 - \\varepsilon_i$。\n- 有效辐射 $J_i$（单位面积上通过辐射离开表面 $i$ 的总能量，包括发射和反射部分）和辐照度 $G_i$（辐射到表面 $i$ 上的总能量）的定义。\n- 罩壳的角系数性质：对于每个 $i$，$F_{ij} \\ge 0$，$\\sum_{j=1}^{3} F_{ij} = 1$，以及互易关系 $A_i F_{ij} = A_j F_{ji}$。\n\n任务：\n1. 通过将有效辐射的守恒定义与漫灰体特性以及用角系数和有效辐射表示的罩壳辐照度相结合，推导有效辐射 $J_1, J_2, J_3$ 的线性系统。该系统必须明确表述为 $\\sum_{j=1}^{3} M_{ij} J_j = b_i$ 的形式，其中 $M_{ij}$ 和 $b_i$ 用 $\\varepsilon_i$、$F_{ij}$ 和 $T_i$ 定义。\n2. 以逻辑合理的顺序描述，在已知 $J_i$ 后如何计算 $q_i$。您的步骤必须从第一性原理开始，并以一个可实现的算法结束。\n\n罩壳几何的数值数据：\n- 表面积：$A_1 = 2\\,\\mathrm{m}^2$, $A_2 = 3\\,\\mathrm{m}^2$, $A_3 = 5\\,\\mathrm{m}^2$。\n- 角系数矩阵 $F = [F_{ij}]$，其行和为 $1$ 并满足互易关系：\n  - 行 1：$F_{11} = 0.1$, $F_{12} = 0.3$, $F_{13} = 0.6$。\n  - 行 2：$F_{21} = 0.2$, $F_{22} = 0.3$, $F_{23} = 0.5$。\n  - 行 3：$F_{31} = 0.24$, $F_{32} = 0.3$, $F_{33} = 0.46$。\n\n物理常数和单位：\n- 使用 $\\sigma = 5.670374419 \\times 10^{-8}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$。\n- 温度必须以开尔文（$\\mathrm{K}$）为单位。\n- 换热率必须以瓦特（$\\mathrm{W}$）报告。\n\n您将编写的程序必须实现您推导的线性系统和计算步骤，并为以下测试套件生成数值答案。对于每种情况，计算离开表面的净辐射换热率向量 $\\left[q_1, q_2, q_3\\right]$，单位为 $\\mathrm{W}$。\n\n测试套件：\n- 情况 1（一般混合发射率和温度）：\n  - $\\varepsilon = [0.7, 0.9, 0.5]$, $T = [1000, 800, 600]\\,\\mathrm{K}$。\n- 情况 2（边界情况：等温黑体罩壳）：\n  - $\\varepsilon = [1.0, 1.0, 1.0]$, $T = [800, 800, 800]\\,\\mathrm{K}$。\n- 情况 3（边缘情况：两个近似镜面的低发射率表面，一个高发射率表面）：\n  - $\\varepsilon = [0.05, 0.05, 0.9]$, $T = [1200, 500, 500]\\,\\mathrm{K}$。\n\n输出规格：\n- 以 $\\mathrm{W}$ 为单位表示每个 $q_i$，四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个列表的列表形式的结果，每个内部列表是对应一个情况的三个换热率，顺序与测试套件相同。格式必须完全如下：\n  - $[[q_{1,1},q_{1,2},q_{1,3}],[q_{2,1},q_{2,2},q_{2,3}],[q_{3,1},q_{3,2},q_{3,3}]]$\n  其中 $q_{k,i}$ 表示情况 $k$ 中表面 $i$ 的换热率。\n\n注：\n- 假设所有表面都是不透明和等温的，罩壳内部只有表面间的辐射，没有参与介质。\n- 通过验证每种情况下 $\\sum_{i=1}^{3} q_i$ 近似为 $0$（闭合罩壳内的能量守恒）来确保数值一致性，并承认存在微小的数值舍入误差。\n\n所有值均以瓦特（$\\mathrm{W}$）为单位作答，四舍五入到六位小数，并严格遵守要求的输出格式。", "solution": "问题陈述经验证在科学上是合理的、自洽的、一致的且适定的。所提供的表面积和角系数数据正确满足了闭合罩壳的几何约束，特别是求和法则和互易法则。该问题是辐射传热原理的一个标准的、非平凡的应用。解决方案从第一性原理推导如下。\n\n本分析针对一个闭合的三表面罩壳，其中所有表面均为不透明、等温的漫灰体发射体和反射体。\n\n**任务 1：有效辐射线性系统的推导**\n\n推导过程通过为每个表面 $i \\in \\{1, 2, 3\\}$ 的有效辐射 $J_i$ 建立一个方程组来进行。\n\n1.  **有效辐射的定义**：有效辐射（$J_i$，单位 $\\mathrm{W}\\,\\mathrm{m}^{-2}$）是单位面积离开表面 $i$ 的总辐射能量。它是发射和反射能量的总和：\n    $$J_i = E_i + \\rho_i G_i$$\n    其中 $E_i$ 是表面 $i$ 的辐射力，$\\rho_i$ 是其反射率，$G_i$ 是表面 $i$ 上的辐照度（单位面积上的入射能量）。对于灰体表面，其辐射力为 $E_i = \\varepsilon_i E_{b,i}$，其中 $\\varepsilon_i$ 是发射率，$E_{b,i}$ 是由斯特藩-玻尔兹曼定律给出的黑体辐射力：\n    $$E_{b,i} = \\sigma T_i^4$$\n    这里，$\\sigma$ 是斯特藩-玻尔兹曼常数（$5.670374419 \\times 10^{-8}\\,\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{K}^{-4}$），$T_i$ 是表面 $i$ 的绝对温度。\n\n2.  **表面特性**：对于不透明的漫灰体表面，Kirchhoff 热辐射定律指出吸收率 $\\alpha_i$ 等于发射率 $\\varepsilon_i$。由于表面不透明，其反射率、吸收率和透射率之和为1，其中透射率为零。这得出 $\\rho_i + \\alpha_i = 1$，意味着：\n    $$\\rho_i = 1 - \\varepsilon_i$$\n    将这些关系代入有效辐射的定义中得到：\n    $$J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) G_i$$\n\n3.  **辐照度的定义**：表面 $i$ 上的辐照度 $G_i$ 是从罩壳中所有表面（包括其自身）到达的辐射能量的总和。对于一个有 $N=3$ 个表面的漫射罩壳，离开表面 $j$ 的能量是 $A_j J_j$。这部分能量中到达表面 $i$ 的分数是角系数 $F_{ji}$。因此，入射到表面 $i$ 上的总能量是 $\\sum_{j=1}^{3} (A_j J_j) F_{ji}$。单位面积的辐照度因此为：\n    $$G_i = \\frac{1}{A_i} \\sum_{j=1}^{3} A_j F_{ji} J_j$$\n    利用角系数的互易关系 $A_j F_{ji} = A_i F_{ij}$，可以简化为罩壳分析的一个关键结果：\n    $$G_i = \\frac{1}{A_i} \\sum_{j=1}^{3} A_i F_{ij} J_j = \\sum_{j=1}^{3} F_{ij} J_j$$\n\n4.  **线性系统的构建**：为了为有效辐射 $J_j$ 创建一个方程组，我们将 $G_i$ 的表达式代入有效辐射方程：\n    $$J_i = \\varepsilon_i E_{b,i} + (1 - \\varepsilon_i) \\sum_{j=1}^{3} F_{ij} J_j$$\n    该方程必须对每个表面 $i = 1, 2, 3$ 都成立。为了构建一个形如 $\\sum_{j=1}^{3} M_{ij} J_j = b_i$ 的标准线性系统，我们重新整理方程，将所有包含未知有效辐射 $J_j$ 的项归到一边：\n    $$J_i - (1 - \\varepsilon_i) \\sum_{j=1}^{3} F_{ij} J_j = \\varepsilon_i E_{b,i}$$\n    通过注意到 $J_i = \\sum_{j=1}^{3} \\delta_{ij} J_j$，这可以更正式地使用克罗内克 δ 函数 $\\delta_{ij}$（当 $i=j$ 时 $\\delta_{ij} = 1$，否则为 $0$）来书写：\n    $$\\sum_{j=1}^{3} \\delta_{ij} J_j - \\sum_{j=1}^{3} (1 - \\varepsilon_i) F_{ij} J_j = \\varepsilon_i E_{b,i}$$\n    合并求和项，得到线性系统的最终形式：\n    $$\\sum_{j=1}^{3} \\left[ \\delta_{ij} - (1 - \\varepsilon_i) F_{ij} \\right] J_j = \\varepsilon_i E_{b,i}$$\n    该系统形式为 $\\mathbf{M}\\mathbf{J} = \\mathbf{b}$，其中 $\\mathbf{J}$ 是未知有效辐射的向量 $[J_1, J_2, J_3]^T$。矩阵 $\\mathbf{M}$ 和向量 $\\mathbf{b}$ 的系数为：\n    $$M_{ij} = \\delta_{ij} - (1 - \\varepsilon_i) F_{ij}$$\n    $$b_i = \\varepsilon_i E_{b,i} = \\varepsilon_i \\sigma T_i^4$$\n    求解这个 $3 \\times 3$ 线性系统即可得到所需的有效辐射。\n\n**任务 2：净辐射换热率的计算**\n\n一旦有效辐射已知，就可以计算离开每个表面的净辐射换热率 $q_i$（单位 $\\mathrm{W}$）。\n\n1.  **净换热率的定义**：离开表面 $i$ 的净换热率 $q_i$ 是离开该表面的总能量（$A_i J_i$）与入射到该表面的总能量（$A_i G_i$）之间的差值：\n    $$q_i = A_i (J_i - G_i)$$\n\n2.  **计算公式的推导**：我们将辐照度表达式 $G_i = \\sum_{j=1}^{3} F_{ij} J_j$ 代入 $q_i$ 的定义中：\n    $$q_i = A_i \\left( J_i - \\sum_{j=1}^{3} F_{ij} J_j \\right)$$\n    对于闭合罩壳，角系数的求和法则规定 $\\sum_{j=1}^{3} F_{ij} = 1$。这允许我们将 $J_i$ 表示为 $J_i \\times 1 = J_i \\sum_{j=1}^{3} F_{ij} = \\sum_{j=1}^{3} F_{ij} J_i$。将此代入 $q_i$ 的方程中：\n    $$q_i = A_i \\left( \\sum_{j=1}^{3} F_{ij} J_i - \\sum_{j=1}^{3} F_{ij} J_j \\right)$$\n    合并求和项，得到用于计算的最终表达式：\n    $$q_i = A_i \\sum_{j=1}^{3} F_{ij} (J_i - J_j)$$\n    这个公式是鲁棒的，并且对所有发射率值都有效，包括黑体（$\\varepsilon_i = 1$）的极限情况。另一种形式 $q_i = \\frac{A_i \\varepsilon_i}{1-\\varepsilon_i} (E_{b,i} - J_i)$ 在黑体情况下会变成不定式，因此不用于通用实现。\n\n**计算算法**\n\n解决给定测试用例问题的总体步骤如下：\n1.  对每个表面 $i$，计算其黑体辐射力 $E_{b,i} = \\sigma T_i^4$。\n2.  使用推导出的系数 $M_{ij}$ 和 $b_i$ 构建 $3 \\times 3$ 矩阵 $\\mathbf{M}$ 和 $3 \\times 1$ 向量 $\\mathbf{b}$。\n3.  求解线性系统 $\\mathbf{M}\\mathbf{J} = \\mathbf{b}$，得到有效辐射向量 $\\mathbf{J} = [J_1, J_2, J_3]^T$。\n4.  使用计算出的有效辐射 $\\mathbf{J}$ 和公式 $q_i = A_i \\sum_{j=1}^{3} F_{ij} (J_i - J_j)$ 计算每个表面的净换热率 $q_i$。\n5.  验证 $\\sum_{i=1}^{3} q_i \\approx 0$，由于封闭系统中的能量守恒，此式必须成立。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the net radiative heat rates in a three-surface enclosure\n    for a given set of test cases.\n    \"\"\"\n\n    # Physical constants and geometry\n    SIGMA = 5.670374419e-8  # Stefan-Boltzmann constant, W m^-2 K^-4\n    AREAS = np.array([2.0, 3.0, 5.0])  # Surface areas A_i, m^2\n    F_MATRIX = np.array([\n        [0.1, 0.3, 0.6],\n        [0.2, 0.3, 0.5],\n        [0.24, 0.3, 0.46]\n    ])  # View factor matrix F_ij\n\n    # Test suite\n    test_cases = [\n        {\n            \"emissivity\": np.array([0.7, 0.9, 0.5]),\n            \"temperature\": np.array([1000.0, 800.0, 600.0])\n        },\n        {\n            \"emissivity\": np.array([1.0, 1.0, 1.0]),\n            \"temperature\": np.array([800.0, 800.0, 800.0])\n        },\n        {\n            \"emissivity\": np.array([0.05, 0.05, 0.9]),\n            \"temperature\": np.array([1200.0, 500.0, 500.0])\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        epsilons = case[\"emissivity\"]\n        temps = case[\"temperature\"]\n        \n        # 1. Calculate blackbody emissive powers (E_b,i = sigma * T_i^4)\n        e_b = SIGMA * (temps ** 4)\n\n        # 2. Construct the linear system MJ = b\n        # M_ij = delta_ij - (1 - epsilon_i) * F_ij\n        # b_i = epsilon_i * E_b,i\n        num_surfaces = 3\n        m_matrix = np.zeros((num_surfaces, num_surfaces))\n        b_vector = np.zeros(num_surfaces)\n\n        for i in range(num_surfaces):\n            b_vector[i] = epsilons[i] * e_b[i]\n            for j in range(num_surfaces):\n                delta_ij = 1.0 if i == j else 0.0\n                m_matrix[i, j] = delta_ij - (1.0 - epsilons[i]) * F_MATRIX[i, j]\n\n        # 3. Solve for radiosities J\n        radiosities = np.linalg.solve(m_matrix, b_vector)\n\n        # 4. Calculate net heat rates q_i\n        # q_i = A_i * sum_j(F_ij * (J_i - J_j))\n        # This can be computed as: q_i = A_i * (J_i * sum_j(F_ij) - sum_j(F_ij * J_j))\n        # Since sum_j(F_ij) = 1, this simplifies to: q_i = A_i * (J_i - sum_j(F_ij * J_j))\n        q_rates = np.zeros(num_surfaces)\n        for i in range(num_surfaces):\n            sum_fj = np.dot(F_MATRIX[i, :], radiosities)\n            q_rates[i] = AREAS[i] * (radiosities[i] - sum_fj)\n\n        # Store rounded results for the current case\n        rounded_q = [round(q, 6) for q in q_rates]\n        all_results.append(rounded_q)\n\n    # Format the final output string as specified\n    # Format: [[q11,q12,q13],[q21,q22,q23],[q31,q32,q33]]\n    output_parts = []\n    for result_list in all_results:\n        # Using f-string format specifier for consistent 6 decimal places\n        inner_str = ','.join([f\"{val:.6f}\" for val in result_list])\n        output_parts.append(f\"[{inner_str}]\")\n    \n    final_output = f\"[{','.join(output_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2526903"}]}