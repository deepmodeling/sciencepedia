{"hands_on_practices": [{"introduction": "本练习旨在介绍动量积分法，这是一种分析边界层的强大近似技术。通过为速度剖面假设一个多项式形式，您将推导出关键的边界层参数，并将其与精确的 Blasius 解进行比较[@problem_id:2500262]。这项实践旨在培养以积分形式应用守恒原理的技能，并突显在流体动力学建模中准确性与复杂性之间的权衡。", "problem": "在一个运动粘度为 $\\nu$、动力粘度为 $\\mu$、施加的压力梯度为零且物性恒定的流体中，一个稳态、二维、不可压缩的层流边界层在一个与速度为 $U$ 的均匀自由来流对齐的半无限平板上形成。令 $x$ 表示流向坐标，$y$ 表示法向坐标。假设厚度为 $\\delta(x)$ 的边界层内的流向速度剖面可由四次 Pohlhausen 多项式近似表示\n$$\n\\frac{u(x,y)}{U} \\equiv \\phi(\\eta) = 2 \\eta - 2 \\eta^{3} + \\eta^{4}, \\quad \\eta \\equiv \\frac{y}{\\delta(x)} ,\n$$\n该多项式满足边界条件 $u(x,0)=0$，$u(x,\\delta)=U$ 和 $\\partial u/\\partial y\\vert_{y=\\delta}=0$。\n\n从稳态、二维的质量和动量边界层方程出发，并仅以这些方程为基本依据，执行以下步骤：\n- 推导适用于零压力梯度平板边界层的动量积分关系式，并用动量厚度 $\\theta(x)$ 和壁面剪切应力 $\\tau_{w}(x)$ 表示。\n- 使用假设的剖面 $\\phi(\\eta)$，通过在 $0 \\le \\eta \\le 1$ 上计算所需的积分，计算位移厚度 $\\delta^{*}(x)$ 和动量厚度 $\\theta(x)$ 作为 $\\delta(x)$ 的精确倍数。\n- 根据本构关系和假设的剖面，计算壁面剪切应力 $\\tau_{w}(x)$ 与 $\\delta(x)$ 的关系，然后得到并求解由动量积分关系式所隐含的关于 $\\delta(x)$ 的常微分方程。\n- 消去 $\\delta(x)$，将位移厚度表示为 $\\delta^{*}(x) = C \\sqrt{\\nu x / U}$ 的形式，并确定无量纲系数 $C$。\n- 计算由假设剖面预测的形状因子 $H \\equiv \\delta^{*}/\\theta$。\n\n将您的值与精确的 Blasius 相似解结果 $\\delta^{*}_{\\mathrm{Bl}}(x)=1.7208 \\sqrt{\\nu x/U}$ 和 $H_{\\mathrm{Bl}} \\approx 2.59$ 进行比较，讨论偏差的符号和大小，但不要在最终的数值答案中报告这些比较。\n\n作为您的最终答案，请报告由系数 $C$ 和形状因子 $H$ 组成的对，形式为行矩阵 $\\big[\\,C \\;\\; H\\,\\big]$。将两个报告的数字四舍五入到四位有效数字。$C$ 和 $H$ 均为无量纲；在报告的对中不要包含单位。", "solution": "所述问题具有科学依据，是适定且客观的。它展示了积分边界层方法的标准应用，这是流体力学中一种有效且成熟的近似技术。所有给定条件都是一致的，并且足以得到唯一解。我们按照指示进行推导。\n\n首先，我们推导动量积分关系。零压力梯度下的稳态、二维、不可压缩边界层方程为：\n连续性方程：\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\n$$\n动量方程：\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}\n$$\n动量方程可以使用乘积法则和连续性方程重写：\n$$\n\\frac{\\partial (u^2)}{\\partial x} + \\frac{\\partial (uv)}{\\partial y} - u \\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = \\nu \\frac{\\partial^2 u}{\\partial y^2}\n$$\n括号中的项为零，剩下：\n$$\n\\frac{\\partial (u^2)}{\\partial x} + \\frac{\\partial (uv)}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}\n$$\n我们对该方程从壁面（$y=0$）到边界层外的一个位置 $y=h$（其中 $h > \\delta(x)$）对 $y$ 进行积分：\n$$\n\\int_0^h \\frac{\\partial (u^2)}{\\partial x} dy + \\int_0^h \\frac{\\partial (uv)}{\\partial y} dy = \\int_0^h \\nu \\frac{\\partial^2 u}{\\partial y^2} dy\n$$\n计算每一项：\n右侧是 $\\nu \\left[\\frac{\\partial u}{\\partial y}\\right]_0^h = \\nu \\left(\\frac{\\partial u}{\\partial y}\\big|_{y=h} - \\frac{\\partial u}{\\partial y}\\big|_{y=0}\\right)$。由于当 $y \\ge \\delta$ 时 $u=U$，所以 $\\frac{\\partial u}{\\partial y}\\big|_{y=h} = 0$。壁面剪切应力为 $\\tau_w = \\mu \\frac{\\partial u}{\\partial y}\\big|_{y=0}$。因此，右侧变为 $-\\nu \\frac{\\tau_w}{\\mu} = -\\frac{\\tau_w}{\\rho}$。\n\n左侧第二项是 $[uv]_0^h = u(h)v(h) - u(0)v(0)$。根据无滑移（$u(0)=0$）和无穿透（$v(0)=0$）条件，此项为 $u(h)v(h) = U v(h)$。我们通过对连续性方程积分来求 $v(h)$：$v(h) = \\int_0^h \\frac{\\partial v}{\\partial y} dy = -\\int_0^h \\frac{\\partial u}{\\partial x} dy$。\n\n左侧第一项使用莱布尼茨积分法则处理，其中 $h$ 是一个常数：$\\int_0^h \\frac{\\partial (u^2)}{\\partial x} dy = \\frac{d}{dx} \\int_0^h u^2 dy$。\n\n合并所有项：\n$$\n\\frac{d}{dx} \\int_0^h u^2 dy - U \\int_0^h \\frac{\\partial u}{\\partial x} dy = -\\frac{\\tau_w}{\\rho}\n$$\n考虑到 $\\int_0^h \\frac{\\partial u}{\\partial x} dy = \\frac{d}{dx} \\int_0^h u \\, dy$：\n$$\n\\frac{d}{dx} \\int_0^h u^2 dy - U \\frac{d}{dx} \\int_0^h u \\, dy = -\\frac{\\tau_w}{\\rho}\n$$\n$$\n\\frac{d}{dx} \\int_0^h (u^2 - Uu) dy = -\\frac{\\tau_w}{\\rho} \\implies \\frac{d}{dx} \\int_0^h u(U-u) dy = \\frac{\\tau_w}{\\rho}\n$$\n动量厚度 $\\theta(x)$ 定义为 $\\theta = \\int_0^\\infty \\frac{u}{U}(1-\\frac{u}{U})dy$。该积分可以写成 $U^2 \\theta = \\int_0^\\infty u(U-u)dy$。由于当 $y > \\delta$ 时被积函数为零，积分上限可以取为 $\\infty$。将此代入方程得到：\n$$\n\\frac{d}{dx}(U^2\\theta) = \\frac{\\tau_w}{\\rho}\n$$\n对于恒定的自由来流速度 $U$，此式简化为所需的动量积分关系式：\n$$\n\\tau_w = \\rho U^2 \\frac{d\\theta}{dx}\n$$\n接下来，我们使用给定的速度剖面 $\\frac{u}{U} = \\phi(\\eta) = 2\\eta - 2\\eta^3 + \\eta^4$（其中 $\\eta = y/\\delta(x)$）来计算位移厚度 $\\delta^*(x)$ 和动量厚度 $\\theta(x)$。\n$$\n\\delta^* = \\int_0^\\infty \\left(1-\\frac{u}{U}\\right)dy = \\delta \\int_0^1 (1-\\phi(\\eta))d\\eta\n$$\n$$\n\\delta^* = \\delta \\int_0^1 (1 - 2\\eta + 2\\eta^3 - \\eta^4)d\\eta = \\delta \\left[\\eta - \\eta^2 + \\frac{2}{4}\\eta^4 - \\frac{1}{5}\\eta^5\\right]_0^1\n$$\n$$\n\\delta^* = \\delta \\left(1-1+\\frac{1}{2}-\\frac{1}{5}\\right) = \\delta\\left(\\frac{5-2}{10}\\right) = \\frac{3}{10}\\delta(x)\n$$\n$$\n\\theta = \\int_0^\\infty \\frac{u}{U}\\left(1-\\frac{u}{U}\\right)dy = \\delta \\int_0^1 \\phi(\\eta)(1-\\phi(\\eta))d\\eta = \\delta \\left( \\int_0^1 \\phi(\\eta)d\\eta - \\int_0^1 \\phi^2(\\eta)d\\eta \\right)\n$$\n第一个积分：\n$$\n\\int_0^1 \\phi(\\eta)d\\eta = \\int_0^1 (2\\eta - 2\\eta^3 + \\eta^4)d\\eta = \\left[\\eta^2 - \\frac{2}{4}\\eta^4 + \\frac{1}{5}\\eta^5\\right]_0^1 = 1-\\frac{1}{2}+\\frac{1}{5} = \\frac{7}{10}\n$$\n第二个积分：\n$$\n\\phi^2(\\eta) = (2\\eta - 2\\eta^3 + \\eta^4)^2 = 4\\eta^2 + 4\\eta^6 + \\eta^8 - 8\\eta^4 + 4\\eta^5 - 4\\eta^7\n$$\n$$\n\\int_0^1 \\phi^2(\\eta)d\\eta = \\int_0^1 (4\\eta^2 - 8\\eta^4 + 4\\eta^5 + 4\\eta^6 - 4\\eta^7 + \\eta^8) d\\eta\n$$\n$$\n= \\left[\\frac{4}{3}\\eta^3 - \\frac{8}{5}\\eta^5 + \\frac{4}{6}\\eta^6 + \\frac{4}{7}\\eta^7 - \\frac{4}{8}\\eta^8 + \\frac{1}{9}\\eta^9\\right]_0^1 = \\frac{4}{3} - \\frac{8}{5} + \\frac{2}{3} + \\frac{4}{7} - \\frac{1}{2} + \\frac{1}{9} = \\frac{367}{630}\n$$\n所以，对于 $\\theta$：\n$$\n\\theta = \\delta \\left(\\frac{7}{10} - \\frac{367}{630}\\right) = \\delta \\left(\\frac{441 - 367}{630}\\right) = \\frac{74}{630}\\delta(x) = \\frac{37}{315}\\delta(x)\n$$\n现在我们计算壁面剪切应力 $\\tau_w$：\n$$\n\\tau_w = \\mu \\frac{\\partial u}{\\partial y}\\bigg|_{y=0} = \\mu \\frac{U}{\\delta} \\frac{d\\phi}{d\\eta}\\bigg|_{\\eta=0}\n$$\n$$\n\\frac{d\\phi}{d\\eta} = 2 - 6\\eta^2 + 4\\eta^3 \\implies \\frac{d\\phi}{d\\eta}\\bigg|_{\\eta=0} = 2\n$$\n$$\n\\tau_w = \\frac{2\\mu U}{\\delta}\n$$\n将 $\\tau_w$ 和 $\\theta$ 代入动量积分方程：\n$$\n\\frac{2\\mu U}{\\delta} = \\rho U^2 \\frac{d}{dx}\\left(\\frac{37}{315}\\delta\\right) = \\rho U^2 \\frac{37}{315} \\frac{d\\delta}{dx}\n$$\n重新整理得到一个关于 $\\delta(x)$ 的微分方程：\n$$\n\\delta \\frac{d\\delta}{dx} = \\frac{2\\mu U}{\\rho U^2} \\frac{315}{37} = \\frac{2\\nu}{U} \\frac{315}{37} = \\frac{630}{37} \\frac{\\nu}{U}\n$$\n假设 $\\delta(0)=0$，对 $x$ 积分：\n$$\n\\int_0^\\delta \\delta' d\\delta' = \\frac{630}{37}\\frac{\\nu}{U} \\int_0^x dx' \\implies \\frac{1}{2}\\delta^2 = \\frac{630}{37} \\frac{\\nu x}{U}\n$$\n$$\n\\delta^2(x) = \\frac{1260}{37} \\frac{\\nu x}{U} \\implies \\delta(x) = \\sqrt{\\frac{1260}{37}} \\sqrt{\\frac{\\nu x}{U}}\n$$\n我们现在可以将 $\\delta^*(x)$ 表示为所需的形式 $\\delta^{*}(x) = C \\sqrt{\\nu x / U}$：\n$$\n\\delta^*(x) = \\frac{3}{10}\\delta(x) = \\frac{3}{10} \\sqrt{\\frac{1260}{37}} \\sqrt{\\frac{\\nu x}{U}}\n$$\n因此，系数 $C$ 为：\n$$\nC = \\frac{3}{10}\\sqrt{\\frac{1260}{37}} = \\frac{3}{10}\\sqrt{\\frac{36 \\times 35}{37}} = \\frac{3 \\times 6}{10}\\sqrt{\\frac{35}{37}} = \\frac{9}{5}\\sqrt{\\frac{35}{37}}\n$$\n数值上，$C = 1.8 \\sqrt{35/37} \\approx 1.750675$。四舍五入到四位有效数字，$C = 1.751$。\n\n最后，我们计算形状因子 $H$：\n$$\nH = \\frac{\\delta^*}{\\theta} = \\frac{\\frac{3}{10}\\delta}{\\frac{37}{315}\\delta} = \\frac{3}{10} \\times \\frac{315}{37} = \\frac{945}{370} = \\frac{189}{74}\n$$\n数值上，$H \\approx 2.554054$。四舍五入到四位有效数字，$H = 2.554$。\n\n按要求，我们将这些结果与精确的 Blasius 相似解进行比较。\n计算出的系数 $C \\approx 1.751$ 大于精确值 $C_{\\mathrm{Bl}} = 1.7208$。偏差为正，相对误差约为 $+1.74\\%$。\n计算出的形状因子 $H \\approx 2.554$ 小于精确值 $H_{\\mathrm{Bl}} \\approx 2.59$。偏差为负，相对误差约为 $-1.39\\%$。这些偏差很小，是近似积分方法所预期的结果。\n\n所要求的最终值是系数 $C$ 和形状因子 $H$，四舍五入到四位有效数字。\n$C = 1.751$\n$H = 2.554$", "answer": "$$\n\\boxed{\n\\begin{bmatrix}\n1.751  2.554\n\\end{bmatrix}\n}\n$$", "id": "2500262"}, {"introduction": "虽然积分方法提供了有用的估算，但 Blasius 方程允许通过数值方法获得“精确”解。本练习将指导您从第一性原理推导 Blasius 常微分方程，并实现一种打靶法来求解它[@problem_id:2500302]。掌握这项技术对于准确预测层流边界层中的壁面切应力和速度场至关重要。", "problem": "要求您设计并实现一种数值打靶法，用于计算在与均匀自由来流对齐的半无限平板上形成的二维、定常、不可压缩层流边界层的相似解。该物理问题由纳维-斯托克斯方程的边界层近似所控制。您的任务必须从基本守恒定律和经过充分检验的数学事实出发，推导出向边值常微分方程的相似性约化，然后将其转换为一个数值上易于处理的初值问题，其中包含一个未知的初始斜率，您需要通过强制执行渐近边界条件来确定该斜率。\n\n请从以下基础开始。\n\n- 定常、二维、不可压缩边界层方程由连续性方程和以笛卡尔坐标系书写的流向动量方程组成：\n  - 连续性方程：$\\dfrac{\\partial u}{\\partial x} + \\dfrac{\\partial v}{\\partial y} = 0$。\n  - 流向动量方程：$u \\dfrac{\\partial u}{\\partial x} + v \\dfrac{\\partial u}{\\partial y} = \\nu \\dfrac{\\partial^2 u}{\\partial y^2}$，其中 $\\nu$ 是运动粘度，$u(x,y)$ 和 $v(x,y)$ 分别是流向和壁面法向的速度分量。\n\n- 边界条件是在壁面处的无滑移和无穿透条件，以及远离壁面处的均匀自由来流：\n  - 在壁面 $y = 0$ 处：$u(x,0) = 0$，$v(x,0) = 0$。\n  - 当 $y \\to \\infty$ 时：$u(x,y) \\to U_\\infty$，其中 $U_\\infty$ 是恒定的自由来流速度。\n\n待完成任务：\n\n1. 从上述控制方程和边界条件出发，引入形式为\n   - $\\psi(x,y) = \\sqrt{\\nu U_\\infty x}\\, f(\\eta)$，\n   - $\\eta = y \\sqrt{\\dfrac{U_\\infty}{\\nu x}}$，\n   的相似性变量和流函数，并使用定义 $u = \\dfrac{\\partial \\psi}{\\partial y}$ 和 $v = -\\dfrac{\\partial \\psi}{\\partial x}$ 将偏微分方程约化为关于 $f(\\eta)$ 的单个边值常微分方程及其在相似性坐标系下的边界条件。您必须提供逻辑步骤，以证明所得方程和边界条件是无量纲的，并且除了通过相似性变量外，不显式依赖于 $x$、$y$ 或其他物理参数。\n\n2. 使用辅助变量（例如，通过定义 $f = y_1$、$f' = y_2$ 和 $f'' = y_3$）将边值常微分方程转换为一阶初值方程组，并确定在 $\\eta = 0$ 处作为打靶参数的未知初始条件。解释如何调整这个未知参数，以满足 $\\eta \\to \\infty$ 处的远场条件。\n\n3. 提出一种基于一维求根方法的更新程序，该方法仅使用函数求值（不需要关于打靶参数的导数）来调整未知初始条件。您的更新规则必须基于非线性方程求根的首要原则进行论证，并且必须在远场残差满足用户指定的容差时终止。您应该讨论如何处理 $\\eta$ 的计算域在有限的 $\\eta_{\\max}$ 处被截断这一事实，以及这如何影响残差的定义。\n\n4. 将您的程序实现为一个完整的程序，该程序：\n   - 对于打靶参数的任何试验值，将初值系统从 $\\eta = 0$ 积分到 $\\eta = \\eta_{\\max}$。\n   - 评估一个定义为在 $\\eta = \\eta_{\\max}$ 处流向相似速度导数与其远场目标值的偏差的残差。\n   - 迭代地更新打靶参数，直到残差大小小于指定的容差。\n   - 对于下面指定的每个测试用例，报告收敛的打靶参数值。相似性公式中的所有变量都是无量纲的。不需要物理单位，也不应报告。\n\n测试套件规范：\n\n对于每个测试，您将得到一个四元组 $(\\eta_{\\max}, s_0, s_1, \\varepsilon)$，其中：\n- $\\eta_{\\max}$ 是用于近似远场的相似性坐标的有限截断值，\n- $s_0$ 和 $s_1$ 是打靶参数 $s = f''(0)$ 的两个不同初始猜测值，\n- $\\varepsilon$ 是远场残差的绝对容差。\n\n您的程序必须为以下测试套件解决该问题：\n- 测试 $1$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (10, 0.3, 0.35, 10^{-10})$。\n- 测试 $2$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (8, 0.1, 1.0, 10^{-8})$。\n- 测试 $3$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (6, 0.3, 0.35, 10^{-8})$。\n- 测试 $4$：$(\\eta_{\\max}, s_0, s_1, \\varepsilon) = (12, 0.33, 0.34, 10^{-12})$。\n\n输出规范：\n\n- 对于每个测试，仅输出您的算法计算出的打靶参数 $s^\\star = f''(0)$ 的收敛值。\n- 将四个浮点数结果按测试顺序聚合到单行中，格式严格为方括号括起来的逗号分隔列表，每个值精确到小数点后六位，例如 `[0.111111,0.222222,0.333333,0.444444]`。", "solution": "该问题需经过验证。\n\n### 第一步：提取已知条件\n\n针对定常、二维、不可压缩层流边界层的控制偏微分方程已给出：\n- 连续性方程：$\\dfrac{\\partial u}{\\partial x} + \\dfrac{\\partial v}{\\partial y} = 0$。\n- 流向动量方程：$u \\dfrac{\\partial u}{\\partial x} + v \\dfrac{\\partial u}{\\partial y} = \\nu \\dfrac{\\partial^2 u}{\\partial y^2}$。\n\n边界条件为：\n- 在壁面，$y = 0$ 处：$u(x,0) = 0$ 和 $v(x,0) = 0$。\n- 在自由来流中，当 $y \\to \\infty$ 时：$u(x,y) \\to U_\\infty$。\n\n相似性变换定义为：\n- 流函数：$\\psi(x,y) = \\sqrt{\\nu U_\\infty x}\\, f(\\eta)$。\n- 相似性变量：$\\eta = y \\sqrt{\\dfrac{U_\\infty}{\\nu x}}$。\n\n速度分量与流函数的关系为：\n- $u = \\dfrac{\\partial \\psi}{\\partial y}$。\n- $v = -\\dfrac{\\partial \\psi}{\\partial x}$。\n\n任务是：\n1.  推导相似性常微分方程（ODE）$f(\\eta)$ 及其边界条件。\n2.  将得到的边值问题（BVP）转换为一个初值问题（IVP）系统，并确定打靶参数。\n3.  提出一种无导数的求根方法（例如，割线法）来确定打靶参数。\n4.  实现一个程序，为给定的测试套件求解打靶参数 $s = f''(0)$。\n\n测试套件由四元组 $(\\eta_{\\max}, s_0, s_1, \\varepsilon)$ 指定：\n- 测试 $1$：$(10, 0.3, 0.35, 10^{-10})$。\n- 测试 $2$：$(8, 0.1, 1.0, 10^{-8})$。\n- 测试 $3$：$(6, 0.3, 0.35, 10^{-8})$。\n- 测试 $4$：$(12, 0.33, 0.34, 10^{-12})$。\n\n输出必须是每个测试用例收敛的 $f''(0)$ 值，保留六位小数，并以特定的列表格式呈现。\n\n### 第二步：使用提取的已知条件进行验证\n\n- **科学上可靠**：该问题是流体力学中的一个经典问题，描述了平板上层流边界层的 Blasius 解。控制方程和边界条件是标准的、基础稳固的。这是边界层理论的关键基础。\n- **适定的**：问题陈述导出了 Blasius 方程，这是一个适定的边值问题，已知有唯一、稳定且具有物理意义的解。\n- **客观的**：问题以精确、形式化的数学和物理语言陈述，没有歧义或主观论断。\n- **完整的**：为测试用例提供了所有必需的方程、边界条件、定义和数值参数。问题是自洽的。\n- **一致的**：所提供的信息内部一致，不包含矛盾。任务之间逻辑上层层递进，从理论推导到数值实现。\n\n该问题未表现出验证清单中列出的任何缺陷。它是计算流体力学中一个标准、可验证且结构良好的问题。\n\n### 第三步：结论与行动\n\n该问题是**有效的**。将提供解答。\n\n---\n\n以下是基于流体力学和数值分析原理的逐步解答。\n\n**任务1：Blasius 相似性方程的推导**\n\n目标是使用给定的相似性变换将控制偏微分方程约化为单个常微分方程。我们首先用相似性函数 $f(\\eta)$ 表示速度分量 $u$ 和 $v$。\n\n相似性变量为 $\\eta = y \\sqrt{\\frac{U_\\infty}{\\nu x}}$，流函数为 $\\psi(x,y) = \\sqrt{\\nu U_\\infty x} f(\\eta)$。撇号表示法，例如 $f'$，将表示对 $\\eta$ 的微分。\n\n首先，我们计算流向速度分量 $u$：\n$$\nu = \\frac{\\partial \\psi}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sqrt{\\nu U_\\infty x} f(\\eta) \\right) = \\sqrt{\\nu U_\\infty x} \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial y}\n$$\n$\\eta$ 对 $y$ 的导数为：\n$$\n\\frac{\\partial \\eta}{\\partial y} = \\sqrt{\\frac{U_\\infty}{\\nu x}}\n$$\n将此代入 $u$ 的表达式中得到：\n$$\nu = \\sqrt{\\nu U_\\infty x} f'(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}} = U_\\infty f'(\\eta)\n$$\n\n接下来，我们计算壁面法向速度分量 $v$。这更复杂，因为 $\\psi$ 的乘积中的两项以及变量 $\\eta$ 本身都依赖于 $x$：\n$$\nv = -\\frac{\\partial \\psi}{\\partial x} = -\\frac{\\partial}{\\partial x} \\left( \\sqrt{\\nu U_\\infty x} f(\\eta) \\right) = -\\left[ \\frac{\\partial(\\sqrt{\\nu U_\\infty x})}{\\partial x} f(\\eta) + \\sqrt{\\nu U_\\infty x} \\frac{\\partial(f(\\eta))}{\\partial x} \\right]\n$$\n各项导数为：\n$$\n\\frac{\\partial(\\sqrt{\\nu U_\\infty x})}{\\partial x} = \\sqrt{\\nu U_\\infty} \\frac{1}{2\\sqrt{x}} = \\frac{1}{2x} \\sqrt{\\nu U_\\infty x}\n$$\n$$\n\\frac{\\partial(f(\\eta))}{\\partial x} = \\frac{df}{d\\eta} \\frac{\\partial \\eta}{\\partial x} = f'(\\eta) \\frac{\\partial \\eta}{\\partial x}\n$$\n$$\n\\frac{\\partial \\eta}{\\partial x} = y \\sqrt{\\frac{U_\\infty}{\\nu}} \\left(-\\frac{1}{2} x^{-3/2}\\right) = -\\frac{1}{2x} \\left(y \\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = -\\frac{\\eta}{2x}\n$$\n将这些代回 $v$ 的表达式中：\n$$\nv = -\\left[ \\frac{1}{2x} \\sqrt{\\nu U_\\infty x} f(\\eta) + \\sqrt{\\nu U_\\infty x} f'(\\eta) \\left(-\\frac{\\eta}{2x}\\right) \\right] = \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} \\left( \\eta f'(\\eta) - f(\\eta) \\right)\n$$\n根据流函数的定义，连续性方程 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0$ 自动满足，因为 $\\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0$。\n\n现在，我们计算动量方程中的各项：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} (U_\\infty f'(\\eta)) = U_\\infty f''(\\eta) \\frac{\\partial \\eta}{\\partial x} = U_\\infty f''(\\eta) \\left(-\\frac{\\eta}{2x}\\right) = -\\frac{U_\\infty \\eta}{2x} f''(\\eta)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} (U_\\infty f'(\\eta)) = U_\\infty f''(\\eta) \\frac{\\partial \\eta}{\\partial y} = U_\\infty f''(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}}\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left( U_\\infty f''(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}} \\right) = U_\\infty f'''(\\eta) \\left(\\frac{\\partial \\eta}{\\partial y}\\right)^2 = U_\\infty f'''(\\eta) \\frac{U_\\infty}{\\nu x}\n$$\n将这些表达式代入动量方程 $u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}$：\n$$\n(U_\\infty f') \\left(-\\frac{U_\\infty \\eta}{2x} f''\\right) + \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} (\\eta f' - f) \\left(U_\\infty f'' \\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = \\nu \\left(U_\\infty f''' \\frac{U_\\infty}{\\nu x}\\right)\n$$\n简化左侧（LHS）：\n$$\n\\text{LHS} = -\\frac{U_\\infty^2}{2x} \\eta f' f'' + \\frac{1}{2} \\frac{U_\\infty^2}{x} (\\eta f' - f) f'' = \\frac{U_\\infty^2}{2x} (-\\eta f' f'' + \\eta f' f'' - f f'') = -\\frac{U_\\infty^2}{2x} f f''\n$$\n简化右侧（RHS）：\n$$\n\\text{RHS} = \\frac{U_\\infty^2}{x} f'''\n$$\n令简化的 LHS 和 RHS 相等：\n$$\n-\\frac{U_\\infty^2}{2x} f f'' = \\frac{U_\\infty^2}{x} f'''\n$$\n消去公因子 $\\frac{U_\\infty^2}{x}$ 后，我们得到 Blasius 方程：\n$$\nf'''(\\eta) + \\frac{1}{2} f(\\eta) f''(\\eta) = 0 \\quad \\text{或} \\quad 2 f''' + f f'' = 0\n$$\n这是一个三阶非线性常微分方程。变换是成功的，因为该方程只依赖于 $\\eta$ 和 $f(\\eta)$，而不依赖于 $x$、$y$ 或物理参数。\n\n现在我们变换边界条件：\n- 在壁面处，$y=0$，这意味着 $\\eta = 0 \\sqrt{\\frac{U_\\infty}{\\nu x}} = 0$。\n  - $u(x,0) = 0 \\implies U_\\infty f'(0) = 0 \\implies f'(0) = 0$。\n  - $v(x,0) = 0 \\implies \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} (\\eta f'(0) - f(0))|_{\\eta=0} = 0 \\implies 0 - f(0) = 0 \\implies f(0) = 0$。\n- 在自由来流中，$y \\to \\infty$，这意味着 $\\eta \\to \\infty$。\n  - $u(x,y) \\to U_\\infty \\implies U_\\infty f'(\\eta) \\to U_\\infty \\implies f'(\\eta \\to \\infty) = 1$。\n\n在相似性坐标系下的完整边值问题是：\n$$\n2 f''' + f f'' = 0\n$$\n服从于：\n$$\nf(0) = 0, \\quad f'(0) = 0, \\quad f'(\\eta \\to \\infty) = 1\n$$\n\n**任务2：转换为初值问题 (IVP)**\n\n这个三阶 BVP 被转换为一个包含三个一阶 ODE 的系统。我们定义一个状态向量 $\\mathbf{y}(\\eta) = [y_1(\\eta), y_2(\\eta), y_3(\\eta)]^T$，其中：\n- $y_1(\\eta) = f(\\eta)$\n- $y_2(\\eta) = f'(\\eta)$\n- $y_3(\\eta) = f''(\\eta)$\n\n一阶 ODE 系统由这些定义和 Blasius 方程推导得出：\n- $y_1' = f' = y_2$\n- $y_2' = f'' = y_3$\n- $y_3' = f''' = -\\frac{1}{2} f f'' = -\\frac{1}{2} y_1 y_3$\n\n在 $\\eta = 0$ 处的边界条件为该系统提供了两个初始条件：\n- $y_1(0) = f(0) = 0$\n- $y_2(0) = f'(0) = 0$\n\n要将此系统作为 IVP 求解，我们需要第三个初始条件，$y_3(0) = f''(0)$。这个值是未知的。我们必须猜测它。设这个打靶参数为 $s = f''(0) = y_3(0)$。\n\n待求解的 IVP 是：\n$$\n\\frac{d}{d\\eta} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ y_3 \\\\ -\\frac{1}{2} y_1 y_3 \\end{pmatrix}\n$$\n在 $\\eta=0$ 处的初始条件为：\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} 0 \\\\ 0 \\\\ s \\end{pmatrix}\n$$\n打靶法的过程是猜测一个 $s$ 值，将 IVP 从 $\\eta=0$ 积分到一个近似 $\\infty$ 的大值 $\\eta_{\\max}$，然后检查在无穷远处的边界条件 $f'(\\infty) = 1$（或 $y_2(\\infty)=1$）是否满足。我们定义一个残差函数 $R(s)$：\n$$\nR(s) = y_2(\\eta_{\\max}; s) - 1\n$$\n其中 $y_2(\\eta_{\\max}; s)$ 表示使用打靶参数 $s$ 得到的在 $\\eta_{\\max}$ 处的 $y_2$ 解。目标是找到 $s$ 的值，我们称之为 $s^*$，使得 $R(s^*) = 0$。\n\n**任务3：打靶参数的更新程序**\n\n我们需要找到非线性方程 $R(s)=0$ 的根 $s^*$。问题要求一种不需要导数 $\\frac{dR}{ds}$ 的方法。割线法是一个合适的选择。它是一种拟牛顿法，使用基于前两次迭代的有限差分来近似导数。\n\n给定打靶参数的两个初始猜测值 $s_0$ 和 $s_1$，割线法使用以下更新规则生成一个近似序列 $\\{s_k\\}$：\n$$\ns_{k+1} = s_k - R(s_k) \\frac{s_k - s_{k-1}}{R(s_k) - R(s_{k-1})}\n$$\n算法流程如下：\n1.  选择两个不同的初始猜测值 $s_0$ 和 $s_1$，以及一个容差 $\\varepsilon$。\n2.  通过对每个猜测值积分 IVP，计算残差 $R_0 = R(s_0)$ 和 $R_1 = R(s_1)$。\n3.  对于 $k=1, 2, ...$：\n    a. 使用上述公式计算下一个猜测值 $s_{k+1}$。\n    b. 使用 $s = s_{k+1}$ 积分 IVP 以找到新的残差 $R_{k+1} = R(s_{k+1})$。\n    c. 如果 $|R_{k+1}|  \\varepsilon$，则过程收敛。解为 $s^* \\approx s_{k+1}$。\n    d. 否则，更新下一次迭代的值：$s_k \\to s_{k+1}$，$s_{k-1} \\to s_k$，残差也做类似更新。\n\n由于数值积分无法进行到无穷大，计算域在有限的 $\\eta_{\\max}$ 处被截断。如果 $\\eta_{\\max}$ 选择得足够大，使得边界层流速已有效达到自由流速度，即对于 $\\eta \\ge \\eta_{\\max}$ 有 $f'(\\eta) \\approx 1$ 和 $f''(\\eta) \\approx 0$，则该近似是有效的。测试用例为 $\\eta_{\\max}$ 提供了值（$6, 8, 10, 12$），这些值已知对于所需的精度是足够的。因此，残差在此有限边界上定义：$R(s) = y_2(\\eta_{\\max}; s) - 1$。算法找到满足此截断边界上远场条件的 $s$ 值。\n\n**任务4：程序实现**\n\n上述逻辑在 Python 程序中实现。我们使用 `scipy.integrate.solve_ivp` 来积分 ODE 系统，并用一个循环来实现割线法求根。对于每个测试用例，报告最终收敛的打靶参数 $s^* = f''(0)$ 的值。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the Blasius boundary layer problem for a given test suite\n    using a numerical shooting method based on the Secant algorithm.\n    \"\"\"\n\n    def blasius_solver(eta_max: float, s0: float, s1: float, tol: float) - float:\n        \"\"\"\n        Finds the shooting parameter s = f''(0) for the Blasius equation.\n\n        Args:\n            eta_max: The finite truncation of the similarity coordinate.\n            s0: The first initial guess for the shooting parameter s.\n            s1: The second initial guess for the shooting parameter s.\n            tol: The absolute tolerance for the far-field residual.\n\n        Returns:\n            The converged value of the shooting parameter s.\n        \"\"\"\n\n        def ode_system(eta, y):\n            \"\"\"\n            Defines the system of first-order ODEs for the Blasius problem.\n            y[0] = f, y[1] = f', y[2] = f''\n            \"\"\"\n            _f, _f_prime, _f_double_prime = y\n            return [\n                _f_prime,\n                _f_double_prime,\n                -0.5 * _f * _f_double_prime,\n            ]\n\n        memo = {}\n        def get_residual(s: float) - float:\n            \"\"\"\n            Calculates the residual R(s) = f'(eta_max; s) - 1.\n            It integrates the ODE system for a given shooting parameter s.\n            \"\"\"\n            if s in memo:\n                return memo[s]\n            \n            y0 = [0.0, 0.0, s]\n            sol = solve_ivp(\n                ode_system,\n                [0, eta_max],\n                y0,\n                dense_output=True,\n                rtol=1e-13, # Use high-precision integration\n                atol=1e-13,\n            )\n            \n            # The value of f'(eta_max) is the second component of the solution vector\n            # at the last time point.\n            f_prime_at_eta_max = sol.y[1, -1]\n            residual = f_prime_at_eta_max - 1.0\n            memo[s] = residual\n            return residual\n\n        # Secant Method Implementation\n        s_prev, s_curr = s0, s1\n        r_prev = get_residual(s_prev)\n        r_curr = get_residual(s_curr)\n        \n        # Limit iterations to prevent infinite loops in case of non-convergence\n        max_iter = 50 \n        for _ in range(max_iter):\n            if abs(r_curr)  tol:\n                return s_curr\n\n            # Avoid division by zero, though unlikely for this problem\n            if abs(r_curr - r_prev)  1e-14:\n                # If residuals are too close, stop to avoid numerical instability.\n                # This may happen if tolerance is too low or guesses are bad.\n                break\n\n            s_next = s_curr - r_curr * (s_curr - s_prev) / (r_curr - r_prev)\n            \n            s_prev, s_curr = s_curr, s_next\n            r_prev, r_curr = r_curr, get_residual(s_curr)\n\n        return s_curr\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (10.0, 0.3, 0.35, 1e-10),\n        (8.0, 0.1, 1.0, 1e-8),\n        (6.0, 0.3, 0.35, 1e-8),\n        (12.0, 0.33, 0.34, 1e-12),\n    ]\n\n    results = []\n    for case in test_cases:\n        eta_max_val, s0_val, s1_val, tol_val = case\n        converged_s = blasius_solver(eta_max_val, s0_val, s1_val, tol_val)\n        results.append(converged_s)\n\n    # Format the final output string as specified.\n    # Each value must be rounded to exactly six digits after the decimal point.\n    output_str = ','.join([f\"{res:.6f}\" for res in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "2500302"}, {"introduction": "数值解会受到各种误差的影响，其中截断误差是近似无限域时的一个关键问题。这个高级练习建立在打靶法的基础上，探讨解对计算边界 $\\eta_{\\max}$ 选择的敏感性[@problem_id:2500305]。您将制定并应用准则，以确保您的数值结果不仅被计算出来，而且其准确性也得到验证，这是计算科学中的一项关键技能。", "problem": "考虑牛顿流体绕与均匀来流对齐的等温、半无限长平板的稳态、二维、不可压缩流动。层流边界层由普朗特边界层方程与连续性方程耦合建模。引入流函数以满足连续性方程，并引入相似性变量将偏微分方程组转化为一个带有适当边界条件的常微分方程，这些边界条件分别在壁面处和法向坐标趋于无穷远处施加。完全在最终得到的无量纲相似性变量下进行计算，从而不出现任何物理单位。\n\n您的目标是量化和控制当半无限相似性域在有限相似性坐标处被截断时所引入的截断误差。具体而言：\n\n- 从稳态、二维、不可压缩边界层方程和相似性流函数的定义出发，为一个单一无量纲相似性变量的无量纲函数，在半无限域上导出一个边值问题。不要假设任何简化公式：从控制方程和适当的相似性假设出发，建立最终的常微分方程和边界条件。\n\n- 以此边值问题为数学基准，在一个选定的截断边界 $\\eta_{\\max}$ 的有限区间 $\\left[0,\\eta_{\\max}\\right]$上定义一个截断问题。然后，设计一种数值方法，将该边值问题转化为一个带有未知壁面曲率参数的初值问题，通过确定该参数来强制在$\\eta=\\eta_{\\max}$处满足远场边界条件。该数值方法应针对未知的壁面曲率参数的候选值，对从$\\eta=0$到$\\eta=\\eta_{\\max}$的常微分方程进行积分，并调整该参数，直到在$\\eta_{\\max}$处的远场边界条件在数值容差范围内得到满足。\n\n- 截断误差的产生是因为真实的边界条件适用于$\\eta\\to\\infty$，而计算出的解是在$\\eta=\\eta_{\\max}$处强制满足该条件。请提出了一个准则，该准则纯粹用在$\\left[0,\\eta_{\\max}\\right]$上的解以及在一个更大的截断域$\\left[0,\\eta_{\\mathrm{ref}}\\right]$（其中$\\eta_{\\mathrm{ref}}\\gg \\eta_{\\max}$）上的参考计算来表示，以确保对于工程上关注的量（如无量纲壁面剪切，即壁面曲率参数），截断误差可以忽略不计。您的准则必须包括：\n  - 一个尾部小量条件，要求在截断边界处的无量纲二阶导数的绝对值$\\left|f''\\left(\\eta_{\\max}\\right)\\right|$不超过预设的容差$\\varepsilon_{\\mathrm{tail}}$。\n  - 一个关于无量纲壁面曲率参数的稳定性条件，要求截断域上的值与参考值的相对偏差$\\left|s\\left(\\eta_{\\max}\\right)-s\\left(\\eta_{\\mathrm{ref}}\\right)\\right|/s\\left(\\eta_{\\mathrm{ref}}\\right)$不超过预设的容差$\\varepsilon_{\\mathrm{rel}}$。\n\n- 实现一个鲁棒的数值算法，该算法：\n  1. 在一个非常大的域$\\left[0,\\eta_{\\mathrm{ref}}\\right]$上计算一个高精度的参考值$s\\left(\\eta_{\\mathrm{ref}}\\right)$。\n  2. 对于每个测试用例$\\left(\\eta_{\\max},\\varepsilon_{\\mathrm{tail}},\\varepsilon_{\\mathrm{rel}}\\right)$，通过打靶法计算截断域上的值$s\\left(\\eta_{\\max}\\right)$，以强制在$\\eta=\\eta_{\\max}$处满足远场边界条件，计算$\\left|f''\\left(\\eta_{\\max}\\right)\\right|$，并检验以下两个不等式\n     $$\\left|f''\\left(\\eta_{\\max}\\right)\\right|\\le \\varepsilon_{\\mathrm{tail}},\\qquad \\frac{\\left|s\\left(\\eta_{\\max}\\right)-s\\left(\\eta_{\\mathrm{ref}}\\right)\\right|}{s\\left(\\eta_{\\mathrm{ref}}\\right)}\\le \\varepsilon_{\\mathrm{rel}}.$$\n  3. 返回一个布尔值，指示两个不等式是否都满足。\n\n- 设计打靶法时，应包含壁面曲率参数的自动区间限定功能，以确保其对所有测试用例都能收敛。使用自适应步长、变阶数的常微分方程积分器，并设置严格的绝对和相对容差，以确保任何观察到的差异都归因于截断误差，而非时间步长误差。\n\n测试套件与答案规格：\n- 使用以下五个测试用例，每个由$\\left(\\eta_{\\max},\\varepsilon_{\\mathrm{tail}},\\varepsilon_{\\mathrm{rel}}\\right)$指定：\n  1. $\\left(4.0,\\,10^{-3},\\,10^{-3}\\right)$\n  2. $\\left(6.0,\\,5\\times 10^{-4},\\,2\\times 10^{-4}\\right)$\n  3. $\\left(8.0,\\,10^{-5},\\,10^{-4}\\right)$\n  4. $\\left(10.0,\\,10^{-6},\\,10^{-5}\\right)$\n  5. $\\left(12.0,\\,10^{-7},\\,5\\times 10^{-6}\\right)$\n\n- 选择一个单一的参考截断值$\\eta_{\\mathrm{ref}}=30.0$和相应的求解器容差，以证明将$s\\left(\\eta_{\\mathrm{ref}}\\right)$视为参考值是合理的。\n\n- 您的程序应产生单行输出，其中包含五个测试用例的布尔结果，形式为逗号分隔的列表并用方括号括起，例如，$\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}\\right]$，但使用标准编程语言的布尔字面量和列表格式打印，即与$[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{False}]$完全一样。\n\n所有数学符号和数字都必须解释为您推导的相似性变换所定义的无量纲量。在您的推导或输出中，不应出现任何角度、物理单位或百分号。所有数值容差必须严格按照上述规定实现，并酌情与绝对值或相对值进行比较。算法组件的描述和实现方式必须能在任何现代编程语言中普遍适用。", "solution": "所述问题是有效的。这是一个计算流体动力学中的适定问题，其基础是边界层理论的既定原则。该问题在科学上是合理的、客观的，并包含了进行唯一且可验证的数值求解所需的所有信息。它在实现鲁棒的数值方法以及在截断误差分析的背景下解释结果方面提出了一个不小的挑战。我们现在开始求解。\n\n物理系统是牛顿流体在半无限长平板上的稳态、二维、不可压缩层流。在普朗特边界层近似下，控制方程为连续性方程和$x$-动量方程：\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = 0\n$$\n$$\nu \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}\n$$\n这里，$u$和$v$分别是$x$（流向）和$y$（壁面法向）方向的速度分量，$\\nu$是流体的运动粘度。边界条件是板表面（$y=0$）的无滑移和不可穿透条件，以及远离板（$y \\to \\infty$）时与均匀自由来流速度$U_\\infty$匹配：\n$$\nu(x, 0) = 0, \\quad v(x, 0) = 0\n$$\n$$\nu(x, y \\to \\infty) = U_\\infty\n$$\n为了恒满足连续性方程，我们引入一个流函数$\\psi(x,y)$，使得：\n$$\nu = \\frac{\\partial \\psi}{\\partial y}, \\qquad v = - \\frac{\\partial \\psi}{\\partial x}\n$$\n将这些代入动量方程，得到一个关于$\\psi$的三阶偏微分方程：\n$$\n\\frac{\\partial \\psi}{\\partial y} \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial \\psi}{\\partial x} \\frac{\\partial^2 \\psi}{\\partial y^2} = \\nu \\frac{\\partial^3 \\psi}{\\partial y^3}\n$$\n该问题缺乏内在的长度尺度，这表明存在相似解。我们引入一个无量纲相似性变量$\\eta$和一个无量纲流函数$f(\\eta)$：\n$$\n\\eta = y \\sqrt{\\frac{U_\\infty}{\\nu x}}\n$$\n$$\n\\psi(x, y) = \\sqrt{\\nu x U_\\infty} f(\\eta)\n$$\n我们现在将速度分量及其导数变换到相似性坐标$(\\eta, f)$中。系统地应用链式法则。\n速度分量$u$为：\n$$\nu = \\frac{\\partial \\psi}{\\partial y} = \\frac{\\partial \\psi}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial y} = \\left(\\sqrt{\\nu x U_\\infty} f'(\\eta)\\right) \\left(\\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = U_\\infty f'(\\eta)\n$$\n速度分量$v$为：\n$$\nv = - \\frac{\\partial \\psi}{\\partial x} = - \\left( \\frac{\\partial}{\\partial x}\\left(\\sqrt{\\nu x U_\\infty}\\right) f(\\eta) + \\sqrt{\\nu x U_\\infty} \\frac{\\partial}{\\partial x}(f(\\eta)) \\right) \\\\ = - \\left( \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} f(\\eta) + \\sqrt{\\nu x U_\\infty} f'(\\eta) \\frac{\\partial \\eta}{\\partial x} \\right)\n$$\n由于$\\frac{\\partial \\eta}{\\partial x} = y \\sqrt{\\frac{U_\\infty}{\\nu}} \\left(-\\frac{1}{2} x^{-3/2}\\right) = -\\frac{1}{2x} \\left(y \\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = -\\frac{\\eta}{2x}$，我们得到：\n$$\nv = - \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} f(\\eta) - \\sqrt{\\nu x U_\\infty} f'(\\eta) \\left(-\\frac{\\eta}{2x}\\right) = \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} \\left( \\eta f'(\\eta) - f(\\eta) \\right)\n$$\n接下来，我们计算动量方程中出现的导数：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} (U_\\infty f'(\\eta)) = U_\\infty f''(\\eta) \\frac{\\partial \\eta}{\\partial x} = U_\\infty f''(\\eta) \\left(-\\frac{\\eta}{2x}\\right) = -\\frac{U_\\infty \\eta}{2x} f''(\\eta)\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} (U_\\infty f'(\\eta)) = U_\\infty f''(\\eta) \\frac{\\partial \\eta}{\\partial y} = U_\\infty f''(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}}\n$$\n$$\n\\frac{\\partial^2 u}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left( U_\\infty f''(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}} \\right) = U_\\infty \\sqrt{\\frac{U_\\infty}{\\nu x}} f'''(\\eta) \\frac{\\partial \\eta}{\\partial y} = \\frac{U_\\infty^2}{\\nu x} f'''(\\eta)\n$$\n将这些表达式代回动量方程$u \\frac{\\partial u}{\\partial x} + v \\frac{\\partial u}{\\partial y} = \\nu \\frac{\\partial^2 u}{\\partial y^2}$：\n$$\n\\left(U_\\infty f'(\\eta)\\right) \\left(-\\frac{U_\\infty \\eta}{2x} f''(\\eta)\\right) + \\left(\\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} \\left( \\eta f'(\\eta) - f(\\eta) \\right)\\right) \\left(U_\\infty f''(\\eta) \\sqrt{\\frac{U_\\infty}{\\nu x}}\\right) = \\nu \\left(\\frac{U_\\infty^2}{\\nu x} f'''(\\eta)\\right)\n$$\n将此方程的所有项除以公因子$\\frac{U_\\infty^2}{x}$进行简化：\n$$\n-\\frac{1}{2} \\eta f'(\\eta) f''(\\eta) + \\frac{1}{2} \\left( \\eta f'(\\eta) - f(\\eta) \\right) f''(\\eta) = f'''(\\eta)\n$$\n包含$\\eta f'(\\eta) f''(\\eta)$的项相互抵消，得到Blasius方程，这是一个三阶常微分方程：\n$$\n2 f'''(\\eta) + f(\\eta) f''(\\eta) = 0\n$$\n边界条件也进行变换：\n1.  $u(x,0) = 0 \\implies U_\\infty f'(0) = 0 \\implies f'(0) = 0$。\n2.  $v(x,0) = 0 \\implies \\frac{1}{2} \\sqrt{\\frac{\\nu U_\\infty}{x}} (0 \\cdot f'(0) - f(0)) = 0 \\implies f(0) = 0$。\n3.  $u(x, y \\to \\infty) = U_\\infty \\implies U_\\infty f'(\\eta \\to \\infty) = U_\\infty \\implies f'(\\infty) = 1$。\n\n因此，问题被简化为半无限域$[0, \\infty)$上的一个边值问题（BVP）：\n$$\n2 f''' + f f'' = 0, \\quad f(0) = 0, \\quad f'(0) = 0, \\quad f'(\\infty) = 1\n$$\n对于数值解，我们将域截断为$[0, \\eta_{\\max}]$，并在$\\eta_{\\max}$处施加远场条件：\n$$\nf'(\\eta_{\\max}) = 1\n$$\n这个BVP使用打靶法求解。我们通过猜测未知的初始条件$f''(0)$（我们记为$s$），将BVP转换为一个初值问题（IVP）。该IVP为：\n$$\n2 f''' + f f'' = 0, \\quad f(0) = 0, \\quad f'(0) = 0, \\quad f''(0) = s\n$$\n为了进行数值积分，我们定义一个状态向量$\\mathbf{y}(\\eta) = [y_1(\\eta), y_2(\\eta), y_3(\\eta)]^T = [f(\\eta), f'(\\eta), f''(\\eta)]^T$。这个三阶ODE被重写为一个包含三个一阶ODE的系统：\n$$\n\\frac{d\\mathbf{y}}{d\\eta} = \n\\begin{pmatrix}\ny_1' \\\\\ny_2' \\\\\ny_3'\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_2 \\\\\ny_3 \\\\\n- \\frac{1}{2} y_1 y_3\n\\end{pmatrix}\n$$\n初始条件为$\\mathbf{y}(0) = [0, 0, s]^T$。\n我们从$\\eta = 0$到$\\eta = \\eta_{\\max}$积分这个系统。目标是找到$s$的值，使得解满足截断的远场边界条件，即$y_2(\\eta_{\\max}) = f'(\\eta_{\\max}) = 1$。这为函数$R(s) = y_2(\\eta_{\\max}; s) - 1$定义了一个求根问题。由于$f'(\\eta_{\\max})$是$s$的单调递增函数，存在唯一的根，可以使用像Brent方法这样的区间法高效地找到。\n\n问题要求量化截断误差。这是通过将截断域$[0, \\eta_{\\max}]$上的解与在一个大得多的域$[0, \\eta_{\\mathrm{ref}}]$上计算的高保真参考解进行比较来完成的，其中$\\eta_{\\mathrm{ref}} = 30.0$。设$s(\\eta_b)$是在区间$[0, \\eta_b]$上求解打靶问题得到的壁面曲率参数$f''(0)$的值。我们定义参考值为$s_{\\mathrm{ref}} = s(\\eta_{\\mathrm{ref}} = 30.0)$。\n\n对于每个测试用例$(\\eta_{\\max}, \\varepsilon_{\\mathrm{tail}}, \\varepsilon_{\\mathrm{rel}})$，我们首先计算截断域的壁面曲率$s_{\\mathrm{trunc}} = s(\\eta_{\\max})$，以及在截断边界处相应的二阶导数$f''(\\eta_{\\max})$。然后，我们评估两个条件：\n1.  **尾部小量条件：** 截断边界处的无量纲剪切应力的大小必须足够小：$|\\!|f''(\\eta_{\\max})|\\!| \\le \\varepsilon_{\\mathrm{tail}}$。由于对于$\\eta  0$，$f''(\\eta)  0$，此条件为$f''(\\eta_{\\max}) \\le \\varepsilon_{\\mathrm{tail}}$。\n2.  **壁面曲率稳定性条件：** 计算出的壁面曲率与参考值的相对偏差必须在给定容差范围内：$\\frac{|s_{\\mathrm{trunc}} - s_{\\mathrm{ref}}|}{s_{\\mathrm{ref}}} \\le \\varepsilon_{\\mathrm{rel}}$。\n\n一个测试用例当且仅当两个条件都满足时，才被认为是成功的（评估为True）。\n\n算法如下：\n1.  设置一个具有严格绝对和相对容差（例如$10^{-12}$）的高精度ODE求解器，以确保数值积分误差可以忽略不计。\n2.  通过求解$\\eta_{\\mathrm{ref}} = 30.0$的打靶问题，计算参考壁面曲率$s_{\\mathrm{ref}}$。\n3.  对于每个测试用例$(\\eta_{\\max}, \\varepsilon_{\\mathrm{tail}}, \\varepsilon_{\\mathrm{rel}})$：\n    a. 求解$\\eta = \\eta_{\\max}$的打靶问题，找到$s_{\\mathrm{trunc}}$。\n    b. 找到$s_{\\mathrm{trunc}}$后，使用$\\mathbf{y}(0) = [0, 0, s_{\\mathrm{trunc}}]$进行一次从$\\eta=0$到$\\eta=\\eta_{\\max}$的最终积分，以获得在$\\eta_{\\max}$处的完整解状态，其中包括$f''(\\eta_{\\max}) = y_3(\\eta_{\\max})$。\n    c. 评估尾部小量条件和壁面曲率稳定性条件。\n    d. 记录组合检查的布尔结果。\n4.  输出布尔结果的列表。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves the Blasius boundary value problem using a shooting method,\n    and evaluates truncation error criteria for several test cases.\n    \"\"\"\n\n    # Define the first-order ODE system for the Blasius equation:\n    # y = [f, f', f''], so y' = [f', f'', f'''] = [y[1], y[2], -0.5*y[0]*y[2]]\n    def blasius_ode(eta, y):\n        # Disable inspection for y[0], y[1], y[2] as they are components of a state vector.\n        # noinspection PyUnresolvedReferences\n        return [y[1], y[2], -0.5 * y[0] * y[2]]\n\n    # High-precision solver tolerances to minimize numerical integration error\n    rtol, atol = 1e-12, 1e-12\n\n    # Memoization for the shooting solver to avoid re-computation\n    memo_solve = {}\n\n    def solve_shooting(eta_max):\n        \"\"\"\n        Finds the wall-curvature parameter s = f''(0) such that f'(eta_max) = 1.\n        Returns the computed s and the value of f''(eta_max).\n        \"\"\"\n        if eta_max in memo_solve:\n            return memo_solve[eta_max]\n        \n        # Objective function for the root-finder: residual = f'(eta_max) - 1\n        def residual_func(s: float):\n            y0 = [0, 0, s]\n            sol = solve_ivp(\n                blasius_ode,\n                [0, eta_max],\n                y0,\n                method='LSODA',\n                rtol=rtol,\n                atol=atol\n            )\n            # Return the value of y[1] (which is f') at the end of the interval\n            return sol.y[1, -1] - 1.0\n\n        # Find the value of s using Brent's method. The bracket [0.1, 1.0] is\n        # known to contain the root for the Blasius problem.\n        try:\n            s_val = brentq(residual_func, 0.1, 1.0)\n        except ValueError:\n            # Should not happen with this bracket, but as a safeguard.\n            return None, None\n\n        # With the correct s_val, re-integrate to get the final state vector.\n        y0_final = [0, 0, s_val]\n        final_sol = solve_ivp(\n            blasius_ode,\n            [0, eta_max],\n            y0_final,\n            method='LSODA',\n            rtol=rtol,\n            atol=atol\n        )\n\n        # f''(eta_max) is the third component of the solution vector at the final point.\n        f_double_prime_at_max = final_sol.y[2, -1]\n        \n        # Store result in memo\n        memo_solve[eta_max] = (s_val, f_double_prime_at_max)\n        \n        return s_val, f_double_prime_at_max\n    \n    # 1. Compute the high-accuracy reference value s_ref\n    eta_ref = 30.0\n    s_ref, _ = solve_shooting(eta_ref)\n    \n    # Define the test suite\n    test_cases = [\n        (4.0, 1e-3, 1e-3),\n        (6.0, 5e-4, 2e-4),\n        (8.0, 1e-5, 1e-4),\n        (10.0, 1e-6, 1e-5),\n        (12.0, 1e-7, 5e-6),\n    ]\n\n    results = []\n\n    # 2. Iterate through each test case\n    for case in test_cases:\n        eta_max, eps_tail, eps_rel = case\n        \n        # 3a. Compute s_trunc and f''(eta_max) for the current case\n        s_trunc, f_double_prime_max = solve_shooting(eta_max)\n        \n        # 3b. Evaluate the two conditions\n        tail_condition_met = abs(f_double_prime_max) = eps_tail\n        stability_condition_met = (abs(s_trunc - s_ref) / s_ref) = eps_rel\n        \n        # 3c. The result is True only if both conditions are met\n        results.append(tail_condition_met and stability_condition_met)\n\n    # 4. Format and print the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2500305"}]}