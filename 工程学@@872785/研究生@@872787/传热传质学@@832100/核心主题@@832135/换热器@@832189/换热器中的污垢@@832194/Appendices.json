{"hands_on_practices": [{"introduction": "污垢最直接的后果是降低传热效率。本练习提供了一个具体的起点，通过计算形成污垢层后的新总传热系数 $U$ 来量化这一影响。通过这个实践，您将巩固串联热阻的基本概念，这是所有传热分析的基石 [@problem_id:2489434]。", "problem": "一台在稳态下运行的单程换热器，其一侧换热表面上开始积聚均匀的碳酸钙沉积物。假设热流是垂直于表面的一维流动，且接触热阻可忽略不计。该沉积物可被模拟为厚度为 $\\delta = 1\\,\\mathrm{mm}$、导热系数为 $k_{\\mathrm{dep}} = 2\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$ 的均匀平层。在结垢之前，该换热器在相同的流体流动条件下，测得其洁净时的总传热系数为 $U_{0} = 2000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。假定 $U_{0}$ 中包含的现有对流热阻和壁面热阻，除了沉积物增加的热阻之外，不因结垢而改变。\n\n从总传热系数根据单位面积等效热阻的定义以及热阻的串联叠加出发，确定存在沉积物时新的总传热系数 $U$（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$）。将最终数值答案四舍五入至四位有效数字。最终答案只提供 $U$ 的值。", "solution": "问题陈述需经验证。\n\n**步骤1：提取已知条件**\n- 操作：单程换热器，稳态运行。\n- 结垢：一侧换热表面有均匀的碳酸钙沉积物。\n- 热流：一维，垂直于表面。\n- 热阻：接触热阻可忽略不计。\n- 沉积物模型：均匀平层。\n- 沉积物厚度：$\\delta = 1\\,\\mathrm{mm}$。\n- 沉积物导热系数：$k_{\\mathrm{dep}} = 2\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$。\n- 洁净时总传热系数：$U_{0} = 2000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- 条件：洁净和结垢状态下的流体流动条件相同。\n- 假设：现有的对流热阻和壁面热阻不因结垢而改变。\n- 目标：确定新的总传热系数 $U$，并将结果四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法明确且客观。它描述了换热器结垢的经典情景，这是传热传质学中的一个基本课题。其支配原则，即热阻的串联叠加，是一种正确且标准的方法。所有必要的数据均已提供，并且这些数值对于碳酸钙水垢来说在物理上是现实的。该问题自成体系、前后一致，并遵循既定的工程原理。\n\n**步骤3：结论与行动**\n该问题被视为有效。将提供解答。\n\n控制稳态传热通过复合系统的基本原理是电阻类比法。总传热系数 $U$ 定义为单位面积总热阻 $R_{\\text{tot}}$ 的倒数。\n$$U = \\frac{1}{R_{\\text{tot}}}$$\n对于洁净、未结垢的换热器，总传热系数为 $U_{0} = 2000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。相应的单位面积初始总热阻 $R_{\\text{tot},0}$ 为：\n$$R_{\\text{tot},0} = \\frac{1}{U_{0}}$$\n该热阻 $R_{\\text{tot},0}$ 代表了洁净换热器固有的对流热阻和传导热阻之和。\n\n当形成一层沉积物时，它会引入一个与现有热阻串联的附加热阻。这就是污垢热阻 $R_{f}$。新的单位面积总热阻 $R_{\\text{tot},f}$ 是初始热阻与污垢热阻之和：\n$$R_{\\text{tot},f} = R_{\\text{tot},0} + R_{f}$$\n对于平层材料，污垢热阻 $R_{f}$ 的计算方法是层厚 $\\delta$ 除以材料的导热系数 $k_{\\text{dep}}$。\n$$R_{f} = \\frac{\\delta}{k_{\\text{dep}}}$$\n新的（或结垢后的）总传热系数 $U$ 是这个新总热阻 $R_{\\text{tot},f}$ 的倒数。\n$$U = \\frac{1}{R_{\\text{tot},f}} = \\frac{1}{\\frac{1}{U_{0}} + \\frac{\\delta}{k_{\\text{dep}}}}$$\n现在，我们将所给数值代入方程。首先，确保所有单位均为国际单位制（SI）基本单位。沉积物厚度为 $\\delta = 1\\,\\mathrm{mm}$，必须转换为米：$\\delta = 1 \\times 10^{-3}\\,\\mathrm{m}$。\n\n其他给定值为：\n- $U_{0} = 2000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n- $k_{\\text{dep}} = 2\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$\n\n首先，计算单位面积的初始热阻：\n$$R_{\\text{tot},0} = \\frac{1}{2000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}} = 0.0005\\,\\mathrm{m^2\\,K\\,W^{-1}}$$\n接下来，计算单位面积的污垢热阻：\n$$R_{f} = \\frac{1 \\times 10^{-3}\\,\\mathrm{m}}{2\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}} = 0.0005\\,\\mathrm{m^2\\,K\\,W^{-1}}$$\n新的总热阻是这两个热阻之和：\n$$R_{\\text{tot},f} = R_{\\text{tot},0} + R_{f} = 0.0005\\,\\mathrm{m^2\\,K\\,W^{-1}} + 0.0005\\,\\mathrm{m^2\\,K\\,W^{-1}} = 0.001\\,\\mathrm{m^2\\,K\\,W^{-1}}$$\n最后，新的总传热系数 $U$ 是新总热阻的倒数：\n$$U = \\frac{1}{R_{\\text{tot},f}} = \\frac{1}{0.001\\,\\mathrm{m^2\\,K\\,W^{-1}}} = 1000\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$$\n题目要求答案四舍五入至四位有效数字。计算值恰好为 $1000$。为了明确地表示为四位有效数字，写作 $1000$。", "answer": "$$\\boxed{1000}$$", "id": "2489434"}, {"introduction": "污垢并非瞬时发生，而是一个动态过程。本练习将超越静态视角，通过引入一个平衡沉积和移除速率的广泛应用的动力学模型，来探索污垢热阻如何随时间演变。通过推导其时间依赖行为和渐近污垢的概念，您将对换热器的长期性能退化获得更深刻的理解 [@problem_id:2489349]。", "problem": "一台单程管壳式换热器在稳定的整体工况下运行，管程侧流体为颗粒污垢流体。单位面积的热污垢阻力表示为 $R_{f}(t)$，机械清洗后的初始条件为 $R_{f}(0)=0$。在固定的操作条件下，假设 $R_{f}(t)$ 的净变化率由一个恒速沉积项和一个一阶剪切移除项之间的竞争决定，因此 $R_{f}(t)$ 的演化过程由以下线性动力学平衡描述\n$$\n\\frac{dR_{f}}{dt}=k_{d}-k_{r}\\,R_{f},\n$$\n其中 $k_{d}>0$ 的单位是单位时间内的污垢阻力增长，而 $k_{r}>0$ 的单位是时间的倒数，并参数化了剪切驱动的移除过程。定义渐近污垢阻力 $R_{f,\\infty}$ 为 $R_{f}(t)$ 的长时间极限，并定义 $\\beta\\equiv k_{r}$。从此动力学平衡和初始条件出发，推导出 $R_{f}(t)$，然后确定 $R_{f}(t)$ 首次达到 $0.9\\,R_{f,\\infty}$ 的时间 $t_{0.9}$。请仅用 $\\beta$ 表示你最终的 $t_{0.9}$。请以秒为单位表示你的答案。\n\n最后，基于壁面处剪切驱动剥离的输运原理，定性讨论增加壁面剪切（在所有其他条件固定的情况下）将如何影响 $\\beta$ 和最终的 $t_{0.9}$，并解释原因。", "solution": "首先将对问题陈述进行严格验证，以确定其科学性和逻辑完整性。\n\n步骤1：提取已知条件。\n- 污垢阻力 $R_{f}(t)$ 的控制微分方程：$\\frac{dR_{f}}{dt}=k_{d}-k_{r}\\,R_{f}$。\n- 初始条件：$R_{f}(0)=0$。\n- 沉积速率常数：$k_{d}>0$。\n- 移除速率常数：$k_{r}>0$。\n- 渐近污垢阻力的定义：$R_{f,\\infty} \\equiv \\lim_{t \\to \\infty} R_{f}(t)$。\n- 参数 $\\beta$ 的定义：$\\beta \\equiv k_{r}$。\n- 目标时间：$t_{0.9}$ 是满足 $R_{f}(t_{0.9}) = 0.9\\,R_{f,\\infty}$ 的时间。\n- 要求输出：仅用 $\\beta$ 表示 $t_{0.9}$ 的表达式，以及关于壁面剪切效应的定性讨论。\n\n步骤2：使用提取的已知条件进行验证。\n- **科学依据**：所给出的模型 $\\frac{dR_{f}}{dt} = k_{d}-k_{r}\\,R_{f}$ 是一个简化的但标准且被广泛接受的污垢过程动力学模型，其中沉积和移除机制相互竞争。它通常被称为 Kern-Seaton 模型。它是研究换热器污垢的一个基本概念，作为一阶近似是科学合理的。\n- **适定性**：该问题是一个一阶常系数线性常微分方程的初值问题。给定初始条件 $R_{f}(0)=0$，该问题是适定的，并且存在唯一、稳定的解。\n- **客观性**：问题陈述使用了精确、客观和正式的科学语言。没有主观或模糊的陈述。\n- **结论**：该问题具有科学依据、适定且客观。它不包含不一致性、信息缺失或逻辑缺陷。该问题被判定为有效。\n\n步骤3：判定与行动。\n问题有效。将推导解答。\n\n污垢阻力 $R_f(t)$ 的演化由以下一阶线性常微分方程描述：\n$$\n\\frac{dR_{f}}{dt} = k_{d} - k_{r}R_{f}\n$$\n初始条件为 $R_{f}(0)=0$。这是一个可分离变量的方程。我们重排各项以分离变量 $R_f$ 和 $t$：\n$$\n\\frac{dR_{f}}{k_{d} - k_{r}R_{f}} = dt\n$$\n我们对两边进行积分。左侧的积分区间为从 $R_{f}(0)=0$ 到 $R_{f}(t)$，右侧的积分区间为从时间 $0$ 到 $t$：\n$$\n\\int_{0}^{R_{f}(t)} \\frac{dR'_{f}}{k_{d} - k_{r}R'_{f}} = \\int_{0}^{t} dt'\n$$\n右侧的积分就是 $t$。左侧的积分计算如下：\n$$\n\\left[ -\\frac{1}{k_{r}}\\ln|k_{d} - k_{r}R'_{f}| \\right]_{0}^{R_{f}(t)} = t\n$$\n由于 $R_f(t)$ 从 $0$ 开始并向其渐近值增加，项 $k_d - k_r R_f$ 将保持为正，因此可以去掉绝对值符号。应用积分限：\n$$\n-\\frac{1}{k_{r}} \\left( \\ln(k_{d} - k_{r}R_{f}(t)) - \\ln(k_{d}) \\right) = t\n$$\n利用对数的性质，我们合并这些项：\n$$\n-\\frac{1}{k_{r}} \\ln\\left(\\frac{k_{d} - k_{r}R_{f}(t)}{k_{d}}\\right) = t\n$$\n两边乘以 $-k_{r}$ 并取指数，得到：\n$$\n\\frac{k_{d} - k_{r}R_{f}(t)}{k_{d}} = \\exp(-k_{r} t)\n$$\n$$\n1 - \\frac{k_{r}}{k_{d}}R_{f}(t) = \\exp(-k_{r} t)\n$$\n解出 $R_{f}(t)$：\n$$\nR_{f}(t) = \\frac{k_{d}}{k_{r}}\\left(1 - \\exp(-k_{r} t)\\right)\n$$\n这就是污垢阻力作为时间函数的表达式。\n\n接下来，我们通过取 $t \\to \\infty$ 的极限来确定渐近污垢阻力 $R_{f,\\infty}$：\n$$\nR_{f,\\infty} = \\lim_{t \\to \\infty} R_{f}(t) = \\lim_{t \\to \\infty} \\left[\\frac{k_{d}}{k_{r}}\\left(1 - \\exp(-k_{r} t)\\right)\\right]\n$$\n由于 $k_{r} > 0$，当 $t \\to \\infty$ 时，项 $\\exp(-k_{r} t)$ 趋近于 $0$。因此：\n$$\nR_{f,\\infty} = \\frac{k_{d}}{k_{r}}\n$$\n这个结果也可以通过在原始微分方程中将变化率设为零来得到，这对应于稳态或渐近条件：$0 = k_{d} - k_{r}R_{f,\\infty}$，从而得出 $R_{f,\\infty} = k_{d}/k_{r}$。\n\n现在，我们必须找到时间 $t_{0.9}$，使得 $R_{f}(t)$ 达到其渐近值的 $90\\%$，即 $R_{f}(t_{0.9}) = 0.9 R_{f,\\infty}$。\n代入 $R_{f}(t)$ 和 $R_{f,\\infty}$ 的表达式：\n$$\n\\frac{k_{d}}{k_{r}}\\left(1 - \\exp(-k_{r} t_{0.9})\\right) = 0.9 \\left(\\frac{k_{d}}{k_{r}}\\right)\n$$\n非零项 $k_{d}/k_{r}$ 从两边消去：\n$$\n1 - \\exp(-k_{r} t_{0.9}) = 0.9\n$$\n重排各项以求解指数项：\n$$\n\\exp(-k_{r} t_{0.9}) = 1 - 0.9 = 0.1\n$$\n对两边取自然对数：\n$$\n-k_{r} t_{0.9} = \\ln(0.1) = \\ln(10^{-1}) = -\\ln(10)\n$$\n解出 $t_{0.9}$：\n$$\nt_{0.9} = \\frac{\\ln(10)}{k_{r}}\n$$\n最后，我们将定义 $\\beta \\equiv k_{r}$ 代入此表达式：\n$$\nt_{0.9} = \\frac{\\ln(10)}{\\beta}\n$$\n$\\beta$ 的单位是时间的倒数，所以 $t_{0.9}$ 的单位是时间。如果 $\\beta$ 的单位是 $s^{-1}$，那么 $t_{0.9}$ 的单位就是秒，正如所要求的。\n\n对于定性讨论部分：\n参数 $\\beta$ (等同于 $k_r$) 代表了剪切驱动下污垢物从传热表面移除的速率常数。这个移除过程是流体流动对沉积层施加的流体动力学的直接结果。导致这种剥离的主要力是壁面处的流体剪切应力 $\\tau_{w}$。\n1.  **对 $\\beta$ 的影响**：主体流体速度或湍流强度的增加会导致更高的壁面剪切应力 $\\tau_{w}$。更大的剪切应力对污垢沉积物施加更大的切向力，增加了它们剥离并重新夹带到流体中的概率和速率。因此，增加壁面剪切会增强移除机制。在模型的背景下，这对应于移除速率常数 $k_r$ 值的增加。由于 $\\beta \\equiv k_r$，增加壁面剪切直接导致 $\\beta$ 的增加。\n2.  **对 $t_{0.9}$ 的影响**：达到渐近污垢阻力 $90\\%$ 的时间由 $t_{0.9} = \\frac{\\ln(10)}{\\beta}$ 给出。由于 $\\beta$ 出现在此表达式的分母中，$\\beta$ 的增加将导致 $t_{0.9}$ 的减小。\n3.  **解释**：更高的壁面剪切不仅导致最终污垢积累量减少（因为 $R_{f,\\infty} = k_d/\\beta$ 减小），而且还加速了达到这个新的、更低的平衡状态的过程。当移除过程更剧烈时，系统会更快地达到沉积和移除之间的动态平衡。因此，达到渐近污垢水平的任何给定比例（例如 $t_{0.9}$）所需的时间会减少。", "answer": "$$\n\\boxed{\\frac{\\ln(10)}{\\beta}}\n$$", "id": "2489349"}, {"introduction": "理论模型的优劣取决于其参数，而这些参数必须从真实数据中确定。最后的这项实践将理论与应用联系起来，要求您开发一个计算程序，从带噪声的测量数据中估计污垢动力学模型的关键参数。本练习介绍了参数估计和可辨识性的实际挑战，这些是现代工程分析和设备监控的基本技能 [@problem_id:2489406]。", "problem": "考虑一个单程换热器，其中一侧的污垢会增加一个随时间变化的热阻。令单位面积的污垢热阻表示为 $R_f(t)$，并假设它遵循由以下一阶常微分方程控制的线性沉积-去除动力学：\n$$\n\\frac{dR_f}{dt} = \\alpha - \\beta R_f,\\quad R_f(0) = 0,\n$$\n其中 $\\alpha \\ge 0$ 的单位是 $\\mathrm{(m^2\\,K/W)/s}$，$\\beta \\ge 0$ 的单位是 $\\mathrm{s^{-1}}$。单位面积的总传热系数 $U(t)$ 通过以下公式与单位面积的总热阻 $R_{\\text{tot}}(t)$ 相关：\n$$\nU(t) = \\frac{1}{R_{\\text{tot}}(t)},\\quad R_{\\text{tot}}(t) = R_0 + R_f(t),\n$$\n其中 $R_0$ 是单位面积所有非污垢热阻（例如，清洁侧的对流膜和壁面热阻）的不随时间变化的总和，单位为 $\\mathrm{m^2\\,K/W}$。除非另有说明，我们假设 $R_0$ 是已知的。\n\n给定在此模型指定时间生成的、带有零均值高斯噪声的合成噪声测量值。您的任务是从传热和参数估计的第一性原理出发，构建一个最小二乘估计器，以从 $R_f(t)$ 数据或 $U(t)$ 数据中恢复 $\\alpha$ 和 $\\beta$。此外，当 $U(t)$ 还依赖于一个未知的 $R_0$（等效于 $R_0$ 中包含的未知对流系数 $h$）时，您必须评估 $\\alpha$ 和 $\\beta$ 的可辨识性。\n\n所有计算和答案都必须使用国际单位制（SI）。时间必须以秒为单位，单位面积热阻的单位为平方米开尔文每瓦，传热系数的单位为瓦特每平方米开尔文。所有 $\\alpha$ 和 $\\beta$ 的参数估计值必须使用科学记数法报告，小数点后保留 $6$ 位数字（例如，$1.000000\\mathrm{e}{-07}$），布尔类型的可辨识性结论必须报告为 Python 布尔值 $True$ 或 $False$。不使用角度。任何分数都必须表示为小数。\n\n允许的基本依据：\n- 导致 $U(t) = 1/R_{\\text{tot}}(t)$ 的热阻串联叠加。\n- 针对独立同分布高斯测量噪声的最小二乘法定义。\n- 线性、时不变一阶常微分方程解的基本性质。\n\n您的程序必须实现以下测试套件。对于每种情况，您必须使用固定的伪随机种子 $42$ 在内部合成噪声测量值，以确保可复现性。\n\n- 情况 A（直接污垢热阻测量）：\n  - 真实参数：$\\alpha_A = 1.0\\times 10^{-7}\\ \\mathrm{(m^2\\,K/W)/s}$，$\\beta_A = 1.0\\times 10^{-5}\\ \\mathrm{s^{-1}}$。\n  - 基准热阻：$R_{0,A} = 2.0\\times 10^{-3}\\ \\mathrm{m^2\\,K/W}$。\n  - 测量时间：$t_i$ 在 $0$ 到 $6.0\\times 10^{5}\\ \\mathrm{s}$ 之间均匀分布，共 $50$ 个点。\n  - 测量数据：$R_{f,\\text{meas}}(t_i) = R_f(t_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma_A^2)$，$\\sigma_A = 5.0\\times 10^{-5}\\ \\mathrm{m^2\\,K/W}$。\n  - 任务：通过最小化由已知标准差归一化的无权残差平方和来估计 $\\alpha$ 和 $\\beta$，即最小化 $\\sum_i \\left(\\frac{R_f(t_i;\\alpha,\\beta) - R_{f,\\text{meas}}(t_i)}{\\sigma_A}\\right)^2$，约束条件为 $\\alpha \\ge 0$，$\\beta \\ge 0$。\n\n- 情况 B（已知基准热阻下的间接总系数测量）：\n  - 真实参数：$\\alpha_B = 8.0\\times 10^{-8}\\ \\mathrm{(m^2\\,K/W)/s}$，$\\beta_B = 5.0\\times 10^{-6}\\ \\mathrm{s^{-1}}$。\n  - 基准热阻：$R_{0,B} = 1.5\\times 10^{-3}\\ \\mathrm{m^2\\,K/W}$。\n  - 测量时间：$t_i$ 在 $0$ 到 $4.0\\times 10^{5}\\ \\mathrm{s}$ 之间均匀分布，共 $40$ 个点。\n  - 测量数据：$U_{\\text{meas}}(t_i) = U(t_i) + \\eta_i$，其中 $\\eta_i \\sim \\mathcal{N}(0,\\sigma_B^2)$，$\\sigma_B = 2.0\\ \\mathrm{W/(m^2\\,K)}$。\n  - 任务：通过最小化 $\\sum_i \\left(\\frac{U(t_i;\\alpha,\\beta) - U_{\\text{meas}}(t_i)}{\\sigma_B}\\right)^2$ 来估计 $\\alpha$ 和 $\\beta$，约束条件为 $\\alpha \\ge 0$，$\\beta \\ge 0$。\n\n- 情况 C（未知基准热阻下的间接总系数测量）：\n  - 真实参数：$\\alpha_C = 2.0\\times 10^{-8}\\ \\mathrm{(m^2\\,K/W)/s}$，$\\beta_C = 1.0\\times 10^{-7}\\ \\mathrm{s^{-1}}$，以及 $R_{0,C} = 3.0\\times 10^{-3}\\ \\mathrm{m^2\\,K/W}$。\n  - 测量时间：$t_i$ 在 $0$ 到 $2.0\\times 10^{5}\\ \\mathrm{s}$ 之间均匀分布，共 $40$ 个点。\n  - 测量数据：$U_{\\text{meas}}(t_i) = U(t_i) + \\zeta_i$，其中 $\\zeta_i \\sim \\mathcal{N}(0,\\sigma_C^2)$，$\\sigma_C = 1.0\\ \\mathrm{W/(m^2\\,K)}$。\n  - 任务：通过最小化 $\\sum_i \\left(\\frac{U(t_i;\\theta) - U_{\\text{meas}}(t_i)}{\\sigma_C}\\right)^2$ 来拟合参数矢量 $\\theta = [\\alpha,\\beta,R_0]^\\top$，约束条件为 $\\alpha \\ge 0$，$\\beta \\ge 0$， $R_0 \\ge 0$。然后通过计算费雪信息矩阵（FIM）近似 $\\mathcal{I}(\\hat{\\theta}) = J(\\hat{\\theta})^\\top J(\\hat{\\theta})$ 来评估 $\\alpha$ 和 $\\beta$ 的实际可辨识性，其中 $J(\\hat{\\theta})$ 是在最小二乘解 $\\hat{\\theta}$ 处评估的残差矢量关于参数的雅可比矩阵。如果 $J(\\hat{\\theta})$ 的 $2$-范数条件数严格小于 $10^{10}$，则报告一个布尔可辨识性标志为 $True$，否则为 $False$。\n\n实现细节和要求：\n- 使用定义 $R_f(t)$ 的常微分方程的闭式解或数值稳定的等效表达式。\n- 对于每种情况，使用种子为 $42$ 的确定性伪随机数生成器在内部合成噪声测量值。\n- 最终输出必须是单行，包含一个 Python 风格的列表，按顺序包含以下条目：\n  - 情况 A 的 $\\alpha$ 估计值（科学记数法，小数点后保留 $6$ 位数字），\n  - 情况 A 的 $\\beta$ 估计值（科学记数法，小数点后保留 $6$ 位数字），\n  - 情况 B 的 $\\alpha$ 估计值（科学记数法，小数点后保留 $6$ 位数字），\n  - 情况 B 的 $\\beta$ 估计值（科学记数法，小数点后保留 $6$ 位数字），\n  - 情况 C 的可辨识性标志（一个布尔值）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[1.000000e-07,1.000000e-05,8.000000e-08,5.000000e-06,False]\"）。", "solution": "所提出的问题是换热器污垢简化但基础的模型的一个标准参数估计练习。该问题被验证为具有科学依据、适定且客观。它基于传热传质和统计估计理论的既定原理。所有给定条件都是明确、一致且足以推导出唯一解的。因此，我们着手进行推导和计算实现。\n\n问题的核心在于污垢热阻模型，它由一个常系数一阶线性常微分方程描述：\n$$\n\\frac{dR_f}{dt} = \\alpha - \\beta R_f\n$$\n初始条件为 $R_f(0) = 0$。这里，$t$ 是时间，$R_f$ 是单位面积的污垢热阻，$\\alpha$ 是沉积速率常数，$\\beta$ 是去除速率常数。\n\n首先，我们必须求得 $R_f(t)$ 的解析解。该方程可以重排为 $\\frac{dR_f}{dt} + \\beta R_f = \\alpha$。这是一个标准形式，可以使用积分因子 $\\mu(t) = e^{\\int \\beta dt} = e^{\\beta t}$ 求解。方程两边同乘以 $\\mu(t)$ 得：\n$$\ne^{\\beta t} \\frac{dR_f}{dt} + \\beta e^{\\beta t} R_f = \\alpha e^{\\beta t}\n$$\n左边是乘积的导数 $\\frac{d}{dt}(R_f(t) e^{\\beta t})$。对两边关于时间积分得到：\n$$\nR_f(t) e^{\\beta t} = \\int \\alpha e^{\\beta t} dt = \\frac{\\alpha}{\\beta} e^{\\beta t} + C\n$$\n其中 $C$ 是积分常数。除以 $e^{\\beta t}$ 得到通解：\n$$\nR_f(t) = \\frac{\\alpha}{\\beta} + C e^{-\\beta t}\n$$\n应用初始条件 $R_f(0) = 0$：\n$$\n0 = \\frac{\\alpha}{\\beta} + C e^0 \\implies C = -\\frac{\\alpha}{\\beta}\n$$\n将 $C$ 代回，我们得到污垢热阻的特解，在 $\\beta > 0$ 时有效：\n$$\nR_f(t; \\alpha, \\beta) = \\frac{\\alpha}{\\beta} (1 - e^{-\\beta t})\n$$\n在 $\\beta = 0$ 的特殊情况下，微分方程简化为 $\\frac{dR_f}{dt} = \\alpha$，考虑到 $R_f(0)=0$，直接积分为 $R_f(t) = \\alpha t$。出于计算目的，为避免当 $\\beta t$ 非常小时出现数值不稳定性，表达式 $1 - e^{-x}$ 应使用诸如 `expm1(-x)` 之类的库函数计算，该函数能为小的 $x$ 精确计算 $e^x - 1$。因此，我们使用 $R_f(t) = \\frac{\\alpha}{\\beta} (-\\text{expm1}(-\\beta t))$。\n\n总传热系数 $U(t)$ 由串联热阻之和的倒数给出：\n$$\nU(t) = \\frac{1}{R_{\\text{tot}}(t)} = \\frac{1}{R_0 + R_f(t)}\n$$\n其中 $R_0$ 是恒定的基准热阻。\n\n参数估计将使用最小二乘法进行。对于在时间 $t_i$ 采集的一组测量值 $y_{\\text{meas},i}$，以及模型预测值 $y_{\\text{model}}(t_i; \\theta)$，目标是找到使残差平方和最小化的参数矢量 $\\theta$。鉴于测量噪声是具有已知标准差 $\\sigma$ 的高斯噪声，统计上正确的目标函数是最小化卡方统计量：\n$$\n\\chi^2(\\theta) = \\sum_i \\left( \\frac{y_{\\text{model}}(t_i; \\theta) - y_{\\text{meas},i}}{\\sigma} \\right)^2\n$$\n最小化将在参数的物理约束（$\\alpha \\ge 0$，$\\beta \\ge 0$， $R_0 \\ge 0$）下进行数值求解。\n\n情况 A：从 $R_f$ 数据直接估计。\n参数矢量为 $\\theta = [\\alpha, \\beta]^\\top$。模型为 $y_{\\text{model}}(t_i; \\alpha, \\beta) = R_f(t_i; \\alpha, \\beta)$。目标函数是：\n$$\nS_A(\\alpha, \\beta) = \\sum_i \\left( \\frac{\\frac{\\alpha}{\\beta}(1 - e^{-\\beta t_i}) - R_{f,\\text{meas}}(t_i)}{\\sigma_A} \\right)^2\n$$\n我们将使用真实参数和带种子的伪随机数生成器生成噪声数据 $R_{f,\\text{meas}}(t_i)$，然后找到最小化 $S_A$ 的 $\\alpha$ 和 $\\beta$ 值。\n\n情况 B：在 $R_0$ 已知的情况下，从 $U(t)$ 数据间接估计。\n参数矢量同样是 $\\theta = [\\alpha, \\beta]^\\top$。模型为 $y_{\\text{model}}(t_i; \\alpha, \\beta) = U(t_i; \\alpha, \\beta) = \\frac{1}{R_{0,B} + R_f(t_i; \\alpha, \\beta)}$。目标函数是：\n$$\nS_B(\\alpha, \\beta) = \\sum_i \\left( \\frac{\\left(R_{0,B} + \\frac{\\alpha}{\\beta}(1 - e^{-\\beta t_i})\\right)^{-1} - U_{\\text{meas}}(t_i)}{\\sigma_B} \\right)^2\n$$\n估计过程与情况 A 类似。\n\n情况 C：在 $R_0$ 未知的情况下，从 $U(t)$ 数据间接估计及可辨识性分析。\n参数矢量现在扩展为 $\\theta = [\\alpha, \\beta, R_0]^\\top$。模型为 $y_{\\text{model}}(t_i; \\alpha, \\beta, R_0) = U(t_i) = \\frac{1}{R_0 + R_f(t_i; \\alpha, \\beta)}$。目标函数是：\n$$\nS_C(\\alpha, \\beta, R_0) = \\sum_i \\left( \\frac{\\left(R_0 + \\frac{\\alpha}{\\beta}(1 - e^{-\\beta t_i})\\right)^{-1} - U_{\\text{meas}}(t_i)}{\\sigma_C} \\right)^2\n$$\n在找到最小二乘估计 $\\hat{\\theta} = [\\hat{\\alpha}, \\hat{\\beta}, \\hat{R_0}]^\\top$ 后，我们评估实际参数可辨识性。这通过检查模型输出对参数变化的敏感度来评估，该敏感度由残差矢量的雅可比矩阵 $J(\\theta)$ 量化。该矩阵的分量是 $J_{ij} = \\frac{\\partial r_i}{\\partial \\theta_j}$，其中 $r_i$ 是第 $i$ 个归一化残差。\n$$\nr_i(\\theta) = \\frac{U(t_i; \\theta) - U_{\\text{meas}}(t_i)}{\\sigma_C} \\implies J_{ij} = \\frac{1}{\\sigma_C} \\frac{\\partial U(t_i; \\theta)}{\\partial \\theta_j}\n$$\n需要 $U$ 对参数的偏导数：\n$$\n\\frac{\\partial U}{\\partial \\alpha} = -\\frac{1}{(R_0 + R_f)^2} \\frac{\\partial R_f}{\\partial \\alpha} = -\\frac{1}{(R_0 + R_f)^2} \\left[ \\frac{1}{\\beta}(1 - e^{-\\beta t}) \\right]\n$$\n$$\n\\frac{\\partial U}{\\partial \\beta} = -\\frac{1}{(R_0 + R_f)^2} \\frac{\\partial R_f}{\\partial \\beta} = -\\frac{1}{(R_0 + R_f)^2} \\left[ -\\frac{\\alpha}{\\beta^2}(1 - e^{-\\beta t}) + \\frac{\\alpha t}{\\beta}e^{-\\beta t} \\right]\n$$\n$$\n\\frac{\\partial U}{\\partial R_0} = -\\frac{1}{(R_0 + R_f)^2}\n$$\n雅可比矩阵 $J(\\hat{\\theta})$ 的大条件数表明其列向量近似线性相关，这意味着改变不同参数对模型输出的影响高度相关。这使得从数据中唯一确定参数值变得困难，这种情况被称为实际不可辨識性。我们将计算 $J(\\hat{\\theta})$ 的 $2$-范数条件数，并将其与指定的阈值 $10^{10}$ 进行比较。对于情况 C，测量时间跨度 $t \\in [0, 2.0\\times 10^5\\ \\mathrm{s}]$ 与污垢时间常数 $1/\\beta_C = 10^7\\ \\mathrm{s}$ 相比很短。在这种情况下（$\\beta t \\ll 1$），污垢模型 $R_f(t) \\approx \\alpha t$。总模型变为 $U(t) \\approx (R_0 + \\alpha t)^{-1}$，其中 $\\beta$ 的影响极小。因此，预计 $\\beta$ 将很难辨识，从而导致一个大的条件数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the heat exchanger fouling parameter estimation problem.\n    \"\"\"\n\n    # --- Model Functions ---\n\n    def R_f_model(t, alpha, beta):\n        \"\"\"\n        Computes fouling resistance R_f(t) using a numerically stable form.\n        R_f(t) = (alpha/beta) * (1 - exp(-beta*t))\n        \"\"\"\n        # Handle the case beta -> 0, where R_f(t) -> alpha*t\n        if np.abs(beta)  1e-12:\n            return alpha * t\n        \n        # Use expm1 for numerical stability for small beta*t\n        # 1 - exp(-x) = -expm1(-x)\n        return (alpha / beta) * (-np.expm1(-beta * t))\n\n    def U_model(t, R0, alpha, beta):\n        \"\"\"\n        Computes overall heat transfer coefficient U(t).\n        U(t) = 1 / (R0 + R_f(t))\n        \"\"\"\n        rf = R_f_model(t, alpha, beta)\n        # Add a small epsilon to prevent division by zero, though unlikely with R0 > 0\n        return 1.0 / (R0 + rf + 1e-15)\n\n    # --- Random Data Generation ---\n    rng = np.random.default_rng(42)\n\n    # --- Case A ---\n    def solve_case_a():\n        alpha_true = 1.0e-7\n        beta_true = 1.0e-5\n        # R0_A is not used in the fitting for Case A, only in problem context.\n        # R0_A = 2.0e-3\n        t_max = 6.0e5\n        n_points = 50\n        sigma_A = 5.0e-5\n\n        t_A = np.linspace(0, t_max, n_points)\n        R_f_true = R_f_model(t_A, alpha_true, beta_true)\n        noise = rng.normal(0, sigma_A, n_points)\n        R_f_meas = R_f_true + noise\n\n        def objective_A(p):\n            alpha, beta = p\n            R_f_pred = R_f_model(t_A, alpha, beta)\n            residuals = (R_f_pred - R_f_meas) / sigma_A\n            return np.sum(residuals**2)\n\n        initial_guess = [alpha_true, beta_true]\n        bounds = [(0, None), (0, None)]\n        result = minimize(objective_A, initial_guess, method='L-BFGS-B', bounds=bounds)\n        alpha_est, beta_est = result.x\n        return alpha_est, beta_est\n\n    # --- Case B ---\n    def solve_case_b():\n        alpha_true = 8.0e-8\n        beta_true = 5.0e-6\n        R0_B = 1.5e-3\n        t_max = 4.0e5\n        n_points = 40\n        sigma_B = 2.0\n\n        t_B = np.linspace(0, t_max, n_points)\n        U_true = U_model(t_B, R0_B, alpha_true, beta_true)\n        noise = rng.normal(0, sigma_B, n_points)\n        U_meas = U_true + noise\n\n        def objective_B(p):\n            alpha, beta = p\n            U_pred = U_model(t_B, R0_B, alpha, beta)\n            residuals = (U_pred - U_meas) / sigma_B\n            return np.sum(residuals**2)\n\n        initial_guess = [alpha_true, beta_true]\n        bounds = [(0, None), (0, None)]\n        result = minimize(objective_B, initial_guess, method='L-BFGS-B', bounds=bounds)\n        alpha_est, beta_est = result.x\n        return alpha_est, beta_est\n\n    # --- Case C ---\n    def solve_case_c():\n        alpha_true = 2.0e-8\n        beta_true = 1.0e-7\n        R0_true = 3.0e-3\n        t_max = 2.0e5\n        n_points = 40\n        sigma_C = 1.0\n\n        t_C = np.linspace(0, t_max, n_points)\n        U_true = U_model(t_C, R0_true, alpha_true, beta_true)\n        noise = rng.normal(0, sigma_C, n_points)\n        U_meas = U_true + noise\n\n        def objective_C(p):\n            alpha, beta, R0 = p\n            U_pred = U_model(t_C, R0, alpha, beta)\n            residuals = (U_pred - U_meas) / sigma_C\n            return np.sum(residuals**2)\n        \n        # Jacobian calculation helpers for numerical stability\n        def dRf_dalpha(t, alpha, beta):\n            if np.abs(beta)  1e-12:\n                return t\n            return (-np.expm1(-beta * t)) / beta\n\n        def dRf_dbeta(t, alpha, beta):\n            if np.abs(beta)  1e-12:\n                return -alpha * t**2 / 2.0\n            term1 = -alpha / beta**2 * (-np.expm1(-beta * t))\n            term2 = (alpha * t / beta) * np.exp(-beta * t)\n            return term1 + term2\n\n        initial_guess = [alpha_true, beta_true, R0_true]\n        bounds = [(0, None), (0, None), (0, None)]\n        result = minimize(objective_C, initial_guess, method='L-BFGS-B', bounds=bounds)\n        alpha_est, beta_est, R0_est = result.x\n\n        # Calculate Jacobian of the residual vector at the estimated parameters\n        Rf_est = R_f_model(t_C, alpha_est, beta_est)\n        U_sq_inv = -1.0 / (R0_est + Rf_est)**2\n\n        J_col1 = U_sq_inv * dRf_dalpha(t_C, alpha_est, beta_est) / sigma_C\n        J_col2 = U_sq_inv * dRf_dbeta(t_C, alpha_est, beta_est) / sigma_C\n        J_col3 = U_sq_inv / sigma_C\n        \n        J = np.vstack([J_col1, J_col2, J_col3]).T\n        \n        # Calculate condition number\n        cond_num = np.linalg.cond(J)\n        \n        is_identifiable = cond_num  1.0e10\n        \n        return is_identifiable\n\n    # --- Execute and collect results ---\n    \n    alpha_A_est, beta_A_est = solve_case_a()\n    alpha_B_est, beta_B_est = solve_case_b()\n    identifiable_C = solve_case_c()\n\n    results = [\n        f\"{alpha_A_est:.6e}\",\n        f\"{beta_A_est:.6e}\",\n        f\"{alpha_B_est:.6e}\",\n        f\"{beta_B_est:.6e}\",\n        identifiable_C\n    ]\n    \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2489406"}]}