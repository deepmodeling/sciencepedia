{"hands_on_practices": [{"introduction": "Boussinesq 近似是自然对流建模的基石，它通过在控制方程中仅在浮力项中考虑密度变化，而在其他地方将密度视为常数，从而简化了分析。本练习 [@problem_id:2510673] 提供了一个关键的动手实践机会来检验这一假设的有效性。通过计算无量纲参数 $\\beta \\Delta T$，你将学会量化密度变化，并在一个实际场景中判断使用这种强大简化的合理性。", "problem": "一块特征长度为 $L$ 的大型水平等温板浸没在环境温度为 $T_{\\infty}$、环境密度为 $\\rho_{\\infty}$ 的静止液态水中。该板的温度高于周围液体，其表面温度均匀，为 $T_{s}=T_{\\infty}+\\Delta T$。在Boussinesq框架下，考虑朝上热板上方的自然对流。\n\n仅从变密度连续介质的质量守恒、含重力的动量方程以及小温差下的线性化状态方程出发，\n$$\n\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0,\\qquad\n\\rho \\frac{D\\mathbf{u}}{Dt}=-\\nabla p+\\mu \\nabla^{2}\\mathbf{u}+\\rho \\mathbf{g},\\qquad\n\\rho(T)=\\rho_{\\infty}\\left[1-\\beta\\left(T-T_{\\infty}\\right)\\right],\n$$\n论证是哪个无量纲小参数控制着此种构型下Boussinesq近似的有效性，并指出它在流场中何处达到最大值。然后，对于 $20\\,^{\\circ}\\mathrm{C}$ 的液态水，其等压体积热膨胀系数 $\\beta=2.07\\times 10^{-4}\\ \\mathrm{K}^{-1}$，板与环境的温差 $\\Delta T=20\\ \\mathrm{K}$，板长 $L=0.1\\ \\mathrm{m}$，计算该小参数的数值。最后，用你的结果解释板附近的相对密度相对于 $\\rho_{\\infty}$ 的变化。\n\n将最终结果表示为一个纯数（无量纲），并四舍五入到三位有效数字。", "solution": "该问题要求论证以确定控制自然对流Boussinesq近似有效性的无量纲参数，找出其影响最显著的位置，并针对给定的物理情境计算其值。\n\n出发点是变密度流体 $\\rho$ 的控制方程组以及一个线性化的状态方程。\n质量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0\n$$\n动量守恒：\n$$\n\\rho \\frac{D\\mathbf{u}}{Dt}=-\\nabla p+\\mu \\nabla^{2}\\mathbf{u}+\\rho \\mathbf{g}\n$$\n线性化状态方程：\n$$\n\\rho(T)=\\rho_{\\infty}\\left[1-\\beta\\left(T-T_{\\infty}\\right)\\right]\n$$\n其中，$\\rho_{\\infty}$ 和 $T_{\\infty}$ 是静止环境流体的参考密度和参考温度，$\\beta$ 是等压体积热膨胀系数，$\\mathbf{u}$ 是速度矢量， $p$ 是压力，$\\mu$ 是动力粘度，$\\mathbf{g}$ 是重力加速度。\n\nBoussinesq近似通过假设密度变化相对于参考密度很小来简化这些方程。我们可以通过分析状态方程来形式化这一点。密度 $\\rho$ 可以表示为参考密度 $\\rho_{\\infty}$ 与偏差 $\\delta\\rho$ 的和：\n$$\n\\rho = \\rho_{\\infty} + \\delta\\rho\n$$\n根据状态方程，此偏差为：\n$$\n\\delta\\rho = -\\rho_{\\infty}\\beta(T-T_{\\infty})\n$$\n因此，相对密度变化为：\n$$\n\\frac{\\delta\\rho}{\\rho_{\\infty}} = \\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}} = -\\beta(T-T_{\\infty})\n$$\n如果在整个流动区域内，此相对密度变化的量级远小于1，则Boussinesq近似有效：\n$$\n\\left|\\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}}\\right| = \\beta|T-T_{\\infty}| \\ll 1\n$$\n流体中的温度介于环境温度 $T_{\\infty}$ 和板表面温度 $T_s$ 之间。因此，最大温差为 $\\Delta T = T_s - T_{\\infty}$。因此，相对密度变化的最大可能值为：\n$$\n\\max \\left( \\left|\\frac{\\rho - \\rho_{\\infty}}{\\rho_{\\infty}}\\right| \\right) = \\beta(T_s - T_{\\infty}) = \\beta \\Delta T\n$$\n这个无量纲数群 $\\beta \\Delta T$ 就是控制该近似有效性的参数。为使该近似精确，必须有 $\\beta \\Delta T \\ll 1$。\n\n让我们研究一下这个参数是如何简化控制方程的。\n在惯性项 $\\rho \\frac{D\\mathbf{u}}{Dt}$ 中，我们代入 $\\rho = \\rho_{\\infty} + \\delta\\rho$：\n$$\n\\rho \\frac{D\\mathbf{u}}{Dt} = (\\rho_{\\infty} + \\delta\\rho)\\frac{D\\mathbf{u}}{Dt} = \\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt} + \\delta\\rho\\frac{D\\mathbf{u}}{Dt}\n$$\n由于 $\\frac{|\\delta\\rho|}{\\rho_{\\infty}} \\le \\beta \\Delta T \\ll 1$，与 $\\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt}$ 相比，$\\delta\\rho \\frac{D\\mathbf{u}}{Dt}$ 项可被忽略。因此，惯性项近似为 $\\rho_{\\infty}\\frac{D\\mathbf{u}}{Dt}$。\n\n在连续性方程 $\\frac{\\partial \\rho}{\\partial t}+\\nabla\\cdot(\\rho \\mathbf{u})=0$ 中，代入 $\\rho = \\rho_{\\infty}(1-\\beta(T-T_\\infty))$ 可得\n$\\frac{\\partial}{\\partial t}(\\rho_{\\infty}(1-\\beta(T-T_\\infty))) + \\nabla\\cdot(\\rho_{\\infty}(1-\\beta(T-T_\\infty))\\mathbf{u}) = 0$。经简化并除以 $\\rho_\\infty$ 后，方程变为 $-\\beta \\frac{DT}{Dt} + (1-\\beta(T-T_\\infty))\\nabla\\cdot\\mathbf{u}=0$。如果 $\\beta \\Delta T \\ll 1$，则 $1-\\beta(T-T_\\infty) \\approx 1$，并且如果 $\\beta \\frac{DT}{Dt}$ 项也很小，方程就简化为经典的不可压缩形式 $\\nabla\\cdot\\mathbf{u}=0$。\n\n然而，在体积力项 $\\rho\\mathbf{g}$ 中，同样的代入得到 $\\rho\\mathbf{g} = (\\rho_{\\infty} + \\delta\\rho)\\mathbf{g} = \\rho_{\\infty}\\mathbf{g} + \\delta\\rho\\mathbf{g}$。第一项 $\\rho_{\\infty}\\mathbf{g}$ 表示流体在参考密度下的静水重力。该项被静水压力梯度 $\\nabla p_h = \\rho_{\\infty}\\mathbf{g}$ 所平衡，其中 $p=p_h+p_m$。第二项 $\\delta\\rho\\mathbf{g} = -\\rho_{\\infty}\\beta(T-T_{\\infty})\\mathbf{g}$ 是浮力。虽然 $\\delta\\rho$ 很小，但这个力是驱动整个对流运动的动力，因此是主导阶项，在动量平衡中被保留。该近似的关键在于 $\\delta\\rho$ 相对于 $\\rho_{\\infty}$ 很小，但 $\\delta\\rho\\mathbf{g}$ 与惯性力和粘性力等其他动力学项相当。\n\n因此，控制Boussinesq近似有效性的无量纲参数是 $\\beta \\Delta T$。\n\n条件 $\\beta |T-T_{\\infty}| \\ll 1$ 在 $|T-T_{\\infty}|$ 最大处最为严格。在本问题中，流体温度范围从 $T_{\\infty}$ 到 $T_s$。最大温差 $\\Delta T = T_s-T_\\infty$ 出现在热板表面。因此，相对密度偏差 $|\\rho-\\rho_\\infty|/\\rho_\\infty = \\beta|T-T_\\infty|$ 在板表面达到其最大值 $\\beta \\Delta T$。\n\n现在，我们根据给定条件计算此参数的数值：\n- 等压体积热膨胀系数，$\\beta = 2.07 \\times 10^{-4}\\ \\mathrm{K}^{-1}$。\n- 板与环境的温差，$\\Delta T = 20\\ \\mathrm{K}$。\n\n无量纲参数为：\n$$\n\\beta \\Delta T = (2.07 \\times 10^{-4}\\ \\mathrm{K}^{-1}) \\times (20\\ \\mathrm{K}) = 41.4 \\times 10^{-4} = 4.14 \\times 10^{-3}\n$$\n该参数的值为 $0.00414$。\n\n最后，我们解释这个结果。数值 $\\beta \\Delta T \\approx 0.00414$ 代表了相对于环境密度的最大密度分数变化。具体来说，在板表面，密度 $\\rho_s$ 比环境密度 $\\rho_{\\infty}$ 低约 $0.414\\%$：\n$$\n\\frac{\\rho_{\\infty} - \\rho_s}{\\rho_{\\infty}} = \\beta(T_s - T_{\\infty}) = \\beta \\Delta T = 4.14 \\times 10^{-3}\n$$\n这个密度变化非常小（远小于 $1\\%$），这为应用Boussinesq近似来模拟这个特定的自然对流问题提供了有力的依据。特征长度 $L=0.1\\,\\mathrm{m}$ 与这个关于材料属性近似有效性的具体问题无关。", "answer": "$$\\boxed{4.14 \\times 10^{-3}}$$", "id": "2510673"}, {"introduction": "水平板自然对流的物理特性因其相对于重力的朝向而发生巨大变化，从而导致截然不同的传热行为。本练习 [@problem_id:2510711] 深入探讨了这一核心概念，要求你运用第一性原理的标度分析来解释为何经验关联式 $Nu = C Ra_{L}^{n}$ 对不同朝向使用不同的指数 $n$。通过推导这些标度律，你将深刻理解稳定与不稳定分层下浮力、粘性和扩散之间的相互作用。", "problem": "一个特征长度为 $L$ 的大型等温水平板浸没在温度均匀 ($T_{\\infty}$) 的静止牛顿流体中。板的温度为 $T_{s}$，且 $|T_{s}-T_{\\infty}|=\\Delta T$。假设物性恒定，采用Boussinesq近似（BA），并忽略边缘效应，因此可以用单一的主导长度 $L$ 来表征其平面形状。考虑两种朝向：(i) 朝上的热板，$T_{s}>T_{\\infty}$，热表面朝上；(ii) 朝下的热板，$T_{s}>T_{\\infty}$，热表面朝下。定义基于 $L$ 的瑞利数为 $Ra_{L}=g\\,\\beta\\,\\Delta T\\,L^{3}/(\\nu\\,\\alpha)$，其中 $g$ 是重力加速度，$\\beta$ 是体积热膨胀系数，$\\nu$ 是运动粘度，$\\alpha$ 是热扩散率。定义努塞尔数为 $Nu=h\\,L/k$，其中 $h$ 是对流传热系数，$k$ 是流体的导热系数。\n\n文献中的许多经验关联式形式为 $Nu=C\\,Ra_{L}^{\\,n}$，并且针对朝上和朝下的板报告了不同的指数 $n$。不引用任何经验关联式，仅使用BA下的质量、动量和能量守恒以及标准的尺度分析，从第一性原理出发，推断在每种朝向和不同流态下控制热边界层和对流运动的主导平衡关系。然后，确定以下哪个选项最正确地解释了为什么两种朝向会报告不同的指数 $n$，并将这些报告的 $n$ 值与潜在的流态连贯地联系起来。你的推理应基于可识别的平衡关系（例如，浮力、粘性扩散、惯性；热传导与对流），并在可能的情况下，推导出这些流态下具有代表性的 $n$ 的标度指数。\n\n哪个选项与此第一性原理分析最一致？\n\nA. 朝上的热板产生不稳定的密度分层，一旦超过临界状态，会自组织成浮力羽流或Rayleigh–Bénard环流，其近壁热层会调整到一个临界的子层瑞利数，使得在足够大的 $Ra_{L}$ 时，有 $Nu\\sim Ra_{L}^{\\,1/3}$。而在较低的 $Ra_{L}$ 时，浮力、粘性和热扩散之间的层流边界层平衡得出 $Nu\\sim Ra_{L}^{\\,1/4}$。朝下的热板是稳定分层的，抑制了羽流或环流的形成，因此一个弱的层流边界层得以持续存在；同样的浮力-粘性-扩散平衡此时会产生一个比不稳定情况更小的有效指数 $n$，这与文献报道的指数 $n\\approx 1/4$ 或更低（在一些数据集中通常更接近 $n\\approx 1/5$）相符。\n\nB. 指数 $n$ 对于朝上和朝下的板必须相同，因为重力仅通过 $Ra_{L}$ 影响该问题，所以朝向不能改变 $Nu\\sim Ra_{L}^{\\,n}$ 的依赖关系。\n\nC. 对于朝上的热板，浮力消除了热扩散的需要，因此 $Nu$ 随 $Ra_{L}$ 线性增长，且 $n\\approx 1$。对于朝下的热板，稳定性完全抑制了对流，因此 $Nu$ 与 $Ra_{L}$ 无关，且 $n\\approx 0$。\n\nD. 观察到的 $n$ 的差异仅由板的导热系数与流体导热系数之比控制；对于理想导热板，两种朝向的 $n$ 均约为 $1/2$，因此任何报道的 $n$ 的差异都必须归因于板的有限导热性，而非朝向或流态。", "solution": "在继续之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n-   系统：一个大型等温水平板。\n-   特征长度：$L$。\n-   流体：静止、牛顿流体，温度 $T_{\\infty}$。\n-   板温：$T_s$。\n-   温差：$\\Delta T = |T_s - T_{\\infty}|$。\n-   假设：物性恒定，Boussinesq近似（BA），边缘效应可忽略。\n-   朝向：\n    -   (i) 朝上的热板：$T_s > T_{\\infty}$，表面朝上。\n    -   (ii) 朝下的热板：$T_s > T_{\\infty}$，表面朝下。\n-   定义：\n    -   瑞利数：$Ra_{L} = g\\,\\beta\\,\\Delta T\\,L^{3}/(\\nu\\,\\alpha)$。\n    -   努塞尔数：$Nu = h\\,L/k$。\n-   任务：从第一性原理和尺度分析出发，解释为何关联式 $Nu = C\\,Ra_{L}^{n}$ 中的指数 $n$ 对两种朝向不同，并将 $n$ 的值与流态联系起来。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题是传热学领域的一个经典课题，即自然对流。物理设置、控制原理（Boussinesq近似下的守恒定律）和无量纲参数（$Ra_L$, $Nu$）都是标准的且基础牢固。\n-   **适定性：** 该问题要求对标度律进行物理解释和推导，这是理论流体力学中一个明确定义的任务。它不需要数值解，而是概念性分析，并且已为此提供了足够的信息。\n-   **客观性：** 语言技术性强、精确，没有主观或模糊的术语。\n\n**步骤3：结论与行动**\n问题陈述科学上合理、适定且客观。它是**有效的**。将基于第一性原理推导解答。\n\n**从第一性原理推导**\n\n水平板自然对流的物理原理受浮力与密度分层的稳定或不稳定效应之间相互作用的支配。重力矢量 $\\mathbf{g}$ 相对于温度梯度 $\\nabla T$ 的方向至关重要。我们使用Boussinesq近似下稳态守恒方程的尺度分析来分析这两种指定的朝向。设 $\\delta_T$ 为热边界层的厚度。努塞尔数的标度关系为 $Nu_L \\sim L/\\delta_T$。我们的目标是找出 $\\delta_T$ 如何依赖于相关的物理参数，这些参数被封装在 $Ra_L$ 中。\n\n**情况 (i)：朝上的热板 ($T_s > T_{\\infty}$)**\n在这种配置中，热的、密度较小的流体位于冷的、密度较大的主体流体下方。这种布置是**流体动力学不稳定的**。重力会放大任何微小的扰动，导致热流体上升和冷流体下沉。\n\n-   **高 $Ra_L$ 区（湍流或环流对流）：**\n    对于足够大的 $Ra_L$，边界层变得不稳定，并分解成上升的羽流和下降的流体片，或形成环流模式。传热由这些剧烈的对流运动主导。对于这个湍流区的一个关键见解是，热边界层厚度 $\\delta_T$ 不再依赖于板的总长度 $L$。相反，$\\delta_T$ 会自我调整，使得基于该厚度的局部瑞利数 $Ra_{\\delta_T} = g\\,\\beta\\,\\Delta T\\,\\delta_T^{3}/(\\nu\\,\\alpha)$ 保持在一个临界常数值 $Ra_c$ 附近，在此值下，子层本身处于临界稳定状态。\n    $$Ra_{\\delta_T} \\sim \\text{常数}$$\n    $$ \\frac{g\\,\\beta\\,\\Delta T\\,\\delta_T^{3}}{\\nu\\,\\alpha} \\sim \\text{常数}$$\n    求解 $\\delta_T$：\n    $$\\delta_T \\sim \\left( \\frac{\\nu\\,\\alpha}{g\\,\\beta\\,\\Delta T} \\right)^{1/3}$$\n    然后通过代入 $\\delta_T$ 的这个标度关系来找到努塞尔数：\n    $$Nu_L \\sim \\frac{L}{\\delta_T} \\sim L \\left( \\frac{g\\,\\beta\\,\\Delta T}{\\nu\\,\\alpha} \\right)^{1/3} = \\left( \\frac{g\\,\\beta\\,\\Delta T\\,L^3}{\\nu\\,\\alpha} \\right)^{1/3}$$\n    因此，对于不稳定的高 $Ra_L$ 区，我们得到标度关系：\n    $$Nu_L \\sim Ra_L^{1/3}$$\n\n-   **低 $Ra_L$ 区（层流对流）：**\n    在强湍流对流的阈值以下但高于运动开始的阈值时，流动是层流。分层的不稳定特性仍然促进垂直运动。该流态下的力平衡通常是浮力、粘性和热扩散之间的平衡。对于垂直板，浮力在边界层内直接驱动流动以对抗粘性阻力，其标度关系为 $Nu_L \\sim Ra_L^{1/4}$。鉴于不稳定的水平板流动涉及显著的垂直流体交换，可以合理地预期其标度行为与垂直板相似。因此，该流态的指数为 $n=1/4$ 是一个合理的期望。\n\n**情况 (ii)：朝下的热板 ($T_s > T_{\\infty}$)**\n在这种配置中，热的、密度较小的流体位于冷的、密度较大的主体流体之上。这种布置是**流体动力学稳定的**。浮力起到抑制垂直运动和使流体分层的作用。\n\n-   **流态：**\n    稳定的分层阻止了羽流的形成和湍流的破坏。对流并非完全不存在；受热的流体层在浮力引起的水平压力梯度驱动下，从中心向板的边缘水平向外扩散。这导致在非常宽的 $Ra_L$ 范围内存在一个弱的、持续的层流边界层。主导平衡是压力梯度、粘性力和热扩散之间的平衡。对此情况的尺度分析如下：\n    1.  垂直压力梯度平衡浮力：$\\partial p'/\\partial y \\sim \\rho g \\beta \\Delta T$。在边界层内，$p' \\sim \\rho g \\beta \\Delta T \\delta_T$。\n    2.  这会产生一个驱动流动的水平压力梯度：$\\partial p'/\\partial x \\sim p'/L \\sim \\rho g \\beta \\Delta T \\delta_T/L$。\n    3.  该压力梯度由粘性剪切平衡：$(1/\\rho)\\partial p'/\\partial x \\sim \\nu U/\\delta_T^2$。这得出 $U \\sim g \\beta \\Delta T \\delta_T^3 / (\\nu L)$。\n    4.  能量方程平衡了水平对流与垂直扩散：$U \\Delta T/L \\sim \\alpha \\Delta T/\\delta_T^2$。这得出 $U \\sim \\alpha L/\\delta_T^2$。\n    5.  将特征速度 $U$ 的两个表达式相等：\n        $$\\frac{g \\beta \\Delta T \\delta_T^3}{\\nu L} \\sim \\frac{\\alpha L}{\\delta_T^2} \\implies \\delta_T^5 \\sim \\frac{\\nu \\alpha L^2}{g \\beta \\Delta T}$$\n    6.  用 $Ra_L$ 表示：\n        $$\\left(\\frac{\\delta_T}{L}\\right)^5 \\sim \\frac{\\nu \\alpha}{g \\beta \\Delta T L^3} = Ra_L^{-1}$$\n        $$\\frac{\\delta_T}{L} \\sim Ra_L^{-1/5}$$\n    7.  最后，努塞尔数的标度关系为：\n        $$Nu_L \\sim \\frac{L}{\\delta_T} \\sim Ra_L^{1/5}$$\n    这个指数 $n=1/5$ 小于 $n=1/4$ 和 $n=1/3$，反映了在稳定配置中传热效率较低。\n\n**选项评估**\n\n-   **选项 A：** 该选项指出，朝上的板是不稳定的，导致羽流/环流，在高 $Ra_L$ 下由于子层的临界稳定性而得到 $Nu \\sim Ra_L^{1/3}$，在较低 $Ra_L$ 下则为层流区，有 $Nu \\sim Ra_L^{1/4}$。它还指出，朝下的板是稳定的，产生一个持续的弱层流层，其指数较小，如 $n \\approx 1/5$。这与第一性原理的推导完全吻合。其物理解释是合理的，预测的标度指数对于各自的流态也是正确的。**正确**。\n\n-   **选项 B：** 该选项声称指数 $n$ 对两种朝向必须相同，因为重力只存在于 $Ra_L$ 中。这在根本上是错误的。板相对于重力矢量的朝向决定了密度分层的稳定性。正是浮力的方向性导致了这两种情况之间深刻的物理差异。**不正确**。\n\n-   **选项 C：** 该选项声称，对于朝上的情况，$n \\approx 1$ 是因为浮力消除了扩散的需要；对于朝下的情况，$n \\approx 0$ 是因为对流被完全抑制。这两种说法都没有物理依据。在壁面处，热扩散总是必要的，以便将热量传递给流体，因此 $n=1$ 没有物理来源。在稳定情况下，对流被削弱，而不是被消除，所以当 $Ra_L > 0$ 时，$Nu$ 不是常数（$n \\neq 0$）。**不正确**。\n\n-   **选项 D：** 该选项错误地将 $n$ 的差异归因于板的导热系数，并声称对于理想导热（等温）板，两种情况下 $n \\approx 1/2$。问题中已经假设板是等温的，所以这不可能是解释。主要原因是流体动力学稳定性，而不是共轭传热。指数 $n=1/2$ 对于此问题不正确，并且关于理想板朝向无关的说法是错误的。**不正确**。\n\n基于严谨的分析，选项A为所观察到的现象提供了唯一在物理上一致且全面的解释。", "answer": "$$\\boxed{A}$$", "id": "2510711"}, {"introduction": "在理论分析与现代计算流体动力学（CFD）之间架起桥梁是当今工程师和科学家的关键技能。这个高级练习 [@problem_id:2510675] 将指导你运用标度律——例如前一个练习中探讨的那些——来为一个直接数值模拟（DNS）设计一个完整且可复现的计算方案。你将把物理参数和理论尺度转化为具体的计算域和网格，从而深入了解基本原理如何指导高保真度模拟的实践。", "problem": "您需要设计一个程序，该程序能将具有物理意义的输入转化为一个可复现的直接数值模拟（DNS）配置，用于模拟等温、朝下、有限尺寸水平板上方的层流自然对流。设计必须基于第一性原理，并从控制方程中推导出特征边界层尺度。该程序必须实现所得到的公式，并返回一个关于计算域尺寸、法向边界层解析网格加密以及保守流向分辨率的紧凑规范。所有结果必须以国际单位制（SI）表示，且浮点量必须四舍五入至六位有效数字。\n\n从以下基本依据出发：\n- 在平坦水平表面上方的边界层极限下，经Boussinesq近似的不可压缩Navier–Stokes方程和能量方程：\n  - 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$。\n  - 动量方程：$\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g} \\beta \\left( T - T_{\\infty} \\right)\\hat{\\mathbf{g}}$。\n  - 能量方程：$\\rho c_p \\left( \\mathbf{u} \\cdot \\nabla \\right) T = k \\nabla^2 T$。\n- 材料属性与参数：密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$、定压比热容 $c_p$、热膨胀系数 $\\beta$、重力加速度大小 $g$、板的特征长度 $L$ 以及温差 $\\Delta T = T_s - T_{\\infty}$。\n- 运动粘度 $\\nu = \\mu / \\rho$ 和热扩散率 $\\alpha = k / (\\rho c_p)$。\n- 瑞利数 $Ra = \\dfrac{g \\beta \\Delta T L^3}{\\nu \\alpha}$。\n\n对层流状态下朝下等温水平板进行适合的量级边界层标度分析。从基本方程出发进行论证（不借助任何现成的对流传热关系式），证明：\n- 板上方的特征水平压力梯度源于在量级为 $L$ 的水平长度上，量级为 $\\rho g \\beta \\Delta T \\delta$ 的静压亏损，其中 $\\delta$ 是板上方的特征边界层厚度。\n- 通过平衡此流向压力梯度与水平动量的粘性扩散，并引用边界层内温度的对流-扩散平衡，可通过瑞利数得到一个连接 $\\delta$、$L$ 和材料-重力参数的预测性代数关系。\n- 使用您推导出的精确代数依赖关系，根据输入计算 $\\delta$。\n\n使用以下要求设计DNS配置：\n1) 计算域尺寸：\n- 法向范围 $H$ 等于 $c_H \\, \\delta$，其中 $c_H = 12$。\n- 流向计算域范围 $L_{\\text{dom}}$ 等于 $L + c_{\\text{side}} \\, \\delta$，其中 $c_{\\text{side}} = 10$。\n\n2) 边界条件（在设计中概念性使用，无需打印）：\n- 底部边界（$y = 0$）：无滑移速度和等温条件 $T = T_s$。\n- 顶部边界（$y = H$）：无应力速度，法向梯度为零，以及固定的环境温度 $T = T_{\\infty}$。\n- 侧向边界（$x = 0$ 和 $x = L_{\\text{dom}}$）：对称条件（法向速度为零且法向梯度为零），以在二维近似中最小化限制效应。\n\n3) 板附近的网格加密：\n- 法向网格间距构成等比数列 $\\Delta y_i = \\Delta y_1 \\, r^{\\, i - 1}$，其中 $i = 1, 2, \\ldots, N_y$，$\\Delta y_1 = \\delta / N_{\\text{bl}}$ 且 $N_{\\text{bl}} = 48$ 是跨边界层的目标分辨率。\n- 公比 $r$ 必须满足 $1 \\le r \\le r_{\\max}$，其中 $r_{\\max} = 1.08$。\n- 确定最小的整数 $N_y \\ge N_{\\text{bl}}$，使得存在一个 $r \\in [1, r_{\\max}]$ 满足\n$$\n\\sum_{i=1}^{N_y} \\Delta y_i \\;=\\; \\Delta y_1 \\, \\frac{r^{N_y} - 1}{r - 1} \\;=\\; H,\n$$\n且相对公差不超过 $10^{-6}$。如果 $r = 1$，则将左侧求和式作极限意义上的解释，即 $N_y \\Delta y_1$。对于给定的 $N_y$，若在 $r_{\\max}$ 处的总和超过 $H$，则在 $[1, r_{\\max}]$ 上通过二分法求解 $r$；否则增加 $N_y$ 并重试。对于下面测试套件中的输入，此搜索必须成功且 $N_y$ 不会超过 $4096$。\n\n4) 流向网格分辨率：\n- 选择一个保守的目标间距 $\\Delta x_{\\text{tgt}} = \\min \\left( \\delta / 4, \\, L_{\\text{dom}} / 200 \\right)$，并将流向网格单元数设为 $N_x = \\lceil L_{\\text{dom}} / \\Delta x_{\\text{tgt}} \\rceil$。\n\n测试套件：\n为以下三个测试案例实现您的程序。每个案例由元组 $(L, \\Delta T, \\rho, \\mu, k, c_p, \\beta, g)$ 定义。\n- A案例（空气，中等 $\\Delta T$）：$(0.2, 10, 1.177, 1.85\\times 10^{-5}, 0.026, 1007, 1/300, 9.81)$。\n- B案例（接近$40\\,^{\\circ}\\mathrm{C}$的水，较高普朗特数）：$(0.1, 5, 992.0, 6.53\\times 10^{-4}, 0.628, 4179.0, 3.5\\times 10^{-4}, 9.81)$。\n- C案例（空气，低$\\Delta T$且板尺寸更大）：$(0.3, 1, 1.177, 1.85\\times 10^{-5}, 0.026, 1007, 1/300, 9.81)$。\n\n对于每个案例，您的程序必须按此确切顺序计算并以列表形式返回：\n- $Ra$（无量纲），\n- $\\delta$（单位：米），\n- $H$（单位：米），\n- $L_{\\text{dom}}$（单位：米），\n- $N_x$（整数），\n- $N_y$（整数），\n- $\\Delta y_1$（单位：米），\n- $r$（无量纲）。\n\n最终输出格式：\n- 您的程序必须打印单行，包含一个逗号分隔的列表，其中包含三个案例的结果。每个结果都是一个方括号括起来的、按上述顺序排列的逗号分隔列表。例如：$[ [\\ldots \\text{案例 A} \\ldots], [\\ldots \\text{案例 B} \\ldots], [\\ldots \\text{案例 C} \\ldots] ]$。\n- 所有浮点输出必须四舍五入到六位有效数字。所有长度单位为米，其他量使用上文所隐含的自然单位。", "solution": "如问题所述，要求从第一性原理出发，为加热水平板上方的自然对流推导出一个直接数值模拟（DNS）的计算配置。在进行求解之前，需要对问题陈述进行严格的验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- **控制方程**：经Boussinesq近似的不可压缩Navier–Stokes方程和能量方程，在边界层极限下：\n  - 连续性方程：$\\nabla \\cdot \\mathbf{u} = 0$。\n  - 动量方程：$\\rho \\left( \\mathbf{u} \\cdot \\nabla \\right)\\mathbf{u} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\rho \\mathbf{g} \\beta \\left( T - T_{\\infty} \\right)\\hat{\\mathbf{g}}$。\n  - 能量方程：$\\rho c_p \\left( \\mathbf{u} \\cdot \\nabla \\right) T = k \\nabla^2 T$。\n- **材料属性与参数**：密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$、比热容 $c_p$、热膨胀系数 $\\beta$、重力加速度 $g$、板长 $L$ 以及温差 $\\Delta T = T_s - T_{\\infty}$。\n- **派生属性**：运动粘度 $\\nu = \\mu / \\rho$、热扩散率 $\\alpha = k / (\\rho c_p)$。\n- **无量纲数**：瑞利数 $Ra = \\dfrac{g \\beta \\Delta T L^3}{\\nu \\alpha}$。\n- **标度分析任务**：进行量级分析，推导边界层厚度 $\\delta$ 作为 $L$ 和 $Ra$ 函数的代数关系。推导必须平衡由浮力引起的水平压力梯度与粘性力，并结合能量方程中的对流-扩散平衡。\n- **DNS配置要求**：\n  1. **计算域尺寸**：法向范围 $H = c_H \\, \\delta$（$c_H = 12$）。流向范围 $L_{\\text{dom}} = L + c_{\\text{side}} \\, \\delta$（$c_{\\text{side}} = 10$）。\n  2. **网格加密**：法向网格间距构成等比数列 $\\Delta y_i = \\Delta y_1 \\, r^{\\, i - 1}$。第一个单元格高度 $\\Delta y_1 = \\delta / N_{\\text{bl}}$（$N_{\\text{bl}} = 48$）。找到最小整数 $N_y \\ge N_{\\text{bl}}$ 和一个比率 $r \\in [1, r_{\\max}]$（$r_{\\max} = 1.08$），使得 $\\sum_{i=1}^{N_y} \\Delta y_i = H$，相对公差为 $10^{-6}$。\n  3. **流向分辨率**：目标间距 $\\Delta x_{\\text{tgt}} = \\min \\left( \\delta / 4, \\, L_{\\text{dom}} / 200 \\right)$。单元格数量 $N_x = \\lceil L_{\\text{dom}} / \\Delta x_{\\text{tgt}} \\rceil$。\n- **测试案例**：为空气和水提供了三组物理参数。\n- **输出格式**：一个特定的嵌套列表结构，所有浮点值四舍五入到六位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据**：该问题基于流体动力学和传热学的基本方程。Boussinesq近似是处理由小温差引起的浮力驱动流动的标准、科学有效的简化方法。对量级进行标度分析的要求是物理学和工程学中经典的教学和研究技术。该过程在物理上和数学上都是合理的。\n- **良态性**：这个问题是良态的（或称适定的）。标度律的推导是基于既定原理的分析任务。随后的DNS配置的计算设计是一个具有精确定义的输入、步骤和确定性输出的算法。用于求解 $N_y$ 和 $r$ 的搜索算法被指定，以确保唯一解的存在并能被找到。\n- **客观性**：问题的各个方面都用客观、定量的标准加以规定。没有模糊性、主观性或依赖于个人观点之处。\n\n**第3步：结论与行动**\n\n该问题具有科学依据、良态性、客观性且自成体系。这是一个有效的科学问题。我现在将提供解决方案。\n\n### 解法推导与算法设计\n\n按要求，解决方案分两个阶段进行。首先，对控制方程进行标度分析，以推导出特征边界层厚度 $\\delta$。其次，利用此结果为生成DNS参数开发一个具体的计算算法。\n\n**1. 边界层标度分析**\n\n我们分析在稳定的、朝下的热板下方形成的边界层。在这种情况下，热的、较轻的流体在板下方积聚，并由于浮力引起的水平压力梯度而从中心向边缘水平扩散。\n\n令 $x$ 为水平（流向）坐标，$y$ 为垂直（法向）坐标。令 $U$ 和 $V$ 分别为这两个方向上的特征速度。边界层厚度为 $\\delta$，并在长度 $L$ 上发展。\n\n问题假设水平运动是由水平压力梯度 $\\partial p/\\partial x$ 驱动的。这个梯度之所以产生，是因为高度约为 $\\delta$ 的热流体柱下方的静压低于周围冷流体中的静压。在水平长度 $L$ 上的压力差 $\\Delta P_x$ 的量级与浮力压头相当：\n$$\n\\Delta P_x \\sim (\\rho_\\infty - \\rho) g \\delta\n$$\n使用Boussinesq近似，$\\rho_\\infty - \\rho \\approx \\rho_\\infty \\beta (T - T_\\infty)$，并取特征温差 $\\Delta T = T_s - T_\\infty$，我们有：\n$$\n\\Delta P_x \\sim \\rho g \\beta \\Delta T \\delta\n$$\n因此，动量方程中的水平压力梯度项的量级为：\n$$\n\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} \\sim \\frac{\\Delta P_x}{\\rho L} \\sim \\frac{g \\beta \\Delta T \\delta}{L}\n$$\n问题要求将此压力梯度与水平动量的粘性扩散相平衡。在 $\\delta \\ll L$ 的薄边界层中，主要的粘性项是由于法向的剪切：\n$$\n\\nu \\nabla^2 u \\sim \\nu \\frac{\\partial^2 u}{\\partial y^2} \\sim \\nu \\frac{U}{\\delta^2}\n$$\n平衡压力项和粘性项得到第一个关系：\n$$\n\\frac{g \\beta \\Delta T \\delta}{L} \\sim \\nu \\frac{U}{\\delta^2} \\quad \\implies \\quad U \\sim \\frac{g \\beta \\Delta T \\delta^3}{\\nu L}\n$$\n接下来，我们对能量方程进行标度分析。在边界层中，由对流带入的热量与扩散相平衡。主要的对流项是 $u \\partial T/\\partial x$（或 $v \\partial T/\\partial y$，根据连续性约束，其量级相同），主要的扩散项是 $\\alpha \\partial^2 T/\\partial y^2$：\n$$\nu\\frac{\\partial T}{\\partial x} \\sim U \\frac{\\Delta T}{L} \\quad \\text{和} \\quad \\alpha \\frac{\\partial^2 T}{\\partial y^2} \\sim \\alpha \\frac{\\Delta T}{\\delta^2}\n$$\n平衡这些项得到 $U$ 的第二个关系：\n$$\nU \\frac{\\Delta T}{L} \\sim \\alpha \\frac{\\Delta T}{\\delta^2} \\quad \\implies \\quad U \\sim \\frac{\\alpha L}{\\delta^2}\n$$\n将特征速度 $U$ 的两个表达式相等，便得到 $\\delta$ 的关系：\n$$\n\\frac{g \\beta \\Delta T \\delta^3}{\\nu L} \\sim \\frac{\\alpha L}{\\delta^2}\n$$\n求解 $\\delta^5$：\n$$\n\\delta^5 \\sim \\frac{\\nu \\alpha L^2}{g \\beta \\Delta T} = L^5 \\left( \\frac{g \\beta \\Delta T L^3}{\\nu \\alpha} \\right)^{-1} = L^5 Ra^{-1}\n$$\n这为边界层厚度提供了所需的预测性代数关系。我们取标度常数为1：\n$$\n\\delta = L \\, Ra^{-1/5}\n$$\n\n**2. DNS配置算法**\n\n对于每个给定的测试案例，我们执行以下计算步骤。\n\n- **第1步：计算物理属性和 $Ra$**。给定元组 $(L, \\Delta T, \\rho, \\mu, k, c_p, \\beta, g)$，首先计算派生属性 $\\nu = \\mu / \\rho$ 和 $\\alpha = k / (\\rho c_p)$。然后，计算瑞利数 $Ra = (g \\beta \\Delta T L^3) / (\\nu \\alpha)$。\n\n- **第2步：计算特征尺度**。使用上面推导的标度律，计算边界层厚度 $\\delta = L \\, Ra^{-1/5}$。然后，计算计算域范围 $H = 12 \\delta$ 和 $L_{\\text{dom}} = L + 10 \\delta$。\n\n- **第3步：计算法向网格参数 $(N_y, \\Delta y_1, r)$**。\n  - 第一个单元格的高度由边界层分辨率要求固定：$\\Delta y_1 = \\delta / 48$。\n  - 总高度 $H$ 必须由 $N_y$ 个高度成等比数列的单元格跨越：$H = \\sum_{i=1}^{N_y} \\Delta y_1 r^{i-1}$。等比数列的和为 $S_{N_y}(r) = \\Delta y_1 (r^{N_y} - 1) / (r - 1)$（对于 $r \\neq 1$），以及 $S_{N_y}(1) = N_y \\Delta y_1$。\n  - 问题定义的一个有趣推论是，比率 $H / \\Delta y_1$ 是一个常数：$H / \\Delta y_1 = (12\\delta) / (\\delta/48) = 12 \\times 48 = 576$。\n  - 因此，对 $N_y$ 和 $r$ 的搜索与测试案例的输入无关。我们必须找到最小的整数 $N_y \\ge 48$，使得方程 $(r^{N_y} - 1)/(r - 1) = 576$ 在 $r \\in [1, 1.08]$ 中有解。\n  - 如果目标值 $576$ 位于区间 $[1, 1.08]$ 上求和函数的最小值和最大值之间，则 $r$ 的解存在。该函数是单调的。我们需要找到满足以下条件的最小 $N_y \\ge 48$：$N_y \\le 576 \\le (1.08^{N_y} - 1)/(1.08 - 1)$。\n  - 第一个不等式 $N_y \\le 576$ 对于合理的 $N_y$ 总是成立的。第二个不等式是决定性因素：$(1.08^{N_y} - 1)/0.08 \\ge 576$，简化为 $1.08^{N_y} \\ge 47.08$，或 $N_y \\ge \\log_{1.08}(47.08) \\approx 50.048$。\n  - 因此，最小整数 $N_y$ 为 $51$。\n  - 当 $N_y=51$ 时，我们使用二分法在区间 $[1, 1.08]$ 上求解 $(r^{51} - 1)/(r - 1) = 576$ 以得到 $r$，直到总和 $S_{51}(r)$ 与 $H$ 的相对公差达到 $10^{-6}$。\n\n- **第4步：计算流向网格参数 $(N_x)$**。\n  - 目标流向单元格尺寸为 $\\Delta x_{\\text{tgt}} = \\min(\\delta / 4, L_{\\text{dom}} / 200)$。\n  - 流向单元格数 $N_x = \\lceil L_{\\text{dom}} / \\Delta x_{\\text{tgt}} \\rceil$。\n\n- **第5步：格式化输出**。所有计算出的浮点值（$Ra, \\delta, H, L_{\\text{dom}}, \\Delta y_1, r$）都四舍五入到六位有效数字。整数值（$N_x, N_y$）按原样输出。结果被组装成指定的列表格式。\n\n这个结构化的程序保证了从给定的参数中生成一个可复现且具有物理动机的DNS配置。", "answer": "[[7.58780e+06,0.00705291,0.0846349,0.270529,200,51,0.000146936,1.07923],[1.72081e+08,0.00216784,0.0260141,0.121678,225,51,4.51633e-05,1.07923],[2.56083e+06,0.0157074,0.188489,0.457074,200,51,0.000327238,1.07923]]", "id": "2510675"}]}