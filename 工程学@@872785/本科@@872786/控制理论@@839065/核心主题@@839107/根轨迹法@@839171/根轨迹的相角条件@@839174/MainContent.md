## 引言
[根轨迹法](@entry_id:273543)是控制理论中一种强大而直观的图形化工具，它揭示了当系统的一个参数（通常是增益 $K$）变化时，闭环系统极点在复平面上的移动轨迹。理解这些轨迹的形成方式对于分析系统的稳定性、瞬态响应和整体性能至关重要。然而，绘制和解释这些复杂轨迹的背后，依赖于一个简洁而深刻的数学原理——[相角条件](@entry_id:264793)。

本文旨在深入剖析[相角条件](@entry_id:264793)，阐明其作为构建整个根轨迹理论基石的核心地位。我们将从根本上解决一个问题：在复平面上成千上万的点中，哪些点有资格成为系统在某个增益下的[闭环极点](@entry_id:274094)？[相角条件](@entry_id:264793)为这个问题提供了明确的答案。

在接下来的内容中，读者将系统地学习：
*   在“原理与机制”一章中，我们将从特征方程出发，推导出[相角条件](@entry_id:264793)，并阐述其清晰的几何意义。您将学会如何计算任意点上的[相角](@entry_id:274491)贡献，并利用它来推导[根轨迹](@entry_id:272958)的关键特征，如[实轴](@entry_id:148276)段、对称性、渐近线以及离开/[到达角](@entry_id:265527)。
*   在“应用与跨学科联系”一章中，我们将展示[相角条件](@entry_id:264793)如何从一个理论概念转变为强大的工程实践工具。我们将探讨其在[控制器设计](@entry_id:274982)（特别是相位补偿）、参数[根轨迹分析](@entry_id:261770)以及处理时间延迟和离散系统等高级问题中的应用。
*   最后，通过“动手实践”环节，您将有机会应用所学知识，解决从基本验证到复杂设计等一系列工程问题，从而将理论理解转化为实际技能。

通过本文的学习，您将不仅掌握绘制[根轨迹](@entry_id:272958)的技巧，更会领悟到[相角条件](@entry_id:264793)作为连接代数方程与几何直觉的桥梁所蕴含的深刻洞见。

## 原理与机制

在上一章中，我们介绍了根轨迹作为一种图形化工具，用于分析闭环系统极点如何随系统参数（通常是增益 $K$）的变化而移动。本章将深入探讨构建和解释[根轨迹图](@entry_id:264447)所需的核心数学原理，特别是**[相角条件](@entry_id:264793) (Angle Condition)**。[相角条件](@entry_id:264793)是决定[根轨迹](@entry_id:272958)几何形状的基石，理解其原理和应用对于掌握[根轨迹法](@entry_id:273543)至关重要。

### 基本原理：从特征方程出发

对于一个典型的负[反馈控制系统](@entry_id:274717)，其[闭环传递函数](@entry_id:275480) $T(s)$ 可以表示为：
$$ T(s) = \frac{K G(s)}{1 + K G(s) H(s)} $$
其中 $K$ 是一个可变增益，$G(s)$ 是[前向通路](@entry_id:275478)[传递函数](@entry_id:273897)，$H(s)$ 是反馈通路[传递函数](@entry_id:273897)。我们通常将 $L(s) = G(s)H(s)$ 称为**[开环传递函数](@entry_id:276280)**。

系统的动态行为由其[闭环极点](@entry_id:274094)决定，这些极点是[特征方程](@entry_id:265849) $1 + K L(s) = 0$ 的根。为了找到这些根 $s$ 的轨迹，我们将[特征方程](@entry_id:265849)重写为：
$$ L(s) = -\frac{1}{K} $$
这个看似简单的方程是整个[根轨迹分析](@entry_id:261770)的出发点。它告诉我们，一个复数 $s$ 若要成为[闭环极点](@entry_id:274094)，那么[开环传递函数](@entry_id:276280)在该点的值 $L(s)$ 必须等于 $-1/K$。

### [相角条件](@entry_id:264793)：一种几何诠释

让我们首先考虑最常见的情况：增益 $K$ 是一个从 $0$ 变化到 $\infty$ 的**正实数**。在这种情况下，$-1/K$ 是一个负实数。任何一个负实数在复平面上的[相角](@entry_id:274491)都是 $\pi$ [弧度](@entry_id:171693)（或 $180^\circ$）的奇数倍。

因此，方程 $L(s) = -1/K$ 可以被分解为两个独立的条件：

1.  **[相角条件](@entry_id:264793) (Angle Condition):** 复数 $L(s)$ 的[相角](@entry_id:274491)必须是 $\pi$ 的奇数倍。
    $$ \angle L(s) = (2k+1)\pi, \quad k \in \mathbb{Z} $$
    其中 $k$ 是任意整数。这等价于 $(2k+1)180^\circ$。

2.  **模值条件 (Magnitude Condition):** 复数 $L(s)$ 的模必须等于 $1/K$。
    $$ |L(s)| = \frac{1}{K} $$

[相角条件](@entry_id:264793)是绘制[根轨迹](@entry_id:272958)几何形状的关键。它定义了复平面上所有可能成为[闭环极点](@entry_id:274094)的点的集合，而与增益 $K$ 的具体值无关（只要 $K>0$）。一旦确定了这条轨迹，模值条件则可以用来在轨迹上找到对应于特定增益值 $K$ 的[极点位置](@entry_id:271565)。

### 计算 $L(s)$ 的[相角](@entry_id:274491)

为了应用[相角条件](@entry_id:264793)，我们必须能够计算 $\angle L(s)$。通常，[开环传递函数](@entry_id:276280) $L(s)$ 是一个有理函数，可以表示为[零点和极点](@entry_id:177073)的乘积形式：
$$ L(s) = C \frac{\prod_{i=1}^{m} (s-z_i)}{\prod_{j=1}^{n} (s-p_j)} $$
其中 $z_i$ 是系统的开环零点，$p_j$ 是[开环极点](@entry_id:272301)，而 $C$ 是一个正的[比例增益](@entry_id:272008)常数。复数的乘积的[相角](@entry_id:274491)是各复数[相角](@entry_id:274491)之和，除法的[相角](@entry_id:274491)是分子[相角](@entry_id:274491)与分母[相角](@entry_id:274491)之差。因此，$\angle L(s)$ 可以表示为：
$$ \angle L(s) = \sum_{i=1}^{m} \angle(s-z_i) - \sum_{j=1}^{n} \angle(s-p_j) $$
这里，每一项 $\angle(s-z_i)$ 或 $\angle(s-p_j)$ 都具有清晰的几何意义：它代表从零点 $z_i$ 或极点 $p_j$ 指向测试点 $s$ 的**向量**的[相角](@entry_id:274491)。

因此，要检验一个点 $s_t$ 是否在[根轨迹](@entry_id:272958)上，我们只需计算所有从开环零点指向 $s_t$ 的向量[相角](@entry_id:274491)之和，再减去所有从[开环极点](@entry_id:272301)指向 $s_t$ 的向量[相角](@entry_id:274491)之和。如果最终结果是 $\pi$ 的奇数倍，那么该点就在根轨迹上。

**示例 1：计算单个零点的[相角](@entry_id:274491)贡献**

考虑一个在 $s = -2$ 处有单个零点的系统。我们想知道它对测试点 $s_t = j3$ 的[相角](@entry_id:274491)贡献。我们需要计算从 $s_z = -2$ 到 $s_t = j3$ 的向量的[相角](@entry_id:274491)。该向量由复数 $V = s_t - s_z = (j3) - (-2) = 2 + j3$ 表示。其[相角](@entry_id:274491)为 $\theta = \arctan(3/2) \approx 56.3^\circ$ [@problem_id:1618280]。

**示例 2：计算多个极点的[相角](@entry_id:274491)贡献**

考虑一个在 $s=1$ 和 $s=-1$ 处有两个[开环极点](@entry_id:272301)的系统。我们想检验测试点 $s_0 = j\sqrt{3}$ 是否在根轨迹上。我们需要计算从这两个极点到 $s_0$ 的向量[相角](@entry_id:274491)的和。
*   从极点 $p_1 = 1$ 出发的向量是 $s_0 - p_1 = -1 + j\sqrt{3}$。该向量位于第二象限，其[相角](@entry_id:274491)为 $\theta_1 = 120^\circ$。
*   从极点 $p_2 = -1$ 出发的向量是 $s_0 - p_2 = 1 + j\sqrt{3}$。该向量位于第一象限，其[相角](@entry_id:274491)为 $\theta_2 = 60^\circ$。

该系统的[开环传递函数](@entry_id:276280)为 $G(s) = K/(s^2-1)$，没有有限零点。因此，$\angle G(s_0) = -(\theta_1 + \theta_2) = -(120^\circ + 60^\circ) = -180^\circ$。由于 $-180^\circ$ 是 $180^\circ$ 的奇数倍，该点 $s_0 = j\sqrt{3}$ 满足[相角条件](@entry_id:264793)，因此它在[根轨迹](@entry_id:272958)上 [@problem_id:1618297]。

### [相角条件](@entry_id:264793)的应用

掌握了[相角条件](@entry_id:264793)的计算方法后，我们可以将其应用于解决一系列[控制系统设计](@entry_id:273663)与分析问题。

#### 确定未知的系统参数

[相角条件](@entry_id:264793)的一个强大用途是，当已知根轨迹经过某个特定点时，可以反向求解系统中未知的参数，例如一个未知的极点或零点位置。

假设一个系统的[开环传递函数](@entry_id:276280)为 $G(s) = \frac{1}{(s+1)(s+4)(s+a)}$，其中[极点位置](@entry_id:271565) $a$ 是未知的。如果我们通过实验或分析得知，[根轨迹](@entry_id:272958)精确地经过点 $s_0 = -2+j$，我们就可以利用[相角条件](@entry_id:264793)来确定 $a$ 的值。

根据[相角条件](@entry_id:264793)，在 $s_0$ 点必须满足：
$$ -\left( \angle(s_0+1) + \angle(s_0+4) + \angle(s_0+a) \right) = (2k+1)\pi $$
为了简化，我们通常取 $k=-1$，使右侧为 $-\pi$。这意味着括号内的[相角](@entry_id:274491)之和必须为 $\pi$ (或 $180^\circ$)：
$$ \angle(-2+j+1) + \angle(-2+j+4) + \angle(-2+j+a) = \pi $$
计算已知项的[相角](@entry_id:274491)：
*   $\angle(-1+j) = 135^\circ$ 或 $\frac{3\pi}{4}$ [弧度](@entry_id:171693)。
*   $\angle(2+j) = \arctan(1/2)$。

代入方程，我们得到：
$$ \frac{3\pi}{4} + \arctan\left(\frac{1}{2}\right) + \angle((a-2)+j) = \pi $$
求解未知的[相角](@entry_id:274491)：
$$ \angle((a-2)+j) = \pi - \frac{3\pi}{4} - \arctan\left(\frac{1}{2}\right) = \frac{\pi}{4} - \arctan\left(\frac{1}{2}\right) $$
取上式两边的正切值，并利用正切差角公式：
$$ \tan(\angle((a-2)+j)) = \frac{\text{Im}}{\text{Re}} = \frac{1}{a-2} $$
$$ \tan\left(\frac{\pi}{4} - \arctan\left(\frac{1}{2}\right)\right) = \frac{\tan(\pi/4) - \tan(\arctan(1/2))}{1 + \tan(\pi/4)\tan(\arctan(1/2))} = \frac{1 - 1/2}{1 + 1/2} = \frac{1}{3} $$
因此，我们有 $1/(a-2) = 1/3$，解得 $a=5$。通过这种方式，我们仅利用根轨迹上的一个点就确定了系统的模型参数 [@problem_id:1618275]。类似的方法也可以用来确定未知的零点位置 [@problem_id:1618285]。

#### 确定[实轴](@entry_id:148276)上的根轨迹段

[相角条件](@entry_id:264793)为我们提供了一个简单的规则来确定实轴的哪些部分属于[根轨迹](@entry_id:272958)。对于[实轴](@entry_id:148276)上的一个测试点，任何位于其左侧的实数极点或零点对其贡献的[相角](@entry_id:274491)为 $0^\circ$；而任何位于其右侧的实数极点或零点对其贡献的[相角](@entry_id:274491)为 $180^\circ$。

因此，[实轴](@entry_id:148276)上某一点的总[相角](@entry_id:274491)等于其**右侧**实数[开环极点和零点](@entry_id:276317)总数乘以 $180^\circ$。为了满足[相角条件](@entry_id:264793)（即总[相角](@entry_id:274491)为 $180^\circ$ 的奇数倍），该点右侧的极点和零点总数必须为**奇数**。

例如，考虑系统 $G(s) = \frac{K(s+4)}{s+1}$ ($K>0$) [@problem_id:1618320]。该系统在 $s=-1$ 处有一个极点，在 $s=-4$ 处有一个零点。
*   对于[实轴](@entry_id:148276)上 $s_0 > -1$ 的任意点，其右侧没有极点或零点。贡献的总[相角](@entry_id:274491)为 $0 \times 180^\circ = 0^\circ$。不满足条件，因此该区域不属于[根轨迹](@entry_id:272958)。
*   对于[实轴](@entry_id:148276)上 $-4 \lt s_0 \lt -1$ 的任意点，其右侧有一个极点（在-1处）。贡献的总[相角](@entry_id:274491)为 $1 \times 180^\circ = 180^\circ$。满足条件，因此该线段属于[根轨迹](@entry_id:272958)。
*   对于[实轴](@entry_id:148276)上 $s_0 \lt -4$ 的任意点，其右侧有一个极点（在-1处）和一个零点（在-4处），总数为2（偶数）。$\angle G(s_0) = \angle(s_0+4) - \angle(s_0+1) = 180^\circ - 180^\circ = 0^\circ$。不满足条件。

#### [根轨迹的对称性](@entry_id:275090)

一个常见的观察是，如果系统的开环[零点和极点](@entry_id:177073)都是实数，或者以共轭对的形式出现，那么[根轨迹图](@entry_id:264447)总是关于实轴对称的。这个性质也可以严格地通过[相角条件](@entry_id:264793)来证明。

假设一个非实数点 $s_0 = \sigma_0 + j\omega_0$ (其中 $\omega_0 \neq 0$) 位于根轨迹上。我们来检验它的[共轭点](@entry_id:160335) $s_0^* = \sigma_0 - j\omega_0$ 是否也满足[相角条件](@entry_id:264793)。对于任意一个实数极点或零点 $p_k$，从 $p_k$ 到 $s_0$ 的向量是 $s_0 - p_k = (\sigma_0 - p_k) + j\omega_0$。而从 $p_k$ 到 $s_0^*$ 的向量是 $s_0^* - p_k = (\sigma_0 - p_k) - j\omega_0$。这两个向量互为共轭，因此它们的[相角](@entry_id:274491)互为[相反数](@entry_id:151709)：$\angle(s_0^* - p_k) = -\angle(s_0 - p_k)$。如果系统的所有[零点和极点](@entry_id:177073)都是实数，那么：
$$ \angle L(s_0^*) = \sum \angle(s_0^*-z_i) - \sum \angle(s_0^*-p_j) = \sum (-\angle(s_0-z_i)) - \sum (-\angle(s_0-p_j)) = - \angle L(s_0) $$
因为 $s_0$ 在根轨迹上，$\angle L(s_0) = (2k+1)\pi$。所以，$\angle L(s_0^*) = -(2k+1)\pi = (2(-k-1)+1)\pi$。这仍然是 $\pi$ 的一个奇数倍。因此，$s_0^*$ 也必须在根轨迹上。这个论证可以扩展到包含[共轭极点](@entry_id:166341)/零点对的情况，从而证明了[根轨迹的对称性](@entry_id:275090) [@problem_id:1618257]。

### 进阶主题与扩展

[相角条件](@entry_id:264793)不仅能用于基本分析，还能推导出[根轨迹绘制](@entry_id:267050)中的一些高级规则，并能被推广到更一般的情况。

#### 离开角与[到达角](@entry_id:265527)

当根轨迹从一个[多重极点](@entry_id:170417)出发或汇入一个多重零点时，其轨[迹线](@entry_id:261720)的[切线](@entry_id:268870)方向，即**离开角 (Angle of Departure)** 或 **[到达角](@entry_id:265527) (Angle of Arrival)**，可以通过在[多重极点](@entry_id:170417)/零点附近应用[相角条件](@entry_id:264793)来确定。

考虑一个在 $p_d$ 处有 $m$ [重极点](@entry_id:262210)的系统。我们想求轨迹离开此点的角度 $\theta_{dep}$。我们选择一个无限接近 $p_d$ 的测试点 $s = p_d + \epsilon e^{j\theta_{dep}}$，其中 $\epsilon \to 0$。对于这个测试点，$s-p_d$ 这一项贡献了 $m$ 次，总[相角](@entry_id:274491)为 $-m\theta_{dep}$。而所有其他[极点和零点](@entry_id:262457)对[相角](@entry_id:274491)的贡献可以近似看作它们到 $p_d$ 点的贡献。因此，[相角条件](@entry_id:264793)变为：
$$ \sum_{i} \angle(p_d - z_i) - \sum_{j, p_j \neq p_d} \angle(p_d - p_j) - m\theta_{dep} = (2k+1)\pi $$
我们可以从此方程解出 $\theta_{dep}$。

例如，对于系统 $G(s) = K \frac{s+3}{(s+1)^2}$，它在 $s=-1$ 处有一个二[重极点](@entry_id:262210) ($m=2$)，在 $s=-3$ 处有一个零点。离开角 $\theta$ 可由以下方程确定：
$$ \angle(-1 - (-3)) - 2\theta = (2k+1)180^\circ $$
$$ \angle(2) - 2\theta = (2k+1)180^\circ $$
$$ 0^\circ - 2\theta = (2k+1)180^\circ \implies \theta = -(2k+1)90^\circ $$
取 $k=0$ 和 $k=1$，我们得到两个离开角：$\theta = -90^\circ$ 和 $\theta = -270^\circ \equiv 90^\circ$。这意味着两条轨迹将分别垂直向上和垂直向下离开双极点 [@problem_id:1618302]。

#### 渐近线

当增益 $K \to \infty$ 时，[根轨迹](@entry_id:272958)的分支会趋向于无穷远处。这些分支的路径可以用**渐近线 (Asymptotes)** 来描述。对于一个远离原点的测试点 $s$，所有有限的[开环极点和零点](@entry_id:276317)看起来都像是聚集在一个点上。在这种情况下，[相角条件](@entry_id:264793)可以近似，并用于推导[渐近线](@entry_id:141820)的角度。对于一个有 $n$ 个极点和 $m$ 个零点的系统，[渐近线](@entry_id:141820)的角度由下式给出：
$$ \theta_a = \frac{(2k+1)\pi}{n-m} $$
例如，一个具有三个极点（$n=3$）和零个零点（$m=0$）的系统，如 $L(s) = \frac{K}{s(s+1)(s+2)}$，其渐近线角度为 $\pm \pi/3$ 和 $\pi$ (即 $\pm 60^\circ, 180^\circ$)。这意味着在远离原点的区域，根轨迹将沿着这三个方向延伸。我们可以通过计算验证，一个位于[渐近线](@entry_id:141820)方向上的远点，如 $s_c = 5 - j5\sqrt{3}$（其[相角](@entry_id:274491)为 $-60^\circ$），确实近似满足[相角条件](@entry_id:264793) [@problem_id:1618278]。

#### 广义[根轨迹](@entry_id:272958)

[相角条件](@entry_id:264793)的概念可以自然地扩展到非标准情况。

**补根轨迹 ($K<0$)**

如果增益 $K$ 是一个负实数，那么 $K = -|K|$。特征方程 $L(s) = -1/K$ 变为 $L(s) = 1/|K|$。此时，方程的右边是一个正实数。一个正实数的[相角](@entry_id:274491)是 $2\pi$ 的整数倍。因此，对于负增益的**补[根轨迹](@entry_id:272958) (Complementary Root Locus)**，[相角条件](@entry_id:264793)变为：
$$ \angle L(s) = 2k\pi, \quad k \in \mathbb{Z} $$
这个条件与标准根轨迹的条件正好相差 $\pi$。这意味着，[实轴](@entry_id:148276)上属于标准[根轨迹](@entry_id:272958)的区段不属于补[根轨迹](@entry_id:272958)，反之亦然 [@problem_id:1568749]。

**复数增益 ($K = |K|e^{j\phi_K}$)**

在更一般的情况下，增益 $K$ 本身可以是一个具有[固定相](@entry_id:168149)角 $\phi_K$ 的复数。此时，特征方程 $L(s) = -1/K$ 变为：
$$ L(s) = -\frac{1}{|K|e^{j\phi_K}} = \frac{1}{|K|} e^{-j\phi_K} e^{j\pi} $$
此时的广义[相角条件](@entry_id:264793)为：
$$ \angle L(s) = \pi - \phi_K + 2k\pi $$
这个强大的推广允许我们分析具有复数或有时变增益的系统。例如，考虑一个系统 $G(s) = 1/s^2$，其增益的[相角](@entry_id:274491)固定为 $\phi_K = +90^\circ$ ($\pi/2$) [@problem_id:1618322]。广义[相角条件](@entry_id:264793)变为：
$$ \angle G(s) = \pi - \frac{\pi}{2} = \frac{\pi}{2} $$
由于 $\angle G(s) = \angle(1/s^2) = -2\angle s$，我们有：
$$ -2\angle s = \frac{\pi}{2} + 2k\pi \implies \angle s = -\frac{\pi}{4} - k\pi $$
取 $k=0$ 和 $k=-1$，我们得到两个解：$\angle s = -45^\circ$ 和 $\angle s = 135^\circ$。这表明，根轨迹由两条从原点出发、分别成 $-45^\circ$ 和 $135^\circ$ 角的直线组成。

通过本章的学习，我们看到[相角条件](@entry_id:264793)不仅是绘制根轨迹的基本规则，更是一个深刻而灵活的分析工具，它将代数的特征方程与复平面的几何直觉紧密地联系在一起。