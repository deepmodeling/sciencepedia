{"hands_on_practices": [{"introduction": "从系统的开环传递函数计算稳定裕度是频域分析的基石。第一个练习将引导你完成计算相位裕度的基本步骤，这是一个量化系统距离不稳定状态有多近的关键指标。通过这个机器人臂的例子[@problem_id:1613054]，你将巩固对增益交越频率及其与相位关系的理解。", "problem": "一位工程师正在分析一个机器人手臂单个关节的单位反馈控制系统的稳定性。关联电机指令信号与关节最终角位置的开环传递函数 $G(s)$ 已被建模为：\n$$G(s) = \\frac{K}{s(1 + \\tau s)}$$\n该模型代表一个带理想积分器（源于电机将速度指令转换为位置）和时间常数为 $\\tau$ 的一阶滞后环节（代表电机的综合电气和机械动态特性）的系统。\n\n对于所考虑的特定系统，增益常数为 $K = 10.0 \\text{ s}^{-1}$，时间常数为 $\\tau = 0.01 \\text{ s}$。\n\n为确保系统稳定并具有足够的性能，工程师需要确定其稳定裕度。计算该系统的相位裕度。答案以度为单位表示，并四舍五入到三位有效数字。", "solution": "对于开环传递函数为 $L(s)=G(s)$ 的单位反馈系统，相位裕度在增益交越频率 $\\omega_{gc}$ 处进行评估，该频率满足 $|L(j\\omega_{gc})|=1$。相位裕度（以弧度为单位）由下式给出：\n$$\\text{PM}=\\pi+\\arg\\{L(j\\omega_{gc})\\}.$$\n\n给定\n$$G(s)=\\frac{K}{s(1+\\tau s)},$$\n频域中的环路传递函数为\n$$L(j\\omega)=\\frac{K}{j\\omega\\left(1+j\\omega\\tau\\right)}.$$\n\n其幅值和相位为\n$$|L(j\\omega)|=\\frac{K}{\\omega\\sqrt{1+(\\omega\\tau)^{2}}}, \\quad \\arg\\{L(j\\omega)\\}=-\\frac{\\pi}{2}-\\arctan(\\omega\\tau).$$\n\n增益交越频率 $\\omega_{gc}$ 满足\n$$\\frac{K}{\\omega_{gc}\\sqrt{1+(\\omega_{gc}\\tau)^{2}}}=1.$$\n令 $x=\\omega_{gc}\\tau$ 和 $a=K\\tau$。那么 $\\omega_{gc}=x/\\tau$，方程变为\n$$\\frac{a}{x\\sqrt{1+x^{2}}}=1 \\;\\;\\Longrightarrow\\;\\; x\\sqrt{1+x^{2}}=a.$$\n两边平方并令 $y=x^{2}$，得到\n$$x^{2}(1+x^{2})=a^{2}\\;\\;\\Longrightarrow\\;\\; y^{2}+y-a^{2}=0.$$\n对 $y\\ge 0$ 求解该二次方程，\n$$y=\\frac{-1+\\sqrt{1+4a^{2}}}{2}, \\quad x=\\sqrt{y}=\\sqrt{\\frac{-1+\\sqrt{1+4a^{2}}}{2}}.$$\n\n在 $\\omega_{gc}$ 处，相位为 $\\arg\\{L(j\\omega_{gc})\\}=-\\frac{\\pi}{2}-\\arctan(x)$，因此相位裕度（以弧度为单位）为\n$$\\text{PM}=\\pi+\\left(-\\frac{\\pi}{2}-\\arctan(x)\\right)=\\frac{\\pi}{2}-\\arctan(x),$$\n以度为单位则为，\n$$\\text{PM}_{\\text{deg}}=90-\\left(\\frac{180}{\\pi}\\right)\\arctan(x), \\quad x=\\sqrt{\\frac{-1+\\sqrt{1+4(K\\tau)^{2}}}{2}}.$$\n\n对于 $K=10.0\\,\\text{s}^{-1}$ 和 $\\tau=0.01\\,\\text{s}$，$a=K\\tau=0.1$，因此\n$$y=\\frac{-1+\\sqrt{1+4(0.1)^{2}}}{2}=\\frac{-1+\\sqrt{1.04}}{2}\\approx 0.009901951,$$\n$$x=\\sqrt{y}\\approx 0.0995085.$$\n于是\n$$\\arctan(x)\\approx 0.09919\\ \\text{rad}\\approx 5.6823\\ \\text{degrees},$$\n所以\n$$\\text{PM}_{\\text{deg}}\\approx 90-5.6823=84.3177.$$\n四舍五入到三位有效数字，相位裕度为 $84.3$ 度。", "answer": "$$\\boxed{84.3}$$", "id": "1613054"}, {"introduction": "稳定裕度不仅是诊断工具，更是控制器设计的核心。本练习将展示如何利用增益裕度来确定能使闭环系统保持稳定的最大比例增益 $K$。这个关于主动悬架系统的实际问题[@problem_id:1613060]揭示了频率响应特性与控制器整定之间的直接联系。", "problem": "一个工程团队正在为一种特种车辆设计主动悬挂系统。该系统被建模为一个单位负反馈控制回路。一个增益为正数 $K$ 的比例控制器根据行驶高度误差产生校正力。代表车辆对此力动态响应的受控对象，其传递函数为 $G(s)$。\n\n对受控对象 $G(s)$ 进行了频率响应分析，得出以下关键特性：\n1. 受控对象是一个最小相位系统，意味着它在s平面的右半部分没有极点或零点。\n2. 对于较小的正增益 $K$ 值，已知闭环系统是稳定的。\n3. 存在一个单一、唯一的角频率，记为相位穿越频率 $\\omega_{pc}$，在该频率下 $G(j\\omega)$ 的相移恰好为 $-180^\\circ$。测得该频率为 $\\omega_{pc} = 25.0$ rad/s。\n4. 在这个特定的相位穿越频率下，测得受控对象的频率响应幅值为 $|G(j\\omega_{pc})| = 0.080$。\n\n根据这些信息，确定使闭环系统保持稳定的增益 $K$ 的最大值。", "solution": "单位负反馈系统的稳定性可以使用开环传递函数 $L(s) = K G(s)$ 来分析。稳定性边界由 Nyquist 稳定判据确定。对于一个处于不稳定性临界的系统，其 $L(j\\omega)$ 的 Nyquist 图必须穿过复平面上的临界点 $(-1, 0)$。\n\n这个条件意味着必须同时满足两个要求：\n1. 开环传递函数的幅值必须为1：$|L(j\\omega)| = 1$。\n2. 开环传递函数的相位必须为 $-180^\\circ$：$\\angle L(j\\omega) = -180^\\circ$。\n\n我们首先分析相位条件。开环传递函数为 $L(s) = K G(s)$。由于增益 $K$ 是一个正实数，其相位为 $0^\\circ$。因此，开环系统的相位等于受控对象的相位：\n$$\n\\angle L(j\\omega) = \\angle (K G(j\\omega)) = \\angle K + \\angle G(j\\omega) = 0^\\circ + \\angle G(j\\omega) = \\angle G(j\\omega)\n$$\n开环相位为 $-180^\\circ$ 时的频率是相位穿越频率 $\\omega_{pc}$。根据问题描述，这发生在 $\\omega_{pc} = 25.0$ rad/s 处，此时 $\\angle G(j\\omega_{pc}) = -180^\\circ$。\n\n现在，我们在这个特定频率下应用幅值条件。当 $|L(j\\omega_{pc})| = 1$ 时，系统处于稳定性的临界状态。我们可以将开环传递函数的幅值表示为：\n$$\n|L(j\\omega_{pc})| = |K G(j\\omega_{pc})| = K |G(j\\omega_{pc})|\n$$\n将系统置于不稳定性临界的增益 $K$ 的值是稳定性的最大可能增益，我们称之为 $K_{max}$。将幅值设为1，得到：\n$$\nK_{max} |G(j\\omega_{pc})| = 1\n$$\n解出 $K_{max}$，我们得到：\n$$\nK_{max} = \\frac{1}{|G(j\\omega_{pc})|}\n$$\n问题给出了在相位穿越频率下受控对象的响应幅值：$|G(j\\omega_{pc})| = 0.080$。\n\n将此值代入我们关于 $K_{max}$ 的表达式中：\n$$\nK_{max} = \\frac{1}{0.080}\n$$\n为了计算该值，我们可以将 $0.080$ 写成分数形式：$0.080 = \\frac{80}{1000} = \\frac{8}{100} = \\frac{2}{25}$。\n$$\nK_{max} = \\frac{1}{\\frac{2}{25}} = \\frac{25}{2} = 12.5\n$$\n由于系统在 $K$ 值较小时是稳定的，并且只有一个相位穿越频率，因此系统在 $0  K  K_{max}$ 的整个增益范围内都是稳定的。因此，使闭环系统保持稳定的增益 $K$ 的最大值为 12.5。", "answer": "$$\\boxed{12.5}$$", "id": "1613060"}, {"introduction": "虽然增益和相位裕度的概念非常强大，但在应用于复杂系统时必须谨慎。最后一个练习探讨了一个具有多个增益交越频率的场景，在这种情况下，对相位裕度的简单解读可能会产生误导。通过分析这个化学反应器模型[@problem_id:1612996]，你将学会通过考察系统在相位交越频率处的行为来更稳健地评估稳定性，从而加深对奈奎斯特稳定判据的理解。", "problem": "一位控制工程师正在设计一个单位负反馈系统，以调节一种新型化学反应器的温度。系统的开环传递函数用 $G(s)$ 表示。由于复杂的热动力学和传输延迟，开环频率响应 $G(j\\omega)$ 的伯德图表现出非标准行为。频率响应分析揭示了以下关键特征：\n\n- $G(j\\omega)$ 的幅值图在两个不同的角频率处穿过0 dB线：$\\omega_{c1} = 10 \\text{ rad/s}$ 和 $\\omega_{c2} = 100 \\text{ rad/s}$。\n- 系统在这些频率下的相位为 $\\angle G(j\\omega_{c1}) = -150^\\circ$ 和 $\\angle G(j\\omega_{c2}) = -210^\\circ$。\n- $G(j\\omega)$ 的相位图在一个称为相位交越频率的单一角频率处穿过 $-180^\\circ$ 线，该频率为 $\\omega_{p} = 40 \\text{ rad/s}$。\n\n闭环系统的稳定性将使用相位裕度进行评估。相位裕度（PM）定义为 $PM = 180^\\circ + \\phi$，其中 $\\phi$ 是相关幅值交越频率处的相位角。下列哪个陈述正确地指出了系统的稳定性及其原因？\n\nA. 系统是稳定的，因为在 $\\omega_{c1}$ 处计算的相位裕度为正。\n\nB. 系统是稳定的，因为在低频和高频下增益小于 0 dB。\n\nC. 系统是不稳定的，因为在这种情况下，在 $\\omega_{c1}$ 处计算的相位裕度不是一个有效的稳定性指标。\n\nD. 系统是不稳定的，因为在相位交越频率 $\\omega_{p}$ 处，开环传递函数的幅值大于1（或 0 dB）。\n\nE. 系统是临界稳定的，因为存在多个幅值交越频率。\n\nF. 根据所提供的信息无法确定稳定性。", "solution": "我们考虑一个单位负反馈回路，其开环传递函数为 $G(s)$，频率响应为 $G(j\\omega)$。幅值交越频率由 $|G(j\\omega_{c})|=1$（即 $0$ dB）定义，在幅值交越频率 $\\omega_{c}$ 处的相位裕度为 $PM=180^{\\circ}+\\angle G(j\\omega_{c})$。相位交越频率 $\\omega_{p}$ 由 $\\angle G(j\\omega_{p})=-180^{\\circ}$ 定义。闭环稳定性可以通过相关幅值交越频率处的相位裕度来评估，或者等效地，通过相位交越频率处的幅值裕度来评估。具体来说，在 $\\omega_{p}$ 处，如果 $|G(j\\omega_{p})|>1$（即幅值大于 $0$ dB），则幅值裕度为负，闭环系统不稳定（根据奈奎斯特判据，对于单位反馈且无开环右半平面极点的情况）。\n\n给定数据：\n- 幅值交越频率：$\\omega_{c1}=10$ 和 $\\omega_{c2}=100$，相位分别为 $\\angle G(j\\omega_{c1})=-150^{\\circ}$ 和 $\\angle G(j\\omega_{c2})=-210^{\\circ}$。\n- 相位交越频率：$\\omega_{p}=40$，相位为 $\\angle G(j\\omega_{p})=-180^{\\circ}$。\n\n步骤1：计算两个幅值交越频率处的相位裕度（以凸显存在多个交越点时的模糊性）。\n在 $\\omega_{c1}$ 处，\n$$\nPM_{1}=180^{\\circ}+(-150^{\\circ})=30^{\\circ}>0.\n$$\n在 $\\omega_{c2}$ 处，\n$$\nPM_{2}=180^{\\circ}+(-210^{\\circ})=-30^{\\circ}0.\n$$\n因此，仅使用 $\\omega_{c1}$ 会误导性地表明系统稳定，而使用 $\\omega_{c2}$ 则表明系统不稳定。因此，在存在多个幅值交越频率时，较低交越频率处的相位裕度本身不是一个可靠的指标。\n\n步骤2：确定在相位交越频率 $\\omega_{p}=40$ 处的幅值。\n设 $M(\\omega)=20\\log_{10}|G(j\\omega)|$ 表示以dB为单位的伯德幅值。我们已知 $M(\\omega_{c1})=0$ 和 $M(\\omega_{c2})=0$。对于可实现的（真或严格真）物理系统，当 $\\omega\\to\\infty$ 时 $|G(j\\omega)|\\to 0$，所以\n$$\n\\lim_{\\omega\\to\\infty}M(\\omega)=-\\infty0.\n$$\n根据 $M(\\omega)$ 的连续性以及 $M(\\omega)=0$ 恰好在两个不同频率 $\\omega_{c1}$ 和 $\\omega_{c2}$ 处成立的事实，可以推断出：\n- 对于 $\\omega>\\omega_{c2}$，$M(\\omega)0$。\n- 因此，在区间 $(\\omega_{c1},\\omega_{c2})$ 内，幅值必须大于 $0$ dB，即 $M(\\omega)>0$。\n由于 $\\omega_{p}=40$ 严格位于 $\\omega_{c1}=10$ 和 $\\omega_{c2}=100$ 之间，我们得出结论\n$$\nM(\\omega_{p})>0 \\quad\\Longleftrightarrow\\quad |G(j\\omega_{p})|>1.\n$$\n\n步骤3：根据相位交越点处的增益判断稳定性。\n在 $\\omega_{p}$ 处，相位恰好为 $-180^{\\circ}$ 且幅值满足 $|G(j\\omega_{p})|>1$。这意味着幅值裕度为负。对于一个没有开环右半平面极点的单位负反馈回路，奈奎斯特图在大于1的半径处穿过负实轴，导致对临界点-1的顺时针包围，因此闭环系统不稳定。因此，正确的稳定性评估是：系统不稳定，因为在相位交越频率处幅值大于1。\n\n在给定的选项中，这与陈述D完全对应。陈述A因存在多个幅值交越频率而无效；陈述C指出了在 $\\omega_{c1}$ 处的相位裕度不是有效指标，但它没有提供正确的具体原因，而D提供了。陈述B、E和F基于上述理由是错误的，并且也因为所提供的信息足以通过 $\\omega_{p}$ 处的负幅值裕度来断定系统不稳定。", "answer": "$$\\boxed{D}$$", "id": "1612996"}]}