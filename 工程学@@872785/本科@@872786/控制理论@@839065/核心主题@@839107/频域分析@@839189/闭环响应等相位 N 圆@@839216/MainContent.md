## 引言
在[控制系统工程](@entry_id:263856)中，理解开环频率特性如何决定[闭环系统](@entry_id:270770)的性能是至关重要的一环。直接从[开环传递函数](@entry_id:276280) $G(j\omega)$ 的每一个点代数计算闭环响应 $T(j\omega)$ 的相位，过程可能既繁琐又不直观，这为系统的快速分析与迭代设计带来了挑战。为了解决这一问题，控制理论发展出了一系列强大的图形化工具，其中，N圆（N-circles）提供了一种优雅的方法，能够直观地揭示开环与[闭环相位](@entry_id:272552)之间的几何关系。

本文旨在系统地阐述N圆的理论与实践。通过学习本文，您将能够：首先，在“原理与机制”一章中，深入理解N圆的数学推导过程和其关键的几何特性；其次，在“应用与跨学科联系”一章中，探索如何将N圆应用于实际的系统性能分析、[控制器设计](@entry_id:274982)，并了解其在[鲁棒控制](@entry_id:260994)和[数字控制](@entry_id:275588)等高级领域的延伸；最后，通过“动手实践”部分提供的练习，巩固所学知识并将其付诸实践。让我们从N圆的基本原理开始，揭示其在[频域分析](@entry_id:265642)中的奥秘。

## 原理与机制

在对单位负[反馈控制系统](@entry_id:274717)进行[频率响应分析](@entry_id:272367)时，一个核心任务是理解[开环频率响应](@entry_id:267477) $G(j\omega)$ 与[闭环频率响应](@entry_id:273935) $T(j\omega)$ 之间的关系。[闭环传递函数](@entry_id:275480)由下式给出：

$$T(j\omega) = \frac{G(j\omega)}{1+G(j\omega)}$$

开环响应 $G(j\omega)$ 是一个随频率 $\omega$ 变化的复数，可以在复平面（通常称为 $G$ 平面或奈奎斯特平面）上绘制出其轨迹，即[奈奎斯特图](@entry_id:264096)。$G(j\omega)$ 的每一个点都唯一地决定了对应频率下闭环响应 $T(j\omega)$ 的幅度和相位。为了系统地、图形化地分析这种关系，我们研究 $G$ 平面中对应恒定闭环特性的点的轨迹。本章重点讨论对应恒定[闭环相位](@entry_id:272552)角的轨迹，即所谓的 **N圆（N-circles）**。

### 恒定[闭环相位](@entry_id:272552)的轨迹推导

我们的目标是找出在 $G$ 平面上，所有使得闭环响应 $T(j\omega)$ 的相位角 $\phi = \arg[T(j\omega)]$ 保持恒定的点 $(x, y)$ 的集合。令[开环频率响应](@entry_id:267477)为 $G(j\omega) = x + iy$。

首先，我们将[闭环传递函数](@entry_id:275480) $T(j\omega)$ 表示为其实部和虚部的形式：

$$T(j\omega) = \frac{x + iy}{1 + (x + iy)} = \frac{x + iy}{(1+x) + iy}$$

为了分离实部和虚部，我们将分子和分母同时乘以分母的共轭复数 $((1+x) - iy)$：

$$T(j\omega) = \frac{(x + iy)((1+x) - iy)}{((1+x) + iy)((1+x) - iy)} = \frac{x(1+x) - ixy + iy(1+x) - i^2y^2}{(1+x)^2 + y^2}$$

整理分子，并利用 $i^2 = -1$，可得：

$$T(j\omega) = \frac{(x^2 + x + y^2) + i(y + xy - xy)}{(1+x)^2 + y^2} = \frac{x^2 + x + y^2}{(1+x)^2 + y^2} + i \frac{y}{(1+x)^2 + y^2}$$

因此，闭环响应的实部 $\Re\{T\}$ 和虚部 $\Im\{T\}$ 分别为：

$$\Re\{T\} = \frac{x^2 + x + y^2}{(1+x)^2 + y^2}$$

$$\Im\{T\} = \frac{y}{(1+x)^2 + y^2}$$

闭环[相角](@entry_id:274491) $\phi$ 由 $\tan(\phi) = \frac{\Im\{T\}}{\Re\{T\}}$ 决定。我们引入一个参数 **$N$**，定义为 **$N = \tan(\phi)$**。于是，恒定相位的条件可以表示为：

$$N = \frac{\frac{y}{(1+x)^2 + y^2}}{\frac{x^2 + x + y^2}{(1+x)^2 + y^2}} = \frac{y}{x^2 + x + y^2}$$

假设分母不为零，我们可以将上式整理为：

$$N(x^2 + x + y^2) = y$$

当 $N \neq 0$ 时，两边同除以 $N$ 并移项，得到：

$$x^2 + x + y^2 - \frac{1}{N}y = 0$$

为了揭示该方程的几何意义，我们采用[配方法](@entry_id:265480)将其转换为[圆的标准方程](@entry_id:164169)。对 $x$ 和 $y$ 项分别配方：

$$(x^2 + x + (\frac{1}{2})^2) - (\frac{1}{2})^2 + (y^2 - \frac{1}{N}y + (\frac{1}{2N})^2) - (\frac{1}{2N})^2 = 0$$

$$\left(x + \frac{1}{2}\right)^2 + \left(y - \frac{1}{2N}\right)^2 = \frac{1}{4} + \frac{1}{4N^2}$$

这是一个[圆的方程](@entry_id:169149)，其圆心和半径为：

**圆心**： $(x_c, y_c) = \left(-\frac{1}{2}, \frac{1}{2N}\right)$

**半径**： $R = \sqrt{\frac{1}{4} + \frac{1}{4N^2}} = \frac{1}{2}\sqrt{1 + \frac{1}{N^2}}$

这个结果表明，对于任意给定的非零闭环[相角](@entry_id:274491) $\phi$（对应一个非零的 $N$ 值），所有能够产生该[相角](@entry_id:274491)的开环响应点 $G(j\omega)$ 构成了 $G$ 平面上的一个圆。这一系列的圆被称为 **N圆**。

举例来说，让我们确定闭环[相角](@entry_id:274491)为 $\phi = -45^\circ$ 时对应的N圆。此时，$N = \tan(-45^\circ) = -1$。代入上述公式，我们得到圆心和半径 [@problem_id:1594796]：

圆心： $(x_c, y_c) = \left(-\frac{1}{2}, \frac{1}{2(-1)}\right) = \left(-\frac{1}{2}, -\frac{1}{2}\right)$

半径： $R = \frac{1}{2}\sqrt{1 + \frac{1}{(-1)^2}} = \frac{1}{2}\sqrt{2} = \frac{\sqrt{2}}{2}$

同样，对于 $\phi = -30^\circ$ 的情况，$N = \tan(-30^\circ) = -\frac{1}{\sqrt{3}}$。对应的N圆圆心为 $(-\frac{1}{2}, -\frac{\sqrt{3}}{2})$，半径为 $1$ [@problem_id:1594775]。

### N圆的几何特性

N圆家族具有一系列显著的几何特性，这些特性对于理解和使用它们至关重要。

#### 公共交点

所有N圆（对于任意非零实数 $N$）都通过两个固定的点。从N[圆方程](@entry_id:167379) $x^2 + x + y^2 - \frac{y}{N} = 0$ 可以看出，如果存在不依赖于 $N$ 的解，那么这些解必须满足该方程。我们可以通过考察两个不同参数 $N_1$ 和 $N_2$ 对应的圆的交点来找到这些公共点：
$x^2 + x + y^2 - \frac{y}{N_1} = 0$
$x^2 + x + y^2 - \frac{y}{N_2} = 0$

两式相减得到：
$y\left(\frac{1}{N_2} - \frac{1}{N_1}\right) = 0$
由于 $N_1 \neq N_2$，括号内的项不为零，因此必有 $y=0$。将 $y=0$ 代回任意一个N[圆方程](@entry_id:167379)，得到：
$x^2 + x = 0 \implies x(x+1) = 0$
解得 $x=0$ 或 $x=-1$。

因此，所有N圆都精确地通过两个点：**$(0, 0)$** 和 **$(-1, 0)$** [@problem_id:1594777]。这两个点在控制理论中具有特殊意义：
-   点 $(0, 0)$ 对应 $G(j\omega) = 0$，此时 $T(j\omega) = 0$，其相位未明确定义，但该点是所有N圆的公共[边界点](@entry_id:176493)。
-   点 $(-1, 0)$ 对应 $G(j\omega) = -1$，这是[奈奎斯特稳定性判据](@entry_id:273425)中的[临界点](@entry_id:144653)。在此点，$1+G(j\omega)=0$，使得[闭环增益](@entry_id:275610)无穷大，相位也无定义。

#### 圆心轨迹与半径变化

N圆的圆心坐标为 $(-\frac{1}{2}, \frac{1}{2N})$。当参数 $N$ 取遍所有非零实数时，圆心的横坐标始终为 $-\frac{1}{2}$，而纵坐标 $\frac{1}{2N}$ 则可以取遍所有非零实数。因此，**所有N圆的圆心都位于垂直直线 $x = -1/2$ 上** [@problem_id:1594819]。

N圆的半径 $R = \frac{1}{2}\sqrt{1 + \frac{1}{N^2}}$ 的行为也很有规律 [@problem_id:1594783]：
-   当 $|N| \to 0$ 时（即 $\phi \to 0^\circ$ 或 $\pm 180^\circ$），$1/N^2 \to \infty$，导致半径 $R \to \infty$。这意味着N圆趋近于一条直线。
-   当 $|N| \to \infty$ 时（即 $\phi \to \pm 90^\circ$），$1/N^2 \to 0$，导致半径 $R \to \frac{1}{2}$。

总结来说，随着[闭环相位](@entry_id:272552)的[绝对值](@entry_id:147688)从 $0^\circ$ 增加到 $90^\circ$（$|N|$ 从 $0$ 增加到 $\infty$），N圆的半径从无穷大减小并趋近于极限值 $1/2$。

#### 对称性

考虑一对相位角互为[相反数](@entry_id:151709)的N圆，即 $\phi = \alpha$ 和 $\phi = -\alpha$（其中 $0  \alpha  \pi/2$）。对应的参数为 $N_p = \tan(\alpha)$ 和 $N_n = \tan(-\alpha) = -\tan(\alpha)$。
-   对应 $\phi = \alpha$ 的圆 $C_p$ 的圆心为 $(-\frac{1}{2}, \frac{1}{2\tan\alpha})$。
-   对应 $\phi = -\alpha$ 的圆 $C_n$ 的圆心为 $(-\frac{1}{2}, -\frac{1}{2\tan\alpha})$。
它们的半径相等，因为半径表达式依赖于 $N^2$。显然，这两个圆的圆心关于实轴（$y=0$）对称 [@problem_id:1594820]。这反映了一个事实：如果开环系统 $G(s)$ 的系数是实数，那么其频率响应 $G(j\omega)$ 关于实轴[共轭对称](@entry_id:144131)。

### 简并情况：$N=0$

当闭环[相角](@entry_id:274491) $\phi=0^\circ$ 或 $\phi=\pm 180^\circ$ 时，$N=\tan(\phi)=0$。在这种情况下，N[圆的方程](@entry_id:169149) $N(x^2 + x + y^2) = y$ 变为 $y=0$。这意味着轨迹退化为 $G$ 平面上的[实轴](@entry_id:148276)，这是一个半径无穷大的极限情况。

然而，[实轴](@entry_id:148276)上的不同部分对应着不同的相位。为此，我们考察当 $G = x$ 为实数时闭环响应 $T = \frac{x}{1+x}$ 的符号：
-   **当 $T > 0$ 时，$\arg(T) = 0^\circ$**。不等式 $\frac{x}{1+x} > 0$ 成立的条件是 $x$ 和 $1+x$ 同号，即 $x>0$ 或 $x-1$。因此，实轴上的区间 $(-\infty, -1)$ 和 $(0, \infty)$ 构成了 $\phi=0^\circ$ 的轨迹。
-   **当 $T  0$ 时，$\arg(T) = \pm 180^\circ$**。不等式 $\frac{x}{1+x}  0$ 成立的条件是 $x$ 和 $1+x$ 异号，即 $-1  x  0$。因此，实轴上的开区间 $(-1, 0)$ 构成了 $\phi=\pm 180^\circ$ 的轨迹 [@problem_id:1594831]。

点 $x=0$ 和 $x=-1$ 是相位的跃变点，其相位未定义。

### 在[频率响应分析](@entry_id:272367)中的应用

N圆提供了一种强大的图形化工具，用于直接从开环[奈奎斯特图](@entry_id:264096)上读取或估计[闭环系统](@entry_id:270770)的相位特性，而无需进行繁琐的代数计算。通过将系统的[奈奎斯特图](@entry_id:264096) $G(j\omega)$ 叠加在一系列预先绘制好的N圆上（这构成了尼柯尔斯图的一部分），我们可以分析[闭环相位](@entry_id:272552)随频率的变化。

-   **确定[闭环相位](@entry_id:272552)**：如果奈奎斯特图在某个频率 $\omega_p$ 处通过点 $G(j\omega_p)$，那么该点所在的N圆就决定了该频率下的闭环[相角](@entry_id:274491) $\phi_p$。例如，若已知在 $\omega_p$ 时 $G(j\omega_p) = -0.800 - j0.900$，我们可以通过计算 $T(j\omega_p)$ 来求得[闭环相位](@entry_id:272552)。
    $T(j\omega_p) = \frac{-0.800 - j0.900}{1 + (-0.800 - j0.900)} = \frac{-0.800 - j0.900}{0.200 - j0.900} \approx 0.765 - j1.059$
    其相位角为 $\phi_p = \arctan(\frac{-1.059}{0.765}) \approx -54.2^\circ$。这意味着点 $(-0.800, -0.900)$ 位于标记为 $-54.2^\circ$ 的N圆上 [@problem_id:1594839]。

-   **确定N参数**：反过来，对于[奈奎斯特图](@entry_id:264096)上的任意一点 $G(j\omega_k) = x+iy$，我们可以计算出它所属的N圆的参数 $N$。利用公式 $N = \frac{y}{x^2+x+y^2}$，我们可以快速评估[闭环相位](@entry_id:272552)。例如，若奈奎斯特图通过点 $(-1.2 + j0.9)$，则对应的 $N$ 值为 [@problem_id:1594778]：
    $N = \frac{0.9}{(-1.2)^2 + (-1.2) + (0.9)^2} = \frac{0.9}{1.44 - 1.2 + 0.81} = \frac{0.9}{1.05} \approx 0.857$
    对应的闭环[相角](@entry_id:274491)为 $\phi = \arctan(0.857) \approx 40.6^\circ$。

### 与[等M圆](@entry_id:274800)的关系

除了N圆，另一族重要的轨迹是**[等M圆](@entry_id:274800)（M-circles）**，它们是[闭环幅值](@entry_id:267646) $|T(j\omega)| = M$ 保持恒定的轨迹。[M圆](@entry_id:272186)也是 $G$ 平面中的圆。一个深刻且优美的性质是，**N圆族和[M圆](@entry_id:272186)族在它们所有的交点处都是相互正交的**。

这种正交性源于复变函数理论中的一个基本事实。映射 $T(G) = \frac{G}{1+G}$ 是一个[保角映射](@entry_id:160824)（在其导数不为零的区域）。[保角映射](@entry_id:160824)的特性是保持角度不变。在 $T$ 平面中，[等幅值轨迹](@entry_id:270878)（以原点为中心的同心圆）和[等相位轨迹](@entry_id:260878)（从原点出发的射线）是处处正交的。由于映射是保角的，这些轨迹在 $G$ 平面中的原像（即[M圆](@entry_id:272186)和N圆）也必须保持正交性。

我们可以通过计算来验证这一点。例如，对于 $M=\sqrt{2}$ 的[M圆](@entry_id:272186)和 $N=1$ 的N圆，可以解出其交点之一为 $G_0 = -1 + j1$。[M圆](@entry_id:272186)的圆心为 $(-2, 0)$，N圆的圆心为 $(-\frac{1}{2}, \frac{1}{2})$。在交点 $G_0$ 处，连接该点与各自圆心的半径向量与[圆的切线](@entry_id:173370)垂直。可以证明，这两个半径向量是相互垂直的，从而证实了[M圆](@entry_id:272186)和N圆在此处的正交性 [@problem_id:1594804]。这一性质在构建尼柯尔斯图时尤为重要，因为它提供了一个清晰的[正交坐标](@entry_id:166074)网格，用于同时分析[闭环系统](@entry_id:270770)的幅值和相位响应。