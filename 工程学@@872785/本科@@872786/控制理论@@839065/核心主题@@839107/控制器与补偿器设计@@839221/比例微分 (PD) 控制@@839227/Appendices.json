{"hands_on_practices": [{"introduction": "在设计任何控制器时，首要任务是确保闭环系统的稳定性。本练习将引导你使用劳斯-赫尔维茨（Routh-Hurwitz）稳定性判据——一个强大的数学工具——来精确描绘PD控制系统的稳定与不稳定行为之间的边界。通过找到稳定边缘上比例增益 $K_p$ 和微分增益 $K_d$ 之间的关系[@problem_id:1602726]，你将对控制器的安全工作范围有基本的理解。", "problem": "正在分析一个用于小型卫星姿态控制的简化模型。该卫星使用比例-微分（PD）控制器来维持其姿态。闭环控制系统的稳定性由其特征方程决定，该方程取决于卫星的物理特性和控制器增益。\n\n特征方程由下式给出：\n$$s^3 + a s^2 + (b + K_d)s + (c + K_p) = 0$$\n此处，$s$ 是复频率变量。参数 $a$、$b$ 和 $c$ 是正常数，代表卫星及其执行器固有的动力学特性。$K_p$ 是比例增益，$K_d$ 是微分增益，它们是 PD 控制器的可调参数。\n\n为了使系统处于不稳定的临界状态，表现出持续振荡，增益 $K_p$ 和 $K_d$ 之间必须存在一种特定的关系。增益参数空间中的这个临界边界可以用形如 $K_p = m K_d + C$ 的线性方程来描述。\n\n确定该稳定性边界线的斜率 $m$ 和截距 $C$ 的表达式。表达式应以给定的正常数 $a, b, c$ 来表示。按顺序给出 $m$ 和 $C$ 的表达式作为你的答案。", "solution": "我们得到三次特征多项式\n$$s^{3} + a s^{2} + (b + K_{d}) s + (c + K_{p}) = 0.$$\n令 $A = a$，$B = b + K_{d}$，$D = c + K_{p}$，则多项式为 $s^{3} + A s^{2} + B s + D$。\n\n对于三次多项式 $s^{3} + A s^{2} + B s + D$，其 Routh 阵列为\n$$\n\\begin{array}{cc}\ns^{3}:  1 \\quad B \\\\\ns^{2}:  A \\quad D \\\\\ns^{1}:  \\dfrac{A B - D}{A} \\quad 0 \\\\\ns^{0}:  D\n\\end{array}\n$$\nRouth-Hurwitz 稳定性要求第一列的所有项均为正，即 $10$，$A0$，$\\dfrac{A B - D}{A}  0$ 和 $D0$。由于 $a$、$b$ 和 $c$ 均为正，我们有 $A = a  0$。具有持续振荡（纯虚根）的稳定性边界出现在 $s^{1}$ 行的第一列元素为零时：\n$$A B - D = 0.$$\n代入 $A = a$，$B = b + K_{d}$ 和 $D = c + K_{p}$ 可得\n$$a\\,(b + K_{d}) - (c + K_{p}) = 0.$$\n求解 $K_{p}$，\n$$K_{p} = a\\,(b + K_{d}) - c = a K_{d} + a b - c.$$\n该式具有 $K_{p} = m K_{d} + C$ 的形式，因此\n$$m = a, \\quad C = a b - c.$$", "answer": "$$\\boxed{\\begin{pmatrix} a  a b - c \\end{pmatrix}}$$", "id": "1602726"}, {"introduction": "尽管PD控制功能强大，但它无法违背物理定律。本练习将探讨一个具有挑战性的场景：控制一个非最小相位系统，该系统的特点是其初始响应与期望的输出方向相反。你将运用拉普拉斯变换的初值定理，来分析并量化这种被称为“下冲”的现象[@problem_id:1602752]，从而揭示一个无论如何调整PD参数都无法消除的根本性能限制。", "problem": "我们正在分析一个小型无人机（UAV）垂直高度控制的简化模型。由于复杂的气动相互作用，该系统表现出非最小相位行为。从电机控制信号 $U(s)$ 到产生的海拔高度变化 $Y(s)$ 的传递函数 $P(s)$ 由下式给出：\n$$P(s) = \\frac{A(z_0 - s)}{(s+p)^2}$$\n其中 $A$、$z_0$ 和 $p$ 是正常数，分别代表系统增益、非最小相位零点的位置和极点的位置。\n\n为了调节无人机的海拔高度，我们实现了一个比例-微分（PD）控制器。为防止期望海拔高度的阶跃变化引起大的控制信号尖峰，控制器的设计使其微分作用仅作用于测量的海拔高度，而不是整个误差信号。因此，控制信号 $U(s)$ 根据以下关系生成：\n$$U(s) = K_p(R(s) - Y(s)) - K_d s Y(s)$$\n其中 $R(s)$ 是期望的海拔高度参考信号，$K_p$ 是比例增益，$K_d$ 是微分增益。$K_p$ 和 $K_d$ 均为正常数。\n\n假设系统初始处于静止状态，在 $t=0$ 时施加一个单位阶跃指令作为期望海拔高度，即 $r(t)=u(t)$。确定无人机海拔高度变化的初始速度，$\\dot{y}(0^+) = \\lim_{t \\to 0^+} \\frac{dy(t)}{dt}$。请用参数 $A$、$p$、$z_0$、$K_p$ 和 $K_d$ 的闭式解析表达式给出你的答案。", "solution": "我们使用拉普拉斯域分析和导数的初值定理。在零初始条件下，初始斜率由下式给出\n$$\n\\dot{y}(0^{+})=\\lim_{t\\to 0^{+}}\\frac{dy(t)}{dt}=\\lim_{s\\to\\infty}s\\left[sY(s)-y(0)\\right]=\\lim_{s\\to\\infty}s^{2}Y(s),\n$$\n其中，由于系统初始静止且闭环系统是严格真分式的，因此 $y(0)=0$。\n\n被控对象为\n$$\nP(s)=\\frac{A(z_{0}-s)}{(s+p)^{2}},\n$$\n控制器法则是\n$$\nU(s)=K_{p}(R(s)-Y(s))-K_{d}sY(s).\n$$\n回路方程为 $Y(s)=P(s)U(s)$，所以\n$$\nY(s)=P(s)\\left[K_{p}R(s)-(K_{p}+K_{d}s)Y(s)\\right].\n$$\n因此，\n$$\nY(s)\\left[1+P(s)\\left(K_{p}+K_{d}s\\right)\\right]=P(s)K_{p}R(s),\n$$\n从 $R$ 到 $Y$ 的闭环传递函数为\n$$\nT(s)\\equiv\\frac{Y(s)}{R(s)}=\\frac{P(s)K_{p}}{1+P(s)\\left(K_{p}+K_{d}s\\right)}.\n$$\n对于单位阶跃输入，$R(s)=\\frac{1}{s}$，所以 $Y(s)=\\frac{T(s)}{s}$ 且\n$$\n\\dot{y}(0^{+})=\\lim_{s\\to\\infty}s^{2}\\frac{T(s)}{s}=\\lim_{s\\to\\infty}s\\,T(s).\n$$\n代入 $P(s)$：\n$$\nT(s)=\\frac{A K_{p}(z_{0}-s)/(s+p)^{2}}{1+\\frac{A(z_{0}-s)}{(s+p)^{2}}(K_{p}+K_{d}s)}\n=\\frac{A K_{p}(z_{0}-s)}{(s+p)^{2}+A(z_{0}-s)(K_{p}+K_{d}s)}.\n$$\n展开分母：\n$$\n(s+p)^{2}+A(z_{0}-s)(K_{p}+K_{d}s)\n=s^{2}+2ps+p^{2}+A(z_{0}K_{p}+z_{0}K_{d}s-K_{p}s-K_{d}s^{2})\n$$\n$$\n=(1-AK_{d})s^{2}+\\left(2p+A z_{0}K_{d}-A K_{p}\\right)s+\\left(p^{2}+A z_{0}K_{p}\\right).\n$$\n分子是\n$$\nA K_{p}(z_{0}-s)=-A K_{p}s+A K_{p}z_{0}.\n$$\n因此，\n$$\ns\\,T(s)=\\frac{s\\left(-A K_{p}s+A K_{p}z_{0}\\right)}{(1-AK_{d})s^{2}+\\left(2p+A z_{0}K_{d}-A K_{p}\\right)s+\\left(p^{2}+A z_{0}K_{p}\\right)}.\n$$\n当 $s\\to\\infty$ 时取极限，并比较最高次幂的系数，\n$$\n\\dot{y}(0^{+})=\\lim_{s\\to\\infty}s\\,T(s)=\\frac{-A K_{p}}{1-A K_{d}},\n$$\n前提是 $1-AK_{d}\\neq 0$。这个结果也可以直接从高频近似 $P(s)\\sim -A/s$ (当 $s\\to\\infty$ 时) 得出，这意味着 $\\dot{y}(0^{+})=-A\\,u(0^{+})$，并且利用 $u(0^{+})=K_{p}-K_{d}\\dot{y}(0^{+})$ 求解 $\\dot{y}(0^{+})$ 可以得到相同的表达式。", "answer": "$$\\boxed{-\\frac{A K_{p}}{1-A K_{d}}}$$", "id": "1602752"}, {"introduction": "PD控制器中的微分项（D项）旨在提供阻尼并改善稳定性。然而，本练习揭示了一个关键的现实悖论：过度的微分作用可能反而导致系统失稳。我们将分析在实际物理系统中，当我们的数学模型忽略了高频共振模态时，增加微分增益 $K_d$ 会如何放大这些“寄生”动态，最终导致整个闭环系统走向不稳定[@problem_id:1602753]。", "problem": "一位控制工程师正在为单关节机械臂设计一个比例-微分（PD）控制器。最初使用了一个简化的机械臂动力学模型，将其表示为一个标准的二阶系统。这个简化对象的传递函数为：\n$$ P_{simple}(s) = \\frac{1}{s^2 + s + 1} $$\n然而，实际的物理系统具有一个在简化模型中被忽略的高频、轻阻尼的结构共振。实际对象的更精确的传递函数由下式给出：\n$$ P_{actual}(s) = \\left(\\frac{1}{s^2 + s + 1}\\right) \\left(\\frac{\\omega_r^2}{s^2 + 2\\zeta_r \\omega_r s + \\omega_r^2}\\right) $$\n其中第二项为寄生共振建模。\n\n传递函数为 $C(s) = K_p + K_d s$ 的 PD 控制器与实际对象 $P_{actual}(s)$ 一起置于一个单位负反馈回路中。工程师选择的比例增益为 $K_p = 8$。观察到当微分增益为零（$K_d = 0$）时，闭环系统是稳定的。然而，增加微分增益 $K_d$ 可能会通过放大共振频率 $\\omega_r$ 处的响应而使系统失稳。\n\n给定寄生共振的参数为 $\\omega_r = 10 \\text{ rad/s}$ 和 $\\zeta_r = 0.05$，确定使闭环系统变为临界稳定的微分增益 $K_d$ 的最小正值。给出你的 $K_d$ 的答案，它是一个无量纲增益，结果保留三位有效数字。", "solution": "对于带有控制器 $C(s)=K_{p}+K_{d}s$ 和对象 $P_{actual}(s)$ 的单位负反馈，其闭环特征方程由 $1 + C(s)P_{actual}(s) = 0$ 得到。使用\n$$\nP_{actual}(s) = \\frac{1}{s^{2}+s+1}\\cdot\\frac{\\omega_{r}^{2}}{s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}},\n$$\n我们得到特征多项式\n$$\n\\Delta(s) = (s^{2}+s+1)(s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}) + \\omega_{r}^{2}(K_{p}+K_{d}s).\n$$\n展开乘积，\n$$\n(s^{2}+s+1)(s^{2}+2\\zeta_{r}\\omega_{r}s+\\omega_{r}^{2}) = s^{4} + (1+2\\zeta_{r}\\omega_{r})s^{3} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+1)s^{2} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r})s + \\omega_{r}^{2}.\n$$\n因此，\n$$\n\\Delta(s) = s^{4} + (1+2\\zeta_{r}\\omega_{r})s^{3} + (\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+1)s^{2} + \\bigl(\\omega_{r}^{2}+2\\zeta_{r}\\omega_{r}+\\omega_{r}^{2}K_{d}\\bigr)s + \\omega_{r}^{2}(1+K_{p}).\n$$\n代入 $\\omega_{r}=10$, $\\zeta_{r}=0.05$ 和 $K_{p}=8$ 得到\n$$\n\\Delta(s) = s^{4} + 2s^{3} + 102s^{2} + (101+100K_{d})s + 900.\n$$\n为了找到临界稳定时的最小正值 $K_{d}$，对四次多项式 $s^{4}+a_{1}s^{3}+a_{2}s^{2}+a_{3}s+a_{4}$（其中 $a_{1}=2$, $a_{2}=102$, $a_{3}=101+100K_{d}$, $a_{4}=900$）应用 Routh-Hurwitz 判据。Routh 表的首列元素为：\n- $s^{4}$ 行：$1,\\;a_{2},\\;a_{4} = 1,\\;102,\\;900$，\n- $s^{3}$ 行：$a_{1},\\;a_{3},\\;0 = 2,\\;101+100K_{d},\\;0$，\n- $s^{2}$ 行第一个元素 $b_{1} = \\frac{a_{1}a_{2}-a_{3}}{a_{1}} = \\frac{2\\cdot 102 -(101+100K_{d})}{2} = \\frac{103-100K_{d}}{2}$，第二个元素 $b_{2}=\\frac{a_{1}a_{4}-0}{a_{1}}=900$，\n- $s^{1}$ 行第一个元素 $c_{1} = \\frac{b_{1}a_{3}-a_{1}b_{2}}{b_{1}} = (101+100K_{d}) - \\frac{1800}{b_{1}}$。\n\n当第一列的某个元素变为零，而其前面的元素均为正时，系统达到临界稳定。从 $K_{d}=0$ 开始，所有元素均为正，因此首次失去严格正性的情况发生在 $c_1=0$ 时（因为 $b_1=0$ 会在稍后的 $K_{d}=\\frac{103}{100}$ 处发生）。令 $c_1=0$ 可得\n$$\n(101+100K_{d}) = \\frac{1800}{b_{1}} = \\frac{3600}{103-100K_{d}},\n$$\n所以\n$$\n(101+100K_{d})(103-100K_{d}) = 3600.\n$$\n展开并化简，\n$$\n-10000K_{d}^{2} + 200K_{d} + 10403 = 3600 \\;\\;\\Rightarrow\\;\\; 10000K_{d}^{2} - 200K_{d} - 6803 = 0.\n$$\n解关于 $K_{d}$ 的二次方程，\n$$\nK_{d} = \\frac{200 \\pm \\sqrt{200^{2} + 4\\cdot 10000 \\cdot 6803}}{2\\cdot 10000} = \\frac{200 \\pm \\sqrt{272160000}}{20000}.\n$$\n取正根得到\n$$\nK_{d} = \\frac{200 + \\sqrt{272160000}}{20000} = \\frac{2 + \\sqrt{27216}}{200} \\approx 0.834864.\n$$\n由于在此 $K_d$ 值下 $b_{1}=\\frac{103-100K_{d}}{2}$ 仍为正，且 $b_{1}=0$ 在稍后的 $K_{d}=1.03$ 处才发生，因此产生临界稳定的最小正微分增益是 $K_{d}\\approx 0.835$（保留三位有效数字）。", "answer": "$$\\boxed{0.835}$$", "id": "1602753"}]}