{"hands_on_practices": [{"introduction": "要使用状态观测器，第一步是进行设计。设计的核心是选择观测器增益 $L$ 以确保估计误差以期望的速率收敛到零。这个收敛速率由误差动力学矩阵 $A-LC$ 的特征值（或称“极点”）决定。\n\n本练习将引导您完成极点配置的基本过程，您将计算所需的 $L$ 的具体值，以便将误差极点放置在复平面上的预定位置。这是 Luenberger 观测器设计的基石。", "problem": "一个小卫星的单轴姿态动力学简化模型由一个线性时不变系统描述。系统状态由向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$ 表示，其中 $x_1$ 是角位置，$x_2$ 是角速度。系统动力学由以下状态空间方程给出：\n\n$$\n\\dot{x} = Ax + Bu\n$$\n$$\ny = Cx\n$$\n\n系统矩阵如下所示：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n矩阵 $B$ 和控制输入 $u$ 是控制系统设计的一部分，本问题不需要它们。\n\n由于传感器限制，只有角位置 $x_1$ 可以被直接测量，这由输出矩阵 $C$ 反映出来。为了有效地控制卫星，需要对完整状态向量 $x$ 进行估计。设计了一个 Luenberger 状态观测器来提供这个估计值，记为 $\\hat{x}$。该观测器的性能由估计误差 $e = x - \\hat{x}$ 的动力学决定。\n\n你的任务是确定观测器增益矩阵 $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$，该矩阵将估计误差动力学的两个特征值（极点）配置在期望位置 $s_1 = -p_1$ 和 $s_2 = -p_2$ 处，其中 $p_1$ 和 $p_2$ 是不同的正实数常量，它们指定了观测器期望的收敛速度。\n\n将观测器增益矩阵 $L$ 表示为以 $p_1$ 和 $p_2$ 表示的列向量。", "solution": "系统的 Luenberger 观测器定义为\n$$\n\\dot{\\hat{x}} = A \\hat{x} + B u + L\\big(y - C \\hat{x}\\big).\n$$\n定义估计误差 $e = x - \\hat{x}$。使用系统动力学 $\\dot{x} = A x + B u$ 和观测器动力学，误差动力学为\n$$\n\\dot{e} = \\dot{x} - \\dot{\\hat{x}} = A x + B u - \\big(A \\hat{x} + B u + L(C x - C \\hat{x})\\big) = (A - L C)e.\n$$\n当 $A = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$，$C = \\begin{pmatrix} 1  0 \\end{pmatrix}$，且 $L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}$ 时，我们有\n$$\nA - L C = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} - \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix}\\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} -l_{1}  1 \\\\ -l_{2}  0 \\end{pmatrix}.\n$$\n误差动力学矩阵的特征多项式为\n$$\n\\det\\big(s I - (A - L C)\\big) = \\det\\begin{pmatrix} s + l_{1}  -1 \\\\ l_{2}  s \\end{pmatrix} = s(s + l_{1}) + l_{2} = s^{2} + l_{1}s + l_{2}.\n$$\n期望的误差动力学特征值位于 $s_{1} = -p_{1}$ 和 $s_{2} = -p_{2}$，因此期望的特征多项式为\n$$\n(s + p_{1})(s + p_{2}) = s^{2} + (p_{1} + p_{2})s + p_{1}p_{2}.\n$$\n匹配系数可得\n$$\nl_{1} = p_{1} + p_{2}, \\quad l_{2} = p_{1}p_{2}.\n$$\n因此，观测器增益为\n$$\nL = \\begin{pmatrix} p_{1} + p_{2} \\\\ p_{1}p_{2} \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix} p_{1}+p_{2} \\\\ p_{1}p_{2} \\end{pmatrix}}$$", "id": "1577274"}, {"introduction": "一旦观测器的极点被配置好，我们如何量化其瞬态性能？仅仅知道收敛速度快并不能保证瞬态过程中的误差幅度就一定小。为了解决这个问题，我们可以引入一个性能指标，例如积分平方误差，它代表了误差信号的总“能量”。\n\n本练习将观测器的误差动力学与李雅普诺夫（Lyapunov）方程联系起来，后者是分析系统稳定性和性能的强大工具。您将不再仅仅局限于简单的极点配置，而是使用李雅普诺夫方程来确定观测器的最差情况性能界限，量化由初始估计失配引起的最大误差能量。", "problem": "一个二阶线性时不变（LTI）系统由状态空间模型 $\\dot{x}(t) = Ax(t)$ 和 $y(t) = Cx(t)$ 描述，其中 $x(t) \\in \\mathbb{R}^2$ 是状态向量，$y(t) \\in \\mathbb{R}$ 是标量输出。系统矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n为了估计状态向量 $x(t)$，我们实现了一个具有以下动态特性的 Luenberger 观测器：\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + L(y(t) - C\\hat{x}(t))\n$$\n其中 $\\hat{x}(t)$ 是估计状态。观测器增益矩阵 $L$ 被选择为：\n$$\nL = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix}\n$$\n估计误差定义为 $e(t) = x(t) - \\hat{x}(t)$。在时间 $t=0$ 时，真实状态和估计状态之间存在初始失配，使得初始误差向量的2-范数为 $\\|e(0)\\|_2 = \\delta$，其中 $\\delta$ 是一个正常数。\n\n衡量随时间变化的总观测误差的一个指标是积分平方误差，定义为 $J = \\int_0^\\infty \\|e(t)\\|_2^2 dt$。对于满足给定范数约束的任何初始误差 $e(0)$，$J$ 的最大可能值可以写成 $k \\delta^2$ 的形式。\n\n确定系数 $k$ 的精确解析表达式。", "solution": "Luenberger 观测器的误差动态由系统动态和观测器动态之差给出。对于 $e(t) = x(t) - \\hat{x}(t)$，我们计算\n$$\n\\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = A x(t) - \\left(A \\hat{x}(t) + L\\left(y(t) - C \\hat{x}(t)\\right)\\right) = \\left(A - L C\\right) e(t).\n$$\n给定 $A = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}$，$C = \\begin{pmatrix} 1  0 \\end{pmatrix}$，和 $L = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix}$，我们计算\n$$\nL C = \\begin{pmatrix} 6 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 6  0 \\\\ 0  0 \\end{pmatrix}, \\quad F \\coloneqq A - L C = \\begin{pmatrix} -6  1 \\\\ -2  -3 \\end{pmatrix}.\n$$\n$F$ 的特征多项式是\n$$\n\\det(\\lambda I - F) = \\det\\begin{pmatrix} \\lambda + 6  -1 \\\\ 2  \\lambda + 3 \\end{pmatrix} = (\\lambda + 6)(\\lambda + 3) + 2 = \\lambda^{2} + 9 \\lambda + 20,\n$$\n其根为 $\\lambda = -4$ 和 $\\lambda = -5$，因此 $F$ 是 Hurwitz 矩阵。所以，\n$$\ne(t) = \\exp(F t)\\, e(0).\n$$\n积分平方误差是\n$$\nJ = \\int_{0}^{\\infty} \\|e(t)\\|_{2}^{2} \\, dt = \\int_{0}^{\\infty} e(t)^{\\top} e(t) \\, dt = \\int_{0}^{\\infty} e(0)^{\\top} \\exp(F^{\\top} t) \\exp(F t)\\, e(0) \\, dt = e(0)^{\\top} P\\, e(0),\n$$\n其中\n$$\nP \\coloneqq \\int_{0}^{\\infty} \\exp(F^{\\top} t) \\exp(F t)\\, dt\n$$\n是连续时间 Lyapunov 方程\n$$\nF^{\\top} P + P F = -I.\n$$\n的唯一正定解。\n\n令 $P = \\begin{pmatrix} p_{11}  p_{12} \\\\ p_{12}  p_{22} \\end{pmatrix}$。已知 $F^{\\top} = \\begin{pmatrix} -6  -2 \\\\ 1  -3 \\end{pmatrix}$，我们计算\n$$\nF^{\\top} P = \\begin{pmatrix} -6 p_{11} - 2 p_{12}  -6 p_{12} - 2 p_{22} \\\\ p_{11} - 3 p_{12}  p_{12} - 3 p_{22} \\end{pmatrix}, \\quad\nP F = \\begin{pmatrix} -6 p_{11} - 2 p_{12}  p_{11} - 3 p_{12} \\\\ -6 p_{12} - 2 p_{22}  p_{12} - 3 p_{22} \\end{pmatrix}.\n$$\n因此\n$$\nF^{\\top} P + P F = \\begin{pmatrix}\n-12 p_{11} - 4 p_{12}  p_{11} - 9 p_{12} - 2 p_{22} \\\\\np_{11} - 9 p_{12} - 2 p_{22}  2 p_{12} - 6 p_{22}\n\\end{pmatrix} = - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n令各项相等，得到线性方程组\n$$\n-12 p_{11} - 4 p_{12} = -1, \\quad p_{11} - 9 p_{12} - 2 p_{22} = 0, \\quad 2 p_{12} - 6 p_{22} = -1.\n$$\n求解，由 $2 p_{12} - 6 p_{22} = -1$ 可得 $p_{12} = \\frac{-1 + 6 p_{22}}{2}$。由 $-12 p_{11} - 4 p_{12} = -1$ 可得 $p_{11} = \\frac{1 - 4 p_{12}}{12}$。代入 $p_{11} - 9 p_{12} - 2 p_{22} = 0$ 得\n$$\n\\frac{1 - 4 p_{12}}{12} - 9 p_{12} - 2 p_{22} = 0 \\implies 112 p_{12} + 24 p_{22} = 1.\n$$\n代入 $p_{12}$ 可得\n$$\n112 \\cdot \\frac{-1 + 6 p_{22}}{2} + 24 p_{22} = 1 \\implies -56 + 360 p_{22} = 1 \\implies p_{22} = \\frac{19}{120}.\n$$\n那么\n$$\np_{12} = \\frac{-1 + 6 \\cdot \\frac{19}{120}}{2} = -\\frac{1}{40}, \\quad p_{11} = \\frac{1 - 4 \\left(-\\frac{1}{40}\\right)}{12} = \\frac{11}{120}.\n$$\n因此\n$$\nP = \\begin{pmatrix} \\frac{11}{120}  -\\frac{1}{40} \\\\ -\\frac{1}{40}  \\frac{19}{120} \\end{pmatrix}.\n$$\n在所有满足 $\\|e(0)\\|_{2} = \\delta$ 的 $e(0)$ 中，$J = e(0)^{\\top} P e(0)$ 的最大值在 $e(0)$ 与 $P$ 的最大特征值对应的特征向量对齐时取得。$P$ 的特征值是\n$$\n\\lambda_{\\pm} = \\frac{\\operatorname{tr}(P) \\pm \\sqrt{\\operatorname{tr}(P)^{2} - 4 \\det(P)}}{2},\n$$\n其中 $\\operatorname{tr}(P) = \\frac{1}{4}$ 且 $\\det(P) = \\frac{1}{72}$。因此\n$$\n\\operatorname{tr}(P)^{2} - 4 \\det(P) = \\frac{1}{16} - \\frac{1}{18} = \\frac{1}{144}, \\quad \\sqrt{\\operatorname{tr}(P)^{2} - 4 \\det(P)} = \\frac{1}{12},\n$$\n所以\n$$\n\\lambda_{\\max}(P) = \\frac{\\frac{1}{4} + \\frac{1}{12}}{2} = \\frac{1}{6}.\n$$\n因此最大值为 $J_{\\max} = \\lambda_{\\max}(P) \\delta^{2}$，所求系数为 $k = \\frac{1}{6}$。", "answer": "$$\\boxed{\\frac{1}{6}}$$", "id": "1577282"}, {"introduction": "到目前为止，我们的设计都假设测量是完美的。然而，现实世界中的传感器精度有限，会向测量中引入量化误差。这种持续的测量误差对观测器来说就像一个扰动，会阻止估计误差完全收敛到零。\n\n本练习要求您在更现实的场景中分析观测器的性能。您将通过分析系统对有界扰动（如量化噪声）的响应来确定估计误差的最终界限。这是理解观测器设计在实际应用中局限性的关键一步。", "problem": "考虑一个由以下状态空间方程描述的线性时不变系统：\n$$\n\\dot{x}(t) = Ax(t) + Bu(t) \\\\\ny(t) = Cx(t)\n$$\n其中 $x(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$ 是状态向量，$u(t)$ 是标量输入，$y(t)$ 是标量输出。系统矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n设计一个全阶状态观测器来估计状态向量 $x(t)$。观测器的动态特性由下式给出：\n$$\n\\dot{\\hat{x}}(t) = A\\hat{x}(t) + Bu(t) + L(y_q(t) - C\\hat{x}(t))\n$$\n其中 $\\hat{x}(t)$ 是估计的状态向量，$L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$ 是观测器增益向量。\n\n测量输出 $y(t)$ 的传感器受到均匀量化的影响。量化测量值 $y_q(t)$ 与真实输出 $y(t)$ 的关系为 $y_q(t) = y(t) + e_q(t)$，其中 $e_q(t)$ 是量化误差。该误差在所有时间 $t$ 内均有界，即 $|e_q(t)| \\le \\frac{\\Delta}{2}$，其中 $\\Delta$ 是量化分辨率。\n\n选择观测器增益向量 $L$，使得观测器误差动态矩阵的两个特征值都配置在 $-p$ 处，其中 $p$ 是一个给定的正实常数。\n\n令状态估计误差为 $e(t) = x(t) - \\hat{x}(t) = \\begin{pmatrix} e_1(t) \\\\ e_2(t) \\end{pmatrix}$。由于持续存在的量化误差，估计误差不会收敛到零，而是在稳态下保持在一个有界区域内。设各个误差分量幅值的最终界限由 $E_1^{\\max}$ 和 $E_2^{\\max}$ 表示，它们分别代表当 $t \\to \\infty$ 时 $|e_1(t)|$ 和 $|e_2(t)|$ 的上确界。\n\n求比值 $\\frac{E_1^{\\max}}{E_2^{\\max}}$ 关于参数 $p$ 的解析表达式。", "solution": "带有量化测量的观测器误差动态可从\n$$\n\\dot{x} = A x + B u, \\quad \\dot{\\hat{x}} = A \\hat{x} + B u + L(y_{q} - C \\hat{x}), \\quad y_{q} = C x + e_{q},\n$$\n推导得出，因此，设 $e = x - \\hat{x}$ 和 $M \\equiv A - L C$，我们得到\n$$\n\\dot{e} = M e - L e_{q}.\n$$\n将 $M$ 的两个特征值都配置在 $-p$ 意味着 $M$ 的特征多项式等于 $(s + p)^{2} = s^{2} + 2 p s + p^{2}$。对于\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}, \\quad L = \\begin{pmatrix} l_{1} \\\\ l_{2} \\end{pmatrix},\n$$\n我们有\n$$\nM = A - L C = \\begin{pmatrix} -l_{1}  1 \\\\ -l_{2}  0 \\end{pmatrix},\n$$\n其特征多项式为 $s^{2} + l_{1} s + l_{2}$。比较系数可得\n$$\nl_{1} = 2 p, \\qquad l_{2} = p^{2}, \\qquad L = \\begin{pmatrix} 2 p \\\\ p^{2} \\end{pmatrix}, \\qquad M = \\begin{pmatrix} -2 p  1 \\\\ -p^{2}  0 \\end{pmatrix}.\n$$\n\n将 $e_{q}$ 视为一个有界扰动输入，满足 $|e_{q}(t)| \\le \\Delta/2$。从 $e_{q}$ 到 $e$ 的（向量）传递函数为\n$$\nG(s) = -(s I - M)^{-1} L.\n$$\n计算\n$$\ns I - M = \\begin{pmatrix} s + 2 p  -1 \\\\ p^{2}  s \\end{pmatrix}, \\quad (s I - M)^{-1} = \\frac{1}{(s + p)^{2}} \\begin{pmatrix} s  1 \\\\ -p^{2}  s + 2 p \\end{pmatrix},\n$$\n所以\n$$\nG(s) = -\\frac{1}{(s + p)^{2}} \\begin{pmatrix} s  1 \\\\ -p^{2}  s + 2 p \\end{pmatrix} \\begin{pmatrix} 2 p \\\\ p^{2} \\end{pmatrix} = -\\begin{pmatrix} \\dfrac{2 p s + p^{2}}{(s + p)^{2}} \\\\ \\dfrac{p^{2} s}{(s + p)^{2}} \\end{pmatrix}.\n$$\n因此，分量脉冲响应 $h_{1}(t)$ 和 $h_{2}(t)$（从 $e_{q}$ 到 $e_{1}$ 和 $e_{2}$）为\n$$\nh_{1}(t) = \\mathcal{L}^{-1}\\left[-\\frac{2 p s + p^{2}}{(s + p)^{2}}\\right]\n= -2 p \\bigl(\\exp(-p t) - p t \\exp(-p t)\\bigr) - p^{2} \\bigl(t \\exp(-p t)\\bigr)\n= p \\exp(-p t)\\,(p t - 2),\n$$\n$$\nh_{2}(t) = \\mathcal{L}^{-1}\\left[-\\frac{p^{2} s}{(s + p)^{2}}\\right]\n= -p^{2} \\bigl(\\exp(-p t) - p t \\exp(-p t)\\bigr)\n= p^{2} \\exp(-p t)\\,(p t - 1).\n$$\n\n对于一个具有标量输入 $u(t)$ 和脉冲响应 $h_{i}(t)$ 的稳定LTI系统，其输出满足\n$$\n|e_{i}(t)| = \\left|\\int_{0}^{\\infty} h_{i}(\\tau)\\, u(t - \\tau)\\, d\\tau\\right|\n\\le \\|u\\|_{\\infty} \\int_{0}^{\\infty} |h_{i}(\\tau)|\\, d\\tau.\n$$\n这个界是紧的，因为通过选择与 $h_{i}$ 符号一致的 $u$，其关于时间的上确界会逼近 $\\|u\\|_{\\infty} \\int_{0}^{\\infty} |h_{i}(\\tau)|\\, d\\tau$。因此，在 $|e_{q}(t)| \\le \\Delta/2$ 的条件下，最终界限为\n$$\nE_{i}^{\\max} = \\frac{\\Delta}{2} \\int_{0}^{\\infty} |h_{i}(t)|\\, dt,\n$$\n且该比值与 $\\Delta$ 无关：\n$$\n\\frac{E_{1}^{\\max}}{E_{2}^{\\max}} = \\frac{\\int_{0}^{\\infty} |h_{1}(t)|\\, dt}{\\int_{0}^{\\infty} |h_{2}(t)|\\, dt}.\n$$\n\n计算这些积分。通过变量替换 $z = p t$（因此 $dt = dz/p$），我们有\n$$\n|h_{1}(t)| = p \\exp(-p t) |p t - 2|, \\quad |h_{2}(t)| = p^{2} \\exp(-p t) |p t - 1|.\n$$\n于是\n$$\n\\int_{0}^{\\infty} |h_{1}(t)|\\, dt = \\int_{0}^{\\infty} \\exp(-z) |z - 2|\\, dz\n= \\int_{0}^{2} \\exp(-z)(2 - z)\\, dz + \\int_{2}^{\\infty} \\exp(-z)(z - 2)\\, dz.\n$$\n使用 $\\int \\exp(-z) (z - c)\\, dz = (c - z - 1)\\exp(-z) + \\text{const}$，这两项的计算结果为\n$$\n\\int_{0}^{2} \\exp(-z)(2 - z)\\, dz = 1 + \\exp(-2), \\qquad\n\\int_{2}^{\\infty} \\exp(-z)(z - 2)\\, dz = \\exp(-2),\n$$\n所以\n$$\n\\int_{0}^{\\infty} |h_{1}(t)|\\, dt = 1 + 2 \\exp(-2).\n$$\n类似地，\n$$\n\\int_{0}^{\\infty} |h_{2}(t)|\\, dt = p \\int_{0}^{\\infty} \\exp(-z) |z - 1|\\, dz\n= p \\left[\\int_{0}^{1} \\exp(-z)(1 - z)\\, dz + \\int_{1}^{\\infty} \\exp(-z)(z - 1)\\, dz\\right]\n= p \\left[\\exp(-1) + \\exp(-1)\\right]\n= 2 p \\exp(-1).\n$$\n\n因此，\n$$\n\\frac{E_{1}^{\\max}}{E_{2}^{\\max}} = \\frac{1 + 2 \\exp(-2)}{2 p \\exp(-1)} = \\frac{\\exp(1) + 2 \\exp(-1)}{2 p}.\n$$\n此表达式仅依赖于 $p$（按题目要求），所有其他量在比值计算中均被消去。", "answer": "$$\\boxed{\\frac{\\exp(1)+2\\exp(-1)}{2p}}$$", "id": "1577300"}]}