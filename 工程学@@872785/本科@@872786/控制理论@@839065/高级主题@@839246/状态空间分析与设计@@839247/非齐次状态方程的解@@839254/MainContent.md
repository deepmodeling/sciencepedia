## 引言
在控制理论与系统工程中，理解一个动态系统如何响应外部激励和初始条件是分析与设计的基础。非[齐次状态方程](@entry_id:266149) $\dot{x}(t) = Ax(t) + Bu(t)$ 正是描述这一动态过程的核心数学模型。然而，如何系统性地求解这个方程，从而精确预测系统在初始[状态和](@entry_id:193625)外部输入共同作用下的完整行为，是初学者面临的关键挑战。本文旨在填补这一知识缺口，提供一个关于非[齐次状态方程](@entry_id:266149)求解的全面指南。在接下来的内容中，读者将首先在“原理与机制”一章中学习到如何利用叠加原理分解问题，并掌握时域[卷积积分](@entry_id:155865)与[频域](@entry_id:160070)拉普拉斯变换两种核心求解技术。随后，在“应用与跨学科联系”一章中，我们将展示这些理论在机械、电子、信号处理等多个领域的广泛应用，揭示其普适性。最后，通过“动手实践”环节，读者将有机会应用所学知识解决具体问题，巩固理解。

## 原理与机制

在对线性时不变（LTI）系统的研究中，理解系统状态如何响应外部输入和初始条件是核心任务之一。本章将深入探讨非[齐次状态方程](@entry_id:266149)的求解方法，从基本原理出发，建立一套系统性的分析框架。我们将揭示，对于任何[线性系统](@entry_id:147850)，其总响应都可以优美地分解，并通过时域和[频域](@entry_id:160070)两种互补的视角进行求解。

### [叠加原理](@entry_id:144649)：分解全响应

[线性系统](@entry_id:147850)最根本且最强大的特性之一便是**[叠加原理](@entry_id:144649)**。该原理指出，系统对于多个独立作用（如此处的初始条件和外部输入）的总响应，等于系统对每个独立作用的响应之和。基于此，我们可以将非[齐次状态方程](@entry_id:266149) $\dot{x}(t) = Ax(t) + Bu(t)$ 在初始条件 $x(0) = x_0$ 下的解 $x(t)$ 分解为两个独立的部分：

1.  **[零输入响应](@entry_id:274925) (Zero-Input Response)**，记为 $x_{zi}(t)$：这是在**没有外部输入** ($u(t) \equiv 0$) 的情况下，系统仅由**非零初始状态** $x(0) = x_0$ 驱动产生的响应。它描述了系统的“固有”或“自然”动态，即系统如何从其初始状态恢复到平衡。$x_{zi}(t)$ 是[齐次状态方程](@entry_id:266149) $\dot{x}(t) = Ax(t)$ 满足初始条件 $x(0)=x_0$ 的解。

2.  **[零状态响应](@entry_id:273280) (Zero-State Response)**，记为 $x_{zs}(t)$：这是在**初始状态为零** ($x(0) = \mathbf{0}$) 的情况下，系统完全由**外部输入** $u(t)$ 驱动产生的响应。它反映了系统如何被外部力量“强迫”运动。$x_{zs}(t)$ 是非[齐次状态方程](@entry_id:266149) $\dot{x}(t) = Ax(t) + Bu(t)$ 满足[初始条件](@entry_id:152863) $x(0)=\mathbf{0}$ 的解。

因此，系统的**全响应 (Total Response)** 为：
$$
x(t) = x_{zi}(t) + x_{zs}(t)
$$

这个分解不仅在理论上是清晰的，在实践中也极具价值。它允许我们分开研究初始条件和外部输入对系统行为的影响。

为了具体理解[零输入响应](@entry_id:274925)的计算，我们可以考虑一个没有外部输入的三阶[LTI系统](@entry_id:271946) [@problem_id:1611781]。设系统由 $\dot{x}(t) = Ax(t)$ 描述，其中：
$$
A = \begin{pmatrix} 0  & 1  & 0 \\ 0  & 0  & 1 \\ -6  & -11  & -6 \end{pmatrix}, \quad x(0) = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}
$$
求解这个问题等价于求解一个三阶[常微分方程](@entry_id:147024) $x_1'''(t) + 6x_1''(t) + 11x_1'(t) + 6x_1(t) = 0$，其特征根为 $-1, -2, -3$。通过求解并利用[初始条件](@entry_id:152863)，我们可以得到状态随时间的演化，这便是该系统的[零输入响应](@entry_id:274925) $x_{zi}(t)$。

反过来，如果我们已知一个系统的全响应 $x(t)$，我们也可以通过计算[零输入响应](@entry_id:274925)来分离出[零状态响应](@entry_id:273280) [@problem_id:1611722]。例如，对于一个由特定初始状态 $x(0)$ 和单位阶跃输入 $u(t)=1$ 共同作用的系统，其全响应为：
$$
x(t) = \begin{pmatrix} \frac{1}{2} + 2e^{-t} - \frac{1}{2}e^{-2t} \\ \frac{1}{2} + \frac{1}{2}e^{-2t} \end{pmatrix}
$$
我们可以独立地计算出仅由初始状态 $x(0)$ 引起的[零输入响应](@entry_id:274925) $x_{zi}(t)$。然后，根据[叠加原理](@entry_id:144649)，[零状态响应](@entry_id:273280)就是全响应与[零输入响应](@entry_id:274925)之差：$x_{zs}(t) = x(t) - x_{zi}(t)$。这种分解的能力是分析和设计控制系统的基础。

此外，线性系统的**齐次性 (homogeneity)** 属性是[叠加原理](@entry_id:144649)的基石之一。该属性特指对于零状态系统，若输入信号按比例放大 $K$ 倍，其输出响应也将同样放大 $K$ 倍。例如，如果单位阶跃输入 $u_1(t)=1$ 产生的零状态输出为 $y_1(t)$，那么一个幅度为 $K$ 的阶跃输入 $u_2(t)=K$ 将产生零状态输出 $y_2(t) = K y_1(t)$ [@problem_id:1611755]。这进一步说明了[线性系统](@entry_id:147850)行为的可预测性和可伸缩性。

### 时域通解：[卷积积分](@entry_id:155865)

在确立了[叠加原理](@entry_id:144649)的基础上，我们接下来推导非[齐次状态方程](@entry_id:266149)的通用解析解。这个解将零输入和[零状态响应](@entry_id:273280)统一在一个表达式中，并揭示了[系统响应](@entry_id:264152)的深刻结构。

我们从状态方程 $\dot{x}(t) = Ax(t) + Bu(t)$ 出发，将其整理为：
$$
\dot{x}(t) - Ax(t) = Bu(t)
$$
这是一个[一阶线性微分方程组](@entry_id:176327)。我们可以借鉴求解标量一阶线性ODE的[积分因子法](@entry_id:167338)。这里，合适的[积分因子](@entry_id:177812)是一个矩阵，即**[状态转移矩阵](@entry_id:269075) (State-Transition Matrix)** $\Phi(t) = e^{At}$ 的逆，即 $e^{-At}$。用 $e^{-At}$ 左乘方程两边，我们得到：
$$
e^{-At}\dot{x}(t) - e^{-At}Ax(t) = e^{-At}Bu(t)
$$
注意到 $\frac{d}{dt}(e^{-At}) = -Ae^{-At} = -e^{-At}A$，上式左边恰好是乘积 $e^{-At}x(t)$ 对时间的导数：
$$
\frac{d}{dt}\left( e^{-At}x(t) \right) = e^{-At}\left( \dot{x}(t) - Ax(t) \right)
$$
因此，原方程可以被优雅地写成：
$$
\frac{d}{dt}\left( e^{-At}x(t) \right) = e^{-At}Bu(t)
$$
现在，我们将两边从 $0$ 到 $t$ 对时间（用哑变量 $\tau$ 表示）进行积分：
$$
\int_{0}^{t} \frac{d}{d\tau}\left( e^{-A\tau}x(\tau) \right) d\tau = \int_{0}^{t} e^{-A\tau}B u(\tau) d\tau
$$
根据微积分基本定理，左边等于：
$$
e^{-At}x(t) - e^{-A \cdot 0}x(0) = e^{-At}x(t) - x(0)
$$
于是，我们有：
$$
e^{-At}x(t) - x(0) = \int_{0}^{t} e^{-A\tau}B u(\tau) d\tau
$$
最后，为了解出 $x(t)$，我们将 $x(0)$ 移到右边，并用 $e^{At}$ 左乘整个方程，得到非[齐次状态方程](@entry_id:266149)的完整解：
$$
x(t) = e^{At}x(0) + e^{At} \int_{0}^{t} e^{-A\tau}B u(\tau) d\tau
$$
这个公式非常重要。我们可以清晰地看到：
- 第一项 $e^{At}x(0)$ 正是**[零输入响应](@entry_id:274925)** $x_{zi}(t)$。它只与[初始条件](@entry_id:152863) $x(0)$ 有关。
- 第二项 $e^{At} \int_{0}^{t} e^{-A\tau}B u(\tau) d\tau$ 则是**[零状态响应](@entry_id:273280)** $x_{zs}(t)$。它只与输入 $u(t)$ 有关。

[零状态响应](@entry_id:273280)的部分还可以写成另一种等价且更常见的形式。由于 $e^{At}$ 相对于积分变量 $\tau$ 是一个常数矩阵，可以将其移入积分号内：
$$
x_{zs}(t) = \int_{0}^{t} e^{At}e^{-A\tau}B u(\tau) d\tau = \int_{0}^{t} e^{A(t-\tau)}B u(\tau) d\tau
$$
这个积分形式被称为**[卷积积分](@entry_id:155865) (Convolution Integral)**。它具有深刻的物理意义：系统在时刻 $t$ 的状态，是过去所有时刻 $\tau \in [0, t]$ 的输入 $u(\tau)$ 作用的累积效应。每个过去的输入 $u(\tau)d\tau$（可视为一个微小的脉冲）在经过 $t-\tau$ 时间的演化后（由 $e^{A(t-\tau)}B$ 描述），对当前状态 $x(t)$ 做出贡献。

总结一下，[状态方程](@entry_id:274378)的通解可以写作以下两种等价形式 [@problem_id:2746237]：
$$
x(t) = \underbrace{e^{At}x(0)}_{\text{零输入响应}} + \underbrace{\int_{0}^{t} e^{A(t-\tau)}B u(\tau) d\tau}_{\text{零状态响应}}
$$
这个公式是现代控制理论的基石之一。

### 应用与特例

掌握了通解公式后，我们来看几个重要的应用场景。

#### 对常数输入的响应

一个常见的情况是系统受到一个恒定的输入，例如一个阶跃信号 $u(t) = U_0$（其中 $U_0$ 是一个常数向量）。这种情况在许多工程应用中都会遇到，例如给电机施加恒定电压，或给加热系统提供恒定功率 [@problem_id:1611733]。

在这种情况下，[零状态响应](@entry_id:273280)的积分为：
$$
x_{zs}(t) = \int_{0}^{t} e^{A(t-\tau)}B U_0 d\tau
$$
我们可以通过换元 $s = t-\tau$ (则 $ds = -d\tau$) 来简化积分：
$$
x_{zs}(t) = \int_{t}^{0} e^{As}B U_0 (-ds) = \int_{0}^{t} e^{As}B U_0 ds = \left( \int_{0}^{t} e^{As} ds \right) B U_0
$$
如果矩阵 $A$ 是可逆的，那么 $\int e^{As} ds = A^{-1}e^{As}$，积分可以解析计算：
$$
\int_{0}^{t} e^{As} ds = A^{-1}[e^{As}]_0^t = A^{-1}(e^{At} - I)
$$
因此，对于常数输入 $U_0$，[零状态响应](@entry_id:273280)为：
$$
x_{zs}(t) = A^{-1}(e^{At} - I)B U_0
$$
系统的全响应则为 $x(t) = e^{At}x(0) + A^{-1}(e^{At} - I)B U_0$。这个表达式清晰地展示了响应如何由瞬态部分（包含 $e^{At}$ 的项）和[稳态](@entry_id:182458)部分（当 $t \to \infty$ 时的极限值，如果系统稳定）组成。

#### 对冲激输入的响应

另一个极为重要的特例是系统对**狄拉克δ函数 (Dirac delta function)** 或[单位冲激](@entry_id:272155)信号 $u(t) = \delta(t) \cdot v$ 的响应，其中 $v$ 是一个常数向量。冲激输入可以模拟瞬间的、能量集中的作用，如锤击或电路中的瞬间高压。

考虑一个初始状态为零的系统 $x(0)=\mathbf{0}$，输入为 $u(t) = \delta(t)v$ [@problem_id:1611740]。其响应为：
$$
x(t) = \int_{0}^{t} e^{A(t-\tau)}B (\delta(\tau)v) d\tau
$$
利用狄拉克$\delta$函数的**[筛选性质](@entry_id:265662)**，即 $\int f(\tau)\delta(\tau)d\tau = f(0)$，我们得到：
$$
x(t) = e^{A(t-0)}Bv = e^{At}Bv, \quad \text{for } t > 0
$$
这个结果意义非凡。它表明，零状态系统对[单位冲激](@entry_id:272155)的响应直接由**[状态转移矩阵](@entry_id:269075)** $e^{At}$ 给出。函数 $h(t) = e^{At}B$ 被称为系统的**状态冲激[响应矩阵](@entry_id:754302)**。一旦我们知道了冲激响应，根据卷积原理，对任何输入 $u(t)$ 的响应都可以通过计算 $\int_0^t h(t-\tau)u(\tau)d\tau$ 得到。

#### 组合响应：一个完整示例

为了巩固理解，我们通过一个完整的例子来演示如何结合零输入和[零状态响应](@entry_id:273280)来求全响应 [@problem_id:1611777]。考虑一个系统，其[初始条件](@entry_id:152863) $x(0)$ 非零，同时受到一个阶跃输入 $u(t)=1$ 的作用。
$$
A = \begin{pmatrix} -3  & 1 \\ 0  & -2 \end{pmatrix}, \quad B = \begin{pmatrix} 0 \\ 1 \end{pmatrix}, \quad x(0) = \begin{pmatrix} 1 \\ 1 \end{pmatrix}, \quad u(t) = 1 \text{ for } t \ge 0
$$
根据[叠加原理](@entry_id:144649)，我们分别计算：
1.  **[零输入响应](@entry_id:274925) $x_{zi}(t)$**：求解 $\dot{x}=Ax$ 且 $x(0) = \begin{pmatrix} 1 & 1 \end{pmatrix}^T$。
2.  **[零状态响应](@entry_id:273280) $x_{zs}(t)$**：求解 $\dot{x}=Ax+Bu$ 且 $x(0) = \begin{pmatrix} 0 & 0 \end{pmatrix}^T$。
最后将两者相加，$x(t) = x_{zi}(t) + x_{zs}(t)$，即可得到系统的全响应。这种分步计算的方法将一个复杂问题分解为两个更简单、更标准的问题，是解决[线性系统](@entry_id:147850)问题的常用策略。

### [频域](@entry_id:160070)方法：[拉普拉斯变换](@entry_id:159339)

除了时域的[卷积积分](@entry_id:155865)方法，**[拉普拉斯变换](@entry_id:159339) (Laplace Transform)** 提供了一种强大的代数工具，尤其适用于求解具有标准形式（如指数、正弦、多项式等）输入的[LTI系统](@entry_id:271946)。

对状态方程 $\dot{x}(t) = Ax(t) + Bu(t)$ 两边进行拉普拉斯变换，利用[微分性质](@entry_id:275298) $\mathcal{L}\{\dot{x}(t)\} = sX(s) - x(0)$，我们得到：
$$
sX(s) - x(0) = AX(s) + BU(s)
$$
其中 $X(s) = \mathcal{L}\{x(t)\}$ 和 $U(s) = \mathcal{L}\{u(t)\}$。这是一个关于 $X(s)$ 的代数方程。我们可以整理并求解 $X(s)$：
$$
sX(s) - AX(s) = x(0) + BU(s)
$$
$$
(sI - A)X(s) = x(0) + BU(s)
$$
$$
X(s) = (sI - A)^{-1}x(0) + (sI - A)^{-1}BU(s)
$$
这个表达式是[状态方程](@entry_id:274378)在[频域](@entry_id:160070)中的解。矩阵 $(sI - A)^{-1}$ 被称为**能解矩阵 (Resolvent Matrix)**，它在[频域分析](@entry_id:265642)中扮演着核心角色。值得注意的是，能解矩阵正是[状态转移矩阵](@entry_id:269075) $e^{At}$ 的拉普拉斯变换，即 $\mathcal{L}\{e^{At}\} = (sI - A)^{-1}$。这在时域和[频域](@entry_id:160070)之间建立了一座重要的桥梁。

同样，我们可以在[频域](@entry_id:160070)中清晰地识别出零输入和[零状态响应](@entry_id:273280)的变换形式：
- $X_{zi}(s) = (sI - A)^{-1}x(0)$
- $X_{zs}(s) = (sI - A)^{-1}BU(s)$

通过计算 $X(s)$，然后对其进行拉普拉斯反变换，我们就可以得到时域解 $x(t)$。对于多项式分母的 $X(s)$，这通常涉及[部分分式展开](@entry_id:265121)。

例如，考虑一个系统具有非零初始[状态和](@entry_id:193625)指数输入 $u(t) = 2e^{-4t}$ [@problem_id:1611772]。通过上述步骤，我们可以先计算出 $U(s) = \frac{2}{s+4}$，然后计算 $(sI-A)^{-1}$，最后将所有部分代入公式得到 $X(s)$ 的表达式。这个过程完全是代数运算，避免了时域中的积分计算。

#### 共振现象

[频域](@entry_id:160070)方法能够非常直观地解释**共振 (Resonance)** 现象。当外部输入的某个频率分量与系统的某个**自然频率**（由系统矩阵 $A$ 的[特征值](@entry_id:154894)决定）相匹配时，就会发生共振。

在拉普拉斯域中，系统的自然频率对应于能解矩阵 $(sI-A)^{-1}$ 的极点，也就是矩阵 $A$ 的[特征值](@entry_id:154894)。如果输入信号 $U(s)$ 的极点之一与 $(sI-A)^{-1}$ 的某个极点重合，那么在最终的响应 $X(s)$ 或 $Y(s)$ 中就会出现**[重极点](@entry_id:262210)**。

例如，考虑一个系统，其矩阵 $A$ 的[特征值](@entry_id:154894)之一为 $\lambda_1 = -1$。如果施加的输入是 $u(t) = e^{-t}$，那么其[拉普拉斯变换](@entry_id:159339)为 $U(s) = \frac{1}{s+1}$。此时，系统[传递函数](@entry_id:273897) $G(s) = C(sI-A)^{-1}B$ 在 $s=-1$ 处有一个极点，输入 $U(s)$ 在 $s=-1$ 处也有一个极点。这导致输出的拉普拉斯变换 $Y(s) = G(s)U(s)$ 在 $s=-1$ 处有一个二阶或更高阶的极点，例如包含形如 $\frac{1}{(s+1)^2}$ 的项 [@problem_id:1611775]。

我们知道 $\mathcal{L}^{-1}\{\frac{1}{(s+\alpha)^2}\} = t e^{-\alpha t}$。因此，响应中会出现 $t \cdot e^{\lambda t}$ 这样的项，称为**长期项 (secular term)**。这意味着响应的幅值会随着时间[线性增长](@entry_id:157553)（乘以一个衰减或增长的指数），导致系统输出远大于非共振情况。理解共振是设计和控制机械与电气系统以避免潜在破坏性[振荡](@entry_id:267781)的关键。

### 高级主题：描述符系统

标准[状态空间模型](@entry_id:137993) $\dot{x}=Ax+Bu$ 假设系统的所有[状态变量](@entry_id:138790)都是动态的。然而，在某些物理模型中（如包含[理想约束](@entry_id:168997)的电路或机械系统），[状态变量](@entry_id:138790)之间可能存在纯代数关系。这类系统可以用**描述符系统 (Descriptor System)** 或[奇异系统](@entry_id:140614)来建模：
$$
E\dot{x}(t) = Ax(t) + Bu(t)
$$
其中矩阵 $E$ 是**奇异的**（即不可逆）。

奇异性带来了两个关键区别 [@problem_id:1611749]：
1.  **代数约束**：由于 $E$ 奇异，[方程组](@entry_id:193238)中存在一些不含导数项的行，它们构成了对状态变量 $x(t)$ 的纯代数约束。例如，如果 $E$ 的最后一行是零，则状态方程的最后一行就变成 $0 = A_{row_n}x(t) + B_{row_n}u(t)$，其中 $A_{row_n}$ 和 $B_{row_n}$ 分别是 $A$ 和 $B$ 的最后一行。状态向量 $x(t)$ 必须在所有时刻都满足这些代数约束。

2.  **状态跳变**：对于标准系统，[状态向量](@entry_id:154607) $x(t)$ 必须是连续的。但在描述符系统中，如果给定的[初始条件](@entry_id:152863) $x(0^-)$ 不满足代数约束，[状态向量](@entry_id:154607)必须在 $t=0$ 时刻发生**不连续的跳变**，到达一个满足约束的“一致”初始状态 $x(0^+)$。这种跳变或冲激行为是描述符系统的典型特征。

求解描述符系统通常需要将[状态变量](@entry_id:138790)分解为动态[部分和](@entry_id:162077)代数部分，或者使用更高级的工具如 Drazin 逆。一个常见的方法是：
- 首先，从[方程组](@entry_id:193238)中分离出代数约束。
- 其次，检查初始条件 $x(0^-)$ 的一致性。如果不一致，计算出一致的初始状态 $x(0^+)$。
- 最后，利用代数约束来消去一些变量，将系统的动态部分转化为一个阶数较低的标准[状态空间方程](@entry_id:266994)，然后用 $x(0^+)$ 作为[初始条件](@entry_id:152863)进行求解。

描述符系统理论为包含约束和冲激现象的更广泛物理系统提供了严谨的数学框架。