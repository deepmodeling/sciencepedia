{"hands_on_practices": [{"introduction": "在着手设计状态估计器之前，我们必须回答一个根本性问题：我们能否通过观测系统输出来唯一地确定其内部状态？这个被称为能观性的属性至关重要，并且它常常取决于我们传感器的安放位置。这个问题 [@problem_id:1584834] 将挑战你分析一个物理系统，并通过检验能观性条件来确定哪种传感器配置能够实现完全的状态估计。", "problem": "一个工程团队正在为一个由柔性缆索连接的双体卫星系统的简化一维模型开发状态反馈控制器。该系统由两个质量分别为 $m_1$ 和 $m_2$ 的物体组成，它们通过一个弹簧常数为 $k$ 的弹簧连接。一个外力 $u(t)$ 可以施加在质量 $m_1$ 上。为建模方便，质量和弹簧常数被归一化，使得 $m_1=1$，$m_2=1$ 且 $k=1$。阻尼被认为可以忽略不计。\n\n系统的状态由向量 $\\mathbf{x} = [p_1, v_1, p_2, v_2]^T$ 描述，其中 $p_1$ 和 $v_1$ 是第一个物体的位置和速度，$p_2$ 和 $v_2$ 是第二个物体的位置和速度。其线性化动力学由状态空间方程 $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u$ 给出，其中系统矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  & 1  & 0  & 0 \\\\\n-1  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & 1 \\\\\n1  & 0  & -1  & 0\n\\end{pmatrix}\n$$\n\n为了实现状态估计器（一个观测器），团队必须能够从可用的测量值中重构出完整的状态向量 $\\mathbf{x}$。提出了两种不同的传感器配置，从而得到两种不同的输出方程 $y = C\\mathbf{x}$。\n\n**配置 1**：一个传感器直接测量第一个物体的绝对位置 $p_1$。相应的输出矩阵为：\n$$\nC_1 = \\begin{pmatrix} 1  & 0  & 0  & 0 \\end{pmatrix}\n$$\n\n**配置 2**：另一个传感器测量两个物体之间的相对位移 $p_1 - p_2$。相应的输出矩阵为：\n$$\nC_2 = \\begin{pmatrix} 1  & 0  & -1  & 0 \\end{pmatrix}\n$$\n\n您的任务是确定哪种配置可以构成一个可观测系统。\n\nA) 只有配置1是可观测的。\n\nB) 只有配置2是可观测的。\n\nC) 两种配置都是可观测的。\n\nD) 两种配置都不是可观测的。", "solution": "对于一个状态矩阵为 $A$、输出矩阵为 $C$ 的线性时不变系统，该系统是可观测的当且仅当其可观测性矩阵\n$$\n\\mathcal{O} = \\begin{pmatrix}\nC \\\\\nCA \\\\\nCA^{2} \\\\\nCA^{3}\n\\end{pmatrix}\n$$\n的秩等于状态维数，此处为 $4$。\n\n给定\n$$\nA = \\begin{pmatrix}\n0  & 1  & 0  & 0 \\\\\n-1  & 0  & 1  & 0 \\\\\n0  & 0  & 0  & 1 \\\\\n1  & 0  & -1  & 0\n\\end{pmatrix},\n$$\n我们对每种配置进行检验。\n\n配置 1：$C_{1} = \\begin{pmatrix} 1  & 0  & 0  & 0 \\end{pmatrix}$。\n\n计算逐次乘积：\n$$\nC_{1}A = \\begin{pmatrix} 0  & 1  & 0  & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{2} = (C_{1}A)A = \\begin{pmatrix} -1  & 0  & 1  & 0 \\end{pmatrix},\n$$\n$$\nC_{1}A^{3} = (C_{1}A^{2})A = \\begin{pmatrix} 0  & -1  & 0  & 1 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathcal{O}_{1} = \\begin{pmatrix}\n1  & 0  & 0  & 0 \\\\\n0  & 1  & 0  & 0 \\\\\n-1  & 0  & 1  & 0 \\\\\n0  & -1  & 0  & 1\n\\end{pmatrix}.\n$$\n$\\mathcal{O}_{1}$ 的列向量为\n$$\n\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix},\\quad\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\n$$\n它们是线性无关的。因此 $\\operatorname{rank}(\\mathcal{O}_{1}) = 4$，所以配置1是可观测的。\n\n配置 2：$C_{2} = \\begin{pmatrix} 1  & 0  & -1  & 0 \\end{pmatrix}$。\n\n计算逐次乘积：\n$$\nC_{2}A = \\begin{pmatrix} 0  & 1  & 0  & -1 \\end{pmatrix},\n$$\n$$\nC_{2}A^{2} = (C_{2}A)A = \\begin{pmatrix} -2  & 0  & 2  & 0 \\end{pmatrix} = -2 C_{2},\n$$\n$$\nC_{2}A^{3} = (C_{2}A^{2})A = -2(C_{2}A) = \\begin{pmatrix} 0  & -2  & 0  & 2 \\end{pmatrix}.\n$$\n因此\n$$\n\\mathcal{O}_{2} = \\begin{pmatrix}\n1  & 0  & -1  & 0 \\\\\n0  & 1  & 0  & -1 \\\\\n-2  & 0  & 2  & 0 \\\\\n0  & -2  & 0  & 2\n\\end{pmatrix},\n$$\n其中第三行等于第一行的 $-2$ 倍，第四行等于第二行的 $-2$ 倍。因此 $\\operatorname{rank}(\\mathcal{O}_{2}) = 2  4$，配置2是不可观测的。\n\n所以，只有配置1是可观测的。", "answer": "$$\\boxed{A}$$", "id": "1584834"}, {"introduction": "一旦我们确定系统是能观的，下一步就是设计观测器本身。设计的核心是选择观测器增益矩阵 $L$，以确保估计误差能以期望的速率收敛到零。在这个练习 [@problem_id:1584819] 中，你将实践极点配置这一基本技术，推导能使误差动态系统达到特定性能目标的观测器增益。", "problem": "考虑一个二阶线性时不变（LTI）系统，其状态空间模型描述如下：\n$$\n\\begin{aligned}\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B \\mathbf{u}(t) \\\\\ny(t) = C \\mathbf{x}(t)\n\\end{aligned}\n$$\n其中状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$，矩阵由下式给出：\n$$\nA = \\begin{pmatrix} 0   1 \\\\ -a_0   -a_1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1   0 \\end{pmatrix}\n$$\n这里，$a_0$ 和 $a_1$ 是实值系统参数。输入矩阵 $B$ 和输入向量 $\\mathbf{u}(t)$ 与本问题无关。\n\n为该系统设计了一个全状态 Luenberger 观测器。估计状态向量 $\\hat{\\mathbf{x}}(t)$ 的动态由以下方程控制：\n$$\n\\dot{\\hat{\\mathbf{x}}}(t) = A \\hat{\\mathbf{x}}(t) + B \\mathbf{u}(t) + L(y(t) - C\\hat{\\mathbf{x}}(t))\n$$\n观测器增益是一个列向量 $L = \\begin{pmatrix} l_1 \\\\ l_2 \\end{pmatrix}$。控制观测器估计误差 $\\mathbf{e}(t) = \\mathbf{x}(t) - \\hat{\\mathbf{x}}(t)$ 的矩阵的特征多项式，期望为：\n$$\np_{des}(s) = s^2 + \\alpha_1 s + \\alpha_0\n$$\n其中 $\\alpha_1  0$ 和 $\\alpha_0  0$ 是决定观测器期望稳定动态的系数。\n\n请确定观测器增益 $l_1$ 和 $l_2$ 关于系统参数（$a_0, a_1$）和期望特征多项式系数（$\\alpha_0, \\alpha_1$）的表达式。您的最终答案应按顺序给出 $l_1$ 和 $l_2$ 的表达式。", "solution": "将估计误差定义为 $\\mathbf{e}(t)=\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)$。使用受控对象和观测器的动态方程，\n$$\n\\dot{\\mathbf{e}}(t)=\\dot{\\mathbf{x}}(t)-\\dot{\\hat{\\mathbf{x}}}(t)=\\left(A\\mathbf{x}(t)+B\\mathbf{u}(t)\\right)-\\left(A\\hat{\\mathbf{x}}(t)+B\\mathbf{u}(t)+L\\left(y(t)-C\\hat{\\mathbf{x}}(t)\\right)\\right).\n$$\n由于 $y(t)=C\\mathbf{x}(t)$，上式可简化为\n$$\n\\dot{\\mathbf{e}}(t)=A\\left(\\mathbf{x}(t)-\\hat{\\mathbf{x}}(t)\\right)-L\\left(C\\mathbf{x}(t)-C\\hat{\\mathbf{x}}(t)\\right)=(A-LC)\\mathbf{e}(t).\n$$\n当 $A=\\begin{pmatrix}0  1\\\\-a_{0}  -a_{1}\\end{pmatrix}$，$C=\\begin{pmatrix}1  0\\end{pmatrix}$ 和 $L=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}$ 时，我们有\n$$\nLC=\\begin{pmatrix}l_{1}\\\\ l_{2}\\end{pmatrix}\\begin{pmatrix}1  0\\end{pmatrix}=\\begin{pmatrix}l_{1}  0\\\\ l_{2}  0\\end{pmatrix},\n\\quad\nA-LC=\\begin{pmatrix}-l_{1}  1\\\\-a_{0}-l_{2}  -a_{1}\\end{pmatrix}.\n$$\n一个 $2\\times 2$ 矩阵 $M$ 的特征多项式为 $s^{2}-(\\operatorname{tr}M)s+\\det M$。因此，对于 $A-LC$ 而言，\n$$\np(s)=s^{2}-\\left(\\operatorname{tr}(A-LC)\\right)s+\\det(A-LC).\n$$\n计算其迹和行列式：\n$$\n\\operatorname{tr}(A-LC)=-l_{1}-a_{1},\\qquad\n\\det(A-LC)=(-l_{1})(-a_{1})-1\\cdot(-a_{0}-l_{2})=l_{1}a_{1}+a_{0}+l_{2}.\n$$\n我们需要 $p(s)=p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$，因此通过系数匹配可得\n$$\n-\\operatorname{tr}(A-LC)=\\alpha_{1}\\;\\Rightarrow\\;-(-l_{1}-a_{1})=\\alpha_{1}\\;\\Rightarrow\\;l_{1}=\\alpha_{1}-a_{1},\n$$\n$$\n\\det(A-LC)=\\alpha_{0}\\;\\Rightarrow\\;l_{1}a_{1}+a_{0}+l_{2}=\\alpha_{0}\\;\\Rightarrow\\;l_{2}=\\alpha_{0}-a_{0}-l_{1}a_{1}.\n$$\n将 $l_{1}=\\alpha_{1}-a_{1}$ 代入 $l_{2}$ 的表达式中，得到\n$$\nl_{2}=\\alpha_{0}-a_{0}-a_{1}(\\alpha_{1}-a_{1})=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}.\n$$\n因此，将估计误差动态置于 $p_{des}(s)=s^{2}+\\alpha_{1}s+\\alpha_{0}$ 的观测器增益为 $l_{1}=\\alpha_{1}-a_{1}$ 和 $l_{2}=\\alpha_{0}-a_{0}-a_{1}\\alpha_{1}+a_{1}^{2}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\alpha_1 - a_1 \\\\ \\alpha_0 - a_0 - a_1\\alpha_1 + a_1^2 \\end{pmatrix}}$$", "id": "1584819"}, {"introduction": "一个系统不能被观测，这到底意味着什么？它意味着存在某些初始状态或行为模式，对于系统的输出而言是完全不可见的。这个练习 [@problem_id:1584790] 将这个抽象概念具体化，要求你找出一个非零初始状态，它能在所有时间内产生零输出，从而识别出系统不可观测子空间中的一个向量。", "problem": "考虑一个线性时不变（LTI）系统，其演化由状态空间方程 $\\dot{x}(t) = Ax(t)$ 和 $y(t) = Cx(t)$ 描述，其中系统在没有任何外部输入的情况下运行。状态向量为 $x(t) \\in \\mathbb{R}^3$，输出为标量 $y(t) \\in \\mathbb{R}$。相应的系统矩阵如下所示：\n$$\nA = \\begin{bmatrix} 1   -3   1 \\\\ 2   0   -3 \\\\ -1   2   -2 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1   -1   0 \\end{bmatrix}\n$$\n可以选择一个非零的初始状态 $x(0)$，使得系统的输出在所有时间内都保持为零，即对于所有 $t \\ge 0$ 都有 $y(t) \\equiv 0$。在附加约束条件为其第一个分量为 $x_1(0) = 5$ 的情况下，求满足此条件的唯一非零初始状态向量 $x(0)$。将您的答案表示为一个 $3 \\times 1$ 的列向量。", "solution": "对于零输入LTI系统 $\\dot{x}(t)=Ax(t)$ 和 $y(t)=Cx(t)$，状态和输出分别为 $x(t)=\\exp(At)x(0)$ 和 $y(t)=C\\exp(At)x(0)$。为了使对所有 $t\\ge 0$ 都有 $y(t)\\equiv 0$，在 $t=0$ 时的所有时间导数都必须为零：\n$$\ny^{(k)}(0)=CA^{k}x(0)=0 \\quad \\text{for all } k\\ge 0.\n$$\n根据 Cayley-Hamilton 定理，在 $\\mathbb{R}^{3}$ 中，只需对 $k=0,1,2$ 强制执行此条件即可。因此 $x(0)$ 必须位于能观性矩阵的零空间中\n$$\n\\mathcal{O}=\\begin{bmatrix} C \\\\ CA \\\\ CA^{2} \\end{bmatrix}.\n$$\n已知 $C=\\begin{bmatrix}1   -1   0\\end{bmatrix}$ 和 $A=\\begin{bmatrix} 1   -3   1 \\\\ 2   0   -3 \\\\ -1   2   -2 \\end{bmatrix}$，我们计算\n$$\nCA=\\begin{bmatrix}1   -1   0\\end{bmatrix}A\n=\\begin{bmatrix}\n1\\cdot 1+(-1)\\cdot 2+0\\cdot(-1),\\;\n1\\cdot(-3)+(-1)\\cdot 0+0\\cdot 2,\\;\n1\\cdot 1+(-1)\\cdot(-3)+0\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-1   -3   4\\end{bmatrix}.\n$$\n然后\n$$\nCA^{2}=(CA)A=\\begin{bmatrix}-1   -3   4\\end{bmatrix}A\n=\\begin{bmatrix}\n(-1)\\cdot 1+(-3)\\cdot 2+4\\cdot(-1),\\;\n(-1)\\cdot(-3)+(-3)\\cdot 0+4\\cdot 2,\\;\n(-1)\\cdot 1+(-3)\\cdot(-3)+4\\cdot(-2)\n\\end{bmatrix}\n=\\begin{bmatrix}-11   11   0\\end{bmatrix}.\n$$\n因此\n$$\n\\mathcal{O}=\\begin{bmatrix}\n1   -1   0\\\\\n-1   -3   4\\\\\n-11   11   0\n\\end{bmatrix}.\n$$\n设 $x(0)=\\begin{bmatrix}x_{1} \\\\ x_{2} \\\\ x_{3}\\end{bmatrix}$。求解 $\\mathcal{O}x(0)=0$，从第一行得到 $x_{1}-x_{2}=0$，因此 $x_{1}=x_{2}$。第二行得出 $-x_{1}-3x_{2}+4x_{3}=0$，将 $x_{1}=x_{2}$ 代入可得 $-4x_{1}+4x_{3}=0$，因此 $x_{3}=x_{1}$。第三行与 $x_{1}=x_{2}$ 一致。因此，零空间由 $\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}$ 张成，且满足 $x_{1}(0)=5$ 的唯一非零初始状态是\n$$\nx(0)=5\\begin{bmatrix}1 \\\\ 1 \\\\ 1\\end{bmatrix}=\\begin{bmatrix}5 \\\\ 5 \\\\ 5\\end{bmatrix}.\n$$\n这个 $x(0)$ 对 $k=0,1,2$ 满足 $CA^{k}x(0)=0$，根据 Cayley-Hamilton 定理，可以推断对所有 $k\\ge 0$ 都有 $CA^{k}x(0)=0$，因此对所有 $t\\ge 0$ 都有 $y(t)\\equiv 0$。", "answer": "$$\\boxed{\\begin{pmatrix}5 \\\\ 5 \\\\ 5\\end{pmatrix}}$$", "id": "1584790"}]}