{"hands_on_practices": [{"introduction": "掌握任何新理论的第一步都是理解其核心机制。本练习将引导你完成应用庞特里亚金最小值原理（Pontryagin Minimum Principle, PMP）的基本步骤。通过解决一个耦合线性系统的最小能量控制问题，你将学习如何构建哈密顿量 (Hamiltonian)，并推导出协态方程 (costate equations) 和最优控制律的一般形式。这个过程是解决所有最优控制问题的基础。[@problem_id:1600509]", "problem": "考虑一个由两个耦合组件构成的简化热调节系统模型。这些组件相对于环境温度的温度偏差由 $x_1(t)$ 和 $x_2(t)$ 表示。该系统的动力学由以下线性常微分方程组描述：\n$$\n\\dot{x}_1(t) = -x_1(t) + x_2(t)\n$$\n$$\n\\dot{x}_2(t) = -x_2(t) + u(t)\n$$\n其中 $u(t)$ 是一个外部控制输入，代表受控的加热或冷却速率。我们寻求一种最优控制策略，在感兴趣的时间区间 $[0, T_f]$ 内操控系统状态。目标是最小化控制能耗，其由以下代价泛函量化：\n$$\nJ = \\frac{1}{2}\\int_0^{T_f} u(t)^2 dt\n$$\n使用庞特里亚金最小值原理 (Pontryagin's Minimum Principle)，确定最优控制律 $u^*(t)$ 的一般函数形式。您的最终表达式应是时间 $t$ 以及协态变量的初始值 $p_1(0)$ 和 $p_2(0)$ 的函数。", "solution": "我们应用庞特里亚金最小值原理。定义哈密顿函数\n$$\nH(x_{1},x_{2},p_{1},p_{2},u)=\\frac{1}{2}u^{2}+p_{1}\\left(-x_{1}+x_{2}\\right)+p_{2}\\left(-x_{2}+u\\right).\n$$\n最优性条件由 $\\partial H/\\partial u=0$ 得到，即\n$$\n\\frac{\\partial H}{\\partial u}=u+p_{2}=0 \\quad \\Rightarrow \\quad u^{*}(t)=-p_{2}(t).\n$$\n协态方程为 $ \\dot{p}_{i}=-\\partial H/\\partial x_{i}$。计算偏导数，\n$$\n\\frac{\\partial H}{\\partial x_{1}}=-p_{1}, \\qquad \\frac{\\partial H}{\\partial x_{2}}=p_{1}-p_{2},\n$$\n我们得到\n$$\n\\dot{p}_{1}=p_{1}, \\qquad \\dot{p}_{2}=-p_{1}+p_{2}.\n$$\n求解 $\\dot{p}_{1}=p_{1}$，其初始条件为 $p_{1}(0)$，得到\n$$\np_{1}(t)=p_{1}(0)\\exp(t).\n$$\n将其代入 $\\dot{p}_{2}$ 方程，得到一个线性常微分方程：\n$$\n\\dot{p}_{2}-p_{2}=-p_{1}(0)\\exp(t).\n$$\n使用积分因子 $\\exp(-t)$，\n$$\n\\frac{d}{dt}\\left(p_{2}(t)\\exp(-t)\\right)=-p_{1}(0),\n$$\n积分得到\n$$\np_{2}(t)\\exp(-t)=p_{2}(0)-p_{1}(0)\\,t \\quad \\Rightarrow \\quad p_{2}(t)=\\exp(t)\\left[p_{2}(0)-p_{1}(0)\\,t\\right].\n$$\n因此，最优控制为\n$$\nu^{*}(t)=-p_{2}(t)=\\exp(t)\\left[p_{1}(0)\\,t-p_{2}(0)\\right].\n$$\n如果终端状态是自由的且不存在终端代价，则横截条件给出 $p_{1}(T_{f})=p_{2}(T_{f})=0$，这意味着 $p_{1}(0)=p_{2}(0)=0$，因此 $u^{*}(t)=0$。然而，关于 $t$、$p_{1}(0)$ 和 $p_{2}(0)$ 的一般函数形式是上述表达式。", "answer": "$$\\boxed{\\exp(t)\\left[p_{1}(0)\\,t-p_{2}(0)\\right]}$$", "id": "1600509"}, {"introduction": "在推导出最优控制的一般形式后，下一步是求解一个具有特定边界条件的完整问题。这个练习要求你计算将系统从一个初始状态驱动到指定终端状态所需的最小控制能量。你需要应用在上一题中学到的方法，并进一步利用系统的边界条件来确定解中的待定常数，从而得到一个确切的最小成本值。[@problem_id:1600520]", "problem": "考虑一个用于控制小物体（例如电路板上的元件）温度的简化模型。设 $x(t)$ 为在时刻 $t$ 物体与其恒温环境之间的温差。根据牛顿冷却定律，物体会自然冷却（或升温）至环境温度，其温差以与温差本身成正比的速率衰减。使用一个热电控制器（如帕尔贴设备）来主动改变物体的温度。温度动态过程由以下线性常微分方程描述：\n$$ \\dot{x}(t) = -\\alpha x(t) + \\beta u(t) $$\n此处，$u(t)$ 是控制输入，它与供给控制器的功率成正比。参数 $\\alpha$ 和 $\\beta$ 是正常数，分别代表与环境的热耦合以及控制器的有效性。\n\n您的任务是找到在一个固定的时间区间 $T$ 内，将系统从一个已知的初始温差 $x(0) = x_0$ 驱动到与环境的热平衡状态 $x(T) = 0$ 的最小成本。成本由消耗的总控制能量定义，由以下泛函给出：\n$$ J = \\int_{0}^{T} \\frac{1}{2} u(t)^2 dt $$\n确定最小成本 $J$ 关于参数 $x_0$、$T$、$\\alpha$ 和 $\\beta$ 的闭式解析表达式。", "solution": "我们寻求最小能量控制，以将标量线性系统 $\\dot{x}(t)=-\\alpha x(t)+\\beta u(t)$ 从 $x(0)=x_{0}$ 驱动到 $x(T)=0$，其成本为 $J=\\int_{0}^{T}\\frac{1}{2}u(t)^{2}\\,dt$。这是一个具有二次型控制成本的固定端点最优控制问题。根据庞特里亚金最小值原理，定义哈密顿量\n$$\nH(x,u,p)=\\frac{1}{2}u^{2}+p\\left(-\\alpha x+\\beta u\\right).\n$$\n最优性条件 $\\partial H/\\partial u=0$ 给出\n$$\nu^{\\ast}(t)+\\beta p(t)=0 \\quad \\Rightarrow \\quad u^{\\ast}(t)=-\\beta p(t).\n$$\n协态方程为\n$$\n\\dot{p}(t)=-\\frac{\\partial H}{\\partial x}=\\alpha p(t),\n$$\n其解为\n$$\np(t)=C\\,\\exp(\\alpha t),\n$$\n其中 $C$ 是一个待由边界条件确定的常数。将 $u^{\\ast}$ 代入状态动态方程得到\n$$\n\\dot{x}(t)=-\\alpha x(t)-\\beta^{2}p(t)=-\\alpha x(t)-\\beta^{2}C\\,\\exp(\\alpha t).\n$$\n这个线性常微分方程的积分因子是 $\\exp(\\alpha t)$，因此\n$$\n\\frac{d}{dt}\\left(\\exp(\\alpha t)\\,x(t)\\right)=-\\beta^{2}C\\,\\exp(2\\alpha t).\n$$\n从 $0$ 积分到 $t$ 并使用 $x(0)=x_{0}$，我们得到\n$$\n\\exp(\\alpha t)\\,x(t)-x_{0}=-\\beta^{2}C\\int_{0}^{t}\\exp(2\\alpha s)\\,ds\n=-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}.\n$$\n因此，\n$$\nx(t)=\\exp(-\\alpha t)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha t)-1}{2\\alpha}\\right].\n$$\n施加终端约束 $x(T)=0$ 得到\n$$\n0=\\exp(-\\alpha T)\\left[x_{0}-\\beta^{2}C\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\\right]\n\\quad \\Rightarrow \\quad\nC=\\frac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\n于是最优控制为\n$$\nu^{\\ast}(t)=-\\beta p(t)=-\\beta C\\,\\exp(\\alpha t).\n$$\n最小成本为\n$$\nJ^{\\ast}=\\int_{0}^{T}\\frac{1}{2}\\left(u^{\\ast}(t)\\right)^{2}dt\n=\\frac{1}{2}\\int_{0}^{T}\\beta^{2}C^{2}\\exp(2\\alpha t)\\,dt\n=\\frac{1}{2}\\,\\beta^{2}C^{2}\\,\\frac{\\exp(2\\alpha T)-1}{2\\alpha}.\n$$\n代入 $C=\\dfrac{2\\alpha x_{0}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}$，\n$$\nJ^{\\ast}=\\frac{1}{2}\\cdot\\beta^{2}\\cdot\\frac{4\\alpha^{2}x_{0}^{2}}{\\beta^{4}\\left(\\exp(2\\alpha T)-1\\right)^{2}}\n\\cdot\\frac{\\exp(2\\alpha T)-1}{2\\alpha}\n=\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}.\n$$\n这就是所求的用 $x_{0}$、$T$、$\\alpha$ 和 $\\beta$ 表示的闭式表达式。", "answer": "$$\\boxed{\\frac{\\alpha x_{0}^{2}}{\\beta^{2}\\left(\\exp(2\\alpha T)-1\\right)}}$$", "id": "1600520"}, {"introduction": "许多现实世界中的最优控制问题，例如航天器轨道转移，其最终时间和最终状态都不是固定的。本练习将向你展示庞特里亚金最小值原理如何优雅地处理这些更复杂的情况。通过解决一个终点位于特定圆周上且结束时间自由的问题，你将学习并应用横截性条件 (transversality conditions)，这是PMP框架中用于处理非固定终端约束的强大工具。[@problem_id:1600523]", "problem": "一个粒子在二维笛卡尔平面内运动，其位置向量为 $\\mathbf{x}(t) = [x_1(t), x_2(t)]^T$，由速度输入 $\\mathbf{u}(t) = [u_1(t), u_2(t)]^T$ 控制。粒子的动力学由简单的积分器模型决定：\n$$\n\\dot{\\mathbf{x}}(t) = \\mathbf{u}(t)\n$$\n粒子在时刻 $t=0$ 时从原点出发，即 $\\mathbf{x}(0) = [0, 0]^T$。目标是引导粒子到达一个以原点为中心、半径为 $R$ 的目标圆。最终时间 $t_f$ 不固定，由粒子首次到达该圆的时刻决定。因此，终端条件由流形方程 $x_1(t_f)^2 + x_2(t_f)^2 = R^2$ 给出。\n\n目标是找到一个控制输入 $\\mathbf{u}(t)$，以最小化目标泛函 $J$，该泛函代表了控制能量和时间持续的组合：\n$$\nJ = \\int_{0}^{t_f} \\left( \\frac{1}{2} (u_1(t)^2 + u_2(t)^2) + 1 \\right) dt\n$$\n\n确定该目标泛函的最小可能值 $J_{min}$，用半径 $R$ 表示。", "solution": "我们将庞特里亚金最小值原理应用于最小化问题\n$$\nJ=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\left(u_{1}(t)^{2}+u_{2}(t)^{2}\\right)+1\\right)dt=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}(t)\\|^{2}+1\\right)dt\n$$\n约束条件为动力学方程 $\\dot{\\mathbf{x}}(t)=\\mathbf{u}(t)$，初始条件 $\\mathbf{x}(0)=\\mathbf{0}$，自由最终时间 $t_{f}$，以及终端流形 $g(\\mathbf{x}(t_{f}))=\\|\\mathbf{x}(t_{f})\\|^{2}-R^{2}=0$。\n\n定义哈密顿量\n$$\nH(\\mathbf{x},\\mathbf{u},\\boldsymbol{\\lambda})=\\frac{1}{2}\\|\\mathbf{u}\\|^{2}+1+\\boldsymbol{\\lambda}^{T}\\mathbf{u}.\n$$\n关于 $\\mathbf{u}$ 的平稳性条件给出\n$$\n\\frac{\\partial H}{\\partial \\mathbf{u}}=\\mathbf{u}+\\boldsymbol{\\lambda}=\\mathbf{0}\\quad\\Rightarrow\\quad \\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}(t).\n$$\n协态动力学为\n$$\n\\dot{\\boldsymbol{\\lambda}}(t)=-\\frac{\\partial H}{\\partial \\mathbf{x}}=\\mathbf{0}\\quad\\Rightarrow\\quad \\boldsymbol{\\lambda}(t)=\\boldsymbol{\\lambda}_{0}\\ \\text{(常数)}.\n$$\n因此，最优控制是常数 $\\mathbf{u}^{*}(t)=-\\boldsymbol{\\lambda}_{0}$，状态演化为\n$$\n\\mathbf{x}(t)=\\int_{0}^{t}\\mathbf{u}^{*}(\\tau)\\,d\\tau=\\mathbf{u}^{*}\\,t=-\\boldsymbol{\\lambda}_{0}\\,t.\n$$\n终端流形条件为\n$$\n\\|\\mathbf{x}(t_{f})\\|^{2}=R^{2}\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}\\,t_{f}^{2}=R^{2}\\quad\\Rightarrow\\quad t_{f}=\\frac{R}{\\|\\mathbf{u}^{*}\\|}.\n$$\n因为最终时间是自由的且没有终端成本，横截条件得出\n$$\nH(t_{f})=0.\n$$\n将 $\\mathbf{u}^{*}=-\\boldsymbol{\\lambda}_{0}$ 代入哈密顿量，得到\n$$\nH=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1+\\boldsymbol{\\lambda}_{0}^{T}\\mathbf{u}^{*}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\boldsymbol{\\lambda}_{0}\\|^{2}\n=\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1-\\|\\mathbf{u}^{*}\\|^{2}\n=1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}.\n$$\n令 $H(t_{f})=0$ 得出\n$$\n1-\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}=0\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|^{2}=2\\quad\\Rightarrow\\quad \\|\\mathbf{u}^{*}\\|=\\sqrt{2}.\n$$\n因此\n$$\nt_{f}=\\frac{R}{\\sqrt{2}}.\n$$\n那么最优成本为\n$$\nJ_{\\min}=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\|\\mathbf{u}^{*}\\|^{2}+1\\right)dt\n=\\int_{0}^{t_{f}}\\left(\\frac{1}{2}\\cdot 2+1\\right)dt\n=\\int_{0}^{t_{f}}2\\,dt\n=2t_{f}\n=2\\cdot\\frac{R}{\\sqrt{2}}\n=\\sqrt{2}\\,R.\n$$\n为了完整性，同样的值也可以通过直接变分法得到。对于任意固定的 $t_{f}$ 和满足 $\\|\\mathbf{y}\\|=R$ 的终端点 $\\mathbf{y}$，最小控制能量由常数控制 $\\mathbf{u}(t)=\\mathbf{y}/t_{f}$ 实现，得到\n$$\nJ(t_{f})=\\frac{1}{2}\\int_{0}^{t_{f}}\\|\\mathbf{u}\\|^{2}dt+\\int_{0}^{t_{f}}1\\,dt=\\frac{1}{2}\\cdot t_{f}\\cdot\\frac{R^{2}}{t_{f}^{2}}+t_{f}=\\frac{R^{2}}{2t_{f}}+t_{f}.\n$$\n通过设置 $\\frac{dJ}{dt_{f}}=-\\frac{R^{2}}{2t_{f}^{2}}+1=0$ 对 $t_{f}0$ 进行最小化，得到 $t_{f}=R/\\sqrt{2}$，因此 $J_{\\min}=\\sqrt{2}\\,R$，这与庞特里亚金分析的结果一致。", "answer": "$$\\boxed{\\sqrt{2}\\,R}$$", "id": "1600523"}]}