{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方法就是亲手实践。我们从一个最简单的情形入手：一个标量系统。通过这个练习 [@problem_id:1557202]，你将看到对于一阶系统，复杂的代数Riccati方程如何简化为一个可以直接手动求解的二次方程，这有助于你直观地理解该方程的核心代数结构，而不必先为复杂的矩阵运算而烦恼。", "problem": "考虑一个标量线性时不变（LTI）系统，由以下一阶常微分方程描述：\n$$\n\\dot{x}(t) = a x(t) + b u(t)\n$$\n其中 $x(t)$ 是系统状态，$u(t)$ 是控制输入。系统性能通过一个需要最小化的无限时域二次型代价函数来评估：\n$$\nJ = \\int_{0}^{\\infty} \\left( q x^2(t) + r u^2(t) \\right) dt\n$$\n最小化此代价函数的最优控制律是形式为 $u(t) = -Kx(t)$ 的线性状态反馈控制器。常数增益 $K$ 由相应Riccati方程的唯一正常数稳态解（用标量 $p$ 表示）确定。\n\n给定系统参数 $a = 2$，$b = 3$，以及代价函数加权因子 $q = 4$ 和 $r = 1$，求此正常数解 $p$ 的值。\n\n将最终答案四舍五入至三位有效数字。", "solution": "对于一个连续时间标量LTI系统 $\\dot{x}(t) = a x(t) + b u(t)$，其代价函数为 $J = \\int_{0}^{\\infty} \\left(q x^{2}(t) + r u^{2}(t)\\right) dt$，其稳态代数Riccati方程为\n$$\nA^{T} P + P A - P B R^{-1} B^{T} P + Q = 0.\n$$\n在标量情况下，$A = a$, $B = b$, $Q = q$, $R = r$, $P = p$，因此方程简化为\n$$\n2 a p - \\frac{b^{2}}{r} p^{2} + q = 0.\n$$\n将其重写为关于 $p$ 的标准二次方程，\n$$\n\\frac{b^{2}}{r} p^{2} - 2 a p - q = 0.\n$$\n应用二次公式，\n$$\np = \\frac{2 a \\pm \\sqrt{(2 a)^{2} + 4 \\frac{b^{2}}{r} q}}{2 \\frac{b^{2}}{r}} = \\frac{a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r} q}}{\\frac{b^{2}}{r}} = \\frac{r}{b^{2}}\\left(a \\pm \\sqrt{a^{2} + \\frac{b^{2}}{r} q}\\right).\n$$\n正的稳定解对应于正号。代入 $a = 2$, $b = 3$, $q = 4$, $r = 1$，\n$$\np = \\frac{1}{9}\\left(2 + \\sqrt{4 + 36}\\right) = \\frac{1}{9}\\left(2 + \\sqrt{40}\\right) = \\frac{1}{9}\\left(2 + 2\\sqrt{10}\\right).\n$$\n数值计算结果为 $p \\approx 0.925$（四舍五入至三位有效数字）。", "answer": "$$\\boxed{0.925}$$", "id": "1557202"}, {"introduction": "从标量系统过渡到更常见的多维矩阵系统后，直接求解Riccati方程通常需要借助数值工具。然而，验证一个给定的解是否正确，是掌握其矩阵形式的绝佳练习 [@problem_id:1557248]。这个实践将让你熟练运用ARE中的各项矩阵运算，并加深对该方程如何通过各矩阵项的平衡来确保最优性条件的理解。", "problem": "在为一个线性时不变系统设计最优控制器时，一位控制工程师正在使用线性二次调节器（LQR）框架。该系统由状态空间方程 $\\dot{x}(t) = Ax(t) + Bu(t)$ 描述，其矩阵如下：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nLQR 设计旨在最小化一个取决于状态权重矩阵 $Q$ 和控制权重矩阵 $R$ 的成本函数，具体如下：\n$$\nQ = \\begin{pmatrix} 5  3 \\\\ 3  5 \\end{pmatrix}, \\quad R = 1\n$$\n寻找最优控制律的一个关键步骤是求解一个对称正定矩阵 $P$ 的连续时间代数Riccati方程（ARE）。ARE 方程如下：\n$$\nA^T P + P A - P B R^{-1} B^T P + Q = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是一个适当维度的零矩阵。\n\n一位实习工程师提出了一个候选矩阵 $P_{cand}$ 作为该 ARE 的一个潜在解：\n$$\nP_{cand} = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}\n$$\n你的任务是验证该实习生提出的矩阵 $P_{cand}$ 是否是给定系统的代数Riccati方程的正确解。下列哪个陈述是正确的？\n\nA. 是的，当代入 $P_{cand}$ 时，方程完全成立。\n\nB. 不是，方程左侧计算结果为零矩阵，但所提出的矩阵 $P_{cand}$ 不是对称的。\n\nC. 不是，方程左侧计算结果为一个非零矩阵。\n\nD. 不是，因为控制权重矩阵 $R$ 不可逆，所以无法进行计算。", "solution": "我们必须验证候选矩阵 $P_{cand}$ 是否满足连续时间代数Riccati方程\n$$\nA^{T}P + P A - P B R^{-1} B^{T} P + Q = \\mathbf{0},\n$$\n对于给定的\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad Q = \\begin{pmatrix} 5  3 \\\\ 3  5 \\end{pmatrix}, \\quad R = 1,\n$$\n以及\n$$\nP_{cand} = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n首先，注意 $P_{cand}$ 是对称的。另外，由于 $R=1$，我们有 $R^{-1}=1$，这是良定义的，因此可以进行计算。\n\n计算 ARE 中的每一项：\n1) 计算 $A^{T}P_{cand}$：\n$$\nA^{T} = \\begin{pmatrix} 0  -2 \\\\ 1  -3 \\end{pmatrix}, \\quad\nA^{T}P_{cand} = \\begin{pmatrix} 0  -2 \\\\ 1  -3 \\end{pmatrix} \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}\n= \\begin{pmatrix} -2  -2 \\\\ 0  -2 \\end{pmatrix}.\n$$\n\n2) 计算 $P_{cand}A$：\n$$\nP_{cand}A = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}\n= \\begin{pmatrix} -2  0 \\\\ -2  -2 \\end{pmatrix}.\n$$\n\n3) 将前两项相加：\n$$\nA^{T}P_{cand} + P_{cand}A = \\begin{pmatrix} -2  -2 \\\\ 0  -2 \\end{pmatrix} + \\begin{pmatrix} -2  0 \\\\ -2  -2 \\end{pmatrix}\n= \\begin{pmatrix} -4  -2 \\\\ -2  -4 \\end{pmatrix}.\n$$\n\n4) 计算 $P_{cand} B R^{-1} B^{T} P_{cand}$ 项。由于 $R^{-1}=1$，\n$$\nP_{cand}B = \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad\nB^{T}P_{cand} = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 3  1 \\\\ 1  1 \\end{pmatrix}\n= \\begin{pmatrix} 1  1 \\end{pmatrix},\n$$\n因此\n$$\nP_{cand} B R^{-1} B^{T} P_{cand} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix}\n= \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n\n5) 构建 ARE 的左侧：\n$$\nA^{T}P_{cand} + P_{cand}A - P_{cand} B R^{-1} B^{T} P_{cand} + Q\n= \\begin{pmatrix} -4  -2 \\\\ -2  -4 \\end{pmatrix} - \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} + \\begin{pmatrix} 5  3 \\\\ 3  5 \\end{pmatrix}.\n$$\n合并矩阵：\n$$\n\\begin{pmatrix} -4  -2 \\\\ -2  -4 \\end{pmatrix} - \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n= \\begin{pmatrix} -5  -3 \\\\ -3  -5 \\end{pmatrix},\n$$\n然后\n$$\n\\begin{pmatrix} -5  -3 \\\\ -3  -5 \\end{pmatrix} + \\begin{pmatrix} 5  3 \\\\ 3  5 \\end{pmatrix}\n= \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}.\n$$\n\n因此，左侧恰好等于零矩阵，所以 $P_{cand}$ 满足 ARE。由于 $P_{cand}$ 是对称的且 $R$ 是可逆的，所以正确的选项是当带入 $P_{cand}$ 时，方程完全成立。", "answer": "$$\\boxed{A}$$", "id": "1557248"}, {"introduction": "代数Riccati方程不仅是一个数学工具，它还蕴含着深刻的物理和工程直觉。这个练习 [@problem_id:1557239] 通过一个思想实验，探讨当控制成本的权重趋于无穷大时的极限情况。通过分析这种极端场景，你将对LQR框架中状态调节与控制能量消耗之间的核心权衡关系，建立起更深刻、更直观的理解。", "problem": "考虑一个由状态空间方程 $\\dot{x}(t) = Ax(t) + Bu(t)$ 描述的连续时间线性时不变 (LTI) 系统，其中 $x(t) \\in \\mathbb{R}^n$ 是状态向量，$u(t) \\in \\mathbb{R}^m$ 是控制输入向量。该系统使用无穷时域线性二次调节器 (LQR) 进行控制，其目标是最小化以下二次代价函数：\n$$J = \\int_{0}^{\\infty} \\left( x(t)^T Q x(t) + u(t)^T R u(t) \\right) dt$$\n此处，$Q$ 是一个对称半正定的状态加权矩阵，$R$ 是一个对称正定的控制加权矩阵。最优控制律的形式为 $u(t) = -Kx(t)$，其中 $K$ 是常数最优增益矩阵。\n\n假设控制加权矩阵由一个正常数 $\\rho$ 参数化，即 $R = \\rho R_0$，其中 $R_0$ 是一个固定的对称正定矩阵。在这种情况下，我们希望理解当对控制力的惩罚变得非常大时，其行为如何。\n\n对于任意给定的非零状态向量 $x(t) \\neq 0$，求当标量参数 $\\rho$ 趋于无穷大时，最优控制向量的欧几里得范数 $||u(t)||_2$ 的极限值。", "solution": "无穷时域连续时间 LQR 问题得到最优状态反馈律 $u(t)=-Kx(t)$，其中\n$$\nK=R^{-1}B^{T}P,\n$$\n$P$ 是连续时间代数 Riccati 方程的唯一稳定对称半正定解\n$$\nA^{T}P+PA-PBR^{-1}B^{T}P+Q=0.\n$$\n通过缩放 $R=\\rho R_{0}$，其中 $R_{0}$ 是对称正定矩阵且 $\\rho0$，我们有 $R^{-1}=\\rho^{-1}R_{0}^{-1}$。Riccati 方程变为\n$$\nA^{T}P_{\\rho}+P_{\\rho}A-\\frac{1}{\\rho}P_{\\rho}BR_{0}^{-1}B^{T}P_{\\rho}+Q=0,\n$$\n并且对应的增益是\n$$\nK_{\\rho}=R^{-1}B^{T}P_{\\rho}=\\frac{1}{\\rho}R_{0}^{-1}B^{T}P_{\\rho}.\n$$\n假设满足标准 LQR 正则性条件，且 $A$ 是赫尔维茨矩阵，那么当 $\\rho\\to\\infty$ 时，序列 $\\{P_{\\rho}\\}$ 保持有界，并收敛于李雅普诺夫方程的唯一解 $P_{\\infty}$\n$$\nA^{T}P_{\\infty}+P_{\\infty}A+Q=0.\n$$\n在此条件下，\n$$\n\\lim_{\\rho\\to\\infty}K_{\\rho}=\\lim_{\\rho\\to\\infty}\\frac{1}{\\rho}R_{0}^{-1}B^{T}P_{\\rho}=0.\n$$\n因此，对于任意固定的非零状态 $x(t)\\neq 0$，最优控制为 $u_{\\rho}(t)=-K_{\\rho}x(t)$ 且满足\n$$\n\\|u_{\\rho}(t)\\|_{2}=\\|K_{\\rho}x(t)\\|_{2}\\leq\\|K_{\\rho}\\|_{2}\\,\\|x(t)\\|_{2}\\leq\\frac{1}{\\rho}\\,\\|R_{0}^{-1}\\|_{2}\\,\\|B\\|_{2}\\,\\|P_{\\rho}\\|_{2}\\,\\|x(t)\\|_{2}\\xrightarrow[\\rho\\to\\infty]{}0,\n$$\n因为 $\\|P_{\\rho}\\|_{2}$ 保持有界，而 $1/\\rho\\to 0$。因此，\n$$\n\\lim_{\\rho\\to\\infty}\\|u(t)\\|_{2}=0.\n$$", "answer": "$$\\boxed{0}$$", "id": "1557239"}]}