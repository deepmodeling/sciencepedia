{"hands_on_practices": [{"introduction": "最小二乘法的第一步是将理论模型和实验数据转化为标准线性回归形式 $Y = \\Phi \\theta$。本练习将指导您完成这一关键步骤，通过一个具体的二阶系统实例，练习构建回归矩阵 $\\Phi$。正确构建此矩阵是成功进行参数辨识的基础。[@problem_id:1588623]", "problem": "一位工程师正在对一个热过程进行系统辨识实验。该过程由以下二阶线性离散时间方程建模：\n$$y(k) = a_1 y(k-1) + a_2 y(k-2) + b_1 u(k-1)$$\n其中 $k$ 是离散时间索引，$y(k)$ 是测量的温度输出，$u(k)$ 是加热器功率输入，$a_1, a_2, b_1$ 是未知的模型参数。\n\n系统初始处于静止状态，即对于所有 $k \\leq 0$，$y(k) = 0$。在时间 $k=1$ 时，对系统施加单位阶跃输入，因此输入信号定义为当 $k  1$ 时 $u(k) = 0$，当 $k \\geq 1$ 时 $u(k) = 1$。\n\n记录到以下温度测量序列：\n$y(1) = 0.5$\n$y(2) = 1.5$\n$y(3) = 2.0$\n$y(4) = 2.2$\n$y(5) = 2.3$\n\n为了使用最小二乘法估计参数，将系统方程堆叠成 $Y = \\Phi \\theta$ 形式的线性回归模型，其中 $\\theta = \\begin{pmatrix} a_1  a_2  b_1 \\end{pmatrix}^T$ 是参数向量。使用从 $k=2$ 到 $k=5$ 的可用测量值，构建数值回归矩阵 $\\Phi$。", "solution": "给定的模型是二阶线性离散时间方程\n$$y(k)=a_{1}y(k-1)+a_{2}y(k-2)+b_{1}u(k-1).$$\n为了形成线性回归 $Y=\\Phi\\theta$，其中 $\\theta=\\begin{pmatrix}a_1  a_2  b_1\\end{pmatrix}^{T}$，回归矩阵 $\\Phi$ 在时间索引 $k$ 的每一行是回归向量的转置\n$$\\phi(k)^T=\\begin{pmatrix}y(k-1)  y(k-2)  u(k-1)\\end{pmatrix}.$$\n系统在 $k\\leq 0$ 时处于静止状态，因此 $y(0)=0$。输入是在 $k=1$ 时的单位阶跃，因此当 $k  1$ 时 $u(k)=0$，当 $k\\geq 1$ 时 $u(k)=1$。因此，对于 $k=2,3,4,5$，我们有 $u(k-1)=1$。\n\n使用测量输出 $y(1)=0.5$，$y(2)=1.5$，$y(3)=2.0$，$y(4)=2.2$，$y(5)=2.3$，$\\Phi$ 的各行计算如下：\n- 对于 $k=2$：$\\phi(2)^T=\\begin{pmatrix}y(1)  y(0)  u(1)\\end{pmatrix}=\\begin{pmatrix}0.5  0  1\\end{pmatrix}$。\n- 对于 $k=3$：$\\phi(3)^T=\\begin{pmatrix}y(2)  y(1)  u(2)\\end{pmatrix}=\\begin{pmatrix}1.5  0.5  1\\end{pmatrix}$。\n- 对于 $k=4$：$\\phi(4)^T=\\begin{pmatrix}y(3)  y(2)  u(3)\\end{pmatrix}=\\begin{pmatrix}2.0  1.5  1\\end{pmatrix}$。\n- 对于 $k=5$：$\\phi(5)^T=\\begin{pmatrix}y(4)  y(3)  u(4)\\end{pmatrix}=\\begin{pmatrix}2.2  2.0  1\\end{pmatrix}$。\n\n将这些行堆叠起来，得到数值回归矩阵\n$$\\Phi=\\begin{pmatrix}\n0.5  0  1\\\\\n1.5  0.5  1\\\\\n2.0  1.5  1\\\\\n2.2  2.0  1\n\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}0.5  0  1 \\\\ 1.5  0.5  1 \\\\ 2.0  1.5  1 \\\\ 2.2  2.0  1\\end{pmatrix}}$$", "id": "1588623"}, {"introduction": "在构建了回归矩阵之后，下一步就是求解参数。本练习将带您走完整个批处理最小二乘估计的流程，不仅包括动态参数，还引入了一个恒定扰动项。这反映了许多实际情况，例如环境温度的恒定影响，并展示了如何通过扩展模型来辨识这些因素。[@problem_id:1588627]", "problem": "一位工程师正在尝试识别在一个制造过程中观测到的离散时间动态系统的参数。该系统的输出 $y(k)$ 被认为遵循一个由输入 $u(k)$ 驱动并受恒定环境扰动 $d$ 影响的一阶线性模型。提出的模型为：\n$$y(k) = a y(k-1) + b u(k-1) + d$$\n其中 $k$ 是时间索引，而 $a$、$b$ 和 $d$ 是待确定的未知恒定参数。已从该过程中收集到如下的输入和输出数据序列：\n- 输入序列：$u(0) = 1$, $u(1) = 0$, $u(2) = 1$, $u(3) = 0$。\n- 输出序列：$y(0) = 2$, $y(1) = 4.1$, $y(2) = 2.9$, $y(3) = 4.6$, $y(4) = 3.3$。\n\n使用所提供的整个数据集，应用批量最小二乘法来找到参数的最佳估计值。待估计的参数向量为 $\\theta = \\begin{pmatrix} a  b  d \\end{pmatrix}^T$。\n\n请以行矩阵的形式提供您的最终答案，该矩阵按顺序包含 $a$、$b$ 和 $d$ 的估计值。将每个参数四舍五入到三位有效数字。", "solution": "我们用一阶线性系统对数据进行建模\n$$y(k) = a\\,y(k-1) + b\\,u(k-1) + d,$$\n并构建批量最小二乘回归 $Y = \\Phi \\theta$，其中 $\\theta = \\begin{pmatrix} a  b  d \\end{pmatrix}^{T}$。使用 $k=1,2,3,4$ 的样本，我们有\n$$\\Phi = \\begin{pmatrix}\n2  1  1\\\\\n4.1  0  1\\\\\n2.9  1  1\\\\\n4.6  0  1\n\\end{pmatrix}, \\quad\nY = \\begin{pmatrix}\n4.1\\\\\n2.9\\\\\n4.6\\\\\n3.3\n\\end{pmatrix}.$$\n批量最小二乘解为\n$$\\hat{\\theta} = \\left(\\Phi^{T}\\Phi\\right)^{-1}\\Phi^{T}Y,$$\n因此我们计算\n$$\\Phi^{T}\\Phi = \\begin{pmatrix}\n50.38  4.9  13.6\\\\\n4.9  2  2\\\\\n13.6  2  4\n\\end{pmatrix}, \\quad\n\\Phi^{T}Y = \\begin{pmatrix}\n48.61\\\\\n8.7\\\\\n14.9\n\\end{pmatrix}.$$\n因此 $\\hat{\\theta}$ 求解正规方程组\n$$\\begin{cases}\n50.38\\,a + 4.9\\,b + 13.6\\,d = 48.61,\\\\\n4.9\\,a + 2\\,b + 2\\,d = 8.7,\\\\\n13.6\\,a + 2\\,b + 4\\,d = 14.9.\n\\end{cases}$$\n将第三个方程减去第二个方程以消去 $b$：\n$$(13.6 - 4.9)a + (2-2)b + (4-2)d = 14.9 - 8.7,$$\n得到\n$$8.7\\,a + 2\\,d = 6.2 \\;\\Rightarrow\\; d = 3.1 - 4.35\\,a.$$\n根据第二个方程，\n$$2\\,b = 8.7 - 4.9\\,a - 2\\,d = 8.7 - 4.9\\,a - (6.2 - 8.7\\,a) = 2.5 + 3.8\\,a,$$\n所以\n$$b = 1.25 + 1.9\\,a.$$\n将 $b$ 和 $d$ 代入第一个方程：\n$$50.38\\,a + 4.9(1.25 + 1.9\\,a) + 13.6(3.1 - 4.35\\,a) = 48.61.$$\n计算各项：\n$$50.38\\,a + 6.125 + 9.31\\,a + 42.16 - 59.16\\,a = 48.61,$$\n$$(50.38 + 9.31 - 59.16)a + (6.125 + 42.16) = 48.61,$$\n$$0.53\\,a + 48.285 = 48.61 \\;\\Rightarrow\\; 0.53\\,a = 0.325 \\;\\Rightarrow\\; a = \\frac{0.325}{0.53} \\approx 0.613207547.$$\n那么\n$$b = 1.25 + 1.9\\,a \\approx 1.25 + 1.9 \\times 0.613207547 \\approx 2.415094339,$$\n$$d = 3.1 - 4.35\\,a \\approx 3.1 - 4.35 \\times 0.613207547 \\approx 0.432547171.$$\n将每个参数四舍五入到三位有效数字得到\n$$a \\approx 0.613,\\quad b \\approx 2.42,\\quad d \\approx 0.433.$$", "answer": "$$\\boxed{\\begin{pmatrix}0.613  2.42  0.433\\end{pmatrix}}$$", "id": "1588627"}, {"introduction": "模型结构的正确性对辨识结果至关重要。这个练习是一个警示性的案例，它通过一个思想实验，定量地揭示了当数据存在未建模的直流偏移时，直接应用最小二乘法会导致怎样的系统性偏差。通过计算这种偏差，您将深刻理解数据预处理和选择正确模型结构的重要性。[@problem_id:1588606]", "problem": "一位工程师正在为服务器的中央处理器（CPU）的热动态特性开发一个离散时间模型。该模型旨在将供给冷却风扇的输入功率 $u(k)$ 与CPU在离散时间步长 $k$ 的温度 $y(k)$ 联系起来。工程师为该系统假设了以下一阶线性模型结构：\n$$y(k) = a y(k-1) + b u(k-1) + \\epsilon(k)$$\n其中 $a$ 和 $b$ 是待辨识的模型参数，$\\epsilon(k)$ 代表噪声和未建模的动态。\n\n描述偏离稳定环境条件的真实物理过程，可以精确地表示为：\n$$y_0(k) = a_{\\text{true}} y_0(k-1) + b_{\\text{true}} u_0(k-1)$$\n这里，$y_0(k)$ 和 $u_0(k)$ 分别是真实的温度偏差和真实的风扇功率输入。已知的真实参数为 $a_{\\text{true}} = 0.9$ 和 $b_{\\text{true}} = 0.4$。输入信号 $u_0(k)$ 是一个平稳的零均值白噪声过程，其方差为 $\\sigma_u^2 = 2.0$（以适当的功率单位的平方计）。\n\n不幸的是，测量仪器存在系统误差。测量的温度 $y(k)$ 和测量的风扇功率 $u(k)$ 都包含恒定的直流偏置：\n$$y(k) = y_0(k) + y_{\\text{off}}$$\n$$u(k) = u_0(k) + u_{\\text{off}}$$\n传感器偏置确定为 $y_{\\text{off}} = 10.0$（单位为摄氏度）和 $u_{\\text{off}} = 1.0$（单位为功率）。\n\n工程师没有意识到这些偏置的关键重要性，直接对大量的原始测量数据 $(u(k), y(k))$ 应用了标准的批量最小二乘估计（LSE）算法。在无限大数据集的极限情况下，LSE算法将收敛到一组有偏的参数估计值 $(\\hat{a}, \\hat{b})$。\n\n计算这些有偏估计 $(\\hat{a}, \\hat{b})$ 的数值。请将 $\\hat{a}$ 和 $\\hat{b}$ 的答案四舍五入到四位有效数字。", "solution": "我们从工程师提出的不含截距项的回归模型开始：\n$$y(k)=a\\,y(k-1)+b\\,u(k-1)+\\epsilon(k),$$\n并定义回归量向量和参数向量为\n$$\\phi(k)\\triangleq\\begin{bmatrix}y(k-1)\\\\ u(k-1)\\end{bmatrix},\\qquad \\theta\\triangleq\\begin{bmatrix}a\\\\ b\\end{bmatrix}.$$\n对于无限大的数据集，最小二乘估计收敛于总体正规方程的解\n$$\\mathbb{E}\\{\\phi(k)\\phi^{\\top}(k)\\}\\,\\hat{\\theta}=\\mathbb{E}\\{\\phi(k)\\,y(k)\\}.$$\n\n给定偏离环境条件的真实动态，\n$$y_{0}(k)=a_{\\text{true}}\\,y_{0}(k-1)+b_{\\text{true}}\\,u_{0}(k-1),$$\n其中 $u_{0}(k)$ 是方差为 $\\sigma_{u}^{2}$ 的零均值白噪声，测量的信号为\n$$y(k)=y_{0}(k)+y_{\\text{off}},\\qquad u(k)=u_{0}(k)+u_{\\text{off}},$$\n我们可以用测量的回归量来表示 $y(k)$：\n$$y(k)=a_{\\text{true}}\\,y_{0}(k-1)+b_{\\text{true}}\\,u_{0}(k-1)+y_{\\text{off}}\n=a_{\\text{true}}\\,y(k-1)+b_{\\text{true}}\\,u(k-1)+c_{0},$$\n其中被忽略的常数（截距项）是\n$$c_{0}=y_{\\text{off}}(1-a_{\\text{true}})-b_{\\text{true}}\\,u_{\\text{off}}.$$\n\n令 $V\\triangleq \\operatorname{var}(y_{0}(k))$。对于由白噪声驱动的稳定一阶系统，\n$$V=a_{\\text{true}}^{2}V+b_{\\text{true}}^{2}\\sigma_{u}^{2}\\quad\\Rightarrow\\quad V=\\frac{b_{\\text{true}}^{2}\\sigma_{u}^{2}}{1-a_{\\text{true}}^{2}}.$$\n利用 $y_{0}$ 和 $u_{0}$ 的平稳性和零均值特性，以及 $y_{0}(k-1)$ 和 $u_{0}(k-1)$ 的独立性，我们得到所需的矩：\n$$\\mathbb{E}\\{y(k-1)\\}=y_{\\text{off}},\\quad \\mathbb{E}\\{u(k-1)\\}=u_{\\text{off}},$$\n$$\\mathbb{E}\\{y(k-1)^{2}\\}=V+y_{\\text{off}}^{2},\\quad \\mathbb{E}\\{u(k-1)^{2}\\}=\\sigma_{u}^{2}+u_{\\text{off}}^{2},\\quad \\mathbb{E}\\{y(k-1)u(k-1)\\}=y_{\\text{off}}u_{\\text{off}},$$\n以及\n$$y(k)=a_{\\text{true}}\\,y_{0}(k-1)+b_{\\text{true}}\\,u_{0}(k-1)+y_{\\text{off}},$$\n这给出\n$$\\mathbb{E}\\{y(k-1)y(k)\\}=a_{\\text{true}}V+y_{\\text{off}}^{2},\\qquad \\mathbb{E}\\{u(k-1)y(k)\\}=b_{\\text{true}}\\sigma_{u}^{2}+y_{\\text{off}}u_{\\text{off}}.$$\n\n因此，\n$$\\mathbb{E}\\{\\phi\\phi^{\\top}\\}=\\begin{bmatrix}V+y_{\\text{off}}^{2}  y_{\\text{off}}u_{\\text{off}}\\\\ y_{\\text{off}}u_{\\text{off}}  \\sigma_{u}^{2}+u_{\\text{off}}^{2}\\end{bmatrix},\\qquad\n\\mathbb{E}\\{\\phi y\\}=\\begin{bmatrix}a_{\\text{true}}V+y_{\\text{off}}^{2}\\\\ b_{\\text{true}}\\sigma_{u}^{2}+y_{\\text{off}}u_{\\text{off}}\\end{bmatrix}.$$\n解这个 $2\\times 2$ 线性系统得到\n$$\\hat{\\theta}=\\begin{bmatrix}\\hat{a}\\\\ \\hat{b}\\end{bmatrix}=\\bigl(\\mathbb{E}\\{\\phi\\phi^{\\top}\\}\\bigr)^{-1}\\,\\mathbb{E}\\{\\phi y\\}.$$\n\n现在代入给定的数值 $a_{\\text{true}}=0.9$，$b_{\\text{true}}=0.4$，$\\sigma_{u}^{2}=2.0$，$y_{\\text{off}}=10.0$，$u_{\\text{off}}=1.0$。首先计算\n$$V=\\frac{b_{\\text{true}}^{2}\\sigma_{u}^{2}}{1-a_{\\text{true}}^{2}}=\\frac{(0.4)^{2}\\cdot 2.0}{1-(0.9)^{2}}=\\frac{0.32}{0.19}=\\frac{32}{19}.$$\n因此\n$$\\mathbb{E}\\{\\phi\\phi^{\\top}\\}=\\begin{bmatrix}\\frac{32}{19}+100  10\\\\ 10  2+1\\end{bmatrix}=\\begin{bmatrix}\\frac{1932}{19}  10\\\\ 10  3\\end{bmatrix},\\quad\n\\mathbb{E}\\{\\phi y\\}=\\begin{bmatrix}0.9\\cdot \\frac{32}{19}+100\\\\ 0.4\\cdot 2+10\\end{bmatrix}=\\begin{bmatrix}\\frac{9644}{95}\\\\ \\frac{54}{5}\\end{bmatrix}.$$\n行列式为\n$$D=\\left(\\frac{1932}{19}\\right)\\cdot 3-10\\cdot 10=\\frac{5796}{19}-100=\\frac{3896}{19}.$$\n于是\n$$\\hat{a}=\\frac{3\\cdot \\frac{9644}{95}-10\\cdot \\frac{54}{5}}{D}=\\frac{\\frac{18672}{95}}{\\frac{3896}{19}}=\\frac{18672}{19480}\\approx 0.95852156058,$$\n$$\\hat{b}=\\frac{-10\\cdot \\frac{9644}{95}+\\left(\\frac{1932}{19}\\right)\\cdot \\frac{54}{5}}{D}=\\frac{\\frac{7888}{95}}{\\frac{3896}{19}}=\\frac{7888}{19480}\\approx 0.40492813105.$$\n将每个值四舍五入到四位有效数字，得到\n$$\\hat{a}\\approx 0.9585,\\qquad \\hat{b}\\approx 0.4049.$$", "answer": "$$\\boxed{\\begin{pmatrix}0.9585  0.4049\\end{pmatrix}}$$", "id": "1588606"}]}