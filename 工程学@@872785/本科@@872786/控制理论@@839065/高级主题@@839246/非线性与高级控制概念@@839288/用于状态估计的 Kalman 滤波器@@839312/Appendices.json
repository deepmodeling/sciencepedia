{"hands_on_practices": [{"introduction": "正确地初始化卡尔曼滤波器是成功实现状态估计的第一步，也是至关重要的一步。初始状态协方差矩阵 $P_{0|0}$ 不仅仅是一组数字，它更是我们向滤波器传达的关于初始状态估计可信度的声明。本练习将通过一个航天器姿态估计的场景，帮助你理解如何将现实世界中对初始状态的了解（或不了解）转化为滤波器的数学语言。[@problem_id:1587015]", "problem": "一名航空航天工程师的任务是实现一个卡尔曼滤波器，以估计一颗新型纳米卫星的姿态（方向）。该估计被简化为单个旋转轴。滤波器的状态向量定义为 $x_k = \\begin{pmatrix} \\theta_k \\\\ \\omega_k \\end{pmatrix}$，其中 $\\theta_k$ 是角位置，$\\omega_k$ 是离散时间步 $k$ 时的角速度。\n\n在从运载火箭部署的时刻（时间 $k=0$），一个星敏感器提供了对初始角位置 $\\theta_0$ 的一个相当精确的测量。然而，在部署过程中，星上陀螺仪发生故障，这意味着没有关于卫星初始角速度 $\\omega_0$ 的可靠信息。工程团队决定用测得的位置和零速度来初始化状态估计，即 $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_0 \\\\ 0 \\end{pmatrix}$。\n\n初始状态协方差矩阵 $P_{0|0}$ 代表了该初始估计中的不确定性，它被初始化为一个对角矩阵：\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^2  0 \\\\ 0  \\sigma_{\\omega}^2 \\end{pmatrix}\n$$\n这里，$\\sigma_{\\theta}^2$ 是初始角位置估计误差的方差，而 $\\sigma_{\\omega}^2$ 是初始角速度估计误差的方差。\n\n为了配置卡尔曼滤波器，使其能够正确反映对初始位置测量的高度置信度和对初始速度假设的极度缺乏置信度，以下哪种方差初始化策略最为合适？\n\nA. 为 $\\sigma_{\\theta}^2$ 取一个较小的值，为 $\\sigma_{\\omega}^2$ 取一个较大的值。\n\nB. 为 $\\sigma_{\\theta}^2$ 取一个较大的值，为 $\\sigma_{\\omega}^2$ 取一个较小的值。\n\nC. 为 $\\sigma_{\\theta}^2$ 和 $\\sigma_{\\omega}^2$ 都取较小的值。\n\nD. 为 $\\sigma_{\\theta}^2$ 和 $\\sigma_{\\omega}^2$ 都取较大的值。\n\nE. 为 $\\sigma_{\\theta}^2$ 取一个较小的值，并将 $\\sigma_{\\omega}^2$ 设为 $0$，因为初始速度估计被设为零。", "solution": "给定初始状态估计 $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_{0} \\\\ 0 \\end{pmatrix}$ 和初始协方差\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^{2}  0 \\\\ 0  \\sigma_{\\omega}^{2} \\end{pmatrix}.\n$$\n在卡尔曼滤波器中，协方差 $P$ 编码了不确定性：较小的方差意味着对相应状态分量的置信度更高，而较大的方差意味着置信度更低。不确定性对新测量值权重的影响由卡尔曼增益决定\n$$\nK_{k} = P_{k|k-1} H^{T} \\left(H P_{k|k-1} H^{T} + R\\right)^{-1},\n$$\n因此，$P_{k|k-1}$ 中较大的项会导致较大的增益和更快的测量校正；较小的项会导致较小的增益和较少的校正。\n\n在 $k=0$ 时，星敏感器提供了对 $\\theta_{0}$ 的精确测量，因此我们应该将 $\\sigma_{\\theta}^{2}$ 设置得较小，以反映对初始位置的高度置信度。关于 $\\omega_{0}$ 没有可靠的信息；所选择的初始值零是任意的。因此，我们应该将 $\\sigma_{\\omega}^{2}$ 设置得较大，以反映高度不确定性，并允许滤波器在通过过程动力学和后续测量获得信息时快速校正初始速度估计。\n\n评估各个选项：\n- A 使用一个小的 $\\sigma_{\\theta}^{2}$ 和一个大的 $\\sigma_{\\omega}^{2}$，这正确地编码了对位置的高置信度和对速度的低置信度。\n- B 会错误地降低精确位置的权重，并过度自信地相信任意设定的零速度。\n- C 会对未知的速度过度自信。\n- D 会不必要地不信任精确的位置测量。\n- E 将 $\\sigma_{\\omega}^{2}=0$，意味着对速度绝对确定，这与所述的缺乏置信度相反，并且会抑制必要的校正。\n\n因此，正确的选择是 A。", "answer": "$$\\boxed{A}$$", "id": "1587015"}, {"introduction": "卡尔曼滤波器的性能在很大程度上取决于其内部模型的准确性。这个思想实验探讨了一个常见的现实世界问题：当传感器存在一个持续的、未知的系统误差（即偏差）时，滤波器会发生什么？通过分析这种情景，我们能够更好地诊断滤波器的性能问题，并认识到标准卡尔曼滤波器在面对未建模误差时的局限性。[@problem_id:1587014]", "problem": "一个一维卡尔曼滤波器被用来估计一辆车的速度 $v$。该滤波器在线性系统和高斯噪声的标准假设下运行。\n\n车辆的动态特性被建模为随机游走，其中时间步 $k$ 的速度与前一时间步 $k-1$ 的速度关系为 $v_k = v_{k-1} + w_{k-1}$。这里，$w_{k-1}$ 是过程噪声，它是一个均值为零、方差为 $Q$ 的高斯随机变量。该项用于解释未建模的微小扰动，如路面坡度的变化或阵风。\n\n车辆的速度由单个传感器（速度计）测量。在时间步 $k$ 的测量值，记为 $z_k$，被建模为 $z_k = v_k + n_k$，其中 $n_k$ 是测量噪声，一个均值为零、方差为 $R$ 的高斯随机变量。过程噪声和测量噪声是不相关的。\n\n滤波器设计者不知道的是，该速度计存在制造缺陷，引入了一个恒定的正偏差 $b  0$。因此，输入到滤波器的实际测量值不是 $z_k$，而是 $z_{k, \\text{biased}} = v_{k, \\text{true}} + b + n_k$，其中 $v_{k, \\text{true}}$ 是真实速度。卡尔曼滤波器配置了标准的测量模型（假设 $b=0$），并且已经运行了足够长的时间，使其内部参数（如卡尔曼增益）达到稳态。\n\n在这种稳态条件下，下列哪个陈述最能描述滤波器的速度估计值 $\\hat{v}_k$ 与真实速度 $v_{k, \\text{true}}$ 之间的关系？假设在观测期间真实速度近似恒定。\n\nA. 滤波器的估计值 $\\hat{v}_k$ 在平均意义上将等于真实速度 $v_{k, \\text{true}}$。滤波器的机制足够稳健，能够抑制恒定偏差。\n\nB. 滤波器的估计值 $\\hat{v}_k$ 将会发散，随时间无限增长。\n\nC. 滤波器的估计值 $\\hat{v}_k$ 在平均意义上将低于真实速度 $v_{k, \\text{true}}$。\n\nD. 滤波器的估计值 $\\hat{v}_k$ 将围绕真实速度 $v_{k, \\text{true}}$ 振荡。\n\nE. 滤波器的估计值 $\\hat{v}_k$ 在平均意义上将高于真实速度 $v_{k, \\text{true}}$。", "solution": "我们将真实的动态特性和带偏差的测量建模为\n$$\nv_{k} = v_{k-1} + w_{k-1}, \\quad z_{k}^{\\text{biased}} = v_{\\text{true}} + b + n_{k},\n$$\n其中噪声是均值为零、不相关的高斯噪声，方差分别为 $Q$ 和 $R$，$b0$ 是一个恒定偏差。卡尔曼滤波器在不知道 $b$ 的情况下，使用标准的测量模型 $z_{k} = v_{k} + n_{k}$。\n\n对于具有单位状态转移矩阵和测量矩阵的一维随机游走模型，卡尔曼预测和更新方程为\n$$\n\\hat{v}_{k\\mid k-1} = \\hat{v}_{k-1\\mid k-1}, \\quad P_{k\\mid k-1} = P_{k-1\\mid k-1} + Q,\n$$\n$$\nK_{k} = \\frac{P_{k\\mid k-1}}{P_{k\\mid k-1} + R}, \\quad r_{k} = z_{k}^{\\text{biased}} - \\hat{v}_{k\\mid k-1},\n$$\n$$\n\\hat{v}_{k\\mid k} = \\hat{v}_{k\\mid k-1} + K_{k}\\, r_{k}.\n$$\n令 $m_{k\\mid k} = \\mathbb{E}[\\hat{v}_{k\\mid k}]$ 并假设 $v_{\\text{true}}$ 是恒定的。利用 $\\mathbb{E}[n_{k}]=0$，我们得到\n$$\n\\mathbb{E}[r_{k}] = \\mathbb{E}[z_{k}^{\\text{biased}} - \\hat{v}_{k\\mid k-1}] = v_{\\text{true}} + b - m_{k\\mid k-1}.\n$$\n对更新方程取期望，\n$$\nm_{k\\mid k} = m_{k\\mid k-1} + K_{k}\\big(v_{\\text{true}} + b - m_{k\\mid k-1}\\big).\n$$\n定义相对于真实速度的平均估计误差为 $e_{k} = m_{k\\mid k} - v_{\\text{true}}$。由于对于该模型有 $m_{k\\mid k-1} = m_{k-1\\mid k-1}$，我们得到标量递推关系\n$$\ne_{k} = (1 - K_{k})\\, e_{k-1} + K_{k}\\, b.\n$$\n在稳态下，$K_{k} \\to K^{\\ast}$，其中 $0  K^{\\ast}  1$（因为 $Q0, R0$ 意味着一个正的稳态协方差），稳态平均误差 $e^{\\ast}$ 满足\n$$\ne^{\\ast} = (1 - K^{\\ast}) e^{\\ast} + K^{\\ast} b \\;\\;\\Longrightarrow\\;\\; K^{\\ast} e^{\\ast} = K^{\\ast} b \\;\\;\\Longrightarrow\\;\\; e^{\\ast} = b.\n$$\n等价地，在稳态下，新息的均值为零，即 $\\mathbb{E}[r_{k}] = 0$，这得出 $v_{\\text{true}} + b - \\mathbb{E}[\\hat{v}_{k\\mid k-1}] = 0$，因此 $\\mathbb{E}[\\hat{v}_{k}] = v_{\\text{true}} + b$。因此，滤波器的估计值在平均意义上比真实速度高出恰好一个偏差值 $b$。这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "1587014"}, {"introduction": "现实世界中的传感器有时会产生完全错误的读数或“毛刺”。将这些异常值输入卡尔曼滤波器可能会严重破坏其状态估计，导致滤波器发散。本练习介绍了一种强大的技术——对归一化新息平方 (NIS) 进行卡方 ($\\chi^2$) 检验，用于对传入的测量值进行统计验证，从而决定是接受还是拒绝它们，以保护滤波器的稳定性。[@problem_id:1587043]", "problem": "一辆自动驾驶汽车的导航系统使用卡尔曼滤波器来跟踪前车。前车的状态通过其位置 $p$ 和速度 $v$ 在一维（纵向运动）上建模。在离散时间步 $k$ 的状态向量由 $x_k = [p_k, v_k]^T$ 给出。\n\n系统动力学由一个线性状态空间模型描述：\n$$x_k = F x_{k-1} + w_{k-1}$$\n$$z_k = H x_k + v_k$$\n\n其中：\n- $F = \\begin{pmatrix} 1  \\Delta t \\\\ 0  1 \\end{pmatrix}$ 是状态转移矩阵，时间步长为 $\\Delta t = 0.5 \\, \\text{s}$。\n- $w_{k-1}$ 是过程噪声，建模为零均值高斯分布，其协方差矩阵为 $Q = \\begin{pmatrix} \\frac{\\Delta t^4}{4}  \\frac{\\Delta t^3}{2} \\\\ \\frac{\\Delta t^3}{2}  \\Delta t^2 \\end{pmatrix} \\sigma_a^2$。未建模加速度的标准差为 $\\sigma_a = 0.2 \\text{ m/s}^2$。\n- $z_k$ 是来自雷达传感器的车辆位置的标量测量值。\n- $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$ 是测量矩阵。\n- $v_k$ 是测量噪声，建模为零均值高斯分布，其方差为 $R = \\sigma_z^2$，其中传感器的测量标准差为 $\\sigma_z = 1.0$ m。\n\n在时间步 $k-1$ 结束时，滤波器的后验状态估计及其误差协方差为：\n$$\\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\text{ m} \\\\ 2.0 \\text{ m/s} \\end{pmatrix}, \\quad P_{k-1|k-1} = \\begin{pmatrix} 0.5  0.1 \\\\ 0.1  0.2 \\end{pmatrix} \\text{ 单位为 } \\text{m}^2 \\text{ 或 } (\\text{m/s})^2$$\n\n在时间步 $k$，接收到一个新的测量值：$z_k = 15.0$ m。\n\n为防止因传感器故障引起的滤波器发散，对每个新测量值应用一个验证门。这是通过对归一化新息平方 (Normalized Innovation Squared, NIS) $\\epsilon_k$ 进行卡方 ($\\chi^2$) 检验来完成的。如果测量值 $z_k$ 的 NIS 值超过预定阈值，则将其作为异常值拒绝。对于维度为1的测量，在显著性水平 $\\alpha = 0.01$ 下，$\\chi^2$ 分布的临界值为 $\\chi^2_{1, 0.01} = 6.635$。\n\n基于此显著性水平的卡方检验，测量值 $z_k$ 计算出的 NIS 值是多少，该测量值应被接受还是拒绝？\n\nA. NIS 约等于 9.69，该测量值应被拒绝。\n\nB. NIS 约等于 9.69，该测量值应被接受。\n\nC. NIS 约等于 15.1，该测量值应被拒绝。\n\nD. NIS 约等于 5.45，该测量值应被接受。\n\nE. NIS 约等于 5.45，该测量值应被拒绝。", "solution": "我们使用恒速模型的标准离散卡尔曼滤波器预测和新息方程。预测步骤为\n$$\n\\hat{x}_{k|k-1} = F \\hat{x}_{k-1|k-1}, \\qquad P_{k|k-1} = F P_{k-1|k-1} F^{T} + Q.\n$$\n当 $\\Delta t = 0.5$ 时，我们有\n$$\nF = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}, \\quad \\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix}.\n$$\n因此，\n$$\n\\hat{x}_{k|k-1} = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix} = \\begin{pmatrix} 11.0 \\\\ 2.0 \\end{pmatrix}.\n$$\n对于 $\\sigma_{a} = 0.2$，过程噪声协方差为\n$$\nQ = \\begin{pmatrix} \\frac{\\Delta t^{4}}{4}  \\frac{\\Delta t^{3}}{2} \\\\ \\frac{\\Delta t^{3}}{2}  \\Delta t^{2} \\end{pmatrix}\\sigma_{a}^{2}\n= \\begin{pmatrix} \\frac{0.5^{4}}{4}  \\frac{0.5^{3}}{2} \\\\ \\frac{0.5^{3}}{2}  0.5^{2} \\end{pmatrix} (0.2)^{2}\n= \\begin{pmatrix} 0.000625  0.0025 \\\\ 0.0025  0.01 \\end{pmatrix}.\n$$\n计算 $F P_{k-1|k-1} F^{T}$：\n$$\nF P_{k-1|k-1} = \\begin{pmatrix} 1  0.5 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 0.5  0.1 \\\\ 0.1  0.2 \\end{pmatrix} = \\begin{pmatrix} 0.55  0.2 \\\\ 0.1  0.2 \\end{pmatrix},\n$$\n$$\nF P_{k-1|k-1} F^{T} = \\begin{pmatrix} 0.55  0.2 \\\\ 0.1  0.2 \\end{pmatrix}\\begin{pmatrix} 1  0 \\\\ 0.5  1 \\end{pmatrix} = \\begin{pmatrix} 0.65  0.2 \\\\ 0.2  0.2 \\end{pmatrix}.\n$$\n因此，\n$$\nP_{k|k-1} = \\begin{pmatrix} 0.65  0.2 \\\\ 0.2  0.2 \\end{pmatrix} + \\begin{pmatrix} 0.000625  0.0025 \\\\ 0.0025  0.01 \\end{pmatrix} = \\begin{pmatrix} 0.650625  0.2025 \\\\ 0.2025  0.21 \\end{pmatrix}.\n$$\n当 $H = \\begin{pmatrix} 1  0 \\end{pmatrix}$ 时，新息（测量残差）为\n$$\ny_{k} = z_{k} - H \\hat{x}_{k|k-1} = 15.0 - 11.0 = 4.0,\n$$\n新息协方差为\n$$\nS_{k} = H P_{k|k-1} H^{T} + R = 0.650625 + (1.0)^{2} = 1.650625.\n$$\n归一化新息平方 (NIS) 为\n$$\n\\epsilon_{k} = y_{k}^{T} S_{k}^{-1} y_{k} = \\frac{y_{k}^{2}}{S_{k}} = \\frac{16}{1.650625} \\approx 9.69.\n$$\n对于一维测量和显著性水平 $\\alpha = 0.01$，阈值为 $\\chi^{2}_{1,0.01} = 6.635$。由于 $9.69 > 6.635$，该测量值应作为异常值被拒绝。这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1587043"}]}