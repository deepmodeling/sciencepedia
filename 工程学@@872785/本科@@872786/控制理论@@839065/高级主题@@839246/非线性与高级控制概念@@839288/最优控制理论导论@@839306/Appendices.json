{"hands_on_practices": [{"introduction": "最优控制中最直观的概念之一是如何在物理限制下最快地完成任务。这个问题 [@problem_id:1585098] 探讨了一个经典场景：在最大加速度受限的情况下，尽快旋转一个物体至目标角度。通过解决这个问题，你将亲手推导出著名的“bang-bang”控制策略，即“全力加速，然后全力减速”，这是时间最优控制问题的一个标志性结果。", "problem": "作为一名控制工程师，您的任务是为两个机械臂设计一个时间最优机动，以在空间站上重新定位一个细长的精密仪器悬臂。\n\n该悬臂被建模为一个均匀刚性杆，可以绕其在空间中保持固定的质心在一个平面内旋转。其姿态由它与一个固定参考轴所成的角度 $\\theta(t)$ 描述。机器人可以共同对悬臂施加一个受控的净扭矩，从而产生角加速度 $\\alpha(t) = \\ddot{\\theta}(t)$。\n\n该机动必须从初始角度 $\\theta(0) = 0$ 的静止状态开始，并将悬臂带到最终目标角度 $\\theta_f > 0$。在机动结束时，悬臂也必须处于静止状态。\n\n一个关键的约束是悬臂的结构完整性。已知最大内部弯矩 $B$ 的大小与角加速度的大小成正比，即 $B = k |\\alpha|$，其中 $k$ 是一个正常数比例常数。为防止结构失效，该弯矩不得超过临界值 $B_{max}$。这对角加速度的最大允许值施加了限制，即 $|\\alpha(t)| \\le \\alpha_{max}$，其中 $\\alpha_{max} = B_{max}/k$。\n\n您的任务是确定完成此重新定向机动所需的最短时间 $t_f$。\n\n请用 $\\theta_f$ 和 $\\alpha_{max}$ 将您的答案表示为单个闭式解析表达式。\n\n假设所有角度均以弧度为单位。", "solution": "旋转运动学由状态方程 $\\dot{\\theta}=\\omega$ 和 $\\dot{\\omega}=\\alpha$ 描述，控制约束为 $|\\alpha(t)|\\leq \\alpha_{max}$。边界条件为 $\\theta(0)=0$，$\\omega(0)=0$ 和 $\\theta(t_{f})=\\theta_{f}>0$，$\\omega(t_{f})=0$。\n\n对于一个具有由 $|\\alpha|\\leq \\alpha_{max}$ 界定的凸控制集的二重积分系统的最小时间转移问题，最优控制几乎处处使约束饱和（bang-bang控制）。从静止开始并以正位移结束于静止状态，这意味着只有一次切换：首先 $\\alpha=\\alpha_{max}$ 以建立角速度，然后 $\\alpha=-\\alpha_{max}$ 以在 $\\theta=\\theta_{f}$ 时恰好使角速度回到零。任何 $|\\alpha|  \\alpha_{max}$ 的时间段都会增加机动时间，而不会改善约束的满足情况。\n\n在 $0\\leq t\\leq t_{s}$ 上，取 $\\alpha=\\alpha_{max}$。积分得到 $\\omega(t)=\\alpha_{max} t$ 和 $\\theta(t)=\\frac{1}{2}\\alpha_{max} t^{2}$。在切换时间 $t_{s}$，状态为 $\\omega_{s}=\\alpha_{max} t_{s}$ 和 $\\theta_{s}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}$。\n\n在 $t_{s}\\leq t\\leq t_{f}$ 上，取 $\\alpha=-\\alpha_{max}$。则 $\\omega(t)=\\omega_{s}-\\alpha_{max}(t-t_{s})$。强制 $\\omega(t_{f})=0$ 可得 $t_{f}-t_{s}=\\omega_{s}/\\alpha_{max}=t_{s}$，因此 $t_{f}=2 t_{s}$。减速期间累积的角度是 $\\omega(t)$ 曲线下的面积：\n$$\n\\theta_{decel}=\\int_{t_{s}}^{t_{f}}\\omega(t)\\,dt=\\omega_{s}(t_{f}-t_{s})-\\frac{1}{2}\\alpha_{max}(t_{f}-t_{s})^{2}=\\alpha_{max} t_{s}^{2}-\\frac{1}{2}\\alpha_{max} t_{s}^{2}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}.\n$$\n因此，总角度为\n$$\n\\theta_{f}=\\theta_{s}+\\theta_{decel}=\\frac{1}{2}\\alpha_{max} t_{s}^{2}+\\frac{1}{2}\\alpha_{max} t_{s}^{2}=\\alpha_{max} t_{s}^{2}.\n$$\n解出 $t_{s}$ 可得 $t_{s}=\\sqrt{\\theta_{f}/\\alpha_{max}}$，最短机动时间为\n$$\nt_{f}=2 t_{s}=2\\sqrt{\\frac{\\theta_{f}}{\\alpha_{max}}}.\n$$\n这满足了所有约束，并在角加速度边界 $|\\alpha|\\leq \\alpha_{max}$ 下实现了最短时间。", "answer": "$$\\boxed{2\\sqrt{\\frac{\\theta_{f}}{\\alpha_{max}}}}$$", "id": "1585098"}, {"introduction": "并非所有优化目标都是追求最快速度。在许多工程应用中，效率和能耗是更关键的考量。这个练习 [@problem_id:1585060] 将我们的关注点从时间转移到能量上，要求在固定的时间内，以最小的能量消耗（以控制力 $u(t)$ 的平方积分来衡量）移动负载。你会发现，最优策略不再是剧烈的“bang-bang”控制，而是一种平滑变化的控制力，这揭示了在最优控制中平滑性与能量效率之间的深刻联系。", "problem": "一台自动龙门起重机的任务是移动一个质量为 $m$ 的有效载荷。其运动被限制在由坐标 $x$ 表示的单一水平轴上。起重机的电机对被建模为质点的有效载荷施加一个时变力 $u(t)$，其运动方程为 $\\ddot{x}(t) = u(t)/m$。\n\n起重机必须在固定的时间 $T$ 内，将有效载荷从初始位置 $x(0) = 0$、初始速度为零 $\\dot{x}(0) = 0$ 运送至最终目的地 $x(T) = L$。在目的地，有效载荷必须完全停止，因此其最终速度必须为零，即 $\\dot{x}(T) = 0$。\n\n为确保平稳运行并最小化电能消耗，控制目标是找到能使以下成本泛函 $J$ 最小化的力函数 $u(t)$：\n$$J = \\int_{0}^{T} u^2(t) dt$$\n\n请确定完成此任务的最优控制力 $u^*(t)$，它应是时间 $t$、质量 $m$、最终位置 $L$ 和总时间 $T$ 的函数。", "solution": "我们将有效载荷建模为质点，其状态变量为 $x$ 和 $v=\\dot{x}$，控制输入为 $u(t)$，满足以下动力学方程\n$$\n\\dot{x}=v,\\qquad \\dot{v}=\\frac{u}{m},\n$$\n边界条件为 $x(0)=0$，$v(0)=0$，$x(T)=L$ 和 $v(T)=0$。需要最小化的成本为\n$$\nJ=\\int_{0}^{T} u^{2}(t)\\,dt.\n$$\n这是一个具有固定终端状态的线性二次最优控制问题。根据庞特里亚金最小值原理，定义哈密顿量\n$$\nH=u^{2}+\\lambda_{1} v+\\lambda_{2}\\frac{u}{m},\n$$\n其中 $\\lambda_{1}$ 和 $\\lambda_{2}$ 是协态变量。平稳性条件 $\\partial H/\\partial u=0$ 给出\n$$\n2u+\\frac{\\lambda_{2}}{m}=0 \\quad \\Rightarrow \\quad u^{*}(t)=-\\frac{\\lambda_{2}(t)}{2m}.\n$$\n协态动力学方程为\n$$\n\\dot{\\lambda}_{1}=-\\frac{\\partial H}{\\partial x}=0 \\quad \\Rightarrow \\quad \\lambda_{1}(t)=c_{1},\n$$\n$$\n\\dot{\\lambda}_{2}=-\\frac{\\partial H}{\\partial v}=-\\lambda_{1}=-c_{1} \\quad \\Rightarrow \\quad \\lambda_{2}(t)=-c_{1} t+c_{2},\n$$\n其中 $c_{1}$ 和 $c_{2}$ 是常数。因此，最优控制具有以下仿射形式\n$$\nu^{*}(t)=\\frac{c_{1} t-c_{2}}{2m}.\n$$\n使用带有 $u^*$ 的系统动力学方程，\n$$\n\\dot{v}=\\frac{u^{*}}{m}=\\frac{c_{1} t-c_{2}}{2 m^{2}},\n$$\n使用 $v(0)=0$ 进行积分，得到\n$$\nv(t)=\\frac{c_{1}}{4 m^{2}} t^{2}-\\frac{c_{2}}{2 m^{2}} t.\n$$\n再次使用 $x(0)=0$ 进行积分，得到\n$$\nx(t)=\\frac{c_{1}}{12 m^{2}} t^{3}-\\frac{c_{2}}{4 m^{2}} t^{2}.\n$$\n施加终端条件。首先，$v(T)=0$ 给出\n$$\n0=\\frac{c_{1}}{4 m^{2}} T^{2}-\\frac{c_{2}}{2 m^{2}} T \\quad \\Rightarrow \\quad c_{2}=\\frac{c_{1} T}{2}.\n$$\n其次，$x(T)=L$ 给出\n$$\nL=\\frac{c_{1}}{12 m^{2}} T^{3}-\\frac{1}{4 m^{2}}\\left(\\frac{c_{1} T}{2}\\right) T^{2}\n=\\frac{c_{1} T^{3}}{12 m^{2}}-\\frac{c_{1} T^{3}}{8 m^{2}}\n=-\\frac{c_{1} T^{3}}{24 m^{2}},\n$$\n因此\n$$\nc_{1}=-\\frac{24 m^{2} L}{T^{3}}, \\qquad c_{2}=-\\frac{12 m^{2} L}{T^{2}}.\n$$\n将这些常数代入 $u^{*}(t)=(c_{1} t-c_{2})/(2m)$ 得到\n$$\nu^{*}(t)=\\frac{1}{2m}\\left(-\\frac{24 m^{2} L}{T^{3}} t+\\frac{12 m^{2} L}{T^{2}}\\right)\n=\\frac{12 m L}{T^{3}}\\left(\\frac{T}{2}-t\\right).\n$$\n此 $u^{*}(t)$ 是时间的线性函数，在 $t  T/2$ 时为正（加速），而在 $t > T/2$ 时为负（减速）。", "answer": "$$\\boxed{\\frac{12 m L}{T^{3}}\\left(\\frac{T}{2}-t\\right)}$$", "id": "1585060"}, {"introduction": "当系统所处的环境本身是动态且不均匀时，最优控制问题会变得更加复杂和有趣。这个挑战 [@problem_id:1585108] 要求你驾驶一艘船，在水流速度随位置变化的河流中，以最短时间到达对岸。简单的直觉在此已不足以找到最优路径，我们必须运用庞特里亚金最小值原理的全部威力，特别是哈密顿量为零的条件，来精确规划控制策略。这个问题完美地展示了最优控制理论如何为在复杂动态环境中导航提供强大的数学工具。", "problem": "一艘自主航行的小船需要渡过一条宽度为 $W$ 的河流。建立一个笛卡尔坐标系，起始岸沿 x 轴，因此河流占据区域 $0 \\leq y \\leq W$。河水的水流平行于 x 轴，其速度不均匀，随离岸距离 y 的变化而变化，关系为 $v_c(y) = \\alpha y$，其中 $\\alpha$ 是一个常数。小船从原点 $(0,0)$ 出发。\n\n小船相对于水的速度保持恒定为 $v_{boat}$。小船的控制系统可以改变其航向角 $\\theta(t)$，该角度定义为小船相对于水的速度矢量与 y 轴正方向之间的夹角。目标是在尽可能短的时间 $t_f$ 内，将小船驾驶到对岸的目标位置 $(x_{target}, W)$。\n\n这是一个最优控制理论问题。将 Pontryagin 极大值原理 (PMP) 应用于该系统，可以定义一个哈密顿量 $H$。对于最短时间问题，哈密顿量由下式给出：\n$$ H = 1 + \\lambda_x (v_{c}(y) + v_{boat}\\sin\\theta) + \\lambda_y (v_{boat}\\cos\\theta) $$\n其中，$\\lambda_x$ 和 $\\lambda_y$ 是对应于状态 $x$ 和 $y$ 的协态变量。最优轨迹的两个关键条件是：\n1. 控制量 $\\theta(t)$ 必须在所有时刻都使哈密顿量的值最小。\n2. 沿着整个最优轨迹，哈密顿量的值必须为零。\n\n对于这个特定问题，PMP 的一个关键推论是协态变量 $\\lambda_x$ 是一个常数，我们将其表示为 $C$。\n\n给定以下参数：\n- 河宽, $W = 500.0$ 米\n- 船相对水的速度, $v_{boat} = 5.00$ 米/秒\n- 水流剖面常数, $\\alpha = 0.0100$ s⁻¹\n- 守恒的协态变量, $\\lambda_x = C = -0.0500$ 秒/米\n\n计算小船渡河所需的最短时间 $t_f$。答案以秒为单位，并四舍五入到三位有效数字。", "solution": "根据给定的定义，系统动力学方程为\n$$\\dot{x} = v_{c}(y) + v_{boat}\\sin\\theta = \\alpha y + v_{boat}\\sin\\theta,\\qquad \\dot{y} = v_{boat}\\cos\\theta.$$\n对于最短时间问题，哈密顿量为\n$$H = 1 + \\lambda_{x}(\\alpha y + v_{boat}\\sin\\theta) + \\lambda_{y}(v_{boat}\\cos\\theta).$$\nPontryagin 极大值原理指出：\n- 控制量 $\\theta(t)$ 逐点最小化 $H$。\n- 沿着最优轨迹， $H=0$。\n- 协态变量满足 $\\dot{\\lambda}_{x} = -\\frac{\\partial H}{\\partial x} = 0$ 和 $\\dot{\\lambda}_{y} = -\\frac{\\partial H}{\\partial y} = -\\lambda_{x}\\alpha$。\n\n已知 $\\lambda_{x}=C$ 是常数，则 $y$ 的协态变量为\n$$\\dot{\\lambda}_{y} = -\\alpha C.$$\n为了对 $\\theta$ 最小化 $H$，注意到对于固定的 $(y,\\lambda_{x},\\lambda_{y})$，与 $\\theta$ 相关的部分是\n$$\\lambda_{x} v_{boat}\\sin\\theta + \\lambda_{y} v_{boat}\\cos\\theta = v_{boat}\\,(\\lambda_{x},\\lambda_{y})\\cdot(\\sin\\theta,\\cos\\theta).$$\n由于 $(\\sin\\theta,\\cos\\theta)$ 是一个单位矢量，当它指向与 $(\\lambda_{x},\\lambda_{y})/\\sqrt{\\lambda_{x}^{2}+\\lambda_{y}^{2}}$ 相反的方向时，达到最小值，即\n$$\\min_{\\theta}\\left[\\lambda_{x} v_{boat}\\sin\\theta + \\lambda_{y} v_{boat}\\cos\\theta\\right] = -v_{boat}\\sqrt{\\lambda_{x}^{2}+\\lambda_{y}^{2}}.$$\n因此，沿着最优轨迹，\n$$H_{\\min} = 1 + \\lambda_{x}\\alpha y - v_{boat}\\sqrt{\\lambda_{x}^{2}+\\lambda_{y}^{2}} = 0.$$\n当 $\\lambda_{x}=C$ 时，这产生代数关系\n$$\\sqrt{C^{2}+\\lambda_{y}^{2}} = \\frac{1 + C\\alpha y}{v_{boat}}.$$\n最小化方向给出\n$$\\sin\\theta = -\\frac{\\lambda_{x}}{\\sqrt{\\lambda_{x}^{2}+\\lambda_{y}^{2}}} = -\\frac{C}{\\sqrt{C^{2}+\\lambda_{y}^{2}}},\\qquad \\cos\\theta = -\\frac{\\lambda_{y}}{\\sqrt{C^{2}+\\lambda_{y}^{2}}}.$$\n因此\n$$\\dot{y} = v_{boat}\\cos\\theta = -\\,\\frac{v_{boat}\\lambda_{y}}{\\sqrt{C^{2}+\\lambda_{y}^{2}}}.$$\n使用 $H=0$ 消去 $\\sqrt{C^{2}+\\lambda_{y}^{2}}$：\n$$\\sqrt{C^{2}+\\lambda_{y}^{2}} = \\frac{1 + C\\alpha y}{v_{boat}} \\quad\\Longrightarrow\\quad \\dot{y} = -\\,\\frac{v_{boat}^{2}\\lambda_{y}}{1 + C\\alpha y}.$$\n对 $H=0$ 关系式对时间求导，以确认一致性并将 $\\dot{y}$ 仅用 $y$ 表示。从\n$$C^{2}+\\lambda_{y}^{2} = \\left(\\frac{1 + C\\alpha y}{v_{boat}}\\right)^{2},$$\n求导得到\n$$2\\lambda_{y}\\dot{\\lambda}_{y} = 2\\left(\\frac{1 + C\\alpha y}{v_{boat}}\\right)\\left(\\frac{C\\alpha\\dot{y}}{v_{boat}}\\right).$$\n使用 $\\dot{\\lambda}_{y} = -\\alpha C$，上式简化为\n$$-\\,\\alpha C\\,\\lambda_{y} = \\frac{C\\alpha(1 + C\\alpha y)\\dot{y}}{v_{boat}^{2}}\\quad\\Longrightarrow\\quad \\dot{y} = -\\,\\frac{v_{boat}^{2}\\lambda_{y}}{1 + C\\alpha y}.$$\n现在使用代数关系消去 $\\lambda_{y}$：\n$$\\lambda_{y} = -\\sqrt{\\left(\\frac{1 + C\\alpha y}{v_{boat}}\\right)^{2} - C^{2}},$$\n其中选择负根以确保 $\\dot{y} = v_{boat}\\cos\\theta  0$（因为在给定参数下 $1 + C\\alpha y  0$）。因此\n$$\\dot{y} = \\frac{v_{boat}}{1 + C\\alpha y}\\sqrt{(1 + C\\alpha y)^{2} - (C v_{boat})^{2}}.$$\n反转得到\n$$dt = \\frac{1 + C\\alpha y}{v_{boat}\\sqrt{(1 + C\\alpha y)^{2} - (C v_{boat})^{2}}}\\,dy.$$\n从 $y=0$ 到 $y=W$ 积分，得到渡河时间 $t_{f}$：\n$$t_{f} = \\int_{0}^{W} \\frac{1 + C\\alpha y}{v_{boat}\\sqrt{(1 + C\\alpha y)^{2} - (C v_{boat})^{2}}}\\,dy.$$\n令 $u = 1 + C\\alpha y$，则 $du = C\\alpha\\,dy$，并且 $y:0\\to W$ 映射到 $u:1\\to 1 + C\\alpha W$。那么\n$$t_{f} = \\frac{1}{C\\alpha v_{boat}}\\int_{1}^{1 + C\\alpha W} \\frac{u}{\\sqrt{u^{2} - (C v_{boat})^{2}}}\\,du.$$\n使用 $\\int \\frac{u}{\\sqrt{u^{2} - a^{2}}}\\,du = \\sqrt{u^{2} - a^{2}}$，我们得到闭式解\n$$t_{f} = \\frac{1}{C\\alpha v_{boat}}\\left[\\sqrt{u^{2} - (C v_{boat})^{2}}\\right]_{u=1}^{u=1 + C\\alpha W} = \\frac{1}{C\\alpha v_{boat}}\\left(\\sqrt{(1 + C\\alpha W)^{2} - (C v_{boat})^{2}} - \\sqrt{1 - (C v_{boat})^{2}}\\right).$$\n现在代入给定的数值 $W=500.0$，$v_{boat}=5.00$，$\\alpha=0.0100$，$C=-0.0500$：\n$$C\\alpha W = (-0.0500)(0.0100)(500.0) = -0.25,\\qquad C v_{boat} = (-0.0500)(5.00) = -0.25,$$\n$$\\sqrt{(1 + C\\alpha W)^{2} - (C v_{boat})^{2}} = \\sqrt{0.75^{2} - 0.25^{2}} = \\sqrt{0.50},$$\n$$\\sqrt{1 - (C v_{boat})^{2}} = \\sqrt{1 - 0.25^{2}} = \\sqrt{0.9375},\\qquad C\\alpha v_{boat} = (-0.0500)(0.0100)(5.00) = -0.0025.$$\n因此\n$$t_{f} = \\frac{1}{-0.0025}\\left(\\sqrt{0.50} - \\sqrt{0.9375}\\right) \\approx (-400)\\,(-0.261139\\ldots) \\approx 1.04456\\times 10^{2}\\ \\text{s}.$$\n四舍五入到三位有效数字，\n$$t_{f} \\approx 104\\ \\text{s}.$$", "answer": "$$\\boxed{104}$$", "id": "1585108"}]}