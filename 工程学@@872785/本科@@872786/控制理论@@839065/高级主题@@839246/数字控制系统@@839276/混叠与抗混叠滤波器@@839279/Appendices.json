{"hands_on_practices": [{"introduction": "为了在数字世界中准确地捕捉一个连续信号，我们必须以足够高的频率对其进行采样。奈奎斯特-香农采样定理为此过程提供了基本准则。第一个练习 [@problem_id:1557482] 旨在巩固这一核心原则，它要求您确定完美重建一个信号所需的理论最低采样率，从而从一开始就避免信息的失真。", "problem": "一个音频工程师团队正在为一家专业录音棚设计一款定制的模拟-数字转换器 (ADC)。他们的目标是捕获一个复杂的音频信号，同时避免因混叠造成信息丢失。待数字化的信号，代表来自一个灵敏麦克风的电压 $V(t)$，可以精确地建模为三个正弦分量的叠加：\n\n$$V(t) = A_1 \\cos(2\\pi f_1 t + \\phi_1) + A_2 \\cos(2\\pi f_2 t + \\phi_2) + A_3 \\cos(2\\pi f_3 t + \\phi_3)$$\n\n已知这些分量的频率分别为 $f_1 = 18.0 \\text{ kHz}$、$f_2 = 35.5 \\text{ kHz}$ 和 $f_3 = 45.0 \\text{ kHz}$。振幅 $(A_1, A_2, A_3)$ 和相位 $(\\phi_1, \\phi_2, \\phi_3)$ 是任意的，并且可以变化。为确保原始的连续时间信号能够从其离散样本中完美重建，必须仔细选择采样率。\n\n确定避免该信号发生混叠所需的理论最低采样率。请用千赫兹 (kHz) 表示您的答案。", "solution": "该信号是频率为 $f_1$、$f_2$ 和 $f_3$ 的三个正弦波之和，因此它是一个基带受限信号，其最高频率为 $f_{max}=\\max\\{f_1,f_2,f_3\\}$。根据奈奎斯特-香农采样定理，要无混叠地完美重建一个基带信号，采样频率需要满足\n$$\nf_s \\geq 2 f_{max}.\n$$\n在此， $f_{max}=\\max\\{18.0,35.5,45.0\\}\\ \\text{kHz}=45.0\\ \\text{kHz}$，因此理论最低采样率为\n$$\nf_{s, \\min}=2 f_{max}=2 \\times 45.0\\ \\text{kHz}=90.0\\ \\text{kHz}.\n$$\n振幅和相位不影响此界限。", "answer": "$$\\boxed{90.0}$$", "id": "1557482"}, {"introduction": "虽然奈奎斯特速率是理想目标，但实际的硬件或成本限制有时会迫使我们使用较低的采样率。当这种情况发生时，信号会如何被错误地解读？接下来的练习 [@problem_id:1557455] 将直接展示欠采样的后果，即一个高频信号如何“折叠”并伪装成一个完全不同的低频信号。掌握这种计算对于诊断和解释采样数据中的异常现象至关重要。", "problem": "一位控制工程师的任务是为一台高速旋转机械实现一个数字监控系统。安装在机器上的传感器测量其主振动，该振动是一个频率为 $f_{actual} = 120 \\text{ Hz}$ 的纯正弦信号。工程师将此传感器连接到一个数据采集 (DAQ) 系统。然而，由于预算限制，唯一可用的 DAQ 系统的最大采样率为 $f_s = 100 \\text{ Hz}$，工程师将此采样率用于测量。当工程师分析数字采样数据时，振荡的频率似乎与实际的物理振动不同。\n\n假设没有使用抗混叠滤波器，计算在离散时间数据中观察到的机器振动的表观频率。表观频率定义为在范围 $0 \\le f_{apparent} \\le f_s/2$ 内的唯一频率 $f_{apparent}$。\n\n以 Hz 为单位表示您的最终答案，并四舍五入到三位有效数字。", "solution": "连续时间正弦信号为 $x(t)=A\\cos(2\\pi f_{actual} t+\\phi)$，其中 $f_{actual}=120$。以速率 $f_s=100$ 进行采样，产生一个离散时间正弦信号，其数字角频率为\n$$\n\\omega_d=2\\pi\\left(\\frac{f_{actual}}{f_s}\\right)\\ \\text{mod}\\ 2\\pi.\n$$\n混叠的产生是因为频谱副本出现在 $f_s$ 的整数倍处。从采样数据中观察到的表观连续时间频率是在 $[0, f_s/2]$ 范围内的唯一折叠频率，由下式给出\n$$\nf_{apparent}=\\left|f_{actual}-n f_s\\right|,\n$$\n其中选择 $n\\in\\mathbb{Z}$ 以最小化 $\\left|f_{actual}-n f_s\\right|$，等价于 $n=\\operatorname{round}\\!\\left(\\frac{f_{actual}}{f_s}\\right)$。\n\n计算\n$$\nn=\\operatorname{round}\\!\\left(\\frac{120}{100}\\right)=\\operatorname{round}(1.2)=1,\n$$\n所以\n$$\nf_{apparent}=\\left|120-1\\cdot 100\\right|=20.\n$$\n由于 $f_{apparent}=20\\leq \\frac{f_s}{2}=50$，不需要进一步折叠。四舍五入到三位有效数字得到 $20.0$。", "answer": "$$\\boxed{20.0}$$", "id": "1557455"}, {"introduction": "理解混叠现象是一回事，而作为工程师，更重要的是主动预防它。在现实世界的系统中，我们不能假设信号中不包含有害的高频噪声，而是必须在采样前将其滤除。最后一个练习 [@problem_id:1557475] 将您置于设计者的位置，要求您设计一个抗混叠滤波器以满足严格的衰减要求，这是控制系统和仪器仪表设计中的一项典型工程任务。", "problem": "一个数字控制系统正在为一个高精度制造过程进行设计。该系统依赖于一个以频率 $f_s = 20.0 \\text{ kHz}$ 采样的传感器测量值。该控制算法被设计用于有效管理高达奈奎斯特频率的系统动态。然而，制造环境中包含的设备会产生强烈的正弦电磁干扰，以频率为 $f_n = 35.0 \\text{ kHz}$ 的噪声分量污染传感器信号。\n\n为防止此高频噪声混叠到控制器的操作频带内，在采样器前方的信号路径中放置了一个巴特沃斯低通抗混叠滤波器。该滤波器的截止频率 $f_c$ 被精确地设置为采样系统的奈奎斯特频率。为了让控制器保持其所需的性能和稳定性裕度，频率为 $f_n$ 的噪声分量的幅值必须至少衰减1000倍（即，其滤波后的幅值不得超过其原始幅值的 $0.1\\%$）。\n\n确定为满足此衰减规格所需的巴特沃斯滤波器的最小整数阶数 $N$。", "solution": "采样频率给定为 $f_s = 20.0$ kHz。因此，奈奎斯特频率为 $f_N = \\frac{f_s}{2}$，且抗混叠巴特沃斯滤波器的截止频率为 $f_c = f_N$。干扰频率为 $f_n = 35.0$ kHz，因此相对于截止频率的频率比为\n$$\nr \\equiv \\frac{f_n}{f_c} = \\frac{f_n}{f_s/2} = \\frac{35.0}{10.0} = 3.5.\n$$\n\n对于一个N阶巴特沃斯低通滤波器，其在频率 $f$ 处的幅频响应为\n$$\n|H(j2\\pi f)| = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_c}\\right)^{2N}}}.\n$$\n在 $f = f_n$ 处，该响应变为\n$$\n|H(j2\\pi f_n)| = \\frac{1}{\\sqrt{1 + r^{2N}}}.\n$$\n\n技术规格要求幅值衰减因子至少为1000，即\n$$\n|H(j2\\pi f_n)| \\leq \\frac{1}{1000}.\n$$\n将此条件施加于巴特沃斯响应，得到\n$$\n\\frac{1}{\\sqrt{1 + r^{2N}}} \\leq \\frac{1}{1000}\n\\;\\;\\Longrightarrow\\;\\;\n\\sqrt{1 + r^{2N}} \\geq 10^{3}\n\\;\\;\\Longrightarrow\\;\\;\n1 + r^{2N} \\geq 10^{6}\n\\;\\;\\Longrightarrow\\;\\;\nr^{2N} \\geq 10^{6} - 1.\n$$\n取自然对数，\n$$\n2N \\ln r \\geq \\ln\\!\\left(10^{6} - 1\\right)\n\\;\\;\\Longrightarrow\\;\\;\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^{6} - 1\\right)}{\\ln r}.\n$$\n当 $r = 3.5$ 时，\n$$\nN \\geq \\frac{1}{2}\\,\\frac{\\ln\\!\\left(10^{6} - 1\\right)}{\\ln(3.5)} \\approx 5.514\\ldots\n$$\n因此，最小整数阶为向上取整：\n$$\nN_{\\min} = 6.\n$$\n\n验证：\n- 当 $N = 5$ 时：$r^{2N} = 3.5^{10} \\approx 2.77 \\times 10^{5}$，因此 $|H| \\approx \\frac{1}{\\sqrt{1 + 2.77 \\times 10^{5}}} \\approx \\frac{1}{526}$，这不满足要求。\n- 当 $N = 6$ 时：$r^{2N} = 3.5^{12} \\approx 3.38 \\times 10^{6}$，因此 $|H| \\approx \\frac{1}{\\sqrt{1 + 3.38 \\times 10^{6}}} \\approx \\frac{1}{1838}$，这满足要求。\n\n因此，需要一个六阶巴特沃斯滤波器。", "answer": "$$\\boxed{6}$$", "id": "1557475"}]}