## 引言
在控制理论和电气工程领域，将物理系统转化为精确的数学模型是进行分析、预测和设计的首要步骤。特别是对于电气电路，一个可靠的模型是设计高性能控制器、滤波器或任何信号处理单元的基础。然而，从一个复杂的电路图到一组可供分析的方程，这一过程往往存在知识鸿沟，初学者常常不知如何系统地着手。本文旨在填补这一鸿沟，全面介绍为电气[电路建模](@entry_id:263743)的核心技术。

在接下来的内容中，读者将踏上一段从具体到抽象的建模之旅。第一章“原理与机制”将从最基本的物理定律出发，讲解如何使用[基尔霍夫定律](@entry_id:180785)和元件本构关系推导描述电路动态的[微分方程](@entry_id:264184)，并进一步介绍如何将这些时域模型转换为功能更强大的[频域](@entry_id:160070)[传递函数](@entry_id:273897)和现代控制理论所青睐的[状态空间表示](@entry_id:147149)法。第二章“应用与跨学科联系”将展示这些模型在信号处理、机电系统乃至生物和经济学等领域的广泛实际应用，揭示[电路建模](@entry_id:263743)作为一种通用分析语言的强大威力。最后，通过第三章“动手实践”中的精选练习，您将有机会亲手应用所学知识，巩固对关键概念的理解。

## 原理与机制

在对电气系统进行控制之前，我们必须首先构建其数学模型。这些模型是描述系统动态行为的数学表达式，它们使我们能够分析、预测并最终设计控制器来改变系统的响应。本章将深入探讨为电气电路建立数学模型的核心原理与机制。我们将从基于基本物理定律推导[微分方程](@entry_id:264184)的经典方法入手，逐步过渡到更为抽象但功能强大的[频域](@entry_id:160070)和[状态空间](@entry_id:177074)方法。

### 建[模的基](@entry_id:156416)础：元件定律与电路法则

任何电气电路的动态行为都源于其储能元件——[电容器](@entry_id:267364)和[电感器](@entry_id:260958)——的物理特性。与仅消耗能量的电阻器不同，[电容器](@entry_id:267364)和电感器能够分别以电场和磁场的形式储存能量，从而引入了与时间相关的行为。

这些元件的基本本构关系是建[模的基](@entry_id:156416)石：

- **电阻器 (Resistor)**：电阻器两端的电压 $v_R(t)$ 与流过它的电流 $i_R(t)$ 成正比，这由[欧姆定律](@entry_id:276027)描述：$v_R(t) = R i_R(t)$。其中 $R$ 是电阻。

- **[电容器](@entry_id:267364) (Capacitor)**：流过[电容器](@entry_id:267364)的电流 $i_C(t)$ 与其两端电压 $v_C(t)$ 的变化率成正比：$i_C(t) = C \frac{d v_C(t)}{dt}$。其中 $C$ 是电容。反之，[电容器](@entry_id:267364)的电压是流过其电流的积分，这表明电压具有“记忆”效应，不能瞬时改变。

- **电感器 (Inductor)**：电感器两端的电压 $v_L(t)$ 与流过它的电流 $i_L(t)$ 的变化率成正比：$v_L(t) = L \frac{d i_L(t)}{dt}$。其中 $L$ 是电感。相应地，[电感器](@entry_id:260958)的电流是其两端电压的积分，因此电流值也不能瞬时改变。

将这些元件组[合成电路](@entry_id:202590)后，我们使用两个基本[守恒定律](@entry_id:269268)——**基尔霍夫定律 (Kirchhoff's Laws)**——来系统地推导描述整个电路行为的方程：

- **[基尔霍夫电压定律](@entry_id:276614) (Kirchhoff's Voltage Law, KVL)**：沿任何闭合回路，所有元件两端电压的代数和为零。这本质上是[能量守恒](@entry_id:140514)的体现。

- **[基尔霍夫电流定律](@entry_id:270632) (Kirchhoff's Current Law, KCL)**：在电路的任何节点，所有流入和流出该节点的电流的代数和为零。这反映了[电荷守恒](@entry_id:264158)。

通过将元件的[本构关系](@entry_id:186508)代入由基尔霍夫定律建立的电路方程中，我们便能得到描述电路动态的[微分方程](@entry_id:264184)。

### [微分方程](@entry_id:264184)建模方法

直接从电路图推导[微分方程](@entry_id:264184)是最基本也是最直观的建模方法。方程的阶数通常由电路中独立的储能元件数量决定。

#### [一阶系统](@entry_id:147467)

仅包含一个[储能](@entry_id:264866)元件（或多个可合并为一个的储能元件）的电路通常由[一阶微分方程](@entry_id:173139)描述。

一个典型的例子是 **RC 电路**。考虑一个由直流电压源 $V_s$、一个电阻 $R$ 和一个电容 $C$ [串联](@entry_id:141009)组成的充电电路 [@problem_id:1592504]。当电路闭合时，根据 KVL，电压源的电压等于电阻和电容上的[电压降](@entry_id:267492)之和：
$V_s = v_R(t) + v_C(t)$
使用欧姆定律 $v_R(t) = R i(t)$ 和电容的本构关系 $i(t) = C \frac{dv_C(t)}{dt}$，我们将电流 $i(t)$ 替换掉。注意，在[串联电路](@entry_id:275175)中，流过电阻和电容的电流是相同的。
$V_s = R \left(C \frac{dv_C(t)}{dt}\right) + v_C(t)$
整理后，我们得到一个描述[电容器](@entry_id:267364)电压 $v_C(t)$ 动态行为的[一阶线性常微分方程](@entry_id:164502)：
$RC \frac{dv_C(t)}{dt} + v_C(t) = V_s$
这个方程精确地描述了[电容器](@entry_id:267364)电压如何从其初始值指数地趋近于电源电压 $V_s$。

另一个经典的一阶系统是 **RL 电路**。让我们以一个简化的汽车点火线圈模型为例 [@problem_id:1592482]。在 $t > 0$ 时，一个电感 $L$ 与一个[负载电阻](@entry_id:267991) $R_2$ 形成一个无源回路。根据 KVL，电感电压与电阻电压之和为零：
$v_L(t) + v_{R2}(t) = 0$
代入本构关系 $v_L(t) = L \frac{di_L(t)}{dt}$ 和 $v_{R2}(t) = R_2 i_L(t)$，我们得到：
$L \frac{di_L(t)}{dt} + R_2 i_L(t) = 0$
这是一个齐次[一阶微分方程](@entry_id:173139)，其解描述了电流的指数衰减。值得注意的是，解这个方程需要一个初始条件，$i_L(0)$。由于[电感](@entry_id:276031)电流不能突变，这个初始值由开关动作之前 ($t  0$) 电路所处的[稳态](@entry_id:182458)决定。如果电路在 $t0$ 时已达到[稳态](@entry_id:182458)，电感器相当于短路，初始电流可由欧姆定律算出。

#### [二阶系统](@entry_id:276555)

包含两个独立储能元件（一个[电感](@entry_id:276031)和一个电容）的电路通常由二阶微分方程描述，它们能够展现出更复杂的动态行为，如[振荡](@entry_id:267781)和阻尼。

经典的 **[串联](@entry_id:141009) RLC 电路** 是一个完美的例子 [@problem_id:1592500]。当一个[串联](@entry_id:141009)的 RLC 电路连接到直流电压源 $V_s$ 时，KVL 方程为：
$v_R(t) + v_L(t) + v_C(t) = V_s$
我们希望得到一个关于电容电压 $v_C(t)$ 的方程。我们知道，流过所有[串联](@entry_id:141009)元件的电流是同一个电流 $i(t)$，且 $i(t) = C \frac{dv_C(t)}{dt}$。因此，我们可以表达 $v_R(t)$ 和 $v_L(t)$ 如下：
$v_R(t) = R i(t) = RC \frac{dv_C(t)}{dt}$
$v_L(t) = L \frac{di(t)}{dt} = L \frac{d}{dt}\left(C \frac{dv_C(t)}{dt}\right) = LC \frac{d^2v_C(t)}{dt^2}$
将这些代入 KVL 方程，得到：
$LC \frac{d^2v_C(t)}{dt^2} + RC \frac{dv_C(t)}{dt} + v_C(t) = V_s$
将方程两边同除以 $LC$，可以得到标准化的[二阶微分方程](@entry_id:269365)形式：
$\frac{d^2v_C(t)}{dt^2} + \frac{R}{L} \frac{dv_C(t)}{dt} + \frac{1}{LC} v_C(t) = \frac{V_s}{LC}$
这个方程的系数 $\frac{R}{L}$ 和 $\frac{1}{LC}$ 决定了系统的阻尼和[振荡](@entry_id:267781)特性。

作为对比，我们再看 **并联 RLC 电路** [@problem_id:1592505]。此时，使用 KCL 更为方便。假设电路被一个[电流源](@entry_id:275668) $i_s(t)$ 驱动，所有元件两端的电压 $v(t)$ 是相同的。在中心节点应用 KCL：
$i_R(t) + i_L(t) + i_C(t) = i_s(t)$
用电压 $v(t)$ 来表示各支路电流：
$\frac{v(t)}{R} + i_L(t) + C \frac{dv(t)}{dt} = i_s(t)$
为了消除电感电流 $i_L(t)$，我们对整个方程求导，并利用电感关系 $\frac{di_L(t)}{dt} = \frac{v(t)}{L}$：
$\frac{1}{R} \frac{dv(t)}{dt} + \frac{v(t)}{L} + C \frac{d^2v(t)}{dt^2} = \frac{di_s(t)}{dt}$
整理后得到：
$\frac{d^2v(t)}{dt^2} + \frac{1}{RC} \frac{dv(t)}{dt} + \frac{1}{LC} v(t) = \frac{1}{C}\frac{di_s(t)}{dt}$
这个方程常被写成控制理论中的[标准二阶系统](@entry_id:266318)形式：
$\frac{d^2v(t)}{dt^2} + 2\zeta\omega_n \frac{dv(t)}{dt} + \omega_n^2 v(t) = f(t)$
通过比较系数，我们可以定义两个至关重要的参数：
- **无阻尼自然频率 (Undamped Natural Frequency)**: $\omega_n = \frac{1}{\sqrt{LC}}$
- **[阻尼比](@entry_id:262264) (Damping Ratio)**: $\zeta = \frac{1}{2R} \sqrt{\frac{L}{C}}$
$\omega_n$ 决定了系统在没有阻尼时的振荡频率，而 $\zeta$ 则描述了系统[振荡](@entry_id:267781)被抑制的程度，决定了系统是欠阻尼、临界阻尼还是过阻尼。

#### 耦合系统

当电路包含多个相互作用的回路时，例如通过[互感](@entry_id:264504)耦合的变压器，我们会得到一个[微分方程组](@entry_id:148215)。考虑一个简化的变压器模型，其中初级和次级线圈通过[互感](@entry_id:264504) $M$ 耦合 [@problem_id:1592485]。对初级和次级回路分别应用 KVL：
初级回路: $L_1 \frac{di_1}{dt} + M \frac{di_2}{dt} + R_1 i_1 = V(t)$
次级回路: $M \frac{di_1}{dt} + L_2 \frac{di_2}{dt} + R_2 i_2 = 0$
这个耦合[微分方程组](@entry_id:148215)可以优雅地写成矩阵形式：
$\begin{pmatrix} L_1  M \\ M  L_2 \end{pmatrix} \frac{d}{dt}\begin{pmatrix} i_1(t) \\ i_2(t) \end{pmatrix} + \begin{pmatrix} R_1  0 \\ 0  R_2 \end{pmatrix} \begin{pmatrix} i_1(t) \\ i_2(t) \end{pmatrix} = \begin{pmatrix} V(t) \\ 0 \end{pmatrix}$
这种[矩阵表示法](@entry_id:190318)不仅是表达复杂系统的简洁方式，也为我们接下来要讨论的状态空间方法奠定了基础。

### [频域建模](@entry_id:749588)：[传递函数](@entry_id:273897)

虽然[微分方程](@entry_id:264184)能完整描述系统动态，但在分析和设计中求解它们可能很繁琐。**拉普拉斯变换 (Laplace Transform)** 提供了一种强大的替代方法，它将时域中的[线性微分方程](@entry_id:150365)转化为[频域](@entry_id:160070)（或称为 $s$ 域）中的[代数方程](@entry_id:272665)，极大地简化了分析过程。

在 $s$ 域中，电路元件的行为由其**阻抗 (Impedance)** $Z(s)$ 描述，它是电压和电流拉普拉斯变换的比值 $Z(s) = V(s) / I(s)$（假设[初始条件](@entry_id:152863)为零）：
- 电阻: $Z_R = R$
- 电感: $Z_L = sL$
- 电容: $Z_C = \frac{1}{sC}$

电路的整体特性可以用**[传递函数](@entry_id:273897) (Transfer Function)** $H(s)$ 来概括，它被定义为系统输出的[拉普拉斯变换](@entry_id:159339) $Y(s)$ 与输入的拉普拉斯变换 $U(s)$ 之比：
$H(s) = \frac{Y(s)}{U(s)}$
[传递函数](@entry_id:273897)捕获了系统的内在动态特性，与具体输入信号无关。

#### 应用于无源电路
考虑一个对实际电感器进行更精确建模的例子，该模型包含一个理想电感 $L$、[串联](@entry_id:141009)的绕组电阻 $R_s$ 和并联的[寄生电容](@entry_id:270891) $C_p$ [@problem_id:1592495]。这是一个由电流源 $I_{in}(s)$ 驱动的电路，输出为两端电压 $V_{out}(s)$。因此，[传递函数](@entry_id:273897)就是该网络的等效阻抗 $Z_{eq}(s)$。
该网络的结构是一个 $R_s+sL$ 的支路与一个 $\frac{1}{sC_p}$ 的支路并联。并联阻抗的计算公式为：
$Z_{eq}(s) = \frac{Z_1(s) Z_2(s)}{Z_1(s) + Z_2(s)} = \frac{(R_s + sL)(\frac{1}{sC_p})}{R_s + sL + \frac{1}{sC_p}}$
对表达式进行化简，分子分母同乘以 $sC_p$：
$H(s) = Z_{eq}(s) = \frac{R_s + sL}{1 + sR_sC_p + s^2LC_p}$
这个[传递函数](@entry_id:273897)表明，由于[寄生电容](@entry_id:270891)的存在，一个看似简单的电感器在较高频率下表现为一个[二阶系统](@entry_id:276555)，这在[射频电路设计](@entry_id:264367)中至关重要。

#### 应用于[有源电路](@entry_id:262270)（运算放大器）

[传递函数](@entry_id:273897)方法在分析包含**[运算放大器](@entry_id:263966) (Op-Amps)** 的[有源电路](@entry_id:262270)时尤其强大。对于[理想运算放大器](@entry_id:271022)，我们应用两条黄金法则：
1.  输入端不消耗电流（[输入阻抗](@entry_id:271561)无限大）。
2.  两个输入端（同相和反相）之间的电压差为零（“[虚短](@entry_id:274728)”或“[虚地](@entry_id:269132)”）。

考虑一个典型的**有源低通滤波器** [@problem_id:1592498]。这是一个[反相放大器](@entry_id:275864)结构，其反馈路径由电阻 $R_f$ 和电容 $C_f$ 并联组成。输入信号 $V_{in}(s)$ 通过电阻 $R_{in}$ 连接到反相输入端。
反馈网络的阻抗 $Z_f(s)$ 是 $R_f$ 和 $\frac{1}{sC_f}$ 的并联：
$Z_f(s) = \frac{R_f \cdot \frac{1}{sC_f}}{R_f + \frac{1}{sC_f}} = \frac{R_f}{1+sR_fC_f}$
对于[反相放大器](@entry_id:275864)配置，其[传递函数](@entry_id:273897)为 $H(s) = -\frac{Z_f(s)}{R_{in}}$。代入 $Z_f(s)$，我们得到：
$H(s) = \frac{V_{out}(s)}{V_{in}(s)} = -\frac{R_f}{R_{in}(1+sR_fC_f)}$
这是一个典型的一阶低通滤波器[传递函数](@entry_id:273897)，其增益在低频时为 $-\frac{R_f}{R_{in}}$，在高频时衰减。

类似地，我们可以分析其他[运算放大器电路](@entry_id:265104)，例如**积分器** [@problem_id:1592512] 和 **[微分器](@entry_id:272992)** [@problem_id:1592492]。对于一个理想积分器，其反馈元件是电容 $C$，输入元件是电阻 $R$，其[传递函数](@entry_id:273897)为：
$H(s) = -\frac{Z_f(s)}{Z_{in}(s)} = -\frac{1/(sC)}{R} = -\frac{1}{sRC}$
$s$ 域中的 $1/s$ 对应时域中的积分，这解释了其名称。对于一个为限制高频增益而改进的**[实用微分器](@entry_id:266303)**，其输入阻抗为 $Z_{in}(s) = R_1 + \frac{1}{sC_1}$，反馈阻抗为 $Z_f(s) = R_f$。其[传递函数](@entry_id:273897)为：
$H(s) = -\frac{Z_f(s)}{Z_{in}(s)} = -\frac{R_f}{R_1 + 1/(sC_1)} = -\frac{sR_fC_1}{1+sR_1C_1}$
在低频时 ($s \to 0$)，该[传递函数](@entry_id:273897)近似于 $-sR_fC_1$，表现为[微分](@entry_id:158718)特性。而在高频时 ($s \to \infty$)，增益被限制在 $-\frac{R_f}{R_1}$，避免了理想微分器对高频噪声过度放大的问题。

### [状态空间表示](@entry_id:147149)法

[状态空间](@entry_id:177074)法是一种现代的、统一的时域建模框架，它将一个 $n$ 阶[微分方程](@entry_id:264184)系统转化为一个由 $n$ 个[一阶微分方程](@entry_id:173139)组成的[矩阵方程](@entry_id:203695)。这种表示法对于多输入多输出 (MIMO) 系统、[非线性系统](@entry_id:168347)以及使用现代控制理论进行分析和设计至关重要。

一个[线性时不变 (LTI) 系统](@entry_id:178866)的标准状态[空间形式](@entry_id:186145)为：
$\dot{\mathbf{x}}(t) = A\mathbf{x}(t) + B\mathbf{u}(t)$  ([状态方程](@entry_id:274378))
$y(t) = C\mathbf{x}(t) + D\mathbf{u}(t)$  (输出方程)

其中：
- $\mathbf{x}(t)$ 是**[状态向量](@entry_id:154607)**，其元素（[状态变量](@entry_id:138790)）完整地描述了系统的内部状态。对于电气电路，[状态变量](@entry_id:138790)通常选择为[电容器](@entry_id:267364)电压和电感器电流，因为它们代表了系统中储存的能量，并且它们的值在任何时刻足以预测系统的未来行为。
- $\mathbf{u}(t)$ 是**输入向量**。
- $y(t)$ 是**输出向量**。
- $A, B, C, D$ 是描述系统内部结构和连接的常数矩阵。

#### 构建[状态空间模型](@entry_id:137993)

让我们重新审视前面讨论过的一阶电路，并为它们构建[状态空间模型](@entry_id:137993)。

对于[串联](@entry_id:141009) RC 充电电路 [@problem_id:1592504]，我们选择[电容器](@entry_id:267364)电压 $v_C(t)$ 作为[状态变量](@entry_id:138790)，即 $x(t) = v_C(t)$。输入是电源电压 $u(t) = V_s$。输出也选择为[电容器](@entry_id:267364)电压 $y(t) = v_C(t)$。
我们之[前推](@entry_id:158718)导的[微分方程](@entry_id:264184)是 $RC \frac{dv_C(t)}{dt} + v_C(t) = V_s$。整理成 $\dot{x}$ 的形式：
$\dot{x}(t) = \frac{dv_C(t)}{dt} = -\frac{1}{RC}v_C(t) + \frac{1}{RC}V_s = -\frac{1}{RC}x(t) + \frac{1}{RC}u(t)$
与[状态方程](@entry_id:274378) $\dot{x}(t) = Ax(t) + Bu(t)$ 比较，我们得到：
$A = -\frac{1}{RC}$, $B = \frac{1}{RC}$
输出方程为 $y(t) = v_C(t) = 1 \cdot x(t) + 0 \cdot u(t)$。与输出方程 $y(t) = Cx(t) + Du(t)$ 比较，我们得到：
$C = 1$, $D = 0$

现在，考虑一个更有趣的例子：一个由可控电压源 $v_{in}(t)$ 驱动的[螺线管](@entry_id:261182)模型（[串联](@entry_id:141009) RL 电路）[@problem_id:1592489]。状态变量自然选择为[电感](@entry_id:276031)电流 $x(t) = i(t)$，输入为 $u(t) = v_{in}(t)$。然而，这次我们感兴趣的输出是[电感](@entry_id:276031)两端的电压 $y(t) = v_L(t)$。
首先，根据 KVL 写出电路方程：$v_{in}(t) = R i(t) + L \frac{di(t)}{dt}$。
整理得到[状态方程](@entry_id:274378)：
$\dot{x}(t) = \frac{di(t)}{dt} = -\frac{R}{L}i(t) + \frac{1}{L}v_{in}(t) = -\frac{R}{L}x(t) + \frac{1}{L}u(t)$
由此可得：
$A = -\frac{R}{L}$, $B = \frac{1}{L}$
接下来是输出方程。输出 $y(t) = v_L(t) = L \frac{di(t)}{dt} = L\dot{x}(t)$。我们必须将输出 $y(t)$ 表示为状态 $x(t)$ 和输入 $u(t)$ 的[线性组合](@entry_id:154743)。我们可以将[状态方程](@entry_id:274378)代入：
$y(t) = L \left(-\frac{R}{L}x(t) + \frac{1}{L}u(t)\right) = -R x(t) + 1 \cdot u(t)$
与 $y(t) = Cx(t) + Du(t)$ 比较，我们得到：
$C = -R$, $D = 1$
这个例子突出表明，输出矩阵 $C$ 和 $D$ 完全取决于我们选择测量的物理量。这里的 $D=1$ 表明输出直接受到输入的影响（存在“前馈”通路），因为输入电压 $v_{in}(t)$ 会瞬时地影响[电感](@entry_id:276031)电压 $v_L(t)$（通过从 $v_{in}$ 中减去电阻压降 $v_R$ 得到）。

通过这些基本方法——[微分方程](@entry_id:264184)、[传递函数](@entry_id:273897)和[状态空间表示](@entry_id:147149)——我们能够将一个物理电气系统转化为一个可以进行严谨[数学分析](@entry_id:139664)的抽象模型。选择哪种模型取决于具体的任务：[微分方程](@entry_id:264184)最接近物理直觉，[传递函数](@entry_id:273897)在分析频率响应和经典控制设计中非常方便，而[状态空间](@entry_id:177074)则为现代控制理论和[复杂系统建模](@entry_id:203520)提供了最通用和最强大的框架。