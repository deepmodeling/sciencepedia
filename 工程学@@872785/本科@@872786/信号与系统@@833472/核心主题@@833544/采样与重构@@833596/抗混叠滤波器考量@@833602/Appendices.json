{"hands_on_practices": [{"introduction": "理论上，奈奎斯特-香农采样定理假设存在一个理想的“砖墙”滤波器，但在现实世界中，所有滤波器都存在一个从通带到阻带的过渡区域。这个练习将引导你探索这一现实约束如何影响系统设计。通过分析一个具有固定过渡带宽的抗混叠滤波器，你将推导出在给定采样率$f_s$下可实现的最大可用信号带宽$B_{max}$，这是理解和设计实际数据采集系统的基本第一步[@problem_id:1698331]。", "problem": "一位生物医学工程师正在设计一款便携式脑电图（EEG）监测设备。该设备的核心是一个数据采集系统，用于将来自大脑的微弱电信号数字化。该系统包括一个模拟抗混叠滤波器，其后是一个模数转换器（ADC）。ADC以固定的采样频率 $f_s$ 工作。\n\n抗混叠滤波器是一种低通滤波器，具有以下规格：\n- **通带截止频率** $f_p$，是输入信号幅度衰减不超过 3 dB 的最大频率。\n- **阻带起始频率** $f_{st}$，是输入信号幅度衰减至少 60 dB 的最小频率。\n- $f_p$ 和 $f_{st}$ 之间的区域是**过渡带**。根据滤波器设计，该频带的宽度是固定的，为 $\\Delta f = f_{st} - f_p$。\n\n为确保所采集数据的完整性，防止混叠失真破坏感兴趣的频率至关重要。**可用信号带宽**定义为从直流（DC）到通带截止频率 $f_p$ 的频率范围。换言之，可用带宽为 $B = f_p$。\n\n假设工程师可以自由选择滤波器的通带截止频率 $f_p$ 以最大化可用带宽，同时严格避免阻带外的任何频率混叠到可用带宽内，请确定最大可实现的可用信号带宽 $B_{max}$，并用采样频率 $f_s$ 和过渡带宽度 $\\Delta f$ 表示。", "solution": "目标是求出最大可用信号带宽 $B_{max}$。题目将可用带宽定义为抗混叠滤波器的通带截止频率，因此 $B = f_p$。我们的目标是在混叠不破坏此频带内信号的约束下，最大化 $f_p$。\n\n抗混叠滤波器有一个在 $f_p$ 处结束的通带和一个在 $f_{st}$ 处开始的阻带。这些频率之间的关系由过渡带宽度 $\\Delta f$ 给出：\n$$f_{st} = f_p + \\Delta f$$\n因为我们要最大化可用带宽 $B = f_p$，所以我们可以用 $B$ 来表示阻带起始频率：\n$$f_{st} = B + \\Delta f$$\n\n根据奈奎斯特-香农采样定理，当以频率 $f_s$ 对信号进行采样时，原始模拟信号的频谱分量会以 $f_s$ 的整数倍为中心进行复制。当这些复制的频谱与基带频谱重叠时，就会发生混叠。具体来说，原始频率为 $f_{orig}$ 的频率分量可能会以混叠频率 $f_{alias} = |f_{orig} - k f_s|$ (其中k为整数) 的形式出现。\n\n最成问题的混叠来自第一个复制频谱（$k=1$时），此时位于 $f_{orig}$ 的高频分量会折返到低频带，出现在 $f_s - f_{orig}$ 处。为了防止可用带宽 $[0, B]$ 受到破坏，我们必须确保任何显著的混叠频率都落在此范围之外。\n\n抗混叠滤波器的设计旨在大幅衰减其阻带内的频率，即所有频率 $f \\ge f_{st}$。任何低于 $f_{st}$ 的频率分量（即在通带或过渡带中）都不能保证被充分衰减，因此可能导致混叠。混叠的“最坏情况”涉及滤波器在进入阻带前未被强力衰减的最低频率。为保守起见并确保信号不被破坏，我们必须考虑在阻带边界处的频率分量会发生什么。\n\n让我们分析位于阻带起始频率 $f_{st}$ 处的一个频率分量。采样后，该频率将在基带中产生一个混叠分量，其频率为：\n$$f_{alias} = f_s - f_{st}$$\n为了确保该混叠分量不干扰可用带宽 $[0, B]$ 内的信号，其频率必须大于或等于该频带内的最大频率，即 $B$。这给了我们临界条件：\n$$f_{alias} \\ge B$$\n代入 $f_{alias}$ 的表达式：\n$$f_s - f_{st} \\ge B$$\n现在，我们可以代入用 $B$ 和 $\\Delta f$ 表示的 $f_{st}$ 的表达式：\n$$f_s - (B + \\Delta f) \\ge B$$\n现在我们可以解这个关于 $B$ 的不等式，以求出允许的最大带宽。\n$$f_s - B - \\Delta f \\ge B$$\n$$f_s - \\Delta f \\ge 2B$$\n$$B \\le \\frac{f_s - \\Delta f}{2}$$\n这个不等式给出了可用带宽 $B$ 的上限。为了最大化带宽，我们选择 $B$ 可能的最大值，这对应于等式：\n$$B_{max} = \\frac{f_s - \\Delta f}{2}$$\n这个表达式表示在给定固定采样率和滤波器过渡带宽的情况下，可实现的最大可用信号带宽。", "answer": "$$\\boxed{\\frac{f_s - \\Delta f}{2}}$$", "id": "1698331"}, {"introduction": "在理解了非理想滤波器带来的基本限制后，我们现在将这一概念应用于一个更具体的场景：对一个包含无限谐波的方波信号进行采样。这个练习将帮助你动手分析一个复杂信号的哪些特定频率分量在经过滤波和采样后，会成为显著的混叠噪声来源[@problem_id:1698335]。通过计算，你将能够确定哪些谐波在实际系统中构成了真正的威胁，从而将混叠这一抽象概念具体化。", "problem": "在一个数字信号处理系统中，必须对模拟信号进行采样。为了防止混叠，在采样器前应用了一个抗混叠滤波器。考虑一个对称周期方波信号，其基频为 $f_0 = 1.0$ kHz。该信号通过一个截止频率为 $f_c = 4.0$ kHz 的二阶模拟巴特沃斯低通滤波器。滤波后的信号随后以 $f_s = 10.0$ kHz 的速率进行采样。\n\n如果原始方波的某个谐波满足以下两个条件，则认为它会引起显著的混叠：\n1.  其频率大于由采样率决定的奈奎斯特频率。\n2.  经过滤波器衰减后，其幅度大于滤波后基波幅度的 1%。\n\n回顾一下，对称周期方波只包含奇次谐波（即其频率分量位于 $k f_0$，其中 $k=1, 3, 5, \\dots$）。根据上述标准，确定引起显著混叠的谐波次数 $k$ 的集合。\n\n下列哪项代表了这些谐波次数的完整集合？\n\nA. $\\{7\\}$\n\nB. $\\{7, 9\\}$\n\nC. $\\{7, 9, 11\\}$\n\nD. $\\{7, 9, 11, 13\\}$\n\nE. $\\{5, 7, 9\\}$", "solution": "奈奎斯特频率为 $f_{N} = \\frac{f_{s}}{2} = 5.0\\ \\text{kHz}$。由于方波只在 $k f_{0}$ 处有奇次谐波，其中 $k \\in \\{1,3,5,\\dots\\}$ 且 $f_{0} = 1.0\\ \\text{kHz}$，条件1要求 $k f_{0}  f_{N}$，即 $k  5$。因此，候选的 $k$ 值为 $k \\in \\{7,9,11,13,\\dots\\}$。\n\n对于对称方波，滤波前第 $k$ 次奇次谐波的幅度与基波幅度的 $\\frac{1}{k}$ 倍成正比。令 $A_{k}^{(0)}$ 表示未滤波的第 $k$ 次谐波幅度，$A_{1}^{(0)}$ 表示未滤波的基波幅度；则 $\\frac{A_{k}^{(0)}}{A_{1}^{(0)}} = \\frac{1}{k}$。\n\n一个二阶巴特沃斯低通滤波器的幅度响应为\n$$\n|H(f)| = \\frac{1}{\\sqrt{1 + \\left(\\frac{f}{f_{c}}\\right)^{4}}}.\n$$\n因此，滤波后的第 $k$ 次谐波幅度与滤波后的基波幅度之比为\n$$\nR_{k} \\equiv \\frac{A_{k}^{(0)} |H(k f_{0})|}{A_{1}^{(0)} |H(f_{0})|} = \\frac{1}{k}\\,\\frac{|H(k f_{0})|}{|H(f_{0})|} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\left(\\frac{f_{0}}{f_{c}}\\right)^{4}}{1 + \\left(\\frac{k f_{0}}{f_{c}}\\right)^{4}}}.\n$$\n条件2要求 $R_{k}  0.01$。已知 $f_{0} = 1.0\\ \\text{kHz}$ 且 $f_{c} = 4.0\\ \\text{kHz}$，我们有 $\\frac{f_{0}}{f_{c}} = \\frac{1}{4}$ 和 $\\frac{k f_{0}}{f_{c}} = \\frac{k}{4}$，所以\n$$\nR_{k} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\left(\\frac{1}{4}\\right)^{4}}{1 + \\left(\\frac{k}{4}\\right)^{4}}} = \\frac{1}{k}\\,\\sqrt{\\frac{1 + \\frac{1}{256}}{1 + \\frac{k^{4}}{256}}} = \\frac{1}{k}\\,\\sqrt{\\frac{\\frac{257}{256}}{1 + \\frac{k^{4}}{256}}}.\n$$\n施加条件 $R_{k}  0.01$ 并平方，得到\n$$\n\\frac{1}{k^{2}}\\,\\frac{\\frac{257}{256}}{1 + \\frac{k^{4}}{256}} > 0.0001,\n$$\n整理后可得\n$$\n1 + \\frac{k^{4}}{256}  \\frac{\\frac{257}{256}}{(0.01 k)^{2}} = \\frac{257}{256}\\cdot\\frac{10000}{k^{2}} = \\frac{2570000}{256 k^{2}}.\n$$\n两边同乘以 $256 k^{2}$ 得到等价的不等式\n$$\nk^{6} + 256 k^{2}  2570000.\n$$\n我们检验大于5的奇数 $k$：\n\n- $k=7$：$k^{6} = 117649$，$256 k^{2} = 12544$，和 $= 130193  2570000$；满足条件。\n- $k=9$：$k^{6} = 531441$，$256 k^{2} = 20736$，和 $= 552177  2570000$；满足条件。\n- $k=11$：$k^{6} = 1771561$，$256 k^{2} = 30976$，和 $= 1802537  2570000$；满足条件。\n- $k=13$：$k^{6} = 4826809$，$256 k^{2} = 43264$，和 $= 4870073 > 2570000$；不满足条件。\n\n由于左侧表达式 $k^{6} + 256 k^{2}$ 随 $k$ 严格递增，所有更大的奇数 $k$ 也将不满足条件。因此，引起显著混叠的谐波次数恰好是 $k \\in \\{7,9,11\\}$，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1698335"}, {"introduction": "最后，我们将视角从纯粹的信号完整性扩展到系统级的工程设计和成本优化。这个练习模拟了一个真实的工程决策过程，其中抗混叠滤波器的选择不仅要满足技术指标，还必须平衡整个系统的成本[@problem_id:1698377]。你将学习如何通过权衡复杂模拟滤波器（高阶）的成本与高速数字子系统（高采样率）的成本，来找到最优的系统设计方案，从而体会到工程实践中的多维度考量。", "problem": "一家公司正在设计一种新的数据采集（DAQ）系统来监测一个物理过程。已知来自传感器的模拟信号是带限的，其最大频率成分为 $f_{max} = 10.0 \\text{ kHz}$。为了防止混叠，在模数转换器（ADC）之前放置了一个N阶巴特沃斯硬件低通滤波器。设计规范要求，滤波器的 -3 dB 截止频率 $f_c$ 必须设置得等于 $f_{max}$。此外，滤波器在奈奎斯特频率 $f_s/2$ 处必须提供至少 $A_{min} = 60 \\text{ dB}$ 的衰减，其中 $f_s$ 是采样频率。\n\n系统的总成本主要由两个部分决定：模拟滤波器和数字子系统（ADC和内存）。\n1.  巴特沃斯滤波器的成本 $C_{filter}$ 与其复杂度成正比，由 $C_{filter} = K_N \\cdot N$ 给出，其中 $N$ 是滤波器的整数阶数，成本系数为 $K_N = \\$150.00$ 每阶。\n2.  数字子系统的成本 $C_{digital}$ 随着所需采样率的增加而增加，由 $C_{digital} = K_s \\cdot f_s$ 给出，其中成本系数为 $K_s = \\$2.00$ 每 kHz 采样频率。\n\n您的任务是确定最优的滤波器阶数 $N_{opt}$，以最小化系统总成本 $C_{total} = C_{filter} + C_{digital}$。您还必须找到这个最小成本 $C_{min}$。滤波器阶数 $N$ 必须是正整数。\n\n确定最优的整数滤波器阶数 $N_{opt}$ 和相应的最小系统总成本 $C_{min}$。最终成本以美元表示，并四舍五入到三位有效数字。", "solution": "一个截止频率为 $f_{c}$ 的 $N$ 阶巴特沃斯低通滤波器的幅度平方响应为\n$$\n|H(j2\\pi f)|^{2}=\\frac{1}{1+\\left(\\frac{f}{f_{c}}\\right)^{2N}}.\n$$\n因此，在频率 $f$ 处的衰减（以分贝为单位）为\n$$\nA(f)=10\\log_{10}\\!\\left(1+\\left(\\frac{f}{f_{c}}\\right)^{2N}\\right).\n$$\n设 $f_{c}=f_{\\max}$，奈奎斯特频率为 $f_{s}/2$，则衰减要求 $A(f_{s}/2)\\geq A_{\\min}$ 给出\n$$\n10\\log_{10}\\!\\left(1+\\left(\\frac{f_{s}/2}{f_{\\max}}\\right)^{2N}\\right)\\geq A_{\\min}.\n$$\n令 $r\\equiv \\frac{f_{s}/2}{f_{\\max}}$。则不等式变为\n$$\n1+r^{2N}\\geq 10^{A_{\\min}/10}\\quad\\Rightarrow\\quad r\\geq\\left(10^{A_{\\min}/10}-1\\right)^{\\frac{1}{2N}}.\n$$\n对于给定的 $N$，满足约束条件的最小采样频率为\n$$\nf_{s,\\min}(N)=2f_{\\max}\\left(10^{A_{\\min}/10}-1\\right)^{\\frac{1}{2N}}.\n$$\n成本为 $C_{\\text{filter}}=K_{N}N$ 和 $C_{\\text{digital}}=K_{s}f_{s}$。为使给定 $N$ 的总成本最小化，我们使用 $f_{s}=f_{s,\\min}(N)$，得到\n$$\nC_{\\text{total}}(N)=K_{N}N+K_{s}\\,f_{s,\\min}(N)\n=K_{N}N+K_{s}\\cdot 2f_{\\max}\\left(10^{\\frac{A_{\\min}}{10}}-1\\right)^{\\frac{1}{2N}}.\n$$\n代入给定的数值规范 $K_{N}=150$，$K_{s}=2$ (每 kHz)，$f_{\\max}=10.0$ kHz，以及 $A_{\\min}=60$ dB：\n$$\nC_{\\text{total}}(N)=150\\,N+40\\left(10^{6}-1\\right)^{\\frac{1}{2N}}.\n$$\n对正整数 $N$ 进行求值：\n- $N=3$: $C_{\\text{total}}(3)\\approx 150\\cdot 3+40\\cdot 10^{\\frac{3}{3}}=450+400=850$.\n- $N=4$: $C_{\\text{total}}(4)\\approx 150\\cdot 4+40\\cdot 10^{\\frac{3}{4}}=600+40\\cdot 5.623413\\approx 824.93653$.\n- $N=5$: $C_{\\text{total}}(5)\\approx 750+40\\cdot 10^{0.6}\\approx 750+159.2429\\approx 909.2429$.\n\n这些值中的最小值出现在 $N=4$ 处。因此，$N_{\\text{opt}}=4$，相应的最小成本为\n$$\nC_{\\min}=150\\cdot 4+40\\left(10^{6}-1\\right)^{\\frac{1}{8}}\\approx 824.93653,\n$$\n四舍五入到三位有效数字后为 $825$ 美元。", "answer": "$$\\boxed{\\begin{pmatrix}4  825\\end{pmatrix}}$$", "id": "1698377"}]}