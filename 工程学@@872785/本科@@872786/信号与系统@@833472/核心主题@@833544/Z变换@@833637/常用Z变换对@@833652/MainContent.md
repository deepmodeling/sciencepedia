## 引言
[Z变换](@entry_id:157804)是分析[离散时间信号](@entry_id:272771)与系统的核心数学工具，它将复杂的时域运算（如卷积）转化为Z域中相对简单的代数运算。然而，许多初学者仅仅停留在记忆常见的[Z变换对](@entry_id:268774)，而未能深入理解这些变换对背后的推导机制和数学原理。这种知其然不知其所以然的学习方式，限制了将理论灵活应用于解决实际问题的能力。本文旨在填补这一知识鸿沟，从根本上阐明常用[Z变换对](@entry_id:268774)的由来。

本文将引导你系统地探索Z变换的构建过程。在“原理与机制”一章中，你将学习到如何运用直接求和法、[几何级数公式](@entry_id:159114)以及[Z域微分](@entry_id:264256)等关键技巧，从零开始推导基本信号的[Z变换](@entry_id:157804)，并深刻理解[收敛域](@entry_id:269722)（ROC）的决定性作用。随后的“应用与交叉学科联系”一章将展示这些[Z变换对](@entry_id:268774)在[信号建模](@entry_id:181485)、[LTI系统分析](@entry_id:266777)、[数字控制](@entry_id:275588)等领域的实际效用。最后，“动手实践”部分将通过具体问题，巩固你将理论付诸实践的能力。通过本次学习，你将不再仅仅是[Z变换对](@entry_id:268774)的使用者，更是其原理的掌握者。

## 原理与机制

在上一章中，我们介绍了 Z 变换的定义及其作为分析[离散时间信号](@entry_id:272771)与系统的强大工具的基本概念。本章将深入探讨“原理与机制”，系统地讲解如何推导常见和基本[信号序列](@entry_id:143660)的 Z 变换。我们的目标不仅仅是记忆变换对，更重要的是理解这些变换对背后的数学原理和推导机制。掌握这些机制，你将能够从基本原理出发，推导出更复杂信号的 Z 变换，从而在信号处理和[系统分析](@entry_id:263805)中游刃有余。

### 基[本构建模](@entry_id:183370)块：有限长序列与[单位冲激](@entry_id:272155)

我们从最简单的信号类型入手，以建立对 Z 变换计算过程的直观理解。根据定义，一个[离散时间信号](@entry_id:272771) $x[n]$ 的 Z 变换是：

$$
X(z) = \sum_{n=-\infty}^{\infty} x[n] z^{-n}
$$

其中 $z$ 是一个[复变量](@entry_id:175312)。这个无穷级数仅对某些特定的 $z$ 值收敛，这些值的集合构成了**[收敛域](@entry_id:269722) (Region of Convergence, ROC)**。

#### 机制一：直接求和法

对于**有限长序列 (finite-duration sequences)**，其 Z 变换的计算非常直接。由于信号仅在有限个时间点上非零，定义中的无穷级数自动简化为一个有限项的和。这使得变换的结果总是一个关于 $z^{-1}$（或 $z$）的多项式。

例如，考虑一个有限长序列，其非零值由集合 $\{1, -2, 0, 4, -3\}$ 定义，且从 $n=0$ 开始。这意味着 $x[0]=1$, $x[1]=-2$, $x[2]=0$, $x[3]=4$, $x[4]=-3$，而在所有其他时刻 $n$，信号值为零。根据 Z 变换的定义，我们只需对这些非零项求和 [@problem_id:1704782]：

$$
\begin{align*}
X(z) = \sum_{n=0}^{4} x[n] z^{-n} \\
= x[0]z^0 + x[1]z^{-1} + x[2]z^{-2} + x[3]z^{-3} + x[4]z^{-4} \\
= 1 \cdot z^0 + (-2) \cdot z^{-1} + 0 \cdot z^{-2} + 4 \cdot z^{-3} + (-3) \cdot z^{-4} \\
= 1 - 2z^{-1} + 4z^{-3} - 3z^{-4}
\end{align*}
$$

由于这是一个有限和，它对除了 $z=0$ （由于 $z^{-1}$ 项）之外的所有复平面上的 $z$ 值都收敛。如果序列也包含 $n0$ 的项，则可能在 $z=\infty$ 处不收敛。因此，对于有限长序列，收敛域通常是整个复平面，可能除去 $z=0$ 或 $z=\infty$。

#### 机制二：冲激信号及其[时移](@entry_id:261541)

[离散时间信号](@entry_id:272771)处理中最基本的信号是**[单位冲激](@entry_id:272155)序列 (unit impulse sequence)**，记为 $\delta[n]$。它的 Z 变换是：

$$
\mathcal{Z}\{\delta[n]\} = \sum_{n=-\infty}^{\infty} \delta[n] z^{-n} = 1 \cdot z^{-0} = 1
$$

其[收敛域](@entry_id:269722)是整个复平面。更有用的是**时移[单位冲激](@entry_id:272155) (time-shifted unit impulse)** $\delta[n-n_0]$。它的 Z 变换为：

$$
\mathcal{Z}\{\delta[n-n_0]\} = \sum_{n=-\infty}^{\infty} \delta[n-n_0] z^{-n} = z^{-n_0}
$$

这个结果揭示了一个深刻的联系：时域中的延迟 $n_0$ 个样本，对应于 Z 域中乘以因子 $z^{-n_0}$。这个性质称为**[时移特性](@entry_id:262410) (time-shifting property)**，是我们工具箱中的一个核心工具。

结合 Z 变换的**线性 (linearity)** 特性，我们可以轻松求出任何由冲激信号线性组合构成的序列的 Z 变换。例如，一个在 $n=n_1$ 和 $n=n_2$ 时刻分别产生幅度为 $A_1$ 和 $A_2$ 的瞬时事件的信号，可以表示为 $x[n] = A_1 \delta[n-n_1] + A_2 \delta[n-n_2]$。其 Z 变换就是 [@problem_id:1704713]：

$$
X(z) = \mathcal{Z}\{A_1 \delta[n-n_1]\} + \mathcal{Z}\{A_2 \delta[n-n_2]\} = A_1 z^{-n_1} + A_2 z^{-n_2}
$$

### 无穷几何序列：有理变换的基石

虽然有限长序列的变换是多项式，但[信号与系统](@entry_id:274453)分析中绝大多数重要的 Z 变换都是**有理函数 (rational functions)**，即两个关于 $z$ 的多项式之比。这些有理变换的根源几乎都来自于**无穷几何序列**。

#### 机制三：几何级数求和公式

核心数学工具是[几何级数](@entry_id:158490)求和公式：

$$
\sum_{n=0}^{\infty} r^n = \frac{1}{1-r}, \quad \text{当 } |r|  1 \text{ 时}
$$

我们将看到，这个简单的公式是推导许多关键 Z 变换对的基础。

#### [右边序列](@entry_id:261542)：因果指数序列

考虑一个**因果指数序列 (causal exponential sequence)** $x[n] = a^n u[n]$，其中 $u[n]$ 是[单位阶跃函数](@entry_id:268807)（即当 $n \ge 0$ 时为 1，否则为 0）。它的 Z 变换是：

$$
X(z) = \sum_{n=0}^{\infty} a^n z^{-n} = \sum_{n=0}^{\infty} (az^{-1})^n
$$

这正是一个[公比](@entry_id:275383) $r = az^{-1}$ 的[几何级数](@entry_id:158490)。根据求和公式，级数收敛的条件是 $|az^{-1}|  1$，即 $|z| > |a|$。当满足此条件时，和为：

$$
X(z) = \frac{1}{1 - az^{-1}} = \frac{z}{z - a}, \quad \text{ROC: } |z| > |a|
$$

这个结果至关重要。它告诉我们，一个因果指数序列的 Z 变换是一个[有理函数](@entry_id:154279)，其极点位于 $z=a$。它的收敛域（ROC）是复平面上以原点为中心、半径为 $|a|$ 的圆的**外部**。这条规则普遍适用于所有**[右边序列](@entry_id:261542) (right-sided sequences)**。

一个特殊的例子是**单位阶跃序列 (unit step sequence)** $u[n]$，它是 $a=1$ 的情况：

$$
\mathcal{Z}\{u[n]\} = \frac{z}{z-1}, \quad \text{ROC: } |z| > 1
$$

利用线性和这个基本变换对，我们可以处理更复杂的信号。例如，一个信号由一个恒定基线和一个衰减分量组成，$v[n] = (C + A\beta^n)u[n]$，其中 $0  \beta  1$。我们可以将其分解为 $C \cdot u[n] + A \cdot (\beta^n u[n])$。其 Z 变换为 [@problem_id:1704715]：

$$
V(z) = C \cdot \frac{z}{z-1} + A \cdot \frac{z}{z-\beta}
$$

其 ROC 是 $|z| > 1$ 和 $|z| > \beta$ 的交集。因为 $\beta  1$，所以 ROC 就是 $|z| > 1$。将上式通分，可得单一的有理表达式：

$$
V(z) = \frac{C z(z-\beta) + A z(z-1)}{(z-1)(z-\beta)} = \frac{(C+A)z^2 - (C\beta+A)z}{(z-1)(z-\beta)}
$$

#### [左边序列](@entry_id:263980)：反因果指数序列

现在考虑**反因果指数序列 (anti-causal exponential sequence)**，例如 $x[n] = a^n u[-n-1]$。这个序列只在 $n \le -1$ 时非零 [@problem_id:1704772]。

$$
X(z) = \sum_{n=-\infty}^{-1} a^n z^{-n}
$$

为了使用[几何级数公式](@entry_id:159114)，我们进行换元，令 $m = -n$。当 $n$ 从 $-\infty$ 到 $-1$ 时，$m$ 从 $\infty$ 到 $1$。

$$
X(z) = \sum_{m=1}^{\infty} a^{-m} z^m = \sum_{m=1}^{\infty} (a^{-1}z)^m
$$

这是一个[公比](@entry_id:275383)为 $r = a^{-1}z$ 的[几何级数](@entry_id:158490)。为了求和，我们将其写成标准形式：$\sum_{m=1}^{\infty} r^m = (\sum_{m=0}^{\infty} r^m) - 1 = \frac{1}{1-r} - 1 = \frac{r}{1-r}$。级数收敛的条件是 $|a^{-1}z|  1$，即 $|z|  |a|$。收敛时，和为：

$$
X(z) = \frac{a^{-1}z}{1 - a^{-1}z} = \frac{z}{a-z}, \quad \text{ROC: } |z|  |a|
$$

请注意，这个 Z 变换的表达式 $\frac{z}{a-z}$ 与因果序列的变换 $\frac{z}{z-a}$ 形式上非常相似。然而，它们的收敛域截然不同。反因果序列的 ROC 是以原点为中心、半径为 $|a|$ 的圆的**内部**。这条规则普遍适用于所有**[左边序列](@entry_id:263980) (left-sided sequences)**。

收敛域的重要性再怎么强调也不为过。一个有理函数表达式，若不指定其[收敛域](@entry_id:269722)，就无法唯一确定其对应的时域序列。例如，考虑 Z 变换 $X(z) = \frac{1}{1 - 4z^{-1}}$。
*   如果 ROC 是 $|z|>4$，它对应于因果序列 $x[n] = 4^n u[n]$。
*   如果 ROC 是 $|z|4$，则它对应于反因果序列 $x[n] = -4^n u[-n-1]$ [@problem_id:1704751]。

#### [双边序列](@entry_id:262580)：环状[收敛域](@entry_id:269722)

当一个信号既有因果部分又有反因果部分时，我们称之为**[双边序列](@entry_id:262580) (two-sided sequence)**。它的 Z 变换可以通过线性特性，将两部分的变换相加得到。其最终的 ROC 是各自 ROC 的**交集**。如果这个交集非空，它将是一个环形区域。

考虑一个典型的[双边信号](@entry_id:273989) $x[n] = (0.5)^n u[n] + (2)^n u[-n-1]$ [@problem_id:1704765]。
*   因果部分 $x_1[n] = (0.5)^n u[n]$ 的变换是 $X_1(z) = \frac{z}{z-0.5}$，ROC 为 $|z|>0.5$。
*   反因果部分 $x_2[n] = 2^n u[-n-1]$ 的变换是 $X_2(z) = \frac{z}{2-z}$，ROC 为 $|z|2$。

信号 $x[n]$ 的 Z 变换 $X(z) = X_1(z) + X_2(z)$ 存在的前提是 $z$ 必须同时满足两个[收敛条件](@entry_id:166121)。因此，总的 ROC 是 $|z|>0.5$ 与 $|z|2$ 的交集，即环状区域 $0.5  |z|  2$。

$$
X(z) = \frac{z}{z-0.5} + \frac{z}{2-z} = \frac{z(2-z) + z(z-0.5)}{(z-0.5)(2-z)} = \frac{1.5z}{(z-0.5)(2-z)}
$$

另一个重要的[双边序列](@entry_id:262580)是对称衰减指数序列 $h[n] = \beta^{|n|}$，其中 $0  \beta  1$。我们可以将其分解为因果部分 $\beta^n u[n]$ 和反因果部分 $\beta^{-n} u[-n-1]$ 的和（注意在 $n=0$ 处需要调整）。一个更直接的方法是将其分解为 $n \ge 0$ 和 $n  0$ 的两部分求和。其 Z 变换的 ROC 同样是一个环状区域 $\beta  |z|  1/\beta$ [@problem_id:1704717]。

### 高级机制：从已知变换推导新变换

直接求和虽然基本，但对于复杂序列而言往往非常繁琐。幸运的是，我们可以利用 Z 变换的各种性质，从已知的简单变换对推导出新的、更复杂的变换对。

#### 机制四：Z 域[微分](@entry_id:158718)法

一个极其有用的性质是 **Z 域[微分](@entry_id:158718) (differentiation in the z-domain)** 特性。它指出，在时域中乘以 $n$ 等价于在 Z 域中进行一次特定的[微分](@entry_id:158718)和尺度变换操作：

$$
\mathcal{Z}\{nx[n]\} = -z \frac{d X(z)}{dz}
$$

我们可以通过对 Z 变换定义式两边关于 $z$求导来证明这一点。这个性质为我们处理形如 $n^k a^n u[n]$ 的序列提供了强大的武器。

让我们从已知的变换对 $\mathcal{Z}\{a^n u[n]\} = \frac{z}{z-a}$ 开始。
应用一次[微分性质](@entry_id:275298)，我们可以求得 $\mathcal{Z}\{n a^n u[n]\}$：

$$
\mathcal{Z}\{n a^n u[n]\} = -z \frac{d}{dz} \left( \frac{z}{z-a} \right) = -z \frac{(z-a) - z}{(z-a)^2} = \frac{az}{(z-a)^2}
$$

再次应用此性质，可以求得 $\mathcal{Z}\{n^2 a^n u[n]\}$：

$$
\mathcal{Z}\{n^2 a^n u[n]\} = -z \frac{d}{dz} \left( \frac{az}{(z-a)^2} \right) = -z \frac{a(z-a)^2 - az \cdot 2(z-a)}{(z-a)^4} = \frac{az(z+a)}{(z-a)^3}
$$

通过[线性组合](@entry_id:154743)这些结果，我们可以求解更复杂的序列，例如一个稳定因果 LTI 系统的冲激响应 $h[n] = (n+1)^2 a^n u[n]$，其中 $|a|1$。由于 $h[n] = (n^2+2n+1)a^n u[n] = n^2 a^n u[n] + 2n a^n u[n] + a^n u[n]$，其 Z 变换 $H(z)$ 就是上述三个变换的[线性组合](@entry_id:154743) [@problem_id:1704774]。

$$
H(z) = \frac{az(z+a)}{(z-a)^3} + 2 \frac{az}{(z-a)^2} + \frac{z}{z-a} = \frac{z^2(z+a)}{(z-a)^3}
$$
其 ROC 为 $|z|>|a|$。

### 重要特例与应用

掌握了上述基本机制后，我们现在可以将其应用于几类在实践中非常重要的信号。

#### 正弦和余弦序列

我们可以利用欧拉公式将正弦和余弦函数表示为[复指数](@entry_id:162635)的[线性组合](@entry_id:154743)：

$$
\cos(\omega_0 n) = \frac{e^{j\omega_0 n} + e^{-j\omega_0 n}}{2}, \quad \sin(\omega_0 n) = \frac{e^{j\omega_0 n} - e^{-j\omega_0 n}}{2j}
$$

因此，求取因果正弦或余弦序列的 Z 变换，就等价于求取两个[复指数](@entry_id:162635)序列 $ (e^{j\omega_0})^n u[n] $ 和 $ (e^{-j\omega_0})^n u[n] $ 的 Z 变换的线性组合。使用 $a^n u[n]$ 的变换对公式，令 $a=e^{j\omega_0}$ 和 $a=e^{-j\omega_0}$，我们有：

$$
\mathcal{Z}\{(e^{\pm j\omega_0})^n u[n]\} = \frac{z}{z - e^{\pm j\omega_0}}
$$

将它们组合起来，经过代数化简，可以得到因果余弦和正弦序列的 Z 变换。例如，对于带指数衰减的正弦序列 $h[n] = r^n \sin(\omega_0 n) u[n]$，其 Z 变换可以通过以下方式求得 [@problem_id:1704770]：

$$
\begin{align*}
H(z) = \mathcal{Z}\left\{ r^n \frac{e^{j\omega_0 n} - e^{-j\omega_0 n}}{2j} u[n] \right\} \\
= \frac{1}{2j} \left[ \mathcal{Z}\{(r e^{j\omega_0})^n u[n]\} - \mathcal{Z}\{(r e^{-j\omega_0})^n u[n]\} \right] \\
= \frac{1}{2j} \left[ \frac{z}{z - r e^{j\omega_0}} - \frac{z}{z - r e^{-j\omega_0}} \right] \\
= \frac{r \sin(\omega_0) z}{z^2 - 2r \cos(\omega_0) z + r^2}
\end{align*}
$$
这个变换对在[二阶系统](@entry_id:276555)的分析中非常常见，例如具有[欠阻尼响应](@entry_id:172933)的系统。

#### [周期序列](@entry_id:159194)

对于一个[基本周期](@entry_id:267619)为 $N$ 的因果[周期序列](@entry_id:159194) $x[n]$，其 Z 变换有一个简洁的表达式。令 $x_1[n]$ 表示该序列的第一个周期（即 $x_1[n] = x[n]$ for $0 \le n \le N-1$，否则为 0），其 Z 变换为 $X_1(z)$。那么整个[周期序列](@entry_id:159194)的 Z 变换为：

$$
X(z) = \frac{X_1(z)}{1 - z^{-N}}
$$

这个公式可以通过将[周期信号](@entry_id:266688)表示为一个周期单元与一个周期冲激串的卷积来推导，或者直接通过对 Z 变换的求和式进行分组得到。

例如，一个周期为 $N=2$ 的数字[时钟信号](@entry_id:174447)，其第一个周期为 $\{1, 0\}$。这意味着 $x_1[n] = \delta[n]$，所以 $X_1(z) = 1$。那么该周期信号的 Z 变换为 [@problem_id:1704787]：

$$
X(z) = \frac{1}{1 - z^{-2}} = \frac{z^2}{z^2 - 1}
$$
其 ROC 为 $|z|>1$，因为这是一个因果序列，且极点位于 $z=\pm 1$。

本章通过一系列机制和实例，展示了如何从第一性原理出发，系统地构建起一个常用 Z 变换对的知识体系。关键在于理解几何级数求和在构建有理变换中的核心作用，以及收敛域如何唯一地将 Z 域表达式与时域序列联系起来。掌握这些原理，将为你后续学习[系统分析](@entry_id:263805)、[滤波器设计](@entry_id:266363)和更高级的信号处理技术奠定坚实的基础。