## 引言
在分析[离散时间信号](@entry_id:272771)与系统的过程中，我们常常需要处理复杂的时域运算，如卷积。为了简化这一过程并获得对系统行为更深刻的洞察，我们引入了一个核心概念——**[系统函数](@entry_id:267697) H(z)**。[系统函数](@entry_id:267697)不仅是连接[时域与频域](@entry_id:268132)（或更准确地说是 Z 域）的关键桥梁，更是描述一个[线性时不变](@entry_id:276287)（LTI）系统所有动态特性的“基因图谱”。它解决了如何将复杂的差分方程和卷积操作转化为简单的代数运算的问题，从而使[系统分析](@entry_id:263805)与设计变得更加直观和高效。

本文将系统地引导你掌握[系统函数](@entry_id:267697)。在第一章“**原理与机制**”中，我们将深入探讨[系统函数](@entry_id:267697)的定义、推导方法，并揭示其极点和零点如何决定系统的[因果性与稳定性](@entry_id:260582)。接下来，在“**应用与跨学科联系**”一章中，我们将展示[系统函数](@entry_id:267697)在[数字滤波器设计](@entry_id:141797)、[系统建模](@entry_id:197208)和[数字控制](@entry_id:275588)等多个领域的强大应用。最后，通过“**动手实践**”部分，你将有机会将理论知识应用于具体问题，巩固所学。读完本文，你将能熟练运用[系统函数](@entry_id:267697)这一强大工具来分析、设计和理解各种离散时间系统。

## 原理与机制

在前一章中，我们介绍了 Z 变换作为分析[离散时间信号](@entry_id:272771)与系统的强大数学工具。本章将深入探讨一个核心概念——**[系统函数](@entry_id:267697) (System Function)**，记作 $H(z)$。[系统函数](@entry_id:267697)是[系统脉冲响应](@entry_id:260864) $h[n]$ 的 Z 变换，它将一个[线性时不变](@entry_id:276287)（LTI）系统在时域中的卷积运算转换为了 Z 域中的乘法运算。这种转换极大地简化了[系统分析](@entry_id:263805)与设计。我们将系统地阐述如何确定[系统函数](@entry_id:267697)，并揭示它如何通过其[代数结构](@entry_id:137052)（特别是[极点和零点](@entry_id:262457)的位置）来完整地描述系统的核心特性，如因果性、稳定性及[频率响应](@entry_id:183149)。

### [系统函数](@entry_id:267697)的定义与推导

对于一个离散时间线性时不变（LTI）系统，其输入 $x[n]$ 与输出 $y[n]$ 之间的关系由[卷积和](@entry_id:263238)定义：
$$y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k]$$
其中 $h[n]$ 是系统的**脉冲响应 (impulse response)**。根据 Z 变换的卷[积性质](@entry_id:151217)，上式在 Z 域中对应着一个简单的乘法关系：
$$Y(z) = X(z)H(z)$$
这里的 $Y(z)$、$X(z)$ 和 $H(z)$ 分别是 $y[n]$、$x[n]$ 和 $h[n]$ 的 Z 变换。

由此，我们定义**[系统函数](@entry_id:267697)** $H(z)$ 为系统输出信号的 Z 变换 $Y(z)$ 与输入信号的 Z 变换 $X(z)$ 之比：
$$H(z) = \frac{Y(z)}{X(z)}$$
同时，根据 Z 变换的定义，[系统函数](@entry_id:267697)也是[系统脉冲响应](@entry_id:260864) $h[n]$ 的 Z 变换：
$$H(z) = \mathcal{Z}\{h[n]\} = \sum_{n=-\infty}^{\infty} h[n]z^{-n}$$
这两种等价的定义为我们提供了两种主要的推导[系统函数](@entry_id:267697)的方法。

#### 从脉冲响应推导

如果一个系统的脉冲响应 $h[n]$ 已知，那么它的[系统函数](@entry_id:267697) $H(z)$ 可以通过直接计算 $h[n]$ 的 Z 变换得到。这个过程通常需要利用 Z 变换的性质和一些常见的变换对，如[几何级数](@entry_id:158490)求和公式。

考虑一个模拟阻尼数字谐振器的因果 LTI 系统，其脉冲响应由下式给出 [@problem_id:1766552]：
$$h[n] = \alpha^n \cos(\omega_0 n) u[n]$$
其中 $u[n]$ 是[单位阶跃函数](@entry_id:268807)，保证了系统的因果性，$0  |\alpha|  1$ 是阻尼因子，$\omega_0$ 是数字[角频率](@entry_id:261565)。为了求其[系统函数](@entry_id:267697) $H(z)$，我们计算 $h[n]$ 的 Z 变换：
$$H(z) = \sum_{n=0}^{\infty} \alpha^n \cos(\omega_0 n) z^{-n}$$
利用欧拉公式 $\cos(\theta) = \frac{1}{2}(e^{\mathrm{j}\theta} + e^{-\mathrm{j}\theta})$，我们可以将上式分解为两个[几何级数](@entry_id:158490)之和：
$$H(z) = \frac{1}{2} \sum_{n=0}^{\infty} (\alpha e^{\mathrm{j}\omega_0} z^{-1})^n + \frac{1}{2} \sum_{n=0}^{\infty} (\alpha e^{-\mathrm{j}\omega_0} z^{-1})^n$$
对于一个[公比](@entry_id:275383)为 $r$ 的几何级数 $\sum_{n=0}^{\infty} r^n$，当 $|r|  1$ 时，其和为 $\frac{1}{1-r}$。在本例中，[收敛条件](@entry_id:166121)为 $|\alpha e^{\pm \mathrm{j}\omega_0} z^{-1}|  1$，即 $|z| > |\alpha|$。满足此条件时，我们得到：
$$H(z) = \frac{1}{2} \left( \frac{1}{1 - \alpha e^{\mathrm{j}\omega_0} z^{-1}} + \frac{1}{1 - \alpha e^{-\mathrm{j}\omega_0} z^{-1}} \right)$$
将两项通分合并，并利用关系 $e^{\mathrm{j}\omega_0} + e^{-\mathrm{j}\omega_0} = 2\cos(\omega_0)$ 和 $e^{\mathrm{j}\omega_0} \cdot e^{-\mathrm{j}\omega_0} = 1$，最终得到一个[闭合形式](@entry_id:271343)的表达式：
$$H(z) = \frac{1 - \alpha \cos(\omega_0) z^{-1}}{1 - 2\alpha \cos(\omega_0) z^{-1} + \alpha^2 z^{-2}}$$
这个结果是一个关于 $z^{-1}$ 的[有理函数](@entry_id:154279)，其收敛域 (Region of Convergence, ROC) 为 $|z| > |\alpha|$。

#### 从差分方程推导

在实际应用中，许多离散时间系统是通过**[线性常系数差分方程](@entry_id:260895) (Linear Constant-Coefficient Difference Equation, LCCDE)** 来描述的。对于这类系统，推导[系统函数](@entry_id:267697)的过程更加直接。我们只需对[差分方程](@entry_id:262177)两边同时进行 Z 变换，并利用 Z 变换的线性和[时移性质](@entry_id:275667)。

考虑一个由以下差分方程描述的因果 IIR 滤波器 [@problem_id:1766522]：
$$y[n] - 0.7 y[n-1] = x[n] - 0.4 x[n-2]$$
系统是**初始静止 (initially at rest)** 的，意味着在输入施加之前（即 $n0$ 时），所有输出和内部状态均为零。这个假设非常重要，因为它使得 Z 变换的[时移性质](@entry_id:275667) $\mathcal{Z}\{f[n-k]\} = z^{-k}F(z)$ 能够直接应用，而无需考虑初始条件项。

对[差分方程](@entry_id:262177)两边取 Z 变换：
$$\mathcal{Z}\{y[n]\} - 0.7 \mathcal{Z}\{y[n-1]\} = \mathcal{Z}\{x[n]\} - 0.4 \mathcal{Z}\{x[n-2]\}$$
$$Y(z) - 0.7 z^{-1}Y(z) = X(z) - 0.4 z^{-2}X(z)$$
将含有 $Y(z)$ 和 $X(z)$ 的项分别合并：
$$Y(z)(1 - 0.7z^{-1}) = X(z)(1 - 0.4z^{-2})$$
最后，通过求解 $H(z) = Y(z)/X(z)$，我们得到[系统函数](@entry_id:267697)：
$$H(z) = \frac{1 - 0.4z^{-2}}{1 - 0.7z^{-1}}$$
为了方便分析，通常将[系统函数](@entry_id:267697)表示为 $z$ 的正幂次的多项式之比。通过分子分母同乘以 $z^2$（即 $z$ 的最高负幂次的[绝对值](@entry_id:147688)次幂），我们得到：
$$H(z) = \frac{z^2(1 - 0.4z^{-2})}{z^2(1 - 0.7z^{-1})} = \frac{z^2 - 0.4}{z^2 - 0.7z}$$
这个[有理函数](@entry_id:154279)形式清晰地揭示了系统的[代数结构](@entry_id:137052)，是我们后续分析的基础。

### 利用[系统函数](@entry_id:267697)表征系统特性

[系统函数](@entry_id:267697) $H(z)$ 不仅仅是一个数学表达式，它是一个蕴含了系统全部动态特性的信息宝库。通过分析 $H(z)$ 的结构，我们可以直接推断出系统的许多重要性质。

#### 极点与零点

对于由 LCCDE 描述的 LTI 系统，其[系统函数](@entry_id:267697)总是一个关于 $z$ 或 $z^{-1}$ 的有理函数，可以表示为：
$$H(z) = \frac{N(z)}{D(z)} = K \frac{\prod_{k=1}^{M}(z-z_k)}{\prod_{k=1}^{N}(z-p_k)}$$
其中 $N(z)$ 和 $D(z)$ 分别是分子和分母多项式。

- **零点 (Zeros)**：使分子多项式 $N(z)$ 等于零的 $z$ 值（$z_k$），即 $H(z_k)=0$。在这些[复频率](@entry_id:266400)点上，系统的响应为零。
- **极点 (Poles)**：使分母多项式 $D(z)$ 等于零的 $z$ 值（$p_k$），即 $H(p_k) \to \infty$。极点的位置决定了系统的固有模态或自然响应，对系统的稳定性有决定性影响。

例如，对于一个由差分方程 $y[n] - 0.9 y[n-2] = x[n] + x[n-1]$ 描述的系统 [@problem_id:1766551]，我们首先求出其[系统函数](@entry_id:267697)：
$$Y(z) - 0.9z^{-2}Y(z) = X(z) + z^{-1}X(z)$$
$$H(z) = \frac{1+z^{-1}}{1-0.9z^{-2}} = \frac{z^2(1+z^{-1})}{z^2(1-0.9z^{-2})} = \frac{z^2+z}{z^2-0.9} = \frac{z(z+1)}{(z-\sqrt{0.9})(z+\sqrt{0.9})}$$
从这个表达式中，我们可以立即识别出：
- **零点**：$z=0$ 和 $z=-1$。
- **极点**：$z=\sqrt{0.9} \approx 0.949$ 和 $z=-\sqrt{0.9} \approx -0.949$。

极点和零点的位置可以绘制在复平面上，形成**极[零图](@entry_id:275064) (pole-zero plot)**，这为我们提供了系统行为的直观几何视图。

[极点和零点](@entry_id:262457)的概念也适用于由基本模块构成的复杂系统。例如，一个[前向通路](@entry_id:275478)为 $H_f(z)$，反馈通路增益为 $K$ 的负反馈系统 [@problem_id:1766556]，其总[系统函数](@entry_id:267697)为：
$$H(z) = \frac{H_f(z)}{1 + K H_f(z)}$$
如果 $H_f(z) = \frac{1}{2}(1 + z^{-1}) = \frac{z+1}{2z}$ 且 $K=1$，则总[系统函数](@entry_id:267697)为：
$$H(z) = \frac{\frac{z+1}{2z}}{1 + \frac{z+1}{2z}} = \frac{z+1}{2z + (z+1)} = \frac{z+1}{3z+1}$$
该系统的零点在 $z=-1$，极点在 $z = -1/3$。可以看到，反馈结构改变了[系统的极点](@entry_id:261618)位置（从开环的 $z=0$ 移动到了 $z=-1/3$），从而改变了系统的动态特性。

#### FIR 与 IIR 系统

根据脉冲响应 $h[n]$ 的长度，LTI 系统可分为两类：**[有限脉冲响应](@entry_id:192542) (Finite Impulse Response, FIR)** 系统和**无限脉冲响应 (Infinite Impulse Response, IIR)** 系统。这一分类在[系统函数](@entry_id:267697) $H(z)$ 中有非常清晰的体现。

- **FIR 系统**：其脉冲响应 $h[n]$ 仅在有限个时间点上非零。这意味着 $H(z) = \sum_{n=N_1}^{N_2} h[n]z^{-n}$ 是一个关于 $z^{-1}$ 的有限项多項式。这类系统的所有极点（除了可能因表示形式而在 $z=0$ 或 $z=\infty$ 处的极点）都位于原点。例如，[系统函数](@entry_id:267697) $H(z) = 1 + z^{-1} + z^{-2}$ [@problem_id:1766523] 是一个典型的 FIR 系统。通过对比 Z 变换的定义式，我们可以直接“读出”其脉冲响应为：
$$h[n] = \delta[n] + \delta[n-1] + \delta[n-2]$$
这是一个长度为 3 的序列。FIR 滤波器由于没有非零极点，总是稳定的，且易于实现[线性相位](@entry_id:274637)，在数字信号处理中有广泛应用。另一个 FIR 系统的例子是 $H(z) = 1 + 3z^{-1} - 4z^{-3}$ [@problem_id:1766508]。

- **IIR 系统**：其脉冲响应 $h[n]$ 在无限多个时间点上非零。这对应于一个具有非平凡分母的[系统函数](@entry_id:267697) $H(z)$，即它在 Z 平面（不含原点和无穷远点）上至少有一个极点。之前我们从[差分方程](@entry_id:262177)和脉冲响应推导出的系统，如 $H(z) = \frac{z^2 - 0.4}{z^2 - 0.7z}$ [@problem_id:1766522] 和 $H(z) = \frac{1 - \alpha \cos(\omega_0) z^{-1}}{1 - 2\alpha \cos(\omega_0) z^{-1} + \alpha^2 z^{-2}}$ [@problem_id:1766552]，都是 IIR 系统。它们的脉冲响应包含形如 $\alpha^n u[n]$ 的项，会无限延伸。IIR 系统可以用较少的计算资源（较低的阶数）实现非常陡峭的[频率响应](@entry_id:183149)，但稳定性和相位问题需要仔细设计。

### [系统函数](@entry_id:267697)、收斂域、[稳定性与因果性](@entry_id:275884)的相互关系

到目前为止，我们主要关注[系统函数](@entry_id:267697)的代数表达式。然而，一个完整的 Z 变换定义必须包含其**收敛域 (Region of Convergence, ROC)**。ROC 是 Z 平面上使得 Z 变换级数收敛的点的集合。令人惊讶的是，仅仅改变 ROC，同一个代数表达式 $H(z)$ 可以对应于性质截然不同的系统（例如，因果的或非因果的，稳定的或不稳定的）。

#### [因果性与稳定性](@entry_id:260582)的 Z 域判据

- **因果性 (Causality)**：一个 LTI 系统是因果的，当且仅当其脉冲响应 $h[n]$ 对于 $n0$ 恒为零，即 $h[n]$ 是一个**[右边序列](@entry_id:261542) (right-sided sequence)**。在 Z 域中，这对应于 ROC 是某个圆的外部，并延伸至 $z=\infty$。对于[有理系统函数](@entry_id:203999)，**[因果系统](@entry_id:264914)的 ROC 是 $|z| > |p_{\max}|$**，其中 $|p_{\max}|$ 是所有极点中模最大的那个极点的模。

- **稳定性 (Stability)**：一个 LTI 系统是 BIBO（有界输入，有界输出）稳定的，当且仅当其脉冲响应是绝对可和的，即 $\sum_{n=-\infty}^{\infty} |h[n]|  \infty$。在 Z 域中，这个条件等价于**系统的 ROC 必须包含单位圆 $|z|=1$**。这是因为单位圆上的 Z 变换即为系统的[频率响应](@entry_id:183149)；ROC 包含单位圆保证了频率响应是收敛且有界的。

将这两个判据结合起来，我们得到分析 LTI 系统的最重要结论之一：
**一个因果 LTI 系统是稳定的，当且仅当其[系统函数](@entry_id:267697) $H(z)$ 的所有极点都严格位于单位圆内部。**

理由如下：因果性要求 ROC 是 $|z| > |p_{\max}|$。稳定性要求 ROC 包含 $|z|=1$。要同时满足这两个条件，唯一的可能是 $|p_{\max}|  1$，这意味着所有极点 $p_k$ 都必须满足 $|p_k|  1$。

例如，如果一个因果 LTI 系统已知有一个极点位于 $z=1.2$ [@problem_id:1766535]，那么根据因果性，其 ROC 必须是 $|z| > r_{\max}$，其中 $r_{\max} \ge 1.2$。这个 ROC 显然不包含单位圆 $|z|=1$。因此，该系统必定是**不稳定**的。

#### [稳定性与因果性](@entry_id:275884)的权衡

对于一个给定的[有理函数](@entry_id:154279) $H(z)$，其可能的 ROC 总是由穿过极点的圆环所界定。这导致了一个深刻的结论：对于某些系统，稳定性和因果性可能是互斥的。

考虑一个[系统函数](@entry_id:267697)，其极点既有在[单位圆](@entry_id:267290)内的，也有在[单位圆](@entry_id:267290)外的 [@problem_id:1701978] [@problem_id:1766545]。例如：
$$H(z) = \frac{1}{(1 - 0.5z^{-1})(1 - 2z^{-1})} = \frac{z^2}{(z-0.5)(z-2)}$$
该系统有两个极点：$p_1=0.5$ 和 $p_2=2$。它有以下三种可能的 ROC，对应三种不同的系统：

1.  **ROC: $|z| > 2$**。这是包含无穷远的区域，对应一个**因果**系统。其脉冲响应是两个[右边序列](@entry_id:261542)之和。但由于这个区域不包含[单位圆](@entry_id:267290) $|z|=1$，所以这个[因果系统](@entry_id:264914)是**不稳定**的。
2.  **ROC: $|z|  0.5$**。这是包含原点的区域，对应一个**反因果 (anti-causal)** 系统（$h[n]=0$ for $n>0$）。这个区域也不包含[单位圆](@entry_id:267290)，因此系统是**不稳定**的。
3.  **ROC: $0.5  |z|  2$**。这是一个环形区域。它包含了[单位圆](@entry_id:267290) $|z|=1$，因此对应的系统是**稳定**的。然而，这个 ROC 既不包含原点也不包含无穷远，对应的脉冲响应 $h[n]$ 是一个**[双边序列](@entry_id:262580) (two-sided sequence)**，因此系统是**非因果**的。

这个例子清晰地表明，对于一个含有位于[单位圆](@entry_id:267290)外的极点的系统，我们**不可能**同时实现因果性和稳定性。设计师必须在两者之间做出选择：要么接受一个不稳定的因果滤波器，要么接受一个稳定的但需要未来输入值的[非因果滤波器](@entry_id:269855)。这是[数字滤波器](@entry_id:181052)和[控制系统设计](@entry_id:273663)中的一个基本限制。

### 特殊系统类型：[最小相位系统](@entry_id:268223)

在稳定且因果的系统大家族中，还有一类具有特殊重要性的系统，称为**[最小相位系统](@entry_id:268223) (minimum-phase systems)**。

一个因果且稳定的 LTI 系统被称为**[最小相位系统](@entry_id:268223)**，如果它的所有**零点**也全部严格位于单位圆内部。

这个定义的直接推论是，如果一个系统 $H(z)$ 是[最小相位](@entry_id:273619)的，那么它的[逆系统](@entry_id:271994) $H_{inv}(z) = 1/H(z)$ 也是因果且稳定的。这是因为 $H(z)$ 的[极点和零点](@entry_id:262457)分别成为 $H_{inv}(z)$ 的[零点和极点](@entry_id:177073)。既然 $H(z)$ 的所有[极点和零点](@entry_id:262457)都在单位圆内，那么 $H_{inv}(z)$ 的所有极点（即 $H(z)$ 的零点）也都在[单位圆](@entry_id:267290)内，因此 $H_{inv}(z)$ 对应的[因果系统](@entry_id:264914)也是稳定的。

[最小相位系统](@entry_id:268223)在信号处理和控制领域备受青睐，因为在所有具有相同[幅度响应](@entry_id:271115)的系统中，[最小相位系统](@entry_id:268223)具有**最小的[群延迟](@entry_id:267197) (group delay)**。[群延迟](@entry_id:267197)衡量了信号不同频率分量通过系统时的时延。最小化[群延迟](@entry_id:267197)意味着最小化信号的[相位失真](@entry_id:184482)，这对于[音频处理](@entry_id:273289)等应用至关重要。

让我们通过一个例子来辨别[最小相位系统](@entry_id:268223) [@problem_id:1766509]。考虑两个因果、稳定的 FIR 系统：
- 系统 A: $H_A(z) = 1 - 0.5z^{-1}$
- 系统 B: $H_B(z) = 0.5 - z^{-1}$

首先找到它们的零点：
- 对于系统 A：$1 - 0.5z^{-1} = 0 \implies z = 0.5$。零点位于 $z=0.5$，其模 $|0.5|  1$。由于其零点在单位圆内，系统 A 是一个**[最小相位系统](@entry_id:268223)**。
- 对于系统 B：$0.5 - z^{-1} = 0 \implies z = 2$。零点位于 $z=2$，其模 $|2| > 1$。由于其零点在[单位圆](@entry_id:267290)外，系统 B **不是**[最小相位系统](@entry_id:268223)。（这类零点全在[单位圆](@entry_id:267290)外的系统有时被称为“[最大相位系统](@entry_id:195859)”）。

有趣的是，这两个系统的[幅度响应](@entry_id:271115) $|H_A(e^{\mathrm{j}\omega})|$ 和 $|H_B(e^{\mathrm{j}\omega})|$ 大小是相同的。可以证明 $|H_B(e^{\mathrm{j}\omega})| = |H_A(e^{\mathrm{j}\omega})|$。尽管它们的[幅度响应](@entry_id:271115)完全相同，但它们的相位特性和[瞬态响应](@entry_id:165150)却大相径庭，这正是由零点位置的差异所决定的。

总结而言，[系统函数](@entry_id:267697) $H(z)$ 及其[收敛域](@entry_id:269722)是理解离散时间 LTI 系统的关键。通过分析其[极点和零点](@entry_id:262457)的位置，我们可以深刻洞察系统的因果性、稳定性、响应类型（FIR/IIR）以及相位特性，从而为[系统分析](@entry_id:263805)和设计提供坚实的理论基础。