## 引言
在信号与系统的世界里，线性时不变（LTI）系统通常由其[传递函数](@entry_id:273897)或差分方程来精确描述。然而，一个数学公式如何转变为一个在智能手机、音频设备或[通信系统](@entry_id:265921)中实际运行的组件呢？这其中存在一个从理论到实践的关键鸿沟。我们需要一个具体的“实现蓝图”，它规定了如何利用加法器、乘法器和存储单元（延迟）这些基本计算模块来构建我们设计的系统。

本文旨在填补这一鸿沟，系统地介绍两种最基础且重要的实现结构：[直接I型](@entry_id:270846)与[直接II型](@entry_id:269862)结构。它们是将抽象的[LTI系统理论](@entry_id:178867)付诸实践的基石。通过本文的学习，你将掌握：
- **第一章：原理与机制** 将深入剖析[直接I型](@entry_id:270846)和[直接II型](@entry_id:269862)结构的推导过程，比较它们的[信号流图](@entry_id:173950)，并从根本上理解它们在存储效率上的关键差异。
- **第二章：应用与跨学科连接** 将展示这些结构如何在实际问题中应用，从资源分析到[数值稳定性](@entry_id:146550)考量，并探讨其局限性如何催生出更先进的实现方法。
- **第三章：动手实践** 将提供一系列练习，帮助你将理论知识应用于具体问题，例如从差分方程推导结构，或根据系统响应辨识其参数。

让我们首先进入第一章，揭开[直接I型](@entry_id:270846)和[直接II型](@entry_id:269862)结构的神秘面纱，理解它们如何将一个[传递函数](@entry_id:273897)转变为一个可计算的信号处理流程。

## 原理与机制

在数字信号处理领域，一个[线性时不变 (LTI) 系统](@entry_id:178866)通常由其**[差分方程](@entry_id:262177)**或等效的**[传递函数](@entry_id:273897)** $H(z)$ 来描述。然而，这些数学表示本身并不直接告诉我们如何在硬件或软件中构建该系统。为了将一个理论上的滤波器转化为一个实际的设备，我们需要一个“蓝图”，这个蓝图被称为实现结构。它详细说明了如何连接基本的计算元件——**加法器** (adders)、**乘法器** (multipliers) 和**单位延迟单元** (unit delay elements)——来实现所需的输入-输出关系。本章将深入探讨两种最基本的实现结构：**[直接I型](@entry_id:270846)** (Direct Form I) 和**[直接II型](@entry_id:269862)** (Direct Form II) 结构。

一个因果[LTI系统](@entry_id:271946)的有理[传递函数](@entry_id:273897)通常表示为 $z^{-1}$ 的多项式之比：
$$ H(z) = \frac{Y(z)}{X(z)} = \frac{\sum_{k=0}^{M} b_k z^{-k}}{1 + \sum_{k=1}^{N} a_k z^{-k}} $$
其中，$x[n]$ 和 $y[n]$ 分别是系统的输入和输出信号，$X(z)$ 和 $Y(z)$ 是它们对应的[Z变换](@entry_id:157804)。系数 $b_k$ 定义了前向路径，而系数 $a_k$ 定义了反馈路径。我们的目标是系统地将这个数学表达式转换为一个可计算的[信号流图](@entry_id:173950)。

### [直接I型](@entry_id:270846)结构：级联的视角

理解[直接I型](@entry_id:270846)结构的最直观方法是将其看作两个更简单的子系统级联而成[@problem_id:1714610]。我们可以将[传递函数](@entry_id:273897) $H(z)$ 分解为两个部分的乘积：
$$ H(z) = \left( \sum_{k=0}^{M} b_k z^{-k} \right) \cdot \left( \frac{1}{1 + \sum_{k=1}^{N} a_k z^{-k}} \right) = H_1(z) H_2(z) $$

第一部分，$H_1(z)$，是一个**全零点**系统，因为它只包含分子多项式。其输出仅依赖于当前和过去的输入，不涉及输出的反馈。这种结构被称为**有限冲激响应 (FIR)** 滤波器。第二部分，$H_2(z)$，是一个**全极点**系统，其分子为常数1。它的输出依赖于过去的输出值，形成一个[反馈回路](@entry_id:273536)，因此被称为**[无限冲激响应](@entry_id:180862) (IIR)** 滤波器。

在[直接I型](@entry_id:270846)实现中，输入信号 $x[n]$ 首先通过一个全零点（FIR）子系统，产生一个中间信号，我们称之为 $v[n]$。然后，这个中间信号 $v[n]$ 再被送入一个全极点（IIR）子系统，产生最终的输出 $y[n]$。这个过程可以用两组差分方程来描述[@problem_id:1714592]：

1.  **FIR部分（前馈）**: $v[n] = \sum_{k=0}^{M} b_k x[n-k]$
2.  **IIR部分（反馈）**: $y[n] = v[n] - \sum_{k=1}^{N} a_k y[n-k]$

从结构图上看，这意味着我们需要两组独立的延迟线。第一组延迟线用于存储过去的输入值 $x[n-1], x[n-2], \dots, x[n-M]$，以计算 $v[n]$。第二组延迟线用于存储过去的输出值 $y[n-1], y[n-2], \dots, y[n-N]$，以计算最终的 $y[n]$。因此，[直接I型](@entry_id:270846)结构所需的总延迟单元数量为：
$$ N_{DF1} = M + N $$

例如，考虑一个四阶[IIR滤波器](@entry_id:273934)，其输出依赖于四个过去的输出值（$N=4$），并且其前馈部分使用当前输入和四个过去的输入值（$M=4$）。采用[直接I型](@entry_id:270846)结构实现时，将需要 $M+N = 4+4=8$ 个延迟单元[@problem_id:1714606]。同样，如果一个系统的[传递函数](@entry_id:273897)分母阶数为 $N=3$，分子阶数为 $M=2$，那么[直接I型](@entry_id:270846)实现将需要 $N_{DF1} = 2+3=5$ 个单位延迟单元[@problem_id:1714566]。这种结构虽然概念上清晰，直接反映了[传递函数](@entry_id:273897)的两个组成部分，但在存储资源上并非最优。

### [直接II型](@entry_id:269862)结构：一种存储高效的典范形式

[直接I型](@entry_id:270846)结构的一个关键观察是，它由两个LTI子系统级联而成。[LTI系统](@entry_id:271946)的一个基本性质是它们是可交换的，即 $H_1(z)H_2(z) = H_2(z)H_1(z)$。这意味着我们可以颠倒级联的顺序，先让输入信号通过全极点部分，再通过全零点部分，而最终的输入-输出关系保持不变。这个简单的顺序交换，却能带来显著的实现优势。

在这种新的配置下，输入 $x[n]$ 首先进入全极点系统 $H_2(z)$，产生一个新的中间信号，我们称之为 $w[n]$。然后，$w[n]$ 再被送入全零点系统 $H_1(z)$，得到最终输出 $y[n]$。这对应于以下[Z变换](@entry_id:157804)关系[@problem_id:1714592]：
$$ W(z) = \frac{1}{1 + \sum_{k=1}^{N} a_k z^{-k}} X(z) \quad \text{和} \quad Y(z) = \left( \sum_{k=0}^{M} b_k z^{-k} \right) W(z) $$

将这些关系转换回时域，我们得到描述[直接II型](@entry_id:269862)结构的一对耦合[差分方程](@entry_id:262177)[@problem_id:1714579]：

1.  **递归部分**: $w[n] = x[n] - \sum_{k=1}^{N} a_k w[n-k]$
2.  **非递归部分**: $y[n] = \sum_{k=0}^{M} b_k w[n-k]$

这里的关键洞察在于，两个方程都依赖于中间信号 $w[n]$ 及其延迟。计算 $w[n]$ 需要 $w[n-1], \dots, w[n-N]$，而计算 $y[n]$ 需要 $w[n], w[n-1], \dots, w[n-M]$。这两个需求可以由同一组延迟单元来满足。我们可以创建一个单一的延迟链来存储 $w[n-1], w[n-2], \dots$，然后从这个共享的延迟链中取出相应的值来计算反馈项和前馈项。

这条共享延迟链的长度必须足以满足两个方程中更长的那个。因此，[直接II型](@entry_id:269862)结构所需的总延迟单元数量为：
$$ N_{DF2} = \max(M, N) $$

由于 $\max(M, N) \le M+N$ 总是成立，[直接II型](@entry_id:269862)结构所需（或更少）的延迟单元永远不会多于[直接I型](@entry_id:270846)。正是因为其在给定[传递函数](@entry_id:273897)阶数下实现了最少的延迟单元（存储器）数量，[直接II型](@entry_id:269862)结构也被称为**典范形式** (canonical form)。

通过选择[直接II型](@entry_id:269862)结构而非[直接I型](@entry_id:270846)，所节省的延迟单元数量为 $(M+N) - \max(M,N) = \min(M,N)$。这个节约在阶数较高时尤为重要。例如，在一个为实时[音频处理](@entry_id:273289)设计的滤波器中，若分子和分母的阶数均为4（$M=4, N=4$），从[直接I型](@entry_id:270846)（需要8个延迟）转换到[直接II型](@entry_id:269862)（需要4个延迟）可以减少一半的存储需求，即节省了 $\min(4,4) = 4$ 个延迟单元[@problem_id:1714597]。对于另一个例子，其中 $N=3$ 和 $M=2$，[直接II型](@entry_id:269862)需要 $\max(2,3) = 3$ 个延迟单元，相比[直接I型](@entry_id:270846)的5个，节省了 $\min(2,3) = 2$ 个单元[@problem_id:1714566]。

### 实现、分析与实际考量

在设计一个嵌入式系统时，除了存储器（延迟单元），我们还关心其他资源的消耗，如乘法器和加法器。

#### 组件计数与实现成本

一个完整的实现成本评估需要计算所有三种基本组件。
*   **延迟单元**: 如上所述，[直接II型](@entry_id:269862)（典范形式）需要 $\max(M, N)$ 个延迟单元。
*   **乘法器**: 通常，每个非零且非$\pm1$的系数 $a_k$ 和 $b_k$ 都需要一个专用的乘法器。
*   **加法器**: 在[直接II型](@entry_id:269862)结构中，通常有两个主要的求和节点。一个用于计算中间信号 $w[n]$（将输入 $x[n]$ 与所有反馈项相加），另一个用于计算输出信号 $y[n]$（将所有前馈项相加）。若使用双输入加法器来构建，反馈部分需要 $N$ 个加法器，前馈部分需要 $M$ 个加法器，总计 $M+N$ 个。

在资源受限的嵌入式系统中，可以定义一个“实现成本指数”来量化硬件开销，例如，通过对每种组件的数量进行加权求和[@problem_id:1714576]。假设一个滤波器由 $y[n] - 1.2 y[n-1] + 0.35 y[n-2] = 4 x[n] + 1.5 x[n-1]$ 描述，其 $N=2, M=1$。[直接II型](@entry_id:269862)实现需要：
*   $N_D = \max(2,1) = 2$ 个延迟。
*   $N_M = 4$ 个乘法器（用于系数 $-1.2, 0.35, 4, 1.5$）。
*   $N_A = N+M = 2+1 = 3$ 个双输入加法器。
如果各组件的成本权重分别为 $w_D=5.0, w_M=3.5, w_A=1.2$，则总成本为 $C = 5.0 \times 2 + 3.5 \times 4 + 1.2 \times 3 = 10 + 14 + 3.6 = 27.6$。这种分析使得工程师能够在不同设计方案之间做出量化的权衡。

#### 因果性与[可实现性](@entry_id:193701)的理论前提

我们是否可以为任何有理[传递函数](@entry_id:273897) $H(z)$ 构建[直接I型](@entry_id:270846)或II型结构？答案是否定的。这些结构隐含了一个基本要求：系统必须是**因果的** (causal)，并且物理上可实现。这与[传递函数](@entry_id:273897)分子和分母的阶数 $M$ 和 $N$ 密切相关[@problem_id:2866185]。

一个有理[传递函数](@entry_id:273897) $H(z)$ 被称为**正常的** (proper)，如果其分子阶数不大于分母阶数，即 $M \le N$。如果分子阶数严格小于分母阶数，即 $M  N$，则称其为**严格正常的** (strictly proper)。

所有物理可实现的因果[LTI系统](@entry_id:271946)，其[传递函数](@entry_id:273897)必须是正常的。这个结论可以从两个角度来理解：

1.  **从Z变换理论出发**：一个因果序列的Z变换[收敛域 (ROC)](@entry_id:268030) 必须包含 $z=\infty$。这意味着当 $z \to \infty$ 时，$H(z)$ 的极限必须是一个有限值。对于我们的有理函数 $H(z) = B(z)/A(z)$，当 $z$ 趋于无穷时，其行为由最高次项决定，即 $H(z) \sim z^{M-N}$。为了使这个极限有限，必须满足 $M-N \le 0$，即 $M \le N$。根据[初值定理](@entry_id:270733)，这个极限值正是系统的初始冲激响应 $h[0]$。如果 $M > N$，$H(z)$ 在无穷远处发散，意味着 $h[0]$ 是无限的，这与一个稳定的[因果系统](@entry_id:264914)不符。

2.  **从实现结构出发**：直接型结构只使用延迟单元 ($z^{-1}$)。如果一个[传递函数](@entry_id:273897)的分子阶数大于分母阶数 ($M > N$)，我们可以对 $H(z)$ 进行[多项式长除法](@entry_id:272380)，得到：
    $$ H(z) = Q(z) + \frac{R(z)}{A(z)} $$
    其中商 $Q(z)$ 是一个 $M-N$ 阶的 $z$ 的多项式，余式 $R(z)$ 的阶数小于 $N$。$Q(z)$ 将包含 $z, z^2, \dots$ 这样的项。在时域中，乘以 $z^k$ ($k>0$) 对应于时间上的超前操作 ($x[n] \to x[n+k]$)。一个需要未来输入值的系统是非因果的，无法用只包含延迟单元的结构来实时实现。因此，一个可实现的直接型结构要求 $Q(z)$ 最多是一个常数，这等价于 $M \le N$。

#### 稳定性考量

最后，一个成功实现的滤波器不仅要结构正确，还必须是**有界输入有界输出 (BIBO) 稳定**的，以避免输出信号失控。对于一个因果[IIR滤波器](@entry_id:273934)，[BIBO稳定性](@entry_id:157773)的条件是其[传递函数](@entry_id:273897)的所有极点都必须严格位于[Z平面](@entry_id:264625)的单位圆内部。

极点是[传递函数](@entry_id:273897)分母多项式 $A(z) = 1 + \sum_{k=1}^{N} a_k z^{-k}$ 的根。这意味着，在直接型结构中直接使用的[反馈系数](@entry_id:275731) $a_k$ 唯一地决定了系统的稳定性。在设计可调滤波器时，这是一个至关重要的考虑。例如，在一个由 $y[n] = a_1 y[n-1] - 0.5 y[n-2] + x[n]$ 描述的实时音频效果器中，我们需要确定可调参数 $a_1$ 的范围以保证稳定性[@problem_id:1714604]。该系统的[特征多项式](@entry_id:150909)为 $z^2 - a_1 z + 0.5 = 0$。对于二阶系统，使用[Jury稳定性判据](@entry_id:172703)可以得到稳定条件：$|0.5| \lt 1$（满足），$1 - a_1 + 0.5 \gt 0$ 和 $1 + a_1 + 0.5 \gt 0$。求解这两个不等式得到 $-1.5 \lt a_1 \lt 1.5$。这意味着，工程师必须将参数 $a_1$ 的可调范围限制在这个区间内，以防止滤波器产生[振荡](@entry_id:267781)或饱和。

综上所述，[直接I型](@entry_id:270846)和[直接II型](@entry_id:269862)结构为实现[LTI系统](@entry_id:271946)提供了基础蓝图。[直接I型](@entry_id:270846)在概念上将[系统分解](@entry_id:274870)为FIR和IIR两部分，易于理解但存储效率低。[直接II型](@entry_id:269862)通过交换级联顺序并共享延迟线，实现了存储最优的典范结构。选择和分析这些结构不仅需要计算组件数量，还必须深刻理解因果性、[可实现性](@entry_id:193701)和稳定性这些根本性的系统原理。