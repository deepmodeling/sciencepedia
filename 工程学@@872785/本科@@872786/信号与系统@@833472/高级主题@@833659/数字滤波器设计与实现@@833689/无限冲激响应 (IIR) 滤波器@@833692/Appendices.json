{"hands_on_practices": [{"introduction": "无限脉冲响应（IIR）滤波器的核心在于其递归结构，即当前输出不仅依赖于当前输入，还依赖于先前的输出。这个练习将带你直观地感受反馈系数如何直接影响滤波器的行为 [@problem_id:1727048]。通过为一个简单的一阶IIR滤波器计算一个特定的反馈系数 $\\alpha$，你将学会如何控制其脉冲响应的衰减速率，这是理解更复杂滤波器稳定性和瞬态响应的第一步。", "problem": "一个简单的数字音频反馈系统被设计用于产生基本的回声效果。在任何离散时间点 $n$ 的输出信号 $y[n]$，由输入信号 $x[n]$ 和前一时间步的输出 $y[n-1]$ 决定。该关系由以下差分方程所描述：\n$$y[n] = x[n] + \\alpha y[n-1]$$\n这里，$\\alpha$ 是一个表示反馈强度的正实数常数。该系统是因果的，并且初始状态为静止，即对于所有 $n  0$，有 $y[n] = 0$。\n\n为了测试该系统的时间特性，在 $n=0$ 时施加一个单位脉冲输入。该输入定义为 $x[0] = 1$ 并且对于所有其他整数 $n$，$x[n] = 0$。\n\n确定反馈系数 $\\alpha$ 的精确值，使得系统在时间 $n=2$ 时的输出幅值恰好是时间 $n=0$ 时输出幅值的一半。请用闭式解析表达式表示您的答案。", "solution": "该系统由因果线性差分方程 $y[n] = x[n] + \\alpha y[n-1]$ 定义，初始条件为静止，即对于 $n  0$ 有 $y[n] = 0$。对于单位脉冲输入，其定义为 $x[0] = 1$ 且当 $n \\neq 0$ 时 $x[n] = 0$，我们递归地计算输出。\n\n在 $n=0$ 时：\n$$\ny[0] = x[0] + \\alpha y[-1] = 1 + \\alpha \\cdot 0 = 1.\n$$\n\n在 $n=1$ 时：\n$$\ny[1] = x[1] + \\alpha y[0] = 0 + \\alpha \\cdot 1 = \\alpha.\n$$\n\n在 $n=2$ 时：\n$$\ny[2] = x[2] + \\alpha y[1] = 0 + \\alpha \\cdot \\alpha = \\alpha^{2}.\n$$\n\n因此，对于此脉冲输入，当 $n \\geq 0$ 时，有 $y[n] = \\alpha^{n}$。题目要求是在 $n=2$ 时的幅值是在 $n=0$ 时幅值的一半：\n$$\n|y[2]| = \\frac{1}{2} |y[0]|.\n$$\n由于 $\\alpha$ 是一个正实数常数，其幅值即为其值本身，所以\n$$\n\\alpha^{2} = \\frac{1}{2}.\n$$\n求解 $\\alpha$ 并选择正根，可得\n$$\n\\alpha = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "1727048"}, {"introduction": "在实际的滤波器设计中，系数的微小变化可能导致性能的巨大差异。这个练习模拟了一个制造缺陷，一个关键的反馈系数被意外置零，从而改变了一个二阶陷波滤波器的特性 [@problem_id:1727038]。通过分析这个“损坏”的滤波器，你将练习使用传递函数和零极点图来预测滤波器的频率响应，这对于滤波器设计、调试和理解其鲁棒性至关重要。", "problem": "一位数字信号处理工程师正在设计一个二阶无限冲激响应（IIR）陷波滤波器，用于从信号中去除一个特定的正弦干扰。该滤波器的输入-输出关系由以下线性常系数差分方程描述：\n\n$$y[n] = a_1 y[n-1] + a_2 y[n-2] + b_0 x[n] + b_1 x[n-1] + b_2 x[n-2]$$\n\n对于一个标准的陷波滤波器，其设计目的是消除数字频率 $\\omega_0$，其锐度由参数 $r$（其中 $0  r  1$）控制，系数设置如下：\n$b_0 = 1$\n$b_1 = -2\\cos(\\omega_0)$\n$b_2 = 1$\n$a_1 = 2r\\cos(\\omega_0)$\n$a_2 = -r^2$\n\n您可以假设陷波频率 $\\omega_0$ 不为 $0$、$\\pi/2$ 或 $\\pi$。\n\n在滤波器的物理实现过程中，出现了一个制造缺陷，导致反馈系数 $a_1$ 被永久固定为零。所有其他系数（$a_2, b_0, b_1, b_2$）都保持其原始设计值。\n\n下列哪个选项最能描述由此缺陷产生的滤波器类型？\n\nA. 一个全通滤波器。\n\nB. 一个低通滤波器。\n\nC. 一个稳定的有限冲激响应（FIR）滤波器。\n\nD. 一个在数字频率 $\\omega = \\pm \\frac{\\pi}{2}$ 处有谐振峰的陷波滤波器。\n\nE. 一个不稳定的滤波器。", "solution": "我们从给定的LTI（线性时不变）二阶IIR滤波器的线性常系数差分方程开始：\n$$\ny[n] = a_{1} y[n-1] + a_{2} y[n-2] + b_{0} x[n] + b_{1} x[n-1] + b_{2} x[n-2]\n$$\n进行$z$变换并求解传递函数 $H(z) = \\frac{Y(z)}{X(z)}$，得到标准关系式\n$$\nH(z) = \\frac{b_{0} + b_{1} z^{-1} + b_{2} z^{-2}}{1 - a_{1} z^{-1} - a_{2} z^{-2}}\n$$\n对于所设计的陷波滤波器，预期的系数为 $b_{0} = 1$、$b_{1} = -2 \\cos(\\omega_{0})$、$b_{2} = 1$、$a_{1} = 2 r \\cos(\\omega_{0})$ 和 $a_{2} = - r^{2}$，其中 $0  r  1$。由于缺陷，$a_{1}$ 被固定为零，而 $a_{2}$ 和所有 $b$ 系数保持设计值。因此，实现的传递函数变为\n$$\nH(z) = \\frac{1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2}}{1 - 0 \\cdot z^{-1} - (-r^{2}) z^{-2}} = \\frac{1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2}}{1 + r^{2} z^{-2}}\n$$\n\n接下来，确定零点和极点：\n- 分子可以因式分解为\n$$\n1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2} = \\left(1 - \\exp(j \\omega_{0}) z^{-1}\\right)\\left(1 - \\exp(- j \\omega_{0}) z^{-1}\\right)\n$$\n所以零点位于 $z = \\exp(\\pm j \\omega_{0})$，即在单位圆上角度为 $\\pm \\omega_{0}$ 的位置。这保证了在频率 $\\omega = \\pm \\omega_{0}$ 处有一个频率陷波。给定的假设 $\\omega_{0} \\neq 0, \\frac{\\pi}{2}, \\pi$ 避免了特殊的边界情况。\n- 分母为 $1 + r^{2} z^{-2} = 0 \\implies z^{2} + r^{2} = 0 \\implies z = \\pm j r$。因此极点位于半径为 $r$、角度为 $\\pm \\frac{\\pi}{2}$ 的位置。因为 $0  r  1$，两个极点都严格位于单位圆内部。因此该滤波器是BIBO（有界输入有界输出）稳定的（所有极点都严格位于单位圆内部），所以它不是不稳定的。\n\n该滤波器不是FIR滤波器，因为其分母不等于 $1$，所以它是一个IIR滤波器。它不是全通滤波器，因为单位圆上的零点 $z = \\exp(\\pm j \\omega_{0})$ 没有与倒数共轭极点配对以在所有频率上产生单位幅值。它也不是低通滤波器，因为其频率响应的特征不是高频衰减和零点附近的通带；相反，分母将在特定频率产生谐振行为。\n\n为了观察谐振行为，我们在单位圆 $z = \\exp(j \\omega)$ 上评估其频率响应：\n$$\nH\\!\\left(\\exp(j \\omega)\\right) = \\frac{1 - 2 \\cos(\\omega_{0}) \\exp(- j \\omega) + \\exp(- j 2 \\omega)}{1 + r^{2} \\exp(- j 2 \\omega)}\n$$\n分母的幅值为\n$$\n\\left|1 + r^{2} \\exp(- j 2 \\omega)\\right|^{2} = \\left(1 + r^{2} \\exp(- j 2 \\omega)\\right)\\left(1 + r^{2} \\exp(j 2 \\omega)\\right) = 1 + r^{4} + 2 r^{2} \\cos(2 \\omega)\n$$\n当 $\\cos(2 \\omega)$ 取最小值，即 $\\cos(2 \\omega) = -1$ 时，该式达到其最小值。这发生在 $2 \\omega = \\pi + 2 k \\pi$，等价于 $\\omega = \\pm \\frac{\\pi}{2} + k \\pi$。在主值范围内，这给出 $\\omega = \\pm \\frac{\\pi}{2}$。在这些频率上，\n$$\n\\left|1 + r^{2} \\exp(- j 2 \\omega)\\right| = \\left|1 - r^{2}\\right|\n$$\n这是对于 $0  r  1$ 时的最小可能值，因此总幅值 $\\left|H\\!\\left(\\exp(j \\omega)\\right)\\right|$ 在 $\\omega = \\pm \\frac{\\pi}{2}$ 处表现出谐振峰。\n\n同时，位于 $z = \\exp(\\pm j \\omega_{0})$ 的零点确保了在 $\\omega = \\pm \\omega_{0}$ 处有一个精确的陷波；假设 $\\omega_{0} \\neq \\frac{\\pi}{2}$ 避免了陷波频率与谐振方向重合。因此，这个有缺陷的滤波器最能被描述为一个在数字频率 $\\omega = \\pm \\frac{\\pi}{2}$ 处具有谐振峰的陷波滤波器（仍然在 $\\omega_{0}$ 处有陷波）。\n\n因此，在给定的选项中，正确的描述是一个在 $\\omega = \\pm \\frac{\\pi}{2}$ 处有谐振峰的陷波滤波器。", "answer": "$$\\boxed{D}$$", "id": "1727038"}, {"introduction": "尽管IIR滤波器功能强大且计算高效，但其固有的反馈回路也带来了不稳定的风险。然而，这并不意味着我们必须弃用不稳定的系统。这个练习将向你展示如何设计一个反馈控制器，通过精确的零极点对消来“驯服”一个不稳定的一阶IIR滤波器，最终构建一个稳定的整体系统 [@problem_id:1727051]。这是一个连接信号处理与控制理论的核心实践，揭示了系统设计的精妙之处。", "problem": "一个因果、线性时不变（LTI）系统，记为系统1，已知其不稳定。其特性由传递函数 $H_1(z) = \\frac{1}{1 - 3z^{-1}}$ 描述。为了稳定该系统，将一个传递函数为 $G(z)$ 的控制器置于系统1的标准负反馈配置中。在此配置中，整个系统的输出 $Y(z)$ 与其输入 $X(z)$ 的关系由表达式 $Y(z) = H_1(z) [X(z) - G(z)Y(z)]$ 给出。\n\n控制器 $G(z)$ 的设计必须满足以下两个标准：\n1. 控制器 $G(z)$ 本身必须是一个因果、稳定的一阶滤波器。\n2. 得到的整个闭环系统，其传递函数为 $H(z) = Y(z)/X(z)$，必须是一个因果且稳定的有限冲激响应（FIR）滤波器。\n\n确定满足这些要求的控制器传递函数 $G(z)$。", "solution": "从给定的负反馈互联开始：\n$$Y(z) = H_{1}(z)\\big[X(z) - G(z)Y(z)\\big], \\quad H_{1}(z) = \\frac{1}{1 - 3 z^{-1}}$$\n求解闭环传递函数 $H(z) = \\frac{Y(z)}{X(z)}$：\n$$Y(z) + H_{1}(z)G(z)Y(z) = H_{1}(z)X(z) \\;\\Rightarrow\\; \\big[1 + H_{1}(z)G(z)\\big]Y(z) = H_{1}(z)X(z)$$\n$$H(z) = \\frac{H_{1}(z)}{1 + H_{1}(z)G(z)}$$\n设定控制器 $G(z)$ 为一个因果、稳定的一阶滤波器。满足此条件的一个简单选择是一阶FIR形式\n$$G(z) = g_{0} + g_{1} z^{-1}$$\n对于任何有限的 $g_{0}, g_{1}$，该形式是因果且BIBO稳定的。代入闭环表达式并化简：\n$$H(z) = \\frac{\\frac{1}{1 - 3 z^{-1}}}{1 + \\frac{1}{1 - 3 z^{-1}}\\big(g_{0} + g_{1} z^{-1}\\big)} = \\frac{1}{1 - 3 z^{-1} + g_{0} + g_{1} z^{-1}} = \\frac{1}{(1 + g_{0}) + (g_{1} - 3) z^{-1}}$$\n为了使 $H(z)$ 成为一个因果、稳定的FIR滤波器，其分母必须是一个非零常数（不含 $z^{-1}$ 项）。因此强制\n$$g_{1} - 3 = 0 \\;\\Rightarrow\\; g_{1} = 3$$\n则\n$$H(z) = \\frac{1}{1 + g_{0}}$$\n这是一个常数FIR（长度为1），只要 $1 + g_{0} \\neq 0$，它就是因果且稳定的。为简单起见，选择 $g_{0} = 0$ 可得到单位闭环增益 $H(z) = 1$ 和控制器\n$$G(z) = 3 z^{-1}$$\n它是一个因果、稳定的一阶FIR滤波器，满足两个设计要求。", "answer": "$$\\boxed{3 z^{-1}}$$", "id": "1727051"}]}