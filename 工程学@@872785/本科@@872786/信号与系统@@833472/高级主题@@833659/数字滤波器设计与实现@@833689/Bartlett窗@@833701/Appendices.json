{"hands_on_practices": [{"introduction": "要掌握任何窗函数，第一步都是理解其基本应用。这个练习将引导您将一个巴特利特窗直接应用于一个离散时间信号，这是在进行傅里叶变换前为减少频谱泄漏而执行的一项基本操作。通过这个直接计算，您将熟悉巴特利特窗的三角形形状以及逐点相乘的过程。[@problem_id:1699596]", "problem": "在数字信号处理中，当进行傅里叶变换时，常对有限长度信号应用窗函数以减少频谱泄漏。考虑一个有限长度的离散时间信号 $x[n]$，当 $n = 0, 1, 2, 3, 4$ 时，其值由序列 $\\{1, 2, 3, 2, 1\\}$ 给出，对于所有其他的 $n$ 值，$x[n]=0$。\n\n该信号将与一个5点因果巴特利特（三角）窗 $w[n]$ 相乘。长度为 $N$ 的因果巴特利特窗的通用公式如下：\n$$w[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}$$\n其中整数 $n$ 的范围是 $0 \\le n \\le N-1$。\n\n得到的加窗信号 $y[n]$ 是输入信号和窗函数的逐点乘积，即 $y[n] = x[n] \\cdot w[n]$。\n\n确定在区间 $n=0, 1, 2, 3, 4$ 上的输出序列 $y[n]$。将您的答案表示为一行数字序列，分别对应于 $y[0], y[1], y[2], y[3], y[4]$ 的值。", "solution": "给定一个有限长度信号 $x[n]$，其中 $x[0]=1$, $x[1]=2$, $x[2]=3$, $x[3]=2$, $x[4]=1$，其他情况下 $x[n]=0$，以及一个为 $0 \\leq n \\leq N-1$ 定义的5点因果巴特利特窗 $w[n]$：\n$$\nw[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}.\n$$\n对于 $N=5$，我们有 $N-1=4$ 和 $\\frac{N-1}{2}=2$，所以\n$$\nw[n] = 1 - \\frac{2 |n-2|}{4} = 1 - \\frac{|n-2|}{2}, \\quad n=0,1,2,3,4.\n$$\n计算每个 $n$ 处的 $w[n]$ 值：\n- 对于 $n=0$： $|0-2|=2 \\Rightarrow w[0] = 1 - \\frac{2}{2} = 0$。\n- 对于 $n=1$： $|1-2|=1 \\Rightarrow w[1] = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n- 对于 $n=2$： $|2-2|=0 \\Rightarrow w[2] = 1 - 0 = 1$。\n- 对于 $n=3$： $|3-2|=1 \\Rightarrow w[3] = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n- 对于 $n=4$： $|4-2|=2 \\Rightarrow w[4] = 1 - \\frac{2}{2} = 0$。\n\n加窗信号为 $y[n] = x[n] w[n]$。计算每个值：\n- $y[0] = 1 \\cdot 0 = 0$。\n- $y[1] = 2 \\cdot \\frac{1}{2} = 1$。\n- $y[2] = 3 \\cdot 1 = 3$。\n- $y[3] = 2 \\cdot \\frac{1}{2} = 1$。\n- $y[4] = 1 \\cdot 0 = 0$。\n\n因此，在 $n=0,1,2,3,4$ 上的输出序列是 $(0, 1, 3, 1, 0)$。", "answer": "$$\\boxed{\\begin{pmatrix}0  1  3  1  0\\end{pmatrix}}$$", "id": "1699596"}, {"introduction": "在掌握了基本应用之后，让我们来探索一个更实际的场景：使用巴特利特窗作为滤波器来处理噪声信号。这个练习将巴特利特窗的脉冲响应与随机过程理论联系起来，计算通过滤波器后的白噪声的输出功率。这有助于您理解滤波器形状如何直接影响其对噪声的统计特性。[@problem_id:1699598]", "problem": "一个数字信号处理系统被设计用于分析一个噪声数据流。该系统的输入 $x[n]$ 被建模为一系列不相关的随机变量，代表离散时间白噪声。该噪声过程的均值为零，方差为一。\n\n信号 $x[n]$ 由一个有限脉冲响应（FIR）滤波器处理。该滤波器的脉冲响应，记为 $h[n]$，由一个长度为奇数 $N > 1$ 的巴特利特（三角）窗定义。脉冲响应的系数由以下公式给出：\n$$h[n] = 1 - \\frac{2\\left|n - \\frac{N-1}{2}\\right|}{N-1}, \\quad \\text{其中 } n = 0, 1, \\dots, N-1$$\n且在其他情况下 $h[n] = 0$。\n\n确定滤波器输出信号 $y[n]$ 的总平均功率。将您的答案表示为关于滤波器长度 $N$ 的闭式解析表达式。", "solution": "一个脉冲响应为 $h[n]$ 的线性时不变（LTI）系统的输出信号 $y[n]$ 是输入信号 $x[n]$ 与 $h[n]$ 的卷积，即 $y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} h[k]x[n-k]$。\n\n输出信号的总平均功率 $P_y$ 定义为其幅度平方的期望值，$P_y = E\\left[|y[n]|^2\\right]$。由于滤波器脉冲响应 $h[n]$ 是实值的，输出 $y[n]$ 也是实值的，因此 $P_y = E\\left[y[n]^2\\right]$。\n\n代入 $y[n]$ 的卷积和：\n$$P_y = E\\left[ \\left( \\sum_{k=0}^{N-1} h[k]x[n-k] \\right) \\left( \\sum_{l=0}^{N-1} h[l]x[n-l] \\right) \\right]$$\n$$P_y = E\\left[ \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]x[n-k]x[n-l] \\right]$$\n根据期望的线性性质，我们可以将期望算子移到求和符号内部：\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]E[x[n-k]x[n-l]]$$\n$E[x[n-k]x[n-l]]$ 这一项是输入信号的自相关，$R_{xx}[(n-k)-(n-l)] = R_{xx}[l-k]$。\n\n输入 $x[n]$ 是均值为零、方差为一的白噪声。这意味着其自相关函数为 $R_{xx}[m] = \\sigma_x^2 \\delta[m] = 1 \\cdot \\delta[m]$，其中 $\\delta[m]$ 是克罗内克δ函数。\n因此，$E[x[n-k]x[n-l]] = \\delta[l-k]$。输出功率的表达式得到显著简化，因为该项仅在 $l=k$ 时非零：\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]\\delta[l-k] = \\sum_{k=0}^{N-1} h[k]h[k] = \\sum_{k=0}^{N-1} h[k]^2$$\n这个结果表明，对于单位方差的白噪声输入，输出功率等于滤波器脉冲响应的能量。\n\n现在我们必须使用给定的 $h[n]$ 表达式来计算这个和。由于 $N$ 被指定为大于1的奇数，我们可以定义一个整数 $M = \\frac{N-1}{2}$，其中 $M \\ge 1$。脉冲响应可以写成：\n$$h[n] = 1 - \\frac{|n - M|}{M}, \\quad \\text{for } n = 0, 1, \\dots, 2M$$\n功率的求和为：\n$$P_y = \\sum_{n=0}^{2M} \\left( 1 - \\frac{|n - M|}{M} \\right)^2$$\n这个和关于中心点 $n=M$ 是对称的。我们可以通过分离中心项（$n=M$）并组合中心周围的对称项对来重写它。\n$$P_y = \\left( h[M] \\right)^2 + \\sum_{n=0}^{M-1} \\left(h[n]\\right)^2 + \\sum_{n=M+1}^{2M} \\left(h[n]\\right)^2$$\n由于对称性，$h[n] = h[2M-n]$。因此，这两个和是相等的。\n$$P_y = \\left( h[M] \\right)^2 + 2\\sum_{n=0}^{M-1} \\left(h[n]\\right)^2$$\n在中心点 $n=M$ 处，我们有 $h[M] = 1 - \\frac{|M - M|}{M} = 1$。\n对于 $n < M$，我们有 $|n-M| = M-n$，所以 $h[n] = 1 - \\frac{M-n}{M} = \\frac{n}{M}$。\n将这些代入功率方程：\n$$P_y = 1^2 + 2\\sum_{n=0}^{M-1} \\left( \\frac{n}{M} \\right)^2 = 1 + \\frac{2}{M^2} \\sum_{n=0}^{M-1} n^2$$\n求和从 $n=0$ 开始，但第一项是 $0^2=0$，所以我们可以从 $n=1$ 开始求和：\n$$P_y = 1 + \\frac{2}{M^2} \\sum_{n=1}^{M-1} n^2$$\n我们使用前 $m$ 个平方数的求和公式：$\\sum_{k=1}^{m} k^2 = \\frac{m(m+1)(2m+1)}{6}$。这里，$m=M-1$。\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)((M-1)+1)(2(M-1)+1)}{6} \\right]$$\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)M(2M-1)}{6} \\right] = 1 + \\frac{(M-1)(2M-1)}{3M}$$\n现在，我们将各项合并，使用公共分母 $3M$：\n$$P_y = \\frac{3M + (M-1)(2M-1)}{3M} = \\frac{3M + (2M^2 - 3M + 1)}{3M} = \\frac{2M^2 + 1}{3M}$$\n最后，我们代回 $M = \\frac{N-1}{2}$：\n$$P_y = \\frac{2\\left(\\frac{N-1}{2}\\right)^2 + 1}{3\\left(\\frac{N-1}{2}\\right)} = \\frac{2\\frac{(N-1)^2}{4} + 1}{\\frac{3(N-1)}{2}} = \\frac{\\frac{(N-1)^2}{2} + 1}{\\frac{3(N-1)}{2}}$$\n将分子和分母同乘以2，得到最终表达式：\n$$P_y = \\frac{(N-1)^2 + 2}{3(N-1)}$$\n这就是输出信号的总平均功率作为 $N$ 的函数。", "answer": "$$\\boxed{\\frac{(N-1)^{2} + 2}{3(N-1)}}$$", "id": "1699598"}, {"introduction": "理论知识的最终目的是应用于高效的实践。巴特利特窗的一个优雅特性是它可以看作是两个矩形窗的卷积，这一结构为高效实现提供了可能。本练习将挑战您利用这一特性，为巴特利特窗滤波器设计一个多相分解结构，这是数字信号处理中提高计算效率的关键高级技术。[@problem_id:1699569]", "problem": "一个因果有限冲激响应（FIR）滤波器的特征是其冲激响应 $h[n]$ 为一个长度为 $N=2M-1$ 的巴特利特（三角）窗，其中 $M$ 是一个正整数。该冲激响应可以通过将一个长度为 $M$ 的矩形窗 $w_R[n]$ 与其自身进行卷积来生成，即 $h[n] = w_R[n] * w_R[n]$。矩形窗定义为：当 $0 \\leq n \\leq M-1$ 时，$w_R[n] = 1$，其他情况下 $w_R[n] = 0$。\n\n对于这个问题，我们施加一个约束，即矩形窗的长度 $M$ 是一个偶数，可以表示为 $M=2K$，其中 $K$ 是某个正整数。\n\n目标是使用 2 分量 I 型多相分解来设计该滤波器的一种计算高效的实现。该滤波器的传递函数 $H(z)$ 可以用其多相分量 $E_0(z)$ 和 $E_1(z)$ 表示为：\n$$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$$\n\n你的任务是推导多相分量 $E_0(z)$ 和 $E_1(z)$ 的解析表达式。将你的答案表示为 $z$ 和整数 $K$ 的函数。以 $\\begin{pmatrix} E_0(z)  E_1(z) \\end{pmatrix}$ 形式的 2 元素行矩阵给出你的最终答案。", "solution": "我们从长度为偶数 $M=2K$ 的因果矩形窗开始，当 $0 \\leq n \\leq 2K-1$ 时，$w_{R}[n]=1$，其他情况下 $w_{R}[n]=0$。其 $z$ 变换为\n$$\nW_{R}(z)=\\sum_{n=0}^{2K-1}z^{-n}=\\frac{1-z^{-2K}}{1-z^{-1}}.\n$$\n巴特利特（三角）冲激响应是卷积 $h[n]=w_{R}[n]*w_{R}[n]$，因此其传递函数为\n$$\nH(z)=W_{R}(z)^{2}=\\left(\\frac{1-z^{-2K}}{1-z^{-1}}\\right)^{2}.\n$$\n\n对于一个 2 分支 I 型多相分解，我们写作：\n$$\nH(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2}),\n$$\n其中：\n$$\nE_{0}(z)=\\sum_{m}h[2m]z^{-m},\\quad E_{1}(z)=\\sum_{m}h[2m+1]z^{-m}.\n$$\n\n利用 $M=2K$ 是偶数这一事实。那么 $W_{R}(z)$ 具有相等的偶数和奇数多相分量：\n$$\nW_{R}(z)=E_{0}^{(R)}(z^{2})+z^{-1}E_{1}^{(R)}(z^{2}),\\quad E_{0}^{(R)}(z)=E_{1}^{(R)}(z)=\\sum_{m=0}^{K-1}z^{-m}.\n$$\n确实，\n$$\nW_{R}(z)=\\sum_{n=0}^{2K-1}z^{-n}=\\sum_{m=0}^{K-1}z^{-2m}+z^{-1}\\sum_{m=0}^{K-1}z^{-2m}=(1+z^{-1})\\sum_{m=0}^{K-1}z^{-2m}.\n$$\n\n现在，对 $W_{R}(z)$ 进行平方以得到 $H(z)$，并与 I 型形式进行匹配。令 $u=z^2$ 并记 $S(u)=\\sum_{m=0}^{K-1}u^{-m}=\\frac{1-u^{-K}}{1-u^{-1}}$。由于 $E_{0}^{(R)}(u)=E_{1}^{(R)}(u)=S(u)$，我们有：\n$$\nH(z)=\\big(E_{0}^{(R)}(u)+z^{-1}E_{1}^{(R)}(u)\\big)^{2}=E_{0}^{(R)}(u)^{2}+2z^{-1}E_{0}^{(R)}(u)E_{1}^{(R)}(u)+z^{-2}E_{1}^{(R)}(u)^{2}.\n$$\n与 $H(z)=E_{0}(u)+z^{-1}E_{1}(u)$ 进行比较，并注意到 $u=z^{2}$，我们可以确定：\n$$\nE_{0}(u)=E_{0}^{(R)}(u)^{2}+u^{-1}E_{1}^{(R)}(u)^{2}=(1+u^{-1})S(u)^{2},\\qquad E_{1}(u)=2E_{0}^{(R)}(u)E_{1}^{(R)}(u)=2S(u)^{2}.\n$$\n最后，将 $u$ 替换为 $z$，以将多相分量表示为 $z$ 和 $K$ 的函数：\n$$\nE_{0}(z)=(1+z^{-1})\\left(\\sum_{m=0}^{K-1}z^{-m}\\right)^{2}=(1+z^{-1})\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2},\n$$\n$$\nE_{1}(z)=2\\left(\\sum_{m=0}^{K-1}z^{-m}\\right)^{2}=2\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2}.\n$$\n这些表达式满足 $H(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2})$，并且当 $M=2K$ 时，它们的长度与偶数和奇数多相分支所需的长度相匹配。", "answer": "$$\\boxed{\\begin{pmatrix}(1+z^{-1})\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2} & 2\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2}\\end{pmatrix}}$$", "id": "1699569"}]}