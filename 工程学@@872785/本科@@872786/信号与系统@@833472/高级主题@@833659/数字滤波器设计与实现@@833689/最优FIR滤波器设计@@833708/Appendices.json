{"hands_on_practices": [{"introduction": "滤波器的频率响应是其最重要的特性之一，尤其是在零频率（直流）处的响应，它决定了滤波器如何处理信号中的恒定分量。这个练习将指导你如何直接从一个已设计好的 FIR 滤波器的冲激响应系数中计算其直流增益。通过这个练习 [@problem_id:1739181]，你将加深对时域表示 ($h[n]$) 和频域响应 ($H(e^{j\\omega})$) 之间基本关系的理解。", "problem": "一位工程师正在为音频处理应用设计一个数字滤波器，以从信号中分离出低频分量。他们实现了一个因果、线性相位、低通的有限脉冲响应（FIR）滤波器。该滤波器是使用一种先进的优化方法专门设计的，以实现所需的频率响应特性。该滤波器的脉冲响应（用 $h[n]$ 表示）仅在离散时间索引 $n=0, 1, \\dots, 6$ 时非零。系数的数值如下：\n\n- $h[0] = 0.0351$\n- $h[1] = -0.1124$\n- $h[2] = 0.2580$\n- $h[3] = 0.6413$\n- $h[4] = 0.2580$\n- $h[5] = -0.1124$\n- $h[6] = 0.0351$\n\n计算该滤波器在处理一个恒定不变的输入信号（也称为直流（DC）信号）时的增益。将您的答案报告为一个无量纲的数值，四舍五入到四位有效数字。", "solution": "对于一个脉冲响应为 $h[n]$ 的因果、线性时不变 FIR 滤波器，其对输入 $x[n]$ 的输出由卷积给出\n$$\ny[n]=\\sum_{k=0}^{6} h[k]\\,x[n-k].\n$$\n对于一个直流（恒定）输入 $x[n]=C$，这变为\n$$\ny[n]=\\sum_{k=0}^{6} h[k]\\,C=C\\sum_{k=0}^{6} h[k].\n$$\n因此，直流增益（输出与输入振幅之比）为\n$$\nG_{\\text{DC}}=\\frac{y[n]}{C}=\\sum_{k=0}^{6} h[k]=H\\!\\left(\\exp(j0)\\right).\n$$\n使用给定的系数，\n$$\n\\sum_{k=0}^{6} h[k]=h[0]+h[1]+h[2]+h[3]+h[4]+h[5]+h[6].\n$$\n将对称项分组：\n$$\n(h[0]+h[6])+(h[1]+h[5])+(h[2]+h[4])+h[3]\n= (0.0351+0.0351)+(-0.1124-0.1124)+(0.2580+0.2580)+0.6413.\n$$\n分步计算：\n$$\n0.0702-0.2248= -0.1546,\\quad -0.1546+0.5160=0.3614,\\quad 0.3614+0.6413=1.0027.\n$$\n因此，直流增益为 $G_{\\text{DC}}=1.0027$。四舍五入到四位有效数字得到 $1.003$。", "answer": "$$\\boxed{1.003}$$", "id": "1739181"}, {"introduction": "在实际进行滤波器设计之前，工程师需要预估其复杂程度，这通常由滤波器的长度或阶数来衡量。本练习将介绍一个在工程实践中广泛应用的经验公式——Kaiser 公式，用于根据过渡带宽和阻带衰减等关键指标估算所需滤波器的长度 [@problem_id:1739231]。这是在滤波器性能和计算成本之间取得平衡的关键一步。", "problem": "一位音频系统工程师的任务是设计一个数字低通滤波器，用于为低音炮分离低频内容。该滤波器必须是一个I型线性相位有限脉冲响应（FIR）滤波器，并使用Parks-McClellan算法进行设计。音频信号的采样率为 $f_{sample} = 48.0$ kHz。滤波器的规格如下：\n- 通带延伸至频率 $f_p = 1.8$ kHz。\n- 阻带起始于频率 $f_a = 2.2$ kHz。\n- 最大通带波纹不超过 $0.5$ dB。\n- 最小阻带衰减必须至少为 $A_s = 60$ dB。\n\n为开始设计过程，该工程师需要估计滤波器脉冲响应所需的长度 $N$。一个常用于此估计的经验公式，称为Kaiser公式，由下式给出：\n\n$$N_{est} = \\frac{A_s - 8}{2.285 \\Delta\\omega}$$\n\n其中，$A_s$ 是以正分贝（dB）表示的最小阻带衰减，而 $\\Delta\\omega$ 是以弧度/采样点为单位的归一化过渡带宽。\n\n计算估计的滤波器长度 $N$。由于该滤波器必须是I型线性相位滤波器，其长度必须是奇数。因此，您必须将计算出的值 $N_{est}$ 向上取整到最接近的奇数，以得到 $N$ 的最终值。", "solution": "该问题要求根据一个低通FIR滤波器的频率规格来估计其长度 $N$。我们已获得必要的参数和一个可供使用的经验公式。\n\n给定的参数如下：\n- 采样频率: $f_{sample} = 48.0 \\text{ kHz} = 48000 \\text{ Hz}$\n- 通带边沿频率: $f_p = 1.8 \\text{ kHz} = 1800 \\text{ Hz}$\n- 阻带边沿频率: $f_a = 2.2 \\text{ kHz} = 2200 \\text{ Hz}$\n- 最小阻带衰减: $A_s = 60 \\text{ dB}$\n\n估计公式为：\n$$N_{est} = \\frac{A_s - 8}{2.285 \\Delta\\omega}$$\n\n我们的第一步是确定归一化过渡带宽 $\\Delta\\omega$。过渡带是通带边沿和阻带边沿之间的频率范围。该带宽度的赫兹值为：\n$$\\Delta f = f_a - f_p = 2200 \\text{ Hz} - 1800 \\text{ Hz} = 400 \\text{ Hz}$$\n\n接下来，我们需要将此过渡带宽从赫兹转换为以弧度/采样点为单位的归一化角频率 $\\Delta\\omega$。频率 $f$ (单位Hz) 与对应的归一化角频率 $\\omega$ 之间的关系由 $\\omega = 2\\pi \\frac{f}{f_{sample}}$ 给出。将此应用于过渡带宽：\n$$\\Delta\\omega = 2\\pi \\frac{\\Delta f}{f_{sample}} = 2\\pi \\frac{400}{48000} = 2\\pi \\frac{1}{120} = \\frac{\\pi}{60} \\text{ radians/sample}$$\n\n现在我们有了Kaiser公式所需的两个值：$A_s = 60$ dB 和 $\\Delta\\omega = \\frac{\\pi}{60}$。我们可以将这些值代入公式中，以求得估计的滤波器长度 $N_{est}$：\n$$N_{est} = \\frac{60 - 8}{2.285 \\times \\left(\\frac{\\pi}{60}\\right)} = \\frac{52}{2.285 \\times \\left(\\frac{\\pi}{60}\\right)}$$\n\n为简化计算，我们可以将分子和分母同乘以60：\n$$N_{est} = \\frac{52 \\times 60}{2.285 \\pi} = \\frac{3120}{2.285 \\pi}$$\n\n现在，我们计算其数值：\n$$N_{est} \\approx \\frac{3120}{2.285 \\times 3.14159265...} \\approx \\frac{3120}{7.17853...} \\approx 434.643$$\n\n问题规定该滤波器必须是I型线性相位滤波器，这要求其长度为奇数。指令要求将估计值 $N_{est}$ 向上取整到最接近的奇数。\n我们计算出的值为 $N_{est} \\approx 434.643$。将此值向上取整得到下一个整数，即435。由于435是一个奇数，这满足了条件。\n\n因此，估计的滤波器长度为 $N = 435$。", "answer": "$$\\boxed{435}$$", "id": "1739231"}, {"introduction": "对于采用 Parks-McClellan 算法等方法设计的最优等波纹滤波器，我们可以使用更具针对性的公式进行阶数估算。本练习将运用一个直接整合了通带和阻带波纹规格 ($\\delta_p$ 和 $\\delta_s$) 的经验公式 [@problem_id:1739207]。通过这个练习，你将学会如何为高性能的等波纹滤波器做出更精确的初步设计估算。", "problem": "一位数字信号处理工程师的任务是为一种新的音频处理设备设计一个最佳等波纹低通有限脉冲响应（FIR）滤波器。该滤波器对于通过衰减高频噪声来隔离特定音频频带至关重要。该滤波器的性能由其频率响应的以下指标定义：\n\n- 归一化通带截止频率：$\\omega_p = 0.38\\pi$ 弧度/样本。\n- 归一化阻带截止频率：$\\omega_s = 0.48\\pi$ 弧度/样本。\n- 最大通带波纹：$\\delta_p = 0.015$。\n- 最大阻带波纹：$\\delta_s = 0.002$。\n\n为了使用 Parks-McClellan 算法开始设计过程，工程师首先需要估计所需的最小滤波器阶数 $N$。一个广泛用于此估计的经验公式如下：\n\n$$N_{est} = \\frac{-20 \\log_{10}(\\sqrt{\\delta_p \\delta_s}) - C_1}{C_2 \\Delta f}$$\n\n在此公式中，$\\Delta f$ 是归一化过渡带宽，单位为周/样本，它与角频率 $\\omega_p$ 和 $\\omega_s$（单位为弧度/样本）通过表达式 $\\Delta f = \\frac{\\omega_s - \\omega_p}{2\\pi}$ 相关联。参数 $C_1 = 13$ 和 $C_2 = 14.6$ 是从大量滤波器设计实验中得出的无量纲经验常数。\n\n计算所需的最小滤波器阶数 $N$。由于滤波器阶数必须是整数，您必须将估计值 $N_{est}$ 向上取整到最接近的整数。", "solution": "我们已知估计公式\n$$N_{est}=\\frac{-20\\log_{10}\\!\\left(\\sqrt{\\delta_{p}\\delta_{s}}\\right)-C_{1}}{C_{2}\\,\\Delta f},$$\n其中 $\\Delta f=\\frac{\\omega_{s}-\\omega_{p}}{2\\pi}$，$C_{1}=13$，$C_{2}=14.6$。\n\n首先计算过渡带宽：\n$$\\Delta f=\\frac{\\omega_{s}-\\omega_{p}}{2\\pi}=\\frac{0.48\\pi-0.38\\pi}{2\\pi}=\\frac{0.10\\pi}{2\\pi}=0.05.$$\n\n接下来，使用 $\\delta_{p}\\delta_{s}=0.015\\times 0.002=3\\times 10^{-5}$ 和恒等式 $\\log_{10}(\\sqrt{x})=\\tfrac{1}{2}\\log_{10}(x)$ 来简化分子：\n$$-20\\log_{10}\\!\\left(\\sqrt{\\delta_{p}\\delta_{s}}\\right)=-20\\cdot \\frac{1}{2}\\log_{10}(\\delta_{p}\\delta_{s})=-10\\log_{10}(3\\times 10^{-5}).$$\n使用 $\\log_{10}(3\\times 10^{-5})=\\log_{10}(3)-5$，上式变为\n$$-10\\log_{10}(3\\times 10^{-5})=50-10\\log_{10}(3).$$\n因此分子是\n$$\\left[50-10\\log_{10}(3)\\right]-C_{1}=\\left[50-10\\log_{10}(3)\\right]-13=37-10\\log_{10}(3).$$\n\n分母是\n$$C_{2}\\Delta f=14.6\\times 0.05=0.73.$$\n\n因此，\n$$N_{est}=\\frac{37-10\\log_{10}(3)}{0.73}.$$\n数值上，$\\log_{10}(3)\\approx 0.4771212547$，得出\n$$N_{est}\\approx \\frac{37-4.771212547}{0.73}=\\frac{32.228787453}{0.73}\\approx 44.149.$$\n\n由于滤波器阶数必须是整数，且我们必须向上取整，所以所需的最小阶数为\n$$N=\\lceil N_{est}\\rceil=45.$$", "answer": "$$\\boxed{45}$$", "id": "1739207"}]}