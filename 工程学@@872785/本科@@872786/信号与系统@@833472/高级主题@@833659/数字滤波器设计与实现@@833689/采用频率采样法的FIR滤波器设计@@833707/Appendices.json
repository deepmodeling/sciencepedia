{"hands_on_practices": [{"introduction": "频率采样方法的基础是离散傅里叶反变换 (IDFT)，它将期望的频域规格转换为时域的滤波器系数。第一个实践直接应用了这一核心原理。通过从一组给定的频率样本计算一个特定的脉冲响应值，你将巩固对这一基本变换过程的理解。[@problem_id:1719137]", "problem": "我们正在使用频率采样技术设计一个长度为 $N=15$ 的线性相位有限冲激响应 (FIR) 滤波器。在该方法中，所需的滤波器频率响应由一组 $N$ 个频率样本 $H(k)$ 指定，其中 $k = 0, 1, \\dots, N-1$。这些样本对应于频率 $\\omega_k = \\frac{2\\pi k}{N}$。\n\n对于此特定设计，选择了一个对称的低通特性，其频率样本定义为：\n$$\nH(k) = \\begin{cases}\n1  \\text{对于 } k \\in \\{0, 1, 2, 13, 14\\} \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n滤波器的冲激响应 $h(n)$ 是通过计算序列 $H(k)$ 的 $N$ 点离散傅里叶逆变换 (IDFT) 得到的。\n\n确定冲激响应系数 $h(7)$ 的值。请以单一的、闭合形式的解析表达式给出你的答案。", "solution": "对于一个 $N$ 点 IDFT，其常规 DFT/IDFT 对为\n$$\nX(k)=\\sum_{n=0}^{N-1} x(n)e^{-j\\frac{2\\pi kn}{N}},\\quad\nx(n)=\\frac{1}{N}\\sum_{k=0}^{N-1} X(k)e^{j\\frac{2\\pi kn}{N}},\n$$\n冲激响应为\n$$\nh(n)=\\frac{1}{N}\\sum_{k=0}^{N-1} H(k)e^{j\\frac{2\\pi kn}{N}}.\n$$\n当 $N=15$ 且对于 $k\\in\\{0,1,2,13,14\\}$ 有 $H(k)=1$，其他情况下 $H(k)=0$ 时，我们得到\n$$\nh(n)=\\frac{1}{15}\\left[1+e^{j\\frac{2\\pi n}{15}}+e^{j\\frac{4\\pi n}{15}}+e^{j\\frac{26\\pi n}{15}}+e^{j\\frac{28\\pi n}{15}}\\right].\n$$\n使用 $13\\equiv -2\\pmod{15}$ 和 $14\\equiv -1\\pmod{15}$ 可得\n$$\nh(n)=\\frac{1}{15}\\left[1+e^{j\\frac{2\\pi n}{15}}+e^{j\\frac{4\\pi n}{15}}+e^{-j\\frac{4\\pi n}{15}}+e^{-j\\frac{2\\pi n}{15}}\\right].\n$$\n应用 $e^{j\\theta}+e^{-j\\theta}=2\\cos\\theta$ 可得\n$$\nh(n)=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{2\\pi n}{15}\\right)+2\\cos\\left(\\frac{4\\pi n}{15}\\right)\\right].\n$$\n对于 $n=7$，\n$$\nh(7)=\\frac{1}{15}\\left[1+2\\cos\\left(\\frac{14\\pi}{15}\\right)+2\\cos\\left(\\frac{28\\pi}{15}\\right)\\right].\n$$\n使用恒等式 $\\cos(\\pi-\\alpha)=-\\cos(\\alpha)$ 和 $\\cos(2\\pi-\\alpha)=\\cos(\\alpha)$ 可得\n$$\n\\cos\\left(\\frac{14\\pi}{15}\\right)=-\\cos\\left(\\frac{\\pi}{15}\\right),\\qquad\n\\cos\\left(\\frac{28\\pi}{15}\\right)=\\cos\\left(\\frac{2\\pi}{15}\\right).\n$$\n因此，\n$$\nh(7)=\\frac{1}{15}\\left[1-2\\cos\\left(\\frac{\\pi}{15}\\right)+2\\cos\\left(\\frac{2\\pi}{15}\\right)\\right].\n$$\n或者，使用 $\\cos(2x)=2\\cos^{2}(x)-1$ 并令 $x=\\frac{\\pi}{15}$，可得等价的闭合形式\n$$\nh(7)=\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right].\n$$\n两个表达式都是 $h(7)$ 的一个有效的单一闭合形式解析表达式。", "answer": "$$\\boxed{\\frac{1}{15}\\left[4\\cos^{2}\\left(\\frac{\\pi}{15}\\right)-2\\cos\\left(\\frac{\\pi}{15}\\right)-1\\right]}$$", "id": "1719137"}, {"introduction": "滤波器设计的一个关键洞见是理解频率响应规格与滤波器零极点分布之间的关系。本练习揭示了频率采样方法的一个重要特性：将频率样本 $H(k)$ 设为零，会直接在 z 平面的单位圆上放置一个零点。这个实践将帮助你形象地理解如何通过策略性地放置零点来消除特定频率，从而实现阻带衰减。[@problem_id:1742274]", "problem": "一位系统工程师正在设计一个长度为 $N=32$ 的数字有限冲激响应 (FIR) 滤波器。该设计基于频率采样法，其中期望的频率响应在 $N$ 个等间隔频率 $\\omega_k = \\frac{2\\pi k}{N}$（$k = 0, 1, \\dots, N-1$）上指定。由此得到的频率样本，记为 $H(k)$，用于确定滤波器的冲激响应 $h[n]$ 及其对应的传递函数 $H(z)$。\n\n为了近似一个理想的低通滤波器，工程师按如下方式设置频率样本：\n$$\nH(k) = \\begin{cases} 1  \\text{for } k \\in \\{0, 1, 2, 30, 31\\} \\\\ 0  \\text{for } k=3, 4, \\dots, 29 \\end{cases}\n$$\n$H(k)$ 的这些特定选择确保了得到的冲激响应 $h[n]$ 是一个实值序列。\n\n根据此设计规范，确定滤波器传递函数 $H(z)$ 的零点中，保证位于 z 平面上单位圆上的零点数量。", "solution": "我们给定一个通过频率采样法设计的长度为 $N=32$ 的 FIR 滤波器。设 $N$ 个等间隔频率为 $\\omega_{k}=\\frac{2\\pi k}{N}$，$k=0,1,\\dots,N-1$，指定的样本为 $H(k)$。冲激响应通过逆离散傅里叶变换 (IDFT) 获得：\n$$\nh[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)e^{j\\frac{2\\pi k}{N}n},\\quad n=0,1,\\dots,N-1.\n$$\n传递函数为\n$$\nH(z)=\\sum_{n=0}^{N-1}h[n]z^{-n},\n$$\n特别地，其在单位圆上的频率响应为\n$$\nH(e^{j\\omega})=\\sum_{n=0}^{N-1}h[n]e^{-j\\omega n}.\n$$\n在采样频率 $\\omega_{m}=\\frac{2\\pi m}{N}$ 处对 $H(e^{j\\omega})$ 求值，并代入 $h[n]$，得到\n$$\nH(e^{j\\frac{2\\pi m}{N}})=\\sum_{n=0}^{N-1}\\left[\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)e^{j\\frac{2\\pi k}{N}n}\\right]e^{-j\\frac{2\\pi m}{N}n}.\n$$\n交换求和顺序可得\n$$\nH(e^{j\\frac{2\\pi m}{N}})=\\frac{1}{N}\\sum_{k=0}^{N-1}H(k)\\sum_{n=0}^{N-1}e^{j\\frac{2\\pi (k-m)}{N}n}.\n$$\n利用复指数的正交性，\n$$\n\\sum_{n=0}^{N-1}e^{j\\frac{2\\pi (k-m)}{N}n}=\\begin{cases}N, k=m\\ (\\text{mod }N),\\\\ 0, k\\neq m,\\end{cases}\n$$\n我们得到精确插值特性\n$$\nH(e^{j\\frac{2\\pi m}{N}})=H(m),\\quad m=0,1,\\dots,N-1.\n$$\n因此，对于每个满足 $H(m)=0$ 的索引 $m$，都有 $H(e^{j\\frac{2\\pi m}{N}})=0$，这意味着 $z=e^{j\\frac{2\\pi m}{N}}$ 是 $H(z)$ 在单位圆上的一个零点。\n\n在给定的规范中，\n$$\nH(k)=1\\ \\text{for}\\ k\\in\\{0,1,2,30,31\\},\\qquad H(k)=0\\ \\text{for}\\ k=3,4,\\dots,29.\n$$\n集合 $\\{3,4,\\dots,29\\}$ 包含 $29-3+1=27$ 个索引。因此，存在 $27$ 个不同的频率 $\\omega_{k}=\\frac{2\\pi k}{N}$ 使得 $H(e^{j\\omega_{k}})=0$，从而保证 $H(z)$ 有 $27$ 个零点位于单位圆上。\n\n这个计数包括了在 $k=\\frac{N}{2}=16$ 处的自共轭奈奎斯特频率（即 $z=-1$）以及所有在 $k$ 和 $N-k$ 处的共轭对，它们各自贡献了不同的单位圆零点。该规范不能保证存在更多的单位圆零点，因此保证的数量是 $27$。", "answer": "$$\\boxed{27}$$", "id": "1742274"}, {"introduction": "虽然频率采样法定义了在特定网格点上的响应，但高级应用常常需要对位于这些点之间的频率进行精确控制。本问题探讨了如何通过在相邻的非零频率样本之间建立特定关系，从而在一个任意频率上构造一个零点（响应为零）。掌握这项技术可以设计出能够定点消除干扰的滤波器，展示了该方法的灵活性。[@problem_id:1719127]", "problem": "一个长度为 $N$ 的有限冲激响应 (FIR) 滤波器将采用频率采样技术进行设计。该方法涉及构建一个滤波器，其频率响应对一组指定的频率样本进行插值。在一个旨在创建陡峭过渡带的特定设计场景中，仅指定了两个频率样本为非零值：$H(k_0)$ 和 $H(k_0+1)$，对于某个整数索引 $k_0$ 且满足 $0 \\le k_0  N-1$。所有其他频率样本 $H(k)$（其中 $k \\notin \\{k_0, k_0+1\\}$）均被设置为零。\n\n滤波器的连续频率响应 $H(e^{j\\omega})$ 是通过使用标准插值公式，由离散傅里叶变换 (DFT) 的 $N$ 个样本 $H(k)$ 重建的：\n$$ H(e^{j\\omega}) = \\frac{1 - e^{-j\\omega N}}{N} \\sum_{k=0}^{N-1} \\frac{H(k)}{1 - e^{j(\\frac{2\\pi k}{N} - \\omega)}} $$\n为了完全抑制一个窄带干扰信号，必须在频率 $\\omega_0 = \\frac{\\pi(2k_0+1)}{N}$ 处精确地设置一个零点（响应中的一个零值）。该频率正好位于频率网格点 $\\omega_{k_0} = \\frac{2\\pi k_0}{N}$ 和 $\\omega_{k_0+1} = \\frac{2\\pi (k_0+1)}{N}$ 的正中间。\n\n为了强制满足条件 $H(e^{j\\omega_0}) = 0$，两个非零样本 $H(k_0)$ 和 $H(k_0+1)$ 之间必须存在一个特定的线性关系。请推导用 $H(k_0)$ 和滤波器长度 $N$ 表示样本 $H(k_0+1)$ 的表达式。", "solution": "我们从给定的插值公式出发，并利用只有 $H(k_{0})$ 和 $H(k_{0}+1)$ 是非零的事实：\n$$\nH(e^{j\\omega})=\\frac{1-e^{-j\\omega N}}{N}\\left(\\frac{H(k_{0})}{1-e^{j\\left(\\frac{2\\pi k_{0}}{N}-\\omega\\right)}}+\\frac{H(k_{0}+1)}{1-e^{j\\left(\\frac{2\\pi (k_{0}+1)}{N}-\\omega\\right)}}\\right).\n$$\n在 $\\omega_{0}=\\frac{\\pi(2k_{0}+1)}{N}$ 处施加一个零点，即 $H(e^{j\\omega_{0}})=0$。由于\n$$\n1-e^{-j\\omega_{0}N}=1-e^{-j\\pi(2k_{0}+1)}=1-(-1)=2\\neq 0,\n$$\n其充要条件是括号内的和为零：\n$$\n\\frac{H(k_{0})}{1-e^{j\\left(\\frac{2\\pi k_{0}}{N}-\\omega_{0}\\right)}}+\\frac{H(k_{0}+1)}{1-e^{j\\left(\\frac{2\\pi (k_{0}+1)}{N}-\\omega_{0}\\right)}}=0.\n$$\n计算频率偏移：\n$$\n\\frac{2\\pi k_{0}}{N}-\\omega_{0}=\\frac{2\\pi k_{0}}{N}-\\frac{\\pi(2k_{0}+1)}{N}=-\\frac{\\pi}{N},\\qquad\n\\frac{2\\pi (k_{0}+1)}{N}-\\omega_{0}=\\frac{2\\pi (k_{0}+1)}{N}-\\frac{\\pi(2k_{0}+1)}{N}=+\\frac{\\pi}{N}.\n$$\n因此条件简化为\n$$\n\\frac{H(k_{0})}{1-e^{-j\\pi/N}}+\\frac{H(k_{0}+1)}{1-e^{j\\pi/N}}=0,\n$$\n这意味着\n$$\nH(k_{0}+1)=-H(k_{0})\\,\\frac{1-e^{j\\pi/N}}{1-e^{-j\\pi/N}}.\n$$\n为了简化该比值，使用以下恒等式\n$$\n1-e^{j\\theta}=-2j\\,e^{j\\theta/2}\\sin\\!\\left(\\frac{\\theta}{2}\\right),\\quad\n1-e^{-j\\theta}=2j\\,e^{-j\\theta/2}\\sin\\!\\left(\\frac{\\theta}{2}\\right),\n$$\n可得\n$$\n\\frac{1-e^{j\\theta}}{1-e^{-j\\theta}}=-e^{j\\theta}.\n$$\n当 $\\theta=\\frac{\\pi}{N}$ 时，我们得到\n$$\nH(k_{0}+1)=H(k_{0})\\,e^{j\\frac{\\pi}{N}}.\n$$\n这就是确保 $H(e^{j\\omega_{0}})=0$ 所需的线性关系。", "answer": "$$\\boxed{H(k_{0}+1)=H(k_{0})\\,e^{j\\frac{\\pi}{N}}}$$", "id": "1719127"}]}