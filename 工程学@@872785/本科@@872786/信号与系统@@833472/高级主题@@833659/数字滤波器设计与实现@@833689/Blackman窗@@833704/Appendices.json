{"hands_on_practices": [{"introduction": "理解任何函数的第一步都是计算其在关键点上的值。这个练习将带你直接应用布莱克曼窗的定义方程，计算它在中心样本点的值。通过这个简单的计算，你将熟悉窗函数的数学形式，并揭示其对称性和峰值的一个基本特性。", "problem": "在数字信号处理中，窗函数用于对信号进行锥化，这有助于在分析有限时长信号的频谱内容时减少频谱泄漏。一种广泛使用的窗函数是 Blackman 窗，它以其出色的旁瓣衰减而闻名。\n\n对称的 N 点 Blackman 窗的公式为：\n$$w[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right)$$\n其中窗函数定义在整数索引 $n$ 从 $0$ 到 $N-1$ 的范围内。\n\n对于长度为 $N = 51$ 的 Blackman 窗，确定其中心采样点处的窗函数值 $w[n]$。将您的答案表示为单个数值。", "solution": "我们已知 Blackman 窗函数为\n$$\nw[n] = 0.42 - 0.5 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + 0.08 \\cos\\left(\\frac{4\\pi n}{N-1}\\right),\n$$\n定义在整数 $n$ 从 $0$ 到 $N-1$ 的范围内。对于奇数长度 $N$，中心采样点的索引由下式给出\n$$\nn_{c} = \\frac{N-1}{2}.\n$$\n当 $N=51$ 时，我们有\n$$\nn_{c} = \\frac{51-1}{2} = 25.\n$$\n在 $n=25$ 和 $N-1=50$ 处计算余弦函数的参数：\n$$\n\\cos\\left(\\frac{2\\pi n_{c}}{N-1}\\right) = \\cos\\left(\\frac{2\\pi \\cdot 25}{50}\\right) = \\cos(\\pi) = -1,\n$$\n$$\n\\cos\\left(\\frac{4\\pi n_{c}}{N-1}\\right) = \\cos\\left(\\frac{4\\pi \\cdot 25}{50}\\right) = \\cos(2\\pi) = 1.\n$$\n代入窗函数公式：\n$$\nw[25] = 0.42 - 0.5(-1) + 0.08(1) = 0.42 + 0.5 + 0.08 = 1.\n$$\n因此，窗函数在中心采样点的值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "1700456"}, {"introduction": "窗函数在频谱分析中的核心作用是平衡主瓣宽度和旁瓣抑制之间的权衡。布莱克曼窗以其出色的旁瓣抑制而著称，但这是以牺牲频率分辨率为代价的。该练习通过比较布莱克曼窗和矩形窗解析两个相近正弦信号所需的最小频率间隔，让你亲手量化这种权衡关系。[@problem_id:1700510]", "problem": "一位数字信号处理工程师正在分析一个信号，已知该信号是两个等幅纯正弦分量的叠加，其频率分别为 $f_1$ 和 $f_2$。为了确定这两个频率，截取一段长度为 $N$ 个采样点的信号，先使用窗函数进行处理，然后进行 $N$ 点离散傅里叶变换（DFT）。采样频率为 $f_s$。\n\n在所得频谱中区分（或“分辨”）这两个频率分量的能力，取决于所选窗函数主瓣的宽度。一个常用的可分辨性准则是 Rayleigh 准则，该准则指出，当一个谱峰的最大值恰好落在另一个谱峰的第一个零点（过零点）上时，这两个谱峰刚好被分辨。\n\nDFT中相邻点之间的频率间隔由 $\\Delta f = f_s / N$ 给出。不同窗函数的第一个零点的位置可以表示为这个基本频率分辨率的倍数。\n- 对于**矩形窗**，第一个零点出现在距离其主瓣中心 $1 \\cdot \\Delta f$ 的频率处。\n- 对于**布莱克曼窗**，第一个零点出现在距离其主瓣中心 $3 \\cdot \\Delta f$ 的频率处。\n\n设 $\\delta f_{\\text{rect}}$ 为使用矩形窗时分辨这两个正弦波所需的最小频率间隔 $|f_1 - f_2|$。类似地，设 $\\delta f_{\\text{black}}$ 为使用布莱克曼窗时所需的最小频率间隔。\n\n计算比率 $\\frac{\\delta f_{\\text{black}}}{\\delta f_{\\text{rect}}}$。", "solution": "DFT的频率间隔由 $\\Delta f = f_{s}/N$ 给出。\n\n根据 Rayleigh 准则，当两个谱峰的频率间隔等于窗函数频谱的主瓣中心到其第一个零点的距离时，它们刚好被分辨。\n\n对于矩形窗，第一个零点出现在距离主瓣中心 $1 \\cdot \\Delta f$ 处，因此最小可分辨间隔为\n$$\n\\delta f_{\\text{rect}} = 1 \\cdot \\Delta f.\n$$\n对于布莱克曼窗，第一个零点出现在距离主瓣中心 $3 \\cdot \\Delta f$ 处，因此\n$$\n\\delta f_{\\text{black}} = 3 \\cdot \\Delta f.\n$$\n所以，该比率为\n$$\n\\frac{\\delta f_{\\text{black}}}{\\delta f_{\\text{rect}}} = \\frac{3 \\cdot \\Delta f}{1 \\cdot \\Delta f} = 3.\n$$", "answer": "$$\\boxed{3}$$", "id": "1700510"}, {"introduction": "窗函数的概念不仅限于一维信号，它在图像处理等多维领域同样至关重要。通过将一维布莱克曼窗扩展为可分离的二维窗，我们可以为二维数据（如图像）设计滤波器。这个练习将挑战你从一维窗的频谱特性出发，推导并理解二维布莱克曼窗在频域中的结构，特别是其主瓣和旁瓣的几何排列方式。[@problem_id:1700451]", "problem": "在数字信号处理中，窗函数用于将信号在其端点处逐渐变细至零，以在计算离散时间傅里叶变换（DTFT）时减少频谱泄漏。一种广泛使用的窗是 Blackman 窗。\n\n考虑一个长度为 $N$ 的一维 Blackman 窗，记为 $w_1[n]$，对于整数 $n$ 在范围 $0 \\le n \\le N-1$ 内，其定义为：\n$$w_1[n] = \\alpha_0 - \\alpha_1 \\cos\\left(\\frac{2\\pi n}{N-1}\\right) + \\alpha_2 \\cos\\left(\\frac{4\\pi n}{N-1}\\right)$$\n该窗函数的标准系数为 $\\alpha_0 = 0.42$，$\\alpha_1 = 0.50$ 和 $\\alpha_2 = 0.08$。\n\n现在，我们通过取两个这样的一维 Blackman 窗的外积来构建一个大小为 $N \\times N$ 的二维可分离窗 $w[n_1, n_2]$：\n$$w[n_1, n_2] = w_1[n_1] w_1[n_2]$$\n该二维窗仅在 $0 \\le n_1 \\le N-1$ 和 $0 \\le n_2 \\le N-1$ 的范围内非零。\n\n该窗的二维 DTFT $W(\\omega_1, \\omega_2)$ 在原点 $(\\omega_1, \\omega_2) = (0,0)$ 处呈现一个主瓣，并在二维频率平面中的其他位置呈现一系列较小的旁瓣。这些旁瓣的结构由窗函数的特性决定。二维 DTFT 可以表示为多个项的和，每个项都以一个特定的频率对为中心。以下哪个陈述最能描述所有这些构成项的中心频率在 $(\\omega_1, \\omega_2)$ 平面中的几何排列？\n\nA. 一个以原点为中心的 $5 \\times 5$ 方形网格位置。\n\nB. 一个以原点为中心的十字形图案，包含5个位置，且仅位于 $\\omega_1$ 和 $\\omega_2$ 轴上。\n\nC. 一个以原点为中心的 $3 \\times 3$ 方形网格位置。\n\nD. 仅在原点处有一个位置，因为旁瓣是连续的，没有明确的中心频率。\n\nE. 一对平行于 $\\omega_1$ 轴且对其对称的位置线。", "solution": "我们从给定长度为 $N$ 的一维 Blackman 窗开始，\n$$\nw_{1}[n] = \\alpha_{0} - \\alpha_{1} \\cos\\!\\left(\\frac{2\\pi n}{N-1}\\right) + \\alpha_{2} \\cos\\!\\left(\\frac{4\\pi n}{N-1}\\right), \\quad 0 \\leq n \\leq N-1,\n$$\n在其他情况下 $w_{1}[n]=0$。引入角增量\n$$\n\\Omega_{0} \\triangleq \\frac{2\\pi}{N-1}.\n$$\n使用恒等式 $\\cos(\\theta n) = \\frac{1}{2}\\left(\\exp(\\mathrm{j}\\theta n) + \\exp(-\\mathrm{j}\\theta n)\\right)$ 将 $w_{1}[n]$ 重写为复指数的和：\n$$\nw_{1}[n] = c_{0} \\exp(\\mathrm{j}\\cdot 0 \\cdot n) + c_{1} \\exp(\\mathrm{j}\\Omega_{0} n) + c_{-1} \\exp(-\\mathrm{j}\\Omega_{0} n) + c_{2} \\exp(\\mathrm{j}2\\Omega_{0} n) + c_{-2} \\exp(-\\mathrm{j}2\\Omega_{0} n),\n$$\n系数为\n$$\nc_{0}=\\alpha_{0},\\quad c_{\\pm 1} = -\\frac{\\alpha_{1}}{2},\\quad c_{\\pm 2} = \\frac{\\alpha_{2}}{2}.\n$$\n定义长度为 $N$ 的矩形支撑函数 $r[n]$，当 $0\\leq n\\leq N-1$ 时 $r[n]=1$，否则 $r[n]=0$，因此 $w_{1}[n]=\\left(\\sum_{k\\in\\{0,\\pm 1,\\pm 2\\}} c_{k}\\exp(\\mathrm{j}k\\Omega_{0} n)\\right) r[n]$。\n\n一维 DTFT 是\n$$\nW_{1}(\\omega) = \\sum_{n=-\\infty}^{\\infty} w_{1}[n] \\exp(-\\mathrm{j}\\omega n) = \\sum_{k\\in\\{0,\\pm 1,\\pm 2\\}} c_{k} \\sum_{n=0}^{N-1} \\exp\\!\\big(-\\mathrm{j}(\\omega - k\\Omega_{0}) n\\big).\n$$\n令\n$$\nR(\\omega) \\triangleq \\sum_{n=0}^{N-1} \\exp(-\\mathrm{j}\\omega n) = \\exp\\!\\left(-\\mathrm{j}\\omega \\frac{N-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{N\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.\n$$\n那么\n$$\nW_{1}(\\omega) = \\sum_{k\\in\\{0,\\pm 1,\\pm 2\\}} c_{k}\\, R(\\omega - k\\Omega_{0}),\n$$\n这是五个项的叠加，这些项分别以 $\\omega = k\\Omega_{0}$ 为中心，其中 $k\\in\\{0,\\pm 1,\\pm 2\\}$。\n\n现在考虑二维可分离窗 $w[n_{1},n_{2}] = w_{1}[n_{1}]\\, w_{1}[n_{2}]$，其在 $0\\leq n_{1},n_{2}\\leq N-1$ 范围内有值，其他情况为零。其二维 DTFT 可以分解为：\n$$\nW(\\omega_{1},\\omega_{2}) = \\sum_{n_{1}=0}^{N-1}\\sum_{n_{2}=0}^{N-1} w_{1}[n_{1}]w_{1}[n_{2}] \\exp\\!\\big(-\\mathrm{j}(\\omega_{1} n_{1}+\\omega_{2} n_{2})\\big) = W_{1}(\\omega_{1})\\, W_{1}(\\omega_{2}).\n$$\n代入 $W_{1}$ 的展开式，\n$$\nW(\\omega_{1},\\omega_{2}) = \\sum_{k_{1}\\in\\{0,\\pm 1,\\pm 2\\}} \\sum_{k_{2}\\in\\{0,\\pm 1,\\pm 2\\}} c_{k_{1}} c_{k_{2}}\\, R(\\omega_{1}-k_{1}\\Omega_{0})\\, R(\\omega_{2}-k_{2}\\Omega_{0}).\n$$\n每个乘积项都以频率对 $(\\omega_{1},\\omega_{2})=(k_{1}\\Omega_{0},k_{2}\\Omega_{0})$ 为中心，其中 $k_{1},k_{2}\\in\\{0,\\pm 1,\\pm 2\\}$。因此，所有构成项的中心位于每个轴上五个一维中心的笛卡尔积上，在 $(\\omega_{1},\\omega_{2})$ 平面中形成一个以原点为中心的 $5\\times 5$ 方形网格位置。\n\n因此，正确的描述是一个以原点为中心的 $5\\times 5$ 方形网格。", "answer": "$$\\boxed{A}$$", "id": "1700451"}]}