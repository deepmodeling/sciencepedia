{"hands_on_practices": [{"introduction": "窗函数法的核心思想始于一个理想的频率响应，但其对应的脉冲响应在时间上是无限的，这在实际中无法实现。本练习将引导你完成最基础的设计步骤：首先，通过傅里叶逆变换计算出理想低通滤波器的无限脉冲响应；然后，应用最简单的窗函数——矩形窗（即直接截断）——来获得一个实际、有限的滤波器系数。这个过程直观地揭示了将理论模型转化为物理可实现设计的核心机制 [@problem_id:1719431]。", "problem": "一个数字信号处理系统正在被设计用于消除高频噪声。该系统使用一个具有7个抽头的线性相位有限脉冲响应 (FIR) 滤波器。因此，其脉冲响应（记为 $h[n]$）是实值、对称且长度有限的。\n\n设计过程始于理想低通滤波器的频率响应 $H_d(e^{j\\omega})$，其在一个周期 $-\\pi \\le \\omega \\le \\pi$ 上的定义如下：\n$$ H_d(e^{j\\omega}) = \\begin{cases} 1 & \\text{for } |\\omega| \\le \\frac{\\pi}{2} \\\\ 0 & \\text{for } \\frac{\\pi}{2}  |\\omega| \\le \\pi \\end{cases} $$\n相应的理想脉冲响应 $h_d[n]$ 通过对 $H_d(e^{j\\omega})$ 进行逆变换得到。\n\n为了创建这个7抽头滤波器，理想脉冲响应 $h_d[n]$ 被截断，使其仅在索引 $n$ 从 $-3$ 到 $3$ 的范围内非零。这样就创建了一个非因果的零相位滤波器，其系数记为 $h_{nc}[n]$。这些系数定义如下：\n$$ h_{nc}[n] = \\begin{cases} h_d[n]  \\text{for } n \\in \\{-3, -2, -1, 0, 1, 2, 3\\} \\\\ 0  \\text{otherwise} \\end{cases} $$\n确定这个非因果滤波器的七个非零系数：$h_{nc}[-3], h_{nc}[-2], \\dots, h_{nc}[3]$。请将您的答案表示为一个包含这七个值的序列，按索引从 $n=-3$ 到 $n=3$ 的递增顺序排列。您的答案必须是包含 $\\pi$ 等常数的精确解析表达式。", "solution": "截止频率为 $\\omega_{c}=\\frac{\\pi}{2}$ 的理想低通滤波器的频率响应为：在 $[-\\pi,\\pi)$ 区间上，当 $|\\omega|\\leq \\frac{\\pi}{2}$ 时 $H_{d}(\\exp(j\\omega))=1$，否则为 $0$。相应的理想脉冲响应由离散时间傅里叶逆变换 (inverse DTFT) 给出：\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}H_{d}(\\exp(j\\omega))\\exp(j\\omega n)\\,d\\omega\n=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\\exp(j\\omega n)\\,d\\omega.\n$$\n当 $n=0$ 时，\n$$\nh_{d}[0]=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}1\\,d\\omega=\\frac{1}{2\\pi}\\left(\\pi\\right)=\\frac{1}{2}.\n$$\n当 $n\\neq 0$ 时，\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\left[\\frac{\\exp(j\\omega n)}{j n}\\right]_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\n=\\frac{1}{2\\pi j n}\\left(\\exp\\!\\left(j\\frac{\\pi n}{2}\\right)-\\exp\\!\\left(-j\\frac{\\pi n}{2}\\right)\\right)\n=\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right).\n$$\n因此，\n$$\nh_{d}[n]=\\begin{cases}\n\\frac{1}{2},  n=0,\\\\\n\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right),  n\\neq 0.\n\\end{cases}\n$$\n通过截断至 $n\\in\\{-3,-2,-1,0,1,2,3\\}$，可以得到7抽头的非因果零相位滤波器，因此对于这些 $n$ 值，有 $h_{nc}[n]=h_{d}[n]$。逐个计算：\n- 对于 $n=-3$：$\\sin\\!\\left(-\\frac{3\\pi}{2}\\right)=1$，因此 $h_{nc}[-3]=\\frac{1}{\\pi(-3)}\\cdot 1=-\\frac{1}{3\\pi}$。\n- 对于 $n=-2$：$\\sin(-\\pi)=0$，因此 $h_{nc}[-2]=0$。\n- 对于 $n=-1$：$\\sin\\!\\left(-\\frac{\\pi}{2}\\right)=-1$，因此 $h_{nc}[-1]=\\frac{1}{-\\pi}\\cdot(-1)=\\frac{1}{\\pi}$。\n- 对于 $n=0$：$h_{nc}[0]=\\frac{1}{2}$。\n- 对于 $n=1$：$\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$，因此 $h_{nc}[1]=\\frac{1}{\\pi}$。\n- 对于 $n=2$：$\\sin(\\pi)=0$，因此 $h_{nc}[2]=0$。\n- 对于 $n=3$：$\\sin\\!\\left(\\frac{3\\pi}{2}\\right)=-1$，因此 $h_{nc}[3]=-\\frac{1}{3\\pi}$。\n\n因此，从 $n=-3$到 $n=3$ 排序，这七个系数是 $-\\frac{1}{3\\pi},\\,0,\\,\\frac{1}{\\pi},\\,\\frac{1}{2},\\,\\frac{1}{\\pi},\\,0,\\,-\\frac{1}{3\\pi}$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{3\\pi}  0  \\frac{1}{\\pi}  \\frac{1}{2}  \\frac{1}{\\pi}  0  -\\frac{1}{3\\pi}\\end{pmatrix}}$$", "id": "1719431"}, {"introduction": "在我们构建了第一个滤波器之后，理解其固有的局限性至关重要。一个常见的问题是：为什么我们精心设计的实际滤波器，其频率响应总是与理想蓝图存在偏差？本练习通过一个概念性问题，深入探讨了“频谱泄漏”这一关键现象，它解释了为何一个本应在直流（DC）频率处增益为零的高通滤波器，实际应用中却表现出微小的非零增益。理解频谱泄漏是掌握窗函数设计中性能权衡的根本 [@problem_id:1719415]。", "problem": "在数字信号处理中，窗函数法是设计有限冲激响应（FIR）滤波器的一种常用技术。该方法始于一个理想的频率响应，其对应的冲激响应通常是无限长且非因果的。为了创建一个实用的、有限长度的滤波器，这个理想的冲激响应会与一个有限长度的窗函数（如矩形窗、汉明窗或布莱克曼窗）相乘。\n\n考虑设计一个离散时间高通滤波器。一个理想的高通滤波器在其阻带（包括直流分量，即频率 $\\omega = 0$）内的增益为零，而在其通带内具有恒定增益（例如，单位增益）。然而，当应用窗函数法来设计一个实用的FIR高通滤波器时，所得滤波器的频率响应在直流处会表现出一个虽小但明显非零的增益。\n\n下列哪个陈述为这种非零直流增益的出现提供了最准确的物理和数学解释？\n\nA. 通过平移其冲激响应来使滤波器因果化的过程，在频域中引入了一个线性相位分量，这从根本上改变了直流处的幅度响应，使其从零变为一个非零值。\n\nB. 通过窗函数对无限理想冲激响应进行截断，等效于将理想频率响应与窗函数的频率响应进行卷积。窗函数频谱的主瓣集中在直流处，不可避免地会“涂抹”或“泄漏”到理想滤波器的阻带中，从而导致在直流处的增益非零。\n\nC. 直流处的非零增益是吉布斯现象的直接结果，吉布斯现象描述了在频带边缘（阻带和通带之间的过渡带）发生的过冲和波纹，并且必然会传播到直流频率。\n\nD. 理想滤波器冲激响应的sinc函数的离散化过程引入了量化误差。这些误差在直流频率处累积，导致了非零增益。\n\nE. 任何实用的窗函数（除了频域中的理想矩形窗）都具有非零带宽。这种固有的带宽迫使最终得到的滤波器在理想滤波器增益为零的频率（包括直流）处也具有非零响应。", "solution": "问题要求解释为什么使用窗函数法设计的高通滤波器具有非零的直流增益，尽管理想的高通滤波器直流增益为零。让我们逐步分析这个过程。\n\n设 $h_{ideal}[n]$ 为理想高通滤波器的冲激响应， $H_{ideal}(e^{j\\omega})$ 为其频率响应。根据定义，理想高通滤波器在直流处的增益为零，所以 $H_{ideal}(e^{j0}) = 0$。与这种急剧截止的滤波器相对应的冲激响应 $h_{ideal}[n]$ 是无限长的（它是一种由余弦调制的sinc函数形式）。\n\n窗函数法通过截断这个理想的冲激响应来创建一个实用的、有限长度的FIR滤波器。这是通过将 $h_{ideal}[n]$ 与一个有限长度的窗函数 $w[n]$ 相乘来实现的。设所得实用滤波器的冲激响应为 $h[n]$。\n\n$$h[n] = h_{ideal}[n] \\cdot w[n]$$\n\n为了理解这个操作对频率响应的影响，我们使用离散时间傅里叶变换（DTFT）的卷积定理。该定理指出，时域中的乘法对应于频域中的周期性卷积。因此，实用滤波器的频率响应 $H(e^{j\\omega})$ 是理想滤波器频率响应 $H_{ideal}(e^{j\\omega})$ 和窗函数频率响应 $W(e^{j\\omega})$ 的卷积。\n\n$$H(e^{j\\omega}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{j(\\omega - \\theta)}) d\\theta$$\n\n我们关心的是实用滤波器的直流增益，即其在 $\\omega = 0$ 处的频率响应值。\n\n$$H(e^{j0}) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} H_{ideal}(e^{j\\theta}) W(e^{-j\\theta}) d\\theta$$\n\n让我们分析这个积分的组成部分：\n1.  $H_{ideal}(e^{j\\theta})$：这是理想的高通频率响应。它在阻带内的频率上为零，即对于 $|\\theta| \\le \\omega_c$（其中 $\\omega_c$ 是截止频率）。因此，$H_{ideal}(e^{j\\theta})$ 在 $\\theta=0$ 附近的一个区域内为零。\n2.  $W(e^{-j\\theta})$：这是窗函数的频率响应。对于任何有限长度的窗函数，$W(e^{j\\omega})$ 都不是一个简单的狄拉克δ函数。它有一个以 $\\omega=0$ 为中心的高能量“主瓣”和一系列延伸至所有频率的衰减“旁瓣”。主瓣的宽度和旁瓣的幅度取决于所使用的具体窗函数。\n\n$H(e^{j0})$ 的积分计算的是这两个函数乘积的面积。虽然 $H_{ideal}(e^{j\\theta})$ 在 $\\theta=0$ 附近为零，但函数 $W(e^{-j\\theta})$ 并非如此。$W(e^{-j\\theta})$ 的主瓣和旁瓣会延伸到 $H_{ideal}(e^{j\\theta})$ 非零的区域（即通带，$|\\theta|  \\omega_c$）。因此，乘积 $H_{ideal}(e^{j\\theta}) W(e^{-j\\theta})$ 将在理想滤波器的通带区域内非零。在区间 $[-\\pi, \\pi]$ 上对这个非零乘积进行积分，通常会得到一个非零的结果。\n\n这个过程通常被称为“频谱泄漏”或“涂抹”。卷积运算实际上是将窗函数的频率响应“涂抹”到理想的频率响应上。窗函数频谱主瓣的能量（集中在直流处）“泄漏”或“扩散”到理想滤波器的阻带中。这种涂抹效应将整个阻带（包括 $\\omega=0$ 处）的增益从理想的零值提升到一个小的非零值。\n\n现在我们来评估给出的选项：\n-   A：使滤波器因果化会引入一个线性相位项，但这不会改变幅度响应 $|H(e^{j\\omega})|$。直流增益是一个幅度属性，所以这是不正确的。\n-   B：这个陈述正确地指出了时域相乘等效于频域卷积。它正确地指出，窗函数的频谱（其主瓣在直流处）与理想滤波器的频谱进行卷积，导致了泄漏或涂抹效应，从而产生了非零的直流增益。这是正确的解释。\n-   C：吉布斯现象指的是在不连续点（频带边缘）附近的高频波纹和过冲/下冲。虽然它也是截断（卷积）的结果，但它特指在不连续点处的行为。非零直流增益是频谱泄漏在整个阻带上的一个更广泛的效应，而不仅仅是频带边缘波纹的一个特征。\n-   D：量化误差与用有限位数表示连续值有关。它与窗函数法本身是两个独立的问题，窗函数法是对理想实数进行的数学运算。这是不正确的。\n-   E：这个陈述部分正确，但不如B选项精确和完整。虽然窗函数的带宽是一个因素，但核心机制是两个频谱的*卷积*。声称窗函数的带宽迫使响应非零，是一种忽略了关键数学运算的过度简化。选项B提供了关于这*如何*发生的更为严谨的解释。\n\n因此，选项B提供了最准确和完整的解释。", "answer": "$$\\boxed{B}$$", "id": "1719415"}, {"introduction": "理解了基本原理及其局限性后，我们便进入更实际的设计场景。不同的窗函数为我们提供了在各种性能指标之间进行权衡的工具，其中Kaiser窗因其灵活性而尤为强大，它允许我们通过一个参数 $\\beta$ 精确控制过渡带宽度和阻带衰减之间的平衡。本练习模拟了一个真实的工程挑战：在固定的滤波器长度限制下，如何利用Kaiser窗的设计公式来确定可实现的最大阻带衰减，并计算出实现该性能所需的特定窗参数 [@problem_id:1719395]。", "problem": "一位工程师的任务是设计一个低通有限脉冲响应（FIR）滤波器，用于预处理来自传感器的噪声信号。该设计必须使用凯撒窗（Kaiser window）方法来实现。由于嵌入式系统上严格的硬件内存限制，滤波器长度固定为 $N=65$。期望的频率响应指标为：通带截止频率 $\\omega_p = 0.3\\pi$ 弧度/样本，阻带截止频率 $\\omega_s = 0.4\\pi$ 弧度/样本。\n\n凯撒窗的经验设计公式如下：\n1.  滤波器长度 $N$、阻带衰减 $A_s$（单位：分贝）以及过渡带宽度 $\\Delta\\omega = \\omega_s - \\omega_p$ 之间的关系由以下近似式给出：\n    $$ (N-1) \\Delta\\omega = \\frac{A_s - 8}{2.285} $$\n2.  凯撒窗参数 $\\beta$ 由阻带衰减 $A_s$ 决定：\n    $$ \\beta = \\begin{cases} 0.1102(A_s - 8.7),  \\text{for } A_s  50 \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21),  \\text{for } 21 \\le A_s \\le 50 \\\\ 0,  \\text{for } A_s  21 \\end{cases} $$\n\n给定固定的滤波器长度和指定的过渡带宽度，确定可以实现的最大阻带衰减 $A_s$。然后，求出实现此设计所需的参数 $\\beta$ 的值。\n\n请以两个数值的形式给出你的答案：衰减 $A_s$（单位：分贝）和参数 $\\beta$。将你的最终答案四舍五入到三位有效数字。", "solution": "我们使用给定的凯撒窗关于滤波器长度、过渡带宽度和阻带衰减的经验关系式：\n$$(N-1)\\Delta\\omega=\\frac{A_{s}-8}{2.285}.$$\n给定 $N=65$ 和 $\\Delta\\omega=\\omega_{s}-\\omega_{p}=0.4\\pi-0.3\\pi=0.1\\pi=\\frac{\\pi}{10}$，我们求解 $A_{s}$：\n$$A_{s}=8+2.285\\,(N-1)\\Delta\\omega=8+2.285\\cdot 64\\cdot \\frac{\\pi}{10}=8+14.624\\,\\pi.$$\n数值上，使用 $\\pi\\approx 3.14159265$ 可得\n$$A_{s}\\approx 8+14.624\\times 3.14159265=53.9426509\\ \\text{dB}.$$\n由于 $A_{s}50$，计算凯撒参数 $\\beta$ 的适用公式为\n$$\\beta=0.1102\\,(A_{s}-8.7).$$\n代入计算出的 $A_{s}$：\n$$\\beta=0.1102\\,(53.9426509-8.7)=0.1102\\times 45.2426509\\approx 4.98574003.$$\n将两者都四舍五入到三位有效数字，得到 $A_{s}\\approx 53.9$ 和 $\\beta\\approx 4.99$。", "answer": "$$\\boxed{\\begin{pmatrix} 53.9  4.99 \\end{pmatrix}}$$", "id": "1719395"}]}