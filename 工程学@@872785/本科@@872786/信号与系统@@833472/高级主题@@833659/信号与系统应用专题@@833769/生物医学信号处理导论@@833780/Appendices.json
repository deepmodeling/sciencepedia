{"hands_on_practices": [{"introduction": "生物医学信号处理的第一步通常是量化和表征我们所测量的信号。通过计算信号的能量，我们可以了解其强度或活动水平，这在分析心电图 (ECG) 等信号时尤其有用。本练习将通过一个简化的ECG心跳模型，带你实践如何计算一个非周期信号段的总能量[@problem_id:1728867]。", "problem": "在生物医学信号处理中，一个心电图（ECG）信号的一个周期的简化模型，记为 $v(t)$，可以使用基本的几何形状来构建。该信号被认为在除了一系列代表P波、QRS波群和T波的不重叠脉冲之外的所有地方都为零。\n\n考虑一个由以下部分建模的心跳周期：\n1.  **P波**：一个矩形脉冲，恒定振幅为 $A_P = 0.2$ 毫伏（mV），持续时间为 $T_P = 100$ 毫秒（ms）。\n2.  **Q波**：一个矩形脉冲，恒定振幅为 $A_Q = -0.1$ mV，持续时间为 $T_Q = 50$ ms。\n3.  **R波**：一个对称三角脉冲，峰值振幅为 $A_R = 1.5$ mV，总基底持续时间为 $T_R = 60$ ms。\n4.  **S波**：一个矩形脉冲，恒定振幅为 $A_S = -0.4$ mV，持续时间为 $T_S = 50$ ms。\n5.  **T波**：一个矩形脉冲，恒定振幅为 $A_T = 0.5$ mV，持续时间为 $T_T = 160$ ms。\n\n在这些脉冲之间的时间间隔内，信号为 0 mV。\n\n计算该信号模型 $v(t)$ 在单个心跳周期内的总能量。请用平方微伏秒（$\\mu\\text{V}^2\\cdot\\text{s}$）作为单位表示您的最终答案。", "solution": "一个连续时间信号 $v(t)$ 的总能量 $E_v$ 定义为其幅值平方在所有时间上的积分：\n$$E_v = \\int_{-\\infty}^{\\infty} |v(t)|^2 dt$$\n问题指出，该信号由五个不重叠的脉冲组成。当一个信号由在不相交的时间区间上非零的分量组成时，总能量是各个分量能量的总和。因此，总能量为：\n$$E_v = E_P + E_Q + E_R + E_S + E_T$$\n其中 $E_P, E_Q, E_S, E_T$ 是矩形脉冲的能量，而 $E_R$ 是三角脉冲的能量。\n\n首先，让我们找出两种脉冲的能量公式。\n对于振幅为 $A$、持续时间为 $T$ 的矩形脉冲，其能量为：\n$$E_{\\text{rect}} = \\int_{0}^{T} A^2 dt = A^2 [t]_0^T = A^2 T$$\n对于峰值振幅为 $A$、基底持续时间为 $T$ 的对称三角脉冲，其信号在其持续时间（比如从 $t=0$ 到 $t=T$）内可以描述为：\n$$v_{\\text{tri}}(t) = \\begin{cases} \\frac{2A}{T}t,  0 \\le t \\le T/2 \\\\ 2A - \\frac{2A}{T}t,  T/2  t \\le T \\end{cases}$$\n能量是该函数平方的积分。由于对称性，我们可以对前半部分进行积分，然后乘以2：\n$$E_{\\text{tri}} = \\int_{0}^{T} |v_{\\text{tri}}(t)|^2 dt = 2 \\int_{0}^{T/2} \\left(\\frac{2A}{T}t\\right)^2 dt$$\n$$E_{\\text{tri}} = 2 \\cdot \\frac{4A^2}{T^2} \\int_{0}^{T/2} t^2 dt = \\frac{8A^2}{T^2} \\left[\\frac{t^3}{3}\\right]_0^{T/2} = \\frac{8A^2}{T^2} \\frac{(T/2)^3}{3} = \\frac{8A^2}{T^2} \\frac{T^3}{24} = \\frac{1}{3} A^2 T$$\n\n接下来，我们必须处理单位。给定的振幅单位是毫伏（mV），持续时间单位是毫秒（ms）。最终答案必须以平方微伏秒（$\\mu\\text{V}^2\\cdot\\text{s}$）为单位。让我们建立转换因子：\n$1 \\text{ mV} = 10^3 \\mu\\text{V}$\n$1 \\text{ ms} = 10^{-3} \\text{ s}$\n能量以 $A^2 T$ 的形式计算。该乘积的初始单位是 $(\\text{mV})^2 \\cdot \\text{ms}$。\n$(\\text{mV})^2 \\cdot \\text{ms} = (10^3 \\mu\\text{V})^2 \\cdot (10^{-3} \\text{s}) = (10^6 \\mu\\text{V}^2) \\cdot (10^{-3} \\text{s}) = 10^3 \\mu\\text{V}^2\\cdot\\text{s}$。\n所以，要将一个值从 $(\\text{mV})^2 \\cdot \\text{ms}$ 转换为 $\\mu\\text{V}^2\\cdot\\text{s}$，我们需要乘以 1000。\n\n现在，我们计算每个脉冲的能量。\n\n1.  **P波（矩形）**：$A_P = 0.2$ mV, $T_P = 100$ ms。\n    $E_P = A_P^2 T_P = (0.2)^2 \\cdot 100 = 0.04 \\cdot 100 = 4.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n2.  **Q波（矩形）**：$A_Q = -0.1$ mV, $T_Q = 50$ ms。\n    $E_Q = A_Q^2 T_Q = (-0.1)^2 \\cdot 50 = 0.01 \\cdot 50 = 0.5 \\text{ mV}^2\\cdot\\text{ms}$\n\n3.  **R波（三角）**：$A_R = 1.5$ mV, $T_R = 60$ ms。\n    $E_R = \\frac{1}{3} A_R^2 T_R = \\frac{1}{3} (1.5)^2 \\cdot 60 = \\frac{1}{3} \\cdot 2.25 \\cdot 60 = 0.75 \\cdot 60 = 45.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n4.  **S波（矩形）**：$A_S = -0.4$ mV, $T_S = 50$ ms。\n    $E_S = A_S^2 T_S = (-0.4)^2 \\cdot 50 = 0.16 \\cdot 50 = 8.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n5.  **T波（矩形）**：$A_T = 0.5$ mV, $T_T = 160$ ms。\n    $E_T = A_T^2 T_T = (0.5)^2 \\cdot 160 = 0.25 \\cdot 160 = 40.0 \\text{ mV}^2\\cdot\\text{ms}$\n\n现在我们将这些单个能量相加，以得到单位为 $\\text{mV}^2\\cdot\\text{ms}$ 的总能量：\n$E_{\\text{total, intermediate}} = E_P + E_Q + E_R + E_S + E_T = 4.0 + 0.5 + 45.0 + 8.0 + 40.0 = 97.5 \\text{ mV}^2\\cdot\\text{ms}$\n\n最后，我们使用我们找到的转换因子，将这个总能量转换为所需的单位 $\\mu\\text{V}^2\\cdot\\text{s}$：\n$E_v = 97.5 \\text{ mV}^2\\cdot\\text{ms} \\times \\frac{1000 \\mu\\text{V}^2\\cdot\\text{s}}{1 \\text{ mV}^2\\cdot\\text{ms}} = 97500 \\mu\\text{V}^2\\cdot\\text{s}$", "answer": "$$\\boxed{97500}$$", "id": "1728867"}, {"introduction": "除了信号的整体能量，其频率成分也携带了重要的生理信息。傅里叶分析是揭示这些信息的关键工具，而分析的第一步就是确定信号的直流 (DC) 分量，即其平均值。本练习将以一个简化的光电容积描记 (PPG) 信号为模型，帮助你理解如何计算周期信号的DC分量，这对于后续的信号放大和处理至关重要[@problem_id:1728907]。", "problem": "在生物医学工程领域，生理信号的分析是基础。一种常见的非侵入性测量是光电容积脉搏波（PPG），它检测组织微血管床中的血容量变化，并常用于脉搏血氧仪中以估计心率和血氧饱和度。\n\n为了进行初步的频率分析，来自静息状态下健康受试者的周期性PPG信号被简化并建模为一串矩形脉冲。这个理想化信号 $v(t)$ 代表了传感器的电压输出。每个周期对应一次心跳。\n\n该模型由以下参数定义：\n- 信号的周期为 $T = 0.850$ s，对应于连续心跳之间的时间。\n- 在每个周期内，信号是一个幅度为 $A = 1.60$ V 的单一矩形脉冲。电压在持续时间 $\\tau = 0.275$ s 内为 $A$，代表心动周期的收缩期，并在周期的其余时间内为零。\n\n为了合理设置后续放大和滤波级的工作点，有必要确定信号的平均值，也称为直流（DC）分量。计算此建模的PPG信号 $v(t)$ 的傅里叶级数的直流系数。\n\n您的答案以伏特为单位，并四舍五入到三位有效数字。", "solution": "周期信号的直流分量（一个周期内的平均值）由一个周期内的时间平均值定义。在三角傅里叶级数的约定中，如果 $v(t) = \\frac{a_{0}}{2} + \\sum_{n=1}^{\\infty}\\left[a_{n}\\cos\\left(\\frac{2\\pi n t}{T}\\right) + b_{n}\\sin\\left(\\frac{2\\pi n t}{T}\\right)\\right]$，则直流分量等于 $\\frac{a_{0}}{2}$，且\n$$\n\\frac{a_{0}}{2} = \\frac{1}{T}\\int_{0}^{T} v(t)\\,dt.\n$$\n对于给定的矩形脉冲串，其周期为 $T$，在持续时间 $\\tau$ 内幅度为 $A$，在每个周期内的其余时间为零，选择一个周期，例如 $t \\in [0,T)$。则\n$$\nv(t) = \\begin{cases}\nA,  0 \\le t  \\tau, \\\\\n0,  \\tau \\le t  T.\n\\end{cases}\n$$\n因此，平均（直流）值为\n$$\nV_{\\text{DC}} = \\frac{1}{T}\\int_{0}^{T} v(t)\\,dt = \\frac{1}{T}\\left(\\int_{0}^{\\tau} A\\,dt + \\int_{\\tau}^{T} 0\\,dt\\right) = \\frac{A\\tau}{T}.\n$$\n代入给定值 $A=1.60$ V，$\\tau=0.275$ s 和 $T=0.850$ s，\n$$\nV_{\\text{DC}} = 1.60 \\cdot \\frac{0.275}{0.850} = 1.60 \\cdot \\frac{275}{850} = 1.60 \\cdot \\frac{11}{34} = \\frac{44}{85} \\text{ V} \\approx 0.5176470588 \\text{ V}.\n$$\n四舍五入到三位有效数字，结果是 $0.518$ V。", "answer": "$$\\boxed{0.518}$$", "id": "1728907"}, {"introduction": "在实际应用中，生物医学信号常常受到来自电力线等环境源的噪声干扰。设计数字滤波器是消除这些特定频率干扰的有效方法。本练习介绍了一个简单的差分方程来实现的滤波器，通过分析其频率响应，你将学会如何确定该滤波器能够完全滤除的噪声频率，从而体验滤波器设计在信号净化中的核心作用[@problem_id:1728869]。", "problem": "一位生物医学工程师正在开发一个简单的实时数字滤波器，用于预处理来自心电图（ECG）监测设备的信号。该滤波器的目的是从原始信号中移除一种特定的、持续存在的周期性伪影。该滤波器通过以下差分方程实现：\n$$y[n] = x[n] - x[n-10]$$\n其中 $x[n]$ 是来自原始心电信号的输入采样序列，而 $y[n]$ 是滤波后信号的输出采样序列。该系统在 $f_s = 600$ Hz 的恒定采样频率下运行。\n\n确定被该滤波器完全衰减的最低非零频率 $f_{\\text{null}}$。请以赫兹（Hz）为单位表示您的答案。", "solution": "我们从给定的线性时不变离散时间系统的差分方程开始：\n$$y[n] = x[n] - x[n-10].$$\n频率响应可以通过在复指数输入上评估系统得到。如果 $x[n] = e^{j\\omega n}$，则 $x[n-10] = e^{j\\omega (n-10)} = e^{-j10\\omega} e^{j\\omega n}$，因此\n$$y[n] = \\left(1 - e^{-j10\\omega}\\right)e^{j\\omega n}.$$\n因此，频率响应为\n$$H(e^{j\\omega}) = 1 - e^{-j10\\omega}.$$\n当以下条件满足时，会发生完全衰减（一个谱零点）：\n$$H(e^{j\\omega}) = 0 \\quad \\Longleftrightarrow \\quad 1 - e^{-j10\\omega} = 0 \\quad \\Longleftrightarrow \\quad e^{-j10\\omega} = 1.$$\n利用复指数的周期性，$e^{j\\theta} = 1$ 当且仅当 $\\theta = 2\\pi k$，其中 $k \\in \\mathbb{Z}$。于是，\n$$-10\\omega = 2\\pi k \\quad \\Longleftrightarrow \\quad \\omega = -\\frac{2\\pi k}{10}, \\quad k \\in \\mathbb{Z}.$$\n对应的以赫兹（Hz）为单位的物理频率，可以通过离散时间弧度频率 $\\omega$ 和连续频率 $f$ 之间的关系得到：\n$$\\omega = 2\\pi \\frac{f}{f_{s}} \\quad \\Longrightarrow \\quad f = \\frac{\\omega}{2\\pi} f_{s}.$$\n将 $\\omega = \\frac{2\\pi k}{10}$ 代入（忽略负号，因为频率为正），得到零点频率\n$$f_{k} = \\frac{\\frac{2\\pi k}{10}}{2\\pi} f_{s} = \\frac{k}{10} f_{s}, \\quad k \\in \\mathbb{Z}.$$\n最低的非零正频率零点对应于 $k=1$，所以\n$$f_{\\text{null}} = \\frac{1}{10} f_{s}.$$\n当 $f_{s} = 600$ Hz 时，我们得到\n$$f_{\\text{null}} = \\frac{600}{10} = 60 \\text{ Hz}.$$", "answer": "$$\\boxed{60}$$", "id": "1728869"}]}