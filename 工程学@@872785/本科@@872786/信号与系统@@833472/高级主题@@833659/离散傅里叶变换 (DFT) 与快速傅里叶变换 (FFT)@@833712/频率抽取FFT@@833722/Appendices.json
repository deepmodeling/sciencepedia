{"hands_on_practices": [{"introduction": "任何复杂算法的核心都是其基本构建模块。对于快速傅里叶变换（FFT）而言，这个模块就是“蝶形”运算。这项练习将引导你聚焦于频率抽取（DIF）FFT算法的第一阶段，通过精确计算此阶段所需的算术运算次数，你将对算法的计算成本建立起一个具体而量化的认识。[@problem_id:1711068]", "problem": "一个专门的数字信号处理器（DSP）正在被设计用于执行快速傅里叶变换（FFT）。该硬件针对基-2，16点按频率抽取（DIF）FFT算法进行了优化。DIF算法首先从输入序列 $x[n]$（$n=0, 1, \\dots, 15$）创建一组蝶形运算。这个初始步骤被称为FFT的“第一级”。在这一级中，通过将序列前半部分（$x[n]$，其中 $n=0, 1, \\dots, 7$）的元素与后半部分（$x[n+8]$）的元素相结合，来计算一组新的值。\n\n您的任务是确定在第一级中执行的基本复数算术运算的总数。一个基本复数算术运算被定义为一次复数加法、一次复数减法或一次复数乘法。计算标准DIF-FFT蝶形结构在这一级所需的所有此类运算。", "solution": "对于一个基-2、长度为 $N$ 的按频率抽取FFT，第一级的蝶形运算将采样点 $x[n]$ 和 $x[n+N/2]$ 配对，其中 $n=0,1,\\dots,\\frac{N}{2}-1$。标准的DIF蝶形运算计算如下\n$$\ny_{0}[n]=x[n]+x[n+N/2], \\quad y_{1}[n]=\\big(x[n]-x[n+N/2]\\big)\\,W_{N}^{n},\n$$\n其中 $W_{N}=\\exp\\big(-\\mathrm{i}\\,2\\pi/N\\big)$。\n\n从这些表达式中，每个蝶形运算：\n- 计算 $y_{0}[n]$ 需要一次复数加法。\n- 计算 $x[n]-x[n+N/2]$ 需要一次复数减法。\n- 乘以 $W_{N}^{n}$ 需要一次复数乘法。\n\n因此，每个蝶形运算恰好需要一次复数加法、一次复数减法和一次复数乘法，每个蝶形运算总共有三次基本复数运算。\n\n在 $N=16$ 的第一级中，蝶形运算的数量为 $\\frac{N}{2}=\\frac{16}{2}=8$。因此，这一级中基本复数算术运算的总数为\n$$\n8 \\times \\big(1\\ \\text{次复数加法} + 1\\ \\text{次复数减法} + 1\\ \\text{次复数乘法}\\big)=8+8+8=24.\n$$", "answer": "$$\\boxed{24}$$", "id": "1711068"}, {"introduction": "理论算法在实际应用中常常需要与各种信号处理技巧相结合。这项练习在第一阶段蝶形运算的基础上，引入了一种常见的技术——零填充。通过分析零填充如何简化蝶形运算，你将探索输入信号的特性与算法执行效率之间的直接联系，这是优化真实世界FFT实现的关键一步。[@problem_id:1711040]", "problem": "考虑一个长度为4的有限离散时间序列 $x[n]$，定义于 $n \\in \\{0, 1, 2, 3\\}$。通过对 $x[n]$ 进行补零，创建一个长度为8的新序列 $y[n]$，使得当 $n \\in \\{0, 1, 2, 3\\}$ 时，$y[n] = x[n]$，当 $n \\in \\{4, 5, 6, 7\\}$ 时，$y[n] = 0$。\n\n这个8点序列 $y[n]$ 是一个标准基2按频率抽取（DIF）快速傅里叶变换（FFT）算法的输入。该算法的第一级计算出两个中间的4点序列，我们将其记为 $g[n]$ 和 $h[n]$，定义于 $n \\in \\{0, 1, 2, 3\\}$。计算如下：\n\n$g[n] = y[n] + y[n+4]$\n$h[n] = (y[n] - y[n+4]) W_8^n$\n\n其中，$W_N^k = \\exp(-j2\\pi k/N)$ 是旋转因子。假设 $x[n]$ 不恒为零。\n\n下列哪个陈述正确地描述了由补零所导致的序列 $g[n]$ 和 $h[n]$ 之间的关系？\n\nA. 对于所有 $n \\in \\{0, 1, 2, 3\\}$，有 $h[n] = g[n]$\n\nB. 对于所有 $n \\in \\{0, 1, 2, 3\\}$，有 $h[n] = g[n]W_8^n$\n\nC. 对于所有 $n \\in \\{0, 1, 2, 3\\}$，有 $h[n] = -g[n]$\n\nD. $g[0] = h[1]$ 且 $g[1] = h[0]$\n\nE. 对于所有 $n \\in \\{0, 1, 2, 3\\}$，有 $h[n] = 0$", "solution": "根据构造，补零序列满足当 $n\\in\\{0,1,2,3\\}$ 时 $y[n]=x[n]$，当 $n\\in\\{4,5,6,7\\}$ 时 $y[n]=0$。在基2 DIF FFT算法的第一级中，对于 $n\\in\\{0,1,2,3\\}$，我们有\n$$\ng[n]=y[n]+y[n+4],\\qquad h[n]=(y[n]-y[n+4])\\,W_{8}^{n}。\n$$\n因为 $n\\in\\{0,1,2,3\\}$ 意味着 $n+4\\in\\{4,5,6,7\\}$，所以补零操作使得 $y[n+4]=0$。因此，\n$$\ng[n]=y[n]+0=y[n]=x[n],\n$$\n和\n$$\nh[n]=(y[n]-0)\\,W_{8}^{n}=y[n]\\,W_{8}^{n}=x[n]\\,W_{8}^{n}。\n$$\n由此直接得出\n$$\nh[n]=g[n]\\,W_{8}^{n}\\quad\\text{对所有 }n\\in\\{0,1,2,3\\}。\n$$\n因此，正确选项是B，而其他选项通常不成立（选项A要求对所有$n$都有$W_{8}^{n}=1$，选项C要求对所有$n$都有$W_{8}^{n}=-1$，选项D与这些定义无关，而选项E要求对所有$n$都有$x[n]=0$，这与题目假设相悖）。", "answer": "$$\\boxed{B}$$", "id": "1711040"}, {"introduction": "最后一项练习提供了一个更具挑战性的“调试”场景，旨在加深你对算法内部数据流的理解。通过分析一个旋转因子（twiddle factor）的微小计算错误如何传播并影响最终输出，你必须追溯DIF-FFT的整个数据路径。这项实践将强化你对偶数索引和奇数索引输出分别计算这一核心机制的认识，揭示算法精巧的内在结构。[@problem_id:1711088]", "problem": "一位工程师正在调试一个8点按频率抽取 (Decimation-In-Frequency, DIF) 的快速傅里叶变换 (Fast Fourier Transform, FFT) 算法，该算法用于计算输入序列 $x[n]$ ($n = 0, 1, \\dots, 7$) 的离散傅里叶变换 (Discrete Fourier Transform, DFT)。DFT 输出表示为 $X[k]$ ($k = 0, 1, \\dots, 7$)。该算法基于标准的DIF-FFT分解，在每个阶段将输入序列分成前后两半。旋转因子定义为 $W_N^k = \\exp(-j\\frac{2\\pi k}{N})$。\n\n经检查发现，算法的第一阶段存在一个计算错误。具体来说，旋转因子 $W_8^2$ 被错误地编程为 $1$，而不是其真实值。这个错误仅发生在计算中的一个位置。假设输入序列 $x[n]$ 是一个普通的复值序列，且满足 $x[2] \\neq x[6]$。由于这一个编程错误，下列哪组输出采样 $X[k]$ 会变得不正确？\n\nA. $X[2], X[6]$\n\nB. $X[0], X[2], X[4], X[6]$\n\nC. $X[2], X[3], X[6], X[7]$\n\nD. $X[1], X[3], X[5], X[7]$\n\nE. 所有输出采样 $X[k]$ ($k=0, 1, \\dots, 7$)", "solution": "令 $N=8$ 并定义 DFT 为\n$$\nX[k]=\\sum_{n=0}^{7}x[n]W_{8}^{nk},\\quad W_{8}^{k}=\\exp\\!\\left(-j\\frac{2\\pi k}{8}\\right).\n$$\n对于 DIF 分解，将 $n$ 分为 $n=m$ 和 $n=m+4$，其中 $m=0,1,2,3$：\n$$\nX[k]=\\sum_{m=0}^{3}\\left(x[m]+W_{8}^{4k}x[m+4]\\right)W_{8}^{mk}.\n$$\n因为 $W_{8}^{4k}=(-1)^{k}$，我们得到\n$$\nX[k]=\\sum_{m=0}^{3}\\left(x[m]+(-1)^{k}x[m+4]\\right)W_{8}^{mk}.\n$$\n对于偶数 $k=2r$，\n$$\nX[2r]=\\sum_{m=0}^{3}\\left(x[m]+x[m+4]\\right)W_{8}^{m\\cdot 2r}\n=\\sum_{m=0}^{3}a[m]\\,W_{4}^{mr},\n$$\n其中 $a[m]=x[m]+x[m+4]$。对于奇数 $k=2r+1$，\n$$\nX[2r+1]=\\sum_{m=0}^{3}\\left(x[m]-x[m+4]\\right)W_{8}^{m(2r+1)}\n=\\sum_{m=0}^{3}\\underbrace{\\left(x[m]-x[m+4]\\right)W_{8}^{m}}_{c[m]}W_{4}^{mr}.\n$$\n因此，第一个 DIF 阶段计算 $a[m]=x[m]+x[m+4]$（无旋转因子）和 $c[m]=(x[m]-x[m+4])W_{8}^{m}$（应用旋转因子），最终输出满足\n$$\nX[2r]=\\text{DFT}_{4}\\{a[m]\\}[r],\\quad X[2r+1]=\\text{DFT}_{4}\\{c[m]\\}[r],\\quad r=0,1,2,3.\n$$\n所述的错误是在第一阶段，旋转因子 $W_{8}^{2}$ 在一个位置被错误地设为 $1$。这仅影响 $c[2]$ 的计算，将正确的\n$$\nc[2]=(x[2]-x[6])W_{8}^{2}\n$$\n替换为不正确的\n$$\nc'[2]=(x[2]-x[6]).\n$$\n所有其他的 $a[m]$ 和 $c[m]$ 保持正确。因此，只有依赖于 $c[m]$ 的奇数索引输出会受到影响。错误的奇数输出为，对于 $r=0,1,2,3$，\n$$\nX'[2r+1]=\\sum_{m=0}^{3}c'[m]W_{4}^{mr}\n= \\sum_{m=0}^{3}c[m]W_{4}^{mr}+\\bigl(c'[2]-c[2]\\bigr)W_{4}^{2r}\n= X[2r+1]+\\bigl(1-W_{8}^{2}\\bigr)(x[2]-x[6])W_{4}^{2r}.\n$$\n对于一个 4 点 DFT，$W_{4}^{2r}=(-1)^{r}$，它永远不为零。根据假设，$W_{8}^{2}\\neq 1$ 且 $x[2]\\neq x[6]$，因此对于每个 $r$，校正项都不为零，所以所有奇数索引输出 $X[1],X[3],X[5],X[7]$ 都被破坏了。偶数索引的输出来源于 $a[m]$，不受影响。\n\n因此，不正确的输出是 $X[1],X[3],X[5],X[7]$，对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1711088"}]}