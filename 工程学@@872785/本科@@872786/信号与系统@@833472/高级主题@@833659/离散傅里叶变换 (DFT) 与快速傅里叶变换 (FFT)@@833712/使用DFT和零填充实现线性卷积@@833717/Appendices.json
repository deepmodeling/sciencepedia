{"hands_on_practices": [{"introduction": "这项练习专注于使用离散傅里叶变换（DFT）进行线性卷积最关键的第一步：确定正确的补零数量。为了确保DFT方法产生的循环卷积与我们期望的线性卷积完全相同，我们必须选择一个足够大的DFT尺寸 $N$ 以防止时域混叠。本练习将帮助你计算所需的最小DFT长度，这是掌握此项技术的基础技能。[@problem_id:1732874]", "problem": "在数字信号处理中，计算两个信号的线性卷积是一项基本操作。执行此操作的一种计算高效的方法是使用离散傅里叶变换（DFT）。该方法包括对输入信号进行DFT，在频域中将它们相乘，然后对乘积进行逆DFT。\n\n然而，DFT的乘积对应的是循环卷积，而非线性卷积。为了使用这种基于DFT的方法正确计算线性卷积，必须在应用DFT之前将两个信号都进行零填充至足够长度，以防止时域混叠。\n\n考虑两个有限长度的离散时间信号：长度为 $L_x = 10$ 的信号 $x[n]$，以及长度为 $L_h = 7$ 的滤波器 $h[n]$。为了确保能够正确计算 $x[n]$ 和 $h[n]$ 的线性卷积而不会产生混叠，必须使用的最小DFT大小 $N$ 是多少？\n\nA. 10\n\nB. 15\n\nC. 16\n\nD. 17\n\nE. 70", "solution": "为了通过DFT计算两个有限长度序列 $x[n]$ 和 $h[n]$ 的线性卷积而无时域混叠，由DFT产生的循环卷积必须等于线性卷积。其充分必要条件是DFT大小 $N$ 满足\n$$\nN \\geq L_{x} + L_{h} - 1,\n$$\n其中 $L_{x}$ 和 $L_{h}$ 分别是 $x[n]$ 和 $h[n]$ 的长度。\n\n给定 $L_{x} = 10$ 和 $L_{h} = 7$，线性卷积的长度为\n$$\nL = L_{x} + L_{h} - 1 = 10 + 7 - 1 = 16.\n$$\n因此，避免混叠的最小DFT大小为\n$$\nN_{\\min} = 16.\n$$\n在所提供的选项中，这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1732874"}, {"introduction": "我们已经了解了避免混叠的条件，现在让我们来探究当这个条件未被满足时会发生什么。这个思想实验故意使用了一个过短的DFT长度，从而导致时域混叠的发生。通过准确找出哪些输出样本被破坏，你将对循环卷积的“环绕”误差如何体现有一个更直观的理解。[@problem_id:1732910]", "problem": "考虑两个有限长度的离散时间序列，$x[n]$ 和 $h[n]$。序列 $x[n]$ 仅在索引 $n \\in \\{0, 1, 2, 3, 4\\}$ 上非零，序列 $h[n]$ 也仅在索引 $n \\in \\{0, 1, 2, 3, 4\\}$ 上非零。\n\n令 $y_{lin}[n]$ 为 $x[n]$ 和 $h[n]$ 的线性卷积。我们希望使用一种涉及离散傅里叶变换 (DFT) 的频域方法来计算这个卷积。具体来说，我们计算这两个序列的8点DFT（在适当补零至长度8之后），将它们相乘，然后计算乘积的8点逆DFT。这个过程产生一个8样本的序列 $y_{circ}[n]$，它是补零后序列的8点循环卷积。\n\n由于所用DFT的长度所限，得到的循环卷积 $y_{circ}[n]$ 中的一些样本将不等于真实线性卷积 $y_{lin}[n]$ 中对应的样本。这种现象被称为时域混叠。\n\n假设 $x[n]$ 和 $h[n]$ 在其定义的支撑集内是任意（即不全为零）的序列，那么下列哪个集合包含了所有使得样本 $y_{circ}[n]$ 被混叠污染的索引 $n$？\n\nA. $\\{0\\}$\n\nB. $\\{7\\}$\n\nC. $\\{0, 7\\}$\n\nD. $\\{0, 1\\}$\n\nE. { } (空集，表示没有样本被污染)\n\nF. $\\{4\\}$", "solution": "令 $x[n]$ 和 $h[n]$ 仅在 $n \\in \\{0,1,2,3,4\\}$ 上非零，因此它们的长度为 $L_{x}=5$ 和 $L_{h}=5$。线性卷积\n$$\ny_{\\text{lin}}[n] = \\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k]\n$$\n其支撑集为 $n \\in \\{0,1,\\ldots,8\\}$，长度为 $L = L_{x} + L_{h} - 1 = 9$。\n\n将两个序列都补零至长度 $N=8$，计算它们的8点DFT，相乘，并应用8点逆DFT。这会得到8点循环卷积\n$$\ny_{\\text{circ}}[n] = \\sum_{k=0}^{7} x_{8}[k]\\,h_{8}[(n-k) \\bmod 8], \\quad n=0,1,\\ldots,7,\n$$\n其中 $x_{8}[n]$ 和 $h_{8}[n]$ 是 $x[n]$ 和 $h[n]$ 的补零版本。\n\n循环卷积和线性卷积之间的基本关系是\n$$\ny_{\\text{circ}}[n] = \\sum_{m=-\\infty}^{\\infty} y_{\\text{lin}}[n + mN], \\quad N=8.\n$$\n由于 $y_{\\text{lin}}[n]$ 仅在 $n \\in \\{0,\\ldots,8\\}$ 上非零，对于每个 $n \\in \\{0,\\ldots,7\\}$，求和式中唯一可能非零的项是：\n- $m=0$ 的项 $y_{\\text{lin}}[n]$，\n- $m=1$ 的项 $y_{\\text{lin}}[n+8]$，它仅在 $n+8 \\leq 8$ 时，即仅当 $n=0$ 时非零，\n- $m=-1$ 的项 $y_{\\text{lin}}[n-8]$，它对于所有的 $n \\in \\{0,\\ldots,7\\}$ 都为零。\n\n因此，\n$$\ny_{\\text{circ}}[n] =\n\\begin{cases}\ny_{\\text{lin}}[0] + y_{\\text{lin}}[8],   n=0,\\\\\ny_{\\text{lin}}[n],   n=1,2,\\ldots,7.\n\\end{cases}\n$$\n因此，循环卷积与线性卷积不同（即被混叠污染）的唯一索引是 $n=0$。等价地，由于 $L - N = 9 - 8 = 1$，当使用 $N  L$ 的 $N$ 点循环卷积时，恰好是前 $L - N$ 个样本（这里只有 $n=0$ 的样本）被污染。\n\n因此，正确的选项是集合 $\\{0\\}$。", "answer": "$$\\boxed{A}$$", "id": "1732910"}, {"introduction": "在识别出混叠样本的基础上，这最后一个练习将挑战你量化这种误差。当DFT的尺寸不足时，循环卷积的结果是线性卷积的移位版本之和。本练习要求你计算出真实线性卷积与混叠后的循环卷积结果之间的精确数值差异，从而巩固你对两者之间潜在数学关系的理解。[@problem_id:1732919]", "problem": "一位信号处理工程师正在设计一个有限冲激响应（FIR）滤波器。该滤波器的冲激响应由有限长度序列 $h[n]$ 给出。该滤波器用于处理一个由序列 $x[n]$ 表示的输入信号。正确的输出，即“真实”的滤波后信号，是通过计算 $x[n]$ 和 $h[n]$ 的线性卷积得到的。\n\n为了高效地执行此卷积，该工程师选择使用离散傅里叶变换（DFT）。这种被称为快速卷积的方法，其过程包括将两个序列的DFT相乘，然后计算乘积的逆DFT。这个过程实际上计算的是序列的圆周卷积。为了使圆周卷积等同于线性卷积，必须通过对原始序列进行补零来恰当地选择DFT的长度，记为 $N$。\n\n然而，由于计算资源的限制，该工程师被迫使用一个比完美重构线性卷积所需的长度更小的DFT长度。这导致了时域混叠，使得计算出的输出与真实输出不同。\n\n输入信号由序列 $x[n] = \\{2, -1, 3, 1, -2\\}$（对于 $n=0, 1, 2, 3, 4$）给出，在其他情况下为零。\n滤波器的冲激响应由序列 $h[n] = \\{1, 2, 0, -1, 3\\}$（对于 $n=0, 1, 2, 3, 4$）给出，在其他情况下为零。\n该工程师使用长度为 $N=5$ 的DFT。\n\n对于给定的样本索引 $n$，混叠误差定义为该索引处真实线性卷积的值减去同一索引处计算出的圆周卷积的值。请计算输出的第一个样本（对应于索引 $n=0$）的混叠误差的数值。", "solution": "线性卷积定义为 $y_{\\text{lin}}[n] = \\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k]$。由于当 $n \\notin \\{0,1,2,3,4\\}$ 时，$x[n]=0$ 和 $h[n]=0$，因此只有索引在 $\\{0,1,2,3,4\\}$ 中的项才有贡献。\n\n对于 $n=0$，只有 $k=0$ 有贡献，所以\n$$\ny_{\\text{lin}}[0] = x[0]\\,h[0] = 2 \\cdot 1 = 2.\n$$\n\n使用 $N=5$ 点的DFT会得到一个 $5$ 点的圆周卷积。所得到的圆周卷积满足时域混叠关系\n$$\ny_{\\text{circ}}[n] = \\sum_{m \\in \\mathbb{Z}} y_{\\text{lin}}[n + mN],\n$$\n求和仅对 $y_{\\text{lin}}[\\cdot]$ 有定义的索引进行。在这里，线性卷积的支撑集为 $n \\in \\{0,1,\\dots,8\\}$，所以对于 $n=0$，有\n$$\ny_{\\text{circ}}[0] = y_{\\text{lin}}[0] + y_{\\text{lin}}[5].\n$$\n\n显式计算 $y_{\\text{lin}}[5]$：\n$$\ny_{\\text{lin}}[5] = \\sum_{k=0}^{4} x[k]\\,h[5-k],\n$$\n其中只有满足 $5-k \\in \\{0,1,2,3,4\\}$ 的项有贡献，即 $k \\in \\{1,2,3,4\\}$。因此，\n$$\n\\begin{aligned}\ny_{\\text{lin}}[5] = x[1]\\,h[4] + x[2]\\,h[3] + x[3]\\,h[2] + x[4]\\,h[1] \\\\\n= (-1)\\cdot 3 + 3 \\cdot (-1) + 1 \\cdot 0 + (-2) \\cdot 2 \\\\\n= -3 - 3 + 0 - 4 \\\\\n= -10.\n\\end{aligned}\n$$\n因此\n$$\ny_{\\text{circ}}[0] = y_{\\text{lin}}[0] + y_{\\text{lin}}[5] = 2 + (-10) = -8.\n$$\n\n在索引 $n=0$ 处的混叠误差定义为\n$$\ne[0] = y_{\\text{lin}}[0] - y_{\\text{circ}}[0] = 2 - (-8) = 10.\n$$", "answer": "$$\\boxed{10}$$", "id": "1732919"}]}