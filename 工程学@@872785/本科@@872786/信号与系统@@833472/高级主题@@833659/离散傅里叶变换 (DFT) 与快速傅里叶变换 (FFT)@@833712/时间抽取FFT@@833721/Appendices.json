{"hands_on_practices": [{"introduction": "让我们通过一个具体的计算来开始我们的实践之旅。时间抽取（DIT）FFT算法的第一步至关重要，它包括对比特反转后的序列执行第一级蝶形运算。这个练习将引导你完成对一个4点序列的初始计算，帮助你牢固掌握DIT-FFT流程的基础。", "problem": "一个标准的基2时间抽取 (DIT) 快速傅里叶变换 (FFT) 算法被用于分析一个4点离散时间信号。该算法首先根据时间索引的位倒序对输入序列 $x[n]$ 进行重排。重排之后，第一个计算阶段通过对位倒序序列的相邻对执行2点离散傅里叶变换 (DFT)，产生一个中间序列 $G[n]$。\n\n考虑一个输入序列定义为 $x[n] = (1+j)^{n}$，其中 $n=0, 1, 2, 3$，且 $j$ 是满足 $j^2=-1$ 的虚数单位。\n\n计算4点DIT-FFT算法第一阶段产生的中間序列 $G[n] = \\{G[0], G[1], G[2], G[3]\\}$ 的四个复数值。将你的答案表示为这四个复数组成的序列。", "solution": "我们给定一个4点基2时间抽取FFT。在此方法中，算法首先通过位倒序时间索引来重排输入 $x[n]$，然后对相邻对执行2点DFT，以产生中间序列 $G[n]$。\n\n首先计算输入样本：\n对于 $x[n]=(1+j)^{n}$ 且 $j^{2}=-1$：\n$$\nx[0]=(1+j)^{0}=1,\\quad\nx[1]=(1+j)^{1}=1+j,\n$$\n$$\nx[2]=(1+j)^{2}=1+2j+j^{2}=2j,\\quad\nx[3]=(1+j)^{3}=(1+j)\\cdot(1+j)^{2}=(1+j)\\cdot 2j=2j+2j^{2}=-2+2j.\n$$\n\n接下来对索引 $n\\in\\{0,1,2,3\\}$ 应用位倒序。使用2位倒序：\n$$\n0\\,(00)\\to 0\\,(00),\\quad 1\\,(01)\\to 2\\,(10),\\quad 2\\,(10)\\to 1\\,(01),\\quad 3\\,(11)\\to 3\\,(11).\n$$\n因此，位倒序后的序列是\n$$\n[x[0],\\,x[2],\\,x[1],\\,x[3]]=[1,\\,2j,\\,1+j,\\,-2+2j].\n$$\n\n第一阶段对相邻对执行2点DFT。对于一对 $(a,b)$，其2点DFT产生\n$$\nA[0]=a+b,\\qquad A[1]=a-b.\n$$\n将此应用于两个相邻对：\n\n第1对：$(a,b)=(1,\\,2j)$\n$$\nG[0]=1+2j,\\qquad G[1]=1-2j.\n$$\n\n第2对：$(a,b)=(1+j,\\,-2+2j)$\n$$\nG[2]=(1+j)+(-2+2j)=-1+3j,\\qquad G[3]=(1+j)-(-2+2j)=3-j.\n$$\n\n因此，中间序列是\n$$\nG[n]=\\{\\,1+2j,\\;1-2j,\\;-1+3j,\\;3-j\\,\\}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1+2j  1-2j  -1+3j  3-j\\end{pmatrix}}$$", "id": "1711383"}, {"introduction": "FFT的效率根植于其巧妙的数据重排方式。在进行任何蝶形运算之前，输入序列会根据其索引的比特反转形式进行重新排序。这个练习将深入探究这一核心机制，要求你确定在第一级蝶形运算中與特定輸入樣本配對的另一個樣本 [@problem_id:1711351]。通过解决这个问题，你将能更好地理解算法的内部数据流和索引逻辑。", "problem": "在实现一个基-2 时域抽取（DIT）快速傅里叶变换（FFT）算法时，输入序列 $x[n]$ 在蝶形运算开始之前，首先会根据位反转置换进行重排。重排后的序列，我们称之为 $x'[m]$，是通过将输入样本 $x[n]$ 移动到新索引 $m$ 处形成的，其中 $m$ 是原始索引 $n$ 的位反转值。\n\n在此置换之后，算法会进行 $\\log_{2}(N)$ 级的蝶形运算。第一级包含 $N/2$ 个两点蝶形运算。对于 $j = 0, 1, ..., N/2 - 1$，每个蝶形运算取重排序列中的一对相邻元素 $x'[2j]$ 和 $x'[2j+1]$ 作为其输入。\n\n考虑一个长度为 $N = 32$ 的输入序列 $x[n]$。样本 $x[5]$ 是计算第一级中某个特定蝶形运算的两个输入之一。你的任务是确定与 $x[5]$ 在此第一级蝶形运算中配对的另一个输入样本 $x[k]$ 的索引 $k$。", "solution": "对于输入进行位反转的基-2 DIT FFT，置换定义为 $x'[m]=x[n]$，其中 $m=B(n)$，$B(\\cdot)$ 表示对 $L=\\log_{2}(N)$ 位的位反转操作。对于 $N=32$，我们有 $L=5$。在第一级中，蝶形运算作用于重排序列中的相邻项，即对 $\\big(x'[2j],x'[2j+1]\\big)$。因此，如果 $x'[m]$ 在一个蝶形运算中，其在重排数组中的配对索引是 $m\\oplus 1$（与 $1$ 进行异或运算会翻转最低有效位）。\n\n已知 $x[5]$ 参与第一级蝶形运算，令 $m=B(5)$。将 $5$ 写成 5 位二进制：$5=(00101)_{2}$。反转这些位得到 $B(5)=(10100)_{2}=20$，因此 $m=20$。其在重排序列中的配对索引是\n$$\nm'=m\\oplus 1=20\\oplus 1=21.\n$$\n配对的样本源自索引 $k$，使得 $B(k)=m'$，即 $k=B(m')$，因为位反转是一个对合运算，$B(B(n))=n$。计算 $B(21)$：$21=(10101)_{2}$，其反转后仍是 $(10101)_{2}$，所以\n$$\nk=B(21)=21.\n$$\n因此，在第一级蝶形运算中，$x[5]$ 与 $x[21]$ 配对。", "answer": "$$\\boxed{21}$$", "id": "1711351"}, {"introduction": "我们已经分别练习了初始计算和索引配对。现在，让我们将这些部分整合起来，观察信号如何在整个FFT网络中传播。本练习将使用单位冲激信号作为输入，这是一个理想的测试信号，因为它能清晰地揭示算法的内在结构 [@problem_id:1711379]。通过追踪这个简单的信号如何逐级通过蝶形运算网络，你将能直观地理解整个DIT-FFT的计算流程，并验证其基本属性。", "problem": "考虑使用标准的时间抽取 (DIT) 快速傅里叶变换 (FFT) 算法计算一个8点离散傅里叶变换 (DFT)。该算法的输入信号是离散时间单位冲激序列，定义为 $x[n] = \\delta[n]$，对于 $n \\in \\{0, 1, \\dots, 7\\}$。\n\n对于一个 $N$ 点变换，DIT-FFT 算法分 $\\log_2(N)$ 级进行。对于这个8点变换，有3个级。该过程首先将输入序列 $x[n]$ 的顺序进行比特反转，以产生第一级的初始序列。第 $m$ 级的输出作为第 $m+1$ 级的输入。\n\n设进入最后一级（第3级）的复数值向量表示为 $X_{2}[k]$，其中 $k \\in \\{0, 1, \\dots, 7\\}$。确定 $X_{2}[k]$ 的正确序列。\n\n旋转因子定义为 $W_N^k = \\exp(-j\\frac{2\\pi k}{N})$。基本的DIT蝶形运算接收两个输入 $A$ 和 $B$，并根据以下关系产生两个输出 $A'$ 和 $B'$：\n$$A' = A + W_N^k B$$\n$$B' = A - W_N^k B$$\n\n以下哪项代表序列 $X_2[k]$？\n\nA. $\\{1, 1, 1, 1, 0, 0, 0, 0\\}$\n\nB. $\\{1, 1, 0, 0, 0, 0, 0, 0\\}$\n\nC. $\\{1, 1, 1, 1, 1, 1, 1, 1\\}$\n\nD. $\\{1, 0, 0, 0, 0, 0, 0, 0\\}$\n\nE. $\\{1, 0, 1, 0, 1, 0, 1, 0\\}$", "solution": "我们正在计算一个8点DIT-FFT，输入为 $x[n]=\\delta[n]$，$n\\in\\{0,1,\\dots,7\\}$，其中 $x[0]=1$ 且对于 $n\\neq 0$，$x[n]=0$。在输出为自然顺序的DIT-FFT中，算法首先对输入序列进行比特反转。令 $\\mathrm{rev}(m)$ 表示索引 $m$ 的3位比特反转。第1级的输入是比特反转后的序列 $v[m]=x[\\mathrm{rev}(m)]$。由于对于所有 $n\\neq 0$，$x[n]$ 都为零，且 $\\mathrm{rev}(0)=0$，因此可得\n$$\nv[0]=x[\\mathrm{rev}(0)]=x[0]=1,\\quad v[m]=x[\\mathrm{rev}(m)]=0\\ \\text{for}\\ m\\neq 0,\n$$\n所以进入第1级的序列是 $[1,0,0,0,0,0,0,0]$。\n\n在每个蝶形运算中，输入为 $A$ 和 $B$，输出为\n$$\nA' = A + W_{8}^{k} B,\\quad B' = A - W_{8}^{k} B,\n$$\n其中 $W_{8}^{k}=\\exp\\!\\left(-j\\frac{2\\pi k}{8}\\right)$。因为在这个问题中，每当 $A=1$ 与 $B$ 配对时，$B$ 都为0，所以旋转因子不影响非零计算。\n\n第1级（长度为2的蝶形）：配对为 $(0,1)$、$(2,3)$、$(4,5)$、$(6,7)$。唯一的非零配对是 $(0,1)$，其 $(A,B)=(1,0)$，产生 $(A',B')=(1,1)$。所有其他配对都产生 $(0,0)$。因此，第1级的输出是\n$$\n[1,1,0,0,0,0,0,0].\n$$\n\n第2级（长度为4的蝶形）：第一组的配对是 $(0,2)$ 和 $(1,3)$，第二组的配对是 $(4,6)$ 和 $(5,7)$。使用第1级的输出，非零配对是 $(0,2)$（其 $(A,B)=(1,0)$）和 $(1,3)$（其 $(A,B)=(1,0)$），每个都产生 $(1,1)$。第二组仍然是零。因此，第2级的输出，也就是最后一级的输入，是\n$$\nX_{2}[k]=[1,1,1,1,0,0,0,0].\n$$\n\n这与选项A相符。（作为一致性检查，第3级接着会组合这些值，得到最终的DFT结果 $X[k]=1$（对所有 $k$），这与单位冲激的DFT预期结果一致。）", "answer": "$$\\boxed{A}$$", "id": "1711379"}]}