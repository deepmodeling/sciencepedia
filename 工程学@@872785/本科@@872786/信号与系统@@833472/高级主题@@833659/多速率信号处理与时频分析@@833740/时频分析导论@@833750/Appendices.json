{"hands_on_practices": [{"introduction": "时频分析的核心在于其基本权衡：时间分辨率和频率分辨率之间的内在矛盾。要精确地解析两个频率相近的音调，我们需要一个较长的观测窗口，但这会牺牲我们定位这些频率事件发生时间的精确性。这项练习将这个抽象的“不确定性原理”置于一个具体的工程场景中，通过计算解决实际问题所需的最小窗口长度，从而巩固您对这一基本概念的理解。[@problem_id:1730830]", "problem": "一位工程师负责分析来自精密加工旋转组件的振动信号，以诊断潜在的不平衡。该信号的采样率为 $F_s = 10.0 \\text{ kHz}$。初步分析表明存在两个主导正弦分量，其频率分别为 $f_1 = 2000.0 \\text{ Hz}$ 和 $f_2 = 1999.3 \\text{ Hz}$。\n\n为研究这些分量的时变特性，该工程师采用短时傅里叶变换 (STFT)。分析中使用汉宁窗。对此类窗而言，分辨两个振幅相近的正弦波的一个通用判据是：它们的频率间隔必须至少为对加窗信号段进行离散傅里叶变换 (DFT) 所得频率分辨率（或称“频率箱间隔”）的两倍。频率箱间隔定义为 $\\frac{F_s}{N}$，其中 $N$ 为窗内样本数。\n\n请根据上述判据，确定该工程师要成功分辨这两个频率分量所需使用的汉宁窗的最小持续时间（以毫秒为单位）。答案需表示为毫秒，并四舍五入至三位有效数字。", "solution": "给定采样率 $F_{s}$ 和两个频率分别为 $f_{1}$ 和 $f_{2}$ 的正弦分量。设频率间隔为 $\\Delta f_{s} = |f_{1} - f_{2}|$。对于使用汉宁窗的STFT，所述的针对两个振幅相近的正弦波的分辨力判据是：当它们的频率间隔至少是DFT频率箱间隔的两倍时，它们才能被分辨。对于一个包含 $N$ 个样本的窗，其DFT频率箱间隔为 $\\Delta f_{\\text{bin}} = \\frac{F_{s}}{N}$。因此，分辨条件为\n$$\n\\Delta f_{s} \\geq 2 \\Delta f_{\\text{bin}} = \\frac{2 F_{s}}{N}.\n$$\n对该不等式求解 $N$ 可得\n$$\nN \\geq \\frac{2 F_{s}}{\\Delta f_{s}}.\n$$\n窗的持续时间（以秒为单位）为 $T_{w} = \\frac{N}{F_{s}}$，因此满足该判据的最小持续时间为\n$$\nT_{w,\\min} = \\frac{1}{F_{s}} \\cdot \\frac{2 F_{s}}{\\Delta f_{s}} = \\frac{2}{\\Delta f_{s}}.\n$$\n现在根据给定值计算频率间隔：\n$$\n\\Delta f_{s} = |2000.0 - 1999.3| \\text{ Hz} = 0.7 \\text{ Hz}.\n$$\n因此，\n$$\nT_{w,\\min} = \\frac{2}{0.7} \\text{ s} = \\frac{20}{7} \\text{ s}.\n$$\n将其转换为毫秒，\n$$\nT_{w,\\min} = \\frac{20}{7} \\times 10^{3} \\text{ ms} \\approx 2.857142857 \\times 10^{3} \\text{ ms}.\n$$\n四舍五入到三位有效数字，\n$$\nT_{w,\\min} \\approx 2.86 \\times 10^{3} \\text{ ms}.\n$$", "answer": "$$\\boxed{2.86 \\times 10^{3}}$$", "id": "1730830"}, {"introduction": "在为所需的频率分辨率选择了合适的窗口长度后，我们必须决定如何让这个窗口在信号上移动。窗口移动的步长，即“跳数” (hop size)，决定了我们对信号时间演变的采样密度，从而直接影响短时傅里叶变换 (STFT) 的时间分辨率。本练习将探讨跳数、语谱图中的时间帧数量以及最终的时间分辨率之间的直接关系，揭示分析细节与计算成本之间的权衡。[@problem_id:1730841]", "problem": "一位信号处理研究员正在分析一个总长度为 `L` 个采样点的离散时间信号，该信号以采样频率 `f_s` 录制。分析采用短时傅里叶变换 (STFT) 进行，该方法包括使用长度为 `N` 个采样点的分析窗将信号分解为更小的片段，然后计算每个片段的傅里叶变换。对于每个后续片段，这些分析窗的位置会前进一个大小为 `R` 个采样点的跳跃步长。\n\n在语谱图中生成的总时间帧数 `M` 由以下公式给出：$M = \\text{floor}\\left(\\frac{L-N}{R}\\right) + 1$，其中 `\\text{floor}(x)` 是小于或等于 `x` 的最大整数。\n\n研究员使用跳跃步长 `R_A` 进行了初步分析（设置 A），在语谱图中总共产生了 `M_A` 个时间帧。该语谱图的时间分辨率定义为连续分析窗中心之间的时间间隔，为 `\\Delta t_A`。\n\n在第二次分析（设置 B）中，研究员旨在将时间分辨率提高 `k` 倍，其中 `k  1`。也就是说，新的时间分辨率 `\\Delta t_B` 应等于 `\\Delta t_A / k`。为实现这一目标，她将跳跃步长调整为一个新值 `R_B`，同时保持所有其他参数（`L`、`N`、`f_s`）不变。这个新设置产生了 `M_B` 个时间帧。\n\n为便于本问题计算，假设量 `(L-N)` 是 `R_A` 和 `R_B` 的整数倍，这样就无需使用 `\\text{floor}` 函数，从而简化了计算。\n\n推导帧数比值 `M_B / M_A` 的表达式。你的答案应仅用初始帧数 `M_A` 和时间分辨率改善因子 `k` 来表示。", "solution": "根据 STFT 帧前进的定义，时间分辨率（相邻窗中心之间的时间）等于以秒为单位的跳跃步长：\n$$\n\\Delta t = \\frac{R}{f_{s}}.\n$$\n对于设置 A，这给出\n$$\n\\Delta t_{A} = \\frac{R_{A}}{f_{s}}.\n$$\n为了将时间分辨率提高 $k1$ 倍，设置 B 必须满足\n$$\n\\Delta t_{B} = \\frac{\\Delta t_{A}}{k} \\;\\;\\Rightarrow\\;\\; \\frac{R_{B}}{f_{s}} = \\frac{1}{k}\\frac{R_{A}}{f_{s}} \\;\\;\\Rightarrow\\;\\; R_{B} = \\frac{R_{A}}{k}.\n$$\n在假设 $(L-N)$ 是 $R_{A}$ 和 $R_{B}$ 的整数倍的情况下，帧数为\n$$\nM = \\frac{L - N}{R} + 1.\n$$\n因此，\n$$\nM_{A} = \\frac{L - N}{R_{A}} + 1,\n\\qquad\nM_{B} = \\frac{L - N}{R_{B}} + 1 = \\frac{L - N}{R_{A}/k} + 1 = k\\frac{L - N}{R_{A}} + 1.\n$$\n使用 $\\frac{L - N}{R_{A}} = M_{A} - 1$，我们得到\n$$\nM_{B} = k(M_{A} - 1) + 1.\n$$\n因此，所求的比值为\n$$\n\\frac{M_{B}}{M_{A}} = \\frac{k(M_{A} - 1) + 1}{M_{A}} = k - \\frac{k - 1}{M_{A}}.\n$$\n此表达式仅依赖于 $M_{A}$ 和 $k$，符合要求。", "answer": "$$\\boxed{\\frac{k\\left(M_{A}-1\\right)+1}{M_{A}}}$$", "id": "1730841"}, {"introduction": "我们已经了解了窗口长度如何影响频率分辨率，以及跳数如何影响时间分辨率。最后一个关键参数是离散傅里叶变换 (DFT) 的点数。这项练习旨在区分由窗口决定的“真实”频率分辨率和由 DFT 大小决定的频率采样密度。通过分析补零操作（即使用比窗口长度更多的 DFT 点数）的效果，您将学会正确解读语谱图，并避免将视觉上更平滑的频谱误认为具有更高频率分辨率的常见错误。[@problem_id:1730843]", "problem": "一位工程师正在分析一个离散时间信号 $x[n]$，以识别其随时间变化的频率成分。为此，他们使用短时傅里叶变换（STFT）计算谱图。该过程包括以下步骤：\n\n1.  将信号 $x[n]$ 分割成重叠的块。\n2.  每个块乘以一个长度为 $L=256$ 个采样点的窗函数 $w[n]$。\n3.  对每个加窗后的段计算离散傅里叶变换（DFT）。\n4.  将DFT结果的幅度平方绘制成强度图（即谱图）。\n\n最初，工程师选择DFT大小 $N$ 等于窗长，即 $N=L=256$。我们将得到的谱图称为*谱图A*。\n\n在观察结果后，工程师决定修改分析方法。他们保持窗长 $L=256$ 不变，但将DFT大小更改为 $N=1024$。这是通过对每个256个采样点的加窗段进行处理，在计算1024点DFT之前，向其末尾附加 $1024 - 256 = 768$ 个零来实现的。这个新过程产生的结果称为*谱图B*。\n\n以下哪个陈述最准确地描述了在比较谱图B和谱图A时观察到的主要定性差异？\n\nA. 谱图B将具有显著更高的时间分辨率。\n\nB. 谱图B将具有显著更高的真实频率分辨率，使工程师能够区分频率上更接近的正弦波。\n\nC. 谱图B将表现出从强频率分量到相邻频率仓的更大频谱泄漏。\n\nD. 谱图B中的频率内容将显得经过插值且更平滑，从而更容易精确估计频谱峰值的频率。\n\nE. 谱图B的信噪比将低于谱图A。", "solution": "我们分析在保持窗函数 $w[n]$ 及其长度 $L$ 固定的情况下，仅将DFT大小从 $N=L$ 更改为 $N L$（通过补零）如何影响STFT谱图。\n\n将在时间索引 $m$ 处的加窗段定义为 $y_{m}[n]=x[n]w[n-m]$，其有效非零支撑长度为 $L$。$y_{m}[n]$ 的连续频率DTFT（离散时间傅里叶变换）为\n$$\nY_{m}(\\omega)=\\sum_{n=0}^{L-1}y_{m}[n]\\exp(-\\mathrm{j}\\omega n).\n$$\n$N$点DFT在网格 $\\omega_{k}=2\\pi k/N$ 上对 $Y_{m}(\\omega)$ 进行采样：\n$$\nX_{m}[k]=\\sum_{n=0}^{N-1}\\tilde{y}_{m}[n]\\exp\\!\\left(-\\mathrm{j}\\frac{2\\pi k}{N}n\\right),\n$$\n其中，当 $0\\leq n\\leq L-1$ 时，$\\tilde{y}_{m}[n]=y_{m}[n]$；当 $L\\leq n\\leq N-1$ 时，$\\tilde{y}_{m}[n]=0$（即当 $NL$ 时进行补零）。因此 $X_{m}[k]=Y_{m}(\\omega_{k})$；改变 $N$ 只会改变 $Y_{m}(\\omega)$ 的采样密度：\n$$\n\\Delta \\omega=\\frac{2\\pi}{N},\\qquad \\Delta f=\\frac{f_{s}}{N}.\n$$\n\n真实频率分辨率由窗的有效持续时间决定，而不是由 $N$ 决定。幅度 $|Y_{m}(\\omega)|$ 是底层谱线与窗谱 $W(\\omega)$ 在频域上的卷积，窗谱的主瓣宽度与 $1/L$ 成正比（比例常数取决于窗的形状）。因此，瑞利极限以及分辨两个频率相近的正弦波的能力是由 $L$ 和 $w[n]$ 决定的，而不是由 $N$ 决定的。补零（增加 $N$）会使频率采样网格更精细，但不会使 $|W(\\omega)|$ 的主瓣变窄，因此它不会显著提高真实频率分辨率。\n\n时间分辨率由窗长 $L$（以及跳跃步长）决定，这两者都未改变；因此，增加 $N$ 并不会改善时间分辨率。频谱泄漏由 $w[n]$ 以及正弦波与频率网格的对齐情况决定；补零不会增加泄漏能量，它只是更密集地对相同的泄漏模式进行采样。信噪比不会因为补零而降低，因为没有引入额外的噪声，并且底层的能量分布保持不变。\n\n因此，当固定 $L$ 而增加 $N$ 时，谱图的频率轴采样变得更精细；显示的幅度 $|X_{m}[k]|^{2}$ 在较粗的频率仓值之间显得更平滑、更像是经过插值，这有助于在不改变基本分辨率或泄漏特性的情况下，直观地定位和估计峰值频率。\n\n因此，最准确的描述是频率内容将看起来像是经过插值且更平滑，从而便于精确的峰值估计。\n\n选项评估：\n- A: 错误；时间分辨率不变。\n- B: 错误；真实频率分辨率由 $L$ 和 $w[n]$ 决定，而非 $N$。\n- C: 错误；泄漏是窗函数的属性；补零不会增加它。\n- D: 正确；更密集的采样使频谱显得更平滑和经过插值。\n- E: 错误；信噪比不会因补零而降低。\n\n因此，正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1730843"}]}