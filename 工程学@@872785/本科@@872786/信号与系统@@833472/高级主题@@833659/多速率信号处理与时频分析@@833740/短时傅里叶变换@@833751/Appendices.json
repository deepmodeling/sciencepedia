{"hands_on_practices": [{"introduction": "我们从最简单的情形入手：一个恒定的直流信号。这项练习旨在揭示短时傅里叶变换（STFT）和窗函数的选择如何相互作用。通过这个基本计算 [@problem_id:1765475]，你将亲眼看到一个时不变信号的STFT如何本质上反映了窗函数自身的频谱，并理解其结果为何在时间维度上是稳定的。", "problem": "考虑一个由 $x(t) = C$ 给出的连续时间信号，其中 $C$ 是一个非零实常数。我们希望使用短时傅里叶变换（STFT）来分析这个信号。STFT，记为 $X(\\tau, \\omega)$，由以下积分定义：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n其中 $j$ 是虚数单位，$\\tau$ 是时间偏移参数，$\\omega$ 是角频率。\n\n用于此分析的窗函数是一个高斯函数，由下式给出：\n$$w(t) = \\exp(-at^2)$$\n其中 $a$ 是一个正实常数。\n\n确定信号 $x(t)$ 的STFT，$X(\\tau, \\omega)$。将你的答案表示为 $C$、$a$、$\\tau$、$\\omega$ 和基本数学常数的函数。", "solution": "短时傅里叶变换（STFT）定义为：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n\n我们给定的信号是 $x(t) = C$，窗函数是 $w(t) = \\exp(-at^2)$。首先，我们将这些代入STFT的定义中。窗函数被平移了 $\\tau$，所以我们使用 $w(t-\\tau) = \\exp(-a(t-\\tau)^2)$。\n\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} C \\exp(-a(t-\\tau)^2) e^{-j\\omega t} dt$$\n\n由于 $C$ 是一个常数，我们可以将其从积分中提出：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp(-a(t-\\tau)^2) e^{-j\\omega t} dt$$\n\n接下来，我们将积分内的指数项合并：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp(-a(t-\\tau)^2 - j\\omega t) dt$$\n\n为了求解这个积分，我们需要将指数部分整理成一个易于积分的二次型。让我们展开指数的参数：\n$$-a(t-\\tau)^2 - j\\omega t = -a(t^2 - 2t\\tau + \\tau^2) - j\\omega t$$\n$$= -at^2 + 2a\\tau t - a\\tau^2 - j\\omega t$$\n\n按积分变量 $t$ 的幂次对各项进行分组：\n$$= -at^2 + (2a\\tau - j\\omega)t - a\\tau^2$$\n\n现在，我们对 $t$ 进行配方。我们从包含 $t$ 的项中提出因子 $-a$：\n$$= -a \\left[ t^2 - \\frac{2a\\tau - j\\omega}{a} t \\right] - a\\tau^2$$\n$$= -a \\left[ t^2 - 2\\left(\\tau - \\frac{j\\omega}{2a}\\right) t \\right] - a\\tau^2$$\n\n为了在方括号内完成配方，我们加上并减去 $t$ 项系数一半的平方，即 $\\left(\\tau - \\frac{j\\omega}{2a}\\right)^2$：\n$$= -a \\left[ \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - \\left(\\tau - \\frac{j\\omega}{2a}\\right)^2 \\right] - a\\tau^2$$\n$$= -a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 + a \\left(\\tau - \\frac{j\\omega}{2a}\\right)^2 - a\\tau^2$$\n\n让我们简化不依赖于 $t$ 的项：\n$$a \\left(\\tau^2 - 2\\tau\\frac{j\\omega}{2a} + \\left(\\frac{j\\omega}{2a}\\right)^2\\right) - a\\tau^2$$\n$$= a\\left(\\tau^2 - \\frac{j\\omega\\tau}{a} - \\frac{\\omega^2}{4a^2}\\right) - a\\tau^2$$\n$$= a\\tau^2 - j\\omega\\tau - \\frac{\\omega^2}{4a} - a\\tau^2$$\n$$= -j\\omega\\tau - \\frac{\\omega^2}{4a}$$\n\n所以，完整的指数是：\n$$-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - j\\omega\\tau - \\frac{\\omega^2}{4a}$$\n\n将此代回 $X(\\tau, \\omega)$ 的积分中：\n$$X(\\tau, \\omega) = C \\int_{-\\infty}^{\\infty} \\exp\\left(-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2 - j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) dt$$\n\n指数中不依赖于 $t$ 的部分可以从积分中提出：\n$$X(\\tau, \\omega) = C \\exp\\left(-j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-a \\left(t - \\left(\\tau - \\frac{j\\omega}{2a}\\right)\\right)^2\\right) dt$$\n\n剩余的积分是一个标准的高斯积分。令 $u = t - (\\tau - \\frac{j\\omega}{2a})$，则 $du = dt$。积分变为：\n$$\\int_{-\\infty}^{\\infty} \\exp(-au^2) du$$\n这是 $\\int_{-\\infty}^{\\infty} \\exp(-bx^2)dx$ 的形式，其熟知的结果是 $\\sqrt{\\frac{\\pi}{b}}$。在我们的例子中，$b=a$。因此，该积分的计算结果为：\n$$\\int_{-\\infty}^{\\infty} \\exp(-au^2) du = \\sqrt{\\frac{\\pi}{a}}$$\n\n最后，我们将这个结果代回我们关于 $X(\\tau, \\omega)$ 的表达式中：\n$$X(\\tau, \\omega) = C \\exp\\left(-j\\omega\\tau - \\frac{\\omega^2}{4a}\\right) \\sqrt{\\frac{\\pi}{a}}$$\n\n重新整理各项，得到最终答案：\n$$X(\\tau, \\omega) = C \\sqrt{\\frac{\\pi}{a}} \\exp\\left(-\\frac{\\omega^2}{4a} - j\\omega\\tau\\right)$$", "answer": "$$\\boxed{C \\sqrt{\\frac{\\pi}{a}} \\exp\\left(-\\frac{\\omega^{2}}{4a} - j\\omega\\tau\\right)}$$", "id": "1765475"}, {"introduction": "理解了基本计算后，我们来探讨STFT的一个基本性质。这项练习 [@problem_id:1765452] 研究了信号中的一个简单时间延迟如何影响其时频表示。掌握这个性质对于理解STFT如何追踪信号在时间上的动态变化至关重要，并揭示了时域的平移如何转化为STFT中的时移和相位调制。", "problem": "在信号处理领域，短时傅里叶变换 (STFT) 是一个关键工具，用于分析信号的频率内容如何随时间变化。连续时间信号 $x(t)$ 的STFT定义为：\n$$\nX(t, \\omega) = \\int_{-\\infty}^{\\infty} x(\\tau) w(\\tau - t) e^{-j\\omega\\tau} d\\tau\n$$\n此处，$w(t)$ 是一个实值窗函数，$t$ 是用于局部化分析的时间变量，$\\omega$ 是角频率，$\\tau$ 是时间积分变量，$j$ 是虚数单位，定义为 $j = \\sqrt{-1}$。\n\n考虑一个信号 $x(t)$，其STFT由 $X(t, \\omega)$ 给出。我们定义一个新信号 $y(t)$，它是原始信号的时延版本，由 $y(t) = x(t - t_0)$ 给出，其中 $t_0$ 是一个常实数值时延。\n\n令 $Y(t, \\omega)$ 为信号 $y(t)$ 的STFT，使用相同的窗函数 $w(t)$ 进行计算。求出 $Y(t, \\omega)$ 关于原始STFT $X(t, \\omega)$ 以及参数 $t_0$ 和 $\\omega$ 的表达式。", "solution": "题目要求我们求出时移信号 $y(t) = x(t - t_0)$ 的短时傅里叶变换 (STFT)，记为 $Y(t, \\omega)$，并用原始信号的STFT $X(t, \\omega)$ 来表示它。\n\n我们从信号 $y(t)$ 的STFT定义开始：\n$$\nY(t, \\omega) = \\int_{-\\infty}^{\\infty} y(\\tau) w(\\tau - t) e^{-j\\omega\\tau} d\\tau\n$$\n\n将 $y(\\tau)$ 的表达式 $y(\\tau) = x(\\tau - t_0)$ 代入积分中：\n$$\nY(t, \\omega) = \\int_{-\\infty}^{\\infty} x(\\tau - t_0) w(\\tau - t) e^{-j\\omega\\tau} d\\tau\n$$\n\n为了将此表达式与 $x(t)$ 的STFT联系起来，我们进行积分的变量替换。令新的积分变量为 $\\lambda$，使得 $\\lambda = \\tau - t_0$。这意味着 $\\tau = \\lambda + t_0$，微分元为 $d\\tau = d\\lambda$。由于 $t_0$ 是一个常数，当 $\\tau$ 从 $-\\infty$ 到 $\\infty$ 时，积分限对应的 $\\lambda$ 也从 $-\\infty$ 到 $\\infty$。\n\n现在，我们将这些代入 $Y(t, \\omega)$ 的积分中：\n$$\nY(t, \\omega) = \\int_{-\\infty}^{\\infty} x(\\lambda) w((\\lambda + t_0) - t) e^{-j\\omega(\\lambda + t_0)} d\\lambda\n$$\n\n我们可以简化积分内的项。窗函数项变为 $w(\\lambda - (t - t_0))$。指数项可以利用属性 $e^{a+b} = e^a e^b$ 进行拆分：\n$$\ne^{-j\\omega(\\lambda + t_0)} = e^{-j\\omega\\lambda} e^{-j\\omega t_0}\n$$\n\n项 $e^{-j\\omega t_0}$ 相对于积分变量 $\\lambda$ 是一个常数，因此可以移到积分符号外：\n$$\nY(t, \\omega) = e^{-j\\omega t_0} \\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - (t - t_0)) e^{-j\\omega\\lambda} d\\lambda\n$$\n\n现在，我们来考察剩下的积分。它具有原始信号 $x(t)$ 的STFT的形式。$x(t)$ 的STFT定义为：\n$$\nX(t', \\omega) = \\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - t') e^{-j\\omega\\lambda} d\\lambda\n$$\n为清晰起见，这里我们使用 $\\lambda$ 作为积分变量，使用 $t'$ 作为时间局部化参数。\n\n通过将我们 $Y(t, \\omega)$ 表达式中的积分与 $X(t', \\omega)$ 的定义进行比较，我们可以看到，如果我们将时间局部化参数 $t'$ 设置为 $t - t_0$，它们是完全相同的。因此，我们有：\n$$\n\\int_{-\\infty}^{\\infty} x(\\lambda) w(\\lambda - (t - t_0)) e^{-j\\omega\\lambda} d\\lambda = X(t - t_0, \\omega)\n$$\n\n将此结果代回到我们 $Y(t, \\omega)$ 的表达式中，我们得到最终的关系式：\n$$\nY(t, \\omega) = e^{-j\\omega t_0} X(t - t_0, \\omega)\n$$\n这个结果表明，信号域中 $t_0$ 的时延，会在STFT的时间变量上引起一个 $t_0$ 的时移，并在STFT的频率变量上引起一个 $- \\omega t_0$ 的线性相移。", "answer": "$$\\boxed{\\exp(-j\\omega t_0) X(t - t_0, \\omega)}$$", "id": "1765452"}, {"introduction": "现在，让我们将STFT应用于一个包含突变事件的信号——单位阶跃函数。这个问题 [@problem_id:1765478] 展示了STFT在时间上定位事件的强大能力。通过分析当分析窗口滑过信号的不连续点时变换输出如何演变，你可以具体地体会到STFT是如何“看到”并捕捉非平稳信号特征的。", "problem": "考虑一个信号 $x(t)$，定义为单位阶跃函数 $u(t)$，其中当 $t \\ge 0$ 时 $u(t) = 1$，当 $t  0$ 时 $u(t) = 0$。我们希望使用短时傅里叶变换 (STFT) 来分析这个信号。\n\n一个信号 $x(t)$ 相对于一个窗函数 $w(t)$ 的短时傅里叶变换 (STFT) 定义为：\n$$X(\\tau, \\omega) = \\int_{-\\infty}^{\\infty} x(t) w(t-\\tau) e^{-j\\omega t} dt$$\n其中 $\\tau$ 是滑动窗的时间参数，$\\omega$ 是角频率。\n\n对于本问题，使用一个总持续时间为 $2T$、以原点为中心的对称矩形窗函数 $w(t)$，定义为：\n$$\nw(t) =\n\\begin{cases}\n1,  |t| \\le T \\\\\n0,  |t|  T\n\\end{cases}\n$$\n使用此矩形窗，确定信号 $x(t) = u(t)$ 的短时傅里叶变换 $X(\\tau, \\omega)$。结果将是 $\\tau$ 和 $\\omega$ 的函数。请将结果表示为单个数学表达式，该表达式可根据 $\\tau$ 的值分段定义。", "solution": "我们已知STFT的定义为：\n$$ X(\\tau,\\omega) = \\int_{-\\infty}^{\\infty} x(t)\\,w(t-\\tau)\\,\\exp(-j\\omega t)\\,dt $$\n其中信号 $x(t) = u(t)$，窗函数 $w(t)$ 为对称矩形窗：\n$$ w(t)=\\begin{cases} 1,  |t|\\leq T \\\\ 0,  |t|>T \\end{cases} $$\n平移后的窗函数 $w(t-\\tau)$ 在 $t \\in [\\tau-T, \\tau+T]$ 区间内为1，在区间外为0。\n信号 $x(t)=u(t)$ 在 $t \\ge 0$ 时为1，在 $t  0$ 时为0。\n因此，被积函数 $x(t)w(t-\\tau)$ 非零的区间是 $[\\tau-T, \\tau+T]$ 和 $[0, \\infty)$ 的交集。我们需要根据窗函数中心 $\\tau$ 的位置分三种情况讨论积分的上下限。\n\n**情况 1: $\\tau \\le -T$**\n此时，窗函数覆盖的区间 $[\\tau-T, \\tau+T]$ 完全位于 $t  0$ 的区域（或在 $t=0$ 处接触）。因此，与 $[0, \\infty)$ 的交集为空，积分结果为0。\n$$ X(\\tau, \\omega) = 0 $$\n\n**情况 2: $-T  \\tau  T$**\n此时，窗函数部分覆盖 $t \\ge 0$ 的区域。积分的下限是 $\\max(0, \\tau-T) = 0$，上限是 $\\tau+T$。\n$$ X(\\tau, \\omega) = \\int_{0}^{\\tau+T} 1 \\cdot \\exp(-j\\omega t) dt $$\n如果 $\\omega \\neq 0$，积分结果为：\n$$ X(\\tau, \\omega) = \\left[ \\frac{\\exp(-j\\omega t)}{-j\\omega} \\right]_0^{\\tau+T} = \\frac{\\exp(-j\\omega(\\tau+T)) - 1}{-j\\omega} = \\frac{1 - \\exp(-j\\omega(\\tau+T))}{j\\omega} $$\n如果 $\\omega = 0$，积分结果为：\n$$ X(\\tau, 0) = \\int_{0}^{\\tau+T} 1 dt = \\tau+T $$\n\n**情况 3: $\\tau \\ge T$**\n此时，窗函数覆盖的区间 $[\\tau-T, \\tau+T]$ 完全位于 $t > 0$ 的区域。积分的下限是 $\\tau-T$，上限是 $\\tau+T$。\n$$ X(\\tau, \\omega) = \\int_{\\tau-T}^{\\tau+T} 1 \\cdot \\exp(-j\\omega t) dt $$\n如果 $\\omega \\neq 0$，积分结果为：\n$$ X(\\tau, \\omega) = \\left[ \\frac{\\exp(-j\\omega t)}{-j\\omega} \\right]_{\\tau-T}^{\\tau+T} = \\frac{\\exp(-j\\omega(\\tau+T)) - \\exp(-j\\omega(\\tau-T))}{-j\\omega} = \\frac{\\exp(-j\\omega(\\tau-T)) - \\exp(-j\\omega(\\tau+T))}{j\\omega} $$\n如果 $\\omega = 0$，积分结果为：\n$$ X(\\tau, 0) = \\int_{\\tau-T}^{\\tau+T} 1 dt = (\\tau+T) - (\\tau-T) = 2T $$", "answer": "$$\\boxed{X(\\tau,\\omega)=\\begin{cases}\n0,  \\text{if } \\tau\\leq -T \\\\[12pt]\n\\begin{cases} \\dfrac{1-e^{-j\\omega(\\tau+T)}}{j\\omega},  \\omega\\neq 0 \\\\ \\tau+T,  \\omega=0 \\end{cases},  \\text{if } -T  \\tau  T \\\\[12pt]\n\\begin{cases} \\dfrac{e^{-j\\omega(\\tau-T)} - e^{-j\\omega(\\tau+T)}}{j\\omega},  \\omega\\neq 0 \\\\ 2T,  \\omega=0 \\end{cases},  \\text{if } \\tau\\geq T\n\\end{cases}}$$", "id": "1765478"}]}