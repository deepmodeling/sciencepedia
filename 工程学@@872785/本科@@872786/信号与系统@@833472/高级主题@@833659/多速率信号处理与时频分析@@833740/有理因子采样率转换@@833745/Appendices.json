{"hands_on_practices": [{"introduction": "理解有理因子采样率转换最直观的方法之一是在频域中进行分析。本练习将引导你逐步观察信号频谱在每个阶段——升采样、滤波和降采样——是如何变换的，从而最终预测输出信号的带宽 [@problem_id:1750644]。这个过程可以帮助你建立一个清晰的心理模型，理解频谱在多速率系统中的压缩、复制和展宽。", "problem": "一个离散时间信号 $x[n]$ 的离散时间傅里叶变换 (DTFT) $X(e^{j\\omega})$ 在频率范围 $|\\omega|  \\pi/5$ 内非零且等于常数值1，而在 $\\pi/5 \\le |\\omega| \\le \\pi$ 范围内为零。\n\n该信号由一个包含以下三个阶段的数字系统处理：\n1. 通过在原始信号 $x[n]$ 的每对连续样本之间插入一个零值样本，来创建一个中间信号 $x_u[n]$。具体来说，如果 $n$ 是偶数，$x_u[n] = x[n/2]$；如果 $n$ 是奇数，$x_u[n] = 0$。\n2. 信号 $x_u[n]$ 接着通过一个理想低通数字滤波器，其通带增益为2，截止频率为 $\\pi/3$ 弧度/样本。设该滤波器的输出为 $x_f[n]$。\n3. 最终输出信号 $y[n]$ 是通过保留 $x_f[n]$ 的每三个样本中的一个来获得的，即 $y[n] = x_f[3n]$。\n\n确定输出信号 $y[n]$ 的带宽。具体来说，求最大正频率 $\\omega_{max}$，使得对于所有频率 $|\\omega|  \\omega_{max}$，输出的DTFT $Y(e^{j\\omega})$ 都非零。请将您的答案表示为 $\\pi$ 的数值倍数。", "solution": "给定一个离散时间信号，其DTFT为\n$$\nX(e^{j\\omega})=\\begin{cases}\n1,  |\\omega|  \\frac{\\pi}{5},\\\\\n0,  \\frac{\\pi}{5} \\le |\\omega| \\le \\pi.\n\\end{cases}\n$$\n阶段1是通过补零实现的因子为2的上采样：当 $n$ 为偶数时，$x_{u}[n]=x[n/2]$；当 $n$ 为奇数时，$x_{u}[n]=0$。一个经因子 $L$ 上采样的信号的DTFT满足\n$$\nX_{u}(e^{j\\omega})=\\sum_{n=-\\infty}^{\\infty}x_{u}[n]e^{-j\\omega n}=\\sum_{k=-\\infty}^{\\infty}x[k]e^{-j\\omega(2k)}=X(e^{j(2\\omega)}).\n$$\n因此，$X_{u}(e^{j\\omega})$ 非零的条件是 $2\\omega$ 落在 $X(e^{j\\Omega})$ 的一个通带内（模 $2\\pi$）。由于 $X(e^{j\\Omega})$ 在 $|\\Omega|\\pi/5$ 时非零（周期为 $2\\pi$），这意味着\n$$\nX_{u}(e^{j\\omega})\\neq 0 \\quad \\Leftrightarrow \\quad |2\\omega-2\\pi m|  \\frac{\\pi}{5}\\ \\text{for some}\\ m\\in\\mathbb{Z},\n$$\n这等价于\n$$\n|\\omega-m\\pi|  \\frac{\\pi}{10}.\n$$\n在主区间 $[-\\pi,\\pi)$ 内，这会产生一个基带波瓣 $|\\omega|  \\pi/10$ 和在 $\\omega=\\pm\\pi$ 附近的镜像波瓣，总宽度为 $\\pi/5$，即 $|\\omega\\mp\\pi|  \\pi/10$。\n\n阶段2应用一个通带增益为2、截止频率为 $\\omega_{c}=\\pi/3$ 的理想低通滤波器。其频率响应为\n$$\nH(e^{j\\omega})=\\begin{cases}\n2,  |\\omega|  \\frac{\\pi}{3},\\\\\n0,  \\frac{\\pi}{3} \\le |\\omega| \\le \\pi.\n\\end{cases}\n$$\n滤波后的频谱为\n$$\nX_{f}(e^{j\\omega})=H(e^{j\\omega})X_{u}(e^{j\\omega}).\n$$\n由于 $X_{u}$ 的基带为 $|\\omega|  \\pi/10$ 且 $\\pi/10  \\pi/3$，它得以通过并被乘以2，而 $\\pm\\pi$ 附近的镜像带落在阻带内被移除。因此\n$$\nX_{f}(e^{j\\omega})=\\begin{cases}\n2,  |\\omega|  \\frac{\\pi}{10},\\\\\n0,  \\frac{\\pi}{10} \\le |\\omega| \\le \\pi.\n\\end{cases}\n$$\n\n阶段3进行因子为 $M=3$ 的下采样：$y[n]=x_{f}[3n]$。一个经因子 $M$ 抽取的信号的DTFT满足\n$$\nY(e^{j\\omega})=\\frac{1}{M}\\sum_{k=0}^{M-1}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{M}}\\right).\n$$\n当 $M=3$ 时，\n$$\nY(e^{j\\omega})=\\frac{1}{3}\\sum_{k=0}^{2}X_{f}\\!\\left(e^{j\\frac{\\omega+2\\pi k}{3}}\\right).\n$$\n因为 $X_{f}(e^{j\\theta})$ 仅在 $|\\theta|  \\pi/10$ 时非零，所以求和中的一项仅在以下条件下非零\n$$\n\\left|\\frac{\\omega+2\\pi k}{3}\\right|  \\frac{\\pi}{10}.\n$$\n对于 $k=0$，此条件为 $|\\omega|  3\\pi/10$，这是可行的，并产生非零贡献。对于 $k=1$，它要求 $|\\omega+2\\pi|  3\\pi/10$，对于 $\\omega\\in[-\\pi,\\pi]$ 这是不成立的。对于 $k=2$，它要求 $|\\omega+4\\pi|  3\\pi/10$，对于 $\\omega\\in[-\\pi,\\pi]$ 这同样是不可能的。因此只有 $k=0$ 项有贡献，并且 $Y(e^{j\\omega})$ 非零的精确条件是\n$$\n|\\omega|  \\frac{3\\pi}{10}.\n$$\n因此输出带宽为 $\\omega_{\\max}=\\frac{3\\pi}{10}$。\n\n因此，使得 $Y(e^{j\\omega})$ 在所有 $|\\omega|  \\omega_{\\max}$ 范围内都非零的最大正频率是 $\\omega_{\\max}=\\frac{3\\pi}{10}$，即 $\\pi$ 的倍数等于 $\\frac{3}{10}\\pi$。", "answer": "$$\\boxed{\\frac{3\\pi}{10}}$$", "id": "1750644"}, {"introduction": "在采样率转换系统中，抗混叠低通滤波器是防止信号失真的关键。本练习通过一个警示性的案例，探讨了当这个至关重要的滤波器被省略时会发生什么 [@problem_id:1750693]。通过分析一个实际的音频处理场景，你将亲眼看到混叠伪影是如何产生的，这对于理解和设计稳健的数字信号处理系统至关重要。", "problem": "一个音频处理系统被设计用来改变录音的播放速度。输入是一个连续时间信号，为了测试目的，该信号是一个由 $x(t) = \\cos(\\omega_0 t)$ 建模的纯音，其频率 $f_0 = \\omega_0 / (2\\pi)$ 精确为 $6 \\text{ kHz}$。该信号首先由一个工作在采样率 $F_s = 20 \\text{ kHz}$ 的模数转换器（ADC）进行数字化，产生一个离散时间序列 $x[n]$。\n\n为了达到预期的效果，系统必须以 $3/4$ 的有理因子对该序列进行重采样。这是通过先将序列 $x[n]$ 以因子 $L=3$ 进行上采样得到中间序列 $x_u[n]$，然后将 $x_u[n]$ 以因子 $M=4$ 进行下采样，从而产生最终的输出序列 $y[n]$ 来实现的。\n\n然而，由于设计缺陷，本应在下采样前应用于 $x_u[n]$ 的关键的低通抗混叠滤波器被完全省略了。最终序列 $y[n]$ 随后被发送到一个工作在新的、修改后的采样率下的理想数模转换器（DAC），以产生输出的模拟信号 $y(t)$。\n\n确定最终模拟信号 $y(t)$ 中存在的所有不同的正频率（以 kHz 为单位）。请按升序给出你的答案。", "solution": "模拟输入为 $x(t)=\\cos(\\omega_{0} t)$，其中 $f_{0}=\\omega_{0}/(2\\pi)=6\\ \\text{kHz}$。在采样率 $F_{s}=20\\ \\text{kHz}$（$T=1/F_{s}$）下采样，得到离散时间纯音\n$$\nx[n]=\\cos(\\omega_{d} n),\\quad \\omega_{d}=\\frac{2\\pi f_{0}}{F_{s}}=\\frac{2\\pi\\cdot 6}{20}=\\frac{3\\pi}{5}\\ \\text{rad/sample}.\n$$\n\n以因子 $L=3$ 进行上采样得到 $x_{u}[n]$，其DTFT为 $X_{u}(e^{j\\omega})=X(e^{j\\omega L})$。对于位于 $\\pm\\omega_{d}$ 的脉冲，上采样后的频谱在以下位置有脉冲\n$$\n\\omega=\\frac{\\pm\\omega_{d}+2\\pi k}{L},\\quad k=0,1,2.\n$$\n当 $\\omega_{d}=\\frac{3\\pi}{5}$ 且 $L=3$ 时，$x_{u}[n]$ 中不同的正频率为\n$$\n\\omega=\\frac{\\pi}{5},\\quad \\omega=\\frac{7\\pi}{15},\\quad \\omega=\\frac{13\\pi}{15}.\n$$\n\n以因子 $M=4$ 对 $x_{u}[n]$ 进行下采样，将每个位于 $\\omega$ 的离散时间正弦波映射到 $y[n]=x_{u}[nM]$，即频率为\n$$\n\\omega'\\equiv M\\omega \\pmod{2\\pi}.\n$$\n将 $M=4$ 应用于三个上采样后的频率，得到\n$$\n\\omega'_{1}=4\\cdot\\frac{\\pi}{5}=\\frac{4\\pi}{5},\\quad\n\\omega'_{2}=4\\cdot\\frac{7\\pi}{15}=\\frac{28\\pi}{15}\\equiv -\\frac{2\\pi}{15},\\quad\n\\omega'_{3}=4\\cdot\\frac{13\\pi}{15}=\\frac{52\\pi}{15}\\equiv -\\frac{8\\pi}{15},\n$$\n因此，$y[n]$ 中存在的不同正频率幅值为\n$$\n\\left\\{\\frac{2\\pi}{15},\\ \\frac{8\\pi}{15},\\ \\frac{4\\pi}{5}\\right\\}.\n$$\n\nDAC 工作在新的采样率下\n$$\nF_{s}'=\\frac{L}{M}F_{s}=\\frac{3}{4}\\cdot 20\\ \\text{kHz}=15\\ \\text{kHz}.\n$$\n一个理想的 DAC 将离散时间角频率 $\\omega'$ 映射到模拟频率 $f=(\\omega'/(2\\pi))F_{s}'$。因此，与上述三个 $\\omega'$ 相对应的模拟频率为\n$$\nf_{1}=\\frac{1}{15}F_{s}'=1\\ \\text{kHz},\\quad\nf_{2}=\\frac{4}{15}F_{s}'=4\\ \\text{kHz},\\quad\nf_{3}=\\frac{2}{5}F_{s}'=6\\ \\text{kHz}.\n$$\n\n因此，$y(t)$ 中存在的不同正频率按升序排列为 $1\\ \\text{kHz}$、$4\\ \\text{kHz}$ 和 $6\\ \\text{kHz}$。", "answer": "$$\\boxed{\\begin{pmatrix}1  4  6\\end{pmatrix}}$$", "id": "1750693"}, {"introduction": "在频域中建立了概念性理解之后，我们现在转向时域，进行一次具体的、逐个样本的计算。本练习要求你直接处理一个有限长度的输入序列，并计算经过完整的升采样、理想滤波和降采样过程后的输出 [@problem_id:1750673]。这会让你熟悉如何应用滤波器的冲激响应，并精确执行多速率操作，从而巩固对整个过程底层机制的掌握。", "problem": "在一个专用的数字信号处理 (DSP) 单元中，一个短的输入信号需要被重采样。输入是一个有限长度的因果信号，定义为 $x[n] = \\{1, 2, 3\\}$ 分别对应 $n=0, 1, 2$，对于所有其他整数 $n$，$x[n] = 0$。\n\n该信号由一个采样率转换器处理，该转换器以有理因子 $L/M = 2/3$ 改变采样率。该转换器包含三个阶段：\n1.  一个上采样器，将采样率提高 $L=2$ 倍。\n2.  一个理想低通滤波器。\n3.  一个下采样器，将采样率降低 $M=3$ 倍。\n\n理想低通滤波器被设计用来完美地去除上采样器产生的镜像伪影，而不失真所需信号分量。它的截止频率为 $\\omega_c = \\pi/M$，通带增益等于 $L$。\n\n确定输出序列 $y[n]$ 在索引 $n = -1, 0, 1, 2, 3$ 处的值。", "solution": "输入为 $x[n]=\\{1,2,3\\}$ (当 $n=0,1,2$)，其他情况下为零。转换器执行上采样 (因子 $L=2$)，理想低通滤波 (通带增益为 $L$，截止频率为 $\\omega_{c}=\\pi/M=\\pi/3$)，以及下采样 (因子 $M=3$)。\n\n通过 $L=2$ 上采样得到 $u[n]=x[n/2]$ (当 $n$ 为偶数)，以及 $u[n]=0$ (当 $n$ 为奇数)。等价地，$u[2r]=x[r]$ (当 $r=0,1,2$)，其他情况下 $u[n]=0$。\n\n理想低通滤波器的频率响应为\n$$\nH(\\omega)=\\begin{cases}\nL,  |\\omega|\\le \\omega_{c},\\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\n其中 $L=2$ 且 $\\omega_{c}=\\pi/3$。其冲激响应是离散时间傅里叶逆变换 (inverse DTFT)：\n$$\nh[n]=\\frac{1}{2\\pi}\\int_{-\\omega_{c}}^{\\omega_{c}}L\\,e^{j\\omega n}\\,d\\omega\n=\n\\begin{cases}\n\\frac{L\\omega_{c}}{\\pi},  n=0,\\\\\n\\frac{L\\sin(\\omega_{c} n)}{\\pi n},  n\\neq 0.\n\\end{cases}\n$$\n代入 $L=2$ 和 $\\omega_{c}=\\pi/3$ 得到\n$$\nh[0]=\\frac{2}{3},\\qquad h[n]=\\frac{2\\sin\\!\\left(\\frac{\\pi n}{3}\\right)}{\\pi n}\\ \\text{ for } n\\neq 0.\n$$\n滤波后，$w[n]=(h*u)[n]=\\sum_{k}h[k]\\,u[n-k]$。利用 $u[n]$ 的稀疏性，这变为\n$$\nw[n]=\\sum_{r=0}^{2}x[r]\\;h[n-2r].\n$$\n通过 $M=3$ 下采样得到\n$$\ny[n]=w[3n]=\\sum_{r=0}^{2}x[r]\\;h[3n-2r].\n$$\n已知 $x[0]=1$, $x[1]=2$, $x[2]=3$，我们有\n$$\ny[n]=h[3n]+2\\,h[3n-2]+3\\,h[3n-4].\n$$\n我们使用 $h[0]=\\frac{2}{3}$ 以及当 $m\\neq 0$ 时 $h[m]=\\frac{2\\sin(\\pi m/3)}{\\pi m}$ 来计算所需索引处的 $h[m]$ 值。注意 $h[m]$ 是偶函数，并且对于非零整数 $q$，$h[3q]=0$。\n\n计算所需的值：\n- $h[\\pm 1]=\\frac{2\\sin(\\pi/3)}{\\pi}=\\frac{\\sqrt{3}}{\\pi}$,\n- $h[\\pm 2]=\\frac{2\\sin(2\\pi/3)}{2\\pi}=\\frac{\\sqrt{3}}{2\\pi}$,\n- $h[\\pm 3]=0$,\n- $h[\\pm 4]=\\frac{2\\sin(4\\pi/3)}{4\\pi}=-\\frac{\\sqrt{3}}{4\\pi}$,\n- $h[\\pm 5]=\\frac{2\\sin(5\\pi/3)}{5\\pi}=-\\frac{\\sqrt{3}}{5\\pi}$,\n- $h[\\pm 6]=0$,\n- $h[\\pm 7]=\\frac{2\\sin(7\\pi/3)}{7\\pi}=\\frac{\\sqrt{3}}{7\\pi}$,\n- $h[9]=0$.\n\n现在计算 $y[n]=h[3n]+2h[3n-2]+3h[3n-4]$:\n\n对于 $n=-1$：$3n=-3$, $3n-2=-5$, $3n-4=-7$,\n$$\ny[-1]=h[-3]+2h[-5]+3h[-7]=0+2\\!\\left(-\\frac{\\sqrt{3}}{5\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{7\\pi}\\right)=\\frac{\\sqrt{3}}{35\\pi}.\n$$\n\n对于 $n=0$：$3n=0$, $3n-2=-2$, $3n-4=-4$,\n$$\ny[0]=h[0]+2h[-2]+3h[-4]=\\frac{2}{3}+2\\!\\left(\\frac{\\sqrt{3}}{2\\pi}\\right)+3\\!\\left(-\\frac{\\sqrt{3}}{4\\pi}\\right)=\\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi}.\n$$\n\n对于 $n=1$：$3n=3$, $3n-2=1$, $3n-4=-1$,\n$$\ny[1]=h[3]+2h[1]+3h[-1]=0+2\\!\\left(\\frac{\\sqrt{3}}{\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{\\pi}\\right)=\\frac{5\\sqrt{3}}{\\pi}.\n$$\n\n对于 $n=2$：$3n=6$, $3n-2=4$, $3n-4=2$,\n$$\ny[2]=h[6]+2h[4]+3h[2]=0+2\\!\\left(-\\frac{\\sqrt{3}}{4\\pi}\\right)+3\\!\\left(\\frac{\\sqrt{3}}{2\\pi}\\right)=\\frac{\\sqrt{3}}{\\pi}.\n$$\n\n对于 $n=3$：$3n=9$, $3n-2=7$, $3n-4=5$,\n$$\ny[3]=h[9]+2h[7]+3h[5]=0+2\\!\\left(\\frac{\\sqrt{3}}{7\\pi}\\right)+3\\!\\left(-\\frac{\\sqrt{3}}{5\\pi}\\right)=-\\frac{11\\sqrt{3}}{35\\pi}.\n$$\n\n因此，对于 $n=-1,0,1,2,3$，输出序列为\n$$\n\\left(\\frac{\\sqrt{3}}{35\\pi},\\ \\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi},\\ \\frac{5\\sqrt{3}}{\\pi},\\ \\frac{\\sqrt{3}}{\\pi},\\ -\\frac{11\\sqrt{3}}{35\\pi}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\sqrt{3}}{35\\pi}  \\frac{2}{3}+\\frac{\\sqrt{3}}{4\\pi}  \\frac{5\\sqrt{3}}{\\pi}  \\frac{\\sqrt{3}}{\\pi}  -\\frac{11\\sqrt{3}}{35\\pi}\\end{pmatrix}}$$", "id": "1750673"}]}