{"hands_on_practices": [{"introduction": "多相分解是高效多速率系统设计的基石。这个练习将从一个最基础也最常见的滤波器——双点移动平均滤波器——开始，带你亲手实践如何将一个滤波器的传递函数分解为两个多相分量。通过这个基础练习 [@problem_id:1737208]，你将掌握将滤波器脉冲响应分解为其偶数和奇数部分的核心机制。", "problem": "在多速率数字信号处理中，一个滤波器的传递函数 $H(z)$ 可以被分解为一组“多相分量”。这种分解对于设计高效的滤波器组至关重要，而滤波器组广泛应用于音频压缩和通信等领域。对于一个抽取/插值因子为 $M=2$ 的系统，其传递函数 $H(z)$ 可以通过其两个多相分量 $E_0(z)$ 和 $E_1(z)$ 唯一地表示为以下关系式：\n\n$$H(z) = E_0(z^{2}) + z^{-1}E_1(z^{2})$$\n\n考虑一个简单的两点移动平均滤波器，这是一种有限冲激响应（FIR）滤波器，通常用于实时数据流中的基本降噪。该滤波器的传递函数由下式给出：\n\n$$H(z) = 0.5(1 + z^{-1})$$\n\n请确定此特定移动平均滤波器的两个多相分量滤波器 $E_0(z)$ 和 $E_1(z)$。你的最终答案应为 $E_0(z)$ 和 $E_1(z)$ 的表达式对。", "solution": "我们从给定的两点移动平均 FIR 滤波器的传递函数开始\n$$H(z) = \\frac{1}{2}\\left(1 + z^{-1}\\right).$$\n根据定义，一个 FIR 传递函数可以写作\n$$H(z) = \\sum_{n=0}^{\\infty} h[n] z^{-n},$$\n由此我们可以确定其冲激响应系数为 $h[0] = \\frac{1}{2}$，$h[1] = \\frac{1}{2}$，以及对于所有其他 $n$，$h[n] = 0$。\n\n对于 $M=2$ 的多相分解，第一类多相分量 $E_{0}(z)$ 和 $E_{1}(z)$ 是通过将 $h[n]$ 分解为其偶数索引和奇数索引部分来定义的：\n$$E_{0}(z) = \\sum_{k=0}^{\\infty} h[2k] z^{-k}, \\qquad E_{1}(z) = \\sum_{k=0}^{\\infty} h[2k+1] z^{-k},$$\n并且它们满足\n$$H(z) = E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right).$$\n\n计算 $E_{0}(z)$：\n- 唯一非零的偶数索引系数是 $h[0] = \\frac{1}{2}$，对应于 $k=0$。因此，\n$$E_{0}(z) = \\frac{1}{2}.$$\n\n计算 $E_{1}(z)$：\n- 唯一非零的奇数索引系数是 $h[1] = \\frac{1}{2}$，对应于 $k=0$。因此，\n$$E_{1}(z) = \\frac{1}{2}.$$\n\n验证：\n$$E_{0}\\left(z^{2}\\right) + z^{-1} E_{1}\\left(z^{2}\\right) = \\frac{1}{2} + z^{-1}\\left(\\frac{1}{2}\\right) = \\frac{1}{2}\\left(1 + z^{-1}\\right) = H(z),$$\n这与给定的传递函数相匹配。\n\n因此，多相分量为 $E_{0}(z) = \\frac{1}{2}$ 和 $E_{1}(z) = \\frac{1}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  \\frac{1}{2}\\end{pmatrix}}$$", "id": "1737208"}, {"introduction": "掌握了基础的双相分解后，下一步自然是将其推广到更一般的情况。这个练习 [@problem_id:1742747] 将分解的相数从两相扩展到三相，这对于理解像通用滤波器组这样更复杂的多速率系统至关重要。它表明，分解原理是通用的，并不仅限于滤波器对，从而加深你对多相表示的理解。", "problem": "一个因果离散时间有限冲激响应（FIR）滤波器的冲激响应为 $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$。为了高效地进行硬件实现，该滤波器将使用3相多相分解来实现。多相分量序列，记为 $e_0[n]$、$e_1[n]$ 和 $e_2[n]$，由原始冲激响应 $h[n]$ 通过关系式 $e_k[n] = h[3n+k]$ 定义，其中 $k \\in \\{0, 1, 2\\}$。\n\n求这三个多相分量序列的Z变换，分别记为 $E_0(z)$、$E_1(z)$ 和 $E_2(z)$。", "solution": "该问题要求解冲激响应为 $h[n] = 2\\delta[n] - \\delta[n-1] + 3\\delta[n-3] - 4\\delta[n-5]$ 的FIR滤波器的3相多相分量。\n冲激响应的非零值为：\n$h[0] = 2$\n$h[1] = -1$\n$h[2] = 0$\n$h[3] = 3$\n$h[4] = 0$\n$h[5] = -4$\n对于所有其他非负整数 $n$，$h[n]=0$。\n\n多相分量 $e_k[n]$ 由关系式 $e_k[n] = h[Mn+k]$ 定义，其中相数 $M=3$。我们将通过对原始序列进行降采样来确定 $k=0, 1, 2$ 时的每个分量序列 $e_k[n]$，然后求出它们各自的Z变换 $E_k(z)$。\n\n首先，我们确定分量序列 $e_0[n]$。该分量由 $h[n]$ 从第一个样本（$n=0$）开始，每隔三个样本取一个样本形成。定义为 $e_0[n] = h[3n]$。\n当 $n=0$ 时：$e_0[0] = h[3 \\cdot 0] = h[0] = 2$。\n当 $n=1$ 时：$e_0[1] = h[3 \\cdot 1] = h[3] = 3$。\n当 $n \\geq 2$ 时，索引 $3n$ 将是 $6, 9, 12, \\dots$。由于当 $m > 5$ 时 $h[m]=0$，因此对于 $n \\geq 2$ 的所有后续值 $e_0[n]$ 均为零。\n所以，序列 $e_0[n]$ 由 $e_0[n] = 2\\delta[n] + 3\\delta[n-1]$ 给出。\n$e_0[n]$ 的Z变换为 $E_0(z) = \\mathcal{Z}\\{e_0[n]\\}$，即：\n$E_0(z) = \\mathcal{Z}\\{2\\delta[n] + 3\\delta[n-1]\\} = 2(1) + 3(z^{-1}) = 2 + 3z^{-1}$。\n\n接下来，我们确定分量序列 $e_1[n]$。该分量由 $h[n]$ 从第二个样本（$n=1$）开始，每隔三个样本取一个样本形成。定义为 $e_1[n] = h[3n+1]$。\n当 $n=0$ 时：$e_1[0] = h[3 \\cdot 0 + 1] = h[1] = -1$。\n当 $n=1$ 时：$e_1[1] = h[3 \\cdot 1 + 1] = h[4] = 0$。\n当 $n \\geq 1$ 时，索引 $3n+1$ 将是 $4, 7, 10, \\dots$。由于对于这些索引（除了我们已经处理过的 $h[1]$），$h[m]=0$，因此对于 $n \\geq 1$ 的所有后续值 $e_1[n]$ 均为零。\n所以，序列 $e_1[n]$ 由 $e_1[n] = -1 \\cdot \\delta[n]$ 给出。\n$e_1[n]$ 的Z变换为 $E_1(z) = \\mathcal{Z}\\{e_1[n]\\}$：\n$E_1(z) = \\mathcal{Z}\\{-\\delta[n]\\} = -1$。\n\n最后，我们确定分量序列 $e_2[n]$。该分量由 $h[n]$ 从第三个样本（$n=2$）开始，每隔三个样本取一个样本形成。定义为 $e_2[n] = h[3n+2]$。\n当 $n=0$ 时：$e_2[0] = h[3 \\cdot 0 + 2] = h[2] = 0$。\n当 $n=1$ 时：$e_2[1] = h[3 \\cdot 1 + 2] = h[5] = -4$。\n当 $n \\geq 2$ 时，索引 $3n+2$ 将是 $8, 11, \\dots$。由于对于这些索引 $h[m]=0$，因此对于 $n \\geq 2$ 的所有后续值 $e_2[n]$ 均为零。\n所以，序列 $e_2[n]$ 由 $e_2[n] = -4\\delta[n-1]$ 给出。\n$e_2[n]$ 的Z变换为 $E_2(z) = \\mathcal{Z}\\{e_2[n]\\}$：\n$E_2(z) = \\mathcal{Z}\\{-4\\delta[n-1]\\} = -4z^{-1}$。\n\n总结一下，这三个多相分量的Z变换是：\n$E_0(z) = 2 + 3z^{-1}$\n$E_1(z) = -1$\n$E_2(z) = -4z^{-1}$", "answer": "$$\\boxed{\\begin{pmatrix} 2 + 3z^{-1}  -1  -4z^{-1} \\end{pmatrix}}$$", "id": "1742747"}, {"introduction": "除了分解单个滤波器，理解多相分量在系统组合下的行为也同样重要。这个更具分析性的练习 [@problem_id:1742749] 探讨了一个基本问题：当我们级联两个系统时，其整体的多相分量是如何构成的？通过分析级联系统，这个问题揭示了多相分量的代数结构，为学习高级滤波器组设计中强大的多相矩阵方法奠定了基础。", "problem": "在高效的多速率数字信号处理系统设计中，滤波器通常使用其多相分量来实现。考虑一个滤波系统 $H(z)$，它通过级联两个有限脉冲响应 (FIR) 滤波器 $H_1(z)$ 和 $H_2(z)$ 来实现，使得总传递函数为 $H(z) = H_1(z)H_2(z)$。\n\n各个滤波器的传递函数由下式给出：\n$H_1(z) = a_0 + a_1 z^{-1} + a_2 z^{-2}$\n$H_2(z) = b_0 + b_1 z^{-1}$\n其中 $a_0, a_1, a_2, b_0,$ 和 $b_1$ 是常实系数。\n\n为了高效实现，总滤波器 $H(z)$ 将使用其2相（类型1）多相分解来表示，其定义如下：\n$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$\n这里，$E_0(z)$ 和 $E_1(z)$ 是 $H(z)$ 的两个多相分量。\n\n确定级联系统 $H(z)$ 的多相分量 $E_0(z)$ 和 $E_1(z)$ 的传递函数。用系数 $a_0, a_1, a_2, b_0, b_1$ 来表示您的答案。将您的最终答案以 $1 \\times 2$ 行矩阵的形式 $\\begin{pmatrix} E_0(z)  E_1(z) \\end{pmatrix}$ 呈现。", "solution": "我们从传递函数为下式的级联 FIR 滤波器开始\n$$H_{1}(z)=a_{0}+a_{1}z^{-1}+a_{2}z^{-2}, \\quad H_{2}(z)=b_{0}+b_{1}z^{-1}.$$\n总传递函数是二者之积\n$$H(z)=H_{1}(z)H_{2}(z).$$\n通过多项式乘法，\n$$\n\\begin{aligned}\nH(z)=(a_{0}+a_{1}z^{-1}+a_{2}z^{-2})(b_{0}+b_{1}z^{-1})\\\\\n=a_{0}b_{0}+(a_{0}b_{1}+a_{1}b_{0})z^{-1}+(a_{1}b_{1}+a_{2}b_{0})z^{-2}+a_{2}b_{1}z^{-3}.\n\\end{aligned}\n$$\n因此，如果我们用 $h[n]$ 表示脉冲响应系数，我们有\n$$h[0]=a_{0}b_{0},\\quad h[1]=a_{0}b_{1}+a_{1}b_{0},\\quad h[2]=a_{1}b_{1}+a_{2}b_{0},\\quad h[3]=a_{2}b_{1}.$$\n对于2相（类型1）多相分解，其定义为\n$$H(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2}),$$\n其中多相分量分别收集偶数索引和奇数索引的采样点：\n$$E_{0}(z)=\\sum_{k}h[2k]z^{-k},\\qquad E_{1}(z)=\\sum_{k}h[2k+1]z^{-k}.$$\n使用计算出的 $h[n]$，我们得到\n$$E_{0}(z)=h[0]+h[2]z^{-1}=a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1},$$\n$$E_{1}(z)=h[1]+h[3]z^{-1}=\\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}.$$\n因此，所求的 $1\\times 2$ 行矩阵为\n$$\\begin{pmatrix}E_{0}(z)  E_{1}(z)\\end{pmatrix}=\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1}  \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}a_{0}b_{0}+\\left(a_{1}b_{1}+a_{2}b_{0}\\right)z^{-1}  \\left(a_{0}b_{1}+a_{1}b_{0}\\right)+a_{2}b_{1}z^{-1}\\end{pmatrix}}$$", "id": "1742749"}]}