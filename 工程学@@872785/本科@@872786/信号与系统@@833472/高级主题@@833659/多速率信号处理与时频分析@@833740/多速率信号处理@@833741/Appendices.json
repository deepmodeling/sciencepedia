{"hands_on_practices": [{"introduction": "多速率信号处理的核心操作之一是抽取（decimation），它能有效降低信号的采样率。这个过程包括两个关键步骤：首先使用低通滤波器防止频率混叠，然后通过下采样（downsampling）来移除多余的样本。本练习将带你亲手完成一个完整的抽取流程，通过计算一个简单信号经过滤波和下采样的结果，来具体理解这一基本操作的每个环节。[@problem_id:1737262]", "problem": "在一个用于数据压缩的数字信号处理系统中，一个传感器的输出被建模为一个有限长离散时间信号 $x[n]$。该信号首先由一个低通有限冲激响应 (FIR) 滤波器处理，然后进行降采样。\n\n输入信号 $x[n]$ 定义为：\n$$\nx[n] = (n+1) \\quad \\text{for} \\quad 0 \\le n \\le 3\n$$\n且对于所有其他 $n$ 值，$x[n] = 0$。\n\nFIR 滤波器的冲激响应 $h[n]$ 由下式给出：\n$$\nh[n] = 0.5\\delta[n] + 0.5\\delta[n-1]\n$$\n其中 $\\delta[n]$ 是克罗内克 delta 函数。\n\n从滤波器输出的信号，我们称之为 $w[n]$，然后以整数因子 $M=2$ 进行降采样。降采样操作定义为，最终输出信号 $y[n]$ 由 $y[n] = w[2n]$ 给出。\n\n下列哪个表达式正确地表示了最终输出信号 $y[n]$？\n\nA. $y[n] = \\delta[n] + 3\\delta[n-1]$\n\nB. $y[n] = 0.5\\delta[n] + 2\\delta[n-1] + 1.5\\delta[n-2]$\n\nC. $y[n] = 0.5\\delta[n] + 2.5\\delta[n-1]$\n\nD. $y[n] = 1.5\\delta[n] + 3.5\\delta[n-1]$\n\nE. $y[n] = 0.5\\delta[n] + 2.5\\delta[n-1] + 2\\delta[n-2]$", "solution": "我们给定一个有限长离散时间信号，定义为当 $0 \\leq n \\leq 3$ 时 $x[n]=(n+1)$，否则 $x[n]=0$。因此，显式地，$x[0]=1$，$x[1]=2$，$x[2]=3$，$x[3]=4$，且对于所有其他 $n$，$x[n]=0$。FIR 滤波器的冲激响应为 $h[n]=\\frac{1}{2}\\delta[n]+\\frac{1}{2}\\delta[n-1]$。令 $w[n]=(x*h)[n]$ 表示滤波器的输出，其中卷积定义为\n$$\nw[n]=\\sum_{k=-\\infty}^{\\infty} x[k]\\,h[n-k].\n$$\n代入 $h[n-k]=\\frac{1}{2}\\delta[n-k]+\\frac{1}{2}\\delta[n-k-1]$，并利用克罗内克 delta 函数的线性和筛选特性，我们得到\n$$\nw[n]=\\frac{1}{2}\\sum_{k} x[k]\\delta[n-k]+\\frac{1}{2}\\sum_{k} x[k]\\delta[n-k-1]\n=\\frac{1}{2}x[n]+\\frac{1}{2}x[n-1].\n$$\n使用 $x[n]$ 的值，我们计算 $w[n]$ 在其可能非零的索引处的值：\n- 对于 $n0$，$w[n]=0$。\n- $n=0$: $w[0]=\\frac{1}{2}x[0]+\\frac{1}{2}x[-1]=\\frac{1}{2}\\cdot 1+0=\\frac{1}{2}$。\n- $n=1$: $w[1]=\\frac{1}{2}x[1]+\\frac{1}{2}x[0]=\\frac{1}{2}\\cdot 2+\\frac{1}{2}\\cdot 1=\\frac{3}{2}$。\n- $n=2$: $w[2]=\\frac{1}{2}x[2]+\\frac{1}{2}x[1]=\\frac{1}{2}\\cdot 3+\\frac{1}{2}\\cdot 2=\\frac{5}{2}$。\n- $n=3$: $w[3]=\\frac{1}{2}x[3]+\\frac{1}{2}x[2]=\\frac{1}{2}\\cdot 4+\\frac{1}{2}\\cdot 3=\\frac{7}{2}$。\n- $n=4$: $w[4]=\\frac{1}{2}x[4]+\\frac{1}{2}x[3]=0+\\frac{1}{2}\\cdot 4=2$。\n- 对于 $n\\geq 5$，$w[n]=0$。\n以因子 $M=2$ 进行降采样得到 $y[n]=w[2n]$，因此\n$$\ny[0]=w[0]=\\frac{1}{2},\\quad y[1]=w[2]=\\frac{5}{2},\\quad y[2]=w[4]=2,\\quad y[n]=0\\ \\text{for all other}\\ n.\n$$\n因此，用移位的克罗内克 delta 函数表示，\n$$\ny[n]=\\frac{1}{2}\\delta[n]+\\frac{5}{2}\\delta[n-1]+2\\delta[n-2],\n$$\n这与选项 E 相符。", "answer": "$$\\boxed{E}$$", "id": "1737262"}, {"introduction": "在了解了抽取的基本流程后，一个关键问题是：如果省略了抗混叠滤波器会发生什么？这个思想实验揭示了多速率系统中的一个核心陷阱——混叠（aliasing）。通过分析一个正弦信号在没有预滤波的情况下被下采样的后果，你将直观地看到信号频率是如何被错误地“折叠”到新的基带中的，从而深刻理解抗混叠滤波的必要性。[@problem_id:1737237]", "problem": "在一个用于监测工业机械的数字信号处理系统中，一个传感器捕获了一个振动信号。由于系统的特性，该信号的主要分量可以很好地用离散时间正弦信号 $x[n] = \\cos(\\omega_0 n)$ 来建模，其中 $n$ 是采样点索引。测得振动的归一化角频率为 $\\omega_0 = \\frac{5\\pi}{6}$ 弧度/采样点。\n\n为了减少传输到中央服务器的数据量，该信号被以一个整数因子 $M=4$ 进行降采样。这个过程，即降采样，会创建一个新信号 $y[n] = x[Mn]$。关键的是，为了简化硬件，在降采样操作之前没有使用抗混叠低通滤波器。\n\n由于没有抗混叠滤波器，所得到的信号 $y[n]$ 将会是一个正弦信号，但其频率可能会因混叠而改变。确定输出信号 $y[n]$ 中正弦信号的归一化角频率 $\\omega_a$。以弧度/采样点为单位，将频率报告为在 $[0, \\pi]$ 范围内的正值的精确表达式。", "solution": "原始的离散时间信号由 $x[n] = \\cos(\\omega_0 n)$ 给出，其初始归一化角频率为 $\\omega_0 = \\frac{5\\pi}{6}$ 弧度/采样点。\n\n该信号以因子 $M=4$ 进行降采样。降采样操作的定义是通过取原始信号的每第 $M$ 个采样点来创建一个新信号 $y[n]$。在数学上，这表示为 $y[n] = x[Mn]$。\n\n将 $x[n]$ 的表达式和 $M$ 的值代入 $y[n]$ 的定义中，我们得到：\n$$y[n] = x[4n] = \\cos\\left(\\omega_0 \\cdot 4n\\right) = \\cos\\left(\\frac{5\\pi}{6} \\cdot 4n\\right)$$\n简化频率项的表达式：\n$$y[n] = \\cos\\left(\\frac{20\\pi}{6} n\\right) = \\cos\\left(\\frac{10\\pi}{3} n\\right)$$\n得到的信号 $y[n]$ 也是一个正弦信号，其表观频率为 $\\omega_y = \\frac{10\\pi}{3}$ 弧度/采样点。\n\n在离散时间信号处理中，信号的频率内容以 $2\\pi$ 为周期是周期性的。这意味着任何两个频率 $\\omega$ 和 $\\omega + 2\\pi k$（其中 $k$ 是整数）是无法区分的，并被称为彼此的混叠。按照惯例，我们用其主值（principal alias）来表示离散时间正弦信号的唯一频率，该值位于区间 $(-\\pi, \\pi]$ 内。\n\n为了找到 $\\omega_y = \\frac{10\\pi}{3}$ 的主值 $\\omega_a$，我们需要找到一个整数 $k$，使得 $\\omega_a = \\omega_y - 2\\pi k$ 落在范围 $(-\\pi, \\pi]$ 内。\n即：\n$$-\\pi  \\frac{10\\pi}{3} - 2\\pi k \\le \\pi$$\n将不等式各边同除以 $\\pi$：\n$$-1  \\frac{10}{3} - 2k \\le 1$$\n各边同减去 $\\frac{10}{3}$：\n$$-1 - \\frac{10}{3}  -2k \\le 1 - \\frac{10}{3}$$\n$$-\\frac{13}{3}  -2k \\le -\\frac{7}{3}$$\n各边同乘以 $-\\frac{1}{2}$ 并反转不等号：\n$$\\frac{13}{6} > k \\ge \\frac{7}{6}$$\n即 $2.166... > k \\ge 1.166...$。\n此范围内的唯一整数是 $k=2$。\n\n因此，主值是：\n$$\\omega_a = \\frac{10\\pi}{3} - 2\\pi(2) = \\frac{10\\pi}{3} - 4\\pi = \\frac{10\\pi - 12\\pi}{3} = -\\frac{2\\pi}{3}$$\n这个值正确地落在 $(-\\pi, \\pi]$ 范围内。\n\n问题要求将频率报告为在 $[0, \\pi]$ 范围内的正值。由于余弦函数是偶函数，$\\cos(-\\theta) = \\cos(\\theta)$，一个具有负频率 $-\\omega_a$ 的信号与一个具有正频率 $\\omega_a$ 的信号是无法区分的。\n因此，信号 $y[n] = \\cos\\left(-\\frac{2\\pi}{3} n\\right)$ 与 $y[n] = \\cos\\left(\\frac{2\\pi}{3} n\\right)$ 是相同的。\n\n混叠后正弦信号的正归一化角频率是 $|\\omega_a| = \\left|-\\frac{2\\pi}{3}\\right| = \\frac{2\\pi}{3}$ 弧度/采样点。此频率在要求的范围 $[0, \\pi]$ 内。", "answer": "$$\\boxed{\\frac{2\\pi}{3}}$$", "id": "1737237"}, {"introduction": "在实际工程应用中，例如软件定义无线电，我们常常需要大幅降低采样率。直接用单级抽取器实现大倍率的抽取，其计算成本可能高得惊人，因为这要求一个非常尖锐的抗混叠滤波器。为了解决这个问题，工程师们通常采用多级抽取（multistage decimation）的策略，本练习将引导你从系统优化的角度出发，建立一个简化的计算成本模型，并推导出如何最佳地分配各级抽取因子，以实现最低的计算复杂度。[@problem_id:1737252]", "problem": "在现代软件定义无线电 (SDR) 的设计中，高效的采样率转换是一项关键任务。考虑一个将信号以一个大的整数因子 $M$ 进行抽取的问题。为了控制计算复杂度，这通常被实现为一个两级过程。总抽取因子被分解为 $M = M_1 M_2$，其中第一级以 $M_1$ 进行抽取，第二级以 $M_2$ 进行抽取。每一级都由一个抗混叠有限冲激响应 (FIR) 滤波器和一个降采样器组成。您的目标是确定能使总计算成本最小化的最优分解。需要使用以下模型：\n\n1.  总计算成本 $R$ 是两级成本之和，即 $R = R_1 + R_2$。\n2.  第 $k$ 级的成本，记为 $R_k$，以每秒操作次数为单位。它与其 FIR 滤波器的阶数 $N_k$ 和其输入端的采样率 $f_{\\text{in},k}$ 都成正比。假设比例常数 $\\mathcal{C}$ 对两级都相同。因此，$R_k = \\mathcal{C} N_k f_{\\text{in},k}$。\n3.  滤波器阶数 $N_k$ 由其截止的陡峭程度决定。对于许多滤波器设计方法，阶数与滤波器的过渡带宽 $\\Delta f_k$ 成反比。设此关系为 $N_k = \\mathcal{A} / \\Delta f_k$，其中 $\\mathcal{A}$ 是一个与期望的通带和阻带波纹相关的常数。\n4.  在本分析中，采用一个简化的设计模型，其中第 $k$ 级（以因子 $M_k$ 进行抽取）的抗混叠滤波器的过渡带宽 $\\Delta f_k$ 被假定为与该级*输出*信号的奈奎斯特频率成正比。输出采样率为 $f_{\\text{out},k} = f_{\\text{in},k} / M_k$。奈奎斯特频率为 $f_{\\text{out},k} / 2$。设比例常数为 $\\mathcal{B}$，因此 $\\Delta f_k = \\mathcal{B} \\frac{f_{\\text{in},k}}{2 M_k}$。\n\n进入第一级的信号的初始采样率为 $f_s$。为了优化的目的，将抽取因子 $M_1$ 和 $M_2$ 视为连续的正实数变量。\n\n基于此模型，推导使总计算成本 $R$ 最小化的最优第一级抽取因子 $M_{1,\\text{opt}}$ 的表达式。用总抽取因子 $M$ 表示您的最终答案。", "solution": "总计算成本建模为 $R=R_{1}+R_{2}$，每一级的成本由 $R_{k}=\\mathcal{C}N_{k}f_{\\text{in},k}$ 给出。滤波器阶数为 $N_{k}=\\mathcal{A}/\\Delta f_{k}$，过渡带宽为 $\\Delta f_{k}=\\mathcal{B}\\frac{f_{\\text{in},k}}{2M_{k}}$。\n\n首先，我们推导单级成本 $R_k$ 的表达式。将 $\\Delta f_{k}$ 的表达式代入 $N_{k}$：\n$$\nN_{k}=\\frac{\\mathcal{A}}{\\Delta f_{k}}=\\frac{\\mathcal{A}}{\\mathcal{B}\\frac{f_{\\text{in},k}}{2M_{k}}}=\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M_{k}}{f_{\\text{in},k}}.\n$$\n现在，将 $N_k$ 的表达式代入 $R_k$：\n$$\nR_{k}=\\mathcal{C}N_{k}f_{\\text{in},k}=\\mathcal{C}\\left(\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M_{k}}{f_{\\text{in},k}}\\right)f_{\\text{in},k}=\\frac{2\\mathcal{A}\\mathcal{C}}{\\mathcal{B}}M_{k}.\n$$\n令常数 $K = \\frac{2\\mathcal{A}\\mathcal{C}}{\\mathcal{B}}$，则 $R_k = K M_k$。这个结果表明，在此模型下，一级的成本与其抽取因子成正比。然而，这是不正确的，因为我们没有正确地将各级联系起来。让我们重新计算 $R_1$ 和 $R_2$。\n\n- **第 1 级**:\n输入采样率为 $f_{\\text{in},1} = f_s$，抽取因子为 $M_1$。\n过渡带宽: $\\Delta f_{1}=\\mathcal{B}\\frac{f_{\\text{in},1}}{2M_{1}} = \\mathcal{B}\\frac{f_{s}}{2M_{1}}$\n滤波器阶数: $N_{1}=\\frac{\\mathcal{A}}{\\Delta f_{1}}=\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M_{1}}{f_{s}}$\n成本: $R_{1}=\\mathcal{C}N_{1}f_{\\text{in},1}=\\mathcal{C}\\left(\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M_{1}}{f_{s}}\\right)f_{s}=\\frac{2\\mathcal{A}\\mathcal{C}}{\\mathcal{B}}M_{1}$.\n\n- **第 2 级**:\n输入采样率为 $f_{\\text{in},2} = f_s / M_1$，抽取因子为 $M_2$。总抽取因子 $M = M_1 M_2$。\n过渡带宽: $\\Delta f_{2}=\\mathcal{B}\\frac{f_{\\text{in},2}}{2M_{2}}=\\mathcal{B}\\frac{f_{s}/M_{1}}{2M_{2}}=\\mathcal{B}\\frac{f_{s}}{2M_1 M_2} = \\mathcal{B}\\frac{f_{s}}{2M}$\n滤波器阶数: $N_{2}=\\frac{\\mathcal{A}}{\\Delta f_{2}}=\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M}{f_{s}}$\n成本: $R_{2}=\\mathcal{C}N_{2}f_{\\text{in},2}=\\mathcal{C}\\left(\\frac{2\\mathcal{A}}{\\mathcal{B}}\\frac{M}{f_{s}}\\right)\\left(\\frac{f_{s}}{M_{1}}\\right)=\\frac{2\\mathcal{A}\\mathcal{C}}{\\mathcal{B}}\\frac{M}{M_{1}}$.\n\n因此，总成本为\n$$\nR=R_{1}+R_{2}=\\frac{2\\mathcal{A}\\mathcal{C}}{\\mathcal{B}}\\left(M_{1}+\\frac{M}{M_{1}}\\right).\n$$\n为了在正实数 $M_1$ 上最小化 $R$，我们只需最小化函数 $g(M_{1})=M_{1}+\\frac{M}{M_{1}}$。计算其导数并令其为零：\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}M_{1}}=1-\\frac{M}{M_{1}^{2}}=0\\quad\\Longrightarrow\\quad M_{1}^{2}=M\\quad\\Longrightarrow\\quad M_{1}=\\sqrt{M}.\n$$\n二阶导数为 $\\frac{\\mathrm{d}^{2}g}{\\mathrm{d}M_{1}^{2}}=\\frac{2M}{M_{1}^{3}} > 0$（因为 $M$ 和 $M_1$ 都是正数），这确认了该点是一个最小值。\n\n因此，最优的第一级抽取因子是 $M_{1,\\text{opt}}=\\sqrt{M}$ 或 $M^{1/2}$。", "answer": "$$\\boxed{M^{1/2}}$$", "id": "1737252"}]}