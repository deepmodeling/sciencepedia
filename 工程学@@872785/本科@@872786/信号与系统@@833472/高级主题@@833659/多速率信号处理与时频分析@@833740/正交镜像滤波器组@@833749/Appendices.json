{"hands_on_practices": [{"introduction": "正交镜像滤波器（QMF）组的一个核心设计理念是，所有四个滤波器（分析低通/高通，综合低通/高通）均由一个原型低通滤波器衍生而来。这个练习将帮助你巩固对这些滤波器之间基本关系的理解。通过从给定的分析低通滤波器出发，推导综合高通滤波器的脉冲响应，你将能熟练掌握定义QMF滤波器的调制和时间反转操作[@problem_id:1746359]。", "problem": "在双通道正交镜像滤波器 (QMF) 组的设计中，涉及四个滤波器：低通分析滤波器 ($h_0[n]$)、高通分析滤波器 ($h_1[n]$)、低通合成滤波器 ($g_0[n]$) 和高通合成滤波器 ($g_1[n]$)。为了消除混叠，这些滤波器通常通过以下条件相关联：\n1. 高通分析滤波器是低通分析滤波器的调制版本：$h_1[n] = (-1)^n h_0[n]$。\n2. 合成滤波器是其相应分析滤波器的时间反转版本：$g_0[n] = h_0[-n]$ 和 $g_1[n] = h_1[-n]$。\n\n假设一位工程师为低通分析阶段选择了一个简单的有限脉冲响应 (FIR) 滤波器，其脉冲响应由下式给出：\n$$h_0[n] = \\delta[n] + \\delta[n-1]$$\n其中 $\\delta[n]$ 是克罗内克 delta 函数。\n\n确定相应的高通合成滤波器的脉冲响应 $g_1[n]$。用克罗内克 delta 函数表示你的答案。", "solution": "题目要求我们从低通分析滤波器的脉冲响应 $h_0[n]$ 出发，求出高通合成滤波器 $g_1[n]$ 的脉冲响应。我们将分两步使用题目中给出的关系式。\n\n首先，我们根据低通分析滤波器 $h_0[n]$ 确定高通分析滤波器 $h_1[n]$ 的脉冲响应。其关系式如下：\n$$h_1[n] = (-1)^n h_0[n]$$\n给定 $h_0[n] = \\delta[n] + \\delta[n-1]$。将其代入 $h_1[n]$ 的方程中，得到：\n$$h_1[n] = (-1)^n (\\delta[n] + \\delta[n-1])$$\n我们可以将调制项 $(-1)^n$ 分配到括号内的两项：\n$$h_1[n] = (-1)^n \\delta[n] + (-1)^n \\delta[n-1]$$\n为了简化这个表达式，我们使用克罗内克 delta 函数的筛选特性，即对于任意函数 $f[n]$，我们有 $f[n]\\delta[n-k] = f[k]\\delta[n-k]$。\n对于第一项 $(-1)^n \\delta[n]$，delta 函数仅在 $n=0$ 时非零。我们在 $n=0$ 处计算 $(-1)^n$ 的值：\n$$(-1)^n \\delta[n] = (-1)^0 \\delta[n] = 1 \\cdot \\delta[n] = \\delta[n]$$\n对于第二项 $(-1)^n \\delta[n-1]$，delta 函数仅在 $n=1$ 时非零。我们在 $n=1$ 处计算 $(-1)^n$ 的值：\n$$(-1)^n \\delta[n-1] = (-1)^1 \\delta[n-1] = -1 \\cdot \\delta[n-1] = -\\delta[n-1]$$\n综合这些结果，高通分析滤波器的脉冲响应为：\n$$h_1[n] = \\delta[n] - \\delta[n-1]$$\n\n其次，我们根据高通分析滤波器 $h_1[n]$ 确定高通合成滤波器 $g_1[n]$ 的脉冲响应。其关系式如下：\n$$g_1[n] = h_1[-n]$$\n这个操作对应于对脉冲响应 $h_1[n]$ 进行时间反转。为此，我们将我们刚推导出的 $h_1[n]$ 表达式中所有的 $n$ 替换为 $-n$：\n$$g_1[n] = \\delta[-n] - \\delta[-n-1]$$\n最后，我们使用克罗内克 delta 函数的标准性质来简化这个表达式。delta 函数是一个偶函数，这意味着对于任意整数 $k$，都有 $\\delta[-k] = \\delta[k]$。\n将此性质应用于第一项，得到：\n$$\\delta[-n] = \\delta[n]$$\n对于第二项，我们可以从 delta 函数的参数中提出负号：\n$$\\delta[-n-1] = \\delta[-(n+1)]$$\n再次对这一项使用偶函数性质，我们得到 $\\delta[-(n+1)] = \\delta[n+1]$。\n将这些简化后的形式代回 $g_1[n]$ 的表达式中，我们得到最终答案：\n$$g_1[n] = \\delta[n] - \\delta[n+1]$$", "answer": "$$\\boxed{\\delta[n] - \\delta[n+1]}$$", "id": "1746359"}, {"introduction": "滤波器组设计的核心目标之一是实现信号的完美重构，即输出信号是输入信号的精确延迟版本。这个练习将带你从理论走向实践，挑战你设计一个满足完美重构条件的QMF原型滤波器。通过求解特定的系统传输函数，你将确定滤波器的系数，从而亲身体验如何将抽象的设计要求转化为具体的滤波器参数[@problem_id:1746348]。", "problem": "双通道正交镜像滤波器（QMF）组是数字信号处理中用于将信号分割为子带的常用结构。该滤波器组由一个分析部分和一个合成部分组成。分析部分包含一个低通滤波器 $H_0(z)$ 和一个高通滤波器 $H_1(z)$；合成部分包含滤波器 $G_0(z)$ 和 $G_1(z)$。\n\n在本题中，我们考虑一种标准的QMF设计，其中所有滤波器都由一个原型低通有限脉冲响应（FIR）滤波器 $H_0(z)$ 定义，具体如下：\n- 分析高通滤波器：$H_1(z) = H_0(-z)$\n- 合成低通滤波器：$G_0(z) = H_0(z)$\n- 合成高通滤波器：$G_1(z) = -H_0(-z)$\n\n通过这样的选择，混叠被完全消除。系统的总传递函数 $T(z)$ 将重建输出 $\\hat{X}(z)$ 与输入 $X(z)$ 关联起来，其关系为 $\\hat{X}(z) = T(z)X(z)$，由下式给出：\n$$T(z) = \\frac{1}{2}\\left[H_0(z)^2 - H_0(-z)^2\\right]$$\n\n你的任务是设计原型滤波器 $H_0(z)$。该滤波器被指定为一个4抽头（4-tap）的FIR滤波器，\n$$H_0(z) = b_0 + b_1 z^{-1} + b_2 z^{-2} + b_3 z^{-3}$$\n此外，该滤波器必须具有广义线性相位，对于其长度，这要求其系数满足对称条件：$b_k = b_{3-k}$，其中 $k \\in \\{0, 1, 2, 3\\}$。\n\n设计目标是使整个系统能实现对输入信号的完美重建，但允许有3个样本的延迟。这意味着总传递函数必须为 $T(z) = z^{-3}$。\n\n确定四个滤波器系数 $b_0, b_1, b_2, b_3$ 的数值。虽然可能存在多个解，但请提供系数 $b_0$ 为正值的特定解。将你的最终答案表示为系数集合 $(b_0, b_1, b_2, b_3)$，每个值四舍五入到三位有效数字。", "solution": "本题要求我们为一个QMF滤波器组找到一个4抽头线性相位FIR滤波器 $H_0(z)$ 的系数，使得整个系统的传递函数为 $T(z) = z^{-3}$。\n\n首先，我们根据线性相位约束写出滤波器 $H_0(z)$ 的形式。滤波器由 $H_0(z) = b_0 + b_1 z^{-1} + b_2 z^{-2} + b_3 z^{-3}$ 给出。线性相位对称条件是 $b_k = b_{3-k}$。这意味着：\n当 $k=0$ 时，$b_0 = b_3$。\n当 $k=1$ 时，$b_1 = b_2$。\n因此，该滤波器的传递函数可以写成只含两个未知系数 $b_0$ 和 $b_1$ 的形式：\n$$H_0(z) = b_0 + b_1 z^{-1} + b_1 z^{-2} + b_0 z^{-3}$$\n\n接下来，我们计算总系统传递函数 $T(z) = \\frac{1}{2}\\left[H_0(z)^2 - H_0(-z)^2\\right]$。为此，我们首先求出 $H_0(-z)$：\n$$H_0(-z) = b_0 + b_1 (-z)^{-1} + b_1 (-z)^{-2} + b_0 (-z)^{-3}$$\n$$H_0(-z) = b_0 - b_1 z^{-1} + b_1 z^{-2} - b_0 z^{-3}$$\n\n为了简化 $H_0(z)^2 - H_0(-z)^2$ 的计算，我们可以使用多相表示法。一个滤波器的传递函数 $H(z)$ 可以分解为其偶数索引和奇数索引系数部分，$H(z) = P_0(z^2) + z^{-1}P_1(z^2)$。\n对于我们的 $H_0(z)$：\n偶数索引的系数是 $b_0$ 和 $b_1$（在位置 $n=0$ 和 $n=2$ 处）。所以，$P_0(z^2) = b_0 + b_1 z^{-2}$。\n奇数索引的系数是 $b_1$ 和 $b_0$（在位置 $n=1$ 和 $n=3$ 处）。所以，$P_1(z^2) = b_1 + b_0 z^{-2}$。\n\n因此，$H_0(z) = (b_0 + b_1 z^{-2}) + z^{-1}(b_1 + b_0 z^{-2})$。\n并且 $H_0(-z) = (b_0 + b_1 z^{-2}) - z^{-1}(b_1 + b_0 z^{-2})$。\n\n现在我们可以计算 $T(z)$：\n$$T(z) = \\frac{1}{2} \\left[ \\left( P_0(z^2) + z^{-1}P_1(z^2) \\right)^2 - \\left( P_0(z^2) - z^{-1}P_1(z^2) \\right)^2 \\right]$$\n展开平方项：\n$$T(z) = \\frac{1}{2} \\left[ (P_0^2 + 2z^{-1}P_0P_1 + z^{-2}P_1^2) - (P_0^2 - 2z^{-1}P_0P_1 + z^{-2}P_1^2) \\right]$$\n$$T(z) = \\frac{1}{2} \\left[ 4z^{-1}P_0(z^2)P_1(z^2) \\right] = 2z^{-1}P_0(z^2)P_1(z^2)$$\n\n现在，我们代入 $P_0(z^2)$ 和 $P_1(z^2)$ 的表达式：\n$$T(z) = 2z^{-1}(b_0 + b_1 z^{-2})(b_1 + b_0 z^{-2})$$\n展开乘积：\n$$T(z) = 2z^{-1}(b_0b_1 + b_0^2 z^{-2} + b_1^2 z^{-2} + b_0b_1 z^{-4})$$\n$$T(z) = 2z^{-1}(b_0b_1 + (b_0^2 + b_1^2)z^{-2} + b_0b_1 z^{-4})$$\n将 $2z^{-1}$ 项分配进去：\n$$T(z) = 2b_0b_1 z^{-1} + 2(b_0^2 + b_1^2)z^{-3} + 2b_0b_1 z^{-5}$$\n\n我们已知所期望的传递函数是 $T(z) = z^{-3}$。我们可以令 $T(z)$ 两个表达式中 $z^{-1}$ 各次幂的系数相等。\n$$2b_0b_1 z^{-1} + 2(b_0^2 + b_1^2)z^{-3} + 2b_0b_1 z^{-5} = 0 \\cdot z^{-1} + 1 \\cdot z^{-3} + 0 \\cdot z^{-5}$$\n这给了我们一个方程组：\n1. $z^{-1}$ 的系数：$2b_0b_1 = 0$\n2. $z^{-3}$ 的系数：$2(b_0^2 + b_1^2) = 1$\n3. $z^{-5}$ 的系数：$2b_0b_1 = 0$（此项多余）\n\n从方程(1)可知，必须有 $b_0 = 0$ 或 $b_1 = 0$。\n\n情况1：$b_0 = 0$。\n将此代入方程(2)：\n$2(0^2 + b_1^2) = 1 \\implies 2b_1^2 = 1 \\implies b_1^2 = \\frac{1}{2} \\implies b_1 = \\pm\\frac{1}{\\sqrt{2}}$。\n\n情况2：$b_1 = 0$。\n将此代入方程(2)：\n$2(b_0^2 + 0^2) = 1 \\implies 2b_0^2 = 1 \\implies b_0^2 = \\frac{1}{2} \\implies b_0 = \\pm\\frac{1}{\\sqrt{2}}$。\n\n题目要求 $b_0$ 为正值的解。这对应于情况2中的正根。\n所以，我们有：\n$b_0 = +\\frac{1}{\\sqrt{2}}$\n$b_1 = 0$\n\n现在我们使用对称条件 $b_2=b_1$ 和 $b_3=b_0$ 求出所有四个系数：\n$b_0 = \\frac{1}{\\sqrt{2}}$\n$b_1 = 0$\n$b_2 = 0$\n$b_3 = \\frac{1}{\\sqrt{2}}$\n\n最后一步是求出四舍五入到三位有效数字的数值。\n$b_0 = b_3 = \\frac{1}{\\sqrt{2}} \\approx 0.70710678...$\n四舍五入到三位有效数字得到 $0.707$。\n其他系数恰好为零。\n\n所求的系数集为 $(b_0, b_1, b_2, b_3) = (0.707, 0, 0, 0.707)$。", "answer": "$$\\boxed{(0.707, 0, 0, 0.707)}$$", "id": "1746348"}, {"introduction": "理论上的完美设计在实际应用中必须被精确实现才能达到预期效果。本练习探讨了在综合阶段出现一个常见实现错误时所产生的后果。通过分析这个配置错误的系统，你将能更深刻地理解QMF系统中每个组件的精确作用，并认识到为何滤波器结构中的每一个细节对于消除混叠和失真都至关重要[@problem_id:1746346]。", "problem": "考虑一个用于数字信号处理的双通道正交镜像滤波器 (QMF) 分析-综合滤波器组。输入信号 $x[n]$ 由一个分析级处理，该分析级由一个传递函数为 $H_0(z)$ 的低通滤波器和一个传递函数为 $H_1(z)$ 的高通滤波器组成。这些滤波器的输出经过2倍因子下采样。得到的信号随后被送入一个综合级，在综合级中它们被2倍因子上采样，并由一个低通综合滤波器 $G_0(z)$ 和一个高通综合滤波器 $G_1(z)$ 进行滤波。综合滤波器的输出相加以产生最终的输出信号 $\\hat{x}[n]$。\n\n该滤波器组基于单个原型低通滤波器 $H_0(z)$ 设计，其他滤波器定义如下：\n- 分析高通滤波器：$H_1(z) = H_0(-z)$\n- 综合低通滤波器：$G_0(z) = H_0(z)$\n\n然而，由于一个实现错误，综合高通滤波器被错误地设置为 $G_1(z) = H_0(-z)$，这偏离了完美重构所需的标准选择。\n\n假设原型滤波器 $H_0(z)$ 是一个理想的离散时间低通滤波器，其单位增益，截止频率为 $\\omega_c = \\pi/2$。其频率响应由下式给出：\n$$\nH_0(e^{j\\omega}) = \\begin{cases} 1,  |\\omega| \\le \\frac{\\pi}{2} \\\\ 0,  \\frac{\\pi}{2}  |\\omega| \\le \\pi \\end{cases}\n$$\n\n对于这个配置错误的系统，确定输出信号 $\\hat{x}[n]$ 和输入信号 $x[n]$ 之间的关系。用一个关于 $\\hat{x}[n]$ 的方程来表示你的答案。", "solution": "令 $X(e^{j\\omega})$ 和 $\\hat{X}(e^{j\\omega})$ 分别表示 $x[n]$ 和 $\\hat{x}[n]$ 的离散时间傅里叶变换。一个双通道分析-综合系统的总体输入-输出关系为：\n$$ \\hat{X}(e^{j\\omega}) = \\frac{1}{2} \\left[ T_0(e^{j\\omega})X(e^{jomega}) + T_1(e^{j\\omega})X(e^{j(\\omega+\\pi)}) \\right] $$\n其中，失真项 $T_0(e^{j\\omega})$ 和混叠项 $T_1(e^{j\\omega})$ 分别为：\n$$ T_0(e^{j\\omega}) = G_0(e^{j\\omega})H_0(e^{j\\omega}) + G_1(e^{j\\omega})H_1(e^{j\\omega}) $$\n$$ T_1(e^{j\\omega}) = G_0(e^{j\\omega})H_0(e^{j(\\omega+\\pi)}) + G_1(e^{j\\omega})H_1(e^{j(\\omega+\\pi)}) $$\n根据题设，$H_1(z)=H_0(-z)$，即 $H_1(e^{j\\omega})=H_0(e^{j(\\omega+\\pi)})$。错误的综合滤波器配置为 $G_0(z)=H_0(z)$ 和 $G_1(z)=H_0(-z)=H_1(z)$。代入可得：\n$$ T_0(e^{j\\omega}) = H_0^2(e^{j\\omega}) + H_1^2(e^{j\\omega}) $$\n$$ T_1(e^{j\\omega}) = H_0(e^{j\\omega})H_0(e^{j(\\omega+\\pi)}) + H_1(e^{j\\omega})H_1(e^{j(\\omega+\\pi)}) $$\n对于理想的半带原型滤波器：\n$$ H_0(e^{j\\omega}) = \\begin{cases} 1,  |\\omega| \\le \\frac{\\pi}{2} \\\\ 0,  \\frac{\\pi}{2}  |\\omega| \\le \\pi \\end{cases} $$\n其高通对应滤波器 $H_1(e^{j\\omega})$ 在互补频带 $\\frac{\\pi}{2}  |\\omega| \\le \\pi$ 上等于1，在其他地方等于0。\n因此，对于所有频率 $\\omega$：\n- 由于在任何频率， $H_0(e^{j\\omega})$ 和 $H_1(e^{j\\omega})$ 中总有一个是1而另一个是0，我们有 $H_0^2(e^{j\\omega}) + H_1^2(e^{j\\omega}) = H_0(e^{j\\omega}) + H_1(e^{j\\omega}) = 1$。所以 $T_0(e^{j\\omega})=1$。\n- $H_0(e^{j\\omega})$ 和 $H_0(e^{j(\\omega+\\pi)})$ 的非零区间不重叠，其乘积为0。同理，$H_1(e^{j\\omega})H_1(e^{j(\\omega+\\pi)})=0$。所以 $T_1(e^{j\\omega})=0$。\n\n将 $T_0(e^{j\\omega})=1$ 和 $T_1(e^{j\\omega})=0$ 代入输入-输出关系式，得到：\n$$ \\hat{X}(e^{j\\omega}) = \\frac{1}{2} \\left[ 1 \\cdot X(e^{j\\omega}) + 0 \\cdot X(e^{j(\\omega+\\pi)}) \\right] = \\frac{1}{2} X(e^{j\\omega}) $$\n进行傅里叶逆变换，得到时域关系：\n$$ \\hat{x}[n] = \\frac{1}{2} x[n] $$\n因此，对于理想原型和给定的错误配置，系统不会产生混叠或失真，但会将输入信号按 $\\frac{1}{2}$ 的因子进行缩放。", "answer": "$$\\boxed{\\hat{x}[n]=\\frac{1}{2}x[n]}$$", "id": "1746346"}]}