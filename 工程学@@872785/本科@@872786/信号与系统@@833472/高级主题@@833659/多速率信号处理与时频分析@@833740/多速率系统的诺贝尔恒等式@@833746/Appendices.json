{"hands_on_practices": [{"introduction": "诺贝尔恒等式是多速率信号处理中的基石，它揭示了滤波器与采样率转换器互换顺序的等价条件。本练习将引导您探索第一诺贝尔恒等式，即上采样器与滤波器级联的等价变换。通过求解在新结构下需要何种滤波器才能保持系统功能不变，您将掌握如何为特定实现需求（例如硬件优化）重构系统。[@problem_id:1737867]", "problem": "在数字信号处理领域，多速率系统常用于改变信号的采样率。考虑一个离散时间信号处理架构，我们称之为系统1。在此系统中，一个Z变换为$X(z)$的输入信号$x[n]$首先由一个有限冲激响应（FIR）滤波器处理，其传递函数为$G(z) = 1 + 2z^{-1} + z^{-2}$。该滤波器的输出然后以因子$L=2$进行上采样，以产生输出信号$y_1[n]$。以因子$L$进行上采样是一个在待上采样序列的每两个样本之间插入$L-1$个零的过程。\n\n出于硬件实现的原因，需要重新设计系统。在称为系统2的新设计中，操作的顺序被颠倒了。相同的输入信号$x[n]$首先以相同的因子$L=2$进行上采样。这个上采样后的信号然后通过一个具有传递函数$H(z)$的新FIR滤波器，以产生输出信号$y_2[n]$。\n\n确定新滤波器的传递函数$H(z)$，以确保对于任何任意输入信号$x[n]$，系统2在功能上等同于系统1。您的答案应为$H(z)$关于$z^{-1}$幂次的表达式。", "solution": "设$x[n]$的Z变换为$X(z)$，且$G(z)=1+2z^{-1}+z^{-2}$。通过一个传递函数为$G(z)$的线性时不变（LTI）系统进行滤波，得到$V(z)=G(z)X(z)$。以因子$L$进行上采样会在样本之间插入$L-1$个零；如果$u[n]$是通过将$v[n]$上采样$L$倍得到的，那么它的Z变换满足$U(z)=V(z^{L})$。因此，在系统1中（先滤波后上采样2倍），\n$$\nY_{1}(z)=V(z^{2})=G(z^{2})X(z^{2}).\n$$\n\n在系统2中，首先进行上采样：设$w[n]$是$x[n]$上采样2倍后的版本，我们有\n$$\nW(z)=X(z^{2}).\n$$\n然后通过$H(z)$进行滤波，得到\n$$\nY_{2}(z)=H(z)W(z)=H(z)X(z^{2}).\n$$\n\n为了对所有输入信号都功能等效，我们需要对所有的$X(z)$都有$Y_{2}(z)=Y_{1}(z)$，这意味着\n$$\nH(z)=G(z^{2}).\n$$\n代入$G(z)=1+2z^{-1}+z^{-2}$得到\n$$\nH(z)=1+2z^{-2}+z^{-4}.\n$$\n这也与时域观点相符，即将滤波器移到上采样器之后，会在系数之间插入$L-1$个零，即对于偶数$n$有$h[n]=g[n/2]$，对于奇数$n$有$h[n]=0$。", "answer": "$$\\boxed{1+2z^{-2}+z^{-4}}$$", "id": "1737867"}, {"introduction": "在实际应用中，我们常常希望在尽可能低的采样率下执行计算密集型的滤波操作以节省资源。第二诺贝尔恒等式为此提供了理论依据，允许我们将滤波器移动到抽取器之后。本练习将逆向应用此恒等式，从一个已优化的低速率系统出发，推导其等价的、在抽取前进行滤波的原始系统中的滤波器形式。[@problem_id:1737879]", "problem": "在数字信号处理中，以高采样率执行运算的计算成本可能很高。一种提高效率的常用策略是重新安排运算顺序。考虑一个系统，其中离散时间信号首先通过一个传递函数为 $H(z)$ 的数字滤波器，然后以因子 $M=4$ 进行下采样。这个过程被称为抽取（decimation）。\n\n为了减少计算负载，一位工程师提出了一个功能上等效的替代系统。在这个新系统中，相同的输入信号首先以因子 $M=4$ 进行下采样，然后得到的较低速率的信号再由一个传递函数为 $G(z) = 1 + z^{-1}$ 的更简单的滤波器进行滤波。\n\n假设对于任何给定的输入信号，这两个系统产生相同的输出信号，请确定原始计算成本高昂的配置中滤波器的传递函数 $H(z)$。", "solution": "设输入信号为 $x[n]$，最终输出信号为 $y[n]$。我们已知有两个等效系统，它们从相同的输入 $x[n]$ 产生相同的输出 $y[n]$。\n\n系统1：一个传递函数为 $H(z)$ 的滤波器，后接一个因子为 $M=4$ 的抽取器（下采样器）。\n经过滤波器 $H(z)$ 后的信号是 $w[n]$，其Z变换为 $W(z) = H(z)X(z)$。\n然后，抽取器产生输出 $y[n] = w[4n]$。输出的Z变换由下式给出\n$$Y(z) = \\frac{1}{4} \\sum_{k=0}^{3} W\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} H\\left(z^{1/4} e^{-j\\pi k/2}\\right) X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\n\n系统2：一个因子为 $M=4$ 的抽取器，后接一个传递函数为 $G(z)$ 的滤波器。\n经过抽取器后的信号是 $v[n] = x[4n]$。其Z变换为 $V(z)$。\n这个信号随后由 $G(z)$ 进行滤波。最终输出的Z变换是 $Y(z) = G(z)V(z)$。\n下采样信号 $v[n]$ 的Z变换与原始信号 $x[n]$ 的Z变换的关系如下\n$$V(z) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} \\exp\\left(-j\\frac{2\\pi k}{4}\\right)\\right) = \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right)$$\n因此，系统2的输出为\n$$Y(z) = G(z) \\left( \\frac{1}{4} \\sum_{k=0}^{3} X\\left(z^{1/4} e^{-j\\pi k/2}\\right) \\right)$$\n\n要使两个系统等效，它们的输出必须相同。这个问题是多速率系统第一类诺贝尔恒等式（针对抽取）的直接应用。该恒等式指出，一个滤波器 $H(z)$ 后接一个因子为 $M$ 的下采样器，等效于一个因子为 $M$ 的下采样器后接一个滤波器 $G(z)$，当且仅当 $H(z)$ 是一个 $M$ 带滤波器，即其传递函数可以表示为 $H(z) = G(z^M)$。\n\n在这个问题中，我们有：\n下采样因子 $M = 4$。\n高效系统中滤波器的传递函数为 $G(z) = 1 + z^{-1}$。\n原始系统中滤波器的传递函数为 $H(z)$。\n\n根据诺贝尔恒等式，两个滤波器传递函数之间的关系是：\n$$H(z) = G(z^M)$$\n\n将给定的 $M=4$ 值代入此关系，我们得到：\n$$H(z) = G(z^4)$$\n\n现在，我们通过将 $G(z)$ 表达式中所有出现的 $z$ 替换为 $z^4$ 来求 $G(z^4)$。\n已知 $G(z) = 1 + z^{-1}$，我们有：\n$$G(z^4) = 1 + (z^4)^{-1}$$\n$$G(z^4) = 1 + z^{-4}$$\n\n因此，原始系统中滤波器的传递函数为：\n$$H(z) = 1 + z^{-4}$$", "answer": "$$\\boxed{1 + z^{-4}}$$", "id": "1737879"}, {"introduction": "理论知识的最终目的是解决实际工程问题。这个挑战性的练习模拟了一个在软件定义无线电中常见的场景：高效地滤除一个窄带干扰。您需要综合运用降采样导致的频率混叠知识与滤波器设计原理，来设计一个在低采样率下工作的陷波滤波器。这个问题将检验您是否能将诺贝尔恒等式的效率优势，应用于真实的系统设计挑战中。[@problem_id:1737892]", "problem": "在现代软件定义无线电系统中，通常需要消除强的窄带干扰。为了最小化计算负载，信号处理通常在尽可能低的采样率下进行。\n\n考虑一个被强正弦干扰污染的离散时间信号。已知该干扰的归一化角频率为 $\\omega_0 = \\frac{3\\pi}{8}$ 弧度/采样点。为消除此干扰，信号首先通过一个抽取器，该抽取器以因子 $M=5$ 对信号进行降采样。得到的低速率信号随后由一个稳定的二阶无限脉冲响应（IIR）滤波器 $H(z)$ 进行滤波。\n\n该陷波滤波器设计为在单位圆上有一对共轭复零点，位于 $z_{1,2} = e^{\\pm j\\theta_z}$，用于消除干扰。滤波器的极点位于 $p_{1,2} = r e^{\\pm j\\theta_z}$，半径为 $r=0.95$，以确保稳定性的同时形成一个尖锐的陷波。\n\n您的任务是确定定义滤波器零点位置的基本正角度 $\\theta_z$。您的答案应满足 $0  \\theta_z  \\pi$。最终答案请用弧度表示。", "solution": "原始离散时间信号中的干扰具有归一化角频率 $\\omega_{0} = \\frac{3\\pi}{8}$ 弧度/采样点。经过因子为 $M=5$ 的抽取后，降采样序列为 $y[n] = x[nM]$。对于复指数分量 $x[n] = \\exp(j\\omega_{0} n)$，抽取后的序列变为 $y[n] = \\exp(j \\omega_{0} M n)$，其对应的归一化角频率为\n$$\n\\omega_{d} = M\\omega_{0} \\quad \\text{mod} \\; 2\\pi.\n$$\n为了将IIR滤波器的陷波点置于降采样信号中的干扰频率处，我们必须将 $\\omega_{d}$ 映射到主区间 $(-\\pi,\\pi]$：\n$$\n\\omega_{d} = \\left(M\\omega_{0} + 2\\pi k\\right) \\in (-\\pi,\\pi] \\quad \\text{对于某个} \\; k \\in \\mathbb{Z}.\n$$\n代入 $\\omega_{0} = \\frac{3\\pi}{8}$ 和 $M=5$ 得\n$$\nM\\omega_{0} = \\frac{15\\pi}{8}.\n$$\n选择 $k=-1$ 以折叠到 $(-\\pi,\\pi]$ 区间内，\n$$\n\\omega_{d} = \\frac{15\\pi}{8} - 2\\pi = \\frac{15\\pi}{8} - \\frac{16\\pi}{8} = -\\frac{\\pi}{8}.\n$$\n陷波滤波器的零点必须位于 $z_{1,2} = \\exp(\\pm j\\theta_{z})$，其中基本正角度 $\\theta_{z}$ 在 $(0,\\pi)$ 内。由于降采样信号中的干扰出现在 $\\omega_{d} = -\\frac{\\pi}{8}$，所需的正角度是其绝对值\n$$\n\\theta_{z} = |\\omega_{d}| = \\frac{\\pi}{8}.\n$$\n这个选择将零点放置在正确的共轭角度上，以消除混叠干扰。极点半径 $r=0.95$ 决定了陷波的尖锐程度，但不影响角度 $\\theta_{z}$。", "answer": "$$\\boxed{\\frac{\\pi}{8}}$$", "id": "1737892"}]}