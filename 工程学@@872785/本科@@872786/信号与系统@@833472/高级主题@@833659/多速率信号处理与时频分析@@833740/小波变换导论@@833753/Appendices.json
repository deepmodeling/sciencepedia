{"hands_on_practices": [{"introduction": "要真正理解离散小波变换（DWT），最有效的方法就是亲手计算一遍。本练习将引导你使用最简单的哈尔小波，完整地走过“分析-处理-合成”的全过程。通过这个练习 [@problem_id:1731109]，你将具体地看到信号是如何被分解为近似和细节部分，以及如何通过操纵这些系数来改变并重构原始信号。", "problem": "在一个信号处理应用中，我们探讨一种对小波系数的简单处理。考虑一个长度为四的离散时间信号，$x[n] = \\{3, 1, 4, 0\\}$。该信号经历一个三步过程：分析、处理和合成。\n\n**步骤1：分析**\n使用单层哈尔离散小波变换（DWT）对信号进行分析。该变换应用于信号值中不重叠的相邻数据对。对于一个通用对 $(s_a, s_b)$，变换产生一个近似系数 $c_A$ 和一个细节系数 $c_D$，定义如下：\n$$c_A = \\frac{s_a + s_b}{\\sqrt{2}}$$\n$$c_D = \\frac{s_a - s_b}{\\sqrt{2}}$$\n对信号 $x[n]$ 应用此变换，得到一个包含两个近似系数的集合 $cA_1$ 和一个包含两个细节系数的集合 $cD_1$。\n\n**步骤2：处理**\n在变换域中，交换计算出的两个细节系数的位置。近似系数保持不变。\n\n**步骤3：合成**\n通过应用哈尔离散小波逆变换，利用原始的近似系数和交换后的细节系数来合成一个新信号 $\\hat{x}[n]$。从对应的系数对 $(c_A, c_D)$ 重建原始对 $(s_a, s_b)$ 的逆变换如下：\n$$s_a = \\frac{c_A + c_D}{\\sqrt{2}}$$\n$$s_b = \\frac{c_A - c_D}{\\sqrt{2}}$$\n\n确定重建信号 $\\hat{x}[n]$。", "solution": "我们已知作用于相邻、不重叠数据对的单层哈尔离散小波变换及其逆变换。对于一对数据 $(s_{a},s_{b})$，其分析系数为\n$$\nc_{A}=\\frac{s_{a}+s_{b}}{\\sqrt{2}},\\quad c_{D}=\\frac{s_{a}-s_{b}}{\\sqrt{2}},\n$$\n其逆变换合成为\n$$\ns_{a}=\\frac{c_{A}+c_{D}}{\\sqrt{2}},\\quad s_{b}=\\frac{c_{A}-c_{D}}{\\sqrt{2}}.\n$$\n\n步骤1 (分析)：将 $x[n]=\\{3,1,4,0\\}$ 分为数据对 $(3,1)$ 和 $(4,0)$。\n- 对于 $(3,1)$:\n$$\nc_{A,1}=\\frac{3+1}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,1}=\\frac{3-1}{\\sqrt{2}}=\\frac{2}{\\sqrt{2}}=\\sqrt{2}.\n$$\n- 对于 $(4,0)$:\n$$\nc_{A,2}=\\frac{4+0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2},\\quad\nc_{D,2}=\\frac{4-0}{\\sqrt{2}}=\\frac{4}{\\sqrt{2}}=2\\sqrt{2}.\n$$\n\n步骤2 (处理)：交换两个细节系数，近似系数保持不变：\n$$\n\\tilde{c}_{D,1}=c_{D,2}=2\\sqrt{2},\\quad \\tilde{c}_{D,2}=c_{D,1}=\\sqrt{2},\\quad c_{A,1}=2\\sqrt{2},\\quad c_{A,2}=2\\sqrt{2}.\n$$\n\n步骤3 (合成)：使用逆变换公式重建每一对数据。\n- 根据 $(c_{A,1},\\tilde{c}_{D,1})=(2\\sqrt{2},2\\sqrt{2})$:\n$$\n\\hat{s}_{a,1}=\\frac{2\\sqrt{2}+2\\sqrt{2}}{\\sqrt{2}}=\\frac{4\\sqrt{2}}{\\sqrt{2}}=4,\\quad\n\\hat{s}_{b,1}=\\frac{2\\sqrt{2}-2\\sqrt{2}}{\\sqrt{2}}=0.\n$$\n- 根据 $(c_{A,2},\\tilde{c}_{D,2})=(2\\sqrt{2},\\sqrt{2})$:\n$$\n\\hat{s}_{a,2}=\\frac{2\\sqrt{2}+\\sqrt{2}}{\\sqrt{2}}=\\frac{3\\sqrt{2}}{\\sqrt{2}}=3,\\quad\n\\hat{s}_{b,2}=\\frac{2\\sqrt{2}-\\sqrt{2}}{\\sqrt{2}}=\\frac{\\sqrt{2}}{\\sqrt{2}}=1.\n$$\n\n因此，重建后的信号为 $\\hat{x}[n]=\\{4,0,3,1\\}$。", "answer": "$$\\boxed{\\begin{pmatrix}4  0  3  1\\end{pmatrix}}$$", "id": "1731109"}, {"introduction": "在了解了如何计算小波系数之后，我们自然会问：这些系数究竟代表了什么？本练习 [@problem_id:1731140] 将挑战你构建一个其一阶细节系数全部为零的信号。通过解决这个问题，你将深刻理解细节系数是如何捕捉信号中的局部变化或高频特征的，从而揭示小波变换的“火眼金睛”所在。", "problem": "在离散信号分析中，离散小波变换（DWT）是根据信号的局部特性来表示信号的强大工具。它将信号分解为近似（低频）分量和细节（高频）分量。\n\n考虑一个简单的实值四点信号 $x[n]$，定义域为 $n = 0, 1, 2, 3$。使用Haar小波系统对该信号进行第一级DWT分解，会将其分解为一个两点近似系数信号 $a_1[k]$ 和一个两点细节系数信号 $d_1[k]$，其中 $k=0,1$。\n\n该分解是使用一个低通滤波器 $h[n]$ 和一个高通滤波器 $g[n]$ 来执行的。对于Haar小波系统，这些滤波器定义如下：\n$$h[n] = \\begin{cases} 1/\\sqrt{2}  n=0, 1 \\\\ 0  \\text{否则} \\end{cases}$$\n$$g[n] = \\begin{cases} 1/\\sqrt{2}  n=0 \\\\ -1/\\sqrt{2}  n=1 \\\\ 0  \\text{否则} \\end{cases}$$\n\n近似系数和细节系数使用标准分析方程计算：\n$$a_1[k] = \\sum_{m} x[m] h[m - 2k]$$\n$$d_1[k] = \\sum_{m} x[m] g[m - 2k]$$\n\n下列哪个选项提供了一个非零信号 $x[n]$ 的例子，其**所有**第一级细节系数 $d_1[k]$ 均为零，并正确描述了任何此类信号在此分解级别上必须具备的一般性质？\n\nA. 信号：$\\{2, 2, -4, -4\\}$。性质：信号在不重叠的双样本块上是分段常数。\n\nB. 信号：$\\{1, 2, 4, 8\\}$。性质：信号表现出指数增长。\n\nC. 信号：$\\{3, 3, 3, 3\\}$。性质：信号必须在其整个长度上是一个恒定的直流信号。\n\nD. 信号：$\\{1, 3, 3, 1\\}$。性质：信号必须是对称的（回文的）。\n\nE. 信号：$\\{5, -5, 5, -5\\}$。性质：信号是纯振荡的，并且其平均值为零。", "solution": "第一级Haar DWT细节系数计算如下\n$$\nd_{1}[k]=\\sum_{m}x[m]\\,g[m-2k],\n$$\n其中给定的 $g[n]$ 满足 $g[0]=\\frac{1}{\\sqrt{2}}$，$g[1]=-\\frac{1}{\\sqrt{2}}$，并且在其他情况下 $g[n]=0$。\n\n对于 $k=0$，\n$$\nd_{1}[0]=\\sum_{m}x[m]\\,g[m]=x[0]g[0]+x[1]g[1]=\\frac{1}{\\sqrt{2}}x[0]-\\frac{1}{\\sqrt{2}}x[1]=\\frac{x[0]-x[1]}{\\sqrt{2}}.\n$$\n对于 $k=1$，\n$$\nd_{1}[1]=\\sum_{m}x[m]\\,g[m-2]=x[2]g[0]+x[3]g[1]=\\frac{1}{\\sqrt{2}}x[2]-\\frac{1}{\\sqrt{2}}x[3]=\\frac{x[2]-x[3]}{\\sqrt{2}}.\n$$\n因此，所有第一级细节系数均为零，当且仅当\n$$\nd_{1}[0]=0 \\;\\;\\Longleftrightarrow\\;\\; x[0]=x[1],\\qquad d_{1}[1]=0 \\;\\;\\Longleftrightarrow\\;\\; x[2]=x[3].\n$$\n因此，充分必要条件是信号在不重叠的双样本块 $\\{x[0],x[1]\\}$ 和 $\\{x[2],x[3]\\}$ 上是分段常数；这两个块不必具有相同的常数值。\n\n现在检查各个选项：\n- A: $\\{2,2,-4,-4\\}$ 得出 $d_{1}[0]=\\frac{2-2}{\\sqrt{2}}=0$ 且 $d_{1}[1]=\\frac{-4-(-4)}{\\sqrt{2}}=0$，其陈述的性质与推导出的条件相符。\n- B: $\\{1,2,4,8\\}$ 产生 $d_{1}[0]=\\frac{1-2}{\\sqrt{2}}\\neq 0$，所以它不满足条件。\n- C: $\\{3,3,3,3\\}$ 产生零细节系数，但其陈述的性质“必须在整个长度上是常数”并非必要条件；它只是真实条件的一个特例，因此该描述不正确。\n- D: $\\{1,3,3,1\\}$ 产生 $d_{1}[0]=\\frac{1-3}{\\sqrt{2}}\\neq 0$，所以它不满足条件，且该性质不是一般条件。\n- E: $\\{5,-5,5,-5\\}$ 产生 $d_{1}[0]=\\frac{5-(-5)}{\\sqrt{2}}\\neq 0$，所以它不满足条件。\n\n因此，正确的选项是A，而正确的一般性质是信号在此级别上的每个双样本块内是常数。", "answer": "$$\\boxed{A}$$", "id": "1731140"}, {"introduction": "在实际应用中，选择哪一种小波函数并非随意，而是需要根据信号特性和应用目标来决定。这个练习 [@problem_id:1731106] 旨在比较不连续的哈尔小波和更平滑的Daubechies小波在表示一个平滑信号时的性能差异。通过计算和比较能量集中度，你将掌握小波变换在信号压缩等应用中的核心概念之一。", "problem": "离散小波变换（DWT）在信号处理中的一个重要应用是压缩，它依赖于能量集中的原理。如果一个变换能够仅用少数几个大幅值系数来表示信号的能量，那么该变换就为信号提供了良好的能量集中。\n\n考虑一个长度为 `N=8` 的离散时间信号 `x[n]`，它代表一个采样的高斯脉冲。该信号的值如下：\n`x = [0.00219, 0.04393, 0.32465, 0.88250, 0.88250, 0.32465, 0.04393, 0.00219]`\n\n单层 DWT 将此信号分解为一组近似系数 `cA` 和一组细节系数 `cD`。近似系数是通过将信号与低通滤波器 `h` 进行卷积，然后以因子 2 进行下采样得到的。卷积应使用周期性边界条件（也称为循环卷积）来执行。\n\n我们希望比较两种不同的小波对此信号的能量集中性能：Haar 小波和 Daubechies 4-tap (D4) 小波。它们各自的低通滤波器系数 `h` 如下所示。\n- Haar 滤波器：`h_Haar = [0.70711, 0.70711]`\n- Daubechies 4-tap (D4) 滤波器：`h_D4 = [0.48296, 0.83652, 0.22414, -0.12941]`\n\n一组系数中所包含的能量是这些系数的平方幅值之和。设 `E_Haar` 为使用 Haar 滤波器得到的近似系数 `cA` 的能量，`E_D4` 为使用 D4 滤波器得到的近似系数 `cA` 的能量。\n\n计算比率 `R = E_D4 / E_Haar`。将最终答案四舍五入至四位有效数字。", "solution": "给定一个长度为$N=8$的实值离散时间信号$x[n]$，具有周期性边界条件（循环卷积），以及两个低通分析滤波器$h_{\\text{Haar}}$和$h_{\\text{D4}}$。单层DWT近似序列$cA$是通过将$x[n]$与$h[m]$进行循环卷积，然后以因子 2 进行下采样得到的。使用标准离散循环卷积，\n$$\ny_{h}[n] = \\sum_{m=0}^{L-1} h[m]\\,x[(n-m)\\bmod N],\\quad cA[k] = y_{h}[2k],\\quad k=0,1,2,3.\n$$\n给定的信号值为\n$$\nx[0]=0.00219,\\;x[1]=0.04393,\\;x[2]=0.32465,\\;x[3]=0.88250,\\;x[4]=0.88250,\\;x[5]=0.32465,\\;x[6]=0.04393,\\;x[7]=0.00219.\n$$\n\nHaar 情况：$h_{\\text{Haar}}[0]=0.70711$，$h_{\\text{Haar}}[1]=0.70711$。循环卷积为\n$$\ny_{\\text{Haar}}[n]=0.70711\\,x[n]+0.70711\\,x[n-1].\n$$\n在偶数索引处进行下采样得到\n$$\n\\begin{aligned}\ncA_{\\text{Haar}}[0]=y_{\\text{Haar}}[0]=0.70711\\,(x[0]+x[7])=0.70711\\cdot(0.00219+0.00219)=0.0030971418,\\\\\ncA_{\\text{Haar}}[1]=y_{\\text{Haar}}[2]=0.70711\\,(x[2]+x[1])=0.70711\\cdot(0.32465+0.04393)=0.2606266038,\\\\\ncA_{\\text{Haar}}[2]=y_{\\text{Haar}}[4]=0.70711\\,(x[4]+x[3])=0.70711\\cdot(0.88250+0.88250)=1.24804915,\\\\\ncA_{\\text{Haar}}[3]=y_{\\text{Haar}}[6]=0.70711\\,(x[6]+x[5])=0.70711\\cdot(0.04393+0.32465)=0.2606266038.\n\\end{aligned}\n$$\n因此，近似能量为\n$$\n\\begin{aligned}\nE_{\\text{Haar}}=\\sum_{k=0}^{3}\\bigl(cA_{\\text{Haar}}[k]\\bigr)^{2}\\\\\n=(0.0030971418)^{2}+(0.2606266038)^{2}+(1.24804915)^{2}+(0.2606266038)^{2}\\\\\n=9.592287329\\times 10^{-6}+0.067926226608322+1.5576266808157225+0.067926226608322\\\\\n\\approx 1.6934887263196955.\n\\end{aligned}\n$$\n\nDaubechies-4 情况：$h_{\\text{D4}}[0]=0.48296$，$h_{\\text{D4}}[1]=0.83652$，$h_{\\text{D4}}[2]=0.22414$，$h_{\\text{D4}}[3]=-0.12941$。在偶数索引处的循环卷积结果为\n$$\n\\begin{aligned}\ny_{\\text{D4}}[0]=0.48296\\,x[0]+0.83652\\,x[-1]+0.22414\\,x[-2]-0.12941\\,x[-3]\\\\\n=0.48296\\,x[0]+0.83652\\,x[7]+0.22414\\,x[6]-0.12941\\,x[5]\\\\\n=0.48296\\cdot 0.00219+0.83652\\cdot 0.00219+0.22414\\cdot 0.04393-0.12941\\cdot 0.32465\\\\\n=0.0010576824+0.0018319788+0.0098464702-0.0420129565\\\\\n=-0.0292768251,\\\n$$6pt]\ny_{\\text{D4}}[2]=0.48296\\,x[2]+0.83652\\,x[1]+0.22414\\,x[0]-0.12941\\,x[7]\\\\\n=0.48296\\cdot 0.32465+0.83652\\cdot 0.04393+0.22414\\cdot 0.00219-0.12941\\cdot 0.00219\\\\\n=0.156792964+0.0367483236+0.0004908666-0.0002834079\\\\\n=0.1937487463,\\\n$$6pt]\ny_{\\text{D4}}[4]=0.48296\\,x[4]+0.83652\\,x[3]+0.22414\\,x[2]-0.12941\\,x[1]\\\\\n=0.48296\\cdot 0.88250+0.83652\\cdot 0.88250+0.22414\\cdot 0.32465-0.12941\\cdot 0.04393\\\\\n=0.4262122+0.7382289+0.072767051-0.0056849813\\\\\n=1.2315231697,\\\n$$6pt]\ny_{\\text{D4}}[6]=0.48296\\,x[6]+0.83652\\,x[5]+0.22414\\,x[4]-0.12941\\,x[3]\\\\\n=0.48296\\cdot 0.04393+0.83652\\cdot 0.32465+0.22414\\cdot 0.88250-0.12941\\cdot 0.88250\\\\\n=0.0212164328+0.271576218+0.19780355-0.114204325\\\\\n=0.3763918758.\n\\end{aligned}\n$$\n因此 $cA_{\\text{D4}}=[-0.0292768251,\\;0.1937487463,\\;1.2315231697,\\;0.3763918758]$ 且近似能量为\n$$\n\\begin{aligned}\nE_{\\text{D4}}=\\sum_{k=0}^{3}\\bigl(cA_{\\text{D4}}[k]\\bigr)^{2}\\\\\n=(-0.0292768251)^{2}+(0.1937487463)^{2}+(1.2315231697)^{2}+(0.3763918758)^{2}\\\\\n=0.000857132487936+0.03753857669282176+1.516649317508+0.1416708441682426\\\\\n\\approx 1.6967158708570004.\n\\end{aligned}\n$$\n\n所求的比率为\n$$\nR=\\frac{E_{\\text{D4}}}{E_{\\text{Haar}}}=\\frac{1.6967158708570004}{1.6934887263196955}\\approx 1.001905616.\n$$\n四舍五入到四位有效数字得到\n$$\nR\\approx 1.002.\n$$", "answer": "$$\\boxed{1.002}$$", "id": "1731106"}]}