{"hands_on_practices": [{"introduction": "为了掌握匹配滤波器的核心功能，我们从一个基础练习开始。通过计算一个简单的矩形脉冲信号与其匹配滤波器进行卷积后的输出波形，我们可以直观地理解滤波器如何处理信号，以在特定时刻产生一个峰值输出。这个练习将为我们建立关于匹配滤波器如何通过自相关操作来最大化信噪比的初步直觉 [@problem_id:1736683]。", "problem": "在一个简化的基带数字通信系统中，使用矩形脉冲来表示二进制的'1'。该脉冲记为 $s(t)$，其持续时间为 $T$，幅度为单位幅度。其定义为：\n$$s(t) = u(t) - u(t-T)$$\n其中 $u(t)$ 是亥维赛单位阶跃函数，定义为当 $t \\ge 0$ 时 $u(t) = 1$，当 $t  0$ 时 $u(t) = 0$。\n\n为了在接收端的特定时刻最大化信噪比，采用了一个匹配滤波器。与信号 $s(t)$ 相匹配的滤波器的冲激响应通常由 $h(t) = s(T_d - t)$ 给出，其中 $T_d$ 是一个表示时间延迟的设计参数。对于该系统，通过选择延迟等于脉冲持续时间来使滤波器成为因果的，因此其冲激响应为 $h(t) = s(T - t)$。\n\n假设发射的脉冲 $s(t)$ 是该匹配滤波器的输入。确定输出波形 $y(t)$ 作为时间 $t$ 和参数 $T$ 的函数的完整数学表达式。你的答案应以单位斜坡函数表示，其定义为 $r(t) = t u(t)$。", "solution": "匹配滤波器的输出是输入脉冲与冲激响应的卷积：\n$$\ny(t) = (s * h)(t), \\quad \\text{with} \\quad s(t) = u(t) - u(t - T), \\quad h(t) = s(T - t).\n$$\n由于 $s(t)$ 是宽度为 $T$ 的单位幅度矩形脉冲，因此 $h(t)$ 也是一个宽度为 $T$ 的矩形脉冲（时间反转并平移以确保因果性）。对于分段连续信号的卷积，孤立时间点的取值不影响结果；因此我们可以等效地使用因果表示\n$$\nh(t) \\equiv u(t) - u(t - T)\n$$\n来计算卷积。因此，\n$$\ny(t) = \\big(u - u(\\cdot - T)\\big) * \\big(u - u(\\cdot - T)\\big).\n$$\n根据卷积的线性性质，\n$$\ny(t) = u * u \\;-\\; u * u(t - T) \\;-\\; u(t - T) * u \\;+\\; u(t - T) * u(t - T).\n$$\n使用标准结果 $u * u = r(t)$（其中 $r(t) = t\\,u(t)$）以及卷积的移位性质，\n$$\nu * u(t - T) = r(t - T), \\quad u(t - T) * u = r(t - T), \\quad u(t - T) * u(t - T) = r(t - 2T).\n$$\n将这些代入 $y(t)$ 的表达式中，得到\n$$\ny(t) = r(t) - 2\\,r(t - T) + r(t - 2T),\n$$\n这是一个底为 $2T$、在 $t = T$ 处峰值为 $T$ 的三角波形，正如匹配滤波器输出所预期的那样（等于在时延 $t - T$ 处计算的 $s(t)$ 的自相关）。", "answer": "$$\\boxed{r(t) - 2\\,r(t - T) + r(t - 2T)}$$", "id": "1736683"}, {"introduction": "在真实的通信系统中，理想的零均值噪声环境十分罕见。这个练习将我们带入一个更贴近实际的场景：接收信号中存在一个未知的直流偏置。我们将定量分析这个看似简单的干扰如何影响系统的信噪比性能，从而揭示匹配滤波器在应对非高斯白噪声干扰时的局限性 [@problem_id:1736640]。", "problem": "在一个数字通信系统中，一个二进制数据流使用简单的矩形脉冲成形方案进行传输。该系统被设计为长期来看是零均值的，信号脉冲 $s(t)$ 及其反相 $-s(t)$ 的传输概率相等。在我们的分析中，我们关注单个脉冲 $s(t)$ 的检测，其定义如下：\n$$\ns(t) = \\begin{cases} A  \\text{ if } 0 \\le t \\le T \\\\ 0  \\text{ otherwise} \\end{cases}\n$$\n其中 $A$ 和 $T$ 是正常数。\n\n接收机采用一个与该信号 $s(t)$ 匹配的滤波器，以在加性高斯白噪声（AWGN）存在的情况下最大化脉冲的可检测性。该噪声具有恒定的双边功率谱密度 $N_0/2$。匹配滤波器的输出在最佳时刻进行采样，以获得最高的信噪比（SNR）。\n\n在理想情况下，接收到的信号是 $r_{ideal}(t) = s(t) + n(t)$，其中 $n(t)$ 是加性高斯白噪声。性能由输出信噪比 $SNR_{ideal}$ 来衡量，其定义为采样时刻滤波器输出端信号分量的平方值，除以输出端噪声分量的平均功率（方差）。\n\n现在，考虑一个非理想的、性能下降的场景，其中一个小的、未知的但恒定的直流偏置 $C$ 由于接收机模拟前端的缺陷而污染了信号。此时接收到的信号是 $r_{degraded}(t) = s(t) + C + n(t)$。使用相同的匹配滤波器。在这种情况下，直流偏置充当一种干扰。性能下降后的性能由 $SNR_{degraded}$ 来衡量，其中输出端的“信号”功率仍然仅由 $s(t)$ 产生，但输出端的“总噪声”功率是加性高斯白噪声的功率与直流偏置 $C$ 产生的功率之和。\n\n计算比率 $\\frac{SNR_{degraded}}{SNR_{ideal}}$ 以量化性能的下降程度。请用 $C$、$T$ 和 $N_0$ 表示您的答案，形式为一个闭式解析表达式。", "solution": "设 $s(t)$ 为实值函数，且时间上限定在 $[0,T]$ 区间。其能量和面积定义为\n$$\nE_{s} \\equiv \\int_{-\\infty}^{\\infty} s^{2}(t)\\,dt, \n\\qquad\nS_{1} \\equiv \\int_{-\\infty}^{\\infty} s(t)\\,dt.\n$$\n对于给定的矩形脉冲，即在 $[0,T]$ 上 $s(t)=A$ 且在其他地方为零，\n$$\nE_{s}=\\int_{0}^{T} A^{2}\\,dt = A^{2}T,\n\\qquad\nS_{1}=\\int_{0}^{T} A\\,dt = AT.\n$$\n\n使用匹配滤波器 $h(t)=s(T-t)$，在 $t=T$ 时的采样值是相关值 $y(T)=\\int_{-\\infty}^{\\infty} s(u)\\,r(u)\\,du$。\n\n理想情况 $r_{\\text{ideal}}(t)=s(t)+n(t)$：\n- 输出采样点的信号分量为\n$$\ny_{s}(T)=\\int s(u)\\,s(u)\\,du=E_{s}.\n$$\n- 噪声分量为 $y_{n}(T)=\\int s(u)\\,n(u)\\,du$，这是一个零均值高斯变量，其方差为\n$$\n\\operatorname{Var}\\{y_{n}(T)\\}=\\frac{N_{0}}{2}\\int s^{2}(u)\\,du=\\frac{N_{0}}{2}E_{s}.\n$$\n因此，\n$$\nSNR_{\\text{ideal}}=\\frac{\\left(y_{s}(T)\\right)^{2}}{\\operatorname{Var}\\{y_{n}(T)\\}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}=\\frac{2E_{s}}{N_{0}}.\n$$\n\n性能下降情况 $r_{\\text{degraded}}(t)=s(t)+C+n(t)$：\n- 输出采样点分解为\n$$\ny(T)=\\int s(u)\\,s(u)\\,du+\\int s(u)\\,C\\,du+\\int s(u)\\,n(u)\\,du\n=E_{s}+C\\,S_{1}+y_{n}(T).\n$$\n- 信号分量仍然是 $E_{s}$。来自直流偏置的干扰是确定性项 $C\\,S_{1}$，其在采样点的功率贡献为 $(C\\,S_{1})^{2}$。加性高斯白噪声的贡献方差为 $\\left(\\frac{N_{0}}{2}\\right)E_{s}$。因此，输出采样点的总噪声加干扰功率为\n$$\n\\left(\\frac{N_{0}}{2}\\right)E_{s}+(C\\,S_{1})^{2}.\n$$\n所以，\n$$\nSNR_{\\text{degraded}}=\\frac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}.\n$$\n\n性能下降比率为\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}}{\\dfrac{E_{s}^{2}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}}}\n=\\frac{\\left(\\frac{N_{0}}{2}\\right)E_{s}}{\\left(\\frac{N_{0}}{2}\\right)E_{s}+C^{2}S_{1}^{2}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}}.\n$$\n对于矩形脉冲，$E_{s}=A^{2}T$ 且 $S_{1}=AT$，所以\n$$\n\\frac{2\\,C^{2}S_{1}^{2}}{N_{0}E_{s}}=\\frac{2\\,C^{2}\\,A^{2}T^{2}}{N_{0}\\,A^{2}T}=\\frac{2\\,C^{2}T}{N_{0}},\n$$\n由此得出\n$$\n\\frac{SNR_{\\text{degraded}}}{SNR_{\\text{ideal}}}\n=\\frac{1}{1+\\dfrac{2\\,C^{2}T}{N_{0}}}\n=\\frac{N_{0}}{N_{0}+2\\,C^{2}T}.\n$$\n该表达式仅依赖于 $C$、$T$ 和 $N_{0}$，符合要求。", "answer": "$$\\boxed{\\frac{N_{0}}{N_{0}+2C^{2}T}}$$", "id": "1736640"}, {"introduction": "掌握了基本原理和局限性后，我们进入一个更高级的滤波器设计挑战。这个练习要求我们设计的滤波器不仅要在噪声中检测出目标信号，还必须完全消除一个已知的干扰信号。这引导我们进入约束优化滤波器设计的领域，通过引入信号空间正交化的概念，解决在复杂信号环境中进行可靠检测的关键问题 [@problem_id:1736682]。", "problem": "为了进行信号检测应用，需要设计一个脉冲响应为 $h(t)$ 的线性时不变滤波器。滤波器的输入是一个接收信号 $r(t)$，它是所需信号分量 $s_1(t)$、干扰信号分量 $s_2(t)$ 和加性高斯白噪声 (AWGN) $n(t)$ 的叠加。噪声 $n(t)$ 具有恒定的双边功率谱密度 $N_0/2$。所需信号和干扰信号均为因果信号，在时间区间 $[0, T]$ 上的定义如下：\n$$ s_1(t) = \\begin{cases} A,  0 \\le t \\le T \\\\ 0,  \\text{其他} \\end{cases} $$\n$$ s_2(t) = \\begin{cases} B \\frac{t}{T},  0 \\le t \\le T \\\\ 0,  \\text{其他} \\end{cases} $$\n这里，$A$ 和 $B$ 是表示信号幅度的非零实常数。\n\n滤波器的设计需要满足在特定采样时刻 $t=T$ 的两个准则：\n1. 由干扰信号 $s_2(t)$ 产生的滤波器输出分量必须恰好为零。\n2. 输出信噪比 (SNR) 必须最大化。信噪比定义为由所需信号 $s_1(t)$ 产生的输出分量的幅值平方除以输出噪声分量的方差。\n\n确定在这两个约束条件下可以实现的最大可能输出信噪比。请用参数 $A$、$B$、$T$ 和 $N_0$ 的闭合形式解析表达式来表示你的答案。", "solution": "设滤波器在时间 $T$ 的输出为 $y(T) = \\int_{-\\infty}^{\\infty} h(\\tau) r(T-\\tau) \\, d\\tau$。将 $r(t) = s_{1}(t) + s_{2}(t) + n(t)$ 分解为所需信号、干扰和噪声项。因此，在 $t=T$ 时，\n$$\ny(T) = y_{1}(T) + y_{2}(T) + y_{n}(T),\n$$\n其中\n$$\ny_{1}(T) = \\int h(\\tau) s_{1}(T-\\tau) \\, d\\tau, \\quad y_{2}(T) = \\int h(\\tau) s_{2}(T-\\tau) \\, d\\tau, \\quad y_{n}(T) = \\int h(\\tau) n(T-\\tau) \\, d\\tau.\n$$\n定义内积 $\\langle f,g\\rangle \\triangleq \\int_{-\\infty}^{\\infty} f(\\tau) g^{*}(\\tau) \\, d\\tau$ 和范数 $\\|f\\|^{2} \\triangleq \\langle f,f\\rangle$。令 $a(\\tau) \\triangleq s_{1}(T-\\tau)$ 和 $b(\\tau) \\triangleq s_{2}(T-\\tau)$。则 $y_{1}(T) = \\langle h,a\\rangle$，$y_{2}(T) = \\langle h,b\\rangle$。干扰置零约束为\n$$\n\\langle h,b\\rangle = 0.\n$$\n对于双边功率谱密度为 $N_{0}/2$ 的加性高斯白噪声，在时间 $T$ 的输出噪声方差为\n$$\n\\sigma_{n}^{2} = \\frac{N_{0}}{2} \\int |h(\\tau)|^{2} \\, d\\tau = \\frac{N_{0}}{2} \\|h\\|^{2}.\n$$\n因此，输出信噪比为\n$$\n\\mathrm{SNR}(h) = \\frac{|\\langle h,a\\rangle|^{2}}{\\sigma_{n}^{2}} = \\frac{2}{N_{0}} \\frac{|\\langle h,a\\rangle|^{2}}{\\|h\\|^{2}},\n$$\n需要在约束条件 $\\langle h,b\\rangle=0$ 下最大化。将 $a$ 分解为平行于 $b$ 和正交于 $b$ 的分量：\n$$\na = a_{\\parallel} + a_{\\perp}, \\quad a_{\\parallel} = \\frac{\\langle a,b\\rangle}{\\|b\\|^{2}} b, \\quad \\langle a_{\\perp}, b\\rangle = 0.\n$$\n对于任何满足 $\\langle h,b\\rangle=0$ 的 $h$，我们有 $\\langle h,a\\rangle = \\langle h,a_{\\perp}\\rangle$，并且根据柯西-施瓦茨不等式 (Cauchy-Schwarz)，\n$$\n\\frac{|\\langle h,a\\rangle|^{2}}{\\|h\\|^{2}} = \\frac{|\\langle h,a_{\\perp}\\rangle|^{2}}{\\|h\\|^{2}} \\le \\|a_{\\perp}\\|^{2},\n$$\n当 $h$ 与 $a_{\\perp}$ 成比例时等号成立。因此，\n$$\n\\mathrm{SNR}_{\\max} = \\frac{2}{N_{0}} \\|a_{\\perp}\\|^{2} = \\frac{2}{N_{0}} \\left( \\|a\\|^{2} - \\frac{|\\langle a,b\\rangle|^{2}}{\\|b\\|^{2}} \\right).\n$$\n现在计算 $a$ 和 $b$。由于当 $t\\in[0,T]$ 时 $s_{1}(t)=A$ 和 $s_{2}(t)=B t/T$，其他情况下为零，所以\n$$\na(\\tau) = s_{1}(T-\\tau) = \\begin{cases} A,  \\tau \\in [0,T] \\\\ 0,  \\text{其他} \\end{cases}, \\quad\nb(\\tau) = s_{2}(T-\\tau) = \\begin{cases} B \\frac{T-\\tau}{T},  \\tau \\in [0,T] \\\\ 0,  \\text{其他} \\end{cases}.\n$$\n因此，\n$$\n\\|a\\|^{2} = \\int_{0}^{T} A^{2} \\, d\\tau = A^{2} T,\n$$\n$$\n\\langle a,b\\rangle = \\int_{0}^{T} A \\cdot B \\frac{T-\\tau}{T} \\, d\\tau = \\frac{AB}{T} \\int_{0}^{T} (T-\\tau) \\, d\\tau = \\frac{ABT}{2},\n$$\n$$\n\\|b\\|^{2} = \\int_{0}^{T} \\left(B \\frac{T-\\tau}{T}\\right)^{2} d\\tau = \\frac{B^{2}}{T^{2}} \\int_{0}^{T} (T-\\tau)^{2} \\, d\\tau = \\frac{B^{2} T}{3}.\n$$\n因此，\n$$\n\\|a_{\\perp}\\|^{2} = \\|a\\|^{2} - \\frac{|\\langle a,b\\rangle|^{2}}{\\|b\\|^{2}} = A^{2} T - \\frac{(ABT/2)^{2}}{B^{2} T/3} = A^{2} T - \\frac{3 A^{2} T}{4} = \\frac{A^{2} T}{4}.\n$$\n代入信噪比表达式，\n$$\n\\mathrm{SNR}_{\\max} = \\frac{2}{N_{0}} \\cdot \\frac{A^{2} T}{4} = \\frac{A^{2} T}{2 N_{0}}.\n$$\n该值与 $B$ 无关，因为线性约束仅取决于 $s_{2}$ 在信号空间中的方向。", "answer": "$$\\boxed{\\frac{A^{2} T}{2 N_{0}}}$$", "id": "1736682"}]}