{"hands_on_practices": [{"introduction": "在我们深入研究谱估计的细微之处前，确认我们的主要工具——周期图——能够正确地反映信号的总能量是至关重要的。这个练习 [@problem_id:1730334] 为傅里叶分析的基石之一，即帕萨瓦尔定理（Parseval's theorem），提供了一个动手验证的机会。通过一个简单的例子，你将证明时域中的能量总和与周期图中各频率分量的能量贡献总和是等价的（仅相差一个比例因子），从而巩固对能量守恒在频域中体现的理解。", "problem": "一个离散时间信号 $x[n]$ 被定义为一个因果的、有限长度的几何序列，由下式给出\n$$\nx[n] = \\alpha^n, \\quad \\text{对于 } n = 0, 1, 2, ..., N-1\n$$\n其他情况下 $x[n]=0$。对于此特定问题，设底为 $\\alpha = \\frac{1}{2}$，信号长度为 $N=4$。\n\n该信号的 $N$ 点离散傅里叶变换 (DFT) 定义为\n$$\nX[k] = \\sum_{n=0}^{N-1} x[n] \\exp\\left(-j \\frac{2\\pi kn}{N}\\right), \\quad \\text{对于 } k = 0, 1, 2, ..., N-1\n$$\n其中 $j$ 是虚数单位。\n\n我们关心与此信号相关的两个量：\n1.  信号在时域中的总能量，由其样本的幅值平方和给出：$E = \\sum_{n=0}^{N-1} |x[n]|^{2}$。\n2.  其DFT系数的幅值平方和：$S = \\sum_{k=0}^{N-1} |X[k]|^{2}$。\n\n计算比值 $\\frac{S}{E}$ 的精确值。", "solution": "给定对于 $n=0,1,2,3$ 时 $x[n]=\\alpha^{n}$，其中 $\\alpha=\\frac{1}{2}$，及其 $N$ 点DFT\n$$\nX[k]=\\sum_{n=0}^{N-1}x[n]\\exp\\left(-j\\frac{2\\pi kn}{N}\\right),\\quad k=0,1,2,3,\n$$\n其中 $N=4$。与此定义一致的逆DFT为\n$$\nx[n]=\\frac{1}{N}\\sum_{k=0}^{N-1}X[k]\\exp\\left(j\\frac{2\\pi kn}{N}\\right).\n$$\n对于此DFT约定，帕塞瓦尔定理（Parseval's theorem）表明\n$$\n\\sum_{n=0}^{N-1}|x[n]|^{2}=\\frac{1}{N}\\sum_{k=0}^{N-1}|X[k]|^{2}.\n$$\n根据定义，时域能量为\n$$\nE=\\sum_{n=0}^{N-1}|x[n]|^{2}=\\sum_{n=0}^{3}\\left(\\frac{1}{2}\\right)^{2n}=\\sum_{n=0}^{3}\\left(\\frac{1}{4}\\right)^{n}.\n$$\n使用有限几何级数公式，\n$$\nE=\\frac{1-\\left(\\frac{1}{4}\\right)^{4}}{1-\\frac{1}{4}}=\\frac{1-\\frac{1}{256}}{\\frac{3}{4}}=\\frac{\\frac{255}{256}}{\\frac{3}{4}}=\\frac{255}{256}\\cdot\\frac{4}{3}=\\frac{85}{64}.\n$$\nDFT系数的幅值平方和为\n$$\nS=\\sum_{k=0}^{N-1}|X[k]|^{2}.\n$$\n应用帕塞瓦尔定理可得\n$$\nE=\\frac{1}{N}S\\quad\\Longrightarrow\\quad S=NE.\n$$\n因此，所求比值为\n$$\n\\frac{S}{E}=N=4.\n$$", "answer": "$$\\boxed{4}$$", "id": "1730334"}, {"introduction": "谱估计不仅仅是转换信号，它更关乎揭示信号的内在结构。维纳-辛钦定理（Wiener-Khinchin theorem）揭示了信号功率谱与其自相关函数之间的深刻联系，这一定理是现代谱估计的理论基础。这个实践问题 [@problem_id:1730338] 让你通过两种不同途径计算周期图并确认它们得出相同结果，从而对一个离散信号数值验证该定理，加深对时域相关性与频域功率分布之间关系的认识。", "problem": "一个有限离散时间信号由序列 $x[n] = \\{2, 0, -1, 3\\}$ 给出，其中 $n = 0, 1, 2, 3$，在其他情况下为零。信号的长度为 $N=4$。\n\n提出了两种不同的方法来分析该信号的频率内容。\n\n方法1涉及计算信号的周期图。一个序列 $y[n]$ 的 $N$ 点离散傅里叶变换 (DFT) 定义为 $Y[k] = \\sum_{n=0}^{N-1} y[n] \\exp(-j\\frac{2\\pi kn}{N})$。周期图功率谱密度估计 $P[k]$ 定义为 $P[k] = \\frac{1}{N} |X[k]|^2$，其中 $X[k]$ 是信号 $x[n]$ 的 $N$ 点 DFT。计算频率索引 $k=1$ 处的周期图值，并将此值表示为 $V_1$。\n\n方法2首先涉及计算信号自相关的估计。有偏循环自相关估计 $\\hat{R}_{xx}[m]$ 对于 $m=0, 1, \\dots, N-1$ 定义为 $\\hat{R}_{xx}[m] = \\frac{1}{N} \\sum_{n=0}^{N-1} x[n] x[(n-m) \\pmod N]$。然后通过对该自相关序列 $\\hat{R}_{xx}[m]$ 进行 $N$ 点 DFT 来获得谱估计 $S[k]$。计算该谱估计在频率索引 $k=1$ 处的值，并将此值表示为 $V_2$。\n\n按顺序报告 $V_1$ 和 $V_2$ 的数值。以小数形式表示你的答案。由于答案是精确值，你不需要四舍五入。", "solution": "给定一个长度为 $N=4$ 的有限序列 $x[n]$，其中 $x[0]=2$，$x[1]=0$，$x[2]=-1$，$x[3]=3$，在其他情况下 $x[n]=0$。$N$ 点 DFT 定义为 $X[k]=\\sum_{n=0}^{N-1} x[n]\\exp\\!\\left(-j\\frac{2\\pi kn}{N}\\right)$。\n\n方法1（周期图）：周期图定义为 $P[k]=\\frac{1}{N}|X[k]|^{2}$。对于 $k=1$ 和 $N=4$，令 $W=\\exp\\!\\left(-j\\frac{2\\pi}{4}\\right)=\\exp(-j\\frac{\\pi}{2})=-j$。则\n$$\nX[1]=x[0]W^{0}+x[1]W^{1}+x[2]W^{2}+x[3]W^{3}\n=2\\cdot 1+0\\cdot(-j)+(-1)\\cdot(-1)+3\\cdot j\n=3+3j.\n$$\n因此\n$$\n|X[1]|^{2}=3^{2}+(3)^{2}=18,\\quad\nP[1]=\\frac{1}{N}|X[1]|^{2}=\\frac{1}{4}\\cdot 18=\\frac{9}{2}=4.5.\n$$\n因此 $V_{1}=4.5$。\n\n方法2（有偏循环自相关的DFT）：有偏循环自相关为\n$$\n\\hat{R}_{xx}[m]=\\frac{1}{N}\\sum_{n=0}^{N-1}x[n]\\,x[(n-m)\\bmod N],\\quad m=0,1,2,3.\n$$\n计算每一项：\n$$\n\\hat{R}_{xx}[0]=\\frac{1}{4}\\big(2^{2}+0^{2}+(-1)^{2}+3^{2}\\big)=\\frac{14}{4},\n$$\n$$\n\\hat{R}_{xx}[1]=\\frac{1}{4}\\big(x[0]x[3]+x[1]x[0]+x[2]x[1]+x[3]x[2]\\big)=\\frac{1}{4}(6+0+0-3)=\\frac{3}{4},\n$$\n$$\n\\hat{R}_{xx}[2]=\\frac{1}{4}\\big(x[0]x[2]+x[1]x[3]+x[2]x[0]+x[3]x[1]\\big)=\\frac{1}{4}(-2+0-2+0)=-1,\n$$\n$$\n\\hat{R}_{xx}[3]=\\frac{1}{4}\\big(x[0]x[1]+x[1]x[2]+x[2]x[3]+x[3]x[0]\\big)=\\frac{1}{4}(0+0-3+6)=\\frac{3}{4}.\n$$\n因此，对于 $m=0,1,2,3$，$\\hat{R}_{xx}[m]=\\left\\{\\frac{14}{4},\\frac{3}{4},-1,\\frac{3}{4}\\right\\}$。谱估计是 $\\hat{R}_{xx}[m]$ 的 $N$ 点 DFT：\n$$\nS[k]=\\sum_{m=0}^{N-1}\\hat{R}_{xx}[m]\\exp\\!\\left(-j\\frac{2\\pi km}{N}\\right).\n$$\n对于 $k=1$ 且 $W=\\exp\\!\\left(-j\\frac{2\\pi}{4}\\right)=-j$，\n$$\nS[1]=\\hat{R}_{xx}[0]W^{0}+\\hat{R}_{xx}[1]W^{1}+\\hat{R}_{xx}[2]W^{2}+\\hat{R}_{xx}[3]W^{3}\n=\\frac{14}{4}+ \\frac{3}{4}(-j)+(-1)(-1)+\\frac{3}{4}j\n=\\frac{14}{4}+1=\\frac{18}{4}=\\frac{9}{2}=4.5.\n$$\n因此 $V_{2}=4.5$。\n\n两种方法结果一致，这与此处使用的循环（有偏）自相关和DFT归一化的维纳-辛钦定理相符：$S[k]=\\frac{1}{N}|X[k]|^{2}$。", "answer": "$$\\boxed{\\begin{pmatrix} 4.5 & 4.5 \\end{pmatrix}}$$", "id": "1730338"}, {"introduction": "在实际应用中，谱估计最常见的挑战之一是“频谱泄漏”，即单个频率的能量看似扩散到了多个频率仓（bin）中，导致测量不准确。这个练习 [@problem_id:1730337] 展示了一个真实的工程场景，你必须设计一个测量方案，以完全避免特定目标频率出现此问题。通过确定相干采样所需的样本数，你将深入理解观测时间、采样率和频率分辨率之间的基本关系，这是精确进行频率测量的关键。", "problem": "一位电气工程师正在为本地电网设计一个数字监控系统。该系统以 $f_s = 8000$ Hz 的速率对电压波形进行采样，并使用离散傅里叶变换 (DFT) 进行频率分析。该工程师希望对一个在电网稳定性测试中观测到的特定、已知的非标称频率 $f_0 = 60.125$ Hz 实现完美的频率分辨率。为此，必须选择合适的信号采集时间，使得频率 $f_0$ 精确地与 DFT 的某个频率仓对齐。这种被称为相干采样的技术，可以消除频率为 $f_0$ 的分量的一种称为频谱泄漏的频谱分析误差。\n\n系统必须采集的满足此条件的最小正采样点数 $N$ 是多少？", "solution": "对于一个以速率 $f_{s}$ 采样的序列的 $N$ 点 DFT，第 $k$ 个 DFT 频率仓的频率由下式给出\n$$\nf_{k}=\\frac{k f_{s}}{N}, \\quad k \\in \\{0,1,\\ldots,N-1\\}.\n$$\n对频率为 $f_{0}$ 的分量进行相干采样，要求 $f_{0}$ 与某个频率仓 $f_{k}$ 重合，即\n$$\nf_{0}=\\frac{k f_{s}}{N} \\quad \\Longleftrightarrow \\quad \\frac{f_{0}}{f_{s}}=\\frac{k}{N},\n$$\n其中 $k$ 和 $N$ 为整数。将比率 $\\frac{f_{0}}{f_{s}}$ 写成最简分数形式，最小正整数解的 $k$ 等于分子，$N$ 等于分母。\n\n当 $f_{s}=8000$ 且 $f_{0}=60.125$ 时，将 $f_{0}$ 表示为一个有理数：\n$$\n60.125=60+\\frac{1}{8}=\\frac{480}{8}+\\frac{1}{8}=\\frac{481}{8}.\n$$\n因此，\n$$\n\\frac{f_{0}}{f_{s}}=\\frac{\\frac{481}{8}}{8000}=\\frac{481}{64000}.\n$$\n由于 $64000=2^{9}\\cdot 5^{3}$ 且 $481=13\\cdot 37$，分数 $\\frac{481}{64000}$ 已经是最简分数。因此，满足 $\\frac{f_{0}}{f_{s}}=\\frac{k}{N}$ 的最小整数是 $k=481$ 和 $N=64000$。因此，所需的最小正采样点数是\n$$\nN=64000.\n$$\n等效地，这确保了在采样窗口内有整数个周期，因为\n$$\nf_{0}\\frac{N}{f_{s}}=\\frac{f_{0}}{f_{s}}N=\\frac{481}{64000}N=481\n$$\n当 $N=64000$ 时，上式结果为 481，这是一个整数，从而消除了频率为 $f_{0}$ 的分量的频谱泄漏。", "answer": "$$\\boxed{64000}$$", "id": "1730337"}]}