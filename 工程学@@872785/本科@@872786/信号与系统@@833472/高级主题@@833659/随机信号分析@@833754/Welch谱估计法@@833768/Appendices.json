{"hands_on_practices": [{"introduction": "在使用韦尔奇方法时，首要步骤是确定如何将信号分割成段。本练习旨在帮助你实践计算数据段的总数，这是一个关键参数，它直接影响最终功率谱估计的统计稳定性。掌握这一基础计算是正确设置任何基于韦尔奇方法的光谱分析的前提 [@problem_id:1773288]。", "problem": "一位工程师正在使用韦尔奇法 (Welch's method) 来估计从一个深空探测器接收到的噪声信号的功率谱密度 (PSD)。记录的离散时间信号总共包含 $N=8192$ 个样本。为了进行分析，该信号将被分割成多个长度为 $L=512$ 个样本的窗口。为了提高估计的统计稳定性，设计连续的段之间有75%的重叠。计算在此过程中为求平均而创建的数据段的总数。", "solution": "设 $N$ 为信号中的总样本数，$L$ 为每段的长度，$P$ 为重叠百分比。我们已知：\n- 总样本数，$N = 8192$。\n- 段长度，$L = 512$ 样本。\n- 重叠百分比，$P = 75\\% = 0.75$。\n\n首先，我们计算任意两个连续段之间重叠的样本数。这等于重叠百分比乘以段长度。\n$$\n\\text{重叠样本数} = P \\times L = 0.75 \\times 512 = 384 \\text{ 样本}\n$$\n\n接下来，我们确定“跳跃尺寸”或“步长”，我们将其表示为 $S$。步长是窗口为获取下一段而移动的样本数。它等于段长度与重叠样本数之差。\n$$\nS = L - (\\text{重叠样本数}) = 512 - 384 = 128 \\text{ 样本}\n$$\n\n设 $K$ 为总段数。第一段从样本索引0开始。第二段从索引 $S$ 开始。第三段从 $2S$ 开始，依此类推。第 $k$ 段（其中 $k$ 是从1到 $K$ 的整数）从样本索引 $(k-1)S$ 开始。\n\n为使一个段有效，它必须完全包含在信号的总长度 $N$ 内。第 $k$ 段的最后一个样本位于索引 $(k-1)S + L - 1$ 处。该索引必须小于 $N$。\n$$\n(k-1)S + L - 1  N\n$$\n确保整个段被包含在内的一个更直接的方法是，段的起始位置加上其长度不能超过总样本数：\n$$\n(k-1)S + L \\le N\n$$\n\n我们想要找到满足此条件的最大整数 $k$（这将是我们的总段数 $K$）。\n$$\n(K-1)S \\le N - L\n$$\n$$\nK - 1 \\le \\frac{N - L}{S}\n$$\n因为 $K-1$ 必须是整数，我们对右侧进行向下取整，以找到 $K-1$ 的最大可能值。\n$$\nK - 1 = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor\n$$\n因此，总段数 $K$ 为：\n$$\nK = \\left\\lfloor \\frac{N - L}{S} \\right\\rfloor + 1\n$$\n\n现在，我们将给定的数值代入此公式：\n$$\nK = \\left\\lfloor \\frac{8192 - 512}{128} \\right\\rfloor + 1\n$$\n$$\nK = \\left\\lfloor \\frac{7680}{128} \\right\\rfloor + 1\n$$\n进行除法运算：\n$$\n\\frac{7680}{128} = 60\n$$\n所以，我们得到：\n$$\nK = \\lfloor 60 \\rfloor + 1 = 60 + 1 = 61\n$$\n\n因此，为进行分析总共创建了61个段。", "answer": "$$\\boxed{61}$$", "id": "1773288"}, {"introduction": "韦尔奇方法的核心在于频率分辨率和方差减小之间的权衡。这个思想实验要求你通过观察功率谱密度图的定性特征——例如谱峰的宽度和噪声基底的平滑度——来推断出所使用的段长度参数。理解这种权衡关系对于正确解读频谱估计结果和在信号分析中做出明智决策至关重要 [@problem_id:1773291]。", "problem": "一位工程师的任务是分析一个离散时间信号 $x[n]$，已知该信号是两个不同正弦分量与加性白噪声的总和。为了估计信号的频率成分，该工程师使用韦尔奇（Welch）方法计算功率谱密度（PSD）。从完全相同的信号 $x[n]$ 生成了两个独立的估计，并分别标记为估计 A 和估计 B。\n\n两次计算之间唯一改变的参数是韦尔奇算法中使用的单个分段的长度。所有其他参数，例如窗函数的选择和分段之间的重叠百分比，都保持相同。\n\n通过比较得到的两个 PSD 图，可以得出以下定性观察结果：\n\n*   **估计 A：** 图中显示了两个清晰的峰，但它们非常宽且有些模糊。图的基线（代表本底噪声）非常平滑，几乎没有随机波动。\n*   **估计 B：** 图中在两个正弦波的频率处显示了两个极其尖锐和清晰的峰。然而，整个图（包括本底噪声）看起来很锯齿状，并且从一个频率仓到下一个频率仓具有高度的随机尖峰变化。\n\n根据这些描述，用于估计 A 的分段长度 $L_A$ 和用于估计 B 的分段长度 $L_B$ 之间是什么关系？\n\nA. $L_A  L_B$\n\nB. $L_A > L_B$\n\nC. $L_A = L_B$\n\nD. 在不知道总信号长度的情况下无法确定关系。\n\nE. 在不知道所用窗函数的情况下无法确定关系。", "solution": "韦尔奇方法通过对长度为 $L$ 的分段上计算的加窗、重叠的周期图进行平均来估计功率谱密度。设总数据长度为 $N$，重叠为固定比例 $\\rho$（在两个估计中相同），窗函数 $w[n]$ 固定。\n\n1) 韦尔奇估计器的定义：\n对于分段索引 $k=0,\\ldots,K-1$，构造\n$$\nX_{k}[m] = \\sum_{n=0}^{L-1} x_{k}[n]\\,w[n]\\exp\\!\\left(-j\\frac{2\\pi mn}{L}\\right),\n$$\n以及每段的周期图\n$$\nI_{k}[m] = \\frac{1}{U L}\\,|X_{k}[m]|^{2}, \\quad U = \\frac{1}{L}\\sum_{n=0}^{L-1} w^{2}[n].\n$$\n韦尔奇 PSD 估计为\n$$\n\\hat{S}[m] = \\frac{1}{K}\\sum_{k=0}^{K-1} I_{k}[m].\n$$\n\n2) 频率分辨率与分段长度的关系：\n谱窗为 $W(\\omega)=\\sum_{n=0}^{L-1} w[n]\\exp(-j\\omega n)$。其主瓣宽度满足\n$$\n\\Delta\\omega_{\\text{ML}} = \\frac{c_{w}}{L},\n$$\n其中 $c_{w}$ 仅取决于所选的窗函数（在两个估计中相同）。因此，较大的 $L$ 产生较小的 $\\Delta\\omega_{\\text{ML}}$，即更尖锐、分辨率更好的谱峰；较小的 $L$ 产生较宽的谱峰。\n\n3) 通过平均降低方差以及对 $L$ 的依赖性：\n在固定的窗函数和重叠下，韦尔奇估计器的方差与平均分段的有效数量 $K$ 成反比：\n$$\n\\operatorname{var}\\{\\hat{S}[m]\\} \\propto \\frac{1}{K},\n$$\n相差一个仅取决于窗函数和重叠的常数（在此均固定）。对于固定的 $N$ 和重叠比例 $\\rho$，增加 $L$ 会减少 $K$（能放入 $N$ 中的分段更少），而减少 $L$ 会增加 $K$（分段更多）。因此，较大的 $L$ 意味着更“锯齿状”的 PSD（更高方差），而较小的 $L$ 意味着更平滑的 PSD（更低方差）。\n\n4) 将观察结果映射到 $L$：\n- 估计 A：宽而模糊的峰（分辨率差）和非常平滑的本底噪声（低方差）意味着小的 $L$ 和大的 $K$。\n- 估计 B：极其尖锐的峰（分辨率好）和锯齿状、有尖峰的本底噪声（高方差）意味着大的 $L$ 和小的 $K$。\n\n因此，分段长度满足\n$$\nL_{A}  L_{B}.\n$$\n这个结论仅取决于在固定的窗函数和重叠下，$L$ 如何影响分辨率和方差；除了知道两个估计中的窗函数相同之外，它不需要知道总长度 $N$ 或具体的窗函数。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1773291"}, {"introduction": "为何韦尔奇方法要对功率（即幅度的平方）进行平均，而不是直接平均复数傅里叶变换结果？本问题深入探讨了这种“非相干平均”背后的统计学原理。通过与“相干平均”方法的对比，该练习揭示了韦尔奇方法的核心机制：它通过避免不同数据段中随机相位的相互抵消，从而确保了对随机信号功率的准确估计 [@problem_id:1773260]。", "problem": "一位工程师正在开发一种自定义的信号处理程序，用于估计平稳随机信号的功率谱密度 (PSD)。标准方法，即 Welch 方法，包括将信号分成多个段，计算每段的离散傅里叶变换 (DFT)，并对这些 DFT 的幅值平方进行平均。\n\n该工程师决定研究一种替代方法。长的输入信号被分成 $L$ 个长度相等且不重叠的段。对每段计算 DFT，得到每个离散频率点 $k$ 的一组复数值谱 $\\{X_1[k], X_2[k], \\dots, X_L[k]\\}$。\n\n提出了两种不同的平均方法来获取特定频率点 $k$ 的最终 PSD 估计值：\n\n方法 A（标准非相干平均）：估计值 $P_A[k]$ 是通过对各个 DFT 的功率（幅值平方）进行平均来计算的。\n$$P_A[k] = \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2$$\n\n方法 B（替代相干平均）：估计值 $P_B[k]$ 是通过先对复数 DFT 结果进行平均，然后计算该平均值的幅值平方来得到的。\n$$P_B[k] = \\left| \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right|^2$$\n\n为了分析这些估计器的性能，假设基础信号是一个零均值、宽义平稳的随机过程。这意味着对于任何给定的频率点 $k$（不对应于直流分量），不同段 $i = 1, \\dots, L$ 的复数 DFT 系数 $X_i[k]$ 可以被建模为独立同分布 (i.i.d.) 的复随机变量，其期望值为零，即 $E[X_i[k]] = 0$。\n\n确定方法 B 估计值的期望值与方法 A 估计值的期望值之间的理论比率。即，求出 $\\frac{E[P_B[k]]}{E[P_A[k]]}$ 的表达式。", "solution": "目标是计算比率 $\\frac{E[P_B[k]]}{E[P_A[k]]}$。我们将分别计算每个估计器 $P_A[k]$ 和 $P_B[k]$ 的期望值。\n\n首先，我们分析方法 A，即标准非相干平均。该估计器由下式给出：\n$$P_A[k] = \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2$$\n我们取该表达式的期望值。由于期望算子的线性性质，我们可以将其移到求和符号内部：\n$$E[P_A[k]] = E\\left[ \\frac{1}{L} \\sum_{i=1}^{L} |X_i[k]|^2 \\right] = \\frac{1}{L} \\sum_{i=1}^{L} E[|X_i[k]|^2]$$\n题目说明复数 DFT 系数 $X_i[k]$ 对于 $i=1, \\dots, L$ 是独立同分布 (i.i.d.) 的。这意味着期望幅值平方 $E[|X_i[k]|^2]$ 对所有段 $i$ 都是相同的。让我们将这个常数值表示为 $\\sigma_X^2$，它代表信号在频率点 $k$ 处的真实功率。\n$$E[|X_1[k]|^2] = E[|X_2[k]|^2] = \\dots = E[|X_L[k]|^2] = \\sigma_X^2$$\n将此代入 $E[P_A[k]]$ 的表达式中：\n$$E[P_A[k]] = \\frac{1}{L} \\sum_{i=1}^{L} \\sigma_X^2 = \\frac{1}{L} (L \\cdot \\sigma_X^2) = \\sigma_X^2$$\n这表明方法 A 的估计器是真实功率 $\\sigma_X^2$ 的无偏估计。\n\n接下来，我们分析方法 B，即替代相干平均。该估计器为：\n$$P_B[k] = \\left| \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right|^2$$\n为了求其期望值 $E[P_B[k]]$，我们使用这样一个性质：对于任何复随机变量 $Z$，其期望幅值平方与其方差和均值有关，即 $E[|Z|^2] = \\text{Var}(Z) + |E[Z]|^2$。\n我们定义复随机变量 $Z = \\frac{1}{L} \\sum_{i=1}^{L} X_i[k]$。那么 $P_B[k] = |Z|^2$。\n我们首先计算 $Z$ 的均值：\n$$E[Z] = E\\left[ \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right] = \\frac{1}{L} \\sum_{i=1}^{L} E[X_i[k]]$$\n题目说明该过程是零均值的，这导致对所有 $i$ 都有 $E[X_i[k]] = 0$。因此：\n$$E[Z] = \\frac{1}{L} \\sum_{i=1}^{L} 0 = 0$$\n接下来，我们计算 $Z$ 的方差。由于 $X_i[k]$ 是独立的，它们的和的方差等于它们方差的和。\n$$\\text{Var}(Z) = \\text{Var}\\left( \\frac{1}{L} \\sum_{i=1}^{L} X_i[k] \\right) = \\frac{1}{L^2} \\text{Var}\\left( \\sum_{i=1}^{L} X_i[k] \\right) = \\frac{1}{L^2} \\sum_{i=1}^{L} \\text{Var}(X_i[k])$$\n单个复随机变量 $X_i[k]$ 的方差由 $\\text{Var}(X_i[k]) = E[|X_i[k]|^2] - |E[X_i[k]]|^2$ 给出。由于 $E[X_i[k]] = 0$，这可以简化为：\n$$\\text{Var}(X_i[k]) = E[|X_i[k]|^2] - 0 = \\sigma_X^2$$\n由于这些变量是独立同分布的，所以所有 $i$ 的方差都相同。将此代回 $\\text{Var}(Z)$ 的表达式中：\n$$\\text{Var}(Z) = \\frac{1}{L^2} \\sum_{i=1}^{L} \\sigma_X^2 = \\frac{1}{L^2} (L \\cdot \\sigma_X^2) = \\frac{\\sigma_X^2}{L}$$\n现在我们可以计算 $P_B[k]$ 的期望值：\n$$E[P_B[k]] = E[|Z|^2] = \\text{Var}(Z) + |E[Z]|^2 = \\frac{\\sigma_X^2}{L} + |0|^2 = \\frac{\\sigma_X^2}{L}$$\n这表明方法 B 估计值的期望是有偏的，并且比真实功率小一个因子 $L$。\n\n最后，我们计算所求的比率：\n$$\\frac{E[P_B[k]]}{E[P_A[k]]} = \\frac{\\sigma_X^2 / L}{\\sigma_X^2} = \\frac{1}{L}$$\n这个比率表明，在对幅值求平方之前对复数 DFT 进行相干平均，会使期望功率估计值减少一个等于分段数 $L$ 的因子。这是因为来自不同段的 DFT 系数的随机相位在平均过程中倾向于相互抵消。", "answer": "$$\\boxed{\\frac{1}{L}}$$", "id": "1773260"}]}