{"hands_on_practices": [{"introduction": "理解任何系统的第一步是识别其基本特性。本练习将引导你从一个系统的差分方程（一种常见的实践描述方式）出发，推导出其传递函数。核心任务是检验该系统是否满足全通系统的定义性特征——即在所有频率上都具有恒定的幅值响应，从而为更深入的分析奠定基础。[@problem_id:1696641]", "problem": "一个因果的离散时间线性时不变 (LTI) 系统被设计为一个简单的相位均衡器。它通过以下差分方程将输出信号 $y[n]$ 与输入信号 $x[n]$ 相关联：\n\n$$y[n] - 0.25y[n-1] = x[n-1] - 0.25x[n]$$\n\n你的任务是确定该系统的传递函数 $H(z) = Y(z)/X(z)$，并判断它是否为一个全通系统。全通系统被定义为其频率响应的幅值对所有频率都为常数的系统。\n\n下列哪个陈述准确地描述了该系统？\n\nA. 传递函数为 $H(z) = \\frac{z^{-1} - 0.25}{1 - 0.25z^{-1}}$，且该系统是全通系统。\n\nB. 传递函数为 $H(z) = \\frac{z^{-1} - 0.25}{1 - 0.25z^{-1}}$，且该系统不是全通系统。\n\nC. 传递函数为 $H(z) = \\frac{1 - 0.25z^{-1}}{z^{-1} - 0.25}$，且该系统是全通系统。\n\nD. 传递函数为 $H(z) = \\frac{z - 0.25}{1 - 0.25z}$，且该系统不是全通系统。\n\nE. 传递函数为 $H(z) = \\frac{z^{-1} + 0.25}{1 + 0.25z^{-1}}$，且该系统不是全通系统。", "solution": "从给定的因果 LTI 差分方程开始：\n$$\ny[n]-\\frac{1}{4}y[n-1]=x[n-1]-\\frac{1}{4}x[n].\n$$\n在零初始条件下对等式两边进行 $z$ 变换，并利用线性和移位性质 $\\mathcal{Z}\\{x[n-k]\\}=z^{-k}X(z)$，得到\n$$\nY(z)-\\frac{1}{4}z^{-1}Y(z)=z^{-1}X(z)-\\frac{1}{4}X(z).\n$$\n对 $Y(z)$ 和 $X(z)$ 进行因式分解，得到\n$$\n\\bigl(1-\\tfrac{1}{4}z^{-1}\\bigr)Y(z)=\\bigl(z^{-1}-\\tfrac{1}{4}\\bigr)X(z).\n$$\n因此，传递函数为\n$$\nH(z)\\equiv\\frac{Y(z)}{X(z)}=\\frac{z^{-1}-\\tfrac{1}{4}}{1-\\tfrac{1}{4}z^{-1}}.\n$$\n为了检验全通特性，在单位圆 $z=\\exp(j\\omega)$ 上计算频率响应：\n$$\nH\\bigl(\\exp(j\\omega)\\bigr)=\\frac{\\exp(-j\\omega)-\\tfrac{1}{4}}{1-\\tfrac{1}{4}\\exp(-j\\omega)}.\n$$\n计算幅度的平方：\n$$\n\\left|H\\bigl(\\exp(j\\omega)\\bigr)\\right|^{2}\n= \\frac{\\left(\\exp(-j\\omega)-\\tfrac{1}{4}\\right)\\left(\\exp(j\\omega)-\\tfrac{1}{4}\\right)}{\\left(1-\\tfrac{1}{4}\\exp(-j\\omega)\\right)\\left(1-\\tfrac{1}{4}\\exp(j\\omega)\\right)}.\n$$\n展开分子和分母：\n$$\n\\left(\\exp(-j\\omega)-\\tfrac{1}{4}\\right)\\left(\\exp(j\\omega)-\\tfrac{1}{4}\\right)\n= 1-\\tfrac{1}{4}\\exp(j\\omega)-\\tfrac{1}{4}\\exp(-j\\omega)+\\left(\\tfrac{1}{4}\\right)^{2},\n$$\n$$\n\\left(1-\\tfrac{1}{4}\\exp(-j\\omega)\\right)\\left(1-\\tfrac{1}{4}\\exp(j\\omega)\\right)\n= 1-\\tfrac{1}{4}\\exp(j\\omega)-\\tfrac{1}{4}\\exp(-j\\omega)+\\left(\\tfrac{1}{4}\\right)^{2}.\n$$\n由于分子和分母相同，因此\n$$\n\\left|H\\bigl(\\exp(j\\omega)\\bigr)\\right|=1 \\quad \\text{for all } \\omega.\n$$\n因此该系统是全通的。与选项比较，正确的陈述是 $H(z)=\\frac{z^{-1}-0.25}{1-0.25z^{-1}}$ 且该系统是全通系统。", "answer": "$$\\boxed{A}$$", "id": "1696641"}, {"introduction": "全通系统的价值不在于改变信号的幅度，而在于调整其相位。群延迟是量化这种相移效应的关键指标，它衡量了不同频率分量通过系统时所经历的时间延迟。本练习将让你计算一个基本的一阶全通滤波器的群延迟，这有助于你直观地理解它如何作为相位均衡器来发挥作用。[@problem_id:1696624]", "problem": "一阶全通滤波器是数字信号处理中的一个基本组件，常用于音频系统中的相位均衡。考虑一个具有实值极点的稳定、因果、离散时间线性时不变 (LTI) 系统，其传递函数 $H(z)$ 描述为：\n$$H(z) = -\\frac{z^{-1}-a}{1-az^{-1}}$$\n此处，$a$ 是一个实值常数，满足 $|a|1$。\n\n群延迟，记作 $\\tau_g(\\omega)$，表征了信号中不同频率分量通过滤波器时所经历的延迟。它定义为滤波器的相位响应 $\\theta(\\omega) = \\arg\\{H(e^{j\\omega})\\}$ 相对于角频率 $\\omega$ 的负导数。数学上，\n$$\\tau_g(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega}$$\n其中 $H(e^{j\\omega})$ 是系统的频率响应。\n\n计算此全通滤波器在零频率（即 $\\omega = 0$ 时）的群延迟。你的最终答案应为一个关于常数 $a$ 的符号表达式。", "solution": "我们已知稳定、因果、离散时间 LTI 全通滤波器为\n$$H(z) = -\\frac{z^{-1}-a}{1-az^{-1}}, \\quad |a|1,$$\n我们需要求其在零频率处的群延迟，其定义为\n$$\\tau_{g}(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega}, \\quad \\theta(\\omega) = \\arg\\{H(e^{j\\omega})\\}.$$\n使用复频率响应的通用恒等式，\n$$\\frac{d\\theta(\\omega)}{d\\omega} = \\Im\\left\\{\\frac{d}{d\\omega}\\ln H(e^{j\\omega})\\right\\},$$\n群延迟变为\n$$\\tau_{g}(\\omega) = -\\Im\\left\\{\\frac{d}{d\\omega}\\ln H(e^{j\\omega})\\right\\}.$$\n\n代入 $z=e^{j\\omega}$，因此 $z^{-1}=u=e^{-j\\omega}$，并写出\n$$H(e^{j\\omega}) = H(u) = -\\frac{u - a}{1 - a u}.$$\n使用商法则对 $H(u)$ 关于 $u$ 求导。令 $f(u)=u-a$ 且 $g(u)=1-au$，则 $H(u)=-f(u)/g(u)$，$f'(u)=1$，$g'(u)=-a$。于是\n$$\\frac{dH}{du} = -\\frac{f'(u)g(u) - f(u)g'(u)}{g(u)^{2}} = -\\frac{(1)(1-au) - (u-a)(-a)}{(1-au)^{2}} = -\\frac{1 - a^{2}}{(1 - a u)^{2}}.$$\n接下来，使用链式法则，其中 $u=e^{-j\\omega}$，所以 $\\frac{du}{d\\omega} = -j u$。因此，\n$$\\frac{d}{d\\omega}\\ln H(e^{j\\omega}) = \\frac{1}{H(u)}\\frac{dH}{du}\\frac{du}{d\\omega} = \\frac{1}{H(u)}\\left(-\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right)(-j u) = -j\\,u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}.$$\n因此，\n$$\\tau_{g}(\\omega) = -\\Im\\left\\{-j\\,u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right\\} = \\Re\\left\\{u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}}\\right\\},$$\n因为对于任意复数 $Y$，有 $\\Im\\{-jY\\}=-\\Re\\{Y\\}$。\n\n现在计算 $1/H(u)$。由 $H(u) = -\\frac{u-a}{1-au}$，我们有\n$$\\frac{1}{H(u)} = -\\frac{1-au}{u-a}.$$\n因此，\n$$u\\,\\frac{1}{H(u)}\\,\\frac{1 - a^{2}}{(1 - a u)^{2}} = u\\left(-\\frac{1-au}{u-a}\\right)\\frac{1 - a^{2}}{(1 - a u)^{2}} = \\frac{u(1 - a^{2})}{(1 - a u)(u - a)}.$$\n所以，\n$$\\tau_{g}(\\omega) = \\Re\\left\\{\\frac{u(1 - a^{2})}{(1 - a u)(u - a)}\\right\\}, \\quad u=e^{-j\\omega}.$$\n\n在零频率处，$\\omega=0$ 意味着 $u=e^{-j\\cdot 0}=1$。代入 $u=1$ 得\n$$\\tau_{g}(0) = \\Re\\left\\{\\frac{1\\cdot(1 - a^{2})}{(1 - a\\cdot 1)(1 - a)}\\right\\} = \\frac{1 - a^{2}}{(1 - a)^{2}} = \\frac{(1 - a)(1 + a)}{(1 - a)^{2}} = \\frac{1 + a}{1 - a}.$$\n因为 $a$ 是实数且 $|a|1$，所以该表达式是实数且有限的。$H(z)$ 中总的常数因子 $-1$ 仅贡献一个恒定的相移，不影响群延迟。", "answer": "$$\\boxed{\\frac{1+a}{1-a}}$$", "id": "1696624"}, {"introduction": "从分析转向设计，本练习将展示如何根据特定要求构建一个全通滤波器。全通系统的一个关键结构特性是其零点和极点之间的倒数关系。这个问题将挑战你利用这一特性，基于一个给定的零点位置来构建一个稳定滤波器的传递函数，这是滤波器综合中的一项基本技能。[@problem_id:1696686]", "problem": "一位工程师正在为数字音频系统设计一个相位均衡级。该设计要求一个稳定的一阶线性时不变 (LTI) 全通滤波器，且其系数为实值。通过分析所需的相位响应，确定该滤波器的传递函数 $H(z)$ 必须在 $z = -2$ 处有一个单零点。\n\n为确保实现是唯一且性能良好的，该滤波器还必须满足两个额外标准：\n1.  滤波器被归一化以具有单位幅频响应，即对于所有频率 $\\omega$，$|H(e^{j\\omega})| = 1$。\n2.  滤波器在零频率 (DC) 处的增益必须为正，这对应于在 $z=1$ 处计算传递函数的值。\n\n确定该滤波器的传递函数 $H(z)$。请将您的答案表示为 $z$ 的有理函数。", "solution": "我们需要一个一阶、稳定、实系数的离散时间全通滤波器，它在 $z=-2$ 处有一个单零点，在单位圆上具有单位幅度，并且在直流 (DC) 处具有正增益。\n\n对于一个实系数一阶全通滤波器，其极点是零点的倒数（和复共轭）。对于一个位于 $z_{0}=-2$ 的实零点，为了满足全通条件和稳定性（极点模小于1），相应的极点必须位于 $p=1/z_{0}=-\\frac{1}{2}$。\n\n一个具有实参数 $a$ 且 $|a|1$ 的通用一阶全通传递函数为\n$$\nH(z)=c\\,\\frac{a+z^{-1}}{1+a z^{-1}},\n$$\n其中 $|c|=1$ 确保对所有 $\\omega$ 都有 $|H(e^{j\\omega})|=1$。这种形式在 $z=-\\frac{1}{a}$ 处有一个零点，在 $z=-a$ 处有一个极点。匹配指定的零点 $z=-2$ 可得\n$$\n-\\frac{1}{a}=-2 \\quad\\Rightarrow\\quad a=\\frac{1}{2},\n$$\n所以极点位于 $z=-\\frac{1}{2}$，这是稳定的。\n\n为了强制直流增益为正，在 $z=1$ 处求值：\n$$\nH(1)=c\\,\\frac{a+1}{1+a}.\n$$\n当 $a=\\frac{1}{2}$ 时，这得出 $H(1)=c$。直流处的正增益要求 $c=1$。\n\n因此，\n$$\nH(z)=\\frac{\\frac{1}{2}+z^{-1}}{1+\\frac{1}{2} z^{-1}}.\n$$\n通过将分子和分母同乘以 $z$ 并消去分数，将其表示为 $z$ 的有理函数（不含负幂次）：\n$$\nH(z)=\\frac{\\frac{1}{2}z+1}{z+\\frac{1}{2}}=\\frac{z+2}{2z+1}.\n$$\n这个 $H(z)$ 在 $z=-2$ 处有零点，在 $z=-\\frac{1}{2}$ 处有极点（稳定），在单位圆上具有单位幅度，并且 $H(1)=10$，满足所有要求。", "answer": "$$\\boxed{\\frac{z+2}{2z+1}}$$", "id": "1696686"}]}