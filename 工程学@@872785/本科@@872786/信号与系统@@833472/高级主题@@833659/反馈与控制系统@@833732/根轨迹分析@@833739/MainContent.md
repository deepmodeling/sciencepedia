## 引言
在[控制系统设计](@entry_id:273663)与分析领域，预测和理解系统动态行为如何随参数变化而演变是至关重要的。根[轨迹分析](@entry_id:756092)法作为一种强大而直观的图解技术，为工程师们提供了洞察[系统稳定性](@entry_id:273248)和瞬态响应的深刻视角。它解决了在没有可视化工具的情况下，评估参数（如[控制器增益](@entry_id:262009)）变化对系统性能影响时所面临的繁琐计算问题，通过一张图展现了系统[闭环极点](@entry_id:274094)的所有可能位置。

本文将带领读者全面掌握[根轨迹法](@entry_id:273543)，从基本原理到高级应用。在接下来的“原理与机制”章节中，我们将深入剖析该方法的数学基础，包括决定轨迹形状的[相角条件](@entry_id:264793)和标定增益的幅值条件，并学习一系列系统性的绘制准则。随后的“应用与跨学科联系”章节将展示如何运用[根轨迹法](@entry_id:273543)进行稳定性分析、性能调谐以及设计高级控制器，并探讨其在电气、机械等领域的广泛联系。最后，通过“动手实践”环节，你将有机会运用所学知识解决具体工程问题，从而巩固和深化理解。

## 原理与机制

在[控制系统分析](@entry_id:261228)与设计中，[根轨迹法](@entry_id:273543)是一种强大而直观的图解技术。它揭示了当系统中的一个特定参数（通常是[控制器增益](@entry_id:262009) $K$）发生变化时，[闭环系统](@entry_id:270770)极点的动态演变过程。通过绘制这些极点在复平面（$s$-平面）上的运动轨迹，工程师能够深刻洞悉系统的稳定性、[瞬态响应](@entry_id:165150)和动态性能。本章旨在系统地阐述根[轨迹分析](@entry_id:756092)的基本原理和构建[根轨迹图](@entry_id:264447)的核心机制。

### 特征方程与[根轨迹](@entry_id:272958)概念

任何一个[线性时不变](@entry_id:276287)（LTI）[反馈控制系统](@entry_id:274717)的动态行为都由其**特征方程 (characteristic equation)** 的根（即**[闭环极点](@entry_id:274094) (closed-loop poles)**）所决定。对于一个标准的负反馈系统，其[闭环传递函数](@entry_id:275480) $T(s)$ 通常可以表示为：

$$
T(s) = \frac{G(s)}{1 + G(s)H(s)}
$$

其中 $G(s)$ 是[前向通路](@entry_id:275478)[传递函数](@entry_id:273897)，$H(s)$ 是反馈通路[传递函数](@entry_id:273897)。系统的特征方程即为[闭环传递函数](@entry_id:275480)的分母置零：

$$
1 + G(s)H(s) = 0
$$

在根[轨迹分析](@entry_id:756092)中，我们关注的是当一个参数（通常是增益 $K$）从 $0$ 变化到 $\infty$ 时，[闭环极点](@entry_id:274094)的变化情况。为此，我们将[开环传递函数](@entry_id:276280) $G(s)H(s)$ 写成包含增益 $K$ 的[标准形式](@entry_id:153058) $K L(s)$。这样，[特征方程](@entry_id:265849)就表达为：

$$
1 + K L(s) = 0
$$

这里，$K$ 是可变增益，$L(s)$ 是与 $K$ 无关的[开环传递函数](@entry_id:276280)部分。**[根轨迹](@entry_id:272958) (root locus)** 的定义就是：当增益 $K$ 从 $0$ 连续变化到 $\infty$ 时，满足此特征方程的所有根 $s$ 在复平面上描绘出的轨迹集合。

至关重要的一点是，必须明确区分开环系统和闭环系统。$L(s)$ 的[极点和零点](@entry_id:262457)分别被称为**[开环极点](@entry_id:272301) (open-loop poles)** 和**开环零点 (open-loop zeros)**，它们是构造根轨迹的起点。而根轨迹本身描绘的是**[闭环极点](@entry_id:274094) (closed-loop poles)** 的位置变化，它们直接决定了最终系统的性能 [@problem_id:2901905]。

例如，考虑一个用于小型卫星的单轴姿态控制系统。假设卫星的动力学模型（从执行器力矩到输出角度）为 $P(s) = \frac{1}{J s^2}$，并采用一个[超前补偿器](@entry_id:265388) $C(s) = K_c \frac{s+a}{s+b}$ 进行控制，构成一个单位[负反馈回路](@entry_id:267222)。系统的[开环传递函数](@entry_id:276280)为 $C(s)P(s)$。其[特征方程](@entry_id:265849)为：

$$
1 + C(s)P(s) = 1 + K_c \frac{s+a}{s+b} \frac{1}{J s^2} = 0
$$

为了进行根[轨迹分析](@entry_id:756092)，我们将其整理成[标准形式](@entry_id:153058)。若将[控制器增益](@entry_id:262009) $K_c$ 作为可变参数，即 $K = K_c$，则特征方程可写作 $1 + K L(s) = 0$，其中：

$$
L(s) = \frac{s+a}{J s^2 (s+b)}
$$

这个 $L(s)$ 就是用于绘制[根轨迹](@entry_id:272958)的[传递函数](@entry_id:273897) [@problem_id:1749601]。

### 矢量条件：幅值与[相角](@entry_id:274491)准则

[根轨迹](@entry_id:272958)的核心原理源于特征方程 $1 + K L(s) = 0$ 的一个简单重写：

$$
L(s) = -\frac{1}{K}
$$

由于我们通常考虑增益 $K$ 为正实数（$K > 0$），那么 $-\frac{1}{K}$ 就是一个负实数。这意味着，任何位于[根轨迹](@entry_id:272958)上的复数点 $s$ 都必须使 $L(s)$ 的计算结果为一个负实数。一个复数为负实数，必须同时满足两个条件：它的[相角](@entry_id:274491)是 $\pi$ 的奇数倍，它的幅值是某个正数。这两个条件分别被称为**[相角条件](@entry_id:264793) (angle condition)** 和**幅值条件 (magnitude condition)**，它们是构建和解释[根轨迹](@entry_id:272958)的基石。

#### [相角条件](@entry_id:264793)

[相角条件](@entry_id:264793)规定，对于任何一个属于[根轨迹](@entry_id:272958)的点 $s$（对应 $K > 0$），$L(s)$ 的[相角](@entry_id:274491)必须满足：

$$
\angle L(s) = (2k+1)\pi, \quad \text{其中 } k \text{ 为任意整数}
$$

这个条件决定了根轨迹的几何**形状**。也就是说，它定义了复平面上哪些点**可能**成为根轨迹的一部分。

我们可以赋予[相角条件](@entry_id:264793)一个深刻的几何解释。假设 $L(s)$ 有 $m$ 个零点 $z_1, z_2, \dots, z_m$ 和 $n$ 个极点 $p_1, p_2, \dots, p_n$，即：

$$
L(s) = \frac{\prod_{i=1}^{m} (s - z_i)}{\prod_{j=1}^{n} (s - p_j)}
$$

$L(s)$ 的总[相角](@entry_id:274491)等于其分子各项[相角](@entry_id:274491)之和减去分母各项[相角](@entry_id:274491)之和：

$$
\angle L(s) = \sum_{i=1}^{m} \angle(s - z_i) - \sum_{j=1}^{n} \angle(s - p_j)
$$

因此，[相角条件](@entry_id:264793)可以直观地表述为：从所有开环零点指向测试点 $s$ 的矢量的[相角](@entry_id:274491)之和，减去从所有[开环极点](@entry_id:272301)指向测试点 $s$ 的矢量的[相角](@entry_id:274491)之和，其结果必须等于 $\pi$ 的奇数倍 [@problem_id:2901841]。

例如，考虑[开环传递函数](@entry_id:276280) $L(s) = K \frac{s+2}{s(s+4)(s+6)}$。该系统有一个开环零点在 $z_1=-2$，三个[开环极点](@entry_id:272301)在 $p_1=0, p_2=-4, p_3=-6$。我们想验证测试点 $s^\star = -5$ 是否在根轨迹上。我们可以计算该点处的净[相角](@entry_id:274491)：

$$
\theta = \angle(s^\star - z_1) - \left[ \angle(s^\star - p_1) + \angle(s^\star - p_2) + \angle(s^\star - p_3) \right]
$$

$$
\theta = \angle(-5 - (-2)) - \left[ \angle(-5 - 0) + \angle(-5 - (-4)) + \angle(-5 - (-6)) \right]
$$

$$
\theta = \angle(-3) - \left[ \angle(-5) + \angle(-1) + \angle(1) \right] = \pi - (\pi + \pi + 0) = -\pi
$$

由于 $-\pi$ 是 $\pi$ 的奇数倍（当 $k=-1$ 时），[相角条件](@entry_id:264793)满足。因此，点 $s^\star = -5$ 确实位于根轨迹上。

#### 幅值条件

幅值条件规定，对于任何一个满足[相角条件](@entry_id:264793)的[根轨迹](@entry_id:272958)上的点 $s$，其对应的增益 $K$ 值由下式确定：

$$
|L(s)| = \frac{1}{K} \quad \implies \quad K = \frac{1}{|L(s)|}
$$

将 $L(s)$ 的表达式代入，我们得到：

$$
K = \frac{\prod_{j=1}^{n} |s - p_j|}{\prod_{i=1}^{m} |s - z_i|}
$$

这个条件为根轨迹上的每一点都“标记”了一个特定的增益值 $K$。几何上，$K$ 的值等于从所有[开环极点](@entry_id:272301)到点 $s$ 的矢量长度（距离）的乘积，再除以从所有开环零点到点 $s$ 的矢量长度的乘积。

继续上面的例子，我们可以计算出使[闭环极点](@entry_id:274094)落在 $s^\star = -5$ 处的增益 $K$ [@problem_id:2901841]：

$$
K = \frac{|s^\star(s^\star+4)(s^\star+6)|}{|s^\star+2|} \bigg|_{s^\star=-5} = \frac{|(-5)(-5+4)(-5+6)|}{|-5+2|} = \frac{|(-5)(-1)(1)|}{|-3|} = \frac{5}{3} \approx 1.667
$$

同样，对于一个[开环传递函数](@entry_id:276280)为 $L(s) = K \frac{s+1}{s(s+2)}$ 的系统，如果我们希望将一个[闭环极点](@entry_id:274094)放置在 $s=-4$ 处，我们可以通过幅值条件直接计算所需的增益 $K$ [@problem_id:1749628]：

$$
K = \frac{1}{|L(-4)|} = \left| \frac{s(s+2)}{s+1} \right|_{s=-4} = \left| \frac{(-4)(-4+2)}{-4+1} \right| = \left| \frac{(-4)(-2)}{-3} \right| = \frac{8}{3}
$$

### 基本性质与绘制准则

基于[相角](@entry_id:274491)和幅值条件，我们可以推导出一系列用于快速、准确地手绘[根轨迹图](@entry_id:264447)的准则。

#### 准则 1：分支数量

根轨迹的**分支数量**等于[开环传递函数](@entry_id:276280) $L(s)$ 的极点数 $n$。这是因为[特征方程](@entry_id:265849) $D(s) + K N(s) = 0$（其中 $L(s) = N(s)/D(s)$）是一个 $n$ 次多项式方程（假设 $n \ge m$），因此总有 $n$ 个根，即 $n$ 个[闭环极点](@entry_id:274094)。每个[闭环极点](@entry_id:274094)都随着 $K$ 的变化描绘出一条轨迹分支 [@problem_id:1749643]。例如，对于 $G(s)H(s) = K \frac{s+1}{s(s+2)(s+4)}$，系统有3个[开环极点](@entry_id:272301)，因此其根轨迹将有3条分支。

#### 准则 2：起点与终点

-   **起点 ($K=0$)**：当 $K=0$ 时，[特征方程](@entry_id:265849) $1+KL(s)=0$ 化为 $D(s)=0$。该方程的根正是 $L(s)$ 的极点。因此，[根轨迹](@entry_id:272958)的分支**起始于**[开环极点](@entry_id:272301)。[@problem_id:1749611]
-   **终点 ($K \to \infty$)**：当 $K \to \infty$ 时，[特征方程](@entry_id:265849)可以写成 $\frac{1}{K} + L(s) = 0$，这趋近于 $L(s)=0$，即 $N(s)=0$。因此，根轨迹的分支**终止于**开环零点。如果零点数 $m$ 小于极点数 $n$，则有 $n-m$ 条分支会终止于无穷远处的零点。

#### 准则 3：对称性

对于绝大多数物理系统，其[传递函数](@entry_id:273897)的[多项式系数](@entry_id:262287)都是实数。这意味着[开环极点和零点](@entry_id:276317)要么是实数，要么以[共轭复数对](@entry_id:150139)的形式出现。在这种情况下，[特征方程](@entry_id:265849) $D(s) + K N(s) = 0$ (其中 $K$ 为实数) 也必然是一个实系数多项式。根据[代数基本定理](@entry_id:152321)的推论（[共轭根定理](@entry_id:183977)），如果一个复数 $s_p$ 是该方程的根，那么它的共轭 $s_p^*$ 也必定是根。因此，[根轨迹图](@entry_id:264447)总是**关于实[轴对称](@entry_id:173333)**的。如果一个系统的[根轨迹](@entry_id:272958)不对称，那必然意味着其[开环传递函数](@entry_id:276280) $L(s)$ 具有非共轭的复数极点或零点，这在理论上是可能的，但在标准物理模型中非常罕见 [@problem_id:1749641]。

#### 准则 4：实轴上的[根轨迹](@entry_id:272958)

[实轴](@entry_id:148276)上的某一点是否属于根轨迹，可以直接用[相角条件](@entry_id:264793)来判断。对于[实轴](@entry_id:148276)上的一个测试点，所有位于其左侧的实数极点/零点贡献的[相角](@entry_id:274491)为 $0$ 或 $2\pi$，而所有位于其右侧的实数极点/零点贡献的[相角](@entry_id:274491)为 $\pi$。为了使总[相角](@entry_id:274491)为 $\pi$ 的奇数倍，该测试点**右侧的实数[开环极点和零点](@entry_id:276317)的总数必须为奇数**。

#### 准则 5：[渐近线](@entry_id:141820)

当 $n > m$ 时，有 $n-m$ 条[根轨迹](@entry_id:272958)分支会趋向于无穷远。当 $|s| \to \infty$ 时，这些分支会趋近于一组直线，称为**[渐近线](@entry_id:141820) (asymptotes)**。

-   **渐近线的交点 (质心)**：所有渐近线都交于[实轴](@entry_id:148276)上的一点，称为**[质心](@entry_id:265015) (centroid)**，记作 $\sigma_a$。其位置由以下公式计算：

    $$
    \sigma_a = \frac{\sum_{j=1}^{n} p_j - \sum_{i=1}^{m} z_i}{n - m}
    $$
    
    其中 $\sum p_j$ 和 $\sum z_i$ 分别是所有[开环极点和零点](@entry_id:276317)的和。例如，对于 $G(s)H(s) = \frac{K(s+5)}{s(s+2)(s+8)}$，有 $n=3$ 个极点（0, -2, -8）和 $m=1$ 个零点（-5）。[质心](@entry_id:265015)为 [@problem_id:1749626]：
    
    $$
    \sigma_a = \frac{(0 - 2 - 8) - (-5)}{3 - 1} = \frac{-5}{2} = -2.5
    $$
    
    对于更复杂的系统，如 $G(s) = K \frac{s + 5}{(s+1)(s+2)(s^2 + 6s + 13)}$，有 $n=4$ 个极点（-1, -2, 和 $s^2+6s+13=0$ 的两个根）和 $m=1$ 个零点（-5）。极点之和为 $(-1) + (-2) + (-6) = -9$。质心为 [@problem_id:1749609]：
    
    $$
    \sigma_a = \frac{(-9) - (-5)}{4 - 1} = -\frac{4}{3}
    $$
    
-   **[渐近线](@entry_id:141820)的角度**：这 $n-m$ 条渐近线与实轴正方向的夹角 $\phi_a$ 由下式给出：

    $$
    \phi_a = \frac{(2k+1)\pi}{n-m}, \quad \text{其中 } k = 0, 1, 2, \dots, n-m-1
    $$

#### 准则 6：分离角与[到达角](@entry_id:265527)

当[根轨迹](@entry_id:272958)从[重极点](@entry_id:262210)或复数极点出发，或到达重零点或复数零点时，我们需要确定其离开或进入该点的[切线](@entry_id:268870)方向。

-   **分离角 (Angle of Departure)**：从一个 $q$ 重[开环极点](@entry_id:272301) $p^*$ 出发的 $q$ 条[根轨迹](@entry_id:272958)分支的[切线](@entry_id:268870)角度 $\theta_d$ 可以通过在 $p^*$ 的一个无限小邻域内应用[相角条件](@entry_id:264793)来确定。其计算公式为：

    $$
    q \theta_d = (2k+1)\pi + \sum_{j, p_j \neq p^*} \angle(p^* - p_j) - \sum_{i=1}^{m} \angle(p^* - z_i), \quad k=0, 1, \dots, q-1
    $$
    
    考虑一个用于伺服机构的系统，其[开环传递函数](@entry_id:276280)为 $G(s)H(s) = \frac{K}{s^2(s+4)}$ [@problem_id:1749593]。该系统在原点有一个二[重极点](@entry_id:262210)（$q=2, p^*=0$），在 $s=-4$ 有一个单极点，没有有限零点。分离角 $\theta_d$ 满足：
    
    $$
    2\theta_d = (2k+1)\pi + \angle(0 - (-4)) - 0 = (2k+1)\pi + \angle(4) = (2k+1)\pi
    $$
    
    $$
    \theta_d = \frac{(2k+1)\pi}{2}
    $$
    
    取 $k=0$ 和 $k=1$，我们得到两个分离角：$\theta_d = \frac{\pi}{2}$ 和 $\theta_d = \frac{3\pi}{2}$，即 $90^\circ$ 和 $270^\circ$ (或 $-90^\circ$)。这意味着两条分支分别沿着正负虚轴方向离开原点。

-   **[到达角](@entry_id:265527) (Angle of Arrival)**：到达一个 $q$ 重开环零点 $z^*$ 的[切线](@entry_id:268870)角度 $\theta_a$ 的计算方式类似，公式为：

    $$
    q \theta_a = (2k+1)\pi + \sum_{j=1}^{n} \angle(z^* - p_j) - \sum_{i, z_i \neq z^*} \angle(z^* - z_i), \quad k=0, 1, \dots, q-1
    $$

通过综合运用以上准则，即使没有计算机辅助，我们也能勾勒出[根轨迹](@entry_id:272958)的概貌，从而对系统的行为有一个定性的理解。这对于初步设计和分析控制器具有不可替代的价值。[根轨迹](@entry_id:272958)不仅是一个分析工具，更是一个设计工具，它指引我们如何通过调整增益或引入补偿环节（即增加新的[开环极点和零点](@entry_id:276317)）来重塑根轨迹，从而使[闭环极点](@entry_id:274094)移动到期望的性能区域，满足系统设计的各项指标。