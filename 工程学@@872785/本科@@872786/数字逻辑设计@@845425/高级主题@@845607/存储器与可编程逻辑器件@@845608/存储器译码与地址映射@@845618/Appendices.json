{"hands_on_practices": [{"introduction": "内存地址映射的核心在于创建能够识别特定地址模式的逻辑电路。本练习旨在将一个高级需求（即一个地址范围）转化为一个底层的门级实现，特别是通过使用通用的或非门（NOR gate）来完成。通过这个实践 [@problem_id:1946694]，你将把布尔代数和逻辑简化的理论知识应用于实际的硬件设计中，从而加深对地址译码器工作原理的理解。", "problem": "一个微处理器系统使用16位地址总线，地址线从$A_{15}$（最高有效位）到$A_0$（最低有效位）表示。一个存储芯片需要集成到该系统中，并且只有当总线上的地址落在十六进制范围 $0x9000$ 到 $0x9FFF$（含）之内时，该芯片才被使能。\n\n该存储芯片有一个低电平有效的片选输入，表示为 $\\overline{CS}$。这意味着当 $\\overline{CS}=0$ 时芯片被选中，当 $\\overline{CS}=1$ 时芯片未被选中。你的任务是为该片选信号设计译码逻辑。你的设计必须*仅*使用2输入或非门来实现。\n\n创建此地址译码电路所需的最少2输入或非门数量是多少？", "solution": "地址范围从 $0x9000$ 到 $0x9FFF$ 对应于最高的四个地址位 $A_{15}A_{14}A_{13}A_{12}=1001$，而 $A_{11}\\dots A_{0}$ 是无关项。因此，该块的高电平有效检测信号为\n$$\nD = A_{15}\\,A_{12}\\,\\overline{A_{14}}\\,\\overline{A_{13}}.\n$$\n因为存储芯片是低电平有效片选，所以所需的片选输入为\n$$\n\\overline{CS}=\\overline{D}=\\overline{A_{15}A_{12}\\,\\overline{A_{14}}\\,\\overline{A_{13}}}.\n$$\n根据德摩根定律，这也可以写成\n$$\n\\overline{CS}=\\overline{A_{15}}+\\overline{A_{12}}+A_{14}+A_{13}.\n$$\n\n我们必须仅使用2输入或非门来实现 $\\overline{CS}$。以下仅使用或非门的实现方法利用了标准恒等式：\n- 反相器：$\\overline{x}=\\operatorname{NOR}(x,x)$。\n- 使用或非门实现与门：$x y=\\operatorname{NOR}\\big(\\operatorname{NOR}(x,x),\\operatorname{NOR}(y,y)\\big)$。\n- 此外，$\\operatorname{NOR}(x,y)=\\overline{x+y}$，所以 $\\operatorname{NOR}(A_{14},A_{13})=\\overline{A_{14}+A_{13}}=\\overline{A_{14}}\\,\\overline{A_{13}}$。\n\n一种门数量最少的实现方法如下：\n\n1) 使用仅或非门的与门形式构建 $t_{1}=A_{15}A_{12}$：\n$$\nn_{15}=\\operatorname{NOR}(A_{15},A_{15}),\\quad n_{12}=\\operatorname{NOR}(A_{12},A_{12}),\\quad t_{1}=\\operatorname{NOR}(n_{15},n_{12}).\n$$\n这需要3个或非门。\n\n2) 直接用一个或非门构建 $t_{2}=\\overline{A_{14}}\\,\\overline{A_{13}}$：\n$$\nt_{2}=\\operatorname{NOR}(A_{14},A_{13}).\n$$\n这需要1个或非门。\n\n3) 使用仅或非门的与门形式构建 $D=t_{1}t_{2}$，然后反相得到 $\\overline{CS}=\\overline{D}$：\n$$\nu=\\operatorname{NOR}(t_{1},t_{1}),\\quad v=\\operatorname{NOR}(t_{2},t_{2}),\\quad D=\\operatorname{NOR}(u,v),\\quad \\overline{CS}=\\operatorname{NOR}(D,D).\n$$\n这一阶段需要 $3+1=4$ 个或非门。\n\n使用的或非门总数为：$3+1+4=8$。\n\n为了论证其最小性，注意到 $\\overline{CS}$ 依赖于 $A_{15}$ 和 $A_{12}$ 的反相形式，因此至少需要两次反相。仅使用2输入或非门实现所需的四变量组合，还需要至少六个额外的或非门操作来以正确的极性组合四个输入（等效于构建两个2输入或门和一个最终的或门，而每个或门由两个或非门实现），从而得到一个 $2+6=8$ 的下界。上述构造达到了这个下界，因此 $8$ 是最小数量。", "answer": "$$\\boxed{8}$$", "id": "1946694"}, {"introduction": "在追求成本效益的系统设计中，工程师有时会采用简化的“不完全译码”方案，但这会带来意想不到的后果。本练习 [@problem_id:1946720] 探讨了这种设计捷径的直接产物——地址混叠（address aliasing），即单个存储芯片会响应多个不同的地址范围。理解这一现象对于调试和掌握许多嵌入式系统的实际行为至关重要。", "problem": "一位数字系统工程师正在将一个内存芯片与一个微处理器进行接口连接。该微处理器拥有 16 KB（千字节）的总地址空间，其中 1 KB 定义为 $2^{10}$ 字节。该内存芯片是一个容量为 1 KB 的随机存取存储器（RAM）设备。\n\n为了选择该内存芯片，使用了一个译码电路。然而，由于设计疏忽，片选逻辑不完整。当且仅当来自微处理器的两个最高有效地址线 $A_{13}$ 和 $A_{12}$ 分别为 1 和 0 时，该芯片才被选中。所有其他未用于芯片*内部*寻址的高位地址线都未连接到片选逻辑，实际上使它们成为片选的“无关”位。\n\n这种不完整的译码方案导致内存芯片会响应微处理器地址空间中的多个不同地址范围，这种现象称为地址混叠。“基地址”定义为内存块的起始地址。您的任务是确定这个 1 KB 内存芯片的全套混叠基地址。\n\n请以一组按升序排列的十六进制值的形式提供您的答案。答案中不要包含任何前缀（如 `0x`）或后缀（如 `h`）。", "solution": "微处理器的地址空间为 16 KB，等于 $2^{14}$ 字节，因此地址总线有 14 条线，标记为 $A_{13}$（最高有效位）到 $A_{0}$（最低有效位）。RAM 容量为 1 KB，等于 $2^{10}$ 字节，因此芯片内部寻址需要 10 条地址线；它们是 $A_{9}$ 到 $A_{0}$。\n\n要在 $2^{14}$ 字节的空间中选择一个特定的 1 KB 块，高位地址线 $A_{13}$ 到 $A_{10}$ 必须确定寻址哪个块。在给定的不完整译码中，当且仅当 $A_{13}=1$ 且 $A_{12}=0$ 时，芯片才被选中，而 $A_{11}$ 和 $A_{10}$ 则作为无关位。因此，芯片会对所有满足以下条件的地址作出响应：\n$$A_{13}=1,\\quad A_{12}=0,\\quad A_{11}\\in\\{0,1\\},\\quad A_{10}\\in\\{0,1\\}.$$\n基地址是一个 1 KB 块的起始地址，这要求 $A_{9}=\\cdots=A_{0}=0$。因此，混叠基地址正是具有上述位模式且 $A_{9}=\\cdots=A_{0}=0$ 的那些地址。\n\n用 2 的幂次表示基地址值，\n$$\\text{Base} = A_{13}2^{13} + A_{12}2^{12} + A_{11}2^{11} + A_{10}2^{10},$$\n其中 $A_{13}=1$，$A_{12}=0$，且 $A_{11},A_{10}\\in\\{0,1\\}$。枚举四种组合：\n- $A_{11}=0$, $A_{10}=0$: $\\text{Base}=2^{13}=0x2000$。\n- $A_{11}=0$, $A_{10}=1$: $\\text{Base}=2^{13}+2^{10}=0x2000+0x0400=0x2400$。\n- $A_{11}=1$, $A_{10}=0$: $\\text{Base}=2^{13}+2^{11}=0x2000+0x0800=0x2800$。\n- $A_{11}=1$, $A_{10}=1$: $\\text{Base}=2^{13}+2^{11}+2^{10}=0x2000+0x0800+0x0400=0x2C00$。\n\n按升序排列，混叠基地址为 $2000$、$2400$、$2800$ 和 $2C00$（十六进制，无前缀或后缀）。", "answer": "$$\\boxed{\\begin{pmatrix}2000  2400  2800  2C00\\end{pmatrix}}$$", "id": "1946720"}, {"introduction": "我们将转向一个更复杂的诊断场景，它真实地反映了工程实践中的挑战。本练习 [@problem_id:1946715] 呈现了一个设计正确但存在单点布线故障的电路，并要求你分析其异常行为。通过解决这个问题，你将学会如何综合运用关于译码器、地址线和控制信号的知识，来诊断和排除那些不直观的系统故障，这是成为一名优秀数字系统工程师的关键技能。", "problem": "一位数字系统设计师正在将八片1千字节（KB）的静态RAM芯片与一个拥有16位地址总线（$A_{15}$ 到 $A_0$）和一个读/写控制线（$R/\\overline{W}$）的微处理器进行接口。$R/\\overline{W}$线在读操作时为高电平，在写操作时为低电平。\n\n设计目标是将这八片RAM芯片映射到从地址0x8000开始的一个连续的8 KB内存块中。为实现这一目标，使用了一个74LS138 3-8译码器进行芯片选择。74LS138有一个高电平有效使能输入（$G_1$）和两个低电平有效使能输入（$G_{2A}$ 和 $G_{2B}$）。为使译码器有效，其使能输入必须为$G_1=1$、$G_{2A}=0$ 和 $G_{2B}=0$。\n\n译码器的预期连接方式如下：\n-   **使能输入：**$G_1$ 连接到 $A_{15}$，$G_{2A}$ 连接到 $A_{14}$，$G_{2B}$ 连接到 $A_{13}$。\n-   **选择输入：** 选择线 $C$、$B$ 和 $A$ 分别连接到 $A_{12}$、$A_{11}$ 和 $A_{10}$。\n-   **输出：** 低电平有效的输出 $\\overline{Y_0}$ 到 $\\overline{Y_7}$ 分别连接到RAM芯片0到7的低电平有效片选（$\\overline{CS}$）输入。\n\n生产后发现一个故障：$G_1$ 使能输入的导线被错误地连接到了CPU的 $R/\\overline{W}$ 线上，而不是 $A_{15}$ 地址线。$A_{15}$ 线不再连接到译码器。\n\n下列哪个陈述最准确地描述了存在此接线故障时RAM的运行行为？\n\nA. RAM可以写入，但无法读取。有效地址范围仍为0x8000-0x9FFF。\n\nB. RAM功能完全正常（可读可写），但它现在出现在两个地址范围：0x0000-0x1FFF和0x8000-0x9FFF。\n\nC. RAM可以读取，但无法写入。用于读取的有效地址范围现在被复制，同时出现在0x0000-0x1FFF和0x8000-0x9FFF。\n\nD. 系统完全按预期运行，因为在读周期中 $R/\\overline{W}$ 线为高电平（逻辑1），这满足了 $G_1$ 使能输入，就像 $A_{15}=1$ 一样。", "solution": "要确定存在故障时系统的行为，我们必须分析错误的接线如何影响译码器的使能逻辑，并因此影响存储系统对读/写操作的响应及其地址映射。\n\n**步骤1：分析预期的（正确的）译码逻辑**\n\n在原始设计中，当74LS138译码器的使能输入满足条件 $G_1=1$、$G_{2A}=0$ 和 $G_{2B}=0$ 时，译码器被使能。连接方式如下：\n-   $G_1 \\leftarrow A_{15}$\n-   $G_{2A} \\leftarrow A_{14}$\n-   $G_{2B} \\leftarrow A_{13}$\n\n因此，译码器当且仅当 $A_{15}=1$、$A_{14}=0$ 和 $A_{13}=0$ 时被使能。在二进制中，这对应于地址前缀 `100...`。\n具有此前缀的内存地址范围从 `1000 0000 0000 0000` (0x8000) 到 `1001 1111 1111 1111` (0x9FFF)。这是一个 8 KB 的地址块。选择线 $A_{12}, A_{11}, A_{10}$ 用于在此块内选择八个1 KB芯片中的一个。此配置将8 KB的RAM正确地映射到预期的地址范围。\n\n**步骤2：分析错误的译码逻辑**\n\n在错误的配置中，$G_1$ 输入连接到 $R/\\overline{W}$ 线而不是 $A_{15}$。译码器的使能逻辑现在变为：\n-   $G_1 = (R/\\overline{W})$\n-   $G_{2A} = A_{14}$\n-   $G_{2B} = A_{13}$\n\n现在译码器被使能的条件是：$(R/\\overline{W})=1$ 且 $A_{14}=0$ 且 $A_{13}=0$。\n\n**步骤3：分析对读写操作的影响**\n\n我们检查CPU读写周期的新使能条件。\n\n-   **写周期：** 在写操作期间，CPU将 $R/\\overline{W}$ 线设置为低电平（逻辑0）。译码器的使能条件为 $(0)=1$ 且 $A_{14}=0$ 且 $A_{13}=0$。这个逻辑与运算的第一部分 `(0)=1` 永远为假。因此，在任何写周期中，无论总线上的地址是什么，译码器都无法被使能。由于译码器永不被使能，其输出 $\\overline{Y_0}-\\overline{Y_7}$ 将永远不会被置为有效（变为低电平）。这意味着没有RAM芯片会被选中（因为它们的 $\\overline{CS}$ 输入保持高电平）。因此，**无法向任何RAM芯片写入数据**。\n\n-   **读周期：** 在读操作期间，CPU将 $R/\\overline{W}$ 线设置为高电平（逻辑1）。译码器的使能条件变为 $(1)=1$ 且 $A_{14}=0$ 且 $A_{13}=0$。这简化为条件：$A_{14}=0$ 且 $A_{13}=0$。如果满足此地址条件，译码器将被使能，其输出之一将选择一个RAM芯片。因此，**可以从RAM芯片中读取数据**。\n\n综合这些发现，我们得出结论，RAM可以被读取，但不能被写入。\n\n**步骤4：分析对地址映射的影响（地址混叠）**\n\n错误的使能逻辑（仅在读取时有效）取决于 $A_{14}=0$ 和 $A_{13}=0$。关键在于，它现在与 $A_{15}$ 地址线无关。这意味着在读操作期间，只要地址前缀是 `X00...`（其中X代表 $A_{15}$ 的“无关”状态），译码器就会响应。\n\n让我们找出满足此条件的地址范围：\n-   **情况1：$A_{15}=0$。** 地址前缀为 `000...`。这对应于 $A_{15}=0, A_{14}=0, A_{13}=0$ 的地址。由 $A_{12}, A_{11}, A_{10}$ 选择的 8 KB RAM块将出现在地址范围 `0000 0000 0000 0000` 到 `0001 1111 1111 1111`，即 **0x0000 到 0x1FFF**。\n-   **情况2：$A_{15}=1$。** 地址前缀为 `100...`。这对应于 $A_{15}=1, A_{14}=0, A_{13}=0$ 的地址。这8 KB的RAM块也将出现在地址范围 `1000 0000 0000 0000` 到 `1001 1111 1111 1111`，即 **0x8000 到 0x9FFF**。这是最初预期的范围。\n\n因为RAM在这两个范围内都响应读取请求，所以内存被称为“混叠”或“镜像”。从地址0x0100读取将访问与从地址0x8100读取完全相同的存储单元。\n\n**步骤5：评估选项**\n\n-   A. “RAM可以写入，但无法读取...” - 不正确。我们的分析表明情况正好相反。\n-   B. “RAM功能完全正常（可读可写）...” - 不正确。写操作失败。\n-   C. “RAM可以读取，但无法写入。用于读取的有效地址范围现在被复制，同时出现在0x0000-0x1FFF和0x8000-0x9FFF。” - **正确。** 这个陈述准确地总结了我们的发现：写操作失败，读操作成功，并且有效地址范围发生混叠，同时出现在0x0000-0x1FFF和0x8000-0x9FFF。\n-   D. “系统完全按预期运行...” - 不正确。这忽略了两个主要问题：所有写操作的失败以及地址混叠的产生，这可能导致严重的系统不稳定。", "answer": "$$\\boxed{C}$$", "id": "1946715"}]}