{"hands_on_practices": [{"introduction": "要真正理解FPGA的架构，最好的方法莫过于亲自动手实践。这些练习将引导你从最基础的逻辑单元编程，到将它们组合起来构建更复杂的电路。我们的第一站是可编程逻辑阵列（FPGA）的核心：查找表（Look-Up Table, LUT）。LUT是实现组合逻辑的基本构件，本质上是一个小型可配置存储器，用于存储一个真值表。这个练习 [@problem_id:1938016] 提供了一个直接的实践机会，让你将一个简单的布尔函数——一个3输入多数表决器——转换为加载到LUT中的物理配置位。", "problem": "在现代数字系统的设计中，现场可编程门阵列 (FPGA) 因其灵活性而被广泛使用。FPGA 的基本构建单元是可配置逻辑块，它通常包含若干个查找表 (LUT)。一个 $k$ 输入查找表是一个小型存储器，可以被配置以实现任意一个 $k$ 变量的布尔函数。对于一个 3 输入查找表，该存储器存储 $2^3 = 8$ 位数据，形成一个 8 位的“配置串”。当三个输入施加到查找表时，它们被视为该存储器的一个地址，存储在该地址上的位成为查找表的输出。\n\n考虑一个简单的容错系统，它使用三个冗余传感器来监测一个关键状况。设这些传感器的二进制输出为 $A$、$B$ 和 $C$。为了生成一个可靠的信号，需要一个“三输入多数决”函数。当且仅当其输入中两个或两个以上为 `1` 时，该函数输出 `1`；否则，它输出 `0`。\n\n您的任务是使用一个 3 输入查找表来实现这个三输入多数决函数。查找表的输入是 $A$、$B$ 和 $C$。这些输入被解释为一个 3 位二进制数 $CBA$ 以形成地址，其中 $C$ 是最高有效位 (MSB)，$A$ 是最低有效位 (LSB)。8 位配置串定义为从地址 7 到地址 0 的存储器值的序列。也就是说，该串为 `{mem[7], mem[6], mem[5], mem[4], mem[3], mem[2], mem[1], mem[0]}`。\n\n以下哪个选项代表了实现三输入多数决函数所需的正确 8 位配置串？\n\nA. 00010111\n\nB. 11101000\n\nC. 10000000\n\nD. 11111110\n\nE. 10010110", "solution": "要解决这个问题，我们需要确定一个实现三输入多数决函数的 3 输入查找表 (LUT) 的 8 位配置串。设输入为 $A$、$B$ 和 $C$，输出为 $F(A, B, C)$。\n\n第一步是构建三输入多数决函数的真值表。如果两个或更多输入为 1，则函数输出为 1，否则为 0。输入 $C$、$B$ 和 $A$ 也构成了 LUT 存储器的地址，其中 $C$ 是最高有效位 (MSB)，$A$ 是最低有效位 (LSB)。二进制数 $CBA$ 的整数值对应于存储器地址。\n\n让我们构建真值表，包括每个输入组合对应的十进制地址。\n\n| 地址 (十进制) | 输入 $C$ | 输入 $B$ | 输入 $A$ | '1'的数量 | 输出 $F$ |\n|-------------------|-----------|-----------|-----------|----------------|------------|\n| 0                 | 0         | 0         | 0         | 0              | 0          |\n| 1                 | 0         | 0         | 1         | 1              | 0          |\n| 2                 | 0         | 1         | 0         | 1              | 0          |\n| 3                 | 0         | 1         | 1         | 2              | 1          |\n| 4                 | 1         | 0         | 0         | 1              | 0          |\n| 5                 | 1         | 0         | 1         | 2              | 1          |\n| 6                 | 1         | 1         | 0         | 2              | 1          |\n| 7                 | 1         | 1         | 1         | 3              | 1          |\n\n输出列 $F$ 代表了应该存储在 LUT 中每个相应存储器地址上的位。因此，我们有：\n- `mem[0]` = 0\n- `mem[1]` = 0\n- `mem[2]` = 0\n- `mem[3]` = 1\n- `mem[4]` = 0\n- `mem[5]` = 1\n- `mem[6]` = 1\n- `mem[7]` = 1\n\n问题规定配置串是从地址 7 到地址 0 的存储器值的序列。这意味着该串是通过按 `mem[7] mem[6] mem[5] mem[4] mem[3] mem[2] mem[1] mem[0]` 的顺序连接存储器位而形成的。\n\n使用我们从真值表中导出的值：\n- `mem[7]` = 1\n- `mem[6]` = 1\n- `mem[5]` = 1\n- `mem[4]` = 0\n- `mem[3]` = 1\n- `mem[2]` = 0\n- `mem[1]` = 0\n- `mem[0]` = 0\n\n按指定顺序组合这些位，得到 8 位配置串：`11101000`。\n\n将此结果与给定选项进行比较：\nA. 00010111 (这是从地址 0 到 7 的相反顺序。一个常见的错误。)\nB. 11101000 (这与我们导出的串相匹配。)\nC. 10000000 (这将实现一个三输入与门。)\nD. 11111110 (这将实现一个三输入或门。)\nE. 10010110 (这将实现一个三输入异或门。)\n\n因此，正确的配置串是 `11101000`，对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "1938016"}, {"introduction": "掌握了组合逻辑的LUT之后，下一步是理解它如何与时序元件——D型触发器（D-type flip-flop, DFF）——配对，共同构成一个完整的逻辑单元（Logic Element, LE）。这种强大的组合使得FPGA能够实现任何类型的同步时序逻辑。这个练习 [@problem_id:1938061] 将挑战你通过编程LUT来改变其关联DFF的行为，从而将一个简单的DFF有效地转换为一个带有同步使能信号的、功能更复杂的T型触发器（T-FF）。", "problem": "现场可编程门阵列 (FPGA) 中的一种专用逻辑单元 (LE) 被设计为高度灵活。该特定 LE 由一个三输入查找表 (LUT) 和一个 D 型触发器 (DFF) 组成。LUT 的输出直接馈入 DFF 的 `D` 输入端。DFF 的寄存器输出，表示为 `Q`，可作为 LE 的一个输出，并且也可以用作 LUT 的一个反馈输入。\n\n您的任务是配置此 LE，使其作为一个带有同步、高电平有效时钟使能信号 `CE` 的 T 型触发器 (T-FF) 来工作。可用于 LUT 的三个输入是翻转信号 `T`、时钟使能信号 `CE` 以及触发器的当前状态 `Q`。\n\n必须对 LUT 进行编程，以实现一个特定的布尔函数 `D = F(CE, T, Q)`，从而使整个 LE 表现得像一个带同步使能的 T-FF。这意味着：\n1.  当 `CE` 为低电平 (0) 时，在下一个有效时钟沿，触发器必须保持其当前状态 `Q`。\n2.  当 `CE` 为高电平 (1) 时，在下一个有效时钟沿，触发器必须表现为标准的 T-FF（即，如果 `T=0` 则保持其状态，如果 `T=1` 则翻转其状态）。\n\n下列哪个关于 `D` 的布尔表达式正确地实现了这一功能？选择所有适用的选项。在以下选项中，`\\land` 表示逻辑与运算，`\\lor` 表示逻辑或运算，`\\neg` 表示逻辑非运算，`\\oplus` 表示逻辑异或运算。\n\nA. `D = (CE \\land (T \\oplus Q)) \\lor (\\neg CE \\land Q)`\n\nB. `D = (CE \\land T) \\oplus Q`\n\nC. `D = CE \\land (T \\oplus Q)`\n\nD. `D = (\\neg CE \\land Q) \\lor (CE \\land T)`\n\nE. `D = \\neg ( (\\neg CE \\land Q) \\lor (CE \\land (T \\oplus Q)) )`", "solution": "设 $Q^{+}$ 表示下一个寄存状态，因此 LUT 必须实现 $D=Q^{+}$ 作为 $(CE,T,Q)$ 的函数，并具有以下要求的行为：\n- 如果 $CE=0$，则 $Q^{+}=Q$ (保持)。\n- 如果 $CE=1$，则 $Q^{+}=Q \\oplus T$ (T 触发器行为)。\n\n这种条件行为可以写成布尔复用器的形式\n$$\nD \\;=\\; (\\neg CE \\land Q)\\; \\lor\\; \\big(CE \\land (Q \\oplus T)\\big).\n$$\n这与选项 A 完全匹配，所以 A 是正确的。\n\n现在证明选项 B 实现了相同的功能。考虑\n$$\nD \\;=\\; (CE \\land T) \\oplus Q.\n$$\n通过对 $CE$ 进行情况分析：\n- 如果 $CE=0$，那么 $D=(0\\land T)\\oplus Q=0\\oplus Q=Q$，这与要求的保持行为相匹配。\n- 如果 $CE=1$，那么 $D=(1\\land T)\\oplus Q=T\\oplus Q=Q\\oplus T$，这与要求的 T-FF 行为相匹配。\n因此 B 是正确的。\n\n为了完整起见，我们还可以证明 A 和 B 之间的代数等价性。从 A 开始：\n$$\nD \\;=\\; CE\\land(Q \\oplus T)\\; \\lor\\; \\neg CE \\land Q\n\\;=\\; CE\\big(\\neg Q \\land T \\;\\lor\\; Q \\land \\neg T\\big)\\; \\lor\\; \\neg CE \\land Q\n$$\n$$\n=\\; CE \\land \\neg Q \\land T \\;\\lor\\; CE \\land Q \\land \\neg T \\;\\lor\\; \\neg CE \\land Q\n$$\n将包含 $Q$ 的项分组：\n$$\n=\\; CE \\land \\neg Q \\land T \\;\\lor\\; Q\\big(CE \\land \\neg T \\;\\lor\\; \\neg CE\\big).\n$$\n使用 $\\neg CE \\lor (CE \\land \\neg T) = (\\neg CE \\lor CE)\\land(\\neg CE \\lor \\neg T)=1\\land(\\neg CE \\lor \\neg T)=\\neg CE \\lor \\neg T$ 可得\n$$\nD \\;=\\; CE \\land \\neg Q \\land T \\;\\lor\\; Q(\\neg CE \\lor \\neg T)\n\\;=\\; CE \\land T \\land \\neg Q \\;\\lor\\; \\neg CE \\land Q \\;\\lor\\; \\neg T \\land Q.\n$$\n识别出这是标准的异或形式：\n$$\nD \\;=\\; \\big(\\neg(CE\\land T)\\land Q\\big) \\;\\lor\\; \\big(CE\\land T \\land \\neg Q\\big)\n\\;=\\; (CE\\land T)\\oplus Q,\n$$\n这就是选项 B。\n\n现在根据要求的行为测试其余选项：\n\n选项 C：$D=CE \\land (T \\oplus Q)$。如果 $CE=0$，那么 $D=0$，这通常不等于 $Q$；因此 C 是不正确的。\n\n选项 D：$D=(\\neg CE \\land Q)\\lor(CE \\land T)$。如果 $CE=1$，那么 $D=T$，但要求的行为是 $Q \\oplus T$。例如，当 $Q=1$ 且 $T=0$ 时，要求的下一个状态是 $1$，但 $D$ 的计算结果为 $0$；因此 D 是不正确的。\n\n选项 E：$D=\\neg\\big((\\neg CE \\land Q)\\lor(CE \\land (T \\oplus Q))\\big)$ 是 A 的逻辑非，因此它反转了要求的行为。例如，当 $CE=0$ 且 $Q=1$ 时，要求的下一个状态是 $1$，但 $D=\\neg(1)=0$；因此 E 是不正确的。\n\n因此，正确的选项是 A 和 B。", "answer": "$$\\boxed{AB}$$", "id": "1938061"}, {"introduction": "现实世界中的数字电路通常非常复杂，无法装入单个LUT中。这正是FPGA架构真正力量的体现之处：通过连接众多逻辑单元来实现大规模设计。我们最后的这个练习 [@problem_id:1938052] 探讨了逻辑综合（logic synthesis）的概念，要求你构建一个5输入多路选择器（a 5-to-1 multiplexer）。由于这个函数的输入数量超出了单个4输入LUT的处理能力，你需要将其分解为一个由多个更小的、相互连接的LUT组成的网络。", "problem": "在现代数字设计中，现场可编程门阵列（FPGA）通常用于原型设计和实现定制逻辑电路。许多FPGA的基本构建模块是K输入查找表（LUT），它是一种小型存储器，能够实现K个变量的任意布尔函数。\n\n考虑一个数字系统，它必须在一个逻辑完全基于4输入查找表（4-LUT）的FPGA上实现。您的任务是设计一个5选1多路复用器（MUX）。该MUX有五个数据输入，标记为 $I_0, I_1, I_2, I_3,$ 和 $I_4$，以及三个选择输入，标记为 $S_2, S_1,$ 和 $S_0$。多路复用器的输出 $Y$ 应等于数据输入 $I_k$，其中 $k$ 是由二进制数 $S_2S_1S_0$ 表示的整数值。例如，如果选择输入为 $S_2S_1S_0 = 100$，则输出 $Y$ 为 $I_4$。对于未使用的选择输入组合（即 $k > 4$），输出为无关项。\n\n假设您只能使用4-LUT和标准布线，构建这个5选1多路复用器所需的最少4输入LUT数量是多少？\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5", "solution": "我们受限于使用4输入LUT。一个4-LUT可以实现最多4个输入的任意布尔函数。\n\n将2选1多路复用器原语定义为布尔函数\n$$\n\\operatorname{mux}(s,a,b) \\equiv \\overline{s}\\,a + s\\,b.\n$$\n一个2选1 MUX使用3个输入 $\\{s,a,b\\}$，因此可以放入一个4-LUT中。\n\n5选1 MUX的目标行为：\n- 设三条选择线构成一个二进制数 $S_{2}S_{1}S_{0}$。\n- 对于 $S_{2}S_{1}S_{0}\\in\\{000,001,010,011,100\\}$，我们要求 $Y=I_{k}$，其中 $k\\in\\{0,1,2,3,4\\}$。\n- 对于 $S_{2}S_{1}S_{0}\\in\\{101,110,111\\}$，$Y$ 是无关项，因此可以任意赋值。\n\n充分性（使用4个LUT的构造性上界）：\n使用2选1 MUX实现标准的多路复用器树，每个2选1 MUX可由一个4-LUT实现：\n- 第一级：\n$$\nA=\\operatorname{mux}(S_{0}, I_{0}, I_{1}),\\quad B=\\operatorname{mux}(S_{0}, I_{2}, I_{3}).\n$$\n- 第二级（在 $A$ 和 $B$ 之间选择）：\n$$\nC=\\operatorname{mux}(S_{1}, A, B).\n$$\n- 最后一级（在 $S_{2}$ 控制下插入 $I_{4}$）：\n$$\nY=\\operatorname{mux}(S_{2}, C, I_{4}).\n$$\n当 $S_{2}=0$ 时，$Y=C$ 实现由 $S_{1},S_{0}$ 在 $I_{0},I_{1},I_{2},I_{3}$ 中进行所需的4选1选择。当 $S_{2}=1$ 时，无论 $S_{1},S_{0}$ 为何，$Y=I_{4}$，这恰好满足了所需情况 $S_{2}S_{1}S_{0}=100$，并且由于是无关项，对于 $S_{2}S_{1}S_{0}\\in\\{101,110,111\\}$ 也是可以接受的。这恰好使用了4个LUT，证明了4个LUT是足够的。\n\n必要性（为什么3个LUT不足够）：\n- 考虑 $S_{2}=0$ 时的余子式：函数简化为由 $\\{S_{1},S_{0}\\}$ 选择的在 $I_{0},I_{1},I_{2},I_{3}$ 中的4选1 MUX。单个4-LUT无法实现此功能，因为这将需要一个有6个独立输入 $\\{S_{1},S_{0},I_{0},I_{1},I_{2},I_{3}\\}$ 的函数，超出了4输入的容量。通过2选1 MUX分解的最小实现需要三个2选1 MUX（两个用于 $S_{0}$ 的第一级，一个用于 $S_{1}$ 的第二级），即3个LUT。\n- 仅使用这3个LUT，该结构中的最后一个LUT已经消耗了 $\\{S_{1},A,B\\}$ 的输入，其中 $A$ 和 $B$ 是第一级的输出。它只剩下一个输入引脚。为了同时实现 $I_{4}$ 的情况，决策点必须能访问 $S_{2}$（以检测需要 $I_{4}$ 分支）和 $I_{4}$（以输出其值）。这将需要在最终决策点至少有两个额外的输入 $\\{S_{2},I_{4}\\}$，超出了4输入的限制。将 $\\{S_{2},I_{4}\\}$ 推入到更早的LUT中会迫使其中至少一个LUT依赖于 $\\{S_{0},I_{x},I_{y},S_{2}\\}$ 并且还要传递 $I_{4}$，这将是5个输入，对于一个4-LUT来说同样是不可能的。因此，3个LUT是不够的。\n\n因此，所需的最少4输入LUT数量为4。", "answer": "$$\\boxed{D}$$", "id": "1938052"}]}