{"hands_on_practices": [{"introduction": "算术逻辑单元（ALU）的一个核心功能是执行减法运算。一种高效实现减法 $A-B$ 的方法是计算 $B$ 的二进制补码，然后将其与 $A$ 相加。本练习将指导你设计一个关键的构建模块：一个可根据控制信号选择性地计算输入数值的二进制补码的电路 [@problem_id:1909155]。掌握这项技能是构建一个能够同时处理加法和减法运算的统一加法器/减法器单元的基础。", "problem": "算术逻辑单元 (ALU) 的一个基本组成部分是一个可以有条件地对一个数进行取反的电路。你的任务是设计一个4位组合逻辑电路，用于对二进制补码（two's complement）数执行此功能。\n\n该电路有一个4位二进制输入 $B = B_3B_2B_1B_0$（其中 $B_3$ 是最高有效位）和一个单控制输入 $S$。该电路产生一个4位二进制输出 $Y = Y_3Y_2Y_1Y_0$。\n\n电路的行为定义如下：\n- 如果 $S=0$，输出与输入相同：$Y = B$。\n- 如果 $S=1$，输出是输入的二进制补码：$Y = \\text{Two's Complement}(B)$。\n\n在你的表达式中，使用 $\\cdot$ 表示“与”（AND），$+$ 表示“或”（OR），$\\oplus$ 表示“异或”（XOR），上划线表示“非”（NOT）（例如，$\\overline{A}$）。\n\n以下哪组简化的布尔表达式正确描述了输出 $Y_3, Y_2, Y_1, Y_0$？\n\nA.\n$Y_0 = B_0$\n$Y_1 = (B_1 \\oplus S) \\oplus (\\overline{B_0} \\cdot S)$\n$Y_2 = (B_2 \\oplus S) \\oplus (\\overline{B_1} \\cdot \\overline{B_0} \\cdot S)$\n$Y_3 = (B_3 \\oplus S) \\oplus (\\overline{B_2} \\cdot \\overline{B_1} \\cdot \\overline{B_0} \\cdot S)$\n\nB.\n$Y_0 = B_0 \\oplus S$\n$Y_1 = B_1 \\oplus S$\n$Y_2 = B_2 \\oplus S$\n$Y_3 = B_3 \\oplus S$\n\nC.\n$Y_0 = B_0 \\oplus S$\n$Y_1 = B_1 \\oplus (B_0 \\cdot S)$\n$Y_2 = B_2 \\oplus (B_1 \\cdot B_0 \\cdot S)$\n$Y_3 = B_3 \\oplus (B_2 \\cdot B_1 \\cdot B_0 \\cdot S)$\n\nD.\n$Y_0 = B_0$\n$Y_1 = (B_1 \\oplus S) \\oplus (B_0 \\cdot S)$\n$Y_2 = (B_2 \\oplus S) \\oplus (B_1 \\cdot B_0 \\cdot S)$\n$Y_3 = (B_3 \\oplus S) \\oplus (B_2 \\cdot B_1 \\cdot B_0 \\cdot S)$", "solution": "我们需要一个4位电路，当 $S=0$ 时输出 $Y=B$，当 $S=1$ 时输出 $Y=\\text{Two's Complement}(B)$。$B$ 的二进制补码是 $\\overline{B}+1$。一种实现这种条件操作的标准方法是：\n- 使用 $X_i=B_i\\oplus S$ 对每一位进行条件反相（因此，如果 $S=0$，则 $X=B$；如果 $S=1$，则 $X=\\overline{B}$）。\n- 将 $S$ 作为最低有效位的进位输入，即计算 $Y=X+S$。\n\n令 $C_0=S$，并对每一位 $i$（从 $0$ 到 $3$）使用半加器关系来计算 $X_i$ 和 $C_i$ 的和：\n$$\nY_i=X_i\\oplus C_i,\\qquad C_{i+1}=X_i\\cdot C_i.\n$$\n使用 $X_i=B_i\\oplus S$ 和恒等式 $A\\oplus B=A\\cdot\\overline{B}+\\overline{A}\\cdot B$ 以及 $S\\cdot\\overline{S}=0$。\n\n位 0：\n$X_0=B_0\\oplus S$, $Y_0=(B_0\\oplus S)\\oplus S=B_0$, $C_1=(B_0\\oplus S)\\cdot S=\\overline{B_0}\\cdot S$.\n\n位 1：\n$X_1=B_1\\oplus S$, $Y_1=(B_1\\oplus S)\\oplus C_1=(B_1\\oplus S)\\oplus(\\overline{B_0}\\cdot S)$,\n$C_2=X_1\\cdot C_1=(B_1\\oplus S)\\cdot(\\overline{B_0}\\cdot S)=(B_1\\overline{S}+\\overline{B_1}S)\\cdot\\overline{B_0}S=\\overline{B_1}\\overline{B_0}S$.\n\n位 2：\n$X_2=B_2\\oplus S$, $Y_2=(B_2\\oplus S)\\oplus C_2=(B_2\\oplus S)\\oplus(\\overline{B_1}\\cdot\\overline{B_0}\\cdot S)$,\n$C_3=X_2\\cdot C_2=(B_2\\oplus S)\\cdot(\\overline{B_1}\\overline{B_0}S)=(B_2\\overline{S}+\\overline{B_2}S)\\cdot\\overline{B_1}\\overline{B_0}S=\\overline{B_2}\\overline{B_1}\\overline{B_0}S$.\n\n位 3：\n$X_3=B_3\\oplus S$, $Y_3=(B_3\\oplus S)\\oplus C_3=(B_3\\oplus S)\\oplus(\\overline{B_2}\\cdot\\overline{B_1}\\cdot\\overline{B_0}\\cdot S)$.\n\n因此，简化的表达式为：\n$$\nY_0=B_0,\\quad Y_1=(B_1\\oplus S)\\oplus(\\overline{B_0}\\cdot S),\\quad Y_2=(B_2\\oplus S)\\oplus(\\overline{B_1}\\cdot\\overline{B_0}\\cdot S),\\quad Y_3=(B_3\\oplus S)\\oplus(\\overline{B_2}\\cdot\\overline{B_1}\\cdot\\overline{B_0}\\cdot S),\n$$\n这与选项A完全匹配。选项 B、C 和 D 的进位项不正确（当 $S=1$ 时，B 产生的是反码（one's complement）；C 和 D 使用的是 $B$ 的乘积项作为进位，而不是所要求的 $\\overline{B}$ 的乘积项作为进位）。", "answer": "$$\\boxed{A}$$", "id": "1909155"}, {"introduction": "当使用固定位数处理有符号数运算时，结果可能会超出可表示的范围，从而导致“溢出”错误。对于ALU而言，能够准确检测到这种情况至关重要。这个练习将向你展示一种非常巧妙的方法，仅通过检查最高有效位（MSB）的进位输入和进位输出，就能检测二进制补码加法中的溢出 [@problem_id:1914733]。理解这个优雅的技巧对于设计可靠的算术电路至关重要。", "problem": "在算术逻辑单元（ALU）的设计中，一个关键部件是能够处理有符号数的二进制并行加法器。考虑一个 $n$ 位并行加法器，其设计用于计算和 $S = A + B$，其中 $A$ 和 $B$ 是用二进制补码格式表示的 $n$ 位有符号整数。该加法器由级联的全加器电路构成。\n\n设操作数的位为 $A = a_{n-1}a_{n-2}...a_0$ 和 $B = b_{n-1}b_{n-2}...b_0$，其中 $a_{n-1}$ 和 $b_{n-1}$ 是符号位，代表最高有效位（MSB）。令 $C_{n-1}$ 表示进入最高有效位（第 $n-1$ 级）全加器的进位输入信号，令 $C_n$ 表示由同一最高有效位级产生的进位输出信号。\n\n您的任务是设计一个最小逻辑电路，该电路产生一个单位溢出信号 $V$。如果和 $S$ 超出了 $n$ 位二进制补码数的表示范围，则该信号必须为逻辑 '1'，否则为逻辑 '0'。该电路应仅使用 $C_{n-1}$ 和 $C_n$ 作为其输入。\n\n以下哪个布尔表达式正确表示了溢出信号 $V$？\n\nA. $V = C_n$\n\nB. $V = C_{n-1} \\cdot C_n$\n\nC. $V = C_{n-1} + C_n$\n\nD. $V = C_{n-1} \\oplus C_n$\n\nE. $V = \\overline{C_{n-1} \\oplus C_n}$", "solution": "在 $n$ 位有符号整数的二进制补码加法中，当且仅当两个加数的符号位相同，但和的符号位与它们不同时，才会发生溢出。等效地，仅使用进入最高有效位的进位和从最高有效位产生的进位就可以检测溢出：当这两个进位不同时，恰好发生溢出。\n\n令 $a \\equiv a_{n-1}$，$b \\equiv b_{n-1}$，$C \\equiv C_{n-1}$，$C_{\\text{out}} \\equiv C_{n}$，以及 $s \\equiv s_{n-1}$ 为最高有效位的和的位。对于最高有效位的全加器，\n$$\ns = a \\oplus b \\oplus C,\\qquad C_{\\text{out}} = a b + a C + b C.\n$$\n用操作数符号和结果符号表示的溢出条件是\n$$\nV = a b\\,\\overline{s} + \\overline{a}\\,\\overline{b}\\,s.\n$$\n我们将证明这等于 $C \\oplus C_{\\text{out}}$。\n\n首先，计算\n$$\nC \\oplus C_{\\text{out}} = C\\,\\overline{C_{\\text{out}}} + \\overline{C}\\,C_{\\text{out}}.\n$$\n使用 $C_{\\text{out}} = a b + a C + b C$ 和德摩根定律，\n$$\n\\overline{C_{\\text{out}}} = \\overline{a b}\\,\\overline{a C}\\,\\overline{b C} = (\\overline{a}+\\overline{b})(\\overline{a}+\\overline{C})(\\overline{b}+\\overline{C}).\n$$\n因此，\n$$\nC\\,\\overline{C_{\\text{out}}} = C(\\overline{a}+\\overline{b})(\\overline{a}+\\overline{C})(\\overline{b}+\\overline{C})\n= C\\,\\overline{a}\\,(\\overline{a}+\\overline{b})(\\overline{b}+\\overline{C})\n= C\\,\\overline{a}\\,(\\overline{b}+\\overline{C})\n= C\\,\\overline{a}\\,\\overline{b}.\n$$\n同样，\n$$\n\\overline{C}\\,C_{\\text{out}} = \\overline{C}(a b + a C + b C) = \\overline{C}\\,a b.\n$$\n因此，\n$$\nC \\oplus C_{\\text{out}} = C\\,\\overline{a}\\,\\overline{b} + \\overline{C}\\,a b.\n$$\n现在根据 $(a,b)$ 的不同情况来评估溢出定义：\n- 如果 $a=b=1$，那么 $s = 1 \\oplus 1 \\oplus C = C$，所以 $V = a b\\,\\overline{s} = \\overline{C} = \\overline{C}\\,a b$。\n- 如果 $a=b=0$，那么 $s = 0 \\oplus 0 \\oplus C = C$，所以 $V = \\overline{a}\\,\\overline{b}\\,s = C = C\\,\\overline{a}\\,\\overline{b}$。\n- 如果 $a \\neq b$，那么 $a b = \\overline{a}\\,\\overline{b} = 0$，所以 $V=0$。\n\n因此，在所有情况下，\n$$\nV = C\\,\\overline{a}\\,\\overline{b} + \\overline{C}\\,a b = C \\oplus C_{\\text{out}}.\n$$\n因此，仅使用 $C_{n-1}$ 和 $C_{n}$ 的最小逻辑是\n$$\nV = C_{n-1} \\oplus C_{n},\n$$\n这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1914733"}, {"introduction": "现实世界中的ALU功能强大且用途广泛，必须能够处理不同类型的数据和算术规则。除了标准的二进制算术，一个常见的需求是处理二进制编码的十进制（BCD）数，这在金融和商业计算中非常普遍。这项高级练习将挑战你设计一个可以在标准二进制加法和BCD加法之间切换的双模算术单元 [@problem_id:1909126]。你将学习如何通过增加额外的控制逻辑来扩展一个基本二进制加法器，以实现一种完全不同的算术功能，这充分体现了ALU设计中模块化和可重构思想的力量。", "problem": "一位数字系统工程师正在设计一个多功能的4位算术单元。该单元必须能够对两个4位操作数 $A = A_3A_2A_1A_0$ 和 $B = B_3B_2B_1B_0$ 执行加法运算。该单元的行为由一个一位的模式控制信号 $M$ 决定。\n\n- 当 $M=0$ 时，该单元执行标准的4位二进制加法。\n- 当 $M=1$ 时，该单元执行压缩二进制编码的十进制（BCD）加法。在此模式下，假定操作数 $A$ 和 $B$ 是有效的单个BCD数字，表示从0到9的十进制值。\n\n该单元的内部架构基于一个标准的4位二进制加法器。这个核心加法器接收输入 $A$ 和 $B$，其初始进位输入 $C_{in}$ 永久接地（设置为0）。它产生一个4位的中间和 $Z = Z_3Z_2Z_1Z_0$ 和一个中间进位输出信号 $K$。\n\n根据模式信号 $M$，额外的校正逻辑处理中间结果 $Z$ 和 $K$，以生成最终的4位和 $S = S_3S_2S_1S_0$ 以及整个单元的最终进位输出信号 $C_{out}$。对于BCD加法（$M=1$），如果初步的二进制和大于9，则需要进行校正。如果二进制加法的结果值大于或等于10，则会产生BCD进位输出。\n\n您的任务是确定最终进位输出信号 $C_{out}$ 的正确最小布尔逻辑表达式。该表达式应是模式信号 $M$、二进制加法器的中间进位输出 $K$ 以及中间和 $Z$ 的各位的函数。以下哪个表达式正确地表示了 $C_{out}$？\n\nA. $C_{out} = K + M \\cdot (Z_3 Z_2 + Z_3 Z_1)$\n\nB. $C_{out} = M K + Z_3 Z_2 + Z_3 Z_1$\n\nC. $C_{out} = K$\n\nD. $C_{out} = \\overline{M} K + M \\cdot (Z_3 Z_2 + Z_3 Z_1)$\n\nE. $C_{out} = M + K + Z_3 Z_2 + Z_3 Z_1$", "solution": "我们寻求最终进位输出 $C_{out}$ 的布尔表达式，该表达式是 $M$、$K$ 和中间和位 $Z_{3}, Z_{2}, Z_{1}, Z_{0}$ 的函数。\n\n在二进制模式下（$M=0$），最终的进位输出必须等于二进制加法器的进位输出：\n$$\nC_{out}\\big|_{M=0} = K.\n$$\n\n在BCD模式下（$M=1$），如果初步的4位和超过9，则需要进行校正（加上 $0110$）。BCD校正（以及因此产生的BCD进位）的标准检测条件是\n$$\nD = K + Z_{3} Z_{2} + Z_{3} Z_{1},\n$$\n因为对于二进制值 $1010$ 到 $1111$，$Z_{3} Z_{2} + Z_{3} Z_{1}$ 为真，而 $K=1$ 覆盖了4位加法器溢出的情况（和 $\\geq 16$）。因此，在BCD模式下，最终的进位输出是\n$$\nC_{out}\\big|_{M=1} = D = K + Z_{3} Z_{2} + Z_{3} Z_{1}.\n$$\n\n使用模式选择来组合这两种情况：\n$$\nC_{out} = \\overline{M}\\,K + M\\,(K + Z_{3} Z_{2} + Z_{3} Z_{1}).\n$$\n应用布尔代数：\n$$\nC_{out} = K(\\overline{M} + M) + M(Z_{3} Z_{2} + Z_{3} Z_{1}) = K + M(Z_{3} Z_{2} + Z_{3} Z_{1}).\n$$\n\n这与选项A相匹配：\n$$\nC_{out} = K + M \\cdot (Z_{3} Z_{2} + Z_{3} Z_{1}).\n$$", "answer": "$$\\boxed{A}$$", "id": "1909126"}]}