## 引言
与我们熟悉的、由全局时钟统一协调的[同步时序电路](@entry_id:175242)不同，[异步时序电路](@entry_id:170735)直接响应输入的瞬时变化，无需等待时钟的节拍。这种独特的运行模式赋予了其在速度和[功耗](@entry_id:264815)方面的潜在优势，但同时也带来了设计的复杂性与挑战，使得其行为分析变得非同寻常且至关重要。若缺乏系统的分析方法，设计师将难以预测和避免竞争、险象等问题，从而导致系统功能失常。

本文旨在为学习者提供一个关于[异步时序电路](@entry_id:170735)分析的完整框架。我们将从第一章 **“原理与机制”** 开始，深入探讨决定电路行为的状态、延迟以及稳定性概念，并学习如何使用流程表和激励方程等工具进行形式化分析。接着，在第二章 **“应用与跨学科连接”** 中，我们将把这些理论应用于解决现实世界的工程问题，例如[时钟域交叉](@entry_id:173614)、信号[抖动](@entry_id:200248)消除以及前沿的[硬件安全](@entry_id:169931)技术。最后，第三章 **“动手实践”** 将通过具体问题，引导您亲手应用所学知识，加深理解。

现在，让我们首先进入[异步电路](@entry_id:169162)的核心，从理解其基本原理与机制开始。

## 原理与机制

与[同步时序电路](@entry_id:175242)依赖于全局[时钟信号](@entry_id:174447)来协调状态变化不同，[异步时序电路](@entry_id:170735)直接对输入信号的变化做出响应。这种即时响应的特性使其在某些应用中具有速度优势，但也引入了一系列独特的设计挑战。本章将深入探讨[异步时序电路](@entry_id:170735)分析的核心原理与关键机制，为理解和设计这些复杂的系统奠定坚实的基础。

### 异步行为的本质：状态与延迟

[异步电路](@entry_id:169162)的核心行为由两个基本概念决定：**状态（state）**和**传播延迟（propagation delay）**。电路的**状态**由一组内部[状态变量](@entry_id:138790)（通常表示为 $y_1, y_2, \ldots$）的值定义，这些变量存储了电路的“记忆”。[传播延迟](@entry_id:170242)（$t_{pd}$）是[逻辑门](@entry_id:142135)从其输入端发生变化到其输出端反映出相应变化所需的时间。在[同步系统](@entry_id:172214)中，延迟通常被视为在时钟周期内必须克服的限制；而在异步系统中，延迟是其动态行为不可分割的一部分。

一个简单的思想实验可以揭示[传播延迟](@entry_id:170242)的根本作用。考虑将一个逻辑门的输出直接反馈到其输入。
- **情形1：反相器**。其逻辑关系为 $Y(t + t_{pd}) = \text{NOT}(Y(t))$。假设在时间 $t$ 输出 $Y(t)$ 为 $0$。这个 $0$ 信号反馈到输入端，经过 $t_{pd}$ 的延迟后，输出将变为 $1$。这个新的 $1$ 信号再次反馈，经过又一个 $t_{pd}$ 的延迟，输出将变回 $0$。这个过程无限循环，形成一个周期性的[振荡](@entry_id:267781)。其[振荡周期](@entry_id:271387) $T$ 恰好是信号两次通过反相器所需的时间，即 $T = 2t_{pd}$。这种简单的结构（称为[环形振荡器](@entry_id:176900)）证明了传播延迟可以直接产生动态行为，例如生成一个基础的[时钟信号](@entry_id:174447) ([@problem_id:1911049])。
- **情形2：缓冲器**。其逻辑关系为 $Y(t + t_{pd}) = Y(t)$。无论初始状态是 $0$ 还是 $1$，经过延迟后输出将保持不变。电路会锁定在一个恒定的[逻辑电平](@entry_id:165095)，不会产生[振荡](@entry_id:267781)。

这个对比鲜明地说明，[异步电路](@entry_id:169162)的行为不仅取决于逻辑功能，还深刻地依赖于物理实现的固有延迟。

### 电路行为的描述：稳定状态与表示方法

[异步电路](@entry_id:169162)通常在大部分时间里处于**稳定状态（stable state）**。一个状态对于给定的输入组合是稳定的，如果电路的下一个状态与当前状态相同。在这种情况下，电路内部没有变化趋势，它会一直“等待”直到下一个输入变化。电路的**总状态（total state）**由外部输入 ($x_1, x_2, \ldots$) 和内部[状态变量](@entry_id:138790) ($y_1, y_2, \ldots$) 的当前值共同定义。

分析[异步电路](@entry_id:169162)的第一步是确定其所有的稳定总状态。这通常通过两种形式化的工具来完成：流程表和激励方程。

#### 流程表

**流程表（Flow Table）**是一种表格化的表示方法，它列出了在每个当前[状态和](@entry_id:193625)每种输入组合下，电路的下一个[状态和](@entry_id:193625)输出。通过检查流程表，我们可以直接识别出稳定状态。

考虑一个拥有两个输入 $x_1, x_0$ 和两个[状态变量](@entry_id:138790) $y_1, y_0$ 的电路。其总状态为四元组 $(x_1, x_0, y_1, y_0)$。如果在一个流程表的某一行（代表当前状态 $(y_1, y_0)$）和某一列（代表输入 $(x_1, x_0)$）的[交叉点](@entry_id:147634)，其“下一个状态” $(Y_1, Y_0)$ 的值与当前状态 $(y_1, y_0)$ 完全相同，那么对应的总状态就是稳定的。

例如，在下表中，当电路处于状态 $(y_1, y_0) = (1, 0)$ 且输入为 $(x_1, x_0) = (0, 1)$ 时，下一个状态为 $(1, 0)$。由于下一状态等于当前状态，所以总状态 $(0, 1, 1, 0)$ 是一个稳定状态 ([@problem_id:1911081])。

| 当前状态 (y1, y0) | 输入 (x1, x0) = (0, 0) | 输入 (x1, x0) = (0, 1) | 输入 (x1, x0) = (1, 0) |
|---|---|---|---|
| (0, 0) | **(0, 0)** | (1, 1) | (0, 1) |
| (0, 1) | (0, 0) | (1, 0) | **(0, 1)** |
| (1, 0) | (0, 0) | **(1, 0)** | (1, 1) |
| (1, 1) | (0, 0) | (1, 0) | (0, 1) |

通过系统性地检查表中的每一项，我们可以找到所有的稳定状态，它们是 $\{(0, 0, 0, 0), (0, 1, 1, 0), (1, 0, 0, 1)\}$。

在设计过程中，我们通常从**[原始流程表](@entry_id:168105)（primitive flow table）**开始，其严格定义为每一行只包含一个稳定状态。为了优化电路，可以将兼容的状态合并，形成**合并流程表（merged flow table）**。合并流程表的一个显著特征是其某些行可能包含多个稳定状态 ([@problem_id:1911051])。

#### 激励方程

**激励方程（Excitation Equations）**是描述电路行为的代数方法。每个下一[状态变量](@entry_id:138790) $Y_i$ 都被表示为输入变量和当前[状态变量](@entry_id:138790)的布尔函数：
$Y_i = f_i(x_1, \ldots, x_m, y_1, \ldots, y_n)$

要判断一个总状态是否稳定，只需将该状态的输入和当前[状态变量](@entry_id:138790)的值代入所有激励方程。如果计算出的每个下一状态变量 $Y_i$ 的值都等于对应的当前状态变量 $y_i$ 的值（即 $Y_i = y_i$ 对所有 $i$ 成立），则该总状态是稳定的。

例如，给定激励方程：
$Y_1 = x_1 y_1 + x_1' y_2$
$Y_2 = x_1 y_2' + x_2 y_1$

我们可以检验总状态 $(x_1, x_2, y_1, y_2) = (1, 1, 1, 1)$ 的稳定性。代入值：
$Y_1 = (1 \cdot 1) + (0 \cdot 1) = 1$
$Y_2 = (1 \cdot 0) + (1 \cdot 1) = 1$
由于计算出的 $(Y_1, Y_2) = (1, 1)$ 与当前状态 $(y_1, y_2) = (1, 1)$ 相同，因此该总状态是稳定的 ([@problem_id:1911085])。

### 状态转换与[基本模式](@entry_id:165201)

[异步电路](@entry_id:169162)的工作[范式](@entry_id:161181)是**[基本模式](@entry_id:165201)（fundamental mode）**操作。该模式基于两个核心假设：
1.  一次只有一个输入信号发生变化。
2.  在下一次输入变化发生之前，电路必须有足够的时间完成所有内部状态转换并达到一个新的稳定状态。

当一个输入信号改变时，电路通常会从一个稳定状态进入一个**[不稳定状态](@entry_id:197287)（unstable state）**。此时，$Y \neq y$，电路内部的组合逻辑会驱动[状态变量](@entry_id:138790)发生变化。这些变化会持续进行，直到电路最终进入一个对新输入而言是稳定的状态。

我们可以通过一个简单的转换表示例来追踪这个过程 ([@problem_id:1911043])。假设一个电路初始处于稳定状态 $(y_1, y_2) = (0, 1)$，输入 $x=0$。此时，输入 $x$ 从 $0$ 变为 $1$。我们查阅流程表，发现对于当前状态 $(0, 1)$ 和新输入 $x=1$，下一个状态是 $(1, 1)$。由于当前状态 $(0, 1)$ 和目标状态 $(1, 1)$ 只有一个比特（$y_1$）不同，电路会平稳地从 $01$ 转换到 $11$。一旦到达状态 $11$，我们再次查表，发现对于输入 $x=1$，状态 $11$ 的下一个状态是 $11$，这是一个稳定状态。因此，转换序列为 $01 \to 11$。

违反[基本模式](@entry_id:165201)假设，特别是当多个输入同时改变时，会导致电路行为不可预测。由于物理世界中不存在真正的“同时”，信号在不同路径上的[传播延迟](@entry_id:170242)差异将导致电路感知到这些变化的顺序是随机的。这种**输入的竞争（input race）**可能将电路引导至完全不同的最终状态。

例如，考虑一个电路，当输入从 $x_1x_2=00$ “同时”变为 $11$ 时，电路可能感知到的序列是 $00 \to 01 \to 11$，也可能是 $00 \to 10 \to 11$。如果按照第一条路径，电路可能最终稳定在状态 C；而如果按照第二条路径，它可能稳定在状态 E。由于无法预测哪个输入变化会先被感知，电路的最终状态也变得不确定，可能是 C 或 E ([@problem_id:1911056], [@problem_id:1911087])。这凸显了在设计和使用[异步电路](@entry_id:169162)时严格遵守[基本模式](@entry_id:165201)的重要性。

### 险象与[竞争条件](@entry_id:177665)：异步设计的挑战

[异步电路](@entry_id:169162)的强大和灵活伴随着一系列固有的挑战，主要表现为**竞争条件（race conditions）**和**险象（hazards）**。成功的设计必须能够识别并消除这些潜在问题。

#### [状态变量](@entry_id:138790)的[竞争条件](@entry_id:177665)

当一次状态转换需要两个或更多的状态变量同时改变时，就会发生**[竞争条件](@entry_id:177665)**。由于门延迟的差异，这些变量实际上会以不可预测的顺序先后改变。这会导致电路短暂地进入一个或多个非预期的中间状态。

- **非临界竞争（Non-critical Race）**：如果所有可能的转换路径最终都导向同一个正确的稳定状态，那么这种竞争是**非临界**的。它可能会引起暂时的状态不一致，但不会影响最终结果。

- **临界竞争（Critical Race）**：如果不同的转换顺序导致电路进入不同的最终稳定状态，那么这种竞争就是**临界**的。这是[异步电路设计](@entry_id:172174)中的一个严重缺陷，因为它使电路的行为变得不确定。

例如，考虑一个从状态 $(0,0)$ 在输入 $X=1$ 时需要转换到 $(1,1)$ 的情况 ([@problem_id:1911080])。这里 $Y_1$ 和 $Y_2$ 都需要从 $0$ 变为 $1$。
1.  如果 $Y_1$ 先变：电路状态变为 $(1,0)$。如果此时 $(1,0)$ 对于输入 $X=1$ 是一个稳定状态，电路将停留在 $(1,0)$，这是一个错误的最终状态。
2.  如果 $Y_2$ 先变：电路状态变为 $(0,1)$。如果此时 $(0,1)$ 对于输入 $X=1$ 也是一个稳定状态，电路将停留在 $(0,1)$，这是另一个错误的最终状态。

因为最终状态取决于内部延迟的细微差别，这种情况就是一个典型的临界竞争。通过分析激励方程，我们也可以揭示同样的问题。一个从 $(0,0)$ 状态在输入 $x$ 从 $1$ 变为 $0$ 后，激励方程可能同时驱动 $Y_1$ 和 $Y_2$ 变为 $1$。分析显示，如果 $y_1$ 先变，电路可能稳定在 $(1,0)$；而如果 $y_2$ 先变，电路则可能稳定在 $(0,1)$ ([@problem_id:1911050])。

#### [组合逻辑](@entry_id:265083)中的险象

即使[状态分配](@entry_id:172668)是无竞争的，实现激励方程和输出方程的[组合逻辑](@entry_id:265083)部分也可能产生瞬态的错误信号，即**险象**。

- **静态险象（Static Hazard）**：当一个单输入变量变化时，电路的输出本应保持不变，但却出现了一个短暂的毛刺。
    - **静态-1险象**：输出应保持为 $1$，但出现了 $1 \to 0 \to 1$ 的脉冲。在“与或”两级逻辑（SOP）实现中，这通常发生在两个相邻的、使得输出为 $1$ 的[最小项](@entry_id:178262)（minterms）之间转换，而这两个[最小项](@entry_id:178262)没有被同一个乘积项（product term）所覆盖 ([@problem_id:1911062])。例如，从 $W'Y'Z$ 切换到 $XYZ$，当输入从 $0101$ 变到 $0111$ 时，$Y$ 发生变化，但没有任何一项同时覆盖这两个输入组合，可能导致输出瞬间变为 $0$。
    - **静态-0险象**：输出应保持为 $0$，但出现了 $0 \to 1 \to 0$ 的脉冲。这是“或与”两级逻辑（POS）实现中对应的现象。

- **动态险象（Dynamic Hazard）**：当一个单输入变量变化时，电路的输出本应从一个[逻辑电平](@entry_id:165095)平滑地转换到另一个（例如 $1 \to 0$），但实际上却发生了多次跳变（例如 $1 \to 0 \to 1 \to 0$）。动态险象发生的根本原因是，变化的输入信号通过**三条或更多条**具有不同传播延迟的路径到达同一个汇合点（通常是[输出门](@entry_id:634048)）。这些不同延迟的信号到达时，会像一系列连续的输入变化一样影响[输出门](@entry_id:634048)，从而产生[振荡](@entry_id:267781) ([@problem_id:1911047])。

#### 本质险象

**本质险象（Essential Hazard）**是一种更微妙且更难处理的险象，它源于流程表本身的结构，而不是特定[逻辑实现](@entry_id:173626)的缺陷。它是由外部输入信号的变化与内部[状态变量](@entry_id:138790)反馈信号之间的“竞争”引起的。

具体来说，当一个输入变化后，电路开始向新的状态转换。这个新的[状态变量](@entry_id:138790)值会通过反馈路径返回到[组合逻辑](@entry_id:265083)的输入端。如果外部输入信号的传播路径相对于[状态反馈](@entry_id:151441)路径的延迟过大，[组合逻辑](@entry_id:265083)可能会在看到新的输入值之前，先看到[状态变量](@entry_id:138790)的变化，从而做出错误的判断，导致电路进入一个非预期的稳定状态。

一个典型的例子是 ([@problem_id:1911053])：电路从稳定状态 D(11) 开始，输入 $x$ 从 $0$ 变为 $1$。预期的转换是到状态 C(10)。这意味着 $y_1$ 保持 $1$，$y_0$ 从 $1$ 变为 $0$。然而，下一状态 $Y_1$ 的方程可能依赖于 $x$ 和 $y_0$（例如 $Y_1 = y_1(y_0+x)$）。当 $x$ 从 $0 \to 1$ 而 $y_0$ 从 $1 \to 0$ 时，如果 $y_0$ 变化的信号比 $x$ 变化的信号先到达 $Y_1$ 的[逻辑门](@entry_id:142135)，该门可能会短暂地看到 $y_0=0$ 和 $x=0$ 的组合，导致 $Y_1$ 输出一个错误的 $0$ 脉冲。如果这个脉冲足够宽，它就能使[状态变量](@entry_id:138790) $y_1$ 翻转为 $0$，从而将电路引向完全错误的稳定状态 B(01)，而不是预期的 C(10)。

本质险象的存在要求在设计时必须仔细控制输入和反馈路径的延迟关系，这通常是[异步电路设计](@entry_id:172174)中最具挑战性的方面之一。