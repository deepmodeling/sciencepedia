{"hands_on_practices": [{"introduction": "在异步电路设计中，电路的行为最终由其激励方程决定。本练习将引导你直接从这些方程入手，通过分析在特定输入变化下状态变量的行为，来找出导致关键竞争的初始条件。掌握这种从数学描述中识别竞争冒险的技能，是进行底层电路验证和调试的基础。[@problem_id:1925474]", "problem": "一个用作控制器的异步时序电路，其行为由其两个内部存储元件 $y_1$ 和 $y_2$ 的激励方程定义。电路的次态，表示为 $(Y_1, Y_2)$，由现态 $(y_1, y_2)$ 和一个外部输入 $x$ 决定。其方程如下：\n$$Y_1 = y_2'x' + y_1x$$\n$$Y_2 = y_1'x' + y_2x$$\n这里，$x'$ 表示 $x$ 的逻辑非。\n\n如果对于给定的输入 $x$，次态与现态相同，即 $(Y_1, Y_2) = (y_1, y_2)$，则称状态 $(y_1, y_2)$ 是**稳定**的。\n\n当输入信号的变化导致电路从一个稳定状态转换到一个新状态，而这个新状态要求两个内部状态变量 $y_1$ 和 $y_2$ 同时改变时，就会发生**竞争条件**。\n\n如果电路最终稳定下来的状态取决于状态变量变化的不可预测顺序，则该竞争被定义为**临界**竞争。如果无论变化顺序如何，电路都达到相同的最终稳定状态，则该竞争是**非临界**的。\n\n假设控制器在输入保持为 $x=1$ 的稳定状态下运行。然后输入突然切换到 $x=0$。下列哪个初始稳定状态 $(y_1, y_2)$ 会导致电路进入临界竞争？选择所有有效选项。\n\nA. (0, 0)\n\nB. (0, 1)\n\nC. (1, 0)\n\nD. (1, 1)", "solution": "给定激励方程\n$$Y_{1}=y_{2}'x'+y_{1}x,\\quad Y_{2}=y_{1}'x'+y_{2}x.$$\n如果 $Y_{1}=y_{1}$ 且 $Y_{2}=y_{2}$，则状态 $(y_{1},y_{2})$ 对于给定的 $x$ 是稳定的。\n\n首先，确定当 $x=1$ 时的稳定性。代入 $x=1$ 得到 $x'=0$，因此\n$$Y_{1}=y_{2}'\\cdot 0+y_{1}\\cdot 1=y_{1},\\quad Y_{2}=y_{1}'\\cdot 0+y_{2}\\cdot 1=y_{2}.$$\n因此，对于 $x=1$，每个状态 $(y_{1},y_{2})\\in\\{(0,0),(0,1),(1,0),(1,1)\\}$ 都是稳定的。\n\n现在输入突然切换到 $x=0$。代入 $x=0$ 得到 $x'=1$，因此\n$$Y_{1}=y_{2}',\\quad Y_{2}=y_{1}'.$$\n因此，对于 $x=0$，一个状态是稳定的当且仅当 $(y_{1},y_{2})=(y_{2}',y_{1}')$，即 $y_{1}=y_{2}'$ 且 $y_{2}=y_{1}'$，这种情况只在 $(0,1)$ 和 $(1,0)$ 时发生。\n\n检查在 $x=1$ 时的每个初始稳定状态及其在切换到 $x=0$ 后的行为：\n- 从 $(0,1)$ 开始：当 $x=0$ 时，$Y_{1}=y_{2}'=0$, $Y_{2}=y_{1}'=1$，所以 $(Y_{1},Y_{2})=(0,1)$。状态不需要改变；没有竞争。\n- 从 $(1,0)$ 开始：当 $x=0$ 时，$Y_{1}=y_{2}'=1$, $Y_{2}=y_{1}'=0$，所以 $(Y_{1},Y_{2})=(1,0)$。状态不需要改变；没有竞争。\n- 从 $(0,0)$ 开始：当 $x=0$ 时，$Y_{1}=y_{2}'=1$, $Y_{2}=y_{1}'=1$，所以 $(Y_{1},Y_{2})=(1,1)$。$y_{1}$ 和 $y_{2}$ 都必须改变，因此发生竞争条件。为测试其是否为临界竞争，考虑由于延迟不等而可能发生的两种逐一转换：\n  - 如果 $y_{1}$ 先改变：$(0,0)\\to(1,0)$。在 $(1,0)$ 处重新计算：$Y_{1}=y_{2}'=1$, $Y_{2}=y_{1}'=0$，所以 $(1,0)$ 是稳定的；电路稳定在 $(1,0)$。\n  - 如果 $y_{2}$ 先改变：$(0,0)\\to(0,1)$。在 $(0,1)$ 处重新计算：$Y_{1}=y_{2}'=0$, $Y_{2}=y_{1}'=1$，所以 $(0,1)$ 是稳定的；电路稳定在 $(0,1)$。\n  最终的稳定状态取决于变化的顺序，所以这是临界竞争。\n- 从 $(1,1)$ 开始：当 $x=0$ 时，$Y_{1}=y_{2}'=0$, $Y_{2}=y_{1}'=0$，所以 $(Y_{1},Y_{2})=(0,0)$。$y_{1}$ 和 $y_{2}$ 都必须改变，因此发生竞争条件。测试其是否为临界竞争：\n  - 如果 $y_{1}$ 先改变：$(1,1)\\to(0,1)$。在 $(0,1)$ 处，$(Y_{1},Y_{2})=(0,1)$，所以它是稳定的；最终状态为 $(0,1)$。\n  - 如果 $y_{2}$ 先改变：$(1,1)\\to(1,0)$。在 $(1,0)$ 处，$(Y_{1},Y_{2})=(1,0)$，所以它是稳定的；最终状态为 $(1,0)$。\n  最终的稳定状态取决于变化的顺序，所以这是临界竞争。\n\n因此，输入变化 $x:1\\to 0$ 恰好从初始状态 $(0,0)$ 和 $(1,1)$ 引发临界竞争，即选项 A 和 D。", "answer": "$$\\boxed{AD}$$", "id": "1925474"}, {"introduction": "一旦识别出竞争，下一步就是判断其是否为“关键”的。本练习通过一个由两个逻辑门构成的极简反馈电路，直观地展示了物理门延迟的不可预测性如何导致电路最终稳定在完全不同的状态。这个思想实验将帮助你深刻理解为何关键竞争会引入不确定性，是异步设计中必须规避的风险。[@problem_id:1925439]", "problem": "一个异步时序电路由两个逻辑门构成，其输出（由状态变量 $y_1$ 和 $y_2$ 指定）被反馈作为输入。该电路的行为由激励方程 $Y_1 = y_2$ 和 $Y_2 = y_1$ 描述，其中 $Y_1$ 和 $Y_2$ 分别是变量 $y_1$ 和 $y_2$ 的目标下一状态。如果激励变量与状态变量匹配，即 $(Y_1, Y_2) = (y_1, y_2)$，则状态 $(y_1, y_2)$ 被认为是稳定的。实现 $y_1$ 和 $y_2$ 的物理逻辑门相关的传播延迟是未知的，但非零。\n\n假设电路初始处于状态 $(y_1, y_2) = (0, 1)$。分析电路的后续行为，并选择最准确描述结果的陈述。\n\nA. 电路将总是转换到稳定状态 $(1, 1)$。\n\nB. 电路将在状态 $(0, 1)$ 和 $(1, 0)$ 之间无限振荡。\n\nC. 电路经历非临界竞争，并将总是转换到稳定状态 $(0, 0)$。\n\nD. 电路经历临界竞争，最终的稳定状态是不确定的，可能是 $(0, 0)$ 或 $(1, 1)$。\n\nE. 电路将转换到状态 $(1, 0)$ 并保持在该状态。", "solution": "激励方程由下式给出\n$$\nY_{1}=y_{2}, \\quad Y_{2}=y_{1}.\n$$\n如果 $(Y_{1},Y_{2})=(y_{1},y_{2})$，则状态 $(y_{1},y_{2})$ 是稳定的。将激励方程代入稳定条件得到\n$$\ny_{1}=Y_{1}=y_{2}, \\quad y_{2}=Y_{2}=y_{1},\n$$\n这可以简化为约束条件 $y_{1}=y_{2}$。因此，仅有的稳定状态是\n$$\n(0,0)\\ \\text{和}\\ (1,1).\n$$\n\n从初始状态 $(y_{1},y_{2})=(0,1)$，激励计算为\n$$\nY_{1}=y_{2}=1, \\quad Y_{2}=y_{1}=0.\n$$\n因此，两个输出都被“请求”改变：$y_{1}$ 从 $0$ 变为 $1$，$y_{2}$ 从 $1$ 变为 $0$。设生成 $y_{1}$ 和 $y_{2}$ 的门的传播延迟分别为 $d_{1}$ 和 $d_{2}$，其中 $d_{1}>0$ 且 $d_{2}>0$。\n\n因为延迟是非零的，所以除非 $d_{1}=d_{2}$ 完全相等，否则这两个变化不能同时发生。其行为由第一个输出变化的相对顺序决定：\n\n1.  如果 $d_1  d_2$，即 $y_1$ 先变化，电路会进入中间状态 $(1,1)$。对于这个状态，激励是 $Y_1 = y_2 = 1$ 和 $Y_2 = y_1 = 1$。因为 $(Y_1,Y_2)=(1,1)$，所以 $(1,1)$ 是一个稳定状态。电路将稳定在 $(1,1)$。\n2.  如果 $d_2  d_1$，即 $y_2$ 先变化，电路会进入中间状态 $(0,0)$。对于这个状态，激励是 $Y_1 = y_2 = 0$ 和 $Y_2 = y_1 = 0$。因为 $(Y_1,Y_2)=(0,0)$，所以 $(0,0)$ 是一个稳定状态。电路将稳定在 $(0,0)$。\n\n由于最终的稳定状态 $(0,0)$ 或 $(1,1)$ 取决于 $d_1$ 和 $d_2$ 之间不可预测的细微差异，因此这是一个临界竞争。所以，选项 D 是对结果的最准确描述。", "answer": "$$\\boxed{D}$$", "id": "1925439"}, {"introduction": "识别和分析问题之后，设计的核心在于解决问题。本练习将你置于一个真实的设计场景中：一个流程表中的状态转换因关键竞争而变得不可靠。你的任务是应用一种标准的解决方法，即通过在流程表中策略性地引入一个中间不稳定状态，来引导电路沿着一条安全的、每次只改变一个状态变量的路径进行转换，从而消除竞争，确保电路的可靠性。[@problem_id:1925460]", "problem": "一个异步时序电路正在被设计用于控制一个简单的工业混合过程。该电路有两个外部输入 $x_1$ 和 $x_0$，以及四个内部状态，分别表示为 A、B、C 和 D。电路的行为由一个流表描述，其中内部状态由两个状态变量 $y_2$ 和 $y_1$ 表示。对于给定的输入，如果下一状态与当前状态相同，则该状态被认为是“稳定”的；否则，该状态是“不稳定”的。\n\n状态分配如下：\n- 状态 A: $y_2 y_1 = 00$\n- 状态 B: $y_2 y_1 = 01$\n- 状态 C: $y_2 y_1 = 11$\n- 状态 D: $y_2 y_1 = 10$\n\n下表给出了流表，显示了每个当前状态和输入组合的下一状态。\n\n| 当前状态 | 二进制 ($y_2 y_1$) | 下一状态 ($x_1x_0=00$) | 下一状态 ($x_1x_0=01$) | 下一状态 ($x_1x_0=10$) | 下一状态 ($x_1x_0=11$) |\n|:-------------:|:------------------:|:------------------------:|:------------------------:|:------------------------:|:------------------------:|\n| A             | 00                 | A                        | B                        | A                        | C                        |\n| B             | 01                 | A                        | B                        | D                        | B                        |\n| C             | 11                 | A                        | D                        | C                        | C                        |\n| D             | 10                 | A                        | D                        | C                        | B                        |\n\n在测试过程中，观察到当输入保持在 $x_1x_0 = 11$ 时，从状态 A 开始的转换不能可靠地到达预期的最终状态。这个问题是由临界竞争条件引起的。为了解决这个竞争，必须使用一个中间状态来引导转换，确保每次只有一个状态变量发生变化。\n\n以下哪项修改正确且完整地解决了这个特定的临界竞争？\n\nA. 在 $x_1x_0=11$ 的列中，将当前状态 A 的下一状态条目更改为 D，并将当前状态 D 的下一状态条目更改为 C。\n\nB. 在 $x_1x_0=11$ 的列中，仅将当前状态 A 的下一状态条目更改为 B。\n\nC. 在 $x_1x_0=11$ 的列中，仅将当前状态 D 的下一状态条目更改为 C。\n\nD. 交换状态 B 和状态 D 的二进制状态分配，即 B 变为 10，D 变为 01。\n\nE. 该竞争条件是非临界的，因此无需对流表进行任何修改。", "solution": "给定一个异步时序电路，它有两个状态变量 $y_{2}$ 和 $y_{1}$，以及状态分配 A:$00$、B:$01$、C:$11$、D:$10$。对于给定的输入 $(x_{1}x_{0})$，如果下一状态等于当前状态，则该状态是稳定的；否则它是不稳定的。\n\n根据流表，在输入 $x_{1}x_{0}=11$ 下，下一状态条目为：\n- 从 A:$00$ 到 C:$11$,\n- 从 B:$01$ 到 B:$01$ (稳定),\n- 从 C:$11$ 到 C:$11$ (稳定),\n- 从 D:$10$ 到 B:$01$。\n\n观察到的问题发生在输入保持在 $x_{1}x_{0}=11$ 并且从状态 A 开始转换时。预期的最终状态是 C。直接从 A:$00$ 转换到 C:$11$ 会同时改变两个状态变量，因为汉明距离是\n$$\nd_{H}\\big((0,0),(1,1)\\big)=2.\n$$\n在基本模式异步机中，当流表要求两位变化时，可能会发生临界竞争，因为一个状态变量可能先改变，从而暂时将电路移动到相邻的编码。从 A:$00$ 出发，相邻的单位比特差异状态是 B:$01$ 和 D:$10$。在 $x_{1}x_{0}=11$ 的输入下，流表显示：\n- 从 B:$01$ 的下一状态是 B:$01$ (稳定),\n- 从 D:$10$ 的下一状态是 B:$01$。\n\n因此，如果 $y_{1}$ 先改变，机器会从 $00 \\to 01$，然后停留在 B；如果 $y_{2}$ 先改变，机器会从 $00 \\to 10 \\to 01$，然后停留在 B。在任何一种情况下，机器都可能稳定在 B 而不是预期的 C，这证实了临界竞争的存在。\n\n要消除这个临界竞争，必须将输入 $x_{1}x_{0}=11$ 下从 A到 C 的转换分解为一个通过中间状态的单位比特变化序列，确保每次只有一个状态变量改变，并且该有向路径唯一地导向 C。评估各个选项：\n\n1) 选项 A 修改了 $x_{1}x_{0}=11$ 这一列，将 A 的下一状态更改为 D，将 D 的下一状态更改为 C。这创建了路径：\n$$\nA:00 \\xrightarrow{11} D:10 \\xrightarrow{11} C:11,\n$$\n每一步都只有单位比特的变化：\n$$\nd_{H}\\big((0,0),(1,0)\\big)=1,\\quad d_{H}\\big((1,0),(1,1)\\big)=1.\n$$\n在此修改下，当处于状态 A 且输入为 $x_{1}x_{0}=11$ 时，下一状态位为 $(y_{2}',y_{1}')=(1,0)$，因此只有 $y_{2}$ 从 $0$ 变为 $1$。到达 D 后，下一状态位为 $(y_{2}',y_{1}')=(1,1)$，因此只有 $y_{1}$ 从 $0$ 变为 $1$ 以到达 C。这消除了两位变化，从而解决了临界竞争。它还通过将 D:$10$ 到 C:$11$ 的转换替换了原来从 D:$10$ 到 B:$01$ 的两位转换，这是一个单位比特变化，从而消除了在输入为 $11$ 时机器处于 D 状态可能发生的任何竞争。\n\n2) 选项 B 仅将输入 $11$ 下 A 的下一状态更改为 B，即 $00 \\to 01$，但在输入 $11$ 下 B 稳定在 B。这将机器困在状态 B，而不是 C，因此既没有保持预期的行为，也没有解决到预期最终状态的竞争。\n\n3) 选项 C 仅将输入 $11$ 下 D 的下一状态更改为 C，但 A 在输入 $11$ 下的下一状态仍为 C。直接的两位变化 $00 \\to 11$ 仍然存在，因此从 A 开始的临界竞争没有被消除。\n\n4) 选项 D 交换了 B 和 D 的编码（B 变为 $10$，D 变为 $01$）。在输入 $11$ 下，从 A:$00$ 到 C:$11$ 的预期转换仍然具有 2 的汉明距离，所以临界竞争仍然存在。\n\n5) 选项 E 是无效的，因为观察到了临界竞争并且必须被纠正。\n\n因此，唯一能够通过强制在输入 $x_{1}x_{0}=11$ 下从 A 到 C 形成唯一的单位比特转换序列，从而正确且完整地解决这个特定临界竞争的修改是选项 A。", "answer": "$$\\boxed{A}$$", "id": "1925460"}]}