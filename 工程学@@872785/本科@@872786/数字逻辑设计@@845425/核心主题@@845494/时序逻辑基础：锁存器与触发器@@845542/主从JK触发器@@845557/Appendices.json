{"hands_on_practices": [{"introduction": "要真正掌握主从JK触发器的工作原理，必须能够根据时钟和数据输入，追踪其状态随时间的变化。[@problem_id:1945792]提供了一个具体的时序场景，要求你逐步分析，计算主锁存器在时钟高电平期间的状态，以及从锁存器在时钟下降沿的更新。这项基础练习将巩固你对主从JK触发器核心——两阶段操作——的理解。", "problem": "一个数字电路使用了一个主从JK触发器，其初始输出状态为 $Q=0$。该触发器的行为定义如下：当时钟信号($CLK$)为高电平（逻辑1）时，主锁存器是透明的，其状态 $Q_m$ 由特性方程 $Q_m = J\\bar{Q} + \\bar{K}Q$ 决定，其中 $J$ 和 $K$ 是输入， $Q$ 是触发器的当前输出。从锁存器仅在$CLK$信号的下降沿将最终输出 $Q$ 更新为主锁存器的状态 $Q_m$。当$CLK$为低电平（逻辑0）时，主锁存器和从锁存器都保持其当前状态。\n\n该触发器由一个周期为40 ns、占空比为50%的周期性时钟信号$CLK$驱动。在每个周期中，时钟信号在前20 ns为高电平，在后20 ns为低电平。具体来说，对于任何整数 $n \\ge 0$，CLK在时间间隔 $[40n \\text{ ns}, (40n + 20) \\text{ ns})$ 内为高电平，在 $[(40n + 20) \\text{ ns}, (40n + 40) \\text{ ns})$ 内为低电平。\n\n输入J和K随时间变化如下：\n- 对于时间间隔 $[0 \\text{ ns}, 30 \\text{ ns})$ 内的 $t$：$J=1$, $K=0$。\n- 对于时间间隔 $[30 \\text{ ns}, 70 \\text{ ns})$ 内的 $t$：$J=1$, $K=1$。\n- 对于时间间隔 $[70 \\text{ ns}, 120 \\text{ ns}]$ 内的 $t$：$J=0$, $K=1$。\n\n确定在 $t = 120$ ns 这个精确时刻，最终输出 $Q$ 的逻辑电平（0或1）。", "solution": "主锁存器仅在时钟为高电平时是透明的，并根据特性方程\n$$\nQ_{m}=J\\bar{Q}+\\bar{K}Q,\n$$\n设置 $Q_m$，而从锁存器仅在时钟下降沿将 $Q$ 更新为 $Q_m$。在周期为40 ns且占空比为50%的情况下，对于整数 $n\\geq 0$，下降沿发生在 $t=20+40n$ 的时刻。在 $t=120$ ns 之前，下降沿发生在 $t=20$ ns, $t=60$ ns, 和 $t=100$ ns。初始条件是 $Q(0)=0$。\n\n在第一个高电平阶段 $t\\in[0,20)$，输入为 $J=1$, $K=0$，且 $Q=0$，因此透明的主锁存器产生\n$$\nQ_{m}=1\\cdot\\bar{0}+\\bar{0}\\cdot 0=1\\cdot 1+1\\cdot 0=1.\n$$\n在 $t=20$ ns 的下降沿，从锁存器更新 $Q\\leftarrow Q_{m}=1$，所以 $Q$ 变为 $1$，然后在低电平阶段 $t\\in[20,40)$ 保持不变。\n\n在下一个上升沿 $t=40$ ns，时钟变为高电平，此时输入为 $J=1$, $K=1$（它们在低电平期间的 $t=30$ ns 时改变），而 $Q=1$ 是由上一次更新得到的。透明的主锁存器计算\n$$\nQ_{m}=1\\cdot\\bar{1}+\\bar{1}\\cdot 1=1\\cdot 0+0\\cdot 1=0,\n$$\n并在高电平窗口 $t\\in[40,60)$ 期间保持这个值。在 $t=60$ ns 的下降沿，从锁存器更新 $Q\\leftarrow 0$，所以 $Q$ 变为 $0$，然后在低电平阶段 $t\\in[60,80)$ 保持不变。\n\n在下一个上升沿 $t=80$ ns，输入为 $J=0$, $K=1$（它们在低电平期间的 $t=70$ ns 时改变），且 $Q=0$。透明的主锁存器计算\n$$\nQ_{m}=0\\cdot\\bar{0}+\\bar{1}\\cdot 0=0\\cdot 1+0\\cdot 0=0,\n$$\n并在高电平窗口 $t\\in[80,100)$ 期间保持这个值。在 $t=100$ ns 的下降沿，从锁存器更新 $Q\\leftarrow 0$，所以 $Q$ 保持为 $0$，然后在低电平阶段 $t\\in[100,120)$ 保持不变。\n\n在 $t=120$ ns 时是一个上升沿（下一个高电平的开始），根据定义，从锁存器在上升沿不进行更新。因此，在 $t=120$ ns 这个精确时刻的最终输出是前一个下降沿所确立的值，即 $Q=0$。", "answer": "$$\\boxed{0}$$", "id": "1945792"}, {"introduction": "为什么主从结构中从锁存器需要使用反相时钟？[@problem_id:1945778]通过一个假设的、缺少时钟反相器的故障电路来探讨这个问题。通过分析当 $J$ 和 $K$ 输入均为高电平时该电路的行为，你将发现“空翻”现象（race-around condition）——一种主从设计旨在避免的关键时序风险。这项练习能让你深刻理解时序逻辑电路背后的设计原理。", "problem": "一位工程师正在分析一个有故障的数字电路，该电路原设计为主从JK触发器。该触发器由两个级联的电平敏感SR锁存器构成，分别称为主锁存器和从锁存器。一个标准的SR锁存器有两个输入，$S$（Set，置位）和$R$（Reset，复位），以及一个输出Q。其行为定义如下：如果$S=1$且$R=0$，$Q$变为1；如果$S=0$且$R=1$，$Q$变为0；如果$S=0$且$R=0$，$Q$保持其先前的值。假设$S=1, R=1$的输入组合永远不会出现。每个锁存器还有一个使能输入（$EN$）；当$EN=1$时，锁存器是“透明的”（输出跟随S/R输入），当$EN=0$时，它处于“保持”状态。\n\n在原设计中，主锁存器的输入由逻辑 $S_{master} = J \\cdot \\overline{Q_{out}}$ 和 $R_{master} = K \\cdot Q_{out}$ 驱动，其中 $J$ 和 $K$ 是外部输入，$Q_{out}$ 是从锁存器的最终输出。从锁存器的输入由主锁存器的输出驱动：$S_{slave} = Q_{master}$ 和 $R_{slave} = \\overline{Q_{master}}$。主锁存器由主时钟信号 $CLK$ 使能，而从锁存器本应由反相时钟信号 $\\overline{CLK}$ 使能。\n\n然而，由于制造缺陷，用于从锁存器时钟输入端的反相器被一个同相缓冲器替代了。结果，主锁存器和从锁存器都由同一个信号 $CLK$ 使能。\n\n该电路处于以下条件：\n- 外部输入保持恒定：$J = 1$ 和 $K = 1$。\n- 时钟信号 $CLK$ 是一个周期性方波，在时间区间 $[2nT, (2n+1)T)$ 为高电平（逻辑1），在时间区间 $[(2n+1)T, (2n+2)T)$ 为低电平（逻辑0），其中 $T$ 是一个恒定的时间长度，$n$ 是任意非负整数（$n=0, 1, 2, \\dots$）。\n- 在时间 $t=0$ 时，触发器输出的初始状态为 $Q_{out}(0) = 0$。\n\n以下哪个陈述最准确地描述了在时钟为高电平的第一个时间区间内，即 $t$ 在 $[0, T)$ 范围内，输出 $Q_{out}$ 的行为？\n\nA. $Q_{out}$ 保持为0。\n\nB. $Q_{out}$ 发生一次从0到1的转换，然后保持为1。\n\nC. $Q_{out}$ 发生一次从0到1的转换，然后在时间 $T$ 之前转换回0。\n\nD. $Q_{out}$ 在0和1之间持续振荡。\n\nE. $Q_{out}$ 转换到一个不确定的亚稳态。", "solution": "问题要求分析一个有故障的主从JK触发器的行为，其中主锁存器和从锁存器都由同一个时钟信号 $CLK$ 使能。\n\n首先，我们根据时钟 $CLK$ 的状态来分析电路的行为。\n问题陈述主锁存器和从锁存器都是电平敏感的SR锁存器。当它们的使能输入为高电平（1）时，它们是“透明的”；当使能输入为低电平（0）时，它们“保持”其状态。由于故障，两个锁存器都使用 $CLK$ 作为其使能信号。\n\n情况1：$CLK = 0$\n当时钟为低电平时，主锁存器和从锁存器都处于“保持”状态。这意味着它们的输出，$Q_{master}$ 和 $Q_{out}$，分别不会改变，无论输入 $J$ 和 $K$ 为何。整个电路保持其状态。\n\n情况2：$CLK = 1$\n当时钟为高电平时，主锁存器和从锁存器都是“透明的”。这意味着它们的输出会在一个传播延迟后改变以反映其输入。\n从锁存器的输入是 $S_{slave} = Q_{master}$ 和 $R_{slave} = \\overline{Q_{master}}$。由于从锁存器是透明的，其输出 $Q_{out}$ 将直接跟随其S输入（因为S和R是互补的）。因此，在此阶段，$Q_{out} = Q_{master}$。\n\n现在我们来分析主锁存器。其输入是 $S_{master} = J \\cdot \\overline{Q_{out}}$ 和 $R_{master} = K \\cdot Q_{out}$。由于主锁存器也是透明的，其输出 $Q_{master}$ 将由这些输入决定。\n由于我们发现在 $CLK=1$ 时 $Q_{out}=Q_{master}$，我们可以用 $Q_{out}$ 替换 $Q_{master}$。这意味着整个级联结构实际上表现为一个单一的反馈系统，其输出 $Q_{out}$ 由自身的逻辑函数决定。\n\n让我们写出当 $CLK=1$ 时 $Q_{out}$ 的控制方程。该结构表现得像一个单一的SR锁存器，其输入为 $S = J \\cdot \\overline{Q_{out}}$ 和 $R = K \\cdot Q_{out}$。对于一个SR锁存器，给定当前状态 ($Q_{current}$)，其下一状态 ($Q_{next}$) 的特征方程是 $Q_{next} = S + \\bar{R} \\cdot Q_{current}$。\n在我们的透明系统中，“下一”状态持续更新“当前”状态。所以我们可以将 $Q_{out}$ 的行为写为：\n$Q_{out} = (J \\cdot \\overline{Q_{out}}) + \\overline{(K \\cdot Q_{out})} \\cdot Q_{out}$\n\n这个方程描述了一个JK锁存器。现在我们将问题中给定的特定输入应用于区间 $t \\in [0, T)$。\n在此区间内，$CLK=1$，且给定 $J=1$ 和 $K=1$。\n将这些值代入方程：\n$Q_{out} = (1 \\cdot \\overline{Q_{out}}) + \\overline{(1 \\cdot Q_{out})} \\cdot Q_{out}$\n$Q_{out} = \\overline{Q_{out}} + \\overline{Q_{out}} \\cdot Q_{out}$\n因为 $\\overline{Q_{out}} \\cdot Q_{out} = 0$，方程简化为：\n$Q_{out} = \\overline{Q_{out}}$\n\n这个结果，$Q_{out} = \\overline{Q_{out}}$，意味着电路的输出在逻辑上要求是其自身的反相。这无法通过一个稳定状态来满足。如果 $Q_{out}$ 是0，方程会强制它变为1。一旦它变为1（经过一个传播延迟后），方程又会强制它变为0。这个过程不断重复，导致输出 $Q_{out}$ 持续翻转。这种现象被称为“竞争冒险”（race-around）条件。\n\n因此，在 $CLK=1$ 的整个期间（区间 $[0, T)$），当 $J=1$ 和 $K=1$ 时，输出 $Q_{out}$ 将在逻辑0和逻辑1之间振荡。这与选项D相符。\n我们简要地看一下其他选项。\nA是错误的，因为初始状态 $Q_{out}=0$ 加上 $J=1, K=1$ 会立即引起变化。\nB是错误的，因为输出不会稳定在1；它会立即被强制回到0。\nC是错误的，因为行为是持续振荡，而不是单个脉冲。\nE是错误的，因为虽然振荡是一种非理想行为，但它是一个明确的振荡状态，而不是亚稳态（亚稳态通常是指卡在一个无效电压电平上的状态）。", "answer": "$$\\boxed{D}$$", "id": "1945778"}, {"introduction": "经典的脉冲触发主从触发器虽然解决了“空翻”问题，但它在整个时钟有效期间（脉冲触发）仍可能对输入变化敏感。[@problem_id:1945760]这项进阶练习要求你分析一个电路改进方案，它将脉冲触发的触发器转变为更稳定的边沿触发触发器。通过仔细研究输入锁存器和调整后的时钟信号如何协同工作，你将学会如何精确控制输入采样和输出更新的瞬间，这是高性能数字设计中的一项关键技能。", "problem": "一名数字系统工程师的任务是修改一个旧有电路，该电路使用一个标准的正脉冲触发主从JK触发器（MS-JK FF）。该MS-JK FF器件的关键特性如下：\n1.  其主级在其时钟输入`CLK_in`为高电平（逻辑1）的整个期间是透明的（即对其J和K输入敏感）。\n2.  其最终输出`Q`仅在其时钟输入`CLK_in`的下降沿（从1到0的跳变）更新。\n\n这种脉冲触发的特性使得电路在时钟为高电平期间，容易受到J和K输入线上的毛刺和时序冒险的影响。为了创建一个更鲁棒的设计，工程师考虑增加一个由两个D型锁存器组成的输入调节电路。D型锁存器是一个存储元件，具有一个数据输入`D`、一个锁存使能输入`LE`和一个输出`Y`。其行为定义为：当`LE`为高电平时，锁存器是透明的（`Y`跟随`D`）；当`LE`为低电平时，锁存器是不透明的（`Y`保持其最后一个值）。\n\n提出的新电路配置如下，使用一个表示为`CLK`的主系统时钟信号：\n- 外部`J`输入连接到第一个D型锁存器（J-锁存器）的`D`输入。\n- 外部`K`输入连接到第二个D型锁存器（K-锁存器）的`D`输入。\n- 系统时钟`CLK`直接连接到两个D型锁存器的`LE`输入。\n- J-锁存器的输出连接到MS-JK FF的`J`输入。\n- K-锁存器的输出连接到MS-JK FF的`K`输入。\n- 系统时钟`CLK`通过一个反相器，得到的`$\\overline{CLK}$`信号连接到MS-JK FF的时钟输入（`CLK_in`）。\n\n分析这个完整的、修改后的电路相对于主系统时钟`CLK`的时序行为。确定该电路的有效触发机制。\n\nA. 电路仍然是一个正脉冲触发的JK触发器。\n\nB. 电路被转换为一个负脉冲触发的JK触发器（主级在CLK=0时激活）。\n\nC. 电路变成一个真正的下降沿触发的JK触发器。\n\nD. 电路变成一个真正的上升沿触发的JK触发器。\n\nE. 电路会振荡或进入亚稳态，无法正常工作。\n\nF. 输出Q将只更新一次，然后无限期地保持锁存状态。", "solution": "我们来逐步分析整个电路相对于主系统时钟$CLK$的行为。\n\n**定义：**\n- MS-JK FF（主从JK触发器）：时钟输入为$CLK_{in}$。主级在$CLK_{in}=1$时透明，输出$Q$在$CLK_{in}$的下降沿更新。\n- D型锁存器：数据输入为$D$，锁存使能为$LE$，输出为$Y$。当$LE=1$时透明（$Y$跟随$D$），当$LE=0$时锁存。\n- 电路连接：两个D锁存器的$LE$输入都连接到$CLK$。它们的输出连接到MS-JK FF的$J$和$K$输入。MS-JK FF的时钟输入$CLK_{in}$连接到$\\overline{CLK}$。\n\n**行为分析：**\n\n1.  **当系统时钟 $CLK$ 为高电平 ($CLK=1$) 时：**\n    -   两个D型锁存器的$LE$输入为高电平，因此它们是透明的。它们的输出（即MS-JK FF的J和K输入）会实时跟随外部的$J$和$K$输入。\n    -   MS-JK FF的时钟输入$CLK_{in}$是$\\overline{CLK}$，即为低电平（0）。根据其特性，此时MS-JK FF的主级和从级都处于锁存（保持）状态。因此，在$CLK$为高电平的整个期间，外部$J$和$K$的任何变化都不会影响到MS-JK FF。\n\n2.  **当系统时钟 $CLK$ 发生下降沿 ($CLK: 1 \\to 0$) 时：**\n    -   两个D型锁存器的$LE$输入从高电平变为低电平。它们立即从透明状态转为锁存状态，捕获并保持了$CLK$下降沿瞬间的外部$J$和$K$输入值。\n    -   同时，MS-JK FF的时钟输入$CLK_{in}$（即$\\overline{CLK}$）发生上升沿（$0 \\to 1$）。这使得MS-JK FF的主级被使能，进入透明状态。\n\n3.  **当系统时钟 $CLK$ 为低电平 ($CLK=0$) 时：**\n    -   两个D型锁存器保持锁存状态，其输出是固定的，为$CLK$下降沿时捕获的值。\n    -   MS-JK FF的时钟输入$CLK_{in}$保持高电平（1）。其主级是透明的，并根据其$J$和$K$输入（由D锁存器提供的稳定值）来确定其下一个状态。由于输入是稳定的，主级不会受到外部输入的任何干扰。从级仍然处于锁存状态，最终输出$Q$不变。\n\n4.  **当系统时钟 $CLK$ 发生上升沿 ($CLK: 0 \\to 1$) 时：**\n    -   这是整个周期的关键时刻。MS-JK FF的时钟输入$CLK_{in}$（即$\\overline{CLK}$）发生下降沿（$1 \\to 0$）。\n    -   根据MS-JK FF的定义，其输出$Q$仅在时钟输入的下降沿更新。因此，在$CLK$的上升沿这一刻，MS-JK FF的从级会将主级在$CLK$低电平期间确定的状态复制到最终输出$Q$。\n\n**结论：**\n整个电路的行为总结如下：外部输入$J$和$K$在主系统时钟$CLK$的**下降沿**被采样和锁存。而电路的最终输出$Q$在主系统时钟$CLK$的**上升沿**更新。\n从外部看，这个组合电路表现为一个**真正的上升沿触发JK触发器**。它仅在$CLK$的上升沿瞬间对输入状态（即前一个下降沿锁存的值）做出反应并更新输出，从而消除了原始脉冲触发器件的输入敏感窗口。\n\n因此，正确选项是D。", "answer": "$$\\boxed{D}$$", "id": "1945760"}]}