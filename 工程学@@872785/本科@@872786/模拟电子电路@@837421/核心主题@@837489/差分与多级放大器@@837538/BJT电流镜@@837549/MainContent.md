## 引言
在[模拟集成电路设计](@entry_id:277019)的世界中，精确、稳定且可预测的电流源是构建高性能放大器、偏置网络和其他复杂系统的基石。与分立电路中常见的大电阻不同，集成电路需要更高效、更节省空间的方案来生成和分配电流。[BJT电流镜](@entry_id:261036)正是为解决这一核心问题而生的优雅解决方案，它已成为模拟设计师工具箱中不可或缺的基本构件。然而，从理想概念到实际应用，设计者必须面对有限晶体管增益、[输出电阻](@entry_id:276800)和温度效应等一系列非理想因素的挑战。本文旨在系统性地填补理论与实践之间的鸿沟，为读者提供对[BJT电流镜](@entry_id:261036)全面而深入的理解。

在接下来的内容中，我们将分步展开：首先，在“原理与机制”一章中，我们将深入剖析基本[电流镜](@entry_id:264819)的工作方式，量化其主要的误差来源，并介绍如Widlar和Wilson等关键的改进型设计。接着，在“应用与跨学科联系”一章，我们将展示这些电路如何作为[有源负载](@entry_id:262691)、偏置网络等在放大器、[振荡器](@entry_id:271549)和定时电路中发挥核心作用。最后，“动手实践”部分将通过精选的练习题，帮助您巩固所学知识并将其应用于实际问题分析。让我们首先从深入理解[BJT电流镜](@entry_id:261036)的内部工作原理开始。

## 原理与机制

在上一章引言的基础上，本章将深入探讨[双极结型晶体管](@entry_id:266088)（BJT）[电流镜](@entry_id:264819)的内部工作原理、关键性能参数以及为克服基本电路局限性而发展的各种改进型拓扑结构。我们将从最简单的双晶体管结构出发，系统地分析其理想工作[状态和](@entry_id:193625)主要的非理想效应，然后过渡到更高级的设计，这些设计旨在提高电流匹配精度和输出电阻。

### 基本双晶体管[电流镜](@entry_id:264819)

最基础的[电流镜](@entry_id:264819)结构由两个特性匹配的BJT组成，通常称为 $Q_1$ 和 $Q_2$。该电路的核心思想是利用BJT的特性，即当两个晶体管的基极-发射极电压 ($V_{BE}$) 相同时，它们的集电极电流 ($I_C$) 也将非常接近。

#### 理想工作原理与参考电流的建立

在一个典型的NPN[电流镜](@entry_id:264819)中，$Q_1$ 和 $Q_2$ 的发射极接地，基极相互连接。关键的配置在于参考晶体管 $Q_1$，其集电极与基极相连。这种“[二极管](@entry_id:160339)连接”的配置迫使 $Q_1$ 工作在[正向有源区](@entry_id:261687)，因为其基极-集电极电压 $V_{BC}$ 被固定为零。一个参考电流 $I_{\text{REF}}$ 被注入到 $Q_1$ 的集电极（也就是公共基极节点）。

由于 $Q_1$ 和 $Q_2$ 的基极-发射极电压 $V_{BE}$ 相同，并且我们假设晶体管是完美匹配的（即具有相同的饱和电流 $I_S$），那么根据BJT的集电极电流基本方程 $I_C = I_S \exp(V_{BE} / V_T)$，两个晶体管的集电极电流必然相等。因此，从 $Q_2$ 集电极流出的输出电流 $I_{\text{OUT}}$ 理想情况下精确地“镜像”了 $Q_1$ 的集电极电流 $I_{C1}$。

那么参考电流 $I_{\text{REF}}$ 本身是如何设定的呢？通常，这是通过一个连接在电源电压（如 $V_{CC}$）和 $Q_1$ 集电极之间的参考电阻 $R_{\text{REF}}$ 来实现的。通过在 $Q_1$ 的基极-发射极环路应用[基尔霍夫电压定律](@entry_id:276614)（KVL），我们可以确定 $I_{\text{REF}}$ 的值。例如，对于一个NPN[电流镜](@entry_id:264819)，参考电流约为 $I_{\text{REF}} \approx (V_{CC} - V_{BE1}) / R_{\text{REF}}$，其中 $V_{BE1}$ 约为 $0.7 \, \text{V}$。

在实际应用中，电源并非总是理想的。一个带有内部[串联](@entry_id:141009)电阻 $R_S$ 的非理想电源会影响参考电流的设定。在这种情况下，电源提供的电压会随着总电流的消耗而下降。总电流是参考电流和输出电流之和，即 $I_S = I_{\text{REF}} + I_{\text{OUT}}$。因此，电阻两端的实际电压为 $V = V_{CC} - (I_{\text{REF}} + I_{\text{OUT}}) R_S$。这将导致参考电流的表达式变为 $I_{\text{REF}} = (V - V_{BE}) / R_{\text{REF}}$。通过联立求解，可以得到更精确的电流值，这对于需要精密偏置的设计至关重要 [@problem_id:1283615]。

对于PNP型[电流镜](@entry_id:264819)，其工作原理相同，但所有电压和电流的[极性相](@entry_id:161819)反。其发射极通常连接到正电源 $V_{CC}$，而参考电阻必须连接在 $Q_1$ 的集电极/基极节点与一个更低的[电位](@entry_id:267554)（如地或负电源）之间，以便从该节点“吸出”电流，从而[正向偏置](@entry_id:159825)基极-发射极结 ($V_{EB} > 0$)。如果错误地将参考电阻连接到 $V_{CC}$，基极节点电压将被拉高至 $V_{CC}$，导致 $V_{EB} = 0$，晶体管将处于截止状态，无法建立有效的参考电流 [@problem_id:1283637]。

#### 二极管连接晶体管的特性

作为参考侧的核心，$Q_1$ 的[二极管](@entry_id:160339)连接结构值得进一步分析。它表现为一个双端器件，其小信号[动态电阻](@entry_id:268111) $R_d$ 对电路的交流特性有重要影响。在[小信号模型](@entry_id:270703)中，施加一个电压 $v$ 会产生一个电流 $i$。这个电流由三部分组成：流过基极-发射极输入电阻 $r_{\pi}$ 的电流、流过集电极-发射极输出电阻 $r_o$ 的电流，以及受控[电流源](@entry_id:275668) $g_m v_{\pi}$ 产生的电流。由于是[二极管](@entry_id:160339)连接，$v_{\pi} = v$。因此，总电流为 $i = v/r_{\pi} + v/r_o + g_m v$。[动态电阻](@entry_id:268111) $R_d = v/i$ 因此为：

$$
R_d = \frac{1}{g_m + \frac{1}{r_{\pi}} + \frac{1}{r_o}}
$$

将晶体管参数 $g_m = I_C/V_T$、$r_{\pi} = \beta/g_m$ 和 $r_o = V_A/I_C$ 代入，我们得到一个更精确的表达式 [@problem_id:1283641]：

$$
R_d = \frac{1}{I_C \left( \frac{1+1/\beta}{V_T} + \frac{1}{V_A} \right)}
$$

这个结果表明，二极管连接的BJT并非一个简单的理想二极管。它的[动态电阻](@entry_id:268111)不仅取决于跨导 $g_m$，还受到有限[电流增益](@entry_id:273397) $\beta$ 和[厄利效应](@entry_id:269996)（通过 $V_A$ 体现）的影响。在大多数情况下，由于 $g_m$ 是[主导项](@entry_id:167418)，我们可以近似认为 $R_d \approx 1/g_m = V_T/I_C$。

### 简单[电流镜](@entry_id:264819)的误差来源

理想的 $I_{\text{OUT}} = I_{\text{REF}}$ 关系在现实中会因几个非理想效应而偏离。理解这些误差的来源是设计高性能[电流镜](@entry_id:264819)的第一步。

#### 有限[电流增益](@entry_id:273397) ($\beta$) 误差

在理想模型中，我们假设晶体管的基极电流为零。然而，对于具有有限[电流增益](@entry_id:273397) $\beta$ 的实际BJT，必须有基极电流 $I_B = I_C / \beta$ 来维持集电极电流。在简单的双晶体管[电流镜](@entry_id:264819)中，参考电流 $I_{\text{REF}}$ 不仅需要提供 $Q_1$ 的集电极电流 $I_{C1}$，还必须同时提供 $Q_1$ 和 $Q_2$ 的基极电流 ($I_{B1}$ 和 $I_{B2}$)。

通过在 $Q_1$ 的集电极节点应用[基尔霍夫电流定律](@entry_id:270632)（KCL），我们得到：

$$
I_{\text{REF}} = I_{C1} + I_{B1} + I_{B2}
$$

由于晶体管匹配且 $V_{BE}$ 相同，我们有 $I_{C1} = I_{C2} = I_{\text{OUT}}$。将基极电流表示为 $I_{B1} = I_{B2} = I_{\text{OUT}}/\beta$，上式变为：

$$
I_{\text{REF}} = I_{\text{OUT}} + \frac{I_{\text{OUT}}}{\beta} + \frac{I_{\text{OUT}}}{\beta} = I_{\text{OUT}} \left(1 + \frac{2}{\beta}\right)
$$

因此，电流传输比 $I_{\text{OUT}} / I_{\text{REF}}$ 实际上是 [@problem_id:1283622]：

$$
\frac{I_{\text{OUT}}}{I_{\text{REF}}} = \frac{1}{1 + 2/\beta} = \frac{\beta}{\beta + 2}
$$

这个表达式明确地显示，由于有限的 $\beta$，输出电流总是略小于参考电流。误差大小约为 $2/\beta$。例如，如果设计要求输出电流不低于参考电流的99%，那么 $\beta/(\beta+2) \ge 0.99$，解得 $\beta \ge 198$。这说明，对于高精度[电流镜](@entry_id:264819)，高 $\beta$ 值的晶体管是必不可少的 [@problem_id:1283631]。

#### [厄利效应](@entry_id:269996)与有限[输出电阻](@entry_id:276800)

另一个主要的非理想效应是[厄利效应](@entry_id:269996)，即集电极-发射极电压 ($V_{CE}$) 的变化会调制基区有效宽度，从而影响集电极电流。这种效应通常用[厄利电压](@entry_id:265482) $V_A$ 来建模，集电极电流可以近似写为 $I_C \approx I_{S} \exp(V_{BE}/V_T)(1 + V_{CE}/V_A)$。

[厄利效应](@entry_id:269996)导致晶体管在[正向有源区](@entry_id:261687)具有有限的[输出电阻](@entry_id:276800)，其值近似为 $r_o = V_A / I_C$。对于[电流镜](@entry_id:264819)的输出晶体管 $Q_2$，这意味着 $I_{\text{OUT}}$ 会随着其集电极电压 $V_{OUT}$ 的变化而变化。因此，[电流镜](@entry_id:264819)并非一个理想的[电流源](@entry_id:275668)（具有无限[输出电阻](@entry_id:276800)），而是一个具有有限[输出电阻](@entry_id:276800) $r_o$ 的实际[电流源](@entry_id:275668)。

在简单的双晶体管[电流镜](@entry_id:264819)中，输出电阻就等于输出晶体管 $Q_2$ 自身的[输出电阻](@entry_id:276800) $r_{o2}$。要计算这个值，我们首先需要确定 $Q_2$ 的直流集电极电流 $I_{C2}$（即 $I_{\text{OUT}}$），然后使用公式 $r_o = V_A / I_{C2}$。$I_{C2}$ 的值会受到前述有限 $\beta$ 效应的影响。因此，精确的[输出电阻](@entry_id:276800)计算需要先计算出实际的 $I_{\text{OUT}}$ [@problem_id:1283613]：

$$
r_o = \frac{V_A}{I_{\text{OUT}}} = \frac{V_A}{I_{\text{REF}} \left(\frac{\beta}{\beta+2}\right)} = \frac{V_A (\beta+2)}{I_{\text{REF}} \beta}
$$

高输出电阻是衡量[电流源](@entry_id:275668)性能的关键指标，因为它决定了[电流源](@entry_id:275668)在负载电压变化时维持恒定电流的能力。简单[电流镜](@entry_id:264819)的输出电阻（通常在几十到几百千欧姆范围内）在许多应用中可能不足。

#### 晶体管失配与热效应

除了上述系统性误差，制造过程中的随机变化会导致 $Q_1$ 和 $Q_2$ 之间存在微小的物理差异（例如，不同的发射区面积或基区掺杂），这被称为**失配（mismatch）**。失配会导致即使在相同的 $V_{BE}$ 下，$I_{C1}$ 和 $I_{C2}$ 也不相等，从而直接引入[电流镜](@entry_id:264819)像误差。

一个更具系统性且在[集成电路](@entry_id:265543)设计中尤为重要的问题是**温度差异**。即使晶体管完美匹配，如果它们的工作温度不同，其电流-电压特性也会发生变化，导致显著的镜像误差。BJT的集电极电流方程 $I_C = I_S \exp(V_{BE} / V_T)$ 中的两个参数都对温度敏感：[热电压](@entry_id:267086) $V_T = k_B T / q$ 和饱和电流 $I_S$。饱和电流 $I_S$ 的温度依赖性尤为强烈，大致遵循 $I_S(T) \propto T^3 \exp(-E_g / (k_B T))$ 的关系，其中 $E_g$ 是[半导体](@entry_id:141536)的[带隙](@entry_id:191975)能量。

考虑一个场景，由于靠近高功率模块，输出晶体管 $Q_2$ 的温度 $T_2$ 高于参考晶体管 $Q_1$ 的温度 $T_1$。由于 $V_{BE1} = V_{BE2}$，我们可以推导出输出电流与参考电流的比值。这个比值不仅取决于温度比 $T_2/T_1$，还强烈地依赖于 $I_S$ 在不同温度下的比值，以及指数项中 $V_T$ 的变化。一个具体的分析表明 [@problem_id:1283617]，即使是几十度的温差，也可能导致输出电流成倍地增加，从而严重破坏[电流镜](@entry_id:264819)的精度。因此，在版图设计中，通常会将[电流镜](@entry_id:264819)的晶体管紧密地放置在一起，并采用对称布局，以确保它们具有尽可能一致的工作温度。

### 改进型[电流镜](@entry_id:264819)拓扑

为了克服简单[电流镜](@entry_id:264819)的局限性，工程师们发展了多种改进型电路拓扑。这些设计旨在减小 $\beta$ 误差、提高输出电阻或实现特定的电流关系。

#### 减小 $\beta$ 误差：三晶体管（Beta-Helper）[电流镜](@entry_id:264819)

为了解决由有限 $\beta$ 引起的 $2/\beta$ 误差，可以引入一个额外的“辅助”晶体管。在一种常见的三晶体管配置中，第三个晶体管 $Q_3$ 被用作一个发[射极跟随器](@entry_id:272066)，其任务是为 $Q_1$ 和 $Q_2$ 提供所需的基极电流。

在这种结构中，$Q_1$ 和 $Q_2$ 仍然构成核心的镜像对。$Q_3$ 的发射极连接到 $Q_1$ 和 $Q_2$ 的公共基极节点。参考电流 $I_{\text{REF}}$ 流入 $Q_1$ 的集电极，而 $Q_3$ 的基极电流则从该节点分流。$Q_3$ 的发射极电流 $I_{E3}$ 恰好等于 $I_{B1} + I_{B2}$。由于 $I_{B3} = I_{E3} / (\beta+1)$，流入 $Q_3$ 基极的电流仅为所需总基极电流的很小一部分。这意味着从 $I_{\text{REF}}$ 中“窃取”的电流大大减少。

经过详细的KCL分析 [@problem_id:1283619]，可以推导出这种“beta-helper”[电流镜](@entry_id:264819)的电流传输比为：

$$
\frac{I_{\text{OUT}}}{I_{\text{REF}}} = \frac{\beta(\beta+1)}{\beta^2+\beta+2} = \frac{1}{1 + \frac{2}{\beta^2+\beta}}
$$

其误差项约为 $2/\beta^2$，与简单[电流镜](@entry_id:264819)的 $2/\beta$ 相比，这是一个显著的改进。例如，如果 $\beta=100$，简单[电流镜](@entry_id:264819)的误差约为2%，而beta-helper[电流镜](@entry_id:264819)的误差仅为约0.02%。

#### 产生小电流：[Widlar电流源](@entry_id:268240)

在低[功耗](@entry_id:264815)设计中，常常需要产生微安（$\mu A$）级别甚至更低的[偏置电流](@entry_id:260952)。使用简单[电流镜](@entry_id:264819)来产生这样的小电流，需要一个非常大的参考电阻 $R_{\text{REF}}$，这在[集成电路](@entry_id:265543)中会占用巨大的芯片面积，是不切实际的。

**[Widlar电流源](@entry_id:268240)**通过在输出晶体管 $Q_2$ 的发射极[串联](@entry_id:141009)一个电阻 $R_E$ 来巧妙地解决这个问题。这个电阻在 $Q_1$ 和 $Q_2$ 的基极-发射极环路中产生了一个电压差。具体来说，$V_{BE1} = V_{BE2} + I_{OUT} R_E$。由于 $V_{BE1} > V_{BE2}$，即使晶体管匹配，$I_{OUT}$ 也会远小于 $I_{C1}$（即 $I_{\text{REF}}$）。

利用BJT的对数关系 $V_{BE} = V_T \ln(I_C/I_S)$，我们可以得到 $V_{BE1} - V_{BE2} = V_T \ln(I_{C1}/I_{OUT})$。将此与 KVL 关系结合，得到 Widlar [电流源](@entry_id:275668)的核心方程 [@problem_id:1283632]：

$$
R_E = \frac{V_{BE1} - V_{BE2}}{I_{OUT}} = \frac{V_T}{I_{OUT}} \ln\left(\frac{I_{\text{REF}}}{I_{\text{OUT}}}\right)
$$

这个方程允许我们通过选择合适的 $R_E$ 来获得一个远小于 $I_{\text{REF}}$ 的 $I_{\text{OUT}}$。例如，可以用一个毫安级别的参考电流和一个几千欧姆的电阻来产生一个微安级别的输出电流，从而大大节省了芯片面积。

#### 提升输出电阻：[Wilson电流镜](@entry_id:270168)

[Wilson电流镜](@entry_id:270168)是另一种三晶体管结构，其主要优点是极大地提高了[输出电阻](@entry_id:276800)，同时也能部分地减小 $\beta$ 误差。在一个经典的NPN [Wilson电流镜](@entry_id:270168)中，$Q_1$ 和 $Q_2$ 构成一个基本的镜像结构，但 $Q_2$ 的集电极并不直接作为输出，而是驱动第三个晶体管 $Q_3$ 的发射极。输出电流从 $Q_3$ 的集电极取出。$Q_3$ 的基极与 $Q_1$ 的基极和集电极相连。

[Wilson电流镜](@entry_id:270168)高[输出电阻](@entry_id:276800)的秘诀在于其内部的**[负反馈机制](@entry_id:175007)**。这个[反馈环](@entry_id:273536)路主要由晶体管 $Q_2$ 和 $Q_3$ 构成 [@problem_id:1283640]。其工作方式如下：如果输出电压（$Q_3$的集电极电压）试图增加，由于 $Q_3$ 的[厄利效应](@entry_id:269996)，其集电极电流会略微增加。然而，这一增加的电流会流经 $Q_2$ 的集电极。更重要的是，$Q_3$ 的 $V_{CE3}$ 增加会提升其发射极电压（即 $Q_2$ 的集电极电压）。$Q_2$ 的集电极电压的增加会通过其自身的[输出电阻](@entry_id:276800) $r_{o2}$ 进一步影响其电流，并通过 $Q_1$ 和 $Q_2$ 的基极连接反映到 $Q_3$ 的基极电压上。这个复杂的相互作用形成了一个[负反馈](@entry_id:138619)，有效地抑制了输出电流随输出电压的变化。

通过[小信号分析](@entry_id:263462)可以证明，[Wilson电流镜](@entry_id:270168)的输出电阻近似为 $r_o \approx \beta r_{o2} / 2$，比简单[电流镜](@entry_id:264819)的 $r_{o2}$ 提高了约 $\beta/2$ 倍。这种显著的性能提升使得[Wilson电流镜](@entry_id:270168)在需要高精度、高阻抗电流源的应用中（如作为放大器的[有源负载](@entry_id:262691)）非常受欢迎。

本章系统地剖析了[BJT电流镜](@entry_id:261036)从基本原理到实际误差，再到高级拓扑的演进。掌握这些原理和机制，是进行复杂[模拟集成电路设计](@entry_id:277019)的基础。