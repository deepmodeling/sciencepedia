## 引言
[差分放大器](@entry_id:272747)是[模拟电路设计](@entry_id:270580)的基石，其核心价值在于能够精确放大两路输入信号的微小差异，同时抑制环境中无处不在的[共模噪声](@entry_id:269684)。然而，理想与现实之间总存在差距。实际的[差分放大器](@entry_id:272747)并非完美，它们在一定程度上仍会对[共模信号](@entry_id:264851)产生响应，这种不期望的放大效应由一个关键参数——**共模增益 ($A_{cm}$)** 来描述。理解、分析并控制共模增益，是从普通电路设计迈向高性能模拟系统设计的关键一步，也是本文旨在解决的核心知识缺口。

为了帮助您系统性地掌握这一主题，本文将分为三个章节。首先，在“**原理与机制**”中，我们将深入剖析共模增益的定义，探讨其产生的根本原因（如有限的尾部阻抗），并介绍关键的分析工具（如共模半边电路）。接着，在“**应用与跨学科联系**”中，我们将视野扩展到实际工程领域，通过生物医学、通信系统和[集成电路](@entry_id:265543)设计的案例，展示[共模抑制](@entry_id:265391)在真实世界中的重要性与挑战。最后，通过“**动手实践**”部分，您将有机会通过具体计算和分析问题，将理论知识转化为解决实际问题的能力。让我们一同开始，揭开共模增益的神秘面纱，掌握提升[差分放大器](@entry_id:272747)性能的精髓。

## 原理与机制

[差分放大器](@entry_id:272747)的一个核心特性是其放大两路输入信号之差（[差模信号](@entry_id:272661)）的能力，同时抑制两路输入信号共同的部分（[共模信号](@entry_id:264851)）。在前一章中，我们介绍了[差分放大器](@entry_id:272747)的基本概念。本章将深入探讨其在抑制[共模信号](@entry_id:264851)方面的性能，重点阐述**共模增益 (common-mode gain)** 的原理、其非理想性的来源，以及评估和分析这些特性的关键机制。

### 共模增益与[共模抑制比](@entry_id:271843)

在理想情况下，[差分放大器](@entry_id:272747)的输出仅取决于其两路输入电压 $v_1$ 和 $v_2$ 之间的差值，即差模输入电压 $v_d = v_1 - v_2$。然而，在实际电路中，输出电压也会受到其输入平均值，即共模输入电压 $v_{cm} = \frac{v_1 + v_2}{2}$ 的微弱影响。这种影响的程度由**共模增益 ($A_{cm}$)** 来量化。

对于一个具有差分输出 $v_{o1}$ 和 $v_{o2}$ 的放大器，其共模输出电压定义为两个输出的平均值：$v_{ocm} = \frac{v_{o1} + v_{o2}}{2}$。因此，共模增益严格定义为共模输出电压与共模输入电压之比：

$$
A_{cm} = \frac{v_{ocm}}{v_{cm}}
$$

在许多分析和测量中，为简化起见，我们常常只考虑单端输出（例如，只取 $v_{o2}$ 作为输出 $v_o$）。在这种情况下，共模增益被定义为单端输出电压与共模输入电压之比 $A_{cm} = v_o / v_{cm}$。例如，在一个测试场景中，若对[差分放大器](@entry_id:272747)的两路输入施加一个峰值为 $1.50 \text{ V}$ 的同相正弦[共模信号](@entry_id:264851)，测得两路输出的同相[正弦信号](@entry_id:196767)峰值分别为 $12.5 \text{ mV}$ 和 $11.1 \text{ mV}$。那么，其共模输出电压的峰值为 $V_{ocm} = \frac{12.5 \text{ mV} + 11.1 \text{ mV}}{2} = 11.8 \text{ mV}$。因此，该放大器的共模增益幅度为 $|A_{cm}| = \frac{11.8 \text{ mV}}{1.50 \text{ V}} \approx 0.00787$ [@problem_id:1293127]。这个数值虽然很小，但并非为零，这正是实际放大器非理想性的体现。

[差分放大器](@entry_id:272747)的设计目标是最大化对[差模信号](@entry_id:272661)的放大作用，同时最小化对[共模信号](@entry_id:264851)的响应。因此，一个理想的[差分放大器](@entry_id:272747)，其**共模增益应为零** [@problem_id:1293094]。为了量化放大器抑制[共模信号](@entry_id:264851)的能力，我们引入了一个至关重要的性能指标：**[共模抑制比](@entry_id:271843) (Common-Mode Rejection Ratio, CMRR)**。它被定义为[差模增益](@entry_id:264461) $A_d$ 与共模增益 $A_{cm}$ 的幅值之比：

$$
\text{CMRR} = \left| \frac{A_d}{A_{cm}} \right|
$$

一个高品质的[差分放大器](@entry_id:272747)应具有非常高的CMRR。在实际应用中，CMRR通常用分贝 (dB) 表示：

$$
\text{CMRR}_{\text{dB}} = 20 \log_{10} \left| \frac{A_d}{A_{cm}} \right|
$$

[@problem_id:1293088]

高CMRR的实际意义在于它直接影响放大器在含噪环境下的性能。输入信号通常包含我们期望放大的微弱[差模信号](@entry_id:272661)（例如来自传感器的信号）和不希望被放大的[共模噪声](@entry_id:269684)（例如通过输入电缆感应到的60Hz电源噪声）。放大器的总输出 $v_{out}$ 可以线性地表示为：

$$
v_{out} = A_d v_d + A_{cm} v_{cm}
$$

其中，$A_d v_d$ 是被放大的有用信号部分，而 $A_{cm} v_{cm}$ 则是被放大的无用噪声部分。我们期望输出信号中，有用信号的幅度远大于噪声的幅度。这个比率可以表示为：

$$
\frac{\text{输出信号幅度}}{\text{输出噪声幅度}} = \frac{|A_d| |V_d|}{|A_{cm}| |V_{cm}|} = \text{CMRR} \times \frac{|V_d|}{|V_{cm}|}
$$

其中 $|V_d|$ 和 $|V_{cm}|$ 分别是[差模信号](@entry_id:272661)和[共模噪声](@entry_id:269684)的幅度。这个关系式清晰地表明，即使输入端的[共模噪声](@entry_id:269684)幅度 $|V_{cm}|$ 远大于[差模信号](@entry_id:272661)幅度 $|V_d|$，一个具有高CMRR的放大器仍然可以在输出端获得良好的[信噪比](@entry_id:185071) [@problem_id:1293139]。例如，一个CMRR为 $80 \text{ dB}$（即 $10^4$）的放大器，在处理一个幅度为 $2.0 \text{ mV}$ 的[差模信号](@entry_id:272661)和一个幅度为 $100.0 \text{ mV}$ 的[共模噪声](@entry_id:269684)时，其输出端的信号幅度将是噪声幅度的 $10^4 \times \frac{2.0}{100.0} = 200$ 倍。

### 共模增益的来源：有限的尾部阻抗

既然理想的共模增益为零，那么在实际电路中，非零的 $A_{cm}$ 来自何处？对于一个对称的[差分对](@entry_id:266000)（无论是MOSFET还是BJT），其共模增益的主要来源是用于偏置[差分对](@entry_id:266000)的**[尾电流源](@entry_id:262705) (tail current source)** 的非理想性，具体来说，是其**有限的[输出阻抗](@entry_id:265563)**。

让我们通过分析一个典型的MOSFET[差分放大器](@entry_id:272747)来阐明这一点。该放大器由两个相同的N[MOS晶体管](@entry_id:273779)M1和M2构成，漏极通过相同的负载电阻 $R_D$ 接到电源。两管的源极连接在一起，并通过一个尾电阻 $R_{SS}$ 接地。假设晶体管的输出电阻 $r_o$ 无穷大。当一个共模小信号电压 $v_{icm}$ 同时施加到M1和M2的栅极时，由于对称性，流过两个晶体管的电流变化是相同的。设公共源极节点的电压为 $v_s$，则每个晶体管的栅源电压为 $v_{gs} = v_{icm} - v_s$。根据[基尔霍夫电流定律](@entry_id:270632)(KCL)，在公共源极节点，两个晶体管源极电流之和等于流过尾电阻 $R_{SS}$ 的电流：

$$
2 g_m (v_{icm} - v_s) = \frac{v_s}{R_{SS}}
$$

其中 $g_m$ 是晶体管的跨导。从上式可以解出 $v_s$，进而得到每个晶体管的漏极电流变化 $i_d = g_m(v_{icm}-v_s)$。单端输出电压为 $v_o = -i_d R_D$。最终，我们可以推导出单端共模增益的表达式 [@problem_id:1293090] [@problem_id:1293070]：

$$
A_{cm} = \frac{v_o}{v_{icm}} = -\frac{g_{m} R_{D}}{1 + 2 g_{m} R_{SS}}
$$

这个公式是理解共模增益的核心。首先，它表明如果尾电阻 $R_{SS}$ 趋于无穷大（即[尾电流源](@entry_id:262705)为理想[电流源](@entry_id:275668)，[输出阻抗](@entry_id:265563)无限大），则 $A_{cm}$ 趋于零。这与我们的理想情况相符 [@problem_id:1293094]。其次，在实际设计中，通常满足 $2 g_m R_{SS} \gg 1$，此时上式可以近似为：

$$
A_{cm} \approx -\frac{R_D}{2 R_{SS}}
$$

这个近似式揭示了一个关键的设计原则：为了获得低的共模增益（从而实现高CMRR），最有效的手段是**最大化[尾电流源](@entry_id:262705)的[输出电阻](@entry_id:276800) $R_{SS}$** [@problem_id:1293128]。相比之下，减小 $R_D$ 或 $g_m$ 虽然也能降低 $A_{cm}$，但通常会以牺牲关键的[差模增益](@entry_id:264461)为代价，因此并非理想的策略。

同样的原理也适用于[BJT差分对](@entry_id:273108)。对于一个由BJT构成的[差分放大器](@entry_id:272747)，其集电极负载为 $R_C$，[尾电流源](@entry_id:262705)的输出电阻为 $R_o$，其共模增益表达式与MOSFET的情况非常相似 [@problem_id:1293120]：

$$
A_{cm} = -\frac{g_{m}R_{C}}{1+2g_{m}R_{o}}
$$

这再次证明，无论是MOSFET还是BJT电路，提高[尾电流源](@entry_id:262705)的[输出阻抗](@entry_id:265563)都是抑制共模增益的根本方法。

### 分析工具：共模半边电路

对于对称的差分电路，在进行共模分析时，可以利用其对称性来极大简化计算。这种方法被称为**共模半边电路 (common-mode half-circuit)** 分析法。由于在共模激励下，电路的左右两半行为完全相同，我们可以只分析其中一半。

构建共模半边电路的关键在于如何处理连接两个半边电路的公共节点，即尾节点。在完整的差分电路中，设尾部阻抗为 $Z_T$（例如，一个电阻 $R_{SS}$）。流过 $Z_T$ 的总电流是两个晶体管源极（或发射极）电流之和，即 $2i_s$，其中 $i_s$ 是单个晶体管的源极电流。因此，公共节点电压为 $v_s = (2i_s) Z_T$。当我们只看半边电路时，我们关心的是从单个晶体管源极“看”下去的等效阻抗。这个等效阻抗 $R_{eff}$ 满足 $v_s = i_s R_{eff}$。比较两个表达式，我们得到一个非常重要的结论：

$$
R_{eff} = 2 Z_T
$$

这意味着，在共模半边电路模型中，尾部阻抗的值需要加倍。例如，如果一个[MOS差分对](@entry_id:272034)的[尾电流源](@entry_id:262705)是由一个输出电阻为 $r_{o3}$ 的N[MOS晶体管](@entry_id:273779)实现的，那么在分析其共模半边电路时，源极与地之间连接的[等效电阻](@entry_id:264704)就是 $2r_{o3}$ [@problem_id:1293130]。利用这个简单的规则，我们可以将复杂的差分[电路分析](@entry_id:261116)简化为对一个单管放大器的分析，从而快速估算其共模性能。

### 高阶效应与非理想性

除了有限的尾部阻抗这一主要因素外，其他一些非理想性也会影响共模增益，尤其是在更精密的分析中。

#### 失配与共模-差模转换

我们之前的分析都基于电路是完全对称的假设。然而，由于制造公差，电路中的元件（如[负载电阻](@entry_id:267991)）总会存在微小的失配。这种失配会引入一种新的效应：**共模-差模转换 (common-mode to differential-mode conversion)**。

考虑一个[BJT差分对](@entry_id:273108)，其两个集电极[负载电阻](@entry_id:267991)不完全相等，分别为 $R_{C1} = R_C$ 和 $R_{C2} = R_C(1+\delta)$，其中 $\delta$ 是一个小的失配系数。当一个纯[共模信号](@entry_id:264851) $v_{cm}$ 输入时，尽管两个晶体管的集电极电流 $i_c$ 变化相同，但由于负载电阻不同，两个集电极的电压变化将不再相等：$v_{c1} = -i_c R_C$ 和 $v_{c2} = -i_c R_C(1+\delta)$。这将导致一个非零的差模输出电压 $v_{od} = v_{c1} - v_{c2} = i_c R_C \delta$。

这意味着，即使输入是纯[共模信号](@entry_id:264851)，输出端也会产生差模分量。这种转换的增益 $A_{cd} = v_{od}/v_{cm}$ 可以被推导出来，它正比于失配系数 $\delta$ [@problem_id:1293133]。这个效应会直接降低电路的CMRR，因为一个理想的差分输出应该只对差模输入有响应。因此，在高性能[模拟电路设计](@entry_id:270580)中，元件的精确匹配至关重要。

#### 共模增益的频率依赖性

在实际电路中，尾节点的阻抗并非纯电阻。特别是实现[尾电流源](@entry_id:262705)的晶体管，其输出端总会存在寄生的[结电容](@entry_id:159302)或栅漏电容。因此，尾节点总阻抗 $Z_T$ 更准确的模型是一个电阻 $R_T$ 与一个电容 $C_T$ 的并联。

$$
Z_T(s) = R_T \parallel \frac{1}{s C_T} = \frac{R_T}{1+s R_T C_T}
$$

在低频时，$s \to 0$，$Z_T$ 近似为 $R_T$。但随着频率 $\omega$ 的升高，$Z_T$ 的幅值会减小。根据我们之前导出的共模增益公式 $A_{cm} \approx -R_D/(2Z_T)$，尾部阻抗的减小将导致**共模增益的幅值随频率升高而增大**。这正是实际应用中观察到**CMRR在高频下会显著下降**的根本原因。

进一步分析可以发现，$A_{cm}(s)$ 的[传递函数](@entry_id:273897)在分子上包含一个零点，这个零点导致了其高频增益的提升 [@problem_id:1293135]。理解这种频率依赖性对于设计需要在宽带宽内保持高CMRR的放大器（例如高速[仪表放大器](@entry_id:265976)）至关重要。

#### 共模增益对直流输入电平的依赖

最后，一个更细微的效应是共模增益本身可能会随着直流（DC）共模输入电平 $V_{CM}$ 的变化而变化。这是因为[尾电流源](@entry_id:262705)晶体管的[输出电阻](@entry_id:276800) $R_{SS}$ 并非一个恒定的值，它本身也依赖于其漏源电压 $V_{DS}$。而[尾电流源](@entry_id:262705)的 $V_{DS}$ 又直接受到公共源极节点的DC电压 $V_P$ 的影响，而 $V_P$ 又与输入的DC共模电平 $V_{CM}$ 相关（例如，$V_P \approx V_{CM} - V_{GS,on}$）。

因此，当 $V_{CM}$ 变化时，[尾电流源](@entry_id:262705)的 $V_{DS}$ 会改变，导致其输出电阻 $R_{SS}$ 发生变化。由于 $A_{cm}$ 直接依赖于 $R_{SS}$，这就造成了 $A_{cm}$ 是 $V_{CM}$ 的函数 [@problem_id:1293114]。在要求高精度的应用中，这种共模增益随输入电平变化的特性可能会引入[非线性](@entry_id:637147)和失真，是设计时需要考虑的一个重要非理想因素。