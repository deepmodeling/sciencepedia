{"hands_on_practices": [{"introduction": "双斜率积分ADC的核心在于其将输入电压转换为一个时间间隔的能力。这个练习将带你亲手实践这一核心过程。通过为一个给定的输入电压计算完整的转换周期，你将直接体验到固定积分阶段和可变去积分阶段是如何协同工作的，并加深对电压-时间转换原理的理解。[@problem_id:1300342]", "problem": "一位电子工程师正在为高精度环境监测站设计一款定制的模数转换器 (ADC)。该 ADC 为双斜率积分型，因其在测量缓慢变化的信号时具有出色的抗噪声特性而被选用。\n\n该 ADC 设计的关键参数如下：\n- 该 ADC 的分辨率为 12 位。其内部计数器随系统时钟的每个周期而递增。\n- 系统时钟频率 $f_{clk}$ 精确为 4.096 MHz。\n- 该 ADC 使用负参考电压 $V_{ref} = -2.500$ V。其输入设计用于测量正电压，满量程范围为 0 V 至 $|V_{ref}|$。\n- 设计规定，对于任何转换，初始积分阶段（第一斜率）的持续时间总是等于 12 位计数器可能的最大计数值。\n\n连接到 ADC 的传感器提供了一个稳定的输入电压 $V_{in} = +1.500$ V。请计算该 ADC 对此特定输入电压完成一个完整转换周期所需的总时间。最终答案以毫秒 (ms) 表示，并四舍五入至三位有效数字。", "solution": "双斜率 ADC 首先对输入信号进行固定时间的积分，然后用相反极性的参考电压进行积分，直到积分器输出返回到零。反积分时间与输入电压成正比，由下式给出\n$$\nT_{2}=\\frac{V_{in}}{|V_{ref}|}T_{1}.\n$$\n初始积分时间等于最大计数值除以时钟频率：\n$$\nT_{1}=\\frac{N_{\\max}}{f_{clk}},\\quad N_{\\max}=2^{12}=4096,\\quad f_{clk}=4.096\\times 10^{6}.\n$$\n因此，\n$$\nT_{1}=\\frac{4096}{4.096\\times 10^{6}}=\\left(\\frac{4096}{4.096}\\right)\\times 10^{-6}\\,\\text{s}=1000\\times 10^{-6}\\,\\text{s}=1.000\\times 10^{-3}\\,\\text{s}.\n$$\n当 $V_{in}=1.500$ 且 $|V_{ref}|=2.500$ 时，\n$$\nT_{2}=\\frac{1.500}{2.500}\\left(1.000\\times 10^{-3}\\right)\\,\\text{s}=0.600\\times 10^{-3}\\,\\text{s}.\n$$\n总转换时间为\n$$\nT_{\\text{total}}=T_{1}+T_{2}=1.000\\times 10^{-3}+0.600\\times 10^{-3}=1.600\\times 10^{-3}\\,\\text{s}=1.60\\,\\text{ms},\n$$\n四舍五入至三位有效数字。", "answer": "$$\\boxed{1.60}$$", "id": "1300342"}, {"introduction": "理解了双斜率ADC的模拟工作原理后，下一个关键步骤是掌握其数字控制逻辑。这个练习将挑战你设计一个有限状态机，以精确地控制ADC的操作流程。通过确定不同状态（如空闲、积分、去积分）之间的转换条件，你将能够连接起模拟概念与数字实现之间的桥梁。[@problem_id:1300339]", "problem": "正在使用有限状态机模型设计一个用于双斜率积分式模数转换器 (ADC) 的简化数字控制逻辑。该逻辑的主要功能是正确地对 ADC 的操作阶段进行排序。\n\n该状态机有三个不同的状态：\n-   `S0_IDLE`：初始状态，在此状态下转换器的积分器被复位，系统等待转换命令。\n-   `S1_INTEGRATE`：在该状态下，对未知的正模拟输入电压 $V_{in}$ 进行积分，持续一个固定的时间段 $T_1$。\n-   `S2_DEINTEGRATE`：在该状态下，对一个已知的负参考电压 $-V_{ref}$ 进行积分，导致积分器的输出电压斜坡式地返回其初始值（零）。此阶段所用的时间 $T_2$ 由一个数字计数器测量，以确定 $V_{in}$ 的值。\n\n这些状态之间的转换由三个输入到控制逻辑的二进制信号控制：\n-   `START`：一个设置为逻辑 `1` 以启动转换的信号。当控制器检测到 `START=1` 时，它应跳出空闲状态。\n-   `TIMER_FLAG`：来自一个固定时长定时器的信号。在计时期间它保持为逻辑 `0`，并在固定积分时间 $T_1$ 结束的瞬间转换到 `1`。硬件确保在离开 `S1_INTEGRATE` 状态时将此标志复位为 `0`。\n-   `COMP`：一个过零比较器的输出。只要积分器的输出非零，它就处于逻辑 `0`，并在输出返回零的瞬间转换到 `1`。\n\n下列哪个选项正确地描述了在单个、完整的转换周期中，状态转换的顺序以及触发这些转换的条件？\n\nA. 系统从 `S0_IDLE` 开始。如果 `START=1`，它转换到 `S1_INTEGRATE`。从 `S1_INTEGRATE`，如果 `COMP=1`，它转换到 `S2_DEINTEGRATE`。从 `S2_DEINTEGRATE`，如果 `TIMER_FLAG=1`，它转换回 `S0_IDLE`。\n\nB. 系统从 `S0_IDLE` 开始。如果 `START=1`，它转换到 `S1_INTEGRATE`。从 `S1_INTEGRATE`，如果 `TIMER_FLAG=1`，它转换到 `S2_DEINTEGRATE`。从 `S2_DEINTEGRATE`，如果 `COMP=1`，它转换回 `S0_IDLE`。\n\nC. 系统从 `S0_IDLE` 开始。如果 `START=1`，它转换到 `S2_DEINTEGRATE`。从 `S2_DEINTEGRATE`，如果 `TIMER_FLAG=1`，它转换到 `S1_INTEGRATE`。从 `S1_INTEGRATE`，如果 `COMP=1`，它转换回 `S0_IDLE`。\n\nD. 系统从 `S0_IDLE` 开始。如果 `START=1`，它转换到 `S1_INTEGRATE`。从 `S1_INTEGRATE`，如果 `TIMER_FLAG=1`，它直接转换回 `S0_IDLE`。\n\nE. 系统从 `S0_IDLE` 开始。如果 `TIMER_FLAG=1`，它转换到 `S1_INTEGRATE`。从 `S1_INTEGRATE`，如果 `START=1`，它转换到 `S2_DEINTEGRATE`。从 `S2_DEINTEGRATE`，如果 `COMP=1`，它转换回 `S0_IDLE`。", "solution": "双斜率积分式 ADC 在两个计时阶段中运行，这两个阶段由一个积分器和一个过零事件控制。运算放大器积分器遵循\n$$\nv_{o}(t)=v_{o}(0)-\\frac{1}{RC}\\int_{0}^{t} v_{in}(\\tau)\\,d\\tau.\n$$\n在第一阶段（积分阶段），将恒定的未知输入 $V_{in}$ 施加固定的时间 $T_1$，输出从复位条件 $v_{o}(0)=0$ 演变为\n$$\nv_{o}(T_{1})=-\\frac{V_{in}}{RC}T_{1}.\n$$\n从此阶段到下一阶段的转换必须恰好在固定时间 $T_{1}$ 结束时发生。根据控制输入的定义，这发生在定时器将 $TIMER\\_FLAG$ 置为1时。因此，正确的 S1 到 S2 的转换条件是 $TIMER\\_FLAG=1$。\n\n在第二阶段（反向积分阶段），施加一个恒定的参考电压 $-V_{ref}$。输出随之演变为\n$$\nv_{o}(T_{1}+t)=v_{o}(T_{1})-\\frac{1}{RC}\\int_{0}^{t}(-V_{ref})\\,d\\tau=v_{o}(T_{1})+\\frac{V_{ref}}{RC}t.\n$$\n当输出返回零时，反向积分结束，这由下式定义了时间 $T_{2}$：\n$$\n0=v_{o}(T_{1})+\\frac{V_{ref}}{RC}T_{2}\\quad\\Longrightarrow\\quad T_{2}=\\frac{V_{in}}{V_{ref}}T_{1}.\n$$\n过零比较器恰好在输出返回零时将 $COMP$ 置为1，因此从 S2 返回 S0 的转换必须由 $COMP=1$ 触发。\n\n转换从复位状态 S0 开始，并在收到转换指令时（即当 $START=1$ 时）离开空闲状态，所以 S0 到 S1 的转换条件是 $START=1$。\n\n总结一个完整转换的正确转换过程：\n- S0 到 S1，条件为 $START=1$\n- S1 到 S2，条件为 $TIMER\\_FLAG=1$\n- S2 到 S0，条件为 $COMP=1$\n\n在所有选项中，这个顺序和这些触发条件与选项 B 的描述完全一致，而其他选项与双斜率转换的物理和时序事件不匹配：\n- A 错误地使用 $COMP=1$ 离开 S1，并使用 $TIMER\\_FLAG=1$ 离开 S2，这与正确的角色相反。\n- C 在 $START=1$ 时从 S2 开始，这与要求的“先积分后反向积分”的顺序相矛盾。\n- D 省略了必要的反向积分阶段。\n- E 将启动 S1 的条件设为 $TIMER\\_FLAG=1$，离开 S1 的条件设为 $START=1$，这两者都与定义的信号作用相矛盾。\n\n因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1300339"}, {"introduction": "在理想模型之外，现实世界中的电路总会存在各种非理想效应。这个练习将引导你分析一个常见的电路缺陷——比较器失调电压——如何影响ADC的精度。通过推导存在失调电压时的输出表达式，你将更深刻地理解精密测量系统中误差的来源，并培养分析和补偿这些误差的关键技能。[@problem_id:1300307]", "problem": "一位电子工程师正在对一个定制的双斜率积分式模数转换器 (ADC) 进行特性分析。该 ADC 的工作分为两个不同的阶段。在第一阶段（积分阶段），一个正的模拟输入电压 $V_{in}$ 被连接到积分器的输入端，持续时间固定为 $N_{int}$ 个时钟周期。该积分器由一个电阻 $R$ 和一个电容 $C$ 组成。在第二阶段（去积分阶段），积分器的输入端被切换到一个恒定的负参考电压 $-V_{ref}$（其中 $V_{ref}$ 是一个正值）。在此阶段，一个数字计数器测量积分器的输出电压返回到比较器阈值所需的时钟周期数 $N_{out}$。时钟频率为 $f_{clk}$。为便于分析，假设积分器内的运算放大器是理想的，并且在每个转换周期开始时，积分器的输出被复位至 0 V。\n\n组装后，测试发现比较器存在一个故障。当积分器输出电压达到一个小而稳定的负偏置电压 $-\\epsilon$（其中 $\\epsilon$ 是一个单位为伏特的正值常量）时，它会触发，而不是在电压达到 0 V 时触发。\n\n推导最终的数字输出计数 $N_{out}$ 关于输入电压 $V_{in}$ 和给定系统参数 $V_{ref}$、$N_{int}$、$R$、$C$、$f_{clk}$ 和 $\\epsilon$ 的表达式。", "solution": "设理想反相积分器满足标准关系式\n$$\nv_{o}(t)=v_{o}(0)-\\frac{1}{RC}\\int_{0}^{t}v_{in}(\\tau)\\,d\\tau,\n$$\n且每次转换开始时积分器输出被复位至零。\n\n积分阶段：\n- 输入为常数 $v_{in}(t)=V_{in}$，持续时间 $T_{int}$ 固定，对应于频率为 $f_{clk}$ 的 $N_{int}$ 个时钟周期，因此 $T_{int}=\\frac{N_{int}}{f_{clk}}$。\n- 积分结束时的输出为\n$$\nv_{o}(T_{int})=0-\\frac{1}{RC}\\int_{0}^{T_{int}}V_{in}\\,d\\tau=-\\frac{V_{in}T_{int}}{RC}.\n$$\n\n去积分阶段：\n- 输入被切换到一个常数 $v_{in}(t)=-V_{ref}$（其中 $V_{ref}>0$）。积分器输出随之演变为\n$$\nv_{o}(t)=v_{o}(T_{int})-\\frac{1}{RC}\\int_{0}^{t}(-V_{ref})\\,d\\tau\n=v_{o}(T_{int})+\\frac{V_{ref}}{RC}t.\n$$\n- 有故障的比较器在 $v_{o}(t)$ 达到 $-\\epsilon$（其中 $\\epsilon>0$）时触发。用 $T_{out}$ 表示去积分时间。令 $v_{o}(T_{out})=-\\epsilon$ 可得\n$$\n-\\epsilon=v_{o}(T_{int})+\\frac{V_{ref}}{RC}T_{out}.\n$$\n解出 $T_{out}$ 并代入 $v_{o}(T_{int})=-\\frac{V_{in}T_{int}}{RC}$ 得到\n$$\nT_{out}=\\frac{RC}{V_{ref}}\\left(-\\epsilon-\\left(-\\frac{V_{in}T_{int}}{RC}\\right)\\right)\n=\\frac{V_{in}T_{int}}{V_{ref}}-\\frac{\\epsilon RC}{V_{ref}}.\n$$\n\n数字输出计数：\n- 计数器测量的结果是 $N_{out}=f_{clk}T_{out}$。使用 $T_{int}=\\frac{N_{int}}{f_{clk}}$，\n$$\nN_{out}=f_{clk}\\left(\\frac{V_{in}T_{int}}{V_{ref}}-\\frac{\\epsilon RC}{V_{ref}}\\right)\n=\\frac{V_{in}}{V_{ref}}N_{int}-\\frac{\\epsilon RC f_{clk}}{V_{ref}}.\n$$\n\n此表达式假设积分过程使输出超过了 $-\\epsilon$（即 $V_{in}T_{int}>\\epsilon RC$），从而使得 $T_{out}>0$。在理想的零偏置情况 $\\epsilon=0$下，该表达式简化为标准的双斜率结果 $N_{out}=\\frac{V_{in}}{V_{ref}}N_{int}$，其中比较器偏置引入了一个值为 $\\frac{\\epsilon RC f_{clk}}{V_{ref}}$ 的恒定负计数偏置。", "answer": "$$\\boxed{\\frac{V_{in}}{V_{ref}}\\,N_{int}-\\frac{\\epsilon R C f_{clk}}{V_{ref}}}$$", "id": "1300307"}]}