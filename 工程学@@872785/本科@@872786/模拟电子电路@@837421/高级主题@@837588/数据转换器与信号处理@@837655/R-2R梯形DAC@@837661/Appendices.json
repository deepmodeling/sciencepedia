{"hands_on_practices": [{"introduction": "我们首先从一个基础练习开始，这个练习将帮助您掌握 R-2R DAC的核心功能：将数字信号转换为模拟信号。通过计算给定数字输入对应的输出电压，您将直接应用二进制加权电流原理。这项实践旨在巩固您对理想 R-2R DAC电路基本工作方式的理解 [@problem_id:1327560]。", "problem": "一个4位数字模拟转换器（DAC）采用标准的R-2R梯形网络结构构建。该网络连接到一个配置为反相求和放大器的理想运算放大器。运算放大器的反馈电阻 $R_f$ 等于梯形网络的基本电阻 $R$。4位数字输入的每一位由一个开关表示。数字“1”将R-2R梯形网络的相应输入连接到稳定的参考电压 $V_{ref}$，而数字“0”将其连接到地（0 V）。对于这个特定电路，参考电压为 $V_{ref} = 8.0$ V。\n\n对于二进制输入字 `1101`，确定运算放大器的模拟输出电压，其中最左边的位是最高有效位（MSB），最右边的位是最低有效位（LSB）。答案以伏特（V）表示。", "solution": "对于一个带有负反馈的理想反相运算放大器，其反相输入端处于虚地状态，因此其电压为 $0$。输入偏置电流为零。设4位字为 $b_{3}b_{2}b_{1}b_{0}$，其中 $b_{3}$ 是最高有效位（MSB），$b_{0}$ 是最低有效位（LSB）。\n\n在一个端接于虚地的 $R$–$2R$ 梯形网络中，线性和自相似结构意味着每个连接到 $V_{ref}$ 的位都会向求和节点贡献一个二进制加权的电流。具体来说，由位 $i$（从MSB的 $i=1$到LSB的 $i=4$ 计数）贡献的电流是\n$$\nI_{i} = b_{i}\\,\\frac{V_{ref}}{2^{i} R}\n$$。\n因此，从梯形网络进入求和节点的总电流为\n$$\nI_{\\text{in}} = \\sum_{i=1}^{4} b_{i}\\,\\frac{V_{ref}}{2^{i} R}\n$$。\n在虚地节点应用KCL并使用理想运算放大器模型，流过反馈电阻的电流为 $I_{f} = \\frac{V_{out}}{R_{f}}$（流入节点）。KCL（流入节点的电流总和为零）给出\n$$\nI_{\\text{in}} + \\frac{V_{out}}{R_{f}} = 0 \\quad \\Longrightarrow \\quad V_{out} = - R_{f}\\,I_{\\text{in}}\n$$。\n当 $R_{f} = R$ 时，这变为\n$$\nV_{out} = - V_{ref} \\sum_{i=1}^{4} \\frac{b_{i}}{2^{i}}\n$$。\n对于输入字 `1101`，若以 $i=1$ 为MSB索引，则有 $b_{1}=1, b_{2}=1, b_{3}=0, b_{4}=1$；等效地，按MSB到LSB的顺序，\n$$\n\\sum_{i=1}^{4} \\frac{b_{i}}{2^{i}} = \\frac{1}{2} + \\frac{1}{4} + 0 + \\frac{1}{16} = \\frac{13}{16}\n$$。\n因此，\n$$\nV_{out} = - V_{ref}\\,\\frac{13}{16}\n$$。\n代入 $V_{ref} = 8.0$ 得\n$$\nV_{out} = - 8.0 \\times \\frac{13}{16} = - \\frac{13}{2} = -6.5\n$$。", "answer": "$$\\boxed{-6.5}$$", "id": "1327560"}, {"introduction": "掌握了正向计算后，让我们来挑战一个“逆向工程”问题。在这个练习中，您需要根据已知的模拟输出电压来推断产生该电压的原始数字输入码。这种逆向思维的训练不仅能加深您对 DAC 转换关系的理解，而且在电路调试和系统分析等实际应用中也至关重要 [@problem_id:1327519]。", "problem": "一个4位R-2R梯形数模转换器 (DAC) 是使用一个处于反相求和配置下的理想运算放大器构建的。电阻网络使用的基础电阻值为 $R$。运算放大器的反馈电阻 $R_f$ 也被设置为等于 $R$。运算放大器的同相输入端接地。\n\n4位数字输入由二进制字 $D_3D_2D_1D_0$ 表示，其中 $D_3$ 是最高有效位 (MSB)，$D_0$ 是最低有效位 (LSB)。对于每一位 $D_i$，如果该位为 '1'，则梯形网络的相应输入端连接到参考电压 $V_{ref} = 8.0$ V。如果该位为 '0'，则该输入端接地 (0 V)。\n\n如果测得电路的稳态输出电压为 $V_{out} = -2.5$ V，请确定4位二进制输入码 $D_3D_2D_1D_0$。\n\nA. 0100\n\nB. 0101\n\nC. 0110\n\nD. 1010\n\nE. 0011", "solution": "因为运算放大器是理想的，具有负反馈且其同相输入端接地，所以求和节点处于虚地状态。R-2R梯形网络产生流入此虚地的二进制加权电流。根据叠加原理和R-2R梯形网络的特性，流入求和节点的总输入电流为\n$$\nI_{\\text{in}}=\\frac{V_{ref}}{R}\\left(\\frac{D_{3}}{2}+\\frac{D_{2}}{4}+\\frac{D_{1}}{8}+\\frac{D_{0}}{16}\\right)\n$$。\n在输入偏置电流为零的情况下，这个相同的电流流过反馈电阻。根据反馈电阻上的欧姆定律，输出电压为\n$$\nV_{out}=-R_{f}I_{\\text{in}}\n$$。\n给定 $R_{f}=R$，这可以简化为\n$$\nV_{out}=-V_{ref}\\left(\\frac{D_{3}}{2}+\\frac{D_{2}}{4}+\\frac{D_{1}}{8}+\\frac{D_{0}}{16}\\right)\n$$。\n代入 $V_{ref}=8.0$ 和测得的 $V_{out}=-2.5$，\n$$\n-2.5=-8.0\\left(\\frac{D_{3}}{2}+\\frac{D_{2}}{4}+\\frac{D_{1}}{8}+\\frac{D_{0}}{16}\\right)\n\\quad\\Rightarrow\\quad\n\\frac{D_{3}}{2}+\\frac{D_{2}}{4}+\\frac{D_{1}}{8}+\\frac{D_{0}}{16}=\\frac{2.5}{8}=\\frac{5}{16}\n$$。\n二进制加权和 $\\frac{5}{16}$ 唯一对应于\n$$\n\\frac{D_{3}}{2}+\\frac{D_{2}}{4}+\\frac{D_{1}}{8}+\\frac{D_{0}}{16}=\\frac{0}{2}+\\frac{1}{4}+\\frac{0}{8}+\\frac{1}{16}=\\frac{5}{16}\n$$，\n所以 $D_{3}D_{2}D_{1}D_{0}=0101$，这与选项B相符。", "answer": "$$\\boxed{B}$$", "id": "1327519"}, {"introduction": "理想元件在现实世界中并不存在，现在让我们踏入非理想电路的分析领域。这个练习模拟了一个常见的制造缺陷——电阻容差——并要求您量化它对 DAC 性能的影响。通过计算一个关键的性能指标，即微分非线性（DNL），您将学会如何分析元器件的微小偏差如何导致 DAC 整体性能的下降，这是从理论走向工程实践的关键一步 [@problem_id:1327546]。", "problem": "分析了一个4位电压模式R-2R梯形数模转换器（DAC）的非理想特性。该梯形网络的构造如下：\n\n一个阻值为 $2R$ 的终端电阻接地。该电阻的顶端定义为节点 $N_0$，对应最低有效位（LSB）。在节点 $N_0$ 处，一个阻值为 $2R$ 的并联电阻连接到代表LSB的电压源，该电压源提供 $b_0 V_{\\text{ref}}$ 的电压。一个串联电阻将节点 $N_0$ 连接到节点 $N_1$。\n\n在节点 $N_1$ 处，一个阻值为 $2R$ 的并联电阻连接到其对应的位源 $b_1 V_{\\text{ref}}$，一个串联电阻将节点 $N_1$ 连接到节点 $N_2$。对于节点 $N_2$（位 $b_2$）和节点 $N_3$（位 $b_3$，最高有效位或MSB），该结构重复。DAC的输出电压 $V_{\\text{out}}$ 是最终节点 $N_3$ 处的电压。\n\n在理想的DAC中，所有串联电阻的阻值都应为 $R$。然而，在这个特定的器件中，出现了一个制造缺陷。除了连接MSB节点（$N_3$）与相邻节点（$N_2$）的串联电阻外，所有电阻都是理想的。这个有缺陷的电阻的阻值为 $R' = R(1+\\epsilon)$，其中 $\\epsilon = 0.01$ 代表+1%的误差。\n\n计算从数字输入“0111”到“1000”的主要码转换的微分非线性（DNL），以LSB为单位表示。将您的最终答案四舍五入到四位有效数字。", "solution": "将码k处的DNL定义为 $\\mathrm{DNL}_{k}=\\frac{V_{\\text{out}}(k+1)-V_{\\text{out}}(k)}{V_{\\text{LSB,ideal}}}-1$，对于一个4位DAC，有 $V_{\\text{LSB,ideal}}=\\frac{V_{\\text{ref}}}{2^{4}}=\\frac{V_{\\text{ref}}}{16}$。我们需要计算从码0111到1000的步阶，即 $\\Delta V = V_{\\text{out}}(1000)-V_{\\text{out}}(0111)$。\n\n根据线性性质，可以写出 $V_{\\text{out}}=V_{\\text{ref}}\\sum_{i=0}^{3}w_{i}b_{i}$，其中 $w_{i}$ 是非理想梯形网络中的位权重。只有 $N_{2}$ 和 $N_{3}$ 之间的串联电阻是非理想的，其阻值为 $R'=R(1+\\epsilon)$。\n\n使用叠加定理和戴维南变换计算权重。\n\n1) MSB权重 $w_{3}$ (仅 $b_{3}=1$):\n当较低位为0时，从 $N_{2}$ 看向地的等效阻抗为 $Z_{N_{2}}=R$（这是具有正确终端电阻的标准R-2R网络的特性）。因此，从 $N_{3}$ 向下看的阻抗为 $Z_{\\text{down}}=R'+Z_{N_{2}}=R(1+\\epsilon)+R=R(2+\\epsilon)$。节点 $N_{3}$ 是一个分压器，位于连接到 $V_{\\text{ref}}$ 的 $2R$ 电阻和连接到地的 $Z_{\\text{down}}$ 之间，因此\n$$\nw_{3}=\\frac{V_{\\text{out}}}{V_{\\text{ref}}}=\\frac{Z_{\\text{down}}}{2R+Z_{\\text{down}}}=\\frac{2+\\epsilon}{4+\\epsilon}\n$$。\n\n2) 下一位权重 $w_{2}$ (仅 $b_{2}=1$):\n从 $N_{2}$ 看向地（不包括连接到源的 $2R$ 支路），下方的梯形网络为 $R+R=2R$（一个串联电阻 $R$ 连接到 $N_1$，以及从 $N_1$ 到地的等效阻抗 $Z_{N_{1}}=R$）。因此，当向上连接开路时，$N_{2}$ 处的戴维南等效为\n$$\nV_{\\text{th},2}=\\frac{2R}{2R+2R}V_{\\text{ref}}=\\frac{V_{\\text{ref}}}{2},\\quad R_{\\text{th},2}=(2R)\\parallel(2R)=R\n$$。\n通过 $R'$ 连接到 $N_{3}$（该节点有一个到地的并联电阻 $2R$）可得\n$$\nw_{2}=\\frac{V_{\\text{out}}}{V_{\\text{ref}}}=\\frac{V_{\\text{th},2}}{V_{\\text{ref}}}\\cdot\\frac{2R}{R'+R+2R}=\\frac{1}{2}\\cdot\\frac{2R}{R'+3R}=\\frac{1}{4+\\epsilon}\n$$。\n\n3) 权重 $w_{1}$ (仅 $b_{1}=1$):\n从下往上逐步构建戴维南等效。在 $N_{1}$ 处（下方到地的网络为 $2R$），$V_{\\text{th},1}=\\frac{V_{\\text{ref}}}{2}$ 且 $R_{\\text{th},1}=R$。通过一个串联电阻 $R$ 到达 $N_{2}$，该节点有一个到地的并联电阻 $2R$，在 $N_{2}$ 处产生：\n$$\nV_{\\text{th},2}=\\frac{V_{\\text{th},1}}{2}=\\frac{V_{\\text{ref}}}{4},\\quad R_{\\text{th},2}=R\n$$。\n然后通过 $R'$ 到达 $N_{3}$，该节点有一个到地的并联电阻 $2R$：\n$$\nw_{1}=\\frac{V_{\\text{out}}}{V_{\\text{ref}}}=\\frac{V_{\\text{th},2}}{V_{\\text{ref}}}\\cdot\\frac{2R}{R'+R+2R}=\\frac{1}{4}\\cdot\\frac{2R}{R'+3R}=\\frac{1}{2(4+\\epsilon)}\n$$。\n\n4) 权重 $w_{0}$ (仅 $b_{0}=1$):\n类似地进行，每一级向上的变换都将戴维南电压减半并保持 $R_{\\text{th}}=R$；经过三级到达 $N_{2}$，有 $V_{\\text{th},2}=\\frac{V_{\\text{ref}}}{8}$，$R_{\\text{th},2}=R$，因此\n$$\nw_{0}=\\frac{V_{\\text{out}}}{V_{\\text{ref}}}=\\frac{1}{8}\\cdot\\frac{2R}{R'+3R}=\\frac{1}{4(4+\\epsilon)}\n$$。\n\n因此，对于码1000和0111，\n$$\nV_{\\text{out}}(1000)=V_{\\text{ref}}\\,w_{3},\\quad V_{\\text{out}}(0111)=V_{\\text{ref}}\\,(w_{2}+w_{1}+w_{0})\n$$，\n实际步阶为\n$$\n\\Delta V=V_{\\text{ref}}\\left[w_{3}-(w_{2}+w_{1}+w_{0})\\right]\n$$。\n计算\n$$\nw_{2}+w_{1}+w_{0}=\\frac{1}{4+\\epsilon}\\left(1+\\frac{1}{2}+\\frac{1}{4}\\right)=\\frac{7}{4(4+\\epsilon)}\n$$，\n所以\n$$\nw_{3}-(w_{2}+w_{1}+w_{0})=\\frac{2+\\epsilon}{4+\\epsilon}-\\frac{7}{4(4+\\epsilon)}=\\frac{\\epsilon+\\frac{1}{4}}{4+\\epsilon}\n$$。\n\n当 $V_{\\text{LSB,ideal}}=\\frac{V_{\\text{ref}}}{16}$ 时，此转换处的DNL为\n$$\n\\mathrm{DNL}=\\frac{\\Delta V}{V_{\\text{LSB,ideal}}}-1=16\\cdot\\frac{\\epsilon+\\frac{1}{4}}{4+\\epsilon}-1=\\frac{15\\epsilon}{4+\\epsilon}\n$$。\n对于 $\\epsilon=0.01$，\n$$\n\\mathrm{DNL}=\\frac{15\\times 0.01}{4+0.01}=\\frac{0.15}{4.01}\\approx 0.03741\\ \\text{LSB}\n$$。", "answer": "$$\\boxed{0.03741}$$", "id": "1327546"}]}