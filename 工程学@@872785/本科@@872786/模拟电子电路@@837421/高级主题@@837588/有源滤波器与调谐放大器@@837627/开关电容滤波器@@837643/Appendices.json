{"hands_on_practices": [{"introduction": "在深入研究复杂的滤波器之前，我们首先需要掌握开关电容电路最基本的功能：模拟电阻器。这个练习将引导你分析一个最简单的开关电容电路，并通过计算流经电路的平均电流，来理解其等效电阻的来源 [@problem_id:1335122]。掌握这一核心概念是理解和设计任何开关电容滤波器的关键第一步。", "problem": "在现代集成电路中，精确的电阻值难以制造且占用较大面积。一种常见的替代方案是开关电容电路，它仅使用电容器和开关——这些在硅上易于精确制造的元器件——来模拟电阻。\n\n考虑一个用于模拟电阻的基本开关电容电路元件。该电路的构造如下：一个电容值为 $C_S$ 的电容器，其一个端子永久接地。电容器的另一个端子可以通过一组理想开关连接到两个点之一。开关 S1 将此端子连接到一个保持在恒定直流电压 $V_{in}$ 的输入节点。开关 S2 将同一个端子接地。\n\n这些开关由一个频率为 $f_{clk}$ 的两相不重叠时钟信号控制。时钟周期为 $T_{clk} = 1/f_{clk}$。\n- 在第一阶段 $\\phi_1$（持续时间为 $T_{clk}/2$）期间，开关 S1 闭合，开关 S2 断开。\n- 在第二阶段 $\\phi_2$（也持续时间为 $T_{clk}/2$）期间，开关 S1 断开，开关 S2 闭合。\n\n假设电路已运行足够长的时间以达到稳态，请确定在一个完整的时钟周期 $T_{clk}$ 内，从输入电压源 $V_{in}$ 吸取的平均电流 $I_{avg}$。请用 $V_{in}$、$C_S$ 和 $f_{clk}$ 的符号表达式表示你的最终答案。", "solution": "在阶段 $\\phi_{1}$ 期间，开关 S1 将电容器的上极板连接到电压为 $V_{in}$ 的输入源，而下极板保持接地。根据电容器的本构关系 $Q = CV$，在 $\\phi_{1}$ 结束时电容器上的电荷为\n$$\nQ_{\\phi_{1},\\,\\text{end}} = C_S V_{in}.\n$$\n在 $\\phi_{1}$ 开始之前，电路刚刚完成 $\\phi_{2}$ 阶段，在此期间 S2 将上极板接地，使电容器电压为零。因此，在 $\\phi_{1}$ 开始时电荷为\n$$\nQ_{\\phi_{1},\\,\\text{start}} = 0.\n$$\n因此，在 $\\phi_{1}$ 期间从电源吸取的净电荷是电容器电荷的变化量，\n$$\n\\Delta Q_{\\text{per cycle}} = Q_{\\phi_{1},\\,\\text{end}} - Q_{\\phi_{1},\\,\\text{start}} = C_S V_{in}.\n$$\n在 $\\phi_{2}$ 期间，由于 S1 断开，电容器通过 S2 向地放电，因此没有从电源吸取电荷。所以，在一个完整的时钟周期 $T_{clk}$ 内，从 $V_{in}$ 吸取的总电荷是 $C_S V_{in}$。\n\n根据一个周期内平均电流的定义，\n$$\nI_{avg} = \\frac{1}{T_{clk}} \\int_{0}^{T_{clk}} i(t)\\, dt = \\frac{\\Delta Q_{\\text{per cycle}}}{T_{clk}} = \\frac{C_S V_{in}}{T_{clk}}.\n$$\n使用 $T_{clk} = \\frac{1}{f_{clk}}$，我们得到\n$$\nI_{avg} = C_S V_{in} f_{clk}.\n$$\n这是标准的开关电容结果，等效于一个阻值为 $R_{eq} = \\frac{1}{C_S f_{clk}}$ 的电阻，因为 $I_{avg} = \\frac{V_{in}}{R_{eq}}$。", "answer": "$$\\boxed{C_S f_{clk} V_{in}}$$", "id": "1335122"}, {"introduction": "掌握了开关电容等效电阻的原理后，我们就可以用它来构建有用的电路模块了。本练习将向你展示如何使用开关电容技术构建一个基本的积分器，这是模拟信号处理中的一个重要组成部分 [@problem_id:1335129]。通过分析电荷在不同时钟相位的转移过程，你将能够推导出电路的输出电压，并体会到开关电容电路实现离散时间信号处理的精妙之处。", "problem": "现代模拟信号处理中的一个基本构建模块是开关电容 (SC) 积分器。考虑一个基本的 SC 积分器，它由一个理想运算放大器 (op-amp)、一个电容值为 $C_S$ 的输入电容器和一个电容值为 $C_I$ 的反馈电容器构成。该电路由一个周期为 $T_c$ 的两相不交叠时钟信号驱动。\n\n在一个时钟周期内的操作如下：\n1.  在第一相 ($\\phi_1$) 期间，一组理想开关将电容器 $C_S$ 连接到值为 $V_{in}$ 的恒定直流输入电压源两端，其正极板连接到电压源，负极板接地。\n2.  在第二相 ($\\phi_2$) 期间，开关重新配置电路。电容器 $C_S$ 与输入源断开。其正极板连接到运放的反相输入端，负极板保持接地。同时，电容器 $C_I$ 被置于反馈回路中，连接在运放的输出端和其反相输入端之间。运放的同相输入端保持在接地电位。\n\n假设在时间 $t=0$ 时，即第一个时钟周期开始之前，运放的输出电压为 $V_{out}(0) = 0$，并且电容器 $C_S$ 和 $C_I$ 均不带初始电荷。\n\n求在第一个完整时钟周期结束的瞬间，运放的输出电压 $V_{out}(T_c)$。请将您的答案表示为关于 $V_{in}$、$C_S$ 和 $C_I$ 的解析表达式。", "solution": "问题要求解一个开关电容积分器在一个完整时钟周期后的输出电压。我们可以通过分析在两个时钟相期间电容器上存储和转移的电荷，并利用理想运放的特性来解决这个问题。\n\n**第 1 步：分析在 $\\phi_1$ 相期间的电路。**\n在第一相期间，电容器 $C_S$ 直接连接在直流电压源 $V_{in}$ 的两端。它会充电，直到其两端的电压等于 $V_{in}$。在此相结束时，电容器 $C_S$ 上存储的电荷由电容的定义给出：\n$$Q_1 = C_S V_{C_S}$$\n由于 $V_{C_S} = V_{in}$，存储的电荷为：\n$$Q_1 = C_S V_{in}$$\n问题陈述，初始输出电压 $V_{out}(0)$ 为零，且电容器 $C_I$ 没有初始电荷。在 $\\phi_1$ 相期间，反馈回路没有以指定方式连接，因此输出电压保持为零，且 $C_I$ 保持不充电状态。\n\n**第 2 步：分析在 $\\phi_2$ 相期间的电路。**\n在第二相期间，开关配置发生变化。电容器 $C_S$ 现在连接在运放的反相输入端和地之间。运放的同相输入端接地。对于一个具有无限开环增益的理想运放，虚地原则适用：反相输入端的电压 $V_{-}$ 必须等于同相输入端的电压 $V_{+}$。\n$$V_{-} = V_{+} = 0 \\text{ V}$$\n由于电容器 $C_S$ 连接在反相输入端 ($V_{-}=0$) 和地之间， $C_S$ 两端的电压必须变为 0 V。为了达到这个状态， $C_S$ 必须完全放电。\n\n**第 3 步：应用电荷守恒原理。**\n存储在 $C_S$ 上的电荷 $Q_1 = C_S V_{in}$ 不会消失。因为理想运放具有无限大的输入阻抗，没有电流可以流入其输入端。因此，所有从 $C_S$ 流出的电荷都必须转移到反馈电容器 $C_I$ 上。\n转移到 $C_I$ 的电荷量为 $\\Delta Q_2 = Q_1$。\n$$\\Delta Q_2 = C_S V_{in}$$\n\n**第 4 步：计算最终输出电压。**\n在此相中，电容器 $C_I$ 连接在运放的输出端 (电位为 $V_{out}$) 和其反相输入端 (在虚地, $V_{-}=0$) 之间。因此，电容器 $C_I$ 两端的电压为：\n$$V_{C_I} = V_{-} - V_{out} = 0 - V_{out} = -V_{out}$$\n$C_I$ 上存储的电荷与其两端电压的关系为 $Q_2 = C_I V_{C_I}$。由于 $C_I$ 最初不带电，在 $\\phi_2$ 相结束时其上的电荷为 $Q_2 = \\Delta Q_2$。\n$$Q_2 = C_I (-V_{out})$$\n我们现在可以将从 $C_S$ 转移的电荷与在 $C_I$ 上累积的电荷相等：\n$$\\Delta Q_2 = Q_2$$\n$$C_S V_{in} = C_I (-V_{out})$$\n求解输出电压 $V_{out}$ 可得：\n$$V_{out} = -\\frac{C_S}{C_I} V_{in}$$\n这就是第一个完整时钟周期结束时 ($t=T_c$) 的输出电压。时钟周期 $T_c$ 本身会影响多个周期内的积分速率，但对于计算单个、完整的电荷转移事件的结果，其值是不需要的。\n\n最终答案是 $V_{out}(T_c) = - \\frac{C_S}{C_I} V_{in}$。", "answer": "$$\\boxed{-\\frac{C_S}{C_I}V_{in}}$$", "id": "1335129"}, {"introduction": "开关电容滤波器本质上是离散时间系统，因此使用 z 变换是分析其性能的最自然的方法。本练习将引导你为一个一阶低通滤波器建立差分方程，并推导其 z 域传递函数 [@problem_id:1335132]。通过将电容比值与滤波器在 z 平面中的极点位置直接联系起来，你将深刻理解物理元件参数是如何决定滤波器的频率响应和稳定性的。", "problem": "一个简单的一阶开关电容（SC）低通滤波器由两个电容（电容值分别为 $C_S$ 和 $C_I$）以及一个由两相不交叠时钟信号控制的开关阵列设计而成。该滤波器在由 $n$ 索引的单个时钟周期内的操作过程如下。我们假设输入电压在周期开始时被采样，并保持恒定值 $v_{in}[n-1]$。\n\n1.  在第一个时钟相位 $\\phi_1$ 期间，电容 $C_S$ 连接到输入电压源，充电至 $v_{in}[n-1]$。在此相位期间，保持着前一个周期的输出电压 $v_{out}[n-1]$ 的电容 $C_I$ 与 $C_S$ 断开。\n2.  在第二个时钟相位 $\\phi_2$ 期间，电容 $C_S$ 从输入源断开，并与电容 $C_I$ 并联。两个电容上存储的电荷重新分配，从而在并联组合上建立新的输出电压 $v_{out}[n]$。\n\n这种离散时间滤波行为可以用z域中的传递函数 $H(z) = V_{out}(z)/V_{in}(z)$ 来表征，该函数具有一个实极点。对于一个特定的应用，该滤波器的极点必须位于 $z_p = 0.820$。确定所需的电容比 $C_I/C_S$。以保留三位有效数字的实数形式给出您的答案。", "solution": "在相位 $\\phi_{1}$ 期间，$C_{S}$ 连接到输入端并充电至采样输入电压 $v_{in}[n-1]$。因此其电荷为 $Q_{S,i} = C_{S} v_{in}[n-1]$。电容 $C_{I}$ 被隔离并保持前一个输出电压 $v_{out}[n-1]$，因此其电荷为 $Q_{I,i} = C_{I} v_{out}[n-1]$。\n\n在相位 $\\phi_{2}$ 期间，$C_{S}$ 从输入端断开并与 $C_{I}$ 并联。根据电荷守恒（理想开关，无损耗），连接前后的总电荷相等：\n$$\nC_{S} v_{in}[n-1] + C_{I} v_{out}[n-1] = (C_{S} + C_{I}) v_{out}[n].\n$$\n求解 $v_{out}[n]$ 得到一阶差分方程\n$$\nv_{out}[n] = \\frac{C_{S}}{C_{S}+C_{I}} v_{in}[n-1] + \\frac{C_{I}}{C_{S}+C_{I}} v_{out}[n-1].\n$$\n\n进行z变换，其中 $V_{out}(z)$ 和 $V_{in}(z)$ 表示变换后的函数，并注意到与 $v_{in}[n-1]$ 和 $v_{out}[n-1]$ 相关联的单位采样延迟 $z^{-1}$，我们得到\n$$\nV_{out}(z) = \\frac{C_{S}}{C_{S}+C_{I}} z^{-1} V_{in}(z) + \\frac{C_{I}}{C_{S}+C_{I}} z^{-1} V_{out}(z).\n$$\n整理得到传递函数 $H(z) = \\frac{V_{out}(z)}{V_{in}(z)}$\n$$\nH(z) = \\frac{\\frac{C_{S}}{C_{S}+C_{I}} z^{-1}}{1 - \\frac{C_{I}}{C_{S}+C_{I}} z^{-1}}.\n$$\n极点 $z_{p}$ 满足\n$$\n1 - \\frac{C_{I}}{C_{S}+C_{I}} z^{-1} = 0 \\quad \\Rightarrow \\quad z_{p} = \\frac{C_{I}}{C_{S}+C_{I}}.\n$$\n令 $r = \\frac{C_{I}}{C_{S}}$。那么\n$$\nz_{p} = \\frac{r C_S}{C_S + r C_S} = \\frac{r}{1 + r} \\quad \\Rightarrow \\quad r = \\frac{z_{p}}{1 - z_{p}}.\n$$\n对于要求的极点位置 $z_{p} = 0.820$，\n$$\n\\frac{C_{I}}{C_{S}} = \\frac{0.820}{1 - 0.820} = \\frac{0.820}{0.180} = \\frac{41}{9} \\approx 4.555\\ldots\n$$\n四舍五入到三位有效数字，得到 $4.56$。", "answer": "$$\\boxed{4.56}$$", "id": "1335132"}]}