## 引言
折叠式共源共栅（Folded Cascode）[运算放大器](@entry_id:263966)是现代高性能[模拟集成电路设计](@entry_id:277019)中的一块关键基石。在对低[功耗](@entry_id:264815)、高增益和宽信号范围要求日益严苛的今天，该拓扑结构因其独特的性能优势而备受青睐。然而，对于许多工程师和学生而言，其复杂的晶体管结构和内部信号流常常构成理解上的障碍，导致在设计中难以权衡其在增益、速度、[功耗](@entry_id:264815)和电压摆幅等多个维度上的性能表现。本文旨在系统性地剖析折叠式[共源共栅放大器](@entry_id:273163)，填补理论知识与实际应用之间的鸿沟。通过本文，读者将全面掌握这一重要电路的内在机理与设计精髓。在“原理与机制”一章中，我们将深入其晶体管级电路，揭示其高增益和宽输入范围的来源。随后，“应用与跨学科连接”一章将展示该放大器在[数据转换](@entry_id:170268)器、精密测量等系统中的实际应用，并探讨其与控制理论、[噪声分析](@entry_id:261354)等领域的交叉。最后，“动手实践”部分将通过具体的设计计算，帮助读者将理论知识转化为实践能力。让我们首先从其最核心的工作原理开始。

## 原理与机制

本章在前一章介绍的基础上，深入探讨折叠式共源共栅（Folded Cascode）运算放大器的核心工作原理与内部机制。我们将解构其复杂的晶体管级结构，分析其信号路径，并阐明其关键性能指标背后的物理原理。通过本章的学习，读者将能够理解折叠式[共源共栅放大器](@entry_id:273163)为何能在实现高增益的同时，提供卓越的[输入共模范围](@entry_id:273151)和[频率响应](@entry_id:183149)特性，并能权衡其在[功耗](@entry_id:264815)等方面的设计折衷。

### 基本结构与信号通路

折叠式共源共栅运算放大器虽然可能由十几个晶体管构成，但其核心思想是构建一个高性能的**[单级放大器](@entry_id:263914)**。理解其结构的关键在于识别出几个核心的[功能模块](@entry_id:275097)，并追踪信号电流在这些模块之间的流动路径。

#### 核心功能模块

一个典型的折叠式[共源共栅放大器](@entry_id:273163)主要由以下几个部分组成：输入[差分对](@entry_id:266000)、电流折叠级、共源共栅级以及[有源负载](@entry_id:262691)。

1.  **输入[差分对](@entry_id:266000)（[跨导](@entry_id:274251)级）**：放大器的输入级是一个[差分对](@entry_id:266000)，通常由一对匹配的 PMOS 或 NMOS 晶体管构成。其核心功能是将输入的差分电压信号 $v_{id}$ 转换为差分电流信号 [@problem_id:1305070]。例如，在一个 PMOS 输入的放大器中，晶体管 M1 和 M2 的栅极分别连接到输入端 $V_{in+}$ 和 $V_{in-}$，其源极共同连接到一个[尾电流源](@entry_id:262705)。根据[跨导](@entry_id:274251)的定义 $i_d = g_m v_{gs}$，输入电压的微小变化会引起 M1 和 M2 漏极电流的等值反向变化，即 $\Delta i_{d1} = -\Delta i_{d2}$。这个差分电流 $\Delta i_{d1} - \Delta i_{d2} = g_m v_{id}$ 便是放大器的初始信号。

2.  **电流折叠级**：这是该拓扑最具特色的部分，也是其名称的由来。与将输入级和共源共栅级直接堆叠（如在套筒式 Cascode 放大器中）不同，折叠式拓扑使用额外的[电流源](@entry_id:275668)将输入级的信号电流“折叠”或重定向到另一组器件中。在一个 NMOS 输入的放大器中，输入对（M1, M2）产生向下的信号电流。该电流会进入两个“折叠”节点。在这些节点上，通常连接着一对作为恒流源工作的 PMOS 晶体管（例如 M3, M4）。这些 PMOS 器件的作用是将 NMOS 输入管产生的信号电流“向上”折叠，送入后续的 PMOS 共源共栅级 [@problem_id:1305040]。

    为了更具体地理解“折叠”过程，我们可以考察一个关键节点——“折叠节点”，即输入晶体管的漏极、折叠电流源的漏极以及共源共栅晶体管的源极三者相连之处。假设在一个 PMOS 输入结构中，输入管 M1 的静态漏极电流为 $I_{TAIL}/2$，一个 NMOS 折叠[电流源](@entry_id:275668) M5 提供一个恒定的下拉电流 $I_{FOLD}$。根据[基尔霍夫电流定律](@entry_id:270632)（KCL），流入后续共源共栅晶体管 M3 的电流必须为 $I_{M3} = I_{FOLD} - I_{D1}$。当一个小的[差分信号](@entry_id:260727) $v_{id}$ 施加时，M1 的漏极电流会变为 $I_{D1} = I_{TAIL}/2 + \Delta i_{d1}$。由于 $\Delta i_{d1}$ 与 $v_{id}$ 成正比，M3 中的电流也随之变化：$I_{M3} = (I_{FOLD} - I_{TAIL}/2) - \Delta i_{d1}$。这个过程清晰地展示了信号电流是如何从输入级被“折叠”并传递到共源共栅级的 [@problem_id:1305045]。为了保证信号的正确传递，折叠电流 $I_{FOLD}$ 在设计上必须大于输入对的单边[静态电流](@entry_id:275067) $I_{TAIL}/2$，以确保共源共栅晶体管始终处于导通状态。

3.  **共源共栅级与[有源负载](@entry_id:262691)**：折叠后的信号电流被送入一个共源共栅（Cascode）级。这些共源共栅晶体管（其栅极连接到固定的偏置电压）的主要作用是显著提升放大器的[输出电阻](@entry_id:276800) $R_{out}$ [@problem_id:1305078]。由于放大器的电压增益近似为 $A_v \approx G_m R_{out}$（其中 $G_m$ 是输入级的总跨导），提高 $R_{out}$ 是实现高增益的关键。一个典型的 Cascode 结构可以将[输出电阻提升](@entry_id:268164)大约一个晶体管[本征增益](@entry_id:262690) $(g_m r_o)$ 的倍数。信号电流最终流经共源共栅级，并驱动一个[有源负载](@entry_id:262691)（通常是[电流镜](@entry_id:264819)结构），从而在输出节点上产生一个大的电压摆动。

#### 完整信号电流路径

现在，我们将这些模块[串联](@entry_id:141009)起来，追踪一个完整的信号路径。考虑一个 NMOS 输入的折叠式[共源共栅放大器](@entry_id:273163)，当一个正的小信号电压施加到非反相输入端（M1 的栅极）时，会发生以下过程 [@problem_id:1305069]：

-   通过[差分对](@entry_id:266000)的共源节点耦合，M1 的漏极电流 $\Delta i_{d1}$ 会增加，而 M2 的漏极电流 $\Delta i_{d2}$ 会以相同幅度减小 ($\Delta i_{d2} = -\Delta i_{d1}$)。

-   在 M1 所在的一侧，增加的电流 $\Delta i_{d1}$ 被 PMOS 折叠器件“向上”折叠，流经 PMOS 共源共栅管 M5，并进入作为[有源负载](@entry_id:262691)的 NMOS [电流镜](@entry_id:264819)的输入端（一个[二极管](@entry_id:160339)连接的晶体管 M7）。

-   [电流镜](@entry_id:264819) M7-M8 会“感知”到这个电流变化，并在其输出端（M8 的漏极）产生一个对应的镜像电流。这个镜像电流直接被“拉出”输出节点。

-   同时，在 M2 所在的一侧，减小的电流 $\Delta i_{d2}$（等效于一个增加的向上电流）被另一个 PMOS 折叠器件折叠，直接流经 PMOS 共源共栅管 M6，“推入”到输出节点。

-   最终，在输出节点上，来自 M6 的推入电流和来自 M8 的拉出电流叠加，共同驱动负载电容，产生输出电压。这种“推挽”式的操作有效地将[差分信号](@entry_id:260727)转换为了单端输出。

### 关键性能特征与分析

理解了基本结构后，我们来分析折叠式[共源共栅放大器](@entry_id:273163)的几个决定性性能特征。

#### [电压增益](@entry_id:266814)与[单级放大器](@entry_id:263914)特性

尽管折叠式[共源共栅放大器](@entry_id:273163)包含大量晶体管，但从[信号分析](@entry_id:266450)的角度看，它被严格归类为**[单级放大器](@entry_id:263914)**。其根本原因在于，在整个前向信号路径中，**仅存在一个高阻抗节点**——即最终的输出节点 [@problem_id:1305037]。放大器的总[电压增益](@entry_id:266814)主要是在这个节点上通过将信号电流乘以该节点巨大的输出电阻 $R_{out}$ 而产生的 ($A_v \approx G_m R_{out}$)。放大器的频率响应也由该节点决定，其主极点 $p_{dom}$ 近似为 $1/(R_{out} C_{out})$，其中 $C_{out}$ 是输出总电容。

相比之下，信号路径上的其他节点，如关键的“折叠节点”，实际上是低阻抗节点。这是因为信号电流被注入到一个共栅晶体管的源极，而从源极看进去的输入阻抗大约为 $1/g_m$（其中 $g_m$ 是该共栅晶体管的跨导），这是一个很小的值。因此，这些内部节点不会产生低频极点，不会显著影响主导[频率响应](@entry_id:183149)，从而保持了电路的单级特性。

#### [输入共模范围](@entry_id:273151) (ICMR)

折叠式共源共栅拓扑的一个显著优势是其宽广的[输入共模范围](@entry_id:273151)。特别是对于 NMOS 输入的折叠式[共源共栅放大器](@entry_id:273163)，通过精心设计，其输入[共模电压](@entry_id:267734)的上限可以达到甚至超过正电源轨 $V_{DD}$，这是传统的 NMOS 输入套筒式（Telescopic）[共源共栅放大器](@entry_id:273163)难以企及的。

其物理原因在于**输入级与共源共栅级的[解耦](@entry_id:637294)** [@problem_id:1305063]。在套筒式结构中，输入[差分对](@entry_id:266000)的 NMOS 晶体管直接堆叠在 NMOS 共源共栅晶体管下方。当输入[共模电压](@entry_id:267734) $V_{CM}$ 升高时，为了保持输入管工作在饱和区，其漏极电压也必须相应抬高。然而，这个漏极电压同时受到上方共源共栅管和负载管饱和所需电压裕量的限制，这导致 $V_{CM}$ 的上限被严重压缩，远低于 $V_{DD}$。

而在折叠式结构中，输入[差分对](@entry_id:266000)和输出的共源共栅级不处于同一个直流电流路径上。NMOS 输入管的漏极（折叠节点）连接的是 PMOS 折叠器件。这个节点的电压主要由 PMOS 侧的偏置决定，而与输入的 NMOS 管的源极电压（由 $V_{CM}$ 决定）没有直接的堆叠关系。因此，即使 $V_{CM}$ 升高到接近 $V_{DD}$，只要输入管的栅源电压 $V_{GS}$ 仍能维持，且其漏源电压 $V_{DS}$ 满足饱和条件，输入级就可以正常工作。这种结构上的“折叠”或“分离”，打破了套筒式结构中从地到 $V_{DD}$ 的严格电压裕量堆叠，从而极大地扩展了[输入共模范围](@entry_id:273151)。

#### [频率响应](@entry_id:183149)与稳定性

在高速应用中，折叠式[共源共栅放大器](@entry_id:273163)的另一个关键优势在于其优越的频率特性，特别是与广泛使用的两级[密勒补偿](@entry_id:270908)（Miller-compensated）放大器相比。

标准的两级[密勒补偿](@entry_id:270908)放大器为了稳定，在第二级的输入和输出之间跨接一个[密勒电容](@entry_id:268711) $C_M$。虽然这种方法能有效地进行主极点补偿，但它引入了一个固有的问题：在[复频率](@entry_id:266400)平面的[右半平面](@entry_id:277010)（Right-Half-Plane, RHP）产生一个零点，其频率近似为 $\omega_z = g_{m2}/C_M$，其中 $g_{m2}$ 是第二级的[跨导](@entry_id:274251)。RHP 零点会引入额外的相位滞后，从而削弱放大器的[相位裕度](@entry_id:264609)，限制了其在给定功耗下的速度和稳定性。

相比之下，折叠式[共源共栅放大器](@entry_id:273163)作为[单级放大器](@entry_id:263914)，其[频率补偿](@entry_id:263725)通常由负载电容本身完成，无需使用跨接反相增益级的[密勒电容](@entry_id:268711)。因此，它**从结构上避免了由[密勒补偿](@entry_id:270908)引起的[右半平面零点](@entry_id:263623)** [@problem_id:1305033]。这使得在相同的[增益带宽积](@entry_id:266298)下，折叠式[共源共栅放大器](@entry_id:273163)通常具有更好的[相位裕度](@entry_id:264609)，表现出更佳的稳定性和更纯净的[阶跃响应](@entry_id:148543)，这对于高速、高精度应用至关重要。

### 设计权衡与考量

尽管折叠式[共源共栅放大器](@entry_id:273163)具有诸多优点，但在实际设计中，工程师必须权衡其固有的缺点，主要是功耗和复杂性。

#### 功耗权衡

折叠式[共源共栅放大器](@entry_id:273163)的一个主要代价是**相对较高的功耗**。与结构更简单的[套筒式共源共栅放大器](@entry_id:268246)相比，为了实现相同的输入跨导 $G_m$（通常由输入对的[偏置电流](@entry_id:260952)决定），折叠式结构需要额外的电流分支。如前所述，折叠电流源 $I_B$ 必须大于输入对单边[静态电流](@entry_id:275067)的一半 ($I_B = \alpha (I_{tail}/2)$，其中 $\alpha > 1$)。这意味着总的[静态电流](@entry_id:275067) $I_{total, fold} = I_{tail} + 2I_B = I_{tail} + \alpha I_{tail} = (1+\alpha)I_{tail}$。

对于一个同样[跨导](@entry_id:274251)的套筒式放大器，其总电流就是尾电流 $I_{tail}$。因此，折叠式拓扑的[功耗](@entry_id:264815)是套筒式的 $(1+\alpha)$ 倍 [@problem_id:1305067]。这个额外的功耗是为换取更宽的[输入共模范围](@entry_id:273151)和[输出摆幅](@entry_id:260991)所付出的代价。

#### 速度与[功耗](@entry_id:264815)的权衡

与所有放大器一样，折叠式[共源共栅放大器](@entry_id:273163)的性能也遵循基本的**速度-功耗权衡**。其[增益带宽积](@entry_id:266298)（Gain-Bandwidth Product, GBW）通常由输入[跨导](@entry_id:274251) $g_m$ 和负载电容 $C_L$ 决定，即 $GBW = g_m / C_L$。对于在[饱和区](@entry_id:262273)工作的 MOSFET，其[跨导](@entry_id:274251) $g_m$ 与其漏极电流 $I_D$ 的平方根成正比 ($g_m = \sqrt{2k'(W/L)I_D}$)。

由于输入管的电流 $I_D$ 是尾电流 $I_{TAIL}$ 的一半，而放大器的总功耗 $P_{diss}$ 又与 $I_{TAIL}$ 成正比，我们可以推导出 $g_m \propto \sqrt{I_{TAIL}} \propto \sqrt{P_{diss}}$。因此，[增益带宽积](@entry_id:266298)与功耗的平方根成正比：$GBW \propto \sqrt{P_{diss}}$。这意味着，若要将放大器的速度（GBW）提升一倍，需要将功耗增加到原来的四倍 [@problem_id:1305072]。这一基本关系是[模拟电路设计](@entry_id:270580)中无处不在的核心权衡法则，指导着设计师在速度、[功耗](@entry_id:264815)和性能之间做出合理的选择。