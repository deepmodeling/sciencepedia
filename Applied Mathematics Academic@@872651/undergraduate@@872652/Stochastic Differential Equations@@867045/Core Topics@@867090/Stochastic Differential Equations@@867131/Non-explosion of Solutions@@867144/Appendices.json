{"hands_on_practices": [{"introduction": "The Lyapunov function method is a cornerstone for proving the non-explosion of solutions to SDEs, particularly when coefficients do not satisfy simple growth conditions. This practice [@problem_id:3068503] demonstrates how a strongly confining drift term can tame a super-linear diffusion term to ensure a solution remains finite. By applying the infinitesimal generator $L$ to a quadratic Lyapunov function $V(x)$, you will derive a key inequality that rigorously proves the non-explosion of the process.", "problem": "Let $\\{W_{t}\\}_{t \\geq 0}$ be a one-dimensional standard Brownian motion and consider the one-dimensional stochastic differential equation (SDE) with deterministic initial condition $X_{0} = x_{0} \\in \\mathbb{R}$,\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}, \\quad \\text{where } b(x) = -x^{3} \\text{ and } \\sigma(x) = x^{2}.\n$$\nDefine the explosion time $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$, where $\\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$ is the exit time from the interval $(-R, R)$. Starting from the definitions of Itô diffusion, the infinitesimal generator constructed via Itô's formula, and the notion of a coercive $C^{2}$ Lyapunov function, derive a non-explosion criterion for the SDE above by bounding the generator applied to a suitable Lyapunov function. In particular, for the choice $V(x) = 1 + x^{2}$, determine the smallest nonnegative constant $c$ such that the inequality\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big) \\quad \\text{for all } x \\in \\mathbb{R}\n$$\nholds, where $L$ denotes the infinitesimal generator associated with the SDE. Use this bound to explain why $\\tau_{\\infty} = +\\infty$ almost surely, but report only the value of the smallest such $c$ as your final answer. Your final answer must be a single real number with no units. No rounding is required.", "solution": "The problem requires us to determine the smallest non-negative constant $c$ that satisfies a specific inequality involving the infinitesimal generator of a given stochastic differential equation (SDE), and to use this result to conclude that the solution does not explode.\n\nThe SDE is given by\n$$\n\\mathrm{d}X_{t} = b(X_{t})\\,\\mathrm{d}t + \\sigma(X_{t})\\,\\mathrm{d}W_{t}\n$$\nwith initial condition $X_{0} = x_{0} \\in \\mathbb{R}$, where $\\{W_{t}\\}_{t \\geq 0}$ is a one-dimensional standard Brownian motion. The drift and diffusion coefficients are $b(x) = -x^{3}$ and $\\sigma(x) = x^{2}$, respectively.\n\nFor a one-dimensional Itô diffusion and a function $f \\in C^{2}(\\mathbb{R})$, the infinitesimal generator $L$ is defined as:\n$$\nL f(x) = b(x) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} \\sigma(x)^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x)\n$$\nSubstituting the given coefficients, the generator for this SDE is:\n$$\nL f(x) = (-x^{3}) \\frac{\\mathrm{d}f}{\\mathrm{d}x}(x) + \\frac{1}{2} (x^{2})^{2} \\frac{\\mathrm{d}^{2}f}{\\mathrm{d}x^{2}}(x) = -x^{3} f'(x) + \\frac{1}{2} x^{4} f''(x)\n$$\n\nWe are given the specific Lyapunov function $V(x) = 1 + x^{2}$. This function is of class $C^{2}(\\mathbb{R})$. We compute its first and second derivatives:\n$$\nV'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(1 + x^{2}) = 2x\n$$\n$$\nV''(x) = \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(1 + x^{2}) = 2\n$$\nNow, we apply the generator $L$ to $V(x)$:\n$$\nL V(x) = -x^{3} V'(x) + \\frac{1}{2} x^{4} V''(x) = -x^{3}(2x) + \\frac{1}{2} x^{4}(2)\n$$\n$$\nL V(x) = -2x^{4} + x^{4} = -x^{4}\n$$\nThe problem asks for the smallest non-negative constant $c$ such that the following inequality holds for all $x \\in \\mathbb{R}$:\n$$\nL V(x) \\leq c\\big(1 + V(x)\\big)\n$$\nSubstituting the expressions for $L V(x)$ and $V(x)$:\n$$\n-x^{4} \\leq c\\big(1 + (1 + x^{2})\\big)\n$$\n$$\n-x^{4} \\leq c(2 + x^{2})\n$$\nSince $2 + x^{2}$ is strictly positive for all $x \\in \\mathbb{R}$, we can divide by it without altering the direction of the inequality:\n$$\n\\frac{-x^{4}}{2 + x^{2}} \\leq c\n$$\nThis inequality must hold for all $x \\in \\mathbb{R}$. Therefore, $c$ must be greater than or equal to the supremum of the function $g(x) = \\frac{-x^{4}}{2 + x^{2}}$ over $\\mathbb{R}$.\n$$\nc \\geq \\sup_{x \\in \\mathbb{R}} \\left( \\frac{-x^{4}}{2 + x^{2}} \\right)\n$$\nLet us analyze the function $g(x)$. The numerator $-x^{4}$ is non-positive for all $x$, and the denominator $2+x^{2}$ is strictly positive. Thus, $g(x) \\leq 0$ for all $x \\in \\mathbb{R}$. The maximum value is attained at $x=0$, where $g(0) = 0$. For any $x \\neq 0$, $g(x)$ is strictly negative.\nTherefore, the supremum is:\n$$\n\\sup_{x \\in \\mathbb{R}} g(x) = 0\n$$\nThe condition on $c$ becomes $c \\geq 0$. The problem asks for the smallest *non-negative* constant $c$ that satisfies this. The set of valid constants is $[0, \\infty)$. The smallest value in this set is $c=0$.\n\nTo explain why this implies the solution does not explode (i.e., $\\tau_{\\infty} = +\\infty$ almost surely), we use a standard argument based on this Lyapunov function. With $c=0$, the inequality is $LV(x) \\leq 0$. The function $V(x) = 1+x^2$ is a coercive function, meaning $V(x) \\to \\infty$ as $|x| \\to \\infty$.\n\nBy Itô's formula, for any stopping time $\\tau$:\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] = V(x_{0}) + \\mathbb{E}\\left[\\int_{0}^{t \\wedge \\tau} L V(X_{s}) \\, \\mathrm{d}s\\right]\n$$\nThe expectation of the stochastic integral term is zero under suitable conditions, which hold here for the stopped process.\nSince $L V(x) = -x^{4} \\leq 0$, the integral term is non-positive. Thus,\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau})] \\leq V(x_{0})\n$$\nLet $\\tau = \\tau_{R} = \\inf\\{t \\geq 0 : |X_{t}| \\geq R\\}$.\nOn the event $\\{\\tau_{R} \\leq t\\}$, we have $|X_{\\tau_R}| = R$, so $V(X_{\\tau_R}) = 1+R^2$. By the non-negativity of $V$, we can write:\n$$\n\\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\geq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = \\mathbb{E}[V(X_{\\tau_{R}}) \\cdot \\mathbf{1}_{\\{\\tau_{R} \\leq t\\}}] = (1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t)\n$$\nCombining the inequalities:\n$$\n(1+R^{2})\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\mathbb{E}[V(X_{t \\wedge \\tau_{R}})] \\leq V(x_{0}) = 1+x_{0}^{2}\n$$\nThis gives a bound on the probability of exiting the interval $(-R, R)$ by time $t$:\n$$\n\\mathbb{P}(\\tau_{R} \\leq t) \\leq \\frac{1+x_{0}^{2}}{1+R^{2}}\n$$\nTaking the limit as $R \\to \\infty$:\n$$\n\\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\nThe explosion time is $\\tau_{\\infty} = \\lim_{R \\to \\infty} \\tau_{R}$. The event that explosion occurs by time $t$ is $\\{\\tau_{\\infty} \\leq t\\} = \\bigcup_{R>0} \\{\\tau_{R} \\leq t\\}$. By continuity of probability on this nested sequence of events:\n$$\n\\mathbb{P}(\\tau_{\\infty} \\leq t) = \\lim_{R \\to \\infty} \\mathbb{P}(\\tau_{R} \\leq t) = 0\n$$\nThis holds for any finite $t  0$. The probability of explosion in finite time is $\\mathbb{P}(\\tau_{\\infty}  \\infty) = \\mathbb{P}\\left(\\bigcup_{n=1}^{\\infty} \\{\\tau_{\\infty} \\leq n\\}\\right) \\leq \\sum_{n=1}^{\\infty} \\mathbb{P}(\\tau_{\\infty} \\leq n) = \\sum_{n=1}^{\\infty} 0 = 0$.\nTherefore, $\\mathbb{P}(\\tau_{\\infty} = \\infty) = 1$, and the solution does not explode, almost surely. The smallest non-negative constant required to establish this is $c=0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3068503"}, {"introduction": "While Lyapunov functions are a general tool, the theory of one-dimensional diffusions offers a specialized and powerful alternative: Feller's test for boundary behavior. This practice [@problem_id:3068511] guides you through the calculation of the scale function and speed measure for a Brownian motion with constant drift. By analyzing whether these functions are integrable near infinity, you can definitively determine if the process can reach infinity in finite time, providing a clear-cut answer on the question of explosion.", "problem": "Consider the one-dimensional stochastic differential equation (SDE) on the entire real line $\\mathbb{R}$,\n$$\ndX_{t} \\;=\\; c\\,dt \\;+\\; \\sqrt{2\\lambda}\\,dW_{t},\n$$\nwhere $c \\neq 0$ and $\\lambda  0$ are constants, and $W_{t}$ is a standard Wiener process. Using the framework of one-dimensional diffusions—specifically the scale function, speed measure, and Feller’s test for explosions—derive the normalized scale function $s(x)$ for this diffusion, imposing the normalization conditions $s(0)=0$ and $s'(0)=1$. Then, using the scale and speed in Feller’s test, determine whether the solution can explode (reach $+\\infty$ or $-\\infty$) in finite time when started at any $X_{0} = x_{0} \\in \\mathbb{R}$.\n\nExpress your final answer as the normalized scale function $s(x)$ in closed form. No rounding is required. No units are needed.", "solution": "The given stochastic differential equation (SDE) is:\n$$\ndX_{t} = c\\,dt + \\sqrt{2\\lambda}\\,dW_{t}\n$$\nThis is a one-dimensional Itô diffusion of the general form $dX_{t} = b(X_t)dt + \\sigma(X_t)dW_{t}$. By comparison, we identify the drift coefficient $b(x)$ and the diffusion coefficient $\\sigma(x)$:\n$$\nb(x) = c\n$$\n$$\n\\sigma(x) = \\sqrt{2\\lambda}\n$$\nwhere $c$ and $\\lambda$ are constants with $c \\neq 0$ and $\\lambda  0$.\n\nFirst, we derive the normalized scale function $s(x)$. The scale function is defined as a twice-differentiable function that satisfies the second-order ordinary differential equation (ODE):\n$$\n\\frac{1}{2}\\sigma^2(x)s''(x) + b(x)s'(x) = 0\n$$\nSubstituting our specific coefficients $b(x)=c$ and $\\sigma^2(x) = (\\sqrt{2\\lambda})^2 = 2\\lambda$:\n$$\n\\frac{1}{2}(2\\lambda)s''(x) + cs'(x) = 0\n$$\n$$\n\\lambda s''(x) + cs'(x) = 0\n$$\nThis is a second-order linear homogeneous ODE with constant coefficients. Let $u(x) = s'(x)$. The equation becomes a first-order ODE for $u(x)$:\n$$\n\\lambda u'(x) + cu(x) = 0\n$$\nThis is a separable equation: $\\frac{du}{u} = -\\frac{c}{\\lambda}dx$. Integrating both sides yields:\n$$\n\\ln|u| = -\\frac{c}{\\lambda}x + C_1\n$$\n$$\nu(x) = A \\exp\\left(-\\frac{c}{\\lambda}x\\right)\n$$\nwhere $A = \\pm\\exp(C_1)$ is an arbitrary constant. So, we have $s'(x) = A \\exp\\left(-\\frac{c}{\\lambda}x\\right)$.\n\nWe are given the normalization condition $s'(0)=1$. Applying this condition:\n$$\ns'(0) = A \\exp(0) = A = 1\n$$\nThus, the derivative of the normalized scale function is:\n$$\ns'(x) = \\exp\\left(-\\frac{c}{\\lambda}x\\right)\n$$\nTo find $s(x)$, we integrate $s'(x)$ with respect to $x$:\n$$\ns(x) = \\int s'(x)dx = \\int \\exp\\left(-\\frac{c}{\\lambda}x\\right)dx = -\\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}x\\right) + B\n$$\nwhere $B$ is the constant of integration. We use the second normalization condition, $s(0)=0$:\n$$\ns(0) = -\\frac{\\lambda}{c}\\exp(0) + B = -\\frac{\\lambda}{c} + B = 0\n$$\nThis gives $B = \\frac{\\lambda}{c}$. Substituting $B$ back into the expression for $s(x)$, we obtain the normalized scale function:\n$$\ns(x) = \\frac{\\lambda}{c} - \\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}x\\right) = \\frac{\\lambda}{c}\\left(1 - \\exp\\left(-\\frac{c}{\\lambda}x\\right)\\right)\n$$\nThis completes the first part of the problem.\n\nNext, we use Feller's test for explosions to determine if the solution can reach $\\pm\\infty$ in finite time. A one-dimensional diffusion on an interval $(l, r)$ is non-explosive (i.e., it does not reach the boundaries $l$ or $r$ in finite time) if and only if the boundaries are inaccessible. For a boundary point $b$ (where $b$ is $l$ or $r$), inaccessibility is determined by two integrals involving the scale function derivative $s'(x)$ and the speed measure density $m(x)$. The speed measure density is given by:\n$$\nm(x) = \\frac{2}{\\sigma^2(x)s'(x)}\n$$\nFor our problem, this is:\n$$\nm(x) = \\frac{2}{(2\\lambda)\\exp\\left(-\\frac{c}{\\lambda}x\\right)} = \\frac{1}{\\lambda}\\exp\\left(\\frac{c}{\\lambda}x\\right)\n$$\nA boundary $b$ is inaccessible if for an arbitrary interior point $a \\in (l, r)$, at least one of the following integrals diverges:\n$$\nI_s(b) = \\int_a^b s'(y)dy \\quad \\text{or} \\quad I_m(b) = \\int_a^b m(y)dy\n$$\nAn explosion occurs only if a boundary is 'regular', which requires both integrals to be finite. We test the boundaries $r=+\\infty$ and $l=-\\infty$, choosing the interior point $a=0$. We must consider two cases based on the sign of $c$, since $\\lambda0$.\n\nCase 1: $c  0$\n-   Boundary at $+\\infty$:\n    $$\n    \\int_0^{+\\infty} s'(y)dy = \\int_0^{+\\infty} \\exp\\left(-\\frac{c}{\\lambda}y\\right)dy = \\left[-\\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}y\\right)\\right]_0^{+\\infty} = 0 - \\left(-\\frac{\\lambda}{c}\\right) = \\frac{\\lambda}{c}  \\infty\n    $$\n    $$\n    \\int_0^{+\\infty} m(y)dy = \\int_0^{+\\infty} \\frac{1}{\\lambda}\\exp\\left(\\frac{c}{\\lambda}y\\right)dy = \\left[\\frac{1}{\\lambda}\\frac{\\lambda}{c}\\exp\\left(\\frac{c}{\\lambda}y\\right)\\right]_0^{+\\infty} = \\frac{1}{c}(\\infty - 1) = \\infty\n    $$\n    Since $\\int_0^{+\\infty} m(y)dy = \\infty$, the boundary at $+\\infty$ is inaccessible.\n\n-   Boundary at $-\\infty$:\n    $$\n    \\int_{-\\infty}^0 s'(y)dy = \\int_{-\\infty}^0 \\exp\\left(-\\frac{c}{\\lambda}y\\right)dy = \\left[-\\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}y\\right)\\right]_{-\\infty}^0 = -\\frac{\\lambda}{c} - (-\\infty) = \\infty\n    $$\n    Since $\\int_{-\\infty}^0 s'(y)dy = \\infty$, the boundary at $-\\infty$ is inaccessible.\n\nCase 2: $c  0$\n-   Boundary at $+\\infty$:\n    $$\n    \\int_0^{+\\infty} s'(y)dy = \\int_0^{+\\infty} \\exp\\left(-\\frac{c}{\\lambda}y\\right)dy = \\left[-\\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}y\\right)\\right]_0^{+\\infty} = \\infty - \\left(-\\frac{\\lambda}{c}\\right) = \\infty\n    $$\n    (Note that since $c0$, the exponent $-c/\\lambda$ is positive). Since this integral diverges, the boundary at $+\\infty$ is inaccessible.\n\n-   Boundary at $-\\infty$:\n    $$\n    \\int_{-\\infty}^0 s'(y)dy = \\int_{-\\infty}^0 \\exp\\left(-\\frac{c}{\\lambda}y\\right)dy = \\left[-\\frac{\\lambda}{c}\\exp\\left(-\\frac{c}{\\lambda}y\\right)\\right]_{-\\infty}^0 = -\\frac{\\lambda}{c}(1-0) = -\\frac{\\lambda}{c}  \\infty\n    $$\n    (Since $c0$, the exponent $-c/\\lambda$ is positive, so the integrand approaches 0 as $y \\to -\\infty$).\n    $$\n    \\int_{-\\infty}^0 m(y)dy = \\int_{-\\infty}^0 \\frac{1}{\\lambda}\\exp\\left(\\frac{c}{\\lambda}y\\right)dy\n    $$\n    (Since $c0$, the exponent $c/\\lambda$ is negative, so the integrand approaches $\\infty$ as $y \\to -\\infty$). The integral diverges:\n    $$\n    \\int_{-\\infty}^0 m(y)dy = \\infty\n    $$\n    Since $\\int_{-\\infty}^0 m(y)dy = \\infty$, the boundary at $-\\infty$ is inaccessible.\n\nIn both cases, $c0$ and $c0$, both boundaries $+\\infty$ and $-\\infty$ are inaccessible. Therefore, the process $X_t$ does not explode; it remains finite for all finite time $t \\ge 0$, almost surely. This conclusion aligns with the known behavior of a Brownian motion with non-zero drift, which is a non-explosive process.\n\nThe problem asks for the normalized scale function $s(x)$ as the final answer.\n$$\ns(x) = \\frac{\\lambda}{c}\\left(1 - \\exp\\left(-\\frac{c}{\\lambda}x\\right)\\right)\n$$", "answer": "$$ \\boxed{\\frac{\\lambda}{c}\\left(1 - \\exp\\left(-\\frac{c}{\\lambda}x\\right)\\right)} $$", "id": "3068511"}, {"introduction": "Analytical proofs provide rigor, but numerical simulations offer invaluable intuition about the behavior of stochastic processes. This computational exercise [@problem_id:3068502] connects theory with practice by having you implement the Euler-Maruyama method to simulate paths of different SDEs. By observing whether paths tend to hit a large threshold, you will develop a practical understanding of why the linear growth condition is a critical benchmark for preventing explosive behavior.", "problem": "Consider the one-dimensional stochastic differential equation (SDE) defined on the time interval $[0,T]$,\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t,\\quad X_0 = x_0,\n$$\nwhere $W_t$ denotes a Brownian motion (also called a Wiener process), $b:\\mathbb{R}\\to\\mathbb{R}$ is the drift coefficient, and $\\sigma:\\mathbb{R}\\to\\mathbb{R}$ is the diffusion coefficient. A solution is said to explode if it becomes unbounded in finite time; more precisely, the explosion time is\n$$\n\\tau_e := \\inf\\{t\\ge 0:\\,|X_t|=+\\infty\\}.\n$$\nNon-explosion of solutions is a fundamental property studied via growth and regularity assumptions on $b$ and $\\sigma$. A classical sufficient condition for non-explosion is that $b$ and $\\sigma$ are locally Lipschitz and satisfy a linear growth bound of the form\n$$\n|b(x)| + |\\sigma(x)| \\le K(1+|x|)\n$$\nfor some constant $K0$ and all $x\\in\\mathbb{R}$. Under such conditions, strong solutions exist globally and do not explode.\n\nYour task is to implement a numerical sanity check using the Euler–Maruyama discretization to gain insight into non-explosion. For a given $b$ and $\\sigma$, simulate sample paths and compute the empirical probability that a path hits a large threshold before the terminal time. Hitting a large finite threshold is not the same as mathematical explosion, but numerically it provides a useful indicator of extreme growth. For each test case, do the following.\n\n1. Use the Euler–Maruyama scheme:\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n,\n$$\nwhere $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ are independent normally distributed increments, $\\Delta t$ is the time step, and $n$ indexes discrete time with $t_n=n\\,\\Delta t$.\n\n2. Define a large finite threshold $M0$. For each simulated path, declare a numerical threshold hit as soon as $|X_n|\\ge M$, and record whether this occurs before time $T$.\n\n3. Repeat across $N$ independent paths and compute the empirical hitting probability as a decimal (not a percentage), that is,\n$$\np := \\frac{\\text{number of paths that hit the threshold by time }T}{N}.\n$$\n\n4. Independently of simulation, evaluate whether the linear growth condition holds for the given parametric forms of $b$ and $\\sigma$. In this problem, the coefficients will be polynomials of the form\n$$\nb(x) = a\\,x^p,\\quad \\sigma(x) = c\\,x^q,\n$$\nwith real parameters $a$, $c$ and nonnegative exponents $p$, $q$. For these polynomial forms, a sufficient check for linear growth is that $p\\le 1$ and $q\\le 1$. Declare the boolean flag $\\text{LG}$ to be $1$ (True) if $p\\le 1$ and $q\\le 1$, and $0$ (False) otherwise. Note that polynomial coefficients are smooth, hence locally Lipschitz on $\\mathbb{R}$, so the linear growth check suffices to indicate the standard condition.\n\nImplement the program to run the following test suite of parameter values. Each test case is a tuple $(a,p,c,q,x_0,T,\\Delta t,M,N)$:\n\n- Test $1$ (stable Ornstein–Uhlenbeck-type coefficients): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (-1,1,1,0,0,2,0.005,100,2000)$. Here $b(x)=-1\\cdot x$, $\\sigma(x)=1$, $x_0=0$, $T=2$, $\\Delta t=0.005$, threshold $M=100$, and $N=2000$ paths.\n- Test $2$ (strong outward linear drift with small diffusion): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (3,1,0.1,0,1,2,0.005,100,2000)$.\n- Test $3$ (deterministic superlinear drift, zero diffusion; a known finite-time blow-up in the corresponding ordinary differential equation): $(a,p,c,q,x_0,T,\\Delta t,M,N) = (1,2,0,0,1,2,0.005,100,2000)$.\n\nFor each test case, output the pair $[p,\\text{LG}]$ where $p$ is the empirical hitting probability rounded to three decimal places and $\\text{LG}$ is the boolean flag as specified above. The final output must be a single line containing the results for all test cases as a comma-separated list enclosed in square brackets, for example, $[[p_1,\\text{LG}_1],[p_2,\\text{LG}_2],[p_3,\\text{LG}_3]]$.\n\nNo physical units are involved in this problem. Angles are not used. Probabilities must be expressed as decimals.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[p_1,\\text{LG}_1],[p_2,\\text{LG}_2],[p_3,\\text{LG}_3]]$).", "solution": "The problem requires us to analyze the behavior of solutions to a one-dimensional stochastic differential equation (SDE) with polynomial coefficients. We will perform two main tasks for each given test case: first, determine if the coefficients satisfy a theoretical sufficient condition for non-explosion (the linear growth condition), and second, perform a numerical simulation using the Euler-Maruyama method to estimate the probability of the solution path reaching a large magnitude.\n\nThe SDE under consideration is\n$$\n\\mathrm{d}X_t = b(X_t)\\,\\mathrm{d}t + \\sigma(X_t)\\,\\mathrm{d}W_t, \\quad X_0 = x_0\n$$\nwhere $b(x)$ is the drift coefficient and $\\sigma(x)$ is the diffusion coefficient. The coefficients are given in polynomial form:\n$$\nb(x) = a\\,x^p, \\quad \\sigma(x) = c\\,x^q\n$$\nwith parameters $a, c \\in \\mathbb{R}$ and non-negative exponents $p, q$.\n\n### Part 1: Linear Growth Condition ($\\text{LG}$ Flag)\n\nA standard sufficient condition for the existence of a unique, non-explosive global solution to the SDE requires the coefficients $b(x)$ and $\\sigma(x)$ to be locally Lipschitz and to satisfy the linear growth condition. The linear growth condition states that there exists a constant $K  0$ such that for all $x \\in \\mathbb{R}$:\n$$\n|b(x)| + |\\sigma(x)| \\le K(1 + |x|)\n$$\nFor the given polynomial forms, $b(x) = a\\,x^p$ and $\\sigma(x) = c\\,x^q$, this condition must be checked. The term $|x|$ on the right-hand side has a growth of order $1$. The terms on the left-hand side have growths of order $p$ and $q$, respectively. For the inequality to hold for all $x$, especially for large $|x|$, the growth on the left-hand side cannot be faster than the growth on the right-hand side. This implies that the exponents $p$ and $q$ must not be greater than $1$.\nTherefore, the linear growth condition is satisfied if and only if $p \\le 1$ and $q \\le 1$.\nThe problem specifies a boolean flag, $\\text{LG}$, which is set to $1$ (True) if this condition holds, and $0$ (False) otherwise.\n\nFor each test case, we evaluate $\\text{LG}$ as follows:\n- **Test 1**: $(a,p,c,q) = (-1,1,1,0)$. Here, $p=1$ and $q=0$. Since $p \\le 1$ and $q \\le 1$, the condition holds. Thus, $\\text{LG}=1$.\n- **Test 2**: $(a,p,c,q) = (3,1,0.1,0)$. Here, $p=1$ and $q=0$. Since $p \\le 1$ and $q \\le 1$, the condition holds. Thus, $\\text{LG}=1$.\n- **Test 3**: $(a,p,c,q) = (1,2,0,0)$. Here, $p=2$ and $q=0$. Since $p  1$, the condition is violated. Thus, $\\text{LG}=0$.\n\n### Part 2: Numerical Simulation (Empirical Hitting Probability $p$)\n\nWe use the Euler-Maruyama scheme to generate approximate sample paths of the SDE. The discretization is given by:\n$$\nX_{n+1} = X_n + b(X_n)\\,\\Delta t + \\sigma(X_n)\\,\\Delta W_n\n$$\nwhere $X_n$ is the state at time $t_n = n\\,\\Delta t$. The term $\\Delta W_n$ represents a Wiener process increment over the interval $[t_n, t_{n+1}]$, which is a normally distributed random variable with mean $0$ and variance $\\Delta t$. We can write $\\Delta W_n = Z_n \\sqrt{\\Delta t}$, where $Z_n \\sim \\mathcal{N}(0,1)$ are independent standard normal random variables. The update rule is then:\n$$\nX_{n+1} = X_n + (a X_n^p)\\,\\Delta t + (c X_n^q)\\sqrt{\\Delta t}\\,Z_n\n$$\nFor each test case, we simulate $N$ independent paths from $t=0$ to $t=T$. The number of time steps for each path is $N_{\\text{steps}} = \\text{int}(T/\\Delta t)$. For each path, we monitor if its magnitude $|X_n|$ ever meets or exceeds a large threshold $M$. If a path hits the threshold at any time $t_n \\le T$, we count it as a \"hit\". The simulation for that specific path is then stopped, as its fate regarding the threshold is determined.\n\nThe algorithm for a single test case is:\n1. Initialize parameters: $a, p, c, q, x_0, T, \\Delta t, M, N$.\n2. Initialize `hit_counter` to $0$.\n3. Loop $N$ times (for each path from $1$ to $N$):\n    a. Set the initial state $X = x_0$.\n    b. Loop $N_{\\text{steps}}$ times (for each time step):\n        i. Generate $Z \\sim \\mathcal{N}(0,1)$.\n        ii. Update the state: $X \\leftarrow X + (a X^p)\\Delta t + (c X^q)\\sqrt{\\Delta t}Z$.\n        iii. Check for threshold hit: If $|X| \\ge M$, increment `hit_counter` by $1$ and break the inner loop (proceed to the next path).\n4. After simulating all $N$ paths, calculate the empirical hitting probability: $p = \\frac{\\text{hit\\_counter}}{N}$.\n5. Round the result $p$ to three decimal places.\n\nThis procedure is applied to each of the three test cases.\n\n- **Test 1**: $b(x)=-x$, $\\sigma(x)=1$. This describes an Ornstein-Uhlenbeck process, which is mean-reverting towards $0$. Starting from $x_0=0$, the process is expected to remain bounded in a small neighborhood of $0$. A threshold of $M=100$ is exceptionally large for this process, so we expect the hitting probability $p$ to be very close to $0$.\n\n- **Test 2**: $b(x)=3x$, $\\sigma(x)=0.1$. The drift term is strongly positive and linear, pushing the solution away from the origin. The corresponding ODE $dx/dt = 3x$ has an exponentially growing solution $x(t) = x_0 e^{3t}$. With $x_0=1$, this deterministic part alone would reach $e^{3 \\times 2} = e^6 \\approx 403.4$ at $t=2$, far exceeding the threshold $M=100$. The small diffusion term adds noise but is unlikely to counteract this explosive trend. We expect a high hitting probability, $p \\approx 1$.\n\n- **Test 3**: $b(x)=x^2$, $\\sigma(x)=0$. This is a deterministic ODE, $\\mathrm{d}X_t/ \\mathrm{d}t = X_t^2$. With $x_0=1$, the analytical solution is $X_t = 1/(1-t)$, which has a finite-time blow-up at $t=1$. Since the simulation runs until $T=2$, it is certain that the trajectory will surpass any finite threshold $M$. The numerical scheme should capture this behavior, yielding a hitting probability of $p=1.0$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by iterating through test cases, calculating the linear\n    growth flag and simulating SDE paths to find the empirical hitting probability.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, p, c, q, x0, T, dt, M, N)\n    test_cases = [\n        (-1, 1, 1, 0, 0, 2, 0.005, 100, 2000),\n        (3, 1, 0.1, 0, 1, 2, 0.005, 100, 2000),\n        (1, 2, 0, 0, 1, 2, 0.005, 100, 2000),\n    ]\n\n    results = []\n    # Initialize a random number generator for reproducibility.\n    rng = np.random.default_rng(seed=42)\n\n    for case in test_cases:\n        a, p, c, q, x0, T, dt, M, N = case\n\n        # Part 1: Evaluate the linear growth (LG) condition\n        # The condition holds if p = 1 and q = 1.\n        lg_flag = 1 if p = 1 and q = 1 else 0\n\n        # Part 2: Run the Euler-Maruyama simulation\n        num_steps = int(T / dt)\n        sqrt_dt = np.sqrt(dt)\n        hit_count = 0\n\n        for _ in range(N):\n            X = float(x0)\n            \n            for _ in range(num_steps):\n                # Standard normal random variable for the Wiener increment\n                Z = rng.normal(0, 1)\n\n                # Calculate drift and diffusion terms\n                # Note: x**p is well-defined for all real x since p is an integer in all test cases.\n                b_X = a * (X**p)\n                sigma_X = c * (X**q)\n\n                # Update the state using the Euler-Maruyama step\n                X += b_X * dt + sigma_X * sqrt_dt * Z\n\n                # Check if the path has hit the threshold\n                if abs(X) >= M:\n                    hit_count += 1\n                    break  # Stop simulating this path as it has already hit\n\n        # Calculate and round the empirical hitting probability\n        hit_prob = hit_count / N\n        p_rounded = round(hit_prob, 3)\n\n        results.append([p_rounded, lg_flag])\n\n    # Format the final output string as specified: [[p1,LG1],[p2,LG2],...]\n    str_results = []\n    for res in results:\n        p_val, lg_val = res\n        # Format the probability to three decimal places as required by the problem.\n        str_results.append(f\"[{p_val:.3f},{lg_val}]\")\n    \n    final_output_string = f\"[{','.join(str_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "3068502"}]}