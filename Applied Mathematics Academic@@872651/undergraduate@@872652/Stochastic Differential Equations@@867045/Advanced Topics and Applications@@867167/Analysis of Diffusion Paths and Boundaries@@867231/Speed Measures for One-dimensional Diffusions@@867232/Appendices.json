{"hands_on_practices": [{"introduction": "The first step in mastering a new mathematical tool is to apply its definition to a fundamental case. This exercise reinforces the core mechanics of finding the scale and speed measures directly from a diffusion's infinitesimal generator. By solving the differential equation for the scale function and using the Sturm-Liouville representation, you will see how the drift and diffusion coefficients sculpt these crucial measures that govern the process's behavior [@problem_id:3074935].", "problem": "Consider the one-dimensional diffusion process governed by the stochastic differential equation (SDE) $dX_{t}=\\alpha X_{t}\\,dt+\\sigma\\,dW_{t}$ on the entire real line $\\mathbb{R}$, where $\\alpha\\in\\mathbb{R}$ and $\\sigma0$ are constants, and $W_{t}$ is a standard Brownian motion. Let $\\mathcal{L}$ denote the infinitesimal generator of this diffusion acting on twice continuously differentiable functions $f\\in C^{2}(\\mathbb{R})$. A scale function $s$ is a strictly increasing function with $s\\in C^{2}(\\mathbb{R})$ that satisfies $\\mathcal{L}s=0$. The speed measure $m$ is the unique positive measure (up to a multiplicative constant fixed by the choice of scale) such that the generator can be written in Sturm–Liouville form as $\\mathcal{L}f=\\frac{d}{dm}\\left(\\frac{d}{ds}f\\right)$ for all $f\\in C_{c}^{2}(\\mathbb{R})$, where $\\frac{d}{ds}f=\\frac{f'(x)}{s'(x)}$ and $\\frac{d}{dm}g=\\frac{1}{m'(x)}\\frac{d}{dx}g(x)$ when $m$ has a density $m'(x)$ with respect to the Lebesgue measure.\n\nUsing only these foundational definitions and the generator associated with the given SDE, derive explicit expressions for the derivative of the scale function $s'(x)$ and the speed density $m'(x)$ (the density of $m$ with respect to the Lebesgue measure), under the normalization $s'(0)=1$. Express your final answer as a pair $\\big(s'(x),\\,m'(x)\\big)$ in closed form.", "solution": "The problem is valid as it is scientifically grounded in the theory of stochastic differential equations, well-posed with sufficient and consistent information, and objectively formulated.\n\nThe one-dimensional diffusion process is described by the stochastic differential equation (SDE):\n$$dX_{t} = \\alpha X_{t}\\,dt + \\sigma\\,dW_{t}$$\nThis is an Itô process of the form $dX_t = \\mu(X_t)dt + \\sigma(X_t)dW_t$, with a drift coefficient $\\mu(x) = \\alpha x$ and a constant diffusion coefficient $\\sigma(x) = \\sigma$.\n\nThe infinitesimal generator $\\mathcal{L}$ of this diffusion process, acting on a function $f \\in C^{2}(\\mathbb{R})$, is given by the general formula:\n$$\\mathcal{L}f(x) = \\mu(x)f'(x) + \\frac{1}{2}\\sigma(x)^{2}f''(x)$$\nSubstituting the specific drift and diffusion coefficients yields:\n$$\\mathcal{L}f(x) = \\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x)$$\n\nThe first step is to find the scale function $s(x)$. The problem defines a scale function as a strictly increasing function $s \\in C^{2}(\\mathbb{R})$ that satisfies the equation $\\mathcal{L}s = 0$. Applying the generator $\\mathcal{L}$ to the scale function $s(x)$, we obtain a second-order ordinary differential equation (ODE):\n$$\\mathcal{L}s(x) = \\alpha x s'(x) + \\frac{\\sigma^2}{2} s''(x) = 0$$\nLet $u(x) = s'(x)$. Then $s''(x) = u'(x)$, and the ODE becomes a first-order linear ODE for $u(x)$:\n$$\\frac{\\sigma^2}{2} u'(x) + \\alpha x u(x) = 0$$\nThis is a separable equation:\n$$\\frac{\\sigma^2}{2} \\frac{du}{dx} = -\\alpha x u$$\n$$\\frac{du}{u} = -\\frac{2\\alpha x}{\\sigma^2} dx$$\nIntegrating both sides gives:\n$$\\int \\frac{1}{u} du = \\int -\\frac{2\\alpha x}{\\sigma^2} dx$$\n$$\\ln|u(x)| = -\\frac{2\\alpha}{\\sigma^2} \\frac{x^2}{2} + C_0 = -\\frac{\\alpha x^2}{\\sigma^2} + C_0$$\nwhere $C_0$ is the constant of integration. Exponentiating both sides, we get:\n$$|u(x)| = \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2} + C_0\\right) = e^{C_0} \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\nThis implies $u(x) = C \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$, where $C = \\pm e^{C_0}$ is an arbitrary non-zero constant. Since $u(x) = s'(x)$ and the scale function $s(x)$ must be strictly increasing, we must have $s'(x) > 0$ for all $x \\in \\mathbb{R}$. The exponential term is always positive, so we require $C > 0$.\nThe problem provides a normalization condition $s'(0) = 1$. We apply this to find the constant $C$:\n$$s'(0) = C \\exp\\left(-\\frac{\\alpha(0)^2}{\\sigma^2}\\right) = C \\exp(0) = C$$\nThus, $C = 1$. The derivative of the scale function is:\n$$s'(x) = \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\n\nThe second step is to find the speed density $m'(x)$. The problem states that the generator can be written in the Sturm-Liouville form $\\mathcal{L}f = \\frac{d}{dm}\\left(\\frac{d}{ds}f\\right)$. The definitions provided are $\\frac{d}{ds}f = \\frac{f'(x)}{s'(x)}$ and, for a measure with density $m'(x)$, $\\frac{d}{dm}g = \\frac{1}{m'(x)}\\frac{d}{dx}g(x)$.\nSubstituting these into the Sturm-Liouville form, we get:\n$$\\mathcal{L}f(x) = \\frac{1}{m'(x)} \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\nWe now have two expressions for $\\mathcal{L}f(x)$. Equating them gives:\n$$\\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x) = \\frac{1}{m'(x)} \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\nTo find $m'(x)$, we can rearrange this equation:\n$$m'(x)\\left(\\alpha x f'(x) + \\frac{\\sigma^2}{2} f''(x)\\right) = \\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right)$$\nUsing the quotient rule on the right-hand side:\n$$\\frac{d}{dx}\\left(\\frac{f'(x)}{s'(x)}\\right) = \\frac{f''(x)s'(x) - f'(x)s''(x)}{[s'(x)]^2} = \\frac{f''(x)}{s'(x)} - \\frac{s''(x)}{[s'(x)]^2}f'(x)$$\nSubstituting this back into the equation:\n$$m'(x)\\alpha x f'(x) + m'(x)\\frac{\\sigma^2}{2} f''(x) = \\frac{1}{s'(x)}f''(x) - \\frac{s''(x)}{[s'(x)]^2}f'(x)$$\nThis equality must hold for any function $f \\in C_c^2(\\mathbb{R})$. This implies that the coefficients of $f'(x)$ and $f''(x)$ on both sides of the equation must be equal.\n\nEquating the coefficients of $f''(x)$:\n$$m'(x)\\frac{\\sigma^2}{2} = \\frac{1}{s'(x)}$$\nSolving for $m'(x)$ directly gives the speed density in terms of the derivative of the scale function:\n$$m'(x) = \\frac{2}{\\sigma^2 s'(x)}$$\nAs a consistency check, we can equate the coefficients of $f'(x)$:\n$$m'(x)\\alpha x = -\\frac{s''(x)}{[s'(x)]^2}$$\nSubstituting $m'(x) = \\frac{2}{\\sigma^2 s'(x)}$ into this equation gives:\n$$\\frac{2\\alpha x}{\\sigma^2 s'(x)} = -\\frac{s''(x)}{[s'(x)]^2}$$\nMultiplying by $[s'(x)]^2$ yields:\n$$\\frac{2\\alpha x}{\\sigma^2} s'(x) = -s''(x)$$\n$$\\frac{\\sigma^2}{2} s''(x) + \\alpha x s'(x) = 0$$\nThis is precisely the ODE for $s'(x)$ that we solved earlier, confirming the consistency of our derivation.\n\nFinally, we substitute the expression for $s'(x)$ into the formula for $m'(x)$:\n$$m'(x) = \\frac{2}{\\sigma^2 s'(x)} = \\frac{2}{\\sigma^2 \\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right)}$$\n$$m'(x) = \\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\alpha x^2}{\\sigma^2}\\right)$$\nThe required pair is composed of the derivative of the scale function, $s'(x)$, and the speed density, $m'(x)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\ns'(x), m'(x)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\exp\\left(-\\frac{\\alpha x^2}{\\sigma^2}\\right),  \\frac{2}{\\sigma^2} \\exp\\left(\\frac{\\alpha x^2}{\\sigma^2}\\right)\n\\end{pmatrix}\n}\n$$", "id": "3074935"}, {"introduction": "With the ability to calculate scale and speed measures, we can now move to interpretation: what do these functions actually tell us about a diffusion? This practice contrasts simple Brownian motion with the widely used Geometric Brownian Motion and Cox-Ingersoll-Ross models to explore how state-dependent noise fundamentally alters the process's long-term spatial behavior [@problem_id:3074956]. By analyzing the form of the speed density $m'(x)$, you will gain intuition for how it acts as a weighting function, revealing where the process is expected to spend most of its time.", "problem": "Consider one-dimensional Itô diffusions on an interval with absorbing or reflecting boundaries, described by the stochastic differential equation $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$, where $b(x)$ is the drift, $\\sigma(x)$ is the diffusion coefficient, and $W_t$ is standard Brownian Motion. The infinitesimal generator and the forward equation determine the scale function and speed measure, which together encode how the diffusion moves spatially and how time is weighted locally. Using only core definitions of the generator, scale function, and speed measure for one-dimensional diffusions, analyze how the presence of multiplicative noise modifies the speed measure relative to constant-noise diffusions. In particular, examine Geometric Brownian Motion (GBM), defined by $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$ on $(0,\\infty)$, and the Cox–Ingersoll–Ross (CIR) process, defined by $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ on $[0,\\infty)$. Identify the correct statement(s) below about the functional form of the speed measure density $m'(x)$ (up to proportionality constants) and the interpretation of the spatial weighting that $m'(x)$ induces, in comparison with constant-noise diffusions.\n\nA. For Geometric Brownian Motion (GBM) with $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$ on $(0,\\infty)$, the speed measure density is $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$. For constant-noise Brownian Motion with zero drift $dY_t = \\sigma\\,dW_t$, the speed measure density is spatially uniform. Interpretation: multiplicative noise in GBM introduces a power-law spatial weighting that down-weights large $x$ unless $\\mu$ is sufficiently large relative to $\\sigma^2$, and up-weights large $x$ when $(2\\mu/\\sigma^2) - 2 > 0$.\n\nB. Multiplicative noise does not affect the speed measure: both Geometric Brownian Motion (GBM) and Cox–Ingersoll–Ross (CIR) have spatially uniform $m'(x)$, identical to constant-noise diffusions.\n\nC. For the Cox–Ingersoll–Ross (CIR) process with $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ on $[0,\\infty)$, the speed measure density is $m'(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1}\\,e^{-(2\\kappa/\\sigma^2)x}$. Interpretation: multiplicative square-root noise creates a polynomial factor that increases weighting near $0$ when $2\\kappa\\theta/\\sigma^2  1$ and decreases it when $2\\kappa\\theta/\\sigma^2  1$, while the exponential factor reflects mean reversion away from large $x$.\n\nD. In the Cox–Ingersoll–Ross (CIR) process, the speed measure density is $m'(x) \\propto e^{+(2\\kappa/\\sigma^2)x}$, showing heavier weighting at large $x$ due to multiplicative noise; near $x=0$ there is no special weighting.\n\nE. The speed measure coincides with the stationary distribution density. Therefore Geometric Brownian Motion (GBM) has lognormal $m'(x)$ and Cox–Ingersoll–Ross (CIR) has a Gamma $m'(x)$.\n\nSelect all correct options.", "solution": "The problem statement is first validated for scientific soundness, self-consistency, and clarity.\n\n**Step 1: Extract Givens**\n-   The general form of the one-dimensional Itô diffusion is $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$.\n-   $b(x)$ is the drift coefficient.\n-   $\\sigma(x)$ is the diffusion coefficient.\n-   $W_t$ is a standard Wiener process (Brownian Motion).\n-   The task concerns the scale function and speed measure, which are determined by the infinitesimal generator and forward equation.\n-   Specific processes to analyze are:\n    1.  Geometric Brownian Motion (GBM) on $(0,\\infty)$: $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$.\n    2.  Cox–Ingersoll–Ross (CIR) process on $[0,\\infty)$: $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$.\n-   The question asks for the functional form of the speed measure density, $m'(x)$, and its interpretation in comparison to constant-noise diffusions.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientific Grounding**: The problem is grounded in the established mathematical theory of stochastic differential equations. The concepts of drift, diffusion, generator, scale function, and speed measure are standard for one-dimensional diffusions. GBM and CIR are canonical, well-studied models. This is scientifically sound.\n-   **Well-Posedness**: The problem is well-posed. Given the drift $b(x)$ and diffusion $\\sigma(x)$, the scale function and speed measure are uniquely defined up to proportionality constants, allowing for a definite solution.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language.\n-   **Completeness and Consistency**: The problem statement is self-contained for an expert in the field. It relies on the standard definitions of the scale function and speed measure, which are assumed known. The definitions are consistent and sufficient to solve the problem.\n    -   Scale function density: $s'(x) \\propto \\exp\\left(-\\int \\frac{2b(y)}{\\sigma(y)^2} dy\\right)$.\n    -   Speed measure density: $m'(x) = \\frac{2}{\\sigma(x)^2 s'(x)}$.\n-   No other flaws from the validation checklist are present.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. The solution will be derived by applying the core definitions to the specified stochastic processes.\n\n**Derivation**\n\nFor a general one-dimensional Itô diffusion $dX_t = b(X_t)\\,dt + \\sigma(X_t)\\,dW_t$, the scale function density $s'(x)$ and the speed measure density $m'(x)$ are defined (up to proportionality constants) as follows. The scale density $s'(x)$ is given by:\n$$\ns'(x) \\propto \\exp\\left( - \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy \\right)\n$$\nThe speed measure density $m'(x)$ is then defined in terms of the scale density and the diffusion coefficient:\n$$\nm'(x) = \\frac{2}{\\sigma(x)^2 s'(x)}\n$$\nThe speed measure density is proportional to the stationary distribution of the process, should one exist. It describes the long-term average time the process spends in an infinitesimal neighborhood of a point $x$.\n\n**Case 1: Constant-Noise Brownian Motion (Reference Case)**\nFor a process $dY_t = \\sigma\\,dW_t$, we have drift $b(y)=0$ and diffusion $\\sigma(y)=\\sigma$ (a constant).\nThe scale density is:\n$$\ns'(x) \\propto \\exp\\left( - \\int^x \\frac{2 \\cdot 0}{\\sigma^2} dy \\right) = \\exp(0) = 1\n$$\nThe speed measure density is:\n$$\nm'(x) \\propto \\frac{1}{\\sigma^2 s'(x)} = \\frac{1}{\\sigma^2 \\cdot 1} = \\frac{1}{\\sigma^2}\n$$\nThus, $m'(x) \\propto 1$, meaning the speed measure density is spatially uniform.\n\n**Case 2: Geometric Brownian Motion (GBM)**\nFor GBM, $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$, we have drift $b(x) = \\mu x$ and diffusion $\\sigma(x) = \\sigma x$.\nThe integral in the scale density expression is:\n$$\n- \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy = - \\int^x \\frac{2\\mu y}{(\\sigma y)^2} dy = - \\int^x \\frac{2\\mu}{\\sigma^2 y} dy = -\\frac{2\\mu}{\\sigma^2} \\ln(x) = \\ln\\left(x^{-2\\mu/\\sigma^2}\\right)\n$$\nSo, the scale density is $s'(x) \\propto x^{-2\\mu/\\sigma^2}$.\nThe speed measure density is:\n$$\nm'(x) \\propto \\frac{1}{\\sigma(x)^2 s'(x)} \\propto \\frac{1}{(\\sigma x)^2 \\cdot x^{-2\\mu/\\sigma^2}} = \\frac{1}{\\sigma^2 x^2 \\cdot x^{-2\\mu/\\sigma^2}} = \\frac{1}{\\sigma^2} x^{(2\\mu/\\sigma^2) - 2}\n$$\nTherefore, for GBM, $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$.\n\n**Case 3: Cox–Ingersoll–Ross (CIR) Process**\nFor the CIR process, $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$, we have drift $b(x) = \\kappa(\\theta - x)$ and diffusion $\\sigma(x) = \\sigma\\sqrt{x}$.\nThe integral in the scale density expression is:\n$$\n- \\int^x \\frac{2b(y)}{\\sigma(y)^2} dy = - \\int^x \\frac{2\\kappa(\\theta - y)}{(\\sigma \\sqrt{y})^2} dy = - \\frac{2\\kappa}{\\sigma^2} \\int^x \\left(\\frac{\\theta}{y} - 1\\right) dy\n$$\n$$\n= - \\frac{2\\kappa}{\\sigma^2} \\left( \\theta\\ln(x) - x \\right) = \\frac{2\\kappa}{\\sigma^2}x - \\frac{2\\kappa\\theta}{\\sigma^2}\\ln(x) = \\ln\\left(e^{(2\\kappa/\\sigma^2)x}\\right) + \\ln\\left(x^{-2\\kappa\\theta/\\sigma^2}\\right)\n$$\nSo, the scale density is $s'(x) \\propto x^{-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}$.\nThe speed measure density is:\n$$\nm'(x) \\propto \\frac{1}{\\sigma(x)^2 s'(x)} \\propto \\frac{1}{(\\sigma\\sqrt{x})^2 \\cdot s'(x)} = \\frac{1}{\\sigma^2 x \\cdot x^{-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}}\n$$\n$$\n= \\frac{1}{\\sigma^2} \\frac{1}{x^{1-2\\kappa\\theta/\\sigma^2} e^{(2\\kappa/\\sigma^2)x}} = \\frac{1}{\\sigma^2} x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}\n$$\nTherefore, for the CIR process, $m'(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$. This is the density kernel of a Gamma distribution.\n\n**Option-by-Option Analysis**\n\nA. For Geometric Brownian Motion (GBM) with $dX_t = \\mu X_t\\,dt + \\sigma X_t\\,dW_t$ on $(0,\\infty)$, the speed measure density is $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$. For constant-noise Brownian Motion with zero drift $dY_t = \\sigma\\,dW_t$, the speed measure density is spatially uniform. Interpretation: multiplicative noise in GBM introduces a power-law spatial weighting that down-weights large $x$ unless $\\mu$ is sufficiently large relative to $\\sigma^2$, and up-weights large $x$ when $(2\\mu/\\sigma^2) - 2 > 0$.\n- The derived formula for GBM is $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$. This matches.\n- The derived formula for constant-noise BM is $m'(x) \\propto 1$, which is spatially uniform. This matches.\n- The interpretation is based on the sign of the exponent $(2\\mu/\\sigma^2) - 2$. If the exponent is negative, $m'(x)$ decreases for large $x$ (down-weighting). If it is positive, $m'(x)$ increases for large $x$ (up-weighting). The condition for up-weighting is precisely $(2\\mu/\\sigma^2) - 2 > 0$. This interpretation is correct.\n- **Verdict: Correct.**\n\nB. Multiplicative noise does not affect the speed measure: both Geometric Brownian Motion (GBM) and Cox–Ingersoll–Ross (CIR) have spatially uniform $m'(x)$, identical to constant-noise diffusions.\n- Our derivations show that the speed measures for both GBM and CIR are functions of $x$ and are not spatially uniform. For GBM, $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$. For CIR, $m'(x) \\propto x^{(\\dots)}e^{-(\\dots)x}$. This statement is patently false.\n- **Verdict: Incorrect.**\n\nC. For the Cox–Ingersoll–Ross (CIR) process with $dX_t = \\kappa(\\theta - X_t)\\,dt + \\sigma \\sqrt{X_t}\\,dW_t$ on $[0,\\infty)$, the speed measure density is $m'(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1}\\,e^{-(2\\kappa/\\sigma^2)x}$. Interpretation: multiplicative square-root noise creates a polynomial factor that increases weighting near $0$ when $2\\kappa\\theta/\\sigma^2  1$ and decreases it when $2\\kappa\\theta/\\sigma^2  1$, while the exponential factor reflects mean reversion away from large $x$.\n- The derived formula for the CIR speed measure is $m'(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$. This matches.\n- The interpretation of the polynomial term $x^{(2\\kappa\\theta/\\sigma^2) - 1}$ near $x = 0$: if the exponent $(2\\kappa\\theta/\\sigma^2) - 1  0$ (i.e., $2\\kappa\\theta/\\sigma^2  1$), then $m'(x) \\to \\infty$ as $x \\to 0^+$, indicating high weighting near the origin. If the exponent is positive (i.e., $2\\kappa\\theta/\\sigma^2 > 1$), then $m'(x) \\to 0$ as $x \\to 0^+$, indicating low weighting. This is correct.\n- The exponential factor $e^{-(2\\kappa/\\sigma^2)x}$ causes rapid decay for large $x$, which keeps the process from diverging to infinity. This is a consequence of the mean-reverting drift $b(x) = \\kappa(\\theta-x)$, which pulls the process back towards $\\theta$. The interpretation is correct.\n- **Verdict: Correct.**\n\nD. In the Cox–Ingersoll–Ross (CIR) process, the speed measure density is $m'(x) \\propto e^{+(2\\kappa/\\sigma^2)x}$, showing heavier weighting at large $x$ due to multiplicative noise; near $x=0$ there is no special weighting.\n- The derived formula is $m'(x) \\propto x^{(2\\kappa\\theta/\\sigma^2) - 1} e^{-(2\\kappa/\\sigma^2)x}$. The option presents an incorrect functional form (wrong sign in the exponent, missing polynomial factor). This leads to a completely wrong interpretation.\n- **Verdict: Incorrect.**\n\nE. The speed measure coincides with the stationary distribution density. Therefore Geometric Brownian Motion (GBM) has lognormal $m'(x)$ and Cox–Ingersoll–Ross (CIR) has a Gamma $m'(x)$.\n- The statement that the speed measure *coincides* with the stationary distribution density is imprecise; they are *proportional*, $m'(x) \\propto \\pi(x)$, and the stationary density $\\pi(x)$ must be normalizable, which is not a requirement for $m'(x)$.\n- The claim that the speed measure for GBM is lognormal is false. Our derivation shows $m'(x) \\propto x^{(2\\mu/\\sigma^2) - 2}$, which is a power-law form. The distribution of $X_t$ at a fixed time $t$ is lognormal, but this is distinct from the speed measure or the stationary distribution.\n- The claim that the CIR speed measure has a Gamma form is correct, as shown by our derivation.\n- However, since the initial premise is imprecise and the conclusion about GBM is incorrect, the entire statement is flawed.\n- **Verdict: Incorrect.**", "answer": "$$\\boxed{AC}$$", "id": "3074956"}, {"introduction": "This final practice showcases one of the most powerful applications of the speed measure: calculating the mean first exit time from an interval. This quantity is critical in applications ranging from finance to physics, and its calculation elegantly unifies the concepts of the scale function and speed measure via a Green's function representation [@problem_id:3074929]. This exercise will guide you through both the theoretical derivation for the Ornstein-Uhlenbeck process and the practical steps of building a numerical tool to compute this expectation, bridging the gap between abstract theory and computational practice.", "problem": "Consider the Ornstein–Uhlenbeck (OU) one-dimensional diffusion defined by the stochastic differential equation (SDE) $dX_t = -\\theta X_t \\, dt + \\sigma \\, dW_t$ with parameters $\\theta > 0$ and $\\sigma > 0$, where $W_t$ is a standard Brownian motion. Fix a finite open interval $(a,b)$ with $a  b$, and define the first exit time $\\tau_{a,b} = \\inf\\{ t \\ge 0 : X_t \\notin (a,b) \\}$ for the OU process starting at $X_0 = x \\in (a,b)$.\n\nStarting only from the foundational definitions and facts of one-dimensional diffusions:\n- The infinitesimal generator $L$ acts on twice continuously differentiable functions $f$ as $L f(x) = \\frac{1}{2}\\sigma^2 f''(x) + \\mu(x) f'(x)$, where $\\mu(x)$ is the drift.\n- The scale density $p(x)$ is defined by $p(x) = \\exp\\!\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right)$.\n- The speed density $m(x)$ is defined by $m(x) = \\frac{2}{\\sigma^2 p(x)}$.\n- The scale function $s(x)$ satisfies $s'(x) = p(x)$ and is determined up to an additive constant.\n\nTasks:\n1. For the OU process with drift $\\mu(x) = -\\theta x$ and constant diffusion coefficient $\\sigma$, derive the explicit forms of the scale density $p(x)$ and speed density $m(x)$. Then, construct a scale function $s(x)$ normalized so that $s(a) = 0$, and show that the expected exit time $\\mathbb{E}_x[\\tau_{a,b}]$ can be expressed as the integral of an appropriate Green function $G_{a,b}(x,y)$ against the speed density over $(a,b)$. Prove that $\\mathbb{E}_x[\\tau_{a,b}]$ is finite for all $x \\in (a,b)$.\n2. Implement a numerical computation of $\\mathbb{E}_x[\\tau_{a,b}]$ by integrating $G_{a,b}(x,y)$ against the explicit speed density $m(y)$ over $y \\in (a,b)$. In your computation, use the analytic expression for the OU scale function obtained from the scale density and normalize it so that $s(a) = 0$. Your algorithm should be stable and accurate on the provided inputs.\n3. Use your program to produce numerical values for $\\mathbb{E}_x[\\tau_{a,b}]$ for the following test suite of parameter sets, each given as $(\\theta,\\sigma,a,b,x)$:\n   - $(1.0, 1.0, -1.0, 1.0, 0.0)$\n   - $(2.0, 0.75, -2.0, 3.0, 1.0)$\n   - $(0.1, 1.5, -0.25, 0.25, 0.0)$\n   - $(5.0, 0.5, -0.5, 0.5, -0.49)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[result1,result2,result3,result4]\"). Each result must be a real number (float). No physical units are involved in this problem, and there are no angle quantities, so no unit specification is required beyond numerical values in standard real-number format.", "solution": "The user-provided problem is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   **Stochastic Differential Equation (SDE):** $dX_t = -\\theta X_t \\, dt + \\sigma \\, dW_t$, for an Ornstein–Uhlenbeck (OU) process.\n-   **Parameters:** $\\theta > 0$, $\\sigma > 0$.\n-   **Drift and Diffusion:** $\\mu(x) = -\\theta x$, diffusion coefficient is $\\sigma$.\n-   **Domain:** A finite open interval $(a,b)$ with $a  b$.\n-   **First Exit Time:** $\\tau_{a,b} = \\inf\\{ t \\ge 0 : X_t \\notin (a,b) \\}$.\n-   **Initial Condition:** $X_0 = x \\in (a,b)$.\n-   **Infinitesimal Generator:** For $f \\in C^2$, $L f(x) = \\frac{1}{2}\\sigma^2 f''(x) + \\mu(x) f'(x)$.\n-   **Scale Density:** $p(x) = \\exp\\!\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right)$.\n-   **Speed Density:** $m(x) = \\frac{2}{\\sigma^2 p(x)}$.\n-   **Scale Function:** $s(x)$ satisfies $s'(x) = p(x)$.\n-   **Normalization Condition:** $s(a) = 0$.\n-   **Tasks:**\n    1.  Derive explicit forms for $p(x)$ and $m(x)$ for the OU process. Construct the normalized scale function $s(x)$. Show that the expected exit time $\\mathbb{E}_x[\\tau_{a,b}]$ is given by an integral of a Green's function $G_{a,b}(x,y)$ against the speed density $m(y)$, and prove this expectation is finite.\n    2.  Implement a numerical method to compute $\\mathbb{E}_x[\\tau_{a,b}]$ using this integral formulation.\n    3.  Apply the implementation to a specific test suite of parameters $(\\theta,\\sigma,a,b,x)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically sound.\n-   **Scientifically Grounded:** The problem deals with the Ornstein-Uhlenbeck process, a cornerstone of stochastic calculus, and its first exit time, a classical problem in the field. The definitions provided for the generator, scale density, speed density, and scale function are standard in the theory of one-dimensional diffusions.\n-   **Well-Posed:** The problem of finding the mean first exit time is a well-posed boundary value problem. The conditions $\\theta > 0$, $\\sigma > 0$, and $x \\in (a,b)$ are physically and mathematically meaningful, ensuring a unique, finite solution.\n-   **Objective:** The problem is stated in precise, objective mathematical language, free from ambiguity or subjective assertions.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, missing information, or logical contradictions. It is a standard, albeit non-trivial, problem in applied mathematics that combines theoretical derivation with numerical implementation.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n---\n\nThe solution proceeds by first addressing the theoretical derivations, then outlining the numerical implementation strategy.\n\n**Task 1: Theoretical Derivation**\n\nFor the Ornstein-Uhlenbeck process, the drift is $\\mu(x) = -\\theta x$ and the diffusion coefficient is constant, $\\sigma$.\n\nFirst, we derive the scale density $p(x)$. Using the provided definition:\n$$\np(x) = \\exp\\left(-\\int^{x} \\frac{2\\mu(u)}{\\sigma^2} \\, du\\right) = \\exp\\left(-\\int^{x} \\frac{2(-\\theta u)}{\\sigma^2} \\, du\\right) = \\exp\\left(\\frac{2\\theta}{\\sigma^2}\\int^{x} u \\, du\\right)\n$$\nThe integral introduces an arbitrary constant of integration, which corresponds to a multiplicative constant for $p(x)$. We can set this constant to $1$ without loss of generality, as it will be absorbed into the scale function's definition. Choosing the lower limit of the integral to be $0$ yields:\n$$\np(x) = \\exp\\left(\\frac{\\theta x^2}{\\sigma^2}\\right)\n$$\nNext, we find the speed density $m(x)$ using its definition:\n$$\nm(x) = \\frac{2}{\\sigma^2 p(x)} = \\frac{2}{\\sigma^2} \\exp\\left(-\\frac{\\theta x^2}{\\sigma^2}\\right)\n$$\nThe scale function $s(x)$ is defined by $s'(x) = p(x)$, and must be normalized such that $s(a) = 0$. This determines $s(x)$ uniquely as the definite integral of $p(u)$:\n$$\ns(x) = \\int_a^x p(u) \\, du = \\int_a^x \\exp\\left(\\frac{\\theta u^2}{\\sigma^2}\\right) \\, du\n$$\nThe expected exit time, $v(x) = \\mathbb{E}_x[\\tau_{a,b}]$, is the solution to the following second-order ordinary differential equation, which is a boundary value problem (BVP):\n$$\nL v(x) = -1, \\quad x \\in (a,b)\n$$\nwith boundary conditions $v(a) = 0$ and $v(b) = 0$. The generator for the OU process is $L = -\\theta x \\frac{d}{dx} + \\frac{\\sigma^2}{2} \\frac{d^2}{dx^2}$.\n\nIt is a fundamental result in the theory of one-dimensional diffusions that the solution to this BVP is given by the integral of a Green's function against the speed density:\n$$\nv(x) = \\int_a^b G_{a,b}(x,y) m(y) \\, dy\n$$\nThe Green's function $G_{a,b}(x,y)$ for the operator associated with the exit time problem, under Dirichlet boundary conditions at $a$ and $b$, is given in terms of the scale function $s(x)$:\n$$\nG_{a,b}(x,y) = \\frac{(s(x \\wedge y) - s(a))(s(b) - s(x \\vee y))}{s(b) - s(a)}\n$$\nwhere $x \\wedge y = \\min(x,y)$ and $x \\vee y = \\max(x,y)$.\n\nApplying our normalization $s(a)=0$, the Green's function simplifies to:\n$$\nG_{a,b}(x,y) = \\frac{s(x \\wedge y)(s(b) - s(x \\vee y))}{s(b)}\n$$\nSubstituting this into the integral for $v(x)$ and splitting the integral at $x$ demonstrates the structure of the solution:\n$$\nv(x) = \\int_a^x G_{a,b}(x,y) m(y) \\, dy + \\int_x^b G_{a,b}(x,y) m(y) \\, dy\n$$\nFor $y \\in (a,x)$, $x \\wedge y = y$ and $x \\vee y = x$, so $G_{a,b}(x,y) = \\frac{s(y)(s(b)-s(x))}{s(b)}$.\nFor $y \\in (x,b)$, $x \\wedge y = x$ and $x \\vee y = y$, so $G_{a,b}(x,y) = \\frac{s(x)(s(b)-s(y))}{s(b)}$.\nThis gives the explicit integral expression:\n$$\nv(x) = \\frac{s(b)-s(x)}{s(b)} \\int_a^x s(y) m(y) \\, dy + \\frac{s(x)}{s(b)} \\int_x^b (s(b)-s(y)) m(y) \\, dy\n$$\nThis verifies the claim that the expected exit time can be expressed as the integral of the Green's function against the speed density.\n\nTo prove that $\\mathbb{E}_x[\\tau_{a,b}]$ is finite for all $x \\in (a,b)$, we examine the components of the integral.\n1.  The speed density $m(y) = \\frac{2}{\\sigma^2} \\exp\\left(-\\frac{\\theta y^2}{\\sigma^2}\\right)$ is a continuous and positive function on the finite interval $(a,b)$. It is therefore bounded.\n2.  The scale function $s(y) = \\int_a^y \\exp\\left(\\frac{\\theta u^2}{\\sigma^2}\\right) du$ is continuous and strictly increasing on $[a,b]$ since its derivative $p(y)$ is strictly positive.\n3.  Because $s(y)$ is continuous on $[a,b]$, it is bounded. Specifically, $s(a)=0$ and $s(b) = \\int_a^b p(u)du > 0$.\n4.  The Green's function $G_{a,b}(x,y)$ is therefore a bounded and continuous function of $y$ for any fixed $x \\in (a,b)$.\n5.  The total integrand, $G_{a,b}(x,y)m(y)$, is the product of two bounded, continuous functions over the finite interval $(a,b)$. The integral of such a function over a finite interval is necessarily finite.\nThus, $\\mathbb{E}_x[\\tau_{a,b}]$ is finite for all $x \\in (a,b)$.\n\n**Task 2  3: Numerical Implementation and Computation**\n\nTo numerically compute $\\mathbb{E}_x[\\tau_{a,b}]$, we will implement the derived integral formula. The main challenge is computing the scale function $s(x)$, which involves an integral with no elementary closed form.\n\nThe integral in $s(x)$ can be expressed using the imaginary error function, $\\text{erfi}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z e^{t^2} dt$.\nLet $\\alpha = \\sqrt{\\theta}/\\sigma$. Then we have:\n$$\ns(x) = \\int_a^x \\exp((\\alpha u)^2) \\, du\n$$\nWith a substitution $v = \\alpha u$ ($du = dv/\\alpha$):\n$$\ns(x) = \\frac{1}{\\alpha} \\int_{\\alpha a}^{\\alpha x} e^{v^2} \\, dv = \\frac{1}{\\alpha} \\left[ \\int_0^{\\alpha x} e^{v^2} \\, dv - \\int_0^{\\alpha a} e^{v^2} \\, dv \\right]\n$$\n$$\ns(x) = \\frac{1}{\\alpha} \\frac{\\sqrt{\\pi}}{2} \\left[ \\text{erfi}(\\alpha x) - \\text{erfi}(\\alpha a) \\right]\n$$\nThis analytical expression for $s(x)$ (in terms of a special function) will be used in the numerical code. `scipy.special.erfi` provides an accurate implementation.\nThe algorithm is as follows:\n1.  For a given set of parameters $(\\theta, \\sigma, a, b, x)$, define the functions for the scale $s(y)$ and speed density $m(y)$ using the derived formulas.\n2.  The two integrals, $I_1 = \\int_a^x s(y)m(y) \\, dy$ and $I_2 = \\int_x^b (s(b)-s(y))m(y) \\, dy$, are computed using a numerical quadrature routine (`scipy.integrate.quad`).\n3.  The final result is assembled using the formula $v(x) = \\frac{s(b)-s(x)}{s(b)}I_1 + \\frac{s(x)}{s(b)}I_2$.\n\nThis procedure is implemented in the Python code below to compute the results for the given test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfi\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the problem by calculating the expected first exit time for the\n    Ornstein-Uhlenbeck process for a given set of parameters.\n    \"\"\"\n    # The test suite of parameter sets (theta, sigma, a, b, x).\n    test_cases = [\n        (1.0, 1.0, -1.0, 1.0, 0.0),\n        (2.0, 0.75, -2.0, 3.0, 1.0),\n        (0.1, 1.5, -0.25, 0.25, 0.0),\n        (5.0, 0.5, -0.5, 0.5, -0.49),\n    ]\n\n    results = []\n    for params in test_cases:\n        theta, sigma, a, b, x = params\n        \n        # Define a factory for creating the required functions s(y) and m(y) for each case.\n        # This closure captures the parameters for a specific case.\n        def make_functions(theta, sigma, a):\n            \"\"\"\n            Creates the scale function s(y) and speed density m(y) for the given parameters.\n            \"\"\"\n            alpha = np.sqrt(theta) / sigma\n            \n            # The scale function s(y) is normalized such that s(a) = 0.\n            # s(y) = integral_a^y exp(theta*u^2/sigma^2) du\n            # Analytically, this is related to the imaginary error function (erfi).\n            sqrt_pi_half = np.sqrt(np.pi) / 2.0\n            pre_factor = sqrt_pi_half / alpha if alpha != 0 else 0\n            erfi_alpha_a = erfi(alpha * a) if alpha != 0 else 0\n\n            def scale_function(y):\n                if alpha == 0:\n                    # In the limit theta -> 0, the process is a scaled Brownian motion.\n                    # s(y) = y - a. This case is not in the test suite but is included for robustness.\n                    return y - a\n                return pre_factor * (erfi(alpha * y) - erfi_alpha_a)\n\n            # The speed density m(y).\n            # m(y) = (2 / sigma^2) * exp(-theta * y^2 / sigma^2)\n            sigma_sq = sigma**2\n            def speed_density(y):\n                return (2.0 / sigma_sq) * np.exp(-theta * y**2 / sigma_sq)\n\n            return scale_function, speed_density\n\n        s, m = make_functions(theta, sigma, a)\n\n        # Pre-compute the values of the scale function at key points.\n        s_x = s(x)\n        s_b = s(b)\n\n        # The expected exit time formula involves two integrals.\n        # v(x) = ((s(b)-s(x))/s(b)) * I1 + (s(x)/s(b)) * I2\n        # where I1 = integral from a to x of s(y)m(y) dy\n        # and I2 = integral from x to b of (s(b)-s(y))m(y) dy\n\n        # Define the integrands for the two parts of the formula.\n        def integrand1(y):\n            return s(y) * m(y)\n        \n        def integrand2(y):\n            return (s_b - s(y)) * m(y)\n\n        # Perform numerical integration using scipy.integrate.quad.\n        # quad returns a tuple (result, error_estimate). We only need the result.\n        integral1, _ = quad(integrand1, a, x)\n        integral2, _ = quad(integrand2, x, b)\n        \n        # If s_b is zero, it would imply a=b, which is ruled out by the problem statement.\n        # So we can safely divide by s_b.\n        if s_b == 0:\n            # This case should not be reached with valid inputs a  b and theta > 0.\n            # If it were, it could correspond to an infinite exit time.\n            # For this problem, we assume s_b is non-zero.\n            raise ValueError(\"s(b) is zero, cannot compute expectation.\")\n\n        expected_time = ((s_b - s_x) / s_b) * integral1 + (s_x / s_b) * integral2\n        results.append(expected_time)\n\n    # Print the results in the specified format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3074929"}]}