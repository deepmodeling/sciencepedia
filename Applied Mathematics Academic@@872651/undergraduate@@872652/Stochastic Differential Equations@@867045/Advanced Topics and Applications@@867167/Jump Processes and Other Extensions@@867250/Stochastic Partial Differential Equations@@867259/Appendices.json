{"hands_on_practices": [{"introduction": "Many fundamental physical laws are expressed as conservation laws, where a certain quantity like mass or momentum remains constant over time. This exercise explores how such laws are modified in the presence of random fluctuations. By analyzing the stochastic Burgers equation on a periodic domain, you will learn to distinguish between deterministic terms that merely redistribute a quantity and stochastic terms that can cause it to grow or decay, providing a key insight into the behavior of the system as a whole [@problem_id:2998293].", "problem": "Consider the one-dimensional stochastic Burgers equation on the periodic torus $\\mathbb{T}_{2\\pi} = \\mathbb{R}/(2\\pi \\mathbb{Z})$ with spatial coordinate $x \\in [0,2\\pi)$:\n$$\n\\mathrm{d}u(t,x) \\;=\\; \\Big(\\nu\\,\\partial_{xx} u(t,x) \\;-\\; \\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\Big)\\,\\mathrm{d}t \\;+\\; \\sigma\\,\\mathrm{d}\\beta_{0}(t) \\;+\\; \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t),\n$$\nwith periodic boundary conditions in $x$, where $\\nu0$, $\\sigma\\in\\mathbb{R}$, and $\\gamma\\in\\mathbb{R}$ are fixed constants, and $\\beta_{0}$ and $\\beta_{1}$ are independent standard Brownian motions. The symbol $\\circ$ denotes a Stratonovich stochastic integral. Assume $u$ is sufficiently regular so that all spatial integrations by parts and stochastic calculus manipulations are justified.\n\nDefine the spatial average (mean) of $u$ by\n$$\n\\bar{u}(t) \\;=\\; \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x.\n$$\n\nStarting only from the definitions of the spatial average, periodic boundary conditions, and the Itō–Stratonovich conversion rule for stochastic differential equations, derive the stochastic differential equation governing the time evolution of $\\bar{u}(t)$ and solve it explicitly. In your derivation, carefully separate deterministic conservative contributions from stochastic contributions and justify whether the spatial average is conserved or undergoes stochastic drift. Provide as your final result a single closed-form analytic expression for $\\bar{u}(t)$ in terms of $\\bar{u}(0)$, $\\sigma$, $\\gamma$, and the driving Brownian motions. No numerical evaluation is required, and no rounding is needed. Express the final answer without units.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique mathematical derivation. Therefore, we proceed with the solution.\n\nThe objective is to derive and solve the stochastic differential equation (SDE) for the spatial average of the solution $u(t,x)$, defined as\n$$\n\\bar{u}(t) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x.\n$$\nThe evolution of $u(t,x)$ is governed by the one-dimensional stochastic Burgers equation on the periodic torus $\\mathbb{T}_{2\\pi}$:\n$$\n\\mathrm{d}u(t,x) = \\left(\\nu\\,\\partial_{xx} u(t,x) - \\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\beta_{0}(t) + \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t).\n$$\nThe problem assumes sufficient regularity of the solution $u(t,x)$, which allows for the interchange of differentiation, spatial integration, and stochastic differentials. We can find the SDE for $\\bar{u}(t)$ by integrating the SPDE for $u(t,x)$ over the spatial domain $x \\in [0, 2\\pi)$ and dividing by the length of the domain, $2\\pi$.\n$$\n\\mathrm{d}\\bar{u}(t) = \\mathrm{d}\\left(\\frac{1}{2\\pi}\\int_{0}^{2\\pi} u(t,x)\\,\\mathrm{d}x\\right) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\mathrm{d}u(t,x)\\,\\mathrm{d}x.\n$$\nSubstituting the expression for $\\mathrm{d}u(t,x)$, we get:\n$$\n\\mathrm{d}\\bar{u}(t) = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} \\left[ \\left(\\nu\\,\\partial_{xx} u - \\tfrac{1}{2}\\,\\partial_{x}(u^{2})\\right)\\mathrm{d}t + \\sigma\\,\\mathrm{d}\\beta_{0}(t) + \\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}(t) \\right] \\mathrm{d}x.\n$$\nWe analyze the contribution of each term after integration.\n\n1.  **Deterministic Conservative Contributions**: The drift part of the SPDE consists of two terms, $\\nu\\,\\partial_{xx} u$ and $-\\tfrac{1}{2}\\,\\partial_{x}(u^2)$. Both can be expressed as the spatial derivative of a flux.\n    *   The integral of the diffusion term is:\n        $$\n        \\int_{0}^{2\\pi} \\nu\\,\\partial_{xx} u(t,x)\\,\\mathrm{d}x = \\nu \\int_{0}^{2\\pi} \\frac{\\partial}{\\partial x}\\left(\\partial_{x} u(t,x)\\right)\\,\\mathrm{d}x = \\nu \\left[ \\partial_{x} u(t,x) \\right]_{x=0}^{x=2\\pi}.\n        $$\n        Due to the periodic boundary conditions on $\\mathbb{T}_{2\\pi}$, the function $u(t,x)$ and its spatial derivatives must have the same value at $x=0$ and $x=2\\pi$. Thus, $\\partial_{x} u(t, 2\\pi) = \\partial_{x} u(t, 0)$, and the integral evaluates to $0$.\n    *   The integral of the nonlinear advection term is:\n        $$\n        \\int_{0}^{2\\pi} -\\tfrac{1}{2}\\,\\partial_{x}\\big(u(t,x)^{2}\\big)\\,\\mathrm{d}x = -\\frac{1}{2} \\left[ u(t,x)^{2} \\right]_{x=0}^{x=2\\pi}.\n        $$\n        Similarly, periodicity requires $u(t, 2\\pi) = u(t, 0)$, so this integral is also $0$.\n    These terms are conservative; they redistribute $u$ over the spatial domain but do not change its total integral. Consequently, they do not contribute to the time evolution of the spatial average $\\bar{u}(t)$.\n\n2.  **Stochastic Contributions**: There are two stochastic terms.\n    *   The first is an additive, spatially homogeneous noise term, $\\sigma\\,\\mathrm{d}\\beta_{0}(t)$. Its integral is:\n        $$\n        \\int_{0}^{2\\pi} \\sigma\\,\\mathrm{d}\\beta_{0}(t)\\,\\mathrm{d}x = \\sigma\\,\\mathrm{d}\\beta_{0}(t) \\int_{0}^{2\\pi} 1\\,\\mathrm{d}x = 2\\pi\\sigma\\,\\mathrm{d}\\beta_{0}(t).\n        $$\n        This is an Itō differential. It provides a non-zero contribution to $\\mathrm{d}\\bar{u}(t)$.\n    *   The second is a multiplicative noise term involving a Stratonovich integral, $\\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t)$. The key property of Stratonovich integrals is that they obey the rules of classical calculus. Interchanging the spatial integral and the stochastic integral gives:\n        $$\n        \\int_{0}^{2\\pi} \\gamma\\,\\partial_{x}u(t,x)\\,\\circ \\mathrm{d}\\beta_{1}(t)\\,\\mathrm{d}x = \\left(\\gamma \\int_{0}^{2\\pi} \\partial_{x}u(t,x)\\,\\mathrm{d}x \\right) \\circ \\mathrm{d}\\beta_{1}(t).\n        $$\n        The spatial integral is $\\int_{0}^{2\\pi} \\partial_{x}u(t,x)\\,\\mathrm{d}x = [u(t,x)]_{x=0}^{x=2\\pi} = u(t, 2\\pi) - u(t, 0) = 0$ due to periodicity. Thus, the entire term is $0 \\circ \\mathrm{d}\\beta_{1}(t) = 0$.\n\n        To explicitly use the Itō–Stratonovich conversion rule as requested, we convert the Stratonovich term to its Itō equivalent. The rule is $G(u) \\circ \\mathrm{d}\\beta = G(u)\\,\\mathrm{d}\\beta + \\frac{1}{2}\\langle \\mathrm{d}G(u), \\mathrm{d}\\beta \\rangle$. Here, $G(u) = \\gamma\\,\\partial_{x}u$, and the noise is $\\beta_{1}$. The quadratic covariation term requires finding the part of $\\mathrm{d}G(u)$ proportional to $\\mathrm{d}\\beta_{1}$.\n        $\\mathrm{d}G(u) = \\mathrm{d}(\\gamma\\,\\partial_{x}u) = \\gamma\\,\\partial_{x}(\\mathrm{d}u)$. The part of $\\mathrm{d}u$ proportional to $\\circ\\mathrm{d}\\beta_{1}$ is $\\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}$. Thus, the relevant part of $\\mathrm{d}G(u)$ is $\\gamma\\,\\partial_{x}(\\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}) = \\gamma^2\\,\\partial_{xx}u\\,\\circ \\mathrm{d}\\beta_{1}$. For calculating the Itō correction, we only need the coefficient of the stochastic differential, which is $\\gamma^2\\,\\partial_{xx}u$.\n        The Itō correction (or drift) term is $\\frac{1}{2}(\\gamma^2\\,\\partial_{xx}u)\\,\\mathrm{d}t$.\n        Therefore, the conversion is:\n        $$\n        \\gamma\\,\\partial_{x}u\\,\\circ \\mathrm{d}\\beta_{1}(t) = \\gamma\\,\\partial_{x}u\\,\\mathrm{d}\\beta_{1}(t) + \\frac{1}{2}\\gamma^{2}\\,\\partial_{xx}u\\,\\mathrm{d}t.\n        $$\n        Now, we integrate these two Itō terms over $[0, 2\\pi)$:\n        $$\n        \\int_{0}^{2\\pi} \\gamma\\,\\partial_{x}u\\,\\mathrm{d}\\beta_{1}(t)\\,\\mathrm{d}x = \\left(\\gamma\\int_{0}^{2\\pi} \\partial_{x}u\\,\\mathrm{d}x\\right)\\mathrm{d}\\beta_{1}(t) = \\gamma[u]_{0}^{2\\pi}\\,\\mathrm{d}\\beta_{1}(t) = 0.\n        $$\n        $$\n        \\int_{0}^{2\\pi} \\frac{1}{2}\\gamma^{2}\\,\\partial_{xx}u\\,\\mathrm{d}t\\,\\mathrm{d}x = \\left(\\frac{1}{2}\\gamma^{2}\\int_{0}^{2\\pi} \\partial_{xx}u\\,\\mathrm{d}x\\right)\\mathrm{d}t = \\frac{1}{2}\\gamma^{2}[\\partial_{x}u]_{0}^{2\\pi}\\,\\mathrm{d}t = 0.\n        $$\n        Both parts of the converted term integrate to zero. This confirms that the contribution of the multiplicative noise term to the evolution of the spatial average is zero. The spatial average is not conserved, but its non-conservation is not due to the terms with $\\nu$ or $\\gamma$. It undergoes a stochastic evolution driven purely by the spatially homogeneous forcing.\n\n3.  **Assembly and Solution of the SDE**:\n    Combining the results for all integrated terms and dividing by $2\\pi$:\n    $$\n    \\mathrm{d}\\bar{u}(t) = \\frac{1}{2\\pi} \\left[ (0 + 0)\\,\\mathrm{d}t + 2\\pi\\sigma\\,\\mathrm{d}\\beta_{0}(t) + 0 \\right] = \\sigma\\,\\mathrm{d}\\beta_{0}(t).\n    $$\n    This is the SDE governing the time evolution of $\\bar{u}(t)$. To find the explicit solution, we integrate from time $0$ to $t$:\n    $$\n    \\int_{0}^{t} \\mathrm{d}\\bar{u}(s) = \\int_{0}^{t} \\sigma\\,\\mathrm{d}\\beta_{0}(s).\n    $$\n    This yields:\n    $$\n    \\bar{u}(t) - \\bar{u}(0) = \\sigma \\left( \\beta_{0}(t) - \\beta_{0}(0) \\right).\n    $$\n    By convention, a standard Brownian motion starts at zero, i.e., $\\beta_{0}(0) = 0$. Therefore, the explicit solution for the spatial average is:\n    $$\n    \\bar{u}(t) = \\bar{u}(0) + \\sigma\\beta_{0}(t).\n    $$", "answer": "$$\n\\boxed{\\bar{u}(0) + \\sigma \\beta_{0}(t)}\n$$", "id": "2998293"}, {"introduction": "While the previous exercise examined the evolution of a specific quantity, many physical systems are dissipative and eventually reach a statistical equilibrium. This problem investigates that balance, using the linear stochastic heat equation as a model for systems where energy is dissipated but also constantly injected by noise. By applying spectral methods and the Itô isometry, you will derive the system's long-term average energy and identify the precise condition under which a stable stationary state exists [@problem_id:2998289].", "problem": "Consider the linear stochastic partial differential equation (SPDE)\n$$\n\\partial_{t} u(t,x) \\;=\\; \\nu\\,\\Delta u(t,x) \\;-\\; \\alpha\\,u(t,x) \\;+\\; \\xi(t,x), \\quad x\\in D,\\; t\\ge 0,\n$$\nwith homogeneous Dirichlet boundary conditions on a bounded, smooth domain $D\\subset\\mathbb{R}^{d}$, and initial condition $u(0,\\cdot)=u_{0}\\in L^{2}(D)$. Here, $\\nu0$ and $\\alpha\\ge 0$ are fixed constants, $\\Delta$ is the Laplacian with domain $H^{2}(D)\\cap H_{0}^{1}(D)$, and $\\xi$ is a centered Gaussian noise that is white in time and colored in space, represented as $\\xi(t,\\cdot)=Q^{1/2}\\dot{W}(t)$, where $W(t)$ is a cylindrical Wiener process on the Hilbert space $L^{2}(D)$ and $Q:L^{2}(D)\\to L^{2}(D)$ is a bounded, self-adjoint, nonnegative covariance operator. Assume that $Q$ commutes with $-\\Delta$ so that there exists an orthonormal basis $\\{e_{k}\\}_{k\\ge 1}$ of $L^{2}(D)$ of simultaneous eigenfunctions, with\n$$\n-\\Delta e_{k} \\;=\\; \\mu_{k}\\,e_{k}, \\quad \\mu_{k}0,\\qquad\nQ e_{k} \\;=\\; q_{k}\\,e_{k}, \\quad q_{k}\\ge 0,\n$$\nand define the generator $A:=\\nu\\,\\Delta-\\alpha I$ so that $A e_{k}=(-\\nu\\mu_{k}-\\alpha)e_{k}$. Let $\\|\\cdot\\|_{L^{2}}$ denote the norm on $L^{2}(D)$ and $\\mathbb{E}$ the expectation with respect to the noise.\n\nStarting from the fundamental definitions of the mild solution for linear SPDEs and the Itô isometry for stochastic integrals in Hilbert spaces, derive the asymptotic behavior of $\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}$ as $t\\to\\infty$. In particular, identify a condition expressed in terms of $\\{\\mu_{k}\\}$, $\\{q_{k}\\}$, $\\nu$, and $\\alpha$ that ensures the existence of a stationary $L^{2}(D)$-valued solution with finite second moment, and express the limit\n$$\n\\lim_{t\\to\\infty}\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}\n$$\nas a single analytic expression in these quantities. Your final answer must be this limiting expression. No rounding is required.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the field of stochastic partial differential equations. All provided information is self-contained and consistent.\n\nWe begin by formulating the problem in an abstract setting. Let $H = L^{2}(D)$ be the Hilbert space of square-integrable functions on the domain $D$. The given stochastic partial differential equation (SPDE) can be written as an abstract stochastic evolution equation in $H$:\n$$\ndu(t) = A u(t) dt + Q^{1/2} dW(t), \\quad u(0) = u_{0}\n$$\nwhere $u(t)$ is a function from $[0, \\infty)$ to $H$ representing the solution $u(t,\\cdot)$, $u_0 \\in H$ is the initial condition, and $W(t)$ is a cylindrical Wiener process on $H$. The operator $A$ is defined as $A = \\nu\\Delta - \\alpha I$, where $I$ is the identity operator. The domain of $A$ is the same as that of the Laplacian $\\Delta$, namely $D(A) = H^{2}(D)\\cap H_{0}^{1}(D)$. The operator $A$ is the generator of a strongly continuous analytic semigroup $S(t) = e^{tA}$ on $H$.\n\nThe mild solution to this abstract SPDE is given by the variation of constants formula:\n$$\nu(t) = S(t)u_{0} + \\int_{0}^{t} S(t-s) Q^{1/2} dW(s).\n$$\nWe wish to compute the long-time behavior of the second moment, $\\mathbb{E}\\|u(t)\\|_{L^{2}}^{2}$. We denote the norm on $H=L^{2}(D)$ by $\\|\\cdot\\|$. Taking the squared norm of the mild solution, we get:\n$$\n\\|u(t)\\|^{2} = \\left\\| S(t)u_{0} + \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\|S(t)u_{0}\\|^{2} + 2\\left\\langle S(t)u_{0}, \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\rangle + \\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2}.\n$$\nWe now take the expectation $\\mathbb{E}$. The initial condition $u_{0}$ is deterministic. The stochastic integral term is an Itô integral, which is a martingale with expectation zero. Therefore, the expectation of the cross-term vanishes:\n$$\n\\mathbb{E}\\left[ 2\\left\\langle S(t)u_{0}, \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\rangle \\right] = 2\\left\\langle S(t)u_{0}, \\mathbb{E}\\left[\\int_{0}^{t} S(t-s) Q^{1/2} dW(s)\\right] \\right\\rangle = 0.\n$$\nThis leaves us with:\n$$\n\\mathbb{E}\\|u(t)\\|^{2} = \\|S(t)u_{0}\\|^{2} + \\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2}.\n$$\nWe analyze each term separately using the provided spectral decomposition. We have an orthonormal basis $\\{e_{k}\\}_{k\\ge 1}$ of $H$ and sequences of eigenvalues $\\{\\mu_{k}\\}_{k\\ge 1}$ and $\\{q_{k}\\}_{k\\ge 1}$ such that $-\\Delta e_{k} = \\mu_{k}e_{k}$ and $Qe_{k} = q_{k}e_{k}$. The operator $A$ acts on this basis as:\n$$\nA e_{k} = (\\nu\\Delta - \\alpha I)e_{k} = -\\nu\\mu_{k}e_{k} - \\alpha e_{k} = -(\\nu\\mu_{k} + \\alpha)e_{k}.\n$$\nLet us define $\\lambda_{k} := \\nu\\mu_{k} + \\alpha$. Since $\\nu  0$, $\\mu_{k}  0$ for all $k \\ge 1$ (due to Dirichlet boundary conditions on a bounded domain), and $\\alpha \\ge 0$, we have $\\lambda_{k}  0$ for all $k$. The semigroup acts on the basis functions as $S(t)e_{k} = e^{tA}e_{k} = e^{-t\\lambda_{k}}e_{k}$.\n\nFor the first term, we expand $u_{0}$ in the eigenbasis: $u_{0} = \\sum_{k=1}^{\\infty} c_{k} e_{k}$, where $c_{k} = \\langle u_{0}, e_{k} \\rangle$. Then\n$$\nS(t)u_{0} = \\sum_{k=1}^{\\infty} c_{k} S(t)e_{k} = \\sum_{k=1}^{\\infty} c_{k} e^{-t\\lambda_{k}} e_{k}.\n$$\nBy Parseval's identity, its squared norm is:\n$$\n\\|S(t)u_{0}\\|^{2} = \\sum_{k=1}^{\\infty} |c_{k}|^{2} e^{-2t\\lambda_{k}}.\n$$\nAs $t \\to \\infty$, since all $\\lambda_{k}  0$, each term $e^{-2t\\lambda_{k}}$ converges to $0$. The series is dominated by $\\sum_{k=1}^{\\infty} |c_{k}|^{2} = \\|u_{0}\\|^{2}  \\infty$. By the Dominated Convergence Theorem for series, the limit of the sum is the sum of the limits, which is $0$.\n$$\n\\lim_{t\\to\\infty} \\|S(t)u_{0}\\|^{2} = 0.\n$$\nFor the second term, we apply the Itô isometry for Hilbert space-valued stochastic integrals:\n$$\n\\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\int_{0}^{t} \\text{Tr}\\left( \\left(S(t-s)Q^{1/2}\\right) \\left(S(t-s)Q^{1/2}\\right)^{*} \\right) ds.\n$$\nThe operator $A$ is self-adjoint, so $S(\\tau)=e^{\\tau A}$ is self-adjoint for $\\tau \\ge 0$. The operator $Q$ is self-adjoint, so its square root $Q^{1/2}$ is also self-adjoint. The operators $A$ and $Q$ commute, which implies that $S(\\tau)$ and $Q$ (and $Q^{1/2}$) also commute. Thus, the argument of the trace becomes:\n$$\nS(t-s)Q^{1/2} (Q^{1/2})^{*} S(t-s)^{*} = S(t-s)Q S(t-s) = S(t-s)^{2} Q = S(2(t-s))Q.\n$$\nThe trace is computed using the basis $\\{e_{k}\\}$:\n$$\n\\text{Tr}(S(2(t-s))Q) = \\sum_{k=1}^{\\infty} \\langle S(2(t-s))Q e_{k}, e_{k} \\rangle = \\sum_{k=1}^{\\infty} \\langle q_{k} e^{-2(t-s)\\lambda_{k}} e_{k}, e_{k} \\rangle = \\sum_{k=1}^{\\infty} q_{k} e^{-2(t-s)\\lambda_{k}}.\n$$\nSubstituting this into the integral and applying the Fubini-Tonelli theorem to interchange the sum and integral (justified as all terms are non-negative):\n$$\n\\mathbb{E}\\left\\| \\int_{0}^{t} S(t-s) Q^{1/2} dW(s) \\right\\|^{2} = \\int_{0}^{t} \\sum_{k=1}^{\\infty} q_{k} e^{-2(t-s)\\lambda_{k}} ds = \\sum_{k=1}^{\\infty} q_{k} \\int_{0}^{t} e^{-2(t-s)\\lambda_{k}} ds.\n$$\nThe integral for each $k$ is:\n$$\n\\int_{0}^{t} e^{-2(t-s)\\lambda_{k}} ds = \\left[ \\frac{e^{-2(t-s)\\lambda_{k}}}{2\\lambda_{k}} \\right]_{s=0}^{s=t} = \\frac{1 - e^{-2t\\lambda_{k}}}{2\\lambda_{k}}.\n$$\nSo, we have:\n$$\n\\mathbb{E}\\|u(t)\\|^{2} = \\sum_{k=1}^{\\infty} |c_{k}|^{2} e^{-2t\\lambda_{k}} + \\sum_{k=1}^{\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}}.\n$$\nNow, we take the limit as $t\\to\\infty$. As established, the first sum converges to $0$. For the second sum, we consider the limit of each term:\n$$\n\\lim_{t\\to\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\frac{q_{k}}{2\\lambda_{k}}.\n$$\nThe existence of a stationary $L^{2}(D)$-valued solution with a finite second moment is equivalent to the condition that the covariance of the stationary distribution is a trace-class operator. The second moment of the stationary distribution is precisely the limit of $\\mathbb{E}\\|u(t)\\|^{2}$ as $t\\to\\infty$. This limit is finite if and only if the series of the limiting terms converges. Therefore, the condition is:\n$$\n\\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}}  \\infty \\quad \\Longleftrightarrow \\quad \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}  \\infty.\n$$\nUnder this condition, we can apply the Monotone Convergence Theorem for series (since each term is non-negative and non-decreasing in $t$) to interchange the limit and the summation:\n$$\n\\lim_{t\\to\\infty} \\sum_{k=1}^{\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\lim_{t\\to\\infty} \\frac{q_{k}(1-e^{-2t\\lambda_{k}})}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}}.\n$$\nCombining all results, the asymptotic behavior of the second moment is:\n$$\n\\lim_{t\\to\\infty} \\mathbb{E}\\|u(t)\\|_{L^{2}}^{2} = 0 + \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2\\lambda_{k}} = \\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}.\n$$\nThis sum represents the variance of the stationary solution, which is a centered Gaussian process.", "answer": "$$\n\\boxed{\\sum_{k=1}^{\\infty} \\frac{q_{k}}{2(\\nu\\mu_{k} + \\alpha)}}\n$$", "id": "2998289"}, {"introduction": "Analytical solutions provide deep insight but are rare for complex SPDEs, making numerical methods essential for practical applications. This practice bridges the gap between theory and computation by guiding you through the process of approximating the stochastic heat equation. You will combine the spectral method with a time-stepping scheme to build a simulation, and more importantly, you will analytically compute the numerical error to understand the trade-offs involved in discretization [@problem_id:3078121].", "problem": "Consider the stochastic heat equation, a prototypical stochastic partial differential equation (SPDE), on the spatial interval $\\left(0,1\\right)$ with homogeneous Dirichlet boundary conditions and zero initial condition. The state variable $u\\left(x,t\\right)$ satisfies\n$$\n\\mathrm{d}u\\left(x,t\\right) = \\nu\\,\\partial_{xx}u\\left(x,t\\right)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W\\left(x,t\\right),\n$$\nwhere $\\nu0$ is the diffusivity, $\\sigma\\ge 0$ is the noise intensity, and $W\\left(x,t\\right)$ is a cylindrical Wiener process on $L^2\\left(0,1\\right)$ that is white in time and spatially homogeneous with respect to the orthonormal Laplacian eigensystem. The boundary conditions are $u\\left(0,t\\right)=0$ and $u\\left(1,t\\right)=0$, and the initial condition is $u\\left(x,0\\right)=0$.\n\nThe spectral Galerkin method approximates $u\\left(x,t\\right)$ by a truncated series in the first $N$ Laplacian eigenfunctions with Dirichlet boundary conditions on $\\left(0,1\\right)$, where the eigenfunctions are taken to be the orthonormal family $\\left\\{e_k\\right\\}_{k=1}^N$ and the corresponding eigenvalues are strictly positive. Let the truncated approximation be written as\n$$\nu_N\\left(x,t\\right) = \\sum_{k=1}^N a_k\\left(t\\right)\\,e_k\\left(x\\right),\n$$\nand the coefficient processes $\\left\\{a_k\\left(t\\right)\\right\\}_{k=1}^N$ satisfy a system of stochastic differential equations (SDEs) derived from projecting the SPDE onto the span of $\\left\\{e_k\\right\\}_{k=1}^N$.\n\nYour task is to:\n- Starting from the definitions of the Laplacian eigenfunctions on $\\left(0,1\\right)$ with Dirichlet boundary conditions, their orthonormality in $L^2\\left(0,1\\right)$, the properties of a cylindrical Wiener process, and Itô calculus for linear SDEs, derive the closed-form expressions needed to compute the expected squared $L^2$-norm $\\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]$ at a final time $T$ for:\n  1. The exact spectral Galerkin system (i.e., the continuous-time coefficient SDEs solved exactly for zero initial condition).\n  2. A time-stepping discretization of the coefficient SDEs using the forward Euler–Maruyama method with a uniform time step $h0$ and $T$ an integer multiple of $h$.\n\n- Express both results purely in terms of the parameters $\\nu$, $\\sigma$, $N$, $T$, and $h$, and the Laplacian eigenvalues associated with the basis $\\left\\{e_k\\right\\}_{k=1}^N$ on $\\left(0,1\\right)$.\n\n- Implement a program that, for each test case below, computes the absolute difference between the exact spectral Galerkin expectation and the forward Euler–Maruyama expectation at time $T$ for $u_N\\left(x,T\\right)$:\n  $$\n  \\left|\\ \\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]_{\\text{exact}} \\;-\\; \\mathbb{E}\\left[\\left\\|u_N\\left(\\cdot,T\\right)\\right\\|_{L^2\\left(0,1\\right)}^2\\right]_{\\text{Euler}}\\ \\right|.\n  $$\n\nYour program must not perform any Monte Carlo sampling and must rely on the closed-form expressions that follow from your derivation. Use standard double-precision arithmetic. Angles and physical units are not involved in this problem.\n\nUse the following test suite, which is designed to probe a typical case, minimal-mode truncation, near-stability step sizes, and degenerate scenarios:\n- Case $1$: $\\nu=0.1$, $\\sigma=1.0$, $N=5$, $T=1.0$, $h=0.001$.\n- Case $2$: $\\nu=0.1$, $\\sigma=1.0$, $N=1$, $T=2.0$, $h=0.4$.\n- Case $3$: $\\nu=0.1$, $\\sigma=0.8$, $N=8$, $T=0.5$, $h=0.03125$.\n- Case $4$: $\\nu=0.5$, $\\sigma=0.0$, $N=3$, $T=1.0$, $h=0.1$.\n- Case $5$: $\\nu=0.1$, $\\sigma=1.0$, $N=4$, $T=0.0$, $h=0.1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]$), where each $\\text{result}_i$ is the absolute difference for Case $i$ expressed as a floating-point number. Ensure that $T/h$ is an integer in each case, so that the number of time steps is well-defined.", "solution": "The user-provided problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and internally consistent. It presents a standard, non-trivial task in the numerical analysis of stochastic partial differential equations (SPDEs). We may therefore proceed with a full solution.\n\n### 1. Eigenbasis and SDE System Derivation\nThe first step is to establish the eigenbasis for the spectral method. We consider the eigenvalue problem for the negative Laplacian operator $-\\partial_{xx}$ on the spatial domain $\\left(0,1\\right)$ with homogeneous Dirichlet boundary conditions, $e(0)=e(1)=0$:\n$$-\\partial_{xx}e_k(x) = \\lambda_k e_k(x)$$\nThe strictly positive eigenvalues are $\\lambda_k = (k\\pi)^2$ for integers $k \\ge 1$. The corresponding eigenfunctions, normalized to form an orthonormal basis in $L^2\\left(0,1\\right)$, are:\n$$e_k(x) = \\sqrt{2}\\sin(k\\pi x)$$\nThe orthonormality condition is $\\int_0^1 e_k(x)e_j(x)\\,\\mathrm{d}x = \\delta_{kj}$, where $\\delta_{kj}$ is the Kronecker delta.\n\nNext, we project the SPDE onto this basis. The Galerkin approximation is $u_N(x,t) = \\sum_{k=1}^N a_k(t)e_k(x)$. Substituting this into the SPDE,\n$$\n\\sum_{k=1}^N \\mathrm{d}a_k(t)\\,e_k(x) = \\nu\\,\\partial_{xx}\\left(\\sum_{k=1}^N a_k(t)e_k(x)\\right)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(x,t)\n$$\nWe take the $L^2$ inner product $\\langle\\cdot, e_j(x)\\rangle = \\int_0^1 \\cdot \\,e_j(x)\\,\\mathrm{d}x$ for each $j \\in \\{1,\\dots,N\\}$.\nUsing the orthonormality of $\\{e_k\\}$ and the eigenvalue property $\\partial_{xx}e_k = -\\lambda_k e_k$, the projection yields a system of decoupled stochastic differential equations (SDEs) for the modal coefficients $a_j(t)$:\n- Left-hand side: $\\left\\langle \\sum_{k=1}^N \\mathrm{d}a_k(t)\\,e_k(x), e_j(x) \\right\\rangle = \\sum_{k=1}^N \\mathrm{d}a_k(t)\\,\\delta_{kj} = \\mathrm{d}a_j(t)$.\n- Drift term: $\\left\\langle \\nu\\,\\partial_{xx}\\left(\\sum_{k=1}^N a_k(t)e_k(x)\\right), e_j(x) \\right\\rangle\\,\\mathrm{d}t = \\nu \\sum_{k=1}^N a_k(t)\\langle -\\lambda_k e_k, e_j \\rangle\\,\\mathrm{d}t = -\\nu \\lambda_j a_j(t)\\,\\mathrm{d}t$.\n- Diffusion term: $\\sigma\\langle \\mathrm{d}W(x,t), e_j(x) \\rangle = \\sigma\\,\\mathrm{d}W_j(t)$. Here, $\\mathrm{d}W_j(t)$ are the increments of independent, standard, one-dimensional Wiener processes, a consequence of the noise $W(x,t)$ being a cylindrical Wiener process with a covariance structure aligned with the Laplacian eigensystem.\n\nThe resulting system of SDEs, for $j=1, \\dots, N$, consists of independent Ornstein-Uhlenbeck processes:\n$$\n\\mathrm{d}a_j(t) = -\\nu\\lambda_j a_j(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W_j(t)\n$$\nThe initial condition $u(x,0)=0$ implies $a_j(0)=0$ for all $j$.\n\n### 2. Exact Expected Squared $L^2$-Norm\nThe exact solution to the SDE for $a_j(t)$ with $a_j(0)=0$ is given by the Itô integral:\n$$\na_j(t) = \\sigma \\int_0^t e^{-\\nu\\lambda_j(t-s)}\\,\\mathrm{d}W_j(s)\n$$\nThis is a Gaussian process with zero mean, $\\mathbb{E}[a_j(t)]=0$. The variance is found using Itô isometry:\n$$\n\\mathbb{E}[a_j(t)^2] = \\sigma^2 \\int_0^t \\left(e^{-\\nu\\lambda_j(t-s)}\\right)^2\\,\\mathrm{d}s = \\sigma^2 \\int_0^t e^{-2\\nu\\lambda_j(t-s)}\\,\\mathrm{d}s\n$$\nEvaluating the integral gives:\n$$\n\\mathbb{E}[a_j(t)^2] = \\sigma^2 \\left[ \\frac{1}{2\\nu\\lambda_j}e^{-2\\nu\\lambda_j(t-s)} \\right]_0^t = \\sigma^2 \\frac{1 - e^{-2\\nu\\lambda_j t}}{2\\nu\\lambda_j}\n$$\nThe squared $L^2$-norm of the approximation is, by Parseval's identity:\n$$\n\\left\\|u_N(\\cdot,T)\\right\\|_{L^2(0,1)}^2 = \\left\\| \\sum_{k=1}^N a_k(T)e_k \\right\\|^2 = \\sum_{k=1}^N a_k(T)^2\n$$\nTaking the expectation and using the independence of the coefficients $a_k(T)$, we get:\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{exact}} = \\sum_{k=1}^N \\mathbb{E}[a_k(T)^2] = \\sum_{k=1}^N \\sigma^2 \\frac{1 - e^{-2\\nu\\lambda_k T}}{2\\nu\\lambda_k}\n$$\nSubstituting $\\lambda_k = (k\\pi)^2$, the final expression is:\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{exact}} = \\sum_{k=1}^N \\sigma^2 \\frac{1 - e^{-2\\nu(k\\pi)^2 T}}{2\\nu(k\\pi)^2}\n$$\n\n### 3. Euler-Maruyama Expected Squared $L^2$-Norm\nThe forward Euler-Maruyama discretization for $a_k(t)$ with time step $h$ is given by the recurrence relation:\n$$\na_{k,n+1} = a_{k,n} - h\\nu\\lambda_k a_{k,n} + \\sigma\\sqrt{h}Z_{k,n} = (1 - h\\nu\\lambda_k)a_{k,n} + \\sigma\\sqrt{h}Z_{k,n}\n$$\nwhere $a_{k,n} \\approx a_k(nh)$ and $Z_{k,n}$ are independent standard normal random variables. The initial condition is $a_{k,0}=0$.\n\nLet $V_{k,n} = \\mathbb{E}[a_{k,n}^2]$. Since $\\mathbb{E}[a_{k,n}]=0$ and $a_{k,n}$ is independent of $Z_{k,n}$, we have:\n$$\nV_{k,n+1} = \\mathbb{E}[((1 - h\\nu\\lambda_k)a_{k,n} + \\sigma\\sqrt{h}Z_{k,n})^2] = (1 - h\\nu\\lambda_k)^2 V_{k,n} + \\sigma^2h\n$$\nThis is a linear recurrence for the variance. Let $C_k = (1 - h\\nu\\lambda_k)^2$. The recurrence is $V_{k,n+1} = C_k V_{k,n} + \\sigma^2h$. With $V_{k,0}=0$, unrolling the recurrence gives a geometric series:\n$$\nV_{k,n} = \\sigma^2h \\sum_{i=0}^{n-1} C_k^i\n$$\nAt the final time $T$, the number of steps is $M=T/h$. If $C_k \\neq 1$, the sum is $\\frac{1-C_k^M}{1-C_k}$. If $C_k = 1$, the sum is $M$.\nThe variance of the $k$-th mode at time $T$ is $V_{k,M} = \\mathbb{E}[a_{k,M}^2]$.\nThe total expected squared norm is the sum over the modes:\n$$\n\\mathbb{E}\\left[\\left\\|u_N(\\cdot,T)\\right\\|^2\\right]_{\\text{Euler}} = \\sum_{k=1}^N V_{k,M} = \\sum_{k=1}^N \\left( \\sigma^2h \\sum_{i=0}^{M-1} [(1 - h\\nu(k\\pi)^2)^2]^i \\right)\n$$\nThis expression is numerically robust and will be used for implementation.\n\n### 4. Final Calculation\nThe required output is the absolute difference between these two derived expectations for each test case:\n$$\n\\text{Difference} = \\left|\\ \\mathbb{E}\\left[\\left\\|u_N\\right\\|^2\\right]_{\\text{exact}} \\;-\\; \\mathbb{E}\\left[\\left\\|u_N\\right\\|^2\\right]_{\\text{Euler}}\\ \\right|\n$$\nThe implementation will compute these two sums and their difference. Special care is taken for cases where parameters might lead to numerical issues, such as $\\sigma=0$, $T=0$, or the common ratio $C_k$ of the geometric series being close to $1$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the absolute difference between the exact and Euler-Maruyama\n    expectations of the squared L2-norm for a spectral approximation of the\n    stochastic heat equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (nu, sigma, N, T, h)\n        (0.1, 1.0, 5, 1.0, 0.001),\n        (0.1, 1.0, 1, 2.0, 0.4),\n        (0.1, 0.8, 8, 0.5, 0.03125),\n        (0.5, 0.0, 3, 1.0, 0.1),\n        (0.1, 1.0, 4, 0.0, 0.1)\n    ]\n\n    results = []\n    for nu, sigma, N, T, h in test_cases:\n        # Handle trivial cases where the solution is deterministically zero.\n        if np.isclose(sigma, 0.0) or np.isclose(T, 0.0):\n            results.append(0.0)\n            continue\n\n        # Convert T/h to an integer number of steps.\n        # The problem statement guarantees this is an integer.\n        M = int(round(T / h))\n\n        # Vectorized calculation over modes k = 1 to N\n        k = np.arange(1, N + 1)\n        lambda_k = (k * np.pi)**2\n        \n        # --- Exact Expectation Calculation ---\n        # E[||u_N||^2] = sum_{k=1 to N} sigma^2 * (1 - exp(-2*nu*lambda_k*T)) / (2*nu*lambda_k)\n        arg = 2 * nu * lambda_k * T\n        # Use np.expm1 for better numerical precision for small arguments.\n        # 1 - exp(-x) = -expm1(-x)\n        exact_terms = sigma**2 * (-np.expm1(-arg)) / (2 * nu * lambda_k)\n        exact_exp = np.sum(exact_terms)\n        \n        # --- Euler-Maruyama Expectation Calculation ---\n        # E[a_{k,M}^2] = sigma^2 * h * sum_{i=0 to M-1} C_k^i\n        # where C_k = (1 - h*nu*lambda_k)^2\n        h_nu_lambda_k = h * nu * lambda_k\n        C_k = (1 - h_nu_lambda_k)**2\n        \n        # Calculate the sum of the geometric series for each mode k.\n        # This approach is numerically stable.\n        geom_sum = np.zeros(N, dtype=float)\n        \n        # Identify modes where C_k is close to 1, which requires special handling.\n        one_mask = np.isclose(C_k, 1.0)\n        \n        # Case 1: C_k is close to 1. The sum is simply M.\n        geom_sum[one_mask] = M\n        \n        # Case 2: C_k is not close to 1. Use the standard formula for a geometric series.\n        not_one_mask = ~one_mask\n        if np.any(not_one_mask):\n            C_k_not_one = C_k[not_one_mask]\n            geom_sum[not_one_mask] = (1 - C_k_not_one**M) / (1 - C_k_not_one)\n            \n        euler_terms = sigma**2 * h * geom_sum\n        euler_exp = np.sum(euler_terms)\n        \n        # Calculate the absolute difference and store the result.\n        results.append(abs(exact_exp - euler_exp))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3078121"}]}