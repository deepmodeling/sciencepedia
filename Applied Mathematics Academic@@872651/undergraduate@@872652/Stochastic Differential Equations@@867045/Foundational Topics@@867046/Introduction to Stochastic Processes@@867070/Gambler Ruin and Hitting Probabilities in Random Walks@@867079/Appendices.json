{"hands_on_practices": [{"introduction": "This first practice problem addresses the most fundamental question in the gambler's ruin scenario: what is the probability of success? By setting up and solving a linear difference equation for the hitting probability in a symmetric random walk, you will master the essential technique of first-step analysis. This method is a cornerstone for solving a wide range of problems involving stochastic processes [@problem_id:3056065].", "problem": "Consider a simple symmetric random walk (SSRW) $\\{X_n\\}_{n \\ge 0}$ on the state space $\\{0,1,\\dots,N\\}$, where $N \\in \\mathbb{N}$ and $N \\ge 2$. The process starts at $X_0=i$ for some $i \\in \\{1,\\dots,N-1\\}$, and at each step moves to $X_{n+1}=X_n+1$ with probability $1/2$ and to $X_{n+1}=X_n-1$ with probability $1/2$, independently of the past. The boundary states $0$ and $N$ are absorbing. Define the hitting times $T_0=\\inf\\{n \\ge 0: X_n=0\\}$ and $T_N=\\inf\\{n \\ge 0: X_n=N\\}$, and the hitting probability\n$$\nh(i) = \\mathbb{P}_i\\left(T_N  T_0\\right),\n$$\nwhere $\\mathbb{P}_i$ denotes probability conditioned on $X_0=i$.\n\nUsing only the Markov property and conditioning on the first step, proceed as follows:\n1. Derive the linear difference equation satisfied by $h(i)$ for interior states $i \\in \\{1,\\dots,N-1\\}$ together with the boundary conditions at $i=0$ and $i=N$.\n2. Solve the resulting boundary value problem to obtain an explicit expression for $h(i)$ in terms of $i$ and $N$.\n3. Justify the uniqueness of the solution among all functions $u:\\{0,1,\\dots,N\\}\\to\\mathbb{R}$ satisfying the same difference equation and boundary conditions, using a discrete maximum principle argument appropriate for harmonic functions on finite graphs.\n\nProvide your final answer as a single closed-form expression for $h(i)$ in terms of $i$ and $N$.", "solution": "The problem is valid as it is a well-posed, scientifically grounded, and objective question from the theory of stochastic processes. It is a classic problem concerning hitting probabilities for a simple symmetric random walk on a finite interval. We proceed with the solution, following the three steps specified in the problem statement.\n\nThe quantity to be determined is the probability $h(i) = \\mathbb{P}_i(T_N  T_0)$, which is the probability that the random walk starting from state $i$ hits state $N$ before hitting state $0$. Here, the state space is $\\{0, 1, \\dots, N\\}$ with $0$ and $N$ being absorbing boundaries, and the starting state $i$ is in the interior, i.e., $i \\in \\{1, \\dots, N-1\\}$.\n\n1. Derivation of the linear difference equation and boundary conditions.\n\nWe derive the equation for $h(i)$ by conditioning on the first step of the random walk, using the law of total probability and the Markov property. Starting from state $i \\in \\{1, \\dots, N-1\\}$, the process moves to state $i+1$ with probability $1/2$ or to state $i-1$ with probability $1/2$. Let $X_n$ denote the position at time $n$.\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_0=i)$$\nConditioning on $X_1$:\n$$h(i) = \\mathbb{P}(T_N  T_0 | X_1=i+1)\\mathbb{P}(X_1=i+1|X_0=i) + \\mathbb{P}(T_N  T_0 | X_1=i-1)\\mathbb{P}(X_1=i-1|X_0=i)$$\nBy the Markov property, the probability of the process hitting $N$ before $0$ starting from $X_1=j$ is the same as if the process started from $X_0=j$. Thus, $\\mathbb{P}(T_N  T_0 | X_1=j) = h(j)$. The transition probabilities are given as $1/2$. Substituting these into the equation gives:\n$$h(i) = h(i+1) \\cdot \\frac{1}{2} + h(i-1) \\cdot \\frac{1}{2}$$\nThis equation holds for all interior states $i \\in \\{1, \\dots, N-1\\}$. Rearranging it, we obtain the second-order linear homogeneous difference equation:\n$$h(i+1) - 2h(i) + h(i-1) = 0$$\nNext, we establish the boundary conditions for $h(i)$ at $i=0$ and $i=N$.\nIf the walk starts at $i=0$, then $X_0=0$. Since $0$ is an absorbing state, the process remains at $0$ for all time. The hitting time of $0$ is $T_0 = \\inf\\{n \\ge 0: X_n=0\\} = 0$. Since $N \\ge 2$, $N \\ne 0$, so the process is not at $N$ at time $0$, meaning $T_N > 0$. Therefore, the event $T_N  T_0$ is impossible. The probability is zero:\n$$h(0) = 0$$\nIf the walk starts at $i=N$, then $X_0=N$. Since $N$ is an absorbing state, the process remains at $N$. The hitting time of $N$ is $T_N=0$. Since $i=N \\ne 0$, the hitting time of $0$ must be $T_0 > 0$. The event $T_N  T_0$ is certain. The probability is one:\n$$h(N) = 1$$\nThus, we have a boundary value problem consisting of the difference equation for $i \\in \\{1, \\dots, N-1\\}$ and the two boundary conditions.\n\n2. Solving the boundary value problem.\n\nThe difference equation $h(i+1) - 2h(i) + h(i-1) = 0$ can be rewritten as $h(i+1) - h(i) = h(i) - h(i-1)$. This indicates that the difference between consecutive values of $h(i)$ is constant. This is the defining property of an arithmetic progression. Therefore, the general solution for $h(i)$ must be a linear function of $i$:\n$$h(i) = Ai + B$$\nwhere $A$ and $B$ are constants to be determined by the boundary conditions.\nUsing the condition at $i=0$:\n$$h(0) = A \\cdot 0 + B = 0 \\implies B=0$$\nUsing the condition at $i=N$:\n$$h(N) = A \\cdot N + B = 1$$\nSubstituting $B=0$ into the second equation yields:\n$$A \\cdot N = 1 \\implies A = \\frac{1}{N}$$\nThus, the explicit expression for $h(i)$ is:\n$$h(i) = \\frac{i}{N}$$\n\n3. Justification of uniqueness.\n\nTo justify that $h(i) = i/N$ is the unique solution to the boundary value problem, we employ a discrete maximum principle argument. The equation $h(i) = \\frac{1}{2}h(i+1) + \\frac{1}{2}h(i-1)$ means that $h$ is a discrete harmonic function on the interior points $\\{1, \\dots, N-1\\}$.\nLet $u(i)$ be any function on $\\{0, 1, \\dots, N\\}$ that satisfies the same boundary value problem:\n$$u(i) = \\frac{1}{2}u(i+1) + \\frac{1}{2}u(i-1) \\quad \\text{for } i \\in \\{1, \\dots, N-1\\}$$\n$$u(0) = 0, \\quad u(N) = 1$$\nDefine the difference function $v(i) = h(i) - u(i) = \\frac{i}{N} - u(i)$. We will show that $v(i) = 0$ for all $i$.\nThe function $v(i)$ is also harmonic on the interior points, as it is a linear combination of two harmonic functions:\n$$v(i) = h(i) - u(i) = \\frac{1}{2}(h(i+1)+h(i-1)) - \\frac{1}{2}(u(i+1)+u(i-1)) = \\frac{1}{2}(v(i+1)+v(i-1))$$\nThe boundary values of $v(i)$ are:\n$$v(0) = h(0) - u(0) = 0 - 0 = 0$$\n$$v(N) = h(N) - u(N) = 1 - 1 = 0$$\nAccording to the discrete maximum principle for harmonic functions on a finite domain, the maximum value of $v(i)$ must be attained on the boundary of the domain, which is the set $\\{0, N\\}$. Let $M = \\max_{i \\in \\{0, \\dots, N\\}} v(i)$. Then:\n$$M = \\max\\{v(0), v(N)\\} = \\max\\{0, 0\\} = 0$$\nThis implies that $v(i) \\le 0$ for all $i \\in \\{0, \\dots, N\\}$.\nSimilarly, the discrete minimum principle states that the minimum value of $v(i)$ must also be attained on the boundary. Let $m = \\min_{i \\in \\{0, \\dots, N\\}} v(i)$. Then:\n$$m = \\min\\{v(0), v(N)\\} = \\min\\{0, 0\\} = 0$$\nThis implies that $v(i) \\ge 0$ for all $i \\in \\{0, \\dots, N\\}$.\nSince we have both $v(i) \\le 0$ and $v(i) \\ge 0$ for all $i$, it must be that $v(i)=0$ for all $i$. Therefore, $h(i) - u(i) = 0$, which means $u(i)=h(i)$ for all $i \\in \\{0, \\dots, N\\}$. This proves that the solution $h(i) = i/N$ is unique.", "answer": "$$\\boxed{\\frac{i}{N}}$$", "id": "3056065"}, {"introduction": "Having determined the probability of ruin, a natural follow-up question is to ask about the expected duration of the game. This exercise guides you through calculating the expected time until the random walk is absorbed at either boundary [@problem_id:3056089]. You will find that the first-step analysis now yields a non-homogeneous difference equation, providing practice with a new and important class of recurrence relations.", "problem": "Consider a simple symmetric random walk on the finite state space $\\{0,1,\\dots,N\\}$ with absorbing boundaries at $0$ and $N$. Let $\\{X_{n}\\}_{n\\geq 0}$ denote the capital of the gambler at step $n$, starting from $X_{0}=i$ where $i\\in\\{1,2,\\dots,N-1\\}$. At each step, the gamblerâ€™s capital changes by $+1$ or $-1$ with equal probability $1/2$, independently of the past. Define the stopping time $\\tau=\\inf\\{n\\geq 0: X_{n}\\in\\{0,N\\}\\}$, the first hitting time of the absorbing set $\\{0,N\\}$.\n\nUsing only first principles for discrete-time Markov chains and first-step analysis, derive the boundary value problem for the function $u(i)=\\mathbb{E}_{i}[\\tau]$ for $i\\in\\{0,1,\\dots,N\\}$, and solve it to obtain a closed-form expression for $u(i)$ in terms of $i$ and $N$. Express your final answer as a single analytic expression with no units. No rounding is required.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem from the field of stochastic processes, specifically concerning discrete-time Markov chains. All necessary information is provided, and there are no contradictions or ambiguities. We may proceed with the solution.\n\nLet $u(i) = \\mathbb{E}_{i}[\\tau]$ be the expected time to absorption, starting from state $i \\in \\{0, 1, \\dots, N\\}$. The process starts at $X_0 = i$. The stopping time is $\\tau = \\inf\\{n \\geq 0: X_n \\in \\{0, N\\}\\}$.\n\nFirst, we establish the boundary conditions for the function $u(i)$.\nIf the process starts at $i=0$, it is already in an absorbing state. The time to absorption is $\\tau=0$. Therefore, the expected time is $u(0) = \\mathbb{E}_{0}[\\tau] = 0$.\nSimilarly, if the process starts at $i=N$, it is also in an absorbing state, so the time to absorption is $\\tau=0$. The expected time is $u(N) = \\mathbb{E}_{N}[\\tau] = 0$.\n\nNext, for any interior state $i \\in \\{1, 2, \\dots, N-1\\}$, we apply the principle of first-step analysis, also known as conditioning on the first move. The expected time $u(i)$ can be expressed as one step plus the expected future time from the state reached after that step.\nAfter one step, which takes a time of $1$ unit, the process moves from state $i$ to state $i+1$ with probability $p=1/2$ or to state $i-1$ with probability $q=1/2$.\nBy the law of total expectation, we can write:\n$$u(i) = 1 + \\mathbb{E}[\\text{time from next state } | X_0=i]$$\n$$u(i) = 1 + \\frac{1}{2} u(i+1) + \\frac{1}{2} u(i-1)$$\nThis equation holds for all $i \\in \\{1, 2, \\dots, N-1\\}$.\n\nWe have now formulated a boundary value problem consisting of a second-order linear non-homogeneous difference equation and its associated boundary conditions:\n$$u(i+1) + u(i-1) - 2u(i) = -2, \\quad \\text{for } i \\in \\{1, 2, \\dots, N-1\\}$$\n$$u(0) = 0$$\n$$u(N) = 0$$\nThe general solution $u(i)$ is the sum of the solution to the homogeneous equation, $u_h(i)$, and a particular solution, $u_p(i)$.\n\nThe homogeneous equation is:\n$$u_h(i+1) - 2u_h(i) + u_h(i-1) = 0$$\nWe seek a solution of the form $u_h(i) = r^i$. Substituting this into the equation yields the characteristic equation:\n$$r^{i+1} - 2r^i + r^{i-1} = 0$$\nAssuming $r \\neq 0$, we can divide by $r^{i-1}$ to get:\n$$r^2 - 2r + 1 = 0$$\n$$(r-1)^2 = 0$$\nThis equation has a repeated root $r_1 = r_2 = 1$. For a repeated root, the two linearly independent solutions are $r^i = 1^i = 1$ and $i \\cdot r^i = i \\cdot 1^i = i$. Therefore, the general homogeneous solution is a linear combination of these two solutions:\n$$u_h(i) = A \\cdot 1 + B \\cdot i = A + Bi$$\nwhere $A$ and $B$ are constants.\n\nNext, we find a particular solution $u_p(i)$ to the non-homogeneous equation $u(i+1) - 2u(i) + u(i-1) = -2$. Since the non-homogeneous term is a constant, we would typically guess a polynomial in $i$. Because the constant and linear terms ($A$ and $Bi$) are solutions to the homogeneous equation, we must try a polynomial of a higher degree. Let's propose a quadratic form $u_p(i) = Ci^2$.\nSubstituting this into the non-homogeneous equation:\n$$C(i+1)^2 - 2C(i)^2 + C(i-1)^2 = -2$$\n$$C(i^2 + 2i + 1) - 2Ci^2 + C(i^2 - 2i + 1) = -2$$\n$$C(i^2 + 2i + 1 - 2i^2 + i^2 - 2i + 1) = -2$$\nCollecting terms:\n$$C[(i^2 - 2i^2 + i^2) + (2i - 2i) + (1 + 1)] = -2$$\n$$C[0 + 0 + 2] = -2$$\n$$2C = -2 \\implies C = -1$$\nThus, a particular solution is $u_p(i) = -i^2$.\n\nThe general solution is the sum of the homogeneous and particular solutions:\n$$u(i) = u_h(i) + u_p(i) = A + Bi - i^2$$\n\nFinally, we use the boundary conditions to determine the constants $A$ and $B$.\nUsing $u(0) = 0$:\n$$u(0) = A + B(0) - (0)^2 = 0 \\implies A = 0$$\nThe solution simplifies to $u(i) = Bi - i^2$.\nNow, using $u(N) = 0$:\n$$u(N) = BN - N^2 = 0$$\nAssuming $N \\neq 0$, which is required for a non-trivial state space, we have:\n$$BN = N^2 \\implies B = N$$\n\nSubstituting the values of $A=0$ and $B=N$ into the general solution gives the unique solution for the expected hitting time:\n$$u(i) = Ni - i^2$$\nThis can be factored as:\n$$u(i) = i(N-i)$$\nThis expression provides the expected number of steps to reach either state $0$ or state $N$, starting from state $i$.", "answer": "$$\n\\boxed{i(N-i)}\n$$", "id": "3056089"}, {"introduction": "Real-world scenarios often lack perfect symmetry. This final practice problem generalizes our analysis to a biased random walk, where the probability of winning a round is not equal to losing [@problem_id:3056064]. Solving for the expected absorption time in this more complex setting will demonstrate the robustness of the first-step analysis framework and deepen your skills in solving more advanced difference equations.", "problem": "Consider a discrete-time biased simple random walk on the finite state space $\\{0,1,2,\\dots,N\\}$ with absorbing boundaries at $0$ and $N$. At each time step, from any interior state $i \\in \\{1,2,\\dots,N-1\\}$, the walk moves to $i+1$ with probability $p \\in (0,1)$ and to $i-1$ with probability $q = 1-p$. Let $T$ denote the first hitting time of the set $\\{0,N\\}$, and for each interior state $i$, define the expected absorption time $u(i) = \\mathbb{E}_{i}[T]$, where $\\mathbb{E}_{i}$ denotes the expectation given that the walk starts at $i$.\n\nUsing only the definitions of expectation, the law of total expectation, and the Markov property of the random walk, derive the linear recurrence relation and boundary conditions satisfied by $u(i)$. Then, for the case $p \\neq \\tfrac{1}{2}$, solve this recurrence explicitly to obtain a closed-form expression for $u(i)$ in terms of $i$, $N$, and $p$.\n\nProvide your final answer as a single closed-form analytic expression for $u(i)$, with no numerical approximation required and no units.", "solution": "The problem as stated is a well-defined and standard problem in the theory of stochastic processes. It is self-contained, scientifically grounded in probability theory, and mathematically consistent. Therefore, the problem is valid, and a full solution can be derived.\n\nThe problem asks for two parts: first, the derivation of the linear recurrence relation for the expected absorption time $u(i)$, and second, the explicit solution of this recurrence for the case of a biased random walk ($p \\neq \\frac{1}{2}$).\n\n**Part 1: Derivation of the Recurrence Relation and Boundary Conditions**\n\nLet the discrete-time random walk be denoted by the sequence of random variables $\\{X_n\\}_{n \\ge 0}$, where $X_n$ is the position at time $n$. The state space is $S = \\{0, 1, 2, \\dots, N\\}$. The states $0$ and $N$ are absorbing boundaries.\n\nFor any interior state $i \\in \\{1, 2, \\dots, N-1\\}$, the transition probabilities are:\n$P(X_{n+1} = i+1 | X_n = i) = p$\n$P(X_{n+1} = i-1 | X_n = i) = q = 1-p$\n\nThe absorption time $T$ is the first time the walk reaches either boundary: $T = \\min\\{n \\ge 0 : X_n \\in \\{0, N\\}\\}$. We are asked to find $u(i) = \\mathbb{E}_i[T]$, which is the expected value of $T$ given the starting state is $X_0 = i$.\n\nWe can establish a recurrence relation for $u(i)$ by conditioning on the first step of the random walk, using the law of total expectation. Let $X_0 = i$, where $i \\in \\{1, 2, \\dots, N-1\\}$. After one time step, the walk will be at state $X_1$, which is either $i+1$ or $i-1$.\n\nThe total time to absorption $T$ can be written as $1$ plus the remaining time from the new state $X_1$.\nBy the law of total expectation, conditioning on the outcome of the first step $X_1$:\n$$ u(i) = \\mathbb{E}_i[T] = \\sum_{j \\in S} \\mathbb{E}_i[T | X_1 = j] P(X_1 = j | X_0 = i) $$\nGiven $X_0 = i$, the only possible values for $X_1$ are $i+1$ (with probability $p$) and $i-1$ (with probability $q$). So the sum simplifies to:\n$$ u(i) = \\mathbb{E}_i[T | X_1 = i+1] \\cdot p + \\mathbb{E}_i[T | X_1 = i-1] \\cdot q $$\nThe time to absorption, given the state after the first step, is $1$ plus the expected time from that new state. Crucially, by the Markov property of the random walk, the future evolution of the process depends only on the current state, not on the path taken to reach it. Therefore:\n$\\mathbb{E}_i[T | X_1 = i+1] = 1 + \\mathbb{E}_{i+1}[T] = 1 + u(i+1)$\n$\\mathbb{E}_i[T | X_1 = i-1] = 1 + \\mathbb{E}_{i-1}[T] = 1 + u(i-1)$\n\nSubstituting these into the equation for $u(i)$:\n$$ u(i) = (1 + u(i+1)) \\cdot p + (1 + u(i-1)) \\cdot q $$\n$$ u(i) = p + p \\cdot u(i+1) + q + q \\cdot u(i-1) $$\nSince $p+q=1$, we arrive at the linear recurrence relation:\n$$ u(i) = 1 + p \\cdot u(i+1) + q \\cdot u(i-1) \\quad \\text{for } i \\in \\{1, 2, \\dots, N-1\\} $$\n\nThe boundary conditions are determined by the definition of absorption. If the walk starts at an absorbing boundary, the time to be absorbed is $0$.\nIf $X_0 = 0$, then $T=0$, so $u(0) = \\mathbb{E}_0[T] = 0$.\nIf $X_0 = N$, then $T=0$, so $u(N) = \\mathbb{E}_N[T] = 0$.\n\nThus, the expected absorption time $u(i)$ satisfies the second-order linear non-homogeneous difference equation\n$$ p \\cdot u(i+1) - u(i) + q \\cdot u(i-1) = -1 $$\nwith boundary conditions $u(0) = 0$ and $u(N) = 0$.\n\n**Part 2: Solution of the Recurrence Relation for $p \\neq \\frac{1}{2}$**\n\nThe solution $u(i)$ is the sum of the general solution to the homogeneous equation, $u_h(i)$, and a particular solution to the non-homogeneous equation, $u_p(i)$.\n\n1.  **Homogeneous Solution:**\n    The homogeneous equation is $p \\cdot u_h(i+1) - u_h(i) + q \\cdot u_h(i-1) = 0$. We assume a solution of the form $u_h(i) = r^i$. Substituting this into the equation yields the characteristic equation:\n    $$ p \\cdot r^{i+1} - r^i + q \\cdot r^{i-1} = 0 $$\n    Dividing by $r^{i-1}$ (for $r \\neq 0$), we get:\n    $$ p r^2 - r + q = 0 $$\n    This is a quadratic equation for $r$. We can factor it as $(pr-q)(r-1)=0$.\n    The roots are $r_1 = 1$ and $r_2 = \\frac{q}{p}$.\n    Since the problem states $p \\neq \\frac{1}{2}$, it follows that $p \\neq q$, and therefore the roots are distinct ($r_1 \\neq r_2$).\n    The general solution to the homogeneous equation is a linear combination of the solutions corresponding to these roots:\n    $$ u_h(i) = A \\cdot (r_1)^i + B \\cdot (r_2)^i = A + B \\left(\\frac{q}{p}\\right)^i $$\n    where $A$ and $B$ are constants to be determined.\n\n2.  **Particular Solution:**\n    The non-homogeneous equation is $p \\cdot u(i+1) - u(i) + q \\cdot u(i-1) = -1$.\n    Since the non-homogeneous term is a constant, one might guess a constant particular solution. However, since $r_1=1$ is a root of the characteristic equation, a constant is part of the homogeneous solution. Therefore, we must try a particular solution of the form $u_p(i) = C \\cdot i$.\n    Substituting this into the non-homogeneous equation:\n    $$ p C(i+1) - Ci + q C(i-1) = -1 $$\n    $$ C [p(i+1) - i + q(i-1)] = -1 $$\n    $$ C [pi + p - i + qi - q] = -1 $$\n    $$ C [(p+q-1)i + (p-q)] = -1 $$\n    Since $p+q = 1$, the term multiplying $i$ is zero. This leaves:\n    $$ C(p-q) = -1 $$\n    Thus, $C = \\frac{-1}{p-q} = \\frac{1}{q-p}$.\n    A particular solution is $u_p(i) = \\frac{i}{q-p}$.\n\n3.  **General Solution and Boundary Conditions:**\n    The general solution is $u(i) = u_h(i) + u_p(i)$:\n    $$ u(i) = A + B \\left(\\frac{q}{p}\\right)^i + \\frac{i}{q-p} $$\n    Now we apply the boundary conditions $u(0)=0$ and $u(N)=0$ to find $A$ and $B$.\n    For $i=0$:\n    $$ u(0) = A + B \\left(\\frac{q}{p}\\right)^0 + \\frac{0}{q-p} = A + B = 0 \\implies A = -B $$\n    For $i=N$:\n    $$ u(N) = A + B \\left(\\frac{q}{p}\\right)^N + \\frac{N}{q-p} = 0 $$\n    Substitute $A = -B$ into the second equation:\n    $$ -B + B \\left(\\frac{q}{p}\\right)^N + \\frac{N}{q-p} = 0 $$\n    $$ B \\left[ \\left(\\frac{q}{p}\\right)^N - 1 \\right] = -\\frac{N}{q-p} $$\n    $$ B = \\frac{-N}{(q-p)\\left[\\left(\\frac{q}{p}\\right)^N - 1\\right]} = \\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} $$\n    And $A = -B = -\\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]}$.\n\n4.  **Final Expression:**\n    Substituting the expressions for $A$ and $B$ back into the general solution for $u(i)$:\n    $$ u(i) = -\\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} + \\frac{N}{(q-p)\\left[1 - \\left(\\frac{q}{p}\\right)^N\\right]} \\left(\\frac{q}{p}\\right)^i + \\frac{i}{q-p} $$\n    We can factor out the term $\\frac{1}{q-p}$:\n    $$ u(i) = \\frac{1}{q-p} \\left[ i + \\frac{N\\left(\\frac{q}{p}\\right)^i - N}{1 - \\left(\\frac{q}{p}\\right)^N} \\right] $$\n    $$ u(i) = \\frac{1}{q-p} \\left[ i - \\frac{N\\left(1 - \\left(\\frac{q}{p}\\right)^i\\right)}{1 - \\left(\\frac{q}{p}\\right)^N} \\right] $$\n    This is the closed-form expression for the expected absorption time $u(i)$ when $p \\neq \\frac{1}{2}$. Note that $q-p = (1-p)-p = 1-2p$.", "answer": "$$ \\boxed{ \\frac{1}{q-p} \\left(i - N \\frac{1 - \\left(\\frac{q}{p}\\right)^i}{1 - \\left(\\frac{q}{p}\\right)^N}\\right) } $$", "id": "3056064"}]}