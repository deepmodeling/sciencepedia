{"hands_on_practices": [{"introduction": "To appreciate the challenges posed by stiff equations, we first examine the behavior of a simple explicit method, the Forward Euler method. While straightforward to implement, its stability is conditional and depends critically on the chosen step size $h$. This first practice [@problem_id:2202562] has you calculate the maximum stable step size for a model problem, revealing the severe limitations explicit methods face when dealing with systems containing fast-decaying components.", "problem": "Consider the radioactive decay of a certain unstable isotope. The number of undecayed atoms, $N(t)$, at a time $t$ is modeled by the first-order linear ordinary differential equation:\n$$\n\\frac{dN}{dt} = -\\lambda N(t)\n$$\nwhere $\\lambda$ is the positive decay constant. For this particular isotope, the decay constant is given as $\\lambda = 120 \\text{ s}^{-1}$.\n\nAn analyst wishes to simulate this decay process using the Forward Euler method, which approximates the solution at discrete time steps. A numerical solution $N_k$ that approximates $N(t_k)$ at time $t_k = k h$ is generated by the iterative formula $N_{k+1} = N_k + h \\cdot \\left(\\frac{dN}{dt}\\right)\\bigg|_{t=t_k, N=N_k}$, where $h$ is the time step.\n\nFor the numerical solution to remain stable and not exhibit unphysical, growing oscillations, the step size $h$ must be chosen below a certain maximum value. Determine this maximum allowable step size, $h_{max}$.\n\nExpress your answer for $h_{max}$ in units of seconds, as a simplified fraction.", "solution": "We model the decay by the linear ODE $\\,\\frac{dN}{dt}=-\\lambda N\\,$ with $\\lambda0$. Applying the Forward Euler method with step size $h$ gives the update\n$$\nN_{k+1}=N_{k}+h\\left(-\\lambda N_{k}\\right)=(1-h\\lambda)N_{k}.\n$$\nThis is a linear recurrence with amplification factor $G=1-h\\lambda$. For the numerical solution to be stable and not grow in magnitude, we require $|G|1$, i.e.,\n$$\n|1-h\\lambda|1.\n$$\nSolving this inequality,\n$$\n-11-h\\lambda1 \\;\\;\\Longrightarrow\\;\\; -2-h\\lambda0 \\;\\;\\Longrightarrow\\;\\; 0h\\lambda2.\n$$\nHence the maximum allowable step size for stability is\n$$\nh_{\\max}=\\frac{2}{\\lambda}.\n$$\nSubstituting the given $\\lambda=120$, we obtain\n$$\nh_{\\max}=\\frac{2}{120}=\\frac{1}{60}.\n$$\nTherefore, expressed in seconds as a simplified fraction, $h_{\\max}=\\frac{1}{60}$.", "answer": "$$\\boxed{\\frac{1}{60}}$$", "id": "2202562"}, {"introduction": "In contrast to the conditional stability of explicit methods, implicit methods offer a robust solution for stiff systems. To understand why, we analyze the stability of the simplest implicit scheme, the Backward Euler method. By deriving its amplification factor in this exercise [@problem_id:2202564], you will uncover the mathematical reason for its excellent stability properties, which allow it to handle stiff problems with much larger time steps.", "problem": "In the analysis of numerical methods for ordinary differential equations, the stability of a method is often investigated by applying it to a simple test problem. Consider the scalar linear test problem given by the differential equation:\n$$\n\\frac{dy}{dt} = \\lambda y\n$$\nwhere $y(t)$ is the function to be solved for, and $\\lambda$ is a given, potentially complex, constant.\n\nA numerical solution can be generated using a discrete time-stepping scheme. The Backward Euler method is a first-order implicit method defined by the following recurrence relation:\n$$\ny_{n+1} = y_n + h f(t_{n+1}, y_{n+1})\n$$\nwhere $y_n$ is the numerical approximation of $y(t_n)$, $h$ is the constant step size ($h = t_{n+1} - t_n$), and $f(t,y) = \\frac{dy}{dt}$.\n\nFor the given test problem, the ratio $R = y_{n+1}/y_n$ is known as the amplification factor. This factor dictates how the numerical solution's magnitude changes from one step to the next. Determine the expression for this amplification factor $R$ in terms of the step size $h$ and the constant $\\lambda$.", "solution": "We consider the scalar linear test problem $y^{\\prime}=\\lambda y$ and apply the Backward Euler method, which is defined by\n$$\ny_{n+1}=y_{n}+h\\,f(t_{n+1},y_{n+1}).\n$$\nFor the given test problem, $f(t,y)=\\lambda y$, so substituting into the scheme yields\n$$\ny_{n+1}=y_{n}+h\\,\\lambda\\,y_{n+1}.\n$$\nRearranging to isolate $y_{n+1}$ on the left-hand side gives\n$$\n(1-h\\lambda)\\,y_{n+1}=y_{n}.\n$$\nSolving for the ratio $R=y_{n+1}/y_{n}$ (with the understanding that $1-h\\lambda\\neq 0$) gives\n$$\n\\frac{y_{n+1}}{y_{n}}=\\frac{1}{1-h\\lambda}.\n$$\nTherefore, the amplification factor is\n$$\nR=\\frac{1}{1-h\\lambda}.\n$$", "answer": "$$\\boxed{\\frac{1}{1-h\\lambda}}$$", "id": "2202564"}, {"introduction": "The superior stability of implicit methods comes at a computational cost, particularly for nonlinear ODEs. An implicit step requires solving an algebraic equation for the solution at the next time point, rather than calculating it directly. This exercise [@problem_id:2202596] challenges you to apply the trapezoidal rule to a nonlinear equation, illustrating how to formulate the implicit problem that must be solved at each time step.", "problem": "Consider the first-order ordinary differential equation (ODE) given by $y'(t) = \\sin(t) - e^{y(t)}$. We wish to approximate the solution to this ODE using the trapezoidal rule. The trapezoidal rule for a generic ODE $y'(t) = f(t, y)$ is given by the formula:\n$$\ny_{n+1} = y_n + \\frac{h}{2} \\left[ f(t_n, y_n) + f(t_{n+1}, y_{n+1}) \\right]\n$$\nHere, $y_n$ is the numerical approximation of the solution $y(t)$ at time $t_n$, $h$ is a constant step size, and $t_{n+1} = t_n + h$.\n\nApplying this rule to the specified ODE results in an implicit algebraic equation that must be solved for $y_{n+1}$. By moving all terms to one side, this equation can be expressed in the form $F(y_{n+1}, y_n, t_n, h) = 0$.\n\nDetermine the expression for $F(y_{n+1}, y_n, t_n, h)$.", "solution": "We have the ODE $y'(t)=\\sin(t)-\\exp(y(t))$, so $f(t,y)=\\sin(t)-\\exp(y)$. The trapezoidal rule for $y'(t)=f(t,y)$ with step size $h$ is\n$$\ny_{n+1}=y_{n}+\\frac{h}{2}\\left[f(t_{n},y_{n})+f(t_{n+1},y_{n+1})\\right],\n$$\nwhere $t_{n+1}=t_{n}+h$. Substituting $f(t,y)=\\sin(t)-\\exp(y)$ gives\n$$\ny_{n+1}=y_{n}+\\frac{h}{2}\\left[\\sin(t_{n})-\\exp(y_{n})+\\sin(t_{n+1})-\\exp(y_{n+1})\\right].\n$$\nUsing $t_{n+1}=t_{n}+h$ and moving all terms to the left-hand side produces the implicit equation\n$$\ny_{n+1}-y_{n}-\\frac{h}{2}\\left[\\sin(t_{n})-\\exp(y_{n})+\\sin(t_{n}+h)-\\exp(y_{n+1})\\right]=0.\n$$\nTherefore, the function $F(y_{n+1},y_{n},t_{n},h)$ is\n$$\nF(y_{n+1},y_{n},t_{n},h)=y_{n+1}-y_{n}-\\frac{h}{2}\\left[\\sin(t_{n})-\\exp(y_{n})+\\sin(t_{n}+h)-\\exp(y_{n+1})\\right].\n$$", "answer": "$$\\boxed{y_{n+1}-y_{n}-\\frac{h}{2}\\left[\\sin(t_{n})-\\exp(y_{n})+\\sin(t_{n}+h)-\\exp(y_{n+1})\\right]}$$", "id": "2202596"}]}