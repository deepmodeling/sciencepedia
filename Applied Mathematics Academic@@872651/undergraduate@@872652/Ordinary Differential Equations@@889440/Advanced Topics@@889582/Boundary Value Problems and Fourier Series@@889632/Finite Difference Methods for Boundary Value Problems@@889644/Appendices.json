{"hands_on_practices": [{"introduction": "Let's begin with a foundational exercise that walks through the entire finite difference method from beginning to end. By tackling a simple second-order boundary value problem, you will see firsthand how to discretize the domain, apply the finite difference approximation to the derivative, and construct a system of linear equations. Solving this small system by hand will solidify your understanding of how a differential equation is transformed into an algebraic problem. [@problem_id:2173554]", "problem": "Consider the second-order linear Boundary Value Problem (BVP) given by the ordinary differential equation:\n$$ y'' + y = 0 $$\nThis equation is defined on the interval $x \\in [0, 1]$ and is subject to the boundary conditions $y(0) = 0$ and $y(1) = 2$.\n\nYou are tasked with finding a numerical approximation to the solution of this BVP using the finite difference method. For this purpose, the domain $[0, 1]$ is to be discretized with a uniform step size of $h = 1/3$. The second derivative, $y''$, at any interior grid point $x_i$ should be approximated using the second-order central difference formula:\n$$ y''(x_i) \\approx \\frac{y_{i+1} - 2y_i + y_{i-1}}{h^2} $$\nwhere $y_i$ represents the numerical approximation of the true solution $y(x)$ at the grid point $x_i$.\n\nBy applying this method, set up and solve the resulting system of linear algebraic equations for the unknown values of the solution at the interior grid points.\n\nExpress your final answer as the numerical approximations for $y(1/3)$ and $y(2/3)$, in that order. The values must be given as exact fractions.", "solution": "We discretize the interval $[0,1]$ with uniform step size $h=1/3$, giving the grid points $x_{0}=0$, $x_{1}=1/3$, $x_{2}=2/3$, $x_{3}=1$. Denote $y_{i}\\approx y(x_{i})$, with boundary values $y_{0}=0$ and $y_{3}=2$. The interior unknowns are $y_{1}$ and $y_{2}$.\n\nThe differential equation is $y''+y=0$. Using the second-order central difference for $y''$ at an interior point $x_{i}$,\n$$\ny''(x_{i}) \\approx \\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}},\n$$\nwe obtain, for $i=1,2$,\n$$\n\\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}}+y_{i}=0.\n$$\nMultiplying by $h^{2}$ and substituting $h^{2}=1/9$ gives\n$$\ny_{i+1}-2y_{i}+y_{i-1}+\\frac{1}{9}y_{i}=0,\n$$\nwhich simplifies to\n$$\ny_{i-1}-\\frac{17}{9}y_{i}+y_{i+1}=0.\n$$\n\nWriting the equations at $i=1$ and $i=2$ and inserting boundary values:\n- For $i=1$: $y_{0}-\\frac{17}{9}y_{1}+y_{2}=0 \\implies -\\frac{17}{9}y_{1}+y_{2}=0$ since $y_{0}=0$.\n- For $i=2$: $y_{1}-\\frac{17}{9}y_{2}+y_{3}=0 \\implies y_{1}-\\frac{17}{9}y_{2}=-y_{3}=-2$.\n\nThus the linear system for $(y_{1},y_{2})^{T}$ is\n$$\n\\begin{pmatrix}\n-\\frac{17}{9} & 1 \\\\\n1 & -\\frac{17}{9}\n\\end{pmatrix}\n\\begin{pmatrix}\ny_{1} \\\\\ny_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n-2\n\\end{pmatrix}.\n$$\nFrom the first equation, $y_{2}=\\frac{17}{9}y_{1}$. Substitute into the second:\n$$\ny_{1}-\\frac{17}{9}\\left(\\frac{17}{9}y_{1}\\right)=-2\n\\;\\;\\Longrightarrow\\;\\;\n\\left(1-\\frac{289}{81}\\right)y_{1}=-2\n\\;\\;\\Longrightarrow\\;\\;\n-\\frac{208}{81}y_{1}=-2.\n$$\nSolving gives\n$$\ny_{1}=\\frac{2\\cdot 81}{208}=\\frac{162}{208}=\\frac{81}{104}.\n$$\nThen\n$$\ny_{2}=\\frac{17}{9}y_{1}=\\frac{17}{9}\\cdot \\frac{81}{104}=\\frac{153}{104}.\n$$\nTherefore, the required approximations are $y(1/3)=\\frac{81}{104}$ and $y(2/3)=\\frac{153}{104}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{81}{104} & \\frac{153}{104} \\end{pmatrix}}$$", "id": "2173554"}, {"introduction": "In practice, boundary value problems often include a source term, represented by a function $f(x)$ on the right-hand side of the differential equation. This exercise focuses specifically on how this source term is incorporated into the finite difference scheme. You will practice setting up the right-hand side vector, $\\vec{b}$, in the matrix equation $A\\vec{y} = \\vec{b}$, which is a crucial step in correctly modeling physical systems with external forces or sources. [@problem_id:2173530]", "problem": "Consider the two-point boundary value problem defined by the ordinary differential equation $y''(x) = x^3$ on the interval $x \\in [0, 1]$, with boundary conditions $y(0) = 0$ and $y(1) = 0$.\n\nWe seek an approximate solution to this problem using the finite difference method. The interval $[0, 1]$ is divided into $n=5$ equal subintervals, creating a set of discrete grid points $x_i = i \\cdot h$ for $i = 0, 1, 2, 3, 4, 5$, where $h$ is the step size. Let $y_i$ be the approximation of the solution $y(x_i)$ at each grid point. The second derivative $y''(x_i)$ is approximated by the central difference formula:\n$$y''(x_i) \\approx \\frac{y_{i+1} - 2y_i + y_{i-1}}{h^2}$$\nApplying this approximation at each interior grid point ($i=1, 2, 3, 4$) results in a system of linear equations. This system is rearranged to group all terms involving the unknown values ($y_1, y_2, y_3, y_4$) on the left side, and all known quantities on the right side. The resulting system is written in matrix form as $A\\vec{y} = \\vec{b}$, where $\\vec{y} = (y_1, y_2, y_3, y_4)^T$.\n\nDetermine the components of the right-hand side vector $\\vec{b}$. Express your answer as a row matrix containing the components of $\\vec{b}$ in order, which correspond to the equations for $i=1, 2, 3, 4$.", "solution": "We discretize the interval with $n=5$ equal subintervals, so the step size is $h=\\frac{1}{5}$ and the grid points are $x_{i}=i h=\\frac{i}{5}$ for $i=0,1,2,3,4,5$. At each interior point $i=1,2,3,4$, we approximate the second derivative by the central difference formula\n$$\n\\frac{y_{i+1}-2y_{i}+y_{i-1}}{h^{2}}=x_{i}^{3}.\n$$\nMultiplying by $h^{2}$ gives\n$$\ny_{i+1}-2y_{i}+y_{i-1}=h^{2}x_{i}^{3}.\n$$\nTo form the linear system $A\\vec{y}=\\vec{b}$ with $\\vec{y}=(y_{1},y_{2},y_{3},y_{4})^{T}$, we group the unknowns on the left and move any known boundary values to the right. For $i=1$,\n$$\ny_{2}-2y_{1}+y_{0}=h^{2}x_{1}^{3}\\;\\;\\Longrightarrow\\;\\;-2y_{1}+y_{2}=h^{2}x_{1}^{3}-y_{0}.\n$$\nFor $i=2$ and $i=3$, no boundary values appear:\n$$\ny_{3}-2y_{2}+y_{1}=h^{2}x_{2}^{3},\\qquad y_{4}-2y_{3}+y_{2}=h^{2}x_{3}^{3}.\n$$\nFor $i=4$,\n$$\ny_{5}-2y_{4}+y_{3}=h^{2}x_{4}^{3}\\;\\;\\Longrightarrow\\;\\;y_{3}-2y_{4}=h^{2}x_{4}^{3}-y_{5}.\n$$\nWith the Dirichlet boundary conditions $y_{0}=0$ and $y_{5}=0$, the right-hand side components reduce to\n$$\nb_{i}=h^{2}x_{i}^{3}\\quad\\text{for}\\quad i=1,2,3,4.\n$$\nUsing $h=\\frac{1}{5}$ and $x_{i}=\\frac{i}{5}$, we have $h^{2}=\\frac{1}{25}$ and $x_{i}^{3}=\\frac{i^{3}}{125}$, so\n$$\nb_{i}=h^{2}x_{i}^{3}=\\frac{1}{25}\\cdot\\frac{i^{3}}{125}=\\frac{i^{3}}{3125},\\quad i=1,2,3,4.\n$$\nTherefore,\n$$\n\\vec{b}=\\begin{pmatrix}\\frac{1}{3125} & \\frac{8}{3125} & \\frac{27}{3125} & \\frac{64}{3125}\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{3125} & \\frac{8}{3125} & \\frac{27}{3125} & \\frac{64}{3125}\\end{pmatrix}}$$", "id": "2173530"}, {"introduction": "Many real-world problems involve boundary conditions on the derivative of a function, such as specifying heat flux or fluid velocity, rather than just the function's value. This practice introduces a powerful technique for handling these Neumann boundary conditions using a \"ghost point\". You will learn how to extend the grid beyond the physical domain to enforce the derivative condition, a key skill for applying the finite difference method to a wider range of engineering and physics problems. [@problem_id:2173551]", "problem": "Consider the following second-order ordinary differential equation which models a steady-state heat distribution in a rod with an internal heat source and heat loss along its length:\n$$ y''(x) - 2y(x) = 4x $$\nThe rod spans the domain $x \\in [0, 1]$. The temperature at the left end is fixed, while the right end experiences a specified heat flux. These conditions are given by the boundary values:\n$$ y(0) = 1, \\quad y'(1) = -3 $$\nWe wish to find an approximate numerical solution to this boundary value problem using the finite difference method. The domain $[0, 1]$ is discretized into $n=4$ uniform subintervals, creating a set of grid points $x_i = i h$ for $i=0, 1, 2, 3, 4$, where $h$ is the step size. Let $y_i$ denote the approximate value of $y(x_i)$.\n\nUse the following standard central difference approximations:\n- For the second derivative: $y''(x_i) \\approx \\frac{y_{i-1} - 2y_i + y_{i+1}}{h^2}$\n- For the first derivative: $y'(x_i) \\approx \\frac{y_{i+1} - y_{i-1}}{2h}$\n\nTo handle the derivative boundary condition at $x_4 = 1$, a \"ghost point\" at $x_5 = x_4 + h$ is introduced. The value at this point, $y_5$, is then eliminated from the system of equations.\n\nThis process results in a system of linear algebraic equations for the unknown values $y_1, y_2, y_3,$ and $y_4$. Determine the specific linear equation that corresponds to the grid point $x_4 = 1$.\n\nWhich of the following equations correctly represents the finite difference approximation at $x_4 = 1$ after eliminating the ghost point?\n\nA. $16y_3 - 17y_4 = 14$\n\nB. $16y_3 - 17y_4 = 8$\n\nC. $16y_3 - 17y_4 = -10$\n\nD. $16y_3 + 15y_4 = 14$\n\nE. $8y_3 - 8y_4 = 7$", "solution": "We discretize the domain $[0,1]$ with $n=4$ uniform subintervals, so the step size is $h=\\frac{1-0}{4}=\\frac{1}{4}$. The grid points are $x_{i}=ih$, hence $x_{4}=1$.\n\nAt $x_{4}=1$, we discretize the differential equation $y''(x)-2y(x)=4x$ using the central difference for the second derivative:\n$$\n\\frac{y_{3}-2y_{4}+y_{5}}{h^{2}}-2y_{4}=4x_{4}.\n$$\nSince $x_{4}=1$, the right-hand side is $4$:\n$$\n\\frac{y_{3}-2y_{4}+y_{5}}{h^{2}}-2y_{4}=4.\n$$\n\nTo eliminate the ghost point $y_{5}$, we use the Neumann boundary condition at $x_{4}=1$, $y'(1)=-3$, with the central difference approximation for the first derivative:\n$$\n\\frac{y_{5}-y_{3}}{2h}=-3 \\quad \\Longrightarrow \\quad y_{5}=y_{3}-6h.\n$$\nWith $h=\\frac{1}{4}$, we obtain\n$$\ny_{5}=y_{3}-\\frac{3}{2}.\n$$\n\nSubstitute this into the discretized equation at $x_{4}$:\n$$\n\\frac{y_{3}-2y_{4}+\\left(y_{3}-\\frac{3}{2}\\right)}{h^{2}}-2y_{4}=4.\n$$\nSince $h^{2}=\\frac{1}{16}$, we have $\\frac{1}{h^{2}}=16$, so\n$$\n16\\left(2y_{3}-2y_{4}-\\frac{3}{2}\\right)-2y_{4}=4.\n$$\nThis simplifies to\n$$\n32y_{3}-32y_{4}-24-2y_{4}=4 \\quad \\Longrightarrow \\quad 32y_{3}-34y_{4}=28.\n$$\nDividing by $2$ gives\n$$\n16y_{3}-17y_{4}=14,\n$$\nwhich matches option A.", "answer": "$$\\boxed{A}$$", "id": "2173551"}]}