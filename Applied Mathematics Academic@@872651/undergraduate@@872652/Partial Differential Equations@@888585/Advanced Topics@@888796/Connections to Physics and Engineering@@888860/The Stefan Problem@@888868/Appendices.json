{"hands_on_practices": [{"introduction": "One of the most elegant analytical tools for the Stefan problem is the similarity solution, often credited to Neumann. This approach is powerful for problems with specific symmetries, such as the one-dimensional solidification of a semi-infinite material. By assuming the temperature profile depends on a single similarity variable $\\eta = x/(2\\sqrt{\\alpha t})$, the heat equation is transformed from a partial differential equation into a more manageable ordinary differential equation. This practice [@problem_id:2150476] challenges you to apply this framework and the Stefan condition to derive the fundamental transcendental equation that governs the solidification rate, connecting the dimensionless interface position $\\lambda$ to the physical properties of the material via the Stefan number.", "problem": "Consider the one-dimensional solidification of a semi-infinite body of pure molten metal, initially at its uniform melting temperature $T_m$. At time $t=0$, the surface at $x=0$ is cooled to a constant temperature $T_0  T_m$. A solidification front, or interface, at position $x=s(t)$ moves into the liquid region ($x>0$).\n\nThe temperature profile in the newly formed solid phase ($0 \\le x \\le s(t)$) is given by:\n$$ T_s(x,t) = T_0 + (T_m - T_0) \\frac{\\mathrm{erf}\\left(\\frac{x}{2\\sqrt{\\alpha_s t}}\\right)}{\\mathrm{erf}(\\lambda)} $$\nThe position of the interface is described by:\n$$ s(t) = 2\\lambda\\sqrt{\\alpha_s t} $$\nwhere $\\lambda$ is a dimensionless constant, $\\alpha_s$ is the thermal diffusivity of the solid, and $\\mathrm{erf}(z)$ is the error function defined as $\\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_0^z \\exp(-u^2)du$.\n\nThe movement of the interface is governed by the Stefan condition, which represents an energy balance at the solidification front:\n$$ \\rho L_f \\frac{ds}{dt} = k_s \\frac{\\partial T_s}{\\partial x}\\bigg|_{x=s(t)} $$\nHere, $\\rho$ is the density (assumed constant), $L_f$ is the latent heat of fusion per unit mass, and $k_s$ is the thermal conductivity of the solid. The thermal diffusivity and conductivity are related by $\\alpha_s = k_s / (\\rho c_s)$, where $c_s$ is the specific heat capacity of the solid.\n\nBy substituting the expressions for $T_s(x,t)$ and $s(t)$ into the Stefan condition, one can derive a transcendental equation for $\\lambda$. This equation can be written in the form $F(\\lambda) = S$, where $S = \\frac{c_s(T_m-T_0)}{L_f}$ is the Stefan number, a dimensionless quantity representing the ratio of sensible heat to latent heat.\n\nYour task is to determine the function $F(\\lambda)$.", "solution": "We start from the given temperature profile in the solid:\n$$T_{s}(x,t)=T_{0}+(T_{m}-T_{0})\\frac{\\mathrm{erf}\\!\\left(\\frac{x}{2\\sqrt{\\alpha_{s}t}}\\right)}{\\mathrm{erf}(\\lambda)}.$$\nDefine the similarity variable $\\eta=\\frac{x}{2\\sqrt{\\alpha_{s}t}}$. Then\n$$\\frac{\\partial T_{s}}{\\partial x}=\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\frac{\\mathrm{d}}{\\mathrm{d}x}\\mathrm{erf}(\\eta)=\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{2}{\\sqrt{\\pi}}\\exp(-\\eta^{2})\\cdot\\frac{\\partial \\eta}{\\partial x}.$$\nUsing $\\frac{\\partial \\eta}{\\partial x}=\\frac{1}{2\\sqrt{\\alpha_{s}t}}$ gives\n$$\\frac{\\partial T_{s}}{\\partial x}=\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{1}{\\sqrt{\\pi}\\sqrt{\\alpha_{s}t}}\\exp(-\\eta^{2}).$$\nEvaluated at the interface $x=s(t)=2\\lambda\\sqrt{\\alpha_{s}t}$, we have $\\eta=\\lambda$, hence\n$$\\left.\\frac{\\partial T_{s}}{\\partial x}\\right|_{x=s(t)}=\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{1}{\\sqrt{\\pi}\\sqrt{\\alpha_{s}t}}\\exp(-\\lambda^{2}).$$\n\nNext, from $s(t)=2\\lambda\\sqrt{\\alpha_{s}t}$, the interface speed is\n$$\\frac{\\mathrm{d}s}{\\mathrm{d}t}=2\\lambda\\sqrt{\\alpha_{s}}\\cdot\\frac{1}{2}t^{-1/2}=\\lambda\\sqrt{\\alpha_{s}}\\,t^{-1/2}.$$\n\nSubstitute these into the Stefan condition\n$$\\rho L_{f}\\frac{\\mathrm{d}s}{\\mathrm{d}t}=k_{s}\\left.\\frac{\\partial T_{s}}{\\partial x}\\right|_{x=s(t)}.$$\nThis yields\n$$\\rho L_{f}\\,\\lambda\\sqrt{\\alpha_{s}}\\,t^{-1/2}=k_{s}\\cdot\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{1}{\\sqrt{\\pi}\\sqrt{\\alpha_{s}}\\,t^{1/2}}\\exp(-\\lambda^{2}).$$\nCancel the common factor $t^{-1/2}$ and multiply both sides by $\\sqrt{\\alpha_{s}}$:\n$$\\rho L_{f}\\,\\lambda\\alpha_{s}=k_{s}\\cdot\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{1}{\\sqrt{\\pi}}\\exp(-\\lambda^{2}).$$\nUsing $\\alpha_{s}=\\frac{k_{s}}{\\rho c_{s}}$ gives\n$$\\frac{k_{s}\\lambda L_{f}}{c_{s}}=k_{s}\\cdot\\frac{T_{m}-T_{0}}{\\mathrm{erf}(\\lambda)}\\cdot\\frac{1}{\\sqrt{\\pi}}\\exp(-\\lambda^{2}).$$\nCancel $k_{s}$ and rearrange to isolate the Stefan number $S=\\frac{c_{s}(T_{m}-T_{0})}{L_{f}}$:\n$$\\lambda=\\frac{c_{s}(T_{m}-T_{0})}{L_{f}}\\cdot\\frac{\\exp(-\\lambda^{2})}{\\sqrt{\\pi}\\,\\mathrm{erf}(\\lambda)} \\quad\\Longrightarrow\\quad S=\\sqrt{\\pi}\\,\\lambda\\,\\exp(\\lambda^{2})\\,\\mathrm{erf}(\\lambda).$$\n\nTherefore, the function $F(\\lambda)$ satisfying $F(\\lambda)=S$ is\n$$F(\\lambda)=\\sqrt{\\pi}\\,\\lambda\\,\\exp(\\lambda^{2})\\,\\mathrm{erf}(\\lambda).$$", "answer": "$$\\boxed{\\sqrt{\\pi}\\,\\lambda\\,\\exp(\\lambda^{2})\\,\\mathrm{erf}(\\lambda)}$$", "id": "2150476"}, {"introduction": "While exact analytical solutions are insightful, they are limited to highly idealized scenarios. For many practical problems, especially in higher dimensions, we turn to powerful approximation methods. The quasi-steady state approximation is a prime example, applicable when the interface moves slowly compared to the time it takes for heat to diffuse through the medium. In this practice [@problem_id:2150475], you will apply this technique to a classic and intuitive problem: a spherical hailstone melting in warm water. By treating the temperature field in the water as being in a steady state at each instant, you can derive a simple differential equation for the sphere's radius and calculate the total time it takes to melt.", "problem": "A spherical hailstone with an initial radius of $R_0$ is placed into a large, well-mixed bath of water maintained at a constant temperature $T_w$. The hailstone is composed of ice, which is at its melting temperature, $T_m$, where $T_w > T_m$. As the hailstone melts, its radius decreases over time.\n\nWe are given the following physical parameters:\n- The density of the ice is $\\rho$.\n- The latent heat of fusion for ice is $L$.\n- The thermal conductivity of the surrounding water is $k$.\n\nTo simplify the analysis, make the following key assumption, often known as the quasi-steady state approximation: at any given moment in time, the temperature distribution in the water surrounding the receding ice sphere can be treated as if it were in a steady state for the current radius of the sphere. Furthermore, assume that the water bath is infinitely large, so the temperature far from the hailstone is always $T_w$.\n\nDerive a closed-form analytic expression for the total time, $T_{\\text{final}}$, it takes for the hailstone to melt completely. Your expression should be in terms of $R_0$, $T_w$, $T_m$, $\\rho$, $L$, and $k$.", "solution": "Let the instantaneous ice radius be $R(t)$. Under the quasi-steady assumption, the temperature field in the water satisfies the steady, spherically symmetric Laplace equation,\n$$\n\\frac{1}{r^{2}}\\frac{d}{dr}\\!\\left(r^{2}\\frac{dT}{dr}\\right)=0,\n$$\nwith boundary conditions $T(\\infty)=T_{w}$ and $T(R)=T_{m}$. The general solution is $T(r)=A+\\frac{B}{r}$. Applying the boundary conditions gives $A=T_{w}$ and $B=R\\,(T_{m}-T_{w})$, hence\n$$\nT(r)=T_{w}-\\left(T_{w}-T_{m}\\right)\\frac{R}{r}.\n$$\nThe radial temperature gradient is\n$$\n\\frac{dT}{dr}=\\frac{R\\left(T_{w}-T_{m}\\right)}{r^{2}},\n$$\nso the radial heat flux (Fourierâ€™s law) at the interface $r=R$ is\n$$\nq_{r}(R)=-k\\frac{dT}{dr}\\Big|_{r=R}=-k\\,\\frac{T_{w}-T_{m}}{R}.\n$$\nThe total heat rate conducted into the interface is the inward flux magnitude times the area,\n$$\n\\dot{Q}=4\\pi R^{2}\\left(\\frac{k\\left(T_{w}-T_{m}\\right)}{R}\\right)=4\\pi k R\\left(T_{w}-T_{m}\\right).\n$$\nThis heat melts ice and is consumed as latent heat. The solid mass is $m=\\rho \\frac{4}{3}\\pi R^{3}$, so the melting rate is $-\\frac{dm}{dt}=-\\rho 4\\pi R^{2}\\frac{dR}{dt}$ (positive since $dR/dt0$). Energy balance (Stefan condition) gives\n$$\n\\dot{Q}=L\\!\\left(-\\frac{dm}{dt}\\right)=L\\left(-\\rho 4\\pi R^{2}\\frac{dR}{dt}\\right),\n$$\nhence\n$$\n4\\pi k R\\left(T_{w}-T_{m}\\right)=-4\\pi \\rho L R^{2}\\frac{dR}{dt}.\n$$\nCanceling $4\\pi R$ yields the ordinary differential equation\n$$\n\\frac{dR}{dt}=-\\frac{k\\left(T_{w}-T_{m}\\right)}{\\rho L}\\,\\frac{1}{R}.\n$$\nSeparate variables and integrate from $R(0)=R_{0}$ to $R(T_{\\text{final}})=0$:\n$$\n\\int_{R_{0}}^{0} R\\,dR=-\\frac{k\\left(T_{w}-T_{m}\\right)}{\\rho L}\\int_{0}^{T_{\\text{final}}} dt,\n$$\nwhich gives\n$$\n-\\frac{R_{0}^{2}}{2}=-\\frac{k\\left(T_{w}-T_{m}\\right)}{\\rho L}\\,T_{\\text{final}}.\n$$\nSolving for $T_{\\text{final}}$,\n$$\nT_{\\text{final}}=\\frac{\\rho L}{2k\\left(T_{w}-T_{m}\\right)}\\,R_{0}^{2}.\n$$\nThis is the closed-form melting time under the stated assumptions.", "answer": "$$\\boxed{\\frac{\\rho L R_{0}^{2}}{2k\\left(T_{w}-T_{m}\\right)}}$$", "id": "2150475"}, {"introduction": "The vast majority of real-world phase-change problems, involving complex geometries or material properties, defy analytical solutions. Here, numerical methods become indispensable. A particularly elegant and robust numerical approach is the enthalpy method, which reformulates the problem in terms of total heat content (enthalpy) instead of temperature. This practice [@problem_id:2112819] introduces this powerful technique, allowing you to sidestep the challenge of explicitly tracking the moving interface. By discretizing the enthalpy-based heat equation, you will perform a single time-step calculation to see how heat propagates and induces a phase change in a fixed-grid simulation.", "problem": "A long, one-dimensional rod made of a novel phase-change material is used in a thermal energy storage system. The material is initially in its solid state and uniformly at its melting temperature, $T_m = 0.00^\\circ \\text{C}$. At time $t=0$, one end of the rod, located at $x=0$, is placed in contact with a heat reservoir maintained at a constant temperature $T_b = 50.0^\\circ \\text{C}$. The rod is sufficiently long so that its far end remains unaffected during the short time interval of interest.\n\nThe melting process is modeled using an enthalpy-based formulation on a fixed spatial grid. The evolution of the volumetric enthalpy, $H(x,t)$, is governed by the heat equation:\n$$\n\\frac{\\partial H}{\\partial t} = k \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $T$ is the temperature and $k$ is the thermal conductivity of the material, which is assumed to be constant in both solid and liquid phases.\n\nThe relationship between temperature $T$ and the volumetric enthalpy $H$ (defined relative to the solid state at $T_m$) is given by:\n$$\nT(H) = \\begin{cases} T_m  \\text{if } H \\le L_v \\\\ T_m + \\frac{H - L_v}{C_v}  \\text{if } H  L_v \\end{cases}\n$$\nwhere $L_v$ is the volumetric latent heat of fusion and $C_v$ is the volumetric heat capacity of the liquid phase.\n\nTo solve the governing equation numerically, a fully implicit finite-difference scheme is employed. The spatial domain is discretized with a uniform grid spacing $\\Delta x$, and time is advanced in steps of $\\Delta t$. The time derivative is approximated using a first-order backward difference, and the spatial derivative is approximated with a second-order central difference.\n\nThe material properties and discretization parameters are as follows:\n- Thermal conductivity, $k = 2.00 \\text{ W/(m}\\cdot\\text{K)}$\n- Volumetric latent heat of fusion, $L_v = 1.00 \\times 10^7 \\text{ J/m}^3$\n- Volumetric heat capacity of the liquid, $C_v = 2.00 \\times 10^6 \\text{ J/(m}^3\\cdot\\text{K)}$\n- Grid spacing, $\\Delta x = 0.0100 \\text{ m}$\n- Time step, $\\Delta t = 20.0 \\text{ s}$\n\nUsing this numerical scheme, calculate the temperature at the first interior grid node, $x_1 = \\Delta x$, after the first time step (at $t = \\Delta t$). Express your answer in degrees Celsius, rounded to three significant figures.", "solution": "The governing equation is written in terms of the volumetric enthalpy as\n$$\n\\frac{\\partial H}{\\partial t}=k\\,\\frac{\\partial^{2}T}{\\partial x^{2}},\n$$\nwhile the constitutive relation between enthalpy and temperature is\n$$\nT(H)=\\begin{cases}\nT_{m},  H\\leq L_{v}, \\\\\nT_{m}+\\dfrac{H-L_{v}}{C_{v}},  HL_{v}.\n\\end{cases}\n$$\nOn a uniform grid with spacing $\\Delta x$ and a fully implicit time step $\\Delta t$, the backward-Euler/central-difference discretization at node $i$ reads\n$$\nH_{i}^{n+1}-H_{i}^{n}=\\lambda\\left(T_{i+1}^{n+1}-2T_{i}^{n+1}+T_{i-1}^{n+1}\\right),\n$$\nwhere\n$$\n\\lambda=\\frac{k\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\nInitially the rod is solid at $T_{m}$, and enthalpy is defined relative to the solid at $T_{m}$, so $H_{i}^{0}=0$ for all interior nodes. The boundary condition at $i=0$ is $T_{0}^{n+1}=T_{b}$ for $n\\geq 0$.\n\nWe seek $T_{1}^{1}$ after one time step. Let us assume the temperature at node $i=2$ remains at the melting point after the first step, $T_{2}^{1}=T_{m}$. This is consistent if $H_{2}^{1}\\leq L_{v}$, which will be verified a posteriori.\n\nAt node $i=1$ the discrete enthalpy equation is\n$$\nH_{1}^{1}=\\lambda\\left(T_{2}^{1}-2T_{1}^{1}+T_{0}^{1}\\right)=\\lambda\\left(T_{m}-2T_{1}^{1}+T_{b}\\right).\n$$\nIf $H_{1}^{1}\\leq L_{v}$, then $T_{1}^{1}=T_{m}$, which would give $H_{1}^{1}=\\lambda(T_{b}-T_{m})$. The condition for remaining on the melting plateau would be $\\lambda(T_{b}-T_{m})\\leq L_{v}$. Define\n$$\n\\lambda=\\frac{k\\,\\Delta t}{(\\Delta x)^{2}}.\n$$\nWith the given data, this yields $\\lambda(T_{b}-T_{m})L_{v}$ (checked numerically below), so node $1$ exceeds the latent heat and enters the liquid regime. Thus we use\n$$\nT_{1}^{1}=T_{m}+\\frac{H_{1}^{1}-L_{v}}{C_{v}}.\n$$\nSubstituting this into the discrete equation gives\n$$\nH_{1}^{1}=\\lambda\\left[T_{b}-T_{m}-\\frac{2}{C_{v}}\\left(H_{1}^{1}-L_{v}\\right)\\right].\n$$\nRearranging,\n$$\nH_{1}^{1}\\left(1+\\frac{2\\lambda}{C_{v}}\\right)=\\lambda(T_{b}-T_{m})+\\frac{2\\lambda}{C_{v}}L_{v},\n$$\nso\n$$\nH_{1}^{1}=\\frac{\\lambda\\left[(T_{b}-T_{m})C_{v}+2L_{v}\\right]}{C_{v}+2\\lambda}.\n$$\nTherefore,\n$$\nT_{1}^{1}=T_{m}+\\frac{H_{1}^{1}-L_{v}}{C_{v}}\n=T_{m}+\\frac{\\lambda(T_{b}-T_{m})-L_{v}}{C_{v}+2\\lambda}.\n$$\n\nNow evaluate numerically. Compute\n$$\n\\lambda=\\frac{k\\,\\Delta t}{(\\Delta x)^{2}}=\\frac{2.00\\times 20.0}{(0.0100)^{2}}=4.0\\times 10^{5},\n$$\nand note\n$$\n\\lambda(T_{b}-T_{m})=4.0\\times 10^{5}\\times 50.0=2.0\\times 10^{7}L_{v}=1.00\\times 10^{7},\n$$\nso the liquid-regime formula is applicable. Then\n$$\nT_{1}^{1}=0+\\frac{2.0\\times 10^{7}-1.00\\times 10^{7}}{2.00\\times 10^{6}+2\\times 4.0\\times 10^{5}}\n=\\frac{1.00\\times 10^{7}}{2.80\\times 10^{6}}\\approx 3.5714286.\n$$\nTo confirm consistency at node $i=2$,\n$$\nH_{2}^{1}=\\lambda\\left(T_{3}^{1}-2T_{2}^{1}+T_{1}^{1}\\right)=\\lambda\\left(T_{m}-2T_{m}+T_{1}^{1}\\right)=\\lambda\\left(T_{1}^{1}-T_{m}\\right)\\approx 4.0\\times 10^{5}\\times 3.5714286\\approx 1.43\\times 10^{6},\n$$\nwhich satisfies $H_{2}^{1}L_{v}$, hence $T_{2}^{1}=T_{m}$ is self-consistent. Thus the computed $T_{1}^{1}$ is valid.\n\nRounded to three significant figures, the temperature at $x_{1}=\\Delta x$ after one time step is $3.57$ degrees Celsius.", "answer": "$$\\boxed{3.57}$$", "id": "2112819"}]}