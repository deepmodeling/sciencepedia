{"hands_on_practices": [{"introduction": "Before applying any numerical scheme, it is crucial to understand its origin. This first practice moves beyond uniform grids to derive the finite difference approximation for the heat equation in a more general setting. By using Taylor series expansions on a non-uniform grid [@problem_id:2112780], you will construct the building blocks of an implicit scheme from first principles, a skill essential for tackling problems with complex geometries or adaptive meshing.", "problem": "A geophysicist is modeling the one-dimensional vertical diffusion of a chemical contaminant through a stratified soil column. The concentration of the contaminant at a vertical position $x$ and time $t$ is given by $u(x, t)$. The process is governed by the diffusion equation:\n$$\n\\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $D$ is the constant diffusion coefficient.\n\nTo solve this equation numerically, an implicit finite difference scheme is employed on a non-uniform spatial grid. Consider three adjacent grid points $x_{i-1}$, $x_i$, and $x_{i+1}$. The grid spacing is not constant; let the spacing to the left of $x_i$ be $h_L = x_i - x_{i-1}$ and the spacing to the right be $h_R = x_{i+1} - x_i$. The time steps are uniform with a duration of $\\Delta t$. We denote the numerical approximation of the concentration at grid point $x_i$ and time $t_n = n\\Delta t$ as $u_i^n$.\n\nThe backward-time, centered-space (BTCS) or fully implicit scheme is given by:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = D (u_{xx})_i^{n+1}\n$$\nwhere $(u_{xx})_i^{n+1}$ represents the finite difference approximation of the second spatial derivative at grid point $x_i$ and time level $n+1$.\n\nFirst, by using Taylor series expansions for $u(x_{i-1})$ and $u(x_{i+1})$ around the point $x_i$, derive a finite difference approximation for the second spatial derivative $u_{xx}$ at point $x_i$ in terms of the function values at $x_{i-1}$, $x_i$, and $x_{i+1}$. Next, substitute this approximation (evaluated at time level $n+1$) into the provided implicit scheme. Finally, rearrange the resulting equation into the form $A_{i} u_{i-1}^{n+1} + B_{i} u_i^{n+1} + C_{i} u_{i+1}^{n+1} = E_{i}$, where the right-hand side $E_i$ depends only on values from the previous time step $n$.\n\nFind the analytical expression for the coefficient $B_{i}$.", "solution": "The goal is to derive the coefficient $B_i$ in the finite difference equation for an implicit scheme on a non-uniform grid. The first step is to find an approximation for the second spatial derivative, $u_{xx}$, at a point $x_i$ using its neighbors $x_{i-1}$ and $x_{i+1}$.\n\nWe start with the Taylor series expansions of $u(x)$ around the point $x_i$. Let $u_i = u(x_i)$.\nThe expansion for $u(x_{i-1}) = u(x_i - h_L)$ is:\n$$\nu_{i-1} = u_i - h_L (u_x)_i + \\frac{h_L^2}{2} (u_{xx})_i - \\frac{h_L^3}{6} (u_{xxx})_i + \\dots\n$$\nThe expansion for $u(x_{i+1}) = u(x_i + h_R)$ is:\n$$\nu_{i+1} = u_i + h_R (u_x)_i + \\frac{h_R^2}{2} (u_{xx})_i + \\frac{h_R^3}{6} (u_{xxx})_i + \\dots\n$$\nHere, $(u_x)_i$ and $(u_{xx})_i$ are the first and second derivatives evaluated at $x_i$. We want to find an expression for $(u_{xx})_i$ by eliminating $(u_x)_i$ from these two equations. To do this, we can multiply the first equation by $h_R$ and the second equation by $h_L$:\n$$\nh_R u_{i-1} = h_R u_i - h_L h_R (u_x)_i + \\frac{h_R h_L^2}{2} (u_{xx})_i - \\dots\n$$\n$$\nh_L u_{i+1} = h_L u_i + h_L h_R (u_x)_i + \\frac{h_L h_R^2}{2} (u_{xx})_i + \\dots\n$$\nAdding these two new equations together cancels the $(u_x)_i$ term:\n$$\nh_R u_{i-1} + h_L u_{i+1} = (h_R + h_L)u_i + \\left(\\frac{h_R h_L^2}{2} + \\frac{h_L h_R^2}{2}\\right) (u_{xx})_i + \\dots\n$$\nWe can factor the term multiplying $(u_{xx})_i$:\n$$\nh_R u_{i-1} + h_L u_{i+1} = (h_R + h_L)u_i + \\frac{h_L h_R (h_L + h_R)}{2} (u_{xx})_i + \\dots\n$$\nNow, we rearrange the equation to solve for $(u_{xx})_i$, ignoring higher-order terms:\n$$\n\\frac{h_L h_R (h_L + h_R)}{2} (u_{xx})_i \\approx h_R u_{i-1} + h_L u_{i+1} - (h_R + h_L)u_i\n$$\n$$\n(u_{xx})_i \\approx \\frac{2}{h_L h_R (h_L + h_R)} \\left( h_R u_{i-1} - (h_L + h_R)u_i + h_L u_{i+1} \\right)\n$$\nThis can be rewritten in a more familiar form:\n$$\n(u_{xx})_i \\approx \\frac{2}{h_L+h_R} \\left( \\frac{u_{i+1}-u_i}{h_R} - \\frac{u_i-u_{i-1}}{h_L} \\right)\n$$\n\nThe next step is to substitute this finite difference approximation into the implicit scheme $ \\frac{u_i^{n+1} - u_i^n}{\\Delta t} = D (u_{xx})_i^{n+1} $. We use the approximation for the derivatives at time level $n+1$:\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = D \\left[ \\frac{2}{h_L h_R (h_L + h_R)} \\left( h_R u_{i-1}^{n+1} - (h_L + h_R)u_i^{n+1} + h_L u_{i+1}^{n+1} \\right) \\right]\n$$\nOur goal is to rearrange this equation into the form $A_{i} u_{i-1}^{n+1} + B_{i} u_i^{n+1} + C_{i} u_{i+1}^{n+1} = E_{i}$. To do this, we move all terms with time index $n+1$ to the left side and terms with time index $n$ to the right side.\nFirst, multiply both sides by $\\Delta t$:\n$$\nu_i^{n+1} - u_i^n = \\frac{2D\\Delta t}{h_L h_R (h_L + h_R)} \\left( h_R u_{i-1}^{n+1} - (h_L + h_R)u_i^{n+1} + h_L u_{i+1}^{n+1} \\right)\n$$\nNow, move all $n+1$ terms to the left side:\n$$\nu_i^{n+1} - \\frac{2D\\Delta t h_R}{h_L h_R (h_L + h_R)} u_{i-1}^{n+1} + \\frac{2D\\Delta t (h_L + h_R)}{h_L h_R (h_L + h_R)} u_i^{n+1} - \\frac{2D\\Delta t h_L}{h_L h_R (h_L + h_R)} u_{i+1}^{n+1} = u_i^n\n$$\nLet's simplify the coefficients and group the terms by their spatial index:\n$$\n-\\left(\\frac{2D\\Delta t}{h_L(h_L+h_R)}\\right) u_{i-1}^{n+1} + \\left(1 + \\frac{2D\\Delta t}{h_L h_R}\\right) u_i^{n+1} - \\left(\\frac{2D\\Delta t}{h_R(h_L+h_R)}\\right) u_{i+1}^{n+1} = u_i^n\n$$\nThis equation is now in the desired form. We can identify the coefficients:\n$A_i = -\\frac{2D\\Delta t}{h_L(h_L+h_R)}$\n$B_i = 1 + \\frac{2D\\Delta t}{h_L h_R}$\n$C_i = -\\frac{2D\\Delta t}{h_R(h_L+h_R)}$\n$E_i = u_i^n$\n\nThe problem asks for the expression for the coefficient $B_i$. From the derivation above, we find:\n$$\nB_i = 1 + \\frac{2D\\Delta t}{h_L h_R}\n$$", "answer": "$$\\boxed{1 + \\frac{2D\\Delta t}{h_L h_R}}$$", "id": "2112780"}, {"introduction": "With the foundational derivation in hand, we now apply the implicit method to a concrete physical problem. This exercise involves simulating heat diffusion in a rod with a sharp initial temperature difference, a common scenario in materials processing [@problem_id:2112821]. You will set up and solve the system of linear equations for the first time step, providing a hands-on feel for how the Backward Time, Centered Space (BTCS) scheme couples spatial points to ensure unconditional stability.", "problem": "A thin insulated rod of length $L=1.0 \\text{ m}$ lies along the x-axis from $x=0$ to $x=1.0 \\text{ m}$. The temperature distribution $u(x,t)$ in the rod is governed by the one-dimensional heat equation $u_t = \\alpha u_{xx}$, where the thermal diffusivity is given as $\\alpha = 0.01 \\text{ m}^2/\\text{s}$. At time $t=0$, the rod has a discontinuous temperature profile: the left half is heated to a constant temperature $T_1 = 100.0^\\circ\\text{C}$ and the right half is at a temperature $T_0 = 0.0^\\circ\\text{C}$. Specifically, the initial condition is $u(x,0) = 100.0^\\circ\\text{C}$ for $x \\in [0, 0.5 \\text{ m})$ and $u(x,0) = 0.0^\\circ\\text{C}$ for $x \\in [0.5 \\text{ m}, 1.0 \\text{ m}]$. For all subsequent times $t>0$, the ends of the rod are maintained at constant temperatures, corresponding to the initial temperatures at the ends: $u(0,t) = 100.0^\\circ\\text{C}$ and $u(1.0 \\text{ m}, t) = 0.0^\\circ\\text{C}$.\n\nYou are to find the temperature at the midpoint of the rod after a short time has elapsed using a numerical approximation. Use the Backward Time, Centered Space (BTCS) implicit finite difference method with a spatial step of $\\Delta x = 0.25 \\text{ m}$ and a time step of $\\Delta t = 2.5 \\text{ s}$.\n\nCalculate the temperature at $x=0.5 \\text{ m}$ at time $t=2.5 \\text{ s}$. Express your answer in degrees Celsius, rounded to three significant figures.", "solution": "We solve the one-dimensional heat equation $u_{t}=\\alpha u_{xx}$ on $x\\in[0,1]$ with Dirichlet boundary conditions $u(0,t)=100$ and $u(1,t)=0$, and initial condition $u(x,0)=100$ for $x\\in[0,0.5)$ and $u(x,0)=0$ for $x\\in[0.5,1]$. We apply the Backward Time, Centered Space (BTCS) method with $\\Delta x=0.25$ and $\\Delta t=2.5$, and thermal diffusivity $\\alpha=0.01$.\n\nDefine grid points $x_{i}=i\\Delta x$ for $i=0,1,2,3,4$, giving $x_{0}=0$, $x_{1}=0.25$, $x_{2}=0.5$, $x_{3}=0.75$, $x_{4}=1$. The interior nodes are $i=1,2,3$. The BTCS discretization for an interior node is\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}=\\alpha\\,\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}.\n$$\nLet $r=\\alpha\\Delta t/\\Delta x^{2}$. Then the linear system for $u_{i}^{n+1}$ is\n$$\n-r\\,u_{i-1}^{n+1}+(1+2r)\\,u_{i}^{n+1}-r\\,u_{i+1}^{n+1}=u_{i}^{n},\\quad i=1,2,3,\n$$\nwith boundary values imposed at time level $n+1$: $u_{0}^{n+1}=100$ and $u_{4}^{n+1}=0$.\n\nCompute $r$:\n$$\nr=\\frac{\\alpha\\Delta t}{\\Delta x^{2}}=\\frac{0.01\\times 2.5}{(0.25)^{2}}=\\frac{0.025}{0.0625}=0.4=\\frac{2}{5}.\n$$\nInitial nodal values consistent with the discontinuity and its inclusion at $x=0.5$ are\n$$\nu_{0}^{0}=100,\\quad u_{1}^{0}=100,\\quad u_{2}^{0}=0,\\quad u_{3}^{0}=0,\\quad u_{4}^{0}=0.\n$$\nAt the first time step ($n=0\\to 1$), the equations for $i=1,2,3$ become, after moving known boundary terms to the right-hand side,\n$$\n(1+2r)u_{1}^{1}-r\\,u_{2}^{1}=u_{1}^{0}+r\\,u_{0}^{1},\\qquad -r\\,u_{1}^{1}+(1+2r)u_{2}^{1}-r\\,u_{3}^{1}=u_{2}^{0},\\qquad -r\\,u_{2}^{1}+(1+2r)u_{3}^{1}=u_{3}^{0}+r\\,u_{4}^{1}.\n$$\nUsing $r=\\frac{2}{5}$, $u_{0}^{1}=100$, $u_{4}^{1}=0$, and $u_{1}^{0}=100$, $u_{2}^{0}=0$, $u_{3}^{0}=0$, this system is\n$$\n\\frac{9}{5}u_{1}^{1}-\\frac{2}{5}u_{2}^{1}=100+\\frac{2}{5}\\cdot 100=140,\n$$\n$$\n-\\frac{2}{5}u_{1}^{1}+\\frac{9}{5}u_{2}^{1}-\\frac{2}{5}u_{3}^{1}=0,\n$$\n$$\n-\\frac{2}{5}u_{2}^{1}+\\frac{9}{5}u_{3}^{1}=0.\n$$\nFrom the third equation,\n$$\n\\frac{9}{5}u_{3}^{1}=\\frac{2}{5}u_{2}^{1}\\quad\\Rightarrow\\quad u_{3}^{1}=\\frac{2}{9}u_{2}^{1}.\n$$\nSubstitute into the second equation:\n$$\n-\\frac{2}{5}u_{1}^{1}+\\frac{9}{5}u_{2}^{1}-\\frac{2}{5}\\cdot\\frac{2}{9}u_{2}^{1}=0\n\\;\\Rightarrow\\;\n-\\frac{2}{5}u_{1}^{1}+\\left(\\frac{9}{5}-\\frac{4}{45}\\right)u_{2}^{1}=0\n\\;\\Rightarrow\\;\n-\\frac{2}{5}u_{1}^{1}+\\frac{77}{45}u_{2}^{1}=0.\n$$\nThus\n$$\n\\frac{77}{45}u_{2}^{1}=\\frac{2}{5}u_{1}^{1}\\quad\\Rightarrow\\quad u_{2}^{1}=\\frac{2}{5}\\cdot\\frac{45}{77}u_{1}^{1}=\\frac{18}{77}u_{1}^{1}.\n$$\nSubstitute this into the first equation:\n$$\n\\frac{9}{5}u_{1}^{1}-\\frac{2}{5}\\cdot\\frac{18}{77}u_{1}^{1}=140\n\\;\\Rightarrow\\;\n\\left(\\frac{9}{5}-\\frac{36}{385}\\right)u_{1}^{1}=140\n\\;\\Rightarrow\\;\n\\frac{657}{385}u_{1}^{1}=140\n\\;\\Rightarrow\\;\nu_{1}^{1}=140\\cdot\\frac{385}{657}=\\frac{53900}{657}.\n$$\nTherefore,\n$$\nu_{2}^{1}=\\frac{18}{77}u_{1}^{1}=\\frac{18}{77}\\cdot\\frac{53900}{657}.\n$$\nSimplify exactly by cancelling common factors: since $657=9\\cdot 73$,\n$$\nu_{2}^{1}=\\frac{18}{657}\\cdot\\frac{53900}{77}=\\frac{2}{73}\\cdot\\frac{53900}{77}.\n$$\nBecause $53900=77\\cdot 700$, we get\n$$\nu_{2}^{1}=\\frac{2}{73}\\cdot 700 = \\frac{1400}{73}.\n$$\nThus the temperature at $x=0.5$ at $t=2.5$ is\n$$\nu(0.5,2.5)=u_{2}^{1}=\\frac{1400}{73}\\approx 19.178082\\ldots\n$$\nRounded to three significant figures, this is $19.2$ in degrees Celsius.", "answer": "$$\\boxed{19.2}$$", "id": "2112821"}, {"introduction": "Real-world heat transfer phenomena are rarely confined to one dimension. This final practice challenges you to extend the backward Euler method to a two-dimensional, L-shaped domain [@problem_id:2112783]. By determining the structure of the matrix equation for this more complex geometry, you will learn how to handle multi-dimensional problems and non-trivial boundaries, a critical step towards advanced computational modeling.", "problem": "Consider the two-dimensional heat equation $\\frac{\\partial u}{\\partial t} = \\alpha \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)$ for a temperature distribution $u(x,y,t)$ on a domain $\\Omega$, where $\\alpha$ is the constant thermal diffusivity. The domain is an L-shaped region defined by the unit square with its top-right quadrant removed: $\\Omega = \\left( (0,1) \\times (0,1) \\right) \\setminus \\left[ [1/2, 1] \\times [1/2, 1] \\right]$. The temperature is held fixed at zero on the boundary $\\partial\\Omega$ for all time $t>0$.\n\nWe aim to solve this problem numerically using the backward Euler method. The spatial domain is discretized with a uniform grid of spacing $h=1/4$ in both the $x$ and $y$ directions, and the time domain is discretized with a step size $k$. The finite difference approximation at each time step results in a linear system of equations that can be written in the form $A\\mathbf{U}^{n+1} = \\mathbf{U}^{n}$, where $\\mathbf{U}^{n}$ is a column vector containing the temperatures at all interior grid points at time $t_n = nk$.\n\nThe interior grid points are ordered lexicographically (sorted first by their $x$-coordinate, and then by their $y$-coordinate). This ordering is explicitly given as:\n$P_1=(1/4, 1/4)$, $P_2=(1/4, 1/2)$, $P_3=(1/4, 3/4)$, $P_4=(1/2, 1/4)$, $P_5=(3/4, 1/4)$.\nThe corresponding unknown temperature vector is $\\mathbf{U}^n = [u(P_1, t_n), u(P_2, t_n), u(P_3, t_n), u(P_4, t_n), u(P_5, t_n)]^T$.\n\nDetermine the entries of the second row of the matrix $A$. Express your answer as a row vector in terms of the dimensionless parameter $s = \\frac{\\alpha k}{h^2}$.", "solution": "We discretize the heat equation $u_{t}=\\alpha(u_{xx}+u_{yy})$ in time with backward Euler and in space with the standard five-point Laplacian on the uniform grid with mesh width $h$ in both directions. Let $s=\\alpha k/h^{2}$. For any interior grid point $(x_{i},y_{j})$, backward Euler yields\n$$\n\\frac{u_{i,j}^{n+1}-u_{i,j}^{n}}{k}=\\alpha\\frac{u_{i+1,j}^{n+1}-2u_{i,j}^{n+1}+u_{i-1,j}^{n+1}+u_{i,j+1}^{n+1}-2u_{i,j}^{n+1}+u_{i,j-1}^{n+1}}{h^{2}},\n$$\nwhich rearranges to\n$$\n(1+4s)u_{i,j}^{n+1}-s\\big(u_{i+1,j}^{n+1}+u_{i-1,j}^{n+1}+u_{i,j+1}^{n+1}+u_{i,j-1}^{n+1}\\big)=u_{i,j}^{n}.\n$$\nDirichlet boundary conditions $u=0$ on $\\partial\\Omega$ imply that any neighbor lying on the boundary contributes a known value zero and hence does not appear as an unknown in the linear system $A\\mathbf{U}^{n+1}=\\mathbf{U}^{n}$.\n\nWe focus on the second unknown $P_{2}=(1/4,1/2)$. Its four grid neighbors at distance $h$ are:\n- Left: $(0,1/2)$, which lies on the boundary, so it contributes a known zero.\n- Right: $(1/2,1/2)$, which lies on the boundary of the removed quadrant, hence also a known zero.\n- Down: $(1/4,1/4)=P_{1}$, an interior unknown.\n- Up: $(1/4,3/4)=P_{3}$, an interior unknown.\n\nThus, for $P_{2}$ the discrete equation becomes\n$$\n(1+4s)u(P_{2})^{n+1}-s\\,u(P_{1})^{n+1}-s\\,u(P_{3})^{n+1}=u(P_{2})^{n},\n$$\nwith no contributions from left or right neighbors because those are boundary zeros. Therefore, in the ordering $\\{P_{1},P_{2},P_{3},P_{4},P_{5}\\}$, the second row of $A$ has entries\n$$\n\\big(-s,\\;1+4s,\\;-s,\\;0,\\;0\\big).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-s & 1+4s & -s & 0 & 0\\end{pmatrix}}$$", "id": "2112783"}]}