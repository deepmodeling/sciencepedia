{"hands_on_practices": [{"introduction": "A fundamental task in data-driven discovery is verifying whether a proposed equation accurately describes a given dataset. This practice introduces the concept of the PDE residual, which quantifies the error by substituting measured data directly into the candidate equation. By calculating the mean squared residual for a proposed model of a wave phenomenon [@problem_id:2094881], you will gain hands-on experience with finite difference approximations and learn a primary method for evaluating model performance.", "problem": "In the field of data-driven scientific discovery, algorithms are used to find governing laws from experimental data. Imagine you are testing an algorithm that has proposed the inviscid Burgers' equation, a fundamental Partial Differential Equation (PDE), as the model for a dataset representing a one-dimensional wave phenomenon. The proposed equation is:\n$$u_t + u u_x = 0$$\nwhere $u(x, t)$ is the wave amplitude at position $x$ and time $t$, $u_t = \\frac{\\partial u}{\\partial t}$, and $u_x = \\frac{\\partial u}{\\partial x}$.\n\nYour task is to quantitatively evaluate the quality of this proposed model. You are given the following discrete data for $u(x,t)$ on a uniform grid with spacing $\\Delta x = 0.1$ and $\\Delta t = 0.1$:\n\n| | $x=0.0$ | $x=0.1$ | $x=0.2$ | $x=0.3$ |\n| :--- | :---: | :---: | :---: | :---: |\n| **$t=0.0$** | 1.00 | 1.10 | 1.30 | 1.60 |\n| **$t=0.1$** | 0.90 | 1.00 | 1.20 | 1.50 |\n| **$t=0.2$** | 0.80 | 0.90 | 1.10 | 1.40 |\n\nTo measure the error, you will calculate the mean squared residual. The residual of the PDE at a point $(x, t)$ is the value obtained by substituting the data into the equation: $R(x, t) = u_t + u u_x$.\n\nUsing second-order central difference approximations for the derivatives, calculate the residual $R(x, t)$ at all interior grid points where these approximations are possible. Then, compute the mean of the squared residuals.\n\nRound your final answer to three significant figures.", "solution": "The goal is to calculate the mean squared residual of the proposed Partial Differential Equation (PDE), $u_t + u u_x = 0$, based on the provided data. The residual at any point $(x, t)$ is defined as $R(x,t) = u_t + u u_x$.\n\nFirst, we must identify the grid points where the derivatives can be approximated using a second-order central difference scheme. This scheme requires data from neighboring points in the direction of the derivative. The central difference approximations for $u_t$ and $u_x$ at $(x_i, t_j)$ are:\n$$u_t \\approx \\frac{u(x_i, t_{j+1}) - u(x_i, t_{j-1})}{2\\Delta t}$$\n$$u_x \\approx \\frac{u(x_{i+1}, t_j) - u(x_{i-1}, t_j)}{2\\Delta x}$$\n\nTo calculate both derivatives at a point, we need its neighbors in both the $x$ and $t$ directions. Given the 4x3 grid, a point $(x_i, t_j)$ must have neighbors $(x_{i \\pm 1}, t_j)$ and $(x_i, t_{j \\pm 1})$. The points on the boundary of the grid do not have all the required neighbors. The only points that satisfy this condition are the \"interior\" points:\n1.  $P_1 = (x=0.1, t=0.1)$\n2.  $P_2 = (x=0.2, t=0.1)$\n\nThere are two such interior points. We will calculate the residual at each of these points.\n\n**Step 1: Calculate the residual at $P_1 = (x=0.1, t=0.1)$**\n\nFrom the data table, the value of the function at this point is $u(0.1, 0.1) = 1.00$. The grid spacings are given as $\\Delta x = 0.1$ and $\\Delta t = 0.1$.\n\nApproximate the partial derivatives at $P_1$:\nFor $u_t$:\n$u_t(0.1, 0.1) \\approx \\frac{u(0.1, 0.2) - u(0.1, 0.0)}{2 \\Delta t} = \\frac{0.90 - 1.10}{2 \\times 0.1} = \\frac{-0.20}{0.2} = -1.0$\n\nFor $u_x$:\n$u_x(0.1, 0.1) \\approx \\frac{u(0.2, 0.1) - u(0.0, 0.1)}{2 \\Delta x} = \\frac{1.20 - 0.90}{2 \\times 0.1} = \\frac{0.30}{0.2} = 1.5$\n\nNow, calculate the residual $R(P_1)$:\n$R(P_1) = u_t(0.1, 0.1) + u(0.1, 0.1) \\times u_x(0.1, 0.1)$\n$R(P_1) \\approx -1.0 + (1.00) \\times (1.5) = -1.0 + 1.5 = 0.5$\n\n**Step 2: Calculate the residual at $P_2 = (x=0.2, t=0.1)$**\n\nFrom the data table, the value of the function at this point is $u(0.2, 0.1) = 1.20$.\n\nApproximate the partial derivatives at $P_2$:\nFor $u_t$:\n$u_t(0.2, 0.1) \\approx \\frac{u(0.2, 0.2) - u(0.2, 0.0)}{2 \\Delta t} = \\frac{1.10 - 1.30}{2 \\times 0.1} = \\frac{-0.20}{0.2} = -1.0$\n\nFor $u_x$:\n$u_x(0.2, 0.1) \\approx \\frac{u(0.3, 0.1) - u(0.1, 0.1)}{2 \\Delta x} = \\frac{1.50 - 1.00}{2 \\times 0.1} = \\frac{0.50}{0.2} = 2.5$\n\nNow, calculate the residual $R(P_2)$:\n$R(P_2) = u_t(0.2, 0.1) + u(0.2, 0.1) \\times u_x(0.2, 0.1)$\n$R(P_2) \\approx -1.0 + (1.20) \\times (2.5) = -1.0 + 3.0 = 2.0$\n\n**Step 3: Calculate the mean squared residual**\n\nThe mean squared residual is the average of the squared residuals calculated at the $N=2$ interior points.\nMean Squared Residual $= \\frac{R(P_1)^2 + R(P_2)^2}{N}$\nMean Squared Residual $= \\frac{(0.5)^2 + (2.0)^2}{2} = \\frac{0.25 + 4.0}{2} = \\frac{4.25}{2} = 2.125$\n\n**Step 4: Round the final answer**\n\nThe problem asks to round the final answer to three significant figures.\nThe calculated value is $2.125$. Rounding to three significant figures gives $2.13$.", "answer": "$$\\boxed{2.13}$$", "id": "2094881"}, {"introduction": "While numerical methods are essential for evaluating PDEs on discrete data, it is crucial to understand their limitations. The choice of discretization scheme can introduce errors that may be misinterpreted as new physical effects. This exercise explores a scenario [@problem_id:2094867] where a sparse sensor array leads an engineer to mistakenly infer a reaction term in what is actually a pure diffusion process, highlighting the critical importance of distinguishing numerical artifacts from true physical phenomena.", "problem": "An engineer is studying heat transport in a long, thin rod, where the temperature distribution, $u(x, t)$, is governed by the one-dimensional heat equation, a pure diffusion process:\n$$ \\frac{\\partial u}{\\partial t} = D \\frac{\\partial^2 u}{\\partial x^2} $$\nThe thermal diffusivity is known to be $D = 0.01 \\text{ m}^2/\\text{s}$. The rod has been prepared such that its temperature profile is described by the specific solution:\n$$ u(x, t) = U_0 \\sin(kx) \\exp(-D k^2 t) $$\nwith amplitude $U_0 = 100 \\text{ K}$ and wavenumber $k = \\pi \\text{ rad/m}$.\n\nThe engineer, however, is unaware of the true underlying physics and proposes a more general reaction-diffusion model to describe the system:\n$$ \\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2} + c u $$\nwhere $\\nu$ is a diffusion coefficient and $c$ is a linear reaction coefficient.\n\nTo determine the parameters of their model, the engineer deploys a sparse sensor array. They place three temperature sensors at locations $x_1 = x_0 - \\Delta x$, $x_2 = x_0$, and $x_3 = x_0 + \\Delta x$, with the central sensor located at $x_0 = 0.25 \\text{ m}$ and a sensor spacing of $\\Delta x = 0.2 \\text{ m}$.\n\nAt a specific instant, which we can set to $t=0$ for simplicity, the engineer performs the following procedure:\n1.  They assume the diffusion coefficient in their model is the correct one, setting $\\nu = D = 0.01 \\text{ m}^2/\\text{s}$.\n2.  They measure the time rate of change of temperature, $\\frac{\\partial u}{\\partial t}$, at the central sensor location $x_0$. You may assume this measurement is perfectly accurate and corresponds to the analytical value derived from the true solution.\n3.  They estimate the second spatial derivative, $\\frac{\\partial^2 u}{\\partial x^2}$, at the central sensor location $x_0$ using the standard second-order central difference formula based on the temperature readings from their three sensors.\n4.  Using these values in their proposed model, they solve for the unknown reaction coefficient $c$.\n\nCalculate the value of the reaction coefficient $c$ that the engineer mistakenly infers from this procedure. Express your answer in units of $\\text{s}^{-1}$ and round to four significant figures.", "solution": "The engineer's proposed model is $\\frac{\\partial u}{\\partial t}=\\nu\\frac{\\partial^{2}u}{\\partial x^{2}}+cu$. They set $\\nu=D$ and solve for $c$ at $x=x_0$ and $t=0$:\n$$ c = \\frac{1}{u(x_0,0)} \\left( \\left.\\frac{\\partial u}{\\partial t}\\right|_{x_0,0} - D \\left.\\frac{\\partial^2 u}{\\partial x^2}\\right|_{x_0, \\text{FD}} \\right) $$\n\n**Step 1: Find the analytical time derivative.**\nThe true temperature field is $u(x,t)=U_{0}\\sin(kx)\\exp(-Dk^{2}t)$. The analytical time derivative, which the engineer measures perfectly, is:\n$$ \\left.\\frac{\\partial u}{\\partial t}\\right|_{t=0}=-Dk^{2}U_{0}\\sin(kx_{0})=-Dk^{2}u(x_{0},0) $$\n\n**Step 2: Find the finite difference approximation of the spatial derivative.**\nThe engineer computes the second derivative using a central difference formula with sensor spacing $\\Delta x$:\n$$ \\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}=\\frac{u(x_{0}+\\Delta x,0)-2u(x_{0},0)+u(x_{0}-\\Delta x,0)}{\\Delta x^{2}} $$\nUsing $u(x,0)=U_{0}\\sin(kx)$ and the angle addition formulas $\\sin(A \\pm B) = \\sin A \\cos B \\pm \\cos A \\sin B$, we get:\n$u(x_0+\\Delta x,0) + u(x_0-\\Delta x,0) = U_0[\\sin(kx_0)\\cos(k\\Delta x) + \\cos(kx_0)\\sin(k\\Delta x)] + U_0[\\sin(kx_0)\\cos(k\\Delta x) - \\cos(kx_0)\\sin(k\\Delta x)] = 2U_0\\sin(kx_0)\\cos(k\\Delta x) = 2u(x_0,0)\\cos(k\\Delta x)$.\nSubstituting this into the finite difference formula:\n$$ \\left.\\frac{\\partial^{2}u}{\\partial x^{2}}\\right|_{x_{0},\\,\\text{FD}}=\\frac{2u(x_{0},0)\\cos(k\\Delta x)-2u(x_{0},0)}{\\Delta x^{2}} = \\frac{2u(x_{0},0)\\left[\\cos(k\\Delta x)-1\\right]}{\\Delta x^{2}} $$\n\n**Step 3: Solve for the inferred reaction coefficient $c$.**\nSubstitute the expressions for the time and space derivatives into the equation for $c$:\n$$ c = \\frac{1}{u(x_{0},0)} \\left( -Dk^{2}u(x_{0},0) - D \\frac{2u(x_{0},0)\\left[\\cos(k\\Delta x)-1\\right]}{\\Delta x^{2}} \\right) $$\nThe term $u(x_0, 0)$ cancels out (as long as $x_0$ is not a node, which it isn't):\n$$ c = -Dk^{2} - D \\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}} = -D\\left[k^{2}+\\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}}\\right] $$\n\n**Step 4: Substitute numerical values.**\nGiven values are $D=0.01\\,\\text{m}^{2}/\\text{s}$, $k=\\pi\\,\\text{rad}/\\text{m}$, and $\\Delta x=0.2\\,\\text{m}$:\n$$ k\\Delta x = \\pi \\times 0.2 = 0.2\\pi $$\n$$ \\cos(k\\Delta x)=\\cos(0.2\\pi) \\approx 0.809017 $$\n$$ k^{2}=\\pi^{2}\\approx 9.869604 $$\nNow, calculate the term with the finite difference error:\n$$ \\frac{2\\left(\\cos(k\\Delta x)-1\\right)}{\\Delta x^{2}}=\\frac{2(0.809017-1)}{(0.2)^{2}} = \\frac{2(-0.190983)}{0.04} \\approx -9.54915 $$\nSubstitute these back into the expression for $c$:\n$$ c \\approx -0.01 \\left[ 9.869604 - 9.54915 \\right] = -0.01 \\times 0.320454 = -0.00320454\\ \\text{s}^{-1} $$\nRounded to four significant figures, the inferred reaction coefficient is $-0.003205\\ \\text{s}^{-1}$.", "answer": "$$\\boxed{-0.003205}$$", "id": "2094867"}, {"introduction": "Modern discovery algorithms often work by constructing a large library of candidate mathematical terms and using sparse regression to identify the few that govern the system. This practice provides a look under the hood of this process by demonstrating how to construct a single column in the resulting linear system. You will use the highly accurate method of spectral differentiation to symbolically compute the nonlinear advection term $u \\frac{\\partial u}{\\partial x}$ from a given analytical data profile [@problem_id:2204924], a key step in building the foundation for automated PDE discovery.", "problem": "In the field of data-driven scientific discovery, a common task is to infer the governing Partial Differential Equation (PDE) of a system from measurement data. A powerful technique for this involves constructing a large, overdetermined linear system based on a library of candidate PDE terms and then using sparse regression to find the few terms that constitute the true equation.\n\nConsider a scalar field $u(x, t)$ defined on a one-dimensional periodic domain of length $L$. The field is measured on a discrete spatial grid $x_j = j \\frac{L}{N}$ for $j=0, 1, \\dots, N-1$. At a specific instant in time, $t_0$, the measurement data is perfectly described by the function:\n$$\nu(x, t_0) = \\alpha \\cos\\left(\\frac{2\\pi m_1}{L} x\\right) + \\beta \\sin\\left(\\frac{2\\pi m_2}{L} x\\right)\n$$\nHere, $\\alpha$ and $\\beta$ are real-valued amplitudes, and $m_1$ and $m_2$ are distinct positive integers representing spatial wavenumbers.\n\nYour task is to help construct the linear system for the discovery algorithm. A proposed candidate term in the library is the nonlinear advection term, $u \\frac{\\partial u}{\\partial x}$. To evaluate this term, you must compute the spatial derivative $\\frac{\\partial u}{\\partial x}$ from the given discrete data using spectral differentiation. You may assume that the number of grid points $N$ is sufficiently large so that $m_1, m_2 \\ll N/2$, which means that aliasing effects can be ignored and the properties of the continuous Fourier transform can be used.\n\nCalculate the value of the candidate term $u \\frac{\\partial u}{\\partial x}$ at the spatial grid point $x_j$. Your final answer should be a symbolic expression in terms of the given parameters $\\alpha, \\beta, L, m_1, m_2,$ and the grid index $j$. For clarity, treat all given symbolic parameters as dimensionless.", "solution": "The goal is to find a symbolic expression for the nonlinear advection term $u \\frac{\\partial u}{\\partial x}$ evaluated at a grid point $x_j$.\n\n**Step 1: Define the field and its spectral derivative.**\nThe scalar field at time $t_{0}$ is given by:\n$$\nu(x,t_{0})=\\alpha \\cos\\left(\\frac{2\\pi m_{1}}{L}x\\right)+\\beta \\sin\\left(\\frac{2\\pi m_{2}}{L}x\\right)\n$$\nLet's define the wavenumbers $k_{1}=\\frac{2\\pi m_{1}}{L}$ and $k_{2}=\\frac{2\\pi m_{2}}{L}$.\nSince we are on a periodic domain, spectral differentiation is exact and is performed by differentiating each Fourier mode:\n$$\n\\frac{\\partial u}{\\partial x}(x,t_{0})=-\\alpha k_{1}\\sin(k_{1}x)+\\beta k_{2}\\cos(k_{2}x)\n$$\n\n**Step 2: Form the product for the nonlinear term.**\nThe candidate term is $u\\frac{\\partial u}{\\partial x}$. We multiply the expressions for $u$ and $\\frac{\\partial u}{\\partial x}$:\n$$\nu\\frac{\\partial u}{\\partial x}=\\left[\\alpha \\cos(k_{1}x)+\\beta \\sin(k_{2}x)\\right]\\left[-\\alpha k_{1}\\sin(k_{1}x)+\\beta k_{2}\\cos(k_{2}x)\\right]\n$$\nExpanding this product gives four terms:\n$$\nu\\frac{\\partial u}{\\partial x} = -\\alpha^2 k_1 \\cos(k_1 x)\\sin(k_1 x) + \\alpha\\beta k_2 \\cos(k_1 x)\\cos(k_2 x) - \\alpha\\beta k_1 \\sin(k_2 x)\\sin(k_1 x) + \\beta^2 k_2 \\sin(k_2 x)\\cos(k_2 x)\n$$\n\n**Step 3: Simplify using product-to-sum trigonometric identities.**\nWe use the following identities:\n*   $\\cos\\theta\\sin\\theta=\\frac{1}{2}\\sin(2\\theta)$\n*   $\\cos A\\cos B=\\frac{1}{2}\\left[\\cos(A-B)+\\cos(A+B)\\right]$\n*   $\\sin A\\sin B=\\frac{1}{2}\\left[\\cos(A-B)-\\cos(A+B)\\right]$\n\nApplying these to our expression:\n\\begin{align*}\nu\\frac{\\partial u}{\\partial x} = -\\frac{\\alpha^{2}k_{1}}{2}\\sin(2k_{1}x) \\\\\n + \\frac{\\alpha\\beta k_2}{2}[\\cos((k_1-k_2)x) + \\cos((k_1+k_2)x)] \\\\\n - \\frac{\\alpha\\beta k_1}{2}[\\cos((k_2-k_1)x) - \\cos((k_2+k_1)x)] \\\\\n + \\frac{\\beta^{2}k_{2}}{2}\\sin(2k_{2}x)\n\\end{align*}\nCombining the $\\alpha\\beta$ terms and using $\\cos(-z)=\\cos(z)$:\n\\begin{align*}\nu\\frac{\\partial u}{\\partial x} = -\\frac{\\alpha^{2}k_{1}}{2}\\sin(2k_{1}x) + \\frac{\\beta^{2}k_{2}}{2}\\sin(2k_{2}x) \\\\\n + \\frac{\\alpha\\beta}{2}(k_2-k_1)\\cos((k_1-k_2)x) + \\frac{\\alpha\\beta}{2}(k_2+k_1)\\cos((k_1+k_2)x)\n\\end{align*}\n\n**Step 4: Evaluate at the grid point $x_j$.**\nFinally, we substitute $x = x_{j}=j\\frac{L}{N}$ and the definitions of $k_1$ and $k_2$:\n\\begin{align*}\nk_1 x_j = \\frac{2\\pi m_1 j}{N}, \\quad k_2 x_j = \\frac{2\\pi m_2 j}{N}\n\\end{align*}\nThis yields the final expression:\n$$\nu(x_{j})\\frac{\\partial u}{\\partial x}(x_{j}) = \\frac{\\pi}{L}\\left[\n-\\alpha^{2}m_{1}\\sin\\!\\left(\\frac{4\\pi m_{1}j}{N}\\right)\n+\\alpha\\beta(m_{2}-m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}-m_{2})j}{N}\\right)\n+\\alpha\\beta(m_{2}+m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}+m_{2})j}{N}\\right)\n+\\beta^{2}m_{2}\\sin\\!\\left(\\frac{4\\pi m_{2}j}{N}\\right)\n\\right]\n$$\nThis is the desired symbolic expression for the candidate term at grid point $x_j$.", "answer": "$$\\boxed{\\frac{\\pi}{L}\\left[-\\alpha^{2}m_{1}\\sin\\!\\left(\\frac{4\\pi m_{1}j}{N}\\right)+\\alpha\\beta(m_{2}-m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}-m_{2})j}{N}\\right)+\\alpha\\beta(m_{2}+m_{1})\\cos\\!\\left(\\frac{2\\pi (m_{1}+m_{2})j}{N}\\right)+\\beta^{2}m_{2}\\sin\\!\\left(\\frac{4\\pi m_{2}j}{N}\\right)\\right]}$$", "id": "2204924"}]}