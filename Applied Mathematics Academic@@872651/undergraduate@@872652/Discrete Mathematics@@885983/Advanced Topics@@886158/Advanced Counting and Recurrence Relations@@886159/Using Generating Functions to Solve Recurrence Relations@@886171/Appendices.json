{"hands_on_practices": [{"introduction": "The first step in mastering generating functions is to see how they transform a recurrence relation into a simple algebraic equation. This exercise provides a foundational practice where a first-order linear recurrence, modeling a bacterial population, is converted into an equation for its ordinary generating function. By solving for this function and expanding it back into a series, you can derive the closed-form solution for the sequence, a fundamental skill for all subsequent problems. [@problem_id:1413569]", "problem": "In a biotechnology lab, a team is studying the population dynamics of a newly engineered bacterial strain. The mass of the bacterial culture, denoted by $a_n$ in milligrams (mg), is measured at the end of each day, $n$. The experiment starts on day $n=0$ with an initial mass of $a_0 = 2$ mg. The culture undergoes a daily growth cycle. Each day, the mass of the bacteria first increases, becoming five times the mass recorded at the end of the previous day. After this growth, the scientists harvest a constant amount of 6 mg for analysis. This process defines the mass for the current day.\n\nDetermine a closed-form expression for $a_n$, the mass of the bacterial culture at the end of day $n$, for any integer $n \\ge 0$.", "solution": "The description translates to the first-order linear nonhomogeneous recurrence\n$$\na_{n} = 5\\,a_{n-1} - 6,\\quad a_{0}=2,\n$$\nsince each day the mass is first multiplied by 5, then 6 mg is removed.\n\nTo solve, consider the associated homogeneous recurrence\n$$\na_{n}^{(h)} = 5\\,a_{n-1}^{(h)}.\n$$\nIts general solution is\n$$\na_{n}^{(h)} = C\\,5^{n},\n$$\nwhere $C$ is a constant determined by the initial condition.\n\nNext, find a particular solution to the nonhomogeneous recurrence. Try a constant particular solution $a_{n}^{(p)} = A$. Substituting into the recurrence gives\n$$\nA = 5A - 6 \\quad \\Longrightarrow \\quad (1-5)A = -6 \\quad \\Longrightarrow \\quad -4A = -6 \\quad \\Longrightarrow \\quad A = \\frac{3}{2}.\n$$\nThus, the general solution is\n$$\na_{n} = a_{n}^{(h)} + a_{n}^{(p)} = C\\,5^{n} + \\frac{3}{2}.\n$$\nUse the initial condition $a_{0} = 2$ to determine $C$:\n$$\n2 = C + \\frac{3}{2} \\quad \\Longrightarrow \\quad C = \\frac{1}{2}.\n$$\nTherefore,\n$$\na_{n} = \\frac{1}{2}\\,5^{n} + \\frac{3}{2} = \\frac{1}{2}\\left(5^{n} + 3\\right).\n$$\nThis expression satisfies the recurrence and the initial condition.", "answer": "$$\\boxed{\\frac{1}{2}\\left(5^{n}+3\\right)}$$", "id": "1413569"}, {"introduction": "Generating functions truly shine when dealing with recurrences that involve summations or convolutions, which are cumbersome to handle with other methods. This practice explores such a scenario, where the number of new variants depends on all previous generations. You will see how the summation term in the recurrence translates directly into a multiplication of generating functions, providing an elegant and powerful path to the solution. [@problem_id:1413554]", "problem": "In a simulation of digital life, a new type of self-replicating organism is studied. Let $a_n$ denote the number of distinct variants of this organism at generation $n$. At the beginning of the simulation (generation $n=0$), there is a single progenitor variant, so we have $a_0 = 1$.\n\nFor any subsequent generation $n \\ge 1$, new variants are formed through two distinct processes:\n1.  Each variant from the immediately preceding generation, $n-1$, gives rise to a single new, unique variant.\n2.  Each variant that has ever existed up to generation $n-1$ (inclusive), from generation $k=0$ to $k=n-1$, contributes to the creation of one additional new, unique variant.\n\nThe total number of variants at generation $n$, denoted by $a_n$, is the sum of the variants created by these two processes. Find a closed-form expression for $a_n$ for $n \\ge 1$ in terms of $n$.", "solution": "The process described in the problem yields the following recurrence relation. The number of variants $a_n$ at generation $n \\ge 1$ is the sum of variants from process 1 ($a_{n-1}$) and process 2 ($\\sum_{k=0}^{n-1} a_k$).\nThus, we have the recurrence relation:\n$$a_n = a_{n-1} + \\sum_{k=0}^{n-1} a_k, \\quad \\text{for } n \\ge 1$$\nwith the initial condition $a_0 = 1$.\n\nWe will solve this recurrence relation using generating functions. Let $A(x)$ be the ordinary generating function for the sequence $\\{a_n\\}$, defined as:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n x^n = a_0 + a_1 x + a_2 x^2 + \\dots$$\n\nOur goal is to find an algebraic expression for $A(x)$ and then extract the coefficient $a_n$. We multiply the recurrence relation by $x^n$ and sum over all valid values of $n$, which is $n \\ge 1$.\n$$ \\sum_{n=1}^{\\infty} a_n x^n = \\sum_{n=1}^{\\infty} a_{n-1} x^n + \\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n $$\n\nLet's analyze each term in this equation.\nThe left-hand side is $\\sum_{n=1}^{\\infty} a_n x^n = A(x) - a_0 = A(x) - 1$.\n\nThe first term on the right-hand side is $\\sum_{n=1}^{\\infty} a_{n-1} x^n$. By factoring out $x$, we get $x \\sum_{n=1}^{\\infty} a_{n-1} x^{n-1}$. Letting $m = n-1$, this becomes $x \\sum_{m=0}^{\\infty} a_m x^m = x A(x)$.\n\nThe second term on the right-hand side is $\\sum_{n=1}^{\\infty} \\left( \\sum_{k=0}^{n-1} a_k \\right) x^n$. Let $s_m = \\sum_{k=0}^{m} a_k$. The term is $\\sum_{n=1}^{\\infty} s_{n-1} x^n = x \\sum_{n=1}^{\\infty} s_{n-1} x^{n-1} = x \\sum_{m=0}^{\\infty} s_m x^m$.\nThe sequence $\\{s_m\\}$ is the sequence of partial sums of $\\{a_n\\}$. The generating function for $\\{s_m\\}$, let's call it $S(x)$, is related to $A(x)$. The sequence $\\{s_m\\}$ is the convolution of the sequence $\\{a_n\\}$ and the constant sequence $\\{1, 1, 1, \\dots\\}$. The generating function for the constant sequence is $\\frac{1}{1-x}$. Therefore, $S(x) = A(x) \\cdot \\frac{1}{1-x}$.\nSo, the second term on the right-hand side becomes $x S(x) = \\frac{x A(x)}{1-x}$.\n\nSubstituting these expressions back into the main equation:\n$$ A(x) - 1 = x A(x) + \\frac{x A(x)}{1-x} $$\n\nNow, we solve for $A(x)$.\n$$ A(x) - 1 = A(x) \\left( x + \\frac{x}{1-x} \\right) $$\n$$ A(x) - 1 = A(x) \\left( \\frac{x(1-x)+x}{1-x} \\right) = A(x) \\left( \\frac{x-x^2+x}{1-x} \\right) = A(x) \\left( \\frac{2x-x^2}{1-x} \\right) $$\n$$ A(x) \\left( 1 - \\frac{2x-x^2}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-x - (2x-x^2)}{1-x} \\right) = 1 $$\n$$ A(x) \\left( \\frac{1-3x+x^2}{1-x} \\right) = 1 $$\n$$ A(x) = \\frac{1-x}{1-3x+x^2} $$\n\nTo find $a_n$, we expand $A(x)$ into a power series using partial fraction decomposition. The roots of the quadratic denominator $t^2 - 3t + 1 = 0$ are $t = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$.\nLet us define the golden ratio $\\phi = \\frac{1+\\sqrt{5}}{2}$ and its conjugate $\\psi = \\frac{1-\\sqrt{5}}{2}$. The roots of $x^2-3x+1=0$ are not $\\phi, \\psi$. Let the roots be $r_1, r_2$. The roots of the reciprocal polynomial $1-3x+x^2=0$ are $1/r_1$ and $1/r_2$. Let's call the roots of $t^2-3t+1=0$ as $r_1$ and $r_2$. So $r_1 = \\frac{3+\\sqrt{5}}{2}$ and $r_2 = \\frac{3-\\sqrt{5}}{2}$. Notice that $r_1 = \\phi^2$ and $r_2 = \\psi^2$.\nSo, the denominator can be factored as $1-3x+x^2 = (1-r_1 x)(1-r_2 x)$.\nWe want to decompose $A(x)$:\n$$ \\frac{1-x}{(1-r_1 x)(1-r_2 x)} = \\frac{C_1}{1-r_1 x} + \\frac{C_2}{1-r_2 x} $$\nUsing the cover-up method:\n$$ C_1 = \\left. \\frac{1-x}{1-r_2 x} \\right|_{x=1/r_1} = \\frac{1 - 1/r_1}{1 - r_2/r_1} = \\frac{(r_1-1)/r_1}{(r_1-r_2)/r_1} = \\frac{r_1-1}{r_1-r_2} $$\nWe have $r_1 - 1 = \\frac{3+\\sqrt{5}}{2} - 1 = \\frac{1+\\sqrt{5}}{2} = \\phi$, and $r_1 - r_2 = \\sqrt{5}$.\nSo, $C_1 = \\frac{\\phi}{\\sqrt{5}}$.\n$$ C_2 = \\left. \\frac{1-x}{1-r_1 x} \\right|_{x=1/r_2} = \\frac{1 - 1/r_2}{1 - r_1/r_2} = \\frac{(r_2-1)/r_2}{(r_2-r_1)/r_2} = \\frac{r_2-1}{r_2-r_1} $$\nWe have $r_2 - 1 = \\frac{3-\\sqrt{5}}{2} - 1 = \\frac{1-\\sqrt{5}}{2} = \\psi$, and $r_2 - r_1 = -\\sqrt{5}$.\nSo, $C_2 = \\frac{\\psi}{-\\sqrt{5}}$.\n\nTherefore, the generating function is:\n$$ A(x) = \\frac{\\phi/\\sqrt{5}}{1-r_1 x} - \\frac{\\psi/\\sqrt{5}}{1-r_2 x} $$\nWe expand each term using the geometric series formula $\\frac{1}{1-u} = \\sum_{n=0}^{\\infty} u^n$:\n$$ A(x) = \\frac{\\phi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_1 x)^n - \\frac{\\psi}{\\sqrt{5}} \\sum_{n=0}^{\\infty} (r_2 x)^n = \\sum_{n=0}^{\\infty} \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) x^n $$\nThe coefficient of $x^n$ is $a_n$:\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi r_1^n - \\psi r_2^n) $$\nSubstituting $r_1 = \\phi^2$ and $r_2 = \\psi^2$:\n$$ a_n = \\frac{1}{\\sqrt{5}} (\\phi (\\phi^2)^n - \\psi (\\psi^2)^n) = \\frac{1}{\\sqrt{5}} (\\phi^{2n+1} - \\psi^{2n+1}) $$\nThis formula is known as Binet's formula for the Fibonacci numbers, specifically $F_{2n+1}$.\nSubstituting the values of $\\phi$ and $\\psi$:\n$$ a_n = \\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right] $$\nThis closed-form expression is valid for all $n \\ge 0$, and therefore for $n \\ge 1$ as requested.", "answer": "$$\\boxed{\\frac{1}{\\sqrt{5}} \\left[ \\left(\\frac{1+\\sqrt{5}}{2}\\right)^{2n+1} - \\left(\\frac{1-\\sqrt{5}}{2}\\right)^{2n+1} \\right]}$$", "id": "1413554"}, {"introduction": "The generating function toolkit can be extended to handle more complex situations, such as systems of mutual recurrences or recurrences involving factorial-related coefficients. This advanced exercise introduces a system of two coupled sequences and demonstrates the power of exponential generating functions (EGFs), a variant tailored for problems where terms are multiplied by their index $n$. By converting the system of recurrences into a system of differential equations for the EGFs, you can solve for sequences that are otherwise difficult to untangle. [@problem_id:1413591]", "problem": "Consider two sequences of numbers, $\\{a_n\\}_{n \\ge 0}$ and $\\{b_n\\}_{n \\ge 0}$, that are coupled through a system of recurrence relations. The sequences are defined by the initial values $a_0 = 1$ and $b_0 = 1$. For all integers $n \\ge 1$, the terms of the sequences are generated by the following mutual recurrences:\n$$a_n = a_{n-1} + n b_{n-1}$$\n$$b_n = n a_{n-1} + b_{n-1}$$\nFind a closed-form expression for the general term $a_n$ as a function of $n$.", "solution": "To solve this system of recurrence relations, we use the method of exponential generating functions (EGFs). Let the EGFs for the sequences $\\{a_n\\}$ and $\\{b_n\\}$ be $A(x)$ and $B(x)$ respectively, defined as:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!}$$\n$$B(x) = \\sum_{n=0}^{\\infty} b_n \\frac{x^n}{n!}$$\nWe convert the recurrences, which are valid for $n \\ge 1$, into equations involving these functions. We multiply each recurrence by $\\frac{x^n}{n!}$ and sum from $n=1$ to $\\infty$.\n\nFor the first recurrence, $a_n = a_{n-1} + n b_{n-1}$:\n$$ \\sum_{n=1}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=1}^{\\infty} a_{n-1} \\frac{x^n}{n!} + \\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^n}{n!} $$\nLet's translate each term:\n- Left-hand side: $\\sum_{n=1}^{\\infty} a_n \\frac{x^n}{n!} = A(x) - a_0$.\n- First term on RHS: $\\sum_{n=1}^{\\infty} a_{n-1} \\frac{x^n}{n!} = \\sum_{k=0}^{\\infty} a_k \\frac{x^{k+1}}{(k+1)!} = \\int_0^x A(t) dt$.\n- Second term on RHS: $\\sum_{n=1}^{\\infty} n b_{n-1} \\frac{x^n}{n!} = \\sum_{n=1}^{\\infty} b_{n-1} \\frac{x^n}{(n-1)!} = x \\sum_{n=1}^{\\infty} b_{n-1} \\frac{x^{n-1}}{(n-1)!} = x \\sum_{k=0}^{\\infty} b_k \\frac{x^k}{k!} = x B(x)$.\n\nThis gives the integro-differential equation:\n$$A(x) - a_0 = \\int_0^x A(t) dt + x B(x)$$\nBy symmetry, the second recurrence $b_n = n a_{n-1} + b_{n-1}$ yields:\n$$B(x) - b_0 = x A(x) + \\int_0^x B(t) dt$$\n\nDifferentiating both equations with respect to $x$ gives a system of ordinary differential equations:\n1) $A'(x) = A(x) + \\frac{d}{dx}(x B(x)) = A(x) + B(x) + x B'(x)$\n2) $B'(x) = B(x) + \\frac{d}{dx}(x A(x)) = B(x) + A(x) + x A'(x)$\n\nNow, we solve this system. Let's subtract the two equations:\n$A'(x) - B'(x) = (A(x) - B(x)) + (x B'(x) - x A'(x))$\n$(A'(x) - B'(x)) = (A(x) - B(x)) - x (A'(x) - B'(x))$\n$(1+x)(A'(x) - B'(x)) = (A(x) - B(x))$\nLet $S(x) = A(x) - B(x)$. The equation becomes $(1+x)S'(x) = S(x)$.\nThis is a separable differential equation: $\\frac{S'(x)}{S(x)} = \\frac{1}{1+x}$.\nIntegrating both sides, we get $\\ln|S(x)| = \\ln|1+x| + C$, which implies $S(x) = K(1+x)$.\nTo find the constant $K$, we use the initial conditions: $a_0 = 1$ and $b_0 = 1$.\n$A(0) = a_0 = 1$ and $B(0) = b_0 = 1$.\nSo, $S(0) = A(0) - B(0) = 1 - 1 = 0$.\nSubstituting this into our solution for $S(x)$: $S(0) = K(1+0) \\implies 0 = K$.\nTherefore, $K=0$, which means $S(x) = 0$ for all $x$. This implies $A(x) = B(x)$.\n\nNow that we know the two generating functions are identical, we can substitute $B(x) = A(x)$ and $B'(x) = A'(x)$ into either of the differential equations. Let's use equation (1):\n$A'(x) = A(x) + A(x) + x A'(x)$\n$A'(x) = 2A(x) + x A'(x)$\n$A'(x) (1-x) = 2A(x)$\nThis is another separable ODE:\n$$\\frac{A'(x)}{A(x)} = \\frac{2}{1-x}$$\nIntegrating both sides with respect to $x$:\n$$\\int \\frac{dA}{A} = \\int \\frac{2}{1-x} dx$$\n$$\\ln|A(x)| = -2 \\ln|1-x| + C_0$$\n$$A(x) = e^{C_0} (1-x)^{-2} = C_1 (1-x)^{-2}$$\nTo find the constant $C_1$, we use the initial condition $A(0) = a_0 = 1$.\n$$A(0) = C_1 (1-0)^{-2} \\implies 1 = C_1$$\nSo, the exponential generating function for $\\{a_n\\}$ is:\n$$A(x) = \\frac{1}{(1-x)^2}$$\nOur final step is to extract the coefficient $a_n$ from this function. We can find the Taylor series expansion of $A(x)$ around $x=0$. Using the generalized binomial theorem:\n$$A(x) = (1-x)^{-2} = \\sum_{n=0}^{\\infty} \\binom{-2}{n} (-x)^n$$\nThe binomial coefficient can be simplified:\n$$\\binom{-2}{n} = \\frac{(-2)(-3)\\dots(-2-n+1)}{n!} = \\frac{(-1)^n (2)(3)\\dots(n+1)}{n!} = (-1)^n \\frac{(n+1)!}{n!} = (-1)^n (n+1)$$\nSubstituting this back into the series expansion:\n$$A(x) = \\sum_{n=0}^{\\infty} (-1)^n (n+1) (-x)^n = \\sum_{n=0}^{\\infty} (n+1) x^n$$\nWe have now found the power series for $A(x)$. By definition, $A(x)$ is an exponential generating function, so we must equate the coefficients of the power series with the terms of the EGF definition:\n$$A(x) = \\sum_{n=0}^{\\infty} a_n \\frac{x^n}{n!} = \\sum_{n=0}^{\\infty} (n+1) x^n$$\nBy comparing the coefficients of $x^n$ on both sides, we get:\n$$\\frac{a_n}{n!} = n+1$$\nSolving for $a_n$ gives the desired closed-form expression:\n$$a_n = (n+1) \\cdot n!$$\nThis simplifies to:\n$$a_n = (n+1)!$$\nSince we found $A(x)=B(x)$, the same formula holds for $b_n$, i.e., $b_n = (n+1)!$.", "answer": "$$\\boxed{(n+1)!}$$", "id": "1413591"}]}