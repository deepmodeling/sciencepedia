{"hands_on_practices": [{"introduction": "The Power Spectral Density (PSD) provides a map of how a signal's power is distributed across different frequencies. A foundational skill is learning to interpret this map to answer practical questions. This first exercise [@problem_id:1742972] provides an excellent starting point by asking you to calculate the portion of a noise signal's total power that lies within a specific frequency band, given its Gaussian-shaped PSD. This reinforces the core principle that the integral of the PSD over a frequency range corresponds directly to the average power contained within that range.", "problem": "A sensitive electronic amplifier is affected by a stationary random noise voltage, denoted by the process $V(t)$. The two-sided Power Spectral Density (PSD) of this noise is well-approximated by a Gaussian function of the angular frequency $\\omega$, given by:\n$$S_V(\\omega) = S_0 \\exp\\left(-\\frac{\\omega^2}{2\\omega_0^2}\\right)$$\nwhere $S_0$ is the zero-frequency spectral density and $\\omega_0$ is a positive constant that characterizes the effective bandwidth of the noise.\n\nTo mitigate the effects of this noise, a filter is applied. We are interested in understanding how the noise power is distributed in frequency. Calculate the fraction of the total average power of the noise signal that is contained within the frequency band $[-\\omega_0, \\omega_0]$.\n\nExpress your answer as a closed-form analytic expression. You may use the definition of the error function, $\\mathrm{erf}(z)$, given by:\n$$ \\mathrm{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z \\exp(-x^2) \\, dx $$", "solution": "For a wide-sense stationary process with two-sided power spectral density $S_{V}(\\omega)$, the total average power equals the autocorrelation at zero lag and is proportional to the integral of the PSD over all angular frequencies:\n$$\nR_{V}(0)=\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty}S_{V}(\\omega)\\,d\\omega.\n$$\nTherefore, the fraction of total power contained in the band $[-\\omega_{0},\\omega_{0}]$ is the ratio\n$$\nF=\\frac{\\int_{-\\omega_{0}}^{\\omega_{0}}S_{V}(\\omega)\\,d\\omega}{\\int_{-\\infty}^{\\infty}S_{V}(\\omega)\\,d\\omega}.\n$$\n\nWith $S_{V}(\\omega)=S_{0}\\exp\\!\\left(-\\frac{\\omega^{2}}{2\\omega_{0}^{2}}\\right)$, evaluate the denominator using the standard Gaussian integral. Let\n$$\nx=\\frac{\\omega}{\\sqrt{2}\\,\\omega_{0}},\\quad d\\omega=\\sqrt{2}\\,\\omega_{0}\\,dx.\n$$\nThen\n$$\n\\int_{-\\infty}^{\\infty}S_{V}(\\omega)\\,d\\omega=S_{0}\\int_{-\\infty}^{\\infty}\\exp\\!\\left(-\\frac{\\omega^{2}}{2\\omega_{0}^{2}}\\right)\\,d\\omega=S_{0}\\sqrt{2\\pi}\\,\\omega_{0}.\n$$\n\nFor the numerator, using the same substitution with limits $\\omega=\\pm\\omega_{0}\\Rightarrow x=\\pm\\frac{1}{\\sqrt{2}}$,\n$$\n\\int_{-\\omega_{0}}^{\\omega_{0}}S_{V}(\\omega)\\,d\\omega=S_{0}\\int_{-\\omega_{0}}^{\\omega_{0}}\\exp\\!\\left(-\\frac{\\omega^{2}}{2\\omega_{0}^{2}}\\right)\\,d\\omega=S_{0}\\sqrt{2}\\,\\omega_{0}\\int_{-1/\\sqrt{2}}^{1/\\sqrt{2}}\\exp(-x^{2})\\,dx.\n$$\nUsing the definition of the error function,\n$$\n\\int_{-a}^{a}\\exp(-x^{2})\\,dx=\\sqrt{\\pi}\\,\\mathrm{erf}(a),\n$$\nwe obtain\n$$\n\\int_{-\\omega_{0}}^{\\omega_{0}}S_{V}(\\omega)\\,d\\omega=S_{0}\\sqrt{2}\\,\\omega_{0}\\,\\sqrt{\\pi}\\,\\mathrm{erf}\\!\\left(\\frac{1}{\\sqrt{2}}\\right)=S_{0}\\sqrt{2\\pi}\\,\\omega_{0}\\,\\mathrm{erf}\\!\\left(\\frac{1}{\\sqrt{2}}\\right).\n$$\n\nForming the ratio,\n$$\nF=\\frac{S_{0}\\sqrt{2\\pi}\\,\\omega_{0}\\,\\mathrm{erf}\\!\\left(\\frac{1}{\\sqrt{2}}\\right)}{S_{0}\\sqrt{2\\pi}\\,\\omega_{0}}=\\mathrm{erf}\\!\\left(\\frac{1}{\\sqrt{2}}\\right).\n$$", "answer": "$$\\boxed{\\mathrm{erf}\\!\\left(\\frac{1}{\\sqrt{2}}\\right)}$$", "id": "1742972"}, {"introduction": "While analyzing a given spectrum is crucial, it is equally important to understand how signals with specific spectral characteristics are generated. Many complex random signals in nature and engineering can be modeled as the output of a linear system driven by a simple input like white noise. This practice [@problem_id:1324487] explores this generative model by analyzing a first-order autoregressive process, a fundamental building block in time-series analysis. You will derive the PSD of a signal created by passing white noise through a simple recursive filter, revealing how filtering shapes a flat spectrum into a structured one.", "problem": "A simplified one-dimensional model for the position of a microscopic bead held in an optical trap can be described by a first-order autoregressive process. The position of the bead at discrete time step $n$, denoted by $P[n]$, is influenced by its position at the previous time step, $P[n-1]$, and a series of random thermal kicks from the surrounding fluid, $N[n]$. The system dynamics are governed by the equation:\n\n$P[n] = \\alpha P[n-1] + N[n]$\n\nHere, $\\alpha$ is a real, positive constant related to the stiffness of the trap and the fluid's viscosity, with $0 < \\alpha < 1$ ensuring the bead remains stably trapped. The term $N[n]$ represents a discrete-time, zero-mean white noise process modeling the thermal kicks. The autocorrelation of this noise process is given by $\\mathbb{E}[N[n]N[m]] = \\sigma_N^2 \\delta_{nm}$, where $\\mathbb{E}[\\cdot]$ is the expectation operator, $\\sigma_N^2$ is the variance of the noise, and $\\delta_{nm}$ is the Kronecker delta.\n\nDetermine the Power Spectral Density (PSD) of the bead's position process, $S_P(\\omega)$, as a function of the angular frequency $\\omega$ in radians per sample.", "solution": "The AR(1) process is given by $P[n] = \\alpha P[n-1] + N[n]$ with $0 < \\alpha < 1$ and $N[n]$ a zero-mean white noise with autocorrelation $\\mathbb{E}[N[n]N[m]] = \\sigma_{N}^{2}\\delta_{nm}$. Taking the $z$-transform and assuming wide-sense stationarity, the input-output relation is $P(z) = H(z)N(z)$ with the transfer function from $N$ to $P$ given by\n$$\nH(z) = \\frac{1}{1 - \\alpha z^{-1}}.\n$$\nFor a white noise input, the input power spectral density is constant:\n$$\nS_{N}(\\omega) = \\sigma_{N}^{2}.\n$$\nFor a linear time-invariant system, the output PSD is the input PSD scaled by the squared magnitude of the frequency response:\n$$\nS_{P}(\\omega) = |H(\\exp(\\mathrm{i}\\omega))|^{2} S_{N}(\\omega).\n$$\nEvaluating the frequency response,\n$$\nH(\\exp(\\mathrm{i}\\omega)) = \\frac{1}{1 - \\alpha \\exp(-\\mathrm{i}\\omega)},\n$$\nso\n$$\n|H(\\exp(\\mathrm{i}\\omega))|^{2} = \\frac{1}{|1 - \\alpha \\exp(-\\mathrm{i}\\omega)|^{2}}.\n$$\nCompute the denominator magnitude squared:\n$$\n|1 - \\alpha \\exp(-\\mathrm{i}\\omega)|^{2} = (1 - \\alpha \\exp(-\\mathrm{i}\\omega))(1 - \\alpha \\exp(\\mathrm{i}\\omega)) = 1 + \\alpha^{2} - \\alpha\\left(\\exp(\\mathrm{i}\\omega) + \\exp(-\\mathrm{i}\\omega)\\right).\n$$\nUsing $\\exp(\\mathrm{i}\\omega) + \\exp(-\\mathrm{i}\\omega) = 2\\cos(\\omega)$, this becomes\n$$\n|1 - \\alpha \\exp(-\\mathrm{i}\\omega)|^{2} = 1 + \\alpha^{2} - 2\\alpha \\cos(\\omega).\n$$\nTherefore,\n$$\nS_{P}(\\omega) = \\frac{\\sigma_{N}^{2}}{1 + \\alpha^{2} - 2\\alpha \\cos(\\omega)}.\n$$\nThe condition $0 < \\alpha < 1$ guarantees stability and stationarity, ensuring the PSD exists and is finite for all $\\omega$.", "answer": "$$\\boxed{\\frac{\\sigma_{N}^{2}}{1+\\alpha^{2}-2\\alpha \\cos(\\omega)}}$$", "id": "1324487"}, {"introduction": "Building on the concept of spectral shaping, this final exercise focuses on analyzing how a common signal processing operation—a moving average filter—transforms the PSD of a signal. Averaging is a ubiquitous technique used to smooth signals and reduce noise. By solving this problem [@problem_id:1324450], you will derive the filter's squared frequency response, $|H(f)|^2$, and see precisely how it acts as a low-pass filter, attenuating high-frequency components of any input signal. This practice solidifies the universal relationship for linear systems, $S_{YY}(f) = |H(f)|^2 S_{XX}(f)$, providing a powerful tool for system analysis and design.", "problem": "A real-valued, zero-mean, Wide-Sense Stationary (WSS) random process $X(t)$ has an autocorrelation function $R_{XX}(\\tau)$ and a corresponding Power Spectral Density (PSD), denoted by $S_{XX}(f)$. This process is passed through a signal processing unit that computes a continuous-time moving average, generating a new process $Y(t)$. The relationship between the input and output processes is defined by the integral:\n$$Y(t) = \\frac{1}{T} \\int_{t-T}^{t} X(\\tau) d\\tau$$\nwhere $T > 0$ is a constant representing the averaging window duration. It can be shown that the output process $Y(t)$ is also WSS.\n\nDetermine the Power Spectral Density of the output process, $S_{YY}(f)$, as a function of the input Power Spectral Density $S_{XX}(f)$ and the averaging duration $T$. Your final expression should not contain any unevaluated integrals.", "solution": "The output process $Y(t)$ is obtained by a linear operation on the input process $X(t)$. We can determine if this operation corresponds to a Linear Time-Invariant (LTI) system. If so, we can find the system's impulse response $h(t)$ and use it to relate the input and output Power Spectral Densities (PSDs).\n\nAn LTI system's output can be expressed as the convolution of the input signal with the system's impulse response:\n$$Y(t) = \\int_{-\\infty}^{\\infty} X(\\tau) h(t-\\tau) d\\tau = \\int_{-\\infty}^{\\infty} h(\\tau') X(t-\\tau') d\\tau'$$\nwhere $\\tau' = t - \\tau$.\n\nLet's manipulate the given expression for $Y(t)$ to match this convolution form. We are given:\n$$Y(t) = \\frac{1}{T} \\int_{t-T}^{t} X(\\tau) d\\tau$$\nLet's perform a change of variables in the integral. Let $\\tau' = t - \\tau$. This implies $\\tau = t - \\tau'$ and $d\\tau = -d\\tau'$. The limits of integration also change:\n- When $\\tau = t$, $\\tau' = t - t = 0$.\n- When $\\tau = t-T$, $\\tau' = t - (t-T) = T$.\n\nSubstituting these into the integral gives:\n$$Y(t) = \\frac{1}{T} \\int_{T}^{0} X(t - \\tau') (-d\\tau') = \\frac{1}{T} \\int_{0}^{T} X(t - \\tau') d\\tau'$$\nThis integral can be written over the entire real line by defining a function that is non-zero only over the interval $[0, T]$:\n$$Y(t) = \\int_{-\\infty}^{\\infty} h(\\tau') X(t-\\tau') d\\tau'$$\nBy comparing the forms, we can identify the impulse response $h(\\tau')$ as:\n$$h(\\tau') = \n\\begin{cases} \n\\frac{1}{T} & 0 \\leq \\tau' \\leq T \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\nThis is a rectangular pulse of height $1/T$ and duration $T$.\n\nFor a WSS process $X(t)$ that is input to an LTI system with impulse response $h(t)$, the output process $Y(t)$ is also WSS. The relationship between the input PSD, $S_{XX}(f)$, and the output PSD, $S_{YY}(f)$, is given by:\n$$S_{YY}(f) = |H(f)|^2 S_{XX}(f)$$\nwhere $H(f)$ is the frequency response of the system, which is the Fourier transform of the impulse response $h(t)$.\n$$H(f) = \\mathcal{F}\\{h(t)\\} = \\int_{-\\infty}^{\\infty} h(t) \\exp(-j2\\pi ft) dt$$\nLet's calculate $H(f)$ for our impulse response:\n$$H(f) = \\int_{0}^{T} \\frac{1}{T} \\exp(-j2\\pi ft) dt$$\n$$H(f) = \\frac{1}{T} \\left[ \\frac{\\exp(-j2\\pi ft)}{-j2\\pi f} \\right]_{t=0}^{t=T}$$\n$$H(f) = \\frac{1}{T} \\left( \\frac{\\exp(-j2\\pi fT) - \\exp(0)}{-j2\\pi f} \\right) = \\frac{1 - \\exp(-j2\\pi fT)}{j2\\pi fT}$$\nTo simplify this expression, we can factor out a phase term from the numerator:\n$$H(f) = \\frac{\\exp(-j\\pi fT) (\\exp(j\\pi fT) - \\exp(-j\\pi fT))}{j2\\pi fT}$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(j\\theta) - \\exp(-j\\theta)}{2j}$, we can write:\n$$H(f) = \\exp(-j\\pi fT) \\frac{2j \\sin(\\pi fT)}{j2\\pi fT}$$\n$$H(f) = \\exp(-j\\pi fT) \\frac{\\sin(\\pi fT)}{\\pi fT}$$\nNow we need to find the magnitude squared of the frequency response, $|H(f)|^2$:\n$$|H(f)|^2 = \\left| \\exp(-j\\pi fT) \\frac{\\sin(\\pi fT)}{\\pi fT} \\right|^2$$\nSince $|\\exp(-j\\theta)| = 1$ for any real $\\theta$, the magnitude is:\n$$|H(f)|^2 = \\left| \\frac{\\sin(\\pi fT)}{\\pi fT} \\right|^2 = \\left( \\frac{\\sin(\\pi fT)}{\\pi fT} \\right)^2$$\nNote that this is often written using the normalized sinc function as $\\text{sinc}^2(fT)$.\n\nFinally, we substitute this result back into the PSD relationship:\n$$S_{YY}(f) = |H(f)|^2 S_{XX}(f) = \\left( \\frac{\\sin(\\pi fT)}{\\pi fT} \\right)^2 S_{XX}(f)$$\nThis is the desired expression for the output PSD.", "answer": "$$\n\\boxed{\\left(\\frac{\\sin(\\pi fT)}{\\pi fT}\\right)^2 S_{XX}(f)}\n$$", "id": "1324450"}]}