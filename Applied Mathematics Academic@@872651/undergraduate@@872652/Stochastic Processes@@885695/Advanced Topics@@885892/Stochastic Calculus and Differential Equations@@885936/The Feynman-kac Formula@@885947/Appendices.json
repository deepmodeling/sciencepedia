{"hands_on_practices": [{"introduction": "The Feynman-Kac formula's power is vividly illustrated in financial mathematics, where it is used to value instruments that generate continuous cash flows. This practice problem models such a scenario, calculating the expected present value of a payment stream tied to a stochastically evolving asset price. By working through this exercise, you will directly compute an expectation over all possible future paths, and see how this value corresponds to the solution of an ordinary differential equation, bridging the worlds of probability and analysis. [@problem_id:1337995]", "problem": "An asset's price, denoted by $X_s$ at time $s$, is modeled as a standard one-dimensional Brownian motion. Its evolution is described by the stochastic differential equation $dX_s = dW_s$, where $W_s$ is a standard Wiener process. The asset starts at an initial price $X_0 = x$.\n\nThis asset generates a continuous stream of payments. At any time $s \\ge 0$, the instantaneous rate of payment is given by the square of the asset's price, i.e., the payment rate is $f(X_s) = X_s^2$.\n\nAn investor wishes to calculate the total present value of all future payments from this asset over an infinite time horizon. The future payments are discounted continuously at a constant risk-free interest rate $r > 0$.\n\nDetermine the expected total discounted value of this infinite stream of payments as a function of the initial price $x$ and the discount rate $r$.", "solution": "Let $X_{s}$ be a standard Brownian motion starting from $X_{0}=x$, so $dX_{s}=dW_{s}$ and $X_{s}=x+W_{s}$. The total discounted value of the running payoff $f(X_{s})=X_{s}^{2}$ is\n$$\nV(x)=\\mathbb{E}_{x}\\left[\\int_{0}^{\\infty} \\exp(-r s)\\,X_{s}^{2}\\,ds\\right], \\quad r>0.\n$$\nSince $X_{s}^{2}\\ge 0$, Tonelli’s theorem justifies interchanging expectation and integration:\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,\\mathbb{E}_{x}[X_{s}^{2}]\\,ds.\n$$\nBecause $X_{s}=x+W_{s}$ with $\\mathbb{E}[W_{s}]=0$ and $\\mathrm{Var}(W_{s})=s$, we have\n$$\n\\mathbb{E}_{x}[X_{s}^{2}]=\\mathrm{Var}(X_{s})+\\left(\\mathbb{E}_{x}[X_{s}]\\right)^{2}=s+x^{2}.\n$$\nHence\n$$\nV(x)=\\int_{0}^{\\infty} \\exp(-r s)\\,(x^{2}+s)\\,ds\n= x^{2}\\int_{0}^{\\infty} \\exp(-r s)\\,ds + \\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds.\n$$\nFor $r>0$,\n$$\n\\int_{0}^{\\infty} \\exp(-r s)\\,ds=\\frac{1}{r}.\n$$\nFor the second integral, integrate by parts with $u=s$ and $dv=\\exp(-r s)\\,ds$, so $du=ds$ and $v=-(1/r)\\exp(-r s)$:\n$$\n\\int_{0}^{\\infty} s\\,\\exp(-r s)\\,ds=\\left.-\\frac{s}{r}\\exp(-r s)\\right|_{0}^{\\infty}+\\frac{1}{r}\\int_{0}^{\\infty}\\exp(-r s)\\,ds\n=0+\\frac{1}{r}\\cdot\\frac{1}{r}=\\frac{1}{r^{2}}.\n$$\nTherefore,\n$$\nV(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}.\n$$\nAs a consistency check via the Feynman–Kac formula, $v(x)=V(x)$ solves the ODE $(r-\\mathcal{L})v=x^{2}$ with generator $\\mathcal{L}=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$, that is,\n$$\nr v(x)-\\frac{1}{2}v''(x)=x^{2}.\n$$\nA particular solution $v_{p}(x)=a x^{2}+b$ yields $v_{p}''(x)=2a$. Substituting this into the equivalent ODE $v''-2rv=-2x^2$ gives $2a - 2r(ax^2+b) = -2x^2$. Comparing coefficients, we find $a=\\frac{1}{r}$ and $b=\\frac{1}{r^{2}}$. The homogeneous solutions $\\exp(\\pm\\sqrt{2r}\\,x)$ are excluded by the requirement of at most polynomial growth, confirming $v(x)=\\frac{x^{2}}{r}+\\frac{1}{r^{2}}$.", "answer": "$$\\boxed{\\frac{x^{2}}{r}+\\frac{1}{r^{2}}}$$", "id": "1337995"}, {"introduction": "Beyond calculating expected values of integrals, the Feynman-Kac framework provides a powerful tool for computing probabilities of complex events. This problem explores a classic \"exit probability\" question: for a particle diffusing randomly within a confined space, what is the chance it hits one part of the boundary before another? You will see how this probabilistic question elegantly transforms into solving a boundary value problem for Laplace's equation, demonstrating the formula's utility in turning questions about random paths into deterministic PDE problems. [@problem_id:1338001]", "problem": "A single gold adatom diffuses on a perfectly flat silver surface. Using advanced manipulation techniques, two concentric circular barriers are constructed, creating an annular region where the adatom is temporarily confined. The inner barrier has a radius $R_1$ and the outer barrier has a radius $R_2$, with $R_1 < R_2$. The adatom's motion on the surface is well-described by a standard two-dimensional Brownian motion.\n\nThe barriers are not perfect; they can be crossed. The process stops as soon as the adatom's path intersects either the inner or the outer circular barrier. Suppose the adatom is initially placed at a location with a radial distance $r_0$ from the center of the circles, such that $R_1 < r_0 < R_2$. Due to the symmetry of the problem, the probability of interest will not depend on the specific angular position, only on the initial radial distance $r_0$.\n\nDetermine the probability, let's call it $P(r_0)$, that the adatom will cross the outer barrier at radius $R_2$ before it crosses the inner barrier at radius $R_1$. Your final answer should be a closed-form analytic expression in terms of $r_0$, $R_1$, and $R_2$.", "solution": "Let $X_{t}$ be a standard two-dimensional Brownian motion on the plane, started at a point with radial coordinate $r_{0}$ such that $R_{1}<r_{0}<R_{2}$. Define the annulus $A=\\{x\\in\\mathbb{R}^{2}:R_{1}<|x|<R_{2}\\}$. Let $P(x)$ denote the probability that, starting from $x\\in A$, the process hits the outer circle $\\{|x|=R_{2}\\}$ before the inner circle $\\{|x|=R_{1}\\}$. By rotational symmetry, $P(x)$ depends only on the radius $r=|x|$, so we write $P(r)$.\n\nFor Brownian motion, the hitting probability of a portion of the boundary solves the Dirichlet problem for the Laplace operator. Thus $P(r)$ is harmonic in the annulus and satisfies the boundary conditions corresponding to absorbing barriers:\n$$\n\\Delta P=0\\quad\\text{in }A,\\qquad P(R_{1})=0,\\qquad P(R_{2})=1.\n$$\nIn polar coordinates, for a radially symmetric function $P(r)$, the Laplacian reduces to\n$$\n\\Delta P=P_{rr}+\\frac{1}{r}P_{r}.\n$$\nTherefore $P(r)$ solves the ordinary differential equation\n$$\nP''(r)+\\frac{1}{r}P'(r)=0,\\quad R_{1}<r<R_{2},\n$$\nwith boundary conditions\n$$\nP(R_{1})=0,\\qquad P(R_{2})=1.\n$$\nTo solve the ODE, set $v(r)=P'(r)$, giving\n$$\nv'(r)+\\frac{1}{r}v(r)=0.\n$$\nThis is a first-order linear equation. Multiplying by $r$ yields\n$$\n\\frac{d}{dr}\\big(r\\,v(r)\\big)=0\\quad\\Rightarrow\\quad r\\,v(r)=C_{1}\\quad\\Rightarrow\\quad P'(r)=\\frac{C_{1}}{r}.\n$$\nIntegrating,\n$$\nP(r)=C_{1}\\ln r+C_{2}.\n$$\nImposing the boundary conditions:\n$$\nP(R_{1})=C_{1}\\ln R_{1}+C_{2}=0,\\qquad P(R_{2})=C_{1}\\ln R_{2}+C_{2}=1.\n$$\nSubtracting the first from the second,\n$$\nC_{1}\\big(\\ln R_{2}-\\ln R_{1}\\big)=1\\quad\\Rightarrow\\quad C_{1}=\\frac{1}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nThen\n$$\nC_{2}=-C_{1}\\ln R_{1}=-\\frac{\\ln R_{1}}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nHence, for any $R_{1}<r<R_{2}$,\n$$\nP(r)=\\frac{\\ln r-\\ln R_{1}}{\\ln R_{2}-\\ln R_{1}}=\\frac{\\ln\\!\\big(\\frac{r}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$\nEvaluated at the initial radius $r_{0}$, the desired probability is\n$$\nP(r_{0})=\\frac{\\ln\\!\\big(\\frac{r_{0}}{R_{1}}\\big)}{\\ln\\!\\big(\\frac{R_{2}}{R_{1}}\\big)}.\n$$", "answer": "$$\\boxed{\\frac{\\ln\\!\\left(\\frac{r_{0}}{R_{1}}\\right)}{\\ln\\!\\left(\\frac{R_{2}}{R_{1}}\\right)}}$$", "id": "1338001"}, {"introduction": "Having explored where a process might end, we now turn to the question of *when*. This exercise focuses on calculating the \"expected hitting time\"—the average time it takes for a stochastic process to reach a certain target level for the first time. The problem introduces an additional layer of physical realism with a reflecting barrier, which prevents the process from going below zero. You will learn how this physical constraint translates into a specific type of boundary condition (a Neumann condition) for the governing differential equation, showcasing the versatility of the PDE approach. [@problem_id:1338002]", "problem": "A simplified model for the state of a financial asset is given by a one-dimensional reflected Brownian motion, $X_t$, which starts at an initial positive value $X_0 = x$. The process $X_t$ evolves as a standard Brownian motion, but it is instantaneously reflected whenever it attempts to cross the origin, ensuring its value remains non-negative.\n\nA company holds this asset and incurs a constant operational cost at a rate of $c$ per unit time for as long as it holds the asset. The company has a pre-determined strategy to liquidate the asset as soon as its value reaches a target level $a$. The initial value $x$ is strictly between 0 and $a$, that is, $0 < x < a$.\n\nAssuming the parameters $x$, $a$, and $c$ are all positive real constants, find a closed-form analytic expression for the total expected operational cost the company will incur until the asset is liquidated.", "solution": "Let $T_{a}=\\inf\\{t\\geq 0: X_{t}=a\\}$ be the liquidation time. The total operational cost accumulated until liquidation is $\\int_{0}^{T_{a}} c\\,dt$, so by linearity of expectation the expected total cost is $c\\,\\mathbb{E}_{x}[T_{a}]$. Thus it suffices to compute $u(x)=\\mathbb{E}_{x}[T_{a}]$ for reflected Brownian motion on $[0,\\infty)$ starting at $x\\in(0,a)$, with reflection at $0$ and absorption at $a$.\n\nThe generator of a standard reflected Brownian motion on $[0,\\infty)$ is $L=\\frac{1}{2}\\frac{d^{2}}{dx^{2}}$ on $(0,a)$, with Neumann boundary condition at $0$ (reflection) and Dirichlet boundary condition at $a$ (absorption). By Dynkin’s formula, $u$ solves the Poisson problem\n$$\n\\frac{1}{2}u''(x)=-1,\\quad x\\in(0,a),\n$$\nwith boundary conditions\n$$\nu'(0)=0,\\qquad u(a)=0.\n$$\nSolving, we integrate $u''(x)=-2$ to get $u'(x)=-2x+C_{1}$. The Neumann condition $u'(0)=0$ implies $C_{1}=0$, hence $u'(x)=-2x$. Integrating again yields $u(x)=-x^{2}+C_{2}$. The Dirichlet condition $u(a)=0$ gives $C_{2}=a^{2}$, hence\n$$\nu(x)=a^{2}-x^{2}.\n$$\nTherefore, the expected total operational cost is\n$$\nc\\,u(x)=c\\left(a^{2}-x^{2}\\right).\n$$", "answer": "$$\\boxed{c\\left(a^{2}-x^{2}\\right)}$$", "id": "1338002"}]}