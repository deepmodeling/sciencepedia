{"hands_on_practices": [{"introduction": "A fundamental question in the study of branching processes is determining the ultimate fate of a population. This first exercise provides a direct application of probability generating functions (PGFs) to calculate the probability of extinction. By modeling a simplified real-world scenario, you will practice constructing the PGF for a discrete offspring distribution and finding the smallest positive root of the equation $G(s) = s$, which is a core skill for analyzing any Galton-Watson process [@problem_id:1304392].", "problem": "A simplified model for the spread of a viral meme on a social network is described by a discrete-time branching process. The process begins at generation 0 with a single user who posts the meme. Each user who has the meme in generation $n$ will independently share it with a certain number of new users, who then form generation $n+1$. The number of new users an individual shares the meme with is a random variable. Specifically, any given user will share the meme with:\n- 0 new users with probability $p_0 = 0.2$.\n- 1 new user with probability $p_1 = 0.5$.\n- 2 new users with probability $p_2 = 0.3$.\n- It is impossible for a user to share the meme with more than 2 new users.\n\nThe process is considered extinct if there is a generation with zero users. Assuming the process starts with a single initial user, calculate the long-term probability that the meme's spread eventually stops.", "solution": "Let $Z_{n}$ be the number of users in generation $n$. This is a Galton–Watson branching process with offspring distribution supported on $\\{0,1,2\\}$, where a user shares with $0, 1, 2$ new users with probabilities $p_0=0.2$, $p_1=0.5$, and $p_2=0.3$, respectively. The extinction probability $q$ (starting from one initial user) is the smallest solution in $[0,1]$ of the fixed-point equation $q=f(q)$, where the offspring generating function is\n$$\nf(s)=\\sum_{k=0}^{2} p_k s^k = 0.2 + 0.5s + 0.3s^2.\n$$\nFirst, we calculate the mean number of new users, $\\mu$:\n$$\n\\mu = f'(1) = 0.5 + 2(0.3) = 1.1 > 1.\n$$\nSince $\\mu > 1$, the process is supercritical and the extinction probability satisfies $q  1$. We solve the equation $q=f(q)$:\n$$\ns = 0.2 + 0.5s + 0.3s^2\n\\;\\Longleftrightarrow\\;\n0.3s^2 - 0.5s + 0.2 = 0\n\\;\\Longleftrightarrow\\;\n3s^2-5s+2=0.\n$$\nThis factors as $(3s-2)(s-1)=0$. The roots are $s=1$ and $s=2/3$. The extinction probability is the smaller root in $[0,1]$, hence $q=2/3$. Alternatively, using the quadratic formula:\n$$\ns=\\frac{5\\pm\\sqrt{25-4(3)(2)}}{6}=\\frac{5\\pm 1}{6}.\n$$\nThe roots are $s=1$ and $s = 4/6 = 2/3$. The smallest non-negative root is $2/3$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "1304392"}, {"introduction": "Beyond knowing whether a population will go extinct, we are often interested in its overall size throughout its existence. This practice introduces the concept of the total progeny, which is the total number of individuals that ever live, including the initial ancestor. You will learn how to use the offspring PGF, $G(s)$, to formulate and solve the fundamental functional equation $H(s) = sG(H(s))$ for the total progeny's PGF, $H(s)$, a powerful method for characterizing the entire history of the process [@problem_id:1304403].", "problem": "A Galton-Watson branching process is a stochastic model for population growth that evolves in discrete generations. The process begins at generation $n=0$ with a single ancestor. This ancestor produces a random number of offspring, which constitute generation $n=1$. Each individual in generation $n$ then independently gives rise to a random number of offspring, according to the same probability distribution, forming generation $n+1$.\n\nConsider a specific branching process where the number of offspring, $X$, for any given individual is a random variable with integer values $k \\geq 0$. The probability mass function for $X$ is given by\n$$\nP(X=k) = \\left(\\frac{1}{2}\\right)^{k+1}, \\quad \\text{for } k = 0, 1, 2, \\ldots\n$$\nThe Probability Generating Function (PGF) of a discrete random variable $X$ is defined as $G(s) = E[s^X]$.\n\nLet $Y$ be the random variable representing the total progeny of the process, defined as the total number of individuals that ever exist, including the initial ancestor. Find the closed-form expression for $H(s) = E[s^Y]$, the probability generating function for the total progeny $Y$.", "solution": "We begin by computing the offspring probability generating function. For the given offspring distribution,\n$$\nG(s) \\equiv \\mathbb{E}[s^{X}] = \\sum_{k=0}^{\\infty} s^{k} \\left(\\frac{1}{2}\\right)^{k+1} = \\frac{1}{2} \\sum_{k=0}^{\\infty} \\left(\\frac{s}{2}\\right)^{k}.\n$$\nUsing the geometric series identity $\\sum_{k=0}^{\\infty} r^{k} = \\frac{1}{1-r}$ for $|r|1$, we obtain\n$$\nG(s) = \\frac{1}{2} \\cdot \\frac{1}{1 - \\frac{s}{2}} = \\frac{1}{2 - s}.\n$$\n\nLet $Y$ denote the total progeny (including the ancestor). In a Galton–Watson process starting from a single ancestor, $Y$ satisfies the decomposition\n$$\nY = 1 + \\sum_{i=1}^{X} Y_{i},\n$$\nwhere, conditional on $X$, the $Y_{i}$ are independent copies of $Y$, independent of $X$. Taking probability generating functions and using independence,\n$$\nH(s) \\equiv \\mathbb{E}[s^{Y}] = \\mathbb{E}\\!\\left[s^{1 + \\sum_{i=1}^{X} Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}}\\right] = s\\, \\mathbb{E}\\!\\left[\\mathbb{E}\\!\\left[\\prod_{i=1}^{X} s^{Y_{i}} \\,\\bigg|\\, X\\right]\\right].\n$$\nGiven $X=k$, we have $\\mathbb{E}[\\prod_{i=1}^{k} s^{Y_{i}}] = \\left(\\mathbb{E}[s^{Y}]\\right)^{k} = \\left(H(s)\\right)^{k}$. Therefore,\n$$\nH(s) = s\\, \\mathbb{E}\\!\\left[(H(s))^{X}\\right] = s\\, G\\!\\left(H(s)\\right).\n$$\nSubstituting $G(u) = \\frac{1}{2 - u}$ with $u = H(s)$ yields the functional equation\n$$\nH(s) = \\frac{s}{2 - H(s)}.\n$$\nRearranging gives a quadratic equation for $H(s)$:\n$$\nH(s)\\left(2 - H(s)\\right) = s \\quad \\Longleftrightarrow \\quad H(s)^{2} - 2 H(s) + s = 0.\n$$\nSolving this quadratic,\n$$\nH(s) = \\frac{2 \\pm \\sqrt{4-4s}}{2} = 1 \\pm \\sqrt{1 - s}.\n$$\nTo select the correct branch, we use the PGF boundary condition $H(0) = \\mathbb{E}[0^{Y}] = P(Y=0) = 0$ since the total progeny $Y$ is at least 1 (the ancestor). Evaluating our solution at $s=0$ gives $H(0) = 1 \\pm 1$, so we must choose the minus sign to get $H(0)=0$. The valid choice is\n$$\nH(s) = 1 - \\sqrt{1 - s}.\n$$\nThis also satisfies $H(1) = 1$, as required for a PGF of a random variable that is finite with probability 1.", "answer": "$$\\boxed{1 - \\sqrt{1 - s}}$$", "id": "1304403"}, {"introduction": "The probability generating function is not just a tool for finding probabilities; it is a powerful analytical device for calculating the moments of a distribution. This advanced exercise challenges you to leverage the functional equation for the total progeny's PGF to derive a general expression for its variance. This practice will deepen your understanding of how derivatives of PGFs relate to moments and demonstrate how to obtain elegant, closed-form results for key characteristics of a branching process [@problem_id:1304404].", "problem": "Consider a Galton-Watson branching process that begins with a single ancestor at generation zero, $Z_0 = 1$. Each individual in any generation, independently of all others, produces a random number of offspring according to a discrete probability distribution. Let the random variable $X$ denote the number of offspring of a single individual. The mean of this distribution is $E[X] = \\mu$ and its variance is $\\operatorname{Var}(X) = \\sigma^2$. We assume the process is subcritical, which means $\\mu  1$.\n\nThe offspring distribution can be described by its Probability Generating Function (PGF), defined as $G(s) = E[s^X]$.\n\nLet $Y$ be the random variable representing the total number of individuals that ever exist in the process, including the initial ancestor. This is the total progeny, given by $Y = \\sum_{n=0}^{\\infty} Z_n$, where $Z_n$ is the number of individuals in the $n$-th generation. The PGF for the total progeny $Y$ is denoted by $H(s) = E[s^Y]$.\n\nFor a process starting with a single ancestor, the PGF of the total progeny, $H(s)$, satisfies the functional equation $H(s) = sG(H(s))$.\n\nUsing this information, derive a closed-form analytic expression for the variance of the total progeny, $\\operatorname{Var}(Y)$. The final expression should be solely in terms of the offspring mean $\\mu$ and variance $\\sigma^2$.", "solution": "We consider a Galton-Watson process with offspring PGF $G(s)=E[s^{X}]$, mean $E[X]=\\mu$ and variance $\\operatorname{Var}(X)=\\sigma^{2}$, in the subcritical case $\\mu1$. Let $H(s)=E[s^{Y}]$ be the PGF of the total progeny $Y$, which satisfies the functional equation $H(s)=s\\,G(H(s))$ for a single ancestor.\n\nSince the process is subcritical, extinction occurs with probability 1, so the total progeny $Y$ is finite almost surely. Thus $H(1)=E[1^{Y}]=1$. Differentiate the identity $H(s)=sG(H(s))$ with respect to $s$:\n$$\nH'(s)=G(H(s)) + s\\,G'(H(s))\\,H'(s).\n$$\nEvaluating at $s=1$ and using $H(1)=1$, $G(1)=1$, and $G'(1)=\\mu$, we obtain the mean of the total progeny:\n$$\nH'(1)=1+\\mu\\,H'(1) \\quad\\Rightarrow\\quad E[Y] = H'(1)=\\frac{1}{1-\\mu}.\n$$\nTo find the variance, we first find $H''(1)$. Differentiating the expression for $H'(s)$ again gives:\n$$\nH''(s)=G'(H(s))\\,H'(s) + \\left[G'(H(s))\\,H'(s) + s\\left(G''(H(s))\\,(H'(s))^{2} + G'(H(s))\\,H''(s)\\right)\\right].\n$$\nIsolating $H''(s)$:\n$$\nH''(s)\\left(1 - s\\,G'(H(s))\\right)=2\\,G'(H(s))\\,H'(s) + s\\,G''(H(s))\\,(H'(s))^{2}.\n$$\nEvaluating at $s=1$ and using $H(1)=1$ gives\n$$\nH''(1)\\,(1-\\mu)=2\\,\\mu\\,H'(1) + G''(1)\\,(H'(1))^{2}.\n$$\nThe variance of a random variable $Z$ is related to its PGF $P_Z(s)$ by $\\operatorname{Var}(Z) = P_Z''(1) + P_Z'(1) - (P_Z'(1))^2$. For the offspring count $X$, this means $\\sigma^2 = G''(1) + \\mu - \\mu^2$, so $G''(1) = \\sigma^2 + \\mu^2 - \\mu$. Substituting this and $H'(1) = 1/(1-\\mu)$ into the equation for $H''(1)$:\n$$\nH''(1)=\\frac{2\\mu \\cdot \\frac{1}{1-\\mu} + (\\sigma^{2}+\\mu^{2}-\\mu)\\left(\\frac{1}{1-\\mu}\\right)^{2}}{1-\\mu}\n= \\frac{2\\mu}{(1-\\mu)^{2}} + \\frac{\\sigma^{2}+\\mu^{2}-\\mu}{(1-\\mu)^{3}}.\n$$\nNow we compute the variance of the total progeny, $\\operatorname{Var}(Y)$:\n$$\n\\operatorname{Var}(Y)= H''(1) + H'(1) - (H'(1))^{2}\n$$\n$$\n\\operatorname{Var}(Y)=\\left(\\frac{2\\mu}{(1-\\mu)^{2}} + \\frac{\\sigma^{2}+\\mu^{2}-\\mu}{(1-\\mu)^{3}}\\right) + \\frac{1}{1-\\mu} - \\left(\\frac{1}{1-\\mu}\\right)^{2}.\n$$\nCombine the last two terms:\n$$\n\\frac{1}{1-\\mu} - \\frac{1}{(1-\\mu)^{2}} = \\frac{(1-\\mu)-1}{(1-\\mu)^2} = \\frac{-\\mu}{(1-\\mu)^{2}}.\n$$\nSubstituting this back into the expression for the variance:\n$$\n\\operatorname{Var}(Y)=\\frac{2\\mu}{(1-\\mu)^{2}} - \\frac{\\mu}{(1-\\mu)^{2}} + \\frac{\\sigma^{2}+\\mu^{2}-\\mu}{(1-\\mu)^{3}}\n= \\frac{\\mu}{(1-\\mu)^{2}} + \\frac{\\sigma^{2}+\\mu^{2}-\\mu}{(1-\\mu)^{3}}.\n$$\nPutting everything over a common denominator $(1-\\mu)^3$:\n$$\n\\operatorname{Var}(Y)= \\frac{\\mu(1-\\mu) + \\sigma^{2} + \\mu^{2} - \\mu}{(1-\\mu)^{3}}\n= \\frac{\\mu - \\mu^2 + \\sigma^{2} + \\mu^{2} - \\mu}{(1-\\mu)^{3}}\n= \\frac{\\sigma^{2}}{(1-\\mu)^{3}}.\n$$\nThus, the variance of the total progeny is given by:\n$$\n\\operatorname{Var}(Y)=\\frac{\\sigma^{2}}{(1-\\mu)^{3}}.\n$$", "answer": "$$\\boxed{\\frac{\\sigma^{2}}{(1-\\mu)^{3}}}$$", "id": "1304404"}]}