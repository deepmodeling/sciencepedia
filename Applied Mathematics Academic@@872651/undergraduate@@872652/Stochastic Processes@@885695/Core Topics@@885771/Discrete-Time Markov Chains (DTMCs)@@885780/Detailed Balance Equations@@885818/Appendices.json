{"hands_on_practices": [{"introduction": "Finding a system's long-term behavior, or stationary distribution, often requires solving a large system of linear equations. However, for a special class of processes known as reversible Markov chains, the principle of detailed balance offers a much simpler path. This practice problem models the movement of a cleaning robot as a random walk, providing a concrete scenario to apply the detailed balance equations and see how they can dramatically simplify the calculation of the stationary distribution [@problem_id:1296904].", "problem": "A robotic cleaning device operates in a small office suite consisting of four rooms arranged in a straight line: Room 1, Room 2, Room 3, and Room 4. Room 1 is connected only to Room 2. Room 2 is connected to Room 1 and Room 3. Room 3 is connected to Room 2 and Room 4. Room 4 is connected only to Room 3.\n\nThe robot's movement is modeled as a discrete-time Markov chain, where the state is the room the robot currently occupies. At each time step, the robot's control system executes the following algorithm:\n- With a probability of $1/2$, the robot remains in its current room to perform intensive cleaning.\n- With the remaining probability, the robot attempts to move to an adjacent room. If the current room has more than one adjacent room, the robot chooses one of them with equal probability.\n\nAfter a very long time, the robot's location follows a stationary probability distribution. Let $\\pi = (\\pi_1, \\pi_2, \\pi_3, \\pi_4)$ be this stationary distribution, where $\\pi_i$ is the probability of finding the robot in Room $i$.\n\nDetermine the stationary distribution $\\pi$. Express your answer as a row vector of four fractions in simplest form, representing the probabilities $(\\pi_1, \\pi_2, \\pi_3, \\pi_4)$.", "solution": "Model the chain with states indexed by rooms. From the rules:\n- In Rooms 1 and 4 (endpoints with one neighbor), the robot stays with probability $\\frac{1}{2}$ and moves to the unique neighbor with probability $\\frac{1}{2}$.\n- In Rooms 2 and 3 (interior rooms with two neighbors), the robot stays with probability $\\frac{1}{2}$ and moves to each neighbor with probability $\\frac{1}{4}$.\n\nThus the nonzero one-step transition probabilities are\n$$\nP_{11}=\\frac{1}{2},\\quad P_{12}=\\frac{1}{2},\\quad\nP_{21}=\\frac{1}{4},\\quad P_{22}=\\frac{1}{2},\\quad P_{23}=\\frac{1}{4},\n$$\n$$\nP_{32}=\\frac{1}{4},\\quad P_{33}=\\frac{1}{2},\\quad P_{34}=\\frac{1}{4},\\quad\nP_{43}=\\frac{1}{2},\\quad P_{44}=\\frac{1}{2}.\n$$\n\nLet $\\pi=(\\pi_{1},\\pi_{2},\\pi_{3},\\pi_{4})$ be a stationary distribution, so $\\pi=\\pi P$ and $\\sum_{i=1}^{4}\\pi_{i}=1$. The balance equations $\\pi_{j}=\\sum_{i}\\pi_{i}P_{ij}$ are\n$$\n\\pi_{1}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{2},\\qquad\n\\pi_{2}=\\frac{1}{2}\\pi_{2}+\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3},\n$$\n$$\n\\pi_{3}=\\frac{1}{2}\\pi_{3}+\\frac{1}{4}\\pi_{2}+\\frac{1}{2}\\pi_{4},\\qquad\n\\pi_{4}=\\frac{1}{2}\\pi_{4}+\\frac{1}{4}\\pi_{3},\n$$\ntogether with\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=1.\n$$\n\nFrom the first and last of the balance equations,\n$$\n\\pi_{1}-\\frac{1}{2}\\pi_{1}=\\frac{1}{4}\\pi_{2}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{2},\\qquad\n\\pi_{4}-\\frac{1}{2}\\pi_{4}=\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{4}=\\frac{1}{2}\\pi_{3}.\n$$\nUse the second balance equation, subtracting $\\frac{1}{2}\\pi_{2}$ from both sides:\n$$\n\\frac{1}{2}\\pi_{2}=\\frac{1}{2}\\pi_{1}+\\frac{1}{4}\\pi_{3}\\;\\Rightarrow\\;\\pi_{2}=\\pi_{1}+\\frac{1}{2}\\pi_{3}.\n$$\nSubstitute $\\pi_{2}=2\\pi_{1}$ from $\\pi_{1}=\\frac{1}{2}\\pi_{2}$ to get\n$$\n2\\pi_{1}=\\pi_{1}+\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{2}\\pi_{3}\\;\\Rightarrow\\;\\pi_{3}=2\\pi_{1}.\n$$\nThen $\\pi_{4}=\\frac{1}{2}\\pi_{3}=\\pi_{1}$ and $\\pi_{2}=2\\pi_{1}$. Enforce normalization:\n$$\n\\pi_{1}+\\pi_{2}+\\pi_{3}+\\pi_{4}=\\pi_{1}+2\\pi_{1}+2\\pi_{1}+\\pi_{1}=6\\pi_{1}=1\\;\\Rightarrow\\;\\pi_{1}=\\frac{1}{6}.\n$$\nTherefore,\n$$\n\\pi_{2}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{3}=2\\pi_{1}=\\frac{1}{3},\\quad \\pi_{4}=\\pi_{1}=\\frac{1}{6}.\n$$\n\nHence the stationary distribution is\n$$\n\\left(\\frac{1}{6},\\frac{1}{3},\\frac{1}{3},\\frac{1}{6}\\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{6} & \\frac{1}{3} & \\frac{1}{3} & \\frac{1}{6}\\end{pmatrix}}$$", "id": "1296904"}, {"introduction": "The principle of detailed balance is particularly powerful in continuous-time systems, which are common in biophysics and chemistry. This problem explores a hypothetical molecular system to highlight a key feature of detailed balance: its local nature. You will see that it is possible to determine the relative likelihood of finding the system in two different states by only considering the transition rates between them, without needing to solve for the entire system's behavior [@problem_id:1296903].", "problem": "A biophysical system involving a single molecule can be simplified and modeled as a particle performing a random walk among three distinct energy states, labeled 1, 2, and 3. The process is a continuous-time Markov chain. The transition rates between these states are given in terms of a positive constant $\\alpha$, which has units of inverse time:\n\n- The transition rate from state 1 to state 2 is $r_{12} = 2\\alpha$.\n- The transition rate from state 2 to state 1 is $r_{21} = 5\\alpha$.\n- The transition rate from state 2 to state 3 is $r_{23} = 3\\alpha$.\n- The transition rate from state 3 to state 2 is $r_{32} = 4\\alpha$.\n- The transition rate from state 3 to state 1 is $r_{31} = 10\\alpha$.\n- The transition rate from state 1 to state 3 is $r_{13}$, which is a certain constant rate that ensures the process is reversible.\n\nThe system is known to reach a stationary distribution, denoted by $\\{\\pi_1, \\pi_2, \\pi_3\\}$, where $\\pi_i$ is the steady-state probability of finding the molecule in state $i$. Given that the process is reversible, determine the value of the dimensionless ratio of stationary probabilities, $\\pi_2 / \\pi_3$.", "solution": "For a reversible continuous-time Markov chain with stationary distribution $\\{\\pi_{1},\\pi_{2},\\pi_{3}\\}$ and transition rates $r_{ij}$, the detailed balance equations must hold for every bidirectional edge:\n$$\n\\pi_{i} r_{ij} = \\pi_{j} r_{ji}.\n$$\nApplying detailed balance to the pair of states $2$ and $3$ gives\n$$\n\\pi_{2} r_{23} = \\pi_{3} r_{32}.\n$$\nSolving for the desired ratio yields\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{r_{32}}{r_{23}}.\n$$\nSubstituting the given rates $r_{23} = 3\\alpha$ and $r_{32} = 4\\alpha$,\n$$\n\\frac{\\pi_{2}}{\\pi_{3}} = \\frac{4\\alpha}{3\\alpha} = \\frac{4}{3}.\n$$\nThis ratio is independent of $\\alpha$ because it cancels. As a consistency check using the other edges, detailed balance on $(1,2)$ gives $\\pi_{2}/\\pi_{1} = \\frac{2\\alpha}{5\\alpha} = \\frac{2}{5}$, so $\\pi_{3}/\\pi_{1} = \\frac{3}{10}$, and then detailed balance on $(1,3)$ requires $r_{13} = \\frac{\\pi_{3}}{\\pi_{1}} r_{31} = \\frac{3}{10} \\cdot 10\\alpha = 3\\alpha$, which is consistent with reversibility. The requested ratio is therefore $\\frac{4}{3}$.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "1296903"}, {"introduction": "Birth-death processes are a cornerstone of stochastic modeling, used to describe everything from population dynamics to customer queues. A key property of these processes is that they are always reversible, making the detailed balance equations the ideal tool for their analysis. This exercise guides you through a social dynamics model, where you will first derive the system's \"birth\" and \"death\" rates and then apply the detailed balance conditions step-by-step to construct the full stationary distribution [@problem_id:1296899].", "problem": "Consider a simplified model for social dynamics within a small, isolated community of $N=4$ individuals. Each individual can be in one of two states: 'Single' or 'Paired'. The state of the entire system is described by the number of pairs, $n$. This system can be modeled as a continuous-time Markov chain, specifically a birth-death process, on the number of pairs.\n\nThe transitions between states are governed by the following rules:\n1.  **Pairing (Birth):** A new pair can form from any two 'Single' individuals. The total rate of transition from a state with $n$ pairs to $n+1$ pairs is given by the birth rate $\\lambda_n = \\alpha \\binom{S_n}{2}$, where $S_n$ is the number of single individuals when there are $n$ pairs, and $\\alpha$ is a constant pairing rate parameter.\n2.  **Separation (Death):** An existing pair can separate, turning both individuals back into 'Singles'. The total rate of transition from a state with $n$ pairs to $n-1$ pairs is given by the death rate $\\mu_n = \\beta n$, where $\\beta$ is a constant separation rate parameter.\n\nAssume the system has been running long enough to reach a stationary (or equilibrium) state. Given that the ratio of the rate parameters is $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$, calculate the stationary probability that the community consists of exactly two pairs (i.e., all individuals are paired). Express your answer as a fraction in simplest form.", "solution": "Let the state of the system be the number of pairs, $n$. Since there are $N=4$ individuals in total, the number of pairs can be $n=0$, $n=1$, or $n=2$. Thus, the state space of this birth-death process is $\\{0, 1, 2\\}$. Let $\\pi_n$ be the stationary probability of being in state $n$.\n\nFirst, we determine the birth and death rates, $\\lambda_n$ and $\\mu_n$, for each state.\n\nThe number of single individuals, $S_n$, when there are $n$ pairs is $S_n = N - 2n = 4 - 2n$.\n\n**Calculating Birth Rates ($\\lambda_n = \\alpha \\binom{S_n}{2}$):**\n-   For $n=0$: There are $S_0 = 4-2(0) = 4$ single individuals. The birth rate is $\\lambda_0 = \\alpha \\binom{4}{2} = \\alpha \\frac{4 \\times 3}{2} = 6\\alpha$. This is the rate of transition from state 0 to state 1.\n-   For $n=1$: There are $S_1 = 4-2(1) = 2$ single individuals. The birth rate is $\\lambda_1 = \\alpha \\binom{2}{2} = \\alpha \\frac{2 \\times 1}{2} = \\alpha$. This is the rate of transition from state 1 to state 2.\n-   For $n=2$: There are $S_2 = 4-2(2) = 0$ single individuals. The birth rate is $\\lambda_2 = \\alpha \\binom{0}{2} = 0$. No new pairs can form.\n\n**Calculating Death Rates ($\\mu_n = \\beta n$):**\n-   For $n=0$: There are no pairs to separate, so the death rate is $\\mu_0 = \\beta(0) = 0$.\n-   For $n=1$: There is one pair. The death rate is $\\mu_1 = \\beta(1) = \\beta$. This is the rate of transition from state 1 to state 0.\n-   For $n=2$: There are two pairs. The death rate is $\\mu_2 = \\beta(2) = 2\\beta$. This is the rate of transition from state 2 to state 1.\n\nIn a stationary state, a birth-death process satisfies the detailed balance equations:\n$$ \\pi_n \\lambda_n = \\pi_{n+1} \\mu_{n+1} $$\n\nWe can use these equations to express $\\pi_1$ and $\\pi_2$ in terms of $\\pi_0$.\n\nFor $n=0$:\n$$ \\pi_0 \\lambda_0 = \\pi_1 \\mu_1 $$\n$$ \\pi_0 (6\\alpha) = \\pi_1 (\\beta) $$\n$$ \\pi_1 = \\pi_0 \\frac{6\\alpha}{\\beta} $$\n\nFor $n=1$:\n$$ \\pi_1 \\lambda_1 = \\pi_2 \\mu_2 $$\n$$ \\pi_1 (\\alpha) = \\pi_2 (2\\beta) $$\n$$ \\pi_2 = \\pi_1 \\frac{\\alpha}{2\\beta} $$\n\nNow, substitute the expression for $\\pi_1$ into the equation for $\\pi_2$:\n$$ \\pi_2 = \\left( \\pi_0 \\frac{6\\alpha}{\\beta} \\right) \\frac{\\alpha}{2\\beta} = \\pi_0 \\frac{6\\alpha^2}{2\\beta^2} = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 $$\n\nWe are given that the ratio of the rate parameters is $\\frac{\\alpha}{\\beta} = \\frac{1}{3}$. We can substitute this value into the expressions for $\\pi_1$ and $\\pi_2$.\n\n$$ \\pi_1 = 6 \\left( \\frac{\\alpha}{\\beta} \\right) \\pi_0 = 6 \\left( \\frac{1}{3} \\right) \\pi_0 = 2\\pi_0 $$\n$$ \\pi_2 = 3 \\left( \\frac{\\alpha}{\\beta} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{3} \\right)^2 \\pi_0 = 3 \\left( \\frac{1}{9} \\right) \\pi_0 = \\frac{1}{3}\\pi_0 $$\n\nThe sum of all stationary probabilities must equal 1 (the normalization condition):\n$$ \\pi_0 + \\pi_1 + \\pi_2 = 1 $$\n\nSubstitute the expressions in terms of $\\pi_0$:\n$$ \\pi_0 + 2\\pi_0 + \\frac{1}{3}\\pi_0 = 1 $$\n$$ \\left(1 + 2 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(3 + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\left(\\frac{9}{3} + \\frac{1}{3}\\right) \\pi_0 = 1 $$\n$$ \\frac{10}{3} \\pi_0 = 1 $$\n$$ \\pi_0 = \\frac{3}{10} $$\n\nThe problem asks for the probability of having exactly two pairs, which is $\\pi_2$. We can now calculate its value:\n$$ \\pi_2 = \\frac{1}{3}\\pi_0 = \\frac{1}{3} \\left( \\frac{3}{10} \\right) = \\frac{1}{10} $$", "answer": "$$\\boxed{\\frac{1}{10}}$$", "id": "1296899"}]}