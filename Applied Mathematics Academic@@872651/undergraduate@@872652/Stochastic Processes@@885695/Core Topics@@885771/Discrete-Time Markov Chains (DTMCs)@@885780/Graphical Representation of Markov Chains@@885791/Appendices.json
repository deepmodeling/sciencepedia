{"hands_on_practices": [{"introduction": "The first step in analyzing any Markov chain is to visualize its structure. This exercise provides a concrete scenario of a robot's movement to help you practice translating a system's rules into a state transition diagram. By drawing the graph, you can intuitively trace the possible paths of the robot and calculate the probability of returning to a specific state after a set number of steps.[@problem_id:1305824]", "problem": "A small autonomous cleaning robot operates in a square room that is partitioned into a 2x2 grid of four equal quadrants. The quadrants are labeled with coordinates: (1,1) for the top-left, (1,2) for the top-right, (2,1) for the bottom-left, and (2,2) for the bottom-right.\n\nThe robot's movement is modeled as a discrete-time process. At each time step, the robot moves from its current quadrant to one of its adjacent quadrants. Two quadrants are defined as \"adjacent\" if they share a common side (i.e., not just a corner). The robot is equally likely to move to any of its available adjacent quadrants. For instance, from quadrant (1,1), the robot can only move to (1,2) or (2,1).\n\nIf the robot starts in the top-left quadrant, (1,1), what is the probability that it will be back in the top-left quadrant after exactly two time steps? Express your answer as a decimal rounded to two significant figures.", "solution": "Let the state of the system be the quadrant the robot is in. The state space is $S = \\{(1,1), (1,2), (2,1), (2,2)\\}$. We can model the robot's movement as a Markov chain on this state space. Let's assign numerical labels to the states for notational convenience: $1 \\leftrightarrow (1,1)$, $2 \\leftrightarrow (1,2)$, $3 \\leftrightarrow (2,1)$, and $4 \\leftrightarrow (2,2)$.\n\nThe problem asks for the probability of being in state 1 after two steps, given the process starts in state 1. This is the entry $(P^2)_{11}$ of the two-step transition matrix, which is the square of the one-step transition matrix, $P$.\n\nFirst, we construct the one-step transition matrix $P$, where the entry $P_{ij}$ is the probability of moving from state $i$ to state $j$ in one step. The movement rule is a uniform random choice among adjacent quadrants.\n\nFrom state 1, (1,1): The adjacent quadrants are (1,2) and (2,1). So, the robot moves to state 2 or state 3, each with probability $1/2$. The first row of $P$ is $(0, 1/2, 1/2, 0)$.\n$P_{11}=0, P_{12}=1/2, P_{13}=1/2, P_{14}=0$.\n\nFrom state 2, (1,2): The adjacent quadrants are (1,1) and (2,2). So, the robot moves to state 1 or state 4, each with probability $1/2$. The second row of $P$ is $(1/2, 0, 0, 1/2)$.\n$P_{21}=1/2, P_{22}=0, P_{23}=0, P_{24}=1/2$.\n\nFrom state 3, (2,1): The adjacent quadrants are (1,1) and (2,2). So, the robot moves to state 1 or state 4, each with probability $1/2$. The third row of $P$ is $(1/2, 0, 0, 1/2)$.\n$P_{31}=1/2, P_{32}=0, P_{33}=0, P_{34}=1/2$.\n\nFrom state 4, (2,2): The adjacent quadrants are (1,2) and (2,1). So, the robot moves to state 2 or state 3, each with probability $1/2$. The fourth row of $P$ is $(0, 1/2, 1/2, 0)$.\n$P_{41}=0, P_{42}=1/2, P_{43}=1/2, P_{44}=0$.\n\nThe complete one-step transition matrix $P$ is:\n$$\nP = \\begin{pmatrix}\n0 & \\frac{1}{2} & \\frac{1}{2} & 0 \\\\\n\\frac{1}{2} & 0 & 0 & \\frac{1}{2} \\\\\n\\frac{1}{2} & 0 & 0 & \\frac{1}{2} \\\\\n0 & \\frac{1}{2} & \\frac{1}{2} & 0\n\\end{pmatrix}\n$$\n\nThe two-step transition probabilities are the entries of the matrix $P^2 = P \\times P$. We are interested in the probability of returning to state 1 after two steps, starting from state 1. This is the element $(P^2)_{11}$. This can be calculated using the definition of matrix multiplication:\n$$\n(P^2)_{11} = \\sum_{k=1}^{4} P_{1k} P_{k1}\n$$\nUsing the values from the matrix $P$:\n$$\n(P^2)_{11} = P_{11} P_{11} + P_{12} P_{21} + P_{13} P_{31} + P_{14} P_{41}\n$$\nSubstituting the probabilities we found:\n$$\n(P^2)_{11} = (0)(0) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + (0)(0)\n$$\n$$\n(P^2)_{11} = 0 + \\frac{1}{4} + \\frac{1}{4} + 0 = \\frac{2}{4} = \\frac{1}{2}\n$$\nAlternatively, one can reason about the paths. To start at (1,1) and return to (1,1) in two steps, the robot must move to an adjacent quadrant and then immediately move back. The possible paths are:\n1. $(1,1) \\to (1,2) \\to (1,1)$. The probability of this path is $P((1,1)\\to(1,2)) \\times P((1,2)\\to(1,1)) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\n2. $(1,1) \\to (2,1) \\to (1,1)$. The probability of this path is $P((1,1)\\to(2,1)) \\times P((2,1)\\to(1,1)) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$.\nThese two paths are mutually exclusive, so the total probability is the sum of their probabilities: $\\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$.\n\nThe probability is $1/2 = 0.5$. The problem requires the answer to be rounded to two significant figures, which is $0.50$.", "answer": "$$\\boxed{0.50}$$", "id": "1305824"}, {"introduction": "Beyond calculating short-term probabilities, a state diagram reveals crucial insights into the long-term behavior of a Markov chain. This problem challenges you to analyze the graph's connectivity to identify communicating classes and determine whether they are transient or recurrent. Understanding these concepts is fundamental to predicting whether a system will eventually settle into a particular set of states or continue to move between different groups.[@problem_id:1305826]", "problem": "A particle performs a random walk on a set of six states, labeled $S = \\{1, 2, 3, 4, 5, 6\\}$. The connections between the states define the possible transitions for the particle. The topology of these connections forms a \"directed dumbbell\" structure, described as follows:\n\n-   **First Cluster:** States $\\{1, 2, 3\\}$ form a triangle. Bidirectional connections exist along the edges, meaning a particle can move between state 1 and 2, between state 2 and 3, and between state 3 and 1, in either direction.\n-   **Second Cluster:** States $\\{4, 5, 6\\}$ form a second, separate triangle. Similar to the first cluster, bidirectional connections exist along the edges, allowing movement between state 4 and 5, between state 5 and 6, and between state 6 and 4, in either direction.\n-   **Bridge:** A single directed bridge connects the two clusters. A transition is possible from state 3 to state 4, but a transition from state 4 back to state 3 is not possible.\n\nAt each discrete time step, if a particle is at a state $i$, it will move to one of its accessible neighboring states with equal probability. A state $j$ is an accessible neighbor of $i$ if a directed path from $i$ to $j$ exists.\n\nBased on this system, identify all communicating classes and classify each class as either recurrent or transient. Choose the option that correctly describes the classes.\n\nA. One transient class $\\{1, 2, 3\\}$ and one recurrent class $\\{4, 5, 6\\}$.\n\nB. One recurrent class $\\{1, 2, 3\\}$ and one transient class $\\{4, 5, 6\\}$.\n\nC. One communicating class $\\{1, 2, 3, 4, 5, 6\\}$ which is recurrent.\n\nD. Two recurrent classes, $\\{1, 2, 3\\}$ and $\\{4, 5, 6\\}$.\n\nE. Two transient classes, $\\{1, 2, 3\\}$ and $\\{4, 5, 6\\}$.\n\nF. Six communicating classes, $\\{1\\}, \\{2\\}, \\{3\\}, \\{4\\}, \\{5\\}, \\{6\\}$, all of which are transient.", "solution": "To solve this, we first identify the communicating classes and then determine if they are recurrent or transient.\n\n**Step 1: Identify Communicating Classes**\nA communicating class is a maximal set of states where every state can reach every other state in the set.\n- The states $\\{1, 2, 3\\}$ form a fully connected cluster with bidirectional edges. Any state in this set can reach any other state in the set (e.g., $1 \\leftrightarrow 2$, $2 \\leftrightarrow 3$, $1 \\leftrightarrow 3$). Thus, $\\{1, 2, 3\\}$ is a communicating class.\n- Similarly, states $\\{4, 5, 6\\}$ form another fully connected cluster. Thus, $\\{4, 5, 6\\}$ is a second communicating class.\n- There is a directed edge from state 3 to state 4. This means any state in $\\{4, 5, 6\\}$ is reachable from any state in $\\{1, 2, 3\\}$. However, there are no edges leading from the $\\{4, 5, 6\\}$ cluster back to the $\\{1, 2, 3\\}$ cluster. Therefore, no state in $\\{1, 2, 3\\}$ is reachable from any state in $\\{4, 5, 6\\}$.\n- Since communication requires reachability in both directions, the two sets are distinct communicating classes. The communicating classes are $\\{1, 2, 3\\}$ and $\\{4, 5, 6\\}$.\n\n**Step 2: Classify Classes as Recurrent or Transient**\nFor a finite-state Markov chain:\n- A communicating class is **recurrent** if it is a \"closed\" set, meaning there are no transitions leading out of the class. Once the process enters a closed class, it can never leave.\n- A communicating class is **transient** if it is not closed.\n\nLet's apply this to our classes:\n- The class $\\{4, 5, 6\\}$ is **closed**. If the particle is in any of states 4, 5, or 6, all possible transitions lead to other states within this same set. There is no escape. Therefore, $\\{4, 5, 6\\}$ is a recurrent class.\n- The class $\\{1, 2, 3\\}$ is **not closed**. It is possible to transition from state 3 to state 4, which is outside the class. Once the particle leaves the $\\{1, 2, 3\\}$ class, it enters the recurrent class $\\{4, 5, 6\\}$ and can never return. Therefore, $\\{1, 2, 3\\}$ is a transient class.\n\nConclusion: We have one transient class, $\\{1, 2, 3\\}$, and one recurrent class, $\\{4, 5, 6\\}$. This corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1305826"}, {"introduction": "Graphical representations are not just for qualitative analysis; they are powerful tools for quantitative problem-solving. This practice introduces the concept of expected hitting timeâ€”the average time it takes to reach a target state. You will use a technique called first-step analysis, where the state diagram guides you in setting up a system of linear equations to find this expected value, a common task in fields like network analysis and computational biology.[@problem_id:1305793]", "problem": "Consider a distributed computing system modeled as a network of nodes. The system consists of one central router, labeled $R_0$, and $N$ identical peripheral compute nodes, labeled $C_1, C_2, \\ldots, C_N$, where $N \\ge 2$. A data packet, or \"token,\" moves between these nodes in discrete time steps according to a specific routing protocol, forming a discrete-time Markov chain.\n\nThe transition rules are defined as follows:\n- From the central router $R_0$, the token is forwarded to any of the $N$ compute nodes with equal probability.\n- From any compute node $C_i$ (for $i \\in \\{1, 2, \\ldots, N\\}$), the token is sent back to the central router $R_0$ with probability $p$, where $0 < p \\le 1$.\n- With the remaining probability, $1-p$, the token is forwarded from compute node $C_i$ to a different compute node $C_j$ (where $j \\neq i$). The destination node $C_j$ is chosen uniformly at random from the set of all other $N-1$ compute nodes.\n\nSuppose the token starts at compute node $C_1$. Determine the expected number of time steps until the token first arrives at compute node $C_2$. Provide your answer as a closed-form analytical expression in terms of $N$ and $p$.", "solution": "Let $E_{i}$ be the expected number of steps to hit state $C_2$ starting from state $i$. By symmetry, the problem can be simplified by defining three types of states: the starting node $C_1$, the target node $C_2$, the central router $R_0$, and any other compute node $C_k$ where $k \\notin \\{1,2\\}$.\nLet $E_1$ be the expected time starting from $C_1$.\nLet $E_0$ be the expected time starting from $R_0$.\nLet $E_o$ be the expected time starting from any \"other\" compute node $C_k$ (where $k \\notin \\{1,2\\}$).\nThe target state is $C_2$, so the expected number of further steps from $C_2$ is $0$.\n\nWe can set up a system of linear equations using first-step analysis, where $E_i = 1 + \\sum_{j} P_{ij} E_j$.\n\n-   Starting from $R_0$: The token moves to $C_1$ (prob $1/N$), to $C_2$ (prob $1/N$), or to one of the $N-2$ \"other\" nodes (prob $(N-2)/N$).\n    $$E_0 = 1 + \\frac{1}{N} E_1 + \\frac{1}{N}(0) + \\frac{N-2}{N} E_o$$\n\n-   Starting from $C_1$: The token moves to $R_0$ (prob $p$), to $C_2$ (prob $(1-p)/(N-1)$), or to one of the $N-2$ \"other\" nodes (prob $(N-2)(1-p)/(N-1)$).\n    $$E_1 = 1 + p E_0 + \\frac{1-p}{N-1} (0) + \\frac{N-2}{N-1}(1-p) E_o$$\n\n-   Starting from an \"other\" node $C_o$: The token moves to $R_0$ (prob $p$), to $C_1$ (prob $(1-p)/(N-1)$), to $C_2$ (prob $(1-p)/(N-1)$), or to one of the $N-3$ remaining \"other\" nodes.\n    $$E_o = 1 + p E_0 + \\frac{1-p}{N-1} E_1 + \\frac{1-p}{N-1}(0) + \\frac{N-3}{N-1}(1-p) E_o$$\n\nOur system of equations is:\n1. $E_0 = 1 + \\frac{1}{N} E_1 + \\frac{N-2}{N} E_o$\n2. $E_1 = 1 + p E_0 + \\frac{(N-2)(1-p)}{N-1} E_o$\n3. $E_o = 1 + p E_0 + \\frac{1-p}{N-1} E_1 + \\frac{(N-3)(1-p)}{N-1} E_o$\n\nFrom (2) and (3), we can subtract the terms $1+pE_0$ from both sides to see the relationship between $E_1$ and $E_o$:\n$$E_1 - (1+pE_0) = \\frac{(N-2)(1-p)}{N-1} E_o$$\n$$E_o - (1+pE_0) = \\frac{1-p}{N-1} E_1 + \\frac{(N-3)(1-p)}{N-1} E_o$$\nBy subtracting the second of these new equations from the first, we get:\n$$(E_1 - E_o) = \\left(\\frac{(N-2)(1-p)}{N-1}\\right)E_o - \\left(\\frac{1-p}{N-1} E_1 + \\frac{(N-3)(1-p)}{N-1} E_o\\right)$$\n$$E_1 - E_o = -\\frac{1-p}{N-1}E_1 + \\left(\\frac{(N-2)(1-p)}{N-1} - \\frac{(N-3)(1-p)}{N-1}\\right)E_o$$\n$$E_1 - E_o = -\\frac{1-p}{N-1}E_1 + \\frac{1-p}{N-1}E_o$$\n$$E_1 \\left(1 + \\frac{1-p}{N-1}\\right) = E_o \\left(1 + \\frac{1-p}{N-1}\\right)$$\nThis implies $E_1 = E_o$.\n\nNow we substitute $E_1 = E_o$ into equation (1):\n$E_0 = 1 + \\frac{1}{N} E_1 + \\frac{N-2}{N} E_1 = 1 + \\frac{N-1}{N} E_1$.\n\nFinally, substitute this expression for $E_0$ and $E_1=E_o$ into equation (2):\n$$E_1 = 1 + p\\left(1 + \\frac{N-1}{N} E_1\\right) + \\frac{(N-2)(1-p)}{N-1} E_1$$\n$$E_1 = 1 + p + p\\frac{N-1}{N} E_1 + \\frac{(N-2)(1-p)}{N-1} E_1$$\nCollect terms of $E_1$ on the left side:\n$$E_1 \\left(1 - p\\frac{N-1}{N} - \\frac{(N-2)(1-p)}{N-1}\\right) = 1+p$$\nThe term in the parenthesis simplifies:\n$$ \\frac{N(N-1)}{N(N-1)} - \\frac{p(N-1)^2}{N(N-1)} - \\frac{N(N-2)(1-p)}{N(N-1)} = \\frac{N^2-N - p(N^2-2N+1) - (N^2-2N)(1-p)}{N(N-1)} $$\n$$ = \\frac{N^2-N - pN^2+2pN-p - (N^2-2N-pN^2+2pN)}{N(N-1)} = \\frac{N-p}{N(N-1)} $$\nSo, we have:\n$$E_1 \\cdot \\frac{N-p}{N(N-1)} = 1+p$$\nSolving for $E_1$:\n$$E_1 = \\frac{N(N-1)(1+p)}{N-p}$$\nThus, the expected number of steps from $C_{1}$ to $C_{2}$ is $\\frac{N(N-1)(1+p)}{N-p}$.", "answer": "$$\\boxed{\\frac{N(N-1)(1+p)}{N-p}}$$", "id": "1305793"}]}