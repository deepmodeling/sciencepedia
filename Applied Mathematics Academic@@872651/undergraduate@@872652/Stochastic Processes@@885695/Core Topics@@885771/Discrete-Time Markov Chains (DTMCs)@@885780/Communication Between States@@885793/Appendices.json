{"hands_on_practices": [{"introduction": "To begin analyzing a Markov chain, our first task is to map out the possible pathways through the system. We need to determine which states are reachable from others, a concept known as accessibility. This exercise [@problem_id:1290007] provides a simple, intuitive model of an elevator to practice this fundamental skill. By tracing the possible transitions, you will determine if two states \"communicate\" with each other, meaning each is accessible from the other, laying the groundwork for understanding the chain's overall structure.", "problem": "Consider a simplified model for the operation of an elevator in a two-story building. The state of the elevator is observed at discrete time steps. The system can be in one of four states:\n- $S_1$: Idle at Floor 1.\n- $S_2$: Moving from Floor 1 to Floor 2.\n- $S_3$: Idle at Floor 2.\n- $S_4$: Moving from Floor 2 to Floor 1.\n\nThe transitions between states are probabilistic and are governed by the following rules:\n1.  If the elevator is in state $S_1$ (Idle at Floor 1), there is a probability $p_u$ that a passenger request will cause it to enter state $S_2$ (Moving Up) in the next time step. Otherwise, it remains in state $S_1$.\n2.  If the elevator is in state $S_3$ (Idle at Floor 2), there is a probability $p_d$ that a passenger request will cause it to enter state $S_4$ (Moving Down) in the next time step. Otherwise, it remains in state $S_3$.\n3.  If the elevator is in state $S_2$ (Moving Up), there is a small probability $\\epsilon$ of a minor mechanical fault that forces an immediate reset, returning it to state $S_1$ in the next time step. If no fault occurs, it successfully reaches state $S_3$ in the next time step.\n4.  If the elevator is in state $S_4$ (Moving Down), it will always complete its journey and arrive at Floor 1, thus entering state $S_1$ in the next time step.\n\nLet the probabilities be $p_u = 0.85$, $p_d = 0.60$, and $\\epsilon = 0.05$.\n\nIn the context of stochastic processes, state $j$ is said to be accessible from state $i$ if it is possible to get from state $i$ to state $j$ in a finite number of steps with a non-zero probability. Two states are said to be mutually accessible if each is accessible from the other.\n\nWhich of the following statements correctly describes the relationship between the state \"Moving Up\" ($S_2$) and the state \"Moving Down\" ($S_4$)?\n\nA. $S_2$ is accessible from $S_4$, but $S_4$ is not accessible from $S_2$.\n\nB. $S_4$ is accessible from $S_2$, but $S_2$ is not accessible from $S_4$.\n\nC. $S_2$ and $S_4$ are mutually accessible.\n\nD. Neither state is accessible from the other.\n\nE. The accessibility relationship depends on the initial state of the system.", "solution": "We model the elevator as a discrete-time Markov chain with states $S_1$ (Idle at Floor 1), $S_2$ (Moving Up), $S_3$ (Idle at Floor 2), and $S_4$ (Moving Down). The nonzero one-step transition probabilities are:\n$$\nP(S_1 \\to S_2) = p_u, \\quad P(S_1 \\to S_1) = 1-p_u,\n$$\n$$\nP(S_3 \\to S_4) = p_d, \\quad P(S_3 \\to S_3) = 1-p_d,\n$$\n$$\nP(S_2 \\to S_1) = \\epsilon, \\quad P(S_2 \\to S_3) = 1-\\epsilon,\n$$\n$$\nP(S_4 \\to S_1) = 1.\n$$\nAccessibility means there exists a finite number of steps with nonzero probability to go from one state to the other.\n\nTo check whether $S_4$ is accessible from $S_2$, consider the two-step path $S_2 \\to S_3 \\to S_4$. Its probability is\n$$\nP(S_2 \\to S_3) \\cdot P(S_3 \\to S_4) = (1-\\epsilon)p_d.\n$$\nGiven $p_d > 0$ and $1-\\epsilon > 0$, this product is strictly positive, so $S_4$ is accessible from $S_2$.\n\nTo check whether $S_2$ is accessible from $S_4$, consider the two-step path $S_4 \\to S_1 \\to S_2$. Its probability is\n$$\nP(S_4 \\to S_1) \\cdot P(S_1 \\to S_2) = 1 \\cdot p_u = p_u.\n$$\nGiven $p_u > 0$, this is strictly positive, so $S_2$ is accessible from $S_4$.\n\nSince each state is accessible from the other in a finite number of steps with nonzero probability, $S_2$ and $S_4$ are mutually accessible. This corresponds to option C.", "answer": "$$\\boxed{C}$$", "id": "1290007"}, {"introduction": "Once we understand pairwise communication, we can partition the entire state space into distinct \"communicating classes.\" This is a crucial step that reveals the large-scale structure of a stochastic process and allows us to classify states as either transient or recurrent. This problem [@problem_id:1290025] models a data-processing automaton with an absorbing state, providing a perfect scenario to practice identifying these classes and understanding their properties, such as which parts of the system are temporary and which are final destinations.", "problem": "A research team is modeling the behavior of a specialized automaton designed to parse a proprietary communication protocol. The automaton's state at any discrete time step is determined by the type of data packet it is currently processing. The system can be modeled as a discrete-time Markov chain with four possible states: `SYNC` (Synchronization), `DATA` (Data Payload), `CTRL` (Control), and `ACK` (Acknowledgement).\n\nThe state transitions are governed by the following probabilistic rules:\n- From state `SYNC`, the automaton always transitions to state `DATA`.\n- From state `DATA`, it transitions back to `DATA` with a probability of 0.6 or to `CTRL` with a probability of 0.4.\n- From state `CTRL`, it transitions to `ACK` with a probability of 0.8 or to `SYNC` with a probability of 0.2.\n- From state `ACK`, it always transitions back to `ACK`.\n\nBased on this model, which of the following statements about the relationships between the states is true?\n\nA. The states `SYNC` and `ACK` communicate with each other.\n\nB. The state `DATA` is a recurrent state.\n\nC. The set of states {`SYNC`, `DATA`, `CTRL`} forms a single communicating class.\n\nD. The entire Markov chain is irreducible.\n\nE. The state `ACK` is a transient state.", "solution": "Let the state space be $S=\\{\\text{SYNC},\\text{DATA},\\text{CTRL},\\text{ACK}\\}$. The one-step transition probabilities are:\n$$P(\\text{SYNC}\\to\\text{DATA})=1,$$\n$$P(\\text{DATA}\\to\\text{DATA})=0.6, \\quad P(\\text{DATA}\\to\\text{CTRL})=0.4,$$\n$$P(\\text{CTRL}\\to\\text{ACK})=0.8, \\quad P(\\text{CTRL}\\to\\text{SYNC})=0.2,$$\n$$P(\\text{ACK}\\to\\text{ACK})=1.$$\n\nTo test communication, recall that states $i$ and $j$ communicate if there exist $m, n \\in \\mathbb{N}$ with $P^m_{ij} > 0$ and $P^n_{ji} > 0$.\n\n1) For statement A, SYNC reaches ACK with\n$P^3_{\\text{SYNC},\\text{ACK}} \\ge P_{\\text{SYNC},\\text{DATA}}P_{\\text{DATA},\\text{CTRL}}P_{\\text{CTRL},\\text{ACK}} = 1 \\cdot 0.4 \\cdot 0.8 > 0.$\nHowever, from ACK we have $P(\\text{ACK}\\to\\text{ACK})=1$, so for every $n \\ge 1$, $P^n_{\\text{ACK},j}=0$ for any $j \\neq \\text{ACK}$. Thus ACK cannot reach SYNC, so they do not communicate. Hence A is false.\n\n2) For statement B, consider DATA. From DATA, the time to first hit CTRL is geometric with success probability $0.4$, so the probability to eventually hit CTRL is $1$. From CTRL, with probability $0.8$ the chain goes to ACK, and with probability $0.2$ it goes to SYNC $\\to$ DATA and repeats. The probability to avoid ACK forever would be $\\lim_{n\\to\\infty}(0.2)^n = 0$, so the probability to be absorbed in ACK eventually (starting from DATA) is $1$. Since from ACK no other state is reachable, the probability of infinitely many returns to DATA is $0$, so DATA is transient, not recurrent. Hence B is false.\n\n3) For statement C, check pairwise communication within $\\{\\text{SYNC},\\text{DATA},\\text{CTRL}\\}$:\n- $\\text{SYNC}\\to\\text{DATA}$ has $P_{\\text{SYNC},\\text{DATA}}=1$, and $\\text{DATA}\\to\\text{SYNC}$ has\n$P^2_{\\text{DATA},\\text{SYNC}} \\ge P_{\\text{DATA},\\text{CTRL}}P_{\\text{CTRL},\\text{SYNC}} = 0.4 \\cdot 0.2 > 0.$\n- $\\text{SYNC}\\to\\text{CTRL}$ has\n$P^2_{\\text{SYNC},\\text{CTRL}} \\ge P_{\\text{SYNC},\\text{DATA}}P_{\\text{DATA},\\text{CTRL}} = 1 \\cdot 0.4 > 0,$\nand $\\text{CTRL}\\to\\text{SYNC}$ has $P_{\\text{CTRL},\\text{SYNC}} = 0.2 > 0.$\n- $\\text{DATA}\\to\\text{CTRL}$ has $P_{\\text{DATA},\\text{CTRL}} = 0.4 > 0$, and $\\text{CTRL}\\to\\text{DATA}$ has\n$P^2_{\\text{CTRL},\\text{DATA}} \\ge P_{\\text{CTRL},\\text{SYNC}}P_{\\text{SYNC},\\text{DATA}} = 0.2 \\cdot 1 > 0.$\nThus all three states communicate pairwise, forming a single communicating class. Note this class is not closed because $P_{\\text{CTRL},\\text{ACK}} = 0.8 > 0$. Therefore C is true.\n\n4) For statement D, a chain is irreducible if there is a single communicating class. Here ACK does not communicate with any other state (it is absorbing), so there are at least two communicating classes: $\\{\\text{SYNC},\\text{DATA},\\text{CTRL}\\}$ and $\\{\\text{ACK}\\}$. Hence D is false.\n\n5) For statement E, since $P(\\text{ACK}\\to\\text{ACK})=1$, starting from ACK the chain returns to ACK in one step with probability $1$, so ACK is recurrent (indeed absorbing), not transient. Hence E is false.\n\nThe only true statement is C.", "answer": "$$\\boxed{C}$$", "id": "1290025"}, {"introduction": "This final practice exercise is designed to deepen your understanding of the fundamental principles of communication. The definition of accessibility relies on the existence of a path with any non-zero probability, regardless of how small that probability might be. This thought experiment [@problem_id:1290034] challenges your intuition by introducing a system where the transition rules themselves are chosen randomly at each step. By working through it, you will reinforce the core idea that if a pathway is possible, even intermittently, it can be sufficient to establish communication between states.", "problem": "A particle performs a random walk on a finite set of states $S = \\{1, 2, \\dots, N\\}$. The process is a Markov chain, but with a stochastic twist. At each discrete time step, the transition law is chosen randomly: with probability $p$, the transition probability matrix is $P_A$, and with probability $1-p$, it is $P_B$. The choice is made independently at each step. We are given that $p$ is a fixed value such that $0  p  1$.\n\nConsider two distinct states $i$ and $j$ from the set $S$. We are given the following information about the communication properties of these states under the individual matrices:\n\n1.  For a standard Markov chain governed solely by the transition matrix $P_A$, states $i$ and $j$ **do not** communicate. This means it is either not possible to reach state $j$ from state $i$, or not possible to reach state $i$ from state $j$ (or both).\n2.  For a standard Markov chain governed solely by the transition matrix $P_B$, states $i$ and $j$ **do** communicate. This means it is possible to reach state $j$ from state $i$ in a finite number of steps, and it is also possible to reach state $i$ from state $j$ in a finite number of steps.\n\nBased on this information, determine whether states $i$ and $j$ communicate in the actual combined process where the transition matrix is randomly selected at each step.\n\nA. Yes, states $i$ and $j$ always communicate.\n\nB. No, states $i$ and $j$ never communicate because the presence of $P_A$ can always break the communication path.\n\nC. States $i$ and $j$ communicate if and only if $p  0.5$.\n\nD. States $i$ and $j$ communicate if and only if the number of states $N$ is even.\n\nE. Whether they communicate depends on the specific entries of the matrices $P_A$ and $P_B$, so there is not enough information to make a general conclusion.", "solution": "Let $S=\\{1,2,\\dots,N\\}$ and let the two given stochastic matrices be $P_A$ and $P_B$. Fix distinct states $i$ and $j$. By hypothesis for the $P_B$-chain alone, there exist positive integers $m_1$ and $m_2$ such that\n$(P_B^{m_1})_{ij} > 0 \\quad \\text{and} \\quad (P_B^{m_2})_{ji} > 0.$\nAt each step of the combined process, the chosen kernel is $P_A$ with probability $p$ and $P_B$ with probability $1-p$, independently across steps, with $0  p  1$.\n\nFor any $n \\in \\mathbb{N}$, let $\\Sigma_n = \\{A,B\\}^n$ denote the set of length-$n$ sequences of kernel choices. For $\\sigma=(\\sigma_1, \\dots, \\sigma_n) \\in \\Sigma_n$, define the weight\n$$w(\\sigma) = p^{k(\\sigma)}(1-p)^{n-k(\\sigma)},$$\nwhere $k(\\sigma)$ is the number of indices $t$ with $\\sigma_t=A$. Let $P_{\\sigma_1} \\cdots P_{\\sigma_n}$ be the corresponding product of kernels. Then the $n$-step transition probability in the combined process from $i$ to $j$ is\n$$\\sum_{\\sigma \\in \\Sigma_n} w(\\sigma)\\,\\bigl(P_{\\sigma_1} P_{\\sigma_2} \\cdots P_{\\sigma_n}\\bigr)_{ij}.$$\nAll terms in this sum are nonnegative. Therefore, for any specific sequence $\\sigma$, the sum is bounded below by the single-term contribution of $\\sigma$.\n\nChoose $\\sigma^*=(B,B,\\dots,B) \\in \\Sigma_{m_1}$ consisting of $m_1$ copies of $B$. Its weight is $w(\\sigma^*) = (1-p)^{m_1} > 0$ and the product is $P_{\\sigma^*_1} \\cdots P_{\\sigma^*_{m_1}} = P_B^{m_1}$. Hence\n$$\\sum_{\\sigma \\in \\Sigma_{m_1}} w(\\sigma)\\,\\bigl(P_{\\sigma_1} \\cdots P_{\\sigma_{m_1}}\\bigr)_{ij} \\;\\ge\\; (1-p)^{m_1}\\,(P_B^{m_1})_{ij}\\; > \\;0.$$\nThis shows that in the combined process there is a positive probability to go from $i$ to $j$ in $m_1$ steps. Repeating the same argument with $m_2$ and reversing the roles of $i$ and $j$, choose $\\tilde{\\sigma}^*=(B,\\dots,B) \\in \\Sigma_{m_2}$ to obtain\n$$\\sum_{\\sigma \\in \\Sigma_{m_2}} w(\\sigma)\\,\\bigl(P_{\\sigma_1} \\cdots P_{\\sigma_{m_2}}\\bigr)_{ji} \\;\\ge\\; (1-p)^{m_2}\\,(P_B^{m_2})_{ji} \\;> \\;0,$$\nso there is also a positive probability to go from $j$ to $i$ in $m_2$ steps.\n\nTherefore, states $i$ and $j$ communicate in the combined process. This conclusion holds for every $p$ with $0  p  1$ and does not depend on $N$ or on the entries of $P_A$ beyond the given conditions. Consequently, the correct choice is that they always communicate.", "answer": "$$\\boxed{A}$$", "id": "1290034"}]}