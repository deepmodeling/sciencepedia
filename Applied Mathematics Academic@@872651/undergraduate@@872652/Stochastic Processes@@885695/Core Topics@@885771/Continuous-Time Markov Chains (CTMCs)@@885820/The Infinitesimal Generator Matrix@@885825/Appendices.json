{"hands_on_practices": [{"introduction": "Before we can use an infinitesimal generator matrix $Q$ to model a system, we must first ensure it is mathematically valid. This exercise [@problem_id:1338866] focuses on the fundamental properties that any generator matrix must satisfy: its off-diagonal elements must be non-negative, and each of its rows must sum to zero. By solving for an unknown parameter, you will practice applying these foundational rules, which are direct consequences of how we model transition rates and probabilities in continuous time.", "problem": "In the study of a particular chemical reaction involving three intermediate species (State 1, State 2, and State 3), the system is modeled as a continuous-time Markov chain. The transition rates between the states are proposed to be governed by the following infinitesimal generator matrix $Q$:\n$$\nQ = \\begin{pmatrix}\n-5.0 & 3.0 & c \\\\\n1.5 & -2.5 & 1.0 \\\\\n0.5 & 4.5 - 2c & -1.0\n\\end{pmatrix}\n$$\nwhere $c$ is a real constant representing a reaction rate coefficient. For $Q$ to be a valid infinitesimal generator matrix, it must satisfy specific mathematical properties. Determine the value of $c$ that ensures $Q$ is a valid infinitesimal generator matrix.", "solution": "For a matrix $Q$ to be a valid infinitesimal generator of a continuous-time Markov chain, it must satisfy:\n- Nonnegativity of off-diagonal entries: $q_{ij} \\geq 0$ for all $i \\neq j$.\n- Row sums equal zero: for each row $i$, $\\sum_{j} q_{ij} = 0$.\n\nApply the row-sum condition to each row of the given $Q$.\n\nRow 1 sum:\n$$\n-5.0 + 3.0 + c = 0 \\quad \\Rightarrow \\quad c = 2.0.\n$$\n\nRow 2 sum:\n$$\n1.5 - 2.5 + 1.0 = 0,\n$$\nwhich is already satisfied and imposes no constraint on $c$.\n\nRow 3 sum:\n$$\n0.5 + (4.5 - 2c) - 1.0 = 0 \\quad \\Rightarrow \\quad 4.0 - 2c = 0 \\quad \\Rightarrow \\quad c = 2.0.\n$$\n\nBoth Row 1 and Row 3 enforce $c = 2.0$, yielding a consistent value.\n\nNext, verify nonnegativity of off-diagonal entries with $c = 2.0$:\n- $q_{12} = 3.0 \\geq 0$, $q_{13} = c = 2.0 \\geq 0$,\n- $q_{21} = 1.5 \\geq 0$, $q_{23} = 1.0 \\geq 0$,\n- $q_{31} = 0.5 \\geq 0$, $q_{32} = 4.5 - 2c = 4.5 - 4.0 = 0.5 \\geq 0$.\n\nThe diagonal entries are negative as required, and with $c = 2.0$ each row sums to zero, so $Q$ is a valid infinitesimal generator.\n\nTherefore, the value ensuring validity is $c = 2$.", "answer": "$$\\boxed{2}$$", "id": "1338866"}, {"introduction": "The entries of a generator matrix are not just abstract numbers; they have direct physical interpretations. This practice [@problem_id:1338871] explores the crucial link between the diagonal entries of $Q$ and the behavior of the system over time. You will learn that the magnitude of a diagonal entry, $q_{ii}$, represents the total rate of leaving state $i$, and its reciprocal is the expected time the system will spend, or \"hold,\" in that state before making a jump.", "problem": "The operational status of a particular server in a data center is modeled as a continuous-time Markov chain. The server can be in one of three states: State 1 (Online), State 2 (Throttled), or State 3 (Offline). The transitions between these states are governed by the infinitesimal generator matrix $Q$, where the entries represent transition rates in events per hour.\n\nThe generator matrix is given by:\n$$\nQ = \\begin{pmatrix}\n-1.5 & 1.0 & 0.5 \\\\\n3.0 & -7.5 & 4.5 \\\\\n2.0 & 0.0 & -2.0\n\\end{pmatrix}\n$$\n\nCalculate the expected amount of time the server spends in the 'Throttled' state (State 2) each time it enters this state, before transitioning to a different state. Express your answer in hours as a rational number in simplest form.", "solution": "For a continuous-time Markov chain with generator matrix $Q=\\{q_{ij}\\}$, the sojourn (holding) time in state $i$ on any visit is exponentially distributed with rate $\\lambda_{i}=-q_{ii}=\\sum_{j\\neq i}q_{ij}$. The expected holding time in state $i$ is therefore\n$$\n\\mathbb{E}[T_{i}]=\\frac{1}{-q_{ii}}=\\frac{1}{\\sum_{j\\neq i}q_{ij}}.\n$$\nFor State $2$, the off-diagonal rates are $q_{21}=3.0=3$ and $q_{23}=4.5=\\frac{9}{2}$, so the total rate of leaving State $2$ is\n$$\n\\lambda_{2}=q_{21}+q_{23}=3+\\frac{9}{2}=\\frac{15}{2}.\n$$\nHence, the expected time spent in the Throttled state on each visit is\n$$\n\\mathbb{E}[T_{2}]=\\frac{1}{\\lambda_{2}}=\\frac{1}{\\frac{15}{2}}=\\frac{2}{15}\\ \\text{hours}.\n$$", "answer": "$$\\boxed{\\frac{2}{15}}$$", "id": "1338871"}, {"introduction": "One of the most powerful applications of a generator matrix is predicting a system's long-term behavior. This exercise [@problem_id:1338886] guides you through calculating the stationary distribution, denoted by the vector $\\pi$. These probabilities, which satisfy the balance equation $\\pi Q = \\mathbf{0}$, describe the fraction of time the system will spend in each state after it has reached equilibrium, providing critical insight into its steady-state dynamics.", "problem": "A simplified model for a single ion channel in a cell membrane considers two states: State 1 (Open) and State 2 (Closed). The channel's state fluctuates over time according to a continuous-time stochastic process. The transition from the Open state to the Closed state occurs with a constant rate $\\alpha > 0$. The transition from the Closed state back to the Open state occurs with a constant rate $\\beta > 0$. This means that if the channel is in State 1 at time $t$, the probability it transitions to State 2 in the next infinitesimal time interval $dt$ is $\\alpha dt$. Similarly, if it is in State 2, the probability of transitioning to State 1 in the same interval is $\\beta dt$.\n\nAfter the system has run for a sufficiently long time, it is expected to reach an equilibrium where the probability of being in either state becomes constant. Let these long-run probabilities be $\\pi_1$ for the Open state and $\\pi_2$ for the Closed state.\n\nFind the expressions for $\\pi_1$ and $\\pi_2$ in terms of the rates $\\alpha$ and $\\beta$. Your final answer should be a pair of expressions $(\\pi_1, \\pi_2)$.", "solution": "We model the channel as a two-state continuous-time Markov chain with states 1 (Open) and 2 (Closed). The transition rates are: from 1 to 2 at rate $\\alpha$ and from 2 to 1 at rate $\\beta$. The generator matrix $Q$ can be written as\n$$\nQ=\\begin{pmatrix}\n-\\alpha & \\alpha \\\\\n\\beta & -\\beta\n\\end{pmatrix},\n$$\nwhere each row sums to zero and $q_{ij}$ for $i\\neq j$ is the transition rate from state $i$ to state $j$.\n\nLet $\\pi_{1}$ and $\\pi_{2}$ denote the stationary (long-run) probabilities of being in states 1 and 2, respectively. At stationarity, the probability flux out of each state equals the flux into that state. Equivalently, the stationary distribution satisfies the global balance (or stationarity) equations\n$$\n\\pi Q=\\mathbf{0}, \\quad \\text{with} \\quad \\pi=\\begin{pmatrix}\\pi_{1} & \\pi_{2}\\end{pmatrix}, \\quad \\pi_{1}+\\pi_{2}=1.\n$$\nWriting $\\pi Q=\\mathbf{0}$ component-wise gives\n$$\n-\\alpha \\pi_{1}+\\beta \\pi_{2}=0, \\quad \\alpha \\pi_{1}-\\beta \\pi_{2}=0,\n$$\nwhich are equivalent; they express detailed balance as\n$$\n\\alpha \\pi_{1}=\\beta \\pi_{2}.\n$$\nUsing the normalization $\\pi_{1}+\\pi_{2}=1$, we solve:\n$$\n\\pi_{2}=\\frac{\\alpha}{\\beta}\\pi_{1}, \\quad \\pi_{1}+\\frac{\\alpha}{\\beta}\\pi_{1}=1 \\;\\;\\Rightarrow\\;\\; \\pi_{1}\\left(1+\\frac{\\alpha}{\\beta}\\right)=1 \\;\\;\\Rightarrow\\;\\; \\pi_{1}=\\frac{\\beta}{\\alpha+\\beta}.\n$$\nSubstituting back gives\n$$\n\\pi_{2}=\\frac{\\alpha}{\\alpha+\\beta}.\n$$\nTherefore, the stationary probabilities are\n$$\n\\pi_{1}=\\frac{\\beta}{\\alpha+\\beta}, \\qquad \\pi_{2}=\\frac{\\alpha}{\\alpha+\\beta}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\beta}{\\alpha+\\beta} & \\frac{\\alpha}{\\alpha+\\beta}\\end{pmatrix}}$$", "id": "1338886"}]}