{"hands_on_practices": [{"introduction": "Understanding the dynamics of nonlinear systems often begins with visualizing their behavior in phase space. This exercise [@problem_id:1089504] provides practice with the foundational step of this process: converting a second-order nonlinear differential equation, in this case for a generalized Duffing oscillator, into an equivalent system of two first-order equations. The resulting vector field is the gateway to both qualitative analysis and numerical simulation of complex phenomena like chaos.", "problem": "The standard Duffing oscillator is a fundamental model for studying nonlinear dynamics and chaos. In certain physical systems, such as those incorporating relativistic kinematics or specific fluid-structure interactions, the effective mass or inertia can depend on the velocity.\n\nConsider a generalized, forced, and damped Duffing oscillator whose motion $x(t)$ is described by the following second-order nonlinear ordinary differential equation:\n$$\nm_0 \\frac{d^2 x}{dt^2} \\left(1 - \\frac{1}{c^2}\\left(\\frac{dx}{dt}\\right)^2\\right)^{-3/2} + \\delta \\frac{dx}{dt} + \\alpha x + \\beta x^3 = \\gamma \\cos(\\omega t)\n$$\nHere, $m_0$ is the rest mass, $c$ is a characteristic speed parameter, $\\delta$ is the damping coefficient, $\\alpha$ and $\\beta$ are parameters of the nonlinear restoring force, and $\\gamma$ and $\\omega$ are the amplitude and angular frequency of the sinusoidal driving force. All these parameters are positive real constants. We are interested in the physical regime where the speed of the oscillator $|\\frac{dx}{dt}|$ remains less than $c$.\n\nTo analyze the dynamics of this system in phase space, it is conventional to convert the second-order ODE into a system of two first-order ODEs. Let the state of the system be described by the vector $\\mathbf{y}(t) = \\begin{pmatrix} y_1(t) \\\\ y_2(t) \\end{pmatrix}$, where $y_1(t) = x(t)$ and $y_2(t) = \\frac{dx}{dt}$. The system's evolution is then governed by an equation of the form $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}, t)$.\n\nDetermine the non-autonomous vector field $\\mathbf{F}(\\mathbf{y}, t)$ for this dynamical system.", "solution": "We set $y_1=x$ and $y_2=\\dot x$, so that\n$$\\dot y_1=y_2\\,. $$\nThe original equation is\n$$\nm_0\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{-3/2}\\ddot x+\\delta y_2+\\alpha y_1+\\beta y_1^3=\\gamma\\cos(\\omega t)\\,.\n$$\nSolving for $\\ddot x$ gives\n$$\n\\ddot x\n=\\frac{\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{3/2}}{m_0}\\bigl[\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr].\n$$\nHence\n$$\n\\dot y_2\n=\\frac{(1-\\frac{y_2^2}{c^2})^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr).\n$$\nThus the non‐autonomous vector field is\n$$\n\\mathbf F(y,t)\n=\\begin{pmatrix}\ny_2\\\\\n\\displaystyle\\frac{\\bigl(1-\\frac{y_2^2}{c^2}\\bigr)^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr)\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\ny_2\\\\\n\\displaystyle\\frac{(1-\\tfrac{y_2^2}{c^2})^{3/2}}{m_0}\\bigl(\\gamma\\cos(\\omega t)-\\delta y_2-\\alpha y_1-\\beta y_1^3\\bigr)\n\\end{pmatrix}}$$", "id": "1089504"}, {"introduction": "State-space representation is a cornerstone of modern control theory, allowing engineers to analyze and design complex systems. This problem [@problem_id:1089737] moves beyond simple physical states to demonstrate how to construct a state vector for a closed-loop PID control system, which includes the integral of the error as a state variable. Deriving the state-space matrix $A$ for this third-order system reveals the interconnected dynamics of the physical plant and its controller.", "problem": "In control engineering, it is standard practice to model the behavior of a physical system using differential equations. Consider a second-order linear time-invariant system, often referred to as the \"plant,\" whose dynamics are governed by the equation:\n$$ m \\frac{d^2y(t)}{dt^2} + c \\frac{dy(t)}{dt} + k y(t) = u(t) $$\nHere, $y(t)$ is the output of the system (e.g., position), $u(t)$ is the control input (e.g., an applied force), and $m, c, k$ are positive real constants representing the system's intrinsic physical properties (e.g., mass, damping coefficient, and spring constant).\n\nTo ensure the output $y(t)$ follows a desired setpoint $r(t)$, a Proportional-Integral-Derivative (PID) controller is used. The controller calculates the error $e(t) = r(t) - y(t)$ and generates a control input based on the law:\n$$ u(t) = K_p e(t) + K_i \\int_0^t e(\\tau) d\\tau + K_d \\frac{de(t)}{dt} $$\nwhere $K_p, K_i, K_d$ are the proportional, integral, and derivative gains, respectively.\n\nFor this problem, consider the common task of regulation, where the setpoint is constant and zero, i.e., $r(t)=0$. The closed-loop system, combining the plant and the controller, can be described by a system of first-order ordinary differential equations in the form $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t)$, which is known as the state-space representation.\n\nDefine the state vector $\\mathbf{x}(t)$ for the closed-loop system as:\n$$ \\mathbf{x}(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\\\ x_3(t) \\end{pmatrix} = \\begin{pmatrix} y(t) \\\\ \\dot{y}(t) \\\\ \\int_0^t e(\\tau) d\\tau \\end{pmatrix} $$\nYour task is to derive the state-space matrix $A$. The final answer should be the matrix $A$ expressed in terms of the parameters $m, c, k, K_p, K_i, K_d$.", "solution": "We have the plant dynamics and the PID control law:\n$$m\\ddot y + c\\dot y + k y = u,$$\n$$u = K_p e + K_i\\int_0^t e(\\tau)\\,d\\tau + K_d\\dot e,$$\nwith $e = r - y$ and here $r=0$, so $e = -y$ and $\\dot e = -\\dot y$.\n\nDefine the state vector\n$$x_1 = y,\\quad x_2 = \\dot y,\\quad x_3 = \\int_0^t e(\\tau)\\,d\\tau = \\int_0^t(-y(\\tau))\\,d\\tau.$$\n\n1. Compute $\\dot{x}_1$:\n$$\\dot{x}_1 = \\dot y = x_2.$$\n\n2. Compute $\\dot{x}_2$ using the plant equation:\n$$m\\ddot y = -c\\dot y - k y + u\n= -c x_2 - k x_1 +\\bigl(K_p(-x_1) + K_i x_3 + K_d(-x_2)\\bigr).$$\nDividing by $m$ gives\n$$\\dot{x}_2 = \\ddot y\n= -\\frac{c+K_d}{m}\\,x_2 - \\frac{k+K_p}{m}\\,x_1 + \\frac{K_i}{m}\\,x_3.$$\n\n3. Compute $\\dot{x}_3$:\n$$\\dot{x}_3 = e = -y = -x_1.$$\n\nCollecting these, the state‐space form $\\dot{\\mathbf x}=A\\mathbf x$ is\n$$\n\\begin{pmatrix}\\dot{x}_1\\\\\\dot{x}_2\\\\\\dot{x}_3\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & 1 & 0\\\\\n-\\frac{k+K_p}{m} & -\\frac{c+K_d}{m} & \\frac{K_i}{m}\\\\\n-1 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}x_1\\\\x_2\\\\x_3\\end{pmatrix}.\n$$\nThus the matrix $A$ is as above.", "answer": "$$\\boxed{\\begin{pmatrix}\n0 & 1 & 0\\\\\n-\\dfrac{k+K_p}{m} & -\\dfrac{c+K_d}{m} & \\dfrac{K_i}{m}\\\\\n-1 & 0 & 0\n\\end{pmatrix}}$$", "id": "1089737"}, {"introduction": "Many fundamental laws in physics and engineering, such as the Euler-Bernoulli beam theory, are expressed as higher-order differential equations. While analytically daunting, these problems are readily solved using computational tools, which almost universally operate on systems of first-order equations. This practice [@problem_id:2444880] illustrates this crucial preparatory step by converting a fourth-order boundary value problem for a vibrating beam into a system of four first-order ODEs, making it ready for a numerical solver.", "problem": "Consider a slender, prismatic Euler–Bernoulli beam undergoing small-amplitude, time-harmonic transverse vibration under a distributed load. Let $x \\in [0,L]$ denote the axial coordinate along the beam, $t$ the time, and $w(x,t)$ the transverse deflection. Assume a steady-state harmonic response of the form $w(x,t) = \\Re\\{Y(x)\\,\\mathrm{e}^{\\mathrm{i}\\,\\omega t}\\}$ to a distributed load $q(x,t) = \\Re\\{q(x)\\,\\mathrm{e}^{\\mathrm{i}\\,\\omega t}\\}$, where $Y(x)$ and $q(x)$ are real-valued amplitudes and $\\omega$ is the angular frequency in radians per second. Neglect damping and rotary inertia. Under these assumptions, the governing equation reduces to the fourth-order ordinary differential equation in $x$\n$$\nE I\\,\\frac{\\mathrm{d}^{4} Y}{\\mathrm{d} x^{4}}(x) - \\rho A\\,\\omega^{2} Y(x) = q(x),\n$$\nwith boundary conditions for a cantilever beam (clamped at $x=0$ and free at $x=L$)\n$$\nY(0)=0,\\quad Y'(0)=0,\\quad Y''(L)=0,\\quad Y'''(L)=0.\n$$\nHere $E$ is Young’s modulus, $I$ is the second moment of area, $\\rho$ is the material mass density, $A$ is the cross-sectional area, and $L$ is the beam length. The distributed load amplitude is specified as $q(x) = q_{0}\\,\\sin\\!\\big(\\pi x/L\\big)$.\n\nTask:\n- Convert the single fourth-order ordinary differential equation in $x$ into an equivalent system of four coupled first-order ordinary differential equations in $x$.\n- Solve the resulting boundary value problem for $Y(x)$ on the interval $x \\in [0,L]$ for each parameter set in the test suite below.\n- For each case, report the tip deflection amplitude $Y(L)$.\n\nAll input parameters use International System of Units (SI). Report all tip deflection amplitudes in meters, rounded to six digits after the decimal point, using scientific notation.\n\nTest suite:\n- Case $1$ (general): $E = 210\\times 10^{9}\\,\\mathrm{Pa}$, $I = 1.0\\times 10^{-6}\\,\\mathrm{m}^{4}$, $\\rho = 7800\\,\\mathrm{kg/m^{3}}$, $A = 1.0\\times 10^{-3}\\,\\mathrm{m}^{2}$, $L = 2.0\\,\\mathrm{m}$, $q_{0} = 100.0\\,\\mathrm{N/m}$, $\\omega = 50.0\\,\\mathrm{rad/s}$.\n- Case $2$ (zero load edge case): $E = 210\\times 10^{9}\\,\\mathrm{Pa}$, $I = 1.0\\times 10^{-6}\\,\\mathrm{m}^{4}$, $\\rho = 7800\\,\\mathrm{kg/m^{3}}$, $A = 1.0\\times 10^{-3}\\,\\mathrm{m}^{2}$, $L = 2.0\\,\\mathrm{m}$, $q_{0} = 0.0\\,\\mathrm{N/m}$, $\\omega = 50.0\\,\\mathrm{rad/s}$.\n- Case $3$ (quasi-static regime): $E = 70\\times 10^{9}\\,\\mathrm{Pa}$, $I = 5.0\\times 10^{-6}\\,\\mathrm{m}^{4}$, $\\rho = 2700\\,\\mathrm{kg/m^{3}}$, $A = 2.0\\times 10^{-3}\\,\\mathrm{m}^{2}$, $L = 1.0\\,\\mathrm{m}$, $q_{0} = 1000.0\\,\\mathrm{N/m}$, $\\omega = 0.01\\,\\mathrm{rad/s}$.\n- Case $4$ (stiff beam): $E = 210\\times 10^{9}\\,\\mathrm{Pa}$, $I = 5.0\\times 10^{-5}\\,\\mathrm{m}^{4}$, $\\rho = 7800\\,\\mathrm{kg/m^{3}}$, $A = 1.0\\times 10^{-3}\\,\\mathrm{m}^{2}$, $L = 2.0\\,\\mathrm{m}$, $q_{0} = 100.0\\,\\mathrm{N/m}$, $\\omega = 20.0\\,\\mathrm{rad/s}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the four tip deflection amplitudes as a comma-separated list, enclosed in square brackets, for example, \"[v1,v2,v3,v4]\".\n- Use scientific notation with exactly six digits after the decimal point for each entry and no spaces, e.g., \"[1.234567e-03,0.000000e+00, ...]\".\n- The values must be in meters.", "solution": "The user-provided problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The steady-state amplitude $Y(x)$ of an Euler-Bernoulli beam's transverse vibration is governed by the fourth-order ordinary differential equation (ODE):\n$$\nE I\\,\\frac{\\mathrm{d}^{4} Y}{\\mathrm{d} x^{4}}(x) - \\rho A\\,\\omega^{2} Y(x) = q(x)\n$$\n- **Domain**: The axial coordinate $x$ is in the interval $[0,L]$.\n- **Boundary Conditions (Cantilever Beam)**:\n  - Clamped at $x=0$: $Y(0)=0$, $Y'(0)=0$.\n  - Free at $x=L$: $Y''(L)=0$, $Y'''(L)=0$.\n- **Distributed Load**: The amplitude of the distributed load is $q(x) = q_{0}\\,\\sin(\\pi x/L)$.\n- **Constants**:\n  - $E$: Young’s modulus\n  - $I$: Second moment of area\n  - $\\rho$: Material mass density\n  - $A$: Cross-sectional area\n  - $L$: Beam length\n  - $q_{0}$: Load magnitude\n  - $\\omega$: Angular frequency\n- **Task**:\n  1. Convert the fourth-order ODE into a system of four coupled first-order ODEs.\n  2. Solve the resulting boundary value problem (BVP) for $Y(x)$ for four different parameter sets.\n  3. Report the tip deflection amplitude $Y(L)$ for each case.\n- **Test Suite (SI units)**:\n  - Case 1: $E = 210 \\times 10^{9}$, $I = 1.0 \\times 10^{-6}$, $\\rho = 7800$, $A = 1.0 \\times 10^{-3}$, $L = 2.0$, $q_{0} = 100.0$, $\\omega = 50.0$.\n  - Case 2: $E = 210 \\times 10^{9}$, $I = 1.0 \\times 10^{-6}$, $\\rho = 7800$, $A = 1.0 \\times 10^{-3}$, $L = 2.0$, $q_{0} = 0.0$, $\\omega = 50.0$.\n  - Case 3: $E = 70 \\times 10^{9}$, $I = 5.0 \\times 10^{-6}$, $\\rho = 2700$, $A = 2.0 \\times 10^{-3}$, $L = 1.0$, $q_{0} = 1000.0$, $\\omega = 0.01$.\n  - Case 4: $E = 210 \\times 10^{9}$, $I = 5.0 \\times 10^{-5}$, $\\rho = 7800$, $A = 1.0 \\times 10^{-3}$, $L = 2.0$, $q_{0} = 100.0$, $\\omega = 20.0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria.\n- **Scientifically Grounded**: The governing equation is the well-established Euler-Bernoulli beam equation for forced, undamped vibrations. All concepts and parameters ($E, I, \\rho, A, L, \\omega, q_0$) are standard in classical mechanics and structural engineering. The problem is scientifically sound.\n- **Well-Posed**: The problem is a two-point boundary value problem for a linear fourth-order ODE. The boundary conditions are standard for a cantilever beam and are sufficient to ensure a unique solution exists, provided the driving frequency $\\omega$ is not one of the beam's natural frequencies (which would cause resonance in this undamped model). In Case $2$, with zero load, the homogeneous problem is considered at a frequency that is not a natural frequency, correctly leading to a trivial solution. The problem is well-posed.\n- **Objective**: The problem is stated using precise mathematical and physical language. The tasks are specific and quantitative. The problem is objective.\n- **Completeness**: All necessary parameters, equations, and boundary conditions for solving the problem are provided.\n- **Relevance**: The task involves converting a higher-order ODE into a system of first-order ODEs and solving it numerically, which is a canonical problem in computational physics.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, objective, and complete. It is a valid problem for which a solution can be constructed.\n\n### Solution Derivation\n\nThe first step is to convert the single fourth-order ODE into an equivalent system of four first-order ODEs. This is a standard technique. We define a state vector $\\mathbf{y}(x)$ with four components:\n\\begin{align*}\n    y_1(x) &= Y(x) & & \\text{(deflection)} \\\\\n    y_2(x) &= Y'(x) & & \\text{(slope)} \\\\\n    y_3(x) &= Y''(x) & & \\text{(proportional to bending moment, } M=EIY'') \\\\\n    y_4(x) &= Y'''(x) & & \\text{(proportional to shear force, } V=EIY''')\n\\end{align*}\nBy differentiating each component with respect to $x$, we can express the derivatives of the state vector components in terms of the components themselves:\n\\begin{align*}\n    y_1'(x) &= y_2(x) \\\\\n    y_2'(x) &= y_3(x) \\\\\n    y_3'(x) &= y_4(x)\n\\end{align*}\nThe derivative of the fourth component, $y_4'(x) = Y''''(x)$, is obtained by rearranging the governing ODE:\n$$\n\\frac{\\mathrm{d}^{4} Y}{\\mathrm{d} x^{4}}(x) = \\frac{\\rho A \\omega^2}{EI} Y(x) + \\frac{q(x)}{EI}\n$$\nSubstituting the state vector components and the given load function $q(x) = q_0\\sin(\\pi x/L)$:\n$$\ny_4'(x) = \\frac{\\rho A \\omega^2}{EI} y_1(x) + \\frac{q_0}{EI} \\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\nThis forms a system of linear first-order ODEs, which can be written in matrix form, $\\mathbf{y}'(x) = \\mathbf{F}(x, \\mathbf{y}(x))$:\n$$\n\\frac{d}{dx}\n\\begin{pmatrix}\ny_1 \\\\\ny_2 \\\\\ny_3 \\\\\ny_4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_2 \\\\\ny_3 \\\\\ny_4 \\\\\n\\frac{\\rho A \\omega^2}{EI} y_1 + \\frac{q_0}{EI} \\sin\\left(\\frac{\\pi x}{L}\\right)\n\\end{pmatrix}\n$$\nThis system must be solved subject to the boundary conditions. In terms of the state vector, the conditions for a cantilever beam are:\n-   At the clamped end, $x=0$:\n    -   $Y(0) = 0 \\implies y_1(0) = 0$\n    -   $Y'(0) = 0 \\implies y_2(0) = 0$\n-   At the free end, $x=L$:\n    -   $Y''(L) = 0 \\implies y_3(L) = 0$\n    -   $Y'''(L) = 0 \\implies y_4(L) = 0$\n\nThis constitutes a two-point boundary value problem (BVP). We will solve this BVP numerically using a suitable algorithm. The `scipy.integrate.solve_bvp` function from the SciPy library is an appropriate tool. It implements a collocation method which is efficient and accurate for such problems.\n\nThe numerical procedure is as follows:\n1.  Define a Python function that represents the ODE system, taking $x$ and $\\mathbf{y}$ as input and returning $\\mathbf{y}'$. This function will also require the physical parameters of the problem.\n2.  Define a Python function for the boundary conditions, which computes the residuals of the four conditions: $[y_1(0), y_2(0), y_3(L), y_4(L)]$. These residuals must be zero for a valid solution.\n3.  Create an initial mesh of points for the domain $[0,L]$. A uniform grid is sufficient.\n4.  Provide an initial guess for the solution $\\mathbf{y}(x)$ on this mesh. A guess of zero for all components is a reasonable starting point.\n5.  Invoke `scipy.integrate.solve_bvp` with the ODE function, boundary condition function, initial mesh, and initial guess.\n6.  The solver iteratively refines the solution until the boundary conditions are satisfied and the ODE is solved to a specified tolerance.\n7.  Once the solution is found, the value of the deflection at the tip, $Y(L) = y_1(L)$, can be evaluated from the resulting solution object.\n\nThis process is repeated for each of the four test cases provided in the problem statement. The final result for each case is formatted as required.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_bvp\n\ndef solve():\n    \"\"\"\n    Solves the Euler-Bernoulli beam BVP for four test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (general)\n        {\n            \"E\": 210.0e9, \"I\": 1.0e-6, \"rho\": 7800.0, \"A\": 1.0e-3,\n            \"L\": 2.0, \"q0\": 100.0, \"omega\": 50.0\n        },\n        # Case 2 (zero load edge case)\n        {\n            \"E\": 210.0e9, \"I\": 1.0e-6, \"rho\": 7800.0, \"A\": 1.0e-3,\n            \"L\": 2.0, \"q0\": 0.0, \"omega\": 50.0\n        },\n        # Case 3 (quasi-static regime)\n        {\n            \"E\": 70.0e9, \"I\": 5.0e-6, \"rho\": 2700.0, \"A\": 2.0e-3,\n            \"L\": 1.0, \"q0\": 1000.0, \"omega\": 0.01\n        },\n        # Case 4 (stiff beam)\n        {\n            \"E\": 210.0e9, \"I\": 5.0e-5, \"rho\": 7800.0, \"A\": 1.0e-3,\n            \"L\": 2.0, \"q0\": 100.0, \"omega\": 20.0\n        }\n    ]\n\n    def ode_system(x, y, p):\n        \"\"\"\n        Defines the system of 4 first-order ODEs.\n        y is a vector [y1, y2, y3, y4]\n        y1 = Y, y2 = Y', y3 = Y'', y4 = Y'''\n        p is a tuple of parameters (E, I, rho, A, L, q0, omega)\n        \"\"\"\n        E, I, rho, A, L, q0, omega = p\n        \n        dy1_dx = y[1]\n        dy2_dx = y[2]\n        dy3_dx = y[3]\n\n        q_x = q0 * np.sin(np.pi * x / L)\n        \n        # From EI Y'''' - rho*A*omega^2*Y = q(x)\n        dy4_dx = (rho * A * omega**2 * y[0] + q_x) / (E * I)\n\n        return np.vstack((dy1_dx, dy2_dx, dy3_dx, dy4_dx))\n\n    def boundary_conditions(ya, yb, p):\n        \"\"\"\n        Defines the boundary conditions for the cantilever beam.\n        ya: solution at x=0\n        yb: solution at x=L\n        BCs: Y(0)=0, Y'(0)=0, Y''(L)=0, Y'''(L)=0\n        In state vector terms: y1(0)=0, y2(0)=0, y3(L)=0, y4(L)=0\n        \"\"\"\n        return np.array([ya[0], ya[1], yb[2], yb[3]])\n\n    results = []\n\n    for case in test_cases:\n        p = (\n            case[\"E\"], case[\"I\"], case[\"rho\"], case[\"A\"],\n            case[\"L\"], case[\"q0\"], case[\"omega\"]\n        )\n        L = case[\"L\"]\n\n        # Set up the initial mesh and guess for the solution\n        x_mesh = np.linspace(0, L, 201)  # 201 points for good resolution\n        y_guess = np.zeros((4, x_mesh.size))\n\n        # Solve the boundary value problem\n        sol = solve_bvp(\n            lambda x, y: ode_system(x, y, p),\n            lambda ya, yb: boundary_conditions(ya, yb, p),\n            x_mesh,\n            y_guess,\n            tol=1e-8\n        )\n        \n        # As a check, for q0=0 and omega != natural frequency, solution must be trivial\n        if case[\"q0\"] == 0.0:\n            tip_deflection = 0.0\n        else:\n            if sol.success:\n                # Evaluate the solution at the tip of the beam (x=L)\n                # sol.sol(L)[0] corresponds to y1(L) = Y(L)\n                tip_deflection = sol.sol(L)[0]\n            else:\n                # This should not happen for the given test cases\n                tip_deflection = np.nan\n\n        # Format the result to scientific notation with 6 decimal places\n        results.append(f\"{tip_deflection:.6e}\")\n    \n    # Print the final result in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2444880"}]}