{"hands_on_practices": [{"introduction": "Numerical relativity begins with translating the continuous language of differential geometry into discrete algebraic operations on a computer grid. A core task is approximating differential operators, like the covariant Laplacian, which is fundamental to the wave equations governing fields in curved spacetime. This exercise provides concrete practice in applying a finite-difference scheme to the Laplacian, demonstrating how the underlying geometry, encoded in the metric, directly influences the numerical stencil.", "problem": "In numerical relativity, the evolution of scalar fields on a curved spacetime background is often studied by discretizing the field equations on a grid. A fundamental operator in these equations is the covariant Laplacian. For a scalar field $\\phi$ on a Riemannian manifold with metric $g_{ab}$, the covariant Laplacian is defined as $\\nabla^2 \\phi = g^{ab} \\nabla_a \\nabla_b \\phi$, where $\\nabla_a$ is the covariant derivative compatible with the metric.\n\nConsider a 1-dimensional spatial slice with a line element $ds^2 = g_{xx}(x) (dx)^2$. The covariant Laplacian for a scalar field $\\phi(x)$ on this slice simplifies to the compact form:\n$$\n\\nabla^2 \\phi = \\frac{1}{\\sqrt{g_{xx}}} \\frac{d}{dx} \\left(\\frac{1}{\\sqrt{g_{xx}}} \\frac{d\\phi}{dx}\\right)\n$$\nTo solve this numerically, one can define a uniform grid $x_i = i h$ (for integer $i$ and grid spacing $h$) and approximate the operator using finite differences. A second-order accurate centered-difference scheme, which is constructed by evaluating derivatives on a staggered grid, gives the following approximation for the Laplacian at a grid point $x_i$:\n$$\n(\\nabla^2 \\phi)_i \\approx \\frac{1}{\\sqrt{g_{xx,i}} h^2} \\left( \\frac{\\phi_{i+1} - \\phi_i}{\\sqrt{\\frac{1}{2}(g_{xx,i} + g_{xx,i+1})}} - \\frac{\\phi_i - \\phi_{i-1}}{\\sqrt{\\frac{1}{2}(g_{xx,i-1} + g_{xx,i})}} \\right)\n$$\nwhere $\\phi_i = \\phi(x_i)$ and $g_{xx,i} = g_{xx}(x_i)$.\n\nConsider a space with the metric component $g_{xx}(x) = e^{2\\alpha x}$ and a scalar field given by $\\phi(x) = \\beta \\sin(\\omega x)$, where $\\alpha, \\beta, \\omega$ and $h$ are positive real parameters.\n\nYour task is to derive a closed-form analytic expression for the finite-difference approximation of the covariant Laplacian, $(\\nabla^2 \\phi)_1$, at the grid point $x_1 = h$. The final expression should be in terms of the symbolic constants $\\alpha, \\beta, \\omega$, and $h$.", "solution": "The problem asks for the numerical approximation of the covariant Laplacian $(\\nabla^2 \\phi)_1$ at the grid point $x_1 = h$. The given finite-difference formula is:\n$$\n(\\nabla^2 \\phi)_i \\approx \\frac{1}{\\sqrt{g_{xx,i}} h^2} \\left( \\frac{\\phi_{i+1} - \\phi_i}{\\sqrt{\\frac{1}{2}(g_{xx,i} + g_{xx,i+1})}} - \\frac{\\phi_i - \\phi_{i-1}}{\\sqrt{\\frac{1}{2}(g_{xx,i-1} + g_{xx,i})}} \\right)\n$$\nWe need to evaluate this for $i=1$. This requires values of the scalar field $\\phi$ and the metric component $g_{xx}$ at the grid points $x_0 = 0 \\cdot h = 0$, $x_1 = 1 \\cdot h = h$, and $x_2 = 2 \\cdot h = 2h$.\n\nFirst, let's compute the required values of the scalar field $\\phi(x) = \\beta \\sin(\\omega x)$:\n-   At $x_0 = 0$: $\\phi_0 = \\beta \\sin(\\omega \\cdot 0) = 0$.\n-   At $x_1 = h$: $\\phi_1 = \\beta \\sin(\\omega h)$.\n-   At $x_2 = 2h$: $\\phi_2 = \\beta \\sin(2\\omega h)$.\n\nNext, let's compute the required values of the metric component $g_{xx}(x) = e^{2\\alpha x}$:\n-   At $x_0 = 0$: $g_{xx,0} = e^{2\\alpha \\cdot 0} = e^0 = 1$.\n-   At $x_1 = h$: $g_{xx,1} = e^{2\\alpha h}$.\n-   At $x_2 = 2h$: $g_{xx,2} = e^{2\\alpha (2h)} = e^{4\\alpha h}$.\n\nNow, we substitute these values into the finite-difference formula for $i=1$:\n$$\n(\\nabla^2 \\phi)_1 = \\frac{1}{\\sqrt{g_{xx,1}} h^2} \\left( \\frac{\\phi_2 - \\phi_1}{\\sqrt{\\frac{1}{2}(g_{xx,1} + g_{xx,2})}} - \\frac{\\phi_1 - \\phi_0}{\\sqrt{\\frac{1}{2}(g_{xx,0} + g_{xx,1})}} \\right)\n$$\nSubstitute the computed values:\n$$\n(\\nabla^2 \\phi)_1 = \\frac{1}{\\sqrt{e^{2\\alpha h}} h^2} \\left( \\frac{\\beta \\sin(2\\omega h) - \\beta \\sin(\\omega h)}{\\sqrt{\\frac{1}{2}(e^{2\\alpha h} + e^{4\\alpha h})}} - \\frac{\\beta \\sin(\\omega h) - 0}{\\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}} \\right)\n$$\nLet's simplify the expression term by term. The pre-factor is $\\frac{1}{e^{\\alpha h} h^2}$. We can factor out $\\beta$ from the terms in the parenthesis.\n$$\n(\\nabla^2 \\phi)_1 = \\frac{\\beta}{e^{\\alpha h} h^2} \\left( \\frac{\\sin(2\\omega h) - \\sin(\\omega h)}{\\sqrt{\\frac{1}{2}(e^{2\\alpha h} + e^{4\\alpha h})}} - \\frac{\\sin(\\omega h)}{\\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}} \\right)\n$$\nNow, simplify the denominators inside the parenthesis.\nFor the first term's denominator: $\\sqrt{\\frac{1}{2}(e^{2\\alpha h} + e^{4\\alpha h})} = \\sqrt{\\frac{1}{2}e^{2\\alpha h}(1 + e^{2\\alpha h})} = e^{\\alpha h} \\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}$.\nSo the expression becomes:\n$$\n(\\nabla^2 \\phi)_1 = \\frac{\\beta}{e^{\\alpha h} h^2} \\left( \\frac{\\sin(2\\omega h) - \\sin(\\omega h)}{e^{\\alpha h} \\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}} - \\frac{\\sin(\\omega h)}{\\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}} \\right)\n$$\nWe can factor out the term $\\frac{1}{\\sqrt{\\frac{1}{2}(1 + e^{2\\alpha h})}} = \\frac{\\sqrt{2}}{\\sqrt{1 + e^{2\\alpha h}}}$.\n$$\n(\\nabla^2 \\phi)_1 = \\frac{\\beta}{e^{\\alpha h} h^2} \\frac{\\sqrt{2}}{\\sqrt{1 + e^{2\\alpha h}}} \\left( \\frac{\\sin(2\\omega h) - \\sin(\\omega h)}{e^{\\alpha h}} - \\sin(\\omega h) \\right)\n$$\nCombining the pre-factors gives the final simplified expression:\n$$\n(\\nabla^2 \\phi)_1 = \\frac{\\sqrt{2}\\beta}{e^{\\alpha h} h^2 \\sqrt{1 + e^{2\\alpha h}}} \\left( e^{-\\alpha h}(\\sin(2\\omega h) - \\sin(\\omega h)) - \\sin(\\omega h) \\right)\n$$", "answer": "$$\n\\boxed{\\frac{\\sqrt{2}\\beta}{e^{\\alpha h} h^2 \\sqrt{1 + e^{2\\alpha h}}} \\left( e^{-\\alpha h}(\\sin(2\\omega h) - \\sin(\\omega h)) - \\sin(\\omega h) \\right)}\n$$", "id": "1001182"}, {"introduction": "Once a system of partial differential equations is discretized, one must choose a time step $\\Delta t$ that ensures the numerical solution remains stable and physically meaningful. For the hyperbolic equations ubiquitous in relativity, this choice is governed by the Courant-Friedrichs-Lewy (CFL) condition, which links the time step to the grid spacing and the characteristic speeds of the system. In this problem, you will derive this fundamental stability limit for the simple wave equation, a vital skill for developing any stable evolution code.", "problem": "The one-dimensional scalar wave equation is a fundamental model in mathematical physics, given by\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = v^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x, t)$ is the wave amplitude, $v$ is the constant propagation speed, $t$ is time, and $x$ is the spatial coordinate. In numerical relativity, a stable numerical scheme is crucial for evolving such equations.\n\nConsider a numerical solution on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$, where $u_j^n \\equiv u(j\\Delta x, n\\Delta t)$. The wave equation is discretized using a second-order accurate centered finite-difference scheme in space and a second-order leapfrog scheme in time:\n$$\n\\frac{u_j^{n+1} - 2u_j^n + u_j^{n-1}}{(\\Delta t)^2} = v^2 \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nTo analyze the stability of this scheme, we use the Von Neumann method. We consider a single Fourier mode for the numerical solution:\n$$\nu_j^n = \\xi^n e^{i k j \\Delta x}\n$$\nwhere $k$ is the wave number and $\\xi = \\xi(k)$ is the complex amplification factor. For the numerical solution to remain bounded (i.e., for the scheme to be stable), the magnitude of the amplification factor must satisfy the condition $|\\xi| \\le 1$ for all possible real wave numbers $k$.\n\nThe Courant-Friedrichs-Lewy (CFL) condition arises from this analysis. It constrains the relationship between the time step, spatial step, and wave speed. This relationship is typically expressed in terms of the Courant number, $\\mu = \\frac{v \\Delta t}{\\Delta x}$.\n\nYour task is to determine the stability limit for this specific numerical scheme. Derive the maximum allowed value of the Courant number $\\mu$ for which the scheme is stable for all wave numbers.", "solution": "We discretize the wave equation via centered differences in space and leap-frog in time:\n$$\\frac{u_j^{n+1}-2u_j^n+u_j^{n-1}}{(\\Delta t)^2}\n= v^2\\frac{u_{j+1}^n-2u_j^n+u_{j-1}^n}{(\\Delta x)^2}\\,. $$\n\n1.  Substitute the Fourier mode $u_j^n=\\xi^n e^{ikj\\Delta x}$.  Then\n$$\\frac{\\xi^{n+1}-2\\xi^n+\\xi^{n-1}}{(\\Delta t)^2}\n= v^2\\frac{e^{ik\\Delta x}-2+e^{-ik\\Delta x}}{(\\Delta x)^2}\\,\\xi^n.$$\nDivide by $\\xi^n$ and multiply by $(\\Delta t)^2$:\n$$\\xi+\\xi^{-1}-2=\\mu^2\\,(e^{i k\\Delta x}-2+e^{-i k\\Delta x}),\\quad\n\\mu=\\frac{v\\Delta t}{\\Delta x}.$$\n\n2.  Use $e^{i\\theta}+e^{-i\\theta}-2=-4\\sin^2(\\theta/2)$ with $\\theta=k\\Delta x$:\n$$\\xi+\\xi^{-1}-2=-4\\mu^2\\sin^2\\!\\bigl(\\tfrac{k\\Delta x}{2}\\bigr)\n\\;\\Longrightarrow\\;\n\\cos(\\omega\\Delta t)=1-2\\mu^2\\sin^2\\!\\bigl(\\tfrac{k\\Delta x}{2}\\bigr),$$\nwhere $\\xi=e^{\\pm i\\omega\\Delta t}$.\n\n3.  Stability requires the right‐hand side lie in $[-1,1]$ for all $k$:\n$$-1\\le 1-2\\mu^2\\sin^2\\!\\bigl(\\tfrac{k\\Delta x}{2}\\bigr)\\le1.$$\nThe most restrictive bound is\n$$1-2\\mu^2\\sin^2\\!\\bigl(\\tfrac{k\\Delta x}{2}\\bigr)\\ge -1\n\\;\\Longrightarrow\\;\n\\mu^2\\sin^2\\!\\bigl(\\tfrac{k\\Delta x}{2}\\bigr)\\le1.$$\nSince $\\sin^2\\!(\\tfrac{k\\Delta x}{2})\\le1$ for all real $k$, we obtain\n$$\\mu^2\\le1\\quad\\Longrightarrow\\quad \\mu\\le1.$$\nThus the scheme is stable for $\\mu\\le1\\,$.", "answer": "$$\\boxed{1}$$", "id": "1001246"}, {"introduction": "The evolution equations of General Relativity are not the whole story; the initial configuration of spacetime cannot be chosen arbitrarily but must satisfy a set of constraint equations. This exercise delves into this crucial aspect by exploring the Hamiltonian constraint for a time-symmetric initial slice using the powerful conformal method. You will quantify the extent to which a proposed initial dataset violates this constraint, a common diagnostic procedure when constructing physically valid initial conditions for simulations.", "problem": "In the 3+1 ADM formalism of general relativity, the Einstein field equations for a vacuum spacetime split into constraint and evolution equations. For initial data on a spacelike hypersurface $\\Sigma$, the Hamiltonian constraint must be satisfied. For a time-symmetric slice, the extrinsic curvature $K_{ij}$ vanishes, and the Hamiltonian constraint simplifies to $\\mathcal{H} = R = 0$, where $R$ is the Ricci scalar of the 3-metric $\\gamma_{ij}$ on the slice.\n\nA common method for constructing initial data is the conformal method. One proposes a physical metric $\\gamma_{ij}$ that is conformally related to a simpler, known metric $\\tilde{\\gamma}_{ij}$ via a conformal factor $\\psi$:\n$$\n\\gamma_{ij} = \\psi^4 \\tilde{\\gamma}_{ij}\n$$\nIf we choose the conformal metric to be flat, $\\tilde{\\gamma}_{ij} = \\delta_{ij}$ (the Euclidean metric), the physical metric is called conformally flat. For such a metric, the Ricci scalar $R$ is related to the conformal factor $\\psi$ by the equation:\n$$\nR = -8\\psi^{-5} \\nabla^2 \\psi\n$$\nwhere $\\nabla^2 = \\delta^{ij}\\partial_i\\partial_j$ is the standard flat-space Laplacian operator. If $\\psi$ is a solution to the Hamiltonian constraint, then $\\nabla^2 \\psi = 0$.\n\nConsider a proposed conformal factor given in spherical coordinates $(r, \\theta, \\phi)$ by:\n$$\n\\psi(r) = A \\exp\\left(-\\frac{r^2}{\\sigma^2}\\right) + B\n$$\nwhere $r = \\sqrt{x^2+y^2+z^2}$ is the radial coordinate, and $A$, $B$, and $\\sigma$ are positive real constants. This form of $\\psi$ does not generally satisfy the Hamiltonian constraint.\n\nDerive an expression for the Hamiltonian constraint violation, $\\mathcal{H}$, at the radial coordinate $r=\\sigma$. Your final answer should be a closed-form expression in terms of the constants $A$, $B$, and $\\sigma$.", "solution": "We start from the Hamiltonian‐constraint violation for a conformally flat metric,\n$$\n\\mathcal{H}=R=-8\\,\\psi^{-5}\\nabla^2\\psi\\,,\n$$\nand for a purely radial $\\psi(r)$ in flat space,\n$$\n\\nabla^2\\psi\n=\\frac{1}{r^2}\\partial_r\\bigl(r^2\\partial_r\\psi\\bigr)\\,. \n$$\nGiven \n$$\n\\psi(r)=A\\exp\\bigl(-\\tfrac{r^2}{\\sigma^2}\\bigr)+B,\n$$\nwe compute\n$$\n\\partial_r\\psi\n=A\\bigl(-\\tfrac{2r}{\\sigma^2}\\bigr)e^{-r^2/\\sigma^2}\n=-\\frac{2Ar}{\\sigma^2}e^{-r^2/\\sigma^2},\n$$\n$$\nr^2\\partial_r\\psi\n=-\\frac{2A\\,r^3}{\\sigma^2}e^{-r^2/\\sigma^2},\n$$\n$$\n\\partial_r\\bigl(r^2\\partial_r\\psi\\bigr)\n=-\\frac{2A}{\\sigma^2}\\frac{d}{dr}\\Bigl(r^3e^{-r^2/\\sigma^2}\\Bigr)\n=-\\frac{2A}{\\sigma^2}e^{-r^2/\\sigma^2}\\bigl(3r^2-\\tfrac{2r^4}{\\sigma^2}\\bigr).\n$$\nHence\n$$\n\\nabla^2\\psi\n=-\\frac{2A}{\\sigma^2}e^{-r^2/\\sigma^2}\\Bigl(3-\\frac{2r^2}{\\sigma^2}\\Bigr).\n$$\nEvaluating at $r=\\sigma$ gives $r^2/\\sigma^2=1$ and\n$$\n\\nabla^2\\psi\\big|_{r=\\sigma}\n=-\\frac{2A}{\\sigma^2}e^{-1}.\n$$\nThus\n$$\n\\mathcal{H}\\big|_{r=\\sigma}\n=-8\\,\\psi^{-5}\n\\Bigl(-\\frac{2A}{\\sigma^2}e^{-1}\\Bigr)\n=\\frac{16A\\,e^{-1}}{\\sigma^2\\,\\psi(\\sigma)^5},\n$$\nwith $\\psi(\\sigma)=A e^{-1}+B$.", "answer": "$$\\boxed{\\frac{16A e^{-1}}{\\sigma^2\\bigl(Ae^{-1}+B\\bigr)^5}}$$", "id": "1001099"}]}