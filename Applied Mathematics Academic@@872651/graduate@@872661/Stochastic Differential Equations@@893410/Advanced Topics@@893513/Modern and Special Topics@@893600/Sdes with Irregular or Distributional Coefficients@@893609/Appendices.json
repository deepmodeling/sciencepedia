{"hands_on_practices": [{"introduction": "A natural starting point for studying SDEs with irregular coefficients is to consider a drift that is not a function but a distribution, such as a force concentrated at a single point. This exercise [@problem_id:2995830] explores the canonical example of a process with a drift proportional to the Dirac delta distribution at the origin. You will use Itô's formula and the concept of semimartingale local time to rigorously define the process and uncover its generator, providing a concrete link between the abstract notion of a distributional drift and the tangible path property of local time.", "problem": "Consider a one-dimensional continuous semimartingale defined by the stochastic differential equation with distributional drift\n$$\ndX_t \\;=\\; dW_t \\;+\\; \\beta \\, dL_t^{0}(X),\n$$\nwhere $W_t$ is a standard Brownian motion, $\\beta \\in [-1,1]$ is a fixed constant, and $L_t^{0}(X)$ denotes the symmetric semimartingale local time of $X$ at $0$. This equation is a canonical weak formulation of a stochastic differential equation with drift given by the Dirac distribution $\\beta \\, \\delta_{0}$, and is well known to generate skew Brownian motion when $|\\beta| \\le 1$.\n\nLet $\\varphi \\in C_c^{\\infty}(\\mathbb{R})$ be a smooth compactly supported test function. Starting from the fundamental definitions of semimartingale local time and the Itô calculus for continuous semimartingales, derive the canonical decomposition of\n$$\n\\varphi(X_t) - \\varphi(X_0) - \\int_{0}^{t} L\\varphi(X_s) \\, ds\n$$\nas a local martingale, where the generator $L$ contains the distributional drift and must be interpreted via its action on test functions. Explicitly identify the distributional part of $L\\varphi$ and explain its meaning in terms of occupation density and local time.\n\nFinally, compute the predictable quadratic variation of the local martingale part in your decomposition and provide it as a single closed-form analytic expression in terms of $\\varphi$ and the path $X$. No numerical rounding is required for your final answer.", "solution": "The problem statement has been validated and is deemed a well-posed and scientifically grounded question in the theory of stochastic differential equations with distributional coefficients.\n\nLet $X_t$ be the one-dimensional continuous semimartingale defined by the stochastic differential equation:\n$$\ndX_t = dW_t + \\beta \\, dL_t^{0}(X)\n$$\nwhere $W_t$ is a standard Brownian motion, $\\beta \\in [-1,1]$ is a constant, and $L_t^{0}(X)$ is the symmetric semimartingale local time of $X_t$ at $0$. Let $\\varphi \\in C_c^{\\infty}(\\mathbb{R})$ be a smooth test function with compact support. In particular, $\\varphi$ is of class $C^2(\\mathbb{R})$.\n\nWe begin by applying Itô's formula for a continuous semimartingale $X_t$ and a function $\\varphi \\in C^2(\\mathbb{R})$:\n$$\n\\varphi(X_t) = \\varphi(X_0) + \\int_{0}^{t} \\varphi'(X_s) \\, dX_s + \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, d\\langle X, X \\rangle_s\n$$\nFirst, we must determine the quadratic variation process $\\langle X, X \\rangle_t$. The integral form of the SDE is $X_t = X_0 + W_t + \\beta L_t^{0}(X)$. This represents the canonical decomposition of the semimartingale $X_t$ into its initial value $X_0$, a continuous local martingale part $M_t = W_t$, and a continuous finite variation part $A_t = \\beta L_t^{0}(X)$.\n\nThe quadratic variation of $X_t$ is given by:\n$$\n\\langle X, X \\rangle_t = \\langle X_0 + W + \\beta L^{0}(X), X_0 + W + \\beta L^{0}(X) \\rangle_t\n$$\nAssuming $X_0$ is a constant or $\\mathcal{F}_0$-measurable, its quadratic variation is $0$. The quadratic variation of a continuous finite variation process is zero, so $\\langle \\beta L^{0}(X), \\beta L^{0}(X) \\rangle_t = 0$. The cross-variation of a continuous local martingale with a continuous finite variation process is also zero, so $\\langle W, \\beta L^{0}(X) \\rangle_t = 0$. Therefore, the quadratic variation of $X_t$ is solely determined by its local martingale part:\n$$\n\\langle X, X \\rangle_t = \\langle W, W \\rangle_t = t\n$$\nThis implies that the differential of the quadratic variation is $d\\langle X, X \\rangle_s = ds$.\n\nSubstituting $dX_s$ and $d\\langle X, X \\rangle_s$ into Itô's formula, we obtain:\n$$\n\\varphi(X_t) = \\varphi(X_0) + \\int_{0}^{t} \\varphi'(X_s) (dW_s + \\beta \\, dL_s^{0}(X)) + \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds\n$$\nWe can split the stochastic integral into two parts:\n$$\n\\varphi(X_t) = \\varphi(X_0) + \\int_{0}^{t} \\varphi'(X_s) \\, dW_s + \\beta \\int_{0}^{t} \\varphi'(X_s) \\, dL_s^{0}(X) + \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds\n$$\nThe integral with respect to the local time, $\\int_{0}^{t} \\varphi'(X_s) \\, dL_s^{0}(X)$, is a Stieltjes integral. The measure $dL_s^{0}(X)$ is supported on the set $\\{s \\ge 0 : X_s = 0\\}$. On this set, the integrand $\\varphi'(X_s)$ is equal to $\\varphi'(0)$. Thus, we can write:\n$$\n\\int_{0}^{t} \\varphi'(X_s) \\, dL_s^{0}(X) = \\int_{0}^{t} \\varphi'(0) \\, dL_s^{0}(X) = \\varphi'(0) L_t^{0}(X)\n$$\nSubstituting this back into the equation for $\\varphi(X_t)$:\n$$\n\\varphi(X_t) = \\varphi(X_0) + \\int_{0}^{t} \\varphi'(X_s) \\, dW_s + \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds + \\beta \\varphi'(0) L_t^{0}(X)\n$$\nThis equation provides the canonical decomposition of the semimartingale $\\varphi(X_t)$. The term $M_t^{\\varphi} = \\int_{0}^{t} \\varphi'(X_s) \\, dW_s$ is a continuous local martingale, and the term $A_t^{\\varphi} = \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds + \\beta \\varphi'(0) L_t^{0}(X)$ is a continuous finite variation process.\n\nThe problem requires us to find the generator $L$ such that $\\varphi(X_t) - \\varphi(X_0) - \\int_{0}^{t} L\\varphi(X_s) \\, ds$ is a local martingale. From our decomposition, we can see that this local martingale is $M_t^{\\varphi}$. By rearranging our result, we have:\n$$\n\\varphi(X_t) - \\varphi(X_0) - \\left( \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds + \\beta \\varphi'(0) L_t^{0}(X) \\right) = \\int_{0}^{t} \\varphi'(X_s) \\, dW_s\n$$\nThis implies that the finite variation part must be identifiable as $\\int_{0}^{t} L\\varphi(X_s) \\, ds$:\n$$\n\\int_{0}^{t} L\\varphi(X_s) \\, ds = \\frac{1}{2} \\int_{0}^{t} \\varphi''(X_s) \\, ds + \\beta \\varphi'(0) L_t^{0}(X)\n$$\nTo identify the operator $L$, we use the occupation density formalism, which gives a rigorous meaning to the formal identity $L_t^{0}(X) = \\int_{0}^{t} \\delta_0(X_s) \\, ds$. Substituting this into the expression gives:\n$$\n\\int_{0}^{t} L\\varphi(X_s) \\, ds = \\int_{0}^{t} \\frac{1}{2} \\varphi''(X_s) \\, ds + \\beta \\varphi'(0) \\int_{0}^{t} \\delta_0(X_s) \\, ds = \\int_{0}^{t} \\left( \\frac{1}{2} \\varphi''(X_s) + \\beta \\varphi'(0) \\delta_0(X_s) \\right) ds\n$$\nFrom this, we identify the action of the generator $L$ on the test function $\\varphi$ as the distribution:\n$$\nL\\varphi(x) = \\frac{1}{2} \\varphi''(x) + \\beta \\varphi'(0) \\delta_0(x)\n$$\nThe distributional part of $L\\varphi$ is explicitly $\\beta \\varphi'(0) \\delta_0(x)$. This term represents the singular drift at the origin. Its meaning is that the process $X_t$ experiences a \"push\" or \"pull\" of magnitude proportional to $\\beta$ only when it is at the position $x=0$. The cumulative effect of this singular drift up to time $t$ is $\\beta \\varphi'(0) L_t^0(X)$, where the local time $L_t^0(X)$ measures the total \"time\" the process has spent at the origin, appropriately scaled. The occupation density formula provides the link, showing that the local time at $0$ acts as the scaling factor for any force or cost concentrated at that single point.\n\nFinally, we compute the predictable quadratic variation of the local martingale part. The problem phrasing identifies the local martingale as $M_t = \\varphi(X_t) - \\varphi(X_0) - \\int_{0}^{t} L\\varphi(X_s) \\, ds$. From our derivation, we have established that:\n$$\nM_t = \\int_{0}^{t} \\varphi'(X_s) \\, dW_s\n$$\nThe predictable quadratic variation of this Itô integral is given by the Itô isometry:\n$$\n\\langle M, M \\rangle_t = \\left\\langle \\int_{0}^{\\cdot} \\varphi'(X_s) \\, dW_s, \\int_{0}^{\\cdot} \\varphi'(X_s) \\, dW_s \\right\\rangle_t = \\int_{0}^{t} \\left(\\varphi'(X_s)\\right)^{2} \\, d\\langle W, W \\rangle_s\n$$\nSince $d\\langle W, W \\rangle_s = ds$, the predictable quadratic variation is:\n$$\n\\langle M, M \\rangle_t = \\int_{0}^{t} \\left(\\varphi'(X_s)\\right)^{2} \\, ds\n$$\nThis is the required closed-form analytic expression in terms of $\\varphi$ and the path $X$.", "answer": "$$\\boxed{\\int_{0}^{t} \\left(\\varphi'(X_s)\\right)^{2} \\, ds}$$", "id": "2995830"}, {"introduction": "Building upon the concept of a delta distribution drift, this next practice [@problem_id:2995802] challenges you to interpret an even more singular object: the derivative of the Dirac delta, $\\delta_{0}'$. Since a direct interpretation is elusive, this problem guides you through the powerful technique of regularization and approximation. By applying the occupation-time formula to a sequence of smooth approximations, you will derive a meaningful representation for the singular drift in terms of the spatial derivative of the process's local time, a key tool for analyzing such highly irregular dynamics.", "problem": "Consider a one-dimensional Itô stochastic differential equation driven by a standard Brownian motion $W=(W_{t})_{t\\ge 0}$ and started at $X_{0}=x_{0}\\in\\mathbb{R}$. Let $\\rho\\in C_{c}^{\\infty}(\\mathbb{R})$ be an even mollifier, that is, $\\rho(x)=\\rho(-x)$ for all $x\\in\\mathbb{R}$ and $\\int_{\\mathbb{R}}\\rho(x)\\,dx=1$, and define $\\rho_{\\varepsilon}(x)=\\varepsilon^{-1}\\rho(x/\\varepsilon)$ for $\\varepsilon0$. For a fixed parameter $\\alpha\\in\\mathbb{R}$, consider the regularized drift $b_{\\varepsilon}(x)=\\alpha\\,\\frac{d}{dx}\\rho_{\\varepsilon}(x)$ and the regularized stochastic differential equation\n$$\ndX_{t}^{\\varepsilon}=dW_{t}+b_{\\varepsilon}\\!\\left(X_{t}^{\\varepsilon}\\right)\\,dt,\\qquad X_{0}^{\\varepsilon}=x_{0}.\n$$\nUse the occupation-time density formula to express the time-integrated drift $\\int_{0}^{t}b_{\\varepsilon}\\!\\left(X_{s}^{\\varepsilon}\\right)\\,ds$ in terms of the local time field $\\{L_{t}^{y}(X^{\\varepsilon})\\}_{y\\in\\mathbb{R}}$ and then pass to the limit $\\varepsilon\\downarrow 0$ in the sense of distributions to obtain a canonical expression for the formal drift corresponding to $b=\\alpha\\,\\delta_{0}'$, where $\\delta_{0}'$ denotes the distributional derivative of the Dirac delta at $0$. In the limiting expression, interpret the spatial derivative of the local time at $y=0$ as the symmetric derivative\n$$\n\\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}=\\lim_{\\varepsilon\\downarrow 0}\\,\\frac{L_{t}^{\\varepsilon}(X)-L_{t}^{-\\varepsilon}(X)}{2\\varepsilon},\n$$\nprovided the limit exists in a suitable sense.\n\nYour task:\n- Starting from the occupation-time density formula and the definition of distributional convergence, derive a closed-form analytic expression for the limiting drift functional in terms of the symmetric spatial derivative of local time at $0$.\n- Briefly explain how this representation via the symmetric local time derivative clarifies the meaning of the formal stochastic differential equation $dX_{t}=dW_{t}+\\alpha\\,\\delta_{0}'(X_{t})\\,dt$, and what it suggests about the well-posedness of the associated martingale problem.\n\nAnswer format:\n- Give the explicit analytic expression for the limiting drift functional as your final answer. No numerical evaluation or rounding is required. The expression must be a single closed-form formula in terms of $\\alpha$ and the local time of $X$.", "solution": "The problem has been validated and is deemed a well-posed, scientifically grounded mathematical problem.\n\nWe are tasked with finding the limiting form of the time-integrated drift $\\int_{0}^{t}b_{\\varepsilon}\\!\\left(X_{s}^{\\varepsilon}\\right)\\,ds$ as the regularization parameter $\\varepsilon \\downarrow 0$. The process $X_{t}^{\\varepsilon}$ is the solution to the stochastic differential equation (SDE) $dX_{t}^{\\varepsilon}=dW_{t}+b_{\\varepsilon}\\!\\left(X_{t}^{\\varepsilon}\\right)\\,dt$ with initial condition $X_{0}^{\\varepsilon}=x_{0}$, where $b_{\\varepsilon}(x)=\\alpha\\,\\frac{d}{dx}\\rho_{\\varepsilon}(x)$ and $\\rho_\\varepsilon$ is a standard scaled mollifier.\n\nOur starting point is the occupation-time density formula, which relates the time integral of a function of a stochastic process to a spatial integral involving its local time. Let $\\{L_{t}^{y}(X^{\\varepsilon})\\}_{y\\in\\mathbb{R}}$ be the field of local times of the process $X^{\\varepsilon}$. The formula states that for a suitable function $f$,\n$$\n\\int_0^t f(X_s^\\varepsilon) ds = \\int_{\\mathbb{R}} f(y) L_{t}^{y}(X^{\\varepsilon}) dy.\n$$\nWe apply this formula to our integrated drift term by setting $f=b_{\\varepsilon}$. This yields\n$$\n\\int_{0}^{t}b_{\\varepsilon}(X_{s}^{\\varepsilon})\\,ds = \\int_{\\mathbb{R}} b_{\\varepsilon}(y) L_{t}^{y}(X^{\\varepsilon}) dy.\n$$\nSubstituting the definition of the regularized drift, $b_{\\varepsilon}(y) = \\alpha \\frac{d}{dy}\\rho_{\\varepsilon}(y)$, we get\n$$\n\\int_{0}^{t}b_{\\varepsilon}(X_{s}^{\\varepsilon})\\,ds = \\alpha \\int_{\\mathbb{R}} \\frac{d}{dy}\\rho_{\\varepsilon}(y) L_{t}^{y}(X^{\\varepsilon}) dy.\n$$\nThe function $\\rho_{\\varepsilon}(y)$ is defined as $\\varepsilon^{-1}\\rho(y/\\varepsilon)$. Its derivative is\n$$\n\\frac{d}{dy}\\rho_{\\varepsilon}(y) = \\frac{d}{dy}\\left(\\frac{1}{\\varepsilon}\\rho\\left(\\frac{y}{\\varepsilon}\\right)\\right) = \\frac{1}{\\varepsilon}\\rho'\\left(\\frac{y}{\\varepsilon}\\right) \\cdot \\frac{1}{\\varepsilon} = \\frac{1}{\\varepsilon^2}\\rho'\\left(\\frac{y}{\\varepsilon}\\right).\n$$\nThe integral becomes\n$$\n\\frac{\\alpha}{\\varepsilon^2} \\int_{\\mathbb{R}} \\rho'\\left(\\frac{y}{\\varepsilon}\\right) L_{t}^{y}(X^{\\varepsilon}) dy.\n$$\nWe perform a change of variables by letting $u = y/\\varepsilon$, which implies $y = \\varepsilon u$ and $dy = \\varepsilon du$. The integral is transformed into\n$$\n\\frac{\\alpha}{\\varepsilon^2} \\int_{\\mathbb{R}} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) (\\varepsilon du) = \\frac{\\alpha}{\\varepsilon} \\int_{\\mathbb{R}} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) du.\n$$\nThe problem states that the mollifier $\\rho$ is an even function, i.e., $\\rho(x) = \\rho(-x)$. This implies that its derivative, $\\rho'(x)$, is an odd function, i.e., $\\rho'(x) = -\\rho'(-x)$. We exploit this property by splitting the integral over $\\mathbb{R}$ into integrals over $(-\\infty, 0)$ and $(0, \\infty)$:\n$$\n\\frac{\\alpha}{\\varepsilon} \\left( \\int_{0}^{\\infty} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) du + \\int_{-\\infty}^{0} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) du \\right).\n$$\nIn the second integral, we perform another change of variables, $v = -u$, so $u = -v$ and $du = -dv$.\n$$\n\\int_{-\\infty}^{0} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) du = \\int_{\\infty}^{0} \\rho'(-v) L_{t}^{-\\varepsilon v}(X^{\\varepsilon}) (-dv) = \\int_{0}^{\\infty} \\rho'(-v) L_{t}^{-\\varepsilon v}(X^{\\varepsilon}) dv.\n$$\nUsing the oddness of $\\rho'$, we have $\\rho'(-v) = -\\rho'(v)$, which gives\n$$\n- \\int_{0}^{\\infty} \\rho'(v) L_{t}^{-\\varepsilon v}(X^{\\varepsilon}) dv.\n$$\nSubstituting this back into our expression, and relabeling the integration variable $v$ back to $u$, we obtain\n$$\n\\frac{\\alpha}{\\varepsilon} \\left( \\int_{0}^{\\infty} \\rho'(u) L_{t}^{\\varepsilon u}(X^{\\varepsilon}) du - \\int_{0}^{\\infty} \\rho'(u) L_{t}^{-\\varepsilon u}(X^{\\varepsilon}) du \\right) = \\frac{\\alpha}{\\varepsilon} \\int_{0}^{\\infty} \\rho'(u) \\left( L_{t}^{\\varepsilon u}(X^{\\varepsilon}) - L_{t}^{-\\varepsilon u}(X^{\\varepsilon}) \\right) du.\n$$\nTo connect this to the symmetric derivative provided in the problem statement, $\\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}=\\lim_{h\\downarrow 0}\\,\\frac{L_{t}^{h}(X)-L_{t}^{-h}(X)}{2h}$, we rearrange the expression as follows:\n$$\n\\alpha \\int_{0}^{\\infty} 2u \\rho'(u) \\left( \\frac{L_{t}^{\\varepsilon u}(X^{\\varepsilon}) - L_{t}^{-\\varepsilon u}(X^{\\varepsilon})}{2\\varepsilon u} \\right) du.\n$$\nWe now wish to take the limit as $\\varepsilon \\downarrow 0$. We assume that the process $X^{\\varepsilon}$ converges to a limiting process $X$ in a sense strong enough that $L_{t}^{y}(X^{\\varepsilon})$ converges to $L_{t}^{y}(X)$, and that we can pass the limit inside the integral. For a fixed $u0$ in the support of $\\rho'$, the argument of the local time difference, $\\varepsilon u$, tends to $0$. The term inside the parentheses converges to the symmetric spatial derivative of the local time of the limiting process $X$ at $y=0$:\n$$\n\\lim_{\\varepsilon\\downarrow 0} \\frac{L_{t}^{\\varepsilon u}(X^{\\varepsilon}) - L_{t}^{-\\varepsilon u}(X^{\\varepsilon})}{2\\varepsilon u} = \\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}.\n$$\nAssuming this limit exists and is independent of $u$ (for small arguments), we can factor it out of the integral. The limiting drift functional becomes\n$$\n\\lim_{\\varepsilon\\downarrow 0} \\int_{0}^{t}b_{\\varepsilon}(X_{s}^{\\varepsilon})\\,ds = \\left( \\alpha \\int_{0}^{\\infty} 2u \\rho'(u) du \\right) \\left( \\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0} \\right).\n$$\nThe remaining task is to evaluate the deterministic integral $\\int_{0}^{\\infty} 2u \\rho'(u) du$. We use integration by parts:\n$$\n2\\int_{0}^{\\infty} u \\rho'(u) du = 2\\left( \\left[ u \\rho(u) \\right]_{0}^{\\infty} - \\int_{0}^{\\infty} 1 \\cdot \\rho(u) du \\right).\n$$\nSince $\\rho \\in C_{c}^{\\infty}(\\mathbb{R})$, it has compact support, which means $\\rho(u)=0$ for $|u|$ large enough. Thus, the boundary term $[u\\rho(u)]_0^\\infty$ equals $0$. The expression simplifies to\n$$\n-2 \\int_{0}^{\\infty} \\rho(u) du.\n$$\nWe are given that $\\rho$ is an even function and $\\int_{\\mathbb{R}}\\rho(x)\\,dx=1$. Therefore,\n$$\n1 = \\int_{-\\infty}^{\\infty} \\rho(u) du = \\int_{-\\infty}^{0} \\rho(u) du + \\int_{0}^{\\infty} \\rho(u) du = 2 \\int_{0}^{\\infty} \\rho(u) du.\n$$\nThis implies $\\int_{0}^{\\infty} \\rho(u) du = \\frac{1}{2}$.\nSubstituting this result back, the integral factor is\n$$\n\\alpha \\int_{0}^{\\infty} 2u \\rho'(u) du = \\alpha \\left( -2 \\cdot \\frac{1}{2} \\right) = -\\alpha.\n$$\nCombining all parts, the limiting expression for the integrated drift is\n$$\n\\lim_{\\varepsilon\\downarrow 0} \\int_{0}^{t}b_{\\varepsilon}(X_{s}^{\\varepsilon})\\,ds = -\\alpha \\, \\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}.\n$$\nThis is the desired closed-form analytic expression for the limiting drift functional.\n\nThis result clarifies the meaning of the formal SDE $dX_{t}=dW_{t}+\\alpha\\,\\delta_{0}'(X_{t})\\,dt$. The term $\\delta_{0}'(X_{t})$ is ill-defined because the sample paths of $X_t$ are not smooth. Our derivation shows that the SDE must be understood in its integral form, where the singular drift term is interpreted as a functional of the entire path up to time $t$:\n$$\nX_t = X_0 + W_t - \\alpha \\, \\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}.\n$$\nThis is a path-dependent SDE, as the \"drift\" at time $t$ depends on the history of the process through its local time. This representation transforms the problem from one involving a distribution acting on the process's state to one involving a functional of the process's path. The existence and uniqueness of solutions (well-posedness) for such an equation can then be studied in the context of SDEs involving local time, for instance, by analyzing the associated martingale problem. The generator of the process involves highly singular terms which can be interpreted as imposing specific interface conditions on the process at $y=0$. The representation via the symmetric derivative of local time is a key step in regularizing the problem and making it amenable to analysis.", "answer": "$$\n\\boxed{-\\alpha\\,\\partial_{y}^{\\mathrm{sym}}L_{t}^{y}(X)\\big|_{y=0}}\n$$", "id": "2995802"}, {"introduction": "Having explored singular drifts, we now turn our attention to irregularities in the diffusion coefficient. This practice [@problem_id:2995833] examines the famous Tanaka SDE, where the diffusion coefficient is a discontinuous sign function, violating standard well-posedness conditions. This exercise is fundamental to understanding the critical distinction between weak solutions (existence in law) and strong solutions (pathwise uniqueness), demonstrating a scenario where the law of the solution is unique but the path itself is not determined by the driving noise. The analysis hinges on Lévy's characterization of Brownian motion and Tanaka's formula, revealing the need for 'extra randomness' to construct a solution path.", "problem": "Let $\\left(\\Omega,\\mathcal{F},\\mathbb{P}\\right)$ be a probability space and let $\\left(W_{t}\\right)_{t\\geq 0}$ be a one-dimensional standard Brownian motion on some filtered stochastic basis $\\left(\\Omega,\\mathcal{F},\\left(\\mathcal{F}_{t}\\right)_{t\\geq 0},\\mathbb{P}\\right)$ satisfying the usual conditions. Consider the one-dimensional Stochastic Differential Equation (SDE) with irregular diffusion coefficient\n$$\ndX_{t} \\;=\\; \\operatorname{sgn}\\!\\left(X_{t}\\right)\\, dW_{t}, \\qquad X_{0}=0,\n$$\nwhere $\\operatorname{sgn}(x)=\\mathbf{1}_{\\{x0\\}}-\\mathbf{1}_{\\{x0\\}}$ and $\\operatorname{sgn}(0)=0$, and let $L_{t}^{0}(X)$ denote the semimartingale local time at $0$ of the continuous semimartingale $\\left(X_{t}\\right)_{t\\geq 0}$.\n\n1. Using only foundational facts about continuous local martingales, stochastic integration, and semimartingale local time (including Tanaka’s formula) together with Lévy’s characterization of Brownian motion, construct a weak solution to the SDE above and explain why there is no strong solution with respect to the given Brownian motion’s filtration, highlighting the role of non-uniqueness of the stochastic basis.\n\n2. For a fixed $t0$, compute the characteristic function $\\varphi_{t}(u)=\\mathbb{E}\\!\\left[\\exp\\!\\left(iu X_{t}\\right)\\right]$ of $X_{t}$ as a function of $u\\in\\mathbb{R}$.\n\n3. Now consider the perturbed SDE with distributional drift supported on the zero set,\n$$\nd\\widetilde{X}_{t} \\;=\\; \\operatorname{sgn}\\!\\left(\\widetilde{X}_{t}\\right)\\, dW_{t} \\;+\\; \\beta \\, dL_{t}^{0}\\!\\left(\\widetilde{X}\\right), \n\\qquad \\widetilde{X}_{0}=0, \\qquad \\beta\\in(-1,1).\n$$\nArgue from first principles how the presence of the term involving the local time $L^{0}$ further entrenches the necessity of extra randomness beyond the Brownian motion to determine the signs of excursions, thus exacerbating the failure of strong solvability due to non-uniqueness of the stochastic basis.\n\nYour final answer must be the single closed-form analytic expression for $\\varphi_{t}(u)$ obtained in item 2. No numerical approximation or rounding is required.", "solution": "This is a valid problem in the theory of stochastic differential equations, specifically concerning SDEs with irregular coefficients and distributional drifts. The problem is well-posed, scientifically grounded, and uses standard, albeit advanced, concepts from stochastic calculus.\n\nWe will address the three parts of the problem in sequence.\n\n### Part 1: Weak Solution and Non-Existence of a Strong Solution\n\nThe given Stochastic Differential Equation (SDE) is\n$$\ndX_{t} = \\operatorname{sgn}(X_{t})\\, dW_{t}, \\qquad X_{0}=0,\n$$\nwhere $\\operatorname{sgn}(x)=\\mathbf{1}_{\\{x0\\}}-\\mathbf{1}_{\\{x0\\}}$.\n\n**Construction of a Weak Solution**\nA weak solution is a pair of processes $(X, W)$ on some filtered probability space $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t\\geq 0}, \\mathbb{P})$ such that $W$ is a standard $(\\mathcal{F}_t)$-Brownian motion, $X$ is an $(\\mathcal{F}_t)$-adapted continuous process, and the SDE is satisfied.\n\nLet $(\\Omega, \\mathcal{F}, (\\mathcal{G}_t)_{t\\geq 0}, \\mathbb{P})$ be a filtered probability space supporting a standard one-dimensional $(\\mathcal{G}_t)$-Brownian motion $(B_t)_{t \\ge 0}$ with $B_0=0$. We propose a candidate solution by setting $X_t = B_t$ for all $t \\ge 0$. We must show that there exists a Brownian motion $W_t$ such that the SDE is satisfied. Let us define a process $W_t$ by the stochastic integral:\n$$\nW_t := \\int_0^t \\operatorname{sgn}(X_s) dX_s = \\int_0^t \\operatorname{sgn}(B_s) dB_s.\n$$\nFor this construction to constitute a weak solution, we must verify that $(W_t)_{t\\geq 0}$ is a standard Brownian motion. We use Lévy's characterization theorem for Brownian motion, which states that a continuous local martingale $M_t$ with $M_0=0$ is a standard Brownian motion if and only if its quadratic variation is $\\langle M \\rangle_t = t$.\n\nThe process $W_t$ is a stochastic integral with respect to a Brownian motion, so it is a continuous local martingale with $W_0=0$. Its quadratic variation is given by:\n$$\n\\langle W \\rangle_t = \\left\\langle \\int \\operatorname{sgn}(B) dB, \\int \\operatorname{sgn}(B) dB \\right\\rangle_t = \\int_0^t (\\operatorname{sgn}(B_s))^2 d\\langle B \\rangle_s.\n$$\nThe quadratic variation of a standard Brownian motion is $\\langle B \\rangle_t = t$. The sign function squared is $(\\operatorname{sgn}(x))^2 = 1$ for $x \\neq 0$ and $(\\operatorname{sgn}(0))^2 = 0$. The set of times $\\{s \\in [0, t] : B_s = 0\\}$ has Lebesgue measure zero almost surely. Therefore, $(\\operatorname{sgn}(B_s))^2 = 1$ for almost every $s \\in [0,t]$.\nThis gives:\n$$\n\\langle W \\rangle_t = \\int_0^t 1 \\cdot ds = t.\n$$\nBy Lévy's characterization, $W_t$ is a standard Brownian motion. We have constructed a pair $(X_t, W_t) = (B_t, \\int_0^t \\operatorname{sgn}(B_s)dB_s)$ on the filtration of $B_t$ that satisfies the SDE, thus proving the existence of a weak solution. Note that the law of this solution $X_t$ is simply the law of a standard Brownian motion.\n\n**Non-Existence of a Strong Solution**\nA strong solution is a process $X_t$ adapted to the filtration $(\\mathcal{F}_t^W)_{t \\geq 0}$ generated by the *given* Brownian motion $W_t$.\n\nFirst, we establish a key property of any solution. For any continuous local martingale $X_t$ starting at $X_0=0$, its quadratic variation is $d\\langle X \\rangle_t = (\\operatorname{sgn}(X_t))^2 (dW_t)^2 = (\\operatorname{sgn}(X_t))^2 dt$. Since the zero set of $X_t$ (if it is not identically zero) must have Lebesgue measure zero, we have $\\langle X \\rangle_t = t$. By Lévy's characterization, any non-trivial solution $X_t$ must be a Brownian motion.\n\nLet's assume a strong solution $X_t$ exists. It must be a Brownian motion adapted to the filtration $\\mathcal{F}_t^W$.\nBy Tanaka's formula for the function $f(x)=|x|$ applied to the semimartingale $X_t$:\n$$\n|X_t| - |X_0| = \\int_0^t \\operatorname{sgn}(X_s) dX_s + L_t^0(X),\n$$\nwhere $L_t^0(X)$ is the semimartingale local time of $X$ at $0$.\nSubstituting $X_0=0$ and the SDE $dX_s = \\operatorname{sgn}(X_s)dW_s$, we get:\n$$\n|X_t| = \\int_0^t \\operatorname{sgn}(X_s)(\\operatorname{sgn}(X_s)dW_s) + L_t^0(X) = \\int_0^t (\\operatorname{sgn}(X_s))^2 dW_s + L_t^0(X).\n$$\nAs established before, $(\\operatorname{sgn}(X_s))^2=1$ for a.e. $s$. Thus, the integral becomes:\n$$\n|X_t| = \\int_0^t dW_s + L_t^0(X) = W_t + L_t^0(X).\n$$\nThis equation describes a Skorokhod problem for $|X_t|$ driven by $W_t$. The conditions are that $|X_t| \\ge 0$ and $L_t^0(X)$ is a non-decreasing process that increases only when $|X_t|=0$. This problem has a unique solution for a given $W_t$:\n$$\nL_t^0(X) = \\sup_{0 \\le s \\le t}(-W_s) \\lor 0 = -\\inf_{0 \\le s \\le t} W_s \\quad (\\text{since } W_0=0),\n$$\nand consequently,\n$$\n|X_t| = W_t - \\inf_{0 \\le s \\le t} W_s = \\sup_{0 \\le s \\le t}(W_t - W_s).\n$$\nThis shows that if a strong solution $X_t$ exists, its absolute value $|X_t|$ is uniquely determined by the path of $W_t$ and is therefore adapted to $\\mathcal{F}_t^W$. The process $|X_t|$ is a reflected Brownian motion.\n\nHowever, a strong solution $X_t$ must be fully determined by $W_t$. We know $X_t = \\operatorname{sgn}(X_t)|X_t|$. While $|X_t|$ is determined, the sign process $\\operatorname{sgn}(X_t)$ is not. The behavior of $X_t$ is described by excursions away from zero. Let $(l_i, r_i)$ be the $i$-th excursion interval of $|X_t|$ from zero. The sign of $X_t$ during this excursion, let's call it $\\epsilon_i$, can be either $+1$ or $-1$. The dynamics of the SDE are symmetric, meaning that if $X_t$ is a solution, so is $-X_t$. There is nothing in the information provided by $W_t$ to determine the sign $\\epsilon_i$ of any given excursion. To construct a full path for $X_t$, one needs to provide an infinite sequence of signs $\\{\\epsilon_i\\}_{i \\ge 1}$, which corresponds to choosing the sign of each excursion. This sequence must be a sequence of i.i.d. Rademacher random variables, independent of $|X_t|$ (and thus independent of $W_t$). This sequence represents \"extra randomness\" not contained in the filtration $\\mathcal{F}_t^W$. Since $X_t$ depends on this external randomness, it cannot be adapted to $\\mathcal{F}_t^W$. Therefore, no strong solution exists. The non-uniqueness of the stochastic basis refers to the fact that a solution can be constructed, but only on an enlarged filtration $\\mathcal{F}_t^W \\lor \\sigma(\\{\\epsilon_i\\})$.\n\n### Part 2: Characteristic Function of $X_t$\n\nWe seek to compute $\\varphi_t(u) = \\mathbb{E}[\\exp(iuX_t)]$ for a fixed $t0$ and $u\\in\\mathbb{R}$.\nAs shown in Part 1, any weak solution $X_t$ to the SDE, starting from $X_0=0$, must have a quadratic variation $\\langle X \\rangle_t = t$. Since $X_t$ is a continuous local martingale, Lévy's characterization implies that $X_t$ is a standard Brownian motion.\nA standard Brownian motion $B_t$ at a fixed time $t$ follows a normal distribution with mean $0$ and variance $t$, i.e., $B_t \\sim \\mathcal{N}(0,t)$.\nTherefore, $X_t \\sim \\mathcal{N}(0,t)$.\nThe characteristic function of a random variable $Y \\sim \\mathcal{N}(\\mu, \\sigma^2)$ is given by $\\mathbb{E}[\\exp(iuY)] = \\exp(iu\\mu - \\frac{1}{2}u^2\\sigma^2)$.\nFor $X_t$, we have $\\mu=0$ and $\\sigma^2=t$. Hence, its characteristic function is:\n$$\n\\varphi_t(u) = \\exp\\left(-\\frac{1}{2}u^2t\\right).\n$$\nAlternatively, we can derive this result directly using Itô's formula, without first identifying the law of $X_t$. Let $f(x) = \\exp(iux)$. Its derivatives are $f'(x) = iu\\exp(iux)$ and $f''(x) = -u^2\\exp(iux)$. Applying Itô's formula to $f(X_t)$:\n$$\nd(\\exp(iuX_t)) = f'(X_t)dX_t + \\frac{1}{2}f''(X_t)d\\langle X \\rangle_t.\n$$\nSubstituting $dX_t = \\operatorname{sgn}(X_t) dW_t$ and $d\\langle X\\rangle_t = dt$:\n$$\nd(\\exp(iuX_t)) = iu\\exp(iuX_t)\\operatorname{sgn}(X_t)dW_t - \\frac{1}{2}u^2\\exp(iuX_t)dt.\n$$\nIntegrating from $s=0$ to $s=t$ and taking expectations:\n$$\n\\mathbb{E}[\\exp(iuX_t)] - \\mathbb{E}[\\exp(iuX_0)] = \\mathbb{E}\\left[iu \\int_0^t \\exp(iuX_s)\\operatorname{sgn}(X_s)dW_s\\right] - \\mathbb{E}\\left[\\frac{u^2}{2}\\int_0^t \\exp(iuX_s)ds\\right].\n$$\nSince $X_0=0$, $\\exp(iuX_0)=1$. The stochastic integral term has zero expectation because the integrand is bounded and thus the stochastic integral is a true martingale. Using Fubini's theorem on the last term:\n$$\n\\varphi_t(u) - 1 = 0 - \\frac{u^2}{2}\\int_0^t \\mathbb{E}[\\exp(iuX_s)]ds = -\\frac{u^2}{2}\\int_0^t \\varphi_s(u)ds.\n$$\nLetting $g(t) = \\varphi_t(u)$, we have the ordinary differential equation:\n$$\ng'(t) = -\\frac{u^2}{2}g(t), \\quad\\text{with initial condition } g(0)=\\varphi_0(u)=1.\n$$\nThe unique solution to this ODE is $g(t) = \\exp(-\\frac{u^2 t}{2})$.\n\n### Part 3: Perturbed SDE\n\nThe perturbed SDE is given by:\n$$\nd\\widetilde{X}_{t} = \\operatorname{sgn}(\\widetilde{X}_{t})\\, dW_{t} + \\beta \\, dL_{t}^{0}(\\widetilde{X}), \\qquad \\widetilde{X}_{0}=0, \\qquad \\beta\\in(-1,1).\n$$\nApplying Tanaka's formula to $|\\widetilde{X}_t|$:\n$$\n|\\widetilde{X}_t| = \\int_0^t \\operatorname{sgn}(\\widetilde{X}_s) d\\widetilde{X}_s + L_t^0(\\widetilde{X}).\n$$\nSubstituting the SDE for $d\\widetilde{X}_s$:\n$$\n|\\widetilde{X}_t| = \\int_0^t \\operatorname{sgn}(\\widetilde{X}_s) \\left( \\operatorname{sgn}(\\widetilde{X}_s)dW_s + \\beta dL_s^0(\\widetilde{X}) \\right) + L_t^0(\\widetilde{X}).\n$$\n$$\n|\\widetilde{X}_t| = \\int_0^t (\\operatorname{sgn}(\\widetilde{X}_s))^2 dW_s + \\beta \\int_0^t \\operatorname{sgn}(\\widetilde{X}_s) dL_s^0(\\widetilde{X}) + L_t^0(\\widetilde{X}).\n$$\nThe first integral is $W_t$. The local time $L_s^0(\\widetilde{X})$ increases only when $\\widetilde{X}_s=0$. By the given definition, $\\operatorname{sgn}(0)=0$. Therefore, the integrand $\\operatorname{sgn}(\\widetilde{X}_s)$ is zero whenever $dL_s^0(\\widetilde{X})$ is non-zero. The second integral is thus zero: $\\int_0^t \\operatorname{sgn}(\\widetilde{X}_s) dL_s^0(\\widetilde{X})=0$.\nWe are left with:\n$$\n|\\widetilde{X}_t| = W_t + L_t^0(\\widetilde{X}).\n$$\nThis is the same relationship as in the unperturbed case. This means that for any solution $\\widetilde{X}_t$, its absolute value $|\\widetilde{X}_t|$ is the same reflected Brownian motion determined by $W_t$ as before.\n\nThe presence of the term $\\beta dL_t^0(\\widetilde{X})$, however, fundamentally alters the behavior of the process at zero. This term acts as a drift that is active only when the process is at the origin. It affects the choice of sign for the next excursion. Heuristically, when the process hits zero, it receives a \"push\" of size $\\beta$ for every unit of local time it accumulates there. If $\\beta0$, the push is positive, biasing the process towards positive excursions. If $\\beta0$, the push is negative.\nThis behavior is formalized in the theory of skew Brownian motion. The solution $\\widetilde{X}_t$ is a skew Brownian motion where the probability of an excursion starting from zero being positive is $p = \\frac{1+\\beta}{2}$. Since $\\beta \\in (-1,1)$, this probability $p$ is in $(0,1)$.\nFor $\\beta=0$, $p=1/2$, corresponding to the symmetric case where the sign of an excursion is decided by a fair coin flip.\nFor $\\beta \\neq 0$, $p \\neq 1/2$, and the coin is biased.\n\nThe failure of strong solvability stems from the need for external randomness to determine the signs of excursions, as this information is not contained in the filtration of $W_t$. The introduction of $\\beta \\neq 0$ \"further entrenches\" this failure for a deeper reason based on symmetry.\nThe driving process $W_t$ is a standard Brownian motion, a process whose properties are symmetric with respect to a sign change (i.e., the law of $W_t$ is the same as the law of $-W_t$).\nIn the case $\\beta=0$, the required external randomness is a sequence of fair coin flips, which is itself a symmetric random object. While it is not possible to construct these flips from $W_t$, one might not see an immediate contradiction based on symmetry alone.\nIn the case $\\beta\\neq0$, the problem becomes asymmetric. The required external randomness is a sequence of *biased* coin flips. This introduces a fundamental asymmetry into the solution's structure. It becomes conceptually even more apparent that a symmetric driving process like $W_t$ cannot, by itself, generate the necessary asymmetric outcomes (the biased flips). Any construction of $\\widetilde{X}_t$ purely from $W_t$ would have to respect the symmetries of $W_t$. Since the law of the solution is asymmetric for $\\beta\\neq 0$, it cannot be a measurable function of a symmetric object like $W_t$. Therefore, the introduction of $\\beta$ makes the impossibility of a strong solution more profound by creating a fundamental mismatch in the symmetry properties of the input ($W_t$) and the required output ($\\widetilde{X}_t$).", "answer": "$$\n\\boxed{\\exp\\!\\left(-\\frac{t u^2}{2}\\right)}\n$$", "id": "2995833"}]}