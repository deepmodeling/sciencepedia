{"hands_on_practices": [{"introduction": "We begin with the most fundamental type of Backward Stochastic Differential Equation (BSDE), one where the driver term is zero. This exercise is designed to illustrate the core connection between BSDEs and the concept of conditional expectation, revealing that in this simple yet important case, the solution process $Y_t$ is nothing more than the best estimate of the terminal value given the information available at time $t$. Mastering this foundational case [@problem_id:841719] is the first step toward understanding the structure of all BSDEs.", "problem": "Consider a complete filtered probability space $(\\Omega, \\mathcal{F}, \\{\\mathcal{F}_t\\}_{t \\geq 0}, P)$, on which a standard one-dimensional Brownian motion $W_t$ is defined, with $W_0=0$.\n\nLet the stochastic process $X_t$ be an arithmetic Brownian motion governed by the stochastic differential equation (SDE):\n$$\ndX_t = \\mu dt + \\sigma dW_t\n$$\nwith a constant drift $\\mu$, constant volatility $\\sigma  0$, and a deterministic initial condition $X_0 = x_0$.\n\nNow, consider a pair of adapted stochastic processes $(Y_t, Z_t)$ that solves the following backward stochastic differential equation (BSDE) on the time interval $[0, T]$:\n$$\n-dY_t = -Z_t dW_t\n$$\nThis is equivalent to $dY_t = Z_t dW_t$. The process is subject to the terminal condition:\n$$\nY_T = X_T^2\n$$\nDerive the value of $Y_0$ in terms of the parameters $x_0, \\mu, \\sigma$, and $T$.", "solution": "For the BSDE \n$$dY_t=Z_t\\,dW_t,\\quad Y_T=X_T^2,$$\nthe generator is zero, so \n$$Y_t=\\mathbb{E}\\bigl[X_T^2\\mid\\mathcal{F}_t\\bigr].$$\nIn particular,\n$$Y_0=\\mathbb{E}[X_T^2].$$\nThe SDE \n$$dX_t=\\mu\\,dt+\\sigma\\,dW_t$$\nhas solution\n$$X_T=x_0+\\mu T+\\sigma W_T.$$\nHence\n$$\\mathbb{E}[X_T]=x_0+\\mu T,\\quad \\mathrm{Var}(X_T)=\\sigma^2T,$$\nand\n$$\\mathbb{E}[X_T^2]=\\bigl(\\mathbb{E}[X_T]\\bigr)^2+\\mathrm{Var}(X_T)\n=(x_0+\\mu T)^2+\\sigma^2T.$$\nTherefore,\n$$Y_0=(x_0+\\mu T)^2+\\sigma^2T.$$", "answer": "$$\\boxed{(x_0 + \\mu T)^2 + \\sigma^2 T}$$", "id": "841719"}, {"introduction": "Having mastered the zero-driver case, we now advance to the broad and highly applicable class of linear BSDEs. These equations feature a driver that depends linearly on the solution components $Y_t$ and $Z_t$. This practice [@problem_id:772846] introduces a powerful and systematic method for finding explicit solutions, which involves the use of an integrating factor and a technique analogous to a change of measure, providing a key tool for your analytical arsenal.", "problem": "Let $(\\Omega, \\mathcal{F}, (\\mathcal{F}_t)_{t \\in [0,T]}, P)$ be a filtered probability space supporting a standard one-dimensional Brownian motion $W_t$, with $W_0 = 0$.\n\nConsider a pair of adapted processes $(Y_t, Z_t)$ that solves the following backward stochastic differential equation (BSDE):\n$$-dY_t = (\\alpha Y_t + \\beta Z_t + \\gamma) dt - Z_t dW_t$$\nfor $t \\in [0, T]$, where $\\alpha, \\beta, \\gamma$ are real constants with $\\alpha \\neq 0$, and $T0$ is a fixed terminal time.\n\nThe process $Y_t$ must satisfy the terminal condition:\n$$Y_T = \\exp(\\lambda W_T)$$\nwhere $\\lambda$ is a real constant.\n\nYour task is to find the value of the process $Y_t$ at time $t=0$. The final answer should be an explicit, closed-form expression in terms of the constants $\\alpha, \\beta, \\gamma, \\lambda,$ and $T$.", "solution": "The problem asks for the value of $Y_0$ for the BSDE:\n$$-dY_t = (\\alpha Y_t + \\beta Z_t + \\gamma) dt - Z_t dW_t$$\nwith terminal condition $Y_T = \\exp(\\lambda W_T)$.\n\n1.  **Write the Forward SDE for Y**: The BSDE in its forward differential form is:\n    $$dY_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)dt + Z_t dW_t$$\n\n2.  **Girsanov Transformation**: To eliminate the $Z_t$ term from the drift, we perform a change of measure. Let's define a new Brownian motion $\\tilde{W}_t$ under a new measure $\\tilde{P}$ as:\n    $$d\\tilde{W}_t = dW_t + \\beta dt$$\n    By Girsanov's theorem, $\\tilde{W}_t$ is a standard Brownian motion under $\\tilde{P}$. We substitute $dW_t = d\\tilde{W}_t - \\beta dt$ into the SDE for $Y_t$:\n    $$dY_t = -(\\alpha Y_t + \\beta Z_t + \\gamma)dt + Z_t (d\\tilde{W}_t - \\beta dt)$$\n    $$dY_t = -(\\alpha Y_t + \\gamma)dt + Z_t d\\tilde{W}_t$$\n\n3.  **Solve the Linear SDE**: The equation is now a linear SDE in $Y_t$ without a $Z_t$ dependency in the drift. We can solve it using an integrating factor.\n    $$dY_t + \\alpha Y_t dt = -\\gamma dt + Z_t d\\tilde{W}_t$$\n    Multiply by the integrating factor $e^{\\alpha t}$:\n    $$d(e^{\\alpha t} Y_t) = e^{\\alpha t}(dY_t + \\alpha Y_t dt) = e^{\\alpha t}(-\\gamma dt + Z_t d\\tilde{W}_t)$$\n\n4.  **Integrate and take Expectation**: Integrating from $t$ to $T$ gives:\n    $$e^{\\alpha T}Y_T - e^{\\alpha t}Y_t = \\int_t^T -\\gamma e^{\\alpha s} ds + \\int_t^T e^{\\alpha s} Z_s d\\tilde{W}_s$$\n    Rearranging for $Y_t$ and taking the conditional expectation under the measure $\\tilde{P}$ (which cancels the stochastic integral term):\n    $$Y_t = \\tilde{\\mathbb{E}}\\left[ e^{-\\alpha(T-t)} Y_T + \\int_t^T \\gamma e^{-\\alpha(s-t)} ds \\;\\middle|\\; \\mathcal{F}_t \\right]$$\n\n5.  **Calculate Y_0**: At $t=0$, we need to compute unconditional expectations:\n    $$Y_0 = \\tilde{\\mathbb{E}}\\left[ e^{-\\alpha T} Y_T \\right] + \\int_0^T \\gamma e^{-\\alpha s} ds$$\n    The second term is deterministic: $\\int_0^T \\gamma e^{-\\alpha s} ds = \\frac{\\gamma}{\\alpha}(1 - e^{-\\alpha T})$.\n    For the first term, we use the relationship between expectations $\\tilde{\\mathbb{E}}[X] = \\mathbb{E}[L_T X]$, where the Radon-Nikodym density is $L_t = \\frac{d\\tilde{P}}{dP}|_{\\mathcal{F}_t} = \\exp(-\\beta W_t - \\frac{1}{2}\\beta^2 t)$.\n    $$\\tilde{\\mathbb{E}}[e^{-\\alpha T} Y_T] = e^{-\\alpha T} \\mathbb{E}[L_T \\exp(\\lambda W_T)] = e^{-\\alpha T} \\mathbb{E}\\left[\\exp(-\\beta W_T - \\frac{1}{2}\\beta^2 T) \\exp(\\lambda W_T)\\right]$$\n    $$= e^{-\\alpha T} e^{-\\frac{1}{2}\\beta^2 T} \\mathbb{E}\\left[\\exp((\\lambda-\\beta)W_T)\\right]$$\n    Using the moment generating function of a normal random variable $W_T \\sim N(0,T)$, which is $\\mathbb{E}[e^{k W_T}] = e^{\\frac{1}{2}k^2 T}$:\n    $$= e^{-\\alpha T} e^{-\\frac{1}{2}\\beta^2 T} e^{\\frac{1}{2}(\\lambda-\\beta)^2 T} = e^{T(-\\alpha - \\frac{1}{2}\\beta^2 + \\frac{1}{2}(\\lambda^2 - 2\\lambda\\beta + \\beta^2))} = e^{T(-\\alpha - \\lambda\\beta + \\frac{1}{2}\\lambda^2)}$$\n\n6.  **Combine Terms**: Putting everything together:\n    $$Y_0 = \\exp\\left(\\left(-\\alpha - \\beta\\lambda + \\frac{1}{2}\\lambda^2\\right)T\\right) + \\frac{\\gamma}{\\alpha}\\left(1 - e^{-\\alpha T}\\right)$$", "answer": "$$\\boxed{\\exp\\left(\\left(-\\alpha - \\beta\\lambda + \\frac{1}{2}\\lambda^2\\right)T\\right) + \\frac{\\gamma}{\\alpha}\\left(1 - e^{-\\alpha T}\\right)}$$", "id": "772846"}, {"introduction": "This final practice delves into the deeper theoretical underpinnings of BSDEs, connecting them to the powerful framework of Malliavin calculus. We will explore how the Clark-Ocone formula provides an explicit representation for the volatility process $Z_t$ in terms of the Malliavin derivative of the terminal condition. This exercise [@problem_id:2969602] not only offers a sophisticated method for identifying the $Z_t$ process but also deepens your understanding of its role as the integrand in the martingale representation of the solution.", "problem": "Let $\\left(\\Omega,\\mathcal{F},\\{\\mathcal{F}_t\\}_{t\\in[0,T]},\\mathbb{P}\\right)$ be a complete filtered probability space supporting a one-dimensional standard Brownian motion $W=\\{W_t\\}_{t\\in[0,T]}$ with its augmented natural filtration. Fix $T\\in(0,\\infty)$. Consider the Backward Stochastic Differential Equation (BSDE) with deterministic driver\n$$\nY_t \\;=\\; h(W_T) \\;+\\; \\int_t^T g(s)\\,ds \\;-\\; \\int_t^T Z_s\\,dW_s,\\qquad t\\in[0,T],\n$$\nwhere $g\\in L^2([0,T])$ is deterministic and $h:\\mathbb{R}\\to\\mathbb{R}$ is such that $h(W_T)\\in L^2(\\Omega)$ and $h\\in\\mathbb{D}^{1,2}$, the Malliavin–Sobolev space of square-integrable, Malliavin differentiable functionals. Assume standard conditions ensuring existence and uniqueness of $(Y,Z)$ in $L^2$.\n\n1) Starting from the Itô representation theorem and the Clark–Ocone formula in Malliavin calculus, derive the representation of the integrand $Z$ in terms of the Malliavin derivative of the terminal condition. In particular, show that for almost every $t\\in[0,T]$,\n$$\nZ_t \\;=\\; \\mathbb{E}\\!\\left[\\,D_t h(W_T)\\,\\middle|\\,\\mathcal{F}_t\\right].\n$$\n\n2) Compute the explicit closed-form expression of $Z_t$ when $h(x)=x^2$, and simplify your answer as a function of $t$ and $W_t$ only. Provide your final expression in exact form. No rounding is required.", "solution": "The problem is divided into two parts. The first part requires the derivation of a general representation for the process $Z_t$ in a Backward Stochastic Differential Equation (BSDE) using tools from Malliavin calculus. The second part asks for an explicit computation of $Z_t$ for a specific terminal condition.\n\nPart $1$: Derivation of the representation for $Z_t$.\n\nWe are given the BSDE:\n$$Y_t = h(W_T) + \\int_t^T g(s)\\,ds - \\int_t^T Z_s\\,dW_s, \\quad t\\in[0,T]$$\nwhere $g$ is a deterministic function in $L^2([0,T])$ and $h(W_T) \\in L^2(\\Omega)$ with $h \\in \\mathbb{D}^{1,2}$. The pair $(Y_t, Z_t)$ is the adapted solution to this equation.\n\nWe can rewrite the BSDE in differential form. For $t \\in [0,T]$, the dynamics of $Y_t$ are given by:\n$$dY_t = -g(t)\\,dt + Z_t\\,dW_t$$\nLet us define a new process $M_t$ by adding the deterministic drift term back to $Y_t$:\n$$M_t = Y_t + \\int_0^t g(s)\\,ds$$\nThe stochastic differential of $M_t$ is:\n$$dM_t = dY_t + g(t)\\,dt = (-g(t)\\,dt + Z_t\\,dW_t) + g(t)\\,dt = Z_t\\,dW_t$$\nThis implies that $M_t$ is a local martingale. Since the solution $(Y,Z)$ is assumed to exist in the usual $L^2$ spaces, which implies $\\mathbb{E}[\\int_0^T Z_s^2 ds]  \\infty$, the process $M_t$ is a true martingale.\n\nAs $M_t$ is a martingale with respect to the filtration $\\{\\mathcal{F}_t\\}_{t \\in [0,T]}$, it must satisfy the property $M_t = \\mathbb{E}[M_T | \\mathcal{F}_t]$ for all $t \\in [0,T]$.\nLet's determine the terminal value $M_T$. At time $t=T$, the BSDE gives $Y_T = h(W_T)$. Therefore,\n$$M_T = Y_T + \\int_0^T g(s)\\,ds = h(W_T) + \\int_0^T g(s)\\,ds$$\nSince the integral $\\int_0^T g(s)\\,ds$ is a deterministic constant, the martingale $M_t$ can be expressed as:\n$$M_t = \\mathbb{E}\\left[h(W_T) + \\int_0^T g(s)\\,ds \\, \\middle| \\, \\mathcal{F}_t\\right] = \\mathbb{E}[h(W_T)|\\mathcal{F}_t] + \\int_0^T g(s)\\,ds$$\nThe process $M_t$ is an $\\mathcal{F}_t$-adapted, square-integrable martingale. The filtration $\\{\\mathcal{F}_t\\}_{t \\in [0,T]}$ is generated by the Brownian motion $W_t$. The Martingale Representation Theorem states that any such martingale can be written as a stochastic integral with respect to $W_t$. We already have one such representation from the definition of $M_t$:\n$$M_t = M_0 + \\int_0^t Z_s\\,dW_s$$\nThe Clark-Ocone formula provides an explicit expression for the integrand in the martingale representation of functionals of Brownian motion. Specifically, for an $\\mathcal{F}_T$-measurable random variable $F \\in \\mathbb{D}^{1,2}$, the martingale $N_t = \\mathbb{E}[F|\\mathcal{F}_t]$ has the representation:\n$$N_t = \\mathbb{E}[F] + \\int_0^t \\mathbb{E}[D_s F | \\mathcal{F}_s]\\,dW_s$$\nwhere $D_s$ is the Malliavin derivative operator.\n\nLet's apply this to our martingale $M_t = \\mathbb{E}[M_T|\\mathcal{F}_t]$. The integrand in its representation is given by $\\mathbb{E}[D_t M_T | \\mathcal{F}_t]$. By the uniqueness of the martingale representation integrand, we can identify $Z_t$ with this expression:\n$$Z_t = \\mathbb{E}[D_t M_T | \\mathcal{F}_t]$$\nWe now compute the Malliavin derivative of $M_T$:\n$$D_t M_T = D_t \\left(h(W_T) + \\int_0^T g(s)\\,ds\\right)$$\nThe Malliavin derivative is a linear operator. The term $\\int_0^T g(s)\\,ds$ is a deterministic constant, and the Malliavin derivative of any constant is $0$. Therefore:\n$$D_t M_T = D_t h(W_T) + D_t\\left(\\int_0^T g(s)\\,ds\\right) = D_t h(W_T) + 0 = D_t h(W_T)$$\nSubstituting this back into our expression for $Z_t$, we obtain the desired result:\n$$Z_t = \\mathbb{E}[D_t h(W_T) | \\mathcal{F}_t]$$\nThis holds for almost every $t \\in [0,T]$. This result shows that the integrand $Z_t$ in the BSDE is the conditional expectation of the Malliavin derivative of the terminal value functional $h(W_T)$. The term involving $g(s)$ affects the process $Y_t$ but not the martingale component $Z_t$.\n\nPart $2$: Explicit computation for $h(x)=x^2$.\n\nWe are given the specific terminal condition functional $h(x) = x^2$, so the terminal condition is $Y_T = h(W_T) = W_T^2$. To find $Z_t$, we use the formula derived in Part $1$:\n$$Z_t = \\mathbb{E}[D_t(W_T^2) | \\mathcal{F}_t]$$\nFirst, we compute the Malliavin derivative $D_t(W_T^2)$. We use the chain rule for the Malliavin derivative, which states that for a differentiable function $f:\\mathbb{R}\\to\\mathbb{R}$ and a Malliavin differentiable random variable $F$, $D_t(f(F)) = f'(F) D_t(F)$.\nHere, $f(x)=x^2$ and $F=W_T$. The derivative is $f'(x) = 2x$. So,\n$$D_t(W_T^2) = 2 W_T \\cdot D_t(W_T)$$\nThe Malliavin derivative of the Brownian motion $W_s$ at time $t$ is the indicator function $D_t(W_s) = \\mathbf{1}_{[0,s]}(t)$. For $s=T$, we have $D_t(W_T) = \\mathbf{1}_{[0,T]}(t)$. Since we are considering $t \\in [0,T]$, $\\mathbf{1}_{[0,T]}(t) = 1$ for almost every $t$ in this interval.\nThus, the Malliavin derivative is:\n$$D_t(W_T^2) = 2W_T \\cdot 1 = 2W_T$$\nNow, we substitute this into the expression for $Z_t$:\n$$Z_t = \\mathbb{E}[2W_T | \\mathcal{F}_t]$$\nBy linearity of conditional expectation, this becomes:\n$$Z_t = 2 \\mathbb{E}[W_T | \\mathcal{F}_t]$$\nTo evaluate the conditional expectation, we use the property that Brownian motion is a martingale. We can write $W_T$ as the sum of its value at time $t$ and a future increment:\n$$W_T = W_t + (W_T - W_t)$$\nTaking the conditional expectation with respect to $\\mathcal{F}_t$:\n$$\\mathbb{E}[W_T | \\mathcal{F}_t] = \\mathbb{E}[W_t + (W_T - W_t) | \\mathcal{F}_t] = \\mathbb{E}[W_t | \\mathcal{F}_t] + \\mathbb{E}[W_T - W_t | \\mathcal{F}_t]$$\nSince $W_t$ is $\\mathcal{F}_t$-measurable, $\\mathbb{E}[W_t | \\mathcal{F}_t] = W_t$. The increment $W_T - W_t$ is independent of the filtration $\\mathcal{F}_t$ for $t  T$. Therefore, its conditional expectation is equal to its unconditional expectation:\n$$\\mathbb{E}[W_T - W_t | \\mathcal{F}_t] = \\mathbb{E}[W_T - W_t] = \\mathbb{E}[W_T] - \\mathbb{E}[W_t] = 0 - 0 = 0$$\nCombining these results, we get:\n$$\\mathbb{E}[W_T | \\mathcal{F}_t] = W_t + 0 = W_t$$\nFinally, we substitute this back into the expression for $Z_t$:\n$$Z_t = 2 \\mathbb{E}[W_T | \\mathcal{F}_t] = 2W_t$$\nThis is the explicit closed-form expression for $Z_t$ as a function of $t$ and $W_t$.", "answer": "$$\\boxed{2W_t}$$", "id": "2969602"}]}