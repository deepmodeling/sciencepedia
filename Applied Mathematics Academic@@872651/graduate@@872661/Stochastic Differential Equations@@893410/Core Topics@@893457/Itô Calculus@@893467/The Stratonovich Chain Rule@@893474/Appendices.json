{"hands_on_practices": [{"introduction": "This first practice provides a concrete application of the Stratonovich chain rule to one of the most important functions in stochastic modeling: the exponential function. By calculating the differential for $Y_t = \\exp(\\alpha X_t)$, you will see how the classical chain rule elegantly applies in the Stratonovich framework. The subsequent conversion to the Itô representation will then make explicit the correction term that arises, providing a foundational understanding of the relationship between the two calculi. [@problem_id:3003904]", "problem": "Let $\\{W_t\\}_{t \\ge 0}$ be a standard one-dimensional Brownian motion and let $X_t$ solve the one-dimensional Stratonovich Stochastic Differential Equation (SDE), meaning the Stratonovich integral is used, given by\n$$\ndX_t \\;=\\; a(X_t)\\,dt \\;+\\; b(X_t)\\,\\circ dW_t,\n$$\nwhere $a:\\mathbb{R}\\to\\mathbb{R}$ and $b:\\mathbb{R}\\to\\mathbb{R}$ are twice continuously differentiable functions with at most polynomial growth. Fix a constant $\\alpha \\in \\mathbb{R}$ and define the process $Y_t := \\exp(\\alpha X_t)$.\n\nStarting from the definition of the Stratonovich integral as the symmetric limit of Riemann sums and the classical chain rule for smooth functions, derive the Stratonovich differential $dY_t$. Then, using the fundamental relation between Stratonovich and Itô integrals via quadratic covariation, or equivalently by converting $dX_t$ to its Itô form and applying the Itô formula, convert $dY_t$ to an Itô SDE. Express the drift coefficient of the Itô SDE for $Y_t$ fully in terms of $a$, $b$, their derivatives with respect to the spatial variable, and $\\alpha$.\n\nProvide only the final analytic expression for the Itô drift coefficient of $Y_t$ in closed form. No numerical approximation is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- A standard one-dimensional Brownian motion, $\\{W_t\\}_{t \\ge 0}$.\n- A process $X_t$ governed by the Stratonovich Stochastic Differential Equation (SDE):\n$$\ndX_t = a(X_t)\\,dt + b(X_t)\\,\\circ dW_t\n$$\n- The functions $a: \\mathbb{R} \\to \\mathbb{R}$ and $b: \\mathbb{R} \\to \\mathbb{R}$ are twice continuously differentiable ($C^2$) and exhibit at most polynomial growth.\n- A real constant $\\alpha \\in \\mathbb{R}$.\n- A new process $Y_t$ defined by the transformation $Y_t = \\exp(\\alpha X_t)$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is situated within the standard mathematical theory of stochastic calculus, specifically addressing the relationship between Itô and Stratonovich integrals and their corresponding chain rules. All concepts are fundamental to this field.\n- **Well-Posed**: The problem is clearly stated. The conditions on the coefficient functions $a(x)$ and $b(x)$ ($C^2$ with polynomial growth) are standard and sufficient to guarantee the existence and uniqueness of a strong solution for the SDE for $X_t$. The transformation function $f(x) = \\exp(\\alpha x)$ is infinitely differentiable ($C^\\infty$). Therefore, applying the rules of stochastic calculus will lead to a unique and well-defined expression for the drift of $Y_t$.\n- **Objective**: The problem is stated using precise, unambiguous mathematical language.\n\nThe problem is deemed valid as it does not violate any of the criteria for invalidity. It is a standard, non-trivial exercise in stochastic calculus. We may proceed to the solution.\n\n### Derivation of the Itô Drift Coefficient for $Y_t$\nThe solution will follow the path outlined in the problem statement: first, we derive the Stratonovich SDE for $Y_t$, and second, we convert this SDE to its Itô equivalent to identify the drift coefficient.\n\n**Part 1: Derivation of the Stratonovich SDE for $Y_t$**\n\nLet the transformation be $Y_t = f(X_t)$, where $f(x) = \\exp(\\alpha x)$. The function $f$ is smooth (infinitely differentiable). A key property of the Stratonovich integral is that the chain rule for a smooth function $f$ applied to a semimartingale takes the same form as the classical chain rule from ordinary calculus. This is a direct consequence of the symmetric limiting procedure used to define the Stratonovich integral.\n\nThe Stratonovich chain rule is given by:\n$$\ndY_t = df(X_t) = f'(X_t) \\circ dX_t\n$$\nwhere $f'(x) = \\frac{df}{dx}(x)$. For $f(x) = \\exp(\\alpha x)$, the derivative is $f'(x) = \\alpha \\exp(\\alpha x)$.\n\nSubstituting $f'(X_t)$ and the SDE for $dX_t$ into the chain rule:\n$$\ndY_t = \\alpha \\exp(\\alpha X_t) \\circ (a(X_t)\\,dt + b(X_t)\\,\\circ dW_t)\n$$\nThe Stratonovich integral is linear. The composition with a $dt$ term is equivalent to standard multiplication, and the composition of two stochastic terms follows the rule $(g_1 \\circ (g_2 \\circ dW_t)) = (g_1 g_2) \\circ dW_t$. Therefore, we can distribute the term $\\alpha \\exp(\\alpha X_t)$:\n$$\ndY_t = \\alpha \\exp(\\alpha X_t) a(X_t)\\,dt + \\alpha \\exp(\\alpha X_t) b(X_t)\\,\\circ dW_t\n$$\nThis is the Stratonovich SDE for $Y_t$. Let's define the new drift and diffusion coefficients as functions of $X_t$:\n$$\nA(X_t) = \\alpha \\exp(\\alpha X_t) a(X_t)\n$$\n$$\nB(X_t) = \\alpha \\exp(\\alpha X_t) b(X_t)\n$$\nSo, the SDE is $dY_t = A(X_t)\\,dt + B(X_t)\\,\\circ dW_t$.\n\n**Part 2: Conversion to an Itô SDE**\n\nTo convert from a Stratonovich SDE to an Itô SDE, we use the fundamental relationship between the two integrals. For a process $G_t$, the relationship is:\n$$\n\\int_0^T G_t \\circ dW_t = \\int_0^T G_t \\,dW_t + \\frac{1}{2} \\langle G, W \\rangle_T\n$$\nIn differential notation, this is $G_t \\circ dW_t = G_t \\,dW_t + \\frac{1}{2}d\\langle G, W \\rangle_t$.\nApplying this to our Stratonovich SDE for $Y_t$ with $G_t = B(X_t)$:\n$$\ndY_t = A(X_t)\\,dt + B(X_t)\\,dW_t + \\frac{1}{2}d\\langle B(X), W \\rangle_t\n$$\nThe Itô SDE for $Y_t$ will be of the form $dY_t = \\mu_Y(X_t)\\,dt + \\sigma_Y(X_t)\\,dW_t$. The Itô drift, $\\mu_Y(X_t)$, is the sum of all terms multiplying $dt$.\n$$\n\\mu_Y(X_t) = A(X_t) + \\frac{1}{2} \\frac{d\\langle B(X), W \\rangle_t}{dt}\n$$\nThe term $\\frac{d\\langle B(X), W \\rangle_t}{dt}$ is the quadratic covariation rate between the process $B(X_t)$ and the Brownian motion $W_t$. For two Itô processes $dZ_1 = \\sigma_1 dW_t + \\dots$ and $dZ_2 = \\sigma_2 dW_t + \\dots$, the quadratic covariation is $d\\langle Z_1, Z_2 \\rangle_t = \\sigma_1 \\sigma_2 dt$. Here, $Z_2 = W_t$, so $\\sigma_2 = 1$. We need to find the diffusion coefficient of the process $Z_1 = B(X_t)$.\n\nTo find the diffusion coefficient of $B(X_t)$, we apply Itô's lemma to the function $g(x) = B(x) = \\alpha \\exp(\\alpha x) b(x)$, with the process $X_t$ as its argument. First, we need the Itô SDE for $X_t$. The conversion from the given Stratonovich SDE $dX_t = a(X_t)\\,dt + b(X_t)\\,\\circ dW_t$ to its Itô form $dX_t = \\tilde{a}(X_t)\\,dt + b(X_t)\\,dW_t$ is given by the correction formula:\n$$\n\\tilde{a}(X_t) = a(X_t) + \\frac{1}{2} b(X_t) b'(X_t)\n$$\nwhere $b'(x) = \\frac{db}{dx}(x)$. So, the Itô SDE for $X_t$ is $dX_t = (a(X_t) + \\frac{1}{2}b(X_t)b'(X_t))dt + b(X_t)dW_t$.\n\nNow, applying Itô's lemma to $B(X_t) = g(X_t)$:\n$$\ndB(X_t) = dg(X_t) = \\left( g'(X_t)\\tilde{a}(X_t) + \\frac{1}{2}g''(X_t)b(X_t)^2 \\right) dt + g'(X_t)b(X_t)dW_t\n$$\nThe diffusion coefficient of $B(X_t)$ is the term multiplying $dW_t$, which is $\\sigma_{B(X)} = g'(X_t)b(X_t)$.\nWe compute $g'(x)$:\n$$\ng'(x) = \\frac{d}{dx} \\left( \\alpha \\exp(\\alpha x) b(x) \\right) = \\alpha \\left( \\alpha \\exp(\\alpha x) b(x) + \\exp(\\alpha x) b'(x) \\right) = \\alpha \\exp(\\alpha x) \\left( \\alpha b(x) + b'(x) \\right)\n$$\nThe quadratic covariation rate is then:\n$$\n\\frac{d\\langle B(X), W \\rangle_t}{dt} = \\sigma_{B(X)} \\cdot 1 = g'(X_t)b(X_t) = \\alpha \\exp(\\alpha X_t) \\left( \\alpha b(X_t) + b'(X_t) \\right) b(X_t)\n$$\n$$\n\\frac{d\\langle B(X), W \\rangle_t}{dt} = \\alpha \\exp(\\alpha X_t) \\left( \\alpha (b(X_t))^2 + b(X_t)b'(X_t) \\right)\n$$\nFinally, we assemble the Itô drift $\\mu_Y(X_t)$:\n$$\n\\mu_Y(X_t) = A(X_t) + \\frac{1}{2} \\frac{d\\langle B(X), W \\rangle_t}{dt}\n$$\n$$\n\\mu_Y(X_t) = \\alpha \\exp(\\alpha X_t) a(X_t) + \\frac{1}{2} \\left[ \\alpha \\exp(\\alpha X_t) \\left( \\alpha (b(X_t))^2 + b(X_t)b'(X_t) \\right) \\right]\n$$\n$$\n\\mu_Y(X_t) = \\alpha \\exp(\\alpha X_t) a(X_t) + \\frac{\\alpha^2}{2} \\exp(\\alpha X_t) (b(X_t))^2 + \\frac{\\alpha}{2} \\exp(\\alpha X_t) b(X_t)b'(X_t)\n$$\nFactoring out the common term $\\exp(\\alpha X_t)$, we obtain the final expression for the Itô drift coefficient of $Y_t$:\n$$\n\\mu_Y(X_t) = \\exp(\\alpha X_t) \\left( \\alpha a(X_t) + \\frac{\\alpha}{2} b(X_t)b'(X_t) + \\frac{\\alpha^2}{2} (b(X_t))^2 \\right)\n$$\nThis expression is in terms of $a$, $b$, its derivative $b'$, the constant $\\alpha$, and the state $X_t$, as required.", "answer": "$$\\boxed{\\exp(\\alpha X_t) \\left( \\alpha a(X_t) + \\frac{\\alpha}{2} b(X_t) b'(X_t) + \\frac{\\alpha^2 (b(X_t))^2}{2} \\right)}$$", "id": "3003904"}, {"introduction": "Moving from analytical derivation to computational practice, this exercise challenges you to implement and compare two fundamental methods for simulating Stratonovich SDEs. You will develop a direct midpoint scheme that numerically captures the symmetric nature of the Stratonovich integral, as well as a scheme based on converting the SDE to its Itô equivalent. This hands-on coding problem is essential for building intuition about how these theoretical constructs behave in practice and for numerically verifying the validity of the classical chain rule. [@problem_id:3003906]", "problem": "Consider a scalar Stratonovich stochastic differential equation (SDE) given by $dx_t = a(x_t,t)\\,dt + b(x_t,t)\\circ dW_t$, where $W_t$ is a standard Wiener process, $a(\\cdot,\\cdot)$ is a drift function, and $b(\\cdot,\\cdot)$ is a diffusion function. The Stratonovich integral is defined as the limit of symmetric Riemann sums, which in discrete time corresponds to midpoint evaluations. Starting from the fundamental base consisting of the definition of the Wiener process and the symmetric Riemann sum characterization of the Stratonovich integral, as well as the Itô integral and the notion of quadratic variation, implement two simulation strategies for the Stratonovich SDE:\n- A midpoint predictor-corrector (Heun-type) scheme consistent with the Stratonovich interpretation via half-step corrections.\n- A conversion of the Stratonovich SDE to an Itô SDE by adjusting the drift and then simulating via an explicit Euler scheme.\n\nAdditionally, numerically verify the Stratonovich chain rule for a smooth function $f$: when the dynamics are interpreted in the Stratonovich sense, a discretization based on midpoint Riemann sums should approximate $f(x_T) - f(x_0)$ by $\\sum_k f'(x_{t_{k+\\frac{1}{2}}})(x_{t_{k+1}}-x_{t_k})$, where $x_{t_{k+\\frac{1}{2}}}$ denotes the midpoint state. Use the same Brownian increments for both simulation strategies to enable direct comparison.\n\nYour program must:\n1. Implement the Stratonovich midpoint (Heun) scheme based on predictor-corrector steps that approximate the symmetric integral.\n2. Implement the Itô simulation of the drift-adjusted SDE resulting from converting the Stratonovich SDE to the Itô form using appropriate limits and quadratic variation, starting only from the foundational definitions and properties (do not use any pre-given shortcut formulas from the literature in the problem statement; derive what is needed in your solution).\n3. For each test case, compute two quantitative diagnostics:\n   - The mean absolute chain-rule error, defined as $\\mathbb{E}\\left[\\left|f(x_T) - f(x_0) - \\sum_{k=0}^{N-1} f'\\!\\left(\\frac{x_{t_{k+1}} + x_{t_k}}{2}\\right)\\left(x_{t_{k+1}} - x_{t_k}\\right)\\right|\\right]$ over all simulated paths.\n   - The mean absolute end-state difference between the Stratonovich midpoint scheme and the drift-adjusted Itô Euler scheme, defined as $\\mathbb{E}\\left[\\left|x_T^{\\text{Strat}} - x_T^{\\text{Itô}}\\right|\\right]$.\n4. Use a fixed random seed per test case to make results reproducible.\n\nTest Suite:\nProvide the following four test cases covering a general case, a nonlinear multiplicative case, a drift-only boundary case, and a coarse time-step case.\n\n- Test Case 1 (General multiplicative noise):\n  - $a(x) = \\alpha x$ with $\\alpha = 0.2$.\n  - $b(x) = \\beta x$ with $\\beta = 0.5$.\n  - $b'(x) = \\beta$.\n  - $f(x) = x^2$, $f'(x) = 2x$.\n  - Initial condition $x_0 = 1.0$.\n  - Time horizon $T = 1.0$.\n  - Number of steps $N = 2000$.\n  - Number of paths $M = 200$.\n  - Fixed seed $s = 12345$.\n\n- Test Case 2 (Nonlinear multiplicative noise):\n  - $a(x) = -0.1 x^3$.\n  - $b(x) = 0.6 x^2$.\n  - $b'(x) = 1.2 x$.\n  - $f(x) = x^3$, $f'(x) = 3x^2$.\n  - Initial condition $x_0 = 0.4$.\n  - Time horizon $T = 0.4$.\n  - Number of steps $N = 3000$.\n  - Number of paths $M = 150$.\n  - Fixed seed $s = 67890$.\n\n- Test Case 3 (Drift-only boundary case):\n  - $a(x) = \\sin(x)$.\n  - $b(x) = 0$.\n  - $b'(x) = 0$.\n  - $f(x) = \\cos(x)$, $f'(x) = -\\sin(x)$.\n  - Initial condition $x_0 = 0.7$.\n  - Time horizon $T = 1.0$.\n  - Number of steps $N = 2000$.\n  - Number of paths $M = 200$.\n  - Fixed seed $s = 13579$.\n\n- Test Case 4 (Coarse time-step variant of Test Case 1):\n  - $a(x) = \\alpha x$ with $\\alpha = 0.2$.\n  - $b(x) = \\beta x$ with $\\beta = 0.5$.\n  - $b'(x) = \\beta$.\n  - $f(x) = x^2$, $f'(x) = 2x$.\n  - Initial condition $x_0 = 1.0$.\n  - Time horizon $T = 1.0$.\n  - Number of steps $N = 200$.\n  - Number of paths $M = 200$.\n  - Fixed seed $s = 24680$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a pair of floats formatted in scientific notation with six digits after the decimal point, representing $[\\text{mean\\_chain\\_error},\\text{mean\\_method\\_diff}]$.\n- Concretely, the final output must have the form $[[e_1,d_1],[e_2,d_2],[e_3,d_3],[e_4,d_4]]$ with no spaces.\n\nNo physical units, angle units, or percentages are involved in this problem. All returned numerical results must be floats.", "solution": "The user-provided problem statement has been analyzed and validated. It is found to be scientifically grounded, well-posed, and objective. It presents a standard but non-trivial exercise in computational stochastic calculus, requiring the derivation of the relationship between Itô and Stratonovich integrals from foundational principles and the implementation of two distinct numerical schemes for solving stochastic differential equations (SDEs). The problem is valid, and a solution will be provided.\n\nThe core of the problem lies in the different interpretations of stochastic integrals. We are given a Stratonovich SDE:\n$$dx_t = a(x_t,t)\\,dt + b(x_t,t)\\circ dW_t$$\nwhere $\\circ dW_t$ denotes integration in the Stratonovich sense. The task is to simulate this SDE using two methods: one that directly approximates the Stratonovich integral and another that first converts the SDE to its equivalent Itô form.\n\n**1. Derivation of the Itô-Stratonovich Conversion**\n\nThe problem requires a derivation of the conversion formula from foundational principles. The Stratonovich integral is defined as the limit of symmetric Riemann sums. For a small time interval $[t_k, t_{k+1}]$, the integral is approximated as:\n$$\\int_{t_k}^{t_{k+1}} b(x_t) \\circ dW_t \\approx b\\left(\\frac{x_{t_k} + x_{t_{k+1}}}{2}\\right) (W_{t_{k+1}} - W_{t_k})$$\nThe Itô integral, in contrast, is defined using the left-point evaluation:\n$$\\int_{t_k}^{t_{k+1}} b(x_t) dW_t \\approx b(x_{t_k}) (W_{t_{k+1}} - W_{t_k})$$\nTo find the relationship, we expand the term $b\\left(\\frac{x_{t_k} + x_{t_{k+1}}}{2}\\right)$ in the Stratonovich sum. For brevity, let $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$ and $\\Delta x_k = x_{t_{k+1}} - x_{t_k}$. We also assume the functions $a$ and $b$ are sufficiently smooth and depend only on $x$ as per the test cases. A Taylor expansion of $b(x)$ around $x_{t_k}$ gives:\n$$b\\left(\\frac{x_{t_k} + x_{t_k} + \\Delta x_k}{2}\\right) = b\\left(x_{t_k} + \\frac{1}{2}\\Delta x_k\\right) \\approx b(x_{t_k}) + \\frac{1}{2}b'(x_{t_k})\\Delta x_k + O((\\Delta x_k)^2)$$\nThe increment $\\Delta x_k$ is given by the SDE itself. To first order, for a small time step $\\Delta t = t_{k+1} - t_k$, the dominant term is the stochastic one:\n$$\\Delta x_k = a(x_{t_k})\\Delta t + b(x_{t_k})\\Delta W_k \\approx b(x_{t_k})\\Delta W_k$$\nSubstituting this approximation for $\\Delta x_k$ into the Taylor expansion:\n$$b\\left(\\frac{x_{t_k} + x_{t_{k+1}}}{2}\\right) \\approx b(x_{t_k}) + \\frac{1}{2}b'(x_{t_k})b(x_{t_k})\\Delta W_k$$\nNow, substitute this back into the Stratonovich integral approximation:\n$$b\\left(\\frac{x_{t_k} + x_{t_{k+1}}}{2}\\right) \\Delta W_k \\approx \\left( b(x_{t_k}) + \\frac{1}{2}b'(x_{t_k})b(x_{t_k})\\Delta W_k \\right) \\Delta W_k$$\n$$= b(x_{t_k})\\Delta W_k + \\frac{1}{2}b'(x_{t_k})b(x_{t_k})(\\Delta W_k)^2$$\nSumming over all intervals and taking the limit as $\\Delta t \\to 0$, the first term $\\sum b(x_{t_k})\\Delta W_k$ converges to the Itô integral $\\int b(x_t) dW_t$. The second term involves the quadratic variation of the Wiener process. A fundamental property of Itô calculus is that, in the limit, $(\\Delta W_k)^2$ behaves like $\\Delta t$. In differential notation, $(dW_t)^2 = dt$. Therefore, the sum $\\sum \\frac{1}{2}b'(x_{t_k})b(x_{t_k})(\\Delta W_k)^2$ converges to the ordinary Riemann integral $\\int \\frac{1}{2}b'(x_t)b(x_t)dt$.\n\nThis yields the conversion rule in differential form:\n$$b(x_t)\\circ dW_t = b(x_t)dW_t + \\frac{1}{2}b(x_t)b'(x_t)dt$$\nSubstituting this into the original Stratonovich SDE gives the equivalent Itô SDE:\n$$dx_t = a(x_t)dt + \\left(b(x_t)dW_t + \\frac{1}{2}b(x_t)b'(x_t)dt\\right)$$\n$$dx_t = \\left(a(x_t) + \\frac{1}{2}b(x_t)b'(x_t)\\right)dt + b(x_t)dW_t$$\nThe new drift term is $\\tilde{a}(x_t) = a(x_t) + \\frac{1}{2}b(x_t)b'(x_t)$. This derived form will be used for the second simulation strategy.\n\n**2. Simulation Strategy 1: Stratonovich Midpoint (Heun) Scheme**\n\nThis method directly approximates the symmetric nature of the Stratonovich integral. It is a predictor-corrector scheme. Given the state $x_k$ at time $t_k$:\n1.  **Predictor Step**: Compute a first-order approximation of the state at time $t_{k+1}$, denoted $\\bar{x}_{k+1}$, using an explicit Euler step.\n    $$\\bar{x}_{k+1} = x_k + a(x_k)\\Delta t + b(x_k)\\Delta W_k$$\n2.  **Corrector Step**: Use the predictor $\\bar{x}_{k+1}$ to form an average of the drift and diffusion coefficients at the start and (predicted) end of the interval. This approximates the evaluation at the midpoint.\n    $$x_{k+1} = x_k + \\frac{1}{2}\\left(a(x_k) + a(\\bar{x}_{k+1})\\right)\\Delta t + \\frac{1}{2}\\left(b(x_k) + b(\\bar{x}_{k+1})\\right)\\Delta W_k$$\nThis scheme has a strong order of convergence of $1.0$ for Stratonovich SDEs with commutative noise, which holds for the scalar case.\n\n**3. Simulation Strategy 2: Euler-Maruyama on Converted Itô SDE**\n\nThis strategy uses the drift-adjusted Itô SDE derived above:\n$$dx_t = \\tilde{a}(x_t)dt + b(x_t)dW_t$$\nwhere $\\tilde{a}(x_t) = a(x_t) + \\frac{1}{2}b(x_t)b'(x_t)$. We can now apply the standard Euler-Maruyama scheme, which is the simplest numerical method for Itô SDEs:\n$$x_{k+1} = x_k + \\tilde{a}(x_k)\\Delta t + b(x_k)\\Delta W_k$$\nThis scheme generally has a strong order of convergence of $0.5$. However, by incorporating the correction term, the combination of conversion and Euler-Maruyama effectively simulates the Stratonovich process to a comparable order of accuracy as the Heun scheme. Both schemes are expected to yield similar results, and the difference between them is one of the diagnostics to be computed.\n\n**4. Numerical Verification of Stratonovich Chain Rule**\n\nFor a sufficiently smooth function $f(x)$, the chain rule for a process $x_t$ governed by a Stratonovich SDE is the same as in ordinary calculus:\n$$df(x_t) = f'(x_t) \\circ dx_t$$\nIntegrating this from $t=0$ to $t=T$ gives:\n$$f(x_T) - f(x_0) = \\int_0^T f'(x_t) \\circ dx_t$$\nThe problem asks to verify this numerically by approximating the integral with a symmetric Riemann sum. Using the simulated path $\\{x_{t_k}\\}_{k=0}^N$ from the Stratonovich-Heun scheme, the integral is approximated as:\n$$\\int_0^T f'(x_t) \\circ dx_t \\approx \\sum_{k=0}^{N-1} f'\\left(\\frac{x_{t_k} + x_{t_{k+1}}}{2}\\right)(x_{t_{k+1}} - x_{t_k})$$\nThe error in this approximation for a single path is:\n$$\\text{error} = \\left| f(x_T) - f(x_0) - \\sum_{k=0}^{N-1} f'\\left(\\frac{x_{t_{k}} + x_{t_{k+1}}}{2}\\right)(x_{t_{k+1}} - x_{t_k}) \\right|$$\nThe implementation will compute the mean of this error over all simulated paths. This error is expected to be small, reflecting the consistency between the Stratonovich integral's definition and the classical chain rule.\n\nThe implementation will proceed by generating a set of Wiener increments for all paths and steps. These same increments will be used for both the Heun scheme and the drift-adjusted Euler-Maruyama scheme to ensure a fair comparison. The two required diagnostics—mean absolute chain-rule error and mean absolute end-state difference—will then be computed from the simulated trajectories.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the stochastic differential equation problem by implementing and\n    comparing two simulation schemes (Stratonovich-Heun and Itô-Euler-Maruyama)\n    and verifying the Stratonovich chain rule.\n    \"\"\"\n    test_cases = [\n        {\n            \"a\": lambda x, alpha=0.2: alpha * x,\n            \"b\": lambda x, beta=0.5: beta * x,\n            \"b_prime\": lambda x, beta=0.5: beta * np.ones_like(x), # Note b'(x) is constant\n            \"f\": lambda x: x**2,\n            \"f_prime\": lambda x: 2 * x,\n            \"x0\": 1.0,\n            \"T\": 1.0,\n            \"N\": 2000,\n            \"M\": 200,\n            \"seed\": 12345,\n        },\n        {\n            \"a\": lambda x: -0.1 * x**3,\n            \"b\": lambda x: 0.6 * x**2,\n            \"b_prime\": lambda x: 1.2 * x,\n            \"f\": lambda x: x**3,\n            \"f_prime\": lambda x: 3 * x**2,\n            \"x0\": 0.4,\n            \"T\": 0.4,\n            \"N\": 3000,\n            \"M\": 150,\n            \"seed\": 67890,\n        },\n        {\n            \"a\": lambda x: np.sin(x),\n            \"b\": lambda x: np.zeros_like(x),\n            \"b_prime\": lambda x: np.zeros_like(x),\n            \"f\": lambda x: np.cos(x),\n            \"f_prime\": lambda x: -np.sin(x),\n            \"x0\": 0.7,\n            \"T\": 1.0,\n            \"N\": 2000,\n            \"M\": 200,\n            \"seed\": 13579,\n        },\n        {\n            \"a\": lambda x, alpha=0.2: alpha * x,\n            \"b\": lambda x, beta=0.5: beta * x,\n            \"b_prime\": lambda x, beta=0.5: beta * np.ones_like(x),\n            \"f\": lambda x: x**2,\n            \"f_prime\": lambda x: 2 * x,\n            \"x0\": 1.0,\n            \"T\": 1.0,\n            \"N\": 200,\n            \"M\": 200,\n            \"seed\": 24680,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Extract parameters for the current test case\n        a_func = case[\"a\"]\n        b_func = case[\"b\"]\n        b_prime_func = case[\"b_prime\"]\n        f_func = case[\"f\"]\n        f_prime_func = case[\"f_prime\"]\n        x0 = case[\"x0\"]\n        T = case[\"T\"]\n        N = case[\"N\"]\n        M = case[\"M\"]\n        seed = case[\"seed\"]\n\n        dt = T / N\n        rng = np.random.default_rng(seed)\n        dW = rng.normal(0, np.sqrt(dt), size=(M, N))\n\n        # --- Scheme 1: Stratonovich Midpoint (Heun) Scheme ---\n        x_strat_traj = np.zeros((M, N + 1))\n        x_strat_traj[:, 0] = x0\n        \n        for k in range(N):\n            x_k = x_strat_traj[:, k]\n            dW_k = dW[:, k]\n            \n            # Predictor step\n            x_pred = x_k + a_func(x_k) * dt + b_func(x_k) * dW_k\n            \n            # Corrector step\n            a_avg = 0.5 * (a_func(x_k) + a_func(x_pred))\n            b_avg = 0.5 * (b_func(x_k) + b_func(x_pred))\n            x_kp1 = x_k + a_avg * dt + b_avg * dW_k\n            \n            x_strat_traj[:, k + 1] = x_kp1\n        \n        x_T_strat = x_strat_traj[:, -1]\n\n        # --- Diagnostic 1: Mean Absolute Chain-Rule Error ---\n        x_k_traj = x_strat_traj[:, :-1]\n        x_kp1_traj = x_strat_traj[:, 1:]\n        \n        increments = x_kp1_traj - x_k_traj\n        midpoints = 0.5 * (x_k_traj + x_kp1_traj)\n        \n        f_prime_midpoints = f_prime_func(midpoints)\n        integral_sum = np.sum(f_prime_midpoints * increments, axis=1)\n        \n        chain_rule_lhs = f_func(x_T_strat) - f_func(x_strat_traj[:, 0])\n        chain_errors = np.abs(chain_rule_lhs - integral_sum)\n        mean_chain_error = np.mean(chain_errors)\n\n        # --- Scheme 2: Euler-Maruyama on Drift-Adjusted Itô SDE ---\n        def a_tilde_func(x):\n            return a_func(x) + 0.5 * b_func(x) * b_prime_func(x)\n\n        x_ito = np.full(M, x0)\n\n        for k in range(N):\n            dW_k = dW[:, k]\n            x_ito = x_ito + a_tilde_func(x_ito) * dt + b_func(x_ito) * dW_k\n            \n        x_T_ito = x_ito\n\n        # --- Diagnostic 2: Mean Absolute End-State Difference ---\n        method_diffs = np.abs(x_T_strat - x_T_ito)\n        mean_method_diff = np.mean(method_diffs)\n        \n        results.append([mean_chain_error, mean_method_diff])\n\n    # Format the final output string exactly as specified\n    formatted_pairs = [f\"[{e:.6e},{d:.6e}]\" for e, d in results]\n    final_output = f\"[{','.join(formatted_pairs)}]\"\n\n    print(final_output)\n\nsolve()\n```", "id": "3003906"}, {"introduction": "This final practice reveals a powerful strategic advantage of the Stratonovich formalism: its ability to simplify problems through transformation. You will investigate a geometric Brownian motion process, which is non-linear, and apply a logarithmic transformation that, thanks to the classical form of the Stratonovich chain rule, results in a simple linear SDE. By comparing the accuracy of simulating the original SDE directly versus simulating the transformed linear SDE, you will gain a deep appreciation for how the chain rule can be used not just for analysis, but as a potent tool for designing more accurate and efficient numerical solutions. [@problem_id:3003926]", "problem": "Consider the Stratonovich stochastic differential equation (SDE) $dX_t = \\alpha X_t \\, dt + \\beta X_t \\circ dW_t$ on the interval $t \\in [0,T]$ with $X_0 \\in (0,\\infty)$, where $\\alpha \\in \\mathbb{R}$ and $\\beta \\in \\mathbb{R}$ are constants, and $W_t$ denotes a Wiener process (Brownian motion). Let $f:(0,\\infty) \\to \\mathbb{R}$ be given by $f(x) = \\log x$, and define $Y_t = f(X_t)$. You must design a numerical experiment that compares two schemes on the same discrete time grid and the same Brownian path:\n\n- Scheme A: Integrate the original equation for $X_t$ directly using a midpoint method consistent with Stratonovich integration on a uniform grid with step size $\\Delta t$.\n- Scheme B: Transform to $Y_t = f(X_t)$ first, integrate the transformed equation for $Y_t$ on the same grid, and then reconstruct $X_t$ by applying $f^{-1}$ pointwise.\n\nYour task is to:\n1. Starting from the symmetric Riemann-sum definition of the Stratonovich integral, and without invoking any pre-stated chain rule formulas, derive the evolution equation satisfied by $Y_t$ in terms of $\\alpha$, $\\beta$, $X_t$, and $f$.\n2. Use the derived evolution to explain, from first principles, why transforming to $Y_t = f(X_t)$ before integrating can improve strong pathwise accuracy for this class of SDEs.\n3. Implement a program that, for each test case described below, computes the maximum absolute pathwise error on the grid for both Scheme A and Scheme B relative to the exact solution, and returns a boolean indicating whether Scheme B has strictly smaller error than Scheme A (that is, whether $\\max_n |X^{B}_{t_n} - X^{\\text{exact}}_{t_n}|  \\max_n |X^{A}_{t_n} - X^{\\text{exact}}_{t_n}|$). The Brownian motion must be simulated by independent Gaussian increments with variance $\\Delta t$, and a fixed pseudo-random seed must be used per test case to ensure reproducibility.\n\nFundamental base for derivation: Use only the definition of the Stratonovich integral as the limit of symmetric Riemann sums, Taylor expansions for $C^2$ functions, properties of quadratic variation of Brownian motion, and the classical chain rule from ordinary calculus. Do not use any pre-stated stochastic chain rule or conversion formulas as shortcuts.\n\nTest suite parameter values:\n- Case $1$: $\\alpha = 0.3$, $\\beta = 0.7$, $X_0 = 1.25$, $T = 1.0$, $N = 80$ time steps, seed $123$.\n- Case $2$: $\\alpha = 0.0$, $\\beta = 0.0$, $X_0 = 1.0$, $T = 1.0$, $N = 10$ time steps, seed $7$.\n- Case $3$: $\\alpha = -0.5$, $\\beta = 2.0$, $X_0 = 0.75$, $T = 1.0$, $N = 8$ time steps, seed $999$.\n- Case $4$: $\\alpha = 0.2$, $\\beta = 0.1$, $X_0 = 3.0$, $T = 2.0$, $N = 1000$ time steps, seed $2024$.\n\nFor each case, use a uniform grid $t_n = n \\Delta t$ with $\\Delta t = T/N$, and simulate $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ independently. The midpoint method for Scheme A must evaluate coefficients at the numerical midpoint defined by $X_{n}^{\\text{mid}} = X_n + \\frac{1}{2} a(X_n) \\Delta t + \\frac{1}{2} b(X_n) \\Delta W_n$, where $a(x) = \\alpha x$ and $b(x) = \\beta x$, followed by $X_{n+1} = X_n + a(X_{n}^{\\text{mid}})\\Delta t + b(X_{n}^{\\text{mid}})\\Delta W_n$. Scheme B must first compute $Y_{n+1}$ on the same grid and increments and then set $X_{n+1} = \\exp(Y_{n+1})$.\n\nExact reference solution: Derive the exact expression for $X_t$ by solving the transformed equation analytically, and use it to compute the pathwise error at the grid points.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a boolean for Case $i$ indicating whether transforming before integrating (Scheme B) yields strictly smaller maximum absolute pathwise error than integrating directly (Scheme A). No physical units are involved, and no angle units are needed. Express all boolean outputs as either $True$ or $False$ exactly, without additional text.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and complete. It describes a standard problem in stochastic calculus and numerical analysis, providing all necessary definitions, constants, and parameters for a unique and meaningful solution. The problem is valid.\n\n### 1. Derivation of the SDE for $Y_t$\n\nThe problem requires the derivation of the evolution equation for $Y_t = f(X_t)$ where $f(x) = \\log x$, starting from the Stratonovich SDE $dX_t = \\alpha X_t \\, dt + \\beta X_t \\circ dW_t$. The derivation must be based on first principles, specifically the symmetric Riemann-sum definition of the Stratonovich integral, and must not use pre-stated stochastic chain rules.\n\nThe Stratonovich chain rule states that for a process $Y_t = f(X_t)$, the differential is given by $dY_t = f'(X_t) \\circ dX_t$, which takes the same form as the classical chain rule. We will demonstrate this from the definition of the integral. The change in $Y_t$ over an interval $[0, T]$ is given by $Y_T - Y_0 = \\int_0^T dY_t$. We can express this as a limit of a sum over a partition $0 = t_0  t_1  \\dots  t_N = T$:\n$$Y_T - Y_0 = \\lim_{N\\to\\infty} \\sum_{i=0}^{N-1} (Y_{t_{i+1}} - Y_{t_i}) = \\lim_{N\\to\\infty} \\sum_{i=0}^{N-1} (f(X_{t_{i+1}}) - f(X_{t_i}))$$\nLet $\\tau_i = (t_i + t_{i+1})/2$ be the midpoint of the time interval $[t_i, t_{i+1}]$. We perform a Taylor expansion of $f(X_{t_{i+1}})$ and $f(X_{t_i})$ around the process value at the midpoint, $X_{\\tau_i}$. For a $C^2$ function $f$, we have:\n$$f(X_{t_{i+1}}) = f(X_{\\tau_i}) + f'(X_{\\tau_i})(X_{t_{i+1}} - X_{\\tau_i}) + \\frac{1}{2}f''(X_{\\tau_i})(X_{t_{i+1}} - X_{\\tau_i})^2 + O(|\\Delta t_i|^{3/2})$$\n$$f(X_{t_i}) = f(X_{\\tau_i}) + f'(X_{\\tau_i})(X_{t_i} - X_{\\tau_i}) + \\frac{1}{2}f''(X_{\\tau_i})(X_{t_i} - X_{\\tau_i})^2 + O(|\\Delta t_i|^{3/2})$$\nSubtracting the second equation from the first gives the increment $\\Delta Y_i = Y_{t_{i+1}} - Y_{t_i}$:\n$$\\Delta Y_i = f'(X_{\\tau_i})(X_{t_{i+1}} - X_{t_i}) + \\frac{1}{2}f''(X_{\\tau_i})\\left[(X_{t_{i+1}} - X_{\\tau_i})^2 - (X_{t_i} - X_{\\tau_i})^2\\right] + \\dots$$\nLet's analyze the terms. The first term, when summed, is $\\sum_{i=0}^{N-1} f'(X_{\\tau_i})(X_{t_{i+1}} - X_{t_i})$. The Stratonovich integral $\\int_0^T G(X_t) \\circ dX_t$ is defined as the limit of such sums. Therefore, this term converges to $\\int_0^T f'(X_t) \\circ dX_t$.\n\nThe second term involves the difference of squared increments of $X_t$ over symmetric half-intervals. To leading order, the increment of $X_t$ is driven by the Brownian motion: $X_s - X_r \\approx \\beta X_r (W_s - W_r)$. The term becomes approximately $\\frac{1}{2}f''(X_{\\tau_i}) \\beta^2 X_{\\tau_i}^2 [(W_{t_{i+1}}-W_{\\tau_i})^2 - (W_{\\tau_i}-W_{t_i})^2]$. The increments $(W_{t_{i+1}}-W_{\\tau_i})$ and $(W_{\\tau_i}-W_{t_i})$ are independent random variables, each with variance $\\Delta t_i / 2$. The expectation of the term in brackets is $E[(\\dots)^2 - (\\dots)^2] = \\Delta t_i / 2 - \\Delta t_i / 2 = 0$. In the limit of a fine partition, the sum of these terms converges to zero.\n\nThus, the change in $Y_t$ is determined solely by the first term, leading to the differential form:\n$$dY_t = f'(X_t) \\circ dX_t$$\nThis confirms that the classical chain rule applies to Stratonovich calculus. Now we substitute the given SDE for $dX_t$:\n$$dY_t = f'(X_t) \\circ ( \\alpha X_t \\, dt + \\beta X_t \\circ dW_t )$$\nUsing the composition properties of the Stratonovich integral, this becomes:\n$$dY_t = f'(X_t) \\alpha X_t \\, dt + f'(X_t) \\beta X_t \\circ dW_t$$\nFor the specific function $f(x) = \\log x$, we have $f'(x) = 1/x$. Substituting this into the equation:\n$$dY_t = \\frac{1}{X_t} (\\alpha X_t) \\, dt + \\frac{1}{X_t} (\\beta X_t) \\circ dW_t$$\n$$dY_t = \\alpha \\, dt + \\beta \\circ dW_t$$\nSince the coefficients $\\alpha$ and $\\beta$ are constants, the Stratonovich and Itô forms of this SDE are identical. Thus, the evolution equation for $Y_t$ is:\n$$dY_t = \\alpha \\, dt + \\beta \\, dW_t$$\n\n### 2. Analysis of Numerical Schemes and Accuracy\n\nThe derived SDE for $Y_t$ is an arithmetic Brownian motion with constant drift $\\alpha$ and constant diffusion $\\beta$. This is a significant simplification over the original SDE for $X_t$, which is a geometric Brownian motion with multiplicative noise (state-dependent coefficients).\n\n**Scheme A** directly integrates the original non-linear SDE for $X_t$:\n$$dX_t = \\alpha X_t \\, dt + \\beta X_t \\circ dW_t$$\nThe specified midpoint method is a general-purpose numerical scheme for Stratonovich SDEs. Although it is a relatively accurate scheme (strong order $1.0$), it introduces truncation error at each step because it approximates the continuous dynamics. The coefficients $a(x) = \\alpha x$ and $b(x) = \\beta x$ are evaluated at a numerically approximated midpoint $X_{n}^{\\text{mid}}$, not the true midpoint, leading to pathwise deviations from the exact solution.\n\n**Scheme B** first transforms the problem into the $Y_t$ variable space. The SDE for $Y_t$ is:\n$$dY_t = \\alpha \\, dt + \\beta \\, dW_t$$\nThis SDE with constant coefficients can be integrated exactly. The solution is $Y_t = Y_0 + \\alpha t + \\beta W_t$. A discrete-time numerical scheme for this equation is the Euler-Maruyama method:\n$$Y_{n+1} = Y_n + \\alpha \\Delta t + \\beta \\Delta W_n$$\nGiven a simulated discrete Brownian path with increments $\\Delta W_n$, this update rule does not approximate the solution for $Y_{t_{n+1}}$; it *is* the exact solution on that path. By induction, $Y_n = Y_0 + \\alpha t_n + \\beta \\sum_{i=0}^{n-1} \\Delta W_i = Y_{t_n}^{\\text{exact}}$.\nThe final step of Scheme B is to transform back: $X^B_n = f^{-1}(Y_n) = \\exp(Y_n)$. Since $Y_n$ is the exact value of the transformed process at time $t_n$ for the given Brownian path, $X^B_n$ is the exact value of the original process $X_{t_n}$.\n$$X_n^B = \\exp(Y_{t_n}^{\\text{exact}}) = \\exp(\\log(X_{t_n}^{\\text{exact}})) = X_{t_n}^{\\text{exact}}$$\nTherefore, Scheme B produces a solution with an error that is zero up to machine floating-point precision. Scheme A, being a general approximation, will have a non-zero error. Consequently, for any case where the SDE is non-trivial (i.e., $\\alpha$ or $\\beta$ are non-zero), Scheme B is expected to have a strictly smaller pathwise error. If $\\alpha=0$ and $\\beta=0$, both schemes are exact and will have zero error, so the \"strictly smaller\" condition will be false.\n\n### 3. Exact Solution for $X_t$\nFrom the SDE for $Y_t$, we integrate from $0$ to $t$:\n$$Y_t - Y_0 = \\int_0^t \\alpha \\, ds + \\int_0^t \\beta \\, dW_s = \\alpha t + \\beta W_t$$\nSubstituting $Y_t = \\log X_t$ and $Y_0 = \\log X_0$:\n$$\\log X_t = \\log X_0 + \\alpha t + \\beta W_t$$\nExponentiating both sides gives the exact solution for $X_t$:\n$$X_t = \\exp(\\log X_0 + \\alpha t + \\beta W_t) = X_0 \\exp(\\alpha t + \\beta W_t)$$\nThis formula is used to generate the reference solution path for error calculations in the numerical experiment.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a numerical experiment comparing two integration schemes for a Stratonovich SDE.\n    \"\"\"\n    test_cases = [\n        # (alpha, beta, X0, T, N, seed)\n        (0.3, 0.7, 1.25, 1.0, 80, 123),\n        (0.0, 0.0, 1.0, 1.0, 10, 7),\n        (-0.5, 2.0, 0.75, 1.0, 8, 999),\n        (0.2, 0.1, 3.0, 2.0, 1000, 2024),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        alpha, beta, X0, T, N, seed = case\n        \n        # Setup grid and Brownian motion\n        dt = T / N\n        rng = np.random.default_rng(seed)\n        # Generate N increments for N steps\n        delta_W = rng.normal(loc=0.0, scale=np.sqrt(dt), size=N)\n        \n        # Path arrays will have N+1 points (t=0 to t=T)\n        t = np.linspace(0, T, N + 1)\n        W = np.concatenate(([0], np.cumsum(delta_W)))\n        \n        # 1. Calculate Exact Solution\n        X_exact = X0 * np.exp(alpha * t + beta * W)\n        \n        # 2. Scheme A: Direct midpoint integration of X_t\n        X_A = np.zeros(N + 1)\n        X_A[0] = X0\n        a = lambda x: alpha * x\n        b = lambda x: beta * x\n        \n        for n in range(N):\n            Xn = X_A[n]\n            dWn = delta_W[n]\n            \n            # As per problem, evaluate coefficients at a numerical midpoint\n            X_mid = Xn + 0.5 * a(Xn) * dt + 0.5 * b(Xn) * dWn\n            X_A[n + 1] = Xn + a(X_mid) * dt + b(X_mid) * dWn\n\n        # 3. Scheme B: Integrate Y_t = log(X_t), then transform back\n        Y_B = np.zeros(N + 1)\n        Y_B[0] = np.log(X0)\n        \n        for n in range(N):\n            Yn = Y_B[n]\n            dWn = delta_W[n]\n            \n            # This is the exact update rule for the transformed SDE\n            Y_B[n + 1] = Yn + alpha * dt + beta * dWn\n            \n        X_B = np.exp(Y_B)\n        \n        # 4. Compare maximum absolute pathwise errors\n        error_A = np.max(np.abs(X_A - X_exact))\n        error_B = np.max(np.abs(X_B - X_exact))\n        \n        results.append(error_B  error_A)\n        \n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3003926"}]}