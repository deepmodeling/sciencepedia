{"hands_on_practices": [{"introduction": "We begin our hands-on exploration with a classic, analytically solvable case: the Pöschl–Teller potential [@problem_id:2448895]. You will use a one-parameter trial wavefunction, $\\psi_{a}(x) = \\mathcal{N}\\,\\mathrm{sech}^{\\,a}(x)$, to find the value of the parameter $a$ that minimizes the energy expectation value. This exercise is particularly insightful as it demonstrates how the variational method, with a well-chosen family of functions, can converge upon the exact ground-state energy, providing a powerful confirmation of the principle's validity.", "problem": "Consider a one-dimensional nonrelativistic quantum particle of mass $m$ governed by the Hamiltonian\n$$\n\\hat{H} \\;=\\; -\\frac{1}{2}\\,\\frac{d^{2}}{dx^{2}} \\;+\\; V(x),\n$$\nin units where the reduced Planck constant $\\hbar$ equals $1$ and the mass $m$ equals $1$. The potential is the Pöschl–Teller potential\n$$\nV(x) \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2\\,\\cosh^{2}(x)},\n$$\nwith real parameter $\\lambda > 1$. Using the variational method with the normalized trial wavefunction\n$$\n\\psi_{a}(x) \\;=\\; \\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x),\n$$\nwhere $a>0$ is a real variational parameter and $\\mathcal{N}(a)$ is the normalization constant, evaluate the variational energy $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ and minimize it with respect to $a$ to obtain the tightest upper bound $E_{\\mathrm{var}}(\\lambda)$ for the ground-state energy.\n\nProvide your final answer as a single exact analytic expression in terms of $\\lambda$. Do not provide an inequality. No numerical rounding is required, and no units should be included beyond the specified choice $\\hbar=1$ and $m=1$.", "solution": "The variational principle states that for any normalized trial wavefunction $\\psi_{a}(x)$, the expectation value $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ satisfies $E(a)\\ge E_{0}$, where $E_{0}$ is the true ground-state energy. We are given the trial family $\\psi_{a}(x)=\\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x)$ with $a>0$. We first compute the normalization factor and then the expectation values of the kinetic and potential energies.\n\nNormalization requires\n$$\n1 \\;=\\; \\int_{-\\infty}^{\\infty} |\\psi_{a}(x)|^{2}\\,dx \\;=\\; |\\mathcal{N}(a)|^{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\nDefine\n$$\nI_{0}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\nA standard integral gives, for $\\mu>0$,\n$$\n\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,\\mu}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma\\!\\left(\\frac{\\mu}{2}\\right)}{\\Gamma\\!\\left(\\frac{1+\\mu}{2}\\right)}.\n$$\nSetting $\\mu=2a$ yields\n$$\nI_{0}(a) \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a)}{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}.\n$$\nThus $|\\mathcal{N}(a)|^{2}=1/I_{0}(a)$.\n\nNext, compute the kinetic energy expectation value. For real $\\psi_{a}$ and in the given units,\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\left(\\frac{d\\psi_{a}}{dx}\\right)^{2}dx.\n$$\nDifferentiate $\\psi_{a}(x)$:\n$$\n\\frac{d}{dx}\\left[\\mathrm{sech}^{\\,a}(x)\\right] \\;=\\; -a\\,\\tanh(x)\\,\\mathrm{sech}^{\\,a}(x),\n$$\nso\n$$\n\\frac{d\\psi_{a}}{dx} \\;=\\; -a\\,\\tanh(x)\\,\\psi_{a}(x),\n$$\nand therefore\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx.\n$$\nIntroduce\n$$\nI_{1}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,\\mathrm{sech}^{\\,2a}(x)\\,dx,\\qquad\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx.\n$$\nUsing $\\tanh^{2}(x)=1-\\mathrm{sech}^{2}(x)$, we have $I_{1}(a)=I_{0}(a)-I_{2}(a)$. With normalization, the kinetic expectation becomes\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{I_{1}(a)}{I_{0}(a)} \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-\\frac{I_{2}(a)}{I_{0}(a)}\\right].\n$$\n\nThe potential energy expectation is\n$$\n\\langle V\\rangle \\;=\\; \\int_{-\\infty}^{\\infty}|\\psi_{a}(x)|^{2}V(x)\\,dx \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx\n\\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{I_{2}(a)}{I_{0}(a)}.\n$$\n\nWe now evaluate the ratio $r(a)=I_{2}(a)/I_{0}(a)$. Using the same standard integral,\n$$\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a+1)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)}.\n$$\nTherefore,\n$$\nr(a) \\;=\\; \\frac{I_{2}(a)}{I_{0}(a)} \\;=\\; \\frac{\\Gamma(a+1)}{\\Gamma(a)}\\cdot \\frac{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)} \\;=\\; \\frac{a}{a+\\frac{1}{2}} \\;=\\; \\frac{2a}{2a+1}.\n$$\n\nCollecting terms, the variational energy is\n$$\nE(a)\\;=\\;\\langle T\\rangle+\\langle V\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-r(a)\\right] \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,r(a).\n$$\nWith $r(a)=\\frac{2a}{2a+1}$ and $1-r(a)=\\frac{1}{2a+1}$, this simplifies to\n$$\nE(a) \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{1}{2a+1} \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{2a}{2a+1}\n\\;=\\; \\frac{\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a}{2a+1}.\n$$\n\nTo minimize $E(a)$ with respect to $a>0$, compute the derivative and set it to zero. Write $E(a)=N(a)/D(a)$ with $N(a)=\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a$ and $D(a)=2a+1$. Then\n$$\n\\frac{dE}{da} \\;=\\; \\frac{N'(a)D(a)-N(a)D'(a)}{[D(a)]^{2}} \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\; N'(a)D(a)-N(a)D'(a)=0.\n$$\nEvaluate\n$$\nN'(a)=a-\\lambda(\\lambda-1),\\qquad D'(a)=2,\n$$\nso\n$$\n\\left[a-\\lambda(\\lambda-1)\\right](2a+1) - 2\\left(\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a\\right)=0.\n$$\nExpanding and simplifying gives\n$$\na^{2}+a-\\lambda(\\lambda-1)=0.\n$$\nSolving the quadratic for $a$,\n$$\na \\;=\\; \\frac{-1+\\sqrt{1+4\\lambda(\\lambda-1)}}{2}.\n$$\nSince $\\lambda > 1$, we have $\\sqrt{1+4\\lambda(\\lambda-1)}=\\sqrt{(2\\lambda-1)^{2}}=2\\lambda-1$, hence\n$$\na_{\\star} \\;=\\; \\lambda-1 > 0.\n$$\n\nSubstitute $a_{\\star}$ into $E(a)$:\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; E(\\lambda-1) \\;=\\; \\frac{\\frac{1}{2}(\\lambda-1)^{2}-\\lambda(\\lambda-1)(\\lambda-1)}{2(\\lambda-1)+1}\n\\;=\\; \\frac{(\\lambda-1)^{2}\\left(\\frac{1}{2}-\\lambda\\right)}{2\\lambda-1}.\n$$\nNoting that $2\\lambda-1=2\\left(\\lambda-\\frac{1}{2}\\right)$, we obtain\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$\n\nThus the variational method with the given trial family yields the exact closed-form upper bound\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$", "answer": "$$\\boxed{-\\frac{(\\lambda-1)^{2}}{2}}$$", "id": "2448895"}, {"introduction": "Building on the basics, this problem [@problem_id:2448862] challenges you to move from optimizing a given function to constructing one from scratch for a particle in a two-dimensional triangular well. The primary task is to devise a trial wavefunction that respects the system's geometry, boundary conditions, and symmetries. This practice develops a crucial skill in applying the variational method: the art of choosing an appropriate and effective trial function for complex, non-separable systems.", "problem": "A spinless nonrelativistic particle of mass $m$ is confined to a two-dimensional domain by an infinite potential well of triangular shape. The potential $V(x,y)$ is defined by $V(x,y)=0$ for $(x,y)$ in the domain $\\mathcal{D}=\\{(x,y)\\,|\\,x\\ge 0,\\;y\\ge 0,\\;x+y\\le L\\}$ and $V(x,y)=+\\infty$ elsewhere. The time-independent Schrödinger equation inside $\\mathcal{D}$ is $-\\frac{\\hbar^{2}}{2m}\\nabla^{2}\\psi(x,y)=E\\,\\psi(x,y)$, with Dirichlet boundary condition $\\psi=0$ on the three edges of the triangle.\n\nUsing the variational principle, construct a real trial wavefunction $\\psi_{\\text{trial}}(x,y)$ that:\n- is normalizable on $\\mathcal{D}$,\n- is positive in the interior of $\\mathcal{D}$ (nodeless),\n- vanishes on each of the three edges of the triangle,\n- is symmetric under exchange $x\\leftrightarrow y$,\n- and has minimal total polynomial degree under these constraints.\n\nThen, using only fundamental principles (the time-independent Schrödinger equation and the variational principle), derive an explicit analytic expression for the corresponding variational upper bound to the ground-state energy,\n$$E_{\\text{var}}=\\frac{\\langle \\psi_{\\text{trial}}|H|\\psi_{\\text{trial}}\\rangle}{\\langle \\psi_{\\text{trial}}|\\psi_{\\text{trial}}\\rangle},$$\nwhere $H=-\\frac{\\hbar^{2}}{2m}\\nabla^{2}+V(x,y)$. Your derivation should justify any integration by parts and boundary term treatments.\n\nExpress your final answer as a closed-form analytic expression in terms of $\\hbar$, $m$, and $L$ (no numerical approximation or units required).", "solution": "First, we construct the trial wavefunction $\\psi_{\\text{trial}}(x,y)$ that satisfies the given constraints. The domain $\\mathcal{D}$ is bounded by the lines $x=0$, $y=0$, and $x+y=L$. For $\\psi_{\\text{trial}}$ to vanish on these boundaries, it must contain factors of $x$, $y$, and $(L-x-y)$. The simplest polynomial form that satisfies this is their product. Let us propose:\n$$ \\psi(x,y) = N x y (L-x-y) $$\nwhere $N$ is a normalization constant. We check this against the given constraints:\n1.  **Normalizable:** As a polynomial, $\\psi$ is continuous and bounded on the compact domain $\\mathcal{D}$, so its square is integrable. It is normalizable.\n2.  **Positive in the interior:** For any point $(x,y)$ in the interior of $\\mathcal{D}$, we have $x>0$, $y>0$, and $x+y<L$, which implies $(L-x-y)>0$. The product of three positive terms is positive.\n3.  **Vanishes on boundaries:** By construction, if $x=0$, $y=0$, or $x+y=L$, then $\\psi(x,y)=0$.\n4.  **Symmetric:** Exchanging $x$ and $y$ gives $N y x (L-y-x) = N x y (L-x-y)$, so the function is symmetric.\n5.  **Minimal degree:** This polynomial has a total degree of $3$. A polynomial of degree $1$ or $2$ cannot satisfy the condition of vanishing on three non-concurrent lines. Thus, degree $3$ is minimal.\n\nThis form for $\\psi_{\\text{trial}}(x,y)$ is correct. For the calculation of the variational energy, the normalization constant $N$ will cancel, so we may work with the unnormalized function $\\psi(x,y) = xy(L-x-y)$.\n\nThe variational energy is given by:\n$$ E_{\\text{var}} = \\frac{\\iint_{\\mathcal{D}} \\psi H \\psi \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi^2 \\,dx\\,dy} $$\nInside the domain $\\mathcal{D}$, the potential $V(x,y)=0$, so the Hamiltonian is purely kinetic: $H = -\\frac{\\hbar^2}{2m}\\nabla^2$. The expression for $E_{\\text{var}}$ becomes:\n$$ E_{\\text{var}} = \\frac{-\\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} \\psi(x,y) \\nabla^2 \\psi(x,y) \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi(x,y)^2 \\,dx\\,dy} $$\nWe evaluate the numerator integral using Green's first identity, $\\iint_{\\mathcal{D}} (f \\nabla^2 g) \\,dA = \\oint_{\\partial \\mathcal{D}} f (\\nabla g \\cdot \\mathbf{n}) \\,ds - \\iint_{\\mathcal{D}} (\\nabla f \\cdot \\nabla g) \\,dA$.\nLetting $f=g=\\psi$, this gives:\n$$ \\iint_{\\mathcal{D}} \\psi \\nabla^2 \\psi \\,dx\\,dy = \\oint_{\\partial \\mathcal{D}} \\psi (\\nabla \\psi \\cdot \\mathbf{n}) \\,ds - \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy $$\nThe boundary term $\\oint_{\\partial \\mathcal{D}} \\psi (\\nabla \\psi \\cdot \\mathbf{n}) \\,ds$ vanishes because our trial wavefunction $\\psi$ was constructed to be zero everywhere on the boundary $\\partial \\mathcal{D}$.\nThe numerator simplifies to:\n$$ \\langle \\psi | H | \\psi \\rangle = -\\frac{\\hbar^2}{2m} \\left( - \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy \\right) = \\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy $$\nSo the variational energy is:\n$$ E_{\\text{var}} = \\frac{\\frac{\\hbar^2}{2m} \\iint_{\\mathcal{D}} |\\nabla \\psi(x,y)|^2 \\,dx\\,dy}{\\iint_{\\mathcal{D}} \\psi(x,y)^2 \\,dx\\,dy} $$\nWe must now compute the two integrals. A standard result for integration of monomials over this triangular domain is:\n$$ I(a,b) = \\iint_{\\mathcal{D}} x^a y^b \\,dx\\,dy = \\int_0^L dx \\int_0^{L-x} dy \\, x^a y^b = L^{a+b+2} \\frac{a!b!}{(a+b+2)!} $$\nFirst, we compute the denominator, the normalization integral $\\langle \\psi | \\psi \\rangle$:\n$$ \\psi^2 = (xy(L-x-y))^2 = (Lxy - x^2y - xy^2)^2 = L^2x^2y^2 + x^4y^2 + x^2y^4 - 2Lx^3y^2 - 2Lx^2y^3 + 2x^3y^3 $$\n$$ \\langle \\psi | \\psi \\rangle = \\iint_{\\mathcal{D}} \\psi^2 \\,dx\\,dy = L^2 I(2,2) + I(4,2) + I(2,4) - 2L I(3,2) - 2L I(2,3) + 2 I(3,3) $$\nUsing the formula for $I(a,b)$:\n$I(2,2) = \\frac{L^6}{180}$, $I(4,2) = I(2,4) = \\frac{L^8}{840}$, $I(3,2) = I(2,3) = \\frac{L^7}{420}$, $I(3,3) = \\frac{L^8}{1120}$.\n$$ \\langle \\psi | \\psi \\rangle = L^2\\left(\\frac{L^6}{180}\\right) + 2\\left(\\frac{L^8}{840}\\right) - 4L\\left(\\frac{L^7}{420}\\right) + 2\\left(\\frac{L^8}{1120}\\right) \\\\ = L^8 \\left(\\frac{1}{180} + \\frac{1}{420} - \\frac{1}{105} + \\frac{1}{560}\\right) = L^8 \\left(\\frac{28 - 36 + 9}{5040}\\right) = \\frac{L^8}{5040} $$\nNext, we compute the numerator integral. We need the gradient of $\\psi = Lxy - x^2y - xy^2$:\n$$ \\frac{\\partial \\psi}{\\partial x} = Ly - 2xy - y^2 = y(L-2x-y) $$\n$$ \\frac{\\partial \\psi}{\\partial y} = Lx - x^2 - 2xy = x(L-x-2y) $$\nSo, $|\\nabla \\psi|^2 = (\\frac{\\partial \\psi}{\\partial x})^2 + (\\frac{\\partial \\psi}{\\partial y})^2 = y^2(L-2x-y)^2 + x^2(L-x-2y)^2$.\nThe integral is $\\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy$. Due to the symmetry of the domain and the form of the integrand $f(x,y)+f(y,x)$, the integral of the two terms is equal.\n$$ \\iint_{\\mathcal{D}} |\\nabla \\psi|^2 \\,dx\\,dy = 2 \\iint_{\\mathcal{D}} y^2(L-2x-y)^2 \\,dx\\,dy $$\nExpanding the integrand:\n$$ y^2(L-2x-y)^2 = y^2(L^2 + 4x^2 + y^2 - 4Lx - 2Ly + 4xy) = L^2y^2 - 4Lxy^2 + 4x^2y^2 - 2Ly^3 + 4xy^3 + y^4 $$\nIntegrating term-by-term using $I(a,b)$:\n$$ \\iint_{\\mathcal{D}} y^2(L-2x-y)^2 \\,dx\\,dy = L^2 I(0,2) - 4L I(1,2) + 4 I(2,2) - 2L I(0,3) + 4 I(1,3) + I(0,4) $$\nUsing the values: $I(0,2) = \\frac{L^4}{12}$, $I(1,2) = \\frac{L^5}{60}$, $I(2,2) = \\frac{L^6}{180}$, $I(0,3) = \\frac{L^5}{20}$, $I(1,3) = \\frac{L^6}{120}$, $I(0,4) = \\frac{L^6}{30}$.\n$$ \\iint y^2(L-2x-y)^2d A = L^2\\frac{L^4}{12} - 4L\\frac{L^5}{60} + 4\\frac{L^6}{180} - 2L\\frac{L^5}{20} + 4\\frac{L^6}{120} + \\frac{L^6}{30} \\\\ = L^6\\left(\\frac{1}{12} - \\frac{1}{15} + \\frac{1}{45} - \\frac{1}{10} + \\frac{1}{30} + \\frac{1}{30}\\right) = L^6\\left(\\frac{15 - 18 + 4}{180}\\right) = \\frac{L^6}{180} $$\nTherefore, the full numerator integral is $\\iint |\\nabla \\psi|^2 \\,dx\\,dy = 2 \\times \\frac{L^6}{180} = \\frac{L^6}{90}$.\nFinally, we assemble the variational energy:\n$$ E_{\\text{var}} = \\frac{\\frac{\\hbar^2}{2m} \\left(\\frac{L^6}{90}\\right)}{\\frac{L^8}{5040}} = \\frac{\\hbar^2}{2m L^2} \\frac{5040}{90} = \\frac{\\hbar^2}{2m L^2} \\times 56 = \\frac{28\\hbar^2}{mL^2} $$\nThis is the variational upper bound for the ground-state energy.", "answer": "$$\n\\boxed{\\frac{28\\hbar^{2}}{mL^{2}}}\n$$", "id": "2448862"}, {"introduction": "Our final practice transitions from analytical optimization to a powerful computational framework, the Rayleigh–Ritz method [@problem_id:2448914]. Here, you will approximate the ground state of a particle in a box with a perturbing linear potential, $V(x) = \\epsilon x/L$, by using a trial wavefunction composed of a linear combination of basis functions. This exercise will guide you through expressing the variational problem as a matrix eigenvalue equation, a fundamental technique in computational physics that paves the way for solving complex quantum systems numerically.", "problem": "Consider a non-relativistic quantum particle of mass $m$ confined to a one-dimensional infinite potential well spanning $x \\in [0,L]$, with Hamiltonian operator $H = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$ and Dirichlet boundary conditions $\\psi(0)=\\psi(L)=0$. Inside the well, the potential is linearly sloped: $V(x) = \\epsilon\\, x/L$, where $\\epsilon \\ge 0$ is a constant that sets the slope scale. Use the Rayleigh–Ritz variational method with a truncated Fourier sine series trial function \n$$\\psi(x) = \\sum_{n=1}^{N} c_n \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right),$$ \nand determine the coefficients $\\{c_n\\}_{n=1}^N$ that minimize the energy expectation value subject to the normalization constraint $\\int_0^L |\\psi(x)|^2\\,dx = 1$.\n\nStart from fundamental principles: the time-independent Schrödinger equation and the variational principle that, for any normalized $\\psi$, the energy functional $E[\\psi] = \\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi \\rangle}$ provides an upper bound to the ground-state energy. Recast the minimization over the coefficients $c_n$ into a finite-dimensional generalized eigenvalue problem using the basis functions $b_n(x) = \\sin(n\\pi x/L)$. Construct the overlap matrix $S_{mn} = \\int_0^L b_m(x)\\,b_n(x)\\,dx$ and the Hamiltonian matrix $H_{mn} = \\int_0^L b_m(x)\\,H\\,b_n(x)\\,dx$. Derive closed-form expressions for all required integrals from first principles, including:\n- the kinetic-energy contribution to $H_{mn}$ based on differentiating $b_n(x)$,\n- the potential-energy contribution to $H_{mn}$ via exact evaluation of $\\int_0^L x\\,\\sin(\\cdot)\\sin(\\cdot)\\,dx$,\n- and the normalization condition expressed in terms of the matrix $S$.\n\nYour program must:\n- assemble $S$ and $H$ exactly using the closed-form integrals you derive,\n- solve the generalized symmetric eigenvalue problem to obtain the lowest eigenvalue $E_0$ and its associated eigenvector $c$,\n- normalize the eigenvector so that $\\int_0^L \\psi^2(x)\\,dx = 1$, equivalently $c^\\top S c = 1$,\n- fix the global phase/sign ambiguity by enforcing that the first coefficient $c_1$ that has magnitude greater than a small threshold is non-negative,\n- and report the ground-state energy and the first three coefficients.\n\nUse the following unit convention: set $\\hbar = 1$ and $m = 1$. Under this convention, energies are to be expressed in the dimensionless unit implied by these choices. The length $L$ is specified for each test and is measured in the same consistent unit system, so energy scales as $1/L^2$. Express all energies and coefficients as decimal numbers rounded to $6$ decimal places.\n\nTest suite. Your program must run the following cases:\n- Case A (happy path): $N=6$, $L=1.0$, $\\epsilon=0.0$.\n- Case B (weak slope): $N=6$, $L=1.0$, $\\epsilon=0.1$.\n- Case C (strong slope and larger basis): $N=12$, $L=1.0$, $\\epsilon=5.0$.\n- Case D (boundary case, minimal basis): $N=1$, $L=1.0$, $\\epsilon=1.0$.\n\nFor each case, output a list containing the ground-state energy followed by the first three coefficients $[E_0, c_1, c_2, c_3]$, after applying the normalization and sign convention described above. If $N < 3$, pad the missing leading coefficients with zeros so that each case still reports three coefficients. Your program should produce a single line of output containing the results for Cases A–D as a comma-separated list of these four-element lists, enclosed in square brackets, for example: [[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]], where each $xij$ is a decimal rounded to $6$ places.", "solution": "The problem as stated is valid. It is a well-posed application of the Rayleigh-Ritz variational method, a fundamental technique in computational quantum mechanics, to a particle in a one-dimensional infinite potential well with a linear perturbation. The problem is scientifically grounded, objective, and contains all necessary information for a unique solution within the specified finite basis. We proceed with the derivation and solution.\n\nThe core of the problem is to find an approximate ground state solution to the time-independent Schrödinger equation, $H\\psi = E\\psi$, for the given Hamiltonian:\n$$H = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + \\frac{\\epsilon x}{L}$$\non the domain $x \\in [0, L]$ with boundary conditions $\\psi(0) = \\psi(L) = 0$.\n\nThe variational principle states that for any normalized trial wavefunction $\\psi$, the expectation value of the energy, $E[\\psi] = \\langle\\psi|H|\\psi\\rangle = \\int_0^L \\psi^*(x) H \\psi(x) dx$, provides an upper bound to the true ground-state energy $E_0$. We are given a trial wavefunction which is a finite linear combination of basis functions $b_n(x)$:\n$$\\psi(x) = \\sum_{n=1}^{N} c_n b_n(x), \\quad \\text{where} \\quad b_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\nThis choice of basis functions correctly satisfies the boundary conditions. The coefficients $\\{c_n\\}$ are real, so $\\psi^*(x) = \\psi(x)$.\n\nThe energy functional in terms of the coefficients $c_n$ is:\n$$E(c_1, \\dots, c_N) = \\frac{\\langle \\sum_m c_m b_m | H | \\sum_n c_n b_n \\rangle}{\\langle \\sum_m c_m b_m | \\sum_n c_n b_n \\rangle} = \\frac{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) H b_n(x) dx}{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) b_n(x) dx}$$\nWe define the Hamiltonian matrix elements $H_{mn} = \\int_0^L b_m(x) H b_n(x) dx$ and the overlap matrix elements $S_{mn} = \\int_0^L b_m(x) b_n(x) dx$. The energy functional becomes:\n$$E = \\frac{\\mathbf{c}^T H \\mathbf{c}}{\\mathbf{c}^T S \\mathbf{c}}$$\nTo find the coefficients that minimize this energy, we require $\\frac{\\partial E}{\\partial c_k} = 0$ for all $k = 1, \\dots, N$. This procedure leads to the generalized eigenvalue problem:\n$$H \\mathbf{c} = E S \\mathbf{c}$$\nThe lowest eigenvalue $E$ of this system is the variational estimate for the ground-state energy, and the corresponding eigenvector $\\mathbf{c}$ gives the coefficients of the approximate ground-state wavefunction. We now derive the matrix elements $S_{mn}$ and $H_{mn}$ from first principles.\n\n**Overlap Matrix $S_{mn}$**\nThe elements of the overlap matrix are given by the integral:\n$$S_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nThe basis functions are orthogonal on the interval $[0, L]$. The evaluation of this standard integral yields:\n$$S_{mn} = \\frac{L}{2} \\delta_{mn}$$\nwhere $\\delta_{mn}$ is the Kronecker delta. The overlap matrix $S$ is therefore a diagonal matrix.\n\n**Hamiltonian Matrix $H_{mn}$**\nThe Hamiltonian matrix elements can be separated into kinetic and potential energy contributions: $H_{mn} = T_{mn} + V_{mn}$.\n\n**Kinetic Energy Term $T_{mn}$**\nThe kinetic energy operator is $T = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$. Its matrix elements are:\n$$T_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nThe basis functions are eigenfunctions of the second derivative operator:\n$$\\frac{d^2}{dx^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\nSubstituting this into the integral for $T_{mn}$:\n$$T_{mn} = \\frac{\\hbar^2}{2m} \\left(\\frac{n\\pi}{L}\\right)^2 \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\hbar^2 \\pi^2 n^2}{2mL^2} S_{mn}$$\nUsing $S_{mn}=\\frac{L}{2}\\delta_{mn}$ and the specified units $\\hbar=1, m=1$:\n$$T_{mn} = \\frac{\\pi^2 n^2}{2L^2} \\left(\\frac{L}{2}\\delta_{mn}\\right) = \\frac{\\pi^2 n^2}{4L} \\delta_{mn}$$\nThe kinetic energy matrix $T$ is also diagonal.\n\n**Potential Energy Term $V_{mn}$**\nThe potential is $V(x) = \\epsilon x / L$. Its matrix elements are:\n$$V_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(\\frac{\\epsilon x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nTo evaluate this integral, we first consider the diagonal elements, $m=n$:\n$$V_{nn} = \\frac{\\epsilon}{L} \\int_0^L x \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx$$\nThe integral $\\int_0^L x \\cos(ax) dx$ evaluates to zero for $a = 2n\\pi/L$. Thus, only the first term contributes:\n$$V_{nn} = \\frac{\\epsilon}{2L} \\int_0^L x dx = \\frac{\\epsilon}{2L} \\left[\\frac{x^2}{2}\\right]_0^L = \\frac{\\epsilon}{2L} \\frac{L^2}{2} = \\frac{\\epsilon L}{4}$$\nFor the off-diagonal elements, $m \\neq n$, we use the identity $\\sin A \\sin B = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$:\n$$V_{mn} = \\frac{\\epsilon}{2L} \\int_0^L x \\left[ \\cos\\left(\\frac{(m-n)\\pi x}{L}\\right) - \\cos\\left(\\frac{(m+n)\\pi x}{L}\\right) \\right] dx$$\nWe use the standard integral, evaluated via integration by parts:\n$$\\int_0^L x \\cos\\left(\\frac{k\\pi x}{L}\\right) dx = \\frac{L^2}{(k\\pi)^2}(\\cos(k\\pi)-1) = \\frac{L^2}{(k\\pi)^2}((-1)^k-1)$$\nThis integral is zero if $k$ is an even integer, and $-2L^2/(k\\pi)^2$ if $k$ is an odd integer.\nFor $V_{mn}$ where $m \\ne n$, the integers $k$ are $(m-n)$ and $(m+n)$. Both have the same parity.\nIf $(m-n)$ is even, both integrals are zero, so $V_{mn}=0$.\nIf $(m-n)$ is odd, both integrals are non-zero:\n\\begin{align*} V_{mn} &= \\frac{\\epsilon}{2L} \\left[ \\frac{-2L^2}{((m-n)\\pi)^2} - \\frac{-2L^2}{((m+n)\\pi)^2} \\right] \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\left[ \\frac{1}{(m-n)^2} - \\frac{1}{(m+n)^2} \\right] \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\frac{(m+n)^2 - (m-n)^2}{(m^2-n^2)^2} \\\\ &= -\\frac{\\epsilon L}{\\pi^2} \\frac{4mn}{(m^2-n^2)^2}\\end{align*}\n\n**Summary of Matrix Elements**\nIn the units $\\hbar=1, m=1$:\n$S_{mn} = \\frac{L}{2}\\delta_{mn}$\n$H_{mn} = T_{mn} + V_{mn}$, where\nFor $m=n$:\n$$H_{nn} = \\frac{\\pi^2 n^2}{4L} + \\frac{\\epsilon L}{4}$$\nFor $m \\ne n$:\n$$H_{mn} = \\begin{cases} 0 & \\text{if } (m-n) \\text{ is even} \\\\ -\\dfrac{4\\epsilon L}{\\pi^2} \\dfrac{mn}{(m^2-n^2)^2} & \\text{if } (m-n) \\text{ is odd} \\end{cases}$$\n\nThese matrices are constructed and used to solve the generalized eigenvalue problem $H\\mathbf{c} = E S\\mathbf{c}$. The lowest eigenvalue $E_0$ is the variational estimate for the ground-state energy. The corresponding eigenvector $\\mathbf{c}$ is normalized such that $\\mathbf{c}^T S \\mathbf{c} = 1$, which is equivalent to $\\int_0^L \\psi^2(x)dx=1$. The global phase is fixed by requiring the first non-negligible coefficient $c_n$ to be positive.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the variational problem for a particle in a 1D box with a linear potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, epsilon)\n        (6, 1.0, 0.0),   # Case A\n        (6, 1.0, 0.1),   # Case B\n        (12, 1.0, 5.0),  # Case C\n        (1, 1.0, 1.0),   # Case D\n    ]\n\n    results = []\n    for N, L, epsilon in test_cases:\n        # Assemble the overlap matrix S and Hamiltonian matrix H.\n        S = np.zeros((N, N))\n        H = np.zeros((N, N))\n\n        # Populate the matrices using 1-based indexing for n and m for clarity\n        # with the derived formulas.\n        for i in range(N):\n            for j in range(N):\n                n = i + 1\n                m = j + 1\n                \n                if i == j:\n                    S[i, j] = L / 2.0\n                    # T_nn = (pi^2 n^2) / (2 L^2) * (L/2) = (pi^2 n^2)/(4L)\n                    T_nn = (np.pi**2 * n**2) / (4.0 * L)\n                    V_nn = epsilon * L / 4.0\n                    H[i, j] = T_nn + V_nn\n                else:\n                    S[i, j] = 0.0\n                    # T_mn is zero for m != n\n                    # V_mn is non-zero only if (m-n) is odd\n                    if (m - n) % 2 != 0:\n                        V_mn = (-4.0 * epsilon * L / np.pi**2) * \\\n                               (m * n) / (m**2 - n**2)**2\n                        H[i, j] = V_mn\n                    else:\n                        H[i, j] = 0.0\n\n        # Solve the generalized eigenvalue problem Hc = ESc\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        # that are S-orthonormal (c.T @ S @ c = 1).\n        eigenvalues, eigenvectors = eigh(H, S)\n\n        # The ground state energy is the lowest eigenvalue\n        E0 = eigenvalues[0]\n\n        # The coefficients are the first eigenvector\n        c = eigenvectors[:, 0]\n\n        # Fix the global sign ambiguity.\n        # Enforce that the first coefficient with magnitude greater than a small\n        # threshold is non-negative.\n        threshold = 1e-9\n        for k in range(N):\n            if abs(c[k]) > threshold:\n                if c[k]  0:\n                    c = -c\n                break\n        \n        # Extract the first three coefficients, padding with zeros if N  3.\n        c1 = c[0] if N >= 1 else 0.0\n        c2 = c[1] if N >= 2 else 0.0\n        c3 = c[2] if N >= 3 else 0.0\n\n        # Append the formatted result for this case.\n        results.append([E0, c1, c2, c3])\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted, then joined by commas, and enclosed in brackets.\n    formatted_results = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        formatted_results.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2448914"}]}