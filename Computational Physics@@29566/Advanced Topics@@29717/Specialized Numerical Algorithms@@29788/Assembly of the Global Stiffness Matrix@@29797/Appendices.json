{"hands_on_practices": [{"introduction": "Mastering the assembly of a global stiffness matrix begins with understanding how individual element contributions are systematically mapped and summed into a global system. This exercise challenges you to perform this assembly manually for a one-dimensional heat conduction problem. By intentionally scrambling the node and element numbering, this practice [@problem_id:2393853] moves beyond simple sequential assembly, forcing a focus on the core logic of local-to-global index mapping that is fundamental to any finite element software.", "problem": "A steady one-dimensional heat conduction problem is considered on a straight, prismatic bar with constant thermal conductivity $k$ and constant cross-sectional area $A$. There is no internal heat generation. The bar is discretized using the standard Galerkin finite element method with linear Lagrange shape functions into $4$ elements over $5$ global nodes. The global node identifiers and their positions along the bar are:\n- Node $42$: $x=0.00 \\ \\mathrm{m}$\n- Node $7$: $x=0.35 \\ \\mathrm{m}$\n- Node $13$: $x=0.50 \\ \\mathrm{m}$\n- Node $5$: $x=0.90 \\ \\mathrm{m}$\n- Node $21$: $x=1.20 \\ \\mathrm{m}$\n\nThe element connectivity is intentionally scrambled and given by the following list of two-node elements $(\\text{first node}, \\text{second node})$:\n- Element $17$: $(42,7)$\n- Element $100$: $(13,7)$\n- Element $9$: $(13,5)$\n- Element $23$: $(21,5)$\n\nAssemble the global stiffness matrix for the unconstrained system (that is, before applying any boundary conditions). The rows and columns of the global stiffness matrix are to be ordered according to the node-identifier sequence $(5, \\ 42, \\ 13, \\ 21, \\ 7)$.\n\nMaterial and geometric properties are:\n- Thermal conductivity $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$\n- Cross-sectional area $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$\n\nWhat is the value of the diagonal entry of the assembled global stiffness matrix associated with global node identifier $13$? Express your answer in $\\mathrm{W \\, K^{-1}}$ and round your answer to $4$ significant figures.", "solution": "The governing differential equation for steady one-dimensional heat conduction in a prismatic bar with constant thermal conductivity $k$ and cross-sectional area $A$ without internal heat generation is\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k A \\, \\frac{\\mathrm{d}T}{\\mathrm{d}x}\\right) \\,=\\, 0.\n$$\nThe standard Galerkin finite element method with linear Lagrange shape functions over a two-node element of length $L_{e}$ produces the element stiffness matrix\n$$\n\\mathbf{K}^{(e)} \\,=\\, \\int_{0}^{L_{e}} k A \\, \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right)^{\\!\\top} \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right) \\, \\mathrm{d}x,\n$$\nwhere $\\mathbf{N} = \\begin{bmatrix} N_{1} & N_{2} \\end{bmatrix}$ are the linear shape functions. For a linear two-node element, the derivatives are constant on the element, $\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{L_{e}}$ and $\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{L_{e}}$, so\n$$\n\\mathbf{K}^{(e)} \\,=\\, k A \\int_{0}^{L_{e}} \n\\begin{bmatrix}\n\\frac{1}{L_{e}^{2}} & -\\frac{1}{L_{e}^{2}} \\\\\n-\\frac{1}{L_{e}^{2}} & \\frac{1}{L_{e}^{2}}\n\\end{bmatrix}\n\\mathrm{d}x\n\\,=\\, \\frac{k A}{L_{e}} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}.\n$$\n\nThus, each element contributes $\\frac{k A}{L_{e}}$ to the diagonal entries associated with its two nodes and $-\\frac{k A}{L_{e}}$ to the corresponding off-diagonal couplings. The diagonal entry of the global stiffness matrix associated with a particular global node is the sum of the diagonal contributions from the elements incident on that node.\n\nWe first compute the element lengths from the given node coordinates:\n- Element $17$ connects nodes $(42, 7)$ at $x=0.00 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{17} = |0.35 - 0.00| = 0.35 \\ \\mathrm{m}$.\n- Element $100$ connects nodes $(13, 7)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.35 \\ \\mathrm{m}$, so $L_{100} = |0.50 - 0.35| = 0.15 \\ \\mathrm{m}$.\n- Element $9$ connects nodes $(13, 5)$ at $x=0.50 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{9} = |0.90 - 0.50| = 0.40 \\ \\mathrm{m}$.\n- Element $23$ connects nodes $(21, 5)$ at $x=1.20 \\ \\mathrm{m}$ and $x=0.90 \\ \\mathrm{m}$, so $L_{23} = |1.20 - 0.90| = 0.30 \\ \\mathrm{m}$.\n\nGlobal node $13$ is incident on elements $100$ and $9$. Therefore, the diagonal entry of the global stiffness matrix associated with node $13$ is\n$$\nK_{(13,13)} \\,=\\, \\frac{k A}{L_{100}} \\,+\\, \\frac{k A}{L_{9}}.\n$$\n\nInsert the given material and geometric properties $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$ and $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$:\n$$\nk A \\,=\\, 180 \\times \\left(2.0 \\times 10^{-3}\\right) \\,=\\, 0.36 \\ \\mathrm{W \\, m^{-1} \\, K^{-1} \\cdot m^2} = 0.36 \\ \\mathrm{W \\, K^{-1} \\cdot m}.\n$$\nThe provided solution had a slight unit error in the intermediate step, it should be $W \\cdot m / K$. The final calculation is correct.\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left(\\frac{1}{0.15} + \\frac{1}{0.40}\\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nCompute the reciprocal lengths:\n$$\n\\frac{1}{0.15} \\,=\\, \\frac{100}{15} \\,=\\, \\frac{20}{3}, \n\\qquad\n\\frac{1}{0.40} \\,=\\, \\frac{10}{4} \\,=\\, \\frac{5}{2}.\n$$\nTherefore,\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left( \\frac{20}{3} + \\frac{5}{2} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{40}{6} + \\frac{15}{6} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{55}{6} \\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\nMultiply:\n$$\n0.36 \\times \\frac{55}{6}\n\\,=\\, 0.06 \\times 55\n\\,=\\, 3.3.\n$$\n\nHence, the diagonal entry associated with global node $13$ is\n$$\nK_{(13,13)} \\,=\\, 3.3 \\ \\mathrm{W \\, K^{-1}}.\n$$\nRounding to $4$ significant figures yields $3.300 \\ \\mathrm{W \\, K^{-1}}$ as required.", "answer": "$$\\boxed{3.300}$$", "id": "2393853"}, {"introduction": "The global stiffness matrix is more than just a collection of numbers; its mathematical properties directly reflect the physical characteristics of the system being modeled. This problem explores the profound connection between a singular matrix and a system's physical stability [@problem_id:2400444]. By tuning a spring constant in a simple mass-spring chain, you will determine the precise condition that creates a 'rigid-body mode'—a free-floating part of the structure—and see how this physical reality manifests as a zero determinant in the corresponding stiffness matrix.", "problem": "A one-dimensional, small-displacement mass–spring chain is assembled from three point masses with translational degrees of freedom $x_{1}$, $x_{2}$, and $x_{3}$. Linear springs connect the degrees of freedom as follows: a ground spring of stiffness $k_{0}=4$ N/m connects $x_{1}$ to ground; an inter-mass spring of stiffness $k_{1}=5$ N/m connects $x_{1}$ and $x_{2}$; and a tunable inter-mass spring of stiffness $\\alpha$ N/m connects $x_{2}$ and $x_{3}$. There is no direct spring from $x_{3}$ to ground. Under the standard linear spring model, the assembled global stiffness matrix $K(\\alpha)$ relates the nodal force vector $f$ to the displacement vector $x$ by $f=K(\\alpha)\\,x$, where each spring of stiffness $k$ between degrees of freedom $i$ and $j$ contributes $+k$ to $K_{ii}$ and $K_{jj}$ and $-k$ to $K_{ij}$ and $K_{ji}$, and a spring of stiffness $k$ to ground at degree of freedom $i$ contributes $+k$ to $K_{ii}$.\n\nDetermine the value of the tunable stiffness $\\alpha$ that makes the system stiffness matrix $K(\\alpha)$ singular (non-invertible), corresponding to the presence of at least one disconnected, free-moving degree of freedom. Express your answer in N/m. Provide an exact value; no rounding is required.", "solution": "The first step is to construct the $3 \\times 3$ global stiffness matrix $K(\\alpha)$ for the degrees of freedom $x_1$, $x_2$, and $x_3$. We apply the given assembly rules.\n\nThe diagonal terms $K_{ii}$ are the sum of the stiffnesses of all springs connected to degree of freedom $i$.\n- For $x_1$: The springs connected are the ground spring $k_0=4$ N/m and the inter-mass spring $k_1=5$ N/m.\n$$K_{11} = k_{0} + k_{1} = 4 + 5 = 9$$\n- For $x_2$: The springs connected are the inter-mass spring $k_1=5$ N/m and the tunable spring $\\alpha$ N/m.\n$$K_{22} = k_{1} + \\alpha = 5 + \\alpha$$\n- For $x_3$: The only spring connected is the tunable spring $\\alpha$ N/m.\n$$K_{33} = \\alpha$$\n\nThe off-diagonal terms $K_{ij}$ ($i \\neq j$) are equal to the negative of the stiffness of the spring connecting degrees of freedom $i$ and $j$. If no spring directly connects them, the term is zero.\n- For the connection between $x_1$ and $x_2$:\n$$K_{12} = K_{21} = -k_{1} = -5$$\n- For the connection between $x_2$ and $x_3$:\n$$K_{23} = K_{32} = -\\alpha$$\n- For the connection between $x_1$ and $x_3$: There is no direct spring.\n$$K_{13} = K_{31} = 0$$\n\nAssembling these components yields the global stiffness matrix $K(\\alpha)$:\n$$\nK(\\alpha) = \\begin{pmatrix}\nk_0+k_1 & -k_1 & 0 \\\\\n-k_1 & k_1+\\alpha & -\\alpha \\\\\n0 & -\\alpha & \\alpha\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n9 & -5 & 0 \\\\\n-5 & 5+\\alpha & -\\alpha \\\\\n0 & -\\alpha & \\alpha\n\\end{pmatrix}\n$$\nA matrix is singular if and only if its determinant is zero. We must therefore solve the equation $\\det(K(\\alpha)) = 0$ for the parameter $\\alpha$.\n\nWe compute the determinant, for instance, by cofactor expansion along the first row:\n$$\n\\det(K(\\alpha)) =\n9 \\cdot \\begin{vmatrix} 5+\\alpha & -\\alpha \\\\ -\\alpha & \\alpha \\end{vmatrix}\n- (-5) \\cdot \\begin{vmatrix} -5 & -\\alpha \\\\ 0 & \\alpha \\end{vmatrix}\n+ 0 \\cdot \\begin{vmatrix} -5 & 5+\\alpha \\\\ 0 & -\\alpha \\end{vmatrix}\n$$\nEvaluating the $2 \\times 2$ determinants:\n$$\n\\det(K(\\alpha)) = 9 [(\\alpha)(5+\\alpha) - (-\\alpha)(-\\alpha)] + 5 [(-5)(\\alpha) - (0)(-\\alpha)] + 0\n$$\n$$\n\\det(K(\\alpha)) = 9 [5\\alpha + \\alpha^2 - \\alpha^2] + 5 [-5\\alpha]\n$$\n$$\n\\det(K(\\alpha)) = 9(5\\alpha) - 25\\alpha\n$$\n$$\n\\det(K(\\alpha)) = 45\\alpha - 25\\alpha\n$$\n$$\n\\det(K(\\alpha)) = 20\\alpha\n$$\nThe condition for singularity is $\\det(K(\\alpha))=0$, which leads to the equation:\n$$\n20\\alpha = 0\n$$\nThe solution is:\n$$\n\\alpha = 0\n$$\nThis result is physically meaningful. The problem states that a singular stiffness matrix corresponds to a \"disconnected, free-moving degree of freedom,\" which is also known as a rigid-body mode. If $\\alpha=0$, the spring connecting degrees of freedom $x_2$ and $x_3$ has zero stiffness, meaning it is effectively removed. Consequently, the mass at $x_3$ is no longer connected to any part of the system that is anchored to the ground. It can undergo arbitrary translation without any restoring force. This is a rigid-body mode, and the system's potential energy is invariant with respect to the displacement $x_3$. For such a mode to exist, the stiffness matrix must be singular. The value $\\alpha=0$ precisely creates this physical situation. The required value for the tunable stiffness is $0$ N/m.", "answer": "$$\\boxed{0}$$", "id": "2400444"}, {"introduction": "While the theory of matrix assembly is exact, its implementation on a computer is subject to the limitations of finite-precision arithmetic. This thought experiment addresses a critical and often overlooked pitfall: numerical error when assembling contributions from components with vastly different stiffness scales [@problem_id:2374300]. By analyzing the addition of a very stiff and a very flexible element's contribution, you will uncover how floating-point 'absorption' can lead to a physically incorrect model and learn which strategies can mitigate such errors.", "problem": "A one-dimensional rod is modeled by the Finite Element Method (FEM), discretized into two linear spring elements connected in series at a shared node. The local stiffness matrix of each two-node element is $k^{(e)} \\in \\mathbb{R}^{2 \\times 2}$ with entries $k^{(e)} = \\begin{bmatrix} k_{e} & -k_{e} \\\\ -k_{e} & k_{e} \\end{bmatrix}$, where $k_{e} = E_{e}A_{e}/L_{e}$. Element $\\left(1\\right)$ is very stiff with $k_{1} = 10^{12}$, and element $\\left(2\\right)$ is very flexible with $k_{2} = 10^{-6}$. They meet at the shared node indexed as $2$ in the global system. In the global stiffness matrix $K \\in \\mathbb{R}^{3 \\times 3}$ (nodes $1$–$3$), the shared-node diagonal entry $K_{22}$ is obtained by summing the contributions from both elements, consistent with the FEM assembly rule that global entries are sums of local contributions associated with shared degrees of freedom.\n\nAssume assembly is performed in Institute of Electrical and Electronics Engineers (IEEE) $754$ binary floating-point arithmetic, double precision, with unit roundoff $u = 2^{-53} \\approx 1.11 \\times 10^{-16}$. Let $\\mathrm{fl}\\!\\left(\\cdot\\right)$ denote the result of a floating-point operation, and let the Unit in the Last Place (ULP) at magnitude $\\left|x\\right|$ be the distance between adjacent representable floating-point numbers near $x$, which is approximately $2u\\left|x\\right|$; thus a small addend $y$ added to a much larger $x$ is rounded away whenever $\\left|y\\right| < \\tfrac{1}{2}\\mathrm{ULP}\\!\\left(x\\right) \\approx u\\left|x\\right|$.\n\nWhich of the following statements about the numerical error propagation during the assembly of $K_{22}$ and its mitigation are correct?\n\nA. The flexible element’s contribution $k_{2}$ is rounded away entirely when forming $\\mathrm{fl}\\!\\left(k_{1}+k_{2}\\right)$ in double precision because $k_{2} < \\tfrac{1}{2}\\mathrm{ULP}\\!\\left(k_{1}\\right)$, so the assembled $K_{22}$ equals $k_{1}$ in floating point.\n\nB. The floating-point model $\\mathrm{fl}\\!\\left(a+b\\right) = \\left(a+b\\right)\\left(1+\\delta\\right)$ with $\\left|\\delta\\right| \\le u$ guarantees that both contributions are represented in $K_{22}$ regardless of the ratio $k_{1}/k_{2}$.\n\nC. Reversing the summation order for this two-term sum (adding $k_{2}$ before $k_{1}$) does not change the final rounded value; the smaller term is still eliminated by rounding.\n\nD. Scaling the equations by a single global constant to make $k_{1}$ of order $1$ will simultaneously make $k_{2}$ of order $1$, thereby preventing the rounding loss at $K_{22}$.\n\nE. If each global matrix entry is assembled and stored in a higher precision format with a larger significand (for example, $p=64$-bit significand extended precision), then for the given numbers the small term $k_{2}$ is retained in $K_{22}$ because $k_{2}$ exceeds the rounding threshold at the scale of $k_{1}$ in that higher precision.\n\nSelect all that apply.", "solution": "The central task is to analyze the floating-point summation $\\mathrm{fl}\\!\\left(k_{1} + k_{2}\\right)$ which determines the computed value of the global stiffness entry $K_{22}$. The exact value is $K_{22} = k_{1} + k_{2} = 10^{12} + 10^{-6}$. The computation is performed in double precision, where the unit roundoff is $u = 2^{-53} \\approx 1.11 \\times 10^{-16}$. According to the problem's rounding model, the contribution of $k_{2}$ will be lost if $k_{2} < u \\cdot k_{1}$.\n\nLet us evaluate this condition for absorption (also called swamping):\n- The smaller term is $k_{2} = 10^{-6}$.\n- The larger term is $k_{1} = 10^{12}$.\n- The rounding threshold is $u \\cdot k_{1} \\approx (1.11 \\times 10^{-16}) \\cdot 10^{12} = 1.11 \\times 10^{-4}$.\n- We compare $k_{2}$ to this threshold: $10^{-6}$ versus $1.11 \\times 10^{-4}$.\n- Clearly, $10^{-6} < 1.11 \\times 10^{-4}$, so the condition for absorption is met. The term $k_{2}$ has a magnitude far below the smallest representable increment for a number of magnitude $k_{1}$ in double precision. Therefore, $\\mathrm{fl}\\!\\left(k_{1} + k_{2}\\right) = k_{1}$.\n\nNow we evaluate each statement.\n\n**A. The flexible element’s contribution $k_{2}$ is rounded away entirely when forming $\\mathrm{fl}\\!\\left(k_{1}+k_{2}\\right)$ in double precision because $k_{2} < \\tfrac{1}{2}\\mathrm{ULP}\\!\\left(k_{1}\\right)$, so the assembled $K_{22}$ equals $k_{1}$ in floating point.**\nOur analysis confirms this. The condition for rounding away the smaller term is approximated by $k_{2} < u \\cdot k_{1}$. Since $10^{-6} < 1.11 \\times 10^{-4}$, the contribution from the flexible element, $k_{2}$, is completely absorbed. The resulting value for $K_{22}$ in the computer's memory will be exactly the floating-point representation of $k_{1}$. This statement is correct.\n\n**B. The floating-point model $\\mathrm{fl}\\!\\left(a+b\\right) = \\left(a+b\\right)\\left(1+\\delta\\right)$ with $\\left|\\delta\\right| \\le u$ guarantees that both contributions are represented in $K_{22}$ regardless of the ratio $k_{1}/k_{2}$.**\nThis statement misinterprets the error model. The model bounds the *relative error* of the computed sum, but it does not guarantee that information from both operands is preserved. As shown above, $\\mathrm{fl}\\!\\left(k_{1} + k_{2}\\right) = k_{1}$, and the information from $k_2$ is lost. The relative error is $\\frac{|k_{1} - (k_{1}+k_{2})|}{|k_{1}+k_{2}|} \\approx \\frac{k_{2}}{k_{1}} = 10^{-18}$, which is less than $u$, so the model holds, but the conclusion in the statement is false. This statement is incorrect.\n\n**C. Reversing the summation order for this two-term sum (adding $k_{2}$ before $k_{1}$) does not change the final rounded value; the smaller term is still eliminated by rounding.**\nA standard floating-point unit (FPU) performs the addition $a+b$ by aligning the exponents of the operands. It shifts the significand of the number with the smaller exponent until they match. This process is independent of the order in which $a$ and $b$ are provided as operands. For a two-term sum, the result is the same regardless of order: $\\mathrm{fl}\\!\\left(k_{1} + k_{2}\\right) = \\mathrm{fl}\\!\\left(k_{2} + k_{1}\\right)$. The smaller term is lost in either case. This statement is correct.\n\n**D. Scaling the equations by a single global constant to make $k_{1}$ of order $1$ will simultaneously make $k_{2}$ of order $1$, thereby preventing the rounding loss at $K_{22}$.**\nThis is false. To make $k_1$ of order 1, we must scale by $\\alpha \\approx 1/k_1 = 10^{-12}$. The scaled value of $k_2$ becomes $\\alpha k_2 \\approx 10^{-12} \\cdot 10^{-6} = 10^{-18}$, which is not of order 1. The ratio of the numbers' magnitudes is invariant under global scaling, so the absorption problem persists. This statement is incorrect.\n\n**E. If each global matrix entry is assembled and stored in a higher precision format with a larger significand (for example, $p=64$-bit significand extended precision), then for the given numbers the small term $k_{2}$ is retained in $K_{22}$ because $k_{2}$ exceeds the rounding threshold at the scale of $k_{1}$ in that higher precision.**\nA $p=64$-bit significand implies a unit roundoff of $u_{ext} = 2^{-64} \\approx 5.42 \\times 10^{-20}$. The new rounding threshold at the magnitude of $k_{1}$ is $u_{ext} \\cdot k_{1} \\approx (5.42 \\times 10^{-20}) \\cdot 10^{12} = 5.42 \\times 10^{-8}$. We compare $k_{2}$ to this new threshold: $k_{2} = 10^{-6}$. Since $10^{-6} > 5.42 \\times 10^{-8}$, the smaller term is now large enough to be registered in the sum. Using a higher-precision accumulator is a standard technique to mitigate this issue. This statement is correct.", "answer": "$$\\boxed{ACE}$$", "id": "2374300"}]}