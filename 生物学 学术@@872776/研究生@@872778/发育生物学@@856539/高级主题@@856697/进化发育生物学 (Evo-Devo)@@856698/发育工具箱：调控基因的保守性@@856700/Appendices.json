{"hands_on_practices": [{"introduction": "发育工具箱基因的保守性是进化发育生物学的一个核心概念。但我们如何量化这种保守性并揭示其背后的选择压力呢？本练习将引导你使用分子进化中的一个关键指标——非同义替换率与同义替换率之比（$d_N/d_S$）——来计算并比较同源异形域蛋白功能域内外的选择压力。通过这个计算，你将亲身体会到为何像同源异形域这样的关键功能模块在数亿年的进化中受到了如此强烈的纯化选择。[@problem_id:2680399]", "problem": "关于发育“工具箱”基因保守性的一个经典论点是，介导序列特异性DNA结合的蛋白质片段比其侧翼区域受到更强的纯化选择。考虑一个同源异形框转录因子，其具有一个长度为$60$个氨基酸的典型同源异形域，该同源异形域嵌入在一个总长度为$300$个氨基酸的蛋白质中，因此有$240$个氨基酸位于同源异形域之外。您比较了两个物种的直系同源编码序列，它们的同义分化为$d_{S}=0.5$个替换/同义位点。将比率$d_{N}/d_{S}=\\omega$定义为非同义分化率（每个非同义位点的非同义替换数）与同义分化率（每个同义位点的同义替换数）之比。根据经验，对于同源异形域，您估计$\\omega_{\\mathrm{hd}}=0.08$（即，域内$\\omega  0.1$），而对于非同源异形域部分，您估计$\\omega_{\\mathrm{non}}=0.6$。\n\n假设以下基本建模前提： \n- 分子生物学的中心法则（脱氧核糖核酸到核糖核酸到蛋白质）将密码子变化与氨基酸变化联系起来，同义替换不改变氨基酸。\n- 每个位点的替换过程是一个时间齐次的泊松过程，且各位点独立进化。\n- 在所考虑的分化过程中，每个非同义位点的预期非同义替换数等于$d_{N}=\\omega\\,d_{S}$。\n\n在这些假设下，如果在进化区间内某个氨基酸位点没有发生非同义替换，则该氨基酸保持保守。计算同源异形域中一个氨基酸保持保守的预期概率。请将您的答案表示为无单位的小数，并四舍五入到四位有效数字。然后，在您的推理中，解释$\\omega$值的强烈分化如何支持发育工具箱约束的概念，但最终答案只提供所要求的数值。", "solution": "首先对问题陈述进行严格验证。\n\n逐字提取已知条件：\n- 一个同源异形框转录因子有一个长度为$60$个氨基酸的同源异形域。\n- 蛋白质总长度为$300$个氨基酸。\n- 非同源异形域部分为$240$个氨基酸。\n- 同义分化为$d_{S}=0.5$个替换/同义位点。\n- 非同义分化与同义分化之比为$d_{N}/d_{S}=\\omega$。\n- 对于同源异形域，$\\omega_{\\mathrm{hd}}=0.08$。\n- 对于非同源异形域部分，$\\omega_{\\mathrm{non}}=0.6$。\n- 假设：每个位点的替换过程是一个时间齐次的泊松过程。\n- 假设：各位点独立进化。\n- 定义：每个非同义位点的预期非同义替换数是$d_{N}=\\omega\\,d_{S}$。\n- 定义：如果一个氨基酸位点没有发生非同义替换，则该氨基酸是保守的。\n- 任务：计算同源异形域中一个氨基酸保持保守的预期概率。\n- 要求：将答案表示为无单位小数，并四舍五入到四位有效数字。\n\n验证评估：\n该问题具有科学依据，依赖于分子进化的标准原理，即用于检验选择的$d_N/d_S$检验和使用泊松过程对替换进行建模。所提供的参数（$d_S=0.5$，$\\omega_{\\mathrm{hd}}=0.08$，$\\omega_{\\mathrm{non}}=0.6$）在比较基因组学的实际范围内。该问题定义明确、客观且自洽，为得出唯一解提供了所有必要的信息和定义。该问题并非无足轻重，因为它要求将概率模型正确应用于进化生物学的概念。该问题被认定为有效。\n\n解题过程如下。\n\n问题的核心在于假设任何给定站点的替换都遵循泊松过程。泊松分布的概率质量函数给出了在固定的时间或空间间隔内观察到恰好$k$个事件的概率，前提是这些事件以已知的恒定平均速率$\\lambda$发生。其公式为：\n$$ P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} $$\n在本问题中，“事件”是单个氨基酸位点上的非同义替换，“平均速率”$\\lambda$是在所讨论的进化时期内每个位点此类替换的预期数量。该速率恰好被定义为$d_N$，即非同义分化。\n\n问题要求计算同源异形域中一个氨基酸保持保守的概率。根据所给定义，如果一个氨基酸位点没有发生非同义替换，则该氨基酸是保守的。这对应于替换数$k$为零的情况。\n\n我们关心的是同源异形域内的一个位点。因此，我们必须使用特定于该域的参数。同源异形域位点的非同义替换平均速率为$\\lambda = d_{N, \\mathrm{hd}}$。保守概率$P_{\\mathrm{cons, hd}}$是观察到$k=0$次替换的概率：\n$$ P_{\\mathrm{cons, hd}} = P(k=0) = \\frac{(d_{N, \\mathrm{hd}})^0 \\exp(-d_{N, \\mathrm{hd}})}{0!} $$\n回顾任何非零数的$0$次幂都为$1$，且$0! = 1$，上式可简化为：\n$$ P_{\\mathrm{cons, hd}} = \\exp(-d_{N, \\mathrm{hd}}) $$\n问题给出了关系式$d_N = \\omega d_S$。我们将其应用于同源异形域：\n$$ d_{N, \\mathrm{hd}} = \\omega_{\\mathrm{hd}} d_S $$\n已知值为$\\omega_{\\mathrm{hd}} = 0.08$和$d_S = 0.5$。现在我们可以计算速率参数$d_{N, \\mathrm{hd}}$：\n$$ d_{N, \\mathrm{hd}} = (0.08) \\times (0.5) = 0.04 $$\n这个值$d_{N, \\mathrm{hd}}=0.04$是在给定的进化分化时间内，同源异形域内每个非同义位点的预期非同义替换数。\n\n现在，我们使用这个速率计算保守概率：\n$$ P_{\\mathrm{cons, hd}} = \\exp(-0.04) $$\n进行数值计算：\n$$ P_{\\mathrm{cons, hd}} \\approx 0.960789439... $$\n问题要求答案四舍五入到四位有效数字。\n$$ P_{\\mathrm{cons, hd}} \\approx 0.9608 $$\n\n解释：参数$\\omega = d_N/d_S$是衡量作用于蛋白质的选择压力的指标。$\\omega  1$的值表示纯化选择，意味着非同义突变是有害的，并会从群体中被清除。同源异形域的$\\omega_{\\mathrm{hd}} = 0.08$值非常低，表明存在强烈的纯化选择。这是一个功能关键域的典型特征，其氨基酸序列受到高度限制，以保持其精确功能——在本例中为序列特异性DNA结合。相比之下，非同源异形域区域的$\\omega_{\\mathrm{non}} = 0.6$，虽然仍处于纯化选择之下，但其对氨基酸变化的容忍度高出近一个数量级。这种选择压力的强烈分化（$\\omega_{\\mathrm{hd}} \\ll \\omega_{\\mathrm{non}}$）是发育“工具箱”基因的经典分子标记。功能模块（同源异形域）被严格保守，而蛋白质的其他部分则具有更大的进化自由度。计算出的同源异形域位点的高保守概率（$96\\%$）正是这种强烈功能限制的直接量化结果，而这种限制是观察到的发育工具箱组件保守性背后的机制。", "answer": "$$\n\\boxed{0.9608}\n$$", "id": "2680399"}, {"introduction": "保守的转录因子通过与顺式调控元件上的特定DNA序列结合来发挥作用。然而，这些结合位点序列的微小变异会如何影响基因的表达输出呢？这个实践练习将带你从一个单核苷酸突变开始，运用位置权重矩阵（PWM）和希尔方程（Hill equation）等生物物理模型，定量地追踪这一突变如何改变转录因子的结合亲和力，并最终影响增强子的激活水平。这个过程清晰地展示了从基因型到表型的精确调控链条。[@problem_id:2680422]", "problem": "某个脊椎动物发育基因中的一个保守增强子依赖于一个转录因子（TF）的单一高信息量结合位点。该位点由一个位置权重矩阵（PWM）建模，其 PWM 得分通过自然对数对数优势比方案相对于均匀背景计算。具体来说，对于长度为 $L$ 的序列，其对数优势比得分为\n$$\nS \\;=\\; \\sum_{i=1}^{L} \\ln\\!\\left(\\frac{p_i(b_i)}{q(b_i)}\\right),\n$$\n其中 $p_i(b)$ 是位置 $i$ 处碱基 $b$ 的 PWM 概率，$q(b)$ 是背景概率。假设背景是均匀的，即 $q(A)=q(C)=q(G)=q(T)=0.25$。位置独立性近似成立，并且除了一个位置外，野生型和突变型的所有其他位置都相同。\n\n在结合位点的单个位置 $i^{\\ast}$ 处发生了一次单核苷酸替换。在此位置，野生型碱基的 PWM 概率为 $p_{i^{\\ast}}(b_{\\mathrm{wt}})=0.60$，而突变型碱基的 PWM 概率为 $p_{i^{\\ast}}(b_{\\mathrm{mut}})=0.15$。所有其他位置保持不变。在 TF 与该位点结合的平衡结合常数 $K_{a}$ 与 PWM 似然比（相对于背景）成正比的标准假设下，突变型与野生型之间的结合常数之比等于它们似然比的比值。\n\n该结合位点参与一个表现出协同 Hill 响应的增强子，其 Hill 系数 $n=2$。因此，分数激活度（相对于最大输出）为\n$$\n\\frac{E}{E_{\\max}} \\;=\\; \\frac{x^{n}}{1+x^{n}},\n$$\n其中 $x\\equiv K_{a}[\\mathrm{TF}]$ 是结合常数与 TF 浓度的无量纲乘积，并假设在野生型和突变型之间是固定的。对于感兴趣的 TF 浓度下的野生型，有效输入为 $x_{\\mathrm{wt}}=2.0$。\n\n仅使用上述定义和在独立性与背景模型下将 PWM 对数优势比得分与结合亲和力相关联的成熟原理，计算预测的突变型分数增强子激活度 $E_{\\mathrm{mut}}/E_{\\max}$。\n\n以保留四位有效数字的小数形式提供最终数值答案。不要包含单位。", "solution": "该问题提问良好且有科学依据，基于转录因子-DNA 结合和基因调控的标准生物物理模型，因此是有效的。\n\n该问题要求计算突变等位基因的分数增强子激活度 $E_{\\mathrm{mut}}/E_{\\max}$。此计算主要分三步进行：首先，确定由突变引起的转录因子（TF）结合亲和力的变化；其次，计算增强子响应函数输入的相应变化；第三，评估突变体的增强子响应。\n\n根据题意，平衡结合常数 $K_a$ 与结合位点序列在位置权重矩阵（PWM）模型下相对于背景模型的似然比成正比。突变型和野生型位点的结合常数之比被说明为等于它们各自似然比 $R_{\\mathrm{mut}}$ 和 $R_{\\mathrm{wt}}$ 的比值。\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}}\n$$\n对于长度为 $L$、碱基为 $\\{b_i\\}$ 的序列，其似然比 $R$ 定义为各位置概率比的乘积：\n$$\nR = \\prod_{i=1}^{L} \\frac{p_i(b_i)}{q(b_i)}\n$$\n其中 $p_i(b_i)$ 是来自 PWM 的位置 $i$ 处碱基 $b_i$ 的概率，$q(b_i)$ 是该碱基的背景概率。\n\n我们可以将似然比的比值 $R_{\\mathrm{mut}}/R_{\\mathrm{wt}}$ 表示为：\n$$\n\\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}} = \\frac{\\prod_{i=1}^{L} \\frac{p_i(b_{i, \\mathrm{mut}})}{q(b_{i, \\mathrm{mut}})}}{\\prod_{i=1}^{L} \\frac{p_i(b_{i, \\mathrm{wt}})}{q(b_{i, \\mathrm{wt}})}}\n$$\n题目指明，野生型和突变型序列仅在单个位置 $i^{\\ast}$ 不同。对于所有其他位置 $i \\neq i^{\\ast}$，碱基是相同的，即 $b_{i, \\mathrm{mut}} = b_{i, \\mathrm{wt}}$。因此，相应的项 $p_i(b_i)/q(b_i)$ 在分子和分母中是相同的，可以相互抵消。表达式简化为单个改变位置 $i^{\\ast}$ 的项的比值：\n$$\n\\frac{R_{\\mathrm{mut}}}{R_{\\mathrm{wt}}} = \\frac{\\frac{p_{i^{\\ast}}(b_{\\mathrm{mut}})}{q(b_{\\mathrm{mut}})}}{\\frac{p_{i^{\\ast}}(b_{\\mathrm{wt}})}{q(b_{\\mathrm{wt}})}}\n$$\n背景模型是均匀的，对于任何碱基 $b$，$q(b) = 0.25$。因此，背景概率 $q(b_{\\mathrm{mut}})$ 和 $q(b_{\\mathrm{wt}})$ 相等，也相互抵消。该比值进一步简化为仅是位置 $i^{\\ast}$ 处突变型和野生型碱基的 PWM 概率的比值：\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{p_{i^{\\ast}}(b_{\\mathrm{mut}})}{p_{i^{\\ast}}(b_{\\mathrm{wt}})}\n$$\n题目提供了所需的概率：$p_{i^{\\ast}}(b_{\\mathrm{wt}}) = 0.60$ 和 $p_{i^{\\ast}}(b_{\\mathrm{mut}}) = 0.15$。代入这些值可得：\n$$\n\\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = \\frac{0.15}{0.60} = \\frac{1}{4} = 0.25\n$$\nHill 响应函数的输入是无量纲量 $x = K_a[\\mathrm{TF}]$。由于 TF 浓度 $[\\mathrm{TF}]$ 假定为常数，突变型与野生型的输入变量之比等于它们结合常数的比值：\n$$\n\\frac{x_{\\mathrm{mut}}}{x_{\\mathrm{wt}}} = \\frac{K_{a, \\mathrm{mut}}[\\mathrm{TF}]}{K_{a, \\mathrm{wt}}[\\mathrm{TF}]} = \\frac{K_{a, \\mathrm{mut}}}{K_{a, \\mathrm{wt}}} = 0.25\n$$\n给定野生型的输入为 $x_{\\mathrm{wt}} = 2.0$。我们现在可以计算突变型的输入 $x_{\\mathrm{mut}}$：\n$$\nx_{\\mathrm{mut}} = 0.25 \\times x_{\\mathrm{wt}} = 0.25 \\times 2.0 = 0.5\n$$\n最后，我们使用给定的 Hill 方程（Hill 系数 $n=2$）和计算出的 $x_{\\mathrm{mut}}$ 值，来计算突变型的分数增强子激活度 $E_{\\mathrm{mut}}/E_{\\max}$：\n$$\n\\frac{E_{\\mathrm{mut}}}{E_{\\max}} = \\frac{x_{\\mathrm{mut}}^{n}}{1 + x_{\\mathrm{mut}}^{n}} = \\frac{(0.5)^{2}}{1 + (0.5)^{2}}\n$$\n计算此表达式：\n$$\n\\frac{E_{\\mathrm{mut}}}{E_{\\max}} = \\frac{0.25}{1 + 0.25} = \\frac{0.25}{1.25} = \\frac{1}{5} = 0.2\n$$\n题目要求答案以保留四位有效数字的小数形式表示。因此，$0.2$ 写为 $0.2000$。", "answer": "$$\n\\boxed{0.2000}\n$$", "id": "2680422"}, {"introduction": "在进化过程中，生物体的功能和表型常常表现出惊人的稳定性，但这是否意味着其背后的基因调控网络一成不变？本练习将通过一个计算模拟，让你深入探索“发育系统漂变”（developmental systems drift）这一前沿概念。你将构建一个双位点增强子的热力学模型，并模拟成对的补偿性突变如何在改变单个结合位点亲和力的同时，维持整个增强子调控输出的稳定。这个练习揭示了在表型保守的强大选择压力下，基因调控网络在序列水平上所具有的令人惊讶的演化灵活性。[@problem_id:2680488]", "problem": "要求您形式化并实现一个由单个转录因子（TF）调控的双位点脱氧核糖核酸（DNA）增强子的热力学平衡模型。目标是模拟改变两个TF结合位点结合能的成对补偿性突变所产生的影响，并计算在指定的TF浓度范围内，相对于野生型增强子，突变参数空间中能产生不变表达的区域。您的程序必须实现该模型，并评估一个有限的成对突变网格，将在规定容差范围内产生不变表达的突变进行分类。每个测试用例的最终数值结果是突变空间中产生不变表达的网格点所占的比例。所有模型参数均为无量纲，能量单位为玻尔兹曼常数乘以绝对温度（$k_{\\mathrm{B}} T$）。\n\n基本原理和定义：\n- 假设系统处于热力学平衡状态并遵循玻尔兹曼统计。一个无量纲化学势为 $\\mu$ 的TF结合到两个结合能分别为 $E_1$ 和 $E_2$（单位为 $k_{\\mathrm{B}} T$）的位点上。设两个已结合的TF分子之间的协同相互作用能为 $J$（单位为 $k_{\\mathrm{B}} T$），对于有利的协同作用，$J$ 可为正，对于拮抗作用可为负，对于独立作用则为零。\n- 无量纲化学势由 $\\mu = \\ln(c/c_0)$ 定义，参考浓度 $c_0 = 1$，因此当 $c$ 以无量纲浓度的形式提供时，$\\mu = \\ln c$。\n- 该增强子有四种占据状态：无TF结合、仅位点1结合、仅位点2结合以及两个位点均结合。这些状态的玻尔兹曼权重分别为，\n  $$\n  w_{00} = 1,\\quad\n  w_{10} = e^{\\mu - E_1},\\quad\n  w_{01} = e^{\\mu - E_2},\\quad\n  w_{11} = e^{2\\mu - E_1 - E_2 + J}.\n  $$\n  配分函数为 $Z = w_{00} + w_{10} + w_{01} + w_{11}$。\n- 将表达输出定义为至少有一个TF结合的概率（一种激活剂逻辑），即\n  $$\n  P_{\\mathrm{on}}(\\mu; E_1,E_2,J) = \\frac{w_{10} + w_{01} + w_{11}}{Z}.\n  $$\n\n成对补偿性突变：\n- 成对补偿性突变将 $(\\Delta E_1, \\Delta E_2)$ 加到野生型能量 $(E_1,E_2)$ 上，产生突变后的能量 $(E_1 + \\Delta E_1,\\, E_2 + \\Delta E_2)$，而 $J$ 在本问题中保持不变。\n- 给定一个由浓度 $\\{c_i\\}_{i=1}^{M}$ 通过 $\\mu_i = \\ln c_i$ 导出的集合 $\\{\\mu_i\\}_{i=1}^{M}$，将野生型表达谱定义为 $\\{P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J)\\}_{i=1}^{M}$，将突变表达谱定义为 $\\{P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J)\\}_{i=1}^{M}$。\n- 定义一个不变性容差 $\\varepsilon  0$。如果满足以下条件，则突变对 $(\\Delta E_1, \\Delta E_2)$ 被分类为不变的：\n  $$\n  \\max_{1 \\le i \\le M} \\left| P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J) - P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J) \\right| \\le \\varepsilon.\n  $$\n\n参数空间区域和定量输出：\n- 考虑突变空间中的一个矩形网格，其中 $\\Delta E_1 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$ 且 $\\Delta E_2 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$，在一个步长为 $h  0$ 的均匀网格上采样，包含端点。设网格点集合为 $\\mathcal{G}$，其基数为 $|\\mathcal{G}|$。\n- 一个测试用例的输出是以下比例\n  $$\n  f = \\frac{\\left|\\{(\\Delta E_1,\\Delta E_2) \\in \\mathcal{G} \\,:\\, \\text{不变性成立}\\}\\right|}{|\\mathcal{G}|},\n  $$\n  该比例必须以浮点数形式报告，并四舍五入到六位小数。\n\n测试套件：\n对于下面的每个测试用例，按规定计算 $f$。\n\n- 测试用例1（一般性协同激活剂）：\n  - 野生型参数：$E_1 = 2.0$, $E_2 = 2.0$, $J = 1.0$。\n  - 浓度：$c \\in \\{0.01, 0.1, 1.0, 10.0, 100.0\\}$，因此 $\\mu = \\{\\ln 0.01, \\ln 0.1, \\ln 1.0, \\ln 10.0, \\ln 100.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.02$。\n  - 网格：$\\Delta E_{\\min} = -3.0$, $\\Delta E_{\\max} = 3.0$, 步长 $h = 0.5$。\n\n- 测试用例2（仅具有精确不变性的边界）：\n  - 野生型参数：$E_1 = 2.0$, $E_2 = 2.0$, $J = 1.0$。\n  - 浓度：$c \\in \\{0.1, 1.0, 10.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.0$。\n  - 网格：$\\Delta E_{\\min} = -1.0$, $\\Delta E_{\\max} = 1.0$, 步长 $h = 0.5$。\n\n- 测试用例3（低占据区，独立位点）：\n  - 野生型参数：$E_1 = 3.0$, $E_2 = 3.0$, $J = 0.0$。\n  - 浓度：$c \\in \\{0.001, 0.003, 0.01\\}$。\n  - 不变性容差：$\\varepsilon = 0.005$。\n  - 网格：$\\Delta E_{\\min} = -2.0$, $\\Delta E_{\\max} = 2.0$, 步长 $h = 0.5$。\n\n- 测试用例4（强协同性）：\n  - 野生型参数：$E_1 = 2.5$, $E_2 = 2.5$, $J = 2.0$。\n  - 浓度：$c \\in \\{0.2, 0.5, 1.0, 2.0, 5.0\\}$。\n  - 不变性容差：$\\varepsilon = 0.02$。\n  - 网格：$\\Delta E_{\\min} = -2.0$, $\\Delta E_{\\max} = 2.0$, 步长 $h = 0.25$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个结果，以逗号分隔并用方括号括起，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是测试用例 $i$ 的比例 $f$，四舍五入到六位小数，无附加文本。不应打印任何物理单位。不涉及角度。百分比必须以小数形式表示，而不是使用百分号。", "solution": "所提出的问题是计算生物物理学中一个明确定义的练习，它要求将统计力学应用于一个基因调控模型。该模型基于热力学平衡，是理解此类系统定量行为的标准且科学上合理的方法。所有参数、定义和目标都以数学精度指定，使得问题完全确定且无歧义。任务是根据所提供的模型形式化一个算法，并针对几个测试用例执行它。该问题是有效的。\n\n模型的核心是计算一个双位点增强子被至少一个转录因子（TF）占据的概率，该概率可作为基因表达水平的代理指标。这个概率 $P_{\\mathrm{on}}$ 是TF化学势 $\\mu$ 和系统能量参数（两个位点的结合能 $E_1$ 和 $E_2$，以及协同相互作用能 $J$）的函数。\n\n系统可以存在于四种不同的状态，由两个结合位点的占据情况定义。每个状态的玻尔兹曼权重（与其概率成正比）由其相对于参考状态（未结合）的能量决定。无量纲化学势由 $\\mu = \\ln c$ 给出，其中 $c$ 是无量纲的TF浓度。这些状态及其相应的玻尔兹曼权重如下：\n-   状态 $(0,0)$（未结合）：权重 $w_{00} = 1$。\n-   状态 $(1,0)$（位点1结合）：权重 $w_{10} = e^{\\mu - E_1}$。\n-   状态 $(0,1)$（位点2结合）：权重 $w_{01} = e^{\\mu - E_2}$。\n-   状态 $(1,1)$（两个位点均结合）：权重 $w_{11} = e^{2\\mu - E_1 - E_2 + J}$。\n\n配分函数 $Z$ 是这些权重的总和，代表了状态概率分布的归一化常数：\n$$\nZ(\\mu; E_1, E_2, J) = 1 + e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}\n$$\n表达输出 $P_{\\mathrm{on}}$ 是系统处于除未结合状态外的任何状态的概率。这对应于一种激活剂逻辑，即至少一个TF分子的结合导致表达。\n$$\nP_{\\mathrm{on}}(\\mu; E_1,E_2,J) = \\frac{e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}}{1 + e^{\\mu-E_1} + e^{\\mu-E_2} + e^{2\\mu - E_1 - E_2 + J}}\n$$\n该问题研究成对补偿性突变的影响，这些突变将结合能从野生型值 $(E_1, E_2)$ 改变为突变状态 $(E_1 + \\Delta E_1, E_2 + \\Delta E_2)$。协同性 $J$ 假定为常数。目标是找到在一组指定的 $M$ 个TF化学势 $\\{\\mu_i\\}_{i=1}^M$ 范围内能保持表达谱不变的突变 $(\\Delta E_1, \\Delta E_2)$。\n\n如果在所有指定的化学势下，突变表达谱和野生型表达谱之间的最大绝对差值在给定的容差 $\\varepsilon$ 之内，则该突变被认为是“不变的”。\n$$\n\\max_{1 \\le i \\le M} \\left| P_{\\mathrm{on}}(\\mu_i; E_1+\\Delta E_1, E_2+\\Delta E_2, J) - P_{\\mathrm{on}}(\\mu_i; E_1,E_2,J) \\right| \\le \\varepsilon\n$$\n计算任务是在一个离散的参数空间内量化此类不变突变的区域。该空间是一个均匀的 $(\\Delta E_1, \\Delta E_2)$ 值网格，其中 $\\Delta E_1, \\Delta E_2 \\in [\\Delta E_{\\min}, \\Delta E_{\\max}]$ 且步长为 $h$。最终输出是满足不变性标准的网格点所占的比例 $f$。\n\n为每个测试用例计算 $f$ 的算法如下：\n\n1.  **初始化**：定义测试用例的参数：野生型能量 $(E_1, E_2, J)$，浓度集合 $\\{c_i\\}$，容差 $\\varepsilon$，以及网格参数 $(\\Delta E_{\\min}, \\Delta E_{\\max}, h)$。\n\n2.  **野生型表达谱计算**：\n    a. 使用关系式 $\\mu_i = \\ln(c_i)$ 将浓度 $\\{c_i\\}$ 转换为化学势 $\\{\\mu_i\\}$。\n    b. 使用 $P_{\\mathrm{on}}$ 的公式计算野生型表达水平的向量 $\\vec{P}_{\\mathrm{wt}} = [P_{\\mathrm{on}}(\\mu_1; E_1,E_2,J), \\dots, P_{\\mathrm{on}}(\\mu_M; E_1,E_2,J)]$。\n\n3.  **网格生成**：\n    a. 为单个能量参数构建一维突变值集合。该集合由范围 $[\\Delta E_{\\min}, \\Delta E_{\\max}]$ 和步长 $h$ 定义，包括端点。点的数量为 $N = (\\Delta E_{\\max} - \\Delta E_{\\min}) / h + 1$。\n    b. 二维网格 $\\mathcal{G}$ 中的总点数为 $|\\mathcal{G}| = N^2$。\n\n4.  **迭代搜索**：\n    a. 初始化一个不变点计数器，$C_{\\mathrm{inv}} = 0$。\n    b. 遍历网格 $\\mathcal{G}$ 中的每个点 $(\\Delta E_1, \\Delta E_2)$。\n    c. 对于每个点：\n        i.  计算突变后的能量：$E'_1 = E_1 + \\Delta E_1$ 和 $E'_2 = E_2 + \\Delta E_2$。\n        ii. 计算突变表达水平的向量 $\\vec{P}_{\\mathrm{mut}} = [P_{\\mathrm{on}}(\\mu_1; E'_1, E'_2, J), \\dots, P_{\\mathrm{on}}(\\mu_M; E'_1, E'_2, J)]$。\n        iii. 计算最大绝对偏差：$d_{\\max} = \\max_i |P_{\\mathrm{mut},i} - P_{\\mathrm{wt},i}|$。\n        iv. 如果 $d_{\\max} \\le \\varepsilon$，则增加计数器：$C_{\\mathrm{inv}} = C_{\\mathrm{inv}} + 1$。\n\n5.  **最终计算**：\n    a. 计算不变点的比例：$f = C_{\\mathrm{inv}} / |\\mathcal{G}|$。\n    b. 对四个指定的测试用例中的每一个重复此过程。\n\n该算法在提供的Python代码中实现，利用 `numpy` 库来高效地进行表达谱及其差异的向量化计算。", "answer": "[0.124260,0.200000,0.209877,0.114187]", "id": "2680488"}]}