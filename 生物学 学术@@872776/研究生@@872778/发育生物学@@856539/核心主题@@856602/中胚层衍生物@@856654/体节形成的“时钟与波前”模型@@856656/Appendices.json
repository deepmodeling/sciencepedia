{"hands_on_practices": [{"introduction": "模型的“波前”部分在物理上是由一个在体节前中胚层中后退的形态发生素梯度实现的。第一个练习将挑战你从扩散和降解的基本原理出发，推导出该梯度的数学形式 [@problem_id:2679229]。理解这一推导过程是掌握发育中组织如何建立和维持位置信息的关键。", "problem": "体节发生的时钟-波前模型的一个核心要素是体节前中胚层 (PSM) 中存在一个从后向前的分子梯度，这通常被归因于成纤维细胞生长因子 (FGF)。考虑一个沿着前后 (A–P) 轴的一维组织坐标 $x \\ge 0$，其中尾芽位于 $x=0$ 处。成纤维细胞生长因子 (FGF) 在 $x=0$ 处产生，以扩散系数 $D$ 扩散到 PSM 中，并以速率常数 $k$ 通过一级动力学被均匀降解。假设系统在组织框架中已达到稳态，并且尾芽作为一个恒定源，向 PSM 施加一个固定的产生通量 $J_{0}$。远离源头时，浓度趋于零。\n\n仅从 (i) 质量守恒、(ii) 菲克扩散定律和 (iii) 一级降解动力学出发，推导出稳态浓度分布 $c(x)$，并确定控制该分布空间衰减的特征长度尺度。然后，在时钟-波前模型的背景下，定义 FGF 浓度等于固定阈值 $c_{\\mathrm{th}}$ 的位置 $x^{\\ast}$，并用特征长度尺度和边界量来表示 $x^{\\ast}$。最后，从生物学角度解释这个特征长度尺度对于 PSM 中的 FGF 梯度代表什么，以及它如何限制波前的位置。\n\n你的最终答案必须是特征长度尺度的闭式解析表达式。最终答案中不要包含任何单位。", "solution": "所述问题具有科学依据、适定且客观。它呈现了一个标准的反应-扩散情景，这是数学生物学中建模形态发生素梯度的基石。所提供的所有数据和条件都是一致且充分的，足以推导出一个唯一且有意义的解。因此，该问题被认为是有效的。\n\n我们开始进行推导。问题要求我们推导成纤维细胞生长因子 (FGF) 沿着一维组织轴 $x \\ge 0$ 的稳态浓度分布 $c(x)$。推导必须从三个基本原理出发：(i) 质量守恒，(ii) 菲克扩散定律，以及 (iii) 一级降解动力学。\n\n让我们考虑一个位于位置 $x$ 和 $x+\\Delta x$ 之间，长度为 $\\Delta x$、均匀横截面积为 $A$ 的一维微小控制体积。该体积中 FGF 的总量为 $c(x,t) A \\Delta x$。\n\n质量守恒原理指出，控制体积中物质总量的变化率等于流入该体积的净通量减去因降解而移除的速率。\n质量的变化率为 $\\frac{\\partial}{\\partial t} (c A \\Delta x)$。\n在位置 $x$ 处流入该体积的 FGF 通量为 $J(x,t) A$，在位置 $x+\\Delta x$ 处流出该体积的通量为 $J(x+\\Delta x, t) A$。因此，流入该体积的净通量为 $(J(x,t) - J(x+\\Delta x,t))A$。\nFGF 通过一级动力学降解，速率常数为 $k$。因此，从该体积中移除的速率为 $(k c) A \\Delta x$。\n\n结合这些项，质量平衡方程为：\n$$ \\frac{\\partial}{\\partial t} (c A \\Delta x) = (J(x,t) - J(x+\\Delta x,t))A - k c A \\Delta x $$\n两边同除以体积 $A \\Delta x$ 并整理得到：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{J(x+\\Delta x,t) - J(x,t)}{\\Delta x} - k c $$\n取 $\\Delta x \\to 0$ 的极限，我们得到一维反应-扩散方程的一般形式：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial J}{\\partial x} - k c $$\n接下来，我们应用菲克第一扩散定律，它将通量 $J$ 与浓度梯度联系起来：\n$$ J = -D \\frac{\\partial c}{\\partial x} $$\n其中 $D$ 是扩散系数。将菲克定律代入质量平衡方程得到：\n$$ \\frac{\\partial c}{\\partial t} = - \\frac{\\partial}{\\partial x} \\left(-D \\frac{\\partial c}{\\partial x}\\right) - k c = D \\frac{\\partial^2 c}{\\partial x^2} - k c $$\n问题指明系统已达到稳态，这意味着浓度不再随时间变化。因此，$\\frac{\\partial c}{\\partial t} = 0$。这使得控制方程简化为一个二阶常微分方程 (ODE)：\n$$ D \\frac{d^2 c}{d x^2} - k c = 0 $$\n$$ \\frac{d^2 c}{d x^2} - \\frac{k}{D} c = 0 $$\n这个方程描述了稳态浓度分布。为求解该方程，我们定义一个具有长度量纲的参数 $\\lambda$，即 $\\lambda = \\sqrt{\\frac{D}{k}}$。现在，该常微分方程可以写成更紧凑的形式：\n$$ \\frac{d^2 c}{d x^2} - \\frac{1}{\\lambda^2} c = 0 $$\n这是一个齐次线性二阶常系数常微分方程。其特征方程为 $r^2 - \\frac{1}{\\lambda^2} = 0$，根为 $r = \\pm \\frac{1}{\\lambda}$。因此，通解为：\n$$ c(x) = C_1 \\exp\\left(\\frac{x}{\\lambda}\\right) + C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n其中 $C_1$ 和 $C_2$ 是待由边界条件确定的积分常数。\n\n第一个边界条件是浓度在远离源头处趋于零：当 $x \\to \\infty$ 时，$c(x) \\to 0$。为使此条件成立，带有正指数的项 $\\exp(x/\\lambda)$ 必须为零，因为它在 $x \\to \\infty$ 时会无界增长。这要求常数 $C_1$ 必须为 $0$。解简化为：\n$$ c(x) = C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n第二个边界条件是在源头 $x=0$ 处有一个恒定的产生通量 $J_0$。通量 $J(x)$ 由菲克定律给出：\n$$ J(x) = -D \\frac{dc}{dx} = -D \\frac{d}{dx} \\left( C_2 \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = -D \\left( -\\frac{C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) \\right) = \\frac{D C_2}{\\lambda} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n在 $x=0$ 处，通量为 $J(0) = J_0$：\n$$ J_0 = \\frac{D C_2}{\\lambda} $$\n求解常数 $C_2$ 得到：\n$$ C_2 = \\frac{J_0 \\lambda}{D} $$\n将其代回 $c(x)$ 的解中，我们得到最终的稳态浓度分布：\n$$ c(x) = \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x}{\\lambda}\\right) $$\n从这个推导中，可以立即确定控制该分布空间衰减的特征长度尺度为：\n$$ \\lambda = \\sqrt{\\frac{D}{k}} $$\n这个长度尺度从控制常微分方程的无量纲化中自然产生，并决定了浓度衰减为 $e^{-1}$ 倍时所经过的距离。\n\n接下来，我们将波前的位置 $x^{\\ast}$ 定义为 FGF 浓度等于一个固定阈值 $c_{\\mathrm{th}}$ 的位置。我们令 $c(x^{\\ast}) = c_{\\mathrm{th}}$：\n$$ \\frac{J_0 \\lambda}{D} \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = c_{\\mathrm{th}} $$\n为了求解 $x^{\\ast}$，我们首先分离指数项：\n$$ \\exp\\left(-\\frac{x^{\\ast}}{\\lambda}\\right) = \\frac{c_{\\mathrm{th}} D}{J_0 \\lambda} $$\n对两边取自然对数：\n$$ -\\frac{x^{\\ast}}{\\lambda} = \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) $$\n$$ x^{\\ast} = -\\lambda \\ln\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right) = \\lambda \\ln\\left(\\left(\\frac{c_{\\mathrm{th}} D}{J_0 \\lambda}\\right)^{-1}\\right) $$\n因此，波前的位置是：\n$$ x^{\\ast} = \\lambda \\ln\\left(\\frac{J_0 \\lambda}{c_{\\mathrm{th}} D}\\right) $$\n项 $\\frac{J_0 \\lambda}{D}$ 是源头处的浓度 $c(0)$，我们可以将其表示为 $c_0$。$x^{\\ast}$ 的表达式可以更清晰地写为 $x^{\\ast} = \\lambda \\ln(c_0 / c_{\\mathrm{th}})$，这明确显示了它对特征长度尺度 $\\lambda$ 以及源头浓度与阈值浓度之比的依赖关系。\n\n最后，我们提供生物学解释。特征长度尺度 $\\lambda = \\sqrt{D/k}$ 是形态发生素梯度的一个基本参数。它代表了一个在尾芽处产生的 FGF 分子在被降解前通常扩散的距离。较大的 $\\lambda$（由于高扩散系数 $D$ 或低降解速率 $k$）会导致一个平缓的梯度，延伸到体节前中胚层 (PSM) 的深处。较小的 $\\lambda$（由于低扩散系数 $D$ 或高降解速率 $k$）则导致一个陡峭且局域化的梯度。在时钟-波前模型的背景下，体节发生的波前被假定为 FGF 浓度下降到临界阈值 $c_{\\mathrm{th}}$ 以下的位置。我们推导出的表达式 $x^{\\ast} = \\lambda \\ln(c_0/c_{\\mathrm{th}})$ 表明，这个波前的位置与特征长度尺度 $\\lambda$ 成正比。因此，$\\lambda$ 不仅仅是一个抽象的数学参数；它是组织系统的一个物理性质，直接限制了位置信息。任何改变 FGF 扩散或降解速率的遗传或环境因素都将改变 $\\lambda$，从而改变波前的位置，进而影响所形成体节的大小和位置。\n\n问题明确要求给出特征长度尺度的闭式解析表达式。", "answer": "$$ \\boxed{\\sqrt{\\frac{D}{k}}} $$", "id": "2679229"}, {"introduction": "“时钟”部分指的是单个细胞内基因表达的周期性振荡。本练习通过将一个分子振荡器建模为一个带有延迟负反馈的基因，深入探讨其核心机制 [@problem_id:2679227]。通过进行稳定性分析，你将确定这个简单回路从稳态转变为持续振荡的精确条件，从而为体节分割时钟提供一个具体的理论基础。", "problem": "在体节形成的时钟-波前模型中，基因产物的细胞内振荡通常通过由转录、翻译和延迟自动抑制引起的延迟负反馈来建模。考虑一个用于描述蛋白质浓度 $p(t)$ 的单基因延迟负反馈模型，该模型由以下延迟微分方程 (DDE) 给出：\n$$\n\\dot{p}(t) \\;=\\; \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} \\;-\\; \\gamma\\, p(t),\n$$\n其中 $\\beta \\!>\\! 0$ 是最大生产速率，$K \\!>\\! 0$ 是半饱和常数，$n \\!>\\! 1$ 是希尔系数，$\\gamma \\!>\\! 0$ 是一级降解速率，$\\tau \\!>\\! 0$ 是一个有效的转录-翻译-反馈延迟。令 $p^{\\ast}$ 表示满足 $\\dot{p}(t)=0$ 的一个稳态。\n\n从延迟微分方程稳定性分析的基本原理出发，对稳态 $p^{\\ast}$ 进行线性化，并应用霍普夫分岔的定义（出现一对纯虚特征值），以获得发生霍普夫分岔的最小正临界延迟 $\\tau_{c}$ 的闭式表达式。你的推导应从线性化过程和 DDE 的特征方程开始，并应确定纯虚根存在的必要相容性条件。将你的最终结果 $\\tau_{c}$ 用模型参数 $\\gamma$、$K$、$n$ 和稳态值 $p^{\\ast}$ 表示；角度必须以弧度表示。最终答案必须是单个闭式解析表达式。不要报告任何不等式；只报告 $\\tau_{c}$ 的表达式。", "solution": "问题陈述具有科学依据、是适定的且客观的。它提供了一个标准的生物振荡器延迟微分方程模型，并要求使用已有的稳定性分析方法推导霍普夫分岔的临界延迟。所有必要的参数和条件都已定义。该问题是有效的。\n\n我们从蛋白质浓度 $p(t)$ 的延迟微分方程 (DDE) 开始：\n$$ \\frac{d p}{dt} = \\frac{\\beta}{1 + \\left(\\frac{p(t-\\tau)}{K}\\right)^{n}} - \\gamma p(t) $$\n参数 $\\beta$、$K$、$n$、$\\gamma$ 和 $\\tau$ 均为正常数，且 $n > 1$。\n\n首先，我们确定稳态 $p^{\\ast}$。稳态是一个常数解，因此 $p(t) = p(t-\\tau) = p^{\\ast}$ 且 $\\frac{dp}{dt} = 0$。将这些代入 DDE，得到稳态条件：\n$$ 0 = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} - \\gamma p^{\\ast} \\quad \\implies \\quad \\gamma p^{\\ast} = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n问题要求最终答案用 $p^{\\ast}$ 表示，所以我们不需要解此方程求出 $p^{\\ast}$。\n\n接下来，我们在稳态 $p^{\\ast}$ 附近进行线性稳定性分析。令 $p(t) = p^{\\ast} + x(t)$，其中 $x(t)$ 代表一个小扰动。将此代入 DDE 得到：\n$$ \\frac{d}{dt}(p^{\\ast} + x(t)) = \\frac{\\beta}{1 + \\left(\\frac{p^{\\ast} + x(t-\\tau)}{K}\\right)^{n}} - \\gamma(p^{\\ast} + x(t)) $$\n左边是 $\\frac{dx}{dt}$。令非线性生产项为 $f(p) = \\frac{\\beta}{1 + (p/K)^{n}}$。我们在 $p^{\\ast}$ 附近对 $f(p(t-\\tau))$ 进行一阶泰勒展开：\n$$ f(p^{\\ast} + x(t-\\tau)) \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) $$\n完整的方程变为：\n$$ \\frac{dx}{dt} \\approx f(p^{\\ast}) + f'(p^{\\ast}) x(t-\\tau) - \\gamma p^{\\ast} - \\gamma x(t) $$\n根据稳态条件，$f(p^{\\ast}) = \\gamma p^{\\ast}$。这些项相互抵消，剩下线性化的 DDE：\n$$ \\frac{dx}{dt} = f'(p^{\\ast}) x(t-\\tau) - \\gamma x(t) $$\n我们必须计算导数 $f'(p^{\\ast})$。$f(p)$ 的导数是：\n$$ f'(p) = \\frac{d}{dp}\\left[\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-1}\\right] = -\\beta \\left(1 + \\left(\\frac{p}{K}\\right)^{n}\\right)^{-2} \\cdot n\\left(\\frac{p}{K}\\right)^{n-1} \\cdot \\frac{1}{K} $$\n$$ f'(p) = -\\frac{\\beta n}{K} \\frac{(p/K)^{n-1}}{(1+(p/K)^{n})^{2}} $$\n使用稳态关系式 $\\beta = \\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n})$，我们代入 $\\beta$ 以用其他参数表示 $f'(p^{\\ast})$：\n$$ f'(p^{\\ast}) = -\\frac{\\gamma p^{\\ast} (1 + (p^{\\ast}/K)^{n}) n}{K} \\frac{(p^{\\ast}/K)^{n-1}}{(1+(p^{\\ast}/K)^{n})^{2}} = -\\frac{\\gamma n p^{\\ast}}{K} \\frac{(p^{\\ast}/K)^{n-1}}{1+(p^{\\ast}/K)^{n}} = -\\frac{\\gamma n (p^{\\ast}/K)^{n}}{1+(p^{\\ast}/K)^{n}} $$\n由于所有参数和 $p^{\\ast}$ 都是正的，且 $n > 1$，所以项 $f'(p^{\\ast})$ 是负的。我们定义一个正常数 $A = -f'(p^{\\ast})$，代表负反馈的强度：\n$$ A = \\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n现在的线性化 DDE 是 $\\frac{dx}{dt} = -A x(t-\\tau) - \\gamma x(t)$。\n\n为了找到稳态的稳定性，我们分析特征方程。我们寻求形式为 $x(t) \\propto \\exp(\\lambda t)$ 的解。将此拟设代入线性化方程：\n$$ \\lambda e^{\\lambda t} = -A e^{\\lambda(t-\\tau)} - \\gamma e^{\\lambda t} $$\n两边除以 $e^{\\lambda t}$，得到特征值 $\\lambda$ 的特征方程：\n$$ \\lambda + \\gamma + A e^{-\\lambda \\tau} = 0 $$\n当一对复共轭特征值穿过虚轴时，发生霍普夫分岔。在分岔点，存在一对纯虚特征值 $\\lambda = \\pm i\\omega_c$，其中 $\\omega_c > 0$ 是临界频率。将 $\\lambda = i\\omega_c$ 代入特征方程：\n$$ i\\omega_c + \\gamma + A e^{-i\\omega_c \\tau_c} = 0 $$\n使用欧拉恒等式 $e^{-i\\theta} = \\cos(\\theta) - i\\sin(\\theta)$，我们得到：\n$$ i\\omega_c + \\gamma + A(\\cos(\\omega_c \\tau_c) - i\\sin(\\omega_c \\tau_c)) = 0 $$\n分离实部和虚部，得到一个包含两个方程的方程组：\n$$ \\text{实部：} \\quad \\gamma + A\\cos(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\cos(\\omega_c \\tau_c) = -\\frac{\\gamma}{A} $$\n$$ \\text{虚部：} \\quad \\omega_c - A\\sin(\\omega_c \\tau_c) = 0 \\quad \\implies \\quad \\sin(\\omega_c \\tau_c) = \\frac{\\omega_c}{A} $$\n为了使解存在，我们使用恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$ \\left(-\\frac{\\gamma}{A}\\right)^2 + \\left(\\frac{\\omega_c}{A}\\right)^2 = 1 \\implies \\frac{\\gamma^2}{A^2} + \\frac{\\omega_c^2}{A^2} = 1 $$\n$$ \\omega_c^2 + \\gamma^2 = A^2 \\implies \\omega_c^2 = A^2 - \\gamma^2 $$\n对于一个非零实频率 $\\omega_c$，我们必须有 $A^2 > \\gamma^2$，即 $A > \\gamma$。因此，临界频率为 $\\omega_c = \\sqrt{A^2 - \\gamma^2}$。\n\n为了求出临界延迟 $\\tau_c$，我们使用余弦和正弦的方程。从符号来看，$\\cos(\\omega_c \\tau_c)  0$ 且 $\\sin(\\omega_c \\tau_c) > 0$，角度 $\\omega_c \\tau_c$ 必须位于第二象限。我们可以使用反余弦函数来求解该角度，其主值范围是 $[0, \\pi]$。该条件正确地将角度置于 $(\\pi/2, \\pi)$ 内。\n$$ \\omega_c \\tau_c = \\arccos\\left(-\\frac{\\gamma}{A}\\right) + 2k\\pi $$\n其中 $k$ 是一个整数 $k \\ge 0$。最小的正延迟 $\\tau_c$ 对应于 $k=0$：\n$$ \\tau_c = \\frac{1}{\\omega_c} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\n代入 $\\omega_c = \\sqrt{A^2 - \\gamma^2}$：\n$$ \\tau_c = \\frac{1}{\\sqrt{A^2 - \\gamma^2}} \\arccos\\left(-\\frac{\\gamma}{A}\\right) $$\n最后，我们将 $A$ 的表达式代入，以获得 $\\tau_c$ 的最终闭式解，该解由模型参数表示。\n分母是：\n$$ \\sqrt{A^2 - \\gamma^2} = \\sqrt{\\left(\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)^2 - \\gamma^2} = \\gamma \\sqrt{\\frac{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n}}{\\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} - 1} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{n^2\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - \\left(1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}\\right)^2} $$\n$$ = \\frac{\\gamma}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1} $$\n反余弦函数的参数是：\n$$ -\\frac{\\gamma}{A} = -\\frac{\\gamma}{\\frac{\\gamma n \\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}} = -\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}} $$\n将这些结合起来得到 $\\tau_c$ 的表达式：\n$$ \\tau_c = \\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^2-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right) $$\n这就是发生霍普夫分岔的最小正临界延迟的最终表达式。", "answer": "$$\\boxed{\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{\\gamma \\sqrt{\\left(n^{2}-1\\right)\\left(\\frac{p^{\\ast}}{K}\\right)^{2n} - 2\\left(\\frac{p^{\\ast}}{K}\\right)^{n} - 1}} \\arccos\\left(-\\frac{1+\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}{n\\left(\\frac{p^{\\ast}}{K}\\right)^{n}}\\right)}$$", "id": "2679227"}, {"introduction": "时钟波前模型的精妙之处在于其两个组成部分相互作用，从而产生空间周期性模式。最后一个练习将从解析理论转向计算实践，要求你建立一个仿真模型，将FGF梯度（波前）和振荡信号（时钟）结合起来 [@problem_id:2679198]。通过测试梯度陡峭度和时钟振幅等参数如何影响最终的基因表达条带，你将亲身体验计算建模在发育生物学中的预测能力。", "problem": "设计并实现一个独立的数值程序，该程序在一个最小且生物学上合理的 Mesp2 条带形成的时钟-波前框架模型下，计算 Mesp2 表达条带的半峰全宽 (FWHM)，该宽度是成纤维细胞生长因子 (FGF) 梯度陡峭度和时钟振荡幅度的函数。程序必须为每个测试用例生成一个 FWHM 值，并将结果汇总到如下指定的单行列表中。\n\n模型假设、定义和要求：\n- 生物学背景和最小数学模型：在体节前中胚层中，FGF（成纤维细胞生长因子，FGF）蛋白形成一个从后到前的梯度，该梯度抑制 Mesp2，而分节时钟通过振荡的 Notch 信号周期性地激活靶基因。我们将固定时间的 Mesp2 表达的稳态快照建模为一个抑制项和一个激活项的乘法积分，这捕捉了一个逻辑“与”门，即需要低 FGF 和一个允许性的时钟状态。\n- 空间域：使用一维胚胎轴，位置 $x \\in [0,L]$，其中 $x=0$ 为后端，$x=L$ 为前端。除非明确说明，否则所有量均视为无单位。角度必须使用弧度。\n- FGF 梯度：设 FGF 浓度为 $F(x) = F_0 \\exp(-s x)$，其中 $F_0$ 是后端浓度，$s$ 是梯度陡峭度参数，将在不同测试用例中变化。\n- FGF 对 Mesp2 的抑制：设抑制作用被建模为一个希尔型抑制解除因子\n$$\nR(F) = \\frac{1}{1 + \\left(\\frac{F}{K_f}\\right)^{n_f}},\n$$\n其中 $K_f$ 是 FGF 半效应浓度，$n_f$ 是代表协同性的希尔系数。\n- 时钟驱动的激活：设瞬时时钟驱动为一个半波整流余弦\n$$\nC(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right),\n$$\n其中 $A$ 是振荡幅度，将在不同测试用例中变化，$q$ 是空间波数，$\\phi_0$ 是相位偏移。通过一个希尔函数对转录激活进行建模\n$$\nH(C) = \\begin{cases}\n\\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}},  C  0, \\\\\n0,  C \\le 0,\n\\end{cases}\n$$\n激活阈值为 $K_c$，希尔系数为 $n_c$。\n- Mesp2 快照：将固定时间的瞬时 Mesp2 表达谱定义为\n$$\nM(x) = H(C(x)) \\cdot R(F(x)).\n$$\n- 决定前沿：将决定前沿定义为位置 $x_{\\mathrm{df}}$，在该位置 $R(F(x_{\\mathrm{df}})) = \\tfrac{1}{2}$，等效于 $F(x_{\\mathrm{df}}) = K_f$。在指数梯度下，这等于\n$$\nx_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}.\n$$\n- 条带识别与 FWHM：在 $[0,L]$ 上 $M(x)$ 的所有局部最大值中，选择位置最接近 $x_{\\mathrm{df}}$ 的峰。设其峰值为 $M_{\\max}$。将半峰全宽 (FWHM) 定义为峰两侧 $M(x)$ 穿过 $\\tfrac{1}{2} M_{\\max}$ 的两个最近点之间的空间距离，该距离通过相邻采样点之间的线性插值获得。如果 $M(x)$ 没有局部最大值或 $M_{\\max} = 0$，则将 FWHM 定义为 $0$。\n- 数值方法要求：\n    - 在 $[0,L]$ 上使用一个包含 $N$ 个点的均匀网格，其中 $N$ 足够大，以解析条带并通过插值稳健地计算 FWHM。\n    - 所有三角计算均使用弧度。\n    - 仅使用下面指定的常数，并在整个测试套件中仅改变 $(s,A)$。\n\n所有模拟中使用的常数：\n- 空间域长度：$L = 5$。\n- 后端 FGF：$F_0 = 1$。\n- FGF 希尔参数：$K_f = 0.2$，$n_f = 4$。\n- 时钟空间波数和相位：$q = 2\\pi$，$\\phi_0 = 0$。\n- 时钟希尔参数：$K_c = 0.5$，$n_c = 3$。\n- 网格分辨率：$N = 10001$。\n\n测试套件：\n- 用例 $1$：$(s, A) = (1.0, 0.6)$。\n- 用例 $2$：$(s, A) = (2.0, 0.6)$。\n- 用例 $3$：$(s, A) = (0.5, 0.6)$。\n- 用例 $4$：$(s, A) = (1.0, 0.2)$。\n- 用例 $5$：$(s, A) = (1.0, 1.2)$。\n- 用例 $6$：$(s, A) = (1.0, 0.0)$。\n\n输出规格：\n- 对于每个测试用例，计算如上定义的 FWHM，并将其报告为一个四舍五入到 $4$ 位小数的浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[w1,w2,w3,w4,w5,w6]”）。\n\n答案格式：\n- 最终答案必须是一个完整的、可独立运行的 Python 程序，该程序按原样运行并以指定格式精确打印一行输出。", "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于发育生物学中已建立的时钟-波前模型，问题提法良好，所有必需的参数和函数都得到了清晰的定义，并且其表述是客观的。该问题是一项重要的计算任务，没有矛盾、歧义或伪深奥的主张。因此，我将继续提供完整的解决方案。\n\n目标是计算模拟的 Mesp2 基因表达条带的半峰全宽 (FWHM)。该模型描述了沿一维胚胎轴 $x \\in [0, L]$ 在一个固定时间点的 Mesp2 表达谱 $M(x)$，其中 $x=0$ 是后端，$x=L$ 是前端。\n\n该模型被构建为一个抑制项和一个激活项的乘法积分，代表一个逻辑与门，即基因表达必须同时满足两个条件——从抑制中解除和存在激活信号。\n\n1.  **FGF 介导的抑制**：成纤维细胞生长因子 (FGF) 形成一个从后到前的梯度，建模为指数衰减：\n    $$\n    F(x) = F_0 \\exp(-s x)\n    $$\n    其中 $F_0$ 是后端 ($x=0$) 的浓度，$s$ 是梯度的陡峭度。FGF 抑制 Mesp2。这种效应被建模为一个抑制解除项 $R(F)$，它是一个 S 型的希尔型函数。在 FGF 浓度低的地方，Mesp2 的表达被允许。这种抑制解除的空间分布是：\n    $$\n    R(x) = \\frac{1}{1 + \\left(\\frac{F(x)}{K_f}\\right)^{n_f}} = \\frac{1}{1 + \\left(\\frac{F_0 \\exp(-s x)}{K_f}\\right)^{n_f}}\n    $$\n    这里，$K_f$ 是 FGF 产生半最大抑制效应时的浓度，$n_f$ 是描述响应协同性（陡峭度）的希尔系数。对于大的 $F(x)$（在小的 $x$ 处），该函数接近 $0$，而对于小的 $F(x)$（在大的 $x$ 处），该函数接近 $1$。\n\n2.  **时钟驱动的激活**：周期性的分节时钟提供一个空间振荡的激活信号。与时钟相关的激活剂的瞬时局部浓度被建模为一个半波整流余弦函数：\n    $$\n    C(x) = \\max\\left(0, A \\cos(q x + \\phi_0)\\right)\n    $$\n    其中 $A$ 是振荡的幅度，$q$ 是空间波数，$\\phi_0$ 是相位偏移。Mesp2 被此信号转录激活的过程由另一个希尔函数 $H(C)$ 建模：\n    $$\n    H(C) = \\begin{cases}\n    \\frac{1}{1 + \\left(\\frac{K_c}{C}\\right)^{n_c}},  C  0 \\\\\n    0,  C \\le 0\n    \\end{cases}\n    $$\n    其中 $K_c$ 是达到半最大激活所需的激活剂浓度，$n_c$ 是希尔系数。\n\n3.  **Mesp2 表达谱**：最终的 Mesp2 表达谱 $M(x)$ 是激活项和抑制解除项的乘积：\n    $$\n    M(x) = H(C(x)) \\cdot R(x)\n    $$\n    该表达谱只会在 $R(x)$ 远大于 $0$（前端区域）并且 $H(C(x))$ 远大于 $0$（在时钟振荡的正相位内）的地方表现出清晰的表达条带。\n\n计算 FWHM 的数值步骤如下：\n\n首先，我们定义空间网格。将域 $[0, L]$ 离散化为 $N$ 个点，$x_i = i \\cdot \\Delta x$，$i = 0, 1, \\dots, N-1$，其中 $\\Delta x = L/(N-1)$。所有模拟均使用以下常数：$L=5$，$F_0=1$，$K_f=0.2$，$n_f=4$，$q=2\\pi$，$\\phi_0=0$，$K_c=0.5$，$n_c=3$，以及 $N=10001$。\n\n对于每个由一对参数 $(s, A)$ 定义的测试用例：\n1.  **计算表达谱**：对网格上的所有点 $x_i$，计算函数 $F(x_i)$、$R(x_i)$、$C(x_i)$、$H(C(x_i))$ 和 $M(x_i)$ 的值。\n2.  **定位决定前沿**：决定前沿 $x_{\\mathrm{df}}$ 是一个参考位置，定义为 FGF 抑制被解除一半的点，即 $R(x_{\\mathrm{df}}) = \\tfrac{1}{2}$。这对应于 $F(x_{\\mathrm{df}}) = K_f$。求解 $x$ 可得：\n    $$\n    x_{\\mathrm{df}} = \\frac{\\ln\\left(\\frac{F_0}{K_f}\\right)}{s}\n    $$\n3.  **寻找并选择峰**：在计算出的 Mesp2 表达谱 $M(x_i)$ 中识别所有局部最大值。如果 $M_i  M_{i-1}$ 且 $M_i  M_{i+1}$，则索引为 $i$ 的点是局部最大值。从所有找到的峰中，我们选择空间位置最接近计算出的决定前沿 $x_{\\mathrm{df}}$ 的那个峰。设该峰的索引为 $i_{\\text{peak}}$，其位置为 $x_{\\text{peak}}$，其值为 $M_{\\max} = M(x_{\\text{peak}})$。如果没有找到峰或者 $M_{\\max}=0$，则 FWHM 定义为 $0$。\n4.  **计算 FWHM**：FWHM 是条带在其最大高度一半处的宽度，$M_{\\text{hm}} = \\tfrac{1}{2} M_{\\max}$。我们必须在峰的两侧找到两个点 $x_{\\text{left}}$ 和 $x_{\\text{right}}$，在这两个点上 $M(x) = M_{\\text{hm}}$。\n    -   为了找到 $x_{\\text{left}}$，我们从 $i_{\\text{peak}}$ 向后搜索，找到第一个包含半最大值的网格区间 $[x_{j-1}, x_j]$（即 $M_{j-1} \\le M_{\\text{hm}}  M_j$）。\n    -   为了找到 $x_{\\text{right}}$，我们从 $i_{\\text{peak}}$ 向前搜索，找到第一个包含半最大值的网格区间 $[x_k, x_{k+1}]$（即 $M_{k+1} \\le M_{\\text{hm}}  M_k$）。\n    -   然后通过在这些区间内进行线性插值来找到位置 $x_{\\text{left}}$ 和 $x_{\\text{right}}$。对于两个点 $(x_1, y_1)$ 和 $(x_2, y_2)$，目标值 $y_{\\text{target}}$ 的插值位置 $x_{\\text{interp}}$ 由以下公式给出：\n    $$\n    x_{\\text{interp}} = x_1 + (x_2 - x_1) \\frac{y_{\\text{target}} - y_1}{y_2 - y_1}\n    $$\n    -   然后 FWHM 就是一个简单的差值：FWHM $= x_{\\text{right}} - x_{\\text{left}}$。\n\n整个过程是自动化的，并对提供的六个测试用例中的每一个执行，然后将得出的 FWHM 值进行汇总。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import find_peaks\n\ndef solve():\n    \"\"\"\n    Computes the FWHM of the Mesp2 expression stripe for a series of test cases based on\n    a minimal clock and wavefront model.\n    \"\"\"\n    # Define the constants for the simulation\n    L = 5.0\n    F0 = 1.0\n    Kf = 0.2\n    nf = 4\n    q = 2 * np.pi\n    phi0 = 0.0\n    Kc = 0.5\n    nc = 3\n    N = 10001\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.6),  # Case 1\n        (2.0, 0.6),  # Case 2\n        (0.5, 0.6),  # Case 3\n        (1.0, 0.2),  # Case 4\n        (1.0, 1.2),  # Case 5\n        (1.0, 0.0),  # Case 6\n    ]\n\n    results = []\n    \n    # Create the spatial grid\n    x = np.linspace(0, L, N)\n    dx = x[1] - x[0]\n\n    for s, A in test_cases:\n        # Step 1: Compute Mesp2 expression profile M(x)\n        \n        # FGF gradient and repression term R(x)\n        F = F0 * np.exp(-s * x)\n        R = 1.0 / (1.0 + (F / Kf)**nf)\n        \n        # Clock activation term C(x) and H(C(x))\n        C = np.maximum(0, A * np.cos(q * x + phi0))\n        \n        H = np.zeros_like(C)\n        # Avoid division by zero where C is 0\n        positive_C_mask = C > 0\n        H[positive_C_mask] = 1.0 / (1.0 + (Kc / C[positive_C_mask])**nc)\n        \n        # Mesp2 profile M(x)\n        M = H * R\n        \n        # Handle trivial case where M is identically zero\n        if np.all(M == 0):\n            results.append(0.0)\n            continue\n            \n        # Step 2: Find peaks and select the one closest to the determination front\n        \n        # Find all local maxima\n        peak_indices, _ = find_peaks(M)\n        \n        if len(peak_indices) == 0:\n            results.append(0.0)\n            continue\n        \n        # Calculate determination front position\n        x_df = np.log(F0 / Kf) / s\n        \n        # Select peak closest to x_df\n        peak_positions = x[peak_indices]\n        closest_peak_index_in_list = np.argmin(np.abs(peak_positions - x_df))\n        main_peak_index = peak_indices[closest_peak_index_in_list]\n        \n        M_max = M[main_peak_index]\n        \n        if M_max == 0:\n            results.append(0.0)\n            continue\n            \n        # Step 3: Calculate Full Width at Half Maximum (FWHM)\n        \n        M_half_max = M_max / 2.0\n        \n        # Find left crossing point by searching backwards from the peak\n        x_left = 0.0\n        found_left = False\n        for i in range(main_peak_index, 0, -1):\n            if M[i] > M_half_max and M[i-1] = M_half_max:\n                # Linear interpolation between points (i-1) and (i)\n                y1, y2 = M[i-1], M[i]\n                x1, x2 = x[i-1], x[i]\n                x_left = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_left = True\n                break\n        \n        # Find right crossing point by searching forwards from the peak\n        x_right = 0.0\n        found_right = False\n        for i in range(main_peak_index, N - 1):\n            if M[i] > M_half_max and M[i+1] = M_half_max:\n                # Linear interpolation between points (i) and (i+1)\n                y1, y2 = M[i], M[i+1]\n                x1, x2 = x[i], x[i+1]\n                x_right = x1 + (x2 - x1) * (M_half_max - y1) / (y2 - y1)\n                found_right = True\n                break\n\n        # If either crossing was not found, FWHM is ill-defined.\n        # Based on the model, this should not happen for a valid peak.\n        if not found_left or not found_right:\n            fwhm = 0.0\n        else:\n            fwhm = x_right - x_left\n            \n        results.append(round(fwhm, 4))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2679198"}]}