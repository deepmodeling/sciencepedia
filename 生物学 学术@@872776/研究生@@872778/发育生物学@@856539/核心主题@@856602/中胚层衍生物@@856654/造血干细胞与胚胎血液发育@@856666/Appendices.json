{"hands_on_practices": [{"introduction": "细胞谱系定型通常依赖于由关键转录因子形成的“双稳态开关”。这些基因调控网络可以将渐变的输入信号转化为明确的、全或无的细胞命运决策。本练习提供了一个动手实践的机会，通过常微分方程来模拟这样一个经典的开关——GATA1-PU.1相互抑制回路，从而探索相互抑制和自我激活如何共同作用，从动态系统的角度创造出离散的、稳定的细胞命运状态。[@problem_id:2641340]", "problem": "造血干细胞 (HSCs) 在两个关键转录因子 GATA1 和 PU.1 的影响下，分化为红系或髓系谱系。这两个转录因子相互抑制对方的表达，并且也能自激活自身的表达。从分子生物学中心法则（即DNA转录为RNA，再翻译为蛋白质）出发，并基于经过充分检验的观察——转录因子对启动子的调控可以用S型希尔函数来描述，形式化一个针对GATA1–PU.1相互拮抗回路的无量纲常微分方程 (ODE) 模型。使用该模型算法化地预测系统是否为双稳态，并推断在指定参数集下的谱系定型结果。\n\n使用的基本定义和约束：\n- 令 $G(t)$ 表示 GATA1 蛋白在时间 $t$ 的无量纲浓度（以任意表达单位计），$P(t)$ 表示 PU.1 蛋白在时间 $t$ 的无量纲浓度（以相同单位计）。所有浓度均为非负实数。\n- 将激活希尔函数 $H_{\\mathrm{act}}(x;n)$ 定义为 $H_{\\mathrm{act}}(x;n) = \\dfrac{x^{n}}{1 + x^{n}}$，其中 $x \\ge 0$，希尔系数 $n \\ge 1$。\n- 将抑制希尔函数 $H_{\\mathrm{rep}}(y;K,m)$ 定义为 $H_{\\mathrm{rep}}(y;K,m) = \\dfrac{1}{1 + \\left(\\dfrac{y}{K}\\right)^{m}}$，其中 $y \\ge 0$，解离常数 $K > 0$，希尔系数 $m \\ge 1$。\n- 假设无量纲的合成和衰变动力学遵循以下机理构成：每种蛋白质的合成速率等于其最大合成速率乘以 (一个基础项与一个自激活项之和) 和 (一个来自对立因子的抑制项) 的乘积；一阶衰变与浓度成正比。\n\n您的任务是：\n- 根据上述基本定义，推导并实现以下ODE：\n$$\n\\frac{dG}{dt} = s_G \\left( b_G + a_G \\, H_{\\mathrm{act}}(G; n_G) \\right) \\, H_{\\mathrm{rep}}(P; K_{PG}, m_{PG}) - d_G \\, G,\n$$\n$$\n\\frac{dP}{dt} = s_P \\left( b_P + a_P \\, H_{\\mathrm{act}}(P; n_P) \\right) \\, H_{\\mathrm{rep}}(G; K_{GP}, m_{GP}) - d_P \\, P,\n$$\n其中 $s_G, s_P > 0$ 是合成比例因子，$b_G, b_P \\ge 0$ 是基础转录项，$a_G, a_P \\ge 0$ 是自激活增益，$d_G, d_P > 0$ 是一阶衰变率，$n_G, n_P \\ge 1$ 是激活希尔系数，$m_{PG}, m_{GP} \\ge 1$ 是抑制希尔系数，$K_{PG}, K_{GP} > 0$ 是抑制解离常数。所有参数都是无量纲的。基因表达单位是任意的，并且通过构造是无量纲的；不需要物理单位。\n- 对于每个指定的参数集，通过从一个初始条件网格对ODE进行数值积分，并对长时间状态进行聚类，以确定吸引子。使用一个均匀的方形初始条件网格 $(G(0), P(0))$，范围为 $[0, G_{\\max}] \\times [0, P_{\\max}]$，其中 $G_{\\max} = P_{\\max} = 4$，包含 $9 \\times 9$ 个均匀间隔的网格点（包括端点）。使用您选择的任何标准ODE求解器，从 $t = 0$ 积分到 $t = T$（$T = 200$）。将 $t=T$ 时的状态视为每个初始条件的终末状态。通过将欧几里得距离小于 $\\varepsilon = 10^{-3}$ 的状态分组，将终末状态聚类成不同的吸引子。不同聚类的总数即为不同吸引子的数量。\n- 根据对最终状态的不同吸引子质心评估的以下规则，将每个参数集的谱系结果分类为单个整数代码：\n    - 如果存在至少2个不同的吸引子（双稳态机制，对应于不同的命运），则返回 $3$。\n    - 如果恰好有1个不同的吸引子，则计算比率 $R = \\dfrac{G^{\\ast}}{P^{\\ast} + 10^{-9}}$，其中 $(G^{\\ast}, P^{\\ast})$ 是唯一的吸引子质心，$10^{-9}$ 是一个小的稳定项以避免除以零。设决策阈值为 $\\theta = 1.5$。如果 $R > \\theta$ (GATA1-高，类红系定型)，则返回 $1$；如果 $R  \\dfrac{1}{\\theta}$ (PU.1-高，类髓系定型)，则返回 $2$；否则返回 $0$ (共表达单吸引子)。\n- 程序必须是确定性的，并且不得使用任何随机性。\n\n测试套件：\n实现您的程序，以精确评估以下四个参数集，并按所列顺序为每个参数集输出分类代码。\n- 测试A (对称，强相互抑制和自激活；预期为双稳态): $s_G = 1$, $s_P = 1$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 6$, $a_P = 6$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$。\n- 测试B (不对称，有利于GATA1): $s_G = 1.2$, $s_P = 0.7$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 6$, $a_P = 2$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$。\n- 测试C (不对称，有利于PU.1): $s_G = 0.7$, $s_P = 1.2$, $d_G = 1$, $d_P = 1$, $b_G = 0.02$, $b_P = 0.02$, $a_G = 2$, $a_P = 6$, $n_G = 2$, $n_P = 2$, $m_{PG} = 4$, $m_{GP} = 4$, $K_{PG} = 1$, $K_{GP} = 1$。\n- 测试D (弱抑制，中等自激活；预期为单个共表达吸引子): $s_G = 1$, $s_P = 1$, $d_G = 1$, $d_P = 1$, $b_G = 0.2$, $b_P = 0.2$, $a_G = 1$, $a_P = 1$, $n_G = 2$, $n_P = 2$, $m_{PG} = 1$, $m_{GP} = 1$, $K_{PG} = 1$, $K_{GP} = 1$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含以逗号分隔的列表形式的结果，并用方括号括起来，顺序为[测试 A, 测试 B, 测试 C, 测试 D]。例如，一个有效的输出可能看起来像 [$3$,$1$,$2$,$0$]。输出为整数，没有单位，因为模型在构建时就是无量纲的。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于分子和系统生物学的原理，在数学上是适定的，并且其详尽和清晰的说明足以得出一个唯一的、客观的和可验证的解。所有必需的参数、方程和数值程序都已无歧义、无矛盾地提供。因此，我们将着手进行形式推导和计算求解。\n\n该问题要求对一个动态系统进行形式化和分析，该系统模拟了两个转录因子GATA1和PU.1的基因调控网络，其浓度分别用 $G(t)$ 和 $P(t)$ 表示。其动力学基于中心法则，即蛋白质浓度的变化是合成与衰变之间平衡的结果。\n\n蛋白质浓度（例如 $G(t)$）的变化率由其合成速率和衰变速率之差给出：\n$$\n\\frac{dG}{dt} = \\text{Synthesis Rate}_G - \\text{Decay Rate}_G\n$$\n根据问题描述，衰变是一个一阶过程，意味着速率与当前浓度成正比。\n$$\n\\text{Decay Rate}_G = d_G \\, G\n$$\n其中 $d_G > 0$ 是衰变速率常数。\n\n合成速率被描述为一个最大合成速率 $s_G > 0$、一个转录激活项和一个转录抑制项的乘积。\n$$\n\\text{Synthesis Rate}_G = s_G \\times (\\text{Activation Term}) \\times (\\text{Repression Term})\n$$\n激活项结合了一个基础（渗漏）表达分量 $b_G \\ge 0$ 和一个自激活分量，即GATA1增强其自身的转录。这种自激活由激活希尔函数 $H_{\\mathrm{act}}(G; n_G)$ 乘以一个增益因子 $a_G \\ge 0$ 来建模。因此，总激活项为：\n$$\n\\text{Activation Term} = b_G + a_G \\, H_{\\mathrm{act}}(G; n_G) = b_G + a_G \\, \\frac{G^{n_G}}{1 + G^{n_G}}\n$$\nGATA1的合成受PU.1的抑制。这由抑制希尔函数 $H_{\\mathrm{rep}}(P; K_{PG}, m_{PG})$ 来描述。\n$$\n\\text{Repression Term} = H_{\\mathrm{rep}}(P; K_{PG}, m_{PG}) = \\frac{1}{1 + \\left(\\frac{P}{K_{PG}}\\right)^{m_{PG}}}\n$$\n将这些分量组合起来，得到 $G(t)$ 的完整微分方程：\n$$\n\\frac{dG}{dt} = s_G \\left( b_G + a_G \\, \\frac{G^{n_G}}{1 + G^{n_G}} \\right) \\left( \\frac{1}{1 + \\left(\\frac{P}{K_{PG}}\\right)^{m_{PG}}} \\right) - d_G \\, G\n$$\n这正是问题陈述中提供的第一个方程。通过逻辑上的对称性，对自激活并受GATA1抑制的PU.1蛋白应用相同的原理，我们推导出第二个方程：\n$$\n\\frac{dP}{dt} = s_P \\left( b_P + a_P \\, \\frac{P^{n_P}}{1 + P^{n_P}} \\right) \\left( \\frac{1}{1 + \\left(\\frac{G}{K_{GP}}\\right)^{m_{GP}}} \\right) - d_P \\, P\n$$\n因此，这个由两个耦合常微分方程(ODE)组成的系统是合理的。\n\n数值解将按照指定的确切程序实现。\n1.  **定义ODE系统**：ODE系统的右侧将实现为一个函数 `dY/dt = f(t, Y, params)`，其中 $Y = [G, P]$ 是状态向量，`params` 是包含所有14个模型参数的字典。\n2.  **生成初始条件**：将在方形域 $[0, 4] \\times [0, 4]$ 上生成一个 $9 \\times 9 = 81$ 个初始条件 $(G(0), P(0))$ 的均匀网格。`numpy.linspace` 函数适合此目的，它会生成包含端点的序列。\n3.  **数值积分**：对于每个初始条件，将从 $t=0$ 到 $t=200$ 对ODE系统进行积分。将使用 `scipy.integrate.solve_ivp` 函数，因为它为求解初值问题提供了一种稳健而准确的方法。系统在最终时间的状态 $Y(200) = [G(200), P(200)]$ 将被存储为终末状态。\n4.  **终末状态聚类**：将对81个终末状态进行聚类以识别不同的吸引子。指定的聚类规则是，将欧几里得距离小于 $\\varepsilon = 10^{-3}$ 的状态分组。这将通过将终末状态视为图中的节点来实现，如果两个节点之间的欧几里得距离小于 $\\varepsilon$，则它们之间存在一条边。聚类即为该图的连通分量。将使用广度优先搜索 (BFS) 算法来确定性地找到这些分量。为确保确定性，在聚类开始前，将对终末状态列表进行字典序排序。将状态划分为聚类后，计算每个聚类的质心（其中所有点的平均值）。\n5.  **结果分类**：吸引子质心的数量和位置决定了谱系结果代码。\n    - 如果吸引子的数量为2个或更多，则系统是双稳态的，代码为 $3$。\n    - 如果恰好有1个吸引子，其质心为 $(G^{\\ast}, P^{\\ast})$，则计算比率 $R = \\frac{G^{\\ast}}{P^{\\ast} + 10^{-9}}$。通过将 $R$ 与阈值 $\\theta = 1.5$ 进行比较来确定结果：\n        - 如果 $R > \\theta$，则代码为 $1$ (GATA1-高)。\n        - 如果 $R  1/\\theta$，则代码为 $2$ (PU.1-高)。\n        - 否则，代码为 $0$ (共表达)。\n\n这个完整的算法将应用于四个指定的参数集中的每一个，以生成最终输出。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It defines the parameter sets and calls the solver for each case.\n    \"\"\"\n\n    test_cases = [\n        # Test A: symmetric, strong mutual repression and auto-activation\n        {\n            \"s_G\": 1.0, \"s_P\": 1.0, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 6.0, \"a_P\": 6.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test B: asymmetric, GATA1-favored\n        {\n            \"s_G\": 1.2, \"s_P\": 0.7, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 6.0, \"a_P\": 2.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test C: asymmetric, PU.1-favored\n        {\n            \"s_G\": 0.7, \"s_P\": 1.2, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.02, \"b_P\": 0.02, \"a_G\": 2.0, \"a_P\": 6.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 4.0, \"m_GP\": 4.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        },\n        # Test D: weak repression, modest auto-activation\n        {\n            \"s_G\": 1.0, \"s_P\": 1.0, \"d_G\": 1.0, \"d_P\": 1.0,\n            \"b_G\": 0.2, \"b_P\": 0.2, \"a_G\": 1.0, \"a_P\": 1.0,\n            \"n_G\": 2.0, \"n_P\": 2.0, \"m_PG\": 1.0, \"m_GP\": 1.0,\n            \"K_PG\": 1.0, \"K_GP\": 1.0\n        }\n    ]\n\n    results = [run_simulation_and_classify(params) for params in test_cases]\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef h_act(x, n):\n    \"\"\"Activation Hill function.\"\"\"\n    return (x**n) / (1.0 + x**n)\n\ndef h_rep(y, K, m):\n    \"\"\"Repression Hill function.\"\"\"\n    return 1.0 / (1.0 + (y / K)**m)\n\ndef ode_system(t, y, p):\n    \"\"\"\n    Defines the system of ODEs for GATA1-PU.1 mutual antagonism.\n    y: state vector [G, P]\n    p: dictionary of parameters\n    \"\"\"\n    G, P = y[0], y[1]\n\n    dG_dt = p[\"s_G\"] * (p[\"b_G\"] + p[\"a_G\"] * h_act(G, p[\"n_G\"])) * h_rep(P, p[\"K_PG\"], p[\"m_PG\"]) - p[\"d_G\"] * G\n    dP_dt = p[\"s_P\"] * (p[\"b_P\"] + p[\"a_P\"] * h_act(P, p[\"n_P\"])) * h_rep(G, p[\"K_GP\"], p[\"m_GP\"]) - p[\"d_P\"] * P\n\n    return [dG_dt, dP_dt]\n\ndef cluster_states(terminal_states, epsilon):\n    \"\"\"\n    Clusters terminal states using a connected components algorithm.\n    Nodes are states, an edge exists if Euclidean distance is less than epsilon.\n    \"\"\"\n    # Sort points for deterministic behavior\n    sorted_states = sorted(terminal_states, key=lambda p: (p[0], p[1]))\n    n_states = len(sorted_states)\n    assigned = [False] * n_states\n    clusters = []\n\n    for i in range(n_states):\n        if not assigned[i]:\n            # Start a new cluster using Breadth-First Search (BFS)\n            new_cluster_indices = []\n            queue = [i]\n            assigned[i] = True\n            \n            head = 0\n            while head  len(queue):\n                current_idx = queue[head]\n                head += 1\n                new_cluster_indices.append(current_idx)\n\n                # Find all unassigned neighbors\n                p1 = np.array(sorted_states[current_idx])\n                for j in range(n_states):\n                    if not assigned[j]:\n                        p2 = np.array(sorted_states[j])\n                        dist = np.linalg.norm(p1 - p2)\n                        if dist  epsilon:\n                            assigned[j] = True\n                            queue.append(j)\n            \n            clusters.append([sorted_states[k] for k in new_cluster_indices])\n            \n    # Calculate centroids for each cluster\n    centroids = [np.mean(c, axis=0) for c in clusters]\n    return centroids\n\ndef classify_attractors(centroids):\n    \"\"\"\n    Classifies the system outcome based on the number and position of attractors.\n    \"\"\"\n    num_attractors = len(centroids)\n    \n    if num_attractors >= 2:\n        return 3  # Bistable\n\n    if num_attractors == 1:\n        G_star, P_star = centroids[0]\n        ratio = G_star / (P_star + 1e-9)\n        threshold = 1.5\n        \n        if ratio > threshold:\n            return 1  # GATA1-high\n        elif ratio  1.0 / threshold:\n            return 2  # PU.1-high\n        else:\n            return 0  # Co-expression\n    \n    # Should not be reached with the given problem setup\n    return -1 # Error code\n\ndef run_simulation_and_classify(params):\n    \"\"\"\n    Runs the full simulation and classification pipeline for a single parameter set.\n    \"\"\"\n    # 1. Setup grid of initial conditions\n    G_max, P_max = 4.0, 4.0\n    grid_size = 9\n    g_initial = np.linspace(0, G_max, grid_size)\n    p_initial = np.linspace(0, P_max, grid_size)\n    initial_conditions = np.array(np.meshgrid(g_initial, p_initial)).T.reshape(-1, 2)\n    \n    # 2. Integrate ODEs for each initial condition\n    t_span = (0, 200)\n    terminal_states = []\n    for y0 in initial_conditions:\n        sol = solve_ivp(\n            fun=ode_system, \n            t_span=t_span, \n            y0=y0, \n            args=(params,), \n            method='RK45', \n            dense_output=True\n        )\n        terminal_states.append(sol.y[:, -1])\n        \n    # 3. Cluster terminal states to find attractors\n    epsilon = 1e-3\n    attractor_centroids = cluster_states(terminal_states, epsilon)\n    \n    # 4. Classify outcome\n    return classify_attractors(attractor_centroids)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2641340"}, {"introduction": "现代发育生物学在很大程度上依赖于单细胞测序等高通量技术来描绘复杂的发育过程。然而，从这些快照式的转录组数据中推断动态的细胞谱系关系充满了挑战和潜在的陷阱。本练习要求学生扮演一位严谨的科学家，批判性地评估一个关于胚胎造血的计算分析，识别其中可能存在的混杂因素和伪影，并设计出能够明确验证谱系分叉事件的“金标准”实验。[@problem_id:2641398]", "problem": "您正在分析来自胚胎发育第 $10.5$ 天小鼠胚胎的主动脉-性腺-中肾 (AGM) 区域的单细胞RNA测序 (scRNA-seq) 数据，旨在解析生血内皮如何通过内皮向造血转变 (EHT) 过渡到造血干细胞 (HSC) 和其他血液谱系。您的计算流程推断出从生血内皮到一个分叉，产生两种命运，您暂时将其标记为淋巴-髓系和红系。该数据集包含在两个相邻时间点（胚胎发育第 $10.0$ 天和第 $10.5$ 天）从多窝小鼠收集并分多个批次测序的解离的AGM细胞，其中包括内皮细胞、生血内皮细胞、HSC前体细胞、红系-髓系祖细胞以及稀有的成熟红细胞。使用扩散图进行的拟时序分析表明存在一个分支点，而RNA速率分析支持从内皮细胞向两种假定命运发展的方向。然而，主成分 $1$ 在细胞周期基因上的载荷很重，并且批次/时间点身份与推断的分支分配相关。\n\n仅使用发育生物学和统计推断的基本原理和核心定义，评估在宣布一个真实的发育分叉时可能存在的陷阱，并提出能够因果验证谱系关系和方向性的实验策略。您的推理应建立在以下基础上：(i) 分子生物学中心法则（DNA到RNA到蛋白质）意味着细胞状态部分反映在转录谱中；(ii) 基因调控网络作为动态系统，在参数改变时可以具有吸引子状态和分叉；(iii) scRNA-seq提供的是编码状态分布的快照，而非直接的因果关系；以及 (iv) 基本的统计依赖概念，如贝叶斯法则、相关性和互信息。\n\n哪个/哪些选项最好地指出了从这些数据推断分叉时的主要陷阱，并概述了科学严谨、正交的实验验证方法，以专门检验在AGM背景下推断出的分支身份和方向？\n\nA. 认识到表观的转录“分支”可能是由细胞周期异质性和批次/时间混淆引起的，而非命运选择。具体而言：如果主成分由$G_1/S$ 和 $G_2/M$程序主导，那么沿拟时序的变化可能反映了振荡的细胞周期位置；并且，如果命运标签 $F$ 与批次 $B$ 在以拟时序 $t$ 为条件的情况下仍然存在统计关联（即条件互信息 $I(F;B \\mid t) > 0$），那么批次或时间取样可能正在驱动这个“分叉”。此外，RNA速率依赖于一个动力学模型 $d u / d t = \\alpha - \\beta u$, $d s / d t = \\beta u - \\gamma s$，其中 $\\alpha, \\beta, \\gamma$ 在邻域内近似恒定；在内皮和造血状态之间违反这些假设可能会导致箭头方向错误。最后，AGM解离物中的类红系细胞可能包含早期植入的卵黄囊来源的红系-髓系祖细胞，从而形成一个混合体。验证方法：在轨迹推断前回归去除细胞周期评分并重新计算拓扑结构；测试 $I(F;B \\mid t)$ 并使用批次平衡的图重新运行分析；重新拟合基因特异性的剪接动力学以检查速率模型的假设；在功能上，于胚胎发育第 $9.5$ 天进行时间受控、低剂量的 VE-Cadherin (Cdh5)-CreERT$2$ 诱导，以克隆性地标记生血内皮，随后进行克隆谱系追踪和跨时间进程的单细胞多组学读出，以观察标记的克隆是否对两个分支都有贡献；并辅以AGM外植体的EHT离体活体成像、在假定分支点前进行定时的Notch扰动、以及对标记的HSC进行体内移植以测试其多能性。\n\nB. 将假定的分叉主要归因于测序深度不足，并通过重新测序至每个细胞更高的读数，然后重新运行拟时序和速率分析来解决，理由是更深的数据将消除伪影，无需额外的验证。\n\nC. 假设分叉必然存在，因为Waddington的景观隐喻暗示了普遍的分支现象；仅通过批量RNA测序和基因调控网络的计算模拟进行验证，而不进行谱系标记、移植或活体成像。\n\nD. 结论是两个推断的分支必然都起源于AGM生血内皮；通过在胚胎发育第 $10.5$ 天分选c-Kit$^{+}$细胞并在体外进行集落形成单位实验来验证，并将其作为谱系关系的最终证明，而不进行时间分辨的体内谱系追踪或关注潜在的卵黄囊祖细胞污染。\n\nE. 识别出在没有额外结构的情况下，方向性无法从快照中确定：$P(F \\mid X) = \\sum_{t} P(F \\mid t) P(t \\mid X)$ 表明，给定表达谱 $X$ 的命运分配是在未观察到的时间 $t$ 上进行边缘化的，因此没有关于 $t$ 的因果先验，时间之箭是模糊的。指出RNA速率的方向取决于可能在不同状态间变化的基因级动力学；并且如果 $I(F;B) \\gg 0$，则时间点和批次会作为混淆变量。认识到类红系AGM细胞可能比AGM HSC出现得更早，且来源于卵黄囊。验证方法：在限定的胚胎发育第 $9.25$–$9.75$ 天窗口内，特别是在VE-Cadherin$^{+}$/Endomucin$^{+}$/RUNX$1^{+}$内皮细胞中启动诱导型谱系条形码，使用基于CRISPR的累积条形码技术生成独特的克隆标记，然后在胚胎发育第 $10.0$–$11.5$ 天进行单细胞多组学分析，以读出克隆的命运共享和染色质启动情况；通过EHT的活体成像和在推断的分支点前进行时间受控的Notch通路扰动来测试方向性；通过计算条件互信息 $I(F;B \\mid t)$ 以及拟合和检验基因特异性的RNA速率动力学来控制混淆变量。包括对带有条形码标记的假定HSC进行体内移植，以验证其自我更新和多能性。\n\n选择所有适用选项。", "solution": "问题陈述是计算生物学和发育生物学中一个有效且定义明确的挑战。它呈现了一个现实的场景：单细胞RNA测序 (scRNA-seq) 数据的计算分析表明存在一个发育分叉，但同时也提供了几个关键的警示信号，使这一推断受到质疑。任务是识别这些陷阱并提出严谨的实验验证策略。该问题具有科学依据，客观，并包含足够的信息以进行批判性评估。\n\n核心的科学挑战在于区分一个真实的生物谱系分叉与由混淆变量产生的伪影。所提供的数据和观察结果指向了几个潜在的陷阱：\n$1$. **细胞周期混淆**：主成分$1$ (PC$1$) 在细胞周期基因上载荷很重的陈述是一个主要警告信号。由细胞在细胞周期中的位置（$G_1$、$S$、$G_2$/$M$期）引起的基因表达变化，可能会在降维图中产生强烈的伪影结构。如果两个假定分支中的细胞系统性地处于细胞周期的不同阶段，拟时序算法可能会错误地对它们进行排序，从而产生一个仅仅是区分循环与非循环细胞，或$G_1$/$S$与$G_2$/$M$细胞的分支表象。一个真正的命运决定应该与细胞周期状态正交。\n$2$. **批次和时间点混淆**：批次/时间点身份与推断的分支分配的相关性是另一个严重问题。这表明“分叉”可能是测序批次间的技术差异或两个时间点（$E10.0$和$E10.5$）之间的生物学差异造成的伪影。例如，如果批次$1$纯粹因为技术原因包含了更多的类红系细胞，而批次$2$包含了更多的类淋巴-髓系细胞，算法可能会将它们划分为两个分支。从统计学上讲，如果$F$是命运标签，$B$是批次/时间标签，$t$是发育拟时序，一个显著的条件互信息 $I(F; B \\mid t) > 0$ 表明，即使对于处于相同发育阶段的细胞，批次和命运也不是独立的，这是存在混淆的有力证据。\n$3$. **来自其他来源的污染**：AGM是确定性造血干细胞 (HSC) 出现的场所，但它不是胚胎此阶段唯一的造血细胞来源。原始造血，主要是红系造血，从$E7.5$开始在卵黄囊中发生，这些细胞会进入循环。在$E10.5$解离的AGM组织中，混有循环中的卵黄囊来源的红系祖细胞是极有可能的。因此，推断出的“红系”分支可能代表一个具有不同起源的独立细胞群体，而不是一个源自AGM生血内皮的命运决定。这将是一个生物混合体，而非发育分叉。\n$4$. **RNA速率的局限性**：RNA速率通过模拟前体mRNA（未剪接，$u$）和mRNA（已剪接，$s$）的动力学来推断方向性。标准模型假设转录（$\\alpha$）、剪接（$\\beta$）和降解（$\\gamma$）的速率对于给定基因在细胞的局部邻域内是近似恒定的。然而，在像EHT这样的重大细胞状态转变过程中，随着整个基因调控网络的重塑，这些速率可能会发生巨大变化。如果模型的假设被违反，推断出的速率向量可能不可靠，甚至指向错误的方向。\n\n一项严谨的验证必须建立因果关系和克隆性，并且必须使用与转录组相似性正交的方法。**因果关系**要求证明祖细胞随时间分化为特定的命运。**克隆性**要求证明单个祖细胞可以在分叉点产生两种子谱系。\n\n现在，我将评估每个选项。\n\n**A. 认识到表观的转录“分支”可能是由细胞周期异质性和批次/时间混淆引起的...[...] 验证方法：在轨迹推断前回归去除细胞周期评分...[...] 进行时间受控、低剂量的VE-Cadherin (Cdh5)-CreERT$2$诱导...[...] 离体活体成像...[...] 定时的Notch扰动...[...] 以及体内移植...[...]**\n\n这个选项非常周全和正确。\n- **陷阱识别**：它正确地识别了所有主要的潜在陷阱：细胞周期、批次效应（用条件互信息 $I(F;B \\mid t)$ 严谨地形式化了）、RNA速率模型违规，以及卵黄囊来源细胞的污染。每一点都是一个有效且关键的关切。\n- **验证策略**：所提出的验证计划是发育生物学领域的金标准。\n    - 纠正计算伪影（回归去除细胞周期，使用批次平衡的图，检验速率动力学）是必要的第一步。\n    - 使用 `Cdh5-CreERT2` 进行克隆谱系追踪是检验单个生血内皮细胞是否能产生两种拟议谱系的权威方法。时间点（$E9.5$）和低剂量诱导的设定是正确的，以在主要EHT事件之前实现克隆性。\n    - 活体成像提供了直接、动态的过程可视化，是另一种正交的证据来源。\n    - 扰动实验（定时的Notch抑制/激活）是检验关键信号通路在命运决定中作用的强有力的因果检验。\n    - 体内移植是真正、多能HSC不可或缺的功能性定义。\n该选项以无可挑剔的科学逻辑全面解决了问题。\n**结论：正确**\n\n**B. 将假定的分叉主要归因于测序深度不足，并通过重新测序至每个细胞更高的读数...理由是更深的数据将消除伪影，无需额外的验证。**\n\n这个选项从根本上就是错误的。虽然更高的测序深度可以提高数据质量，但它不能解决细胞周期、批次效应或生物污染等结构性、混淆性问题。事实上，更深的测序可能会放大这些混淆变量的统计特征。仅仅依赖于重新运行相同的计算流程（“无需额外的验证”），而没有任何正交的实验验证来检验潜在的因果主张，是天真且不科学的。这是一个循环论证的例子，试图通过收集更多产生模糊结果的同类型数据来解决问题。\n**结论：错误**\n\n**C. 假设分叉必然存在，因为Waddington的景观隐喻暗示了普遍的分支现象；仅通过批量RNA测序和基因调控网络的计算模拟进行验证...**\n\n这个选项在多个层面上都是错误的。\n- **前提有误**：它首先将Waddington景观这一有用的隐喻当作保证分叉存在的物理定律。这是一个非科学的假设，绕过了所必需的批判性评估。\n- **验证不足**：所提出的方法是不恰当的。批量RNA测序会平均掉单细胞的异质性，这是一个倒退，会完全掩盖任何潜在的分叉。基因调控网络的计算模拟，若没有像谱系追踪这样的实验数据来约束和验证，只是一种推测性练习。它无法提供体内谱系关系的证明。它明确排斥了必要的实验技术（谱系追踪、移植）。\n**结论：错误**\n\n**D. 结论是两个推断的分支必然都起源于AGM生血内皮；通过分选c-Kit$^{+}$细胞...进行集落形成单位实验来验证...作为谱系关系的最终证明...**\n\n这个选项得出了一个过早的结论，并提出了一个薄弱的验证策略。\n- **无支持的结论**：它一开始就断定谱系关系是真实的，而这正是需要检验的假设。\n- **验证有误**：分选`c-Kit`并不足以特异性地分离出AGM来源的祖细胞，因为卵黄囊来源的祖细胞也是`c-Kit+`。这未能解决污染问题。集落形成单位（CFU）实验是在体外进行的，用于测试短期祖细胞潜能，但不能构成体内谱系关系或真正HSC特有的长期自我更新和多能性的“最终证明”。明确排除时间分辨的体内谱系追踪是拒绝了解决该问题的最有力工具。该验证既非克隆性的，也无法证明体内起源。\n**结论：错误**\n\n**E. 识别出...方向性无法从快照中确定...$P(F \\mid X) = \\sum_{t} P(F \\mid t) P(t \\mid X)$...指出RNA速率的方向...混淆变量...卵黄囊来源...验证方法：启动诱导型谱系条形码...使用基于CRISPR的累积条形码...进行单细胞多组学分析...活体成像...Notch通路扰动...体内移植...**\n\n这个选项同样非常出色且科学严谨。\n- **陷阱识别**：它识别出了与选项A相同的核心问题，并用优雅的统计学和信息论概念来构建它们。关于在推断 $P(F \\mid X)$ 时时间 $t$ 的模糊性的观点，是对静态快照问题的一种高明的表述。它正确地指出了RNA速率的局限性、混淆变量问题（$I(F;B) \\gg 0$），以及卵黄囊污染的生物学可能性。\n- **验证策略**：所提出的策略是最先进的，并直接应对了问题的挑战。\n    - 基于CRISPR的累积条形码（在`VE-Cadherin+/Endomucin+/RUNX1+`细胞中）是一种功能强大、高分辨率的克隆谱系追踪方法，非常适合从单时间点收集中重建谱系树。\n    - 将其与多组学分析（例如，RNA和染色质可及性）相结合，可以提供异常丰富的数据来理解命运决定。\n    - 与选项A一样，它正确地提出了必要的正交验证：活体成像、定时的扰动实验以及用于评估功能的体内移植。\n    - 它正确地提出使用适当的统计方法（$I(F;B \\mid t)$）来检查混淆变量。\n该选项提供了一个正确且全面的解决方案，在概念上与选项A并行，仅在具体选择的前沿技术上有所不同。\n**结论：正确**\n\n选项A和E都表现出对计算推断局限性以及严谨、多方面实验验证必要性的深刻理解。它们正确地识别了陷阱，并提出了适当的、最先进的解决方案。因此，两者都是正确的。", "answer": "$$\\boxed{AE}$$", "id": "2641382"}, {"introduction": "细胞的命运决策深刻地受到其微环境信号的影响，而将外部信号转化为内部响应是细胞信号转导的核心。本练习将聚焦于量化这一过程，带领学生应用质量作用定律来计算一个关键的造血信号通路。通过计算干细胞因子（Stem Cell Factor）配体如何与其受体c-Kit结合以产生下游信号通量，学生可以具体理解环境线索如何精确地调控细胞行为。[@problem_id:2641382]", "problem": "在胚胎造血过程中的生血内皮中，由 c-Kit 受体酪氨酸激酶介导的信号传导取决于被可溶性配体——干细胞因子占据的受体比例，以及每个被占据的受体产生下游信号中间体的速率。假设一个浸泡在充分搅拌的细胞外介质中的单个生血内皮细胞，其具有以下实验上合理的条件和参数：\n- 配体浓度：$L = 50\\,\\text{nM}$。\n- 受体-配体相互作用的解离常数：$K_d = 5\\,\\text{nM}$，根据质量作用定律，由平衡关系 $K_d = [R][L]/[RL]$ 定义，其中 $[R]$ 是未结合受体的浓度，$[L]$ 是溶液中游离配体的浓度，$[RL]$ 是受体-配体复合物的浓度。\n- 细胞上的受体表面密度：$\\rho_R = 20\\,\\text{receptors}\\,\\mu\\text{m}^{-2}$。\n- 暴露于介质的有效膜面积：$A = 800\\,\\mu\\text{m}^2$。\n- 每个被占据受体产生下游中间体的信号生成速率：$k_{\\text{sig}} = 0.05\\,\\text{s}^{-1}$。\n\n假设细胞外介质足够大，以至于 $L$ 代表了膜处的游离配体浓度（即，因结合导致的配体耗尽可忽略不计），并且相对于下游信号传导，受体-配体结合迅速达到平衡。\n\n仅使用质量作用定律和解离常数的定义，从第一性原理推导出 c-Kit 的稳态占据分数 $\\theta$，并用它来计算细胞的总稳态下游信号通量 $F$，该通量定义为下游中间体的总产生速率：\n- 首先，计算稳态下配体占据受体的分数 $\\theta$。\n- 然后，计算细胞上的受体总数 $N_R$、被占据的受体数量 $N_{\\text{occ}}$，最后计算信号通量 $F = k_{\\text{sig}} N_{\\text{occ}}$。\n\n将占据分数 $\\theta$ 表示为无量纲分数，信号通量 $F$ 的单位为 分子/秒·细胞。将两个数值结果均四舍五入到四位有效数字。按 $\\theta$，$F$ 的顺序提供您的最终数值结果。", "solution": "恰当的起点是将质量作用定律应用于平衡状态下的受体-配体结合。设 $R$ 表示游离受体，$L$ 表示游离配体，$RL$ 表示受体-配体复合物。结合反应为 $R + L \\rightleftharpoons RL$。在平衡状态下，解离常数定义为\n$$\nK_d \\equiv \\frac{[R][L]}{[RL]}.\n$$\n将受体总量（每个细胞）定义为 $R_T \\equiv [R] + [RL]$。占据分数是与配体结合的受体所占的比例：\n$$\n\\theta \\equiv \\frac{[RL]}{R_T}.\n$$\n我们的目标是用 $L$ 和 $K_d$ 来表示 $\\theta$。从 $K_d$ 的定义中解出用 $[R]$ 表示的 $[RL]$：\n$$\n[RL] = \\frac{[R][L]}{K_d}.\n$$\n代入 $[R] = R_T - [RL]$：\n$$\n[RL] = \\frac{(R_T - [RL])\\,L}{K_d}.\n$$\n重新整理，将含 $[RL]$ 的项收集到左侧：\n$$\n[RL]\\left(1 + \\frac{L}{K_d}\\right) = \\frac{R_T\\,L}{K_d}.\n$$\n解出 $[RL]$：\n$$\n[RL] = \\frac{R_T\\,L}{K_d + L}.\n$$\n两边同时除以 $R_T$ 得到占据分数：\n$$\n\\theta = \\frac{[RL]}{R_T} = \\frac{L}{K_d + L}.\n$$\n该表达式仅取决于 $L$ 和 $K_d$，并且在 $L$ 表示游离配体浓度时有效。根据所述假设，在一个大的、充分搅拌的浴液中，给定的 $L$ 等于游离配体浓度。\n\n代入给定值 $L = 50\\,\\text{nM}$ 和 $K_d = 5\\,\\text{nM}$：\n$$\n\\theta = \\frac{50}{5 + 50} = \\frac{50}{55} = \\frac{10}{11}.\n$$\n数值上，\n$$\n\\theta = \\frac{10}{11} \\approx 0.909090\\ldots\n$$\n\n接下来计算细胞上的受体总数。已知受体表面密度 $\\rho_R$ 和暴露面积 $A$，\n$$\nN_R = \\rho_R \\, A = \\left(20\\,\\text{receptors}\\,\\mu\\text{m}^{-2}\\right)\\left(800\\,\\mu\\text{m}^2\\right) = 16000\\,\\text{receptors}.\n$$\n被占据的受体数量为\n$$\nN_{\\text{occ}} = \\theta\\,N_R = \\left(\\frac{10}{11}\\right)\\left(16000\\right) = \\frac{160000}{11} \\approx 14545.4545\\ldots\n$$\n下游信号通量，定义为由被占据的受体引起的信号中间体的产生速率，为\n$$\nF = k_{\\text{sig}}\\,N_{\\text{occ}} = \\left(0.05\\,\\text{s}^{-1}\\right)\\left(\\frac{160000}{11}\\right) = \\frac{8000}{11}\\,\\text{s}^{-1}.\n$$\n数值上，\n$$\nF \\approx 727.2727\\ldots\\,\\text{molecules}\\,\\text{s}^{-1}\\,\\text{cell}^{-1}.\n$$\n\n将两个量都四舍五入到四位有效数字：\n- $\\theta \\approx 0.9091$ (无量纲)。\n- $F \\approx 727.3\\,\\text{molecules}\\,\\text{s}^{-1}\\,\\text{cell}^{-1}$。\n\n这些结果直接由质量作用定律和解离常数的定义，以及细胞的受体总数和每个被占据受体的信号速率常数得出。", "answer": "$$\\boxed{\\begin{pmatrix}0.9091  727.3\\end{pmatrix}}$$", "id": "2641398"}]}