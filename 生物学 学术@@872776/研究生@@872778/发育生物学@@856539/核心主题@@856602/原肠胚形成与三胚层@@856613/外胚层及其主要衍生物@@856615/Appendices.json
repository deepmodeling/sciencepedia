{"hands_on_practices": [{"introduction": "外胚层的前后轴向图式形成是脊椎动物胚胎发育的核心事件，其中Wnt信号通路扮演着关键的“后部化”角色。理解这一基本原理对于解读发育过程中的基因调控网络至关重要。这项练习 [@problem_id:2632453] 作为一个思想实验，要求你基于Wnt信号的核心功能，推导在一个假设的基因扰动下可能产生的复杂表型，这模拟了发育遗传学家设计和解释实验时的演绎推理过程。", "problem": "您构建了一个脊椎动物模型，在该模型中，通过一个可稳定$\\beta$-catenin的tamoxifen诱导、组织特异性的转基因，可以在前部神经外胚层中选择性地、强有力地激活经典Wnt信号通路。您在晚期原肠胚到早期神经胚阶段诱导其激活，此时神经板正沿着前后轴进行区域化。请预测在前部神经外胚层及其衍生物中将产生最一致的表型组合，并根据外胚层模式形成和组织者功能的基本原理来论证该预测。假设非经典Wnt通路未被直接改变，且骨形态发生蛋白水平和Hedgehog信号通路在全局上保持不变。\n\n哪个选项最符合预期的结果？\n\nA. 严重的前部截短，其特征为前脑衍生物（包括端脑和眼域）的缺失或严重减少，后部神经特征向前扩展至吻侧神经板，基板前区域减少并伴随颅基板（如晶状体、嗅觉和腺垂体基板）的缺失，以及前部神经板边界处神经嵴的相对扩张。\n\nB. 前脑和眼域的大规模扩张和重复，同时抑制后部神经命运，并伴有基板前区域的扩大和前部神经板边界处神经嵴的抑制。\n\nC. 前部神经特征基本保留，但由于中线缺陷而出现独眼畸形，同时基板衍生物正常形成，后部神经基因表达边界保持不变。\n\nD. 前部神经管的选择性背侧化，保留了前后轴特征，导致顶板标记物增加，而前脑大小或基板与神经嵴的分配没有重大变化。\n\nE. 由于神经诱导受损，前部神经外胚层转化为表面外胚层，导致头部表皮扩大和前部区域中枢神经系统组织的普遍缺失。\n\n选择唯一最佳选项。", "solution": "首先，将根据既定的科学和逻辑原理对问题陈述进行严格的验证程序。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题陈述提供了以下信息：\n*   **系统：** 脊椎动物模型生物。\n*   **基因操作：** 一个tamoxifen诱导的、组织特异性的转基因，可稳定$\\beta$-catenin，导致经典Wnt信号通路的选择性、强有力激活。\n*   **目标组织：** 前部神经外胚层。\n*   **诱导时间：** 晚期原肠胚到早期神经胚阶段。\n*   **发育背景：** 神经板沿前后轴的区域化。\n*   **目标：** 预测前部神经外胚层及其衍生物中最一致的表型组合。\n*   **假设/约束：**\n    1.  非经典Wnt通路未被直接改变。\n    2.  骨形态发生蛋白（BMP）水平在全局上未改变。\n    3.  Hedgehog（Hh）信号通路在全局上未改变。\n\n**步骤2：使用提取的已知条件进行验证**\n\n根据以下标准对问题进行评估：\n\n*   **有科学依据：** 该问题牢固地植根于发育生物学的基本原理。经典Wnt信号通路、$\\beta$-catenin、BMP和Hh在胚胎外胚层模式形成中的作用是公认的核心概念。由$\\beta$-catenin介导的经典Wnt信号通路经实验验证是神经外胚层的主要后部化信号。所描述的实验设计——在特定的时空背景下诱导信号通路的激活——是该领域的标准且强大的方法论。该设定在科学上是合理和现实的。\n*   **定义明确：** 问题定义清晰。它明确了系统、扰动、时间点和一系列约束条件。这种结构允许从基本原理中推导出一个唯一且合乎逻辑的解决方案。问题要求的是“表型组合”，这是对复杂发育结果提问的标准方式。\n*   **客观性：** 语言技术性强、精确，没有主观性或模糊性。诸如“经典Wnt信号通路”、“$\\beta$-catenin稳定”和“前部神经外胚层”等术语在发育生物学中具有特定的、普遍理解的含义。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。它在科学上合理、定义明确且客观。它代表了发育神经生物学中的一个经典思想实验。因此，将推导出一个解决方案。\n\n### 解题推导\n\n解决方案从以下脊椎动物胚胎模式形成的基本原理推导得出：\n\n1.  **神经板模式形成：** 在原肠胚形成和神经胚形成期间，外胚层被模式化为不同的区域。中心区域成为神经板（中枢神经系统的前体），其两侧是神经板边界（NPB）。NPB以外的组织成为表面外胚层（表皮）。\n2.  **前后（A-P）轴的确定：** 神经板沿着A-P轴被模式化，以形成主要的大脑分区（前脑、中脑、后脑）和脊髓。由组织者分泌的BMP信号拮抗剂诱导的神经组织的“默认”状态是前部或前脑样的。这种前部特征的发育和维持关键依赖于对后部化信号的*抑制*。\n3.  **经典Wnt信号通路的作用：** 经典Wnt信号通路通过稳定$\\beta$-catenin并使其核转位来运作，是神经外胚层的主要后部化信号。沿A-P轴存在一个Wnt活性梯度，前部水平低，向后部逐渐升高。最前部的结构，包括前脑和眼域，在无Wnt的环境中发育，这种环境由前部脏层内胚层和脊索前中内胚层分泌的Wnt拮抗剂（例如Dkk1、Cerberus、sFRPs）主动维持。\n4.  **神经板边界（NPB）的命运决定：** NPB既产生神经嵴，也产生颅基板。这些命运的确定受Wnt、BMP和FGF等信号的复杂相互作用调控。\n    *   **基板前区域（PPD）：** 该区域位于前部NPB，产生嗅觉、晶状体和腺垂体基板。其确定需要Wnt和BMP水平均较低的信号环境。\n    *   **神经嵴：** 这一细胞群体源自更靠后的NPB（以及后来的背侧神经管）。其诱导由Wnt信号与中等水平的BMP信号协同促进。\n\n**应用于本问题：**\n\n该实验涉及在A-P模式形成发生时，于前部神经外胚层中异位激活经典Wnt信号通路（通过$\\beta$-catenin稳定）。根据上述原理，预测会产生以下后果：\n\n*   **前部神经板的后部化：** 强制激活的Wnt/$\\beta$-catenin信号将覆盖前部神经发育所需的内源性Wnt抑制环境。前部神经外胚层将被重新指定为更靠后的命运。这将导致无法形成前脑衍生物（如端脑、间脑）和视泡（眼域）。这种表型被称为“前部截短”或“尾部化”。前部神经板将转而表达更靠后区域的特征基因，如中脑、后脑甚至脊髓的基因。\n*   **前部NPB命运的破坏：** 异位的Wnt信号将改变前部NPB的信号环境。\n    *   需要低Wnt水平的PPD将无法被指定或维持。因此，其衍生物——颅基板（晶状体、嗅觉等）——将严重减少或缺失。\n    *   相反，由于Wnt信号促进神经嵴诱导，前部NPB的异位Wnt激活预计将以牺牲基板命运为代价，促进神经嵴命运。这将导致前部头部区域神经嵴细胞的相对或绝对扩张。\n\n这一预测的表型组合——前部截短、后部转化、基板缺失和神经嵴扩张——是该实验扰动的逻辑结果。\n\n### 选项评估\n\n*   **A. 严重的前部截短，其特征为前脑衍生物（包括端脑和眼域）的缺失或严重减少，后部神经特征向前扩展至吻侧神经板，基板前区域减少并伴随颅基板（如晶状体、嗅觉和腺垂体基板）的缺失，以及前部神经板边界处神经嵴的相对扩张。**\n    该选项精确地描述了从基本原理推导出的所有预期后果：神经管的后部化（前部截短）、基板衍生物的减少以及神经嵴命运的促进。\n    **结论：正确。**\n\n*   **B. 前脑和眼域的大规模扩张和重复，同时抑制后部神经命运，并伴有基板前区域的扩大和前部神经板边界处神经嵴的抑制。**\n    这描述了*抑制*经典Wnt信号通路所预期的表型，而非其激活。这与正确预测完全相反。\n    **结论：错误。**\n\n*   **C. 前部神经特征基本保留，但由于中线缺陷而出现独眼畸形，同时基板衍生物正常形成，后部神经基因表达边界保持不变。**\n    这在多个方面都是错误的。独眼畸形是典型的与Hh信号不足相关的中线缺陷，而问题明确假设Hh信号未变。最重要的是，异位Wnt信号从根本上改变了A-P特征；因此，前部特征不会“基本保留”。\n    **结论：错误。**\n\n*   **D. 前部神经管的选择性背侧化，保留了前后轴特征，导致顶板标记物增加，而前脑大小或基板与神经嵴的分配没有重大变化。**\n    虽然Wnt信号确实在神经管中具有背侧化作用，但其对A-P模式形成的影响是首要且压倒性的，尤其是在这些实验条件下。认为在强烈的、异位的Wnt信号在前部区域激活的情况下A-P特征会得以保留是不合逻辑的。该选项错误地将次要作用置于主要作用之上。\n    **结论：错误。**\n\n*   **E. 由于神经诱导受损，前部神经外胚层转化为表面外胚层，导致头部表皮扩大和前部区域中枢神经系统组织的普遍缺失。**\n    这描述了神经诱导的失败，这是一个主要由BMP信号介导的过程。高BMP水平促进表皮命运，而BMP抑制则促进神经命运。该问题是在已经指定的神经外胚层内扰乱Wnt通路，并声明BMP水平未变。因此，转化为表面外胚层不是预期的结果。\n    **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2632453"}, {"introduction": "形态发生素梯度如何精确地指定细胞命运是发育生物学的一个中心问题，而脊髓的背腹轴向图式形成为我们提供了经典的范例。细胞通过解读诸如声 Hedgehog (Shh) 等分子在空间中的浓度来获取其“位置信息”。这项练习 [@problem_id:2632318] 让你从定性描述走向定量建模，通过运用经典的梯度函数和细胞响应函数，你将推導出发育图式如何响应形态发生素水平变化的精确预测，这是理解发育系统“尺度不变性”的关键一步。", "problem": "在腹侧脊髓的图式形成过程中，Sonic hedgehog (Shh) 蛋白建立了一个从腹侧到背侧的浓度梯度，该梯度划分了不同的前体细胞区域，例如运动神经元前体细胞 (pMN) 区域和 V2 中间神经元前体细胞 (p2) 区域。假设以下基本且被广泛接受的原则成立：(i) 细胞将位置信息解读为局部形态发生素浓度的单调函数，(ii) 边界位置对应于一个具有交叉抑制并实现固定响应阈值的基因调控网络的等响应轮廓，以及 (iii) 在稳态下，一个在边界处产生并在组织中被均匀清除的形态发生素会形成一个随距源头距离变化的近似指数浓度分布。设 Shh 沿背腹轴的浓度为 $S(x)=S_{0}\\exp(-x/\\lambda)$，其中 $x\\ge 0$，$x$ 是距离腹侧中线的距离，$S_{0}$ 是腹侧的浓度幅值，$\\lambda$ 是衰减长度。假设决定 pMN 与 p2 细胞命运的相关转录输出 $R$ 是对 Shh 浓度的一种希尔型响应，由 $R(S)=\\dfrac{S^{n}}{K^{n}+S^{n}}$ 给出，其中希尔系数 $n>0$，半激活常数 $K>0$。pMN/p2 边界定义为响应达到由交叉抑制网络决定的固定阈值 $R_{c}$ ($0<R_{c}<1$) 时的位置 $x_{b}$。\n\n现在考虑一个扰动，该扰动增加了 Shh 的产生，使腹侧幅值变为 $S_{0}^{\\prime}=\\alpha S_{0}$（其中 $\\alpha>0$），而 $n$、$K$、$\\lambda$ 和 $R_{c}$ 保持不变。设 $x_{b}^{\\prime}$ 是由相同的响应阈值 $R_{c}$ 定义的新边界位置。请根据所述原则，推导边界位移 $\\Delta x=x_{b}^{\\prime}-x_{b}$ 仅作为 $\\alpha$ 和 $\\lambda$ 函数的闭式符号表达式。请以单个闭式符号表达式的形式给出你的答案。", "solution": "该问题要求推导在源浓度幅值发生变化时，由形态发生素定义的边界位移 $\\Delta x$。问题陈述在科学上是合理的，在数学上是适定的，提供了足够的原则和方程来确定唯一解。我们将进行形式推导。\n\n形态发生素 Sonic hedgehog ($Shh$) 沿背腹轴的浓度由函数 $S(x) = S_{0}\\exp(-x/\\lambda)$ 给出，其中 $x$ 是距腹侧中线的距离，$S_{0}$ 是源头 ($x=0$) 的浓度，$\\lambda$ 是梯度的特征衰减长度。\n\n细胞对局部 $Shh$ 浓度 $S$ 的响应由一个希尔函数描述：\n$$ R(S) = \\frac{S^{n}}{K^{n}+S^{n}} $$\n其中 $n$ 是希尔系数，$K$ 是半激活常数。\n\n一个特定的细胞命运边界，在此例中是 pMN 和 p2 前体细胞区域之间的边界，建立在细胞响应 $R$ 达到临界阈值 $R_{c}$ 的位置 $x_{b}$ 处。这与位置信息原则一致，即浓度阈值指定了不同的发育结果。因此，边界的位置 $x_{b}$ 由以下方程定义：\n$$ R(S(x_{b})) = R_{c} $$\n代入 $R(S)$ 的表达式，我们得到：\n$$ \\frac{(S(x_{b}))^{n}}{K^{n}+(S(x_{b}))^{n}} = R_{c} $$\n这个方程定义了对应于边界的特定形态发生素浓度，我们称之为 $S_{b} = S(x_b)$。我们可以求解 $S_{b}$：\n$$ (S_{b})^{n} = R_{c} (K^{n} + (S_{b})^{n}) $$\n$$ (S_{b})^{n} = R_{c}K^{n} + R_{c}(S_{b})^{n} $$\n$$ (S_{b})^{n} (1 - R_{c}) = R_{c}K^{n} $$\n$$ (S_{b})^{n} = \\frac{R_{c}K^{n}}{1 - R_{c}} $$\n$$ S_{b} = K \\left( \\frac{R_{c}}{1 - R_{c}} \\right)^{1/n} $$\n这表明边界形成于一个恒定的、不随时间变化的等浓度轮廓 $S_{b}$ 处，其值由基因调控网络的固定参数（$n$、$K$、$R_{c}$）决定。\n\n现在，我们使用浓度分布函数 $S(x)$ 将此阈值浓度 $S_{b}$ 与边界的空间位置 $x_{b}$ 联系起来。\n$$ S(x_{b}) = S_{0}\\exp(-x_{b}/\\lambda) = S_{b} $$\n为了求解 $x_{b}$，我们对等式两边取自然对数：\n$$ \\exp(-x_{b}/\\lambda) = \\frac{S_{b}}{S_{0}} $$\n$$ -\\frac{x_{b}}{\\lambda} = \\ln\\left(\\frac{S_{b}}{S_{0}}\\right) $$\n$$ x_{b} = -\\lambda \\ln\\left(\\frac{S_{b}}{S_{0}}\\right) = \\lambda \\ln\\left(\\left(\\frac{S_{b}}{S_{0}}\\right)^{-1}\\right) = \\lambda \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) $$\n这就是初始边界位置的表达式。\n\n接下来，我们考虑扰动。$Shh$ 的产生发生改变，使得源浓度变为 $S_{0}^{\\prime} = \\alpha S_{0}$。新的浓度分布为 $S^{\\prime}(x) = S_{0}^{\\prime}\\exp(-x/\\lambda) = \\alpha S_{0}\\exp(-x/\\lambda)$。响应网络的参数（$n$、$K$）和阈值（$R_{c}$）保持不变。因此，边界现在将形成在一个新的位置 $x_{b}^{\\prime}$，在该位置新的浓度分布 $S^{\\prime}(x)$ 等于相同的阈值浓度 $S_{b}$。\n$$ S^{\\prime}(x_{b}^{\\prime}) = \\alpha S_{0}\\exp(-x_{b}^{\\prime}/\\lambda) = S_{b} $$\n我们求解新的边界位置 $x_{b}^{\\prime}$：\n$$ \\exp(-x_{b}^{\\prime}/\\lambda) = \\frac{S_{b}}{\\alpha S_{0}} $$\n$$ -\\frac{x_{b}^{\\prime}}{\\lambda} = \\ln\\left(\\frac{S_{b}}{\\alpha S_{0}}\\right) $$\n$$ x_{b}^{\\prime} = -\\lambda \\ln\\left(\\frac{S_{b}}{\\alpha S_{0}}\\right) = \\lambda \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) $$\n问题要求的是边界位移 $\\Delta x = x_{b}^{\\prime} - x_{b}$。我们代入 $x_{b}^{\\prime}$ 和 $x_{b}$ 的表达式：\n$$ \\Delta x = \\lambda \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) - \\lambda \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) $$\n使用对数恒等式 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们可以简化此表达式：\n$$ \\Delta x = \\lambda \\left[ \\ln\\left(\\frac{\\alpha S_{0}}{S_{b}}\\right) - \\ln\\left(\\frac{S_{0}}{S_{b}}\\right) \\right] = \\lambda \\ln\\left( \\frac{\\frac{\\alpha S_{0}}{S_{b}}}{\\frac{S_{0}}{S_{b}}} \\right) $$\n$$ \\Delta x = \\lambda \\ln(\\alpha) $$\n这个边界位移 $\\Delta x$ 的最终表达式只与源浓度的倍数变化 $\\alpha$ 和梯度衰减长度 $\\lambda$ 有关，符合题意。描述转录响应细节的参数 $n$、$K$ 和 $R_{c}$ 不影响位移，只影响边界的绝对位置。", "answer": "$$\\boxed{\\lambda \\ln(\\alpha)}$$", "id": "2632318"}, {"introduction": "发育中的生物系统如何自发地形成复杂的空间图式？“反应-扩散”机制为此提供了一个强有力的理论框架，其中骨形态发生蛋白（BMP）与其抑制剂（如Chordin）的相互作用是外胚层背腹轴向图式形成和神经诱导的经典案例。这项高级练习 [@problem_id:2632435] 将指导你从基本物理化学原理出发，一步步构建一个计算模型。通过亲手实现并运行这个模型，你将获得系统生物学研究的实践经验，即如何运用计算机模拟来测试关于发育网络动态、稳定性和参数敏感性的科学假说。", "problem": "考虑沿外胚层片的一维背腹轴，由空间坐标 $x \\in [0,1]$ 表示。假定当游离的骨形态发生蛋白 (BMP) 浓度足够低时，神经诱导便会发生。令 $B(x,t)$ 表示游离BMP，$C(x,t)$ 表示Chordin，$BC(x,t)$ 表示BMP–Chordin复合物，$T(x,t)$ 表示Tolloid。假设所有物种在 $x=0$ 和 $x=1$ 处满足零通量（Neumann）边界条件，并且初始时对所有 $x$，都有 $B(x,0)=C(x,0)=BC(x,0)=T(x,0)=0$。\n\n从以下基本原理出发：\n- 菲克扩散定律，对于任何扩散系数为 $D$ 的可扩散物种 $u(x,t)$，其在一维情况下产生一个扩散项 $D \\,\\partial^2 u/\\partial x^2$。\n- 适用于可逆结合和酶切反应的质量作用定律，其产生的反应项与反应物浓度的乘积成正比。\n\n提出并实现一个由以下偏微分方程（PDEs）组成的反应扩散模型，其中每一项都必须源于上述原理并进行生物学解释：\n- 每个物种的扩散，其扩散系数分别为 $D_B$、$D_C$、$D_{BC}$ 和 $D_T$。\n- 代表BMP和Chordin的空间局域化生成以及Tolloid的均匀生成的源项：\n  - $s_B(x) = s_{B0}\\cdot \\dfrac{1}{2}\\left(1+\\tanh\\left(\\dfrac{x-x_v}{\\sigma}\\right)\\right)$，其中 $x_v=0.7$ 和 $\\sigma=0.1$，用于建模腹侧偏向的BMP源。\n  - $s_C(x) = s_{C0}\\cdot \\dfrac{1}{2}\\left(1+\\tanh\\left(\\dfrac{x_d-x}{\\sigma}\\right)\\right)$，其中 $x_d=0.3$ 和 $\\sigma=0.1$，用于建模背侧偏向的Chordin源。\n  - $s_T(x) = s_{T0}$ （均匀），用于建模空间均匀的Tolloid生成。\n- 可逆结合 $B + C \\rightleftharpoons BC$，其正向反应速率常数为 $k_{\\text{on}}$，逆向反应速率常数为 $k_{\\text{off}}$。\n- Tolloid对$BC$进行蛋白水解切割以释放游离BMP，其速率常数为 $k_{\\text{cleave}}$；以及各物种的一阶降解，其相应的速率常数分别为 $k_{\\text{deg},B}$、$k_{\\text{deg},C}$、$k_{\\text{deg},BC}$ 和 $k_{\\text{deg},T}$。\n\n你的程序必须将长度为 $L=1$ 的空间离散化为 $N=100$ 个点，强制执行零通量边界条件，并对得到的半离散系统进行时间积分，直到在最终时间 $t_{\\text{final}}=10$ 达到准稳态。所有量均被视为无量纲（无物理单位）。使用任何数值稳定的求解器求解得到的常微分方程（ODEs）系统，前提是该求解器能保证浓度的非负性。\n\n在积分到 $t_{\\text{final}}$ 后，为每个测试用例计算游离BMP浓度 $B(x,t_{\\text{final}})$ 低于神经诱导阈值 $\\theta$ 的空间网格点所占的比例。该比例应以 $[0,1]$ 范围内的浮点数形式返回，四舍五入到三位小数。不应使用百分比；结果以小数形式表示。\n\n除非在测试用例中另有规定，否则请使用以下固定参数值：\n- 扩散系数：$D_B=1.0\\times 10^{-2}$，$D_C=1.0\\times 10^{-2}$，$D_{BC}=5.0\\times 10^{-3}$，$D_T=5.0\\times 10^{-3}$。\n- 结合与降解动力学：$k_{\\text{on}}=50.0$，$k_{\\text{off}}=0.1$，$k_{\\text{deg},B}=0.01$，$k_{\\text{deg},C}=0.01$，$k_{\\text{deg},BC}=0.01$，$k_{\\text{deg},T}=0.01$。\n- 源参数：$x_v=0.7$，$x_d=0.3$，$\\sigma=0.1$。\n\n实现该模型，并为以下每个测试用例计算所需的比例，每个用例指定了 $(s_{B0}, s_{C0}, s_{T0}, k_{\\text{cleave}}, \\theta)$：\n\n- 案例 1（正常路径）：$(1.0, 1.0, 0.5, 1.0, 0.1)$。\n- 案例 2（无Chordin）：$(1.0, 0.0, 0.5, 1.0, 0.1)$。\n- 案例 3（无Tolloid）：$(1.0, 1.0, 0.0, 1.0, 0.1)$。\n- 案例 4（强Tolloid，BMP减少）：$(0.2, 0.5, 2.0, 1.0, 0.1)$。\n\n你的程序应产生单行输出，其中包含四个结果，格式为用方括号括起来的逗号分隔列表，每个浮点数四舍五入到三位小数，例如 $[r_1,r_2,r_3,r_4]$。", "solution": "问题陈述已经过验证，并被认定为有效。它描述了理论发育生物学中一个有科学依据、适定且客观的问题。该模型基于反应扩散系统的既定原理，并且所有参数、边界条件和初始条件都已指定，从而允许存在唯一的数值解。陈述中没有矛盾、歧义或科学上不合理之处。\n\n任务是为一个由四种相互作用的形态发生素——骨形态发生蛋白 ($B$)、Chordin ($C$)、BMP-Chordin复合物 ($BC$) 和 Tolloid ($T$)——组成的系统建模，该系统沿着由空间域 $x \\in [0, 1]$ 表示的一维外胚层片分布，并描述其时空动态。该模型是根据第一性原理构建的：用于扩散的菲克定律和用于化学反应的质量作用定律。\n\n该系统由以下耦合偏微分方程组（PDEs）描述：\n\n1.  **游离BMP, $B(x,t)$:**\n    游离BMP的浓度因扩散、空间局域化的源、降解、与Chordin的可逆结合以及通过Tolloid切割从$BC$复合物中释放而变化。\n    $$ \\frac{\\partial B}{\\partial t} = D_B \\frac{\\partial^2 B}{\\partial x^2} + s_B(x) - k_{\\text{deg},B} B - k_{\\text{on}} B C + k_{\\text{off}} (BC) + k_{\\text{cleave}} T (BC) $$\n    -   $D_B \\frac{\\partial^2 B}{\\partial x^2}$：扩散，源于菲克定律。\n    -   $s_B(x)$：空间变化的生成，局域于腹侧（$x$ 接近 $0.7$）。\n    -   $-k_{\\text{deg},B} B$：一阶降解。\n    -   $-k_{\\text{on}} B C$：通过与Chordin结合消耗游离BMP，源于 $B+C \\to BC$ 的质量作用定律。\n    -   $+k_{\\text{off}} (BC)$：通过复合物解离产生游离BMP，源于 $BC \\to B+C$。\n    -   $+k_{\\text{cleave}} T (BC)$：通过Tolloid对复合物进行酶切产生游离BMP，其中Tolloid作为催化剂。\n\n2.  **游离Chordin, $C(x,t)$:**\n    游离Chordin的浓度因扩散、空间局域化的源、降解以及与BMP的可逆结合而变化。\n    $$ \\frac{\\partial C}{\\partial t} = D_C \\frac{\\partial^2 C}{\\partial x^2} + s_C(x) - k_{\\text{deg},C} C - k_{\\text{on}} B C + k_{\\text{off}} (BC) $$\n    -   各项与BMP的类似，除了切割项。问题陈述指出 $BC$ 的切割会释放游离BMP；我们假设Chordin部分在此过程中失活或被破坏，并且不会返回到活性的游离Chordin池中。\n\n3.  **BMP-Chordin复合物, $BC(x,t)$:**\n    该复合物的浓度因扩散、由游离BMP和Chordin形成、解离、被Tolloid切割以及降解而变化。\n    $$ \\frac{\\partial (BC)}{\\partial t} = D_{BC} \\frac{\\partial^2 (BC)}{\\partial x^2} + k_{\\text{on}} B C - k_{\\text{off}} (BC) - k_{\\text{cleave}} T (BC) - k_{\\text{deg},BC} (BC) $$\n    -   $D_{BC} \\frac{\\partial^2 (BC)}{\\partial x^2}$：复合物的扩散。\n    -   $+k_{\\text{on}} B C$：复合物的形成。\n    -   $-k_{\\text{off}} (BC)$：复合物的解离。\n    -   $-k_{\\text{cleave}} T (BC)$：Tolloid切割导致复合物的破坏。\n    -   $-k_{\\text{deg},BC} (BC)$：复合物的一阶降解。\n\n4.  **Tolloid, $T(x,t)$:**\n    Tolloid的浓度因扩散、均匀生成和降解而变化。它作为一种酶，在切割反应中不被消耗。\n    $$ \\frac{\\partial T}{\\partial t} = D_T \\frac{\\partial^2 T}{\\partial x^2} + s_{T0} - k_{\\text{deg},T} T $$\n    -   $D_T \\frac{\\partial^2 T}{\\partial x^2}$：Tolloid的扩散。\n    -   $s_{T0}$：空间均匀的生成。\n    -   $-k_{\\text{deg},T} T$：一阶降解。\n\n为了对此系统进行数值求解，我们采用线方法（Method of Lines）。空间在区间 $[0, 1]$ 上被离散化为 $N=100$ 个网格点 $x_i$，间距为 $\\Delta x = 1/(N-1)$。这将该偏微分方程组转化为一个包含 $4 \\times N$ 个耦合常微分方程（ODEs）的系统。\n\n在内部网格点 $x_i$ 处的扩散项（拉普拉斯算子）$\\frac{\\partial^2 u}{\\partial x^2}$ 使用二阶中心差分公式进行近似：\n$$ \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_i \\approx \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2} $$\n零通量（Neumann）边界条件 $\\frac{\\partial u}{\\partial x}|_{x=0} = \\frac{\\partial u}{\\partial x}|_{x=1} = 0$ 通过引入“虚拟点”来实施，使得 $u_{-1} = u_1$ 且 $u_N = u_{N-2}$。这导致在边界处有以下近似：\n$$ \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_0 \\approx \\frac{2(u_1 - u_0)}{(\\Delta x)^2} \\quad \\text{和} \\quad \\left(\\frac{\\partial^2 u}{\\partial x^2}\\right)_{N-1} \\approx \\frac{2(u_{N-2} - u_{N-1})}{(\\Delta x)^2} $$\n得到的常微分方程组 $\\frac{d\\vec{y}}{dt} = \\vec{f}(t, \\vec{y})$（其中 $\\vec{y}(t)$ 是所有网格点上所有浓度值的扁平化向量）的初始条件为 $\\vec{y}(0) = \\vec{0}$。由于反应和扩散的时间尺度不同，该系统很可能是刚性的。因此，使用一个合适的隐式求解器（例如 `scipy.integrate.solve_ivp` 中实现的后向差分公式（BDF）方法）将其从 $t=0$ 积分到 $t_{\\text{final}}=10$。\n\n积分后，提取游离BMP的最终浓度分布 $B(x_i, t_{\\text{final}})$。对应于神经诱导的区域所占比例，其计算方法为满足 $B(x_i, t_{\\text{final}})  \\theta$ 的网格点数除以总网格点数 $N$。每个测试用例的结果都四舍五入到三位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the reaction-diffusion system for ectodermal patterning.\n    \"\"\"\n    \n    # --- Fixed Parameters ---\n    N = 100  # Number of spatial grid points\n    L = 1.0  # Length of the domain\n    x_grid = np.linspace(0, L, N)\n    dx = L / (N - 1)\n    t_final = 10.0\n\n    # Diffusion coefficients\n    D_B = 1.0e-2\n    D_C = 1.0e-2\n    D_BC = 5.0e-3\n    D_T = 5.0e-3\n\n    # Binding and degradation kinetics\n    k_on = 50.0\n    k_off = 0.1\n    k_deg_B = 0.01\n    k_deg_C = 0.01\n    k_deg_BC = 0.01\n    k_deg_T = 0.01\n    \n    # Source shape parameters\n    x_v = 0.7\n    x_d = 0.3\n    sigma = 0.1\n\n    # --- Test Cases ---\n    # Each case is a tuple: (s_B0, s_C0, s_T0, k_cleave, theta)\n    test_cases = [\n        (1.0, 1.0, 0.5, 1.0, 0.1),  # Case 1 (happy path)\n        (1.0, 0.0, 0.5, 1.0, 0.1),  # Case 2 (no Chordin)\n        (1.0, 1.0, 0.0, 1.0, 0.1),  # Case 3 (no Tolloid)\n        (0.2, 0.5, 2.0, 1.0, 0.1),  # Case 4 (strong Tolloid with reduced BMP)\n    ]\n    \n    def ode_system(t, y, p):\n        \"\"\"\n        Defines the system of ODEs for the reaction-diffusion model.\n        \"\"\"\n        # Unpack parameters\n        D_B, D_C, D_BC, D_T, k_on, k_off, k_cleave, k_deg_B, k_deg_C, k_deg_BC, k_deg_T, s_B_vec, s_C_vec, s_T0, N, dx = p\n\n        # Reshape the flattened state vector y into a (4, N) matrix\n        concentrations = y.reshape((4, N))\n        B, C, BC, T = concentrations[0], concentrations[1], concentrations[2], concentrations[3]\n\n        # Initialize derivatives\n        dydt = np.zeros_like(concentrations)\n        dB_dt, dC_dt, dBC_dt, dT_dt = dydt[0], dydt[1], dydt[2], dydt[3]\n\n        # --- Diffusion Terms (Discretized Laplacian with Neumann BCs) ---\n        def laplacian(u, D, dx_val):\n            lap = np.zeros_like(u)\n            # Interior points\n            lap[1:-1] = (u[:-2] - 2 * u[1:-1] + u[2:]) / dx_val**2\n            # Boundary points (zero-flux)\n            lap[0] = 2 * (u[1] - u[0]) / dx_val**2\n            lap[-1] = 2 * (u[-2] - u[-1]) / dx_val**2\n            return D * lap\n\n        dB_dt += laplacian(B, D_B, dx)\n        dC_dt += laplacian(C, D_C, dx)\n        dBC_dt += laplacian(BC, D_BC, dx)\n        dT_dt += laplacian(T, D_T, dx)\n\n        # --- Reaction Terms (pointwise) ---\n        binding = k_on * B * C\n        unbinding = k_off * BC\n        cleavage = k_cleave * T * BC\n        \n        # BMP equation\n        dB_dt += s_B_vec - k_deg_B * B - binding + unbinding + cleavage\n        # Chordin equation\n        dC_dt += s_C_vec - k_deg_C * C - binding + unbinding\n        # BMP-Chordin Complex equation\n        dBC_dt += binding - unbinding - cleavage - k_deg_BC * BC\n        # Tolloid equation\n        dT_dt += s_T0 - k_deg_T * T\n\n        # Return the flattened derivatives\n        return dydt.flatten()\n\n    results = []\n    for case in test_cases:\n        s_B0, s_C0, s_T0, k_cleave, theta = case\n\n        # --- Calculate spatially-varying source terms ---\n        s_B_vec = s_B0 * 0.5 * (1 + np.tanh((x_grid - x_v) / sigma))\n        s_C_vec = s_C0 * 0.5 * (1 + np.tanh((x_d - x_grid) / sigma))\n\n        # --- Package parameters for the solver ---\n        params = (D_B, D_C, D_BC, D_T, k_on, k_off, k_cleave, k_deg_B, k_deg_C, k_deg_BC, k_deg_T, s_B_vec, s_C_vec, s_T0, N, dx)\n\n        # --- Initial Conditions ---\n        y0 = np.zeros(4 * N)\n        \n        # --- Time Integration ---\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=(0, t_final),\n            y0=y0,\n            method='BDF',\n            args=(params,),\n            t_eval=[t_final]  # Evaluate only at the final time\n        )\n        \n        # --- Post-processing ---\n        final_state = sol.y[:, -1]\n        \n        # Extract final BMP concentration profile\n        B_final = final_state[0:N]\n        \n        # Ensure non-negativity from numerical artifacts\n        B_final[B_final  0] = 0\n        \n        # Calculate the fraction of grid points below the threshold\n        neural_domain_count = np.sum(B_final  theta)\n        fraction = neural_domain_count / N\n        \n        # Round and store the result\n        results.append(round(fraction, 3))\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2632435"}]}