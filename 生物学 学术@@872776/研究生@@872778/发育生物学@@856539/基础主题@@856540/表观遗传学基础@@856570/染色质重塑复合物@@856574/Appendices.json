{"hands_on_practices": [{"introduction": "对染色质重塑的理解始于单个酶与单个核小体相互作用的层面。本练习将结合生物物理学和生物化学中的关键概念——结合平衡、酶动力学和随机运动——来建立一个描述重塑酶速度的定量模型。通过这项实践 [@problem_id:2933156]，你将锻炼推导和应用多部分生物物理模型的能力。", "problem": "当一个依赖三磷酸腺苷(ATP)的染色质重塑酶与核小体结合时，它会以单碱基对的步长将DNA移过组蛋白八聚体。假设以下机理特征，所有这些特征都与已确立的超家族$2$解旋酶样重塑酶模型一致：(i) 当该酶与核小体结合时，每次ATP水解事件会以概率 $p_{f}$ 产生一个大小为 $1$ 碱基对的前向步进，以概率 $p_{b}$ 产生一个大小为 $1$ 碱基对的后向步进，并以概率 $p_{0}$ 不产生净位移，且 $p_{f}+p_{b}+p_{0}=1$；(ii) ATPase的活性受核小体结合的强烈刺激，使得催化循环仅在结合状态下遵循米氏动力学(Michaelis–Menten kinetics)；以及(iii) 在步进的时间尺度上，酶-核小体结合达到快速预平衡，因此一个代表性核小体被酶占据的时间分数等于其平衡占据分数。\n\n给定以下参数值：总酶浓度 $E_{T}=20$ nM，总核小体浓度 $N_{T}=10$ nM，$E+N \\rightleftharpoons EN$ 的解离常数等于 $K_{d}=5$ nM，在结合状态下的催化转换数 $k_{\\text{cat}}=50$ s$^{-1}$，米氏常数 $K_{m}=0.10$ mM，ATP浓度 $[\\text{ATP}]=0.50$ mM，以及步进概率 $p_{f}=0.80$，$p_{b}=0.10$，$p_{0}=0.10$。假设每个机械化学事件的步长为 $1$ 碱基对，并且在未结合状态下的ATP水解可以忽略不计。\n\n仅从 (a) 平衡时 $1{:}1$ 结合的质量作用定律，(b) 结合状态下ATPase循环的米氏速率定律(Michaelis–Menten rate law)，以及 (c) 速度的定义，即单位时间的期望位移出发，推导一个代表性核小体平均滑动速度的解析表达式，然后计算将单个核小体重新定位 $50$ 个碱基对所需的平均时间。将最终数值答案四舍五入至三位有效数字。以秒为单位表示最终时间。", "solution": "所提出的问题是生物物理化学中的一个有效练习，它要求综合来自结合平衡、酶动力学和随机过程理论的概念。该问题提法明确，有科学依据，并为得到唯一解提供了所有必需的参数。我们将开始推导。\n\n目标是推导核小体平均滑动速度的表达式，然后计算重新定位 $50$ 个碱基对($bp$)所需的时间。推导将基于规定的三个原理：质量作用定律、米氏速率定律(Michaelis–Menten rate law)以及速度作为单位时间期望位移的定义。\n\n首先，我们确定平衡时酶-核小体复合物的浓度 $[EN]$。结合反应为 $E + N \\rightleftharpoons EN$。解离常数 $K_d$ 由质量作用定律定义为：\n$$K_d = \\frac{[E][N]}{[EN]}$$\n此处，$[E]$ 和 $[N]$ 分别是游离酶和游离核小体的浓度。总浓度 $E_T$ 和 $N_T$ 是守恒的：\n$$E_T = [E] + [EN]$$\n$$N_T = [N] + [EN]$$\n将游离浓度的表达式 $[E] = E_T - [EN]$ 和 $[N] = N_T - [EN]$ 代入 $K_d$ 的方程，得到：\n$$K_d = \\frac{(E_T - [EN])(N_T - [EN])}{[EN]}$$\n这可以重排成一个关于 $[EN]$ 的二次方程：\n$$K_d [EN] = E_T N_T - (E_T + N_T)[EN] + [EN]^2$$\n$$[EN]^2 - (E_T + N_T + K_d)[EN] + E_T N_T = 0$$\n使用二次公式求解 $[EN]$，得到两个可能的解：\n$$[EN] = \\frac{(E_T + N_T + K_d) \\pm \\sqrt{(E_T + N_T + K_d)^2 - 4E_T N_T}}{2}$$\n复合物的浓度 $[EN]$ 不能超过任一反应物的总浓度，即 $[EN] \\le N_T$ 且 $[EN] \\le E_T$。这个条件要求选择负根，这是唯一具有物理意义的解。\n$$[EN] = \\frac{(E_T + N_T + K_d) - \\sqrt{(E_T + N_T + K_d)^2 - 4E_T N_T}}{2}$$\n\n第二，我们确定一个代表性核小体被酶占据的时间分数。题目说明这等于平衡占据分数 $\\theta_N$。\n$$\\theta_N = \\frac{[EN]}{N_T}$$\n代入 $[EN]$ 的表达式：\n$$\\theta_N = \\frac{(E_T + N_T + K_d) - \\sqrt{(E_T + N_T + K_d)^2 - 4E_T N_T}}{2N_T}$$\n\n第三，我们确定ATP水解的速率，它对应于易位尝试的速率。这只发生在结合状态，并遵循米氏动力学(Michaelis–Menten kinetics)。每个结合复合物的步进尝试速率 $k_{\\text{step}}$ 由下式给出：\n$$k_{\\text{step}} = \\frac{k_{\\text{cat}}[\\text{ATP}]}{K_m + [\\text{ATP}]}$$\n其中 $k_{\\text{cat}}$ 是转换数，$K_m$ 是米氏常数，$[\\text{ATP}]$ 是底物浓度。\n\n第四，我们计算每个机械化学事件（步进）的期望位移。在前向步进概率为 $p_f$、后向步进概率为 $p_b$、步长为 $\\Delta x = 1$ bp 的情况下，每步的期望位移 $\\langle \\Delta x \\rangle_{\\text{step}}$ 为：\n$$\\langle \\Delta x \\rangle_{\\text{step}} = (+ \\Delta x) p_f + (-\\Delta x) p_b + (0) p_0 = (p_f - p_b)\\Delta x$$\n\n一个代表性核小体的平均滑动速度 $V$ 是该核小体平均步进事件速率与每事件期望位移的乘积。一个核小体仅在其结合的时间分数 $\\theta_N$ 内是活跃的。\n$$V = \\theta_N \\times k_{\\text{step}} \\times \\langle \\Delta x \\rangle_{\\text{step}}$$\n代入推导出的表达式，得到平均速度的完整解析表达式：\n$$V = \\left( \\frac{(E_T + N_T + K_d) - \\sqrt{(E_T + N_T + K_d)^2 - 4E_T N_T}}{2N_T} \\right) \\left( \\frac{k_{\\text{cat}}[\\text{ATP}]}{K_m + [\\text{ATP}]} \\right) (p_f - p_b)\\Delta x$$\n\n现在，我们计算每个分量的数值。\n给定参数：$E_T=20$ nM, $N_T=10$ nM, $K_d=5$ nM。\n占据分数 $\\theta_N$ 为：\n$$\\theta_N = \\frac{(20 + 10 + 5) - \\sqrt{(20 + 10 + 5)^2 - 4(20)(10)}}{2(10)} = \\frac{35 - \\sqrt{35^2 - 800}}{20} = \\frac{35 - \\sqrt{1225 - 800}}{20} = \\frac{35 - \\sqrt{425}}{20}$$\n因为 $\\sqrt{425} = \\sqrt{25 \\times 17} = 5\\sqrt{17}$，\n$$\\theta_N = \\frac{35 - 5\\sqrt{17}}{20} = \\frac{7 - \\sqrt{17}}{4}$$\n\n给定动力学参数：$k_{\\text{cat}}=50$ s$^{-1}$，$K_m=0.10$ mM，$[\\text{ATP}]=0.50$ mM。\n步进速率 $k_{\\text{step}}$ 为：\n$$k_{\\text{step}} = \\frac{50 \\text{ s}^{-1} \\times 0.50 \\text{ mM}}{0.10 \\text{ mM} + 0.50 \\text{ mM}} = \\frac{25}{0.60} \\text{ s}^{-1} = \\frac{125}{3} \\text{ s}^{-1}$$\n\n给定步进参数：$p_f=0.80$，$p_b=0.10$，以及 $\\Delta x=1$ bp。\n每步的期望位移是：\n$$\\langle \\Delta x \\rangle_{\\text{step}} = (0.80 - 0.10) \\times 1 \\text{ bp} = 0.70 \\text{ bp}$$\n\n平均速度 $V$ 是：\n$$V = \\left( \\frac{7 - \\sqrt{17}}{4} \\right) \\left( \\frac{125}{3} \\text{ s}^{-1} \\right) (0.70 \\text{ bp})$$\n$$V \\approx (0.71922) \\times (41.667 \\text{ s}^{-1}) \\times (0.70 \\text{ bp}) \\approx 20.978 \\text{ bp s}^{-1}$$\n\n最后，我们计算将核小体重新定位距离 $D = 50$ bp 所需的平均时间 $t$。假设速度恒定：\n$$t = \\frac{D}{V}$$\n$$t = \\frac{50 \\text{ bp}}{V} = \\frac{50}{\\left( \\frac{7 - \\sqrt{17}}{4} \\right) \\left( \\frac{125}{3} \\right) (0.70)} \\text{ s}$$\n$$t = \\frac{50 \\times 4 \\times 3}{(7 - \\sqrt{17})(125)(0.7)} = \\frac{600}{(7 - \\sqrt{17})(87.5)} \\text{ s}$$\n使用先前计算的 $V$ 值：\n$$t \\approx \\frac{50}{20.978} \\text{ s} \\approx 2.3834 \\text{ s}$$\n四舍五入到三位有效数字，平均时间为 $2.38$ 秒。", "answer": "$$\\boxed{2.38}$$", "id": "2933156"}, {"introduction": "重塑酶的微观行为对染色质结构会产生宏观影响，我们可以通过 ATAC-seq 和 MNase-seq 等技术来测量这些影响。本练习 [@problem_id:2796649] 要求你像实验科学家一样思考，预测扰动不同重塑酶家族（SWI/SNF 与 ISWI）将如何改变这些基因组学特征。这项实践对于培养解读实验数据所需的直觉至关重要。", "problem": "一个真核启动子呈现出典型的结构，其转录起始位点 (TSS) 中心是一个核小体耗尽区 (NDR)，两侧分别是上游位置明确的 $-1$ 核小体和下游位置明确的 $+1$ 核小体，并向基因体内延伸形成一个相位化阵列，具有近似规则的核小体重复长度 (NRL)。你在对照条件下以及两种扰动条件下进行了微球菌核酸酶测序 (MNase-seq; Micrococcal Nuclease sequencing) 和使用测序技术的转座酶可及性染色质分析 (ATAC-seq; Assay for Transposase-Accessible Chromatin using sequencing)：扰动一是敲低 SWItch/Sucrose Non-Fermentable (SWI/SNF) 家族的腺苷三磷酸 (ATP) 依赖性重塑因子，扰动二是化学抑制 Imitation SWItch (ISWI) 家族的 ATP 依赖性重塑因子。从以下基本原则出发：(i) 核小体是染色质的基本单位，由大约 $147$ 个碱基对的 DNA 缠绕在一个组蛋白八聚体上构成；(ii) MNase-seq 通过优先切割连接 DNA 来测量核小体的占据和定位，产生的读段反映了受保护的片段；(iii) ATAC-seq 通过 Tn5 转座酶的整合来测量 DNA 的可及性，其中启动子处的高信号与开放的染色质相关，而片段长度的周期性反映了一个或多个核小体的保护作用；(iv) SWI/SNF 家族重塑因子主要通过破坏、滑动和驱逐核小体来打开调控区域；(v) ISWI 家族重塑因子主要通过滑动核小体来生成并维持均匀间隔的阵列；请预测在每种扰动下，该启动子及其侧翼核小体阵列在 MNase-seq 和 ATAC-seq 中你预期会看到的特征性变化。选择能够以科学上一致的方式最好地整合这些预期的唯一选项。\n\nA. SWI/SNF 敲低会增加 NDR/TSS 内的 MNase-seq 占据，并将 $+1$ 核小体向上游移动到 NDR 中，从而降低 ATAC-seq 启动子的可及性（峰高降低，亚核小体片段，例如 $100$ 碱基对，减少）；ISWI 抑制会降低长程相位化（MNase-seq 峰更模糊，NRL 分布变宽），并削弱侧翼区域的 ATAC-seq 核小体周期性，而启动子 ATAC-seq 峰高变化不大。\n\nB. SWI/SNF 敲低由于间距丢失而增加了启动子处的 ATAC-seq 可及性，并减少了 NDR 内的 MNase-seq 占据，而 ISWI 抑制则使 MNase-seq 振荡更尖锐（更强的相位化和更窄的 NRL 分布），并增强了 ATAC-seq 的核小体周期性。\n\nC. SWI/SNF 敲低使 TSS 处的 MNase-seq 保持不变，但减少了整个基因体的核小体占据；ISWI 抑制将阵列压缩成更短的 NRL，具有更尖锐的 MNase-seq 相位化，并导致启动子 ATAC-seq 可及性大幅增加。\n\nD. 由于其他重塑因子的补偿活性，SWI/SNF 敲低全局上增加了核小体间距的规律性（更具周期性的 MNase-seq 阵列），而 ATAC-seq 启动子信号不变；ISWI 抑制使 MNase-seq 图谱保持不变，但几乎完全消除了启动子 ATAC-seq 信号。", "solution": "首先将验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤 1：提取已知信息\n问题提供了以下基本信息：\n- **典型启动子结构**：一个真核启动子，在转录起始位点 (TSS) 有一个核小体耗尽区 (NDR)，两侧分别是位置明确的 $-1$ 核小体和 $+1$ 核小体，以及一个具有规则核小体重复长度 (NRL) 的相位化阵列。\n- **实验技术**：微球菌核酸酶测序 (MNase-seq) 和使用测序技术的转座酶可及性染色质分析 (ATAC-seq)。\n- **扰动**：\n    1. 敲低 SWItch/Sucrose Non-Fermentable (SWI/SNF) 家族的腺苷三磷酸 (ATP) 依赖性重塑因子。\n    2. 化学抑制 Imitation SWItch (ISWI) 家族的 ATP 依赖性重塑因子。\n- **基本原则**：\n    - (i) 核小体是染色质的基本单位，由大约 $147$ 个碱基对的 DNA 缠绕在一个组蛋白八聚体上构成。\n    - (ii) MNase-seq 通过优先切割连接 DNA 来测量核小体的占据和定位，产生的读段反映了受保护的片段。\n    - (iii) ATAC-seq 通过 Tn$5$ 转座酶的整合来测量 DNA 的可及性，其中启动子处的高信号与开放的染色质相关，而片段长度的周期性反映了一个或多个核小体的保护作用。\n    - (iv) SWI/SNF 家族重塑因子主要通过破坏、滑动和驱逐核小体来打开调控区域。\n    - (v) ISWI 家族重塑因子主要通过滑动核小体来生成并维持均匀间隔的阵列。\n\n### 步骤 2：使用提取的已知信息进行验证\n对问题陈述进行严格验证。\n1.  **科学依据**：该问题植根于分子生物学和遗传学的既定原则。关于启动子结构、核小体结构、MNase-seq 和 ATAC-seq 的功能，以及 SWI/SNF 和 ISWI 染色质重塑家族独特作用的描述都是事实正确的，代表了该领域的共识。\n2.  **问题定义明确**：问题定义明确。它要求根据一组给定的基本原则和特定的扰动来预测实验结果。问题的结构使其具有一个可从前提中推导出的唯一的、合乎逻辑的解决方案。\n3.  **客观性**：语言是技术性的、精确的，并且没有主观或含糊的术语。所有使用的术语（例如 NDR、TSS、NRL、SWI/SNF、ISWI）在遗传学中都有标准的、明确定义的含义。\n4.  **完整性和一致性**：问题通过五个基本原则提供了推断两种扰动后果所需的所有必要信息。没有内部矛盾。\n5.  **无其他缺陷**：该问题不是琐碎的、隐喻性的或不切实际的。它代表了染色质调控研究中的一个标准概念性问题。\n\n### 步骤 3：结论和行动\n问题陈述有效。将根据所提供的原则推导出解决方案。\n\n### 解题推导\n解决方案要求预测两种不同扰动对染色质结构的影响，该影响通过 MNase-seq 和 ATAC-seq 进行测量。我们将根据给定的原则分别分析每种扰动。\n\n**SWI/SNF 敲低分析**\n\n- **功能**：根据原则 (iv)，SWI/SNF 重塑因子负责通过破坏、滑动和驱逐核小体来打开调控区域。在所述启动子处，此功能对于维持核小体耗尽区 (NDR) 至关重要。\n- **对 MNase-seq 的预测**：随着 SWI/SNF 活性的降低，清除 NDR 中核小体的力量减弱。这将导致核小体随机或定向地侵入先前开放的区域。因此，测量核小体占据的 MNase-seq 将检测到 NDR 内信号的*增加*。侧翼的核小体，特别是通常被 SWI/SNF 阻挡在外的 $+1$ 核小体，可能会向上游滑入 NDR。\n- **对 ATAC-seq 的预测**：根据原则 (iii)，ATAC-seq 测量 DNA 的可及性。NDR 是活性或待激活启动子处的主要可及性位点。如果由于 SWI/SNF 敲低而导致该区域被核小体占据，其对 Tn$5$ 转座酶的可及性将降低。这将表现为以 TSS 为中心的 ATAC-seq 峰高的*降低*。此外，来自短的、亚核小体片段（例如小于 $100$ 碱基对）的高信号，这是高度可及、无核小体 DNA 的特征，也将减少。\n\n**ISWI 抑制分析**\n\n- **功能**：根据原则 (v)，ISWI 家族重塑因子主要负责滑动核小体以生成并维持均匀间隔的阵列。这产生了延伸到基因体内的规则相位化和一致的核小体重复长度 (NRL)。\n- **对 MNase-seq 的预测**：对 ISWI 的化学抑制将破坏其“间隔”功能。TSS 下游核小体的规则、有序排列将丧失。核小体的位置将变得更加不规则。在 MNase-seq 图谱中，这将表现为长程相位化的丧失。对应于阵列中单个核小体的尖锐峰将变得更宽且更不清晰（“更模糊”）。相邻核小体之间距离的分布将变宽，这意味着 NRL 将不再是一个单一值，而是一个宽泛的分布。\n- **对 ATAC-seq 的预测**：ATAC-seq 片段长度的周期性反映了核小体的规则间隔（片段对应于单、双、三核小体等），在启动子侧翼的区域，这种周期性将减弱，这与相位化阵列的丧失相一致。因为 ISWI 的主要作用是核小体间隔，而不是创建初始的开放 NDR（这是 SWI/SNF 的主要作用），预计其抑制对启动子核心的整体可及性（即 TSS 处的 ATAC-seq 峰高）影响*不大*。\n\n**预测整合**\n总结如下：\n- **SWI/SNF 敲低**：导致 NDR 被填充，$+1$ 核小体向上游移动，NDR 中的 MNase-seq 信号增加，启动子处的 ATAC-seq 信号减少。\n- **ISWI 抑制**：导致核小体阵列无序，引起更模糊的 MNase-seq 峰，NRL 分布变宽，以及 ATAC-seq 周期性减弱，而对启动子本身的可及性变化甚微。\n\n### 逐项分析\n\n**A. SWI/SNF 敲低会增加 NDR/TSS 内的 MNase-seq 占据，并将 $+1$ 核小体向上游移动到 NDR 中，从而降低 ATAC-seq 启动子的可及性（峰高降低，亚核小体片段，例如 $100$ 碱基对，减少）；ISWI 抑制会降低 long-range phasing（MNase-seq 峰更模糊，NRL 分布变宽），并削弱侧翼区域的 ATAC-seq 核小体周期性，而启动子 ATAC-seq 峰高变化不大。**\n该选项与两种扰动的推导预测完全一致。对 SWI/SNF 敲低对 MNase-seq 和 ATAC-seq 影响的描述是准确的。对 ISWI 抑制对 MNase-seq 相位化、NRL 和 ATAC-seq 周期性影响的描述也是准确的，并正确指出了其对启动子峰高的影响不大。\n**结论：正确。**\n\n**B. SWI/SNF 敲低由于间距丢失而增加了启动子处的 ATAC-seq 可及性，并减少了 NDR 内的 MNase-seq 占据，而 ISWI 抑制则使 MNase-seq 振荡更尖锐（更强的相位化和更窄的 NRL 分布），并增强了 ATAC-seq 的核小体周期性。**\n该选项在多个方面都是错误的。敲低*创造*可及性的 SWI/SNF 会*减少*而非增加 ATAC-seq 信号。它会*增加*而非减少 NDR 中的 MNase-seq 占据。抑制作为间隔因子的 ISWI 会*破坏*相位化（ weniger scharf），而不是使其更尖锐。\n**结论：错误。**\n\n**C. SWI/SNF 敲低使 TSS 处的 MNase-seq 保持不变，但减少了整个基因体的核小体占据；ISWI 抑制将阵列压缩成更短的 NRL，具有更尖銳的 MNase-seq 相位化，并导致启动子 ATAC-seq 可及性大幅增加。**\n该选项错误地描述了两种重塑因子的作用。SWI/SNF 在启动子处的主要作用是在 TSS 处建立 NDR；敲低后该区域保持不变是不合逻辑的。“更尖锐的相位化”与抑制的预期结果相反。启动子可及性大幅增加不是其主要功能。\n**结论：错误。**\n\n**D. 由于其他重塑因子的补偿活性，SWI/SNF 敲低全局上增加了核小体间距的规律性（更具周期性的 MNase-seq 阵列），而 ATAC-seq 启动子信号不变；ISWI 抑制使 MNase-seq 图谱保持不变，但几乎完全消除了启动子 ATAC-seq 信号。**\n该选项颠倒了重塑因子的作用并作出了错误的陈述。增加间距规律性是 ISWI 的功能，而不是 SWI/SNF 缺失的结果。SWI/SNF 敲低后 ATAC-seq 启动子信号不变与其功能相矛盾。对于 ISWI，MNase-seq 图谱保持不变与其间隔功能相矛盾，而消除启动子 ATAC 信号是与创造 NDR 的重塑因子相关的效应，而非间隔因子。\n**结论：错误。**\n\n基于对所提供原则的严谨分析，只有选项 A 为两种实验扰动提供了一套科学上一致且正确的预测。", "answer": "$$\\boxed{A}$$", "id": "2796649"}, {"introduction": "现代基因组学研究依赖于整合多种数据类型以得出可靠的结论。本练习 [@problem_id:2796621] 提供了一项动手计算任务，通过分析模拟的 ATAC-seq、ChIP-seq 和重塑酶占据数据，来识别 BRG1 重塑酶的直接靶点。这项实践将帮助你培养在真实的生物信息学背景下进行定量数据分析和假设检验的基本技能。", "problem": "给定一个简化的、自包含的定量框架，用于整合使用测序技术的转座酶可及性染色质分析 (ATAC-seq)、组蛋白 H3 赖氨酸 27 乙酰化 (H3K27ac) 染色质免疫沉淀测序 (ChIP-seq) 以及 Brahma 相关基因 1 (BRG1，也称为 SMARCA4) 的占据数据，以便在 BRG1 耗尽后，推断 SWItch/Sucrose Non-Fermentable (SWI/SNF) 染色质重塑复合物的直接增强子靶标。设计一个程序，该程序基于以下基本原理实现一种原则性分析：\n\n- 活性增强子以染色质可及性和组蛋白乙酰化为标志。增强子处的 ATAC-seq 读取计数近似其可及性。增强子处的 H3K27ac ChIP-seq 计数近似其乙酰化水平。\n- 诸如 BRG1 之类的染色质重塑因子直接调节核小体定位，从而影响增强子的可及性和活性。耗尽 BRG1 预计会主要在直接结合位点降低增强子的可及性和活性。\n- 为量化变化，请使用经正伪计数稳定的测序计数的对数比率。为量化一组增强子中 BRG1 占据与增强子变化之间的关联，请使用皮尔逊相关系数。\n\n需要实现的定义：\n\n- 对于索引为 $i$ 的增强子，让 $C^{A}_i$ 和 $D^{A}_i$ 分别表示在对照条件和 BRG1 耗尽条件下的 ATAC-seq 计数。让 $C^{H}_i$ 和 $D^{H}_i$ 分别表示在对照条件和 BRG1 耗尽条件下的 H3K27ac ChIP-seq 计数。让 $O_i$ 表示在对照条件下的 BRG1 占据得分（例如，ChIP-seq 信号或峰值强度）。\n- 给定一个正伪计数 $p$，定义可及性的以 2 为底的对数倍数变化为\n$$\n\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right),\n$$\n以及乙酰化的以 2 为底的对数倍数变化为\n$$\n\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right).\n$$\n- 将两个等长 ($n \\ge 2$) 向量 $\\mathbf{x}=(x_i)$ 和 $\\mathbf{y}=(y_i)$ 之间的皮尔逊相关系数定义为\n$$\nr(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是算术平均值。如果分母为零（即任一向量的方差为零），则按惯例定义 $r(\\mathbf{x},\\mathbf{y}) = 0$。\n- 使用以下规则通过阈值法推断一组假定的 BRG1 直接靶标：当且仅当\n$$\nO_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H},\n$$\n时，增强子 $i$ 被称为直接靶标，其中 $\\tau_{\\mathrm{occ}} > 0$、$\\tau_{A} > 0$ 和 $\\tau_{H} > 0$ 是用户指定的阈值。\n\n您的程序必须精确实现上述定义，并为每个测试用例计算以下输出：\n- $\\{O_i\\}$ 和 $\\{\\Delta^A_i\\}$ 之间的皮尔逊相关系数，四舍五入到三位小数。\n- $\\{O_i\\}$ 和 $\\{\\Delta^H_i\\}$ 之间的皮尔逊相关系数，四舍五入到三位小数。\n- 推断出的直接靶标的数量（一个整数）。\n- 推断出的直接靶标的从零开始的索引列表，按升序排列。\n\n边界情况处理：\n- 所有对数均以 2 为底。\n- 使用提供的伪计数 $p$ 以避免除以零。\n- 如果皮尔逊相关中任一向量的方差为零，则该相关性返回 $0$。\n\n测试套件：\n提供一个硬编码并评估以下三个独立测试用例的程序。对于每个测试用例 $t \\in \\{1,2,3\\}$，输入包括数组 $C^{A}$、$D^{A}$、$C^{H}$、$D^{H}$、$O$，以及标量 $p$、$\\tau_{\\mathrm{occ}}$、$\\tau_A$、$\\tau_H$。数组按增强子索引对齐，并且必须视为从零开始索引。\n\n- 测试用例 $1$（一般情况）：\n  - $C^{A} = [180, 240, 95, 160, 210, 130, 75, 300]$\n  - $D^{A} = [90, 200, 70, 120, 140, 110, 60, 260]$\n  - $C^{H} = [1500, 2200, 800, 1200, 2400, 900, 700, 2600]$\n  - $D^{H} = [900, 1800, 700, 900, 1900, 850, 650, 2100]$\n  - $O = [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.3$, $\\tau_{H} = 0.25$\n\n- 测试用例 $2$（包含零和阈值临界值的边界条件）：\n  - $C^{A} = [0, 50, 100, 0]$\n  - $D^{A} = [0, 25, 200, 0]$\n  - $C^{H} = [0, 400, 800, 0]$\n  - $D^{H} = [0, 200, 1200, 0]$\n  - $O = [6.0, 6.0, 5.9, 10.0]$\n  - $p = 0.5$, $\\tau_{\\mathrm{occ}} = 6.0$, $\\tau_{A} = 0.5$, $\\tau_{H} = 0.5$\n\n- 测试用例 $3$（无变异边界情况）：\n  - $C^{A} = [100, 100, 100, 100]$\n  - $D^{A} = [100, 100, 100, 100]$\n  - $C^{H} = [1000, 1000, 1000, 1000]$\n  - $D^{H} = [1000, 1000, 1000, 1000]$\n  - $O = [3.0, 3.0, 3.0, 3.0]$\n  - $p = 1.0$, $\\tau_{\\mathrm{occ}} = 5.0$, $\\tau_{A} = 0.1$, $\\tau_{H} = 0.1$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个测试用例的结果本身必须是一个形式为 $[\\text{corr\\_ATAC}, \\text{corr\\_H3K27ac}, \\text{n\\_direct}, \\text{direct\\_indices}]$ 的列表，其中 $\\text{corr\\_ATAC}$ 和 $\\text{corr\\_H3K27ac}$ 是四舍五入到三位小数的浮点数，$\\text{n\\_direct}$ 是一个整数，$\\text{direct\\_indices}$ 是一个整数列表。具体来说，您的输出必须如下所示\n$[[r^A_1, r^H_1, n_1, [\\dots]], [r^A_2, r^H_2, n_2, [\\dots]], [r^A_3, r^H_3, n_3, [\\dots]]]$\n其中包含为上述测试套件计算的值，并且没有附加文本。", "solution": "问题陈述已经过严格评估，并被认为是有效的。它在科学上基于染色质生物学原理，在数学上是适定的，并且没有任何模糊性、矛盾或事实上的不健全之处。该问题为表观基因组数据的简化分析提供了一个清晰的定量框架，这是计算生物学中的一项常见任务。因此，我们将着手推导解决方案。\n\n目标是使用多模态测序数据分析一组假定的增强子，以推断 BRG1 染色质重塑因子的直接靶标。这是通过为每个提供的测试用例实施一系列精确的计算步骤来完成的。\n\n该方法结构如下：\n\n1.  **计算对数倍数变化**：对于每个索引为 $i$ 的增强子，量化在 BRG1 耗尽后染色质可及性和组蛋白乙酰化的变化。给定以 2 为底的对数倍数变化公式：\n    -   可及性变化： $\\Delta^A_i = \\log_2\\!\\left(\\frac{D^{A}_i + p}{C^{A}_i + p}\\right)$\n    -   乙酰化变化： $\\Delta^H_i = \\log_2\\!\\left(\\frac{D^{H}_i + p}{C^{H}_i + p}\\right)$\n\n    在这里，$C^{A}_i$ 和 $C^{H}_i$ 分别是 ATAC-seq 和 H3K27ac ChIP-seq 在对照条件下的计数。$D^{A}_i$ 和 $D^{H}_i$ 是在 BRG1 耗尽条件下的相应计数。一个正伪计数 $p$ 被添加到每一项以稳定比率，防止除以零并减轻低计数值时噪声的影响。这些计算产生两个向量，$\\mathbf{\\Delta}^A = \\{\\Delta^A_i\\}$ 和 $\\mathbf{\\Delta}^H = \\{\\Delta^H_i\\}$，代表每个增强子对 BRG1 耗尽的响应。\n\n2.  **计算皮尔逊相关系数**：我们必须量化增强子上 BRG1 占据与观察到的可及性和乙酰化变化之间的关联。这通过使用皮尔逊相关系数 $r$ 来实现。我们计算两个这样的系数：\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$：BRG1 占据向量 $\\mathbf{O} = \\{O_i\\}$ 与可及性变化向量 $\\mathbf{\\Delta}^A$ 之间的相关性。\n    -   $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$：BRG1 占据向量 $\\mathbf{O}$ 与乙酰化变化向量 $\\mathbf{\\Delta}^H$ 之间的相关性。\n\n    长度为 $n$ 的两个向量 $\\mathbf{x}$ 和 $\\mathbf{y}$ 之间的皮尔逊相关系数公式为：\n    $$\n    r(\\mathbf{x},\\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\left(\\sum_{i=1}^{n} (x_i - \\bar{x})^2\\right)\\left(\\sum_{i=1}^{n} (y_i - \\bar{y})^2\\right)}}\n    $$\n    其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值。根据问题的明确指示，如果 $\\mathbf{x}$ 或 $\\mathbf{y}$ 的方差为零（导致分母为零），则相关性 $r(\\mathbf{x},\\mathbf{y})$ 定义为 $0$。最终值必须四舍五入到三位小数。\n\n3.  **识别直接靶标**：提供了一套标准来将增强子分类为“直接靶标”。该分类基于一个前提，即 BRG1 的直接靶标应具有高 BRG1 占据，并在 BRG1 耗尽后在可及性和乙酰化方面都表现出显著降低。当且仅当满足以下所有三个条件时，增强子 $i$ 被分类为直接靶标：\n    $$\n    O_i \\ge \\tau_{\\mathrm{occ}}, \\quad \\Delta^A_i \\le -\\tau_{A}, \\quad \\Delta^H_i \\le -\\tau_{H}\n    $$\n    其中 $\\tau_{\\mathrm{occ}}$、$\\tau_A$ 和 $\\tau_H$ 分别是为占据、可及性降低和乙酰化降低给定的正阈值。请注意，降低对应于负的对数倍数变化，因此有条件 $\\Delta^A_i \\le -\\tau_{A}$ 和 $\\Delta^H_i \\le -\\tau_{H}$。\n\n4.  **汇总结果**：对于每个测试用例，最终输出被编译成一个包含四个元素的列表：\n    -   计算出的相关性 $r(\\mathbf{O}, \\mathbf{\\Delta}^A)$，已四舍五入。\n    -   计算出的相关性 $r(\\mathbf{O}, \\mathbf{\\Delta}^H)$，已四舍五入。\n    -   被识别为直接靶标的增强子总数，一个整数。\n    -   这些直接靶标的从零开始的索引列表，按升序排序。\n\n该实现将对三个指定的测试用例中的每一个应用此操作序列，以生成最终的格式化输出。使用矢量化操作（例如由 `NumPy` 这样的库提供）是实现这些计算最有效和最直接的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromatin remodeling analysis problem for the three given test cases.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"C_A\": [180, 240, 95, 160, 210, 130, 75, 300],\n            \"D_A\": [90, 200, 70, 120, 140, 110, 60, 260],\n            \"C_H\": [1500, 2200, 800, 1200, 2400, 900, 700, 2600],\n            \"D_H\": [900, 1800, 700, 900, 1900, 850, 650, 2100],\n            \"O\": [5.2, 7.8, 2.1, 6.0, 8.5, 3.5, 1.0, 9.0],\n            \"p\": 1.0, \"tau_occ\": 6.0, \"tau_A\": 0.3, \"tau_H\": 0.25\n        },\n        {\n            \"C_A\": [0, 50, 100, 0],\n            \"D_A\": [0, 25, 200, 0],\n            \"C_H\": [0, 400, 800, 0],\n            \"D_H\": [0, 200, 1200, 0],\n            \"O\": [6.0, 6.0, 5.9, 10.0],\n            \"p\": 0.5, \"tau_occ\": 6.0, \"tau_A\": 0.5, \"tau_H\": 0.5\n        },\n        {\n            \"C_A\": [100, 100, 100, 100],\n            \"D_A\": [100, 100, 100, 100],\n            \"C_H\": [1000, 1000, 1000, 1000],\n            \"D_H\": [1000, 1000, 1000, 1000],\n            \"O\": [3.0, 3.0, 3.0, 3.0],\n            \"p\": 1.0, \"tau_occ\": 5.0, \"tau_A\": 0.1, \"tau_H\": 0.1\n        }\n    ]\n\n    def calculate_pearson_r(x, y):\n        \"\"\"\n        Calculates the Pearson correlation coefficient. Returns 0 if variance of either input is 0.\n        \"\"\"\n        if x.std() == 0 or y.std() == 0:\n            return 0.0\n        return np.corrcoef(x, y)[0, 1]\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        C_A = np.array(case[\"C_A\"])\n        D_A = np.array(case[\"D_A\"])\n        C_H = np.array(case[\"C_H\"])\n        D_H = np.array(case[\"D_H\"])\n        O = np.array(case[\"O\"])\n        p = case[\"p\"]\n        tau_occ = case[\"tau_occ\"]\n        tau_A = case[\"tau_A\"]\n        tau_H = case[\"tau_H\"]\n\n        # Step 1: Calculate log fold-changes\n        delta_A = np.log2((D_A + p) / (C_A + p))\n        delta_H = np.log2((D_H + p) / (C_H + p))\n\n        # Step 2: Calculate Pearson correlation coefficients\n        corr_ATAC = calculate_pearson_r(O, delta_A)\n        corr_H3K27ac = calculate_pearson_r(O, delta_H)\n\n        # Round to three decimal places\n        corr_ATAC_rounded = round(corr_ATAC, 3)\n        corr_H3K27ac_rounded = round(corr_H3K27ac, 3)\n\n        # Step 3: Identify direct targets\n        target_indices = np.where(\n            (O >= tau_occ)  \n            (delta_A = -tau_A)  \n            (delta_H = -tau_H)\n        )[0]\n        \n        n_direct = len(target_indices)\n        direct_indices_list = target_indices.tolist()\n\n        # Step 4: Assemble results for the case\n        case_result = [\n            corr_ATAC_rounded,\n            corr_H3K27ac_rounded,\n            n_direct,\n            direct_indices_list\n        ]\n        results.append(case_result)\n\n    # Format the final output string to remove spaces for compact representation\n    # e.g., '[1, 2, [3, 4]]' -> '[1,2,[3,4]]'\n    final_output_str = f\"[{','.join(str(item).replace(' ', '') for item in results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2796621"}]}