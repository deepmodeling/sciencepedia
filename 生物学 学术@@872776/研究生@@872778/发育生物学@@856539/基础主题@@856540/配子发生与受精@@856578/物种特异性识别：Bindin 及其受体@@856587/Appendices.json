{"hands_on_practices": [{"introduction": "物种特异性识别并非一个全有或全无的开关，而是由分子间的结合亲和力精细调控的。本练习将引导你运用基础的热力学和统计力学原理，来量化微小的结合自由能差异如何通过多价相互作用（multivalency）被放大，从而形成坚固的物种识别屏障。通过这个计算 [@problem_id:2673733]，你将能更深刻地理解亲缘关系较近的物种间是如何维持生殖隔离的。", "problem": "在许多海洋无脊椎动物中，精卵黏附是由精子顶体蛋白bindin与卵子表面受体的结合所引发的。物种特异性源于bindin及其受体的微小序列差异，这些差异改变了可逆结合反应的平衡。考虑一个同种的bindin-受体相互作用，在平衡状态下测得其结合常数为 $K_{a,\\mathrm{con}}$。假设结合是一个遵循质量作用定律的可逆一对一相互作用，其结合的吉布斯自由能变(GFE)由 $\\Delta G = -R T \\ln(K_a)$ 给出，其中 $R$ 是普适气体常数， $T$ 是绝对温度。在精卵接触处，假设一个纳米尺度的斑块中有 $n$ 个独立、等效的潜在bindin-受体接触点，并且在接触时间内，每个位点可接触到的受体的有效局部摩尔浓度为 $c$。在平衡状态下，每个位点表现为一个双态系统（已结合或未结合）。\n\n仅从质量作用定律和双态结合位点的概率守恒出发，完成以下任务：\n\n1. 用 $R$、$T$ 和 $K_{a,\\mathrm{con}}$ 表示同种相互作用的GFE $\\Delta G_{\\mathrm{con}}$。然后，对于一个异种相互作用，其单位点GFE的不利程度增加了一个微小量 $\\Delta \\Delta G$（即 $\\Delta G_{\\mathrm{het}} = \\Delta G_{\\mathrm{con}} + \\Delta \\Delta G$ 且 $\\Delta \\Delta G > 0$），请将 $K_{a,\\mathrm{het}}$ 与 $K_{a,\\mathrm{con}}$、$R$、$T$ 和 $\\Delta \\Delta G$ 联系起来。\n\n2. 使用双态位点的平衡统计推理，推导出暴露于受体浓度 $c$ 的位点的单一位点结合概率 $p_1$（用位点的 $K_a$ 和 $c$ 表示）。然后，利用位点间的独立性，用 $p_1$ 和 $n$ 表示斑块中至少形成一个键的概率 $p_{\\mathrm{adh}}$。\n\n3. 对于参数 $K_{a,\\mathrm{con}} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}$、$\\Delta \\Delta G = 1.50 \\times 10^{3}\\ \\mathrm{J\\,mol}^{-1}$、$T = 298\\ \\mathrm{K}$、$R = 8.314\\ \\mathrm{J\\,mol}^{-1}\\mathrm{K}^{-1}$、$n = 100$ 和 $c = 1.0 \\times 10^{-8}\\ \\mathrm{M}$，数值计算比率\n$$\n\\mathcal{R} \\equiv \\frac{p_{\\mathrm{adh,con}}}{p_{\\mathrm{adh,het}}}.\n$$\n将您的 $\\mathcal{R}$ 最终答案四舍五入到三位有效数字。仅报告此无单位的小数值比率。\n\n注意：如果某个中间数值需要选择单位，则任何自由能使用千焦耳/摩尔，任何摩尔量使用摩尔/升。但是，唯一需要的最终输出是四舍五入到三位有效数字的无量纲比率 $\\mathcal{R}$。", "solution": "该问题具有科学依据，表述清晰且客观。它提供了一个简化但有效的分子识别生物物理模型，这是发育生物学中的一个关键概念。所有必需的定义、参数和关系都已给出，并且它们与热力学和统计力学的既定原理一致。因此，该问题被认为是有效的，并将提供解答。\n\n按要求，该问题分三部分解答。\n\n第1部分：吉布斯自由能和结合常数\n\n同种相互作用的吉布斯自由能变(GFE) $\\Delta G_{\\mathrm{con}}$ 由自由能和平衡常数之间的基本热力学关系给出。将同种相互作用的结合常数表示为 $K_{a,\\mathrm{con}}$，则GFE为：\n$$\n\\Delta G_{\\mathrm{con}} = -R T \\ln(K_{a,\\mathrm{con}})\n$$\n其中 $R$ 是普适气体常数， $T$ 是绝对温度。\n\n对于异种相互作用，其GFE $\\Delta G_{\\mathrm{het}}$ 据称要不利 $\\Delta \\Delta G > 0$ 的量。这表示为：\n$$\n\\Delta G_{\\mathrm{het}} = \\Delta G_{\\mathrm{con}} + \\Delta \\Delta G\n$$\n异种相互作用的GFE也与其自身的结合常数 $K_{a,\\mathrm{het}}$ 相关：\n$$\n\\Delta G_{\\mathrm{het}} = -R T \\ln(K_{a,\\mathrm{het}})\n$$\n通过将 $\\Delta G_{\\mathrm{het}}$ 和 $\\Delta G_{\\mathrm{con}}$ 的表达式代入它们之间的关系，我们得到：\n$$\n-R T \\ln(K_{a,\\mathrm{het}}) = -R T \\ln(K_{a,\\mathrm{con}}) + \\Delta \\Delta G\n$$\n为了求解 $K_{a,\\mathrm{het}}$，我们首先将整个方程除以 $-R T$：\n$$\n\\ln(K_{a,\\mathrm{het}}) = \\ln(K_{a,\\mathrm{con}}) - \\frac{\\Delta \\Delta G}{R T}\n$$\n利用对数的性质重新整理各项，得到：\n$$\n\\ln(K_{a,\\mathrm{het}}) - \\ln(K_{a,\\mathrm{con}}) = -\\frac{\\Delta \\Delta G}{R T}\n$$\n$$\n\\ln\\left(\\frac{K_{a,\\mathrm{het}}}{K_{a,\\mathrm{con}}}\\right) = -\\frac{\\Delta \\Delta G}{R T}\n$$\n对两边取指数，得到两个结合常数之间的关系：\n$$\nK_{a,\\mathrm{het}} = K_{a,\\mathrm{con}} \\exp\\left(-\\frac{\\Delta \\Delta G}{R T}\\right)\n$$\n\n第2部分：结合概率\n\n我们推导在平衡状态下表现为双态系统（已结合或未结合）的位点的单一位点结合概率 $p_1$。结合反应被建模为可逆的一对一相互作用：\n$$\n\\text{Site}_{\\text{unbound}} + \\text{Receptor} \\rightleftharpoons \\text{Site}_{\\text{bound}}\n$$\n根据质量作用定律，结合常数 $K_a$ 是已结合复合物的浓度与未结合组分浓度乘积的比值。在此背景下，我们考虑已结合位点的分数。设 $p_1$ 为一个位点被结合的概率， $1 - p_1$ 为其未结合的概率。在有效局部受体浓度为 $c$ 时，平衡条件表示为：\n$$\nK_a = \\frac{[\\text{Site}_{\\text{bound}}]}{[\\text{Site}_{\\text{unbound}}] [\\text{Receptor}]} = \\frac{p_1}{(1 - p_1) c}\n$$\n我们求解此方程以得到 $p_1$：\n$$\nK_a c (1 - p_1) = p_1\n$$\n$$\nK_a c - K_a c p_1 = p_1\n$$\n$$\nK_a c = p_1 (1 + K_a c)\n$$\n$$\np_1 = \\frac{K_a c}{1 + K_a c}\n$$\n这个表达式给出了单一位点被结合的概率。\n\n接下来，我们确定黏附概率 $p_{\\mathrm{adh}}$，其定义为在包含 $n$ 个独立且等效位点的接触斑块中至少形成一个键的概率。首先计算其互补事件的概率会更简单：即没有键形成。\n单一位点未结合的概率是 $1 - p_1$。\n由于这 $n$ 个位点是独立的，所有 $n$ 个位点都未结合的概率是它们各自概率的乘积：\n$$\nP(\\text{no bonds}) = (1 - p_1)^n\n$$\n因此，至少形成一个键的概率 $p_{\\mathrm{adh}}$ 为：\n$$\np_{\\mathrm{adh}} = 1 - P(\\text{no bonds}) = 1 - (1 - p_1)^n\n$$\n\n第3部分：数值计算\n\n我们被要求使用以下参数计算比率 $\\mathcal{R} = p_{\\mathrm{adh,con}} / p_{\\mathrm{adh,het}}$：\n-   $K_{a,\\mathrm{con}} = 1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}$\n-   $\\Delta \\Delta G = 1.50 \\times 10^{3}\\ \\mathrm{J\\,mol}^{-1}$\n-   $T = 298\\ \\mathrm{K}$\n-   $R = 8.314\\ \\mathrm{J\\,mol}^{-1}\\mathrm{K}^{-1}$\n-   $n = 100$\n-   $c = 1.0 \\times 10^{-8}\\ \\mathrm{M}$\n\n首先，我们计算无量纲乘积 $K_{a,\\mathrm{con}} c$：\n$$\nK_{a,\\mathrm{con}} c = (1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}) (1.0 \\times 10^{-8}\\ \\mathrm{M}) = 0.01\n$$\n现在我们计算同种情况下的单一位点结合概率 $p_{1,\\mathrm{con}}$：\n$$\np_{1,\\mathrm{con}} = \\frac{K_{a,\\mathrm{con}} c}{1 + K_{a,\\mathrm{con}} c} = \\frac{0.01}{1 + 0.01} = \\frac{0.01}{1.01}\n$$\n同种情况下的黏附概率 $p_{\\mathrm{adh,con}}$ 为：\n$$\np_{\\mathrm{adh,con}} = 1 - (1 - p_{1,\\mathrm{con}})^n = 1 - \\left(1 - \\frac{0.01}{1.01}\\right)^{100} = 1 - \\left(\\frac{1.01 - 0.01}{1.01}\\right)^{100} = 1 - \\left(\\frac{1}{1.01}\\right)^{100} = 1 - (1.01)^{-100}\n$$\n$$(1.01)^{100} \\approx 2.70481$$\n$$\np_{\\mathrm{adh,con}} \\approx 1 - \\frac{1}{2.70481} \\approx 1 - 0.36971 = 0.63029\n$$\n\n接下来，我们评估异种情况的参数。我们首先计算第1部分中的指数项：\n$$\n\\frac{\\Delta \\Delta G}{R T} = \\frac{1.50 \\times 10^{3}\\ \\mathrm{J\\,mol}^{-1}}{(8.314\\ \\mathrm{J\\,mol}^{-1}\\mathrm{K}^{-1})(298\\ \\mathrm{K})} \\approx 0.60543\n$$\n利用这个结果，我们求得 $K_{a,\\mathrm{het}}$：\n$$\nK_{a,\\mathrm{het}} = K_{a,\\mathrm{con}} \\exp\\left(-\\frac{\\Delta \\Delta G}{R T}\\right) \\approx (1.0 \\times 10^{6}\\ \\mathrm{M}^{-1}) \\exp(-0.60543) \\approx (1.0 \\times 10^{6})(0.54583) = 0.54583 \\times 10^{6}\\ \\mathrm{M}^{-1}\n$$\n现在我们计算乘积 $K_{a,\\mathrm{het}} c$：\n$$\nK_{a,\\mathrm{het}} c \\approx (0.54583 \\times 10^{6}\\ \\mathrm{M}^{-1})(1.0 \\times 10^{-8}\\ \\mathrm{M}) \\approx 0.0054583\n$$\n异种情况下的单一位点结合概率 $p_{1,\\mathrm{het}}$ 为：\n$$\np_{1,\\mathrm{het}} = \\frac{K_{a,\\mathrm{het}} c}{1 + K_{a,\\mathrm{het}} c} \\approx \\frac{0.0054583}{1 + 0.0054583} \\approx \\frac{0.0054583}{1.0054583} \\approx 0.0054296\n$$\n异种情况下的黏附概率 $p_{\\mathrm{adh,het}}$ 为：\n$$\np_{\\mathrm{adh,het}} = 1 - (1 - p_{1,\\mathrm{het}})^n \\approx 1 - \\left(1 - \\frac{0.0054583}{1.0054583}\\right)^{100} = 1 - \\left(\\frac{1}{1.0054583}\\right)^{100} = 1 - (1.0054583)^{-100}\n$$\n$$(1.0054583)^{100} \\approx 1.72477$$\n$$\np_{\\mathrm{adh,het}} \\approx 1 - \\frac{1}{1.72477} \\approx 1 - 0.57978 = 0.42022\n$$\n最后，我们计算比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{p_{\\mathrm{adh,con}}}{p_{\\mathrm{adh,het}}} \\approx \\frac{0.63029}{0.42022} \\approx 1.49989\n$$\n将此结果四舍五入到三位有效数字，得到 $1.50$。", "answer": "$$\\boxed{1.50}$$", "id": "2673733"}, {"introduction": "分子层面的相互作用最终要在生态尺度上体现其生物学意义，对于配子识别而言，其最终的成功标准就是有效的受精。本练习将视角从单个分子转移到体外受精的群体动力学过程。你将通过构建一个动力学模型，把由bindin-EBR1介导的分子相容性（体现在反应速率常数 $\\beta$ 中）与广播式繁殖场景下的宏观受精成功率联系起来 [@problem_id:2673762]。", "problem": "在体外受精的棘皮动物中，精子表达顶体蛋白 bindin，该蛋白介导精子与卵细胞表面受体“卵结合蛋白受体1”(Egg Bindin Receptor 1, EBR1) 的物种特异性附着。考虑在静止海水中发生的一次广播式产卵事件，其中浓度为 $S$ 的精子和浓度为 $C$ 的卵细胞最初均匀混合。假设以下基本事实和条件成立：(i) 相容的 bindin–EBR1 接触会立即导致该卵细胞受精，(ii) 相容的精卵相遇受碰撞限制，可用二阶质量作用动力学模型描述，其有效结合速率常数为 $\\beta$（该常数已包含了物种特异性分子识别和向卵细胞表面的运输过程），(iii) 卵细胞独立作用，在所考虑的时间内不会显著消耗精子库，并且 (iv) 卵细胞一旦受精，即从后续反应中移除。\n\n从这些假设和适用于独立碰撞过程的标准概率或动力学推理出发，推导时间 $t$ 后受精卵的期望浓度表达式，然后代入 $S=10^{6}\\,\\text{mL}^{-1}$，$C=10^{3}\\,\\text{mL}^{-1}$，$\\beta=10^{-8}\\,\\text{mL}\\,\\text{s}^{-1}$ 和 $t=600\\,\\text{s}$ 计算其值。将最终数值答案四舍五入至四位有效数字。最终结果以“卵/毫升”为单位表示。最后，结合关于广播式产卵动物种内受精成功率的野外观察，解释您的结果的量级，并阐明通过 bindin–EBR1 实现的物种特异性识别如何反映在参数 $\\beta$ 中，而无需更改您的数值答案。", "solution": "该场景描述了精子和卵细胞之间独立的、受碰撞限制的相遇，其中相容的 bindin–卵结合蛋白受体1 (EBR1) 接触会立即使卵细胞受精。在稀释条件下，当精子消耗可忽略不计且卵细胞之间相互独立时，每个卵细胞经历相容精子相遇事件的瞬时风险是恒定的，且与精子浓度成正比。这是质量作用动力学的标准设定，它导出一个随时间呈指数衰减的存活（未受精）概率。\n\n令 $U(t)$ 表示在时间 $t$ 仍未受精的卵细胞比例。在有效结合速率常数为 $\\beta$、精子浓度为 $S$ 的二阶质量作用动力学下，每个卵细胞的瞬时风险为 $\\beta S$。那么，未受精比例的变化率为\n$$\n\\frac{dU}{dt} = -\\beta S\\,U(t),\n$$\n初始条件为 $U(0)=1$，因为所有卵细胞开始时都未受精。解此线性常微分方程可得\n$$\nU(t) = \\exp(-\\beta S t).\n$$\n因此，到时间 $t$ 为止受精的卵细胞比例为\n$$\nF(t) = 1 - U(t) = 1 - \\exp(-\\beta S t).\n$$\n如果初始卵细胞浓度为 $C$（卵/毫升），且卵细胞独立作用，没有明显的精子消耗，那么时间 $t$ 后受精卵的期望浓度为\n$$\nY(t) = C\\,F(t) = C\\left[1 - \\exp(-\\beta S t)\\right].\n$$\n\n我们现在代入给定的参数值 $S=10^{6}\\,\\text{mL}^{-1}$，$C=10^{3}\\,\\text{mL}^{-1}$，$\\beta=10^{-8}\\,\\text{mL}\\,\\text{s}^{-1}$ 和 $t=600\\,\\text{s}$ 来计算该表达式。首先计算指数中的无量纲乘积：\n$$\n\\beta S t = \\left(10^{-8}\\,\\text{mL}\\,\\text{s}^{-1}\\right)\\left(10^{6}\\,\\text{mL}^{-1}\\right)\\left(600\\,\\text{s}\\right) = 10^{-2}\\times 600 = 6.\n$$\n因此\n$$\nY(t) = 10^{3}\\left[1 - \\exp(-6)\\right].\n$$\n使用 $\\exp(-6)\\approx 0.002478752176666$，\n$$\nY(t) \\approx 10^{3}\\left(1 - 0.002478752176666\\right)\n= 10^{3}\\times 0.997521247823334\n\\approx 997.521247823334.\n$$\n四舍五入到四位有效数字，得到\n$$\nY(t) \\approx 997.5\\ \\text{eggs per milliliter}.\n$$\n\n结合野外观察的背景进行解释：计算出的值对应于在所述精子密度下，几乎所有卵细胞都在 $600\\,\\text{s}$ 内受精。在许多广播式产卵的棘皮动物中，种内受精在高精子浓度和短时间内通常会接近完成，这与此处预测的近饱和状态一致。由 bindin–EBR1 识别介导的物种特异性被编码在有效结合速率 $\\beta$ 中：强的分子相容性会增加 $\\beta$，从而加速受精；而异种或不匹配的 bindin–受体对会有效地降低 $\\beta$，并将在相同时间窗口内大幅降低 $Y(t)$。因此，在有利的混合和密度条件下，使用给定 $\\beta$ 值获得的高受精率与野外高效的种内识别相符。", "answer": "$$\\boxed{997.5}$$", "id": "2673762"}, {"introduction": "我们在生物体中所观察到的精妙的物种特异性识别机制，是长期进化压力的产物。本章的最后一个练习将带你深入到分子进化的领域，探索如何在基因序列中寻找这种进化压力的“指纹”。你将通过一个正式的生物信息学流程 [@problem_id:2673738]，学习如何检验`bindin`基因是否经历了正选择（positive selection），从而理解驱动其快速分化并可能导致新物种形成的进化动力。", "problem": "您需要实现一个完整的决策理论流程，用于正式检测跨物种的 bindin 基因中的正选择。该流程集成了比对质量控制、重组检测、通过嵌套似然比较进行的密码子模型选择，以及通过 bootstrap 和 jackknife 进行的稳健性检验。此流程必须源自演化遗传学和统计推断的基本原理，然后实现为一个程序，该程序接受一组固定的参数集测试套件，并为每个案例返回一个布尔决策。\n\n基本原理：\n- 分子生物学的中心法则将基因通过信使核糖核酸 (mRNA) 映射到蛋白质，而蛋白质编码 DNA 序列的演化受到氨基酸变化的限制。\n- 在分子演化的密码子模型中，当非同义替换率与同义替换率之比（表示为 $d_N/d_S$，通常用 $\\omega$ 代表）超过 $1$ 时，表明编码序列存在正选择。有几种嵌套的最大似然密码子模型可以检验这一点：例如，一个不允许 $\\omega>1$ 的中性模型与一个允许存在 $\\omega>1$ 的类别的选择模型进行比较。\n- 基于似然的嵌套模型比较使用似然比检验 (LRT)，其统计量为 $2\\Delta\\ell = 2(\\ell_{\\text{alt}} - \\ell_{\\text{null}})$，在正则性条件下，该统计量服从卡方分布，其自由度等于模型间参数的差异。\n- 重组可以在比对中产生镶嵌的谱系，从而使单个系统发育树的密码子模型无效。一个简单的防范方法是在支持的重组断点处将比对分段，并对每个片段应用检验，同时进行多重检验校正。\n- 诸如非参数 bootstrap 和留一法 jackknife 等稳健性检验被用来确认推断不是由数据的特异性所驱动。\n\n您的程序必须仅使用下面提供的固定数值输入来实现以下算法：\n- 比对质量控制：\n  - 给定一个逐位点比对质量得分列表 $Q = [q_{1},\\dots,q_{N}]$ 和一个阈值 $q_{\\text{thresh}}$，保留得分 $q_{i} \\ge q_{\\text{thresh}}$ 的位点。计算保留比例 $f = \\frac{1}{N}\\sum_{i=1}^{N} \\mathbf{1}[q_{i} \\ge q_{\\text{thresh}}]$。如果 $f  f_{\\min}$，该测试案例的流程必须提前终止，决策为 False。\n- 重组检测和分段：\n  - 给定位于位置 $P = [p_{1},\\dots,p_{B}]$ 的 $B$ 个候选断点和相应的重组支持度得分 $S = [s_{1},\\dots,s_{B}]$，以及阈值 $s_{\\text{thresh}}$，如果 $s_{j} \\ge s_{\\text{thresh}}$，则在 $p_{j}$ 处声明一个断点。设声明的断点数量为 $K$。定义片段数量为 $S^{\\ast} = K + 1$。通过 Bonferroni 方法对各片段应用多重检验校正，因此每个片段的显著性水平为 $\\alpha_{\\text{seg}} = \\alpha / S^{\\ast}$。\n- 通过嵌套 LRT 进行模型选择：\n  - 对于每个片段 $r \\in \\{1,\\dots,S^{\\ast}\\}$，您将获得四种模型下的对数似然值：$\\ell_{\\text{M1a}}^{(r)}$、$\\ell_{\\text{M2a}}^{(r)}$、$\\ell_{\\text{M7}}^{(r)}$ 和 $\\ell_{\\text{M8}}^{(r)}$。每个片段计算两个 LRT 统计量：\n    - $T_{12}^{(r)} = 2\\left(\\ell_{\\text{M2a}}^{(r)} - \\ell_{\\text{M1a}}^{(r)}\\right)$\n    - $T_{78}^{(r)} = 2\\left(\\ell_{\\text{M8}}^{(r)} - \\ell_{\\text{M7}}^{(r)}\\right)$\n  - 对于每个 LRT，计算在自由度为 $2$ 的卡方分布下的 $p$-值，$p = \\Pr\\left(\\chi^{2}_{2} \\ge T\\right)$。如果两个检验中至少有一个的 $p  \\alpha_{\\text{seg}}$，则声明为片段水平的检测。\n- 稳健性检验：\n  - Bootstrap：对于每个片段 $r$，您将获得一个用于 $\\text{M7}$ 与 $\\text{M8}$ 比较的 bootstrap 重复 LRT 值列表 $\\{T_{78,b}^{(r)}\\}_{b=1}^{B_{r}}$。设 $p_{b}^{(r)}$ 为自由度为 $2$ 的卡方 $p$-值。计算比例 $\\phi_{\\text{boot}}^{(r)} = \\frac{1}{B_{r}}\\sum_{b=1}^{B_{r}} \\mathbf{1}\\left[p_{b}^{(r)}  \\alpha_{\\text{seg}}\\right]$。如果 $\\phi_{\\text{boot}}^{(r)} \\ge \\phi_{\\min}$，则 bootstrap 稳健性标准成立。\n  - Jackknife：对于每个片段 $r$，您将获得一个在 $\\alpha_{\\text{seg}}$ 水平下针对 $\\text{M7}$ 与 $\\text{M8}$ 检验的留一物种显著性布尔值列表 $\\{J_{m}^{(r)}\\}_{m=1}^{M_{r}}$。计算 $\\phi_{\\text{jack}}^{(r)} = \\frac{1}{M_{r}}\\sum_{m=1}^{M_{r}} \\mathbf{1}[J_{m}^{(r)} = \\text{True}]$。如果 $\\phi_{\\text{jack}}^{(r)} \\ge \\psi_{\\min}$，则 jackknife 稳健性标准成立。\n- 测试案例的最终决策：\n  - 当且仅当比对质量通过，并且存在至少一个片段 $r$ 满足以下条件时，最终决策为 True：\n    - 原始片段水平的检测成立（$T_{12}^{(r)}$ 或 $T_{78}^{(r)}$ 中至少有一个在 $\\alpha_{\\text{seg}}$ 水平上显著），并且\n    - 两个稳健性标准都成立：$\\phi_{\\text{boot}}^{(r)} \\ge \\phi_{\\min}$ 和 $\\phi_{\\text{jack}}^{(r)} \\ge \\psi_{\\min}$。\n\n对于统计决策，请使用严格不等式：对于任何在 $\\alpha$ 水平上的比较，使用规则“如果 $p  \\alpha$ 则显著”。\n\n角度单位和物理单位不适用。所有比例必须以小数表示。\n\n测试套件：\n对于每个测试案例，所有数组都明确提供。由声明的重组断点所暗示的片段数量必须与提供的每片段似然和稳健性列表的长度相匹配。\n\n- 测试案例 A：\n  - 比对质量：\n    - $Q = [0.9, 0.95, 0.88, 0.7, 0.75, 0.8, 0.92, 0.85, 0.65, 0.72]$\n    - $q_{\\text{thresh}} = 0.7, f_{\\min} = 0.6$.\n  - 重组：\n    - 位置 $P = [30, 60]$, 得分 $S = [5.0, 7.0]$, $s_{\\text{thresh}} = 10.0$.\n  - 每片段对数似然值（暗示为单个片段）：\n    - $\\ell_{\\text{M7}}^{(1)} = -1200.0, \\ell_{\\text{M8}}^{(1)} = -1194.0$;\n      $\\ell_{\\text{M1a}}^{(1)} = -1205.0, \\ell_{\\text{M2a}}^{(1)} = -1201.0$.\n  - M7 与 M8 比较的 Bootstrap LRT：\n    - 片段 1：$[10.0, 11.0, 8.5, 9.2, 12.3]$.\n  - M7 与 M8 比较的 Jackknife 布尔值：\n    - 片段 1：$[True, True, True, True, True, True, False]$.\n  - 全局阈值：\n    - $\\alpha = 0.05, \\phi_{\\min} = 0.8, \\psi_{\\min} = 0.7$.\n\n- 测试案例 B：\n  - 比对质量：\n    - $Q = [0.95, 0.9, 0.85, 0.82, 0.81, 0.79, 0.83, 0.88, 0.91, 0.77, 0.86, 0.84, 0.8, 0.76, 0.9]$.\n    - $q_{\\text{thresh}} = 0.8, f_{\\min} = 0.7$.\n  - 重组：\n    - 位置 $P = [100]$, 得分 $S = [12.0]$, $s_{\\text{thresh}} = 10.0$.\n  - 每片段对数似然值（暗示为两个片段）：\n    - 片段 1：$\\ell_{\\text{M7}}^{(1)} = -600.0, \\ell_{\\text{M8}}^{(1)} = -596.0; \\ell_{\\text{M1a}}^{(1)} = -603.0, \\ell_{\\text{M2a}}^{(1)} = -599.0$.\n    - 片段 2：$\\ell_{\\text{M7}}^{(2)} = -580.0, \\ell_{\\text{M8}}^{(2)} = -579.5; \\ell_{\\text{M1a}}^{(2)} = -581.0, \\ell_{\\text{M2a}}^{(2)} = -580.2$.\n  - M7 与 M8 比较的 Bootstrap LRT：\n    - 片段 1：$[8.2, 8.0, 7.9, 9.0]$.\n    - 片段 2：$[1.2, 2.0, 0.5]$.\n  - M7 与 M8 比较的 Jackknife 布尔值：\n    - 片段 1：$[True, True, False, True, True]$.\n    - 片段 2：$[False, False, False]$.\n  - 全局阈值：\n    - $\\alpha = 0.05, \\phi_{\\min} = 0.75, \\psi_{\\min} = 0.7$.\n\n- 测试案例 C：\n  - 比对质量：\n    - $Q = [0.9, 0.5, 0.55, 0.6, 0.58, 0.62, 0.59, 0.57, 0.53, 0.65]$.\n    - $q_{\\text{thresh}} = 0.8, f_{\\min} = 0.6$.\n  - 重组：\n    - 位置 $P = [50, 120]$, 得分 $S = [11.0, 4.0]$, $s_{\\text{thresh}} = 10.0$.\n  - 每片段对数似然值（如果质量不合格则忽略）：\n    - 片段 1：$\\ell_{\\text{M7}}^{(1)} = -400.0, \\ell_{\\text{M8}}^{(1)} = -397.0; \\ell_{\\text{M1a}}^{(1)} = -402.0, \\ell_{\\text{M2a}}^{(1)} = -400.0$.\n    - 片段 2：$\\ell_{\\text{M7}}^{(2)} = -390.0, \\ell_{\\text{M8}}^{(2)} = -389.9; \\ell_{\\text{M1a}}^{(2)} = -391.0, \\ell_{\\text{M2a}}^{(2)} = -390.9$.\n  - Bootstrap 和 jackknife 数组可以是任意的（如果质量不合格则忽略）。\n  - 全局阈值：\n    - $\\alpha = 0.05, \\phi_{\\min} = 0.8, \\psi_{\\min} = 0.7$.\n\n- 测试案例 D：\n  - 比对质量：\n    - $Q = [0.92, 0.89, 0.87, 0.91, 0.85, 0.9, 0.88, 0.86]$.\n    - $q_{\\text{thresh}} = 0.8, f_{\\min} = 0.7$.\n  - 重组：\n    - 位置 $P = [90]$, 得分 $S = [3.0]$, $s_{\\text{thresh}} = 10.0$.\n  - 每片段对数似然值（暗示为单个片段）：\n    - $\\ell_{\\text{M7}}^{(1)} = -710.0, \\ell_{\\text{M8}}^{(1)} = -706.9; \\ell_{\\text{M1a}}^{(1)} = -712.0, \\ell_{\\text{M2a}}^{(1)} = -710.0$.\n  - M7 与 M8 比较的 Bootstrap LRT：\n    - 片段 1：$[6.3, 6.1, 6.5, 5.8, 6.4]$.\n  - M7 与 M8 比较的 Jackknife 布尔值：\n    - 片段 1：$[True, True, True, False, True]$.\n  - 全局阈值：\n    - $\\alpha = 0.05, \\phi_{\\min} = 0.8, \\psi_{\\min} = 0.7$.\n\n- 测试案例 E：\n  - 比对质量：\n    - $Q = [0.9, 0.93, 0.88, 0.91, 0.85, 0.87, 0.89, 0.92, 0.86, 0.84]$.\n    - $q_{\\text{thresh}} = 0.8, f_{\\min} = 0.7$.\n  - 重组：\n    - 位置 $P = [40]$, 得分 $S = [2.0]$, $s_{\\text{thresh}} = 10.0$.\n  - 每片段对数似然值（暗示为单个片段）：\n    - $\\ell_{\\text{M7}}^{(1)} = -500.0, \\ell_{\\text{M8}}^{(1)} = -495.0; \\ell_{\\text{M1a}}^{(1)} = -501.0, \\ell_{\\text{M2a}}^{(1)} = -500.9$.\n  - M7 与 M8 比较的 Bootstrap LRT：\n    - 片段 1：$[4.0, 5.5, 6.1, 5.8, 4.9]$.\n  - M7 与 M8 比较的 Jackknife 布尔值：\n    - 片段 1：$[True, False, False, False, False]$.\n  - 全局阈值：\n    - $\\alpha = 0.05, \\phi_{\\min} = 0.8, \\psi_{\\min} = 0.7$.\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含对 A 到 E 五个测试案例的布尔决策，按顺序排列，作为一个用逗号分隔并用方括号括起来的列表（例如，$[\\text{True},\\text{False},\\dots]$）。", "solution": "该问题经过验证，被确定为有效。它在科学上基于分子演化的原理，问题阐述清晰，目标明确，并提供了一整套完整的数值数据，没有矛盾、模糊或事实不健全之处。该问题构成了用于检测蛋白质编码基因序列中正选择的标准生物信息学流程的形式化算法实现。\n\n解决方案是根据所提供的规范构建的计算流程。每一步的逻辑都源于基本的统计学和演化原理。\n\n**第 1 步：比对质量控制**\n多序列比对是所有下游系统发育推断的基础。质量得分低的位点会引入噪声和错误。因此，第一步是过滤比对。给定一个逐位点质量得分列表 $Q = [q_{1}, \\dots, q_{N}]$ 和一个质量阈值 $q_{\\text{thresh}}$，我们计算满足该阈值的位点比例 $f$。该比例定义为：\n$$\nf = \\frac{1}{N} \\sum_{i=1}^{N} \\mathbf{1}[q_{i} \\ge q_{\\text{thresh}}]\n$$\n其中 $\\mathbf{1}[\\cdot]$ 是指示函数，如果条件为真则等于 $1$，否则等于 $0$。如果这个保留比例 $f$ 小于指定的最小可接受比例 $f_{\\min}$，则认为该比对质量不足以进行可靠分析。该测试案例的流程终止，决策为 `False`。\n\n**第 2 步：重组检测和分段**\n基因内的重组可以创造出不同演化历史的镶嵌体，这违反了标准密码子模型的单一系统发育树假设。该流程通过在检测到的重组断点处对序列比对进行分段来解决此问题。给定一组候选断点得分 $S = [s_{1}, \\dots, s_{B}]$ 和一个支持度阈值 $s_{\\text{thresh}}$，确定显著断点的数量 $K$：\n$$\nK = \\sum_{j=1}^{B} \\mathbf{1}[s_{j} \\ge s_{\\text{thresh}}]\n$$\n这 $K$ 个断点将比对划分为 $S^{\\ast} = K + 1$ 个独立片段。为了对这 $S^{\\ast}$ 个片段进行多重假设检验进行调整，对总体显著性水平 $\\alpha$ 应用 Bonferroni 校正。调整后的每片段显著性水平 $\\alpha_{\\text{seg}}$ 变为：\n$$\n\\alpha_{\\text{seg}} = \\frac{\\alpha}{S^{\\ast}}\n$$\n\n**第 3 步：通过嵌套似然比检验 (LRT) 进行模型选择**\n对于每个片段 $r \\in \\{1, \\dots, S^{\\ast}\\}$，我们使用成对的嵌套密码子模型来检验是否存在正选择位点（$\\omega = d_N/d_S > 1$）。该问题指定了两个标准检验：\n1.  **M1a（中性）vs. M2a（选择）**：M1a 将 $\\omega$ 约束在两个位点类别，分别为 $0 \\le \\omega_{0}  1$ 和 $\\omega_{1} = 1$。M2a 增加第三个类别，允许 $\\omega_{2} > 1$。\n2.  **M7（中性）vs. M8（选择）**：M7 使用一个在区间 $(0, 1)$ 上的 beta 分布来模拟 $\\omega$。M8 增加一个额外的位点类别，其 $\\omega_{s} > 1$ 可自由估计。\n\n比较通过似然比检验 (LRT) 进行。对于一个零假设模型和一个备择模型，LRT 统计量 $T$ 计算如下：\n$$\nT = 2(\\ell_{\\text{alt}} - \\ell_{\\text{null}})\n$$\n其中 $\\ell_{\\text{alt}}$ 和 $\\ell_{\\text{null}}$ 是最大化的对数似然值。对于每个片段 $r$，我们计算：\n$$\nT_{12}^{(r)} = 2\\left(\\ell_{\\text{M2a}}^{(r)} - \\ell_{\\text{M1a}}^{(r)}\\right)\n$$\n$$\nT_{78}^{(r)} = 2\\left(\\ell_{\\text{M8}}^{(r)} - \\ell_{\\text{M7}}^{(r)}\\right)\n$$\n在零假设下，该统计量渐近服从 $\\chi^2$ 分布，其自由度等于模型间自由参数数量的差异。对于 M1a vs. M2a 和 M7 vs. M8，这个差异都是 $2$ 个参数。如果任一检验的 $p$-值小于校正后的显著性水平 $\\alpha_{\\text{seg}}$，则该片段显示出正选择的证据。$p$-值计算为 $p = \\Pr(\\chi^2_2 \\ge T)$。因此，一个片段的检测标准是：\n$$\n\\left(p_{12}^{(r)}  \\alpha_{\\text{seg}}\\right) \\lor \\left(p_{78}^{(r)}  \\alpha_{\\text{seg}}\\right)\n$$\n\n**第 4 步：稳健性检验**\n选择的推断可能对抽样噪声或有影响的数据点（例如，特定的序列）敏感。该流程包含两项针对 M7 vs. M8 比较的稳健性检验。\n1.  **非参数 Bootstrap**：这评估了在重抽样数据集中结论的支持度。对于一个片段 $r$，我们给定 $B_{r}$ 个 bootstrap 重复的 LRT 值 $\\{T_{78,b}^{(r)}\\}$。我们计算这些重复中在 $\\alpha_{\\text{seg}}$ 水平上产生显著结果的比例。这个比例 $\\phi_{\\text{boot}}^{(r)}$ 是：\n    $$\n    \\phi_{\\text{boot}}^{(r)} = \\frac{1}{B_{r}}\\sum_{b=1}^{B_{r}} \\mathbf{1}\\left[ \\Pr(\\chi^2_2 \\ge T_{78,b}^{(r)})  \\alpha_{\\text{seg}} \\right]\n    $$\n    如果 $\\phi_{\\text{boot}}^{(r)} \\ge \\phi_{\\min}$，则满足 bootstrap 标准，其中 $\\phi_{\\min}$ 是一个最小支持度阈值。\n2.  **留一法 Jackknife**：这评估了单个序列的影响。对于一个有 $M_{r}$ 个序列的片段 $r$，我们给定一组布尔值 $\\{J_{m}^{(r)}\\}$，指示在移除第 $m$ 个序列后 LRT 是否仍然显著。支持度通过显著的 jackknife 重复的比例来量化：\n    $$\n    \\phi_{\\text{jack}}^{(r)} = \\frac{1}{M_{r}}\\sum_{m=1}^{M_{r}} \\mathbf{1}[J_{m}^{(r)} = \\text{True}]\n    $$\n    如果 $\\phi_{\\text{jack}}^{(r)} \\ge \\psi_{\\min}$，则满足 jackknife 标准，其中 $\\psi_{\\min}$ 是一个最小支持度阈值。\n\n**第 5 步：最终决策逻辑**\n当且仅当比对质量检查通过，并且存在至少一个片段 $r$ 满足以下所有三个条件时，最终决策为 `True`（检测到正选择）：\n1.  初始片段水平的检测是显著的（根据第 3 步）。\n2.  满足 bootstrap 稳健性标准（$\\phi_{\\text{boot}}^{(r)} \\ge \\phi_{\\min}$）。\n3.  满足 jackknife 稳健性标准（$\\phi_{\\text{jack}}^{(r)} \\ge \\psi_{\\min}$）。\n如果没有任何片段满足这些条件，则最终决策为 `False`。\n\n**测试案例执行**\n\n- **测试案例 A**：\n  - 质量控制：$N=10$, $q_{\\text{thresh}}=0.7$。10 个位点中有 9 个通过。$f = 0.9 \\ge f_{\\min}=0.6$。通过。\n  - 重组：$s_{\\text{thresh}}=10.0$。$S=[5.0, 7.0]$ 中没有得分达到此阈值。$K=0, S^{\\ast}=1$。$\\alpha_{\\text{seg}} = 0.05 / 1 = 0.05$。\n  - 模型选择（片段 1）：$T_{12}^{(1)} = 2(-1201.0 - (-1205.0)) = 8.0$。$T_{78}^{(1)} = 2(-1194.0 - (-1200.0)) = 12.0$。\n    - $\\Pr(\\chi^2_2 \\ge 8.0) \\approx 0.0183  0.05$。\n    - $\\Pr(\\chi^2_2 \\ge 12.0) \\approx 0.0025  0.05$。\n    - 片段水平的检测成立。\n  - 稳健性（片段 1）：\n    - Bootstrap：$\\alpha_{\\text{seg}}=0.05$，临界值 $\\approx 5.991$。所有 5 个 LRT 值 $[10.0, 11.0, 8.5, 9.2, 12.3]$ 都超过此值。$\\phi_{\\text{boot}}^{(1)} = 5/5 = 1.0$。$1.0 \\ge \\phi_{\\min}=0.8$。通过。\n    - Jackknife：7 个中有 6 个为 True。$\\phi_{\\text{jack}}^{(1)} = 6/7 \\approx 0.857$。$0.857 \\ge \\psi_{\\min}=0.7$。通过。\n  - 最终决策：片段 1 满足所有条件。结果：**True**。\n\n- **测试案例 B**：\n  - 质量控制：$N=15$, $q_{\\text{thresh}}=0.8$。15 个位点中有 12 个通过。$f = 0.8 \\ge f_{\\min}=0.7$。通过。\n  - 重组：$s_{\\text{thresh}}=10.0$。$S=[12.0]$ 中有一个得分达到此阈值。$K=1, S^{\\ast}=2$。$\\alpha_{\\text{seg}} = 0.05 / 2 = 0.025$。\n  - 片段 1：$T_{12}^{(1)}$ 和 $T_{78}^{(1)}$ 均为 $8.0$。$\\Pr(\\chi^2_2 \\ge 8.0) \\approx 0.0183  0.025$。检测成立。$\\alpha_{\\text{seg}}=0.025$的临界值为 $7.378$。所有4个bootstrap LRT值都超过此值，所以 $\\phi_{\\text{boot}}^{(1)} = 1.0 \\ge 0.75$。Jackknife比例为 $4/5 = 0.8 \\ge 0.7$。片段 1 满足所有条件。\n  - 最终决策：由于一个片段通过了所有标准，我们得出 `True` 的结论，无需分析片段 2。结果：**True**。\n\n- **测试案例 C**：\n  - 质量控制：$N=10$, $q_{\\text{thresh}}=0.8$。只有 1 个位点通过。$f = 0.1  f_{\\min}=0.6$。失败。\n  - 最终决策：流程终止。结果：**False**。\n\n- **测试案例 D**：\n  - 质量控制：$f = 1.0 \\ge f_{\\min}=0.7$。通过。\n  - 重组：$S^{\\ast}=1, \\alpha_{\\text{seg}} = 0.05$。\n  - 模型选择：$T_{78}^{(1)} = 2(-706.9 - (-710.0)) = 6.2$。$p_{78}^{(1)} \\approx 0.045  0.05$。检测成立。\n  - 稳健性：$\\alpha_{\\text{seg}}=0.05$ 的临界值为 $5.991$。Bootstrap LRT值中 $[6.3, 6.1, 6.5, 6.4]$ 超过临界值，但 $5.8$ 没有。$\\phi_{\\text{boot}}^{(1)} = 4/5 = 0.8 \\ge \\phi_{\\min}=0.8$。通过。$\\phi_{\\text{jack}}^{(1)} = 4/5 = 0.8 \\ge \\psi_{\\min}=0.7$。通过。\n  - 最终决策：所有条件都满足。结果：**True**。\n\n- **测试案例 E**：\n  - 质量控制：$f = 1.0 \\ge f_{\\min}=0.7$。通过。\n  - 重组：$S^{\\ast}=1, \\alpha_{\\text{seg}} = 0.05$。\n  - 模型选择：$T_{78}^{(1)} = 2(-495.0 - (-500.0)) = 10.0$。$p_{78}^{(1)} \\approx 0.0067  0.05$。检测成立。\n  - 稳健性：$\\alpha_{\\text{seg}}=0.05$ 的临界值为 $5.991$。Bootstrap LRT值中只有 $6.1$ 超过此值。$\\phi_{\\text{boot}}^{(1)} = 1/5 = 0.2  \\phi_{\\min}=0.8$。Bootstrap 失败。\n  - 最终决策：没有片段满足所有条件。结果：**False**。", "answer": "[True, True, False, True, False]", "id": "2673738"}]}