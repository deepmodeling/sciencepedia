{"hands_on_practices": [{"introduction": "精子获能过程始于其内部生化环境的一系列精确变化，其中碳酸氢根离子 ($[\\mathrm{HCO_3^-}]$) 的涌入是关键的触发因素。这个练习将带领我们应用基础的生化原理，量化这一初始信号如何转化为细胞内生理状态的改变。我们将使用亨德森-哈塞尔巴赫方程来计算由 $[\\mathrm{HCO_3^-}]$ 浓度上升引起的胞内 pH 值的变化，并进一步通过希尔方程来估算这一变化对下游关键信号分子蛋白激酶A（PKA）活性的影响 [@problem_id:2675135]。", "problem": "哺乳动物精子的获能过程涉及碳酸氢根离子的快速内流，这会提高细胞内pH值，并通过可溶性腺苷酸环化酶 (sAC) 激活环磷酸腺苷 (cAMP) 信号通路，进而激活蛋白激酶A (PKA)，最终促进超活化。考虑一个精子群体，它们处于二氧化碳分压 $p\\mathrm{CO}_{2}$ 保持恒定的培养基中。在获能过程中，胞内碳酸氢根浓度从 $[\\mathrm{HCO}_{3}^{-}]_{1} = 5\\ \\mathrm{mM}$ 增加到 $[\\mathrm{HCO}_{3}^{-}]_{2} = 25\\ \\mathrm{mM}$，而 $p\\mathrm{CO}_{2}$ 和温度保持不变。二氧化碳-碳酸氢根缓冲体系可以用 Henderson–Hasselbalch 关系式描述，在生理温度下，对于 $\\mathrm{CO}_{2}/\\mathrm{HCO}_{3}^{-}$ 对，其有效 $pK_{a} = 6.1$。\n\n1. 仅使用 $p\\mathrm{CO}_{2}$ 恒定（因此 Henderson–Hasselbalch 表达式中溶解的 $\\mathrm{CO}_{2}$ 项保持不变）的假设，推导出在两种碳酸氢根浓度之间胞内pH值的变化量 $\\Delta \\mathrm{pH} = \\mathrm{pH}_{2} - \\mathrm{pH}_{1}$ 的表达式，并计算其数值。\n\n2. 为了估计下游信号传导，假设可溶性腺苷酸环化酶 (sAC) 产生的稳态 cAMP 受碳酸氢根激活，遵循Hill型关系，其Hill系数 $n = 2$，半激活常数 $K = 15\\ \\mathrm{mM}$。并假设稳态蛋白激酶A (PKA) 活性与 cAMP 的生成成正比。设标准化的PKA活性为 $A([\\mathrm{HCO}_{3}^{-}]) = A_{\\max}\\,\\dfrac{[\\mathrm{HCO}_{3}^{-}]^{n}}{K^{n} + [\\mathrm{HCO}_{3}^{-}]^{n}}$。计算PKA活性的倍数变化，定义为 $F = \\dfrac{A(25\\ \\mathrm{mM})}{A(5\\ \\mathrm{mM})}$。\n\n将您对 $\\Delta \\mathrm{pH}$ 和 $F$ 的最终答案以行向量 $\\bigl[\\Delta \\mathrm{pH}\\ \\ F\\bigr]$ 的形式一起提供。将每个量四舍五入到三位有效数字。最终的方框答案中不要包含单位；请注意这两个量都是无单位的。", "solution": "该问题经过验证，被认为是有效的。它在科学上基于酸碱化学和酶动力学原理，问题提法得当，信息充分，并且客观。没有矛盾或谬误。我们开始解答。\n\n问题分为两部分。第一部分要求计算由碳酸氢根浓度增加引起的胞内pH值变化量 $\\Delta \\mathrm{pH}$。第二部分要求计算蛋白激酶A (PKA) 活性的倍数变化 $F$。\n\n第1部分：计算 $\\Delta \\mathrm{pH}$\n\n胞内pH值由二氧化碳-碳酸氢根缓冲体系控制，该体系由Henderson-Hasselbalch方程描述：\n$$ \\mathrm{pH} = pK_{a} + \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]}{[\\mathrm{H}_{2}\\mathrm{CO}_{3}]} \\right) $$\n碳酸浓度 $[\\mathrm{H}_{2}\\mathrm{CO}_{3}]$ 与溶解在水中的二氧化碳 $[\\mathrm{CO}_{2}]_{\\mathrm{aq}}$ 处于平衡状态。根据Henry定律，溶解气体的浓度与其分压 $p\\mathrm{CO}_{2}$ 成正比。因此，$[\\mathrm{H}_{2}\\mathrm{CO}_{3}]$ 与 $p\\mathrm{CO}_{2}$ 成正比。问题陈述 $p\\mathrm{CO}_{2}$ 保持恒定。因此，Henderson-Hasselbalch方程分母中代表溶解二氧化碳物种浓度的项是恒定的。我们将其表示为常数浓度 $C = [\\mathrm{H}_{2}\\mathrm{CO}_{3}]$。\n\n给定了两个状态：初始状态（下标为1）和最终状态（下标为2）。每个状态的pH值为：\n$$ \\mathrm{pH}_{1} = pK_{a} + \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{1}}{C} \\right) $$\n$$ \\mathrm{pH}_{2} = pK_{a} + \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}}{C} \\right) $$\npH值的变化量 $\\Delta \\mathrm{pH}$ 定义为 $\\mathrm{pH}_{2} - \\mathrm{pH}_{1}$。\n$$ \\Delta \\mathrm{pH} = \\mathrm{pH}_{2} - \\mathrm{pH}_{1} = \\left( pK_{a} + \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}}{C} \\right) \\right) - \\left( pK_{a} + \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{1}}{C} \\right) \\right) $$\n$pK_{a}$ 项相互抵消。使用对数恒等式 $\\log(a) - \\log(b) = \\log(a/b)$，我们合并对数项：\n$$ \\Delta \\mathrm{pH} = \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}}{C} \\right) - \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{1}}{C} \\right) = \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}/C}{[\\mathrm{HCO}_{3}^{-}]_{1}/C} \\right) $$\n恒定的分母 $C$ 被消去，得到pH变化的最终表达式：\n$$ \\Delta \\mathrm{pH} = \\log_{10} \\left( \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}}{[\\mathrm{HCO}_{3}^{-}]_{1}} \\right) $$\n给定的初始和最终碳酸氢根浓度为：$[\\mathrm{HCO}_{3}^{-}]_{1} = 5\\ \\mathrm{mM}$ 和 $[\\mathrm{HCO}_{3}^{-}]_{2} = 25\\ \\mathrm{mM}$。注意，此计算不需要 $pK_{a} = 6.1$ 的值。\n代入数值：\n$$ \\Delta \\mathrm{pH} = \\log_{10} \\left( \\frac{25}{5} \\right) = \\log_{10}(5) $$\n其数值计算结果为：\n$$ \\Delta \\mathrm{pH} \\approx 0.69897 $$\n四舍五入到三位有效数字，我们得到 $\\Delta \\mathrm{pH} \\approx 0.699$。\n\n第2部分：计算PKA活性的倍数变化 $F$\n\n标准化的PKA活性 $A$ 是碳酸氢根浓度 $[\\mathrm{HCO}_{3}^{-}]$ 的函数，由一个Hill型方程给出：\n$$ A([\\mathrm{HCO}_{3}^{-}]) = A_{\\max} \\frac{[\\mathrm{HCO}_{3}^{-}]^{n}}{K^{n} + [\\mathrm{HCO}_{3}^{-}]^{n}} $$\n倍数变化 $F$ 是最终活性与初始活性的比值：\n$$ F = \\frac{A([\\mathrm{HCO}_{3}^{-}]_{2})}{A([\\mathrm{HCO}_{3}^{-}]_{1})} $$\n代入 $A$ 的表达式：\n$$ F = \\frac{A_{\\max} \\dfrac{[\\mathrm{HCO}_{3}^{-}]_{2}^{n}}{K^{n} + [\\mathrm{HCO}_{3}^{-}]_{2}^{n}}}{A_{\\max} \\dfrac{[\\mathrm{HCO}_{3}^{-}]_{1}^{n}}{K^{n} + [\\mathrm{HCO}_{3}^{-}]_{1}^{n}}} $$\n最大活性 $A_{\\max}$ 是一个比例常数，可以消去：\n$$ F = \\frac{[\\mathrm{HCO}_{3}^{-}]_{2}^{n}}{K^{n} + [\\mathrm{HCO}_{3}^{-}]_{2}^{n}} \\cdot \\frac{K^{n} + [\\mathrm{HCO}_{3}^{-}]_{1}^{n}}{[\\mathrm{HCO}_{3}^{-}]_{1}^{n}} $$\n给定以下参数：Hill系数 $n = 2$，半激活常数 $K = 15\\ \\mathrm{mM}$，初始浓度 $[\\mathrm{HCO}_{3}^{-}]_{1} = 5\\ \\mathrm{mM}$，以及最终浓度 $[\\mathrm{HCO}_{3}^{-}]_{2} = 25\\ \\mathrm{mM}$。\n将这些值代入 $F$ 的表达式。单位 ($\\mathrm{mM}$)是一致的，将会抵消，所以我们可以直接使用数值。\n$$ F = \\frac{25^{2}}{15^{2} + 25^{2}} \\cdot \\frac{15^{2} + 5^{2}}{5^{2}} $$\n计算平方项：$5^{2} = 25$，$15^{2} = 225$，$25^{2} = 625$。\n$$ F = \\frac{625}{225 + 625} \\cdot \\frac{225 + 25}{25} $$\n$$ F = \\frac{625}{850} \\cdot \\frac{250}{25} $$\n$$ F = \\frac{625}{850} \\cdot 10 = \\frac{6250}{850} = \\frac{625}{85} $$\n通过将分子和分母都除以 $5$ 来化简分数：\n$$ F = \\frac{125}{17} $$\n其数值计算结果为：\n$$ F \\approx 7.35294 $$\n四舍五入到三位有效数字，我们得到 $F \\approx 7.35$。\n\n最终答案要求将 $\\Delta \\mathrm{pH}$ 和 $F$ 这两个量以行向量的形式呈现。\n$\\Delta \\mathrm{pH} \\approx 0.699$\n$F \\approx 7.35$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.699  7.35 \\end{pmatrix}}\n$$", "id": "2675135"}, {"introduction": "除了改变pH值，碳酸氢根还直接激活可溶性腺苷酸环化酶（sAC），从而大量生成第二信使环磷酸腺苷（cAMP）。信号的强度固然重要，但其建立和演变的时间尺度在生物学过程中同样至关重要。这个练习构建了一个动力学模型，通过一个常微分方程来描述cAMP浓度的动态平衡过程，即sAC的生成速率与磷酸二酯酶（PDE）的降解速率之间的博弈 [@problem_id:2675075]。通过求解这个模型，我们将揭示cAMP信号响应外部刺激（如进入富含碳酸氢根的输卵管环境）的内在时间常数。", "problem": "哺乳动物精子的获能依赖于细胞内环磷酸腺苷 ($[\\mathrm{cAMP}]$)，它由碳酸氢盐 ($[\\mathrm{HCO_3^-}]$) 激活的可溶性腺苷酸环化酶 (sAC) 生成，并由磷酸二酯酶 (PDE) 降解。考虑一个精子鞭毛中 $[\\mathrm{cAMP}]$ 动态变化的单室模型，其中其生成和降解遵循以下经过充分检验的动力学形式：由可溶性腺苷酸环化酶 (sAC) 的生成速率为 $v_{\\mathrm{sAC}}=V_{\\max}\\dfrac{[\\mathrm{HCO_3^-}]}{K_{0.5}+[\\mathrm{HCO_3^-}]}$，由磷酸二酯酶 (PDE) 的降解为一阶反应，速率为 $v_{\\mathrm{PDE}}=k\\,[\\mathrm{cAMP}]$，其中 $k>0$。质量平衡方程为\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt}=v_{\\mathrm{sAC}}-v_{\\mathrm{PDE}}.\n$$\n在时间 $t=0^{-}$ 时，系统在基础碳酸氢盐浓度 $[\\mathrm{HCO_3^-}]=H_{1}$ 下处于稳态。在 $t=0^{+}$ 时，细胞外碳酸氢盐浓度阶跃至一个更高的恒定水平 $[\\mathrm{HCO_3^-}]=H_{2}$，其中 $H_{2}>H_{1}$，这模拟了引发获能的输卵管环境。假设 $V_{\\max}$、$K_{0.5}$ 和 $k$ 随时间保持恒定，并且不受此次阶跃变化的影响，除非通过 $v_{\\mathrm{sAC}}$ 对 $[\\mathrm{HCO_3^-}]$ 的显式依赖关系。\n\n从这些定义出发，并且不使用任何未列出的快捷公式，推导出一个精确的闭式表达式，用于描述 $[\\mathrm{cAMP}]$ 从其阶跃后的初始值 $[\\mathrm{cAMP}](0^{+})$ 达到其在 $H_{2}$ 下的新稳态值的 $0.9$ 倍所需的时间 $t_{0.9}$。也就是说，求 $t_{0.9}$ 使得\n$$\n\\left|[\\mathrm{cAMP}](t_{0.9})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|=0.1\\,\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|,\n$$\n其中 $[\\mathrm{cAMP}]_{\\infty}(H)$ 表示在固定的碳酸氢盐水平 $H$ 下的稳态浓度。\n\n请以仅含 $k$ 的单个闭式表达式给出最终答案。时间单位为秒。不需要进行数值取整。", "solution": "我们从质量平衡方程开始\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt}=v_{\\mathrm{sAC}}-v_{\\mathrm{PDE}}.\n$$\n根据假设，可溶性腺苷酸环化酶 (sAC) 的生成速率为 $v_{\\mathrm{sAC}}=V_{\\max}\\dfrac{[\\mathrm{HCO_3^-}]}{K_{0.5}+[\\mathrm{HCO_3^-}]}$，磷酸二酯酶 (PDE) 的降解速率为 $v_{\\mathrm{PDE}}=k\\,[\\mathrm{cAMP}]$，其中 $k>0$ 为常数。对于固定的碳酸氢盐浓度 $[\\mathrm{HCO_3^-}]=H$，生成项是一个常数\n$$\nA(H)\\equiv V_{\\max}\\frac{H}{K_{0.5}+H}.\n$$\n在 $t=0^{+}$ 时，碳酸氢盐浓度从 $H_{1}$ 瞬时阶跃到 $H_{2}$，因此对于 $t>0$，我们得到一个具有常系数和常数输入项的线性常微分方程：\n$$\n\\frac{d[\\mathrm{cAMP}]}{dt}=A(H_{2})-k\\,[\\mathrm{cAMP}].\n$$\n为简洁起见，令 $C(t)\\equiv[\\mathrm{cAMP}](t)$。方程可写为\n$$\n\\frac{dC}{dt}+k\\,C=A(H_{2}).\n$$\n这个一阶线性微分方程的通解是齐次解与一个特解之和。齐次方程 $\\dfrac{dC}{dt}+k\\,C=0$ 的解为 $C_{h}(t)=C_{0}\\,\\exp(-k t)$，其中 $C_{0}$ 是一个常数。一个常数特解 $C_{p}$ 满足 $k\\,C_{p}=A(H_{2})$，因此\n$$\nC_{p}=\\frac{A(H_{2})}{k}.\n$$\n因此，完整解为\n$$\nC(t)=\\frac{A(H_{2})}{k}+\\left(C(0^{+})-\\frac{A(H_{2})}{k}\\right)\\exp(-k t).\n$$\n在固定碳酸氢盐浓度 $H$ 下的稳态浓度通过令 $\\dfrac{dC}{dt}=0$ 定义，得到\n$$\n[\\mathrm{cAMP}]_{\\infty}(H)=\\frac{A(H)}{k}=\\frac{1}{k}\\,V_{\\max}\\frac{H}{K_{0.5}+H}.\n$$\n因此，对于 $t>0$，\n$$\n[\\mathrm{cAMP}](t)=[\\mathrm{cAMP}]_{\\infty}(H_{2})+\\left([\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right)\\exp(-k t).\n$$\n题目要求我们求 $t_{0.9}$，使得浓度与新稳态的偏差衰减到其初始大小的十分之一：\n$$\n\\left|[\\mathrm{cAMP}](t_{0.9})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|=0.1\\,\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|.\n$$\n将解代入左侧，得到\n$$\n\\left|[\\mathrm{cAMP}](t)-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|=\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|\\,\\exp(-k t).\n$$\n因此，条件变为\n$$\n\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|\\,\\exp(-k t_{0.9})=0.1\\,\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|.\n$$\n只要初始偏差不为零（对于 $H_{2}\\neq H_{1}$ 的真实阶跃，这是成立的），我们就可以将两边同除以 $\\left|[\\mathrm{cAMP}](0^{+})-[\\mathrm{cAMP}]_{\\infty}(H_{2})\\right|$，得到\n$$\n\\exp(-k t_{0.9})=0.1.\n$$\n取自然对数，得到\n$$\n-k\\,t_{0.9}=\\ln(0.1)=-\\ln(10),\n$$\n因此\n$$\nt_{0.9}=\\frac{1}{k}\\,\\ln(10).\n$$\n由此可以立即得出两点：\n\n1. 时间 $t_{0.9}$ 仅取决于降解速率常数 $k$；它与 $V_{\\max}$、$K_{0.5}$、$H_{1}$ 和 $H_{2}$ 无关。这是由阶跃输入驱动的一阶线性系统的一个通用属性：达到新稳态的分数进程仅由齐次衰减率决定。\n\n2. 因为 $k$ 的单位是时间的倒数，所以 $\\dfrac{1}{k}$ 的单位是时间。因此，当 $k$ 以 $\\mathrm{s}^{-1}$ 表示时，$t_{0.9}$ 的单位是秒。\n\n因此，精确的闭式表达式是 $t_{0.9}=\\dfrac{1}{k}\\ln(10)$。", "answer": "$$\\boxed{\\frac{1}{k}\\ln(10)}$$", "id": "2675075"}, {"introduction": "细胞内pH值的改变最终会汇聚到对离子通道功能的调控上，其中精子特异性阳离子通道（CatSper）是介导超活化运动的核心。本练习将我们带入生物物理研究的前沿，从理论计算转向模拟真实世界的实验数据分析。我们将从统计热力学的基本原理出发，推导描述离子通道开关行为的玻尔兹曼模型，并利用该模型来拟合模拟的CatSper通道在不同pH条件下的电生理数据 [@problem_id:2675116]。这项实践不仅能让我们量化通道电压门控对pH的敏感性，还能深入理解其背后的分子机制，即将pH变化与门控残基的质子化状态联系起来。", "problem": "一个双态热力学门控模型描述了精子特异性 CatSper 通道在获能过程中的开放概率。假设在闭合态和开放态之间存在一个双态平衡，其吉布斯自由能差 $\\Delta G(V, \\mathrm{pH}_i)$ 线性依赖于膜电压 $V$ 并受细胞内 pH ($\\mathrm{pH}_i$) 的调节。其基本原理是，在热平衡状态下，状态占据率的比值遵循玻尔兹曼分布，其中\n$$\n\\Delta G(V,\\mathrm{pH}_i) = \\Delta G_0(\\mathrm{pH}_i) - z_g F V,\n$$\n其中 $z_g$ 是无量纲的有效门控电荷，$F$ 是法拉第常数，$\\Delta G_0(\\mathrm{pH}_i)$ 是一个依赖于 $\\mathrm{pH}_i$ 的基线能量差。开放概率由该双态系统在温度 $T$ 下的平衡决定，遵循玻尔兹曼定律。\n\n利用这一物理基础，推导出一个适用于拟合的开放概率电压依赖性模型，然后将该模型与在三个测试条件（标记为 A、B 和 C）下生成的数据进行拟合。根据最佳拟合参数，计算每个 $\\mathrm{pH}_i$ 对应的半激活电压 $V_{1/2}$，然后通过线性回归确定 $V_{1/2}$ 随单位 $\\mathrm{pH}_i$ 变化的偏移量。以毫伏每 pH 单位报告斜率。\n\n使用的物理常数：\n- 通用气体常数：$R = 8.314462618 \\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 法拉第常数：$F = 96485.33212 \\,\\mathrm{C\\,mol^{-1}}$。\n- 绝对温度：$T = 310 \\,\\mathrm{K}$。\n\n电压网格（在数据生成和拟合中，所有电压均以毫伏表示）：$V \\in \\{-100,-75,-50,-25,0,25,50,75,100\\}$。\n\n建模与数据生成假设：\n- 假设在平衡状态下为严格的双态模型。\n- 仅在数据生成时，假设所有三个条件的有效门控电荷恒为 $z_g = 1$，以固定由温度和电荷所决定的斜率因子。\n- 将斜率因子定义为（单位：毫伏）$k = 1000 \\cdot \\frac{R T}{z_g F}$。\n- 对于每个条件，定义半激活电压对 $\\mathrm{pH}_i$ 的线性依赖关系：\n$$\nV_{1/2}(\\mathrm{pH}_i) = V_{1/2}^{\\mathrm{ref}} + \\alpha \\cdot (\\mathrm{pH}_i - \\mathrm{pH}^{\\mathrm{ref}}),\n$$\n单位为毫伏，其中 $V_{1/2}^{\\mathrm{ref}}$ 和 $\\mathrm{pH}^{\\mathrm{ref}}$ 是每个条件的参考值，而 $\\alpha$ 是真实的、单位 $\\mathrm{pH}_i$ 变化对应的 $V_{1/2}$ 偏移量（单位为 $\\mathrm{mV}/\\mathrm{pH}$）。观测到的开放概率数据是使用这些参数从平衡双态模型中确定性地生成的，没有添加噪声。\n\n测试套件（三个独立条件）：\n- 条件 A（理想路径）：$\\mathrm{pH}_i \\in \\{6.8, 7.0, 7.2, 7.4\\}$，$V_{1/2}^{\\mathrm{ref}} = -20 \\,\\mathrm{mV}$（在 $\\mathrm{pH}^{\\mathrm{ref}} = 7.0$ 时），以及 $\\alpha = -30 \\,\\mathrm{mV}/\\mathrm{pH}$。\n- 条件 B（边界情况，$\\mathrm{pH}_i$ 点数最少）：$\\mathrm{pH}_i \\in \\{7.2, 7.6\\}$，$V_{1/2}^{\\mathrm{ref}} = -10 \\,\\mathrm{mV}$（在 $\\mathrm{pH}^{\\mathrm{ref}} = 7.2$ 时），以及 $\\alpha = 10 \\,\\mathrm{mV}/\\mathrm{pH}$。\n- 条件 C（边缘情况，对 $\\mathrm{pH}_i$ 不敏感）：$\\mathrm{pH}_i \\in \\{6.9, 7.1, 7.3\\}$，$V_{1/2}^{\\mathrm{ref}} = -25 \\,\\mathrm{mV}$（在 $\\mathrm{pH}^{\\mathrm{ref}} = 7.1$ 时），以及 $\\alpha = 0 \\,\\mathrm{mV}/\\mathrm{pH}$。\n\n你的任务：\n- 使用上述热力学双态基础，推导电压-激活关系，并将其转换为一个包含半激活电压 $V_{1/2}$ 和与温度及有效电荷一致的斜率因子的可拟合函数。\n- 对于每个条件和每个指定的 $\\mathrm{pH}_i$，使用确定性双态平衡模型和所提供的条件参数，在电压网格上生成合成的开放概率数据。\n- 对于每个 $\\mathrm{pH}_i$，将推导出的模型与生成的数据进行拟合，以仅从数据中估计 $V_{1/2}(\\mathrm{pH}_i)$ 和斜率因子（拟合过程中不要假设其真实值）。\n- 对于每个条件，对 $V_{1/2}(\\mathrm{pH}_i)$ 与 $\\mathrm{pH}_i$ 的关系进行线性最小二乘拟合，以估计单位 $\\Delta \\mathrm{pH}_i$ 对应的 $V_{1/2}$ 偏移量。\n- 以 $\\mathrm{mV}/\\mathrm{pH}$ 为单位表示每个条件的最终斜率，四舍五入到恰好三位小数（使用小数而非百分比）。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含条件 A、B 和 C 的三个估计斜率（按此顺序），格式为用方括号括起来的逗号分隔列表，例如 `\"[x_A,x_B,x_C]\"`。\n- 单位：以 $\\mathrm{mV}/\\mathrm{pH}$ 报告斜率。\n- 本问题不涉及角度单位。\n\n科学真实性与解释要求：\n- 估计出的斜率的符号和大小应根据对 pH 敏感的门控残基的质子化进行物理解释。\n- 碱性偏移（$\\mathrm{pH}_i$ 增加）导致 $V_{1/2}$ 减小（负斜率），这对应于通过去质子化稳定了开放态；相反的符号则反映了闭合态的相对稳定。\n\n本说明中的所有数字和变量均应按国际单位制（SI）标准处理，除非像上文所述明确指定电压单位为毫伏。确保程序的输出严格遵守指定的最终输出格式。", "solution": "问题陈述经过严格评估，被认定为有效。它在科学上基于统计热力学原理（玻尔兹曼分布）应用于离子通道门控的生物物理模型，这是该领域的标准方法。该问题定义明确，提供了所有必需的常数、参数以及一系列清晰的任务，从而能够导出一个唯一的、可验证的解决方案。定义和约束条件是自洽的、一致的，并以客观的语言表述。未发现科学、逻辑或结构上的缺陷。\n\n解决方案主要分三个阶段进行：\n1. 从第一性原理推导适用于拟合的电压-激活模型。\n2. 计算模拟与分析：针对每个指定条件，生成合成数据，将模型与此数据拟合以估计参数，并执行最终的线性回归。\n3. 基于底层生物物理模型对结果进行解释。\n\n**1. 门控模型的推导**\n\n问题描述了一个通道的双态平衡模型，该通道可以存在于闭合态 ($C$) 或开放态 ($O$)：\n$$ C \\rightleftharpoons O $$\n在热平衡状态下，处于开放态的概率 $P_O$ 与处于闭合态的概率 $P_C$ 之比由玻尔兹曼分布决定，该分布取决于两个状态之间的吉布斯自由能差 $\\Delta G$：\n$$ \\frac{P_O}{P_C} = \\exp\\left(-\\frac{\\Delta G}{RT}\\right) $$\n其中 $R$ 是通用气体常数，$T$ 是绝对温度。由于通道必须处于这两种状态之一，因此概率之和必须为 1：$P_O + P_C = 1$。我们可以将 $P_C$ 表示为 $1 - P_O$ 并将其代入平衡方程中：\n$$ \\frac{P_O}{1 - P_O} = \\exp\\left(-\\frac{\\Delta G}{RT}\\right) $$\n求解该方程得到开放概率 $P_O$，即 S 型玻尔兹曼函数：\n$$ P_O(V, \\mathrm{pH}_i) = \\frac{1}{1 + \\exp\\left(\\frac{\\Delta G(V, \\mathrm{pH}_i)}{RT}\\right)} $$\n问题指明，自由能差 $\\Delta G$ 线性依赖于膜电压 $V$：\n$$ \\Delta G(V, \\mathrm{pH}_i) = \\Delta G_0(\\mathrm{pH}_i) - z_g F V $$\n这里，$z_g$ 是有效门控电荷，$F$ 是法拉第常数，$\\Delta G_0(\\mathrm{pH}_i)$ 是零电压下的自由能差，受细胞内 pH 值 $\\mathrm{pH}_i$ 的调节。\n\n为了创建一个适用于拟合的模型，我们用半激活电压 $V_{1/2}$ 对方程进行重新参数化。半激活电压是开放概率为 0.5 时的电压。在玻尔兹曼函数中设定 $P_O = 0.5$ 意味着指数的参数必须为零，即 $\\Delta G(V_{1/2}, \\mathrm{pH}_i) = 0$。\n$$ \\Delta G_0(\\mathrm{pH}_i) - z_g F V_{1/2} = 0 \\implies \\Delta G_0(\\mathrm{pH}_i) = z_g F V_{1/2} $$\n将 $\\Delta G_0(\\mathrm{pH}_i)$ 的这个表达式代回 $\\Delta G$ 的方程中：\n$$ \\Delta G(V, \\mathrm{pH}_i) = z_g F V_{1/2} - z_g F V = z_g F (V_{1/2} - V) $$\n现在，开放概率函数可以写成：\n$$ P_O(V) = \\frac{1}{1 + \\exp\\left(\\frac{z_g F (V_{1/2} - V)}{RT}\\right)} $$\n问题要求电压以毫伏 (mV) 表示。设 $V$ 和 $V_{1/2}$ 的单位为 mV。那么，我们必须将它们转换为伏特 (V) 以与 $R$、$T$ 和 $F$ 的国际单位制 (SI) 单位保持一致。以毫伏为单位的电压 $V_{\\text{mV}}$ 相当于 $V_{\\text{mV}}/1000$ 伏特。指数的参数变为：\n$$ \\frac{z_g F ( (V_{1/2})_{\\text{mV}} - V_{\\text{mV}} ) / 1000}{RT} = \\frac{(V_{1/2})_{\\text{mV}} - V_{\\text{mV}}}{1000 \\cdot \\frac{RT}{z_g F}} $$\n我们定义一个单位为毫伏的斜率因子 $k = 1000 \\cdot \\frac{RT}{z_g F}$。这给出了玻尔兹曼模型的最终、可拟合形式：\n$$ P_O(V) = \\frac{1}{1 + \\exp\\left(\\frac{V_{1/2} - V}{k}\\right)} $$\n其中 $V$、$V_{1/2}$ 和 $k$ 的单位均为 mV。需要通过拟合来估计的参数是 $V_{1/2}$ 和 $k$。\n\n**2. 计算流程**\n\n对于每个实验条件（A、B、C），总体流程包括三个步骤：\n\na. **数据生成**：使用为每个条件提供的参数（$\\alpha$、$V_{1/2}^{\\mathrm{ref}}$、$\\mathrm{pH}^{\\mathrm{ref}}$）以及每个指定的 $\\mathrm{pH}_i$，我们首先计算“真实”的半激活电压 $V_{1/2}(\\mathrm{pH}_i) = V_{1/2}^{\\mathrm{ref}} + \\alpha \\cdot (\\mathrm{pH}_i - \\mathrm{pH}^{\\mathrm{ref}})$。我们还计算“真实”的斜率因子 $k = 1000 \\cdot RT / (z_g F)$，其中 $z_g=1$。然后，将这些值用于推导出的玻尔兹曼函数，为所提供网格中的每个电压生成确定性的开放概率数据 $P_O$。\n\nb. **参数估计**：对于每个生成的数据集（一个条件内每个 $\\mathrm{pH}_i$ 对应一个），我们对 $(V, P_O)$ 数据进行玻尔兹曼模型的非线性最小二乘拟合。拟合过程估计参数 $V_{1/2}$ 和 $k$。由于数据无噪声且由同一模型生成，拟合预计能精确地恢复在 a 步骤中使用的真实参数。我们收集每个 $\\mathrm{pH}_i$ 的拟合 $V_{1/2}$ 值。\n\nc. **线性回归**：对于每个条件，我们现在都有一组有序对 $(\\mathrm{pH}_i, V_{1/2}^{\\text{fitted}})$。我们对这些数据进行线性最小二乘回归，以拟合模型 $V_{1/2}^{\\text{fitted}} = m \\cdot \\mathrm{pH}_i + c$。这条线的斜率 $m$ 就是我们想要的量：每单位 pH 变化的半激活电压偏移量，即 $\\Delta V_{1/2} / \\Delta \\mathrm{pH}_i$。该值等同于用于数据生成的参数 $\\alpha$。\n\n**3. 生物物理解释**\n\n斜率 $\\alpha = \\Delta V_{1/2} / \\Delta \\mathrm{pH}_i$ 量化了通道电压依赖性门控的 pH 敏感性。其符号具有重要的生物物理意义：\n- **负斜率 ($\\alpha  0$)**：$\\mathrm{pH}_i$ 的增加（碱化）导致 $V_{1/2}$ 的减小（在电压轴上向左移动）。这表明在较高的 pH 值下，通道需要较少的去极化即可开放。这意味着一个或多个对 pH 敏感的氨基酸残基（例如组氨酸）的去质子化稳定了开放态（相对于闭合态）。\n- **正斜率 ($\\alpha > 0$)**：$\\mathrm{pH}_i$ 的增加导致 $V_{1/2}$ 的增加（向右移动）。这意味着通道需要更多的去极化才能开放，暗示去质子化稳定了闭合态（相对于开放态）。\n- **零斜率 ($\\alpha = 0$)**：在测试范围内，通道的电压依赖性对 pH 变化不敏感。\n\n以下代码实现了此流程，以确定三个给定条件下的斜率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Derives gating parameters for the CatSper channel based on a two-state\n    thermodynamic model, fits the model to synthetic data, and determines\n    the pH-sensitivity of voltage gating.\n    \"\"\"\n    # Physical constants\n    R = 8.314462618  # J mol^-1 K^-1\n    F = 96485.33212   # C mol^-1\n    T = 310.0         # K\n\n    # Voltage grid (in mV) for data generation and fitting\n    V_grid = np.array([-100, -75, -50, -25, 0, 25, 50, 75, 100], dtype=float)\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"ph_values\": [6.8, 7.0, 7.2, 7.4],\n            \"v_half_ref\": -20.0,\n            \"ph_ref\": 7.0,\n            \"alpha\": -30.0,\n        },\n        {\n            \"ph_values\": [7.2, 7.6],\n            \"v_half_ref\": -10.0,\n            \"ph_ref\": 7.2,\n            \"alpha\": 10.0,\n        },\n        {\n            \"ph_values\": [6.9, 7.1, 7.3],\n            \"v_half_ref\": -25.0,\n            \"ph_ref\": 7.1,\n            \"alpha\": 0.0,\n        },\n    ]\n\n    # Fit-ready Boltzmann function where V, v_half, and k are in mV\n    def boltzmann_model(V, v_half, k):\n        \"\"\"\n        Calculates open probability based on the Boltzmann distribution.\n        \"\"\"\n        # A small epsilon is added to the denominator to prevent division-by-zero\n        # in edge cases, though not strictly necessary with standard float precision.\n        return 1.0 / (1.0 + np.exp((v_half - V) / k))\n\n    # Gating charge for data generation, as specified\n    z_g_gen = 1.0\n\n    # Calculate the slope factor k for data generation (in mV)\n    k_gen = 1000.0 * (R * T) / (z_g_gen * F)\n    \n    results = []\n\n    for case in test_cases:\n        ph_vals = np.array(case[\"ph_values\"])\n        v_half_ref = case[\"v_half_ref\"]\n        ph_ref = case[\"ph_ref\"]\n        alpha = case[\"alpha\"]\n        \n        fitted_v_halfs = []\n\n        # For each pH value in the current condition...\n        for ph_i in ph_vals:\n            # 1. Generate synthetic data\n            # Calculate the \"true\" half-activation voltage for this pH_i\n            v_half_true = v_half_ref + alpha * (ph_i - ph_ref)\n            \n            # Generate deterministic open probability data across the voltage grid\n            p_open_data = boltzmann_model(V_grid, v_half_true, k_gen)\n            \n            # 2. Fit the model to the generated data\n            # Since data is ideal, initial guesses (p0) are not critical but can aid convergence.\n            p0 = [v_half_true, k_gen]  # Use true values as perfect initial guess\n            \n            # Use non-linear least squares to find the best-fit V_1/2 and k\n            params, _ = curve_fit(boltzmann_model, V_grid, p_open_data, p0=p0)\n            \n            v_half_fit = params[0]\n            fitted_v_halfs.append(v_half_fit)\n            \n        # 3. Perform linear regression of V_1/2 vs. pH\n        # Fit V_1/2 = slope * pH + intercept to find the sensitivity (slope)\n        slope, _, _, _, _ = linregress(ph_vals, fitted_v_halfs)\n        \n        results.append(slope)\n\n    # Format the final output as a comma-separated list in brackets,\n    # with each slope rounded to exactly three decimal places.\n    formatted_results = map(lambda s: f\"{s:.3f}\", results)\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2675116"}]}