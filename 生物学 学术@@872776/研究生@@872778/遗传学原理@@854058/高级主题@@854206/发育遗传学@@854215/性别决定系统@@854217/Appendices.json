{"hands_on_practices": [{"introduction": "在理解性别决定系统时，掌握性染色体上基因的独特遗传模式至关重要。以XX/XY系统为例，由于雄性只从母亲那里继承X染色体，而雌性则从双亲各继承一条，这导致了X连锁基因在两性间的等位基因频率动态存在差异。这项练习将引导你推导这些动态的基础方程，为分析任何X连锁性状的演化奠定理论基石。[@problem_id:2849906]", "problem": "在一个采用XX/XY性别决定系统的物种中，考虑一个X连锁基因座，该基因座有两个等位基因，记为$A$和$a$。设亲代中，成年雌性X染色体上等位基因$A$的频率为$p_{f}$，成年雄性X染色体上等位基因$A$的频率为$p_{m}$。假设满足以下条件，这些是哈代-温伯格随机交配模型的标准假设：(i) 雌雄个体间随机交配，(ii) 减数分裂中等位基因均等分离，(iii) 雄性产生含X和含Y配子的概率相等，(iv) 无突变、无迁移、无选择，以及 (v) 所有交配均等可能，并对合子池做出同等贡献。\n\n仅使用这些假设和XX/XY系统的定义（雌性为$XX$，雄性为$XY$），推导经过一代随机交配后合子中的预期基因型频率，分别对雌性后代（基因型$AA$、$Aa$和$aa$）和雄性后代（半合子基因型$A$和$a$）进行表示。最终答案仅用$p_{f}$和$p_{m}$表示，并将五个频率按以下顺序以单个行向量的形式呈现：雌性$AA$、雌性$Aa$、雌性$aa$、雄性$A$、雄性$a$。无需数值近似；请提供精确的代数表达式。答案中不包含任何单位。", "solution": "问题陈述需进行验证。\n\n已知条件：\n1.  性别决定系统：$XX$ (雌性) / $XY$ (雄性)。\n2.  基因座：单个，X连锁，有两个等位基因，$A$和$a$。\n3.  亲代中的等位基因频率：\n    - $p_{f}$：成年雌性X染色体上等位基因$A$的频率。\n    - $p_{m}$：成年雄性X染色体上等位基因$A$的频率。\n4.  假设 (哈代-温伯格模型)：\n    - (i) 随机交配。\n    - (ii) 等位基因均等分离。\n    - (iii) 雄性产生含X和含Y配子的概率相等。\n    - (iv) 无突变、迁移或选择。\n    - (v) 所有交配均等可能，并对合子池做出同等贡献。\n\n验证结论：\n该问题有效。这是一个种群遗传学中标准的、定义明确的问题，具有科学依据且表述客观。它要求将孟德尔遗传的基本原理应用于性连锁基因座。所提供的信息完整且一致，可以唯一地推导出所要求的基因型频率。我们将继续进行推导。\n\n核心原理是后代的基因型由亲代配子的随机结合决定。我们必须首先确定雌雄种群产生的配子中等位基因的频率。\n\n步骤1：确定配子频率\n雌性的基因型为$XX$。其X染色体上等位基因$A$的频率为$p_{f}$，因此等位基因$a$的频率为$1 - p_{f}$。根据分离定律(ii)，所产生的卵子（雌性配子）携带等位基因$A$的频率为$p_{f}$，携带等位基因$a$的频率为$1 - p_{f}$。\n- 卵子中$A$的频率：$p_{f}$\n- 卵子中$a$的频率：$1 - p_{f}$\n\n雄性的基因型为$XY$。其单条X染色体携带等位基因$A$或$a$。雄性中等位基因$A$的频率为$p_{m}$，因此基因型为$A$（更精确地说是$X^{A}Y$）的雄性频率为$p_{m}$。基因型为$a$（即$X^{a}Y$）的雄性频率为$1 - p_{m}$。雄性产生两种数量相等的配子(iii)：含X的精子和含Y的精子。含X精子所携带的等位基因是雄性自身X染色体上的那个。\n- 携带$A$的含X精子的频率：$p_{m}$\n- 携带$a$的含X精子的频率：$1 - p_{m}$\n- 含Y的精子不携带该基因座。\n\n步骤2：计算后代的基因型频率\n下一代的基因型频率通过考虑卵子和精子的随机结合来确定，这由随机交配的假设(i)所决定。我们必须分别考虑雌性后代和雄性后代。\n\n雌性后代 ($XX$)：\n雌性后代从母亲（卵子）继承一条X染色体，从父亲（精子）继承一条X染色体。三种可能的雌性基因型（$AA$、$Aa$、$aa$）的频率计算如下：\n- 雌性合子基因型为$AA$的概率是卵子携带$A$的概率与含X精子携带$A$的概率的乘积。\n  频率(雌性$AA$) = (卵子中$A$的频率) $\\times$ (含X精子中$A$的频率) = $p_{f} \\times p_{m}$\n- 雌性合子基因型为$aa$的概率是卵子携带$a$的概率与含X精子携带$a$的概率的乘积。\n  频率(雌性$aa$) = (卵子中$a$的频率) $\\times$ (含X精子中$a$的频率) = $(1 - p_{f})(1 - p_{m})$\n- 雌性合子的基因型为$Aa$有两种方式：一个携带$A$的卵子被一个携带$a$的精子受精，或者一个携带$a$的卵子被一个携带$A$的精子受精。总概率是这两个互斥事件的概率之和。\n  频率(雌性$Aa$) = (卵子中$A$的频率)(含X精子中$a$的频率) + (卵子中$a$的频率)(含X精子中$A$的频率)\n  $= p_{f}(1 - p_{m}) + (1 - p_{f})p_{m}$\n  $= p_{f} - p_{f}p_{m} + p_{m} - p_{f}p_{m}$\n  $= p_{f} + p_{m} - 2p_{f}p_{m}$\n\n作为检验，雌性基因型频率之和必须为1：\n$p_{f}p_{m} + (p_{f} + p_{m} - 2p_{f}p_{m}) + (1 - p_{f})(1 - p_{m}) = p_{f}p_{m} + p_{f} + p_{m} - 2p_{f}p_{m} + 1 - p_{f} - p_{m} + p_{f}p_{m} = 1$。计算结果一致。\n\n雄性后代 ($XY$)：\n雄性后代从母亲（卵子）继承其单条X染色体，从父亲（精子）继承Y染色体。因此，其X染色体上的等位基因完全由孕育他的卵子中所含的等位基因决定。\n- 雄性合子基因型为$A$（半合子）的概率等于携带$A$等位基因的卵子频率。\n  频率(雄性$A$) = 卵子中$A$的频率 = $p_{f}$\n- 雄性合子基因型为$a$（半合子）的概率等于携带$a$等位基因的卵子频率。\n  频率(雄性$a$) = 卵子中$a$的频率 = $1 - p_{f}$\n\n作为检验，雄性基因型频率之和必须为1：\n$p_{f} + (1 - p_{f}) = 1$。计算结果一致。\n\n问题要求将五个频率按以下顺序以单个行向量的形式呈现：雌性$AA$、雌性$Aa$、雌性$aa$、雄性$A$、雄性$a$。根据推导，这些频率是：\n1.  雌性 $AA$：$p_{f}p_{m}$\n2.  雌性 $Aa$：$p_{f} + p_{m} - 2p_{f}p_{m}$\n3.  雌性 $aa$：$(1 - p_{f})(1 - p_{m})$\n4.  雄性 $A$：$p_{f}$\n5.  雄性 $a$：$1 - p_{f}$\n\n推导结束。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\np_{f} p_{m}  p_{f} + p_{m} - 2 p_{f} p_{m}  (1-p_{f})(1-p_{m})  p_{f}  1-p_{f}\n\\end{pmatrix}\n}\n$$", "id": "2849906"}, {"introduction": "在遗传学研究中，一个具有挑战性的任务是，仅凭表型观察来推断其潜在的遗传结构。例如，一个仅在雄性中表现的性状，可能源于X连锁遗传，也可能是由常染色体基因的限雄性表达所致。这项练习将带你运用统计推断的核心工具——似然性，来区分这两种相互竞争的遗传模型，通过分析具体的系谱数据，培养你解决实际遗传难题的能力。[@problem_id:2849995]", "problem": "一个研究团队怀疑某种脊椎动物的限雄性性状（仅在雄性中表达）是由常染色体等位基因或X染色体等位基因引起的。他们从一个大型随机交配群体中，通过患病父亲和无亲缘关系的未患病母亲，收集了多个家系。假设如下：\n\n- 对于携带至少一个致病等位基因的雄性，该性状是完全外显的，而在雌性中从不表达（限雄性表达）。\n- 无新突变，无拟表型，且孟德尔分离定律成立。\n- 在常染色体模型下，每位患病父亲都是杂合子；在X连锁模型下，每位患病父亲都是半合子。\n- 根据独立筛查已知，携带者母亲的群体频率（在常染色体模型下为常染色体等位基因的杂合子；在X连锁模型下为X连锁等位基因的杂合子）在常染色体模型下为 $c_A = 0.02$，在X连锁模型下为 $c_X = 0.02$。\n\n对于每个家庭，其儿子数量和患病儿子数量记录如下（各家庭相互独立）：\n\n- 家庭 $1$：$s_1 = 3$ 个儿子，$a_1 = 2$ 个患病儿子。\n- 家庭 $2$：$s_2 = 2$ 个儿子，$a_2 = 1$ 个患病儿子。\n- 家庭 $3$：$s_3 = 4$ 个儿子，$a_3 = 2$ 个患病儿子。\n- 家庭 $4$：$s_4 = 1$ 个儿子，$a_4 = 0$ 个患病儿子。\n- 家庭 $5$：$s_5 = 3$ 个儿子，$a_5 = 1$ 个患病儿子。\n- 家庭 $6$：$s_6 = 2$ 个儿子，$a_6 = 2$ 个患病儿子。\n\n仅从孟德尔分离定律和所述的限雄性外显率出发，推导在以下模型下每个家庭的似然：\n\n- 模型 $A$（常染色体，限雄性）：患病父亲是常染色体杂合子；母亲是携带者的概率为 $c_A$，是非携带者的概率为 $1 - c_A$。\n- 模型 $X$（X连锁，限雄性）：患病父亲是$X$半合子；母亲是携带者的概率为 $c_X$，是非携带者的概率为 $1 - c_X$。\n\n然后，使用这些似然计算所有家庭的联合似然 $L_A$ 和 $L_X$，以及自然对数似然比\n$$\\ln \\Lambda = \\ln L_A - \\ln L_X.$$\n报告 $\\ln \\Lambda$ 的数值，四舍五入到四位有效数字。最终答案必须是一个实数（无量纲）。", "solution": "我们从孟德尔分离定律和所述的限雄性外显率出发。\n\n在模型 $A$（常染色体，限雄性）下：\n- 患病父亲是常染色体杂合子。对于一个儿子，如果母亲是非携带者（概率为 $1 - c_A$），儿子从父亲那里继承该等位基因的概率是 $1/2$，并且由于该性状是限雄性完全外显的，儿子患病的概率是 $1/2$。如果母亲是携带者（概率为 $c_A$），则父亲是杂合子，母亲也是杂合子；一个儿子只有在基因型为 $aa$ 时才不患病，这种情况发生的概率是 $1/4$，因此儿子患病的概率是 $3/4$。在给定母亲携带状态的条件下，根据标准二项抽样，儿子们是相互独立的。\n- 因此，对于一个有 $s$ 个儿子和 $a$ 个患病儿子的家庭，其在模型 $A$ 下的似然是一个混合：\n$$\nL_{A,\\text{family}} = (1 - c_A)\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{a}\\left(\\frac{1}{2}\\right)^{s-a} \\;+\\; c_A\\,\\binom{s}{a}\\left(\\frac{3}{4}\\right)^{a}\\left(\\frac{1}{4}\\right)^{s-a}.\n$$\n\n在模型 $X$（X连锁，限雄性）下：\n- 患病父亲是 $X$ 半合子，并将 Y 染色体遗传给所有儿子；因此，儿子不能继承父源的 X 等位基因。如果母亲是非携带者（概率为 $1 - c_X$），那么没有儿子会患病，所以在 $s$ 个儿子中有 $a=0$ 个患病儿子的概率是 $1$，而有 $a0$ 个患病儿子的概率是 $0$。如果母亲是携带者（概率为 $c_X$），每个儿子有 $1/2$ 的概率继承母源的突变 X 染色体，因此会患病（限雄性完全外显）。在给定母亲携带状态的条件下，儿子们是相互独立的。\n- 因此，对于一个有 $s$ 个儿子和 $a$ 个患病儿子的家庭，其在模型 $X$ 下的似然是：\n$$\nL_{X,\\text{family}} = (1 - c_X)\\,\\mathbf{1}\\{a = 0\\} \\;+\\; c_X\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{a}\\left(\\frac{1}{2}\\right)^{s-a} \\;=\\; (1 - c_X)\\,\\mathbf{1}\\{a = 0\\} \\;+\\; c_X\\,\\binom{s}{a}\\left(\\frac{1}{2}\\right)^{s}.\n$$\n\n给定 $c_A = 0.02$ 和 $c_X = 0.02$。\n\n计算每个家庭的似然：\n\n- 家庭 $1$：$s_1 = 3$，$a_1 = 2$，$\\binom{3}{2} = 3$，$\\left(\\frac{1}{2}\\right)^{3} = 0.125$。\n  - 模型 $A$：\n    $$\n    L_{A,1} = (1 - 0.02)\\cdot 3\\cdot 0.125 + 0.02\\cdot 3 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.98 \\cdot 0.375 + 0.02 \\cdot 3 \\cdot \\frac{9}{16}\\cdot \\frac{1}{4} \\\\\n    = 0.3675 + 0.0084375 = 0.3759375.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,1} = 0 \\;+\\; 0.02 \\cdot 3 \\cdot 0.125 = 0.0075.\n    $$\n\n- 家庭 $2$：$s_2 = 2$，$a_2 = 1$，$\\binom{2}{1} = 2$，$\\left(\\frac{1}{2}\\right)^{2} = 0.25$。\n  - 模型 $A$：\n    $$\n    L_{A,2} = 0.98 \\cdot 2 \\cdot 0.25 + 0.02 \\cdot 2 \\cdot \\left(\\frac{3}{4}\\right)^{1}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.98 \\cdot 0.5 + 0.04 \\cdot \\frac{3}{16} \\\\\n    = 0.49 + 0.0075 = 0.4975.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,2} = 0 \\;+\\; 0.02 \\cdot 2 \\cdot 0.25 = 0.01.\n    $$\n\n- 家庭 $3$：$s_3 = 4$，$a_3 = 2$，$\\binom{4}{2} = 6$，$\\left(\\frac{1}{2}\\right)^{4} = 0.0625$。\n  - 模型 $A$：\n    $$\n    L_{A,3} = 0.98 \\cdot 6 \\cdot 0.0625 + 0.02 \\cdot 6 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{2} \\\\\n    = 0.98 \\cdot 0.375 + 0.02 \\cdot 6 \\cdot \\frac{9}{16}\\cdot \\frac{1}{16} \\\\\n    = 0.3675 + 0.00421875 = 0.37171875.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,3} = 0 \\;+\\; 0.02 \\cdot 6 \\cdot 0.0625 = 0.0075.\n    $$\n\n- 家庭 $4$：$s_4 = 1$，$a_4 = 0$，$\\binom{1}{0} = 1$，$\\left(\\frac{1}{2}\\right)^{1} = 0.5$。\n  - 模型 $A$：\n    $$\n    L_{A,4} = 0.98 \\cdot 1 \\cdot 0.5 + 0.02 \\cdot 1 \\cdot \\left(\\frac{3}{4}\\right)^{0}\\left(\\frac{1}{4}\\right)^{1} \\\\\n    = 0.49 + 0.005 = 0.495.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,4} = (1 - 0.02)\\cdot 1 + 0.02 \\cdot 1 \\cdot 0.5 = 0.98 + 0.01 = 0.99.\n    $$\n\n- 家庭 $5$：$s_5 = 3$，$a_5 = 1$，$\\binom{3}{1} = 3$，$\\left(\\frac{1}{2}\\right)^{3} = 0.125$。\n  - 模型 $A$：\n    $$\n    L_{A,5} = 0.98 \\cdot 3 \\cdot 0.125 + 0.02 \\cdot 3 \\cdot \\left(\\frac{3}{4}\\right)^{1}\\left(\\frac{1}{4}\\right)^{2} \\\\\n    = 0.3675 + 0.0028125 = 0.3703125.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,5} = 0 \\;+\\; 0.02 \\cdot 3 \\cdot 0.125 = 0.0075.\n    $$\n\n- 家庭 $6$：$s_6 = 2$，$a_6 = 2$，$\\binom{2}{2} = 1$，$\\left(\\frac{1}{2}\\right)^{2} = 0.25$。\n  - 模型 $A$：\n    $$\n    L_{A,6} = 0.98 \\cdot 1 \\cdot 0.25 + 0.02 \\cdot 1 \\cdot \\left(\\frac{3}{4}\\right)^{2}\\left(\\frac{1}{4}\\right)^{0} \\\\\n    = 0.245 + 0.01125 = 0.25625.\n    $$\n  - 模型 $X$：\n    $$\n    L_{X,6} = 0 \\;+\\; 0.02 \\cdot 1 \\cdot 0.25 = 0.005.\n    $$\n\n假设各家庭相互独立，联合似然是各项乘积：\n$$\nL_A = \\prod_{i=1}^{6} L_{A,i}, \\qquad L_X = \\prod_{i=1}^{6} L_{X,i}.\n$$\n在数值计算上，计算 $\\ln \\Lambda = \\sum_{i=1}^{6} \\ln\\left(\\frac{L_{A,i}}{L_{X,i}}\\right)$ 更为稳定。\n\n计算每个家庭的似然比 $R_i = \\frac{L_{A,i}}{L_{X,i}}$：\n- 家庭 $1$：$R_1 = \\frac{0.3759375}{0.0075} = 50.125$。\n- 家庭 $2$：$R_2 = \\frac{0.4975}{0.01} = 49.75$。\n- 家庭 $3$：$R_3 = \\frac{0.37171875}{0.0075} = 49.5625$。\n- 家庭 $4$：$R_4 = \\frac{0.495}{0.99} = 0.5$。\n- 家庭 $5$：$R_5 = \\frac{0.3703125}{0.0075} = 49.375$。\n- 家庭 $6$：$R_6 = \\frac{0.25625}{0.005} = 51.25$。\n\n因此，\n$$\n\\ln \\Lambda = \\sum_{i=1}^{6} \\ln R_i = \\ln 50.125 + \\ln 49.75 + \\ln 49.5625 + \\ln 0.5 + \\ln 49.375 + \\ln 51.25.\n$$\n计算得，\n$$\n\\ln 50.125 \\approx 3.9145198856,\\;\n\\ln 49.75 \\approx 3.9070104637,\\;\n\\ln 49.5625 \\approx 3.9032345000,\n$$\n$$\n\\ln 0.5 \\approx -0.6931471806,\\;\n\\ln 49.375 \\approx 3.8994442230,\\;\n\\ln 51.25 \\approx 3.9367156170.\n$$\n求和得，\n$$\n\\ln \\Lambda \\approx 18.8677775088.\n$$\n\n四舍五入到四位有效数字，所求值为 $18.87$。", "answer": "$$\\boxed{18.87}$$", "id": "2849995"}, {"introduction": "性染色体上的遗传元件不仅遵循独特的传递规则，有时还会演化出“自私”的特性，例如破坏孟德尔定律的减数分裂驱动。本练习将带你进入一个高级课题：构建一个整合了遗传学和生态学的计算模型，来模拟一个X染色体驱动元件如何影响整个种群的命运。通过这个模拟，你将亲手探索遗传冲突、性别比例失衡和种群动态之间的深刻联系，并理解性连锁遗传元件如何能将一个种群推向灭绝的边缘。[@problem_id:2849925]", "problem": "您需要为一个具有 XX/XY 性别决定系统的物种，在引入一个 X-染色体驱动的减数分裂驱动元件的情况下，实现并分析一个确定性的、离散时间的、性别结构化的种群模型。该模型必须整合遗传学和种群动态学中的以下基本原理：(i) 在 XX/XY 系统中，雄性是异配的，合子的性别由父本的性染色体决定；(ii) 孟德尔分离定律适用于雌性，而雄性体内的驱动元件则会使 X 染色体的传递概率发生偏向；(iii) 有限的雄性交配能力限制了受精雌性的比例；(iv) Beverton–Holt 密度制约调节种群的补充量。您的任务是计算几组参数集下能避免种群崩溃的单位雌性最低繁殖力，并将这些最低繁殖力值以浮点数形式输出。\n\n模型要素和定义：\n- 时间是离散的，以世代为单位，由 $t \\in \\{0,1,2,\\dots\\}$ 索引。\n- 设 $N_f(t)$ 和 $N_m(t)$ 分别表示第 $t$ 代的成年雌性和雄性数量。\n- 设第 $t$ 代的成年雌性基因型数量为 $F_{DD}(t)$、$F_{DN}(t)$ 和 $F_{NN}(t)$，分别对应基因型 $X^D X^D$、$X^D X$ 和 $X X$，因此 $N_f(t) = F_{DD}(t) + F_{DN}(t) + F_{NN}(t)$。\n- 设第 $t$ 代的成年雄性基因型数量为 $M_D(t)$ 和 $M_N(t)$，分别对应基因型 $X^D Y$ 和 $X Y$，因此 $N_m(t) = M_D(t) + M_N(t)$。\n- 设 $c  0$ 表示雄性交配能力（单个雄性每代可使多少雌性受精），$b \\ge 0$ 表示单位雌性繁殖力（每只受精雌性的产卵数），$\\alpha \\ge 0$ 表示 Beverton–Holt 拥挤参数，$d \\in [0.5,1]$ 表示 $X^D Y$ 雄性中的减数分裂驱动偏向（传递 $X^D$ 而非 $Y$ 的概率）。非驱动型雄性（$X Y$）以 0.5 的概率传递 $X$，以 0.5 的概率传递 $Y$。\n\n在每一代 $t$：\n- 受精雌性的比例为\n$$\n\\phi_t = \n\\begin{cases}\n\\min\\left\\{1,\\; c \\, \\dfrac{N_m(t)}{N_f(t)}\\right\\},  \\text{if } N_f(t)  0, \\\\\n0,  \\text{if } N_f(t) = 0.\n\\end{cases}\n$$\n- 密度调节前的合子总数为\n$$\nE_t = b \\, \\phi_t \\, N_f(t).\n$$\n- 当 $N_f(t)  0$ 时，设雌性基因型频率为 $f_{DD}(t) = \\dfrac{F_{DD}(t)}{N_f(t)}$、$f_{DN}(t) = \\dfrac{F_{DN}(t)}{N_f(t)}$、$f_{NN}(t) = \\dfrac{F_{NN}(t)}{N_f(t)}$（否则定义为 $0$）。当 $N_m(t)  0$ 时，设雄性基因型频率为 $m_D(t) = \\dfrac{M_D(t)}{N_m(t)}$ 和 $m_N(t) = \\dfrac{M_N(t)}{N_m(t)}$（否则定义为 $0$）。\n- 雌性减数分裂遵循孟德尔定律：随机一个卵细胞携带 $X^D$ 的概率为\n$$\np^{(m)}_{X^D}(t) = f_{DD}(t) + \\dfrac{1}{2} f_{DN}(t),\n$$\n因此，$p^{(m)}_{X}(t) = 1 - p^{(m)}_{X^D}(t)$ 是卵细胞携带非驱动型 $X$ 的概率。\n- 雄性减数分裂：随机一个精子是 $X^D$ 的概率等于\n$$\np^{(f)}_{X^D}(t) = m_D(t) \\, d,\n$$\n一个精子是非驱动型 $X$ 的概率等于\n$$\np^{(f)}_{X}(t) = m_N(t) \\cdot \\dfrac{1}{2},\n$$\n一个精子是 $Y$ 的概率等于\n$$\np^{(f)}_{Y}(t) = 1 - \\left(p^{(f)}_{X^D}(t) + p^{(f)}_{X}(t)\\right) = m_D(t)\\,(1-d) + m_N(t)\\cdot \\dfrac{1}{2}.\n$$\n- 密度调节前的预期合子基因型数量由卵细胞和精子类型的概率乘积再乘以 $E_t$ 给出：\n    - 子代雌性（父本提供 $X$，母本提供 $X$）：\n        - $X^D X^D$: $E_{DD}(t) = E_t \\, p^{(f)}_{X^D}(t)\\, p^{(m)}_{X^D}(t)$.\n        - $X^D X$: $E_{DN}(t) = E_t \\left[p^{(f)}_{X^D}(t)\\, p^{(m)}_{X}(t) + p^{(f)}_{X}(t)\\, p^{(m)}_{X^D}(t)\\right]$.\n        - $X X$: $E_{NN}(t) = E_t \\, p^{(f)}_{X}(t)\\, p^{(m)}_{X}(t)$.\n    - 子代雄性（父本提供 $Y$，母本提供 $X$）：\n        - $X^D Y$: $E_{M_D}(t) = E_t \\, p^{(f)}_{Y}(t) \\, p^{(m)}_{X^D}(t)$.\n        - $X Y$: $E_{M_N}(t) = E_t \\, p^{(f)}_{Y}(t) \\, p^{(m)}_{X}(t)$.\n- Beverton–Holt 密度制约通过以下因子缩放合子数量\n$$\ns_t = \\dfrac{1}{1 + \\alpha \\left(N_f(t) + N_m(t)\\right)}.\n$$\n- 第 $t+1$ 代的成年个体为\n$$\nF_{DD}(t+1) = s_t \\, E_{DD}(t),\\quad F_{DN}(t+1) = s_t \\, E_{DN}(t),\\quad F_{NN}(t+1) = s_t \\, E_{NN}(t),\n$$\n$$\nM_D(t+1) = s_t \\, E_{M_D}(t),\\quad M_N(t+1) = s_t \\, E_{M_N}(t).\n$$\n\n灭绝与持续生存标准：\n- 如果在任何时刻 $t$，$N_f(t)   \\varepsilon$ 或 $N_m(t)   \\varepsilon$ 之一成立，则宣布种群灭绝，此时不再发生繁殖；使用 $\\varepsilon = 10^{-12}$。\n- 如果在时间上限 $T$ 时，最终总数 $N_f(T) + N_m(T) \\ge \\eta$（其中 $\\eta = 1.0$），则宣布种群持续生存。\n\n目标：\n- 对于每个参数集，计算使得种群在时间上限 $T$ 时能够持续生存的最低繁殖力值 $b^\\star$。假设持续生存相对于 $b$ 具有单调性，并通过二分搜索确定 $b^\\star$，绝对容差为 $\\delta = 10^{-6}$。使用区间限定法，从 $b_{\\text{lo}} = 0$ 和 $b_{\\text{hi}} = 1$ 开始，通过指数增加上界 $b_{\\text{hi}}$ 来找到区间，直到实现持续生存或 $b_{\\text{hi}}$ 超过 $B_{\\max} = 10^3$。如果在使用 $B_{\\max}$ 时仍未实现持续生存，则返回 $B_{\\max}$ 作为结果值。\n\n所有测试用例的初始条件：\n- 在 $t = 0$ 时，设 $F_{NN}(0) = N_f(0)$，$F_{DD}(0) = 0$，$F_{DN}(0) = 0$。\n- 在 $t = 0$ 时，设 $M_D(0) = q_0 \\, N_m(0)$ 和 $M_N(0) = \\left(1-q_0\\right) N_m(0)$。\n\n测试套件（每行为一个参数集 $(c,\\alpha,d,q_0,N_f(0),N_m(0),T)$）：\n- 情况 A: $(2.0,\\; 0.01,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$。\n- 情况 B: $(0.5,\\; 0.01,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$。\n- 情况 C: $(2.0,\\; 0.05,\\; 0.95,\\; 0.2,\\; 500,\\; 500,\\; 200)$。\n- 情况 D: $(2.0,\\; 0.01,\\; 0.6,\\; 0.2,\\; 500,\\; 500,\\; 200)$。\n\n您的程序必须：\n- 精确实现上述递推关系。\n- 对于每个测试用例，使用指定的区间限定和二分搜索规则计算 $b^\\star$，绝对容差为 $\\delta = 10^{-6}$。\n- 生成单行输出，其中包含四个 $b^\\star$ 值的列表，这些值为十进制浮点数，精确到小数点后 $6$ 位，并按 A、B、C、D 的顺序排列。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，“[bA,bB,bC,bD]”）。", "solution": "问题陈述经过验证，被确定为有效。它具有科学依据，是良态的且客观的。它为一个确定性的、离散时间的种群遗传学模型提供了完整且一致的规范。该模型正确地整合了基本原理，包括 XX/XY 性别决定、孟德尔和非孟德尔（减数分裂驱动）遗传、通过 Holling I 型功能反应实现的交配限制，以及 Beverton–Holt 密度依赖性调节。其目标是使用一个精确定义的数值搜索算法，找到一个关键参数值，即种群持续生存所需的单位雌性最低繁殖力 $b^\\star$。因此，该问题是数学生物学和计算科学中的一个标准练习。\n\n解决该问题的方法是，首先根据所提供的递推关系构建一个模拟种群动态的函数。这个函数（我们可以称之为 `check_persistence`）以一组参数 $(c, \\alpha, d, q_0, N_f(0), N_m(0), T)$ 和一个试验繁殖力值 $b$ 作为输入，然后将种群状态迭代 $T$ 代。\n\n在任何时刻 $t$ 的种群状态由五种基因型的数量完全描述：三种雌性（$F_{DD}(t)$、$F_{DN}(t)$、$F_{NN}(t)$）和两种雄性（$M_D(t)$、$M_N(t)$）。模拟从 $t=0$ 时的指定初始条件开始：\n$$F_{DD}(0)=0, \\quad F_{DN}(0)=0, \\quad F_{NN}(0)=N_f(0)$$\n$$M_D(0)=q_0 N_m(0), \\quad M_N(0)=(1-q_0) N_m(0)$$\n\n在模拟的每一代 $t$ 中，执行以下步骤：\n1.  通过对各自的基因型数量求和，计算成年雌性 $N_f(t)$ 和雄性 $N_m(t)$ 的总种群数量。\n2.  进行灭绝检查。如果 $N_f(t)   \\varepsilon$ 或 $N_m(t)   \\varepsilon$（其中 $\\varepsilon = 10^{-12}$），则认为种群已灭绝，模拟终止，并返回 `False`（非持续生存）的判定结果。\n3.  计算受精雌性的比例 $\\phi_t$，其中考虑了交配限制：\n    $$\\phi_t = \\min\\left\\{1,\\; c \\, \\dfrac{N_m(t)}{N_f(t)}\\right\\}$$\n    其中需要注意处理 $N_f(t)=0$ 的情况，此时 $\\phi_t=0$。\n4.  产生的合子总数 $E_t$ 为 $E_t = b \\, \\phi_t \\, N_f(t)$。\n5.  计算两性的基因型频率。对于 $N_f(t)  0$ 的情况，$f_{DD}(t) = F_{DD}(t)/N_f(t)$，以此类推。如果总数为零，则相应的频率取为零。\n6.  根据这些频率以及孟德尔分离定律（在雌性和 $XY$ 雄性中）和减数分裂驱动规则（在具有偏向 $d$ 的 $X^D Y$ 雄性中），计算来自雌性的 $X^D$ 和 $X$ 配子频率（$p^{(m)}_{X^D}(t)$、$p^{(m)}_{X}(t)$）以及来自雄性的 $X^D$、$X$ 和 $Y$ 配子频率（$p^{(f)}_{X^D}(t)$、$p^{(f)}_{X}(t)$、$p^{(f)}_{Y}(t)$）。\n7.  通过将合子总数 $E_t$ 乘以适当的配子频率乘积，计算每种基因型合子的预期数量（$E_{DD}$、$E_{DN}$、$E_{NN}$、$E_{M_D}$、$E_{M_N}$）。\n8.  通过 Beverton–Holt 缩放因子 $s_t = (1 + \\alpha (N_f(t) + N_m(t)))^{-1}$ 应用密度依赖性存活。\n9.  下一代（$t+1$）的成年个体数量通过将预期的合子数量乘以存活因子 $s_t$ 得到。例如，$F_{DD}(t+1) = s_t E_{DD}(t)$。\n\n在迭代 $T$ 代且未触发灭绝条件后，模拟将检查持续生存。如果最终总种群数量 $N_f(T) + N_m(T) \\ge \\eta$（其中 $\\eta=1.0$），则认为种群持续生存。在这种情况下，`check_persistence` 函数返回 `True`。\n\n为了找到最低繁殖力 $b^\\star$，为每个测试用例实现了一个数值搜索程序。该程序假设持续生存是 $b$ 的单调递增函数，这是一个生物学上合理的假设。搜索包括两个阶段：\n1.  **区间限定**：必须找到一个区间 $[b_{\\text{lo}}, b_{\\text{hi}}]$，使得 `check_persistence` 对 $b_{\\text{lo}}$ 返回 `False`，对 $b_{\\text{hi}}$ 返回 `True`。搜索从 $b_{\\text{lo}}=0$ 和 $b_{\\text{hi}}=1$ 开始。如果在 $b_{\\text{hi}}$ 处未能实现持续生存，则指数级增加此上界（例如，$b_{\\text{hi}} \\leftarrow 2 \\cdot b_{\\text{hi}}$），同时 $b_{\\text{lo}}$ 跟踪旧的 $b_{\\text{hi}}$，直到观察到持续生存。处理了一种特殊情况，即即使对于 $b=B_{\\max}=10^3$，也未能实现持续生存，此时返回 $B_{\\max}$ 作为结果。\n2.  **二分搜索（对分法）**：一旦建立了有效的区间 $[b_{\\text{lo}}, b_{\\text{hi}}]$，就反复对该区间进行对分。测试中点 $b_{\\text{mid}} = (b_{\\text{lo}} + b_{\\text{hi}})/2$。如果它导致持续生存，则新区间变为 $[b_{\\text{lo}}, b_{\\text{mid}}]$；否则，新区间变为 $[b_{\\text{mid}}, b_{\\text{hi}}]$。此过程持续进行，直到区间宽度 $b_{\\text{hi}} - b_{\\text{lo}}$ 小于指定的容差 $\\delta = 10^{-6}$。$b^\\star$ 的最终估计值是最终区间的中点。\n\n整个算法在 Python 中实现，并遵守指定的环境。对四个测试用例中的每一个重复此过程，收集得到的 $b^\\star$ 值，将其格式化为六位小数，并以所需的列表格式打印。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef check_persistence(b, params):\n    \"\"\"\n    Simulates the population dynamics for a given fecundity b and parameters.\n    Returns True for persistence, False for extinction.\n    \"\"\"\n    c, alpha, d, q0, Nf0, Nm0, T = params\n    epsilon = 1e-12\n    eta = 1.0\n\n    # Initial genotype counts at t=0\n    F_DD = 0.0\n    F_DN = 0.0\n    F_NN = float(Nf0)\n    M_D = q0 * float(Nm0)\n    M_N = (1.0 - q0) * float(Nm0)\n\n    for t in range(T):\n        Nf_t = F_DD + F_DN + F_NN\n        Nm_t = M_D + M_N\n\n        if Nf_t  epsilon or Nm_t  epsilon:\n            return False\n\n        # Fraction of females fertilized\n        if Nf_t > 0:\n            phi_t = min(1.0, c * Nm_t / Nf_t)\n        else: # Should not happen due to check above, but for robustness\n            phi_t = 0.0\n\n        # Total zygotes\n        E_t = b * phi_t * Nf_t\n\n        # Genotype frequencies\n        f_DD = F_DD / Nf_t\n        f_DN = F_DN / Nf_t\n        f_NN = F_NN / Nf_t\n        \n        if Nm_t > 0:\n            m_D = M_D / Nm_t\n            m_N = M_N / Nm_t\n        else: # Should not happen due to check above\n            m_D, m_N = 0.0, 0.0\n\n        # Gamete probabilities\n        # (m) from mothers (eggs)\n        p_m_XD = f_DD + 0.5 * f_DN\n        p_m_X = f_NN + 0.5 * f_DN # or 1.0 - p_m_XD\n        \n        # (f) from fathers (sperm)\n        p_f_XD = m_D * d\n        p_f_X = m_N * 0.5\n        p_f_Y = m_D * (1.0 - d) + m_N * 0.5 # or 1.0 - (p_f_XD + p_f_X)\n\n        # Expected zygote counts\n        E_DD = E_t * p_f_XD * p_m_XD\n        E_DN = E_t * (p_f_XD * p_m_X + p_f_X * p_m_XD)\n        E_NN = E_t * p_f_X * p_m_X\n        E_M_D = E_t * p_f_Y * p_m_XD\n        E_M_N = E_t * p_f_Y * p_m_X\n\n        # Beverton-Holt density dependence\n        s_t = 1.0 / (1.0 + alpha * (Nf_t + Nm_t))\n\n        # Update adult counts for t+1\n        F_DD = s_t * E_DD\n        F_DN = s_t * E_DN\n        F_NN = s_t * E_NN\n        M_D = s_t * E_M_D\n        M_N = s_t * E_M_N\n\n    # Final check at horizon T\n    Nf_T = F_DD + F_DN + F_NN\n    Nm_T = M_D + M_N\n    \n    return (Nf_T + Nm_T) >= eta\n\ndef find_b_star(params):\n    \"\"\"\n    Finds the minimal fecundity b* for persistence using binary search.\n    \"\"\"\n    B_max = 1000.0\n    delta = 1e-6\n\n    # Check persistence at B_max. If it fails, the answer is B_max.\n    if not check_persistence(B_max, params):\n        return B_max\n\n    # Find a bracket [b_lo, b_hi] where b_lo fails and b_hi succeeds.\n    b_lo, b_hi = 0.0, 1.0\n    \n    # Exponentially increase b_hi until persistence is found.\n    # This loop will terminate because we know B_max persists.\n    while not check_persistence(b_hi, params):\n        b_lo = b_hi\n        b_hi = min(b_hi * 2.0, B_max) # Ensure we don't overshoot B_max\n\n    # Binary search for b* within the bracket [b_lo, b_hi]\n    while (b_hi - b_lo) > delta:\n        b_mid = b_lo + (b_hi - b_lo) / 2.0\n        if check_persistence(b_mid, params):\n            b_hi = b_mid\n        else:\n            b_lo = b_mid\n            \n    return (b_lo + b_hi) / 2.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (c, alpha, d, q0, Nf0, Nm0, T)\n    test_cases = [\n        (2.0, 0.01, 0.95, 0.2, 500, 500, 200),  # Case A\n        (0.5, 0.01, 0.95, 0.2, 500, 500, 200),  # Case B\n        (2.0, 0.05, 0.95, 0.2, 500, 500, 200),  # Case C\n        (2.0, 0.01, 0.6, 0.2, 500, 500, 200),   # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        b_star = find_b_star(case)\n        results.append(b_star)\n\n    # Format results to 6 decimal places and print\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2849925"}]}