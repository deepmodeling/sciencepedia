{"hands_on_practices": [{"introduction": "基因组组装的成功与否始于原始测序数据的质量。本练习将带你深入了解FASTQ格式中编码的Phred质量分数，这是评估碱基调用准确性的行业标准。通过将这些分数与其对应的错误概率联系起来，你将学会量化测序读段的可靠性，这是任何基因组分析流程中至关重要的第一步 [@problem_id:1493811]。", "problem": "在生物信息学中，FASTQ格式是一种标准的基于文本的格式，用于存储生物序列及其对应的质量分数。FASTQ文件中的每个条目由四行组成：一个序列标识符、原始序列数据、一个分隔行（通常只是一个`+`）以及一个质量分数字符串。\n\n质量分数使用Phred质量分数系统进行编码。Phred质量分数$Q$是一个整数值，与对应碱基检出错误的概率$P$相关。该关系由公式$P = 10^{-Q/10}$给出。\n\n这些整数分数随后被表示为美国信息交换标准代码 (ASCII) 字符以节省空间。对于本题，假设使用广泛应用的Phred+33编码，其中整数Phred分数$Q$是通过获取ASCII字符的十进制（序数）值再减去33得到的。\n\n您正在分析一个来自靶向测序实验的单个短DNA测序读段。相关数据如下：\n- 序列：`GATTACA`\n- 质量字符串：`!7>B'?)`\n\n计算该整个读段中错误碱基检出的期望数量。将您的答案表示为单个实数，并四舍五入到三位有效数字。", "solution": "一个读段中错误碱基检出的期望数量是每个碱基错误概率的总和。对于Phred分数，单个碱基的错误概率由$P = 10^{-Q/10}$给出。在Phred+33编码下，质量字符$c$的整数Phred分数$Q = \\mathrm{ord}(c) - 33$，其中$\\mathrm{ord}(c)$是$c$的ASCII十进制代码。\n\n对于质量字符串`!7>B'?)`, 其ASCII代码和对应的$Q$值如下：\n- `!`: $\\mathrm{ord} = 33 \\Rightarrow Q = 33 - 33 = 0$。\n- `7`: $\\mathrm{ord} = 55 \\Rightarrow Q = 55 - 33 = 22$。\n- `>`: $\\mathrm{ord} = 62 \\Rightarrow Q = 62 - 33 = 29$。\n- `B`: $\\mathrm{ord} = 66 \\Rightarrow Q = 66 - 33 = 33$。\n- `'`: $\\mathrm{ord} = 39 \\Rightarrow Q = 39 - 33 = 6$。\n- `?`: $\\mathrm{ord} = 63 \\Rightarrow Q = 63 - 33 = 30$。\n- `)`: $\\mathrm{ord} = 41 \\Rightarrow Q = 41 - 33 = 8$。\n\n因此，Phred分数向量为$(0, 22, 29, 33, 6, 30, 8)$。错误碱基的期望数量是\n$$\nE \\;=\\; \\sum_{i=1}^{7} 10^{-Q_{i}/10}\n\\;=\\; 10^{-0/10} + 10^{-22/10} + 10^{-29/10} + 10^{-33/10} + 10^{-6/10} + 10^{-30/10} + 10^{-8/10}.\n$$\n在有帮助的情况下，将指数写成约分分数形式，得到\n$$\nE \\;=\\; 10^{0} + 10^{-11/5} + 10^{-29/10} + 10^{-33/10} + 10^{-3/5} + 10^{-3} + 10^{-4/5}.\n$$\n数值上，\n$$\n10^{0} = 1,\\quad\n10^{-11/5} \\approx 0.006309573445,\\quad\n10^{-29/10} \\approx 0.001258925412,\\quad\n10^{-33/10} \\approx 0.0005011872336,\n$$\n$$\n10^{-3/5} \\approx 0.2511886432,\\quad\n10^{-3} = 0.001,\\quad\n10^{-4/5} \\approx 0.1584893192.\n$$\n求和，\n$$\nE \\approx 1 + 0.006309573445 + 0.001258925412 + 0.0005011872336 + 0.2511886432 + 0.001 + 0.1584893192 \\approx 1.4187476484906.\n$$\n四舍五入到三位有效数字，结果为$1.42$。", "answer": "$$\\boxed{1.42}$$", "id": "1493811"}, {"introduction": "现代基因组组装严重依赖于德布鲁因图（De Bruijn graph）来处理海量的短读段。基因组中的重复序列和杂合性等复杂特征会在图中产生模糊路径，给组装带来挑战。本练习通过一个杂合位点（SNP）的具体案例，让你亲手构建德布鲁因图并计算其节点和边的数量，从而直观地理解基因组变异是如何导致组装歧义的 [@problem_id:1493761]。", "problem": "一位遗传学家正在分析一种新发现的二倍体植物物种中的一个特定基因。通过测序，他们确定所研究的植物个体对于该基因为杂合子。该植物中存在的两个等位基因由以下短DNA序列表示：\n\n等位基因 1：`5'-GTACATTGAGGCT-3'`\n等位基因 2：`5'-GTACATCGAGGCT-3'`\n\n为了从短读长测序数据中组装该基因，一位生物信息学家将所有读长（来自两个等位基因）汇集起来，并构建一个德布鲁因图（De Bruijn graph）。为组装选择的k-mer大小为 `k=5`。该图的构建方式是，来自序列组合集合中的每个独特的k-mer对应一条有向边，每个独特的(k-1)-mer序列形成一个节点。对应于一个k-mer的边连接代表其前 `k-1` 个碱基的节点和代表其后 `k-1` 个碱基的节点。\n\n计算最终生成的德布鲁因图中将存在的独特节点总数和独特边总数。\n\n请将您的答案表示为一个2元行矩阵 `(节点数, 边数)`。", "solution": "设等位基因序列的长度为 $L=13$，选择的 $k$-mer 大小为 $k=5$。在德布鲁因图中，每个独特的 $k$-mer 是一条有向边，每个独特的 $(k-1)$-mer 是一个节点。\n\n对于每个等位基因， $k$-mer 的数量为 $L-k+1=13-5+1=9$。两个等位基因在位置 $7$（从1开始计数）处相差一个单核苷酸（SNP）。一个 $5$-mer 窗口 $i,\\dots,i+4$ 包含位置 $7$ 当且仅当 $i\\in\\{3,4,5,6,7\\}$，这有 $5$ 个窗口。因此，在每个等位基因的 $9$ 个 $5$-mer 中，有 $5$ 个在两个等位基因之间是不同的，剩下的 $9-5=4$ 个是相同的。因此，汇集数据中独特边（独特的 $5$-mer）的数量是\n$$\n|E|=\\bigl|K_{1}\\cup K_{2}\\bigr|=|K_{1}|+|K_{2}|-\\bigl|K_{1}\\cap K_{2}\\bigr|=9+9-4=14.\n$$\n\n节点对应于独特的 $(k-1)$-mer，其中 $k-1=4$。对于每个等位基因， $4$-mer 的数量为 $L-(k-1)+1=13-4+1=10$。一个 $4$-mer 窗口 $i,\\dots,i+3$ 包含位置 $7$ 当且仅当 $i\\in\\{4,5,6,7\\}$，这有 $4$ 个窗口。因此，在每个等位基因的 $10$ 个 $4$-mer 中，有 $4$ 个在两个等位基因之间是不同的，剩下的 $10-4=6$ 个是相同的。因此，独特节点（独特的 $4$-mer）的数量是\n$$\n|V|=\\bigl|N_{1}\\cup N_{2}\\bigr|=|N_{1}|+|N_{2}|-\\bigl|N_{1}\\cap N_{2}\\bigr|=10+10-6=14.\n$$\n\n因此，德布鲁因图有 $14$ 个独特节点和 $14$ 条独特边。作为检验，从等位基因序列中进行显式枚举，确认有 $14$ 个不同的 $5$-mer 和 $14$ 个不同的 $4$-mer。", "answer": "$$\\boxed{\\begin{pmatrix}14  14\\end{pmatrix}}$$", "id": "1493761"}, {"introduction": "基因注释的最终目标是精确地识别出基因组上的功能元件，但这远非简单的开放阅读框扫描。本高级练习模拟了真实世界的基因注释流程，你需要设计一个动态规划算法来整合来自RNA-seq、从头转录本和蛋白质同源比对等多种来源的证据。通过为不同证据赋予权重并解决冲突，你将构建出最佳的基因模型，这正是尖端基因注释软件的核心逻辑 [@problem_id:2818203]。", "problem": "给定一个简化的基因组基因座模型，您必须通过结合来自核糖核酸测序（RNA-seq）、从头转录本重建和蛋白质同源性比对的证据，将候选外显子和候选内含子整合为每个基因座的单个最高置信度的基因模型（一个转录本）。整合过程必须通过一个有原则的证据加权方案和一个冲突解决策略来执行，该策略能产生一个由允许的内含子连接的、受最大支持的、不重叠的、有序的外显子链。此设定抽象了标准的注释实践：外显子是基因组区间，内含子连接一个外显子的末端到下游一个外显子的起始端，而证据来源提供量化支持。目标是编码并执行一个确定性算法，该算法能在定义的评分方案下构建最优转录本，并符合生物学第一原理。\n\n基本原理和生物学基础：分子生物学中心法则断言，脱氧核糖核酸（DNA）转录为信使核糖核酸（mRNA），后者再翻译成蛋白质。因此，在稳态细胞环境中，外显子上存在RNA-seq覆盖度、支持内含子的剪接连接读数、以及预测编码区与已知蛋白质的同源性，都为基因模型的存在提供了汇聚证据。您的证据整合方案必须遵循以下五个公理：\n$1.$ 独立特征的证据可加性（外显子和内含子的贡献相加形成转录本分数）。\n$2.$ 在每个证据维度上的单调性（更多的支持永远不会降低置信度）。\n$3.$ 原始覆盖度计数的收益递减（使用一个凹增函数转换原始覆盖度）。\n$4. $ 赋予蛋白质同源性比RNA覆盖度或从头转录本计数更高的可靠性，这反映了编码序列的保守性是真实基因的强有力指标。\n$5.$ 冲突必须通过选择一个不重叠、按坐标排序、且只使用允许的内含子的外显子链来解决；在得分并列的解决方案中，选择外显子标识符序列字典序最小的那个。\n\n您的程序必须实现以下精确的评分和选择规则以确保可测试性：\n- 设每个候选外显子$e_i$的坐标为$[a_i,b_i]$，位于单条正链基因座上，其特征为：RNA-seq平均覆盖度$c_i \\ge 0$，从头转录本支持计数$t_i \\in \\{0,1,2,\\dots\\}$，以及蛋白质同源性分数$p_i \\ge 0$。定义外显子贡献为\n$$\nS_{\\text{exon}}(e_i) \\;=\\; w_r \\cdot \\log_2(1 + c_i) \\;+\\; w_t \\cdot t_i \\;+\\; w_p \\cdot p_i.\n$$\n- 设每个允许的内含子$j_{u \\to v}$连接外显子$e_u$到外显子$e_v$，其中$b_u  a_v$。每个内含子具有以下特征：连接读数计数$r_{uv} \\ge 0$，从头桥接计数$d_{uv} \\ge 0$，以及同源性间隙支持$h_{uv} \\ge 0$。定义内含子贡献，并对完全没有支持的内含子施加惩罚：\n$$\nS_{\\text{intron}}(j_{u \\to v}) \\;=\\; u_r \\cdot \\log_2(1 + r_{uv}) \\;+\\; u_t \\cdot d_{uv} \\;+\\; u_p \\cdot h_{uv} \\;-\\; \\lambda \\cdot \\mathbf{1}\\{r_{uv} = 0 \\wedge d_{uv} = 0 \\wedge h_{uv} = 0\\}.\n$$\n- 转录本是一个由不同外显子组成的有序序列$(e_{i_1}, e_{i_2}, \\dots, e_{i_m})$，其坐标严格递增且无重叠，其中每个相邻外显子通过一个允许的内含子$j_{i_k \\to i_{k+1}}$实现连接。其分数为\n$$\nS_{\\text{tx}} \\;=\\; \\sum_{k=1}^{m} S_{\\text{exon}}(e_{i_k}) \\;+\\; \\sum_{k=1}^{m-1} S_{\\text{intron}}(j_{i_k \\to i_{k+1}}).\n$$\n- 冲突解决：选择$S_{\\text{tx}}$最大的转录本。如果多个转录本获得完全相同的最高分，则选择其外显子标识符序列作为整数列表时字典序最小的那个。\n\n对所有基因座使用以下固定权重和惩罚值：$w_r = 1.0$，$w_t = 0.5$，$w_p = 2.0$，$u_r = 1.5$，$u_t = 0.5$，$u_p = 2.0$，以及$\\lambda = 3.0$。所有对数均以$2$为底。\n\n输入模型和测试套件：没有外部输入；您的程序必须嵌入并解决以下基因座，每个基因座由一组外显子和一组内含子定义。所有坐标都在一个概念上的单个重叠群（contig）的正链上，仅用于定义排序和不重叠约束。外显子标识符是每个基因座局部的正整数。\n\n- 基因座 1：\n  - 外显子：\n    - $e_1$：$[100,200]$，$c_1=20.0$，$t_1=1$，$p_1=5.0$。\n    - $e_2$：$[300,400]$，$c_2=25.0$，$t_2=1$，$p_2=6.0$。\n    - $e_3$：$[500,650]$，$c_3=30.0$，$t_3=1$，$p_3=7.0$。\n    - $e_4$：$[300,350]$，$c_4=10.0$，$t_4=1$，$p_4=1.0$（$e_2$的替代选项）。\n  - 内含子：\n    - $j_{1 \\to 2}$：$r_{12}=50$，$d_{12}=1$，$h_{12}=5.0$。\n    - $j_{1 \\to 4}$：$r_{14}=5$，$d_{14}=1$，$h_{14}=1.0$。\n    - $j_{2 \\to 3}$：$r_{23}=45$，$d_{23}=1$，$h_{23}=6.0$。\n    - $j_{4 \\to 3}$：$r_{43}=10$，$d_{43}=1$，$h_{43}=1.0$。\n\n- 基因座 2：\n  - 外显子：\n    - $e_1$：$[100,220]$，$c_1=1.0$，$t_1=0$，$p_1=20.0$。\n    - $e_2$：$[800,900]$，$c_2=0.5$，$t_2=0$，$p_2=18.0$。\n    - $e_3$：$[100,150]$，$c_3=10.0$，$t_3=0$，$p_3=0.0$（靠近起始位置的一个短替代选项）。\n  - 内含子：\n    - $j_{1 \\to 2}$：$r_{12}=0$，$d_{12}=0$，$h_{12}=15.0$。\n\n- 基因座 3：\n  - 外显子：\n    - $e_1$：$[100,180]$，$c_1=8.0$，$t_1=0$，$p_1=0.0$。\n    - $e_2$：$[120,200]$，$c_2=2.0$，$t_2=2$，$p_2=0.0$（与$e_1$重叠；不能共存）。\n  - 内含子：无。\n\n- 基因座 4：\n  - 外显子：\n    - $e_1$：$[100,150]$，$c_1=5.0$，$t_1=1$，$p_1=0.0$。\n    - $e_2$：$[300,350]$，$c_2=5.0$，$t_2=1$，$p_2=0.0$。\n  - 内含子：无。\n\n计算要求：\n- 将基因座建模为一个有向无环图（DAG），其中节点是外显子，有向边是允许的内含子。一个转录本是此DAG中的一条路径，可以从任何外显子开始，到任何外显子结束，且外显子不重叠。如果一个基因座没有给定内含子，则有效的转录本简化为单个外显子的选择。\n- 您的程序必须通过在DAG上进行动态规划来计算每个基因座的最优转录本：对于每个外显子，计算以该外显子结尾的最佳可达转录本分数，考虑所有入边，并可以选择从该外显子开始。这必须遵守由内含子定义和坐标排序$b_u  a_v$隐式强制执行的不重叠约束。\n- 平局打破规则：如果两个转录本的总分完全相等，选择外显子标识符序列字典序最小的那个（作为整数列表比较）。\n- 数值稳定性：精确地实现 $\\log_2(1+x)$。无需报告物理单位。\n\n最终输出规范：\n- 您的程序应生成单行输出，包含结果，格式为一个由方括号括起来的、逗号分隔的列表的列表，其中第 $k$ 个条目是为基因座 $k$ 选择的转录本的外显子标识符序列，表示为一个整数列表。输出中不得出现空格。对于上述四个基因座，输出必须采用以下形式\n$[\\,[\\dots],\\,[\\dots],\\,[\\dots],\\,[\\dots]\\,]$\n内部是精确的整数标识符。例如，\n$[[1,2,3],[1,2],[1],[1]]$\n是有效的格式。", "solution": "所呈现的问题是一个基于计算基因组学的约束优化问题，具体来说，是从多个冲突或佐证的证据源中合成单个最优基因模型。该问题在科学上是有效的、良定的，并且为确定性解提供了所有必要的参数和约束。我们将着手进行形式化求解。\n\n核心任务是识别单个转录本，定义为一个由指定内含子连接的、不重叠的、按坐标排序的外显子序列，该序列最大化给定的评分函数。这可以建模为在有向无环图（DAG）中寻找得分最高的路径。\n\n首先，让我们为给定的基因座形式化图结构。候选外显子$\\{e_i\\}$作为我们图的顶点。当且仅当输入中指定了一个“允许的内含子”$j_{u \\to v}$时，从外显子$e_u$到$e_v$存在一条有向边。问题指出，一个内含子$j_{u \\to v}$意味着坐标满足$b_u  a_v$，其中$[a_u, b_u]$是外显子$e_u$的坐标。这个条件确保了任何由边连接的两个外显子都是不重叠的，并且处于正确的基因组顺序中。根据传递性，任何在此图中形成路径的外显子序列都将由坐标严格递增的互不重叠的外显子组成。因此，一个有效的转录本精确地对应于此DAG中的一条路径。一个转录本也可以由单个外显子组成，这对应于长度为零的路径（单个顶点）。\n\n目标是找到总分最高的路径（转录本）。一个转录本$(e_{i_1}, e_{i_2}, \\dots, e_{i_m})$的分数定义为其组成外显子和内含子分数的总和：\n$$\nS_{\\text{tx}} \\;=\\; \\sum_{k=1}^{m} S_{\\text{exon}}(e_{i_k}) \\;+\\; \\sum_{k=1}^{m-1} S_{\\text{intron}}(j_{i_k \\to i_{k+1}})\n$$\n这种结构——在DAG中寻找最大权重路径——是一个经典问题，可以使用动态规划有效解决。\n\n对于每个基因座，算法按以下步骤进行：\n\n$1.$ **初始化**：必须首先根据基因组坐标对外显子集合进行排序，为DP算法建立拓扑排序。我们主要按起始坐标（$a_i$）排序外显子，其次按结束坐标（$b_i$）作为平局打破规则。设排序后的外显子序列为$(E_1, E_2, \\dots, E_N)$。\n\n$2.$ **动态规划**：我们将为每个外显子$E_i$计算以该外显子结尾的最优转录本的分数和结构。设$DP[i]$为一个对$(\\text{score}_i, \\text{path}_i)$，其中$\\text{score}_i$是以$E_i$结尾的转录本的最大分数，$\\text{path}_i$是对应的外显子标识符序列。\n\n递推关系通过考虑外显子$E_i$的所有可能前驱来导出。一个以$E_i$结尾的转录本可以从$E_i$开始，也可以是以前一个由内含子$j_{j \\to i}$连接的外显子$E_j$（其中$j  i$）结尾的转录本的延伸。\n\n对于排序列表中的每个外显子$E_i$（从$i=1$到$N$）：\n- 来自外显子本身的贡献分数为$S_{\\text{exon}}(E_i)$。\n- 我们寻找最佳的前驱转录本进行延伸。我们遍历所有前面的外显子$E_j$（其中$j  i$）。如果存在从$E_j$到$E_i$的内含子，我们计算延伸路径的潜在分数：$\\text{score}_j + S_{\\text{intron}}(j_{j \\to i})$。\n- 我们选择使该值最大化的前驱$E_j$。设此最大值为$S_{\\text{max\\_prev}}$。如果不存在有效的前驱，则$S_{\\text{max\\_prev}} = 0$。\n- 以$E_i$结尾的最优转录本的分数则为$\\text{score}_i = S_{\\text{max\\_prev}} + S_{\\text{exon}}(E_i)$。如果我们从一个以$E_j$结尾的最优路径延伸，新路径为$\\text{path}_i = \\text{path}_j \\oplus [id_i]$，其中$\\oplus$表示拼接，而$id_i$是外显子$E_i$的标识符。如果没有前驱，路径就是$[id_i]$。\n- 为确保唯一解，问题规定了一个平局打破规则。如果多个前驱路径导致相同的总分，我们没有被指示如何在此中间阶段打破平局。一个稳健的方法是选择其路径字典序最小的那个。然而，问题指出平局打破规则是针对最终的最大分数。为简单起见并根据提示确保正确性，我们的DP将找到最佳分数，如果多条通往一个外显子的路径给出相同的分数，可以选择任何一条。最终选择步骤将解决已完成转录本之间的任何平局。\n\n递归的基例是从一个外显子$E_i$开始的转录本，其分数为$S_{\\text{exon}}(E_i)$，路径为$[id_i]$。我们的公式通过初始化对前驱的搜索（分数为0，路径为空）来包含这一点。\n\n$3.$ **最终选择**：在为所有$i=1, \\dots, N$计算完$DP[i]$后，该基因座的最优转录本不一定是以$E_N$结尾的那个。它可能是任何一个计算出的以任何$E_i$结尾的最优路径。因此，我们必须在所有计算出的$\\text{score}_i$中找到全局最大分数。\n- 设$S_{\\text{max}} = \\max_{i=1 \\dots N} \\{\\text{score}_i\\}$。\n- 识别所有分数等于$S_{\\text{max}}$的转录本集合$\\{ \\text{path}_k \\}$。\n- 根据平局打破规则，我们从此集合中选择外显子标识符序列字典序最小的那个转录本。\n\n让我们将此应用于基因座1。\n固定权重为：$w_r = 1.0$，$w_t = 0.5$，$w_p = 2.0$，$u_r = 1.5$，$u_t = 0.5$，$u_p = 2.0$，$\\lambda = 3.0$。\n\n- **外显子分数 ($S_{\\text{exon}}$)**：\n  - $S(e_1) = \\log_2(1+20) + 0.5 \\cdot 1 + 2 \\cdot 5 = 4.392 + 0.5 + 10 = 14.892$\n  - $S(e_2) = \\log_2(1+25) + 0.5 \\cdot 1 + 2 \\cdot 6 = 4.700 + 0.5 + 12 = 17.200$\n  - $S(e_3) = \\log_2(1+30) + 0.5 \\cdot 1 + 2 \\cdot 7 = 4.954 + 0.5 + 14 = 19.454$\n  - $S(e_4) = \\log_2(1+10) + 0.5 \\cdot 1 + 2 \\cdot 1 = 3.459 + 0.5 + 2 = 5.959$\n\n- **内含子分数 ($S_{\\text{intron}}$)**：\n  - $S(j_{1\\to2}) = 1.5\\log_2(1+50) + 0.5 \\cdot 1 + 2 \\cdot 5 = 1.5 \\cdot 5.672 + 0.5 + 10 = 19.008$\n  - $S(j_{1\\to4}) = 1.5\\log_2(1+5) + 0.5 \\cdot 1 + 2 \\cdot 1 = 1.5 \\cdot 2.585 + 0.5 + 2 = 6.377$\n  - $S(j_{2\\to3}) = 1.5\\log_2(1+45) + 0.5 \\cdot 1 + 2 \\cdot 6 = 1.5 \\cdot 5.524 + 0.5 + 12 = 20.786$\n  - $S(j_{4\\to3}) = 1.5\\log_2(1+10) + 0.5 \\cdot 1 + 2 \\cdot 1 = 1.5 \\cdot 3.459 + 0.5 + 2 = 7.689$\n\n- **DP执行**：按坐标排序的外显子为$(e_1, e_4, e_2, e_3)$。\n  - **$DP(e_1)$**：路径由此开始。分数 = $S(e_1) = 14.892$。路径 = $[1]$。\n  - **$DP(e_4)$**：前驱$e_1$通过$j_{1\\to4}$。路径$[1,4]$。分数 = $S(e_1) + S(j_{1\\to4}) + S(e_4) = 14.892 + 6.377 + 5.959 = 27.228$。与从$e_4$开始（分数$5.959$）相比，路径$[1,4]$更优。\n  - **$DP(e_2)$**：前驱$e_1$通过$j_{1\\to2}$。路径$[1,2]$。分数 = $S(e_1) + S(j_{1\\to2}) + S(e_2) = 14.892 + 19.008 + 17.200 = 51.100$。与从$e_2$开始（分数$17.200$）相比，路径$[1,2]$更优。\n  - **$DP(e_3)$**：两个可能的前驱，$e_2$和$e_4$。\n    - 通过$e_2$：路径$[1,2,3]$。分数 = (路径$[1,2]$的分数) $+ S(j_{2\\to3}) + S(e_3) = 51.100 + 20.786 + 19.454 = 91.340$。\n    - 通过$e_4$：路径$[1,4,3]$。分数 = (路径$[1,4]$的分数) $+ S(j_{4\\to3}) + S(e_3) = 27.228 + 7.689 + 19.454 = 54.371$。\n    - 通过$e_2$的路径更优。最终路径是$[1,2,3]$，分数为$91.340$。\n\n- **基因座1的最终选择**：比较所有计算出的最优路径分数：\n  - 路径$[1]$：$14.892$\n  - 路径$[1,4]$：$27.228$\n  - 路径$[1,2]$：$51.100$\n  - 路径$[1,2,3]$：$91.340$\n  最高分是$91.340$，唯一对应于转录本$[1,2,3]$。\n\n此过程对所有基因座重复进行。对于没有内含子的基因座，有效的转录本集合简化为单外显子模型。该算法能正确处理这种情况，因为不会有延伸步骤，最终选择将在单个外显子分数之间进行。对于基因座4，两个转录本$[1]$和$[2]$达到相同的最高分，平局打破规则选择$[1]$，因为它的字典序更小。", "answer": "[[1,2,3],[1,2],[1],[1]]", "id": "2818203"}]}