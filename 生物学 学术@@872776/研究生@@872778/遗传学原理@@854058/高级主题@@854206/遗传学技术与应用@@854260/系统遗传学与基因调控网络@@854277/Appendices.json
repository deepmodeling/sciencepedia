{"hands_on_practices": [{"introduction": "基因调控始于转录因子（TF）与DNA启动子区域之间的物理相互作用。本练习将引导你运用化学平衡的基本原理，建立一个描述启动子占据概率的定量模型。通过这个实践，你将能够理解细胞内的转录因子浓度和其结合亲和力（以解离常数$K_d$表示）是如何共同决定基因的调控状态的，这是理解基因表达调控的第一步。", "problem": "基因调控网络中的一个单基因模块受一个启动子控制，该启动子带有一个用于转录因子（TF）的典型结合位点。假设存在快速时间尺度分离，其中转录因子的结合和解离相对于转录起始处于准平衡状态，并且占据概率等于结合位点的平衡分数占据率。使用解离常数的化学定义，从第一性原理推导占据率。\n\n令 $[X]$ 表示物质 $X$ 的摩尔浓度，其中 $X \\in \\{\\mathrm{TF}, P, \\mathrm{TF}\\!\\cdot\\!P\\}$。假设一个简单的 $1{:}1$ 结合模型，其反应为 $\\mathrm{TF} + P \\rightleftharpoons \\mathrm{TF}\\!\\cdot\\!P$，解离常数 $K_d$ 定义为 $K_d = \\dfrac{[\\mathrm{TF}][P]}{[\\mathrm{TF}\\!\\cdot\\!P]}$。分数占据率（启动子被结合的概率）定义为 $P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[P] + [\\mathrm{TF}\\!\\cdot\\!P]}$。假设总启动子浓度相对于核内转录因子浓度非常小，因此 $[\\mathrm{TF}]$ 实际上就是游离的核内浓度。\n\n在 $1{:}1$ 结合模型下，从 $K_d$ 的定义和启动子的守恒关系出发，推导出用 $K_d$ 和 $[\\mathrm{TF}]$ 表示 $P_{\\mathrm{bound}}$ 的表达式，并对 $K_d = 20\\,\\mathrm{nM}$ 和 $[\\mathrm{TF}] = 30\\,\\mathrm{nM}$ 进行数值计算。将最终概率表示为精确分数。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 该系统是一个单基因模块，其启动子带有一个用于转录因子（TF）的结合位点。\n- 假设结合反应处于准平衡状态：$\\mathrm{TF} + P \\rightleftharpoons \\mathrm{TF}\\!\\cdot\\!P$。\n- 占据概率 $P_{\\mathrm{bound}}$ 等于结合位点的平衡分数占据率。\n- 解离常数定义为 $K_d = \\dfrac{[\\mathrm{TF}][P]}{[\\mathrm{TF}\\!\\cdot\\!P]}$。\n- 分数占据率定义为 $P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[P] + [\\mathrm{TF}\\!\\cdot\\!P]}$。分母 $[P] + [\\mathrm{TF}\\!\\cdot\\!P]$ 代表总启动子浓度 $[P]_{\\mathrm{total}}$。\n- 做出一个近似：总启动子浓度与总转录因子浓度相比可以忽略不计，因此游离转录因子浓度 $[\\mathrm{TF}]$ 实际上是恒定的，等于总核内TF浓度。\n- 任务是推导出 $P_{\\mathrm{bound}}$ 作为 $K_d$ 和 $[\\mathrm{TF}]$ 的函数的表达式。\n- 提供了用于计算的数值：$K_d = 20\\,\\mathrm{nM}$ 和 $[\\mathrm{TF}] = 30\\,\\mathrm{nM}$。\n- 最终的数值答案必须是精确分数。\n\n**步骤2：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据**：该问题在化学动力学和分子生物学原理方面有充分的依据。所描述的模型是转录因子-启动子结合的一个标准简化表示，通常称为单一位点的希尔-朗缪尔等温线。准平衡和TF耗尽可忽略的假设在此背景下是常见且有效的近似。\n- **适定性**：该问题是适定的。它提供了清晰的定义、充足的数据和一个具体的目标。可以确定一个唯一且有意义的解。\n- **客观性**：问题陈述使用了客观、精确的科学语言。\n\n该问题没有科学上的不健全、模糊性和内部矛盾。所有已知条件都是一致的，足以推导出解。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n推导从提供的第一性原理开始：解离常数 $K_d$ 的定义和分数占据率 $P_{\\mathrm{bound}}$ 的定义。目标是用 $[\\mathrm{TF}]$ 和 $K_d$ 表示 $P_{\\mathrm{bound}}$。\n\n解离常数由下式给出：\n$$K_d = \\dfrac{[\\mathrm{TF}][P]}{[\\mathrm{TF}\\!\\cdot\\!P]}$$\n此处，$[P]$ 是游离（未结合）启动子的浓度，$[\\mathrm{TF}\\!\\cdot\\!P]$ 是结合复合物的浓度。我们可以重排此方程，用结合复合物和其他参数表示游离启动子的浓度：\n$$[P] = K_d \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[\\mathrm{TF}]}$$\n\n分数占据率，代表启动子被结合的概率，定义为结合的启动子浓度与总启动子浓度的比值：\n$$P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[P]_{\\mathrm{total}}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[P] + [\\mathrm{TF}\\!\\cdot\\!P]}$$\n\n现在，我们将重排后的 $K_d$ 方程中 $[P]$ 的表达式代入 $P_{\\mathrm{bound}}$ 方程的分母：\n$$P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{\\left(K_d \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[\\mathrm{TF}]}\\right) + [\\mathrm{TF}\\!\\cdot\\!P]}$$\n\n项 $[\\mathrm{TF}\\!\\cdot\\!P]$ 出现在分子以及分母的两项中。假设转录因子浓度不为零，这意味着存在非零的结合可能性，则 $[\\mathrm{TF}\\!\\cdot\\!P]$ 不为零，可以从分母中提出并消去：\n$$P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}\\!\\cdot\\!P]}{[\\mathrm{TF}\\!\\cdot\\!P] \\left(\\dfrac{K_d}{[\\mathrm{TF}]} + 1\\right)} = \\dfrac{1}{\\dfrac{K_d}{[\\mathrm{TF}]} + 1}$$\n\n为简化这个繁分数，我们为分母中的项找到一个公分母：\n$$P_{\\mathrm{bound}} = \\dfrac{1}{\\dfrac{K_d + [\\mathrm{TF}]}{[\\mathrm{TF}]}}$$\n\n最后，将分母取倒数，得到用 $K_d$ 和 $[\\mathrm{TF}]$ 表示 $P_{\\mathrm{bound}}$ 的表达式：\n$$P_{\\mathrm{bound}} = \\dfrac{[\\mathrm{TF}]}{K_d + [\\mathrm{TF}]}$$\n这就是所要求的解析表达式。这是希尔系数为 $1$ 的希尔-朗缪尔方程的一个特例。\n\n现在问题要求对给定值 $K_d = 20\\,\\mathrm{nM}$ 和 $[\\mathrm{TF}] = 30\\,\\mathrm{nM}$ 进行数值计算。浓度单位（$\\mathrm{nM}$）是一致的，将会抵消，从而得到一个无量纲的概率，这与预期相符。\n$$P_{\\mathrm{bound}} = \\dfrac{30\\,\\mathrm{nM}}{20\\,\\mathrm{nM} + 30\\,\\mathrm{nM}} = \\dfrac{30}{50}$$\n\n按要求，将此结果表示为其最简形式的精确分数：\n$$P_{\\mathrm{bound}} = \\dfrac{3}{5}$$\n这意味着在给定条件下，在任何时刻，启动子的结合位点有 $60\\%$ 的概率被转录因子占据。", "answer": "$$\\boxed{\\frac{3}{5}}$$", "id": "2854817"}, {"introduction": "在理解了转录因子结合的物理化学基础后，我们需要一种方法来在广阔的基因组中识别其潜在的结合位点。本练习介绍了一种核心的生物信息学工具——位置权重矩阵（PWM），它能够捕捉转录因子对特定DNA序列的偏好。你将学会如何应用PWM来评估候选序列，从而将原始的DNA序列信息转化为一个定量的结合可能性得分。", "problem": "在一项关于转录调控的系统遗传学研究中，一个源自染色质免疫沉淀测序 (ChIP-seq) 的转录因子 (TF) 结合基序由一个位置权重矩阵 (PWM) 表示，该矩阵为每个位置提供了观察到每种核苷酸的概率。PWM 的长度为 $6$，并提供了以下位置特异性概率 $P_{i}(b)$（对于位置 $i \\in \\{1,\\dots,6\\}$ 和碱基 $b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$）：\n- 位置 $1$：$P_{1}(\\mathrm{A})=0.55$, $P_{1}(\\mathrm{C})=0.15$, $P_{1}(\\mathrm{G})=0.15$, $P_{1}(\\mathrm{T})=0.15$。\n- 位置 $2$：$P_{2}(\\mathrm{A})=0.10$, $P_{2}(\\mathrm{C})=0.60$, $P_{2}(\\mathrm{G})=0.20$, $P_{2}(\\mathrm{T})=0.10$。\n- 位置 $3$：$P_{3}(\\mathrm{A})=0.15$, $P_{3}(\\mathrm{C})=0.15$, $P_{3}(\\mathrm{G})=0.60$, $P_{3}(\\mathrm{T})=0.10$。\n- 位置 $4$：$P_{4}(\\mathrm{A})=0.05$, $P_{4}(\\mathrm{C})=0.10$, $P_{4}(\\mathrm{G})=0.15$, $P_{4}(\\mathrm{T})=0.70$。\n- 位置 $5$：$P_{5}(\\mathrm{A})=0.50$, $P_{5}(\\mathrm{C})=0.20$, $P_{5}(\\mathrm{G})=0.20$, $P_{5}(\\mathrm{T})=0.10$。\n- 位置 $6$：$P_{6}(\\mathrm{A})=0.10$, $P_{6}(\\mathrm{C})=0.55$, $P_{6}(\\mathrm{G})=0.25$, $P_{6}(\\mathrm{T})=0.10$。\n\n假设一个独立同分布的背景模型，其中 $p_{0}(\\mathrm{A})=p_{0}(\\mathrm{C})=p_{0}(\\mathrm{G})=p_{0}(\\mathrm{T})=0.25$。考虑候选结合位点序列 $\\mathrm{ACGTAC}$。\n\n使用自然对数，计算序列 $\\mathrm{ACGTAC}$ 在此 PWM 下相对于背景模型的 PWM 对数优势比（对数似然比）得分。报告一个实数值，四舍五入到四位有效数字。", "solution": "目标是计算一个长度为 $6$ 的序列在独立背景模型下的位置权重矩阵 (PWM) 对数优势比得分。计算从基因调控网络分析中使用的概率基序模型的核心定义开始。\n\n基本原理：\n1. 一个 PWM 为每个位置 $i$ 指定了在核苷酸 $b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 上的一个分类分布 $P_{i}(b)$，其中对于每个 $i$ 都有 $\\sum_{b} P_{i}(b)=1$。\n2. 在结合位点模型中跨位置的标准独立性假设下，长度为 $L$ 的序列 $s=s_{1}s_{2}\\dots s_{L}$ 在 PWM 下的似然为 $P_{\\mathrm{PWM}}(s)=\\prod_{i=1}^{L} P_{i}(s_{i})$。\n3. 在具有核苷酸频率 $p_{0}(b)$ 的独立背景模型下，相同序列的似然为 $P_{0}(s)=\\prod_{i=1}^{L} p_{0}(s_{i})$。\n4. 以自然对数单位（奈特, nats）表示的对数优势比（对数似然比）得分定义为\n$$\nS(s) \\equiv \\ln\\!\\left(\\frac{P_{\\mathrm{PWM}}(s)}{P_{0}(s)}\\right)\n= \\sum_{i=1}^{L} \\ln\\!\\left(\\frac{P_{i}(s_{i})}{p_{0}(s_{i})}\\right).\n$$\n\n将这些定义应用于给定的序列和参数。设 $L=6$ 且 $s=\\mathrm{ACGTAC}$。背景是均匀的，即 $p_{0}(\\mathrm{A})=p_{0}(\\mathrm{C})=p_{0}(\\mathrm{G})=p_{0}(\\mathrm{T})=0.25$。因此，对于每个位置 $i$，其贡献为\n$$\n\\ln\\!\\left(\\frac{P_{i}(s_{i})}{0.25}\\right) \\;=\\; \\ln\\!\\left(4\\,P_{i}(s_{i})\\right).\n$$\n\n提取每个位置的 $P_{i}(s_{i})$：\n- 位置 $1$， $s_{1}=\\mathrm{A}$： $P_{1}(\\mathrm{A})=0.55 \\;\\Rightarrow\\; \\ln(4 \\times 0.55)=\\ln(2.2)$。\n- 位置 $2$， $s_{2}=\\mathrm{C}$： $P_{2}(\\mathrm{C})=0.60 \\;\\Rightarrow\\; \\ln(4 \\times 0.60)=\\ln(2.4)$。\n- 位置 $3$， $s_{3}=\\mathrm{G}$： $P_{3}(\\mathrm{G})=0.60 \\;\\Rightarrow\\; \\ln(4 \\times 0.60)=\\ln(2.4)$。\n- 位置 $4$， $s_{4}=\\mathrm{T}$： $P_{4}(\\mathrm{T})=0.70 \\;\\Rightarrow\\; \\ln(4 \\times 0.70)=\\ln(2.8)$。\n- 位置 $5$， $s_{5}=\\mathrm{A}$： $P_{5}(\\mathrm{A})=0.50 \\;\\Rightarrow\\; \\ln(4 \\times 0.50)=\\ln(2)$。\n- 位置 $6$， $s_{6}=\\mathrm{C}$： $P_{6}(\\mathrm{C})=0.55 \\;\\Rightarrow\\; \\ln(4 \\times 0.55)=\\ln(2.2)$。\n\n将这些贡献相加：\n$$\nS(s) \\;=\\; \\ln(2.2) \\;+\\; \\ln(2.4) \\;+\\; \\ln(2.4) \\;+\\; \\ln(2.8) \\;+\\; \\ln(2) \\;+\\; \\ln(2.2).\n$$\n使用对数性质可知，这等于\n$$\nS(s) \\;=\\; \\ln\\!\\big( (2.2)^{2} \\times (2.4)^{2} \\times 2.8 \\times 2 \\big),\n$$\n但我们用自然对数进行数值计算以得到最终值：\n- $\\ln(2.2) \\approx 0.7884573603642703$,\n- $\\ln(2.4) \\approx 0.8754687373539010$,\n- $\\ln(2.8) \\approx 1.0296194171811581$,\n- $\\ln(2) \\approx 0.6931471805599453$.\n\n因此，\n$$\nS(s) \\approx 0.7884573603642703 + 0.8754687373539010 + 0.8754687373539010 + 1.0296194171811581 + 0.6931471805599453 + 0.7884573603642703,\n$$\n总和为\n$$\nS(s) \\approx 5.050618793177446.\n$$\n\n四舍五入到四位有效数字，PWM 对数优势比得分（以自然对数单位计）为 $5.051$。", "answer": "$$\\boxed{5.051}$$", "id": "2854797"}, {"introduction": "单个的调控作用可以组合成具有复杂动态行为的基因调控网络。本练习将探索一个最常见的网络基序：正向自调控环路，即一个基因激活其自身的转录。通过求解该系统的稳态并分析其稳定性，你将发现这种简单的正反馈机制如何产生例如双稳态（分子开关）等复杂现象，这对于理解细胞决策和记忆至关重要。", "problem": "基因调控网络 (GRN) 中的一个单基因正向自调控模块，可以用一个一维常微分方程 (ODE) 来建模。该方程描述了分子浓度 $x \\ge 0$ 如何在合成与一级降解之间取得平衡。合成速率由一个希尔 (Hill) 激活函数表示，该函数捕捉了协同转录因子的结合过程，而降解是线性的。其动力学由以下方程给出：\n$$\n\\frac{dx}{dt} \\;=\\; f(x) \\;=\\; \\alpha \\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\beta\\, x,\n$$\n其中 $\\alpha  0$ 是最大产生速率，$\\beta  0$ 是降解速率常数，$K  0$ 是激活解离常数，$n \\ge 1$ 是希尔 (Hill) 系数。一个不动点 $x^\\ast$ 满足 $f(x^\\ast) = 0$ 且 $x^\\ast \\ge 0$。线性稳定性由 $f'(x^\\ast)$ 的符号决定：如果 $f'(x^\\ast)  0$，则不动点是稳定的；如果 $f'(x^\\ast)  0$，则是不稳定的。如果在域 $x \\ge 0$ 中存在至少两个不同的稳定不动点，则称系统存在多个稳定状态。\n\n任务：编写一个完整的程序，对于下方测试套件中的每一组参数，计算出：\n- 非负不动点 $x^\\ast \\ge 0$ 的总数，以及\n- 是否存在多个稳定状态（即，是否存在至少两个不同的稳定不动点）。\n\n你必须纯粹从数学角度处理这个问题，仅使用上述模型。在域 $x \\in [0, X_{\\max}]$ 上使用数值求根方法，其中有限的 $X_{\\max}$ 由你根据参数系统地选择，以确保找到所有非负不动点。稳定性所需的导数可以解析计算或数值计算，但最终的分类必须正确。在整个过程中，所有计算都是无量纲的；不需要物理单位。\n\n测试套件（每种情况都是一个元组 $(\\alpha,\\beta,K,n)$，所有数字和参数定义如上）：\n- 情况 1：$(\\alpha,\\beta,K,n) = (50, 1, 5, 3)$。\n- 情况 2：$(\\alpha,\\beta,K,n) = (2, 1, 5, 1)$。\n- 情况 3：$(\\alpha,\\beta,K,n) = (10, 1, 5, 1)$。\n- 情况 4：$(\\alpha,\\beta,K,n) = (5, 1, 5, 3)$。\n- 情况 5：$(\\alpha,\\beta,K,n) = (20, 1, 3, 4)$。\n\n最终输出格式：你的程序应生成单行输出，其中包含五个测试用例的结果，形式为一个逗号分隔的列表的列表，每个内部列表包含两项：不动点数量的整数和一个指示是否存在多个稳定状态的布尔值。确切要求的格式为：\n\"[ [m1,b1], [m2,b2], [m3,b3], [m4,b4], [m5,b5] ]\"\n但其中没有任何空格，例如：\n\"[[m1,b1],[m2,b2],[m3,b3],[m4,b4],[m5,b5]]\"\n其中每个 $m_i$ 是一个整数，每个 $b_i$ 是 True 或 False。请将每个 $m_i$ 和 $b_i$ 替换为计算出的结果。", "solution": "该问题要求分析一个单基因正向自调控系统的不动点及其稳定性，该系统由以下常微分方程描述：\n$$\n\\frac{dx}{dt} \\;=\\; f(x) \\;=\\; \\alpha \\,\\frac{x^{n}}{K^{n} + x^{n}} \\;-\\; \\beta\\, x\n$$\n其中 $x \\ge 0$ 是分子浓度，参数 $\\alpha$、$\\beta$、$K$ 是正常数，希尔系数 $n \\ge 1$。\n\n不动点（或称稳态）$x^\\ast$ 是一个浓度值，在该浓度下变化率为零，即 $f(x^\\ast) = 0$。我们关心的是非负不动点，即 $x^\\ast \\ge 0$。不动点的方程为：\n$$\n\\alpha \\,\\frac{(x^\\ast)^{n}}{K^{n} + (x^\\ast)^{n}} \\;=\\; \\beta\\, x^\\ast\n$$\n一个平凡解是显而易见的：$x^\\ast_0 = 0$。对于满足给定约束的任何参数，$f(0) = 0$，所以原点总是一个不动点。\n\n为了找到非平凡不动点 ($x^\\ast  0$)，我们可以将方程两边除以 $x^\\ast$：\n$$\n\\alpha \\,\\frac{(x^\\ast)^{n-1}}{K^{n} + (x^\\ast)^{n}} \\;=\\; \\beta\n$$\n通常需要使用数值方法来求解这个关于 $x^\\ast$ 的非多项式方程。正实根的数量取决于参数。在几何上，这些根是合成速率曲线 $S(x) = \\alpha \\frac{x^n}{K^n+x^n}$ 与降解速率直线 $D(x) = \\beta x$ 的交点。\n\n不动点 $x^\\ast$ 的线性稳定性由导数 $f'(x^\\ast)$ 的符号决定。如果 $f'(x^\\ast)  0$，不动点是稳定的；如果 $f'(x^\\ast)  0$，则是不稳定的。$f(x)$ 的导数使用商法则求得：\n$$\nf'(x) = \\frac{d}{dx}f(x) = \\alpha \\frac{nK^n x^{n-1}}{(K^n + x^n)^2} - \\beta\n$$\n我们必须分析每个不动点的稳定性。\n\n首先，考虑平凡不动点 $x^\\ast_0 = 0$。其稳定性取决于 $n$ 的值。\n- 如果 $n  1$，则 $n-1  0$。在 $x=0$ 处，$x^{n-1}$ 项的值为 $0$，因此 $f'(0) = \\alpha \\cdot 0 - \\beta = -\\beta$。由于 $\\beta  0$，我们有 $f'(0)  0$。因此，对于 $n  1$，不动点 $x^\\ast_0 = 0$ 总是稳定的。\n- 如果 $n = 1$，导数为 $f'(x) = \\alpha \\frac{K}{(K+x)^2} - \\beta$。在 $x=0$ 处，这得到 $f'(0) = \\frac{\\alpha}{K} - \\beta$。当 $n=1$ 时，$x^\\ast_0 = 0$ 的稳定性取决于参数：如果 $\\frac{\\alpha}{K}  \\beta$ 则稳定，如果 $\\frac{\\alpha}{K}  \\beta$ 则不稳定。\n\n为了为每个给定的参数集找到所有非负不动点并评估其稳定性，我们采用一种数值算法。\n1. 为给定的参数 $(\\alpha, \\beta, K, n)$ 定义函数 $f(x)$ 和 $f'(x)$。\n2. 对正不动点的搜索可以限制在一个有限区间 $[0, X_{\\max}]$ 内。一个不动点 $x^\\ast$ 必须满足 $\\beta x^\\ast = \\alpha \\frac{(x^\\ast)^n}{K^n + (x^\\ast)^n}$。由于对于任何有限的 $x^\\ast$，希尔函数项都严格小于 $1$，我们必须有 $\\beta x^\\ast  \\alpha$，这意味着 $x^\\ast  \\alpha / \\beta$。因此，所有正不动点都保证位于区间 $(0, \\alpha/\\beta)$ 内。我们选择一个搜索区间 $[0, X_{\\max}]$，其中 $X_{\\max}$ 等于 $\\alpha/\\beta$。\n3. 我们系统地在区间 $(0, X_{\\max}]$ 内搜索 $f(x)$ 的根。一种稳健的方法是将区间划分为一个精细的网格，并检测相邻网格点之间 $f(x)$ 的符号变化。符号变化表示存在一个根，可以使用标准的求根算法（如 Brent 方法）精确定位该根。\n4. 所有找到的正根，连同平凡根 $x^\\ast_0=0$，构成了非负不动点的完整集合。\n5. 对于这个集合中的每个不动点 $x^\\ast$，我们计算导数 $f'(x^\\ast)$ 并检查其符号。\n6. 计算不动点的总数。同时计算稳定不动点（其中 $f'(x^\\ast)  0$）的数量。\n7. 如果稳定不动点的数量至少为两个，则系统表现出多个稳定状态。\n\n这个以编程方式实现的流程，可以对每个测试用例进行明确的分析。", "answer": "[[3,True],[1,False],[2,False],[1,False],[3,True]]", "id": "2854806"}]}