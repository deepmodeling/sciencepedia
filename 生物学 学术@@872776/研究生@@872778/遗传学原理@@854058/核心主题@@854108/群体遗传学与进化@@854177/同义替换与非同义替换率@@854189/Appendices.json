{"hands_on_practices": [{"introduction": "在深入研究复杂的进化模型之前，掌握基本概念的计算至关重要。本练习将引导您根据观测到的序列数据，直接计算同义替换比例（$p_S$）和非同义替换比例（$p_N$）。通过计算一个未经多重替换校正的朴素 $\\omega$ 比率，您将为这些数值在最基本层面上的含义建立坚实的直觉 [@problem_id:2844396]。", "problem": "两个物种之间一个蛋白质编码基因的成对序列比对跨越了$100$个密码子，总共$300$个核苷酸位点。在标准遗传密码下，该基因被注释有$230$个同义位点和$70$个非同义位点，其中“位点”是根据遗传密码的简并性进行分数计数，然后对整个基因求和得到的。在该比对中，有$70$个观察到的同义差异和$21$个观察到的非同义差异。\n\n从基本定义出发，在不进行多次突变校正的情况下，每个位点类别的观察到的每位点分化度等于观察到的差异数除以该类别中的位点数，并且非同义替换率与同义替换率之比（通常表示为$d_{N}/d_{S}$或$\\omega$）定义为非同义替换率与同义替换率的比值。请在不进行多次突变校正的情况下计算以下量：\n- 每同义位点的同义分化度，$p_{S}$，\n- 每非同义位点的非同义分化度，$p_{N}$，\n- 以及使用$d_{S}=p_{S}$和$d_{N}=p_{N}$的朴素比率$\\omega = d_{N}/d_{S}$。\n\n将这三个值都以无舍入的精确有理数形式报告。以行向量$\\big(p_{S},\\,p_{N},\\,\\omega\\big)$的形式提供你的最终结果。", "solution": "对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 比对长度：$100$个密码子，总共$300$个核苷酸位点。\n- 同义位点数：$S = 230$。\n- 非同义位点数：$N = 70$。\n- 观察到的同义差异数：$S_d = 70$。\n- 观察到的非同义差异数：$N_d = 21$。\n- 每位点分化度的定义（无多次突变校正）：观察到的差异数除以该类别中的位点数。这对应于$p_S$和$p_N$。\n- 非同义替换率与同义替换率之比的定义：$\\omega = d_{N}/d_{S}$。\n- 计算条件：使用$d_{S}=p_{S}$和$d_{N}=p_{N}$的朴素假设。\n- 要求输出：三个量，$p_S$、$p_N$和$\\omega$，以精确有理数形式报告在一个行向量中。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它涉及分子进化的基本概念，特别是替换率的计算。同义位点($S$)、非同义位点($N$)、同义差异($S_d$)和非同义差异($N_d$)的概念是该领域的标准概念。所提供的数据内部一致；位点总数为$S + N = 230 + 70 = 300$，这与一个包含$100$个密码子的序列中的核苷酸位点总数相匹配（$100 \\text{ 个密码子} \\times 3 \\text{ 个核苷酸/密码子} = 300$）。该问题是适定的，提供了计算唯一解所需的所有必要定义和数据。不进行多次突变校正的指令对于一个入门级问题来说是一个有效的简化假设，它导致对每个位点类别计算“p距离”。问题是客观的，不包含任何歧义。\n\n步骤3：结论与行动。\n问题有效。将进行求解。\n\n该问题要求计算与序列分化相关的三个量：每同义位点的同义分化度($p_S$)、每非同义位点的非同义分化度($p_N$)，以及在简化假设下这些速率的比值($\\omega$)。\n\n给定的量是：\n- 同义位点数，$S = 230$。\n- 非同义位点数，$N = 70$。\n- 观察到的同义差异数，$S_d = 70$。\n- 观察到的非同义差异数，$N_d = 21$。\n\n问题将每个类别的观察到的每位点分化度定义为观察到的差异数除以该类别中的位点数。这给出了$p_S$和$p_N$的定义。\n\n首先，我们计算每同义位点的同义分化度，$p_S$。这是两个序列之间显示出差异的同义位点的比例。\n$$p_S = \\frac{S_d}{S}$$\n代入给定值：\n$$p_S = \\frac{70}{230}$$\n这个分数可以通过分子和分母同时除以它们的最大公约数$10$来化简。\n$$p_S = \\frac{7}{23}$$\n\n其次，我们计算每非同义位点的非同义分化度，$p_N$。这是观察到差异的非同义位点的比例。\n$$p_N = \\frac{N_d}{N}$$\n代入给定值：\n$$p_N = \\frac{21}{70}$$\n这个分数可以通过分子和分母同时除以它们的最大公约数$7$来化简。\n$$p_N = \\frac{3}{10}$$\n\n第三，我们计算比率$\\omega = d_N/d_S$。问题明确指出，使用朴素近似法，即替换率$d_N$和$d_S$分别被视为等于观察到的分化度$p_N$和$p_S$。这种简化忽略了在同一位点发生多次替换的可能性，这会导致对真实进化距离的低估，但我们必须遵循问题的指令。\n因此，我们设$d_N = p_N$和$d_S = p_S$。那么比率$\\omega$为：\n$$\\omega = \\frac{d_N}{d_S} = \\frac{p_N}{p_S}$$\n代入先前计算出的$p_N$和$p_S$的值：\n$$\\omega = \\frac{3/10}{7/23}$$\n为了化简这个繁分数，我们将分子乘以分母的倒数：\n$$\\omega = \\frac{3}{10} \\times \\frac{23}{7} = \\frac{3 \\times 23}{10 \\times 7} = \\frac{69}{70}$$\n\n这三个量是$p_S = \\frac{7}{23}$，$p_N = \\frac{3}{10}$，和$\\omega = \\frac{69}{70}$。问题要求将这些值以行向量$\\big(p_{S},\\,p_{N},\\,\\omega\\big)$的形式报告。\n最终结果是包含这三个精确有理数的向量。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{7}{23}  \\frac{3}{10}  \\frac{69}{70} \\end{pmatrix}}$$", "id": "2844396"}, {"introduction": "由于同一位点可能发生多次替换，观测到的序列差异通常会低估真实的替换数量。本练习将介绍 Jukes-Cantor 模型，这是一种校正这种偏差的基础方法。通过实践，您将学会如何将观测到的差异比例（$p_S$ 和 $p_N$）转换为更准确的进化速率（$d_S$ 和 $d_N$），并解释由此得出的 $\\omega$ 值的生物学意义 [@problem_id:2844443]。", "problem": "通过使用遗传密码将密码子位置划分为同义和非同义位点类别，对一对密切相关的编码蛋白质的DNA序列进行分析。假设每个位点类别的替换遵循一个独立的、齐次的连续时间马尔可夫链，该链作用于四种核苷酸，所有核苷酸对之间具有相等的交换率，且具有相等的平稳碱基频率（Jukes-Cantor模型）。设两个序列之间在同义位点上的观察差异比例为 $p_{S}$，在非同义位点上的观察差异比例为 $p_{N}$。在该模型下，时间 $t$ 时观察到的差异比例 $p$ 与每个位点的预期替换数 $d$ 通过相同概率的指数衰减相关联，该衰减由速率矩阵的特征结构和离开一个状态的总速率决定。\n\n使用此框架，首先推导连接 $p$ 和 $d$ 的函数关系，然后对其求逆以获得用 $p$ 表示的 $d$。将所得表达式分别应用于同义和非同义分区，从以下观察比例计算 $d_{S}$ 和 $d_{N}$：\n- $p_{S} = 0.18$\n- $p_{N} = 0.06$\n\n最后，计算比率 $\\omega$（定义为非同义与同义替换率之比 $\\omega = d_{N}/d_{S}$），并简要说明该 $\\omega$ 值对该编码蛋白质的序列意味着何种选择模式。报告 $d_{S}$、$d_{N}$ 和 $\\omega$ 的值，每个值均四舍五入至 $4$ 位有效数字。将这三个报告的量表示为无量纲数（每个位点的预期替换数是无量纲的）。", "solution": "所述问题具有科学依据，提法明确，并包含了获得唯一且有意义解所需的所有信息。我们将进行推导和计算。\n\n该问题指定了 Jukes–Cantor ($1969$) 核苷酸替换模型。这是一个连续时间马尔可夫模型，其 $4 \\times 4$ 的速率矩阵为 $Q$，其中从任意核苷酸 $i$ 到任意其他核苷酸 $j$ ($i \\neq j$) 的替换速率是一个常数 $\\alpha$。对角线元素 $Q_{ii}$ 的定义使得每行之和为零，因此 $Q_{ii} = -3\\alpha$。速率矩阵为：\n$$\nQ = \\begin{pmatrix}\n-3\\alpha  \\alpha  \\alpha  \\alpha \\\\\n\\alpha  -3\\alpha  \\alpha  \\alpha \\\\\n\\alpha  \\alpha  -3\\alpha  \\alpha \\\\\n\\alpha  \\alpha  \\alpha  -3\\alpha\n\\end{pmatrix} = \\alpha \\begin{pmatrix}\n-3  1  1  1 \\\\\n1  -3  1  1 \\\\\n1  1  -3  1 \\\\\n1  1  1  -3\n\\end{pmatrix}\n$$\n时间间隔 $t$ 的概率转移矩阵由 $P(t) = \\exp(Qt)$ 给出。由于 $Q$ 的对称性，我们可以找到一个封闭形式的表达式。经过时间 $t$ 后，一个位点仍然是相同核苷酸的概率 $P_{ii}(t)$，以及它已变为某个特定不同核苷酸的概率 $P_{ij}(t)$（$i \\neq j$），分别为：\n$$ P_{ii}(t) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t) $$\n$$ P_{ij}(t) = \\frac{1}{4} - \\frac{1}{4}\\exp(-4\\alpha t) \\quad (i \\neq j) $$\n我们考虑的是两个序列，它们在 $t$ 个时间单位前从一个共同祖先分化而来。分隔它们的总演化时间为 $2t$。让我们求一个位点在两个序列中相同的概率 $F$。假设祖先核苷酸为状态 $k$，如果两个谱系最终都处于相同的状态 $m$，那么后代中的该位点将是相同的。这个概率，对所有可能的最终状态 $m$ 求和，为：\n$$ F = \\sum_{m=A,C,G,T} P_{km}(t) \\cdot P_{km}(t) = (P_{kk}(t))^2 + 3(P_{kj}(t))^2 \\quad (j \\neq k) $$\n其中，项 $P_{kk}(t)$ 对应于两个谱系都与祖先具有相同的核苷酸，而项 $3(P_{kj}(t))^2$ 对应于两个谱系都已变为*相同*的新核苷酸。因为平稳分布是均匀的（对于所有 $i$，$\\pi_i = 1/4$），所以这个结果与祖先状态 $k$ 无关。\n代入 $P_{ii}(t)$ 和 $P_{ij}(t)$ 的表达式：\n$$ F = \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-4\\alpha t)\\right)^2 + 3\\left(\\frac{1}{4} - \\frac{1}{4}\\exp(-4\\alpha t)\\right)^2 $$\n$$ F = \\frac{1}{16} \\left[ (1 + 3\\exp(-4\\alpha t))^2 + 3(1 - \\exp(-4\\alpha t))^2 \\right] $$\n$$ F = \\frac{1}{16} \\left[ (1 + 6\\exp(-4\\alpha t) + 9\\exp(-8\\alpha t)) + 3(1 - 2\\exp(-4\\alpha t) + \\exp(-8\\alpha t)) \\right] $$\n$$ F = \\frac{1}{16} \\left[ 1 + 6\\exp(-4\\alpha t) + 9\\exp(-8\\alpha t) + 3 - 6\\exp(-4\\alpha t) + 3\\exp(-8\\alpha t) \\right] $$\n$$ F = \\frac{1}{16} [4 + 12\\exp(-8\\alpha t)] = \\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t) $$\n观察到的差异位点比例 $p$ 是不相同的概率，即 $1-F$。\n$$ p = 1 - F = 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-8\\alpha t)\\right) = \\frac{3}{4} - \\frac{3}{4}\\exp(-8\\alpha t) = \\frac{3}{4}(1 - \\exp(-8\\alpha t)) $$\n接下来，我们必须将其与每个位点的预期替换数 $d$ 联系起来。每个位点每单位时间的替换速率是离开任意状态的速率，即 $3\\alpha$。由于两个序列被总长为 $2t$ 的分支长度分开，每个位点的预期替换数为：\n$$ d = (3\\alpha) \\times (2t) = 6\\alpha t $$\n我们可以将指数中的项 $8\\alpha t$ 表示为 $d$ 的函数：\n$$ 8\\alpha t = \\frac{8}{6} (6\\alpha t) = \\frac{4}{3}d $$\n将此代入 $p$ 的表达式，我们得到 $p$ 和 $d$ 之间的函数关系：\n$$ p(d) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{4}{3}d\\right)\\right) $$\n为了用 $p$ 表示 $d$，我们必须对该方程求逆：\n$$ \\frac{4}{3}p = 1 - \\exp\\left(-\\frac{4}{3}d\\right) $$\n$$ \\exp\\left(-\\frac{4}{3}d\\right) = 1 - \\frac{4}{3}p $$\n$$ -\\frac{4}{3}d = \\ln\\left(1 - \\frac{4}{3}p\\right) $$\n$$ d(p) = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}p\\right) $$\n这就是 Jukes–Cantor 校正公式。现在我们将此公式应用于同义（$S$）和非同义（$N$）分区，使用提供的观察差异比例。\n\n对于同义位点，我们有 $p_S = 0.18$。每个同义位点的替换数 $d_S$ 为：\n$$ d_S = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}(0.18)\\right) = -\\frac{3}{4}\\ln(1 - 0.24) = -\\frac{3}{4}\\ln(0.76) $$\n$$ d_S \\approx -0.75 \\times (-0.2744368) \\approx 0.2058276 $$\n四舍五入至 $4$ 位有效数字， $d_S = 0.2058$。\n\n对于非同义位点，我们有 $p_N = 0.06$。每个非同义位点的替换数 $d_N$ 为：\n$$ d_N = -\\frac{3}{4}\\ln\\left(1 - \\frac{4}{3}(0.06)\\right) = -\\frac{3}{4}\\ln(1 - 0.08) = -\\frac{3}{4}\\ln(0.92) $$\n$$ d_N \\approx -0.75 \\times (-0.0833816) \\approx 0.0625362 $$\n四舍五入至 $4$ 位有效数字， $d_N = 0.06254$。\n\n最后，我们计算比率 $\\omega = d_N / d_S$：\n$$ \\omega = \\frac{d_N}{d_S} \\approx \\frac{0.0625362}{0.2058276} \\approx 0.303828 $$\n四舍五入至 $4$ 位有效数字， $\\omega = 0.3038$。\n\n比率 $\\omega$ 衡量了作用于蛋白质的选择压力。$\\omega  1$ 的值表明，非同义替换比同义（中性）替换更频繁地被自然选择所清除。该模式被称为**纯化选择**或负选择，这表明该蛋白质在功能上是受限的，并且大多数氨基酸变化是有害的。我们的结果 $\\omega \\approx 0.3038$ 显著小于 $1$，因此是作用于该编码蛋白质序列的纯化选择的一个明确指标。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2058  0.06254  0.3038 \\end{pmatrix}}\n$$", "id": "2844443"}, {"introduction": "为整个基因计算的单个 $\\omega$ 值是一个平均值，它可能掩盖了不同位点在不同选择压力下演化的复杂现实。本练习通过一个包含纯化选择和正选择两种位点类型的理论情景，揭示了对全基因取平均值是如何掩盖正选择信号的 [@problem_id:2844378]。理解这一原理对于批判性地评估已发表的研究结果以及认识到更复杂的位点特异性模型的必要性至关重要。", "problem": "一个蛋白质编码基因座被建模为具有两个位点类别，这两个类别的非同义替换速率与同义替换速率之比不同，该比率定义为 $dN/dS$（通常表示为 $\\omega$）。类别 $1$ 包含比例为 $p$ 的位点，其 $\\omega_1 = 0.1$（强纯化选择）；类别 $2$ 包含比例为 $1 - p$ 的位点，其 $\\omega_2 = 2.0$（正向选择）。假设每个同义位点的同义替换速率 $dS$ 在所有位点类别中是相同的，每个位点发生同义变化的机会在不同类别之间是可比的，并且跨位点聚合的 $dN/dS$ 定义为每个非同义位点的期望非同义替换数除以每个同义位点的期望同义替换数，这是通过汇集所有位点计算得出的。\n\n仅使用上述定义和位点类别混合下的期望概念，推导出跨位点平均 $dN/dS$（表示为 $\\bar{\\omega}$）作为 $p$ 的一个简化函数。然后，简要解释为什么在这个模型中，该跨位点平均值可能无法揭示作用于一部分位点的正向选择的存在。最终答案只报告 $\\bar{\\omega}$ 的简化解析表达式。无需进行数值四舍五入。", "solution": "题目要求为一个具有两类位点的蛋白质编码基因座推导跨位点平均的非同义与同义替换速率之比 $\\bar{\\omega}$。\n\n首先，我们将给定的信息和定义形式化。\n该基因座包含两个位点类别。\n类别 $1$：比例为 $p$ 的位点处于强纯化选择下，其速率比为 $\\omega_1 = \\frac{dN_1}{dS_1} = 0.1$。\n类别 $2$：比例为 $1-p$ 的位点处于正向选择下，其速率比为 $\\omega_2 = \\frac{dN_2}{dS_2} = 2.0$。\n\n此处，$dN_i$ 是类别 $i$ 中每个非同义位点的非同义替换速率，$dS_i$ 是类别 $i$ 中每个同义位点的同义替换速率。题目提供了一个关键的简化假设：同义替换速率在所有位点上是相同的，这意味着对于某个恒定速率 $dS$，有 $dS_1 = dS_2 = dS$。\n\n根据 $\\omega_1$ 和 $\\omega_2$ 的定义，我们可以用共同的同义速率 $dS$ 来表示每个类别的非同义速率：\n$$ dN_1 = \\omega_1 \\cdot dS_1 = 0.1 \\cdot dS $$\n$$ dN_2 = \\omega_2 \\cdot dS_2 = 2.0 \\cdot dS $$\n\n题目将跨位点聚合平均值 $\\bar{\\omega}$ 定义为每个非同义位点的期望非同义替换速率 $E[dN]$ 与每个同义位点的期望同义替换速率 $E[dS]$ 之比，其中期望是根据位点类别的分布计算的。\n\n期望非同义替换速率 $E[dN]$ 是这两个类别速率的加权平均值，权重由它们的比例给出：\n$$ E[dN] = p \\cdot dN_1 + (1-p) \\cdot dN_2 $$\n代入 $dN_1$ 和 $dN_2$ 的表达式：\n$$ E[dN] = p \\cdot (0.1 \\cdot dS) + (1-p) \\cdot (2.0 \\cdot dS) $$\n提取公因子 $dS$：\n$$ E[dN] = dS \\cdot [0.1p + 2.0(1-p)] $$\n\n期望同义替换速率 $E[dS]$ 的计算方法类似：\n$$ E[dS] = p \\cdot dS_1 + (1-p) \\cdot dS_2 $$\n因为 $dS_1 = dS_2 = dS$：\n$$ E[dS] = p \\cdot dS + (1-p) \\cdot dS = (p + 1 - p) \\cdot dS = dS $$\n这个结果是合乎逻辑的：如果速率在所有位点上是恒定的，那么它的期望值就是那个恒定值。\n\n现在，我们根据定义构建聚合比率 $\\bar{\\omega}$：\n$$ \\bar{\\omega} = \\frac{E[dN]}{E[dS]} = \\frac{dS \\cdot [0.1p + 2.0(1-p)]}{dS} $$\n未知速率 $dS$ 从分子和分母中消去，这是问题能够被合理解答的必要条件。这得到：\n$$ \\bar{\\omega} = 0.1p + 2.0(1-p) $$\n简化此表达式得到关于 $p$ 的最终函数：\n$$ \\bar{\\omega} = 0.1p + 2.0 - 2.0p $$\n$$ \\bar{\\omega} = 2.0 - 1.9p $$\n\n问题的第二部分询问为什么这个平均值 $\\bar{\\omega}$ 可能无法揭示正向选择的存在。通常当速率比大于1时，我们推断存在正向选择。在这个模型中，类别 $2$ 的位点明确处于正向选择之下，因为 $\\omega_2 = 2.0  1$。然而，跨位点平均的度量 $\\bar{\\omega}$ 可能小于或等于 $1$，从而掩盖了这一信号。\n\n当处于纯化选择下的位点（类别 $1$，其 $\\omega_1 = 0.1  1$）的贡献在平均值中占主导地位时，就会发生这种情况。如果满足以下条件，$\\bar{\\omega}$ 的值将小于 $1$：\n$$ 2.0 - 1.9p  1 $$\n$$ 1.0  1.9p $$\n$$ p  \\frac{1.0}{1.9} \\approx 0.526 $$\n\n因此，如果处于强纯化选择下的位点比例 $p$ 大于约 $52.6\\%$，跨位点平均的 $\\bar{\\omega}$ 将小于 $1$。例如，如果 $p = 0.8$，意味着 $80\\%$ 的位点处于纯化选择下，平均 $\\bar{\\omega}$ 将是 $2.0 - 1.9(0.8) = 2.0 - 1.52 = 0.48$。一个观测到的 $\\bar{\\omega} = 0.48$ 的值会得出一个天真的结论，即整个基因都处于纯化选择之下，从而完全无法检测到那 $20\\%$ 在强正向选择下演化的位点。这展示了对一个在其进化压力上具有异质性的基因或基因座使用单一、平均的 $\\omega$ 值的一个根本局限性。平均化过程掩盖了潜在的异质性，尤其是当少数位点受到的选择压力与大多数位点相反时。", "answer": "$$\\boxed{2.0 - 1.9p}$$", "id": "2844378"}]}