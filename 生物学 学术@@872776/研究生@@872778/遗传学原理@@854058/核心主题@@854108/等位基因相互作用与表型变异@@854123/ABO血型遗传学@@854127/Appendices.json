{"hands_on_practices": [{"introduction": "ABO血型的表达是一个超越单一基因座的经典复杂遗传学案例。本问题将介绍孟买血型（Bombay phenotype），这是一个引人入胜的上位效应（epistasis）实例，其中 *FUT1* 基因的功能是表现任何ABO抗原的先决条件。通过解决这个场景 [@problem_id:2772058]，你将练习应用孟德尔的自由组合定律来理解一个基因如何掩盖另一个基因的表达效果。", "problem": "一对夫妇正在进行遗传咨询。决定红细胞（RBC）ABO抗原表达所需H抗原存在的Alpha(1,2)-岩藻糖基转移酶 1 (FUT1) 基因座有两个等位基因：一个功能性显性等位基因 $H$ 和一个无效隐性等位基因 $h$。基因型为 $hh$ 的个体，其红细胞上缺少H抗原，表现为孟买表型，该表型会掩盖任何可能表达的ABO血型抗原。ABO血型系统由一个独立的基因座决定，该基因座有三个常见的等位基因：$I^{A}$、$I^{B}$ 和 $i$，其中 $I^{A}$ 和 $I^{B}$ 为共显性，且两者对 $i$ 均为显性。已知这对父母在FUT1基因座上均为杂合子，基因型均为 $Hh$。在ABO基因座上，第一位亲本的基因型为 $I^{A}i$，第二位亲本的基因型为 $I^{B}i$。假设遵循孟德尔分离定律和自由组合定律（即FUT1和ABO基因座独立分配），基因型 $hh$ 的孟买表型具有完全外显率，且不发生选择、突变或分离畸变。在随机分离的情况下，这对夫妇随机受孕的子女具有孟买表型（即在FUT1基因座上为 $hh$）的概率是多少，无论其ABO基因型如何？请将最终答案表示为最简分数。无需四舍五入。", "solution": "该问题陈述已经过验证，被认为是有效的。它具有科学依据，问题明确且客观。它提出了一个孟德尔遗传学中的标准问题，涉及H/h (FUT1) 基因座与ABO基因座之间的上位效应。所有必要信息，包括亲本基因型和遗传模式，都已提供，足以计算出唯一且有意义的解。\n\n问题要求计算指定夫妇的子女表现出孟买表型的概率。孟买表型由Alpha(1,2)-岩藻糖基转移酶 1 (FUT1) 基因座上的 $hh$ 基因型所定义。问题明确指出，根据孟德尔自由组合定律，FUT1基因座和ABO基因座是独立分配的。该定律指出，一个性状的遗传不影响另一个性状的遗传。因此，要确定后代在FUT1基因座上的基因型概率，我们可以将该基因座与ABO基因座完全分离开来进行分析。对于所提出的特定问题，父母在ABO基因座上的基因型（$I^{A}i$ 和 $I^{B}i$）是无关信息。\n\n父母在FUT1基因座上的基因型均被告知为杂合的，即 $Hh$。因此，需要考虑的遗传杂交是 $Hh \\times Hh$。\n\n根据孟德尔分离定律，每个亲本产生携带 $H$ 等位基因或 $h$ 等位基因的配子的概率相等。对于每个亲本，产生带 $H$ 等位基因的配子的概率是 $P(H) = \\frac{1}{2}$，产生带 $h$ 等位基因的配子的概率是 $P(h) = \\frac{1}{2}$。\n\n为了求出后代基因型为 $hh$ 的概率，我们必须考虑孩子从第一个亲本遗传一个 $h$ 等位基因，并且从第二个亲本遗传一个 $h$ 等位基因的事件。由于来自每个亲本的配子贡献是独立事件，我们可以将它们的概率相乘。\n\n从第一个亲本遗传一个 $h$ 等位基因的概率是 $P(\\text{parent}_1 \\to h) = \\frac{1}{2}$。\n从第二个亲本遗传一个 $h$ 等位基因的概率是 $P(\\text{parent}_2 \\to h) = \\frac{1}{2}$。\n\n因此，后代基因型为 $hh$ 的概率是这些独立概率的乘积：\n$$P(hh) = P(\\text{parent}_1 \\to h) \\times P(\\text{parent}_2 \\to h) = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4}$$\n\n这个结果也可以通过使用庞氏表（Punnett square）来可视化单基因杂交 $Hh \\times Hh$。后代可能的基因型是 $HH$、$Hh$ 和 $hh$。庞氏表得出以下基因型比例：$1$份 $HH$，$2$份 $Hh$ 和 $1$份 $hh$。可能结果的总数是 $4$。\n每种基因型的概率是：\n$P(HH) = \\frac{1}{4}$\n$P(Hh) = \\frac{2}{4} = \\frac{1}{2}$\n$P(hh) = \\frac{1}{4}$\n\n问题要求的是孩子具有孟买表型的概率，这对应于基因型 $hh$。这个概率是 $\\frac{1}{4}$。该分数已经是最简形式。", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2772058"}, {"introduction": "虽然标准的 $A$、$B$ 和 $O$ 等位基因构成了ABO遗传学的基础，但现实情况更为复杂，包含了具有不寻常特性的稀有变异。本练习探讨了$cis\\text{-}AB$等位基因，它挑战了简单的共显性规则，并表现出不完全外显（incomplete penetrance），导致单一基因型可能产生多种表型。解决这个问题 [@problem_id:2772066] 将磨练你在非标准遗传模式下运用概率论预测结果的技能。", "problem": "ABO血型系统的单基因座模型假设ABO基因具有编码糖基转移酶活性的等位基因，这些活性决定了红细胞抗原表型：等位基因$A$编码$\\alpha$-$N$-乙酰半乳糖胺转移酶（A活性），等位基因$B$编码$\\alpha$-半乳糖基转移酶（B活性），而等位基因$i$（历史上称为$O$）是一个无酶活性的无效等位基因。一个罕见的重组等位基因，记为$\\mathrm{cis}\\!-\\!AB$，编码一种对$A$和$B$决定簇具有双重特异性的单一糖基转移酶，并已知在标准血清学检测中表现出表现度多变和外显不全。假设减数分裂遵循孟德尔分离定律，并且没有分离畸变。\n\n考虑一个$\\mathrm{cis}\\!-\\!AB/i$基因型亲本与一个$i/i$基因型亲本之间的交配。在一个经过验证和固定的表型分析方案下，基因型$\\mathrm{cis}\\!-\\!AB/i$被分类为以下血清学表型，其外显率如下：\n- $P(\\text{表型 }A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$，\n- $P(\\text{表型 } B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$，\n- $P(\\text{表型 } AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$，\n- $P(\\text{表型 } O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$，\n它们的总和为$1.00$。\n\n对于基因型$i/i$，假设$P(\\text{表型 } O \\mid i/i) = 1.00$且$P(\\text{任何其他表型} \\mid i/i) = 0$。\n\n仅使用上述定义、孟德尔分离定律和全概率定律，推导该交配如何在后代中产生所有四种ABO表型，并计算后代中表型$A$、$B$、$AB$和$O$的期望频率。按$A, B, AB, O$的顺序，以小数形式报告这四个频率，其总和应为$1$，并将最终报告的数字四舍五入到四位有效数字。答案中不要使用百分号。", "solution": "所述问题是有效的。它在科学上基于孟德尔遗传学和概率论的原理。该问题定义明确，为获得唯一解提供了所有必要的数据和定义，没有内部矛盾或歧义。这个场景涉及罕见的$\\mathrm{cis}\\!-\\!AB$等位基因及其已知的外显不全特性，是人类遗传学中一个有效但并非无关紧要的问题。\n\n解决方案需要两个主要步骤：首先，使用孟德尔分离定律确定可能的后代基因型的概率；其次，应用全概率定律，使用给定的外显率计算每种表型的期望频率。\n\n设等位基因表示为$\\mathcal{A}_{\\mathrm{cisAB}}$、$\\mathcal{A}_A$、$\\mathcal{A}_B$和$\\mathcal{A}_i$。问题中使用了$\\mathrm{cis}\\!-\\!AB$、$A$、$B$和$i$的表示法。我们将遵循问题的表示法。\n\n交配在一个基因型为$\\mathrm{cis}\\!-\\!AB/i$的亲本和一个基因型为$i/i$的亲本之间进行。\n根据孟德尔分离定律，每个亲本以相等的概率将其两个等位基因中的一个传递给后代。没有分离畸变，因此来自杂合子亲本的每个等位基因的概率恰好是$\\frac{1}{2}$。\n\n亲本1（基因型$\\mathrm{cis}\\!-\\!AB/i$）产生两种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因$\\mathrm{cis}\\!-\\!AB$的配子，概率为$P(\\text{配子} = \\mathrm{cis}\\!-\\!AB) = 0.5$。\n    \\item 带有等位基因$i$的配子，概率为$P(\\text{配子} = i) = 0.5$。\n\\end{itemize}\n\n亲本2（基因型$i/i$）只产生一种类型的配子：\n\\begin{itemize}\n    \\item 带有等位基因$i$的配子，概率为$P(\\text{配子} = i) = 1.0$。\n\\end{itemize}\n\n后代的基因型及其概率由每个亲本的配子结合决定。\n\\begin{enumerate}\n    \\item 后代基因型$\\mathrm{cis}\\!-\\!AB/i$：这是由来自亲本1的$\\mathrm{cis}\\!-\\!AB$配子和来自亲本2的$i$配子融合而成的。\n    其概率为$P(G=\\mathrm{cis}\\!-\\!AB/i) = 0.5 \\times 1.0 = 0.5$。\n    \\item 后代基因型$i/i$：这是由来自亲本1的$i$配子和来自亲本2的$i$配子融合而成的。\n    其概率为$P(G=i/i) = 0.5 \\times 1.0 = 0.5$。\n\\end{enumerate}\n后代基因型概率之和为$0.5 + 0.5 = 1.0$，符合预期。\n\n问题要求后代中表型$A$、$B$、$AB$和$O$的期望频率。我们使用全概率定律。对于任何表型$\\Phi$，其概率是该表型在每种可能基因型下的条件概率之和，并按每种基因型的概率加权：\n$$P(\\Phi=\\phi) = \\sum_{G_j} P(\\Phi=\\phi \\mid G=G_j) \\times P(G=G_j)$$\n其中，求和遍及所有可能的后代基因型$G_j$。在我们的例子中，基因型为$G_1 = \\mathrm{cis}\\!-\\!AB/i$和$G_2 = i/i$。\n\n给定的条件概率（外显率值）是：\n\\begin{itemize}\n    \\item $P(\\text{表型 } A \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.22$\n    \\item $P(\\text{表型 } B \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.15$\n    \\item $P(\\text{表型 } AB \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.62$\n    \\item $P(\\text{表型 } O \\mid \\mathrm{cis}\\!-\\!AB/i) = 0.01$\n\\end{itemize}\n对于$i/i$基因型：\n\\begin{itemize}\n    \\item $P(\\text{表型 } O \\mid i/i) = 1.00$\n    \\item $P(\\text{任何其他表型} \\mid i/i) = 0$\n\\end{itemize}\n\n使用这些信息，我们计算每种表型的概率：\n\n1.  **表型A的频率：**\n    $$P(A) = P(A \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(A \\mid i/i)P(i/i)$$\n    $$P(A) = (0.22)(0.5) + (0)(0.5) = 0.11$$\n\n2.  **表型B的频率：**\n    $$P(B) = P(B \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(B \\mid i/i)P(i/i)$$\n    $$P(B) = (0.15)(0.5) + (0)(0.5) = 0.075$$\n\n3.  **表型AB的频率：**\n    $$P(AB) = P(AB \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(AB \\mid i/i)P(i/i)$$\n    $$P(AB) = (0.62)(0.5) + (0)(0.5) = 0.31$$\n\n4.  **表型O的频率：**\n    $$P(O) = P(O \\mid \\mathrm{cis}\\!-\\!AB/i)P(\\mathrm{cis}\\!-\\!AB/i) + P(O \\mid i/i)P(i/i)$$\n    $$P(O) = (0.01)(0.5) + (1.00)(0.5) = 0.005 + 0.5 = 0.505$$\n\n这个推导解释了这次交配如何能产生所有四种表型。后代群体是两种基因型的混合体。$i/i$个体将始终表现为O型。$\\mathrm{cis}\\!-\\!AB/i$个体由于外显不全，可以表现出四种表型中的任何一种，尽管概率不同。这些结果的加权和导致整个后代群体中所有四种表型的概率都非零。\n\n为了验证，表型频率的总和是：\n$P(A) + P(B) + P(AB) + P(O) = 0.11 + 0.075 + 0.31 + 0.505 = 1.0$。\n\n问题要求将频率报告为四舍五入到四位有效数字的小数。\n\\begin{itemize}\n    \\item $P(A) = 0.11 \\to 0.1100$\n    \\item $P(B) = 0.075 \\to 0.0750$\n    \\item $P(AB) = 0.31 \\to 0.3100$\n    \\item $P(O) = 0.505 \\to 0.5050$\n\\end{itemize}\n最终，表型$A, B, AB, O$的频率分别为$0.1100$、$0.0750$、$0.3100$和$0.5050$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1100  0.0750  0.3100  0.5050\n\\end{pmatrix}\n}\n$$", "id": "2772066"}, {"introduction": "从根本上说，表型是细胞内动态生化过程的累积结果。这个高级实践从静态的孟德尔杂交分析转向对血型抗原在高尔基体中转运与合成过程的建模。通过构建一个定量的房室模型（compartmental model）[@problem_id:2772055]，你将获得一个系统层面的理解，即遗传信息如何被转化为最终可测量的细胞表面表型。", "problem": "您需要设计并实现一个离散、单次通过的房室模型，用于描述基于N-乙酰乳糖胺的聚糖在内质网（ER）和高尔基体中成熟的过程。该模型需能捕捉ABO血型转移酶活性对细胞表面抗原出现的影响。该模型必须基于以下基本原理：分子生物学中心法则（基因型决定酶丰度）、在底物饱和条件下由质量作用动力学描述的酶催化作用（产生有效的一级速率定律），以及通过高尔基体的顺序性囊泡运输。您编写的程序必须能针对指定的参数集，计算携带A抗原、B抗原或仍为H抗原的细胞表面聚糖末端的预测分数，并以小数形式表示。\n\n将使用的建模假设和定义：\n- 房室化：一个糖蛋白依次穿过内质网（ER）和高尔基体，其中高尔基体由三个串联的房室表示：顺式（cis）、中间（medial）和反式（trans）。设高尔基体有 $n=3$ 个房室，索引为 $i \\in \\{1,2,3\\}$。在本问题中，内质网被视为一个过渡房室，不发生ABO转换；它在顺式高尔基体入口处引入底物H抗原。因此，就ABO转换而言，只有三个高尔基体房室贡献反应事件。\n- 房室内停留时间：设房室 $i$ 内的停留时间为 $t_i$（单位为 $\\mathrm{s}$），这些时间收集在一个向量 $\\mathbf{t} = [t_1,t_2,t_3]$ 中，其中 $t_i \\ge 0$。\n- 有效动力学：假设供体底物是饱和的，因此ABO转移酶催化的H到A和H到B的转化可以很好地近似为独立的、竞争性的不可逆一级反应，每个房室具有恒定的风险率。对于房室 $i$，定义伪一级速率常数 $k_{Ai}$ 和 $k_{Bi}$，单位为 $\\mathrm{s}^{-1}$。\n- 酶活性的遗传控制：设 $E_A$ 和 $E_B$ 分别为A和B转移酶的无量纲相对表达水平，由基因型决定。每个房室单位酶的催化效率为常数 $c_{Ai}$ 和 $c_{Bi}$，单位为 $\\mathrm{s}^{-1}$ 每酶单位，因此对于每个 $i$，有 $k_{Ai} = E_A \\cdot c_{Ai}$ 和 $k_{Bi} = E_B \\cdot c_{Bi}$。\n- 单次通过运输：每个聚糖按顺序单次通过每个房室。在房室 $i$ 内，状态H可以随机且不可逆地转化为A或B，或在离开前保持为H，其恒定风险率为 $k_{Ai}$ 和 $k_{Bi}$。到达细胞表面后不发生转化。没有反向运输，也没有逆反应。进入顺式高尔基体时的初始条件是状态H的分数为 $1$，状态A和B的分数为 $0$。\n\n要求的推导和计算：\n- 仅使用上述定义以及竞争性泊松过程和恒定风险率下生存分析的第一性原理，推导出将 $(\\mathbf{t}, \\mathbf{c}_A, \\mathbf{c}_B, E_A, E_B)$ 映射到最终细胞表面分数 $(f_A, f_B, f_H)$ 的表达式，其中 $f_A$ 是带有A抗原的分数， $f_B$ 是带有B抗原的分数， $f_H$ 是仍为H抗原的分数。您的推导必须从每个房室中未转化H状态的生存函数开始，并考虑跨房室生存概率的顺序乘积以及在每个房室中转化为A或B的条件概率。最终分数必须满足 $f_A \\ge 0$, $f_B \\ge 0$, $f_H \\ge 0$, 且 $f_A + f_B + f_H = 1$。\n- 所有时间参数的单位必须是 $\\mathrm{s}$，所有速率常数的单位必须是 $\\mathrm{s}^{-1}$，所有输出必须报告为四舍五入到 $6$ 位小数的小数。\n\n测试套件的输入参数：\n- 固定催化效率向量（所有测试用例均相同）：\n  - $\\mathbf{c}_A = [2.0\\times 10^{-3},\\;4.0\\times 10^{-3},\\;1.0\\times 10^{-3}]\\,\\mathrm{s}^{-1}\\,\\text{每酶单位}$。\n  - $\\mathbf{c}_B = [1.5\\times 10^{-3},\\;3.5\\times 10^{-3},\\;1.2\\times 10^{-3}]\\,\\mathrm{s}^{-1}\\,\\text{每酶单位}$。\n- 定义基础停留时间向量：\n  - $\\mathbf{t}^{(\\text{base})} = [600,\\;900,\\;600]\\,\\mathrm{s}$。\n- 程序必须为以下 $5$ 个测试用例中的每一个计算 $(f_A, f_B, f_H)$，其中每个用例是一个元组 $(E_A, E_B, \\mathbf{t})$：\n  1. $(1.0,\\;0.0,\\;\\mathbf{t}^{(\\text{base})})$ 用于模拟具有典型运输的基因型A。\n  2. $(0.0,\\;1.2,\\;\\mathbf{t}^{(\\text{base})})$ 用于模拟具有典型运输的B表达增强情况。\n  3. $(0.8,\\;0.8,\\;\\mathbf{t}^{(\\text{base})})$ 用于模拟具有典型运输的共表达（基因型AB）。\n  4. $(0.0,\\;0.0,\\;\\mathbf{t}^{(\\text{base})})$ 用于模拟无转化的基因型O。\n  5. $(1.0,\\;0.0,\\;[5,\\;5,\\;5]\\,\\mathrm{s})$ 用于模拟具有极快速运输的基因型A。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素是对应一个测试用例的三个小数的内部列表 $[f_A,f_B,f_H]$，顺序与上文所列一致。数值必须四舍五入到 $6$ 位小数。例如，语法正确的输出形式为 $[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots]$，除了逗号和括号外，没有额外的空白要求。", "solution": "该问题要求推导并实现一个房室模型，用于描述糖蛋白穿过高尔基体时ABO抗原的合成过程。该模型基于竞争性反应的一级动力学和顺序运输。\n\n**问题验证。**\n问题陈述经评估为有效。它在科学上植根于细胞生物学和生物化学动力学的既定原理，特别是房室建模、底物饱和下近似为一级过程的质量作用定律，以及顺序性囊泡运输。该问题是适定的，提供了所有必要的参数、初始条件（在顺式高尔基体入口处为 $100\\%$ H抗原），以及一套清晰、客观的状态转换规则。所提供的参数对于生物系统而言是物理上现实的。该问题是自洽的、可数学形式化的，并在模型的推导和实现上提出了一个非平凡的挑战。\n\n**模型推导。**\n\n设糖蛋白的状态由其末端抗原表示，可以是H、A或B。该过程始于一批全部处于H状态的糖蛋白进入高尔基体的第一个房室。高尔基体被建模为 $n=3$ 个顺序房室，索引为 $i \\in \\{1, 2, 3\\}$。\n\n设 $H_i$、$A_i$ 和 $B_i$ 分别表示该批次在离开房室 $i$ 时处于H、A和B状态的分数。进入房室 $1$（为方便表示，索引为 $i=0$）时的初始条件是：\n$$\nH_0 = 1, \\quad A_0 = 0, \\quad B_0 = 0\n$$\n\n在每个房室 $i$ 中，一个糖蛋白停留时间为 $t_i$。在此期间，处于H状态的分子可以以伪一级速率常数 $k_{Ai}$ 转化为状态A，或以速率常数 $k_{Bi}$ 转化为状态B。这些转化被建模为竞争性的、独立的泊松过程。房室 $i$ 中H转化的总风险率为各个速率之和：\n$$\n\\lambda_i = k_{Ai} + k_{Bi}\n$$\n速率常数由酶表达水平 $E_A$ 和 $E_B$ 以及内在催化效率 $\\mathbf{c}_A$ 和 $\\mathbf{c}_B$ 决定：\n$$\nk_{Ai} = E_A \\cdot c_{Ai}, \\quad k_{Bi} = E_B \\cdot c_{Bi}\n$$\n\n考虑一个进入房室 $i$ 的处于H状态的单一糖蛋白。它在其停留时间 $t_i$ 内保持H状态的概率由速率为 $\\lambda_i$ 的指数分布的生存函数给出：\n$$\nP(\\text{在房室 } i \\text{ 中以H状态存活}) = e^{-\\lambda_i t_i}\n$$\n因此，它被转化为A或B的概率是：\n$$\nP(\\text{在房室 } i \\text{ 中转化}) = 1 - e^{-\\lambda_i t_i}\n$$\n如果发生转化（即 $\\lambda_i > 0$），结果由相对速率决定。转化到状态A的条件概率是：\n$$\nP(\\text{H} \\to \\text{A} | \\text{发生转化}) = \\frac{k_{Ai}}{k_{Ai} + k_{Bi}} = \\frac{k_{Ai}}{\\lambda_i}\n$$\n转化到状态B的条件概率是：\n$$\nP(\\text{H} \\to \\text{B} | \\text{发生转化}) = \\frac{k_{Bi}}{k_{Ai} + k_{Bi}} = \\frac{k_{Bi}}{\\lambda_i}\n$$\n如果 $\\lambda_i=0$，则不发生转化，也就不需要这些条件概率。\n\n现在，我们可以为分数 $H_i$、$A_i$ 和 $B_i$ 建立递推关系，描述这批糖蛋白从一个房室传递到下一个房室的过程。设 $H_{i-1}$、$A_{i-1}$ 和 $B_{i-1}$ 是进入房室 $i$ 的分数。\n\n进入房室 $i$ 时仍处于H状态的批次分数是 $H_{i-1}$。只有这部分分数会发生转化。离开房室 $i$ 时仍保持H状态的分数是：\n$$\nH_i = H_{i-1} \\cdot e^{-\\lambda_i t_i}\n$$\n这是一个递推公式。将其展开，经过 $n$ 个房室后剩余的H的总分数是：\n$$\nH_n = H_0 \\prod_{j=1}^{n} e^{-\\lambda_j t_j} = \\exp\\left(-\\sum_{j=1}^{n} \\lambda_j t_j\\right)\n$$\n\n已经处于A或B状态的糖蛋白是惰性的。新的A和B抗原仅由 $H_{i-1}$ 分数形成。在房室 $i$ 中，A抗原携带者分数的增量，记为 $\\Delta A_i$，是进入的H分数乘以转化概率，再乘以该转化是到A的条件概率：\n$$\n\\Delta A_i = H_{i-1} \\cdot \\left(1 - e^{-\\lambda_i t_i}\\right) \\cdot \\frac{k_{Ai}}{\\lambda_i}\n$$\n对于B也类似：\n$$\n\\Delta B_i = H_{i-1} \\cdot \\left(1 - e^{-\\lambda_i t_i}\\right) \\cdot \\frac{k_{Bi}}{\\lambda_i}\n$$\n这些公式在 $\\lambda_i > 0$ 时成立。如果 $\\lambda_i=0$，那么 $k_{Ai}=k_{Bi}=0$，项 $(1 - e^{-\\lambda_i t_i})$ 为零，从而正确地得到 $\\Delta A_i = 0$ 和 $\\Delta B_i = 0$。\n\n经过房室 $i$ 后的总分数是进入时的分数与新形成的分数之和：\n$$\nA_i = A_{i-1} + \\Delta A_i\n$$\n$$\nB_i = B_{i-1} + \\Delta B_i\n$$\n\n离开最后一个房室（$i=3$）时的最终分数是 $(f_A, f_B, f_H) = (A_3, B_3, H_3)$。这些分数通过对 $i=1, 2, 3$ 顺序应用递推关系来计算。\n\n**计算算法。**\n1. 初始化分数：$H \\leftarrow 1.0$, $A \\leftarrow 0.0$, $B \\leftarrow 0.0$。\n2. 对于从 $1$ 到 $3$ 的每个房室 $i$：\n   a. 计算速率常数 $k_{Ai} = E_A \\cdot c_{Ai}$ 和 $k_{Bi} = E_B \\cdot c_{Bi}$。\n   b. 计算总风险率 $\\lambda_i = k_{Ai} + k_{Bi}$。\n   c. 确定进入房室 $i$ 的H分数中通过后存活下来的部分：$S_i = e^{-\\lambda_i t_i}$。\n   d. 确定进入房室 $i$ 的H分数中发生转化的部分：$C_i = 1 - S_i$。\n   e. 从当前的H分数中计算新生成的A和B的数量。如果 $\\lambda_i > 0$：\n      i. $\\Delta A = H \\cdot C_i \\cdot (k_{Ai} / \\lambda_i)$\n      ii. $\\Delta B = H \\cdot C_i \\cdot (k_{Bi} / \\lambda_i)$\n   f. 更新总分数：$A \\leftarrow A + \\Delta A$, $B \\leftarrow B + \\Delta B$。\n   g. 更新进入下一阶段的H分数：$H \\leftarrow H \\cdot S_i$。\n3. 最终计算出的 $A$、$B$ 和 $H$ 的值即为所要求的分数 $f_A, f_B, f_H$。然后将它们四舍五入到 $6$ 位小数。此过程确保了质量平衡，即 $f_A + f_B + f_H = 1$，但会受到浮点精度和四舍五入的影响。", "answer": "[[0.995483,0.000000,0.004517],[0.000000,0.993774,0.006226],[0.817296,0.176435,0.006269],[0.000000,0.000000,1.000000],[0.034420,0.000000,0.965580]]", "id": "2772055"}]}