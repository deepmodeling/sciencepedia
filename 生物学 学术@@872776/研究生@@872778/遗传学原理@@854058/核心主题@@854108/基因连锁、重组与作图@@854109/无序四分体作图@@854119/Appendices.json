{"hands_on_practices": [{"introduction": "这项实践回归到四分体分析的根本。在进行任何定量分析之前，我们必须能够准确地对减数分裂的原始产物——即四分体本身——进行分类。本练习旨在挑战您超越简单的模式识别，开发一个形式化的算法程序，将任何给定的四分体分类为亲本双型（Parental Ditype, PD）、非亲本双型（Nonparental Ditype, NPD）或四型（Tetratype, T），或者判定其为无效。关键在于从第一性原理出发，特别是利用等位基因的 $2:2$ 分离定律，该定律不仅是分类的依据，也是一个至关重要的数据质量检验步骤 [@problem_id:2864980]。这种计算方法有助于建立对四分体类型的深刻、可操作的理解。", "problem": "给定一个来自子囊菌样生物单次减数分裂的无序四分体，该生物在两个双等位基因标记上是杂合的。设这两个基因座由等位基因 $A/a$ 和 $B/b$ 表示，并假设减数分裂前的二倍体是由两个单倍体亲本 $AB$ 和 $ab$ 杂交形成的，因此合子处于连锁相 $AB/ab$。每个四分体表示为从集合 $\\{AB, Ab, aB, ab\\}$ 中抽取的 $4$ 个单倍体双基因座基因型的多重集。这四个孢子是无序的；也就是说，这 $4$ 个基因型的任意排列都表示同一个四分体。需要使用的基本事实是：(i) 在一个完整的四分体中，每个基因座的减数分裂分离产生 $2:2$ 的等位基因分布（恰好两个孢子携带 $A$，两个携带 $a$；同样，恰好两个携带 $B$，两个携带 $b$），以及 (ii) 重组可以产生非亲本的双基因座组合 $Ab$ 和 $aB$。\n\n您的任务是设计一个程序，实现一个算法分类规则，将任何给定的四分体映射到以下类别之一，并按如下规定进行数字编码：\n- 亲本双型 (Parental Ditype, PD)：编码为 $0$。\n- 四分型 (Tetratype, T)：编码为 $1$。\n- 非亲本双型 (Nonparental Ditype, NPD)：编码为 $2$。\n- 无效（在任一基因座上违反 $2:2$ 分离定律，或包含 $\\{A,a,B,b\\}$ 之外的符号）：编码为 $-1$。\n\n您实现的算法必须从上述事实出发，由第一性原理推导得出。具体来说，您必须严格地仅基于观察到的 $4$ 个双基因座基因型的多重集和每个基因座的 $2:2$ 分离约束来进行分类，而不依赖于现成的公式。您的程序必须：\n- 将四分体视为无序的（分类必须对孢子排列保持不变）。\n- 在分类前验证每个基因座的 $2:2$ 分离约束；如果违反或任何基因型包含不在 $\\{A,a,B,b\\}$ 中的字符或长度不完全为 $2$，则返回编码 $-1$。\n- 否则，当且仅当四分体恰好包含两个亲本基因型 $AB$ 和 $ab$，且每个重数为 $2$ 时，将其映射为 $0$（亲本双型）；当且仅当它恰好包含两个非亲本基因型 $Ab$ 和 $aB$，且每个重数为 $2$ 时，将其映射为 $2$（非亲本双型）；当且仅当它包含所有四种基因型 $\\{AB, Ab, aB, ab\\}$，且每个重数为 $1$ 时，将其映射为 $1$（四分型）。\n\n测试套件和输出规范：\n- 按此顺序使用以下 $5$ 个四分体作为固定的测试套件：\n    $1.$ $\\{AB, AB, ab, ab\\}$。\n    $2.$ $\\{Ab, Ab, aB, aB\\}$。\n    $3.$ $\\{AB, Ab, aB, ab\\}$。\n    $4.$ $\\{AB, AB, Ab, ab\\}$。\n    $5.$ $\\{AB, ab, aB, aX\\}$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的整数列表，且没有空格。例如，输出形式为 $[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_i$ 是测试用例 $i$ 的编码。\n- 此问题中没有物理单位或角度。所有结果均为整数。\n\n您的实现必须是一个完整的、可运行的程序，在执行时只产生最终所需的单行输出。", "solution": "所述问题是有效的。它在科学上基于减数分裂遗传学的原理，在数学上是适定的，并且用客观、明确的语言定义。它没有违反任何无效标准。因此，我将从第一性原理出发提供一个解决方案。\n\n任务是为来自基因型为 $AB/ab$ 的二倍体合子的无序减数分裂四分体构建一个分类算法。该分类必须区分亲本双型 ($PD$)、非亲本双型 ($NPD$)、四分型 ($T$) 和无效四分体。\n\n**从第一性原理推导算法**\n\n在进行任何分类尝试之前，算法必须首先强制执行遗传学的基本约束和问题的定义。这建立了一个逻辑层次：验证先于分类。\n\n**1. 验证阶段：强制执行生物学和形式上的正确性**\n\n设输入四分体为四个双基因座基因型的多重集，$T = \\{g_1, g_2, g_3, g_4\\}$。\n\n- **形式有效性**：问题将基因型定义为双字符字符串。第一个字符必须来自集合 $\\{A, a\\}$，第二个字符必须来自 $\\{B, b\\}$。任何偏离此格式的情况，如不正确的字符串长度或出现未定义符号（例如“$X$”），都构成形式上的违规。根据问题的规范，这样的输入不是一个有效的四分体，必须被拒绝。\n\n- **生物学有效性（$2:2$ 分离定律）**：在单个杂合基因座上，减数分裂的一个基石是分离定律，该定律规定一个完整的四分体必须包含 $2:2$ 的等位基因比例。对于所讨论的两个基因座，这转化为四个严格条件。设 $C(x)$ 为四分体中所有四个孢子中等位基因 $x$ 的总数。这些条件是：\n$$\nC(A) = 2 \\quad \\land \\quad C(a) = 2\n$$\n$$\nC(B) = 2 \\quad \\land \\quad C(b) = 2\n$$\n如果这四个等式中的任何一个不满足，该四分体就代表了非整倍性或其他减数分裂错误，或者仅仅是一个格式错误的输入。无论哪种情况，它都被归类为无效（编码为 $-1$）。\n\n算法必须首先遍历给定的四个基因型，验证其形式结构，并同时计算等位基因的总数 $C(A), C(a), C(B), C(b)$。如果任何检查失败，则过程终止并返回 $-1$。\n\n**2. 分类阶段：有效四分体的分析**\n\n成功通过验证阶段的四分体是符合 $2:2$ 分离规则的合法减数分裂产物。其分为 $PD$、$NPD$ 或 $T$ 的分类是基于其亲本型 ($AB, ab$) 和非亲本型 ($Ab, aB$) 基因型的构成。\n\n通过分析一个有效四分体可以包含的不同基因型*种类*的数量，可以得到一个关键的洞见。\n- **一种不同的类型**：一个由 $\\{g, g, g, g\\}$ 组成的四分体无法满足 $2:2$ 规则。例如，$\\{AB, AB, AB, AB\\}$ 得到 $C(A)=4$，而不是 $2$。所以这是不可能的。\n- **三种不同的类型**：一个形如 $\\{g_1, g_1, g_2, g_3\\}$ 的四分体（其中 $g_1, g_2, g_3$ 不同）也无法满足 $2:2$ 规则。如果我们令 $g_1=AB$，前两个孢子贡献的计数为 $C(A)=2, C(B)=2$。为了满足整体的 $2:2$ 规则，剩下的孢子 $g_2, g_3$ 必须贡献 $C(a)=2, C(b)=2$，这意味着 $g_2=ab$ 且 $g_3=ab$。这迫使四分体为 $\\{AB, AB, ab, ab\\}$，它只有两种不同的类型，这是一个矛盾。所以，三种不同的类型是不可能的。\n\n因此，任何有效的四分体必须恰好包含**两种**或**四种**不同的基因型。这一关键推论为分类提供了一个稳健的框架。\n\n- **情况 1：四种不同的基因型**\n  如果一个四分体包含四种不同的基因型，并且鉴于孢子总数为四个，它必须是多重集 $\\{AB, Ab, aB, ab\\}$，其中每种基因型出现的重数为 $1$。这是**四分型 (T)**的定义。我们可以验证它是有效的：$C(A)$ 来自 $AB$ 和 $Ab$，所以 $C(A)=2$。$C(a)$ 来自 $aB$ 和 $ab$，所以 $C(a)=2$。同样地，$C(B)=2$ 和 $C(b)=2$。这样的四分体被分类为 $T$（编码为 $1$）。\n\n- **情况 2：两种不同的基因型**\n  如果一个四分体包含两种不同的基因型，其形式必须是 $\\{g_1, g_1, g_2, g_2\\}$。为了同时满足两个基因座的 $2:2$ 规则，基因型 $g_1$ 和 $g_2$ 必须是互补的。例如，如果 $g_1=AB$，其贡献是 $1A, 1B$。为了达到 $2A, 2a, 2B, 2b$ 的目标，两个 $g_2$ 型的孢子必须共同贡献 $1A, 2a, 1B, 2b$。这是不可能的。相反，两个 $g_1$ 孢子贡献 $2A, 2B$。那么两个 $g_2$ 孢子必须贡献 $0A, 2a, 0B, 2b$，这意味着 $g_2=ab$。因此，唯一可能的基因型对是 $(AB, ab)$ 和 $(Ab, aB)$。这导致两种子情况：\n  - **亲本双型 (PD)**：两种基因型是亲本类型，$\\{AB, ab\\}$。四分体是 $\\{AB, AB, ab, ab\\}$。这被分类为 $PD$（编码为 $0$）。\n  - **非亲本双型 (NPD)**：两种基因型是非亲本类型，$\\{Ab, aB\\}$。四分体是 $\\{Ab, Ab, aB, aB\\}$。这被分类为 $NPD$（编码为 $2$）。\n\n**最终算法结构**\n1.  实现验证检查（形式和生物学）。失败时返回 $-1$。\n2.  如果四分体有效，计算四种可能基因型的重数：$N_{AB}, N_{Ab}, N_{aB}, N_{ab}$。\n3.  根据这些计数应用分类规则，这些规则是互斥的。\n    - 如果 $N_{AB}=2$ 且 $N_{ab}=2$，返回 $0$ (PD)。\n    - 如果 $N_{Ab}=2$ 且 $N_{aB}=2$，返回 $2$ (NPD)。\n    - 如果 $N_{AB}=1, N_{Ab}=1, N_{aB}=1, N_{ab}=1$，返回 $1$ (T)。\n这个过程是完整的、正确的，并且直接从问题的公理化基础推导出来。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport collections\n\ndef solve():\n    \"\"\"\n    Solves the tetrad classification problem for the specified test suite.\n    \"\"\"\n\n    def classify_tetrad(tetrad: list[str]) - int:\n        \"\"\"\n        Classifies a single meiotic tetrad based on genetic principles.\n\n        The classification follows a two-step process: validation and then classification.\n        A tetrad is invalid if it violates formal structure or the 2:2 allele segregation law.\n        A valid tetrad is classified as PD, T, or NPD based on its genotype composition.\n\n        Args:\n            tetrad: A list of 4 strings representing the genotypes of the spores.\n\n        Returns:\n            An integer code: 0 for PD, 1 for T, 2 for NPD, -1 for Invalid.\n        \"\"\"\n        # --- Step 1: Validation ---\n        \n        # 1a: Check basic structure (must be 4 spores)\n        if len(tetrad) != 4:\n            return -1\n\n        # 1b: Check allele validity and count alleles for segregation check\n        allele_counts = collections.defaultdict(int)\n        valid_alleles_locus1 = {'A', 'a'}\n        valid_alleles_locus2 = {'B', 'b'}\n\n        for genotype in tetrad:\n            # Genotype must be a string of length 2\n            if not isinstance(genotype, str) or len(genotype) != 2:\n                return -1\n            \n            allele1, allele2 = genotype[0], genotype[1]\n            \n            # Alleles must be from the allowed sets\n            if allele1 not in valid_alleles_locus1 or allele2 not in valid_alleles_locus2:\n                return -1\n\n            allele_counts[allele1] += 1\n            allele_counts[allele2] += 1\n\n        # 1c: Check for 2:2 allele segregation law\n        if not (allele_counts.get('A', 0) == 2 and allele_counts.get('a', 0) == 2 and\n                allele_counts.get('B', 0) == 2 and allele_counts.get('b', 0) == 2):\n            return -1\n\n        # --- Step 2: Classification of Valid Tetrads ---\n        \n        genotype_counts = collections.Counter(tetrad)\n        \n        # Parental Ditype (PD): code 0\n        # Contains exactly the two parental genotypes, AB and ab, each with multiplicity 2.\n        if genotype_counts.get('AB', 0) == 2 and genotype_counts.get('ab', 0) == 2:\n            return 0\n            \n        # Nonparental Ditype (NPD): code 2\n        # Contains exactly the two nonparental genotypes, Ab and aB, each with multiplicity 2.\n        if genotype_counts.get('Ab', 0) == 2 and genotype_counts.get('aB', 0) == 2:\n            return 2\n            \n        # Tetratype (T): code 1\n        # Contains all four genotypes {AB, Ab, aB, ab}, each with multiplicity 1.\n        if (genotype_counts.get('AB', 0) == 1 and genotype_counts.get('Ab', 0) == 1 and\n            genotype_counts.get('aB', 0) == 1 and genotype_counts.get('ab', 0) == 1):\n            return 1\n            \n        # Per the derivation, a valid tetrad must fall into one of the above three categories.\n        # This fallback is for logical completeness but should not be reached.\n        return -1\n\n\n    # Define the fixed test suite from the problem statement.\n    test_cases = [\n        ['AB', 'AB', 'ab', 'ab'],    # Case 1: PD\n        ['Ab', 'Ab', 'aB', 'aB'],    # Case 2: NPD\n        ['AB', 'Ab', 'aB', 'ab'],    # Case 3: T\n        ['AB', 'AB', 'Ab', 'ab'],    # Case 4: Invalid (violates 2:2 'a' segregation)\n        ['AB', 'ab', 'aB', 'aX']     # Case 5: Invalid (contains illegal character 'X')\n    ]\n\n    results = []\n    for case in test_cases:\n        result = classify_tetrad(case)\n        results.append(result)\n\n    # Final print statement must produce only the required single-line format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2864980"}, {"introduction": "当对大量的四分体进行分类和计数后，遗传学家通常提出的第一个问题是：观察到的频率是否偏离了基因不连锁时所预期的频率？本练习将介绍回答这一问题的核心统计方法：卡方（$\\chi^2$）拟合优度检验。通过应用此检验，您将学习如何定量地比较观察到的四分体计数（PD、NPD、T）与独立分配假说下的预期比例，从而为接受或拒绝无连锁的零假设提供统计学依据 [@problem_id:2865026]。这是解读任何遗传杂交实验结果的一项基本技能。", "problem": "一个在两个基因座上杂合的二倍体 *Saccharomyces cerevisiae* 菌株经过孢子形成后，其无序四分体被解剖并分为亲本双型 (PD)、非亲本双型 (NPD) 和四分型 (T) 三类。在总共 $356$ 个完整的四分体中，观测到的计数为：PD $= 94$，NPD $= 88$，T $= 174$。在不存在连锁（独立分配且无染色单体干涉）的原假设下，$PD:NPD:T$ 的预期类别比例为 $1:1:2$。\n\n仅使用卡方拟合优度检验的定义，计算针对不存在连锁原假设的卡方检验统计量。将您的最终答案表示为一个四舍五入到四位有效数字的实数。不要报告 $p$ 值，也不要包含任何单位。", "solution": "该问题要求计算一个用于拟合优度检验的卡方 ($\\chi^2$) 检验统计量。这是遗传学中的一个标准程序，用于评估遗传杂交的观测数据是否显著偏离特定假设下的预期频率，在本例中即为两个基因独立分配的假设。\n\n首先，正式陈述给定的信息。\n观测到的四分体总数：$N = 356$。\n三种四分体类型的观测频率为：\n- 亲本双型：$O_{PD} = 94$。\n- 非亲本双型：$O_{NPD} = 88$。\n- 四分型：$O_{T} = 174$。\n\n原假设 ($H_0$) 是两个基因座独立分配。对于像 *Saccharomyces cerevisiae* 这样进行减数分裂的生物，其非连锁基因产生的亲本双型 (PD)、非亲本双型 (NPD) 和四分型 (T) 四分体的理论比例为 $1:1:2$。这个比例源于同源染色体的等概率分离模式以及减数分裂中期 I 二价体的随机取向。具体来说，当基因与着丝粒之间没有发生交换时，会形成 PD 和 NPD 四分体，并且它们以相等的频率出现。当其中一个基因与其着丝粒之间发生单次交换时，会形成 T 四分体。当考虑交换时，非连锁基因的 PD:NPD:T 预期比例是 $1:1:4$；然而，问题陈述明确给出了 $1:1:2$ 的比例作为原假设，这在许多入门教材中作为独立分配的标准预期（忽略着丝粒连锁时）。我们将按照明确提供的比例进行计算。\n\n预期比例 $1:1:2$ 中各部分的和为 $1 + 1 + 2 = 4$。现在我们可以根据总样本量 $N=356$ 计算原假设下每个类别的预期频率 ($E_i$)。\n每个类别的预期频率由公式 $E_i = (\\text{proportion}_i) \\times N$ 给出。\n\n- PD的预期频率：\n$$E_{PD} = \\frac{1}{1+1+2} \\times N = \\frac{1}{4} \\times 356 = 89$$\n\n- NPD的预期频率：\n$$E_{NPD} = \\frac{1}{1+1+2} \\times N = \\frac{1}{4} \\times 356 = 89$$\n\n- T的预期频率：\n$$E_{T} = \\frac{2}{1+1+2} \\times N = \\frac{2}{4} \\times 356 = \\frac{1}{2} \\times 356 = 178$$\n\n作为检验，预期频率的总和必须等于观测总数：$E_{PD} + E_{NPD} + E_{T} = 89 + 89 + 178 = 356 = N$。计算结果一致。\n\n卡方检验统计量 $\\chi^2$ 由以下公式定义：\n$$\\chi^2 = \\sum_{i} \\frac{(O_i - E_i)^2}{E_i}$$\n其中 $O_i$ 是第 $i$ 个类别的观测频率，$E_i$ 是其预期频率。\n\n我们现在计算每个类别对总 $\\chi^2$ 值的贡献。\n\n- 对于 PD 类别：\n$$\\frac{(O_{PD} - E_{PD})^2}{E_{PD}} = \\frac{(94 - 89)^2}{89} = \\frac{5^2}{89} = \\frac{25}{89}$$\n\n- 对于 NPD 类别：\n$$\\frac{(O_{NPD} - E_{NPD})^2}{E_{NPD}} = \\frac{(88 - 89)^2}{89} = \\frac{(-1)^2}{89} = \\frac{1}{89}$$\n\n- 对于 T 类别：\n$$\\frac{(O_{T} - E_{T})^2}{E_{T}} = \\frac{(174 - 178)^2}{178} = \\frac{(-4)^2}{178} = \\frac{16}{178} = \\frac{8}{89}$$\n\n总 $\\chi^2$ 统计量是这些值的总和：\n$$\\chi^2 = \\frac{25}{89} + \\frac{1}{89} + \\frac{8}{89} = \\frac{25 + 1 + 8}{89} = \\frac{34}{89}$$\n\n最后，我们必须计算该分数的数值，并按问题陈述的要求将其四舍五入到四位有效数字。\n$$\\chi^2 = \\frac{34}{89} \\approx 0.38202247...$$\n将此结果四舍五入到四位有效数字，得到 $0.3820$。该值表示观测到的四分体计数与不存在连锁假设下的预期计数之间的差异大小。", "answer": "$$\\boxed{0.3820}$$", "id": "2865026"}, {"introduction": "构建一幅完整的遗传图谱通常需要综合来自多个实验的信息。当估算三个或更多基因座之间的成对距离时，即使真实的基因顺序是线性的，由于抽样误差的存在，这些初步的估计值也可能不完全满足可加性。这项高级实践将引导您通过一个两步过程来应对这一常见挑战：首先，基于距离可加性原理推断出最可能的基因顺序；其次，利用最小二乘法对成对距离进行调整，以构建一个统一的、内部一致的遗传图谱 [@problem_id:2865030]。本练习展示了如何协调实验数据，以构建一个更精确、更稳健的染色体模型。", "problem": "在一种形成无序四分体的同宗配合真菌中，研究人员对大量子囊中的三个基因座 $A$、$B$ 和 $C$ 进行了基因分型。对于每对基因座，研究者首先通过无序四分体恒等式 $\\hat{r}_{ij} = \\frac{1}{2} T + \\text{NPD}$ 将观察到的亲本双型 (PD)、非亲本双型 (NPD) 和四分型 (T) 四分体的频率转换为染色单体重组率估计值 $\\hat{r}_{ij}$，然后应用无干涉 (Haldane) 作图函数得到 $\\hat{d}_{ij} = -\\frac{1}{2}\\ln(1 - 2\\hat{r}_{ij})$，从而计算出以摩根为单位的初步成对图距估计值 $\\hat{d}_{ij}$。由此得到的初步基因座间距离估计值（单位为摩根）如下：\n- $\\hat{d}_{AB} = 0.145$,\n- $\\hat{d}_{BC} = 0.202$,\n- $\\hat{d}_{AC} = 0.331$.\n\n由于真实的图距沿线性顺序是可加的，但初步估计值 $\\hat{d}_{ij}$ 包含抽样噪声，因此它们不必严格满足可加性。假设没有交换干涉（因此 Haldane 距离是可加的），并且真实的片段距离是非负的。在三种可能的线性顺序中，选择与这些约束条件一致的顺序，然后对该顺序执行无加权最小二乘法调整以强制实现可加性。具体来说，如果选择的顺序是 $A$–$B$–$C$，则引入未知的非负片段长度 $a = d_{AB}$ 和 $b = d_{BC}$，通过 $a + b$ 预测 $d_{AC}$，并选择 $a$ 和 $b$ 以最小化预测距离与初步估计值 $\\hat{d}_{ij}$ 之间的偏差平方和。\n\n在所选顺序下，通过这种最小二乘投影强制实现可加性后，基因座 $A$ 和 $C$ 之间的调整后图距是多少（单位为摩根）？将您的答案四舍五入到四位有效数字，并以摩根表示。最终答案中不要包含单位。", "solution": "该问题要求确定三个基因座“$A$”、“$B$”和“$C$”的线性顺序，并随后对图距进行最小二乘法调整以强制实现可加性。\n\n首先，需要验证问题陈述的有效性。\n给定的数据是初步的成对图距估计值：\n$\\hat{d}_{AB} = 0.145$ 摩根\n$\\hat{d}_{BC} = 0.202$ 摩根\n$\\hat{d}_{AC} = 0.331$ 摩根\n问题假设没有交换干涉，这意味着真实的图距（$d_{ij}$）沿着线性染色体是可加的。它还指出，真实的片段距离是非负的。任务是选择最可能的线性顺序，进行无加权最小二乘法调整，并报告调整后的距离 $d_{AC}$。\n\n这个问题在科学上基于遗传作图的原理，它提法明确，目标清晰，数据充分，并且陈述客观。初步估计值中存在的轻微非可加性（$\\hat{d}_{AB} + \\hat{d}_{BC} = 0.145 + 0.202 = 0.347 \\ne 0.331 = \\hat{d}_{AC}$）归因于抽样噪声，这是一个现实情景，并为进行统计调整提供了根本动因。因此，该问题被认为是有效的。\n\n解决方案分两个阶段进行：确定基因顺序和最小二乘法调整。\n\n阶段1：确定基因顺序\n三个基因座有 $3$ 种可能的线性顺序：$A-B-C$、$A-C-B$ 和 $B-A-C$。假设图距具有可加性，两个最外侧基因座之间的距离应等于相邻基因座之间距离的总和。我们为每种可能的顺序，比较两个较小估计距离之和与最大估计距离，以找到差异最小的顺序。\n\n情况1：顺序 $A-B-C$。预期的关系是 $d_{AC} = d_{AB} + d_{BC}$。使用估计值，我们将 $\\hat{d}_{AB} + \\hat{d}_{BC}$ 与 $\\hat{d}_{AC}$ 进行比较。\n$\\hat{d}_{AB} + \\hat{d}_{BC} = 0.145 + 0.202 = 0.347$。\n差异为 $|\\left(\\hat{d}_{AB} + \\hat{d}_{BC}\\right) - \\hat{d}_{AC}| = |0.347 - 0.331| = 0.016$。\n\n情况2：顺序 $A-C-B$。预期的关系是 $d_{AB} = d_{AC} + d_{CB}$。使用估计值，我们将 $\\hat{d}_{AC} + \\hat{d}_{BC}$ 与 $\\hat{d}_{AB}$ 进行比较。\n$\\hat{d}_{AC} + \\hat{d}_{BC} = 0.331 + 0.202 = 0.533$。\n差异为 $|\\left(\\hat{d}_{AC} + \\hat{d}_{BC}\\right) - \\hat{d}_{AB}| = |0.533 - 0.145| = 0.388$。\n\n情况3：顺序 $B-A-C$。预期的关系是 $d_{BC} = d_{BA} + d_{AC}$。使用估计值，我们将 $\\hat{d}_{AB} + \\hat{d}_{AC}$ 与 $\\hat{d}_{BC}$ 进行比较。\n$\\hat{d}_{AB} + \\hat{d}_{AC} = 0.145 + 0.331 = 0.476$。\n差异为 $|\\left(\\hat{d}_{AB} + \\hat{d}_{AC}\\right) - \\hat{d}_{BC}| = |0.476 - 0.202| = 0.274$。\n\n最小的差异（$0.016$）对应于顺序 $A-B-C$。因此选择此顺序为最可能的线性顺序。\n\n阶段2：无加权最小二乘法调整\n对于顺序 $A-B-C$，设调整后的非负片段距离为 $a = d_{AB}$ 和 $b = d_{BC}$。根据可加性原理，最外侧基因座之间的调整后距离为 $d_{AC} = a + b$。\n\n目标是找到 $a$ 和 $b$ 的值，以最小化初步估计值 $\\hat{d}_{ij}$ 与调整后距离之间的偏差平方和 $S(a, b)$。\n$$S(a, b) = (\\hat{d}_{AB} - a)^2 + (\\hat{d}_{BC} - b)^2 + (\\hat{d}_{AC} - (a+b))^2$$\n代入给定的数值：\n$$S(a, b) = (0.145 - a)^2 + (0.202 - b)^2 + (0.331 - a - b)^2$$\n为了找到最小值，我们计算 $S$ 对 $a$ 和 $b$ 的偏导数，并令其等于 $0$。\n$$\\frac{\\partial S}{\\partial a} = -2(0.145 - a) - 2(0.331 - a - b) = 0$$\n$$\\frac{\\partial S}{\\partial b} = -2(0.202 - b) - 2(0.331 - a - b) = 0$$\n两边同除以 $-2$，简化方程组：\n$$ (0.145 - a) + (0.331 - a - b) = 0 $$\n$$ (0.202 - b) + (0.331 - a - b) = 0 $$\n合并同类项，我们得到一个二元线性方程组：\n$$ 2a + b - 0.476 = 0 \\implies 2a + b = 0.476 \\quad (1) $$\n$$ a + 2b - 0.533 = 0 \\implies a + 2b = 0.533 \\quad (2) $$\n我们必须解这个方程组来求 $a$ 和 $b$。由方程 $(1)$ 得，$b = 0.476 - 2a$。将此代入方程 $(2)$：\n$$ a + 2(0.476 - 2a) = 0.533 $$\n$$ a + 0.952 - 4a = 0.533 $$\n$$ -3a = 0.533 - 0.952 $$\n$$ -3a = -0.419 $$\n$$ a = \\frac{0.419}{3} $$\n现在，将 $a$ 的值代回 $b$ 的表达式中：\n$$ b = 0.476 - 2\\left(\\frac{0.419}{3}\\right) = \\frac{1.428}{3} - \\frac{0.838}{3} = \\frac{0.590}{3} $$\n$a$ 和 $b$ 均为正数，满足非负性约束。\n\n问题要求的是基因座 $A$ 和 $C$ 之间的调整后图距，即 $d_{AC} = a + b$。\n$$ d_{AC} = a + b = \\frac{0.419}{3} + \\frac{0.590}{3} = \\frac{0.419 + 0.590}{3} = \\frac{1.009}{3} $$\n计算数值：\n$$ d_{AC} \\approx 0.336333... $$\n按要求四舍五入到四位有效数字，我们得到 $0.3363$。这是 $A$ 和 $C$ 之间的调整后图距。", "answer": "$$\\boxed{0.3363}$$", "id": "2865030"}]}