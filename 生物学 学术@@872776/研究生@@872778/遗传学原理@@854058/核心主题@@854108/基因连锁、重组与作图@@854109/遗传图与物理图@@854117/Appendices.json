{"hands_on_practices": [{"introduction": "要掌握遗传图谱和物理图谱之间的关系，我们必须从它们最基本的定义开始。本练习旨在巩固核心概念，即遗传距离是通过在物理距离上累积（或数学上，积分）局部重组率来确定的。通过解决这个假设一个分段恒定重组率的问题，您将直接应用这个定义，将以兆碱基（$\\mathrm{Mb}$）为单位的物理长度转换为以厘摩（$\\mathrm{cM}$）为单位的遗传距离。", "problem": "一个线性染色体片段，其物理坐标从 $x=0$ 到 $x=30$ 兆碱基（megabase, $\\mathrm{Mb}$），具有分段恒定的局部重组率密度，单位为厘摩每兆碱基（$\\mathrm{cM}$ per $\\mathrm{Mb}$）。具体来说，对于 $0 \\le x  20$ $\\mathrm{Mb}$，重组率密度为 $0.5$ $\\mathrm{cM}/\\mathrm{Mb}$；对于 $20 \\le x \\le 30$ $\\mathrm{Mb}$，重组率密度为 $3$ $\\mathrm{cM}/\\mathrm{Mb}$。请仅使用通过局部重组率密度将遗传图谱与物理图谱联系起来的基本定义，计算整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离。请将最终答案以厘摩（$\\mathrm{cM}$）为单位表示为一个数字。无需四舍五入。", "solution": "所提出的问题是遗传学中联系物理图谱和遗传图谱基本原理的直接应用。该问题具有科学依据，提法明确且完整。我们将开始解答。\n\n物理图谱（以兆碱基（$\\mathrm{Mb}$）等长度单位度量）与遗传图谱（以厘摩（$\\mathrm{cM}$）度量）之间的核心关系由局部重组率密度定义，我们将其表示为 $r(x)$。该函数 $r(x)$ 量化了染色体上特定物理位置 $x$ 处单位物理距离的遗传距离。其单位通常为厘摩每兆碱基（$\\mathrm{cM}/\\mathrm{Mb}$）。\n\n从物理起始坐标 $x_a$ 到结束坐标 $x_b$ 的连续染色体片段的总遗传距离 $\\Delta G$ 是通过在物理区间 $[x_a, x_b]$ 上对局部重组率密度 $r(x)$ 进行积分得到的。在数学上，这表示为：\n$$ \\Delta G = \\int_{x_a}^{x_b} r(x) \\, dx $$\n这个积分代表了沿染色体片段物理长度累积的遗传距离。\n\n在所给问题中，我们有一个从物理坐标 $x_1 = 0$ $\\mathrm{Mb}$ 延伸到 $x_3 = 30$ $\\mathrm{Mb}$ 的线性染色体片段。局部重组率密度 $r(x)$ 在整个区域内不是均匀的，而是作为一个分段常数函数给出。该函数定义如下：\n$$\nr(x) =\n\\begin{cases}\nr_1 = 0.5 \\, \\text{cM/Mb}   \\text{for } 0 \\le x  20 \\, \\text{Mb} \\\\\nr_2 = 3 \\, \\text{cM/Mb}   \\text{for } 20 \\le x \\le 30 \\, \\text{Mb}\n\\end{cases}\n$$\n为了计算整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离 $\\Delta G_{total}$，我们必须计算 $r(x)$ 从 $x = 0$ 到 $x = 30$ 的积分。\n$$ \\Delta G_{total} = \\int_{0}^{30} r(x) \\, dx $$\n由于函数 $r(x)$ 的分段性质，我们必须将积分划分为对应于重组率恒定的区间段。不连续点在 $x_2 = 20$ $\\mathrm{Mb}$。因此，我们在此点将积分分开：\n$$ \\Delta G_{total} = \\int_{0}^{20} r(x) \\, dx + \\int_{20}^{30} r(x) \\, dx $$\n现在，我们将每个区间各自的恒定重组率密度值代入积分中：\n$$ \\Delta G_{total} = \\int_{0}^{20} 0.5 \\, dx + \\int_{20}^{30} 3 \\, dx $$\n常数的积分是简单的。对于第一个区间，从 $x=0$到 $x=20$ $\\mathrm{Mb}$，遗传距离 $\\Delta G_1$ 是：\n$$ \\Delta G_1 = 0.5 \\times (20 - 0) = 0.5 \\times 20 = 10 \\, \\text{cM} $$\n对于第二个区间，从 $x=20$ 到 $x=30$ $\\mathrm{Mb}$，遗传距离 $\\Delta G_2$ 是：\n$$ \\Delta G_2 = 3 \\times (30 - 20) = 3 \\times 10 = 30 \\, \\text{cM} $$\n整个 $30$ $\\mathrm{Mb}$ 区域的总遗传距离是这两个子区域遗传距离的总和：\n$$ \\Delta G_{total} = \\Delta G_1 + \\Delta G_2 = 10 + 30 $$\n$$ \\Delta G_{total} = 40 \\, \\text{cM} $$\n计算完成。总遗传距离为 $40$ 厘摩。", "answer": "$$ \\boxed{40} $$", "id": "2817629"}, {"introduction": "在了解了物理距离和遗传距离之间的理论联系之后，下一步是学习如何从实验数据中估计关键参数。本练习将指导您完成一个核心的统计遗传学任务：根据减数分裂的原始计数数据，计算两个标记间的重组分数（$r$）的最大似然估计值。此外，您还将计算LOD得分，这是一个至关重要的统计量，用于量化连锁（即$r  0.5$）相对于无连锁（$r=0.5$）的证据强度，从而将原始数据转化为有统计支持的结论。", "problem": "一位研究人员正在比较两个遗传标记，以量化它们在遗传图谱上的分离程度，他们认识到遗传图距是由减数分裂重组推断出来的，而非物理上的碱基对距离。在一次受控回交实验中，他们针对这两个标记，将减数分裂事件记为重组型或非重组型。他们观察到$120$次重组型减数分裂和$380$次非重组型减数分裂。将每次减数分裂视为一次独立的伯努利试验，其中重组结果的概率等于重组率 $r$。根据这些数据，计算 $r$ 的最大似然估计值，以及比较最佳拟合连锁模型与无连锁模型 $r=0.5$ 的优势对数 (LOD) 得分。将 $\\hat{r}$ 以小数形式表示（而非百分比）。将 $\\hat{r}$ 和 LOD 得分均报告至$4$位有效数字。无需单位。", "solution": "目标是根据观察到的重组型和非重组型减数分裂的计数来估计两个标记间的重组率 $r$，然后使用优势对数 (LOD) 得分，相对于无连锁基线，来量化对连锁的统计支持度。其基本依据包括以下几个被广泛接受的原则：\n- 在回交实验中，将每次减数分裂针对两个基因座记为重组型或非重组型，会产生一个伯努利结果，其成功概率等于重组率 $r$。\n- 对于 $n$ 次独立试验中的 $x$ 次重组事件，其抽样模型为二项分布，似然函数与 $r^{x}(1-r)^{n-x}$ 成正比。\n- 二项概率参数的最大似然估计是通过最大化关于 $r$ 的似然函数（或等价地，对数似然函数）得到的。\n- 优势对数 (LOD) 得分是比较拟合的连锁模型与无连锁模型 $r=0.5$ 的似然比的以 10 为底的对数。\n\n设 $x$ 表示重组型减数分裂的次数，$n$ 表示减数分裂的总次数，$r$ 表示重组率。根据数据，$x=120$ 且 $n=120+380=500$。\n\n关于 $r$ 的二项似然函数，在不考虑一个与 $r$ 无关的组合常数的情况下，为\n$$\nL(r)\\propto r^{x}(1-r)^{n-x}\n$$\n对数似然函数为\n$$\n\\ell(r)=x\\ln(r)+(n-x)\\ln(1-r)+\\text{常数}\n$$\n对该函数求导并令其等于零，以求得最大似然估计值：\n$$\n\\frac{d\\ell}{dr}=\\frac{x}{r}-\\frac{n-x}{1-r}=0\n$$\n$$\nx(1-r)=(n-x)r\n$$\n$$\n\\hat{r}=\\frac{x}{n}\n$$\n当 $x=120$ 且 $n=500$ 时，\n$$\n\\hat{r}=\\frac{120}{500}=0.24\n$$\n四舍五入到 $4$ 位有效数字，得到 $\\hat{r}=0.2400$。\n\n接下来，计算LOD得分，其定义为\n$$\n\\mathrm{LOD}=\\log_{10}\\!\\left(\\frac{L(\\hat{r})}{L(0.5)}\\right)\n$$\n组合项在比率中被约去，因此\n$$\n\\frac{L(\\hat{r})}{L(0.5)}=\\frac{\\hat{r}^{x}(1-\\hat{r})^{n-x}}{(0.5)^{n}}\n$$\n所以\n$$\n\\mathrm{LOD}=x\\log_{10}\\!\\left(\\frac{\\hat{r}}{0.5}\\right)+(n-x)\\log_{10}\\!\\left(\\frac{1-\\hat{r}}{0.5}\\right)\n$$\n代入 $x=120$，$n=500$ 和 $\\hat{r}=0.24$：\n$$\n\\mathrm{LOD}\n=120\\log_{10}\\!\\left(\\frac{0.24}{0.5}\\right)+380\\log_{10}\\!\\left(\\frac{0.76}{0.5}\\right)\n=120\\log_{10}(0.48)+380\\log_{10}(1.52)\n$$\n计算对数值：\n$$\n\\log_{10}(0.48) \\approx -0.3187587626, \\quad \\log_{10}(1.52) \\approx 0.1818435879\n$$\n得出\n$$\n\\mathrm{LOD} \\approx 120(-0.3187587626)+380(0.1818435879) = -38.25105151+69.10056342 = 30.84951190\\ldots\n$$\n四舍五入到 $4$ 位有效数字，LOD得分为 $30.85$。\n\n因此，报告至 $4$ 位有效数字，重组率的最大似然估计值为 $0.2400$，且在该估计值下相对于 $r=0.5$ 的LOD得分为 $30.85$。", "answer": "$$\\boxed{\\begin{pmatrix}0.2400  30.85\\end{pmatrix}}$$", "id": "2817714"}, {"introduction": "最后，我们将把前面练习中的概念整合到一个更复杂、更实际的场景中：三点测交实验。这个经典的作图练习展示了如何同时定位多个基因座，计算区间特异性的图距，并量化交叉干涉这一生物学现象。通过分析不同类型的交换（包括单交换和双交换）的后代计数，您将能构建一个包含三个基因座的连锁图，从而弥合了简单的两点分析与构建更完整遗传图谱之间的差距。", "problem": "为了在一种模式生物中对同一条染色体上的三个基因座（标记为 $A$、$B$ 和 $C$）进行作图，进行了一次三点测交。子代被分为四种交换类型：非交换型（NCO）、在区间 $A$–$B$ 发生单交换（SCO）、在区间 $B$–$C$ 发生单交换（SCO）以及双交换型（DCO）。观测到的计数为：$800$ 个 NCO、$180$ 个 $A$–$B$ 区间的 SCO、$180$ 个 $B$–$C$ 区间的 SCO，以及 $20$ 个 DCO。假设没有染色单体干涉，并且每种交换类型都已被正确识别。\n\n仅使用将遗传图距与小遗传距离下的重组频率联系起来的核心定义，以及根据观测到的双交换与乘法法则期望值的偏差来定义干涉的定义，计算：\n- $A$–$B$ 和 $B$–$C$ 之间的遗传图距，以厘摩（cM）为单位，以及\n- 跨越 $A$、$B$ 和 $C$ 区域的干涉，以无单位的小数表示。\n\n将每个遗传图距四舍五入至四位有效数字（单位为厘摩，cM），并将干涉四舍五入至四位有效数字（作为无单位小数）。将您的最终答案以行向量 $\\big[d_{AB},\\ d_{BC},\\ I\\big]$ 的形式报告，其中 $d_{AB}$ 和 $d_{BC}$ 是以 cM 为单位的图距，$I$ 是干涉（无单位）。", "solution": "问题陈述已经过验证，被认为可以进行分析。它在科学上基于经典遗传学原理，问题阐述清晰且客观。所有必要数据均已提供且内部一致。\n\n分析首先计算实验中的子代总数。设 $N_{NCO}$ 为非交换型子代的数量，$N_{SCO, AB}$ 为基因座 $A$ 和 $B$ 之间区间内的单交换子代的数量，$N_{SCO, BC}$ 为基因座 $B$ 和 $C$ 之间区间内的单交换子代的数量，以及 $N_{DCO}$ 为双交换型子代的数量。子代总数 $N$ 是这些计数的总和：\n$$N = N_{NCO} + N_{SCO, AB} + N_{SCO, BC} + N_{DCO}$$\n代入给定值：\n$$N = 800 + 180 + 180 + 20 = 1180$$\n\n两个基因座之间的遗传图距 $d$ 定义为它们之间的重组频率，以厘摩（cM）为单位表示，其中 $1 \\text{ cM}$ 对应于 $1\\%$ 的重组频率。\n\n为了计算基因座 $A$ 和 $B$ 之间的图距 $d_{AB}$，我们必须识别出所有由该区间内的交换事件产生的子代。这些包括 $A$–$B$ 区域的单交换型和双交换型，因为双交换事件涉及一次在 $A$–$B$ 区域的交换和第二次在 $B$–$C$ 区域的交换。区间 $A$–$B$ 的重组频率，记为 $R.F._{AB}$，为：\n$$R.F._{AB} = \\frac{N_{SCO, AB} + N_{DCO}}{N} = \\frac{180 + 20}{1180} = \\frac{200}{1180}$$\n那么图距是：\n$$d_{AB} = R.F._{AB} \\times 100 = \\frac{200}{1180} \\times 100 \\approx 16.94915 \\text{ cM}$$\n按要求四舍五入到四位有效数字，得到 $d_{AB} = 16.95 \\text{ cM}$。\n\n类似地，基因座 $B$ 和 $C$ 之间的图距 $d_{BC}$ 是根据该区间的重组频率 $R.F._{BC}$ 计算的。该区间的重组型子代是 $B$–$C$ 区域的单交换型和双交换型。\n$$R.F._{BC} = \\frac{N_{SCO, BC} + N_{DCO}}{N} = \\frac{180 + 20}{1180} = \\frac{200}{1180}$$\n图距 $d_{BC}$ 是：\n$$d_{BC} = R.F._{BC} \\times 100 = \\frac{200}{1180} \\times 100 \\approx 16.94915 \\text{ cM}$$\n四舍五入到四位有效数字，得到 $d_{BC} = 16.95 \\text{ cM}$。\n\n接下来，我们计算干涉 $I$。干涉量化了一个区域的交换对邻近区域发生交换概率的影响程度。它是根据并发系数 $C$ 计算的。并发系数是观测到的双交换频率（$DCO_{obs}$）与期望的双交换频率（$DCO_{exp}$）的比值。\n观测到的 DCO 频率是：\n$$DCO_{obs} = \\frac{N_{DCO}}{N} = \\frac{20}{1180}$$\n期望的 DCO 频率，假设两个区间的交换事件是独立的，是它们各自重组频率的乘积：\n$$DCO_{exp} = R.F._{AB} \\times R.F._{BC} = \\left(\\frac{200}{1180}\\right) \\times \\left(\\frac{200}{1180}\\right) = \\frac{40000}{1392400}$$\n因此，并发系数 $C$ 是：\n$$C = \\frac{DCO_{obs}}{DCO_{exp}} = \\frac{20/1180}{(200/1180) \\times (200/1180)} = \\frac{20 \\times 1180}{200 \\times 200} = \\frac{23600}{40000} = 0.59$$\n干涉 $I$ 定义为：\n$$I = 1 - C$$\n$$I = 1 - 0.59 = 0.41$$\n按要求四舍五入到四位有效数字，得到 $I = 0.4100$。\n\n最终结果是图距 $d_{AB} = 16.95 \\text{ cM}$、$d_{BC} = 16.95 \\text{ cM}$ 和干涉 $I = 0.4100$。", "answer": "$$\\boxed{\\begin{pmatrix} 16.95  16.95  0.4100 \\end{pmatrix}}$$", "id": "2817779"}]}