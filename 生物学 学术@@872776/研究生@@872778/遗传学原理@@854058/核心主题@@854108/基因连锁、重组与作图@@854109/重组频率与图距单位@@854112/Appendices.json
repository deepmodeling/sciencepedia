{"hands_on_practices": [{"introduction": "遗传图谱构建的基石在于对特定杂交后代数据的分析。该练习超越了基础的计算，引入了重组率中真实存在的生物学复杂性——异交叉性（heterochiasmy），即重组率在不同性别间的差异。通过处理来自互交实验的数据，本题旨在锻炼您从原始实验结果中审慎解读和精确计算连锁距离的能力 [@problem_id:1472893]。", "problem": "在一个小鼠遗传学研究项目中，研究了两个连锁的常染色体基因。第一个基因控制毛皮质地，其中“Velvet”等位基因（$V$）对“normal”等位基因（$v$）为显性。第二个基因影响尾巴长度，其中“Short-tail”等位基因（$S$）对“long-tail”等位基因（$s$）为显性。\n\n为了产生杂合子群体，将一个具有天鹅绒毛和长尾的纯系小鼠与一个具有正常毛和短尾的纯系小鼠进行杂交。得到的F1代小鼠均为两个基因的杂合子，然后将它们与一个对两种性状均为纯合隐性（正常毛，长尾）的测交系进行一系列相互测交。这些测交的后代计数如下所示。\n\n**杂交1：** F1雌性 $\\times$ 测交系雄性（`vvss`）\n-   天鹅绒毛、长尾后代：412\n-   正常毛、短尾后代：408\n-   天鹅绒毛、短尾后代：93\n-   正常毛、长尾后代：87\n\n**杂交2：** F1雄性 $\\times$ 测交系雌性（`vvss`）\n-   天鹅绒毛、长尾后代：435\n-   正常毛、短尾后代：441\n-   天鹅绒毛、短尾后代：62\n-   正常毛、长尾后代：62\n\n在许多物种中，两性之间重组率的差异，这种现象被称为异交叉性（heterochiasmy），导致了性别特异性的遗传图距。计算`V`基因和`S`基因之间区间内，雌性特异性遗传图距与雄性特异性遗传图距的比率。将您的最终答案四舍五入到三位有效数字。", "solution": "目标是根据给定的测交数据计算性别特异性重组频率，然后求出相应遗传图距的比率。以厘摩（cM）为单位的遗传图距在数值上等于以百分比表示的重组频率。因此，图距的比率等于重组频率的比率。\n\n首先，我们必须识别亲本型和重组型的后代类别。F1代是通过将纯系天鹅绒毛、长尾品系（$VVss$）与纯系正常毛、短尾品系（$vvSS$）杂交产生的。得到的F1代杂合子基因型为$VvSs$。重要的是，这些F1个体的连锁相是排斥相（或反式），意味着亲本染色体携带的等位基因是$Vs$和$vS$。\n\n测交涉及一个F1代杂合子（$VvSs$）和一个纯合隐性测交亲本（$vvss$）。测交后代的表型直接揭示了由杂合F1亲本提供的配子中的等位基因组合。\n\n-   **亲本型配子** 来自F1亲本，为$Vs$和$vS$。它们产生具有以下表型的后代：\n    -   天鹅绒毛、长尾（$Vvss$）\n    -   正常毛、短尾（$vvSs$）\n-   **重组型配子** 来自F1亲本，为$VS$和$vs$。它们是由两个基因之间的交换事件形成的，并产生具有以下表型的后代：\n    -   天鹅绒毛、短尾（$VvSs$）\n    -   正常毛、长尾（$vvss$）\n\n现在，我们可以计算每个性别的重组频率。重组频率（RF）定义为：\n$$\n\\text{RF} = \\frac{\\text{Number of recombinant progeny}}{\\text{Total number of progeny}}\n$$\n\n**步骤1：计算雌性重组频率（$RF_{female}$）。**\n我们使用杂交1的数据，其中F1亲本为雌性。\n\n-   重组型后代数量 = (天鹅绒毛、短尾数量) + (正常毛、长尾数量)\n    $$\n    N_{\\text{recombinant, female}} = 93 + 87 = 180\n    $$\n-   亲本型后代数量 = (天鹅绒毛、长尾数量) + (正常毛、短尾数量)\n    $$\n    N_{\\text{parental, female}} = 412 + 408 = 820\n    $$\n-   杂交1中的后代总数：\n    $$\n    N_{\\text{total, female}} = N_{\\text{recombinant, female}} + N_{\\text{parental, female}} = 180 + 820 = 1000\n    $$\n-   雌性重组频率为：\n    $$\n    RF_{female} = \\frac{180}{1000} = 0.18\n    $$\n\n**步骤2：确定雌性特异性遗传图距。**\n遗传图距是以厘摩为单位表示的重组频率。\n$$\n\\text{Map distance}_{female} = 0.18 \\times 100 = 18 \\text{ cM}\n$$\n\n**步骤3：计算雄性重组频率（$RF_{male}$）。**\n我们使用杂交2的数据，其中F1亲本为雄性。\n\n-   重组型后代数量 = (天鹅绒毛、短尾数量) + (正常毛、长尾数量)\n    $$\n    N_{\\text{recombinant, male}} = 62 + 62 = 124\n    $$\n-   亲本型后代数量 = (天鹅绒毛、长尾数量) + (正常毛、短尾数量)\n    $$\n    N_{\\text{parental, male}} = 435 + 441 = 876\n    $$\n-   杂交2中的后代总数：\n    $$\n    N_{\\text{total, male}} = N_{\\text{recombinant, male}} + N_{\\text{parental, male}} = 124 + 876 = 1000\n    $$\n-   雄性重组频率为：\n    $$\n    RF_{male} = \\frac{124}{1000} = 0.124\n    $$\n\n**步骤4：确定雄性特异性遗传图距。**\n$$\n\\text{Map distance}_{male} = 0.124 \\times 100 = 12.4 \\text{ cM}\n$$\n\n**步骤5：计算雌性与雄性图距的比率。**\n问题要求计算雌性特异性遗传图距与雄性特异性遗传图距的比率。\n$$\n\\text{Ratio} = \\frac{\\text{Map distance}_{female}}{\\text{Map distance}_{male}} = \\frac{18 \\text{ cM}}{12.4 \\text{ cM}}\n$$\n由于单位（cM）相互抵消，这等同于重组频率的比率：\n$$\n\\text{Ratio} = \\frac{RF_{female}}{RF_{male}} = \\frac{0.18}{0.124} \\approx 1.4516129...\n$$\n\n**步骤6：四舍五入最终答案。**\n问题要求将答案四舍五入到三位有效数字。\n$$\n\\text{Ratio} \\approx 1.45\n$$", "answer": "$$\\boxed{1.45}$$", "id": "1472893"}, {"introduction": "在根据数据计算出重组率后，理解连接这些比率与染色体上物理距离的理论模型便至关重要。本练习深入探讨了交换事件的基础随机模型——泊松过程，要求您从第一性原理出发推导一个核心关系。这有助于您从随机过程的层面，对遗传距离的真正含义建立更深刻的直觉 [@problem_id:2798154]。", "problem": "一个臂内染色体倒位杂合子携带一个倒位片段，其遗传图距为 $g$ 摩尔根（Morgan），其中 1 摩尔根对应于在该图距上每次减数分裂预期发生一次交换。为近似计算该倒位的减数分裂后果，采用标准模型，即遗传图上的交换作为遗传长度上的齐次泊松过程的点发生，具有独立增量和每摩尔根 1 次的恒定速率。仅使用齐次泊松过程的定义性质和遗传长度作为预期交换数的解释，推导出一个关于 $g$ 的显式闭式表达式，表示在单次减数分裂中倒位片段内至少发生一次交换的概率。请以 $g$ 的单个简化解析表达式的形式给出最终答案。不需要数值近似。", "solution": "令 $N$ 为表示在倒位染色体片段内发生交换次数的随机变量。该片段的长度以遗传图距给出，为 $g$ 摩尔根。\n\n问题陈述指出，沿遗传图的交换被建模为具有恒定速率的齐次泊松过程。该过程的速率 $\\lambda$ 是每单位长度（摩尔根）的预期事件（交换）数。摩尔根遗传图距的定义恰好是每次减数分裂的预期交换数。因此，长度为 1 摩尔根对应于 1 次交换的期望值。这直接意味着泊松过程的速率为 $\\lambda = 1$ 次交换/摩尔根。\n\n对于在长度为 $L$ 的区间上，速率为 $\\lambda$ 的齐次泊松过程，该区间内的事件数 $N$ 服从参数（均值）为 $\\mu = \\lambda L$ 的泊松分布。在此问题中，“区间”是长度为 $g$ 摩尔根的遗传片段。因此，我们有 $L = g$ 和 $\\lambda = 1$。\n\n长度为 $g$ 的片段中交换次数 $N$ 的泊松分布参数为：\n$$ \\mu = \\lambda \\times g = 1 \\times g = g $$\n此结果与摩尔根遗传距离的基本定义一致。\n\n均值为 $\\mu = g$ 的泊松分布随机变量 $N$ 的概率质量函数（PMF）由下式给出：\n$$ P(N=k) = \\frac{\\mu^k \\exp(-\\mu)}{k!} = \\frac{g^k \\exp(-g)}{k!} $$\n其中 $k$ 是一个非负整数（$k=0, 1, 2, \\ldots$），代表交换的次数。\n\n问题要求的是在倒位片段内发生*至少一次*交换的概率。这是概率 $P(N \\geq 1)$。更直接的计算方法是使用其互补事件，即发生*零次*交换的概率 $P(N=0)$。\n$$ P(N \\geq 1) = 1 - P(N=0) $$\n我们可以通过将 $k=0$ 代入泊松 PMF 来求得 $P(N=0)$：\n$$ P(N=0) = \\frac{g^0 \\exp(-g)}{0!} $$\n根据数学定义，任何非零数的 0 次方都为 1（即，对于 $g > 0$，$g^0 = 1$；$g=0$ 的情况是平凡的，得到概率为 0），0 的阶乘也为 1（即 $0! = 1$）。因此，该表达式简化为：\n$$ P(N=0) = \\frac{1 \\cdot \\exp(-g)}{1} = \\exp(-g) $$\n这是在长度为 $g$ 摩尔根的片段中观察到没有交换的概率。\n\n最后，将此结果代回互补事件的表达式，得到至少发生一次交换的概率：\n$$ P(N \\geq 1) = 1 - \\exp(-g) $$\n这就是所要求的、在倒位片段内至少发生一次交换的概率的显式闭式表达式，表示为其遗传图距 $g$ 的函数。这个函数也被称为 J.B.S. Haldane 的作图函数，它在无干涉的假设下，将遗传距离与重组频率联系起来。", "answer": "$$\\boxed{1 - \\exp(-g)}$$", "id": "2798154"}, {"introduction": "在实践中，遗传作图不仅是确定性的计算，更是一项统计推断工作。这最后一个练习将实验数据、理论模型和严谨的统计框架融为一体。您将推导图谱距离的最大似然估计量，并更关键地，量化其估计的不确定性——这是解读和报告任何研究发现都必不可少的核心技能 [@problem_id:2845266]。", "problem": "将一个在两个共显性基因座上杂合的二倍体生物与一个纯合隐性测试体进行杂交，并对所得后代的基因型进行计分，以便能够明确无误地识别由该杂合子贡献的重组型和非重组型配子。假设在一个包含 $n = 1000$ 个独立后代的样本中，有 $k = 150$ 个在两个基因座之间发生了重组。\n\n假设以下基本前提：\n- 每个后代反映了来自杂合子的单个减数分裂产物，并且对于每次减数分裂，重组指示变量是一个伯努利随机变量，其参数等于重组率 $r \\in (0, \\tfrac{1}{2})$。\n- 在经典的无干涉交换形成模型（Haldane模型）下，一个二价体上两个基因座之间区间内的交换服从一个齐次泊松过程，并且，在没有染色单体干涉的情况下，一条焦点染色单体以概率 $1/2$ 独立地参与每次交换。\n- 图距 $d$ 以摩根（Morgan）为单位进行测量，其中1摩根等于100厘摩（cM）。一条染色单体相对于这两个基因座是重组的，当且仅当它在该区间内经历了奇数次交换。\n\n从这些假设出发，并且不使用任何现成的作图函数恒等式，完成以下任务：\n1. 在伯努利抽样模型下，写出 $r$ 的似然函数，并推导出最大似然估计量 $\\hat{r}$。\n2. 使用交换的泊松模型和上述重组的定义，推导出连接 $r$ 和 $d$ 的函数关系，并将其反转以将 $d$ 表示为 $r$ 的函数。使用此关系求得 $\\hat{d}$。\n3. 使用大样本似然理论和一个适当的变换论证，推导出以摩根为单位的 $\\hat{d}$ 的渐近标准误的显式表达式（用 $n$ 和 $r$ 表示），然后在 $\\hat{r}$ 处对其进行求值。最后，将此标准误转换为厘摩。\n\n报告以厘摩为单位的 $\\hat{d}$ 的渐近标准误的数值。将答案四舍五入到四位有效数字。以cM为单位表示最终答案。", "solution": "该任务分为三个部分。\n\n**第一部分：$r$ 的似然函数和最大似然估计量**\n\n该实验包括对 $n = 1000$ 个独立的减数分裂产物进行抽样。每个产物要么是重组的（概率为 $r$），要么是非重组的（概率为 $1-r$）。这构成了一个包含 $n$ 次伯努利试验的序列。观察到的重组体总数 $k$ 服从二项分布。在大小为 $n$ 的样本中观察到 $k$ 个重组体的概率由下式给出：\n$$\nP(K=k | n, r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\n似然函数 $L(r)$ 与此概率成正比。我们将其写作：\n$$\nL(r) = \\binom{n}{k} r^k (1-r)^{n-k}\n$$\n为了找到最大似然估计量（MLE）$\\hat{r}$，我们需要最大化 $L(r)$。在计算上，最大化对数似然函数 $\\ell(r) = \\ln L(r)$ 更为简单：\n$$\n\\ell(r) = \\ln\\left(\\binom{n}{k}\\right) + k \\ln(r) + (n-k) \\ln(1-r)\n$$\n我们对 $\\ell(r)$ 关于 $r$ 求导，并将导数设为零：\n$$\n\\frac{d\\ell(r)}{dr} = \\frac{k}{r} - \\frac{n-k}{1-r} = 0\n$$\n求解 $r$：\n$$\n\\frac{k}{r} = \\frac{n-k}{1-r} \\implies k(1-r) = r(n-k) \\implies k - kr = nr - kr \\implies k = nr\n$$\n这给出了重组率 $r$ 的最大似然估计量：\n$$\n\\hat{r} = \\frac{k}{n}\n$$\n给定 $k = 150$ 和 $n = 1000$，估计值为：\n$$\n\\hat{r} = \\frac{150}{1000} = 0.15\n$$\n\n**第二部分：重组率 $r$ 和图距 $d$ 之间的关系**\n\n以摩根为单位的图距 $d$ 定义为在目标区间内每条染色单体上发生的交换的期望次数。在考虑二价体（包含四条染色单体的结构）上交换的标准模型下，整个二价体的平均交换次数为 $2d$。设 $X$ 为二价体上交换次数的随机变量。根据Haldane模型，$X$ 服从均值为 $2d$ 的泊松分布：\n$$\nX \\sim \\text{Poisson}(2d), \\quad P(X=x) = \\frac{\\exp(-2d)(2d)^x}{x!} \\quad \\text{for } x = 0, 1, 2, \\ldots\n$$\n如果一条给定的染色单体参与了奇数次交换，则它是重组的。在无染色单体干涉的情况下，一条染色单体以概率 $1/2$ 参与任何一次给定的交换。如果二价体上有 $x$ 次交换，我们关注的焦点染色单体参与的次数服从二项分布 $\\text{Binomial}(x, 1/2)$。在给定总共有 $x$ 次交换的情况下，它参与奇数次交换的概率在 $x=0$ 时为 $0$，在 $x > 0$ 时为 $1/2$。\n\n重组率 $r$ 是染色单体发生重组的总概率。我们通过对交换次数 $X$ 取条件来求得这个概率：\n$$\nr = P(\\text{重组}) = \\sum_{x=0}^{\\infty} P(\\text{重组} | X=x) P(X=x)\n$$\n$$\nr = P(\\text{重组} | X=0) P(X=0) + \\sum_{x=1}^{\\infty} P(\\text{重组} | X=x) P(X=x)\n$$\n$$\nr = (0) \\cdot P(X=0) + \\sum_{x=1}^{\\infty} \\left(\\frac{1}{2}\\right) P(X=x) = \\frac{1}{2} \\sum_{x=1}^{\\infty} P(X=x)\n$$\n由于 $\\sum_{x=0}^{\\infty} P(X=x) = 1$，我们有 $\\sum_{x=1}^{\\infty} P(X=x) = 1 - P(X=0)$。因此：\n$$\nr = \\frac{1}{2} (1 - P(X=0))\n$$\n对于均值为 $2d$ 的泊松分布，$P(X=0) = \\exp(-2d)$。将其代入得到Haldane作图函数：\n$$\nr = \\frac{1}{2} (1 - \\exp(-2d))\n$$\n我们必须反转这个函数，以将距离 $d$ 表示为重组率 $r$ 的函数：\n$$\n2r = 1 - \\exp(-2d) \\implies \\exp(-2d) = 1 - 2r \\implies -2d = \\ln(1-2r)\n$$\n$$\nd(r) = -\\frac{1}{2} \\ln(1 - 2r)\n$$\n根据最大似然估计量的不变性，$d$ 的最大似然估计量（MLE）是：\n$$\n\\hat{d} = d(\\hat{r}) = -\\frac{1}{2} \\ln(1 - 2\\hat{r})\n$$\n\n**第三部分：$\\hat{d}$ 的渐近标准误**\n\n我们使用delta方法来求 $\\hat{d}$ 的渐近方差。公式为：\n$$\n\\text{Var}(\\hat{d}) \\approx \\left(\\frac{d(d)}{dr}\\bigg|_{r=\\hat{r}}\\right)^2 \\text{Var}(\\hat{r})\n$$\n首先，我们求 $\\hat{r}$ 的大样本方差。单次伯努利试验的费雪信息量是 $1/(r(1-r))$。对于 $n$ 次试验，它是 $I(r) = n/(r(1-r))$。$\\hat{r}$ 的渐近方差是费雪信息量的倒数：\n$$\n\\text{Var}(\\hat{r}) \\approx \\frac{1}{I(r)} = \\frac{r(1-r)}{n}\n$$\n接下来，我们求 $d(r)$ 的导数：\n$$\n\\frac{d(d)}{dr} = \\frac{d}{dr}\\left(-\\frac{1}{2} \\ln(1-2r)\\right) = -\\frac{1}{2} \\cdot \\frac{1}{1-2r} \\cdot (-2) = \\frac{1}{1-2r}\n$$\n现在我们将这些结果结合起来，以求出 $\\hat{d}$ 的渐近方差：\n$$\n\\text{Var}(\\hat{d}) \\approx \\left(\\frac{1}{1-2r}\\right)^2 \\frac{r(1-r)}{n} = \\frac{r(1-r)}{n(1-2r)^2}\n$$\n$\\hat{d}$ 的渐近标准误是方差的平方根：\n$$\n\\text{SE}(\\hat{d}) = \\sqrt{\\frac{r(1-r)}{n(1-2r)^2}} = \\frac{\\sqrt{r(1-r)}}{(1-2r)\\sqrt{n}}\n$$\n我们在 MLE $\\hat{r} = 0.15$ 和 $n = 1000$ 处计算该表达式的值：\n$$\n\\widehat{\\text{SE}}(\\hat{d}) = \\frac{\\sqrt{0.15(1-0.15)}}{(1-2(0.15))\\sqrt{1000}} = \\frac{\\sqrt{0.15 \\cdot 0.85}}{(1-0.3)\\sqrt{1000}} = \\frac{\\sqrt{0.1275}}{0.7\\sqrt{1000}}\n$$\n计算数值：\n$$\n\\widehat{\\text{SE}}(\\hat{d}) \\approx \\frac{0.3570714}{0.7 \\cdot 31.622777} \\approx \\frac{0.3570714}{22.135944} \\approx 0.0161313 \\text{ 摩根}\n$$\n题目要求以厘摩（cM）为单位的标准误。我们使用换算关系 $1$ 摩根 $= 100$ cM：\n$$\n\\widehat{\\text{SE}}(\\hat{d})_{\\text{cM}} = \\widehat{\\text{SE}}(\\hat{d})_{\\text{Morgans}} \\times 100 \\approx 0.0161313 \\times 100 = 1.61313 \\text{ cM}\n$$\n四舍五入到四位有效数字，我们得到 $1.613$ cM。", "answer": "$$\\boxed{1.613}$$", "id": "2845266"}]}