{"hands_on_practices": [{"introduction": "理解非整倍体的发生率始于对概率论的基本掌握。此练习 [@problem_id:2832476] 提供了一种第一性原理方法，用于根据亲代双方配子中减数分裂错误的独立概率，计算群体中三体综合征的总体风险。掌握这一简单模型是理解染色体异常这一更宏观流行病学图景的第一步。", "problem": "当减数分裂不分离产生染色体拷贝数异常的配子，并与拷贝数合适的配子融合时，就会产生非整倍体合子。考虑一个随机交配种群中的某条特定染色体，并为参与所研究受孕过程的具受精能力的配子定义如下：\n- 令 $p_m$ 表示母方配子携带目标染色体二体（两个拷贝）的概率。\n- 令 $p_p$ 表示父方配子携带目标染色体二体的概率。\n\n假设：\n- 母方和父方配子的拷贝数状态在不同受孕事件中是相互独立的。\n- 携带目标染色体缺体（nullisomic）的配子对所研究的受精事件集合的贡献可忽略不计，因此，在受精的条件下，一个配子的“非二体”事件可以等同于“该目标染色体为整倍体”。\n- 双二体结合（会产生四体合子）不计为三体性。\n\n仅使用概率的乘法法则和加法法则以及三体性和二体性的定义，推导出合子为目标染色体三体的概率 $P_T$ 关于 $p_m$ 和 $p_p$ 的表达式。然后，用 $p_m = 1.5 \\times 10^{-3}$ 和 $p_p = 3.0 \\times 10^{-4}$ 计算 $P_T$ 的值。将你的数值结果四舍五入到四位有效数字，并以小数形式表示（不带百分号）。", "solution": "首先将对问题进行严格的验证。\n\n步骤1：提取已知条件。\n- 令 $p_m$ 表示母方配子是二体的概率。\n- 令 $p_p$ 表示父方配子是二体的概率。\n- 假设1：母方和父方配子的拷贝数状态是独立的。\n- 假设2：缺体配子的贡献可忽略不计。一个配子的“非二体”事件等同于“该目标染色体为整倍体”。\n- 假设3：双二体结合（形成四体合子）不计为三体性。\n- 任务1：用 $p_m$ 和 $p_p$ 推导合子为三体的概率 $P_T$。\n- 任务2：用 $p_m = 1.5 \\times 10^{-3}$ 和 $p_p = 3.0 \\times 10^{-4}$ 计算 $P_T$。\n- 任务3：将数值结果四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据。它提出了一个简化但标准且正确的模型，解释了非整倍性（特别是三体性）如何由减数分裂不分离事件引起，这是遗传学中的一个基本概念。给出的概率对于人类染色体错误是符合实际的。该问题提法恰当；它提供了使用基本概率论推导出唯一解所需的所有必要定义、假设和数据。这些假设——配子状态的独立性、缺体性的可忽略性以及三体性的特定定义——共同创建了一个清晰、自洽且可解的形式系统。该问题是客观的，并避免了任何非科学或模糊的语言。它并非简单的，因为它要求将概率的加法和乘法法则正确应用于生物学情景。因此，该问题是有效的。\n\n步骤3：结论与行动。\n问题是有效的。将提供完整的解答。\n\n目标是求出合子为三体的概率 $P_T$。一个三体合子包含三个拷贝的目标染色体。根据遗传学原理和问题陈述，这种状态是由一个二体配子（包含两个染色体拷贝）与一个整倍体配子（包含一个拷贝）融合而产生的。\n\n让我们定义相关事件：\n- $M_d$: 母方配子是二体。其概率为 $P(M_d) = p_m$。\n- $P_d$: 父方配子是二体。其概率为 $P(P_d) = p_p$。\n\n基于缺体贡献可忽略不计的假设，一个配子拷贝数的样本空间仅包含两种状态：二体（两个拷贝）或整倍体（一个拷贝）。因此，“非二体”事件即为“整倍体”事件。我们为整倍体配子定义相应事件：\n- $M_e$: 母方配子是整倍体。其概率为 $P(M_e) = 1 - P(M_d) = 1 - p_m$。\n- $P_e$: 父方配子是整倍体。其概率为 $P(P_e) = 1 - P(P_d) = 1 - p_p$。\n\n一个三体合子可以通过以下两种互斥的方式之一形成：\n1.  母方配子是二体（$M_d$）且父方配子是整倍体（$P_e$）。\n2.  母方配子是整倍体（$M_e$）且父方配子是二体（$P_d$）。\n\n问题陈述母方和父方配子的拷贝数状态是独立的。因此，我们可以使用独立事件的乘法法则 $P(A \\cap B) = P(A)P(B)$ 来计算每种情况的概率。\n\n情况1的概率：\n$P(M_d \\cap P_e) = P(M_d) \\times P(P_e) = p_m (1 - p_p)$\n\n情况2的概率：\n$P(M_e \\cap P_d) = P(M_e) \\times P(P_d) = (1 - p_m) p_p$\n\n由于这两种情况是互斥的（它们不能在同一次受精事件中同时发生），根据概率的加法法则，三体合子的总概率 $P_T$ 是它们各自概率之和。\n\n$P_T = P(M_d \\cap P_e) + P(M_e \\cap P_d)$\n$P_T = p_m(1 - p_p) + (1 - p_m)p_p$\n\n展开各项，我们得到：\n$P_T = p_m - p_m p_p + p_p - p_m p_p$\n\n合并同类项，得到 $P_T$ 的最终表达式：\n$P_T = p_m + p_p - 2 p_m p_p$\n\n这就是推导出的三体合子概率的表达式。项 $p_m p_p$ 对应于四体合子（由两个二体配子结合而成）的概率，根据问题的第三个假设，该项被正确地从定义 $P_T$ 的和中排除了。\n\n现在，我们使用给定的数值来计算这个表达式：$p_m = 1.5 \\times 10^{-3}$ 和 $p_p = 3.0 \\times 10^{-4}$。\n首先，转换为小数形式以便计算：\n$p_m = 0.0015$\n$p_p = 0.0003$\n\n将这些值代入 $P_T$ 的表达式中：\n$P_T = (1.5 \\times 10^{-3}) + (3.0 \\times 10^{-4}) - 2 (1.5 \\times 10^{-3}) (3.0 \\times 10^{-4})$\n$P_T = 0.0015 + 0.0003 - 2(0.0015)(0.0003)$\n$P_T = 0.0018 - 2(0.00000045)$\n$P_T = 0.0018 - 0.0000009$\n$P_T = 0.0017991$\n\n问题要求将结果四舍五入到四位有效数字。$0.0017991$ 中的前四位有效数字是 $1$、$7$、$9$ 和 $9$。后一位数字是 $1$，小于 $5$，所以我们不进位。\n\n最终的数值结果是 $0.001799$。", "answer": "$$\n\\boxed{0.001799}\n$$", "id": "2832476"}, {"introduction": "不分离现象的后果不仅限于染色体数目的改变，它还会影响受累染色体上基因的遗传模式。这个问题 [@problem_id:2832382] 要求您建立一个定量模型，来预测在发生第一次减数分裂不分离事件后子代的基因型。通过整合遗传重组和合子差异存活率的影响，您将更深入地理解如何利用遗传标记来追溯减数分裂的错误。", "problem": "一个二倍体个体在某条常染色体上的一个共显性标记位点上是杂合的，基因型记为 $A/a$。在该个体的某次减数分裂中，这条常染色体的同源染色体发生了一次减数第一次分裂不分离事件：两条同源染色体在减数分裂后期 I 移向同一极，而姐妹染色单体在减数第二次分裂时正常分离。假设如下：\n\n- 在减数分裂前期 I，着丝粒和标记位点之间可能发生交换。设 $\\theta$ 表示在重组结束后，一条同源染色体内的两条姐妹染色单体在标记位点上携带相反等位基因的概率（等价地，着丝粒和该位点之间发生了奇数次交换，导致两条姐妹染色单体在该标记上有所不同）。以 $1 - \\theta$ 的概率，每条同源染色体内的两条姐妹染色单体携带相同的标记等位基因。\n- 减数第二次分裂正常进行，因此本次减数分裂产生的每个二体配子都从每条同源染色体接收一条染色单体，而互补的配子则是针对该染色体的缺体配子。在这次减数第一次分裂不分离事件中，针对该染色体的二体配子比例为 $1/2$，缺体配子比例为 $1/2$。\n- 与来自标记位点为纯合 $a/a$ 的伴侣的正常单倍体配子进行随机受精。一个二体配子与伴侣的配子受精，产生一个针对该染色体的三体合子，而一个缺体配子则产生一个单体合子。\n- 针对该染色体的三体合子和单体合子的相对生存力（存活到计分阶段）分别为 $w_t$ 和 $w_m$，其中 $w_t > 0$ 且 $w_m > 0$。整倍体的生存力在此不相关，因为这次减数第一次分裂不分离事件不产生针对该染色体的整倍体配子。\n\n构建由发生不分离的亲本产生的二体和缺体配子的标记位点基因型类别，作为 $\\theta$ 的函数，然后，在随机受精和通过 $w_t$ 与 $w_m$ 进行生存力加权的条件下，推导出一个单一的闭合形式表达式，表示存活合子中在标记位点上是杂合子的预期比例（即，在其染色体拷贝中同时携带 $A$ 和 $a$）。以 $\\theta$、$w_t$ 和 $w_m$ 的简化解析表达式形式提供你的最终答案。无需进行数值计算。", "solution": "所述问题在科学上是合理的、定义明确的且客观的。这是一个关于减数分裂不分离后果的理论遗传学形式化问题。所有必要的参数和条件都已提供，以得出一个唯一解。我将开始推导。\n\n设二倍体亲本的基因型为 $A/a$。DNA复制后，细胞包含一个由四条染色单体组成的四分体：两条携带等位基因 $A$，两条携带等位基因 $a$。设两条同源染色体为 $H_A$ 和 $H_a$。复制后，$H_A$ 由两条姐妹染色单体组成，最初都携带等位基因 $A$；$H_a$ 由两条姐妹染色单体组成，最初都携带等位基因 $a$。\n\n问题将 $\\theta$ 定义为着丝粒与标记位点之间的交换事件导致姐妹染色单体携带不同等位基因的概率。这是第二次分裂分离的定义。以 $1 - \\theta$ 的概率，没有此类事件发生，这就是第一次分裂分离。我们分析这两种情况来确定配子的遗传内容。\n\n情况1：第一次分裂分离（概率为 $1 - \\theta$）。\n在这种情况下，着丝粒和位点之间没有发生有效交换。每条同源染色体的姐妹染色单体保持相同。$H_A$ 的着丝粒连接着两条 $A$ 染色单体，$H_a$ 的着丝粒连接着两条 $a$ 染色单体。\n在减数第一次分裂不分离期间，两条同源染色体 $H_A$ 和 $H_a$ 都移向同一极。这导致一个次级母细胞含有全部四条染色单体，另一个次级母细胞为缺体。\n含有四条染色单体的次级母细胞进行正常的减数第二次分裂。问题陈述，产生的二体配子各自从“每条同源染色体接收一条染色单体”。由于来自 $H_A$ 的染色单体都是 $A$，来自 $H_a$ 的都是 $a$，任何有效的分离都会产生基因型为 $A/a$ 的配子。因此，在这种情况下产生的两个二体配子都具有 $A/a$ 基因型。\n\n情况2：第二次分裂分离（概率为 $\\theta$）。\n在这种情况下，着丝粒和位点之间发生了交换。同源染色体 $H_A$ 的姐妹染色单体变为 $(A, a)$，同源染色体 $H_a$ 的姐妹染色单体变为 $(a, A)$。\n和之前一样，减数第一次分裂不分离将两条同源染色体都送往一极。在减数第二次分裂时，通过从 $H_A$ 对中取一条染色单体，从 $H_a$ 对中取一条染色单体，形成两个二体配子。产生的配子有四种等概率的组合：\n\\begin{itemize}\n    \\item 来自 $H_A$ 的染色单体 $A$ 和来自 $H_a$ 的染色单体 $a$：基因型 $A/a$。\n    \\item 来自 $H_A$ 的染色单体 $A$ 和来自 $H_a$ 的染色单体 $A$：基因型 $A/A$。\n    \\item 来自 $H_A$ 的染色单体 $a$ 和来自 $H_a$ 的染色单体 $a$：基因型 $a/a$。\n    \\item 来自 $H_A$ 的染色单体 $a$ 和来自 $H_a$ 的染色单体 $A$：基因型 $A/a$。\n\\end{itemize}\n因此，在这种情况下产生的二体配子中，基因型的比例为：$1/4$ 的 $A/A$，$1/2$ 的 $A/a$，以及 $1/4$ 的 $a/a$。\n\n结合这两种情况，我们得出由 $A/a$ 亲本产生的所有二体配子中的基因型比例。设 $P(G)$ 为基因型为 $G$ 的二体配子的比例。\n$$P(A/A) = (1 - \\theta) \\cdot 0 + \\theta \\cdot \\frac{1}{4} = \\frac{\\theta}{4}$$\n$$P(a/a) = (1 - \\theta) \\cdot 0 + \\theta \\cdot \\frac{1}{4} = \\frac{\\theta}{4}$$\n$$P(A/a) = (1 - \\theta) \\cdot 1 + \\theta \\cdot \\frac{1}{2} = 1 - \\theta + \\frac{\\theta}{2} = 1 - \\frac{\\theta}{2}$$\n这些比例的总和为 $\\frac{\\theta}{4} + \\frac{\\theta}{4} + 1 - \\frac{\\theta}{2} = 1$，这是正确的。\n\n问题陈述，二体配子的总比例为 $1/2$，缺体配子（基因型 $\\emptyset$）的比例为 $1/2$。我们现在可以写出由发生不分离的亲本产生的每种配子类型的绝对频率 $f(G)$：\n\\begin{itemize}\n    \\item $f(A/A_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(A/A) = \\frac{1}{2} \\cdot \\frac{\\theta}{4} = \\frac{\\theta}{8}$\n    \\item $f(a/a_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(a/a) = \\frac{1}{2} \\cdot \\frac{\\theta}{4} = \\frac{\\theta}{8}$\n    \\item $f(A/a_{\\text{disomic}}) = \\frac{1}{2} \\cdot P(A/a) = \\frac{1}{2} \\cdot (1 - \\frac{\\theta}{2}) = \\frac{1}{2} - \\frac{\\theta}{4}$\n    \\item $f(\\emptyset_{\\text{nullisomic}}) = \\frac{1}{2}$\n\\end{itemize}\n\n这些配子与基因型为 $a/a$ 的伴侣的配子受精，该伴侣只产生基因型为 $a$ 的正常单倍体配子。这次交配产生的合子具有以下初始频率和基因型：\n\\begin{itemize}\n    \\item 来自 $A/A$ 配子：合子 $A/A/a$ (三体)，频率 $\\frac{\\theta}{8}$。该合子为杂合子。\n    \\item 来自 $a/a$ 配子：合子 $a/a/a$ (三体)，频率 $\\frac{\\theta}{8}$。该合子为纯合隐性。\n    \\item 来自 $A/a$ 配子：合子 $A/a/a$ (三体)，频率 $\\frac{1}{2} - \\frac{\\theta}{4}$。该合子为杂合子。\n    \\item 来自 $\\emptyset$ 配子：合子 $a$ (单体)，频率 $\\frac{1}{2}$。该合子为纯合隐性。\n\\end{itemize}\n\n三体和单体合子的相对生存力分别为 $w_t$ 和 $w_m$。每种类型存活合子的频率是其初始频率乘以相应的生存力因子。\n\n存活的杂合子总频率 $W_{\\text{het}}$ 是存活的 $A/A/a$ 和 $A/a/a$ 合子频率之和：\n$$W_{\\text{het}} = \\left(\\frac{\\theta}{8}\\right) w_t + \\left(\\frac{1}{2} - \\frac{\\theta}{4}\\right) w_t = w_t \\left(\\frac{\\theta}{8} + \\frac{4 - 2\\theta}{8}\\right) = w_t \\left(\\frac{4 - \\theta}{8}\\right)$$\n\n所有存活合子的总频率 $W_{\\text{total}}$ 是所有存活类型频率之和：\n$$W_{\\text{total}} = \\underbrace{\\left[ \\left(\\frac{\\theta}{8}\\right) + \\left(\\frac{\\theta}{8}\\right) + \\left(\\frac{1}{2} - \\frac{\\theta}{4}\\right) \\right]}_{\\text{所有三体}} w_t + \\left(\\frac{1}{2}\\right) w_m$$\n三体合子的项简化为：\n$$\\left[ \\frac{2\\theta}{8} + \\frac{1}{2} - \\frac{2\\theta}{8} \\right] = \\frac{1}{2}$$\n因此，存活者的总频率为：\n$$W_{\\text{total}} = \\frac{1}{2} w_t + \\frac{1}{2} w_m = \\frac{1}{2}(w_t + w_m)$$\n\n最终要求的量是存活合子中杂合子的比例。即比率 $\\frac{W_{\\text{het}}}{W_{\\text{total}}}$。\n$$\\text{杂合子比例} = \\frac{w_t \\left(\\frac{4 - \\theta}{8}\\right)}{\\frac{1}{2}(w_t + w_m)} = \\frac{w_t (4 - \\theta)}{8} \\cdot \\frac{2}{w_t + w_m} = \\frac{w_t(4 - \\theta)}{4(w_t + w_m)}$$\n这就是最终的简化表达式。", "answer": "$$\n\\boxed{\\frac{w_t (4 - \\theta)}{4(w_t + w_m)}}\n$$", "id": "2832382"}, {"introduction": "在临床诊断和基础研究中，区分第一次减数分裂（MI）和第二次减数分裂（MII）错误是一项关键任务。这项实践 [@problem_id:2832404] 将让您沉浸在现代统计遗传学的世界中，您将构建一个贝叶斯分类器，根据单核苷酸多态性（SNP）芯片数据推断三体综合征的减数分裂起源。通过将减数分裂的分配原则与统计模型相结合，您将学会如何将原始的基因组数据转化为有意义的生物学见解。", "problem": "给定一组来自单个因不分离而受影响的染色体的三体受孕体的独立基因分型样本。每个样本都由在固定的着丝粒邻近窗口中测量的单核苷酸多态性 (SNP) 阵列衍生的特征进行概括：SNP 的总数 $n$，该窗口中纯合 SNP 的数量 $k$，该窗口中最长连续纯合片段的长度 $L$（以 SNP 数量计，为整数且 $L \\ge 1$），以及在受影响的染色体上推断出的交换总数 $K$（一个非负整数）。任务是使用一种基于似然的有原则方法，将每个样本分类为源于减数分裂I (MI) 不分离或减数分裂II (MII) 不分离。该方法基于以下基本生物学事实和统计假设：\n\n- 生物学基础：\n  - 在 MI 不分离中，同源染色体未能分离，倾向于在着丝粒处产生异二体性（不同的同源染色体），这会减少着丝粒附近的长纯合片段。在 MII 不分离中，姐妹染色单体未能分离，倾向于在着丝粒处产生同二体性（相同的染色单体），这会增加着丝粒附近的长纯合片段。\n  - 交换的形成调节染色体分离，并且可以在染色体尺度上作为计数过程进行统计建模。\n\n- 以来源为条件的统计模型和独立性假设：\n  - 先验概率：$P(\\mathrm{MI}) = 0.6$, $P(\\mathrm{MII}) = 0.4$。\n  - 着丝粒附近的纯合率：以来源 $O \\in \\{\\mathrm{MI}, \\mathrm{MII}\\}$ 为条件，$k \\mid n, O \\sim \\mathrm{Binomial}(n, \\theta_O)$，其中 $\\theta_{\\mathrm{MI}} = 0.2$ 且 $\\theta_{\\mathrm{MII}} = 0.8$。\n  - 着丝粒附近的最长纯合片段：以来源 $O$ 为条件，$L \\mid O \\sim \\mathrm{Geometric}(q_O)$，分布在 $\\{1,2,\\dots\\}$ 上，其概率质量函数为 $P(L=\\ell \\mid O) = q_O (1 - q_O)^{\\ell - 1}$，其中 $q_{\\mathrm{MI}} = 0.25$ 且 $q_{\\mathrm{MII}} = 0.07$。\n  - 受影响染色体上的交换计数：以来源 $O$ 为条件，$K \\mid O \\sim \\mathrm{Poisson}(\\mu_O)$，其中 $\\mu_{\\mathrm{MI}} = 0.8$ 且 $\\mu_{\\mathrm{MII}} = 1.6$。\n  - 条件独立性：给定来源 $O$，特征 $(k, L, K)$ 是独立的。\n\n- 分类目标：\n  - 对于每个样本，从上述先验和似然假设出发，使用贝叶斯法则计算后验概率 $P(\\mathrm{MI} \\mid \\text{data})$ 和 $P(\\mathrm{MII} \\mid \\text{data})$。如果 $P(\\mathrm{MII} \\mid \\text{data}) \\ge 0.5$，则将样本分类为 MII；否则分类为 MI。在恰好等于 $0.5$ 的情况下，倾向于 MII 来打破平局。\n\n- 实现约束和数值稳定性：\n  - 使用对数域来组合似然和先验。你可以省略不依赖于来源 $O$ 的加法常数（例如，二项分布中的 $\\log \\binom{n}{k}$ 项和泊松分布中的 $\\log(K!)$ 项），因为它们在后验比率中会抵消。\n\n测试套件：\n提供一个程序，实现上述分类器，并将其应用于以下六个样本，每个样本指定为一个元组 $(n, k, L, K)$：\n\n1. $(100, 85, 40, 2)$\n2. $(100, 20, 3, 0)$\n3. $(100, 50, 10, 1)$\n4. $(100, 30, 50, 0)$\n5. $(100, 80, 2, 3)$\n6. $(50, 25, 1, 0)$\n\n要求的最终输出格式：\n- 生成单行输出，其中包含六个样本的分类结果，形式为方括号内由逗号分隔的整数列表。使用 $0$ 表示 MI，使用 $1$ 表示 MII。例如，一个有效的输出形式为 $[c_1,c_2,c_3,c_4,c_5,c_6]$，其中每个 $c_i \\in \\{0,1\\}$。", "solution": "所提出的问题是一个有效且适定的贝叶斯分类练习，其根植于统计遗传学的原理。它具有科学依据，没有矛盾，并包含推導唯一解所需的所有信息。我将继续进行分析。\n\n目标是将由数据 $D = (n, k, L, K)$ 描述的每个样本分类为源于减数分裂I (MI) 或减数分裂II (MII) 不分离。分类规则是，如果 MII 的后验概率大于或等于 $0.5$，即 $P(\\mathrm{MII} \\mid D) \\ge 0.5$，则选择 MII，否则选择 MI。\n\n这个不等式等同于比较后验概率：\n$$P(\\mathrm{MII} \\mid D) \\ge P(\\mathrm{MI} \\mid D)$$\n使用贝叶斯定理，$P(O \\mid D) = \\frac{P(D \\mid O)P(O)}{P(D)}$，其中 $O \\in \\{\\mathrm{MI}, \\mathrm{MII}\\}$。由于分母 $P(D)$ 对两个后验概率是共同的，不等式简化为对分子的比较：\n$$P(D \\mid \\mathrm{MII})P(\\mathrm{MII}) \\ge P(D \\mid \\mathrm{MI})P(\\mathrm{MI})$$\n为了处理概率的乘积并避免数值下溢，标准做法是使用对数概率。对两边取自然对数，分类规则变为：\n$$\\log(P(D \\mid \\mathrm{MII})) + \\log(P(\\mathrm{MII})) \\ge \\log(P(D \\mid \\mathrm{MI})) + \\log(P(\\mathrm{MI}))$$\n让我们为每个来源 $O$ 定义一个分数 $S_O$，作为与后验概率成正比的对数项：\n$$S_O = \\log P(O) + \\log P(D \\mid O)$$\n规则是，如果 $S_{\\mathrm{MII}} \\ge S_{\\mathrm{MI}}$，则将样本分类为 MII，否则分类为 MI。\n\n问题指出，给定来源 $O$，特征 $k$、$L$ 和 $K$ 是条件独立的。因此，对数似然 $\\log P(D \\mid O)$ 可以表示为各个对数似然的总和：\n$$\\log P(D \\mid O) = \\log P(k \\mid n, O) + \\log P(L \\mid O) + \\log P(K \\mid O)$$\n\n如前所述，我们可以省略对数似然中相对于来源 $O$ 是常数的项，因为它们在分数比较中会抵消。让我们为每个特征定义分数的组成部分：\n\n1.  **纯合计数 ($k$)**：分布为 $k \\mid n, O \\sim \\mathrm{Binomial}(n, \\theta_O)$。概率质量函数 (PMF) 是 $P(k \\mid n, O) = \\binom{n}{k} \\theta_O^k (1-\\theta_O)^{n-k}$。对数似然为 $\\log P(k \\mid n, O) = \\log\\binom{n}{k} + k\\log(\\theta_O) + (n-k)\\log(1-\\theta_O)$。$\\log\\binom{n}{k}$ 项与 $O$ 无关，可以舍去。相关部分是：\n    $$\\log \\mathcal{L}_k(O) = k\\log(\\theta_O) + (n-k)\\log(1-\\theta_O)$$\n\n2.  **最长纯合片段 ($L$)**：分布为 $L \\mid O \\sim \\mathrm{Geometric}(q_O)$，定义在 $\\{1, 2, \\dots\\}$ 上。PMF 是 $P(L \\mid O) = q_O(1-q_O)^{L-1}$。对数似然为：\n    $$\\log \\mathcal{L}_L(O) = \\log(q_O) + (L-1)\\log(1-q_O)$$\n\n3.  **交换计数 ($K$)**：分布为 $K \\mid O \\sim \\mathrm{Poisson}(\\mu_O)$。PMF 是 $P(K \\mid O) = \\frac{e^{-\\mu_O}\\mu_O^K}{K!}$。对数似然为 $\\log P(K \\mid O) = -\\mu_O + K\\log(\\mu_O) - \\log(K!)$。$\\log(K!)$ 项与 $O$ 无关，可以舍去。相关部分是：\n    $$\\log \\mathcal{L}_K(O) = -\\mu_O + K\\log(\\mu_O)$$\n    注意，如果 $K=0$，该项正确地计算为 $-\\mu_O$。\n\n结合这些部分，来源 $O$ 的总分为：\n$$S_O = \\log P(O) + \\log \\mathcal{L}_k(O) + \\log \\mathcal{L}_L(O) + \\log \\mathcal{L}_K(O)$$\n\n提供的参数是：\n-   **先验概率**：$P(\\mathrm{MI}) = 0.6$, $P(\\mathrm{MII}) = 0.4$。\n-   **MI 参数**：$\\theta_{\\mathrm{MI}} = 0.2$, $q_{\\mathrm{MI}} = 0.25$, $\\mu_{\\mathrm{MI}} = 0.8$。\n-   **MII 参数**：$\\theta_{\\mathrm{MII}} = 0.8$, $q_{\\mathrm{MII}} = 0.07$, $\\mu_{\\mathrm{MII}} = 1.6$。\n\n对于每个测试样本 $(n, k, L, K)$，我们将计算 $S_{\\mathrm{MI}}$ 和 $S_{\\mathrm{MII}}$ 并应用决策规则。MI 的分类将被编码为 $0$，MII 编码为 $1$。\n\n样本1的计算示例：$(n, k, L, K)=(100, 85, 40, 2)$\n\n**MI 的分数：**\n$S_{\\mathrm{MI}} = \\log(0.6) + [85\\log(0.2) + (100-85)\\log(0.8)] + [\\log(0.25) + (40-1)\\log(0.75)] + [-0.8 + 2\\log(0.8)]$\n$S_{\\mathrm{MI}} \\approx -0.5108 + [85(-1.6094) + 15(-0.2231)] + [-1.3863 + 39(-0.2877)] + [-0.8 + 2(-0.2231)]$\n$S_{\\mathrm{MI}} \\approx -0.5108 - 140.15 - 12.61 - 1.25 \\approx -154.52$\n\n**MII 的分数：**\n$S_{\\mathrm{MII}} = \\log(0.4) + [85\\log(0.8) + (100-85)\\log(0.2)] + [\\log(0.07) + (40-1)\\log(0.93)] + [-1.6 + 2\\log(1.6)]$\n$S_{\\mathrm{MII}} \\approx -0.9163 + [85(-0.2231) + 15(-1.6094)] + [-2.6593 + 39(-0.0726)] + [-1.6 + 2(0.4700)]$\n$S_{\\mathrm{MII}} \\approx -0.9163 - 43.11 - 5.49 - 0.66 \\approx -50.18$\n\n由于 $S_{\\mathrm{MII}} (-50.18) \\ge S_{\\mathrm{MI}} (-154.52)$，样本1的分类是 MII ($1$)。此过程在实现中系统地应用于所有提供的样本。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the classification problem for non-disjunction events based on a Bayesian model.\n    \"\"\"\n\n    # Define the statistical parameters for Meiosis I (MI) and Meiosis II (MII)\n    params = {\n        'MI': {\n            'prior': 0.6,\n            'theta': 0.2,  # Binomial parameter for homozygosity\n            'q': 0.25,     # Geometric parameter for run of homozygosity\n            'mu': 0.8,     # Poisson parameter for crossover count\n        },\n        'MII': {\n            'prior': 0.4,\n            'theta': 0.8,\n            'q': 0.07,\n            'mu': 1.6,\n        },\n    }\n\n    # Pre-compute log of parameters for efficiency and clarity\n    log_params = {\n        'MI': {\n            'log_prior': np.log(params['MI']['prior']),\n            'log_theta': np.log(params['MI']['theta']),\n            'log_1_minus_theta': np.log(1 - params['MI']['theta']),\n            'log_q': np.log(params['MI']['q']),\n            'log_1_minus_q': np.log(1 - params['MI']['q']),\n            'mu': params['MI']['mu'],\n            'log_mu': np.log(params['MI']['mu']),\n        },\n        'MII': {\n            'log_prior': np.log(params['MII']['prior']),\n            'log_theta': np.log(params['MII']['theta']),\n            'log_1_minus_theta': np.log(1 - params['MII']['theta']),\n            'log_q': np.log(params['MII']['q']),\n            'log_1_minus_q': np.log(1 - params['MII']['q']),\n            'mu': params['MII']['mu'],\n            'log_mu': np.log(params['MII']['mu']),\n        },\n    }\n\n    # Test suite of samples, each specified as (n, k, L, K)\n    test_cases = [\n        (100, 85, 40, 2),\n        (100, 20, 3, 0),\n        (100, 50, 10, 1),\n        (100, 30, 50, 0),\n        (100, 80, 2, 3),\n        (50, 25, 1, 0),\n    ]\n\n    def calculate_score(sample_data, origin):\n        \"\"\"\n        Calculates the log-posterior proportional score for a given origin (MI or MII).\n        \"\"\"\n        n, k, L, K = sample_data\n        p = log_params[origin]\n\n        # Log likelihood from homozygosity count (Binomial model)\n        # log_L_k = k * log(theta) + (n-k) * log(1-theta)\n        log_lk_k = k * p['log_theta'] + (n - k) * p['log_1_minus_theta']\n\n        # Log likelihood from longest run of homozygosity (Geometric model)\n        # log_L_L = log(q) + (L-1) * log(1-q)\n        log_lk_L = p['log_q'] + (L - 1) * p['log_1_minus_q']\n\n        # Log likelihood from crossover count (Poisson model)\n        # log_L_K = -mu + K * log(mu)\n        # The term K*log(mu) is 0 if K=0.\n        log_lk_K = -p['mu'] + (K * p['log_mu'] if K > 0 else 0)\n\n        # Total score is sum of log prior and log likelihoods\n        score = p['log_prior'] + log_lk_k + log_lk_L + log_lk_K\n        return score\n\n    results = []\n    for case in test_cases:\n        # Calculate scores for both MI and MII hypotheses\n        score_mi = calculate_score(case, 'MI')\n        score_mii = calculate_score(case, 'MII')\n\n        # Classify as MII if its score is greater or equal, MI otherwise.\n        # MII is coded as 1, MI as 0.\n        if score_mii >= score_mi:\n            results.append(1)  # MII\n        else:\n            results.append(0)  # MI\n            \n    # Print results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2832404"}]}