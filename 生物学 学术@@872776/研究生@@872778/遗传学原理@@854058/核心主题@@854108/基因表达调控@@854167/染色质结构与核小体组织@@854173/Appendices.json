{"hands_on_practices": [{"introduction": "DNA双螺旋缠绕在组蛋白八聚体上时，其旋转朝向至关重要，这决定了DNA的哪个面（大沟或小沟）朝外，哪个面与组蛋白接触。这种精确的几何排布是理解核小体结构与功能的基础。本练习 ([@problem_id:2797169]) 将通过一个基础计算，帮助你掌握DNA螺旋周期如何决定核小体关键接触点的旋转相位，从而深化对核小体内部精细结构的理解。", "problem": "一个核小体核心颗粒将大约两圈B型脱氧核糖核酸（DNA）缠绕在一个组蛋白八聚体上。设二重对称轴碱基对为旋转相位的原点，并将其旋转设定定义为角度 $0$ （弧度）。在B型DNA中，螺旋重复周期为 $h = 10.5$ 个碱基对每圈，因此每前进一个碱基对，DNA的方位角会均匀地增加一整圈的 $1/h$。超螺旋位置（SHL）$n$ 标记了沿DNA缠绕路径上周期性的、小沟朝内的接触位点，并且在一个非常好的近似下，这些位点出现在距离二重对称轴 $s(n) \\approx 10 n$ 的碱基对偏移处。假设在本计算中，相邻SHL整数之间的这个 $10$ 碱基对间距是精确成立的。\n\n将在碱基对偏移 $s$ 处的旋转设定定义为相对于二重对称轴均匀前进所获得的方位角 $\\theta(s)$，并将其对一整圈取模，得到 $[0,2\\pi)$ 区间内的主值。仅使用这些定义和 $h=10.5$，计算在SHL $-5$、SHL $-2$、SHL $+2$ 和SHL $+5$ 处与DNA接触的残基的预期旋转设定（以弧度为单位），并按此顺序排列。将您的最终答案表示为 $\\pi$ 的精确有理数倍，每个值都简化到区间 $[0,2\\pi)$ 内，并将这四个值以单行矩阵的形式报告。", "solution": "首先将对问题的科学性和逻辑完整性进行验证。\n\n从题目陈述中提取的已知条件如下：\n- DNA是B型的。\n- 二重对称轴碱基对是原点，其旋转设定为 $0$ 弧度。\n- 螺旋重复周期为 $h = 10.5$ 个碱基对每圈。\n- 每前进一个碱基对，方位角会均匀增加一整圈的 $\\frac{1}{h}$。\n- 超螺旋位置（SHL）由一个整数 $n$ 表示。\n- 对于给定的SHL $n$，其距离二重对称轴的碱基对偏移 $s$ 由精确关系 $s(n) = 10n$ 给出。\n- 在偏移 $s$ 处的旋转设定 $\\theta(s)$ 是相对于二重对称轴的总方位角，对一整圈取模后得到主值范围 $[0, 2\\pi)$。\n- 任务是计算 $n \\in \\{-5, -2, +2, +5\\}$ 时 $\\theta(s(n))$ 的值。\n\n该问题具有科学依据，提法明确且客观。它基于DNA结构及其在染色质中组织的既定原理，特别是DNA缠绕组蛋白八聚体形成核小体的过程。所提供的参数，例如 $h = 10.5$ bp/turn，是溶液中B型DNA的标准教科书值。模型 $s(n) = 10n$ 是描述核小体核心颗粒中DNA接触几何形状的一个常用且有用的简化。该问题是自洽的，提供了推导出唯一、有意义解所需的所有信息。其中没有矛盾、歧义或逻辑谬误。因此，该问题被认定为有效，并将提供解答。\n\nDNA螺旋的旋转相位随着其序列位置的变化而均匀前进。一个完整的 $360$ 度旋转，对应 $2\\pi$ 弧度，发生在 $h = 10.5$ 个碱基对的长度上。因此，每个碱基对的角度增量 $\\Delta\\theta_{\\text{bp}}$ 为：\n$$\n\\Delta\\theta_{\\text{bp}} = \\frac{2\\pi}{h} = \\frac{2\\pi}{10.5} = \\frac{2\\pi}{\\frac{21}{2}} = \\frac{4\\pi}{21} \\text{ 弧度/碱基对}\n$$\n在距离二重对称轴（此处角度定义为 $0$）的碱基对偏移 $s$ 处的旋转设定 $\\theta(s)$ 是累积的角度，必须将其简化到主区间 $[0, 2\\pi)$。这是一个取模运算。\n$$\n\\theta(s) = (s \\cdot \\Delta\\theta_{\\text{bp}}) \\pmod{2\\pi}\n$$\n问题规定，对于给定的SHL $n$，碱基对偏移 $s$ 取为 $s(n) = 10n$。将这个关系和 $\\Delta\\theta_{\\text{bp}}$ 的表达式代入 $\\theta(s)$ 的方程，我们得到旋转设定作为SHL指数 $n$ 的函数：\n$$\n\\theta(n) = \\left( (10n) \\cdot \\frac{4\\pi}{21} \\right) \\pmod{2\\pi} = \\left( \\frac{40n\\pi}{21} \\right) \\pmod{2\\pi}\n$$\n我们现在为每个要求的SHL指数 $n$ 计算这个值。\n\n对于 SHL $n = -5$：\n总角度为 $\\frac{40(-5)\\pi}{21} = -\\frac{200\\pi}{21}$。\n为了找到在区间 $[0, 2\\pi)$ 内的等效角，我们必须加上 $2\\pi$ 的整数倍。我们可以将 $-\\frac{200}{21}$ 写为 $-9 - \\frac{11}{21}$。因此，角度是 $-9\\pi - \\frac{11\\pi}{21}$。不，这不是最清晰的方法。我们直接进行模运算。\n$$\n-\\frac{200\\pi}{21} = -\\frac{(10 \\cdot 21 - 10)\\pi}{21} = -\\frac{210\\pi}{21} + \\frac{10\\pi}{21} = -5 \\cdot (2\\pi) + \\frac{10\\pi}{21}\n$$\n主值是正余数。\n$$\n\\theta(-5) = \\frac{10\\pi}{21}\n$$\n\n对于 SHL $n = -2$：\n总角度为 $\\frac{40(-2)\\pi}{21} = -\\frac{80\\pi}{21}$。\n我们进行模运算：\n$$\n-\\frac{80\\pi}{21} = -\\frac{(4 \\cdot 21 - 4)\\pi}{21} = -\\frac{84\\pi}{21} + \\frac{4\\pi}{21} = -2 \\cdot (2\\pi) + \\frac{4\\pi}{21}\n$$\n主值是正余数。\n$$\n\\theta(-2) = \\frac{4\\pi}{21}\n$$\n\n对于 SHL $n = +2$：\n总角度为 $\\frac{40(2)\\pi}{21} = \\frac{80\\pi}{21}$。\n我们进行模运算：\n$$\n\\frac{80\\pi}{21} = \\frac{(1 \\cdot 42 + 38)\\pi}{21} = \\frac{42\\pi}{21} + \\frac{38\\pi}{21} = 1 \\cdot (2\\pi) + \\frac{38\\pi}{21}\n$$\n余数是主值。\n$$\n\\theta(+2) = \\frac{38\\pi}{21}\n$$\n\n对于 SHL $n = +5$：\n总角度为 $\\frac{40(5)\\pi}{21} = \\frac{200\\pi}{21}$。\n我们进行模运算：\n$$\n\\frac{200\\pi}{21} = \\frac{(4 \\cdot 42 + 32)\\pi}{21} = \\frac{168\\pi}{21} + \\frac{32\\pi}{21} = 4 \\cdot (2\\pi) + \\frac{32\\pi}{21}\n$$\n余数是主值。\n$$\n\\theta(+5) = \\frac{32\\pi}{21}\n$$\n按指定顺序（SHL $-5$、SHL $-2$、SHL $+2$、SHL $+5$），四个所需的旋转设定分别为 $\\frac{10\\pi}{21}$、$\\frac{4\\pi}{21}$、$\\frac{38\\pi}{21}$ 和 $\\frac{32\\pi}{21}$ 弧度。所有值都在区间 $[0, 2\\pi)$ 内，因为 $2\\pi = \\frac{42\\pi}{21}$。最终结果必须以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{10\\pi}{21}  \\frac{4\\pi}{21}  \\frac{38\\pi}{21}  \\frac{32\\pi}{21} \\end{pmatrix}}\n$$", "id": "2797169"}, {"introduction": "核小体不仅是DNA的包装单元，更是基因调控的关键参与者。通过与转录因子等蛋白竞争结合DNA，核小体的稳定性直接影响了基因的可及性与表达水平。本练习 ([@problem_id:2797130]) 引导你应用统计力学的基本原理，建立一个简化的热力学模型，来量化分析由组蛋白乙酰化等修饰引起的核小体稳定性变化，如何显著改变转录因子的结合概率。", "problem": "一个启动子被一个定位的核小体所遮蔽，该核小体与一个DNA结合转录因子（TF）竞争。假设存在以下生物学和物理学框架。\n\n- 该启动子在热平衡状态下存在两种相互排斥的宏观态：无核小体的可及状态（状态 $\\mathrm{O}$）和有核小体结合的不可及状态（状态 $\\mathrm{N}$）。设 $\\mathrm{N}$ 和 $\\mathrm{O}$ 之间的自由能差为 $\\Delta G_{\\mathrm{nuc}}$（因此 $\\mathrm{N}$ 相对于 $\\mathrm{O}$ 的统计权重为 $\\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$），其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- 在状态 $\\mathrm{O}$ 下，TF可以结合到其位点上，其条件占有率（给定可及性）为 $f_{\\mathrm{TF}}$，该值取决于TF浓度和TF-DNA亲和力，但不受组蛋白乙酰化的影响。在状态 $\\mathrm{N}$ 下，假设TF位点是不可及的。\n- 组蛋白乙酰化修饰了核小体-DNA相互作用，使得核小体结合自由能增加了 $\\Delta\\Delta G = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} - \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} = +1.5\\,k_{B}T$（也就是说，乙酰化通过降低其结合的有利程度来破坏核小体结合的稳定性）。\n- 在乙酰化前，体系处于强核小体遮蔽状态，即 $\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$，因此启动子的可及性是TF占有率的限制因素。\n\n使用平衡统计力学和上述假设，推导TF占有率的预期倍数变化（乙酰化后与乙酰化前的比率），并对 $\\Delta\\Delta G = 1.5\\,k_{B}T$ 的情况进行数值计算。将倍数变化表示为一个纯数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求推导和计算组蛋白乙酰化后，转录因子（TF）在启动子位点占有率的倍数变化。该系统使用平衡统计力学进行建模。\n\n**问题验证**\n\n首先，我对问题陈述进行严格的验证。\n\n1.  **提取已知条件**：明确提供的信息如下：\n    *   启动子有两个宏观态：可及态（O）和核小体结合态（N）。\n    *   系统处于热平衡状态。\n    *   状态 N 和状态 O 之间的自由能差为 $\\Delta G_{\\mathrm{nuc}}$。\n    *   状态 N 相对于状态 O 的统计权重为 $\\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$。\n    *   在状态 O 中，条件TF占有率为 $f_{\\mathrm{TF}}$。该量与组蛋白乙酰化无关。\n    *   在状态 N 中，TF位点是不可及的。\n    *   组蛋白乙酰化使核小体结合自由能改变了 $\\Delta\\Delta G = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} - \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} = +1.5\\,k_{B}T$。\n    *   在乙酰化之前，系统处于强核小体遮蔽状态，数学上表述为 $\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$。\n\n2.  **使用提取的已知条件进行验证**：该问题具有科学依据，采用统计力学（玻尔兹曼分布）的标准原理来模拟一个已充分理解的生物学现象（启动子处的竞争性结合）。问题提法清晰，所有必要的参数和条件都已定义，可以得出一个唯一的解。语言客观而精确。问题陈述没有表现出任何科学上不健全、不完整或模棱两可的缺陷。\n\n3.  **结论与行动**：该问题被判定为有效。我将继续推导解决方案。\n\n**求解推导**\n\nTF 的总占有率，记作 $\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle$，是系统处于 TF 与其 DNA 位点结合状态的概率。根据问题描述，这只可能在启动子处于可及状态 O 时发生。因此，TF 占有率是启动子可及的概率 $P(\\mathrm{O})$ 与给定启动子可及条件下 TF 结合的条件概率 $f_{\\mathrm{TF}}$ 的乘积。\n\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle = P(\\mathrm{O}) \\times f_{\\mathrm{TF}}\n$$\n\n概率 $P(\\mathrm{O})$ 由开放状态 O 和核小体遮蔽状态 N 之间的热平衡决定。我们可以为这两个状态定义一个配分函数 $Z$。通过将参考状态 O 的自由能设为零，$G_{\\mathrm{O}} = 0$，其统计权重为 $w_{\\mathrm{O}} = \\exp(-G_{\\mathrm{O}}/(k_{B}T)) = 1$。状态 N 的自由能是 $G_{\\mathrm{N}} = \\Delta G_{\\mathrm{nuc}}$，所以其权重是 $w_{\\mathrm{N}} = \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))$。\n\n配分函数是权重的总和：\n$$\nZ = w_{\\mathrm{O}} + w_{\\mathrm{N}} = 1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))\n$$\n\n启动子处于可及状态 O 的概率是状态 O 的权重除以配分函数：\n$$\nP(\\mathrm{O}) = \\frac{w_{\\mathrm{O}}}{Z} = \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))}\n$$\n\n我们现在可以将 TF 占有率写为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}/(k_{B}T))} \\right)\n$$\n\n问题要求的是占有率的倍数变化，即乙酰化后的占有率与乙酰化前的占有率之比。\n\n乙酰化前（未修饰）的占有率为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{unmod}} = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))} \\right)\n$$\n\n乙酰化后的占有率为：\n$$\n\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{acetyl}} = f_{\\mathrm{TF}} \\left( \\frac{1}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}}/(k_{B}T))} \\right)\n$$\n\n倍数变化是比率 $\\frac{\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{acetyl}}}{\\langle\\mathrm{Occ}_{\\mathrm{TF}}\\rangle_{\\mathrm{unmod}}}$。因子 $f_{\\mathrm{TF}}$ 被消去。\n$$\n\\text{Fold-Change} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}}/(k_{B}T))}\n$$\n\n我们已知 $\\Delta G_{\\mathrm{nuc}}^{\\mathrm{acetyl}} = \\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} + \\Delta\\Delta G$。让我们将此关系代入倍数变化的表达式中。\n$$\n\\text{Fold-Change} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-(\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}} + \\Delta\\Delta G)/(k_{B}T))} = \\frac{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))}{1 + \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))\\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n现在我们应用强遮蔽条件，$\\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T)) \\gg 1$。我们用 $X = \\exp(-\\Delta G_{\\mathrm{nuc}}^{\\mathrm{unmod}}/(k_{B}T))$ 来表示这个很大的量。\n表达式变为：\n$$\n\\text{Fold-Change} = \\frac{1 + X}{1 + X \\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n由于 $X \\gg 1$，我们可以在 $X \\to \\infty$ 的极限下分析此表达式。为了形式化地做到这一点，我们将分子和分母同时除以 $X$：\n$$\n\\text{Fold-Change} = \\frac{\\frac{1}{X} + 1}{\\frac{1}{X} + \\exp(-\\Delta\\Delta G/(k_{B}T))}\n$$\n\n取 $X \\to \\infty$ 的极限，项 $\\frac{1}{X}$ 趋近于 0。表达式简化为：\n$$\n\\text{Fold-Change} \\approx \\frac{0 + 1}{0 + \\exp(-\\Delta\\Delta G/(k_{B}T))} = \\frac{1}{\\exp(-\\Delta\\Delta G/(k_{B}T))} = \\exp(\\Delta\\Delta G/(k_{B}T))\n$$\n这是在指定极限条件下倍数变化的最终解析表达式。\n\n**数值计算**\n\n我们已知 $\\Delta\\Delta G = +1.5\\,k_{B}T$。将其代入推导出的表达式中：\n$$\n\\text{Fold-Change} = \\exp\\left(\\frac{1.5\\,k_{B}T}{k_{B}T}\\right) = \\exp(1.5)\n$$\n数值计算如下：\n$$\n\\exp(1.5) \\approx 4.48168907 \\dots\n$$\n根据要求，四舍五入到四位有效数字：\n$$\n\\text{Fold-Change} \\approx 4.482\n$$\n$\\Delta\\Delta G$ 的正值表明乙酰化破坏了核小体结合的稳定性，使启动子更易于接近。这导致 TF 占有率增加，因此预期倍数变化大于 1，这与我们的结果一致。", "answer": "$$\\boxed{4.482}$$", "id": "2797130"}, {"introduction": "理论模型为我们理解染色质结构提供了框架，而高通量测序技术则让我们能够大规模地观察这些结构。ATAC-seq是绘制全基因组染色质可及性图谱的有力工具，但从原始测序片段中提取生物学信息是一项计算挑战。本练习 ([@problem_id:2797038]) 将让你扮演一名计算生物学家的角色，设计并实现一个核心算法，用于处理ATAC-seq数据，从而精确地定位启动子下游的$+$1核小体，并计算核小体耗竭区（NDR）的宽度。", "problem": "设计并实现一个程序，该程序根据启动子周围的测序法分析转座酶可及性染色质 (ATAC-seq) 双末端片段，依据染色质结构和核小体组织的基本原理计算两个量：(i) 相对于转录起始位点 (TSS) 的第一个下游核小体二分体的位置，下文称为正一核小体二分体；(ii) 以 TSS 为中心的核小体耗尽区 (NDR) 的宽度。您的实现必须基于以下基本且广为接受的事实：(a) 腺苷三磷酸 (ATP) 依赖性转座酶优先插入到可及性脱氧核糖核酸 (DNA) 中，而 ATAC-seq 双末端片段反映了染色质的可及性区域；(b) 单核小体保护大约 $147$ 个碱基对 (bp) 的 DNA，因此 ATAC-seq 片段长度在单核小体长度附近的模式反映了核小体的占据情况；(c) 核小体二分体是核小体 DNA 缠绕的中心，可以用核小体大小片段的中心来近似；(d) 正一核小体是 TSS 下游的第一个核小体；(e) 启动子处的 NDR 表现为 TSS 周围核小体占据的一个低谷。\n\n您必须将计算形式化如下。\n\n- 输入模型。给定一个有限的双末端片段列表，每个片段表示为相对于 $x=0$ 处 TSS 的整数坐标轴上的一个半开基因组区间 $[s_i, e_i)$，单位为碱基对 (bp)，其中 $s_i$ 和 $e_i$ 是整数且 $s_i  e_i$。片段 $i$ 的长度为 $\\ell_i = e_i - s_i$，其中心为 $c_i = (s_i + e_i)/2$（可能为非整数）。此外，还给定一个用于分析的基因组窗口 $[x_{\\min}, x_{\\max}]$，一个用于筛选核小体大小片段的单核小体长度范围 $[L_{\\min}, L_{\\max}]$（单位 bp），一个高斯平滑带宽 $\\sigma  0$（单位 bp），一个阈值分数 $\\alpha \\in (0,1)$，以及一个用于搜索正一核小体的搜索区间 $[x_a, x_b]$（单位 bp）。\n\n- 核小体中心密度。令 $\\mathcal{N} = \\{ i \\mid L_{\\min} \\le \\ell_i \\le L_{\\max} \\}$ 为核小体大小片段的集合。在整数网格 $x_k \\in \\{ x_{\\min}, x_{\\min}+1, \\dots, x_{\\max} \\}$ 上，定义平滑核小体中心密度为\n$$\nD(x_k) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x_k - c_i)^2}{2\\sigma^2} \\right).\n$$\n\n- 正一核小体二分体。定义正一核小体二分体估计值 $x^\\star$ 为搜索区间内使 $D(x)$ 最大化的位置：\n$$\nx^\\star \\;=\\; \\operatorname*{arg\\,max}_{x_k \\in [x_a, x_b] \\cap \\mathbb{Z}} \\; D(x_k),\n$$\n若有多个最大值，则选择最小的 $x_k$。将 $x^\\star$ 报告为相对于 TSS 的整数，单位为 bp。\n\n- 核小体耗尽区宽度。令\n$$\n\\theta \\;=\\; \\alpha \\cdot \\max_{x_k \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z}} D(x_k).\n$$\n形成集合 $\\mathcal{Z} = \\{ x_k \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z} \\,:\\, D(x_k) \\le \\theta \\}$。考虑 $\\mathcal{Z}$ 中包含 $x=0$ 的连通分量（相对于整数网格上的单位步长）；如果没有这样的分量包含 $0$，则定义 NDR 宽度为 $0$。否则，如果这个连通分量由连续的网格点 $\\{ x_{i_0}, x_{i_0+1}, \\dots, x_{i_1} \\}$ 组成，且 $x_{i_0} \\le 0 \\le x_{i_1}$，则定义 NDR 宽度为\n$$\nw \\;=\\; (i_1 - i_0 + 1) \\times 1 \\;\\text{bp}.\n$$\n将 $w$ 报告为以碱基对为单位的整数。\n\n实现一个严格遵循上述定义的算法。仅使用提供的片段和参数。所有答案必须以碱基对 (bp) 为单位表示为整数。\n\n测试套件。使用以下四个测试用例。每个测试用例提供 $[x_{\\min}, x_{\\max}]$, $[L_{\\min}, L_{\\max}]$, $\\sigma$, $\\alpha$, $[x_a, x_b]$，以及一个以半开区间 $(s_i, e_i)$（单位 bp）表示的片段明确列表。\n\n- 用例 1（正常路径，下游有清晰的正一峰且 NDR 定义明确）：\n    - 窗口: $x_{\\min} = -300$, $x_{\\max} = 400$。\n    - 单核小体长度范围: $L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽: $\\sigma = 10$。\n    - 阈值分数: $\\alpha = 0.25$。\n    - 正一搜索范围: $x_a = 20$, $x_b = 250$。\n    - 片段 $(s_i, e_i)$:\n    $$\n    \\big[\n    (-20,130),\\,(-15,135),\\,(-13,137),\\,(-17,133),\\,(-10,140),\\,(-16,134),\\;\n    (-245,-95),\\,(-235,-85),\\,(-240,-90),\\,(-247,-97),\\;\n    (140,290),\\,(145,295),\\,(150,300),\\;\n    (-55,-5),\\,(-35,15),\\,(-25,25),\\,(-15,35),\\,(-5,45)\n    \\big].\n    $$\n\n- 用例 2（边界情况：在正一搜索范围内没有核小体大小的片段）：\n    - 窗口: $x_{\\min} = -200$, $x_{\\max} = 200$。\n    - 单核小体长度范围: $L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽: $\\sigma = 8$。\n    - 阈值分数: $\\alpha = 0.20$。\n    - 正一搜索范围: $x_a = 20$, $x_b = 180$。\n    - 片段 $(s_i, e_i)$:\n    $$\n    \\big[\n    (-205,-55),\\,(-195,-45),\\,(-185,-35),\\;\n    (-45,5),\\,(-30,20),\\,(-20,30),\\,(-5,45)\n    \\big].\n    $$\n\n- 用例 3（下游核小体占据强且 NDR 较窄）：\n    - 窗口: $x_{\\min} = -200$, $x_{\\max} = 300$。\n    - 单核小体长度范围: $L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽: $\\sigma = 12$。\n    - 阈值分数: $\\alpha = 0.30$。\n    - 正一搜索范围: $x_a = 20$, $x_b = 250$。\n    - 片段 $(s_i, e_i)$:\n    $$\n    \\big[\n    (-185,-35),\\,(-175,-25),\\,(-165,-15),\\;\n    (60,210),\\,(65,215),\\,(70,220),\\,(75,225),\\,(67,217),\\;\n    (-65,85),\\;\n    (-40,10),\\,(-25,25),\\,(-10,40)\n    \\big].\n    $$\n\n- 用例 4（边缘情况：完全核小体耗尽，只有短片段）：\n    - 窗口: $x_{\\min} = -200$, $x_{\\max} = 200$。\n    - 单核小体长度范围: $L_{\\min} = 120$, $L_{\\max} = 200$。\n    - 高斯带宽: $\\sigma = 10$。\n    - 阈值分数: $\\alpha = 0.10$。\n    - 正一搜索范围: $x_a = 20$, $x_b = 180$。\n    - 片段 $(s_i, e_i)$:\n    $$\n    \\big[\n    (-55,-5),\\,(-35,15),\\,(-25,25),\\,(-15,35),\\,(5,55)\n    \\big].\n    $$\n\n最终输出格式。您的程序应生成单行输出，其中包含四个测试用例的结果，格式为方括号括起来的逗号分隔列表，每个测试用例的结果是一个双元素列表 $[x^\\star, w]$。例如，打印\n$[ [x^\\star_1,w_1], [x^\\star_2,w_2], [x^\\star_3,w_3], [x^\\star_4,w_4] ]$\n，不含任何额外文本，且 $x^\\star_j$ 和 $w_j$ 均以碱基对 (bp) 为单位表示为整数。", "solution": "我们被要求根据启动子转录起始位点 (TSS) 相关的测序法分析转座酶可及性染色质 (ATAC-seq) 双末端片段，计算两个量：正一核小体二分体的位置和核小体耗尽区 (NDR) 的宽度。该解决方案必须基于染色质生物学中的核心定义和经过充分检验的事实，并以计算机可确定性执行的算法形式表达。\n\n原理基础。\n\n- 片段类别反映染色质结构。在 ATAC-seq 中，转座酶优先插入可及性脱氧核糖核酸 (DNA)。单核小体保护的 DNA 跨度约为 $147$ 个碱基对 (bp)，因此长度在 $147$ bp 附近（例如 $[120, 200]$ bp）的双末端片段富集了单核小体的足迹。这些片段的中心近似于核小体二分体的位置。短片段（例如 $[35,100]$ bp）富集在开放染色质中，但在本问题中，我们不直接依赖短片段；相反，我们通过模拟单核小体信号的缺失来定义核小体耗尽区。\n\n- 核小体占据作为平滑中心密度。给定核小体大小片段的中心 $c_i$，位置 $x$ 处的局部占据情况可以通过使用带宽为 $\\sigma$ 的高斯核进行核密度估计来建模：\n$$\nD(x) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x - c_i)^2}{2\\sigma^2} \\right),\n$$\n其中 $\\mathcal{N}$索引了核小体大小的片段。这是一种经过充分检验的方法，可以通过平滑控制噪声，从离散的中心点获得占据情况的连续代理。\n\n- 正一核小体二分体。根据定义，正一核小体是 TSS 下游的第一个核小体。在实践中，我们扫描下游区间 $[x_a, x_b]$ 并找到 $D(x)$ 的最大值，若有多个最大值则返回最小的坐标：\n$$\nx^\\star \\;=\\; \\operatorname*{arg\\,max}_{x \\in [x_a, x_b]} D(x).\n$$\n离散化到整数网格上可以得到唯一的整数值结果。\n\n- 核小体耗尽区宽度。NDR 是 TSS 周围核小体占据的低谷。为了使其精确且可单元测试，我们在分析窗口 $[x_{\\min}, x_{\\max}]$ 内，将其平滑占据值在其最大值的一小部分 $\\alpha$ 处设置阈值：\n$$\n\\theta \\;=\\; \\alpha \\cdot \\max_{x \\in [x_{\\min}, x_{\\max}]} D(x).\n$$\n然后我们收集集合 $\\mathcal{Z} = \\{ x \\in [x_{\\min}, x_{\\max}] \\cap \\mathbb{Z} : D(x) \\le \\theta \\}$ 并取包含 $x=0$ 的连通分量（在一维整数格点的邻接关系中）。如果没有分量包含 $0$，根据定义 NDR 宽度为 $0$。否则，如果该分量在单位间隔整数网格上跨越索引 $i_0$ 到 $i_1$，则以碱基对为单位的宽度是\n$$\nw \\;=\\; (i_1 - i_0 + 1) \\times 1\\ \\text{bp}.\n$$\n这个定义将概念上的“低谷”映射为一个精确的、从 TSS 周围的零至低核小体密度推导出的整数值长度。\n\n算法设计。\n\n- 步骤 1：解析输入。对于每个测试用例，读取 $[x_{\\min}, x_{\\max}]$, $[L_{\\min}, L_{\\max}]$, $\\sigma$, $\\alpha$, $[x_a, x_b]$ 以及半开区间片段 $(s_i, e_i)$ 的列表。\n\n- 步骤 2：计算片段长度 $\\ell_i = e_i - s_i$ 和中心 $c_i = (s_i + e_i)/2$。\n\n- 步骤 3：选择核小体大小的片段 $\\mathcal{N} = \\{ i : L_{\\min} \\le \\ell_i \\le L_{\\max} \\}$。\n\n- 步骤 4：构建整数网格 $x_k \\in \\{ x_{\\min}, x_{\\min}+1, \\dots, x_{\\max} \\}$，并评估\n$$\nD(x_k) \\;=\\; \\sum_{i \\in \\mathcal{N}} \\exp\\!\\left( -\\frac{(x_k - c_i)^2}{2\\sigma^2} \\right)\n$$\n通过直接求和进行计算，这对于此处指定的小型合成数据集是数值稳定的。\n\n- 步骤 5：通过在 $x_k \\in [x_a, x_b] \\cap \\mathbb{Z}$ 上最大化 $D(x_k)$ 来找到正一核小体二分体 $x^\\star$，若有多个最大值则取最小的 $x_k$。由于网格是整数值的且 $\\sigma  0$，得到的 $x^\\star$ 是以碱基对为单位的整数。\n\n- 步骤 6：在整个分析网格上计算 $\\theta = \\alpha \\cdot \\max_k D(x_k)$。为 $\\mathcal{Z}$ 构建布尔掩码，其中 $D(x_k) \\le \\theta$。确定索引 $k_0$ 使得 $x_{k_0} = 0$ (TSS)。如果 $D(0)  \\theta$（即在阈值下 TSS 不在低占据区域），则设 $w=0$。否则，从 $k_0$ 向左和向右扩展，同时保持在 $\\mathcal{Z}$ 内，以找到包含 $k_0$ 的最大连续索引 $i_0$ 和 $i_1$。计算 NDR 宽度为 $w = (i_1 - i_0 + 1)$，单位为碱基对。\n\n- 步骤 7：输出格式化。对于四个测试用例，将双元素列表 $[x^\\star, w]$ 汇总到一个列表中，并将其作为带有整数条目的方括号、逗号分隔列表打印在一行上，不含额外文本。\n\n科学现实性与测试套件。\n\n- 用例 1 包括上游（负一核小体）、下游约 $+60$ bp 处（正一核小体）以及更下游（正二核小体）的强单核小体大小片段簇，以及 TSS 附近的短片段。当 $\\sigma = 10$ 且 $\\alpha = 0.25$ 时，约 $+60$ bp 处的占据峰在正一搜索区域 $[20,250]$ 中占主导地位，NDR 跨越了 $0$ bp 周围的一个低占据低谷，其边界是朝向上游和下游核小体方向逐渐升高的占据水平。\n\n- 用例 2 在 $[20,180]$ 范围内缺少核小体大小的片段，因此 $D(x)$ 在该区域基本平坦且接近于零；平局决胜规则选择了允许的最小坐标 $x^\\star = 20$。NDR 宽度很大，因为在 TSS 附近 $D(x)$ 从未超过低阈值 $\\theta$。\n\n- 用例 3 展示了在约 $+140$ bp 处有一个强的下游簇，在 $+10$ bp 附近有一个弱的核小体，在 $-100$ bp 附近有一个上游簇。当 $\\sigma = 12$ 且 $\\alpha = 0.30$ 时，$D(x)$ 在 $[20,250]$ 中的最大值出现在约 $+140$ bp 的簇附近，并且由于 $+10$ bp 附近占据水平升高， $0$ bp 周围的 NDR 比用例 1 中更窄。\n\n- 用例 4 完全不包含核小体大小的片段。因此 $D(x) \\equiv 0$，$\\theta = 0$，NDR 是整个窗口，其宽度等于 $[x_{\\min}, x_{\\max}]$ 中的整数位置数，即 $(x_{\\max} - x_{\\min} + 1)$ 碱基对。$[20,180]$ 中的正一核小体二分体通过平局决胜规则设置为 $x^\\star = 20$。\n\n所有计算均以碱基对 (bp) 为单位并报告为整数。程序完全按照定义评估高斯和以及集合操作，确保每个测试用例的数值输出仅由提供的输入和参数决定，没有任何启发式捷径。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef gaussian_density(grid, centers, sigma):\n    if len(centers) == 0:\n        return np.zeros_like(grid, dtype=float)\n    # Compute D(x) = sum_i exp(-(x - c_i)^2 / (2 sigma^2))\n    D = np.zeros_like(grid, dtype=float)\n    inv_two_sigma2 = 1.0 / (2.0 * (sigma ** 2))\n    for c in centers:\n        D += np.exp(-((grid - c) ** 2) * inv_two_sigma2)\n    return D\n\ndef plus_one_dyad(grid, D, xa, xb):\n    # Restrict to search window\n    mask = (grid = xa)  (grid = xb)\n    sub_idx = np.nonzero(mask)[0]\n    if sub_idx.size == 0:\n        # No positions to search; define behavior: return xa as fallback\n        return int(xa)\n    D_sub = D[sub_idx]\n    # Argmax with tie-breaking to smallest x: numpy.argmax returns first occurrence\n    rel_idx = int(np.argmax(D_sub))\n    idx = int(sub_idx[rel_idx])\n    return int(grid[idx])\n\ndef ndr_width(grid, D, alpha):\n    # Threshold and contiguous component containing x=0\n    Dmax = float(np.max(D)) if D.size  0 else 0.0\n    theta = alpha * Dmax\n    mask_low = (D = theta)\n    # Find index closest to x=0 (should be exact if 0 in grid)\n    zero_idx = int(np.argmin(np.abs(grid - 0)))\n    if not mask_low[zero_idx]:\n        return 0\n    # Expand left\n    i0 = zero_idx\n    while i0 - 1 = 0 and mask_low[i0 - 1]:\n        i0 -= 1\n    # Expand right\n    i1 = zero_idx\n    n = grid.size\n    while i1 + 1  n and mask_low[i1 + 1]:\n        i1 += 1\n    # Width equals number of integer grid points in component (1 bp per point)\n    width_bp = (i1 - i0 + 1)\n    return int(width_bp)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (xmin, xmax, Lmin, Lmax, sigma, alpha, xa, xb, fragments)\n    test_cases = [\n        # Case 1\n        {\n            \"xmin\": -300, \"xmax\": 400,\n            \"Lmin\": 120, \"Lmax\": 200,\n            \"sigma\": 10.0, \"alpha\": 0.25,\n            \"xa\": 20, \"xb\": 250,\n            \"fragments\": [\n                (-20,130),(-15,135),(-13,137),(-17,133),(-10,140),(-16,134),\n                (-245,-95),(-235,-85),(-240,-90),(-247,-97),\n                (140,290),(145,295),(150,300),\n                (-55,-5),(-35,15),(-25,25),(-15,35),(-5,45)\n            ],\n        },\n        # Case 2\n        {\n            \"xmin\": -200, \"xmax\": 200,\n            \"Lmin\": 120, \"Lmax\": 200,\n            \"sigma\": 8.0, \"alpha\": 0.20,\n            \"xa\": 20, \"xb\": 180,\n            \"fragments\": [\n                (-205,-55),(-195,-45),(-185,-35),\n                (-45,5),(-30,20),(-20,30),(-5,45)\n            ],\n        },\n        # Case 3\n        {\n            \"xmin\": -200, \"xmax\": 300,\n            \"Lmin\": 120, \"Lmax\": 200,\n            \"sigma\": 12.0, \"alpha\": 0.30,\n            \"xa\": 20, \"xb\": 250,\n            \"fragments\": [\n                (-185,-35),(-175,-25),(-165,-15),\n                (60,210),(65,215),(70,220),(75,225),(67,217),\n                (-65,85),\n                (-40,10),(-25,25),(-10,40)\n            ],\n        },\n        # Case 4\n        {\n            \"xmin\": -200, \"xmax\": 200,\n            \"Lmin\": 120, \"Lmax\": 200,\n            \"sigma\": 10.0, \"alpha\": 0.10,\n            \"xa\": 20, \"xb\": 180,\n            \"fragments\": [\n                (-55,-5),(-35,15),(-25,25),(-15,35),(5,55)\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        xmin = case[\"xmin\"]; xmax = case[\"xmax\"]\n        Lmin = case[\"Lmin\"]; Lmax = case[\"Lmax\"]\n        sigma = case[\"sigma\"]; alpha = case[\"alpha\"]\n        xa = case[\"xa\"]; xb = case[\"xb\"]\n        frags = case[\"fragments\"]\n\n        # Compute lengths and centers\n        starts = np.array([s for s, _ in frags], dtype=float)\n        ends = np.array([e for _, e in frags], dtype=float)\n        lengths = ends - starts\n        centers = (starts + ends) / 2.0\n\n        # Select nucleosome-sized fragments\n        nuc_mask = (lengths = Lmin)  (lengths = Lmax)\n        nuc_centers = centers[nuc_mask]\n\n        # Build grid and density\n        grid = np.arange(xmin, xmax + 1, dtype=float)\n        D = gaussian_density(grid, nuc_centers, sigma)\n\n        # Compute plus-one dyad\n        dyad = plus_one_dyad(grid, D, xa, xb)\n\n        # Compute NDR width\n        width = ndr_width(grid, D, alpha)\n\n        results.append([int(dyad), int(width)])\n\n    # Final print statement in the exact required format (no spaces).\n    def format_list(obj):\n        if isinstance(obj, list):\n            return '[' + ','.join(format_list(e) for e in obj) + ']'\n        elif isinstance(obj, (int, np.integer)):\n            return str(int(obj))\n        elif isinstance(obj, (float, np.floating)):\n            # Ensure integer-like floats are printed without trailing .0 if ever present\n            if float(obj).is_integer():\n                return str(int(obj))\n            else:\n                return repr(float(obj))\n        else:\n            return repr(obj)\n\n    print(format_list(results))\n\nsolve()\n```", "id": "2797038"}]}