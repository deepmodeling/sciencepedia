{"hands_on_practices": [{"introduction": "精确的术语是科学交流的基石。系统发育学中的“支序”（clade）概念有着严格的数学定义。本练习旨在超越对“类群”的直观理解，要求你严格应用关于单系群、并系群和多系群的形式化定义 [@problem_id:2760582]。通过这种方式，你将培养在系统发育思想中至关重要的严谨性。", "problem": "考虑一个有根系统发育树，其叶节点集合为 $L=\\{A,B,C,D\\}$，有根拓扑结构为 $T=(((A,B),C),D)$，其中根节点连接到 $D$ 以及后代为 $\\{A,B,C\\}$ 的内部分支节点。使用以下基于树的标准定义。对于有根树中的任意节点 $v$，令 $D(v)$ 表示 $v$ 的后代叶节点集合。如果存在一个节点 $v$ 使得 $S=D(v)$，则称子集 $S\\subseteq L$ 为单系群（一个支序）。如果存在一个节点 $v$ 及其 $k\\ge 1$ 个后代节点的有限集合 $v_1,\\dots,v_k$，使得 $S=D(v)\\setminus \\bigcup_{i=1}^k D(v_i)$，则称子集 $S\\subseteq L$ 为并系群。如果一个子集 $S\\subseteq L$ 相对于给定的有根树不能表示为上述两种形式中的任何一种，则称其为多系群。\n\n仅使用这些定义和拓扑结构 $T$，对以下每个子集进行分类：$\\{A,B\\}$、$\\{A,C\\}$、$\\{A,B,C\\}$ 和 $\\{B,C,D\\}$。\n\n选择唯一一个按所列顺序正确分类所有四个子集的选项：\n\nA. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是并系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。\n\nB. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是多系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。\n\nC. $\\{A,B\\}$ 是并系群；$\\{A,C\\}$ 是多系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。\n\nD. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是并系群；$\\{A,B,C\\}$ 是并系群；$\\{B,C,D\\}$ 是多系群。\n\nE. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是单系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   **叶节点集合：** $L=\\{A,B,C,D\\}$\n-   **有根拓扑结构：** $T=(((A,B),C),D)$\n-   **根节点位置：** 根节点连接到叶节点 $D$ 以及后代为 $\\{A,B,C\\}$ 的内部分支节点。\n-   **单系群（支序）的定义：** 如果存在一个树中的节点 $v$ 使得 $S=D(v)$，其中 $D(v)$ 是 $v$ 的后代叶节点集合，则称子集 $S\\subseteq L$ 为单系群。\n-   **并系群的定义：** 如果存在一个节点 $v$ 及其 $k\\ge 1$ 个后代节点的有限集合 $v_1,\\dots,v_k$，使得 $S=D(v)\\setminus \\bigcup_{i=1}^k D(v_i)$，则称子集 $S\\subseteq L$ 为并系群。\n-   **多系群的定义：** 如果一个子集 $S\\subseteq L$ 既不是单系群也不是并系群，则称其为多系群。\n-   **任务：** 对四个子集 $\\{A,B\\}$、$\\{A,C\\}$、$\\{A,B,C\\}$ 和 $\\{B,C,D\\}$ 进行分类。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题为系统发育树提供了一个清晰、数学上定义明确的结构，并为单系群、并系群和多系群提供了精确的集合论定义。以 Newick 格式给出的拓扑结构 $T=(((A,B),C),D)$ 与根的描述一致。该问题是自洽的，其科学基础是支序分类学的原理，并且问题提法是适定的。问题陈述本身没有矛盾、歧义或缺失信息。该任务是所提供定义的直接应用。\n\n### 步骤 3：结论与行动\n问题是有效的。将通过严格应用给定的定义到指定的树拓扑结构来推导解决方案。\n\n### 求解过程\n首先，我们必须精确理解树 $T=(((A,B),C),D)$ 的结构。\n我们用以下符号表示树的节点：\n-   $l_A, l_B, l_C, l_D$ 是对应于分类单元 $A, B, C, D$ 的叶节点。\n-   $v_1$ 是代表 $A$ 和 $B$ 最近共同祖先 (MRCA) 的内部分支节点。\n-   $v_2$ 是代表 $\\{A,B\\}$ 和 $C$ 的 MRCA 的内部分支节点。\n-   $v_3$ 是根节点，代表 $\\{A,B,C\\}$ 和 $D$ 的 MRCA。\n\n每个非叶节点的后代叶节点集合为：\n-   $D(v_1) = \\{A, B\\}$\n-   $D(v_2) = \\{A, B, C\\}$\n-   $D(v_3) = \\{A, B, C, D\\}$\n包含多个分类单元的所有可能的单系群（支序）为 $\\{A, B\\}$、$\\{A, B, C\\}$ 和 $\\{A, B, C, D\\}$。集合 $\\{A\\}, \\{B\\}, \\{C\\}, \\{D\\}$ 也显然是单系群。\n\n我们现在使用提供的定义对四个指定的子集进行分类，假设单系群的分类优先于并系群。\n\n**1. 子集 $\\{A,B\\}$ 的分类**\n根据定义，如果一个集合是某个节点的所有后代叶节点的集合，则该集合是单系群。集合 $\\{A,B\\}$ 是节点 $v_1$ 的所有后代叶节点的集合。\n因此，$\\{A,B\\}$ 是 **单系群**。\n\n**2. 子集 $\\{A,C\\}$ 的分类**\n_是单系群吗？_ 不是。在树 $T$ 中没有一个节点的完整后代叶节点集合是 $\\{A,C\\}$。\n_是并系群吗？_ 如果一个集合 $S$ 可以表示为 $S = D(v) \\setminus \\bigcup_{i=1}^k D(v_i)$，则它是并系群。\n我们选择节点 $v = v_2$。其后代叶节点为 $D(v_2) = \\{A, B, C\\}$。\n为了得到 $\\{A,C\\}$，我们必须移除分类单元 $B$。分类单元 $B$ 对应于叶节点 $l_B$，其后代集合是 $D(l_B) = \\{B\\}$。节点 $l_B$ 是 $v_2$ 的一个后代。\n我们可以设置 $k=1$ 和 $v_1 = l_B$。表达式变为 $D(v_2) \\setminus D(l_B) = \\{A, B, C\\} \\setminus \\{B\\} = \\{A,C\\}$。\n这个构造精确地匹配了并系群的定义。\n因此，根据问题中提供的定义，集合 $\\{A,C\\}$ 是 **并系群**。它不是多系群，因为多系群的定义仅适用于那些不能被描述为单系群或并系群的集合。\n\n**3. 子集 $\\{A,B,C\\}$ 的分类**\n集合 $\\{A,B,C\\}$ 是节点 $v_2$ 的所有后代叶节点的集合。\n因此，$\\{A,B,C\\}$ 是 **单系群**。\n\n**4. 子集 $\\{B,C,D\\}$ 的分类**\n_是单系群吗？_ 不是。在树 $T$ 中没有一个节点的完整后代叶节点集合是 $\\{B,C,D\\}$。\n_是并系群吗？_ 我们检查该集合是否可以通过减法定义形成。\n我们选择根节点 $v = v_3$。其后代叶节点为 $D(v_3) = \\{A, B, C, D\\}$。\n为了得到 $\\{B,C,D\\}$，我们必须移除分类单元 $A$。分类单元 $A$ 对应于叶节点 $l_A$，其后代集合是 $D(l_A) = \\{A\\}$。节点 $l_A$ 是根节点 $v_3$ 的一个后代。\n我们设置 $k=1$ 和 $v_1 = l_A$。表达式变为 $D(v_3) \\setminus D(l_A) = \\{A, B, C, D\\} \\setminus \\{A\\} = \\{B,C,D\\}$。\n这个构造匹配了并系群的定义。\n因此，$\\{B,C,D\\}$ 是 **并系群**。\n\n**分类总结：**\n-   $\\{A,B\\}$: 单系群\n-   $\\{A,C\\}$: 并系群\n-   $\\{A,B,C\\}$: 单系群\n-   $\\{B,C,D\\}$: 并系群\n\n这个分类序列是：单系群，并系群，单系群，并系群。\n\n### 逐项分析\n\n-   **A. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是并系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。**\n    此选项与我们为所有四个子集推导出的分类相匹配。\n    结论：**正确**。\n\n-   **B. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是多系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。**\n    此选项错误地将 $\\{A,C\\}$ 分类为多系群。如前所述，$\\{A,C\\}$ 可以根据问题中并系群的定义来构建。\n    结论：**错误**。\n\n-   **C. $\\{A,B\\}$ 是并系群；$\\{A,C\\}$ 是多系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。**\n    此选项错误地分类了 $\\{A,B\\}$。集合 $\\{A,B\\}$ 是一个支序，因此是单系群，而不是并系群。\n    结论：**错误**。\n\n-   **D. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是并系群；$\\{A,B,C\\}$ 是并系群；$\\{B,C,D\\}$ 是多系群。**\n    此选项错误地将 $\\{A,B,C\\}$ 分类为并系群。它是一个支序，因此是单系群。它还错误地将 $\\{B,C,D\\}$ 分类为多系群，而实际上它可以被构建为并系群。\n    结论：**错误**。\n\n-   **E. $\\{A,B\\}$ 是单系群；$\\{A,C\\}$ 是单系群；$\\{A,B,C\\}$ 是单系群；$\\{B,C,D\\}$ 是并系群。**\n    此选项错误地将 $\\{A,C\\}$ 分类为单系群。如已确定，它不是一个支序。\n    结论：**错误**。\n\n根据所提供的正式定义，唯一正确分类所有四个子集的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2760582"}, {"introduction": "在明确了什么是支序之后，下一步就是如何从数据中推断它们。本练习将引导你应用最大简约法原则，这是一种经典且直观的系统发育推断方法 [@problem_id:2760542]。你将使用Fitch算法来计算给定系统发育树的“简约性得分”，并识别出作为支序证据的共有衍征。", "problem": "给定一个包含五个分类单元的有根系统发育树，其拓扑结构为 (((A,B),(C,D)),E)，其中根节点是分类单元 E 与包含 A、B、C 和 D 的分支之间的分歧点。考虑在树梢观察到的两个独立、等权重、二元、无序的形态特征（两个位点）。观察到的状态如下：\n- 位点 $1$：A 的状态为 $1$，B 的状态为 $1$，C 的状态为 $0$，D 的状态为 $0$，E 的状态为 $0$。\n- 位点 $2$：A 的状态为 $1$，B 的状态为 $0$，C 的状态为 $1$，D 的状态为 $0$，E 的状态为 $0$。\n\n使用最大简约法（MP）原理，假设状态变化为无序且成本相等，并应用 Fitch 算法计算给定有根树上每个位点的简约分数（即树上状态变化的最小次数）。基于与给定根节点一致的最小变化重构，识别该树上哪些分支（若有）是由共有衍征（在单一分支上出现并被所有后代保留的共享衍生状态）支持的。你可以假设根节点的状态是根据 MP 从树梢的数据推断出来的。\n\n最后，仅以单个整数形式报告两个位点的总简约分数。无需四舍五入，不涉及单位。请从简约法、分支和共有衍征识别的基本原理出发解释你的推理过程，不要使用任何快捷公式或计算工具。", "solution": "该问题是有效的。它在科学上基于系统发育系统学的原理，特别是最大简约法（MP）。问题陈述清晰，提供了明确的树拓扑结构、五个分类单元在两个位点上无歧义的特征状态数据，以及一组精确的任务。术语如“支序 (clade)”、“共有衍征 (synapomorphy)”和“Fitch 算法”在演化生物学中是标准术语。所给数据是自洽的，足以推导出简约分数的唯一解。\n\n最大简约法原理指出，最优的演化假说是解释观察数据所需演化变化（例如，特征状态转变）次数最少的那一个。Fitch 算法是一种两遍扫描法，用于在给定的树拓扑结构上为给定特征计算这个最小变化数（简约分数）。\n\n设内部节点表示如下：$N_1$ 是分类单元 $A$ 和 $B$ 的最近共同祖先（MRCA）。$N_2$ 是分类单元 $C$ 和 $D$ 的最近共同祖先。$N_3$ 是分支 $(A,B,C,D)$ 的最近共同祖先。树的根节点 $R$ 是所有五个分类单元的最近共同祖先，代表分类单元 $E$ 和分支 $(A,B,C,D)$ 之间的分歧点。树的拓扑结构为 $(((A,B)N_1, (C,D)N_2)N_3, E)R$。\n\n我们将对每个位点独立应用 Fitch 算法。\n\n**位点 $1$ 的分析**\n\n位点 $1$ 在树梢（叶节点）观察到的状态是：$A:1, B:1, C:0, D:0, E:0$。\n\nFitch 算法包含两个步骤：一个自下而上的扫描（阶段 $1$），用于确定可能的祖先状态集和简约分数；以及一个自上而下的扫描（阶段 $2$），用于为内部节点分配具体状态。\n\n阶段 $1$（自下而上）：\n对于每个内部节点，我们计算一个潜在状态集。如果其两个直接后代的状态集有非空交集，则父节点的状态集就是这个交集。如果交集为空，则父节点的状态集是后代状态集的并集，并且简约分数加 $1$。\n\n1.  节点 $N_1$（$A$ 和 $B$ 的祖先）：状态集分别为 $A$ 的 $\\{1\\}$ 和 $B$ 的 $\\{1\\}$。交集为 $\\{1\\} \\cap \\{1\\} = \\{1\\}$。因此，$N_1$ 的状态集是 $\\{1\\}$。分数保持为 $0$。\n2.  节点 $N_2$（$C$ 和 $D$ 的祖先）：状态集分别为 $C$ 的 $\\{0\\}$ 和 $D$ 的 $\\{0\\}$。交集为 $\\{0\\} \\cap \\{0\\} = \\{0\\}$。因此，$N_2$ 的状态集是 $\\{0\\}$。分数保持为 $0$。\n3.  节点 $N_3$（$N_1$ 和 $N_2$ 的祖先）：状态集分别为 $N_1$ 的 $\\{1\\}$ 和 $N_2$ 的 $\\{0\\}$。交集为 $\\{1\\} \\cap \\{0\\} = \\emptyset$。交集为空，因此我们取并集 $\\{1\\} \\cup \\{0\\} = \\{0, 1\\}$ 并将分数加一。$N_3$ 的状态集是 $\\{0, 1\\}$。分数现在是 $1$。\n4.  节点 $R$（根节点，$N_3$ 和 $E$ 的祖先）：状态集分别为 $N_3$ 的 $\\{0, 1\\}$ 和 $E$ 的 $\\{0\\}$。交集为 $\\{0, 1\\} \\cap \\{0\\} = \\{0\\}$。交集不为空，因此根节点 $R$ 的状态集是 $\\{0\\}$。分数不增加。\n\n位点 $1$ 的最终简约分数，记为 $S_1$，是并集操作的总次数，即 $1$。因此，$S_1 = 1$。\n\n**位点 $2$ 的分析**\n\n位点 $2$ 在树梢观察到的状态是：$A:1, B:0, C:1, D:0, E:0$。\n\n阶段 $1$（自下而上）：\n1.  节点 $N_1$（$A$ 和 $B$ 的祖先）：状态集分别为 $A$ 的 $\\{1\\}$ 和 $B$ 的 $\\{0\\}$。交集为空。并集为 $\\{0, 1\\}$。$N_1$ 的状态集是 $\\{0, 1\\}$。分数增加到 $1$。\n2.  节点 $N_2$（$C$ 和 $D$ 的祖先）：状态集分别为 $C$ 的 $\\{1\\}$ 和 $D$ 的 $\\{0\\}$。交集为空。并集为 $\\{0, 1\\}$。$N_2$ 的状态集是 $\\{0, 1\\}$。分数增加到 $1+1=2$。\n3.  节点 $N_3$（$N_1$ 和 $N_2$ 的祖先）：状态集分别为 $N_1$ 的 $\\{0, 1\\}$ 和 $N_2$ 的 $\\{0, 1\\}$。交集为 $\\{0, 1\\} \\cap \\{0, 1\\} = \\{0, 1\\}$。交集不为空，因此 $N_3$ 的状态集是 $\\{0, 1\\}$。分数不增加。\n4.  节点 $R$（根节点，$N_3$ 和 $E$ 的祖先）：状态集分别为 $N_3$ 的 $\\{0, 1\\}$ 和 $E$ 的 $\\{0\\}$。交集为 $\\{0, 1\\} \\cap \\{0\\} = \\{0\\}$。交集不为空，因此根节点 $R$ 的状态集是 $\\{0\\}$。分数不增加。\n\n位点 $2$ 的最终简约分数，记为 $S_2$，是 $2$。\n\n**总简约分数**\n\n两个位点的总简约分数是各个分数之和：\n$$S_{total} = S_1 + S_2 = 1 + 2 = 3$$\n\n**共有衍征识别**\n\n为识别共有衍征，我们执行 Fitch 算法的阶段 $2$（自上而下扫描），为每个内部节点分配一个具体状态，从而创建一个最小变化重构。共有衍征是在一个分支的干支上出现并被该分支所有成员继承的共享衍生特征状态。问题说明要假设根节点的状态是根据 MP 推断的。\n\n对于位点 $1$：\n根节点 $R$ 的状态集是 $\\{0\\}$，因此我们将状态 $0$ 分配给根节点。\n-   $R$ 的状态为 $0$。其后代 $E$ 的状态也为 $0$（无变化）。其另一个后代 $N_3$ 的状态集为 $\\{0, 1\\}$。由于父节点状态 $0$ 在此集合中，我们将状态 $0$ 分配给 $N_3$。\n-   $N_3$ 的状态为 $0$。其后代 $N_2$ 的状态集为 $\\{0\\}$，因此我们必须将状态 $0$ 分配给 $N_2$。其另一个后代 $N_1$ 的状态集为 $\\{1\\}$。由于父节点状态 $0$ 不在此集合中，必须发生状态变化。我们将状态 $1$ 分配给 $N_1$。这个 $0 \\to 1$ 的变化发生在从 $N_3$ 到 $N_1$ 的分支上。\n在通往分支 $(A,B)$ 的分支上发生的这一次变化，导致衍生状态 $1$ 被 $A$ 和 $B$ 共同拥有。因此，位点 $1$ 上的状态 $1$ 是支持支序 $(A,B)$ 的一个共有衍征。\n\n对于位点 $2$：\n根节点 $R$ 的状态集是 $\\{0\\}$，因此我们将状态 $0$ 分配给根节点。\n-   $R$ 的状态为 $0$。其后代 $E$ 的状态为 $0$。其另一个后代 $N_3$ 的状态集为 $\\{0, 1\\}$，因此我们将状态 $0$ 分配给 $N_3$。\n-   $N_3$ 的状态为 $0$。其后代 $N_1$ 的状态集为 $\\{0, 1\\}$，因此我们可以将状态 $0$ 分配给 $N_1$。其另一个后代 $N_2$ 的状态集为 $\\{0, 1\\}$，因此我们可以将状态 $0$ 分配给 $N_2$。\n-   在这种重构下（这是几种同样简约的可能性之一，例如 DELTRAN 重构），所有内部节点（$R, N_3, N_2, N_1$）的状态都为 $0$。所需的两次变化是：\n    1.  在通往 $A$ 的末端分支上：$0 \\to 1$（因为 $N_1$ 是 $0$）。\n    2.  在通往 $C$ 的末端分支上：$0 \\to 1$（因为 $N_2$ 是 $0$）。\n这是两次独立地向状态 $1$ 的变化。这种现象称为同源异形（具体来说是趋同演化）。状态 $1$ 并不是任何分支的共享衍生特征；它对于分类单元 $A$ 是一个独衍征，对于分类单元 $C$ 也是一个独衍征。因此，位点 $2$ 没有为该树上的任何分支提供共有衍征支持。\n\n结论：在所提供的特征中，只有位点 $1$ 提供了一个共有衍征，它支持支序 $(A,B)$。然而，主要问题是报告总简约分数。\n\n两个位点的总简约分数是 $3$。", "answer": "$$ \\boxed{3} $$", "id": "2760542"}, {"introduction": "虽然简约法很直观，但它依赖于简化的假设。本练习将介绍一种基于模型的概率推断方法——最大似然法 [@problem_id:2760550]。通过从第一性原理出发推导结果，你将看到，与简约法相比，引入一个明确的演化模型如何能够处理模糊情况，并得出更细致、更具决定性的结论。", "problem": "考虑一个有根、完全二分的三分类单元树，其拓扑结构为 $((A,B),C)$，其中每条边（包括内部分支）具有相同的分支长度 $b$，该长度是在马尔可夫 $k$-状态（Mk）模型下，以每个字符的预期变化次数来度量的。在树的末端观察到一个单一的二元性状，其状态为 $A=1$、$B=1$ 和 $C=0$。假设采用二元 Mk 模型，该模型具有对称的瞬时速率、时不变的动态过程以及相等的稳态频率，因此根节点的先验概率为每个状态分配 $1/2$ 的概率。利用树上似然性的第一性原理（给定祖先状态下后代子树的条件独立性以及剪枝递归），从连续时间双状态马尔可夫链推导出根节点处于状态 $0$ 的精确后验概率，并将其表示为仅与 $b$ 有关的闭式函数。用 $\\exp(-2b)$ 来表示您的最终结果，并将其呈现为单一的简化解析表达式。然后，根据您的表达式，说明在 Mk 模型下哪个根节点状态能最大化后验概率，并将其与在此拓扑和数据下使用 Fitch 简约法对根节点进行的推断进行比较。无需进行数值四舍五入，且 $b$ 不需要单位。", "solution": "该问题要求在给定特定数据集和连续时间马尔可夫模型的情况下，推导一个三分类单元树上单个二元性状的根节点状态的后验概率。这个结果将与基于简约法的推断结果进行比较。\n\n首先，我们将模型和树结构形式化。树的拓扑结构是 $((A,B),C)$，这是一个有根树，其中分类单元 $A$ 和 $B$ 互为姐妹群，分类单元 $C$ 是外群。设根节点表示为 $R$，对应于 $A$ 和 $B$ 最近共同祖先的内部分支节点表示为 $N$。问题说明，这棵树的所有四条边——三条末端边 $(N,A)$、$(N,B)$、$(R,C)$ 和一条内部分支边 $(R,N)$——都具有相同的长度 $b$。末端的数据为 $s_A=1$、$s_B=1$ 和 $s_C=0$。\n\n演化过程是一个基于状态 $\\{0, 1\\}$ 的双状态对称马尔可夫模型。对于这样的过程，其瞬时速率矩阵 $Q$ 如下所示，其中分支长度以每个位点的预期替换数来度量（$b = \\mu t$）：\n$$ Q = \\mu \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} $$\n该模型假设稳态频率相等，$\\pi_0 = \\pi_1 = 1/2$，这与对称的 $Q$ 矩阵是一致的。\n\n对于长度为 $b$ 的分支，其转移概率矩阵为 $P(b) = \\exp(Qb)$。在长度为 $b$ 的分支上，保持相同状态的概率（$P_{ii}(b)$）或改变状态的概率（$P_{ij}(b)$，其中 $i \\neq j$）为：\n$$ P_{ii}(b) = P_{00}(b) = P_{11}(b) = \\frac{1}{2} + \\frac{1}{2} \\exp(-2b) $$\n$$ P_{ij}(b) = P_{01}(b) = P_{10}(b) = \\frac{1}{2} - \\frac{1}{2} \\exp(-2b) $$\n我们用 $p_s(b) = \\frac{1}{2}(1 + \\exp(-2b))$ 表示保持相同状态的概率，用 $p_d(b) = \\frac{1}{2}(1 - \\exp(-2b))$ 表示改变状态的概率。注意 $p_s(b) + p_d(b) = 1$。为简洁起见，我们将它们写作 $p_s$ 和 $p_d$。\n\n我们使用 Felsenstein 的剪枝算法来计算在给定根节点特定状态下数据的似然性。给定根节点状态 $s_R$，数据 $D = \\{s_A=1, s_B=1, s_C=0\\}$ 的似然性为 $L(s_R) = P(D | s_R)$。该算法从末端向根部递归进行。\n\n对于处于状态 $i$ 的末端 $u$，其条件似然性为 $L_u(i) = \\delta_{i, s_u}$，其中 $\\delta$ 是克罗内克 δ。\n对于我们的数据：\n$L_A(i) = \\delta_{i,1}$，因此 $L_A(0)=0, L_A(1)=1$。\n$L_B(i) = \\delta_{i,1}$，因此 $L_B(0)=0, L_B(1)=1$。\n$L_C(i) = \\delta_{i,0}$，因此 $L_C(0)=1, L_C(1)=0$。\n\n接下来，我们计算内部分支节点 $N$ 的条件似然性：\n$L_N(i) = \\left( \\sum_{j \\in \\{0,1\\}} P_{ij}(b) L_A(j) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{ik}(b) L_B(k) \\right)$\n对于 $i=0$：\n$L_N(0) = (P_{00}(b)L_A(0) + P_{01}(b)L_A(1)) \\cdot (P_{00}(b)L_B(0) + P_{01}(b)L_B(1)) = (p_s \\cdot 0 + p_d \\cdot 1)(p_s \\cdot 0 + p_d \\cdot 1) = p_d^2$。\n对于 $i=1$：\n$L_N(1) = (P_{10}(b)L_A(0) + P_{11}(b)L_A(1)) \\cdot (P_{10}(b)L_B(0) + P_{11}(b)L_B(1)) = (p_d \\cdot 0 + p_s \\cdot 1)(p_d \\cdot 0 + p_s \\cdot 1) = p_s^2$。\n\n最后，我们计算节点 $R$ 处每个可能根节点状态的总似然性：\n$L(s_R) = \\left( \\sum_{j \\in \\{0,1\\}} P_{s_R, j}(b) L_N(j) \\right) \\left( \\sum_{k \\in \\{0,1\\}} P_{s_R, k}(b) L_C(k) \\right)$\n对于根节点状态 $s_R=0$：\n$L(0) = (P_{00}(b)L_N(0) + P_{01}(b)L_N(1)) \\cdot (P_{00}(b)L_C(0) + P_{01}(b)L_C(1))$\n$L(0) = (p_s \\cdot p_d^2 + p_d \\cdot p_s^2) \\cdot (p_s \\cdot 1 + p_d \\cdot 0) = (p_s p_d (p_d + p_s)) \\cdot p_s = (p_s p_d) \\cdot p_s = p_s^2 p_d$。\n\n对于根节点状态 $s_R=1$：\n$L(1) = (P_{10}(b)L_N(0) + P_{11}(b)L_N(1)) \\cdot (P_{10}(b)L_C(0) + P_{11}(b)L_C(1))$\n$L(1) = (p_d \\cdot p_d^2 + p_s \\cdot p_s^2) \\cdot (p_d \\cdot 1 + p_s \\cdot 0) = (p_d^3 + p_s^3) \\cdot p_d$。\n\n根据贝叶斯定理，当先验概率为均匀分布 $P(s_R=0)=P(s_R=1)=1/2$ 时，根节点处于状态 $0$ 的后验概率为：\n$$ P(s_R=0 | D) = \\frac{P(D | s_R=0) P(s_R=0)}{P(D)} = \\frac{L(0) \\cdot (1/2)}{L(0) \\cdot (1/2) + L(1) \\cdot (1/2)} = \\frac{L(0)}{L(0)+L(1)} $$\n$$ P(s_R=0 | D) = \\frac{p_s^2 p_d}{p_s^2 p_d + p_d(p_d^3 + p_s^3)} $$\n由于 $b>0$，我们有 $p_d \\neq 0$，因此可以通过除以 $p_d$ 来简化：\n$$ P(s_R=0 | D) = \\frac{p_s^2}{p_s^2 + p_d^3 + p_s^3} $$\n为了进一步简化，我们代入 $y = \\exp(-2b)$。那么 $p_s = \\frac{1}{2}(1+y)$ 且 $p_d = \\frac{1}{2}(1-y)$。\n$p_s^2 = \\frac{1}{4}(1+y)^2 = \\frac{1}{4}(1+2y+y^2)$。\n$p_s^3 = \\frac{1}{8}(1+y)^3 = \\frac{1}{8}(1+3y+3y^2+y^3)$。\n$p_d^3 = \\frac{1}{8}(1-y)^3 = \\frac{1}{8}(1-3y+3y^2-y^3)$。\n和 $p_d^3 + p_s^3 = \\frac{1}{8}((1-3y+3y^2-y^3) + (1+3y+3y^2+y^3)) = \\frac{1}{8}(2+6y^2) = \\frac{1}{4}(1+3y^2)$。\n后验概率的分母是：\n$p_s^2 + p_d^3 + p_s^3 = \\frac{1}{4}(1+2y+y^2) + \\frac{1}{4}(1+3y^2) = \\frac{1}{4}(2+2y+4y^2) = \\frac{1}{2}(1+y+2y^2)$。\n现在，我们写出后验概率：\n$$ P(s_R=0|D) = \\frac{\\frac{1}{4}(1+y)^2}{\\frac{1}{2}(1+y+2y^2)} = \\frac{(1+y)^2}{2(1+y+2y^2)} $$\n将 $y = \\exp(-2b)$ 代回表达式，最终的闭式解为：\n$$ P(s_R=0|D) = \\frac{(1+\\exp(-2b))^2}{2(1+\\exp(-2b)+2\\exp(-4b))} $$\n\n为了确定哪个根节点状态能最大化后验概率，我们比较 $P(s_R=0|D)$ 和 $P(s_R=1|D) = 1 - P(s_R=0|D)$。\n$P(s_R=1|D) = 1 - \\frac{(1+y)^2}{2(1+y+2y^2)} = \\frac{2(1+y+2y^2) - (1+2y+y^2)}{2(1+y+2y^2)} = \\frac{2+2y+4y^2 - 1-2y-y^2}{2(1+y+2y^2)} = \\frac{1+3y^2}{2(1+y+2y^2)}$。\n我们比较分子。让我们评估其差值：$(1+y)^2 - (1+3y^2) = 1+2y+y^2 - 1 - 3y^2 = 2y - 2y^2 = 2y(1-y)$。\n由于分支长度 $b > 0$，我们有 $0  y = \\exp(-2b)  1$。在此区间内，$2y$ 和 $(1-y)$ 均为正数，因此它们的乘积 $2y(1-y) > 0$。\n这意味着 $(1+y)^2 > 1+3y^2$，因此对于任何有限且非零的分支长度 $b$，$P(s_R=0|D) > P(s_R=1|D)$。因此，Mk 模型的推断支持根节点的状态为 $0$。\n\n作为对比，我们应用 Fitch 的简约法算法。\n向上遍历过程确定每个内部分支节点可能的状态集：\n1. 末端：$S_A = \\{1\\}$, $S_B = \\{1\\}$, $S_C = \\{0\\}$。\n2. 节点 $N$：$S_N = S_A \\cap S_B = \\{1\\} \\cap \\{1\\} = \\{1\\}$。\n3. 根节点 $R$：$S_R = S_N \\cap S_C = \\{1\\} \\cap \\{0\\} = \\emptyset$。由于交集为空，我们取其并集：$S_R = S_N \\cup S_C = \\{1\\} \\cup \\{0\\} = \\{0,1\\}$。\n最小变化数（简约法得分）为 $1$，对应于执行的单次并集操作。根节点的最简约状态集是 $\\{0,1\\}$。因此，简约法的结果是模棱两可的，认为根节点状态 $0$ 和 $1$ 同样合理。\n\n总之，在 Mk 模型下，基于似然性的方法提供了一个决定性的结果，对于任何 $b>0$ 都一致地支持根节点状态为 $0$。这与 Fitch 简约法形成对比，后者认为根节点状态 $0$ 和 $1$ 同样最优。似然法更为精细，因为它考虑了沿分支发生多次替换的概率，并正确权衡了来自非独立、具有系统发育关系的分类单元 $A$ 和 $B$ 的证据。它正确地推断出，在通往 $(A,B)$ 分支的内部分支上发生一次变化，比在通往 $C$ 的末端分支上发生一次变化更为可能，而简约法中简单的变化计数未能做出这种区分。", "answer": "$$ \\boxed{\\frac{(1+\\exp(-2b))^{2}}{2(1+\\exp(-2b)+2\\exp(-4b))}} $$", "id": "2760550"}]}