## 引言
在分[子序列](@entry_id:147702)分析中，一个普遍而关键的观察是，不同位点的[演化速率](@entry_id:202008)存在巨大差异——有些位点高度保守，而另一些则变化迅速。这种被称为**位点间[速率异质性](@entry_id:149577)（Rate Heterogeneity Across Sites, RHAS）**的现象，是理解基因和蛋白质功能约束的窗口。然而，在[系统发育分析](@entry_id:172534)中若忽略这一基本事实，将会导致对演化历史的严重误读，产生错误的[系统发育树](@entry_id:140506)和不准确的[演化距离](@entry_id:177968)估计。本文旨在系统性地剖析这一核心概念，为读者构建一个从理论到实践的完整知识框架。

为了实现这一目标，本文将分为三个紧密相连的部分。在第一章**“原理与机制”**中，我们将深入探讨[速率异质性](@entry_id:149577)背后的[群体遗传学](@entry_id:146344)原理，阐明功能约束如何转化为可观察的[演化速率](@entry_id:202008)差异，并详细介绍用于捕捉这种变异的经典[统计模型](@entry_id:165873)，如Gamma[分布](@entry_id:182848)模型。随后，在第二章**“应用和跨学科联系”**中，我们将展示这些模型在实践中的巨大价值，不仅在于如何提升[系统发育推断](@entry_id:182186)的准确性，还将探索其在[功能基因组学](@entry_id:155630)、分子钟定年乃至癌症研究等前沿领域的广泛应用。最后，第三章**“动手实践”**将通过一系列精心设计的计算练习，引导读者亲手实现数据模拟、似然性计算和模型选择，将理论知识转化为可操作的技能。

通过这一系列的学习，您将不仅掌握位点间[速率异质性](@entry_id:149577)的核心理论，更能深刻理解其在现代[演化生物学](@entry_id:145480)及相关学科中的重要性与实际应用。让我们一同开始这段从基本原理到前沿应用的探索之旅。

## 原理与机制

在[分子演化](@entry_id:148874)分析中，一个核心的观察是，序列中的不同位点（例如，DNA或蛋白质序列中的不同位置）以不同的速率演化。一些位点几乎不发生变化，暗示着它们受到强烈的结构或功能限制；而另一些位点则迅速积累替换，表明它们受到的选择压力较小。这种现象被称为**位点间[速率异质性](@entry_id:149577) (Rate Heterogeneity Across Sites, RHAS)**。准确地对这种变异建模对于[系统发育推断](@entry_id:182186)的准确性至关重要，因为它深刻影响着[分支长度](@entry_id:177486)的估计、祖先序列的重建以及系统发育树的拓扑结构。本章将深入探讨RHAS的原理、其产生的根本机制、忽略它所带来的后果，以及在现代系统发育学中用于解释这一现象的[计算模型](@entry_id:152639)。

### 速率变异的基本概念：位点间异质性与[异速性](@entry_id:184519)

在深入探讨建模策略之前，我们必须首先精确区分两种不同类型的速率变异。这两种变异都源于[演化约束](@entry_id:152522)的变化，但它们发生在不同的维度上：一些是跨越序列位点的空间变异，另一些是沿谱系时间的变异。

**位点间[速率异质性](@entry_id:149577) (Rate Heterogeneity Across Sites, RHAS)** 是指在任何固定的时间点，比对中不同列（位点）的瞬时[替换速率](@entry_id:150366)存在差异。在标准的[连续时间马尔可夫链 (CTMC)](@entry_id:203641) 模型框架中，一个共享的[瞬时速率](@entry_id:182981)矩阵 $Q$ 描述了所有位点的基本替换模式。RHAS通过为每个位点 $i$ 引入一个不随时间变化的特定速率乘子 $r_i$ 来建模。因此，位点 $i$ 的有效速率矩阵变为 $r_i Q$。如果 $r_i \neq r_j$，则位点 $i$ 和 $j$ 就表现出[速率异质性](@entry_id:149577)。

这种现象的生物学基础在于不同位点所承受的**功能约束 (functional constraints)** 存在持久性差异。一个经典的例子来自蛋白质编码基因。由于遗传[密码子](@entry_id:274050)的简并性，第三[密码子](@entry_id:274050)位置的替换通常是同义的（不改变编码的氨基酸），因此它受到的纯化选择压力远小于第一和第二[密码子](@entry_id:274050)位置。结果是，第三[密码子](@entry_id:274050)位置通常具有更高的速率乘子（即更大的 $r_i$），演化得更快。同样，在蛋白质结构中，位于酶[活性中心](@entry_id:136476)的催化残基对蛋白质功能至关重要，几乎任何替换都是有害的，因此这些位点演化得极其缓慢（$r_i \approx 0$）。相反，暴露在溶剂中的表面环上的残基通常可以容忍更多的替换，因此演化得更快（$r_i > 1$）。[@problem_id:2747202]

与RHAS相对的是**[异速性](@entry_id:184519) (heterotachy)**，它指的是**单个**位点的瞬时[替换速率](@entry_id:150366)随演化时间而变化。这需要一个随时间变化的速率乘子，记为 $r_i(t)$。[异速性](@entry_id:184519)意味着一个位点的功能约束在系统发育树的不同部分发生了改变。这种变化可能是由于[蛋白质相互作用](@entry_id:271521)伙伴的获得或丧失，或者蛋白质自身构象的改变。典型的例子是**协变子 (covarion)** 模型，其中一个氨基酸位点可以在两种状态之间切换：一种是功能受限状态（演化缓慢），另一种是不受限状态（演化迅速）。当一个蛋白质在一个谱系中获得了一个新的相互作用伙伴时，其接触界面上的一个位点可能会从不受限变为受限。这种约束的改变就是[异速性](@entry_id:184519)的一个机制性例子。[@problem_id:2747202]

在本章的其余部分，我们的[焦点](@entry_id:174388)将主要集中在RHAS上，即在任何给定时间点上，不同位点间的静态速率差异。

### [速率异质性](@entry_id:149577)的[群体遗传学](@entry_id:146344)起源

为什么功能约束的差异会导致[演化速率](@entry_id:202008)的巨大差别？答案深植于[群体遗传学](@entry_id:146344)的基本原理，它将单个突变的命运与自然选择和[遗传漂变](@entry_id:145594)的力量联系起来。一个位点的长期[替换速率](@entry_id:150366)，我们记为 $K$，不仅仅是新突变产生的速率，而是新突变产生并最终在群体中**固定 (fixation)** 的速率。

在一个大小为 $N_e$ 的有效二倍体群体中，每个位点每个世代的突变率为 $\mu$。因此，每一代群体中出现的新突变为 $2 N_e \mu$ 个。每个新突变都有一个[选择系数](@entry_id:155033) $s$，它量化了该突变相对于[野生型等位基因](@entry_id:162987)的适合度效应。一个新突变最终在群体中固定的概率 $P_{\text{fix}}(s)$，在标准的[Wright-Fisher模型](@entry_id:148998)下，由木村资生 ([Motoo Kimura](@entry_id:153912)) 的[扩散方程](@entry_id:170713)近似给出：

$$
P_{\text{fix}}(s) = \frac{1 - \exp(-2s)}{1 - \exp(-4 N_e s)}
$$

因此，[替换速率](@entry_id:150366)为：

$$
K = 2 N_e \mu P_{\text{fix}}(s)
$$

这个框架清晰地揭示了功能约束如何转化为可观察的[替换速率](@entry_id:150366)。功能约束的强度决定了突变的适合度效应谱（即 $s$ 的[分布](@entry_id:182848)）。

*   **强约束位点**（例如酶的催化残基）：这些位点的结构和化学性质经过了高度优化。大多数非同义突变都会破坏其功能，因此是强有害的，具有较大的负选择系数（例如，$s \approx -10^{-2}$）。在这种情况下，群体规模与选择的乘积 $4 N_e |s|$ 远大于1（例如，$4 \times 10^5 \times 10^{-2} = 4000 \gg 1$）。这意味着**选择**远比**遗传漂变**强大。对于[有害突变](@entry_id:175618)（$s0$），[固定概率](@entry_id:178551) $P_{\text{fix}}(s)$ 会呈指数级减小，变得微乎其微。因此，尽管突变仍在以速率 $\mu$ 发生，但它们几乎总是被纯化选择所清除，导致[替换速率](@entry_id:150366) $K_c \approx 0$。[@problem_id:2747263]

*   **弱约束位点**（例如蛋白质表面残基）：这些位点的突变通常对蛋白质的结构和功能影响很小，因此是近中性的或微弱有害的（例如，$s \approx -10^{-7}$）。在这种情况下，$4 N_e |s|$ 可能远小于1（例如，$4 \times 10^5 \times 10^{-7} = 0.04 \ll 1$）。这意味着**[遗传漂变](@entry_id:145594)**主导了突变的命运。当 $|s|$ 非常小时，[固定概率](@entry_id:178551) $P_{\text{fix}}(s)$ 近似于一个[中性突变](@entry_id:176508)的[固定概率](@entry_id:178551)，即其初始频率 $1/(2N_e)$。代入[替换速率](@entry_id:150366)公式，我们得到：

    $$
    K_s \approx 2 N_e \mu \left( \frac{1}{2 N_e} \right) = \mu
    $$

    因此，在弱约束位点，[替换速率](@entry_id:150366)约等于[突变率](@entry_id:136737)。[@problem_id:2747263]

这个从第一性原理出发的推导解释了一个核心的经验观察：功能越重要的位点演化越慢。速率的差异并非源于突变输入的差异（$\mu$ 通常被假定为在整个基因组中是恒定的），而是源于自然选择在不同位点上对这些突变进行差异化过滤的效率。

### 忽略[速率异质性](@entry_id:149577)的后果

既然RHAS是[分子演化](@entry_id:148874)的一个普遍特征，那么在[系统发育分析](@entry_id:172534)中忽略它会导致什么问题呢？模型的不当设定会引入严重的系统性偏差，主要体现在两个方面：[分支长度](@entry_id:177486)估计错误和拓扑结构推断错误。

#### [分支长度](@entry_id:177486)的系统性低估

当一个模型假设所有位点以相同的速率演化，而实际上数据是由一个包含快速和慢速位点的混合体生成时，该模型会系统性地低估[演化距离](@entry_id:177968)（即[分支长度](@entry_id:177486)）。

我们可以通过一个简单的思想实验来理解这一点。考虑在Jukes-Cantor模型下，两个序列沿着一条长度为 $t$ 的分支演化。如果一个位点的速率乘子为 $r$，那么在该位点观察到差异的概率为 $p(r, t) = \frac{3}{4}(1 - \exp(-\frac{4}{3}rt))$。这是一个关于 $t$ 的饱和函数：随着时间的推移，观察到差异的概率渐近地接近 $\frac{3}{4}$。

现在，假设真实情况是，一半的位点演化缓慢（例如 $r=0.1$），另一半演化迅速（例如 $r=1.9$），平均速率为 $\mathbb{E}[R]=1$。经过很长一段时间 $t$ 后，快速位点将很快达到饱和（差异概率接近0.75），而慢速位点则几乎没有变化（差异概率仍接近于0）。在所有位点上观察到的平[均差](@entry_id:138238)异将是快速和慢速位点贡献的平均值，这个值会显著低于一个所有位点都以平均速率 $r=1$ 演化时的期望差异。

更正式地，函数 $p(r, t)$ 相对于速率 $r$ 是一个**[凹函数](@entry_id:274100)** (concave function)，因为它的[二阶导数](@entry_id:144508) $p''(r,t) = -\frac{4}{3}t^2 \exp(-\frac{4}{3}rt)$ 恒为负。根据**[詹森不等式](@entry_id:144269) (Jensen's inequality)**，对于任何[凹函数](@entry_id:274100) $p$ 和非退化的[随机变量](@entry_id:195330) $R$，我们有 $\mathbb{E}[p(R, t)]  p(\mathbb{E}[R], t)$。分析者观测到的数据是序列间的平[均差](@entry_id:138238)异，它对应于 $\mathbb{E}[p(R, t)]$。然而，他/她使用的均质模型（$r \equiv 1 = \mathbb{E}[R]$）是基于 $p(1, t)$ 来估计[分支长度](@entry_id:177486)的。由于观测到的差异 $\mathbb{E}[p(R, t)]$ 低于模型在真实[分支长度](@entry_id:177486) $t$ 下的[期望值](@entry_id:153208) $p(1, t)$，为了匹配这个较低的差异，模型必须推断出一个更短的[分支长度](@entry_id:177486) $\hat{t}  t$。这种低估对于长分支尤为严重，因为快速位点的饱和效应在长时间尺度上更为显著。[@problem_id:2747241]

#### 拓扑推断错误：[长枝吸引](@entry_id:141763)

忽略RHAS的更危险后果是可能导致错误的系统发育树拓扑，最著名的例子是**[长枝吸引](@entry_id:141763) (Long-Branch Attraction, LBA)**。LBA是一种[系统发育推断](@entry_id:182186)中的人为错误，即在真实树中不相关的两个（或多个）长分支，在推断的树中被错误地聚在一起。

这种现象的根本原因在于，RHAS在位点间的替换次数中引入了**[过度离散](@entry_id:263748) (overdispersion)**。在一个均质速率模型中，沿着一条分支的替换次数被建模为[泊松分布](@entry_id:147769)，其[方差](@entry_id:200758)等于均值。然而，当速率 $r$ 本身是一个[随机变量](@entry_id:195330)时，替换次数实际上遵循一个泊松[混合分布](@entry_id:276506)。其[方差](@entry_id:200758)大于其均值 ($\text{Var}(K) > \mathbb{E}[K]$)。这种[过度离散](@entry_id:263748)意味着，与简单的[泊松分布](@entry_id:147769)相比，我们观察到更多具有极少替换次数的位点（来自慢速位点）和更多具有极多替换次数的位点（来自快速位点）。

现在考虑一个具有两个长末端分支和两个短末端分支的四分类单元树（即所谓的“[Felsenstein区](@entry_id:191063)”）。在两个不相关的长分支上，那些快速演化的位点会经历大量的替换。由于状态空间是有限的（例如，DNA只有A, C, G, T四种状态），这些位点会很快达到饱和，导致**同oplasy**（趨同或平行演化）的概率急剧增加——即两个不相关的谱系独立地演化出相同的字符状态。当[系统发育](@entry_id:137790)模型忽略了RHAS时，它无法区分这种由快速演化引起的偶然相似性（同oplasy）和由[共同祖先](@entry_id:175919)遗传而来的真实相似性（[共有衍征](@entry_id:140197)）。模型会将长分支上快速位点产生的大量偶然匹配错误地解释为它们共享更近的共同祖先的证据，从而将它们吸引到一起，导致错误的拓扑结构。[@problem_id:2747241]

### 为[速率异质性](@entry_id:149577)建模

鉴于忽略RHAS的严重后果，为其建立显式模型至关重要。最流行和最成功的方法是使用[概率分布](@entry_id:146404)来描述位点间速率的变异。

#### Gamma (+$\Gamma$) [分布](@entry_id:182848)模型

最广泛使用的方法是假设位点特定的速率乘子 $r$ 是从一个**Gamma ($\Gamma$) [分布](@entry_id:182848)**中独立抽取的。Gamma[分布](@entry_id:182848)由两个参数定义：形状参数 $\alpha$ 和[尺度参数](@entry_id:268705) $\beta$。它是一个灵活的、仅在正实数上有定义的[连续分布](@entry_id:264735)，能够模拟多种形状的速率[分布](@entry_id:182848)。

为了避免模型的不可识别性——即无法区分快速率/短分支和慢速率/长分支——通常会施加一个约束，将平均速率标准化为1。通过设定 $\mathbb{E}[r] = \alpha\beta = 1$，速率乘子 $r$ 就成为一个相对速率。在这种标准化下，[分支长度](@entry_id:177486)的单位仍然是“每个位点的期望替换次数”，这是一个可解释的量度。[@problem_id:2424625] 如果[平均速率](@entry_id:147100)被错误地设置为某个其他值，例如2，那么为了补偿，所有估计的[分支长度](@entry_id:177486)将被迫减半，以保持总的演化量不变。[@problem_id:2424625]

在这个模型中，[形状参数](@entry_id:270600) $\alpha$ 成为衡量[速率异质性](@entry_id:149577)程度的关键指标。由于[方差](@entry_id:200758) $\text{Var}(r) = \alpha\beta^2 = 1/\alpha$，$\alpha$ 的值与[速率异质性](@entry_id:149577)成反比：
*   **小 $\alpha$ 值**（例如 $\alpha  1$）：表示**高度[异质性](@entry_id:275678)**。[分布](@entry_id:182848)呈“L”形，意味着大多数位点的[演化速率](@entry_id:202008)非常接近于零（高度保守），而少数位点的[演化速率](@entry_id:202008)则非常高（快速演化）。
*   **大 $\alpha$ 值**（例如 $\alpha > 5$）：表示**低度[异质性](@entry_id:275678)**。[分布](@entry_id:182848)呈钟形，紧密地围绕在平均速率 $r=1$ 周围，意味着大多数位点的[演化速率](@entry_id:202008)都非常相似，接近于均质模型。
当 $\alpha \to \infty$ 时，[方差](@entry_id:200758)趋于零，Gamma[分布](@entry_id:182848)坍缩为一个在 $r=1$ 处的点质量，模型退化为均质速率模型。因此，通过从数据中估计 $\alpha$，我们可以量化序列中存在的[位点间速率变异](@entry_id:196331)程度。[@problem_id:2424612]

#### 不变位点 (+I) 模型

另一种简单且常用的模型是**不变位点 (+I)** 模型。它不假设速率的[连续分布](@entry_id:264735)，而是将所有位点划分为两个离散的类别：
1.  一部分比例为 $p_{\text{inv}}$ 的位点被假定为**完全不变的 (invariant)**，它们的速率乘子 $r=0$。
2.  剩余比例为 $1 - p_{\text{inv}}$ 的位点则以一个共同的、非零的速率演化。

GTR+$\Gamma$ 模型通过一个[连续分布](@entry_id:264735)来描述速率变化，适用于那些约束强度呈渐变谱的情况。而GTR+$I$模型则假设了一个更明确的二分法：一些位点由于极端的功能约束而完全不能改变，而其他位点则都可以改变。在实践中，如果数据显示出大量的恒定列（在所有物种中都相同的位点），并且可变位点之间的速率差异不大，那么GTR+$I$模型可能是一个很好的近似。然而，值得注意的是，GTR+$\Gamma$模型（特别是当$\alpha$很小时）也可以通过将大量概率密度集中在接近零的速率来解释大量的恒定列。两者捕捉了[速率异质性](@entry_id:149577)的不同方面，因此，一种包含两者的混合模型，即**GTR+$\Gamma$+I**，在许多系统发育软件中被实现，并通常能提供比单独使用任一模型更好的数据拟合度。[@problem_id:2424641]

#### 计算实现：离散Gamma近似

在似然框架下，为了计算一个位点的总似然，我们需要对所有可能的速率 $r$进行积分。对于Gamma模型，这意味着求解如下积分：
$$
L(D) = \int_0^\infty p(D \mid r) \, f_{\Gamma}(r; \alpha, \beta) \, dr
$$
其中 $p(D \mid r)$ 是在给定速率 $r$ 下的数据[似然](@entry_id:167119)，通过Felsenstein的剪枝算法计算得出。这个积分通常没有解析解。尽管在某些情况下可以推导出基于[特征值分解](@entry_id:272091)的解析表达式[@problem_id:2747206]，但在实践中，标准的解决方案是采用一种[数值近似方法](@entry_id:169303)，即**离散Gamma模型**。

该方法用一个具有 $k$ 个离散速率类别的混合模型来近似连续的Gamma[分布](@entry_id:182848)。具体步骤如下[@problem_id:2747224] [@problem_id:2747222]：
1.  **划分区间**：将连续的Gamma[分布](@entry_id:182848)划分为 $k$ 个具有相等概率（$1/k$）的区间（分位数）。
2.  **选择代表速率**：对于每个类别 $c$，选择一个代表该区间的速率 $r_c$。最准确的选择是该区间内速率的条件均值：$r_c = \mathbb{E}[r \mid r \text{ in interval } c]$。
3.  **计算总[似然](@entry_id:167119)**：位点的总[似然](@entry_id:167119)被近似为这 $k$ 个类别似然的加权平均值。由于每个类别的概率都是 $1/k$，所以公式简化为：
    $$
    L(D) \approx \frac{1}{k} \sum_{c=1}^k p(D \mid r_c)
    $$
在计算上，这意味着需要对每个位点运行 $k$ 次剪枝算法。在第 $c$ 次运行时，树上的所有[分支长度](@entry_id:177486)都会被乘以相应的速率 $r_c$。然后将这 $k$ 次计算得到的似然值取平均。因此，使用一个具有 $k$ 个类别的离散Gamma模型，其计算成本大约是均质速率模型的 $k$ 倍。通常，$k=4$ 或 $k=8$ 已被证明在大多数情况下都能提供足够好的近似。[@problem_id:2747222]

### 一个重要的混淆因素：组分异质性

最后，必须认识到，观察到的位点间变异模式并不仅仅由[替换速率](@entry_id:150366)的差异引起。**位点间组分异质性 (Compositional Heterogeneity Across Sites)** 是另一个重要的生物学现象，它指的是不同位点具有不同的平衡碱基或氨基酸频率（即不同的稳态分布 $\boldsymbol{\pi}^{(s)}$）。例如，一些位点可能由于结构原因偏好嘌呤（A, G），而另一些位点则可能没有这种偏好。

当一个模型假设所有位点共享一个共同的、均质的[平衡频率](@entry_id:275072)向量 $\boldsymbol{\pi}$（例如GTR+$\Gamma$模型），而实际上数据中存在位点间的组分异质性时，就会产生混淆。考虑一个由于结构原因强烈偏好G和C的位点。即使这个位点的内在[替换速率](@entry_id:150366)很高，它的大部分替换也只是G和C之间的相互转换。因此，在跨物种比较时，这个位点看起来会比一个具有均一碱基频率但演化速率相同的位点更为保守（即具有更高的[序列相似性](@entry_id:178293)）。

这种效应的根本原因在于，当发散时间很长时，两个序列在一个位点上拥有相同状态的概率趋向于 $\sum_i (\pi_i^{(s)})^2$。这个值对于高度偏斜的[分布](@entry_id:182848)（例如，$\boldsymbol{\pi}^{(s)}=(0.49, 0.01, 0.49, 0.01)$）远大于[均匀分布](@entry_id:194597)（$\boldsymbol{\pi}^{(s)}=(0.25, 0.25, 0.25, 0.25)$）。一个标准的RHAS模型无法将这种由组分偏好引起的保守性归因于 $\boldsymbol{\pi}^{(s)}$ 的变化，因此它会错误地推断该位点具有一个非常低的速率乘子 $r_s$，以解释观察到的高相似度。[@problem_id:2747229]

这种混淆会导致对RHAS程度的严重高估，并可能影响其他参数的估计。解决这个问题的办法是使用更复杂的**位点异质模型 (site-heterogeneous models)**，如剖面混合模型（profile mixture models，例如CAT模型），它们允许[平衡频率](@entry_id:275072)向量 $\boldsymbol{\pi}^{(s)}$ 和速率乘子 $r_s$ 同时在位点间变化。这些模型通过直接对组分异质性进行建模，从而能够更准确地区分这两种不同来源的变异。[@problem_id:2747229]