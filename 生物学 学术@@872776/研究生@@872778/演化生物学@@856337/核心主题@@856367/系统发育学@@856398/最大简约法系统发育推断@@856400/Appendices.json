{"hands_on_practices": [{"introduction": "在最大简约法分析中，并非所有性状数据都对区分不同系统发育树拓扑有贡献。只有那些能够支持某一特定分组而反对其他分组的位点，即简约信息位点（parsimony-informative sites），才是有用的。这个练习将帮助你掌握识别这些关键信息位点的标准，这是进行任何简约分析的基础步骤 [@problem_id:2837245]。", "problem": "给定一个包含 $4$ 个分类单元（标记为 A、B、C 和 D）在 $20$ 个位点上的脱氧核糖核酸（DNA）字符比对。在最大简约法（MP）原则下的系统发育推断中，如果一个位点的字符状态分布能够通过暗示不同数量的最小状态改变次数来区分不同的无根树拓扑结构，那么该位点被称为简约信息位点。对于具有四种可能核苷酸的 DNA 字符，假设根据第一性原理作如下解释：一个位点是简约信息位点，当且仅当至少存在 $2$ 种不同的核苷酸，并且其中至少 $2$ 种核苷酸各自至少在 $2$ 个分类单元中出现。由 N 表示的模糊字符和由 - 表示的缺失被视作缺失数据，不计入计数；一个位点仅在其明确的观测值本身满足所述标准时，才被计为简约信息位点。\n\n请根据上述原则，用你自己的话定义什么是简约信息位点，然后计算以下比对中简约信息位点的总数。每个位点以 A/B/C/D 的模式列出：\n\n- 位点 $1$：A A A A\n- 位点 $2$：A A A G\n- 位点 $3$：A A G G\n- 位点 $4$：A G A G\n- 位点 $5$：A G G A\n- 位点 $6$：A C G T\n- 位点 $7$：C C C C\n- 位点 $8$：T T C C\n- 位点 $9$：G G G T\n- 位点 $10$：G T G T\n- 位点 $11$：T G G G\n- 位点 $12$：C C G G\n- 位点 $13$：C G C G\n- 位点 $14$：C G G C\n- 位点 $15$：A A C C\n- 位点 $16$：A C C C\n- 位点 $17$：A N G G\n- 位点 $18$：N N A A\n- 位点 $19$：- A - A\n- 位点 $20$：T C T C\n\n请仅报告简约信息位点的数量作为你的最终答案。无需四舍五入；以不带单位的整数形式提供结果。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n**步骤 1：提取的已知条件**\n- 分类单元数量：$4$ 个（A、B、C、D）。\n- 位点数量：$20$ 个。\n- 字符类型：脱氧核糖核酸（DNA）核苷酸（A、C、G、T）。\n- 特定字符的处理：'N'（模糊）和 '-'（缺失）被视为缺失数据，并从字符计数中排除。\n- 简约信息位点的定义：一个位点是简约信息位点，当且仅当基于明确的字符同时满足两个条件：\n    1. 至少存在 $2$ 种不同的核苷酸。\n    2. 这些不同核苷酸中至少有 $2$ 种，每一种都至少在 $2$ 个分类单元中出现。\n- 数据：提供了一个 $4 \\times 20$ 的 DNA 比对。\n\n**步骤 2：验证结论**\n该问题具有科学依据，因为它涉及系统发育分析中简约信息位点的基本概念，这是计算生物学和遗传学的核心课题。所提供的定义是对一个位点在 $4$ 个分类单元分析中成为简约信息位点的充分必要条件的正确且正式的陈述。该问题是适定的，具备所有必要的数据和清晰、明确的评估标准，确保了唯一解的存在。该问题是客观的，没有任何科学或逻辑上的缺陷。因此，该问题是**有效的**。\n\n接下来进行求解。\n\n根据所提供的原则，一个简约信息位点是序列比对中的一列，它提供了支持某一个无根系统发育树拓扑结构优于其他拓扑结构的证据。对于 $4$ 个分类单元，存在 $3$ 种可能的无根树。一个位点只有在支持特定的分类单元分组时，才能在这些树之间进行区分。这要求一种字符分布，其中至少有两个分类单元共享一种字符状态，而另外至少两个分类单元共享另一种不同的字符状态。因此，其模式形式为 `x-x-y-y`。任何其他模式，例如 `x-x-x-x`（不变位点），`x-x-x-y`（单一变异位点），或 `w-x-y-z`（所有状态都唯一），在所有 $3$ 种可能的树拓扑上都将需要相同数量的最小改变次数，因此对于选择最简约的树是无信息的。给定的规则是这一原则的形式化表述：一个位点要成为信息位点，它必须包含至少两种不同的字符状态，并且其中至少有两种状态必须至少出现两次。\n\n我们根据此标准分析 $20$ 个位点中的每一个，忽略任何 `N` 或 `-` 字符。\n\n设 $S_i$ 为位点 $i$ 处的字符集合。设 $C(S_i)$ 为 $S_i$ 中的唯一字符集合。设 $N(c, S_i)$ 为字符 $c$ 在位点 $S_i$ 中的计数。一个位点是简约信息位点，如果：\n1. $|C(S_i)| \\ge 2$\n2. 满足 $N(c, S_i) \\ge 2$ 的字符 $c \\in C(S_i)$ 的数量本身至少为 $2$。\n\n- **不变位点：** 模式 `x-x-x-x`。\n  - 位点 $1$ (A,A,A,A): $|C(S_1)| = 1$。不满足条件 1。非信息位点。\n  - 位点 $7$ (C,C,C,C): $|C(S_7)| = 1$。不满足条件 1。非信息位点。\n\n- **单一变异位点：** 模式 `x-x-x-y`。\n  - 位点 $2$ (A,A,A,G): $C(S_2) = \\{\\text{A, G}\\}$，所以 $|C(S_2)| = 2$。$N(\\text{A}, S_2)=3$，$N(\\text{G}, S_2)=1$。只有一个字符（'A'）的计数 $\\ge 2$。不满足条件 2。非信息位点。\n  - 位点 $9$ (G,G,G,T): $C(S_9) = \\{\\text{G, T}\\}$，$N(\\text{G}, S_9)=3$，$N(\\text{T}, S_9)=1$。不满足条件 2。非信息位点。\n  - 位点 $11$ (T,G,G,G): $C(S_{11}) = \\{\\text{T, G}\\}$，$N(\\text{T}, S_{11})=1$，$N(\\text{G}, S_{11})=3$。不满足条件 2。非信息位点。\n  - 位点 $16$ (A,C,C,C): $C(S_{16}) = \\{\\text{A, C}\\}$，$N(\\text{A}, S_{16})=1$，$N(\\text{C}, S_{16})=3$。不满足条件 2。非信息位点。\n\n- **多状态唯一位点：** 模式 `w-x-y-z`。\n  - 位点 $6$ (A,C,G,T): $C(S_6) = \\{\\text{A, C, G, T}\\}$，所以 $|C(S_6)| = 4$。$N(\\text{A})=1, N(\\text{C})=1, N(\\text{G})=1, N(\\text{T})=1$。没有字符的计数 $\\ge 2$。不满足条件 2。非信息位点。\n\n- **含有缺失数据的位点：**\n  - 位点 $17$ (A,N,G,G): 明确的字符是 (A,G,G)。$C(S_{17}) = \\{\\text{A, G}\\}$。$N(\\text{A})=1, N(\\text{G})=2$。只有一个字符（'G'）的计数 $\\ge 2$。不满足条件 2。非信息位点。\n  - 位点 $18$ (N,N,A,A): 明确的字符是 (A,A)。$C(S_{18}) = \\{\\text{A}\\}$，所以 $|C(S_{18})| = 1$。不满足条件 1。非信息位点。\n  - 位点 $19$ (-,A,-,A): 明确的字符是 (A,A)。$C(S_{19}) = \\{\\text{A}\\}$，所以 $|C(S_{19})| = 1$。不满足条件 1。非信息位点。\n\n- **简约信息位点：** 模式 `x-x-y-y`。\n  - 这些是唯一满足两个条件的位点。$|C(S_i)|=2$，并且对于 $C(S_i)$ 中的两个字符 $c_1, c_2$，都有 $N(c_1, S_i) = 2$ 和 $N(c_2, S_i) = 2$。\n  - 位点 $3$ (A,A,G,G): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $4$ (A,G,A,G): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $5$ (A,G,G,A): $N(\\text{A})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $8$ (T,T,C,C): $N(\\text{T})=2, N(\\text{C})=2$。**信息位点。**\n  - 位点 $10$ (G,T,G,T): $N(\\text{G})=2, N(\\text{T})=2$。**信息位点。**\n  - 位点 $12$ (C,C,G,G): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $13$ (C,G,C,G): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $14$ (C,G,G,C): $N(\\text{C})=2, N(\\text{G})=2$。**信息位点。**\n  - 位点 $15$ (A,A,C,C): $N(\\text{A})=2, N(\\text{C})=2$。**信息位点。**\n  - 位点 $20$ (T,C,T,C): $N(\\text{T})=2, N(\\text{C})=2$。**信息位点。**\n\n简约信息位点的总数是最后一类位点的计数。共有 $10$ 个这样的位点。", "answer": "$$\\boxed{10}$$", "id": "2837245"}, {"introduction": "理想情况下，所有性状都支持同一个系统发育树，这种现象被称为性状相容性（character compatibility），可以构建一个“完美系统发育树”。然而在真实数据中，不同性状往往因趋同演化或性状反转而产生冲突，这种冲突被称为同源异形（homoplasy）。这个练习将引导你使用四配子检验（four-gamete test）来评估性状间的相容性，并量化数据集固有的最小同源异形量，从而深入理解数据冲突对系统发育推断的影响 [@problem_id:2731406]。", "problem": "给定$5$个分类单元在$4$个无序、二元、独立的形态学特征上的一个排列。对于每个分类单元，其状态向量以$\\left(c_{1},c_{2},c_{3},c_{4}\\right)$的形式列出，状态取值为$\\{0,1\\}$：\n- 分类单元 $A$：$\\left(0,0,0,0\\right)$\n- 分类单元 $B$：$\\left(0,0,1,1\\right)$\n- 分类单元 $C$：$\\left(0,1,0,1\\right)$\n- 分类单元 $D$：$\\left(1,0,0,1\\right)$\n- 分类单元 $E$：$\\left(1,1,1,0\\right)$\n\n完美系统发育树是指这样一棵关于这些分类单元的树，其中每个特征都是凸的，即可以在树上通过恰好一次状态改变（如果是不变特征，则为零次）来实现。在最大简约法（MP）下，最简约树是使所有特征的总状态改变次数最小化的树。将此数据集所需的最小同塑性定义为：最简约树上的总改变次数与完美系统发育树存在情况下的理论最小改变次数之间的差值（即，对所有特征的单个特征下限求和，对于每个可变二元特征该下限为$1$，对于每个不变特征为$0$）。\n\n仅使用上述定义以及二元数据特征相容性和简约性的标准属性，判断这些数据是否存在完美系统发育树。如果完美系统发育树不存在，计算在任何一个包含这$5$个分类单元的完全解析无根树上所有特征可能产生的最小总改变次数，并由此确定所需的最小同塑性。将最小同塑性报告为单个整数。无需四舍五入。", "solution": "问题要求分析一个给定的包含$5$个分类单元和$4$个二元特征的形态学数据集，以确定是否存在完美系统发育树，如果不存在，则计算最小同塑性。\n\n首先，我们将给定的数据形式化。分类单元为 $A, B, C, D, E$。特征状态数据可以用一个矩阵 $M$ 表示，其中 $M_{ij}$ 是分类单元 $i$ 在特征 $c_j$ 上的状态。\n$$\nM = \\begin{pmatrix}\n  c_1  c_2  c_3  c_4 \\\\\nA  0  0  0  0 \\\\\nB  0  0  1  1 \\\\\nC  0  1  0  1 \\\\\nD  1  0  0  1 \\\\\nE  1  1  1  0\n\\end{pmatrix}\n$$\n\n完美系统发育树被定义为一棵树，其中每个特征都是凸的，对于二元特征而言，这意味着每个特征状态的改变只发生一次（如果特征不变，则为零次）。对于一组二元特征，完美系统发育树存在的充要条件是所有特征两两相容。对于两个二元特征 $c_i$ 和 $c_j$，相容性由四配子检验确定：如果不存在分类单元表现出所有四种可能的状态组合 $(0,0)$、$(0,1)$、$(1,0)$ 和 $(1,1)$，那么这两个特征是相容的。\n\n我们必须测试所有 $\\binom{4}{2} = 6$ 对特征的相容性。\n\n1.  特征 $c_1$ 和 $c_2$：\n    -   分类单元 A 的状态为 $(0,0)$。\n    -   分类单元 C 的状态为 $(0,1)$。\n    -   分类单元 D 的状态为 $(1,0)$。\n    -   分类单元 E 的状态为 $(1,1)$。\n    所有四种状态组合都存在。因此，$c_1$ 和 $c_2$ 不相容。\n\n由于至少有一对特征不相容，我们可以立即得出结论：该数据集不存在完美系统发育树。为了完整起见，我们可以验证所有特征对确实都不相容。\n2.  $c_1, c_3$：A: $(0,0)$, B: $(0,1)$, D: $(1,0)$, E: $(1,1)$。不相容。\n3.  $c_1, c_4$：A: $(0,0)$, B: $(0,1)$, E: $(1,0)$, D: $(1,1)$。不相容。\n4.  $c_2, c_3$：A: $(0,0)$, B: $(0,1)$, C: $(1,0)$, E: $(1,1)$。不相容。\n5.  $c_2, c_4$：A: $(0,0)$, E: $(1,0)$, B: $(0,1)$, C: $(1,1)$。不相容。\n6.  $c_3, c_4$：A: $(0,0)$, E: $(1,0)$, C: $(0,1)$, B: $(1,1)$。不相容。\n\n由于每对特征都不相容，所以完美系统发育树不存在。\n\n下一步是找到在任何完全解析的无根树上可能产生的最小总改变次数，也就是最简约树（MPT）的简约性得分。一棵树 $T$ 的简约性得分，记为 $L(T)$，是该树上每个特征所需的最少改变次数（长度）的总和：$L(T) = \\sum_{i=1}^{4} l_i(T)$。\n\n单个特征的理论最小改变次数是其状态数减一。所有四个特征都是可变的（同时拥有状态 $0$ 和 $1$），因此每个特征长度的下限是 $l_i \\ge 2-1 = 1$。理论最小总分，只有在存在完美系统发育树时才能达到，是这些下限的总和：$L_{min, theoretical} = \\sum_{i=1}^{4} 1 = 4$。\n\n由于完美系统发育树不存在，实际的最简约树（MPT）得分将大于 $4$。任意两个特征 $c_i$ 和 $c_j$ 不相容这一事实意味着，不存在任何单一的系统发育树，使得这两个特征都能以最少的1次改变来实现。换句话说，对于任何树 $T$，不可能同时满足 $l_i(T)=1$ 和 $l_j(T)=1$。由于所有特征对都不相容，在任何给定的树上，最多只有一个特征的长度可以为 $1$。\n\n我们可以通过考虑任意树 $T$ 的两种情况来分析可能的最小树长 $L_{MPT}$：\n情况1：没有特征的长度为 $1$。在这种情况下，对于所有 $i \\in \\{1,2,3,4\\}$，都有 $l_i(T) \\ge 2$。总长度将为 $L(T) \\ge 2+2+2+2 = 8$。\n情况2：恰好有一个特征的长度为 $1$。假设对于某个特征 $c_k$ 有 $l_k(T)=1$。由于所有其他特征 $c_j$（其中 $j \\neq k$）都与 $c_k$ 不相容，它们的长度必须大于 $1$，即 $l_j(T) \\ge 2$。总长度将为 $L(T) \\ge 1 + (2+2+2) = 7$。\n\n比较这两种情况，可能的最小简约性得分是 $\\min(8, 7) = 7$，前提是确实存在一个得分为 $7$ 的树。如果存在一个树拓扑结构，其中一个特征的长度为 $1$，而其他三个特征的长度各为 $2$，则可以得到 $7$ 分。\n\n让我们通过构建一棵树来检验这一点。要使一个特征的长度为 $1$，其对应的分类单元二分划分必须由树中的一条边来表示。特征 $c_1$ 的划分是 $\\{A,B,C\\}|\\{D,E\\}$。一个包含此划分的树的例子是 $T_1 = ((A,B),(C,(D,E)))$。这棵树有两条内部分支，对应于划分 $\\{A,B\\}|\\{C,D,E\\}$ 和 $\\{D,E\\}|\\{A,B,C\\}$。由于 $c_1$ 的划分存在，所以 $l_1(T_1)=1$。现在我们使用Fitch算法计算该树上其他特征的长度。\n\n-   $l_1(T_1)$: 根据构建，此值为 $1$。\n-   $l_2(T_1)$: 对于特征 $c_2$，状态为 $A(0), B(0), C(1), D(0), E(1)$。\n    -   从叶节点向上的遍历得出代价：$cost((D,E)) = 1$，$cost((C,(D,E))) = 0$，$cost((A,B)) = 0$，$cost(root) = 1$。总代价：$1+1=2$。\n-   $l_3(T_1)$: 对于特征 $c_3$，状态为 $A(0), B(1), C(0), D(0), E(1)$。\n    -   向上遍历：$cost((D,E))=1$，$cost((C,(D,E)))=0$，$cost((A,B))=1$，$cost(root)=0$。总代价：$1+1=2$。\n-   $l_4(T_1)$: 对于特征 $c_4$，状态为 $A(0), B(1), C(1), D(1), E(0)$。\n    -   向上遍历：$cost((D,E))=1$，$cost((C,(D,E)))=0$，$cost((A,B))=1$，$cost(root)=0$。总代价：$1+1=2$。\n\n树 $T_1$ 的总长度为 $L(T_1) = 1+2+2+2 = 7$。既然我们已经证明了任何树的得分都必须至少为 $7$，并且我们找到了一个得分为 $7$ 的树，那么可能的最小总改变次数就是 $7$。\n\n最后，我们计算最小同塑性。同塑性是指树上特征改变次数超过理论最小值的数量。\n$$ \\text{最小同塑性} = L_{MPT} - L_{min, theoretical} $$\n我们得出 $L_{MPT} = 7$ 以及 $L_{min, theoretical} = 4$。\n$$ \\text{最小同塑性} = 7 - 4 = 3 $$\n这代表了由于特征之间的不相容性而需要的三个额外步骤。", "answer": "$$\\boxed{3}$$", "id": "2731406"}, {"introduction": "最简单的简约法模型假定所有性状状态的改变具有相同的代价，但这在生物学上往往是不现实的。例如，在 DNA 序列中，转换（transition）通常比颠换（transversion）更频繁。这个高级练习将向你展示如何构建一个自定义的步长矩阵（stepmatrix），将不同的演化代价整合到简约法计算中，从而实现一个更符合生物学现实的广义简约模型 [@problem_id:2731369]。", "problem": "对脱氧核糖核酸 (DNA) 性状进行最大简约性分析，可以通过使用一个为性状状态变化分配代价的状态依赖的代价矩阵来进行推广。考虑一个DNA位点，其中核苷酸按顺序编码为整数：$0 \\leftrightarrow \\mathrm{A}$，$1 \\leftrightarrow \\mathrm{G}$，$2 \\leftrightarrow \\mathrm{C}$，$3 \\leftrightarrow \\mathrm{T}$。你需要构建一个组合代价矩阵，该矩阵按如下方式同时实现有序代价和转换/颠换加权。\n\n- 四个整数编码的状态嵌入到一个线性有序图 $0$–$1$–$2$–$3$ 上。\n- 任何变化的代价是沿此线的最小路径长度，其中对于$|i-j|=1$的每个相邻移动$i \\leftrightarrow j$，根据其在生物学核苷酸上是转换还是颠换来分配代价：相邻边 $0 \\leftrightarrow 1$ (对应 $\\mathrm{A} \\leftrightarrow \\mathrm{G}$) 和 $2 \\leftrightarrow 3$ (对应 $\\mathrm{C} \\leftrightarrow \\mathrm{T}$) 是转换，各自的代价为 $\\tau$；而中间的边 $1 \\leftrightarrow 2$ (对应 $\\mathrm{G} \\leftrightarrow \\mathrm{C}$) 是颠换，代价为 $\\upsilon$。任意两个整数状态 $i$ 和 $j$ 之间的代价是沿连接 $i$ 和 $j$ 的线路上相邻边代价的最小总和。\n\n使用此构造，分析在具有四个分类单元、拓扑结构为 $((X_{1},X_{2}),(X_{3},X_{4}))$ 的无根二叉树上，单个位点的简约长度。其中观测到的叶节点状态为 $X_{1}=\\mathrm{A}$, $X_{2}=\\mathrm{G}$, $X_{3}=\\mathrm{C}$, $X_{4}=\\mathrm{T}$ (在给定的编码中等价于 $0,1,2,3$)。简约长度定义为，在所有内部节点状态的赋值中，树上所有边的代价矩阵代价总和的最小值。\n\n设转换边代价为 $\\tau=\\frac{5}{4}$，颠换边代价为 $\\upsilon=\\frac{7}{3}$。在你构建的组合代价矩阵下，计算此位点在此树上的最小简约长度。将你的答案表示为一个精确的有理数 (不要四舍五入)。", "solution": "该问题陈述是最大简约法系统发育推断中的一个有效练习。它在科学上基于分子进化的原理，问题提法恰当且有唯一解，并以客观、明确的语言表达。它没有违反任何有效性标准。因此，我们可以着手求解。\n\n该问题要求计算一个指定四分类单元树上单个字符位点的最小简约长度。该长度由一个自定义的代价矩阵决定，我们必须首先构建该矩阵。\n\n四个字符状态被编码为整数：$0$ (腺嘌呤)，$1$ (鸟嘌呤)，$2$ (胞嘧啶) 和 $3$ (胸腺嘧啶)。这些状态排列在一个线性图 $0-1-2-3$ 上。任意两个状态之间变化的代价 $C(i, j)$ 是在该图上遍历节点 $i$ 和节点 $j$ 之间路径的最小代价。\n\n相邻移动的代价已给出。变化 $0 \\leftrightarrow 1$ (A $\\leftrightarrow$ G) 是转换，代价为 $\\tau$。变化 $2 \\leftrightarrow 3$ (C $\\leftrightarrow$ T) 也是转换，代价为 $\\tau$。变化 $1 \\leftrightarrow 2$ (G $\\leftrightarrow$ C) 是颠换，代价为 $\\upsilon$。所有其他非相邻代价是累积的。例如，代价 $C(0, 2)$ 是沿路径 $0 \\to 1 \\to 2$ 的代价之和，即 $C(0,1) + C(1,2) = \\tau + \\upsilon$。\n\n根据这个定义，我们构建对称的 $4 \\times 4$ 代价矩阵 $S$，其中元素 $S_{ij} = C(i, j)$:\n对于所有 $i$，$C(i, i) = 0$。\n$C(0, 1) = C(1, 0) = \\tau$\n$C(1, 2) = C(2, 1) = \\upsilon$\n$C(2, 3) = C(3, 2) = \\tau$\n$C(0, 2) = C(2, 0) = C(0, 1) + C(1, 2) = \\tau + \\upsilon$\n$C(1, 3) = C(3, 1) = C(1, 2) + C(2, 3) = \\upsilon + \\tau$\n$C(0, 3) = C(3, 0) = C(0, 1) + C(1, 2) + C(2, 3) = \\tau + \\upsilon + \\tau = 2\\tau + \\upsilon$\n\n完整的代价矩阵是：\n$$\nS = \\begin{pmatrix}\n0  \\tau  \\tau+\\upsilon  2\\tau+\\upsilon \\\\\n\\tau  0  \\upsilon  \\tau+\\upsilon \\\\\n\\tau+\\upsilon  \\upsilon  0  \\tau \\\\\n2\\tau+\\upsilon  \\tau+\\upsilon  \\tau  0\n\\end{pmatrix}\n$$\n\n系统发育树是一个拓扑结构为 $((X_{1},X_{2}),(X_{3},X_{4}))$ 的无根二叉树。设两个内部节点为 $V_1$ 和 $V_2$，其中 $V_1$ 与叶节点 $X_1$ 和 $X_2$ 相邻，$V_2$ 与叶节点 $X_3$ 和 $X_4$ 相邻。内部节点 $V_1$ 和 $V_2$ 通过唯一的内部边相连。叶节点的状态给出为 $X_{1}=0$，$X_{2}=1$，$X_{3}=2$ 和 $X_{4}=3$。\n\n树的简约长度是五条边上的总代价的最小值，该最小值是在内部节点 $V_1$ 和 $V_2$ 所有可能的状态赋值下取得的。设 $V_1$ 的状态为 $s_1 \\in \\{0, 1, 2, 3\\}$，$V_2$ 的状态为 $s_2 \\in \\{0, 1, 2, 3\\}$。总长度 $L$ 是这两个状态的函数：\n$$\nL(s_1, s_2) = C(X_1, s_1) + C(X_2, s_1) + C(V_1, V_2) + C(V_2, X_3) + C(V_2, X_4)\n$$\n代入给定的叶节点状态和代价函数记法：\n$$\nL(s_1, s_2) = C(0, s_1) + C(1, s_1) + C(s_1, s_2) + C(s_2, 2) + C(s_2, 3)\n$$\n为了找到最小简约长度，我们必须找到 $\\min_{s_1, s_2} L(s_1, s_2)$。我们可以通过枚举 $(s_1, s_2)$ 的所有 $4 \\times 4 = 16$ 种可能的状态对来解决这个问题。\n\n为了便于组织，我们定义两个子问题的代价：\n$L_1(s_1) = C(0, s_1) + C(1, s_1)$，是在节点 $V_1$ 状态为 $s_1$ 时，包含 $X_1$ 和 $X_2$ 的子树的代价。\n$L_2(s_2) = C(2, s_2) + C(3, s_2)$，是在节点 $V_2$ 状态为 $s_2$ 时，包含 $X_3$ 和 $X_4$ 的子树的代价。\n那么总长度为 $L(s_1, s_2) = L_1(s_1) + L_2(s_2) + C(s_1, s_2)$。\n\n我们为所有可能的状态计算 $L_1(s_1)$ 和 $L_2(s_2)$ 的值：\n对于 $s_1 \\in \\{0, 1, 2, 3\\}$:\n$L_1(0) = C(0,0) + C(1,0) = 0 + \\tau = \\tau$\n$L_1(1) = C(0,1) + C(1,1) = \\tau + 0 = \\tau$\n$L_1(2) = C(0,2) + C(1,2) = (\\tau+\\upsilon) + \\upsilon = \\tau+2\\upsilon$\n$L_1(3) = C(0,3) + C(1,3) = (2\\tau+\\upsilon) + (\\tau+\\upsilon) = 3\\tau+2\\upsilon$\n\n对于 $s_2 \\in \\{0, 1, 2, 3\\}$:\n$L_2(0) = C(0,2) + C(0,3) = (\\tau+\\upsilon) + (2\\tau+\\upsilon) = 3\\tau+2\\upsilon$\n$L_2(1) = C(1,2) + C(1,3) = \\upsilon + (\\tau+\\upsilon) = \\tau+2\\upsilon$\n$L_2(2) = C(2,2) + C(2,3) = 0 + \\tau = \\tau$\n$L_2(3) = C(3,2) + C(3,3) = \\tau + 0 = \\tau$\n\n现在我们必须找到 $\\min_{s_1,s_2} [L_1(s_1) + L_2(s_2) + C(s_1, s_2)]$。我们分析可能的组合。让我们考虑状态对 $(s_1, s_2) = (1, 2)$:\n$L(1, 2) = L_1(1) + L_2(2) + C(1, 2) = \\tau + \\tau + \\upsilon = 2\\tau + \\upsilon$。\n让我们验证这是否是最小值。考虑另一个可能的组合，$(s_1, s_2) = (0, 2)$:\n$L(0, 2) = L_1(0) + L_2(2) + C(0, 2) = \\tau + \\tau + (\\tau+\\upsilon) = 3\\tau + \\upsilon$。\n因为 $\\tau  0$，所以有 $3\\tau + \\upsilon  2\\tau + \\upsilon$。\n考虑 $(s_1, s_2) = (1, 1)$:\n$L(1, 1) = L_1(1) + L_2(1) + C(1, 1) = \\tau + (\\tau+2\\upsilon) + 0 = 2\\tau + 2\\upsilon$。\n因为 $\\upsilon  0$，所以有 $2\\tau + 2\\upsilon  2\\tau + \\upsilon$。\n对所有 $16$ 种状态对的全面检查证实，当状态赋值为 $(s_1, s_2) = (1, 2)$ 时达到最小代价，其最小长度为 $2\\tau + \\upsilon$。\n这在直觉上是合理的：$V_1$ 的最优状态应该位于其后代 $0$ 和 $1$ 之间的路径上 (即状态 $0$ 或 $1$)，而 $V_2$ 的最优状态应该位于其后代 $2$ 和 $3$ 之间的路径上 (即状态 $2$ 或 $3$)。组合 $(s_1,s_2)=(1,2)$ 满足这些条件，并在四种可能性 $\\{(0,2), (0,3), (1,2), (1,3)\\}$ 中最小化了内部边代价 $C(s_1, s_2)$。最小的内部代价是 $C(1,2)=\\upsilon$。\n\n因此，最小简约长度为 $L_{min} = 2\\tau + \\upsilon$。\n给定数值 $\\tau = \\frac{5}{4}$ 和 $\\upsilon = \\frac{7}{3}$。我们将这些值代入最小长度的表达式中：\n$$\nL_{min} = 2\\left(\\frac{5}{4}\\right) + \\frac{7}{3} = \\frac{10}{4} + \\frac{7}{3} = \\frac{5}{2} + \\frac{7}{3}\n$$\n为了对这些分数求和，我们找到一个公分母，即 $6$：\n$$\nL_{min} = \\frac{5 \\times 3}{2 \\times 3} + \\frac{7 \\times 2}{3 \\times 2} = \\frac{15}{6} + \\frac{14}{6} = \\frac{29}{6}\n$$\n最小简约长度是 $\\frac{29}{6}$。", "answer": "$$\\boxed{\\frac{29}{6}}$$", "id": "2731369"}]}