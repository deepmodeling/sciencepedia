{"hands_on_practices": [{"introduction": "本次练习旨在巩固育种家方程的基本原理。你将从育种值对表型的线性回归这一第一性原理出发，推导出该方程。本练习还将强调正确处理测量单位和标准化变量的重要性，这些都是分析数量遗传学数据时的关键技能。[@problem_id:2745780]", "problem": "在一个大型随机交配群体中，记录了一个以毫米为单位的单一的度量数量性状 $X$（例如，一个线性形态学测量）。该群体的基因作用是纯加性的，没有显性、上位性或基因型-环境互作。选择前的表型方差为 $V_{P} = 9 \\text{ mm}^2$，选择前的加性遗传方差为 $V_{A} = 4 \\text{ mm}^2$。发生了一轮生存力选择，使得被选親本的平均表型比选择前的群体平均值高 $1.8 \\text{ mm}$。研究人员还分析了标准化性状 $Z = (X - \\mu)/\\sigma$，其中 $\\mu$ 和 $\\sigma$ 表示在同一个目标世代中选择前的性状平均值和标准差。通过这种标准化，观察到的对 $Z$ 的选择差为 $0.6$。\n\n请仅从狭义遗传力 $h^2$ 的定义 $V_{A}/V_{P}$ 以及源于加性作用的育种值与表型之间的线性回归关系出发，推导该性状均值对所述代内选择的单代进化响应。然后计算其数值并将其转换为厘米。从概念上验证为什么以标准化单位计算响应然后反向转换会得到与直接以毫米为单位计算相同的答案，并解释测量单位的变化（毫米到厘米）如何影响方差、选择差和响应。\n\n请提供一个数字：预测的一代后性状均值的变化，以厘米为单位表示。将您的答案四舍五入到四位有效数字。", "solution": "将首先就该问题的科学合理性、一致性和完整性进行验证。只有在问题被认为是有效的情况下，才会提供解答。\n\n**问题验证**\n\n第一步：提取已知条件\n问题提供了以下明确信息：\n-   一个数量性状 $X$ 以毫米（mm）为单位测量。\n-   群体是大型且随机交配的。\n-   遗传效应是纯加性的，没有显性、上位性或基因型-环境互作。\n-   选择前表型方差：$V_{P} = 9 \\text{ mm}^{2}$。\n-   选择前加性遗传方差：$V_{A} = 4 \\text{ mm}^{2}$。\n-   性状 $X$ 的选择差：$S = \\mu_{\\text{selected}} - \\mu_{\\text{population}} = 1.8 \\text{ mm}$。\n-   标准化性状：$Z = (X - \\mu)/\\sigma$，其中 $\\sigma = \\sqrt{V_P}$。\n-   标准化性状 $Z$ 的选择差：$i = S_Z = 0.6$。\n\n第二步：使用提取的已知条件进行验证\n根据标准有效性准则对问题进行评估。\n1.  **科学依据**：该问题基于育种家方程，这是数量遗传学和进化生物学中的一个基本概念。所有术语（$V_P$、$V_A$、$h^2$、$S$）在该框架内都是标准的且定义正确。简化假设（加性等）在入门模型中很常见。\n2.  **一致性**：我们必须检查内部一致性。表型标准差为 $\\sigma_P = \\sqrt{V_P} = \\sqrt{9 \\text{ mm}^2} = 3 \\text{ mm}$。标准化选择差，或称选择强度，定义为 $i = S / \\sigma_P$。使用所提供的值，我们计算出 $i = \\frac{1.8 \\text{ mm}}{3 \\text{ mm}} = 0.6$。这个计算值与给定的标准化选择差 $0.6$ 完全匹配。因此，输入数据是一致且冗余的，而非矛盾的。此外，加性遗传方差（$V_A = 4 \\text{ mm}^2$）是表型方差（$V_P = 9 \\text{ mm}^2$）的一个组成部分且小于表型方差，这是必需的（$V_P = V_A + V_E$，其中 $V_E$ 是环境方差，必须为非负数）。\n3.  **适定性**：该问题是适定的。它提供了计算所要求数量，即进化响应（$R$），所需的所有必要信息，并要求进行清晰的推导和概念性解释。存在一个唯一的、稳定的解。\n\n结论：该问题有效。它在科学上是合理的、内部一致的且适定的。我们继续进行求解。\n\n**推导与求解**\n\n目标是推导单代进化响应 $R$，即由于选择引起的群体平均表型的变化。\n$R = \\bar{P}_{\\text{offspring}} - \\bar{P}_{\\text{parental}}$。\n\n在子代从亲代继承性状且非遗传因素不在亲代和子代之间产生协方差的假设下，子代群体的平均表型等于上一代被选亲本的平均育种值。\n$\\bar{P}_{\\text{offspring}} = \\bar{A}_{\\text{selected parents}}$。\n\n根据定义，当性状值表示为与群体均值的离差时，整个未选择亲代群体的平均育种值为零，所以 $\\bar{A}_{\\text{parental}} = 0$。因此，响应等于被选亲本的平均育种值：\n$R = \\bar{A}_{\\text{selected parents}}$。\n\n问题要求从育种值（$A$）对表型（$P$）的线性回归进行推导。该回归的斜率 $b_{AP}$ 由下式给出：\n$$b_{AP} = \\frac{\\text{Cov}(A, P)}{V_P}$$\n表型 $P$ 被建模为育种值 $A$ 和一个残差项 $E$ 的和，该残差项包含了环境效应和非加性遗传效应。问题陈述没有非加性效应，所以 $P = A + E$。假设没有基因型-环境相关（$\\text{Cov}(A,E)=0$），协方差项为：\n$$\\text{Cov}(A, P) = \\text{Cov}(A, A+E) = \\text{Cov}(A,A) + \\text{Cov}(A,E) = V_A + 0 = V_A$$\n将此代入斜率的表达式中可得：\n$$b_{AP} = \\frac{V_A}{V_P}$$\n该比率即为狭义遗传力 $h^2$ 的定义。因此，$b_{AP} = h^2$。\n\n在给定其表型 $P$ 的情况下，个体的期望育种值可以从这条回归线预测：\n$E[A | P] = \\bar{A} + b_{AP} (P - \\bar{P})$。\n在均值为0的离差下进行计算，即 $\\bar{A}=0$ 且 $\\bar{P}=0$，上式简化为：\n$E[A | P] = h^2 P$。\n\n被选亲本的平均育种值 $\\bar{A}_{\\text{selected parents}}$，是所有被选个体的这些期望育种值的平均值：\n$\\bar{A}_{\\text{selected parents}} = E[h^2 P_{\\text{selected}}] = h^2 \\bar{P}_{\\text{selected parents}}$。\n选择差 $S$ 是被选亲本的平均表型与整个亲代群体平均表型之间的差值：$S = \\bar{P}_{\\text{selected parents}} - \\bar{P}_{\\text{parental}}$。当 $\\bar{P}_{\\text{parental}}=0$ 时，这简化为 $S = \\bar{P}_{\\text{selected parents}}$。\n将 $S$ 代入 $\\bar{A}_{\\text{selected parents}}$ 的方程中可得：\n$$\\bar{A}_{\\text{selected parents}} = h^2 S$$\n因为我们已经确定 $R = \\bar{A}_{\\text{selected parents}}$，我们便得到了育种家方程：\n$$R = h^2 S$$\n至此完成了所需的推导。\n\n现在，我们计算响应的数值。首先，计算狭义遗传力 $h^2$：\n$$h^2 = \\frac{V_A}{V_P} = \\frac{4 \\text{ mm}^2}{9 \\text{ mm}^2} = \\frac{4}{9}$$\n给定的选择差 $S$ 为 $1.8 \\text{ mm}$。响应 $R$ 为：\n$$R = h^2 S = \\left(\\frac{4}{9}\\right) \\times 1.8 \\text{ mm} = \\frac{7.2}{9} \\text{ mm} = 0.8 \\text{ mm}$$\n\n**概念验证与单位转换**\n\n首先，我们使用标准化性状 $Z$ 来验证这个结果。以标准化单位表示的响应 $R_Z$ 由 $R_Z = h_Z^2 S_Z$ 给出。对 $Z$ 的选择差给定为 $S_Z = i = 0.6$。标准化性状的遗传力 $h_Z^2$ 为 $h_Z^2 = V_{A,Z} / V_Z$。一个标准化变量的方差为 $V_Z = 1$。$Z$ 的加性遗传方差为 $V_{A,Z} = V_A / \\sigma_P^2 = V_A / V_P = h^2$。因此，$h_Z^2 = h^2 / 1 = h^2$。遗传力是一个无量纲的比率，并且对于性状的线性缩放是不变的。\n标准化响应为：\n$$R_Z = h^2 i = \\left(\\frac{4}{9}\\right) \\times 0.6 = \\frac{2.4}{9} = \\frac{4}{15}$$\n响应 $R$ 是均值的变化，即 $\\Delta \\mu_X$。标准化响应 $R_Z$ 是 $Z$ 均值的变化，即 $\\Delta (\\frac{X-\\mu_X}{\\sigma_X}) = \\frac{\\Delta \\mu_X}{\\sigma_X} = \\frac{R}{\\sigma_P}$。\n要将 $R_Z$ 转换回原始单位，我们将其乘以表型标准差 $\\sigma_P = 3 \\text{ mm}$：\n$$R = R_Z \\times \\sigma_P = \\left(\\frac{4}{15}\\right) \\times 3 \\text{ mm} = \\frac{12}{15} \\text{ mm} = \\frac{4}{5} \\text{ mm} = 0.8 \\text{ mm}$$\n结果完全相同，这证实了概念框架的正确性。以标准化单位计算然后反向转换与直接计算是等效的，因为 $R = \\sigma_P R_Z = \\sigma_P (h^2 i) = \\sigma_P h^2 (S/\\sigma_P) = h^2 S$。\n\n接下来，我们分析将单位从毫米（mm）更改为厘米（cm）的影响。转换因子是 $1 \\text{ cm} = 10 \\text{ mm}$。以厘米为单位的测量值是以毫米为单位的值的 $1/10$。\n-   **方差**（$V_A, V_P$）：由于其单位为长度的平方，它们按 $(1/10)^2 = 1/100$ 的比例缩放。\n    $V_{P,cm} = 9/100 = 0.09 \\text{ cm}^2$。\n    $V_{A,cm} = 4/100 = 0.04 \\text{ cm}^2$。\n-   **遗传力**（$h^2$）：作为方差的比率，它是无量纲的，并且不随单位变化而改变。\n    $h^2 = \\frac{0.04 \\text{ cm}^2}{0.09 \\text{ cm}^2} = \\frac{4}{9}$。\n-   **选择差与响应**（$S, R$）：由于其单位为长度，它们按 $1/10$ 的比例缩放。\n    $S_{cm} = 1.8 / 10 = 0.18 \\text{ cm}$。\n    $R_{cm} = h^2 S_{cm} = \\left(\\frac{4}{9}\\right) \\times 0.18 \\text{ cm} = 4 \\times 0.02 \\text{ cm} = 0.08 \\text{ cm}$。\n这与转换我们最初计算的响应结果是一致的：$R = 0.8 \\text{ mm} = 0.08 \\text{ cm}$。\n\n**最终答案计算**\n\n问题要求以厘米为单位，给出预测的一代后性状均值的变化，并四舍五入到四位有效数字。\n计算出的响应恰好是 $0.08 \\text{ cm}$。为了用四位有效数字表示这个数，我们必须在小数点后添加尾随零。对于数字 $0.08000$，其有效数字为数字 $8$ 以及其后的三个 $0$，共四位。\n最终的数值答案是 $0.08000 \\text{ cm}$。", "answer": "$$\\boxed{0.08000}$$", "id": "2745780"}, {"introduction": "现实世界中的种群比理想化模型要复杂得多。本练习将挑战你扩展育种家方程，以考虑表型选型交配和近交效应。通过这个过程，你将学会如何根据非随机交配和历史种群因素，从机理上调整你的进化预测。[@problem_id:2745763]", "problem": "一个大型、随机交配的二倍体群体表现出一个数量性状，该性状以厘米为单位进行测量，由纯加性遗传效应和独立的环境效应决定。设个体表型是其育种值和环境离差之和，即 $P = G + E$，其中 $\\operatorname{Var}(G)$ 是加性遗传方差，$\\operatorname{Var}(E)$ 是环境方差。远交基础群体的加性遗传方差为 $V_{A0}$，环境方差为 $V_{E}$。由于其近期的种群历史，当前群体表现出近交系数 $F$。假设对于纯加性基因作用，近交使加性遗传方差按因子 $(1+F)$ 进行缩放，而 $V_{E}$ 保持不变，因此当前的加性遗传方差为 $V_{A}(F) = (1+F)\\,V_{A0}$，当前的表型方差为 $V_{P} = V_{A}(F) + V_{E}$。假设没有显性、没有上位性、配偶间或代际间没有共享环境协方差，并且由于许多微效位点和环境影响，潜在交配对的表型近似呈联合正态分布。\n\n仅对雄性实施截选，产生雄性选择差 $S_{\\mathrm{m}}$（被选雄性表型的平均值减去群体平均值）。雌性不被直接选择。然而，交配是表型选型交配：交配的雄雌对表型之间的相关系数为 $\\rho$。假设雄性和雌性的表型方差相等，并且被选雄性与其雌性伴侣之间为单配。\n\n仅使用上述假设，从基本原理推导子代平均表型的预期单代变化（即选择反应），同时考虑近交和表型选型交配。然后，使用以下参数值计算您的结果：$V_{A0} = 2.4 \\text{ cm}^{2}$，$V_{E} = 1.6 \\text{ cm}^{2}$，$F = 0.10$，$\\rho = 0.30$ 以及 $S_{\\mathrm{m}} = 1.20 \\text{ cm}$。用厘米表示您的最终答案，并四舍五入到四位有效数字。", "solution": "问题陈述经过验证，被认为是科学合理的、定义明确的且客观的。它提出了一个标准的、尽管是多部分的数量遗传学问题，可以使用既定原理解决。所有必要的参数和假设都已提供，并且没有内部矛盾或事实错误。因此，该问题被认为是有效的。\n\n任务是从基本原理推导预期的单代选择反应（表示为 $R$），然后用一组给定的参数对其进行求值。选择反应 $R$ 定义为子代平均表型相对于亲代平均值的变化。不失一般性，我们可以将亲代的平均表型设为零，因此 $R = \\bar{P}_{\\text{offspring}}$。\n\n个体的表型 $P$ 由其育种值 $G$ 和环境离差 $E$ 的和给出，即 $P = G + E$。因此，子代的预期平均表型为 $\\bar{P}_{\\text{offspring}} = \\operatorname{E}[G_{\\text{offspring}} + E_{\\text{offspring}}] = \\bar{G}_{\\text{offspring}} + \\bar{E}_{\\text{offspring}}$。根据问题假设，环境效应是独立的且均值为零，我们有 $\\bar{E}_{\\text{offspring}} = 0$。因此，选择反应等于子代的平均育种值：\n$$R = \\bar{G}_{\\text{offspring}}$$\n对于一个纯加性遗传模型下的二倍体随机交配群体，一个后代的育种值是其双亲育种值的平均值。因此，子代的平均育种值是产生它们的父本群体和母本群体的平均育种值的平均值：\n$$\\bar{G}_{\\text{offspring}} = \\frac{1}{2}(\\bar{G}_{\\text{fathers}} + \\bar{G}_{\\text{mothers}})$$\n我们现在的目标是确定被选父本及其交配伴侣（母本）的平均育种值。一个被选个体群体的平均育种值通过育种值对表型的回归与其平均表型相关。在给定个体表型 $P$ 的条件下，其育种值 $G$ 的条件期望是 $E[G | P=p] = \\mu_{G} + b_{GP}(p - \\mu_{P})$。回归系数 $b_{GP}$ 由下式给出：\n$$b_{GP} = \\frac{\\operatorname{Cov}(G, P)}{\\operatorname{Var}(P)}$$\n给定 $P = G + E$ 且 $G$ 和 $E$ 不相关，则 $\\operatorname{Cov}(G, P) = \\operatorname{Cov}(G, G+E) = \\operatorname{Var}(G) + \\operatorname{Cov}(G,E) = \\operatorname{Var}(G)$。育种值的方差即为加性遗传方差，在当前的近交群体中为 $V_{A}(F)$。表型方差为 $V_{P}$。因此，回归系数是当前群体的狭义遗传力，$h^2(F) = \\frac{V_{A}(F)}{V_{P}}$。\n\n假设群体均值 $\\mu_G$ 和 $\\mu_P$ 为零，一个被选群体的平均育种值为 $\\bar{G} = h^2(F) \\bar{P}$，其中 $\\bar{P}$ 是该群体的平均表型。\n\n对于雄性，应用了截选，产生选择差 $S_{\\mathrm{m}}$。这被定义为被选雄性的平均表型减去群体平均值，所以 $\\bar{P}_{\\text{fathers}} = S_{\\mathrm{m}}$。因此，父本的平均育种值为：\n$$\\bar{G}_{\\text{fathers}} = h^2(F) S_{\\mathrm{m}}$$\n雌性不被直接选择，而是与被选雄性进行选型交配，表型相关系数为 $\\rho$。在潜在配对的表型呈联合正态分布的假设下，给定其雄性伴侣的表型 $P_{\\mathrm{m}}$，雌性表型 $P_{\\mathrm{f}}$ 的期望值由线性回归 $E[P_{\\mathrm{f}} | P_{\\mathrm{m}}=p_{\\mathrm{m}}] = \\mu_{P} + \\rho \\frac{\\sigma_{P_{\\mathrm{f}}}}{\\sigma_{P_{\\mathrm{m}}}} (p_{\\mathrm{m}} - \\mu_{P})$ 描述。问题陈述，两性表型方差相等（$\\sigma_{P_{\\mathrm{f}}} = \\sigma_{P_{\\mathrm{m}}}$）。当 $\\mu_P=0$ 时，该式简化为 $E[P_{\\mathrm{f}} | P_{\\mathrm{m}}=p_{\\mathrm{m}}] = \\rho p_{\\mathrm{m}}$。\n\n母本群体的平均表型是这个条件期望的期望值，对被选雄性的表型取平均。\n$$\\bar{P}_{\\text{mothers}} = \\operatorname{E}[E[P_{\\mathrm{f}} | P_{\\mathrm{m}}]]_{\\text{selected males}} = \\operatorname{E}[\\rho P_{\\mathrm{m}}]_{\\text{selected males}} = \\rho \\operatorname{E}[P_{\\mathrm{m}}]_{\\text{selected males}} = \\rho S_{\\mathrm{m}}$$\n这代表了雌性上的一个相关选择差，它是由与被选雄性的选型交配引起的。因此，母本的平均育种值为：\n$$\\bar{G}_{\\text{mothers}} = h^2(F) \\bar{P}_{\\text{mothers}} = h^2(F) \\rho S_{\\mathrm{m}}$$\n我们现在结合亲本群体的结果来求选择反应：\n$$R = \\frac{1}{2}(\\bar{G}_{\\text{fathers}} + \\bar{G}_{\\text{mothers}}) = \\frac{1}{2}(h^2(F) S_{\\mathrm{m}} + h^2(F) \\rho S_{\\mathrm{m}})$$\n对该表达式进行因式分解，得到在这些特定条件下选择反应的最终方程：\n$$R = \\frac{1}{2} (1+\\rho) h^2(F) S_{\\mathrm{m}}$$\n现在必须使用提供的参数值来计算该方程。给定：$V_{A0} = 2.4\\,\\text{cm}^2$，$V_{E} = 1.6\\,\\text{cm}^2$，$F = 0.10$，$\\rho = 0.30$，以及 $S_{\\mathrm{m}} = 1.20\\,\\text{cm}$。\n\n首先，我们计算当前群体的方差和遗传力。\n近交群体的加性遗传方差为：\n$$V_{A}(F) = (1+F)V_{A0} = (1+0.10) \\times 2.4\\,\\text{cm}^2 = 1.1 \\times 2.4\\,\\text{cm}^2 = 2.64\\,\\text{cm}^2$$\n总表型方差为：\n$$V_{P} = V_{A}(F) + V_{E} = 2.64\\,\\text{cm}^2 + 1.6\\,\\text{cm}^2 = 4.24\\,\\text{cm}^2$$\n当前群体的狭义遗传力为：\n$$h^2(F) = \\frac{V_{A}(F)}{V_{P}} = \\frac{2.64}{4.24} = \\frac{66}{106} = \\frac{33}{53}$$\n现在，我们将这些值代入推导出的选择反应 $R$ 的表达式中：\n$$R = \\frac{1}{2} (1 + 0.30) \\left(\\frac{33}{53}\\right) (1.20)\\,\\text{cm}$$\n$$R = \\frac{1}{2} (1.3) \\left(\\frac{33}{53}\\right) (1.2)\\,\\text{cm}$$\n$$R = (0.5 \\times 1.3 \\times 1.2) \\left(\\frac{33}{53}\\right)\\,\\text{cm}$$\n$$R = 0.78 \\times \\frac{33}{53}\\,\\text{cm} = \\frac{25.74}{53}\\,\\text{cm}$$\n$$R \\approx 0.485660377... \\,\\text{cm}$$\n按要求将结果四舍五入到四位有效数字，得到 $0.4857\\,\\text{cm}$。", "answer": "$$ \\boxed{0.4857} $$", "id": "2745763"}, {"introduction": "一个预测模型的最终检验标准是其与经验数据的吻合程度。最后的这个练习旨在连接理论与应用，要求你建立一个验证进化预测的框架。你将通过实施统计方法，比较观测到的响应与预测响应，同时考虑到单性状和多性状情况下的抽样不确定性。[@problem_id:2745772]", "problem": "您将设计并实现一个程序，使用源自数量遗传学基本原理的一般推导，来检验定向选择下演化响应预测的经验有效性。其目的是通过比较源自加性遗传结构和选择的预测响应与观察到的性状变化，并将统计不确定性明确考虑在内，从而使模型检验具有可操作性。\n\n从以下基本原理出发：\n- Price 方程指出，对于一个种群均值为 $\\,\\bar{z}\\,$、个体表型为 $\\,z_i\\,$、绝对适合度为 $\\,w_i\\,$ 的性状，跨一代的性状均值变化满足\n$$\n\\Delta \\bar{z} \\;=\\; \\frac{\\operatorname{Cov}(w,z)}{\\bar{w}} \\;+\\; \\frac{1}{\\bar{w}} \\,\\mathbb{E}[w \\,\\Delta z_i],\n$$\n其中 $\\,\\bar{w}\\,$ 是平均适合度。在加性遗传且性状无家系内传递偏差的标准假设下，对于跨单代的响应，第二项对加性遗传贡献可忽略不计，遗传响应由适合度与育种值的协方差驱动。\n- 表型方差 $\\,V_P\\,$ 分解为加性遗传方差 $\\,V_A\\,$ 和环境方差 $\\,V_E\\,$，即\n$$\nV_P \\;=\\; V_A \\;+\\; V_E,\n$$\n窄义遗传力为 $\\,h^2 = V_A / V_P$。\n- 令 $\\,\\mathbf{G}\\,$ 为性状向量的加性遗传方差-协方差矩阵，选择梯度 $\\,\\boldsymbol{\\beta}\\,$ 定义为线性定向选择下相对适合度对性状向量的斜率。选择响应是 $\\,\\mathbf{G}\\,$ 和 $\\,\\boldsymbol{\\beta}\\,$ 的函数。\n- 单个性状的选择差 $\\,S\\,$ 等于被选择亲本的均值与整个种群均值之差。\n\n您的任务：\n1) 基于这些原理，推导出一个表达式，将性状均值的预期单代遗传响应与加性遗传方差（或方差-协方差矩阵）和选择梯度联系起来。将其分别特化到单变量和多变量情况，并关联选择差和选择梯度。\n2) 使用一阶 delta 方法，推导在窄义遗传力 $\\,h^2\\,$ 和选择差 $\\,S\\,$ 均为已知抽样方差和协方差的估计量时，预测响应在单变量情况下的抽样方差表达式。在单变量情况下应用模型检验时，使用正态近似来描述遗传响应的预测分布。\n3) 在多变量情况下，假设加性遗传方差-协方差矩阵 $\\,\\mathbf{G}\\,$ 已知且无误差，而选择梯度 $\\,\\boldsymbol{\\beta}\\,$ 的估计量具有已知的抽样协方差矩阵 $\\,\\mathbf{B}\\,$。使用一阶近似推导预测响应向量的抽样协方差。展示如何计算观测响应相对于预测的广义马氏平方距离，并使用置信水平为 $\\,0.95\\,$ 的卡方分布确定一个接受准则。解决当预测协方差矩阵为奇异矩阵时如何处理的问题，包括适当的统计自由度和在零空间内保持一致性的必要条件。\n\n所有量均已根据焦点种群的表型标准差单位进行了标准化，因此不需要物理单位。所有数值输出均以小数形式表示。当使用任何置信水平时，请以小数形式书写（例如，$\\,0.95\\,$）。\n\n模型检验的算法要求：\n- 对于每个单变量测试用例，通过上述推导的 delta 方法计算预测响应及其抽样方差。使用置信水平为 $\\,0.95\\,$ 的双侧正态接受域。如果抽样方差恰好为零，则仅在观测响应和预测响应在数值容差范围内相等时才接受。\n- 对于每个多变量测试用例，计算预测响应向量及其抽样协方差。使用预测协方差的逆矩阵计算广义马氏平方距离。如果预测协方差是奇异的，则用 Moore–Penrose 伪逆替换逆矩阵，将秩计算为严格正特征值的数量，并使用自由度等于该秩的卡方分布进行检验。此外，如果差异向量在预测协方差的零空间中有任何非零分量（超出数值容差），则直接拒绝一致性，因为模型认为该分量的抽样不确定性为零。\n\n测试套件：\n为以下五个案例实现上述要求。所有数值均采用标准化性状单位。对于单变量案例，接受准则是置信水平为 $\\,0.95\\,$ 的双侧正态区间。对于多变量案例，接受准则是置信水平为 $\\,0.95\\,$ 且自由度等于预测协方差秩的卡方阈值。\n- 案例 $\\,1$（单变量，典型情况）：$\\,h^2 = 0.5\\,$, $\\,S = 0.2\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.01\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.0025\\,$, $\\,\\operatorname{Cov}(\\hat{h}^2,\\hat{S}) = 0.0\\,$, 观测响应 $\\,R_{\\text{obs}} = 0.11\\,$.\n- 案例 $\\,2$（单变量，边界遗传力）：$\\,h^2 = 0.0\\,$, $\\,S = 0.6\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.0004\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.01\\,$, $\\,\\operatorname{Cov}(\\hat{h}^2,\\hat{S}) = 0.0\\,$, 观测响应 $\\,R_{\\text{obs}} = 0.02\\,$.\n- 案例 $\\,3$（单变量，因环境漂移导致模型违例）：$\\,h^2 = 0.4\\,$, $\\,S = 0.1\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.0025\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.0004\\,$, $\\,\\operatorname{Cov}(\\hat{h}^2,\\hat{S}) = 0.0\\,$, 观测响应 $\\,R_{\\text{obs}} = 0.09\\,$.\n- 案例 $\\,4$（多变量，2个性状，满秩预测协方差）：\n  $$\\mathbf{G} = \\begin{bmatrix} 0.6  0.2 \\\\ 0.2  0.5 \\end{bmatrix}$$\n  $$\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} 0.1 \\\\ -0.05 \\end{bmatrix}$$\n  $$\\mathbf{B} = \\begin{bmatrix} 0.0009  0.0002 \\\\ 0.0002  0.0004 \\end{bmatrix}$$\n  观测响应 $\\,\\mathbf{R}_{\\text{obs}} = \\begin{bmatrix} 0.058 \\\\ -0.012 \\end{bmatrix}\\,$。\n- 案例 $\\,5$（多变量，奇异预测协方差且零空间差异应导致拒绝）：\n  $$\\mathbf{G} = \\begin{bmatrix} 0.6  0.2 \\\\ 0.2  0.5 \\end{bmatrix}$$\n  $$\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} 0.1 \\\\ -0.05 \\end{bmatrix}$$\n  $$\\mathbf{B} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0009 \\end{bmatrix}$$\n  观测响应 $\\,\\mathbf{R}_{\\text{obs}} = \\mathbf{R}_{\\text{pred}} + 0.01 \\,\\mathbf{v}\\,$，其中 $\\,\\mathbf{R}_{\\text{pred}}\\,$ 是此案例的预测响应，$\\,\\mathbf{v} = \\bigl[0.5,\\,-0.2\\bigr]^\\top / \\|\\bigl[0.5,\\,-0.2\\bigr]^\\top\\|\\,$，即，对于预测协方差而言，这是一个纯粹的零空间偏差。\n\n程序要求：\n- 根据上述假设实现推导，以计算预测响应及其不确定性，然后依次对五个案例进行模型检验。\n- 您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个条目都是一个布尔值，指示在上述定义的意义下，观测响应是否在 $\\,0.95\\,$ 的置信水平上与模型预测一致。例如，一个有效的输出可能类似于五个案例的 $\\,\\bigl[\\text{True},\\text{False},\\dots\\bigr]\\,$。", "solution": "对选择的遗传响应可以从第一性原理出发，使用 Price 方程和加性遗传模型推导得出。首先考虑一个具有个体表型 $\\,z\\,$ 和育种值 $\\,a\\,$ 的单个性状。在加性遗传且跨一代无家系内传递偏差的情况下，平均育种值的变化等于相对适合度与育种值的协方差。对于线性定向选择，相对适合度在标准化单位下可以近似为 $\\,1 + \\beta z\\,$，其中 $\\,\\beta\\,$ 是选择梯度。驱动遗传响应的协方差项则为 $\\,\\operatorname{Cov}(w, a)/\\bar{w}\\,$；在弱选择下，我们取 $\\,\\bar{w} \\approx 1\\,$ 且 $\\,\\operatorname{Cov}(w, a) \\approx \\beta\\,\\operatorname{Cov}(z, a)\\,$。因为在加性模型下 $\\,\\operatorname{Cov}(z, a) = V_A\\,$，所以平均育种值在一代内的预期响应为\n$$\nR \\;=\\; V_A \\,\\beta.\n$$\n使用 $\\,V_P = V_A + V_E\\,$ 和 $\\,h^2 = V_A / V_P\\,$，根据选择梯度作为相对适合度对性状的斜率的定义，单个性状的选择差 $\\,S\\,$ 满足 $\\,S = V_P \\beta\\,$。结合这些关系可得\n$$\nR \\;=\\; V_A \\,\\beta \\;=\\; \\frac{V_A}{V_P}\\, V_P \\beta \\;=\\; h^2\\, S,\n$$\n这是育种家方程的单变量形式。\n\n对于一个性状向量 $\\,\\mathbf{z}\\,$，其加性遗传方差-协方差矩阵为 $\\,\\mathbf{G}\\,$，在线性定向选择下，选择梯度向量为 $\\,\\boldsymbol{\\beta}\\,$，同样的逻辑可将响应推广为\n$$\n\\mathbf{R} \\;=\\; \\mathbf{G}\\,\\boldsymbol{\\beta},\n$$\n选择差向量为 $\\,\\mathbf{S} = \\mathbf{P}\\,\\boldsymbol{\\beta}\\,$，其中 $\\,\\mathbf{P}\\,$ 是表型方差-协方差矩阵。这些是在加性模型和线性选择假设下 Price 方程的标准推论。\n\n通过 delta 方法计算单变量不确定性：\n令 $\\,\\hat{h}^2\\,$ 和 $\\,\\hat{S}\\,$ 为 $\\,h^2\\,$ 和 $\\,S\\,$ 的估计量，其抽样方差分别为 $\\,\\operatorname{Var}(\\hat{h}^2)\\,$ 和 $\\,\\operatorname{Var}(\\hat{S})\\,$，协方差为 $\\,\\operatorname{Cov}(\\hat{h}^2,\\hat{S})\\,$。预测响应的估计量为 $\\,\\hat{R} = \\hat{h}^2 \\hat{S}\\,$。其方差的一阶 delta 方法近似是通过将 $\\,g(h^2, S) = h^2 S\\,$ 在真值附近线性化得到的。其梯度为\n$$\n\\nabla g \\;=\\; \\begin{bmatrix} \\partial g / \\partial h^2 \\\\ \\partial g / \\partial S \\end{bmatrix} \\;=\\; \\begin{bmatrix} S \\\\ h^2 \\end{bmatrix}.\n$$\n因此，方差近似为\n$$\n\\operatorname{Var}(\\hat{R}) \\;\\approx\\; \\begin{bmatrix} S  h^2 \\end{bmatrix}\n\\begin{bmatrix} \\operatorname{Var}(\\hat{h}^2)  \\operatorname{Cov}(\\hat{h}^2,\\hat{S}) \\\\ \\operatorname{Cov}(\\hat{h}^2,\\hat{S})  \\operatorname{Var}(\\hat{S}) \\end{bmatrix}\n\\begin{bmatrix} S \\\\ h^2 \\end{bmatrix}\n\\;=\\; S^2 \\operatorname{Var}(\\hat{h}^2) \\;+\\; (h^2)^2 \\operatorname{Var}(\\hat{S}) \\;+\\; 2 h^2 S \\operatorname{Cov}(\\hat{h}^2,\\hat{S}).\n$$\n在正态近似 $\\,\\hat{R} \\sim \\mathcal{N}(R, \\operatorname{Var}(\\hat{R}))\\,$ 下，一个用于比较观测响应 $\\,R_{\\text{obs}}\\,$ 与预测均值 $\\,R\\,$ 的置信水平为 $\\,0.95\\,$ 的双侧接受域可以实现为\n$$\n\\left| R_{\\text{obs}} - R \\right| \\;\\le\\; z_{0.975}\\, \\sqrt{\\operatorname{Var}(\\hat{R})},\n$$\n其中 $\\,z_{0.975} \\approx 1.96\\,$。如果 $\\,\\operatorname{Var}(\\hat{R}) = 0\\,$，则模型下唯一一致的观测是 $\\,R_{\\text{obs}} = R\\,$（在可忽略的数值容差内）。\n\n多变量不确定性与马氏距离检验：\n假设 $\\,\\mathbf{G}\\,$ 已知，选择梯度估计为 $\\,\\hat{\\boldsymbol{\\beta}} \\sim \\mathcal{N}(\\boldsymbol{\\beta}, \\mathbf{B})\\,$。预测响应的估计量为 $\\,\\hat{\\mathbf{R}} = \\mathbf{G}\\, \\hat{\\boldsymbol{\\beta}}\\,$，根据线性性质，其抽样协方差为\n$$\n\\mathbf{\\Sigma}_R \\;=\\; \\operatorname{Cov}(\\hat{\\mathbf{R}}) \\;=\\; \\mathbf{G}\\, \\mathbf{B}\\, \\mathbf{G}^\\top.\n$$\n给定一个观测响应向量 $\\,\\mathbf{R}_{\\text{obs}}\\,$ 和预测均值 $\\,\\mathbf{R} = \\mathbf{G}\\,\\boldsymbol{\\beta}\\,$，定义差异 $\\,\\boldsymbol{\\delta} = \\mathbf{R}_{\\text{obs}} - \\mathbf{R}\\,$。当 $\\,\\mathbf{\\Sigma}_R\\,$ 是满秩时，马氏平方距离\n$$\nD^2 \\;=\\; \\boldsymbol{\\delta}^\\top \\mathbf{\\Sigma}_R^{-1} \\boldsymbol{\\delta}\n$$\n应与自由度为 $\\,k\\,$（性状数量）的卡方分布的 $\\,0.95\\,$ 分位数进行比较。如果 $\\,D^2 \\le \\chi^2_{0.95;k}\\,$，则接受一致性。\n\n如果 $\\,\\mathbf{\\Sigma}_R\\,$ 是奇异的，写出其特征分解 $\\,\\mathbf{\\Sigma}_R = \\mathbf{Q}\\,\\operatorname{diag}(\\lambda_1,\\dots,\\lambda_k)\\,\\mathbf{Q}^\\top\\,$，其中特征值 $\\,\\lambda_i \\ge 0\\,$。令 $\\,\\mathcal{S}\\,$ 为具有严格正特征值的特征向量所张成的空间，其维度为 $\\,r = \\operatorname{rank}(\\mathbf{\\Sigma}_R)\\,$。该模型意味着在 $\\,\\mathcal{S}\\,$ 之外没有抽样不确定性。因此，一致性的一个必要条件是 $\\,\\boldsymbol{\\delta}\\,$ 在正交补空间 $\\,\\mathcal{S}^\\perp\\,$ 上的投影为零（在数值容差内）。如果此条件不满足，则拒绝一致性。如果满足，则计算\n$$\nD^2 \\;=\\; \\sum_{i:\\,\\lambda_i0} \\frac{(\\mathbf{q}_i^\\top \\boldsymbol{\\delta})^2}{\\lambda_i},\n$$\n并与 $\\,\\chi^2_{0.95;r}\\,$ 进行比较。这等效于使用 Moore–Penrose 伪逆 $\\,\\mathbf{\\Sigma}_R^+\\,$ 和适当的自由度。\n\n我们现在将这些原理应用于测试套件。\n\n案例 $\\,1$（单变量）：\n参数为 $\\,h^2 = 0.5\\,$, $\\,S = 0.2\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.01\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.0025\\,$, $\\,\\operatorname{Cov} = 0.0\\,$, $\\,R_{\\text{obs}} = 0.11\\,$.\n预测 $\\,R = h^2 S = 0.5 \\times 0.2 = 0.1\\,$.\n方差 $\\,\\operatorname{Var}(\\hat{R}) = 0.2^2 \\cdot 0.01 + 0.5^2 \\cdot 0.0025 + 2 \\cdot 0.5 \\cdot 0.2 \\cdot 0 = 0.001025\\,$.\n标准误 $\\,\\sqrt{0.001025} \\approx 0.032016\\,$, 容差范围 $\\,1.96 \\times 0.032016 \\approx 0.06275\\,$.\n绝对差异 $\\,|0.11 - 0.1| = 0.01\\,$ 在容差范围内，因此接受。\n\n案例 $\\,2$（单变量边界情况）：\n$\\,h^2 = 0.0\\,$, $\\,S = 0.6\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.0004\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.01\\,$, $\\,\\operatorname{Cov} = 0\\,$, $\\,R_{\\text{obs}} = 0.02\\,$.\n预测 $\\,R = 0.0\\,$.\n方差 $\\,\\operatorname{Var}(\\hat{R}) = 0.6^2 \\cdot 0.0004 + 0^2 \\cdot 0.01 + 0 = 0.000144\\,$.\n标准误 $\\,\\sqrt{0.000144} = 0.012\\,$, 容差范围 $\\,1.96 \\times 0.012 \\approx 0.02352\\,$.\n绝对差异 $\\,|0.02 - 0.0| = 0.02\\,$ 在容差范围内，因此接受。\n\n案例 $\\,3$（单变量违例）：\n$\\,h^2 = 0.4\\,$, $\\,S = 0.1\\,$, $\\,\\operatorname{Var}(\\hat{h}^2) = 0.0025\\,$, $\\,\\operatorname{Var}(\\hat{S}) = 0.0004\\,$, $\\,\\operatorname{Cov} = 0\\,$, $\\,R_{\\text{obs}} = 0.09\\,$.\n预测 $\\,R = 0.04\\,$.\n方差 $\\,\\operatorname{Var}(\\hat{R}) = 0.1^2 \\cdot 0.0025 + 0.4^2 \\cdot 0.0004 = 0.000025 + 0.000064 = 0.000089\\,$.\n标准误 $\\,\\sqrt{0.000089} \\approx 0.009433\\,$, 容差范围 $\\,1.96 \\times 0.009433 \\approx 0.01849\\,$.\n绝对差异 $\\,|0.09 - 0.04| = 0.05\\,$ 超出容差范围，因此拒绝。\n\n案例 $\\,4$（多变量满秩）：\n$\\,\\mathbf{G} = \\begin{bmatrix} 0.6  0.2 \\\\ 0.2  0.5 \\end{bmatrix}\\,$, $\\,\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} 0.1 \\\\ -0.05 \\end{bmatrix}\\,$, $\\,\\mathbf{B} = \\begin{bmatrix} 0.0009  0.0002 \\\\ 0.0002  0.0004 \\end{bmatrix}\\,$, $\\,\\mathbf{R}_{\\text{obs}} = \\begin{bmatrix} 0.058 \\\\ -0.012 \\end{bmatrix}\\,$.\n预测 $\\,\\mathbf{R} = \\mathbf{G}\\,\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} 0.05 \\\\ -0.005 \\end{bmatrix}\\,$.\n预测协方差 $\\,\\mathbf{\\Sigma}_R = \\mathbf{G}\\,\\mathbf{B}\\,\\mathbf{G}^\\top\\,$ 数值上等于 $\\,\\begin{bmatrix} 0.000388  0.000216 \\\\ 0.000216  0.000176 \\end{bmatrix}\\,$.\n差异 $\\,\\boldsymbol{\\delta} = \\begin{bmatrix} 0.008 \\\\ -0.007 \\end{bmatrix}\\,$.\n马氏平方距离 $\\,D^2 \\approx 2.52\\,$ 且 $\\,\\chi^2_{0.95;2} \\approx 5.991\\,$, 因此接受。\n\n案例 $\\,5$（多变量奇异）：\n$\\,\\mathbf{G} = \\begin{bmatrix} 0.6  0.2 \\\\ 0.2  0.5 \\end{bmatrix}\\,$, $\\,\\hat{\\boldsymbol{\\beta}} = \\begin{bmatrix} 0.1 \\\\ -0.05 \\end{bmatrix}\\,$, $\\,\\mathbf{B} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0009 \\end{bmatrix}\\,$.\n预测 $\\,\\mathbf{R} = \\begin{bmatrix} 0.05 \\\\ -0.005 \\end{bmatrix}\\,$ 同前。预测协方差为 $\\,\\mathbf{\\Sigma}_R = \\mathbf{G}\\,\\mathbf{B}\\,\\mathbf{G}^\\top = 0.0009 \\,\\mathbf{g}\\,\\mathbf{g}^\\top\\,$，其中 $\\,\\mathbf{g} = \\begin{bmatrix} 0.2 \\\\ 0.5 \\end{bmatrix}\\,$，因此秩为 $\\,1\\,$。观测响应指定为 $\\,\\mathbf{R}_{\\text{obs}} = \\mathbf{R} + 0.01 \\,\\mathbf{v}\\,$，其中 $\\,\\mathbf{v} = \\bigl[0.5,\\,-0.2\\bigr]^\\top / \\|\\bigl[0.5,\\,-0.2\\bigr]^\\top\\|\\,$。因为 $\\,\\mathbf{v}^\\top \\mathbf{g} = 0\\,$，此差异完全位于 $\\,\\mathbf{\\Sigma}_R\\,$ 的零空间内，违反了一致性的必要条件。因此拒绝。\n\n按顺序收集布尔结果得到 $\\,\\bigl[\\text{True},\\text{True},\\text{False},\\text{True},\\text{False}\\bigr]\\,$。\n\n程序精确地实现了这些计算，对单变量案例使用正态接受域，对多变量案例使用卡方接受域，并通过特征分解、伪逆、秩确定和零空间一致性检查来适当处理奇异预测协方差。输出是包含按指定顺序和格式排列的五个布尔值列表的单行。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef univariate_check(h2, S, var_h2, var_S, cov_h2_S, R_obs, z975=1.96, tol=1e-12):\n    \"\"\"\n    Compute predicted response R = h2 * S and its delta-method variance,\n    then perform a two-sided Normal 0.95 acceptance check for R_obs.\n    \"\"\"\n    R_pred = h2 * S\n    var_R = (S**2) * var_h2 + (h2**2) * var_S + 2.0 * h2 * S * cov_h2_S\n    if var_R  0:\n        # Numerical guard: variance cannot be negative\n        var_R = 0.0\n    if var_R == 0.0:\n        return abs(R_obs - R_pred) = tol\n    se = np.sqrt(var_R)\n    margin = z975 * se\n    return abs(R_obs - R_pred) = margin\n\ndef multivariate_check(G, beta, Bcov, R_obs, chi2_quantiles={1: 3.841458820694124, 2: 5.991464547107979}, tol_eig=1e-12, tol_null=1e-12):\n    \"\"\"\n    Compute predicted response R = G @ beta and predictive covariance Sigma = G @ Bcov @ G.T.\n    Perform model check using squared Mahalanobis distance and chi-square threshold at 0.95 level.\n    Handle singular Sigma using eigendecomposition:\n      - Reject if discrepancy has any component in the null space beyond tol_null.\n      - Otherwise compute D^2 on the support and compare to chi-square with df = rank(Sigma).\n    \"\"\"\n    G = np.asarray(G, dtype=float)\n    beta = np.asarray(beta, dtype=float).reshape(-1)\n    Bcov = np.asarray(Bcov, dtype=float)\n    R_pred = G @ beta\n    Sigma = G @ Bcov @ G.T\n    delta = np.asarray(R_obs, dtype=float).reshape(-1) - R_pred\n\n    # Eigendecomposition for rank and handling singularity\n    # Use symmetric eigendecomposition\n    w, Q = np.linalg.eigh(Sigma)\n    # Identify positive eigenvalues\n    pos_idx = w > tol_eig\n    lam_pos = w[pos_idx]\n    Q_pos = Q[:, pos_idx]\n    rank = lam_pos.size\n\n    if rank == 0:\n        # No predictive uncertainty at all; accept only if exact match within tolerance\n        return np.linalg.norm(delta) = tol_null\n\n    # Project discrepancy onto support and null space\n    delta_support = Q_pos @ (Q_pos.T @ delta)\n    delta_null = delta - delta_support\n\n    # If there is any component in null space, reject\n    if np.linalg.norm(delta_null) > tol_null:\n        return False\n\n    # Compute D^2 on the support\n    coeffs = Q_pos.T @ delta  # coordinates in eigenbasis on support\n    D2 = np.sum((coeffs**2) / lam_pos)\n\n    # Chi-square threshold at 0.95 for df = rank\n    if rank not in chi2_quantiles:\n        # For ranks beyond provided keys, approximate via Wilson-Hilferty or add more keys as needed.\n        # Here, we conservatively compute using numpy percentile on simulated chi2 if needed,\n        # but to keep deterministic without RNG, fallback to SciPy formula is not allowed; so raise.\n        # Given our test suite uses only ranks 1 or 2, this branch will not be used.\n        raise ValueError(\"Chi-square quantile for df={} not provided.\".format(rank))\n    threshold = chi2_quantiles[rank]\n    return D2 = threshold\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Case 1: univariate typical\n    case1 = (\"uni\", {\n        \"h2\": 0.5,\n        \"S\": 0.2,\n        \"var_h2\": 0.01,\n        \"var_S\": 0.0025,\n        \"cov_h2_S\": 0.0,\n        \"R_obs\": 0.11\n    })\n\n    # Case 2: univariate boundary heritability\n    case2 = (\"uni\", {\n        \"h2\": 0.0,\n        \"S\": 0.6,\n        \"var_h2\": 0.0004,\n        \"var_S\": 0.01,\n        \"cov_h2_S\": 0.0,\n        \"R_obs\": 0.02\n    })\n\n    # Case 3: univariate model violation via environmental shift\n    case3 = (\"uni\", {\n        \"h2\": 0.4,\n        \"S\": 0.1,\n        \"var_h2\": 0.0025,\n        \"var_S\": 0.0004,\n        \"cov_h2_S\": 0.0,\n        \"R_obs\": 0.09\n    })\n\n    # Case 4: multivariate 2 traits, full-rank predictive covariance\n    G4 = np.array([[0.6, 0.2],\n                   [0.2, 0.5]], dtype=float)\n    beta4 = np.array([0.1, -0.05], dtype=float)\n    B4 = np.array([[0.0009, 0.0002],\n                   [0.0002, 0.0004]], dtype=float)\n    # Predicted R for case 4 (not needed to be precomputed, but for constructing R_obs we follow problem)\n    R4_pred = G4 @ beta4\n    R4_obs = np.array([0.058, -0.012], dtype=float)\n    case4 = (\"multi\", {\n        \"G\": G4,\n        \"beta\": beta4,\n        \"Bcov\": B4,\n        \"R_obs\": R4_obs\n    })\n\n    # Case 5: multivariate singular predictive covariance, null-space discrepancy\n    G5 = np.array([[0.6, 0.2],\n                   [0.2, 0.5]], dtype=float)\n    beta5 = np.array([0.1, -0.05], dtype=float)\n    B5 = np.array([[0.0, 0.0],\n                   [0.0, 0.0009]], dtype=float)\n    R5_pred = G5 @ beta5\n    v = np.array([0.5, -0.2], dtype=float)\n    v = v / np.linalg.norm(v)\n    R5_obs = R5_pred + 0.01 * v\n    case5 = (\"multi\", {\n        \"G\": G5,\n        \"beta\": beta5,\n        \"Bcov\": B5,\n        \"R_obs\": R5_obs\n    })\n\n    test_cases = [case1, case2, case3, case4, case5]\n\n    results = []\n    for kind, params in test_cases:\n        if kind == \"uni\":\n            res = univariate_check(\n                h2=params[\"h2\"],\n                S=params[\"S\"],\n                var_h2=params[\"var_h2\"],\n                var_S=params[\"var_S\"],\n                cov_h2_S=params[\"cov_h2_S\"],\n                R_obs=params[\"R_obs\"]\n            )\n            results.append(res)\n        elif kind == \"multi\":\n            res = multivariate_check(\n                G=params[\"G\"],\n                beta=params[\"beta\"],\n                Bcov=params[\"Bcov\"],\n                R_obs=params[\"R_obs\"]\n            )\n            results.append(res)\n        else:\n            # Unknown case type; mark as False\n            results.append(False)\n    \n    return f\"[{','.join(map(str, results))}]\"\n\n# The original problem asks to produce a single line output. \n# For the purpose of this structure, the final result string is computed and would be the answer.\n# Here we just show the code block that would produce it.\n```", "answer": "$$\\boxed{\\bigl[\\text{True},\\text{True},\\text{False},\\text{True},\\text{False}\\bigr]}$$", "id": "2745772"}]}