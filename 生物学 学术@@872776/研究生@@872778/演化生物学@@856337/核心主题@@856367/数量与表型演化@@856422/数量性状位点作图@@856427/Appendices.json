{"hands_on_practices": [{"introduction": "QTL分析的第一步是建立一个能将基因型与连续表型联系起来的数学模型。本练习将指导您实践如何从一个$F_2$群体中观察到的表型数据，通过最小二乘法来估计单个QTL的加性效应（$a$）和显性效应（$d$）[@problem_id:2746560]。这个过程是理解遗传效应对表型变异贡献的基础。", "problem": "一项高级遗传图谱研究调查了一个在由两个近交创始品系衍生的 $F_2$ 群体中分离的双等位基因数量性状位点 (QTL)。假设该性状是一个以毫米为单位记录的连续形态学测量值。假设个体 $i$ 在此位点的表型遵循以下线性模型：\n$$\ny_i \\;=\\; \\mu \\;+\\; a\\,X_{A,i} \\;+\\; d\\,X_{D,i} \\;+\\; \\varepsilon_i,\n$$\n其中 $\\mu$ 是基准均值，$a$ 是加性效应，$d$ 是显性离差，$X_{A,i}$ 和 $X_{D,i}$ 是个体 $i$ 的固定基因型编码，$\\varepsilon_i$ 是独立残差，满足 $\\mathbb{E}[\\varepsilon_i]=0$ 和 $\\mathrm{Var}(\\varepsilon_i)=\\sigma^{2}$。对于双等位基因位点，使用以下标准的加性和显性编码：\n- 对于基因型 $\\mathrm{AA}$：$X_A=-1$，$X_D=0$。\n- 对于基因型 $\\mathrm{AB}$：$X_A=0$，$X_D=1$。\n- 对于基因型 $\\mathrm{BB}$：$X_A=1$，$X_D=0$。\n\n仅从上述模型定义、孟德尔基因型类别 $\\{\\mathrm{AA},\\mathrm{AB},\\mathrm{BB}\\}$ 以及残差独立且 $\\mathbb{E}[\\varepsilon_i]=0$ 的性质出发，首先推导出每个基因型类别下的条件期望表型均值。然后，利用在此模型下类别样本均值是其期望的无偏估计量这一事实，将这些期望与下面观测到的类别均值进行比较，以获得加性效应 $a$ 和显性离差 $d$ 的最小二乘估计值。\n\n观测到的基因型类别样本量和样本均值（单位：毫米）如下：\n- $\\mathrm{AA}$：$n_{\\mathrm{AA}} = 112$，$\\bar{y}_{\\mathrm{AA}} = 9.842$，\n- $\\mathrm{AB}$：$n_{\\mathrm{AB}} = 224$，$\\bar{y}_{\\mathrm{AB}} = 12.115$，\n- $\\mathrm{BB}$：$n_{\\mathrm{BB}} = 108$，$\\bar{y}_{\\mathrm{BB}} = 14.658$。\n\n报告估计值 $\\hat{a}$ 和 $\\hat{d}$ 的数值，保留四位有效数字。答案以毫米为单位表示。最终答案必须仅包含这两个数值，写在同一行，顺序为 $\\hat{a}$ 然后是 $\\hat{d}$。", "solution": "首先将对问题的科学性和逻辑完整性进行验证。\n\n步骤1：提取已知信息。\n问题提供了以下信息：\n1.  一个数量性状 $y_i$ 的线性模型：\n    $$y_i = \\mu + a\\,X_{A,i} + d\\,X_{D,i} + \\varepsilon_i$$\n2.  $\\mu$ 是基准均值，$a$ 是加性效应，$d$ 是显性离差。\n3.  $X_{A,i}$ 和 $X_{D,i}$ 是个体 $i$ 的基因型编码。\n4.  $\\varepsilon_i$ 是独立残差，满足 $\\mathbb{E}[\\varepsilon_i]=0$ 和 $\\mathrm{Var}(\\varepsilon_i)=\\sigma^{2}$。\n5.  双等位基因位点 $\\{\\mathrm{AA}, \\mathrm{AB}, \\mathrm{BB}\\}$ 的基因型编码：\n    -   对于基因型 $\\mathrm{AA}$：$X_A=-1$，$X_D=0$。\n    -   对于基因型 $\\mathrm{AB}$：$X_A=0$，$X_D=1$。\n    -   对于基因型 $\\mathrm{BB}$：$X_A=1$，$X_D=0$。\n6.  观测到的样本量和样本均值：\n    -   $\\mathrm{AA}$：$n_{\\mathrm{AA}} = 112$，$\\bar{y}_{\\mathrm{AA}} = 9.842$。\n    -   $\\mathrm{AB}$：$n_{\\mathrm{AB}} = 224$，$\\bar{y}_{\\mathrm{AB}} = 12.115$。\n    -   $\\mathrm{BB}$：$n_{\\mathrm{BB}} = 108$，$\\bar{y}_{\\mathrm{BB}} = 14.658$。\n\n步骤2：使用提取的已知信息进行验证。\n-   **科学依据**：该模型是数量性状位点 (QTL) 分析中使用的单一位点遗传模型的标准参数化形式。加性效应和显性效应的编码是该领域的常见选择。该设置描述了一个典型的 F2 代杂交实验。该问题在科学上是合理的。\n-   **适定性**：该问题要求从实验数据中估计模型参数。参数的最小二乘估计存在唯一解。所提供的数据是充分且一致的。\n-   **客观性**：该问题使用精确、客观的数学和统计语言陈述，没有歧义或主观论断。\n\n该问题是完整的、一致的且科学有效的。未发现任何缺陷。\n\n步骤3：结论与行动。\n问题有效。将提供完整解答。\n\n第一步是推导三个基因型类别各自的期望表型均值，记为 $\\mu_{\\mathrm{AA}}$、$\\mu_{\\mathrm{AB}}$ 和 $\\mu_{\\mathrm{BB}}$。我们使用给定的线性模型以及残差期望为零的性质，即 $\\mathbb{E}[\\varepsilon_i]=0$。\n\n对于基因型为 $\\mathrm{AA}$ 的个体，编码为 $X_A=-1$ 和 $X_D=0$。其期望表型为：\n$$\n\\mu_{\\mathrm{AA}} = \\mathbb{E}[y | \\text{genotype is AA}] = \\mathbb{E}[\\mu + a(-1) + d(0) + \\varepsilon_i] = \\mu - a + \\mathbb{E}[\\varepsilon_i] = \\mu - a\n$$\n\n对于基因型为 $\\mathrm{AB}$ 的个体，编码为 $X_A=0$ 和 $X_D=1$。其期望表型为：\n$$\n\\mu_{\\mathrm{AB}} = \\mathbb{E}[y | \\text{genotype is AB}] = \\mathbb{E}[\\mu + a(0) + d(1) + \\varepsilon_i] = \\mu + d + \\mathbb{E}[\\varepsilon_i] = \\mu + d\n$$\n\n对于基因型为 $\\mathrm{BB}$ 的个体，编码为 $X_A=1$ 和 $X_D=0$。其期望表型为：\n$$\n\\mu_{\\mathrm{BB}} = \\mathbb{E}[y | \\text{genotype is BB}] = \\mathbb{E}[\\mu + a(1) + d(0) + \\varepsilon_i] = \\mu + a + \\mathbb{E}[\\varepsilon_i] = \\mu + a\n$$\n\n这就建立了一个包含三个线性方程的方程组，将期望基因型值与模型参数 $\\mu$、$a$ 和 $d$ 联系起来：\n1.  $\\mu_{\\mathrm{AA}} = \\mu - a$\n2.  $\\mu_{\\mathrm{AB}} = \\mu + d$\n3.  $\\mu_{\\mathrm{BB}} = \\mu + a$\n\n最小二乘法原理旨在找到使误差平方和 (SSE) $SSE = \\sum_i (y_i - \\mathbb{E}[y_i])^2$ 最小化的参数值。在该模型中，个体被划分为三个不同的基因型组。总的误差平方和可以分解为各组误差平方和的总和：\n$$\nSSE = \\sum_{i \\in \\mathrm{AA}} (y_i - \\mu_{\\mathrm{AA}})^2 + \\sum_{i \\in \\mathrm{AB}} (y_i - \\mu_{\\mathrm{AB}})^2 + \\sum_{i \\in \\mathrm{BB}} (y_i - \\mu_{\\mathrm{BB}})^2\n$$\n为了最小化总的 $SSE$，必须独立地最小化每一项。使某一组的平方和最小化的该组理论均值（例如 $\\mu_{\\mathrm{AA}}$）即为该组观测值的样本均值（例如 $\\bar{y}_{\\mathrm{AA}}$）。因此，基因型均值的最小二乘估计值就是观测到的样本均值：\n$$\n\\hat{\\mu}_{\\mathrm{AA}} = \\bar{y}_{\\mathrm{AA}}, \\quad \\hat{\\mu}_{\\mathrm{AB}} = \\bar{y}_{\\mathrm{AB}}, \\quad \\hat{\\mu}_{\\mathrm{BB}} = \\bar{y}_{\\mathrm{BB}}\n$$\n根据最小二乘估计量的不变性，重新参数化的参数估计值 $(\\hat{\\mu}, \\hat{a}, \\hat{d})$ 可以通过将这些估计出的基因型值代入方程组求解得到：\n1.  $\\hat{\\mu} - \\hat{a} = \\bar{y}_{\\mathrm{AA}}$\n2.  $\\hat{\\mu} + \\hat{d} = \\bar{y}_{\\mathrm{AB}}$\n3.  $\\hat{\\mu} + \\hat{a} = \\bar{y}_{\\mathrm{BB}}$\n\n我们现在求解这个方程组以得到 $\\hat{a}$ 和 $\\hat{d}$。\n为了求 $\\hat{a}$，将方程 (3) 减去方程 (1)：\n$$\n(\\hat{\\mu} + \\hat{a}) - (\\hat{\\mu} - \\hat{a}) = \\bar{y}_{\\mathrm{BB}} - \\bar{y}_{\\mathrm{AA}}\n$$\n$$\n2\\hat{a} = \\bar{y}_{\\mathrm{BB}} - \\bar{y}_{\\mathrm{AA}}\n$$\n$$\n\\hat{a} = \\frac{\\bar{y}_{\\mathrm{BB}} - \\bar{y}_{\\mathrm{AA}}}{2}\n$$\n为了求 $\\hat{d}$，我们首先求出 $\\hat{\\mu}$。将方程 (1) 和方程 (3) 相加：\n$$\n(\\hat{\\mu} - \\hat{a}) + (\\hat{\\mu} + \\hat{a}) = \\bar{y}_{\\mathrm{AA}} + \\bar{y}_{\\mathrm{BB}}\n$$\n$$\n2\\hat{\\mu} = \\bar{y}_{\\mathrm{AA}} + \\bar{y}_{\\mathrm{BB}}\n$$\n$$\n\\hat{\\mu} = \\frac{\\bar{y}_{\\mathrm{AA}} + \\bar{y}_{\\mathrm{BB}}}{2}\n$$\n现在，将 $\\hat{\\mu}$ 的表达式代入方程 (2)：\n$$\n\\hat{d} = \\bar{y}_{\\mathrm{AB}} - \\hat{\\mu} = \\bar{y}_{\\mathrm{AB}} - \\frac{\\bar{y}_{\\mathrm{AA}} + \\bar{y}_{\\mathrm{BB}}}{2}\n$$\n现在我们代入给定的数值：$\\bar{y}_{\\mathrm{AA}} = 9.842$，$\\bar{y}_{\\mathrm{AB}} = 12.115$，以及 $\\bar{y}_{\\mathrm{BB}} = 14.658$。\n\n加性效应的估计值 $\\hat{a}$ 为：\n$$\n\\hat{a} = \\frac{14.658 - 9.842}{2} = \\frac{4.816}{2} = 2.408\n$$\n显性离差的估计值 $\\hat{d}$ 为：\n$$\n\\hat{d} = 12.115 - \\frac{9.842 + 14.658}{2} = 12.115 - \\frac{24.500}{2} = 12.115 - 12.250 = -0.135\n$$\n问题要求答案保留四位有效数字。\n值 $\\hat{a} = 2.408$ 已经有四位有效数字。\n值 $\\hat{d} = -0.135$ 有三位有效数字。为了表示为四位有效数字，我们写成 $\\hat{d} = -0.1350$。\n\n估计的加性效应为 $\\hat{a} = 2.408 \\text{ mm}$，估计的显性离差为 $\\hat{d} = -0.1350 \\text{ mm}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.408  -0.1350\n\\end{pmatrix}\n}\n$$", "id": "2746560"}, {"introduction": "在实际操作中，我们通常无法直接观测到QTL本身的基因型，因此需要利用与其紧密连锁的分子标记来推断它。本练习将带您从第一性原理出发，运用贝叶斯定理和重组率的概念，计算在给定两侧翼标记基因型的情况下，一个个体QTL基因型的后验概率[@problem_id:2746493]。这是区间作图法（interval mapping）的核心逻辑，是“定位”QTL的关键一步。", "problem": "一位研究人员在一个标准的轮回交设计中正在对一个数量性状位点（QTL）进行定位。将两个纯合近交系进行杂交，产生在沿一条染色体排列的三个基因座（$M_1$–$Q$–$M_2$）上均为杂合的 $F_1$ 个体，其中 $M_1$ 和 $M_2$ 是两侧的共显性标记，而 $Q$ 是该数量性状位点。$F_1$ 代是由处于相引相的、具有固定等位基因的亲本杂交而来，因此一条 $F_1$ 同源染色体携带单倍型 $M_1^{A}$–$Q^{Q}$–$M_2^{A}$，另一条则携带 $M_1^{a}$–$Q^{q}$–$M_2^{a}$。将一个 $F_1$ 个体与基因型为 $M_1^{a}$–$Q^{q}$–$M_2^{a}$ 的轮回亲本进行轮回交，产生 $BC_1$ 子代。设 $M_1$ 和 $Q$ 之间的重组率为 $\\theta_1 \\in (0, \\tfrac{1}{2})$，$Q$ 和 $M_2$ 之间的重组率为 $\\theta_2 \\in (0, \\tfrac{1}{2})$。\n\n对于一个特定的 $BC_1$ 个体，在 $M_1$ 处观测到的两侧标记基因型为 $M_1^{A}M_1^{a}$（即等位基因 $A$ 来自于 $F_1$），在 $M_2$ 处为 $M_2^{a}M_2^{a}$（即等位基因 $a$ 来自于 $F_1$）。假设遵循孟德尔分离定律，无选择，无染色单体干涉，且两个相邻区间的重组事件是独立的，即 $M_1$–$Q$ 之间的交换以概率 $\\theta_1$ 发生，$Q$–$M_2$ 之间的交换以概率 $\\theta_2$ 发生，二者相互独立。仅使用贝叶斯定理以及重组率等于杂合子产生的配子中两个基因座发生重组的概率这一定义，从第一性原理出发，推导在给定观测到的两侧标记基因型的条件下，该 $BC_1$ 个体的 QTL 基因型是 $Qq$ 与 $qq$ 的后验概率。\n\n将您的最终答案表示为一个包含两个元素的行向量 $[P(Qq \\mid \\text{markers}), P(qq \\mid \\text{markers})]$，其形式为关于 $\\theta_1$ 和 $\\theta_2$ 的闭合表达式。不要代入数值，也不要进行近似计算。", "solution": "该问题要求在给定两个两侧标记上观测到的基因型的条件下，推导轮回交个体的两种可能的数量性状位点（QTL）基因型的后验概率。我将首先验证问题陈述，然后从第一性原理出发进行严格的推导。\n\n**问题验证**\n\n步骤1：提取已知条件。\n- 考虑一个三点连锁分析，基因座顺序为 $M_1$–$Q$–$M_2$。\n- $F_1$ 代的基因型为 $\\frac{M_1^{A} Q^{Q} M_2^{A}}{M_1^{a} Q^{q} M_2^{a}}$，由两个处于相引相的纯合近交系杂交得到。\n- 将一个 $F_1$ 个体与基因型为 $M_1^{a}–Q^{q}–M_2^{a}$ 的轮回亲本（纯合体 $M_1^a M_1^a Q^q Q^q M_2^a M_2^a$）进行轮回交。\n- $M_1$ 和 $Q$ 之间的重组率为 $\\theta_1 \\in (0, \\frac{1}{2})$。\n- $Q$ 和 $M_2$ 之间的重组率为 $\\theta_2 \\in (0, \\frac{1}{2})$。\n- 对于一个特定的 $BC_1$ 个体，来自 $F_1$ 亲本的等位基因在标记 $M_1$ 处为 $M_1^A$，在标记 $M_2$ 处为 $M_2^a$。\n- 假设：孟德尔分离定律，无选择，无染色单体干涉，以及两个区间内重组事件的独立性。\n- 任务是推导后验概率 $P(Qq \\mid \\text{markers})$ 和 $P(qq \\mid \\text{markers})$。如果 $BC_1$ 个体从 $F_1$ 亲本遗传了 $Q^Q$ 等位基因，其在 QTL 处的基因型为 $Qq$；如果遗传了 $Q^q$ 等位基因，其基因型为 $qq$，因为轮回亲本只提供 $Q^q$ 等位基因。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，是适定且客观的。它描述了遗传学中的一个标准实验设计（三点轮回交），并提出了 QTL 定位中统计推断的一个经典问题。所作的假设是连锁分析入门模型的标准假设。所有必要信息均已提供，且问题可进行数学形式化并内部一致。\n\n步骤3：结论与行动。\n该问题有效。我将继续提供完整的解答。\n\n**推导**\n\n让我们定义假设和证据。\n两个互斥的假设涉及杂合的 $F_1$ 亲本所遗传的 QTL 位点 $Q$ 的等位基因。\n- $H_Q$：由 $F_1$ 亲本遗传的配子包含等位基因 $Q^Q$。这导致 $BC_1$ 个体的基因型为 $Q^Q Q^q$，在问题陈述中记为 $Qq$。\n- $H_q$：由 $F_1$ 亲本遗传的配子包含等位基因 $Q^q$。这导致 $BC_1$ 个体的基因型为 $Q^q Q^q$，记为 $qq$。\n\n证据 $E$ 由 $F_1$ 亲本遗传的、在两侧标记上观测到的等位基因组成。\n- $E$：来自 $F_1$ 亲本的配子在标记 $M_1$ 处包含等位基因 $M_1^A$，在标记 $M_2$ 处包含等位基因 $M_2^a$。\n\n我们的目标是使用贝叶斯定理计算后验概率 $P(H_Q \\mid E)$ 和 $P(H_q \\mid E)$。\n贝叶斯定理表述如下：\n$$P(H_Q \\mid E) = \\frac{P(E \\mid H_Q) P(H_Q)}{P(E)}$$\n$$P(H_q \\mid E) = \\frac{P(E \\mid H_q) P(H_q)}{P(E)}$$\n分母中的项 $P(E)$ 是证据的全概率，由全概率定律给出：\n$$P(E) = P(E \\mid H_Q) P(H_Q) + P(E \\mid H_q) P(H_q)$$\n\n首先，我们确定假设的先验概率 $P(H_Q)$ 和 $P(H_q)$。$F_1$ 个体是杂合的 $Q^Q/Q^q$。根据孟德尔分离定律，在没有选择或分离畸变的情况下，遗传任一等位基因的概率是相等的。\n$$P(H_Q) = \\frac{1}{2}$$\n$$P(H_q) = \\frac{1}{2}$$\n\n接下来，我们确定似然度 $P(E \\mid H_Q)$ 和 $P(E \\mid H_q)$。这些是在 QTL 位点遗传了特定等位基因的条件下，观测到标记数据的概率。\n$F_1$ 亲本的基因型是 $\\frac{M_1^{A} Q^{Q} M_2^{A}}{M_1^{a} Q^{q} M_2^{a}}$。亲本单倍型为 $(M_1^A, Q^Q, M_2^A)$ 和 $(M_1^a, Q^q, M_2^a)$。重组率 $\\theta$ 是一个配子对两个基因座而言是重组型的概率。非重组的概率是 $1-\\theta$。无染色单体干涉的假设意味着在 $M_1-Q$ 和 $Q-M_2$ 区间内的重组事件是独立的。\n\n让我们计算似然度 $P(E \\mid H_Q) = P(\\text{gamete has } M_1^A, M_2^a \\mid \\text{gamete has } Q^Q)$。\n在配子包含 $Q^Q$ 等位基因的条件下，它的来源是携带 $(M_1^A, Q^Q, M_2^A)$ 的亲本染色体。\n为使该配子也包含标记等位基因 $M_1^A$，$M_1$ 到 $Q$ 的区段必须是非重组的。此事件的概率为 $1-\\theta_1$。\n为使该配子也包含标记等位基因 $M_2^a$，$Q$ 到 $M_2$ 的区段必须是重组的，因为亲本染色体携带的是 $M_2^A$。此事件的概率为 $\\theta_2$。\n由于两个区间内重组事件的独立性，该似然度是这些概率的乘积：\n$$P(E \\mid H_Q) = (1-\\theta_1)\\theta_2$$\n\n现在，让我们计算似然度 $P(E \\mid H_q) = P(\\text{gamete has } M_1^A, M_2^a \\mid \\text{gamete has } Q^q)$。\n在配子包含 $Q^q$ 等位基因的条件下，它的来源是携带 $(M_1^a, Q^q, M_2^a)$ 的亲本染色体。\n为使该配子也包含标记等位基因 $M_1^A$，$M_1$ 到 $Q$ 的区段必须是重组的，因为亲本染色体携带的是 $M_1^a$。此事件的概率为 $\\theta_1$。\n为使该配子也包含标记等位基因 $M_2^a$，$Q$ 到 $M_2$ 的区段必须是非重组的。此事件的概率为 $1-\\theta_2$。\n因此，该似然度为：\n$$P(E \\mid H_q) = \\theta_1(1-\\theta_2)$$\n\n现在我们可以计算证据的边际概率 $P(E)$：\n$$P(E) = P(E \\mid H_Q) P(H_Q) + P(E \\mid H_q) P(H_q) = (1-\\theta_1)\\theta_2 \\cdot \\frac{1}{2} + \\theta_1(1-\\theta_2) \\cdot \\frac{1}{2}$$\n$$P(E) = \\frac{1}{2} \\left[ (1-\\theta_1)\\theta_2 + \\theta_1(1-\\theta_2) \\right] = \\frac{1}{2} (\\theta_2 - \\theta_1\\theta_2 + \\theta_1 - \\theta_1\\theta_2) = \\frac{1}{2} (\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2)$$\n\n最后，我们将这些分量代入贝叶斯定理以求得后验概率。\n$Qq$ 基因型的后验概率是：\n$$P(H_Q \\mid E) = P(Qq \\mid \\text{markers}) = \\frac{P(E \\mid H_Q) P(H_Q)}{P(E)} = \\frac{(1-\\theta_1)\\theta_2 \\cdot \\frac{1}{2}}{\\frac{1}{2}(\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2)} = \\frac{(1-\\theta_1)\\theta_2}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2}$$\n\n$qq$ 基因型的后验概率是：\n$$P(H_q \\mid E) = P(qq \\mid \\text{markers}) = \\frac{P(E \\mid H_q) P(H_q)}{P(E)} = \\frac{\\theta_1(1-\\theta_2) \\cdot \\frac{1}{2}}{\\frac{1}{2}(\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2)} = \\frac{\\theta_1(1-\\theta_2)}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2}$$\n\n这两个概率之和为1，符合要求：\n$$\\frac{(1-\\theta_1)\\theta_2 + \\theta_1(1-\\theta_2)}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2} = \\frac{\\theta_2 - \\theta_1\\theta_2 + \\theta_1 - \\theta_1\\theta_2}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2} = \\frac{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2} = 1$$\n最终答案以一个包含两个元素的行向量形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{(1-\\theta_1)\\theta_2}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2}  \\frac{\\theta_1(1-\\theta_2)}{\\theta_1 + \\theta_2 - 2\\theta_1\\theta_2}\n\\end{pmatrix}\n}\n$$", "id": "2746493"}, {"introduction": "在定位了QTL并估计了其效应后，我们需要一个严格的统计检验来判断这个QTL的存在是否具有统计显著性。LOD（优势对数）得分是QTL作图中的黄金标准。本练习将向您展示如何通过比较包含QTL效应的备择模型和不包含该效应的零模型的残差平方和，来计算LOD得分[@problem_id:2746491]，从而量化我们对QTL存在的置信度。", "problem": "在一次旨在定位一个数量性状基因座 (QTL) 的回交实验中，一位研究人员测量了 $n = 120$ 个个体样本的数量表型。将两个嵌套高斯线性模型拟合到该表型上，其中表型是协变量和一个假定标记基因型指示变量的函数。零模型排除了标记效应，而备择模型包含了它。在两个模型中，都假设残差独立同分布于 $\\mathcal{N}(0,\\sigma^{2})$，具有一个共同但未知的方差 $\\sigma^{2}$。通过最大似然法拟合模型后，研究人员得到零模型下的残差平方和为 $\\mathrm{RSS}_{0} = 9.200 \\times 10^{3}$，备择模型下的残差平方和为 $\\mathrm{RSS}_{1} = 8.200 \\times 10^{3}$。\n\n根据定义，该标记处的优势对数 (LOD) 得分为 $\\log_{10}(\\Lambda)$，其中 $\\Lambda$ 是备择模型下的最大化似然与零模型下的最大化似然之比。仅使用这些假设和结果，计算 LOD 得分。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求计算数量性状基因座 (QTL) 分析的优势对数 (LOD) 得分。该问题是良定的，并包含了所有必要的信息。\n\nLOD 得分定义为 $\\log_{10}(\\Lambda)$，其中 $\\Lambda$ 是似然比，由下式给出：\n$$\n\\Lambda = \\frac{L_{1}}{L_{0}}\n$$\n此处，$L_{1}$ 是备择模型（包含标记效应）下的最大化似然，$L_{0}$ 是零模型（排除标记效应）下的最大化似然。\n\n问题陈述，对于两个模型，残差都是独立同分布 (i.i.d.)，服从正态分布 $\\mathcal{N}(0, \\sigma^{2})$。对于一个包含 $n$ 个个体的样本，给定高斯线性模型的似然函数是其参数的函数，这些参数包括回归系数 $\\boldsymbol{\\beta}$ 和方差 $\\sigma^{2}$。似然函数由下式给出：\n$$\nL(\\boldsymbol{\\beta}, \\sigma^{2}) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi\\sigma^{2}}} \\exp\\left(-\\frac{(y_i - \\hat{y}_i(\\boldsymbol{\\beta}))^{2}}{2\\sigma^{2}}\\right)\n$$\n其中 $y_i$ 是个体 $i$ 的观测表型，$\\hat{y}_i(\\boldsymbol{\\beta})$ 是由系数为 $\\boldsymbol{\\beta}$ 的模型预测的值。该表达式可以使用残差平方和 $\\mathrm{RSS}(\\boldsymbol{\\beta}) = \\sum_{i=1}^{n} (y_i - \\hat{y}_i(\\boldsymbol{\\beta}))^{2}$ 重写为：\n$$\nL(\\boldsymbol{\\beta}, \\sigma^{2}) = (2\\pi\\sigma^{2})^{-n/2} \\exp\\left(-\\frac{\\mathrm{RSS}(\\boldsymbol{\\beta})}{2\\sigma^{2}}\\right)\n$$\n为了找到给定模型（零模型或备择模型）的最大化似然，我们必须找到使该函数最大化的 $\\boldsymbol{\\beta}$ 和 $\\sigma^{2}$ 的值。这分两个阶段完成。首先，对于一个固定的 $\\sigma^{2}$，通过最小化 $\\mathrm{RSS}(\\boldsymbol{\\beta})$ 来最大化似然。对于高斯模型，最大似然法等价于估计 $\\boldsymbol{\\beta}$ 的最小二乘法。问题提供了零模型和备择模型的最小化残差平方和，分别为 $\\mathrm{RSS}_{0}$ 和 $\\mathrm{RSS}_{1}$。\n\n其次，我们将最小化的 RSS 代入似然函数，得到一个仅是 $\\sigma^{2}$ 函数的剖面似然：\n$$\nL(\\sigma^{2}) = (2\\pi\\sigma^{2})^{-n/2} \\exp\\left(-\\frac{\\mathrm{RSS}}{2\\sigma^{2}}\\right)\n$$\n为了找到 $\\sigma^{2}$ 的最大似然估计 (MLE)，我们对对数似然 $\\ln L(\\sigma^{2})$ 关于 $\\sigma^{2}$ 求导，并令结果为零。\n$$\n\\ln L(\\sigma^{2}) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{n}{2}\\ln(\\sigma^{2}) - \\frac{\\mathrm{RSS}}{2\\sigma^{2}}\n$$\n$$\n\\frac{d}{d(\\sigma^{2})} \\ln L(\\sigma^{2}) = -\\frac{n}{2\\sigma^{2}} + \\frac{\\mathrm{RSS}}{2(\\sigma^{2})^{2}}\n$$\n将导数设为零，得到 $\\sigma^{2}$ 的 MLE，记为 $\\hat{\\sigma}^{2}$：\n$$\n-\\frac{n}{2\\hat{\\sigma}^{2}} + \\frac{\\mathrm{RSS}}{2(\\hat{\\sigma}^{2})^{2}} = 0 \\implies n\\hat{\\sigma}^{2} = \\mathrm{RSS} \\implies \\hat{\\sigma}^{2} = \\frac{\\mathrm{RSS}}{n}\n$$\n将 $\\hat{\\sigma}^{2} = \\frac{\\mathrm{RSS}}{n}$ 代回剖面似然函数，即可得到模型的最大化似然：\n$$\nL_{max} = \\left(2\\pi \\frac{\\mathrm{RSS}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{\\mathrm{RSS}}{2(\\mathrm{RSS}/n)}\\right) = \\left(\\frac{2\\pi \\mathrm{RSS}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{n}{2}\\right)\n$$\n我们将此一般结果应用于零模型和备择模型。零模型的最大化似然 $L_{0}$ 使用 $\\mathrm{RSS}_{0}$ 求得，备择模型的最大化似然 $L_{1}$ 使用 $\\mathrm{RSS}_{1}$ 求得。\n$$\nL_{0} = \\left(\\frac{2\\pi \\mathrm{RSS}_{0}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{n}{2}\\right)\n$$\n$$\nL_{1} = \\left(\\frac{2\\pi \\mathrm{RSS}_{1}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{n}{2}\\right)\n$$\n因此，似然比 $\\Lambda$ 为：\n$$\n\\Lambda = \\frac{L_{1}}{L_{0}} = \\frac{\\left(\\frac{2\\pi \\mathrm{RSS}_{1}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{n}{2}\\right)}{\\left(\\frac{2\\pi \\mathrm{RSS}_{0}}{n}\\right)^{-n/2} \\exp\\left(-\\frac{n}{2}\\right)} = \\frac{(\\mathrm{RSS}_{1})^{-n/2}}{(\\mathrm{RSS}_{0})^{-n/2}} = \\left(\\frac{\\mathrm{RSS}_{1}}{\\mathrm{RSS}_{0}}\\right)^{-n/2} = \\left(\\frac{\\mathrm{RSS}_{0}}{\\mathrm{RSS}_{1}}\\right)^{n/2}\n$$\nLOD 得分是 $\\Lambda$ 以 10 为底的对数：\n$$\n\\mathrm{LOD} = \\log_{10}(\\Lambda) = \\log_{10}\\left(\\left(\\frac{\\mathrm{RSS}_{0}}{\\mathrm{RSS}_{1}}\\right)^{n/2}\\right) = \\frac{n}{2} \\log_{10}\\left(\\frac{\\mathrm{RSS}_{0}}{\\mathrm{RSS}_{1}}\\right)\n$$\n现在，我们代入给定值：$n = 120$，$\\mathrm{RSS}_{0} = 9.200 \\times 10^{3}$，以及 $\\mathrm{RSS}_{1} = 8.200 \\times 10^{3}$。\n$$\n\\mathrm{LOD} = \\frac{120}{2} \\log_{10}\\left(\\frac{9.200 \\times 10^{3}}{8.200 \\times 10^{3}}\\right) = 60 \\log_{10}\\left(\\frac{9.2}{8.2}\\right)\n$$\n我们进行计算：\n$$\n\\frac{9.2}{8.2} \\approx 1.1219512\n$$\n$$\n\\log_{10}(1.1219512) \\approx 0.04997015\n$$\n$$\n\\mathrm{LOD} \\approx 60 \\times 0.04997015 \\approx 2.998209\n$$\n问题要求将答案四舍五入到四位有效数字。计算出的值为 $2.998209...$。前四位有效数字是 $2$、$9$、$9$ 和 $8$。第五位数字是 $2$，所以我们不向上取整。最终四舍五入后的值为 $2.998$。", "answer": "$$\n\\boxed{2.998}\n$$", "id": "2746491"}]}