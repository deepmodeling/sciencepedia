{"hands_on_practices": [{"introduction": "G-矩阵不仅是数字的集合，它还为进化定义了一个几何景观。此练习将 G-矩阵的代数性质（特别是其特征结构）与其在塑造进化响应中的作用联系起来。通过计算给定选择强度下可能的最大进化响应，您将了解到“最小阻力路线”（line of least resistance）的概念，即 G-矩阵主特征向量所代表的方向，以及最大可演化性如何由其最大特征值决定。[@problem_id:2758130]", "problem": "一个生物体表现出 $3$ 个数量性状。其加性遗传方差-协方差（G）矩阵被估计为\n$$\nG \\;=\\; \\begin{pmatrix}\n2  1  1 \\\\\n1  2  1 \\\\\n1  1  2\n\\end{pmatrix}.\n$$\n假设在一个短期弱选择机制下，平均性状向量的代际变化由加性遗传方差-协方差结构介导的对定向选择的线性响应给出。表型选择梯度被约束为具有固定的欧几里得范数 $b0$，但其方向 $\\hat{s}$ 可以在 $\\|\\hat{s}\\|=1$ 的条件下自由选择。\n\n将单位选择强度下沿方向 $\\hat{s}$ 在一代内的定向响应定义为响应在 $\\hat{s}$ 上的标量投影除以 $b$。对于给定的 $G$，确定在所有单位方向 $\\hat{s}$ 上，此单位选择强度下的定向响应的最大可能值。\n\n请用精确实数表示最终答案，无需四舍五入。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 一个生物体表现出 $3$ 个数量性状。\n- 加性遗传方差-协方差（G）矩阵为 $G = \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix}$。\n- 选择机制为短期且弱。\n- 平均性状向量的代际变化为 $\\Delta \\bar{z} = G\\beta$。\n- 表型选择梯度为 $\\beta$，其被约束为具有固定的欧几里得范数 $b0$ 和一个可以自由选择的方向 $\\hat{s}$，使得 $\\|\\hat{s}\\|=1$。\n- 需要最大化的量是“单位选择强度下沿方向 $\\hat{s}$ 在一代内的定向响应”，定义为响应在 $\\hat{s}$ 上的标量投影除以 $b$。\n\n验证结论：\n该问题具有科学依据。控制方程 $\\Delta \\bar{z} = G \\beta$ 是标准的多变量育种者方程，这是演化数量遗传学中的一个基本概念。给定的 $G$ 矩阵是对称的。要成为一个有效的协方差矩阵，它还必须是正定的。我们将计算 $G$ 的特征值，其结果为 $4$、$1$ 和 $1$。由于所有特征值均为正，所以 $G$ 是正定的。该问题是适定的，因为它要求解一个连续函数（二次型）在一个紧集（单位球面）上的最大值，该最大值保证存在。该问题是客观的，并包含得出唯一解所需的所有信息。该问题被声明为有效。\n\n解：\n在定向选择下，平均性状向量 $\\Delta \\bar{z}$ 的变化由多变量育种者方程给出：\n$$ \\Delta \\bar{z} = G \\beta $$\n选择梯度 $\\beta$ 被指定为大小为 $b  0$，方向由单位向量 $\\hat{s}$ 给出：\n$$ \\beta = b \\hat{s} $$\n其中 $\\hat{s}$ 是 $\\mathbb{R}^3$ 中的一个列向量，满足 $\\|\\hat{s}\\| = \\sqrt{\\hat{s}^T \\hat{s}} = 1$。\n\n将 $\\beta$ 的表达式代入育种者方程，得到响应向量：\n$$ \\Delta \\bar{z} = G (b \\hat{s}) = b (G \\hat{s}) $$\n问题将“单位选择强度下沿方向 $\\hat{s}$ 的定向响应”定义为响应向量 $\\Delta \\bar{z}$ 在选择方向 $\\hat{s}$ 上的标量投影，再除以选择强度 $b$。\n\n向量 $\\vec{u}$ 在单位向量 $\\vec{v}$ 上的标量投影由它们的点积 $\\vec{u} \\cdot \\vec{v}$ 给出。在矩阵表示法中，对于列向量 $u$ 和 $v$，其中 $v$ 是单位向量，这表示为 $v^T u$。\n因此，$\\Delta \\bar{z}$ 在 $\\hat{s}$ 上的标量投影是 $\\hat{s}^T (\\Delta \\bar{z})$。\n因此，需要最大化的量，我们称之为 $R(\\hat{s})$，是：\n$$ R(\\hat{s}) = \\frac{\\hat{s}^T (\\Delta \\bar{z})}{b} $$\n代入 $\\Delta \\bar{z}$ 的表达式：\n$$ R(\\hat{s}) = \\frac{\\hat{s}^T (b G \\hat{s})}{b} = \\hat{s}^T G \\hat{s} $$\n这个量 $\\hat{s}^T G \\hat{s}$ 代表了沿向量 $\\hat{s}$ 方向的加性遗传方差，也称为在 $\\hat{s}$ 方向上的可演化性。\n\n问题现在简化为在 $\\hat{s}$ 是单位向量，即 $\\|\\hat{s}\\| = 1$（或 $\\hat{s}^T \\hat{s} = 1$）的约束条件下，求函数 $R(\\hat{s}) = \\hat{s}^T G \\hat{s}$ 的最大值。\n表达式 $\\frac{\\hat{s}^T G \\hat{s}}{\\hat{s}^T \\hat{s}}$ 是矩阵 $G$ 的瑞利商。由于 $\\hat{s}^T \\hat{s} = 1$，我们实际上是在最大化瑞利商本身。\n对于任何实对称矩阵，其瑞利商的最大值是其最大特征值 $\\lambda_{\\text{max}}$。当 $\\hat{s}$ 是对应于 $\\lambda_{\\text{max}}$ 的单位特征向量时，达到此最大值。\n\n任务是求矩阵 $G$ 的特征值：\n$$ G \\;=\\; \\begin{pmatrix} 2  1  1 \\\\ 1  2  1 \\\\ 1  1  2 \\end{pmatrix} $$\n特征值 $\\lambda$ 是特征方程 $\\det(G - \\lambda I) = 0$ 的根，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n$$ \\det \\begin{pmatrix} 2-\\lambda  1  1 \\\\ 1  2-\\lambda  1 \\\\ 1  1  2-\\lambda \\end{pmatrix} = 0 $$\n一个更有效的方法是识别 $G$ 的结构。我们可以将 $G$ 表示为两个更简单矩阵的和：\n$$ G = I + J $$\n其中 $I = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$ 是单位矩阵，而 $J = \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}$ 是全一矩阵。\n\n大小为 $n \\times n$ 的秩为1的矩阵 $J$ 的特征值为 $n$（重数为 $1$）和 $0$（重数为 $n-1$）。对于 $n=3$， $J$ 的特征值为 $\\{3, 0, 0\\}$。\n设 $v$ 是 $J$ 的一个特征向量，其特征值为 $\\mu_J$。则 $Jv = \\mu_J v$。\n考虑 $G$ 在此特征向量 $v$ 上的作用：\n$$ Gv = (I+J)v = Iv + Jv = v + \\mu_J v = (1+\\mu_J)v $$\n这表明 $v$ 也是 $G$ 的一个特征向量，其特征值为 $\\lambda_G = 1 + \\mu_J$。\n因此，G 的特征值可以通过将 J 的每个特征值加 1 得到。\n$G$ 的特征值为：\n$$ \\lambda_1 = 1 + 3 = 4 $$\n$$ \\lambda_2 = 1 + 0 = 1 $$\n$$ \\lambda_3 = 1 + 0 = 1 $$\n$G$ 的特征值集合是 $\\{4, 1, 1\\}$。\n\n单位选择强度下的定向响应的最大值，$R(\\hat{s}) = \\hat{s}^T G \\hat{s}$，是 $G$ 的最大特征值。\n$$ \\max_{\\|\\hat{s}\\|=1} R(\\hat{s}) = \\lambda_{\\text{max}}(G) = 4 $$\n当选择方向 $\\hat{s}$ 与对应于特征值 $\\lambda=4$ 的特征向量对齐时，出现此最大响应。该特征向量与 $(1, 1, 1)^T$ 成比例，代表了对所有三个性状进行等量增加的选择。\n\n最大可能值为一个精确实数。", "answer": "$$\n\\boxed{4}\n$$", "id": "2758130"}, {"introduction": "虽然 G-矩阵定义了进化的潜力，但它更重要的作用是施加约束。当可用的遗传变异与选择的方向不一致时会发生什么？这个练习探讨了一个由于发育模块化而导致 G-矩阵秩亏的情景，这意味着遗传变异仅存在于整个性状空间的特定子空间中。通过计算进化响应，您将亲眼看到响应向量如何被限制在由遗传模块定义的子空间内，即使选择的方向不同。[@problem_id:2758135]", "problem": "一个种群表现出 $5$ 个在纯加性遗传控制下的数量性状。发育模块化意味着遗传变异局限于两个潜模块，在性状空间中由列向量 $\\mathbf{v}_{1}$ 和 $\\mathbf{v}_{2}$ 表示，因此遗传方差-协方差 (G) 矩阵等于\n$$\n\\mathbf{G} \\;=\\; \\mathbf{v}_{1}\\mathbf{v}_{1}^{\\top} \\;+\\; \\mathbf{v}_{2}\\mathbf{v}_{2}^{\\top}.\n$$\n这两个模块向量是\n$$\n\\mathbf{v}_{1} \\;=\\; \\begin{pmatrix} 2 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\qquad\n\\mathbf{v}_{2} \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}.\n$$\n定向选择作用于这些性状，其表型选择梯度为常数\n$$\n\\boldsymbol{\\beta} \\;=\\; \\begin{pmatrix} 0.5 \\\\ -0.2 \\\\ 0.3 \\\\ 0.0 \\\\ 0.4 \\end{pmatrix}.\n$$\n假设在弱选择和恒定加性遗传结构条件下，短期演化响应满足标准的多变量数量遗传学条件。确定平均性状向量在单代内的预期变化的欧几里得范数。将您的答案四舍五入到四位有效数字，并以无单位的纯数形式报告。", "solution": "所述问题具有科学依据，提法恰当且客观。唯一解所需的所有数据和条件均已提供。该问题是数量遗传学中多变量育种家方程的直接应用，该方程是演化理论的基石。因此，该问题适合进行分析。\n\n平均性状向量的预期单代变化，记为 $\\Delta \\bar{\\mathbf{z}}$，由多变量育种家方程决定：\n$$\n\\Delta \\bar{\\mathbf{z}} = \\mathbf{G}\\boldsymbol{\\beta}\n$$\n其中 $\\mathbf{G}$ 是加性遗传方差-协方差矩阵，$\\boldsymbol{\\beta}$ 是选择梯度。\n\n问题指明，该种群有 $5$ 个性状，$\\mathbf{G}$ 矩阵由两个发育模块 $\\mathbf{v}_{1}$ 和 $\\mathbf{v}_{2}$ 构成，因此：\n$$\n\\mathbf{G} = \\mathbf{v}_{1}\\mathbf{v}_{1}^{\\top} + \\mathbf{v}_{2}\\mathbf{v}_{2}^{\\top}\n$$\n模块向量和选择梯度如下所示：\n$$\n\\mathbf{v}_{1} = \\begin{pmatrix} 2 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{v}_{2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} 0.5 \\\\ -0.2 \\\\ 0.3 \\\\ 0.0 \\\\ 0.4 \\end{pmatrix}\n$$\n为了求出演化响应 $\\Delta \\bar{\\mathbf{z}}$，我们将 $\\mathbf{G}$ 的表达式代入育种家方程：\n$$\n\\Delta \\bar{\\mathbf{z}} = (\\mathbf{v}_{1}\\mathbf{v}_{1}^{\\top} + \\mathbf{v}_{2}\\mathbf{v}_{2}^{\\top})\\boldsymbol{\\beta}\n$$\n根据矩阵乘法的结合律，这可以改写为：\n$$\n\\Delta \\bar{\\mathbf{z}} = \\mathbf{v}_{1}(\\mathbf{v}_{1}^{\\top}\\boldsymbol{\\beta}) + \\mathbf{v}_{2}(\\mathbf{v}_{2}^{\\top}\\boldsymbol{\\beta})\n$$\n这种形式在计算上更高效，因为它避免了显式构造 $5 \\times 5$ 的 $\\mathbf{G}$ 矩阵。它还揭示了选择响应被约束在由模块向量 $\\mathbf{v}_{1}$ 和 $\\mathbf{v}_{2}$ 张成的子空间内。\n\n首先，我们计算选择梯度 $\\boldsymbol{\\beta}$ 在模块向量 $\\mathbf{v}_{1}$ 和 $\\mathbf{v}_{2}$ 上的标量投影。\n\n在 $\\mathbf{v}_{1}$ 上的投影是：\n$$\n\\mathbf{v}_{1}^{\\top}\\boldsymbol{\\beta} = \\begin{pmatrix} 2  0  1  -1  0 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.2 \\\\ 0.3 \\\\ 0.0 \\\\ 0.4 \\end{pmatrix} = (2)(0.5) + (0)(-0.2) + (1)(0.3) + (-1)(0.0) + (0)(0.4) = 1.0 + 0 + 0.3 - 0 + 0 = 1.3\n$$\n在 $\\mathbf{v}_{2}$ 上的投影是：\n$$\n\\mathbf{v}_{2}^{\\top}\\boldsymbol{\\beta} = \\begin{pmatrix} 0  1  1  0  -1 \\end{pmatrix} \\begin{pmatrix} 0.5 \\\\ -0.2 \\\\ 0.3 \\\\ 0.0 \\\\ 0.4 \\end{pmatrix} = (0)(0.5) + (1)(-0.2) + (1)(0.3) + (0)(0.0) + (-1)(0.4) = 0 - 0.2 + 0.3 - 0 - 0.4 = -0.3\n$$\n现在，我们用这些标量系数作为 $\\mathbf{v}_{1}$ 和 $\\mathbf{v}_{2}$ 的线性组合来构造响应向量 $\\Delta \\bar{\\mathbf{z}}$：\n$$\n\\Delta \\bar{\\mathbf{z}} = \\mathbf{v}_{1}(1.3) + \\mathbf{v}_{2}(-0.3) = 1.3 \\begin{pmatrix} 2 \\\\ 0 \\\\ 1 \\\\ -1 \\\\ 0 \\end{pmatrix} - 0.3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2.6 \\\\ 0 \\\\ 1.3 \\\\ -1.3 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -0.3 \\\\ -0.3 \\\\ 0 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 2.6 \\\\ -0.3 \\\\ 1.0 \\\\ -1.3 \\\\ 0.3 \\end{pmatrix}\n$$\n最后一步是计算响应向量 $\\Delta \\bar{\\mathbf{z}}$ 的欧几里得范数，记为 $\\|\\Delta \\bar{\\mathbf{z}}\\|$。范数是其各分量平方和的平方根：\n$$\n\\|\\Delta \\bar{\\mathbf{z}}\\| = \\sqrt{(2.6)^{2} + (-0.3)^{2} + (1.0)^{2} + (-1.3)^{2} + (0.3)^{2}}\n$$\n我们计算各分量的平方：\n$$\n(2.6)^{2} = 6.76 \\\\\n(-0.3)^{2} = 0.09 \\\\\n(1.0)^{2} = 1.00 \\\\\n(-1.3)^{2} = 1.69 \\\\\n(0.3)^{2} = 0.09\n$$\n将这些值相加：\n$$\n\\|\\Delta \\bar{\\mathbf{z}}\\|^{2} = 6.76 + 0.09 + 1.00 + 1.69 + 0.09 = 9.63\n$$\n因此，欧几里得范数是：\n$$\n\\|\\Delta \\bar{\\mathbf{z}}\\| = \\sqrt{9.63} \\approx 3.10322416\n$$\n按要求将结果四舍五入到四位有效数字，得到 $3.103$。", "answer": "$$\\boxed{3.103}$$", "id": "2758135"}, {"introduction": "为了全面理解 G-矩阵的进化后果，我们需要一个超越单一计算的定量指标工具箱。这个综合性练习要求您编写一个程序来计算几个关键指标：可演化性、约束、响应向量的大小以及选择与响应之间的偏转角。通过将此工具箱应用于具有不同结构的各种 G-矩阵，您将培养出分析和解释遗传结构如何塑造进化轨迹的实用技能，从而将抽象理论与实证分析联系起来。[@problem_id:2758140]", "problem": "设计并实现一个程序，在给定一个对称的加性遗传方差-协方差矩阵 $G$ 和一个定向选择梯度向量 $\\beta$ 的情况下，在演化数量遗传学的多元育种家框架下量化可演化性与约束。您必须使用的基本依据是公认的 Lande 多元育种家方程，该方程指出，预期的每代平均性状响应是加性遗传方差-协方差矩阵与选择梯度的乘积。具体来说，出发点是：平均性状的预期响应是由 $G$ 和 $\\beta$ 得到的向量 $\\,\\Delta z\\,$，并且加性遗传方差-协方差（简写为 $G$）是对称且半正定的。您必须从这些基础以及关于协方差、线性代数和向量几何的一般事实中推导出所有要求的量，不得调用任何预先指定的快捷公式。\n\n您的程序必须为每个测试用例计算以下五个量化可演化性与约束的量：\n\n1. 沿选择方向的可演化性，概念上定义为与 $\\beta$ 平行的单位方向上可用的加性遗传方差。这是加性遗传值在与 $\\beta$ 平行的单位向量上投影的方差。\n\n2. 沿选择方向的条件可演化性，概念上定义为，在加性遗传协方差下，为在 $\\beta$ 的单位方向上实现单位响应所需的选择进行映射时获得的曲率的倒数，这等效于在该方向上获得单位响应所需的最小选择强度。如果 $G$ 不可逆，则使用 Moore–Penrose 伪逆，以确保只要该方向不完全在 $G$ 的零空间中，该量就有明确定义。\n\n3. Lande 多元育种家方程下响应向量的模 $\\,\\|\\Delta z\\|_2\\,$。该值必须仅从 $G$ 和 $\\beta$ 计算得出。\n\n4. 响应向量 $\\,\\Delta z\\,$ 与选择梯度向量 $\\,\\beta\\,$ 之间的夹角，以弧度为单位。该夹角必须使用欧几里得内积和欧几里得范数计算。\n\n5. 单位选择方向与 $G$ 的主特征向量（对应最大特征值的特征向量）之间对齐的余弦平方。该值量化了选择与最大加性遗传方差方向的对齐程度。\n\n所有计算都必须以纯数学和算法术语表示。角度必须以弧度报告。所有浮点输出都应四舍五入到 $6$ 位小数。\n\n您的程序必须处理以下测试套件。每个用例提供 $G$ 和 $\\beta$。在每个用例中，$G$ 都是对称且半正定的，并且 $\\beta \\neq 0$。\n\n- 用例 $1$ (理想情况, $3 \\times 3$):\n  $$\n  G = \\begin{bmatrix}\n  0.8  0.2  0.1 \\\\\n  0.2  0.5  0.05 \\\\\n  0.1  0.05  0.3\n  \\end{bmatrix},\\quad\n  \\beta = \\begin{bmatrix} 0.4 \\\\ -0.2 \\\\ 0.1 \\end{bmatrix}.\n  $$\n\n- 用例 $2$ (近奇异轴, $3 \\times 3$):\n  $$\n  G = \\begin{bmatrix}\n  10^{-6}  0  0 \\\\\n  0  0.4  0.2 \\\\\n  0  0.2  0.2\n  \\end{bmatrix},\\quad\n  \\beta = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}.\n  $$\n\n- 用例 $3$ (对角结构, $2 \\times 2$):\n  $$\n  G = \\begin{bmatrix}\n  0.5  0 \\\\\n  0  0.1\n  \\end{bmatrix},\\quad\n  \\beta = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}.\n  $$\n\n- 用例 $4$ (具有主导子空间的强协方差, $3 \\times 3$):\n  $$\n  G = \\begin{bmatrix}\n  1.0  0.9  0 \\\\\n  0.9  1.0  0 \\\\\n  0  0  0.1\n  \\end{bmatrix},\\quad\n  \\beta = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}.\n  $$\n\n您的程序必须输出一行，其中包含一个列表，每个测试用例对应一个条目，并保持上面给出的用例顺序。每个条目本身必须是一个包含五个浮点数的列表，顺序如下：\n\n$[$ 沿选择方向的可演化性, 条件可演化性, 响应模长 $\\,\\|\\Delta z\\|_2\\,$, $\\,\\Delta z\\,$ 与 $\\,\\beta\\,$ 之间的夹角（弧度）, 与主特征向量对齐的余弦平方 $]$,\n\n所有值都四舍五入到 $6$ 位小数。最终输出必须是单行，格式完全如下（无空格）：\n\n$[ [x_{11},x_{12},x_{13},x_{14},x_{15}], [x_{21},x_{22},x_{23},x_{24},x_{25}], [x_{31},x_{32},x_{33},x_{34},x_{35}], [x_{41},x_{42},x_{43},x_{44},x_{45}] ]$\n\n作为以逗号分隔并用方括号括起来的列表。将每个 $x_{ij}$ 替换为您为用例 $i$ 和量 $j$ 计算并四舍五入后的浮点数。", "solution": "该问题要求基于基础的 Lande 多元育种家方程 $\\Delta z = G \\beta$，计算五个关于可演化性与约束的定量指标。在此，$\\Delta z$ 是平均性状值的演化响应向量，$G$ 是对称、半正定的加性遗传方差-协方差矩阵，$\\beta$ 是定向选择梯度向量。每个指标的推导都必须基于应用于演化理论的线性代数和统计学的第一性原理。\n\n对于几个测试用例，我们给定了矩阵 $G$ 和向量 $\\beta$。所有矩阵 $G$ 都被说明是对称且半正定的，并且 $\\beta \\neq 0$。\n\n首先，我们建立选择方向上的单位向量，这对于几个要求的量至关重要。该向量表示为 $\\hat{\\beta}$，计算方式如下：\n$$ \\hat{\\beta} = \\frac{\\beta}{\\|\\beta\\|_2} $$\n其中 $\\|\\beta\\|_2 = \\sqrt{\\beta^T \\beta}$ 是 $\\beta$ 的欧几里得范数。\n\n我们现在将推导五个所要求量的表达式。\n\n**1. 沿选择方向的可演化性**\n\n这个量在概念上被定义为选择方向上的加性遗传方差。设 $a$ 为性状的加性遗传值随机向量，其协方差矩阵为 $\\text{cov}(a) = G$。$a$ 在选择单位方向 $\\hat{\\beta}$ 上的投影是一个标量随机变量 $p_{a}$，由点积给出：\n$$ p_a = a^T \\hat{\\beta} $$\n我们寻求的是这个投影值的方差。使用随机向量线性变换方差的标准公式 $V(C^T X) = C^T \\text{cov}(X) C$，我们可以代入 $X=a$ 和 $C=\\hat{\\beta}$：\n$$ V(p_a) = \\hat{\\beta}^T \\text{cov}(a) \\hat{\\beta} = \\hat{\\beta}^T G \\hat{\\beta} $$\n代入 $\\hat{\\beta}$ 的表达式，我们得到沿选择方向的可演化性的公式，我们将其表示为 $e(\\beta)$:\n$$ e(\\beta) = \\left( \\frac{\\beta}{\\|\\beta\\|_2} \\right)^T G \\left( \\frac{\\beta}{\\|\\beta\\|_2} \\right) = \\frac{\\beta^T G \\beta}{\\beta^T \\beta} $$\n这个表达式是矩阵 $G$ 对于向量 $\\beta$ 的瑞利商。\n\n**2. 沿选择方向的条件可演化性**\n\n这个量被描述为与“在该方向上获得单位响应所需的最小选择强度”相关。在数量遗传学中，一个标准的解释是根据选择成本来定义它。为实现特定的响应向量 $\\delta$，所需的选择梯度为 $\\beta_{req} = G^+ \\delta$，其中 $G^+$ 是 $G$ 的 Moore-Penrose 伪逆。为了实现一个纯粹在 $\\hat{\\beta}$ 方向上且大小为单位的响应，我们设 $\\delta = \\hat{\\beta}$。这种选择的“成本”可以通过它引起的适应度方差来衡量，即 $\\beta_{req}^T G \\beta_{req}$。\n让我们计算这个成本：\n$$ \\text{成本} = (G^+ \\hat{\\beta})^T G (G^+ \\hat{\\beta}) = \\hat{\\beta}^T (G^+)^T G G^+ \\hat{\\beta} $$\n使用属性 $(G^+)^T = (G^T)^+ = G^+$（因为 $G$ 是对称的）和 $G^+ G G^+ = G^+$，这可以简化为：\n$$ \\text{成本} = \\hat{\\beta}^T G^+ \\hat{\\beta} $$\n条件可演化性，表示为 $c(\\beta)$，被定义为此成本的倒数。\n$$ c(\\beta) = \\frac{1}{\\hat{\\beta}^T G^+ \\hat{\\beta}} = \\frac{1}{\\left( \\frac{\\beta}{\\|\\beta\\|_2} \\right)^T G^+ \\left( \\frac{\\beta}{\\|\\beta\\|_2} \\right)} = \\frac{\\beta^T \\beta}{\\beta^T G^+ \\beta} $$\n根据问题要求使用伪逆，即使当 $G$ 是奇异的时，这个公式也是稳健且有明确定义的。\n\n**3. 响应向量的模, $\\|\\Delta z\\|_2$**\n\n这是 Lande 方程的直接应用。首先，我们计算响应向量 $\\Delta z$：\n$$ \\Delta z = G \\beta $$\n然后，我们计算它的欧几里得范数：\n$$ \\|\\Delta z\\|_2 = \\sqrt{ (\\Delta z)^T (\\Delta z) } = \\sqrt{ (G\\beta)^T (G\\beta) } = \\sqrt{ \\beta^T G^T G \\beta } $$\n由于 $G$ 是对称的 ($G^T = G$)，这等价于 $\\sqrt{\\beta^T G^2 \\beta}$。为了计算，最直接的方法是先计算向量 $\\Delta z = G\\beta$，然后求其范数。\n\n**4. 响应向量 $\\Delta z$ 与选择梯度 $\\beta$ 之间的夹角**\n\n两个非零向量 $u$ 和 $v$ 之间的夹角 $\\theta$ 由源自欧几里得内积的公式给出：\n$$ \\cos(\\theta) = \\frac{u^T v}{\\|u\\|_2 \\|v\\|_2} $$\n在我们的情况下，$u = \\Delta z = G\\beta$ 且 $v = \\beta$。因此，夹角为：\n$$ \\theta = \\arccos\\left( \\frac{(G\\beta)^T \\beta}{\\|G\\beta\\|_2 \\|\\beta\\|_2} \\right) = \\arccos\\left( \\frac{\\beta^T G \\beta}{\\|G\\beta\\|_2 \\|\\beta\\|_2} \\right) $$\n$\\theta$ 的值量化了演化响应与选择方向对齐的程度。$\\theta = 0$ 表示完全对齐，而 $\\theta  0$ 表示遗传相关（$G$ 的非对角元素）导致种群向不同于选择所偏好的方向演化。由于 $G$ 是半正定的，$\\beta^T G \\beta \\geq 0$，所以夹角 $\\theta$ 将在 $[0, \\pi/2]$ 弧度范围内。\n\n**5. 与主特征向量对齐的余弦平方**\n\n该指标评估选择方向与最大遗传方差方向的对齐程度。$G$ 的特征向量代表了遗传变异的主轴，相应的特征值代表了沿这些轴的方差量。\n计算步骤如下：\n1. 对称矩阵 $G$ 进行特征分解，找到其特征值 $\\lambda_i$ 和相应的特征向量 $v_i$。\n2. 识别主特征向量 $v_{max}$，即对应于最大特征值 $\\lambda_{max}$ 的特征向量。该向量代表了最大加性遗传方差 ($g_{max}$) 的方向。我们假设它被归一化为单位长度，即 $\\|v_{max}\\|_2 = 1$。\n3. 归一化选择梯度向量以获得单位选择方向，$\\hat{\\beta} = \\beta / \\|\\beta\\|_2$。\n4. $v_{max}$ 和 $\\hat{\\beta}$ 之间夹角 $\\phi$ 的余弦是它们的点积：$\\cos(\\phi) = v_{max}^T \\hat{\\beta}$。\n5. 所求的量是此余弦的平方：\n$$ (\\cos(\\phi))^2 = (v_{max}^T \\hat{\\beta})^2 $$\n这个值范围从 $0$ 到 $1$，衡量对齐程度。值为 $1$ 表示选择作用于最大遗传方差的方向，而值为 $0$ 表示它作用于与之正交的方向。\n\n这五个推导出的公式构成了计算实现的基础。将为给定的测试用例计算每一个公式。", "answer": "[[0.359524,1.166304,0.198368,0.485741,0.509745],[0.000001,0.000001,0.000001,0.000000,1.000000],[0.300000,0.166667,0.424264,0.785398,0.500000],[0.100000,0.100000,0.100000,0.000000,0.000000]]", "id": "2758140"}]}