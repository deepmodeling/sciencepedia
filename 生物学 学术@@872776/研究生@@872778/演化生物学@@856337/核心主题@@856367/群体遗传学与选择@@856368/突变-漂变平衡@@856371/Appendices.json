{"hands_on_practices": [{"introduction": "量化群体内的遗传变异是演化生物学的一项核心任务。这项基础练习将引导您从中性溯祖理论的第一性原理出发，推导分离位点数 $S$ 的期望值。掌握这一推导过程，能将有效群体大小 $N_e$ 和突变率 $\\mu$ 等抽象概念与可观测的量直接联系起来，为理解突变-漂变平衡下的多态性奠定基石。", "problem": "一个大小恒定的泛交二倍体种群处于突变-漂变平衡状态，其有效种群大小为 $N_{e}$。考虑一个随机抽取的样本，包含 $n$ 条同源序列，每条序列长度为 $L$ 个位点。这些序列在中性条件下根据无限位点模型（ISM）演化。突变以每个位点每代 $\\mu$ 的速率，作为泊松过程沿着谱系分支发生。令 $S$ 表示在 $L$ 个位点中，样本里观察到的分离位点的总数。假设一个大小恒定种群的标准中性溯祖模型，其中当存在 $k$ 个祖先谱系时（$k \\in \\{2,\\dots,n\\}$），到下一个溯祖事件的等待时间 $T_{k}$ 服从指数分布，其均值 $\\mathbb{E}[T_{k}]$ 取决于 $k$ 和 $N_{e}$。将该样本的种群尺度突变参数 $\\theta$ 定义为 $\\theta = 4 N_{e} \\mu L$。\n\n仅从这些基础和上述定义出发，推导 $\\mathbb{E}[S]$ 关于 $\\theta$ 和 $n$ 的闭式表达式。您的推导应将 $\\mathbb{E}[S]$ 与谱系的期望总分支长度联系起来，并应指明和解释为什么对 $n$ 的依赖性呈现为调和数 $a_{n-1}$ 的形式。对于最终答案，请仅使用 $\\theta$、$n$ 和标准数学函数提供 $\\mathbb{E}[S]$ 的闭式表达式，无需进行数值计算。无需四舍五入，最终答案中也不应报告任何单位。", "solution": "我们从无限位点模型（ISM）和恒定有效种群大小 $N_{e}$ 下的中性溯祖模型开始。在 ISM 下，对于一个固定的包含 $n$ 个抽样序列的谱系，突变以每个位点每代 $\\mu$ 的速率，作为泊松过程沿着谱系的分支发生。在 $L$ 个独立位点上，沿一个分支的总突变率为 $L \\mu$，因此在整个谱系上突变总数的条件分布是泊松分布，其均值为 $L \\mu$ 乘以总分支长度（以世代为单位）。因为在 ISM 下，一个位点只要发生过至少一次突变就会成为分离位点，且不允许重复突变，所以分离位点的期望数等于谱系中突变总数的期望值。因此，\n$$\n\\mathbb{E}[S] \\;=\\; L \\mu \\cdot \\mathbb{E}\\!\\left[\\text{total branch length of the genealogy in generations}\\right].\n$$\n\n因此，任务简化为计算样本谱系的期望总分支长度。在恒定大小的二倍体种群的标准中性溯祖模型下，当有 $k$ 个祖先谱系时，到下一个溯祖事件的时间 $T_{k}$ 服从指数分布，其速率为 $\\binom{k}{2}/(2 N_{e})$，所以其均值为\n$$\n\\mathbb{E}[T_{k}] \\;=\\; \\frac{2 N_{e}}{\\binom{k}{2}} \\;=\\; \\frac{2 N_{e}}{k(k-1)/2} \\;=\\; \\frac{4 N_{e}}{k(k-1)}.\n$$\n在有 $k$ 个谱系的时期，存在 $k$ 个分支，因此该时期对总分支长度的贡献是 $k T_{k}$。将从 $k=n$ 到 $k=2$ 的所有时期的贡献相加，期望总分支长度为\n$$\n\\mathbb{E}\\!\\left[\\text{total branch length}\\right]\n\\;=\\; \\sum_{k=2}^{n} k \\, \\mathbb{E}[T_{k}]\n\\;=\\; \\sum_{k=2}^{n} k \\cdot \\frac{4 N_{e}}{k(k-1)}\n\\;=\\; 4 N_{e} \\sum_{k=2}^{n} \\frac{1}{k-1}.\n$$\n将索引重标记为 $i = k-1$ 可得\n$$\n\\mathbb{E}\\!\\left[\\text{total branch length}\\right]\n\\;=\\; 4 N_{e} \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\n\n将此代入 $\\mathbb{E}[S]$ 的表达式中，得到\n$$\n\\mathbb{E}[S]\n\\;=\\; L \\mu \\cdot 4 N_{e} \\sum_{i=1}^{n-1} \\frac{1}{i}\n\\;=\\; \\left(4 N_{e} \\mu L\\right) \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\n根据定义 $\\theta = 4 N_{e} \\mu L$，我们得到闭式\n$$\n\\mathbb{E}[S] \\;=\\; \\theta \\sum_{i=1}^{n-1} \\frac{1}{i}.\n$$\n\n为了解释对调和数的依赖性：和 $\\sum_{i=1}^{n-1} \\frac{1}{i}$ 是第 $(n-1)$ 个调和数，通常表示为 $a_{n-1}$。它之所以出现，是因为有 $k$ 个谱系时，溯祖事件之间的期望等待时间与 $\\mathbb{E}[T_{k}] \\propto \\frac{1}{k(k-1)}$ 成正比，而在此期间有 $k$ 个并存的分支。因此，乘积 $k \\cdot \\mathbb{E}[T_{k}]$ 与 $\\frac{1}{k-1}$ 成正比，将这些从 $k=2$ 到 $k=n$ 的贡献相加，便产生了调和级数 $\\sum_{i=1}^{n-1} \\frac{1}{i}$。直观地看，随着 $n$ 的增长，新增的抽样谱系会增加越来越短的溯祖间隔，但由于在这些间隔中有更多的谱系存在，每个阶段贡献的项与（谱系数量减 1）成反比，从而产生了调和数的结构。", "answer": "$$\\boxed{\\theta \\sum_{i=1}^{n-1} \\frac{1}{i}}$$", "id": "2737613"}, {"introduction": "除了简单地预测总变异量，我们还可以利用变异的精细模式来推断关键的群体参数。本练习要求您基于位点频率谱（SFS）为群体突变率 $\\theta$ 构建一个统计估计量。通过在泊松随机场近似下应用最大似然估计框架，您将学习如何将关于SFS的理论预测转化为一种从真实序列数据中估计 $\\theta$ 的稳健方法。", "problem": "考虑一个在无限位点假设下，根据中性赖特-费希尔模型在突变-漂变平衡下演化的随机交配群体。设标度突变率为 $\\theta = 4 N_{e} \\mu$，其中 $N_{e}$ 是有效群体大小，$\\mu$ 是每代每个位点的突变率。从一个大小为 $n$ 的单倍体基因组样本（$n \\geq 2$）中，您观察到非折叠的位点频率谱（SFS），定义为计数向量 $\\boldsymbol{\\xi} = (\\xi_{1}, \\xi_{2}, \\ldots, \\xi_{n-1})$，其中 $\\xi_{i}$ 是衍生等位基因在样本中恰好出现 $i$ 次的分离位点的数量。\n\n使用中性条件和无限位点模型下的标准溯祖结果，即期望SFS满足 $\\mathbb{E}[\\xi_{i}] = \\theta a_{i}$，其中 $a_{i} = 1/i$，对于 $i \\in \\{1, 2, \\ldots, n-1\\}$。采用泊松随机场近似，将计数 $\\{\\xi_{i}\\}_{i=1}^{n-1}$ 视为均值为 $\\{\\theta a_{i}\\}_{i=1}^{n-1}$ 的独立泊松随机变量。\n\n任务：\n- 基于这些假设，构建 $\\theta$ 的复合似然（CL）函数 $L_{c}(\\theta \\mid \\boldsymbol{\\xi})$。\n- 推导得分函数 $U(\\theta) = \\frac{\\partial}{\\partial \\theta} \\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi})$ 并求解 $U(\\theta) = 0$，以获得 $\\theta$ 的最大似然估计（MLE）关于 $\\{\\xi_{i}\\}$ 和 $n$ 的闭式表达式。\n\n以 $\\theta$ 的MLE的单个闭式解析表达式的形式提供您的最终答案。不要包含任何单位。您不需要执行任何数值计算或四舍五入。", "solution": "任务是找到标度突变率 $\\theta$ 的最大似然估计（MLE）。推导过程分三步进行：构建似然函数，求对数似然及其导数（得分函数），以及求解使得分函数为零的参数值。\n\n首先，我们构建复合似然函数 $L_{c}(\\theta \\mid \\boldsymbol{\\xi})$。根据泊松随机场近似，每个观测到的计数 $\\xi_{i}$ 是一个均值为 $\\lambda_{i} = \\mathbb{E}[\\xi_{i}] = \\theta a_{i} = \\theta/i$ 的泊松随机变量的独立实现。均值为 $\\lambda$ 的泊松随机变量 $X$ 的概率质量函数（PMF）是 $P(X=k) = \\frac{\\lambda^{k} \\exp(-\\lambda)}{k!}$。\n鉴于计数 $\\{\\xi_{i}\\}_{i=1}^{n-1}$ 的独立性，总似然是每个 $i$ 的个体概率的乘积：\n$$L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\prod_{i=1}^{n-1} P(\\text{count}=\\xi_{i} \\mid \\text{mean}=\\theta/i) = \\prod_{i=1}^{n-1} \\frac{(\\theta/i)^{\\xi_{i}} \\exp(-\\theta/i)}{\\xi_{i}!}$$\n\n其次，为了简化求导，我们使用似然函数的自然对数，即对数似然 $\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi})$：\n$$\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\ln \\left( \\prod_{i=1}^{n-1} \\frac{(\\theta/i)^{\\xi_{i}} \\exp(-\\theta/i)}{\\xi_{i}!} \\right)$$\n利用对数的性质，乘积变成和：\n$$\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\sum_{i=1}^{n-1} \\ln \\left( \\frac{(\\theta/i)^{\\xi_{i}} \\exp(-\\theta/i)}{\\xi_{i}!} \\right)$$\n$$\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\sum_{i=1}^{n-1} \\left[ \\ln((\\theta/i)^{\\xi_{i}}) + \\ln(\\exp(-\\theta/i)) - \\ln(\\xi_{i}!) \\right]$$\n$$\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\sum_{i=1}^{n-1} \\left[ \\xi_{i} \\ln(\\theta/i) - \\frac{\\theta}{i} - \\ln(\\xi_{i}!) \\right]$$\n我们可以进一步展开项 $\\ln(\\theta/i) = \\ln(\\theta) - \\ln(i)$：\n$$\\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\sum_{i=1}^{n-1} \\left[ \\xi_{i} \\ln(\\theta) - \\xi_{i} \\ln(i) - \\frac{\\theta}{i} - \\ln(\\xi_{i}!) \\right]$$\n得分函数 $U(\\theta)$ 是对数似然函数关于 $\\theta$ 的一阶导数：\n$$U(\\theta) = \\frac{\\partial}{\\partial \\theta} \\ln L_{c}(\\theta \\mid \\boldsymbol{\\xi}) = \\frac{\\partial}{\\partial \\theta} \\sum_{i=1}^{n-1} \\left[ \\xi_{i} \\ln(\\theta) - \\xi_{i} \\ln(i) - \\frac{\\theta}{i} - \\ln(\\xi_{i}!) \\right]$$\n逐项对 $\\theta$ 求导：\n$$U(\\theta) = \\sum_{i=1}^{n-1} \\left[ \\frac{\\partial}{\\partial \\theta}(\\xi_{i} \\ln(\\theta)) - \\frac{\\partial}{\\partial \\theta}\\left(\\frac{\\theta}{i}\\right) \\right]$$\n项 $\\xi_{i} \\ln(i)$ 和 $\\ln(\\xi_{i}!)$ 是关于 $\\theta$ 的常数，它们的导数为零。\n$$U(\\theta) = \\sum_{i=1}^{n-1} \\left[ \\frac{\\xi_{i}}{\\theta} - \\frac{1}{i} \\right]$$\n这可以改写为：\n$$U(\\theta) = \\frac{1}{\\theta} \\left(\\sum_{i=1}^{n-1} \\xi_{i}\\right) - \\left(\\sum_{i=1}^{n-1} \\frac{1}{i}\\right)$$\n\n第三，为了找到记为 $\\hat{\\theta}$ 的MLE，我们将得分函数设为零，$U(\\hat{\\theta}) = 0$，并求解 $\\hat{\\theta}$：\n$$\\frac{1}{\\hat{\\theta}} \\left(\\sum_{i=1}^{n-1} \\xi_{i}\\right) - \\left(\\sum_{i=1}^{n-1} \\frac{1}{i}\\right) = 0$$\n$$\\frac{1}{\\hat{\\theta}} \\left(\\sum_{i=1}^{n-1} \\xi_{i}\\right) = \\sum_{i=1}^{n-1} \\frac{1}{i}$$\n求解 $\\hat{\\theta}$ 得到MLE的最终表达式：\n$$\\hat{\\theta} = \\frac{\\sum_{i=1}^{n-1} \\xi_{i}}{\\sum_{i=1}^{n-1} \\frac{1}{i}}$$\n分子 $\\sum_{i=1}^{n-1} \\xi_{i}$ 是在大小为 $n$ 的样本中观测到的分离位点的总数。分母是第 $(n-1)$ 个调和数。这个估计量通常被称为Watterson估计量，$\\hat{\\theta}_{W}$。", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{n-1} \\xi_{i}}{\\sum_{i=1}^{n-1} \\frac{1}{i}}}$$", "id": "2737559"}, {"introduction": "数据分析中的一个关键步骤是检验我们所用模型的假设是否成立。本练习将介绍经典的Tajima's D统计量，这是一种检验标准中性分子演化模型的方法。您将探索为什么两种不同的 $\\theta$ 估计量（$\\hat{\\pi}$ 和 $\\hat{\\theta}_W$）在中性模型下期望相等，但在存在选择或群体动态变化时会发生偏离，从而使它们的差异成为理解塑造群体演化力量的有力诊断工具。", "problem": "一个恒定有效大小的随机交配二倍体种群，在无限位点突变模型下中性演化，每个位点的突变率为 $\\mu$，且世代不重叠。设 $N_e$ 表示有效种群大小，定义 $\\theta \\equiv 4 N_e \\mu$。从该种群中抽取一个大小为 $n$ 的序列样本。考虑两种经典的 $\\theta$ 的单位点估计量：(i) 平均成对核苷酸多样性 $\\hat{\\pi}$（样本中所有 $\\binom{n}{2}$ 对序列间每位点的平均差异数），以及 (ii) Watterson 估计量 $\\hat{\\theta}_W \\equiv S/(a_{n-1} L)$，其中 $S$ 是长度为 $L$ 个位点的基因座上分离位点的数量，而 $a_{n-1} \\equiv \\sum_{i=1}^{n-1} 1/i$。\n\n从标准中性模型（SNM；中性演化、恒定 $N_e$、随机交配和无限位点突变过程）下的基本溯祖期望出发，确定对于任何 $n \\ge 2$ 时 $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ 的期望值，并根据预期的成对溯祖时间和预期的总谱系分支长度来解释为什么该期望值取这个值。然后，解释观察到的 $\\hat{\\pi} - \\hat{\\theta}_W$ 与其 SNM 期望值的偏差符号如何通过位点频率谱（多态性位点上等位基因频率的分布）的扭曲来指示对突变-漂变平衡的偏离。\n\n下列哪些陈述是正确的？\n\nA. 在无限位点 SNM 模型下，对于任何样本大小 $n$，$\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$，因为 $\\hat{\\pi}$ 和 $\\hat{\\theta}_W$ 都是 $\\theta = 4 N_e \\mu$ 的无偏估计量。观察到 $\\hat{\\pi}  \\hat{\\theta}_W$ 表明相对于突变-漂变平衡，中等频率变异过多，这符合平衡选择或种群分化的预期。\n\nB. 在 SNM 模型下，重组的存在会使 $\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ 偏离 $0$，因为重组减少了位点间的连锁不平衡。\n\nC. 观察到 $\\hat{\\pi} - \\hat{\\theta}_W  0$ 是低频多态性过多的特征，这符合近期种群扩张、针对有害变异的纯化选择或近期硬选择性清除之后的预期。\n\nD. 在任何处于突变-漂变平衡的人口统计学情景中，即使种群近期大小发生了变化，$\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = 0$。\n\nE. 在 SNM 模型下，$\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$ 通过谐波数项 $a_{n-1}$ 依赖于 $n$，因此除非 $n$ 很大，否则它通常不为 $0$。", "solution": "这个问题的核心是理解在标准中性模型（SNM）下，种群突变率 $\\theta = 4N_e\\mu$ 的两个不同估计量的期望值，以及当模型假设被违反时，它们之间的差异如何表现。\n\n**1. SNM下估计量的期望值**\n\n*   **核苷酸多样性的期望值, $\\mathbb{E}[\\hat{\\pi}]$**:\n    $\\hat{\\pi}$ 是样本中所有可能的序列对之间每位点的平均核苷酸差异数。根据期望的线性性质，其期望值等于任意两个随机选择的序列之间差异数的期望值。在溯祖框架中，两个谱系的预期溯祖时间为 $2N_e$ 代。在此期间，突变沿着两个谱系累积，总分支长度为 $2 \\times (2N_e) = 4N_e$ 代。在无限位点模型下，每个突变都会产生一个新的差异。因此，每位点的预期差异数是突变率 $\\mu$ 乘以总分支长度：\n    $$ \\mathbb{E}[\\hat{\\pi}] = \\mu \\times (2 \\times 2N_e) = 4N_e\\mu = \\theta $$\n    因此，$\\hat{\\pi}$ 是 $\\theta$ 的一个无偏估计量。\n\n*   **Watterson估计量的期望值, $\\mathbb{E}[\\hat{\\theta}_W]$**:\n    Watterson估计量基于样本中 $n$ 个序列在一个长度为 $L$ 的基因座上的分离位点数 $S$。其每位点定义为 $\\hat{\\theta}_W = \\frac{S}{L \\cdot a_{n-1}}$，其中 $a_{n-1} = \\sum_{i=1}^{n-1} \\frac{1}{i}$。分离位点数的期望值是每位点突变率 $\\mu$ 乘以谱系的总期望长度 $\\mathbb{E}[T_{total}]$。总期望长度为 $4N_e L \\sum_{i=1}^{n-1} \\frac{1}{i} = \\theta L a_{n-1}$。\n    因此，$S$ 的期望值为：\n    $$ \\mathbb{E}[S] = \\mu \\times (\\text{以位点-代为单位的期望总分支长度}) = \\mu \\times (L \\cdot 4N_e \\sum_{i=1}^{n-1} \\frac{1}{i}) = (4N_e\\mu) L a_{n-1} = \\theta L a_{n-1} $$\n    该估计量的期望值为：\n    $$ \\mathbb{E}[\\hat{\\theta}_W] = \\frac{\\mathbb{E}[S]}{L a_{n-1}} = \\frac{\\theta L a_{n-1}}{L a_{n-1}} = \\theta $$\n    因此，$\\hat{\\theta}_W$ 也是 $\\theta$ 的一个无偏估计量。\n\n由于在SNM下两个估计量都是无偏的，它们差的期望值为零：\n$$ \\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W] = \\mathbb{E}[\\hat{\\pi}] - \\mathbb{E}[\\hat{\\theta}_W] = \\theta - \\theta = 0 $$\n\n**2. 对偏差的解释**\n\n这两个估计量对位点频率谱（SFS）的不同方面敏感。$\\hat{\\pi}$ 对中等频率的变异更为敏感，而 $\\hat{\\theta}_W$ 则完全由变异的总数驱动，而变异总数又以低频变异为主。这种差异使得它们的差值（Tajima's D统计量的基础）成为检验SNM的有力工具。\n\n*   **陈述A是正确的。** 正偏差（$\\hat{\\pi} > \\hat{\\theta}_W$，即Tajima's D > 0）表明与SNM的预期相比，中等频率的等位基因过多。这种模式是平衡选择（维持多个等位基因处于中等频率）或种群结构（来自不同亚群的个体之间的成对差异被夸大）的特征。\n*   **陈述B是错误的。** 在SNM下，重组会打破连锁，但不会改变单个位点中性多样性的期望水平。因此，它不会在$\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$中引入系统性偏差。\n*   **陈述C是正确的。** 负偏差（$\\hat{\\pi}  \\hat{\\theta}_W$，即Tajima's D  0）表明低频（稀有）等位基因过多。这是近期种群扩张（新突变是年轻的，因此是稀有的）、纯化选择（有害突变在被清除前保持在低频）或选择性清除（一个有利突变固定下来，随后的新突变是年轻且稀有的）之后的预期模式。\n*   **陈述D是错误的。** 种群瓶颈或扩张等人口统计学变化会从根本上改变溯祖谱系的形状和由此产生的SFS，导致$\\mathbb{E}[\\hat{\\pi} - \\hat{\\theta}_W]$偏离零。SNM明确假设种群大小恒定。\n*   **陈述E是错误的。** 如上所示，在SNM下，对于任何样本大小 $n \\ge 2$，期望值都恰好为零。\n\n因此，陈述A和C都正确地描述了对SNM的偏离如何影响这些估计量。", "answer": "$$\\boxed{AC}$$", "id": "2737616"}]}