{"hands_on_practices": [{"introduction": "要真正掌握瓦伦德效应，我们首先需要进行一个基础计算。本练习将要求你在一个经典的理想化场景中——两个规模相等但等位基因频率不同的亚群体——计算杂合子亏缺。通过分别计算亚群体内部的平均预期杂合度（$H_S$）和合并后总群体的预期杂合度（$H_T$），你将直接量化纯粹由群体结构导致的杂合子减少。这个动手计算将巩固瓦伦德效应的核心原理。[@problem_id:2762872]", "problem": "一个二倍体物种被划分为$2$个普查规模相等的亚群，标记为亚群$1$和亚群$2$。在一个具有等位基因$A$和$a$的单位点双等位基因座上，等位基因$A$在亚群$1$中的频率为$p_1=0.2$，在亚群$2$中的频率为$p_2=0.8$。假设每个亚群内部随机交配，并且在一代内没有选择、突变或迁移，因此每个亚群都单独满足Hardy–Weinberg平衡（HWE）。设$H_S$表示使用相等权重在各亚群间平均的亚群内预期杂合度，设$H_T$表示根据混合等位基因频率计算出的预期杂合度，如同总种群是泛交的一样。从Hardy–Weinberg原理和杂合度作为杂合子预期比例的定义出发，从第一性原理计算$H_S$和$H_T$，然后确定由Wahlund效应引起的杂合子缺失$H_T - H_S$。\n\n请将您的最终答案以单一量$H_T - H_S$的形式表示，并以精确分数形式给出。请勿四舍五入。请勿包含任何单位。", "solution": "该问题陈述已经过验证，被认为是科学上合理的、问题明确且完整的。我们将从第一性原理开始推导。\n\n这个问题的基础是针对二倍体物种在双等位基因座上的Hardy–Weinberg原理。设等位基因为$A$和$a$，其频率分别为$p$和$q$，使得$p+q=1$。在一个处于Hardy–Weinberg平衡（HWE）的种群中——即，假设随机交配、无选择、无突变、无基因流——基因型$AA$、$Aa$和$aa$的预期频率分别为$p^2$、$2pq$和$q^2$。预期杂合度，记为$H$，是杂合基因型$Aa$的预期频率，由表达式$H = 2pq$给出。\n\n题目指明一个种群被划分为$2$个大小相等的亚群。我们已知每个亚群中等位基因$A$的频率。\n在亚群$1$中，等位基因$A$的频率为$p_1 = 0.2$。因此，等位基因$a$的频率为$q_1 = 1 - p_1 = 1 - 0.2 = 0.8$。\n在亚群$2$中，等位基因$A$的频率为$p_2 = 0.8$。因此，等位基因$a$的频率为$q_2 = 1 - p_2 = 1 - 0.8 = 0.2$。\n\n首先，我们计算亚群内的平均杂合度$H_S$。题目说明每个亚群都处于HWE状态。因此，我们可以单独计算每个亚群的预期杂合度。\n对于亚群$1$，预期杂合度为$H_1 = 2p_1q_1$。\n对于亚群$2$，预期杂合度为$H_2 = 2p_2q_2$。\n\n$H_S$被定义为这些杂合度的平均值，按亚群大小加权。由于亚群大小相等，所以权重相等（每个亚群为$1/2$）：\n$$H_S = \\frac{1}{2}H_1 + \\frac{1}{2}H_2 = \\frac{1}{2}(2p_1q_1) + \\frac{1}{2}(2p_2q_2) = p_1q_1 + p_2q_2$$\n代入给定的数值：\n$$H_S = (0.2)(0.8) + (0.8)(0.2) = 0.16 + 0.16 = 0.32$$\n\n接下来，我们计算总预期杂合度$H_T$。这是当两个亚群合并成一个单一的泛交种群时存在的预期杂合度。为了计算这个值，我们必须首先确定总种群的混合等位基因频率。设$\\bar{p}$和$\\bar{q}$分别为总种群中等位基因$A$和$a$的频率。由于亚群大小相等，混合频率是各亚群频率的算术平均值：\n$$\\bar{p} = \\frac{p_1 + p_2}{2}$$\n$$\\bar{q} = \\frac{q_1 + q_2}{2} = 1 - \\bar{p}$$\n代入$p_1$和$p_2$的给定值：\n$$\\bar{p} = \\frac{0.2 + 0.8}{2} = \\frac{1.0}{2} = 0.5$$\n因此，等位基因$a$的混合频率为$\\bar{q} = 1 - 0.5 = 0.5$。\n\n现在，我们使用混合等位基因频率计算$H_T$，假设总种群作为一个处于HWE状态的单一单元：\n$$H_T = 2\\bar{p}\\bar{q}$$\n代入计算出的混合频率：\n$$H_T = 2(0.5)(0.5) = 0.5$$\n\n最后，题目要求计算由Wahlund效应引起的杂合子缺失，即差值$H_T - H_S$。这个量衡量了与泛交预期相比，由种群亚结构导致的杂合度降低。\n$$H_T - H_S = 0.5 - 0.32 = 0.18$$\n题目要求将此结果表示为精确分数。\n$$0.18 = \\frac{18}{100} = \\frac{9}{50}$$\n这个缺失量$H_T - H_S$是亚群间等位基因频率方差$\\text{Var}(p)$的直接结果。对于$k_d$个大小相等的亚群，一般关系式为$H_S = H_T - 2\\text{Var}(p)$，或$H_T-H_S = 2\\text{Var}(p)$。在这个有$2$个亚群的特定案例中，$\\text{Var}(p) = \\frac{(p_1 - \\bar{p})^2 + (p_2 - \\bar{p})^2}{2} = \\frac{(0.2 - 0.5)^2 + (0.8 - 0.5)^2}{2} = \\frac{(-0.3)^2 + (0.3)^2}{2} = \\frac{0.09 + 0.09}{2} = 0.09$。因此，$H_T - H_S = 2(0.09) = 0.18$，这证实了我们的直接计算。", "answer": "$$\\boxed{\\frac{9}{50}}$$", "id": "2762872"}, {"introduction": "观察到杂合子亏缺只是第一步，下一步则是以标准化的方式量化其程度。本练习将场景推广到三个亚群体，并引入群体遗传学中的一个关键指标：固定指数（$F_{ST}$，在此记为 $F_W$）。通过计算该指数，你将学会如何将瓦伦德效应作为总预期杂合度的一部分来衡量，这为比较不同群体间的遗传分化程度提供了一个强有力的工具。[@problem_id:2762899]", "problem": "一个复合种群由三个种群大小相等的亚群组成，每个亚群内在一个具有等位基因 $A$ 和 $a$ 的双等位基因座上进行随机交配。这三个亚群中等位基因 $A$ 的频率分别为 $p_{1}=0.1$、$p_{2}=0.5$ 和 $p_{3}=0.9$。假设在每个亚群内部，基因型频率遵循哈代-温伯格平衡（HWE），并且混合样本是通过从每个亚群中提取等量随机样本然后忽略亚群标签而形成的。\n\n仅使用哈代-温伯格平衡的基本定义和加权平均：\n- 用 $\\{p_{i}\\}$ 和相等的权重来推导预期的混合基因型频率 $f_{AA}$、$f_{Aa}$ 和 $f_{aa}$。\n- 通过计算相对杂合子缺失来量化混合样本与哈代-温伯格平衡的偏差。相对杂合子缺失定义为：与在混合等位基因频率下根据泛交预测的杂合度相比，混合样本的预期杂合度的比例减少量。具体而言，设 $H_{\\mathrm{pooled}}$ 为混合样本中的预期杂合度，设 $H_{\\mathrm{HWE}}$ 为使用混合等位基因频率在泛交条件下预测的杂合度；报告由 $H_{\\mathrm{pooled}}$ 相对于 $H_{\\mathrm{HWE}}$ 的相对缺失给出的系数 $F_{W}$ 的值。\n\n请以一个关于 $F_{W}$ 的最简分数形式提供您的最终答案。不要包含单位或百分号。您可以在推导过程中展示中间的混合基因型频率，但只有 $F_{W}$ 的值将作为最终答案进行评分。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n- 一个复合种群由三个亚群组成。\n- 各亚群的种群大小相等。\n- 每个亚群内部交配是随机的。\n- 考虑一个具有等位基因 $A$ 和 $a$ 的双等位基因座。\n- 三个亚群中等位基因 $A$ 的频率分别为 $p_{1}=0.1$、$p_{2}=0.5$ 和 $p_{3}=0.9$。\n- 每个亚群内的基因型频率遵循哈代-温伯格平衡（HWE）。\n- 混合样本是通过从全部 $3$ 个亚群中各取一个等量随机样本而形成的。\n- 任务是推导混合基因型频率 $f_{AA}$、$f_{Aa}$ 和 $f_{aa}$。\n- 任务是通过计算相对杂合子缺失 $F_{W}$ 来量化与HWE的偏差。\n- $F_{W}$ 定义为 $\\frac{H_{\\mathrm{HWE}} - H_{\\mathrm{pooled}}}{H_{\\mathrm{HWE}}}$，其中 $H_{\\mathrm{pooled}}$ 是混合样本中的预期杂合度，$H_{\\mathrm{HWE}}$ 是使用混合等位基因频率在泛交条件下预测的杂合度。\n- $F_W$ 的最终答案必须是一个最简分数。\n\n验证结论：\n该问题具有科学依据，提法得当且客观。它描述了种群遗传学中的一个基本概念——瓦伦德效应的经典情景。所有必要的数据和定义（$p_i$ 值、亚群数量、相等权重、$F_W$ 的公式）均已提供，不存在内部矛盾或歧义。该问题是将 HWE 原理应用于结构化种群的一个标准的、可形式化的练习。因此，该问题被认定为有效，并将提供解答。\n\n解答过程如下。\n设 $p_i$ 为亚群 $i$ 中等位基因 $A$ 的频率，$q_i = 1 - p_i$ 为等位基因 $a$ 的频率。题目给出了 $3$ 个亚群的等位基因频率分别为 $p_1 = 0.1$，$p_2 = 0.5$ 和 $p_3 = 0.9$。因此，等位基因 $a$ 的频率为 $q_1 = 1 - 0.1 = 0.9$，$q_2 = 1 - 0.5 = 0.5$ 和 $q_3 = 1 - 0.9 = 0.1$。\n\n在每个亚群 $i$ 内部，交配是随机的，因此基因型频率处于哈代-温伯格平衡（HWE）状态。基因型 $AA$、$Aa$ 和 $aa$ 的预期频率分别由 $p_i^2$、$2p_iq_i$ 和 $q_i^2$ 给出。\n对于亚群 1：\n$f_{AA,1} = p_1^2 = (0.1)^2 = 0.01$\n$f_{Aa,1} = 2p_1q_1 = 2(0.1)(0.9) = 0.18$\n$f_{aa,1} = q_1^2 = (0.9)^2 = 0.81$\n\n对于亚群 2：\n$f_{AA,2} = p_2^2 = (0.5)^2 = 0.25$\n$f_{Aa,2} = 2p_2q_2 = 2(0.5)(0.5) = 0.50$\n$f_{aa,2} = q_2^2 = (0.5)^2 = 0.25$\n\n对于亚群 3：\n$f_{AA,3} = p_3^2 = (0.9)^2 = 0.81$\n$f_{Aa,3} = 2p_3q_3 = 2(0.9)(0.1) = 0.18$\n$f_{aa,3} = q_3^2 = (0.1)^2 = 0.01$\n\n混合样本是通过合并来自 $k=3$ 个亚群中每个亚群的等量随机样本而形成的。因此，每个亚群在混合样本中的权重是 $w_i = \\frac{1}{k} = \\frac{1}{3}$。混合样本中的总基因型频率（$f_{AA}$、$f_{Aa}$、$f_{aa}$）是各个亚群中频率的加权平均值。\n\n问题的第一个部分要求用 $\\{p_i\\}$ 和权重来推导这些频率。用符号表示，对于有权重 $w_i$ 的 $k$ 个亚群，混合频率为：\n$f_{AA} = \\sum_{i=1}^{k} w_i f_{AA,i} = \\sum_{i=1}^{k} w_i p_i^2$\n$f_{Aa} = \\sum_{i=1}^{k} w_i f_{Aa,i} = \\sum_{i=1}^{k} w_i (2p_i q_i)$\n$f_{aa} = \\sum_{i=1}^{k} w_i f_{aa,i} = \\sum_{i=1}^{k} w_i q_i^2$\n对于这个 $w_i = 1/3$ 的特定问题：\n$f_{AA} = \\frac{1}{3}(p_1^2 + p_2^2 + p_3^2) = \\frac{1}{3}(0.01 + 0.25 + 0.81) = \\frac{1.07}{3}$\n$f_{Aa} = \\frac{1}{3}(2p_1q_1 + 2p_2q_2 + 2p_3q_3) = \\frac{1}{3}(0.18 + 0.50 + 0.18) = \\frac{0.86}{3}$\n$f_{aa} = \\frac{1}{3}(q_1^2 + q_2^2 + q_3^2) = \\frac{1}{3}(0.81 + 0.25 + 0.01) = \\frac{1.07}{3}$\n\n问题的第二部分要求计算系数 $F_W$。这需要两个量：$H_{\\mathrm{pooled}}$ 和 $H_{\\mathrm{HWE}}$。\n\n$H_{\\mathrm{pooled}}$ 是混合样本中的预期杂合度，也就是计算出的杂合子频率 $f_{Aa}$。\n$H_{\\mathrm{pooled}} = f_{Aa} = \\frac{0.86}{3}$。\n为了得到精确的分数，我们从一开始就使用分数进行计算。\n$p_1 = \\frac{1}{10}$，$p_2 = \\frac{1}{2}$，$p_3 = \\frac{9}{10}$。\n$q_1 = \\frac{9}{10}$，$q_2 = \\frac{1}{2}$，$q_3 = \\frac{1}{10}$。\n$H_{\\mathrm{pooled}} = \\frac{1}{3} \\left[ 2\\left(\\frac{1}{10}\\right)\\left(\\frac{9}{10}\\right) + 2\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + 2\\left(\\frac{9}{10}\\right)\\left(\\frac{1}{10}\\right) \\right]$\n$H_{\\mathrm{pooled}} = \\frac{2}{3} \\left[ \\frac{9}{100} + \\frac{1}{4} + \\frac{9}{100} \\right] = \\frac{2}{3} \\left[ \\frac{18}{100} + \\frac{25}{100} \\right] = \\frac{2}{3} \\left( \\frac{43}{100} \\right) = \\frac{43}{150}$。\n\n$H_{\\mathrm{HWE}}$ 是如果混合种群是泛交群体时的预期杂合度。这是使用混合等位基因频率 $\\bar{p}$ 计算的。混合等位基因频率是各亚群等位基因频率的加权平均值。\n$\\bar{p} = \\sum_{i=1}^{3} w_i p_i = \\frac{1}{3}(p_1 + p_2 + p_3)$\n$\\bar{p} = \\frac{1}{3}\\left(\\frac{1}{10} + \\frac{5}{10} + \\frac{9}{10}\\right) = \\frac{1}{3}\\left(\\frac{15}{10}\\right) = \\frac{1}{3}\\left(\\frac{3}{2}\\right) = \\frac{1}{2}$。\n混合等位基因 $a$ 的频率是 $\\bar{q} = 1 - \\bar{p} = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n现在，$H_{\\mathrm{HWE}}$ 按 $2\\bar{p}\\bar{q}$ 计算：\n$H_{\\mathrm{HWE}} = 2\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{1}{2}$。\n\n最后，根据系数 $F_W$ 作为相对杂合子缺失的定义来计算它。\n$F_{W} = \\frac{H_{\\mathrm{HWE}} - H_{\\mathrm{pooled}}}{H_{\\mathrm{HWE}}}$\n代入计算出的值：\n$F_{W} = \\frac{\\frac{1}{2} - \\frac{43}{150}}{\\frac{1}{2}}$\n分子是 $\\frac{1}{2} - \\frac{43}{150} = \\frac{75}{150} - \\frac{43}{150} = \\frac{32}{150}$。\n$F_{W} = \\frac{\\frac{32}{150}}{\\frac{1}{2}} = \\frac{32}{150} \\times 2 = \\frac{32}{75}$。\n数字 $32 = 2^5$ 和 $75 = 3 \\times 5^2$ 没有公共质因数，所以这个分数是最简分数。\n这个系数是正数，证实了与 HWE 期望值相比，混合样本中存在杂合子缺失，这正是瓦伦德效应的实质。种群结构化为具有不同等位基因频率的亚群，在混合时导致了这种偏差。", "answer": "$$\\boxed{\\frac{32}{75}}$$", "id": "2762899"}, {"introduction": "现代群体遗传学在根本上是计算性的。本练习将挑战你从纸笔计算转向编程，这是分析大规模遗传数据的关键技能。你将开发一个脚本来自动计算瓦伦德效应，从而能够快速测试不同群体规模和等位基因频率下的各种情景。这项实践不仅巩固了基本概念，还揭示了一个更简洁高效的双亚群体计算公式，展示了理论洞察力在创建实用计算解决方案中的力量。[@problem_id:2396530]", "problem": "编写一个完整的程序，用于量化当两个各自处于哈迪-温伯格平衡 (HWE) 的亚群体被混合时，单个双等位基因座的 Wahlund 效应。考虑一个等位基因为 $A$ 和 $a$ 的二倍体基因座。对于亚群体 $i \\in \\{1,2\\}$，令 $n_i$ 表示二倍体个体的数量，令 $p_i$ 表示等位基因 $A$ 的频率；令 $q_i = 1 - p_i$。假设每个亚群体都精确处于哈迪-温伯格平衡 (HWE) 状态，这意味着其基因型频率由其等位基因频率决定。将亚群体视为遵循 HWE 所蕴含的期望基因型频率的确定性系统，而非随机抽样的结果。在混合这两个亚群体后（不发生任何混合后的交配），混合群体的观测杂合度定义为所有个体中杂合个体的比例。另外，将混合等位基因频率定义为 $\\bar{p}$，即 $p_1$ 和 $p_2$ 以个体总数加权的平均值。在混合等位基因频率下，随机交配所期望的杂合度，是指一个等位基因频率为 $\\bar{p}$ 的单一随机交配群体处于 HWE 状态时所产生的杂合度。将 Wahlund 效应 $W$ 定义为在 $\\bar{p}$ 下随机交配的期望杂合度与混合群体中的观测杂合度之差。以小数（而非百分比）形式报告 $W$。\n\n您的程序必须为以下五个独立的测试用例计算 $W$，每个测试用例以 $(n_1, p_1, n_2, p_2)$ 的形式给出：\n- 测试用例 A: $(100, 0.4, 100, 0.7)$\n- 测试用例 B: $(50, 0.5, 200, 0.5)$\n- 测试用例 C: $(120, 0.0, 80, 1.0)$\n- 测试用例 D: $(10, 0.2, 1000, 0.21)$\n- 测试用例 E: $(1, 1.0, 1, 1.0)$\n\n所有 $n_i$ 均为个体数量（无单位）。所有等位基因频率 $p_i$ 都必须视为闭区间 $[0,1]$ 内的小数。不涉及任何物理单位。对于每个测试用例，计算单个值 $W$，并将其四舍五入到小数点后恰好六位。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，结果顺序与测试用例 A 到 E 的顺序一致。例如，要求的格式为 $[w_A,w_B,w_C,w_D,w_E]$，其中每个 $w_{\\cdot}$ 是上文所述的四舍五入后的小数。", "solution": "问题陈述已提交以供验证。\n\n### 步骤 1：提取已知信息\n- **主题**：单个双等位基因座（$A$, $a$）的 Wahlund 效应。\n- **亚群体**：两个亚群体，索引为 $i \\in \\{1, 2\\}$。\n- **亚群体 $i$ 的参数**：\n    - $n_i$：二倍体个体数量。\n    - $p_i$：等位基因 $A$ 的频率。\n    - $q_i = 1 - p_i$：等位基因 $a$ 的频率。\n- **核心假设**：每个亚群体 $i$ 都精确处于哈迪-温伯格平衡 (HWE) 状态。基因型频率由 $p_i$ 确定。\n- **过程**：两个亚群体被混合。混合后不发生交配。\n- **定义**：\n    - **混合群体的观测杂合度**：混合群体总个体中杂合个体（$Aa$）的比例。\n    - **混合等位基因频率 ($\\bar{p}$)**：$p_1$ 和 $p_2$ 以个体总数加权的平均值。\n    - **随机交配下的期望杂合度**：等位基因频率为 $\\bar{p}$ 的群体在 HWE 状态下的杂合子频率，即 $2\\bar{p}(1-\\bar{p})$。\n    - **Wahlund 效应 ($W$)**：定义为随机交配下的期望杂合度与混合群体中的观测杂合度之差。$W = H_{exp} - H_{obs}$。\n- **测试用例**：提供五个用例，格式为 $(n_1, p_1, n_2, p_2)$：\n    - A: $(100, 0.4, 100, 0.7)$\n    - B: $(50, 0.5, 200, 0.5)$\n    - C: $(120, 0.0, 80, 1.0)$\n    - D: $(10, 0.2, 1000, 0.21)$\n    - E: $(1, 1.0, 1, 1.0)$\n- **输出要求**：对每个用例计算 $W$，四舍五入至小数点后六位。最终输出为单行字符串：`[w_A,w_B,w_C,w_D,w_E]`。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n- **科学性**：该问题是群体遗传学中的一个经典表述。Wahlund 效应、哈迪-温伯格平衡以及混合群体的概念是该领域的标准和基本原则。“确定性”假设是入门理论问题中的一种标准简化。\n- **适定性**：该问题是适定的。所有必需的变量（$n_i$，$p_i$）都已提供。所有术语（$H_{obs}$、$H_{exp}$、$\\bar{p}$、$W$）都有明确无误的定义。每个测试用例都存在唯一解。\n- **客观性**：问题陈述是严格数学化和客观的。它不包含任何主观看法或意见。\n\n该问题没有任何使其无效的缺陷。它在科学上是合理的，结构上是正式的，内容是完整的，并且是可验证的。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将制定并提供解决方案。\n\n### 解题推导\n目标是推导出 Wahlund 效应 $W$ 的一个闭式表达式，然后将其应用于给定的测试用例。我们从第一性原理出发。\n\n设等位基因为 $A$ 和 $a$。对于亚群体 $i$，等位基因 $A$ 的频率为 $p_i$，等位基因 $a$ 的频率为 $q_i = 1 - p_i$。亚群体 $i$ 的大小为 $n_i$。\n\n**1. 亚群体中的基因型数量：**\n由于每个亚群体都处于哈迪-温伯格平衡状态，亚群体 $i$ 中基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p_i^2$、$2p_iq_i$ 和 $q_i^2$。因此，亚群体 $i$ 中杂合个体 ($Aa$) 的数量为：\n$$ N_{Aa, i} = n_i \\cdot (2p_iq_i) = 2n_i p_i (1-p_i) $$\n\n**2. 混合群体中的观测杂合度 ($H_{obs}$):**\n当亚群体混合后，个体总数为 $N_{total} = n_1 + n_2$。杂合子总数是每个亚群体中杂合子数量之和：\n$$ N_{Aa, pooled} = N_{Aa, 1} + N_{Aa, 2} = 2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2) $$\n观测杂合度 $H_{obs}$ 是这些杂合子在混合群体总数中所占的比例：\n$$ H_{obs} = \\frac{N_{Aa, pooled}}{N_{total}} = \\frac{2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2)}{n_1 + n_2} $$\n\n**3. 混合等位基因频率 ($\\bar{p}$):**\n二倍体群体中 $A$ 等位基因的总数是每个亚群体中 $A$ 等位基因数量之和。在亚群体 $i$ 中，共有 $2n_i$ 个等位基因，其中比例为 $p_i$ 的是 $A$ 等位基因。因此，$A$ 等位基因的数量为 $2n_ip_i$。\n混合群体中 $A$ 等位基因的总数为 $2n_1p_1 + 2n_2p_2$。所有等位基因的总数为 $2N_{total} = 2(n_1+n_2)$。\n混合等位基因频率 $\\bar{p}$ 为：\n$$ \\bar{p} = \\frac{2n_1p_1 + 2n_2p_2}{2(n_1 + n_2)} = \\frac{n_1p_1 + n_2p_2}{n_1 + n_2} $$\n这证实了问题陈述中给出的定义。这即是亚群体等位基因频率的加权平均值，其中权重是亚群体的相对大小。令 $c_1 = \\frac{n_1}{n_1+n_2}$ 和 $c_2 = \\frac{n_2}{n_1+n_2}$。那么 $\\bar{p} = c_1p_1 + c_2p_2$。\n\n**4. 随机交配下的期望杂合度 ($H_{exp}$):**\n如果这个混合群体进行随机交配（panmixia），它将形成一个等位基因频率为 $\\bar{p}$ 的单一基因库。这个随机交配群体在 HWE 下的期望杂合度为：\n$$ H_{exp} = 2\\bar{p}(1-\\bar{p}) $$\n\n**5. Wahlund 效应 ($W$):**\nWahlund 效应定义为 $W = H_{exp} - H_{obs}$。\n代入 $H_{exp}$ 和 $H_{obs}$ 的表达式：\n$$ W = 2\\bar{p}(1-\\bar{p}) - \\frac{2n_1 p_1 (1-p_1) + 2n_2 p_2 (1-p_2)}{n_1 + n_2} $$\n我们可以简化这个表达式。注意 $H_{obs}$ 是亚群体内部杂合度的加权平均值：$H_{obs} = c_1(2p_1q_1) + c_2(2p_2q_2) = 2(c_1p_1q_1 + c_2p_2q_2)$。所以，\n$$ W = 2\\bar{p}(1-\\bar{p}) - 2(c_1p_1(1-p_1) + c_2p_2(1-p_2)) $$\n$$ W = 2 \\left[ (\\bar{p} - \\bar{p}^2) - (c_1p_1 - c_1p_1^2 + c_2p_2 - c_2p_2^2) \\right] $$\n$$ W = 2 \\left[ (c_1p_1+c_2p_2) - (c_1p_1+c_2p_2)^2 - (c_1p_1+c_2p_2) + (c_1p_1^2 + c_2p_2^2) \\right] $$\n$$ W = 2 \\left[ (c_1p_1^2 + c_2p_2^2) - (c_1p_1 + c_2p_2)^2 \\right] $$\n括号内的项是等位基因频率 $p$ 在各亚群体间的方差，$\\text{Var}(p) = E[p^2] - (E[p])^2$。\n所以，$W = 2 \\text{Var}(p)$。让我们展开它：\n$$ \\text{Var}(p) = (c_1p_1^2 + c_2p_2^2) - (c_1^2p_1^2 + 2c_1c_2p_1p_2 + c_2^2p_2^2) $$\n$$ \\text{Var}(p) = (c_1-c_1^2)p_1^2 + (c_2-c_2^2)p_2^2 - 2c_1c_2p_1p_2 $$\n由于 $c_1+c_2=1$，我们有 $c_1-c_1^2 = c_1(1-c_1) = c_1c_2$ 且 $c_2-c_2^2 = c_2(1-c_2) = c_1c_2$。\n$$ \\text{Var}(p) = c_1c_2p_1^2 + c_1c_2p_2^2 - 2c_1c_2p_1p_2 = c_1c_2(p_1^2 - 2p_1p_2 + p_2^2) = c_1c_2(p_1-p_2)^2 $$\n因此，Wahlund 效应 $W$ 有一个简洁而紧凑的形式：\n$$ W = 2 c_1 c_2 (p_1 - p_2)^2 $$\n代入 $c_1$ 和 $c_2$ 的定义：\n$$ W = 2 \\left(\\frac{n_1}{n_1+n_2}\\right) \\left(\\frac{n_2}{n_1+n_2}\\right) (p_1 - p_2)^2 = \\frac{2 n_1 n_2}{(n_1+n_2)^2} (p_1 - p_2)^2 $$\n这个最终公式计算效率高，将用于解决测试用例。它表明 Wahlund 效应是非负的，并且仅当亚群体中的等位基因频率相同时（$p_1=p_2$）才为零。\n\n### 测试用例计算\n- **用例 A**: $(n_1, p_1, n_2, p_2) = (100, 0.4, 100, 0.7)$\n$W = \\frac{2(100)(100)}{(100+100)^2} (0.4 - 0.7)^2 = \\frac{20000}{40000} (-0.3)^2 = 0.5 \\times 0.09 = 0.045$。四舍五入后: $0.045000$。\n\n- **用例 B**: $(n_1, p_1, n_2, p_2) = (50, 0.5, 200, 0.5)$\n$p_1 - p_2 = 0.5 - 0.5 = 0$。因此，$W=0$。四舍五入后: $0.000000$。\n\n- **用例 C**: $(n_1, p_1, n_2, p_2) = (120, 0.0, 80, 1.0)$\n$W = \\frac{2(120)(80)}{(120+80)^2} (0.0 - 1.0)^2 = \\frac{19200}{40000} (-1)^2 = 0.48 \\times 1 = 0.48$。四舍五入后: $0.480000$。\n\n- **用例 D**: $(n_1, p_1, n_2, p_2) = (10, 0.2, 1000, 0.21)$\n$W = \\frac{2(10)(1000)}{(10+1000)^2} (0.2 - 0.21)^2 = \\frac{20000}{1010^2} (-0.01)^2 = \\frac{20000}{1020100} (0.0001) = \\frac{2}{1020100} \\approx 0.00000196$。四舍五入后: $0.000002$。\n\n- **用例 E**: $(n_1, p_1, n_2, p_2) = (1, 1.0, 1, 1.0)$\n$p_1 - p_2 = 1.0 - 1.0 = 0$。因此，$W=0$。四舍五入后: $0.000000$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Wahlund effect for several test cases of pooled subpopulations.\n    \"\"\"\n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple is in the format (n1, p1, n2, p2).\n    test_cases = [\n        (100, 0.4, 100, 0.7),    # Test case A\n        (50, 0.5, 200, 0.5),    # Test case B\n        (120, 0.0, 80, 1.0),    # Test case C\n        (10, 0.2, 1000, 0.21),  # Test case D\n        (1, 1.0, 1, 1.0),       # Test case E\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current test case.\n        n1, p1, n2, p2 = case\n\n        # The Wahlund effect (W) is calculated using the derived formula:\n        # W = 2 * c1 * c2 * (p1 - p2)^2\n        # where c1 = n1 / (n1 + n2) and c2 = n2 / (n1 + n2).\n        # This simplifies to W = (2 * n1 * n2 / (n1 + n2)^2) * (p1 - p2)^2.\n\n        n_total = n1 + n2\n        \n        # Guard against division by zero, although not present in test data.\n        if n_total == 0:\n            w = 0.0\n        else:\n            # Calculate the two components of the formula.\n            size_component = (2 * n1 * n2) / (n_total**2)\n            freq_component = (p1 - p2)**2\n            \n            # Combine components to get the Wahlund effect.\n            w = size_component * freq_component\n        \n        # Format the result to exactly six decimal places and append to the list.\n        results.append(f\"{w:.6f}\")\n\n    # Final print statement in the exact required format: [w_A,w_B,w_C,w_D,w_E]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2396530"}]}