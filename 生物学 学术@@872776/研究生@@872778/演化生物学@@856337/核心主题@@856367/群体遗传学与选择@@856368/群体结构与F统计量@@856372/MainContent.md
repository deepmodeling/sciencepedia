## 引言
在进化生物学中，理解物种内遗传变异的[分布](@entry_id:182848)格局是探索[演化过程](@entry_id:175749)的基础。然而，自然界中的生物群体极少是完全随机交配的理想模型。相反，它们往往因地理障碍、生态差异或历史事件而形成复杂的结构，被分割为多个局部繁殖的亚群体。这种结构如何影响等位基因的频率、如何塑造遗传多样性，以及我们如何精确地量化这些效应，是[群体遗传学](@entry_id:146344)面临的核心问题。若无法准确描述群体结构，我们将难以区分[遗传漂变](@entry_id:145594)、[基因流](@entry_id:140922)和自然选择等不同演化力量的作用。

本文旨在系统性地介绍量化群体结构的核心工具——[F统计量](@entry_id:148252)。通过三个章节的递进式学习，你将全面掌握这一经典而强大的分析框架。在“原理与机制”一章，我们将从[瓦伦德效应](@entry_id:151966)出发，建立对群体结构如何导致[杂合子](@entry_id:276964)亏缺的直观理解，并详细阐述Sewall Wright的[F统计量](@entry_id:148252)体系（$F_{IS}, F_{ST}, F_{IT}$）的定义、计算及其内在联系。随后，在“应用与跨学科联系”一章，我们将展示[F统计量](@entry_id:148252)如何作为一把钥匙，解锁从探测基因组中的自然选择足迹到重建古人类复杂迁徙历史等一系列前沿科学问题，并探讨其在保护生物学、人类遗传学等领域的应用。最后，“动手实践”部分将提供精选的思考题，帮助你巩固理论知识并解决实际计算中的挑战。

现在，让我们从最基本的原理开始，深入探索[群体结构](@entry_id:148599)的遗传学效应及其量化方法。

## 原理与机制

在群体遗传学中，理解物种内遗传变异的[分布](@entry_id:182848)是核心任务之一。一个大的、连续的群体很少是完全[随机交配](@entry_id:149892)的（即泛交配的）。更常见的是，由于地理障碍、社会行为或历史事件，群体被分割成多个更小的、局部繁殖的单元，我们称之为亚群体（subpopulations）或[半群](@entry_id:153860)体（demes）。这种群体结构深刻地影响了[等位基因频率](@entry_id:146872)的[分布](@entry_id:182848)，并改变了[基因型频率](@entry_id:141286)与我们在单一泛交配群体中所预期的模式。本章旨在系统地阐述量化[群体结构](@entry_id:148599)的原理和机制，重点介绍 Sewall Wright 的[固定指数](@entry_id:170530)（F-statistics）及其现代理论扩展。

### [瓦伦德效应](@entry_id:151966)：结构化群体的[杂合子](@entry_id:276964)亏缺

理解群体结构效应的起点是 **[瓦伦德效应](@entry_id:151966)（Wahlund effect）**。该原理指出，如果将两个或多个具有不同等位基因频率的亚群体合并，并在合并后的总体中计算[基因型频率](@entry_id:141286)，那么观察到的[杂合子](@entry_id:276964)数量将低于基于合并后总体[等位基因频率](@entry_id:146872)计算的哈迪-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）[期望值](@entry_id:153208)。换句话说，群体结构自身就会导致[杂合子](@entry_id:276964)亏缺。

我们可以通过一个数值例子来阐明这一效应。设想一个由三个独立的、内部随机交配的[半群](@entry_id:153860)体组成的物种，我们在一个双等位[基因座](@entry_id:177958)上对其进行基因分型。每个半群体内部都符合哈迪-温伯格平衡，但它们的[等位基因频率](@entry_id:146872)不同 [@problem_id:2745307]。

假设我们观察到以下基因型计数：
- 半群体 1: $AA=8$, $Aa=64$, $aa=128$ (总计 $N_1=200$)
- [半群](@entry_id:153860)体 2: $AA=54$, $Aa=72$, $aa=24$ (总计 $N_2=150$)
- [半群](@entry_id:153860)体 3: $AA=160$, $Aa=80$, $aa=10$ (总计 $N_3=250$)

首先，我们可以计算每个半群体内的[等位基因频率](@entry_id:146872) $p$（$A$ 等位基因的频率）。
- [半群](@entry_id:153860)体 1: $p_1 = (2 \times 8 + 64) / (2 \times 200) = 80 / 400 = 0.2$
- 半群体 2: $p_2 = (2 \times 54 + 72) / (2 \times 150) = 180 / 300 = 0.6$
- 半群体 3: $p_3 = (2 \times 160 + 80) / (2 \times 250) = 400 / 500 = 0.8$

由于每个[半群](@entry_id:153860)体内部是随机交配的，其观察到的[杂合度](@entry_id:166208)与 HWE [期望值](@entry_id:153208) $2p_i(1-p_i)$ 是一致的。现在，我们将这三个[半群](@entry_id:153860)体合并成一个总群体，总个体数为 $N = 200 + 150 + 250 = 600$。合并后，总的[杂合子](@entry_id:276964)个体数量为 $64 + 72 + 80 = 216$。因此，在合并后的总群体中，**观察到的全局[杂合度](@entry_id:166208)** $H_O$ 为：
$$H_O = \frac{216}{600} = 0.36$$

接下来，我们计算如果这个总群体是一个单一的泛交配单元时的**[期望杂合度](@entry_id:204049)** $H_T$。为此，我们首先需要计算合并后的总[等位基因频率](@entry_id:146872) $\bar{p}$。总群体中 $A$ 等位基因的总数为 $(2 \times 8 + 64) + (2 \times 54 + 72) + (2 \times 160 + 80) = 80 + 180 + 400 = 660$。总等位基因数为 $2N = 1200$。因此，
$$\bar{p} = \frac{660}{1200} = 0.55$$
根据哈迪-温伯格定律，总体的[期望杂合度](@entry_id:204049) $H_T$ 为：
$$H_T = 2\bar{p}(1-\bar{p}) = 2 \times 0.55 \times (1-0.55) = 0.495$$

比较 $H_T$ 和 $H_O$，我们发现 $H_O  H_T$。这个差值 $D = H_T - H_O = 0.495 - 0.36 = 0.135$ 就是[瓦伦德效应](@entry_id:151966)导致的**[杂合子](@entry_id:276964)亏缺** [@problem_id:2745307]。这种亏缺的产生并非因为近亲繁殖，而仅仅是因为亚群体间[等位基因频率](@entry_id:146872)的差异（[方差](@entry_id:200758)）造成的。当我们将这些亚群体混合时，来自不同亚群体的个体之间的交配机会（在我们的思想实验中）被忽略了，而更多的纯合子是在具有偏高或偏低等位基因频率的亚群体内部形成的。

### F-统计量：一个分层级的分析框架

[瓦伦德效应](@entry_id:151966)揭示了[群体结构](@entry_id:148599)的一个关键后果，但我们需要一个更普适和[标准化](@entry_id:637219)的方法来量化它。Sewall Wright 提出的 F-统计量提供了一个强大的分层框架，用于将总体的遗传变异分解到不同层次上。该框架的核心思想是将[杂合子](@entry_id:276964)的亏缺视为不同层次上等位基因之间的相关性。

我们考虑一个三层结构：个体（Individuals, $I$），亚群体（Subpopulations, $S$），和总群体（Total population, $T$）。相应地，我们定义三个[杂合度](@entry_id:166208)水平 [@problem_id:2745296]：

- **$H_I$ (个体观测[杂合度](@entry_id:166208))**: 在整个样本中观察到的杂合个体的实际平均比例。
- **$H_S$ (亚群体内[期望杂合度](@entry_id:204049))**: 假定每个亚群体内部都进行[随机交配](@entry_id:149892)时，所期望的[杂合度](@entry_id:166208)的加权平均值。对于亚群体 $i$，其[期望杂合度](@entry_id:204049)为 $H_{e,i} = 2p_i(1-p_i)$，其中 $p_i$ 是该亚群体中的[等位基因频率](@entry_id:146872)。$H_S$ 是所有 $H_{e,i}$ 的加权平均值，权重通常是亚群体的样本大小。
- **$H_T$ (总群体[期望杂合度](@entry_id:204049))**: 如果整个总群体是一个单一的泛交配单元，所期望的[杂合度](@entry_id:166208)。它由总体的平均等位基因频率 $\bar{p}$ 计算得出：$H_T = 2\bar{p}(1-\bar{p})$。

基于这三个[杂合度](@entry_id:166208)，我们可以将 F-统计量定义为[杂合度](@entry_id:166208)的相对亏缺量 [@problem_id:2745296]：

#### $F_{ST}$：亚群体间的[固定指数](@entry_id:170530)

**$F_{ST}$** 量化了由于亚群体间[等位基因频率](@entry_id:146872)分化所导致的[杂合子](@entry_id:276964)亏缺。它衡量了从总群体（$T$）到亚群体（$S$）层面，[杂合度](@entry_id:166208)的降低程度。
$$F_{ST} = \frac{H_T - H_S}{H_T} = 1 - \frac{H_S}{H_T}$$
$F_{ST}$ 的值域为 $0$ 到 $1$。$F_{ST}=0$ 意味着所有亚群体具有相同的等位基因频率（$H_S = H_T$），群体不存在分化。$F_{ST}=1$ 则表示亚群体之间完全分化，它们不共享任何等位基因。因此，$F_{ST}$ 是衡量群体[遗传分化](@entry_id:163113)最常用的指标。

从另一个角度看，$F_{ST}$ 可以被解释为从同一个亚群体中随机抽取的两个等位基因，相对于从总群体中随机抽取的两个等位基因，它们是相同（即相关）的概率。

让我们通过一个实例来计算 $F_{ST}$。假设我们在三个亚群体中收集了以下基因型计数 [@problem_id:2810582]：
- 亚群体 1 ($n_1=120$): $AA=70, Aa=40, aa=10$
- 亚群体 2 ($n_2=80$): $AA=30, Aa=40, aa=10$
- 亚群体 3 ($n_3=100$): $AA=20, Aa=50, aa=30$

1.  **计算各亚群体的[等位基因频率](@entry_id:146872) ($p_i$) 和[期望杂合度](@entry_id:204049) ($H_{e,i}$)**:
    - $p_1 = (2 \times 70 + 40) / 240 = 0.75 \implies H_{e,1} = 2(0.75)(0.25) = 0.375$
    - $p_2 = (2 \times 30 + 40) / 160 = 0.625 \implies H_{e,2} = 2(0.625)(0.375) = 0.46875$
    - $p_3 = (2 \times 20 + 50) / 200 = 0.45 \implies H_{e,3} = 2(0.45)(0.55) = 0.495$

2.  **计算 $H_S$ (亚群体内[期望杂合度](@entry_id:204049)的加权平均)**:
    总样本数 $N_T = 120 + 80 + 100 = 300$。
    $$H_S = \frac{120(0.375) + 80(0.46875) + 100(0.495)}{300} = \frac{45 + 37.5 + 49.5}{300} = \frac{132}{300} = 0.44$$

3.  **计算 $H_T$ (总群体[期望杂合度](@entry_id:204049))**:
    合并后的[等位基因频率](@entry_id:146872) $\bar{p} = (180 + 100 + 90) / 600 = 370/600 = 37/60$。
    $$H_T = 2\left(\frac{37}{60}\right)\left(1-\frac{37}{60}\right) = 2\left(\frac{37}{60}\right)\left(\frac{23}{60}\right) = \frac{1702}{3600} \approx 0.4728$$

4.  **计算 $F_{ST}$**:
    $$F_{ST} = \frac{H_T - H_S}{H_T} = \frac{0.4728 - 0.44}{0.4728} \approx 0.06933$$
    这个结果表明，该物种总遗传变异的约 $6.9\%$ 可归因于这三个亚群体之间的分化。

#### $F_{IS}$：个体内的[近交系数](@entry_id:190186)

**$F_{IS}$** 量化了由于亚群体内部的[非随机交配](@entry_id:184998)（通常是[近亲繁殖](@entry_id:263386)）所导致的[杂合子](@entry_id:276964)亏缺。它衡量了从亚群体期望（$S$）到个体实际观察（$I$）层面，[杂合度](@entry_id:166208)的降低程度。
$$F_{IS} = \frac{H_S - H_I}{H_S} = 1 - \frac{H_I}{H_S}$$
$F_{IS}$ 的值可以为负（表示[杂合子](@entry_id:276964)过剩，可能由[异型交配](@entry_id:169040)导致）、零（表示[随机交配](@entry_id:149892)）或正（表示杂合子亏缺，通常由[近交](@entry_id:263386)导致）。因此，$F_{IS}$ 是衡量亚群体内部偏离哈迪-温伯格平衡程度的指标。它也可以被解释为一个群体中，导致个体纯合的两个等位基因，相对于其所在亚群体，是 **同源（Identical by Descent, IBD）** 的概率。

#### $F_{IT}$：总体的[近交系数](@entry_id:190186)

**$F_{IT}$** 衡量了相对于总群体，个体层面的总[杂合子](@entry_id:276964)亏缺。它包含了由亚[群体分化](@entry_id:188346)（[瓦伦德效应](@entry_id:151966)）和亚群体内部[非随机交配](@entry_id:184998)两方面共同造成的影响。
$$F_{IT} = \frac{H_T - H_I}{H_T} = 1 - \frac{H_I}{H_T}$$

#### 分层关系

这三个 F-统计量通过一个优美的关系式联系在一起：
$$(1 - F_{IT}) = (1 - F_{IS})(1 - F_{ST})$$
这个表达式表明，相对于总群体的非[近交](@entry_id:263386)状态（$1-F_{IT}$，即观测[杂合度](@entry_id:166208)与总[期望杂合度](@entry_id:204049)之比），是亚群体内部的非[近交](@entry_id:263386)状态（$1-F_{IS}$）和亚群体间结构效应（$1-F_{ST}$）的乘积。这个关系式是分离群体结构和[近交](@entry_id:263386)效应的关键 [@problem_id:2745296]。

### 深入解读与实际应用

#### 区分[近交](@entry_id:263386)与[群体结构](@entry_id:148599)

在实际研究中，我们常常在一个合并的样本中观察到[杂合子](@entry_id:276964)亏缺（即 $F_{IT} > 0$）。这个亏缺可能是由亚群体内部的[近交](@entry_id:263386)（$F_{IS} > 0$）引起的，也可能是因为我们无意中混合了多个[遗传分化](@entry_id:163113)的群体（即存在隐性结构，导致 $F_{ST} > 0$）而产生的[瓦伦德效应](@entry_id:151966)。

利用 F-统计量的分层框架，我们可以有效地分辨这两种情况 [@problem_id:2745277]。策略如下：
1.  根据采样地点等信息，将样本划分成多个假定的亚群体。
2.  利用多位点基因型数据，同时估计 $F_{IS}$ 和 $F_{ST}$。
3.  分析结果：
    - 如果我们发现显著的 $F_{ST} > 0$ 但 $F_{IS} \approx 0$，那么总体的[杂合子](@entry_id:276964)亏缺主要是由群体间的[遗传分化](@entry_id:163113)（[瓦伦德效应](@entry_id:151966)）造成的。这表明每个亚群体内部接近随机交配，但亚群体之间存在差异。
    - 如果我们发现 $F_{ST} \approx 0$ 但显著的 $F_{IS} > 0$，这表明亚群体之间没有明显分化，但亚群体内部存在普遍的[近交](@entry_id:263386)现象。
    - 如果两者都显著为正，则表明杂合子亏缺是[群体结构](@entry_id:148599)和内部[近交](@entry_id:263386)共同作用的结果。

#### F-统计量作为同源（IBD）[概率的解释](@entry_id:200448)

为了更深刻地理解 F-统计量的含义，我们需要区分**同态（Identity by State, IBS）**和**同源（Identity by Descent, IBD）** [@problem_id:2745302]。
- **IBS**: 两个等位基因具有相同的等位基因类型（例如，都是 $A$），而不管它们的祖先来源。
- **IBD**: 两个等位基因是同一个祖先等位基因在没有发生突变的情况下的复制品。如果两个等位基因是 IBD，那么它们必然是 IBS（假定无突变）。反之则不成立：两个 IBS 的等位基因可能来自不同的祖先，只是恰好状态相同。

基于此，$F_{IS}$ 有一个非常直观的概率解释：它是在亚群体参照系下，一个个体内的两个等位基因是 IBD 的概率 [@problem_id:2745302]。例如，在一个亚群体中，我们观察到等位基因 $A$ 的频率 $p=0.5$，因此 HWE [期望杂合度](@entry_id:204049) $H_S = 2(0.5)(0.5) = 0.5$。如果我们实际观察到的[杂合度](@entry_id:166208) $H_I = 0.4$，那么 $F_{IS} = 1 - 0.4/0.5 = 0.2$。这 0.2 的值可以解释为，从该亚群体中随机抽取一个个体，其携带的两个等位基因有 20% 的概率是源于同一个祖先等位基因的拷贝。

这种解释也阐明了[亲缘关系](@entry_id:172505)如何直接影响 $F_{IS}$。个体的[近交系数](@entry_id:190186) $F$ 定义为其父母的**[亲缘系数](@entry_id:263298)（kinship coefficient）** $\phi$。例如，全同胞兄妹的父母（假设父母本身非[近交](@entry_id:263386)）的[亲缘系数](@entry_id:263298)是 $0.25$，因此他们的后代个体的[近交系数](@entry_id:190186) $F=0.25$。如果一个样本中包含这样的近交个体，它们会直接拉高样本的平均[近交系数](@entry_id:190186)，从而导致计算出的 $F_{IS}$ 值增加。例如，在一个 10 个个体的样本中，若有 2 个是全同胞交配的后代（$F=0.25$），其余 8 个是远缘交配的后代（$F=0$），那么该样本的平均[近交系数](@entry_id:190186)，也就是其[全基因组](@entry_id:195052) $F_{IS}$，将为 $(2 \times 0.25 + 8 \times 0)/10 = 0.05$ [@problem_id:2745274]。重要的是，由于 $F_{ST}$ 是基于[等位基因频率](@entry_id:146872)计算的，它对样本中个体的亲缘关系结构不敏感，这再次凸显了这两个统计量在概念上的清晰分离。

### 高级主题与批判性思考

#### 扩展的分层结构

简单的“亚群体-总群体”模型可以扩展到更复杂的层级，例如，亚群体（Subpopulations, $S$）嵌套在区域（Collections/Regions, $C$）中，而区域又嵌套在总群体（$T$）中。在这种情况下，我们可以定义更多的 F-统计量来描述不同层级的[遗传分化](@entry_id:163113) [@problem_id:2810561]。
- $F_{SC}$: 衡量区域内部，亚群体之间的分化。$F_{SC} = (H_C - H_S)/H_C$，其中 $H_C$ 是各区域的[期望杂合度](@entry_id:204049)的加权平均。
- $F_{CT}$: 衡量区域之间的分化。$F_{CT} = (H_T - H_C)/H_T$。

这种方法被称为**分子[方差分析](@entry_id:275547)（Analysis of Molecular Variance, AMOVA）**，它将总的遗传[方差](@entry_id:200758)（或[杂合度](@entry_id:166208)亏缺）分解到不同的组织层级上。

#### 对 $F_{ST}$ 解释的审视

$F_{ST}$ 常被解释为“由亚群体间[等位基因频率](@entry_id:146872)差异所占的总[遗传多样性](@entry_id:201444)比例”。这个解释虽然直观，但需要满足特定条件，并且在某些情况下可能产生误导 [@problem_id:2745294]。

- **解释的有效性**: 这个解释在 $H_S$ 和 $H_T$ 都是基于等位基因频率计算的[期望杂合度](@entry_id:204049)（即基因多样性）时是成立的。即使亚群体内部存在近交（不符合 HWE），只要我们使用等位基因频率来计算 $H_S$，这个解释仍然有效。因为 $F_{ST}$ 的设计初衷就是为了将[群体结构](@entry_id:148599)效应与内部交配[模式分离](@entry_id:199607)开。
- **解释的失效**: 如果用**观察到**的[杂合度](@entry_id:166208)代替[期望杂合度](@entry_id:204049)来计算，或者亚群体大小权重不当，这个解释就会失效。
- **$F_{ST}$ 的上限**: $F_{ST}$ 的最大值受限于亚群体内部的遗传多样性 ($H_S$)。对于高度多态性的标记（如[微卫星](@entry_id:187091)），$H_S$ 可能非常接近 1，这使得 $F_{ST}$ 的理论上限远低于 1。例如，如果 $H_S=0.9$，那么即使群体间完全分化，$F_{ST}$ 的最大值也只能是 $0.1$。这导致在不同多态性水平的位点之间直接比较 $F_{ST}$ 值是困难和具有误导性的。
- **与 $\Phi_{ST}$ 的区别**: 在 AMOVA 中，如果引入了等位基因间的分子距离（例如，DNA 序列差异），所计算的统计量是 $\Phi_{ST}$。它衡量的是“分子[方差](@entry_id:200758)”的划分，而不是“基因多样性”（即非同一性的概率）的划分。因此，将 $\Phi_{ST}$ 解释为基因多样性的划分是不准确的。

#### 分化指标的选择：$G_{ST}$ vs. Jost's $D$

对于多等位[基因座](@entry_id:177958)，Nei 提出了 $G_{ST}$ 作为 $F_{ST}$ 的推广，其定义与 $F_{ST}$ 相同：$G_{ST} = (H_T - H_S)/H_T$。然而，和 $F_{ST}$ 一样，$G_{ST}$ 的值也受到群体内多样性的严重影响。为了克服这一缺陷，Lou Jost 提出了一个名为 $D$ 的分化指标 [@problem_id:2810566]。

Jost's $D$ 基于**有效等位基因数目**（Hill numbers）的划分，而非[杂合度](@entry_id:166208)的划分。对于 q=2 阶的多样性（对应于纯合度的倒数），Jost's $D$ 被定义为：
$$D = \frac{^2D_T - ^2D_S}{(k-1) \cdot ^2D_S}$$
其中 $^2D_T$ 和 $^2D_S$ 分别是总群体和亚群体内的有效等位基因数，$k$ 是亚群体数量。$D$ 被设计成一个与群体内多样性无关的、更纯粹的分化度量。在群体内多样性很高时，$G_{ST}$ 可能很小，即使群体间已完全分化，而 $D$ 在这种情况下会趋近于 1，从而能更准确地反映分化程度。在实践中，同时报告 $G_{ST}$ 和 $D$ 能够为[群体分化](@entry_id:188346)提供更全面的图景。

#### 实际估计中的挑战

从理论参数到样本估计的转变引入了额外的复杂性。例如，对于 $F_{ST}$ 的估计，存在多种方法，其中最著名的是 Weir  Cockerham (W-C) 的方法和 Hudson 的方法 [@problem_id:2745309]。
- **Weir-Cockerham 估计量 ($\hat{\theta}$)**: 基于 ANOVA 框架，它能很好地处理不等样本量和多个亚群体，是目前最广泛使用的方法之一。然而，对于稀有变异（如仅在某个样本中出现一次的“单例”），其单一位点的估计值可能波动很大，甚至为负，这会导致在平均多个位点时产生向下偏差。
- **Hudson 估计量**: 基于成对序列的差异（pairwise diversity）来定义 $F_{ST}$。它的一个优点是，当采用“平均值之比”（ratio of averages）的方式在多个位点上进行汇总时，它对包含大量稀有变异的位点不那么敏感，表现得更为稳健。然而，其基本概念是成对比较，推广到多个群体时不如 W-C 方法直接。

总而言之，F-统计量及其相关概念为我们提供了一个从基础到前沿的、用于理解和量化自然群体中遗传变异结构的综合性框架。掌握这些原理与机制，对于[进化生物学](@entry_id:145480)、生态学、人类遗传学和保护生物学等领域的研究至关重要。