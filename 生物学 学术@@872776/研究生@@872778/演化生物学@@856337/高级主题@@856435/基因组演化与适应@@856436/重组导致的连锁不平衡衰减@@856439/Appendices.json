{"hands_on_practices": [{"introduction": "这第一个练习为连锁不平衡的衰减奠定了理论基础。通过从第一性原理推导基本递推关系 $D_{t+1} = (1-r)D_t$，您将深入理解减数分裂和随机交配如何系统地削弱不同位点上等位基因之间的统计关联。这是群体遗传学学生的必备基础技能。[@problem_id:2699687]", "problem": "考虑一个有效无限的随机交配种群中的两个双等位基因座，记为 $A/a$ 和 $B/b$，该种群具有离散且不重叠的世代。假设没有选择、没有突变、也没有迁移。设第 $t$ 代的四种配子（单倍型）频率分别为 $x_{AB,t}$、$x_{Ab,t}$、$x_{aB,t}$ 和 $x_{ab,t}$，它们的总和为 $1$。定义边际等位基因频率为 $p_{A,t} = x_{AB,t} + x_{Ab,t}$ 和 $p_{B,t} = x_{AB,t} + x_{aB,t}$，并定义连锁不平衡 (LD) 为 $D_t = x_{AB,t} - p_{A,t} p_{B,t}$。两个基因座之间的重组率是一个常数 $r \\in [0,1/2]$。\n\n仅使用这些定义和上述假设，通过明确计算随机交配下形成的每种二倍体基因型产生的重组和非重组配子，从第一性原理推导关联 $D_{t+1}$ 与 $D_t$ 和 $r$ 的单代递归关系。然后将您的结果特化到不连锁的情况 $r = 0.5$，并展示从 $D_t$ 到 $D_{t+1}$ 的映射。\n\n最后，从一个任意非零的 $D_0$ 开始，确定连锁不平衡的绝对值减少超过其初始量值的 $0.99$ 所需的最小整数代数 $t$，即 $|D_t|  0.01\\,|D_0|$。报告这个最小整数。", "solution": "所述问题是理论群体遗传学中的一个基本练习。它有科学依据、问题良定、客观，并包含获得唯一解所需的所有信息。这些定义和假设对于推导连锁不平衡的衰减是标准的。因此，该问题是有效的，我将着手解答。\n\n该问题要求三个不同的结果：首先，推导连锁不平衡 $D$ 的单代递归关系；其次，将此递归关系特化到不连锁的基因座；第三，在不连锁的条件下，计算连锁不平衡衰减超过指定量所需的代数。\n\n让我们从推导 $D_t$ 的递归关系开始。\n第 $t$ 代的连锁不平衡定义为 $D_t = x_{AB,t} - p_{A,t} p_{B,t}$。为了找到 $D_t$ 的递归关系，我们必须找到 $D_{t+1}$ 的表达式。这需要找到第 $t+1$ 代 $AB$ 配子的频率 $x_{AB, t+1}$，以及第 $t+1$ 代的等位基因频率 $p_{A, t+1}$ 和 $p_{B, t+1}$。\n\n第 $t+1$ 代的配子是由第 $t+1$ 代的二倍体个体产生的，这些个体由第 $t$ 代配子的随机结合形成。任何二倍体基因型的频率是形成它的两个配子频率的乘积。我们必须系统地计算所有可能的亲代基因型产生的 $AB$ 配子。基因座之间的重组率为 $r$。\n\n第 $t+1$ 代中 $AB$ 配子的频率，记为 $x_{AB,t+1}$，是第 $t+1$ 代中存在的所有二倍体基因型贡献的总和。能够产生 $AB$ 配子的相关基因型有：\n$1$. $AB/AB$ 型：频率为 $x_{AB,t}^2$。只产生 $AB$ 配子。\n$2$. $AB/Ab$ 型：频率为 $2x_{AB,t}x_{Ab,t}$。等比例产生 $AB$ 和 $Ab$ 配子，因此 $AB$ 配子的比例为 $1/2$。\n$3$. $AB/aB$ 型：频率为 $2x_{AB,t}x_{aB,t}$。等比例产生 $AB$ 和 $aB$ 配子，因此 $AB$ 配子的比例为 $1/2$。\n$4$. $AB/ab$ 型（相引相双杂合子）：频率为 $2x_{AB,t}x_{ab,t}$。以 $1-r$ 的概率产生非重组配子（$AB$, $ab$），以 $r$ 的概率产生重组配子（$Ab$, $aB$）。产生的 $AB$ 配子的比例为 $(1-r)/2$。\n$5$. $Ab/aB$ 型（相斥相双杂合子）：频率为 $2x_{Ab,t}x_{aB,t}$。以 $1-r$ 的概率产生非重组配子（$Ab$, $aB$），以 $r$ 的概率产生重组配子（$AB$, $ab$）。产生的 $AB$ 配子的比例为 $r/2$。\n\n将这些基因型对第 $t+1$ 代配子库的贡献相加：\n$$x_{AB,t+1} = (x_{AB,t}^2)(1) + (2x_{AB,t}x_{Ab,t})\\left(\\frac{1}{2}\\right) + (2x_{AB,t}x_{aB,t})\\left(\\frac{1}{2}\\right) + (2x_{AB,t}x_{ab,t})\\left(\\frac{1-r}{2}\\right) + (2x_{Ab,t}x_{aB,t})\\left(\\frac{r}{2}\\right)$$\n$$x_{AB,t+1} = x_{AB,t}^2 + x_{AB,t}x_{Ab,t} + x_{AB,t}x_{aB,t} + (1-r)x_{AB,t}x_{ab,t} + r x_{Ab,t}x_{aB,t}$$\n为简化，我们加上并减去项 $r x_{AB,t}x_{ab,t}$：\n$$x_{AB,t+1} = x_{AB,t}^2 + x_{AB,t}x_{Ab,t} + x_{AB,t}x_{aB,t} + x_{AB,t}x_{ab,t} - r x_{AB,t}x_{ab,t} + r x_{Ab,t}x_{aB,t}$$\n我们可以从前四项中提取公因式 $x_{AB,t}$：\n$$x_{AB,t+1} = x_{AB,t}(x_{AB,t} + x_{Ab,t} + x_{aB,t} + x_{ab,t}) - r(x_{AB,t}x_{ab,t} - x_{Ab,t}x_{aB,t})$$\n所有配子频率的总和为 $1$，因此 $x_{AB,t} + x_{Ab,t} + x_{aB,t} + x_{ab,t} = 1$。项 $x_{AB,t}x_{ab,t} - x_{Ab,t}x_{aB,t}$ 是在随机交配下有效的连锁不平衡的另一种定义。可以证明它等于 $D_t = x_{AB,t} - p_{A,t}p_{B,t}$。因此，我们有：\n$$x_{AB,t+1} = x_{AB,t} - r D_t$$\n接下来，我们必须确定等位基因频率 $p_{A,t+1}$ 和 $p_{B,t+1}$。在没有选择、突变和迁移的情况下，等位基因频率预期是恒定的。我们将证明这一点。\n第 $t+1$ 代等位基因 $A$ 的频率是 $p_{A,t+1} = x_{AB,t+1} + x_{Ab,t+1}$。我们通过与 $x_{AB,t+1}$ 的对称性来推导 $x_{Ab,t+1}$ 的递归关系。重组会分解 $AB/ab$ 基因型来形成 $Ab$，并会分解 $Ab/aB$ 基因型，使其不再形成 $Ab$。对于重组单倍型，$D_t$ 项的符号是相反的。\n$$x_{Ab,t+1} = x_{Ab,t} + r D_t$$\n类似地，$x_{aB,t+1} = x_{aB,t} + r D_t$ 且 $x_{ab,t+1} = x_{ab,t} - r D_t$。\n现在，我们计算 $p_{A,t+1}$：\n$$p_{A,t+1} = x_{AB,t+1} + x_{Ab,t+1} = (x_{AB,t} - r D_t) + (x_{Ab,t} + r D_t) = x_{AB,t} + x_{Ab,t} = p_{A,t}$$\n以及 $p_{B,t+1}$：\n$$p_{B,t+1} = x_{AB,t+1} + x_{aB,t+1} = (x_{AB,t} - r D_t) + (x_{aB,t} + r D_t) = x_{AB,t} + x_{aB,t} = p_{B,t}$$\n等位基因频率在各代之间是恒定的。设对所有 $t$ 都有 $p_A = p_{A,t}$ 和 $p_B = p_{B,t}$。\n\n现在我们可以写出 $D_{t+1}$ 的表达式：\n$$D_{t+1} = x_{AB,t+1} - p_{A,t+1}p_{B,t+1}$$\n代入我们的结果：\n$$D_{t+1} = (x_{AB,t} - r D_t) - p_A p_B = (x_{AB,t} - p_A p_B) - r D_t$$\n认识到 $D_t = x_{AB,t} - p_A p_B$，我们得到连锁不平衡的单代递归关系：\n$$D_{t+1} = D_t - r D_t = (1-r)D_t$$\n这是第一个要求的结果。\n\n对于第二部分，我们将此结果特化到不连锁基因座的情况，此时 $r=1/2 = 0.5$。\n$$D_{t+1} = (1 - 0.5)D_t = 0.5 D_t$$\n从 $D_t$ 到 $D_{t+1}$ 的映射是按 $1/2$ 的因子缩减。这表明对于不连锁的基因座，连锁不平衡在每一代随机交配后减半。\n\n对于第三部分，我们必须找到连锁不平衡的量值减少超过 $99\\%$ 所需的最小整数代数 $t$。这意味着对于任意初始非零的不平衡 $D_0$，我们需要 $|D_t|  0.01 |D_0|$。该情况被指定为不连锁，因此我们使用递归关系 $D_{t+1} = 0.5 D_t$。\n这是一个一阶线性齐次递归关系。其解是一个等比数列：\n$$D_t = (0.5)^t D_0$$\n我们应用该条件：\n$$|D_0 (0.5)^t|  0.01 |D_0|$$\n由于 $D_0$ 非零，我们可以除以 $|D_0|$：\n$$(0.5)^t  0.01$$\n$$(\\frac{1}{2})^t  \\frac{1}{100}$$\n$$2^{-t}  10^{-2}$$\n为了解出 $t$，我们对两边取自然对数。\n$$\\ln(2^{-t})  \\ln(10^{-2})$$\n$$-t \\ln(2)  -2 \\ln(10)$$\n乘以 $-1$ 会使不等号反向：\n$$t \\ln(2) > 2 \\ln(10)$$\n$$t > \\frac{2 \\ln(10)}{\\ln(2)}$$\n或者，从 $2^t > 100$，我们可以用以2为底的对数来表示：$t > \\log_2(100)$。\n我们知道 $2^6 = 64$ 且 $2^7 = 128$。\n因为 $64  100  128$，很明显 $6  \\log_2(100)  7$。\n其值为 $\\log_2(100) = \\frac{\\ln(100)}{\\ln(2)} = \\frac{2\\ln(10)}{\\ln(2)} \\approx \\frac{2 \\times 2.3026}{0.6931} \\approx 6.6439$。\n问题要求满足不等式 $t > 6.6439$ 的最小整数 $t$。大于此值的最小整数是 $7$。\n因此，对于不连锁的基因座，连锁不平衡衰减到其初始值的 $1\\%$ 以下，至少需要 $7$ 代。\n检验：\n对于 $t=6$：$|D_6|/|D_0| = (0.5)^6 = 1/64 = 0.015625$，不小于 $0.01$。\n对于 $t=7$：$|D_7|/|D_0| = (0.5)^7 = 1/128 = 0.0078125$，小于 $0.01$。\n所需的最小整数代数确实是 $7$。", "answer": "$$\\boxed{7}$$", "id": "2699687"}, {"introduction": "真实的生物群体常常偏离理想的随机交配模式。本练习要求您扩展基本模型，以纳入部分自交——一种在植物和某些动物中常见的交配系统。您将推导近交如何通过减少信息性减数分裂的比例来减缓连锁不平衡的衰减，并通过有效重组率的概念来量化这一效应。[@problem_id:2699693]", "problem": "考虑一个非常大的，实际上是无限的二倍体种群，世代不重叠，每代有固定比例 $\\sigma$ 的个体进行自交（因此有 $1-\\sigma$ 比例的个体进行随机异交）。两个双等位基因座 $A/a$ 和 $B/b$ 位于同一条染色体上，它们之间的重组率为 $r$。假设没有突变、没有选择、也没有遗传漂变。设第 $t$ 代的单倍型（配子）频率为 $x_{AB,t}$、$x_{Ab,t}$、$x_{aB,t}$ 和 $x_{ab,t}$，并定义双基因座连锁不平衡 (LD) 为 $D_t = x_{AB,t} x_{ab,t} - x_{Ab,t} x_{aB,t}$。\n\n从近交下的基因型频率和单个基因座的近交系数 $F$ 的定义出发，并仅使用以下经过充分检验的事实作为基础起点：在一个自交率为常数 $\\sigma$ 的种群中，单个基因座在平衡时的近交系数为 $F = \\sigma/(2 - \\sigma)$，推导 $D$ 的线性化逐代递推关系式，并分离出 $D$ 经过一代后所乘以的乘法因子。你的推导应该明确解释为什么部分自交会减少那些对于打破配子关联具有信息价值的减数分裂的比例，从而缩放了重组的有效作用。\n\n令 $\\lambda$ 表示由 $D_{t+1} = \\lambda D_t$ 定义的逐代乘法衰减因子，该关系对 $D_t$ 精确到一阶（即，忽略 $D_t^2$ 及更高阶的项）。计算当 $\\sigma = 0.6$ 和 $r = 0.1$ 时 $\\lambda$ 的值。请以精确分数形式提供最终答案（不要四舍五入）。无需单位。", "solution": "该问题要求在一个具有恒定自交率 $\\sigma$ 和重组率 $r$ 的大型二倍体种群中，推导连锁不平衡 $D$ 的逐代乘法衰减因子 $\\lambda$。并需要为特定参数计算 $\\lambda$ 的值。\n\n首先，我们必须形式化生命周期和种群状态。我们考虑第 $t$ 代的种群。其状态由四种单倍型的频率描述：$x_{AB,t}$、$x_{Ab,t}$、$x_{aB,t}$ 和 $x_{ab,t}$。由于多代以来存在恒定的自交率 $\\sigma$，我们假设种群已经达到了由近交系数 $F$ 表征的近交平衡水平。问题给出了平衡值 $F = \\frac{\\sigma}{2 - \\sigma}$。这个系数 $F$ 表示一个个体在单个基因座上的两个等位基因是同源相同的概率。\n\n由于这种近交，第 $t$ 代的基因型频率不再符合哈迪-温伯格平衡比例。它们可以用单倍型频率和 $F$ 来表示。对于任意两个单倍型 $i$ 和 $j$，基因型 $G_{ij}$ 的频率由下式给出：\n$$f_{G_{ij}, t} = x_{i,t} x_{j,t} (1-F) + \\delta_{ij} x_{i,t} F$$\n其中，如果单倍型相同（$i=j$），则 $\\delta_{ij} = 1$，否则 $\\delta_{ij} = 0$。与随机交配的种群相比，该方程反映了纯合子过剩和杂合子亏缺。\n\n我们的目标是求出下一代（$t+1$）配子库中的单倍型频率。这些配子是由第 $t$ 代的成年个体通过减数分裂产生的。下一代配子库中某一给定单倍型（例如 $AB$）的频率（$x_{AB, t+1}$）是所有亲代基因型贡献的总和，并按其在第 $t$ 代的频率加权。\n$$x_{AB, t+1} = \\sum_{\\text{All Genotypes } G} f_{G,t} \\times (\\text{Frequency of AB gametes produced by } G)$$\n\n重组会打破等位基因间的关联，但它只改变双杂合子（$AB/ab$ 和 $Ab/aB$）产生的配子类型。其他基因型产生的配子所含的等位基因与亲本染色体上已有的完全相同。对 $AB$ 配子库的贡献如下：\n\\begin{itemize}\n    \\item 基因型 $AB/AB$ (频率 $f_{AB/AB,t}$)：只产生 $AB$ 配子（比例为 $1$）。\n    \\item 基因型 $AB/Ab$ ($f_{AB/Ab,t}$) 和 $AB/aB$ ($f_{AB/aB,t}$)：产生 $AB$ 配子（比例为 $\\frac{1}{2}$）。\n    \\item 基因型 $AB/ab$ ($f_{AB/ab,t}$)：产生非重组的 $AB$ 配子（比例为 $\\frac{1-r}{2}$）。\n    \\item 基因型 $Ab/aB$ ($f_{Ab/aB,t}$)：产生重组的 $AB$ 配子（比例为 $\\frac{r}{2}$）。\n\\end{itemize}\n所有其他基因型产生的 $AB$ 配子均为零。\n\n将这些贡献相加，我们得到：\n$$x_{AB, t+1} = 1 \\cdot f_{AB/AB,t} + \\frac{1}{2} f_{AB/Ab,t} + \\frac{1}{2} f_{AB/aB,t} + \\frac{1-r}{2} f_{AB/ab,t} + \\frac{r}{2} f_{Ab/aB,t}$$\n现在，我们使用包含近交系数 $F$ 的公式代入基因型频率：\n$f_{AB/AB,t} = x_{AB,t}^2 (1-F) + x_{AB,t} F$\n$f_{AB/Ab,t} = 2 x_{AB,t} x_{Ab,t} (1-F)$\n$f_{AB/aB,t} = 2 x_{AB,t} x_{aB,t} (1-F)$\n$f_{AB/ab,t} = 2 x_{AB,t} x_{ab,t} (1-F)$\n$f_{Ab/aB,t} = 2 x_{Ab,t} x_{aB,t} (1-F)$\n\n将这些代入 $x_{AB, t+1}$ 的方程中：\n$$x_{AB, t+1} = [x_{AB,t}^2 (1-F) + x_{AB,t} F] + x_{AB,t} x_{Ab,t} (1-F) + x_{AB,t} x_{aB,t} (1-F) + (1-r) x_{AB,t} x_{ab,t} (1-F) + r x_{Ab,t} x_{aB,t} (1-F)$$\n我们可以从大多数项中提出因子 $(1-F)$：\n$$x_{AB, t+1} = x_{AB,t} F + (1-F) [x_{AB,t}^2 + x_{AB,t} x_{Ab,t} + x_{AB,t} x_{aB,t} + (1-r) x_{AB,t} x_{ab,t} + r x_{Ab,t} x_{aB,t}]$$\n可以从方括号内的前四项中提出因子 $x_{AB,t}$：\n$$x_{AB, t+1} = x_{AB,t} F + (1-F) [x_{AB,t}(x_{AB,t} + x_{Ab,t} + x_{aB,t} + x_{ab,t}) - r x_{AB,t} x_{ab,t} + r x_{Ab,t} x_{aB,t}]$$\n因为所有单倍型频率之和为 $1$，且连锁不平衡为 $D_t = x_{AB,t} x_{ab,t} - x_{Ab,t} x_{aB,t}$，上式可简化为：\n$$x_{AB, t+1} = x_{AB,t} F + (1-F) [x_{AB,t}(1) - r(x_{AB,t} x_{ab,t} - x_{Ab,t} x_{aB,t})]$$\n$$x_{AB, t+1} = x_{AB,t} F + (1-F) [x_{AB,t} - r D_t]$$\n$$x_{AB, t+1} = x_{AB,t} F + x_{AB,t} - F x_{AB,t} - r(1-F)D_t$$\n$$x_{AB, t+1} = x_{AB,t} - r(1-F)D_t$$\n\n根据对称性，其他三种单倍型的递推关系式为：\n$$x_{ab, t+1} = x_{ab,t} - r(1-F)D_t$$\n$$x_{Ab, t+1} = x_{Ab,t} + r(1-F)D_t$$\n$$x_{aB, t+1} = x_{aB,t} + r(1-F)D_t$$\n\n这个结果明确地显示了部分自交如何降低连锁不平衡的衰减速率。衰减是由重组驱动的，重组以频率 $r$ 发生。然而，其对种群配子库的影响被因子 $(1-F)$ 缩放。量 $r_{eff} = r(1-F)$ 可以被解释为有效重组率。自交增加了纯合性。只有当重组发生在双杂合子（$AB/ab$ 或 $Ab/aB$）中时，才能产生新的等位基因组合，从而打破连锁不平衡。通过增加一个或两个基因座上的纯合子频率，自交降低了种群中对重组有信息价值的减数分裂的比例。因子 $(1-F)$ 正是个体非同源合子（即其在一个基因座上的等位基因并非同源相同）的概率，这是杂合性的先决条件。双杂合子的频率（重组对连锁不平衡有影响的情况）与 $(1-F)$ 成比例减少，因此，重组在整个种群中的有效作用也按此相同因子被缩减。\n\n现在，我们推导 $D_t$ 的递推关系式。\n$$D_{t+1} = x_{AB, t+1} x_{ab, t+1} - x_{Ab, t+1} x_{aB, t+1}$$\n$$D_{t+1} = (x_{AB,t} - r(1-F)D_t)(x_{ab,t} - r(1-F)D_t) - (x_{Ab,t} + r(1-F)D_t)(x_{aB,t} + r(1-F)D_t)$$\n展开乘积：\n$$D_{t+1} = [x_{AB,t}x_{ab,t} - r(1-F)D_t(x_{AB,t}+x_{ab,t}) + (r(1-F)D_t)^2] - [x_{Ab,t}x_{aB,t} + r(1-F)D_t(x_{Ab,t}+x_{aB,t}) + (r(1-F)D_t)^2]$$\n平方项相互抵消。\n$$D_{t+1} = (x_{AB,t}x_{ab,t} - x_{Ab,t}x_{aB,t}) - r(1-F)D_t(x_{AB,t}+x_{ab,t}+x_{Ab,t}+x_{aB,t})$$\n$$D_{t+1} = D_t - r(1-F)D_t(1)$$\n$$D_{t+1} = D_t (1 - r(1-F))$$\n这就是 $D_t$ 的线性化（实际上是精确的）递推关系式。因此，乘法衰减因子 $\\lambda$ 为：\n$$\\lambda = 1 - r(1-F)$$\n\n我们已知 $\\sigma = 0.6$ 和 $r = 0.1$。首先，我们必须计算平衡近交系数 $F$：\n$$F = \\frac{\\sigma}{2 - \\sigma} = \\frac{0.6}{2 - 0.6} = \\frac{0.6}{1.4} = \\frac{6}{14} = \\frac{3}{7}$$\n现在，我们将 $r$ 和 $F$ 的值代入 $\\lambda$ 的表达式中：\n$$\\lambda = 1 - r(1-F) = 1 - 0.1 \\left(1 - \\frac{3}{7}\\right)$$\n$$\\lambda = 1 - \\frac{1}{10} \\left(\\frac{7-3}{7}\\right)$$\n$$\\lambda = 1 - \\frac{1}{10} \\left(\\frac{4}{7}\\right)$$\n$$\\lambda = 1 - \\frac{4}{70} = 1 - \\frac{2}{35}$$\n$$\\lambda = \\frac{35}{35} - \\frac{2}{35} = \\frac{33}{35}$$\n最终答案要求为精确分数。", "answer": "$$\\boxed{\\frac{33}{35}}$$", "id": "2699693"}, {"introduction": "最后的这个练习将从纯理论转向基因组数据的实际分析，这是现代演化生物学的一项核心任务。您将构建一个更真实的双组分重组模型，该模型同时考虑了在连锁不平衡模式中留下不同印记的交换和基因转换。随后，您将应用该模型拟合经验数据，从而估计这些基本的演化参数，锻炼您的定量和计算分析能力。[@problem_id:2699672]", "problem": "给定三个标准化的连锁不平衡随物理距离变化的经验曲线。每条曲线由一组以碱基对为单位的距离和测得的标准化连锁不平衡值表示。假设在一个随机交配的群体中，在相关时间尺度上没有选择或漂变效应，并且每代两基因座之间的重组由两种独立的机制产生：交换和基因转换。将交换视为以单位碱基率在基因组上均匀分布，并将基因转换视为一个以单位碱基起始率在基因组上均匀起始的过程，其产生的交换片段长度是独立同分布的，服从已知平均片段长度的指数分布。使用以下基本事实作为您的基础：\n- 根据定义，在一个大的中性群体中，由每代重组概率分隔的两个基因座之间的连锁不平衡（LD）会随世代呈乘性衰减，满足一阶线性递归形式 $D_{t+1} = (1 - c) D_t$，其中 $D_t$ 是在第 $t$ 代等位基因状态的协方差，而 $c$ 是每代中这两个基因座因重组而被分离到不同遗传背景上的概率。\n- 对于在一代内独立发生的稀有事件，无事件发生的概率是各无事件概率的乘积，这意味着组合的每代分离风险在一阶近似下是各组分之和。\n- 标准化LD曲线是在已知的有效世代数后，连锁不平衡与其初始值的比率 $y(d) = D_t(d)/D_0(d)$。在稀有事件近似下，这个标准化的LD是聚合的每代重组风险在已知时间尺度上积分的指数函数。\n\n您的任务：\n1) 从上述基础和所述假设出发，推导相距物理距离为 $d$ 的两个基因座之间的聚合每代重组风险的双组分表达式，该表达式用单位碱基交换率 $r$、单位碱基基因转换起始率 $g$ 和已知的平均基因转换片段长度 $\\ell$ 来表示。解释为什么在每代概率较小的情况下，交换和基因转换对此风险的贡献是可加的，并说明这如何导致在已知的有效时间尺度 $s$ 之后，标准化LD $y(d)$ 呈现指数形式。\n\n2) 使用您推导的模型，在约束条件 $g \\ge 0$ 和 $r \\ge 0$ 下，为两个未知参数 $(g, r)$ 实现一个非线性最小二乘估计器。给定距离数组 $d_i$（单位：碱基对）、观测到的标准化LD值 $y_i$（无量纲）、已知的有效时间尺度 $s$（单位：代）和已知的平均基因转换片段长度 $\\ell$（单位：碱基对）。目标函数应为原始尺度上观测值 $y_i$ 与模型预测值 $\\hat{y}(d_i; g, r)$ 之间偏差的平方和。\n\n3) 将您的估计器应用于以下测试套件。每个测试用例按如下方式提供 $(s, \\ell, \\{d_i\\}, \\{y_i\\})$。单位：距离 $d_i$ 单位为碱基对，平均片段长度 $\\ell$ 单位为碱基对，时间尺度 $s$ 单位为代。报告估计值 $(\\hat{g}, \\hat{r})$，单位为事件/碱基/代。您必须以十进制浮点数形式返回值；不要打印任何百分号。\n\n测试用例1（具有短程陡峭性的双组分）：\n- $s = 10000.0$\n- $\\ell = 300.0$\n- $d = [0.0, 25.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0, 5000.0, 10000.0]$\n- $y = [1.000000, 0.996367, 0.992798, 0.985834, 0.972492, 0.935681, 0.880097, 0.780800, 0.544571, 0.298568]$\n\n测试用例2（仅交换的边界情况）：\n- $s = 10000.0$\n- $\\ell = 500.0$\n- $d = [0.0, 1000.0, 2000.0, 5000.0, 10000.0, 20000.0]$\n- $y = [1.000000, 0.904837, 0.818731, 0.606531, 0.367879, 0.135335]$\n\n测试用例3（具有极短片段的双组分）：\n- $s = 8000.0$\n- $\\ell = 100.0$\n- $d = [0.0, 10.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0]$\n- $y = [1.000000, 0.998535, 0.997176, 0.993614, 0.988986, 0.982468, 0.969364, 0.950096, 0.912822]$\n\n您的程序必须通过最小化观测值 $y$ 和您的模型之间的残差平方和来计算每个测试用例的 $(\\hat{g}, \\hat{r})$。所有输出必须以事件/碱基/代为单位，并使用科学记数法四舍五入到三位有效数字。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表：[[g1,r1],[g2,r2],[g3,r3]]，其中每个数字都以三位有效数字的科学记数法打印（例如，3.50e-08）。不应打印任何其他文本。", "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且内部一致的。它提出了群体遗传学中的一个标准问题：从连锁不平衡数据估计重组参数。其基础物理模型建立在减数分裂重组及其对遗传连锁影响的既定原则之上。我们将继续进行推导和求解。\n\n**任务1：连锁不平衡衰减模型的推导**\n\n两个双等位基因座之间的连锁不平衡（LD）衰减由递归关系 $D_{t+1} = (1 - c) D_t$ 描述，其中 $D_t$ 是第 $t$ 代的LD系数，$c$ 是基因座之间每代的总重组率。经过 $s$ 代后，LD变为 $D_s = (1 - c)^s D_0$，其中 $D_0$ 是初始LD。标准化的LD，$y(d)$，是比率 $D_s/D_0$。\n$$\ny(d) = \\frac{D_s(d)}{D_0(d)} = (1 - c(d))^s\n$$\n在这里，重组率 $c$ 是基因座之间物理距离 $d$ 的函数。对于较小的 $c(d)$（这对于短物理距离上的每代重组率是一个有效假设），我们可以使用近似 $(1 - c(d)) \\approx e^{-c(d)}$。这得到：\n$$\ny(d) \\approx (e^{-c(d)})^s = e^{-s \\cdot c(d)}\n$$\n问题陈述指出，重组是两个独立过程的结果：交换（CO）和基因转换（GC）。至少发生一次重组事件的总概率是 $c(d) = c_{CO}(d) + c_{GC}(d) - c_{CO}(d)c_{GC}(d)$。由于这些是在每代、每碱基对尺度上的稀有事件，乘积项 $c_{CO}(d)c_{GC}(d)$ 与线性项相比可以忽略不计。因此，总重组概率在很好的近似下是各个概率之和：\n$$\nc(d) \\approx c_{CO}(d) + c_{GC}(d)\n$$\n这等价于一个陈述，即总重组风险是独立过程风险之和。设 $h(d)$ 为总风险率，使得 $c(d) \\approx h(d) = h_{CO}(d) + h_{GC}(d)$。\n\n首先，我们对交换分量 $h_{CO}(d)$ 建模。假设交换以每代每碱基对的均匀速率 $r$ 发生。对于相距为 $d$ 的两个基因座，该区间内的预期交换次数为 $r \\cdot d$。假设交换是一个泊松过程，则没有交换发生的概率是 $e^{-rd}$，至少发生一次的概率是 $1 - e^{-rd}$。风险是事件之间指数等待距离的参数，因此就是速率参数，所以对总风险的贡献是：\n$$\nh_{CO}(d) = r \\cdot d\n$$\n\n其次，我们对基因转换分量 $h_{GC}(d)$ 建模。基因转换事件的特征是起始位置和片段长度 $L$。起始以每代每碱基对的均匀速率 $g$ 发生，片段长度从平均值为 $\\ell$ 的指数分布中抽取，其概率密度函数为 $f(L) = (1/\\ell)e^{-L/\\ell}$ for $L \\ge 0$。如果一个基因转换事件的片段覆盖了一个基因座而没有覆盖另一个，它就会导致这两个基因座之间发生重组。\n\n设两个基因座位于位置 $0$ 和 $d$。我们计算基因转换片段分离这两个基因座的速率。这可以通过两种互斥的方式发生：\n1. 一个片段覆盖了位置 $0$ 的基因座，但没有覆盖位置 $d$ 的基因座。\n2. 一个片段覆盖了位置 $d$ 的基因座，但没有覆盖位置 $0$ 的基因座。\n\n对于情况1，考虑一个在位置 $x \\le 0$ 起始的片段。为了覆盖位置 $0$ 的基因座，其长度 $L$ 必须至少为 $-x$。为了不覆盖位置 $d$ 的基因座，其长度 $L$ 必须小于 $d-x$。通过对所有可能的起始点 $x \\le 0$ 和所有相关的片段长度 $L$ 进行积分，可以得到速率：\n$$\n\\text{Rate}_1 = \\int_{-\\infty}^{0} g \\left( \\int_{-x}^{d-x} \\frac{1}{\\ell} e^{-L/\\ell} dL \\right) dx\n$$\n内层积分计算结果为 $[-e^{-L/\\ell}]_{-x}^{d-x} = e^{-(-x)/\\ell} - e^{-(d-x)/\\ell} = e^{x/\\ell} - e^{-(d-x)/\\ell}$。\n将此代入外层积分：\n$$\n\\text{Rate}_1 = g \\int_{-\\infty}^{0} (e^{x/\\ell} - e^{-(d-x)/\\ell}) dx = g \\left[ \\ell e^{x/\\ell} - \\ell e^{-(d-x)/\\ell} \\right]_{-\\infty}^{0}\n$$\n$$\n\\text{Rate}_1 = g \\left( (\\ell e^0 - \\ell e^{-d/\\ell}) - (0 - 0) \\right) = g\\ell(1 - e^{-d/\\ell})\n$$\n根据对称性，情况2（一个片段覆盖了位置 $d$ 的基因座，但没有覆盖位置 $0$ 的基因座）的速率是相同的。这可以通过将原点放在 $d$ 处并考虑第二个基因座位于 $-d$ 来概念化。\n因此，由基因转换引起的总重组风险是这两个速率之和：\n$$\nh_{GC}(d) = \\text{Rate}_1 + \\text{Rate}_2 = 2g\\ell(1 - e^{-d/\\ell})\n$$\n总重组风险 $c(d)$ 是交换和基因转换风险之和：\n$$\nc(d) \\approx h(d) = h_{CO}(d) + h_{GC}(d) = rd + 2g\\ell(1 - e^{-d/\\ell})\n$$\n将此代入标准化LD的表达式中，我们得到最终模型：\n$$\ny(d) = \\exp\\left[-s \\left( rd + 2g\\ell(1-e^{-d/\\ell}) \\right)\\right]\n$$\n这完成了任务1的推导。\n\n**任务2：非线性最小二乘估计器**\n\n目标是从经验数据中估计未知参数 $g$（基因转换起始率）和 $r$（交换率）。数据由一组 $N$ 对物理距离和观测到的标准化LD值组成，即 $\\{ (d_i, y_i) \\}_{i=1}^N$。我们已知有效时间尺度 $s$ 和平均基因转换片段长度 $\\ell$。\n\n我们根据上述推导定义一个模型函数 $\\hat{y}(d_i; g, r)$：\n$$\n\\hat{y}(d_i; g, r) = \\exp\\left[-s \\left( r d_i + 2g\\ell(1-e^{-d_i/\\ell}) \\right)\\right]\n$$\n参数 $(g, r)$ 必须通过最小化观测值 $y_i$ 和模型预测值 $\\hat{y}(d_i; g, r)$ 之间的残差平方和（SSR）来估计。目标函数 $S(g,r)$ 为：\n$$\nS(g,r) = \\sum_{i=1}^{N} \\left[ y_i - \\hat{y}(d_i; g, r) \\right]^2\n$$\n这是一个非线性最小二乘问题。最小化必须在速率不能为负的物理约束下进行：\n$$\ng \\ge 0, \\quad r \\ge 0\n$$\n我们将采用一种数值优化算法，特别是L-BFGS-B方法，它适用于此类有界约束的非线性问题。该算法需要参数 $(g,r)$ 的初始猜测值。基于典型的生物学数值，以 $(10^{-8}, 10^{-8})$ 作为 $(g, r)$ （单位：事件/碱基/代）的初始猜测值是一个合理的起点。\n\n**任务3：应用于测试套件**\n\n实现的估计器将应用于所提供的三个测试用例。对于每个用例，将使用给定的数据集 $(s, \\ell, \\{d_i\\}, \\{y_i\\})$。将执行任务2中描述的优化过程，以找到最小化SSR的最优值 $(\\hat{g}, \\hat{r})$。每个测试用例的结果将以三位有效数字的科学记数法报告。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating recombination parameters from LD data.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"s\": 10000.0,\n            \"ell\": 300.0,\n            \"d\": np.array([0.0, 25.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0, 5000.0, 10000.0]),\n            \"y\": np.array([1.000000, 0.996367, 0.992798, 0.985834, 0.972492, 0.935681, 0.880097, 0.780800, 0.544571, 0.298568]),\n        },\n        {\n            \"s\": 10000.0,\n            \"ell\": 500.0,\n            \"d\": np.array([0.0, 1000.0, 2000.0, 5000.0, 10000.0, 20000.0]),\n            \"y\": np.array([1.000000, 0.904837, 0.818731, 0.606531, 0.367879, 0.135335]),\n        },\n        {\n            \"s\": 8000.0,\n            \"ell\": 100.0,\n            \"d\": np.array([0.0, 10.0, 20.0, 50.0, 100.0, 200.0, 500.0, 1000.0, 2000.0]),\n            \"y\": np.array([1.000000, 0.998535, 0.997176, 0.993614, 0.988986, 0.982468, 0.969364, 0.950096, 0.912822]),\n        }\n    ]\n\n    results = []\n\n    # Model function for normalized LD\n    def model_y(params, d, s, ell):\n        \"\"\"\n        Calculates predicted normalized LD based on the derived model.\n        params: tuple (g, r)\n            g: gene conversion initiation rate per base\n            r: crossover rate per base\n        d: array of distances in base pairs\n        s: effective timescale in generations\n        ell: mean gene conversion tract length in base pairs\n        \"\"\"\n        g, r = params\n        recombination_hazard = r * d + 2 * g * ell * (1 - np.exp(-d / ell))\n        return np.exp(-s * recombination_hazard)\n\n    # Objective function: Sum of Squared Residuals\n    def objective_ssr(params, d_obs, y_obs, s, ell):\n        \"\"\"\n        Calculates the sum of squared residuals between observed and predicted y.\n        \"\"\"\n        y_pred = model_y(params, d_obs, s, ell)\n        return np.sum((y_obs - y_pred)**2)\n\n    for case in test_cases:\n        s = case[\"s\"]\n        ell = case[\"ell\"]\n        d_obs = case[\"d\"]\n        y_obs = case[\"y\"]\n\n        # Initial guess for parameters (g, r)\n        initial_guess = (1e-8, 1e-8)\n\n        # Parameter bounds (g = 0, r = 0)\n        bounds = [(0, None), (0, None)]\n\n        # Perform non-linear least squares optimization\n        result = minimize(\n            fun=objective_ssr,\n            x0=initial_guess,\n            args=(d_obs, y_obs, s, ell),\n            method='L-BFGS-B',\n            bounds=bounds\n        )\n\n        g_hat, r_hat = result.x\n        results.append(f\"[{g_hat:.2e},{r_hat:.2e}]\")\n        \n    # Final print statement in the exact required format.\n    print(f\"[[{','.join(results)}]]\")\n\nsolve()\n```", "id": "2699672"}]}