{"hands_on_practices": [{"introduction": "地理镶嵌理论的核心在于理解选择压力如何在地理上变化，但最终通过基因流在物种层面整合。本练习为此概念构建了数学基础。通过从第一性原理推导全域平均选择梯度，您将精确理解不同斑块的适合度变异如何结合起来，共同决定一个物种的总体演化方向，这是为空间结构化种群中的协同演化建模的一项基本技能。[@problem_id:2719766]", "problem": "两个相互作用的物种，物种A和物种B，在一个符合协同演化地理镶嵌理论的异质性景观中共同演化。设物种A的平均性状值为 $z_A$，物种B的平均性状值为 $z_B$。环境异质性由 $K$ 个不同的生态斑块（索引为 $k \\in \\{1,\\dots,K\\}$）所体现，每个斑块被遇到的频率为 $\\pi_k$，满足 $\\sum_{k=1}^{K} \\pi_k = 1$ 且对所有 $k$ 都有 $\\pi_k > 0$。在斑块 $k$ 中，物种A的个体适合度为 $w_A^{(k)} = f_k(z_A, z_B)$，物种B的个体适合度为 $w_B^{(k)} = g_k(z_A, z_B)$，其中 $f_k$ 和 $g_k$ 是关于性状的正值、二次连续可微函数，概括了协同演化互作和局域生态条件的影响。\n\n假设：\n- 在每个物种内部，性状近似服从方差很小且选择很弱的正态分布，因此在 $(z_A, z_B)$ 附近的一阶（线性）近似是准确的。\n- 高强度的基因流在每一代中使每个物种内的性状均值在各个斑块间同质化，因此在给定的一代中，每个斑块经历相同的 $(z_A, z_B)$。\n- 在所考虑的时间尺度上，传递偏差可以忽略不计。\n\n以Price方程为基本基础，并利用相对适合度的定义，从第一性原理推导作用于每个物种性状的定向选择梯度表达式，这些梯度决定了整个镶嵌景观中对 $z_A$ 和 $z_B$ 的即时选择方向。您的推导过程应首先表达每个物种在所有斑块上的平均适合度，然后将相对适合度对其自身性状求导。请将您的最终答案表示为行矩阵 $\\bigl(\\beta_A\\ \\beta_B\\bigr)$ 的形式，其中 $\\beta_A$ 和 $\\beta_B$ 分别是作用于 $z_A$ 和 $z_B$ 的定向选择梯度。请用 $\\{\\pi_k\\}_{k=1}^{K}$、$\\{f_k\\}_{k=1}^{K}$ 和 $\\{g_k\\}_{k=1}^{K}$ 以闭合形式给出最终表达式。无需进行数值评估，也无需四舍五入。", "solution": "该问题陈述科学基础扎实、内容自洽且提问明确。它是在理论数量遗传学应用于协同演化地理镶嵌理论方面的一个标准练习。我们将从第一性原理出发进行严格的推导。\n\n作用于一个数量性状的即时选择方向由定向选择梯度决定，记为 $\\beta$。Price方程为这一概念提供了基本基础。平均性状 $\\bar{z}$ 的变化由 $\\Delta \\bar{z} = \\text{Cov}(w, z) + \\text{E}(w \\Delta z)$ 给出，其中 $w$ 是相对适合度，$z$ 是性状，$\\text{Cov}$ 是协方差，$\\text{E}$ 是期望。问题指明传递偏差可以忽略不计，因此第二项 $\\text{E}(w \\Delta z)$ 可以被忽略。在弱选择的假设下，平均性状的变化可以很好地近似为 $\\Delta \\bar{z} \\approx G \\beta_z$，其中 $G$ 是该性状的加性遗传方差。选择梯度 $\\beta_z$ 定义为个体的相对适合度对其自身性状值的偏导数，并在种群平均性状处取值。我们应用此定义来推导物种A和物种B的选择梯度。\n\n我们首先考虑物种A。设 $z_A'$ 表示物种A中一个个体的性状值，而 $z_A$ 是整个物种的平均性状值。问题陈述高强度的基因流使性状均值在所有 $K$ 个斑块间同质化。因此，具有性状 $z_A'$ 的个体的适合度是在整个景观上平均的。该个体的绝对适合度 $W_A(z_A', z_B)$ 是其在每个斑块 $k$ 中适合度的加权平均，权重为斑块频率 $\\pi_k$。该适合度取决于个体的性状 $z_A'$ 和相互作用物种B的平均性状 $z_B$。\n$$W_A(z_A', z_B) = \\sum_{k=1}^{K} \\pi_k f_k(z_A', z_B)$$\n整个物种A种群的平均绝对适合度 $\\bar{W}_A$ 是通过在种群平均性状值 $z_A' = z_A$ 处评估 $W_A(z_A', z_B)$ 得到的。\n$$\\bar{W}_A(z_A, z_B) = \\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)$$\n具有性状 $z_A'$ 的个体的相对适合度是其绝对适合度除以种群的平均绝对适合度。\n$$w_A(z_A') = \\frac{W_A(z_A', z_B)}{\\bar{W}_A(z_A, z_B)}$$\n作用于性状 $z_A$ 的定向选择梯度，记为 $\\beta_A$，是该相对适合度函数对个体性状 $z_A'$ 的偏导数，并在种群均值 $z_A$ 处取值。\n$$\\beta_A = \\frac{\\partial w_A(z_A')}{\\partial z_A'} \\bigg|_{z_A' = z_A}$$\n我们使用商法则来计算这个导数。关键要注意的是，$\\bar{W}_A(z_A, z_B)$ 是种群平均性状 $z_A$ 的函数，因此在对个体性状变量 $z_A'$ 求导时被视为常数。\n$$\\frac{\\partial w_A(z_A')}{\\partial z_A'} = \\frac{\\partial}{\\partial z_A'} \\left( \\frac{W_A(z_A', z_B)}{\\bar{W}_A(z_A, z_B)} \\right) = \\frac{1}{\\bar{W}_A(z_A, z_B)} \\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'}$$\n个体绝对适合度的导数为：\n$$\\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'} = \\frac{\\partial}{\\partial z_A'} \\left( \\sum_{k=1}^{K} \\pi_k f_k(z_A', z_B) \\right) = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A', z_B)}{\\partial z_A'}$$\n在 $z_A' = z_A$ 处求值得到：\n$$\\frac{\\partial W_A(z_A', z_B)}{\\partial z_A'} \\bigg|_{z_A' = z_A} = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}$$\n将此结果代回 $\\beta_A$ 的表达式中，我们得到：\n$$\\beta_A = \\frac{1}{\\bar{W}_A(z_A, z_B)} \\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}$$\n最后，我们代入 $\\bar{W}_A(z_A, z_B)$ 的表达式：\n$$\\beta_A = \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}}{\\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)}$$\n这就是作用于性状 $z_A$ 的选择梯度。它是景观平均的选择压力，并由景观平均的适合度进行了归一化。\n\n对物种B的推导遵循完全相同的逻辑。设 $z_B'$ 是物种B中一个个体的性状，而 $z_B$ 是种群均值。该个体的绝对适合度 $W_B(z_A, z_B')$ 取决于其自身性状和物种A的平均性状 $z_A$。\n$$W_B(z_A, z_B') = \\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B')$$\n物种B种群的平均绝对适合度是：\n$$\\bar{W}_B(z_A, z_B) = \\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)$$\n个体的相对适合度为 $w_B(z_B') = W_B(z_A, z_B') / \\bar{W}_B(z_A, z_B)$。选择梯度 $\\beta_B$ 为：\n$$\\beta_B = \\frac{\\partial w_B(z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B}$$\n遵循与物种A相同的步骤：\n$$\\beta_B = \\frac{1}{\\bar{W}_B(z_A, z_B)} \\frac{\\partial W_B(z_A, z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B}$$\n$$\\frac{\\partial W_B(z_A, z_B')}{\\partial z_B'} \\bigg|_{z_B' = z_B} = \\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}$$\n代入这些表达式得到 $\\beta_B$ 的最终形式：\n$$\\beta_B = \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}}{\\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)}$$\n问题要求答案以行矩阵 $(\\beta_A, \\beta_B)$ 的形式给出。结合推导出的表达式，我们得到最终结果。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial f_k(z_A, z_B)}{\\partial z_A}}{\\sum_{k=1}^{K} \\pi_k f_k(z_A, z_B)}  \\frac{\\sum_{k=1}^{K} \\pi_k \\frac{\\partial g_k(z_A, z_B)}{\\partial z_B}}{\\sum_{k=1}^{K} \\pi_k g_k(z_A, z_B)} \\end{pmatrix} } $$", "id": "2719766"}, {"introduction": "在掌握了选择如何在镶嵌景观中运作之后，下一步是模拟由此产生的演化动态。本练习将探讨局部适应与基因流的同质化效应之间的经典张力。通过求解一个双种群系统中的平衡性状值，您将看到局部选择强度和迁移率之间的平衡如何定量地决定局部适应的程度，为理解基因流如何导致性状错配（地理镶嵌理论的一个关键预测）提供了具体的模型。[@problem_id:2719868]", "problem": "考虑一个双亚群集合种群，亚群之间通过对称扩散相连，每代迁移率为 $m$（岛屿模型）。单个数量性状 $z$ 在数量遗传动力学下演化。在每个亚群 $i \\in \\{1,2\\}$ 中，设 $\\bar{z}_i$ 表示平均性状值。假设：\n- 在两个亚群中，加性遗传方差是恒定的，且等于 $G$。\n- 在每个亚群中，性状根据Lande方程演化，迁移将亚群耦合在一起：$\\bar{z}_i$ 的每代变化量由 $G \\beta_i(\\bar{z}_i)$ 加上来自另一亚群的迁入个体所带来的净增益给出。\n- 局域协同演化相互作用产生围绕亚群特有最优值 $\\theta_1$ 和 $\\theta_2$ 的高斯稳定化选择，且曲率相等。具体来说，亚群 $i$ 中的马尔萨斯适应度满足 $\\ln W_i(z) = \\text{const} - \\frac{a}{2}(z - \\theta_i)^2$，其中 $a0$ 衡量稳定化选择的强度。因此，局域选择梯度（$\\ln W_i$ 关于 $z$ 的导数）为 $\\beta_i(\\bar{z}_i) = -a(\\bar{z}_i - \\theta_i)$。\n\n从这些假设和包含迁移的Lande方程的定义出发，推导出平衡平均性状值 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$ 关于 $G$、$a$、$m$、$\\theta_1$ 和 $\\theta_2$ 的闭式解析表达式。将你的最终答案表示为一个单行矩阵，其元素为 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$。不需要进行数值近似或四舍五入。", "solution": "该问题要求在一个包含选择和迁移的双亚群数量遗传模型中，求解平衡平均性状值。对问题陈述的验证证实了其科学基础扎实、问题设定合理且客观。我们可以开始推导。\n\n在每个亚群 $i \\in \\{1, 2\\}$ 中，平均性状值 $\\bar{z}_i$ 的动力学由Lande方程决定，该方程经过扩展以包含迁移效应。平均性状值的每代变化量 $\\Delta\\bar{z}_i$ 是选择响应和基因流引起的变化之和。选择响应由加性遗传方差 $G$ 和选择梯度 $\\beta_i$ 的乘积给出。从亚群 $j$ 到亚群 $i$ 的基因流引起的变化与迁移率 $m$ 以及平均性状值的差异成正比，即 $m(\\bar{z}_j - \\bar{z}_i)$。\n\n因此，我们可以写出关于平均性状值 $\\bar{z}_1$ 和 $\\bar{z}_2$ 的差分方程组如下：\n$$\n\\Delta\\bar{z}_1 = \\bar{z}_1(t+1) - \\bar{z}_1(t) = G \\beta_1(\\bar{z}_1) + m(\\bar{z}_2 - \\bar{z}_1)\n$$\n$$\n\\Delta\\bar{z}_2 = \\bar{z}_2(t+1) - \\bar{z}_2(t) = G \\beta_2(\\bar{z}_2) + m(\\bar{z}_1 - \\bar{z}_2)\n$$\n问题指定了围绕局域最优值 $\\theta_i$ 的高斯稳定化选择的选择梯度为 $\\beta_i(\\bar{z}_i) = -a(\\bar{z}_i - \\theta_i)$，其中 $a  0$ 是选择强度。将此代入动态方程，得到：\n$$\n\\Delta\\bar{z}_1 = -G a (\\bar{z}_1 - \\theta_1) + m(\\bar{z}_2 - \\bar{z}_1)\n$$\n$$\n\\Delta\\bar{z}_2 = -G a (\\bar{z}_2 - \\theta_2) + m(\\bar{z}_1 - \\bar{z}_2)\n$$\n在平衡状态下，平均性状值不再变化，因此 $\\Delta\\bar{z}_1 = 0$ 且 $\\Delta\\bar{z}_2 = 0$。设平衡性状值为 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$。平衡时的方程组为：\n$$\n0 = -G a (\\bar{z}_1^{\\ast} - \\theta_1) + m(\\bar{z}_2^{\\ast} - \\bar{z}_1^{\\ast}) \\quad (1)\n$$\n$$\n0 = -G a (\\bar{z}_2^{\\ast} - \\theta_2) + m(\\bar{z}_1^{\\ast} - \\bar{z}_2^{\\ast}) \\quad (2)\n$$\n我们现在必须求解这个关于 $\\bar{z}_1^{\\ast}$ 和 $\\bar{z}_2^{\\ast}$ 的二元一次方程组。让我们重新整理这些方程。\n从方程 ($1$):\n$$\nG a (\\bar{z}_1^{\\ast} - \\theta_1) = m(\\bar{z}_2^{\\ast} - \\bar{z}_1^{\\ast})\n$$\n$$\nG a \\bar{z}_1^{\\ast} - G a \\theta_1 = m \\bar{z}_2^{\\ast} - m \\bar{z}_1^{\\ast}\n$$\n$$\n(G a + m) \\bar{z}_1^{\\ast} - m \\bar{z}_2^{\\ast} = G a \\theta_1 \\quad (3)\n$$\n从方程 ($2$):\n$$\nG a (\\bar{z}_2^{\\ast} - \\theta_2) = m(\\bar{z}_1^{\\ast} - \\bar{z}_2^{\\ast})\n$$\n$$\nG a \\bar{z}_2^{\\ast} - G a \\theta_2 = m \\bar{z}_1^{\\ast} - m \\bar{z}_2^{\\ast}\n$$\n$$\n-m \\bar{z}_1^{\\ast} + (G a + m) \\bar{z}_2^{\\ast} = G a \\theta_2 \\quad (4)\n$$\n将方程 ($3$) 和方程 ($4$) 相加，可以得到一个有用的简化：\n$$\n[(G a + m) - m] \\bar{z}_1^{\\ast} + [-m + (G a + m)] \\bar{z}_2^{\\ast} = G a \\theta_1 + G a \\theta_2\n$$\n$$\nG a \\bar{z}_1^{\\ast} + G a \\bar{z}_2^{\\ast} = G a (\\theta_1 + \\theta_2)\n$$\n由于 $G$ 和 $a$ 是正常数，我们可以两边同除以 $G a$：\n$$\n\\bar{z}_1^{\\ast} + \\bar{z}_2^{\\ast} = \\theta_1 + \\theta_2\n$$\n这表明平衡平均性状值之和等于选择最优值之和。由此，我们可以将一个变量用另一个变量表示：$\\bar{z}_2^{\\ast} = \\theta_1 + \\theta_2 - \\bar{z}_1^{\\ast}$。\n将 $\\bar{z}_2^{\\ast}$ 的这个表达式代入方程 ($3$):\n$$\n(G a + m) \\bar{z}_1^{\\ast} - m (\\theta_1 + \\theta_2 - \\bar{z}_1^{\\ast}) = G a \\theta_1\n$$\n$$\nG a \\bar{z}_1^{\\ast} + m \\bar{z}_1^{\\ast} - m \\theta_1 - m \\theta_2 + m \\bar{z}_1^{\\ast} = G a \\theta_1\n$$\n合并含有 $\\bar{z}_1^{\\ast}$ 的项：\n$$\n(G a + 2m) \\bar{z}_1^{\\ast} = G a \\theta_1 + m \\theta_1 + m \\theta_2\n$$\n$$\n(G a + 2m) \\bar{z}_1^{\\ast} = (G a + m)\\theta_1 + m \\theta_2\n$$\n解出 $\\bar{z}_1^{\\ast}$ 可得：\n$$\n\\bar{z}_1^{\\ast} = \\frac{(G a + m) \\theta_1 + m \\theta_2}{G a + 2m}\n$$\n由于问题设置的对称性，$\\bar{z}_2^{\\ast}$ 的表达式可以通过简单地交换下标 $1$ 和 $2$ 得到：\n$$\n\\bar{z}_2^{\\ast} = \\frac{(G a + m) \\theta_2 + m \\theta_1}{G a + 2m}\n$$\n这些就是平衡平均性状值的闭式解析表达式。表达式表明，每个平衡性状值是两个最优值 $\\theta_1$ 和 $\\theta_2$ 的加权平均。权重取决于选择（$G a$）和迁移（$m$）的相对强度。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{(G a + m) \\theta_1 + m \\theta_2}{G a + 2m}  \\frac{(G a + m) \\theta_2 + m \\theta_1}{G a + 2m} \\end{pmatrix}}\n$$", "id": "2719868"}, {"introduction": "理论模型固然强大，但地理镶嵌理论终究是一个理解自然界中协同演化的经验性框架。这最后一个练习旨在连接理论与数据，展示如何量化地理选择镶嵌并检验其根本原因。本练习将指导您如何从野外数据中推导选择梯度的估计量，并将其变异分解为生态和演化两个部分，从而掌握检验地理镶嵌理论核心原则的统计工具：即非生物环境和相互作用物种的性状共同塑造了协同演化的地理格局。[@problem_id:2719800]", "problem": "考虑一个协同演化的物种对，分布在 $m$ 个由 $i \\in \\{1,\\dots,m\\}$ 索引的离散地点。在每个地点 $i$，您采集了焦点物种的 $n_i$ 个个体，并对每个个体 $j \\in \\{1,\\dots,n_i\\}$ 测量了一个焦点数量性状 $z_{ij}$ 及其绝对适合度 $W_{ij}$。您还记录了每个地点 $i$ 的一个生态驱动因子 $X_i$（例如，资源指数）和一个相互作用者性状的局部均值 $y_i$（例如，介导相互选择的平均拮抗性状）。假设在每个地点 $i$ 内，对焦点性状的方向性选择可以很好地用相对适合度与该性状之间的线性关系来近似；并且在不同地点之间，局部方向性选择梯度的变异源于生态环境和相互作用者的演化分化，这与协同演化的地理镶嵌理论一致。\n\n1) 仅使用相对适合度和普通最小二乘法的定义，推导地点 $i$ 内对 $z$ 的方向性选择梯度 $\\beta_i$ 的一个地点特异的、无偏的估计量 $\\hat{\\beta}_i$，该估计量是相对适合度对性状回归的斜率。您的估计量必须用 $\\{z_{ij},W_{ij}\\}_{j=1}^{n_i}$ 和地点水平的样本均值明确表示。\n\n2) 为了捕捉地理镶嵌，假设 $\\beta_i$ 的地点间变异可以用一个包含生态预测变量和演化预测变量的线性模型来描述，\n$$\n\\beta_i \\;=\\; \\alpha \\;+\\; \\gamma_{E}\\,X_i \\;+\\; \\gamma_{Y}\\,y_i \\;+\\; \\varepsilon_i,\n$$\n其中 $\\alpha$ 是截距，$\\gamma_{E}$ 和 $\\gamma_{Y}$ 是回归系数，$\\varepsilon_i$ 是独立、均值为零且方差恒定的残差。仅使用方差、协方差和线性法则，推导一个封闭形式的表达式，将地点间方差 $\\mathrm{Var}(\\beta_i)$ 分解为一个可归因于 $X_i$ 的生态分量、一个可归因于 $y_i$ 的演化分量、一个生态-演化耦合项以及一个残差分量。将您的最终分解式完全用 $\\gamma_{E}$、$\\gamma_{Y}$、$\\mathrm{Var}(X_i)$、$\\mathrm{Var}(y_i)$、$\\mathrm{Cov}(X_i,y_i)$ 和 $\\mathrm{Var}(\\varepsilon_i)$ 来表示。\n\n以一对解析表达式的形式提供您的最终答案，将其排列成一个单行矩阵，其中第一个条目是您在第1部分中得到的估计量 $\\hat{\\beta}_i$，第二个条目是您在第2部分中得到的方差分解。不需要进行数值计算，最终答案中也不应包含单位。", "solution": "这个问题有科学依据，提法严谨，可以通过直接应用统计学和数量演化生物学的标准原理来解决。\n\n第1部分：地点特异性选择梯度估计量 $\\hat{\\beta}_i$ 的推导。\n\n目标是推导特定地点 $i$ 内方向性选择梯度 $\\beta_i$ 的一个估计量。问题指定了相对适合度与数量性状 $z$ 之间存在线性关系。\n\n首先，我们定义相对适合度。对于地点 $i$ 中的任何个体 $j$，其绝对适合度为 $W_{ij}$。包含 $n_i$ 个个体的地点 $i$ 的平均绝对适合度由下式给出：\n$$ \\bar{W}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} W_{ij} $$\n相对适合度 $w_{ij}$ 则定义为个体的绝对适合度除以地点均值：\n$$ w_{ij} = \\frac{W_{ij}}{\\bar{W}_i} $$\n相对适合度的一个关键性质是，其在一个地点内的样本均值恒为1：\n$$ \\bar{w}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} w_{ij} = \\frac{1}{n_i} \\sum_{j=1}^{n_i} \\frac{W_{ij}}{\\bar{W}_i} = \\frac{1}{n_i \\bar{W}_i} \\left( \\sum_{j=1}^{n_i} W_{ij} \\right) = \\frac{1}{n_i \\bar{W}_i} (n_i \\bar{W}_i) = 1 $$\n\n问题陈述，相对适合度与性状 $z_{ij}$ 之间的关系由一个线性模型近似：\n$$ w_{ij} = \\alpha_i' + \\beta_i z_{ij} + e_{ij} $$\n其中 $\\beta_i$ 是我们感兴趣的方向性选择梯度。我们的任务是找到这个斜率的普通最小二乘法 (OLS) 估计量，我们将其记为 $\\hat{\\beta}_i$。\n\n对于响应变量 $Y$ 对预测变量 $X$ 的简单线性回归，OLS斜率估计量的通用公式为：\n$$ \\hat{\\beta} = \\frac{\\sum_{k=1}^{N} (X_k - \\bar{X})(Y_k - \\bar{Y})}{\\sum_{k=1}^{N} (X_k - \\bar{X})^2} $$\n对于我们在地点 $i$ 的特定情况，我们有 $Y_j = w_{ij}$ 和 $X_j = z_{ij}$。对应的样本均值为 $\\bar{Y} = \\bar{w}_i = 1$ 和 $\\bar{X} = \\bar{z}_i$，其中 $\\bar{z}_i = \\frac{1}{n_i} \\sum_{j=1}^{n_i} z_{ij}$。\n\n将这些代入OLS公式，得到 $\\beta_i$ 的估计量：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(w_{ij} - \\bar{w}_i)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(w_{ij} - 1)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n现在，我们必须用给定的量 $\\{z_{ij}, W_{ij}\\}$ 以及地点水平的样本均值 $\\bar{z}_i$ 和 $\\bar{W}_i$ 来表示这个式子。我们代入 $w_{ij} = W_{ij} / \\bar{W}_i$：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) \\left( \\frac{W_{ij}}{\\bar{W}_i} - 1 \\right)}{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n分子可以展开为：\n$$ \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) \\left( \\frac{W_{ij}}{\\bar{W}_i} - 1 \\right) = \\frac{1}{\\bar{W}_i} \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij} - \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) $$\n第二项 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)$ 根据均值的定义恒等于零。因此，分子简化为：\n$$ \\frac{1}{\\bar{W}_i} \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij} $$\n项 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i) W_{ij}$ 是中心化性状值和绝对适合度值的交叉乘积之和。这也可以用中心化的适合度值来表示，即 $\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)$，因为增加的项 $-\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)$ 为零。\n因此，估计量 $\\hat{\\beta}_i$ 的最终表达式为：\n$$ \\hat{\\beta}_i = \\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)}{\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2} $$\n这个表达式满足了问题的要求。它是性状和绝对适合度的样本协方差，除以平均绝对适合度与性状的样本方差的乘积（分子和分母中都有一个因子 $n_i - 1$ 或 $n_i$，它们相互抵消）。\n\n第2部分：地点间选择梯度 $\\mathrm{Var}(\\beta_i)$ 的方差分解。\n\n问题的第二部分要求基于所提供的线性模型来分解选择梯度的地点间方差 $\\mathrm{Var}(\\beta_i)$：\n$$ \\beta_i = \\alpha + \\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i + \\varepsilon_i $$\n在这里，$\\beta_i$、$X_i$、$y_i$ 和 $\\varepsilon_i$ 是代表 $m$ 个地点间变异的随机变量，而 $\\alpha$、$\\gamma_E$ 和 $\\gamma_Y$ 是固定系数。残差 $\\varepsilon_i$ 独立，均值为零，方差恒定为 $\\mathrm{Var}(\\varepsilon_i)$，并且与预测变量 $X_i$ 和 $y_i$ 独立。\n\n我们对方程 $\\beta_i$ 应用方差算子：\n$$ \\mathrm{Var}(\\beta_i) = \\mathrm{Var}(\\alpha + \\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i + \\varepsilon_i) $$\n使用方差的基本性质：\n1.  常数的方差为零，所以 $\\mathrm{Var}(\\alpha)=0$。\n2.  随机变量 $A$ 和 $B$ 之和的方差为 $\\mathrm{Var}(A+B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) + 2\\mathrm{Cov}(A,B)$。\n\n由于误差项 $\\varepsilon_i$ 与 $X_i$ 和 $y_i$ 都独立，因此它也与它们的任何线性组合独立。所以，$\\varepsilon_i$ 与其他变量项之间的协方差为零：\n$$ \\mathrm{Cov}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i, \\varepsilon_i) = 0 $$\n这使我们能够分离出误差项的方差：\n$$ \\mathrm{Var}(\\beta_i) = \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) + \\mathrm{Var}(\\varepsilon_i) $$\n接下来，我们使用相关变量加权和的方差规则来展开第一项：\n$$ \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) = \\mathrm{Var}(\\gamma_{E}\\,X_i) + \\mathrm{Var}(\\gamma_{Y}\\,y_i) + 2\\mathrm{Cov}(\\gamma_{E}\\,X_i, \\gamma_{Y}\\,y_i) $$\n对于常数 $c$ 和 $d$，使用性质 $\\mathrm{Var}(cA) = c^2\\mathrm{Var}(A)$ 和 $\\mathrm{Cov}(cA, dB) = cd\\mathrm{Cov}(A,B)$：\n$$ \\mathrm{Var}(\\gamma_{E}\\,X_i + \\gamma_{Y}\\,y_i) = \\gamma_{E}^{2}\\,\\mathrm{Var}(X_i) + \\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i) + 2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i) $$\n将此结果与残差方差结合，得到完整的分解：\n$$ \\mathrm{Var}(\\beta_i) = \\gamma_{E}^{2}\\,\\mathrm{Var}(X_i) + \\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i) + 2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i) + \\mathrm{Var}(\\varepsilon_i) $$\n这个表达式按要求分解了选择梯度的总方差：\n-   $\\gamma_{E}^{2}\\,\\mathrm{Var}(X_i)$ 是生态分量，源于生态驱动因子 $X_i$ 的变异。\n-   $\\gamma_{Y}^{2}\\,\\mathrm{Var}(y_i)$ 是演化分量，源于相互作用者性状 $y_i$ 的变异。\n-   $2\\gamma_{E}\\gamma_{Y}\\mathrm{Cov}(X_i, y_i)$ 是生态-演化耦合项，源于生态预测变量和演化预测变量之间的统计关联。\n-   $\\mathrm{Var}(\\varepsilon_i)$ 是残差方差，代表所有其他未被模型捕获的变异来源。\n\n这个表达式就是所要求的封闭形式的分解。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)(W_{ij} - \\bar{W}_i)}{\\bar{W}_i \\sum_{j=1}^{n_i} (z_{ij} - \\bar{z}_i)^2}  \\gamma_{E}^{2} \\mathrm{Var}(X_i) + \\gamma_{Y}^{2} \\mathrm{Var}(y_i) + 2 \\gamma_{E} \\gamma_{Y} \\mathrm{Cov}(X_i, y_i) + \\mathrm{Var}(\\varepsilon_i)\n\\end{pmatrix}\n}\n$$", "id": "2719800"}]}