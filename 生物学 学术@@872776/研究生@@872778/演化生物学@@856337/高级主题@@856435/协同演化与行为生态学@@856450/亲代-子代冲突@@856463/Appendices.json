{"hands_on_practices": [{"introduction": "亲子冲突的核心源于亲代和子代在遗传利益上的不对称性。本练习将引导你从广义适合度的第一性原理出发，推导出亲代和子代的最优投资策略，通过精确计算亲缘关系系数，揭示冲突的根本遗传基础 [@problem_id:2740664]。这个基础性的推导是理解所有亲子冲突模型的关键第一步。", "problem": "考虑一个二倍体、有性繁殖且无近亲繁殖的物种。单个亲代向一个目标子代分配连续的投入量 $x \\ge 0$。这项投入为目标子代带来收益 $b(x)$，该收益以目标子代存活后代等价物的预期增加量来衡量；同时，这项投入对同一亲代所有其他后代的生产和存活造成总成本 $c(x)$，该成本以亲代存活的非目标后代数量的预期减少量来衡量。假设 $b(x)$ 是递增且严格凹的，因此 $b'(x)  0$ 且 $b''(x)  0$；并且 $c(x)$ 是递增且严格凸的，因此 $c'(x)  0$ 且 $c''(x)  0$。亲缘系数根据同源基因（identity by descent）的标准定义。\n\n从广义适合度的第一性原理出发：亲代通过用其与后代的亲缘系数对后代的变化进行加权，来评估对其广义适合度的边际效应；目标子代通过用其与自身和兄弟姐妹的亲缘系数对这些个体的变化进行加权，来评估对其广义适合度的边际效应。\n\n1. 推导亲代对目标子代的最优投入 $x_{\\mathrm{P}}^{\\ast}$ 的一阶条件，其形式为 $b'(x_{\\mathrm{P}}^{\\ast}) = \\lambda\\, c'(x_{\\mathrm{P}}^{\\ast})$，并在上述假设下，将 $\\lambda$ 确定为亲缘系数的比值。\n\n2. 假设在非目标后代中，有比例为 $q \\in [0,1]$ 的是目标子代的半同胞（与目标的亲缘关系为 $1/4$），剩余比例为 $1-q$ 的是全同胞（与目标的亲缘关系为 $1/2$）。推导目标子代最优需求 $x_{\\mathrm{O}}^{\\ast}$ 的一阶条件，其形式为 $b'(x_{\\mathrm{O}}^{\\ast}) = \\mu\\, c'(x_{\\mathrm{O}}^{\\ast})$，并将 $\\mu$ 确定为用 $q$ 表示的亲缘系数比值。简要解释为什么对于 $q \\in [0,1]$，$\\mu  \\lambda$ 成立。\n\n3. 现在采用具体的函数形式 $b(x) = \\alpha \\ln(1+x)$（其中 $\\alpha  0$）和 $c(x) = \\delta x^{2}$（其中 $\\delta  0$）。计算比率 $R \\equiv x_{\\mathrm{O}}^{\\ast} / x_{\\mathrm{P}}^{\\ast}$ 关于 $\\alpha$、$\\delta$ 和 $q$ 的闭合形式表达式。将最终答案表示为仅包含 $\\alpha$、$\\delta$ 和 $q$ 的单个简化解析表达式。不要进行近似或四舍五入。", "solution": "对问题陈述进行严格审查后，认定其是有效的。这是一个适定问题，基于演化生物学的既定原则，特别是亲代-子代冲突理论。其假设是标准的，足以得出唯一解。我们开始进行推导。\n\n该问题要求基于广义适合度原则，从亲代和目标子代的角度分析最优投入。个体的广义适合度是其自身繁殖成功（直接适合度）的总和，加上其行为对其亲属繁殖成功的影响，其中每项影响都由相应的亲缘系数加权。\n\n第1部分：亲代的最优投入\n亲代的广义适合度 $W_{\\mathrm{P}}$ 受到对目标子代的投入 $x$ 的影响。这项投入使目标子代的适合度增加 $b(x)$，并使亲代其他（非目标）后代的适合度减少 $c(x)$。亲代通过最大化其广义适合度来确定其最优投入。\n\n从亲代的角度来看，收益的接受者是目标子代，而承担成本的个体是其其他后代。在一个二倍体、有性繁殖且无近亲繁殖的物种中，亲代与其任何一个后代的亲缘系数都是 $r_{\\mathrm{po}} = 1/2$。设 $r_{\\mathrm{pf}}$ 为亲代与目标子代的亲缘关系， $r_{\\mathrm{pn}}$ 为亲代与非目标后代的亲缘关系。我们有 $r_{\\mathrm{pf}} = r_{\\mathrm{pn}} = 1/2$。\n\n由于投入 $x$ 的边际变化，亲代广义适合度的变化由其对后代的加权边际效应之和给出：\n$$\n\\frac{d W_{\\mathrm{P}}}{dx} = r_{\\mathrm{pf}} \\frac{db}{dx} - r_{\\mathrm{pn}} \\frac{dc}{dx} = r_{\\mathrm{pf}} b'(x) - r_{\\mathrm{pn}} c'(x)\n$$\n为了找到亲代的最优投入 $x_{\\mathrm{P}}^{\\ast}$，我们将此导数设为零：\n$$\nr_{\\mathrm{pf}} b'(x_{\\mathrm{P}}^{\\ast}) - r_{\\mathrm{pn}} c'(x_{\\mathrm{P}}^{\\ast}) = 0\n$$\n$$\nr_{\\mathrm{pf}} b'(x_{\\mathrm{P}}^{\\ast}) = r_{\\mathrm{pn}} c'(x_{\\mathrm{P}}^{\\ast})\n$$\n由于 $r_{\\mathrm{pf}} = r_{\\mathrm{pn}} = 1/2$，这些项相互抵消，方程简化为：\n$$\nb'(x_{\\mathrm{P}}^{\\ast}) = c'(x_{\\mathrm{P}}^{\\ast})\n$$\n这符合 $b'(x_{\\mathrm{P}}^{\\ast}) = \\lambda\\, c'(x_{\\mathrm{P}}^{\\ast})$ 的形式。通过比较两者，我们将 $\\lambda$ 确定为亲缘系数的比值：\n$$\n\\lambda = \\frac{r_{\\mathrm{pn}}}{r_{\\mathrm{pf}}} = \\frac{1/2}{1/2} = 1\n$$\n条件 $\\lambda=1$ 反映了亲代与其所有后代的亲缘关系相等，因此它对一个后代单位收益的估值等同于对其其他后代单位成本的估值。$b(x)$ 是凹函数和 $c(x)$ 是凸函数的假设确保了满足最大值的二阶条件。\n\n第2部分：子代的最优投入\n现在，我们从目标子代的角度考虑同样的情况。目标子代基于其自身的广义适合度 $W_{\\mathrm{O}}$ 来评估这种权衡。\n投入 $x$ 直接为目标子代提供收益 $b(x)$。子代与自身的亲缘关系为 $r_{\\mathrm{oo}} = 1$。\n成本 $c(x)$ 由目标子代的兄弟姐妹承担。其中比例为 $q$ 的是半同胞（与目标的亲缘关系为 $r_{\\mathrm{ohs}} = 1/4$），比例为 $1-q$ 的是全同胞（与目标的亲缘关系为 $r_{\\mathrm{ofs}} = 1/2$）。\n目标子代与承担成本的兄弟姐妹群体中一个个体的平均亲缘关系为：\n$$\n\\bar{r}_{\\mathrm{os}} = q \\cdot r_{\\mathrm{ohs}} + (1-q) \\cdot r_{\\mathrm{ofs}} = q \\left(\\frac{1}{4}\\right) + (1-q) \\left(\\frac{1}{2}\\right) = \\frac{q + 2 - 2q}{4} = \\frac{2-q}{4}\n$$\n子代广义适合度的边际变化为：\n$$\n\\frac{d W_{\\mathrm{O}}}{dx} = r_{\\mathrm{oo}} \\frac{db}{dx} - \\bar{r}_{\\mathrm{os}} \\frac{dc}{dx} = r_{\\mathrm{oo}} b'(x) - \\bar{r}_{\\mathrm{os}} c'(x)\n$$\n将此导数设为零，以找到子代的最优需求 $x_{\\mathrm{O}}^{\\ast}$：\n$$\nr_{\\mathrm{oo}} b'(x_{\\mathrm{O}}^{\\ast}) - \\bar{r}_{\\mathrm{os}} c'(x_{\\mathrm{O}}^{\\ast}) = 0\n$$\n$$\nr_{\\mathrm{oo}} b'(x_{\\mathrm{O}}^{\\ast}) = \\bar{r}_{\\mathrm{os}} c'(x_{\\mathrm{O}}^{\\ast})\n$$\n$$\nb'(x_{\\mathrm{O}}^{\\ast}) = \\frac{\\bar{r}_{\\mathrm{os}}}{r_{\\mathrm{oo}}} c'(x_{\\mathrm{O}}^{\\ast})\n$$\n这与 $b'(x_{\\mathrm{O}}^{\\ast}) = \\mu\\, c'(x_{\\mathrm{O}}^{\\ast})$ 的形式相匹配，其中 $\\mu$ 是子代与承担成本的个体（其兄弟姐妹）的亲缘关系，与子代与接受收益的个体（其自身）的亲缘关系之比：\n$$\n\\mu = \\frac{\\bar{r}_{\\mathrm{os}}}{r_{\\mathrm{oo}}} = \\frac{(2-q)/4}{1} = \\frac{2-q}{4}\n$$\n为了解释为什么 $\\mu  \\lambda$，我们将 $\\mu = (2-q)/4$ 与 $\\lambda = 1$ 进行比较。变量 $q$ 是一个分数，所以 $q \\in [0,1]$。\n当 $q=0$ 时，$\\mu = 2/4 = 1/2$。当 $q=1$ 时，$\\mu = 1/4$。\n对于任何 $q \\in [0,1]$，$2-q$ 的值在 $1$ 和 $2$ 之间，因此 $\\mu = (2-q)/4$ 在 $1/4$ 和 $1/2$ 之间。\n因此，对于所有 $q \\in [0,1]$，我们有 $\\mu \\le 1/2$。由于 $\\lambda = 1$，所以 $\\mu  \\lambda$ 总是成立的。\n简要的解释是，冲突源于亲缘关系的不对称性。目标子代与自身的亲缘关系（$r_{\\mathrm{oo}}=1$）比与其兄弟姐妹的亲缘关系（$\\bar{r}_{\\mathrm{os}} \\le 1/2$）更近，因此它相对于自身的收益，会贬低对其兄弟姐妹的成本。而亲代与其所有后代的亲缘关系相等（$r_{\\mathrm{pf}}=r_{\\mathrm{pn}}=1/2$），从遗传学的角度看，它对收益和成本的估值是相等的。这种对成本估值的差异导致子代期望的投入水平高于亲代在演化上被选择提供的水平。\n\n第3部分：比率 $R$ 的计算\n我们给定具体的函数形式：$b(x) = \\alpha \\ln(1+x)$ 和 $c(x) = \\delta x^{2}$。其导数分别为 $b'(x) = \\frac{\\alpha}{1+x}$ 和 $c'(x) = 2 \\delta x$。\n\n对于亲代的最优值 $x_{\\mathrm{P}}^{\\ast}$，一阶条件是 $b'(x_{\\mathrm{P}}^{\\ast}) = c'(x_{\\mathrm{P}}^{\\ast})$：\n$$\n\\frac{\\alpha}{1+x_{\\mathrm{P}}^{\\ast}} = 2 \\delta x_{\\mathrm{P}}^{\\ast} \\implies \\alpha = 2\\delta x_{\\mathrm{P}}^{\\ast}(1+x_{\\mathrm{P}}^{\\ast}) \\implies (x_{\\mathrm{P}}^{\\ast})^2 + x_{\\mathrm{P}}^{\\ast} - \\frac{\\alpha}{2\\delta} = 0\n$$\n解此二次方程求 $x_{\\mathrm{P}}^{\\ast}$，并取正根（因为投入 $x \\ge 0$）：\n$$\nx_{\\mathrm{P}}^{\\ast} = \\frac{-1 + \\sqrt{1^2 - 4(1)(-\\frac{\\alpha}{2\\delta})}}{2} = \\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta}}}{2}\n$$\n对于子代的最优值 $x_{\\mathrm{O}}^{\\ast}$，一阶条件是 $b'(x_{\\mathrm{O}}^{\\ast}) = \\mu c'(x_{\\mathrm{O}}^{\\ast})$：\n$$\n\\frac{\\alpha}{1+x_{\\mathrm{O}}^{\\ast}} = \\mu (2 \\delta x_{\\mathrm{O}}^{\\ast}) \\implies \\alpha = 2\\delta\\mu x_{\\mathrm{O}}^{\\ast}(1+x_{\\mathrm{O}}^{\\ast}) \\implies (x_{\\mathrm{O}}^{\\ast})^2 + x_{\\mathrm{O}}^{\\ast} - \\frac{\\alpha}{2\\delta\\mu} = 0\n$$\n求解 $x_{\\mathrm{O}}^{\\ast}$：\n$$\nx_{\\mathrm{O}}^{\\ast} = \\frac{-1 + \\sqrt{1^2 - 4(1)(-\\frac{\\alpha}{2\\delta\\mu})}}{2} = \\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta\\mu}}}{2}\n$$\n比率 $R$ 是 $x_{\\mathrm{O}}^{\\ast} / x_{\\mathrm{P}}^{\\ast}$：\n$$\nR = \\frac{\\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta\\mu}}}{2}}{\\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta}}}{2}} = \\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta\\mu}}}{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta}}}\n$$\n最后，我们将 $\\mu = \\frac{2-q}{4}$ 代入 $R$ 的表达式：\n$$\nR = \\frac{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta\\left(\\frac{2-q}{4}\\right)}}}{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta}}} = \\frac{-1 + \\sqrt{1+\\frac{8\\alpha}{\\delta(2-q)}}}{-1 + \\sqrt{1+\\frac{2\\alpha}{\\delta}}}\n$$\n这就是比率 $R$ 关于 $\\alpha$、$\\delta$ 和 $q$ 的最终闭合形式表达式。", "answer": "$$\\boxed{\\frac{-1 + \\sqrt{1 + \\frac{8\\alpha}{\\delta(2-q)}}}{-1 + \\sqrt{1 + \\frac{2\\alpha}{\\delta}}}}$$", "id": "2740664"}, {"introduction": "亲子冲突的强度并非一成不变，而是会随着亲代的生命史阶段而动态变化。本练习引入了亲代年龄和剩余繁殖价值这两个关键变量，要求你分析当亲代年龄增长时，冲突的激烈程度会如何变化 [@problem_id:2740643]。通过这个模型，你将学会如何将静态的优化问题嵌入到更真实的生命史框架中。", "problem": "考虑在亲代年龄 $a \\ge 0$ 时的一次繁殖回合中的亲代-子代互动。亲代选择对目标子代的一个连续投入水平 $x \\ge 0$。设目标子代的直接适合度收益为一个凹的增函数 $B(x)$，而对亲代剩余繁殖价值的代价为一个增函数 $C(x)$。亲代在年龄 $a$ 时的剩余繁殖价值为 $R(a)$，定义为在基线条件下从年龄 $a$ 开始的期望未来繁殖产出。假设 $R(a)$ 关于 $a$ 是严格递减且可微的。亲缘系数如下：亲代与当前子代的亲缘度为 $r_{po} = 1/2$，目标子代与其未来全同胞的亲缘度为 $r_{s} \\in (0,1)$。\n\n假设函数形式和参数如下：\n- $B(x) = \\alpha x - \\frac{1}{2} q x^{2}$，其中 $\\alpha  0$ 且 $q  0$。\n- $C(x) = c x$，其中 $c  0$。\n- $R(a) = R_{0} \\exp(-\\lambda a)$，其中 $R_{0}  0$ 且 $\\lambda  0$。\n\n假设在所考虑的年龄范围内存在内部最优解，因此一阶条件可以确定两个决策者的唯一最大值。使用一个广义适合度框架，其中每个行为者都最大化其自身基因代表性的影响总和（按适当的亲缘系数加权），定义：\n- 亲代的目标函数为 $W_{p}(x,a) = r_{po} B(x) - R(a) C(x)$。\n- 子代的目标函数为 $W_{o}(x,a) = B(x) - r_{s} R(a) C(x)$。\n\n令 $x_{p}^{*}(a)$ 和 $x_{o}^{*}(a)$ 分别表示最大化 $W_{p}$ 和 $W_{o}$ 的投入水平。将冲突强度视为差值 $x_{o}^{*}(a) - x_{p}^{*}(a)$。\n\n从上述定义和标准优化条件出发，推导导数 $\\frac{\\partial}{\\partial a}\\big(x_{o}^{*}(a) - x_{p}^{*}(a)\\big)$ 的一个闭式表达式，该表达式用模型参数和 $a$ 表示。请将最终答案表示为单个解析表达式。不需要进行数值计算，也无需四舍五入。", "solution": "首先验证该问题，以确保其具有科学依据、适定且客观。问题陈述使用广义适合度框架来模拟亲子冲突，这是演化生物学中的一种标准方法。收益、代价和剩余繁殖价值的函数虽然具体，但代表了生活史理论中的常见假设（投入的边际效益递减、对未来繁殖的代价和衰老）。亲代和子代的目标函数被明确定义，并基于 Hamilton 法则，其中适合度效应按亲缘系数加权。该问题是自洽的、数学上精确的，并且不违反任何基本原理。因此，该问题被认为是有效的，并将推导求解。\n\n目标是求出冲突强度关于亲代年龄的导数，即 $\\frac{\\partial}{\\partial a}\\big(x_{o}^{*}(a) - x_{p}^{*}(a)\\big)$。\n\n首先，我们通过最大化亲代的广义适合度 $W_p(x, a)$ 来确定亲代的最优投入水平 $x_p^*(a)$。\n亲代的目标函数由下式给出：\n$$W_{p}(x,a) = r_{po} B(x) - R(a) C(x)$$\n代入给定的函数形式 $B(x) = \\alpha x - \\frac{1}{2} q x^{2}$、$C(x) = c x$、$r_{po} = \\frac{1}{2}$ 和 $R(a) = R_{0} \\exp(-\\lambda a)$：\n$$W_{p}(x,a) = \\frac{1}{2} \\left( \\alpha x - \\frac{1}{2} q x^{2} \\right) - c R(a) x$$\n为了找到最优投入 $x_{p}^{*}(a)$，我们根据最大值的一阶条件，求 $W_{p}$ 关于 $x$ 的一阶导数并将其设为零。问题陈述说明我们可以假设存在内部最优解。\n$$\\frac{\\partial W_{p}}{\\partial x} = \\frac{1}{2}(\\alpha - qx) - c R(a) = 0$$\n求解 $x$ 得到亲代的最优解 $x_{p}^{*}(a)$：\n$$\\alpha - q x_{p}^{*}(a) = 2c R(a)$$\n$$q x_{p}^{*}(a) = \\alpha - 2c R(a)$$\n$$x_{p}^{*}(a) = \\frac{\\alpha - 2c R(a)}{q}$$\n\n其次，我们通过最大化子代的广义适合度 $W_o(x, a)$ 来确定子代的最优投入水平 $x_o^*(a)$。\n子代的目标函数为：\n$$W_{o}(x,a) = B(x) - r_{s} R(a) C(x)$$\n代入函数形式：\n$$W_{o}(x,a) = \\left( \\alpha x - \\frac{1}{2} q x^{2} \\right) - r_{s} c R(a) x$$\n为了找到最优投入 $x_{o}^{*}(a)$，我们求 $W_{o}$ 关于 $x$ 的一阶导数并将其设为零：\n$$\\frac{\\partial W_{o}}{\\partial x} = (\\alpha - qx) - r_{s} c R(a) = 0$$\n求解 $x$ 得到子代的最优解 $x_{o}^{*}(a)$：\n$$\\alpha - q x_{o}^{*}(a) = r_{s} c R(a)$$\n$$q x_{o}^{*}(a) = \\alpha - r_{s} c R(a)$$\n$$x_{o}^{*}(a) = \\frac{\\alpha - r_{s} c R(a)}{q}$$\n\n第三，我们将冲突强度定义为子代和亲代的最优投入水平之差，即 $\\Delta x(a) = x_{o}^{*}(a) - x_{p}^{*}(a)$。\n$$\\Delta x(a) = \\left( \\frac{\\alpha - r_{s} c R(a)}{q} \\right) - \\left( \\frac{\\alpha - 2c R(a)}{q} \\right)$$\n$$\\Delta x(a) = \\frac{1}{q} \\big( (\\alpha - r_{s} c R(a)) - (\\alpha - 2c R(a)) \\big)$$\n$$\\Delta x(a) = \\frac{1}{q} \\big( -\\alpha + \\alpha - r_{s} c R(a) + 2c R(a) \\big)$$\n$$\\Delta x(a) = \\frac{c R(a)}{q} (2 - r_{s})$$\n\n最后，我们计算冲突强度 $\\Delta x(a)$ 关于亲代年龄 $a$ 的导数。\n$$\\frac{\\partial}{\\partial a} \\Delta x(a) = \\frac{\\partial}{\\partial a} \\left( \\frac{c (2 - r_{s})}{q} R(a) \\right)$$\n项 $\\frac{c (2 - r_{s})}{q}$ 相对于 $a$ 是常数。\n$$\\frac{\\partial}{\\partial a} \\Delta x(a) = \\frac{c (2 - r_{s})}{q} \\frac{\\partial R(a)}{\\partial a}$$\n我们已知 $R(a) = R_{0} \\exp(-\\lambda a)$。它关于 $a$ 的导数是：\n$$\\frac{\\partial R(a)}{\\partial a} = \\frac{\\partial}{\\partial a} \\left( R_{0} \\exp(-\\lambda a) \\right) = R_{0} (-\\lambda) \\exp(-\\lambda a) = -\\lambda R(a)$$\n将此导数代回到 $\\frac{\\partial}{\\partial a} \\Delta x(a)$ 的表达式中：\n$$\\frac{\\partial}{\\partial a} \\Delta x(a) = \\frac{c (2 - r_{s})}{q} (-\\lambda R(a))$$\n代入 $R(a)$ 的表达式，得到最终的闭式表达式：\n$$\\frac{\\partial}{\\partial a}\\big(x_{o}^{*}(a) - x_{p}^{*}(a)\\big) = -\\frac{\\lambda c (2 - r_{s})}{q} R_{0} \\exp(-\\lambda a)$$\n该表达式表示冲突强度的变化率，是亲代年龄 $a$ 的函数，并按要求用模型参数表示。", "answer": "$$ \\boxed{-\\frac{\\lambda c (2 - r_{s})}{q} R_{0} \\exp(-\\lambda a)} $$", "id": "2740643"}, {"introduction": "亲代与子代之间的冲突往往会引发一场持续的协同进化“军备竞赛”。本练习将带你从静态的策略分析转向动态的协同进化过程，你需要运用数量遗传学的兰德方程来模拟亲代抗性和子代需求这两个性状的共同演化轨迹 [@problem_id:2740632]。这个综合性的练习不仅需要你进行解析推导，还需要你通过编程来解决问题，从而掌握模拟进化动态的核心技能。", "problem": "您需要形式化并分析一个亲代-子代冲突模型，并将其对应的协同进化动力学实现为一个可运行的程序。您的目标有两个：第一，从第一性原理推导出，为何子代需求给亲代带来的成本增加，会选择出更高的亲代抵抗阈值；第二，在数量遗传学（QG）框架下，使用亲代和子代性状的加性遗传方差，计算所产生的协同进化轨迹。\n\n请使用以下与情景相符的基础：\n- 广义适合度（IF）：亲代的适合度包括对其子代的益处，并按遗传相关度加权。\n- 数量遗传学中的Lande方程：对于具有加性遗传方差的性状，其平均值的代际变化等于加性遗传方差与在当前平均表型处评估的方向性选择梯度的乘积。具体而言，对于平均性状值 $z$，其动力学遵循 $\\Delta z = G \\, \\beta$，其中 $G$ 是加性遗传方差，$\\beta$ 是方向性选择梯度。\n\n模型假设与定义：\n- 设子代表达一个连续的需求性状 $o \\in \\mathbb{R}$，亲代表达一个连续的抵抗阈值 $p \\in \\mathbb{R}$。\n- 实现的资源转移是一个平滑函数 $x(o,p) = \\sigma(o - p)$，其中 $\\sigma(a)$ 是逻辑斯谛函数 $\\sigma(a) = \\dfrac{1}{1 + e^{-a}}$。因此 $x \\in (0,1)$ 且 $\\dfrac{\\partial x}{\\partial a} = \\sigma(a)\\bigl(1-\\sigma(a)\\bigr) = x(1-x)$。\n- 子代从资源 $x$ 中获得的收益具有递减效应，由 $B(x) = b \\ln(1 + x)$ 给出，其中 $b  0$。因此 $B'(x) = \\dfrac{b}{1 + x}$。\n- 亲代的单位资源成本为 $k  0$。亲代的广义适合度为\n  $$W_p(p,o) = r \\, B(x) - k \\, x - \\frac{c_p}{2} \\, p^2,$$\n  其中 $r \\in (0,1]$ 是遗传相关度，$c_p  0$ 是对抵抗的稳定性成本。\n- 子代的适合度为\n  $$W_o(p,o) = B(x) - \\frac{c_o}{2} \\, o^2,$$\n  其中 $c_o  0$ 是对需求的稳定性成本。\n- 种群数量大，选择作用弱，并且Lande方程适用于亲代平均性状 $p$ 和子代平均性状 $o$，其加性遗传方差分别为 $G_p \\ge 0$ 和 $G_o \\ge 0$。具体来说，\n  $$\\Delta p = G_p \\, \\beta_p, \\quad \\Delta o = G_o \\, \\beta_o,$$\n  其中 $\\beta_p = \\left.\\dfrac{\\partial W_p}{\\partial p}\\right\\vert_{(p,o)}$ 和 $\\beta_o = \\left.\\dfrac{\\partial W_o}{\\partial o}\\right\\vert_{(p,o)}$ 是在当前平均性状下评估的选择梯度。\n\n任务：\n1. 使用以上定义，推导选择梯度 $\\beta_p$ 和 $\\beta_o$ 的解析表达式。利用这些表达式，用符号项证明，在固定的状态 $(p,o)$ 下，增加 $k$（即增加子代需求对亲代的成本）会增加偏好 $p$ 增大的方向性选择梯度，从而选择更高的亲代抵抗阈值。\n2. 实现离散时间的协同进化动力学\n   $$p_{t+1} = p_t + G_p \\, \\beta_p(p_t,o_t), \\quad o_{t+1} = o_t + G_o \\, \\beta_o(p_t,o_t),$$\n   并进行迭代，直到达到最大代数或步长 $\\sqrt{(\\Delta p)^2 + (\\Delta o)^2}$ 降至容差以下。对逻辑斯谛函数的大数值参数使用数值稳定的求值方法。不要假设对称性；使用您推导出的精确梯度。\n\n测试套件：\n对以下五个参数集运行您的程序。每个测试案例是一个元组 $(b, r, k, c_p, c_o, G_p, G_o, p_0, o_0, T_{\\max}, \\varepsilon)$，其中 $T_{\\max}$ 是最大代数，$\\varepsilon$ 是收敛容差。\n- 案例 A（基线）：$(1.0, 0.5, 0.6, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0 \\times 10^{-12})$。\n- 案例 B（亲代成本增加）：$(1.0, 0.5, 1.2, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0 \\times 10^{-12})$。\n- 案例 C（亲代成本较低）：$(1.0, 0.5, 0.1, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0 \\times 10^{-12})$。\n- 案例 D（子代进化受限）：$(1.0, 0.5, 0.6, 0.05, 0.05, 0.02, 0.0, 0.5, 0.5, 200000, 1.0 \\times 10^{-12})$。\n- 案例 E（信号成本高）：$(1.0, 0.5, 0.6, 0.05, 0.5, 0.02, 0.02, 0.5, 0.5, 200000, 1.0 \\times 10^{-12})$。\n\n最终输出格式：\n- 对于每个测试案例，返回通过迭代直到满足停止条件所获得的稳态均值 $(p^{\\ast}, o^{\\ast})$。如果达到最大代数仍未满足容差，则返回最后的迭代值作为数值近似解。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，按测试案例的顺序平铺排列为 $[p^{\\ast}_A, o^{\\ast}_A, p^{\\ast}_B, o^{\\ast}_B, p^{\\ast}_C, o^{\\ast}_C, p^{\\ast}_D, o^{\\ast}_D, p^{\\ast}_E, o^{\\ast}_E]$。\n- 将每个数字表示为小数，并四舍五入到小数点后恰好 $6$ 位。\n- 不涉及物理单位或角度；仅按上述规定报告纯十进制数。", "solution": "问题陈述已经过验证。\n\n**第1步：提取已知条件**\n- 子代需求性状：$o \\in \\mathbb{R}$。\n- 亲代抵抗阈值：$p \\in \\mathbb{R}$。\n- 资源转移函数：$x(o,p) = \\sigma(o - p)$，其中 $\\sigma(a) = \\dfrac{1}{1 + e^{-a}}$。\n- 逻辑斯谛函数的导数：$\\dfrac{d\\sigma}{da} = \\sigma(a)\\bigl(1-\\sigma(a)\\bigr) = x(1-x)$。\n- 子代收益函数：$B(x) = b \\ln(1 + x)$，其中 $b  0$。\n- 收益函数的导数：$B'(x) = \\dfrac{b}{1 + x}$。\n- 亲代的广义适合度：$W_p(p,o) = r \\, B(x) - k \\, x - \\frac{c_p}{2} \\, p^2$，其中遗传相关度 $r \\in (0,1]$，资源成本 $k  0$，抵抗成本 $c_p  0$。\n- 子代的适合度：$W_o(p,o) = B(x) - \\frac{c_o}{2} \\, o^2$，其中需求成本 $c_o  0$。\n- 进化动力学（Lande方程）：$\\Delta p = G_p \\, \\beta_p$ 和 $\\Delta o = G_o \\, \\beta_o$，其中 $\\beta_p = \\left.\\dfrac{\\partial W_p}{\\partial p}\\right\\vert_{(p,o)}$，$\\beta_o = \\left.\\dfrac{\\partial W_o}{\\partial o}\\right\\vert_{(p,o)}$，$G_p, G_o \\ge 0$ 是加性遗传方差。\n- 模拟用的离散时间动力学：$p_{t+1} = p_t + G_p \\, \\beta_p(p_t,o_t)$ 和 $o_{t+1} = o_t + G_o \\, \\beta_o(p_t,o_t)$。\n- 模拟参数：初始条件 $(p_0, o_0)$，最大代数 $T_{\\max}$，以及收敛容差 $\\varepsilon$。\n- 提供了五个具有特定参数值的测试案例。\n\n**第2步：使用提取的已知条件进行验证**\n根据验证标准对问题进行评估。\n- **科学基础**：该问题构建于进化生物学的基础理论之上，即亲代-子代冲突理论、广义适合度和数量遗传学。用于成本和收益的数学函数是理论生物学中的标准形式。该模型是合理的。\n- **问题明确**：问题定义清晰。它要求推导指定函数的梯度，并模拟一个明确定义的动力学系统。二次稳定性成本的存在表明动力学将收敛到一个稳定平衡点，确保存在有意义的解。\n- **客观性**：问题陈述精确、量化，没有主观或含糊的语言。所有术语都已正式定义。\n- **不完整或矛盾的设置**：问题是自洽的。数值任务所需的所有必要参数、方程、初始条件和终止标准都已提供。没有矛盾之处。\n\n**第3步：结论与行动**\n此问题有效。将提供解答。\n\n**第1部分：解析推导**\n\n首先，我们推导选择梯度 $\\beta_p$ 和 $\\beta_o$ 的表达式。我们应用链式法则进行微分。设 $a = o - p$。资源转移为 $x = \\sigma(a)$。\n\n$x$ 对 $p$ 和 $o$ 的偏导数是：\n$$\n\\frac{\\partial x}{\\partial p} = \\frac{d\\sigma}{da} \\frac{\\partial a}{\\partial p} = \\sigma'(a) \\cdot (-1) = -x(1-x)\n$$\n$$\n\\frac{\\partial x}{\\partial o} = \\frac{d\\sigma}{da} \\frac{\\partial a}{\\partial o} = \\sigma'(a) \\cdot (1) = x(1-x)\n$$\n\n亲代性状上的选择梯度 $\\beta_p$ 是亲代广义适合度 $W_p$ 对其自身性状 $p$ 的偏导数：\n$$\n\\beta_p = \\frac{\\partial W_p}{\\partial p} = \\frac{\\partial}{\\partial p} \\left( r \\, B(x) - k \\, x - \\frac{c_p}{2} \\, p^2 \\right)\n$$\n$$\n\\beta_p = r \\, \\frac{dB}{dx} \\frac{\\partial x}{\\partial p} - k \\, \\frac{\\partial x}{\\partial p} - c_p \\, p = \\left( r \\, B'(x) - k \\right) \\frac{\\partial x}{\\partial p} - c_p \\, p\n$$\n代入 $B'(x) = \\dfrac{b}{1+x}$ 和 $\\dfrac{\\partial x}{\\partial p} = -x(1-x)$:\n$$\n\\beta_p = \\left( r \\frac{b}{1+x} - k \\right) (-x(1-x)) - c_p \\, p\n$$\n$$\n\\beta_p = \\left( k - r \\frac{b}{1+x} \\right) x(1-x) - c_p \\, p\n$$\n\n子代性状上的选择梯度 $\\beta_o$ 是子代适合度 $W_o$ 对其自身性状 $o$ 的偏导数：\n$$\n\\beta_o = \\frac{\\partial W_o}{\\partial o} = \\frac{\\partial}{\\partial o} \\left( B(x) - \\frac{c_o}{2} \\, o^2 \\right)\n$$\n$$\n\\beta_o = \\frac{dB}{dx} \\frac{\\partial x}{\\partial o} - c_o \\, o = B'(x) \\frac{\\partial x}{\\partial o} - c_o \\, o\n$$\n代入 $B'(x) = \\dfrac{b}{1+x}$ 和 $\\dfrac{\\partial x}{\\partial o} = x(1-x)$:\n$$\n\\beta_o = \\left( \\frac{b}{1+x} \\right) x(1-x) - c_o \\, o\n$$\n\n接下来，我们证明资源转移成本 $k$ 的增加会选择更高的親代抵抗 $p$。这需要评估在保持 $(p,o)$ 恒定时，$\\beta_p$ 对 $k$ 的偏导数的符号。\n$$\n\\frac{\\partial \\beta_p}{\\partial k} = \\frac{\\partial}{\\partial k} \\left[ \\left( k - r \\frac{b}{1+x} \\right) x(1-x) - c_p \\, p \\right]\n$$\n由于 $p$ 和 $o$ 保持恒定，$x = \\sigma(o-p)$ 也为常数。导数简化为：\n$$\n\\frac{\\partial \\beta_p}{\\partial k} = x(1-x)\n$$\n资源转移 $x$ 由逻辑斯谛函数 $x = \\sigma(o-p)$ 给出，其值域为 $(0,1)$。因此，对于任何有限的 $o$ 和 $p$ 值，我们都有 $0  x  1$。这意味着 $x$ 和 $(1-x)$ 均为正数。因此，它们的乘积严格为正：\n$$\n\\frac{\\partial \\beta_p}{\\partial k} = x(1-x)  0\n$$\n一个正的导数 $\\frac{\\partial \\beta_p}{\\partial k}$ 表明增加 $k$ 会使选择梯度 $\\beta_p$ 更正（或更小负）。这对应于对亲代抵抗性状 $p$ 增加的更强的方向性选择。这证实了假设：当为子代提供资源对亲代而言成本更高时，选择会偏好那些对子代需求抵抗更强的亲代。\n\n**第2部分：协同进化动力学实现**\n\n种群平均性状 $(\\bar{p}, \\bar{o})$ 的协同进化轨迹由基于Lande方程的离散时间方程组建模：\n$$\np_{t+1} = p_t + G_p \\, \\beta_p(p_t,o_t)\n$$\n$$\no_{t+1} = o_t + G_o \\, \\beta_o(p_t,o_t)\n$$\n其中 $\\beta_p$ 和 $\\beta_o$ 是上面推导出的梯度，在当前平均性状 $(p_t, o_t)$ 处进行评估。\n\n数值实现遵循一个迭代算法：\n1. 将性状初始化为其起始值，$p \\leftarrow p_0$ 和 $o \\leftarrow o_0$。\n2. 对于从 $0$ 到 $T_{\\max}-1$ 的每一代 $t$：\n   a. 计算资源转移 $x_t = \\sigma(o_t - p_t)$。使用数值稳定的逻辑斯谛函数实现，以防止大参数值引起的上溢或下溢问题。\n   b. 使用推导出的解析表达式计算选择梯度 $\\beta_p(p_t, o_t)$ 和 $\\beta_o(p_t, o_t)$。\n   c. 计算下一代性状的变化量：$\\Delta p = G_p \\beta_p$ 和 $\\Delta o = G_o \\beta_o$。\n   d. 评估停止条件。如果变化的大小 $\\sqrt{(\\Delta p)^2 + (\\Delta o)^2}$ 小于容差 $\\varepsilon$，则系统已收敛到稳态，迭代终止。\n   e. 更新性状：$p_{t+1} = p_t + \\Delta p$ 和 $o_{t+1} = o_t + \\Delta o$。\n3. 最终的 $(p,o)$ 值作为进化均衡点 $(p^*, o^*)$ 的数值近似值被报告。如果循环因达到 $T_{\\max}$ 而完成，则返回最后的迭代值。\n\n提供的Python代码实现了该算法，用于为五个指定的测试案例求解均衡性状。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import expit\n\ndef solve():\n    \"\"\"\n    Formalizes and simulates a parent-offspring conflict model based on quantitative genetics.\n    \"\"\"\n    # Each test case is a tuple:\n    # (b, r, k, c_p, c_o, G_p, G_o, p_0, o_0, T_max, epsilon)\n    test_cases = [\n        # Case A (baseline)\n        (1.0, 0.5, 0.6, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0e-12),\n        # Case B (escalated cost to parent)\n        (1.0, 0.5, 1.2, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0e-12),\n        # Case C (low cost to parent)\n        (1.0, 0.5, 0.1, 0.05, 0.05, 0.02, 0.02, 0.5, 0.5, 200000, 1.0e-12),\n        # Case D (offspring evolution constrained)\n        (1.0, 0.5, 0.6, 0.05, 0.05, 0.02, 0.0, 0.5, 0.5, 200000, 1.0e-12),\n        # Case E (high signaling cost)\n        (1.0, 0.5, 0.6, 0.05, 0.5, 0.02, 0.02, 0.5, 0.5, 200000, 1.0e-12),\n    ]\n\n    results = []\n    for params in test_cases:\n        b, r, k, c_p, c_o, G_p, G_o, p0, o0, T_max, epsilon = params\n        \n        p = float(p0)\n        o = float(o0)\n\n        for _ in range(T_max):\n            # Calculate resource transfer x = sigma(o - p)\n            # Use scipy.special.expit for numerical stability\n            x = expit(o - p)\n\n            # The term x*(1-x) is the derivative of sigma with respect to its argument\n            dx_da = x * (1.0 - x)\n            \n            # Calculate selection gradients using derived expressions\n            # beta_p = (k - r * b / (1+x)) * x(1-x) - c_p * p\n            beta_p = (k - r * b / (1.0 + x)) * dx_da - c_p * p\n            \n            # beta_o = (b / (1+x)) * x(1-x) - c_o * o\n            beta_o = (b / (1.0 + x)) * dx_da - c_o * o\n            \n            # Calculate changes in traits based on the Lande equation\n            delta_p = G_p * beta_p\n            delta_o = G_o * beta_o\n            \n            # Check for convergence\n            step_size = np.sqrt(delta_p**2 + delta_o**2)\n            if step_size  epsilon:\n                break\n            \n            # Update traits for the next generation\n            p += delta_p\n            o += delta_o\n\n        results.extend([p, o])\n\n    # Format output to 6 decimal places as specified\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    \n    # Final print statement in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2740632"}]}