{"hands_on_practices": [{"introduction": "这项练习将指导你完成杂交区分析中的一项基本任务：从遗传数据中估计个体的杂交指数（$h$）。你将使用最大似然框架——现代统计遗传学的基石——来推导 $h$ 的估计量。至关重要的是，该模型明确考虑了基因分型错误（$\\epsilon$），这是现实世界基因组数据中常见的噪声来源，从而教会你如何构建更稳健的统计模型。[@problem_id:2717930]", "problem": "考虑从两个亲本物种的杂交区中抽样得到的单个二倍体个体。这两个亲本物种在一组祖源信息标记（AIMs）上对不同的等位基因是固定的。在每个AIM上，记为 $A$ 的等位基因在亲本物种1中是固定的，而在亲本物种2中不存在。该个体的杂交指数 $h$ 定义为从基因组中随机抽取一个等位基因拷贝来自亲本物种1的全基因组概率，其中 $h \\in [0,1]$。假设个体的祖源比例符合哈迪-温伯格平衡，各位点之间相互独立，且存在一个对称的、按等位基因计的基因分型错误率 $\\epsilon \\in [0,0.5)$，使得任何一个等位基因拷贝被错误地鉴定为另一个等位基因的概率为 $\\epsilon$，且在不同等位基因拷贝和位点之间是独立的。\n\n您对该个体的 $L$ 个独立的AIM进行基因分型，并记录了在位点 $i$ 上等位基因 $A$ 的剂量 $D_i \\in \\{0,1,2\\}$，其中 $i=1,\\dots,L$。令 $n_2$ 为 $D_i=2$ 的位点数，$n_1$ 为 $D_i=1$ 的位点数，$n_0$ 为 $D_i=0$ 的位点数，因此 $L = n_0 + n_1 + n_2$。\n\n仅使用基本定义（包括哈迪-温伯格平衡下的二项抽样、等位基因拷贝的独立性以及最大似然的定义），通过对未观察到的真实基因型进行适当的边缘化，推导出观察到的剂量关于 $h$ 和 $\\epsilon$ 的似然函数。然后，以 $n_0$、$n_1$、$n_2$ 和 $\\epsilon$ 的函数形式，求得最大似然估计（MLE）$\\hat{h}$ 的封闭解。\n\n对于以下数据，数值计算您的封闭解表达式：$n_2 = 58$，$n_1 = 34$，$n_0 = 28$，以及 $\\epsilon = 0.03$。将您的最终数值答案四舍五入到四位有效数字。您的最终答案必须是一个数字。", "solution": "问题陈述经评估有效。它在群体遗传学和统计理论方面有科学依据，是客观、适定的，并包含推导唯一解所需的所有必要信息。因此，我们可以开始推导。\n\n目标是求出杂交指数 $h$ 的最大似然估计（MLE）。杂交指数 $h$ 表示在一个二倍体个体中随机抽取一个等位基因拷贝来自亲本物种1的概率。等位基因 $A$ 在物种1中是固定的，而另一个等位基因（我们记为 $a$）在物种2中是固定的。\n\n首先，我们确定在任何给定的祖源信息标记（AIM）位点上，三种可能的真实、未观察到的基因型的概率。设 $G$ 为真实基因型，可以是 $AA$、$Aa$ 或 $aa$。在祖源比例符合哈迪-温伯格平衡的假设下，二倍体个体中的两个等位基因拷贝是独立抽取的。从物种1抽取一个等位基因（等位基因 $A$）的概率是 $h$，从物种2（等位基因 $a$）抽取一个的概率是 $1-h$。\n因此，真实基因型的概率为：\n$P(G=AA) = h \\times h = h^2$\n$P(G=Aa) = h(1-h) + (1-h)h = 2h(1-h)$\n$P(G=aa) = (1-h) \\times (1-h) = (1-h)^2$\n\n接下来，我们对基因分型错误进行建模。观察到的等位基因 $A$ 的剂量记为 $D \\in \\{0, 1, 2\\}$。一个对称的、按等位基因计的错误率 $\\epsilon$ 意味着一个真实的 $A$ 被错误地鉴定为 $a$ 的概率为 $\\epsilon$，一个真实的 $a$ 被错误地鉴定为 $A$ 的概率也为 $\\epsilon$。任何一个等位基因被正确鉴定的概率是 $1-\\epsilon$。在一个位点上，两个等位基因拷贝之间的错误是独立的。我们现在推导在给定真实基因型 $G$ 的条件下，观察到剂量 $D$ 的条件概率。\n\n如果真实基因型是 $AA$（2个 $A$ 拷贝）：\n$P(D=2 | G=AA) = (1-\\epsilon)(1-\\epsilon) = (1-\\epsilon)^2$ (两个 $A$ 都被正确鉴定)\n$P(D=1 | G=AA) = \\binom{2}{1}(1-\\epsilon)\\epsilon = 2\\epsilon(1-\\epsilon)$ (一个 $A$ 正确，一个被错误鉴定)\n$P(D=0 | G=AA) = \\epsilon \\epsilon = \\epsilon^2$ (两个 $A$ 都被错误鉴定)\n\n如果真实基因型是 $Aa$（1个 $A$ 拷贝，1个 $a$ 拷贝）：\n$P(D=2 | G=Aa) = (1-\\epsilon)\\epsilon$ ($A$ 正确, $a$ 被错误鉴定为 $A$)\n$P(D=1 | G=Aa) = (1-\\epsilon)(1-\\epsilon) + \\epsilon\\epsilon = (1-\\epsilon)^2 + \\epsilon^2$ ($A$ 正确, $a$ 正确 或 $A$ 错误鉴定, $a$ 错误鉴定)\n$P(D=0 | G=Aa) = \\epsilon(1-\\epsilon)$ ($A$ 被错误鉴定为 $a$, $a$ 正确)\n\n如果真实基因型是 $aa$（0个 $A$ 拷贝）：\n$P(D=2 | G=aa) = \\epsilon\\epsilon = \\epsilon^2$ (两个 $a$ 都被错误鉴定为 $A$)\n$P(D=1 | G=aa) = \\binom{2}{1}\\epsilon(1-\\epsilon) = 2\\epsilon(1-\\epsilon)$ (一个 $a$ 错误鉴定，一个正确)\n$P(D=0 | G=aa) = (1-\\epsilon)(1-\\epsilon) = (1-\\epsilon)^2$ (两个 $a$ 都被正确鉴定)\n\n下一步是求出观察到每种剂量的边际概率，$p_k = P(D=k)$，其中 $k \\in \\{0, 1, 2\\}$。这通过使用全概率公式对未观察到的真实基因型求和来完成：$p_k = \\sum_{G} P(D=k | G) P(G)$。\n\n$p_2 = P(D=2) = P(D=2|G=AA)P(G=AA) + P(D=2|G=Aa)P(G=Aa) + P(D=2|G=aa)P(G=aa)$\n$p_2 = (1-\\epsilon)^2 h^2 + \\epsilon(1-\\epsilon) [2h(1-h)] + \\epsilon^2 (1-h)^2$\n这个表达式可以看作是一个平方项的展开。让我们定义一个“观察到的”等位基因频率 $h_{obs}$，即随机抽样的一个等位基因拷贝被观察为 $A$ 的概率。一个等位基因被观察为 $A$，有两种情况：它本是 $A$ 且被正确分型，或者它本是 $a$ 但被错误分型。\n$h_{obs} = h(1-\\epsilon) + (1-h)\\epsilon = h - h\\epsilon + \\epsilon - h\\epsilon = h(1-2\\epsilon) + \\epsilon$。\n观察到等位基因为 $a$ 的概率是 $1-h_{obs}$。\n$1-h_{obs} = 1 - (h(1-2\\epsilon) + \\epsilon) = h\\epsilon + (1-h)(1-\\epsilon)$。\n由于等位基因拷贝之间的错误是独立的，观察到的基因型相对于观察到的等位基因频率 $h_{obs}$ 遵循哈迪-温伯格平衡。因此，边际概率为：\n$p_2 = h_{obs}^2 = (h(1-2\\epsilon) + \\epsilon)^2$\n$p_1 = 2h_{obs}(1-h_{obs}) = 2(h(1-2\\epsilon) + \\epsilon)(1 - (h(1-2\\epsilon) + \\epsilon))$\n$p_0 = (1-h_{obs})^2 = (1 - (h(1-2\\epsilon) + \\epsilon))^2$\n\n数据由 $L = n_0+n_1+n_2$ 个独立位点的计数 $(n_0, n_1, n_2)$ 组成。这些数据的似然由多项概率质量函数给出：\n$L(h | n_0, n_1, n_2, \\epsilon) = \\frac{L!}{n_0! n_1! n_2!} p_0^{n_0} p_1^{n_1} p_2^{n_2}$\n为了找到MLE，我们相对于 $h$ 最大化此函数。最大化对数似然 $\\ln L$ 是等价且更简单的。我们可以忽略常数项多项式系数。\n$\\ln L \\propto n_0 \\ln(p_0) + n_1 \\ln(p_1) + n_2 \\ln(p_2)$\n用 $h_{obs}$ 的表达式代入：\n$\\ln L \\propto n_0 \\ln((1-h_{obs})^2) + n_1 \\ln(2h_{obs}(1-h_{obs})) + n_2 \\ln(h_{obs}^2)$\n$\\ln L \\propto 2n_0 \\ln(1-h_{obs}) + n_1(\\ln 2 + \\ln h_{obs} + \\ln(1-h_{obs})) + 2n_2 \\ln h_{obs}$\n$\\ln L \\propto (2n_0 + n_1)\\ln(1-h_{obs}) + (n_1 + 2n_2)\\ln h_{obs} + \\text{常数}$\n\n为了求最大值，我们将 $\\ln L$ 对 $h$ 求导，并令导数为零。使用链式法则，$\\frac{d(\\ln L)}{dh} = \\frac{d(\\ln L)}{dh_{obs}} \\frac{dh_{obs}}{dh}$。\n$\\frac{dh_{obs}}{dh} = \\frac{d}{dh}(h(1-2\\epsilon) + \\epsilon) = 1-2\\epsilon$。因为 $\\epsilon \\in [0, 0.5)$，所以 $1-2\\epsilon \\neq 0$。\n$\\frac{d(\\ln L)}{dh_{obs}} = \\frac{-(2n_0 + n_1)}{1-h_{obs}} + \\frac{n_1 + 2n_2}{h_{obs}}$\n令导数为零：\n$\\frac{n_1 + 2n_2}{h_{obs}} = \\frac{2n_0 + n_1}{1-h_{obs}}$\n$(n_1 + 2n_2)(1-h_{obs}) = (2n_0 + n_1)h_{obs}$\n$n_1 + 2n_2 - (n_1 + 2n_2)h_{obs} = (2n_0 + n_1)h_{obs}$\n$n_1 + 2n_2 = h_{obs}(2n_0 + n_1 + n_1 + 2n_2) = h_{obs}(2n_0 + 2n_1 + 2n_2)$\n$n_1 + 2n_2 = 2h_{obs}(n_0 + n_1 + n_2) = 2h_{obs}L$\n观察到的等位基因频率的MLE，$\\hat{h}_{obs}$，为：\n$\\hat{h}_{obs} = \\frac{n_1 + 2n_2}{2L}$\n这是从观察到的基因型计数中估计等位基因频率的标准基因计数法。\n\n根据最大似然估计的不变性，通过使用 $\\hat{h}_{obs}$ 求解关于 $h$ 的方程，可以找到 $h$ 的MLE，记为 $\\hat{h}$：\n$\\hat{h}_{obs} = \\hat{h}(1-2\\epsilon) + \\epsilon$\n$\\hat{h}_{obs} - \\epsilon = \\hat{h}(1-2\\epsilon)$\n$\\hat{h} = \\frac{\\hat{h}_{obs} - \\epsilon}{1-2\\epsilon}$\n代入 $\\hat{h}_{obs}$ 的表达式，我们得到 $h$ 的封闭解MLE：\n$\\hat{h} = \\frac{\\frac{n_1 + 2n_2}{2(n_0+n_1+n_2)} - \\epsilon}{1-2\\epsilon}$\n\n现在我们用给定的数据来计算这个表达式：$n_2 = 58$，$n_1 = 34$，$n_0 = 28$，以及 $\\epsilon = 0.03$。\n首先，计算位点总数 $L$：\n$L = n_0 + n_1 + n_2 = 28 + 34 + 58 = 120$\n接下来，计算观察到的等位基因频率的MLE，$\\hat{h}_{obs}$：\n$\\hat{h}_{obs} = \\frac{n_1 + 2n_2}{2L} = \\frac{34 + 2(58)}{2(120)} = \\frac{34 + 116}{240} = \\frac{150}{240} = \\frac{5}{8} = 0.625$\n最后，计算 $\\hat{h}$：\n$\\hat{h} = \\frac{\\hat{h}_{obs} - \\epsilon}{1-2\\epsilon} = \\frac{0.625 - 0.03}{1 - 2(0.03)} = \\frac{0.595}{1 - 0.06} = \\frac{0.595}{0.94}$\n$\\hat{h} \\approx 0.6329787...$\n将结果四舍五入到四位有效数字，得到 $0.6330$。", "answer": "$$\n\\boxed{0.6330}\n$$", "id": "2717930"}, {"introduction": "本实践深入探讨了张力带（tension zones）的经典理论，这种区域的维持依赖于扩散与针对杂交个体选择之间的平衡。通过求解一个反应-扩散方程，你将推导出基因频率梯度标志性的S形曲线，并揭示其宽度（$w$）、扩散方差（$\\sigma^2$）和选择强度（$s$）之间的基本关系。这项练习有力地说明了我们如何从空间遗传模式中推断进化过程。[@problem_id:2717953]", "problem": "两个物种之间的一个一维杂交带跨越一个线性样带，其中相邻种群单元之间的扩散可以很好地用高斯运动来近似，其每代方差为 $\\sigma^{2}$ (单位: $\\text{km}^{2}\\,\\text{generation}^{-1}$)。在一个具有等位基因 $A$ 和 $a$ 的单基因座上，假设存在对称的杂合子劣势：基因型适应度为 $w_{AA}=1$, $w_{Aa}=1-s$ 和 $w_{aa}=1$，其中 $s \\in (0,1)$ 是针对杂合子的选择系数。假设随机交配、无遗传漂变且种群规模较大。\n\n设 $p(x,t)$ 表示在位置 $x$ 和时间 $t$ 时等位基因 $A$ 的频率。使用扩散的标准扩散近似和连续时间选择，等位基因频率的动态可以通过以下形式的反应扩散方程来建模：\n$$\n\\frac{\\partial p}{\\partial t} \\;=\\; \\frac{\\sigma^{2}}{2}\\,\\frac{\\partial^{2}p}{\\partial x^{2}} \\;+\\; p(1-p)\\,\\Delta m(p),\n$$\n其中 $\\Delta m(p)$ 是等位基因 $A$ 和 $a$ 之间的马尔萨斯适应度差异，表示为在假设的基因型适应度下 $p$ 的函数。在平衡状态下，会建立一个连接 $p(-\\infty)=0$ 和 $p(+\\infty)=1$ 的静态基因频率梯度 $p(x)$。\n\n从这些假设和定义出发，并且不引用任何预先给定的梯度宽度公式，完成以下任务：\n\n1. 推导静态梯度 $p(x)$ 所满足的常微分方程，并求解该方程以获得 $p(x)$ 的显式 S 型函数形式。\n2. 将梯度宽度 $w$ 定义为 $w := 1/\\left|p'(0)\\right|$，即在梯度中心 $x=0$（其中 $p(0)=\\tfrac{1}{2}$）处最大斜率的倒数。用 $\\sigma^{2}$ 和 $s$ 表示 $w$，然后重新整理以获得 $s$ 作为 $w$ 和 $\\sigma^{2}$ 的函数。\n3. 一项经验研究测量出梯度宽度 $w = 24\\,\\text{km}$ 和扩散方差 $\\sigma^{2} = 3\\,\\text{km}^{2}\\,\\text{generation}^{-1}$。使用你的表达式，计算隐含的选择系数 $s$。将答案四舍五入到四位有效数字，并以无单位的纯数形式表示。\n4. 简要列举在此背景下，为了使您推导的估计量有效，所需的关键生物学和建模假设。\n\n最终答案只需报告 $s$ 的数值，并按要求四舍五入。上文提到的所有单位仅供解释；最终报告的 $s$ 应为无单位数。", "solution": "问题陈述具有科学依据，提法恰当，并包含获得唯一解所需的所有信息。它代表了数理演化生物学中一个标准且基本的问题。因此，该问题被认为是有效的。\n\n任务是分析一个在对称杂合子劣势条件下，描述一维杂交带中等位基因频率的反应扩散模型。我们需要推导静态梯度剖面、梯度宽度的表达式，并用它从经验数据中估计选择系数，最后列出其基本假设。\n\n首先，我们确定所提供的反应扩散方程中的选择项：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{\\sigma^{2}}{2}\\,\\frac{\\partial^{2}p}{\\partial x^{2}} + p(1-p)\\,\\Delta m(p)\n$$\n此处，$p$ 是等位基因 $A$ 的频率，$\\sigma^{2}$ 是扩散方差，$\\Delta m(p)$ 是等位基因 $A$ 和 $a$ 之间的马尔萨斯适应度差异。赖特适应度给定为 $w_{AA}=1$, $w_{Aa}=1-s$ 和 $w_{aa}=1$。马尔萨斯适应度 $m$ 是这些值的自然对数，即 $m = \\ln(w)$。对于弱选择（$s \\ll 1$），使用一阶泰勒近似，我们有 $m_{AA} = \\ln(1) = 0$，$m_{aa} = \\ln(1) = 0$，以及 $m_{Aa} = \\ln(1-s) \\approx -s$。\n\n等位基因 $A$ 的边际马尔萨斯适应度为 $m_A = p \\cdot m_{AA} + (1-p) \\cdot m_{Aa} \\approx p(0) + (1-p)(-s) = -s(1-p)$。\n等位基因 $a$ 的边际马尔萨斯适应度为 $m_a = p \\cdot m_{Aa} + (1-p) \\cdot m_{aa} \\approx p(-s) + (1-p)(0) = -sp$。\n其差值为 $\\Delta m(p) = m_A - m_a \\approx -s(1-p) - (-sp) = s(2p-1)$。\n因此，选择项为 $s p(1-p)(2p-1)$。\n\n**1. 静态梯度方程的推导与求解**\n\n在平衡状态下，等位基因频率剖面是静态的，因此 $\\frac{\\partial p}{\\partial t} = 0$。偏微分方程变为关于静态梯度 $p(x)$ 的常微分方程（ODE）：\n$$\n\\frac{\\sigma^{2}}{2}\\,\\frac{d^{2}p}{dx^{2}} + s p(1-p)(2p-1) = 0\n$$\n令 $p' = \\frac{dp}{dx}$。为求解此二阶非线性常微分方程，我们两边乘以 $p'$ 并对 $x$ 积分：\n$$\n\\frac{\\sigma^{2}}{2} p' p'' = -s p(1-p)(2p-1) p'\n$$\n对两边积分可得：\n$$\n\\int \\frac{\\sigma^{2}}{2} p' \\frac{dp'}{dx} dx = -s \\int (2p^2 - 3p + 1)p \\cdot p' dx\n$$\n通过将积分变量更改为 $p$（因为 $dp = p' dx$），我们得到：\n$$\n\\frac{\\sigma^{2}}{2} \\int p' dp' = -s \\int (2p^3 - 3p^2 + p) dp\n$$\n$$\n\\frac{\\sigma^{2}}{2} \\frac{(p')^2}{2} = -s \\left(\\frac{1}{2}p^4 - p^3 + \\frac{1}{2}p^2 \\right) + C\n$$\n$$\n\\frac{\\sigma^{2}}{4} (p')^2 = -\\frac{s}{2} (p^4 - 2p^3 + p^2) + C = -\\frac{s}{2} p^2(p-1)^2 + C\n$$\n积分常数 $C$ 由边界条件确定。当 $x \\to \\pm\\infty$ 时，梯度变平，因此 $p' \\to 0$。同时，$p \\to 0$ 或 $p \\to 1$。无论哪种情况，项 $p^2(p-1)^2$ 都变为 0。因此，$C=0$。\n$$\n\\frac{\\sigma^{2}}{4} (p')^2 = \\frac{s}{2} p^2(1-p)^2\n$$\n求解 $p'$：\n$$\n(p')^2 = \\frac{2s}{\\sigma^2} p^2(1-p)^2 \\implies p' = \\pm \\sqrt{\\frac{2s}{\\sigma^2}} p(1-p)\n$$\n由于梯度连接 $p(-\\infty)=0$ 和 $p(+\\infty)=1$，斜率必须为正，所以我们取正根：\n$$\n\\frac{dp}{dx} = \\sqrt{\\frac{2s}{\\sigma^2}} p(1-p)\n$$\n这是一个一阶可分离常微分方程。我们分离变量并积分：\n$$\n\\int \\frac{dp}{p(1-p)} = \\int \\sqrt{\\frac{2s}{\\sigma^2}} dx\n$$\n使用部分分式分解 $\\frac{1}{p(1-p)} = \\frac{1}{p} + \\frac{1}{1-p}$：\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\sqrt{\\frac{2s}{\\sigma^2}} x + C_1\n$$\n$$\n\\ln(p) - \\ln(1-p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\sqrt{\\frac{2s}{\\sigma^2}} x + C_1\n$$\n我们使用梯度以 $x=0$ 为中心的条件，即 $p(0) = \\frac{1}{2}$。\n$$\n\\ln\\left(\\frac{1/2}{1-1/2}\\right) = \\ln(1) = 0 = \\sqrt{\\frac{2s}{\\sigma^2}}(0) + C_1 \\implies C_1 = 0\n$$\n因此，经 logit 变换的频率在空间上是线性的：\n$$\n\\ln\\left(\\frac{p(x)}{1-p(x)}\\right) = \\sqrt{\\frac{2s}{\\sigma^2}} x\n$$\n求解 $p(x)$ 得到梯度的显式 S 型函数形式：\n$$\np(x) = \\frac{\\exp\\left(\\sqrt{\\frac{2s}{\\sigma^2}} x\\right)}{1 + \\exp\\left(\\sqrt{\\frac{2s}{\\sigma^2}} x\\right)} = \\frac{1}{1 + \\exp\\left(-\\sqrt{\\frac{2s}{\\sigma^2}} x\\right)}\n$$\n\n**2. 梯度宽度与选择系数的估计**\n\n梯度宽度 $w$ 定义为最大斜率的倒数，该斜率出现在中心 $x=0$ 处：$w = 1/|p'(0)|$。从我们关于 $p'$ 的一阶常微分方程，我们有：\n$$\np'(x) = \\sqrt{\\frac{2s}{\\sigma^2}} p(x)(1-p(x))\n$$\n在 $x=0$ 处，$p(0) = \\frac{1}{2}$，所以斜率为：\n$$\np'(0) = \\sqrt{\\frac{2s}{\\sigma^2}} \\left(\\frac{1}{2}\\right)\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4}\\sqrt{\\frac{2s}{\\sigma^2}}\n$$\n由于 $s>0$ 且 $\\sigma^2>0$，$p'(0) > 0$，所以 $|p'(0)| = p'(0)$。梯度宽度为：\n$$\nw = \\frac{1}{p'(0)} = \\frac{4}{\\sqrt{\\frac{2s}{\\sigma^2}}} = 4\\sqrt{\\frac{\\sigma^2}{2s}} = \\frac{4\\sigma}{\\sqrt{2s}} = \\frac{2\\sqrt{2}\\sigma}{\\sqrt{s}} = \\sqrt{\\frac{8\\sigma^2}{s}}\n$$\n为了将选择系数 $s$ 表示为 $w$ 和 $\\sigma^2$ 的函数，我们重新整理该公式：\n$$\nw^2 = \\frac{8\\sigma^2}{s} \\implies s = \\frac{8\\sigma^2}{w^2}\n$$\n\n**3. 选择系数的数值计算**\n\n根据经验测量值 $w = 24\\,\\text{km}$ 和 $\\sigma^2 = 3\\,\\text{km}^{2}\\,\\text{generation}^{-1}$，我们计算 $s$：\n$$\ns = \\frac{8 \\times 3}{24^2} = \\frac{24}{576} = \\frac{1}{24}\n$$\n作为小数并四舍五入到四位有效数字，结果是：\n$$\ns \\approx 0.041666... \\approx 0.04167\n$$\n\n**4. 关键的生物学和建模假设**\n\n这个对 $s$ 的估计的有效性取决于模型内在的一系列关键假设：\n- **遗传结构**：选择作用于具有两个等位基因的单个基因座。该基因座是杂种不相容性的主要决定因素。其他基因座的影响（上位性）被忽略。\n- **选择模式**：选择在空间和时间上是恒定的，并采用对称杂合子劣势的形式（$w_{AA}=w_{aa}  w_{Aa}$）。不存在频率依赖或密度依赖的选择。\n- **种群与空间结构**：种群栖息于一维、同质的环境中。种群统计学特征（种群密度）是均匀的。\n- **扩散**：个体移动是随机、无偏的，并且可以通过具有恒定扩散方差 $\\sigma^2$ 的扩散过程来近似。这意味着扩散距离通常较短并遵循高斯分布。\n- **交配系统**：在任何局域邻域内交配是随机的（随机交配）。\n- **演化动态**：系统处于平衡状态，形成一个静态（不移动的）梯度。其他演化力量，如遗传漂变（意味着较大的局域种群规模）、突变和减数分裂驱动，被认为是可忽略不计的。\n- **模型简化**：使用连续的反应扩散方程假设了空间、时间和等位基因频率是连续变量，这是对个体、世代和基因拷贝离散性质的一种近似。它还隐含地假设选择足够弱，以使这种连续时间近似成立。", "answer": "$$\\boxed{0.04167}$$", "id": "2717953"}, {"introduction": "在现代基因组梯度研究中，一个关键目标是通过识别具有异常陡峭或偏移的基因频率梯度的位点来检测受选择的基因座。本练习探讨了研究设计的一个关键方面：样本中杂交指数的分布如何影响你检测此类异常位点的统计功效？通过推导基因频率梯度参数的费雪信息（Fisher information），你将定量地证明为什么均衡的杂交后代取样对于最大化推断能力至关重要。[@problem_id:2718001]", "problem": "在一个杂交带中，令杂交指数 $h \\in [0,1]$ 表示来自亲本群体 $P_{1}$ 的全基因组祖先成分比例。对于一个具有双等位基因祖先状态 $z \\in \\{0,1\\}$（其中 $z=1$ 表示祖先来自 $P_{1}$）的焦点基因座，考虑以下基因组渐渗带模型，该模型通过一个基因座特异性的截距和斜率来扰动中性对数优势比：\n$$\\operatorname{logit}\\left(p(h;\\alpha,\\beta)\\right) \\equiv \\ln\\!\\left(\\frac{p(h;\\alpha,\\beta)}{1 - p(h;\\alpha,\\beta)}\\right) \\;=\\; \\ln\\!\\left(\\frac{h}{1-h}\\right) \\;+\\; \\alpha \\;+\\; \\beta\\,x(h),$$\n其中 $x(h) \\equiv 2h - 1$。这种参数化确保了中性期望 $p(h;0,0)=h$。假设对于个体 $i=1,\\dots,N$，$z_{i} \\mid h_{i} \\sim \\mathrm{Bernoulli}\\!\\left(p(h_{i};\\alpha,\\beta)\\right)$ 且相互独立。\n\n重点关注斜率参数 $\\beta$ 的推断，其中截距固定为 $\\alpha=0$，真实值为 $\\beta=2$。您将分析抽样个体中杂交指数 $h_{i}$ 的分布如何影响 $\\beta$ 的费雪信息，并因此影响其最大似然估计量的渐近标准误。\n\n1) 从伯努利对数似然和上述连接函数出发，推导 $\\beta$ 的期望费雪信息，将其表示为 $\\{h_{i}\\}_{i=1}^{N}$ 和 $\\beta$ 的函数。\n\n2) 考虑两种杂交指数的抽样设计，每种设计的总样本量均为 $N$，但个体在五个代表性值 $h \\in \\{0.1, 0.3, 0.5, 0.7, 0.9\\}$ 上的分布不同：\n- 设计 A（均衡型）：在 $h=0.1, 0.3, 0.5, 0.7, 0.9$ 每个值上各有 $N/5$ 个个体。\n- 设计 B（非均衡型；中间类型少）：在这些相同的 $h$ 值上，个体比例分别为：$h=0.1$ 处占 $0.4N$，$h=0.3$ 处占 $0.05N$，$h=0.5$ 处占 $0.1N$，$h=0.7$ 处占 $0.05N$，$h=0.9$ 处占 $0.4N$。\n\n使用您在第 (1) 部分得到的表达式，设 $\\alpha=0$ 和 $\\beta=2$，计算渐近标准误的比率，\n$$R \\equiv \\frac{\\mathrm{se}_{B}(\\hat{\\beta})}{\\mathrm{se}_{A}(\\hat{\\beta})},$$\n其中 $\\mathrm{se}_{D}(\\hat{\\beta})$ 表示设计 $D \\in \\{A,B\\}$下的渐近标准误。将您计算出的 $R$ 的最终数值四舍五入到四位有效数字。该答案无量纲；请以纯数字形式报告（无单位）。", "solution": "该问题要求推导基因组渐渗带模型中一个参数的期望费雪信息，并基于该参数估计的精度对两种抽样设计进行比较。\n\n**第1部分：期望费雪信息的推导**\n\n该模型描述了对于一个杂交指数为 $h$ 的个体，其等位基因来自群体 $P_1$ 的概率。这个概率，记为 $p(h;\\alpha,\\beta)$，通过一个逻辑斯谛连接函数进行建模。我们已知该概率的对数优势比（logit）的参数化形式为：\n$$ \\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\ln\\left(\\frac{h}{1-h}\\right) + \\alpha + \\beta x(h) $$\n其中 $x(h) = 2h - 1$。分析的重点是参数 $\\beta$，而 $\\alpha$ 固定为 $0$。对于个体 $i$，令 $p_i = p(h_i; 0, \\beta)$ 且 $x_i = 2h_i - 1$。模型简化为：\n$$ \\eta_i \\equiv \\operatorname{logit}(p_i) = \\ln\\left(\\frac{h_i}{1-h_i}\\right) + \\beta x_i $$\n个体 $i$ 的祖先状态 $z_i$ 是一个伯努利随机变量，$z_i | h_i \\sim \\mathrm{Bernoulli}(p_i)$。单个观测值 $(z_i, h_i)$ 的对数似然为：\n$$ \\ell_i(\\beta) = z_i \\ln(p_i) + (1-z_i) \\ln(1-p_i) $$\n这是一个具有伯努利分布和 logit 连接函数的广义线性模型 (GLM)。费雪信息由对数似然函数的二阶导数推导得出。\n\n首先，我们求得分函数，即对数似然函数关于 $\\beta$ 的一阶导数。使用链式法则：\n$$ \\frac{\\partial \\ell_i}{\\partial \\beta} = \\frac{\\partial \\ell_i}{\\partial p_i} \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta} $$\n该导数的各组成部分为：\n1. $\\frac{\\partial \\ell_i}{\\partial p_i} = \\frac{z_i}{p_i} - \\frac{1-z_i}{1-p_i} = \\frac{z_i - p_i}{p_i(1-p_i)}$\n2. 对于逻辑斯谛函数 $p_i = (1 + \\exp(-\\eta_i))^{-1}$，其导数为 $\\frac{\\partial p_i}{\\partial \\eta_i} = p_i(1-p_i)$。\n3. 根据模型方程，$\\frac{\\partial \\eta_i}{\\partial \\beta} = x_i$。\n\n合并这些项，得分函数变为：\n$$ \\frac{\\partial \\ell_i}{\\partial \\beta} = \\left(\\frac{z_i - p_i}{p_i(1-p_i)}\\right) [p_i(1-p_i)] (x_i) = (z_i - p_i)x_i $$\n接下来，我们计算对数似然的二阶导数：\n$$ \\frac{\\partial^2 \\ell_i}{\\partial \\beta^2} = \\frac{\\partial}{\\partial \\beta} \\left[ (z_i - p_i)x_i \\right] = -x_i \\frac{\\partial p_i}{\\partial \\beta} $$\n我们再次使用链式法则求解 $\\frac{\\partial p_i}{\\partial \\beta}$：\n$$ \\frac{\\partial p_i}{\\partial \\beta} = \\frac{\\partial p_i}{\\partial \\eta_i} \\frac{\\partial \\eta_i}{\\partial \\beta} = p_i(1-p_i)x_i $$\n将此代入二阶导数的表达式中，得到：\n$$ \\frac{\\partial^2 \\ell_i}{\\partial \\beta^2} = -x_i [p_i(1-p_i)x_i] = -x_i^2 p_i(1-p_i) $$\n单个观测值 $i$ 的期望费雪信息，记为 $I_i(\\beta)$，是二阶导数期望的负值。期望是关于 $z_i$ 的分布计算的。\n$$ I_i(\\beta) = -E_{z_i}\\left[ \\frac{\\partial^2 \\ell_i}{\\partial \\beta^2} \\right] $$\n由于二阶导数的表达式不依赖于随机变量 $z_i$，其期望就是它本身。\n$$ I_i(\\beta) = - \\left[-x_i^2 p_i(1-p_i)\\right] = x_i^2 p_i(1-p_i) $$\n对于一个包含 $N$ 个独立个体的样本，总期望费雪信息是各个体贡献之和：\n$$ I(\\beta) = \\sum_{i=1}^{N} I_i(\\beta) = \\sum_{i=1}^{N} x_i^2 p_i(1-p_i) $$\n代入 $x_i = 2h_i - 1$ 并回顾 $p_i = p(h_i; 0, \\beta)$，我们得到期望费雪信息作为杂交指数 $\\{h_i\\}_{i=1}^N$ 和参数 $\\beta$ 的函数的最终表达式：\n$$ I(\\beta) = \\sum_{i=1}^{N} (2h_i - 1)^2 p(h_i; 0, \\beta)(1-p(h_i; 0, \\beta)) $$\n\n**第2部分：渐近标准误的比率**\n\n最大似然估计量 $\\hat{\\beta}$ 的渐近标准误与费雪信息的平方根成反比：$\\mathrm{se}(\\hat{\\beta}) = [I(\\beta)]^{-1/2}$。我们需要为两种抽样设计 A 和 B 计算比率 $R = \\mathrm{se}_{B}(\\hat{\\beta}) / \\mathrm{se}_{A}(\\hat{\\beta})$。\n\n$$ R = \\frac{[I_B(\\beta)]^{-1/2}}{[I_A(\\beta)]^{-1/2}} = \\sqrt{\\frac{I_A(\\beta)}{I_B(\\beta)}} $$\n我们必须在真实参数值 $\\beta=2$ 处计算这个比率。首先，我们为每个指定的 $h \\in \\{0.1, 0.3, 0.5, 0.7, 0.9\\}$ 值计算信息权重 $w(h, \\beta) = (2h - 1)^2 p(h; \\alpha=0, \\beta)(1 - p(h; \\alpha=0, \\beta))$。\n\n令 $\\beta=2$。对于每个 $h_j$：\n1. $x_j = 2h_j-1$\n2. $\\eta_j = \\ln\\left(\\frac{h_j}{1-h_j}\\right) + 2x_j$\n3. $p_j = (1 + \\exp(-\\eta_j))^{-1}$\n4. $w_j = x_j^2 p_j(1-p_j)$\n\n计算过程如下：\n- 对于 $h_1 = 0.1$：\n  $x_1 = -0.8$, $\\eta_1 = \\ln(1/9) - 1.6 \\approx -3.7972$, $p_1 \\approx 0.02194$, $p_1(1-p_1) \\approx 0.02146$。\n  $w_1 = (-0.8)^2(0.02146) = 0.64 \\times 0.02146 \\approx 0.013734$。\n- 对于 $h_2 = 0.3$：\n  $x_2 = -0.4$, $\\eta_2 = \\ln(3/7) - 0.8 \\approx -1.6473$, $p_2 \\approx 0.16148$, $p_2(1-p_2) \\approx 0.13541$。\n  $w_2 = (-0.4)^2(0.13541) = 0.16 \\times 0.13541 \\approx 0.021666$。\n- 对于 $h_3 = 0.5$：\n  $x_3 = 0$, $\\eta_3 = \\ln(1) + 0 = 0$, $p_3 = 0.5$, $p_3(1-p_3) = 0.25$。\n  $w_3 = (0)^2(0.25) = 0$。\n- 对于 $h_4 = 0.7$：根据对称性，$x_4 = 0.4 = -x_2$, $\\eta_4 = -\\eta_2$, $p_4 = 1-p_2$，所以 $p_4(1-p_4) = p_2(1-p_2)$。因此，$w_4 = x_4^2 p_4(1-p_4) = (-x_2)^2 p_2(1-p_2) = w_2 \\approx 0.021666$。\n- 对于 $h_5 = 0.9$：根据对称性，$x_5 = 0.8 = -x_1$，所以 $w_5 = w_1 \\approx 0.013734$。\n\n两种设计的总信息量是这些权重的总和，按样本量 $N$ 和抽样比例进行缩放。因子 $N$ 将在比率中被消去。\n令 $I_A' = I_A/N$ 和 $I_B' = I_B/N$ 为每个个体的平均信息量。\n\n对于设计 A（均衡型），每个 $h_j$ 的比例为 $1/5 = 0.2$。\n$$ I_A' = 0.2(w_1 + w_2 + w_3 + w_4 + w_5) = 0.2(2w_1 + 2w_2) = 0.4(w_1 + w_2) $$\n$$ I_A' = 0.4(0.013734 + 0.021666) = 0.4(0.035400) = 0.014160 $$\n\n对于设计 B（非均衡型），比例为 $\\{0.4, 0.05, 0.1, 0.05, 0.4\\}$。\n$$ I_B' = 0.4w_1 + 0.05w_2 + 0.1w_3 + 0.05w_4 + 0.4w_5 $$\n$$ I_B' = (0.4+0.4)w_1 + (0.05+0.05)w_2 + 0.1w_3 = 0.8w_1 + 0.1w_2 $$\n$$ I_B' = 0.8(0.013734) + 0.1(0.021666) = 0.0109872 + 0.0021666 = 0.0131538 $$\n\n现在我们可以计算信息量的比率，然后计算标准误的比率。\n$$ \\frac{I_A}{I_B} = \\frac{I_A'}{I_B'} = \\frac{0.014160}{0.0131538} \\approx 1.07650 $$\n标准误的比率是该值的平方根：\n$$ R = \\sqrt{\\frac{I_A}{I_B}} = \\sqrt{1.07650} \\approx 1.037545 $$\n四舍五入到四位有效数字得到 $1.038$。这表明，在非均衡抽样设计（B）下，$\\hat{\\beta}$ 的渐近标准误比均衡设计（A）下大约大 $3.8\\%$，意味着设计 B 的统计精度较低。", "answer": "$$\\boxed{1.038}$$", "id": "2718001"}]}