{"hands_on_practices": [{"introduction": "ABBA-BABA检验和D统计量是检测古代基因渗入的基石。本练习的核心不仅在于计算该统计量，更在于学习如何使用区块刀切法（block jackknife）来评估其统计显著性，这是处理真实基因组数据中因连锁而产生的非独立性的关键步骤。通过这个练习，你将掌握从基因组比对的原始计数中推断基因流信号的统计基础。[@problem_id:2544491]", "problem": "使用全基因组范围内的双等位基因单核苷酸多态性（SNPs）进行了一项针对适应性基因渗入的四分类单元检验，这些SNPs被排列成不重叠的物理区块以考虑连锁效应。这些分类单元排列为 $\\left(P_{1},P_{2},P_{3};O\\right)$，其中 $O$ 是一个外群。在无基因渗入且仅存在不完全谱系分选（ILS）的零假设下，位点模式 $\\mathrm{ABBA}$ 和 $\\mathrm{BABA}$ 的期望计数是相等的。D-统计量用于量化这些计数中的不对称性。基因组被划分为 $B=50$ 个等长区块，用于区块重抽样。\n\n在整个数据集中，总计数为 $\\mathrm{ABBA}=320$ 和 $\\mathrm{BABA}=280$。为评估不确定性，执行了删一区块刀切法（每次剔除一个区块）。令 $\\hat{D}_{(-b)}$ 表示从移除了区块 $b$ 的数据计算出的D-统计量，令 $\\bar{D}_{\\mathrm{LOO}}=\\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ 为留一法估计值的均值。从 $B=50$ 个留一法重复中，观测到离差平方和为\n$$\n\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}.\n$$\n\n仅使用 $\\mathrm{ABBA}$–$\\mathrm{BABA}$ 框架和删一刀切法的基本定义，完成以下任务：\n- 根据总计数推导全基因组D-统计量的表达式并计算其值。\n- 从删一刀切法方差估计量的定义出发，推导出用 $B$ 和留一法偏差表示的该估计量，然后计算刀切法标准误和用于检验零假设 $D=0$ 的相应Z-分数。\n\n将您的最终答案以行矩阵 $\\left[D,\\;Z\\right]$ 的形式报告，其中两个条目均四舍五入至四位有效数字，并以纯小数形式表示（无单位）。", "solution": "问题陈述具有科学依据、提法得当、客观，并包含了得出完整解答所需的所有信息。它描述了D-统计量（ABBA-BABA检验）与用于方差估计的区块刀切法程序的标准应用，这些都是群体基因组学中的既定方法。所提供的数据是一致且合理的。因此，我们将进行完整的推导和计算。\n\n首先，我们推导并计算全基因组D-统计量，记为 $\\hat{D}$。该统计量量化了由 $\\mathrm{ABBA}$ 和 $\\mathrm{BABA}$ 位点模式所代表的两种备择基因树拓扑结构计数之间的不对称性。设 $n_{\\mathrm{ABBA}}$ 和 $n_{\\mathrm{BABA}}$ 为整个基因组中这些模式的总计数。D-统计量定义为这些计数的归一化差异：\n$$\n\\hat{D} = \\frac{n_{\\mathrm{ABBA}} - n_{\\mathrm{BABA}}}{n_{\\mathrm{ABBA}} + n_{\\mathrm{BABA}}}\n$$\n问题提供了总计数：$n_{\\mathrm{ABBA}} = 320$ 和 $n_{\\mathrm{BABA}} = 280$。将这些值代入公式可得：\n$$\n\\hat{D} = \\frac{320 - 280}{320 + 280} = \\frac{40}{600} = \\frac{1}{15}\n$$\n其数值为 $\\hat{D} \\approx 0.066667$。\n\n接下来，我们使用删一区块刀切法来处理不确定性估计和假设检验。我们需要推导方差估计量。设 $\\hat{D}$ 是从包含 $B$ 个区块的完整数据集中计算出的统计量，$\\hat{D}_{(-b)}$ 是剔除区块 $b$ 后重新计算的统计量。对于每个区块 $b \\in \\{1, 2, ..., B\\}$，刀切法伪值 $J_b$ 定义为：\n$$\nJ_b = B \\hat{D} - (B-1)\\hat{D}_{(-b)}\n$$\n$\\hat{D}$ 的刀切法方差估计量由伪值的样本方差除以区块数 $B$ 给出：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} (J_b - \\bar{J})^2\n$$\n其中 $\\bar{J}$ 是伪值的均值，$\\bar{J} = \\frac{1}{B}\\sum_{b=1}^{B} J_b$。为了继续推导，我们用留一法估计值 $\\hat{D}_{(-b)}$ 来表示此方差。首先，我们求伪值的均值 $\\bar{J}$：\n$$\n\\bar{J} = \\frac{1}{B} \\sum_{b=1}^{B} [B \\hat{D} - (B-1)\\hat{D}_{(-b)}] = B \\hat{D} - \\frac{B-1}{B} \\sum_{b=1}^{B} \\hat{D}_{(-b)} = B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\n$$\n其中 $\\bar{D}_{\\mathrm{LOO}} = \\frac{1}{B}\\sum_{b=1}^{B}\\hat{D}_{(-b)}$ 是留一法估计值的均值。单个伪值与其均值的偏差为：\n$$\nJ_b - \\bar{J} = \\left[B \\hat{D} - (B-1)\\hat{D}_{(-b)}\\right] - \\left[B \\hat{D} - (B-1)\\bar{D}_{\\mathrm{LOO}}\\right] = -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})\n$$\n将此结果代入方差公式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{1}{B(B-1)} \\sum_{b=1}^{B} \\left[ -(B-1)(\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}}) \\right]^2 = \\frac{(B-1)^2}{B(B-1)} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n这可以化简为我们所求的删一刀切法方差估计量的表达式：\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{B-1}{B} \\sum_{b=1}^{B} (\\hat{D}_{(-b)} - \\bar{D}_{\\mathrm{LOO}})^2\n$$\n推导出此表达式后，我们现在可以计算其值。给定 $B=50$ 和离差平方和 $\\sum_{b=1}^{B}\\left(\\hat{D}_{(-b)}-\\bar{D}_{\\mathrm{LOO}}\\right)^{2}=2.296\\times 10^{-4}$。\n$$\n\\widehat{\\mathrm{Var}}_{J}(\\hat{D}) = \\frac{50-1}{50} (2.296 \\times 10^{-4}) = \\frac{49}{50} (2.296 \\times 10^{-4}) = 0.98 \\times 2.296 \\times 10^{-4} = 2.25008 \\times 10^{-4}\n$$\n刀切法标准误 $\\mathrm{SE}_J(\\hat{D})$ 是方差的平方根：\n$$\n\\mathrm{SE}_J(\\hat{D}) = \\sqrt{\\widehat{\\mathrm{Var}}_{J}(\\hat{D})} = \\sqrt{2.25008 \\times 10^{-4}} \\approx 0.01500027\n$$\n最后，我们计算用于检验零假设 $H_0: D=0$ 的Z-分数。Z-分数是估计的统计量与其标准误的比值：\n$$\nZ = \\frac{\\hat{D} - D_{H_0}}{\\mathrm{SE}_J(\\hat{D})} = \\frac{\\hat{D}}{\\mathrm{SE}_J(\\hat{D})}\n$$\n使用已计算出的 $\\hat{D}$ 和 $\\mathrm{SE}_J(\\hat{D})$ 的值：\n$$\nZ = \\frac{1/15}{0.01500027} \\approx \\frac{0.066666...}{0.01500027} \\approx 4.44439\n$$\n问题要求最终答案以行矩阵 $[D, Z]$ 的形式报告，两个值均四舍五入至四位有效数字。\n$D = 0.066666... \\approx 0.06667$\n$Z = 4.44439... \\approx 4.444$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06667  4.444\n\\end{pmatrix}\n}\n$$", "id": "2544491"}, {"introduction": "检测到基因渗入的信号后，下一个关键问题是：如果渗入的等位基因是适应性的，它的命运将如何？本练习将我们的视角从静态检测转向动态过程，探索了在加性选择作用下，一个适应性等位基因在群体中频率变化的经典确定性模型。通过从第一性原理推导，你将掌握描绘其频率增长的逻辑斯蒂方程，并理解其最终走向固定的动态轨迹。[@problem_id:2544560]", "problem": "一个赋予高海拔耐受性的基因渗入等位基因$A$通过适应性基因渗入进入了两个不同的分类单元：一种山地哺乳动物和一种高山草本植物。在时间$t=0$时发生一次短暂的杂交脉冲后，该等位基因在受体群体中以频率$p_{0} \\in (0,1)$存在。此后，群体规模大、随机交配且封闭（无迁移），因此遗传漂变和进一步的基因流可以忽略不计。假设选择在连续时间内对马尔萨斯适应度起加性作用：每个等位基因$A$的拷贝都对人均增长率有$s0$的加性贡献，因此基因型马尔萨斯适应度为$r_{AA}=2s$，$r_{Aa}=s$和$r_{aa}=0$。假设由于随机交配，在每个瞬间都满足哈迪-温伯格基因型比例，并且连续时间的确定性选择动态适用。\n\n仅使用这些假设和基因型频率的连续时间选择（复制子）动态的定义——即基因型频率$x_{i}$根据$\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$变化，其中$\\bar{r}$是平均马尔萨斯适应度——从第一性原理推导在初始条件$p(0)=p_{0}$下，$t \\ge 0$时的预期等位基因频率轨迹$p(t)$。然后，将半固定时间$t_{1/2}$定义为$p(t)=\\frac{1}{2}$时的时间，并用$s$和$p_{0}$来确定$t_{1/2}$。将时间$t$视为以世代为单位，将$s$视为每代的马尔萨斯选择系数。以$p(t)$和$t_{1/2}$的闭合形式解析表达式提供最终答案。不需要进行数值舍入。", "solution": "在尝试任何解答之前，将首先对问题陈述进行严格的验证程序。\n\n### 第1步：提取给定条件\n问题陈述中提供的明确信息如下：\n- 一个基因渗入等位基因表示为$A$。\n- 杂交发生在时间$t=0$。\n- 等位基因$A$的初始频率为$p(0) = p_{0}$，其中$p_{0} \\in (0,1)$。\n- 群体规模大、随机交配且封闭，因此遗传漂变和迁移可以忽略不计。\n- 选择在连续时间内对马尔萨斯适应度起加性作用。\n- 每个等位基因$A$的拷贝对人均增长率的加性贡献为$s0$。\n- 基因型马尔萨斯适应度指定为：$r_{AA}=2s$，$r_{Aa}=s$和$r_{aa}=0$。\n- 假设在每个瞬间都满足哈迪-温伯格基因型比例。\n- 基因型频率$x_{i}$的动态由微分方程$\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$控制，其中$\\bar{r}$是平均马尔萨斯适应度。\n- 任务是推导$t \\ge 0$时的等位基因频率轨迹$p(t)$。\n- 任务包括定义并确定半固定时间$t_{1/2}$，其中$p(t_{1/2})=\\frac{1}{2}$。\n\n### 第2步：使用提取的给定条件进行验证\n根据所需标准对问题进行评估。\n\n- **科学依据：** 该问题是确定性群体遗传学理论的经典应用。连续时间复制子方程、马尔萨斯适应度、加性选择和哈迪-温伯格原理是理论生物学中基本且已确立的概念。适应性基因渗入的情景是一个已知的进化过程。该问题在科学上是合理的。\n- **适定性：** 该问题提供了一个基于一阶常微分方程的明确定义的初值问题。它提供了所有必要的参数（$p_0$，$s$）和函数形式（适应度、动态）来推导$p(t)$及后续$t_{1/2}$的唯一解。该问题是适定的。\n- **客观性：** 该问题使用精确、形式化和客观的数学及生物学术语进行陈述。它不包含任何主观或基于意见的陈述。\n- **不完整或矛盾的设置：** 该问题为其解答提供了完整的假设和定义集。没有内部矛盾。\n- **不切实际或不可行：** 该模型是一个理想化模型，正如所有模型一样，但它在科学上并非不合理或物理上不可能。它代表了群体遗传学理论中的一个标准极限情况。\n- **其他缺陷：** 该问题不是隐喻性的、琐碎的或同义反复的。它需要从第一性原理进行严格推导，这是一项实质性的练习。\n\n### 第3步：结论和行动\n该问题被判定为**有效**。这是一个数学群体遗传学中的标准、适定问题。我现在将开始推导解答。\n\n任务是从第一性原理推导等位基因频率$p(t)$的轨迹。我们已知基因型频率的动态，所以我们必须首先将等位基因频率的变化$\\dot{p}$与基因型频率的变化联系起来。\n\n等位基因$A$的频率（表示为$p$）与基因型$AA$和$Aa$的频率（分别表示为$x_{AA}$和$x_{Aa}$）通过以下关系相关联：\n$$\np = x_{AA} + \\frac{1}{2}x_{Aa}\n$$\n问题假设由于随机交配，在所有时间都满足哈迪-温伯格比例。这意味着基因型频率可以用等位基因频率$p$及其替代等位基因频率$q=1-p$来表示：\n$$\nx_{AA} = p^2 \\quad , \\quad x_{Aa} = 2p(1-p) \\quad , \\quad x_{aa} = (1-p)^2\n$$\n群体的平均马尔萨斯适应度$\\bar{r}$是按频率加权的基因型适应度的平均值：\n$$\n\\bar{r} = x_{AA}r_{AA} + x_{Aa}r_{Aa} + x_{aa}r_{aa}\n$$\n代入哈迪-温伯格比例和给定的适应度值（$r_{AA}=2s$，$r_{Aa}=s$，$r_{aa}=0$）：\n$$\n\\bar{r} = p^2(2s) + 2p(1-p)(s) + (1-p)^2(0) = 2sp^2 + 2sp - 2sp^2 = 2sp\n$$\n平均适应度与等位基因频率之间的这种线性关系是加性选择的一个典型特征。\n\n现在，我们推导$p(t)$的微分方程。我们将$p$的表达式对时间$t$求导：\n$$\n\\dot{p} = \\frac{dp}{dt} = \\frac{d}{dt}\\left(x_{AA} + \\frac{1}{2}x_{Aa}\\right) = \\dot{x}_{AA} + \\frac{1}{2}\\dot{x}_{Aa}\n$$\n我们代入给定的复制子动态$\\dot{x}_{i}=x_{i}(r_{i}-\\bar{r})$：\n$$\n\\dot{p} = x_{AA}(r_{AA} - \\bar{r}) + \\frac{1}{2}x_{Aa}(r_{Aa} - \\bar{r})\n$$\n现在，代入哈迪-温伯格比例以及适应度和平均适应度的表达式：\n$$\n\\dot{p} = p^2(2s - 2sp) + \\frac{1}{2}[2p(1-p)](s - 2sp)\n$$\n提取公因式：\n$$\n\\dot{p} = p^2(2s(1-p)) + p(1-p)(s(1-2p))\n$$\n我们可以从两项中提取出$sp(1-p)$：\n$$\n\\dot{p} = sp(1-p)[2p + (1-2p)]\n$$\n方括号中的项简化为$1$：\n$$\n\\dot{p} = sp(1-p)\n$$\n这是加性选择下等位基因频率的逻辑斯蒂微分方程。为了求出$p(t)$，我们必须解这个方程，并满足初始条件$p(0)=p_0$。这是一个可分离变量方程：\n$$\n\\frac{dp}{p(1-p)} = s \\, dt\n$$\n我们对两边进行积分。左边使用部分分式分解进行积分。我们设$\\frac{1}{p(1-p)} = \\frac{C_1}{p} + \\frac{C_2}{1-p}$。这得到$1 = C_1(1-p) + C_2 p$，解得$C_1=1$和$C_2=1$。\n$$\n\\int \\left(\\frac{1}{p} + \\frac{1}{1-p}\\right) dp = \\int s \\, dt\n$$\n进行积分得到：\n$$\n\\ln|p| - \\ln|1-p| = st + K\n$$\n其中$K$是积分常数。由于$p \\in (0,1)$，绝对值符号不是必需的。\n$$\n\\ln\\left(\\frac{p}{1-p}\\right) = st + K\n$$\n这个量$\\ln(p/(1-p))$是频率$p$的logit值。为了求出$K$，我们应用初始条件$p(0)=p_0$：\n$$\n\\ln\\left(\\frac{p_0}{1-p_0}\\right) = s(0) + K \\implies K = \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\n将$K$代回方程：\n$$\n\\ln\\left(\\frac{p(t)}{1-p(t)}\\right) = st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\n$$\n为了解出$p(t)$，我们首先对两边取指数：\n$$\n\\frac{p(t)}{1-p(t)} = \\exp\\left(st + \\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\exp(st) \\exp\\left(\\ln\\left(\\frac{p_0}{1-p_0}\\right)\\right) = \\frac{p_0}{1-p_0}\\exp(st)\n$$\n设这个右边为$Z(t)$。那么$p(t) = Z(t)(1-p(t)) = Z(t) - Z(t)p(t)$。\n$$\np(t)(1+Z(t)) = Z(t) \\implies p(t) = \\frac{Z(t)}{1+Z(t)}\n$$\n代入$Z(t)$的表达式：\n$$\np(t) = \\frac{\\frac{p_0}{1-p_0}\\exp(st)}{1 + \\frac{p_0}{1-p_0}\\exp(st)}\n$$\n将分子和分母同乘以$(1-p_0)$，可将表达式简化为其最终形式：\n$$\np(t) = \\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)}\n$$\n这是第一个要求的结果。\n\n接下来，我们必须找到半固定时间$t_{1/2}$，定义为$p(t_{1/2}) = \\frac{1}{2}$时的时间。我们将$p(t)$的解设为$\\frac{1}{2}$：\n$$\n\\frac{1}{2} = \\frac{p_0 \\exp(st_{1/2})}{(1-p_0) + p_0 \\exp(st_{1/2})}\n$$\n交叉相乘得到：\n$$\n(1-p_0) + p_0 \\exp(st_{1/2}) = 2 p_0 \\exp(st_{1/2})\n$$\n重新整理以求解指数项：\n$$\n1-p_0 = 2 p_0 \\exp(st_{1/2}) - p_0 \\exp(st_{1/2}) = p_0 \\exp(st_{1/2})\n$$\n$$\n\\exp(st_{1/2}) = \\frac{1-p_0}{p_0}\n$$\n对两边取自然对数：\n$$\nst_{1/2} = \\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\n最后，求解$t_{1/2}$：\n$$\nt_{1/2} = \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n$$\n这个表达式也可以写成$t_{1/2} = -\\frac{1}{s}\\ln\\left(\\frac{p_0}{1-p_0}\\right)$。请注意，对于$p_0  \\frac{1}{2}$，对数的参数大于$1$，因此$t_{1/2} > 0$。如果$p_0 = \\frac{1}{2}$，则$t_{1/2} = 0$，正如预期。推导到此结束。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p_0 \\exp(st)}{(1-p_0) + p_0 \\exp(st)}  \\frac{1}{s}\\ln\\left(\\frac{1-p_0}{p_0}\\right)\n\\end{pmatrix}\n}\n$$", "id": "2544560"}, {"introduction": "适应性渗入的成功并不仅仅取决于单个有利等位基因，还取决于它能否摆脱与之连锁的不利遗传背景，这一现象被称为“连锁拖累”（linkage drag）。本练习引入了这一关键的现实复杂性，通过概率建模来量化重组如何帮助适应性等位基因“逃脱”与之连锁的有害变异。完成此练习后，你将能从数学上理解重组率和有害突变密度如何共同决定一个渗入的适应性基因的最终成败。[@problem_id:2544485]", "problem": "一个适应性等位基因，记为 $B$，由嵌入在受体基因组中的一个供体祖先片段携带，渐渗到一个受体物种中（在比较动物学和植物学的背景下）。假设以下被广泛使用并有经验支持的基础。\n\n1. 沿着单个谱系，染色体上的减数重组断点以空间泊松点过程的形式出现，其恒定速率为每个碱基对每代 $r$。在 $B$ 的祖先中经过 $T$ 代后，焦点位点左右两侧最近的重组断点距离是独立同分布的指数随机变量，其速率参数为 $rT$。\n\n2. 最初在供体祖先上连锁的有害变异沿着染色体以空间泊松点过程的形式分布，其恒定速率为每个碱基对 $\\lambda$。在受体背景下，每个变异都有一个有害选择系数 $S$，它是从支撑集为 $(0,\\infty)$ 的概率密度函数 $g(s)$ 中独立同分布（i.i.d.）地抽取的。\n\n3. 对于一个由生态环境和背景选择决定的固定容忍阈值 $s_{c}0$（例如，$B$ 的净优势的一小部分），如果一个连锁的有害变异的 $S \\ge s_{c}$，则它被分类为有害的。在所考虑的时间窗口内，$S  s_{c}$ 的变异对于 $B$ 的命运被认为是可忽略的。\n\n将 $T$ 代后围绕 $B$ 的未重组的供体祖先核心长度定义为左右两侧最近断点距离之和。如果在时间 $T$ 时，这个未重组的核心内没有有害的变异存在，则称适应性等位基因 $B$ 逃脱了有害连锁变异。\n\n从上述原理出发，且不引入任何没有根据的简化，推导出一个关于 $B$ 在时间 $T$ 时已逃脱有害连锁变异的概率 $P_{\\mathrm{escape}}(T)$ 的解析表达式，该表达式是 $r$、$T$、$\\lambda$、$g(s)$ 和 $s_{c}$ 的函数。你的最终答案必须是一个单一的封闭形式表达式。不要进行近似。报告一个无量纲的概率（无单位）。如果你引入任何辅助量，它们必须用 $g(s)$ 和 $s_{c}$ 明确定义。", "solution": "所陈述的问题在科学上是合理的、自洽的且提法恰当。它基于群体遗传学的既定原理，特别是使用泊松过程来模拟重组和突变事件。所有参数都已明确定义，目标是推导一个概率，这是一个可以形式化和解决的任务。因此，我将开始推导解答。\n\n问题要求计算适应性等位基因 $B$ 在 $T$ 代后逃脱与有害变异连锁的概率。这个逃脱事件被定义为在围绕 $B$ 的未重组的供体祖先核心内不存在任何有害的变异。\n\n首先，我们必须描述有害变异的空间过程。根据问题陈述，有害变异沿着染色体以空间泊松点过程的形式分布，其恒定速率为每个碱基对 $\\lambda$。如果一个变异的选择系数 $S$ 大于或等于阈值 $s_c$，则该变异被分类为有害的。每个变异的选择系数 $S$ 是从概率密度函数 $g(s)$ 中独立随机抽取的。\n\n任何给定的有害变异为“有害的”的概率，我们记为 $p_h$，由概率密度函数 $g(s)$ 在有害选择系数范围内的积分给出：\n$$p_h = P(S \\ge s_c) = \\int_{s_c}^{\\infty} g(s) \\, ds$$\n这个量 $p_h$ 代表了根据指定标准被认为是有害的所有变异的比例。\n\n根据泊松过程的稀疏化性质，有害的变异本身也构成一个空间泊松点过程。这个新过程的速率，我们记为 $\\lambda_h$，是原始速率 $\\lambda$ 与一个变异为有害的概率 $p_h$ 的乘积。\n$$ \\lambda_h = \\lambda \\cdot p_h = \\lambda \\int_{s_c}^{\\infty} g(s) \\, ds $$\n\n围绕等位基因 $B$ 的未重组的供体祖先核心长度是随机变量 $L = L_L + L_R$，其中 $L_L$ 和 $L_R$ 分别是 $B$ 左右两侧最近的断点距离。问题指出 $L_L$ 和 $L_R$ 是独立同分布（i.i.d.）的指数随机变量，速率参数为 $rT$。也就是说，$L_L, L_R \\sim \\text{Exponential}(rT)$。这些距离的概率密度函数是 $f(x) = rT \\exp(-rTx)$，对于 $x \\ge 0$。\n\n对于一个固定的、非随机的核心长度 $l$，在此长度内的有害变异数量 $N_h$ 服从均值为 $\\lambda_h l$ 的泊松分布。在此长度内找到 $k$ 个有害变异的概率是：\n$$ P(N_h = k | L=l) = \\frac{(\\lambda_h l)^k \\exp(-\\lambda_h l)}{k!} $$\n如果核心中没有有害变异，等位基因 $B$ 就逃脱了。这个事件的概率，在核心长度为 $l$ 的条件下，是：\n$$ P(\\text{escape} | L=l) = P(N_h = 0 | L=l) = \\exp(-\\lambda_h l) $$\n\n为了找到无条件的逃脱概率 $P_{\\text{escape}}(T)$，我们必须将这个条件概率在随机核心长度 $L$ 的整个概率分布上取平均。这等价于求函数 $\\exp(-\\lambda_h L)$ 的期望值：\n$$ P_{\\text{escape}}(T) = E[\\exp(-\\lambda_h L)] $$\n由于 $L = L_L + L_R$，并且 $L_L$ 和 $L_R$ 是独立的随机变量，我们可以将期望分开：\n$$ P_{\\text{escape}}(T) = E[\\exp(-\\lambda_h (L_L + L_R))] = E[\\exp(-\\lambda_h L_L)] \\cdot E[\\exp(-\\lambda_h L_R)] $$\n项 $E[\\exp(-\\lambda_h X)]$ 是随机变量 $X$ 在 $t = -\\lambda_h$ 处的矩生成函数（MGF）。一个指数随机变量 $X \\sim \\text{Exponential}(\\beta)$ 的 MGF 由 $M_X(t) = E[\\exp(tX)] = \\frac{\\beta}{\\beta - t}$ 给出，其中 $t  \\beta$。\n\n在我们的例子中，$L_L$ 和 $L_R$ 服从 $\\text{Exponential}(rT)$ 分布，所以速率参数是 $\\beta = rT$。我们在 $t = -\\lambda_h$ 处计算 MGF。\n$$ E[\\exp(-\\lambda_h L_L)] = M_{L_L}(-\\lambda_h) = \\frac{rT}{rT - (-\\lambda_h)} = \\frac{rT}{rT + \\lambda_h} $$\n由于 $L_R$ 具有相同的分布，其期望值也相同：\n$$ E[\\exp(-\\lambda_h L_R)] = \\frac{rT}{rT + \\lambda_h} $$\n综合这些结果，逃脱概率是这两个期望的乘积：\n$$ P_{\\text{escape}}(T) = \\left( \\frac{rT}{rT + \\lambda_h} \\right) \\cdot \\left( \\frac{rT}{rT + \\lambda_h} \\right) = \\left( \\frac{rT}{rT + \\lambda_h} \\right)^2 $$\n最后，我们将有害变异速率的定义 $\\lambda_h = \\lambda \\int_{s_c}^{\\infty} g(s) \\, ds$ 代入表达式中，以获得用问题陈述中提供的原始参数表示的最终答案。\n$$ P_{\\text{escape}}(T) = \\left( \\frac{rT}{rT + \\lambda \\int_{s_c}^{\\infty} g(s) \\, ds} \\right)^2 $$\n这就是适应性等位基因 $B$ 在时间 $T$ 时已逃脱有害连锁变异的概率的完整、封闭形式的解析表达式。", "answer": "$$\\boxed{\\left( \\frac{rT}{rT + \\lambda \\int_{s_c}^{\\infty} g(s) \\, ds} \\right)^2}$$", "id": "2544485"}]}