## 引言
人类起源与[人族系统发育](@entry_id:186557)的探索，是演化生物学中最引人入胜的领域之一。理解我们从何而来，不仅满足了人类与生俱来的好奇心，也为我们洞悉自身的生物学特性、行为模式乃至健康与疾病的演化根源提供了基础。然而，重建这段跨越数百万年的深邃历史，是一项充满挑战的科学任务，它依赖于零散的[化石记录](@entry_id:136693)和复杂的基因组数据。

如何从这些不完整且充满噪声的线索中，提炼出可靠的演化叙事？如何区分真实的谱系关系与[趋同演化](@entry_id:263490)造成的假象？又如何解读基因组中由群体历史、随机漂变和自然选择共同留下的复杂印记？这些问题构成了现代[古人类学](@entry_id:168485)研究的核心挑战。

为应对这些挑战，本文构建了一个系统的知识框架，旨在全面介绍用于研究人类起源的现代原理、方法与实践。在第一章“原理与机制”中，我们将奠定理论基石，深入探讨系统发育系统学的逻辑、[群体遗传学](@entry_id:146344)中的溯祖过程，以及用于推断物种树和群体历史的各类[统计模型](@entry_id:165873)及其固有的陷阱。接下来的第二章“应用与跨学科连接”，将通过一系列真实案例，展示这些理论和方法如何被应用于分析化石形态、解读[古DNA](@entry_id:142895)，并整合生态与气候数据，从而解决人类演化中的具体问题。最后，在“动手实践”部分，读者将有机会亲手应用这些关键分析方法，加深对核心概念的理解。

这趟智识之旅将从最基本的概念开始：我们用来描述和推断演化关系的语言与逻辑。让我们首先进入“原理与机制”的世界，学习如何构建和解读[生命之树](@entry_id:139693)。

## 原理与机制

### 祖先的语言：系统发育系统学

在深入探讨人类起源的复杂细节之前，我们必须首先建立一个清晰、严谨的词汇和概念框架，用于描述和解释[生命之树](@entry_id:139693)的谱系关系。系统发育系统学（phylogenetic systematics），或称[支序学](@entry_id:143946)（cladistics），为我们提供了这样的框架。其核心原则是，分类群组的划分必须反映其演化历史，即共同祖先关系，而非仅仅是表面的相似性。

#### [单系性](@entry_id:174362)作为基石

演化的[基本模式](@entry_id:165201)是“可修饰的后裔”（descent with modification）。这一过程自然地产生了嵌套的层级结构，其中一些物种比其他物种共享更晚近的[共同祖先](@entry_id:175919)。一个科学的分类系统应该旨在反映这一根本的因果结构。因此，系统发育系统学的核心是**[单系群](@entry_id:142386)（monophyletic group）**或**支系（clade）**的概念，它被定义为一个祖先及其所有后代所构成的完整群体。

将分类建立在[单系性](@entry_id:174362)之上，而非传统的总体形态相似性之上，是至关重要的。形态上的相似性可能源于两种截然不同的原因：**同源性（homology）**，即因共同祖先而共享的相似性；以及**同塑性（homoplasy）**，即因趋同演化、[平行演化](@entry_id:263490)或性状逆转而独立获得的相似性。仅仅依赖总体相似性进行分组，会不可避免地将这两种现象混淆，从而产生错误的[演化关系](@entry_id:175708)推断。例如，一个基于天真相似性规则的方法可能会将具有相似臼齿形态（如巨齿）的几个化石人族物种归为一类，即使其中一个物种缺乏其他成员共有的关键适应性状，如两足行走。这种分组可能会因为一个[趋同演化](@entry_id:263490)的性状而掩盖了真实的谱系关系，导致建立**[并系群](@entry_id:147411)（paraphyletic group）**（包含共同祖先但排除了其部分后代）或**[多系群](@entry_id:168427)（polyphyletic group）**（其成员的[最近共同祖先](@entry_id:136722)不属于该群），这两种分类单元都歪曲了真实的演化历史 [@problem_id:2724610]。为了识别和区分同源性，[系统发育学](@entry_id:147399)家使用**[外群比较](@entry_id:139024)法（outgroup comparison）**来确定性状的极性，区分**共源衍征（synapomorphy）**（定义支系的共享衍生性状）和**祖征（plesiomorphy）**（从更遥远祖先继承的[原始性](@entry_id:145479)状）。只有共源衍征才能作为定义[单系群](@entry_id:142386)的证据。

#### 定义[支系](@entry_id:171685)：基于节点与基于主干

为了确保分类学术语的精确性和稳定性，系统发育命名法提供了两种主要的[支系](@entry_id:171685)定义方式 [@problem_id:2724559]：

1.  **基于节点的定义（Node-based definition）**：定义一个[支系](@entry_id:171685)，该支系包含特定内部指征（specifiers）的**[最近共同祖先](@entry_id:136722)（Most Recent Common Ancestor, MRCA）**及其所有后代。
2.  **基于主干的定义（Stem-based definition）**：定义一个[支系](@entry_id:171685)，该支系包含所有与某个内部指征共享的[最近共同祖先](@entry_id:136722)，比它们与某个外部指征（外群）的[最近共同祖先](@entry_id:136722)更晚近的生物。

这些精确的定义对于厘清人类演化中一些常用但易混淆的术语至关重要。基于当前公认的人科（Hominidae）[系统发育树](@entry_id:140506)——（猩猩科，（大猩猩科，（[人属](@entry_id:173148)，黑猩猩属））），我们可以如下定义几个关键[类群](@entry_id:182524)：

-   **人科（hominid, Family Hominidae）**：这个分类单元通常指“大型猿类”。一个精确的基于节点的定义是：[人属](@entry_id:173148)（*Homo*）和猩猩属（*Pongo*）的[最近共同祖先](@entry_id:136722)及其所有后代。现存成员包括人、黑猩猩、大猩猩和猩猩。

-   **人亚科（hominine, Subfamily Homininae）**：这个分类单元通常指“非洲大型猿类”，排除了亚洲的猩猩。一个精确的基于节点的定义是：[人属](@entry_id:173148)和**大猩猩属**（*Gorilla*）的[最近共同祖先](@entry_id:136722)及其所有后代。现存成员包括人、黑猩猩和大猩猩。

-   **人族（hominin, Tribe Hominini）**：在现代用法中，这个术语特指自与黑猩猩/倭黑猩猩谱系分化后的人类谱系。一个精确的基于主干的定义是：所有与智人（*Homo sapiens*）的关系比与黑猩猩（*Pan troglodytes*）更近的分类单元。根据这个定义，现存的人族成员仅包括[人属](@entry_id:173148)物种。而所有早期的人类谱系化石，如**[南方古猿](@entry_id:166069)（*Australopithecus*）**、**傍人（*Paranthropus*）**、**地猿（*Ardipithecus*）**、**乍得沙赫人（*Sahelanthropus*）**和**图根原人（*Orrorin*）**，都明确地属于人族。

#### 整合化石：实践中的主干群与冠群

在处理包含大量已灭绝成员的谱系时，区分**冠群（crown group）**和**主干群（stem group）**变得尤为重要。

-   **冠群**是一个由某一群体现存所有成员的[最近共同祖先](@entry_id:136722)及其所有后代（包括已灭绝的后代）构成的[支系](@entry_id:171685)。
-   **主干群**则由一系列已灭绝的谱系组成，这些谱系与某个冠群的关系比该冠群与其现存的姐妹群（sister group）的关系更近。它们位于通向冠群的“主干”上，但本身不属于冠群。

这些定义的应用取决于我们如何界定“人族”这个术语 [@problem_id:2724624]。例如，我们可以考虑两种定义：

-   定义1（广义）：将“人族”定义为包含[人属](@entry_id:173148)和黑猩猩属的部落（Hominini）。在这种情况下，冠群人族由[人属](@entry_id:173148)和黑猩猩属的[最近共同祖先](@entry_id:136722)（约700万年前）及其所有后代组成。因此，所有明确位于人类谱系分化后的化石（如*Australopithecus*, *Homo erectus*等）都属于这个冠群。

-   定义2（狭义）：将“人族”定义为仅包含人类谱系的亚族（Hominina）。在这种情况下，冠群人族由所有现存[人属](@entry_id:173148)成员（即智人）的[最近共同祖先](@entry_id:136722)及其所有后代组成。这个祖先在[地质时间](@entry_id:175139)上非常晚近。因此，所有已灭绝的早期人类亲属，如*Australopithecus*, *Paranthropus*, 甚至*Homo erectus*和尼安德特人，都位于这个冠群之外，属于人族的主干群。

理解这些定义的区别对于准确解释化石在人类[演化树](@entry_id:176670)中的位置至关重要。

### 群体内的谱系：[溯祖理论](@entry_id:155051)及其推论

物种树（species tree）描绘了物种间的分化历史，但在这棵树的每个分支内部，基因的遗传历史——即[基因谱系](@entry_id:172451)（gene genealogies）——遵循着一套受群体规模和随机[遗传漂变](@entry_id:145594)影响的独特过程。**[溯祖理论](@entry_id:155051)（coalescent theory）**为我们提供了理解这些过程的数学框架。

#### [多物种溯祖](@entry_id:150944)（MSC）模型

**[多物种溯祖模型](@entry_id:168566)（The Multispecies Coalescent, MSC）**将单个群体的溯祖过程扩展到一个固定的物种树上。它将[基因谱系](@entry_id:172451)的形成模拟为一个[随机过程](@entry_id:159502)，其中[基因谱系](@entry_id:172451)在物种树的分支内向后追溯。在任何一个分支内，任意两对[基因谱系](@entry_id:172451)在每一代以一定的速率“合并”（coalesce）成一个共同的祖先谱系，这个速率与**有效群体规模（effective population size, $N_e$）**成反比。具体来说，对于$k$个谱系，合并发生的速率为$\binom{k}{2} / (2N_e)$。当谱系追溯到物种分化点时，它们会进入更古老的祖先群体中继续溯祖过程 [@problem_id:2724601]。

#### [不完全谱系分选](@entry_id:141497)（ILS）与基因树冲突

MSC模型的一个核心预测是，由于溯祖过程的随机性，基因树的拓扑结构可能与[物种树](@entry_id:147678)不一致。这种现象被称为**[不完全谱系分选](@entry_id:141497)（Incomplete Lineage Sorting, ILS）**。当一个[物种树](@entry_id:147678)的内部分支在时间上很短，而祖先群体的有效规模很大时，ILS尤为常见。

以人-黑猩猩-大猩猩的三元关系为例，公认的[物种树](@entry_id:147678)是（（人，黑猩猩），大猩猩）。人与黑猩猩的祖先谱系在大约800万年前从大猩猩谱系分化出来，然后在约600万年前，人与黑猩猩谱系自身发生分化。这中间的内部分支持续了约200万年。如果我们将这段时间（以世代计）用$2N_e$（溯祖单位）来衡量，就可以计算出人与黑猩猩的两个谱系在该分支内未能合并的概率。

假设[世代时间](@entry_id:173412)为25年，祖先有效群体大小$N_e \approx 5 \times 10^4$，那么这个内部分支的长度$t = 2 \times 10^6$年，相当于$t/25 = 8 \times 10^4$代。以溯祖单位衡量，[分支长度](@entry_id:177486)为$T = t / (2N_e) = 8 \times 10^4 / (2 \times 5 \times 10^4) = 0.8$。两个谱系在该分支上未能合并的概率是$e^{-T} = e^{-0.8} \approx 0.45$。如果它们未能合并，它们将与大猩猩的谱系一起进入更古老的祖先群体。在这三个谱系中，任何一对都有$1/3$的可能首先合并。因此，总的[基因树](@entry_id:143427)与[物种树](@entry_id:147678)不一致的概率为$P(\text{discordant total}) = \frac{2}{3}e^{-T} \approx \frac{2}{3}(0.45) \approx 0.30$。这意味着，即使没有物种间的杂交，我们预期仍有大约30%的基因组区域所呈现的[基因树](@entry_id:143427)与（（人，黑猩猩），大猩猩）的物种树拓扑不符，这完全是ILS造成的随机结果 [@problem_id:2724601]。

#### 探测古老的[基因渗入](@entry_id:174858)：基因渐渗 vs. ILS

除了ILS，**基因渐渗（introgression）**，即物种分化后的[基因流](@entry_id:140922)，也会导致等位基因在不同物种间的共享。那么，我们如何区分这两种现象呢？**帕特森D统计量（Patterson's D-statistic）**，也称为四分类群检验（4-taxon test），为此提供了一个强大的工具。

该检验考虑四个分类单元：两个姐妹群$P_1$和$P_2$，一个与它们构成姐妹群的$P_3$，以及一个外群$O$。物种树拓扑为$((P_1, P_2), P_3), O$。我们分析基因组中两种特定的不一致的位点模式：
-   **ABBA模式**：$P_1$为祖先型（A），而$P_2$和$P_3$共享衍生型（B）。
-   **BABA模式**：$P_2$为祖先型（A），而$P_1$和$P_3$共享衍生型（B）。

在仅有ILS而没有[基因渗入](@entry_id:174858)的情况下，产生这两种模式的深层[基因谱系](@entry_id:172451)（即$((P_2, P_3), P_1)$和$((P_1, P_3), P_2)$）因溯祖过程的对称性而具有相等的期望频率。因此，我们期望观察到ABBA和BABA模式的数量大致相等。

D统计量被定义为：
$$ D = \frac{\sum C_{ABBA} - \sum C_{BABA}}{\sum C_{ABBA} + \sum C_{BABA}} $$
其中，$C_{ABBA}$和$C_{BABA}$是每个位点对相应模式的贡献计数（对于频率数据，可以表示为$C_{ABBA,s} = (1 - p_{1,s}) p_{2,s} p_{3,s}$和$C_{BABA,s} = p_{1,s} (1 - p_{2,s}) p_{3,s}$）。

在纯ILS模型下，$E[D]=0$。然而，如果存在从$P_3$到$P_2$的[基因渗入](@entry_id:174858)，这会额外引入大量$((P_2, P_3), P_1)$的谱系拓扑，导致ABBA模式的数量显著超过BABA模式，从而得到$D>0$。反之，若[基因渗入](@entry_id:174858)是从$P_3$到$P_1$，则BABA模式会过量，得到$D0$。因此，D统计量的符号和大小为我们提供了检测[基因渗入](@entry_id:174858)及其方向的有力证据 [@problem_id:2724545]。

### [统计推断](@entry_id:172747)及其挑战

有了理论模型，我们还需要统计方法来从真实的形态和基因组数据中推断演化历史。然而，这些方法本身也充满了挑战和潜在的陷阱。

#### 从单个基因组推断群体历史：PSMC

我们如何从现代人的基因组中窺探其祖先在数十万年间的群体规模变化？**成对顺序马尔可夫[溯祖模型](@entry_id:202220)（Pairwise Sequentially Markovian Coalescent, PSMC）**提供了一种巧妙的方法。它利用单个[二倍体](@entry_id:268054)基因组中杂合位点的[分布](@entry_id:182848)模式来推断过去连续变化的有效群体大小$N_e(t)$。

PSMC的核心是一个**[隐马尔可夫模型](@entry_id:141989)（Hidden Markov Model, HMM）** [@problem_id:2724522]：
-   **[隐藏状态](@entry_id:634361)**：沿着[染色体](@entry_id:276543)，来自父母的两条同源[染色体](@entry_id:276543)的**[最近共同祖先时间](@entry_id:174926)（[TMRCA](@entry_id:174926)）**是不断变化的。PSMC将连续的时间轴离散化为若干区间，因此在基因组的任何一个位置，其[隐藏状态](@entry_id:634361)就是其局部[TMRCA](@entry_id:174926)所在的那个时间区间。
-   **发射概率**：给定一个隐藏状态（即一个[TMRCA](@entry_id:174926)值$T$），我们可以观察到相应基因组片段的[杂合度](@entry_id:166208)。一个位点是[杂合的](@entry_id:276964)概率约等于$2\mu T$，其中$\mu$是突变率。因此，在一个窗口内观察到特定数量杂合位点的概率（即发射概率）是$T$的函数。
-   **转移概率**：当我们在基因组上从一个位置移动到下一个位置时，[隐藏状态](@entry_id:634361)（[TMRCA](@entry_id:174926)）是否改变取决于**重组（recombination）**。如果没有重组事件发生，[TMRCA](@entry_id:174926)保持不变。一个重组事件会打破原有的[基因谱系](@entry_id:172451)，导致一个新的[TMRCA](@entry_id:174926)。重组发生的速率与谱系的总长度（$2T$）和[重组率](@entry_id:203271)$r$成正比。因此，从一个[TMRCA](@entry_id:174926)状态转移出去的概率随$T$的增大而增大。当转移发生时，新的[TMRCA](@entry_id:174926)是从由$N_e(t)$决定的溯祖[先验分布](@entry_id:141376)中重新抽样得到的。

通过使用**[鲍姆-韦尔奇算法](@entry_id:273942)（Baum-Welch algorithm）**，PSMC可以找到最大化观测数据（杂合位点模式）[似然性](@entry_id:167119)的$N_e(t)$参数，从而重建出过去群体规模的动态历史。

#### 推断物种树和[基因渗入](@entry_id:174858)：方法与陷阱

**拼接法与“异常[基因树](@entry_id:143427)”区域**
在构建物种树时，一个看似简单直接的方法是将多个基因的序列**拼接（concatenation）**成一个“超级矩阵”，然后用[最大似然](@entry_id:146147)法等标准方法构建一棵树。然而，在存在显著ILS的情况下，这种方法可能是**统计不一致的（statistically inconsistent）**，意味着即使数据量无限增大，它也可能收敛到一个错误的物种树拓扑 [@problem_id:2724563]。

其根本原因是模型误设（model misspecification）。拼接法假设所有位点都共享同一棵树，而真实的数据是由MSC模型从一个基因树[混合分布](@entry_id:276506)中生成的。当[物种树](@entry_id:147678)的某些内部分支在溯祖单位上极短时，系统发育树可能进入一个所谓的**“异常基因树”区域（anomaly zone）**。在这个区域内，与物种树拓扑不一致的某种基因树反而是最常出现的基因树。由于拼接法的[最大似然估计](@entry_id:142509)会收敛到最能解释数据的单一树，这通常就是最频繁的[基因树](@entry_id:143427)。因此，在异常区域，拼接法会系统性地推断出错误的[物种树](@entry_id:147678)。例如，在人-尼安德特人-[丹尼索瓦人](@entry_id:274908)的快速分化事件中，由于其间的分化间隔非常短，这可能就是一个现实世界中拼接法会失效的例子。

**混合图与可识别性**
为了同时模拟分化和基因流，研究者开发了**混合图（admixture graphs）**模型。这是一种有向无环图，其中节点代表群体，边代表漂变，而特殊的“混合节点”则代表按特定比例（$\alpha$）混合的基因流事件。我们可以通过比较模型预测的**f-统计量**（如$f_2, f_3, f_4$）与从数据中计算出的经验值来拟合这些图。

然而，混合图的推断面临着**可识别性（identifiability）**的限制 [@problem_id:2724570]。这意味着不同的图模型可能产生完全相同的f-统计量，使我们无法仅凭数据区分它们。主要挑战包括：
-   **方向不可识别**：仅凭f-统计量通常无法确定[基因流](@entry_id:140922)的方向。例如，一个尼安德特人向现代人渗入的模型和一个现代人向尼安德特人渗入的模型，通过调整参数，可能在数学上无法区分。
-   **“幽灵”群体**：如果基因流的一个源头是一个未被采样的“幽灵”群体，那么其对混合群体的贡献比例$\alpha$和其自身谱系的漂变长度会相互混淆，导致参数无法唯一确定。
-   **参数过载**：对于$n$个群体，独立的f-统计量的数量是有限的。如果一个混合图模型包含的自由参数（[分支长度](@entry_id:177486)、混合比例）数量超过了数据中独立信息点的数量，该模型必然是不可识别的。

#### 整合化石证据

**化石化生灭（FBD）过程**
如何在一个统一的框架内整合分子数据和化石证据来构建一个有时间标尺的[系统发育树](@entry_id:140506)？**化石化生灭（Fossilized Birth-Death, FBD）**过程为我们提供了这样一个强大的模型 [@problem_id:2724589]。它将物种的演化模拟为一个包含四个参数的[连续时间过程](@entry_id:274437)：
-   [物种形成](@entry_id:147004)率（$\lambda$）
-   灭绝率（$\mu$）
-   化石采样率（$\psi$）
-   现代物种[采样率](@entry_id:264884)（$\rho$）

FBD模型的一个关键创新是，化石采样事件并不会终止一个谱系。这意味着一个谱系可以在被采样（形成化石）后继续存在、演化甚至再次分化。这自然地允许了**“采样祖先”（sampled ancestors）**的存在，即一个化石可以位于另一个化石或现存物种的直接祖先谱系上。在贝叶斯推断中，该模型能够优雅地整合化石的年代不确定性（通常由[地层学](@entry_id:189703)给出），通过在化石的可能年龄区间上进行积分来计算概率，而非简单地使用一个[点估计](@entry_id:174544)。一个化石是另一个化石祖先的[先验概率](@entry_id:275634)，会受到模型参数的影响：例如，更高的化石采样率（$\psi$）和[物种形成](@entry_id:147004)率（$\lambda$）会增加这种可能性，而更高的灭绝率（$\mu$）则会降低它。

**解释形态数据：[长枝吸引](@entry_id:141763)的危险**
化石通常只提供形态数据，而对形态数据的[系统发育分析](@entry_id:172534)也面临着独特的挑战。一个主要的系统性偏差来源是**[长枝吸引](@entry_id:141763)（Long-Branch Attraction, LBA）**。当一棵树中包含两个或多个不相关但演化迅速（即分支很长）的谱系时，它们会因为独立地积累了大量性状变化而看起来彼此相似。像**[最大简约法](@entry_id:168212)（Maximum Parsimony）**这样的方法可能会错误地将这些趋同演化的变化解释为共享的衍生性状，从而将这些长枝错误地聚集在一起。

以**弗洛勒斯人（*Homo floresiensis*）**为例，其独特的矮小体型和混合的形态特征导致其[系统发育](@entry_id:137790)位置充满争议。如果弗洛勒斯人谱系（由于岛屿矮化等因素）和某个遥远的、同样具有许多独特衍生特征的古老人族谱系都经历了快速的形态演化，那么当分析只使用快速演化的形态性状时，LBA就可能导致弗洛勒斯人被错误地与那个遥远的谱系归为一类，而不是其真正近亲 [@problem_id:2724613]。减轻LBA的策略包括：
-   增加分类单元采样，特别是那些能够打断长枝的中间谱系。
-   纳入演化速率更慢、更保守的性状，它们在长枝上不易饱和。
-   使用基于模型的推断方法（如最大似然法或贝叶斯推断），并采用能够解释性状间[速率异质性](@entry_id:149577)的模型（如带有Gamma[分布](@entry_id:182848)速率变化的Mk模型）。

#### [化石记录](@entry_id:136693)的系统性偏差：[埋藏学](@entry_id:271145)案例

最后，我们必须认识到，我们赖以为生的[化石记录](@entry_id:136693)本身并非对过去的无偏采样。**[埋藏学](@entry_id:271145)（taphonomy）**研究的是从死亡到发现之间发生的一切过程，这些过程会引入强烈的系统性偏差。

以更新世人族化石的身体大小研究为例。化石样本不成比例地来自洞穴环境，而洞穴环境可能偏向于保存体型较大的个体（例如，骨骼更粗壮、更不易被破坏）。假设这种偏差可以被模型化为：一个个体进入洞穴化石记录的概率与其身体质量$M$的某个幂次$M^{\alpha}$（$\alpha  0$）成正比。

现在，假设我们想要研究身体大小随时间的变化趋势。如果在不同时间段，我们样本中来自洞穴的化石比例$f_t$发生了变化，这就会产生一个完全人为的趋势。具体来说，一个时间段内观测到的平均对数体型可以表示为：$\mu_{t, \text{obs}} = \mu_t + f_t \alpha \sigma^2$，其中$\mu_t$是真实平均值，$\sigma^2$是群体内的[方差](@entry_id:200758)。即使真实的平均体型$\mu_t$保持不变，仅仅因为“早期”样本中洞穴化石比例$f_{\text{early}}$高于“晚期”样本$f_{\text{late}}$，观测到的平均体型就会呈现出从大到小的虚假趋势。更严重的是，这种偏差甚至可以掩盖甚至逆转一个真实的趋势。例如，如果真实的体型趋势是逐渐增大的，但同时洞穴化石的比例急剧下降，最终观测到的结果可能是一个看似不变甚至减小的体型趋势 [@problem_id:2724561]。这个例子深刻地提醒我们，在解释任何来自化石记录的宏观演化模式之前，都必须审慎地评估和校正潜在的[采样偏差](@entry_id:193615)。