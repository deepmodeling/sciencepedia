{"hands_on_practices": [{"introduction": "竞争实验是实验进化的基石，用于量化不同基因型之间的适应性差异。其基本原理是通过追踪竞争菌株在一段时间内的频率变化来估算选择系数 $s$。本练习将指导你推导出 $s$ 的标准估计量，以及至关重要的、由抽样引起的估计方差，这是解读任何实验结果的一项关键技能 [@problem_id:2712517]。", "problem": "在一项分批培养实验进化分析中，两个分别表示为 $A$ 和 $B$ 的无性繁殖菌株，在恒定条件下竞争 $t$ 代。假设每个菌株每代都具有恒定的马尔萨斯适应度，分别表示为 $m_A$ 和 $m_B$，并且确定性种群动态遵循指数增长，因此期望丰度满足 $N_A(t) = N_A(0)\\exp(m_A t)$ 和 $N_B(t) = N_B(0)\\exp(m_B t)$。将每代的选择系数定义为 $s = m_A - m_B$。在时间 $0$ 和时间 $t$，你使用流式细胞术对混合均匀的大体积等分样本进行测量，得到菌株的相对丰度。在时间 $0$，从总共 $N_0 = A_0 + B_0$ 个事件中获得计数 $(A_0,B_0)$；在时间 $t$，从总共 $N_t = A_t + B_t$ 个事件中获得计数 $(A_t,B_t)$。将每个时间点的细胞术取样建模为从真实潜在频率 $p_\\tau = N_A(\\tau)/[N_A(\\tau)+N_B(\\tau)]$ 中进行的独立二项式抽取，样本量为 $N_\\tau$，即，对于 $\\tau \\in \\{0,t\\}$，$A_\\tau \\sim \\mathrm{Binomial}(N_\\tau, p_\\tau)$，且 $B_\\tau = N_\\tau - A_\\tau$。\n\n从这些假设以及选择系数是马尔萨斯参数之差的定义出发，推导：\n- 一个以观测计数 $(A_0,B_0,A_t,B_t)$ 和已知代数 $t$ 表示的闭式估计量 $\\hat{s}$，以及\n- 一个对 $\\mathrm{Var}(\\hat{s})$ 的一阶delta方法近似，该近似考虑了时间 $0$ 和 $t$ 的细胞术计数中的取样方差。\n\n陈述你所使用的任何正则性假设，并对任何未知的讨厌参数使用代入法。以精确的解析表达式形式提供你的最终答案。以每代为单位表示 $s$。最终的方框答案中不要包含单位。如果你选择呈现多个表达式，请将它们表示为单个行向量。", "solution": "该问题要求从一个竞争性生长和二项式取样的模型中，推导出选择系数的估计量 $\\hat{s}$ 及其方差 $\\mathrm{Var}(\\hat{s})$ 的一阶近似。\n\n我们首先验证问题陈述。\n**第 1 步：提取已知条件**\n- 菌株：$A$ 和 $B$，无性繁殖。\n- 竞争时间：$t$ 代。\n- 马尔萨斯适应度参数：$m_A$, $m_B$。\n- 种群动态：$N_A(t) = N_A(0)\\exp(m_A t)$ 和 $N_B(t) = N_B(0)\\exp(m_B t)$。\n- 选择系数：$s = m_A - m_B$。\n- 观测计数：在时间 $\\tau=0$ 时，从大小为 $N_0 = A_0 + B_0$ 的样本中得到 $(A_0, B_0)$；在时间 $\\tau=t$ 时，从大小为 $N_t = A_t + B_t$ 的样本中得到 $(A_t, B_t)$。\n- 取样模型：对于 $\\tau \\in \\{0,t\\}$，$A_\\tau \\sim \\mathrm{Binomial}(N_\\tau, p_\\tau)$，其中 $p_\\tau = N_A(\\tau) / (N_A(\\tau)+N_B(\\tau))$ 是菌株 $A$ 在时间 $\\tau$ 的真实频率。两个样本是独立的。\n- 任务：推导一个以 $(A_0, B_0, A_t, B_t, t)$ 表示的闭式估计量 $\\hat{s}$，并使用delta方法和针对未知参数的代入法来近似 $\\mathrm{Var}(\\hat{s})$。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了种群遗传学和实验进化中的标准模型（指数增长、马尔萨斯适应度、二项式取样）。该问题是适定的，为获得唯一解提供了足够的信息。语言客观、精确。这些假设虽然是对现实的简化，但在许多微生物进化实验的背景下是标准且合理的。该问题并非无足轻重，需要严格应用统计理论。因此，该问题被认为是有效的。\n\n**第 3 步：进行求解**\n\n**估计量 $\\hat{s}$ 的推导**\n\n两种菌株的种群动态由下式给出：\n$$N_A(t) = N_A(0)\\exp(m_A t)$$\n$$N_B(t) = N_B(0)\\exp(m_B t)$$\n我们考虑在时间 $t$ 两种菌株的丰度之比：\n$$ \\frac{N_A(t)}{N_B(t)} = \\frac{N_A(0)\\exp(m_A t)}{N_B(0)\\exp(m_B t)} = \\frac{N_A(0)}{N_B(0)} \\exp\\left( (m_A - m_B)t \\right) $$\n使用选择系数的定义 $s = m_A - m_B$，我们有：\n$$ \\frac{N_A(t)}{N_B(t)} = \\frac{N_A(0)}{N_B(0)} \\exp(st) $$\n为了找到 $s$ 的表达式，我们对该方程进行重排并取自然对数：\n$$ \\exp(st) = \\frac{N_A(t)/N_B(t)}{N_A(0)/N_B(0)} $$\n$$ st = \\ln\\left( \\frac{N_A(t)/N_B(t)}{N_A(0)/N_B(0)} \\right) = \\ln\\left(\\frac{N_A(t)}{N_B(t)}\\right) - \\ln\\left(\\frac{N_A(0)}{N_B(0)}\\right) $$\n因此，选择系数由下式给出：\n$$ s = \\frac{1}{t} \\left[ \\ln\\left(\\frac{N_A(t)}{N_B(t)}\\right) - \\ln\\left(\\frac{N_A(0)}{N_B(0)}\\right) \\right] $$\n该方程将 $s$ 与真实的、未观测到的种群比率联系起来。我们必须根据观测到的计数构建一个估计量。时间 $\\tau$ 的真实比率可以用真实频率 $p_\\tau = N_A(\\tau) / (N_A(\\tau) + N_B(\\tau))$ 表示为 $N_A(\\tau)/N_B(\\tau) = p_\\tau/(1-p_\\tau)$。我们使用流式细胞术数据中的样本频率来估计这些真实频率：\n$$ \\hat{p}_0 = \\frac{A_0}{N_0} = \\frac{A_0}{A_0+B_0} \\quad \\text{和} \\quad \\hat{p}_t = \\frac{A_t}{N_t} = \\frac{A_t}{A_t+B_t} $$\n相应的估计比率为：\n$$ \\frac{\\hat{p}_0}{1-\\hat{p}_0} = \\frac{A_0/N_0}{B_0/N_0} = \\frac{A_0}{B_0} \\quad \\text{和} \\quad \\frac{\\hat{p}_t}{1-\\hat{p}_t} = \\frac{A_t/N_t}{B_t/N_t} = \\frac{A_t}{B_t} $$\n使用代入原则（plug-in principle），我们将这些估计值代入 $s$ 的方程中，得到估计量 $\\hat{s}$：\n$$ \\hat{s} = \\frac{1}{t} \\left[ \\ln\\left(\\frac{A_t}{B_t}\\right) - \\ln\\left(\\frac{A_0}{B_0}\\right) \\right] $$\n这可以更紧凑地写作：\n$$ \\hat{s} = \\frac{1}{t} \\ln\\left( \\frac{A_t B_0}{A_0 B_t} \\right) $$\n此估计量的一个正则性假设是，所有计数 $A_0, B_0, A_t, B_t$ 必须严格为正，这样对数才有定义。\n\n**方差近似 $\\mathrm{Var}(\\hat{s})$ 的推导**\n\n我们使用delta方法来近似 $\\hat{s}$ 的方差。估计量 $\\hat{s}$ 是随机变量 $A_0$ 和 $A_t$ 的函数（因为 $B_0=N_0-A_0$ 且 $B_t=N_t-A_t$，其中 $N_0$ 和 $N_t$ 是固定的样本量）。我们定义函数 $g(x,y)$：\n$$ g(x,y) = \\frac{1}{t} \\left[ \\ln\\left(\\frac{y}{N_t-y}\\right) - \\ln\\left(\\frac{x}{N_0-x}\\right) \\right] $$\n所以，$\\hat{s} = g(A_0, A_t)$。根据问题陈述，$A_0$ 和 $A_t$ 是独立的随机变量。根据delta方法，$\\hat{s}$ 的方差近似为：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\left( \\frac{\\partial g}{\\partial x} \\right)^2 \\mathrm{Var}(A_0) + \\left( \\frac{\\partial g}{\\partial y} \\right)^2 \\mathrm{Var}(A_t) $$\n其中，偏导数在 $A_0$ 和 $A_t$ 的期望值处求值，即 $\\mathrm{E}[A_0] = N_0 p_0$ 和 $\\mathrm{E}[A_t] = N_t p_t$。\n\n首先，我们计算 $g(x,y) = \\frac{1}{t} [ \\ln(y) - \\ln(N_t-y) - \\ln(x) + \\ln(N_0-x) ]$ 的偏导数：\n$$ \\frac{\\partial g}{\\partial x} = \\frac{1}{t} \\left[ -\\frac{1}{x} + \\frac{1}{N_0-x} \\right] = \\frac{1}{t} \\frac{-N_0+x-x}{x(N_0-x)} = -\\frac{N_0}{t x (N_0-x)} $$\n$$ \\frac{\\partial g}{\\partial y} = \\frac{1}{t} \\left[ \\frac{1}{y} - \\frac{-1}{N_t-y} \\right] = \\frac{1}{t} \\frac{N_t-y+y}{y(N_t-y)} = \\frac{N_t}{t y (N_t-y)} $$\n接下来，我们在 $x=\\mathrm{E}[A_0]=N_0 p_0$ 和 $y=\\mathrm{E}[A_t]=N_t p_t$ 处计算这些导数的值：\n$$ \\left. \\frac{\\partial g}{\\partial x} \\right|_{x=N_0 p_0} = -\\frac{N_0}{t (N_0 p_0) (N_0 - N_0 p_0)} = -\\frac{1}{t N_0 p_0 (1-p_0)} $$\n$$ \\left. \\frac{\\partial g}{\\partial y} \\right|_{y=N_t p_t} = \\frac{N_t}{t (N_t p_t) (N_t - N_t p_t)} = \\frac{1}{t N_t p_t (1-p_t)} $$\n二项随机变量的方差为 $\\mathrm{Var}(A_0) = N_0 p_0 (1-p_0)$ 和 $\\mathrm{Var}(A_t) = N_t p_t (1-p_t)$。\n将这些代入delta方法的公式中：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\left( -\\frac{1}{t N_0 p_0 (1-p_0)} \\right)^2 [N_0 p_0 (1-p_0)] + \\left( \\frac{1}{t N_t p_t (1-p_t)} \\right)^2 [N_t p_t (1-p_t)] $$\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2 N_0 p_0 (1-p_0)} + \\frac{1}{t^2 N_t p_t (1-p_t)} = \\frac{1}{t^2} \\left[ \\frac{1}{N_0 p_0 (1-p_0)} + \\frac{1}{N_t p_t (1-p_t)} \\right] $$\n这个近似值取决于未知的真实频率 $p_0$ 和 $p_t$。按照指示，我们使用代入法，用它们的样本估计值 $\\hat{p}_0 = A_0/N_0$ 和 $\\hat{p}_t = A_t/N_t$ 来替换真实频率。这就得到了方差的一个估计量，为简单起见，我们仍将其表示为 $\\mathrm{Var}(\\hat{s})$。\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2} \\left[ \\frac{1}{N_0 \\hat{p}_0 (1-\\hat{p}_0)} + \\frac{1}{N_t \\hat{p}_t (1-\\hat{p}_t)} \\right] $$\n我们来简化括号中的项：\n$$ \\frac{1}{N_0 \\hat{p}_0 (1-\\hat{p}_0)} = \\frac{1}{N_0 (A_0/N_0) (B_0/N_0)} = \\frac{N_0}{A_0 B_0} = \\frac{A_0+B_0}{A_0 B_0} = \\frac{1}{A_0} + \\frac{1}{B_0} $$\n类似地，对于时间 $t$ 的项：\n$$ \\frac{1}{N_t \\hat{p}_t (1-\\hat{p}_t)} = \\frac{1}{A_t} + \\frac{1}{B_t} $$\n将这些代回，我们得到以观测计数表示的方差近似的最终表达式：\n$$ \\mathrm{Var}(\\hat{s}) \\approx \\frac{1}{t^2} \\left( \\frac{1}{A_0} + \\frac{1}{B_0} + \\frac{1}{A_t} + \\frac{1}{B_t} \\right) $$\n该表达式代表了我们的估计量 $\\hat{s}$ 的估计方差。\n因此，两个所要求的表达式都已推导得出。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{t} \\ln\\left(\\frac{A_t B_0}{A_0 B_t}\\right)  \\frac{1}{t^2} \\left( \\frac{1}{A_0} + \\frac{1}{B_0} + \\frac{1}{A_t} + \\frac{1}{B_t} \\right) \\end{pmatrix} } $$", "id": "2712517"}, {"introduction": "连续传代培养是研究长期进化的常用方法，但该过程会引入周期性的人口瓶颈。瓶颈大小的波动（例如，由于移液误差）会影响长期有效种群大小 $N_e$。本练习阐明了一个重要原则：在这种情况下，$N_e$ 由瓶颈大小的调和平均数而非算术平均数决定。通过这项实践，你将学会分析看似微小的实验噪声如何导致对关键进化参数估计的系统性偏差，并学习如何用数学方法量化这种偏差 [@problem_id:2712475]。", "problem": "在一项无性微生物的每日连续传代实验中，每天 $t$ 通过移液操作施加一个大小为 $N_{b}(t)$ 的瓶颈，随后是一个大的扩增阶段，该阶段相对于瓶颈事件对遗传漂变的贡献不显著。假设每日的瓶颈大小 $N_{b}(t)$ 是独立同分布的，具有有限均值 $\\mu \\equiv \\mathbb{E}[N_{b}]$ 和方差 $\\sigma^{2} \\equiv \\operatorname{Var}(N_{b})$，并且变异系数的平方 $c_{v}^{2} \\equiv \\sigma^{2}/\\mu^{2}$ 很小。在 $T$ 次离散的每日传代中（其中 $T \\gg 1$ 且世代不重叠），一个经过充分检验的事实是：对于时变的普查规模，近交有效种群大小（记为 $N_{e}$）是每日普查规模随时间变化的调和平均数。\n\n一位研究者错误地使用算术平均数 $\\widehat{N}_{e}^{\\,\\text{arith}} \\equiv \\frac{1}{T}\\sum_{t=1}^{T} N_{b}(t)$ 来估计 $N_{e}$，而根据这些假设，正确的估计量是调和平均数 $\\widehat{N}_{e}^{\\,\\text{harm}} \\equiv \\left(\\frac{1}{T}\\sum_{t=1}^{T} \\frac{1}{N_{b}(t)}\\right)^{-1}$。根据大数定律，在极限 $T \\to \\infty$ 时，它们分别几乎必然地收敛于 $\\mu$ 和 $\\left(\\mathbb{E}[1/N_{b}]\\right)^{-1}$。\n\n仅使用上述基本原理和关于 $c_{v}^{2}$ 的二阶展开，推导算术平均估计量相对于真实有效大小的主导阶相对偏差，\n$$\n\\beta \\equiv \\frac{\\widehat{N}_{e}^{\\,\\text{arith}} - \\widehat{N}_{e}^{\\,\\text{harm}}}{\\widehat{N}_{e}^{\\,\\text{harm}}},\n$$\n并将其表示为 $\\mu$ 和 $\\sigma^{2}$ 的闭式函数。请以简化的解析表达式给出您的最终答案。无需进行数值四舍五入。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个群体遗传学中的标准情景，并要求基于既定的数学原理进行推导。因此，该问题是有效的，我们可以开始求解。\n\n问题要求计算有效种群大小的算术平均估计量 $\\widehat{N}_{e}^{\\,\\text{arith}}$ 相对于正确的调和平均估计量 $\\widehat{N}_{e}^{\\,\\text{harm}}$ 的相对偏差 $\\beta$。偏差的定义如下：\n$$\n\\beta = \\frac{\\widehat{N}_{e}^{\\,\\text{arith}} - \\widehat{N}_{e}^{\\,\\text{harm}}}{\\widehat{N}_{e}^{\\,\\text{harm}}}\n$$\n问题考虑了大量传代次数的极限情况，即 $T \\to \\infty$。在此极限下，根据大数定律，样本均值几乎必然收敛于真实期望值。\n瓶颈大小的算术平均值收敛于瓶颈大小的期望值：\n$$\n\\widehat{N}_{e}^{\\,\\text{arith}} = \\frac{1}{T}\\sum_{t=1}^{T} N_{b}(t) \\xrightarrow[T\\to\\infty]{a.s.} \\mathbb{E}[N_{b}] = \\mu\n$$\n调和平均估计量是倒数的算术平均值的倒数。因此，它收敛于瓶颈大小倒数的期望值的倒数：\n$$\n\\widehat{N}_{e}^{\\,\\text{harm}} = \\left(\\frac{1}{T}\\sum_{t=1}^{T} \\frac{1}{N_{b}(t)}\\right)^{-1} \\xrightarrow[T\\to\\infty]{a.s.} \\left(\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right]\\right)^{-1}\n$$\n将这些渐近值代入相对偏差 $\\beta$ 的表达式中，我们得到：\n$$\n\\beta = \\frac{\\mu - \\left(\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right]\\right)^{-1}}{\\left(\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right]\\right)^{-1}} = \\mu \\cdot \\mathbb{E}\\left[\\frac{1}{N_{b}}\\right] - 1\n$$\n核心任务是找到 $\\mathbb{E}[1/N_{b}]$ 项的近似值。问题指定使用二阶展开，其合理性基于变异系数的平方 $c_{v}^{2} = \\sigma^{2}/\\mu^{2}$ 很小的假设。这意味着随机变量 $N_{b}$ 不会显著偏离其均值 $\\mu$。\n\n我们对函数 $f(x) = 1/x$ 在点 $x = \\mu$ 附近进行泰勒级数展开。展开到二阶项的一般形式为：\n$$\nf(x) \\approx f(\\mu) + f'(\\mu)(x - \\mu) + \\frac{f''(\\mu)}{2!}(x - \\mu)^{2}\n$$\n我们计算该函数及其前两阶导数在 $x = \\mu$ 处的值：\n-   $f(x) = x^{-1} \\implies f(\\mu) = \\mu^{-1} = \\frac{1}{\\mu}$\n-   $f'(x) = -x^{-2} \\implies f'(\\mu) = -\\mu^{-2} = -\\frac{1}{\\mu^{2}}$\n-   $f''(x) = 2x^{-3} \\implies f''(\\mu) = 2\\mu^{-3} = \\frac{2}{\\mu^{3}}$\n\n将这些代入随机变量 $N_b$ 的函数 $f(N_b)$ 的展开式中：\n$$\n\\frac{1}{N_{b}} \\approx \\frac{1}{\\mu} - \\frac{1}{\\mu^{2}}(N_{b} - \\mu) + \\frac{1}{2!} \\left(\\frac{2}{\\mu^{3}}\\right) (N_{b} - \\mu)^{2}\n$$\n$$\n\\frac{1}{N_{b}} \\approx \\frac{1}{\\mu} - \\frac{N_{b} - \\mu}{\\mu^{2}} + \\frac{(N_{b} - \\mu)^{2}}{\\mu^{3}}\n$$\n为了求期望 $\\mathbb{E}[1/N_{b}]$，我们对该近似式的两边取期望。根据期望算子的线性性：\n$$\n\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right] \\approx \\mathbb{E}\\left[\\frac{1}{\\mu} - \\frac{N_{b} - \\mu}{\\mu^{2}} + \\frac{(N_{b} - \\mu)^{2}}{\\mu^{3}}\\right]\n$$\n$$\n\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right] \\approx \\frac{1}{\\mu} - \\frac{1}{\\mu^{2}}\\mathbb{E}[N_{b} - \\mu] + \\frac{1}{\\mu^{3}}\\mathbb{E}[(N_{b} - \\mu)^{2}]\n$$\n根据定义，与均值的偏差的期望为零，而与均值的偏差的平方的期望是方差：\n-   $\\mathbb{E}[N_{b} - \\mu] = \\mathbb{E}[N_{b}] - \\mu = \\mu - \\mu = 0$\n-   $\\mathbb{E}[(N_{b} - \\mu)^{2}] = \\operatorname{Var}(N_{b}) = \\sigma^{2}$\n\n将这些结果代入 $\\mathbb{E}[1/N_{b}]$ 的表达式中，得到二阶近似：\n$$\n\\mathbb{E}\\left[\\frac{1}{N_{b}}\\right] \\approx \\frac{1}{\\mu} - \\frac{0}{\\mu^{2}} + \\frac{\\sigma^{2}}{\\mu^{3}} = \\frac{1}{\\mu} + \\frac{\\sigma^{2}}{\\mu^{3}}\n$$\n现在，我们将此近似值代回相对偏差 $\\beta$ 的表达式中：\n$$\n\\beta \\approx \\mu \\left(\\frac{1}{\\mu} + \\frac{\\sigma^{2}}{\\mu^{3}}\\right) - 1\n$$\n将因子 $\\mu$ 分配进去：\n$$\n\\beta \\approx \\left(\\mu \\cdot \\frac{1}{\\mu}\\right) + \\left(\\mu \\cdot \\frac{\\sigma^{2}}{\\mu^{3}}\\right) - 1\n$$\n$$\n\\beta \\approx 1 + \\frac{\\sigma^{2}}{\\mu^{2}} - 1\n$$\n简化该表达式得到主导阶相对偏差：\n$$\n\\beta \\approx \\frac{\\sigma^{2}}{\\mu^{2}}\n$$\n这个结果是变异系数的平方 $c_{v}^{2}$，这与问题的前提（即该量很小）相符，从而证明了截断泰勒级数的合理性。最终答案用给定的参数 $\\mu$ 和 $\\sigma^{2}$ 表示。", "answer": "$$\n\\boxed{\\frac{\\sigma^{2}}{\\mu^{2}}}\n$$", "id": "2712475"}, {"introduction": "现代实验进化严重依赖于测序技术（即“进化与重测序”方法）来测量等位基因频率的变化。然而，数据生成过程中的聚合酶链式反应（PCR）步骤可能引入显著的“彩票效应”（jackpotting）噪声，即随机的早期扩增事件会不成比例地放大某些DNA模板，从而夸大频率估计的方差。本练习将引导你通过一个数学模型来理解PCR彩票效应的影响，并展示独特分子标识符（UMI）技术如何减轻这个问题，从而提高测量的准确性 [@problem_id:2712500]。", "problem": "在一项实验进化研究中，您对一个混合群体进行测序，以估计一个目标基因变异的频率。脱氧核糖核酸 (DNA) 分子首先通过聚合酶链式反应 (PCR) 进行扩增，然后进行深度测序。由于随机的早期循环扩增变异（PCR jackpotting），不同的输入模板分子会产生数量差异极大的扩增拷贝。您考虑使用独特分子标识符 (UMI) 来纠正此问题，UMI 可以将 PCR 重复序列合并到不同的输入模板水平。\n\n假设存在以下生成模型。有 $N_{0}$ 个输入模板分子，由 $i \\in \\{1,\\dots,N_{0}\\}$ 索引。每个模板要么是目标变异 ($X_{i}=1$)，要么是参考序列 ($X_{i}=0$)，其中 $X_{i} \\sim \\mathrm{Bernoulli}(p)$ 独立分布，未知真实变异分数 $p \\in (0,1)$。在给定 $X_{i}$ 的条件下，每个模板 $i$ 会产生随机数量 $K_{i}$ 的 PCR 扩增分子；通过将 $K_{i}$ 视为独立同分布且具有有限均值 $\\mu_{K}=\\mathbb{E}[K_{i}]$ 和方差 $\\sigma_{K}^{2}=\\mathrm{Var}(K_{i})$，并且独立于 $\\{X_{i}\\}$，来对 jackpotting 进行建模。令 $S=\\sum_{i=1}^{N_{0}} X_{i} K_{i}$ 为扩增的变异分子总数，令 $T=\\sum_{i=1}^{N_{0}} K_{i}$ 为扩增的分子总数。\n\n您进行饱和深度测序，使得来自测序的采样噪声相对于上游变异可以忽略不计，即在极大读数深度极限下，基于读数的朴素变异频率估计量为 $\\hat{q}=S/T$。在饱和覆盖度下（每个输入分子都被标记并至少被观察到一次）使用基于 UMI 的去重，校正后的估计量是携带变异的不同输入模板的比例，即 $\\hat{p}_{\\mathrm{UMI}}=N_{0}^{-1}\\sum_{i=1}^{N_{0}} X_{i}$。\n\n仅使用基本概率定义、独立性假设和对于大 $N_{0}$ 合理的一阶泰勒（delta 方法）近似，推导在 PCR jackpotting 下 $\\hat{q}$ 的主阶方差以及在完美 UMI 去重下 $\\hat{p}_{\\mathrm{UMI}}$ 的相应方差。将过离散降低因子定义为比率\n$$\n\\mathcal{R} \\equiv \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})} \\, .\n$$\n假设如上所述，$N_{0}$ 很大且读数深度是饱和的，那么仅用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示的 $\\mathcal{R}$ 的闭式解析表达式是什么？请提供 $\\mathcal{R}$ 的最终表达式；不需要进行数值计算，也不需要单位。", "solution": "必须首先严格验证问题陈述。\n\n步骤 1：提取已知条件。\n- $N_{0}$：输入模板分子的数量。\n- $i \\in \\{1, \\dots, N_{0}\\}$：分子的索引。\n- $X_{i}$：目标变异的指示变量，$X_{i}=1$ 如果是变异，$X_{i}=0$ 如果是参考序列。\n- 对于所有 $i$，$X_{i} \\sim \\mathrm{Bernoulli}(p)$ 独立分布。\n- $p \\in (0,1)$：目标变异的真实分数。\n- $K_{i}$：来自模板 $i$ 的 PCR 扩增分子的随机数量。\n- $\\{K_{i}\\}$ 是独立同分布 (i.i.d.) 的。\n- $\\mu_{K} = \\mathbb{E}[K_{i}]$：扩增计数的有限均值。\n- $\\sigma_{K}^{2} = \\mathrm{Var}(K_{i})$：扩增计数的有限方差。\n- 对于所有 $i, j$，$\\{K_{i}\\}$ 和 $\\{X_{j}\\}$ 相互独立。\n- $S = \\sum_{i=1}^{N_{0}} X_{i} K_{i}$：扩增的变异分子总数。\n- $T = \\sum_{i=1}^{N_{0}} K_{i}$：扩增的分子总数。\n- $\\hat{q} = S/T$：基于读数的朴素变异频率估计量。\n- $\\hat{p}_{\\mathrm{UMI}} = N_{0}^{-1}\\sum_{i=1}^{N_{0}} X_{i}$：UMI 校正的估计量。\n- 假设：$N_{0}$ 很大。\n- 假设：测序深度是饱和的，因此从扩增池中抽样不是误差的来源。\n- 任务：使用一阶泰勒（delta 方法）近似推导 $\\mathrm{Var}(\\hat{q})$。\n- 任务：推导 $\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})$。\n- 任务：计算比率 $\\mathcal{R} \\equiv \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})}$，用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，描述了定量测序中的一个标准且易于理解的问题（PCR jackpotting）以及一种常见的校正方法（UMI）。该概率模型是对此过程的常规且适当的形式化。问题提法明确，提供了所有必要的定义、假设（大 $N_{0}$、独立性）和明确的目标。它没有规定不足、自相矛盾或基于主观声明。推导需要概率论和近似方法的标准、非平凡的应用。问题有效。\n\n步骤 3：结论和行动。\n问题有效。我将继续进行推导。\n\n首先，我们推导基于 UMI 的估计量 $\\hat{p}_{\\mathrm{UMI}}$ 的方差。该估计量是 $N_{0}$ 个独立同分布的伯努利随机变量 $X_{i}$ 的样本均值。\n一个伯努利$(p)$随机变量的方差是 $p(1-p)$。\n$$\n\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}}) = \\mathrm{Var}\\left(\\frac{1}{N_{0}}\\sum_{i=1}^{N_{0}} X_{i}\\right)\n$$\n因为 $X_{i}$ 是独立的，所以和的方差是方差的和：\n$$\n\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}}) = \\frac{1}{N_{0}^{2}} \\sum_{i=1}^{N_{0}} \\mathrm{Var}(X_{i}) = \\frac{1}{N_{0}^{2}} \\cdot N_{0} \\cdot p(1-p) = \\frac{p(1-p)}{N_{0}}\n$$\n\n接下来，我们推导朴素估计量 $\\hat{q} = S/T$ 的方差。我们对两个随机变量的比率使用一阶泰勒展开（delta 方法），这对于大 $N_{0}$ 是一个有效的近似。令 $g(S, T) = S/T$。$\\hat{q}$ 的方差近似为：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\left(\\frac{\\partial g}{\\partial S}\\right)^2 \\mathrm{Var}(S) + \\left(\\frac{\\partial g}{\\partial T}\\right)^2 \\mathrm{Var}(T) + 2\\left(\\frac{\\partial g}{\\partial S}\\right)\\left(\\frac{\\partial g}{\\partial T}\\right) \\mathrm{Cov}(S, T)\n$$\n偏导数在 $S$ 和 $T$ 的期望值处计算。\n\n我们必须首先计算 $S$ 和 $T$ 的期望、方差和协方差。\n$T$ 的期望是：\n$$\n\\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{i=1}^{N_{0}} K_{i}\\right] = \\sum_{i=1}^{N_{0}} \\mathbb{E}[K_{i}] = N_{0}\\mu_{K}\n$$\n$S$ 的期望是：\n$$\n\\mathbb{E}[S] = \\mathbb{E}\\left[\\sum_{i=1}^{N_{0}} X_{i}K_{i}\\right] = \\sum_{i=1}^{N_{0}} \\mathbb{E}[X_{i}K_{i}]\n$$\n由于 $X_{i}$ 和 $K_{i}$ 的独立性，$\\mathbb{E}[X_{i}K_{i}] = \\mathbb{E}[X_{i}]\\mathbb{E}[K_{i}] = p\\mu_{K}$。\n$$\n\\mathbb{E}[S] = \\sum_{i=1}^{N_{0}} p\\mu_{K} = N_{0}p\\mu_{K}\n$$\n该比率的期望值近似为 $\\mathbb{E}[\\hat{q}] \\approx \\mathbb{E}[S]/\\mathbb{E}[T] = (N_{0}p\\mu_{K})/(N_{0}\\mu_{K}) = p$。\n\n$g(S,T)=S/T$ 的偏导数是：\n$$\n\\frac{\\partial g}{\\partial S} = \\frac{1}{T} \\quad \\implies \\quad \\left. \\frac{\\partial g}{\\partial S} \\right|_{\\mathbb{E}[S], \\mathbb{E}[T]} = \\frac{1}{N_{0}\\mu_{K}}\n$$\n$$\n\\frac{\\partial g}{\\partial T} = -\\frac{S}{T^{2}} \\quad \\implies \\quad \\left. \\frac{\\partial g}{\\partial T} \\right|_{\\mathbb{E}[S], \\mathbb{E}[T]} = -\\frac{N_{0}p\\mu_{K}}{(N_{0}\\mu_{K})^{2}} = -\\frac{p}{N_{0}\\mu_{K}}\n$$\n\n现在我们求方差和协方差。\n$T$ 的方差：由于 $K_{i}$ 是独立同分布的，\n$$\n\\mathrm{Var}(T) = \\mathrm{Var}\\left(\\sum_{i=1}^{N_{0}} K_{i}\\right) = \\sum_{i=1}^{N_{0}} \\mathrm{Var}(K_{i}) = N_{0}\\sigma_{K}^{2}\n$$\n$S$ 的方差：令 $Y_{i} = X_{i}K_{i}$。由于这些项是独立同分布的，$\\mathrm{Var}(S) = \\sum \\mathrm{Var}(Y_{i}) = N_{0}\\mathrm{Var}(Y_{1})$。我们使用全方差公式：$\\mathrm{Var}(Y_{i}) = \\mathbb{E}[\\mathrm{Var}(Y_{i}|X_{i})] + \\mathrm{Var}(\\mathbb{E}[Y_{i}|X_{i}])$。\n$$\n\\mathbb{E}[Y_{i}|X_{i}] = \\mathbb{E}[X_{i}K_{i}|X_{i}] = X_{i}\\mathbb{E}[K_{i}] = X_{i}\\mu_{K}\n$$\n$$\n\\mathrm{Var}(Y_{i}|X_{i}) = \\mathrm{Var}(X_{i}K_{i}|X_{i}) = X_{i}^{2}\\mathrm{Var}(K_{i}) = X_{i}\\sigma_{K}^{2} \\quad (\\text{因为对于伯努利分布有 } X_{i}^{2}=X_{i})\n$$\n所以，$\\mathbb{E}[\\mathrm{Var}(Y_{i}|X_{i})] = \\mathbb{E}[X_{i}\\sigma_{K}^{2}] = \\sigma_{K}^{2}\\mathbb{E}[X_{i}] = p\\sigma_{K}^{2}$。\n并且，$\\mathrm{Var}(\\mathbb{E}[Y_{i}|X_{i}]) = \\mathrm{Var}(X_{i}\\mu_{K}) = \\mu_{K}^{2}\\mathrm{Var}(X_{i}) = \\mu_{K}^{2}p(1-p)$。\n$$\n\\mathrm{Var}(Y_{i}) = p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)\n$$\n因此，$S$ 的方差是：\n$$\n\\mathrm{Var}(S) = N_{0}\\left(p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)\\right)\n$$\n$S$ 和 $T$ 的协方差：\n$$\n\\mathrm{Cov}(S, T) = \\mathrm{Cov}\\left(\\sum_{i=1}^{N_{0}} X_{i}K_{i}, \\sum_{j=1}^{N_{0}} K_{j}\\right) = \\sum_{i=1}^{N_{0}}\\sum_{j=1}^{N_{0}} \\mathrm{Cov}(X_{i}K_{i}, K_{j})\n$$\n对于 $i \\neq j$，$X_{i}K_{i}$ 和 $K_{j}$ 是独立的，所以 $\\mathrm{Cov}(X_{i}K_{i}, K_{j}) = 0$。我们只需要考虑 $i=j$ 的项。\n$$\n\\mathrm{Cov}(S, T) = \\sum_{i=1}^{N_{0}} \\mathrm{Cov}(X_{i}K_{i}, K_{i})\n$$\n我们计算 $\\mathrm{Cov}(X_{i}K_{i}, K_{i}) = \\mathbb{E}[X_{i}K_{i}^{2}] - \\mathbb{E}[X_{i}K_{i}]\\mathbb{E}[K_{i}]$。\n根据独立性，$\\mathbb{E}[X_{i}K_{i}^{2}] = \\mathbb{E}[X_{i}]\\mathbb{E}[K_{i}^{2}] = p(\\sigma_{K}^{2} + \\mu_{K}^{2})$。\n并且 $\\mathbb{E}[X_{i}K_{i}]\\mathbb{E}[K_{i}] = (p\\mu_{K})\\mu_{K} = p\\mu_{K}^{2}$。\n所以，$\\mathrm{Cov}(X_{i}K_{i}, K_{i}) = p(\\sigma_{K}^{2} + \\mu_{K}^{2}) - p\\mu_{K}^{2} = p\\sigma_{K}^{2}$。\n$$\n\\mathrm{Cov}(S, T) = \\sum_{i=1}^{N_{0}} p\\sigma_{K}^{2} = N_{0}p\\sigma_{K}^{2}\n$$\n\n现在将所有分量代入 delta 方法的 $\\mathrm{Var}(\\hat{q})$ 公式中：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\left(\\frac{1}{N_{0}\\mu_{K}}\\right)^{2}\\mathrm{Var}(S) + \\left(-\\frac{p}{N_{0}\\mu_{K}}\\right)^{2}\\mathrm{Var}(T) + 2\\left(\\frac{1}{N_{0}\\mu_{K}}\\right)\\left(-\\frac{p}{N_{0}\\mu_{K}}\\right)\\mathrm{Cov}(S, T)\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{(N_{0}\\mu_{K})^{2}} \\left[ \\mathrm{Var}(S) + p^{2}\\mathrm{Var}(T) - 2p\\mathrm{Cov}(S, T) \\right]\n$$\n代入方差和协方差的表达式：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}^{2}\\mu_{K}^{2}} \\left[ N_{0}(p\\sigma_{K}^{2} + \\mu_{K}^{2}p(1-p)) + p^{2}(N_{0}\\sigma_{K}^{2}) - 2p(N_{0}p\\sigma_{K}^{2}) \\right]\n$$\n从括号中提出因子 $N_{0}$：\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{N_{0}}{N_{0}^{2}\\mu_{K}^{2}} \\left[ (p\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2}) + p^{2}\\sigma_{K}^{2} - 2p^{2}\\sigma_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}\\mu_{K}^{2}} \\left[ p\\sigma_{K}^{2} - p^{2}\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{1}{N_{0}\\mu_{K}^{2}} \\left[ p(1-p)\\sigma_{K}^{2} + p(1-p)\\mu_{K}^{2} \\right]\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{p(1-p)}{N_{0}\\mu_{K}^{2}} \\left( \\sigma_{K}^{2} + \\mu_{K}^{2} \\right)\n$$\n$$\n\\mathrm{Var}(\\hat{q}) \\approx \\frac{p(1-p)}{N_{0}} \\left( 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}} \\right)\n$$\n\n最后，我们计算过离散降低因子 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\mathrm{Var}(\\hat{q})}{\\mathrm{Var}(\\hat{p}_{\\mathrm{UMI}})} \\approx \\frac{\\frac{p(1-p)}{N_{0}} \\left( 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}} \\right)}{\\frac{p(1-p)}{N_{0}}}\n$$\n$$\n\\mathcal{R} \\approx 1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}}\n$$\n这就是所要求的用 $\\mu_{K}$ 和 $\\sigma_{K}^{2}$ 表示的闭式表达式。它表示由于 PCR 扩增的随机性导致的方差膨胀，该膨胀由扩增拷贝数的变异系数的平方来量化。", "answer": "$$\\boxed{1 + \\frac{\\sigma_{K}^{2}}{\\mu_{K}^{2}}}$$", "id": "2712500"}]}