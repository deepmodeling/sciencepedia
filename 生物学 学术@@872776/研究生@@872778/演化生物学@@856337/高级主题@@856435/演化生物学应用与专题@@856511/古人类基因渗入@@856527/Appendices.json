{"hands_on_practices": [{"introduction": "在确定了古人类基因渗入的存在后，一个核心问题是：这次混合事件发生在多久以前？本练习将指导你运用一个基本原理来回答这个问题：随着世代更迭，重组会不断打断渗入的祖先染色体片段。因此，现今基因组中观察到的古人类DNA片段的平均长度，为我们提供了一个估算混合时间的分子钟。通过这个练习[@problem_id:2692279]，你将亲手实践如何利用这一原理，从经验数据中推断出古人类渗入事件的年代。", "problem": "一次单脉冲的古人类基因渗入事件发生于$t_a$代前，进入了一个解剖学现代人群体。在这次基因混合脉冲之后，每一代重组都会打断渗入的祖先片段，假设单位碱基的重组率$r$（单位为$\\text{bp}^{-1}\\text{gen}^{-1}$）是均一的，那么渗入片段的长度（以碱基对为单位）可以被建模为沿染色体的一个无记忆过程。给定从现今基因组中推断出的一组经过整理的渗入片段，其平均片段长度的经验估计值为 $\\bar{L} = 70$ kb，以及重组率为每代每碱基对 $r = 1.0 \\times 10^{-8}$。假设代际时间为$29$年。对个体和基因组区域进行的区块自助法分析得出，样本平均片段长度的估计方差为 $\\text{Var}[\\bar{L}] = 4.9 \\, \\text{kb}^2$。\n\n仅使用关于单次基因混合脉冲后$t_a$代内重组断点的基本群体遗传学推理，按以下步骤进行：\n\n- 用$\\bar{L}$和$r$推导出以代为单位的$t_a$的估计量，并计算其数值。\n- 使用给定的代际时间将点估计值转换为年。\n- 使用delta方法和提供的$\\text{Var}[\\bar{L}]$，计算$t_a$以代为单位的近似95%置信区间（CI），并将该区间转换为年。\n\n假设为单脉冲基因混合模型，空间上均一的重组率，且基因转换可忽略不计。将所有报告的数值四舍五入到三位有效数字。以代和年为单位表示时间估计（在计算过程中说明单位），但请注意，评分时只会检查纯数字。对于数值计算，请记住 $1$ kb $= 1000$ bp。", "solution": "所述问题具有科学依据，提法恰当且客观。它描述了群体遗传学中用于根据重组导致的祖先片段长度衰减来为基因混合事件定年的标准简化模型。所提供的参数是符合实际的，所要求的计算是标准的统计程序。因此，我们开始求解。\n\n基本原理是，源于$t_a$代前单次基因混合脉冲的渗入染色体片段的长度服从指数分布。这是因为将重组断点建模为沿染色体的泊松过程。设$r$为每代每碱基对的均一重组率。在$t_a$代中，终止一个祖先片段的断点的累积率为 $\\lambda = t_a r$。\n\n片段长度$L$的概率密度函数由$f(L) = \\lambda \\exp(-\\lambda L)$给出。来自此指数分布的片段的期望值（或平均长度）为 $E[L] = \\frac{1}{\\lambda}$。\n\n通过代入$\\lambda = t_a r$，我们得到平均片段长度与基因混合发生时间之间的关系：\n$$E[L] = \\frac{1}{t_a r}$$\n经验测量的平均片段长度$\\bar{L}$可作为真实总体均值$E[L]$的估计量。因此，我们可以写成$\\bar{L} \\approx \\frac{1}{t_a r}$。根据这个关系，我们推导出基因混合至今的代数$\\hat{t}_a$的估计量，它是可观测量$\\bar{L}$和固定参数$r$的函数：\n$$\\hat{t}_a = \\frac{1}{r \\bar{L}}$$\n这就是所要求的$t_a$的估计量。\n\n现在我们计算$t_a$的点估计值。给定值为$\\bar{L} = 70$ kb 和 $r = 1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}$。为保证量纲一致，我们必须使用换算关系 $1 \\text{ kb} = 1000 \\text{ bp}$ 将$\\bar{L}$表示为碱基对（bp）：\n$$\\bar{L} = 70 \\text{ kb} = 70 \\times 1000 \\text{ bp} = 7 \\times 10^4 \\text{ bp}$$\n将数值代入我们的估计量：\n$$\\hat{t}_a = \\frac{1}{(1.0 \\times 10^{-8} \\text{ bp}^{-1}\\text{gen}^{-1}) \\times (7 \\times 10^4 \\text{ bp})} = \\frac{1}{7 \\times 10^{-4}} \\text{ gen} \\approx 1428.57 \\text{ generations}$$\n四舍五入到三位有效数字，点估计值为 $\\hat{t}_a \\approx 1.43 \\times 10^3$ 代。\n\n为将此时间转换为年，我们使用指定的代际时间$29$年：\n$$\\text{Time in years} = \\hat{t}_a \\times 29 \\text{ years/gen} \\approx 1428.57 \\times 29 \\approx 41428.5 \\text{ years}$$\n四舍五入到三位有效数字，这对应于 $4.14 \\times 10^4$ 年。\n\n接下来，我们利用delta方法计算$t_a$的95%置信区间。delta方法可近似一个随机变量函数的方差。我们的估计量$\\hat{t}_a = g(\\bar{L}) = (r\\bar{L})^{-1}$是随机变量$\\bar{L}$的函数。$g(\\bar{L})$的方差近似为 $\\text{Var}[\\hat{t}_a] \\approx (g'(\\mu_{\\bar{L}}))^2 \\text{Var}[\\bar{L}]$，其中我们使用样本均值$\\bar{L}$作为其期望值$\\mu_{\\bar{L}}$的估计。$g(\\bar{L})$关于$\\bar{L}$的导数是：\n$$g'(\\bar{L}) = \\frac{d}{d\\bar{L}} \\left( \\frac{1}{r\\bar{L}} \\right) = -\\frac{1}{r\\bar{L}^2}$$\n因此，我们估计量的方差为：\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(-\\frac{1}{r\\bar{L}^2}\\right)^2 \\text{Var}[\\bar{L}] = \\frac{\\text{Var}[\\bar{L}]}{r^2\\bar{L}^4}$$\n这个表达式可以根据点估计值$\\hat{t}_a = \\frac{1}{r\\bar{L}}$重写为：\n$$\\text{Var}[\\hat{t}_a] \\approx \\left(\\frac{1}{r\\bar{L}}\\right)^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\hat{t}_a^2 \\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2}$$\n给定$\\text{Var}[\\bar{L}] = 4.9 \\, \\text{kb}^2$。$\\bar{L}$的变异系数的平方是：\n$$\\frac{\\text{Var}[\\bar{L}]}{\\bar{L}^2} = \\frac{4.9 \\, \\text{kb}^2}{(70 \\, \\text{kb})^2} = \\frac{4.9}{4900} = 0.001$$\n那么$\\hat{t}_a$的方差是：\n$$\\text{Var}[\\hat{t}_a] \\approx (1428.57 \\text{ gen})^2 \\times 0.001 \\approx 2040.8 \\text{ gen}^2$$\n估计值的标准误（SE）是其方差的平方根：\n$$SE(\\hat{t}_a) = \\sqrt{\\text{Var}[\\hat{t}_a]} \\approx \\sqrt{2040.8} \\approx 45.175 \\text{ generations}$$\n一个近似的95%置信区间由$\\hat{t}_a \\pm z_{0.025} \\times SE(\\hat{t}_a)$给出，其中$z_{0.025} \\approx 1.96$是来自标准正态分布的临界值。误差范围是 $1.96 \\times 45.175 \\approx 88.543$ 代。\n\n$t_a$以代为单位的95%置信区间是：\n$$[1428.57 - 88.543, \\quad 1428.57 + 88.543] = [1340.027, \\quad 1517.113] \\text{ generations}$$\n将边界四舍五入到三位有效数字，区间为 $[1.34 \\times 10^3, 1.52 \\times 10^3]$ 代。\n\n最后，我们将此区间通过将未四舍五入的边界乘以29年的代际时间来转换为年：\n$$\\text{Lower bound (years)}: 1340.027 \\times 29 \\approx 38860.8 \\text{ years}$$\n$$\\text{Upper bound (years)}: 1517.113 \\times 29 \\approx 43996.3 \\text{ years}$$\n四舍五入到三位有效数字，以年为单位的95%置信区间为 $[3.89 \\times 10^4, 4.40 \\times 10^4]$ 年。\n\n所要求的数值结果是基因混合时间的点估计值（以代和年为单位），以及相应的95%置信区间边界。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1.43 \\times 10^3  4.14 \\times 10^4  1.34 \\times 10^3  1.52 \\times 10^3  3.89 \\times 10^4  4.40 \\times 10^4\n\\end{pmatrix}\n}\n$$", "id": "2692279"}, {"introduction": "除了确定混合事件的时间，量化渗入的基因比例也同样至关重要。$f_4$-比率统计量是现代群体遗传学中用于估算混合比例（即古人类血统在现代人基因组中所占的份额）的强大工具。然而，一个可靠的估计必须伴随着对其不确定性的精确评估，尤其是在其分子和分母统计量相关的情况下。本练习[@problem_id:2692273]将让你运用多元delta方法，来处理这种相关性并计算混合比例估计的标准误，这是严谨的科学分析中不可或缺的一步。", "problem": "在一项关于古代人种基因渗入的研究中，考虑四群体统计量 $f_4(A,B;C,D)$，其定义为跨基因座的等位基因频率差异的期望乘积，$f_4(A,B;C,D) = \\mathbb{E}\\left[(p_A - p_B)(p_C - p_D)\\right]$，其中 $p_X$ 表示群体 $X$ 中的等位基因频率。对于一个测试群体 $T$、一个外群 $O$、一个尼安德特人参考样本 $N$、一个丹尼索瓦人参考样本 $D$，以及一个已知缺乏尼安德特人血统的现代人参考样本 $R$，尼安德特人混合比例的 $f_4$ 比率估计量定义为\n$$\n\\hat{\\alpha} \\equiv \\frac{\\widehat{f_4}(T,O;N,D)}{\\widehat{f_4}(R,O;N,D)} \\equiv \\frac{\\hat{f}_1}{\\hat{f}_2}.\n$$\n使用区块刀切法（BJ）对大的基因组片段进行分析，以估计向量 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ 的均值和 $2 \\times 2$ 协方差矩阵。BJ 估计值为：\n$$\n\\hat{f}_1 = 1.30 \\times 10^{-4}, \\qquad \\hat{f}_2 = 6.10 \\times 10^{-3},\n$$\n且\n$$\n\\widehat{\\Sigma} = \n\\begin{pmatrix}\n2.4 \\times 10^{-9}  -3.0 \\times 10^{-9} \\\\\n-3.0 \\times 10^{-9}  1.3 \\times 10^{-7}\n\\end{pmatrix}.\n$$\n使用随机变量光滑函数的误差传播基本原理，应用多变量德尔塔方法计算标准误 $\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})}$，并明确考虑 $\\hat{f}_1$ 和 $\\hat{f}_2$ 之间的协方差。你可以将 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$ 视为近似服从联合正态分布，其均值为 $(\\hat{f}_1,\\hat{f}_2)^{\\top}$，协方差为 $\\widehat{\\Sigma}$。\n\n仅报告标准误 $\\operatorname{se}(\\hat{\\alpha})$（无量纲）作为你的最终答案，四舍五入到三位有效数字。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含得出唯一解所需的所有信息。因此，该问题被视为有效。任务是使用多变量德尔塔方法计算比率估计量的标准误。\n\n令统计量向量为 $\\boldsymbol{\\theta} = (\\hat{f}_1, \\hat{f}_2)^{\\top}$。混合比例的估计量是这些统计量的函数，$\\hat{\\alpha} = g(\\boldsymbol{\\theta}) = g(\\hat{f}_1, \\hat{f}_2) = \\frac{\\hat{f}_1}{\\hat{f}_2}$。多变量德尔塔方法为随机变量光滑函数的方差提供了一阶近似。如果 $\\boldsymbol{\\theta}$ 是一个均值为 $\\boldsymbol{\\mu}$、协方差矩阵为 $\\Sigma$ 的随机向量，那么 $g(\\boldsymbol{\\theta})$ 的方差近似为：\n$$\n\\operatorname{Var}(g(\\boldsymbol{\\theta})) \\approx \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]^{\\top} \\Sigma \\left[ \\nabla g(\\boldsymbol{\\mu}) \\right]\n$$\n在这个问题中，我们使用估计的均值和协方差矩阵。均值由样本估计值近似，即 $\\boldsymbol{\\mu} \\approx (\\hat{f}_1, \\hat{f}_2)^{\\top}$，协方差矩阵为给定的 $\\widehat{\\Sigma}$。\n\n首先，我们计算函数 $g(x_1, x_2) = \\frac{x_1}{x_2}$ 的梯度。其偏导数为：\n$$\n\\frac{\\partial g}{\\partial x_1} = \\frac{1}{x_2}\n$$\n$$\n\\frac{\\partial g}{\\partial x_2} = -\\frac{x_1}{x_2^2}\n$$\n我们记梯度向量为 $\\mathbf{J}$，并在点 $(\\hat{f}_1, \\hat{f}_2)$ 处对其求值：\n$$\n\\mathbf{J} = \\nabla g(\\hat{f}_1, \\hat{f}_2) = \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\n那么，$\\hat{\\alpha}$ 的方差由以下二次型给出：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\mathbf{J}^{\\top} \\widehat{\\Sigma} \\mathbf{J} = \\begin{pmatrix} \\frac{1}{\\hat{f}_2}  -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix} \\widehat{\\Sigma} \\begin{pmatrix} \\frac{1}{\\hat{f}_2} \\\\ -\\frac{\\hat{f}_1}{\\hat{f}_2^2} \\end{pmatrix}\n$$\n设协方差矩阵的元素为 $\\widehat{\\Sigma} = \\begin{pmatrix} \\sigma_{11}  \\sigma_{12} \\\\ \\sigma_{21}  \\sigma_{22} \\end{pmatrix}$。注意 $\\sigma_{12} = \\sigma_{21}$。展开矩阵乘积可得到方差的表达式：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\left(\\frac{1}{\\hat{f}_2}\\right)^2 \\sigma_{11} + 2 \\left(\\frac{1}{\\hat{f}_2}\\right) \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right) \\sigma_{12} + \\left(-\\frac{\\hat{f}_1}{\\hat{f}_2^2}\\right)^2 \\sigma_{22}\n$$\n化简该表达式，我们得到：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{\\sigma_{11}}{\\hat{f}_2^2} - \\frac{2\\hat{f}_1\\sigma_{12}}{\\hat{f}_2^3} + \\frac{\\hat{f}_1^2\\sigma_{22}}{\\hat{f}_2^4}\n$$\n这可以用 $\\hat{\\alpha} = \\hat{f}_1/\\hat{f}_2$ 更紧凑地重写为：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\hat{f}_2^2} \\left( \\sigma_{11} - 2\\hat{\\alpha}\\sigma_{12} + \\hat{\\alpha}^2\\sigma_{22} \\right)\n$$\n我们已知以下数值：\n$\\hat{f}_1 = 1.30 \\times 10^{-4}$\n$\\hat{f}_2 = 6.10 \\times 10^{-3}$\n$\\sigma_{11} = 2.4 \\times 10^{-9}$\n$\\sigma_{12} = -3.0 \\times 10^{-9}$\n$\\sigma_{22} = 1.3 \\times 10^{-7}$\n\n首先，我们计算估计的混合比例 $\\hat{\\alpha}$：\n$$\n\\hat{\\alpha} = \\frac{\\hat{f}_1}{\\hat{f}_2} = \\frac{1.30 \\times 10^{-4}}{6.10 \\times 10^{-3}} = \\frac{1.30}{61.0} \\approx 0.021311475\n$$\n现在，将这些值代入方差公式：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{\\left(6.10 \\times 10^{-3}\\right)^2} \\left[ \\left(2.4 \\times 10^{-9}\\right) - 2\\left(\\frac{1.30}{61.0}\\right)\\left(-3.0 \\times 10^{-9}\\right) + \\left(\\frac{1.30}{61.0}\\right)^2\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{1}{3.721 \\times 10^{-5}} \\left[ 2.4 \\times 10^{-9} + \\left(\\frac{7.8}{61.0}\\right) \\times 10^{-9} + \\left(\\frac{1.69}{3721}\\right)\\left(1.3 \\times 10^{-7}\\right) \\right]\n$$\n为保持精度，我们提出因子 $10^{-9}$：\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-9}}{3.721 \\times 10^{-5}} \\left[ 2.4 + \\frac{7.8}{61.0} + \\frac{1.69 \\times 130}{3721} \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.4 + 0.1278688... + 0.0590432... \\right]\n$$\n$$\n\\operatorname{Var}(\\hat{\\alpha}) \\approx \\frac{10^{-4}}{3.721} \\left[ 2.586912... \\right] \\approx 0.695219... \\times 10^{-4} = 6.95219... \\times 10^{-5}\n$$\n标准误 $\\operatorname{se}(\\hat{\\alpha})$ 是方差的平方根：\n$$\n\\operatorname{se}(\\hat{\\alpha}) = \\sqrt{\\operatorname{Var}(\\hat{\\alpha})} \\approx \\sqrt{6.95219... \\times 10^{-5}} \\approx 0.00833798...\n$$\n按要求将结果四舍五入到三位有效数字，我们得到：\n$$\n\\operatorname{se}(\\hat{\\alpha}) \\approx 0.00834\n$$\n用科学记数法表示为 $8.34 \\times 10^{-3}$。", "answer": "$$\n\\boxed{8.34 \\times 10^{-3}}\n$$", "id": "2692273"}, {"introduction": "在群体遗传学推断中，一个深刻的挑战是“模型拟合”问题：不同的演化历史可能产生相似的遗传学统计信号。古人类基因渗入研究中的一个典型例子，就是深度祖先结构（即某些现代人群体与古人类共享了更近的共同祖先，但没有发生混合）有时会模仿近期基因渗入在$f$-统计量上的信号。本练习[@problem_id:2692318]将引导你构建这两个相互竞争的模型，并展示如何利用连锁不平衡（LD）的衰减模式——一种在两种情景下表现迥异的信号——来明确区分它们，从而解决这一关键的推断难题。", "problem": "要求您形式化两种替代的人口统计学模型，这两种模型在标准等位基因频率相关性统计下，会产生几乎无法区分的信号；并设计一个有原则的辅助统计量来区分它们。在Wright–Fisher模型的扩散极限下进行分析，采用高斯（布朗）近似来处理沿人口统计学图谱边缘的等位基因频率漂移，其方差的独立增量等于漂移长度。设一个群体的双等位基因位点上的等位基因频率被建模为从根到叶的路径上各边缘独立高斯增量的总和。对于脉冲式混合，假设在混合节点处，亲本等位基因频率随机变量呈线性混合。\n\n根据等位基因频率 $p_X$ 定义标准的 $f$-统计量（Reich等人）如下：\n- $f_2(X,Y) = \\mathbb{E}\\left[(p_X - p_Y)^2\\right]$,\n- $f_3(C;A,B) = \\mathbb{E}\\left[(p_C - p_A)(p_C - p_B)\\right]$,\n- $f_4(A,B;C,D) = \\mathbb{E}\\left[(p_A - p_B)(p_C - p_D)\\right]$。\n\n您将考虑四个标记的群体：一个外群 $O$，一个古人类 $N$，一个非洲群体 $A$ 和一个非非洲群体 $B$。漂移长度以方差沿边缘累加的单位表示（例如，$f_2$ 漂移单位）。\n\n模型 I（基因渗入模型）：一个对称的现代人框架，伴有一次古人类基因渗入到群体 $B$ 的脉冲事件。\n- 根分裂成通往 $N$ 和现代人祖先的谱系；共享的主干漂移长度为 $t_0$。\n- 谱系 $N$ 累积了额外的独特漂移 $n_U$ 直至现在。\n- 现代人祖先立即分裂成 $A$ 和 $B$（为简化起见，假设分裂后没有共享漂移）；$A$ 累积漂移 $a$ 直至现在，$B$ 在其未混合路径 $B_{\\mathrm{main}}$ 上累积漂移 $b$ 直至现在。\n- 在很近的过去，发生了一次来自 $N$ 到 $B$ 的比例为 $\\alpha$ 的脉冲式基因渗入，因此现今的 $B$ 随机变量为 $p_B = (1-\\alpha) p_{B_{\\mathrm{main}}} + \\alpha p_N$。\n- 外群 $O$ 是独立的，拥有自己的漂移方差 $o$，且与其他群体的协方差为零。\n\n模型 S（深层结构模型）：一个没有基因渗入的树状模型，其中 $B$ 和 $N$ 共享一个额外的内部分支，而 $A$ 不共享该分支。\n- 根分裂成两个分支：一个通往 $A$，另一个通往包含 $N$ 和 $B$ 的分支。共享的主干漂移长度为 $t_0$。\n- 在通往 $(N,B)$ 分支的路径上，有一个漂移长度为 $s_{\\mathrm{shared}}$ 的短内部片段，然后分裂成 $N$ 和 $B$；此后，$N$ 以独特的漂移 $n_U - s_{\\mathrm{shared}}$ 继续演化，以保持总的 $N$ 方差与模型 I 中相等；$B$ 以独特的漂移 $b_S$ 继续演化，$A$ 以独特的漂移 $a_S$ 继续演化。\n- 外群 $O$ 如上所述。\n- 为了使 $f$-统计量与模型 I 的结果紧密匹配，同时保持所有漂移为非负值，选择 $s_{\\mathrm{shared}} = \\alpha n_U$ 并设置 $a_S = a - \\tfrac{1}{2} s_{\\mathrm{shared}}$ 和 $b_S = b - \\tfrac{1}{2} s_{\\mathrm{shared}}$。\n\n任务：\n1) 使用带有线性混合的高斯漂移设置，推导在每种模型下 $(O,N,A,B)$ 之间的预期协方差矩阵，作为漂移参数的函数。然后使用这些协方差矩阵和 $f$-统计量的定义，计算在模型 I 和模型 S 下，对于四群体组 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$ 的 $f_4$-统计量三元组。按指定顺序将每个三元组表示为包含三个实数的向量。\n\n2) 计算这两个 $f_4$ 三元组之间差异（模型 I 减去模型 S）的欧几里得范数。\n\n3) 提出并形式化一个基于双位点混合连锁不平衡（LD）衰减的辅助统计量。使用以下原理：在过去 $t$ 代的单一脉冲混合 $\\alpha$ 事件下，遗传距离为 $d$ 摩根（Morgan）处的预期协方差按 $C(d) = A_0 \\exp(-2 r t d)$ 衰减，其中 $r$ 是每摩根的重组率，$A_0$ 是一个振幅。在没有近期脉冲事件的深层结构下，在相同的遗传距离尺度上，将预期协方差建模为 $C(d) = B_0$（近似平坦）。给定两个距离 $d_1$ 和 $d_2$（其中 $d_2 > d_1$），通过以下公式估算脉冲时间：\n$$\n\\widehat{t} = -\\frac{\\ln\\left(\\frac{C(d_2)}{C(d_1)}\\right)}{2 r (d_2 - d_1)}.\n$$\n采纳惯例，如果 $C(d_1) = C(d_2) = 0$，则 $\\widehat{t} = 0$。对于模型 I，设置 $C(d) = \\alpha(1-\\alpha)\\exp(-2 r t d)$；对于模型 S，设置 $C(d) = B_0$ 且常数 $B_0 > 0$（您的估计与 $B_0$ 无关）。报告每个模型的 $\\widehat{t}$。\n\n4) 决策规则：输出一个布尔值，如果辅助统计量能够区分这两个模型，则该值为真。此处定义为：对于模型 I 返回 $\\widehat{t} > 0$，对于模型 S 返回 $\\widehat{t} = 0$（在数值容差范围内）。\n\n测试套件和答案规范：\n- 使用以下三个参数集，每个参数集定义一个测试用例。在所有情况下，按顺序使用四群体组 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$。距离单位为摩根，重组率 $r$ 是每摩根。\n    - 案例 1：$t_0 = 0.1$，$n_U = 0.06$，$a = 0.02$，$b = 0.02$，$\\alpha = 0.02$，$o = 0.2$，$d_1 = 0.01$，$d_2 = 0.05$，$r = 1.0$，$t = 120$。\n    - 案例 2：$t_0 = 0.1$，$n_U = 0.08$，$a = 0.03$，$b = 0.018$，$\\alpha = 0.005$，$o = 0.2$，$d_1 = 0.005$，$d_2 = 0.05$，$r = 1.0$，$t = 300$。\n    - 案例 3：$t_0 = 0.1$，$n_U = 0.05$，$a = 0.02$，$b = 0.02$，$\\alpha = 0.0$，$o = 0.2$，$d_1 = 0.01$，$d_2 = 0.05$，$r = 1.0$，$t = 200$。\n\n- 单位和数值报告：\n    - 所有漂移长度（$t_0$、$n_U$、$a$、$b$、$o$）均以方差可加的漂移单位表示；辅助统计量要求 $d_1$ 和 $d_2$ 以摩根为单位，$r$ 以每摩根为单位，$t$ 以代为单位。\n    - 您的程序必须为每个测试用例计算一个列表 $[ \\Delta, \\widehat{t}_{\\mathrm{I}}, \\widehat{t}_{\\mathrm{S}}, \\text{disc} ]$，其中 $\\Delta$ 是两个 $f_4$ 三元组（模型 I 减去模型 S）差异的欧几里得范数，$\\widehat{t}_{\\mathrm{I}}$ 是模型 I 的估计时间，$\\widehat{t}_{\\mathrm{S}}$ 是模型 S 的估计时间，$\\text{disc}$ 是上面定义的布尔值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个按案例排列的列表，以逗号分隔，无空格，并用方括号括起来。例如，一个有效的形状是 $[[x_{11},x_{12},x_{13},b_1],[x_{21},x_{22},x_{23},b_2],[x_{31},x_{32},x_{33},b_3]]$，其中 $x_{ij}$ 是浮点数，$b_i$ 是布尔字面量。", "solution": "该问题要求我们形式化并区分两种用于古人类基因渗入的人口统计学模型，方法是使用群体遗传学统计量。问题陈述的验证已确认其科学合理性、一致性和适定性。我们可以着手解决。\n\n群体 $X$ 的等位基因频率 $p_X$ 被建模为从一个根频率（为计算 $f$-统计量，可不失一般性地设为0）开始的独立高斯增量之和。两个群体等位基因频率之间的协方差 $\\text{Cov}(p_X, p_Y)$ 是从根到它们最近共同祖先的共享路径上的总漂移长度。我们将此共享漂移表示为 $c(X,Y)$。方差 $\\text{Var}(p_X) = c(X,X)$ 是从根到 $X$ 的总漂移。$f$-统计量是根据等位基因频率差异乘积的期望值定义的，可以用协方差来表示。具体来说，$f_4(A,B;C,D) = \\mathbb{E}[(p_A - p_B)(p_C - p_D)] = c(A,C) - c(A,D) - c(B,C) + c(B,D)$。\n\n**第 1 部分：协方差矩阵和 $f_4$-统计量**\n\n首先，我们推导在每种模型下群体 $(O, N, A, B)$ 等位基因频率的协方差矩阵。外群 $O$ 在根部分裂，并且与所有其他群体独立，因此对于任何 $X \\neq O$，$c(O,X)=0$，且 $\\text{Var}(p_O) = o$。\n\n**模型 I：基因渗入模型**\n人口统计学图谱为 $((N, (A, B_{\\mathrm{main}})), O)$，并伴有一个创建了群体 $B$ 的近期混合事件。群体 $B$ 中的等位基因频率由 $p_B = (1-\\alpha) p_{B_{\\mathrm{main}}} + \\alpha p_N$ 给出。我们使用协方差算子的线性性质来计算涉及 $p_B$ 的协方差。\n\n非混合群体的基本协方差为：\n- $\\text{Var}(p_N) = c(N,N) = t_0 + n_U$\n- $\\text{Var}(p_A) = c(A,A) = t_0 + a$\n- $\\text{Var}(p_{B_{\\mathrm{main}}}) = c(B_{\\mathrm{main}},B_{\\mathrm{main}}) = t_0 + b$\n- $c(N,A) = c(N,B_{\\mathrm{main}}) = c(A,B_{\\mathrm{main}}) = t_0$\n\n混合群体 $B$ 的协方差为：\n- $\\text{Cov}(p_A, p_B) = \\text{Cov}(p_A, (1-\\alpha)p_{B_{\\mathrm{main}}} + \\alpha p_N) = (1-\\alpha)c(A, B_{\\mathrm{main}}) + \\alpha c(A,N) = (1-\\alpha)t_0 + \\alpha t_0 = t_0$。\n- $\\text{Cov}(p_N, p_B) = \\text{Cov}(p_N, (1-\\alpha)p_{B_{\\mathrm{main}}} + \\alpha p_N) = (1-\\alpha)c(N, B_{\\mathrm{main}}) + \\alpha \\text{Var}(p_N) = (1-\\alpha)t_0 + \\alpha(t_0+n_U) = t_0 + \\alpha n_U$。\n- 对于指定的 $f_4$ 统计量，不需要计算其他与 $p_B$ 相关的协方差。\n\n**模型 S：深层结构模型**\n人口统计学图谱为 $((A, (N,B)), O)$。这是一个没有混合的简单树状模型。参数被选择用来模仿模型 I：$s_{\\mathrm{shared}} = \\alpha n_U$，$a_S = a - \\frac{1}{2}s_{\\mathrm{shared}}$，以及 $b_S = b - \\frac{1}{2}s_{\\mathrm{shared}}$。\n\n协方差直接从树结构中读取：\n- $c(A,N) = t_0$\n- $c(A,B) = t_0$\n- $c(N,B) = t_0 + s_{\\mathrm{shared}} = t_0 + \\alpha n_U$\n\n现在，我们为两种模型计算 $f_4$-统计量三元组。所需的四群体组是 $(O,N;A,B)$、$(A,O;B,N)$ 和 $(A,B;O,N)$。\n\n1.  $f_4(O,N;A,B) = c(O,A) - c(O,B) - c(N,A) + c(N,B)$:\n    - 模型 I: $0 - 0 - t_0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    - 模型 S: $0 - 0 - t_0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    结果是相同的。\n\n2.  $f_4(A,O;B,N) = c(A,B) - c(A,N) - c(O,B) + c(O,N)$:\n    - 模型 I: $t_0 - t_0 - 0 + 0 = 0$。\n    - 模型 S: $t_0 - t_0 - 0 + 0 = 0$。\n    结果是相同的。\n\n3.  $f_4(A,B;O,N) = c(A,O) - c(A,N) - c(B,O) + c(B,N)$:\n    - 模型 I: $0 - t_0 - 0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    - 模型 S: $0 - t_0 - 0 + (t_0 + \\alpha n_U) = \\alpha n_U$。\n    结果是相同的。\n\n对于这两种模型， $f_4$ 统计量三元组都是 $(\\alpha n_U, 0, \\alpha n_U)$。这表明对于这一特定的统计量集合，这两种模型是无法区分的。\n\n**第 2 部分：差异的欧几里得范数**\n模型 I 的 $f_4$ 统计量向量是 $\\mathbf{F_I} = (\\alpha n_U, 0, \\alpha n_U)$，模型 S 的是 $\\mathbf{F_S} = (\\alpha n_U, 0, \\alpha n_U)$。差向量是 $\\mathbf{F_I} - \\mathbf{F_S} = (0, 0, 0)$。\n这个差的欧几里得范数 $\\Delta$ 是：\n$$\n\\Delta = \\sqrt{0^2 + 0^2 + 0^2} = 0\n$$\n\n**第 3 部分：基于连锁不平衡（LD）衰减的辅助统计量**\n提出的辅助统计量是基于连锁不平衡（LD）随遗传距离 $d$ 衰减的混合时间 $t$ 的估计量。\n$$\n\\widehat{t} = -\\frac{\\ln\\left(\\frac{C(d_2)}{C(d_1)}\\right)}{2 r (d_2 - d_1)}\n$$\n- **对于模型 I (基因渗入)**，混合连锁不平衡由 $C(d) = \\alpha(1-\\alpha)e^{-2rtd}$ 给出。\n  如果 $\\alpha \\in (0,1)$，协方差的比值为：\n  $$\n  \\frac{C(d_2)}{C(d_1)} = \\frac{\\alpha(1-\\alpha)\\exp(-2 r t d_2)}{\\alpha(1-\\alpha)\\exp(-2 r t d_1)} = \\exp(-2 r t (d_2 - d_1))\n  $$\n  将此代入 $\\widehat{t}_{\\mathrm{I}}$ 的估计量中：\n  $$\n  \\widehat{t}_{\\mathrm{I}} = -\\frac{\\ln(\\exp(-2 r t (d_2 - d_1)))}{2 r (d_2 - d_1)} = -\\frac{-2 r t (d_2 - d_1)}{2 r (d_2 - d_1)} = t\n  $$\n  如果 $\\alpha=0$ 或 $\\alpha=1$，则 $C(d)=0$，根据问题的约定，$\\widehat{t}_{\\mathrm{I}} = 0$。\n\n- **对于模型 S (深层结构)**，没有近期的混合脉冲。连锁不平衡被建模为一个常数，$C(d) = B_0 > 0$。\n  协方差的比值为：\n  $$\n  \\frac{C(d_2)}{C(d_1)} = \\frac{B_0}{B_0} = 1\n  $$\n  将此代入 $\\widehat{t}_{\\mathrm{S}}$ 的估计量中：\n  $$\n  \\widehat{t}_{\\mathrm{S}} = -\\frac{\\ln(1)}{2 r (d_2 - d_1)} = -\\frac{0}{2 r (d_2 - d_1)} = 0\n  $$\n\n**第 4 部分：决策规则和测试用例评估**\n区分模型的决策规则是一个布尔值 `disc`，如果 $\\widehat{t}_{\\mathrm{I}} > 0$ 且 $\\widehat{t}_{\\mathrm{S}} = 0$ 则为真。由于 $\\widehat{t}_{\\mathrm{S}}$ 始终为 $0$，规则简化为 `disc` 为真当且仅当 $\\widehat{t}_{\\mathrm{I}} > 0$。这发生在存在真实混合（$\\alpha \\in (0,1)$）且脉冲时间 $t$ 为正时。\n\n我们现在将这些公式应用于测试用例。\n\n**案例 1:** $\\alpha = 0.02$, $n_U = 0.06$, $t=120$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = t = 120.0$ (因为 $0  0.02  1$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(120.0 > 0) \\land (0.0 = 0)$ 为真 (True)。\n- 结果: $[0.0, 120.0, 0.0, \\text{True}]$\n\n**案例 2:** $\\alpha = 0.005$, $n_U = 0.08$, $t=300$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = t = 300.0$ (因为 $0  0.005  1$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(300.0 > 0) \\land (0.0 = 0)$ 为真 (True)。\n- 结果: $[0.0, 300.0, 0.0, \\text{True}]$\n\n**案例 3:** $\\alpha = 0.0$, $n_U = 0.05$, $t=200$。\n- $\\Delta = 0.0$。\n- $\\widehat{t}_{\\mathrm{I}} = 0.0$ (因为 $\\alpha = 0$)。\n- $\\widehat{t}_{\\mathrm{S}} = 0.0$。\n- `disc`: $(0.0 > 0) \\land (0.0 = 0)$ 为假 (False)。\n- 结果: $[0.0, 0.0, 0.0, \\text{False}]$\n\n基于LD的统计量成功地区分了模型 I（有基因渗入）和模型 S（深层结构），而所选的 $f_4$-统计量集合则无法区分。", "answer": "[[0.0,120.0,0.0,True],[0.0,300.0,0.0,True],[0.0,0.0,0.0,False]]", "id": "2692318"}]}