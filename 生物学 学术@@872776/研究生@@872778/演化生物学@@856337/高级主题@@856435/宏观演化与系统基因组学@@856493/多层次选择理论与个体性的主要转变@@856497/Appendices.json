{"hands_on_practices": [{"introduction": "为了正式分析选择如何在多个层次上运作，我们必须首先学会在数学上将其效应进行分解。本练习将通过分析经典的公共品博弈——一个研究合作演化的基石模型——为您提供基础性实践。通过推导适应度函数及相应的选择梯度，您将看到总选择压力如何被分解为组内组分（有利于背叛者）和组间组分（有利于合作者群体）[@problem_id:2736938]。", "problem": "考虑一个集合种群，其被划分为多个大小恒为 $n \\geq 2$ 的小组。在每个小组中，个体分为两种类型：合作者 ($C$) 和背叛者 ($D$)。令 $k \\in \\{0,1,\\dots,n\\}$ 表示一个焦点小组中合作者的数量。每个合作者付出个人成本 $c > 0$，并产生一种非排他性的公共物品，该物品产生总收益 $b > 0$，由所有 $n$ 个小组成员（包括生产者自己）平均分享。每个个体还会获得一个基准适应度 $w_{0} > 0$。假设适应度效应是可加的（弱选择），并且小组的期望生产力与其成员在当前代期望个体适应度的总和成正比。\n\n仅使用这些假设和定义：\n1. 推导期望小组生产力 $W_{G}(k)$ 作为 $k$ 的函数。\n2. 将组内选择梯度 $s_{W}$ 定义为：当小组中其他合作者的数量固定为 $j = k - 1$ 时，一个个体从 $D$ 转换为 $C$ 对其自身期望适应度的边际效应。计算 $s_{W}$ 作为 $b$、$c$ 和 $n$ 的函数。\n3. 将组间选择梯度 $s_{B}$ 定义为小组平均适应度 $\\bar{w}(k)$ 关于 $k$ 的导数，即 $s_{B} = \\frac{d \\bar{w}(k)}{d k}$，其中 $\\bar{w}(k)$ 是一个有 $k$ 个合作者的小组中个体的平均期望适应度。计算 $s_{B}$ 作为 $b$、$c$ 和 $n$ 的函数。\n\n将你的最终答案表示为一个行矩阵，其元素为 $\\big[ W_{G}(k),\\, s_{W},\\, s_{B} \\big]$。不需要数值近似；给出闭式表达式。最终答案中不包含单位。", "solution": "首先应对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- 集合种群被划分为大小恒为 $n \\geq 2$ 的小组。\n- 个体分为两种类型：合作者 ($C$) 和背叛者 ($D$)。\n- $k \\in \\{0, 1, \\dots, n\\}$ 是焦点小组中合作者的数量。\n- 合作者付出个人成本 $c > 0$。\n- 合作者产生一种非排他性的公共物品，产生总收益 $b > 0$。\n- 收益由所有 $n$ 个小组成员平均分享。\n- 每个个体获得一个基准适应度 $w_{0} > 0$。\n- 适应度效应是可加的（弱选择）。\n- 小组的期望生产力 $W_{G}(k)$ 与其成员的期望个体适应度之和成正比。\n- 组内选择梯度 $s_{W}$ 是当其他合作者数量固定为 $j=k-1$ 时，个体从 $D$ 转换为 $C$ 对其自身期望适应度的边际效应。\n- 组间选择梯度 $s_{B}$ 是小组平均适应度 $\\bar{w}(k)$ 关于 $k$ 的导数，即 $s_{B} = \\frac{d \\bar{w}(k)}{d k}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题呈现了一个标准的公共物品博弈场景，这是演化生物学中用于研究合作演化的一个基本模型。\n- **科学依据：** 该问题基于演化博弈论和多层次选择理论的既定原则。合作者、背叛者、公共物品和适应度计算等概念在该领域是标准的。该问题在科学上是合理的。\n- **适定性：** 所有参数（$n, c, b, w_0$）都有定义，并且函数依赖关系也已明确。任务是基于这些定义推导量，这将导出一个唯一的、有意义的解。\n- **客观性：** 问题以精确的数学语言陈述，没有主观性或模糊性。\n- **完整性与一致性：** 该问题是自洽的。所提供的定义足以推导出所要求的量。没有内部矛盾。对离散变量 $k$ 求导是在这些模型中计算选择梯度的标准惯例。\n- **无其他缺陷：** 该问题既非显然也非同义反复，需要逻辑推导。在其理论框架内，它不基于任何不切实际或无法验证的前提。\n\n**步骤3：结论与行动**\n问题被认为是有效的。将提供完整解答。\n\n**推导**\n\n解答需要推导合作者和背叛者的适应度函数，然后才能计算小组生产力和选择梯度。\n\n首先，我们定义在一个包含 $k$ 个合作者、大小为 $n$ 的小组中，一个合作者 ($w_{C}$) 和一个背叛者 ($w_{D}$) 的期望适应度。在这样的小组中，由公共物品产生的总收益是 $k \\cdot b$。这个收益被所有 $n$ 个成员平均分享，所以每个个体得到 $\\frac{kb}{n}$ 的份额。合作者需要额外付出个人成本 $c$。所有个体都以基准适应度 $w_0$ 开始。\n\n在一个有 $k$ 个合作者的小组中，一个背叛者 ($w_D$) 的适应度是：\n$$w_D(k) = w_0 + \\frac{kb}{n}$$\n在同一个小组中，一个合作者 ($w_C$) 的适应度是：\n$$w_C(k) = w_0 - c + \\frac{kb}{n}$$\n\n有了这些基本表达式，我们接下来解决问题的三个部分。\n\n**1. 小组生产力 $W_{G}(k)$**\n\n问题陈述，小组生产力 $W_G(k)$ 与小组中所有成员的期望个体适应度之和成正比。令这个总和用 $\\Sigma_W(k)$ 表示。\n一个有 $k$ 个合作者的小组有 $n-k$ 个背叛者。适应度总和为：\n$$\\Sigma_W(k) = k \\cdot w_C(k) + (n-k) \\cdot w_D(k)$$\n代入 $w_C(k)$ 和 $w_D(k)$ 的表达式：\n$$\\Sigma_W(k) = k \\left(w_0 - c + \\frac{kb}{n}\\right) + (n-k) \\left(w_0 + \\frac{kb}{n}\\right)$$\n展开各项：\n$$\\Sigma_W(k) = kw_0 - kc + \\frac{k^2b}{n} + nw_0 + \\frac{nkb}{n} - kw_0 - \\frac{k^2b}{n}$$\n通过消去项（$kw_0$ 和 $\\frac{k^2b}{n}$）来简化表达式：\n$$\\Sigma_W(k) = nw_0 - kc + kb = nw_0 + k(b-c)$$\n鉴于 $W_G(k)$ 与此总和成正比，我们写成 $W_G(k) = \\alpha \\cdot \\Sigma_W(k)$，其中 $\\alpha$ 是比例常数。在没有更多信息的情况下，标准做法是设 $\\alpha=1$，从而将小组生产力等同于其成员的适应度总和。因此：\n$$W_G(k) = nw_0 + k(b-c)$$\n\n**2. 组内选择梯度 $s_W$**\n\n组内选择梯度 $s_W$ 是一个焦点个体从策略 $D$ 转换为策略 $C$ 所导致的适应度变化。小组其余成员的构成保持不变，即在其他 $n-1$ 个个体中有 $j=k-1$ 个合作者。\n\n-   如果焦点个体是背叛者 ($D$)，则小组中合作者的总数是 $k=j$。其适应度为 $w_D(j) = w_0 + \\frac{jb}{n}$。\n-   如果焦点个体转变为合作者 ($C$)，则合作者的总数变为 $k=j+1$。其适应度为 $w_C(j+1) = w_0 - c + \\frac{(j+1)b}{n}$。\n\n选择梯度 $s_W$ 是这两个适应度值之差：\n$$s_W = w_C(j+1) - w_D(j)$$\n$$s_W = \\left(w_0 - c + \\frac{(j+1)b}{n}\\right) - \\left(w_0 + \\frac{jb}{n}\\right)$$\n$$s_W = w_0 - c + \\frac{jb}{n} + \\frac{b}{n} - w_0 - \\frac{jb}{n}$$\n简化表达式得到：\n$$s_W = \\frac{b}{n} - c$$\n\n这个结果代表了个体因其自身的合作行为而产生的净适应度效应：它获得自身贡献的一部分收益（$\\frac{b}{n}$），同时支付全部成本（$-c$）。\n\n**3. 组间选择梯度 $s_B$**\n\n组间选择梯度 $s_B$ 定义为小组平均适应度 $\\bar{w}(k)$ 关于合作者数量 $k$ 的导数。\n首先，我们计算一个有 $k$ 个合作者的小组的平均适应度 $\\bar{w}(k)$。这是所有个体适应度的总和除以小组大小 $n$。\n$$\\bar{w}(k) = \\frac{\\Sigma_W(k)}{n} = \\frac{k \\cdot w_C(k) + (n-k) \\cdot w_D(k)}{n}$$\n使用在第1部分中推导出的总和 $\\Sigma_W(k)$ 的表达式：\n$$\\bar{w}(k) = \\frac{nw_0 + k(b-c)}{n} = w_0 + \\frac{k(b-c)}{n}$$\n现在，我们计算 $\\bar{w}(k)$ 关于 $k$ 的导数，按照这类分析的标准做法，将 $k$ 视为连续变量。\n$$s_B = \\frac{d\\bar{w}(k)}{dk} = \\frac{d}{dk} \\left(w_0 + \\frac{k(b-c)}{n}\\right)$$\n常数 $w_0$ 的导数为零。关于 $k$ 的线性项的导数是其系数：\n$$s_B = \\frac{b-c}{n}$$\n该项量化了小组的平均适应度如何随着合作者数量的增加而变化。\n\n因此，所要求的三个量均已推导得出。", "answer": "$$\\boxed{\\begin{pmatrix}nw_{0} + k(b-c)  \\frac{b}{n} - c  \\frac{b-c}{n}\\end{pmatrix}}$$", "id": "2736938"}, {"introduction": "多层次选择有时会产生初看起来似乎自相矛盾的结果。一个著名的例子是，某个性状在每一个子群体中的频率都在下降，但其在总群体中的整体频率却在上升——这一现象被称为辛普森悖论。本练习提供了一个该情景下的具体数值案例，要求您计算合作者在两个层次上的频率变化，并运用普赖斯方程（Price equation）来正式地化解这个表面上的矛盾，从而为理解组内选择与组间选择之间的相互作用建立坚实的直觉 [@problem_id:2736847]。", "problem": "一个种群被划分为多个离散且不重叠的群体，这些群体经历一轮选择和繁殖，随后进行完全混合。在时间 $t=0$ 时，有三个群体，其构成如下：\n- A群：$n_{A0} = 5$ 个个体，其中 $c_{A0} = 4$ 个为合作者，$d_{A0} = 1$ 个为背叛者。\n- B群：$n_{B0} = 50$ 个个体，其中 $c_{B0} = 20$ 个为合作者，$d_{B0} = 30$ 个为背叛者。\n- C群：$n_{C0} = 100$ 个个体，其中 $c_{C0} = 10$ 个为合作者，$d_{C0} = 90$ 个为背叛者。\n\n在每个群体内部，个体以依赖于类型的绝对适应度进行克隆繁殖：每个合作者产生 $s_{C} = 1$ 个存活后代，每个背叛者产生 $s_{D} = 2$ 个存活后代。在这次群体内部繁殖之后，每个群体的总产出将乘以一个群体水平的生产力乘数，该乘数仅取决于群体的初始构成，反映了合作的公共物品效应：A群的乘数为 $M_{A} = 50$，B群的乘数为 $M_{B} = 5$，C群的乘数为 $M_{C} = 1$。因此，在时间 $t=1$ 时，群体 $i \\in \\{\\text{A},\\text{B},\\text{C}\\}$ 对下一代的总贡献是其群体内部后代总数的 $M_{i}$ 倍。\n\n令 $z_{ij} \\in \\{0,1\\}$ 表示在 $t=0$ 时群体 $i$ 中个体 $j$ 的合作类型，并令 $\\bar{z}_{i0}$ 为 $t=0$ 时的群体平均合作类型。令 $w_{i}$ 为群体平均绝对适应度（即群体 $i$ 对 $t=1$ 时刻贡献的人均后代数量），并令 $\\bar{w}$ 为全局平均绝对适应度。令群体内部平均合作水平的变化为 $\\Delta \\bar{z}_{i} = \\bar{z}_{i1} - \\bar{z}_{i0}$，其中 $\\bar{z}_{i1}$ 是混合前由群体 $i$ 贡献的后代中的平均合作水平。\n\n任务：\n1. 计算在 $t=0$ 时的全局合作者频率（记为 $\\bar{z}_{0}$）和在 $t=1$ 时的全局合作者频率（记为 $\\bar{z}_{1}$），并验证合作者频率在每个群体内部都下降（即对每个群体都有 $\\Delta \\bar{z}_{i}  0$），但在全局范围内增加（即 $\\bar{z}_{1} > \\bar{z}_{0}$）。\n2. 使用以初始群体大小为权重的两水平Price分解，计算群体间分量 $\\mathrm{B} = \\mathrm{Cov}_{G}(w_{i}, \\bar{z}_{i0})/\\bar{w}$ 和群体内分量 $\\mathrm{W} = \\mathrm{E}_{G}(w_{i}\\,\\Delta \\bar{z}_{i})/\\bar{w}$，其中 $\\mathrm{Cov}_{G}$ 和 $\\mathrm{E}_{G}$ 是在以 $n_{i0}/N_{0}$（其中 $N_{0} = \\sum_{i} n_{i0}$）为权重的群体间计算的。将这些分量以精确有理数形式给出（不要四舍五入）。\n3. 最后，将合作频率的全局净变化 $\\Delta \\bar{z} = \\bar{z}_{1} - \\bar{z}_{0}$ 报告为单个最简分数。这个最终值必须是你的答案。不要四舍五入；将最终值表示为无单位的精确最简分数。", "solution": "我们首先列出初始条件以及从 $t=0$ 到 $t=1$ 的繁殖映射。\n\n初始群体大小和构成：\n- A群：$n_{A0} = 5$, $c_{A0} = 4$, $d_{A0} = 1$，因此 $\\bar{z}_{A0} = c_{A0}/n_{A0} = 4/5$。\n- B群：$n_{B0} = 50$, $c_{B0} = 20$, $d_{B0} = 30$，因此 $\\bar{z}_{B0} = 20/50 = 2/5$。\n- C群：$n_{C0} = 100$, $c_{C0} = 10$, $d_{C0} = 90$，因此 $\\bar{z}_{C0} = 10/100 = 1/10$。\n\n初始总种群大小为 $N_{0} = 5 + 50 + 100 = 155$。初始全局合作频率为\n$$\n\\bar{z}_{0} = \\frac{c_{A0} + c_{B0} + c_{C0}}{N_{0}} = \\frac{4 + 20 + 10}{155} = \\frac{34}{155}。\n$$\n\n在绝对适应度 $s_{C} = 1$ 和 $s_{D} = 2$ 下的群体内部繁殖，对于每个群体 $i$ (在应用 $M_{i}$ 之前) 得出：\n- 合作者产生 $c_{i0} s_{C}$ 个后代，背叛者产生 $d_{i0} s_{D}$ 个后代。\n- 群体内部繁殖后的合作频率（在应用 $M_{i}$ 之前，该项在分数中被约去）为\n$$\n\\bar{z}_{i1} = \\frac{c_{i0} s_{C}}{c_{i0} s_{C} + d_{i0} s_{D}}。\n$$\n因此，\n- A群：$\\bar{z}_{A1} = \\frac{4 \\cdot 1}{4 \\cdot 1 + 1 \\cdot 2} = \\frac{4}{6} = \\frac{2}{3}$，所以 $\\Delta \\bar{z}_{A} = \\frac{2}{3} - \\frac{4}{5} = -\\frac{2}{15}  0$。\n- B群：$\\bar{z}_{B1} = \\frac{20 \\cdot 1}{20 \\cdot 1 + 30 \\cdot 2} = \\frac{20}{80} = \\frac{1}{4}$，所以 $\\Delta \\bar{z}_{B} = \\frac{1}{4} - \\frac{2}{5} = -\\frac{3}{20}  0$。\n- C群：$\\bar{z}_{C1} = \\frac{10 \\cdot 1}{10 \\cdot 1 + 90 \\cdot 2} = \\frac{10}{190} = \\frac{1}{19}$，所以 $\\Delta \\bar{z}_{C} = \\frac{1}{19} - \\frac{1}{10} = -\\frac{9}{190}  0$。\n\n因此，合作在每个群体内部都下降了。\n\n接下来，计算在应用群体乘数 $M_{A} = 50$，$M_{B} = 5$，$M_{C} = 1$ 后，对 $t=1$ 的总贡献。每个群体贡献的后代数量为：\n- A群：$C_{A1} = M_{A} \\cdot c_{A0} s_{C} = 50 \\cdot 4 = 200$， $D_{A1} = M_{A} \\cdot d_{A0} s_{D} = 50 \\cdot 2 = 100$，所以 $N_{A1} = 300$。\n- B群：$C_{B1} = 5 \\cdot 20 = 100$， $D_{B1} = 5 \\cdot 60 = 300$，所以 $N_{B1} = 400$。\n- C群：$C_{C1} = 1 \\cdot 10 = 10$， $D_{C1} = 1 \\cdot 180 = 180$，所以 $N_{C1} = 190$。\n\n在 $t=1$ 时的总数：\n$$\nC_{1} = 200 + 100 + 10 = 310,\\quad D_{1} = 100 + 300 + 180 = 580,\\quad N_{1} = 890.\n$$\n所以在 $t=1$ 时的全局合作频率为\n$$\n\\bar{z}_{1} = \\frac{C_{1}}{N_{1}} = \\frac{310}{890} = \\frac{31}{89}。\n$$\n由于 $\\bar{z}_{0} = \\frac{34}{155} \\approx 0.21935$ 且 $\\bar{z}_{1} = \\frac{31}{89} \\approx 0.34831$，合作在全局范围内增加了，这证实了所要求的模式。\n\n我们现在来计算两水平Price分解。令群体平均绝对适应度为 $w_{i} = N_{i1}/n_{i0}$，全局平均绝对适应度为 $\\bar{w} = N_{1}/N_{0}$。群体权重为 $n_{i0}/N_{0}$。\n\n计算 $w_{i}$ 和 $\\bar{w}$：\n$$\nw_{A} = \\frac{300}{5} = 60,\\quad w_{B} = \\frac{400}{50} = 8,\\quad w_{C} = \\frac{190}{100} = \\frac{19}{10},\\quad \\bar{w} = \\frac{N_{1}}{N_{0}} = \\frac{890}{155} = \\frac{178}{31}。\n$$\n\n群体间分量。群体间的加权协方差为\n$$\n\\mathrm{Cov}_{G}(w_{i}, \\bar{z}_{i0}) = \\mathrm{E}_{G}(w_{i}\\bar{z}_{i0}) - \\mathrm{E}_{G}(w_{i})\\,\\mathrm{E}_{G}(\\bar{z}_{i0})。\n$$\n我们已经有 $\\mathrm{E}_{G}(w_{i}) = \\bar{w} = \\frac{178}{31}$ 和 $\\mathrm{E}_{G}(\\bar{z}_{i0}) = \\bar{z}_{0} = \\frac{34}{155}$。\n\n计算以 $n_{i0}/N_{0}$ 为权重的 $\\mathrm{E}_{G}(w_{i}\\bar{z}_{i0})$：\n- 权重：$n_{A0}/N_{0} = \\frac{5}{155}$, $n_{B0}/N_{0} = \\frac{50}{155}$, $n_{C0}/N_{0} = \\frac{100}{155}$。\n- 乘积：$w_{A}\\bar{z}_{A0} = 60 \\cdot \\frac{4}{5} = 48$, $w_{B}\\bar{z}_{B0} = 8 \\cdot \\frac{2}{5} = \\frac{16}{5}$, $w_{C}\\bar{z}_{C0} = \\frac{19}{10} \\cdot \\frac{1}{10} = \\frac{19}{100}$。\n因此\n$$\n\\mathrm{E}_{G}(w_{i}\\bar{z}_{i0}) = \\frac{5}{155}\\cdot 48 + \\frac{50}{155}\\cdot \\frac{16}{5} + \\frac{100}{155}\\cdot \\frac{19}{100} = \\frac{48}{31} + \\frac{32}{31} + \\frac{19}{155} = \\frac{419}{155}。\n$$\n所以，\n$$\n\\mathrm{Cov}_{G}(w_{i}, \\bar{z}_{i0}) = \\frac{419}{155} - \\frac{178}{31}\\cdot \\frac{34}{155} = \\frac{419}{155} - \\frac{6052}{4805} = \\frac{6937}{4805}。\n$$\n群体间的Price分量是\n$$\n\\mathrm{B} = \\frac{\\mathrm{Cov}_{G}(w_{i}, \\bar{z}_{i0})}{\\bar{w}} = \\frac{\\frac{6937}{4805}}{\\frac{178}{31}} = \\frac{6937}{27590}。\n$$\n\n群体内分量。计算 $\\mathrm{E}_{G}(w_{i}\\Delta \\bar{z}_{i})$：\n- $\\Delta \\bar{z}_{A} = -\\frac{2}{15}$，所以 $w_{A}\\Delta \\bar{z}_{A} = 60 \\cdot \\left(-\\frac{2}{15}\\right) = -8$。\n- $\\Delta \\bar{z}_{B} = -\\frac{3}{20}$，所以 $w_{B}\\Delta \\bar{z}_{B} = 8 \\cdot \\left(-\\frac{3}{20}\\right) = -\\frac{6}{5}$。\n- $\\Delta \\bar{z}_{C} = -\\frac{9}{190}$，所以 $w_{C}\\Delta \\bar{z}_{C} = \\frac{19}{10} \\cdot \\left(-\\frac{9}{190}\\right) = -\\frac{171}{1900}$。\n按 $n_{i0}/N_{0}$ 加权，\n$$\n\\mathrm{E}_{G}(w_{i}\\Delta \\bar{z}_{i}) = \\frac{5}{155}(-8) + \\frac{50}{155}\\left(-\\frac{6}{5}\\right) + \\frac{100}{155}\\left(-\\frac{171}{1900}\\right) = -\\frac{8}{31} - \\frac{12}{31} - \\frac{9}{155} = -\\frac{109}{155}。\n$$\n因此群体内的Price分量是\n$$\n\\mathrm{W} = \\frac{\\mathrm{E}_{G}(w_{i}\\Delta \\bar{z}_{i})}{\\bar{w}} = \\frac{-\\frac{109}{155}}{\\frac{178}{31}} = -\\frac{109}{890}。\n$$\n\n一致性检验：Price分解断言\n$$\n\\Delta \\bar{z} = \\mathrm{B} + \\mathrm{W}。\n$$\n计算其和：\n$$\n\\mathrm{B} + \\mathrm{W} = \\frac{6937}{27590} - \\frac{109}{890} = \\frac{6937}{27590} - \\frac{3379}{27590} = \\frac{3558}{27590} = \\frac{1779}{13795}。\n$$\n从全局频率直接计算得出\n$$\n\\Delta \\bar{z} = \\bar{z}_{1} - \\bar{z}_{0} = \\frac{31}{89} - \\frac{34}{155} = \\frac{1779}{13795}，\n$$\n该结果与分解结果相符。群体间分量为正，且其值超过了为负的群体内分量的绝对值，从而解决了这个悖论：合作在每个群体内部都下降，但在全局范围内却增加了。\n\n所要求的最终量是合作频率的全局净变化，以最简分数表示，即 $\\Delta \\bar{z} = \\frac{1779}{13795}$。", "answer": "$$\\boxed{\\frac{1779}{13795}}$$", "id": "2736847"}, {"introduction": "虽然理论模型至关重要，但演化生物学同样是一门实证科学。一个关键的挑战是如何将我们的模型与真实世界的数据联系起来，并估计那些支配社会性状演化的参数，例如合作的成本（$c$）和收益（$b$）。本练习介绍了一个强大的统计框架——邻居调节的适应度回归（neighbor-modulated fitness regression）——它使我们能够实现这一目标。通过分析一个小型数据集，您将练习使用普通最小二乘法回归来估计这些关键参数以及关联度（$r$），从而将多层次选择框架与亲缘选择理论的逻辑直接联系起来 [@problem_id:2736901]。", "problem": "将多层次选择和内含适应性联系起来的一个标准方法是使用基于罗伯逊-普莱斯恒等式的邻居调节适应性回归。考虑一个由二元组构成的种群，其中每个个体具有二元表型 $x \\in \\{0,1\\}$，$x=1$ 表示合作者，$x=0$ 表示背叛者。每个个体恰好与一个表型为 $y \\in \\{0,1\\}$ 的伙伴互动，并获得实现适应性 $w$。假设我们将个体适应性建模为自身表型和伙伴表型的线性函数，\n$$\nw = \\alpha + \\beta_{S} x + \\beta_{N} y + \\varepsilon,\n$$\n其中 $\\alpha$ 是截距，$\\beta_{S}$ 是自身表型的偏效应（直接或个体内部效应），$\\beta_{N}$ 是伙伴表型的偏效应（邻居效应）。定义合作成本 $c$ 和对伙伴的收益 $b$ 为 $c \\equiv -\\beta_{S}$ 和 $b \\equiv \\beta_{N}$。定义表型关联（回归相关度）$r$ 为 $y$ 对 $x$ 的普通最小二乘回归，$r \\equiv \\beta_{y \\mid x}$。\n\n给你以下包含 $6$ 个二元组（共 $12$ 个个体）的数据集。对每个个体，都列出了元组 $(x,y,w)$。其中 $x$ 是个体的自身表型，$y$ 是其伙伴的表型，$w$ 是实现的绝对适应性。\n\n- 二元组 $1$ (合作者-合作者)：$(x,y,w)=(1,1,1.35)$，$(1,1,1.35)$。\n- 二元组 $2$ (合作者-合作者)：$(x,y,w)=(1,1,1.35)$，$(1,1,1.35)$。\n- 二元组 $3$ (背叛者-背叛者)：$(x,y,w)=(0,0,1)$，$(0,0,1)$。\n- 二元组 $4$ (背叛者-背叛者)：$(x,y,w)=(0,0,1)$，$(0,0,1)$。\n- 二元组 $5$ (合作者-背叛者)：$(x,y,w)=(1,0,0.9)$，$(0,1,1.45)$。\n- 二元组 $6$ (合作者-背叛者)：$(x,y,w)=(1,0,0.9)$，$(0,1,1.45)$。\n\n任务：\n1. 使用普通最小二乘法 (OLS)，拟合邻居调节适应性回归 $w = \\alpha + \\beta_{S} x + \\beta_{N} y + \\varepsilon$，并通过 $\\widehat{b} \\equiv \\widehat{\\beta}_{N}$ 和 $\\widehat{c} \\equiv -\\widehat{\\beta}_{S}$ 估计 $\\widehat{b}$ 和 $\\widehat{c}$。\n2. 通过 $y$ 对 $x$ 的 OLS 回归估计表型关联 $\\widehat{r}$，即 $\\widehat{r} \\equiv \\widehat{\\beta}_{y \\mid x}$。\n3. 以罗伯逊-普莱斯恒等式为基础，通过计算净一阶内含效应 $\\widehat{r}\\,\\widehat{b} - \\widehat{c}$ 来评估合作性状是否受青睐。\n\n报告一个等于 $\\widehat{r}\\,\\widehat{b} - \\widehat{c}$ 值的实数作为最终答案。不包含单位，也不要提供不等式或文字陈述作为最终答案。", "solution": "所提出的问题陈述是量化演化遗传学中的一个有效练习。它在科学上基于社会演化理论的原理，特别是邻居调节适应性方法及其通过罗伯逊-普莱斯恒等式与内含适应性的联系。该问题设定良好，提供了完整的数据集和清晰、客观的定义及任务。没有矛盾、模糊或事实不健全之处。因此，可以推导出一个严谨的解。\n\n该问题需要三步计算。首先，从适应性的多元线性回归中估计合作的收益 $b$ 和成本 $c$。其次，估计表型关联，或称相关度 $r$。第三，结合这些估计值来评估内含适应性效应 $rb-c$。\n\n总数据集包含 $N=12$ 个个体。数据点 $(x_i, y_i, w_i)$ (对于 $i=1, \\dots, 12$) 是从 $6$ 个二元组中汇编而来的：\n- 四个类型为 $(x,y,w) = (1, 1, 1.35)$ 的个体\n- 四个类型为 $(x,y,w) = (0, 0, 1)$ 的个体\n- 两个类型为 $(x,y,w) = (1, 0, 0.9)$ 的个体\n- 两个类型为 $(x,y,w) = (0, 1, 1.45)$ 的个体\n\n步骤1：估计 $\\widehat{b}$ 和 $\\widehat{c}$\n邻居调节适应性的模型由以下线性回归给出：\n$$w = \\alpha + \\beta_{S} x + \\beta_{N} y + \\varepsilon$$\n参数 $\\widehat{b}$ 和 $\\widehat{c}$ 定义为 $\\widehat{b} \\equiv \\widehat{\\beta}_{N}$ 和 $\\widehat{c} \\equiv -\\widehat{\\beta}_{S}$，其中 $\\widehat{\\beta}_{S}$ 和 $\\widehat{\\beta}_{N}$ 是普通最小二乘法 (OLS) 的估计值。\n\n对数据集的检查显示，适应性 $w$ 是 $x$ 和 $y$ 的一个完美线性函数。对于数据中四个唯一的 $(x,y)$ 对——$(1,1)$, $(0,0)$, $(1,0)$, 和 $(0,1)$——都只有一个恒定的观测适应性值。这意味着所有数据点的误差项 $\\varepsilon$ 均为零，OLS 拟合将是精确的。因此，我们可以通过求解以下线性方程组来找到系数：\n- 对于 $(x,y)=(0,0)$：$w = \\alpha + \\beta_{S}(0) + \\beta_{N}(0) = \\alpha = 1$\n- 对于 $(x,y)=(1,0)$：$w = \\alpha + \\beta_{S}(1) + \\beta_{N}(0) = \\alpha + \\beta_{S} = 0.9$\n- 对于 $(x,y)=(0,1)$：$w = \\alpha + \\beta_{S}(0) + \\beta_{N}(1) = \\alpha + \\beta_{N} = 1.45$\n- 对于 $(x,y)=(1,1)$：$w = \\alpha + \\beta_{S}(1) + \\beta_{N}(1) = \\alpha + \\beta_{S} + \\beta_{N} = 1.35$\n\n从第一个方程，我们得到 $\\widehat{\\alpha} = 1$。\n将 $\\widehat{\\alpha}=1$ 代入第二个方程，得到 $1 + \\widehat{\\beta}_{S} = 0.9$，从而得出 $\\widehat{\\beta}_{S} = -0.1$。\n将 $\\widehat{\\alpha}=1$ 代入第三个方程，得到 $1 + \\widehat{\\beta}_{N} = 1.45$，从而得出 $\\widehat{\\beta}_{N} = 0.45$。\n我们可以用第四个方程验证这些值：$1 + (-0.1) + 0.45 = 1.35$，这是正确的。\n\n因此，OLS 估计值为 $\\widehat{\\beta}_{S} = -0.1$ 和 $\\widehat{\\beta}_{N} = 0.45$。\n根据所给的定义：\n- 估计的收益为 $\\widehat{b} \\equiv \\widehat{\\beta}_{N} = 0.45$。\n- 估计的成本为 $\\widehat{c} \\equiv -\\widehat{\\beta}_{S} = -(-0.1) = 0.1$。\n\n步骤2：估计表型关联 $\\widehat{r}$\n表型关联 $\\widehat{r}$ 是伙伴表型 $y$ 对焦点个体表型 $x$ 的 OLS 回归系数。对于简单线性回归 $y = \\beta_0 + rx + \\delta$，斜率 $\\widehat{r}$ 由以下公式给出：\n$$\\widehat{r} = \\frac{\\text{Cov}(x,y)}{\\text{Var}(x)}$$\n我们从 $N=12$ 个个体的完整样本中计算必要的组成部分。\n$x$ 的表型为 $\\{1,1,1,1,0,0,0,0,1,0,1,0\\}$。\n$y$ 的表型为 $\\{1,1,1,1,0,0,0,0,0,1,0,1\\}$。\n\n$x$ 值的总和是 $\\sum x_i = 6$。均值为 $\\bar{x} = \\frac{6}{12} = 0.5$。\n$y$ 值的总和是 $\\sum y_i = 6$。均值为 $\\bar{y} = \\frac{6}{12} = 0.5$。\n\n$x$ 的方差是 $\\text{Var}(x) = \\frac{1}{N}\\sum (x_i - \\bar{x})^2 = \\frac{1}{12} \\sum (x_i - 0.5)^2$。由于 $x_i \\in \\{0,1\\}$，这可以简化为 $\\bar{x}(1-\\bar{x}) = 0.5(1-0.5) = 0.25$。\n另外，由于 $x_i$ 是二元的，$\\sum x_i^2 = \\sum x_i = 6$。\n$\\text{Var}(x) = \\frac{\\sum x_i^2}{N} - \\bar{x}^2 = \\frac{6}{12} - (0.5)^2 = 0.5 - 0.25 = 0.25 = \\frac{1}{4}$。\n\n$x$ 和 $y$ 的协方差是 $\\text{Cov}(x,y) = \\frac{1}{N}\\sum(x_i - \\bar{x})(y_i - \\bar{y}) = \\frac{1}{N}\\sum x_i y_i - \\bar{x}\\bar{y}$。\n我们必须计算 $\\sum x_i y_i$。这是 $12$ 个数据点中每个点内表型的乘积之和。\n- 四个 $(x,y)=(1,1)$ 的个体贡献了 $4 \\times (1 \\times 1) = 4$。\n- 四个 $(x,y)=(0,0)$ 的个体贡献了 $4 \\times (0 \\times 0) = 0$。\n- 两个 $(x,y)=(1,0)$ 的个体贡献了 $2 \\times (1 \\times 0) = 0$。\n- 两个 $(x,y)=(0,1)$ 的个体贡献了 $2 \\times (0 \\times 1) = 0$。\n总和为 $\\sum x_i y_i = 4$。\n现在，协方差为 $\\text{Cov}(x,y) = \\frac{4}{12} - (0.5)(0.5) = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12}$。\n\n最后，我们计算 $\\widehat{r}$：\n$$\\widehat{r} = \\frac{\\text{Cov}(x,y)}{\\text{Var}(x)} = \\frac{1/12}{1/4} = \\frac{1}{12} \\times 4 = \\frac{4}{12} = \\frac{1}{3}$$\n\n步骤3：评估内含适应性效应 $\\widehat{r}\\,\\widehat{b} - \\widehat{c}$\n使用前面步骤中估计的值：\n- $\\widehat{r} = \\frac{1}{3}$\n- $\\widehat{b} = 0.45$\n- $\\widehat{c} = 0.1$\n\n净内含适应性效应为：\n$$\\widehat{r}\\,\\widehat{b} - \\widehat{c} = \\left(\\frac{1}{3}\\right) \\times (0.45) - 0.1$$\n$$\\widehat{r}\\,\\widehat{b} - \\widehat{c} = 0.15 - 0.1 = 0.05$$\n正值表示，在数据所反映的条件下，合作性状 $x=1$ 受到自然选择的青睐。然而，问题只要求提供数值。", "answer": "$$\\boxed{0.05}$$", "id": "2736901"}]}