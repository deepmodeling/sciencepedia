{"hands_on_practices": [{"introduction": "分子进化的核心在于观察到同源序列比随机预期的更相似。本练习旨在通过一个基础的假设检验来将这一直觉形式化。通过在一个随机性的零假设模型下，计算观察到高度序列一致性的概率，我们可以量化支持共同祖先假说的统计证据 [@problem_id:2706445]。这个练习将巩固对$p$值的理解，以及所有分子序列比较背后所依赖的基础统计逻辑。", "problem": "两条长度为 $1000$ 的同源DNA序列进行了无空位比对。在这 $1000$ 个位点中，两条序列之间恰好有 $850$ 个位置是相同的。假设采用以下随机序列生成的零模型：在每个位点，每条序列独立地从字母表 $\\{A,C,G,T\\}$ 中以相等的概率 $1/4$ 抽取一个核苷酸，且不同位点之间以及序列之间的抽取是相互独立的。您希望检验观察到的相同水平是否与此随机模型一致，以此作为支持共同祖先假说的证据。\n\n仅从独立试验的概率论基本原理出发，并根据单侧p值的定义（即在零模型下，获得一个比观察结果更极端或同样极端，且方向为更多相同位点的结果的概率），推导出一个精确的闭式表达式（无数值近似），用于计算在该零模型下，在 $1000$ 个位点中观察到 $850$ 个或更多相同位点的p值。请将您的最终答案表示为单个解析表达式。然后，简要解释相对于随机匹配模型，这个p值如何影响支持共同祖先的证据强度，并说明p值量化了什么。\n\n你的最终答案必须是一个单一的精确表达式。不要进行数值近似，也不要包含任何单位。如果你选择使用特殊函数来表达p值，它必须是标准的闭式形式。", "solution": "该问题要求推导一个精确的p值，以检验观察到的两条DNA序列之间的相同性是否源于随机偶然。这构成了一个正式的假设检验。\n\n首先，我们形式化零模型。零假设 $H_0$ 指出，两条序列是独立且随机生成的。序列长度为 $N = 1000$。在 $N$ 个位点中的每一个位点，每条序列从集合 $\\{A, C, G, T\\}$ 中抽取一个核苷酸，每个核苷酸的概率均为 $\\frac{1}{4}$。所有位点之间以及两条序列之间的抽取都是相互独立的。\n\n任务是计算p值，即观察到至少与已发现结果同样极端的结果的概率。观察到的结果是 $k_{obs} = 850$ 个相同位点。“更极端”的方向被指定为朝向更多相同位点的方向。\n\n我们首先在 $H_0$ 下计算单个任意位点上匹配的概率 $p$。设 $S_1$ 和 $S_2$ 分别为第一条和第二条序列在给定位置的核苷酸。如果 $S_1 = S_2$，则发生匹配。由于核苷酸的选择是独立的，任何特定匹配（例如，两者都是A）的概率为 $P(S_1=A \\text{ and } S_2=A) = P(S_1=A)P(S_2=A) = \\frac{1}{4} \\times \\frac{1}{4} = \\frac{1}{16}$。因为有四种可能的核苷酸，所以匹配的总概率是匹配为A、C、G或T的概率之和：\n$$p = P(S_1=S_2) = P(S_1=S_2=A) + P(S_1=S_2=C) + P(S_1=S_2=G) + P(S_1=S_2=T)$$\n$$p = 4 \\times \\left(\\frac{1}{4} \\times \\frac{1}{4}\\right) = 4 \\times \\frac{1}{16} = \\frac{1}{4}$$\n一个位点上不匹配的概率是 $1 - p = \\frac{3}{4}$。\n\n$N=1000$ 个位点的比对可以看作是一系列 $N$ 次独立的伯努利试验。每次试验对应一个位点，“成功”定义为该位点上的相同性。每次试验成功的概率是 $p = \\frac{1}{4}$。\n\n设 $K$ 是表示相同位点总数的随机变量。由于 $K$ 是 $N$ 次独立同分布的伯努利试验的总和，它遵循二项分布，即 $K \\sim \\text{Binomial}(N, p)$。$K$ 的概率质量函数（PMF）由下式给出：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n对于本问题，当 $N=1000$ 且 $p=\\frac{1}{4}$ 时，概率质量函数为：\n$$P(K=k) = \\binom{1000}{k} \\left(\\frac{1}{4}\\right)^k \\left(\\frac{3}{4}\\right)^{1000-k}$$\np值是观察到 $k_{obs} = 850$ 个或更多相同位点的概率。这通过将 $k$ 从 $850$ 到 $1000$ 的所有值的概率相加来计算：\n$$p\\text{-value} = P(K \\ge 850) = \\sum_{k=850}^{1000} P(K=k)$$\n将概率质量函数代入此求和式，得到p值的精确闭式表达式：\n$$p\\text{-value} = \\sum_{k=850}^{1000} \\binom{1000}{k} \\left(\\frac{1}{4}\\right)^k \\left(\\frac{3}{4}\\right)^{1000-k}$$\n此表达式是按要求应用概率论基本原理得到的结果。\n\n解释：\np值量化了在两条序列不相关（即零模型成立）的情况下，纯粹由于偶然性而观察到 $1000$ 个位点中有 $850$ 个或更多位点相同的序列相同性的概率。在该零模型下，相同位点的期望数量是 $E[K] = Np = 1000 \\times \\frac{1}{4} = 250$。观察到的值 $850$ 个位点远在分布的尾部，这意味着计算出的p值将极小。一个极小的p值表明，观察到的数据与随机匹配的零假设高度不一致。这为拒绝零假设提供了强有力的统计证据。拒绝随机匹配模型为备择假设提供了重要支持：即序列是同源的，意味着它们共享一个共同祖先。因此，这种高度相似性被解释为共享进化历史的结果，而不是一个天文数字般不可能的巧合。p值是在随机性假设下，对数据统计惊奇程度的直接度量。", "answer": "$$\\boxed{\\sum_{k=850}^{1000} \\binom{1000}{k} \\left(\\frac{1}{4}\\right)^k \\left(\\frac{3}{4}\\right)^{1000-k}}$$", "id": "2706445"}, {"introduction": "一旦我们接受序列相似性反映了共同的祖先，下一个问题就是如何将序列差异转化为对进化时间的度量。本练习应用了严格的分子钟假说和 Jukes-Cantor 模型，这是最简洁的核苷酸替换模型之一。你将推导观察到的序列分化与时间之间的关系，并考虑到同一位点上可能发生的多次替换 [@problem_id:2706423]。这个练习提供了处理分子进化基础模型的实践经验，阐明了校正原始分化度以估算实际替换数，并最终估算分化时间的关键步骤。", "problem": "对两个二倍体物种的大量假定中性的四重简并位点进行取样，得到一个包含 $L = 1.0 \\times 10^{7}$ 个独立位点的比对，其测序误差可以忽略不计。这两个物种在这些位点间的原始差异汉明分数为 $\\hat{p} = 0.060$。假设存在严格的分子钟，其中每个位点的替换在每个谱系中都遵循时间同质的泊松过程，每个位点每代的替换率为 $\\mu$。并假设核苷酸过程由 Jukes–Cantor (JC) 模型描述，该模型具有相等的平衡碱基频率和相等的交换性。这些物种的世代时间恒定为 $g = 20$ 年。\n\n仅从这些基础（独立谱系上的泊松替换、具有 Jukes–Cantor 模型的时间同质连续时间马尔可夫链、以及位点间的独立性）出发，推导连接观测到的差异分数 $\\hat{p}$、每个位点每代的突变率 $\\mu$ 以及自两个物种分化以来的分化时间 $T$（以世代为单位）之间的关系。然后，使用此关系计算与共同祖先的分化时间（以年为单位）。使用 $\\mu = 1.1 \\times 10^{-8}$ 每位点每代。将最终数值答案四舍五入至四位有效数字，并以年为单位报告（在最终的方框答案中不要包含单位）。", "solution": "该问题要求在 Jukes-Cantor 模型下，推导观测到的序列差异分数与分化时间之间的关系，然后计算该时间。该问题具有科学依据且提法明确。我们开始解答。\n\n首先，我们必须推导期望差异位点分数 $p$、每位点每代替换率 $\\mu$ 以及分化时间 $T$（以世代为单位）之间的关系。问题指定了 Jukes-Cantor (JC) 模型。在 JC 模型中，所有核苷酸替换都以相同的速率发生。从任何核苷酸替换出去的总速率为 $\\mu$。由于有3个可能的目标核苷酸，从任何特定核苷酸 $i$ 变为另一个特定核苷酸 $j$ ($i \\neq j$) 的速率为 $\\frac{\\mu}{3}$。\n\n这个过程由一个具有速率矩阵 $Q$ 的连续时间马尔可夫链描述。对于 $i \\neq j$，$Q_{ij}$ 元素是从状态 $i$ 转换到状态 $j$ 的速率，而对角线元素 $Q_{ii}$ 使得行和为零。因此，$Q_{ii} = -\\sum_{j \\neq i} Q_{ij} = -3(\\frac{\\mu}{3}) = -\\mu$。速率矩阵 $Q$ 为：\n$$\nQ = \\begin{pmatrix}\n-\\mu  \\frac{\\mu}{3}  \\frac{\\mu}{3}  \\frac{\\mu}{3} \\\\\n\\frac{\\mu}{3}  -\\mu  \\frac{\\mu}{3}  \\frac{\\mu}{3} \\\\\n\\frac{\\mu}{3}  \\frac{\\mu}{3}  -\\mu  \\frac{\\mu}{3} \\\\\n\\frac{\\mu}{3}  \\frac{\\mu}{3}  \\frac{\\mu}{3}  -\\mu\n\\end{pmatrix}\n$$\n时间间隔 $t$ 的转移概率矩阵 $P(t)$ 由矩阵指数 $P(t) = \\exp(Qt)$ 给出。为了计算它，我们可以将 $Q$ 写成 $Q = \\frac{\\mu}{3}J - \\frac{4\\mu}{3}I$，其中 $J$ 是全为1的 $4 \\times 4$ 矩阵，$I$ 是单位矩阵。\n单个谱系经过 $T$ 代的转移矩阵是 $P(T) = \\exp(QT)$。\n$$\nP(T) = \\exp\\left( \\left(\\frac{\\mu}{3}J - \\frac{4\\mu}{3}I\\right)T \\right) = \\exp\\left(-\\frac{4\\mu T}{3}I\\right) \\exp\\left(\\frac{\\mu T}{3}J\\right)\n$$\n对角矩阵的指数是直接的：$\\exp(-\\frac{4\\mu T}{3}I) = \\exp(-\\frac{4\\mu T}{3})I$。对于 $J$ 的指数，我们使用级数展开，注意到当 $k \\ge 1$ 时，$J^k = 4^{k-1}J$：\n$$\n\\exp\\left(\\frac{\\mu T}{3}J\\right) = I + \\sum_{k=1}^{\\infty} \\frac{(\\frac{\\mu T}{3})^k J^k}{k!} = I + \\frac{J}{4} \\sum_{k=1}^{\\infty} \\frac{(\\frac{4\\mu T}{3})^k}{k!} = I + \\frac{J}{4}\\left(\\exp\\left(\\frac{4\\mu T}{3}\\right)-1\\right)\n$$\n结合这些结果：\n$$\nP(T) = \\exp\\left(-\\frac{4\\mu T}{3}\\right) \\left[ I + \\frac{J}{4}\\left(\\exp\\left(\\frac{4\\mu T}{3}\\right)-1\\right) \\right] = \\exp\\left(-\\frac{4\\mu T}{3}\\right)I + \\frac{1}{4}\\left(1-\\exp\\left(-\\frac{4\\mu T}{3}\\right)\\right)J\n$$\n$P(T)$ 的元素是一个核苷酸在 $T$ 代后成为某种类型的概率。令 $P_{ii}(T)$ 为一个位点保持相同核苷酸的概率，而 $P_{ij}(T)$（对于 $i \\neq j$）为它变为某个特定不同核苷酸的概率。\n$$\nP_{ii}(T) = \\frac{1}{4} + \\frac{3}{4}\\exp\\left(-\\frac{4\\mu T}{3}\\right)\n$$\n$$\nP_{ij}(T) = \\frac{1}{4} - \\frac{1}{4}\\exp\\left(-\\frac{4\\mu T}{3}\\right) \\quad (i \\neq j)\n$$\n现在，考虑两个物种在 $T$ 代前从一个共同祖先分化而来。任何位点上分隔序列的总时间是 $2T$。我们想求出同源位点上的核苷酸不同的概率 $p$。这等于 $1$ 减去它们相同的概率。\n它们相同的概率是它们同为 $A$、同为 $C$、同为 $G$ 或同为 $T$ 的概率之和。\n让我们计算它们同为核苷酸类型 $k$ 的概率。假设祖先序列处于平衡状态（所有 $j \\in \\{A, C, G, T\\}$ 的碱基频率为 $\\pi_j = 1/4$），这个概率是：\n$$\nP(\\text{both are } k) = \\sum_{j \\in \\{A,C,G,T\\}} \\pi_j P(\\text{lineage 1 is } k | \\text{anc is } j) P(\\text{lineage 2 is } k | \\text{anc is } j)\n$$\n利用谱系的独立性和 $\\pi_j = 1/4$：\n$$\nP(\\text{both are } k) = \\frac{1}{4} \\sum_j (P_{jk}(T))^2\n$$\n由于 JC 模型的对称性，这个和与 $k$ 无关。让我们为一个任意的 $k$ 计算它：\n$$\n\\sum_j (P_{jk}(T))^2 = (P_{kk}(T))^2 + 3(P_{ik}(T))^2 \\quad (i \\neq k)\n$$\n代入 $P_{ii}(T)$ 和 $P_{ij}(T)$ 的表达式，并令 $E = \\exp(-\\frac{4\\mu T}{3})$：\n$$\n\\sum_j (P_{jk}(T))^2 = \\left(\\frac{1}{4} + \\frac{3}{4}E\\right)^2 + 3\\left(\\frac{1}{4} - \\frac{1}{4}E\\right)^2 = \\frac{1}{16}(1+6E+9E^2) + \\frac{3}{16}(1-2E+E^2) = \\frac{1}{4} + \\frac{3}{4}E^2\n$$\n两个谱系都具有核苷酸 $k$ 的概率是 $\\frac{1}{4}(\\frac{1}{4} + \\frac{3}{4}E^2) = \\frac{1}{16} + \\frac{3}{16}E^2$。\n位点相同的总概率是 $k$ 的所有4种可能性的总和：\n$$\nP(\\text{identical}) = 4 \\times \\left(\\frac{1}{16} + \\frac{3}{16}E^2\\right) = \\frac{1}{4} + \\frac{3}{4}E^2 = \\frac{1}{4} + \\frac{3}{4}\\exp\\left(-\\frac{8\\mu T}{3}\\right)\n$$\n位点不同的概率 $p$ 是 $1 - P(\\text{identical})$：\n$$\np = 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp\\left(-\\frac{8\\mu T}{3}\\right)\\right) = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{8\\mu T}{3}\\right)\\right)\n$$\n这就是所要求的关系。观测到的差异分数 $\\hat{p}$ 是期望分数 $p$ 的一个估计值。对于大量的位点 $L = 1.0 \\times 10^7$，我们令 $\\hat{p} = p$。\n\n接下来，我们使用这个关系来计算以年为单位的分化时间。给定：\n$\\hat{p} = 0.060$\n$\\mu = 1.1 \\times 10^{-8}$ 每位点每代\n$g = 20$ 年每代\n\n我们将 $\\hat{p}$ 代入推导出的方程，解出 $T$（以世代为单位）：\n$$\n0.060 = \\frac{3}{4}\\left(1 - \\exp\\left(-\\frac{8\\mu T}{3}\\right)\\right)\n$$\n$$\n\\frac{4}{3} \\times 0.060 = 1 - \\exp\\left(-\\frac{8\\mu T}{3}\\right)\n$$\n$$\n0.080 = 1 - \\exp\\left(-\\frac{8\\mu T}{3}\\right)\n$$\n$$\n\\exp\\left(-\\frac{8\\mu T}{3}\\right) = 1 - 0.080 = 0.920\n$$\n取两边的自然对数：\n$$\n-\\frac{8\\mu T}{3} = \\ln(0.920)\n$$\n$$\nT = -\\frac{3 \\ln(0.920)}{8\\mu}\n$$\n现在，代入 $\\mu = 1.1 \\times 10^{-8}$ 的值：\n$$\nT = -\\frac{3 \\ln(0.920)}{8 \\times (1.1 \\times 10^{-8})} = -\\frac{3 \\ln(0.920)}{8.8 \\times 10^{-8}}\n$$\n使用计算器，$\\ln(0.920) \\approx -0.0833816$。\n$$\nT \\approx -\\frac{3 \\times (-0.0833816)}{8.8 \\times 10^{-8}} = \\frac{0.2501448}{8.8 \\times 10^{-8}} \\approx 2.8425548 \\times 10^6 \\text{ 世代}\n$$\n为了求得以年为单位的分化时间 $T_{years}$，我们将以世代为单位的时间乘以世代时间 $g$：\n$$\nT_{years} = T \\times g \\approx (2.8425548 \\times 10^6) \\times 20 = 56851096 \\text{ 年}\n$$\n问题要求答案四舍五入至四位有效数字。\n$$\nT_{years} \\approx 5.685 \\times 10^7 \\text{ 年}\n$$\n这是最终的数值答案。", "answer": "$$\\boxed{5.685 \\times 10^{7}}$$", "id": "2706423"}, {"introduction": "并非所有的进化变化都是中性的；自然选择扮演着关键角色。一个核心挑战是通过分析物种内部的变异和物种之间的差异模式，来区分中性漂变和自然选择的影响。麦当劳-克雷特曼（McDonald-Kreitman, MK）检验为此任务提供了一个强有力的框架。通过比较多态性位点与固定差异位点中非同义替换与同义替换的比例，我们可以检测到正选择的信号 [@problem_id:2706400]。本练习将指导你应用MK检验，从计算中性指数到估算适应性替换的比例 $\\alpha$，为你提供一个利用群体遗传学和分化数据检验适应性进化的具体方法。", "problem": "一对密切相关的二倍体物种已在足够大量的独立常染色体编码基因座上进行了取样。在每个基因座上，根据功能效应（非同义与同义）和进化类别（物种内多态性与物种间固定差异）对位点进行分类。设 $P_{N}$ 和 $P_{S}$ 分别表示非同义和同义多态性位点的总数，设 $D_{N}$ 和 $D_{S}$ 分别表示非同义和同义固定差异的总数。对于这些数据，观测到的计数为 $P_{N}=12$，$P_{S}=40$，$D_{N}=30$，$D_{S}=50$。\n\n从中性理论的预期出发，即在没有选择的情况下，物种内（多态性）和物种间（分化）的非同义与同义变化的比例相同，并且同义变化主要反映了中性突变过程，请完成以下任务：\n\n1) 使用 McDonald–Kreitman (MK) 框架，将中性指数 $NI$ 定义为多态性中非同义与同义变化的几率相对于分化中非同义与同义变化的几率之比，并根据这四个计数计算其值。\n\n2) 对一个 $2\\times 2$ 列联表进行 Fisher 精确检验，其中行由功能类别（$\\text{非同义}$，$\\text{同义}$）给出，列由进化类别（$\\text{多态性}$，$\\text{分化}$）给出。假设边际值由抽样设计固定。报告与非同义分化相对于非同义多态性过量（即非同义多态性不足）相对应的备择假设的单侧精确 $p$ 值，将 $p$ 值表示为封闭形式的有限超几何尾部概率。\n\n3) 使用标准的 MK 逻辑，将同义类别等同于中性，从而将非同义分化划分为中性和适应性成分，推导适应性非同义替换比例 $\\alpha$ 的估计量（用 $P_{N}$、$P_{S}$、$D_{N}$ 和 $D_{S}$ 表示），然后根据给定数据计算其值。\n\n将您的最终答案以单行向量 $(NI,\\;p\\text{-值},\\;\\alpha)$ 的形式给出。如果数值是精确的，请精确报告；将 Fisher 单侧 $p$ 值表示为无需数值计算的封闭形式有限和。不需要单位。如果您选择额外对任何量进行数值计算以供核对，请四舍五入到四位有效数字，但最终报告的答案必须保持上述指定的精确形式。", "solution": "该问题要求计算与 McDonald-Kreitman (MK) 检验框架相关的三个量。\n\n**1) 中性指数 ($NI$) 的计算**\n\n中性指数 $NI$ 定义为多态性阶段非同义与同义变化的几率与固定分化阶段非同义与同义变化的几率之比。这是一个优势比（odds ratio）。\n\n非同义多态性相对于同义多态性的几率由比率 $\\frac{P_{N}}{P_{S}}$ 给出。\n非同义固定差异相对于同义固定差异的几率由比率 $\\frac{D_{N}}{D_{S}}$ 给出。\n\n中性指数 $NI$ 是这两个几率的比：\n$$NI = \\frac{P_{N} / P_{S}}{D_{N} / D_{S}} = \\frac{P_{N} D_{S}}{P_{S} D_{N}}$$\n在中性无效假设下，选择对非同义突变在多态性和分化上的作用相似，我们预期 $NI = 1$。$NI  1$ 的值表明非同义分化过量，这被解释为正选择导致适应性固定的证据。$NI  1$ 的值表明非同义多态性过量，这被解释为纯化选择移除了作为多态性存在但不太可能被固定的弱有害等位基因的证据。\n\n代入给定的计数：$P_{N}=12$，$P_{S}=40$，$D_{N}=30$，$D_{S}=50$。\n$$NI = \\frac{12 \\times 50}{40 \\times 30} = \\frac{600}{1200} = \\frac{1}{2}$$\n\n**2) Fisher 精确检验 $p$ 值**\n\n该问题指定使用 Fisher 精确检验进行列联表分析。数据构成一个 $2 \\times 2$ 表：\n\n| 类别 | 多态性 ($P$) | 分化 ($D$) | 行总计 |\n|---|---|---|---|\n| 非同义 ($N$) | $P_{N}=12$ | $D_{N}=30$ | $R_1=42$ |\n| 同义 ($S$) | $P_{S}=40$ | $D_{S}=50$ | $R_2=90$ |\n| 列总计 | $C_1=52$ | $C_2=80$ | $N_{总计}=132$ |\n\n无效假设是，变化的类别（非同义 vs. 同义）与进化阶段（多态性 vs. 分化）无关。Fisher 精确检验计算在行和列总计（边际值）固定的情况下，观察到与观测表一样极端或更极端的表的概率。左上角单元格计数为 $a$（这里 $a = P_N$）的特定表格配置的概率由超几何分布给出：\n$$P(P_{N}=k) = \\frac{\\binom{P_{N}+D_{N}}{k} \\binom{P_{S}+D_{S}}{P_{N}+P_{S}-k}}{\\binom{N_{总计}}{P_{N}+P_{S}}}$$\n备择假设被指定为“非同义分化相对于非同义多态性过量（即非同义多态性不足）”。这对应于正选择，并意味着观测到的 $P_{N}$ 值小于中性预期值。因此，单侧 $p$ 值是 $P_{N}$ 计数小于或等于观测值 $12$ 的所有表的概率之和。\n\n$p$ 值是所有 $P_{N} \\in \\{0, 1, ..., 12\\}$ 的表的超几何概率之和：\n$$p\\text{-值} = P(P_{N} \\le 12) = \\sum_{k=0}^{12} P(P_{N}=k)$$\n将边际总计代入公式：\n$$p\\text{-值} = \\sum_{k=0}^{12} \\frac{\\binom{42}{k} \\binom{90}{52-k}}{\\binom{132}{52}}$$\n这是所要求的单侧 $p$ 值的封闭形式表达式。\n\n**3) 适应性非同义替换的比例 ($\\alpha$)**\n\n适应性非同义替换的比例 $\\alpha$ 是通过将观测到的非同义固定差异数 $D_N$ 与中性模型下预期的数量进行比较来估计的。MK 逻辑使用同义类别作为中性基准。\n\n在中性条件下，非同义与同义变化的比例对于多态性和固定差异应相同：\n$$\\frac{D_{N, \\text{中性}}}{D_{S}} = \\frac{P_{N}}{P_{S}}$$\n其中 $D_{N, \\text{中性}}$ 是中性累积的非同义固定差异的预期数量。根据这种关系，我们可以估计 $D_{N, \\text{中性}}$：\n$$D_{N, \\text{中性}} = D_{S} \\frac{P_{N}}{P_{S}}$$\n观测到的非同义固定 ($D_{N}$) 超过此中性预期的任何部分都归因于适应性进化（正选择）。因此，适应性非同义替换的数量 $D_{N, \\text{适应性}}$ 为：\n$$D_{N, \\text{适应性}} = D_{N} - D_{N, \\text{中性}} = D_{N} - D_{S} \\frac{P_{N}}{P_{S}}$$\n适应性非同义替换的比例 $\\alpha$ 是所有非同义替换中适应性替换所占的比例：\n$$\\alpha = \\frac{D_{N, \\text{适应性}}}{D_{N}} = \\frac{D_{N} - D_{S} \\frac{P_{N}}{P_{S}}}{D_{N}} = 1 - \\frac{P_{N} D_{S}}{P_{S} D_{N}}$$\n该表达式等价于 $1 - NI$。\n\n使用给定数据：\n$$\\alpha = 1 - \\frac{12 \\times 50}{40 \\times 30} = 1 - \\frac{600}{1200} = 1 - \\frac{1}{2} = \\frac{1}{2}$$\n如果 $D_{N}  D_{S} \\frac{P_{N}}{P_{S}}$，$\\alpha$ 将为负值，通常解释为 $\\alpha=0$，因为比例不能为负。在这种情况下，由于 $NI  1$，计算得出的 $\\alpha$ 为正值。\n\n最终结果为 $NI = \\frac{1}{2}$，$p$ 值是如上推导的和，$\\alpha = \\frac{1}{2}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2},  \\sum_{k=0}^{12} \\frac{\\binom{42}{k} \\binom{90}{52-k}}{\\binom{132}{52}},  \\frac{1}{2} \\end{pmatrix} } $$", "id": "2706400"}]}