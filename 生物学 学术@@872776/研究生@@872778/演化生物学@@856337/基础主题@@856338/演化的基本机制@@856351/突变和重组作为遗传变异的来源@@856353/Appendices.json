{"hands_on_practices": [{"introduction": "突变是遗传变异的最终来源，但它并非在基因组上均匀发生。本练习探讨了突变率异质性的一个典型例子：哺乳动物基因组中CpG二核苷酸上因甲基化而升高的C→T突变率。通过从第一性原理推导，您将量化这些“突变热点”对新生突变总数的贡献，这是理解基因组演化模式和疾病遗传学的一项基本技能 [@problem_id:2751518]。", "problem": "在一个拥有脱氧核糖核酸（DNA）的大型异交真核生物群体中，考虑从胞嘧啶到胸腺嘧啶的新生点突变。假设在5'到3'方向上胞嘧啶后跟着鸟嘌呤（CpG二核苷酸上下文）的情况下，相对于非CpG位点的胞嘧啶，其每个位点每个世代的胞嘧啶到胸腺嘧啶的突变率会因甲基化而升高。设基因组中胞嘧啶的总数为 $N_{C}$，并且这些胞嘧啶中有一部分比例 $f_{\\text{CpG}}$ 出现在CpG上下文中。假设在一个世代内，突变是跨位点发生的独立稀有事件，因此期望事件数是所有位点上单位点速率的总和，并且观测到的计数在泊松过程模型下与期望值成正比。令 $r_{m}$ 表示CpG位点胞嘧啶（假定为甲基化的）每个位点每个世代的胞嘧啶到胸腺嘧啶的突变率，而 $r_{b}$ 表示非CpG位点胞嘧啶（基线）每个位点每个世代的胞嘧啶到胸腺嘧啶的突变率。\n\n仅使用单位点突变率的定义、关于位点类别的全期望定律以及独立位点的稀有事件近似，从第一性原理推导出一个表达式，用于计算单个世代内在CpG位点发生的新生胞嘧啶到胸腺嘧啶突变的期望比例 $F$。该表达式用 $f_{\\text{CpG}}$、$r_{m}$ 和 $r_{b}$ 表示。\n\n然后，使用以下经验驱动的参数值计算 $F$：$f_{\\text{CpG}} = 0.02$，$r_{m} = 5 \\times 10^{-7}$ 每个位点每个世代，以及 $r_{b} = 1 \\times 10^{-8}$ 每个位点每个世代。将您的最终答案表示为无单位小数，并四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，阐述清晰且客观。它基于分子进化的既定原则，特别是突变率的异质性，并使用标准的数学建模假设来计算期望结果。所有必要的参数都已提供，以获得唯一解。因此，我们开始进行推导和计算。\n\n问题要求计算在CpG位点发生的新生胞嘧啶到胸腺嘧啶（C→T）突变的期望比例 $F$。我们首先根据问题陈述定义所涉及的量。\n\n设 $N_C$ 为基因组中胞嘧啶核苷酸的总数。\n所有胞嘧啶的集合可以划分为两个不相交的类别：属于CpG二核苷酸上下文的胞嘧啶，和不属于的胞嘧啶。\n\n在CpG上下文中的胞嘧啶数量由下式给出：\n$$N_{\\text{CpG}} = f_{\\text{CpG}} N_C$$\n其中 $f_{\\text{CpG}}$ 是在此上下文中的胞嘧啶比例。\n\n因此，在非CpG上下文中的胞嘧啶数量为：\n$$N_{\\text{non-CpG}} = (1 - f_{\\text{CpG}}) N_C$$\n\n问题定义了两种不同的针对C→T转换的每个位点每个世代的突变率：\n$r_m$：CpG位点的突变率。\n$r_b$：非CpG位点的突变率（基线）。\n\n在突变是稀有、独立事件的假设下，给定类别位点中的期望突变数是该类别中位点数与单位点突变率的乘积。\n\n在一个世代内，源于CpG位点的C→T突变的期望数 $E[M_{\\text{CpG}}]$ 为：\n$$E[M_{\\text{CpG}}] = N_{\\text{CpG}} \\cdot r_m = (f_{\\text{CpG}} N_C) r_m$$\n\n同样，源于非CpG位点的C→T突变的期望数 $E[M_{\\text{non-CpG}}]$ 为：\n$$E[M_{\\text{non-CpG}}] = N_{\\text{non-CpG}} \\cdot r_b = ((1 - f_{\\text{CpG}}) N_C) r_b$$\n\n根据全期望定律，每个世代新生C→T突变的总期望数 $E[M_{\\text{total}}]$ 是这两个不相交位点类别的期望数之和：\n$$E[M_{\\text{total}}] = E[M_{\\text{CpG}}] + E[M_{\\text{non-CpG}}]$$\n$$E[M_{\\text{total}}] = (f_{\\text{CpG}} N_C) r_m + ((1 - f_{\\text{CpG}}) N_C) r_b$$\n提取公因数，即胞嘧啶总数 $N_C$：\n$$E[M_{\\text{total}}] = N_C (f_{\\text{CpG}} r_m + (1 - f_{\\text{CpG}}) r_b)$$\n\n所求的量 $F$ 是在CpG位点发生的总C→T突变的期望比例。这是CpG位点期望突变数与总C→T突变期望数之比：\n$$F = \\frac{E[M_{\\text{CpG}}]}{E[M_{\\text{total}}]}$$\n代入上面推导出的表达式：\n$$F = \\frac{(f_{\\text{CpG}} N_C) r_m}{N_C (f_{\\text{CpG}} r_m + (1 - f_{\\text{CpG}}) r_b)}$$\n分子和分母中的项 $N_C$相互抵消，这是合乎逻辑的，因为该比例应与基因组大小无关。这就得出了用给定参数表示的 $F$ 的最终表达式：\n$$F = \\frac{f_{\\text{CpG}} r_m}{f_{\\text{CpG}} r_m + (1 - f_{\\text{CpG}}) r_b}$$\n\n现在，我们必须使用提供的参数值来计算这个表达式：\n$f_{\\text{CpG}} = 0.02$\n$r_m = 5 \\times 10^{-7}$\n$r_b = 1 \\times 10^{-8}$\n\n首先，我们计算表达式中的各项。\n分子是：\n$$f_{\\text{CpG}} r_m = (0.02) \\times (5 \\times 10^{-7}) = 0.1 \\times 10^{-7} = 1 \\times 10^{-8}$$\n分母由两项组成。第一项与分子相同：\n$$f_{\\text{CpG}} r_m = 1 \\times 10^{-8}$$\n分母中的第二项是：\n$$(1 - f_{\\text{CpG}}) r_b = (1 - 0.02) \\times (1 \\times 10^{-8}) = 0.98 \\times (1 \\times 10^{-8}) = 0.98 \\times 10^{-8}$$\n分母是这两项的和：\n$$f_{\\text{CpG}} r_m + (1 - f_{\\text{CpG}}) r_b = (1 \\times 10^{-8}) + (0.98 \\times 10^{-8}) = (1 + 0.98) \\times 10^{-8} = 1.98 \\times 10^{-8}$$\n最后，我们计算比例 $F$：\n$$F = \\frac{1 \\times 10^{-8}}{1.98 \\times 10^{-8}} = \\frac{1}{1.98}$$\n进行除法运算：\n$$F \\approx 0.50505050...$$\n按照要求，将结果四舍五入到四位有效数字，我们得到：\n$$F \\approx 0.5051$$\n这一结果表明，在给定参数下，尽管CpG位点仅占所有胞嘧啶的$2\\%$，但预计超过一半的新生胞嘧啶到胸腺嘧啶突变都发生在CpG位点。这是突变率显著升高（$r_m$ 是 $r_b$ 的50倍）的直接结果。", "answer": "$$\\boxed{0.5051}$$", "id": "2751518"}, {"introduction": "重组本身也可以通过一种称为偏向性基因转换（Biased Gene Conversion, BGC）的机制来塑造序列演化，这导致了所谓的“热点悖论”：重组热点会驱动其自身的消亡。本练习将这一复杂的演化动态抽象为一个简洁的连续时间马尔可夫链（CTMC）模型。通过分析这个随机过程，您将推导出重组热点的预期寿命，这体现了如何运用数学模型来理解驱动基因组结构演化的内在冲突 [@problem_id:2751595]。", "problem": "在一个重组基因组中，重组热点由短DNA序列基序指定。考虑以下受热点悖论启发的机理图景。当一个基序产生一个热点时，集中在该热点的重组事件会诱发有偏基因转换（Biased Gene Conversion, BGC），该过程会将热点基序替换为其非热点变体，从而随时间侵蚀该热点。新的热点基序通过突变以某一较低的速率从头产生，在不同基因组位置上相互独立，且在给定位置上热点不重叠。假设如下：\n\n- 每个基因组位置可以处于两种状态之一：非热点 ($0$) 或热点 ($1$)。\n- 状态 $0 \\to 1$ 的转换以每个位置恒定的从头热点基序产生率 $\\mu_{h}$ 发生，反映了突变起源。\n- 状态 $1 \\to 0$ 的转换以每个位置恒定的热点侵蚀率 $\\alpha$ 发生，反映了BGC诱导的基序丢失。\n- 转换是一个具有时齐速率的无记忆连续时间过程，且不存在其他转换或状态。\n\n将单个基因组位置的动力学视为一个双态连续时间马尔可夫链（Continuous-Time Markov Chain, CTMC），并定义随机变量 $T$ 为该位置上一个热点的寿命，其度量始于该位置上热点被创造的瞬间（即发生 $0 \\to 1$ 转换），止于它下一次消失的瞬间（即第一次发生 $1 \\to 0$ 转换）。严格从转移率的定义和时齐CTMC的无穷小形式出发，推导在该生灭过程中 $T$ 的生存函数 $S(t) = \\Pr(T \\ge t)$ 和相应的概率密度函数 $f(t)$，并明确论证为何在热点寿命期间的从头产生事件不改变 $T$。然后以闭合形式计算平均热点寿命 $\\mathbb{E}[T]$。\n\n将平均热点寿命的最终答案表示为仅含 $\\alpha$ 的单个解析表达式。无需四舍五入。无需单位，因为 $t$ 的度量单位与定义 $\\alpha$ 和 $\\mu_{h}$ 所用的任意时间单位相同。", "solution": "问题陈述经过验证。\n\n步骤1：提取给定条件。\n- 系统是单个基因组位置。\n- 状态空间：{$0$ (非热点), $1$ (热点)}。\n- 转换：一个连续时间马尔可夫链 (CTMC) 过程。\n- 从状态 $0$ 到状态 $1$ 的转移率：$\\mu_h$。\n- 从状态 $1$ 到状态 $0$ 的转移率：$\\alpha$。\n- 该过程是无记忆的，且具有时齐速率。\n- 不可能存在其他状态或转换。\n- 随机变量 $T$ 定义为一个热点的寿命，从发生 $0 \\to 1$ 转换的瞬间开始，到首次后续的 $1 \\to 0$ 转换结束。\n- 任务是推导生存函数 $S(t) = \\Pr(T \\ge t)$、概率密度函数 $f(t)$ 以及平均热点寿命 $\\mathbb{E}[T]$。需要论证为何速率 $\\mu_h$ 不影响 $T$。\n\n步骤2：使用提取的给定条件进行验证。\n- **科学依据**：该问题是随机过程理论（具体来说，是一个双态CTMC，也称为生灭过程）在模拟演化遗传学中一个公认概念——“热点悖论”方面的标准且有效的应用，该悖论涉及突变、重组和有偏基因转换。该模型是一个简化模型，但在科学上是合理的，并且适合于理论研究。\n- **良态问题**：该问题是良态的。它定义了一个完备的双态CTMC，并要求计算在其中一个状态的等待时间（逗留时间）的分布和均值。这是随机过程理论中一个经典的、可解的问题，具有唯一且有意义的解。\n- **客观性**：该问题以精确、客观和形式化的数学语言陈述。\n- **结论**：该问题是有效的。这是一个将标准数学模型应用于生物学现象的严谨练习。\n\n步骤3：裁定与行动。\n问题有效。将提供解答。\n\n令 $X(t)$ 表示基因组位置在时间 $t$ 的状态，其中 $X(t) \\in \\{0, 1\\}$。该问题描述了一个双态连续时间马尔可夫链。转移率给定为 $q_{01} = \\mu_h$ 和 $q_{10} = \\alpha$。此过程的生成元矩阵 $Q$ 为：\n$$\nQ = \\begin{pmatrix} -\\mu_h & \\mu_h \\\\ \\alpha & -\\alpha \\end{pmatrix}\n$$\n随机变量 $T$ 是热点的寿命。这对应于在状态 $1$ 中的等待时间，或称逗留时间。该过程在时间 $t=0$ 时从状态 $1$ 开始（或者更精确地说，我们以过程刚刚进入状态 $1$ 这一事件为条件），$T$ 是直到过程首次离开状态 $1$ 所经过的时间。\n\n时齐CTMC的一个基本性质是，在任何状态 $i$ 的逗留时间服从指数分布。该分布的速率参数是离开状态 $i$ 的总速率，由 $\\lambda_i = -q_{ii} = \\sum_{j \\neq i} q_{ij}$ 给出。\n对于热点的寿命，我们关心的是在状态 $1$ 的逗留时间。离开状态 $1$ 的总速率是 $\\lambda_1 = -q_{11} = q_{10} = \\alpha$。该过程是无记忆的，意味着从一个状态开始的未来演化只取决于当前状态，而与到达该状态的路径无关。因此，在过程处于状态 $1$ 的条件下，直到下一次转换发生的时间仅取决于离开状态 $1$ 的速率。速率 $\\mu_h = q_{01}$ 是离开状态 $0$ 的速率，它与在状态 $1$ 中停留的时间长度无关。这明确地论证了为什么从头产生率 $\\mu_h$ 不会改变热点寿命 $T$。寿命 $T$ 完全由其自身的销毁机制决定，该机制以速率 $\\alpha$ 发生。\n\n我们现在从第一性原理推导生存函数 $S(t) = \\Pr(T \\ge t)$。$S(t)$ 是指系统在时间 $0$ 进入状态 $1$ 后，在状态 $1$ 中至少停留时间 $t$ 的概率。让我们考虑一个微小的时间间隔 $\\Delta t$。在此间隔内从状态 $1$ 转换到状态 $0$ 的概率由无穷小转移概率给出：\n$$\n\\Pr(X(t+\\Delta t)=0 | X(t)=1) = \\alpha \\Delta t + o(\\Delta t)\n$$\n因此，停留在状态 $1$ 的概率是：\n$$\n\\Pr(X(t+\\Delta t)=1 | X(t)=1) = 1 - \\alpha \\Delta t + o(\\Delta t)\n$$\n生存函数 $S(t) = \\Pr(\\text{在 } [0, t] \\text{ 内没有离开状态 1 的转换})$。利用马尔可夫链的时齐性和无记忆性：\n$$\nS(t+\\Delta t) = \\Pr(\\text{在 } [0, t+\\Delta t] \\text{ 内没有转换}) = \\Pr(\\text{在 } [0, t] \\text{ 内没有转换}) \\times \\Pr(\\text{在 } (t, t+\\Delta t] \\text{ 内没有转换} | \\text{在 } [0, t] \\text{ 内没有转换})\n$$\n$$\nS(t+\\Delta t) = S(t) \\times (1 - \\alpha \\Delta t + o(\\Delta t))\n$$\n重新整理各项，我们得到：\n$$\n\\frac{S(t+\\Delta t) - S(t)}{\\Delta t} = - \\alpha S(t) + \\frac{o(\\Delta t)}{\\Delta t}\n$$\n取极限 $\\Delta t \\to 0$，我们得到微分方程：\n$$\n\\frac{dS(t)}{dt} = - \\alpha S(t)\n$$\n这是一个一阶线性常微分方程。初始条件是 $S(0) = \\Pr(T \\ge 0) = 1$，因为寿命必须是非负的。给定此初始条件的常微分方程的解是：\n$$\nS(t) = \\exp(-\\alpha t) \\quad \\text{for } t \\ge 0\n$$\n这就是热点寿命 $T$ 的生存函数。\n\n接下来，我们推导概率密度函数 (PDF) $f(t)$。PDF 与生存函数 $S(t)$ 以及累积分布函数 $F(t) = \\Pr(T \\le t) = 1 - S(t)$ 的关系为 $f(t) = \\frac{dF(t)}{dt} = -\\frac{dS(t)}{dt}$。\n$$\nf(t) = -\\frac{d}{dt} (\\exp(-\\alpha t)) = -(-\\alpha \\exp(-\\alpha t)) = \\alpha \\exp(-\\alpha t) \\quad \\text{for } t \\ge 0\n$$\n这证实了 $T$ 服从速率参数为 $\\alpha$ 的指数分布，记为 $T \\sim \\text{Exp}(\\alpha)$。\n\n最后，我们计算平均热点寿命 $\\mathbb{E}[T]$。对于一个非负随机变量，其期望可以通过对生存函数在其支撑集上积分来计算：\n$$\n\\mathbb{E}[T] = \\int_{0}^{\\infty} S(t) dt\n$$\n代入推导出的生存函数：\n$$\n\\mathbb{E}[T] = \\int_{0}^{\\infty} \\exp(-\\alpha t) dt\n$$\n我们计算这个积分：\n$$\n\\mathbb{E}[T] = \\left[ -\\frac{1}{\\alpha} \\exp(-\\alpha t) \\right]_{0}^{\\infty} = \\lim_{t \\to \\infty} \\left( -\\frac{1}{\\alpha} \\exp(-\\alpha t) \\right) - \\left( -\\frac{1}{\\alpha} \\exp(0) \\right)\n$$\n由于 $\\alpha > 0$ （速率必须是非负的，如果 $\\alpha=0$，热点永远不会消失，导致寿命无限长），极限项趋于零：\n$$\n\\mathbb{E}[T] = 0 - \\left( -\\frac{1}{\\alpha} \\right) = \\frac{1}{\\alpha}\n$$\n热点的平均寿命是其侵蚀率的倒数。", "answer": "$$\n\\boxed{\\frac{1}{\\alpha}}\n$$", "id": "2751595"}, {"introduction": "在理论上理解突变过程之后，我们面临着在真实的基因组数据中识别它们的实际挑战。从测序数据中准确鉴定稀有的新生突变，本质上是一个在真实生物信号和技术噪声（如测序错误）之间进行区分的统计问题。本练习将引导您构建一个贝叶斯框架，用以评估突变检测规则的性能，并推导检测效力（detection power）和错误发现率（False Discovery Rate, FDR）等关键指标，这些是在现代基因组学研究中必不可少的技能 [@problem_id:2751574]。", "problem": "在一个亲子三人组中，我们对一个双等位基因位点进行探查。假设该位点在群体中对于参考等位基因是单态的，因此后代中的任何替代等位基因要么是真正的从头突变，要么是测序假象。设每个位点、每一代的真实从头突变的先验概率为 $\\,\\mu\\,$。每个个体（后代和2个亲本）在该位点上都被测序，测序深度为 $\\,d\\,$ 条独立读数（reads）。每条读数都是一个独立的观测，它以概率 $\\,e\\,$ 报告错误的等位基因（将参考等位基因翻转为替代等位基因，或将替代等位基因翻转为参考等位基因），并以概率 $\\,1-e\\,$ 报告正确的等位基因。在一个真实的从头突变事件下，后代是杂合子（一个参考等位基因和一个替代等位基因），每条读数以相等的概率 $\\,1/2\\,$ 从两条同源染色体中抽样。\n\n我们采用一个简单的判别规则：当且仅当后代在该位点至少有一条读数支持替代等位基因，而双亲均没有读数支持替代等位基因时，才判定为一次从头突变。\n\n从读数的二项抽样、孟德尔分离定律（杂合子中等位基因的均等抽样）和贝叶斯定理出发，推导：\n\n- 检测效能（在上述规则下，一个真实的从头突变被判定的概率），作为 $\\,d\\,$ 和 $\\,e\\,$ 的函数。\n- 假发现率（FDR；在规则被触发的情况下，该判定为假的后验概率），作为 $\\,d\\,$、$\\,e\\,$ 和 $\\,\\mu\\,$ 的函数。\n\n将 FDR 以闭合形式表示为仅含 $\\,d\\,$、$\\,e\\,$ 和 $\\,\\mu\\,$ 的单个解析表达式。不需要进行数值计算。如果引入了中间符号，必须将其消去，以使最终表达式仅依赖于 $\\,d\\,$、$\\,e\\,$ 和 $\\,\\mu\\,$。最终答案必须是无单位的单个解析表达式。", "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n\n-   **系统**：一个亲子三人组（后代、亲本1、亲本2）。\n-   **基因位点**：一个单一的双等位基因组位点。\n-   **群体状态**：该位点在群体中对参考等位基因是单态的。\n-   **突变先验**：每个位点、每一代的真实*从头*突变的先验概率为 $\\mu$。\n-   **测序数据**：3个个体中的每一个都被测序，深度为 $d$ 条独立读数。\n-   **误差模型**：每条读数以概率 $e$ 报告错误的等位基因，以概率 $1-e$ 报告正确的等位基因。\n-   **杂合子抽样**：在杂合子中（一个参考等位基因，一个替代等位基因），每条读数以相等的概率 $\\frac{1}{2}$ 从两条同源染色体中的一条进行抽样。\n-   **判别规则**：当且仅当后代至少有一条读数支持替代等位基因，且双亲均没有读数支持替代等位基因时，才判定为一次*从头*突变。\n-   **要求推导**：\n    1.  检测效能，作为 $d$ 和 $e$ 的函数。\n    2.  假发现率（FDR），作为 $d$、$e$ 和 $\\mu$ 的函数。\n-   **最终输出要求**：一个关于 FDR 的单一闭合形式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题是群体遗传学和生物信息学中一个用于检测*从头*突变的成熟（尽管简化了）的模型。它正确地使用了先验概率、测序误差模型（二项抽样）、孟德尔分离定律和贝叶斯推断等概念。诸如单态背景和统一错误率等假设是创建易于处理的分析模型的标准做法。该模型在基本结构上是科学合理的、符合实际的。\n-   **良态问题**：问题陈述清晰。所有必要的参数（$d$, $e$, $\\mu$）和规则（判别标准，误差模型）都已定义，从而可以推导出所要求的量（检测效能和FDR）。存在唯一、稳定且有意义的解。\n-   **客观性**：问题以精确、定量和无偏见的语言表述。它不包含主观或基于观点的陈述。\n\n### 步骤 3：结论与行动\n\n该问题是有效的，因为它具有科学依据、是良态问题、客观，并且没有明显缺陷。将推导解答。\n\n### 推导过程\n\n设 $M$ 为后代发生真实*从头*突变的事件。根据题意，其先验概率为 $P(M) = \\mu$。其互补事件 $\\neg M$（即未发生突变）的概率为 $P(\\neg M) = 1 - \\mu$。\n\n判别规则定义了一个事件 $C$。设 $k_O$、$k_{P1}$ 和 $k_{P2}$ 分别为后代、亲本1和亲本2在总共 $d$ 条读数中支持替代等位基因的读数数量。事件 $C$ 的形式化定义为：\n$$C \\iff (k_O \\geq 1) \\land (k_{P1} = 0) \\land (k_{P2} = 0)$$\n\n任何个体的替代等位基因读数数量遵循二项分布，$k \\sim \\text{Binomial}(d, p)$，其中 $p$ 是单条读数报告替代等位基因的概率。这个概率 $p$ 取决于个体的真实基因型。\n\n如果一个个体是参考等位基因纯合子（Ref/Ref），那么观察到替代等位基因读数只能是由于测序错误。抽样到参考等位基因的概率是 $1$，而它被错误地报告为替代等位基因的概率是 $e$。因此，对于一个 Ref/Ref 个体：\n$$p_{\\text{Ref/Ref}} = e$$\n双亲来自一个单态的参考群体，因此他们是 Ref/Ref。如果没有发生突变（$\\neg M$），后代也是 Ref/Ref。\n\n如果一个个体是杂合子（Ref/Alt），即事件 $M$ 发生时后代的情况，一条读数可以通过两种方式成为替代等位基因读数：正确读取替代等位基因，或错误读取参考等位基因。单条读数抽样到替代等位基因染色体的概率为 $\\frac{1}{2}$，抽样到参考等位基因染色体的概率为 $\\frac{1}{2}$。\n一条读数为替代等位基因的概率是：\n$$p_{\\text{Het}} = P(\\text{read is Alt} | \\text{sampled Alt})P(\\text{sampled Alt}) + P(\\text{read is Alt} | \\text{sampled Ref})P(\\text{sampled Ref})$$\n$$p_{\\text{Het}} = (1-e)\\left(\\frac{1}{2}\\right) + (e)\\left(\\frac{1}{2}\\right) = \\frac{1-e+e}{2} = \\frac{1}{2}$$\n所以，对于一个杂合子个体，替代等位基因读数的数量分布为 $k \\sim \\text{Binomial}(d, \\frac{1}{2})$。\n\n**1. 检测效能**\n\n检测效能是在真实突变发生的情况下，判定其为突变的概率。这即是 $P(C|M)$。由于每个个体的测序是独立过程，我们有：\n$$P(C|M) = P(k_O \\geq 1 | M) \\times P(k_{P1} = 0 | M) \\times P(k_{P2} = 0 | M)$$\n对于后代，在给定事件 $M$ 的情况下，其基因型为杂合子（Het）。因此，$k_O \\sim \\text{Binomial}(d, \\frac{1}{2})$。\n$$P(k_O \\geq 1 | M) = 1 - P(k_O = 0 | M) = 1 - \\binom{d}{0}\\left(\\frac{1}{2}\\right)^0\\left(1-\\frac{1}{2}\\right)^{d} = 1 - \\left(\\frac{1}{2}\\right)^d = 1 - 2^{-d}$$\n双亲是 Ref/Ref。因此，$k_{P1}, k_{P2} \\sim \\text{Binomial}(d, e)$。\n$$P(k_{P1} = 0 | M) = \\binom{d}{0}e^0(1-e)^{d} = (1-e)^d$$\n$$P(k_{P2} = 0 | M) = (1-e)^d$$\n结合这些结果，检测效能为：\n$$\\text{Power} = P(C|M) = (1 - 2^{-d})(1-e)^{2d}$$\n\n**2. 假发现率 (FDR)**\n\nFDR 是在判别规则被触发的情况下，该判定为假的后验概率。这即是 $P(\\neg M | C)$。使用贝叶斯定理：\n$$\\text{FDR} = P(\\neg M | C) = \\frac{P(C|\\neg M)P(\\neg M)}{P(C)}$$\n判定事件的总概率 $P(C)$ 由全概率公式给出：\n$$P(C) = P(C|M)P(M) + P(C|\\neg M)P(\\neg M)$$\n我们需要计算 $P(C|\\neg M)$。如果没有发生突变（$\\neg M$），后代就像双亲一样是 Ref/Ref。所有三个个体都是 Ref/Ref，他们的读数数量 $k_O, k_{P1}, k_{P2}$ 独立同分布于 $\\text{Binomial}(d, e)$。\n$$P(C|\\neg M) = P(k_O \\geq 1 | \\neg M) \\times P(k_{P1} = 0 | \\neg M) \\times P(k_{P2} = 0 | \\neg M)$$\n对于后代（现在是 Ref/Ref）：\n$$P(k_O \\geq 1 | \\neg M) = 1 - P(k_O = 0 | \\neg M) = 1 - \\binom{d}{0}e^0(1-e)^d = 1 - (1-e)^d$$\n对于双亲（Ref/Ref）：\n$$P(k_{P1} = 0 | \\neg M) = (1-e)^d$$\n$$P(k_{P2} = 0 | \\neg M) = (1-e)^d$$\n因此，一个错误判定的概率为：\n$$P(C|\\neg M) = (1 - (1-e)^d)(1-e)^{2d}$$\n现在我们将所有部分代入 FDR 公式：\n$$\\text{FDR} = \\frac{P(C|\\neg M)P(\\neg M)}{P(C|M)P(M) + P(C|\\neg M)P(\\neg M)}$$\n$$\\text{FDR} = \\frac{\\left[(1 - (1-e)^d)(1-e)^{2d}\\right](1-\\mu)}{\\left[(1 - 2^{-d})(1-e)^{2d}\\right]\\mu + \\left[(1 - (1-e)^d)(1-e)^{2d}\\right](1-\\mu)}$$\n假设 $e  1$，项 $(1-e)^{2d}$ 非零，可以从分子和分母中约去：\n$$\\text{FDR} = \\frac{(1 - (1-e)^d)(1-\\mu)}{(1 - 2^{-d})\\mu + (1 - (1-e)^d)(1-\\mu)}$$\n这就是假发现率作为 $d$、$e$ 和 $\\mu$ 函数的最终闭合形式表达式。", "answer": "$$ \\boxed{ \\frac{(1 - (1-e)^d)(1-\\mu)}{(1 - 2^{-d})\\mu + (1 - (1-e)^d)(1-\\mu)} } $$", "id": "2751574"}]}