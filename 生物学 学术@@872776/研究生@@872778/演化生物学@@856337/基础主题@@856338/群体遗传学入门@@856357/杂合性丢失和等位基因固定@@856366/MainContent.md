## 引言
在群体遗传学中，理解物种内部遗传变异的[分布](@entry_id:182848)、维持和演化是其核心议题。[杂合度](@entry_id:166208)的丧失与等位基因的固定是这一宏大叙事中两个基本且不可避免的终点。它们描述了一个群体如何因随机机遇和确定性力量的作用，随时间推移逐渐失去[遗传多样性](@entry_id:201444)，最终在某个[基因座](@entry_id:177958)上“锁定”为单一的遗传形式。这一过程不仅是演化理论的基石，也对现实世界的生物学问题——从濒危物种的存续到人类疾病的发生——具有深远的启示。然而，遗传漂变、突变、选择和种群结构等多种力量如何精确地相互作用，共同驱动这一过程？这正是本篇文章旨在解决的核心知识缺口。

为了系统地解答这个问题，本文将分为三个部分。首先，在“**原理与机制**”一章中，我们将深入探讨[杂合度](@entry_id:166208)的度量方式，并建立描述遗传漂变、[突变-漂变平衡](@entry_id:204457)以及[平衡选择](@entry_id:150481)等核心机制的数学模型。接着，在“**应用与跨学科连接**”一章中，我们将展示这些理论原理如何被应用于解决保护遗传学、[物种形成](@entry_id:147004)、[癌症生物学](@entry_id:148449)和基因组数据解释等领域的实际问题。最后，在“**动手实践**”部分，我们提供了一系列精心设计的计算练习，旨在帮助读者将抽象的理论转化为可操作的分析技能。通过这一结构化的学习路径，读者将能够全面掌握[杂合度](@entry_id:166208)丧失与[等位基因固定](@entry_id:178848)的理论精髓及其在现代生物学研究中的强大应用价值。

## 原理与机制

在群体遗传学中，理解等位基因频率的动态变化是核心任务之一。等位基因频率的随机波动最终可能导致群体中某个等位基因的频率达到1（**固定**）或0（**丢失**），这一过程伴随着[遗传多样性](@entry_id:201444)的丧失。本章将深入探讨[杂合度](@entry_id:166208)丧失和[等位基因固定](@entry_id:178848)的基本原理与核心机制，重点阐述[遗传漂变](@entry_id:145594)、突变、选择以及种群结构在这一过程中的作用。

### 遗传变异的度量：[杂合度](@entry_id:166208)

衡量一个群体在特定[基因座](@entry_id:177958)上的遗传变异水平，最常用的指标之一是**[杂合度](@entry_id:166208)（heterozygosity）**。在理论层面，我们通常关注**[期望杂合度](@entry_id:204049)（expected heterozygosity）**，也称为**基因多样性（gene diversity）**，记为 $H$。对于一个拥有 $k$ 个等位基因、频率分别为 $p_i$（其中 $\sum_{i=1}^k p_i = 1$）的[基因座](@entry_id:177958)，基因多样性定义为从群体中随机抽取两个基因拷贝，它们属于不同等位基因的概率。其计算公式为：

$H = 1 - \sum_{i=1}^{k} p_i^2$

这个公式的逻辑是，随机抽取两个基因拷贝属于相同等位基因的概率是 $\sum p_i^2$，因此它们不相同的概率就是 $1$ 减去这个值。对于一个简单的双等位基因系统，频率分别为 $p$ 和 $1-p$，该公式简化为 $H = 1 - [p^2 + (1-p)^2] = 2p(1-p)$。

另一个衡量[遗传多样性](@entry_id:201444)的指标是**[核苷酸多样性](@entry_id:164565)（nucleotide diversity）**，记为 $\pi$。它被定义为从群体中随机抽取的两个序列（或[染色体](@entry_id:276543)）在每个[核苷酸](@entry_id:275639)位点上的平[均差](@entry_id:138238)异数。对于一个单一的变异位点（如[单核苷酸多态性](@entry_id:173601)，SNP），如果我们将两个不同的等位基因之间的差异记为1，相同的记为0，那么该位点的[核苷酸多样性](@entry_id:164565) $\pi$ 就等于随机抽取的两个基因拷贝在该位点不相同的概率。因此，对于单个位点而言，[核苷酸多样性](@entry_id:164565)的定义在群体水平上与基因多样性完[全等](@entry_id:273198)价，即 $\pi = H$ [@problem_id:2729396]。

需要强调的是，理论上的[期望杂合度](@entry_id:204049) $H$ 是基于群体真实的等位基因频率计算的，它的值与群体是否处于**哈迪-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）**无关。HWE描述的是[等位基因频率](@entry_id:146872)与[基因型频率](@entry_id:141286)之间的关系，而 $H$ 和 $\pi$ 是直接由基因库中的等位基因频率决定的 [@problem_id:2729396]。

在实际研究中，我们通常处理的是有限大小的样本。基于样本计算出的多样性估计值会受到[抽样误差](@entry_id:182646)的影响。例如，对于一个大小为 $n$ 的单倍体样本，$\pi$ 的[无偏估计量](@entry_id:756290) $\hat{\pi}$（即样本中所有配对的平[均差](@entry_id:138238)异数）与基因多样性的“[置换](@entry_id:136432)型”（plug-in）估计量 $\hat{H} = 1 - \sum \hat{p}_i^2$（其中 $\hat{p}_i$ 是样本[等位基因频率](@entry_id:146872)）之间存在一个精确的关系：$\hat{\pi} = \frac{n}{n-1}\hat{H}$。对于较大的样本（$n \gg 1$），$\frac{n}{n-1}$ 因子趋近于1，使得两者在数值上非常接近 [@problem_id:2729396]。理解群体参数与其样本估计值之间的关系，对于解释基因组数据至关重要。

### 多样性丧失的引擎：遗传漂变

在任何有限大小的群体中，即使没有自然选择，等位基因频率也会因世代传递过程中的随机抽样误差而发生波动，这一过程被称为**遗传漂变（genetic drift）**。[遗传漂变](@entry_id:145594)是导致[杂合度](@entry_id:166208)丧失和[等位基因固定](@entry_id:178848)的主要驱动力。

#### [Wright-Fisher模型](@entry_id:148998)与[等位基因固定](@entry_id:178848)

为了精确描述遗传漂变，群体遗传学家构建了理想化的**[Wright-Fisher模型](@entry_id:148998)**。该模型假设一个大小恒为 $N$ 的[二倍体](@entry_id:268054)群体，世代不重叠，进行[随机交配](@entry_id:149892)。每一代产生的 $2N$ 个基因拷贝，都是从上一代的[基因库](@entry_id:267957)中进行有放回的随机抽取的。

在这个模型下，当一个等位基因的频率变为0或1时，它就进入了**吸收态（absorbing state）**。例如，考虑一个双等位[基因座](@entry_id:177958)，等位基因 $A$ 的频率为 $p$。如果 $p_t=0$，意味着群体中已没有 $A$ 基因，下一代的基因库完全由 $a$ 基因构成，因此 $p_{t+1}$ 必然为0（在没有新突变或迁入的情况下）。同样，如果 $p_t=1$，群体中只有 $A$ 基因，则 $p_{t+1}$ 必然为1。因此，状态 $p=0$ 和 $p=1$ 是等位基因频率演化这个[马尔可夫链](@entry_id:150828)的[吸收边界](@entry_id:201489) [@problem_id:2729409]。

当等位基因频率达到0或1时，群体在该[基因座](@entry_id:177958)上就丧失了所有遗传变异，即 $H = 2p(1-p) = 0$。这个状态被称为**[等位基因固定](@entry_id:178848)（allele fixation）**。需要区分**[等位基因固定](@entry_id:178848)**和**基因型固定（genotype fixation）**。在[随机交配](@entry_id:149892)的群体中，等位基因 $A$ 的固定（$p=1$）必然导致 $AA$ 基因型的固定（频率为 $p^2=1$），反之亦然。然而，一个群体不可能“固定”在[杂合子](@entry_id:276964) $Aa$ 状态。即使一个群体在某一代碰巧全部由 $Aa$ 个体组成（此时 $p=0.5$），下一代在随机交配后，其后代[基因型频率](@entry_id:141286)会立刻变为哈迪-温伯格比例：$0.25$ $AA$, $0.5$ $Aa$, $0.25$ $aa$。因此，完全杂合的状态不是一个[吸收态](@entry_id:161036) [@problem_id:2729409]。

#### [杂合度](@entry_id:166208)丧失的速率

遗传漂变的强度与群体大小成反比。在[Wright-Fisher模型](@entry_id:148998)中，下一代等位基因频率 $p_{t+1}$ 的[条件方差](@entry_id:183803)，即等位基因频率单代变化的[方差](@entry_id:200758)，可以被精确推导。由于新一代的 $2N$ 个基因拷贝是从上一代频率为 $p_t$ 的[基因库](@entry_id:267957)中进行二项抽样得到的，[等位基因频率](@entry_id:146872)变化的[方差](@entry_id:200758)为：

$\operatorname{Var}(\Delta p \mid p_t) = \operatorname{Var}(p_{t+1} \mid p_t) = \frac{p_t(1-p_t)}{2N}$ [@problem_id:2729334]

这个结果表明，群体越小（$N$ 越小），[等位基因频率](@entry_id:146872)的随机波动就越大。

这种随机波动直接导致了[期望杂合度](@entry_id:204049)的衰减。通过考察 $H_{t+1} = 2p_{t+1}(1-p_{t+1})$ 的期望，我们可以推导出[期望杂合度](@entry_id:204049)的代际递推关系。利用 $E[p_{t+1} \mid p_t] = p_t$ 和 $E[p_{t+1}^2 \mid p_t] = \operatorname{Var}(p_{t+1} \mid p_t) + (E[p_{t+1} \mid p_t])^2$，我们得到：

$E[H_{t+1} \mid p_t] = H_t \left(1 - \frac{1}{2N}\right)$ [@problem_id:2729361] [@problem_id:2729334]

对整个群体取期望，我们得到一个关于[期望杂合度](@entry_id:204049)的[线性递推关系](@entry_id:273376)：

$E[H_{t+1}] = E[H_t] \left(1 - \frac{1}{2N}\right)$

解这个[递推关系](@entry_id:189264)，我们得到从初始[杂合度](@entry_id:166208) $H_0$ 开始，经过 $t$ 代后[期望[杂合](@entry_id:204049)度](@entry_id:166208)的表达式：

$E[H_t] = H_0 \left(1 - \frac{1}{2N}\right)^t$ [@problem_id:2729334]

这个重要的结果表明，在任何没有新突变补充的[有限群](@entry_id:139710)体中，[期望杂合度](@entry_id:204049)都以每代 $1/(2N)$ 的速率几何衰减，最终不可避免地趋向于0。这也意味着，在纯粹[遗传漂变](@entry_id:145594)的作用下，所有[多态性](@entry_id:159475)最终都会丧失，群体将固定在某个等位基因上。由于 $\pi = H$ 在群体水平上成立，所以期望[核苷酸多样性](@entry_id:164565)也以完全相同的速率衰减 [@problem_id:2729396]。

#### 有效群体大小 ($N_e$)

真实种群的繁殖方式远比[Wright-Fisher模型](@entry_id:148998)复杂。为了将理论应用于现实，群体遗传学引入了**有效群体大小（effective population size, $N_e$）**的概念。$N_e$ 是一个理想化的Wright-Fisher群体的规模，该群体与我们关注的真实群体在某个特定的遗传特性上表现出相同的[演化速率](@entry_id:202008)。根据所关注的遗传特性不同，可以定义不同的有效群体大小：

- **近交有效群体大小 ($N_e^I$)**: 理想群体的大小，其[近交系数](@entry_id:190186)的增长率与真实群体相同。
- **[方差](@entry_id:200758)有效群体大小 ($N_e^V$)**: 理想群体的大小，其[等位基因频率](@entry_id:146872)的[方差](@entry_id:200758)与真实群体相同。
- **溯祖有效群体大小 ($N_e^C$)**: 理想群体的大小，其任意两个[基因谱系](@entry_id:172451)在上一代发生合并的概率与真实群体相同。

在一个严格遵循[Wright-Fisher模型](@entry_id:148998)假设的群体中，即群体大小恒定为 $N$，[随机交配](@entry_id:149892)，且每个亲本贡献的配子数服从[泊松分布](@entry_id:147769)，这三种定义的有效群体大小是完[全等](@entry_id:273198)价的，并且都等于群体的普查大小 $N$ [@problem_id:2729374]。然而，在真实群体中，由于性别比例不均、繁殖成功率差异巨大、群体大[小波](@entry_id:636492)动等因素，这几个 $N_e$ 的值可能不同，并且通常远小于普查大小 $N$。在后续讨论中，我们使用 $N_e$ 来泛指适用于特定演化过程的有效群体大小。

### 维持[杂合度](@entry_id:166208)的机制

尽管遗传漂变持续不断地消耗遗传多样性，但群体中的[多态性](@entry_id:159475)依然普遍存在。这得益于一些与之抗衡的演化力量，主要是突变和某些形式的自然选择。

#### [突变-漂变平衡](@entry_id:204457)

**突变（mutation）**是新等位基因的最终来源，它不断地向群体中引入新的遗传变异，从而对抗漂变的固定效应。在一个群体中，[杂合度](@entry_id:166208)最终的平衡水平取决于突变引入变异的速率和漂变消除变异的速率。

考虑一个中性（不受选择）[基因座](@entry_id:177958)，突变遵循**无限等位基因模型（infinite-alleles model）**，即每次突变都产生一个全新的、前所未有的等位基因，[突变率](@entry_id:136737)为 $\mu$。我们可以通过建立一个关于两个随机抽取的基因拷贝是否相同的概率（即纯合度 $P_t$）的递推关系来求解平衡[杂合度](@entry_id:166208)。在第 $t+1$ 代随机抽取两个基因拷贝，它们在第 $t$ 代的祖先有两种可能：
1. 它们源自同一个祖先基因拷贝，概率为 $1/(2N_e)$。
2. 它们源自两个不同的祖先基因拷贝，概率为 $1 - 1/(2N_e)$。

为了使这两个基因拷贝在 $t+1$ 代相同，它们不仅祖先要相同（在情况2中），而且从 $t$ 代到 $t+1$ 代的两条谱系都不能发生突变，后者的概率为 $(1-\mu)^2$。由此可得纯合度 $P_t$ 的平衡状态 $P^*$ 满足：

$P^* = \left[ \frac{1}{2N_e} + \left(1 - \frac{1}{2N_e}\right)P^* \right] (1-\mu)^2$

在生物学上合理的假设下，即[突变率](@entry_id:136737) $\mu$ 很小（$\mu \ll 1$），我们可以忽略 $\mu^2$ 项，近似 $(1-\mu)^2 \approx 1-2\mu$。解出 $P^*$ 可得：

$P^* \approx \frac{1}{1 + 4N_e\mu}$

平衡状态下的[期望杂合度](@entry_id:204049) $H^* = 1 - P^*$，因此：

$H^* \approx \frac{4N_e\mu}{1 + 4N_e\mu}$ [@problem_id:2729394]

这个经典的结果被称为**[突变-漂变平衡](@entry_id:204457)（mutation-drift balance）**。它表明，平衡[杂合度](@entry_id:166208)由复合参数 $4N_e\mu$ 决定，这个参数也常被称为居群突变参数 $\theta$。当 $N_e$ 或 $\mu$ 很大时，[杂合度](@entry_id:166208)水平高；反之则低。

有趣的是，在一个理论上的无限大群体中（即没有漂变），可逆突变（$A \to a$ 速率为 $\mu > 0$，$a \to A$ 速率为 $\nu > 0$）自身就能阻止[等位基因固定](@entry_id:178848)。系统会达到一个由突变率决定的[稳定多态平衡](@entry_id:168980)点 $\hat{p} = \nu/(\mu+\nu)$。在这种情况下，真实的群体固定永远不会发生。然而，如果突变是单向的（例如 $\nu=0$），那么即使在无限大群体中，群体最终也会固定在被突变产生的那个等位基因上 [@problem_id:2729382]。

#### [平衡选择](@entry_id:150481)

自然选择也能维持[杂合度](@entry_id:166208)，特别是**[平衡选择](@entry_id:150481)（balancing selection）**。最典型的例子是**[超显性](@entry_id:268017)（overdominance）**，即[杂合子](@entry_id:276964)具有比两种纯合子都高的适合度。

考虑一个双等位[基因座](@entry_id:177958)，基因型 $AA$、$Aa$ 和 $aa$ 的相对生存力分别为 $w_{AA}=1-s$、$w_{Aa}=1$ 和 $w_{aa}=1-t$（其中 $s, t > 0$）。在一个非常大的群体中（忽略漂变），等位基因 $A$ 的频率 $p$ 将会趋向于一个稳定的内部[平衡点](@entry_id:272705) $p^*$。这个[平衡点](@entry_id:272705)可以通过令两个等位基因的边际适合度相等来求得，结果为：

$p^* = \frac{t}{s+t}$ [@problem_id:2729393]

由于 $s, t > 0$，这个[平衡频率](@entry_id:275072)必然在 $(0, 1)$ 区间内，保证了两种等位基因都会被保留在群体中。在该[平衡点](@entry_id:272705)，群体维持的[期望杂合度](@entry_id:204049)为：

$H^* = 2p^*(1-p^*) = \frac{2st}{(s+t)^2}$ [@problem_id:2729393]

这个结果表明，只要存在[杂合子优势](@entry_id:143056)，选择本身就能主动维持多态性。然而，必须清醒地认识到，即使存在强大的[平衡选择](@entry_id:150481)，它也无法创造新的等位基因。如果一个群体由于漂变偶然丢失了某个等位基因（例如 $p$ 变为0或1），选择将无能为力。因为选择作用于现存的变异，一旦变异消失，选择也就失去了作用对象。因此，在[有限群](@entry_id:139710)体中，$p=0$ 和 $p=1$ 依然是[吸收态](@entry_id:161036)，即使在超显[性选择模型](@entry_id:261537)下也是如此 [@problem_id:2729409]。

### 其他视角与复杂因素

#### [溯祖理论](@entry_id:155051)视角

[溯祖理论](@entry_id:155051)（Coalescent Theory）为理解[杂合度](@entry_id:166208)提供了一个强大的回溯性视角。它不向前追踪等位基因频率的变化，而是向后追溯样本中[基因谱系](@entry_id:172451)的合并历史。两个随机抽取的基因拷贝之所以不同，是因为在它们回溯到其**[最近共同祖先](@entry_id:136722)（Most Recent Common Ancestor, MRCA）**的谱系上至少发生了一次突变。

假设在恒定的有效群体大小 $N_e$ 下，任意两个谱系的合并时间 $T_2$ 服从期望为 $2N_e$ 个世代的[指数分布](@entry_id:273894)。在总长度为 $2T_2$ 的谱系分支上，如果突变按速率为 $\mu$ 的泊松过程发生，那么没有突变发生的概率是 $\exp(-2\mu T_2)$。因此，[期望杂合度](@entry_id:204049)（即至少发生一次突变的概率）可以通过对所有可能的 $T_2$ 值求平均得到：

$E[H] = 1 - E[\exp(-2\mu T_2)]$

通过对指数分布的矩母函数求值，可以精确地计算出这个期望：

$E[H] = 1 - \frac{1}{1+4N_e\mu} = \frac{4N_e\mu}{1+4N_e\mu}$ [@problem_id:2729386]

这个结果与之前使用前向时间模型（Wright-Fisher）推导出的[突变-漂变平衡](@entry_id:204457)[杂合度](@entry_id:166208)完全一致，展示了[群体遗传学](@entry_id:146344)理论内部的深刻一致性。

#### 种群结构与[Wahlund效应](@entry_id:151966)

前面的讨论大多基于[随机交配](@entry_id:149892)的单一群体。然而，许多物种都存在地理上的**种群结构（population structure）**，被划分为多个亚群（deme）。这种结构对[杂合度](@entry_id:166208)有显著影响。

考虑一个被划分为两个大小相等的亚群的物种，亚群内部随机交配，但亚群之间没有基因交流。设等位基因 $A$ 在两个亚群中的频率分别为 $p_1$ 和 $p_2$。在每个亚群内部，[基因型频率](@entry_id:141286)遵循HWE。亚群1的杂合子频率为 $2p_1(1-p_1)$，亚群2为 $2p_2(1-p_2)$。如果我们将两个亚群的个体混合在一起进行分析，合并后的群体中[杂合子](@entry_id:276964)的频率是两者频率的平均值：$f(Aa)_{\text{pooled}} = p_1(1-p_1) + p_2(1-p_2)$。

然而，如果我们先计算合并后的平均[等位基因频率](@entry_id:146872) $\bar{p} = (p_1+p_2)/2$，然后基于此计算[期望杂合度](@entry_id:204049)，会得到 $2\bar{p}(1-\bar{p})$。可以证明，只要 $p_1 \neq p_2$，合并群体中观察到的杂合子频率总是低于基于平均频率计算出的[期望值](@entry_id:153208)。这个[杂合子缺失](@entry_id:200653)的现象被称为**[Wahlund效应](@entry_id:151966)**。缺失量 $D$ 可以精确计算为：

$D = 2\bar{p}(1-\bar{p}) - f(Aa)_{\text{pooled}} = \frac{(p_1 - p_2)^2}{2}$ [@problem_id:2729408]

这个效应表明，由于等位基因频率在亚群间的差异，种群的整体结构会导致杂合子比例的降低。在每个孤立的亚群内部，[遗传漂变](@entry_id:145594)会分别导致[杂合度](@entry_id:166208)的丧失，而[Wahlund效应](@entry_id:151966)则是这种分化在宏观层面上的直接体现。

#### 群体状态与样本观察

最后，必须区分群体的真实[状态和](@entry_id:193625)从该群体中获得的有限样本所展示的观察结果。例如，在一个由可逆突变维持多态性的巨大群体中，两个等位基因都以非零频率稳定存在。然而，如果我们只抽取一个很小的样本（比如 $n=50$ 个个体，即100个基因拷贝），我们完全有可能在样本中只观察到其中一个等位基因，造成**“表观固定”（apparent fixation）**的假象。

这种情况发生的概率可以通过二项抽样计算。如果一个次要等位基因的频率很低（例如 $q \approx 10^{-3}$），那么在一个中等大小的样本中没有抽到它的概率（即主要等位基因的频率 $p=1-q$ 的 $2n$ 次方）可能会非常高。例如，当 $p \approx 0.999$ 且 $2n=100$ 时，样本中全是主要等位基因的概率约为 $(1-10^{-3})^{100} \approx \exp(-0.1) \approx 0.905$ [@problem_id:2729382]。

这提醒我们，从样本中观察到的固定现象，并不一定代表整个群体已经丧失了变异。样本中[杂合度](@entry_id:166208)的完全丧失（LOH）可能只是抽样效应的结果。随着样本量的增加，样本能更准确地反映群体的真实多样性，观察到“表观固定”的概率会严格下降 [@problem_id:2729382]。因此，在解释群体遗传数据时，审慎考虑抽样过程的影响是至关重要的。