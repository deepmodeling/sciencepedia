## 引言
自然选择是驱动[适应性进化](@entry_id:176122)的核心力量，它通过塑造物种的遗传构成来响应环境挑战。然而，从达尔文“适者生存”的直观概念到量化预测进化轨迹，需要一个严谨的数学框架。群体遗传学正是提供了这样一套工具，其核心在于理解[等位基因频率](@entry_id:146872)在各种演化力量作用下的动态变化。本文旨在深入探讨其中最基本、最强大的力量——自然选择——是如何以一种确定性的方式改变[等位基因频率](@entry_id:146872)的。我们将揭示隐藏在[进化过程](@entry_id:175749)背后的数学原理，并展示这些原理如何解释从分子到生态系统的广泛生物学现象。

本文将通过三个章节，系统地构建您对确定[性选择](@entry_id:138426)理论的理解。在**“原理和机制”**一章中，我们将从第一性原理出发，推导描述[等位基因频率](@entry_id:146872)变化的核心递归方程，并介绍边际适应度、平均适应度和[费雪基本定理](@entry_id:193199)等关键概念。随后，在**“应用与跨学科联系”**一章，我们将把这些理论模型应用于真实世界的问题，探讨新突变的命运、[局域适应](@entry_id:172044)的形成、遗传疾病的持续存在以及物种间的[协同进化](@entry_id:183476)。最后，**“动手实践”**部分将通过一系列计算问题，帮助您巩固所学知识，并将其转化为解决实际问题的能力。

让我们首先进入理论的核心，从构建最基础的选择模型开始，探索其内在的原理与机制。

## 原理和机制

本章旨在深入阐述在选择作用下等位基因频率确定性变化的数学原理和核心机制。我们将从最基础的单[基因座](@entry_id:177958)、双等位基因模型出发，系统地推导其动态方程，并逐步将该框架扩展至更复杂的情形，包括多等位基因系统、不同的[选择模式](@entry_id:144214)以及[频率依赖性选择](@entry_id:155870)。我们的目标是建立一个严谨的理论框架，用以理解自然选择如何塑造群体的遗传构成。

### 基本模型：[二倍体](@entry_id:268054)中的生存力选择

为了建立一个可分析的确定[性选择模型](@entry_id:261537)，我们首先考虑一个理想化的群体遗传学生命周期。假设一个非常大的[二倍体](@entry_id:268054)群体，世代不重叠，进行随机交配（泛交）。我们关注一个常[染色体](@entry_id:276543)上的单个[基因座](@entry_id:177958)，该[基因座](@entry_id:177958)有两个等位基因，$A$ 和 $a$。在一个世代开始时，合子中的等位基因频率分别为 $p$ 和 $q = 1-p$。

#### [哈代-温伯格平衡](@entry_id:140509)作为基线

在任何一代中，生命周期始于合子的形成。[随机交配](@entry_id:149892)假设等同于亲代产生的雌雄配子随机结合形成合子。如果亲代群体中的[等位基因频率](@entry_id:146872)为 $p$ 和 $q$，那么在没有其他演化力量（如突变、迁移或[遗传漂变](@entry_id:145594)）干扰的情况下，新形成的[合子](@entry_id:146894)群体中的[基因型频率](@entry_id:141286)将遵循**[哈代-温伯格平衡](@entry_id:140509)（Hardy-Weinberg Equilibrium, HWE）**。这意味着三种基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p^2$、$2pq$ 和 $q^2$。

至关重要的是要理解，即使在选择作用下，[哈代-温伯格原理](@entry_id:187455)仍然在每一代的生命周期中扮演着核心角色。选择作用于合子形成之后、个体达到性成熟之前的阶段（即生存阶段）。它通过改变不同基因型的存活概率来改变群体的[基因型频率](@entry_id:141286)构成。然而，存活下来的成年个体再次进行[随机交配](@entry_id:149892)时，它们产生的配子将再次随机结合，从而在下一代的合子中重新建立哈代-温伯格比例。唯一的区别在于，由于选择的作用，用于计算新一代[合子](@entry_id:146894)[基因型频率](@entry_id:141286)的等位基因频率 $p'$ 可能已经发生了改变。因此，哈代-温伯格频率 $p^2, 2pq, q^2$ 为每一代选择作用的“输入”或基线状态提供了理论基础 [@problem_id:2700664]。

#### [等位基因频率](@entry_id:146872)变化的递归方程

现在，我们从第一性原理出发，推导等位基因频率在一个世代内的变化。

1.  **初始[合子](@entry_id:146894)频率**：根据HWE，基因型 $AA$、$Aa$ 和 $aa$ 的频率分别为 $p^2$、$2pq$ 和 $q^2$。

2.  **生存力选择**：我们用**[绝对适应度](@entry_id:168875)**（absolute fitness）来量化选择。基因型 $AA$、$Aa$ 和 $aa$ 的绝对生存力（或称生存[适应度](@entry_id:154711)）分别表示为 $w_{AA}$、$w_{Aa}$ 和 $w_{aa}$。这些值代表一个个体从合子存活到成年并参与繁殖的期望后代数。经过选择后，各种基因型的相对数量与其初始频率和其生存力的乘积成正比。因此，存活下来的个体中，三种基因型的比例分别为 $p^2 w_{AA}$、$2pq w_{Aa}$ 和 $q^2 w_{aa}$。

3.  **[标准化](@entry_id:637219)**：为了得到存活成年群体中真实的[基因型频率](@entry_id:141286)，我们需要将上述比例进行[标准化](@entry_id:637219)，即用它们各自除以它们的总和。这个总和被称为群体的**平均适应度（mean fitness）**，用 $\bar{w}$ 表示：
    $$ \bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$
    因此，成年群体中的[基因型频率](@entry_id:141286)为：
    -   $AA$ 的频率: $f'_{AA} = \frac{p^2 w_{AA}}{\bar{w}}$
    -   $Aa$ 的频率: $f'_{Aa} = \frac{2pq w_{Aa}}{\bar{w}}$
    -   $aa$ 的频率: $f'_{aa} = \frac{q^2 w_{aa}}{\bar{w}}$

4.  **下一代的[等位基因频率](@entry_id:146872)**：这些成年个体随机交配产生下一代。下一代合子中的等位基因频率 $p'$ 将等于当前成年群体中的等位基因频率。我们可以通过计算成年群体中 $A$ 等位基因的频率来得到 $p'$：
    $$ p' = f'_{AA} + \frac{1}{2}f'_{Aa} = \frac{p^2 w_{AA}}{\bar{w}} + \frac{1}{2} \left( \frac{2pq w_{Aa}}{\bar{w}} \right) $$
    合并同类项，我们得到描述等位基因频率从一代到下一代变化的核心递归方程 [@problem_id:2700660]：
    $$ p' = \frac{p^2 w_{AA} + pq w_{Aa}}{\bar{w}} = \frac{p(p w_{AA} + q w_{Aa})}{p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa}} $$
这个方程是研究确定性选择的基石。

#### [绝对适应度](@entry_id:168875)与[相对适应度](@entry_id:153028)

在上述推导中，我们注意到 $p'$ 的表达式是一个有理函数，其中分子和分母都是[适应度](@entry_id:154711) $w_{ij}$ 的[线性组合](@entry_id:154743)。如果我们把所有基因型的[绝对适应度](@entry_id:168875)都乘以一个正常数 $c > 0$（即 $w'_{ij} = c \cdot w_{ij}$），那么新的平均适应度 $\bar{w}'$ 将变为 $c\bar{w}$。新的下一代[等位基因频率](@entry_id:146872) $p''$ 则为：
$$ p'' = \frac{p^2 (c w_{AA}) + pq (c w_{Aa})}{c \bar{w}} = \frac{c(p^2 w_{AA} + pq w_{Aa})}{c \bar{w}} = p' $$
结果表明，下一代的等位基因频率保持不变。这意味着，对于等位基因频率的动态演化而言，重要的是**[相对适应度](@entry_id:153028)（relative fitness）**，即不同基因型[适应度](@entry_id:154711)的比率，而不是它们的[绝对值](@entry_id:147688)。因此，我们通常可以通过将所有[适应度](@entry_id:154711)值除以其中一个（例如，将最适应的基因型或一个参考基因型的[适应度](@entry_id:154711)定为1）来进行简化，而不会影响[等位基因频率](@entry_id:146872)变化的轨迹 [@problem_id:2700719]。

### 选择方程的推广：边际[适应度](@entry_id:154711)与[复制子动态](@entry_id:142626)

上述双等位基因模型可以自然地推广到具有任意数量等位基因（$A_1, A_2, \dots, A_n$）的单个[基因座](@entry_id:177958)。设等位基因 $A_i$ 的频率为 $p_i$，基因型 $A_i A_j$ 的[适应度](@entry_id:154711)为 $w_{ij}$。

通过与双等位基因模型完全相同的逻辑，我们可以推导出下一代等位基因 $A_i$ 的频率 $p'_i$ 的表达式：
$$ p'_i = \frac{p_i \sum_{j=1}^{n} p_j w_{ij}}{\sum_{k=1}^{n} \sum_{l=1}^{n} p_k p_l w_{kl}} $$
这个表达式看起来很复杂，但可以通过引入两个关键概念来大大简化。首先，分母正是群体的平均[适应度](@entry_id:154711) $\bar{w} = \sum_{k,l} p_k p_l w_{kl}$。其次，我们定义一个新量，**等位基因的边际[适应度](@entry_id:154711)（marginal fitness of an allele）** $w_i$：
$$ w_i = \sum_{j=1}^{n} p_j w_{ij} $$
$w_i$ 的直观含义是，一个 $A_i$ 等位基因在群体中的平均[适应度](@entry_id:154711)。它是在考虑了该等位基因可能与其在群体中遇到的所有其他等位基因（频率为 $p_j$）组合成基因型（[适应度](@entry_id:154711)为 $w_{ij}$）之后得到的加权平均值。

利用这两个定义，[等位基因频率](@entry_id:146872)的递归方程可以写成一个非常简洁的形式：
$$ p'_i = p_i \frac{w_i}{\bar{w}} $$
这个方程揭示了一个深刻的原理：一个等位基因在下一代中的频率，等于它当前频率乘以其边际适应度与群体平均[适应度](@entry_id:154711)的比值。

为了更清晰地看到选择的方向和速率，我们考察频率的变化量 $\Delta p_i = p'_i - p_i$：
$$ \Delta p_i = p_i \frac{w_i}{\bar{w}} - p_i = p_i \left( \frac{w_i - \bar{w}}{\bar{w}} \right) $$
这个形式的方程被称为**[复制子方程](@entry_id:198195)（replicator equation）** [@problem_id:2700659]。它表明，一个等位基因的频率是否增加，完全取决于其边际适应度 $w_i$ 是否高于群体的平均适应度 $\bar{w}$。如果 $w_i > \bar{w}$，则 $\Delta p_i > 0$，该等位基因频率增加；如果 $w_i  \bar{w}$，则 $\Delta p_i  0$，其频率下降；如果 $w_i = \bar{w}$，则频率不变，[达到平衡](@entry_id:170346)。这一原理为我们理解选择的动态提供了强大的直观工具。

### 选择的后果：平均适应度与[费雪基本定理](@entry_id:193199)

既然选择倾向于增加高[适应度](@entry_id:154711)等位基因的频率，一个自然的问题是：选择是否总能提高整个群体的平均适应度？对于适应度恒定的模型，答案的核心在于**[费雪自然选择基本定理](@entry_id:187374)（Fisher's Fundamental Theorem of Natural Selection）**。

该定理的现代、精确表述为：在适应度恒定的确定[性选择模型](@entry_id:261537)中，群体平均[适应度](@entry_id:154711)的增加率（在一个世代内）等于适合度的**[加性遗传方差](@entry_id:154158)（additive genetic variance）**除以平均适应度。

要理解这个定理，我们必须首先定义[加性遗传方差](@entry_id:154158) ($V_A$)。在一个双等位基因模型中，我们可以将基因型 $G$ 的[适应度](@entry_id:154711) $w_G$ 分解为一个关于其携带的 $A$ 等位基因数量（$x_G$，对于 $AA, Aa, aa$ 分别为 2, 1, 0）的线性回归模型 [@problem_id:2700675]：
$$ w_G = \mu + \alpha x_G + d_G $$
在这里，$\alpha$ 是适应度在等位基因数量上的[回归系数](@entry_id:634860)，代表了**等位基因的平均效应（average effect of allele substitution）**。$d_G$ 是残差，代表了由显性效应引起的对[线性模型](@entry_id:178302)的偏离。[加性遗传方差](@entry_id:154158) $V_A$ 被定义为该线性（加性）部分在群体中的[方差](@entry_id:200758)：
$$ V_A = \text{Var}(\alpha x_G) = \alpha^2 \text{Var}(x_G) = 2pq\alpha^2 $$
[费雪基本定理](@entry_id:193199)可以表述为：
$$ \Delta \bar{w} \approx \frac{d\bar{w}}{dt} = \frac{V_A}{\bar{w}} $$
(在离散世代模型中，这通常表示 $\Delta \bar{w}$ 的主要部分)。该定理的深刻含义在于，自然选择的作用速率正比于可供选择作用的、可遗传的[适应度](@entry_id:154711)变异量。当[加性遗传方差](@entry_id:154158) $V_A$ 耗尽时（例如，当一个等位基因被固定，或者群体达到一个特定的[多态性](@entry_id:159475)平衡时），平均[适应度](@entry_id:154711)的进化将停止。这个定理因此将群体遗传学的数学模型与达尔文关于选择作用于遗传变异的直觉联系了起来。

### [平衡与稳定性](@entry_id:175068)分析：关键情景

当 $\Delta p = 0$ 时，群体等位基因频率达到一个**平衡（equilibrium）**。除了所有等位基因都被淘汰的边界平衡（$p=0$ 或 $p=1$）之外，还可能存在内部平衡（$p^* \in (0,1)$）。内部平衡的存在与稳定性取决于基因型之间的适应度关系。

#### [超显性](@entry_id:268017)（Overdominance）

当[杂合子](@entry_id:276964) $Aa$ 的[适应度](@entry_id:154711)高于两个纯[合子](@entry_id:146894)时（$w_{Aa} > w_{AA}$ 且 $w_{Aa} > w_{aa}$），这种情况被称为**[超显性](@entry_id:268017)**或**[杂合子优势](@entry_id:143056)**。在这种情况下，存在一个唯一的、稳定的内部[平衡点](@entry_id:272705)。我们可以通过设置 $\Delta p = 0$ 来求解该[平衡点](@entry_id:272705)的频率。从[复制子方程](@entry_id:198195)的逻辑可知，平衡发生在 $w_A = w_a$ 时（进而等于 $\bar{w}$）。对于双等位基因模型，这等价于 $p(w_{AA} - w_{Aa}) + q(w_{Aa} - w_{aa}) = 0$。

如果我们使用一个常见的参数化方案：$w_{AA} = 1-s$, $w_{Aa} = 1$, $w_{aa} = 1-t$ (其中 $s, t > 0$) [@problem_id:2700704]，[平衡频率](@entry_id:275072) $p^*$ 为：
$$ p^* = \frac{t}{s+t} $$
这个[平衡点](@entry_id:272705)是**全局稳定**的，意味着无论初始频率 $p_0 \in (0,1)$ 是多少，群体最终都会演化到这个[平衡频率](@entry_id:275072)。其背后的机制是**受保护的[多态性](@entry_id:159475)（protected polymorphism）**：当一个等位基因变得稀有时，它主要存在于[杂合子](@entry_id:276964)中。由于杂合子具有最高的[适应度](@entry_id:154711)，稀有等位基因的边际适应度将高于群体的平均适应度，从而使其频率增加。例如，当 $A$ 稀有（$p \to 0$）时，它的边际适应度 $w_A \approx w_{Aa}$，而群体的平均[适应度](@entry_id:154711) $\bar{w} \approx w_{aa}$。因为 $w_{Aa} > w_{aa}$，所以 $A$ 的频率会增加。同理，当 $a$ 稀有时也会增加。这种机制是维持群体内[遗传多样性](@entry_id:201444)的一个重要方式 [@problem_id:2700633]。

#### 亚显性（Underdominance）

当杂合子的[适应度](@entry_id:154711)低于两个纯合子时（$w_{Aa}  w_{AA}$ 且 $w_{Aa}  w_{aa}$），这种情况被称为**亚显性**或**[杂合子劣势](@entry_id:175739)**。在这种情况下，也存在一个唯一的内部[平衡点](@entry_id:272705)，但它是**不稳定**的。初始频率高于这个[平衡点](@entry_id:272705)的群体将演化至 $p=1$（$A$ [等位基因固定](@entry_id:178848)），而初始频率低于该[平衡点](@entry_id:272705)的群体将演化至 $p=0$（$a$ [等位基因固定](@entry_id:178848)）。边界[平衡点](@entry_id:272705) $p=0$ 和 $p=1$ 是两个稳定的吸引子。

在这种情况下，任何一个等位基因在稀有时都会被选择所淘汰，因为它们主要存在于适应度较低的杂合子中。因此，亚显[性选择](@entry_id:138426)下不存在受保护的多态性 [@problem_id:2700633]。这种动态可以成为[物种形成](@entry_id:147004)过程中的一个重要机制，因为它能在群体之间建立起强大的生殖隔离屏障。

### 超越恒定生存力选择

我们至今为止的讨论主要集中在最简单的模型上：恒定的、作用于生存阶段的[个体适应](@entry_id:190630)度。现在我们放宽这些假设，探讨更广泛的确定[性选择](@entry_id:138426)机制。

#### 生育力选择

选择不仅可以作用于生存阶段（**生存力选择**），还可以作用于繁殖阶段。**生育力选择（fertility selection）**指的是不同基因型组合的交配对在产生后代的数量上存在差异。例如，一个 $AA \times Aa$ 的交配对可能比一个 $AA \times AA$ 的交配对产生更多或更少的后代。

生育力选择的数学模型与生存力选择有本质不同。它不能简单地归结为个体基因型的适应度，而必须考虑交配对的频率和它们各自的生育力 $F_{ij}$。下一代等位基因的频率 $p'$ 需要通过对所有可能的交配类型（频率为 $f_i f_j$）、它们的相对生育力（$F_{ij}$）以及它们后代中 $A$ 等位基因的预期比例进行加权求和来计算 [@problem_id:2700705]。这种[选择模式](@entry_id:144214)的动态可能更为复杂，因为它直接作用于基因组合的层面上。

#### [频率依赖性选择](@entry_id:155870)

在许多现实情况下，一个基因型的[适应度](@entry_id:154711)并不是恒定的，而是依赖于其自身或其他基因型在群体中的频率。这就是**[频率依赖性选择](@entry_id:155870)（frequency-dependent selection）**。

一个经典的例子是**[负频率依赖性选择](@entry_id:176214)**，即稀有基因型具有更高的[适应度](@entry_id:154711)。例如，在一个单倍体模型中，考虑[适应度函数](@entry_id:171063) $w_A(p) = 1 + s(1 - 2p)$ 和 $w_a(p) = 1$ (假设 $s>0$) [@problem_id:2700696]。当 $A$ 等位基因稀有（$p$ 接近 0）时，$w_A(p) \approx 1+s > 1 = w_a(p)$，因此 $A$ 的频率会增加。当 $A$ 普遍（$p$ 接近 1）时，$w_A(p) \approx 1-s  1 = w_a(p)$，$A$ 的频率会下降。这导致系统存在一个稳定的内部[平衡点](@entry_id:272705)，当 $w_A(p^*) = w_a(p^*)$ 时达到，即 $1+s(1-2p^*) = 1$，解得 $p^* = 1/2$。[负频率依赖性选择](@entry_id:176214)是维持多态性的另一个强有力机制。

[频率依赖性选择](@entry_id:155870)的存在也从根本上改变了我们对平均适应度的看法。[费雪基本定理](@entry_id:193199)指出，在恒定[适应度](@entry_id:154711)下，平均适应度永远不会下降。然而，在[频率依赖性选择](@entry_id:155870)下，这一结论不再成立。考虑一个简单的[负频率](@entry_id:264021)依赖模型，可以构造一个例子，其中群体从一个初始频率出发，经过一代选择后，等位基因频率发生了变化，但群体的平均[适应度](@entry_id:154711)实际上**下降**了 [@problem_id:2700720]。这发生的原因是，当[等位基因频率](@entry_id:146872)改变时，整个“[适应度景观](@entry_id:162607)”本身也在改变。群体可能朝着一个方向演化，但这反过来又降低了当前状态下的平均[适应度](@entry_id:154711)。这一现象突显了将从简单模型中得出的结论推广到更复杂情景时必须保持谨慎。