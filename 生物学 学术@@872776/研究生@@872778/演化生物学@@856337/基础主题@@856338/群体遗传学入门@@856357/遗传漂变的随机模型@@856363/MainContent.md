## 引言
[遗传漂变](@entry_id:145594)是与自然选择、突变和迁移并列的核心演化力量之一，它描述了在有限群体中由于随机抽样导致的[等位基因频率](@entry_id:146872)的偶然波动。尽管其本质是随机的，但漂变的影响并非完全不可预测。事实上，一个多世纪以来，[群体遗传学](@entry_id:146344)家们发展出了一套强大的数学工具来精确地描述和量化其动态过程及其在塑造生物多样性中的关键作用。本文旨在系统性地介绍这些工具，解决看似矛盾的问题：我们如何为一种随机现象建立确定性的数学模型？

通过本文的学习，读者将深入理解[遗传漂变](@entry_id:145594)理论的基石。在第一章“原理与机制”中，我们将从第一性原理出发，构建经典的离散时间模型（Wright-Fisher和[Moran模型](@entry_id:195772)）和连续时间[扩散近似](@entry_id:147930)，并探讨它们的核心数学性质。在第二章“应用与跨学科联系”中，我们将展示这些理论模型如何被扩展以整合其他演化力量，并应用于解决[癌症生物学](@entry_id:148449)、[生物地理学](@entry_id:138434)和基因组学等前沿领域的实际问题。最后，在第三章“动手实践”中，你将有机会通过具体的计算和模拟练习，将理论知识转化为实践技能。

现在，让我们首先进入遗传漂变随机理论的核心，探索其最基本的原理和机制。

## 原理与机制

在[群体遗传学](@entry_id:146344)中，遗传漂变被定义为有限群体中由于随机抽样导致的等位基因频率的逐代波动。与选择、突变和迁移这些定[向性](@entry_id:144651)的进化力量不同，漂变是随机的，其方向和大小在每一代都不可预测。然而，这并不意味着我们无法对其动态和后果进行[数学建模](@entry_id:262517)。本章将深入探讨几种描述[遗传漂变](@entry_id:145594)的核心随机模型，阐明它们的基本假设、数学特性以及它们如何共同构成立群体遗传学随机理论的基石。我们将从离散时间的经典模型入手，逐步过渡到连续时间的[扩散近似](@entry_id:147930)，并展示如何应用这些工具来解决关键的演化问题。

### 基本离散时间模型

对遗传漂变最早且最富影响力的数学描述是基于离散、不重叠世代的框架。其中，两个模型——[Wright-Fisher模型](@entry_id:148998)和[Moran模型](@entry_id:195772)——因其简洁性和深刻的洞察力而占据了中心地位。

#### [Wright-Fisher模型](@entry_id:148998)

[Wright-Fisher模型](@entry_id:148998)是[群体遗传学](@entry_id:146344)随机理论的基石。它设想了一个理想化的群体，其繁殖过程遵循一组严格的规则。让我们首先考虑一个大小恒定为 $N$ 的单倍体群体，其中包含两种等位基因 $A$ 和 $a$。该模型的核心假设是，第 $t+1$ 代的 $N$ 个个体是通过对第 $t$ 代的 $N$ 个个体进行 $N$ 次独立的、有放回的抽样而形成的 [@problem_id:2753593]。

在第 $t$ 代，假设等位基因 $A$ 的频率为 $p_t$。那么，在为下一代抽取任何一个后[代时](@entry_id:173412)，其亲本为 $A$ 型的概率就是 $p_t$。由于这 $N$ 次抽样是独立的，第 $t+1$ 代中 $A$ 等位基因的数量 $X_{t+1}$ 就遵循一个[二项分布](@entry_id:141181)，其参数为试验次数 $N$ 和成功概率 $p_t$。即：
$$
X_{t+1} \mid p_t \sim \mathrm{Binomial}(N, p_t)
$$
这个基本结论可以推广到更复杂的情况。对于一个大小恒定为 $N$ 的二倍体群体，[基因库](@entry_id:267957)中总共有 $2N$ 个基因拷贝。[Wright-Fisher模型](@entry_id:148998)的逻辑保持不变：第 $t+1$ 代的 $2N$ 个基因拷贝是通过对第 $t$ 代的 $2N$ 个基因拷贝进行 $2N$ 次独立的、有放回的抽样而形成的。因此，如果第 $t$ 代 $A$ 等位基因的频率为 $p_t = X_t/(2N)$，那么下一代中 $A$ 等位基因的数量 $X_{t+1}$ 将遵循 $\mathrm{Binomial}(2N, p_t)$ [分布](@entry_id:182848) [@problem_id:2753527]。

一个至关重要的细节是，这个抽样过程直接作用于基因库。这意味着，等位基因如何组合成[二倍体](@entry_id:268054)基因型（例如，$AA$, $Aa$, $aa$）对于下一代等位基因频率的演化是无关紧要的。只要等位基因总数 $X_t$ 确定，无论群体是否处于哈迪-温伯格平衡，下一代的抽样概率 $p_t$ 就确定了 [@problem_id:2753527]。

从这个二项抽样机制中，我们可以立即推导出[Wright-Fisher模型](@entry_id:148998)的一些基本性质。对于一个[二倍体](@entry_id:268054)群体：

1.  **期望频率不变性**：下一代[等位基因频率](@entry_id:146872)的[期望值](@entry_id:153208)等于当前代的频率。
    $$
    \mathbb{E}[p_{t+1} \mid p_t] = \mathbb{E}\left[\frac{X_{t+1}}{2N} \mid p_t\right] = \frac{1}{2N}\mathbb{E}[X_{t+1} \mid p_t] = \frac{1}{2N}(2Np_t) = p_t
    $$
    这个性质表明，在没有其他进化力量（如选择或突变）的情况下，遗传漂变本身平均而言不会改变等位基因频率。在数学上，这意味着等位基因频率过程 $\{p_t\}$ 是一个**[鞅](@entry_id:267779)（martingale）**。

2.  **频率变化的[方差](@entry_id:200758)**：下一代频率的[条件方差](@entry_id:183803)量化了漂变的强度。
    $$
    \mathrm{Var}(p_{t+1} \mid p_t) = \mathrm{Var}\left(\frac{X_{t+1}}{2N} \mid p_t\right) = \frac{1}{(2N)^2}\mathrm{Var}(X_{t+1} \mid p_t) = \frac{2Np_t(1-p_t)}{(2N)^2} = \frac{p_t(1-p_t)}{2N}
    $$
    这个公式是群体遗传学中最重要的结果之一 [@problem_id:2753527] [@problem_id:2753593]。它精确地表明，遗传漂变的强度（以频率变化的[方差](@entry_id:200758)来衡量）与有效群体大小成反比。在[小群](@entry_id:198763)体中，随机波动更为剧烈；而在大群体中，则较为平缓。

3.  **[马尔可夫链](@entry_id:150828)特性**：由于第 $t+1$ 代的[频率分布](@entry_id:176998)完全由第 $t$ 代的频率决定，而与更早的世代无关，因此[等位基因频率](@entry_id:146872)过程 $\{p_t\}$ 是一个**[马尔可夫链](@entry_id:150828)**。由于状态转移的规则不随时间改变，它也是一个**时间齐次**的马尔可夫链 [@problem_id:2753527] [@problem_id:2753593]。

4.  **[吸收态](@entry_id:161036)**：当一个等位基因的频率达到 $0$（丢失）或 $1$（固定）时会发生什么？
    *   如果 $p_t = 0$，那么下一代抽中 $A$ 等位基因的概率为 $0$。因此，$X_{t+1}$ 必然为 $0$，即 $p_{t+1}=0$。
    *   如果 $p_t = 1$，那么下一代抽中 $A$ 等位基因的概率为 $1$。因此，$X_{t+1}$ 必然为 $2N$，即 $p_{t+1}=1$。
    在没有突变或迁移引入新变异的情况下，一旦群体到达这两个边界状态，它就无法离开。在[马尔可夫链](@entry_id:150828)的术语中，状态 $p=0$ 和 $p=1$ 是**吸收态（absorbing states）** [@problem_id:2753575]。这意味着，在任何有限群体中，[遗传漂变](@entry_id:145594)的最终结果必然是其中一个等位基因的丢失和另一个的固定，从而导致群体内[遗传多样性](@entry_id:201444)的丧失。

#### [Moran模型](@entry_id:195772)

[Moran模型](@entry_id:195772)提供了另一种描述遗传漂变的视角，它放弃了不重叠世代的假设，转而采用一个连续时间（或等效的，基于事件的离散时间）的框架。

在一个大小恒定为 $N$ 的单倍体群体中，[Moran模型](@entry_id:195772)的[基本事件](@entry_id:265317)是单个个体的出生和死亡 [@problem_id:2753554]。在每一个时间步，一个随机个体被选择进行繁殖，同时另一个随机个体被选择死亡，新生个体取代死亡个体的位置。在最简单的中性模型中，繁殖和死亡个体的选择都是从整个群体中均匀随机地进行的，并且这两个选择是独立的 [@problem_id:2753529]。

假设群体中有 $i$ 个 $A$ 等位基因和 $N-i$ 个 $a$ 等位基因。等位基因数量发生变化的情况只有两种：
*   $A$ 的数量增加 1 ($i \to i+1$)：这要求一个 $A$ 型个体被选中繁殖（概率为 $i/N$），同时一个 $a$ 型个体被选中死亡（概率为 $(N-i)/N$）。总概率为 $P_{i,i+1} = \frac{i(N-i)}{N^2}$。
*   $A$ 的数量减少 1 ($i \to i-1$)：这要求一个 $a$ 型个体被选中繁殖（概率为 $(N-i)/N$），同时一个 $A$ 型个体被选中死亡（概率为 $i/N$）。总概率为 $P_{i,i-1} = \frac{(N-i)i}{N^2}$。

如果繁殖和死亡的个体携带相同的等位基因，则群体状态不变。因此，与[Wright-Fisher模型](@entry_id:148998)不同，[Moran模型](@entry_id:195772)中的等位基因数量在每个事件中最多改变 $\pm 1$。这是一个**出生-死亡过程** [@problem_id:2753529]。

尽管机制不同，[Moran模型](@entry_id:195772)也表现出与[Wright-Fisher模型](@entry_id:148998)类似的关键特性。例如，在中性情况下，等位基因数量的期望变化为零：$\mathbb{E}[\Delta i \mid i] = (+1)P_{i,i+1} + (-1)P_{i,i-1} = 0$ [@problem_id:2753554]。同样，状态 $i=0$ 和 $i=N$ 也是吸收态。

#### [模型比较](@entry_id:266577)与时间尺度

[Wright-Fisher模型](@entry_id:148998)和[Moran模型](@entry_id:195772)的主要区别在于它们的繁殖结构：WF模型是**同步的**，整个群体在每一代都被替换；而[Moran模型](@entry_id:195772)是**异步的**，一次只有一个个体被替换。这也导致了对“时间”的不同理解。在WF模型中，一个时间单位是一代，期间发生了 $2N$ 次独立的基因抽样。在[Moran模型](@entry_id:195772)中，一个时间单位是一个出生-死亡事件。为了使这两个模型在描述漂变速率上具有可比性，需要进行时间尺度的调整。大致来说，[Moran模型](@entry_id:195772)中的 $N$ 个事件（足以让群体中每个个体平均被替换一次）大致对应于WF模型中的半代。当进行更严格的数学分析时，我们会发现，通过恰当的时间和参数缩放，这两个模型（以及许多其他类似模型）都会收敛到相同的连续时间极限，即[扩散近似](@entry_id:147930)。

### 遗传漂变的宏观效应

虽然遗传漂变在每一代的具体结果是随机的，但其长期累积的效应是可预测的。最重要的效应之一是[遗传多样性](@entry_id:201444)的丧失。

#### [杂合度](@entry_id:166208)的衰减

在[二倍体](@entry_id:268054)群体中，**[杂合度](@entry_id:166208)（heterozygosity）** $H$ 通常被定义为从群体中随机抽取两个基因拷贝，它们属于不同等位基因类型的概率。它是一个衡量群体遗传多样性的核心指标。[遗传漂变](@entry_id:145594)会不可避免地导致[杂合度](@entry_id:166208)的衰减。

我们可以通过一个简单的溯祖（coalescent）思想来推导这一过程 [@problem_id:2753561]。考虑第 $t+1$ 代的两个随机基因拷贝。它们在第 $t$ 代的祖先有两种可能：
1.  它们来自同一个亲本基因拷贝。在[Wright-Fisher模型](@entry_id:148998)中，第一次抽样选择了一个亲本，第二次抽样恰好选中同一个亲本的概率是 $1/(2N)$。
2.  它们来自两个不同的亲本基因拷贝。这个概率是 $1 - 1/(2N)$。

如果这两个基因拷贝来自同一个亲本，它们必然是相同的，因此它们属于不同类型的概率为 $0$。如果它们来自不同的亲本，它们属于不同类型的概率就是第 $t$ 代的[杂合度](@entry_id:166208) $H_t$。根据[全概率公式](@entry_id:194231)，我们可以写出 $H_{t+1}$ 的递推关系：
$$
H_{t+1} = \left(0 \times \frac{1}{2N}\right) + \left(H_t \times \left(1 - \frac{1}{2N}\right)\right)
$$
因此，我们得到了一个描述[杂合度](@entry_id:166208)随时间衰减的简单而深刻的公式：
$$
H_{t+1} = H_t \left(1 - \frac{1}{2N}\right)
$$
这个公式表明，在没有新突变补充的情况下，每个世代群体会以 $1/(2N)$ 的速率失去其[杂合度](@entry_id:166208)。这个速率完全由群体大小决定，是遗传漂变侵蚀遗传变异能力的直接量度。

### 推广框架：有效群体大小

理想化的[Wright-Fisher模型](@entry_id:148998)假设群体大小恒定、繁殖成功率遵循泊松分布（或[二项分布](@entry_id:141181)）等。然而，真实群体的繁殖动态要复杂得多。**有效群体大小（effective population size, $N_e$）**这个概念应运而生，旨在将一个具有复杂人口历史的真实群体，用一个“等效”的理想化Wright-Fisher群体的规模来表示。

有不同类型的有效群体大小，定义方式取决于我们关注的遗传学特性。其中一种是**[方差](@entry_id:200758)有效群体大小（variance effective population size）**。它被定义为这样一个理想WF群体的规模，该群体中[等位基因频率](@entry_id:146872)的逐代变化[方差](@entry_id:200758)与我们所研究的真实群体相同 [@problem_id:2753573]。

假设一个真实群体的等位基因频率变化[方差](@entry_id:200758)可以表示为 $\mathrm{Var}(\Delta p_t \mid p_t) \approx p_t(1-p_t)c_t$，其中 $c_t$ 是一个可能随时间变化的系数，它概括了所有偏离理想模型的复杂人口学因素。我们将此与理想[二倍体](@entry_id:268054)WF模型的[方差](@entry_id:200758) $\frac{p_t(1-p_t)}{2N_e}$ 相匹配，得到 $c_t = \frac{1}{2N_{e,t}}$，其中 $N_{e,t}$ 是第 $t$ 代的瞬时有效大小。为了获得一个描述长期漂变强度的单一参数 $N_e$，我们对漂变的“速率”进行平均。漂变的累积效应与[方差](@entry_id:200758)系数的总和成正比。因此，长期的平均速率 $\bar{c}$ 是 $c_t$ 的算术平均值。我们定义长期 $N_e$ 如下：
$$
\frac{1}{2N_e} = \bar{c} = \lim_{T\to\infty}\frac{1}{T}\sum_{t=1}^{T} c_t
$$
这个定义非常强大，因为它允许我们将各种复杂的现实因素——如波动的群体规模、不均等的繁殖贡献——的影响都压缩到一个单一、可比较的参数 $N_e$ 中，从而极大地扩展了随机理论的应用范围 [@problem_id:2753573]。

### [扩散近似](@entry_id:147930)：连续时间视角

离散模型虽然基础，但在处理诸如[等位基因固定](@entry_id:178848)时间或[固定概率](@entry_id:178551)等问题时，数学上往往变得非常棘手。**[扩散近似](@entry_id:147930)（diffusion approximation）**通过将离散的等位基因频率变化过程近似为一个连续的[随机过程](@entry_id:159502)，为这些问题提供了强大的分析工具。

其核心思想是，在群体规模 $N$ 很大时，单次事件或单个世代对等位基因频率 $p_t$ 的改变非常微小。因此，频率的轨迹可以被看作是连续的，其动态可以用一个随机微分方程（SDE）来描述：
$$
dX_t = a(X_t) dt + \sqrt{b(X_t)} dW_t
$$
其中 $X_t$ 是时间 $t$ 时的等位基因频率，$W_t$ 是标准的布朗运动（[维纳过程](@entry_id:137696)）。$a(x)$ 被称为**[漂移系数](@entry_id:199354)（drift coefficient）**，代表频率的瞬时期望变化率；$b(x)$ 被称为**[扩散](@entry_id:141445)系数（diffusion coefficient）**，代表频率的瞬时[方差](@entry_id:200758)变化率。它们分别定义为：
$$
a(x) = \lim_{\Delta t \to 0} \frac{\mathbb{E}[\Delta X \mid X_t=x]}{\Delta t}, \quad b(x) = \lim_{\Delta t \to 0} \frac{\mathbb{E}[(\Delta X)^2 \mid X_t=x]}{\Delta t}
$$

#### 时间尺度的关键作用

从离散模型到[扩散近似](@entry_id:147930)的过渡并非平凡，它要求对时间和模型参数进行恰当的**尺度变换（scaling）**。让我们以包含选择和突变的[二倍体](@entry_id:268054)[Wright-Fisher模型](@entry_id:148998)为例 [@problem_id:2753547]。在一个世代中，我们已经知道由漂变引起的[方差](@entry_id:200758)是 $\mathrm{Var}(\Delta p) \approx \frac{p(1-p)}{2N}$，这是一个 $O(1/N)$ 的小量。同时，由弱选择（选择系数 $s_N$）和弱突变（突变率 $\mu_N, \nu_N$）引起的频率期望变化 $\mathbb{E}[\Delta p]$ 也是一个小量。

为了在[连续极限](@entry_id:162780)中同时保留漂变（随机项）和弱选择/突变（确定性项）的效应，我们必须让它们具有相同的[数量级](@entry_id:264888)。这可以通过将时间尺度与群体大小联系起来实现。如果我们不以“代”为单位，而是以 $2N$ 代为一个新的时间单位来衡量演化，即 $t = \tau / (2N)$（其中 $\tau$ 是代数），那么一个世代对应的时间步长 $\Delta t = 1/(2N)$。
在这种尺度下，[扩散](@entry_id:141445)系数变为：
$$
b(p) = \lim_{N\to\infty} \frac{\mathrm{Var}(\Delta p)}{\Delta t} = \lim_{N\to\infty} \frac{p(1-p)/(2N)}{1/(2N)} = p(1-p)
$$
它成为了一个 $O(1)$ 的量。为了使[漂移系数](@entry_id:199354) $a(p)$ 也保持为 $O(1)$，$\mathbb{E}[\Delta p]$ 的分子必须与分母 $\Delta t$ 同阶，即 $O(1/N)$。这就要求选择和突变参数本身也必须是弱的，其强度与 $1/N$ 成正比。例如，我们设定 $s_N = \sigma/(2N)$，$\mu_N = \theta_1/(2N)$ 等，其中 $\sigma, \theta_1$ 是常数。在这种尺度变换下，我们得到了一个有意义的、包含所有进化力量的扩散方程 [@problem_id:2753547]。例如，对于连续时间[Moran模型](@entry_id:195772)，我们可以直接计算从状态 $i$ 到 $i\pm1$ 的转移速率，然后导出其[漂移和扩散](@entry_id:148816)系数，这为连接离散事件和连续过程提供了具体的范例 [@problem_id:2753589]。

#### 应用[扩散](@entry_id:141445)理论：[固定概率](@entry_id:178551)

[扩散](@entry_id:141445)框架最强大的应用之一是计算一个新突变等位基因的最终命运。例如，一个具有选择优势 $s$ 的新突变，其最终在群体中固定（频率达到 $1$）的概率是多少？

令 $u(p)$ 为一个初始频率为 $p$ 的等位基因的最终[固定概率](@entry_id:178551)。对于一个由[漂移系数](@entry_id:199354) $a(p)$ 和[扩散](@entry_id:141445)系数 $b(p)$ 描述的[扩散过程](@entry_id:170696)，$u(p)$ 满足一个被称为**向后[柯尔莫哥洛夫方程](@entry_id:270139)（backward Kolmogorov equation）**的[常微分方程](@entry_id:147024)：
$$
a(p) \frac{du}{dp} + \frac{1}{2} b(p) \frac{d^2u}{dp^2} = 0
$$
该方程的解需要满足两个边界条件：$u(0) = 0$（如果等位基因已丢失，其[固定概率](@entry_id:178551)为零）和 $u(1) = 1$（如果等位基因已固定，其[固定概率](@entry_id:178551)为一）。

以一个具有加[性选择](@entry_id:138426)的[二倍体](@entry_id:268054)[Wright-Fisher模型](@entry_id:148998)为例（[有效种群大小](@entry_id:146802)为 $N_e$，[选择系数](@entry_id:155033)为 $s$）[@problem_id:2753511]，其[漂移系数](@entry_id:199354) $a(p) \approx s p(1-p)$ 和[扩散](@entry_id:141445)系数 $b(p) \approx p(1-p)/(2N_e)$。代入向后方程并求解，可得到[固定概率](@entry_id:178551)的通用解：
$$
u(p) = \frac{1 - \exp(-4N_esp)}{1 - \exp(-4N_es)}
$$
这个公式优雅地连接了选择强度 $s$、有效群体大小 $N_e$ 和初始频率 $p$。如果我们考虑一个单拷贝的新突变，其初始频率为 $p = 1/(2N_e)$，那么它的[固定概率](@entry_id:178551)为：
$$
u\left(\frac{1}{2N_e}\right) = \frac{1 - \exp(-2s)}{1 - \exp(-4N_es)}
$$
这个著名的结果，完全通过[扩散](@entry_id:141445)理论推导得出，展示了数学模型如何将微观的随机事件（出生、死亡、抽样）与宏观的演化结果（[固定概率](@entry_id:178551)）联系起来，构成了现代[群体遗传学](@entry_id:146344)理论的核心。