{"hands_on_practices": [{"introduction": "本练习将带您回顾经典的间断接合实验，这是绘制细菌基因图谱的一项基石技术。通过假设Hfr供体以恒定速率转移DNA，我们可以将细菌染色体视为一把“卷尺”，其中基因进入受体的时间与遗传距离成正比。这项实践将让您运用这一基本原理，将原始的实验时间数据转化为一个连贯的、包含基因顺序和间距的物理图谱。[@problem_id:2484026]", "problem": "在一个经典的中断杂交实验中，使用处于高频重组 (Hfr) 状态的大肠杆菌 (Escherichia coli) 供体，其致育质粒 (F质粒) 已整合到染色体中。在时间 $t=0$ 杂交开始时，供体染色体DNA通过从转移起点开始的滚环复制转移到受体中，并沿着染色体单向线性进行。在这类实验中，重组子中某个可选择标记的最早检测时间被用作该标记的“进入时间”，并假定在恒定的有效线性转移速度下，该时间与其沿转移方向距离转移起点的染色体距离成正比。\n\n假设监测三个标记，分别表示为 $A$、$B$ 和 $C$，它们的进入时间（定义为中断杂交后回收带有各标记的重组子的最早时间）在杂交开始后分别观测为 $t_A=8$ 分钟，$t_B=14$ 分钟和 $t_C=23$ 分钟。假设在感兴趣的区间内，有效转移速度恒定为 $40\\,\\mathrm{kb\\,min^{-1}}$，转移沿单一轨迹进行且无逆转，并且任何固定的起始或重组延迟对所有标记都相同，因此进入时间的差异反映了沿转移方向的染色体距离的差异。\n\n仅基于这些观察和假设：\n1. 推断沿转移方向染色体上标记的顺序。\n2. 确定沿该方向相邻标记间的成对图距（以千碱基为单位）。\n3. 最后，报告从标记 $A$ 到标记 $C$ 沿转移方向的总图距（以千碱基为单位）。将您的最终数值答案四舍五入到三位有效数字，并以 $\\mathrm{kb}$ 表示。", "solution": "问题陈述描述了微生物学中用于遗传作图的一个经典的中断杂交实验。该问题有科学依据，提法得当，且所有提供的数据都一致且足以得出一个唯一解。我们将着手进行分析。\n\n该实验的基本原理是供体染色体以恒定速率从一个确定的转移起点 ($oriT$) 线性转移到受体细胞中。问题指出，有效转移速度（记为 $v$）是恒定的。对于一个给定的标记 $M$，其进入时间 $t_M$ 是从杂交开始到在受体中检测到该标记所经过的时间。问题明确指出，任何固定的延迟时间对所有标记都是恒定的。因此，染色体上任意两个标记 $M_1$ 和 $M_2$ 之间的物理距离 $\\Delta d$ 与它们的进入时间之差 $\\Delta t = t_{M_2} - t_{M_1}$ 成正比。该关系由以下公式给出：\n$$ \\Delta d = v \\cdot \\Delta t $$\n该方程构成了所有后续计算的基础。\n\n已知条件如下：\n- 标记 $A$ 的进入时间：$t_A = 8\\,\\mathrm{分钟}$\n- 标记 $B$ 的进入时间：$t_B = 14\\,\\mathrm{分钟}$\n- 标记 $C$ 的进入时间：$t_C = 23\\,\\mathrm{分钟}$\n- 有效转移速度：$v = 40\\,\\mathrm{kb\\,min^{-1}}$\n\n按照问题的要求，分析分三步进行。\n\n1. 推断标记的顺序。\n染色体DNA的转移是线性和单向的。这意味着距离转移起点更近的标记会更早被转移。通过比较进入时间，我们可以确定基因沿转移方向在染色体上的相对顺序。\n观测到的进入时间为 $t_A = 8\\,\\mathrm{min}$，$t_B = 14\\,\\mathrm{min}$ 和 $t_C = 23\\,\\mathrm{min}$。\n我们观察到不等式：\n$$ t_A  t_B  t_C $$\n$$ 8\\,\\mathrm{min}  14\\,\\mathrm{min}  23\\,\\mathrm{min} $$\n这个时间顺序直接对应于标记在染色体上相对于转移起点的空间顺序。因此，沿转移方向的标记顺序是 $A - B - C$。\n\n2. 确定相邻标记间的成对图距。\n图距是两个标记之间的物理距离，这里以千碱基 ($kb$) 表示。我们使用已建立的公式 $\\Delta d = v \\cdot \\Delta t$。\n相邻标记 $A$ 和 $B$ 之间的图距，记为 $d_{AB}$，计算如下：\n$$ d_{AB} = v \\cdot (t_B - t_A) $$\n$$ d_{AB} = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (14\\,\\mathrm{min} - 8\\,\\mathrm{min}) = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (6\\,\\mathrm{min}) = 240\\,\\mathrm{kb} $$\n相邻标记 $B$ 和 $C$ 之间的图距，记为 $d_{BC}$，计算如下：\n$$ d_{BC} = v \\cdot (t_C - t_B) $$\n$$ d_{BC} = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (23\\,\\mathrm{min} - 14\\,\\mathrm{min}) = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (9\\,\\mathrm{min}) = 360\\,\\mathrm{kb} $$\n所以，$A-B$ 的成对图距为 $240\\,\\mathrm{kb}$，$B-C$ 的成对图距为 $360\\,\\mathrm{kb}$。\n\n3. 报告从标记 A 到标记 C 的总图距。\n从标记 $A$ 到标记 $C$ 的总图距，记为 $d_{AC}$，是中间图距之和，因为转移是线性的且基因顺序是 $A-B-C$。\n$$ d_{AC} = d_{AB} + d_{BC} = 240\\,\\mathrm{kb} + 360\\,\\mathrm{kb} = 600\\,\\mathrm{kb} $$\n这个结果可以通过直接使用标记 $A$ 和 $C$ 的进入时间来计算距离，进行独立验证：\n$$ d_{AC} = v \\cdot (t_C - t_A) $$\n$$ d_{AC} = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (23\\,\\mathrm{min} - 8\\,\\mathrm{min}) = (40\\,\\mathrm{kb\\,min^{-1}}) \\cdot (15\\,\\mathrm{min}) = 600\\,\\mathrm{kb} $$\n两种方法得出了相同的结果，证实了模型和数据的一致性。\n\n问题要求最终答案四舍五入到三位有效数字。计算出的值恰好是 $600$。为了以三位有效数字的明确精度表示这个数字，我们使用标准科学记数法。因此，数值 $600$ 表示为 $6.00 \\times 10^2$。", "answer": "$$\\boxed{6.00 \\times 10^2}$$", "id": "2484026"}, {"introduction": "虽然基因图谱绘制的基本模型假设了DNA转移过程不被中断，但现实世界中的接合是一个脆弱的过程，会受到随机物理因素的干扰。本练习在理想化的确定性模型基础上更进一步，引入了随机元素，将接合中断视为一个恒定风险过程。您将从第一性原理出发，推导出一个基因在接合对断裂前成功转移的概率，从而定量地理解为何远离转移起点的基因转移效率会降低。[@problem_id:2484036]", "problem": "在细菌的高频重组（Hfr）供体-受体接合中，脱氧核糖核酸（DNA）的转移从转移起始点（oriT）开始，并通过滚环复制沿染色体单向进行。假设在一个受控的中断接合实验中，线性转移速度恒为 $v$，单位为 $\\mathrm{kb\\,min^{-1}}$。假设接合对的物理中断是一个无记忆过程，具有恒定的风险（率）$\\mu$，单位为 $\\mathrm{min^{-1}}$，并且与染色体上的位置无关。根据滚环复制机制的定义，传递一个距离 oriT 图距为 $d$（单位为 $\\mathrm{kb}$）的染色体标记所需的时间，就是遍历该距离所需的转移时间。\n\n仅使用这些假设和恒定风险过程的标准性质，从第一性原理推导出在中断发生前成功获得位于距离 oriT 为 $d$ 的特定染色体标记的受体细胞的期望分数，然后用以下参数对其进行求值：$v = 30\\,\\mathrm{kb\\,min^{-1}}$，$\\mu = 0.08\\,\\mathrm{min^{-1}}$，以及 $d = 750\\,\\mathrm{kb}$。将最终的期望分数表示为小数（而非百分比），并将您的答案四舍五入到四位有效数字。", "solution": "在进行求解之前，首先对问题陈述的有效性进行严格评估。\n\n步骤1：提取已知条件。\n已知条件如下：\n- 背景是细菌中的高频重组 (Hfr) 接合。\n- DNA 转移在转移起始点 `oriT` 启动。\n- 转移是通过滚环复制单向进行的。\n- 线性转移速度是恒定的，记为 $v$，单位为 $\\mathrm{kb\\,min^{-1}}$。\n- 接合对的物理中断是一个无记忆过程。\n- 中断的风险率是恒定的，记为 $\\mu$，单位为 $\\mathrm{min^{-1}}$。\n- 中断过程与染色体位置无关。\n- 传递一个位于图距 $d$（单位 $\\mathrm{kb}$）处的染色体标记所需的时间，就是遍历该距离所需的转移时间。\n- 用于求值的具体参数：$v = 30\\,\\mathrm{kb\\,min^{-1}}$，$\\mu = 0.08\\,\\mathrm{min^{-1}}$，以及 $d = 750\\,\\mathrm{kb}$。\n\n步骤2：使用提取的已知条件进行验证。\n根据既定标准对问题进行评估：\n- **科学依据**：所述模型是细菌遗传学中中断接合实验的一个标准、简化但有效的表示。恒定转移速度和随机、无记忆中断事件的假设是对此类实验进行定量分析的基础。将中断描述为一个恒定风险过程，这正确定性了等待时间的指数分布，这是随机过程中的一个基本概念。\n- **适定性**：该问题是适定的。它要求基于明确定义的物理和概率模型，推导一个特定的物理量（成功受体的期望分数）。进行一般推导（$v$、$\\mu$、$d$）和具体数值计算所需的所有参数都已提供。存在唯一、稳定的解。\n- **客观性**：语言精确、技术性强，没有主观或模棱两可的术语。\n\n该问题没有表现出任何科学上不健全、不完整、矛盾或不可行等缺陷。这是一个定量生物学中的标准问题，它将确定性运动与随机过程相结合。\n\n步骤3：结论与行动。\n该问题具有科学依据、适定、客观且内部一致。因此，它被判定为**有效**。将从第一性原理推导求解。\n\n该问题要求推导成功获得特定染色体标记的受体细胞的期望分数。如果DNA转移所需的时间小于接合对被物理中断前的时间，则一个细胞是成功的。\n\n首先，我们定义DNA转移所需的时间 $T_{transfer}$。转移以恒定的线速度 $v$ 在距离 $d$ 上进行。这是一个确定性过程。因此，所需时间由以下公式给出：\n$$\nT_{transfer} = \\frac{d}{v}\n$$\n\n接下来，我们为中断时间 $T_{disrupt}$ 建模。问题陈述这是一个具有恒定风险率 $\\mu$ 的无记忆过程。这是一个事件等待时间遵循指数分布的过程的定义特征。设 $T_{disrupt}$ 是表示直到中断发生的时间的随机变量。$T_{disrupt}$ 的概率密度函数 (PDF) 是：\n$$\nf(t) = \\mu \\exp(-\\mu t) \\quad \\text{for } t \\ge 0\n$$\n到某一时间 $t$ 时中断*尚未*发生的概率由生存函数 $S(t) = P(T_{disrupt} > t)$ 给出。这通过将概率密度函数从 $t$ 积分到无穷大来计算：\n$$\nS(t) = P(T_{disrupt} > t) = \\int_{t}^{\\infty} \\mu \\exp(-\\mu \\tau) \\,d\\tau = \\left[ -\\exp(-\\mu \\tau) \\right]_{t}^{\\infty} = 0 - (-\\exp(-\\mu t)) = \\exp(-\\mu t)\n$$\n当且仅当随机的中断时间大于固定的转移所需时间时，受体细胞才能成功获得标记。在数学上，这个条件是 $T_{disrupt} > T_{transfer}$。\n\n我们记成功受体的期望分数为 $F$，它是该事件发生的概率：\n$$\nF = P(T_{disrupt} > T_{transfer})\n$$\n我们可以通过在时间 $t = T_{transfer}$ 处评估生存函数来找到这个概率：\n$$\nF = S(T_{transfer}) = \\exp(-\\mu T_{transfer})\n$$\n代入 $T_{transfer} = d/v$ 的表达式，我们得到成功受体期望分数作为距离 $d$ 的函数的通用公式：\n$$\nF(d) = \\exp\\left(-\\frac{\\mu d}{v}\\right)\n$$\n这就完成了从第一性原理的推导。\n\n现在，我们使用给定的参数 $v = 30\\,\\mathrm{kb\\,min^{-1}}$，$\\mu = 0.08\\,\\mathrm{min^{-1}}$ 和 $d = 750\\,\\mathrm{kb}$ 来评估这个表达式。\n\n首先，计算转移时间 $T_{transfer}$：\n$$\nT_{transfer} = \\frac{d}{v} = \\frac{750\\,\\mathrm{kb}}{30\\,\\mathrm{kb\\,min^{-1}}} = 25\\,\\mathrm{min}\n$$\n接下来，计算指数函数的参数，即风险率和转移时间的乘积：\n$$\n-\\mu T_{transfer} = -(0.08\\,\\mathrm{min^{-1}}) \\times (25\\,\\mathrm{min}) = -2\n$$\n最后，计算期望分数 $F$：\n$$\nF = \\exp(-2)\n$$\n数值约为 $0.13533528...$。问题要求答案四舍五入到四位有效数字。\n$$\nF \\approx 0.1353\n$$\n这是在中断发生前，将获得位于距离 `oriT` 为 $750\\,\\mathrm{kb}$ 的标记的受体细胞的期望分数。", "answer": "$$\\boxed{0.1353}$$", "id": "2484036"}, {"introduction": "在探究了单次接合事件中的DNA转移机制后，我们现在将视角放大，思考接合在群体水平上带来的后果。质粒在细菌群体中的传播是进化和公共卫生领域的关键过程，它驱动了抗生素抗性等性状的扩散。在这项高级实践中，您将建立并数值求解一个常微分方程组，以模拟细菌生长、质粒转移以及携带质粒所带来的适应性成本或收益之间的动态相互作用。[@problem_id:2484017]", "problem": "您正在使用一个基于逻辑斯谛增长和质量作用相遇动力学的种群动力学框架，对由 F 生育质粒（F 质粒）介导的细菌接合动力学进行建模，该模型明确包含了滚环复制和质粒携带的适应性效应。生物学类别包括供体（最初携带 F 质粒的细胞）、受体（不含质粒的细胞）和接合子（通过接合获得质粒的前受体细胞）。关键的机理基础是：(i) 在环境承载能力下的逻辑斯谛增长，(ii) 携带质粒细胞与不含质粒细胞之间的质量作用相遇驱动接合，(iii) 滚环复制确保携带质粒的细胞在转移质粒后不会丢失它，以及 (iv) 质粒携带会带来适应性成本，并可能在特定环境下赋予收益。\n\n使用由环境承载能力缩放的密度进行研究，即定义 $x(t)$、$y(t)$ 和 $z(t)$ 分别为在时间 $t$ 的供体、受体和接合子的密度，表示为环境承载能力 $K$ 的分数，因此有 $0 \\le x(t), y(t), z(t)$ 且 $n(t) = x(t) + y(t) + z(t) \\le 1$。必须使用以下基本原理来构建模型：\n\n- 逻辑斯谛增长：一个具有内在人均增长率 $g$ 的种群以 $g \\cdot X \\cdot (1 - N/K)$ 的速率增长，其中 $X$ 是亚种群大小，$N$ 是总种群大小。在缩放密度下，这表示为 $g \\cdot x \\cdot (1 - n)$，其中 $x = X/K$ 且 $n = N/K$。\n- 质量作用相遇：携带质粒细胞与不含质粒细胞之间的接合事件发生的速率与它们的密度乘积成正比。在缩放形式下，这导致从受体到接合子的流与 $k \\cdot y \\cdot (x + z)$ 成正比，其中 $k$ 是一个以每小时为单位的接合速率常数。\n- 接合过程中的滚环复制确保供体保留质粒；因此，接合不会直接减少供体或接合子的密度。\n- 适应性效应：如果不含质粒的受体的内在人均增长率为 $r$（单位为每小时），那么携带质粒的细胞（供体和接合子）的调整后增长率为 $r_{\\mathrm{P}} = r \\cdot (1 - c + b)$，其中 $c$ 是质粒携带的分数适应性成本，$b$ 是质粒赋予的分数收益。\n\n任务：\n- 仅从上述基本原理出发，为 $x(t)$、$y(t)$ 和 $z(t)$ 推导出一个与这些机制一致的常微分方程组。\n- 使用固定步长的四阶 Runge–Kutta 方法实现一个数值求解器，对您推导出的系统从 $t = 0$ 到 $t = \\tau$ 进行积分。\n- 对于每个提供的测试用例，模拟并报告最终的接合子频率 $f_{\\mathrm{T}}(\\tau) = \\dfrac{z(\\tau)}{x(\\tau) + y(\\tau) + z(\\tau)}$。\n- 单位：时间必须以小时为单位，速率 $r$ 和 $k$ 必须以每小时为单位，$f_{\\mathrm{T}}(\\tau)$ 必须以小数形式报告（而非百分比）。\n- 需使用的实现细节：\n  - $t = 0$ 时的初始条件：$x(0) = 10^{-4}$，$y(0) = 9 \\times 10^{-4}$，$z(0) = 0$。\n  - 基础受体增长率：$r = 1.0$ 每小时。\n  - 质粒收益：$b = 0.1$（无量纲）。\n  - 模拟时长：$\\tau = 24$ 小时。\n  - 数值积分的时间步长：$\\Delta t = 0.01$ 小时。\n\n测试套件：\n- 每个测试由一对 $(k, c)$ 组成，其中 $k$ 的单位是每小时，$c$ 是无量纲的。\n  - 测试 1：$k = 0.0$，$c = 0.05$。\n  - 测试 2：$k = 0.05$，$c = 0.4$。\n  - 测试 3：$k = 0.1$，$c = 0.0$。\n  - 测试 4：$k = 0.2$，$c = 0.05$。\n  - 测试 5：$k = 1.5$，$c = 0.05$。\n\n输出规格：\n- 您的程序必须生成单行输出，其中包含五个 $f_{\\mathrm{T}}(\\tau)$ 值的逗号分隔列表，每个值四舍五入到恰好 $6$ 位小数，并用方括号括起来，顺序与上面列出的测试一致。例如，输出应类似于：\"[0.123456,0.234567,0.345678,0.456789,0.567890]\"。", "solution": "问题陈述经评估有效。它在科学上基于种群动力学和微生物遗传学的既定原理，作为一个常微分方程组的初值问题，其提法是适定的，并且以客观、明确的语言表述。所有必要的数据、参数和边界条件都已提供，不存在内部矛盾或逻辑缺陷。\n\n任务是模拟参与 F 质粒接合的三个细菌亚种群——供体 ($x$)、受体 ($y$) 和接合子 ($z$) 的动力学。密度由环境承载能力 $K$ 进行缩放。我们将首先从提供的基本原理推导常微分方程（ODEs）系统，然后描述其数值求解方法。\n\n设时间 $t$ 的缩放密度为 $x(t)$、$y(t)$ 和 $z(t)$。总缩放密度为 $n(t) = x(t) + y(t) + z(t)$。所有种群的增长都受到逻辑斯谛约束，由因子 $(1 - n(t))$ 表示。\n\n不含质粒的受体的内在人均增长率为 $r$。对于携带质粒的细胞（供体和接合子），增长率受到适应性成本 $c$ 和收益 $b$ 的修正，导致净增长率为 $r_{\\mathrm{P}} = r(1 - c + b)$。\n\n每个亚种群的变化率是通过接合实现的增长和种群转移项的总和。\n\n1.  **供体种群动力学 ($\\frac{dx}{dt}$):**\n    供体是携带质粒的细胞，因此以速率 $r_{\\mathrm{P}}$ 增长，并受到逻辑斯谛动力学的约束。增长项为 $+r_{\\mathrm{P}} x(t)(1 - n(t))$。根据滚环复制的原理，供体细胞在将其副本转移给受体时不会丢失其质粒。因此，不存在与接合过程相关的供体损失项。初始供体种群及其后代仍然是供体。\n    供体密度的微分方程为：\n    $$\n    \\frac{dx}{dt} = r_{\\mathrm{P}} x(t) \\left(1 - (x(t) + y(t) + z(t))\\right)\n    $$\n\n2.  **受体种群动力学 ($\\frac{dy}{dt}$):**\n    受体是不含质粒的细胞，以其内在速率 $r$ 增长，并受逻辑斯谛约束。增长项为 $+r y(t)(1-n(t))$。当受体从任何携带质粒的细胞（供体或接合子，总密度为 $x(t) + z(t)$）获得质粒时，它们会转化为接合子。此过程由质量作用动力学控制，接合速率常数为 $k$。这导致一个损失项，与受体密度和总质粒携带者密度的乘积成正比：$-k y(t)(x(t) + z(t))$。\n    受体密度的微分方程为：\n    $$\n    \\frac{dy}{dt} = r y(t) \\left(1 - (x(t) + y(t) + z(t))\\right) - k y(t) \\left(x(t) + z(t)\\right)\n    $$\n\n3.  **接合子种群动力学 ($\\frac{dz}{dt}$):**\n    接合子是新形成的携带质粒的细胞。它们以与供体相同的速率 $r_{\\mathrm{P}}$ 增长，并受逻辑斯谛限制。增长项为 $+r_{\\mathrm{P}} z(t)(1-n(t))$。接合子是通过接合从受体产生的。这个增益项必须等于受体种群的损失项：$+k y(t)(x(t) + z(t))$。与供体类似，接合子在后续的接合事件中也充当质粒供体，但不会失去其质粒状态。\n    接合子密度的微分方程为：\n    $$\n    \\frac{dz}{dt} = r_{\\mathrm{P}} z(t) \\left(1 - (x(t) + y(t) + z(t))\\right) + k y(t) \\left(x(t) + z(t)\\right)\n    $$\n\n总而言之，完整的 ODE 系统是：\n$$\n\\begin{cases}\n\\frac{dx}{dt} = r(1-c+b) \\cdot x \\cdot (1 - (x+y+z)) \\\\\n\\frac{dy}{dt} = r \\cdot y \\cdot (1 - (x+y+z)) - k \\cdot y \\cdot (x+z) \\\\\n\\frac{dz}{dt} = r(1-c+b) \\cdot z \\cdot (1 - (x+y+z)) + k \\cdot y \\cdot (x+z)\n\\end{cases}\n$$\n\n为了数值求解此系统，我们采用固定步长的四阶 Runge-Kutta (RK4) 方法。对于由 $\\frac{d\\vec{v}}{dt} = \\vec{f}(t, \\vec{v})$ 给出的 ODE 系统，其中 $\\vec{v}(t) = [x(t), y(t), z(t)]^T$，从时间 $t_i$ 到 $t_{i+1}$ 的一个步长为 $\\Delta t$ 的计算如下：\n$$ \\vec{v}_{i+1} = \\vec{v}_i + \\frac{\\Delta t}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4) $$\n其中\n$$\n\\begin{align*}\n\\vec{k}_1 = \\vec{f}(t_i, \\vec{v}_i) \\\\\n\\vec{k}_2 = \\vec{f}(t_i + \\frac{\\Delta t}{2}, \\vec{v}_i + \\frac{\\Delta t}{2} \\vec{k}_1) \\\\\n\\vec{k}_3 = \\vec{f}(t_i + \\frac{\\Delta t}{2}, \\vec{v}_i + \\frac{\\Delta t}{2} \\vec{k}_2) \\\\\n\\vec{k}_4 = \\vec{f}(t_i + \\Delta t, \\vec{v}_i + \\Delta t \\vec{k}_3)\n\\end{align*}\n$$\n向量函数 $\\vec{f}$ 是我们推导的 ODE 系统的右侧，它是自治的（不显式依赖于 $t$）。\n\n模拟过程从初始条件 $x(0) = 10^{-4}$、$y(0) = 9 \\times 10^{-4}$ 和 $z(0) = 0$ 开始。参数设置为 $r=1.0$ 每小时，$b=0.1$，$\\tau=24$ 小时，$\\Delta t = 0.01$ 小时。对于每个测试用例 $(k, c)$，通过重复应用 RK4 算法 $N = \\tau / \\Delta t = 2400$ 步，将系统从 $t=0$ 积分到 $t=\\tau$。\n\n在最后一步之后，获得密度 $x(\\tau)$、$y(\\tau)$ 和 $z(\\tau)$。然后计算最终的接合子频率 $f_{\\mathrm{T}}(\\tau)$：\n$$\nf_{\\mathrm{T}}(\\tau) = \\frac{z(\\tau)}{x(\\tau) + y(\\tau) + z(\\tau)}\n$$\n提供的代码实现了这整个过程，遍历每个测试用例并计算相应的最终接合子频率，然后按规定格式化输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves a system of ODEs for bacterial conjugation dynamics.\n    \"\"\"\n\n    def odesystem(v, r, r_p, k):\n        \"\"\"\n        Defines the system of ODEs for the conjugation model.\n\n        Args:\n            v (np.ndarray): State vector [x, y, z] representing donor, recipient,\n                            and transconjugant densities.\n            r (float): Intrinsic growth rate of recipients.\n            r_p (float): Intrinsic growth rate of plasmid-bearing cells.\n            k (float): Conjugation rate constant.\n\n        Returns:\n            np.ndarray: The derivatives [dx/dt, dy/dt, dz/dt].\n        \"\"\"\n        x, y, z = v[0], v[1], v[2]\n        \n        n = x + y + z\n        logistic_factor = 1.0 - n\n        \n        # Rate of encounters leading to conjugation\n        conjugation_term = k * y * (x + z)\n        \n        # ODE for each subpopulation\n        dxdt = r_p * x * logistic_factor\n        dydt = r * y * logistic_factor - conjugation_term\n        dzdt = r_p * z * logistic_factor + conjugation_term\n        \n        return np.array([dxdt, dydt, dzdt])\n\n    def rk4_step(f, v, dt, r, r_p, k):\n        \"\"\"\n        Performs a single step of the fourth-order Runge-Kutta method.\n\n        Args:\n            f (function): The function defining the ODE system.\n            v (np.ndarray): Current state vector.\n            dt (float): Time step size.\n            r, r_p, k: Parameters for the ODE system.\n\n        Returns:\n            np.ndarray: The state vector at the next time step.\n        \"\"\"\n        k1 = f(v, r, r_p, k)\n        k2 = f(v + dt / 2.0 * k1, r, r_p, k)\n        k3 = f(v + dt / 2.0 * k2, r, r_p, k)\n        k4 = f(v + dt * k3, r, r_p, k)\n        \n        return v + dt / 6.0 * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n\n    def simulate_case(k_val, c_val):\n        \"\"\"\n        Runs a full simulation for a given (k, c) pair.\n\n        Args:\n            k_val (float): Conjugation rate constant.\n            c_val (float): Fitness cost of the plasmid.\n\n        Returns:\n            float: The final transconjugant frequency f_T(tau).\n        \"\"\"\n        # Problem-defined constants and initial conditions\n        r_base = 1.0\n        b = 0.1\n        tau = 24.0\n        dt = 0.01\n        \n        x0 = 1e-4\n        y0 = 9e-4\n        z0 = 0.0\n        \n        # State vector\n        v = np.array([x0, y0, z0])\n        \n        # Derived growth rate for plasmid-bearers\n        r_p = r_base * (1.0 - c_val + b)\n        \n        # Simulation loop\n        num_steps = int(tau / dt)\n        for _ in range(num_steps):\n            v = rk4_step(odesystem, v, dt, r_base, r_p, k_val)\n        \n        # Calculate final transconjugant frequency\n        x_final, y_final, z_final = v[0], v[1], v[2]\n        total_density = x_final + y_final + z_final\n        \n        if total_density == 0:\n            return 0.0\n        \n        f_T = z_final / total_density\n        return f_T\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        (0.0, 0.05),  # Test 1\n        (0.05, 0.4),  # Test 2\n        (0.1, 0.0),   # Test 3\n        (0.2, 0.05),  # Test 4\n        (1.5, 0.05)   # Test 5\n    ]\n    \n    results = []\n    for k, c in test_cases:\n        result = simulate_case(k, c)\n        results.append(f\"{result:.6f}\") # Format to 6 decimal places\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2484017"}]}