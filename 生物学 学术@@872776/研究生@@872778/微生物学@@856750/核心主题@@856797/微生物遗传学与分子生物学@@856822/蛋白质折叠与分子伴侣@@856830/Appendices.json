{"hands_on_practices": [{"introduction": "测量蛋白质的稳定性——其折叠态和去折叠态之间的吉布斯自由能差（$\\Delta G$）——是蛋白质科学的基石。化学变性实验是获取这一关键热力学参数的经典方法。本练习将指导你将实验数据拟合到双态折叠模型中，从而提取核心的热力学参数 $\\Delta G_{\\mathrm{H_2O}}$ 和 $m$ 值，这不仅能加深你对蛋白质稳定性的理解，还能锻炼你必备的数据分析和建模能力[@problem_id:2765810]。", "problem": "一个处于恒温下的双态蛋白质折叠系统，被浓度为 $[D]$（单位为 $\\mathrm{M}$）的变性剂化学变性。观测值为天然构象系综的比例 $f_N([D])$，在每个 $[D]$ 浓度下独立测量。从以下基本原理出发：(i) 平衡常数 $K = \\exp(-\\Delta G / (R T))$ 的热力学定义，它通过玻尔兹曼因子将去折叠系综与天然系综之间的吉布斯自由能差 $\\Delta G$ 与平衡常数联系起来，(ii) 根据配分函数定义的双态系统中状态比例的定义，以及 (iii) 在中低变性剂浓度下，$\\Delta G$ 与变性剂浓度呈经验线性关系 $\\Delta G([D]) = \\Delta G_{\\mathrm{H_2O}} - m [D]$。根据这些原理，推导出一个正向模型，该模型能用 $\\Delta G_{\\mathrm{H_2O}}$（单位 $\\mathrm{kJ/mol}$）、$m$（单位 $\\mathrm{kJ/mol/M}$）、气体常数 $R$（单位 $\\mathrm{kJ/(mol\\cdot K)}$）和绝对温度 $T$（单位 $\\mathrm{K}$）来预测 $f_N([D])$。通过最小化测量值 $f_N([D])$ 与模型预测值之间的残差平方和，构建一个非线性最小二乘法目标函数，以估计 $\\Delta G_{\\mathrm{H_2O}}$ 和 $m$。对所有数据点使用相等的权重。通过在最优点周围进行线性误差传播，根据残差估计拟合参数的不确定度（标准误差）：计算残差相对于参数在最优点处的雅可比矩阵，使用残差方差估计量 $\\hat{\\sigma}^2 = \\mathrm{RSS}/(n - p)$（其中 $n$ 是数据点数量，$p$ 是拟合参数数量），并构建参数协方差矩阵 $\\hat{\\sigma}^2 (J^\\top J)^{-1}$；如果 $J^\\top J$ 是病态的，则使用 Moore–Penrose 伪逆。将此协方差矩阵对角线元素的平方根作为参数的标准误差进行报告。约束 $m \\ge 0$。\n\n假设温度 $T = 298.15$ $\\mathrm{K}$，气体常数 $R = 0.008314462618$ $\\mathrm{kJ/(mol\\cdot K)}$。对于以下三个测试用例，均提供了变性剂浓度 $[D]$（单位 $\\mathrm{M}$）和测量的比例 $f_N$（无量纲）。所有 $f_N$ 值均为独立测量值。\n\n- 用例 A（宽转变）：\n  $[D] = [0.0, 1.0, 2.0, 3.0, 4.0, 4.5, 5.0, 6.0, 7.0]$，\n  $f_N = [0.999, 0.999, 0.995, 0.946, 0.600, 0.310, 0.118, 0.012, 0.001]$。\n\n- 用例 B（转变中段区域）：\n  $[D] = [0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0]$，\n  $f_N = [0.885, 0.835, 0.770, 0.690, 0.600, 0.500, 0.400]$。\n\n- 用例 C（低变性剂浓度下信息部分不足，中点附近急剧下降）：\n  $[D] = [0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0]$，\n  $f_N = [1.000, 1.000, 1.000, 0.983, 0.500, 0.017, 0.000]$。\n\n对于每个用例，您的程序必须使用非线性最小二乘法，在上述基本原理推导出的双态模型下，拟合 $\\Delta G_{\\mathrm{H_2O}}$（单位 $\\mathrm{kJ/mol}$）和 $m$（单位 $\\mathrm{kJ/mol/M}$），并使用上述基于残差的协方差近似法计算它们的标准误差。生成的结果需四舍五入到三位小数。用 $\\mathrm{kJ/mol}$ 表示 $\\Delta G_{\\mathrm{H_2O}}$，用 $\\mathrm{kJ/mol/M}$ 表示 $m$，其标准误差的单位应与对应参数的单位相同。\n\n最终输出格式：您的程序应生成单行输出，包含一个由列表组成的逗号分隔列表，每个内部列表对应一个测试用例，且每个内部列表按 $[\\Delta G_{\\mathrm{H_2O}}, m, s_{\\Delta G_{\\mathrm{H_2O}}}, s_m]$ 的顺序排列，例如 $[[x_{A1},x_{A2},x_{A3},x_{A4}],[x_{B1},x_{B2},x_{B3},x_{B4}],[x_{C1},x_{C2},x_{C3},x_{C4}]]$，其中每个 $x$ 是一个四舍五入到三位小数的浮点数。", "solution": "问题陈述在生物物理化学和数据分析领域提出了一个有效且定义明确的任务。它在科学上基于经典的蛋白质折叠双态模型和线性外推法。该问题是自包含的，提供了所有必要的数据、常数以及对所需数学和统计程序的清晰描述。它没有矛盾、歧义或事实错误。因此，将提供一个合理的解决方案。\n\n任务是通过使用非线性最小二乘法拟合双态折叠模型，从蛋白质变性数据中估计热力学参数 $\\Delta G_{\\mathrm{H_2O}}$ 和 $m$，并计算这些估计值的不确定度。\n\n首先，我们推导天然蛋白质比例 $f_N$ 作为变性剂浓度 $[D]$ 函数的正向模型。该系统被描述为天然（$N$）和去折叠（$U$）状态之间的双态平衡：\n$$ N \\rightleftharpoons U $$\n该反应（代表去折叠过程）的平衡常数由各状态浓度的比值给出：\n$$ K = \\frac{[U]}{[N]} $$\n问题将 $\\Delta G$ 定义为去折叠系综和天然系综之间的吉布斯自由能差，因此 $\\Delta G = G_U - G_N$。对于在没有变性剂的情况下稳定折叠的蛋白质，$G_N  G_U$，这意味着 $\\Delta G > 0$。平衡常数与 $\\Delta G$ 之间的关系由基本热力学方程给出：\n$$ K = \\exp\\left(-\\frac{\\Delta G}{RT}\\right) $$\n其中 $R$ 是气体常数，$T$ 是绝对温度。\n\n观测值 $f_N$ 是处于天然状态的蛋白质分子的比例。用浓度表示如下：\n$$ f_N = \\frac{[N]}{[N] + [U]} $$\n通过将分子和分母同时除以 $[N]$，我们可以用平衡常数 $K$ 来表示 $f_N$：\n$$ f_N = \\frac{1}{1 + \\frac{[U]}{[N]}} = \\frac{1}{1 + K} $$\n代入 $K$ 的表达式，得到 $f_N$ 和 $\\Delta G$ 之间的关系：\n$$ f_N = \\frac{1}{1 + \\exp\\left(-\\frac{\\Delta G}{RT}\\right)} $$\n该方程在形式上类似于费米-狄拉克分布。\n\n问题陈述指出，$\\Delta G$ 与变性剂浓度 $[D]$ 存在经验性的线性依赖关系：\n$$ \\Delta G([D]) = \\Delta G_{\\mathrm{H_2O}} - m[D] $$\n此处，$\\Delta G_{\\mathrm{H_2O}}$ 是在纯水中（$[D]=0$）的去折叠吉布斯自由能，而 $m$ 值量化了 $\\Delta G$ 对变性剂浓度的敏感性。将此线性关系代入我们的 $f_N$ 表达式中，得到最终的正向模型：\n$$ f_N([D]; \\Delta G_{\\mathrm{H_2O}}, m) = \\frac{1}{1 + \\exp\\left(-\\frac{\\Delta G_{\\mathrm{H_2O}} - m[D]}{RT}\\right)} $$\n给定参数 $\\theta = (\\Delta G_{\\mathrm{H_2O}}, m)$，该模型可以预测在任意给定变性剂浓度下天然蛋白质的比例。\n\n接下来，我们构建非线性最小二乘（NLLS）问题，以从一组 $n$ 个实验数据点 $([D_i], f_{N,i}^{\\text{obs}})$ 中估计参数 $\\theta$。目标是找到使观测数据与模型预测之间的残差平方和（RSS）最小化的参数值。第 $i$ 个数据点的残差为：\n$$ r_i(\\theta) = f_{N,i}^{\\text{obs}} - f_N([D_i]; \\theta) $$\n要最小化的目标函数是 RSS：\n$$ \\text{RSS}(\\theta) = \\sum_{i=1}^n r_i(\\theta)^2 $$\n优化的执行遵循具有物理意义的约束条件 $m \\ge 0$，因为变性剂预计会破坏天然状态的稳定性，从而降低 $\\Delta G$。\n\n最后，我们处理参数不确定度的估计。对于非线性模型，不确定度可以通过在最优参数集 $\\hat{\\theta}$ 周围进行线性误差传播来近似。该方法依赖于在最优点处计算的残差的雅可比矩阵 $J$。雅可比矩阵的元素由下式给出：\n$$ J_{ij} = \\frac{\\partial r_i}{\\partial \\theta_j} \\bigg|_{\\theta=\\hat{\\theta}} $$\n模型参数的数量为 $p=2$。测量误差的方差由最小化的 RSS 估计得出：\n$$ \\hat{\\sigma}^2 = \\frac{\\text{RSS}(\\hat{\\theta})}{n - p} $$\n其中 $n-p$ 是自由度。参数协方差矩阵 $C$ 则近似为：\n$$ C = \\hat{\\sigma}^2 (J^\\top J)^{-1} $$\n为增强对数值不稳定性的鲁棒性，特别是在 $J^\\top J$ 是病态矩阵时（如果数据不足以充分约束所有参数，就可能发生这种情况），使用 Moore-Penrose 伪逆 $(J^\\top J)^+$ 代替标准逆。\n$$ C = \\hat{\\sigma}^2 (J^\\top J)^+ $$\n估计参数的标准误差（不确定度）是协方差矩阵对角线元素的平方根：\n$$ s_{\\theta_j} = \\sqrt{C_{jj}} $$\n具体来说，$s_{\\Delta G_{\\mathrm{H_2O}}} = \\sqrt{C_{11}}$ 且 $s_m = \\sqrt{C_{22}}$。\n\n该实现将利用 `scipy.optimize.least_squares` 函数来执行 NLLS 拟合。此函数方便地提供了最优参数和解处的雅可比矩阵，然后用它们来计算前述的协方差矩阵和标准误差。在整个计算过程中使用常数 $T = 298.15 \\, \\mathrm{K}$ 和 $R = 0.008314462618 \\, \\mathrm{kJ/(mol\\cdot K)}$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom scipy.linalg import pinv\n\ndef solve():\n    \"\"\"\n    Fits a two-state protein folding model to denaturation data and calculates parameter uncertainties.\n    \"\"\"\n    # Define constants as specified in the problem\n    T_K = 298.15  # Temperature in Kelvin\n    R_KJ_MOL_K = 0.008314462618  # Gas constant in kJ/(mol*K)\n    RT = R_KJ_MOL_K * T_K\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Case A (broad transition)\n        (np.array([0.0, 1.0, 2.0, 3.0, 4.0, 4.5, 5.0, 6.0, 7.0]),\n         np.array([0.999, 0.999, 0.995, 0.946, 0.600, 0.310, 0.118, 0.012, 0.001])),\n\n        # Case B (mid-transition region)\n        (np.array([0.0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0]),\n         np.array([0.885, 0.835, 0.770, 0.690, 0.600, 0.500, 0.400])),\n        \n        # Case C (partially uninformative, sharp drop)\n        (np.array([0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0]),\n         np.array([1.000, 1.000, 1.000, 0.983, 0.500, 0.017, 0.000]))\n    ]\n    \n    all_results = []\n\n    for D_M, fN_obs in test_cases:\n        \n        def two_state_model(params, D):\n            \"\"\"\n            Calculates the fraction of native protein based on the two-state model.\n            params[0]: dG_H2O (in kJ/mol)\n            params[1]: m (in kJ/mol/M)\n            \"\"\"\n            dG_H2O, m_val = params\n            delta_G = dG_H2O - m_val * D\n            arg_exp = -delta_G / RT\n            # Use np.exp for vectorized operations\n            return 1.0 / (1.0 + np.exp(arg_exp))\n\n        def residuals(params, D, fN_obs):\n            \"\"\"\n            Calculates the residuals between observed and predicted fN.\n            \"\"\"\n            fN_pred = two_state_model(params, D)\n            return fN_obs - fN_pred\n\n        # Initial guess for parameters [dG_H2O, m].\n        # A positive dG_H2O indicates a stable native state at [D]=0.\n        # An m-value represents the slope of the transition.\n        x0 = np.array([10.0, 5.0]) \n\n        # Bounds for parameters: m must be non-negative.\n        bounds = ([-np.inf, 0], [np.inf, np.inf])\n\n        # Perform the non-linear least squares fit. 'trf' is a good choice for bounds.\n        fit_result = least_squares(residuals, x0, args=(D_M, fN_obs), bounds=bounds, method='trf')\n        \n        # Optimal parameters\n        dG_H2O_fit, m_fit = fit_result.x\n        \n        # Number of data points and parameters\n        n_points = len(D_M)\n        p_params = 2\n        \n        # Degrees of freedom must be positive to estimate variance\n        if n_points = p_params:\n            s_dG, s_m = np.nan, np.nan\n        else:\n            # Calculate residual sum of squares (RSS)\n            # fit_result.cost is 0.5 * sum(residuals**2)\n            rss = 2 * fit_result.cost\n            \n            # Estimate variance of the error\n            sigma_sq = rss / (n_points - p_params)\n            \n            # Jacobian matrix at the solution\n            J = fit_result.jac\n            \n            # Calculate parameter covariance matrix\n            try:\n                # Use Moore-Penrose pseudoinverse for numerical stability\n                jtj_inv = pinv(J.T @ J)\n                cov_matrix = sigma_sq * jtj_inv\n                \n                # Standard errors are the sqrt of the diagonal elements\n                # Ensure diagonal elements are non-negative before taking sqrt\n                diag_cov = np.diag(cov_matrix)\n                if np.any(diag_cov  0):\n                    # Should not happen with real data and a decent fit.\n                    # This indicates a severe numerical issue or a very poor model.\n                    std_errors = np.array([np.nan, np.nan])\n                else:\n                    std_errors = np.sqrt(diag_cov)\n                \n                s_dG, s_m = std_errors\n            except np.linalg.LinAlgError:\n                # Fallback in case of a singular matrix that pinv can't handle\n                s_dG, s_m = np.nan, np.nan\n\n        case_results = [\n            round(dG_H2O_fit, 3),\n            round(m_fit, 3),\n            round(s_dG, 3),\n            round(s_m, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    # map(str, all_results) will convert each inner list to its string representation\n    # e.g., '[1.234, 5.678, ...]'\n    output_str = f\"[{','.join(map(str, all_results))}]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "2765810"}, {"introduction": "除了稳定性，我们还想知道蛋白质是*如何*折叠的，即其折叠路径是怎样的。$\\phi$值分析是一种强大的蛋白质工程技术，由 Alan Fersht 等人开创，用于探测折叠过渡态的结构。在本练习中，你将根据定点突变的动力学数据计算$\\phi$值，并用它们来识别“折叠核”——那些在折叠过程中最早形成稳定相互作用的关键残基，从而为我们提供一幅关于折叠瓶颈的分子快照[@problem_id:2765799]。", "problem": "在一个旨在设计折叠鲁棒性的合成生物学项目中，您正在分析一个通过双态机制折叠的小单域蛋白质。您在等温条件下进行经典的过渡态理论（TST）分析，并量化六种丙氨酸到甘氨酸的点突变（每个位点一个）相对于野生型对折叠和去折叠速率的影响。假设以下基础：(i) 经典过渡态理论，其中透射系数为常数，因此相对速率的变化反映了活化自由能的变化；(ii) 双态折叠机制，其中平衡稳定性由折叠和去折叠速率的比率决定。温度是固定的，并且对于所有测量都是相同的，野生型速率用 $k_{f}^{\\mathrm{WT}}$ 和 $k_{u}^{\\mathrm{WT}}$ 表示。对于每个突变 $i \\in \\{1,2,3,4,5,6\\}$，观察到的速率变化以相对于相同温度下野生型的倍数变化因子给出：\n- 突变 $1$：$k_{f}^{(1)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.2)$，$k_{u}^{(1)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.8)$\n- 突变 $2$：$k_{f}^{(2)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-1.0)$，$k_{u}^{(2)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.5)$\n- 突变 $3$：$k_{f}^{(3)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.8)$，$k_{u}^{(3)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.2)$\n- 突变 $4$：$k_{f}^{(4)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.6)$，$k_{u}^{(4)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.3)$\n- 突变 $5$：$k_{f}^{(5)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.1)$，$k_{u}^{(5)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.9)$\n- 突变 $6$：$k_{f}^{(6)} = k_{f}^{\\mathrm{WT}} \\,\\exp(-0.3)$，$k_{u}^{(6)} = k_{u}^{\\mathrm{WT}} \\,\\exp(0.9)$\n\n此处 $\\exp(\\cdot)$ 表示指数函数，所有速率常数都在相同温度下，因此过渡态理论中的指前因子在比率中被消掉。将突变 $i$ 的 $\\phi$ 值定义为由突变引起的折叠活化自由能变化与由突变引起的平衡稳定性（天然态自由能）变化之比，两者均以 $RT$ 为单位，其中 $R$ 是通用气体常数， $T$ 是绝对温度。\n\n您还获得一个天然态残基-残基接触图，其顶点是六个突变位点 $\\{1,2,3,4,5,6\\}$，其无向边表示在天然结构中 $5 \\,\\mathrm{\\AA}$ 截断距离内的侧链接触。边为：\n- $\\{1,2\\}$, $\\{2,3\\}$, $\\{3,4\\}$, $\\{4,5\\}$, $\\{5,6\\}$, $\\{2,4\\}$\n\n定义一个 $\\phi$ 阈值 $\\theta = 0.5$。折叠核在操作上定义为在 $\\phi \\ge \\theta$ 的残基集合上的诱导子图的最大连通分量。\n\n仅使用上述基础和数据，计算六个突变的 $\\phi$ 值，构建阈值 $\\theta$ 下的诱导子图，并确定折叠核的大小（残基数）。仅报告此大小作为您的最终答案。无需四舍五入，最终答案应为不带单位的整数。", "solution": "问题要求根据一系列点突变的动力学数据确定蛋白质折叠核的大小。该分析必须基于经典过渡态理论（TST）和 $\\phi$ 值分析的原理。\n\n首先，我们必须将给定的速率常数与相关的热力学量之间的关系形式化。根据TST，对于活化自由能为 $\\Delta G^{\\ddagger}$ 的反应，在温度 $T$ 下的速率常数 $k$ 由下式给出：\n$$ k = \\kappa \\frac{k_B T}{h} \\exp\\left(-\\frac{\\Delta G^{\\ddagger}}{RT}\\right) $$\n其中 $\\kappa$ 是透射系数， $k_B$ 是玻尔兹曼常数， $h$ 是普朗克常数。问题陈述 $\\kappa$ 是常数，且所有测量都在相同的温度 $T$ 下进行。对于突变 $i$，突变体速率常数 $k^{(i)}$ 与野生型速率常数 $k^{\\mathrm{WT}}$ 的比值为：\n$$ \\frac{k^{(i)}}{k^{\\mathrm{WT}}} = \\frac{\\exp\\left(-\\frac{\\Delta G^{\\ddagger, (i)}}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G^{\\ddagger, \\mathrm{WT}}}{RT}\\right)} = \\exp\\left(-\\frac{\\Delta G^{\\ddagger, (i)} - \\Delta G^{\\ddagger, \\mathrm{WT}}}{RT}\\right) = \\exp\\left(-\\frac{\\Delta \\Delta G^{\\ddagger, (i)}}{RT}\\right) $$\n此处，$\\Delta \\Delta G^{\\ddagger, (i)}$ 表示由突变 $i$ 引起的活化自由能的变化。取自然对数可得到以 $RT$ 为单位的活化自由能变化：\n$$ \\frac{\\Delta \\Delta G^{\\ddagger, (i)}}{RT} = -\\ln\\left(\\frac{k^{(i)}}{k^{\\mathrm{WT}}}\\right) $$\n该关系适用于折叠 ($k_f$) 和去折叠 ($k_u$) 过程，及其各自的活化自由能 $\\Delta G_f^{\\ddagger}$ 和 $\\Delta G_u^{\\ddagger}$。\n\n问题将突变 $i$ 的 $\\phi$ 值定义为折叠活化自由能的变化与折叠平衡自由能（稳定性）$\\Delta G_{N-U}$ 的变化之比：\n$$ \\phi_i = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}}{\\Delta \\Delta G_{N-U,i}} $$\n稳定性的变化 $\\Delta \\Delta G_{N-U,i}$ 可与活化能的变化相关联。折叠自由能为 $\\Delta G_{N-U} = G_N - G_U$。活化能垒是从去折叠态 $U$ 和天然态 $N$ 到过渡态 $TS$ 定义的：$\\Delta G_f^{\\ddagger} = G_{TS} - G_U$ 和 $\\Delta G_u^{\\ddagger} = G_{TS} - G_N$。根据这些定义，可以得出 $\\Delta G_{N-U} = \\Delta G_f^{\\ddagger} - \\Delta G_u^{\\ddagger}$。突变后该量的变化为：\n$$ \\Delta \\Delta G_{N-U,i} = \\Delta \\Delta G_{f,i}^{\\ddagger} - \\Delta \\Delta G_{u,i}^{\\ddagger} $$\n因此，以 $RT$ 为单位表示的 $\\phi$ 值为：\n$$ \\phi_i = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT}{\\Delta \\Delta G_{N-U,i}/RT} = \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT}{\\Delta \\Delta G_{f,i}^{\\ddagger}/RT - \\Delta \\Delta G_{u,i}^{\\ddagger}/RT} $$\n使用从TST导出的关系：\n$$ \\frac{\\Delta \\Delta G_{f,i}^{\\ddagger}}{RT} = -\\ln\\left(\\frac{k_f^{(i)}}{k_f^{\\mathrm{WT}}}\\right) \\quad \\text{和} \\quad \\frac{\\Delta \\Delta G_{u,i}^{\\ddagger}}{RT} = -\\ln\\left(\\frac{k_u^{(i)}}{k_u^{\\mathrm{WT}}}\\right) $$\n问题直接在指数项中提供了 $\\ln(k_f^{(i)}/k_f^{\\mathrm{WT}})$ 和 $\\ln(k_u^{(i)}/k_u^{\\mathrm{WT}})$ 的值。让这些值分别用 $X_i$ 和 $Y_i$ 表示。因此，$k_f^{(i)}/k_f^{\\mathrm{WT}} = \\exp(X_i)$ 和 $k_u^{(i)}/k_u^{\\mathrm{WT}} = \\exp(Y_i)$。\n那么，$\\Delta \\Delta G_{f,i}^{\\ddagger}/RT = -X_i$ 和 $\\Delta \\Delta G_{u,i}^{\\ddagger}/RT = -Y_i$。将这些代入 $\\phi_i$ 的表达式中可得：\n$$ \\phi_i = \\frac{-X_i}{-X_i - (-Y_i)} = \\frac{-X_i}{Y_i - X_i} $$\n我们现在计算这6个突变中每一个的 $\\phi$ 值。\n\n- **突变 1:** $X_1 = -0.2$, $Y_1 = 0.8$。\n  $$ \\phi_1 = \\frac{-(-0.2)}{0.8 - (-0.2)} = \\frac{0.2}{1.0} = 0.2 $$\n- **突变 2:** $X_2 = -1.0$, $Y_2 = 0.5$。\n  $$ \\phi_2 = \\frac{-(-1.0)}{0.5 - (-1.0)} = \\frac{1.0}{1.5} = \\frac{2}{3} $$\n- **突变 3:** $X_3 = -0.8$, $Y_3 = 0.2$。\n  $$ \\phi_3 = \\frac{-(-0.8)}{0.2 - (-0.8)} = \\frac{0.8}{1.0} = 0.8 $$\n- **突变 4:** $X_4 = -0.6$, $Y_4 = 0.3$。\n  $$ \\phi_4 = \\frac{-(-0.6)}{0.3 - (-0.6)} = \\frac{0.6}{0.9} = \\frac{2}{3} $$\n- **突变 5:** $X_5 = -0.1$, $Y_5 = 0.9$。\n  $$ \\phi_5 = \\frac{-(-0.1)}{0.9 - (-0.1)} = \\frac{0.1}{1.0} = 0.1 $$\n- **突变 6:** $X_6 = -0.3$, $Y_6 = 0.9$。\n  $$ \\phi_6 = \\frac{-(-0.3)}{0.9 - (-0.3)} = \\frac{0.3}{1.2} = \\frac{1}{4} = 0.25 $$\n\n折叠核是基于 $\\phi$ 阈值 $\\theta = 0.5$ 定义的。构成折叠核的残基是那些 $\\phi_i \\ge \\theta$ 的残基。我们对每个残基评估此条件：\n- $\\phi_1 = 0.2  0.5$\n- $\\phi_2 = 2/3 \\approx 0.667 \\ge 0.5$\n- $\\phi_3 = 0.8 \\ge 0.5$\n- $\\phi_4 = 2/3 \\approx 0.667 \\ge 0.5$\n- $\\phi_5 = 0.1  0.5$\n- $\\phi_6 = 0.25  0.5$\n\n$\\phi$ 值大于或等于阈值的残基集合是 $S = \\{2, 3, 4\\}$。\n折叠核是在此集合 $S$ 上的诱导子图的最大连通分量。原始残基接触图的顶点为 $V = \\{1, 2, 3, 4, 5, 6\\}$，边为 $E = \\{\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,5\\}, \\{5,6\\}, \\{2,4\\}\\}$。\n诱导子图 $G[S]$ 包含顶点 $S = \\{2, 3, 4\\}$ 以及所有连接 $S$ 内部顶点对的来自 $E$ 的边。我们检查边集 $E$：\n- 边 $\\{2,3\\}$ 连接 $S$ 中的两个顶点。它被包括在内。\n- 边 $\\{3,4\\}$ 连接 $S$ 中的两个顶点。它被包括在内。\n- 边 $\\{2,4\\}$ 连接 $S$ 中的两个顶点。它被包括在内。\n- $E$ 中的所有其他边至少有一个顶点不在 $S$ 中，因此被排除。\n\n$S$ 上的诱导子图由顶点 $\\{2, 3, 4\\}$ 和边 $\\{\\{2,3\\}, \\{3,4\\}, \\{2,4\\}\\}$ 组成。在此子图中，每个顶点都通过一条边与其他所有顶点相连。因此，所有三个顶点都属于一个单一的连通分量。\n这个分量的大小是它包含的顶点数，即 $3$。这是唯一的连通分量，因此也是最大的。\n折叠核的大小是 $3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "2765799"}, {"introduction": "在拥挤的细胞环境中，蛋白质折叠并非孤立发生；分子伴侣在防止错误折叠和聚集方面扮演着至关重要的角色。本练习将构建一个经典的Hsp70分子伴侣循环的动力学模型，以量化其工作效率。通过计算客户蛋白聚集速率的降低程度，你将把分子伴侣结合和核苷酸循环的微观动力学与一项关键的宏观细胞功能联系起来[@problem_id:2765789]。", "problem": "一个底物多肽在其折叠周期中会瞬时结合到热休克蛋白70 (Hsp70)上。在每个结合周期中，底物在被释放前会经历该分子伴侣的两个连续的核苷酸状态：先是三磷酸腺苷 (ATP) 结合态，然后是二磷酸腺苷 (ADP) 结合态。您测得底物与Hsp70结合时，在每种状态下的平均停留时间分别为 $ \\tau_{\\mathrm{ATP}} = 0.60\\,\\text{s}$ 和 $ \\tau_{\\mathrm{ADP}} = 9.0\\,\\text{s}$。游离Hsp70的核苷酸循环是一个两态过程，其中ATP到ADP的转化（水解）速率为 $k_{\\mathrm{hyd}} = 1.20\\,\\text{s}^{-1}$，ADP到ATP的核苷酸交换速率为 $k_{\\mathrm{exch}} = 0.30\\,\\text{s}^{-1}$。游离Hsp70的总浓度为 $C_{\\mathrm{tot}} = 5.0\\,\\mu\\text{M}$，底物与ATP结合态Hsp70的结合（二级）速率常数为 $k_{\\mathrm{on}} = 1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$。未受保护的底物以泊松过程发生聚集，其基线速率为 $k_{\\mathrm{agg}}^{0} = 1.00 \\times 10^{-2}\\,\\text{s}^{-1}$。\n\n假设：\n- 游离Hsp70的核苷酸状态构成一个两态连续时间马尔可夫链，其稳态流由给定的相互转化速率决定。\n- 底物仅通过与ATP结合态的Hsp70结合而被捕获；因此，每个未结合底物的瞬时结合速率等于 $k_{\\mathrm{on}}$ 乘以稳态下ATP-Hsp70的浓度。\n- 底物被捕获前的未结合等待时间呈指数分布，其均值等于捕获速率的倒数（泊松到达）。\n- 在一次结合事件中，ATP和ADP阶段顺序发生，因此每次事件的平均结合持续时间是ATP和ADP平均停留时间之和。\n- 当底物与Hsp70结合时，聚集核心的形成被阻断；因此，有效聚集速率等于基线速率乘以底物处于未结合状态的长时间分数。\n\n从这些原理出发，仅使用第一性原理推断（例如，两态马尔可夫链中的稳态平衡、结合的质量作用定律、泊松/指数等待时间性质以及更新过程的时间分数论证），计算在分子伴侣作用下，单个底物分子在稳态时的有效聚集速率 $k_{\\mathrm{agg,eff}}$。将 $k_{\\mathrm{agg,eff}}$ 以 $\\text{s}^{-1}$ 为单位表示，并将最终答案四舍五入至三位有效数字。最终答案必须是一个数字。", "solution": "该问题是有效的，因为它具有科学依据、良定且客观。它提出了一个简化但标准的分子伴侣-底物相互作用的生物物理模型，提供了所有必要的参数和一致的假设，并要求计算一个可计算的量。我现在开始解答。\n\n目标是计算在Hsp70分子伴侣系统作用下，一个底物多肽的有效聚集速率 $k_{\\mathrm{agg,eff}}$。根据问题的第五个假设，当底物与Hsp70结合时，聚集被阻断。因此，有效聚集速率是基线聚集速率 $k_{\\mathrm{agg}}^{0}$ 乘以底物处于未结合状态的时间分数 $P_{\\mathrm{unbound}}$。\n$$k_{\\mathrm{agg,eff}} = k_{\\mathrm{agg}}^{0} \\times P_{\\mathrm{unbound}}$$\n底物的状态在未结合与和Hsp70结合之间交替。这构成了一个更新过程。对于这样的过程，在某一特定状态下花费的长时间分数是该状态的平均持续时间与平均总周期时间的比值。\n$$P_{\\mathrm{unbound}} = \\frac{\\langle T_{\\mathrm{unbound}} \\rangle}{\\langle T_{\\mathrm{unbound}} \\rangle + \\langle T_{\\mathrm{bound}} \\rangle}$$\n这里，$\\langle T_{\\mathrm{unbound}} \\rangle$ 是底物在单个周期内未结合的平均时间，$\\langle T_{\\mathrm{bound}} \\rangle$ 是底物与Hsp70结合的平均时间。\n\n首先，我们计算平均结合时间 $\\langle T_{\\mathrm{bound}} \\rangle$。问题指出，一次结合事件包括两个连续的阶段：ATP结合阶段和ADP结合阶段。一次完整结合事件的平均持续时间是每个状态下平均停留时间的总和。\n$$\\langle T_{\\mathrm{bound}} \\rangle = \\tau_{\\mathrm{ATP}} + \\tau_{\\mathrm{ADP}}$$\n使用给定的值 $\\tau_{\\mathrm{ATP}} = 0.60\\,\\text{s}$ 和 $\\tau_{\\mathrm{ADP}} = 9.0\\,\\text{s}$：\n$$\\langle T_{\\mathrm{bound}} \\rangle = 0.60\\,\\text{s} + 9.0\\,\\text{s} = 9.6\\,\\text{s}$$\n\n接下来，我们计算平均未结合时间 $\\langle T_{\\mathrm{unbound}} \\rangle$。根据假设，捕获未结合底物是一个泊松过程。泊松过程中事件的平均等待时间是其速率的倒数。捕获速率 $\\lambda_{\\text{capture}}$ 由质量作用定律给出：它是二级结合速率常数 $k_{\\mathrm{on}}$ 与可用于结合的物质（即与ATP结合的Hsp70，记为 $[H_{ATP}]$）的浓度的乘积。\n$$\\langle T_{\\mathrm{unbound}} \\rangle = \\frac{1}{\\lambda_{\\text{capture}}} = \\frac{1}{k_{\\mathrm{on}} [H_{ATP}]}$$\n\n为了求得 $[H_{ATP}]$，我们必须确定游离Hsp70核苷酸状态的稳态浓度。问题将游离Hsp70的核苷酸循环描述为一个涉及ATP结合态Hsp70 ($H_{ATP}$) 和ADP结合态Hsp70 ($H_{ADP}$) 的两态连续时间马尔可夫过程。\n$$H_{ATP} \\underset{k_{\\mathrm{exch}}}{\\stackrel{k_{\\mathrm{hyd}}}{\\rightleftharpoons}} H_{ADP}$$\n在稳态下，从ATP状态到ADP状态的流必须与从ADP状态到ATP状态的流相平衡。\n$$k_{\\mathrm{hyd}} [H_{ATP}] = k_{\\mathrm{exch}} [H_{ADP}]$$\n此外，两种状态的浓度之和等于游离Hsp70的总浓度 $C_{\\mathrm{tot}}$。\n$$[H_{ATP}] + [H_{ADP}] = C_{\\mathrm{tot}}$$\n我们可以求解这个二元线性方程组。由第二个方程，我们得到 $[H_{ADP}] = C_{\\mathrm{tot}} - [H_{ATP}]$，并将其代入第一个方程：\n$$k_{\\mathrm{hyd}} [H_{ATP}] = k_{\\mathrm{exch}} (C_{\\mathrm{tot}} - [H_{ATP}])$$\n求解 $[H_{ATP}]$：\n$$k_{\\mathrm{hyd}} [H_{ATP}] + k_{\\mathrm{exch}} [H_{ATP}] = k_{\\mathrm{exch}} C_{\\mathrm{tot}}$$\n$$[H_{ATP}] (k_{\\mathrm{hyd}} + k_{\\mathrm{exch}}) = k_{\\mathrm{exch}} C_{\\mathrm{tot}}$$\n$$[H_{ATP}] = C_{\\mathrm{tot}} \\frac{k_{\\mathrm{exch}}}{k_{\\mathrm{hyd}} + k_{\\mathrm{exch}}}$$\n现在，我们代入给定的数值：$C_{\\mathrm{tot}} = 5.0\\,\\mu\\text{M} = 5.0 \\times 10^{-6}\\,\\text{M}$，$k_{\\mathrm{exch}} = 0.30\\,\\text{s}^{-1}$，以及 $k_{\\mathrm{hyd}} = 1.20\\,\\text{s}^{-1}$。\n$$[H_{ATP}] = (5.0 \\times 10^{-6}\\,\\text{M}) \\frac{0.30\\,\\text{s}^{-1}}{1.20\\,\\text{s}^{-1} + 0.30\\,\\text{s}^{-1}} = (5.0 \\times 10^{-6}\\,\\text{M}) \\frac{0.30}{1.50} = (5.0 \\times 10^{-6}\\,\\text{M}) \\times 0.2 = 1.0 \\times 10^{-6}\\,\\text{M}$$\n\n利用ATP结合态Hsp70的浓度，我们可以使用 $k_{\\mathrm{on}} = 1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}$ 计算捕获速率 $\\lambda_{\\text{capture}}$。\n$$\\lambda_{\\text{capture}} = k_{\\mathrm{on}} [H_{ATP}] = (1.0 \\times 10^{6}\\,\\text{M}^{-1}\\text{s}^{-1}) \\times (1.0 \\times 10^{-6}\\,\\text{M}) = 1.0\\,\\text{s}^{-1}$$\n平均未结合时间是该速率的倒数：\n$$\\langle T_{\\mathrm{unbound}} \\rangle = \\frac{1}{\\lambda_{\\text{capture}}} = \\frac{1}{1.0\\,\\text{s}^{-1}} = 1.0\\,\\text{s}$$\n\n现在我们得到了两个平均时间：$\\langle T_{\\mathrm{unbound}} \\rangle = 1.0\\,\\text{s}$ 和 $\\langle T_{\\mathrm{bound}} \\rangle = 9.6\\,\\text{s}$。我们可以计算底物处于未结合状态的时间分数：\n$$P_{\\mathrm{unbound}} = \\frac{\\langle T_{\\mathrm{unbound}} \\rangle}{\\langle T_{\\mathrm{unbound}} \\rangle + \\langle T_{\\mathrm{bound}} \\rangle} = \\frac{1.0\\,\\text{s}}{1.0\\,\\text{s} + 9.6\\,\\text{s}} = \\frac{1.0}{10.6}$$\n\n最后，我们使用基线速率 $k_{\\mathrm{agg}}^{0} = 1.00 \\times 10^{-2}\\,\\text{s}^{-1}$ 来计算有效聚集速率 $k_{\\mathrm{agg,eff}}$。\n$$k_{\\mathrm{agg,eff}} = k_{\\mathrm{agg}}^{0} \\times P_{\\mathrm{unbound}} = (1.00 \\times 10^{-2}\\,\\text{s}^{-1}) \\times \\frac{1.0}{10.6} \\approx 9.43396 \\times 10^{-4}\\,\\text{s}^{-1}$$\n将结果四舍五入到三位有效数字，我们得到 $9.43 \\times 10^{-4}\\,\\text{s}^{-1}$。", "answer": "$$\\boxed{9.43 \\times 10^{-4}}$$", "id": "2765789"}]}