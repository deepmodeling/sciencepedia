{"hands_on_practices": [{"introduction": "在实验微生物学中，将真实信号与背景噪声区分开是数据分析的首要关键步骤。在通过广义转导测量基因转移时，我们期望的信号是成功转导的细胞形成的菌落，但自发突变也可能产生外观相同的菌落，从而构成噪声。此练习 [@problem_id:2477884] 将指导您完成校正观测转导频率的基本计算，这是一项确保实验结论准确性和有效性的核心技能。", "problem": "一种广义转导噬菌体将一个抗生素抗性决定簇从供体转移到细菌受体。经过吸附和中和后，通过在非选择性琼脂上铺板测定，感染混合物中活体受体菌的浓度为 $1.5 \\times 10^{9}$ 个细胞/毫升。然后，您将体积为 $0.100$ 毫升的该混合物铺在含有抗生素的选择性琼脂上，这样只有抗生素抗性细胞才能形成菌落。您在该平板上观察到 $112$ 个抗性菌落。\n\n在相同的生长条件下（未添加噬菌体），独立测得的该基因型的自发抗性频率为 $\\mu = 2.0 \\times 10^{-8}$ 个自发抗性细胞/每个铺板的活体受体菌。假设在吸附和铺板期间没有细胞分裂，转导子和自发突变体在选择性琼脂上的存活性没有差异，并且所用的噬菌体支持广义转导（即，没有位点特异性的包装偏好）。将 $\\mu$ 视为铺板时每个细胞的概率。\n\n仅使用菌落形成单位的定义、独立事件的概率，以及观察到的抗性菌落等于真实转导子和自发突变体之和这一概念分解，通过减去预期的自发背景，从第一性原理推导出每个铺板受体细胞的校正转导频率。请用小数表示最终答案，并四舍五入到 $4$ 位有效数字。最终答案是无量纲的；不要包含单位。", "solution": "该问题要求从第一性原理推导校正后的转导频率，同时要考虑到自发突变的背景。\n\n首先，我们必须严格定义所涉及的量。\n设 $C_R$ 为活体受体细胞的浓度，给定值为 $1.5 \\times 10^{9}$ 个细胞/毫升。\n设 $V$ 为铺在选择性培养基上的细胞混合物的体积，给定值为 $0.100$ 毫升。\n铺板的活体受体细胞总数 $N_{plated}$ 是浓度和体积的乘积：\n$$N_{plated} = C_R \\times V$$\n代入给定值：\n$$N_{plated} = (1.5 \\times 10^{9} \\text{ cells/mL}) \\times (0.100 \\text{ mL}) = 1.5 \\times 10^{8} \\text{ cells}$$\n\n设 $N_{obs}$ 为在选择性平板上观察到的抗性菌落总数，给定值为 $112$。这些菌落来源于两个不同且独立的来源：真实的转导事件和自发突变事件。\n设 $N_T$ 为由真实转导事件产生的菌落数（转导子）。\n设 $N_S$ 为由自发突变产生的菌落数。\n\n问题指出，观察到的菌落是这两个群体之和。这是一个合理的近似，因为单个细胞既是转导子又是自发突变体的概率是两个非常小的概率的乘积，因此可以忽略不计。\n$$N_{obs} = N_T + N_S$$\n\n频率定义为群体中每个成员发生的事件数。我们可以定义以下频率：\n观察到的抗性频率 $F_{obs}$ 是每个铺板受体细胞产生的抗性菌落总数：\n$$F_{obs} = \\frac{N_{obs}}{N_{plated}}$$\n校正的或真实的转导频率 $F_T$ 是每个铺板受体细胞产生的转导子菌落数：\n$$F_T = \\frac{N_T}{N_{plated}}$$\n自发突变频率 $\\mu$ 被给定为细胞自发产生抗性的概率，这等同于每个铺板受体细胞产生的自发突变菌落数：\n$$\\mu = \\frac{N_S}{N_{plated}} = 2.0 \\times 10^{-8}$$\n\n为了推导 $F_T$ 的关系式，我们从菌落计数的分解开始，并除以铺板的细胞总数 $N_{plated}$：\n$$\\frac{N_{obs}}{N_{plated}} = \\frac{N_T}{N_{plated}} + \\frac{N_S}{N_{plated}}$$\n代入频率的定义，我们得到基本关系式：\n$$F_{obs} = F_T + \\mu$$\n目标是求出校正后的转导频率 $F_T$。我们重排方程以求解 $F_T$：\n$$F_T = F_{obs} - \\mu$$\n\n现在，我们可以代入实验数据来计算数值。\n首先，我们计算观察到的频率 $F_{obs}$：\n$$F_{obs} = \\frac{N_{obs}}{N_{plated}} = \\frac{112}{1.5 \\times 10^{8}}$$\n现在，我们将这个表达式和给定的 $\\mu$ 值代入 $F_T$ 的方程中：\n$$F_T = \\frac{112}{1.5 \\times 10^{8}} - 2.0 \\times 10^{-8}$$\n为了进行减法运算，我们可以将两项表示为相同的 $10$ 的幂次方：\n$$F_T = \\left(\\frac{112}{1.5}\\right) \\times 10^{-8} - 2.0 \\times 10^{-8}$$\n计算该分数：\n$$\\frac{112}{1.5} = \\frac{112}{3/2} = \\frac{224}{3} \\approx 74.666...$$\n因此，方程变为：\n$$F_T = (74.666... - 2.0) \\times 10^{-8} = 72.666... \\times 10^{-8}$$\n为了用标准科学记数法表示，我们调整小数点和指数：\n$$F_T = 7.2666... \\times 10^{-7}$$\n问题要求答案四舍五入到 $4$ 位有效数字。第五位有效数字是 $6$，所以我们将第四位数字向上取整。\n$$F_T \\approx 7.267 \\times 10^{-7}$$\n这是每个铺板受体细胞的校正转导频率，是一个无量纲的量，表示导致抗性菌落的成功转导事件的概率。", "answer": "$$\\boxed{7.267 \\times 10^{-7}}$$", "id": "2477884"}, {"introduction": "一旦我们能够准确测量转导事件，下一步自然是优化实验条件以获得最佳结果。任何噬菌体实验中的一个关键参数是感染复数（$m$，MOI），它在此处带来了一个关键的权衡：更多的噬菌体增加了基因递送的几率，但也增加了裂解性噬菌体杀死宿主细胞的风险。此练习 [@problem_id:2477931] 深入探讨了这一权衡，利用概率模型来推导能最大化存活转导子产量的最佳MOI，展示了数学方法如何为实验室工作提供强大的实践指导。", "problem": "在一项使用严格裂解性噬菌体的广义转导实验中，供体来源的噬菌体颗粒分为两类：携带病毒基因组并在增殖性感染后引起裂解的标准裂解颗粒，以及携带宿主DNA片段且不会引起增殖性裂解的转导颗粒。设所有颗粒中转导颗粒的比例为 $f_{t} \\in (0,1)$，并假设转导颗粒和裂解颗粒通过随机碰撞独立吸附到受体上，该过程可由泊松过程很好地近似。感染复数（MOI），定义为每个受体细胞平均吸附的总颗粒数，为 $m > 0$。假设以下机理事实和定义为基本依据：\n\n- 吸附事件是独立的，每个细胞吸附的裂解颗粒和转导颗粒的数量是独立的泊松随机变量，其均值分别为 $m(1 - f_{t})$ 和 $m f_{t}$。\n- 接收到至少一个裂解颗粒的受体细胞会发生致死性裂解，无法产生有活力的转导子。\n- 在接收到恰好 $n \\geq 0$ 个转导颗粒且没有裂解颗粒的条件下，细胞的存活概率为 $s^{n}$，其中 $s \\in (0,1]$，这反映了每次独立进入的转导颗粒所带来的细胞毒性风险是相乘的。\n- 在接收到恰好 $n \\geq 0$ 个转导颗粒且没有裂解颗粒的条件下，同源重组成功将供体等位基因整合到受体染色体中的概率为 $1 - (1 - r)^{n}$，其中 $r \\in (0,1]$，假设每个颗粒有独立的重组机会。\n\n因此，在上述假设下，成为有活力的转导子的受体细胞的期望比例由 $m$、$f_{t}$、$s$ 和 $r$ 决定。\n\n从这些假设出发，不使用任何未经证明的简化公式，推导出使每个受体细胞中有活力的转导子期望比例最大化的 MOI 值 $m^{\\star}$ 的闭式解析表达式，该表达式是 $f_{t}$、$s$ 和 $r$ 的函数。将最终答案表示为 $m^{\\star}$ 的单个闭式表达式。无需进行数值计算，也无需单位，因为 MOI 是无量纲的。", "solution": "所述问题在科学上是合理的，在数学上是适定的。我们直接进行推导。\n\n设 $T(m)$ 为成为有活力的转导子的受体细胞的期望比例，它是感染复数 $m$ 的函数。一个受体细胞成为有活力的转导子，当且仅当同时满足以下三个条件：\n1.  细胞未被任何裂解性噬菌体颗粒感染。\n2.  细胞在转导颗粒可能诱导的细胞毒性作用下存活下来。\n3.  来自至少一个转导颗粒的供体 DNA 成功整合到受体的染色体中。\n\n设 $N_l$ 和 $N_t$ 分别是吸附到单个受体细胞上的裂解颗粒和转导颗粒数量的随机变量。根据问题陈述，它们是独立的泊松随机变量，具有以下均值：\n- 裂解颗粒的平均数：$\\lambda_l = m(1 - f_t)$\n- 转导颗粒的平均数：$\\lambda_t = m f_t$\n\n其概率质量函数由下式给出：\n$P(N_l = k) = \\frac{\\exp(-\\lambda_l) \\lambda_l^k}{k!} = \\frac{\\exp(-m(1-f_t)) (m(1-f_t))^k}{k!}$，其中 $k=0,1,2,...$\n$P(N_t = n) = \\frac{\\exp(-\\lambda_t) \\lambda_t^n}{n!} = \\frac{\\exp(-mf_t) (mf_t)^n}{n!}$，其中 $n=0,1,2,...$\n\n接收到至少一个裂解颗粒（$N_l \\geq 1$）的细胞会被裂解，不能成为转导子。因此，要形成转导子，细胞必须恰好吸附零个裂解颗粒。此事件的概率为：\n$$P(N_l = 0) = \\frac{\\exp(-m(1-f_t)) (m(1-f_t))^0}{0!} = \\exp(-m(1-f_t))$$\n\n我们现在必须计算在 $N_l=0$ 的条件下，存活和重组的概率。我们可以使用全概率定律，对所有可能的转导颗粒数 $n$ 进行求和。\n设 $S_n$ 为存活事件，$R_n$ 为重组事件，条件是 $N_t=n$ 且 $N_l=0$。其概率如下：\n- $P(S_n) = s^n$\n- $P(R_n) = 1 - (1-r)^n$\n\n假设存活和重组是条件独立事件，两者同时发生的概率是它们各自概率的乘积：\n$P(S_n \\cap R_n) = P(S_n) P(R_n) = s^n (1 - (1-r)^n)$。\n\n有活力的转导子的总比例 $T(m)$ 是在 $N_l=0$ 的条件下，对所有可能的 $N_t=n$ 值的概率求和：\n$$T(m) = P(N_l=0) \\sum_{n=0}^{\\infty} P(S_n \\cap R_n) P(N_t=n)$$\n代入上面推导出的表达式：\n$$T(m) = \\exp(-m(1-f_t)) \\sum_{n=0}^{\\infty} \\left[ s^n (1 - (1-r)^n) \\right] \\left[ \\frac{\\exp(-mf_t) (mf_t)^n}{n!} \\right]$$\n我们可以将与求和指数 $n$ 无关的项 $\\exp(-mf_t)$ 提取出来：\n$$T(m) = \\exp(-m(1-f_t)) \\exp(-mf_t) \\sum_{n=0}^{\\infty} \\frac{(s^n - (s(1-r))^n) (mf_t)^n}{n!}$$\n指数项合并：$\\exp(-m(1-f_t) - mf_t) = \\exp(-m+mf_t-mf_t) = \\exp(-m)$。\n$$T(m) = \\exp(-m) \\sum_{n=0}^{\\infty} \\left( \\frac{(smf_t)^n}{n!} - \\frac{(s(1-r)mf_t)^n}{n!} \\right)$$\n我们可以将求和拆分：\n$$T(m) = \\exp(-m) \\left( \\sum_{n=0}^{\\infty} \\frac{(smf_t)^n}{n!} - \\sum_{n=0}^{\\infty} \\frac{(s(1-r)mf_t)^n}{n!} \\right)$$\n识别出指数函数的泰勒级数展开式 $\\exp(x) = \\sum_{k=0}^{\\infty} \\frac{x^k}{k!}$，我们可以简化这些和：\n- $\\sum_{n=0}^{\\infty} \\frac{(smf_t)^n}{n!} = \\exp(smf_t)$\n- $\\sum_{n=0}^{\\infty} \\frac{(s(1-r)mf_t)^n}{n!} = \\exp(s(1-r)mf_t)$\n\n将这些代回 $T(m)$ 的表达式中：\n$$T(m) = \\exp(-m) (\\exp(smf_t) - \\exp(s(1-r)mf_t))$$\n分配 $\\exp(-m)$ 项，我们得到转导子期望比例的闭式表达式：\n$$T(m) = \\exp(-m + smf_t) - \\exp(-m + s(1-r)mf_t)$$\n$$T(m) = \\exp(-m(1 - sf_t)) - \\exp(-m(1 - s(1-r)f_t))$$\n为了找到使 $T(m)$ 最大化的 $m$ 值，我们必须求 $T(m)$ 对 $m$ 的导数，并令其为零。\n$$\\frac{dT}{dm} = \\frac{d}{dm} \\left[ \\exp(-m(1 - sf_t)) - \\exp(-m(1 - s(1-r)f_t)) \\right]$$\n应用链式法则：\n$$\\frac{dT}{dm} = -(1 - sf_t)\\exp(-m(1 - sf_t)) - [-(1 - s(1-r)f_t))]\\exp(-m(1 - s(1-r)f_t))$$\n$$\\frac{dT}{dm} = (1 - s(1-r)f_t)\\exp(-m(1 - s(1-r)f_t)) - (1 - sf_t)\\exp(-m(1 - sf_t))$$\n将导数设为零，以求最优 MOI，$m^{\\star}$：\n$$(1 - s(1-r)f_t)\\exp(-m^{\\star}(1 - s(1-r)f_t)) = (1 - sf_t)\\exp(-m^{\\star}(1 - sf_t))$$\n为简化求解 $m^{\\star}$ 的过程，令 $A = 1 - sf_t$ 且 $B = 1 - s(1-r)f_t$。方程变为：\n$$B \\exp(-m^{\\star}B) = A \\exp(-m^{\\star}A)$$\n由于 $s, r, f_t \\in (0,1]$，因此 $A>0$ 且 $B>0$。我们可以对两边取自然对数：\n$$\\ln(B \\exp(-m^{\\star}B)) = \\ln(A \\exp(-m^{\\star}A))$$\n$$\\ln(B) - m^{\\star}B = \\ln(A) - m^{\\star}A$$\n重新整理各项以分离出 $m^{\\star}$：\n$$m^{\\star}A - m^{\\star}B = \\ln(A) - \\ln(B)$$\n$$m^{\\star}(A - B) = \\ln\\left(\\frac{A}{B}\\right)$$\n因此，最优 MOI 为：\n$$m^{\\star} = \\frac{\\ln(A/B)}{A - B}$$\n现在，我们代入 $A$ 和 $B$ 的原始表达式：\n分母是 $A - B = (1 - sf_t) - (1 - s(1-r)f_t) = 1 - sf_t - 1 + sf_t - srf_t = -srf_t$。\n分子是 $\\ln(A/B) = \\ln\\left(\\frac{1 - sf_t}{1 - s(1-r)f_t}\\right)$。\n将这些代入 $m^{\\star}$ 的表达式中：\n$$m^{\\star} = \\frac{\\ln\\left(\\frac{1 - sf_t}{1 - s(1-r)f_t}\\right)}{-srf_t}$$\n使用对数性质 $\\ln(x/y) = -\\ln(y/x)$，我们可以将其重写为：\n$$m^{\\star} = \\frac{-\\ln\\left(\\frac{1 - s(1-r)f_t}{1 - sf_t}\\right)}{-srf_t} = \\frac{\\ln\\left(\\frac{1 - s(1-r)f_t}{1 - sf_t}\\right)}{srf_t}$$\n这就是最优感染复数的最终表达式。二阶导数检验确认这是一个最大值，因为 $s, r, f_t > 0$ 且对数的参数大于 1。", "answer": "$$\\boxed{\\frac{\\ln\\left(\\frac{1 - s(1-r)f_{t}}{1 - sf_{t}}\\right)}{srf_{t}}}$$", "id": "2477931"}, {"introduction": "在探讨了单次实验中转导的测量和优化后，我们现在将视角扩展到群体层面，以理解其长期的进化意义。转导如何在多代中促进抗生素抗性等性状的传播？这最后一个练习 [@problem_id:2477934] 要求您构建一个计算模型，模拟自然选择和广义转导之间的相互作用，从而预测一个基因在群体中频率随时间的变化。这项实践将转导的分子机制与其作为细菌进化强大驱动力的作用直接联系起来。", "problem": "考虑一个单倍体、无性繁殖的细菌种群，该种群被一种介导普遍性转导的严格裂解性噬菌体感染。假设每代种群大小恒定为 $N$ 个细胞，世代离散不重叠，并且在每一代内，转导发生之前存在密度非依赖性的生存力选择。存在两种基因型：抗性 ($R$) 和敏感性 ($S$)。抗性基因型的适应度为 $1 + s$，敏感性基因型的适应度为 $1$，其中 $s$ 是选择系数。普遍性转导的发生过程如下：供体细胞将脱氧核糖核酸 (DNA) 片段随机释放到噬菌体衣壳中；在感染受体细胞时，转导颗粒可以通过同源重组将敏感性细胞转化为抗性细胞。根据质量作用假说，假设在任何一代中，任何一个敏感性细胞通过转导变为抗性细胞的概率与选择后的供体频率成正比。设 $\\tau$ 表示每代的比例常数（转导率系数）。假设没有从抗性到敏感性的反向转化。\n\n从第 $t$ 代选择前的抗性频率 $x_t \\in [0,1]$ 开始，标准的单倍体生存力选择更新给出选择后的抗性频率\n$$\nx_t^{\\mathrm{sel}} = \\frac{x_t (1 + s)}{1 + s x_t}.\n$$\n在同一代内的质量作用转导步骤中，每个敏感性细胞以如下概率独立地转化为抗性细胞\n$$\np_t^{\\mathrm{conv}} = \\tau \\, x_t^{\\mathrm{sel}},\n$$\n该概率需要满足 $0 \\le p_t^{\\mathrm{conv}} \\le 1$。因此，转导后的期望抗性频率为\n$$\nx_{t}^{\\mathrm{det}} = x_t^{\\mathrm{sel}} + \\left(1 - x_t^{\\mathrm{sel}}\\right) p_t^{\\mathrm{conv}}.\n$$\n最后，通过 Wright–Fisher (WF) 抽样，以抗性概率 $x_{t}^{\\mathrm{det}}$ 抽取 $N$ 个后代用于第 $t+1$ 代，从而维持种群大小为 $N$。期望抗性频率满足 $\\mathbb{E}[x_{t+1} \\mid x_t] = x_{t}^{\\mathrm{det}}$。\n\n任务：仅使用期望值（不模拟随机抽样），构建一个程序，在给定 $(\\tau, s, N, i_0, G)$ 的情况下，计算以下内容，其中 $i_0$ 是初始抗性个体数，$G$ 是世代数：\n- 在上述选择-转导递归关系下，从 $x_0 = i_0 / N$ 开始，经过 $G$ 代后的期望抗性频率 $x_G$，\n- 在 $t = 0, 1, \\ldots, G-1$ 世代中，由普遍性转导专门产生的新的抗性细胞的期望累积数量，其等于\n$$\nT = \\sum_{t=0}^{G-1} N \\left(1 - x_t^{\\mathrm{sel}}\\right) p_t^{\\mathrm{conv}}.\n$$\n\n你必须为每一代 $t$ 实现以下更新：\n1. 计算 $x_t^{\\mathrm{sel}} = \\dfrac{x_t (1 + s)}{1 + s x_t}$。\n2. 计算 $p_t^{\\mathrm{conv}} = \\tau \\, x_t^{\\mathrm{sel}}$，如果数值误差导致其超出 $[0,1]$ 范围，则将其限制在该范围内。\n3. 更新期望抗性频率 $x_{t+1} = x_t^{\\mathrm{sel}} + (1 - x_t^{\\mathrm{sel}}) p_t^{\\mathrm{conv}}$。\n4. 累加这一代中期望的新增转导子数量，$N (1 - x_t^{\\mathrm{sel}}) p_t^{\\mathrm{conv}}$。\n\n用作基本依据的科学假设：\n- 相对适应度为 $1+s$（抗性）和 $1$（敏感性）且 $N$ 恒定的单倍体生存力选择，导致标准的选择后频率 $x_t^{\\mathrm{sel}} = \\dfrac{x_t (1 + s)}{1 + s x_t}$。\n- 普遍性转导随机包装宿主DNA，因此源自供体的转导颗粒比例与供体频率成正比，从而产生一个与 $x_t^{\\mathrm{sel}}$ 成正比的转化概率，系数为 $\\tau$。\n- Wright–Fisher 抽样保持 $N$ 恒定；仅使用期望值意味着遗传漂变不改变期望频率，即 $\\mathbb{E}[x_{t+1} \\mid x_t] = x_t^{\\mathrm{det}}$。\n\n要求：\n- 实现 $G$ 代的确定性递归，以浮点数形式生成 $x_G$ 和 $T$。所有中间计算必须满足 $x_t \\in [0,1]$ 和 $0 \\le p_t^{\\mathrm{conv}} \\le 1$。\n- 不要模拟随机抽样；仅使用上述模型所隐含的期望值。\n- 所有测试用例的输出应汇总到单行中：一个类JSON格式的结果列表，其中每个结果是一个双元素列表 $[x_G, T]$，两个条目均为十进制数（无百分号）。例如，一个包含两个案例的输出应如下所示 $[[x_{G,1}, T_1],[x_{G,2}, T_2]]$。\n\n测试套件（每个元组为 $(\\tau, s, N, i_0, G)$）：\n- 案例 1：$(\\tau = 10^{-5},\\ s = 0.1,\\ N = 10^6,\\ i_0 = 100,\\ G = 50)$。\n- 案例 2：$(\\tau = 0,\\ s = 0.05,\\ N = 10^5,\\ i_0 = 10,\\ G = 100)$。\n- 案例 3：$(\\tau = 0.02,\\ s = 0,\\ N = 10^4,\\ i_0 = 0,\\ G = 20)$。\n- 案例 4：$(\\tau = 0.03,\\ s = -0.05,\\ N = 5 \\times 10^5,\\ i_0 = 5 \\times 10^4,\\ G = 60)$。\n- 案例 5：$(\\tau = 0.02,\\ s = 0.2,\\ N = 2 \\times 10^5,\\ i_0 = 2 \\times 10^5,\\ G = 10)$。\n\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的五个双元素列表，并用方括号括起来，顺序与上述案例完全一致；例如：\n$[[x_{G,1},T_1],[x_{G,2},T_2],[x_{G,3},T_3],[x_{G,4},T_4],[x_{G,5},T_5]]$。", "solution": "所述问题在数学上和生物学上是明确定义的。它描述了一个确定性动力学系统，用于计算在选择和通过普遍性转导进行的水平基因转移的共同作用下，抗性等位基因的期望频率。任务是计算该系统在指定世代数后的状态。我们通过构建一个直接的迭代算法来解决此问题。\n\n在任何世代 $t$，系统的状态由抗性基因型的频率 $x_t$ 描述。问题要求计算经过 $G$ 代后的两个量：最终频率 $x_G$ 和由转导产生的新抗性细胞的累积数量 $T$。\n\n第 $t=0$ 代的初始状态由给定参数确定：初始抗性个体数 $i_0$ 和总种群大小 $N$。因此，初始频率为 $x_0 = i_0 / N$。初始累积转导子数量为 $T_{cumulative} = 0$。\n\n从第 $t$ 代到第 $t+1$ 代的系统演化由一系列确定性步骤控制，我们将迭代 $G$ 次。对于从 $0$ 到 $G-1$ 的每一代 $t$，我们执行以下计算：\n\n1.  **生存力选择**：首先，我们考虑自然选择。抗性基因型的相对适应度为 $1+s$，而敏感性基因型的适应度为 $1$。选择前种群的平均适应度为 $\\bar{w}_t = x_t(1+s) + (1-x_t)(1) = 1 + sx_t$。选择后抗性基因型的频率 $x_t^{\\mathrm{sel}}$ 由标准的单倍体选择方程给出：\n    $$\n    x_t^{\\mathrm{sel}} = \\frac{x_t (1 + s)}{1 + s x_t}\n    $$\n    这个频率 $x_t^{\\mathrm{sel}}$ 代表了用于转导的潜在供体池中抗性个体的比例。\n\n2.  **普遍性转导**：选择之后，发生普遍性转导。\n    a.  假定任何给定敏感性细胞转化为抗性细胞的概率 $p_t^{\\mathrm{conv}}$ 与选择后抗性基因型的频率 $x_t^{\\mathrm{sel}}$ 成正比。这是一个质量作用模型。比例常数是转导率系数 $\\tau$。\n        $$\n        p_t^{\\mathrm{conv}} = \\tau \\, x_t^{\\mathrm{sel}}\n        $$\n        由于这是一个概率，其值必须在区间 $[0, 1]$ 内。所提供的参数确保 $\\tau \\, x_t^{\\mathrm{sel}} \\le 1$，但为了算法的鲁棒性，任何超出此范围的值都必须被截断。\n    b.  计算在第 $t$ 代由转导产生的新抗性细胞的期望数量。选择后的敏感性细胞数量为 $N(1-x_t^{\\mathrm{sel}})$。将其乘以转化概率，得到这一代中期望的新增转导子数量，我们将其记为 $\\Delta T_t$。\n        $$\n        \\Delta T_t = N \\left(1 - x_t^{\\mathrm{sel}}\\right) p_t^{\\mathrm{conv}}\n        $$\n        将此数量添加到一个运行总和中，以计算累积转导子数量 $T$。\n\n3.  **频率更新**：下一代抗性基因型的期望频率 $x_{t+1}$，是存活下来的抗性细胞频率与新转化为抗性的敏感性细胞频率之和。\n    $$\n    x_{t+1} = x_t^{\\mathrm{sel}} + \\left(1 - x_t^{\\mathrm{sel}}\\right) p_t^{\\mathrm{conv}}\n    $$\n    这个 $x_{t+1}$ 的值成为下一代的起始频率。\n\n该算法的实现方式是：首先初始化 $x \\leftarrow x_0$ 和 $T \\leftarrow 0$，然后执行一个进行 $G$ 次迭代的循环。在每次迭代中，执行上述三个步骤来更新 $x$ 和 $T$。经过 $G$ 个完整世代后的最终值即为所要求的输出 $x_G$ 和 $T$。此过程应用于问题陈述中指定的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the population genetics problem for the given test cases.\n    \"\"\"\n\n    def calculate_evolution(tau, s, N, i0, G):\n        \"\"\"\n        Calculates the expected resistant frequency and cumulative transductants.\n\n        Args:\n            tau (float): Transduction rate coefficient.\n            s (float): Selection coefficient.\n            N (float): Population size.\n            i0 (float): Initial count of resistant individuals.\n            G (int): Number of generations.\n\n        Returns:\n            list[float, float]: A list containing the final resistant frequency x_G\n                                and the total cumulative transductants T.\n        \"\"\"\n        # Initial conditions\n        if N == 0:\n            return [0.0, 0.0]\n        x = float(i0) / float(N)\n        total_transductants = 0.0\n\n        for _ in range(G):\n            # Optimization for fixed points x=0 and x=1\n            if x == 0.0:\n                # If there are no resistant cells, frequency cannot increase\n                # without de novo mutation (not in model).\n                break\n            if x == 1.0:\n                # If all cells are resistant, no sensitive cells exist to be transduced.\n                break\n\n            # Step 1: Compute post-selection frequency\n            # This is the standard haploid viability selection update.\n            # Denominator (1 + s*x) is guaranteed to be non-zero for s > -1.\n            # The problem's constraints on s satisfy this.\n            x_sel = (x * (1.0 + s)) / (1.0 + s * x)\n\n            # Step 2: Compute conversion probability and clamp\n            # This is the mass-action transduction model.\n            p_conv = tau * x_sel\n            # Clamp for numerical stability, though not strictly needed for given cases.\n            p_conv = max(0.0, min(1.0, p_conv))\n\n            # Step 4 (as per problem): Accumulate new transductants\n            new_transductants = N * (1.0 - x_sel) * p_conv\n            total_transductants += new_transductants\n\n            # Step 3 (as per problem): Update expected frequency for the next generation\n            x = x_sel + (1.0 - x_sel) * p_conv\n\n        return [x, total_transductants]\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        # (tau, s, N, i0, G)\n        (1e-5, 0.1, 1e6, 100, 50),\n        (0.0, 0.05, 1e5, 10, 100),\n        (0.02, 0.0, 1e4, 0, 20),\n        (0.03, -0.05, 5e5, 5e4, 60),\n        (0.02, 0.2, 2e5, 2e5, 10)\n    ]\n\n    results = []\n    for case in test_cases:\n        tau, s, N, i0, G = case\n        result = calculate_evolution(tau, s, float(N), float(i0), G)\n        results.append(result)\n\n    # Format the output string precisely as required.\n    # The output should be a JSON-like list of two-element lists.\n    # Example: [[x_G,1,T_1],[x_G,2,T_2]]\n    result_strings = []\n    for res in results:\n        result_strings.append(f\"[{res[0]},{res[1]}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2477934"}]}