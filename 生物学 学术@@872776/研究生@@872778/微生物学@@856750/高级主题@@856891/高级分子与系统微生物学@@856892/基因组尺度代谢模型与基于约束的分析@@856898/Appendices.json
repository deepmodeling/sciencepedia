{"hands_on_practices": [{"introduction": "化学计量矩阵 $S$ 是任何代谢模型的核心，它以数学形式描述了网络中所有反应的物质转化关系。本练习将引导你将一组化学反应转化为矩阵形式，并探索其基本数学性质，例如决定所有可能的稳态通量分布的零空间。这是进行任何基于约束的分析的基础步骤。[@problem_id:2496368]", "problem": "在基于约束的基因组尺度代谢模型重建与分析 (COBRA) 中，稳态假设对胞内代谢物施加了质量平衡约束，表示为 $S \\, v = 0$，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。考虑一个封闭的内部分网络，包含三个不可逆反应 $R_1$、$R_2$、$R_3$ 和三种胞内代谢物 $A$、$B$、$C$：\n- $R_1$：$A \\to B$\n- $R_2$：$B \\to C$\n- $R_3$：$C \\to A$\n\n根据化学计量系数的定义（消耗为负，生成为正），构建化学计量矩阵 $S$，代谢物顺序为 $[A,B,C]$，反应顺序为 $[R_1,R_2,R_3]$。然后，利用封闭内部分网络（无交换反应）的稳态质量平衡，确定 $S \\, v = 0$ 在实数域上的解空间的维度。假设所有三个反应都是不可逆的，但请报告线性解空间的维度（而非可行锥）。请用一个不带单位的整数表示您的最终答案。无需四舍五入。", "solution": "该问题要求确定给定封闭代谢子网络的稳态质量平衡方程 $S \\, v = 0$ 的解空间的维度。这个维度在数学上等同于化学计量矩阵 $S$ 的零空间的维度，也称为 $S$ 的零度。\n\n首先，我们必须构建化学计量矩阵 $S$。该矩阵的行对应于代谢物，列对应于反应。问题指定了代谢物的顺序为 $[A, B, C]$，反应的顺序为 $[R_1, R_2, R_3]$。因此，矩阵 $S$ 将是一个 $3 \\times 3$ 的矩阵。矩阵的元素 $S_{ij}$ 是代谢物 $i$ 在反应 $j$ 中的化学计量系数。惯例是反应物（消耗）的系数为负，产物（生成）的系数为正。\n\n反应如下：\n$R_1$: $A \\to B$\n$R_2$: $B \\to C$\n$R_3$: $C \\to A$\n\n我们来构建 $S$ 中对应于每个反应的列：\n对于反应 $R_1$: $A \\to B$。代谢物 $A$ 被消耗（系数为 $-1$），代谢物 $B$ 被生成（系数为 $+1$），代谢物 $C$ 不参与（系数为 $0$）。$S$ 的第一列是 $\\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n对于反应 $R_2$: $B \\to C$。代谢物 $B$ 被消耗（系数为 $-1$），代谢物 $C$ 被生成（系数为 $+1$），代谢物 $A$ 不参与（系数为 $0$）。$S$ 的第二列是 $\\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$。\n\n对于反应 $R_3$: $C \\to A$。代谢物 $C$ 被消耗（系数为 $-1$），代谢物 $A$ 被生成（系数为 $+1$），代谢物 $B$ 不参与（系数为 $0$）。$S$ 的第三列是 $\\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。\n\n合并这些列，化学计量矩阵 $S$ 为：\n$$\nS = \\begin{pmatrix}\n-1   0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n$$\n\n问题要求解线性系统 $S v = 0$ 的解空间的维度，其中 $v = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix}$ 是反应通量向量。这就是矩阵 $S$ 的零度，记为 $\\text{nullity}(S)$。\n\n根据秩-零度定理，对于一个有 $n$ 列的矩阵，以下关系成立：\n$$\n\\text{rank}(S) + \\text{nullity}(S) = n\n$$\n在我们的例子中，列数 $n$ 是反应的数量，即 $3$。因此，我们有：\n$$\n\\text{nullity}(S) = 3 - \\text{rank}(S)\n$$\n为了求零度，我们首先确定 $S$ 的秩，也就是其行空间（或列空间）的维度。$S$ 的行向量是：\n$r_1 = \\begin{pmatrix} -1   0  1 \\end{pmatrix}$\n$r_2 = \\begin{pmatrix} 1  -1  0 \\end{pmatrix}$\n$r_3 = \\begin{pmatrix} 0  1  -1 \\end{pmatrix}$\n\n我们可以通过观察到三个行向量之和为零向量来检验线性相关性：\n$$\nr_1 + r_2 + r_3 = \\begin{pmatrix} -1+1+0  0-1+1  1+0-1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\end{pmatrix}\n$$\n由于存在行的非平凡线性组合等于零向量，所以这些行是线性相关的。这意味着 $\\text{rank}(S)  3$。\n\n现在我们检查是否有任意两行是线性无关的。考虑 $r_1$ 和 $r_2$。它们是线性无关的，因为它们中的任何一个都不是另一个的标量倍数。例如，为了匹配第一个元素，我们需要 $c \\cdot (-1) = 1$，所以 $c=-1$。但 $c \\cdot r_1 = (-1)\\begin{pmatrix} -1  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0  -1 \\end{pmatrix} \\neq r_2$。因此，$S$ 的秩至少为 $2$。\n由于 $\\text{rank}(S)  3$ 且 $\\text{rank}(S) \\ge 2$，所以必然有 $\\text{rank}(S) = 2$。\n\n使用秩-零度定理：\n$$\n\\text{nullity}(S) = 3 - \\text{rank}(S) = 3 - 2 = 1\n$$\n或者，我们可以直接求解方程组 $S v = 0$：\n$$\n\\begin{pmatrix}\n-1   0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n\\begin{pmatrix}\nv_1 \\\\\nv_2 \\\\\nv_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这给出了以下线性方程组：\n$1) \\quad -v_1 + v_3 = 0 \\implies v_1 = v_3$\n$2) \\quad v_1 - v_2 = 0 \\implies v_1 = v_2$\n$3) \\quad v_2 - v_3 = 0 \\implies v_2 = v_3$\n所有三个方程都导向同一个条件：$v_1 = v_2 = v_3$。如果我们令 $v_1 = t$（其中 $t$ 是某个实数参数），那么任何解向量 $v$ 都可以写成：\n$$\nv = \\begin{pmatrix} t \\\\ t \\\\ t \\end{pmatrix} = t \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n解空间是向量 $\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$ 的所有标量倍数的集合。这个空间由单个基向量张成。因此，解空间的维度是 $1$。这个结果对应于存在一个独立的稳态通量模式，在本例中即为该循环通路本身，其中所有反应必须以相同的速率进行以维持质量平衡。问题提到反应是不可逆的，但正确地要求了线性解空间（$S v = 0$）的维度，而不是可行锥（$S v = 0, v \\ge 0$）的维度，这个维度确实是 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "2496368"}, {"introduction": "化学计量定义了代谢通量的可能性，而热力学则决定了其可行性。本练习阐明了热力学第二定律如何根据细胞内代谢物的实际浓度对反应方向施加严格的约束，从而进一步精炼了仅由 $S v = 0$ 定义的解空间。通过这个例子，你可以理解标准吉布斯自由能与实际吉布斯自由能之间的关键区别及其对通量方向的决定性影响。[@problem_id:2496312]", "problem": "考虑一个嵌入在通量平衡分析（FBA）中的基因组尺度代谢模型里的单个胞内反应。该反应的标准变换反应吉布斯自由能变为 $\\Delta_{r} G'^{\\circ} = -20 \\ \\text{kJ} \\ \\text{mol}^{-1}$。在温度 $T = 310 \\ \\text{K}$ 及测得的胞内代谢物浓度下，观察到变换吉布斯自由能变满足基本关系 $\\Delta_{r} G' = \\Delta_{r} G'^{\\circ} + R T \\ln Q$，并被确定为 $\\Delta_{r} G' = +2 \\ \\text{kJ} \\ \\text{mol}^{-1}$。在模型重建中，该反应受到酶容量的限制，具有双侧约束 $-5 \\le v \\le 10$，其中 $v$ 是以 $\\text{mmol} \\ \\text{gDW}^{-1} \\ \\text{h}^{-1}$ 为单位的净反应通量，且正向定义为 $v  0$。假设系统处于稳态，并施加与热力学第二定律一致的热力学可行性约束。\n\n该反应的最大热力学可行正向净通量是多少？请以 $\\text{mmol} \\ \\text{gDW}^{-1} \\ \\text{h}^{-1}$ 为单位表示最终答案。无需四舍五入。", "solution": "目标是，从非平衡热力学的第一性原理出发，根据测得的热力学数据和容量限制，确定最大可行正向净通量。\n\n将反应自由能与浓度联系起来的基本关系是\n$$\n\\Delta_{r} G' \\;=\\; \\Delta_{r} G'^{\\circ} + R T \\ln Q,\n$$\n其中 $\\Delta_{r} G'$ 是胞内条件下的变换吉布斯自由能变，$\\Delta_{r} G'^{\\circ}$ 是标准变换吉布斯自由能变，$R$ 是理想气体常数，$T$ 是绝对温度，$Q$ 是由代谢物活度或浓度计算出的反应商。根据题意，在测得的胞内状态下，此值计算为 $\\Delta_{r} G' = +2 \\ \\text{kJ} \\ \\text{mol}^{-1}$。\n\n接下来，我们应用热力学第二定律来处理化学反应的非平衡稳态。根据非平衡热力学的公认结论，单个反应 $r$ 的熵产生速率由以下公式给出：\n$$\n\\sigma_{r} \\;=\\; -\\frac{v_{r} \\, \\Delta_{r} G'}{T},\n$$\n其中 $v_{r}$ 是净反应通量（在定义为正向的方向上为正值），$T$ 是绝对温度。热力学第二定律要求在稳态下 $\\sigma_{r} \\ge 0$。因此，\n$$\n-\\frac{v_{r} \\, \\Delta_{r} G'}{T} \\;\\ge\\; 0 \\quad \\Longrightarrow \\quad v_{r} \\, \\Delta_{r} G' \\;\\le\\; 0,\n$$\n因为 $T  0$。\n\n当 $\\Delta_{r} G' = +2 \\ \\text{kJ} \\ \\text{mol}^{-1}  0$ 时，该不等式简化为\n$$\nv_{r} \\le 0.\n$$\n因此，任何热力学可行的净通量都必须是非正的；特别是，不存在严格为正的正向净通量。给定的酶容量约束为 $-5 \\le v \\le 10$ (单位为 $\\text{mmol} \\ \\text{gDW}^{-1} \\ \\text{h}^{-1}$)。施加 $v \\le 0$ 的约束后，可行域进一步被限制为\n$$\n-5 \\;\\le\\; v \\;\\le\\; 0.\n$$\n因此，在正向（正值）方向上 $v$ 的最大可行值是与这两个约束都一致的最大 $v$ 值，即\n$$\nv_{\\text{forward,max}} = 0.\n$$\n因此，最大热力学可行正向净通量为零，单位为 $\\text{mmol} \\ \\text{gDW}^{-1} \\ \\text{h}^{-1}$。", "answer": "$$\\boxed{0}$$", "id": "2496312"}, {"introduction": "基因组尺度模型的真正威力在于其强大的预测能力，特别是在模拟遗传扰动方面。本练习整合了所有核心概念——化学计量、通量边界、生物质目标函数（FBA）以及基因-蛋白质-反应（GPR）关联——来进行计算机内的基因敲除实验。通过识别“合成致死”基因对，我们可以揭示代谢网络中隐藏的功能冗余和鲁棒性机制。[@problem_id:2496280]", "problem": "给定一个小型、质量平衡的代谢网络，该网络包含两条平行通路，分别由反应 $R_A$ 和 $R_B$ 表示，每条通路在功能正常时都能独立支持生物质的生产。任务是使用基因-蛋白质-反应 (GPR) 映射与流平衡分析 (FBA) 来确定基因缺失情况下的存活性，并识别合成致死基因对。你的程序必须从第一性原理出发，基于稳态质量平衡和代谢流的操作性定义来实现这些步骤。\n\n需要使用的基本定义：\n- 在代谢稳态下，细胞内代谢物的浓度在所关注的时间尺度上没有明显变化。这意味着存在线性约束 $$S \\, v = 0,$$ 其中 $S$ 是化学计量矩阵，$v$ 是反应流向量。\n- 每个反应流 $v_i$ 都受下界和上界约束，$$\\ell_i \\le v_i \\le u_i.$$\n- 在此，流平衡分析 (FBA) 定义为在满足稳态和边界约束的条件下，最大化生物质生成速率的优化问题。设生物质反应是索引为 $5$ 的反应（从零开始的索引）。线性规划的目标是最大化 $v_5$。\n- 基因-蛋白质-反应 (GPR) 映射使用布尔逻辑将基因的存在与否与反应的可用性联系起来。一个反应是活跃的，当且仅当在给定的基因缺失集下其 GPR 布尔公式的计算结果为真；否则，如果反应不活跃，则强制 $$v_i = 0.$$\n\n网络规格：\n- 内部代谢物（$S$ 的行）：$S$（底物），$A$（通路 $R_A$ 的中间产物），$C$（通路 $R_B$ 的中间产物），$B$（生物质前体）。\n- 反应（$S$ 的列），按顺序：\n  $0$: $S$ 的交换/摄取（表示为 $\\mathrm{EX\\_S}$），\n  $1$: $S \\to A$ ($R1A$)，\n  $2$: $A \\to B$ ($R2A$)，\n  $3$: $S \\to C$ ($R1B$)，\n  $4$: $C \\to B$ ($R2B$)，\n  $5$: $B \\to$ 生物质汇（$\\mathrm{Biomass}$）。\n- 化学计量矩阵 $S \\in \\mathbb{R}^{4 \\times 6}$，代谢物和反应均按上述顺序排列：\n$$\nS =\n\\begin{bmatrix}\n+1   -1  0  -1  0  0 \\\\\n0  +1  -1  0  0  0 \\\\\n0  0  0  +1  -1  0 \\\\\n0  0  +1  0  +1  -1\n\\end{bmatrix}.\n$$\n- 流边界（任意单位）：下界\n$$\n\\ell = \\begin{bmatrix} -10 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix},\n$$\n上界\n$$\nu = \\begin{bmatrix} 0 \\\\ 1000 \\\\ 1000 \\\\ 1000 \\\\ 1000 \\\\ 1000 \\end{bmatrix}.\n$$\n- GPR 规则，使用从零开始的基因索引。共有 $4$ 个基因，索引为 $0,1,2,3$。对每个反应的 GPR 使用析取范式 (OR-of-AND)：\n  - 反应 $0$ ($\\mathrm{EX\\_S}$): 无基因关联（始终活跃）。\n  - 反应 $1$ ($R1A$): $[\\,[0]\\,]$。\n  - 反应 $2$ ($R2A$): $[\\,[1]\\,]$。\n  - 反应 $3$ ($R1B$): $[\\,[2]\\,]$。\n  - 反应 $4$ ($R2B$): $[\\,[3]\\,]$。\n  - 反应 $5$ ($\\mathrm{Biomass}$): 无基因关联（始终活跃）。\n  解释：像 $[\\,[i]\\,]$ 这样的列表意味着如果基因 $i$ 存在，则反应是活跃的；像 $[i,j]$ 这样的子句意味着基因 $i$ 和 $j$ 都必须存在；跨子句的“或”逻辑意味着至少有一个子句必须被满足才能使反应活跃。\n\n存活性标准：\n- 对于给定的基因缺失集，评估 GPR 规则以停用任何相关反应（为不活跃的反应将上下界均设为 $0$），然后执行 FBA。如果最优生物质流满足 $$v_5^\\star \\ge \\varepsilon,$$ 则认为该基因型是可存活的，其中 $\\varepsilon = 10^{-9}$。\n\n合成致死性：\n- 如果基因 $i$ 和 $j$ 两个相应的单基因缺失各自是可存活的，但这两个基因的双基因缺失是不可存活的，则基因对 $\\{i,j\\}$ 是一个合成致死对。\n\n程序任务：\n- 实现上文定义的 GPR 评估和 FBA。\n- 使用指定的网络和边界，评估以下基因缺失集的存活性（使用从零开始的基因索引，并将每个集合按升序排序）：\n  - $D_0 = [\\,]$,\n  - $D_1 = [\\,0\\,]$,\n  - $D_2 = [\\,1\\,]$,\n  - $D_3 = [\\,2\\,]$,\n  - $D_4 = [\\,3\\,]$,\n  - $D_5 = [\\,0,2\\,]$,\n  - $D_6 = [\\,0,3\\,]$,\n  - $D_7 = [\\,1,2\\,]$,\n  - $D_8 = [\\,1,3\\,]$.\n- 在完整的基因集 $\\{0,1,2,3\\}$ 中，枚举所有大小为 $2$ 的基因对，并返回那些根据上述定义为合成致死的基因对。每对基因都必须以排序列表 $[i,j]$（其中 $i  j$）的形式报告。基因对列表本身必须按字典序排序。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果。条目按顺序依次是 $D_0$ 到 $D_8$ 的 9 个布尔存活性结果，其后是一个包含所有合成致死基因对（表示为含两个整数的列表）的列表。例如，一个带有占位符的输出看起来会像\n\"[True,True,False,...,[[0,2],[1,3]]]\"（不要打印引号）。", "solution": "所提出的问题是计算系统生物学中一个适定性很好的练习，要求在由基因-蛋白质-反应 (GPR) 映射定义的遗传约束下应用流平衡分析 (FBA)。任务是确定各种基因型的细胞存活性，并识别合成致死基因对。解决方案是从代谢稳态和线性规划的第一性原理推导得出。\n\n问题的核心在于求解一个线性规划 (LP) 问题。代谢网络的状态由反应流向量 $v \\in \\mathbb{R}^6$ 描述。在稳态下，内部代谢物的浓度是恒定的。这施加了质量平衡约束，它是一个线性方程组：\n$$S v = 0$$\n此处，$S \\in \\mathbb{R}^{4 \\times 6}$ 是化学计量矩阵，其中行对应代谢物，列对应反应。向量 $v$ 包含每个反应的流。方程 $S v = 0$ 确保对于每种内部代谢物，其总生成速率等于其总消耗速率。\n\n此外，每个流 $v_i$ 都受热力学和酶容量限制的约束。这些约束表示为每个流的下界和上界：\n$$ \\ell_i \\le v_i \\le u_i $$\n对于此问题，边界由向量 $\\ell = [-10, 0, 0, 0, 0, 0]^T$ 和 $u = [0, 1000, 1000, 1000, 1000, 1000]^T$ 给出。请注意，摄取反应 $\\mathrm{EX\\_S}$（反应 $0$）的流为负值，表示从环境中消耗底物，最大速率为 $10$ 单位。所有内部反应都是不可逆的，其下界为 $0$。\n\n细胞的生物学目标被假定为最大化其生长速率。在 FBA 中，这被建模为最大化通过一个合成生物质反应的流，该反应以化学计量上适当的比例消耗前体。在这个简化模型中，这是反应 $5$，目标是最大化 $v_5$。\n\n因此，完整的 FBA 问题被表述为以下 LP：\n$$\n\\begin{array}{ll}\n\\underset{v}{\\text{maximize}}  c^T v \\\\\n\\text{subject to}  S v = 0 \\\\\n \\ell \\le v \\le u\n\\end{array}\n$$\n其中目标向量是 $c = [0, 0, 0, 0, 0, 1]^T$。标准的 LP 求解器通常执行最小化，因此我们求解等效的最小化 $-c^T v$ 的问题。\n\n通过评估 GPR 规则来整合基因缺失的影响。GPR 规则是一个布尔表达式，它根据其关联基因的存在与否来确定一个反应是否活跃。如果由于基因缺失，反应 $i$ 的 GPR 表达式计算结果为假，则该反应被视为不活跃。这通过将其流边界设置为零来强制执行：$\\ell_i = 0$ 和 $u_i = 0$，从而强制 $v_i=0$。对于给定的网络，GPR 是简单的一对一映射：基因 $0 \\to$ 反应 $1$，基因 $1 \\to$ 反应 $2$，基因 $2 \\to$ 反应 $3$，以及基因 $3 \\to$ 反应 $4$。例如，如果基因 $0$ 被删除，反应 $1$ 将变得不活跃。\n\n一个由一组被删除的基因指定的基因型，如果其产生的最优生物质流 $v_5^*$ 满足 $v_5^* \\ge \\varepsilon$，则被认为是可存活的，其中存活性阈值为 $\\varepsilon = 10^{-9}$。\n\n基因对 $\\{i,j\\}$ 被定义为合成致死，是指基因 $i$ 和 $j$ 的单基因缺失都是可存活的，但 $\\{i,j\\}$ 的双基因缺失是不可存活的。这表明基因 $i$ 和 $j$ 参与了平行的、冗余的通路，这些通路在组合起来时是必不可少的。\n\n求解策略如下：\n1.  对于给定的基因缺失集，根据 GPR 规则更新默认的流边界 $\\ell$ 和 $u$。\n2.  求解相应的 FBA 线性规划问题，以找到最大生物质流 $v_5^*$。\n3.  通过将 $v_5^*$ 与阈值 $\\varepsilon$ 进行比较来确定存活性。\n4.  应用此过程来评估九个指定缺失集的存活性。\n5.  要识别合成致死对，首先评估所有单基因缺失的存活性。然后，对于每一对（其单个缺失是可存活的）基因 $\\{i,j\\}$，评估双重缺失 $\\{i,j\\}$ 的存活性。如果双重缺失是不可存活的，则 $\\{i,j\\}$ 是一个合成致死对。\n\n这种 FBA 的系统性应用提供了所需的存活性数据，并识别了编码在网络结构和 GPR 逻辑中的功能冗余。所提供的网络由两条平行通路（通路 A：反应 $1,2$，由基因 $0,1$ 控制；通路 B：反应 $3,4$，由基因 $2,3$ 控制）组成，它们将底物 $S$ 转化为生物质前体 $B$。同时从每个通路中删除一个基因将阻断通往生物质生产的两条路径，导致致死表型，这是该系统中合成致死性的基础。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom itertools import combinations\n\ndef solve():\n    \"\"\"\n    Solves the metabolic network analysis problem by implementing Flux Balance Analysis (FBA)\n    with Gene-Protein-Reaction (GPR) constraints to determine viability and synthetic lethality.\n    \"\"\"\n    \n    # --- Model Definition ---\n    # Stoichiometric matrix S\n    S = np.array([\n        [1, -1, 0, -1, 0, 0],  # Substrate S\n        [0, 1, -1, 0, 0, 0],  # Intermediate A\n        [0, 0, 0, 1, -1, 0],  # Intermediate C\n        [0, 0, 1, 0, 1, -1]   # Precursor B\n    ])\n\n    # Default flux bounds (lower, upper)\n    base_bounds = [\n        (-10, 0),    # 0: EX_S\n        (0, 1000),   # 1: R1A\n        (0, 1000),   # 2: R2A\n        (0, 1000),   # 3: R1B\n        (0, 1000),   # 4: R2B\n        (0, 1000)    # 5: Biomass\n    ]\n\n    # GPR rules: maps gene index to the reaction index it controls.\n    # A deleted gene knocks out its associated reaction.\n    gpr_map = {\n        0: 1,  # Gene 0 -> R1A (Reaction 1)\n        1: 2,  # Gene 1 -> R2A (Reaction 2)\n        2: 3,  # Gene 2 -> R1B (Reaction 3)\n        3: 4,  # Gene 3 -> R2B (Reaction 4)\n    }\n\n    # FBA objective: maximize biomass flux (v_5). Scipy minimizes, so we minimize -v_5.\n    c = np.array([0, 0, 0, 0, 0, -1])\n\n    # Equality constraints: Sv = 0\n    A_eq = S\n    b_eq = np.zeros(S.shape[0])\n\n    # Viability threshold\n    epsilon = 1e-9\n\n    # Cache for memoizing FBA results to avoid redundant computations\n    viability_cache = {}\n\n    def is_viable(deleted_genes_tuple):\n        \"\"\"\n        Determines if a genotype is viable by running FBA.\n        The input is a tuple of sorted, unique gene indices to be deleted.\n        \"\"\"\n        if deleted_genes_tuple in viability_cache:\n            return viability_cache[deleted_genes_tuple]\n\n        # Apply GPR rules to update bounds\n        current_bounds = list(base_bounds)\n        for gene_idx in deleted_genes_tuple:\n            if gene_idx in gpr_map:\n                reaction_idx = gpr_map[gene_idx]\n                current_bounds[reaction_idx] = (0, 0)\n        \n        # Solve the LP\n        res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=current_bounds, method='highs')\n\n        max_biomass_flux = 0.0\n        if res.success:\n            max_biomass_flux = -res.fun\n        \n        # Determine and cache viability\n        viable = max_biomass_flux >= epsilon\n        viability_cache[deleted_genes_tuple] = viable\n        return viable\n\n    # --- Task 1: Evaluate viability for specified gene deletion sets ---\n    deletion_sets_to_test = [\n        [], [0], [1], [2], [3], [0, 2], [0, 3], [1, 2], [1, 3]\n    ]\n    \n    viability_results = []\n    for d_set in deletion_sets_to_test:\n        # Use a sorted tuple as the cache key\n        d_tuple = tuple(sorted(d_set))\n        viability_results.append(is_viable(d_tuple))\n\n    # --- Task 2: Identify all synthetic lethal gene pairs ---\n    num_genes = 4\n    all_genes = range(num_genes)\n    synthetic_lethal_pairs = []\n\n    # Check all pairs of genes {i, j} with i  j\n    for i, j in combinations(all_genes, 2):\n        # A pair is synthetic lethal if single deletions are viable but the double is not.\n        single_i_viable = is_viable((i,))\n        single_j_viable = is_viable((j,))\n        double_ij_viable = is_viable((i, j))\n        \n        if single_i_viable and single_j_viable and not double_ij_viable:\n            synthetic_lethal_pairs.append([i, j])\n\n    # The pairs are already sorted by `itertools.combinations`.\n\n    # --- Final Output Formatting ---\n    # Combine the 9 viability booleans and the list of SL pairs\n    final_output_list = viability_results + [synthetic_lethal_pairs]\n\n    # Format the list to a string with no spaces, as per the example\n    str_results = []\n    for item in final_output_list:\n        # Convert item to string and remove all whitespace\n        str_item = str(item).replace(\" \", \"\")\n        str_results.append(str_item)\n    \n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "2496280"}]}