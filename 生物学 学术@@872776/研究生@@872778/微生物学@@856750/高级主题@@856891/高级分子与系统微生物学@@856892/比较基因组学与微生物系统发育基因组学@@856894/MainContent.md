## 引言
在基因组时代，[比较基因组学](@entry_id:148244)与微生物系统发育基因组学已成为现代微生物学研究的基石，它们赋予我们前所未有的能力，去解读隐藏在DNA序列中的生命演化蓝图。通过比较不同微生物的基因组，我们不仅能识别出赋予它们独特生物学功能的基因，更能追溯它们在数亿年时间长河中的演化足迹。然而，微生物的演化并非简单的线性过程；基因的复制、丢失、以及在不同物种间的水平转移，共同编织了一张错综复杂的演化网络。如何从这海量的基因组数据中理清头绪，准确重构演化历史，是该领域面临的核心挑战。

本文旨在系统性地引导读者深入这一激动人心的领域。我们将分三个章节展开：
*   **第一章：原理与机制**，将奠定理论基础，详细解析[比较基因组学](@entry_id:148244)的基本单元（如直系同源和[旁系同源](@entry_id:174821)）、微生物[泛基因组](@entry_id:149997)的动态，以及构建可靠系统发育树所需的核心方法和模型。
*   **第二章：应用与[交叉](@entry_id:147634)学科联系**，将展示这些原理和方法在解决实际生物学问题时的强大威力，涵盖从[生物信息学](@entry_id:146759)基础、[宏基因组](@entry_id:177424)物种重建，到[病原体进化](@entry_id:176826)追踪和[生命起源](@entry_id:138395)探索等多个[交叉](@entry_id:147634)学科领域。
*   **第三章：实践练习**，将通过一系列精心设计的问题，帮助读者将理论知识转化为解决实际问题的分析技能。

通过这一结构化的学习路径，读者将能够全面掌握从原始数据到深刻演化洞见的分析全流程，并理解这一领域如何持续推动我们对生命世界的认知。

## 原理与机制

### 基因组比较的基本单元：同源及其分类

[比较基因组学](@entry_id:148244)的核心任务是理解基因和基因组在物种形成、[功能分化](@entry_id:171068)和[适应过程](@entry_id:187710)中的演化轨迹。这一任务的基石是**同源 (homology)** 的概念，即指代因[共同祖先](@entry_id:175919)而相关的基因。两个或多个基因共享一个祖先基因，则它们互为同源基因。然而，仅仅判断同源性是不够的。为了精确重建演化历史，我们必须区分由不同演化事件产生的同源关系。主要的演化事件包括**物种形成 (speciation)**、**[基因重复](@entry_id:150636) (gene duplication)** 和**水平基因转移 (horizontal gene transfer, HGT)**。

根据[基因谱系](@entry_id:172451) (gene lineage) 在哪个事件上发生[分歧](@entry_id:193119)，同源基因可以被细分为以下几类：

*   **直系同源基因 (Orthologs)**：这类同源基因的[分歧](@entry_id:193119)事件是**[物种形成](@entry_id:147004)**。当一个祖先物种分化为两个或多个后代物种时，其基因组中的基因也随之分化。存在于不同物种中、由[物种形成](@entry_id:147004)事件直接产生的同源基因互为[直系同源](@entry_id:163003)基因。它们通常在不同物种中保留相似的功能。

*   **旁系同源基因 (Paralogs)**：这类同源基因的[分歧](@entry_id:193119)事件是**基因重复**。在某个物种的基因组内，一个基因被复制，产生了两个或多个副本。这些副本在同一个基因组内[共同演化](@entry_id:151915)，它们之间的关系就是[旁系同源](@entry_id:174821)。[旁系同源基因](@entry_id:263736)为新功能的产生提供了原始材料。根据基因重复事件与特定物种形成事件的相对时间，旁系同源基因还可以进一步分为：
    *   **种内[旁系同源基因](@entry_id:263736) (In-paralogs)**：相对于某个参照物种，如果[基因重复](@entry_id:150636)事件发生在目标物种与参照物种分化**之后**，那么在目标物种中产生的[旁系同源基因](@entry_id:263736)就是种内旁系同源基因。
    *   **种间[旁系同源基因](@entry_id:263736) (Out-paralogs)**：如果基因重复事件发生在目标物种与参照物种分化**之前**，那么产生的旁系同源基因就是种间[旁系同源基因](@entry_id:263736)。

*   **异源同源基因 (Xenologs)**：这类同源关系由**[水平基因转移](@entry_id:145265)**产生。当一个基因从一个物种（供体）的基因组转移到另一个不相关物种（受体）的基因组中时，受体中的新基因与供体中的源基因就构成了异源同源关系。这种关系揭示了非垂直的遗传事件，在微生物演化中尤其普遍。

为了阐明这些定义，我们可以构想一个具体的演化场景 [@problem_id:2483674]。假设存在三个细菌物种 $S_X$, $S_Y$ 和 $S_Z$，它们的物种[演化树](@entry_id:176670)为 $((S_X, S_Y), S_Z)$，意味着 $S_Z$ 最早分化出去，然后 $S_X$ 和 $S_Y$ 从它们的共同祖先分化。一个祖先单拷贝基因经历了以下事件：
1.  在 $S_X$ 和 $S_Y$ 分化**之后**，$S_X$ 谱系中的基因发生了一次重复，产生了两个现存的拷贝 $x_1$ 和 $x_2$。
2.  同样在 $S_X-S_Y$ 分化**之后**，$S_Z$ 谱系中的一个基因拷贝通过[水平基因转移](@entry_id:145265)进入了 $S_Y$ 谱系，产生了 $y_2$。$S_Y$ 中[垂直遗传](@entry_id:271244)的原始拷贝是 $y_1$。$S_Z$ 中保留的拷贝是 $z_1$。

基于这个场景，我们可以确定这些基因之间的关系：
*   $x_1$ 和 $x_2$ 的共同祖先是一个[基因重复](@entry_id:150636)事件，因此它们是**[旁系同源基因](@entry_id:263736)**。由于这次重复发生在 $S_X$ 与 $S_Y$ 分化之后，因此相对于 $S_Y$ 中的基因（如 $y_1$），$x_1$ 和 $x_2$ 互为**种内旁系同源基因**。
*   $x_1$ 和 $y_1$ 的谱系分歧点是 $S_X$ 和 $S_Y$ 的物种形成事件。因此，它们是**直系同源基因**。
*   $y_2$ 和 $z_1$ 的关系较为复杂。$y_2$ 的谱系是通过 HGT 事件从 $S_Z$ 谱系中“嫁接”而来。它们谱系的[分歧](@entry_id:193119)点就是 HGT 事件本身，而非[物种形成](@entry_id:147004)或基因重复。因此，它们是**异源同源基因**。
*   $x_1$ 和 $y_2$ 的关系呢？要追溯它们的[共同祖先](@entry_id:175919)，我们需要将 $x_1$ 的谱系追溯到 $S_X$ 和 $S_Y$ 的共同祖先，再到三个物种的[共同祖先](@entry_id:175919)。同时，将 $y_2$ 的谱系追溯到它在 $S_Z$ 中的来源，再到三个物种的[共同祖先](@entry_id:175919)。它们最近的共同祖先存在于所有三个物种的[共同祖先](@entry_id:175919)中，而它们谱系的[分歧](@entry_id:193119)正是 $S_Z$ 谱系与 ($S_X, S_Y$) 谱系分离的那个古老[物种形成](@entry_id:147004)事件。因此，根据定义，$x_1$ 和 $y_2$ 是**直系同源基因**。这种情况有时被称为“伪[直系同源](@entry_id:163003) (pseudoorthology)”，因为它掩盖了其后发生的 HGT 事件。

### 微生物[泛基因组](@entry_id:149997)：核心、附件及其动态

当我们将视野从单个[基因家族](@entry_id:266446)扩展到整个物种的基因库时，我们进入了[泛基因组学](@entry_id:173769)的领域。对于一个微生物物种而言，其**[泛基因组](@entry_id:149997) (pan-genome)** 指的是该物种所有菌株中发现的[基因家族](@entry_id:266446)的总和。[泛基因组](@entry_id:149997)的概念揭示了微生物物种内部巨大的[遗传多样性](@entry_id:201444)。根据基因在一个物种不同菌株中的[分布](@entry_id:182848)模式，[泛基因组](@entry_id:149997)可以被划分为几个关键部分 [@problem_id:2483721]：

*   **[核心基因组](@entry_id:175558) (Core genome)**：由存在于**所有**被测菌株基因组中的基因家族构成。这些基因通常编码生命活动所必需的基本功能，如[DNA复制](@entry_id:140403)、转录、翻译和核心代谢。

*   **[附件基因组](@entry_id:195062) (Accessory genome)**：也称为可塑性或非[必需基因](@entry_id:200288)组，由存在于**部分而非全部**菌株中的基因家族构成。附件基因赋予了菌株适应特定环境的能力，例如抗生素抗性、[毒力因子](@entry_id:169482)、以及代谢特殊底物的能力。

*   **独特基因 (Unique genes)**：这是一个更细的分类，特指那些仅在**单个**被测菌株中发现的基因。它们是[附件基因组](@entry_id:195062)的一部分，代表了最新获得的基因或正在快速丢失的基因。

随着测序的菌株数量 $N$ 的增加，[泛基因组](@entry_id:149997)的大小 $P(N)$ 也会发生变化。这种动态可以用一个经验性的数学模型来描述，即**希普斯定律 (Heaps' law)** 的一种形式：$P(N) = \kappa N^{\alpha}$，其中 $\kappa$ 是一个正常数，$\alpha$ 是决定[泛基因组](@entry_id:149997)增长行为的关键指数。

[泛基因组](@entry_id:149997)的动态可以分为两类：
*   **[开放泛基因组](@entry_id:198501) (Open pan-genome)**：当不断对新菌株进行测序时，总能发现新的基因家族，[泛基因组](@entry_id:149997)的大小会无限增长。在数学上，这意味着当 $N \to \infty$ 时，$P(N) \to \infty$。这种情况在上述模型中对应于**$\alpha > 0$**。即使 $\alpha$ 很小（例如 $0  \alpha  1$），增长是亚线性的，但总规模依然是无界的。具有[开放泛基因组](@entry_id:198501)的物种通常生活在多样的环境中，并且拥有高效的[水平基因转移](@entry_id:145265)机制。

*   **封闭[泛基因组](@entry_id:149997) (Closed pan-genome)**：测序足够多的菌株后，新基因的发现速率会趋近于零，[泛基因组](@entry_id:149997)的大小会收敛到一个有限的常数。这在模型中对应于**$\alpha \le 0$**。具有封闭[泛基因组](@entry_id:149997)的物种通常是那些生活在隔离或高度稳定环境中的专性寄生菌或共生菌。

因此，通过拟合菌株数量 $N$ 与[泛基因组](@entry_id:149997)大小 $P(N)$ 的关系曲线，并估计指数 $\alpha$ 的值，我们可以判断一个微生物物种的基因库是开放的还是封闭的，从而洞察其生态策略和[演化潜力](@entry_id:200131)。

### 量化整体基因组相似性：[平均核](@entry_id:746606)苷酸同一性

在界定微生物物种时，我们需要一个能够精确量化两个基因组之间整体相似性的指标。**[平均核](@entry_id:746606)苷酸同一性 (Average Nucleotide Identity, ANI)** 已成为现代[微生物分类](@entry_id:173287)学的“金标准”。ANI 的核心思想是计算两个基因组在所有共享的[直系同源](@entry_id:163003)区域的[核苷酸](@entry_id:275639)序列的平均一致性。

要从第一性原理理解 ANI 的计算，我们首先定义单个比对区域的同一性 $I$ 为相同[核苷酸](@entry_id:275639)位点的数量除以总比对长度。当比较两个基因组时，我们会得到多个不重叠的同源比对块。ANI 的计算必须反映总的相同[核苷酸](@entry_id:275639)数量相对于总的比对长度，而不是简单地对每个比对块的同一性值取平均 [@problem_id:2483727]。

具体来说，假设我们有 $n$ 个符合条件的同源比对块，对于第 $i$ 个比对块，其长度为 $L_i$，[核苷酸](@entry_id:275639)同一性为 $I_i$。该比对块中相同的[核苷酸](@entry_id:275639)数量为 $I_i L_i$。那么，总的相同[核苷酸](@entry_id:275639)数量就是 $\sum_{i=1}^{n} I_i L_i$，而总的比对长度是 $\sum_{i=1}^{n} L_i$。因此，ANI 的计算公式为：

$$ \text{ANI} = \frac{\sum_{i=1}^{n} I_i L_i}{\sum_{i=1}^{n} L_i} $$

这个公式本质上是一个**加权算术平均**，其中每个比对块的同一性 $I_i$ 的权重是其自身的长度 $L_i$。这种加权是必要的，因为它确保了长的、信息量大的比对区域对最终结果的贡献更大，而短的、可能由随机匹配产生的区域贡献较小，从而使 ANI 成为一个稳健的、能反映全基因组水平相似性的指标。

在实践中，ANI 值通常与一个经验阈值进行比较，以界定物种。一个广泛接受的标准是，如果两个菌株基因组之间的 ANI 值**大于或等于 $0.95$ 到 $0.96$**，它们就被认为属于同一个物种。例如，如果通过计算发现两个基因组的 ANI 值为 $0.9570$，这个值超过了 $0.95$ 的阈值，我们就有充分的基因组学证据将它们划分为同一个物种 [@problem_id:2483727]。

### 推断演化历史：[系统发育](@entry_id:137790)基因组学的原理

[系统发育](@entry_id:137790)[基因组学](@entry_id:138123)旨在利用[全基因组](@entry_id:195052)信息来重建[生命之树](@entry_id:139693)。这涉及到复杂的模型和方法，因为微生物的演化并非总是简单的树状[分叉](@entry_id:270606)。

#### 树与网：演化历史的表达

传统的**系统发育树 (phylogenetic tree)** 是一个强大的模型，用于描述**[垂直遗传](@entry_id:271244) (vertical descent)**，即遗传物质从亲代传递到子代的过程。在图论中，一个有根系统发育树是一个有向无环图，其中根节点入度为0，所有内部节点的入度为1，[出度](@entry_id:263181)至少为2。从根到每个叶节点（代表现存物种）都有唯一的路径。

然而，微生物的演化充满了**网状演化 (reticulate evolution)** 事件，如[水平基因转移](@entry_id:145265)（HGT）和杂交，这些事件破坏了严格的树状结构。为了同时容纳垂直和水平的遗传事件，我们需要一个更普适的结构——**[系统发育网络](@entry_id:166650) (phylogenetic network)** [@problem_id:2483680]。

一个有根[系统发育网络](@entry_id:166650)同样是一个**[有向无环图 (DAG)](@entry_id:748452)**，以保证时间的一致性（即一个谱系不能是其自身的祖先）。与树的关键区别在于，网络允许存在**入度大于1**的节点，这些节点被称为**网状节点 (reticulation nodes)**。一个网状节点代表一个谱系从两个或多个亲本谱系接收了遗传物质，精确地模拟了 HGT 或杂交事件。因此，当不同的基因（例如，来自[核心基因组](@entry_id:175558)的基因和来自 HGT 的基因）支持相互冲突的树状拓扑时，一个[系统发育网络](@entry_id:166650)是唯一能够同时解释这些冲突信号的最小结构。

#### 主要的[系统发育推断](@entry_id:182186)方法

重建[系统发育树](@entry_id:140506)或网络需要复杂的计算方法。目前主流的方法可以分为几大类，它们基于不同的优化目标和统计哲学 [@problem_id:2483730]。

*   **基于距离的方法 (Distance-based methods)**：这类方法首先将序列比对数据转化为一个**[距离矩阵](@entry_id:165295)**，矩阵中的每个元素代表一对物种之间的[演化距离](@entry_id:177968)。然后，算法试图构建一棵树，使得树上节点间的路径长度能够最好地拟合这个[距离矩阵](@entry_id:165295)。
    *   **[邻接法](@entry_id:163788) (Neighbor-Joining, NJ)** 是最经典的距离法。它是一个贪心算法，在每一步迭代中，它会选择一对节点（或分类单元）进行合并，使得新生成的树的总枝长最小化。这个标准与**最小演化 (minimum evolution)** 原则是一致的。NJ 算法本身不提供对分支的[置信度](@entry_id:267904)评估。其不确定性通常通过**非[参数自举](@entry_id:178143)法 (nonparametric bootstrap)** 来量化：通过对原始序列比对的列进行有放回的[重采样](@entry_id:142583)，生成数百个伪数据集，对每个伪数据集运行 NJ 得到一棵树，最终某个分支的支持率就是它在所有自举树中出现的频率。

*   **基于特征的[概率方法](@entry_id:197501) (Character-based probabilistic methods)**：这类方法直接作用于[序列比对](@entry_id:172191)中的每个字符（如[核苷酸](@entry_id:275639)或氨基酸），并基于一个明确的演化模型来评估不同树形的优劣。
    *   **最大似然法 (Maximum Likelihood, ML)**：ML 的目标是找到一个[树拓扑](@entry_id:165290) $T$ 和一组模型参数 $\Theta$（包括枝长和[替换模型](@entry_id:177799)参数），使得观察到[序列数据](@entry_id:636380) $D$ 的概率（即**似然值** $L(T, \Theta) = p(D \mid T, \Theta)$）最大化。这是一个计算密集型的[优化问题](@entry_id:266749)。与 NJ 类似，ML 本身只给出一个最优的[点估计](@entry_id:174544)（最佳树），其[分支支持度](@entry_id:201765)也通常通过[自举法](@entry_id:139281)或近似[似然比检验](@entry_id:268070)（aLRT）等方法来评估。
    *   **贝叶斯推断 (Bayesian Inference)**：贝叶斯方法的目标不是找到单个最优树，而是推断树和模型参数的**后验概率[分布](@entry_id:182848)** $p(T, \Theta \mid D)$。根据贝叶斯定理，$p(T, \Theta \mid D) \propto p(D \mid T, \Theta) p(T, \Theta)$，即后验概率正比于似然值与**先验概率** $p(T, \Theta)$ 的乘积。计算这个[分布](@entry_id:182848)通常采用**[马尔可夫链蒙特卡洛](@entry_id:138779) (Markov Chain [Monte Carlo](@entry_id:144354), MCMC)** 的数值模拟方法。[贝叶斯推断](@entry_id:146958)的优势在于，不确定性的量化是其内在的组成部分。一个分支的**后验概率**就是它在 MCMC 采样得到的树集合中出现的频率，而模型参数（如枝长、[替换速率](@entry_id:150366)）的不确定性则通过其后验分布的**可信区间 (credible intervals)** 来表示。

### 微[生物系统](@entry_id:272986)发育基因组学的挑战与陷阱

在微生物世界中，重建精确的演化历史充满了挑战。多种生物学过程和方法论上的陷阱都可能导致错误的结论。

#### 基因交换的[光谱](@entry_id:185632)：HGT 与同源重组

基因的水平转移并非铁板一块，其机制和对[系统发育分析](@entry_id:172534)的影响存在巨大差异。我们需要明确区分两种主要的基因交换形式 [@problem_id:2483701]：

*   **非同源 HGT**：指受体菌获得全新的、其祖先基因组中所没有的基因。这些基因通常形成“基因岛”，在基因组中具有可识别的边界。这类事件主要影响**基于基因含量的[系统发育分析](@entry_id:172534)**。例如，在一个基于基因有无（presence/absence）构建的[距离矩阵](@entry_id:165295)中，从物种 $C$ 到 $A$ 的非同源 HGT 会使 $A$ 和 $C$ 共享一些原本 $A$ 没有的基因，从而人为地**降低**了它们之间的基因含量距离（如[汉明距离](@entry_id:157657)），可能导致它们在树中被错误地[聚类](@entry_id:266727)。此外，由于这些外来基因岛可能来自亲缘关系很远的物种，它们的碱[基组](@entry_id:160309)成（如[GC含量](@entry_id:275315)）和[密码子使用偏好](@entry_id:143761)通常与宿主基因组存在显著差异，因此可以通过**基因组成偏离检测**的方法来识别。

*   **同源重组 (Homologous Recombination, HR)**：指受体菌基因组中的一个基因（或其片段）被来自供体的同源等位基因所替换。这个过程不改变基因的有无，但会改变基因的序列。因此，HR 主要影响**基于核心[基因序列](@entry_id:191077)的[系统发育分析](@entry_id:172534)**。一个发生了 HR 的核心基因，其基因树拓扑可能会反映供体和受体之间的亲缘关系，而不是物种本身的演化历史。如果一个物种（如 $A$）与一个远亲（如 $C$）之间发生了频繁的 HR，那么其基因组中将有相当一部分[基因树](@entry_id:143427)支持错误的拓扑 $((A,C),B)$，而不是真实的[物种树](@entry_id:147678) $((A,B),C)$。这会干扰基于多基因投票或[串联](@entry_id:141009)分析的[物种树推断](@entry_id:185386)。

#### [不完全谱系分选](@entry_id:141497)与方法论对策

即使在严格[垂直遗传](@entry_id:271244)的情况下，[基因树](@entry_id:143427)也未必与物种树一致。**[不完全谱系分选](@entry_id:141497) (Incomplete Lineage Sorting, ILS)** 是一个主要原因。当[物种形成](@entry_id:147004)事件发生得非常迅速时（即[物种树](@entry_id:147678)的内部分支很短），祖先物种中的多态性等位基因可能来不及在分化前完全固定。这些等位基因会随机地“分选”到后代物种中，导致某些基因的演化历史（[基因树](@entry_id:143427)）与物种的分化历史（[物种树](@entry_id:147678)）不符。

处理 ILS 有两种主流的系统发育[基因组学](@entry_id:138123)策略 [@problem_id:2483690]：

*   **[串联](@entry_id:141009)法 (Concatenation / Supermatrix)**：这是最直接的方法，将所有基因的比对序列首尾相连，形成一个巨大的“超级矩阵”，然后用 ML 或贝叶斯方法为这个超级矩阵推断一棵树。这种方法隐含地假设所有基因共享同一棵演化树，这在存在 ILS 的情况下是错误的。

*   **总结合并法 (Summary methods)**：这类方法分两步进行。首先，为每个独立的基因推断一棵[基因树](@entry_id:143427)。然后，使用一个特定的算法（如 **ASTRAL**）来“合并”这些[基因树](@entry_id:143427)，找到与这组[基因树](@entry_id:143427)最一致的物种树。这类方法明确承认基因树之间可能存在冲突。

这两种方法的统计学特性有天壤之别。在某些特定的演化条件下，即所谓的**异常[基因树](@entry_id:143427)区域 (Anomalous Gene Tree, AGT zone)**——由于极短的内部分支导致与物种树拓扑不一致的[基因树](@entry_id:143427)反而成为最常见的基因树类型——[串联](@entry_id:141009)法被证明是**统计不一致的**，即随着基因数量的增加，它会以越来越高的置信度收敛到一棵错误的树。相反，像 ASTRAL 这样的基于[溯祖理论](@entry_id:155051)的合并法，在这些条件下仍然是**统计一致的**，能够正确推断物种树。

然而，值得注意的是，无论是[串联](@entry_id:141009)法还是 ASTRAL，它们的理论保证都建立在 ILS 是基因树冲突的唯一来源这一假设之上。一旦存在其他过程，如 HGT 或[基因重复与丢失](@entry_id:194933)（GDL），两种方法的模型都被错误指定 (model-misspecified)，其结果的准确性都无法得到保证 [@problem_id:2483690]。

#### 模型错误指定：基因组成[异质性](@entry_id:275678)的案例

所有基于概率的[系统发育](@entry_id:137790)方法都依赖于一个数学模型来描述序列演化。如果使用的模型与真实的演化过程严重不符，就会导致系统性的推断错误。一个经典的例子是**基因组成异质性 (compositional heterogeneity)** 的问题 [@problem_id:2483655]。

标准的[替换模型](@entry_id:177799)，如 GTR 模型，通常假设[演化过程](@entry_id:175749)是**平稳的 (stationary)**，即序列的平衡碱基频率（由向量 $\pi$ 描述）在整个演化树的所有谱系中都是恒定的。然而，在真实数据中，不同谱系可能演化出不同的碱基[组成偏好](@entry_id:174591)（例如，一些谱系趋向于富含 GC，而另一些则富含 AT）。这种跨谱系的[平衡频率](@entry_id:275072)差异就是基因组成[异质性](@entry_id:275678)。

当使用一个平稳的（同质的）模型来分析具有基因组成异质性的数据时，会产生一种称为**[长枝吸引](@entry_id:141763) (Long-Branch Attraction, LBA)** 的著名[系统发育](@entry_id:137790)陷阱。其机制如下：在一条很长的演化枝上，序列有足够的时间达到其谱系特有的平衡组成。如果两个没有[亲缘关系](@entry_id:172505)的谱系（即它们在树上的位置相距很远）恰好独立演化出了相似的碱[基组](@entry_id:160309)成（例如，都变得富含 AT），并且它们各自的演化枝都很长，那么它们的序列之间会因为[趋同演化](@entry_id:263490)而共享大量相同的碱基。一个错误的平稳模型无法识别这种趋同性，它会错误地将这些共享的碱基解释为源于[共同祖先](@entry_id:175919)的信号（同源），从而最大化一个将这两条长枝错误地聚集在一起的[树拓扑](@entry_id:165290)的似然值。这导致了亲缘关系远的物种被错误地推断为姐妹群。

### 分子钟定年：校准[生命之树](@entry_id:139693)

[系统发育树](@entry_id:140506)的枝长通常以每位点替换数来衡量。要将这些[演化距离](@entry_id:177968)转化为[绝对时间](@entry_id:265046)（如百万年），我们需要一个**分子钟 (molecular clock)**。

#### [严格分子钟](@entry_id:183441)及其失效

**[严格分子钟](@entry_id:183441) (strict molecular clock)** 假设在所有演化谱系中，[核苷酸](@entry_id:275639)或氨基酸的[替换速率](@entry_id:150366) $r$（单位：替换数/位点/单位日历时间）是恒定的 [@problem_id:2483728]。如果这个假设成立，那么从根节点到所有现存物种的[演化距离](@entry_id:177968)都应该相等，这样的树被称为**[超度量树](@entry_id:168934) (ultrametric tree)**。枝长（距离）$d_i$ 与时间 $t_i$ 的关系可以简单地表示为 $t_i = d_i / r$。

然而，在微生物中，[严格分子钟](@entry_id:183441)的假设经常被违背。其失效的原因多种多样：
*   **世代时间效应 (Generation time effect)**：根据[中性演化](@entry_id:172700)理论，每个世代的[替换速率](@entry_id:150366)约等于每个世代的[突变率](@entry_id:136737) $\mu$。因此，以日历时间（如年）为单位的[替换速率](@entry_id:150366) $r$ 取决于[世代时间](@entry_id:173412) $g$ 的长短，即 $r = \mu / g$。世代时间差异巨大的微生物（例如，一个世代时间为0.5小时，另一个为12小时），即使它们的代际[突变率](@entry_id:136737)相同，其年际[替换速率](@entry_id:150366)也会有天壤之别 [@problem_id:2483728]。
*   **[有效种群大小](@entry_id:146802) ($N_e$) 的影响**：根据近[中性演化](@entry_id:172700)理论，对于那些具有微弱选择效应（特别是微弱有害）的突变，它们的[固定概率](@entry_id:178551)受到[有效种群大小](@entry_id:146802) $N_e$ 的影响。在 $N_e$ 较小的种群中，[纯化选择](@entry_id:170615)的效率较低，一些微弱有害的突变可能像[中性突变](@entry_id:176508)一样被固定，从而提高[替换速率](@entry_id:150366)。因此，[有效种群大小](@entry_id:146802)不同的谱系可能具有不同的[替换速率](@entry_id:150366)。
*   **时间依赖的速率 (Time-dependent rates)**：观察到的[替换速率](@entry_id:150366)似乎会随着观察时间尺度的变化而变化。在很短的时间尺度上（如种群内部），观察到的[分歧](@entry_id:193119)包含了大量尚未被纯化选择清除的微弱有害突变，因此速率显得较高。而在漫长的时间尺度上（如物种间），这些有害突变大多已被清除，[替换速率](@entry_id:150366)主要反映[中性突变](@entry_id:176508)的固定，因此速率较低。如果在深度的演化时间尺度上校准了一个较低的速率 $r$，然后用它来估算一个近期分歧事件的时间，将会导致时间被高估 [@problem_id:2483728]。
*   **[水平基因转移](@entry_id:145265)**：如前所述，HGT 和 HR 都会引入与宿主谱系历史不符的基因，从而在基因组尺度上扰乱任何简单的速率模式 [@problem_id:2483728]。

#### 驰豫分子钟

为了克服[严格分子钟](@entry_id:183441)的局限性，研究者们发展了**驰豫分子钟 (relaxed molecular clocks)**。这类模型允许[替换速率](@entry_id:150366)在树的不同分支上发生变化 [@problem_id:2483661]。

*   **不相关对数正态 (UCLN) 驰豫钟**：这是最常用的一种驰豫钟模型。它假设每个分支的速率 $r_b$ 都是从一个共同的**对数正态分布**中独立抽取的。这意味着速率的对数 $\ln(r_b)$ 服从一个[正态分布](@entry_id:154414) $\mathcal{N}(\mu, \sigma^2)$。$\mu$ 控制了[平均速率](@entry_id:147100)的对数值，而 $\sigma^2$ 则描述了速率在不同分支间的变异程度。

在贝叶斯框架下（如在 BEAST 软件中），分支特异的速率 $r_b$ 作为模型参数被估计出来。其后验分布综合了来自序列数据的似然信息（通过枝长 $\ell_b = r_b \tau_b$ 体现）和来自[对数正态分布](@entry_id:261888)的[先验信息](@entry_id:753750)。值得注意的是，如果没有外部的时间校准信息（如已知采样时间的叶节点，即**叶尖定年 (tip-dating)**，或[化石校准](@entry_id:261585)点），速率和时间是不可区分的，[绝对时间](@entry_id:265046)无法被估计 [@problem_id:2483661]。

在处理多基因数据时，可以采用不同的分区策略。我们可以为整个[串联](@entry_id:141009)比对只分配一个 UCLN 钟模型，这假设所有基因在同一分支上的速率变化是协同的（例如，由超突变表型引起的[全基因组](@entry_id:195052)速率提升）。或者，我们也可以为每个基因分区分配一个独立的 UCLN 钟模型，这允许每个基因在每个分支上都有自己独特的速率，但这种模型参数极多，容易[过拟合](@entry_id:139093)，需要更强的先验知识来约束 [@problem_id:2483661]。通过对速率变异的建模，驰豫钟为在复杂的微生物数据中进行更准确的[分子钟](@entry_id:141071)定年提供了可能。