{"hands_on_practices": [{"introduction": "在任何定量稳定同位素探测（SIP）分析中，重同位素的原子分数是量化标记掺入的核心指标。本练习旨在巩固原子分数的基本定义及其从常见的原子百分比数据转换而来的计算方法[@problem_id:2534056]。掌握这一基础计算是进行更复杂同位素混合与稀释建模的先决条件。", "problem": "在微生物生态学中的定量稳定同位素探针（SIP）技术中，同位素组成通常由分子库中重同位素的原子分数来概括（例如，核糖体核糖核酸或脱氧核糖核酸中作为碳-13的碳原子所占的比例）。考虑一个均匀样品，其中含有总共 $N$ 个某给定元素的原子，该元素以两种确切的稳定同位素形式存在：一种轻同位素和一种重同位素。设 $n_{L}$ 表示轻同位素的原子数，$n_{H}$ 表示重同位素的原子数。假设 $N$ 是特定同位素原子数的总和，并且样品混合均匀，因此原子数与摩尔数成正比。\n\n仅从原子计数和原子守恒的核心定义出发，推导一个用 $n_{H}$ 和 $n_{L}$ 表示的重同位素原子分数的通用表达式。然后，将报告为样品整体碳中按原子计为 $1.1\\%$ 碳-13的测量组成解释为原子分数，并计算碳-13的重同位素原子分数。将最终数值表示为一个纯小数（无单位），并将您的答案四舍五入到 $4$ 位有效数字。", "solution": "首先对问题陈述进行严格验证，以确保其科学和逻辑上的完整性。\n\n已知条件逐字提取如下：\n- 一个均匀样品含有总共 $N$ 个某给定元素的原子。\n- 该元素以两种确切的稳定同位素形式存在：轻同位素和重同位素。\n- $n_{L}$ 是轻同位素的原子数。\n- $n_{H}$ 是重同位素的原子数。\n- $N$ 是特定同位素原子数的总和。这被解释为原子守恒，因此 $N = n_{L} + n_{H}$。\n- 一个测量得到的组成报告为按原子计 $1.1\\%$ 的碳-13。\n- 最终数值必须是四舍五入到 $4$ 位有效数字的纯小数。\n\n根据有效性标准对问题进行评估。发现该问题具有科学依据，因为它涉及同位素、原子计数和原子分数等基本概念，这些是化学和同位素生态学的基石。该问题提法恰当，为得到唯一解提供了所有必要的定义和数据。语言客观，没有歧义。例如，“按原子计”的陈述明确了百分比的基准，将其与基于质量的百分比区分开来。这个情景是现实的；碳-13是碳的一种稳定重同位素，其自然丰度约为 $1.1\\%$。该问题不违反任何基本原则，也不包含矛盾或不完整的信息。因此，该问题被认为是有效的，并将构建一个解决方案。\n\n任务是双重的：首先，推导重同位素原子分数的通用表达式；其次，根据所提供的数据计算碳-13的该值。\n\n第1部分：通用表达式的推导。\n混合物中特定组分的原子分数定义为该组分的原子数与混合物中总原子数的比率。设 $F_{H}$ 表示重同位素的原子分数。根据这个核心定义，我们写出：\n$$F_{H} = \\frac{\\text{重同位素的原子数}}{\\text{元素总原子数}}$$\n使用问题陈述中提供的符号，重同位素的原子数为 $n_{H}$，元素的总原子数为 $N$。因此，表达式变为：\n$$F_{H} = \\frac{n_{H}}{N}$$\n问题陈述指出，总原子数 $N$ 是特定同位素原子数的总和。这是对系统原子守恒原理的明确陈述。因此，我们有以下关系：\n$$N = n_{H} + n_{L}$$\n将这个 $N$ 的表达式代入我们关于 $F_{H}$ 的方程中，我们得到用重同位素和轻同位素的原子数表示的重同位素原子分数的通用表达式：\n$$F_{H} = \\frac{n_{H}}{n_{H} + n_{L}}$$\n这个推导从定义分数的第一性原理出发，并按要求结合了原子守恒。\n\n第2部分：碳-13的计算。\n问题提供了一个按原子计为 $1.1\\%$ 碳-13的测量组成。碳-13 ($^{13}C$) 是碳的重稳定同位素，而碳-12 ($^{12}C$) 是其轻稳定同位素。给定值 $1.1\\%$ 是以百分比为单位表示的原子分数（即原子百分比）。“按原子计”的说明证实了这不是质量百分比。\n要将百分比转换为无量纲分数，必须除以 $100$。\n设 $F_{^{13}C}$ 为碳-13的原子分数。\n$$F_{^{13}C} = 1.1\\% = \\frac{1.1}{100}$$\n计算很简单：\n$$F_{^{13}C} = 0.011$$\n问题要求将此结果表示为四舍五入到 $4$ 位有效数字的纯小数。\n数字 $0.011$ 有两位有效数字（两个数字'1'）。前导零不计为有效数字，因为它仅用于定位小数点。为了用 $4$ 位有效数字表示该值，我们必须在末尾添加两个零。这些尾随零是有效的，因为它们表明了该值的精度。\n因此，四舍五入到 $4$ 位有效数字的碳-13原子分数为 $0.01100$。", "answer": "$$\n\\boxed{0.01100}\n$$", "id": "2534056"}, {"introduction": "稳定同位素探测的核心原理是依据分子浮力密度的差异进行分离。本练习将通过一个公认的线性模型，演示如何基于两个关键因素——DNA的内在生物学属性（鸟嘌呤-胞嘧啶含量）和实验标记的程度（$^{13}\\mathrm{C}$原子分数）——来预测其最终的浮力密度[@problem_id:2534014]。理解这一模型有助于我们从物理层面把握SIP分离过程，并为后续从密度数据反推同位素掺入程度奠定基础。", "problem": "在用于脱氧核糖核酸（DNA）稳定同位素探针（SIP）技术的氯化铯平衡密度梯度中，等密度平衡时的浮力密度取决于DNA所受净浮力为零时的溶液密度。微生物生态学中的定量解释基于两个经过充分检验的事实：(i) 在固定的温度和氯化铯（CsCl）离子强度下，DNA的浮力密度随鸟嘌呤+胞嘧啶摩尔分数的增加而近似线性增加，这是因为与鸟嘌呤和胞嘧啶相关的更高的平均偏比容和每碱基对质量会改变平衡密度；(ii) 在稀释取代和理想混合的假设下，增加分子质量的同位素取代（例如，用碳-13替代碳-12）会使浮力密度近似线性增加，其增加量与DNA碳库中重同位素的原子分数成正比。这些线性依赖关系可以通过以下参数进行参数化：在鸟嘌呤+胞嘧啶分数为零和自然同位素丰度下的基线DNA浮力密度、相对于鸟嘌呤+胞嘧啶摩尔分数的斜率，以及相对于碳-13原子分数的斜率。\n\n现为您提供在实验温度下，于CsCl中获得的DNA的以下经验校准参数：基线密度 $\\rho_{0}=1.660~\\mathrm{g~ml^{-1}}$，鸟嘌呤+胞嘧啶斜率 $k_{\\mathrm{GC}}=0.098~\\mathrm{g~ml^{-1}}$ 每单位鸟嘌呤+胞嘧啶摩尔分数，以及同位素斜率 $\\alpha=0.036~\\mathrm{g~ml^{-1}}$ 每单位 ${}^{13}\\mathrm{C}$ 原子分数。考虑一个鸟嘌呤+胞嘧啶摩尔分数为 $x_{\\mathrm{GC}}=0.60$ 的微生物基因组，在 ${}^{13}\\mathrm{C}$ 标记的底物上培养后，其DNA中 ${}^{13}\\mathrm{C}$ 的碳原子分数为 $f_{H}=0.30$。\n\n使用上述合理的线性响应框架，确定该DNA的预期浮力密度，单位为 $\\mathrm{g~ml^{-1}}$。将您的最终答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，将对问题进行验证。\n\n首先，我将逐字提取问题陈述中的已知条件。\n- 在鸟嘌呤+胞嘧啶分数为零和自然同位素丰度下的基线DNA浮力密度，$\\rho_{0}=1.660~\\mathrm{g~ml^{-1}}$。\n- 鸟嘌呤+胞嘧啶斜率，$k_{\\mathrm{GC}}=0.098~\\mathrm{g~ml^{-1}}$ 每单位鸟嘌呤+胞嘧啶摩尔分数。\n- ${}^{13}\\mathrm{C}$的同位素斜率，$\\alpha=0.036~\\mathrm{g~ml^{-1}}$ 每单位 ${}^{13}\\mathrm{C}$ 原子分数。\n- 微生物基因组的鸟嘌呤+胞嘧啶摩尔分数，$x_{\\mathrm{GC}}=0.60$。\n- 培养后DNA碳库中 ${}^{13}\\mathrm{C}$ 的原子分数，$f_{H}=0.30$。\n- 浮力密度、鸟嘌呤+胞嘧啶摩尔分数和同位素取代之间的关系被描述为一个线性模型。\n- 最终答案必须四舍五入到四位有效数字。\n\n接下来，我将基于这些提取的已知条件来验证问题。\n1.  **科学依据**：该问题描述了一个简化但基本正确的DNA在氯化铯梯度中浮力密度的模型，这是一种分子生物学和微生物生态学中的标准技术，称为稳定同位素探针（SIP）。浮力密度对G+C含量和重同位素掺入的线性依赖关系是用于定量分析的广为接受的近似方法。所提供的参数值在此实验背景下是物理上现实的。该问题在科学上是合理的。\n2.  **适定性**：该问题提供了一个清晰的数学框架——一个线性模型——以及计算浮力密度单一、唯一值所需的所有必要参数。该问题是适定的。\n3.  **客观性**：该问题以精确、定量和客观的术语陈述。没有主观或基于意见的陈述。该问题是客观的。\n4.  **完整性与一致性**：该问题是自洽的。它提供了应用所述线性模型所需的所有常数和变量。没有矛盾之处。\n5.  **现实性与可行性**：所描述的条件是DNA-SIP实验的标准条件。$60\\%$的G+C含量在细菌中很常见，而$30\\%$的${}^{13}\\mathrm{C}$原子分数在实验室培养中是可以实现的。该问题是现实的。\n6.  **其他缺陷**：该问题并非微不足道，因为它需要正确应用一个多变量线性模型。它不是隐喻性的、不适定的或无法验证的。\n\n结论是该问题有效。我现在将继续进行解答。\n\n问题陈述指出，浮力密度$\\rho$是鸟嘌呤+胞嘧啶摩尔分数$x_{\\mathrm{GC}}$和重同位素${}^{13}\\mathrm{C}$原子分数$f_{H}$的线性函数。该模型可以表示为相对于基线密度$\\rho_0$的效应的线性叠加。这种线性模型的一般形式是：\n$$\n\\rho(x_{\\mathrm{GC}}, f_{H}) = \\rho_{0} + \\Delta\\rho_{\\mathrm{GC}} + \\Delta\\rho_{\\mathrm{iso}}\n$$\n其中 $\\Delta\\rho_{\\mathrm{GC}}$ 是由鸟嘌呤+胞嘧啶含量引起的密度偏移，$\\Delta\\rho_{\\mathrm{iso}}$ 是由同位素标记引起的密度偏移。\n\n根据问题描述，这些偏移与其各自的控制变量成正比，比例常数是给定的斜率 $k_{\\mathrm{GC}}$ 和 $\\alpha$。\n来自鸟嘌呤+胞嘧啶含量的贡献是：\n$$\n\\Delta\\rho_{\\mathrm{GC}} = k_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}}\n$$\n来自同位素取代的贡献是：\n$$\n\\Delta\\rho_{\\mathrm{iso}} = \\alpha \\cdot f_{H}\n$$\n综合这些项，浮力密度 $\\rho$ 的完整方程是：\n$$\n\\rho(x_{\\mathrm{GC}}, f_{H}) = \\rho_{0} + k_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}} + \\alpha \\cdot f_{H}\n$$\n现在，我将把提供的数值代入这个方程。\n给定的值为：\n- $\\rho_{0} = 1.660~\\mathrm{g~ml^{-1}}$\n- $k_{\\mathrm{GC}} = 0.098~\\mathrm{g~ml^{-1}}$\n- $x_{\\mathrm{GC}} = 0.60$\n- $\\alpha = 0.036~\\mathrm{g~ml^{-1}}$\n- $f_{H} = 0.30$\n\n计算过程如下：\n$$\n\\rho = 1.660 + (0.098 \\cdot 0.60) + (0.036 \\cdot 0.30)\n$$\n首先，计算各个部分的贡献：\n来自G+C含量的贡献是：\n$$\nk_{\\mathrm{GC}} \\cdot x_{\\mathrm{GC}} = 0.098 \\cdot 0.60 = 0.0588\n$$\n来自同位素标记的贡献是：\n$$\n\\alpha \\cdot f_{H} = 0.036 \\cdot 0.30 = 0.0108\n$$\n现在，将这些贡献与基线密度相加：\n$$\n\\rho = 1.660 + 0.0588 + 0.0108\n$$\n$$\n\\rho = 1.7188 + 0.0108\n$$\n$$\n\\rho = 1.7296~\\mathrm{g~ml^{-1}}\n$$\n问题要求最终答案四舍五入到四位有效数字。计算值为$1.7296$。前四位有效数字是$1$、$7$、$2$和$9$。第五位数字是$6$，大于或等于$5$，所以我们将第四位数字向上取整。\n$$\n\\rho \\approx 1.730~\\mathrm{g~ml^{-1}}\n$$\n最终计算出的浮力密度是 $1.730~\\mathrm{g~ml^{-1}}$。", "answer": "$$\\boxed{1.730}$$", "id": "2534014"}, {"introduction": "在SIP实验之后，我们获得的数据是特定微生物的DNA在密度梯度中各组分的丰度分布。本练习提供了一个实践性的计算任务，旨在通过实现一个核心的定量SIP（qSIP）算法，来处理这类原始数据[@problem_id:2533985]。通过计算DNA丰度分布的质心，我们将能够量化标记所引起的密度漂移，并最终推算出DNA中$^{13}\\mathrm{C}$的原子分数超额（AFE），完成从实验数据到生理学参数的关键一步。", "problem": "您将获得一份来自氯化铯 (Cesium Chloride (CsCl)) 中脱氧核糖核酸 (Deoxyribonucleic Acid (DNA)) 稳定同位素探测 (Stable Isotope Probing (SIP)) 实验的数据，该数据包含单个操作分类单元 (Operational Taxonomic Unit (OTU)) 在等密度梯度离心各组分中的丰度。对于每个测试用例，您都会得到在同一组浮力密度下的两种丰度分布：一种分布来自未标记的对照 DNA 样本，另一种来自标记的 DNA 处理样本。您的任务是实现计算每个分布在密度空间中的质心，根据 DNA 中碳-13 的原子分数超额 (Atom Fraction Excess (AFE)) 来解释质心位移，并以小数形式输出 AFE。\n\n请使用以下基本原理：\n- 对于具有密度坐标 $\\rho$ 和非负权重函数 $w(\\rho)$ 的连续分布，其质心 (center of mass (COM)) 的定义为：\n$$\\rho_{\\mathrm{COM}} \\;=\\; \\dfrac{\\int \\rho\\, w(\\rho)\\, d\\rho}{\\int w(\\rho)\\, d\\rho}.$$\n- 对于由 $i$ 索引的离散组分，其浮力密度为 $\\rho_i$，非负丰度为 $a_i$，通过黎曼和来近似积分，得到离散质心：\n$$\\rho_{\\mathrm{COM}} \\;=\\; \\dfrac{\\sum_i \\rho_i\\, a_i}{\\sum_i a_i}.$$\n- 在恒定温度的氯化铯 DNA 梯度中，由碳-13 标记引起的浮力密度位移与 DNA 中碳-13 的原子分数超额近似成线性关系。令 $k$ 表示比例常数（每单位原子分数超额的密度位移）。使用 $k = 0.036$，单位为每单位 AFE $\\mathrm{g}\\,\\mathrm{mL}^{-1}$：\n$$\\Delta \\rho \\;=\\; k \\cdot \\mathrm{AFE}.$$\n假设未标记和已标记的测量值均指同一 OTU，因此鸟嘌呤+胞嘧啶含量是恒定的，在计算差值时会被抵消。\n\n算法任务：\n1. 对于每个测试用例，使用上述离散公式计算未标记样本的质心 $\\rho_{\\mathrm{U}}$ 和标记样本的质心 $\\rho_{\\mathrm{L}}$。其中，$\\rho_i$ 是以 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$ 为单位的浮力密度，$a_i$ 是非负丰度（任意单位）。\n2. 计算密度位移 $\\Delta \\rho = \\rho_{\\mathrm{L}} - \\rho_{\\mathrm{U}}$，单位为 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$。\n3. 计算原子分数超额 $\\mathrm{AFE} = \\Delta \\rho / k$（无量纲）。\n4. 由于测量噪声的存在，AFE 的负数估算值在物理上是不允许的；因此，如果 $\\mathrm{AFE}  0$，则该用例报告为 $0$。\n5. 对于数值报告，将每个 AFE 四舍五入到小数点后六位，并以小数形式表示（不带百分号）。\n\n物理单位：\n- 密度 $\\rho_i$ 的单位为 $\\mathrm{g}\\,\\mathrm{mL}^{-1}$。\n- 比例常数 $k = 0.036$ $\\mathrm{g}\\,\\mathrm{mL}^{-1}$ 每单位 AFE。\n- 最终的 AFE 是无量纲的，必须报告为四舍五入到小数点后六位的小数。\n\n测试套件：\n对于每个用例，您将得到一个密度列表和两个丰度列表（未标记的在前，标记的在后）。对所有用例均使用 $k = 0.036$。\n\n- 用例 1：\n  - 密度：$[\\,1.690,\\,1.700,\\,1.710,\\,1.720,\\,1.730\\,]$\n  - 未标记丰度：$[\\,10,\\,50,\\,100,\\,50,\\,10\\,]$\n  - 标记丰度：$[\\,5,\\,20,\\,80,\\,80,\\,35\\,]$\n\n- 用例 2：\n  - 密度：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n  - 未标记丰度：$[\\,0,\\,10,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,10,\\,0\\,]$\n\n- 用例 3：\n  - 密度：$[\\,1.680,\\,1.690,\\,1.700,\\,1.710\\,]$\n  - 未标记丰度：$[\\,20,\\,10,\\,0,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,0,\\,0,\\,30\\,]$\n\n- 用例 4：\n  - 密度：$[\\,1.700,\\,1.705,\\,1.710,\\,1.715,\\,1.720\\,]$\n  - 未标记丰度：$[\\,1,\\,0,\\,0,\\,0,\\,0\\,]$\n  - 标记丰度：$[\\,0,\\,0,\\,0,\\,0,\\,1\\,]$\n\n- 用例 5：\n  - 密度：$[\\,1.700,\\,1.705,\\,1.710\\,]$\n  - 未标记丰度：$[\\,5,\\,10,\\,5\\,]$\n  - 标记丰度：$[\\,4,\\,10,\\,6\\,]$\n\n- 用例 6（测试非负性处理）：\n  - 密度：$[\\,1.700,\\,1.710,\\,1.720\\,]$\n  - 未标记丰度：$[\\,0,\\,10,\\,0\\,]$\n  - 标记丰度：$[\\,7,\\,3,\\,0\\,]$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用例 1 到 6 的 AFE 结果，格式为一个用方括号括起来的逗号分隔列表，每个值都四舍五入到小数点后六位（例如 $[0.123456,0.000000,\\dots]$）。", "solution": "该问题陈述在科学上是合理的，定义清晰，并且是客观的。它为微生物生态学中稳定同位素探测（SIP）技术的一个常见计算任务提供了一个简化但准确的框架。所有必要的数据、定义和物理常数均已提供，不存在内部矛盾或歧义。我们将着手解决此问题。\n\n核心任务是量化重同位素（$^{13}\\mathrm{C}$）掺入特定操作分类单元（OTU）的DNA中的程度。这种掺入表现为DNA浮力密度的增加。该分析依赖于密度梯度中DNA丰度分布的质心（COM）概念。\n\n如问题所述，一组离散组分的质心计算为浮力密度$\\rho_i$的加权平均值，权重为相应的丰度$a_i$。对于未标记的对照样本（U）和标记的处理样本（L），各自的质心$\\rho_{\\mathrm{U}}$和$\\rho_{\\mathrm{L}}$计算如下：\n$$\n\\rho_{\\mathrm{U}} = \\frac{\\sum_i \\rho_i a_{U_i}}{\\sum_i a_{U_i}}\n\\qquad \\text{和} \\qquad\n\\rho_{\\mathrm{L}} = \\frac{\\sum_i \\rho_i a_{L_i}}{\\sum_i a_{L_i}}\n$$\n这里，$a_{U_i}$ 和 $a_{L_i}$ 分别代表未标记样本和标记样本在第 $i$ 个组分中的丰度。\n\n质心的位移 $\\Delta\\rho$ 是标记样本质心和未标记样本质心之差：\n$$\n\\Delta\\rho = \\rho_{\\mathrm{L}} - \\rho_{\\mathrm{U}}\n$$\n该密度位移在物理上与DNA中$^{13}\\text{C}$的原子分数超额（AFE）成正比。该关系以线性近似给出：\n$$\n\\Delta\\rho = k \\cdot \\text{AFE}\n$$\n其中 $k$ 是比例常数，给定为 $k = 0.036 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}$ 每单位AFE。由此，我们推导出AFE的表达式：\n$$\n\\text{AFE} = \\frac{\\Delta\\rho}{k}\n$$\n由于AFE代表超额的同位素分数，它在物理上不能为负。因此，任何计算出的 $\\text{AFE}  0$ 的值（可能由测量噪声或实验伪影引起），都必须修正为 $0$。\n\n我们现在将此步骤应用于每个测试用例。\n\n**用例 1：**\n- $\\rho_i$: $[\\,1.690,\\,1.700,\\,1.710,\\,1.720,\\,1.730\\,]$\n- $a_{U_i}$: $[\\,10,\\,50,\\,100,\\,50,\\,10\\,]$\n- $a_{L_i}$: $[\\,5,\\,20,\\,80,\\,80,\\,35\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.690(10) + 1.700(50) + 1.710(100) + 1.720(50) + 1.730(10)}{10+50+100+50+10} = \\frac{376.2}{220} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.690(5) + 1.700(20) + 1.710(80) + 1.720(80) + 1.730(35)}{5+20+80+80+35} = \\frac{377.4}{220} \\approx 1.71545455 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.71545455 - 1.710 = 0.00545455 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.00545455}{0.036} \\approx 0.15151515 \\implies 0.151515\n$$\n\n**用例 2：**\n- $\\rho_i$: $[\\,1.700,\\,1.710,\\,1.720\\,]$\n- $a_{U_i}$: $[\\,0,\\,10,\\,0\\,]$\n- $a_{L_i}$: $[\\,0,\\,10,\\,0\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.710 - 1.710 = 0 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0}{0.036} = 0 \\implies 0.000000\n$$\n\n**用例 3：**\n- $\\rho_i$: $[\\,1.680,\\,1.690,\\,1.700,\\,1.710\\,]$\n- $a_{U_i}$: $[\\,20,\\,10,\\,0,\\,0\\,]$\n- $a_{L_i}$: $[\\,0,\\,0,\\,0,\\,30\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.680(20) + 1.690(10)}{20+10} = \\frac{50.5}{30} \\approx 1.68333333 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.710(30)}{30} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.710 - 1.68333333 = 0.02666667 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.02666667}{0.036} \\approx 0.74074074 \\implies 0.740741\n$$\n\n**用例 4：**\n- $\\rho_i$: $[\\,1.700,\\,1.705,\\,1.710,\\,1.715,\\,1.720\\,]$\n- $a_{U_i}$: $[\\,1,\\,0,\\,0,\\,0,\\,0\\,]$\n- $a_{L_i}$: $[\\,0,\\,0,\\,0,\\,0,\\,1\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.700(1)}{1} = 1.700 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.720(1)}{1} = 1.720 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.720 - 1.700 = 0.020 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.020}{0.036} \\approx 0.55555556 \\implies 0.555556\n$$\n\n**用例 5：**\n- $\\rho_i$: $[\\,1.700,\\,1.705,\\,1.710\\,]$\n- $a_{U_i}$: $[\\,5,\\,10,\\,5\\,]$\n- $a_{L_i}$: $[\\,4,\\,10,\\,6\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.700(5) + 1.705(10) + 1.710(5)}{5+10+5} = \\frac{34.1}{20} = 1.705 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.700(4) + 1.705(10) + 1.710(6)}{4+10+6} = \\frac{34.11}{20} = 1.7055 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.7055 - 1.705 = 0.0005 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\text{AFE} = \\frac{0.0005}{0.036} \\approx 0.01388889 \\implies 0.013889\n$$\n\n**用例 6：**\n- $\\rho_i$: $[\\,1.700,\\,1.710,\\,1.720\\,]$\n- $a_{U_i}$: $[\\,0,\\,10,\\,0\\,]$\n- $a_{L_i}$: $[\\,7,\\,3,\\,0\\,]$\n$$\n\\rho_{\\mathrm{U}} = \\frac{1.710(10)}{10} = 1.710 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\rho_{\\mathrm{L}} = \\frac{1.700(7) + 1.710(3)}{7+3} = \\frac{17.03}{10} = 1.703 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n$$\n\\Delta\\rho = 1.703 - 1.710 = -0.007 \\, \\mathrm{g}\\,\\mathrm{mL}^{-1}\n$$\n得到的 $\\Delta\\rho$ 是负数，这会导致AFE为负。根据问题规范，这在物理上是不允许的，必须设为 $0$。\n$$\n\\text{AFE}_{\\text{raw}} = \\frac{-0.007}{0.036}  0 \\implies \\text{AFE} = 0 \\implies 0.000000\n$$\n实现过程将编码此逻辑以生成最终结果。最终结果列表为 $[0.151515, 0.000000, 0.740741, 0.555556, 0.013889, 0.000000]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Atom Fraction Excess (AFE) in DNA Stable Isotope Probing (SIP)\n    experiments based on buoyant density shifts.\n    \"\"\"\n\n    # Proportionality constant k in g/mL per unit AFE\n    k_constant = 0.036\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"densities\": [1.690, 1.700, 1.710, 1.720, 1.730],\n            \"unlabeled_abundances\": [10, 50, 100, 50, 10],\n            \"labeled_abundances\": [5, 20, 80, 80, 35],\n        },\n        {\n            \"densities\": [1.700, 1.710, 1.720],\n            \"unlabeled_abundances\": [0, 10, 0],\n            \"labeled_abundances\": [0, 10, 0],\n        },\n        {\n            \"densities\": [1.680, 1.690, 1.700, 1.710],\n            \"unlabeled_abundances\": [20, 10, 0, 0],\n            \"labeled_abundances\": [0, 0, 0, 30],\n        },\n        {\n            \"densities\": [1.700, 1.705, 1.710, 1.715, 1.720],\n            \"unlabeled_abundances\": [1, 0, 0, 0, 0],\n            \"labeled_abundances\": [0, 0, 0, 0, 1],\n        },\n        {\n            \"densities\": [1.700, 1.705, 1.710],\n            \"unlabeled_abundances\": [5, 10, 5],\n            \"labeled_abundances\": [4, 10, 6],\n        },\n        {\n            \"densities\": [1.700, 1.710, 1.720],\n            \"unlabeled_abundances\": [0, 10, 0],\n            \"labeled_abundances\": [7, 3, 0],\n        }\n    ]\n\n    results = []\n\n    def calculate_com(densities, abundances):\n        \"\"\"Calculates the discrete center of mass.\"\"\"\n        total_abundance = np.sum(abundances)\n        if total_abundance == 0:\n            # Handle case with no abundance, though not expected in test data.\n            # Return 0 or raise error. Returning 0 is safer for automation.\n            return 0.0\n        \n        # Weighted sum of densities\n        weighted_sum = np.dot(densities, abundances)\n        \n        return weighted_sum / total_abundance\n\n    for case in test_cases:\n        densities = np.array(case[\"densities\"])\n        unlabeled_abundances = np.array(case[\"unlabeled_abundances\"])\n        labeled_abundances = np.array(case[\"labeled_abundances\"])\n\n        # 1. Compute COM for unlabeled and labeled distributions\n        rho_unlabeled = calculate_com(densities, unlabeled_abundances)\n        rho_labeled = calculate_com(densities, labeled_abundances)\n\n        # 2. Compute the density shift\n        delta_rho = rho_labeled - rho_unlabeled\n\n        # 3. Compute the Atom Fraction Excess (AFE)\n        afe = delta_rho / k_constant\n\n        # 4. Handle non-physical negative AFE values\n        if afe  0:\n            afe = 0.0\n\n        # Append the formatted result\n        results.append(f\"{afe:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2533985"}]}