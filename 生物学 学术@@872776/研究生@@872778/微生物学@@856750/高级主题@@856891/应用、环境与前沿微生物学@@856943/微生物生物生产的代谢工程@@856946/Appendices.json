{"hands_on_practices": [{"introduction": "在优化任何代谢途径之前，我们必须确保所提出的任何反应方案在物理上都是可行的。这项练习 [@problem_id:2506619] 侧重于使用元素平衡和氧化还原平衡——基本的守恒定律——来验证和约束代谢途径，从而消除那些违反基本守恒定律的假设性方案。掌握这项技能是构建可靠代谢模型和进行严谨的理论产率计算的第一步。", "problem": "一位生物过程工程师正在评估在水相介质中，无外部电子受体且生物质形成可忽略不计的条件下，由葡萄糖$(\\mathrm{C_{6}H_{12}O_{6}})$厌氧生产正丁醇$(\\mathrm{C_{4}H_{10}O})$的过程。副产物仅限于二氧化碳$(\\mathrm{CO_{2}})$、水$(\\mathrm{H_{2}O})$和氢气$(\\mathrm{H_{2}})$。该系统必须遵守原子守恒和总还原当量（电子）守恒。将每摩尔氢气视为携带$2$个还原当量，水和二氧化碳的净还原当量视为零。所有物质均为中性，因此电荷平衡已默认满足。\n\n给定$3$个候选总反应路径：\n- 路径A：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$。\n- 路径B：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$。\n- 路径C：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$。\n\n任务：\n1. 使用原子追踪法，检验每条路径的碳、氢、氧原子守恒以及总还原当量守恒。排除违反任何守恒定律的路径。\n2. 对于允许的副产物集合$\\left\\{\\mathrm{CO_{2}},\\mathrm{H_{2}O},\\mathrm{H_{2}}\\right\\}$，考虑通用总反应\n$$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{\\mathrm{H}_2}\\,\\mathrm{H_{2}},$$\n其中化学计量系数$\\nu_{b}, \\nu_{c}, \\nu_{h}, \\nu_{\\mathrm{H}_2} \\ge 0$为未知的非负数。推导碳、氢、氧的元素平衡方程，以及基于还原当量守恒的总氧化还原平衡方程。利用这些约束条件，确定正丁醇的最大可能摩尔产率$\\nu_{b}^{\\max}$（单位：摩尔/摩尔葡萄糖）。\n3. 使用原子量$M(\\mathrm{C})=12.01$，$M(\\mathrm{H})=1.008$，$M(\\mathrm{O})=16.00$（单位：克/摩尔），计算相应的最大质量产率$Y_{P/S}^{\\max}$（单位：克正丁醇/克葡萄糖）。将最终数值答案表示为克正丁醇/克葡萄糖，并四舍五入到$4$位有效数字。\n\n你最终报告的答案必须是任务3中规定的$Y_{P/S}^{\\max}$的单一值。", "solution": "问题陈述已经过评估并被确定为有效。这是一个有科学依据、自洽且定义明确的代谢化学计量学和热力学问题，需要应用基本守恒定律。其前提、约束和目标都已明确定义。我现在将进行系统性求解。\n\n根据问题的任务，解答分为三个部分。\n\n首先，我将通过检验原子（碳、氢、氧）守恒和还原当量守恒来验证这三个候选反应路径。分子$\\mathrm{C}_{a}\\mathrm{H}_{b}\\mathrm{O}_{c}\\mathrm{N}_{d}$的还原度$\\gamma$由公式$\\gamma = 4a + b - 2c - 3d$给出。对于本问题中的物质，它们均不带电荷且不含氮，因此该公式可以简化。一摩尔物质的总可用电子数，我们称之为还原当量（RE），即为其还原度。\n对于底物，葡萄糖（$\\mathrm{C_{6}H_{12}O_{6}}$）：$\\gamma_{\\text{glucose}} = 4(6) + 12 - 2(6) = 24$。\n对于产物，正丁醇（$\\mathrm{C_{4}H_{10}O}$）：$\\gamma_{\\text{butanol}} = 4(4) + 10 - 2(1) = 24$。\n问题定义了副产物的RE：\n$\\mathrm{CO_{2}}$：$\\gamma_{\\mathrm{CO_{2}}} = 0$。这与公式一致：$4(1) - 2(2) = 0$。\n$\\mathrm{H_{2}O}$：$\\gamma_{\\mathrm{H_{2}O}} = 0$。这与公式一致：$2 - 2(1) = 0$。\n$\\mathrm{H_{2}}$：$\\gamma_{\\mathrm{H_{2}}} = 2$。这与公式一致：$2$。\n\n路径A：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 2\\,\\mathrm{CO_{2}} + \\mathrm{H_{2}O}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 2(1) = 6$。平衡满足。\n- 氢(H)平衡：$12 \\rightarrow 10 + 2(1) = 12$。平衡满足。\n- 氧(O)平衡：$6 \\rightarrow 1 + 2(2) + 1 = 6$。平衡满足。\n- 还原当量(RE)平衡：$24 \\rightarrow 1(24) + 2(0) + 1(0) = 24$。平衡满足。\n结论：路径A有效，因为它满足所有守恒定律。\n\n路径B：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + \\mathrm{CO_{2}} + 2\\,\\mathrm{H_{2}}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 1 = 5$。平衡不满足。\n结论：路径B因碳原子不守恒而无效。无需进一步检查。\n\n路径C：$\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\mathrm{C_{4}H_{10}O} + 3\\,\\mathrm{CO} + 2\\,\\mathrm{H_{2}O}$\n- 碳(C)平衡：$6 \\rightarrow 4 + 3(1) = 7$。平衡不满足。\n结论：路径C因碳原子不守恒而无效。此外，一氧化碳（$\\mathrm{CO}$）的出现也使得该路径与后续分析不一致，因为它不是主要问题中指定的可接受副产物集合中的一员。再者，问题陈述未提供$\\mathrm{CO}$的还原当量，因此即使原子平衡，也无法进行完全验证。\n\n其次，我将确定正丁醇的最大可能摩尔产率$\\nu_{b}^{\\max}$。通用化学计量方程为：\n$$1\\,\\mathrm{C_{6}H_{12}O_{6}} \\rightarrow \\nu_{b}\\,\\mathrm{C_{4}H_{10}O} + \\nu_{c}\\,\\mathrm{CO_{2}} + \\nu_{h}\\,\\mathrm{H_{2}O} + \\nu_{\\mathrm{H}_2}\\,\\mathrm{H_{2}}$$\n我们基于消耗1摩尔葡萄糖，根据原子平衡建立线性方程组。\n- C平衡：$6 = 4\\nu_{b} + \\nu_{c}$  (1)\n- H平衡：$12 = 10\\nu_{b} + 2\\nu_{h} + 2\\nu_{\\mathrm{H}_2}$  (2)\n- O平衡：$6 = \\nu_{b} + 2\\nu_{c} + \\nu_{h}$  (3)\n\n氧化还原平衡（$24 = 24\\nu_{b} + 2\\nu_{\\mathrm{H}_2}$）是原子平衡（$4 \\times \\text{C} + \\text{H} - 2 \\times \\text{O}$）的线性组合，因此是冗余的。我们必须求解这个包含三个方程和四个未知化学计量系数的方程组，这些系数被约束为非负数：$\\nu_{b} \\ge 0$, $\\nu_{c} \\ge 0$, $\\nu_{h} \\ge 0$, $\\nu_{\\mathrm{H}_2} \\ge 0$。\n\n我们将$\\nu_{c}$、$\\nu_{h}$和$\\nu_{\\mathrm{H}_2}$表示为$\\nu_{b}$的函数，以找到丁醇产率的可行范围。\n从(1)式得：\n$$\\nu_{c} = 6 - 4\\nu_{b}$$\n将此代入(3)式：\n$6 = \\nu_{b} + 2(6 - 4\\nu_{b}) + \\nu_{h}$\n$6 = \\nu_{b} + 12 - 8\\nu_{b} + \\nu_{h}$\n$6 = 12 - 7\\nu_{b} + \\nu_{h} \\implies \\nu_{h} = 7\\nu_{b} - 6$\n\n将$\\nu_{h}$代入简化的H平衡方程(2)，即$6 = 5\\nu_{b} + \\nu_{h} + \\nu_{\\mathrm{H}_2}$：\n$6 = 5\\nu_{b} + (7\\nu_{b} - 6) + \\nu_{\\mathrm{H}_2}$\n$6 = 12\\nu_{b} - 6 + \\nu_{\\mathrm{H}_2} \\implies \\nu_{\\mathrm{H}_2} = 12 - 12\\nu_{b}$\n\n现在应用非负约束条件：\n1. $\\nu_{b} \\ge 0$ (给定)\n2. $\\nu_{c} \\ge 0 \\implies 6 - 4\\nu_{b} \\ge 0 \\implies 4\\nu_{b} \\le 6 \\implies \\nu_{b} \\le \\frac{3}{2}$\n3. $\\nu_{h} \\ge 0 \\implies 7\\nu_{b} - 6 \\ge 0 \\implies 7\\nu_{b} \\ge 6 \\implies \\nu_{b} \\ge \\frac{6}{7}$\n4. $\\nu_{\\mathrm{H}_2} \\ge 0 \\implies 12 - 12\\nu_{b} \\ge 0 \\implies 12\\nu_{b} \\le 12 \\implies \\nu_{b} \\le 1$\n\n综合这些不等式，我们得到$\\nu_{b}$的可行范围：\n$$\\frac{6}{7} \\le \\nu_{b} \\le 1$$\n目标是最大化$\\nu_{b}$。在此可行范围内的最大值为$\\nu_{b}^{\\max} = 1$。\n\n第三，我将计算最大质量产率$Y_{P/S}^{\\max}$。首先，使用给定的原子量计算摩尔质量（$M$）：$M(\\mathrm{C})=12.01\\,\\text{g/mol}$，$M(\\mathrm{H})=1.008\\,\\text{g/mol}$，$M(\\mathrm{O})=16.00\\,\\text{g/mol}$。\n葡萄糖$M_{\\text{glucose}}$（$\\mathrm{C_{6}H_{12}O_{6}}$）的摩尔质量：\n$$M_{\\text{glucose}} = 6 \\times 12.01 + 12 \\times 1.008 + 6 \\times 16.00 = 72.06 + 12.096 + 96.00 = 180.156\\,\\text{g/mol}$$\n正丁醇$M_{\\text{butanol}}$（$\\mathrm{C_{4}H_{10}O}$）的摩尔质量：\n$$M_{\\text{butanol}} = 4 \\times 12.01 + 10 \\times 1.008 + 1 \\times 16.00 = 48.04 + 10.080 + 16.00 = 74.120\\,\\text{g/mol}$$\n最大质量产率由以下公式给出：\n$$Y_{P/S}^{\\max} = \\nu_{b}^{\\max} \\frac{M_{\\text{butanol}}}{M_{\\text{glucose}}}$$\n代入数值：\n$$Y_{P/S}^{\\max} = 1 \\times \\frac{74.120}{180.156} \\approx 0.4114134\\,\\text{g/g}$$\n根据要求四舍五入到$4$位有效数字，结果是$0.4114$。", "answer": "$$\n\\boxed{0.4114}\n$$", "id": "2506619"}, {"introduction": "化学计量学定义了什么是可能的，而酶动力学则决定了在给定条件下以何种速率可以实现。这项练习 [@problem_id:2506550] 演示了如何应用经典的米氏动力学模型，根据测得的酶丰度、催化常数和底物浓度来计算途径中每一步的实际通量能力。这是一项诊断途径性能的关键技能，能够帮助我们准确识别限制整体产出的瓶颈所在，从而为后续的蛋白质工程或基因表达调控提供明确的指导。", "problem": "构建了一种工程细菌，通过一个严格的线性四步途径来生产目标分子。每一步都由一种单底物酶催化，在操作条件下没有变构调节，产物抑制可忽略不计。细胞处于稳定的生理状态，每一步底物的细胞内底物浓度已测定，且每种酶在酶-底物复合物的准稳态假设下遵循经典的米氏-门氏机理。假设所报告的总酶具有催化活性，每一步都有效不可逆，并且在稳态下途径的比通量不能超过给定条件下最慢步骤可达到的速率。酶的总丰度以每克干重 (gDW) 报告，其中 gDW 代表克干重。\n\n对于步骤 $i \\in \\{1,2,3,4\\}$，测量了以下参数：\n- 步骤 1：总酶丰度 $E_{t,1} = 0.030~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},1} = 120~\\text{s}^{-1}$，米氏常数 $K_{M,1} = 0.20~\\text{mM}$，底物浓度 $S_{1} = 1.00~\\text{mM}$。\n- 步骤 2：总酶丰度 $E_{t,2} = 0.015~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},2} = 200~\\text{s}^{-1}$，米氏常数 $K_{M,2} = 0.050~\\text{mM}$，底物浓度 $S_{2} = 0.100~\\text{mM}$。\n- 步骤 3：总酶丰度 $E_{t,3} = 0.040~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},3} = 50~\\text{s}^{-1}$，米氏常数 $K_{M,3} = 0.50~\\text{mM}$，底物浓度 $S_{3} = 0.250~\\text{mM}$。\n- 步骤 4：总酶丰度 $E_{t,4} = 0.010~\\mu\\text{mol}~\\text{gDW}^{-1}$，催化转换数 $k_{\\text{cat},4} = 500~\\text{s}^{-1}$，米氏常数 $K_{M,4} = 0.20~\\text{mM}$，底物浓度 $S_{4} = 1.00~\\text{mM}$。\n\n仅使用米氏-门氏动力学的基本定义和源自质量守恒的稳态途径通量约束，计算在这些条件下受酶限制的最大途径比通量，以 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$ 表示。将您的答案四舍五入到三位有效数字。除了所述参数外，您不能假设任何其他参数，并且您必须在求解过程中从第一性原理证明所用单位的合理性。虽然您应该推断哪个步骤限制了通量，但只需报告所要求单位的最大比通量的数值。", "solution": "我们从经典的单底物米氏-门氏机理以及对酶-底物复合物的准稳态假设开始。对于总酶浓度为 $E_{t}$、底物浓度为 $S$ 的单一步骤，单位体积的反应速率为\n\n$$\nr \\;=\\; \\frac{V_{\\max} S}{K_{M} + S} \\quad \\text{with} \\quad V_{\\max} \\;=\\; k_{\\text{cat}} E,\n$$\n\n其中 $E$ 是单位体积的酶浓度。在代谢工程中，通常以每克干重 (gDW) 而不是每体积来报告酶丰度。设 $E_{t}$（单位 $\\text{mol}~\\text{gDW}^{-1}$）表示每克干重的总酶丰度。设 $\\rho$ 是以 $\\text{gDW}~\\text{L}^{-1}$ 为单位的生物质密度。那么，体积酶浓度为 $E = E_{t}\\,\\rho$（单位 $\\text{mol}~\\text{L}^{-1}$）。因此，体积速率变为\n\n$$\nr \\;=\\; k_{\\text{cat}} (E_{t}\\rho)\\, \\frac{S}{K_{M} + S}.\n$$\n\n每克干重的比通量，记为 $J$（单位 $\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$），是通过将体积速率除以 $\\rho$ 转换为每克干重的基础得到的：\n\n$$\nJ \\;=\\; \\frac{r}{\\rho} \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\n因此，当 $E_{t}$ 以每克干重给出，而 $S$、$K_{M}$ 以相同单位的浓度给出时，每克干重的比速率直接为\n\n$$\nJ \\;=\\; k_{\\text{cat}} E_{t}\\, \\frac{S}{K_{M} + S}.\n$$\n\n单位是一致的：$k_{\\text{cat}}$ 的单位是 $\\text{s}^{-1}$，$E_{t}$ 的单位是 $\\mu\\text{mol}~\\text{gDW}^{-1}$，饱和项 $\\frac{S}{K_{M}+S}$ 是无量纲的，所以 $J$ 的单位是 $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$。然后通过乘以 $3.6$ 将其转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。\n\n对于一个在稳态下严格线性的途径，没有中间产物的积累，并且每一步都在相同的通量下独立运行，可达到的途径通量不能超过在当前底物浓度下任何单个步骤的容量。因此，受酶限制的最大途径比通量是各步骤容量的最小值：\n\n$$\nJ_{\\text{max}} \\;=\\; \\min_{i \\in \\{1,2,3,4\\}} \\left\\{ k_{\\text{cat},i} E_{t,i}\\, \\frac{S_{i}}{K_{M,i} + S_{i}} \\right\\}.\n$$\n\n\n我们计算每个步骤的容量 $J_{i}$，单位为 $\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}$，然后转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。\n\n步骤 1:\n\n$$\nV_{\\max,1} \\;=\\; k_{\\text{cat},1} E_{t,1} \\;=\\; 120~\\text{s}^{-1} \\times 0.030~\\mu\\text{mol}~\\text{gDW}^{-1} \\;=\\; 3.6~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{1}}{K_{M,1}+S_{1}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{1.00}{1.20} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{1} \\;=\\; 3.6 \\times \\frac{5}{6} \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$：\n\n$$\n3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\times \\frac{1~\\text{mmol}}{1000~\\mu\\text{mol}} \\times \\frac{3600~\\text{s}}{1~\\text{h}} \\;=\\; 10.8~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 2:\n\n$$\nV_{\\max,2} \\;=\\; 200 \\times 0.015 \\;=\\; 3.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{2}}{K_{M,2}+S_{2}} \\;=\\; \\frac{0.100}{0.050+0.100} \\;=\\; \\frac{0.100}{0.150} \\;=\\; \\frac{2}{3}.\n$$\n\n\n$$\nJ_{2} \\;=\\; 3.0 \\times \\frac{2}{3} \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\;\\Rightarrow\\; 2.0 \\times 3.6 \\;=\\; 7.2~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 3:\n\n$$\nV_{\\max,3} \\;=\\; 50 \\times 0.040 \\;=\\; 2.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{3}}{K_{M,3}+S_{3}} \\;=\\; \\frac{0.250}{0.50+0.250} \\;=\\; \\frac{0.250}{0.750} \\;=\\; \\frac{1}{3}.\n$$\n\n\n$$\nJ_{3} \\;=\\; 2.0 \\times \\frac{1}{3} \\;=\\; \\frac{2}{3}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换：\n\n$$\n\\frac{2}{3}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\times 3.6 \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n步骤 4:\n\n$$\nV_{\\max,4} \\;=\\; 500 \\times 0.010 \\;=\\; 5.0~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n\n$$\n\\frac{S_{4}}{K_{M,4}+S_{4}} \\;=\\; \\frac{1.00}{0.20+1.00} \\;=\\; \\frac{5}{6}.\n$$\n\n\n$$\nJ_{4} \\;=\\; 5.0 \\times \\frac{5}{6} \\;=\\; \\frac{25}{6}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1}.\n$$\n\n转换：\n\n$$\n\\frac{25}{6}~\\mu\\text{mol}~\\text{gDW}^{-1}~\\text{s}^{-1} \\times 3.6 \\;=\\; 15.0~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n汇总各步骤容量（单位为 $\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$）：\n\n$$\nJ_{1} = 10.8,\\quad J_{2} = 7.2,\\quad J_{3} = 2.4,\\quad J_{4} = 15.0.\n$$\n\n受酶限制的最大途径比通量是\n\n$$\nJ_{\\text{max}} \\;=\\; \\min\\{10.8,\\, 7.2,\\, 2.4,\\, 15.0\\} \\;=\\; 2.4~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}.\n$$\n\n\n四舍五入到三位有效数字得到 $2.40~\\text{mmol}~\\text{gDW}^{-1}~\\text{h}^{-1}$。通过检查各步骤容量，可知在这些条件下，限制步骤是步骤 $3$。根据要求，我们仅报告所要求单位的数值。", "answer": "$$\\boxed{2.40}$$", "id": "2506550"}, {"introduction": "在化学计量学的基础上，通量平衡分析（FBA）使我们能够预测整个网络的代谢通量分布，以实现特定的生物学目标，例如最大化生物量或目标产物的产量。这项高级练习 [@problem_id:2506613] 涉及实施 FBA 和通量变异性分析（FVA），以探索不同优化目标下的最佳代谢状态以及网络内在的灵活性。这种计算方法是现代系统代谢工程的基石，对于在全细胞水平上理解和设计复杂的代谢网络至关重要。", "problem": "一个用于微生物生物生产的代谢网络通过稳态质量守恒（化学计量质量平衡）和线性优化进行建模。其基础是稳态下的质量平衡和通量边界：每个内部代谢物没有净积累，因此通量向量 $\\mathbf{v} \\in \\mathbb{R}^n$ 必须满足 $S \\mathbf{v} = \\mathbf{0}$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是化学计量矩阵，并且每个反应通量 $v_i$ 都受到下限和上限的约束。这个基础与线性目标函数一起，构成了通量平衡分析（Flux Balance Analysis, FBA）的基石。替代最优点通过通量变异性分析（Flux Variability Analysis, FVA）来表征，该方法在将最优目标值维持在一个小容差范围内的同时，计算单个通量的允许范围。您的程序必须实现这些原理，以比较不同目标下的最优解，并通过 FVA 来量化替代最优点。\n\n网络规范。内部代谢物为 $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$。反应（全部为不可逆反应）及其通量索引如下：\n- $v_1$：葡萄糖摄取，$\\text{Glc}_e \\rightarrow \\text{Glc}$，索引为 $0$。\n- $v_2$：糖酵解，$\\text{Glc} \\rightarrow 2\\,\\text{Pyr} + 2\\,\\text{ATP}$，索引为 $1$。\n- $v_3$：呼吸作用 A，$\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$，索引为 $2$。\n- $v_{10}$：呼吸作用 B（呼吸作用 A 的重复），$\\text{Pyr} + 2.5\\,\\text{O2} \\rightarrow 3\\,\\text{CO2} + 12.5\\,\\text{ATP}$，索引为 $3$。\n- $v_4$：发酵作用 A，$\\text{Pyr} \\rightarrow \\text{Lac}$，索引为 $4$。\n- $v_{11}$：发酵作用 B（发酵作用 A 的重复），$\\text{Pyr} \\rightarrow \\text{Lac}$，索引为 $5$。\n- $v_5$：三磷酸腺苷（ATP）水解需求，$\\text{ATP} \\rightarrow \\varnothing$，索引为 $6$。\n- $v_6$：生物质形成（汇），$2\\,\\text{Pyr} + 10\\,\\text{ATP} \\rightarrow \\varnothing$，索引为 $7$。\n- $v_7$：氧气摄取，$\\text{O2}_e \\rightarrow \\text{O2}$，索引为 $8$。\n- $v_8$：二氧化碳排出，$\\text{CO2} \\rightarrow \\varnothing$，索引为 $9$。\n- $v_9$：乳酸排出，$\\text{Lac} \\rightarrow \\varnothing$，索引为 $10$。\n\n针对内部代谢物的稳态化学计量质量平衡 $S \\mathbf{v} = \\mathbf{0}$，写成线性方程组如下：\n- Glc: $+1\\,v_1 - 1\\,v_2 = 0$。\n- Pyr: $+2\\,v_2 - 1\\,v_3 - 1\\,v_{10} - 1\\,v_4 - 1\\,v_{11} - 2\\,v_6 = 0$。\n- ATP: $+2\\,v_2 + 12.5\\,v_3 + 12.5\\,v_{10} - 1\\,v_5 - 10\\,v_6 = 0$。\n- O2: $+1\\,v_7 - 2.5\\,v_3 - 2.5\\,v_{10} = 0$。\n- CO2: $+3\\,v_3 + 3\\,v_{10} - 1\\,v_8 = 0$。\n- Lac: $+1\\,v_4 + 1\\,v_{11} - 1\\,v_9 = 0$。\n\n通量边界。所有反应均为不可逆反应，下限为 $0$。交换反应具有如下有限上限：\n- $0 \\le v_1 \\le G_{\\max}$，用于葡萄糖摄取。\n- $0 \\le v_7 \\le O_{\\max}$，用于氧气摄取。\n- 所有其他反应的上限为 $+\\infty$。\n\n目标。您必须计算以下各项，每项都作为一个线性规划问题来构建：\n1. 生物质最大化：最大化 $v_6$。\n2. ATP 产量最大化：最大化 $v_5$。\n3. 最大生长速率下的最小总通量：首先从目标 (1) 中找到最大生物质 $v_6^\\star$，然后在满足 $S \\mathbf{v} = \\mathbf{0}$、上述边界条件以及 $v_6 \\ge v_6^\\star - \\epsilon$ 的约束下，最小化总通量 $\\sum_{i=1}^{n} |v_i|$。由于所有反应都是不可逆的，因此 $|v_i| = v_i$，目标简化为最小化 $\\sum_{i=1}^{n} v_i$。\n\n通量变异性分析 (FVA)。对于上述每个目标，在获得最优目标值 $z^\\star$ 后，通过计算集合 $\\{v_3, v_{10}, v_4, v_{11}\\}$ 中每个目标通量 $v_j$ 的最小和最大可行值来表征替代最优点，同时需满足约束条件 $S \\mathbf{v} = \\mathbf{0}$、边界条件以及目标值保持在容差 $\\epsilon$ 内的最优状态。当目标是最大化 $c^\\top \\mathbf{v}$ 时，通过添加不等式 $-c^\\top \\mathbf{v} \\le -z^\\star + \\epsilon$ 来实现。对于最小总通量目标，需同时添加 $v_6 \\ge v_6^\\star - \\epsilon$ 和 $\\sum_{i=1}^{n} v_i \\le T^\\star + \\epsilon$，其中 $T^\\star$ 是在该约束下找到的最小总通量。\n\n数值容差和单位。使用容差 $\\epsilon = 10^{-7}$。所有通量以毫摩尔每克干重每小时为单位，即 $\\text{mmol}\\,\\text{gDW}^{-1}\\,\\text{h}^{-1}$。所有报告的数值四舍五入到六位小数。\n\n测试套件。针对以下参数集 $(G_{\\max}, O_{\\max})$ 求解上述问题：\n- 案例 1：$(G_{\\max}, O_{\\max}) = (10, 100)$。\n- 案例 2：$(G_{\\max}, O_{\\max}) = (10, 8)$。\n- 案例 3：$(G_{\\max}, O_{\\max}) = (10, 0)$。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含一个列表，该列表按顺序串联每个案例的以下值，顺序必须完全一致：\n- 生物质最优点 $v_6^\\star$。\n- ATP 最优点 $v_5^\\star$。\n- $v_6 \\ge v_6^\\star - \\epsilon$ 条件下的最小总通量 $T^\\star$。\n- 生物质最优点下的 FVA：$[v_3^{\\min}, v_3^{\\max}, v_{10}^{\\min}, v_{10}^{\\max}, v_4^{\\min}, v_4^{\\max}, v_{11}^{\\min}, v_{11}^{\\max}]$。\n- ATP 最优点下的 FVA：按相同顺序排列的八个相同值。\n- 最小总通量最优点下的 FVA：按相同顺序排列的八个相同值。\n\n您的程序应生成单行输出，其中包含一个以逗号分隔的列表形式的结果，并用方括号括起来（例如 $[x_1,x_2,\\dots]$），每个数字按要求四舍五入到六位小数。不应打印任何其他文本。", "solution": "问题陈述已经过严格审查，并被确定为 **有效**。它提出了一个计算系统生物学领域的标准练习，具体涉及应用于一个简化代谢网络的通量平衡分析（Flux Balance Analysis, FBA）和通量变异性分析（Flux Variability Analysis, FVA）。该问题是自包含的，在数学上是适定的，并且在科学上基于稳态质量守恒原理。重复反应路径（$v_3/v_{10}$ 和 $v_4/v_{11}$）的存在不是一个缺陷，而是一种为创造替代最优点而进行的有意构建，这是代谢网络中的一种常见现象，对其进行表征是 FVA 的核心目的。\n\n解决方案通过系统地应用线性规划（LP）来推进。代谢网络的状态由一个通量向量 $\\mathbf{v} \\in \\mathbb{R}^{11}$ 描述，其中 $\\mathbf{v} = [v_0, v_1, \\dots, v_{10}]^\\top$。索引 $0, \\dots, 10$ 对应于问题中指定的反应 $v_1, v_2, v_3, v_{10}, v_4, v_{11}, v_5, v_6, v_7, v_8, v_9$。\n\n模型的核心是稳态质量平衡方程 $S \\mathbf{v} = \\mathbf{0}$，其中 $S \\in \\mathbb{R}^{6 \\times 11}$ 是化学计量矩阵。$S$ 的行对应于内部代谢物 $\\{\\text{Glc}, \\text{Pyr}, \\text{ATP}, \\text{O2}, \\text{CO2}, \\text{Lac}\\}$，其列对应于通量 $v_0, \\dots, v_{10}$。根据所提供的化学计量方程，矩阵 $S$ 为：\n$$\nS = \\begin{pmatrix}\n 1  -1  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0 \\\\\n 0  2  -1.0  -1.0  -1.0  -1.0  0.0  -2.0  0.0  0.0  0.0 \\\\\n 0  2  12.5  12.5  0.0  0.0  -1.0  -10.0  0.0  0.0  0.0 \\\\\n 0  0  -2.5  -2.5  0.0  0.0  0.0  0.0  1.0  0.0  0.0 \\\\\n 0  0  3.0  3.0  0.0  0.0  0.0  0.0  0.0  -1.0  0.0 \\\\\n 0  0  0.0  0.0  1.0  1.0  0.0  0.0  0.0  0.0  -1.0\n\\end{pmatrix}\n$$\n因此，线性方程组为 $S\\mathbf{v} = \\mathbf{0}$，其中 $\\mathbf{0}$ 是 $\\mathbb{R}^6$ 中的零向量。\n\n每个通量 $v_i$ 都受到下限和上限 $l_i \\le v_i \\le u_i$ 的约束。所有反应都是不可逆的，因此对于所有 $i \\in \\{0, \\dots, 10\\}$，$l_i = 0$。上限为：\n- $v_0 \\le G_{\\max}$\n- $v_8 \\le O_{\\max}$\n- 对于所有其他通量，$v_i \\le +\\infty$。\n\n每个任务都被构建为一个独立的 LP 问题。由于标准的 LP 求解器执行最小化操作，因此最大化目标函数 $c^\\top \\mathbf{v}$ 是通过最小化 $-c^\\top \\mathbf{v}$ 来实现的。\n\n1.  **生物质最大化**：目标是最大化生物质形成通量 $v_7$（反应 $v_6$）。要最小化的目标函数是 $c^\\top \\mathbf{v}$，其中 $c = [0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0]^\\top$。最优值为 $v_6^\\star = - \\min(c^\\top \\mathbf{v})$。\n\n2.  **ATP 产量最大化**：目标是最大化 ATP 水解通量 $v_6$（反应 $v_5$）。要最小化的目标函数是 $c^\\top \\mathbf{v}$，其中 $c = [0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0]^\\top$。最优值为 $v_5^\\star = - \\min(c^\\top \\mathbf{v})$。\n\n3.  **最大生长速率下的最小总通量**：这是一个两步优化问题。\n    a. 首先，如目标 (1) 中所述，确定最大生物质通量 $v_6^\\star$。\n    b. 其次，求解一个新的 LP 问题以最小化总通量 $\\sum_{i=0}^{10} v_i$。这对应于目标向量 $c = [1, 1, \\dots, 1]^\\top$。添加一个约束以确保生物质生产接近最优：$v_7 \\ge v_6^\\star - \\epsilon$。最优值为 $T^\\star = \\min(\\sum v_i)$。\n\n**通量变异性分析 (FVA)** 对上述发现的三个最优状态中的每一个都进行。对于给定的最优目标值 $z^\\star$，向 LP 问题添加一个额外的约束，以强制目标值保持在近最优状态。然后，对于每个目标通量 $v_j$（即反应 $v_3, v_{10}, v_4, v_{11}$），我们通过求解两个 LP 问题来找到其可能的最小值和最大值。\n\n-   **生物质最优点的 FVA**：添加约束 $v_7 \\ge v_6^\\star - \\epsilon$。\n-   **ATP 最优点的 FVA**：添加约束 $v_6 \\ge v_5^\\star - \\epsilon$。\n-   **最小总通量的 FVA**：添加两个约束：$v_7 \\ge v_6^\\star - \\epsilon$ 和 $\\sum_{i=0}^{10} v_i \\le T^\\star + \\epsilon$。\n\n对于这些约束系统中的每一个，我们遍历目标通量 $v_j$，将目标先后设置为最小化 $v_j$ 和最大化 $v_j$（即最小化 $-v_j$），以找到允许的通量范围 $[v_j^{\\min}, v_j^{\\max}]$。\n\n整个过程使用 `scipy.optimize.linprog` 函数为每个测试案例进行算法实现，该函数为此类 LP 问题提供了稳健的求解器。所有数值结果按要求四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of Flux Balance Analysis (FBA) and Flux Variability Analysis (FVA)\n    problems for a given metabolic network model.\n    \"\"\"\n    \n    # Define the test cases (G_max, O_max)\n    test_cases = [\n        (10.0, 100.0),  # Case 1\n        (10.0, 8.0),    # Case 2\n        (10.0, 0.0)     # Case 3\n    ]\n\n    # Stoichiometric matrix S (6 metabolites x 11 reactions)\n    # Rows: Glc, Pyr, ATP, O2, CO2, Lac\n    # Columns: v1, v2, v3, v10, v4, v11, v5, v6, v7, v8, v9 (indices 0-10)\n    S = np.array([\n        # v0,  v1,    v2,    v3,    v4,    v5,   v6,   v7,   v8,   v9,  v10\n        [  1,  -1,   0.0,   0.0,   0.0,   0.0,  0.0,  0.0,  0.0,  0.0,  0.0],  # Glc\n        [  0,   2,  -1.0,  -1.0,  -1.0,  -1.0,  0.0, -2.0,  0.0,  0.0,  0.0],  # Pyr\n        [  0,   2,  12.5,  12.5,   0.0,   0.0, -1.0, -10.0, 0.0,  0.0,  0.0],  # ATP\n        [  0,   0,  -2.5,  -2.5,   0.0,   0.0,  0.0,  0.0,  1.0,  0.0,  0.0],  # O2\n        [  0,   0,   3.0,   3.0,   0.0,   0.0,  0.0,  0.0,  0.0, -1.0,  0.0],  # CO2\n        [  0,   0,   0.0,   0.0,   1.0,   1.0,  0.0,  0.0,  0.0,  0.0, -1.0],  # Lac\n    ])\n    b_eq = np.zeros(S.shape[0])\n    num_fluxes = S.shape[1]\n    \n    # Numerical tolerance\n    epsilon = 1e-7\n\n    # FVA target flux indices (0-based): v3, v10, v4, v11\n    fva_flux_indices = [2, 3, 4, 5]\n\n    all_results = []\n\n    def run_fva(S_mat, b_eq_vec, bounds_list, A_ub_mat, b_ub_vec):\n        \"\"\"Helper function to perform FVA for a given constrained system.\"\"\"\n        fva_results = []\n        for idx in fva_flux_indices:\n            c = np.zeros(num_fluxes)\n            \n            # Minimize flux v_j\n            c[idx] = 1.0\n            res_min = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            min_val = res_min.fun if res_min.success else 0.0\n            \n            # Maximize flux v_j by minimizing -v_j\n            c[idx] = -1.0\n            res_max = linprog(c, A_eq=S_mat, b_eq=b_eq_vec, A_ub=A_ub_mat, b_ub=b_ub_vec, bounds=bounds_list, method='highs')\n            max_val = -res_max.fun if res_max.success else 0.0\n\n            fva_results.extend([min_val, max_val])\n        return fva_results\n\n    for G_max, O_max in test_cases:\n        case_results = []\n        bounds = [(0, None)] * num_fluxes\n        bounds[0] = (0, G_max)  # v1 (glucose uptake)\n        bounds[8] = (0, O_max)  # v7 (oxygen uptake)\n\n        # 1. Biomass maximization (objective: max v6, index 7)\n        c_biomass = np.zeros(num_fluxes)\n        c_biomass[7] = -1\n        res_biomass = linprog(c_biomass, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v6_star = -res_biomass.fun if res_biomass.success else 0.0\n        case_results.append(v6_star)\n        \n        # 2. ATP yield maximization (objective: max v5, index 6)\n        c_atp = np.zeros(num_fluxes)\n        c_atp[6] = -1\n        res_atp = linprog(c_atp, A_eq=S, b_eq=b_eq, bounds=bounds, method='highs')\n        v5_star = -res_atp.fun if res_atp.success else 0.0\n        case_results.append(v5_star)\n\n        # 3. Minimal total flux at maximal growth\n        A_ub_minflux = np.zeros((1, num_fluxes))\n        A_ub_minflux[0, 7] = -1  # -v7 = -(v6_star - epsilon) ==> v7 >= v6_star - epsilon\n        b_ub_minflux = [-(v6_star - epsilon)]\n        c_totalflux = np.ones(num_fluxes)\n        res_totalflux = linprog(c_totalflux, A_eq=S, b_eq=b_eq, A_ub=A_ub_minflux, b_ub=b_ub_minflux, bounds=bounds, method='highs')\n        T_star = res_totalflux.fun if res_totalflux.success else 0.0\n        case_results.append(T_star)\n\n        # 4. FVA for Biomass Optimum\n        A_ub_fva1 = np.zeros((1, num_fluxes))\n        A_ub_fva1[0, 7] = -1    # v7 >= v6_star - epsilon\n        b_ub_fva1 = [-(v6_star - epsilon)]\n        fva_biomass_results = run_fva(S, b_eq, bounds, A_ub_fva1, b_ub_fva1)\n        case_results.extend(fva_biomass_results)\n\n        # 5. FVA for ATP Optimum\n        A_ub_fva2 = np.zeros((1, num_fluxes))\n        A_ub_fva2[0, 6] = -1    # v6 >= v5_star - epsilon\n        b_ub_fva2 = [-(v5_star - epsilon)]\n        fva_atp_results = run_fva(S, b_eq, bounds, A_ub_fva2, b_ub_fva2)\n        case_results.extend(fva_atp_results)\n        \n        # 6. FVA for Minimal Total Flux Optimum\n        A_ub_fva3 = np.zeros((2, num_fluxes))\n        A_ub_fva3[0, 7] = -1        # v7 >= v6_star - epsilon\n        A_ub_fva3[1, :] = 1         # sum(v_i) = T_star + epsilon\n        b_ub_fva3 = [-(v6_star - epsilon), T_star + epsilon]\n        fva_totalflux_results = run_fva(S, b_eq, bounds, A_ub_fva3, b_ub_fva3)\n        case_results.extend(fva_totalflux_results)\n\n        all_results.extend(case_results)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.6f}' for x in all_results)}]\")\n\nsolve()\n```", "id": "2506613"}]}