{"hands_on_practices": [{"introduction": "在设计或优化任何生物工艺之前，我们必须首先理解其基本的“化学配方”。本练习将重点构建微生物生长的化学计量方程，这是估算理论耗氧量和营养物消耗的关键第一步[@problem_id:2501945]。掌握这项技能对于精确设计培养基配方和通气策略至关重要。", "problem": "一个好氧、碳源受限的分批发酵过程使用葡萄糖作为唯一碳源和能源，氨作为氮源，生产经验式为 $\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$ 的新微生物菌体。假设所有未被同化的碳都完全氧化为二氧化碳，并且水是唯一的还原副产物。没有其他胞外有机副产物形成。以消耗 $1$ 摩尔葡萄糖为基准。\n\n从逐个元素（碳、氢、氧、氮）应用的质量守恒定律出发，构建一个包含氨、氧气、菌体、二氧化碳和水的未知化学计量系数的化学计量反应式。使用菌体对底物的产率（菌体对葡萄糖的产率）$Y_{X/S} = 0.5$ g/g。为确保计算的可复现性，请使用以下原子质量：碳（$12.01$ g/mol）、氢（$1.008$ g/mol）、氧（$16.00$ g/mol）和氮（$14.01$ g/mol）。\n\n报告摩尔需氧量，单位为每摩尔 $\\mathrm{C_6H_{12}O_6}$ 所需的 $\\mathrm{O_2}$ 摩尔数。将您的答案四舍五入到 $4$ 位有效数字，并以 mol $\\mathrm{O_2}$ / mol $\\mathrm{C_6H_{12}O_6}$ 为单位表示。", "solution": "该问题陈述在科学上是合理的，提法明确，并包含足够的信息以获得唯一解。这是生物过程化学计量学中的一个标准问题。我将继续进行推导。\n\n基本任务是确定生化反应中氧气的化学计量系数。该反应涉及消耗葡萄糖（$\\mathrm{C_6H_{12}O_6}$）和氨（$\\mathrm{NH_3}$）来生产微生物菌体（$\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$）、二氧化碳（$\\mathrm{CO_2}$）和水（$\\mathrm{H_2O}$）。\n\n首先，我们以消耗 $1$ 摩尔葡萄糖为基准，建立总的化学计量方程。未知的化学计量系数用 $a, b, c, d,$ 和 $e$ 表示。\n$$1 \\ \\mathrm{C_6H_{12}O_6} + a \\ \\mathrm{NH_3} + b \\ \\mathrm{O_2} \\rightarrow c \\ \\mathrm{CH_{1.8}O_{0.5}N_{0.2}} + d \\ \\mathrm{CO_2} + e \\ \\mathrm{H_2O}$$\n\n解决该系统的核心原则是每个元素的质量守恒：碳（C）、氢（H）、氧（O）和氮（N）。此外，我们还获得了一个宏观产率系数，它提供了必要的第五个约束条件。\n\n我们首先使用给定的原子质量计算底物（葡萄糖，$M_S$）和产物菌体（$M_X$）的摩尔质量：$M_C = 12.01$ g/mol， $M_H = 1.008$ g/mol， $M_O = 16.00$ g/mol，以及 $M_N = 14.01$ g/mol。\n\n葡萄糖的摩尔质量 $M_S$ 为：\n$$M_S = 6 \\times M_C + 12 \\times M_H + 6 \\times M_O = 6(12.01) + 12(1.008) + 6(16.00) = 180.156 \\frac{\\text{g}}{\\text{mol}}$$\n由经验式 $\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$ 表示的菌体的摩尔质量 $M_X$ 为：\n$$M_X = 1 \\times M_C + 1.8 \\times M_H + 0.5 \\times M_O + 0.2 \\times M_N = 1(12.01) + 1.8(1.008) + 0.5(16.00) + 0.2(14.01) = 24.6264 \\frac{\\text{g}}{\\text{mol}}$$\n\n产率系数 $Y_{X/S}$ 给出为 $0.5$ 克菌体/克葡萄糖。这个基于质量的产率必须转换为摩尔产率，它对应于化学计量系数 $c$（每消耗一摩尔葡萄糖所产生的菌体的摩尔数）。\n$$c \\left[ \\frac{\\text{mol biomass}}{\\text{mol glucose}} \\right] = Y_{X/S} \\left[ \\frac{\\text{g biomass}}{\\text{g glucose}} \\right] \\times \\frac{M_S \\left[ \\frac{\\text{g glucose}}{\\text{mol glucose}} \\right]}{M_X \\left[ \\frac{\\text{g biomass}}{\\text{mol biomass}} \\right]}$$\n代入数值：\n$$c = 0.5 \\times \\frac{180.156}{24.6264} \\approx 3.6578$$\n\n在确定系数 $c$ 后，我们从元素平衡中构建一个线性方程组。\n\n1.  **氮（N）平衡**：\n    所有来自氨的氮都被整合到菌体中。\n    $$a \\times 1 = c \\times 0.2 \\implies a = 0.2c$$\n\n2.  **碳（C）平衡**：\n    来自葡萄糖的碳被分配到菌体和二氧化碳之间。\n    $$1 \\times 6 = c \\times 1 + d \\times 1 \\implies d = 6 - c$$\n\n3.  **氢（H）平衡**：\n    $$1 \\times 12 + a \\times 3 = c \\times 1.8 + e \\times 2$$\n    代入 $a = 0.2c$:\n    $$12 + 3(0.2c) = 1.8c + 2e$$\n    $$12 + 0.6c = 1.8c + 2e$$\n    $$2e = 12 - 1.2c \\implies e = 6 - 0.6c$$\n\n4.  **氧（O）平衡**：\n    我们关心的量是 $b$，即摩尔需氧量。\n    $$1 \\times 6 + b \\times 2 = c \\times 0.5 + d \\times 2 + e \\times 1$$\n    $$6 + 2b = 0.5c + 2d + e$$\n    我们现在可以通过代入以 $c$ 表示的 $d$ 和 $e$ 的表达式来求解 $b$。\n    $$6 + 2b = 0.5c + 2(6 - c) + (6 - 0.6c)$$\n    $$6 + 2b = 0.5c + 12 - 2c + 6 - 0.6c$$\n    合并同类项：\n    $$6 + 2b = 18 - (2.0 - 0.5 + 0.6)c$$\n    $$6 + 2b = 18 - 2.1c$$\n    分离含 $b$ 的项：\n    $$2b = 12 - 2.1c$$\n    $$b = 6 - 1.05c$$\n\n这个最终表达式将需氧系数 $b$ 与菌体生产系数 $c$ 直接关联起来。现在，我们代入计算出的 $c$ 值。\n$$c = 0.5 \\times \\frac{180.156}{24.6264} = 3.657800...$$\n$$b = 6 - 1.05 \\times \\left( 3.657800... \\right)$$\n$$b = 6 - 3.840690...$$\n$$b = 2.159310...$$\n\n题目要求答案四舍五入到 $4$ 位有效数字。\n$$b \\approx 2.159$$\n该值表示在指定条件下，消耗 $1$ 摩尔 $\\mathrm{C_6H_{12}O_6}$ 所需的 $\\mathrm{O_2}$ 的摩尔数。", "answer": "$$\\boxed{2.159}$$", "id": "2501945"}, {"introduction": "化学计量学提供了理论蓝图，但细胞的实际代谢是动态的，只能通过实时测量来理解。本练习将演示如何使用来自工业常用工具——尾气分析仪的数据，来计算如呼吸商 ($RQ$) 等关键代谢指标[@problem_id:2502028]。通过分析 $RQ$，您将学会推断碳底物如何在生物质合成和能量生成之间分配，从而为过程监控与控制提供关键见解。", "problem": "一个好氧稳态恒化器在以甘油（化学式为 $\\mathrm{C_3H_8O_3}$）为碳源、铵为氮源的条件下培养一种异养微生物。干燥空气以 $1.000$ mol min$^{-1}$ 的恒定摩尔流量通入，其组成为 $\\mathrm{O_2}$ 摩尔分数 $0.210$ 和 $\\mathrm{N_2}$ 摩尔分数 $0.790$（假设入口 $\\mathrm{CO_2}$ 可忽略不计）。测得干燥尾气的总摩尔流量为 $0.99100$ mol min$^{-1}$，干燥尾气的摩尔分数为 $\\mathrm{O_2}$ 摩尔分数 $0.161453$ 和 $\\mathrm{CO_2}$ 摩尔分数 $0.041372$（其余为 $\\mathrm{N_2}$）。假设理想气体行为，干燥气体中水蒸气可忽略不计，溶解气体持留动力学可忽略不计，且氮气是惰性的。\n\n生物质的经验组成为每碳摩尔（C-mol）$\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$。在完全好氧、非限制性生长条件下，实验确定的生物质对甘油碳的产率为每消耗一碳摩尔甘油碳产生 $0.45$ 碳摩尔生物质。假设在稳态下，所有甘油碳仅有以下两种去向：\n- 完全氧化为 $\\mathrm{CO_2}$ 和 $\\mathrm{H_2O}$。\n- 生物质合成，仅以 $\\mathrm{CO_2}$ 和 $\\mathrm{H_2O}$ 为副产物，并以 $\\mathrm{O_2}$ 为唯一的末端电子受体。\n\n请按以下步骤从基本原理出发进行计算：使用气相摩尔平衡计算摄氧率（OUR）和二氧化碳释放率（CER），并由此计算呼吸商（RQ）。接下来，使用元素平衡，为一摩尔甘油写出一个与给定生物质产率和经验组成一致的、化学计量配平的“生物质合成”反应。最后，将观察到的RQ建模为两种途径（完全氧化和生物质合成）的RQ值的凸组合，以推断路由到完全氧化的甘油摩尔消耗分数 $f$。\n\n仅报告 $f$ 的小数值，保留四位有效数字。报告的值是无量纲的。", "solution": "首先确认该问题在科学上是合理的、提法是明确的，并且基于客观、一致的数据。解题过程将应用质量平衡和元素平衡的基本原理。\n\n首先，我们根据所提供的稳态下气相摩尔流量和组成来确定摄氧率（OUR）和二氧化碳释放率（CER）。计算进口和出口气流中氧气和二氧化碳的摩尔流量。\n\n进口气体摩尔流量：\n进口摩尔流量为 $F_{in} = 1.000$ mol min$^{-1}$。\n$\\mathrm{O_2}$ 的摩尔分数为 $y_{\\mathrm{O_2}, in} = 0.210$。\n$\\mathrm{CO_2}$ 的摩尔分数为 $y_{\\mathrm{CO_2}, in} = 0$。\n进入反应器的氧气摩尔流量为 $F_{\\mathrm{O_2}, in} = F_{in} \\times y_{\\mathrm{O_2}, in} = 1.000 \\text{ mol min}^{-1} \\times 0.210 = 0.210 \\text{ mol min}^{-1}$。\n进入反应器的二氧化碳摩尔流量为 $F_{\\mathrm{CO_2}, in} = F_{in} \\times y_{\\mathrm{CO_2}, in} = 1.000 \\text{ mol min}^{-1} \\times 0 = 0 \\text{ mol min}^{-1}$。\n\n出口气体摩尔流量：\n出口摩尔流量为 $F_{out} = 0.99100$ mol min$^{-1}$。\n$\\mathrm{O_2}$ 的摩尔分数为 $y_{\\mathrm{O_2}, out} = 0.161453$。\n$\\mathrm{CO_2}$ 的摩尔分数为 $y_{\\mathrm{CO_2}, out} = 0.041372$。\n离开反应器的氧气摩尔流量为 $F_{\\mathrm{O_2}, out} = F_{out} \\times y_{\\mathrm{O_2}, out} = 0.99100 \\text{ mol min}^{-1} \\times 0.161453 = 0.16000 \\text{ mol min}^{-1}$。\n离开反应器的二氧化碳摩尔流量为 $F_{\\mathrm{CO_2}, out} = F_{out} \\times y_{\\mathrm{CO_2}, out} = 0.99100 \\text{ mol min}^{-1} \\times 0.041372 = 0.04100 \\text{ mol min}^{-1}$。\n给定的数字是精确指定的，我们将假设它们导出了这些确切的值。\n\nOUR是耗氧速率，CER是二氧化碳生成速率：\n$$OUR = F_{\\mathrm{O_2}, in} - F_{\\mathrm{O_2}, out} = 0.210 - 0.16000 = 0.05000 \\text{ mol min}^{-1}$$\n$$CER = F_{\\mathrm{CO_2}, out} - F_{\\mathrm{CO_2}, in} = 0.04100 - 0 = 0.04100 \\text{ mol min}^{-1}$$\n\n观察到的呼吸商 ($RQ_{obs}$) 是CER与OUR的摩尔比：\n$$RQ_{obs} = \\frac{CER}{OUR} = \\frac{0.04100 \\text{ mol min}^{-1}}{0.05000 \\text{ mol min}^{-1}} = 0.82$$\n\n接下来，我们建立甘油（$\\mathrm{C_3H_8O_3}$）两种可能去向的化学计量关系。\n\n途径1：完全氧化。\n配平的反应式为：\n$$\\mathrm{C_3H_8O_3} + 3.5 \\mathrm{O_2} \\rightarrow 3 \\mathrm{CO_2} + 4 \\mathrm{H_2O}$$\n该途径的呼吸商 $RQ_{ox}$ 是产生的 $\\mathrm{CO_2}$ 摩尔数与消耗的 $\\mathrm{O_2}$ 摩尔数的比值：\n$$RQ_{ox} = \\frac{3}{3.5} = \\frac{6}{7}$$\n\n途径2：生物质合成。\n反应式是为消耗一摩尔甘油生成生物质（$\\mathrm{CH_{1.8}O_{0.5}N_{0.2}}$）而写的，使用铵（$\\mathrm{NH_3}$ 用于元素平衡）作为氮源：\n$$1 \\cdot \\mathrm{C_3H_8O_3} + a' \\cdot \\mathrm{O_2} + b' \\cdot \\mathrm{NH_3} \\rightarrow c' \\cdot \\mathrm{CH_{1.8}O_{0.5}N_{0.2}} + d' \\cdot \\mathrm{CO_2} + e' \\cdot \\mathrm{H_2O}$$\n给定生物质对甘油碳的产率为 $Y_{XS/C} = 0.45$ C-mol 生物质 / C-mol 甘油。由于一摩尔甘油含有 $3$ C-mol，每摩尔甘油产生的生物质摩尔数（以C-mol计）为：\n$$c' = 3 \\text{ C-mol glycerol} \\times \\frac{0.45 \\text{ C-mol biomass}}{1 \\text{ C-mol glycerol}} = 1.35$$\n化学计量系数 $a'$, $b'$, $d'$ 和 $e'$ 通过元素平衡求得：\n- 碳 (C): $3 = c' + d' \\implies 3 = 1.35 + d' \\implies d' = 1.65$\n- 氮 (N): $b' = 0.2 \\cdot c' \\implies b' = 0.2 \\cdot 1.35 = 0.27$\n- 氢 (H): $8 + 3b' = 1.8c' + 2e' \\implies 8 + 3(0.27) = 1.8(1.35) + 2e' \\implies 8.81 = 2.43 + 2e' \\implies e' = 3.19$\n- 氧 (O): $3 + 2a' = 0.5c' + 2d' + e' \\implies 3 + 2a' = 0.5(1.35) + 2(1.65) + 3.19 \\implies 3 + 2a' = 0.675 + 3.3 + 3.19 = 7.165 \\implies a' = 2.0825$\n\n生物质合成的呼吸商 $RQ_{syn}$ 为：\n$$RQ_{syn} = \\frac{d'}{a'} = \\frac{1.65}{2.0825}$$\n\n最后，我们将观察到的RQ建模为两种途径RQ的凸组合。设 $f$ 是路由到完全氧化的甘油摩尔消耗分数。路由到生物质合成的分数是 $(1-f)$。\n释放的总 $\\mathrm{CO_2}$ 是来自每个途径的 $\\mathrm{CO_2}$ 的加权和，与该途径中消耗的甘油摩尔数成正比。$\\mathrm{O_2}$ 的消耗也是如此。\n$$RQ_{obs} = \\frac{\\text{释放的总 } \\mathrm{CO_2}}{\\text{消耗的总 } \\mathrm{O_2}} = \\frac{f \\cdot 3 + (1-f) \\cdot 1.65}{f \\cdot 3.5 + (1-f) \\cdot 2.0825}$$\n代入 $RQ_{obs} = 0.82$ 并求解 $f$：\n$$0.82 = \\frac{3f + 1.65 - 1.65f}{3.5f + 2.0825 - 2.0825f}$$\n$$0.82 = \\frac{1.35f + 1.65}{1.4175f + 2.0825}$$\n$$0.82 \\cdot (1.4175f + 2.0825) = 1.35f + 1.65$$\n$$1.16235f + 1.70765 = 1.35f + 1.65$$\n$$1.70765 - 1.65 = 1.35f - 1.16235f$$\n$$0.05765 = 0.18765f$$\n$$f = \\frac{0.05765}{0.18765} \\approx 0.30722089$$\n按要求保留四位有效数字，我们得到分数 $f$。", "answer": "$$\\boxed{0.3072}$$", "id": "2502028"}, {"introduction": "生物工艺工程的最终目标是运行一个不仅科学上可行，而且经济上可行的过程。这项综合性练习挑战您将传质、动力学、热力学和经济学原理整合到一个整体优化问题中[@problem_id:2502008]。您将确定最佳操作条件——例如批次时间 $t_b$、搅拌功率 $P/V$ 和体积 $V$——以在遵守氧气供应、冷却能力和下游处理限制等关键约束的同时，实现利润最大化。", "problem": "要求您编写一个完整、可运行的程序，该程序为一个单批次好氧工业发酵制定并解决利润最大化问题，使用一个基于机理的模型。解决方案必须从微生物生长和过程工程的基本原理推导得出，并表示为对明确指定的决策变量的优化。您的程序必须计算出最优决策变量值，以在满足体积传质系数 ($k_La$)、单位体积功率输入 ($P/V$)、冷却能力和下游处理通量等约束条件的同时，最大化每批次的利润。最终输出必须按规定将一系列测试用例的结果汇总为单行。\n\n定义与建模基础：\n- 体积传质系数 ($k_La$) 遵循一个与单位体积搅拌功率和表观气体流速强度相关的幂律关系。对于一个工作体积为 $V$ (单位: $\\mathrm{m^3}$)，单位体积搅拌功率为 $P/V$ (单位: $\\mathrm{W \\, m^{-3}}$) 和表观曝气强度为 $q_v$ (单位: $\\mathrm{h^{-1}}$，解释为标准条件下每小时的反应器体积倍数) 的容器，该关系式为\n$$\nk_La = k_0 \\, (P/V)^{\\alpha} \\, q_v^{\\beta},\n$$\n其中 $k_La$ 的单位为 $\\mathrm{h^{-1}}$。\n- 在溶解氧控制在饱和度的 $\\phi$ 分数下，单位体积的氧传递速率 (OTR) (单位: $\\mathrm{mol \\, m^{-3} \\, h^{-1}}$) 由以下模型描述\n$$\n\\mathrm{OTR} = k_La \\, (1 - \\phi) \\, C^\\ast_{\\mathrm{O_2}},\n$$\n其中 $C^\\ast_{\\mathrm{O_2}}$ 是在给定温度和压力下，肉汤中氧气的饱和浓度 (单位: $\\mathrm{mol \\, m^{-3}}$)，而 $\\phi \\in (0,1)$ 是溶解氧分数。\n- 生物质 $X$ (单位: $\\mathrm{g \\, L^{-1}}$) 所需的单位体积耗氧速率 (OUR) 是\n$$\n\\mathrm{OUR} = q_{\\mathrm{O_2}} \\, X \\, 10^3,\n$$\n其中 $q_{\\mathrm{O_2}}$ 的单位为 $\\mathrm{mol \\, g^{-1} \\, h^{-1}}$，$10^3$ 用于将 $\\mathrm{L}$ 转换为 $\\mathrm{m^3}$。\n- 无资源限制的生长近似为指数生长\n$$\nX_{\\mathrm{uncon}}(t_b) = X_0 \\, e^{\\mu_{\\max} \\, t_b},\n$$\n其中 $\\mu_{\\max}$ 的单位为 $\\mathrm{h^{-1}}$，$X_0$ 是接种物浓度，单位为 $\\mathrm{g \\, L^{-1}}$，$t_b$ 是批次时间，单位为 $\\mathrm{h}$。\n- 氧限制的生物质浓度上限为\n$$\nX_{\\mathrm{O_2,lim}} = \\frac{\\mathrm{OTR}}{q_{\\mathrm{O_2}} \\, 10^3}.\n$$\n- 单位体积的冷却能力是一个限制产热的硬性约束。使用 Thornton 法则，每消耗一摩尔氧气的比热释放为 $\\Delta H_{\\mathrm{ox}}$ (单位: $\\mathrm{J \\, mol^{-1}}$)。单位体积的冷却能力为 $Q_{c,\\max}$ (单位: $\\mathrm{W \\, m^{-3}}$)。由于 $\\mathrm{OUR}$ 的单位是 $\\mathrm{mol \\, m^{-3} \\, h^{-1}}$，单位体积的产热率为\n$$\n\\dot{Q}_{\\mathrm{gen}}/V = \\Delta H_{\\mathrm{ox}} \\, \\frac{\\mathrm{OUR}}{3600},\n$$\n因此，热限制的生物质浓度为\n$$\nX_{\\mathrm{heat,lim}} = \\frac{Q_{c,\\max} \\, 3600}{\\Delta H_{\\mathrm{ox}} \\, q_{\\mathrm{O_2}} \\, 10^3}.\n$$\n- 可实现的最终生物质浓度被建模为\n$$\nX_{\\mathrm{final}} = \\min\\left\\{ X_{\\mathrm{uncon}}(t_b), \\, X_{\\mathrm{O_2,lim}}, \\, X_{\\mathrm{heat,lim}} \\right\\}.\n$$\n- 产物形成与生长相关，产率为 $Y_{pX}$ (单位: $\\mathrm{g \\, 产物 \\, g^{-1} \\, 生物质}$)，得到最终产物浓度\n$$\nP_{\\mathrm{conc}} = Y_{pX} \\, \\max\\{0, X_{\\mathrm{final}} - X_0\\} \\quad \\text{(单位: } \\mathrm{g \\, L^{-1}} \\text{)}.\n$$\n- 每批次的总产物质量为\n$$\nM_p = P_{\\mathrm{conc}} \\, V \\quad \\text{(单位: } \\mathrm{kg} \\text{, 因为 } \\mathrm{g \\, L^{-1}} \\cdot \\mathrm{m^3} = \\mathrm{kg}).\n$$\n- 下游处理 (DSP) 通量施加了一个硬性约束，即每批次产物 $M_p$ 不得超过在周期时间 $t_{\\mathrm{cycle}} = t_b + t_{\\mathrm{turn}}$ 内可处理的最大量：\n$$\nM_p \\le R_{\\mathrm{DSP}} \\, t_{\\mathrm{cycle}},\n$$\n其中 $R_{\\mathrm{DSP}}$ 是最大 DSP 速率，单位为 $\\mathrm{kg \\, h^{-1}}$，$t_{\\mathrm{turn}}$ 是批次之间固定的周转时间，单位为 $\\mathrm{h}$。\n- 每批次的搅拌能源成本由轴功率计算得出\n$$\nC_{\\mathrm{agit}} = \\frac{P}{1000} \\, c_{\\mathrm{el}} \\, t_b = \\frac{P/V \\cdot V}{1000} \\, c_{\\mathrm{el}} \\, t_b,\n$$\n其中 $c_{\\mathrm{el}}$ 的单位为 $\\mathrm{USD \\, kWh^{-1}}$，$P$ 的单位为 $\\mathrm{W}$，时间单位为 $\\mathrm{h}$。\n- 每批次的曝气成本为\n$$\nC_{\\mathrm{air}} = q_v \\, V \\, t_b \\, c_{\\mathrm{air}},\n$$\n其中 $c_{\\mathrm{air}}$ 的单位为 $\\mathrm{USD \\, m^{-3}}$ (标准条件下)。\n- 每批次的原材料成本与产物质量成正比：\n$$\nC_{\\mathrm{raw}} = c_{\\mathrm{raw}} \\, M_p,\n$$\n其中 $c_{\\mathrm{raw}}$ 的单位为 $\\mathrm{USD \\, kg^{-1}}$。\n- 此外，还会产生固定的每批次成本 $C_{\\mathrm{fix}}$ (单位: $\\mathrm{USD}$)。\n- 收入为\n$$\n\\mathrm{Rev} = p_{\\mathrm{prod}} \\, M_p,\n$$\n其中 $p_{\\mathrm{prod}}$ 的单位为 $\\mathrm{USD \\, kg^{-1}}$。\n- 每批次的利润为\n$$\n\\Pi = \\mathrm{Rev} - \\left(C_{\\mathrm{agit}} + C_{\\mathrm{air}} + C_{\\mathrm{raw}} + C_{\\mathrm{fix}}\\right).\n$$\n\n待优化的决策变量：\n- 批次时间 $t_b$ (单位: $\\mathrm{h}$)。\n- 单位体积搅拌功率 $P/V$ (单位: $\\mathrm{W \\, m^{-3}}$)。\n- 曝气强度 $q_v$ (单位: $\\mathrm{h^{-1}}$)。\n- 工作体积 $V$ (单位: $\\mathrm{m^3}$)。\n\n需执行的约束条件：\n- $P/V$ 的界限：$P/V_{\\min} \\le P/V \\le P/V_{\\max}$。\n- $q_v$ 的界限：$q_{v,\\min} \\le q_v \\le q_{v,\\max}$。\n- $V$ 的界限：$V_{\\min} \\le V \\le V_{\\max}$。\n- $t_b$ 的界限：$t_{b,\\min} \\le t_b \\le t_{b,\\max}$。\n- 传质硬件约束：$k_La \\le k_{La,\\max}$。\n- 冷却能力约束：$\\dot{Q}_{\\mathrm{gen}}/V \\le Q_{c,\\max}$，等效于上述的 $X \\le X_{\\mathrm{heat,lim}}$。\n- 下游处理通量约束：$M_p \\le R_{\\mathrm{DSP}} (t_b + t_{\\mathrm{turn}})$。\n\n目标：\n- 在满足所有约束条件的情况下，最大化批次利润 $\\Pi$。\n\n您的程序应通过对指定的决策变量网格进行离散网格搜索来解决此问题，并为每个测试用例返回最佳可行解。\n\n测试套件：\n对于每个测试用例，您都会获得相应的参数。所有数字都应按所述单位进行解释。您的程序必须对所有测试用例使用完全相同的决策变量网格：\n- $t_b \\in \\{\\,12, 18, 24, 30, 36, 42, 48\\,\\}$ $\\mathrm{h}$。\n- $P/V \\in \\{\\,100, 200, 400, 600, 800, 1000, 1200, 1500\\,\\}$ $\\mathrm{W \\, m^{-3}}$。\n- $q_v \\in \\{\\,0.5, 1, 2, 4, 6, 8, 9\\,\\}$ $\\mathrm{h^{-1}}$。\n- $V \\in \\{\\,4, 6, 8, 10, 12\\,\\}$ $\\mathrm{m^3}$。\n\n所有测试用例的通用常量，除非每个案例另有覆盖：\n- $X_0 = 0.5$ $\\mathrm{g \\, L^{-1}}$。\n- $\\mu_{\\max} = 0.20$ $\\mathrm{h^{-1}}$。\n- $\\phi = 0.30$ (无量纲)。\n- $\\Delta H_{\\mathrm{ox}} = 460000$ $\\mathrm{J \\, mol^{-1}}$。\n- $Y_{pX} = 0.5$ $\\mathrm{g \\, g^{-1}}$。\n- $t_{\\mathrm{turn}} = 6$ $\\mathrm{h}$。\n- $P/V_{\\min} = 100$ $\\mathrm{W \\, m^{-3}}$, $P/V_{\\max} = 1500$ $\\mathrm{W \\, m^{-3}}$。\n- $q_{v,\\min} = 0.5$ $\\mathrm{h^{-1}}$, $q_{v,\\max} = 9$ $\\mathrm{h^{-1}}$。\n- $V_{\\min} = 4$ $\\mathrm{m^3}$, $V_{\\max} = 12$ $\\mathrm{m^3}$。\n- $t_{b,\\min} = 12$ $\\mathrm{h}$, $t_{b,\\max} = 48$ $\\mathrm{h}$。\n\n每个测试用例 $j$ 指定了以下参数元组：\n$\\left(k_0, \\alpha, \\beta, k_{La,\\max}, C^\\ast_{\\mathrm{O_2}}, q_{\\mathrm{O_2}}, Q_{c,\\max}, R_{\\mathrm{DSP}}, p_{\\mathrm{prod}}, c_{\\mathrm{el}}, c_{\\mathrm{air}}, c_{\\mathrm{raw}}, C_{\\mathrm{fix}}\\right)$，单位如上定义。\n\n提供以下五个案例：\n- 案例 1：$\\left(3.5, 0.5, 0.5, 350, 0.24, 0.003, 30000, 80, 80, 0.12, 0.02, 5, 1000\\right)$。\n- 案例 2：与案例 1 相同，但 $R_{\\mathrm{DSP}} = 2$。\n- 案例 3：$\\left(3.5, 0.5, 0.5, 350, 0.24, 0.010, 8000, 80, 80, 0.12, 0.02, 5, 1000\\right)$。\n- 案例 4：$\\left(3.5, 0.5, 0.5, 200, 0.14, 0.003, 30000, 80, 80, 0.12, 0.02, 5, 1000\\right)$。\n- 案例 5：$\\left(3.5, 0.5, 0.5, 120, 0.24, 0.003, 30000, 80, 80, 0.12, 0.02, 5, 1000\\right)$。\n\n对单位和输出的要求：\n- 所有内部计算必须遵循上述单位。\n- 最终输出必须是包含五个测试用例结果的单行，形式为一个包含五个子列表的列表。对于每个测试用例，输出包含五个浮点数的子列表：$[\\Pi, t_b, P/V, q_v, V]$，其中 $\\Pi$ 是每批次的最大利润 (单位: $\\mathrm{USD}$)，$t_b$ 的单位是 $\\mathrm{h}$，$P/V$ 的单位是 $\\mathrm{W \\, m^{-3}}$，$q_v$ 的单位是 $\\mathrm{h^{-1}}$，$V$ 的单位是 $\\mathrm{m^3}$。您的程序应生成包含结果的单行输出，格式为用方括号括起来的逗号分隔列表（例如，“[[...],[...],...]”）。\n\n您的算法必须是确定性的，并且不得需要任何用户输入。您必须仅使用指定的运行时环境。结果必须是数值浮点数（不要在打印输出中包含单位），并使用十进制表示法。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上基于既定的生物过程工程原理，内部一致且良态。所有必要的参数、约束和目标函数都已明确定义，从而可以得到一个确定性的解。该问题是工业过程优化任务的一个标准（尽管简化了）的表示。\n\n目标是最大化每批次的利润 $\\Pi$，该利润是四个决策变量的函数：批次时间 $t_b$、单位体积搅拌功率 $P/V$、表观曝气强度 $q_v$ 和工作体积 $V$。利润函数由下式给出：\n$$\n\\Pi(t_b, P/V, q_v, V) = \\mathrm{Rev} - \\left(C_{\\mathrm{agit}} + C_{\\mathrm{air}} + C_{\\mathrm{raw}} + C_{\\mathrm{fix}}\\right)\n$$\n最大化过程受一系列操作和物理约束的限制。指定的解决方法是对决策变量的定义空间进行离散网格搜索。\n\n该算法通过系统地评估所提供网格中决策变量的每个组合来进行。对于每个组合，我们计算过程结果并根据所有约束检查其可行性。仅对可行点计算利润。产生最高利润的组合被选为最优解。\n\n对于四维搜索网格中的每个点 $(t_b, P/V, q_v, V)$，详细步骤如下：\n\n1.  **计算体积传质系数 ($k_{La}$):**\n    $k_{La}$ 值使用给定的经验相关式确定：\n    $$\n    k_{La} = k_0 \\, (P/V)^{\\alpha} \\, q_v^{\\beta}\n    $$\n    其中 $k_0$、$\\alpha$ 和 $\\beta$ 是特定于发酵罐几何形状和流体性质的参数。\n\n2.  **验证 $k_{La}$ 的硬件约束:**\n    计算出的 $k_{La}$ 不得超过最大允许值 $k_{La,\\max}$，该值由硬件限制（例如，为防止过度发泡或细胞剪切）决定。\n    $$\n    \\text{如果 } k_{La} > k_{La,\\max}，\\text{ 则该操作点不可行。舍弃并继续下一个点。}\n    $$\n\n3.  **确定可达到的生物质浓度 ($X_{\\mathrm{final}}$):**\n    最终生物质浓度受三个因素中的最小值限制：无约束生长潜力、氧气供应和散热能力。\n\n    a.  **无约束生长极限 ($X_{\\mathrm{uncon}}$):** 这是在只有时间和内在动力学是限制因素的情况下，遵循指数生长模型可达到的生物质浓度：\n        $$\n        X_{\\mathrm{uncon}}(t_b) = X_0 \\, e^{\\mu_{\\max} \\, t_b}\n        $$\n\n    b.  **氧传递极限 ($X_{\\mathrm{O_2,lim}}$):** 当微生物耗氧速率 (OUR) 等于系统可提供的最大氧传递速率 (OTR) 时，达到此极限。OTR 为：\n        $$\n        \\mathrm{OTR} = k_La \\, (1 - \\phi) \\, C^\\ast_{\\mathrm{O_2}}\n        $$\n        此 OTR 可支持的生物质浓度为：\n        $$\n        X_{\\mathrm{O_2,lim}} = \\frac{\\mathrm{OTR}}{q_{\\mathrm{O_2}} \\, 10^3}\n        $$\n\n    c.  **散热极限 ($X_{\\mathrm{heat,lim}}$):** 此极限由发酵罐的最大冷却能力 $Q_{c,\\max}$ 施加。产生的热量与消耗的氧气成正比。冷却系统可支持的生物质浓度为：\n        $$\n        X_{\\mathrm{heat,lim}} = \\frac{Q_{c,\\max} \\, 3600}{\\Delta H_{\\mathrm{ox}} \\, q_{\\mathrm{O_2}} \\, 10^3}\n        $$\n        对于给定的测试用例，该值为常数。\n\n    d.  **最终生物质浓度:** 实际的最终生物质浓度是这三个极限的瓶颈：\n        $$\n        X_{\\mathrm{final}} = \\min\\left\\{ X_{\\mathrm{uncon}}(t_b), \\, X_{\\mathrm{O_2,lim}}, \\, X_{\\mathrm{heat,lim}} \\right\\}\n        $$\n\n4.  **计算产物质量 ($M_p$):**\n    产物形成被建模为与生物质生长直接相关。最终产物浓度 ($P_{\\mathrm{conc}}$) 和总产物质量 ($M_p$) 为：\n    $$\n    P_{\\mathrm{conc}} = Y_{pX} \\, \\max\\{0, X_{\\mathrm{final}} - X_0\\}\n    $$\n    $$\n    M_p = P_{\\mathrm{conc}} \\, V\n    $$\n\n5.  **验证下游处理 (DSP) 约束:**\n    一个批次的总产物质量不能超过下游纯化设备在总周期时间 ($t_{\\mathrm{cycle}} = t_b + t_{\\mathrm{turn}}$) 内的处理能力。\n    $$\n    \\text{如果 } M_p > R_{\\mathrm{DSP}} \\, (t_b + t_{\\mathrm{turn}})，\\text{ 则该点不可行。舍弃并继续。}\n    $$\n\n6.  **计算利润 ($\\Pi$):**\n    如果操作点可行，则计算利润。\n    -   收入：$\\mathrm{Rev} = p_{\\mathrm{prod}} \\, M_p$\n    -   成本：\n        -   $C_{\\mathrm{agit}} = \\frac{(P/V) \\cdot V}{1000} \\, c_{\\mathrm{el}} \\, t_b$\n        -   $C_{\\mathrm{air}} = q_v \\, V \\, t_b \\, c_{\\mathrm{air}}$\n        -   $C_{\\mathrm{raw}} = c_{\\mathrm{raw}} \\, M_p$\n        -   $C_{\\mathrm{fix}}$ 是给定的常数。\n    -   利润：$\\Pi = \\mathrm{Rev} - (C_{\\mathrm{agit}} + C_{\\mathrm{air}} + C_{\\mathrm{raw}} + C_{\\mathrm{fix}})$\n\n7.  **更新最优解:**\n    将当前可行点的计算利润 $\\Pi$ 与迄今为止找到的最大利润 $\\Pi_{\\max}$ 进行比较。如果 $\\Pi > \\Pi_{\\max}$，则将 $\\Pi_{\\max}$ 更新为 $\\Pi$，并将当前的决策变量集 $(t_b, P/V, q_v, V)$ 存储为新的最优解。使用严格不等式确保在利润相等的情况下，保留网格搜索中遇到的第一组最优参数。这提供了一个确定性的平局打破规则。\n\n对搜索网格中的所有点重复此完整过程。搜索完成后，存储的最优变量和相应的最大利润构成一个测试用例的解。然后对所有指定的测试用例重复此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a profit-maximization problem for a single-batch aerobic industrial \n    fermentation using a discrete grid search over decision variables.\n    \"\"\"\n\n    # --- Decision Variable Grids ---\n    tb_grid = [12.0, 18.0, 24.0, 30.0, 36.0, 42.0, 48.0]  # h\n    PV_grid = [100.0, 200.0, 400.0, 600.0, 800.0, 1000.0, 1200.0, 1500.0]  # W/m^3\n    qv_grid = [0.5, 1.0, 2.0, 4.0, 6.0, 8.0, 9.0]  # h^-1\n    V_grid = [4.0, 6.0, 8.0, 10.0, 12.0]  # m^3\n\n    # --- Common Constants ---\n    X0 = 0.5  # g/L, inoculum concentration\n    mu_max = 0.20  # h^-1, max specific growth rate\n    phi = 0.30  # dimensionless, DO fraction of saturation\n    Delta_H_ox = 460000.0  # J/mol, Thornton rule heat release\n    Y_pX = 0.5  # g/g, product yield on biomass\n    t_turn = 6.0  # h, turnaround time\n\n    # --- Test Cases ---\n    # (k0, alpha, beta, kLa_max, C_star_O2, q_O2, Qc_max, R_DSP, p_prod, c_el, c_air, c_raw, C_fix)\n    test_cases = [\n        (3.5, 0.5, 0.5, 350.0, 0.24, 0.003, 30000.0, 80.0, 80.0, 0.12, 0.02, 5.0, 1000.0),\n        (3.5, 0.5, 0.5, 350.0, 0.24, 0.003, 30000.0, 2.0, 80.0, 0.12, 0.02, 5.0, 1000.0),\n        (3.5, 0.5, 0.5, 350.0, 0.24, 0.010, 8000.0, 80.0, 80.0, 0.12, 0.02, 5.0, 1000.0),\n        (3.5, 0.5, 0.5, 200.0, 0.14, 0.003, 30000.0, 80.0, 80.0, 0.12, 0.02, 5.0, 1000.0),\n        (3.5, 0.5, 0.5, 120.0, 0.24, 0.003, 30000.0, 80.0, 80.0, 0.12, 0.02, 5.0, 1000.0),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        k0, alpha, beta, kLa_max, C_star_O2, q_O2, Qc_max, R_DSP, p_prod, c_el, c_air, c_raw, C_fix = case\n\n        max_profit = -float('inf')\n        optimal_vars = [0.0, 0.0, 0.0, 0.0, 0.0] # Pi, tb, P/V, qv, V\n\n        # Pre-calculate constant heat-limited biomass concentration for the case\n        X_heat_lim = (Qc_max * 3600.0) / (Delta_H_ox * q_O2 * 1000.0)\n\n        for V in V_grid:\n            for qv in qv_grid:\n                for PV in PV_grid:\n                    # Calculate kLa based on P/V and qv\n                    kLa = k0 * (PV**alpha) * (qv**beta)\n                    \n                    # 1. kLa constraint\n                    if kLa > kLa_max:\n                        continue\n                    \n                    # Calculate OTR and O2-limited biomass\n                    OTR = kLa * (1.0 - phi) * C_star_O2\n                    X_O2_lim = OTR / (q_O2 * 1000.0)\n\n                    for tb in tb_grid:\n                        # Calculate unconstrained biomass\n                        X_uncon = X0 * np.exp(mu_max * tb)\n\n                        # Determine final biomass concentration\n                        X_final = min(X_uncon, X_O2_lim, X_heat_lim)\n\n                        # Calculate product mass\n                        P_conc = Y_pX * max(0.0, X_final - X0)\n                        M_p = P_conc * V  # units: g/L * m^3 = kg\n\n                        # 2. DSP constraint\n                        t_cycle = tb + t_turn\n                        M_p_max_dsp = R_DSP * t_cycle\n                        if M_p > M_p_max_dsp:\n                            continue\n                        \n                        # Calculate Revenue\n                        revenue = p_prod * M_p\n                        \n                        # Calculate Costs\n                        C_agit = (PV * V / 1000.0) * c_el * tb\n                        C_air = qv * V * tb * c_air\n                        C_raw = c_raw * M_p\n                        \n                        total_cost = C_agit + C_air + C_raw + C_fix\n                        \n                        # Calculate Profit\n                        profit = revenue - total_cost\n\n                        if profit > max_profit:\n                            max_profit = profit\n                            optimal_vars = [profit, tb, PV, qv, V]\n        \n        all_results.append(optimal_vars)\n\n    # Format the output string\n    sublist_strs = [f\"[{','.join(map(str, r))}]\" for r in all_results]\n    output_str = f\"[{','.join(sublist_strs)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2502008"}]}