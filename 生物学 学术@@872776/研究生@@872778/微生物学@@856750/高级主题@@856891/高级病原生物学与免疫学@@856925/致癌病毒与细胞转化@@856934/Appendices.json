{"hands_on_practices": [{"introduction": "致癌病毒通常通过靶向关键的细胞调节蛋白来发挥作用。我们可以使用简洁的数学模型，来超越定性描述，从而对这一过程获得定量的理解。这项练习将向您展示如何为肿瘤抑制蛋白 $p53$ 被人乳头瘤病毒（HPV）的 E6 蛋白降解的过程建立动力学模型，并量化其对细胞的深远影响 [@problem_id:2516291]。", "problem": "一个哺乳动物细胞维持着一个肿瘤蛋白 p53 (p53) 池，p53 在其中被持续合成和降解。考虑一个混合均匀的单细胞，其中 p53 以近似恒定的速率 $s$（零级合成）合成，并通过泛素-蛋白酶体系统 (UPS) 以一级动力学方式被清除，其降解速率常数为 $k$。高危型人乳头瘤病毒 (HPV) 表达 E6 癌蛋白，该蛋白招募 E6 相关蛋白 (E6-AP) 以增强 p53 的泛素化，从而有效地将一级降解速率常数增加一个乘法因子 $\\gamma>1$，而合成速率保持不变。\n\n仅从以下两点出发：(i) 质量平衡原理，即某物质随时间的变化率等于其输入速率减去其移除速率；以及 (ii) 一级动力学和半衰期的定义，完成以下任务：\n\n1. 在没有 HPV E6 的情况下，推导 p53 拷贝数 $P(t)$ 的时间动态微分方程。定义稳态 $P_{\\mathrm{ss}}$，并用 $s$ 和 $k$ 表示它。然后，当 E6 将降解速率常数增加到 $k^{\\prime}=\\gamma k$ 时，表示新的稳态 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$。\n\n2. 使用一级过程的半衰期定义，将 $k$ 与 p53 的基线半衰期 $t_{1/2}$ 联系起来。然后，使用参数集 $s=9.0$ 分子 s$^{-1}$ 细胞$^{-1}$，$t_{1/2}=30$ 分钟和 $\\gamma=4.0$ 计算 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 的数值。将您的答案四舍五入到三位有效数字。以“分子/细胞”为单位表示您的最终答案。\n\n3. 如果细胞凋亡的启动随稳态 p53 丰度单调增加，请定性地简要解释在 DNA 损伤信号下，从 $P_{\\mathrm{ss}}$ 到 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 的变化预计将如何影响细胞凋亡的倾向。\n\n您最终报告的量必须是 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 的值，且为一个单独的数字。", "solution": "所述问题具有科学依据，内容自洽，且表述清晰。它描述了一个蛋白质动力学的经典模型及其被病毒癌蛋白扰动的情况，这是定量生物学和病毒学中的一个标准课题。所提供的参数在生物学上是合理的。没有逻辑矛盾或含糊不清之处。我们可以开始解题了。\n\n该问题需要分三部分进行分析。我们将按顺序处理每个部分。\n\n第 1 部分：推导控制微分方程和稳态表达式。\n\n基本原理是单个细胞体积内 p53 蛋白拷贝数 $P(t)$ 的质量平衡方程。$P(t)$ 随时间的变化率是其合成速率和移除速率之差：\n$$\n\\frac{dP(t)}{dt} = (\\text{合成速率}) - (\\text{移除速率})\n$$\n问题指出合成为零级过程，意味着其速率是一个常数，我们用 $s$ 表示。单位是分子/单位时间。\n$$\n\\text{合成速率} = s\n$$\n在没有人乳头瘤病毒 (HPV) 的情况下，降解遵循一级动力学。这意味着移除速率与该物质的当前量 $P(t)$ 成正比。比例常数是降解速率常数 $k$。\n$$\n\\text{移除速率} = k P(t)\n$$\n将这些项组合起来，得到未感染细胞中 p53 拷贝数的时间动态微分方程：\n$$\n\\frac{dP(t)}{dt} = s - k P(t)\n$$\n稳态被定义为浓度或拷贝数不再随时间变化的条件。在数学上，这对应于时间导数为零的状态。设 $P_{\\mathrm{ss}}$ 为稳态拷贝数。\n$$\n\\frac{d P_{\\mathrm{ss}}}{dt} = 0\n$$\n将此代入微分方程，得到：\n$$\n0 = s - k P_{\\mathrm{ss}}\n$$\n求解 $P_{\\mathrm{ss}}$，得到以合成和降解速率表示的稳态 p53 拷贝数：\n$$\nP_{\\mathrm{ss}} = \\frac{s}{k}\n$$\n现在，我们考虑存在 HPV E6 癌蛋白的情况。问题指出 E6 将降解速率提高了一个乘法因子 $\\gamma > 1$，而合成速率 $s$ 保持不变。因此，新的降解速率常数 $k^{\\prime}$ 为：\n$$\nk^{\\prime} = \\gamma k\n$$\n控制微分方程相应地被修改为：\n$$\n\\frac{dP(t)}{dt} = s - k^{\\prime} P(t) = s - (\\gamma k) P(t)\n$$\n新的稳态，我们表示为 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$，同样通过将时间导数设为零来求得：\n$$\n0 = s - \\gamma k P_{\\mathrm{ss}}^{(\\mathrm{E6})}\n$$\n求解新的稳态拷贝数，得到：\n$$\nP_{\\mathrm{ss}}^{(\\mathrm{E6})} = \\frac{s}{\\gamma k}\n$$\n通过观察可以清楚地看到 $P_{\\mathrm{ss}}^{(\\mathrm{E6})} = \\frac{1}{\\gamma} P_{\\mathrm{ss}}$。由于 $\\gamma > 1$，E6 的存在降低了 p53 的稳态水平。\n\n第 2 部分：速率常数与半衰期的关系及数值计算。\n\n对于经历一级衰变过程的物质，其半衰期 $t_{1/2}$ 是其浓度降至初始值一半所需的时间。考虑在没有合成的情况下的衰变过程，由 $\\frac{dP}{dt} = -kP$ 描述。该方程的解为 $P(t) = P_0 \\exp(-kt)$，其中 $P_0$ 是 $t=0$ 时的初始浓度。\n根据半衰期的定义，在 $t=t_{1/2}$ 时，我们有 $P(t_{1/2}) = \\frac{1}{2} P_0$。\n$$\n\\frac{1}{2} P_0 = P_0 \\exp(-k t_{1/2})\n$$\n两边同除以 $P_0$（非零），然后取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -k t_{1/2}\n$$\n$$\n-\\ln(2) = -k t_{1/2}\n$$\n这就给出了一级速率常数和半衰期之间的基本关系：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}}\n$$\n我们现在可以将这个 $k$ 的表达式代入我们推导出的 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 公式中：\n$$\nP_{\\mathrm{ss}}^{(\\mathrm{E6})} = \\frac{s}{\\gamma k} = \\frac{s}{\\gamma \\left(\\frac{\\ln(2)}{t_{1/2}}\\right)} = \\frac{s t_{1/2}}{\\gamma \\ln(2)}\n$$\n我们已知以下参数值：\n$s = 9.0$ 分子 s$^{-1}$ 细胞$^{-1}$\n$t_{1/2} = 30$ 分钟\n$\\gamma = 4.0$\n\n在计算之前，我们必须确保单位的一致性。合成速率 $s$ 的单位是秒，而半衰期 $t_{1/2}$ 的单位是分钟。我们将分钟转换为秒：\n$$\nt_{1/2} = 30 \\text{ 分钟} \\times \\frac{60 \\text{ 秒}}{1 \\text{ 分钟}} = 1800 \\text{ 秒}\n$$\n现在我们将数值代入 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 的表达式中：\n$$\nP_{\\mathrm{ss}}^{(\\mathrm{E6})} = \\frac{(9.0 \\text{ 秒}^{-1}) (1800 \\text{ 秒})}{(4.0) \\ln(2)} = \\frac{16200}{4.0 \\ln(2)} = \\frac{4050}{\\ln(2)}\n$$\n使用 $\\ln(2) \\approx 0.693147...$ 的值，我们计算最终的数值结果：\n$$\nP_{\\mathrm{ss}}^{(\\mathrm{E6})} \\approx \\frac{4050}{0.693147} \\approx 5842.86 \\text{ 分子/细胞}\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nP_{\\mathrm{ss}}^{(\\mathrm{E6})} \\approx 5840 \\text{ 分子/细胞}\n$$\n用科学记数法表示，即为 $5.84 \\times 10^3$ 分子/细胞。\n\n第 3 部分：定性解释。\n\n计算表明，在存在 HPV E6 的情况下，p53 的稳态丰度 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$ 降低为其正常值 $P_{\\mathrm{ss}}$ 的 $1/\\gamma$。当 $\\gamma = 4.0$ 时，这相当于细胞 p53 池减少了 $75\\%$。p53 蛋白是一种关键的肿瘤抑制因子，常被称为“基因组的守护者”，其部分功能是在响应细胞应激信号（如 DNA 损伤）时诱导细胞凋亡（程序性细胞死亡）。\n\n问题指出，细胞凋亡的倾向随 p53 的稳态丰度单调增加。因此，p53 水平从 $P_{\\mathrm{ss}}$ 急剧下降到 $P_{\\mathrm{ss}}^{(\\mathrm{E6})}$，会显著削弱细胞在 DNA 受损时触发细胞凋亡的能力。这种凋亡检查点的损伤使得具有潜在致癌突变的细胞能够存活、增殖并积累更多的遗传损伤，从而增加了恶性转化的风险。这一分子机制是高危型 HPV 致癌性的主要原因之一。", "answer": "$$ \\boxed{5.84 \\times 10^3} $$", "id": "2516291"}, {"introduction": "在分子层面理解了病毒的致癌机制后，一个关键的后续步骤是量化其对公共卫生的影响。人群归因分数（Population Attributable Fraction, PAF）是衡量这一影响的核心流行病学指标，它估算了如果消除某个风险因素（如病毒感染），可以避免多大比例的疾病发生。这项练习将引导您从基本原理出发，推导并计算由高危型 HPV 感染导致宫颈癌的 PAF，从而将分子病毒学与流行病学联系起来 [@problem_id:2516234]。", "problem": "持续感染致癌型人类乳头瘤病毒（HPV）可驱动宫颈上皮细胞转化，最终导致浸润性宫颈癌。考虑一个年龄在$25$–$64$岁的封闭女性人群，其中持续性高危型HPV感染的时点患病率为$p = 0.12$。在同一人群中进行的一项队列研究估计，与未感染的女性相比，持续感染的女性患宫颈癌的相对风险（RR）为$\\mathrm{RR} = 30$。仅使用以下基本定义和混合推理，推导由持续性高危型HPV感染引起的人群归因分数（PAF）的解析表达式，然后根据给定的$p$和$\\mathrm{RR}$计算其值：\n- $p$是人群中存在暴露（持续性高危型HPV感染）的比例。\n- 相对风险（RR）定义为$\\mathrm{RR} = I_{e}/I_{u}$，其中$I_{e}$是暴露组的疾病发病率，$I_{u}$是非暴露组的疾病发病率。\n- 人群归因分数（PAF）是指在其他所有条件保持不变的情况下，如果消除该暴露，总疾病发病率将出现的比例性减少。\n\n您的推导应从这些定义以及总发病率是暴露组和非暴露组发病率的加权平均这一事实开始。在推导出PAF关于$p$和$\\mathrm{RR}$的闭式表达式后，对$p = 0.12$和$\\mathrm{RR} = 30$进行数值计算。将您的最终数值答案四舍五入至$4$位有效数字。将PAF表示为不带百分号的纯小数。", "solution": "在尝试任何解决方案之前，所提出的问题都经过了严格的验证。\n\n**第1步：提取已知条件**\n- 人群：年龄在$25$–$64$岁的封闭女性人群。\n- 暴露：持续感染高危型HPV。\n- 暴露患病率：$p = 0.12$。\n- 相对风险：$\\mathrm{RR} = 30$。\n- 相对风险的定义：$\\mathrm{RR} = I_{e}/I_{u}$，其中$I_{e}$是暴露组的疾病发病率，$I_{u}$是非暴露组的疾病发病率。\n- 人群归因分数（PAF）的定义：如果消除暴露，总疾病发病率将出现的比例性减少。\n- 附加说明：总发病率是暴露组和非暴露组发病率的加权平均。\n- 任务：推导PAF关于$p$和$\\mathrm{RR}$的解析表达式，然后计算其值，四舍五入到$4$位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n根据所提供的信息对问题进行有效性评估。\n\n- **科学依据**：该问题基于流行病学的基本和标准原则。持续性高危型HPV感染与宫颈癌之间的联系是病毒学和肿瘤学中一个公认的事实。患病率、相对风险和人群归因分数的定义是该领域的标准。给定的$p$和$\\mathrm{RR}$值在此背景下是现实的。该问题在科学上是合理的。\n- **适定性**：该问题定义了所有必要的术语，并提供了足够的数据来推导唯一的解析表达式并计算相应的数值。目标陈述清晰。\n- **客观性**：该问题以精确、客观的语言陈述，没有歧义或主观主张。\n\n**结论**：该问题被视为有效。它在科学上是合理的、适定的和客观的。它不包含逻辑矛盾、缺失信息或伪科学元素。可以构建一个正式的解决方案。\n\n**第3步：推导与求解**\n推导从所提供的基本定义开始。\n\n设$I_{total}$为总人群中宫颈癌的总发病率。该发病率是暴露组（$I_{e}$）的发病率和非暴露组（$I_{u}$）的发病率的加权平均。权重是各组在人群中所占的比例。暴露人群的比例由患病率$p$给出。因此，非暴露人群的比例是$1-p$。\n\n总发病率表示为：\n$$I_{total} = (p \\cdot I_{e}) + ((1-p) \\cdot I_{u})$$\n\n相对风险（$\\mathrm{RR}$）的定义为$\\mathrm{RR} = \\frac{I_{e}}{I_{u}}$。我们可以重新整理这个公式，用$I_{u}$和$\\mathrm{RR}$来表示$I_{e}$：\n$$I_{e} = \\mathrm{RR} \\cdot I_{u}$$\n\n将$I_{e}$的这个表达式代入$I_{total}$的方程中：\n$$I_{total} = (p \\cdot (\\mathrm{RR} \\cdot I_{u})) + ((1-p) \\cdot I_{u})$$\n\n我们可以提取公因子$I_{u}$：\n$$I_{total} = I_{u} \\cdot (p \\cdot \\mathrm{RR} + 1 - p)$$\n$$I_{total} = I_{u} \\cdot (1 + p(\\mathrm{RR} - 1))$$\n\n人群归因分数（PAF）定义为如果消除暴露，总发病率的比例性减少。如果从人群中消除了暴露，整个人群将经历非暴露组的发病率$I_{u}$。新的总发病率$I_{new}$将是$I_{u}$。\n\n发病率的减少量是原始总发病率与新发病率之间的差值：\n$$\\text{Reduction in Incidence} = I_{total} - I_{new} = I_{total} - I_{u}$$\n\n这个比例性减少量，即PAF，是这个减少量除以原始总发病率：\n$$\\mathrm{PAF} = \\frac{I_{total} - I_{u}}{I_{total}} = 1 - \\frac{I_{u}}{I_{total}}$$\n\n现在，我们将推导出的$I_{total}$表达式代入PAF的公式中：\n$$\\mathrm{PAF} = 1 - \\frac{I_{u}}{I_{u} \\cdot (1 + p(\\mathrm{RR} - 1))}$$\n\n术语$I_{u}$从分子和分母中消去，得到PAF关于$p$和$\\mathrm{RR}$的最终解析表达式：\n$$\\mathrm{PAF} = 1 - \\frac{1}{1 + p(\\mathrm{RR} - 1)}$$\n\n为了将其表示为单个分数，我们进行通分：\n$$\\mathrm{PAF} = \\frac{(1 + p(\\mathrm{RR} - 1)) - 1}{1 + p(\\mathrm{RR} - 1)}$$\n$$\\mathrm{PAF} = \\frac{p(\\mathrm{RR} - 1)}{1 + p(\\mathrm{RR} - 1)}$$\n\n这就是所要求的解析表达式。\n\n现在，我们使用给定的数据计算数值：$p = 0.12$和$\\mathrm{RR} = 30$。\n$$\\mathrm{PAF} = \\frac{0.12 \\cdot (30 - 1)}{1 + 0.12 \\cdot (30 - 1)}$$\n$$\\mathrm{PAF} = \\frac{0.12 \\cdot 29}{1 + 0.12 \\cdot 29}$$\n$$\\mathrm{PAF} = \\frac{3.48}{1 + 3.48}$$\n$$\\mathrm{PAF} = \\frac{3.48}{4.48}$$\n\n数值为：\n$$\\mathrm{PAF} \\approx 0.7767857...$$\n\n按要求四舍五入到$4$位有效数字，我们得到：\n$$\\mathrm{PAF} = 0.7768$$\n这个结果表明，该人群中约有$77.68\\%$的宫颈癌病例可归因于持续性高危型HPV感染。", "answer": "$$\\boxed{0.7768}$$", "id": "2516234"}, {"introduction": "进入基因组学时代，我们能够以前所未有的精度研究病毒致癌的机制。插入突变是逆转录病毒致癌的经典机制之一，而高通量测序技术使我们能够系统地研究其在全基因组范围内的影响。这项练习将您置于一个真实的生物信息学场景中，您将使用线性回归模型来量化病毒 DNA 整合如何顺式激活（cis-activation）附近宿主基因的表达，从而掌握一种分析大规模基因组数据的强大工具 [@problem_id:2516222]。", "problem": "一种能引起细胞转化的逆转录病毒，可以将其脱氧核糖核酸（DNA）整合到宿主原癌基因附近，通过顺式激活（cis-activation）改变转录。根据分子生物学的中心法则，转录的变化可以通过核糖核酸测序（RNA-seq）测量的信使核糖核酸（mRNA）丰度来量化。为了量化由邻近整合引起的顺式激活效应大小，同时控制基因组距离的影响，我们对每个基因的多个样本考虑以下线性模型：\n对于一个固定的基因 $g$ 和样本索引 $s \\in \\{1,\\dots,S\\}$，设 $y_{s}$ 为基因 $g$ 经过对数转换和文库大小归一化后的RNA表达量，$I_{s} \\in \\{0,1\\}$ 表示在样本 $s$ 中基因 $g$ 附近是否存在至少一个病毒整合，而 $d_{s}$ 是最近的整合位点与该基因转录起始位点（TSS）之间的距离，单位为千碱基（kb）。按照惯例，当 $I_{s} = 0$ 时，定义 $d_{s} = 0$。模型为\n$$\ny_{s} = \\beta_{0} + \\beta_{1} I_{s} + \\beta_{2}\\, I_{s}\\,\\log_{10}(d_{s} + 1) + \\varepsilon_{s},\n$$\n其中 $\\beta_{0}$ 是截距，$\\beta_{1}$ 是启动子近端顺式激活效应（距离为 $0$ 时的效应），$\\beta_{2}$ 捕捉了以10为底的对数千碱基距离下的距离依赖性衰减，$\\varepsilon_{s}$ 是均值为零的残差。您必须对每个基因，使用从该线性模型推导出的最小二乘法闭式解，通过普通最小二乘法（OLS）估计 $\\beta_{1}$ 和 $\\beta_{2}$，并输出估计值。\n\n请实现一个程序，对下方测试套件中的每个基因，构建包含三列 $[1, I_{s}, I_{s}\\log_{10}(d_{s}+1)]$ 的设计矩阵，求解 OLS 估计量\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{X}^{\\top}\\mathbf{y},\n$$\n并返回估计对 $(\\hat{\\beta}_{1}, \\hat{\\beta}_{2})$。请使用以10为底的对数、单位为千碱基的距离，并遵循当 $I_{s}=0$ 时 $d_{s}=0$ 的惯例。将所有报告的系数四舍五入到 $6$ 位小数。所有输出均表示为无单位的实数。\n\n测试套件（三个基因；每个基因有 $S = 8$ 个样本；数组按样本顺序 $s=1$ 至 $s=8$ 列出）：\n\n- 基因A:\n    - $I = [\\,0,\\,1,\\,0,\\,1,\\,1,\\,0,\\,1,\\,0\\,]$\n    - $d_{\\mathrm{kb}} = [\\,0,\\,2,\\,0,\\,10,\\,0,\\,0,\\,100,\\,0\\,]$\n    - $y = [\\,10.0,\\,11.522878745280338,\\,10.0,\\,10.958607314841775,\\,12.0,\\,10.0,\\,9.995678626217357,\\,10.0\\,]$\n- 基因B:\n    - $I = [\\,1,\\,1,\\,0,\\,0,\\,1,\\,0,\\,1,\\,0\\,]$\n    - $d_{\\mathrm{kb}} = [\\,1,\\,50,\\,0,\\,0,\\,5,\\,0,\\,500,\\,0\\,]$\n    - $y = [\\,10.397940008672038,\\,7.584859647804127,\\,8.0,\\,8.0,\\,9.443697499232713,\\,8.0,\\,5.600324548265508,\\,8.0\\,]$\n- 基因C:\n    - $I = [\\,0,\\,0,\\,1,\\,0,\\,1,\\,1,\\,0,\\,0\\,]$\n    - $d_{\\mathrm{kb}} = [\\,0,\\,0,\\,0,\\,0,\\,20,\\,200,\\,0,\\,0\\,]$\n    - $y = [\\,12.0,\\,12.0,\\,13.5,\\,12.0,\\,12.83889035263304,\\,12.348401971289755,\\,12.0,\\,12.0\\,]$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\,\\hat{\\beta}_{1}^{A},\\,\\hat{\\beta}_{2}^{A},\\,\\hat{\\beta}_{1}^{B},\\,\\hat{\\beta}_{2}^{B},\\,\\hat{\\beta}_{1}^{C},\\,\\hat{\\beta}_{2}^{C}\\,]$，每个值四舍五入到 $6$ 位小数。例如，一个可接受的格式是 $[0.123456,-0.234567, \\dots]$。", "solution": "所述问题是有效的。它在科学上基于分子生物学和定量基因组学，作为一个标准的线性回归问题被良好地提出，并且所有必要数据均已提供，定义客观明确。\n\n任务是使用普通最小二乘法（OLS）对三个数据集（每个数据集对应一个特定基因）的线性模型参数进行估计。\n\n所提供的模型是：\n$$\ny_{s} = \\beta_{0} + \\beta_{1} I_{s} + \\beta_{2}\\, I_{s}\\,\\log_{10}(d_{s} + 1) + \\varepsilon_{s}\n$$\n这里，$y_s$ 是样本 $s$ 观测到的基因表达量，$I_s$ 是病毒整合的指示变量，$d_s$ 是到整合位点的距离，$\\varepsilon_s$ 是残差项，而 $\\beta_{0}$, $\\beta_{1}$, $\\beta_{2}$ 是待估计的参数。每个基因的总样本数为 $S=8$。\n\n这个包含 $S$ 个线性方程的系统可以用矩阵形式表示为：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\n$$\n其中：\n- $\\mathbf{y}$ 是观测表达值的 $S \\times 1$ 响应向量，$\\mathbf{y} = [y_1, \\dots, y_S]^{\\top}$。\n- $\\mathbf{X}$ 是 $S \\times 3$ 的设计矩阵。$\\mathbf{X}$ 的每一行 $s$ 对应一个样本，并由模型中的预测变量定义：\n$$\n\\mathbf{x}_{s}^{\\top} = [1, I_{s}, I_{s}\\log_{10}(d_{s} + 1)]\n$$\n$\\mathbf{X}$ 的三列分别代表截距、整合存在效应 ($I_s$) 和距离调节效应 ($I_{s}\\log_{10}(d_{s} + 1)$)。\n- $\\boldsymbol{\\beta}$ 是待估计的 $3 \\times 1$ 参数向量：$\\boldsymbol{\\beta} = [\\beta_{0}, \\beta_{1}, \\beta_{2}]^{\\top}$。\n- $\\boldsymbol{\\varepsilon}$ 是 $S \\times 1$ 的残差向量。\n\n普通最小二乘（OLS）估计量 $\\hat{\\boldsymbol{\\beta}}$ 是使残差平方和 $\\sum_{s=1}^{S} \\varepsilon_s^2$ 最小化的 $\\boldsymbol{\\beta}$ 值。该估计量的闭式解由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^{\\top}\\mathbf{X})^{-1}\\mathbf{X}^{\\top}\\mathbf{y}\n$$\n只要矩阵 $\\mathbf{X}^{\\top}\\mathbf{X}$ 是可逆的，该解就存在且唯一，而当 $\\mathbf{X}$ 的列线性无关时，该条件成立。对于所提供的数据集，此条件是满足的。\n\n对三个基因（基因A、基因B、基因C）中的每一个，计算过程如下：\n1. 对于给定的基因，从提供的表达数据构建响应向量 $\\mathbf{y}$。\n2. 使用给定的向量 $\\mathbf{I}$ 和 $\\mathbf{d}$ 构建设计矩阵 $\\mathbf{X}$。如上所述形成三列。$\\log_{10}$ 函数是以10为底的对数。项 $d_s+1$ 正确处理了 $d_s=0$ 的情况。\n3. 计算矩阵乘积 $\\mathbf{X}^{\\top}\\mathbf{X}$，得到一个 $3 \\times 3$ 矩阵。\n4. 计算该矩阵的逆矩阵 $(\\mathbf{X}^{\\top}\\mathbf{X})^{-1}$。\n5. 计算矩阵-向量乘积 $\\mathbf{X}^{\\top}\\mathbf{y}$，得到一个 $3 \\times 1$ 向量。\n6. 计算最终的估计量向量 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^{\\top}\\mathbf{X})^{-1}(\\mathbf{X}^{\\top}\\mathbf{y})$。\n7. 所需的估计值 $\\hat{\\beta}_{1}$ 和 $\\hat{\\beta}_{2}$ 分别是向量 $\\hat{\\boldsymbol{\\beta}}$ 的第二个和第三个元素。这些值需四舍五入到 $6$ 位小数。\n\n将此程序应用于所提供的数据，得出以下结果：\n\n对于基因A：\n- $\\mathbf{I} = [0, 1, 0, 1, 1, 0, 1, 0]$\n- $\\mathbf{d} = [0, 2, 0, 10, 0, 0, 100, 0]$\n- $\\mathbf{y} = [10.0, 11.52287875, 10.0, 10.95860731, 12.0, 10.0, 9.99567863, 10.0]$\n得到的参数估计值为 $\\hat{\\beta}_{1}^{A} = 2.0$ 和 $\\hat{\\beta}_{2}^{A} = -1.0$。\n\n对于基因B：\n- $\\mathbf{I} = [1, 1, 0, 0, 1, 0, 1, 0]$\n- $\\mathbf{d} = [1, 50, 0, 0, 5, 0, 500, 0]$\n- $\\mathbf{y} = [10.39794001, 7.58485965, 8.0, 8.0, 9.44369750, 8.0, 5.60032455, 8.0]$\n得到的参数估计值为 $\\hat{\\beta}_{1}^{B} = 3.0$ 和 $\\hat{\\beta}_{2}^{B} = -2.0$。\n\n对于基因C：\n- $\\mathbf{I} = [0, 0, 1, 0, 1, 1, 0, 0]$\n- $\\mathbf{d} = [0, 0, 0, 0, 20, 200, 0, 0]$\n- $\\mathbf{y} = [12.0, 12.0, 13.5, 12.0, 12.83889035, 12.34840197, 12.0, 12.0]$\n得到的参数估计值为 $\\hat{\\beta}_{1}^{C} = 1.5$ 和 $\\hat{\\beta}_{2}^{C} = -0.5$。\n\n这些计算在随附的程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_coefficients(I_data, d_data, y_data):\n    \"\"\"\n    Estimates beta_1 and beta_2 using the Ordinary Least Squares (OLS) closed-form solution.\n\n    The model is y_s = beta_0 + beta_1*I_s + beta_2*I_s*log10(d_s + 1) + eps_s.\n    The OLS estimator is beta_hat = (X^T * X)^(-1) * X^T * y.\n\n    Args:\n        I_data (list): List of integration indicators (0 or 1).\n        d_data (list): List of distances in kilobases.\n        y_data (list): List of log-transformed gene expression values.\n\n    Returns:\n        tuple: A tuple containing the estimated coefficients (beta_1_hat, beta_2_hat).\n    \"\"\"\n    # Cast input lists to numpy arrays for vectorized operations.\n    I = np.array(I_data, dtype=float)\n    d = np.array(d_data, dtype=float)\n    y = np.array(y_data, dtype=float)\n    \n    num_samples = len(y)\n    \n    # Construct the design matrix X with three columns as specified by the model.\n    # Column 0: Intercept (a vector of ones).\n    col0_intercept = np.ones(num_samples)\n    \n    # Column 1: Promoter-proximal cis-activation effect (I_s).\n    col1_integration = I\n    \n    # Column 2: Distance-dependent attenuation (I_s * log10(d_s + 1)).\n    col2_distance_effect = I * np.log10(d + 1)\n    \n    # Stack the columns horizontally to form the S x 3 design matrix.\n    X = np.stack([col0_intercept, col1_integration, col2_distance_effect], axis=1)\n    \n    # Calculate the OLS estimator using the normal equation: beta_hat = inv(X^T*X) * X^T*y\n    # This formula is applied directly as requested by the problem statement.\n    XTX = X.T @ X\n    XTX_inv = np.linalg.inv(XTX)\n    XTy = X.T @ y\n    beta_hat = XTX_inv @ XTy\n    \n    # The resulting beta_hat vector contains [beta_0_hat, beta_1_hat, beta_2_hat].\n    # We are interested in beta_1_hat and beta_2_hat.\n    beta_1_hat = beta_hat[1]\n    beta_2_hat = beta_hat[2]\n    \n    return beta_1_hat, beta_2_hat\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing the I, d, and y vectors for a gene.\n    test_cases = [\n        # Gene A: (I_vector, d_vector, y_vector)\n        (\n            [0, 1, 0, 1, 1, 0, 1, 0],\n            [0, 2, 0, 10, 0, 0, 100, 0],\n            [10.0, 11.522878745280338, 10.0, 10.958607314841775, 12.0, 10.0, 9.995678626217357, 10.0]\n        ),\n        # Gene B: (I_vector, d_vector, y_vector)\n        (\n            [1, 1, 0, 0, 1, 0, 1, 0],\n            [1, 50, 0, 0, 5, 0, 500, 0],\n            [10.397940008672038, 7.584859647804127, 8.0, 8.0, 9.443697499232713, 8.0, 5.600324548265508, 8.0]\n        ),\n        # Gene C: (I_vector, d_vector, y_vector)\n        (\n            [0, 0, 1, 0, 1, 1, 0, 0],\n            [0, 0, 0, 0, 20, 200, 0, 0],\n            [12.0, 12.0, 13.5, 12.0, 12.83889035263304, 12.348401971289755, 12.0, 12.0]\n        )\n    ]\n\n    # A list to store the results from all test cases.\n    results = []\n    \n    # Iterate through each gene's data, calculate the coefficients, and store them.\n    for case in test_cases:\n        I_data, d_data, y_data = case\n        \n        beta1_hat, beta2_hat = estimate_coefficients(I_data, d_data, y_data)\n        \n        # Append the results to the list, formatted to 6 decimal places.\n        results.append(f\"{beta1_hat:.6f}\")\n        results.append(f\"{beta2_hat:.6f}\")\n\n    # Final print statement in the exact required format.\n    # The output is a single line, a comma-separated list enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2516222"}]}