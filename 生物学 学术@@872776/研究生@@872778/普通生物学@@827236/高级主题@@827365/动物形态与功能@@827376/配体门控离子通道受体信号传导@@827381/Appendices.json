{"hands_on_practices": [{"introduction": "要理解离子通道的基本特性，我们首先要从单分子水平入手。膜片钳记录技术使我们能够测量流经单个开放通道的微小电流。本练习将引导你分析这类实验的理想化数据，以确定两个关键的生物物理参数：单通道电导（$ \\gamma $）和反转电位（$ E_{\\text{rev}} $）。通过这项实践，你将巩固对离子通道欧姆定律的理解，并学习线性回归等基本数据分析方法。[@problem_id:2812344]", "problem": "在一个膜外侧向外记录模式的膜片上，记录了一个单独的配体门控阳离子通道，该记录在对称的单价离子条件下进行，且液体接界电位 (LJP) 可以忽略不计。施加饱和浓度的激动剂，使得通道在几个不同的指令电压下，在关闭态和开放态之间快速且重复地转换。对于每个指令电压 $V$，在高带宽下采集一段长的稳态记录，并构建一个全点振幅直方图。每个直方图都可以很好地用两个高斯分量来描述：一个关闭态噪声分量，其均值为 $\\mu_{\\mathrm{c}}(V)$，标准差为 $\\sigma_{\\mathrm{c}}(V)$；以及一个开放态噪声分量，其均值为 $\\mu_{\\mathrm{o}}(V)$，标准差为 $\\sigma_{\\mathrm{o}}(V)$。在该电压下的单通道开放电流振幅被操作性地定义为两个高斯均值之差，即 $i(V) \\equiv \\mu_{\\mathrm{o}}(V) - \\mu_{\\mathrm{c}}(V)$。\n\n仅从电流、电导和电化学驱动力的核心定义出发，并利用反转电位是净电流为零时的电压这一定义，推导出连接单通道电流振幅 $i$、单通道电导 $\\gamma$、指令电压 $V$ 和反转电位 $E_{\\mathrm{rev}}$ 之间的函数依赖关系。清晰地陈述此关系在测试电压范围内成立所需的物理假设。\n\n然后，考虑在五个电压下测得的以下代表性直方图拟合结果（均值 ± 标准差）：\n- $V = -60\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = -0.02 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -3.05 \\pm 0.12\\,\\mathrm{pA}$。\n- $V = -40\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.01 \\pm 0.09\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -2.01 \\pm 0.12\\,\\mathrm{pA}$。\n- $V = -20\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -1.01 \\pm 0.11\\,\\mathrm{pA}$。\n- $V = 0\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$。\n- $V = +20\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = -0.01 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = +0.99 \\pm 0.11\\,\\mathrm{pA}$。\n\n哪个选项指定了一个正确的、与假设一致的、且在统计学上适当的分析流程，用于从跨电压的此类振幅直方图中估计 $\\gamma$ 和 $E_{\\mathrm{rev}}$，并且（应用于上述数据时）报告了与数据一致的估计值？\n\nA. 对每个 $V$，从高斯拟合中计算 $i(V) = \\mu_{\\mathrm{o}}(V) - \\mu_{\\mathrm{c}}(V)$ 及其不确定度。使用加权最小二乘法（权重与 $i$ 的方差倒数成正比）对 $i(V)$ 与 $V$ 进行回归。在确认线性和可忽略的串联电阻误差后，将斜率作为 $\\gamma$，x轴截距作为 $E_{\\mathrm{rev}}$。对于给定数据，这得出 $\\gamma \\approx 0.050\\,\\mathrm{pA/mV} = 50\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$，且不确定度很小。\n\nB. 在每个 $V$下，计算整个记录的平均电流 $\\langle I \\rangle$，并除以通过停留时间理想化得到的开放概率 $\\hat{P}_{\\mathrm{o}}$，以估计 $i(V) = \\langle I \\rangle / \\hat{P}_{\\mathrm{o}}$。通过强制过原点的普通最小二乘法拟合 $i(V)$ 对 $V$ 的关系以获得 $\\gamma$；根据构造设定 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$。应用于此数据，得到 $\\gamma \\approx 45\\,\\mathrm{pS}$。\n\nC. 对每个 $V$，使用开放态峰值位置的绝对值 $| \\mu_{\\mathrm{o}}(V) |$ 作为振幅。对 $| i(V) |$ 与 $| V |$ 进行回归以避免负值，并将斜率报告为 $\\gamma$；从该拟合的y轴截距估计 $E_{\\mathrm{rev}}$。应用于此数据，得到 $\\gamma \\approx 50\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx -0.5\\,\\mathrm{mV}$。\n\nD. 在每个 $V$ 下，通过对群体响应进行分箱来执行非稳态噪声分析，以估计方差-均值抛物线，并提取 $i(V)$ 作为二次项的系数。将得到的 $i(V)$ 在所有电压下取平均，然后除以平均指令电压以获得 $\\gamma$；将方差最小时的电压作为 $E_{\\mathrm{rev}}$。应用于此数据，得到 $\\gamma \\approx 55\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$。", "solution": "在尝试给出解答之前，将首先验证问题陈述的科学合理性和一致性。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统：** 一个单独的配体门控阳离子通道。\n- **实验装置：** 膜外侧向外膜片钳记录。\n- **离子条件：** 对称的单价离子条件。\n- **电位：** 可忽略的液体接界电位 (LJP)。\n- **激活：** 饱和浓度的激动剂，引起快速转换。\n- **测量：** 在几个指令电压 $V$ 下，记录高带宽的长稳态片段。\n- **分析：** 为每个 $V$ 构建全点振幅直方图。\n- **直方图模型：** 每个直方图由两个高斯分量描述：\n    - 关闭态：均值 $\\mu_{\\mathrm{c}}(V)$，标准差 $\\sigma_{\\mathrm{c}}(V)$。\n    - 开放态：均值 $\\mu_{\\mathrm{o}}(V)$，标准差 $\\sigma_{\\mathrm{o}}(V)$。\n- **操作性定义：** 单通道电流振幅为 $i(V) \\equiv \\mu_{\\mathrm{o}}(V) - \\mu_{\\mathrm{c}}(V)$。\n- **任务1：** 从核心定义出发，推导连接单通道电流 $i$、单通道电导 $\\gamma$、指令电压 $V$ 和反转电位 $E_{\\mathrm{rev}}$ 的函数关系。\n- **任务2：** 陈述此关系成立所需的物理假设。\n- **任务3：** 分析所提供的数据并评估选项。\n- **数据：** 代表性的直方图拟合结果（高斯分量的均值 ± 标准差）：\n    - $V = -60\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = -0.02 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -3.05 \\pm 0.12\\,\\mathrm{pA}$。\n    - $V = -40\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.01 \\pm 0.09\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -2.01 \\pm 0.12\\,\\mathrm{pA}$。\n    - $V = -20\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = -1.01 \\pm 0.11\\,\\mathrm{pA}$。\n    - $V = 0\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = +0.00 \\pm 0.10\\,\\mathrm{pA}$。\n    - $V = +20\\,\\mathrm{mV}$: $\\mu_{\\mathrm{c}} = -0.01 \\pm 0.10\\,\\mathrm{pA}$，$\\mu_{\\mathrm{o}} = +0.99 \\pm 0.11\\,\\mathrm{pA}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 问题描述了生物物理学中一个标准且成熟的实验方案（单通道膜片钳电生理学），并使用了标准的术语和概念。该实验设置是科学上现实的。\n- **定义明确：** 问题提供了足够的信息和一个明确的目标：推导一个理论关系，然后应用它来分析给定的数据集以找到物理参数。结构逻辑清晰，导向一个唯一的解。\n- **客观性：** 语言是技术性的、精确的，没有主观或含糊的陈述。\n- **一致性与完整性：** 问题是自洽的。所提供的对称离子条件数据（这意味着 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$）与 $V=0\\,\\mathrm{mV}$ 时的测量结果 $i(V) \\approx 0\\,\\mathrm{pA}$ 一致。没有发现矛盾或缺失关键信息。\n\n**步骤3：结论与行动**\n问题陈述有效。现在将进行推导和解答。\n\n### 推导与解答\n\n**第1部分：电流-电压关系的推导**\n\n通过通道孔的离子净流动是由跨膜的电化学势差驱动的。这个净驱动力是电势（膜电压，$V$）与离子种类的平衡电位（也称为反转电位，$E_{\\mathrm{rev}}$）之间的差值。\n\n反转电位 $E_{\\mathrm{rev}}$ 是指通过通道的净电流为零时的电压。根据定义，在 $V = E_{\\mathrm{rev}}$ 时，电势梯度和化学势梯度正好平衡，导致净通量为零。\n\n单通道电流的大小 $i$ 与净电化学驱动力的大小成正比。比例常数是单通道电导 $\\gamma$。这构成了离子通道的广义欧姆定律。\n\n在数学上，这表示为：\n$$i(V) = \\gamma (V - E_{\\mathrm{rev}})$$\n这个方程描述了单个通道的电流-电压（$I-V$）关系。它是 $V$ 的一个线性函数，其中 $\\gamma$ 是斜率，$E_{\\mathrm{rev}}$ 是电压轴截距（即 $i(V)=0$ 时的电压）。\n\n**第2部分：物理假设**\n\n为了使关系式 $i(V) = \\gamma (V - E_{\\mathrm{rev}})$ 在一定电压范围内有效，必须满足以下假设：\n\n1.  **欧姆行为：** 单通道电导 $\\gamma$ 必须是常数，并且与膜电压 $V$ 和离子流向无关。如果 $\\gamma$ 依赖于 $V$，则称该通道具有整流特性，其 $I-V$ 关系将是非线性的。推导出的线性方程假设没有整流。\n2.  **恒定的反转电位：** 反转电位 $E_{\\mathrm{rev}}$ 在测试的电压范围内必须是恒定的。这要求膜片两侧的离子浓度在整个实验过程中保持稳定，这是膜片钳记录的标准条件。问题陈述中提到“对称的单价离子条件”，根据能斯特方程，这意味着 $E_{\\mathrm{rev}} = \\frac{RT}{zF} \\ln\\frac{[C]_{\\mathrm{out}}}{[C]_{\\mathrm{in}}} = \\frac{RT}{zF} \\ln(1) = 0\\,\\mathrm{mV}$。因此，我们的分析应该找到一个接近这个理论值的 $E_{\\mathrm{rev}}$。\n3.  **精确的电压钳：** 指令电压 $V$ 必须准确地代表真实的跨膜电位。这意味着通过移液管尖端和电极的串联电阻所产生的电压降可以忽略不计。显著的串联电阻会导致真实膜电位偏离指令电位，引入系统误差，并可能使观察到的 $I-V$ 曲线在较大电流时呈现亚线性。\n\n**第3部分：数据分析与选项评估**\n\n首先，我们使用操作性定义 $i(V) = \\mu_{\\mathrm{o}}(V) - \\mu_{\\mathrm{c}}(V)$ 计算每个电压下的单通道电流振幅 $i(V)$。$i(V)$ 的不确定度（标准差），记为 $\\sigma_{i}$，是通过传播均值的不确定度 $\\sigma_{\\mu_o}$ 和 $\\sigma_{\\mu_c}$ 来计算的。假设这些来自拟合的不确定度是独立的，它们的方差相加：$\\sigma_{i}^2 = \\sigma_{\\mu_o}^2 + \\sigma_{\\mu_c}^2$。表示为“± 标准差”的值被解释为拟合均值的标准误。\n\n-   $V = -60\\,\\mathrm{mV}$:\n    $i = (-3.05) - (-0.02) = -3.03\\,\\mathrm{pA}$\n    $\\sigma_{i}^2 = (0.12)^2 + (0.10)^2 = 0.0144 + 0.01 = 0.0244 \\implies \\sigma_i \\approx 0.156\\,\\mathrm{pA}$\n\n-   $V = -40\\,\\mathrm{mV}$:\n    $i = (-2.01) - (0.01) = -2.02\\,\\mathrm{pA}$\n    $\\sigma_{i}^2 = (0.12)^2 + (0.09)^2 = 0.0144 + 0.0081 = 0.0225 \\implies \\sigma_i = 0.150\\,\\mathrm{pA}$\n\n-   $V = -20\\,\\mathrm{mV}$:\n    $i = (-1.01) - (0.00) = -1.01\\,\\mathrm{pA}$\n    $\\sigma_{i}^2 = (0.11)^2 + (0.10)^2 = 0.0121 + 0.01 = 0.0221 \\implies \\sigma_i \\approx 0.149\\,\\mathrm{pA}$\n\n-   $V = 0\\,\\mathrm{mV}$:\n    $i = (0.00) - (0.00) = 0.00\\,\\mathrm{pA}$\n    $\\sigma_{i}^2 = (0.10)^2 + (0.10)^2 = 0.01 + 0.01 = 0.0200 \\implies \\sigma_i \\approx 0.141\\,\\mathrm{pA}$\n\n-   $V = +20\\,\\mathrm{mV}$:\n    $i = (0.99) - (-0.01) = 1.00\\,\\mathrm{pA}$\n    $\\sigma_{i}^2 = (0.11)^2 + (0.10)^2 = 0.0121 + 0.01 = 0.0221 \\implies \\sigma_i \\approx 0.149\\,\\mathrm{pA}$\n\n数据点 $(V, i)$ 为：$(-60, -3.03)$, $(-40, -2.02)$, $(-20, -1.01)$, $(0, 0.00)$, $(20, 1.00)$。这些点呈现出极好的线性关系。对 $i$ 与 $V$ 进行线性回归将得到斜率 $\\gamma$ 和截距，由此可以计算出 $E_{\\mathrm{rev}}$。考虑到不确定度不均匀，加权最小二乘 (WLS) 回归是统计上正确的方法，权重为 $w_k = 1/\\sigma_{i,k}^2$。\n\n简单观察可知，斜率约为 $\\frac{\\Delta i}{\\Delta V} = \\frac{1.00 - (-3.03)}{20 - (-60)} = \\frac{4.03}{80} = 0.050375\\,\\mathrm{pA/mV}$，即 $50.375\\,\\mathrm{pS}$。数据点 $(0, 0.00)$ 表明直线通过原点，因此电压轴截距为 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$。\n\n现在我们评估每个选项：\n\n**A. 对每个 $V$，从高斯拟合中计算 $i(V) = \\mu_{\\mathrm{o}}(V) - \\mu_{\\mathrm{c}}(V)$ 及其不确定度。使用加权最小二乘法（权重与 $i$ 的方差倒数成正比）对 $i(V)$ 与 $V$ 进行回归。在确认线性和可忽略的串联电阻误差后，将斜率作为 $\\gamma$，x轴截距作为 $E_{\\mathrm{rev}}$。对于给定数据，这得出 $\\gamma \\approx 0.050\\,\\mathrm{pA/mV} = 50\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$，且不确定度很小。**\n- **分析流程：** 这描述了完全正确的步骤。它使用了为 $i(V)$ 提供的定义，正确地确定了 $i(V)$ 对 $V$ 的回归模型，采用了统计上最优的方法 (WLS)，并正确地将斜率解释为 $\\gamma$，x轴截距解释为 $E_{\\mathrm{rev}}$。它还正确地指出了需要检查线性度（数据明显满足）和潜在的伪影，如串联电阻。\n- **报告值：** 估计值 $\\gamma \\approx 50\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$ 与我们根据所提供数据进行的独立计算非常吻合。\n- **结论：** **正确**。\n\n**B. 在每个 $V$下，计算整个记录的平均电流 $\\langle I \\rangle$，并除以通过停留时间理想化得到的开放概率 $\\hat{P}_{\\mathrm{o}}$，以估计 $i(V) = \\langle I \\rangle / \\hat{P}_{\\mathrm{o}}$。通过强制过原点的普通最小二乘法拟合 $i(V)$ 对 $V$ 的关系以获得 $\\gamma$；根据构造设定 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$。应用于此数据，得到 $\\gamma \\approx 45\\,\\mathrm{pS}$。**\n- **分析流程：** 这描述了一种与问题陈述不一致的替代分析方法，问题陈述要求使用振幅直方图的结果。停留时间理想化是另一种不同的技术。此外，将拟合约束为通过原点是先验地假设 $E_{\\mathrm{rev}} = 0\\,\\mathrm{mV}$，这妨碍了独立的估计和验证。与加权最小二乘法相比，使用普通最小二乘法在统计上是次优的。\n- **报告值：** 报告的电导 $\\gamma \\approx 45\\,\\mathrm{pS}$ 与从所提供的直方图数据得到的结果（$\\approx 50\\,\\mathrm{pS}$）不一致。\n- **结论：** **错误**。\n\n**C. 对每个 $V$，使用开放态峰值位置的绝对值 $| \\mu_{\\mathrm{o}}(V) |$ 作为振幅。对 $| i(V) |$ 与 $| V |$ 进行回归以避免负值，并将斜率报告为 $\\gamma$；从该拟合的y轴截距估计 $E_{\\mathrm{rev}}$。应用于此数据，得到 $\\gamma \\approx 50\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx -0.5\\,\\mathrm{mV}$。**\n- **分析流程：** 这个过程在根本上是错误的。电流振幅是开放态和关闭态能级之间的*差值*，$i(V) = \\mu_o(V) - \\mu_c(V)$，而不是 $|\\mu_o(V)|$。对电流和电压取绝对值 $|i(V)|$ 和 $|V|$，会丢弃关于电流流向的重要信息，并人为地将数据强制到第一象限，破坏了线性关系。从此类扭曲的回归中解释拟合参数在物理上是没有意义的。\n- **报告值：** 尽管 $\\gamma$ 的值碰巧很接近，但其方法在科学上是无效的。\n- **结论：** **错误**。\n\n**D. 在每个 $V$ 下，通过对群体响应进行分箱来执行非稳态噪声分析，以估计方差-均值抛物线，并提取 $i(V)$ 作为二次项的系数。将得到的 $i(V)$ 在所有电压下取平均，然后除以平均指令电压以获得 $\\gamma$；将方差最小时的电压作为 $E_{\\mathrm{rev}}$。应用于此数据，得到 $\\gamma \\approx 55\\,\\mathrm{pS}$ 和 $E_{\\mathrm{rev}} \\approx 0\\,\\mathrm{mV}$。**\n- **分析流程：** 这描述了非稳态波动分析，这是一种用于研究具有时变开放概率的大量通道（例如，全细胞电流）的技术。它完全不适用于问题中所述的单个通道的稳态记录。通过平均电流和电压来计算 $\\gamma$ 的方法是临时的且不正确的。\n- **报告值：** 该方法对于此实验背景是错误的，并且得到的 $\\gamma$ 与数据不一致。\n- **结论：** **错误**。", "answer": "$$\\boxed{A}$$", "id": "2812344"}, {"introduction": "在上一节练习了反转电位的概念之后，本练习将深入探讨离子选择性，这是决定通道生理功能的关键特征。我们将应用Goldman-Hodgkin-Katz (GHK) 方程，基于在多种离子环境中测得的反转电位，来计算通道对不同离子（如钠离子和钾离子）的相对渗透性比率（$ P_{\\text{Na}}/P_{\\text{K}} $）。这项练习旨在展示如何通过宏观的电学测量来揭示关于通道孔及其与离子相互作用的微观细节。[@problem_id:2812363]", "problem": "一个电压钳制细胞中的配体门控阳离子通道在只有单价阳离子钠和钾可渗透的条件下被激活。胞内溶液分别含有浓度为 $[\\text{K}]_{i} = 140$ mM 的钾离子和浓度为 $[\\text{Na}]_{i} = 10$ mM 的钠离子。胞外溶液分别含有浓度为 $[\\text{K}]_{o} = 5$ mM 的钾离子和浓度为 $[\\text{Na}]_{o} = 145$ mM 的钠离子。在绝对温度 $T = 298$ K 时，通道激活期间测得的宏观反转电位为 $E_{\\text{rev}} = +8.0$ mV。\n\n从离子运动的恒定场描述以及反转电位（即可渗透离子所携带的净宏观电流为零时的电压）的定义出发，推导一个用离子浓度和相对渗透性表示反转电位的表达式，然后用它来计算相对渗透性比率 $P_{\\text{Na}}/P_{\\text{K}}$。清晰地陈述为证明在配体门控通道孔中使用恒定场模型的合理性而做出的任何必要假设，并用一两句话解释，违反电场均匀性假设将如何使从反转电位推断出的渗透性比率产生偏差。\n\n在推导中以符号形式使用普适气体常数 $R$ 和法拉第常数 $F$。对于数值计算，取 $R = 8.314$ J mol$^{-1}$ K$^{-1}$ 和 $F = 96485$ C mol$^{-1}$。将最终答案表示为一个无单位的比率，并四舍五入到三位有效数字。", "solution": "基本原理包括电场中离子通量的 Nernst-Planck 描述、恒定场近似以及反转电位（即净电流为零时的膜电位）的定义。在恒定场近似（渗透路径上的电场是均匀的）下，对于化合价为 $z_{i} = +1$ 的单价阳离子种类 $i$，Goldman-Hodgkin-Katz (GHK) 通量方程可以写为\n$$\nJ_{i} \\;=\\; P_{i}\\,\\frac{F^{2}}{R T}\\,V_{m}\\,\\frac{[\\text{i}]_{i} - [\\text{i}]_{o}\\,\\exp\\!\\left(-\\frac{F V_{m}}{R T}\\right)}{1 - \\exp\\!\\left(-\\frac{F V_{m}}{R T}\\right)},\n$$\n其中 $J_{i}$ 是外向通量，$P_{i}$ 是渗透性，$F$ 是法拉第常数，$R$ 是普适气体常数，$T$ 是绝对温度，$V_{m}$ 是膜电位。由离子种类 $i$ 携带的宏观电流为 $I_{i} = z_{i} F J_{i}$，对于单价阳离子，$z_{i} = +1$，因此 $I_{i} \\propto J_{i}$。\n\n根据定义，在反转电位处，净电流为零：\n$$\nI_{\\text{tot}}(E_{\\text{rev}}) \\;=\\; \\sum_{i \\in \\{\\text{K},\\text{Na}\\}} I_{i}(E_{\\text{rev}}) \\;=\\; 0.\n$$\n因为在固定的 $V_{m}$ 和 $T$ 下，$J_{i}$ 中乘以括号内浓度项的因子对两种离子是相同的，所以零电流条件简化为\n$$\n\\sum_{i} P_{i}\\,\\big([\\text{i}]_{i} - [\\text{i}]_{o}\\,\\exp(-\\phi)\\big) \\;=\\; 0,\n$$\n其中 $\\phi \\equiv \\frac{F E_{\\text{rev}}}{R T}$。整理得，\n$$\n\\exp(-\\phi)\\,\\sum_{i} P_{i}\\,[\\text{i}]_{o} \\;=\\; \\sum_{i} P_{i}\\,[\\text{i}]_{i}.\n$$\n等价地，\n$$\n\\exp(\\phi) \\;=\\; \\frac{\\sum_{i} P_{i}\\,[\\text{i}]_{o}}{\\sum_{i} P_{i}\\,[\\text{i}]_{i}},\n$$\n因此\n$$\nE_{\\text{rev}} \\;=\\; \\frac{R T}{F}\\,\\ln\\!\\left(\\frac{P_{\\text{K}}[\\text{K}]_{o} + P_{\\text{Na}}[\\text{Na}]_{o}}{P_{\\text{K}}[\\text{K}]_{i} + P_{\\text{Na}}[\\text{Na}]_{i}}\\right).\n$$\n定义渗透性比率 $r \\equiv \\frac{P_{\\text{Na}}}{P_{\\text{K}}}$。则\n$$\n\\exp\\!\\left(\\frac{F E_{\\text{rev}}}{R T}\\right) \\;=\\; \\frac{[\\text{K}]_{o} + r\\,[\\text{Na}]_{o}}{[\\text{K}]_{i} + r\\,[\\text{Na}]_{i}}.\n$$\n用代数方法求解 $r$。令 $s \\equiv \\exp\\left(\\frac{F E_{\\text{rev}}}{R T}\\right)$。则\n$$\ns\\,[\\text{K}]_{i} + s\\,r\\,[\\text{Na}]_{i} \\;=\\; [\\text{K}]_{o} + r\\,[\\text{Na}]_{o},\n$$\n分离出 $r$ 可得，\n$$\nr\\,(s\\,[\\text{Na}]_{i} - [\\text{Na}]_{o}) \\;=\\; [\\text{K}]_{o} - s\\,[\\text{K}]_{i},\n$$\n$$\nr \\;=\\; \\frac{[\\text{K}]_{o} - s\\,[\\text{K}]_{i}}{s\\,[\\text{Na}]_{i} - [\\text{Na}]_{o}}.\n$$\n\n现在代入给定值。首先计算 $s$：\n$$\n\\phi \\;=\\; \\frac{F E_{\\text{rev}}}{R T} \\;=\\; \\frac{(96485)\\,(0.0080)}{(8.314)\\,(298)}.\n$$\n首先计算 $R T$ 的值：\n$$\nR T \\;=\\; 8.314 \\times 298 \\;=\\; 2477.572,\n$$\n以及\n$$\nF E_{\\text{rev}} \\;=\\; 96485 \\times 0.0080 \\;=\\; 771.88.\n$$\n因此\n$$\n\\phi \\;=\\; \\frac{771.88}{2477.572} \\;\\approx\\; 0.3116,\n$$\n以及\n$$\ns \\;=\\; \\exp(\\phi) \\;\\approx\\; \\exp(0.3116) \\;\\approx\\; 1.3659.\n$$\n代入浓度 $[\\text{K}]_{o} = 5$，$[\\text{K}]_{i} = 140$，$[\\text{Na}]_{o} = 145$，$[\\text{Na}]_{i} = 10$（单位为毫摩尔；在比率中单位被消去），得到\n$$\nr \\;=\\; \\frac{5 - (1.3659)\\,(140)}{(1.3659)\\,(10) - 145}.\n$$\n计算分子和分母：\n$$\n\\text{numerator} \\;=\\; 5 - 191.226 \\;=\\; -186.226,\n$$\n$$\n\\text{denominator} \\;=\\; 13.659 - 145 \\;=\\; -131.341,\n$$\n以及\n$$\nr \\;=\\; \\frac{-186.226}{-131.341} \\;\\approx\\; 1.418.\n$$\n四舍五入到三位有效数字，无单位的渗透性比率为\n$$\nr \\;\\approx\\; 1.42.\n$$\n\n假设和电场均匀性的作用：恒定场近似假设电势在渗透路径上线性下降，离子运动是独立的（孔道内没有离子-离子相互作用），并且只有所述的单价阳离子携带电流。在配体门控通道孔中，如果由于离散的结合位点或能垒导致电场不均匀，则 GHK 推导出的 $E_{\\text{rev}}$ 和渗透性比率之间的关系会失真；此时推断出的 $P_{\\text{Na}}/P_{\\text{K}}$ 代表了恒定场模型下的一个表观比率，并且可能会向上或向下偏离，具体取决于真实的电势分布如何在孔道内优先稳定某一种离子。", "answer": "$$\\boxed{1.42}$$", "id": "2812363"}, {"introduction": "在表征了通道孔的特性之后，我们转向门控机制——即配体结合如何控制通道的开放。本练习将深入探讨Monod-Wyman-Changeux (MWC) 模型，这是一个描述变构调控的强大理论框架。你将通过非线性回归方法，将此模型与剂量-反应曲线数据进行拟合，从而估算描述通道构象平衡及其如何被变构效应物调节的关键参数。这项实践将为你提供受体功能定量建模的实战经验。[@problem_id:2812331]", "problem": "一个配体门控离子通道被建模为一个具有关闭（紧张）态和开放（松弛）态的双态 Monod–Wyman–Changeux (MWC) 系统。该受体有 $n$ 个用于激动剂配体的相同且独立的结合位点，激动剂浓度为 $A$（单位：微摩尔），以及 $q$ 个用于变构调节剂的相同且独立的结合位点，调节剂浓度为 $M$（单位：微摩尔）。在没有任何配体存在的情况下，从关闭构象到开放构象的平衡常数为 $L_0$。激动剂与关闭态结合的解离常数为 $K_C$，与开放态结合的解离常数为 $K_O$。定义亲和力比值 $c$ 为 $c = K_O / K_C$。调节剂与关闭态结合的解离常数为 $K_{MC}$，与开放态结合的解离常数为 $K_{MO}$。定义调节剂与开放态的偶联因子为 $\\phi = K_{MO} / K_{MC}$。开放概率是一个无量纲的量。\n\n推导基本原理：在 MWC 框架中，一个宏观状态的统计权重与其构象权重以及每种配体的结合多项式的乘积成正比。开放概率等于开放态权重除以总权重（开放态和关闭态权重之和）。对于配体浓度为 $x$、解离常数为 $K$ 的 $n$ 个相同独立位点，其结合多项式为 $\\left(1 + \\frac{x}{K}\\right)^n$。在没有配体的情况下，构象偏向由 $L_0$ 设定。\n\n任务：\n1) 从结合多项式原理和 $L_0$ 的定义出发，推导开放概率作为 $A$、$M$、$L_0$、$c$、$K_C$、$K_{MC}$、$n$、$q$ 和 $\\phi$ 的函数的显式表达式。然后使用此表达式执行非线性最小二乘回归，从下面提供的每个数据集中估计 $L_0$、$c$ 和 $\\phi$。\n2) 对每个数据集，将 $K_C$、$K_{MC}$、$n$、$q$ 和 $M$ 视为已知常数。通过联合拟合在两种条件下（无调节剂和在指定浓度 $M$ 下有调节剂）测量的跨越不同激动剂浓度的开放概率，来估计 $L_0$、$c$ 和 $\\phi$。\n3) 所有浓度单位均为微摩尔 (µM)。开放概率是无量纲、无单位的。您的程序必须为每个数据集输出最终估计的参数，这些参数是四舍五入到小数点后五位的实数。\n4) 最终输出格式：您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表按给定顺序对应一个数据集，并包含三个估计参数 $[L_0, c, \\phi]$。例如：\"[[0.12345,0.23456,0.34567],[...],[...]]\"。\n5) 角度单位不适用。不要输出百分比；所有结果均以小数表示。\n\n测试套件（三个数据集）。对于每个数据集，元组为：已知常数、激动剂浓度、无调节剂时测量的开放概率、有调节剂时测量的开放概率。\n\n数据集 1（理想路径；中等协同性，强激动剂，正向调节剂）：\n- 已知常数：$n = 2$, $q = 1$, $K_C = 10$, $K_{MC} = 10$, $M = 10$。\n- 激动剂浓度 (µM)：$[0, 10, 30, 40, 90]$。\n- 无调节剂时的开放概率：$\\left[\\frac{1}{301}, \\frac{1}{49}, \\frac{169}{4969}, \\frac{289}{7789}, \\frac{1369}{31369}\\right]$。\n- 有调节剂时的开放概率：$\\left[\\frac{1}{101}, \\frac{1}{17}, \\frac{169}{1769}, \\frac{289}{2789}, \\frac{1369}{11369}\\right]$。\n\n数据集 2（边界情况；弱激动剂，正向调节剂）：\n- 已知常数：$n = 2$, $q = 1$, $K_C = 10$, $K_{MC} = 10$, $M = 10$。\n- 激动剂浓度 (µM)：$[0, 10, 30, 90]$。\n- 无调节剂时的开放概率：$\\left[\\frac{1}{201}, \\frac{81}{12881}, \\frac{361}{51561}, \\frac{2401}{322401}\\right]$。\n- 有调节剂时的开放概率：$\\left[\\frac{11}{411}, \\frac{891}{26491}, \\frac{3971}{106371}, \\frac{26411}{666411}\\right]$。\n\n数据集 3（边缘情况；高协同性，强激动剂，强正向调节剂）：\n- 已知常数：$n = 4$, $q = 1$, $K_C = 10$, $K_{MC} = 10$, $M = 5$。\n- 激动剂浓度 (µM)：$[0, 1, 10]$。\n- 无调节剂时的开放概率：$\\left[\\frac{1}{31}, \\frac{160000}{599230}, \\frac{14641}{15121}\\right]$。\n- 有调节剂时的开放概率：$\\left[\\frac{11}{56}, \\frac{1760000}{2418845}, \\frac{161051}{161771}\\right]$。\n\n要求：\n- 如上所述，从第一性原理推导开放概率表达式。\n- 通过同时最小化两种条件下平方残差之和，实现非线性回归来为每个数据集估计 $L_0$、$c$ 和 $\\phi$。\n- 按每个数据集给定的常数使用；不要估计它们。\n- 输出单行：一个包含三个列表的列表，每个内部列表包含一个数据集的 $[L_0, c, \\phi]$，四舍五入到小数点后五位，顺序为数据集 1、数据集 2、数据集 3。", "solution": "该问题要求推导双态 Monod–Wyman–Changeux (MWC) 受体模型的开放概率，并随后应用此模型，使用非线性最小二乘回归从提供的数据集中估计关键参数。该问题已经过验证，并被确定为科学上合理、定义明确且内部一致。\n\n**1. 开放概率表达式的推导**\n\nMWC 模型假设受体可以存在于两种主要构象中：关闭（紧张， $C$）态和开放（松弛， $O$）态。这些状态之间的平衡受配体结合的影响。\n\n该系统由以下参数定义：\n- $n$：激动剂配体的相同、独立结合位点的数量。\n- $A$：激动剂的浓度。\n- $K_C$ 和 $K_O$：激动剂分别与关闭态和开放态结合的解离常数。亲和力比值定义为 $c = K_O / K_C$。\n- $q$：变构调节剂的相同、独立结合位点的数量。\n- $M$：调节剂的浓度。\n- $K_{MC}$ 和 $K_{MO}$：调节剂分别与关闭态和开放态结合的解离常数。偶联因子定义为 $\\phi = K_{MO} / K_{MC}$。\n- $L_0$：变构常数，定义为在没有任何配体的情况下，处于关闭态的受体总数与处于开放态的受体总数之比。问题陈述中给出 $L_0 = \\frac{[\\text{关闭}]}{[\\text{开放}]}$。让我们将未结合配体的关闭态和开放态分别表示为 $R_C$ 和 $R_O$。那么 $L_0 = [R_C]/[R_O]$。\n\n根据 MWC 框架，宏观状态的统计权重与其固有的构象权重和配体结合多项式的乘积成正比。我们可以将未结合配体的开放态 $R_O$ 的参考权重设为 $1$。因此，未结合配体的关闭态 $R_C$ 的权重为 $L_0$。\n\n对于浓度为 $x$ 的配体与 $k$ 个解离常数为 $K$ 的相同独立位点结合，其结合多项式由 $\\left(1 + \\frac{x}{K}\\right)^k$ 给出。\n\n所有关闭态系综的总统计权重 $W_C$ 是关闭构象的固有权重 ($L_0$) 与激动剂和调节剂的结合多项式的乘积。\n$$\nW_C = L_0 \\left(1 + \\frac{A}{K_C}\\right)^n \\left(1 + \\frac{M}{K_{MC}}\\right)^q\n$$\n\n同样，所有开放态系综的总统计权重 $W_O$ 是开放构象的固有权重 ($1$) 与其相应结合多项式的乘积。\n$$\nW_O = 1 \\cdot \\left(1 + \\frac{A}{K_O}\\right)^n \\left(1 + \\frac{M}{K_{MO}}\\right)^q\n$$\n\n受体处于开放态的概率 $P_{open}$ 是开放态总权重与开放态和关闭态总权重之和的比值。\n$$\nP_{open} = \\frac{W_O}{W_C + W_O} = \\frac{\\left(1 + \\frac{A}{K_O}\\right)^n \\left(1 + \\frac{M}{K_{MO}}\\right)^q}{L_0 \\left(1 + \\frac{A}{K_C}\\right)^n \\left(1 + \\frac{M}{K_{MC}}\\right)^q + \\left(1 + \\frac{A}{K_O}\\right)^n \\left(1 + \\frac{M}{K_{MO}}\\right)^q}\n$$\n\n代入已定义的比值 $c = K_O / K_C$ 和 $\\phi = K_{MO} / K_{MC}$。这意味着 $K_O = c K_C$ 且 $K_{MO} = \\phi K_{MC}$。$P_{open}$ 的表达式变为待估计参数 ($L_0, c, \\phi$) 和已知常数的函数。\n$$\nP_{open}(A, M; L_0, c, \\phi) = \\frac{\\left(1 + \\frac{A}{c K_C}\\right)^n \\left(1 + \\frac{M}{\\phi K_{MC}}\\right)^q}{L_0 \\left(1 + \\frac{A}{K_C}\\right)^n \\left(1 + \\frac{M}{K_{MC}}\\right)^q + \\left(1 + \\frac{A}{c K_C}\\right)^n \\left(1 + \\frac{M}{\\phi K_{MC}}\\right)^q}\n$$\n\n通过将分子和分母同除以 $W_O$ 项，可以得到一个更便于分析的形式：\n$$\nP_{open} = \\frac{1}{1 + \\frac{W_C}{W_O}} = \\frac{1}{1 + L_0 \\frac{\\left(1 + A/K_C\\right)^n \\left(1 + M/K_{MC}\\right)^q}{\\left(1 + A/(c K_C)\\right)^n \\left(1 + M/(\\phi K_{MC})\\right)^q}}\n$$\n这可以重写为：\n$$\nP_{open}(A, M; L_0, c, \\phi) = \\left[1 + L_0 \\left(\\frac{1 + A/K_C}{1 + A/(c K_C)}\\right)^n \\left(\\frac{1 + M/K_{MC}}{1 + M/(\\phi K_{MC})}\\right)^q\\right]^{-1}\n$$\n这是用于数值拟合的最终表达式。\n\n**2. 通过非线性最小二乘回归进行参数估计**\n\n任务是为每个数据集估计参数 $\\theta = (L_0, c, \\phi)$。每个数据集提供了在两种条件下（无调节剂，$M=0$；有固定浓度调节剂，$M0$）于几个激动剂浓度 $A_j$ 下测量的开放概率。这需要同时对两个数据系列进行联合拟合。\n\n采用最小二乘法来寻找使模型预测与实验数据之间的残差平方和 (SSR) 最小化的参数值。SSR 定义为：\n$$\n\\text{SSR}(\\theta) = \\sum_{j} \\left( P_{open}(A_j, 0; \\theta) - P_{open, j}^{\\text{data}, M=0} \\right)^2 + \\sum_{j} \\left( P_{open}(A_j, M_{const}; \\theta) - P_{open, j}^{\\text{data}, M0} \\right)^2\n$$\n其中，求和遍历数据集中的所有激动剂浓度点 $j$。\n\n优化过程使用 SciPy 库中的 `scipy.optimize.least_squares` 函数执行。此函数专为解决非线性最小二乘问题而设计，非常适合此任务。它作用于残差向量，而非 SSR 本身。残差向量 $r(\\theta)$ 是通过连接来自两种实验条件的残差构建的：\n$$\nr(\\theta) = \\begin{bmatrix}\nP_{open}(A_1, 0; \\theta) - P_{open, 1}^{\\text{data}, M=0} \\\\\n\\vdots \\\\\nP_{open}(A_N, 0; \\theta) - P_{open, N}^{\\text{data}, M=0} \\\\\nP_{open}(A_1, M_{const}; \\theta) - P_{open, 1}^{\\text{data}, M0} \\\\\n\\vdots \\\\\nP_{open}(A_N, M_{const}; \\theta) - P_{open, N}^{\\text{data}, M0}\n\\end{bmatrix}\n$$\n其中 $N$ 是激动剂浓度点的数量。\n\n`least_squares` 函数通过迭代调整参数 $\\theta$ 来最小化此向量中元素的平方和 $\\sum r_i^2$。为保证稳健性，对参数设置了边界，以确保它们保持在物理上有意义的范围内（即 $L_0  0$、$c  0$ 和 $\\phi  0$）。使用一个小的正数（例如 $10^{-9}$）作为下界，以防止除以零并保持物理相关性。启动迭代最小化过程还需要参数的初始猜测值。\n\n**3. 实现**\n\n该解决方案用 Python 实现。定义了一个函数 `mwc_model` 以根据推导的方程计算 $P_{open}$。第二个函数 `residuals` 计算给定参数集的残差向量。此函数被传递给 `scipy.optimize.least_squares`。主脚本遍历提供的三个数据集，对每个数据集进行拟合，收集估计的参数，将其格式化为五位小数，并以指定的列表的列表格式打印最终结果。所提供的精确分数数据被转换为浮点数以进行数值计算。对所提供数据的分析表明，它是完全解析的，这意味着算法应该会收敛到用于生成数据的精确参数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import least_squares\nfrom fractions import Fraction\n\ndef solve():\n    \"\"\"\n    Solves for MWC model parameters for three datasets using nonlinear least squares regression.\n    \"\"\"\n    \n    # Test suite with three datasets\n    # Structure: (known_constants, agonist_concentrations, P_open_no_mod, P_open_with_mod)\n    # known_constants: n, q, KC, KMC, M\n    test_cases = [\n        {\n            \"constants\": (2, 1, 10.0, 10.0, 10.0),\n            \"A_data\": np.array([0, 10, 30, 40, 90], dtype=float),\n            \"P_open_no_mod\": np.array([Fraction(1, 301), Fraction(1, 49), Fraction(169, 4969), Fraction(289, 7789), Fraction(1369, 31369)], dtype=float),\n            \"P_open_with_mod\": np.array([Fraction(1, 101), Fraction(1, 17), Fraction(169, 1769), Fraction(289, 2789), Fraction(1369, 11369)], dtype=float)\n        },\n        {\n            \"constants\": (2, 1, 10.0, 10.0, 10.0),\n            \"A_data\": np.array([0, 10, 30, 90], dtype=float),\n            \"P_open_no_mod\": np.array([Fraction(1, 201), Fraction(81, 12881), Fraction(361, 51561), Fraction(2401, 322401)], dtype=float),\n            \"P_open_with_mod\": np.array([Fraction(11, 411), Fraction(891, 26491), Fraction(3971, 106371), Fraction(26411, 666411)], dtype=float)\n        },\n        {\n            \"constants\": (4, 1, 10.0, 10.0, 5.0),\n            \"A_data\": np.array([0, 1, 10], dtype=float),\n            \"P_open_no_mod\": np.array([Fraction(1, 31), Fraction(160000, 599230), Fraction(14641, 15121)], dtype=float),\n            \"P_open_with_mod\": np.array([Fraction(11, 56), Fraction(1760000, 2418845), Fraction(161051, 161771)], dtype=float)\n        }\n    ]\n\n    def mwc_model(params, A, M, n, q, KC, KMC):\n        \"\"\"\n        Calculates the open probability based on the MWC model.\n        \n        Args:\n            params (tuple): A tuple or list of parameters (L0, c, phi) to be estimated.\n            A (float or np.ndarray): Agonist concentration(s).\n            M (float): Modulator concentration.\n            n (int): Number of agonist binding sites.\n            q (int): Number of modulator binding sites.\n            KC (float): Agonist dissociation constant for the closed state.\n            KMC (float): Modulator dissociation constant for the closed state.\n        \n        Returns:\n            float or np.ndarray: The calculated open probability(ies).\n        \"\"\"\n        L0, c, phi = params\n        \n        # To prevent division by zero or negative values for c and phi\n        c = max(c, 1e-12)\n        phi = max(phi, 1e-12)\n\n        # Numerator of the L_eff term\n        term_agonist_C = (1 + A / KC)**n\n        term_modulator_C = (1 + M / KMC)**q\n        \n        # Denominator of the L_eff term\n        term_agonist_O = (1 + A / (c * KC))**n\n        term_modulator_O = (1 + M / (phi * KMC))**q\n        \n        p_open = 1.0 / (1.0 + L0 * (term_agonist_C * term_modulator_C) / (term_agonist_O * term_modulator_O))\n        \n        return p_open\n\n    def residuals(params, A_data, P_open_no_mod, P_open_with_mod, constants):\n        \"\"\"\n        Calculates the residuals for the least-squares fit.\n        This function is passed to scipy.optimize.least_squares.\n        \"\"\"\n        n, q, KC, KMC, M = constants\n        \n        # Calculate model predictions for both conditions\n        pred_no_mod = mwc_model(params, A_data, 0, n, q, KC, KMC)\n        pred_with_mod = mwc_model(params, A_data, M, n, q, KC, KMC)\n        \n        # Calculate residuals for both conditions and concatenate them\n        res_no_mod = pred_no_mod - P_open_no_mod\n        res_with_mod = pred_with_mod - P_open_with_mod\n        \n        return np.concatenate((res_no_mod, res_with_mod))\n\n    results = []\n    for case in test_cases:\n        constants = case[\"constants\"]\n        A_data = case[\"A_data\"]\n        P_open_no_mod = case[\"P_open_no_mod\"]\n        P_open_with_mod = case[\"P_open_with_mod\"]\n\n        # Initial guess for parameters [L0, c, phi]\n        initial_guess = [100.0, 0.5, 0.5]\n        \n        # Bounds for parameters (must be positive)\n        bounds = ([1e-9, 1e-9, 1e-9], [np.inf, np.inf, np.inf])\n\n        # Perform the non-linear least squares regression\n        fit_result = least_squares(\n            residuals,\n            initial_guess,\n            bounds=bounds,\n            args=(A_data, P_open_no_mod, P_open_with_mod, constants)\n        )\n        \n        # Extract estimated parameters\n        L0_est, c_est, phi_est = fit_result.x\n        \n        # Store rounded results\n        results.append([round(L0_est, 5), round(c_est, 5), round(phi_est, 5)])\n\n    # Format output as a list of lists string\n    formatted_results = []\n    for r in results:\n        formatted_results.append(f\"[{r[0]:.5f},{r[1]:.5f},{r[2]:.5f}]\")\n    \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2812331"}]}