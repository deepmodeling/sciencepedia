{"hands_on_practices": [{"introduction": "系统与合成生物学的核心在于量化地理解和设计生物分子系统。本练习将从一个基本的调控元件——核糖开关（riboswitch）入手，探讨其对配体的响应。通过构建一个简单的生物物理模型，我们将学习如何预测生物元件的输入-输出行为，这是设计功能可预测的基因线路的关键第一步 [@problem_id:2840949]。", "problem": "一个转录核糖开关控制着信使核糖核酸 (mRNA) 中一个内在终止子的形成。在该系统中，小分子配体与核糖开关适配体的结合会阻止终止子的形成，从而允许RNA聚合酶继续延伸；因此，基因表达随配体浓度的增加而增强。假设以下生物物理理想化条件：(i) 相对于转录决策而言，配体-适配体的结合能迅速达到平衡；(ii) 表达水平与处于配体结合状态的核糖开关的比例成正比（也就是说，在未结合状态下的泄露表达可忽略不计）；(iii) 配体与适配体上的单个位点结合，无协同效应。设适配体的解离常数为 $K_{d}=100~\\mathrm{nM}$，希尔系数为 $n=1$。仅使用解离常数的定义及其所蕴含的平衡占有率，确定当归一化基因表达达到其最大值的 $0.90$ 时所需的配体浓度。以纳摩尔浓度表示最终浓度，并将答案四舍五入至四位有效数字。", "solution": "在尝试求解之前，必须首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n步骤1：提取已知条件。\n题目提供了以下信息和假设：\n- 转录核糖开关控制基因表达。\n- 配体与适配体结合阻止终止子形成，从而增强表达。\n- 假设(i)：配体-适配体结合迅速达到平衡。\n- 假设(ii)：表达水平与处于配体结合状态的核糖开关的比例成正比，且未结合状态下的泄露表达可忽略不计。\n- 假设(iii)：配体与适配体上的单个位点结合，无协同效应。\n- 适配体解离常数：$K_{d}=100~\\mathrm{nM}$。\n- 希尔系数：$n=1$。\n- 目标是求出当归一化基因表达达到其最大值的 $0.90$ 时的配体浓度 $[L]$。\n\n步骤2：使用提取的已知条件进行验证。\n根据所需标准对问题进行评估：\n- **科学性**：所描述的模型是一个简单的配体-受体相互作用的标准表示，该作用遵循质量作用定律，这是化学动力学和生物物理学的一个基本原理。核糖开关是生物学中有据可查的调控元件。这些假设虽然是理想化的，但对于构建此类系统的基本定量模型是标准的。所提供的解离常数值 $K_d = 100~\\mathrm{nM}$ 对于生物分子相互作用是一个物理上现实的值。指定的希尔系数 $n=1$ 与单一位点、非协同结合的假设在数学上是一致的。该问题是科学合理的。\n- **适定性和完整性**：该问题是适定的。它定义了配体浓度和基因表达之间的清晰关系，并要求找出能产生特定输出（归一化表达水平）的输入（配体浓度）。所有必要的参数（$K_d$，目标表达水平）均已提供。该模型是自洽的，不包含相互矛盾的约束条件。\n\n步骤3：结论与行动。\n该问题是有效的。它基于已确立的生物物理学原理，并且在数学上是适定的。下面将推导求解过程。\n\n解题过程从解离常数和分数占有率的定义开始。设 $[A]$ 代表游离适配体的浓度，$[L]$ 代表游离配体的浓度，$[AL]$ 代表配体-适配体复合物的浓度。结合平衡由下式给出：\n$$ A + L \\rightleftharpoons AL $$\n根据定义，此反应在平衡状态下的解离常数 $K_d$ 为：\n$$ K_d = \\frac{[A][L]}{[AL]} $$\n题目指出，基因表达水平与处于配体结合状态的核糖开关的比例成正比。这个比例，通常表示为 $\\theta$ (分数占有率)，是已结合的适配体浓度与适配体总浓度 $[A]_{\\text{total}}$ 的比值。\n$$ \\theta = \\frac{[AL]}{[A]_{\\text{total}}} = \\frac{[AL]}{[A] + [AL]} $$\n为了将 $\\theta$ 表示为配体浓度 $[L]$ 的函数，我们首先重新整理解离常数方程，以求解游离适配体浓度 $[A]$：\n$$ [A] = \\frac{K_d [AL]}{[L]} $$\n将 $[A]$ 的这个表达式代入 $\\theta$ 的方程中：\n$$ \\theta = \\frac{[AL]}{\\frac{K_d [AL]}{[L]} + [AL]} $$\n由于 $[AL]$ 出现在所有项中，并且我们假设存在非零结合，因此我们可以将分子和分母同时除以 $[AL]$：\n$$ \\theta = \\frac{1}{\\frac{K_d}{[L]} + 1} $$\n将分子和分母同乘以 $[L]$，得到标准的Langmuir等温线，这与希尔系数 $n=1$ 时的Hill方程相同：\n$$ \\theta = \\frac{[L]}{K_d + [L]} $$\n归一化基因表达等同于此分数占有率 $\\theta$，因为当 $[L] \\to \\infty$ 时，$\\theta \\to 1$，此时达到最大表达。我们的任务是找出归一化表达为 $0.90$ 时的配体浓度 $[L]$。因此，我们设 $\\theta = 0.90$。\n$$ 0.90 = \\frac{[L]}{K_d + [L]} $$\n现在我们求解这个关于 $[L]$ 的代数方程。\n$$ 0.90 \\times (K_d + [L]) = [L] $$\n$$ 0.90 K_d + 0.90 [L] = [L] $$\n$$ 0.90 K_d = [L] - 0.90 [L] $$\n$$ 0.90 K_d = (1 - 0.90) [L] $$\n$$ 0.90 K_d = 0.10 [L] $$\n$$ [L] = \\frac{0.90}{0.10} K_d = 9 K_d $$\n题目提供了 $K_d = 100~\\mathrm{nM}$。代入此值：\n$$ [L] = 9 \\times 100~\\mathrm{nM} = 900~\\mathrm{nM} $$\n题目要求答案保留四位有效数字。计算值 $900$ 基于输入是精确的。为了用四位有效数字表示，我们将其写为 $900.0$。", "answer": "$$\\boxed{900.0}$$", "id": "2840949"}, {"introduction": "在掌握了单个元件的建模后，下一步是理解元件间的相互作用如何涌现出复杂的系统级行为。本练习将分析一个经典的合成生物学线路——基因拨动开关（genetic toggle switch），它由两个相互抑制的基因构成。你将通过更深入的数学分析，推导出该线路实现双稳态功能所需的精确条件，从而揭示系统级特性是如何从元件间的连接方式中产生的 [@problem_id:2840929]。", "problem": "考虑由以下常微分方程（ODE）控制的双基因相互抑制开关\n$$\n\\frac{dx}{dt}=\\frac{\\alpha}{1+\\left(\\frac{y}{K_y}\\right)^{n}}-\\gamma x,\\qquad\n\\frac{dy}{dt}=\\frac{\\alpha}{1+\\left(\\frac{x}{K_x}\\right)^{n}}-\\gamma y,\n$$\n其中 $x$ 和 $y$ 表示蛋白质浓度，$\\alpha$ 是最大合成速率，$\\gamma$ 是一阶降解/稀释速率，$K_x$ 和 $K_y$ 是抑制作用的解离常数，$n$ 是希尔协同性系数。假设相对于蛋白质动力学，启动子的结合-解离过程非常迅速，从而使得标准的希尔抑制形式成立，并假设合成和降解在时间上是均匀的。\n\n你的任务是，在对称情况 $\\,K_x=K_y=K\\,$ 下，从相平面分析和分岔几何的第一性原理出发，推导出一个关于 $\\,\\gamma$、$\\,K\\,$ 和 $\\,n\\,$ 的闭式表达式，用于描述标志着三稳态（即恰好有三个实不动点）出现的最小合成速率 $\\,\\alpha_c\\,$。你的推导必须从零斜线的定义以及通过合并产生额外不动点的精确相切条件开始。如果方便，你可以进行无量纲化，但最终结果必须以原始参数给出 $\\,\\alpha_c\\,$ 的表达式。\n\n请将你的最终结果报告为 $\\,\\alpha_c\\,$ 关于 $\\,\\gamma$、$\\,K\\,$ 和 $\\,n\\,$ 的单一解析表达式。在方框答案中不要包含单位。不需要进行数值四舍五入。请明确说明作为确保三个实不动点存在的一部分而出现的任何关于 $\\,n\\,$ 的必要条件。", "solution": "该问题要求推导对称基因开关系统恰好表现出三个不动点时的最小合成速率 $\\alpha_c$。此条件对应于双稳态的起始，它源于一个鞍结分岔，在该分岔点上会产生两个新的不动点。推导将从控制系统的常微分方程（ODE）出发，并使用相平面分析方法。\n\n给定的常微分方程组为：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1+\\left(\\frac{y}{K_y}\\right)^{n}}-\\gamma x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1+\\left(\\frac{x}{K_x}\\right)^{n}}-\\gamma y\n$$\n我们考虑对称情况，其中 $K_x = K_y = K$。\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1+\\left(\\frac{y}{K}\\right)^{n}}-\\gamma x\n$$\n$$\n\\frac{dy}{dt} = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}-\\gamma y\n$$\n系统的不动点通过令时间导数为零来找到：$\\frac{dx}{dt} = 0$ 和 $\\frac{dy}{dt} = 0$。这定义了系统的零斜线。\n$x$-零斜线由下式给出：\n$$\n\\gamma x = \\frac{\\alpha}{1+\\left(\\frac{y}{K}\\right)^{n}}\n$$\n$y$-零斜线由下式给出：\n$$\n\\gamma y = \\frac{\\alpha}{1+\\left(\\frac{x}{K}\\right)^{n}}\n$$\n为简化分析，我们对系统进行无量纲化。令 $u = \\frac{x}{K}$，$v = \\frac{y}{K}$，以及 $\\tau = \\gamma t$。这意味着 $t = \\frac{\\tau}{\\gamma}$，$x=Ku$，$y=Kv$。将这些代入第一个常微分方程：\n$$\n\\frac{d(Ku)}{d(\\tau/\\gamma)} = \\frac{\\alpha}{1+v^n} - \\gamma (Ku) \\implies \\gamma K \\frac{du}{d\\tau} = \\frac{\\alpha}{1+v^n} - \\gamma K u\n$$\n两边同除以 $\\gamma K$ 得到无量纲形式：\n$$\n\\frac{du}{d\\tau} = \\frac{\\alpha}{\\gamma K} \\frac{1}{1+v^n} - u\n$$\n我们定义无量纲合成速率 $\\beta = \\frac{\\alpha}{\\gamma K}$。完整的无量纲系统为：\n$$\n\\frac{du}{d\\tau} = \\frac{\\beta}{1+v^n} - u\n$$\n$$\n\\frac{dv}{d\\tau} = \\frac{\\beta}{1+u^n} - v\n$$\n在此无量纲平面中，零斜线为 $u = \\frac{\\beta}{1+v^n}$ 和 $v = \\frac{\\beta}{1+u^n}$。不动点是这两条曲线的交点。由于方程的对称性，一个不动点总是位于直线 $u=v$ 上。额外不动点的出现（从一个变为三个）发生在鞍结分岔点。从几何上看，这个分岔点是两条零斜线曲线相互相切的地方。\n\n设定义零斜线的函数为 $f(z) = \\frac{\\beta}{1+z^n}$。零斜线为 $u = f(v)$ 和 $v = f(u)$。第一条零斜线在 $(u,v)$ 平面上的斜率通过对 $u$ 求导得出：$1 = f'(v) \\frac{dv}{du}$，因此 $\\frac{dv}{du} = \\frac{1}{f'(v)}$。第二条零斜线的斜率为 $\\frac{dv}{du} = f'(u)$。\n\n在相切点 $(u_c, v_c)$，两条曲线的斜率必须相等：\n$$\nf'(u_c) = \\frac{1}{f'(v_c)}\n$$\n由于系统的对称性，产生新一对不动点的相切点发生在对角线 $u=v$ 上。因此，$u_c = v_c$。该条件变为：\n$$\nf'(u_c) = \\frac{1}{f'(u_c)} \\implies (f'(u_c))^2 = 1\n$$\n$f(u)$ 关于 $u$ 的导数为：\n$$\nf'(u) = \\frac{d}{du}\\left(\\frac{\\beta}{1+u^n}\\right) = -\\frac{\\beta n u^{n-1}}{\\left(1+u^n\\right)^2}\n$$\n由于蛋白质浓度 $u$ 是非负的，且所有参数 $\\beta, n$ 都是正的，所以对于 $u0$，$f'(u)$ 总是负的。因此，相切条件必须是：\n$$\nf'(u_c) = -1\n$$\n这给出了我们关于临界点的第一个方程。第二个方程是点 $(u_c, u_c)$ 必须位于零斜线上：\n$$\nu_c = f(u_c) = \\frac{\\beta_c}{1+u_c^n}\n$$\n此处，$\\beta_c$ 是发生分岔时 $\\beta$ 的临界值。我们现在求解这个由两个方程组成的方程组，以求出两个未知数 $u_c$ 和 $\\beta_c$。\n\n由 $f'(u_c) = -1$ 可得：\n$$\n-\\frac{\\beta_c n u_c^{n-1}}{(1+u_c^n)^2} = -1 \\implies \\beta_c n u_c^{n-1} = (1+u_c^n)^2\n$$\n根据零斜线方程，我们有 $\\beta_c = u_c(1+u_c^n)$。将此式代入斜率方程：\n$$\n\\left(u_c(1+u_c^n)\\right) n u_c^{n-1} = (1+u_c^n)^2\n$$\n假设 $1+u_c^n \\neq 0$（对于非负的 $u_c$ 这总是成立的），我们可以用 $(1+u_c^n)$ 去除方程两边：\n$$\nn u_c^n = 1+u_c^n\n$$\n$$\n(n-1)u_c^n = 1 \\implies u_c^n = \\frac{1}{n-1}\n$$\n为了使 $u_c$ 存在正实数解，必须有 $\\frac{1}{n-1}  0$，这为希尔协同性系数施加了一个必要条件：\n$$\nn  1\n$$\n如果 $n \\le 1$，协同性不足以产生所需的开关行为，系统将永远只有一个不动点。\n\n现在，我们求解临界无量纲合成速率 $\\beta_c$。从 $u_c^n = \\frac{1}{n-1}$，我们得到 $u_c = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}$。将此式和 $u_c^n$ 的表达式代回 $\\beta_c$ 的零斜线方程：\n$$\n\\beta_c = u_c(1+u_c^n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n$$\n\\beta_c = (n-1)^{-1/n} \\left(\\frac{n-1+1}{n-1}\\right) = (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right)\n$$\n$$\n\\beta_c = n \\cdot (n-1)^{-1} \\cdot (n-1)^{-1/n} = n (n-1)^{-(1 + 1/n)} = n (n-1)^{-(n+1)/n}\n$$\n这就是无量纲的临界合成速率。为了求得最终答案 $\\alpha_c$，我们将其恢复量纲：\n$$\n\\beta_c = \\frac{\\alpha_c}{\\gamma K} \\implies \\alpha_c = \\beta_c \\gamma K\n$$\n代入 $\\beta_c$ 的表达式：\n$$\n\\alpha_c = \\gamma K n (n-1)^{-(n+1)/n}\n$$\n这也可以写作：\n$$\n\\alpha_c = \\frac{\\gamma K n}{(n-1)^{(n+1)/n}}\n$$\n该表达式给出了系统拥有三个不动点所需的最小合成速率 $\\alpha_c$，其前提条件是希尔系数 $n1$。", "answer": "$$\\boxed{\\frac{\\gamma K n}{(n-1)^{(n+1)/n}}}$$", "id": "2840929"}, {"introduction": "前述练习中使用的理论模型依赖于诸如希尔系数 $n$ 和解离常数 $K$ 等关键参数。最后一个练习旨在连接理论与实验，展示如何从真实的剂量-响应数据中估计这些参数。通过对希尔方程进行线性化并应用统计回归分析，你将掌握一项对于建立并验证数学模型的定量生物学家至关重要的实践技能 [@problem_id:2840935]。", "problem": "给定一个启动子或受体的输入（剂量）$A_i$ 和输出（响应）$y_i$ 的测量值。该启动子或受体表现出协同结合，在系统生物学和合成生物学中通常使用希尔函数进行建模。希尔输入-输出函数定义为\n$$\ny = \\frac{A^n}{K^n + A^n},\n$$\n其中 $A$ 是输入，$y$ 是归一化输出（$0  y  1$），$n$ 是希尔系数，$K$ 是产生半最大响应时的输入值。\n\n基本原理：希尔函数是一个经过充分检验的、用于描述协同结合和转录调控的唯象模型。对于 $0  y  1$，logit变换定义为 $\\operatorname{logit}(y) = \\ln\\!\\left(\\frac{y}{1-y}\\right)$。在同方差高斯误差的假设下，对模型 $Z = \\beta_0 + \\beta_1 X + \\varepsilon$ 进行普通最小二乘（OLS）线性回归，可以得到 $\\beta_0$ 和 $\\beta_1$ 的无偏估计量，其抽样分布允许我们基于学生t分布构建置信区间。\n\n任务：通过上述定义推导，构建一个线性回归方法，通过使用logit变换和自然对数的线性化来估计希尔系数 $n$。假设在变换后（线性化）的域中，误差为同方差高斯误差。对于 $N$ 个数据点，使用基于具有 $N-2$ 自由度的学生t分布，构建置信水平为 $0.95$ 的双侧置信区间。将 $n$ 的估计值及其置信区间的下限和上限作为实数报告。\n\n实现要求：\n- 所有对数均使用自然对数。\n- 对线性化后的数据执行普通最小二乘法，以获得斜率及其标准误。\n- 使用学生t分布的适当临界值，为 $n$ 构建置信水平为 $0.95$ 的双侧置信区间。\n- 不使用权重；假设在变换后的域中存在同方差性。\n\n测试套件：\n将您的程序应用于以下三个测试用例。对于每个用例，请使用提供的剂量-响应对 $\\{(A_i, y_i)\\}_{i=1}^N$。所有数值均按给定值使用。\n\n- 测试用例 1：\n  - `A = [1, 5, 10, 20, 50, 100, 200, 500]`\n  - `y = [0.0051, 0.0643, 0.1242, 0.2566, 0.5000, 0.6900, 0.8447, 0.9379]`\n\n- 测试用例 2：\n  - `A = [0.2, 0.5, 1.0, 2.0, 5.0, 10.0]`\n  - `y = [0.0020, 0.01238, 0.1151, 0.5000, 0.93385, 0.98806]`\n\n- 测试用例 3：\n  - `A = [0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0]`\n  - `y = [0.0597, 0.1059, 0.1623, 0.2984, 0.4197, 0.5592, 0.7207]`\n\n不涉及角度单位。不涉及物理单位。所有输出都必须是实数值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为类似JSON的列表的列表。每个内部列表必须按此顺序包含三个浮点数：$n$ 的估计值、$0.95$ 置信区间的下限和 $0.95$ 置信区间的上限。\n- 每个数字必须精确到小数点后四位。\n- 打印的行必须具有以下形式：\n  - 例如，$[\\,[n_1,\\ell_1,u_1],[n_2,\\ell_2,u_2],[n_3,\\ell_3,u_3]\\,]$, 其中 $n_j$, $\\ell_j$, 和 $u_j$ 是对应于测试用例 $j$ 的、四舍五入到四位小数的浮点数。\n\n您的程序不得读取任何输入，也不得打印任何其他内容。", "solution": "所述问题是有效的。它在科学上基于生物化学建模和统计推断的既定原则，问题阐述清晰，目标明确，并为获得唯一解提供了所有必要信息。任务是通过对希尔函数进行线性化并应用普通最小二乘（OLS）回归，从剂量-响应数据对 $(A_i, y_i)$ 中估计希尔系数 $n$。\n\n希尔函数由下式给出：\n$$\ny = \\frac{A^n}{K^n + A^n}\n$$\n在此式中，$y$ 是归一化响应，其范围限定在 $0  y  1$，$A$ 是输入浓度，$n$ 是量化协同性的希尔系数，$K$ 是解离常数，表示产生半最大响应时的输入浓度。\n\n问题要求使用logit变换对该函数进行线性化，对于概率或比例 $p$，该变换定义为 $\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)$。将此变换应用于响应变量 $y$ 需要我们首先用模型参数表示比率 $\\frac{y}{1-y}$。\n\n首先，我们求出 $1-y$ 的表达式：\n$$\n1-y = 1 - \\frac{A^n}{K^n + A^n} = \\frac{(K^n + A^n) - A^n}{K^n + A^n} = \\frac{K^n}{K^n + A^n}\n$$\n现在，我们可以构建比率 $\\frac{y}{1-y}$：\n$$\n\\frac{y}{1-y} = \\frac{\\frac{A^n}{K^n + A^n}}{\\frac{K^n}{K^n + A^n}} = \\frac{A^n}{K^n} = \\left(\\frac{A}{K}\\right)^n\n$$\n为实现线性关系，我们根据问题陈述的建议，对等式两边取自然对数：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = \\ln\\left(\\left(\\frac{A}{K}\\right)^n\\right)\n$$\n利用对数的性质，我们可以简化方程：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = n \\ln\\left(\\frac{A}{K}\\right) = n (\\ln(A) - \\ln(K))\n$$\n重新整理得到最终的线性形式：\n$$\n\\ln\\left(\\frac{y}{1-y}\\right) = n \\ln(A) - n \\ln(K)\n$$\n该方程符合标准线性模型 $Z = \\beta_1 X + \\beta_0$，我们进行以下识别：\n-   变换后的响应变量是 $Z = \\ln\\left(\\frac{y}{1-y}\\right)$。\n-   变换后的输入变量是 $X = \\ln(A)$。\n-   直线的斜率是 $\\beta_1 = n$。\n-   直线的截距是 $\\beta_0 = -n \\ln(K)$。\n\n主要目标是估计希尔系数 $n$。根据我们的线性化， $n$ 的估计值就是对 $Z$ 和 $X$ 进行普通最小二乘回归得到的斜率估计值 $\\hat{\\beta}_1$。给定 $N$ 个数据点 $\\{(A_i, y_i)\\}_{i=1}^N$，我们首先将它们转换为线性域数据集 $\\{(X_i, Z_i)\\}_{i=1}^N$。斜率 $\\beta_1$ 的普通最小二乘估计量由下式给出：\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^N (X_i - \\bar{X})(Z_i - \\bar{Z})}{\\sum_{i=1}^N (X_i - \\bar{X})^2}\n$$\n其中 $\\bar{X}$ 和 $\\bar{Z}$ 是变换后数据的样本均值。因此，我们对希尔系数的估计是 $\\hat{n} = \\hat{\\beta}_1$。\n\n问题还要求构建 $n$ 的 $95\\%$ 置信区间。回归斜率的双侧置信区间的通用形式是：\n$$\n\\hat{\\beta}_1 \\pm t_{\\alpha/2, N-2} \\cdot \\text{SE}(\\hat{\\beta}_1)\n$$\n其中：\n-   $\\hat{\\beta}_1$ 是我们估计的斜率，即 $\\hat{n}$。\n-   $\\text{SE}(\\hat{\\beta}_1)$ 是斜率估计的标准误。\n-   $N$ 是数据点的数量。\n-   $t$ 分布的自由度是 $df = N-2$。\n-   对于 $95\\%$ 的置信水平，显著性水平为 $\\alpha = 0.05$。我们需要来自学生t分布的临界值 $t_{0.025, N-2}$，该值满足 $P(T  t_{0.025, N-2}) = 0.025$，其中 $T$ 是一个具有 $N-2$ 自由度的t分布随机变量。\n\n斜率的标准误 $\\text{SE}(\\hat{\\beta}_1)$ 计算如下：\n$$\n\\text{SE}(\\hat{\\beta}_1) = \\sqrt{\\frac{\\text{MSE}}{\\sum_{i=1}^N (X_i - \\bar{X})^2}}\n$$\n其中 MSE 是残差的均方误差：\n$$\n\\text{MSE} = \\frac{\\text{SSE}}{N-2} = \\frac{1}{N-2}\\sum_{i=1}^N (Z_i - \\hat{Z}_i)^2\n$$\n并且 $\\hat{Z}_i = \\hat{\\beta}_0 + \\hat{\\beta}_1 X_i$ 是回归的预测值。在变换后的 $(X,Z)$ 空间中，同方差高斯误差的假设证明了此过程的合理性。\n\n每个测试用例的计算过程如下：\n1.  给定数据数组 $A$ 和 $y$，计算变换后的变量 $X = \\ln(A)$ 和 $Z = \\ln(y/(1-y))$。\n2.  对 $Z$ 和 $X$ 进行普通最小二乘线性回归，以获得斜率估计值 $\\hat{n} = \\hat{\\beta}_1$ 及其标准误 $\\text{SE}(\\hat{n}) = \\text{SE}(\\hat{\\beta}_1)$。\n3.  确定数据点的数量 $N$ 并计算自由度 $df = N-2$。\n4.  找到临界 $t$ 值，$t_{\\text{crit}} = t_{0.025, df}$。\n5.  计算误差范围，$ME = t_{\\text{crit}} \\cdot \\text{SE}(\\hat{n})$。\n6.  构建置信区间为 $[\\hat{n} - ME, \\hat{n} + ME]$。\n7.  报告结果 $\\hat{n}$、下限和上限，每个都四舍五入到小数点后四位。\n这提供了一个完整且统计上严谨的方法来满足问题的要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress, t\n\ndef solve():\n    \"\"\"\n    Estimates the Hill coefficient and its confidence interval from dose-response data\n    by linearizing the Hill equation and using Ordinary Least Squares regression.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            np.array([1, 5, 10, 20, 50, 100, 200, 500], dtype=float),\n            np.array([0.0051, 0.0643, 0.1242, 0.2566, 0.5000, 0.6900, 0.8447, 0.9379], dtype=float)\n        ),\n        (\n            np.array([0.2, 0.5, 1.0, 2.0, 5.0, 10.0], dtype=float),\n            np.array([0.0020, 0.01238, 0.1151, 0.5000, 0.93385, 0.98806], dtype=float)\n        ),\n        (\n            np.array([0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0], dtype=float),\n            np.array([0.0597, 0.1059, 0.1623, 0.2984, 0.4197, 0.5592, 0.7207], dtype=float)\n        )\n    ]\n\n    results = []\n    confidence_level = 0.95\n    alpha = 1 - confidence_level\n\n    for A, y in test_cases:\n        # Step 1: Linearize the data\n        # The Hill equation y = A^n / (K^n + A^n) is linearized to\n        # log(y / (1 - y)) = n*log(A) - n*log(K).\n        # This is of the form Z = beta1*X + beta0, where:\n        # Z = log(y / (1 - y))\n        # X = log(A)\n        # beta1 = n (Hill coefficient)\n        \n        # Ensure inputs to log are positive\n        if np.any(A = 0) or np.any(y = 0) or np.any(y >= 1):\n             # This case should not happen with the provided data\n             # but is good practice to handle.\n             raise ValueError(\"Invalid input data for logarithmic transformation.\")\n\n        X_transformed = np.log(A)\n        Z_transformed = np.log(y / (1 - y))\n\n        # Step 2: Perform Ordinary Least Squares (OLS) linear regression\n        # `linregress` returns slope, intercept, r_value, p_value, and std_err of the slope\n        regression_result = linregress(X_transformed, Z_transformed)\n        \n        n_estimate = regression_result.slope\n        se_n = regression_result.stderr\n\n        # Step 3: Construct the confidence interval for the slope (n)\n        N = len(A)\n        df = N - 2  # Degrees of freedom for t-distribution\n\n        # Get the critical value from the Student's t-distribution for a two-sided interval\n        t_critical = t.ppf(1 - alpha / 2, df)\n\n        # Calculate the margin of error\n        margin_of_error = t_critical * se_n\n\n        # Calculate the lower and upper bounds of the confidence interval\n        lower_bound = n_estimate - margin_of_error\n        upper_bound = n_estimate + margin_of_error\n\n        results.append([n_estimate, lower_bound, upper_bound])\n\n    # Final print statement in the exact required format.\n    # Each number is rounded to four decimal places.\n    output_parts = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.4f},{res[1]:.4f},{res[2]:.4f}]\"\n        output_parts.append(formatted_res)\n    \n    print(f\"[{','.join(output_parts)}]\")\n\nsolve()\n```", "id": "2840935"}]}