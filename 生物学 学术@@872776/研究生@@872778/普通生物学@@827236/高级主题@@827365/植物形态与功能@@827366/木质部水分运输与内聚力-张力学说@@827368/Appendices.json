{"hands_on_practices": [{"introduction": "内聚力-张力学说认为，木质部中的水处于巨大的负压之下。那么，是什么物理机制阻止了空气被吸入水柱，导致栓塞呢？本练习将深入探讨在木质部纹孔膜的纳米级孔隙中，表面张力如何发挥关键作用，以承受巨大的压力差。通过从第一性原理推导杨-拉普拉斯方程，你将能够量化这一维持木质部水柱连续性的核心机制 [@problem_id:2849117]。", "problem": "内聚力-张力理论假定，木质部中的水处于张力之下，纹孔膜纳米孔中的空气-水界面维持着巨大的压力差，以防止气体栓塞。仅从液体界面的表面自由能等于表面张力乘以面积的定义出发，并利用与可移动界面上的压力差相关的可逆机械功，推导出球形空气-水界面两端的压力差与其曲率半径之间的平衡关系。具体来说：\n- 将表面张力视为常数 $ \\gamma $ (与曲率无关)，并将表面自由能定义为 $ U_{\\text{surf}} = \\gamma A $。\n- 考虑一个可逆、等温、准静态的虚位移，该位移在界面两侧压力差 $ \\Delta P $ 的作用下，使界面面积改变了 $ \\mathrm{d}A $，封闭的液体体积改变了 $ \\mathrm{d}V $。\n- 通过对此可逆位移应用能量守恒来施加力学平衡条件。\n\n然后将您推导出的关系应用于木质部纹孔膜纳米孔。假设跨越孔的弯月面是良好润湿的，因此接触角实际为零，并将弯月面近似为球体的一部分，其曲率半径等于孔半径。对于孔半径 $ r = 50\\,\\mathrm{nm} $ 和室温下水的表面张力 $ \\gamma = 0.072\\,\\mathrm{N\\,m^{-1}} $，计算弯月面所能维持的压力差的大小。用兆帕 (MPa) 表示最终的压力差，并将答案四舍五入到三位有效数字。最终答案必须是一个实数。", "solution": "所陈述的问题是有效的。它具有科学依据，提法明确，没有歧义或矛盾。我们将继续进行推导和后续计算。\n\n第一个任务是推导球形界面两端的压力差 $\\Delta P$ 与其曲率半径 $R$ 之间的关系。我们考虑一个球形空气-水界面的可逆、等温、准静态的虚位移。问题要求从能量守恒进行推导，对于可逆等温过程，这等同于陈述亥姆霍兹自由能的变化量 $\\mathrm{d}F$ 在平衡时为零。\n\n亥姆霍兹自由能 $F$ 的全微分包括机械功和新表面积产生的项。在体积膨胀 $\\mathrm{d}V$ 的过程中，系统抵抗压力差 $\\Delta P = P_{\\text{in}} - P_{\\text{out}}$ 所做的功是 $\\Delta P\\,\\mathrm{d}V$。因此，外界对系统做的功是 $-\\Delta P\\,\\mathrm{d}V$。根据问题中的定义，表面自由能的变化是 $\\mathrm{d}U_{\\text{surf}} = \\gamma\\,\\mathrm{d}A$，其中 $\\gamma$ 是表面张力，$A$ 是表面积。\n\n组合系统（体相+界面）的总自由能变化由下式给出：\n$$ \\mathrm{d}F = -\\Delta P\\,\\mathrm{d}V + \\gamma\\,\\mathrm{d}A $$\n在平衡状态下，系统的自由能处于最小值，因此对于任何虚位移，变化量 $\\mathrm{d}F$ 必须为零。这得出力学平衡的条件：\n$$ \\Delta P\\,\\mathrm{d}V = \\gamma\\,\\mathrm{d}A $$\n为了继续推导，我们必须将球形界面的体积变化 $\\mathrm{d}V$ 与面积变化 $\\mathrm{d}A$ 联系起来。设球体的曲率半径为 $R$。其体积 $V$ 和表面积 $A$ 分别为：\n$$ V = \\frac{4}{3}\\pi R^{3} $$\n$$ A = 4\\pi R^{2} $$\n我们考虑一个使半径发生无穷小量 $\\mathrm{d}R$ 变化的虚位移。相应的体积和面积变化通过对 $R$ 求导得出：\n$$ \\mathrm{d}V = \\frac{\\mathrm{d}V}{\\mathrm{d}R}\\mathrm{d}R = 4\\pi R^{2}\\,\\mathrm{d}R $$\n$$ \\mathrm{d}A = \\frac{\\mathrm{d}A}{\\mathrm{d}R}\\mathrm{d}R = 8\\pi R\\,\\mathrm{d}R $$\n将这些表达式代入我们的平衡条件：\n$$ \\Delta P \\left(4\\pi R^{2}\\,\\mathrm{d}R\\right) = \\gamma \\left(8\\pi R\\,\\mathrm{d}R\\right) $$\n只要 $R > 0$ 且 $\\mathrm{d}R \\neq 0$，我们就可以消去方程两边的非零项 $4\\pi R\\,\\mathrm{d}R$。简化后得到：\n$$ \\Delta P \\cdot R = 2\\gamma $$\n对压力差进行整理，得到球形界面的杨-拉普拉斯方程：\n$$ \\Delta P = \\frac{2\\gamma}{R} $$\n该方程将球形界面两端的压力差与表面张力和曲率半径联系起来。压力在界面的凹侧更高。在木质部的背景下，水处于张力（较低压力）之下，因此从空气一侧看，空气-水界面是凹的，其曲率中心位于水相中。因此 $\\Delta P = P_{\\text{air}} - P_{\\text{water}} > 0$。\n\n第二个任务是将此推导出的关系应用于木质部纹孔膜纳米孔。问题提供了必要的数据和假设。我们已知：\n- 孔半径，$r = 50\\,\\mathrm{nm} = 50 \\times 10^{-9}\\,\\mathrm{m}$。\n- 水的表面张力，$\\gamma = 0.072\\,\\mathrm{N\\,m^{-1}}$。\n问题陈述，弯月面是良好润湿的（接触角为零），并且可以近似为球体的一部分，其曲率半径 $R$ 等于孔半径 $r$。因此，我们在推导出的方程中令 $R = r$。\n\n弯月面所能维持的压力差的大小 $|\\Delta P|$ 为：\n$$ |\\Delta P| = \\frac{2\\gamma}{r} $$\n代入给定的数值：\n$$ |\\Delta P| = \\frac{2 \\times 0.072\\,\\mathrm{N\\,m^{-1}}}{50 \\times 10^{-9}\\,\\mathrm{m}} $$\n首先，我们计算分子：\n$$ 2 \\times 0.072 = 0.144 $$\n所以表达式变为：\n$$ |\\Delta P| = \\frac{0.144\\,\\mathrm{N\\,m^{-1}}}{50 \\times 10^{-9}\\,\\mathrm{m}} = \\frac{0.144}{50} \\times 10^{9}\\,\\mathrm{N\\,m^{-2}} $$\n单位 $\\mathrm{N\\,m^{-2}}$ 是帕斯卡，$\\mathrm{Pa}$。\n$$ |\\Delta P| = 0.00288 \\times 10^{9}\\,\\mathrm{Pa} = 2.88 \\times 10^{6}\\,\\mathrm{Pa} $$\n问题要求答案以兆帕 ($\\mathrm{MPa}$) 表示。根据定义，$1\\,\\mathrm{MPa} = 10^{6}\\,\\mathrm{Pa}$。\n因此：\n$$ |\\Delta P| = 2.88\\,\\mathrm{MPa} $$\n此结果已按题目要求表示为三位有效数字。这个巨大的压力差表明，木质部内的水柱可以维持相当大的张力，这是植物汁液上升的内聚力-张力理论的基石。", "answer": "$$\\boxed{2.88}$$", "id": "2849117"}, {"introduction": "一旦我们理解了张力是如何维持的，下一步就是探究这种张力如何驱动水的流动。本练习运用流体动力学原理来模拟水在木质部导管中的运输过程。通过推导和应用哈根-泊肃叶方程，你将定量地理解导管半径等解剖学差异如何极大地影响导水效率，这对于理解植物进化和水分利用策略至关重要 [@problem_id:2849188]。", "problem": "在木质部运输的内聚-张力理论框架中，水通过轴向压力势梯度被拉过管道。将每个管道内腔视为一个刚性的、直的、圆形的圆柱体，其中有不可压缩的牛顿流体在稳态、充分发展的层流条件下流动，壁面无滑移，并忽略端壁和纹孔膜对阻力的贡献。考虑两个承受相同轴向压差大小 $\\Delta P$ 的管道：一个半径为 $20\\,\\mu\\mathrm{m}$、长度为 $5\\,\\mathrm{mm}$ 的导管，以及一个半径为 $5\\,\\mu\\mathrm{m}$、长度为 $5\\,\\mathrm{mm}$ 的管胞。水的动力粘度为 $\\eta=1.2\\,\\mathrm{mPa\\,s}$，压差大小为 $\\Delta P=0.5\\,\\mathrm{MPa}$。\n\n从圆柱体中粘性流的第一性原理出发，确定在这些条件下通过导管和管胞的体积流率的无量纲比率。将最终答案表示为一个四舍五入到三位有效数字的无量纲数。最终答案中不要包含任何单位。", "solution": "题目要求在稳态、层流、不可压缩流动的条件下，确定通过两个圆柱形管道（一个导管和一个管胞）的体积流率之比。题目指示我们从第一性原理开始。\n\n这个流体动力学问题的控制原理是稳态流动中流体元上的力平衡。考虑一个半径为 $R$、长度为 $L$ 的圆柱形管道。流动由长度 $L$ 上的压差 $\\Delta P$ 驱动。对于稳态流（即无加速度），任何流体元上的合力为零。我们来分析一个与管道同轴、半径为 $r$（其中 $r \\le R$）、长度为 $L$ 的圆柱形流体元。\n\n作用在这个流体圆柱体上的力有：\n1.  来自入口压力的力：$F_{P1} = P_1 (\\pi r^2)$。\n2.  来自出口压力的力：$F_{P2} = -P_2 (\\pi r^2)$。\n3.  粘性拖曳力 $F_{\\eta}$，由相邻的流体外层作用在圆柱体表面积 $A_{surf} = 2\\pi r L$ 上。这个力与流动方向相反。\n\n净压力为 $F_P = F_{P1} + F_{P2} = (P_1 - P_2)\\pi r^2 = \\Delta P \\pi r^2$。\n粘性拖曳力为 $F_{\\eta} = -\\tau(r) (2\\pi r L)$，其中 $\\tau(r)$ 是半径 $r$ 处的剪应力。对于稳态流，力的总和为零：\n$$ \\Delta P \\pi r^2 - \\tau(r) (2\\pi r L) = 0 $$\n从这个力平衡，我们可以将剪应力表示为半径 $r$ 的函数：\n$$ \\tau(r) = \\frac{\\Delta P}{2L} r $$\n题目说明流体是牛顿流体。对于牛顿流体，剪应力与速度梯度成正比。在柱坐标系中，这个关系由下式给出：\n$$ \\tau(r) = -\\eta \\frac{du}{dr} $$\n其中 $\\eta$ 是动力粘度，$u(r)$ 是半径 $r$ 处的流体速度。负号表示速度随着半径从中心（$r=0$）向管壁（$r=R$）增加而减小。\n\n将剪应力的两个表达式相等，得到一个关于速度剖面 $u(r)$ 的一阶常微分方程：\n$$ -\\eta \\frac{du}{dr} = \\frac{\\Delta P}{2L} r $$\n$$ \\frac{du}{dr} = -\\frac{\\Delta P}{2\\eta L} r $$\n我们通过对 $r$ 积分来求解 $u(r)$：\n$$ \\int du = \\int -\\frac{\\Delta P}{2\\eta L} r \\,dr $$\n$$ u(r) = -\\frac{\\Delta P}{4\\eta L} r^2 + C $$\n其中 $C$ 是积分常数。我们使用无滑移边界条件来确定 $C$，该条件表明流体在管道的静止壁面处速度为零。在 $r=R$ 处，$u(R)=0$：\n$$ 0 = -\\frac{\\Delta P}{4\\eta L} R^2 + C $$\n$$ C = \\frac{\\Delta P}{4\\eta L} R^2 $$\n将 $C$ 的这个表达式代回 $u(r)$ 的方程，我们得到管道中层流的抛物线速度剖面：\n$$ u(r) = \\frac{\\Delta P}{4\\eta L} (R^2 - r^2) $$\n体积流率 $Q$ 是速度剖面在管道横截面积上的积分。我们通过对面积为 $dA = 2\\pi r \\,dr$ 的无穷小环形区域上的流速进行积分：\n$$ Q = \\int_0^R u(r) \\,dA = \\int_0^R \\frac{\\Delta P}{4\\eta L} (R^2 - r^2) (2\\pi r) \\,dr $$\n提出常数：\n$$ Q = \\frac{2\\pi \\Delta P}{4\\eta L} \\int_0^R (R^2r - r^3) \\,dr = \\frac{\\pi \\Delta P}{2\\eta L} \\left[ \\frac{R^2r^2}{2} - \\frac{r^4}{4} \\right]_0^R $$\n计算积分在积分限处的值：\n$$ Q = \\frac{\\pi \\Delta P}{2\\eta L} \\left( \\left(\\frac{R^4}{2} - \\frac{R^4}{4}\\right) - (0) \\right) = \\frac{\\pi \\Delta P}{2\\eta L} \\left( \\frac{R^4}{4} \\right) $$\n这个结果就是哈根-泊肃叶方程：\n$$ Q = \\frac{\\pi \\Delta P R^4}{8\\eta L} $$\n题目要求计算通过导管的体积流率（$Q_v$）与通过管胞的体积流率（$Q_t$）之比。导管的半径为 $R_v = 20\\,\\mu\\mathrm{m}$，长度为 $L_v = 5\\,\\mathrm{mm}$。管胞的半径为 $R_t = 5\\,\\mu\\mathrm{m}$，长度为 $L_t = 5\\,\\mathrm{mm}$。两者都承受相同的压差大小 $\\Delta P = 0.5\\,\\mathrm{MPa}$，流体是水，其粘度为 $\\eta = 1.2\\,\\mathrm{mPa\\,s}$。\n\n对每个管道使用哈根-泊肃叶方程：\n$$ Q_v = \\frac{\\pi \\Delta P R_v^4}{8\\eta L_v} $$\n$$ Q_t = \\frac{\\pi \\Delta P R_t^4}{8\\eta L_t} $$\n题目说明 $\\Delta P$、$\\eta$ 和 $L$ 对于两个管道是相同的（$L_v = L_t = 5\\,\\mathrm{mm}$）。因此，当我们计算比率 $\\frac{Q_v}{Q_t}$ 时，这些项会消掉：\n$$ \\frac{Q_v}{Q_t} = \\frac{\\frac{\\pi \\Delta P R_v^4}{8\\eta L}}{\\frac{\\pi \\Delta P R_t^4}{8\\eta L}} = \\frac{R_v^4}{R_t^4} = \\left(\\frac{R_v}{R_t}\\right)^4 $$\n计算该比率不需要 $\\Delta P$、$\\eta$ 和 $L$ 的数值，尽管它们对于确认流态确实是层流是必要的。对较宽的管道（导管）进行雷诺数（$Re = \\frac{\\rho v D}{\\eta}$）计算，得出 $Re \\approx 139$，这远低于湍流的阈值（$Re \\approx 2300$），从而验证了层流模型的有效性。\n\n现在，我们将给定的半径代入比率表达式：\n$$ R_v = 20\\,\\mu\\mathrm{m} $$\n$$ R_t = 5\\,\\mu\\mathrm{m} $$\n$$ \\frac{Q_v}{Q_t} = \\left(\\frac{20\\,\\mu\\mathrm{m}}{5\\,\\mu\\mathrm{m}}\\right)^4 = (4)^4 $$\n计算很简单：\n$$ 4^4 = 16^2 = 256 $$\n该比率是一个无量纲数。题目要求答案四舍五入到三位有效数字。数字 $256$ 是一个精确的整数，并且已经有三位有效数字。", "answer": "$$\\boxed{256}$$", "id": "2849188"}, {"introduction": "当张力过大时，内聚力-张力机制便会失效，导致空穴化和栓塞。我们如何量化植物对这种失效的敏感性？这个实践性的计算练习将指导你拟合木质部脆弱性曲线，这是现代植物生态生理学中的一项核心技能。你将学习如何从实验数据中提取如 $\\psi_{50}$（50%电导率损失时的水势）这样的关键功能性状，并使用自助法（bootstrapping）来评估其不确定性 [@problem_id:2849211]。", "problem": "给你三个独立的数据集，用于测量在内聚力-张力机制下，木质部中的电导率损失百分比 (PLC) 作为水势的函数。假设在给定的水势 $ \\psi $ (单位为 MPa) 下，每个导管独立发生栓塞的概率为 $ p(\\psi) $，并且测得的 $ PLC $ 是栓塞导管的比例。设 $ p(\\psi) $ 由一个双参数逻辑斯谛族模型来建模，该模型由 $ PLC = 0.5 $ 时的水势（记作 $ \\psi_{50} $，单位为 MPa）和一个无量纲的陡度参数 $S$（单位为 $\\text{MPa}^{-1}$）表征，具体如下：\n$$\np(\\psi) \\;=\\; \\frac{1}{1 + \\exp\\!\\left( S\\,(\\psi - \\psi_{50}) \\right)} \\, .\n$$\n该模型与将 $ p(\\psi) $ 解释为异质木质部群体中导管气体栓塞阈值的累积分布函数，以及栓塞事件的独立性假设是一致的。\n\n你的任务是编写一个程序，对每个数据集执行以下步骤：\n\n- 通过非加权非线性最小二乘法拟合 $\\psi_{50}$（单位为 MPa）和 $S$（单位为 $\\text{MPa}^{-1}$），最小化观测到的 $ PLC $ 值（介于 $ 0 $ 和 $ 1 $ 之间的小数）与在测量的 $ \\psi $ 值处评估的模型 $ p(\\psi) $ 之间的残差平方和。\n- 使用参数化自举法 (parametric bootstrap) 计算 $ \\psi_{50} $ 和 $ S $ 的双侧 $ 0.95 $ 置信区间，该方法需遵循拟合模型下导管的二项式抽样：对于每次自举法重复，对于在水势 $ \\psi_i $ 处有 $ N_i $ 个导管的每次测量，生成 $ K_i \\sim \\mathrm{Binomial}(N_i, p(\\psi_i;\\widehat{\\psi}_{50},\\widehat{S})) $，设置自举法 $ PLC_i^\\ast = K_i / N_i $，将模型重新拟合到 $ \\{(\\psi_i, PLC_i^\\ast)\\} $，并收集自举法参数估计值。使用所有自举法重复的经验性 $ 0.025 $ 和 $ 0.975 $ 分位数分别作为置信区间的下限和上限。\n- 为了确保可复现性，请使用恰好 $ 300 $ 次自举法重复和一个固定的伪随机数种子 $ 12345 $。\n\n对于每个数据集，报告一个包含 $ 6 $ 个浮点数的列表，这些浮点数需四舍五入到 $ 3 $ 位小数，并按 $ [ \\widehat{\\psi}_{50}, \\widehat{S}, L_{\\psi_{50}}, U_{\\psi_{50}}, L_{S}, U_{S} ] $ 的顺序排列，其中 $ L_{\\cdot} $ 和 $ U_{\\cdot} $ 表示置信区间的下限和上限。\n\n物理单位：$\\psi_{50}$ 以 MPa 为单位，$S$ 以 $\\text{MPa}^{-1}$ 为单位。$ PLC $ 值为无量纲小数。所有数值输出必须四舍五入到 $ 3 $ 位小数。\n\n数据集（每个数据集提供水势向量 $ \\{\\psi_i\\} $（单位为 MPa）、观测到的 $ PLC $ 值 $ \\{PLC_i\\} $（为小数）以及导管数量 $ \\{N_i\\} $（为整数））：\n\n- 数据集 A:\n    - $ \\{\\psi_i\\} = [0.0, -0.5, -1.0, -1.5, -2.0, -2.5, -3.0] $\n    - $ \\{PLC_i\\} = [0.020, 0.050, 0.190, 0.490, 0.820, 0.950, 0.990] $\n    - $ \\{N_i\\} = [100, 100, 100, 100, 100, 100, 100] $\n- 数据集 B:\n    - $ \\{\\psi_i\\} = [-0.5, -1.5, -2.0, -2.5, -3.5, -4.0] $\n    - $ \\{PLC_i\\} = [0.100, 0.300, 0.550, 0.700, 0.900, 0.950] $\n    - $ \\{N_i\\} = [20, 20, 20, 20, 20, 20] $\n- 数据集 C:\n    - $ \\{\\psi_i\\} = [-0.8, -1.0, -1.1, -1.2, -1.3, -1.4, -1.6] $\n    - $ \\{PLC_i\\} = [0.040, 0.170, 0.310, 0.500, 0.690, 0.830, 0.960] $\n    - $ \\{N_i\\} = [200, 200, 200, 200, 200, 200, 200] $\n\n最终输出格式：你的程序应生成单行输出，其中包含一个由三个列表组成的列表，每个子列表对应一个数据集，并包含上述 $ 6 $ 个值（四舍五入到 $ 3 $ 位小数并按指定顺序排列），例如 $ [[\\cdots],[\\cdots],[\\cdots]] $。", "solution": "该问题是有效的。这是一个在定量植物生物学领域中定义明确、有科学依据的问题，需要标准的统计建模和计算技术。所有必要的数据和程序细节都已提供，且问题没有事实错误、矛盾或含糊之处。我将着手解决。\n\n目标是分析三个数据集的木质部脆弱性曲线。这包括将逻辑斯谛模型拟合到电导率损失百分比 (PLC) 与水势 ($\\psi$) 的数据上，然后使用参数化自举法计算模型参数的置信区间。\n\n对于每个数据集，方法论上的步骤包括三个主要部分：\n1.  通过非线性最小二乘法进行参数估计。\n2.  使用参数化自举法进行不确定性量化。\n3.  按规定格式化并呈现结果。\n\n**1. 木质部脆弱性的逻辑斯谛模型**\n\n内聚力-张力理论描述了木质部导管中的负压（张力）如何将水从根部拉到叶片。足够高的张力会导致气穴现象 (cavitation)，即空气被吸入导管（气体注入），从而导致栓塞，阻碍水流。木质部对这一现象的脆弱性由脆弱性曲线来表征，该曲线绘制了电导率损失百分比 (PLC) 与水势 ($\\psi$) 的关系。\n\n问题提供了一个逻辑斯谛模型，用于描述在给定水势 $\\psi$ 下单个导管发生栓塞的概率 $p(\\psi)$：\n$$\np(\\psi) = \\frac{1}{1 + \\exp\\left( S(\\psi - \\psi_{50}) \\right)}\n$$\n这个方程描述了一种 S 型关系，这在阈值现象中很常见。其参数为：\n- $\\psi_{50}$：当 $50\\%$ 的导管发生栓塞时的水势（单位为 MPa），即 $PLC = 0.5$。该参数表示木质部对栓塞的总体抗性。\n- $S$：一个陡度参数（单位为 MPa$^{-1}$），它决定了在 $\\psi_{50}$ 附近 PLC 随水势变化的速率。较大的 $S$ 值意味着导管在很窄的水势范围内更同步地发生栓塞。\n\n在给定 $\\psi$ 下测得的 $PLC$ 被视为基于导管样本的概率 $p(\\psi)$ 的经验估计值。\n\n**2. 通过非线性最小二乘法进行参数估计**\n\n第一个任务是找到参数值（记作 $\\widehat{\\psi}_{50}$ 和 $\\widehat{S}$），以使模型 $p(\\psi)$ 对观测数据 $\\{(\\psi_i, PLC_i)\\}$ 达到最佳拟合。“最佳拟合”的定义是最小化残差平方和 (SSR)，这是一种称为非加权非线性最小二乘法的方法。需要最小化的目标函数是：\n$$\nSSR(\\psi_{50}, S) = \\sum_{i} \\left( PLC_i - p(\\psi_i; \\psi_{50}, S) \\right)^2\n$$\n这个最小化问题通过数值方法求解。我们利用 `scipy.optimize` 库中的 `curve_fit` 函数，该函数正是为此目的设计的。它采用一种迭代算法 (Levenberg-Marquardt) 来寻找最小化 SSR 的参数值。为确保结果具有科学意义并帮助收敛，我们将陡度参数 $S$ 约束为非负 ($S \\geq 0$) 并为两个参数提供合理的初始猜测值。\n\n**3. 通过参数化自举法估计置信区间**\n\n$\\widehat{\\psi}_{50}$ 和 $\\widehat{S}$ 的值是点估计值，并且会受到源于栓塞的随机性和测量抽样的不确定性的影响。为了量化这种不确定性，我们执行参数化自举法。这种重抽样方法基于已拟合的模型生成合成数据集，以模拟我们若重复实验多次所期望看到的变异性。\n\n该过程总共进行 $B=300$ 次自举法重复，并使用固定的伪随机数种子 $12345$ 以保证可复现性，具体步骤如下：\n1.  **生成合成数据集**：对于每个测量的水势 $\\psi_i$，我们有观测到的导管数量 $N_i$。单个导管在此水势下栓塞的概率由我们拟合的模型估计得出，即 $\\hat{p}_i = p(\\psi_i; \\widehat{\\psi}_{50}, \\widehat{S})$。我们通过从二项分布中抽取一个随机数 $K_i^*$ 来模拟栓塞导管的计数过程：\n    $$\n    K_i^* \\sim \\mathrm{Binomial}(N_i, \\hat{p}_i)\n    $$\n    这一步正确地模拟了从有限计数中估计比例 ($PLC$) 时固有的二项式抽样误差。\n2.  **计算合成 PLC**：接着，自举法 PLC 值为 $PLC_i^* = K_i^* / N_i$。集合 $\\{(\\psi_i, PLC_i^*)\\}$ 构成一个合成数据集。\n3.  **重新拟合模型**：使用相同的非线性最小二乘法程序，将逻辑斯谛模型重新拟合到这个新的合成数据集上，从而得到一组自举法参数估计值 $(\\psi_{50}^*, S^*)$。\n4.  **收集自举法估计值**：这个过程重复 $300$ 次，产生两个各包含 $300$ 个自举法估计值的分布，一个用于 $\\psi_{50}$，另一个用于 $S$。\n\n这些分布经验性地近似了估计量 $\\widehat{\\psi}_{50}$ 和 $\\widehat{S}$ 的抽样分布。每个参数的双侧 $0.95$ 置信区间是通过找到其对应自举法分布的 $0.025$ 和 $0.975$ 分位数来确定的。例如，$\\psi_{50}$ 置信区间的下限 $L_{\\psi_{50}}$ 和上限 $U_{\\psi_{50}}$ 分别是所收集的 $\\psi_{50}^*$ 值的第 $2.5$ 和第 $97.5$ 百分位数。\n\n**4. 最终实现与输出**\n\n该算法在一个 Python 脚本中实现。对于三个数据集中的每一个，该脚本首先计算点估计值 $(\\widehat{\\psi}_{50}, \\widehat{S})$，然后运行参数化自举法以找到置信区间 $(L_{\\psi_{50}}, U_{\\psi_{50}})$ 和 $(L_{S}, U_{S})$。然后将所有六个值四舍五入到三位小数并收集到一个列表中。最终输出是一个包含这三个结果列表的列表，并按指定格式进行格式化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Main function to solve the xylem vulnerability curve fitting problem for all datasets.\n    \"\"\"\n\n    def logistic_model(psi, psi50, S):\n        \"\"\"\n        Logistic model for Percent Loss of Conductivity (PLC).\n        psi: Water potential (MPa)\n        psi50: Water potential at 50% PLC (MPa)\n        S: Steepness parameter (MPa^-1)\n        \"\"\"\n        return 1.0 / (1.0 + np.exp(S * (psi - psi50)))\n\n    def solve_for_dataset(psi_vals, plc_vals, n_conduits):\n        \"\"\"\n        Performs the full analysis for a single dataset:\n        1. Fits the model using unweighted nonlinear least squares.\n        2. Performs a parametric bootstrap to find 95% confidence intervals.\n        \"\"\"\n        # 1. Initial Fit\n        # Provide a reasonable initial guess for the parameters.\n        # Guess for psi50: psi value where PLC is closest to 0.5.\n        psi50_guess = psi_vals[np.argmin(np.abs(plc_vals - 0.5))]\n        # A generic guess for the steepness S.\n        S_guess = 3.0\n        initial_guesses = [psi50_guess, S_guess]\n        \n        # Set bounds for S to be non-negative, as required by the model's interpretation.\n        param_bounds = ([-np.inf, 0], [np.inf, np.inf])\n        \n        # Use curve_fit for unweighted nonlinear least squares.\n        popt, _ = curve_fit(\n            f=logistic_model,\n            xdata=psi_vals,\n            ydata=plc_vals,\n            p0=initial_guesses,\n            bounds=param_bounds\n        )\n        psi50_hat, S_hat = popt\n\n        # 2. Parametric Bootstrap\n        NUM_REPLICATES = 300\n        RANDOM_SEED = 12345\n        rng = np.random.default_rng(RANDOM_SEED)\n        \n        bootstrap_params = []\n        \n        # Pre-calculate model probabilities using the initial fit\n        p_hat_at_psi = logistic_model(psi_vals, psi50_hat, S_hat)\n        \n        # Use the initial fit parameters as the starting point for bootstrap fits to aid convergence.\n        bootstrap_p0 = [psi50_hat, S_hat]\n\n        for _ in range(NUM_REPLICATES):\n            # Generate a bootstrap sample of PLC values.\n            # This simulates the binomial sampling process of counting embolized conduits.\n            p_hat_clipped = np.clip(p_hat_at_psi, 0, 1) # Ensure probabilities are valid for binomial.\n            num_embolized_conduits = rng.binomial(n=n_conduits, p=p_hat_clipped)\n            plc_bootstrap = num_embolized_conduits / n_conduits\n            \n            try:\n                # Fit the model to the bootstrap data.\n                popt_star, _ = curve_fit(\n                    f=logistic_model,\n                    xdata=psi_vals,\n                    ydata=plc_bootstrap,\n                    p0=bootstrap_p0,\n                    bounds=param_bounds\n                )\n                bootstrap_params.append(popt_star)\n            except RuntimeError:\n                # If optimization fails to converge for a bootstrap sample, skip it.\n                # This is unlikely with the given datasets and stable initial guesses.\n                pass\n\n        # 3. Calculate Confidence Intervals\n        bootstrap_params = np.array(bootstrap_params)\n        psi50_bootstrap_dist = bootstrap_params[:, 0]\n        S_bootstrap_dist = bootstrap_params[:, 1]\n        \n        # Use the percentile method to find the 95% confidence intervals.\n        L_psi50, U_psi50 = np.quantile(psi50_bootstrap_dist, [0.025, 0.975])\n        L_S, U_S       = np.quantile(S_bootstrap_dist, [0.025, 0.975])\n        \n        # 4. Format results\n        # Order: [psi50_hat, S_hat, L_psi50, U_psi50, L_S, U_S]\n        results_list = [psi50_hat, S_hat, L_psi50, U_psi50, L_S, U_S]\n        \n        # Round to 3 decimal places as required.\n        return [round(x, 3) for x in results_list]\n\n    # Define the three datasets from the problem statement.\n    datasets = [\n        # Dataset A\n        {\n            \"psi\": np.array([0.0, -0.5, -1.0, -1.5, -2.0, -2.5, -3.0]),\n            \"plc\": np.array([0.020, 0.050, 0.190, 0.490, 0.820, 0.950, 0.990]),\n            \"N\": np.full(7, 100)\n        },\n        # Dataset B\n        {\n            \"psi\": np.array([-0.5, -1.5, -2.0, -2.5, -3.5, -4.0]),\n            \"plc\": np.array([0.100, 0.300, 0.550, 0.700, 0.900, 0.950]),\n            \"N\": np.full(6, 20)\n        },\n        # Dataset C\n        {\n            \"psi\": np.array([-0.8, -1.0, -1.1, -1.2, -1.3, -1.4, -1.6]),\n            \"plc\": np.array([0.040, 0.170, 0.310, 0.500, 0.690, 0.830, 0.960]),\n            \"N\": np.full(7, 200)\n        }\n    ]\n    \n    all_results = []\n    for data in datasets:\n        result = solve_for_dataset(data[\"psi\"], data[\"plc\"], data[\"N\"])\n        all_results.append(result)\n\n    # Print the final result in the specified format: [[...],[...],[...]]\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2849211"}]}