{"hands_on_practices": [{"introduction": "生态系统从干扰中恢复的能力，即恢复力，是其动态学的一个核心特征。为了对恢复力进行比较和预测，我们需要可量化的指标。这个练习将引导你通过一个基本的一阶微分方程来模拟干扰后的恢复过程，并推导出恢复半衰期这一关键指标，它简洁地描述了生态系统恢复到其先前状态一半所需的时间。[@problem_id:2794126]", "problem": "一个温带草原在其干扰体系中会经历周期性的斑块级火灾。火灾发生后，群落的地上生物量会偏离其干扰前的平衡状态，其偏差量为 $D(t)$（以$\\mathrm{g}\\,\\mathrm{m}^{-2}$为单位的绝对偏差），其中 $t$ 是以年为单位的时间。生态监测表明，恢复过程可以通过一阶线性弛豫很好地近似，即偏差的瞬时变化率与当前偏差成正比：$\\frac{dD}{dt}=-rD$，其中 $r$ 是一个恒定的恢复速率。假设长期调查估计该草原的 $r=0.15\\,\\mathrm{yr}^{-1}$，并且在 $t=0$ 时偏差为 $D(0)=D_{0}$。\n\n将偏差半衰期 $t_{1/2}$ 定义为偏差从 $D_{0}$ 减少到 $D_{0}/2$ 所需的时间。仅从微分方程 $\\frac{dD}{dt}=-rD$ 和初始条件 $D(0)=D_{0}$ 出发，推导出 $t_{1/2}$ 关于 $r$ 的表达式，然后计算当 $r=0.15\\,\\mathrm{yr}^{-1}$ 时的数值。将您的答案四舍五入到三位有效数字，并以年为单位表示。\n\n用一两句话陈述在此背景下半衰期 $t_{1/2}$ 的生态学意义（解释部分无需计算；但仍需提供最终数值答案）。", "solution": "问题陈述经评估确定为有效。其科学依据是既有的生态学干扰与恢复原则，并被构建为一个适定初值问题，使用了标准的一阶线性微分方程。变量和参数定义清晰，前提条件一致且足以推导出唯一解。因此，我们可以进行形式推导和计算。\n\n该问题描述了群落生物量在干扰后的恢复过程。与平衡状态的偏差 $D(t)$ 遵循以下微分方程：\n$$\n\\frac{dD}{dt} = -rD\n$$\n这是一个一阶、线性、齐次的常系数常微分方程。初始条件为 $D(t=0) = D_0$。\n\n为了解此方程，我们使用分离变量法。我们重新整理方程，将包含 $D$ 和 $t$ 的项分别置于等号两侧：\n$$\n\\frac{1}{D} dD = -r \\, dt\n$$\n接下来，我们对两边进行积分。积分从初始状态时间 $t=0$（此时偏差为 $D_0$）到任意时间 $t$（此时偏差为 $D(t)$）。\n$$\n\\int_{D_0}^{D(t)} \\frac{1}{D'} dD' = \\int_{0}^{t} -r \\, dt'\n$$\n左侧积分为自然对数，右侧是对一个常数的简单积分。由于偏差 $D(t)$ 是非负的（对于有限时间 $t$，$D(t)>0$），我们可以在对数中省略绝对值符号。\n$$\n[\\ln(D')]_{D_0}^{D(t)} = [-rt']_{0}^{t}\n$$\n$$\n\\ln(D(t)) - \\ln(D_0) = -r(t) - (-r(0))\n$$\n$$\n\\ln\\left(\\frac{D(t)}{D_0}\\right) = -rt\n$$\n为了求得显式函数 $D(t)$，我们对两边取指数：\n$$\n\\frac{D(t)}{D_0} = \\exp(-rt)\n$$\n$$\nD(t) = D_0 \\exp(-rt)\n$$\n该解描述了生物量偏差随时间从其初始值 $D_0$ 开始的指数衰减过程。\n\n问题将偏差半衰期 $t_{1/2}$ 定义为偏差减小到其初始值一半所需的时间。在数学上，这意味着找到时间 $t = t_{1/2}$，使得 $D(t_{1/2}) = \\frac{D_0}{2}$。我们将此条件代入 $D(t)$ 的解中：\n$$\n\\frac{D_0}{2} = D_0 \\exp(-r t_{1/2})\n$$\n对于非平凡干扰（$D_0 \\ne 0$），我们可以将两边同除以 $D_0$：\n$$\n\\frac{1}{2} = \\exp(-r t_{1/2})\n$$\n为了求解 $t_{1/2}$，我们对等式两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = \\ln\\left(\\exp(-r t_{1/2})\\right)\n$$\n利用对数的性质 $\\ln(1/x) = -\\ln(x)$ 和 $\\ln(\\exp(y)) = y$，我们得到：\n$$\n-\\ln(2) = -r t_{1/2}\n$$\n求解 $t_{1/2}$，我们得到其关于恢复速率 $r$ 的通用表达式：\n$$\nt_{1/2} = \\frac{\\ln(2)}{r}\n$$\n现在，给定恢复速率的数值 $r = 0.15\\,\\mathrm{yr}^{-1}$。我们将其代入我们推导出的半衰期公式中：\n$$\nt_{1/2} = \\frac{\\ln(2)}{0.15}\n$$\n使用自然对数 $2$ 的近似值 $\\ln(2) \\approx 0.693147...$，我们可以计算 $t_{1/2}$ 的数值：\n$$\nt_{1/2} \\approx \\frac{0.693147}{0.15}\\,\\mathrm{yr} \\approx 4.62098\\,\\mathrm{yr}\n$$\n问题要求答案四舍五入到三位有效数字。因此，我们有：\n$$\nt_{1/2} \\approx 4.62\\,\\mathrm{yr}\n$$\n在此背景下，半衰期 $t_{1/2}$ 的生态学意义是，它是草原生态系统在火灾后恢复到其干扰前平衡生物量状态一半所需的特征时间。这个值可作为群落恢复力的一个量化指标，半衰期越短表明恢复速率越快。", "answer": "$$\n\\boxed{4.62}\n$$", "id": "2794126"}, {"introduction": "生态学家传统上将演替分为初级演替和次级演替，其区别在于是否存在生物遗产（如土壤或幸存的繁殖体）。然而，在现实世界中，这种区分往往是模糊的。这个练习挑战你超越简单的定义，通过量化比较本地幸存者的贡献与外来殖民者的贡献，来建立一个可操作的、基于机理的分类规则，从而使演替类型的判断变得严谨和可检验。[@problem_id:2794088]", "problem": "一场火山喷发用深度为 $d$ 的火山灰覆盖了温带森林景观，但一些地下的营养繁殖体（根茎、根状茎）在热脉冲中幸存下来。生态演替通常分为初级演替和次级演替：当没有生物遗产（土壤结构、有活力的繁殖体）直接驱动最早阶段时，为初级演替；当这类遗产主导初始恢复时，为次级演替。假设给定一个地点，喷发后的测量表明火山灰层深度为 $d = 20\\,\\mathrm{cm}$，有活力的根茎残余密度为 $R = 3.0\\,\\mathrm{m}^{-2}$。该地区的独立监测提供了一个估计值：已定植的再萌发个体的早季净人均增长率为 $r = 0.5\\,\\mathrm{month}^{-1}$，来自周围未燃烧区域的平均外来定居者到达通量为 $I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$。关于再萌发体穿透火山灰出苗的野外实验得出了一个特征深度尺度 $\\lambda = 10\\,\\mathrm{cm}$，超过该深度，出苗成功率随埋藏深度的增加而急剧下降。\n\n从初级演替与次级演替的核心定义（生物遗产的作用）以及本地幸存者增长与外来者迁入之间的基本种群动态平衡出发，从选项中选择最佳的阈值规则，该规则能操作性地对该地点的演替进行分类并得出分类决策。你的选择应反映火山灰埋藏与生物遗产对早期恢复的有效贡献之间的机理联系，并且在量纲上应保持一致。\n\n哪个选项最能准确说明适用于该地点的阈值规则和分类结果？\n\nA. 定义一个有效贡献遗产密度 $L(d,R) = R\\,e^{-d/\\lambda}$，当 $r\\,L(d,R) > I$ 时分类为次级演替，否则为初级演替。对于给定地点，$L \\approx 3.0\\,e^{-2}\\,\\mathrm{m}^{-2} \\approx 0.41\\,\\mathrm{m}^{-2}$，因此 $r\\,L \\approx 0.20\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} > I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$，这意味着是次级演替。\n\nB. 使用仅与深度相关的阈值：如果 $d > \\lambda$，则分类为初级演替，否则为次级演替。对于给定地点，$20\\,\\mathrm{cm} > 10\\,\\mathrm{cm}$，因此是初级演替。\n\nC. 使用仅与残余密度相关的阈值：如果 $R > I/r$，则分类为次级演替，否则为初级演替。对于给定地点，$R = 3.0\\,\\mathrm{m}^{-2} > 0.20\\,\\mathrm{m}^{-2}$，因此是次级演替。\n\nD. 定义一个有效贡献遗产密度 $L(d,R) = R\\,e^{-d/\\lambda}$，但当 $r\\,L(d,R)  I$ 时分类为次级演替，否则为初级演替。对于给定地点，$r\\,L \\approx 0.20\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} > I$，因此是初级演替。", "solution": "题干是定量生态学中的一个有效练习。它呈现了一个基于既定生态学原理——初级和次级演替、干扰和种群动态——的场景，并提供了一套自洽、一致的定义和数据。这个问题提得很好，要求从一组给定选项中选择一个具有机理性和量纲一致性的分类规则。不存在科学、逻辑或事实上的缺陷。\n\n问题的核心是确定该地点的生态演替主要是由本地幸存者（生物遗产）的再生驱动，还是由受干扰区域外部新移民的定居驱动。这需要对这两个来源的种群贡献进行定量比较。\n\n首先，让我们将来自生物遗产的贡献形式化。有活力的根茎的初始密度为 $R = 3.0\\,\\mathrm{m}^{-2}$。然而，它们对新植物群落的贡献能力因上覆深度为 $d = 20\\,\\mathrm{cm}$ 的火山灰层而减弱。问题提供了一个特征深度尺度 $\\lambda = 10\\,\\mathrm{cm}$，它控制着出苗成功率的下降。一个标准且机理上合理的、描述出苗成功率随深度变化的概率模型是指数衰减函数。成功出苗并定植的遗产的有效密度（我们记为 $L$）因此可以建模为初始密度 $R$ 乘以一个出苗成功因子：\n$$L(d,R) = R \\, e^{-d/\\lambda}$$\n这个表达式正确地捕捉了这样一个思想：随着埋藏深度 $d$ 相对于特征尺度 $\\lambda$ 的增加，成功再萌发的个体数量减少。项 $e^{-d/\\lambda}$ 是一个无量纲的概率。因此，$L$ 的单位是密度，$\\mathrm{m}^{-2}$。\n\n一旦定植，这些幸存的个体会对种群增长做出贡献。净人均增长率给定为 $r = 0.5\\,\\mathrm{month}^{-1}$。来自这些遗产的总种群增长率是它们的有效密度与其人均增长率的乘积：\n$$ \\text{Rate from Legacies} = r \\cdot L(d,R) = r R e^{-d/\\lambda} $$\n这个量的量纲是 $(\\mathrm{month}^{-1}) \\cdot (\\mathrm{m}^{-2}) = \\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$，表示单位面积单位时间内新增个体的通量。\n\n接下来，我们考虑来自地点外部的新定居者的贡献。这直接由外来定居者到达通量给出，$I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$。这个量与来自遗产的增长率具有相同的量纲，从而可以进行直接且有意义的比较。\n\n演替的分类取决于这两个速率中哪一个占主导地位。根据问题的定义，当生物遗产“主导初始恢复”时，演替是次级的。这转化为来自遗产的增长速率大于来自移民的增长速率的条件。相反，如果移民是新增个体的主要来源，则该过程更接近初级演替。\n因此，正确的阈值规则是：\n- **次级演替**，如果：$r R e^{-d/\\lambda} > I$\n- **初级演替**，如果：$r R e^{-d/\\lambda} \\le I$\n\n现在我们使用提供的数据应用此规则：\n- $d = 20\\,\\mathrm{cm}$\n- $R = 3.0\\,\\mathrm{m}^{-2}$\n- $r = 0.5\\,\\mathrm{month}^{-1}$\n- $I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$\n- $\\lambda = 10\\,\\mathrm{cm}$\n\n首先，我们计算遗产的有效密度 $L$：\n$$ L = (3.0\\,\\mathrm{m}^{-2}) \\cdot e^{-(20\\,\\mathrm{cm})/(10\\,\\mathrm{cm})} = 3.0 \\, e^{-2} \\,\\mathrm{m}^{-2} $$\n使用值 $e \\approx 2.71828$，我们得到 $e^2 \\approx 7.389$。\n$$ L \\approx \\frac{3.0}{7.389} \\,\\mathrm{m}^{-2} \\approx 0.4060\\,\\mathrm{m}^{-2} $$\n\n接下来，我们计算遗产贡献率：\n$$ rL \\approx (0.5\\,\\mathrm{month}^{-1}) \\cdot (0.4060\\,\\mathrm{m}^{-2}) \\approx 0.203\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} $$\n\n最后，我们将此速率与移民通量 $I$ 进行比较：\n$$ rL \\approx 0.203\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} > I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} $$\n由于来自遗产的贡献大于来自移民的贡献，该过程被分类为**次级演替**。\n\n现在我们评估每个选项：\n\n**A.** `定义一个有效贡献遗产密度 $L(d,R) = R\\,e^{-d/\\lambda}$，当 $r\\,L(d,R) > I$ 时分类为次级演替，否则为初级演替。对于给定地点，$L \\approx 3.0\\,e^{-2}\\,\\mathrm{m}^{-2} \\approx 0.41\\,\\mathrm{m}^{-2}$，因此 $r\\,L \\approx 0.20\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} > I = 0.10\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$，这意味着是次级演替。`\n此选项正确地确定了有效遗产密度的机理模型 $L(d,R) = R\\,e^{-d/\\lambda}$。它为将演替分类为次级演替制定了正确的速率比较 $rL > I$。计算是准确的：$L(d,R) = 3.0e^{-2}\\,\\mathrm{m}^{-2} \\approx 0.41\\,\\mathrm{m}^{-2}$，并且 $rL \\approx 0.5 \\times 0.41 = 0.205\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1}$（选项中使用了 $0.20$，这是一个合理的四舍五入）。比较 $0.20 > 0.10$ 是正确的，得出的次级演替分类也是正确的。\n**结论：正确。**\n\n**B.** `使用仅与深度相关的阈值：如果 $d > \\lambda$，则分类为初级演替，否则为次级演替。对于给定地点，$20\\,\\mathrm{cm} > 10\\,\\mathrm{cm}$，因此是初级演替。`\n这个规则过于简单，不符合机理性的要求。它忽略了遗产密度 $R$、其增长率 $r$ 和迁入率 $I$。演替取决于种群动态力量的*平衡*，而不是单个物理参数。例如，即使 $d > \\lambda$，一个非常大的 $R$ 也可能导致次级演替。这个规则是一个任意的启发式方法。\n**结论：不正确。**\n\n**C.** `使用仅与残余密度相关的阈值：如果 $R > I/r$，则分类为次级演替，否则为初级演替。对于给定地点，$R = 3.0\\,\\mathrm{m}^{-2} > 0.20\\,\\mathrm{m}^{-2}$，因此是次级演替。`\n这个规则等价于 $rR > I$，正确地比较了潜在的遗产贡献与移民通量，但没有考虑因火山灰埋藏深度 $d$ 导致的死亡或出苗失败。它实际上假设 $d=0$ 或深度没有影响，这与问题的前提相矛盾。这里缺少了与埋藏深度的机理联系。\n**结论：不正确。**\n\n**D.** `定义一个有效贡献遗产密度 $L(d,R) = R\\,e^{-d/\\lambda}$，但当 $r\\,L(d,R)  I$ 时分类为次级演替，否则为初级演替。对于给定地点，$r\\,L \\approx 0.20\\,\\mathrm{m}^{-2}\\,\\mathrm{month}^{-1} > I$，因此是初级演替。`\n该选项使用了正确的遗产贡献率表达式，但应用了颠倒的分类逻辑条件。次级演替发生在生物遗产*占主导地位*时，意味着它们的贡献率*大于*移民的贡献率 ($rL > I$)。该选项的规则 $rL  I$ 将次级演替定义为遗产*不占主导地位*的情况，这与生态学定义直接矛盾。其初级演替的最终结论是应用这种错误逻辑的结果。\n**结论：不正确。**\n\n基于此分析，选项A是唯一一个提供了机理上合理、计算正确并得出正确结论的选项。", "answer": "$$\\boxed{A}$$", "id": "2794088"}, {"introduction": "生态理论的一个终极目标是预测群落如何随时间演变。这个练习提供了一个将理论付诸实践的计算框架，要求你构建一个动态模型来模拟演替轨迹。通过将经典的Lotka-Volterra竞争模型与离散的干扰事件相结合，你将能预测物种丰度的变化，并使用布雷-柯蒂斯相异度等指标将模型预测与（假设的）观测数据进行验证，这是现代生态学研究中的一项核心技能。[@problem_id:2794128]", "problem": "考虑一个物种集合，它们在均匀生境中进行演替，其种群动态受两两资源竞争的支配。假设以下基本和建模前提：(i) 在没有其他物种的情况下，每个物种的单位个体增长遵循逻辑斯谛增长；(ii) 种间竞争是可加的，并通过实验估算的参数化两两竞争系数来捕捉；(iii) 外部干扰在指定时间发生，并立即通过物种特异性存活分数降低种群密度；(iv) 没有迁入。密度为 $N_i(t)$ 的物种 $i$ 的连续时间动态，假设其形式为源自逻辑斯谛增长和两两相加效应的 Lotka–Volterra 竞争模型：\n$$\n\\frac{dN_i}{dt} \\;=\\; r_i \\, N_i \\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j}{K_i}\\Bigg),\n$$\n其中 $S$ 是物种数量，$r_i$ 是内禀增长率，$K_i$ 是在没有竞争者时的环境承载力，而 $\\alpha_{ij}$ 是竞争系数，用于衡量物种 $j$ 对物种 $i$ 的影响，以物种 $i$ 的单位表示。假设对所有 $i$，$\\alpha_{ii} = 1$。在指定时间 $t \\in \\mathcal{D}$ 发生的干扰会立即将每个种群密度乘以其存活分数 $s_i \\in [0,1]$。\n\n您的任务是编写一个程序，在给定参数化的两两竞争系数和其他种群参数的情况下，预测群落组成随时间的变化，并使用 Bray–Curtis 相异度对照观测到的演替轨迹进行验证。对于同一时间的组成向量 $\\mathbf{p}$ 和观测到的组成向量 $\\mathbf{q}$，Bray–Curtis 相异度为\n$$\n\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) \\;=\\; \\frac{\\sum_{i=1}^{S} |p_i - q_i|}{\\sum_{i=1}^{S} (p_i + q_i)}.\n$$\n由于 $\\mathbf{p}$ 和 $\\mathbf{q}$ 都是相对丰度，其总和为 $1$，因此分母等于 $2$，于是 $\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) = \\tfrac{1}{2}\\sum_{i=1}^{S} |p_i - q_i|$。\n\n数值预测要求：实现一个前向欧拉显式时间离散化方法，使用固定的时间步长 $\\Delta t$（单位：年）来对连续时间动态进行积分。在从时间 $t$ 到 $t + \\Delta t$ 的每一步中，\n$$\nN_i(t+\\Delta t) \\;=\\; N_i(t) \\;+\\; \\Delta t \\; r_i \\, N_i(t)\\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j(t)}{K_i}\\Bigg).\n$$\n更新到时间 $t+\\Delta t$ 后，通过将任何负值 $N_i$ 设为 $0$ 来强制实施非负性。如果 $t+\\Delta t$ 与观测时间 $\\tau \\in \\mathcal{T}_{\\mathrm{obs}}$ 重合，则记录相对丰度向量 $\\mathbf{p}(\\tau)$，其条目为 $p_i(\\tau) = N_i(\\tau) / \\sum_{k=1}^{S} N_k(\\tau)$。如果 $t+\\Delta t$ 与干扰时间 $\\mathcal{D}$ 中的某个时间重合，则在同一时间记录完观测数据（如果有）后，立即通过将 $N_i(\\tau)$ 乘以存活分数 $s_i$ 来施加干扰。这为观测时间和干扰时间重合的情况定义了一致的顺序：在施加干扰前立即记录群落组成。\n\n验证要求：对于每个测试用例，计算所有观测时间的 Bray–Curtis 相异度，并将这些相异度的算术平均值作为单个浮点数（无量纲）返回。您的程序必须生成单行输出，其中包含所有测试用例的结果。结果是一个由逗号分隔的平均相异度列表，并用方括号括起来（例如，“[0.123456,0.234567,0.345678]”）。将每个值四舍五入到恰好六位小数。所有密度的单位均为个体/平方米（ind m$^{-2}$），时间单位为年。输出指标是无量纲的。\n\n测试套件：使用以下三个测试用例。在每个用例中，$S = 3$，时间步长 $\\Delta t = 0.01$ 年，所有观测时间和干扰时间都以年为单位表示。\n\n- 测试用例 A（中等种间竞争；轻度干扰下出现演替后期优势）：\n  - 参数：\n    - 内禀增长率 $r = (1.20, 0.80, 0.50)$ yr$^{-1}$。\n    - 环境承载力 $K = (100.0, 120.0, 150.0)$ ind m$^{-2}$。\n    - 竞争矩阵 $\\alpha$ 各行为\n      - 行 1：$(1.00, 0.60, 0.90)$，\n      - 行 2：$(0.70, 1.00, 0.80)$，\n      - 行 3：$(0.20, 0.30, 1.00)$。\n    - 初始密度 $N_0 = (5.00, 1.00, 0.10)$ ind m$^{-2}$。\n    - 干扰时间 $\\mathcal{D} = \\{5.00, 15.00, 30.00\\}$，存活分数统一为 $s = (0.50, 0.50, 0.50)$。\n    - 观测时间 $\\mathcal{T}_{\\mathrm{obs}} = \\{1.00, 5.00, 10.00, 20.00, 40.00\\}$；模拟至 $T_{\\max} = 40.00$ 年。\n  - 各观测时间的观测演替组成（行按 $1.00, 5.00, 10.00, 20.00, 40.00$ 的顺序对应各时间）：\n    - $(0.70, 0.25, 0.05)$,\n    - $(0.60, 0.30, 0.10)$,\n    - $(0.40, 0.35, 0.25)$,\n    - $(0.20, 0.30, 0.50)$,\n    - $(0.10, 0.20, 0.70)$。\n\n- 测试用例 B（中性边界；对称竞争与频繁强干扰；组成保持在初始比例附近）：\n  - 参数：\n    - 内禀增长率 $r = (0.80, 0.80, 0.80)$ yr$^{-1}$。\n    - 环境承载力 $K = (100.00, 100.00, 100.00)$ ind m$^{-2}$。\n    - 竞争矩阵 $\\alpha$ 各行为\n      - 行 1：$(1.00, 1.00, 1.00)$，\n      - 行 2：$(1.00, 1.00, 1.00)$，\n      - 行 3：$(1.00, 1.00, 1.00)$。\n    - 初始密度 $N_0 = (30.00, 30.00, 40.00)$ ind m$^{-2}$。\n    - 干扰时间 $\\mathcal{D} = \\{2.00, 4.00, 6.00, 8.00, 10.00, 12.00, 14.00, 16.00\\}$，存活分数统一为 $s = (0.10, 0.10, 0.10)$。\n    - 观测时间 $\\mathcal{T}_{\\mathrm{obs}} = \\{1.00, 2.00, 4.00, 8.00, 16.00\\}$；模拟至 $T_{\\max} = 16.00$ 年。\n  - 各观测时间的观测演替组成（行按 $1.00, 2.00, 4.00, 8.00, 16.00$ 的顺序对应各时间）：\n    - $(0.30, 0.30, 0.40)$,\n    - $(0.31, 0.29, 0.40)$,\n    - $(0.29, 0.31, 0.40)$,\n    - $(0.30, 0.30, 0.40)$,\n    - $(0.30, 0.30, 0.40)$。\n\n- 测试用例 C（竞争优势物种的非对称强排斥；干扰差异性地削弱了优势物种，但长期优势依然出现）：\n  - 参数：\n    - 内禀增长率 $r = (1.00, 0.70, 0.60)$ yr$^{-1}$。\n    - 环境承载力 $K = (80.00, 200.00, 120.00)$ ind m$^{-2}$。\n    - 竞争矩阵 $\\alpha$ 各行为\n      - 行 1：$(1.00, 1.20, 0.90)$，\n      - 行 2：$(0.40, 1.00, 0.50)$，\n      - 行 3：$(0.80, 1.10, 1.00)$。\n    - 初始密度 $N_0 = (2.00, 0.50, 0.50)$ ind m$^{-2}$。\n    - 干扰时间 $\\mathcal{D} = \\{8.00, 20.00\\}$，存活分数为 $s = (0.60, 0.30, 0.60)$。\n    - 观测时间 $\\mathcal{T}_{\\mathrm{obs}} = \\{2.00, 8.00, 12.00, 24.00, 36.00\\}$；模拟至 $T_{\\max} = 36.00$ 年。\n  - 各观测时间的观测演替组成（行按 $2.00, 8.00, 12.00, 24.00, 36.00$ 的顺序对应各时间）：\n    - $(0.60, 0.25, 0.15)$,\n    - $(0.55, 0.20, 0.25)$,\n    - $(0.40, 0.40, 0.20)$,\n    - $(0.20, 0.60, 0.20)$,\n    - $(0.10, 0.75, 0.15)$。\n\n实现细节和输出规范：\n- 使用上述指定的前向欧拉更新，时间步长 $\\Delta t = 0.01$ 年。\n- 在任何同时是观测时间和干扰时间的时间点，应在施加干扰前立即记录组成。\n- 对于每个测试用例，计算所有观测时间的 Bray–Curtis 相异度的平均值。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[0.123456,0.234567,0.345678]”），每个值都四舍五入到恰好六位小数。", "solution": "所述问题定义明确、科学上合理且内部一致。它提出了计算生态学中的一个标准任务：对受离散干扰事件影响的多物种 Lotka-Volterra 竞争模型进行数值模拟，并随后根据一组提供的观测数据来验证模型输出。因此，我们可以直接着手构建解决方案。\n\n问题的核心是求解控制 $S$ 个竞争物种的种群动态的耦合非线性常微分方程组。对于每个物种 $i$，其密度 $N_i$ 的变化率由下式给出：\n$$\n\\frac{dN_i}{dt} \\;=\\; r_i \\, N_i \\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j}{K_i}\\Bigg)\n$$\n其中 $r_i$ 是内禀增长率，$K_i$ 是环境承载力，矩阵 $\\alpha$ 包含竞争系数 $\\alpha_{ij}$，并且种内竞争系数定义为 $\\alpha_{ii} = 1$。\n\n该系统的解析解通常是难以求得的，因此需要采用数值方法。问题指定使用前向欧拉法，这是一种显式一阶积分方案。使用固定的时间步长 $\\Delta t$，种群密度向量 $\\mathbf{N}(t) = (N_1(t), \\dots, N_S(t))^\\top$ 根据以下迭代公式从时间 $t$ 传播到 $t + \\Delta t$：\n$$\nN_i(t+\\Delta t) \\;=\\; N_i(t) \\;+\\; \\Delta t \\; r_i \\, N_i(t)\\,\\Bigg(1 - \\frac{\\sum_{j=1}^{S} \\alpha_{ij} \\, N_j(t)}{K_i}\\Bigg)\n$$\n对所有物种 $i=1, \\dots, S$ 执行此更新。一个反映生物学现实的关键步骤是强制执行非负约束：如果任何 $N_i(t+\\Delta t)$ 计算为负值，则立即将其设置为 $0$。\n\n连续的动态过程被离散事件（观测和干扰）所中断。一个鲁棒的数值实现必须在其精确的预定时间处理这些事件。比较时间的浮点数表示容易出错。正确而严谨的程序是将整个模拟时间轴离散化，方法是将所有事件时间转换为整数时间步索引。对于最大模拟时间 $T_{\\max}$ 和时间步长 $\\Delta t$，模拟将总共运行 $n_{\\text{steps}} = \\text{round}(T_{\\max} / \\Delta t)$ 步。因此，安排在时间 $t_{\\text{event}}$ 的事件被映射到整数步索引 $k_{\\text{event}} = \\text{round}(t_{\\text{event}} / \\Delta t)$。\n\n模拟算法的结构是一个从步骤 $k=1$ 迭代到 $n_{\\text{steps}}$ 的循环：\n1.  **积分**：使用前向欧拉公式将种群向量 $\\mathbf{N}$ 从其在步骤 $k-1$ 的状态更新到其在步骤 $k$ 的状态。对得到的 $\\mathbf{N}$ 向量强制执行非负性。\n2.  **观测**：检查当前步索引 $k$ 是否与预定的观测步匹配。如果匹配，则根据当前的绝对密度 $\\mathbf{N}$（其中 $p_i = N_i / \\sum_j N_j$）计算预测的相对丰度向量 $\\mathbf{p}$。然后，使用 Bray-Curtis 相异度将此预测的组成 $\\mathbf{p}$ 与相应的观测组成 $\\mathbf{q}$ 进行比较。由于 $\\mathbf{p}$ 和 $\\mathbf{q}$ 都已归一化，其总和为 $1$，因此公式简化为 $\\mathrm{BC}(\\mathbf{p},\\mathbf{q}) = \\frac{1}{2}\\sum_{i=1}^{S} |p_i - q_i|$。记录得到的相异度值。\n3.  **干扰**：然后检查步 $k$ 是否与预定的干扰步匹配。如果匹配，则通过将每个物种的密度 $N_i$ 乘以其指定的存活分数 $s_i$ 来施加干扰，即 $N_i \\leftarrow N_i \\cdot s_i$。问题规定，在给定时间进行的观测发生在同一时间的干扰之前。对于给定的步索引 $k$，在循环内顺序执行步骤 (2) 和 (3) 可以正确实现此顺序。\n\n在 $T_{\\max}$ 模拟完成后，每个测试用例最终要求的输出是所有记录的 Bray-Curtis 相异度值的算术平均值。整个过程将使用 `numpy` 库来实现，以便于对种群向量和参数数组进行高效的向量化计算。该算法将被封装在一个处理单个测试用例的函数中，并且一个主驱动程序将遍历所有测试用例以生成最终格式化的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_simulation(r, K, alpha, N0, s, dist_times, obs_times, obs_data, T_max, dt):\n    \"\"\"\n    Runs the Lotka-Volterra competition simulation with disturbances for one test case.\n\n    Args:\n        r (tuple): Intrinsic rates of increase.\n        K (tuple): Carrying capacities.\n        alpha (list of lists): Competition matrix.\n        N0 (tuple): Initial densities.\n        s (tuple): Survival fractions.\n        dist_times (set): Set of disturbance times.\n        obs_times (tuple): Tuple of observation times.\n        obs_data (list of tuples): Observed compositions at observation times.\n        T_max (float): Maximum simulation time.\n        dt (float): Time step for integration.\n\n    Returns:\n        float: The mean Bray-Curtis dissimilarity over all observation times.\n    \"\"\"\n    # Convert parameters to numpy arrays for vectorized operations\n    r = np.array(r, dtype=np.float64)\n    K = np.array(K, dtype=np.float64)\n    alpha = np.array(alpha, dtype=np.float64)\n    N = np.array(N0, dtype=np.float64)\n    s_vec = np.array(s, dtype=np.float64)\n\n    # Create event maps based on integer step indices for robust time handling\n    obs_data_map = {t: np.array(q) for t, q in zip(obs_times, obs_data)}\n    obs_step_data_map = {int(round(t / dt)): q for t, q in obs_data_map.items()}\n    dist_step_map = {int(round(t / dt)): s_vec for t in dist_times}\n\n    num_steps = int(round(T_max / dt))\n    bray_curtis_dissimilarities = []\n\n    for step in range(1, num_steps + 1):\n        # Forward Euler integration step\n        # dN/dt = r*N*(1 - (alpha @ N) / K)\n        competition_term = alpha @ N\n        dN_dt = r * N * (1.0 - competition_term / K)\n        N += dt * dN_dt\n\n        # Enforce non-negativity constraint\n        N[N  0] = 0.0\n\n        # Check for observation event at the end of the current time step\n        if step in obs_step_data_map:\n            observed_q = obs_step_data_map[step]\n            \n            # Calculate predicted relative abundance, p\n            total_density = np.sum(N)\n            # Handle case where all species are extinct to avoid division by zero\n            if total_density > 1e-12:\n                predicted_p = N / total_density\n            else:\n                predicted_p = np.zeros_like(N)\n            \n            # Calculate Bray-Curtis dissimilarity: 0.5 * sum(|p_i - q_i|)\n            bc_dissimilarity = 0.5 * np.sum(np.abs(predicted_p - observed_q))\n            bray_curtis_dissimilarities.append(bc_dissimilarity)\n\n        # Check for disturbance event (occurs after observation at the same time)\n        if step in dist_step_map:\n            survival_fractions = dist_step_map[step]\n            N *= survival_fractions\n    \n    return np.mean(bray_curtis_dissimilarities) if bray_curtis_dissimilarities else 0.0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case A\n        {\n            \"r\": (1.20, 0.80, 0.50), \"K\": (100.0, 120.0, 150.0),\n            \"alpha\": [[1.00, 0.60, 0.90], [0.70, 1.00, 0.80], [0.20, 0.30, 1.00]],\n            \"N0\": (5.00, 1.00, 0.10), \"s\": (0.50, 0.50, 0.50),\n            \"dist_times\": {5.00, 15.00, 30.00},\n            \"obs_times\": (1.00, 5.00, 10.00, 20.00, 40.00),\n            \"obs_data\": [\n                (0.70, 0.25, 0.05), (0.60, 0.30, 0.10), (0.40, 0.35, 0.25),\n                (0.20, 0.30, 0.50), (0.10, 0.20, 0.70)\n            ],\n            \"T_max\": 40.00, \"dt\": 0.01\n        },\n        # Test Case B\n        {\n            \"r\": (0.80, 0.80, 0.80), \"K\": (100.00, 100.00, 100.00),\n            \"alpha\": [[1.00, 1.00, 1.00], [1.00, 1.00, 1.00], [1.00, 1.00, 1.00]],\n            \"N0\": (30.00, 30.00, 40.00), \"s\": (0.10, 0.10, 0.10),\n            \"dist_times\": {2.00, 4.00, 6.00, 8.00, 10.00, 12.00, 14.00, 16.00},\n            \"obs_times\": (1.00, 2.00, 4.00, 8.00, 16.00),\n            \"obs_data\": [\n                (0.30, 0.30, 0.40), (0.31, 0.29, 0.40), (0.29, 0.31, 0.40),\n                (0.30, 0.30, 0.40), (0.30, 0.30, 0.40)\n            ],\n            \"T_max\": 16.00, \"dt\": 0.01\n        },\n        # Test Case C\n        {\n            \"r\": (1.00, 0.70, 0.60), \"K\": (80.00, 200.00, 120.00),\n            \"alpha\": [[1.00, 1.20, 0.90], [0.40, 1.00, 0.50], [0.80, 1.10, 1.00]],\n            \"N0\": (2.00, 0.50, 0.50), \"s\": (0.60, 0.30, 0.60),\n            \"dist_times\": {8.00, 20.00},\n            \"obs_times\": (2.00, 8.00, 12.00, 24.00, 36.00),\n            \"obs_data\": [\n                (0.60, 0.25, 0.15), (0.55, 0.20, 0.25), (0.40, 0.40, 0.20),\n                (0.20, 0.60, 0.20), (0.10, 0.75, 0.15)\n            ],\n            \"T_max\": 36.00, \"dt\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        mean_bc = run_simulation(\n            r=case[\"r\"], K=case[\"K\"], alpha=case[\"alpha\"], N0=case[\"N0\"],\n            s=case[\"s\"], dist_times=case[\"dist_times\"], obs_times=case[\"obs_times\"],\n            obs_data=case[\"obs_data\"], T_max=case[\"T_max\"], dt=case[\"dt\"]\n        )\n        results.append(f\"{mean_bc:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2794128"}]}