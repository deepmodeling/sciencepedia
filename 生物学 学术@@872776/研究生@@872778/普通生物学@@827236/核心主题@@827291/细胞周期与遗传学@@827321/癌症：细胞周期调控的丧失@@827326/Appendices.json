{"hands_on_practices": [{"introduction": "细胞周期调控网络的核心是精确的蛋白质相互作用。Rb-E2F 通路是 G1/S 转换的关键“刹车”，其功能失调是癌症的标志性特征之一。本练习 [@problem_id:2781000] 要求你运用质量作用定律，从第一性原理出发，定量分析 Rb 蛋白的亲和力变化如何影响 E2F 转录因子的活性。\n\n通过这个实践，你将推导出由突变引起的 E2F 转录输出的倍数变化，从而深刻理解单个分子事件（如亲和力下降）如何通过生物化学平衡的改变，最终导致整个细胞命运决定通路的失控。这有助于将对基因调控的理解从定性的“开/关”模型，深化为更精确的、依赖于浓度的定量模型。", "problem": "在增殖的哺乳动物细胞中，Retinoblastoma蛋白 (Rb) 会结合并抑制E2 promoter-binding factor (E2F)，从而抑制由E2F驱动的转录。考虑一个单一的核池，其中结合平衡相对于转录读出而言是快速的，Rb和E2F在此池中形成可逆的一对一复合物。设Rb和E2F的总核浓度分别为$R_T$和$E_T$，并用$K_d$表示野生型相互作用的解离常数。Rb中的一个错义突变使其对E2F的亲和力降低了十倍；等效地，突变体的解离常数为$10K_d$。假设转录输出与游离（未结合）E2F的浓度成正比，并且在测量的时间尺度内没有其他调控过程发生变化。不要对$R_T$和$E_T$作任何特定的极限状态假设。\n\n仅使用质量作用平衡和质量守恒作为基本依据，推导由突变引起的E2F转录输出的倍数变化，定义为\n$$\nF \\equiv \\frac{\\text{存在突变Rb时的游离E2F}}{\\text{存在野生型Rb时的游离E2F}}。\n$$\n将你的最终答案表示为仅含$R_T$、$E_T$和$K_d$的单一闭式解析表达式。无需进行数值计算。答案是无量纲的；不要包含单位。", "solution": "解析并验证问题陈述。\n\n已知条件：\n1.  系统：单一核池，其中Retinoblastoma protein (Rb) 和 E2 promoter-binding factor (E2F) 形成可逆的一对一复合物。\n2.  平衡：结合过程 $Rb + E2F \\rightleftharpoons Rb \\cdot E2F$ 被假定处于平衡状态。\n3.  总浓度：Rb和E2F的总浓度分别表示为$R_T$和$E_T$。\n4.  解离常数：野生型的解离常数为$K_d$。Rb中的一个突变使解离常数增加十倍，变为$10K_d$。\n5.  转录输出：输出与游离（未结合）E2F的浓度成正比。\n6.  目标：推导倍数变化$F$，定义为存在突变Rb时的游离E2F与存在野生型Rb时的游离E2F之比。\n7.  约束条件：推导过程必须仅使用质量作用平衡和质量守恒。不对$R_T$和$E_T$作任何极限状态的假设。\n\n验证：\n该问题具有科学依据、提法明确且客观。它描述了一个标准的生物化学平衡模型，这是定量生物学和药理学的基石。前提条件一致，并为推导唯一解提供了足够的信息。Rb-E2F相互作用模型是细胞周期调控中一个有效且基本的概念。因此，该问题被认定为有效，并将提供解答。\n\n推导：\n我们首先基于质量作用平衡和质量守恒建立系统的控制方程。设$[R]$、$[E]$和$[C]$分别表示游离Rb、游离E2F和Rb-E2F复合物的平衡浓度。\n\n各种物质的质量守恒由以下公式给出：\n$$R_T = [R] + [C] \\quad (1)$$\n$$E_T = [E] + [C] \\quad (2)$$\n\n解离平衡的质量作用定律为：\n$$K_d = \\frac{[R][E]}{[C]} \\quad (3)$$\n\n我们的目标是找到一个用总浓度$R_T$、$E_T$和解离常数$K_d$表示$[E]$的表达式。我们可以使用方程 $(1)$ 和 $(2)$ 将$[R]$和$[C]$用$[E]$表示：\n根据方程 $(2)$，我们有：\n$$[C] = E_T - [E] \\quad (4)$$\n将方程 $(4)$ 代入方程 $(1)$：\n$$[R] = R_T - [C] = R_T - (E_T - [E]) = R_T - E_T + [E] \\quad (5)$$\n\n现在，我们将方程 $(4)$ 和 $(5)$ 代入平衡表达式，即方程 $(3)$：\n$$K_d = \\frac{(R_T - E_T + [E])[E]}{E_T - [E]}$$\n\n为了求解$[E]$，我们将此方程重排为标准的二次方程形式 $a x^2 + b x + c = 0$，其中 $x = [E]$：\n$$K_d(E_T - [E]) = (R_T - E_T)[E] + [E]^2$$\n$$K_d E_T - K_d [E] = (R_T - E_T)[E] + [E]^2$$\n$$[E]^2 + (R_T - E_T)[E] + K_d [E] - K_d E_T = 0$$\n$$[E]^2 + (R_T - E_T + K_d)[E] - K_d E_T = 0 \\quad (6)$$\n\n我们使用二次公式求解这个关于$[E]$的二次方程：\n$$[E] = \\frac{-(R_T - E_T + K_d) \\pm \\sqrt{(R_T - E_T + K_d)^2 - 4(1)(-K_d E_T)}}{2(1)}$$\n$$[E] = \\frac{-(R_T - E_T + K_d) \\pm \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}$$\n\n由于浓度必须是非负物理量，即$[E] \\ge 0$，我们必须选择正确的根。平方根下的项是严格为正的。平方根项的绝对值总是大于分子中第一项的绝对值 $|-(R_T - E_T + K_d)|$。因此，只有正号才能得到具有物理意义（正值）的浓度。\n\n设$[E]_{wt}$为野生型情况下游离E2F的浓度。其表达式为：\n$$[E]_{wt} = \\frac{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}$$\n\n对于突变体情况，分析是相同的，但解离常数变为$K_d' = 10 K_d$。我们将$[E]_{wt}$表达式中的$K_d$替换为$10 K_d$，以求得突变体的游离E2F浓度$[E]_{mut}$：\n$$[E]_{mut} = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 4(10 K_d)E_T}}{2}$$\n$$[E]_{mut} = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{2}$$\n\n问题陈述指出，转录输出与游离E2F的浓度成正比。倍数变化$F$定义为突变体输出与野生型输出之比，这可以简化为游离E2F浓度之比：\n$$F = \\frac{[E]_{mut}}{[E]_{wt}}$$\n\n代入推导出的$[E]_{mut}$和$[E]_{wt}$的表达式：\n$$F = \\frac{\\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{2}}{\\frac{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}{2}}$$\n\n分子和分母中的因子$\\frac{1}{2}$相互抵消，从而得到倍数变化$F$的最终闭式表达式：\n$$F = \\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}$$\n此表达式由给定的参数$R_T$、$E_T$和$K_d$表示，符合要求。", "answer": "$$\n\\boxed{\\frac{-(R_T - E_T + 10 K_d) + \\sqrt{(R_T - E_T + 10 K_d)^2 + 40 K_d E_T}}{-(R_T - E_T + K_d) + \\sqrt{(R_T - E_T + K_d)^2 + 4 K_d E_T}}}\n$$", "id": "2781000"}, {"introduction": "G1 期细胞必须通过一个“不归点”（即限制点），才能不可逆地进入 S 期。精确定义触发这一决定的分子阈值，是理解细胞周期调控和癌症发生机制的核心。本练习 [@problem_id:2780961] 提出了两种关于限制点调控机制的竞争性假说，并要求你设计一个能够明确区分它们的思想实验。\n\n这个实践的核心在于理解和利用不同调控蛋白（如快速降解的 Cyclin D 和缓慢恢复的 CKI 抑制剂）在动力学特性上的差异。通过评估不同实验设计的辨别能力，你将锻炼设计可证伪实验和解读动态系统行为的能力，这对于任何前沿生物学研究者来说都是一项至关重要的技能。", "problem": "一个处于$G_1$期的增殖哺乳动物细胞必须通过限制点，才能变得不依赖于促分裂原并启动DNA合成。考虑关于是什么设定了此限制点定量阈值的两种机制性假说：模型D假设，该阈值由Cyclin D与周期蛋白依赖性激酶4/6 (CDK4/6)复合物的丰度设定，因此，充足的Cyclin D积累是retinoblastoma蛋白 (Rb) 磷酸化和$E2F$活化的主要门控。模型I假设，该阈值由cyclin依赖性激酶抑制剂 (CKIs) 如$p27$和$p21$通过泛素-蛋白酶体途径（例如，S期激酶相关蛋白2 (Skp2)–Skp1–Cullin–F-box (SCF) 复合物）的主动降解设定，因此，CKI的充分移除是Rb磷酸化和$E2F$活化的主要门控。两种模型都假设存在经典的Rb–$E2F$正反馈回路和中心法则：蛋白质丰度由合成和降解调控。\n\n使用的基础事实：(i) Rb–$E2F$正反馈在$G_1$期产生一个双稳态开关，需要cyclin依赖性激酶 (CDK) 活性达到一个阈值才能实现不可逆的$E2F$活化；(ii) Cyclin D是一种不稳定的蛋白质，其丰度追踪促分裂原信号，半衰期很短，约为$20$–$30$分钟；(iii) 在进入$G_1$期时，CKIs通过靶向降解被移除，一旦降解，它们的恢复依赖于从头转录和翻译，其再合成的时间尺度通常远长于Cyclin D的衰减时间（几十到几百分钟）；(iv) 蛋白质X的变化速率可表示为$dX/dt = k_{\\mathrm{synth}} - k_{\\mathrm{deg}} X$，这意味着在合成或降解发生阶跃变化后，系统会以时间常数$\\tau \\equiv 1/k_{\\mathrm{deg}}$指数弛豫到一个新的稳态。\n\n你的任务是选择一个最佳的可证伪预测，该预测能在其他网络组分不受扰动的情况下，清晰地区分模型D和模型I。“可证伪”在此意味着，观察到相反的结果将直接排除做出该预测的模型，而无需额外的辅助性假设。\n\n以下哪个实验设计和预测结果对能够最清晰地区分这两个模型？\n\nA. 对表达荧光$E2F$报告基因和活细胞Cyclin D报告基因的血清饥餓细胞，施加两个相同的、各持续$30$分钟的亚阈值促分裂原脉冲，两次脉冲间隔$60$分钟。第一次脉冲短暂提高了Cyclin D但未引起$E2F$活化。预测：如果限制点由Cyclin D丰度设定（模型D），则两次脉冲后通过限制点的细胞比例将保持在低水平，且与单次脉冲无区别，因为Cyclin D以时间常数$\\tau_D \\approx 20$–$30$分钟衰减，并且不会在$60$分钟的间隔内整合信号。如果限制点由CKI降解设定（模型I），则第二次脉冲将比第一次更有效，因为由于再合成缓慢（$\\tau_I \\gg 60$分钟），CKI丰度在脉冲之间保持在较低水平，从而导致两次脉冲后有更高比例的细胞发生$E2F$活化。观察到第二次脉冲的选择性增强效应将证伪模型D并支持模型I。\n\nB. 在促分裂原刺激期间抑制蛋白酶体$60$分钟，并通过后期促进复合物/细胞周期体 (Anaphase Promoting Complex/Cyclosome, APC/C)–Cdh1活性报告基因来定量限制点通过情况。预测：两种模型都预测限制点通过会减少，因为全局蛋白酶体抑制阻止了Cyclin D动态变化或CKI移除所必需的蛋白质周转。观察到通过减少支持模型I并证伪模型D。\n\nC. 使用生长素诱导的降解决定子 (auxin-inducible degron)，在完全没有促分裂原的情况下急速耗盡$p27$，并在$60$分钟内测量$E2F$的活化。预测：如果CKI降解设定阈值（模型I），仅$p27$的急性缺失就将触发$E2F$活化和限制点通过；如果Cyclin D丰度设定阈值（模型D），则不会发生通过。\n\nD. 将Cyclin D过表达至内源性水平的数倍，同时通过Skp2缺失来遗传性地稳定CKIs，然后评估限制点通过情况。预测：如果Cyclin D丰度设定阈值（模型D），过表达将驱动细胞通过限制点，尽管CKIs被稳定；如果CKI降解设定阈值（模型I），通过将被阻断。", "solution": "首先将对问题陈述进行科学性和逻辑完整性验证。\n\n### 步骤1：提取已知信息\n问题提供了关于哺乳动物细胞中设定限制点通过定量阈值机制的两种相互竞争的假说。\n- **模型D (Cyclin D驱动):** 阈值由Cyclin D-CDK4/6复合物的丰度设定。Cyclin D的充分积累是主要门控。\n- **模型I (CKI驱动):** 阈值由Cyclin依赖性激酶抑制剂 (CKIs)，如$p27$和$p21$的主动降解设定。CKIs的充分移除是主要门控。\n- **共同假设:** 两种模型都包含了经典的Rb-$E2F$正反馈回路，并假设蛋白质丰度由合成和降解调控。\n\n**基础事实：**\n(i) Rb-$E2F$正反馈回路在$G_1$期建立了一个双稳态开关，需要Cyclin依赖性激酶 (CDK) 活性达到一个阈值才能实现不可逆的$E2F$活化。\n(ii) Cyclin D是一种不稳定的蛋白质，半衰期约为$20-30$分钟。其丰度密切追踪促分裂原信号。\n(iii) CKIs在进入$G_1$期时通过靶向降解被移除。它们的恢复依赖于从头合成，其时间尺度远长于Cyclin D的衰减时间（几十到几百分钟）。\n(iv) 蛋白质X的变化速率由常微分方程$dX/dt = k_{\\mathrm{synth}} - k_{\\mathrm{deg}} X$建模。这意味着在合成或降解速率发生变化后，系统会以时间常数$\\tau \\equiv 1/k_{\\mathrm{deg}}$指数弛豫到一个新的稳态。\n\n**任务：** 在假设其他网络组分未受扰动的情况下，从选项中找出能最清晰地区分模型D和模型I的唯一最佳可证伪预测。\n\n### 步骤2：使用提取的已知信息进行验证\n根据既定标准对问题进行验证。\n\n1.  **科学依据充分：** 该问题牢固地植根于已确立的分子和细胞生物学知识。关于$G_1/S$转换，Cyclin D、CDK4/6、Rb、$E2F$和CKIs ($p27$, $p21$)的作用的描述都是标准的教科书知识。这两个模型代表了在该领域历史上一直有争论的、貌似合理的竞争性假说。基础事实，特别是不同蛋白质的稳定性，是经过实验验证的原理。蛋白质动力学的数学模型是一个标准的、基础的表述。该问题在科学上是合理的。\n\n2.  **提法恰当 (Well-Posed)：** 该问题要求一个能够区分两个定义明确的模型的实验设计和结果。这是一个经典的科学推理问题结构。对于一个评估概念理解的多项选择题来说，“最佳”区分性预测的存在是一个合理的前提。该问题提法恰当。\n\n3.  **客观性：** 所使用的语言是技术性的、精确的，并且没有主观或基于意见的陈述。模型和事实都作为客观陈述呈现以供评估。\n\n4.  **缺陷分析：**\n    -   **科学/事实不健全：** 无。在细胞周期生物学的背景下，各项前提在事实上是正确的。\n    -   **不可形式化/不相关：** 该问题高度可形式化，基于蛋白质网络的动力学，并与细胞周期调控的主题直接相关。\n    -   **不完整/矛盾的设置：** 所提供的信息是充分的。模型之间的关键区别在于所提出的门控分子（Cyclin D vs. CKIs）的不同动力学特性，这一点已明确说明。没有矛盾之处。\n    -   **不切实际/不可行：** 选项中描述的实验技术（荧光报告基因、促分裂原脉冲、蛋白酶体抑制剂、生长素诱导的降解决定子、遗传修饰）是现代生物学研究中标准的、可行的工具。\n    -   **提法不当/结构不良：** 问题结构清晰。它提出了两个明确的模型，并要求一种方法来证伪其中一个相对于另一个。术语“清晰地区分”为评估选项提供了明确的标准。\n    -   **伪深刻/琐碎：** 问题并非琐碎。它要求理解动态生物系统中不同时间尺度的含义，以及如何设计实验来探测这些差异。\n    -   **超出科学可验证性：** 问题围绕可证伪性概念展开，这是科学验证的核心。\n\n### 步骤3：结论和行动\n问题陈述有效。它具有科学依据，提法恰当，客观，并且没有列出的缺陷。将推导出一个解决方案。\n\n### 推导和选项分析\n\n核心任务是确定一个实验设置，其预测结果对于模型D和模型I是不同的。关键区别在于所提出的调控分子的时间动态。\n- **模型D：** 门控分子是Cyclin D，一种短寿命蛋白质（$\\tau_D \\approx 20-30$ 分钟）。系统对过去的促分裂原信号只有短暂的“记忆”，时间尺度约为$\\tau_D$。\n- **模型I：** 门控是CKI的水平，它通过降解而降低。由于再合成的时间尺度很长（$\\tau_I \\gg \\tau_D$），CKI恢复缓慢。系统对过去触发CKI降解的促分裂原信号有长“记忆”。\n\n我们现在将评估每个选项。\n\n**A. 施加两个相同的、各持续$30$分钟的亚阈值促分裂原脉冲，两次脉冲间隔$60$分钟……**\n\n- **分析：** 这个实验专门设计用于测试系统的记忆。$30$分钟的脉冲与Cyclin D的时间常数$\\tau_D$相当。$60$分钟的间隔明显长于$\\tau_D$，但短于所述的CKI再合成时间尺度$\\tau_I$。\n- **对模型D的预测：** 第一次脉冲提高了Cyclin D的水平，但不足以越过限制点阈值。在$60$分钟的间隔期间（大约是$\\tau_D$的$2-3$倍），Cyclin D浓度将衰减回接近其基础水平。根据提供的动力学模型，衰减遵循$C(t) = C(0)e^{-t/\\tau_D}$。在$t=60$分钟后，剩余浓度为$C(60) \\approx C(0)e^{-60/25} \\approx 0.09 C(0)$，代表衰减了超过$90\\%$。因此，第二次脉冲基本上从与第一次相同的基线开始，也将是亚阈值的。两次脉冲后通过限制点的细胞比例应与一次脉冲后相似。\n- **对模型I的预测：** 第一次脉冲刺激了导致CKI降解的信号通路。在$60$分钟的间隔内，由于再合成缓慢（$\\tau_I \\gg 60$分钟），CKI水平只会轻微恢复。因此，第二次脉冲开始时，CKI水平（一个较低的抑制屏障）比第一次脉冲时更低。这使得第二次脉冲更有效，有可能将系统的CDK活性推过阈值。与一次脉冲相比，两次脉冲后应有显著更高比例的细胞通过限制点。\n- **结论：** 两种模型的预测结果截然不同，并直接检验了它们动力学假设的核心差异。观察到两次脉冲的协同效应将证伪所呈现的模型D的简单版本。这个实验是对潜在机制的一个清晰、动态的测试。**正确**。\n\n**B. 在促分裂原刺激期间抑制蛋白酶体$60$分钟……**\n\n- **分析：** 全局蛋白酶体抑制是一种粗糙的扰动，影响包括cyclin和CKI在内的许多蛋白质的降解。\n- **对模型D的预测：** Cyclin D是一种不稳定的蛋白质，其稳态水平取决于合成和蛋白酶体降解之间的平衡。抑制蛋白酶体会阻断其降解，导致其大量积累，而不是减少。这很可能*促进*而非减少限制点通过，与选项中给出的预测相矛盾。\n- **对模型I的预测：** CKI的降解由蛋白酶体介导。抑制它会稳定CKI，使抑制屏障保持在高位，从而阻断限制点通过。这部分预测与模型一致。\n- **区分能力：** 该选项关于两种模型都预测通过减少的前提是有缺陷的。对模型D的影响陈述不正确。此外，一个同时扰动多个关键组分（同时稳定激活剂Cyclin D和抑制剂CKI）的实验不能“清晰地”区分它们的作用。净结果将取决于相互竞争效应的复杂相互作用，使得解释变得模糊不清。**错误**。\n\n**C. 使用生长素诱导的降解决定子急速耗尽$p27$，在完全没有促分裂原的情况下……**\n\n- **分析：** 这个实验测试的是，在没有主要促分裂原信号的情况下，移除CKI是否*足以*触发限制点通过。\n- **对模型D的预测：** 该模型假设Cyclin D丰度是主要门控。在没有促分裂原的情况下，Cyclin D水平非常低。尽管移除$p27$会解除对任何现有CDK4/6复合物的抑制，但 изначально就不会有太多这样的复合物。因此，预计不会发生限制点通过。这个预测是合理的。\n- **对模型I的预测：** 该模型假设CKI移除是主要门控。人为移除$p27$直接满足了这个条件。因此，预计会发生限制点通过。这个预测也是合理的。\n- **区分能力：** 预测结果是二分的，这很好。然而，这是一个“旁路”实验。它将系统强制推入一个生理上无法达到的状态。它测试了CKI移除的充分性，但没有直接测试在正常促分裂原反应期间CKI降解是否是*设定阈值的限速步骤*。模型D并未声称CKI不相关，只是说Cyclin D是主要门控。发现移除CKI足以导致通过会很有趣，但这并不能清晰地证伪模型D关于正常情况下阈值是如何设定的说法。它不如选项A清晰，选项A探测的是系统对生理刺激的自然动态响应。**错误**。\n\n**D. 将Cyclin D过表达至内源性水平的数倍，同时遗传性地稳定CKIs……**\n\n- **分析：** 这个实验在一种强的促增殖信号（Cyclin D过表達）和一种强的抗增殖阻断（CKI稳定化）之间制造了冲突。\n- **对模型D的预测：** 预测是Cyclin D过表達将驱动通过。这假设过表達的效力足以克服任何抑制。\n- **对模型I的预测：** 预测是稳定的CKI将阻断通过。这假设CKI的水平足以抑制所有过表達的Cyclin D-CDK复合物。\n- **区分能力：** 这个实验的结果不是对模型基本原理的清晰检验，而是一个关于化学计量和结合亲和力的定量问题。如果Cyclin D过表达至足够高的水平，它可能会滴定并隔离所有稳定的CKI，即使模型I的一般原理是正确的，也会导致通过。反之，如果CKI的稳定化导致非常高的CKI水平，它甚至可能抑制过表达的Cyclin D，从而阻断通过，即使Cyclin D是正常的门控分子（因为模型D不否認CKI是抑制剂）。由于结果取决于未说明的过表达和稳定化的定量水平，这个实验不能清晰地区分模型。它是一个结果模糊的受扰动系统。**错误**。\n\n**结论：**\n选项A提出了最优雅和清晰的实验设计。它巧妙利用了两个模型之间固有的、已陈述的动力学差异——即系统的记忆——并使用生理刺激。其他选项涉及强的、人为的扰动（B、C、D），这些扰动要么造成模糊性，要么测试的是充分性而非天然的阈值机制，要么基于有缺陷的前提。因此，A中的脉冲-追踪实验是进行清晰、可证伪检验的唯一最佳选择。", "answer": "$$\\boxed{A}$$", "id": "2780961"}, {"introduction": "对细胞周期调控的深刻理解为设计合理的癌症治疗策略提供了理论基础，例如将 CDK4/6 抑制剂与传统化疗药物相结合。本练习 [@problem_id:2780903] 要求你构建一个细胞周期进程和药物效应的离散时间计算模型，并利用该模型寻找能够最大化协同效应的最佳给药方案。\n\n这个动手编程实践将理论生物学与临床应用联系起来，让你亲身体验如何将 G1 期阻滞和 S 期敏感性等概念转化为一个预测性的系统药理学模型。通过解决这个优化问题，你将学会如何利用计算工具来探索和设计复杂的联合治疗策略，这体现了细胞周期基础研究在肿瘤学中的巨大转化潜力。", "problem": "考虑真核细胞周期的典型时期，其中处于 $G_{1}$、$S$ 和 $G_{2}/M$ 期的细胞群体比例，在离散时间步 $t$ 由状态向量 $x_{t} = (g_{1,t}, s_{t}, g_{2,t})$ 表示。对于所有 $t$，均有 $g_{1,t} + s_{t} + g_{2,t} = 1$。细胞周期蛋白依赖性激酶 (CDK) $4/6$ 的活性调控 $G_{1} \\rightarrow S$ 限制点。损伤脱氧核糖核酸 (DNA) 的化学疗法（化疗）倾向于优先杀死处于 $S$ 期的细胞。您需要建立一个仅使用时期分数转移和活细胞数量乘法变化的离散时间模型，然后搜索简单的给药方案，以在固定的时间范围内最小化活细胞负荷。\n\n基于经过充分验证的生物学事实的模型假设：\n- CDK $4/6$ 抑制作用在抑制剂存在期间会降低从 $G_{1} \\rightarrow S$ 的有效转移，从而模拟 $G_{1}$ 期阻滞。\n- 在解除 CDK $4/6$ 抑制后，细胞会以同步群体的方式瞬时进入 $S$ 期。通过在抑制剂关闭事件后立即暂时增加 $G_{1} \\rightarrow S$ 转移的单步超调来对此建模。\n- 损伤 DNA 的化疗在给药时会造成与当前 $S$ 期细胞比例成正比的分数杀伤。\n- 净活细胞数量通过与 $G_{2}/M \\rightarrow G_{1}$ 流量成正比的生长因子和反映化疗诱导死亡的存活因子进行乘法更新。\n\n定义如下：\n- 基线每步转移概率：$a$ 代表 $G_{1} \\rightarrow S$，$b$ 代表 $S \\rightarrow G_{2}/M$，$c$ 代表 $G_{2}/M \\rightarrow G_{1}$。\n- 二元控制序列：$u_{C}(t) \\in \\{0,1\\}$ (CDK $4/6$ 抑制剂开启或关闭) 和 $u_{D}(t) \\in \\{0,1\\}$ (损伤 DNA 的化疗开启或关闭)。\n- 当 $u_{C}(t) = 1$ 时，有效的 $G_{1} \\rightarrow S$ 转移率为 $a_{t} = a \\cdot (1 - \\alpha)$，其中 $0 \\le \\alpha \\le 1$。\n- 当发生释放事件时（即 $u_{C}(t-1) = 1$ 且 $u_{C}(t) = 0$），仅在该步设置 $a_{t} = a \\cdot (1 + \\gamma)$。如果在时间步 $t$ 既没有抑制也没有释放，则使用 $a_{t} = a$。\n- 时期分数更新为一阶马尔可夫转移：\n$$\n\\begin{aligned}\ng_{1,t+1} = g_{1,t} \\cdot (1 - a_{t}) + g_{2,t} \\cdot c, \\\\\ns_{t+1}   = s_{t} \\cdot (1 - b) + g_{1,t} \\cdot a_{t}, \\\\\ng_{2,t+1} = g_{2,t} \\cdot (1 - c) + s_{t} \\cdot b.\n\\end{aligned}\n$$\n- 活细胞数量 $N_{t}$ 从 $N_{0} = 1$ 开始，并按如下方式更新：\n$$\nN_{t+1} = N_{t} \\cdot \\bigl(1 + \\lambda \\cdot c \\cdot g_{2,t}\\bigr) \\cdot \\bigl(1 - u_{D}(t) \\cdot \\kappa \\cdot s_{t}\\bigr),\n$$\n其中 $0 \\le \\kappa \\le 1$ 且 $\\lambda \\ge 0$。\n\n方案约束：\n- CDK $4/6$ 抑制剂 $u_{C}(t)$ 可以作为长度为 $L_{C} \\in \\{0,1,\\dots,L_{\\max}\\}$ 的单个连续区块给药，起始时间为 $t_{C} \\in \\{0,1,\\dots,T-1\\}$，且满足 $t_{C} + L_{C} \\le T$。按惯例，若 $L_{C} = 0$，则取 $t_{C} = 0$。\n- 化疗 $u_{D}(t)$ 可以给药零次或一次。设 $n_{D} \\in \\{0,1\\}$ 为化疗脉冲次数，若 $n_{D} = 1$，则脉冲时间为 $t_{D} \\in \\{0,1,\\dots,T-1\\}$。按惯例，若 $n_{D} = 0$，则取 $t_{D} = -1$。\n- 适用线性毒性预算：$L_{C} \\cdot w_{C} + n_{D} \\cdot w_{D} \\le B$，其中 $w_{C}, w_{D}$ 为非负权重，$B$ 为预算。\n\n任务：\n- 对于测试套件中的每组参数，枚举出满足上述约束的所有可行方案 $(t_{C}, L_{C}, n_{D}, t_{D})$。\n- 使用指定的规则，从初始状态 $x_{0} = (g_{1,0}, s_{0}, g_{2,0})$ 和 $N_{0} = 1$ 开始模拟系统 $T$ 个时间步，确保每一步都满足 $g_{1,t} + s_{t} + g_{2,t} = 1$。\n- 找出使 $N_{T}$ 最小化的方案。如果 $N_{T}$ 出现平局（在标准浮点运算的数值相等范围内），则选择字典序最小的三元组 $(t_{C}, L_{C}, t_{D})$，其中当 $n_{D} = 0$ 时，$t_{D} = -1$。\n- 对于每个测试用例，输出列表 $[N_{T}^{\\star}, t_{C}^{\\star}, L_{C}^{\\star}, t_{D}^{\\star}]$，其中 $N_{T}^{\\star}$ 四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含所有用例的结果，形式为方括号括起的逗号分隔列表。\n\n测试套件：\n- 用例 1 (启用同步的协同作用搜索):\n  - $T = 10$, $a = 0.35$, $b = 0.60$, $c = 0.70$, $\\alpha = 0.90$, $\\gamma = 1.00$, $\\kappa = 0.80$, $\\lambda = 1.00$.\n  - $L_{\\max} = 5$, $B = 6$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = (0.60, 0.20, 0.20)$.\n- 用例 2 (无超调，测试自然时期定时):\n  - $T = 8$, $a = 0.30$, $b = 0.50$, $c = 0.60$, $\\alpha = 0.80$, $\\gamma = 0.00$, $\\kappa = 0.70$, $\\lambda = 0.80$.\n  - $L_{\\max} = 4$, $B = 3$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = (0.40, 0.30, 0.30)$.\n- 用例 3 (化疗无效的边缘情况):\n  - $T = 6$, $a = 0.40$, $b = 0.50$, $c = 0.50$, $\\alpha = 0.90$, $\\gamma = 1.20$, $\\kappa = 0.00$, $\\lambda = 0.90$.\n  - $L_{\\max} = 3$, $B = 0$, $w_{C} = 1$, $w_{D} = 1$.\n  - $x_{0} = \\left(\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3}\\right)$.\n\n最终输出格式：\n- 单行输出，包含一个由方括号括起的、逗号分隔的各用例结果列表，其中每个用例表示为 $[N_{T}^{\\star}, t_{C}^{\\star}, L_{C}^{\\star}, t_{D}^{\\star}]$，且 $N_{T}^{\\star}$ 四舍五入到 $6$ 位小数。对于没有化疗的方案，报告 $t_{D}^{\\star} = -1$。例如，一个有效的输出格式（非实际答案）是 $[[1.234567,0,3,5],[2.000000,1,0,-1],[\\dots]]$。", "solution": "所提出的问题是计算系统生物学中一个明确定义的练习，要求在治疗方案的离散空间上进行优化搜索。该模型是一个一阶线性差分方程组，它是对复杂细胞周期动力学的有效且标准的简化。它在科学上基于已确立的细胞周期控制和药理学概念，在数学上是一致的，并且所有参数都有明确定义。总细胞比例守恒，$g_{1,t} + s_{t} + g_{2,t} = 1$，由更新规则保证。因此，该问题是有效的，并且在指定的平局打破规则下有唯一解。\n\n核心任务是找到一个最优方案 $(t_{C}^{\\star}, L_{C}^{\\star}, n_{D}^{\\star}, t_{D}^{\\star})$，以在时间终点 $T$ 最小化最终的活细胞数量 $N_{T}$。一个方案由四个参数定义：细胞周期蛋白依赖性激酶 (CDK) $4/6$ 抑制剂单次连续给药的开始时间 $t_{C}$ 和持续时间 $L_{C}$，以及损伤 DNA 的化疗脉冲的次数 $n_{D}$ 和时间 $t_{D}$。\n\n所有可能方案的集合，我们记为 $\\mathcal{S}$，由以下约束定义：\n- $L_{C} \\in \\{0, 1, \\dots, L_{\\max}\\}$\n- $t_{C} \\in \\{0, 1, \\dots, T - 1\\}$ 且满足 $t_C + L_C \\le T$。按惯例，若 $L_C = 0$，则 $t_C = 0$。\n- $n_{D} \\in \\{0, 1\\}$\n- $t_{D} \\in \\{0, 1, \\dots, T-1\\}$。按惯例，若 $n_D = 0$，则 $t_D = -1$。\n此外，每个方案都必须满足线性毒性预算：\n$$L_{C} \\cdot w_{C} + n_{D} \\cdot w_{D} \\le B$$\n\n因此，优化问题可表述为在一个离散集合上寻找一个函数的最小值：\n$$\\min_{(t_{C}, L_{C}, n_{D}, t_{D}) \\in \\mathcal{S}_{\\text{feasible}}} N_{T}(t_{C}, L_{C}, n_{D}, t_{D})$$\n其中 $\\mathcal{S}_{\\text{feasible}}$ 是 $\\mathcal{S}$ 中满足预算约束的子集。\n\n求解策略是对所有可行方案进行暴力枚举和评估。由于由参数 $T$ 和 $L_{\\max}$ 定义的搜索空间规模适中，这在计算上是可行的。对于每个可行方案，系统的状态，包括时期分数 $x_t=(g_{1,t}, s_t, g_{2,t})$ 和总活细胞数 $N_t$，在时间间隔 $t \\in \\{0, 1, \\dots, T-1\\}$ 上进行模拟。\n\n首先，对于一个给定的方案 $(t_C, L_C, n_D, t_D)$，构造 $t \\in \\{0, \\dots, T-1\\}$ 的二元控制序列 $u_{C}(t)$ 和 $u_{D}(t)$：\n$$u_C(t) = \\begin{cases} 1  \\text{如果 } t_C \\le t  t_C + L_C \\\\ 0  \\text{否则} \\end{cases}$$\n$$u_D(t) = \\begin{cases} 1  \\text{如果 } n_D = 1 \\text{ 且 } t = t_D \\\\ 0  \\text{否则} \\end{cases}$$\n\n接下来，确定每个时间步 $t$ 的随时间变化的 $G_{1} \\rightarrow S$ 转移率 $a_t$：\n$$ a_{t} = \\begin{cases} a \\cdot (1 - \\alpha)  \\text{如果 } u_{C}(t) = 1 \\\\ a \\cdot (1 + \\gamma)  \\text{如果 } t  0, u_{C}(t-1) = 1, \\text{ 且 } u_{C}(t) = 0 \\\\ a  \\text{否则} \\end{cases} $$\n释放事件的条件 $u_C(t-1)=1$ 在 $t=0$ 时无法满足。\n\n状态初始化为 $x_0 = (g_{1,0}, s_{0}, g_{2,0})$ 和 $N_0 = 1$。然后系统进行迭代演化。对于每个时间步 $t = 0, \\dots, T-1$，状态被更新。时期分数根据指定的马尔可夫转移模型进行更新，该模型可以写成矩阵形式：\n$$\n\\begin{pmatrix} g_{1,t+1} \\\\ s_{t+1} \\\\ g_{2,t+1} \\end{pmatrix} =\n\\begin{pmatrix} 1-a_t  0  c \\\\ a_t  1-b  0 \\\\ 0  b  1-c \\end{pmatrix}\n\\begin{pmatrix} g_{1,t} \\\\ s_t \\\\ g_{2,t} \\end{pmatrix}\n$$\n这个变换正确地保持了总分数的守恒，因为转移矩阵的每一列之和为 $1$。\n\n同时，活细胞数量 $N_t$ 进行乘法更新：\n$$N_{t+1} = N_{t} \\cdot \\underbrace{\\bigl(1 + \\lambda \\cdot c \\cdot g_{2,t}\\bigr)}_{\\text{有丝分裂带来的增长}} \\cdot \\underbrace{\\bigl(1 - u_{D}(t) \\cdot \\kappa \\cdot s_{t}\\bigr)}_{\\text{化疗诱导的死亡}}$$\n\n迭代到 $t=T-1$ 后，得到的结果值是 $N_T$。算法必须跟踪迄今为止产生最小 $N_T$ 的方案。如果 $N_T$ 值出现平局（在约 $\\approx 10^{-9}$ 的标准浮点精度内），则通过选择字典序最小的元组 $(t_C, L_C, t_D)$ 来打破平局。\n\n所实现的算法为每个提供的测试用例自动执行此搜索和模拟过程，并按要求格式化最优方案和相应的最小细胞计数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main driver function to solve the problem for all test cases.\n    It generates feasible schedules, simulates the system for each,\n    and finds the optimal schedule minimizing the final cell count.\n    \"\"\"\n\n    def simulate(T, x0, N0, a, b, c, alpha, gamma, kappa, lambda_, schedule):\n        \"\"\"\n        Simulates the cell cycle model for a given schedule.\n        \n        Args:\n            T (int): Time horizon.\n            x0 (tuple): Initial phase fractions (g1_0, s_0, g2_0).\n            N0 (float): Initial viable cell number.\n            a, b, c (float): Baseline transition probabilities.\n            alpha (float): CDK4/6i inhibition factor.\n            gamma (float): CDK4/6i release overshoot factor.\n            kappa (float): Chemotherapy kill rate scaling factor.\n            lambda_ (float): Growth rate scaling factor.\n            schedule (tuple): A tuple (t_C, L_C, n_D, t_D) defining the treatment.\n        \n        Returns:\n            float: Viable cell number N_T at the final time step.\n        \"\"\"\n        t_C, L_C, n_D, t_D = schedule\n\n        # Generate control sequences u_C and u_D from the schedule\n        u_C = np.zeros(T, dtype=int)\n        if L_C > 0:\n            u_C[t_C : t_C + L_C] = 1\n\n        u_D = np.zeros(T, dtype=int)\n        if n_D == 1 and t_D >= 0:\n            u_D[t_D] = 1\n\n        # Initialize state variables\n        g1, s, g2 = x0\n        N = float(N0)\n\n        # Main simulation loop over discrete time steps\n        for t in range(T):\n            # Determine the effective G1->S transition rate a_t\n            is_release = (t > 0 and u_C[t - 1] == 1 and u_C[t] == 0)\n            \n            if u_C[t] == 1:\n                a_t = a * (1 - alpha)\n            elif is_release:\n                a_t = a * (1 + gamma)\n            else:\n                a_t = a\n\n            # Store current state values to ensure updates use the state at time t\n            g1_t, s_t, g2_t = g1, s, g2\n            N_t = N\n\n            # Update viable cell number N_{t+1}\n            growth_factor = 1.0 + lambda_ * c * g2_t\n            kill_factor = 1.0 - u_D[t] * kappa * s_t\n            N = N_t * growth_factor * kill_factor\n\n            # Update phase fractions (g1_{t+1}, s_{t+1}, g2_{t+1})\n            g1 = g1_t * (1.0 - a_t) + g2_t * c\n            s = s_t * (1.0 - b) + g1_t * a_t\n            g2 = g2_t * (1.0 - c) + s_t * b\n            \n        return N\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'T': 10, 'a': 0.35, 'b': 0.60, 'c': 0.70, 'alpha': 0.90, 'gamma': 1.00, \n         'kappa': 0.80, 'lambda_': 1.00, 'L_max': 5, 'B': 6, 'w_C': 1, 'w_D': 1, \n         'x0': (0.60, 0.20, 0.20), 'N0': 1.0},\n        # Case 2\n        {'T': 8, 'a': 0.30, 'b': 0.50, 'c': 0.60, 'alpha': 0.80, 'gamma': 0.00, \n         'kappa': 0.70, 'lambda_': 0.80, 'L_max': 4, 'B': 3, 'w_C': 1, 'w_D': 1, \n         'x0': (0.40, 0.30, 0.30), 'N0': 1.0},\n        # Case 3\n        {'T': 6, 'a': 0.40, 'b': 0.50, 'c': 0.50, 'alpha': 0.90, 'gamma': 1.20, \n         'kappa': 0.00, 'lambda_': 0.90, 'L_max': 3, 'B': 0, 'w_C': 1, 'w_D': 1, \n         'x0': (1/3, 1/3, 1/3), 'N0': 1.0},\n    ]\n\n    all_case_results = []\n    TOL = 1e-9 # Tolerance for floating point comparisons\n\n    for case in test_cases:\n        T, L_max, B, w_C, w_D = case['T'], case['L_max'], case['B'], case['w_C'], case['w_D']\n        \n        # 1. Generate all feasible schedules\n        feasible_schedules = []\n        for L_C in range(L_max + 1):\n            t_C_range = [0] if L_C == 0 else range(T - L_C + 1)\n            for t_C in t_C_range:\n                for n_D in [0, 1]:\n                    t_D_range = [-1] if n_D == 0 else range(T)\n                    for t_D in t_D_range:\n                        # Check if the schedule adheres to the toxicity budget\n                        if L_C * w_C + n_D * w_D = B:\n                            schedule = (t_C, L_C, n_D, t_D)\n                            feasible_schedules.append(schedule)\n\n        # 2. Find the optimal schedule by simulating each feasible one\n        best_N_T = float('inf')\n        best_schedule_for_tiebreak = (float('inf'), float('inf'), float('inf'))\n        best_schedule_output = []\n\n        for schedule in feasible_schedules:\n            t_C, L_C, n_D, t_D = schedule\n            \n            N_T = simulate(\n                T=case['T'], x0=case['x0'], N0=case['N0'], a=case['a'], \n                b=case['b'], c=case['c'], alpha=case['alpha'], \n                gamma=case['gamma'], kappa=case['kappa'], \n                lambda_=case['lambda_'], schedule=schedule\n            )\n\n            current_schedule_for_tiebreak = (t_C, L_C, t_D)\n\n            # Compare N_T with the best found so far and apply tie-breaking rules\n            if N_T  best_N_T - TOL:\n                best_N_T = N_T\n                best_schedule_for_tiebreak = current_schedule_for_tiebreak\n                best_schedule_output = [round(N_T, 6), t_C, L_C, t_D]\n            elif abs(N_T - best_N_T) = TOL:\n                # Tie in N_T, use lexicographical comparison of the schedule triple\n                if current_schedule_for_tiebreak  best_schedule_for_tiebreak:\n                    best_schedule_for_tiebreak = current_schedule_for_tiebreak\n                    best_schedule_output = [round(N_T, 6), t_C, L_C, t_D]\n        \n        all_case_results.append(best_schedule_output)\n\n    # Final print statement in the exact required format.\n    print(f\"[[{', '.join(map(str, all_case_results))}]\".replace(\" \", \"\"))\n\n# Execute the solver\nsolve()\n```", "id": "2780903"}]}