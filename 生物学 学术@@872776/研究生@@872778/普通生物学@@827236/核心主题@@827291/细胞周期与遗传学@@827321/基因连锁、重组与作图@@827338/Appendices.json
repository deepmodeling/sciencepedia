{"hands_on_practices": [{"introduction": "遗传作图的核心技能之一是从实验数据中推断基因的排列顺序和相对距离。三点测交是实现这一目标的经典方法，它通过分析杂合三基因个体与纯合隐性个体杂交后代的表型比例，来揭示亲本配子形成过程中的重组事件。这项实践将指导你完成一个完整的三点测交分析，从原始的后代计数数据出发，通过识别亲本型、单交换和双交换类型，最终构建出包含三个基因座 $A$、$B$ 和 $C$ 的连锁图。[@problem_id:2801497]", "problem": "一个在三个基因座 $A$、$B$ 和 $C$ 上均为杂合的三杂合个体，携带相偶连锁单倍型 $A B C$ 和 $a b c$。该个体与一个三隐性测交亲本 $a b c$ 进行测交。测交后代中的表现型类别直接反映了该三杂合亲本产生的配子。您观察到以下八个后代类别（总数 $N = 10,000$）：\n\n- $A B C$: 3,579\n- $a b c$: 3,573\n- $A b c$: 525\n- $a B C$: 523\n- $A B c$: 826\n- $a b C$: 824\n- $A b C$: 76\n- $a B c$: 74\n\n仅从经典遗传学中关于重组率、双交换（DCO）和三点测交逻辑的核心定义出发，推断线性基因顺序，并计算推断顺序中相邻基因座之间的遗传图距。\n\n- 将基因顺序从左到右报告为基因座索引 $(1,2,3)$ 的一个排列，其中 $1 \\equiv A$，$2 \\equiv B$，$3 \\equiv C$。\n- 以厘摩（centiMorgan, cM）为单位，计算两个相邻基因座的距离 $d_{1\\text{–}2}$ 和 $d_{2\\text{–}3}$，使用标准短距离近似法，即重组率乘以100等于以$\\text{cM}$为单位的遗传距离。\n- 将每个距离四舍五入至四位有效数字。\n- 将最终答案表示为单行矩阵 $\\begin{pmatrix} i_1  i_2  i_3  d_{1\\text{–}2}  d_{2\\text{–}3} \\end{pmatrix}$，矩阵内不含单位。在解题过程中，将单位注明为$\\text{cM}$。", "solution": "问题经过验证。\n\n已知条件逐字提取如下：\n- 一个在三个基因座$A$、$B$和$C$上均为杂合的三杂合个体。\n- 该个体携带相偶连锁单倍型 $A B C$ 和 $a b c$。\n- 该个体与一个三隐性测交亲本 $a b c$ 进行测交。\n- 后代总数为$N = 10,000$。\n- 后代表现型类别计数：\n  - $A B C$: 3,579\n  - $a b c$: 3,573\n  - $A b c$: 525\n  - $a B C$: 523\n  - $A B c$: 826\n  - $a b C$: 824\n  - $A b C$: 76\n  - $a B c$: 74\n\n验证结论：问题有效。\n- 它在科学上基于经典遗传学的原理，特别是用于基因作图的三点测交分析。\n- 它的提法恰当，为求得唯一解提供了所有必要数据。\n- 语言客观、精确。\n- 数据内部一致；后代计数总和为 $3,579 + 3,573 + 525 + 523 + 826 + 824 + 76 + 74 = 10,000$，与给定的总数$N$相符。互补类型（例如，$A B C$和$a b c$）的计数在数量上相似，这与减数分裂的预期一致。所有有效问题的标准均已满足。\n\n解题过程如下。目标是确定三个基因的线性顺序及其间的遗传距离。三点测交的分析依赖于识别杂合亲本产生的不同类型的配子。由于测交亲本是纯合隐性（$a b c$），后代的表现型直接揭示了来自三杂合亲本的配子的遗传组成。\n\n首先，我们根据后代的频率对其进行分类。原则是亲本型（非重组）配子频率最高，而双交换（DCO）配子频率最低。\n- 两个最常见的表现型类别是$A B C$（计数$3,579$）和$a b c$（计数$3,573$）。这些代表了亲本型，或称非重组配子。非重组后代的总数为 $N_{P} = 3,579 + 3,573 = 7,152$。这与给定的亲本单倍型$A B C$和$a b c$一致。\n- 两个最少见的表现型类别是$A b C$（计数$76$）和$a B c$（计数$74$）。这些代表了双交换（DCO）配子，其产生于两次同时发生的交换事件。双交换后代的总数为 $N_{DCO} = 76 + 74 = 150$。\n\n接下来，我们确定基因顺序。双交换事件会交换两条亲本染色体之间的中间等位基因。通过比较双交换配子的等位基因组成与亲本配子的等位基因组成，我们可以识别出位于中间的基因。让我们比较亲本单倍型$A B C$与双交换单倍型$A b C$。基因座$A$和$C$的等位基因相同（$A$和$C$），而基因座$B$的等位基因被交换了（$B$换成了$b$）。这表明基因座$B$位于基因座$A$和$C$之间。因此，正确的基因顺序是$A - B - C$。根据题目中 $1 \\equiv A$，$2 \\equiv B$，$3 \\equiv C$ 的表示法，基因顺序为 $(1, 2, 3)$。\n\n基因顺序确定后，我们现在可以对剩下的四个后代类别进行分类，它们是由单交换（SCO）事件产生的。\n- 基因$A$和基因$B$之间（1区）的单交换会产生配子$A b c$和$a B C$。这些类别的观察计数分别为$525$和$523$。1区的单交换后代总数为 $N_{SCO1} = 525 + 523 = 1,048$。\n- 基因$B$和基因$C$之间（2区）的单交换会产生配子$A B c$和$a b C$。这些类别的观察计数分别为$826$和$824$。2区的单交换后代总数为 $N_{SCO2} = 826 + 824 = 1,650$。\n\n现在，我们计算遗传图距。两个基因座之间的图距定义为它们之间的重组率，以厘摩（$\\text{cM}$）表示。一厘摩对应于$1\\%$的重组率。重组率（$RF$）是重组后代数与后代总数的比值。关键要记住，两个基因座之间的重组事件总数包括该区间的*所有*单交换*以及所有*双交换。\n\n基因座$A$和基因座$B$之间的距离，记作$d_{1\\text{–}2}$，计算如下：\n$$RF_{A-B} = \\frac{N_{SCO1} + N_{DCO}}{N_{total}} = \\frac{1,048 + 150}{10,000} = \\frac{1,198}{10,000} = 0.1198$$\n那么图距为：\n$$d_{1\\text{–}2} = RF_{A-B} \\times 100 = 0.1198 \\times 100 = 11.98 \\text{ cM}$$\n该值已是四位有效数字。\n\n基因座$B$和基因座$C$之间的距离，记作$d_{2\\text{–}3}$，计算方法类似：\n$$RF_{B-C} = \\frac{N_{SCO2} + N_{DCO}}{N_{total}} = \\frac{1,650 + 150}{10,000} = \\frac{1,800}{10,000} = 0.1800$$\n那么图距为：\n$$d_{2\\text{–}3} = RF_{B-C} \\times 100 = 0.1800 \\times 100 = 18.00 \\text{ cM}$$\n该值为四位有效数字。\n\n推断出的遗传图为：$A \\xrightarrow{11.98\\text{ cM}} B \\xrightarrow{18.00\\text{ cM}} C$。\n\n为了确认交换事件的非随机性（遗传干涉），我们可以将观察到的双交换频率与预期的双交换频率进行比较。预期频率是两个相邻区域重组率的乘积：\n$$RF_{expected DCO} = RF_{A-B} \\times RF_{B-C} = 0.1198 \\times 0.1800 \\approx 0.02156$$\n预期的双交换后代数为 $10,000 \\times 0.02156 = 215.6$。\n观察到的数目是 $150$。\n并发系数为 $C = \\frac{\\text{观察到的DCO}}{\\text{预期的DCO}} = \\frac{150}{215.6} \\approx 0.696$。\n干涉为 $I = 1 - C = 1 - 0.696 = 0.304$。这个正干涉值表明，一个区域的交换会降低相邻区域同时发生交换的概率，这是一个常见的生物学现象。\n\n最终答案要求以 $(1,2,3)$ 的排列形式给出基因顺序，以及两个相邻的图距 $d_{1\\text{–}2}$ 和 $d_{2\\text{–}3}$。\n基因顺序是$A-B-C$，对应于$(1, 2, 3)$。\n距离为 $d_{1\\text{–}2} = 11.98$ 和 $d_{2\\text{–}3} = 18.00$。\n要求的输出是一个包含这五个值的单行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  2  3  11.98  18.00\n\\end{pmatrix}\n}\n$$", "id": "2801497"}, {"introduction": "重组率（recombination fraction, $r$）是连锁分析的直接观测值，但它并不完全等同于遗传距离（map distance）。当基因相距较远时，多次交换事件的发生会导致重组率低估真实的遗传距离。为了校正这种偏差，遗传学家提出了多种作图函数（mapping functions），它们建立了重组率和图距之间的数学关系。本练习将通过比较 Haldane 和 Kosambi 两种经典的作图函数，让你亲手计算并体会不同模型（分别假设无干涉和正干涉）如何将同一个观测重组率转化为不同的图距估计。[@problem_id:2801515]", "problem": "在一个二倍体物种的大规模回交实验中，根据经验估计，两个共显性遗传标记之间的重组率为 $r=0.22$。假设在此尺度下自由组合定律不适用，并且染色体上的交换形成过程可以用两种经典的作图函数框架之一来建模。\n\n仅使用以下基本原理：\n- 重组率 $r$ 是指随机抽样的一条染色单体在两个基因座之间发生重组的概率，这种情况在染色单体上两个基因座之间的交换次数为奇数时发生。\n- 在无干涉模型下，交换位置沿二价染色体的遗传长度呈泊松过程分布，而涉及特定染色单体的交换次数则是一个稀疏泊松过程。\n- 在具有图距可加性的正干涉模型下，Kosambi 作图函数是一种在重组率和遗传距离之间进行转换的、经过广泛使用和充分检验的方法。\n\n对于给定的 $r$ 值，分别根据 Haldane 的无干涉模型和 Kosambi 的正干涉模型推导遗传图距，然后计算这两种距离之差的绝对值。将两种距离以厘摩（cM）为单位表示，其中 1 摩根（Morgan）等于平均每条染色单体预期发生一次交换的区间长度。按此顺序报告三个值：Haldane 距离（cM）、Kosambi 距离（cM）和绝对差值（cM）。将每个报告值四舍五入至 4 位有效数字。最终报告的值中不要包含任何注释；单位和注释应只出现在您的计算过程中。最终报告的值必须与您给出的推导过程一致。", "solution": "该问题要求使用两种不同的模型——Haldane 的无干涉模型和 Kosambi 的正干涉模型——根据观测到的重组率计算遗传图距。我们已知经验重组率为 $r = 0.22$。最终结果必须以厘摩（cM）表示，并四舍五入至 4 位有效数字。\n\n首先，我们处理 Haldane 的无干涉模型。该模型假设沿染色体二价体的交换事件遵循泊松过程。遗传图距（单位为摩根，我们记作 $x$）定义为两个基因座之间在单条染色单体上发生交换的期望次数。如果二价体上的交换是泊松分布的，那么影响单条染色单体的交换次数 $K$ 也遵循均值为 $x$ 的泊松分布。观测到 $k$ 次交换的概率由下式给出：\n$$P(K=k) = \\frac{\\exp(-x) x^k}{k!}$$\n如果基因座之间发生奇数次交换，就会产生重组型染色单体。因此，重组率 $r$ 是所有奇数 $k$ 值对应概率的总和：\n$$r = \\sum_{j=0}^{\\infty} P(K = 2j+1) = \\sum_{j=0}^{\\infty} \\frac{\\exp(-x) x^{2j+1}}{(2j+1)!}$$\n在双曲函数的泰勒级数展开中可以识别出这个和式。具体而言，$\\sinh(x) = \\sum_{j=0}^{\\infty} \\frac{x^{2j+1}}{(2j+1)!}$。\n因此，关系式为：\n$$r = \\exp(-x) \\sinh(x)$$\n通过代入双曲正弦的指数形式 $\\sinh(x) = \\frac{\\exp(x) - \\exp(-x)}{2}$，我们推导出 Haldane 作图函数：\n$$r = \\exp(-x) \\left( \\frac{\\exp(x) - \\exp(-x)}{2} \\right) = \\frac{1 - \\exp(-2x)}{2}$$\n为了从重组率 $r$ 求出遗传距离 $x_H$，我们必须对该函数求逆：\n$$2r = 1 - \\exp(-2x_H)$$\n$$\\exp(-2x_H) = 1 - 2r$$\n$$-2x_H = \\ln(1 - 2r)$$\n$$x_H = -\\frac{1}{2} \\ln(1 - 2r)$$\n距离 $x_H$ 的单位是摩根。为了转换为厘摩（$d_H$），我们乘以 $100$：\n$$d_H = 100 \\times x_H = -50 \\ln(1 - 2r)$$\n代入给定的值 $r = 0.22$：\n$$d_H = -50 \\ln(1 - 2 \\times 0.22) = -50 \\ln(1 - 0.44) = -50 \\ln(0.56)$$\n计算数值：\n$$d_H \\approx -50 \\times (-0.579818) \\approx 28.9909 \\text{ cM}$$\n四舍五入到 4 位有效数字，Haldane 距离是 $28.99$ cM。\n\n其次，我们处理 Kosambi 的正干涉模型。题目指示我们使用 Kosambi 作图函数，该函数将重组率 $r$ 与以摩根为单位的图距 $x_K$ 关联起来，如下所示：\n$$r = \\frac{1}{2} \\tanh(2x_K)$$\n此函数考虑了正干涉，即一次交换事件会降低附近发生另一次交换事件的概率。为了从 $r$ 求出距离 $d_K$，我们必须对该函数求逆。\n$$2r = \\tanh(2x_K)$$\n$$2x_K = \\arctanh(2r)$$\n$$x_K = \\frac{1}{2} \\arctanh(2r)$$\n距离 $x_K$ 的单位是摩根。以厘摩为单位的距离 $d_K$ 是：\n$$d_K = 100 \\times x_K = 50 \\arctanh(2r)$$\n我们也可以使用反双曲正切的对数定义来表示它，即 $\\arctanh(z) = \\frac{1}{2} \\ln \\left( \\frac{1+z}{1-z} \\right)$：\n$$d_K = 50 \\left( \\frac{1}{2} \\ln \\left( \\frac{1+2r}{1-2r} \\right) \\right) = 25 \\ln \\left( \\frac{1+2r}{1-2r} \\right)$$\n代入值 $r = 0.22$：\n$$d_K = 50 \\arctanh(2 \\times 0.22) = 50 \\arctanh(0.44)$$\n计算数值：\n$$d_K \\approx 50 \\times (0.472231) \\approx 23.6115 \\text{ cM}$$\n四舍五入到 4 位有效数字，Kosambi 距离是 $23.61$ cM。\n\n最后，我们计算两种距离之差的绝对值 $\\Delta d$：\n$$\\Delta d = |d_H - d_K|$$\n在最终四舍五入之前，使用未舍入的值以获得更高精度：\n$$\\Delta d = |28.99092... - 23.61154...| = |5.37938...| \\text{ cM}$$\n将绝对差值四舍五入到 4 位有效数字，我们得到 $5.379$ cM。\n\n因此，所需的三个值为：\nHaldane 距离：$d_H \\approx 28.99$ cM。\nKosambi 距离：$d_K \\approx 23.61$ cM。\n绝对差值：$\\Delta d \\approx 5.379$ cM。", "answer": "$$\n\\boxed{\\begin{pmatrix} 28.99  23.61  5.379 \\end{pmatrix}}\n$$", "id": "2801515"}, {"introduction": "在现代遗传学研究中，高通量基因分型技术虽然强大，但不可避免地会引入基因分型错误和数据缺失。这些看似微小的技术瑕疵，如果不加以妥善处理，会对连锁图的构建造成严重影响，例如导致“图谱膨胀”（spurious map expansion）等假象。这项高级实践模拟了真实数据分析中的挑战，要求你从第一性原理出发，定量分析分型错误如何系统性地抬高观测到的重组率，并探讨用于构建稳健遗传图的现代计算策略，如隐马尔可夫模型（HMM）等。[@problem_id:2801527]", "problem": "一位植物遗传学家正在利用回交群体构建连锁图谱，其中每个后代在每个位点上携带轮回亲本等位基因或供体等位基因。考虑位于同一条染色体上的两个共显性标记 $M_1$ 和 $M_2$。设 $M_1$ 和 $M_2$ 之间的真实重组率为 $r$，并假设染色体上不存在交换干涉。每个标记基因型在检测时，会以概率 $\\varepsilon$ 独立地被错判（在两个回交基因型类别之间发生对称的两态翻转），并以概率 $m$ 独立地缺失（随机缺失）。研究者使用朴素两点估计量，该方法排除了在 $M_1$ 或 $M_2$ 任意一个标记上存在数据缺失的个体，然后在剩余个体中通过观察到的重组型基因型对的比例来估计重组率。然后，在无干涉假设下，使用该情况下的标准作图函数计算遗传距离。假设样本量足够大，使得期望值可以近似于观察到的比例。\n\n你的推理需基于第一性原理：重组率 $r$ 的定义（即回交群体配子形成过程中同源染色单体间发生重组事件的伯努利概率）、各基因分型错误在位点间和个体间的独立性，以及重组率和图谱距离之间的无干涉关系。不要假设任何直接给出错误条件下观察到的重组率的特定修正公式；相反，应从给定的假设中推导出任何必要的表达式。\n\n现在分析以下具体参数设置：$r = 0.12$，$\\varepsilon = 0.02$，$m = 0.10$。在你的答案中，你可以按名称引用通用算法框架，例如隐马尔可夫模型（HMM）、期望最大化（EM）和贝叶斯信息准则（BIC）。\n\n在这些条件下，哪个选项最准确地描述了预期的朴素两点估计，并为多标记排序程序推荐了算法上合理的步骤，以防止由基因分型错误和缺失数据引起的伪图谱扩张？\n\nA. 朴素两点估计值大致保持在 $r = 0.12$，因为随机基因分型错误平均会相互抵消；然而，缺失率为 $m = 0.10$ 的数据会因减小分母而向下偏倚估计值。为了纠正多标记图谱扩张，应删除所有有任何缺失标记的个体，并在添加标记时使用更严格的显著性阈值。\n\nB. 在 $\\varepsilon = 0.02$ 的条件下，朴素两点估计值被夸大至约 $r_{\\text{obs}} \\approx 0.150$，而随机缺失率为 $m = 0.10$ 时，并不会偏倚两点估计量的期望值，但会增加其方差；相应的无干涉图谱距离从约 $13.72$ 厘摩（centiMorgans）夸大至约 $17.83$ 厘摩。纠正性的排序应将一个明确的基因分型错误参数纳入多点隐马尔可夫模型（HMM）中，通过最大似然法（例如，期望最大化（EM）算法）估计 $\\varepsilon$，并通过对缺失基因型进行边缘化处理，而不是逐例删除；通过最大化多点似然并应用长度惩罚（例如，贝叶斯信息准则（BIC））来评估局部顺序置换（“涟漪分析”），以抑制伪图谱扩张，并迭代地标记和重新检查具有高局部后验错误概率的基因型。\n\nC. 朴素两点估计值在 $r \\approx 0.120$ 处保持不变，因为两个位点上的错误是独立的；为了稳定排序，应使用成对删除法计算成对重组率，然后在相邻区间上进行多数投票，并将所有模糊或缺失的状态指定为重组型以求保守。\n\nD. 朴素两点估计值被压缩至约 $r_{\\text{obs}} \\approx 0.100$，因为基因分型错误掩盖了真实的重组体；为防止图谱扩张，应切换到 Kosambi 作图函数，并在排序前将缺失的基因型填补为每个标记上最常见的等位基因。\n\nE. 朴素两点估计值被夸大了约 $2\\varepsilon$，得到 $r_{\\text{obs}} \\approx 0.160$；为了纠正，应筛选出偏离哈迪-温伯格平衡的标记，然后在不模拟错误或缺失的情况下，固定使相邻重组率之和最小化的标记顺序。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n-   **种群结构**：回交群体。\n-   **标记**：位于同一染色体上的两个共显性标记 $M_1$ 和 $M_2$。\n-   **真实重组率**：$r$。\n-   **交换干涉假设**：无交换干涉。\n-   **基因分型错误模型**：每个标记以概率 $\\varepsilon$ 独立错分。该错误是回交群体中两种可能基因型类别之间的对称两态翻转。\n-   **缺失数据模型**：每个标记以概率 $m$ 独立缺失。机制是随机缺失（MAR）。\n-   **估计量**：一个使用成对删除法（舍弃在 $M_1$ 或 $M_2$ 上有缺失数据的个体）的朴素两点估计量。重组率通过剩余个体中重组体的比例来估计。\n-   **作图函数**：与无干涉假设对应的标准函数（Haldane 函数）。\n-   **样本量**：假设足够大，因此观察比例可以用其期望值来近似。\n-   **具体参数**：$r = 0.12$，$\\varepsilon = 0.02$，$m = 0.10$。\n-   **任务**：描述朴素估计的特征，并为多标记作图推荐鲁棒的算法程序。\n\n### 步骤2：使用提取的给定条件进行验证\n-   **科学依据**：该问题在统计遗传学和连锁图谱构建的原理上有充分的依据。回交、重组、基因分型错误、缺失数据和作图函数的概念都是标准的。指定的参数是现实的。\n-   **良构性**：该问题是良构的。它提供了所有必要的参数和对估计过程的清晰定义，从而可以为观察到的重组率和图谱距离推导出唯一的期望值。\n-   **客观性**：该问题以精确、客观、技术性的语言陈述，不含主观性。\n-   **完整性和一致性**：该问题是自洽且内部一致的。它指定了错误模型、缺失数据机制和估计方法。\n-   **可行性**：所有陈述的条件和参数值在科学上都是合理的，在计算上也是可行的。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、良构的且内部一致。它是 **有效的**。开始求解。\n\n### 朴素估计期望值的推导\n\n首先，我们分析朴素估计过程的各个组成部分。\n\n**1. 缺失数据的影响**\n该过程排除了在 $M_1$ 或 $M_2$ 上有任何缺失基因型的个体。在单个位点上观察到基因型的概率是 $(1-m)$。由于缺失在位点间是独立的，一个个体在 $M_1$ 和 $M_2$ 上都有非缺失数据的概率是 $(1-m)^2$。对于 $m=0.10$，这个概率是 $(1-0.10)^2 = 0.90^2 = 0.81$。\n问题指出数据是随机缺失（MAR）。这意味着，对具有完整数据的个体子集进行条件化，并不会改变真实基因型的期望频率。因此，对缺失数据进行成对删除会减少有效样本量，从而增加估计的方差，但不会对估计量的期望值引入系统性偏差。因此，我们可以在具有完整数据的个体亚群上分析基因分型错误的影响。\n\n**2. 基因分型错误的影响**\n设 $r$ 为真实重组率。在一个大的回交样本中，真实亲本型基因型的比例是 $(1-r)$，真实重组型基因型的比例是 $r$。\n基因分型错误 $\\varepsilon$ 是一个位点上两种可能基因型状态之间的对称翻转。我们需要找到一个真实的亲本型或重组型个体被*观察*为重组型的概率。这个观察到的比例就是朴素估计值 $r_{\\text{obs}}$。\n\n一个个体的基因型对如果其在 $M_1$ 和 $M_2$ 上的基因型相同，则被归类为亲本型；如果不同，则为重组型。\n一个错误是观察到的基因型的翻转。各位点上的错误是独立的。\n\n-   **考虑一个真实的亲本型个体（比例为 $1-r$）：**\n    $M_1$ 和 $M_2$ 的基因型相同。如果一个位点被正确读取而另一个位点被错误读取，这个个体将被*观察为重组型*。\n    其概率为：\n    $$P(\\text{obs rec} | \\text{true par}) = P(\\text{correct at } M_1, \\text{error at } M_2) + P(\\text{error at } M_1, \\text{correct at } M_2)$$\n    $$P(\\text{obs rec} | \\text{true par}) = (1-\\varepsilon)\\varepsilon + \\varepsilon(1-\\varepsilon) = 2\\varepsilon(1-\\varepsilon)$$\n\n-   **考虑一个真实的重组型个体（比例为 $r$）：**\n    $M_1$ 和 $M_2$ 的基因型不同。如果两个位点都被正确读取，或者两个位点都被错误读取（双重错误使这对基因型再次显得不同），这个个体将被*观察为重组型*。\n    其概率为：\n    $$P(\\text{obs rec} | \\text{true rec}) = P(\\text{correct at } M_1, \\text{correct at } M_2) + P(\\text{error at } M_1, \\text{error at } M_2)$$\n    $$P(\\text{obs rec} | \\text{true rec}) = (1-\\varepsilon)(1-\\varepsilon) + \\varepsilon\\varepsilon = (1-\\varepsilon)^2 + \\varepsilon^2$$\n\n观察到的重组体的总体期望比例 $r_{\\text{obs}}$ 是这些可能性按真实比例加权的总和：\n$$r_{\\text{obs}} = P(\\text{obs rec}) = P(\\text{obs rec} | \\text{true par}) P(\\text{true par}) + P(\\text{obs rec} | \\text{true rec}) P(\\text{true rec})$$\n$$r_{\\text{obs}} = [2\\varepsilon(1-\\varepsilon)](1-r) + [(1-\\varepsilon)^2 + \\varepsilon^2](r)$$\n让我们简化这个表达式：\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2)(1-r) + (1-2\\varepsilon+\\varepsilon^2+\\varepsilon^2)(r)$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) - r(2\\varepsilon - 2\\varepsilon^2) + r(1 - 2\\varepsilon + 2\\varepsilon^2)$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) + r(1 - 2\\varepsilon + 2\\varepsilon^2 - (2\\varepsilon - 2\\varepsilon^2))$$\n$$r_{\\text{obs}} = (2\\varepsilon - 2\\varepsilon^2) + r(1 - 4\\varepsilon + 4\\varepsilon^2)$$\n$$r_{\\text{obs}} = 2\\varepsilon(1-\\varepsilon) + r(1-2\\varepsilon)^2$$\n一个等价的替代公式是 $r_{\\text{obs}} = r + (1-2r) \\cdot 2\\varepsilon(1-\\varepsilon)$。这个形式清楚地表明，对于 $r  0.5$，$1-2r  0$，所以 $r_{\\text{obs}}  r$。重组率被夸大了。\n\n**3. 数值计算**\n使用给定参数 $r = 0.12$ 和 $\\varepsilon = 0.02$：\n$$r_{\\text{obs}} = 0.12 + (1 - 2 \\cdot 0.12) \\cdot 2 \\cdot 0.02 \\cdot (1 - 0.02)$$\n$$r_{\\text{obs}} = 0.12 + (1 - 0.24) \\cdot 0.04 \\cdot (0.98)$$\n$$r_{\\text{obs}} = 0.12 + (0.76) \\cdot (0.0392)$$\n$$r_{\\text{obs}} = 0.12 + 0.029792$$\n$$r_{\\text{obs}} \\approx 0.1498$$\n四舍五入到三位小数，$r_{\\text{obs}} \\approx 0.150$。\n\n**4. 图谱距离计算与夸大**\n问题指定了无交换干涉，这对应于 Haldane 作图函数：\n$$d = -0.5 \\ln(1 - 2r)$$\n其中 $d$ 的单位是摩根（Morgans）。为了得到厘摩（cM），我们使用 $d_{\\text{cM}} = -50 \\ln(1 - 2r)$。\n\n-   **真实图谱距离（使用 $r = 0.12$）：**\n    $$d_{\\text{true}} = -50 \\ln(1 - 2 \\cdot 0.12) = -50 \\ln(1 - 0.24) = -50 \\ln(0.76)$$\n    $$d_{\\text{true}} \\approx -50(-0.27443) \\approx 13.72 \\text{ cM}$$\n\n-   **观察到的图谱距离（使用 $r_{\\text{obs}} \\approx 0.150$）：**\n    $$d_{\\text{obs}} = -50 \\ln(1 - 2 \\cdot 0.150) = -50 \\ln(1 - 0.30) = -50 \\ln(0.70)$$\n    $$d_{\\text{obs}} \\approx -50(-0.35667) \\approx 17.83 \\text{ cM}$$\n基因分型错误导致估计的重组率从 $0.12$ 夸大到约 $0.150$，这又导致估计的图谱距离从约 $13.72$ cM 夸大到约 $17.83$ cM。这种现象被称为伪图谱扩张。\n\n**5. 算法建议**\n为了在存在基因分型错误和缺失数据的情况下构建鲁棒的多标记连锁图谱，必须放弃朴素的两点法。最先进的方法包括：\n-   **多点似然模型**：使用隐马尔可夫模型（HMM）是标准方法。沿染色体的真实基因型序列是“隐藏”状态，观察到的基因型是“发射”。HMM 中的转移概率是相邻标记间重组率的函数。\n-   **显式错误建模**：HMM 的发射概率必须明确地对基因分型错误率 $\\varepsilon$ 进行建模。该模型变为 $P(\\text{观察到的基因型} | \\text{真实基因型})$。\n-   **参数估计**：通过在整个图谱上最大化数据的总似然，同时估计重组率和错误率 $\\varepsilon$。期望最大化（EM）算法是 HMM 中进行这种最大似然估计的标准工具。\n-   **处理缺失数据**：HMM 不是丢弃数据（成对或逐例删除），而是通过对缺失位点所有可能的隐藏状态进行求和（边缘化）来自然地处理缺失数据，并根据侧翼数据给出的概率进行加权。这是一种更有效的信息利用方式。\n-   **顺序优化和模型选择**：找到最佳标记顺序需要测试局部置换（例如，“涟漪”程序），并选择使多点似然最大化的顺序。为了防止过拟合和伪图谱扩张，这种最大化通常会受到惩罚。像贝叶斯信息准则（BIC）或赤池信息准则（AIC）这样的模型选择准则可以用来惩罚图谱长度（具有更多重组事件的模型）。\n-   **错误诊断**：图谱构建后，可以使用 Viterbi 或前向-后向算法为每个数据点计算基因分型错误的后验概率。具有高后验错误概率的基因型可以被标记出来，以便重新评分或在下一轮作图中置空。\n\n---\n### 逐项分析\n\n**A. 朴素两点估计值大致保持在 $r = 0.12$，因为随机基因分型错误平均会相互抵消；然而，缺失率为 $m = 0.10$ 的数据会因减小分母而向下偏倚估计值。为了纠正多标记图谱扩张，应删除所有有任何缺失标记的个体，并在添加标记时使用更严格的显著性阈值。**\n-   **不正确。** 推导表明，随机错误不会相互抵消；它们会导致对连锁标记的重组率产生系统性夸大。随机缺失数据不会偏倚估计量的期望值。推荐的纠正措施效率低下，且未解决问题的根本原因。\n\n**B. 在 $\\varepsilon = 0.02$ 的条件下，朴素两点估计值被夸大至约 $r_{\\text{obs}} \\approx 0.150$，而随机缺失率为 $m = 0.10$ 时，并不会偏倚两点估计量的期望值，但会增加其方差；相应的无干涉图谱距离从约 $13.72$ 厘摩（centiMorgans）夸大至约 $17.83$ 厘摩。纠正性的排序应将一个明确的基因分型错误参数纳入多点隐马尔可夫模型（HMM）中，通过最大似然法（例如，期望最大化（EM）算法）估计 $\\varepsilon$，并通过对缺失基因型进行边缘化处理，而不是逐例删除；通过最大化多点似然并应用长度惩罚（例如，贝叶斯信息准则（BIC））来评估局部顺序置换（“涟漪分析”），以抑制伪图谱扩张，并迭代地标记和重新检查具有高局部后验错误概率的基因型。**\n-   **正确。** 此选项正确地量化了重组率和图谱距离的夸大程度，正确描述了随机缺失（MAR）数据的统计效应，并准确地详述了解决基因分型错误和缺失数据的最先进的鲁棒连锁图谱构建算法框架。该选项的每个组成部分都符合统计遗传学的原理。\n\n**C. 朴素两点估计值在 $r \\approx 0.120$ 处保持不变，因为两个位点上的错误是独立的；为了稳定排序，应使用成对删除法计算成对重组率，然后在相邻区间上进行多数投票，并将所有模糊或缺失的状态指定为重组型以求保守。**\n-   **不正确。** 如推导所示，估计值被夸大，而非不变。其推理（“因为两个位点上的错误是独立的”）是错误的。将缺失状态指定为重组型的建议是一个有严重缺陷的程序，会引入巨大的偏差和灾难性的图谱扩张。\n\n**D. 朴素两点估计值被压缩至约 $r_{\\text{obs}} \\approx 0.100$，因为基因分型错误掩盖了真实的重组体；为防止图谱扩张，应切换到 Kosambi 作图函数，并在排序前将缺失的基因型填补为每个标记上最常见的等位基因。**\n-   **不正确。** 估计值被夸大，而非压缩。提出的解决方案是错误的。切换作图函数解决的是干涉问题，而不是基因分型错误。填补为最常见的等位基因是一种朴素且有偏的方法，会人为地降低估计的重组率。\n\n**E. 朴素两点估计值被夸大了约 $2\\varepsilon$，得到 $r_{\\text{obs}} \\approx 0.160$；为了纠正，应筛选出偏离哈迪-温伯格平衡的标记，然后在不模拟错误或缺失的情况下，固定使相邻重组率之和最小化的标记顺序。**\n-   **不正确。** 近似式 $r_{\\text{obs}} \\approx r + 2\\varepsilon$ 是不准确的；计算表明夸大后的值为 $\\approx 0.150$。回交群体中不期望存在哈迪-温伯格平衡，因此该筛选方法不适用。在没有错误模型的情况下最小化重组率之和是一种朴素的“旅行商”方法，众所周知，这种方法对基因分型错误高度敏感，常常产生错误的图谱。它不能纠正错误，反而受其害。", "answer": "$$\\boxed{B}$$", "id": "2801527"}]}