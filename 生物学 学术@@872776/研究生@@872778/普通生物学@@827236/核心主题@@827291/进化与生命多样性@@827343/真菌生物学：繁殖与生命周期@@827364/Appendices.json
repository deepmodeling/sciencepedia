{"hands_on_practices": [{"introduction": "真菌的繁殖策略多种多样，其中许多担子菌进化出了复杂的多等位基因交配系统，以最大限度地促进异宗交配并维持遗传多样性。本练习将探讨一个经典的四极（双因子）交配系统，要求你运用基本的概率论原理，从第一性原理出发，推导出两个随机选择的单核体菌丝实现亲和交配的精确概率 [@problem_id:2800260]。通过这个计算，你将深入理解交配型位点和等位基因数量如何共同决定群体的远交潜力。", "problem": "一种担子菌具有四极（双因子）交配系统，该系统由两个不连锁的交配型位点（记为 $A$ 和 $B$）控制。每个单核体都是单倍体，在位点 $A$ 和位点 $B$ 上各携带一个等位基因。在位点 $A$ 上有 $n_{A}$ 个不同的等位基因，在位点 $B$ 上有 $n_{B}$ 个不同的等位基因。假设存在一个非常大的随机交配群体，其中每个位点上的各个等位基因因长期平衡选择而保持相同的频率，并且两个位点不连锁，因此 $A$ 和 $B$ 上的等位基因处于连锁平衡状态。两个独立抽样的单核体只有在它们于 $A$ 和 $B$ 两个位点上都携带不同等位基因时才可亲和。\n\n仅从上述定义、基本概率公理以及不连锁位点和单核体独立抽样之间的独立性假设出发，推导两个独立抽样的单核体可亲和的精确概率。将最终答案表示为关于 $n_{A}$ 和 $n_{B}$ 的闭式表达式。不要近似；给出精确表达式。最终答案无需单位。", "solution": "所述问题具有科学依据、提法恰当、客观且内部一致。这是一个群体遗传学中的标准问题，可以使用概率论的基本原理来解决。所有必要信息均已提供。因此，该问题是有效的，我们可以继续进行推导。\n\n设 $M_1$ 和 $M_2$ 是从群体中独立抽样的两个单核体。单核体的交配型由其在两个不连锁位点 $A$ 和 $B$ 上的等位基因决定。设 $M_1$ 的基因型为 $(A_i, B_k)$，$M_2$ 的基因型为 $(A_j, B_l)$，其中 $i, j \\in \\{1, 2, \\dots, n_A\\}$ 且 $k, l \\in \\{1, 2, \\dots, n_B\\}$。\n\n问题指明，两个单核体可亲和的充要条件是它们在位点 $A$ 和位点 $B$ 上均携带不同的等位基因。该条件可表述为 $i \\neq j$ 且 $k \\neq l$。\n\n设 $C$ 为 $M_1$ 和 $M_2$ 可亲和的事件。\n设 $D_A$ 为两个单核体在位点 $A$ 上具有不同等位基因的事件（即 $i \\neq j$）。\n设 $D_B$ 为两个单核体在位点 $B$ 上具有不同等位基因的事件（即 $k \\neq l$）。\n\n可亲和的条件意味着事件 $C$ 是事件 $D_A$ 和 $D_B$ 的交集：\n$$C = D_A \\cap D_B$$\n问题陈述两个位点 $A$ 和 $B$ 不连锁且处于连锁平衡状态。此假设的一个直接推论是事件 $D_A$ 和 $D_B$ 是统计独立的。因此，可亲和概率 $P(C)$ 是这些独立事件概率的乘积：\n$$P(C) = P(D_A \\cap D_B) = P(D_A) P(D_B)$$\n我们的任务简化为计算 $P(D_A)$ 和 $P(D_B)$。两个位点的逻辑完全相同，因此我们首先推导 $P(D_A)$。\n\n更直接的方法是先计算对立事件 $S_A$ 的概率，即两个单核体在位点 $A$ 上具有*相同*等位基因的事件。那么概率 $P(D_A)$ 由下式给出：\n$$P(D_A) = 1 - P(S_A)$$\n问题陈述在位点 $A$ 上有 $n_A$ 个不同的等位基因，且每个等位基因都保持相同的频率。在一个非常大的群体中，这意味着任何特定等位基因（例如 $A_i$）的频率为 $\\frac{1}{n_A}$。因此，抽样得到一个带有等位基因 $A_i$ 的单核体的概率为 $P(A_i) = \\frac{1}{n_A}$。\n\n我们来考虑两个独立抽样的单核体 $M_1$ 和 $M_2$。事件 $S_A$ 发生，当且仅当两个单核体都携带相同的等位基因 $A_1$，或都携带相同的等位基因 $A_2$，...，或都携带相同的等位基因 $A_{n_A}$。这些是互斥事件。\n由于是独立抽样，$M_1$ 和 $M_2$ 都携带特定等位基因 $A_i$ 的概率是：\n$$P(M_1 \\text{ 带有 } A_i \\text{ 且 } M_2 \\text{ 带有 } A_i) = P(M_1 \\text{ 带有 } A_i) \\times P(M_2 \\text{ 带有 } A_i) = \\frac{1}{n_A} \\times \\frac{1}{n_A} = \\frac{1}{n_A^2}$$\n为了求出事件 $S_A$ 的总概率，我们将此概率对所有可能的等位基因求和：\n$$P(S_A) = \\sum_{i=1}^{n_A} P(\\text{ } M_1 \\text{ 和 } M_2 \\text{ 均带有 } A_i) = \\sum_{i=1}^{n_A} \\frac{1}{n_A^2} = n_A \\times \\frac{1}{n_A^2} = \\frac{1}{n_A}$$\n或者，可以这样推理：抽取第一个单核体 $M_1$。它将在位点 $A$ 上拥有某个等位基因。具体是哪个等位基因无关紧要。第二个独立抽样的单核体 $M_2$ 拥有完全相同等位基因的概率，就是该等位基因在群体中的频率，即 $\\frac{1}{n_A}$。\n\n现在我们可以计算两个单核体在位点 $A$ 上具有不同等位基因的概率：\n$$P(D_A) = 1 - P(S_A) = 1 - \\frac{1}{n_A}$$\n对于位点 $B$，通过相同的推理，它有 $n_B$ 个等位基因，每个频率为 $\\frac{1}{n_B}$，两个单核体在位点 $B$ 上具有不同等位基因的概率是：\n$$P(D_B) = 1 - \\frac{1}{n_B}$$\n最后，利用两个位点的独立性，我们将这些结果代回可亲和概率 $P(C)$ 的表达式中：\n$$P(C) = P(D_A) P(D_B) = \\left(1 - \\frac{1}{n_A}\\right) \\left(1 - \\frac{1}{n_B}\\right)$$\n这就是在给定假设下，四极交配系统中两个独立抽样的单核体可亲和的精确闭式表达式。该表达式也可以写作 $\\frac{(n_A - 1)(n_B - 1)}{n_A n_B}$。我们将以第一种形式给出答案。", "answer": "$$\\boxed{\\left(1 - \\frac{1}{n_{A}}\\right)\\left(1 - \\frac{1}{n_{B}}\\right)}$$", "id": "2800260"}, {"introduction": "除了遗传上的亲和性，成功的有性生殖还依赖于交配个体在时间和空间上的相遇。本练习构建了一个随机过程模型，用于量化接合菌在有限的感受态窗口期内成功形成接合孢子的频率 [@problem_id:2800243]。这个模型将菌丝间的相遇率、交配亲和概率以及感受态的持续时间等生物学参数整合在一起，让你能够练习使用泊松过程来描述和预测动态的生物学事件。", "problem": "一种异宗配合的接合菌只有在交配型为 $+$ 的感受态菌丝在其感受期内遇到交配型为 $-$ 的相容菌丝时，才会形成接合孢子囊。假设以下机理模型，该模型基于相遇过程的标准随机描述以及真菌交配相容性的生物学原理：\n\n- 给定的感受态菌丝与邻近菌丝的相遇是一个无记忆过程，以单位时间恒定速率 $\\lambda$ 发生，且在不相交的时间区间内相互独立。这意味着在任何长度为 $t$ 的区间内，总相遇次数服从均值为 $\\lambda t$ 的泊松分布，并且相遇间隔时间服从指数分布。\n- 每次相遇独立地以概率 $p$ 相容（相容性要求交配型相反且生理状态合适），以概率 $1-p$ 不相容。\n- 在第一次相容相遇时，该菌丝立即决定形成接合孢子囊并变为非感受态，因此每条菌丝至多只能形成一个接合孢子囊。\n- 如果在持续时间为 $\\tau$ 的有限感受期内没有发生相容相遇，则该菌丝不会形成接合孢子囊。\n\n仅从上述核心定义（泊松相遇过程、相遇间相容性的独立性、以及在第一次相容相遇时即决定的机制）出发，推导在一个大的感受态菌丝群体中预期的接合孢子囊形成频率。该频率定义为在长度为 $\\tau$ 的感受期内形成至少一个接合孢子囊的菌丝的预期比例。将你的最终答案表示为关于 $\\lambda$、$p$ 和 $\\tau$ 的单个无单位的闭式解析表达式。", "solution": "问题要求的是预期的接合孢子囊形成频率，对于一个大的菌丝群体而言，这等价于单个感受态菌丝形成接合孢子囊的概率。根据问题陈述，当且仅当在持续时间为 $\\tau$ 的感受期内发生至少一次相容相遇时，才会形成接合孢子囊。因此，任务简化为计算此事件的概率。\n\n让我们对相遇过程进行建模。在长度为 $t$ 的时间区间内，与给定菌丝的总相遇次数（包括相容和不相容的）被描述为一个速率恒为 $\\lambda$ 的无记忆过程。这是泊松过程的定义。设 $N(t)$ 是表示在时间区间 $[0, t]$ 内总相遇次数的随机变量。那么 $N(t)$ 服从均值为 $\\lambda t$ 的泊松分布。在此区间内恰好发生 $k$ 次相遇的概率由以下概率质量函数给出：\n$$P(N(t) = k) = \\frac{(\\lambda t)^{k} \\exp(-\\lambda t)}{k!}$$\n对于 $k = 0, 1, 2, \\dots$。\n\n每次相遇独立地以概率 $p$ 被分类为“相容”，或以概率 $1-p$ 被分类为“不相容”。这是一个泊松过程稀疏化的经典例子。泊松过程的一个基本性质指出，如果一个速率为 $\\lambda$ 的泊松过程中的事件以概率 $p$被独立地选择，那么由被选中的事件构成的新过程也是一个泊松过程，其新速率（即“稀疏化”后的速率）为 $\\lambda_c = \\lambda p$。\n\n在我们的情境中，相容相遇流本身就是一个泊松过程。设 $N_c(t)$ 为时间区间 $[0, t]$ 内的相容相遇次数。根据稀疏化性质，$N_c(t)$ 服从均值为 $\\lambda_c t = (\\lambda p)t$ 的泊松分布。在长度为 $t$ 的区间内观察到恰好 $k$ 次相容相遇的概率是：\n$$P(N_c(t) = k) = \\frac{(\\lambda p t)^{k} \\exp(-\\lambda p t)}{k!}$$\n\n如果在持续时间为 $\\tau$ 的感受期内至少有一次相容相遇，就会形成接合孢子囊。这对应于事件 $N_c(\\tau) \\ge 1$。计算上更直接的方法是先计算其互补事件的概率，即在此窗口内没有发生相容相遇。这对应于事件 $N_c(\\tau) = 0$。\n\n使用稀疏化过程 $N_c(t)$ 的概率质量函数，并设 $t = \\tau$ 和 $k=0$，我们求得没有相容相遇的概率：\n$$P(N_c(\\tau) = 0) = \\frac{(\\lambda p \\tau)^{0} \\exp(-\\lambda p \\tau)}{0!}$$\n根据定义，对于任何 $x$，有 $x^0 = 1$，并且 $0! = 1$。因此，概率简化为：\n$$P(N_c(\\tau) = 0) = \\exp(-\\lambda p \\tau)$$\n\n接合孢子囊形成的概率是互补事件 $P(N_c(\\tau) \\ge 1)$ 的概率。它由下式给出：\n$$P(N_c(\\tau) \\ge 1) = 1 - P(N_c(\\tau) = 0)$$\n代入上一步的结果，我们得到：\n$$P(N_c(\\tau) \\ge 1) = 1 - \\exp(-\\lambda p \\tau)$$\n\n根据大数定律，这个概率代表了在一个大群体中成功形成接合孢子囊的菌丝的预期比例。这个表达式就是所要求的关于给定参数 $\\lambda$、$p$ 和 $\\tau$ 的闭式解。", "answer": "$$\n\\boxed{1 - \\exp(-\\lambda p \\tau)}\n$$", "id": "2800243"}, {"introduction": "减数分裂是真菌有性生殖的核心，但基因的传递并非总是遵循孟德尔定律的公平分配。本练习聚焦于一种被称为“孢子杀手”的减数分裂驱动系统，其中某些等位基因会通过杀死携带其对偶基因的孢子来增加自身的遗传频率 [@problem_id:2800309]。你将需要建立一个数学模型来预测这种自私遗传元件在子囊中留下的可观察表型，并进一步利用假设的实验数据，通过最大似然估计来推断其杀伤强度，从而将理论模型与实验数据分析紧密联系起来。", "problem": "一种具有有序子囊的单倍体丝状子囊菌，可以通过允许或抑制单次减数分裂后有丝分裂，来实验性地分别产生八分体（含八个孢子的子囊）或四分体（含四个孢子的子囊）。考虑一个单位点孢子杀手系统，该系统含有一个杀手等位基因 $K$ 和一个敏感等位基因 $k$。在确保杀手位点为杂合的杂交中，每次减数分裂恰好产生4个携带 $K$ 的减数分裂产物和4个携带 $k$ 的减数分裂产物。在可选的减数分裂后有丝分裂之后，八分体因此包含4个 $K$ 基因型孢子和4个 $k$ 基因型孢子，而四分体则包含2个 $K$ 基因型孢子和2个 $k$ 基因型孢子。假设以下经过充分检验的事实和定义：\n- 每个 $K$ 基因型孢子都具有内在抗性，并以概率 $1$ 存活下来成为一个有活力的孢子。\n- 每个 $k$ 基因型孢子都具有内在敏感性，并因孢子致死效应而以概率 $s \\in (0,1)$ 死亡，此事件与子囊中其他孢子无关；因此每个敏感孢子的存活概率为 $1-s$。\n- 除了孢子致死效应外，背景死亡率可忽略不计，并且杀手位点上没有发生基因转换。\n\n基于这些前提，完成以下任务：\n1) 推导实验室使用的两种诊断性子囊表型的期望概率，将其表示为 $s$ 的函数：\n- 在八分体中，表型为“$4\\!:\\!4$ 存活:死亡”（恰好4个存活孢子和4个非存活孢子）。\n- 在四分体中，表型为“$2\\!:\\!2$ 存活:死亡”（恰好2个存活孢子和2个非存活孢子）。\n2) 在一项实验中，实验室对 $N_{8} = 160$ 个八分体进行计数，观察到 $M_{4:4} = 10$ 个八分体具有 $4\\!:\\!4$ 存活:死亡的表型。在抑制了减数分裂后有丝分裂的平行操作中，实验室对 $N_{4} = 400$ 个四分体进行计数，观察到 $M_{2:2} = 100$ 个四分体具有 $2\\!:\\!2$ 存活:死亡的表型。假设各个子囊之间以及两个实验之间是独立的，写出在你的模型下 $s$ 的联合似然函数，并计算 $s$ 的最大似然估计。将最终数值答案四舍五入到四位有效数字。将 $s$ 表示为纯数（无单位）。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n已知条件如下：\n- 一种具有有序子囊的单倍体丝状子囊菌真菌。\n- 两种实验条件：八分体形成（有减数分裂后有丝分裂）或四分体形成（无减数分裂后有丝分裂）。\n- 一个单位点孢子杀手系统，包含等位基因 $K$（杀手）和 $k$（敏感）。\n- 减数分裂是杂合的，在有丝分裂前产生4个 $K$ 产物和4个 $k$ 产物。\n- 八分体包含4个 $K$ 孢子和4个 $k$ 孢子。\n- 四分体包含2个 $K$ 孢子和2个 $k$ 孢子。\n- $K$ 孢子的存活概率为 $1$。\n- $k$ 孢子的死亡概率为 $s$，其中 $s \\in (0,1)$。存活概率为 $1-s$。\n- 孢子死亡是独立事件。\n- 背景死亡率可忽略不计，且无基因转换。\n- 八分体实验数据：总子囊数 $N_8 = 160$；观察到的具有“$4:4$ 存活:死亡”表型的子囊数 $M_{4:4} = 10$。\n- 四分体实验数据：总子囊数 $N_4 = 400$；观察到的具有“$2:2$ 存活:死亡”表型的子囊数 $M_{2:2} = 100$。\n\n对问题进行验证：\n1.  **科学依据**：该问题描述了一个简化但标准的通过孢子致死实现减数分裂驱动的模型，这是真菌遗传学中有据可查的现象。这些假设是构建此类系统一阶数学模型的典型假设。该问题在科学上是合理的。\n2.  **适定性**：问题定义清晰。它要求推导概率并随后对参数 $s$ 进行最大似然估计。所有为找到唯一解所必需的数据和条件都已提供。\n3.  **客观性**：问题以精确、定量的术语陈述，没有主观或含糊不清的语言。\n\n结论是该问题是**有效的**。将构建解答。\n\n**第1部分：子囊表型概率的推导**\n\n设 $P_{4:4}(s)$ 为观察到具有“$4:4$ 存活:死亡”孢子比例的八分体的概率。一个八分体包含4个 $K$ 基因型孢子和4个 $k$ 基因型孢子。基因型为 $K$ 的孢子具有抗性，存活概率为 $1$。因此，这4个 $K$ 孢子总是贡献4个存活孢子。为了使子囊表现出“$4:4$ 存活:死亡”的表型，即总共有4个存活孢子和4个死亡孢子，所有4个敏感孢子（基因型为 $k$）都必须死亡。\n\n单个 $k$ 孢子死亡的概率为 $s$。由于4个独立的 $k$ 孢子的死亡是独立事件，因此它们全部死亡的概率是它们各自死亡概率的乘积：\n$$P(\\text{all } 4 \\text{ } k\\text{-spores die}) = s \\times s \\times s \\times s = s^4$$\n这就是概率 $P_{4:4}(s)$。\n$$P_{4:4}(s) = s^4$$\n\n设 $P_{2:2}(s)$ 为观察到具有“$2:2$ 存活:死亡”孢子比例的四分体的概率。一个四分体包含2个 $K$ 基因型孢子和2个 $k$ 基因型孢子。这2个 $K$ 孢子以概率 $1$ 存活，贡献2个存活孢子。为了使子囊表现出“$2:2$ 存活:死亡”的表型（总共2个存活孢子和2个死亡孢子），两个敏感的 $k$ 孢子都必须死亡。\n\n单个 $k$ 孢子死亡的概率为 $s$。2个独立的 $k$ 孢子的死亡是独立事件。它们都死亡的概率是：\n$$P(\\text{all } 2 \\text{ } k\\text{-spores die}) = s \\times s = s^2$$\n这就是概率 $P_{2:2}(s)$。\n$$P_{2:2}(s) = s^2$$\n\n**第2部分：$s$ 的最大似然估计**\n\n实验结果可以被建模为两个独立的伯努利试验序列。\n\n对于八分体实验，我们有 $N_8 = 160$ 次试验。“成功”定义为观察到一个“$4:4$ 存活:死亡”的子囊，其发生概率为 $p_8 = P_{4:4}(s) = s^4$。观察到的成功次数为 $M_{4:4} = 10$。此实验的似然函数 $L_8(s)$ 由二项概率质量函数给出：\n$$L_8(s) = \\binom{N_8}{M_{4:4}} (p_8)^{M_{4:4}} (1 - p_8)^{N_8 - M_{4:4}} = \\binom{160}{10} (s^4)^{10} (1 - s^4)^{160 - 10} = \\binom{160}{10} s^{40} (1 - s^4)^{150}$$\n\n对于四分体实验，我们有 $N_4 = 400$ 次试验。“成功”定义为观察到一个“$2:2$ 存活:死亡”的子囊，其发生概率为 $p_4 = P_{2:2}(s) = s^2$。观察到的成功次数为 $M_{2:2} = 100$。此实验的似然函数 $L_4(s)$ 为：\n$$L_4(s) = \\binom{N_4}{M_{2:2}} (p_4)^{M_{2:2}} (1 - p_4)^{N_4 - M_{2:2}} = \\binom{400}{100} (s^2)^{100} (1 - s^2)^{400 - 100} = \\binom{400}{100} s^{200} (1 - s^2)^{300}$$\n\n由于两个实验是独立的，联合似然函数 $L(s)$ 是各个似然函数的乘积：\n$$L(s) = L_8(s) L_4(s) = \\binom{160}{10} \\binom{400}{100} s^{40} (1 - s^4)^{150} s^{200} (1 - s^2)^{300}$$\n$$L(s) = C \\cdot s^{240} (1 - s^4)^{150} (1 - s^2)^{300}$$\n其中 $C = \\binom{160}{10} \\binom{400}{100}$ 是一个不依赖于 $s$ 的常数。\n\n为了找到 $s$ 的最大似然估计 (MLE)，我们最大化对数似然函数 $\\ell(s) = \\ln(L(s))$，因为这样做可以简化计算，并且能得到使 $s$ 最大化的相同值。\n$$\\ell(s) = \\ln(C) + 240 \\ln(s) + 150 \\ln(1 - s^4) + 300 \\ln(1 - s^2)$$\n我们通过对 $s$ 求导并令其等于零来找到临界点：\n$$\\frac{d\\ell}{ds} = \\frac{240}{s} + 150 \\left(\\frac{-4s^3}{1 - s^4}\\right) + 300 \\left(\\frac{-2s}{1 - s^2}\\right) = 0$$\n$$\\frac{d\\ell}{ds} = \\frac{240}{s} - \\frac{600s^3}{1 - s^4} - \\frac{600s}{1 - s^2} = 0$$\n由于 $s \\in (0,1)$，我们可以用 $s$ 乘以方程两边：\n$$240 - \\frac{600s^4}{1 - s^4} - \\frac{600s^2}{1 - s^2} = 0$$\n使用因式分解 $1 - s^4 = (1 - s^2)(1 + s^2)$，我们找到一个公分母：\n$$240 - \\frac{600s^4}{(1 - s^2)(1 + s^2)} - \\frac{600s^2(1 + s^2)}{(1 - s^2)(1 + s^2)} = 0$$\n乘以分母 $(1 - s^2)(1 + s^2) = 1 - s^4$，对于 $s \\in (0,1)$，该分母不为零：\n$$240(1 - s^4) - 600s^4 - 600s^2(1 + s^2) = 0$$\n$$240 - 240s^4 - 600s^4 - 600s^2 - 600s^4 = 0$$\n合并同类项：\n$$240 - 600s^2 - (240 + 600 + 600)s^4 = 0$$\n$$240 - 600s^2 - 1440s^4 = 0$$\n将整个方程除以 $-120$：\n$$12s^4 + 5s^2 - 2 = 0$$\n这是一个关于 $s^2$ 的二次方程。令 $x = s^2$。由于 $s \\in (0,1)$，$x$ 必须在 $(0,1)$ 区间内。方程变为：\n$$12x^2 + 5x - 2 = 0$$\n我们使用二次方程求根公式 $x = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $x$：\n$$x = \\frac{-5 \\pm \\sqrt{5^2 - 4(12)(-2)}}{2(12)} = \\frac{-5 \\pm \\sqrt{25 + 96}}{24} = \\frac{-5 \\pm \\sqrt{121}}{24} = \\frac{-5 \\pm 11}{24}$$\n这给出了 $x$ 的两个可能解：\n$$x_1 = \\frac{-5 + 11}{24} = \\frac{6}{24} = \\frac{1}{4}$$\n$$x_2 = \\frac{-5 - 11}{24} = \\frac{-16}{24} = -\\frac{2}{3}$$\n因为 $x = s^2$，$x$ 必须为非负数。因此我们舍弃解 $x_2 = -2/3$。唯一有效的解是 $x = 1/4$。\n$$s^2 = \\frac{1}{4}$$\n因为 $s$ 是一个概率，且已知在 $(0,1)$ 区间内，我们必须取正平方根：\n$$s = \\sqrt{\\frac{1}{4}} = \\frac{1}{2} = 0.5$$\n$s$ 的最大似然估计是 $0.5$。问题要求答案四舍五入到四位有效数字。\n\n最终值：$\\hat{s} = 0.5000$。", "answer": "$$ \\boxed{0.5000} $$", "id": "2800309"}]}