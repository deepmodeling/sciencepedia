{"hands_on_practices": [{"introduction": "有效种群大小（$N_e$）的概念是理解遗传漂变的基础。它通过定义一个理想化种群的大小——该种群将经历与我们实际种群相同程度的漂变——来为漂变速率提供一个标准化的衡量标准。这项基于第一性原理的练习 [@problem_id:2801288] 将指导您在一个常见情景（即繁殖雄性和雌性数量不等）中推导 $N_e$ 的公式，从而将溯祖的抽象概念与一个具体的种群统计学因素联系起来。", "problem": "一个岛屿有蹄类种群经历了一次剧烈的瓶颈效应，使得在单一代内，只有一部分成年个体参与繁殖。野外数据表明，恰好有 $N_m$ 个雄性和 $N_f$ 个雌性为下一代提供了配子，其中 $N_m = 30$ 且 $N_f = 70$。假设该物种为雌雄异体，遵循常染色体遗传，世代不重叠，随机交配，且每个性别内部的繁殖成功率方差相等（即 Wright–Fisher (WF) 模型的理想化假设）。将有效种群大小（N_e）定义为：一个理想的 WF 二倍体繁殖种群，其大小应使得从子代中随机抽取的两个常染色体基因谱系，其单代溯祖合并概率与实际种群相同。\n\n严格从该定义出发，并基于以下事实：对于雌雄异体物种的常染色体，一个随机选择的基因谱系追溯到雄性亲本或雌性亲本的概率各为 $1/2$，推导出一个以 $N_m$ 和 $N_f$ 为函数的 $N_e$ 的封闭形式表达式。然后，将 $N_m = 30$ 和 $N_f = 70$ 代入你的表达式中进行计算，并报告 $N_e$ 的数值。将最终答案表示为一个无单位的实数。如果需要四舍五入，则保留四位有效数字；但如果结果为整数，请报告精确值。", "solution": "该问题要求推导一个繁殖雄性数量（$N_m$）和雌性数量（$N_f$）不等的雌雄异体种群的有效种群大小 $N_e$。推导过程必须从问题陈述中提供的 $N_e$ 的第一性原理定义出发。\n\n首先对问题进行验证。\n**第一步：提取已知条件**\n- 种群结构：雌雄异体物种，常染色体遗传，世代不重叠，随机交配。\n- 繁殖种群数量：$N_m = 30$ 个雄性和 $N_f = 70$ 个雌性。\n- 模型假设：Wright–Fisher (WF) 模型的理想化假设在每个性别内部均适用。\n- $N_e$ 的定义：一个理想的 WF 二倍体繁殖种群的大小，该种群的单代溯祖合并概率与实际种群相同。\n- 基本前提：一个随机选择的常染色体基因谱系追溯到雄性或雌性亲本的概率各为 $\\frac{1}{2}$。\n- 任务：\n  1. 推导 $N_e$ 作为 $N_m$ 和 $N_f$ 函数的封闭形式表达式。\n  2. 根据给定的 $N_m = 30$ 和 $N_f = 70$ 计算 $N_e$。\n\n**第二步：验证**\n该问题在科学上基于群体遗传学，特别是遗传漂变和有效种群大小的理论。问题陈述清晰，提供了明确的定义和足够的信息以获得唯一解。语言客观，参数具有生物学上的合理性。该问题是理论生物学中一个标准的、非平凡的练习。因此，该问题被认为是有效的。\n\n**第三步：求解推导**\n推导过程通过将实际种群中的溯祖合并概率与理想参考种群中的概率相等来展开。\n\n首先，我们计算在指定种群中，从子代中随机抽取的两个基因谱系的单代溯祖合并概率 $P_{coal, actual}$。设这两个谱系为 $L_1$ 和 $L_2$。根据给定的前提，对于每个谱系，追溯到雄性亲本的概率为 $\\frac{1}{2}$，追溯到雌性亲本的概率也为 $\\frac{1}{2}$。由于两个谱系的亲本来源是独立事件，我们可以定义四种关于亲本性别的互斥情况：\n1.  两个谱系都追溯到雄性亲本。此事件的概率为 $(\\frac{1}{2}) \\times (\\frac{1}{2}) = \\frac{1}{4}$。\n2.  两个谱系都追溯到雌性亲本。此事件的概率为 $(\\frac{1}{2}) \\times (\\frac{1}{2}) = \\frac{1}{4}$。\n3.  谱系 $L_1$ 追溯到雄性亲本，而 $L_2$ 追溯到雌性亲本。概率为 $(\\frac{1}{2}) \\times (\\frac{1}{2}) = \\frac{1}{4}$。\n4.  谱系 $L_1$ 追溯到雌性亲本，而 $L_2$ 追溯到雄性亲本。概率为 $(\\frac{1}{2}) \\times (\\frac{1}{2}) = \\frac{1}{4}$。\n\n现在，我们确定每种情况下的条件合并概率。如果两个谱系都追溯到同一个亲本个体，则发生溯祖合并。\n- 在情况1中，两个谱系都追溯到由 $N_m$ 个雄性组成的父本池。在随机交配和繁殖成功率方差相等的假设下（如 WF 模型），$N_m$ 个雄性中每一个成为亲本的机会均等。两个谱系都追溯到同一个特定雄性的概率是 $\\frac{1}{N_m}$。\n- 在情况2中，两个谱系都追溯到由 $N_f$ 个雌性组成的母本池。根据相同的逻辑，它们追溯到同一个特定雌性的概率是 $\\frac{1}{N_f}$。\n- 在情况3和4中，谱系追溯到不同性别的亲本。因此，它们不可能在亲代发生溯祖合并，合并概率为 $0$。\n\n总的溯祖合并概率 $P_{coal, actual}$ 是这些路径概率的总和：\n$$P_{coal, actual} = \\left(\\frac{1}{4} \\times \\frac{1}{N_m}\\right) + \\left(\\frac{1}{4} \\times \\frac{1}{N_f}\\right) + \\left(\\frac{1}{4} \\times 0\\right) + \\left(\\frac{1}{4} \\times 0\\right)$$\n$$P_{coal, actual} = \\frac{1}{4N_m} + \\frac{1}{4N_f}$$\n此表达式可简化为：\n$$P_{coal, actual} = \\frac{1}{4} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) = \\frac{1}{4} \\left( \\frac{N_f + N_m}{N_m N_f} \\right)$$\n\n接下来，我们确定理想参考种群的溯祖合并概率 $P_{coal, ideal}$。问题指定了一个大小为 $N_e$ 的“理想 WF 二倍体繁殖种群”。虽然最简单的 WF 模型是雌雄同体的，但这里的背景是一个雌雄异体的物种。一个一致的比较需要一个具有相同基本繁殖生物学的参考种群。因此，理想种群被解释为一个大小为 $N_e$ 且性别比平衡的雌雄异体种群，即 $N_m' = N_e/2$ 且 $N_f' = N_e/2$。我们将与上面相同的逻辑应用于这个理想种群：\n$$P_{coal, ideal} = \\frac{1}{4N_m'} + \\frac{1}{4N_f'} = \\frac{1}{4(\\frac{N_e}{2})} + \\frac{1}{4(\\frac{N_e}{2})}$$\n$$P_{coal, ideal} = \\frac{1}{2N_e} + \\frac{1}{2N_e} = \\frac{2}{2N_e} = \\frac{1}{N_e}$$\n\n问题将 $N_e$ 定义为使溯祖合并概率相等的种群大小：$P_{coal, actual} = P_{coal, ideal}$。\n$$\\frac{1}{4} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) = \\frac{1}{N_e}$$\n求解 $N_e$：\n$$N_e = \\frac{4}{\\frac{1}{N_m} + \\frac{1}{N_f}}$$\n这是雄性和雌性数量的调和平均数乘以4。进一步简化该表达式，得到所要求的封闭形式：\n$$N_e = \\frac{4}{\\frac{N_f + N_m}{N_m N_f}} = \\frac{4 N_m N_f}{N_m + N_f}$$\n这就是推导出的有效种群大小的封闭形式表达式。\n\n最后，我们将给定的值 $N_m = 30$ 和 $N_f = 70$ 代入此表达式进行计算。\n$$N_e = \\frac{4 \\times 30 \\times 70}{30 + 70}$$\n$$N_e = \\frac{4 \\times 2100}{100}$$\n$$N_e = 4 \\times 21$$\n$$N_e = 84$$\n有效种群大小为 $84$。繁殖种群的总普查规模为 $N = N_m + N_f = 30 + 70 = 100$。偏斜的性别比使有效种群大小降低到普查规模的 $84\\%$，这说明了不平等的亲本贡献对遗传漂变速率的影响。", "answer": "$$\\boxed{84}$$", "id": "2801288"}, {"introduction": "在牢固掌握了有效种群大小的概念之后，我们现在可以模拟其对种群遗传构成随时间产生的直接影响。这项练习 [@problem_id:2801278] 探讨了遗传漂变如何导致预期杂合度（衡量遗传多样性的主要指标）发生可预测的衰减。通过从因共同祖先而一致（identity by descent, IBD）的概率出发推导该关系，您将对小种群中遗传变异不可避免的丧失获得定量的理解。", "problem": "一个二倍体脊椎动物种群经历了一次严重的栖息地收缩，其持续时间足以导致有效种群大小的持续减小。紧随收缩之后，在一个中性、共显性基因座上测得的预期杂合度为 $H_0 = 0.8$。在随后的 $t = 20$ 个不重叠世代中，该种群可以用一个具有恒定有效种群大小 $N_e = 250$、随机交配、无突变、无迁移和无选择的Wright-Fisher过程来近似。仅使用Wright-Fisher模型下随机遗传漂变的基本原理以及同源相同和杂合度的定义，确定 $t = 20$ 个世代后的预期杂合度。将你的答案表示为无单位的小数，并四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n从陈述中逐字提取的已知条件如下：\n- 一个二倍体脊椎动物种群。\n- 在一个中性、共显性基因座上的初始预期杂合度：$H_0 = 0.8$。\n- 时间跨度：$t = 20$ 个不重叠世代。\n- 恒定有效种群大小：$N_e = 250$。\n- 模型假设：Wright-Fisher过程、随机交配、无突变、无迁移、无选择。\n- 任务：确定 $t = 20$ 个世代后的预期杂合度。\n- 约束：仅使用Wright-Fisher模型下随机遗传漂变的基本原理以及同源相同和杂合度的定义。\n- 输出格式：无单位小数，四舍五入到四位有效数字。\n\n对问题进行有效性评估。该问题科学地基于群体遗传学原理，特别是随机遗传漂变的Wright-Fisher模型。问题提法明确，提供了所有必要参数（$H_0$、$N_e$、$t$）和一个清晰的理论框架以得出唯一解。语言客观而精确。问题是自洽的、一致的，并且需要应用基本理论，因此并非微不足道。结论是该问题有效。\n\n按要求，解题过程从基本原理出发。设 $H_t$ 为第 $t$ 代的预期杂合度，定义为从种群中随机抽取的两个等位基因非同源相同（IBD）的概率。设 $F_t$ 为随机抽取的两个等位基因为IBD的概率。根据定义，这两个概率是互补的：\n$$ H_t = 1 - F_t $$\n核心任务是建立 $H_t$ 在一个世代内的递推关系。我们首先推导 $F_t$ 的递推关系。在一个有效种群大小为 $N_e$ 的二倍体Wright-Fisher种群中，任何一代的基因库中都有 $2N_e$ 个等位基因。考虑在第 $t$ 代从种群中随机抽取的两个等位基因。我们追溯它们的祖先到第 $t-1$ 代。\n\n这两个等位基因的来源有两种互斥的可能性：\n1.  它们是来自第 $t-1$ 代的*同一个*亲本等位基因的拷贝。选中一个特定等位基因的概率是 $\\frac{1}{2N_e}$，而选中第二个等位基因且它是同一个亲本等位基因的拷贝的概率也是 $\\frac{1}{2N_e}$。随机选中的两个等位基因源自上一代同一个祖先等位基因的概率是 $\\frac{1}{2N_e}$。在这种情况下，根据定义，它们是IBD。此路径对 $F_t$ 的概率贡献为 $\\frac{1}{2N_e} \\times 1 = \\frac{1}{2N_e}$。\n\n2.  它们是来自第 $t-1$ 代的*不同*亲本等位基因的拷贝。此事件的概率是第一种情况的补集，即 $1 - \\frac{1}{2N_e}$。如果这两个等位基因源自不同的亲本等位基因，那么它们在第 $t$ 代是IBD的条件是，它们在第 $t-1$ 代的各自亲本等位基因已经是IBD。根据定义，此概率为 $F_{t-1}$。此路径对 $F_t$ 的概率贡献为 $\\left(1 - \\frac{1}{2N_e}\\right) F_{t-1}$。\n\n将这两种概率相加，得到同源相同概率的递推关系：\n$$ F_t = \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right) F_{t-1} $$\n为了找到杂合度的递推关系，我们将 $F_t = 1 - H_t$ 和 $F_{t-1} = 1 - H_{t-1}$ 代入此方程：\n$$ 1 - H_t = \\frac{1}{2N_e} + \\left(1 - \\frac{1}{2N_e}\\right) (1 - H_{t-1}) $$\n展开右侧：\n$$ 1 - H_t = \\frac{1}{2N_e} + 1 - \\frac{1}{2N_e} - \\left(1 - \\frac{1}{2N_e}\\right) H_{t-1} $$\n简化表达式：\n$$ 1 - H_t = 1 - \\left(1 - \\frac{1}{2N_e}\\right) H_{t-1} $$\n$$ -H_t = - \\left(1 - \\frac{1}{2N_e}\\right) H_{t-1} $$\n$$ H_t = \\left(1 - \\frac{1}{2N_e}\\right) H_{t-1} $$\n这个递推关系表明，由于遗传漂变，杂合度随世代呈几何级数衰减。从初始杂合度 $H_0$ 开始，经过 $t$ 个世代后，$H_t$ 的通解为：\n$$ H_t = H_0 \\left(1 - \\frac{1}{2N_e}\\right)^t $$\n问题提供了以下数值：$H_0 = 0.8$，$N_e = 250$，以及 $t = 20$。我们将这些值代入方程。每代的衰减因子为：\n$$ 1 - \\frac{1}{2N_e} = 1 - \\frac{1}{2 \\times 250} = 1 - \\frac{1}{500} = 1 - 0.002 = 0.998 $$\n现在，我们计算 $t = 20$ 个世代后的预期杂合度，记为 $H_{20}$：\n$$ H_{20} = H_0 \\left(0.998\\right)^{20} = 0.8 \\times \\left(0.998\\right)^{20} $$\n首先，我们计算 $\\left(0.998\\right)^{20}$ 这一项：\n$$ \\left(0.998\\right)^{20} \\approx 0.960773305 $$\n接下来，我们将此结果乘以初始杂合度 $H_0 = 0.8$：\n$$ H_{20} \\approx 0.8 \\times 0.960773305 \\approx 0.768618644 $$\n问题要求答案四舍五入到四位有效数字。\n$$ H_{20} \\approx 0.7686 $$\n这就是在指定条件下，第 $t=20$ 代的预期杂合度。", "answer": "$$\\boxed{0.7686}$$", "id": "2801278"}, {"introduction": "除了降低整体杂合度外，遗传漂变（尤其是在极端的瓶颈事件中）对单个等位基因的命运也具有巨大影响。这项练习 [@problem_id:2801279] 运用二项式抽样的原理，来量化一个稀有等位基因在单次剧烈的种群崩溃中存活下来的概率。这项计算有力地揭示了为什么奠基者效应和瓶颈能够清除等位基因变异，并导致种群从其祖先群体中快速分化出去。", "problem": "一个大的、随机交配的二倍体群体经历了一个单代的种群瓶颈，其普查规模降至 $N_b=25$ 个二倍体个体，之后群体规模恢复到其原始的大数值。考虑一个选择中性的等位基因 $A$，其在瓶颈前的群体频率为 $p=0.1$。假设这个单代瓶颈遵循标准的 Wright–Fisher 抽样假设：中性、配子随机结合，并且瓶颈代中的 $2N_b$ 个基因拷贝是从瓶颈前的配子库中独立抽取的。\n\n从基本原理出发，即在这些假设下，瓶颈代中 $2N_b$ 个基因拷贝中等位基因 $A$ 的拷贝数遵循一个二项分布，其参数由试验次数和等位基因频率给出。请推导出一个表达式，用 $p$ 和 $N_b$ 表示等位基因 $A$ 在瓶颈期间不丢失（即在 $2N_b$ 个抽取的基因拷贝中至少出现一次）的概率。然后，对于 $N_b=25$ 和 $p=0.1$ 的情况，计算这个概率。\n\n将最终概率表示为小数，并将您的答案四舍五入到六位有效数字。", "solution": "问题陈述提出了群体遗传学中的一个标准问题，该问题基于 Wright-Fisher 遗传漂变模型。所有提供的参数和假设在科学上都是合理的、一致的，并且足以推导出一个唯一的解。因此，该问题被认为是有效的。\n\n问题要求我们推导一个选择中性的等位基因 $A$（初始频率为 $p$）在经历一个大小为 $N_b$ 个二倍体个体的单代瓶颈后不丢失的概率。\n\n问题的核心在于抽样过程。构成瓶颈代的 $2N_b$ 个基因拷贝是从瓶颈前的群体中有放回地抽样（或者说从一个有效无限大的配子库中抽样）得到的。设随机变量 $X$ 表示瓶颈代中 $2N_b$ 个基因拷贝中等位基因 $A$ 的拷贝数。\n\n正如问题所述，在 Wright-Fisher 假设下，$X$ 遵循二项分布。该分布的参数是：\n1.  独立试验的次数 $n$，即抽取的基因拷贝总数。对于一个大小为 $N_b$ 的二倍体群体，这个数是 $n = 2N_b$。\n2.  单次试验中成功的概率，即抽样得到一个等位基因 $A$ 的概率。这等于该等位基因在瓶颈前群体中的频率 $p$。\n\n因此，$X$ 的分布为 $X \\sim \\text{Binomial}(n, p)$，其中 $n=2N_b$。获得恰好 $k$ 个等位基因 $A$ 拷贝的概率质量函数是：\n$$P(X=k) = \\binom{n}{k} p^k (1-p)^{n-k}$$\n用 $N_b$ 表示为：\n$$P(X=k) = \\binom{2N_b}{k} p^k (1-p)^{2N_b-k}$$\n\n如果等位基因 $A$ 在瓶颈代中的计数至少为一，则它“没有丢失”。在数学上，这对应于事件 $X \\ge 1$。该事件的概率是 $P(X \\ge 1)$。\n\n计算其互补事件的概率更为直接：等位基因 $A$ 丢失。这当且仅当等位基因 $A$ 的拷贝数恰好为零时发生，即事件 $X=0$。\n使用 $k=0$ 的二项概率公式：\n$$P(\\text{loss}) = P(X=0) = \\binom{2N_b}{0} p^0 (1-p)^{2N_b - 0}$$\n由于 $\\binom{2N_b}{0} = 1$ 且 $p^0 = 1$，该式简化为：\n$$P(\\text{loss}) = (1-p)^{2N_b}$$\n\n因此，等位基因*不*丢失的概率 $P(\\text{survival})$ 是 $1$ 减去它丢失的概率：\n$$P(\\text{survival}) = P(X \\ge 1) = 1 - P(X=0)$$\n代入 $P(X=0)$ 的表达式，我们得到等位基因存活概率的通用公式：\n$$P(\\text{survival}) = 1 - (1-p)^{2N_b}$$\n这就完成了问题的第一部分。\n\n对于第二部分，我们必须使用给定的数值来评估这个概率：瓶颈普查规模为 $N_b = 25$ 个个体，初始等位基因频率为 $p=0.1$。\n\n首先，我们计算瓶颈中的基因拷贝总数：\n$$n = 2N_b = 2 \\times 25 = 50$$\n现在，我们将 $n=50$ 和 $p=0.1$ 代入存活概率公式：\n$$P(\\text{survival}) = 1 - (1 - 0.1)^{50} = 1 - (0.9)^{50}$$\n我们现在必须计算 $(0.9)^{50}$ 的值：\n$$(0.9)^{50} \\approx 0.0051537752$$\n将此值代回我们的存活概率表达式中，得到：\n$$P(\\text{survival}) = 1 - 0.0051537752 \\approx 0.9948462248$$\n问题要求答案四舍五入到六位有效数字。前六位有效数字是 $9$、$9$、$4$、$8$、$4$、$6$。第七位数字是 $2$，小于 $5$，所以我们不对第六位数字进行进位。\n最终的数值答案是 $0.994846$。", "answer": "$$\\boxed{0.994846}$$", "id": "2801279"}]}