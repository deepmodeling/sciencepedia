{"hands_on_practices": [{"introduction": "蛋白质的结构稳定性是其功能的基础，而这种稳定性由热力学定律决定。本练习将通过一个核心计算，帮助你掌握如何运用吉布斯自由能（$G$）来判断蛋白质折叠过程的自发性[@problem_id:2935910]。通过分析焓变（$\\Delta H$）和熵变（$\\Delta S$）对自由能的贡献，你将能够量化驱动蛋白质折叠的力，并理解温度如何调节这一精妙的平衡。", "problem": "一个单结构域蛋白质在近似恒压的水性缓冲液中可逆地折叠。在参考温度 $T_{0} = 298\\ \\text{K}$ 下，量热法测量得到折叠的焓变为 $\\Delta H = -200\\ \\text{kJ mol}^{-1}$，折叠的熵变为 $\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$。在 $T_{0}$ 附近温度范围内，假设热容变化可忽略不计，因此 $\\Delta H$ 和 $\\Delta S$ 实际上不随温度变化。从适用于恒温恒压过程的基本热力学定义出发，推导折叠自由能变随温度变化的适当表达式，并用它来评估在 $T_{0}$ 时折叠是否是有利的。然后，评估焓贡献和熵贡献之间的平衡如何随着温度升高而变化，并确定折叠驱动力改变符号的温度（如果存在）。\n\n为了评分，请仅报告在 $T_{0} = 298\\ \\text{K}$ 时折叠的吉布斯自由能变的数值，单位为 $\\text{kJ mol}^{-1}$，并四舍五入到三位有效数字。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n逐字提取给定信息：\n1.  该过程是一个单结构域蛋白质在近似恒压的水性缓冲液中的可逆折叠。\n2.  参考温度为 $T_{0} = 298\\ \\text{K}$。\n3.  折叠的焓变为 $\\Delta H = -200\\ \\text{kJ mol}^{-1}$。\n4.  折叠的熵变为 $\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$。\n5.  假设热容变化可忽略不计，使得 $\\Delta H$ 和 $\\Delta S$ 在 $T_{0}$ 附近不随温度变化。\n\n问题验证：\n该问题科学地基于应用于生物聚合物的化学热力学原理。所提供的折叠焓值和熵值在物理上是现实的：折叠过程通常是放热的（$\\Delta H  0$），这是由于形成了有利的分子内相互作用（氢键、范德华接触、疏水效应）；并且在熵上是不利的（$\\Delta S  0$），因为多肽链从无序的高熵展开状态转变为一个独特的、有序的低熵天然结构。假设热容变化 $\\Delta C_p$ 可忽略不计，是入门级问题中常见的简化，尽管实际上蛋白质折叠表现出显著的正 $\\Delta C_p$。然而，由于这是问题框架内的明确假设，它不会使问题无效。该问题是适定的、客观的，并包含唯一解所需的所有必要信息。因此，该问题被认为是有效的。\n\n求解过程如下。\n\n对于在恒温 $T$ 和恒压下发生的过程，吉布斯自由能的变化 $\\Delta G$ 是自发性的基本判据。它由吉布斯-亥姆霍兹方程定义：\n$$\n\\Delta G = \\Delta H - T\\Delta S\n$$\n其中 $\\Delta H$ 是焓变，$\\Delta S$ 是熵变。\n\n问题要求一个自由能变随温度变化的表达式。根据所提供的假设，即 $\\Delta H$ 和 $\\Delta S$ 相对于温度是恒定的，上述方程，\n$$\n\\Delta G(T) = \\Delta H - T\\Delta S\n$$\n直接作为所需的表达式，其中 $\\Delta H$ 和 $\\Delta S$ 是给定的常数值。\n\n接下来，我们评估在参考温度 $T_{0} = 298\\ \\text{K}$ 时折叠是否是有利的。如果一个过程的吉布斯自由能变为负（$\\Delta G  0$），那么它在热力学上是有利的，即自发的。我们可以使用提供的数据计算在 $T_0$ 时的 $\\Delta G$：\n$\\Delta H = -200\\ \\text{kJ mol}^{-1}$\n$\\Delta S = -0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}$\n$T_{0} = 298\\ \\text{K}$\n\n将这些值代入吉布斯自由能方程：\n$$\n\\Delta G(T_0) = \\Delta H - T_{0}\\Delta S\n$$\n$$\n\\Delta G(298\\ \\text{K}) = (-200\\ \\text{kJ mol}^{-1}) - (298\\ \\text{K})(-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1})\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -200\\ \\text{kJ mol}^{-1} + (298 \\times 0.6)\\ \\text{kJ mol}^{-1}\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -200\\ \\text{kJ mol}^{-1} + 178.8\\ \\text{kJ mol}^{-1}\n$$\n$$\n\\Delta G(298\\ \\text{K}) = -21.2\\ \\text{kJ mol}^{-1}\n$$\n由于 $\\Delta G(298\\ \\text{K}) = -21.2\\ \\text{kJ mol}^{-1}$ 为负值，因此在参考温度 $T_0 = 298\\ \\text{K}$ 下，折叠过程是自发的，因而是有利的。\n\n现在我们评估随着温度变化，焓贡献和熵贡献之间的平衡。总自由能变 $\\Delta G$ 是焓贡献 $\\Delta H$ 和熵贡献 $-T\\Delta S$ 的总和。\n焓项 $\\Delta H = -200\\ \\text{kJ mol}^{-1}$ 是恒定的，并且强烈地有利于折叠。\n熵项 $-T\\Delta S = -T(-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}) = 0.6T\\ \\text{kJ mol}^{-1}$ 不利于折叠，其大小随绝对温度 $T$ 线性增加。\n在低温下，有利的焓项占主导地位，导致 $\\Delta G$ 为负和自发折叠。随着温度升高，不利的熵项的大小增加，并越来越抵消有利的焓。\n\n折叠的驱动力在 $\\Delta G = 0$ 的温度下改变符号。这个温度通常表示为熔点或转变温度 $T_m$，代表折叠态和展开态之间的平衡点。我们通过设置 $\\Delta G(T_m) = 0$ 来找到这个温度：\n$$\n\\Delta G(T_m) = \\Delta H - T_{m}\\Delta S = 0\n$$\n求解 $T_m$：\n$$\nT_{m} = \\frac{\\Delta H}{\\Delta S}\n$$\n代入给定值：\n$$\nT_{m} = \\frac{-200\\ \\text{kJ mol}^{-1}}{-0.6\\ \\text{kJ mol}^{-1}\\text{K}^{-1}} = \\frac{200}{0.6}\\ \\text{K} = \\frac{1000}{3}\\ \\text{K} \\approx 333.3\\ \\text{K}\n$$\n在 $T = T_m \\approx 333.3\\ \\text{K}$ (或 $60.15\\ ^{\\circ}\\text{C}$) 时，有利的焓贡献与不利的熵贡献完全平衡，蛋白质处于平衡状态。对于温度 $T > T_m$，项 $-T\\Delta S$ 的绝对值将大于 $\\Delta H$，使得 $\\Delta G$ 为正，导致展开（变性）成为自发过程。这种现象被称为热变性。\n\n问题要求在 $T_{0} = 298\\ \\text{K}$ 时折叠的吉布斯自由能变的数值，单位为 $\\text{kJ mol}^{-1}$，并四舍五入到三位有效数字。如前计算，该值为 $-21.2\\ \\text{kJ mol}^{-1}$。", "answer": "$$\\boxed{-21.2}$$", "id": "2935910"}, {"introduction": "生物分子的功能往往体现在其动力学行为上，尤其是在酶催化反应中。本练习旨在让你深入理解酶抑制剂如何调控反应速率，这是药物设计和代谢通路分析的核心[@problem_id:2935907]。通过从头推导竞争性与非竞争性抑制的动力学方程，你将学会如何利用表观米氏常数（$K_M^{\\text{app}}$）和最大反应速率（$V_{\\text{max}}^{\\text{app}}$）的变化来区分不同的抑制机制。", "problem": "在恒定温度的缓冲溶液中，于初始速率条件下研究一种遵循 Michaelis–Menten (MM) 机理 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 的酶，其中产物浓度可忽略不计 ($[P] \\approx 0$)。稳态近似成立，底物与活性位点的结合是一个非扩散限制的可逆步骤。除非被抑制剂结合明确改变，否则转换数 $k_{\\text{cat}}$ 在所有条件下均保持不变。\n\n现给出在无抑制剂存在下测得的以下生化参数：\n- 米氏常数：$K_M = 5.0~\\mu\\mathrm{M}$。\n- 转换数：$k_{\\text{cat}} = 50~\\mathrm{s}^{-1}$。\n- 总酶浓度：$[E]_T = 10~\\mathrm{nM}$。\n- 所有测定中的底物浓度：$[S] = 20~\\mu\\mathrm{M}$。\n\n分别研究了两种抑制模式：\n- 竞争性抑制：抑制剂 $I_c$ 只与游离酶结合，抑制剂浓度为 $[I_c] = 15~\\mu\\mathrm{M}$，抑制常数为 $K_i^{(c)} = 3.0~\\mu\\mathrm{M}$。\n- 纯非竞争性抑制：抑制剂 $I_n$ 与 $E$ 和 $ES$ 以相同的亲和力结合（酶的底物亲和力不变），抑制剂浓度为 $[I_n] = 8.0~\\mu\\mathrm{M}$，抑制常数为 $K_i^{(n)} = 2.0~\\mu\\mathrm{M}$。$I_n$ 的结合不改变 $ES$ 本身的 $k_{\\text{cat}}$，但使被抑制的复合物不具催化能力。\n\n从 MM 机理和稳态定义 $v = k_{\\text{cat}}[ES]$ 出发，结合抑制常数的热力学定义（例如，对于相应的被抑制复合物，$K_i = [E][I]/[EI]$）和总酶的质量平衡，执行以下操作：\n\n- 在给定的 $[S]$, $[E]_T$, $[I_c]$ 和 $K_i^{(c)}$ 条件下，推导竞争性抑制下的初始速率 $v_{\\text{comp}}$，并确定此模式下的表观参数 $K_M^{\\text{app}}$ 和 $V_{\\max}^{\\text{app}}$。\n- 在给定的 $[S]$, $[E]_T$, $[I_n]$ 和 $K_i^{(n)}$ 条件下，推导纯非竞争性抑制下的初始速率 $v_{\\text{noncomp}}$，并确定此模式下的表观参数 $K_M^{\\text{app}}$ 和 $V_{\\max}^{\\text{app}}$。\n- 使用你推导出的表达式和所提供的数值，计算无量纲标量\n$$Q \\equiv \\frac{v_{\\text{comp}}}{v_{\\text{noncomp}}} \\times \\frac{K_M^{\\text{app}}(\\text{competitive})}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}^{\\text{app}}(\\text{noncompetitive})}.$$\n\n在你的推导过程中，以 $\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$ 为单位报告 $v_{\\text{comp}}$ 和 $v_{\\text{noncomp}}$ 以验证一致性，但最终要求的量是 $Q$。将 $Q$ 的最终答案表示为一个纯数，并四舍五入到四位有效数字。", "solution": "该问题已经过验证，被认为是科学上可靠、提法得当且无矛盾或歧义的。它代表了酶动力学中的一个标准问题。我们将进行严格的推导。\n\nMichaelis-Menten (MM) 模型下酶动力学的基本方程由初始速率 $v$ 给出：\n$$v = \\frac{V_{\\max}[S]}{K_M + [S]}$$\n其中 $V_{\\max}$ 是最大速率，$K_M$ 是米氏常数，$[S]$ 是底物浓度。最大速率与总酶浓度 $[E]_T$ 和转换数 $k_{\\text{cat}}$ 的关系为 $V_{\\max} = k_{\\text{cat}}[E]_T$。\n\n首先，我们使用所给参数计算未受抑制的最大速率 $V_{\\max}$。总酶浓度为 $[E]_T = 10~\\mathrm{nM} = 1.0 \\times 10^{-2}~\\mu\\mathrm{M}$。\n$$V_{\\max} = k_{\\text{cat}}[E]_T = (50~\\mathrm{s}^{-1})(1.0 \\times 10^{-2}~\\mu\\mathrm{M}) = 0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\n第 1 部分：竞争性抑制\n\n在竞争性抑制中，抑制剂 $I_c$ 可逆地与游离酶 $E$ 结合，形成无活性的复合物 $EI_c$。反应方案包括平衡 $E + I_c \\rightleftharpoons EI_c$，其特征由抑制常数 $K_i^{(c)} = \\frac{[E][I_c]}{[EI_c]}$ 描述。\n总酶浓度 $[E]_T$ 分布在三种物质中：游离酶 $[E]$、酶-底物复合物 $[ES]$ 和酶-抑制剂复合物 $[EI_c]$。\n$$[E]_T = [E] + [ES] + [EI_c]$$\n使用底物结合的稳态关系 $[E][S] = K_M[ES]$ 和 $K_i^{(c)}$ 的定义，我们可以用 $[ES]$ 来表示 $[E]$ 和 $[EI_c]$：\n$$[E] = \\frac{K_M[ES]}{[S]}$$\n$$[EI_c] = \\frac{[E][I_c]}{K_i^{(c)}} = \\left(\\frac{K_M[ES]}{[S]}\\right) \\frac{[I_c]}{K_i^{(c)}}$$\n将这些表达式代入质量平衡方程：\n$$[E]_T = \\frac{K_M[ES]}{[S]} + [ES] + \\frac{K_M[ES][I_c]}{K_i^{(c)}[S]} = [ES]\\left(1 + \\frac{K_M}{[S]}\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)\\right)$$\n初始速率为 $v_{\\text{comp}} = k_{\\text{cat}}[ES]$。解出 $[ES]$ 并代入可得：\n$$v_{\\text{comp}} = \\frac{k_{\\text{cat}}[E]_T}{1 + \\frac{K_M}{[S]}\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)} = \\frac{V_{\\max}[S]}{K_M\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right) + [S]}$$\n该方程具有 MM 方程的形式，其表观参数为：\n$$V_{\\max}^{\\text{app}}(\\text{competitive}) = V_{\\max}$$\n$$K_M^{\\text{app}}(\\text{competitive}) = K_M\\left(1 + \\frac{[I_c]}{K_i^{(c)}}\\right)$$\n使用给定的数值：$[I_c] = 15~\\mu\\mathrm{M}$, $K_i^{(c)} = 3.0~\\mu\\mathrm{M}$, $K_M = 5.0~\\mu\\mathrm{M}$。\n$$K_M^{\\text{app}}(\\text{competitive}) = (5.0~\\mu\\mathrm{M})\\left(1 + \\frac{15}{3.0}\\right) = (5.0~\\mu\\mathrm{M})(1+5) = 30~\\mu\\mathrm{M}$$\n在 $[S] = 20~\\mu\\mathrm{M}$ 时，竞争性抑制下的速率为：\n$$v_{\\text{comp}} = \\frac{(0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(20~\\mu\\mathrm{M})}{30~\\mu\\mathrm{M} + 20~\\mu\\mathrm{M}} = \\frac{10}{50}~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 0.20~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\n第 2 部分：纯非竞争性抑制\n\n在纯非竞争性抑制中，抑制剂 $I_n$ 以相同的亲和力与游离酶 $E$ 和酶-底物复合物 $ES$ 结合。相关平衡为 $E + I_n \\rightleftharpoons EI_n$ 和 $ES + I_n \\rightleftharpoons ESI_n$，具有相同的抑制常数 $K_i^{(n)} = \\frac{[E][I_n]}{[EI_n]} = \\frac{[ES][I_n]}{[ESI_n]}$。$ESI_n$ 复合物无催化活性。\n酶的质量平衡为：\n$$[E]_T = [E] + [ES] + [EI_n] + [ESI_n]$$\n我们用 $[ES]$ 来表示所有物质：\n$$[E] = \\frac{K_M[ES]}{[S]}$$\n$$[EI_n] = \\frac{[E][I_n]}{K_i^{(n)}} = \\frac{K_M[ES][I_n]}{K_i^{(n)}[S]}$$\n$$[ESI_n] = \\frac{[ES][I_n]}{K_i^{(n)}}$$\n代入质量平衡方程：\n$$[E]_T = [ES]\\left(1 + \\frac{K_M}{[S]} + \\frac{K_M[I_n]}{K_i^{(n)}[S]} + \\frac{[I_n]}{K_i^{(n)}}\\right) = [ES]\\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)\\left(1 + \\frac{K_M}{[S]}\\right)$$\n速率为 $v_{\\text{noncomp}} = k_{\\text{cat}}[ES]$。解出 $[ES]$：\n$$v_{\\text{noncomp}} = \\frac{k_{\\text{cat}}[E]_T}{\\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)\\left(1 + \\frac{K_M}{[S]}\\right)} = \\frac{V_{\\max} / \\left(1 + \\frac{[I_n]}{K_i^{(n)}}\\right)}{1 + \\frac{K_M}{[S]}} = \\frac{\\left(\\frac{V_{\\max}}{1 + [I_n]/K_i^{(n)}}\\right)[S]}{K_M + [S]}$$\n表观参数为：\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = \\frac{V_{\\max}}{1 + \\frac{[I_n]}{K_i^{(n)}}}$$\n$$K_M^{\\text{app}}(\\text{noncompetitive}) = K_M$$\n使用给定的值：$[I_n] = 8.0~\\mu\\mathrm{M}$, $K_i^{(n)} = 2.0~\\mu\\mathrm{M}$。\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = \\frac{0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{1 + \\frac{8.0}{2.0}} = \\frac{0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}}{1+4} = 0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n在 $[S] = 20~\\mu\\mathrm{M}$ 时，非竞争性抑制下的速率为：\n$$v_{\\text{noncomp}} = \\frac{(0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1})(20~\\mu\\mathrm{M})}{5.0~\\mu\\mathrm{M} + 20~\\mu\\mathrm{M}} = \\frac{2.0}{25}~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1} = 0.080~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$$\n\n第 3 部分：计算 $Q$\n\n无量纲量 $Q$ 定义为：\n$$Q \\equiv \\frac{v_{\\text{comp}}}{v_{\\text{noncomp}}} \\times \\frac{K_M^{\\text{app}}(\\text{competitive})}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}^{\\text{app}}(\\text{noncompetitive})}$$\n我们可以直接用我们已计算出的数值来计算这个量：\n$v_{\\text{comp}} = 0.20~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$v_{\\text{noncomp}} = 0.080~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$K_M^{\\text{app}}(\\text{competitive}) = 30~\\mu\\mathrm{M}$\n$K_M = 5.0~\\mu\\mathrm{M}$\n$V_{\\max} = 0.50~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = 0.10~\\mu\\mathrm{M}\\,\\mathrm{s}^{-1}$\n$$Q = \\left(\\frac{0.20}{0.080}\\right) \\times \\left(\\frac{30}{5.0}\\right) \\times \\left(\\frac{0.50}{0.10}\\right) = (2.5) \\times (6.0) \\times (5.0) = 75$$\n或者，我们可以推导 $Q$ 的符号表达式。设 $\\alpha_c = 1 + \\frac{[I_c]}{K_i^{(c)}}$ 且 $\\alpha_n = 1 + \\frac{[I_n]}{K_i^{(n)}}$。\n$Q$ 的各组成部分为：\n$$K_M^{\\text{app}}(\\text{competitive}) = K_M \\alpha_c$$\n$$V_{\\max}^{\\text{app}}(\\text{noncompetitive}) = V_{\\max} / \\alpha_n$$\n$$v_{\\text{comp}} = \\frac{V_{\\max}[S]}{K_M \\alpha_c + [S]}$$\n$$v_{\\text{noncomp}} = \\frac{(V_{\\max}/\\alpha_n)[S]}{K_M + [S]}$$\n将这些代入 $Q$ 的表达式中：\n$$Q = \\frac{\\frac{V_{\\max}[S]}{K_M \\alpha_c + [S]}}{\\frac{V_{\\max}[S]}{\\alpha_n(K_M + [S])}} \\times \\frac{K_M \\alpha_c}{K_M} \\times \\frac{V_{\\max}}{V_{\\max}/\\alpha_n}$$\n$$Q = \\frac{\\alpha_n (K_M + [S])}{K_M \\alpha_c + [S]} \\times \\alpha_c \\times \\alpha_n = (\\alpha_n)^2 \\alpha_c \\frac{K_M + [S]}{K_M \\alpha_c + [S]}$$\n现在我们代入数值：\n$\\alpha_c = 1 + \\frac{15}{3.0} = 6.0$\n$\\alpha_n = 1 + \\frac{8.0}{2.0} = 5.0$\n$K_M = 5.0~\\mu\\mathrm{M}$\n$[S] = 20~\\mu\\mathrm{M}$\n$$Q = (5.0)^2 \\times (6.0) \\times \\frac{5.0 + 20}{5.0 \\times 6.0 + 20} = 25 \\times 6.0 \\times \\frac{25}{30+20} = 150 \\times \\frac{25}{50} = 150 \\times 0.5 = 75$$\n两种方法得到相同的结果。问题要求答案四舍五入到四位有效数字。", "answer": "$$\\boxed{75.00}$$", "id": "2935907"}, {"introduction": "虽然我们经常在平衡态的框架下讨论自由能，但许多现代实验技术（如单分子力谱）本质上是在非平衡条件下进行的。本练习将引导你运用Jarzynski等式这一非平衡功关系，从非平衡拉伸实验的功（$W$）分布中精确计算出平衡态的自由能差（$\\Delta F$）[@problem_id:2935883]。这项计算实践不仅展示了统计力学理论的强大威力，也让你掌握了处理和分析前沿实验数据的关键技能。", "problem": "给定多组独立的非平衡机械功样本，这些样本是在重复的快速拉伸实验中收集的、用于解折叠单个蛋白质结构域的数据。每个功样本均以每个分子的皮牛顿-纳米（picoNewton-nanometer）为单位报告。温度以开尔文（Kelvin）为单位给出。您的任务是实现一个程序，该程序从平衡统计力学和微观可逆性的第一性原理出发，推导出一个估计量，用于估算折叠态和解折叠态之间的平衡亥姆霍兹自由能差。该推导需利用将功的指数平均值与平衡自由能差联系起来的非平衡功关系。然后，您必须将此估计量应用于所提供的测试集并报告数值结果。\n\n您可以使用的基本原理：\n- 正则系综：对于一个温度为 $T$ 的系统，其亥姆霍兹自由能为 $F=-k_{\\mathrm{B}} T \\ln Z$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z$ 是正则配分函数。\n- 微观可逆性与已建立的非平衡功关系：在固定协议下，对多次实现的非平衡功进行指数平均，其结果与初始态和最终态之间的平衡自由能差相关。\n- 功是路径依赖的，但平衡自由能差是一个状态函数。\n\n实现约束：\n- 使用 $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ 和 $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 使用 $1\\ \\mathrm{pN\\cdot nm}=10^{-21}\\ \\mathrm{J}$ 将每个功 $W$ 从皮牛顿-纳米转换为焦耳。\n- 温度 $T$ 以开尔文为单位给出。\n- 为了在平均指数时保持数值稳定性，请设计您的计算，通过在取对数前对指数进行适当的重新缩放来避免当 $W$ 为大的正数时出现下溢；不要直接计算大的负参数的朴素指数。\n- 对于每个测试用例，使用您的估计量计算每摩尔的平衡解折叠自由能差 $\\Delta F$（单位为千焦耳/摩尔），并报告一个四舍五入到三位小数的浮点数。\n\n角度单位不适用。如果您在内部推导中遇到任何分数，您的程序仍应按规定输出一个浮点数。\n\n测试集：\n- 案例 1：$T=298\\ \\mathrm{K}$，功样本（单位：$\\mathrm{pN\\cdot nm}$）：\n  $[247.0,255.3,260.1,241.5,252.8,249.2,258.9,243.6,251.0,246.8,262.4,239.7,254.1,248.5,257.3,244.9,250.6,263.0,242.1,256.0]$。\n- 案例 2：$T=310\\ \\mathrm{K}$，功样本（单位：$\\mathrm{pN\\cdot nm}$）：\n  $[124.0,126.1,122.5,125.3,127.0,123.8,124.7,125.9,126.4,123.2,124.5,125.1,126.0,123.9,124.8]$。\n- 案例 3：$T=298\\ \\mathrm{K}$，功样本（单位：$\\mathrm{pN\\cdot nm}$）：\n  $[420.5,395.2,410.1,505.3,460.7,442.8,487.6,378.4,455.9,468.2,499.1,389.3,472.5,361.7,435.0,481.2,352.6,460.3,341.9,492.7,227.8,243.5,269.1,312.4,285.0,301.6,520.3,476.9,458.7,440.2,355.5,330.8,290.4,275.2,261.9,240.3,510.8,497.0,482.6,466.4]$。\n- 案例 4：$T=298\\ \\mathrm{K}$，功样本（单位：$\\mathrm{pN\\cdot nm}$）：\n  $[260.0,310.0,280.0]$。\n\n答案所需单位：\n- 以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位报告每摩尔的 $\\Delta F$，每个结果四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述案例的顺序排列，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$，其中每个 $\\text{result}_i$ 是一个在 $\\mathrm{kJ\\,mol^{-1}}$ 单位下小数点后有三位的浮点数。", "solution": "我们从正则系综开始，其中亥姆霍兹自由能为 $F=-k_{\\mathrm{B}} T \\ln Z$，其中 $k_{\\mathrm{B}}$ 为玻尔兹曼常数，$T$ 为绝对温度，$Z$ 为正则配分函数。对于一个通过驱动协议将初始平衡态转变为最终平衡态的解折叠过程，平衡自由能差为 $\\Delta F=F_{\\text{final}}-F_{\\text{initial}}$。\n\n微观可逆性和哈密顿动力学是一类非平衡功关系的基础，这些关系将不可逆的功测量值与平衡自由能差联系起来。对于从同一初始平衡态开始并重复多次的固定协议，对各次实现的功进行指数平均，可以得到平衡自由能差。具体来说，如果 $W$ 表示某次实现过程中的机械功，且 $\\beta=(k_{\\mathrm{B}} T)^{-1}$，那么非平衡功关系表明 $W$ 的指数平均值蕴含了 $\\Delta F$ 的信息。根据此关系和期望值的定义（作为样本均值的极限），可以通过用样本均值代替系综平均，然后取适当的对数并乘以 $k_{\\mathrm{B}} T$，来为基于 $N$ 个观测功 $\\{W_i\\}_{i=1}^N$ 的有限样本构建一个一致的估计量。\n\n具体而言，对于给定的集合 $\\{W_i\\}_{i=1}^N$、温度 $T$ 和 $\\beta=(k_{\\mathrm{B}} T)^{-1}$，该估计量为\n$$\n\\widehat{\\Delta F}=-k_{\\mathrm{B}} T \\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{-\\beta W_i}\\right).\n$$\n这个公式是综合以下几点得出的：(i) 自由能的正则定义，(ii) 由微观可逆性导出的、连接 $W$ 的指数平均值与 $\\Delta F$ 的非平衡功关系，以及 (iii) 用样本平均代替系综平均以产生一个可计算的估计量。当 $N\\to\\infty$ 时，这个估计量是渐近无偏的，尽管对于有限的 $N$，它可能表现出偏差，该偏差会随着低功值实现的出现而减小。\n\n数值稳定性：当 $W_i$ 以 $k_{\\mathrm{B}} T$ 为单位是大的正数时，直接计算 $e^{-\\beta W_i}$ 可能会导致下溢。为避免下溢，我们使用一种重新缩放的对数-求和-指数（log-sum-exp）计算方法。定义 $a_i=-\\beta W_i$，并令 $a_{\\max}=\\max_i a_i$。则\n$$\n\\frac{1}{N}\\sum_{i=1}^N e^{a_i}=e^{a_{\\max}} \\cdot \\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}},\n$$\n因此\n$$\n\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i}\\right)=a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right).\n$$\n所以，\n$$\n\\widehat{\\Delta F}=-k_{\\mathrm{B}} T \\left[a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right)\\right].\n$$\n由于 $a_i-a_{\\max}\\le 0$，内部的指数项的值被限制在 $1$ 以下，因此在数值上是安全的。\n\n单位与换算：\n- 输入的功是每个分子的皮牛顿-纳米。使用 $1\\ \\mathrm{pN\\cdot nm}=10^{-21}\\ \\mathrm{J}$ 换算为焦耳/分子。\n- 使用 $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$ 和 $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 在计算出 $\\widehat{\\Delta F}$（单位为焦耳/分子）之后，通过以下方式换算为千焦耳/摩尔：\n$$\n\\widehat{\\Delta F}\\ (\\mathrm{kJ\\,mol^{-1}})=\\frac{\\widehat{\\Delta F}\\ (\\mathrm{J\\ per\\ molecule})\\times N_{\\mathrm{A}}}{1000}.\n$$\n\n每个测试用例的算法：\n1. 读取温度 $T$（开尔文）和功样本 $\\{W_i^{\\mathrm{(pN\\cdot nm)}}\\}$。\n2. 将 $W_i$ 换算为焦耳：$W_i^{\\mathrm{(J)}}=W_i^{\\mathrm{(pN\\cdot nm)}}\\times 10^{-21}$。\n3. 计算 $\\beta=(k_{\\mathrm{B}} T)^{-1}$。\n4. 构建 $a_i=-\\beta W_i^{\\mathrm{(J)}}$。\n5. 计算 $a_{\\max}=\\max_i a_i$。\n6. 计算 $\\ln M = a_{\\max}+\\ln\\left(\\frac{1}{N}\\sum_{i=1}^N e^{a_i-a_{\\max}}\\right)$。\n7. 计算 $\\widehat{\\Delta F}^{\\mathrm{(J)}}=-k_{\\mathrm{B}} T \\cdot \\ln M$。\n8. 使用 $N_{\\mathrm{A}}$ 换算为 $\\mathrm{kJ\\,mol^{-1}}$ 并除以 $1000$。\n9. 四舍五入到三位小数。\n10. 按照案例顺序，将四个结果输出为单个方括号括起来的、逗号分隔的行。\n\n测试集包括：\n- 一个在 $T=298\\ \\mathrm{K}$ 下的典型近可逆数据集，功值在几十个 $k_{\\mathrm{B}} T$ 左右。\n- 一个在 $T=310\\ \\mathrm{K}$ 下的更高温度、近平衡的数据集。\n- 一个在 $T=298\\ \\mathrm{K}$ 下的高度耗散数据集，其分布宽泛且包含罕见的低功事件，以确保指数平均的正确收敛。\n- 一个在 $T=298\\ \\mathrm{K}$ 下的小样本边缘案例，用以说明有限样本偏差以及在数据最少情况下的数值处理。\n\n程序实现了此过程并按要求打印结果。", "answer": "```python\nimport numpy as np\n\n# Constants (CODATA exact values where defined)\nk_B = 1.380649e-23          # Boltzmann constant in J/K\nN_A = 6.02214076e23         # Avogadro constant in 1/mol\nPNM_TO_J = 1e-21            # 1 pN*nm in Joule\nJ_TO_KJMOL = N_A / 1000.0   # Convert J per molecule to kJ/mol\n\ndef jarzynski_deltaF_kJ_per_mol(work_pNnm, T_K):\n    \"\"\"\n    Compute Jarzynski estimator of DeltaF from work samples (per molecule) given in pN*nm at temperature T_K.\n    Returns DeltaF in kJ/mol using a numerically stable log-sum-exp computation.\n    \"\"\"\n    W_J = np.array(work_pNnm, dtype=np.float64) * PNM_TO_J  # per molecule in Joule\n    beta = 1.0 / (k_B * T_K)\n    a = -beta * W_J  # exponents\n    a_max = np.max(a)\n    # Compute log of mean exp(a) stably\n    # ln(mean(exp(a))) = a_max + ln(mean(exp(a - a_max)))\n    exp_shifted = np.exp(a - a_max)\n    ln_mean_exp = a_max + np.log(np.mean(exp_shifted))\n    deltaF_J = - (k_B * T_K) * ln_mean_exp  # per molecule in Joule\n    deltaF_kJ_per_mol = deltaF_J * J_TO_KJMOL\n    return float(deltaF_kJ_per_mol)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [\n                247.0, 255.3, 260.1, 241.5, 252.8, 249.2, 258.9, 243.6, 251.0, 246.8,\n                262.4, 239.7, 254.1, 248.5, 257.3, 244.9, 250.6, 263.0, 242.1, 256.0\n            ],\n        },\n        # Case 2\n        {\n            \"T_K\": 310.0,\n            \"work_pNnm\": [\n                124.0, 126.1, 122.5, 125.3, 127.0, 123.8, 124.7, 125.9, 126.4, 123.2,\n                124.5, 125.1, 126.0, 123.9, 124.8\n            ],\n        },\n        # Case 3\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [\n                420.5, 395.2, 410.1, 505.3, 460.7, 442.8, 487.6, 378.4, 455.9, 468.2,\n                499.1, 389.3, 472.5, 361.7, 435.0, 481.2, 352.6, 460.3, 341.9, 492.7,\n                227.8, 243.5, 269.1, 312.4, 285.0, 301.6, 520.3, 476.9, 458.7, 440.2,\n                355.5, 330.8, 290.4, 275.2, 261.9, 240.3, 510.8, 497.0, 482.6, 466.4\n            ],\n        },\n        # Case 4\n        {\n            \"T_K\": 298.0,\n            \"work_pNnm\": [260.0, 310.0, 280.0],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        T_K = case[\"T_K\"]\n        work = case[\"work_pNnm\"]\n        deltaF_kJmol = jarzynski_deltaF_kJ_per_mol(work, T_K)\n        results.append(deltaF_kJmol)\n\n    # Format each result to three decimal places and print as a single line list without spaces\n    formatted = [f\"{x:.3f}\" for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2935883"}]}