{"hands_on_practices": [{"introduction": "这项练习是分子钟应用的基础。原始的序列差异会因同一位点发生多次替换而低估真实的演化距离。本练习将引导你使用一个标准的核酸替换模型（K80模型）来校正这一偏差，并将校正后的遗传距离转化为绝对的分化时间。[@problem_id:2590767]", "problem": "您正在研究从两个独立进化的谱系（一个植物，一个动物）中采样的一对直系同源核基因，以比较植物学和动物学中的分化模式。从一个非常长的高质量比对中，观察到的核苷酸差异比例为 $p = 0.12$。假设核苷酸碱基频率相等，且替换遵循Kimura双参数（K80）模型，其中转换和颠换以不同的瞬时速率发生，但其他方面碱基被对称处理。转换与颠换的速率比给定为 $\\kappa = 2$，并且序列比对足够长，以至于观察到的差异中实现的转换与颠换的比率近似于潜在的速率比。\n\n在严格分子钟下，每个谱系的替换速率为 $r = 0.004$ 替换/位点/百万年（Myr），在每个谱系中随时间恒定，且两个谱系之间相互独立。\n\n仅使用基本定义和经过充分检验的公式，按以下步骤进行：\n- 通过援引观察到的差异中实现的转换与颠换比率为 $\\kappa:1$ 的假设，将观察到的差异比例 $p$ 分解为转换的估计比例 $P$ 和颠换的估计比例 $Q$。\n- 应用Kimura双参数校正，从 $P$ 和 $Q$ 中获得每个位点的预期替换数 $D_{\\text{K80}}$，同时确保参数域得到满足，从而使校正有定义。\n- 使用严格分子钟在成对校正距离和时间之间的关系，将 $D_{\\text{K80}}$ 转换为分化时间 $T$。\n\n计算分化时间 $T$，并报告您的最终答案，四舍五入到四位有效数字。以百万年（Myr）为单位表示 $T$。", "solution": "所提出的问题是分子系统发育学中的一个标准练习，需要应用已建立的模型来估计分化时间。在进行系统性解答之前，我将首先验证其前提。\n\n已知条件如下：\n- 两个序列之间观察到的核苷酸差异比例为 $p = 0.12$。\n- 核苷酸替换模型是Kimura双参数（K80）模型。\n- 假设碱基频率相等，即每种核苷酸为 $0.25$。\n- 转换与颠换的速率比为 $\\kappa = 2$。\n- 观察到的转换（$P$）与观察到的颠换（$Q$）的实现比率假定等于速率比，因此 $P/Q = \\kappa = 2$。\n- 在严格分子钟下假定恒定的每个谱系的替换速率为 $r = 0.004$ 替换/位点/百万年（Myr）。\n- 两个谱系是独立进化的。\n- 分化时间 $T$ 的最终答案必须以百万年（Myr）为单位，并四舍五入到四位有效数字。\n\n该问题具有科学依据，使用了成熟的K80模型和分子钟概念。问题陈述清晰，提供了所有必要的参数和通往唯一解的清晰逻辑路径。语言客观，提供的值（$p=0.12$, $\\kappa=2$, $r=0.004$）在生物数据的合理范围内。没有逻辑矛盾、缺失数据或不科学的前提。因此，我判断该问题是有效的，并将继续进行推导。\n\n按照指示，该过程分三个阶段执行。\n\n首先，我们将观察到的总差异比例 $p$ 分解为转换差异的比例 $P$ 和颠换差异的比例 $Q$。我们有两个已知条件：\n1. 各比例之和等于观察到的总差异：$p = P + Q$。\n2. 观察到的转换与颠换的比率由 $\\kappa$ 给出：$\\frac{P}{Q} = \\kappa$。\n\n代入给定值，$p = 0.12$ 和 $\\kappa = 2$：\n$$\nP + Q = 0.12\n$$\n$$\n\\frac{P}{Q} = 2 \\implies P = 2Q\n$$\n我们将第二个方程代入第一个方程：\n$$\n2Q + Q = 0.12 \\implies 3Q = 0.12\n$$\n解出 $Q$ 得：\n$$\nQ = \\frac{0.12}{3} = 0.04\n$$\n确定 $Q$ 后，我们求 $P$：\n$$\nP = 2Q = 2(0.04) = 0.08\n$$\n因此，观察到的差异比例被分解为 $P = 0.08$（转换）和 $Q = 0.04$（颠换）。简单验证可得 $P + Q = 0.08 + 0.04 = 0.12$，这是正确的。\n\n第二，我们应用Kimura双参数（K80）校正来估计每个位点的替换数 $D_{\\text{K80}}$。K80距离的公式是：\n$$\nD_{\\text{K80}} = -\\frac{1}{2}\\ln(1 - 2P - Q) - \\frac{1}{4}\\ln(1 - 2Q)\n$$\n这个校正考虑了在同一位点发生的多次替换，这些多次替换导致观察到的差异 $p$ 低估了真实的进化距离。在应用此公式之前，我们必须验证其参数是否定义良好，特别是自然对数的参数必须为正。\n条件1：$1 - 2P - Q > 0$\n$$\n1 - 2(0.08) - 0.04 = 1 - 0.16 - 0.04 = 1 - 0.20 = 0.80\n$$\n由于 $0.80 > 0$，此条件得到满足。\n条件2：$1 - 2Q > 0$\n$$\n1 - 2(0.04) = 1 - 0.08 = 0.92\n$$\n由于 $0.92 > 0$，此条件也得到满足。因此，K80校正是适用的。\n\n现在我们将 $P$ 和 $Q$ 的值代入K80公式：\n$$\nD_{\\text{K80}} = -\\frac{1}{2}\\ln(0.80) - \\frac{1}{4}\\ln(0.92)\n$$\n我们计算 $D_{\\text{K80}}$ 的数值：\n$$\nD_{\\text{K80}} \\approx -\\frac{1}{2}(-0.22314355) - \\frac{1}{4}(-0.08338161)\n$$\n$$\nD_{\\text{K80}} \\approx 0.111571775 + 0.0208454025\n$$\n$$\nD_{\\text{K80}} \\approx 0.1324171775\n$$\n这个值 $D_{\\text{K80}}$ 代表了自两个序列的最后一个共同祖先以来，在它们之间累积的每个位点的估计总替换数。\n\n第三，我们使用严格分子钟假说将这个遗传距离转换为分化时间 $T$。两个序列之间的总距离 $D$ 是从它们的共同祖先开始，在两个谱系上各自累积的替换数之和。如果 $r$ 是每个谱系单位时间的替换速率，而 $T$ 是分化以来的时间，则每个谱系累积的距离为 $r \\times T$。由于有两个这样的谱系，总距离是：\n$$\nD = 2rT\n$$\n我们求解分化时间 $T$：\n$$\nT = \\frac{D}{2r}\n$$\n使用我们计算出的距离 $D_{\\text{K80}}$ 和给定的速率 $r = 0.004$ 替换/位点/百万年（Myr）：\n$$\nT = \\frac{0.1324171775}{2 \\times 0.004} = \\frac{0.1324171775}{0.008}\n$$\n$$\nT \\approx 16.5521471875 \\text{ Myr}\n$$\n问题要求最终答案四舍五入到四位有效数字。\n$$\nT \\approx 16.55 \\text{ Myr}\n$$\n这是根据所提供的数据和模型，估算出的植物和动物谱系自其最后一个共同祖先分化以来的时间。", "answer": "$$\n\\boxed{16.55}\n$$", "id": "2590767"}, {"introduction": "在掌握了单一物种对的时间估算后，我们自然地进入下一个阶段：为包含多个物种的系统发育树定年。本练习将探讨如何利用成对物种间的遗传距离矩阵，在严格分子钟的假设下，通过最小二乘法来重建一棵时间标定的超度量树。这个过程涉及到模型拟合和拓扑结构选择，是系统发育学中的核心技能。[@problem_id:2590673]", "problem": "使用 Jukes–Cantor (JC69) 模型（Jukes–Cantor 1969 (JC69)）校正的序列分歧，对一个动物学分支中四个近缘分类单元的比较数据集进行分析。校正后的成对距离 $D_{ij}$ 以每位点替换数（substitutions per site）为单位进行测量。假设存在一个严格分子钟，其已知的替换速率 $r$（每百万年每位点替换数）在所有谱系中均保持恒定。\n\n使用的基本事实：\n- 在严格分子钟下，每个分支以恒定的速率 $r$（每个谱系单位时间内）累积替换。\n- 校正距离 $D_{ij}$ 近似于树上连接分类单元 $i$ 和 $j$ 的唯一路径上每位点的预期总替换数，即该路径上各分支长度之和。\n- 超度量树是指从根节点到每个叶尖的总时间相等的树。\n\n给定以下数据和假设：\n- 已知的严格分子钟速率为 $r = 0.005$。\n- 观测到的对称距离矩阵条目为：\n  - $D_{AB} = 0.0618$, $D_{AC} = 0.1420$, $D_{AD} = 0.1450$,\n  - $D_{BC} = 0.1400$, $D_{BD} = 0.1440$, $D_{CD} = 0.0552$。\n- 仅考虑分类单元 $\\{A,B,C,D\\}$ 上具有两个姐妹对（cherries）的完全解析有根二叉树。对于每个候选的有根拓扑结构，三个节点年龄分别是两个内部分支的年龄（即两个姐妹对的最近共同祖先的年龄）和根节点的年龄。\n\n任务：\n1. 使用上述基本事实，且不援引任何预先推导的“快捷”公式，将给定候选拓扑结构的模型预测成对距离写成未知节点年龄和已知速率 $r$ 的线性函数。从第一性原理出发，仔细论证这些预测为何成立。\n2. 对于三种可能的具有两个姐妹对的有根拓扑结构中的每一种，构建比较观测距离 $D_{ij}$ 与模型预测距离的无权最小二乘准则。在严格分子钟下，针对固定的拓扑结构，推导节点年龄的闭式最小二乘估计量，并将得到的最小化残差平方和写成该拓扑结构下观测距离的函数。\n3. 对三种拓扑结构中的每一种，评估其最小化残差平方和，选择值最小的拓扑结构，并报告其最小二乘节点年龄估计值。\n4. 从所选拓扑结构中，提取估计的根节点年龄（以百万年为单位）。\n\n将最终答案表示为以 $\\text{Myr}$（百万年）为单位的估计根节点年龄，并四舍五入到四位有效数字。最终答案仅提供所要求的单个数值。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 分类单元：四个分类单元的集合 $\\{A, B, C, D\\}$。\n- 模型：Jukes–Cantor (JC69) 校正的序列分歧。\n- 距离：成对距离 $D_{ij}$ 以每位点替换数为单位进行测量。\n- 分子钟：一个严格分子钟，其在所有谱系中具有恒定的速率 $r$。\n- 分子钟速率：$r = 0.005$ 每百万年每位点替换数。\n- 距离矩阵条目：\n  - $D_{AB} = 0.0618$\n  - $D_{AC} = 0.1420$\n  - $D_{AD} = 0.1450$\n  - $D_{BC} = 0.1400$\n  - $D_{BD} = 0.1440$\n  - $D_{CD} = 0.0552$\n- 拓扑结构约束：分析仅限于 $\\{A,B,C,D\\}$ 上具有两个姐妹对（cherries）的完全解析有根二叉树。\n- 定义：\n  - 校正距离 $D_{ij}$ 是连接分类单元 $i$ 和 $j$ 的路径上的分支长度（单位为每位点替换数）之和。\n  - 严格分子钟意味着一个超度量树，其中分支长度是时间和速率的乘积。\n  - 节点年龄被定义为两个内部分支的年龄和根节点的年龄。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了分子系统发育学的标准原理，如严格分子钟模型、基于距离的方法以及用于树参数化的最小二乘估计。问题陈述清晰，提供了一套完整的数据和明确的目标，可以通过指定程序得到唯一解。该问题是客观的，以精确、正式的语言表述，没有主观或推测性内容。这是一个计算生物学中的教科书式练习，没有科学上的不健全、模糊不清或信息缺失之处。数据点数量（六个距离）大于给定拓扑结构在严格分子钟下的自由参数数量（三个节点年龄），因此使用最小二乘准则是恰当且必要的。\n\n步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n解答过程将按问题陈述中列出的四个任务执行。\n\n任务1：模型预测的距离\n对于四个分类单元的集合 $\\{A, B, C, D\\}$，存在三种可能的包含两个姐妹对的完全解析有根二叉拓扑结构：\n1. 拓扑结构1：$((A,B),(C,D))$\n2. 拓扑结构2：$((A,C),(B,D))$\n3. 拓扑结构3：$((A,D),(B,C))$\n\n让我们考虑这种形式的一般拓扑结构，记为 $((i,j),(k,l))$。设 $t_{ij}$ 为分类单元 $i$ 和 $j$ 的最近共同祖先（MRCA）的年龄（以百万年，Myr为单位）。设 $t_{kl}$ 为分类单元 $k$ 和 $l$ 的MRCA的年龄。设 $t_{\\text{root}}$ 为树的根节点年龄，即所有四个分类单元的MRCA。根据定义，$t_{\\text{root}} > t_{ij}$ 且 $t_{\\text{root}} > t_{kl}$。时间从现在（时间 $t=0$）开始向后计算。\n\n在严格分子钟下，树上任意两个节点之间的进化距离（每位点替换数）是它们之间的时间间隔与替换速率 $r$ 的乘积。两个末端分类单元 $i$ 和 $j$ 之间的总距离 $D_{ij}$ 是连接它们的唯一路径上各分支长度之和。\n\n对于拓扑结构 $((i,j),(k,l))$，分类单元 $i$ 和分类单元 $j$ 之间的路径从现在（$t=0$）追溯到它们在时间 $t_{ij}$ 的MRCA，然后再回到现在。此路径的总时间跨度为 $t_{ij} + t_{ij} = 2t_{ij}$。因此，模型预测的距离为 $\\hat{D}_{ij} = r \\times (2t_{ij}) = 2rt_{ij}$。类似地，对于另一个姐妹对，$\\hat{D}_{kl} = 2rt_{kl}$。\n\n第一对中的一个分类单元（例如 $i$）与第二对中的一个分类单元（例如 $k$）之间的路径从现在追溯到时间 $t_{\\text{root}}$ 的根节点，然后再回到现在。此路径的总时间跨度为 $t_{\\text{root}} + t_{\\text{root}} = 2t_{\\text{root}}$。因此，对于任何跨对比较，预测的距离是相同的：$\\hat{D}_{ik} = \\hat{D}_{il} = \\hat{D}_{jk} = \\hat{D}_{jl} = 2rt_{\\text{root}}$。\n\n这些方程为任何给定的候选拓扑结构提供了模型预测的成对距离，表示为未知节点年龄的线性函数。\n\n任务2：最小二乘准则和估计量\n无权最小二乘准则 $S$ 是观测距离 $D_{ij}$ 与模型预测距离 $\\hat{D}_{ij}$ 之间差的平方和。对于一般拓扑结构 $((i,j),(k,l))$，表达式为：\n$$S = (D_{ij} - 2rt_{ij})^2 + (D_{kl} - 2rt_{kl})^2 + (D_{ik} - 2rt_{\\text{root}})^2 + (D_{il} - 2rt_{\\text{root}})^2 + (D_{jk} - 2rt_{\\text{root}})^2 + (D_{jl} - 2rt_{\\text{root}})^2$$\n为了找到节点年龄的最小二乘估计量，我们必须通过将偏导数设为零来最小化 $S$ 关于 $t_{ij}$、$t_{kl}$ 和 $t_{\\text{root}}$ 的值。\n\n这些参数是解耦的。\n$\\frac{\\partial S}{\\partial t_{ij}} = 2(D_{ij} - 2rt_{ij})(-2r) = 0 \\implies \\hat{t}_{ij} = \\frac{D_{ij}}{2r}$\n$\\frac{\\partial S}{\\partial t_{kl}} = 2(D_{kl} - 2rt_{kl})(-2r) = 0 \\implies \\hat{t}_{kl} = \\frac{D_{kl}}{2r}$\n\n对于根节点年龄：\n$\\frac{\\partial S}{\\partial t_{\\text{root}}} = 2(D_{ik} - 2rt_{\\text{root}})(-2r) + 2(D_{il} - 2rt_{\\text{root}})(-2r) + 2(D_{jk} - 2rt_{\\text{root}})(-2r) + 2(D_{jl} - 2rt_{\\text{root}})(-2r) = 0$\n这可以简化为：\n$(D_{ik} - 2rt_{\\text{root}}) + (D_{il} - 2rt_{\\text{root}}) + (D_{jk} - 2rt_{\\text{root}}) + (D_{jl} - 2rt_{\\text{root}}) = 0$\n$D_{ik} + D_{il} + D_{jk} + D_{jl} = 4 \\times (2rt_{\\text{root}}) = 8rt_{\\text{root}}$\n$\\hat{t}_{\\text{root}} = \\frac{D_{ik} + D_{il} + D_{jk} + D_{jl}}{8r}$\n\n最小化的残差平方和 $S^*$ 是通过将这些估计量代入 $S$ 的表达式中得到的。前两项 $(D_{ij} - 2r\\hat{t}_{ij})^2$ 和 $(D_{kl} - 2r\\hat{t}_{kl})^2$ 变为零。剩余的和为：\n$S^* = (D_{ik} - \\bar{D}_{\\text{cross}})^2 + (D_{il} - \\bar{D}_{\\text{cross}})^2 + (D_{jk} - \\bar{D}_{\\text{cross}})^2 + (D_{jl} - \\bar{D}_{\\text{cross}})^2$\n其中 $\\bar{D}_{\\text{cross}} = 2r\\hat{t}_{\\text{root}} = \\frac{D_{ik} + D_{il} + D_{jk} + D_{jl}}{4}$ 是四个“跨对”距离的算术平均值。因此，$S^*$ 是跨对距离与其均值之差的平方和。\n\n任务3：评估与选择\n我们现在使用提供的距离数据为三种可能的拓扑结构中的每一种计算 $S^*$。\n\n拓扑结构1：$((A,B),(C,D))$\n跨对距离为 $\\{D_{AC}, D_{AD}, D_{BC}, D_{BD}\\}$。\n$D_{AC} = 0.1420$, $D_{AD} = 0.1450$, $D_{BC} = 0.1400$, $D_{BD} = 0.1440$。\n这些距离的均值为：\n$\\bar{D}_{\\text{cross},1} = \\frac{0.1420 + 0.1450 + 0.1400 + 0.1440}{4} = \\frac{0.5710}{4} = 0.14275$。\n最小化平方和为：\n$S_1^* = (0.1420 - 0.14275)^2 + (0.1450 - 0.14275)^2 + (0.1400 - 0.14275)^2 + (0.1440 - 0.14275)^2$\n$S_1^* = (-0.00075)^2 + (0.00225)^2 + (-0.00275)^2 + (0.00125)^2$\n$S_1^* = 0.0000005625 + 0.0000050625 + 0.0000075625 + 0.0000015625 = 0.00001475 = 1.475 \\times 10^{-5}$。\n\n拓扑结构2：$((A,C),(B,D))$\n跨对距离为 $\\{D_{AB}, D_{AD}, D_{CB}, D_{CD}\\}$。注意 $D_{CB} = D_{BC}$。\n$D_{AB} = 0.0618$, $D_{AD} = 0.1450$, $D_{BC} = 0.1400$, $D_{CD} = 0.0552$。\n均值为：\n$\\bar{D}_{\\text{cross},2} = \\frac{0.0618 + 0.1450 + 0.1400 + 0.0552}{4} = \\frac{0.4020}{4} = 0.1005$。\n$S_2^* = (0.0618 - 0.1005)^2 + (0.1450 - 0.1005)^2 + (0.1400 - 0.1005)^2 + (0.0552 - 0.1005)^2$\n$S_2^* = (-0.0387)^2 + (0.0445)^2 + (0.0395)^2 + (-0.0453)^2$\n$S_2^* = 0.00149769 + 0.00198025 + 0.00156025 + 0.00205209 = 0.00709028$。\n\n拓扑结构3：$((A,D),(B,C))$\n跨对距离为 $\\{D_{AB}, D_{AC}, D_{DB}, D_{DC}\\}$。注意 $D_{DB}=D_{BD}$ 且 $D_{DC}=D_{CD}$。\n$D_{AB} = 0.0618$, $D_{AC} = 0.1420$, $D_{BD} = 0.1440$, $D_{CD} = 0.0552$。\n均值为：\n$\\bar{D}_{\\text{cross},3} = \\frac{0.0618 + 0.1420 + 0.1440 + 0.0552}{4} = \\frac{0.4030}{4} = 0.10075$。\n$S_3^* = (0.0618 - 0.10075)^2 + (0.1420 - 0.10075)^2 + (0.1440 - 0.10075)^2 + (0.0552 - 0.10075)^2$\n$S_3^* = (-0.03895)^2 + (0.04125)^2 + (0.04325)^2 + (-0.04555)^2$\n$S_3^* = 0.0015171025 + 0.0017015625 + 0.0018705625 + 0.0020748025 = 0.00716403$。\n\n比较最小化平方和：\n$S_1^* = 1.475 \\times 10^{-5}$\n$S_2^* \\approx 7.09 \\times 10^{-3}$\n$S_3^* \\approx 7.16 \\times 10^{-3}$\n由于 $S_1^*$ 远小于 $S_2^*$ 和 $S_3^*$，拓扑结构 $((A,B),(C,D))$ 在严格分子钟模型下最能拟合数据。\n\n该拓扑结构的最小二乘节点年龄估计值为：\n$\\hat{t}_{AB} = \\frac{D_{AB}}{2r} = \\frac{0.0618}{2 \\times 0.005} = \\frac{0.0618}{0.01} = 6.18 \\, \\text{Myr}$\n$\\hat{t}_{CD} = \\frac{D_{CD}}{2r} = \\frac{0.0552}{2 \\times 0.005} = \\frac{0.0552}{0.01} = 5.52 \\, \\text{Myr}$\n$\\hat{t}_{\\text{root}} = \\hat{t}_{ABCD} = \\frac{D_{AC} + D_{AD} + D_{BC} + D_{BD}}{8r} = \\frac{0.5710}{8 \\times 0.005} = \\frac{0.5710}{0.04} = 14.275 \\, \\text{Myr}$\n\n任务4：提取估计的根节点年龄\n所选拓扑结构 $((A,B),(C,D))$ 的估计根节点年龄为 $\\hat{t}_{ABCD}$。\n$\\hat{t}_{ABCD} = 14.275 \\, \\text{Myr}$。\n问题要求将此值四舍五入到四位有效数字。\n$14.275 \\approx 14.28$。", "answer": "$$\\boxed{14.28}$$", "id": "2590673"}, {"introduction": "严格分子钟是一个强有力的假设，但在真实的生物数据中常常被违背。当不同谱系的演化速率存在差异时，我们就需要更复杂的模型。本练习将引导你进入高级贝叶斯分析领域，设计一个严谨的统计流程来比较不同的时钟模型——包括严格分子钟、局部分子钟和非相关松弛分子钟——并选择最能解释数据的模型。这是确保获得可靠分化时间估算的决定性步骤。[@problem_id:2590771]", "problem": "一个比较数据集包含来自 $n = 62$ 个分类单元的直系同源核基因比对，涵盖多个被子植物分支和多个昆虫目，并设有一个藻类外群。三个独立的化石校准点提供了硬性下限：冠群被子植物节点的最小年龄为 $t_{\\min,1} = 125$ 百万年，冠群完全变态昆虫节点的最小年龄为 $t_{\\min,2} = 315$ 百万年，后生动物与绿色植物分化的最小年龄为 $t_{\\min,3} = 600$ 百万年。一项严格分子钟的似然比检验在 $p  0.001$ 的水平上拒绝了类时钟演化。您的任务是设计一个统计上一致的模型选择策略，以比较三种时钟模型：严格时钟、一个双分区局域时钟（植物对昆虫），以及一个不相关对数正态（UCLN）弛豫时钟，使用通过踏脚石采样估计的边际似然进行比较。您的设计必须指定估计策略和所有必要的先验，以确保边际似然在各模型间是定义良好且可比较的，并且必须遵循贝叶斯分化时间推断的良好实践。\n\n您可以依赖的基础事实和定义包括：对于模型 $M$ 和数据 $y$ 的贝叶斯定理 $p(M \\mid y) \\propto p(y \\mid M)\\,p(M)$，边际似然的定义为似然函数对所有参数和树的先验进行积分，以及踏脚石采样通过幂后验在先验和后验之间架起桥梁来估计边际似然。您也可以假设标准的替换模型和树先验是可用的。除了这些定义之外，不要假设任何快捷公式。\n\n哪个选项最能指定一个有效且可辩护的策略？\n\nA. 一次性固定最大似然拓扑和分支长度，并在每个时钟模型下的后验样本上通过马尔可夫链蒙特卡罗计算赤池信息准则（AICM）。对时钟速率使用不当的 Jeffreys 先验以避免影响后验。对于校准，施加等于化石最小值的硬性下限且无上限。因为严格时钟被拒绝，所以将其从边际似然估计中排除。对于踏脚石采样，使用 $K = 10$ 个踏脚石，其幂次均匀间隔，每个踏脚石进行 $5 \\times 10^{4}$ 次迭代。\n\nB. 对于每个模型，使用相同的替换过程（广义时间可逆加 Gamma，记为 GTR+$\\Gamma$）和相同的带采样的校准出生-死亡树先验，对树拓扑和节点时间进行积分。为交换率和碱基频率分配狄利克雷先验，为 gamma 形状参数分配指数先验，并为时间树分配一个正常的、校准过的出生-死亡先验，其中化石校准实现为带偏移的对数正态先验：对于校准 $i \\in \\{1,2,3\\}$，$t_{i} \\sim \\text{Lognormal}(\\mu_{i}, \\sigma_{i})$，在 $t_{\\min,i}$ 处有偏移量，且 $\\mu_{i}, \\sigma_{i}$ 为有限值。对于严格时钟，为平均速率设置一个对数正态先验 $r \\sim \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$。对于双分区局域时钟，先验地定义两个不相交的单系分区（植物对昆虫），为分区特定的速率 $r_{1}, r_{2}$ 分配独立的对数正态先验，并设置一个弱信息层级先验 $\\log r_{j} \\sim \\mathcal{N}(\\mu_{r}, \\tau^{2})$，其中 $\\mu_{r}$ 和 $\\tau$ 具有正常的先验。对于不相关对数正态弛豫时钟（UCLN），将分支特异性速率 $r_{b}$ 独立地分配为对数正态分布，其对数尺度上的均值参数为 $\\mu_{r}$，标准差参数为 $\\sigma_{r}$，即 $r_{b} \\stackrel{\\text{i.i.d.}}{\\sim} \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$，并设置正常的超先验，例如 $\\mu_{r} \\sim \\text{Normal}(\\mu_{0}, \\sigma_{0}^{2})$（截断为正速率）和 $\\sigma_{r} \\sim \\text{HalfCauchy}(\\lambda)$。通过踏脚石采样估计边际似然，使用 $K = 64$ 个踏脚石，其幂次根据 $\\text{Beta}(\\alpha,1)$ 分布（其中 $\\alpha = 0.3$）的分位数给出，以将踏脚石集中在先验附近，每个踏脚石运行 $2 \\times 10^{6}$ 次迭代，并设 $25\\%$ 的预烧期，每个模型至少进行 $2$ 次独立重复，评估混合情况和有效样本量。使用相等的模型先验 $p(M)$，并用从估计的边际似然计算出的贝叶斯因子比较模型。\n\nC. 在每个模型下使用踏脚石采样，设 $K = 12$ 个踏脚石，幂次在 $[0,1]$ 内线性间隔。对于 UCLN，将分支速率建模为独立的伽马分布变量，具有一个共享的方差参数 $\\sigma^{2}$，并设置一个不当先验 $p(\\sigma) \\propto 1/\\sigma$ 以避免过度正则化。对于局域时钟，在每个踏脚石处根据后验树估计植物对昆虫的分区，以反映分区的不确定性。对于校准，通过将节点年龄固定在其化石最小值来施加硬性界限，以稳定链。对平均时钟速率使用 $(0,\\infty)$ 上的均匀先验。\n\nD. 实施幂后验采样，但使用初步严格时钟运行的后验预测分布作为最终运行的先验，以稳定估计。对于所有模型，将时钟速率的正态先验中心设在最大似然估计值上，并使用小方差以改善收敛。对于局域时钟，允许使用泊松先验估计局域时钟的数量，但将分区限制为那些根据全部数据计算出的后验分支概率超过 $0.95$ 的分区。使用调和平均估计量计算贝叶斯因子，以交叉检验踏脚石估计，并选择后验平均偏差最小的模型。", "solution": "该问题陈述是设计贝叶斯系统发育模型选择实验的一个有效练习。它具有科学依据、问题明确且客观。它提供了一个涉及分子钟定年的现实场景，这是演化生物学中的一项常见任务。所有提供的数据和约束条件都是一致且充分的，足以评估所提出的策略。因此，我将进行全面分析。\n\n目标是使用从边际似然估计得出的贝叶斯因子来比较三种分子钟模型——严格时钟、双分区局域时钟和不相关对数正态（UCLN）弛豫时钟。模型 $M$ 和数据 $y$ 的边际似然 $p(y \\mid M)$ 定义为似然函数对所有模型参数 $\\theta$ 的先验分布进行积分：\n$$\np(y \\mid M) = \\int p(y \\mid \\theta, M) \\, p(\\theta \\mid M) \\, d\\theta\n$$\n贝叶斯因子 $K_{12} = p(y \\mid M_1) / p(y \\mid M_2)$ 量化了数据为模型 $M_1$ 相对于模型 $M_2$ 提供的证据。为了使这种比较在统计上有效，有两个条件至关重要：\n1. 每个模型中所有参数的先验 $p(\\theta \\mid M)$ 必须是**正常的**，即它们积分到一个有限值（通常为 $1$）。不当先验会导致未定义的边际似然，从而导致任意的贝叶斯因子。\n2. 跨模型共享的参数（例如，替换模型、树先验）的先验必须相同，以确保边际似然的任何差异反映的是时钟模型本身的拟合度，而不是其他模型组件的差异。\n\n似然比检验拒绝严格时钟（$p  0.001$）是一个频率学派的结果。在贝叶斯框架中，这不构成将该模型排除在比较之外的理由。相反，严格时钟作为一个重要的基准或零假设，用以衡量更复杂模型的证据强度。贝叶斯因子的大小将精确量化弛豫时钟模型拟合数据的优越程度。\n\n踏脚石采样是估计边际似然的一种稳健方法。其准确性取决于用于连接先验和后验的“踏脚石”（幂后验）的数量、这些踏脚石的位置以及为确保收敛而为每个踏脚石运行的模拟长度。最佳实践建议使用大量的踏脚石，将它们集中在先验附近（例如，通过根据 $\\text{Beta}(\\alpha, 1)$ 分布且 $\\alpha  1$ 的分位数来间隔幂 $\\beta$），并运行长 MCMC 链并进行收敛诊断。\n\n化石校准最好作为节点年龄的“软性”概率先验（例如，带偏移的对数正态或指数分布）来整合，而不是硬性界限。这种方法恰当地反映了化石提供了一个最小年龄，但真实年龄可能更老这一固有的不确定性。\n\n在这些原则的基础上，我将评估每个选项。\n\nA. 一次性固定最大似然拓扑和分支长度，并在每个时钟模型下的后验样本上通过马尔可夫链蒙特卡罗计算赤池信息准则（AICM）。对时钟速率使用不当的 Jeffreys 先验以避免影响后验。对于校准，施加等于化石最小值的硬性下限且无上限。因为严格时钟被拒绝，所以将其从边际似然估计中排除。对于踏脚石采样，使用 $K = 10$ 个踏脚石，其幂次均匀间隔，每个踏脚石进行 $5 \\times 10^{4}$ 次迭代。\n\n此选项包含多个严重的方法论缺陷。\n1. 贝叶斯推断旨在对不确定性进行积分。将拓扑和分支长度固定为单个最大似然估计值，会丢弃所有关于树结构和分化时间不确定性的信息，而这正是使用贝叶斯方法的主要动机之一。\n2. 问题明确要求通过边际似然进行比较以获得贝叶斯因子。AICM 是一种基于信息准则的模型选择方法，而不是边际似然。\n3. 使用不当的 Jeffreys 先验是一个关键错误。对于具有不当先验的模型，边际似然没有定义，使得贝叶斯因子的计算成为不可能。\n4. 施加硬性下限而无上限（即从 $t_{\\min}$ 到 $\\infty$ 的均匀先验）也是一个不当先验，加剧了前一个错误。\n5. 基于 LRT 结果排除严格时钟在贝叶斯背景下是糟糕的做法。模型比较的目的是量化支持或反对所有候选模型的证据，包括最简单的模型。\n6. 建议的踏脚石设置（$K=10$ 个踏脚石，线性间隔）是次优的，不如现代替代方案准确。\n**结论**：错误。\n\nB. 对于每个模型，使用相同的替换过程（广义时间可逆加 Gamma，记为 GTR+$\\Gamma$）和相同的带采样的校准出生-死亡树先验，对树拓扑和节点时间进行积分。为交换率和碱基频率分配狄利克雷先验，为 gamma 形状参数分配指数先验，并为时间树分配一个正常的、校准过的出生-死亡先验，其中化石校准实现为带偏移的对数正态先验：对于校准 $i \\in \\{1,2,3\\}$，$t_{i} \\sim \\text{Lognormal}(\\mu_{i}, \\sigma_{i})$，在 $t_{\\min,i}$ 处有偏移量，且 $\\mu_{i}, \\sigma_{i}$ 为有限值。对于严格时钟，为平均速率设置一个对数正态先验 $r \\sim \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$。对于双分区局域时钟，先验地定义两个不相交的单系分区（植物对昆虫），为分区特定的速率 $r_{1}, r_{2}$ 分配独立的对数正态先验，并设置一个弱信息层级先验 $\\log r_{j} \\sim \\mathcal{N}(\\mu_{r}, \\tau^{2})$，其中 $\\mu_{r}$ 和 $\\tau$ 具有正常的先验。对于不相关对数正态弛豫时钟（UCLN），将分支特异性速率 $r_{b}$ 独立地分配为对数正态分布，其对数尺度上的均值参数为 $\\mu_{r}$，标准差参数为 $\\sigma_{r}$，即 $r_{b} \\stackrel{\\text{i.i.d.}}{\\sim} \\text{Lognormal}(\\mu_{r}, \\sigma_{r})$，并设置正常的超先验，例如 $\\mu_{r} \\sim \\text{Normal}(\\mu_{0}, \\sigma_{0}^{2})$（截断为正速率）和 $\\sigma_{r} \\sim \\text{HalfCauchy}(\\lambda)$。通过踏脚石采样估计边际似然，使用 $K = 64$ 个踏脚石，其幂次根据 $\\text{Beta}(\\alpha,1)$ 分布（其中 $\\alpha = 0.3$）的分位数给出，以将踏脚石集中在先验附近，每个踏脚石运行 $2 \\times 10^{6}$ 次迭代，并设 $25\\%$ 的预烧期，每个模型至少进行 $2$ 次独立重复，评估混合情况和有效样本量。使用相等的模型先验 $p(M)$，并用从估计的边际似然计算出的贝叶斯因子比较模型。\n\n此选项描述了一种先进且统计上严谨的方法。\n1. 它正确地指定了对树拓扑和节点时间进行积分。\n2. 它对所有共享参数（替换模型、树先验）使用了一致、正常且标准的先验。\n3. 使用带偏移的对数正态分布实现化石校准是最佳实践，正确地模拟了“软性”界限。\n4. 所有三种时钟模型（严格、局域、UCLN）的先验设定都是恰当的，使用了正常且弱信息的分布。对局域时钟和 UCLN 模型的层级结构的描述是正确的。对方差参数使用半柯西先验是一种现代且备受推崇的选择。\n5. 踏脚石采样策略是最佳实践的教科书式范例：大量的踏脚石（$K=64$）、集中在先验附近的幂间隔（$\\text{Beta}(0.3, 1)$）、带有预烧期的长运行、多次重复以及收敛性检查（ESS）。\n6. 最后一步，在等模型先验下从估计的边际似然计算贝叶斯因子，是所述程序的正确结论。\n**结论**：正确。\n\nC. 在每个模型下使用踏脚石采样，设 $K = 12$ 个踏脚石，幂次在 $[0,1]$ 内线性间隔。对于 UCLN，将分支速率建模为独立的伽马分布变量，具有一个共享的方差参数 $\\sigma^{2}$，并设置一个不当先验 $p(\\sigma) \\propto 1/\\sigma$ 以避免过度正则化。对于局域时钟，在每个踏脚石处根据后验树估计植物对昆虫的分区，以反映分区的不确定性。对于校准，通过将节点年龄固定在其化石最小值来施加硬性界限，以稳定链。对平均时钟速率使用 $(0,\\infty)$ 上的均匀先验。\n\n此选项在根本上是有缺陷的。\n1. 它提出了两个独立的不当先验：UCLN 方差的 $p(\\sigma) \\propto 1/\\sigma$ 和平均时钟速率在 $(0, \\infty)$ 上的均匀先验。如前所述，不当先验使边际似然估计无效。\n2. 它将要求比较的 UCLN 时钟错误地指定为“不相关伽马”模型。虽然这是一种可能的模型，但它不是要求比较的模型。\n3. 它将固定分区的局域时钟与一个更复杂的、分区被估计的模型混为一谈。这改变了被测试的模型，并给边际似然估计带来了巨大挑战。\n4. 将节点年龄固定为化石最小值是一种糟糕且在统计上不健全的做法，它忽略了不确定性并可能严重偏倚结果。\n5. 踏脚石设置（$K=12$，线性间隔）是次优的。\n**结论**：错误。\n\nD. 实施幂后验采样，但使用初步严格时钟运行的后验预测分布作为最终运行的先验，以稳定估计。对于所有模型，将时钟速率的正态先验中心设在最大似然估计值上，并使用小方差以改善收敛。对于局域时钟，允许使用泊松先验估计局域时钟的数量，但将分区限制为那些根据全部数据计算出的后验分支概率超过 $0.95$ 的分区。使用调和平均估计量计算贝叶斯因子，以交叉检验踏脚石估计，并选择后验平均偏差最小的模型。\n\n此选项推荐了几个在统计上有问题或不正确的程序。\n1. 使用初步分析的后验分布作为最终分析的先验构成了“两次使用数据”。这使得贝叶斯模型比较的哲学基础失效，因为先验不再代表*先验*信念。由此产生的贝叶斯因子将无法以标准方式解释。\n2. 类似地，将先验中心设在从相同数据导出的最大似然估计值上，会偏向于那些点估计接近整体最大似然的模型，并人为地夸大它们的边际似然。\n3. 它提出了一个“随机局域时钟”模型，其中分区的数量被估计，这并非问题陈述中指定的双分区模型。\n4. 它建议使用调和平均估计量。这个估计量是出了名的不可靠，已知具有无穷大方差，几乎总是严重高估边际似然的值。它不是一种有效的交叉检验方法，并且已被踏脚石采样等方法所取代。\n5. 它最后建议根据偏差信息准则（DIC，由“后验平均偏差”暗示）来选择模型，这与问题明确指示使用边际似然和贝叶斯因子的要求相矛盾。\n**结论**：错误。\n\n基于此分析，选项 B 是唯一描述了与现代贝叶斯系统发育学最佳实践相符的、连贯、有效且可辩护的策略的选项。它正确地指定了正常先验的使用、恰当的校准方法，以及用于边际似然估计的稳健的踏脚石采样实现。", "answer": "$$\\boxed{B}$$", "id": "2590771"}]}