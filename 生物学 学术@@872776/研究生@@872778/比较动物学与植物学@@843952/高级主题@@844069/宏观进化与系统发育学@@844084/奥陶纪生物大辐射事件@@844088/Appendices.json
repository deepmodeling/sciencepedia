{"hands_on_practices": [{"introduction": "分析任何地质历史事件的第一步，是确定其发生的时间和持续时长。古生物学家利用火山灰层中的放射性同位素定年，来为含有化石的沉积层提供精确的时间坐标。本练习将演示如何根据地层上下叠覆的火山灰层的年龄及其不确定性，来估算奥陶纪生物大辐射主要阶段的持续时间 [@problem_id:2616920]，这是定量研究宏观演化事件节奏的基础。", "problem": "在奥陶纪生物大辐射事件（GOBE）期间，一个关键区间由一个首次主要动物群更替层位（主要多样化脉冲的开始）和一个后期的更替层位（主要脉冲的停止）所确定。这些记录保存在一个连续的海相陆棚地层序列中，该序列中还保存有夹层的火山灰床。地层关系遵循叠覆律：越深的地层越老。四个火山灰床精确地限定了这两个层位，并通过化学研磨-同位素稀释-热电离质谱法（CA–ID–TIMS）测定了高精度的铀-铅锆石年龄。年龄以 $95\\%$ 的置信度报告为 $2\\sigma$ 界限，并假设其具有独立的、近似高斯分布的不确定性。相对于分析不确定性，火山灰降落和埋藏之间的沉积延迟可以忽略不计。\n\n起始层位界限：\n- 起始层位正下方的火山灰床：年龄 $L_1 = 470.52 \\pm 0.12$ 百万年前 (Ma)。\n- 起始层位正上方的火山灰床：年龄 $L_2 = 469.98 \\pm 0.10$ Ma。\n\n终止层位界限：\n- 终止层位正下方的火山灰床：年龄 $U_1 = 468.47 \\pm 0.08$ Ma。\n- 终止层位正上方的火山灰床：年龄 $U_2 = 468.12 \\pm 0.09$ Ma。\n\n仅使用叠覆律、放射性测年得出的绝对年龄代表地质时间轴上的时刻（年代越老，以Ma为单位的年龄数值越大）的定义，以及对独立 $2\\sigma$ 不确定性的标准处理方法，通过对界限年龄进行区间传播，估算GOBE主要脉冲的保守 $95\\%$ 置信度的最小和最大持续时间。将持续时间 $D$ 定义为起始年龄减去终止年龄，从而使 $D$ 为正值。将最小和最大持续时间都以百万年（Myr）为单位表示，并将每个值四舍五入到三位有效数字。", "solution": "该问题要求确定一个地质区间的持续时间的保守 $95\\%$ 置信区间，该区间由一个起始层位和一个终止层位定义。这些层位的绝对年龄受四个在地层上限定它们的火山灰床的铀-铅年龄所约束。解决方案通过应用叠覆原理和区间传播法来进行。\n\n首先，我们确定每个火山灰床真实年龄的 $95\\%$ 置信区间。问题陈述不确定性为 $2\\sigma$，这对应于高斯分布变量的 $95\\%$ 置信水平。一个以 $\\mu \\pm \\delta$ 形式给出的年龄，其中 $\\delta$ 是 $2\\sigma$ 不确定性，对应于一个 $95\\%$ 的置信区间 $[\\mu - \\delta, \\mu + \\delta]$。\n\n起始层位的界限年龄为：\n- 火山灰床 $L_1$（起始层位下方）：年龄 $A_{L1} = 470.52 \\pm 0.12$ 百万年前 (Ma)。其年龄的 $95\\%$ 置信区间为 $[470.52 - 0.12, 470.52 + 0.12]$，即 $[470.40, 470.64]$ Ma。\n- 火山灰床 $L_2$（起始层位上方）：年龄 $A_{L2} = 469.98 \\pm 0.10$ Ma。其年龄的 $95\\%$ 置信区间为 $[469.98 - 0.10, 469.98 + 0.10]$，即 $[469.88, 470.08]$ Ma。\n\n终止层位的界限年龄为：\n- 火山灰床 $U_1$（终止层位下方）：年龄 $A_{U1} = 468.47 \\pm 0.08$ Ma。其 $95\\%$ 置信区间为 $[468.47 - 0.08, 468.47 + 0.08]$，即 $[468.39, 468.55]$ Ma。\n- 火山灰床 $U_2$（终止层位上方）：年龄 $A_{U2} = 468.12 \\pm 0.09$ Ma。其 $95\\%$ 置信区间为 $[468.12 - 0.09, 468.12 + 0.09]$，即 $[468.03, 468.21]$ Ma。\n\n根据叠覆律，更深的地层年代更老。由于年龄以 Ma（百万年*前*）为单位，年代更老的事件具有更大的数值。起始层位的年龄为 $T_{onset}$，在地层上位于 $L_1$ 和 $L_2$ 灰床之间。因此，它必定比 $L_1$ 年轻，比 $L_2$ 古老。这给出了不等式 $A_{L2}  T_{onset}  A_{L1}$。为了找到与界限年龄的 $95\\%$ 置信区间一致的 $T_{onset}$ 最保守（最宽）的可能区间，我们必须使用 $A_{L2}$ 区间的最小值和 $A_{L1}$ 区间的最大值。这就定义了起始年龄的区间 $I_{onset}$。\n$$I_{onset} = [\\min(A_{L2}), \\max(A_{L1})] = [469.88, 470.64] \\text{ Ma}$$\n\n类似地，终止层位的年龄为 $T_{cessation}$，位于 $U_1$ 和 $U_2$ 灰床之间。它必定比 $U_1$ 年轻，比 $U_2$ 古老。这给出了不等式 $A_{U2}  T_{cessation}  A_{U1}$。终止年龄的保守区间 $I_{cessation}$ 由 $A_{U2}$ 区间的最小值和 $A_{U1}$ 区间的最大值定义。\n$$I_{cessation} = [\\min(A_{U2}), \\max(A_{U1})] = [468.03, 468.55] \\text{ Ma}$$\n\nGOBE脉冲的持续时间定义为 $D = T_{onset} - T_{cessation}$。为了找到该持续时间的最小和最大可能值，我们必须对 $I_{onset}$ 和 $I_{cessation}$ 进行区间减法运算。\n\n最小持续时间 $D_{min}$ 通过从最小可能起始年龄中减去最大可能终止年龄得到：\n$$D_{min} = \\min(I_{onset}) - \\max(I_{cessation}) = 469.88 \\text{ Ma} - 468.55 \\text{ Ma} = 1.33 \\text{ Myr}$$\n\n最大持续时间 $D_{max}$ 通过从最大可能起始年龄中减去最小可能终止年龄得到：\n$$D_{max} = \\max(I_{onset}) - \\min(I_{cessation}) = 470.64 \\text{ Ma} - 468.03 \\text{ Ma} = 2.61 \\text{ Myr}$$\n\n问题要求答案四舍五入到三位有效数字。两个结果，$1.33$ 和 $2.61$，已经是这种形式。因此，GOBE主要脉冲持续时间的保守 $95\\%$ 置信区间为 $1.33$ 百万年至 $2.61$ 百万年。", "answer": "$$\\boxed{\\begin{pmatrix} 1.33  2.61 \\end{pmatrix}}$$", "id": "2616920"}, {"introduction": "在确定了时间框架后，下一步是量化“生物多样性”的增长。由于化石记录的取样强度不均，直接统计化石数量会产生误导。本练习将介绍一种现代统计学校正方法——股东名额二次抽样（Shareholder Quorum Subsampling, SQS），以获得可比较的物种丰富度估计值 [@problem_id:2616930]。通过将该方法应用于模拟的奥陶纪数据，我们将学习如何克服取样偏差，揭示属级分类单元丰富度的真实变化趋势。", "problem": "在比较动物学和植物学中，研究人员通过量化连续各个阶的标准化物种丰富度来研究奥陶纪生物大辐射事件 (Great Ordovician Biodiversification Event, GOBE)，尽管抽样强度存在巨大差异。考虑以下一个关于海洋无脊椎动物属的真实奥陶纪示例，其目的在于相同的研究方案也可以应用于植物孢粉属，以实现跨领域的比较。现有三个连续阶的数据，其出现数据已在阶的层面上进行了汇总。基本出发点是：依据 Good 和 Turing 的抽样覆盖度，其中 Good 覆盖度估计量由 $\\hat{C} = 1 - f_{1}/n$ 给出，这里 $n$ 是总出现次数，$f_{1}$ 是单次出现属（仅出现一次的属）的数量；以及在股东定额二次抽样 (Shareholder Quorum Subsampling, SQS) 中“股东”的定义，其中属 $i$ 的份额为 $p_{i} = f_{i}/n$，一组抽样属的累积覆盖度是它们份额的总和。\n\n阶层面的数据：\n- 弗洛阶 (Floian): 总出现次数 $n_{\\mathrm{Fl}} = 80$，单次出现属数量 $f_{1,\\mathrm{Fl}} = 28$。\n- 大坪阶 (Dapingian): 总出现次数 $n_{\\mathrm{Da}} = 400$，单次出现属数量 $f_{1,\\mathrm{Da}} = 60$。最常见属的份额如下（已归一化，使得 $\\sum_i p_i = 1$）：\n$$\\{0.16,\\,0.12,\\,0.10,\\,0.08,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.03,\\,0.03,\\,0.02,\\,0.02,\\ldots\\}.$$\n- 达瑞威尔阶 (Darriwilian): 总出现次数 $n_{\\mathrm{Dr}} = 1200$，单次出现属数量 $f_{1,\\mathrm{Dr}} = 90$。最常见属的份额如下：\n$$\\{0.10,\\,0.09,\\,0.08,\\,0.07,\\,0.06,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.04,\\,0.03,\\,0.03,\\,0.03,\\,0.02,\\,0.02,\\ldots\\}.$$\n\n你的目标是在固定的股东定额 $q = 0.7$ 下，估计并比较这些阶的属丰富度，尽管各阶之间的 $n$ 值存在数量级的差异。假设每个阶的抽样在空间上是混合的，使得汇总的出现频率具有生态学上的可解释性，并且假设同样的工作流程将独立应用于植物孢粉，以比较植物学和动物学的趋势。\n\n在股东定额二次抽样 (SQS) 和 $q = 0.7$ 的条件下，哪个选项正确地描述了处理这些数据的流程，并给出了最终的标准化丰富度趋势？\n\nA. 对于每个阶，计算 $\\hat{C}$；剔除 $\\hat{C}  q$ 的阶；在保留的阶中，以与 $p_{i}$ 成正比的选择概率进行无放回抽样，重复抽取属，直到不重复属的累积份额首次达到或超过 $q$；此时不重复属的数量即为该次试验的标准化丰富度。通过对多次试验结果取平均，可以获得估计值和不确定性。对于大坪阶，最常见属的累积份额在第十个属时达到 $0.72$，因此标准化丰富度约为 $10$；对于达瑞威尔阶，累积份额在第十二个属时达到 $0.70$，因此标准化丰富度约为 $12$；弗洛阶被排除，因为 $\\hat{C}_{\\mathrm{Fl}} = 1 - 28/80 = 0.65  0.7$。最终趋势显示，从大坪阶到 达瑞威尔阶，属的数量从约 $10$ 个增加到 $12$ 个，与 GOBE 期间的增长趋势一致。\n\nB. 汇总所有阶，并通过二次抽样使每个阶的采集样本数相等；然后计算不同属的数量，而不使用覆盖度估计。因为达瑞威尔阶的头部份额分布更均匀，所以在 $q = 0.7$ 时其标准化丰富度会比大坪阶低，因此大坪阶约有 $12$ 个属，达瑞威尔阶约有 $10$ 个属，并且无论 $\\hat{C}$ 如何，弗洛阶都将被保留。\n\nC. 对于每个阶，设置一个自适应定额 $q' = \\min(q,\\hat{C})$，这样即使是覆盖度不足的阶也能被分析；然后，对于 $\\hat{C}_{\\mathrm{Fl}} = 0.65$ 的弗洛阶，使用 $q' = 0.65$，而对其他阶使用 $q' = 0.7$。按丰度降序包含各个属，直到累积份额达到 $q'$。这确保了所有阶都被保留，并且即使在 $\\hat{C}  q$ 的情况下，也能在各阶之间产生严格无偏的比较。\n\nD. 对于每个阶，计算基于丰度的 Chao 1 估计量，并将其作为标准化丰富度，无需进行二次抽样或覆盖度匹配。因为 Chao 1 通过单次出现项 $f_{1}$ 和两次出现项 $f_{2}$ 进行调整，它内在地校正了样本量的差异，并且等同于 $q = 0.7$ 时的 SQS，因此报告的丰富度将与 SQS 计数相匹配，即大坪阶约有 $12$ 个属，达瑞威尔阶约有 $10$ 个属，并且所有阶都将被保留，无论 $\\hat{C}$ 值如何。", "solution": "该问题要求应用股东定额二次抽样 (Shareholder Quorum Subsampling, SQS) 方法，在固定的定额 $q = 0.7$ 下，比较三个奥陶纪阶的属丰富度。在进行解答之前，必须对问题陈述进行严格的验证。\n\n**问题验证**\n\n**第一步：提取已知条件**\n- **方法论：** 股东定额二次抽样 (SQS)。\n- **定额水平：** $q = 0.7$。\n- **Good 覆盖度估计量公式：** $\\hat{C} = 1 - f_{1}/n$。\n- **属 $i$ 的份额公式：** $p_{i} = f_{i}/n$。\n- **弗洛阶 (Floian) 数据：** 总出现次数 $n_{\\mathrm{Fl}} = 80$，单次出现属数量 $f_{1,\\mathrm{Fl}} = 28$。\n- **大坪阶 (Dapingian) 数据：** 总出现次数 $n_{\\mathrm{Da}} = 400$，单次出现属数量 $f_{1,\\mathrm{Da}} = 60$。最常见属的份额为 $\\{0.16,\\,0.12,\\,0.10,\\,0.08,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.03,\\,0.03,\\,0.02,\\,0.02,\\ldots\\}$。\n- **达瑞威尔阶 (Darriwilian) 数据：** 总出现次数 $n_{\\mathrm{Dr}} = 1200$，单次出现属数量 $f_{1,\\mathrm{Dr}} = 90$。最常见属的份额为 $\\{0.10,\\,0.09,\\,0.08,\\,0.07,\\,0.06,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.04,\\,0.03,\\,0.03,\\,0.03,\\,0.02,\\,0.02,\\ldots\\}$。\n- **目标：** 使用 SQS 在 $q = 0.7$ 时，确定正确的流程和由此产生的标准化丰富度趋势。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据。奥陶纪生物大辐射事件是古生物学研究的一个主要课题。所引用的方法——Good 覆盖度估计量和股东定额二次抽样——是定量生态学和古生物学中用于标准化抽样工作的成熟技术。所提供的数据内部一致，对于古生物出现数据集来说是合理的。问题提法得当，提供了足够的信息来应用指定的方法并评估各个选项。术语精确客观。该问题没有违反任何数学或生物学的基本原则。这是一个已知统计程序的直接应用。\n\n**第三步：结论与行动**\n问题陈述有效。我将进行完整的推导和分析。\n\n**标准化丰富度的推导**\n\nSQS 协议分两个阶段进行。\n\n**第一阶段：覆盖度评估**\n每个阶的样本覆盖度使用 Good 估计量 $\\hat{C} = 1 - f_1/n$ 计算。只有当一个阶的样本覆盖度 $\\hat{C}$ 大于或等于指定的定额 $q$ 时，该阶才被保留用于分析。这里，$q = 0.7$。\n\n- **弗洛阶 (Floian Stage):**\n$n_{\\mathrm{Fl}} = 80$, $f_{1,\\mathrm{Fl}} = 28$。\n$$\\hat{C}_{\\mathrm{Fl}} = 1 - \\frac{f_{1,\\mathrm{Fl}}}{n_{\\mathrm{Fl}}} = 1 - \\frac{28}{80} = 1 - 0.35 = 0.65.$$\n由于 $\\hat{C}_{\\mathrm{Fl}} = 0.65  0.7$，弗洛阶的抽样覆盖度不足以标准化到 $q=0.7$ 的定额。因此，必须将其从比较中排除。\n\n- **大坪阶 (Dapingian Stage):**\n$n_{\\mathrm{Da}} = 400$, $f_{1,\\mathrm{Da}} = 60$。\n$$\\hat{C}_{\\mathrm{Da}} = 1 - \\frac{f_{1,\\mathrm{Da}}}{n_{\\mathrm{Da}}} = 1 - \\frac{60}{400} = 1 - 0.15 = 0.85.$$\n由于 $\\hat{C}_{\\mathrm{Da}} = 0.85 \\ge 0.7$，大坪阶被保留用于分析。\n\n- **达瑞威尔阶 (Darriwilian Stage):**\n$n_{\\mathrm{Dr}} = 1200$, $f_{1,\\mathrm{Dr}} = 90$。\n$$\\hat{C}_{\\mathrm{Dr}} = 1 - \\frac{f_{1,\\mathrm{Dr}}}{n_{\\mathrm{Dr}}} = 1 - \\frac{90}{1200} = 1 - 0.075 = 0.925.$$\n由于 $\\hat{C}_{\\mathrm{Dr}} = 0.925 \\ge 0.7$，达瑞威尔阶也被保留用于分析。\n\n**第二阶段：在定额下的丰富度计算**\n对于保留的阶，标准化丰富度是最丰富的属的数量，这些属的累积频率份额 $p_i$ 的总和达到或超过定额 $q=0.7$。我们按降序对提供的份额进行求和。\n\n- **大坪阶在 $q=0.7$ 时的丰富度：**\n份额为 $\\{0.16,\\,0.12,\\,0.10,\\,0.08,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.03,\\,0.03,\\, \\ldots\\}$。\n份额的累积和为：\n - $1$ 个属: $0.16$\n - $2$ 个属: $0.16 + 0.12 = 0.28$\n - $3$ 个属: $0.28 + 0.10 = 0.38$\n - $4$ 个属: $0.38 + 0.08 = 0.46$\n - $5$ 个属: $0.46 + 0.06 = 0.52$\n - $6$ 个属: $0.52 + 0.05 = 0.57$\n - $7$ 个属: $0.57 + 0.05 = 0.62$\n - $8$ 个属: $0.62 + 0.04 = 0.66$\n - $9$ 个属: $0.66 + 0.03 = 0.69$\n - $10$ 个属: $0.69 + 0.03 = 0.72$\n在包含第10个属时，累积份额首次达到或超过 $0.7$。因此，大坪阶的 SQS 丰富度为 $10$。\n\n- **达瑞威尔阶在 $q=0.7$ 时的丰富度：**\n份额为 $\\{0.10,\\,0.09,\\,0.08,\\,0.07,\\,0.06,\\,0.06,\\,0.05,\\,0.05,\\,0.04,\\,0.04,\\,0.03,\\,0.03,\\,0.03,\\, \\ldots\\}$。\n份额的累积和为：\n - $1$ 个属: $0.10$\n - $2$ 个属: $0.10 + 0.09 = 0.19$\n - $3$ 个属: $0.19 + 0.08 = 0.27$\n - $4$ 个属: $0.27 + 0.07 = 0.34$\n - $5$ 个属: $0.34 + 0.06 = 0.40$\n - $6$ 个属: $0.40 + 0.06 = 0.46$\n - $7$ 个属: $0.46 + 0.05 = 0.51$\n - $8$ 个属: $0.51 + 0.05 = 0.56$\n - $9$ 个属: $0.56 + 0.04 = 0.60$\n - $10$ 个属: $0.60 + 0.04 = 0.64$\n - $11$ 个属: $0.64 + 0.03 = 0.67$\n - $12$ 个属: $0.67 + 0.03 = 0.70$\n在包含第12个属时，累积份额首次达到或超过 $0.7$。因此，达瑞威尔阶的 SQS 丰富度为 $12$。\n\n**推导结论**\nSQS 分析排除了弗洛阶。它显示标准化属丰富度从大坪阶的 $10$ 增加到达瑞威尔阶的 $12$。\n\n**逐项分析选项**\n\n**A.** 该选项正确地陈述了必须首先计算 $\\hat{C}$ 并剔除 $\\hat{C}  q$ 的阶。它正确地计算出 $\\hat{C}_{\\mathrm{Fl}} = 1 - 28/80 = 0.65$，并正确地得出弗洛阶被排除的结论。它正确地计算出，对于大坪阶，前十个属的累积份额为 $0.72$，得出的丰富度约为 $10$。它正确地计算出，对于达瑞威尔阶，前十二个属的累积份额为 $0.70$，得出的丰富度约为 $12$。最后，它正确地指出了从 $10$ 增加到 $12$ 的趋势，与 GOBE 期间的增长相符。二次抽样过程的描述略有混乱，它描述了一种基于随机试验的方法，但随后使用了更简单的确定性计算，但这不影响基本步骤和最终数值结果的正确性。**正确。**\n\n**B.** 该选项提出了一个完全不正确的程序。它建议汇总所有阶并使用经典稀疏化，这不是 SQS。它错误地指出弗洛阶将被保留，忽略了强制性的覆盖度检查。它断言大坪阶的丰富度（$12$）高于达瑞威尔阶（$10$），这与正确结果相反。其关于在固定定额下，更高的均匀度导致更低丰富度的生态学推理是根本错误的；事实恰恰相反。对于一个目标累积频率份额，一个更均匀的分布需要加总更多的分类单元，从而产生更高的丰富度。**错误。**\n\n**C.** 该选项提出了一个“自适应定额” $q' = \\min(q,\\hat{C})$。这违反了标准化原则，即在“共同”的基准上比较样本。将一个在 $q=0.65$ 时的丰富度值与另一个在 $q=0.7$ 时的值进行比较，不是一个有效的、无偏的比较；这正是 SQS 严格的定额规则旨在防止的那种错误。声称该方法“产生严格无偏的比较”是错误的。**错误。**\n\n**D.** 该选项错误地将 SQS 与 Chao 1 渐近丰富度估计量混为一谈。这些是根本不同的指标：SQS 衡量在指定样本完备度水平上的丰富度，而 Chao 1 试图估计总丰富度，包括未观察到的分类单元。声称 Chao 1 “等同于 q=0.7 时的 SQS”是毫无根据的。此外，Chao 1 估计量需要两次出现项 ($f_2$) 的计数，而问题陈述中并未提供此信息。它还颠倒了正确的丰富度趋势，与选项B类似，并错误地保留了弗洛阶。**错误。**", "answer": "$$\\boxed{A}$$", "id": "2616930"}, {"introduction": "总的物种多样性（伽马多样性, $\\Gamma$）的简单增长并不能揭示故事的全貌。这种增长可能源于局域群落内物种数量的增加（阿尔法多样性, $\\alpha$），也可能源于不同地区间群落组成的差异化增大（贝塔多样性, $\\beta$）。本练习将运用 Whittaker 的多样性划分框架，将宏观区域的多样性分解为不同尺度上的组分 [@problem_id:2616852]。通过这种方式，我们可以诊断奥陶纪生物大辐射主要是由区域内物种的累积驱动，还是由区域间动物群的特有化驱动。", "problem": "考虑奥陶纪生物大辐射事件（Great Ordovician Biodiversification Event, GOBE），在此事件中，分类学丰富度在各个海洋省迅速扩张。使用有无出现矩阵，基于群落生态学和生物地理学中的以下核心定义，来量化省内和省际的多样性分配。\n\n使用的基本定义：\n- 局域（样本水平）alpha多样性：单个集合（行）中的分类单元数量，即该行中存在值等于 $1$ 的分类单元的计数。\n- 省级gamma多样性：在一个时间区间内，从一个省的所有集合中发现的不同分类单元的总数，即在该省和该时间区间内的所有行中至少有一次存在的分类单元的计数。\n- 平均省级gamma多样性：一个时间区间内，各省的省级gamma多样性的算术平均值。\n- Whittaker beta多样性（省内）：乘法划分 $ \\beta_{\\mathrm{W}} = \\gamma / \\overline{\\alpha} $，其中 $ \\overline{\\alpha} $ 是一个时间区间内某省各集合的平均alpha多样性，而 $ \\gamma $ 是该时间区间内该省的省级gamma多样性。\n- 大区内省际乘法分异：$ \\beta_{\\mathrm{among}} = \\Gamma / \\overline{\\gamma} $，其中 $ \\Gamma $ 是大区gamma多样性（该时间区间内所有省合并后的不同分类单元数量），而 $ \\overline{\\gamma} $ 是该时间区间内各省省级gamma多样性的平均值。\n\n对于一个大区内和一个固定时间区间内的跨省层级乘法划分，大区gamma多样性满足\n$$\n\\Gamma = \\overline{\\gamma} \\times \\beta_{\\mathrm{among}}.\n$$\n\n为诊断连续时间区间之间大区gamma多样性变化的驱动因素，使用对数可加性：\n$$\n\\Delta \\log \\Gamma = \\Delta \\log \\overline{\\gamma} + \\Delta \\log \\beta_{\\mathrm{among}}.\n$$\n按如下方式定义两个连续时间区间之间变化的驱动因素。设 $ \\Delta \\log \\overline{\\gamma} $ 为省内累积分量，$ \\Delta \\log \\beta_{\\mathrm{among}} $ 为省际分异分量。如果 $ \\left| \\Delta \\log \\overline{\\gamma} \\right| > \\left| \\Delta \\log \\beta_{\\mathrm{among}} \\right| $，返回整数 $1$（省内累积占主导）。如果 $ \\left| \\Delta \\log \\overline{\\gamma} \\right|  \\left| \\Delta \\log \\beta_{\\mathrm{among}} \\right| $，返回整数 $-1$（省际分异占主导）。如果 $ \\left| \\Delta \\log \\overline{\\gamma} \\right| $ 和 $ \\left| \\Delta \\log \\beta_{\\mathrm{among}} \\right| $ 的差值小于容差 $ \\varepsilon = 10^{-9} $，返回整数 $0$（平局）。所有多样性量均为无量纲。\n\n输入数据（测试套件）：三个奥陶纪时间区间，分别代表GOBE前、GOBE早期和GOBE高峰期。对于每个时间区间，给定一个共享的分类单元列表（列）以及Laurentia和Baltica的有无矩阵（行为集合；条目为 $0$ 或 $1$）。在每个时间区间内，列按分类单元名称对齐。\n\n时间区间1（GOBE前）：分类单元 $[A,B,C,D,E]$。\n- Laurentia $L_1$ ($3 \\times 5$):\n  - $[1,1,0,0,0]$\n  - $[0,1,1,0,0]$\n  - $[1,0,1,1,0]$\n- Baltica $B_1$ ($3 \\times 5$):\n  - $[1,1,0,0,0]$\n  - $[0,1,1,0,1]$\n  - $[1,0,1,0,0]$\n\n时间区间2（GOBE早期）：分类单元 $[A,B,C,D,E,F,G,H]$。\n- Laurentia $L_2$ ($4 \\times 8$):\n  - $[1,1,0,1,0,1,0,0]$\n  - $[0,1,1,0,0,0,1,0]$\n  - $[1,0,1,0,0,0,0,1]$\n  - $[0,0,0,0,0,1,1,0]$\n- Baltica $B_2$ ($4 \\times 8$):\n  - $[1,1,0,0,1,0,0,0]$\n  - $[0,1,1,0,0,1,0,0]$\n  - $[1,0,1,0,0,0,1,0]$\n  - $[0,0,0,0,1,1,0,0]$\n\n时间区间3（GOBE高峰期）：分类单元 $[A,B,C,D,E,F,G,H,I,J,K]$。\n- Laurentia $L_3$ ($4 \\times 11$):\n  - $[1,1,0,1,0,0,0,0,0,0,0]$\n  - $[0,0,0,0,0,1,0,1,0,0,0]$\n  - $[1,0,0,0,0,0,0,0,1,0,0]$\n  - $[0,1,0,0,0,1,0,1,0,0,0]$\n- Baltica $B_3$ ($4 \\times 11$):\n  - $[0,0,1,0,1,0,0,0,0,0,0]$\n  - $[0,0,0,0,0,0,1,0,0,1,0]$\n  - $[0,0,0,0,0,0,0,0,0,0,1]$\n  - $[0,0,1,0,0,0,1,0,0,0,1]$\n\n任务：\n- 对于每个时间区间 $b \\in \\{1,2,3\\}$ 和每个省 $P \\in \\{\\text{Laurentia}, \\text{Baltica}\\}$，计算 $ \\overline{\\alpha}_{P,b} $、$ \\gamma_{P,b} $ 和 Whittaker $ \\beta_{\\mathrm{W},P,b} = \\gamma_{P,b} / \\overline{\\alpha}_{P,b} $。\n- 对于每个时间区间 $b$，计算大区 $ \\Gamma_b $（两个省的并集）、平均省级gamma $ \\overline{\\gamma}_b = \\left( \\gamma_{\\text{Laurentia},b} + \\gamma_{\\text{Baltica},b} \\right) / 2 $ 和 $ \\beta_{\\mathrm{among},b} = \\Gamma_b / \\overline{\\gamma}_b $。\n- 对于连续的时间区间对 $(1 \\rightarrow 2)$ 和 $(2 \\rightarrow 3)$，计算 $ \\Delta \\log \\overline{\\gamma} $ 和 $ \\Delta \\log \\beta_{\\mathrm{among}} $，并按上述规定（容差 $ \\varepsilon = 10^{-9} $）返回驱动因素指示符。\n\n角度单位不适用。不涉及物理单位。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。有序输出必须是：\n- 按顺序对每个时间区间 $1,2,3$：三个浮点数值 $ \\beta_{\\mathrm{W},\\text{Laurentia},b} $、$ \\beta_{\\mathrm{W},\\text{Baltica},b} $ 和 $ \\beta_{\\mathrm{among},b} $，每个值都四舍五入到6位小数。\n- 接着是两个整数，分别代表 $(1 \\rightarrow 2)$ 和 $(2 \\rightarrow 3)$ 的驱动因素指示符。\n\n因此，输出必须总共包含 $11$ 个值。例如，使用占位符数字的输出将如下所示：\n\"[x1,x2,x3,x4,x5,x6,x7,x8,x9,d12,d23]\"\n其中每个 $x_i$ 是一个四舍五入到6位小数的浮点数，每个 $d_{ij}$ 是 $\\{-1,0,1\\}$ 中的一个整数。", "solution": "所提供的问题经过了严格的验证。该问题具有科学依据，利用了群落生态学和古生物学的既定概念，例如Whittaker的乘法多样性划分（$ \\alpha $、$ \\beta $、$ \\gamma $）。所提供的数据由有无矩阵组成，这是此类分析的标准格式。定义、公式和计算任务都以数学精度陈述且内部一致。该问题是适定的、客观的，并包含唯一解所需的所有必要信息。因此，该问题被认为是有效的，有必要给出完整解答。\n\n解决方案通过系统地计算三个时间区间（$ b=1, 2, 3 $）中每一个所需的生物多样性指标来进行。对于每个时间区间，我们分析Laurentia（$ L $）和Baltica（$ B $）这两个省，然后分析它们所构成的大区。\n\n首先，我们为给定时间区间 $ b $ 内的某个省矩阵 $ M $（可以是 $ L_b $ 或 $ B_b $）定义关键量：\n- 单个集合（第 $ i $ 行）的局域alpha多样性为 $ \\alpha_i = \\sum_j M_{ij} $。\n- 该省的平均alpha多样性为 $ \\overline{\\alpha} = \\frac{1}{N} \\sum_{i=1}^{N} \\alpha_i $，其中 $ N $ 是集合（行）的数量。\n- 省级gamma多样性为 $ \\gamma = \\sum_j \\mathbb{I}(\\sum_i M_{ij} > 0) $，其中 $ \\mathbb{I}(\\cdot) $ 是指示函数。这是至少有一次存在的分类单元的计数。\n- Whittaker beta多样性为 $ \\beta_{\\mathrm{W}} = \\gamma / \\overline{\\alpha} $。\n\n对于时间区间 $ b $ 内的大区：\n- 大区gamma多样性是 $ \\Gamma_b $，即两个省所有不同分类单元的总数。\n- 平均省级gamma多样性是 $ \\overline{\\gamma}_b = (\\gamma_{\\text{Laurentia},b} + \\gamma_{\\text{Baltica},b}) / 2 $。\n- 省际beta多样性是 $ \\beta_{\\mathrm{among},b} = \\Gamma_b / \\overline{\\gamma}_b $。\n\n两个连续时间区间 $ b $ 和 $ b+1 $ 之间的变化使用对数可加模型 $ \\Delta \\log \\Gamma = \\Delta \\log \\overline{\\gamma} + \\Delta \\log \\beta_{\\mathrm{among}} $ 进行分析。主导驱动因素通过比较各分量的绝对值来确定：$ \\left| \\Delta \\log \\overline{\\gamma} \\right| $ 与 $ \\left| \\Delta \\log \\beta_{\\mathrm{among}} \\right| $。\n\n**时间区间1 (GOBE前)**\n有无矩阵是用于Laurentia的 $ L_1 $ ($ 3 \\times 5 $) 和用于Baltica的 $ B_1 $ ($ 3 \\times 5 $)。\n\n对于 Laurentia ($ L_1 $):\n- 3个集合的Alpha多样性为 $ 2, 2, 3 $。\n- 平均alpha多样性: $ \\overline{\\alpha}_{L,1} = (2+2+3)/3 = 7/3 $。\n- Gamma多样性: 分类单元A、B、C、D存在。$ \\gamma_{L,1} = 4 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},L,1} = \\gamma_{L,1} / \\overline{\\alpha}_{L,1} = 4 / (7/3) = 12/7 \\approx 1.714286 $。\n\n对于 Baltica ($ B_1 $):\n- 3个集合的Alpha多样性为 $ 2, 3, 2 $。\n- 平均alpha多样性: $ \\overline{\\alpha}_{B,1} = (2+3+2)/3 = 7/3 $。\n- Gamma多样性: 分类单元A、B、C、E存在。$ \\gamma_{B,1} = 4 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},B,1} = \\gamma_{B,1} / \\overline{\\alpha}_{B,1} = 4 / (7/3) = 12/7 \\approx 1.714286 $。\n\n对于大区 (时间区间1):\n- 平均省级gamma: $ \\overline{\\gamma}_1 = (\\gamma_{L,1} + \\gamma_{B,1}) / 2 = (4+4)/2 = 4 $。\n- 大区gamma多样性: 所有五个分类单元(A, B, C, D, E)在两个省中都有出现。$ \\Gamma_1 = 5 $。\n- 省际beta: $ \\beta_{\\mathrm{among},1} = \\Gamma_1 / \\overline{\\gamma}_1 = 5/4 = 1.25 $。\n\n**时间区间2 (GOBE早期)**\n矩阵是 $ L_2 $ 和 $ B_2 $，均为 $ 4 \\times 8 $。\n\n对于 Laurentia ($ L_2 $):\n- Alpha多样性: $ 4, 3, 3, 2 $。\n- 平均alpha: $ \\overline{\\alpha}_{L,2} = (4+3+3+2)/4 = 12/4 = 3 $。\n- Gamma多样性: $ 7 $ 个分类单元存在。$ \\gamma_{L,2} = 7 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},L,2} = 7/3 \\approx 2.333333 $。\n\n对于 Baltica ($ B_2 $):\n- Alpha多样性: $ 3, 3, 3, 2 $。\n- 平均alpha: $ \\overline{\\alpha}_{B,2} = (3+3+3+2)/4 = 11/4 = 2.75 $。\n- Gamma多样性: $ 6 $ 个分类单元存在。$ \\gamma_{B,2} = 6 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},B,2} = 6 / 2.75 = 24/11 \\approx 2.181818 $。\n\n对于大区 (时间区间2):\n- 平均省级gamma: $ \\overline{\\gamma}_2 = (7+6)/2 = 6.5 $。\n- 大区gamma多样性: 所有 $ 8 $ 个分类单元都存在。$ \\Gamma_2 = 8 $。\n- 省际beta: $ \\beta_{\\mathrm{among},2} = 8 / 6.5 = 16/13 \\approx 1.230769 $。\n\n**时间区间3 (GOBE高峰期)**\n矩阵是 $ L_3 $ 和 $ B_3 $，均为 $ 4 \\times 11 $。\n\n对于 Laurentia ($ L_3 $):\n- Alpha多样性: $ 3, 2, 2, 3 $。\n- 平均alpha: $ \\overline{\\alpha}_{L,3} = (3+2+2+3)/4 = 10/4 = 2.5 $。\n- Gamma多样性: $ 6 $ 个分类单元存在。$ \\gamma_{L,3} = 6 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},L,3} = 6 / 2.5 = 2.4 $。\n\n对于 Baltica ($ B_3 $):\n- Alpha多样性: $ 2, 2, 1, 3 $。\n- 平均alpha: $ \\overline{\\alpha}_{B,3} = (2+2+1+3)/4 = 8/4 = 2 $。\n- Gamma多样性: $ 5 $ 个分类单元存在。$ \\gamma_{B,3} = 5 $。\n- Whittaker beta: $ \\beta_{\\mathrm{W},B,3} = 5 / 2 = 2.5 $。\n\n对于大区 (时间区间3):\n- 平均省级gamma: $ \\overline{\\gamma}_3 = (6+5)/2 = 5.5 $。\n- 大区gamma多样性: 所有 $ 11 $ 个分类单元都存在。$ \\Gamma_3 = 11 $。\n- 省际beta: $ \\beta_{\\mathrm{among},3} = 11 / 5.5 = 2 $。\n\n**驱动因素分析**\n自然对数用 $ \\log $ 表示。\n\n对于转换 $ 1 \\rightarrow 2 $:\n- 省内分量: $ \\Delta \\log \\overline{\\gamma} = \\log(\\overline{\\gamma}_2) - \\log(\\overline{\\gamma}_1) = \\log(6.5) - \\log(4) = \\log(1.625) \\approx 0.4855 $。\n- 省际分量: $ \\Delta \\log \\beta_{\\mathrm{among}} = \\log(\\beta_{\\mathrm{among},2}) - \\log(\\beta_{\\mathrm{among},1}) = \\log(16/13) - \\log(1.25) \\approx -0.0155 $。\n- 比较: $ \\left| 0.4855 \\right| > \\left| -0.0155 \\right| $。因此，省内累积占主导。指示符为 $ 1 $。\n\n对于转换 $ 2 \\rightarrow 3 $:\n- 省内分量: $ \\Delta \\log \\overline{\\gamma} = \\log(\\overline{\\gamma}_3) - \\log(\\overline{\\gamma}_2) = \\log(5.5) - \\log(6.5) \\approx -0.1671 $。\n- 省际分量: $ \\Delta \\log \\beta_{\\mathrm{among}} = \\log(\\beta_{\\mathrm{among},3}) - \\log(\\beta_{\\mathrm{among},2}) = \\log(2) - \\log(16/13) \\approx 0.4855 $。\n- 比较: $ \\left| -0.1671 \\right|  \\left| 0.4855 \\right| $。因此，省际分异占主导。指示符为 $ -1 $。\n\n**最终结果**\n所需的值按顺序如下：\n- 时间区间1: $ \\beta_{\\mathrm{W},L,1} \\approx 1.714286 $, $ \\beta_{\\mathrm{W},B,1} \\approx 1.714286 $, $ \\beta_{\\mathrm{among},1} = 1.250000 $。\n- 时间区间2: $ \\beta_{\\mathrm{W},L,2} \\approx 2.333333 $, $ \\beta_{\\mathrm{W},B,2} \\approx 2.181818 $, $ \\beta_{\\mathrm{among},2} \\approx 1.230769 $。\n- 时间区间3: $ \\beta_{\\mathrm{W},L,3} = 2.400000 $, $ \\beta_{\\mathrm{W},B,3} = 2.500000 $, $ \\beta_{\\mathrm{among},3} = 2.000000 $。\n- 驱动因素: $ (1 \\rightarrow 2) $ 为 $ 1 $，$ (2 \\rightarrow 3) $ 为 $ -1 $。\n这些将按照最终输出的指定格式进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the biodiversity partitioning problem for the GOBE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (Laurentia_matrix, Baltica_matrix) for a time bin.\n    test_cases = [\n        ( # Bin 1\n            np.array([\n                [1, 1, 0, 0, 0],\n                [0, 1, 1, 0, 0],\n                [1, 0, 1, 1, 0]\n            ]),\n            np.array([\n                [1, 1, 0, 0, 0],\n                [0, 1, 1, 0, 1],\n                [1, 0, 1, 0, 0]\n            ])\n        ),\n        ( # Bin 2\n            np.array([\n                [1, 1, 0, 1, 0, 1, 0, 0],\n                [0, 1, 1, 0, 0, 0, 1, 0],\n                [1, 0, 1, 0, 0, 0, 0, 1],\n                [0, 0, 0, 0, 0, 1, 1, 0]\n            ]),\n            np.array([\n                [1, 1, 0, 0, 1, 0, 0, 0],\n                [0, 1, 1, 0, 0, 1, 0, 0],\n                [1, 0, 1, 0, 0, 0, 1, 0],\n                [0, 0, 0, 0, 1, 1, 0, 0]\n            ])\n        ),\n        ( # Bin 3\n            np.array([\n                [1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0],\n                [1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0],\n                [0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0]\n            ]),\n            np.array([\n                [0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0],\n                [0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0],\n                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],\n                [0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1]\n            ])\n        )\n    ]\n\n    results_floats = []\n    gamma_metrics = {}\n\n    for i, (L_mat, B_mat) in enumerate(test_cases):\n        b = i + 1\n        \n        # Province-level calculations for Laurentia\n        mean_alpha_L = L_mat.sum(axis=1).mean()\n        gamma_L = np.any(L_mat, axis=0).sum()\n        beta_W_L = gamma_L / mean_alpha_L\n\n        # Province-level calculations for Baltica\n        mean_alpha_B = B_mat.sum(axis=1).mean()\n        gamma_B = np.any(B_mat, axis=0).sum()\n        beta_W_B = gamma_B / mean_alpha_B\n\n        # Macroregional calculations\n        Gamma = np.logical_or(np.any(L_mat, axis=0), np.any(B_mat, axis=0)).sum()\n        mean_gamma = (gamma_L + gamma_B) / 2.0\n        beta_among = Gamma / mean_gamma\n        \n        gamma_metrics[b] = {\n            \"mean_gamma\": mean_gamma,\n            \"beta_among\": beta_among\n        }\n        \n        results_floats.extend([beta_W_L, beta_W_B, beta_among])\n\n    # Driver analysis\n    drivers = []\n    epsilon = 1e-9\n\n    # Transition 1 -> 2\n    g_bar_1 = gamma_metrics[1][\"mean_gamma\"]\n    g_bar_2 = gamma_metrics[2][\"mean_gamma\"]\n    beta_a_1 = gamma_metrics[1][\"beta_among\"]\n    beta_a_2 = gamma_metrics[2][\"beta_among\"]\n    \n    delta_log_g_bar_12 = np.log(g_bar_2) - np.log(g_bar_1)\n    delta_log_beta_a_12 = np.log(beta_a_2) - np.log(beta_a_1)\n    \n    if abs(abs(delta_log_g_bar_12) - abs(delta_log_beta_a_12))  epsilon:\n        drivers.append(0)\n    elif abs(delta_log_g_bar_12) > abs(delta_log_beta_a_12):\n        drivers.append(1)\n    else:\n        drivers.append(-1)\n        \n    # Transition 2 -> 3\n    g_bar_3 = gamma_metrics[3][\"mean_gamma\"]\n    beta_a_3 = gamma_metrics[3][\"beta_among\"]\n    \n    delta_log_g_bar_23 = np.log(g_bar_3) - np.log(g_bar_2)\n    delta_log_beta_a_23 = np.log(beta_a_3) - np.log(beta_a_2)\n\n    if abs(abs(delta_log_g_bar_23) - abs(delta_log_beta_a_23))  epsilon:\n        drivers.append(0)\n    elif abs(delta_log_g_bar_23) > abs(delta_log_beta_a_23):\n        drivers.append(1)\n    else:\n        drivers.append(-1)\n        \n    # Format final output string according to problem specification\n    formatted_results = [f\"{v:.6f}\" for v in results_floats]\n    formatted_results.extend([str(d) for d in drivers])\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the main function\nsolve()\n```", "id": "2616852"}]}