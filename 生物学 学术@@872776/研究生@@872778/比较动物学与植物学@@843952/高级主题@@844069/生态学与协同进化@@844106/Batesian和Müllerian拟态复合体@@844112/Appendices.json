{"hands_on_practices": [{"introduction": "在进化生态学中，一项核心技能是将现场或实验室的观测数据转化为对潜在生物学机制的有力推断。本练习旨在通过一个假设的数据集，磨练您从经验证据中辨别不同拟态类型的能力。通过分析拟态物种的化学防御水平和相应的捕食率，您将学习如何应用贝氏拟态和缪勒氏拟态的核心定义来解释自然界中的模式，这是连接理论与实践的关键一步。", "problem": "某个昼行性昆虫分类单元的两个同域色型共享相同的显眼背部颜色图案，并共同出现在同一寄主植物上。对其背部组织的化学分析表明，色型 $X$ 的平均生物碱浓度为 $5\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$，而色型 $Y$ 的平均生物碱浓度为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$。在使用初级鸟类捕食者进行的标准化鸟舍试验中，当以相似频率呈现时，每次遭遇的攻击概率估计为：色型 $X$ 为 $0.10$，色型 $Y$ 为 $0.50$。假设生物碱是介导无利可图性的主要威慑物，共享的颜色图案是捕食者使用的主要线索，并且该分析捕获了该系统中相关的威慑物类别。\n\n哪种解释最符合已建立的拟态理论，为什么？\n\nA. 贝氏拟态：色型 $X$ 是一个无利可图的模型，色型 $Y$ 是一个可食的模拟者；捕食者的学习将对 $X$ 的攻击减少到 $0.10$，而 $Y$ 则遭受接近 $0.50$ 的更高攻击，尤其是在模拟者不稀有时。\n\nB. 缪氏拟态：两种色型都是无利可图的共同模拟者；观察到的 $0.10$ 和 $0.50$ 之间的差异是预料之中的，因为毒性更强的共同模拟者的攻击率总是低于毒性较弱的共同模拟者。\n\nC. 无拟态：颜色图案不起警戒信号的作用；$0.10$ 和 $0.50$ 之间的攻击率差异最好由未测量的栖息地使用差异来解释，生物碱浓度无关紧要。\n\nD. 具有准贝氏动态的缪氏复合体：色型 $Y$ 防御力弱，因此仍然是共同模拟者；即使一个共同模拟者的生物碱含量为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$，像 $0.10$ 对 $0.50$ 这样大的攻击率差异也是典型结果。", "solution": "必须首先对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n问题陈述中提供的明确数据和假设如下：\n- **分类单元：** 某个昼行性昆虫分类单元的两个同域色型，$X$ 和 $Y$。\n- **信号：** 两种色型共享相同的显眼背部颜色图案。\n- **生态学：** 两者共同出现在同一寄主植物上。\n- **化学防御：**\n    - 色型 $X$：平均生物碱浓度为 $5\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$。\n    - 色型 $Y$：平均生物碱浓度为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$。\n- **捕食者反应：** 在使用初级鸟类捕食者进行的标准化鸟舍试验中：\n    - 色型 $X$ 的每次遭遇攻击概率为 $0.10$。\n    - 色型 $Y$ 的每次遭遇攻击概率为 $0.50$。\n    - 这两种色型以相似的频率呈现。\n- **假设：**\n    1. 生物碱是介导无利可图性的主要威慑物。\n    2. 共享的颜色图案是捕食者使用的主要线索。\n    3. 化学分析捕获了该系统中相关的威慑物类别。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学依据：** 该问题描述了进化生态学中一个关于化学防御和拟态的经典场景。贝氏拟态、缪氏拟态、警戒作用、生物碱作为化学防御以及捕食者学习等概念都是该领域的基本原理。提供的数值在生物学上是合理的。\n- **定义明确：** 该问题定义明确。它提供了足够的数据（生物碱浓度、攻击概率）和明确的假设，从而可以逻辑推断出存在的拟态系统。问题要求找出“最一致的”解释，这对于生物学问题是恰当的。\n- **客观性：** 语言是技术性的，没有主观性。\n\n问题陈述没有显示任何缺陷。它在科学上不是不合理的、不完整的、矛盾的或在其他方面无效的。它基于标准的生态学原理提出了一个清晰、可形式化的问题。\n\n### 第 3 步：结论与行动\n问题陈述是有效的。我将继续进行求解推导和选项分析。\n\n### 求解推导\n该问题的理论框架基于警戒作用和拟态的定义。警戒作用（Aposematism）是指警戒信号（这里指显眼的颜色图案）与使生物体对捕食者无利可图的防御（这里指生物碱）之间的关联。拟态涉及不同物种或色型之间信号的趋同。\n\n1.  **描述色型 $X$ 的特征：** 该色型拥有 $5\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$ 的平均生物碱浓度。根据所给假设，生物碱是主要威慑物，这使得色型 $X$ 对捕食者来说是无利可图的。它展示出显眼的颜色图案，并经历 $0.10$ 的低攻击概率。这种警戒信号、无利可图性以及捕食者习得性回避的组合，将色型 $X$ 定义为一个警戒作用的**模型**。\n\n2.  **描述色型 $Y$ 的特征：** 该色型的生物碱浓度为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$。基于生物碱是主要防御且分析是全面的假设，色型 $Y$ 是无防御的，因此是**可食的**。它与色型 $X$ 共享相同的警戒信号，但遭受的攻击概率要高得多，为 $0.50$。\n\n3.  **确定拟态系统：** 该系统涉及一个可食的生物体（色型 $Y$），它已演化出与一个无利可图、具警戒作用的生物体（色型 $X$）共享警戒信号的特征。这正是**贝氏拟态**的精确定义。在这种寄生关系中，模拟者（$Y$）受益于捕食者对模型（$X$）的习得性厌恶，而模型则可能受到损害，因为与可食模拟者的相遇会稀释或延缓学习过程。攻击概率的显著差异（模型为 $0.10$，模拟者为 $0.50$）是贝氏拟态系统的典型标志，尤其是在模拟者不稀有时（由“相似频率”所暗示），因为捕食者更可能攻击并吃掉可食的模拟者，从而削弱了信号对所有携带者的保护价值。\n\n### 逐项分析\n\n**A. 贝氏拟态：色型 $X$ 是一个无利可图的模型，色型 $Y$ 是一个可食的模拟者；捕食者的学习将对 $X$ 的攻击减少到 $0.10$，而 $Y$ 则遭受接近 $0.50$ 的更高攻击，尤其是在模拟者不稀有时。**\n该陈述根据各自 $5\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$ 和 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$ 的生物碱浓度，正确地将色型 $X$ 识别为无利可图的模型，将色型 $Y$ 识别为可食的模拟者。它准确地描述了模型受到良好保护（$0.10$ 的攻击率）而模拟者被更频繁攻击（$0.50$ 的攻击率）的动态。提及模拟者频率（“尤其是在模拟者不稀有时”）正确地反映了贝氏拟态动态的一个关键原则，这与“相似频率”的实验条件相符。这种解释与数据和已建立的理论完全一致。\n**结论：正确。**\n\n**B. 缪氏拟态：两种色型都是无利可图的共同模拟者；观察到的 $0.10$ 和 $0.50$ 之间的差异是预料之中的，因为毒性更强的共同模拟者的攻击率总是低于毒性较弱的共同模拟者。**\n该陈述存在根本性错误。缪氏拟态要求*所有*参与成员都必须是无利可图的。色型 $Y$ 的生物碱浓度为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$，因此是可食的，而非无利可图的。基于问题的数据，该选项的前提在事实上是不正确的。因此，该系统不可能是缪氏拟态。\n**结论：错误。**\n\n**C. 无拟态：颜色图案不起警戒信号的作用；$0.10$ 和 $0.50$ 之间的攻击率差异最好由未测量的栖息地使用差异来解释，生物碱浓度无关紧要。**\n该选项直接违反了问题的明确假设。问题陈述指出“共享的颜色图案是捕食者使用的主要线索”以及“生物碱是主要威慑物”。该选项否定了这两点，声称图案不是警戒信号，生物碱也无关紧要。它援引了推测性的、“未测量的”因素，当问题提供了一套自洽的条件时，这是一种无效的方法。被防御的色型 $X$ 极低的攻击率（$0.10$）是有力证据，表明颜色图案*确实*起到了有效的警戒信号作用。\n**结论：错误。**\n\n**D. 具有准贝氏动态的缪氏复合体：色型 $Y$ 防御力弱，因此仍然是共同模拟者；即使一个共同模拟者的生物碱含量为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$，像 $0.10$ 对 $0.50$ 这样大的攻击率差异也是典型结果。**\n该选项是一种错误的定性。 “准贝氏”动态的概念适用于缪氏复合体中无利可图性的谱系，其中防御较弱的共同模拟者寄生于防御较强的共同模拟者。然而，这仍然要求模拟者至少是“防御力弱”或在某种程度上是无利可图的。数据显示色型 $Y$ 的生物碱浓度为 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$。根据问题的假设，这表示完全缺乏相关防御，使色型 $Y$ 成为可食的，而非防御力弱。一个可食的生物体是贝氏拟态的模拟者，而不是缪氏拟态的共同模拟者。声称一个共同模拟者可以有 $0\\,\\mathrm{mg}\\,\\mathrm{g}^{-1}$ 的防御力是自相矛盾的。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2549469"}, {"introduction": "任何拟态系统的有效性最终都取决于捕食者的学习和记忆能力。为了量化这一认知过程，生态学家经常使用像 Rescorla-Wagner 模型这样的联想学习框架。这个练习让您亲手计算捕食者学会规避一个警告信号所需的负面相遇次数[@problem_id:2549445]，从而将捕食者心理学中的抽象概念转化为具体的、可预测的结果。通过这个练习，您将更深入地理解维持缪勒氏拟态环稳定性的微观演化机制。", "problem": "一种泛化捕食性鸟类在一个群落中觅食，该群落中存在一个由共享显眼警戒信号的有防御昆虫组成的穆勒氏拟态环。每当捕食者攻击并尝试捕食带有该警戒信号的有防御猎物时，它会受到厌恶性无条件刺激（毒性），其攻击该警戒信号的倾向通过联想学习而降低。假设捕食者的学习遵循Rescorla–Wagner (RW) 模型。设在离散的第 $t$ 次遭遇时，警戒信号的联想强度为 $V_t \\in [0,1]$，捕食者对该警戒信号的攻击概率与联想强度呈线性关系，为 $p_t = 1 - V_t$。假设无条件刺激的强度归一化为 $\\lambda = 1$，条件刺激的显著性被吸收到学习率中，RW更新方程为\n$$\nV_{t+1} \\;=\\; V_t \\;+\\; \\alpha\\big(\\lambda - V_t\\big),\n$$\n学习率 $\\alpha = 0.3$。捕食者开始时对该警戒信号有很高的初始攻击概率 $p_0 = 0.8$。\n\n将每次对有防御猎物的攻击视为一次离散的学习遭遇，并假设所有对有防御猎物的遭遇都涉及相同的警戒信号。计算所需的对有防御猎物的最少整数遭遇次数，使得对该警戒信号的攻击概率首次降至 $p_t \\le 0.2$。你的答案应表示为一个不带单位的整数。", "solution": "该问题陈述具有科学依据，提法恰当且客观。它描述了Rescorla-Wagner模型在穆勒氏拟态背景下应用于捕食者学习的一个经典案例，这是定量行为生态学中的一个有效课题。所有参数和条件都已明确定义，从而可以得出一个唯一且有意义的解。因此，该问题被认为是有效的，并将提供解答。\n\n该模型由以下部分定义：\n第 $t$ 次遭遇时的联想强度为 $V_t$。\n攻击概率是联想强度的线性函数：$p_t = 1 - V_t$。\nRescorla-Wagner更新方程如下所示：\n$$V_{t+1} = V_t + \\alpha(\\lambda - V_t)$$\n\n提供的参数如下：\n- 学习率, $\\alpha = 0.3$。\n- 渐进学习水平（无条件刺激强度）, $\\lambda = 1$。\n- 初始攻击概率, $p_0 = 0.8$。\n\n目标是求出使攻击概率满足 $p_t \\le 0.2$ 所需的最小整数遭遇次数 $t$。\n\n首先，我们根据给定的初始攻击概率 $p_0 = 0.8$ 确定联想强度的初始条件 $V_0$：\n$$V_0 = 1 - p_0 = 1 - 0.8 = 0.2$$\n\n接下来，我们将给定的常数 $\\alpha = 0.3$ 和 $\\lambda = 1$ 代入更新方程：\n$$V_{t+1} = V_t + 0.3(1 - V_t)$$\n这可以简化为一个线性递推关系：\n$$V_{t+1} = V_t + 0.3 - 0.3V_t = (1 - 0.3)V_t + 0.3 = 0.7V_t + 0.3$$\n\n目标条件是 $p_t \\le 0.2$。我们用联想强度 $V_t$ 来重新表示这个条件：\n$$1 - V_t \\le 0.2$$\n$$V_t \\ge 1 - 0.2$$\n$$V_t \\ge 0.8$$\n\n我们现在必须确定使 $V_t$ 的值达到或超过 $0.8$ 的最小整数 $t$。我们可以通过迭代这个递推关系来计算，其中每一步对应一次对有防御猎物的遭遇。\n\n初始状态在 $t=0$ 时：\n$V_0 = 0.2$。该值小于目标值 $0.8$。\n\n第一次遭遇后 ($t=1$)：\n$$V_1 = 0.7V_0 + 0.3 = 0.7(0.2) + 0.3 = 0.14 + 0.3 = 0.44$$\n此时，$V_1  0.8$。攻击概率为 $p_1 = 1 - 0.44 = 0.56$。\n\n第二次遭遇后 ($t=2$)：\n$$V_2 = 0.7V_1 + 0.3 = 0.7(0.44) + 0.3 = 0.308 + 0.3 = 0.608$$\n此时，$V_2  0.8$。攻击概率为 $p_2 = 1 - 0.608 = 0.392$。\n\n第三次遭遇后 ($t=3$)：\n$$V_3 = 0.7V_2 + 0.3 = 0.7(0.608) + 0.3 = 0.4256 + 0.3 = 0.7256$$\n此时，$V_3  0.8$。攻击概率为 $p_3 = 1 - 0.7256 = 0.2744$。\n\n第四次遭遇后 ($t=4$)：\n$$V_4 = 0.7V_3 + 0.3 = 0.7(0.7256) + 0.3 = 0.50792 + 0.3 = 0.80792$$\n此时，$V_4 = 0.80792$，满足条件 $V_4 \\ge 0.8$。这是首次超过阈值。对应的攻击概率为 $p_4 = 1 - 0.80792 = 0.19208$，满足 $p_4 \\le 0.2$。\n\n因此，需要至少 $4$ 次对有防御猎物的遭遇，才能使捕食者的攻击概率降至或低于指定阈值。", "answer": "$$\\boxed{4}$$", "id": "2549445"}, {"introduction": "贝氏拟态的演化动态本质上是一个频率依赖选择的博弈过程，其中拟态者的适应度取决于其在种群中的相对丰度。本练习将引导您使用演化博弈论中的核心工具——复制子动态方程（replicator equation），来构建一个数值模拟[@problem_id:2549335]。通过编写代码来模拟一个稀有的贝氏拟态者入侵一个有防御的模型种群的过程，您将能够探索不同生态成本（如防御成本、模拟成本）和收益如何共同决定拟态的演化轨迹和入侵成功与否。这是一个高级综合性练习，旨在将理论模型与计算生物学技能相结合。", "problem": "一个研究团队正在研究在频率依赖性捕食作用下，一个可口的贝氏拟态者如何入侵一个警戒色模型的种群。考虑一个包含两种类型的单一信号类别：有防御的模型和无防御的拟态者。令 $p \\in [0,1]$ 表示信号发出者中拟态者的频率。捕食者对信号发出者的攻击概率通过函数 $A(f_{\\mathrm{def}}) = A_0 \\exp(-k f_{\\mathrm{def}})$ 依赖于有防御信号发出者的比例，其中 $A_0 \\in (0,1]$ 是在没有回避学习的情况下的基准攻击概率，$k \\ge 0$ 是一个学习速率参数。在一个贝氏系统中，信号发出者中有防御的比例是 $f_{\\mathrm{def}} = 1 - p$。假设拟态者和模型的基准生殖力分别为 $b_m$ 和 $b_M$。设拟态者每次被攻击的适合度损失为 $c_{\\mathrm{pred},m}  0$，而对于模型，由于其有防御，该损失减少为 $\\rho \\, c_{\\mathrm{pred},m}$，其中 $0 \\le \\rho \\le 1$。设 $c_{\\mathrm{morph}} \\ge 0$ 是拟态者模拟的成本，$c_{\\mathrm{def}} \\ge 0$ 是模型防御的成本。那么，频率依赖的Malthusian适合度为\n$$\nW_m(p) = b_m - c_{\\mathrm{morph}} - c_{\\mathrm{pred},m}\\, A(1-p),\n\\qquad\nW_M(p) = b_M - c_{\\mathrm{def}} - \\rho\\, c_{\\mathrm{pred},m}\\, A(1-p).\n$$\n该团队使用演化博弈论中的复制子方程来模拟频率动态，\n$$\n\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big),\n\\quad\n\\bar{W}(p) = p\\, W_m(p) + (1-p)\\, W_M(p),\n$$\n其中点号表示时间导数。从 $p(0) = p_0$ 开始，并对常微分方程（ODE）进行时间上的前向积分。\n\n根据演化动力学和频率依赖性选择的核心定义，您需要实现一个数值模拟，以确定入侵是否成功。入侵成功定义为拟态者频率在固定时间范围 $T$ 内的任何时刻达到或超过阈值 $p_{\\mathrm{thr}}$。在所有模拟中使用以下固定值：$p_0 = 0.01$，$p_{\\mathrm{thr}} = 0.10$，$T = 500.0$，$b_m = 1.0$，$b_M = 1.0$。您必须确保在整个积分过程中，$p(t)$ 在数值上被约束在 $[0,1]$ 区间内。\n\n您的程序必须实现上述模型，并评估以下包含五组参数的测试套件。每个参数集是一个元组 $(A_0, k, c_{\\mathrm{pred},m}, \\rho, c_{\\mathrm{def}}, c_{\\mathrm{morph}})$：\n\n- 测试 $1$（预期允许入侵至中等频率）：$(0.8, 3.0, 0.8, 0.1, 0.12, 0.01)$。\n- 测试 $2$（无捕食者学习，预期无入侵）：$(0.8, 0.0, 0.6, 0.1, 0.05, 0.01)$。\n- 测试 $3$（在稀有时接近中性，预期在 $T$ 内不会超过阈值）：$(0.8, 3.0, 0.8, 0.1, 0.05, 0.02133)$。\n- 测试 $4$（拟态者模拟成本高，预期无入侵）：$(0.8, 3.0, 0.8, 0.1, 0.12, 0.20)$。\n- 测试 $5$（捕食者学习能力强且防御成本高，预期会入侵）：$(1.0, 6.0, 0.8, 0.2, 0.20, 0.00)$。\n\n对于每个测试，模拟 $\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big)$ 从 $t=0$ 到 $t=T$，并返回一个布尔值，指示 $\\max_{t \\in [0,T]} p(t) \\ge p_{\\mathrm{thr}}$ 是否成立。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的Python布尔值列表（例如，`[True, False, True, False, True]`）。", "solution": "问题陈述已经过严格验证，被认为是科学上合理、定义明确且完整的。它提出了一个来自演化生态学的标准模型，具体是频率依赖性捕食下贝氏拟态的动力学。该模型建立在基本原理之上，利用演化博弈论中的复制子方程来描述拟态者频率的变化。所有参数、初始条件和目标标准都已明确定义，从而可以得到唯一且有意义的解。\n\n该系统的核心是复制子常微分方程（ODE），它描述了拟态者频率 $p \\in [0,1]$ 的演化。该方程为：\n$$\n\\dot{p} = p \\big(W_m(p) - \\bar{W}(p)\\big)\n$$\n其中 $W_m(p)$ 是拟态者的适合度，$W_M(p)$ 是模型的适合度，$\\bar{W}(p)$ 是信号发出种群的平均适合度，定义为 $\\bar{W}(p) = p\\, W_m(p) + (1-p)\\, W_M(p)$。\n\n通过将 $\\bar{W}(p)$ 的定义代入复制子方程，我们可以简化 $\\dot{p}$ 的表达式：\n$$\n\\dot{p} = p \\big(W_m(p) - [p\\, W_m(p) + (1-p)\\, W_M(p)]\\big)\n$$\n$$\n\\dot{p} = p \\big( (1-p)W_m(p) - (1-p)W_M(p) \\big)\n$$\n$$\n\\dot{p} = p(1-p) \\big( W_m(p) - W_M(p) \\big)\n$$\n这种形式明确显示了频率 $p=0$（拟态者灭绝）和 $p=1$（模型灭绝）是该动力学的不动点。始于区间 $p \\in [0,1]$ 内的轨迹将保持在该区间内。\n\n适合度差异 $W_m(p) - W_M(p)$ 决定了选择的方向。我们定义这个项为 $\\Delta W(p)$：\n$$\n\\Delta W(p) = W_m(p) - W_M(p) = \\big(b_m - c_{\\mathrm{morph}} - c_{\\mathrm{pred},m}\\, A(1-p)\\big) - \\big(b_M - c_{\\mathrm{def}} - \\rho\\, c_{\\mathrm{pred},m}\\, A(1-p)\\big)\n$$\n鉴于固定值 $b_m = b_M = 1.0$，基准生殖力相互抵消：\n$$\n\\Delta W(p) = (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A(1-p)\n$$\n代入捕食者的攻击概率函数 $A(f_{\\mathrm{def}}) = A_0 \\exp(-k f_{\\mathrm{def}})$，其中 $f_{\\mathrm{def}} = 1-p$：\n$$\n\\Delta W(p) = (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A_0 \\exp(-k(1-p))\n$$\n因此，需要积分的ODE的最终形式是：\n$$\n\\dot{p} = p(1-p) \\left[ (c_{\\mathrm{def}} - c_{\\mathrm{morph}}) - (1-\\rho)c_{\\mathrm{pred},m}\\, A_0 \\exp(-k(1-p)) \\right]\n$$\n这是一个关于 $p(t)$ 的一阶非线性ODE。为了确定入侵是否成功，我们必须为所提供的每个参数集数值求解该方程。初始条件为 $p(0) = p_0 = 0.01$，积分时域为 $T = 500.0$。如果在任何时间 $t \\in [0, T]$，拟态者频率 $p(t)$ 达到或超过阈值 $p_{\\mathrm{thr}} = 0.10$，则认为入侵成功。\n\n数值解将使用标准的自适应步长ODE求解器（例如Runge-Kutta方法）获得。`scipy.integrate.solve_ivp` 函数适合此任务。对于每个测试用例，我们将：\n1. 使用特定参数 $(A_0, k, c_{\\mathrm{pred},m}, \\rho, c_{\\mathrm{def}}, c_{\\mathrm{morph}})$ 定义ODE的右侧（RHS），即 $\\dot{p} = f(t, p)$。\n2. 使用初始条件 $p(0) = 0.01$ 将ODE从 $t=0$ 积分到 $t=T$。求解器将生成一个解点数组 $(t_i, p(t_i))$。\n3. 在整个计算出的轨迹上确定拟态者频率的最大值 $\\max_i p(t_i)$。\n4. 将此最大值与阈值 $p_{\\mathrm{thr}}$ 进行比较。如果 $\\max p(t) \\ge p_{\\mathrm{thr}}$，则结果为True；否则为False。\n\n将对所有五个测试用例重复此过程，以生成最终的布尔结果列表。通过复制子方程的结构，$p(t)$ 必须保持在 $[0,1]$ 内的约束自然得到满足，并且一个稳健的数值求解器将遵守这些边界。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Simulates the replicator dynamics for Batesian mimicry and evaluates invasion success.\n    \"\"\"\n    \n    # --- Fixed parameters for all simulations ---\n    p0 = 0.01          # Initial mimic frequency\n    p_thr = 0.10       # Invasion success threshold\n    T_horizon = 500.0  # Simulation time horizon\n    b_m = 1.0          # Baseline fecundity of mimic\n    b_M = 1.0          # Baseline fecundity of model\n\n    # --- Test suite of parameter sets ---\n    # Each tuple is (A0, k, c_pred_m, rho, c_def, c_morph)\n    test_cases = [\n        (0.8, 3.0, 0.8, 0.1, 0.12, 0.01),    # Test 1\n        (0.8, 0.0, 0.6, 0.1, 0.05, 0.01),    # Test 2\n        (0.8, 3.0, 0.8, 0.1, 0.05, 0.02133), # Test 3\n        (0.8, 3.0, 0.8, 0.1, 0.12, 0.20),    # Test 4\n        (1.0, 6.0, 0.8, 0.2, 0.20, 0.00),    # Test 5\n    ]\n\n    def replicator_rhs(t, p, A0, k, c_pred_m, rho, c_def, c_morph):\n        \"\"\"\n        Calculates the right-hand side of the replicator ODE: dp/dt.\n        \n        Args:\n            t (float): Time variable (unused, for compatibility with solve_ivp).\n            p (list or np.ndarray): State variable, p[0] is the mimic frequency.\n            A0 (float): Baseline attack probability.\n            k (float): Predator learning rate.\n            c_pred_m (float): Per-attack fitness loss for the mimic.\n            rho (float): Reduction factor for model's predation cost.\n            c_def (float): Cost of defense for the model.\n            c_morph (float): Cost of resemblance for the mimic.\n            \n        Returns:\n            list: The derivative [dp/dt].\n        \"\"\"\n        p_val = p[0]\n\n        # The p(1-p) term naturally enforces the [0,1] boundary, but as a\n        # safeguard for numerical stability, we can explicitly return 0 at the boundaries.\n        if not (0  p_val  1):\n            return [0.0]\n\n        # Fraction of defended signalers (models)\n        f_def = 1.0 - p_val\n        \n        # Predator's attack probability\n        attack_prob = A0 * np.exp(-k * f_def)\n        \n        # Malthusian fitness of mimic and model\n        W_m = b_m - c_morph - c_pred_m * attack_prob\n        W_M = b_M - c_def - rho * c_pred_m * attack_prob\n        \n        # Replicator equation: dp/dt = p(1-p)(W_m - W_M)\n        dpdt = p_val * (1.0 - p_val) * (W_m - W_M)\n        \n        return [dpdt]\n\n    results = []\n    \n    for case_params in test_cases:\n        # Solve the ODE for the current parameter set\n        solution = solve_ivp(\n            fun=replicator_rhs,\n            t_span=(0, T_horizon),\n            y0=[p0],\n            method='RK45',\n            args=case_params,\n            dense_output=False # We only need the max value from the returned points\n        )\n        \n        # Determine if invasion was successful\n        if solution.status == 0:  # Check if integration was successful\n            max_p = np.max(solution.y[0])\n            invasion_success = max_p >= p_thr\n        else:\n            # If solver fails, assume invasion fails for this case\n            invasion_success = False\n\n        results.append(invasion_success)\n        \n    # Format and print the final output exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2549335"}]}