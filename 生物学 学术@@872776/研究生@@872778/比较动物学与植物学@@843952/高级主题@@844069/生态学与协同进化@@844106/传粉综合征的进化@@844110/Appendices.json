{"hands_on_practices": [{"introduction": "传粉者的访问并非随机行为，其背后是最大化能量收益、最小化能量成本的生存法则。本练习将运用最优觅食理论，分析一个假设的植物-传粉者系统。通过计算不同传粉者类群的“收益-成本比”，你将能够量化地判断哪个传粉者群体最可能成为植物花部性状演化的主要选择压力，从而为理解传粉综合征的特化提供了机制层面的基础。[@problem_id:2571665]", "problem": "一个植物谱系表现出一套与特化传粉综合征一致的花部性状：长管状、窄口径的花冠，红色反射且紫外对比度低，以及在黄昏时开始开花。为评估哪个传粉者功能团通过访花对这些性状施加最强的定向选择，请考虑以下基于能量平衡和最优觅食理论的情景。假设传粉者的行为旨在最大化单次访花获得的能量回报与该次访花消耗的能量成本之比，且影响形态和时间的植物性状通过一个提取效率因子起作用，该因子可调整特定传粉者可利用的花蜜能量。\n\n该植物每朵花提供的花蜜体积为 $v = 2.0 \\times 10^{-2}\\,\\text{mL}$，糖质量分数为 $s = 0.20$，花蜜溶液密度为 $\\rho = 1.08\\,\\text{g}\\,\\text{mL}^{-1}$。将糖视为蔗糖，其可代谢能量密度为 $e_{s} = 1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}$。忽略除提取效率外的热力学损失。传粉者单次访花的能量成本是其悬停或采蜜时的代谢功率乘以处理单朵花的时间。\n\n考虑三个候选传粉者功能团，用 $i \\in \\{1,2,3\\}$ 索引，其与性状相关的参数如下：\n\n- $i=1$ (长舌蜂)：提取效率 $\\eta_{1} = 0.30$，处理时间 $t_{1} = 2.0\\,\\text{s}$，代谢功率 $P_{1} = 0.10\\,\\text{J}\\,\\text{s}^{-1}$。\n- $i=2$ (天蛾)：提取效率 $\\eta_{2} = 0.85$，处理时间 $t_{2} = 1.6\\,\\text{s}$，代谢功率 $P_{2} = 0.25\\,\\text{J}\\,\\text{s}^{-1}$。\n- $i=3$ (蜂鸟)：提取效率 $\\eta_{3} = 0.70$，处理时间 $t_{3} = 1.2\\,\\text{s}$，代谢功率 $P_{3} = 0.60\\,\\text{J}\\,\\text{s}^{-1}$。\n\n仅使用生物能量学和最优觅食理论的基本定义，根据上述数据，计算每个功能团 $i$ 的单次访花能量回报与单次访花能量成本之比。然后确定具有最大比率的功能团的索引 $k^{\\ast} \\in \\{1,2,3\\}$。最终答案仅报告整数 $k^{\\ast}$，无需单位，也无需对整数进行舍入说明。", "solution": "推导过程从能量平衡和最优觅食的第一性原理出发。单次访花的能量回报等于传粉者实际提取的花蜜中所含的可代谢能量。单次访花的能量成本等于觅食期间的代谢功率乘以处理单朵花所花费的时间。\n\n首先，计算每朵花的糖质量。花蜜的体积为 $v$，密度为 $\\rho$，因此每朵花的花蜜溶液质量为\n$$\nm_{\\text{solution}} = v \\,\\rho,\n$$\n其中 $v = 2.0 \\times 10^{-2}\\,\\text{mL}$ 且 $\\rho = 1.08\\,\\text{g}\\,\\text{mL}^{-1}$。糖质量分数为 $s = 0.20$，因此每朵花的糖质量为\n$$\nm_{\\text{sugar}} = s \\, m_{\\text{solution}} = s \\, v \\,\\rho.\n$$\n该糖中的总可代谢能量为\n$$\nE_{\\text{nectar}} = m_{\\text{sugar}} \\, e_{s} = s \\, v \\,\\rho \\, e_{s},\n$$\n其中 $e_{s} = 1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}$。\n\n功能团 $i$ 的传粉者仅提取该能量的一小部分 $\\eta_{i}$，因此其单次访花的回报为\n$$\nR_{i} = \\eta_{i} \\, E_{\\text{nectar}} = \\eta_{i} \\, s \\, v \\,\\rho \\, e_{s}.\n$$\n其单次访花的能量成本是代谢功率乘以处理时间，\n$$\nC_{i} = P_{i} \\, t_{i}.\n$$\n因此，功能团 $i$ 的回报与成本之比为\n$$\nW_{i} = \\frac{R_{i}}{C_{i}} = \\frac{\\eta_{i} \\, s \\, v \\,\\rho \\, e_{s}}{P_{i} \\, t_{i}}.\n$$\n\n现在代入给定的数值，以比较不同功能团的 $W_{i}$。\n\n计算共同的花蜜能量项：\n$$\nm_{\\text{sugar}} = s \\, v \\,\\rho = (0.20)\\,(2.0 \\times 10^{-2}\\,\\text{mL})\\,(1.08\\,\\text{g}\\,\\text{mL}^{-1}) = 4.32 \\times 10^{-3}\\,\\text{g}.\n$$\n那么\n$$\nE_{\\text{nectar}} = m_{\\text{sugar}} \\, e_{s} = (4.32 \\times 10^{-3}\\,\\text{g})\\,(1.65 \\times 10^{4}\\,\\text{J}\\,\\text{g}^{-1}) = 7.128 \\times 10^{1}\\,\\text{J} = 71.28\\,\\text{J}.\n$$\n\n计算每个功能团的 $W_{i}$：\n\n- 对于 $i=1$ (长舌蜂)：$\\eta_{1} = 0.30$, $t_{1} = 2.0\\,\\text{s}$, $P_{1} = 0.10\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{1} = \\eta_{1} \\, E_{\\text{nectar}} = (0.30)\\,(71.28\\,\\text{J}) = 21.384\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{1} = P_{1}\\, t_{1} = (0.10\\,\\text{J}\\,\\text{s}^{-1})\\,(2.0\\,\\text{s}) = 0.20\\,\\text{J}.\n  $$\n  比率：\n  $$ \n  W_{1} = \\frac{21.384\\,\\text{J}}{0.20\\,\\text{J}} = 1.0692 \\times 10^{2} = 106.92.\n  $$\n\n- 对于 $i=2$ (天蛾)：$\\eta_{2} = 0.85$, $t_{2} = 1.6\\,\\text{s}$, $P_{2} = 0.25\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{2} = \\eta_{2} \\, E_{\\text{nectar}} = (0.85)\\,(71.28\\,\\text{J}) = 60.588\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{2} = P_{2}\\, t_{2} = (0.25\\,\\text{J}\\,\\text{s}^{-1})\\,(1.6\\,\\text{s}) = 0.40\\,\\text{J}.\n  $$\n  比率：\n  $$\n  W_{2} = \\frac{60.588\\,\\text{J}}{0.40\\,\\text{J}} = 1.5147 \\times 10^{2} = 151.47.\n  $$\n\n- 对于 $i=3$ (蜂鸟)：$\\eta_{3} = 0.70$, $t_{3} = 1.2\\,\\text{s}$, $P_{3} = 0.60\\,\\text{J}\\,\\text{s}^{-1}$。\n  回报：\n  $$\n  R_{3} = \\eta_{3} \\, E_{\\text{nectar}} = (0.70)\\,(71.28\\,\\text{J}) = 49.896\\,\\text{J}.\n  $$\n  成本：\n  $$\n  C_{3} = P_{3}\\, t_{3} = (0.60\\,\\text{J}\\,\\text{s}^{-1})\\,(1.2\\,\\text{s}) = 0.72\\,\\text{J}.\n  $$\n  比率：\n  $$\n  W_{3} = \\frac{49.896\\,\\text{J}}{0.72\\,\\text{J}} = 6.916 \\times 10^{1} \\approx 69.166\\overline{6}.\n  $$\n\n比较这些比率，$W_{2} = 151.47$ 是最大的，其次是 $W_{1} = 106.92$，然后是 $W_{3} \\approx 69.17$。因此，具有最大回报与成本之比的功能团的索引是\n$$\nk^{\\ast} = 2.\n$$\n根据给定的索引，这对应于天蛾，这也与性状描述中强调的黄昏开花和长管状形态相一致。所要求的最终答案是整数索引 $k^{\\ast}$。", "answer": "$$\\boxed{2}$$", "id": "2571665"}, {"introduction": "理解了传粉者偏好的潜在机制后，下一步是衡量这种偏好在群体水平上产生的演化效应。本练习运用演化数量遗传学的基石——Lande-Arnold框架，来分析一组关于花部性状和适合度的假设数据。通过计算选择差异和选择梯度，你将学会如何揭示选择的强度与方向，并利用遗传参数预测群体在短期内的演化响应，从而架起生态互动与演化改变之间的桥梁。[@problem_id:2571671]", "problem": "一种目标植物物种表现出两种数量花部性状，这两种性状被认为是趋异传粉综合征的基础：花冠管长度 $x$（单位为毫米）和花蜜蔗糖质量分数 $y$（无量纲分数）。在一个目标种群中，测量了六朵花的这些性状，并记录了优势传粉者功能群对每朵花的访问率。访问率已被标准化为相对适合度 $w$，使得样本的 $\\bar{w}=1$。个体 $i=1,\\dots,6$ 的测量值如下：\n- $i=1$: $x=9$, $y=0.22$, $w=0.75$\n- $i=2$: $x=10$, $y=0.25$, $w=0.95$\n- $i=3$: $x=11$, $y=0.28$, $w=1.15$\n- $i=4$: $x=9$, $y=0.20$, $w=0.70$\n- $i=5$: $x=12$, $y=0.30$, $w=1.35$\n- $i=6$: $x=11$, $y=0.27$, $w=1.10$\n\n使用 Lande–Arnold 数量遗传学框架，从以下广泛接受的基础出发：\n- 相对适合度为 $w$，且 $\\bar{w}=1$。\n- （表型）选择微分向量 $\\mathbf{S}$ 由性状与相对适合度之间的协方差定义，即对于性状 $z_{1}=x$ 和 $z_{2}=y$，其分量为 $S_{j}=\\operatorname{Cov}(z_{j},w)$。\n- 方向性选择梯度向量 $\\boldsymbol{\\beta}$ 是在普通最小二乘法 (OLS) 下，$w$ 对各性状的偏回归系数向量。\n- 每代的短期进化响应为 $\\Delta \\bar{\\mathbf{z}}=\\mathbf{G}\\boldsymbol{\\beta}$，其中 $\\mathbf{G}$ 是加性遗传方差-协方差矩阵。\n\n对于此数据集，通过有限样本均值来估计期望值：对于样本量为 $n=6$、样本均值分别为 $\\bar{a}$ 和 $\\bar{b}$ 的任意变量 $a$ 和 $b$，使用 $\\widehat{\\operatorname{Cov}}(a,b)=\\frac{1}{n}\\sum_{i=1}^{n}(a_{i}-\\bar{a})(b_{i}-\\bar{b})$，并且对于相对适合度，按给定值使用 $\\bar{w}=1$。计算：\n1. 选择微分向量 $\\mathbf{S}$。\n2. 由 OLS 正规方程所隐含的方向性选择梯度向量 $\\boldsymbol{\\beta}$。\n3. 使用提供的加性遗传方差-协方差矩阵\n$$\n\\mathbf{G}=\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{100}\\\\[4pt]\n\\frac{1}{100}  \\frac{1}{4000}\n\\end{pmatrix}\n$$\n预测的单代响应 $\\Delta \\bar{\\mathbf{z}}$。\n\n将您的最终结果以单行矩阵的形式报告，顺序为 $\\big(S_{x},\\,S_{y},\\,\\beta_{x},\\,\\beta_{y},\\,\\Delta \\bar{z}_{x},\\,\\Delta \\bar{z}_{y}\\big)$，使用精确值（不要四舍五入）。将 $\\Delta \\bar{z}_{x}$ 以毫米表示，将 $\\Delta \\bar{z}_{y}$ 表示为每代的性状分数，但不要在最终答案框内包含单位。", "solution": "问题陈述具有科学依据、提法得当、客观且自洽。因此，该问题被视为有效。我们将继续计算所要求的量。该问题要求根据 $n=6$ 个个体的样本，计算两种花部性状——花冠长度 $x$ 和花蜜蔗糖分数 $y$ 的选择微分向量 $\\mathbf{S}$、方向性选择梯度向量 $\\boldsymbol{\\beta}$ 和预测的进化响应向量 $\\Delta \\bar{\\mathbf{z}}$。\n\n给定的数据如下：\n个体 $i$ 的性状向量：$\\mathbf{z}_i = (x_i, y_i)^T$。\n个体 $i$ 的相对适合度：$w_i$。\n$i=1$: $x_1=9$, $y_1=0.22$, $w_1=0.75$\n$i=2$: $x_2=10$, $y_2=0.25$, $w_2=0.95$\n$i=3$: $x_3=11$, $y_3=0.28$, $w_3=1.15$\n$i=4$: $x_4=9$, $y_4=0.20$, $w_4=0.70$\n$i=5$: $x_5=12$, $y_5=0.30$, $w_5=1.35$\n$i=6$: $x_6=11$, $y_6=0.27$, $w_6=1.10$\n\n问题指定使用协方差估计量 $\\widehat{\\operatorname{Cov}}(a,b)=\\frac{1}{n}\\sum_{i=1}^{n}(a_{i}-\\bar{a})(b_{i}-\\bar{b})$。样本量为 $n=6$。给定的平均相对适合度为 $\\bar{w}=1$。\n\n首先，我们计算性状 $x$ 和 $y$ 的样本均值。\n$$ \\bar{x} = \\frac{1}{6} \\sum_{i=1}^{6} x_i = \\frac{1}{6}(9+10+11+9+12+11) = \\frac{62}{6} = \\frac{31}{3} $$\n$$ \\bar{y} = \\frac{1}{6} \\sum_{i=1}^{6} y_i = \\frac{1}{6}(0.22+0.25+0.28+0.20+0.30+0.27) = \\frac{1.52}{6} = \\frac{152}{600} = \\frac{19}{75} $$\n\n第1部分：选择微分向量 $\\mathbf{S}$\n性状 $z_j$ 的选择微分定义为 $S_j = \\operatorname{Cov}(z_j, w)$。给定 $\\bar{w}=1$，协方差简化为 $\\operatorname{Cov}(z_j, w) = \\frac{1}{n}\\sum(z_{ji} - \\bar{z}_j)(w_i-1) = \\frac{1}{n}(\\sum z_{ji} w_i - \\sum z_{ji}) = \\frac{1}{n}\\sum z_{ji} w_i - \\bar{z}_j$。\n\n对于性状 $x$：\n$$ \\sum_{i=1}^{6} x_i w_i = (9)(0.75) + (10)(0.95) + (11)(1.15) + (9)(0.70) + (12)(1.35) + (11)(1.10) $$\n$$ = 6.75 + 9.5 + 12.65 + 6.3 + 16.2 + 12.1 = 63.5 = \\frac{127}{2} $$\n$$ S_x = \\operatorname{Cov}(x, w) = \\frac{1}{6} \\left(\\frac{127}{2}\\right) - \\bar{x} = \\frac{127}{12} - \\frac{31}{3} = \\frac{127 - 124}{12} = \\frac{3}{12} = \\frac{1}{4} $$\n\n对于性状 $y$：\n$$ \\sum_{i=1}^{6} y_i w_i = (0.22)(0.75) + (0.25)(0.95) + (0.28)(1.15) + (0.20)(0.70) + (0.30)(1.35) + (0.27)(1.10) $$\n$$ = 0.165 + 0.2375 + 0.322 + 0.140 + 0.405 + 0.297 = 1.5665 = \\frac{3133}{2000} $$\n$$ S_y = \\operatorname{Cov}(y, w) = \\frac{1}{6} \\left(\\frac{3133}{2000}\\right) - \\bar{y} = \\frac{3133}{12000} - \\frac{19}{75} = \\frac{3133 - 19 \\cdot 160}{12000} = \\frac{3133 - 3040}{12000} = \\frac{93}{12000} = \\frac{31}{4000} $$\n选择微分向量为 $\\mathbf{S} = \\begin{pmatrix} S_x \\\\ S_y \\end{pmatrix} = \\begin{pmatrix} 1/4 \\\\ 31/4000 \\end{pmatrix}$。\n\n第2部分：方向性选择梯度向量 $\\boldsymbol{\\beta}$\n选择梯度向量由 $\\boldsymbol{\\beta} = \\mathbf{P}^{-1} \\mathbf{S}$ 给出，其中 $\\mathbf{P}$ 是性状的表型方差-协方差矩阵。$\\mathbf{P}$ 的元素为 $P_{11} = \\operatorname{Var}(x)$，$P_{22} = \\operatorname{Var}(y)$ 和 $P_{12} = \\operatorname{Cov}(x, y)$。我们使用指定的估计量，因此 $\\operatorname{Var}(z) = \\frac{1}{n} \\sum z_i^2 - \\bar{z}^2$。\n\n$$ \\sum x_i^2 = 9^2+10^2+11^2+9^2+12^2+11^2 = 81+100+121+81+144+121 = 648 $$\n$$ P_{11} = \\operatorname{Var}(x) = \\frac{648}{6} - \\left(\\frac{31}{3}\\right)^2 = 108 - \\frac{961}{9} = \\frac{972-961}{9} = \\frac{11}{9} $$\n$$ \\sum y_i^2 = 0.22^2+0.25^2+0.28^2+0.20^2+0.30^2+0.27^2 = 0.0484+0.0625+0.0784+0.0400+0.0900+0.0729 = 0.3922 = \\frac{1961}{5000} $$\n$$ P_{22} = \\operatorname{Var}(y) = \\frac{1}{6}\\frac{1961}{5000} - \\left(\\frac{19}{75}\\right)^2 = \\frac{1961}{30000} - \\frac{361}{5625} = \\frac{1961 \\cdot 3 - 361 \\cdot 16}{90000} = \\frac{5883 - 5776}{90000} = \\frac{107}{90000} $$\n$$ \\sum x_i y_i = (9)(0.22)+(10)(0.25)+(11)(0.28)+(9)(0.20)+(12)(0.30)+(11)(0.27) = 1.98+2.5+3.08+1.8+3.6+2.97 = 15.93 = \\frac{1593}{100} $$\n$$ P_{12} = \\operatorname{Cov}(x,y) = \\frac{1}{6}\\frac{1593}{100} - \\left(\\frac{31}{3}\\right)\\left(\\frac{19}{75}\\right) = \\frac{531}{200} - \\frac{589}{225} = \\frac{531 \\cdot 9 - 589 \\cdot 8}{1800} = \\frac{4779-4712}{1800} = \\frac{67}{1800} $$\n表型方差-协方差矩阵为 $\\mathbf{P} = \\begin{pmatrix} 11/9  67/1800 \\\\ 67/1800  107/90000 \\end{pmatrix}$。\n行列式为 $\\det(\\mathbf{P}) = \\left(\\frac{11}{9}\\right)\\left(\\frac{107}{90000}\\right) - \\left(\\frac{67}{1800}\\right)^2 = \\frac{1177}{810000} - \\frac{4489}{3240000} = \\frac{4 \\cdot 1177 - 4489}{3240000} = \\frac{4708-4489}{3240000} = \\frac{219}{3240000} = \\frac{73}{1080000}$。\n逆矩阵为 $\\mathbf{P}^{-1} = \\frac{1}{\\det(\\mathbf{P})} \\begin{pmatrix} P_{22}  -P_{12} \\\\ -P_{12}  P_{11} \\end{pmatrix} = \\frac{1080000}{73} \\begin{pmatrix} 107/90000  -67/1800 \\\\ -67/1800  11/9 \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284  -40200 \\\\ -40200  1320000 \\end{pmatrix}$。\n现在我们计算 $\\boldsymbol{\\beta} = \\mathbf{P}^{-1} \\mathbf{S}$：\n$$ \\begin{pmatrix} \\beta_x \\\\ \\beta_y \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284  -40200 \\\\ -40200  1320000 \\end{pmatrix} \\begin{pmatrix} 1/4 \\\\ 31/4000 \\end{pmatrix} = \\frac{1}{73} \\begin{pmatrix} 1284 \\cdot \\frac{1}{4} - 40200 \\cdot \\frac{31}{4000} \\\\ -40200 \\cdot \\frac{1}{4} + 1320000 \\cdot \\frac{31}{4000} \\end{pmatrix} $$\n$$ \\beta_x = \\frac{1}{73} \\left(321 - \\frac{4020 \\cdot 31}{400}\\right) = \\frac{1}{73} \\left(321 - \\frac{201 \\cdot 31}{20}\\right) = \\frac{1}{73} \\left(\\frac{6420 - 6231}{20}\\right) = \\frac{1}{73}\\left(\\frac{189}{20}\\right) = \\frac{189}{1460} $$\n$$ \\beta_y = \\frac{1}{73} \\left(-10050 + \\frac{1320 \\cdot 31}{4}\\right) = \\frac{1}{73} (-10050 + 330 \\cdot 31) = \\frac{1}{73} (-10050 + 10230) = \\frac{180}{73} $$\n选择梯度向量为 $\\boldsymbol{\\beta} = \\begin{pmatrix} 189/1460 \\\\ 180/73 \\end{pmatrix}$。\n\n第3部分：预测的单代响应 $\\Delta \\bar{\\mathbf{z}}$\n选择响应由 $\\Delta \\bar{\\mathbf{z}} = \\mathbf{G}\\boldsymbol{\\beta}$ 给出，其中提供的加性遗传方差-协方差矩阵为 $\\mathbf{G} = \\begin{pmatrix} 1/2  1/100 \\\\ 1/100  1/4000 \\end{pmatrix}$。\n$$ \\begin{pmatrix} \\Delta\\bar{z}_x \\\\ \\Delta\\bar{z}_y \\end{pmatrix} = \\begin{pmatrix} 1/2  1/100 \\\\ 1/100  1/4000 \\end{pmatrix} \\begin{pmatrix} 189/1460 \\\\ 180/73 \\end{pmatrix} $$\n$$ \\Delta\\bar{z}_x = \\left(\\frac{1}{2}\\right)\\left(\\frac{189}{1460}\\right) + \\left(\\frac{1}{100}\\right)\\left(\\frac{180}{73}\\right) = \\frac{189}{2920} + \\frac{180}{7300} = \\frac{189}{40 \\cdot 73} + \\frac{18}{10 \\cdot 73} = \\frac{189 \\cdot 5 + 18 \\cdot 20}{200 \\cdot 73} = \\frac{945+360}{14600} = \\frac{1305}{14600} = \\frac{261}{2920} $$\n$$ \\Delta\\bar{z}_y = \\left(\\frac{1}{100}\\right)\\left(\\frac{189}{1460}\\right) + \\left(\\frac{1}{4000}\\right)\\left(\\frac{180}{73}\\right) = \\frac{189}{146000} + \\frac{180}{292000} = \\frac{2 \\cdot 189 + 180}{292000} = \\frac{378+180}{292000} = \\frac{558}{292000} = \\frac{279}{146000} $$\n预测的响应向量为 $\\Delta\\bar{\\mathbf{z}} = \\begin{pmatrix} 261/2920 \\\\ 279/146000 \\end{pmatrix}$。\n\n按要求的顺序汇总的最终结果如下：\n$S_x = \\frac{1}{4}$\n$S_y = \\frac{31}{4000}$\n$\\beta_x = \\frac{189}{1460}$\n$\\beta_y = \\frac{180}{73}$\n$\\Delta\\bar{z}_x = \\frac{261}{2920}$\n$\\Delta\\bar{z}_y = \\frac{279}{146000}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{31}{4000}  \\frac{189}{1460}  \\frac{180}{73}  \\frac{261}{2920}  \\frac{279}{146000} \\end{pmatrix}}\n$$", "id": "2571671"}, {"introduction": "前面的练习提供了选择作用的静态“快照”，而本最终练习将这些概念整合到一个动态模拟中，以探索传粉综合征在演化时间尺度上如何形成与分化。通过构建一个将植物性状演化与传粉者觅食行为及学习过程相耦合的模型，你将亲眼观察到，在一个初始均匀的群体中，正反馈循环如何驱动离散性状集群的出现。这个练习将让你深刻体会到协同演化模式背后复杂的、涌现性的本质。[@problem_id:2571546]", "problem": "你的任务是形式化并模拟一个耦合的植物-传粉者进化系统，以研究作为植物性状进化与传粉者觅食行为之间反馈产物的传粉综合征的涌现。该系统必须使用数量遗传学和决策理论的标准模型从第一性原理出发进行指定和求解，然后实现为一个算法，为一组精心挑选的测试用例产生可量化的输出。\n\n建模假设和基本原理：\n- 植物性状进化遵循数量遗传学中的 Lande 方程：平均性状的变化与加性遗传方差乘以选择梯度成正比。具体而言，对于性状为 $t_i$、加性遗传方差为 $G$ 的植物形态 $i$，其更新规则为 $t_i \\leftarrow t_i + G \\, \\frac{\\partial \\ln W_i}{\\partial t_i}$，其中 $W_i$ 是形态 $i$ 的适应度。\n- 离散植物形态间的频率变化遵循复制子动态：对于频率为 $x_i$ 且满足 $\\sum_i x_i = 1$ 的情况，乘性适应度更新给出 $x_i \\leftarrow x_i \\, W_i$，然后进行归一化以保持 $\\sum_i x_i = 1$。\n- 传粉者觅食被建模为基于智能体的多项 logit (softmax) 选择，该选择源于带 Gumbel 噪声的效用最大化或 Boltzmann 理性。对于每个性状偏好为 $p_j$、逆温度为 $\\beta$ 的传粉者智能体 $j$，其访问形态 $i$ 的概率为\n$$\nP_{ij} = \\frac{x_i \\, \\exp\\!\\left(-\\beta \\, (t_i - p_j)^2\\right)}{\\sum_{k} x_k \\, \\exp\\!\\left(-\\beta \\, (t_k - p_j)^2\\right)}.\n$$\n- 每个传粉者智能体每代进行 $R$ 次访问，因此形态 $i$ 每代的预期访问次数为 $V_i = \\sum_{j} R \\, P_{ij}$。\n- 植物形态的适应度结合了访问收益和稳定化代价，假定在适应度上是乘性的，因此在对数适应度上是加性的：\n$$\n\\ln W_i = \\alpha \\, V_i \\;-\\; \\gamma \\, (t_i - \\theta)^2,\n$$\n所以 $W_i = \\exp\\!\\left(\\alpha V_i - \\gamma (t_i - \\theta)^2\\right)$。\n- 植物性状的选择梯度为\n$$\n\\frac{\\partial \\ln W_i}{\\partial t_i} = \\alpha \\, \\frac{\\partial V_i}{\\partial t_i} \\;-\\; 2 \\gamma \\, (t_i - \\theta),\n$$\n其中\n$$\n\\frac{\\partial V_i}{\\partial t_i} = \\sum_{j} R \\, \\frac{\\partial P_{ij}}{\\partial t_i}\n\\quad\\text{且}\\quad\n\\frac{\\partial P_{ij}}{\\partial t_i} = -2 \\beta \\, (t_i - p_j) \\, P_{ij} \\, (1 - P_{ij}).\n$$\n- 传粉者的偏好通过强化作用向它们所访问性状的平均值适应，学习率为 $\\eta$：\n$$\np_j \\leftarrow p_j + \\eta \\sum_i P_{ij} \\, (t_i - p_j).\n$$\n\n算法要求：\n- 模拟耦合动态共 $T$ 个离散代。在每一代中：计算 $P_{ij}$ 和 $V_i$，通过乘性适应度和重新归一化来更新植物频率 $x_i$，使用上述选择梯度通过 Lande 方程更新植物性状 $t_i$，并通过强化学习更新传粉者偏好 $p_j$。一代内的所有更新必须基于相同的更新前状态进行计算（同步更新）。\n- 当所有植物频率、植物性状和传粉者偏好在连续两代之间的最大绝对变化小于容差 $\\varepsilon$ 时，应判断为收敛。\n\n综合征检测和摘要指标：\n- 模拟结束后，按如下方式识别涌现的植物性状簇的数量：仅保留最终频率 $x_i \\ge f_{\\min}$ 的形态，对其最终性状进行排序，当相邻的保留性状之间的距离大于分离阈值 $\\Delta$ 时，计为一个新的簇。这样可以得到一个整数的簇计数。\n- 将匹配分数定义为“匹配”访问的比例，其中当 $|t_i - p_j| \\le d_{\\mathrm{match}}$ 时，传粉者 $j$ 对形态 $i$ 的一次访问被计为匹配。根据最后一代的数据计算如下：\n$$\n\\text{匹配分数} = \n\\begin{cases}\n\\frac{1}{M} \\sum_{j} \\sum_i P_{ij} \\,\\mathbf{1}\\{|t_i - p_j| \\le d_{\\mathrm{match}}\\},  \\text{若 } M  0,\\\\\n0,  \\text{若 } M = 0,\n\\end{cases}\n$$\n其中 $\\mathbf{1}\\{\\cdot\\}$ 是指示函数。\n- 收敛是一个布尔值，指示是否在 $T$ 代内达到了容差标准。\n\n测试套件：\n实现你的程序以运行以下四个测试用例。所有用例使用相同的通用模拟结构，但参数值不同。请明确使用所列出的值。\n\n- 用例A（双峰功能群，强选择性；预期出现分化综合征）：\n  - 植物形态数量 $K = 3$，初始性状 $\\mathbf{t}^{(0)} = [-0.2, 0.0, 0.2]$，初始频率 $\\mathbf{x}^{(0)} = [\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}]$。\n  - 传粉者数量 $M = 40$，初始偏好由20个 $p=-1$ 的智能体和20个 $p=+1$ 的智能体组成。\n  - 参数：$\\beta = 10.0$, $R = 5$, $\\alpha = 0.01$, $\\gamma = 0.05$, $\\theta = 0.0$, $G = 0.005$, $\\eta = 0.02$, $T = 2000$。\n  - 综合征检测：$f_{\\min} = 0.05$, $\\Delta = 0.5$, $d_{\\mathrm{match}} = 0.3$, 收敛容差 $\\varepsilon = 10^{-6}$。\n\n- 用例B（单一中心化功能群；预期在功能群偏好附近出现单一综合征）：\n  - $K = 3$，$\\mathbf{t}^{(0)} = [-0.2, 0.0, 0.2]$，$\\mathbf{x}^{(0)} = [\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}]$。\n  - $M = 40$，初始偏好：40个智能体的 $p = 0$。\n  - $\\beta = 10.0$, $R = 5$, $\\alpha = 0.01$, $\\gamma = 0.05$, $\\theta = 0.0$, $G = 0.005$, $\\eta = 0.02$, $T = 2000$。\n  - $f_{\\min} = 0.05$, $\\Delta = 0.5$, $d_{\\mathrm{match}} = 0.3$, $\\varepsilon = 10^{-6}$。\n\n- 用例C（双峰功能群，极低的遗传方差；预期出现有限的分化）：\n  - $K = 3$，$\\mathbf{t}^{(0)} = [-0.2, 0.0, 0.2]$，$\\mathbf{x}^{(0)} = [\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}]$。\n  - $M = 40$，初始偏好：20个智能体的 $p=-1$ 和20个智能体的 $p=+1$。\n  - $\\beta = 10.0$, $R = 5$, $\\alpha = 0.01$, $\\gamma = 0.05$, $\\theta = 0.0$, $G = 10^{-4}$, $\\eta = 0.02$, $T = 2000$。\n  - $f_{\\min} = 0.05$, $\\Delta = 0.5$, $d_{\\mathrm{match}} = 0.3$, $\\varepsilon = 10^{-6}$。\n\n- 用例D（无传粉者；仅有稳定化选择）：\n  - $K = 3$, $\\mathbf{t}^{(0)} = [-0.2, 0.0, 0.2]$, $\\mathbf{x}^{(0)} = [\\tfrac{1}{3}, \\tfrac{1}{3}, \\tfrac{1}{3}]$。\n  - $M = 0$, 无传粉者偏好。\n  - $\\beta = 10.0$, $R = 5$, $\\alpha = 0.01$, $\\gamma = 0.05$, $\\theta = 0.0$, $G = 0.005$, $\\eta = 0.02$, $T = 2000$。\n  - $f_{\\min} = 0.05$, $\\Delta = 0.5$, $d_{\\mathrm{match}} = 0.3$, $\\varepsilon = 10^{-6}$。\n\n程序输出要求：\n- 对于每个用例，计算并返回一个包含三个值的列表：整数形式的簇数量，四舍五入到三位小数的匹配分数（浮点数），以及一个表示是否收敛的布尔值。\n- 你的程序应生成单行输出，其中包含四个用例的结果，形式为列表的列表，按A、B、C、D的顺序排列，格式严格如下：\n\"[ [clusters_A,match_A,converged_A], [clusters_B,match_B,converged_B], [clusters_C,match_C,converged_C], [clusters_D,match_D,converged_D] ]\"\n除了此处显示的可选空格外，不应有其他空格。浮点数值必须四舍五入到三位小数。", "solution": "我们推导出一个基于原理的模型和算法流程，以耦合植物性状进化与基于智能体的传粉者觅食行为，然后明确了涌现的传粉综合征的检测方法。\n\n基本要素：\n- 数量遗传学（Lande 方程）：平均数量性状的变化等于加性遗传方差乘以选择梯度。对于平均性状为 $t_i$、加性遗传方差为 $G$ 的植物形态 $i$，每代的更新使用 $t_i \\leftarrow t_i + G \\, \\frac{\\partial \\ln W_i}{\\partial t_i}$，其中 $W_i$ 是实现的适应度。\n- 复制子动态：对于频率为 $\\mathbf{x} = (x_1,\\dots,x_K)$、适应度为 $\\mathbf{W} = (W_1,\\dots,W_K)$ 的离散类型，乘性增长后进行归一化可得 $x_i \\leftarrow \\frac{x_i W_i}{\\sum_k x_k W_k}$，这等价于一个离散时间复制子方程。\n- 基于智能体的多项 logit 选择：决策理论和统计力学的一个标准结果表明，如果效用是带有 Gumbel 噪声的二次不匹配的负值，或者在 Boltzmann 理性下，选择概率是负平方距离的 softmax 函数。对于传粉者偏好 $p_j$ 和植物性状 $t_i$，当 $t_i$ 接近 $p_j$ 时效用更高。通过植物可得性 $x_i$ 加权后，选择概率为\n$$\nP_{ij} = \\frac{x_i \\, \\exp\\!\\left(-\\beta (t_i - p_j)^2\\right)}{\\sum_k x_k \\, \\exp\\!\\left(-\\beta (t_k - p_j)^2\\right)}.\n$$\n\n通过访问和适应度进行耦合：\n每个传粉者 $j$ 每代进行 $R$ 次访问，因此对形态 $i$ 的预期访问次数为 $V_i = \\sum_j R \\, P_{ij}$。植物形态 $i$ 的对数适应度为\n$$\n\\ln W_i = \\alpha V_i - \\gamma (t_i - \\theta)^2.\n$$\n$t_i$ 的选择梯度为\n$$\n\\frac{\\partial \\ln W_i}{\\partial t_i} = \\alpha \\frac{\\partial V_i}{\\partial t_i} - 2 \\gamma (t_i - \\theta),\n$$\n且\n$$\n\\frac{\\partial V_i}{\\partial t_i} = \\sum_j R \\, \\frac{\\partial P_{ij}}{\\partial t_i}.\n$$\n我们从 softmax 的定义精确计算 $\\frac{\\partial P_{ij}}{\\partial t_i}$。令 $Z_j = \\sum_k x_k \\exp\\!\\left(-\\beta (t_k - p_j)^2\\right)$ 且 $N_{ij} = x_i \\exp\\!\\left(-\\beta (t_i - p_j)^2\\right)$。那么 $P_{ij} = N_{ij}/Z_j$。微分得到\n$$\n\\frac{\\partial N_{ij}}{\\partial t_i} = N_{ij} \\, (-2\\beta) (t_i - p_j), \\quad\n\\frac{\\partial Z_j}{\\partial t_i} = \\frac{\\partial N_{ij}}{\\partial t_i}.\n$$\n于是\n$$\n\\frac{\\partial P_{ij}}{\\partial t_i} = \\frac{1}{Z_j} \\frac{\\partial N_{ij}}{\\partial t_i} - \\frac{N_{ij}}{Z_j^2} \\frac{\\partial Z_j}{\\partial t_i}\n= \\left(-2\\beta (t_i - p_j)\\right) \\left(\\frac{N_{ij}}{Z_j} - \\frac{N_{ij}^2}{Z_j^2}\\right)\n= -2\\beta (t_i - p_j) \\, P_{ij} \\, (1 - P_{ij}).\n$$\n因此\n$$\n\\frac{\\partial V_i}{\\partial t_i} = \\sum_j R \\left[-2\\beta (t_i - p_j) \\, P_{ij} \\, (1 - P_{ij})\\right].\n$$\n植物性状的更新变为\n$$\nt_i \\leftarrow t_i + G \\left\\{ \\alpha \\sum_j R \\left[-2\\beta (t_i - p_j) \\, P_{ij} \\, (1 - P_{ij})\\right] - 2\\gamma (t_i - \\theta) \\right\\}.\n$$\n\n传粉者偏好适应：\n我们使用一个强化学习规则，其中每个传粉者将其偏好移向其访问的预期性状：\n$$\np_j \\leftarrow p_j + \\eta \\sum_i P_{ij} \\, (t_i - p_j).\n$$\n这是向所访问性状均值的一种收缩，并且与性状匹配线性回报的梯度上升相一致。\n\n同步更新方案：\n在每一代，我们使用当前状态 $(\\mathbf{x}, \\mathbf{t}, \\mathbf{p})$ 计算 $P_{ij}$、$V_i$、$\\ln W_i$ 和梯度，然后同时通过乘性适应度和重新归一化更新 $\\mathbf{x}$，通过 Lande 方程更新 $\\mathbf{t}$，以及通过强化学习更新 $\\mathbf{p}$。\n\n收敛与综合征检测：\n当 $\\mathbf{x}$、$\\mathbf{t}$ 和 $\\mathbf{p}$ 所有条目在连续两代间的最大绝对差值低于 $\\varepsilon$ 时，宣告收敛。综合征检测通过对频率 $x_i \\ge f_{\\min}$ 的形态进行阈值处理，对其最终的 $t_i$ 进行排序，并计算相隔超过 $\\Delta$ 的簇的数量来实现。这将产生一个整数的簇数。我们在最后一代计算匹配分数：\n$$\n\\text{匹配分数} = \n\\begin{cases}\n\\frac{1}{M} \\sum_j \\sum_i P_{ij} \\, \\mathbf{1}\\{|t_i - p_j| \\le d_{\\mathrm{match}}\\},  \\text{若 } M0, \\\\\n0,  \\text{若 } M=0.\n\\end{cases}\n$$\n这个量反映了访问集中于匹配的植物-传粉者对的强度。\n\n每个测试用例的算法步骤：\n1. 初始化 $\\mathbf{x}$、$\\mathbf{t}$、$\\mathbf{p}$。\n2. 对于每一代直到 $T$：\n   - 通过带有 $x_i$ 可用性的 softmax 计算所有 $i,j$ 的 $P_{ij}$。\n   - 计算 $V_i = \\sum_j R \\, P_{ij}$。\n   - 计算 $W_i = \\exp(\\alpha V_i - \\gamma (t_i - \\theta)^2)$ 并更新 $x_i \\leftarrow x_i W_i$，然后重新归一化 $\\mathbf{x}$。\n   - 计算 $\\frac{\\partial V_i}{\\partial t_i} = \\sum_j R \\, \\left[-2\\beta (t_i - p_j) P_{ij} (1 - P_{ij})\\right]$ 并更新 $t_i \\leftarrow t_i + G \\left(\\alpha \\frac{\\partial V_i}{\\partial t_i} - 2\\gamma (t_i - \\theta)\\right)$。\n   - 更新 $p_j \\leftarrow p_j + \\eta \\sum_i P_{ij} (t_i - p_j)$。\n   - 通过 $\\mathbf{x}$、$\\mathbf{t}$、$\\mathbf{p}$ 的串联数组的最大绝对变化检查收敛性；如果低于 $\\varepsilon$，则停止。\n3. 模拟结束后，使用 $f_{\\min}$ 和 $\\Delta$ 计算簇数，使用 $d_{\\mathrm{match}}$ 计算匹配分数，并记录收敛布尔值。\n\n设计原理与反馈：\n- 植物的吸引力随着访问量（$\\alpha V_i$）的增加而增加，而访问量又取决于植物频率和性状匹配度。这就产生了一个正反馈：与传粉者偏好更匹配的性状获得更多访问，从而提高适应度并因此增加频率，强化了访问优势。带有 $\\beta$ 的 softmax 非线性控制着传粉者的区分强度；较大的 $\\beta$ 会放大这种反馈，在偏好多峰时有利于分化。\n- 稳定化代价 $\\gamma (t_i - \\theta)^2$ 提供了一种抗衡力量，可以防止失控分化，在觅食行为较弱或有噪声时将性状锚定在 $\\theta$ 附近。\n- 传粉者强化（$\\eta$）增加了相互反馈：传粉者的偏好向频繁访问的性状漂移，这可能根据初始的多峰性来稳定综合征或放大分化。\n\n测试套件覆盖范围：\n- 用例A：两个功能群分别在 $p=-1$ 和 $p=+1$，高 $\\beta$，中等 $G$；由于分化选择，预期出现两个簇，高匹配分数，很可能收敛。\n- 用例B：单一功能群在 $p=0$；预期在 $0$ 附近出现一个簇，高匹配分数，很可能收敛。\n- 用例C：两个功能群但 $G$ 非常小；性状移动有限，可能只有一个簇（分离不足），中等匹配分数，很可能收敛（变化小）。\n- 用例D：零传粉者；$V_i=0$，性状被稳定化选择拉向 $\\theta=0$，一个簇，匹配分数为零，很可能收敛。\n\n该程序精确地实现了这些步骤，为每个用例返回整数簇数、四舍五入到三位小数的匹配分数以及收敛布尔值，并以指定的顺序和格式打印包含这些三元组的单行列表。", "answer": "```python\nimport numpy as np\n\ndef simulate_case(params):\n    # Unpack parameters\n    K = params['K']\n    t = np.array(params['t0'], dtype=float)  # plant traits\n    x = np.array(params['x0'], dtype=float)  # plant frequencies\n    x = x / x.sum()\n    M = params['M']\n    if M > 0:\n        p = np.array(params['p0'], dtype=float)  # pollinator preferences\n    else:\n        p = np.array([], dtype=float)\n\n    beta = params['beta']\n    R = params['R']\n    alpha = params['alpha']\n    gamma = params['gamma']\n    theta = params['theta']\n    G = params['G']\n    eta = params['eta']\n    T = params['T']\n    f_min = params['f_min']\n    Delta = params['Delta']\n    d_match = params['d_match']\n    eps = params['eps']\n\n    converged = False\n\n    # Helper to compute P_ij given current x, t, p\n    def compute_P(x, t, p):\n        # Returns matrix P of shape (K, M)\n        if p.size == 0:\n            return np.zeros((K, 0), dtype=float)\n        # attractiveness A_ij = x_i * exp(-beta * (t_i - p_j)^2)\n        # Use broadcasting\n        diff = t[:, None] - p[None, :]\n        A = x[:, None] * np.exp(-beta * (diff ** 2))\n        Z = A.sum(axis=0, keepdims=True)  # shape (1, M)\n        # Avoid division by zero: if Z_j == 0, distribute uniformly by x\n        zero_cols = (Z[0] == 0.0)\n        P = np.zeros_like(A)\n        if np.any(~zero_cols):\n            P[:, ~zero_cols] = A[:, ~zero_cols] / Z[:, ~zero_cols]\n        if np.any(zero_cols):\n            # fallback: proportional to availability x\n            P[:, zero_cols] = x[:, None]\n        return P\n\n    # Main simulation loop\n    for _ in range(T):\n        x_prev = x.copy()\n        t_prev = t.copy()\n        p_prev = p.copy()\n\n        # Compute choice probabilities and visits\n        P = compute_P(x_prev, t_prev, p_prev)\n        if M > 0:\n            V = R * P.sum(axis=1)  # total expected visits per morph\n        else:\n            V = np.zeros(K, dtype=float)\n\n        # Compute fitness and update frequencies\n        lnW = alpha * V - gamma * (t_prev - theta) ** 2\n        # To improve numerical stability, subtract max lnW before exponentiating\n        lnW_centered = lnW - np.max(lnW)\n        W = np.exp(lnW_centered)\n        x = x_prev * W\n        x_sum = x.sum()\n        if x_sum == 0.0:\n            # In degenerate case, revert to previous frequencies\n            x = x_prev.copy()\n        else:\n            x = x / x_sum\n\n        # Compute selection gradient for t\n        if M > 0:\n            # dV_i/dt_i = sum_j R * (-2 beta (t_i - p_j) * P_ij * (1 - P_ij))\n            diff = t_prev[:, None] - p_prev[None, :]\n            dV_dt = R * (-2.0 * beta) * np.sum(diff * P * (1.0 - P), axis=1)\n        else:\n            dV_dt = np.zeros(K, dtype=float)\n        grad_lnW = alpha * dV_dt - 2.0 * gamma * (t_prev - theta)\n        t = t_prev + G * grad_lnW\n\n        # Update pollinator preferences\n        if M > 0:\n            # p_j - p_j + eta * sum_i P_ij * (t_i - p_j)\n            # Use t_prev for synchronous update\n            delta_p = eta * (np.sum(P * (t_prev[:, None] - p_prev[None, :]), axis=0))\n            p = p_prev + delta_p\n\n        # Convergence check\n        max_change = 0.0\n        max_change = max(max_change, np.max(np.abs(x - x_prev)))\n        max_change = max(max_change, np.max(np.abs(t - t_prev)))\n        if M > 0:\n            max_change = max(max_change, np.max(np.abs(p - p_prev)))\n        if max_change  eps:\n            converged = True\n            break\n\n    # Final metrics\n    # Cluster counting for morphs with x_i >= f_min\n    retained_idx = np.where(x >= f_min)[0]\n    if retained_idx.size == 0:\n        clusters = 0\n    else:\n        t_retained = np.sort(t[retained_idx])\n        clusters = 1\n        for i in range(1, t_retained.size):\n            if abs(t_retained[i] - t_retained[i - 1]) > Delta:\n                clusters += 1\n\n    # Match fraction at final state\n    if M > 0:\n        P_final = compute_P(x, t, p)\n        diff_final = np.abs(t[:, None] - p[None, :])\n        matched_mask = (diff_final = d_match).astype(float)\n        # Fraction of visits matched: average over pollinators of sum_i P_ij * indicator\n        match_fraction = float(np.mean(np.sum(P_final * matched_mask, axis=0)))\n    else:\n        match_fraction = 0.0\n\n    return [int(clusters), float(round(match_fraction + 1e-12, 3)), bool(converged)]\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Case A\n            'K': 3,\n            't0': [-0.2, 0.0, 0.2],\n            'x0': [1/3, 1/3, 1/3],\n            'M': 40,\n            'p0': ([-1.0] * 20) + ([1.0] * 20),\n            'beta': 10.0,\n            'R': 5,\n            'alpha': 0.01,\n            'gamma': 0.05,\n            'theta': 0.0,\n            'G': 0.005,\n            'eta': 0.02,\n            'T': 2000,\n            'f_min': 0.05,\n            'Delta': 0.5,\n            'd_match': 0.3,\n            'eps': 1e-6\n        },\n        {\n            # Case B\n            'K': 3,\n            't0': [-0.2, 0.0, 0.2],\n            'x0': [1/3, 1/3, 1/3],\n            'M': 40,\n            'p0': ([0.0] * 40),\n            'beta': 10.0,\n            'R': 5,\n            'alpha': 0.01,\n            'gamma': 0.05,\n            'theta': 0.0,\n            'G': 0.005,\n            'eta': 0.02,\n            'T': 2000,\n            'f_min': 0.05,\n            'Delta': 0.5,\n            'd_match': 0.3,\n            'eps': 1e-6\n        },\n        {\n            # Case C\n            'K': 3,\n            't0': [-0.2, 0.0, 0.2],\n            'x0': [1/3, 1/3, 1/3],\n            'M': 40,\n            'p0': ([-1.0] * 20) + ([1.0] * 20),\n            'beta': 10.0,\n            'R': 5,\n            'alpha': 0.01,\n            'gamma': 0.05,\n            'theta': 0.0,\n            'G': 1e-4,\n            'eta': 0.02,\n            'T': 2000,\n            'f_min': 0.05,\n            'Delta': 0.5,\n            'd_match': 0.3,\n            'eps': 1e-6\n        },\n        {\n            # Case D\n            'K': 3,\n            't0': [-0.2, 0.0, 0.2],\n            'x0': [1/3, 1/3, 1/3],\n            'M': 0,\n            'p0': [],\n            'beta': 10.0,\n            'R': 5,\n            'alpha': 0.01,\n            'gamma': 0.05,\n            'theta': 0.0,\n            'G': 0.005,\n            'eta': 0.02,\n            'T': 2000,\n            'f_min': 0.05,\n            'Delta': 0.5,\n            'd_match': 0.3,\n            'eps': 1e-6\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(simulate_case(case))\n\n    # Format and print results: list of [clusters, match_fraction, converged]\n    def format_results(results_list):\n        def fmt_item(item):\n            if isinstance(item, float):\n                return f\"{item:.3f}\"\n            elif isinstance(item, bool):\n                return \"True\" if item else \"False\"\n            else:\n                return str(item)\n        inner = []\n        for res in results_list:\n            inner.append(\"[\" + \",\".join(fmt_item(v) for v in res) + \"]\")\n        return \"[\" + \",\".join(inner) + \"]\"\n\n    print(format_results(results))\n\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2571546"}]}