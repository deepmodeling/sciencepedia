{"hands_on_practices": [{"introduction": "在发育生物学中，经典的胚胎学实验，如组织移植，是理解模式形成机制的基石。本练习将带您深入探讨著名的“极化活动区”（ZPA）移植实验，该实验揭示了音猬因子 (Sonic hedgehog, *Shh*) 作为关键形态发生素在肢体前后轴向发育中的作用。这个思想实验不仅要求您预测实验结果，更重要的是，它挑战您设计一个基于分子标记的策略，以区分两种关于形态发生素作用范围的竞争模型——长程梯度模型与短程接力模型，从而磨练您在机制探究中的严谨实验设计能力。", "problem": "鸡胚翼芽中的一个经典移植实验是将第二个音猬因子 (Sonic hedgehog, Shh)来源放置在前缘，产生异位的前部Shh表达，而内源性的后部极化活性区 (ZPA) 保持完整。考虑一个Hamburger–Hamilton (HH) 第$20$期的翼芽，在其前后轴指头发育身份被指定的阶段，在前部短暂植入一个浸泡了Shh的小珠。假设以下基本事实作为推理基础：(i) 形态发生素是一种分泌因子，它形成一个浓度场，细胞通过阈值将其解读为不同的命运，(ii) 分子生物学中心法则 (DNA $\\rightarrow$ RNA $\\rightarrow$ 蛋白质) 允许通过即刻早期转录靶点直接读取信号通路，以及 (iii) Shh结合Patched1 (*Ptch1*)，解除对Smoothened的抑制，从而激活GLI转录因子；*Ptch1*和*Gli1*是Shh信号的直接转录靶点，而*Gremlin1*和5' *Hoxd*基因 (例如 *Hoxd13*) 可以通过与来自顶外胚层脊 (AER) 的成纤维细胞生长因子 (FGF) 信号的反馈间接维持。\n\n在这种异位前部Shh场景下，哪个选项最能预测指序，并提出一种基于标记物的实验策略，以区分直接长程Shh梯度机制和短程Shh接力机制？\n\nA. 预测出现前后轴序列为$4$-$3$-$2$-$2$-$3$-$4$的镜像重复。为区分这两种机制，在早期时间点 (例如，移植后约$\\sim$$6$–$8$小时和约$\\sim$$18$–$24$小时) 对*Ptch1*和*Gli1*进行时间分辨原位杂交。直接梯度模型预测，在早期，*Ptch1*/*Gli1*的表达在靠近后部和异位前部来源处出现两个局部最大值，并向区域中心单调衰减；*Alx4*应在两个来源附近被对称抑制。接力模型预测，在早期，*Ptch1*/*Gli1*的表达局限于Shh来源附近的区域，而*Gremlin1*和*Hoxd13*的表达在稍晚时间点会更广泛地扩展到中央的间充质中，超出*Ptch1*/*Gli1*的表达域。\n\nB. 预测出现前后轴序列为$2$-$3$-$4$-$4$-$3$-$2$的镜像重复。为区分这两种机制，追踪AER中*Fgf8*的扩展，并预期如果梯度机制起作用，*Ptch1*将在整个间充质中均匀表达；如果接力机制起作用，*Ptch1*将在前部缺失。\n\nC. 预测出现前后轴序列为$4$-$3$-$2$-$2$-$3$-$4$的镜像重复。为区分这两种机制，仅量化*Hoxd13*作为Shh梯度的直接读出；梯度应产生一个均匀的*Hoxd13*平台，而接力应产生一个斑块状的*Hoxd13*表达域。\n\nD. 预测出现无镜像对称性的非有序多指畸形。为区分这两种机制，检测*Tbx5*与*Tbx4*的表达；梯度应将前部的*Tbx5*转换为*Tbx4*，而接力则不应改变*Tbx5*/*Tbx4*。", "solution": "问题陈述在科学上是合理的、阐述清晰且内部一致的。它描述了发育生物学中的一个经典实验——将形态发生素Sonic hedgehog (*Shh*) 异位施用于发育中的鸡胚肢芽。所提供的关于*Shh*信号通路及其转录靶点的假设基于已确立的分子生物学知识，为解决该问题提供了有效的框架。该问题要求预测产生的表型，并设计一个实验来区分两种相互竞争的形态发生素作用模型，这是模式形成研究的核心任务。因此，可以推导出一个严谨的解决方案。\n\n该问题描述了一个处于Hamburger-Hamilton (HH) 第$20$期的鸡胚翼芽，它有两个形态发生素*Shh*的来源：内源性的后部极化活性区 (ZPA) 和一个异位的、浸泡过*Shh*的前部小珠。这种设置在肢芽前后 (AP) 轴的前后两极创建了两个信号中心。\n\n首先，我们必须预测最终形成的指头模式。在正常发育中，单一的后部*Shh*来源建立了一个从后向前递减的梯度。间充质细胞解读这个浓度梯度，以从后到前的顺序$4, 3, 2$来指定指头身份。高浓度的*Shh*指定最后侧的指头，即指头$4$；中等浓度指定指头$3$；低浓度指定指头$2$。有了两个相对的*Shh*来源，将建立两个梯度，每个梯度都从各自的极点向肢芽中心衰减。\n- 离后部ZPA最近的细胞将接收到最高浓度的*Shh*并形成指头$4$。\n- 离后部ZPA稍远一些的细胞将接收到中等浓度并形成指头$3$。\n- 离前部*Shh*小珠最近的细胞也将接收到最高浓度的*Shh*并形成指头$4$。\n- 离前部小珠稍远一些的细胞将接收到中等浓度并形成指头$3$。\n- 肢芽中心的细胞，与两个来源等距，将经历来自任一梯度的最低*Shh*浓度，从而形成由*Shh*指定的最前部指头身份，即指头$2$。\n这导致了一个对称的模式。从前到后读取，指序将是镜像重复的：$4$-$3$-$2$-$2$-$3$-$4$。\n\n其次，我们必须设计一个实验策略来区分直接长程梯度机制和短程接力机制。关键是利用所提供的关于*Shh*信号通路的信息。问题陈述指出，*Ptch1*和*Gli1*是*Shh*信号的直接转录靶点。相比之下，*Gremlin1*和5' *Hoxd*基因（如*Hoxd13*）是间接维持的，可能通过涉及成纤维细胞生长因子 (FGF) 信号的反馈回路。\n\n- **直接长程梯度模型：** 该模型假定*Shh*蛋白本身扩散穿过整个区域并被所有细胞直接“读取”。如果这是真的，那么活跃的*Shh*信号的空间域应直接对应于模式化区域的全部范围。因此，直接靶点*Ptch1*和*Gli1*的表达应反映*Shh*配体本身的浓度梯度。实验上，人们会期望看到两个宽泛的*Ptch1*和*Gli1*表达域，每个域在*Shh*来源附近有一个峰值，并平滑地向肢芽中心衰减。这些基因的表达应跨越最终将形成指头$2, 3,$和$4$的整个区域。\n\n- **短程接力模型：** 该模型假定*Shh*仅在其来源的短距离内起作用，以激活次级信号分子或自我传播的基因调控网络，然后由后者对组织的其余部分进行模式化。如果这是真的，*Shh*的直接转录靶点（*Ptch1*，*Gli1*）将仅在靠近*Shh*来源的狭窄细胞区域内被激活。人们会观察到，间接或下游靶点（如*Gremlin1*和后部*Hoxd*基因）的表达会随时间扩展到中央组织中，远远超出*Ptch1*/*Gli1*表达的初始受限区域。\n\n一个决定性的实验将涉及使用原位杂交进行时程分析，以可视化直接（*Ptch1*，*Gli1*）和间接（*Gremlin1*，*Hoxd13*）靶点的表达域。比较这两类基因的空间范围和动态变化将揭示直接*Shh*信号的范围是否与最终模式的范围相匹配。\n\n现在，让我们根据这个推理来评估每个选项。\n\n**A. 预测出现前后轴序列为$4$-$3$-$2$-$2$-$3$-$4$的镜像重复。为区分这两种机制，在早期时间点 (例如，移植后约$\\sim$$6$–$8$小时和约$\\sim$$18$–$24$小时) 对*Ptch1*和*Gli1*进行时间分辨原位杂交。直接梯度模型预测，在早期，*Ptch1*/*Gli1*的表达在靠近后部和异位前部来源处出现两个局部最大值，并向区域中心单调衰减；*Alx4*应在两个来源附近被对称抑制。接力模型预测，在早期，*Ptch1*/*Gli1*的表达局限于Shh来源附近的区域，而*Gremlin1*和*Hoxd13*的表达在稍晚时间点会更广泛地扩展到中央的间充质中，超出*Ptch1*/*Gli1*的表达域。**\n\n这个选项完全正确。\n- 预测的指头模式$4$-$3$-$2$-$2$-$3$-$4$是准确的，如上所述。\n- 所提出的实验——对直接（*Ptch1*，*Gli1*）和间接（*Gremlin1*，*Hoxd13*）靶点进行时间分辨比较——正是正确的策略。\n- 对直接梯度模型的预测（宽泛、分级的*Ptch1*/*Gli1*表达）是正确的。关于前部标记物*Alx4*对称抑制的补充细节也是正确的，并进一步加强了分析。\n- 对接力模型的预测（受限的*Ptch1*/*Gli1*表达域与更宽、不断扩展的*Gremlin1*/*Hoxd13*表达域）准确地抓住了两个模型之间的核心区别。\n因此，该选项在科学上是合理的，在逻辑上是连贯的。**正确**。\n\n**B. 预测出现前后轴序列为$2$-$3$-$4$-$4$-$3$-$2$的镜像重复。为区分这两种机制，追踪AER中*Fgf8*的扩展，并预期如果梯度机制起作用，*Ptch1*将在整个间充质中均匀表达；如果接力机制起作用，*Ptch1*将在前部缺失。**\n\n这个选项因多种原因而不正确。\n- 预测的指头模式$2$-$3$-$4$-$4$-$3$-$2$是颠倒的。极点处的高浓度*Shh*指定后部指头（指头$4$），而不是前部指头（指头$2$）。\n- 实验逻辑存在缺陷。“梯度”不会产生“均匀”的*Ptch1*表达；根据定义，梯度产生的是分级的、不均匀的响应。\n- 对接力模型的预测也是不正确的。在前部*Shh*小珠附近会有一个*Ptch1*的表达域，而不是完全缺失。\n因此，这个选项存在根本性缺陷。**不正确**。\n\n**C. 预测出现前后轴序列为$4$-$3$-$2$-$2$-$3$-$4$的镜像重复。为区分这两种机制，仅量化*Hoxd13*作为Shh梯度的直接读出；梯度应产生一个均匀的*Hoxd13*平台，而接力应产生一个斑块状的*Hoxd13*表达域。**\n\n这个选项不正确。\n- 虽然预测的指头模式$4$-$3$-$2$-$2$-$3$-$4$是正确的，但实验策略基于一个错误的前提。问题陈述明确将*Hoxd13*定义为一个*间接*靶点。因此，它不能用作“*Shh*梯度的直接读出”。\n- “梯度产生一个均匀平台”的预测是对形态发生素梯度如何运作的误解；它们产生的是分级响应。\n- 将接力结果描述为“斑块状表达域”是模糊的，也不是最显著的特征。关键特征是直接和间接靶基因表达域之间的时空不匹配。\n因此，所提出的实验是无效的。**不正确**。\n\n**D. 预测出现无镜像对称性的非有序多指畸形。为区分这两种机制，检测*Tbx5*与*Tbx4*的表达；梯度应将前部的*Tbx5*转换为*Tbx4*，而接力则不应改变*Tbx5*/*Tbx4*。**\n\n这个选项不正确。\n- “非有序多指畸形”的预测是错误的。ZPA/*Shh*移植以产生高度有序的镜像对称模式而闻名。\n- 所提出的实验检测的是错误的生物学过程。*Tbx5*和*Tbx4*是前肢与后肢身份的标记物，而不是一个肢体内指头的前后轴。翼芽中的异位*Shh*会重新模式化AP轴；它不会将翅膀转变为腿。\n因此，这个选项与AP模式化的问题无关。**不正确**。\n\n基于全面的分析，选项A是唯一一个根据所提供的分子事实，正确预测了表型并提出了有效、合理的实验策略来区分两种理论模型的选项。", "answer": "$$\\boxed{A}$$", "id": "2569623"}, {"introduction": "形态的进化改变往往源于发育过程中时间和速率的变异，即“异时性”（heterochrony）。在理解了信号通路如何建立模式之后，下一步是量化这些过程改变所带来的形态学后果。本练习以指间细胞程序性死亡（凋亡）这一经典过程为例，它塑造了从有蹼到无蹼的各种附肢形态。您将通过构建一个简洁的数学模型，来精确计算凋亡起始时间的延迟对最终指间蹼面积的影响，从而将发育调控与可测量的宏观形态变化联系起来。[@problem_id:2569545]", "problem": "在脊椎动物的肢体发育过程中，指/趾间间充质通过由骨形态发生蛋白（BMP）信号驱动的程序性细胞死亡而被移除，这一过程可以建模为活细胞数量的一阶衰变。设 $t$ 表示自细胞凋亡开始后经过的时间，活细胞数量由指数衰减公式 $N(t)=N_0 \\exp(-\\kappa t)$ 给出，其中 $N_0$ 是细胞凋亡开始时的活细胞数量，$\\kappa$ 是一个恒定的速率参数。假设在某一固定的发育终点 $T$，由于细胞密度和厚度近似均匀，预测的指/趾间蹼面积与此时存活的活细胞数量成正比，即 $A(T)=\\alpha N(t)$，其中 $\\alpha$ 为某个比例常数，$t$ 为自凋亡开始后经过的时间。基线条件下的细胞凋亡在肢芽启动后的起始时间 $t_0$ 开始，且发育终点满足 $T>t_0$。考虑一个扰动，该扰动将细胞凋亡的起始时间延迟了 $1.10$ 倍，因此扰动后的起始时间为 $t_0^{\\prime}=1.10\\,t_0$，而速率常数 $\\kappa$ 和终点 $T$ 保持不变，且满足 $T>t_0^{\\prime}$。仅使用这些假设和指数衰变模型，推导在延迟起始条件下与基线条件下，发育终点 $T$ 时预测的蹼面积之比 $A^{\\prime}(T)/A(T)$ 的闭式解析表达式，该表达式应以 $\\kappa$ 和 $t_0$ 表示。请以单个闭式解析表达式的形式给出最终答案。最终表达式无需四舍五入，也无需单位。", "solution": "问题陈述提出了一个关于指/趾间间充质细胞凋亡的定量模型，并要求推导两种不同条件下结果的比率。首先，需要对问题进行严格的验证。\n\n已知条件如下：\n1.  活细胞数量 $N(t)$ 服从一阶衰变模型：$N(t)=N_0 \\exp(-\\kappa t)$，其中 $t$ 是自细胞凋亡开始后经过的时间。\n2.  $N_0$ 是细胞凋亡开始时的初始活细胞数量。\n3.  $\\kappa$ 是一个恒定的速率参数。\n4.  在发育终点 $T$ 预测的蹼面积，记为 $A(T)$，与存活细胞数量成正比：$A(T)=\\alpha N(t)$，其中 $\\alpha$ 是一个比例常数，$t$ 是经过的时间。\n5.  基线条件：细胞凋亡在起始时间 $t_0$ 开始。终点 $T$ 满足 $T > t_0$。\n6.  扰动条件：细胞凋亡起始时间被延迟，新的起始时间为 $t_0^{\\prime}=1.10\\,t_0$。速率常数 $\\kappa$ 和终点 $T$ 保持不变。新的条件 $T > t_0^{\\prime}$ 成立。\n7.  目标是求出扰动后的面积与基线面积之比 $\\frac{A^{\\prime}(T)}{A(T)}$，并用 $\\kappa$ 和 $t_0$ 表示。\n\n该问题具有科学依据，使用标准的指数衰变模型来描述一个生物过程。问题提法清晰，提供了所有必要信息和明确的目标。语言客观，参数一致。略显模糊的记法 $A(T)=\\alpha N(t)$ 可由上下文澄清，上下文规定了所经过的时间 $t$ 必须是相对于相关的起始时间和共同的终点 $T$ 来计算的。因此，该问题被认为是有效的，可以推导出解决方案。\n\n让我们定义一个绝对时间尺度，记为 $\\tau$，从一个任意的原点（如肢芽启动时）开始。\n基线条件下的细胞凋亡发生在 $\\tau = t_0$。\n扰动条件下的细胞凋亡发生在 $\\tau = t_0^{\\prime} = 1.10 t_0$。\n该过程在一个固定的发育终点 $\\tau = T$ 进行评估。\n\n对于基线条件，细胞凋亡的持续时间，即从起始到终点 $T$ 所经过的时间，由 $\\Delta t_{base} = T - t_0$ 给出。\n在时间 $T$ 的活细胞数量可以通过将此经过时间代入衰变模型来确定：\n$$N_{base}(T) = N_0 \\exp(-\\kappa(T - t_0))$$\n预测的蹼面积与此细胞数量成正比：\n$$A(T) = \\alpha N_{base}(T) = \\alpha N_0 \\exp(-\\kappa(T - t_0))$$\n\n对于扰动条件，细胞凋亡的起始延迟到 $t_0^{\\prime}$。到同一终点 $T$ 为止，细胞凋亡的持续时间现在是 $\\Delta t_{pert} = T - t_0^{\\prime} = T - 1.10 t_0$。\n在此扰动下，时间 $T$ 的活细胞数量为：\n$$N_{pert}(T) = N_0 \\exp(-\\kappa(T - 1.10 t_0))$$\n相应的蹼面积为：\n$$A^{\\prime}(T) = \\alpha N_{pert}(T) = \\alpha N_0 \\exp(-\\kappa(T - 1.10 t_0))$$\n\n问题要求计算比率 $\\frac{A^{\\prime}(T)}{A(T)}$。我们使用上面推导出的表达式来构建这个比率：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\frac{\\alpha N_0 \\exp(-\\kappa(T - 1.10 t_0))}{\\alpha N_0 \\exp(-\\kappa(T - t_0))}$$\n比例常数 $\\alpha$ 和初始细胞数 $N_0$ 在分子和分母中都存在，因此可以消去：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\frac{\\exp(-\\kappa(T - 1.10 t_0))}{\\exp(-\\kappa(T - t_0))}$$\n利用指数的性质 $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$，我们可以简化该表达式：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( (-\\kappa(T - 1.10 t_0)) - (-\\kappa(T - t_0)) \\right)$$\n在指数部分展开各项：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( -\\kappa T + 1.10 \\kappa t_0 + \\kappa T - \\kappa t_0 \\right)$$\n涉及终点 $T$ 的项，具体来说是 $-\\kappa T$ 和 $+\\kappa T$，相互抵消。这表明该比率与具体的终点 $T$ 无关，只要 $T$ 大于两个起始时间。表达式简化为：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( 1.10 \\kappa t_0 - \\kappa t_0 \\right)$$\n提取公因式 $\\kappa t_0$：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp\\left( (1.10 - 1) \\kappa t_0 \\right)$$\n这就得出了该比率的最终闭式解析表达式：\n$$\\frac{A^{\\prime}(T)}{A(T)} = \\exp(0.10 \\kappa t_0)$$\n这个结果在物理上是合理的。延迟细胞凋亡的起始会减少细胞死亡发生的时间，导致存活细胞数量增加，从而使蹼面积更大。由于 $\\kappa > 0$ 且 $t_0 > 0$，指数 $0.10 \\kappa t_0$ 为正，使得比率大于1，这与物理推理相符。", "answer": "$$\\boxed{\\exp(0.10 \\kappa t_0)}$$", "id": "2569545"}, {"introduction": "随着基因组学技术的发展，演化发育生物学研究已进入一个新时代，能够系统地比较物种间基因表达的差异，以揭示形态创新的遗传基础。本练习将您置于现代生物信息学分析的前沿，以蝙蝠翼的演化——一个极端指骨伸长的案例——为背景。您将亲手操作一个简化的单细胞RNA测序数据分析流程，通过计算基因表达的差异，识别与指骨伸长相关的保守及趋异的基因模块，并使用超几何检验来评估其统计显著性。这不仅是编码练习，更是对如何从海量数据中提取生物学洞见的实践。[@problem_id:2569639]", "problem": "给定来自蝙蝠和小鼠的肢端细胞的简化、合成的单细胞信使核糖核酸（mRNA）丰度摘要，这些细胞被分为远端组和近端组。从基于分子生物学中心法则（DNA到RNA到蛋白质）的原则性视角，并根据经验观察，即不同解剖区域间的mRNA丰度差异可以反映差异性基因活动，您需要将与指/趾伸长相关的程序建模为远端上调模块。对于每个物种，您必须使用以2为底的倍数变化对数来计算远端偏好，选择排名靠前的基因作为模块，通过物种间的交集导出保守模块，通过蝙蝠特有的集合差集导出分化模块，然后使用单侧超几何检验（无放回抽样）评估这些模块在给定基因集中的富集统计显著性。使用一个小的正伪计数来避免除以零。\n\n使用的核心定义和假设：\n- 对于每个物种 $s$ 和基因 $g$，将远端偏好定义为以2为底的倍数变化对数 $L_{s}(g) = \\log_{2}\\left(\\dfrac{\\mu_{\\text{distal},s}(g) + \\epsilon}{\\mu_{\\text{proximal},s}(g) + \\epsilon}\\right)$，其中 $\\mu_{\\text{distal},s}(g)$ 和 $\\mu_{\\text{proximal},s}(g)$ 分别是远端和近端细胞组的平均mRNA丰度，$\\epsilon$ 是一个小的正伪计数。\n- 选择具有最大正值 $L_{s}(g)$ 的前 $k$ 个基因，形成物种 $s$ 的远端上调模块 $M_{s}$。\n- 定义保守模块 $M_{\\text{cons}} = M_{\\text{bat}} \\cap M_{\\text{mouse}}$ 和蝙蝠分化模块 $M_{\\text{div,bat}} = M_{\\text{bat}} \\setminus M_{\\text{mouse}}$。\n- 基因集富集使用超几何分布进行评估：给定一个大小为 $N = |U|$ 的全集 $U$，一个大小为 $K = |G|$ 的基因集 $G \\subseteq U$，一个大小为 $n = |M|$ 的模块 $M \\subseteq U$，以及一个观测到的重叠大小 $x = |M \\cap G|$，计算单侧 $p$-值 $p = \\Pr[X \\ge x]$，其中 $X \\sim \\text{Hypergeometric}(N, K, n)$。使用生存函数以避免下溢。当 $n = 0$ 时，报告 $p = 1$。\n\n所有测试用例中固定的参数：\n- 伪计数 $\\epsilon = 10^{-3}$。\n- 显著性阈值 $\\alpha = 0.05$。\n- 所有对数均以2为底。\n- 所有 $p$-值均以浮点数形式报告，并四舍五入到六位小数。\n\n您的程序必须为以下测试套件实现上述过程。在所有情况下，请使用提供的基因顺序来对齐向量。\n\n测试用例1（具有明确保守性的理想路径）：\n- 全集 $U_{1}$ 顺序为：[SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},1}$：[$2$, $1$, $4$, $5$, $6$, $0.5$, $1$, $0.5$, $2$, $3$, $4$, $2$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},1}$：[$12$, $10$, $3$, $4$, $5$, $8$, $7$, $6$, $3$, $2$, $4.5$, $1.8$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},1}$：[$2$, $1$, $4$, $5$, $6$, $0.5$, $0.8$, $0.5$, $1$, $3$, $4$, $2$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},1}$：[$11$, $9$, $3$, $4$, $5$, $7$, $6$, $1.5$, $5$, $2$, $4.3$, $1.9$]。\n- 排名靠前的选择大小 $k_{1} = 5$。\n- 伸长基因集 $G_{\\text{elong},1} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$。\n- 比较基因集 $G_{\\text{comp},1} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},1}$ 中的富集 $p$-值，以及 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},1}$ 中的富集 $p$-值。\n\n测试用例2（无重叠和空分化模块的边界情况）：\n- 全集 $U_{2}$ 顺序为：[SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},2}$：[$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},2}$：[$3.5$, $2.4$, $10$, $8$, $9$, $1.3$, $2.5$, $1.5$, $2.2$, $6$, $3.3$, $5$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},2}$：[$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},2}$：[$3.5$, $2.4$, $11$, $9$, $8.5$, $1.3$, $2.2$, $1.7$, $2.2$, $6.2$, $3.3$, $5.3$]。\n- 排名靠前的选择大小 $k_{2} = 5$。\n- 伸长基因集 $G_{\\text{elong},2} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$。\n- 比较基因集 $G_{\\text{comp},2} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},2}$ 中的富集 $p$-值，以及 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},2}$ 中的富集 $p$-值。\n\n测试用例3（小全集中的最大保守性边缘情况）：\n- 全集 $U_{3}$ 顺序为：[FGF8, HOXD13, IGF1, GREM1, SHH, GLI3, BMP2]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},3}$：[$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},3}$：[$8$, $7$, $6$, $5$, $2.5$, $1.8$, $2.5$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},3}$：[$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},3}$：[$8$, $7$, $6$, $5$, $2.3$, $1.9$, $2.6$]。\n- 排名靠前的选择大小 $k_{3} = 4$。\n- 伸长基因集 $G_{\\text{elong},3} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}\\}$。\n- 比较基因集 $G_{\\text{comp},3} = \\{\\text{BMP2}, \\text{GLI3}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},3}$ 中的富集 $p$-值，以及 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},3}$ 中的富集 $p$-值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表形式的结果，并用方括号括起来。每个测试用例贡献一个双元素列表，顺序为 [$p_{\\text{cons}}$, $p_{\\text{div,bat}}$]，每个 $p$ 值四舍五入到六位小数。例如，输出应类似于 [[p11,p12],[p21,p22],[p31,p32]]，每个 $p$ 值显示六位小数，且无多余空格。", "solution": "该问题已经过严格验证。\n\n步骤1：提取已知信息\n该问题为三个测试用例提供了以下定义、参数和数据集。\n\n核心定义：\n- 远端偏好：$L_{s}(g) = \\log_{2}\\left(\\dfrac{\\mu_{\\text{distal},s}(g) + \\epsilon}{\\mu_{\\text{proximal},s}(g) + \\epsilon}\\right)$，对于物种 $s$ 和基因 $g$。\n- 远端上调模块：$M_{s}$ 是具有最大正远端偏好 $L_{s}(g)$ 的前 $k$ 个基因的集合。\n- 保守模块：$M_{\\text{cons}} = M_{\\text{bat}} \\cap M_{\\text{mouse}}$。\n- 蝙蝠分化模块：$M_{\\text{div,bat}} = M_{\\text{bat}} \\setminus M_{\\text{mouse}}$。\n- 超几何 $p$-值：来自超几何分布 $X \\sim \\text{Hypergeometric}(N, K, n)$ 的单侧概率 $\\Pr[X \\ge x]$，其中 $N$ 是全集大小， $K$ 是基因集大小， $n$ 是模块大小， $x$ 是重叠大小。一个特殊情况是：如果 $n=0$，则 $p=1$。\n\n固定参数：\n- 伪计数 $\\epsilon = 10^{-3}$。\n- 显著性阈值 $\\alpha = 0.05$。\n- 对数底为 $2$。\n- 所有 $p$-值都将四舍五入到六位小数。\n\n测试用例1：\n- 全集 $U_1$：[SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},1}$：[$2$, $1$, $4$, $5$, $6$, $0.5$, $1$, $0.5$, $2$, $3$, $4$, $2$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},1}$：[$12$, $10$, $3$, $4$, $5$, $8$, $7$, $6$, $3$, $2$, $4.5$, $1.8$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},1}$：[$2$, $1$, $4$, $5$, $6$, $0.5$, $0.8$, $0.5$, $1$, $3$, $4$, $2$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},1}$：[$11$, $9$, $3$, $4$, $5$, $7$, $6$, $1.5$, $5$, $2$, $4.3$, $1.9$]。\n- 排名靠前的选择大小 $k_1 = 5$。\n- 基因集：$G_{\\text{elong},1} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$， $G_{\\text{comp},1} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},1}$ 中和 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},1}$ 中的富集 $p$-值。\n\n测试用例2：\n- 全集 $U_2$：[SHH, FGF8, BMP2, SOX9, COL2A1, HOXD13, IGF1, GREM1, GLI3, RUNX2, PTCH1, IHH]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},2}$：[$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},2}$：[$3.5$, $2.4$, $10$, $8$, $9$, $1.3$, $2.5$, $1.5$, $2.2$, $6$, $3.3$, $5$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},2}$：[$4$, $3$, $3$, $2$, $2$, $2$, $3$, $2$, $2$, $1$, $3$, $1$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},2}$：[$3.5$, $2.4$, $11$, $9$, $8.5$, $1.3$, $2.2$, $1.7$, $2.2$, $6.2$, $3.3$, $5.3$]。\n- 排名靠前的选择大小 $k_2 = 5$。\n- 基因集：$G_{\\text{elong},2} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}, \\text{SHH}\\}$， $G_{\\text{comp},2} = \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},2}$ 中和 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},2}$ 中的富集 $p$-值。\n\n测试用例3：\n- 全集 $U_3$：[FGF8, HOXD13, IGF1, GREM1, SHH, GLI3, BMP2]。\n- 蝙蝠近端平均值 $\\mu_{\\text{prox},\\text{bat},3}$：[$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$]。\n- 蝙蝠远端平均值 $\\mu_{\\text{dist},\\text{bat},3}$：[$8$, $7$, $6$, $5$, $2.5$, $1.8$, $2.5$]。\n- 小鼠近端平均值 $\\mu_{\\text{prox},\\text{mouse},3}$：[$1$, $0.5$, $1$, $0.5$, $2$, $2$, $3$]。\n- 小鼠远端平均值 $\\mu_{\\text{dist},\\text{mouse},3}$：[$8$, $7$, $6$, $5$, $2.3$, $1.9$, $2.6$]。\n- 排名靠前的选择大小 $k_3 = 4$。\n- 基因集：$G_{\\text{elong},3} = \\{\\text{FGF8}, \\text{HOXD13}, \\text{IGF1}, \\text{GREM1}\\}$， $G_{\\text{comp},3} = \\{\\text{BMP2}, \\text{GLI3}\\}$。\n- 任务：计算 $M_{\\text{cons}}$ 在 $G_{\\text{elong},3}$ 中和 $M_{\\text{div,bat}}$ 在 $G_{\\text{comp},3}$ 中的富集 $p$-值。\n\n步骤2：使用提取的已知信息进行验证\n该问题根据指定标准进行评估：\n- **科学基础和客观性**：该问题是一个简化但标准的生物信息学工作流程。用于差异表达的倍数变化对数（log fold-change）、模块定义以及用于基因集富集的超几何检验等概念是基因组学和分子生物学中基础且广泛使用的。该问题基于客观的定量程序。\n- **良构性**：该问题被构建为一个精确的算法。所有必要的数据、参数和定义都已提供。指令明确，确保可以计算出唯一且稳定的解。边界情况，如除以零（通过伪计数 $\\epsilon$ 处理）和空模块（通过规则 $p=1$ for $n=0$ 处理），都得到了明确处理。\n- **完整性和一致性**：该问题是自包含的。每个测试用例的数据集都是完整的，没有内部矛盾。\n\n步骤3：结论和行动\n该问题科学上合理、定义明确且完整。因此，它是**有效的**。将提供一个解决方案。\n\n通用流程是为每个测试用例执行定义的计算流程。这包括：\n1. 对每个物种（蝙蝠和小鼠），计算给定全集中所有基因的远端偏好 $L_s(g)$。\n2. 筛选出具有正 $L_s(g)$ 的基因，按降序对其进行排序，并选择前 $k$ 个基因以形成物种特异性模块 $M_{\\text{bat}}$ 和 $M_{\\text{mouse}}$。\n3. 分别使用集合交集和差集推导出保守模块 $M_{\\text{cons}}$ 和分化模块 $M_{\\text{div,bat}}$。\n4. 对于每个必需的富集检验，使用单侧超几何检验生存函数计算相应的 $p$-值。\n\n超几何检验的参数是：\n- $N$：全集 $U$ 中的基因总数。\n- $K$：目标基因集 $G$ 中的基因数量（群体中的“成功”案例）。\n- $n$：被测试模块 $M$ 中的基因数量（“抽取”次数）。\n- $x$：模块和基因集交集中的基因数量，$x = |M \\cap G|$（“观察到的成功”案例）。\n\n$p$-值是 $p = \\Pr[X \\ge x]$，计算为随机变量 $X \\sim \\text{Hypergeometric}(N, K, n)$ 的超几何分布的生存函数。这等同于对从 $x$ 到 $\\min(n, K)$ 的所有 $i$ 的概率 $\\Pr[X=i]$ 求和。\n\n现在，我们将此程序应用于每个测试用例。\n\n测试用例1：\n- 全集大小 $N_1 = 12$，选择大小 $k_1 = 5$，伪计数 $\\epsilon = 0.001$。\n- 蝙蝠模块 $M_{\\text{bat},1}$：我们为所有基因计算 $L_{\\text{bat},1}(g)$。具有正偏好的前5个基因是：$\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}, \\text{SHH}\\}$。\n- 小鼠模块 $M_{\\text{mouse},1}$：我们为所有基因计算 $L_{\\text{mouse},1}(g)$。具有正偏好的前5个基因是：$\\{\\text{HOXD13}, \\text{FGF8}, \\text{IGF1}, \\text{SHH}, \\text{GLI3}\\}$。\n- 保守模块 $M_{\\text{cons},1} = M_{\\text{bat},1} \\cap M_{\\text{mouse},1} = \\{\\text{SHH}, \\text{FGF8}, \\text{HOXD13}, \\text{IGF1}\\}$。\n- 分化模块 $M_{\\text{div,bat},1} = M_{\\text{bat},1} \\setminus M_{\\text{mouse},1} = \\{\\text{GREM1}\\}$。\n- $M_{\\text{cons},1}$ 相对于 $G_{\\text{elong},1}$ 的P值：\n  - $N_1 = 12$。 $K_1 = |G_{\\text{elong},1}| = 5$。 $n_1 = |M_{\\text{cons},1}| = 4$。\n  - 重叠 $x_1 = |M_{\\text{cons},1} \\cap G_{\\text{elong},1}| = |\\{\\text{SHH, FGF8, HOXD13, IGF1}\\}| = 4$。\n  - 对于 $X \\sim \\text{Hypergeometric}(12, 5, 4)$，$p_{\\text{cons},1} = \\Pr[X \\ge 4]$。$p = \\frac{\\binom{5}{4}\\binom{7}{0}}{\\binom{12}{4}} = \\frac{5}{495} \\approx 0.010101$。\n- $M_{\\text{div,bat},1}$ 相对于 $G_{\\text{comp},1}$ 的P值：\n  - $N_1 = 12$。 $K_2 = |G_{\\text{comp},1}| = 4$。 $n_2 = |M_{\\text{div,bat},1}| = 1$。\n  - 重叠 $x_2 = |M_{\\text{div,bat},1} \\cap G_{\\text{comp},1}| = |\\{\\text{GREM1}\\} \\cap \\{\\text{SOX9}, \\text{COL2A1}, \\text{RUNX2}, \\text{IHH}\\}| = 0$。\n  - 对于 $X \\sim \\text{Hypergeometric}(12, 4, 1)$，$p_{\\text{div},1} = \\Pr[X \\ge 0]$。此概率必然为 $1$。\n\n测试用例2：\n- 全集大小 $N_2 = 12$，选择大小 $k_2 = 5$，伪计数 $\\epsilon = 0.001$。\n- 蝙蝠模块 $M_{\\text{bat},2}$：具有正偏好的前5个基因是 $\\{\\text{RUNX2}, \\text{IHH}, \\text{COL2A1}, \\text{SOX9}, \\text{BMP2}\\}$。\n- 小鼠模块 $M_{\\text{mouse},2}$：具有正偏好的前5个基因是 $\\{\\text{RUNX2}, \\text{IHH}, \\text{SOX9}, \\text{COL2A1}, \\text{BMP2}\\}$。\n- 保守模块 $M_{\\text{cons},2} = M_{\\text{bat},2} \\cap M_{\\text{mouse},2} = \\{\\text{RUNX2}, \\text{IHH}, \\text{COL2A1}, \\text{SOX9}, \\text{BMP2}\\}$。\n- 分化模块 $M_{\\text{div,bat},2} = M_{\\text{bat},2} \\setminus M_{\\text{mouse},2} = \\emptyset$。\n- $M_{\\text{cons},2}$ 相对于 $G_{\\text{elong},2}$ 的P值：\n  - $N_2 = 12$。 $K_1 = |G_{\\text{elong},2}| = 5$。 $n_1 = |M_{\\text{cons},2}| = 5$。\n  - 重叠 $x_1 = |M_{\\text{cons},2} \\cap G_{\\text{elong},2}| = 0$。\n  - 对于 $X \\sim \\text{Hypergeometric}(12, 5, 5)$，$p_{\\text{cons},2} = \\Pr[X \\ge 0]$。此概率为 $1$。\n- $M_{\\text{div,bat},2}$ 相对于 $G_{\\text{comp},2}$ 的P值：\n  - $n_2 = |M_{\\text{div,bat},2}| = 0$。根据问题定义，如果模块大小为0，则 $p$-值为 $1$。\n\n测试用例3：\n- 全集大小 $N_3 = 7$，选择大小 $k_3 = 4$，伪计数 $\\epsilon = 0.001$。\n- 蝙蝠模块 $M_{\\text{bat},3}$：具有正偏好的前4个基因是 $\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$。\n- 小鼠模块 $M_{\\text{mouse},3}$：具有正偏好的前4个基因是 $\\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$。\n- 保守模块 $M_{\\text{cons},3} = M_{\\text{bat},3} \\cap M_{\\text{mouse},3} = \\{\\text{HOXD13}, \\text{GREM1}, \\text{FGF8}, \\text{IGF1}\\}$。\n- 分化模块 $M_{\\text{div,bat},3} = M_{\\text{bat},3} \\setminus M_{\\text{mouse},3} = \\emptyset$。\n- $M_{\\text{cons},3}$ 相对于 $G_{\\text{elong},3}$ 的P值：\n  - $N_3 = 7$。 $K_1 = |G_{\\text{elong},3}| = 4$。 $n_1 = |M_{\\text{cons},3}| = 4$。\n  - 重叠 $x_1 = |M_{\\text{cons},3} \\cap G_{\\text{elong},3}| = 4$。\n  - 对于 $X \\sim \\text{Hypergeometric}(7, 4, 4)$，$p_{\\text{cons},3} = \\Pr[X \\ge 4]$。$p = \\frac{\\binom{4}{4}\\binom{3}{0}}{\\binom{7}{4}} = \\frac{1}{35} \\approx 0.028571$。\n- $M_{\\text{div,bat},3}$ 相对于 $G_{\\text{comp},3}$ 的P值：\n  - $n_2 = |M_{\\text{div,bat},3}| = 0$。$p$-值为 $1$。\n\n计算结果摘要：\n- 测试用例1：$p_{\\text{cons}} \\approx 0.010101$, $p_{\\text{div,bat}} = 1.000000$。\n- 测试用例2：$p_{\\text{cons}} = 1.000000$, $p_{\\text{div,bat}} = 1.000000$。\n- 测试用例3：$p_{\\text{cons}} \\approx 0.028571$, $p_{\\text{div,bat}} = 1.000000$。\n这些结果将按照最终答案的要求进行格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import hypergeom\n\ndef solve():\n    \"\"\"\n    Solves the bioinformatics problem for a suite of test cases.\n    \"\"\"\n    \n    # Define the fixed parameters for all test cases.\n    epsilon = 1e-3\n\n    test_cases = [\n        {\n            \"U\": ['SHH', 'FGF8', 'BMP2', 'SOX9', 'COL2A1', 'HOXD13', 'IGF1', 'GREM1', 'GLI3', 'RUNX2', 'PTCH1', 'IHH'],\n            \"mu_prox_bat\": np.array([2, 1, 4, 5, 6, 0.5, 1, 0.5, 2, 3, 4, 2]),\n            \"mu_dist_bat\": np.array([12, 10, 3, 4, 5, 8, 7, 6, 3, 2, 4.5, 1.8]),\n            \"mu_prox_mouse\": np.array([2, 1, 4, 5, 6, 0.5, 0.8, 0.5, 1, 3, 4, 2]),\n            \"mu_dist_mouse\": np.array([11, 9, 3, 4, 5, 7, 6, 1.5, 5, 2, 4.3, 1.9]),\n            \"k\": 5,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH'},\n            \"G_comp\": {'SOX9', 'COL2A1', 'RUNX2', 'IHH'}\n        },\n        {\n            \"U\": ['SHH', 'FGF8', 'BMP2', 'SOX9', 'COL2A1', 'HOXD13', 'IGF1', 'GREM1', 'GLI3', 'RUNX2', 'PTCH1', 'IHH'],\n            \"mu_prox_bat\": np.array([4, 3, 3, 2, 2, 2, 3, 2, 2, 1, 3, 1]),\n            \"mu_dist_bat\": np.array([3.5, 2.4, 10, 8, 9, 1.3, 2.5, 1.5, 2.2, 6, 3.3, 5]),\n            \"mu_prox_mouse\": np.array([4, 3, 3, 2, 2, 2, 3, 2, 2, 1, 3, 1]),\n            \"mu_dist_mouse\": np.array([3.5, 2.4, 11, 9, 8.5, 1.3, 2.2, 1.7, 2.2, 6.2, 3.3, 5.3]),\n            \"k\": 5,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH'},\n            \"G_comp\": {'SOX9', 'COL2A1', 'RUNX2', 'IHH'}\n        },\n        {\n            \"U\": ['FGF8', 'HOXD13', 'IGF1', 'GREM1', 'SHH', 'GLI3', 'BMP2'],\n            \"mu_prox_bat\": np.array([1, 0.5, 1, 0.5, 2, 2, 3]),\n            \"mu_dist_bat\": np.array([8, 7, 6, 5, 2.5, 1.8, 2.5]),\n            \"mu_prox_mouse\": np.array([1, 0.5, 1, 0.5, 2, 2, 3]),\n            \"mu_dist_mouse\": np.array([8, 7, 6, 5, 2.3, 1.9, 2.6]),\n            \"k\": 4,\n            \"G_elong\": {'FGF8', 'HOXD13', 'IGF1', 'GREM1'},\n            \"G_comp\": {'BMP2', 'GLI3'}\n        }\n    ]\n\n    all_results = []\n\n    def get_module(U, mu_prox, mu_dist, k, epsilon):\n        \"\"\"\n        Calculates the distal-upregulated module for a single species.\n        \"\"\"\n        log_fc = np.log2((mu_dist + epsilon) / (mu_prox + epsilon))\n        \n        # Filter for positive log fold-changes\n        positive_indices = np.where(log_fc > 0)[0]\n        \n        if len(positive_indices) == 0:\n            return set()\n            \n        # Get LFCs and corresponding gene names for positive ones\n        positive_lfc = log_fc[positive_indices]\n        positive_genes = np.array(U)[positive_indices]\n        \n        # Sort by LFC descending\n        sorted_indices = np.argsort(positive_lfc)[::-1]\n        \n        # Select top k genes\n        top_k = min(k, len(sorted_indices))\n        module_genes = positive_genes[sorted_indices][:top_k]\n        \n        return set(module_genes)\n\n    def calculate_p_value(M_module, G_geneset, U_universe):\n        \"\"\"\n        Calculates the one-sided hypergeometric p-value for enrichment.\n        \"\"\"\n        N = len(U_universe)\n        K = len(G_geneset)\n        n = len(M_module)\n        \n        # Per problem statement, if module size is 0, p-value is 1.\n        if n == 0:\n            return 1.0\n            \n        x = len(M_module.intersection(G_geneset))\n        \n        # Using the survival function (sf), Pr[X >= x] is sf(x-1).\n        # sf(k, M, n, N) -- k=successes, M=pop size, n=type I objects, N=draws\n        # scipy.stats.hypergeom(M, n, N) where M=total, n=successes in pop, N=draws\n        # so M=N, n=K, N=n from problem notation\n        p_val = hypergeom.sf(x - 1, N, K, n)\n        \n        return p_val\n\n    for case in test_cases:\n        U = case[\"U\"]\n        k = case[\"k\"]\n        \n        # Step 1  2: Get species-specific modules\n        M_bat = get_module(U, case[\"mu_prox_bat\"], case[\"mu_dist_bat\"], k, epsilon)\n        M_mouse = get_module(U, case[\"mu_prox_mouse\"], case[\"mu_dist_mouse\"], k, epsilon)\n        \n        # Step 3: Derive conserved and divergent modules\n        M_cons = M_bat.intersection(M_mouse)\n        M_div_bat = M_bat.difference(M_mouse)\n\n        # Step 4: Perform enrichment analysis\n        p_cons = calculate_p_value(M_cons, case[\"G_elong\"], U)\n        p_div_bat = calculate_p_value(M_div_bat, case[\"G_comp\"], U)\n        \n        all_results.append([p_cons, p_div_bat])\n\n    # Final print statement in the exact required format.\n    # e.g., [[p11,p12],[p21,p22],[p31,p32]] with 6 decimal places.\n    formatted_results = [f\"[{p[0]:.6f},{p[1]:.6f}]\" for p in all_results]\n    print(f\"[[{','.join(formatted_results)}]]\")\n\nsolve()\n```", "id": "2569639"}]}