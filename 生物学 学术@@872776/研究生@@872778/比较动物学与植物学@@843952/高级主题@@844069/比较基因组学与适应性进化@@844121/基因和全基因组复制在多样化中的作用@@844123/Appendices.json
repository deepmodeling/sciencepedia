{"hands_on_practices": [{"introduction": "在研究古代全基因组复制 (WGD) 事件时，首要任务之一是确定其发生的时间。分子钟假说为我们提供了强大的理论框架，它假定基因序列在中性位点（如同义替换位点）上以相对恒定的速率积累突变。通过比较旁系同源基因（paralogs）之间的同义替换距离 ($K_s$)，并结合已知的替换速率，我们可以估算出它们的分化时间，即WGD事件的年龄。这项实践将指导你应用这些基本原理，从给定的$K_s$数据中计算WGD事件的年龄 [@problem_id:2577160]，这是任何古多倍体研究的基石。", "problem": "在比较动物学和比较植物学中，全基因组复制（WGD）会在保守的同线性区块中留下重复基因保留的特征信号。考虑一个植物谱系，其中通过一组锚基因对（同线性旁系同源基因）推断出发生了一次WGD。这些基因对的中位同义替换分歧据报道为 $K_s = 1.2$。假设报道的 $K_s$ 是旁系同源序列之间经过Jukes–Cantor（JC）校正的同义距离。设同义替换率为每个谱系每年每个位点 $r = 6 \\times 10^{-9}$ 次替换，并假设在同义位点上存在严格的分子钟。在Jukes–Cantor核苷酸替换模型下，并假设复制事件瞬间产生了两个子拷贝，此后它们以相同的速率独立累积替换，请从第一性原理出发，推导一个以JC校正的同义距离和谱系单位速率表示的复制后时间 $t$ 的表达式。然后使用上述数值计算该表达式。以百万年（Ma）为单位表示最终答案，并将答案四舍五入至四位有效数字。", "solution": "首先必须验证问题陈述的科学合理性、一致性和完整性。\n\n**步骤1：提取已知条件**\n-   主题：植物谱系中的全基因组复制（WGD）。\n-   数据：锚基因对的中位同义替换分歧，$K_s = 1.2$。\n-   模型：分歧 $K_s$ 是经过Jukes–Cantor（JC）校正的同义距离。\n-   常数：同义替换率，每个谱系每年每个位点 $r = 6 \\times 10^{-9}$ 次替换。\n-   假设1：在同义位点上存在严格的分子钟。\n-   假设2：复制事件是瞬时发生的。\n-   假设3：子拷贝以相同的速率 $r$ 独立累积替换。\n-   任务1：从第一性原理出发，推导复制后时间 $t$ 的表达式。\n-   任务2：使用给定值计算该表达式。\n-   输出格式：时间 $t$ 的最终答案必须以百万年（Ma）为单位，并四舍五入至四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n-   **科学依据：** 该问题使用了分子进化和计算生物学中的标准概念：全基因组复制（WGD）、同义替换率（$r$）、同义替换分歧（$K_s$）、Jukes-Cantor（JC）模型和分子钟假说。这些是该领域的基本原理。提供的 $K_s$ 和 $r$ 值对于植物进化是符合实际的。该问题在科学上是合理的。\n-   **适定性：** 问题定义明确。它要求推导一个标准公式并将其应用于一个具体案例。给定的条件和假设足以确定唯一解。\n-   **客观性：** 语言技术性强且精确，没有主观或含糊的陈述。\n-   **完整性和一致性：** 问题是自洽的。提供的信息足够，没有内部矛盾。每个谱系的速率与总分歧率之间的区别是一个关键要素，并且已正确指明。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。这是一个分子系统发育学中的标准、适定的问题。我将进行完整的推导和解答。\n\n该问题要求基于产生的旁系同源基因之间的同义替换分歧（$K_s$）来推导自复制事件以来的时间（$t$）。\n\n让我们从第一性原理开始。复制事件从单个祖先基因创建了两个相同的基因拷贝。设此事件发生在时间 $t=0$。我们关心的是自此事件以来经过的时间 $t$。复制后，这两个拷贝沿着两个独立的谱系独立进化。\n\n替换率以 $r$ 表示，单位为每个谱系每年每个位点的替换次数。这是单个进化谱系中替换累积的速率。\n\n两个旁系同源序列之间的分歧是在*两个*谱系中累积替换的结果。分隔两个现存序列的总进化时间是回到它们的共同祖先（即复制节点）的两个分支长度之和。每个分支的长度为 $t$ 年。因此，两个序列之间的总进化路径长度为 $t + t = 2t$。\n\n根据严格分子钟假说，替换数与时间成正比。两个序列之间的分歧率，我们称之为 $k_{div}$，是它们之间差异累积的速率。由于两个谱系是独立进化的，这个速率是它们各自替换率的总和。\n$$k_{div} = r_{lineage\\,1} + r_{lineage\\,2}$$\n鉴于两个谱系都以相同的速率 $r$ 进化，我们有：\n$$k_{div} = r + r = 2r$$\n\n总同义替换分歧 $K_s$ 代表了自两个序列分歧以来，每个同义位点上发生的预期同义替换数。它是分歧率与所经过时间的乘积。\n$$K_s = k_{div} \\times t$$\n代入 $k_{div}$ 的表达式，我们得到基本关系式：\n$$K_s = (2r)t$$\n\n需要注意的是，问题指明 $K_s$ 是经过Jukes-Cantor校正的距离。这意味着所提供的 $K_s=1.2$ 值已经考虑了随时间在同一位点上发生的多次替换，并直接代表了每个位点的预期替换数。因此，上面推导的线性关系是合适的。如果我们得到的是原始差异位点比例 $p$，我们需要先用Jukes-Cantor公式 $K = -\\frac{3}{4}\\ln(1-\\frac{4}{3}p)$ 来计算 $K_s$，但在这里这没有必要。\n\n从推导出的方程中，我们现在可以解出复制后的时间 $t$：\n$$t = \\frac{K_s}{2r}$$\n这就是从第一性原理推导出的所需 $t$ 的表达式。\n\n现在，我们使用所提供的值来计算这个表达式：\n-   $K_s = 1.2$（无量纲，每个位点的替换数）\n-   $r = 6 \\times 10^{-9}$（每个位点每年的替换数）\n\n将这些值代入 $t$ 的表达式中：\n$$t = \\frac{1.2}{2 \\times (6 \\times 10^{-9} \\text{ year}^{-1})}$$\n$$t = \\frac{1.2}{12 \\times 10^{-9}} \\text{ years}$$\n$$t = \\frac{1.2}{1.2 \\times 10^{-8}} \\text{ years}$$\n$$t = 1 \\times 10^8 \\text{ years}$$\n\n问题要求答案以百万年（Ma）表示，其中 $1 \\text{ Ma} = 10^6$ 年。\n$$t = (1 \\times 10^8) \\text{ years} \\times \\frac{1 \\text{ Ma}}{10^6 \\text{ years}} = 100 \\text{ Ma}$$\n\n最后，答案必须四舍五入到四位有效数字。计算值恰好为 $100$。为了用四位有效数字表示，我们写作 $100.0$。", "answer": "$$\n\\boxed{100.0}\n$$", "id": "2577160"}, {"introduction": "全基因组复制事件虽然为生物体提供了丰富的基因原材料，但并非所有重复的基因都会被保留下来。剂量平衡假说（dosage-balance hypothesis）为解释基因保留模式提供了关键视角，该假说预测，那些编码需要维持精确化学计量比的蛋白质（如转录因子和激酶）的基因在WGD后倾向于被优先保留。这项实践将引导你使用经典的卡方检验（chi-square test），分析一个假设的基因保留数据集，以检验不同功能类别的基因在WGD和零星复制（SSD）后的保留频率是否存在显著差异 [@problem_id:2577002]，从而在实践中验证剂量平衡假说的预测力。", "problem": "剂量平衡假说的一个长期预测是，与小规模复制（SSD）相比，剂量敏感的基因类别，如转录因子和蛋白激酶，在全基因组复制（WGD）后会优先保留下来，因为WGD保留了相互作用伙伴之间的化学计量平衡，而SSD则没有。考虑一个汇集了代表性脊椎动物和被子植物分支的比较数据集，其中保留的重复基因已按复制机制（WGD与SSD）和基因类别（转录因子、激酶、代谢酶）进行了分类。您需要检验，在WGD和SSD之间，保留的重复基因在不同基因类别中的分布是否存在差异，这是否与剂量平衡介导的富集相符。\n\n观测到的保留重复基因计数如下：\n- WGD保留：转录因子 = $240$，激酶 = $200$，代谢酶 = $160$。\n- SSD保留：转录因子 = $30$，激酶 = $40$，代谢酶 = $230$。\n\n在原假设（复制机制和基因类别在保留的重复基因中是独立的）下，对得到的 $2 \\times 3$ 列联结构使用皮尔逊卡方独立性检验，计算卡方检验统计量。假设所有单元格的计数都足够大，可以应用渐近近似，并且不使用连续性校正。\n\n仅报告卡方检验统计量，四舍五入到四位有效数字。不需要单位。", "solution": "该问题陈述具有科学依据，提法明确，并包含进行指定统计检验所需的所有信息。其前提基于演化基因组学中有效的剂量平衡假说，并且所提供的数据构成了一个完整的列联表，适合进行卡方分析。因此，该问题被认为是有效的，并将提供解答。\n\n主要任务是计算皮尔逊卡方检验统计量，记为 $\\chi^2$，用于对给定列联表进行独立性检验。原假设 $H_0$ 指出，保留的重复基因的基因类别与复制机制（全基因组复制WGD与小规模复制SSD）无关。备择假设 $H_A$ 是这两个分类不是独立的。\n\n首先，我们将观测频率 $O_{ij}$ 组织成一个 $2 \\times 3$ 的列联表，其中 $i$ 是行索引（复制机制），$j$ 是列索引（基因类别）。\n\n观测计数表如下：\n$$\n\\begin{array}{c|ccc|c}\n  \\text{转录因子}  \\text{激酶}  \\text{代谢酶}  \\text{行总计} \\\\\n\\hline\n\\text{WGD}  O_{11} = 240  O_{12} = 200  O_{13} = 160  R_1 \\\\\n\\text{SSD}  O_{21} = 30  O_{22} = 40  O_{23} = 230  R_2 \\\\\n\\hline\n\\text{列总计}  C_1  C_2  C_3  N\n\\end{array}\n$$\n\n接下来，我们计算行总计 ($R_i$)、列总计 ($C_j$) 和总计 ($N$)。\n行总计为：\n$$R_1 = 240 + 200 + 160 = 600$$\n$$R_2 = 30 + 40 + 230 = 300$$\n\n列总计为：\n$$C_1 = 240 + 30 = 270$$\n$$C_2 = 200 + 40 = 240$$\n$$C_3 = 160 + 230 = 390$$\n\n总计 $N$ 是所有观测值的总和：\n$$N = R_1 + R_2 = 600 + 300 = 900$$\n作为检验，$N = C_1 + C_2 + C_3 = 270 + 240 + 390 = 900$。总计是一致的。\n\n在独立性原假设下，每个单元格的期望频率 $E_{ij}$ 使用以下公式计算：\n$$E_{ij} = \\frac{R_i \\times C_j}{N}$$\n\n我们计算六个单元格中每一个的期望频率：\n$$E_{11} = \\frac{R_1 \\times C_1}{N} = \\frac{600 \\times 270}{900} = 180$$\n$$E_{12} = \\frac{R_1 \\times C_2}{N} = \\frac{600 \\times 240}{900} = 160$$\n$$E_{13} = \\frac{R_1 \\times C_3}{N} = \\frac{600 \\times 390}{900} = 260$$\n$$E_{21} = \\frac{R_2 \\times C_1}{N} = \\frac{300 \\times 270}{900} = 90$$\n$$E_{22} = \\frac{R_2 \\times C_2}{N} = \\frac{300 \\times 240}{900} = 80$$\n$$E_{23} = \\frac{R_2 \\times C_3}{N} = \\frac{300 \\times 390}{900} = 130$$\n\n皮尔逊卡方检验统计量定义为观测频率与期望频率之差的平方除以期望频率，对所有单元格求和：\n$$\\chi^2 = \\sum_{i=1}^{2} \\sum_{j=1}^{3} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$\n\n现在我们计算每个单元格对 $\\chi^2$ 值的贡献：\n$$\\frac{(O_{11} - E_{11})^2}{E_{11}} = \\frac{(240 - 180)^2}{180} = \\frac{60^2}{180} = \\frac{3600}{180} = 20$$\n$$\\frac{(O_{12} - E_{12})^2}{E_{12}} = \\frac{(200 - 160)^2}{160} = \\frac{40^2}{160} = \\frac{1600}{160} = 10$$\n$$\\frac{(O_{13} - E_{13})^2}{E_{13}} = \\frac{(160 - 260)^2}{260} = \\frac{(-100)^2}{260} = \\frac{10000}{260} = \\frac{1000}{26} = \\frac{500}{13}$$\n$$\\frac{(O_{21} - E_{21})^2}{E_{21}} = \\frac{(30 - 90)^2}{90} = \\frac{(-60)^2}{90} = \\frac{3600}{90} = 40$$\n$$\\frac{(O_{22} - E_{22})^2}{E_{22}} = \\frac{(40 - 80)^2}{80} = \\frac{(-40)^2}{80} = \\frac{1600}{80} = 20$$\n$$\\frac{(O_{23} - E_{23})^2}{E_{23}} = \\frac{(230 - 130)^2}{130} = \\frac{100^2}{130} = \\frac{10000}{130} = \\frac{1000}{13}$$\n\n最后，我们将这些贡献相加，得到总的 $\\chi^2$ 统计量：\n$$\\chi^2 = 20 + 10 + \\frac{500}{13} + 40 + 20 + \\frac{1000}{13}$$\n$$\\chi^2 = 90 + \\frac{1500}{13}$$\n为了合并这些项，我们找到一个公分母：\n$$\\chi^2 = \\frac{90 \\times 13}{13} + \\frac{1500}{13} = \\frac{1170 + 1500}{13} = \\frac{2670}{13}$$\n将精确分数转换为小数值：\n$$\\chi^2 \\approx 205.384615...$$\n问题要求结果四舍五入到四位有效数字。\n$$\\chi^2 \\approx 205.4$$\n如此大的 $\\chi^2$ 统计量值表明，与原假设下的期望频率存在显著差异，这意味着复制机制和基因类别不是独立的。", "answer": "$$\n\\boxed{205.4}\n$$", "id": "2577002"}, {"introduction": "在真实的基因组数据中，来自古代WGD事件的信号常常与持续发生的零星复制（如串联重复）产生的信号相混杂，使得在$K_s$分布图中识别清晰的WGD峰变得困难。为了解决这个问题，研究人员通常采用统计模型来解构这些复杂的分布。这项高级实践将挑战你推导一个双组分混合模型的似然函数，该模型旨在将来自WGD的古老复制基因和近期产生的重复基因从一个混合的$K_s$数据集中区分开来 [@problem_id:2576992]。掌握这种建模方法是开发稳健的生物信息学工具以识别和分析复杂基因组复制历史的核心技能。", "problem": "在被子植物和硬骨鱼类的比较分析中，全基因组复制 (WGD) 事件和谱系特异性的串联重复都被认为促进了物种多样化。考虑一个基因组规模的旁系同源基因对集合，你已经计算了它们的同义替换率 $K_s$（即每个同义位点的同义替换数）。经验上，具有已知古老 WGD 事件的物种，其 $K_s$ 直方图在同线性重复基因对中通常在 $K_s \\approx 0.8$ 附近显示一个主峰，并在 $K_s \\approx 0.1$ 附近显示一个与近期串联重复一致的次峰。\n\n你决定将所有旁系同源基因对的 $K_s$ 边际分布建模为一个双组分混合模型，其中近期串联重复（组分 $R$）和古老 WGD 重复（组分 $A$）各自对 $K_s$ 贡献一个不同的非负右偏分布。受速率和时间异质性的启发，你假设在每个组分 $c \\in \\{R,A\\}$ 内，$K_s$ 服从形状参数为 $\\alpha_c$ 和速率参数为 $\\beta_c$ 的伽马分布（因此均值为 $\\alpha_c/\\beta_c$），并且观测值在给定其潜在组分身份的条件下是条件独立的。令 $\\pi \\in (0,1)$ 表示近期串联重复的混合比例，因此一个随机抽取的重复基因对是近期的概率为 $\\pi$，是古老的概率为 $1-\\pi$。\n\n你从旁系同源基因的混合群体中观测到 $n$ 个独立的 $K_s$ 值 $x_1,\\dots,x_n$。使用上述假设，并从混合模型和统计独立性的定义出发，推导在给定数据 $x_1,\\dots,x_n$ 的情况下，参数 $\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的观测数据似然函数。将你的最终答案表示为一个关于 $x_1,\\dots,x_n$、$\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的单一、闭式解析表达式。不要简化为对数似然函数。不需要进行数值计算或四舍五入。$K_s$ 没有单位，因为它是每个位点的无量纲速率估计值。", "solution": "所述问题需经过验证。\n\n步骤1：提取已知条件。\n- 系统是对被子植物和硬骨鱼类的旁系同源基因对的分析。\n- 数据包含同义替换率值，记为 $K_s$。\n- $K_s$ 的边际分布被建模为双组分混合模型。\n- 组分 $R$ 代表近期串联重复。\n- 组分 $A$ 代表古老的全基因组复制 (WGD) 重复。\n- 组分 $R$ 的混合比例为 $\\pi \\in (0,1)$。组分 $A$ 的比例为 $1-\\pi$。\n- 对于每个组分 $c \\in \\{R,A\\}$，$K_s$ 的分布是形状参数为 $\\alpha_c$、速率参数为 $\\beta_c$ 的伽马分布。\n- 问题指定伽马分布的均值为 $\\alpha_c/\\beta_c$，这与形状-速率参数化一致。\n- 数据包含 $n$ 个独立的 $K_s$ 观测值 $x_1, \\dots, x_n$。\n- 任务是根据给定数据推导参数 $\\pi$、$\\alpha_R$、$\\beta_R$、$\\alpha_A$ 和 $\\beta_A$ 的观测数据似然函数。\n- 最终表达式必须是单一的闭式解析表达式，而不是对数似然函数。\n\n步骤2：使用提取的已知条件进行验证。\n- 问题具有 **科学依据**。使用混合模型，特别是伽马分布，来分析 $K_s$ 分布是演化生物信息学中检测和测定古多倍性事件年代的一种标准且成熟的方法。其前提在事实上是可靠的。\n- 问题是 **适定的**。它要求为一个完全指定的统计模型推导似然函数。这样的函数存在且唯一。\n- 问题是 **客观的**。它使用精确的技术语言，不含主观或基于价值的陈述。\n- 问题设置是 **完整且一致的**。构建似然函数所需的所有要素均已提供。伽马概率密度函数的定义是数学中的一个标准结果，其缺失并不会使问题不完整，因为指令要求从定义出发。\n- 问题 **并非无关紧要或故作高深**。这是数理统计学中的一个标准推导，需要对混合模型和似然理论有清晰的理解。\n\n步骤3：结论与行动。\n问题被判定为 **有效**。将提供解答。\n\n推导从概率论的基本原理出发。设参数向量为 $\\theta = (\\pi, \\alpha_R, \\beta_R, \\alpha_A, \\beta_A)$。该问题描述了一个有限混合模型。对于单个观测值 $x$，其概率密度函数 (PDF) $p(x | \\theta)$ 是各个组分 PDF 的加权和。\n设 $p_R(x | \\alpha_R, \\beta_R)$ 是代表近期重复 ($R$) 组分的 PDF，$p_A(x | \\alpha_A, \\beta_A)$ 是代表古老重复 ($A$) 组分的 PDF。混合比例分别为 $\\pi$ 和 $1-\\pi$。因此，根据全概率定律，混合分布的 PDF 由下式给出：\n$$p(x | \\theta) = \\pi \\cdot p_R(x | \\alpha_R, \\beta_R) + (1-\\pi) \\cdot p_A(x | \\alpha_A, \\beta_A)$$\n问题指出每个组分都服从伽马分布。一个形状参数为 $\\alpha  0$、速率参数为 $\\beta  0$ 的伽马分布随机变量 $X$ 的 PDF 定义为：\n$$f(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)$$\n对于 $x  0$，其中 $\\Gamma(\\alpha) = \\int_0^\\infty t^{\\alpha-1} \\exp(-t) dt$ 是伽马函数。$K_s$ 值的支撑集为非负，与此分布一致。\n\n将此定义应用于我们的两个组分，我们得到：\n对于近期重复（组分 $R$）：\n$$p_R(x | \\alpha_R, \\beta_R) = \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x^{\\alpha_R-1} \\exp(-\\beta_R x)$$\n对于古老重复（组分 $A$）：\n$$p_A(x | \\alpha_A, \\beta_A) = \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x^{\\alpha_A-1} \\exp(-\\beta_A x)$$\n将这些表达式代入单个观测值 $x_i$ 的混合模型 PDF 中，我们得到：\n$$p(x_i | \\theta) = \\pi \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x_i^{\\alpha_R-1} \\exp(-\\beta_R x_i) + (1-\\pi) \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x_i^{\\alpha_A-1} \\exp(-\\beta_A x_i)$$\n问题指出我们有从该混合分布中抽取的 $n$ 个独立观测值 $x_1, \\dots, x_n$。似然函数 $L(\\theta | x_1, \\dots, x_n)$ 定义为观测到给定数据的联合概率密度，并视其为参数 $\\theta$ 的函数。由于独立性假设，该联合密度是各个密度的乘积：\n$$L(\\theta | x_1, \\dots, x_n) = \\prod_{i=1}^{n} p(x_i | \\theta)$$\n通过代入上面推导的 $p(x_i | \\theta)$ 的表达式，我们得到观测数据似然函数的最终表达式。此表达式表示在给定一组特定参数 $\\theta = (\\pi, \\alpha_R, \\beta_R, \\alpha_A, \\beta_A)$ 的情况下，观测到整个数据集 $\\{x_1, ..., x_n\\}$ 的概率。其结果是所要求的闭式解析表达式。", "answer": "$$\\boxed{\\prod_{i=1}^{n} \\left[ \\pi \\frac{\\beta_R^{\\alpha_R}}{\\Gamma(\\alpha_R)} x_i^{\\alpha_R-1} \\exp(-\\beta_R x_i) + (1-\\pi) \\frac{\\beta_A^{\\alpha_A}}{\\Gamma(\\alpha_A)} x_i^{\\alpha_A-1} \\exp(-\\beta_A x_i) \\right]}$$", "id": "2576992"}]}