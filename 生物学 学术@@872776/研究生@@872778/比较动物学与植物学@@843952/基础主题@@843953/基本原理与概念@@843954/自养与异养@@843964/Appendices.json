{"hands_on_practices": [{"introduction": "要真正理解异养生物的代谢，一个有效的方法是从其消耗的底物和产生的气体入手。呼吸商（$RQ$）是一个源于简单气体交换测量的强大工具，它使我们能够推断生物体主要在消耗何种能量来源。这个练习将通过化学计量学的基本原理，带你实践如何从一个动物的呼吸数据中，确定其是以碳水化合物还是脂质作为主要代谢燃料，从而加深对食物元素组成与呼吸宏观信号之间联系的理解。[@problem_id:2548035]", "problem": "在比较动物学和比较植物学中，气体交换比率用于区分自养型和异养型代谢。对于处于静息状态的异养生物，呼吸商（RQ）定义为二氧化碳产生速率与氧气消耗速率之比。即 $ \\mathrm{RQ} = \\dot V_{\\mathrm{CO_2}} / \\dot V_{\\mathrm{O_2}} $，其中 $ \\dot V_{\\mathrm{CO_2}} $ 是二氧化碳产生速率，$ \\dot V_{\\mathrm{O_2}} $ 是氧气消耗速率。相比之下，进行产氧光合作用的自养生物表现出取决于营养物同化作用的光合商，但本题专注于异养呼吸和底物利用。\n\n测量得到一只处于静息状态的恒温动物其稳态呼吸商为 $ 0.700 $。尿氮排泄量低于检测限，因此可以假定在测量时间窗内蛋白质的氧化可忽略不计。假定被氧化的底物仅为葡萄糖（碳水化合物）和棕榈酸（脂质），其化学式分别为 $ \\mathrm{C_6H_{12}O_6} $ 和 $ \\mathrm{C_{16}H_{32}O_2} $。\n\n从元素平衡（碳、氢、氧守恒）和呼吸商的定义出发，首先推导出葡萄糖和棕榈酸的完全氧化平衡反应式，并由此推导出它们各自的RQ值。然后，将观测到的RQ建模为葡萄糖和棕榈酸混合氧化的结果，确定脂质氧化占总耗氧量的比例。\n\n将脂质消耗的氧气分数以 $ 0 $ 到 $ 1 $ 之间的小数形式报告，并将您的答案四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "解析并验证题目陈述。该题目在科学上基于新陈代谢化学计量学，问题提出得当，数据充足，可得唯一解，并以客观、正式的语言表述。不存在事实不健全、含糊不清或矛盾之处。因此，该问题被认定为有效，并将推导求解。\n\n第一步是为两种指定底物——葡萄糖（$\\mathrm{C_6H_{12}O_6}$）和棕榈酸（$\\mathrm{C_{16}H_{32}O_2}$）——建立呼吸商（$\\mathrm{RQ}$）的化学计量基础。$\\mathrm{RQ}$ 定义为产生的二氧化碳与消耗的氧气的摩尔比，即 $\\mathrm{RQ} = \\dot V_{\\mathrm{CO_2}} / \\dot V_{\\mathrm{O_2}}$，在恒温恒压下，这等同于体积比。\n\n对于葡萄糖，完全氧化反应为：\n$$ \\mathrm{C_6H_{12}O_6} + a \\mathrm{O_2} \\rightarrow b \\mathrm{CO_2} + c \\mathrm{H_2O} $$\n为配平此方程式，我们应用元素守恒定律：\n1.  碳（$\\mathrm{C}$）：左侧有 $6$ 个碳原子，所以 $b$ 必须为 $6$。\n2.  氢（$\\mathrm{H}$）：左侧有 $12$ 个氢原子，所以 $2c=12$，得出 $c=6$。\n3.  氧（$\\mathrm{O}$）：左侧有 $6 + 2a$ 个氧原子，右侧有 $6 \\times 2 + 6 \\times 1 = 18$ 个氧原子。令二者相等可得 $6 + 2a = 18$，简化为 $2a=12$，所以 $a=6$。\n葡萄糖氧化的配平反应式为：\n$$ \\mathrm{C_6H_{12}O_6} + 6 \\mathrm{O_2} \\rightarrow 6 \\mathrm{CO_2} + 6 \\mathrm{H_2O} $$\n根据此化学计量关系，葡萄糖的呼吸商（$\\mathrm{RQ}_{\\text{glucose}}$）是产生的 $\\mathrm{CO_2}$ 摩尔数与消耗的 $\\mathrm{O_2}$ 摩尔数之比：\n$$ \\mathrm{RQ}_{\\text{glucose}} = \\frac{6}{6} = 1 $$\n\n接下来，我们对脂质棕榈酸进行相同的分析：\n$$ \\mathrm{C_{16}H_{32}O_2} + a' \\mathrm{O_2} \\rightarrow b' \\mathrm{CO_2} + c' \\mathrm{H_2O} $$\n1.  碳（$\\mathrm{C}$）：左侧有 $16$ 个碳原子，所以 $b'=16$。\n2.  氢（$\\mathrm{H}$）：左侧有 $32$ 个氢原子，所以 $2c'=32$，得出 $c'=16$。\n3.  氧（$\\mathrm{O}$）：左侧有 $2 + 2a'$ 个氧原子，右侧有 $16 \\times 2 + 16 \\times 1 = 32 + 16 = 48$ 个氧原子。令二者相等可得 $2 + 2a' = 48$，简化为 $2a'=46$，所以 $a'=23$。\n棕榈酸氧化的配平反应式为：\n$$ \\mathrm{C_{16}H_{32}O_2} + 23 \\mathrm{O_2} \\rightarrow 16 \\mathrm{CO_2} + 16 \\mathrm{H_2O} $$\n因此，棕榈酸的呼吸商（$\\mathrm{RQ}_{\\text{lipid}}$）为：\n$$ \\mathrm{RQ}_{\\text{lipid}} = \\frac{16}{23} $$\n\n题目指出，动物观测到的呼吸商 $\\mathrm{RQ}_{\\text{obs}} = 0.700$ 是葡萄糖和脂质混合氧化的结果。我们可以将总耗氧量（$\\dot V_{\\mathrm{O_2, total}}$）和总二氧化碳产生量（$\\dot V_{\\mathrm{CO_2, total}}$）表示为各种底物贡献的总和：\n$$ \\dot V_{\\mathrm{O_2, total}} = \\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}} $$\n$$ \\dot V_{\\mathrm{CO_2, total}} = \\dot V_{\\mathrm{CO_2, glucose}} + \\dot V_{\\mathrm{CO_2, lipid}} $$\n观测到的 $\\mathrm{RQ}$ 是这些总量的比值：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\frac{\\dot V_{\\mathrm{CO_2, total}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{CO_2, glucose}} + \\dot V_{\\mathrm{CO_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n利用各组分RQ的定义，我们可以写出 $\\dot V_{\\mathrm{CO_2, glucose}} = \\mathrm{RQ}_{\\text{glucose}} \\cdot \\dot V_{\\mathrm{O_2, glucose}}$ 和 $\\dot V_{\\mathrm{CO_2, lipid}} = \\mathrm{RQ}_{\\text{lipid}} \\cdot \\dot V_{\\mathrm{O_2, lipid}}$。将这些代入 $\\mathrm{RQ}_{\\text{obs}}$ 的方程中得到：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\frac{\\mathrm{RQ}_{\\text{glucose}} \\cdot \\dot V_{\\mathrm{O_2, glucose}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot \\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n题目要求我们求出脂质氧化占总耗氧量的比例。设此比例为 $f_{\\text{lipid}}$：\n$$ f_{\\text{lipid}} = \\frac{\\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{O_2, lipid}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n同样，设 $f_{\\text{glucose}}$ 为葡萄糖的比例：\n$$ f_{\\text{glucose}} = \\frac{\\dot V_{\\mathrm{O_2, glucose}}}{\\dot V_{\\mathrm{O_2, total}}} = \\frac{\\dot V_{\\mathrm{O_2, glucose}}}{\\dot V_{\\mathrm{O_2, glucose}} + \\dot V_{\\mathrm{O_2, lipid}}} $$\n显然，$f_{\\text{glucose}} + f_{\\text{lipid}} = 1$。\n通过将 $\\mathrm{RQ}_{\\text{obs}}$ 表达式的分子和分母同除以 $\\dot V_{\\mathrm{O_2, total}}$，我们得到一个加权平均值：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} \\cdot f_{\\text{glucose}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n代入 $f_{\\text{glucose}} = 1 - f_{\\text{lipid}}$：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} (1 - f_{\\text{lipid}}) + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n现在我们求解 $f_{\\text{lipid}}$：\n$$ \\mathrm{RQ}_{\\text{obs}} = \\mathrm{RQ}_{\\text{glucose}} - \\mathrm{RQ}_{\\text{glucose}} \\cdot f_{\\text{lipid}} + \\mathrm{RQ}_{\\text{lipid}} \\cdot f_{\\text{lipid}} $$\n$$ \\mathrm{RQ}_{\\text{obs}} - \\mathrm{RQ}_{\\text{glucose}} = f_{\\text{lipid}} (\\mathrm{RQ}_{\\text{lipid}} - \\mathrm{RQ}_{\\text{glucose}}) $$\n$$ f_{\\text{lipid}} = \\frac{\\mathrm{RQ}_{\\text{obs}} - \\mathrm{RQ}_{\\text{glucose}}}{\\mathrm{RQ}_{\\text{lipid}} - \\mathrm{RQ}_{\\text{glucose}}} $$\n现在我们将已知值代入这个推导出的公式中：$\\mathrm{RQ}_{\\text{obs}} = 0.700$，$\\mathrm{RQ}_{\\text{glucose}} = 1$，以及 $\\mathrm{RQ}_{\\text{lipid}} = \\frac{16}{23}$。\n$$ f_{\\text{lipid}} = \\frac{0.700 - 1}{\\frac{16}{23} - 1} $$\n$$ f_{\\text{lipid}} = \\frac{-0.300}{\\frac{16 - 23}{23}} = \\frac{-0.300}{\\frac{-7}{23}} $$\n$$ f_{\\text{lipid}} = 0.300 \\times \\frac{23}{7} = \\frac{6.9}{7} $$\n计算得出：\n$$ f_{\\text{lipid}} \\approx 0.98571428... $$\n题目要求答案四舍五入到四位有效数字。\n$$ f_{\\text{lipid}} \\approx 0.9857 $$\n该结果表明，该动物消耗的氧气中约有 $98.57\\%$ 用于脂质氧化，这与观测到的 $0.700$ 的RQ值相符，该值非常接近纯脂质代谢的理论RQ值。", "answer": "$$\n\\boxed{0.9857}\n$$", "id": "2548035"}, {"introduction": "在掌握了宏观的化学计量学之后，我们将深入到自养生物代谢的核心——一个关键的生化途径。光呼吸是$C_3$植物在进行光合作用时面临的一个主要挑战，量化其能量成本对于理解光合效率和植物演化至关重要。本练习将引导你剖析卡尔文循环和光呼吸途径的化学计量关系，从而揭示在有氧环境下固定碳所付出的隐藏代价。[@problem_id:2548096]", "problem": "比较植物-动物生理学的视角强调了产氧光合自养生物必须应对1,5-二磷酸核酮糖羧化酶/加氧酶 (RuBisCO) 的双重反应活性，该酶既催化1,5-二磷酸核酮糖的羧化反应，也催化其加氧反应。这种不可避免的加氧反应会启动光呼吸补救途径，该途径释放二氧化碳并消耗细胞能量，这与无需承担类似的卡尔文-本森循环负担的异养生物形成对比。考虑一个在 $25^{\\circ}\\mathrm{C}$ 和环境 $\\mathrm{O}_2$ 浓度下的典型 $\\mathrm{C}_3$ 叶片。\n\n使用以下经过充分检验的生理学事实作为基本依据：\n- RuBisCO 对 $\\mathrm{CO}_2$ 和 $\\mathrm{O}_2$ 的区分能力可以通过有效特异性因子 $S^{*}$ (无量纲) 来表征，其定义使得 RuBisCO 加氧与羧化速率之比满足\n$$\\frac{v_{o}}{v_{c}}=\\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}},$$\n其中 $O$ 是叶绿体中的 $\\mathrm{O}_2$ 分压，$C_{c}$ 是叶绿体中的 $\\mathrm{CO}_2$ 分压。\n- 在 $25^{\\circ}\\mathrm{C}$ 下，取 $S^{*}=2600$ (无量纲)。假设 $O=21\\,\\mathrm{kPa}$ 且 $C_{c}=28\\,\\mathrm{Pa}$。\n- 卡尔文-本森循环中将一个 $\\mathrm{CO}_2$ 羧化为碳水化合物需要消耗 3 个三磷酸腺苷 (ATP) 和 2 个还原型烟酰胺腺嘌呤二核苷酸磷酸 (NADPH)。\n- 乙醇酸磷酸的光呼吸补救途径将碳返回到卡尔文-本森循环，但是，每发生两次 RuBisCO 加氧事件，就会释放一个 $\\mathrm{CO}_2$ 并消耗 3 个 ATP 和 2 个 NADPH。\n\n仅从这些基本事实和定义出发，完成以下任务：\n1. 推导加氧与羧化反应的速率比 $\\varphi=\\frac{v_{o}}{v_{c}}$。\n2. 根据 RuBisCO 和光呼吸的化学计量关系，推导在存在光呼吸的情况下，每次羧化事件净释放的 $\\mathrm{CO}_2$ 以及净消耗的 ATP 和 NADPH。\n3. 基于以上结果，推导每净同化一个 $\\mathrm{CO}_2$ 所需 ATP 分子数的封闭形式表达式（作为 $\\varphi$ 的函数），然后在给定条件下对其进行数值计算。\n\n将最终答案表示为每净固定一个 $\\mathrm{CO}_2$ 所需的 ATP 分子数。将答案四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n- RuBisCO 加氧速率 ($v_o$) 与羧化速率 ($v_c$) 之比由下式给出：$\\frac{v_{o}}{v_{c}}=\\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}}$。\n- $S^{*}$ 是有效特异性因子。在 $25^{\\circ}\\mathrm{C}$ 下，$S^{*}=2600$。\n- $O$ 是叶绿体中的 $\\mathrm{O}_2$ 分压，给定值为 $O=21\\,\\mathrm{kPa}$。\n- $C_{c}$ 是叶绿体中的 $\\mathrm{CO}_2$ 分压，给定值为 $C_{c}=28\\,\\mathrm{Pa}$。\n- 卡尔文-本森循环的化学计量关系：1 次 $\\mathrm{CO}_2$ 羧化需要 3 个 ATP 和 2 个 NADPH。\n- 光呼吸的化学计量关系：每 2 次加氧事件，释放 1 个 $\\mathrm{CO}_2$，消耗 3 个 ATP 和 2 个 NADPH。\n- 加氧与羧化之比记为 $\\varphi = \\frac{v_o}{v_c}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于公认的光合作用 Farquhar-von Caemmerer-Berry 模型，这是植物生态生理学的基石。RuBisCO 的双重功能、光呼吸、卡尔文-本森循环以及能量成本等概念在事实上和科学上都是合理的。\n- **适定性**：该问题结构为一系列推导。它提供了所有必要的常数和化学计量关系。给定的压力单位（$O$ 以 $\\mathrm{kPa}$ 为单位，$C_c$ 以 $\\mathrm{Pa}$ 为单位）不一致，但很容易转换（$1\\,\\mathrm{kPa} = 1000\\,\\mathrm{Pa}$），这是一个简单的步骤，不会使问题无效，而是对基本物理单位一致性的一种考验。假设意图是进行这种转换，那么该问题是适定的。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n**结论：** 问题被判定为有效。将提供解答。\n\n解答将按顺序处理三个指定的任务。\n\n**1. 推导加氧与羧化速率之比 $\\varphi$**\n\n比率 $\\varphi$ 定义为 $\\frac{v_{o}}{v_{c}}$。控制方程如下：\n$$ \\varphi = \\frac{v_{o}}{v_{c}} = \\frac{O}{C_{c}}\\cdot\\frac{1}{S^{*}} $$\n分压必须使用一致的单位。我们将 $O$ 从千帕 (kPa) 转换为帕斯卡 (Pa)。\n已知 $O = 21\\,\\mathrm{kPa}$ 且 $C_{c} = 28\\,\\mathrm{Pa}$。\n$$ O = 21\\,\\mathrm{kPa} \\times \\frac{1000\\,\\mathrm{Pa}}{1\\,\\mathrm{kPa}} = 21000\\,\\mathrm{Pa} $$\n特异性因子给定为 $S^{*} = 2600$。\n将这些值代入 $\\varphi$ 的方程中：\n$$ \\varphi = \\frac{21000\\,\\mathrm{Pa}}{28\\,\\mathrm{Pa}} \\cdot \\frac{1}{2600} = 750 \\cdot \\frac{1}{2600} = \\frac{750}{2600} = \\frac{75}{260} $$\n通过将分子和分母除以它们的最大公约数 5 来简化分数：\n$$ \\varphi = \\frac{15}{52} $$\n\n**2. 推导每次羧化事件的净通量**\n\n我们将所有通量归一化到单次羧化事件。当一摩尔底物被 RuBisCO 羧化时，有 $\\varphi$ 摩尔被加氧。\n\n- **净 $\\mathrm{CO}_2$ 通量：**\n羧化反应消耗 1 摩尔 $\\mathrm{CO}_2$。加氧反应启动光呼吸，每 2 次加氧事件释放 1 摩尔 $\\mathrm{CO}_2$。因此，一次加氧事件导致释放 $\\frac{1}{2}$ 摩尔的 $\\mathrm{CO}_2$。\n对于 $\\varphi$ 次加氧事件，释放的 $\\mathrm{CO}_2$ 总量为 $\\frac{1}{2}\\varphi$。\n问题要求的是每次羧化事件*净释放的 $\\mathrm{CO}_2$*。这是释放总量减去消耗总量。\n每次 $v_c$ 净释放的 $\\mathrm{CO}_2 = (\\text{光呼吸释放的二氧化碳}) - (\\text{羧化消耗的二氧化碳}) = \\frac{\\varphi}{2} - 1$。\n\n- **净 ATP 消耗：**\n羧化反应消耗 3 摩尔 ATP。光呼吸每 2 次加氧事件消耗 3 摩尔 ATP，即每次加氧的成本为 $\\frac{3}{2}$ ATP。\n对于 $\\varphi$ 次加氧事件，ATP 成本为 $\\frac{3}{2}\\varphi$。\n每次 $v_c$ 消耗的总 ATP = $(\\text{羧化作用的ATP}) + (\\text{光呼吸作用的ATP}) = 3 + \\frac{3}{2}\\varphi = 3\\left(1 + \\frac{\\varphi}{2}\\right)$。\n\n- **净 NADPH 消耗：**\n羧化反应消耗 2 摩尔 NADPH。光呼吸每 2 次加氧事件消耗 2 摩尔 NADPH，即每次加氧的成本为 1 NADPH。\n对于 $\\varphi$ 次加氧事件，NADPH 成本为 $\\varphi$。\n每次 $v_c$ 消耗的总 NADPH = $(\\text{羧化作用的NADPH}) + (\\text{光呼吸作用的NADPH}) = 2 + \\varphi$。\n\n**3. 推导每净同化一个 $\\mathrm{CO}_2$ 的 ATP 成本**\n\n所求数量为消耗的总 ATP 除以净同化的 $\\mathrm{CO}_2$。令其为 $\\Gamma_{ATP}$。\n$$ \\Gamma_{ATP} = \\frac{\\text{每次 } v_c \\text{ 消耗的总 ATP}}{\\text{每次 } v_c \\text{ 净同化的 } \\mathrm{CO}_2} $$\n净同化的 $\\mathrm{CO}_2$ 是净释放的 $\\mathrm{CO}_2$ 的负值。根据第 2 部分：\n每次 $v_c$ 净同化的 $\\mathrm{CO}_2 = -(\\frac{\\varphi}{2} - 1) = 1 - \\frac{\\varphi}{2}$。\n每次 $v_c$ 消耗的总 ATP 已求得为 $3\\left(1 + \\frac{\\varphi}{2}\\right)$。\n\n因此，$\\Gamma_{ATP}$ 作为 $\\varphi$ 的函数的封闭形式表达式为：\n$$ \\Gamma_{ATP}(\\varphi) = \\frac{3\\left(1 + \\frac{\\varphi}{2}\\right)}{1 - \\frac{\\varphi}{2}} $$\n该表达式可以通过分子和分母同乘以 2 来简化：\n$$ \\Gamma_{ATP}(\\varphi) = \\frac{3(2 + \\varphi)}{2 - \\varphi} $$\n现在，我们使用第 1 部分推导出的值 $\\varphi = \\frac{15}{52}$ 对该表达式进行数值计算。\n$$ \\Gamma_{ATP} = \\frac{3\\left(2 + \\frac{15}{52}\\right)}{2 - \\frac{15}{52}} $$\n首先，计算括号中的项：\n$$ 2 + \\frac{15}{52} = \\frac{104}{52} + \\frac{15}{52} = \\frac{119}{52} $$\n$$ 2 - \\frac{15}{52} = \\frac{104}{52} - \\frac{15}{52} = \\frac{89}{52} $$\n将这些结果代回 $\\Gamma_{ATP}$ 的表达式中：\n$$ \\Gamma_{ATP} = \\frac{3\\left(\\frac{119}{52}\\right)}{\\frac{89}{52}} = 3 \\times \\frac{119}{89} = \\frac{357}{89} $$\n为了得到最终的数值答案，我们进行除法运算，并按要求四舍五入到四位有效数字。\n$$ \\Gamma_{ATP} = \\frac{357}{89} \\approx 4.011235955... $$\n四舍五入到四位有效数字得到 $4.011$。这是在给定条件下，每净同化一个 $\\mathrm{CO}_2$ 分子所需的 ATP 分子数。", "answer": "$$ \\boxed{4.011} $$", "id": "2548096"}, {"introduction": "最后，我们将视角从单个代谢途径提升到整个系统的层面。流平衡分析（FBA）是一种强大的计算框架，可以用它来预测基于基因组尺度重建的代谢网络的能力。这项实践提供了一个简化的FBA入门，演示了如何运用线性规划来比较自养和异养策略在不同资源限制下的生长潜力，让你体验系统生物学方法如何阐明复杂的代谢问题。[@problem_id:2548056]", "problem": "要求您通过线性规划，形式化并求解两个简化的通量平衡分析模型。这两个模型在一个相同的最小培养基上比较自养生长和异养生长，旨在分离碳源和能源的作用。目的是计算生长速率的差异，并识别限制生长的约束性限制。\n\n使用的基本原理：\n- 通量平衡分析 (FBA) 的核心定义：在稳态下，细胞内代谢物的平衡由线性系统 $S \\, \\mathbf{v} = \\mathbf{0}$ 表示，其中 $S$ 是化学计量矩阵，$\\mathbf{v}$ 是反应通量向量，所有通量都满足边界约束。生长通过一个生物质生成反应来建模，该反应的通量在这些约束条件下被最大化。\n- 关于自养与异养的公认事实：自养生物同化无机碳（此处为二氧化碳），而异养生物同化有机碳（此处为乙酸盐）。三磷酸腺苷 (ATP) 是生物合成所必需的。在这个简化的设定中，自养生物从光中获取 ATP，而异养生物通过用分子氧氧化乙酸盐来制造 ATP。\n\n您必须用以下的化学计量矩阵和边界来实现两个模型。除非另有说明，所有通量都被约束为非负值 ($0 \\le v_i \\le \\text{upper bound}_i$)。每个模型的目标都是最大化生物质通量。\n\n模型 A（自养：碳来自二氧化碳，能量来自光）：\n- 代谢物（$S_{\\text{auto}}$ 的行）：$[\\text{CO}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP}]$。\n- 反应（$S_{\\text{auto}}$ 的列）及其化学计量：\n  1. $\\text{CO}_2$ 摄取：$\\varnothing \\to \\text{CO}_2$，通量为 $v_1$，上界为 $U_{\\text{CO2}}$。\n  2. $\\text{NH}_4^+$ 摄取：$\\varnothing \\to \\text{NH}_4^+$，通量为 $v_2$，上界为 $U_{\\text{NH4}}$。\n  3. $\\text{PO}_4^{3-}$ 摄取：$\\varnothing \\to \\text{PO}_4^{3-}$，通量为 $v_3$，上界为 $U_{\\text{PO4}}$。\n  4. 光到 ATP：$\\text{light} \\to \\text{ATP}$，通量为 $v_4$，上界为 $U_{\\text{light}}$。\n  5. 生物质形成（自养）：$\\text{CO}_2 + 0.2\\,\\text{NH}_4^+ + 0.1\\,\\text{PO}_4^{3-} + 10\\,\\text{ATP} \\to \\text{biomass}$，通量为 $v_5$，无有限上界。\n- 矩阵形式，行序为 $[\\text{CO}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP}]$，列序为 $[v_1,\\ v_2,\\ v_3,\\ v_4,\\ v_5]$：\n$$\nS_{\\text{auto}}=\n\\begin{bmatrix}\n1  0  0  0  -1 \\\\\n0  1  0  0  -0.2 \\\\\n0  0  1  0  -0.1 \\\\\n0  0  0  1  -10\n\\end{bmatrix}.\n$$\n- 目标：在 $S_{\\text{auto}} \\mathbf{v} = \\mathbf{0}$ 和 $0 \\le v_1 \\le U_{\\text{CO2}}$, $0 \\le v_2 \\le U_{\\text{NH4}}$, $0 \\le v_3 \\le U_{\\text{PO4}}$, $0 \\le v_4 \\le U_{\\text{light}}$, $v_5 \\ge 0$ 的约束下最大化 $v_5$。\n\n模型 B（异养：碳和能量来自乙酸盐，用氧气进行呼吸）：\n- 代谢物（$S_{\\text{het}}$ 的行）：$[\\text{Ac},\\ \\text{O}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP},\\ \\text{CO}_2]$。\n- 反应（$S_{\\text{het}}$ 的列）及其化学计量：\n  1. 乙酸盐摄取：$\\varnothing \\to \\text{Ac}$，通量为 $w_1$，上界为 $U_{\\text{Ac}}$。\n  2. 氧气摄取：$\\varnothing \\to \\text{O}_2$，通量为 $w_2$，上界为 $U_{\\text{O2}}$。\n  3. $\\text{NH}_4^+$ 摄取：$\\varnothing \\to \\text{NH}_4^+$，通量为 $w_3$，上界为 $U_{\\text{NH4}}$。\n  4. $\\text{PO}_4^{3-}$ 摄取：$\\varnothing \\to \\text{PO}_4^{3-}$，通量为 $w_4$，上界为 $U_{\\text{PO4}}$。\n  5. 乙酸盐氧化生成 ATP：$\\text{Ac} + 2\\,\\text{O}_2 \\to 10\\,\\text{ATP} + 2\\,\\text{CO}_2$，通量为 $w_5$，无有限上界。\n  6. $\\text{CO}_2$ 输出：$\\text{CO}_2 \\to \\varnothing$，通量为 $w_6$，无有限上界。\n  7. 生物质形成（异养）：$0.5\\,\\text{Ac} + 0.2\\,\\text{NH}_4^+ + 0.1\\,\\text{PO}_4^{3-} + 10\\,\\text{ATP} \\to \\text{biomass}$，通量为 $w_7$，无有限上界。\n- 矩阵形式，行序为 $[\\text{Ac},\\ \\text{O}_2,\\ \\text{NH}_4^+,\\ \\text{PO}_4^{3-},\\ \\text{ATP},\\ \\text{CO}_2]$，列序为 $[w_1,\\ w_2,\\ w_3,\\ w_4,\\ w_5,\\ w_6,\\ w_7]$：\n$$\nS_{\\text{het}}=\n\\begin{bmatrix}\n1  0  0  0  -1  0  -0.5 \\\\\n0  1  0  0  -2  0  0 \\\\\n0  0  1  0  0  0  -0.2 \\\\\n0  0  0  1  0  0  -0.1 \\\\\n0  0  0  0  10  0  -10 \\\\\n0  0  0  0  2  -1  0\n\\end{bmatrix}.\n$$\n- 目标：在 $S_{\\text{het}} \\mathbf{w} = \\mathbf{0}$ 和 $0 \\le w_1 \\le U_{\\text{Ac}}$, $0 \\le w_2 \\le U_{\\text{O2}}$, $0 \\le w_3 \\le U_{\\text{NH4}}$, $0 \\le w_4 \\le U_{\\text{PO4}}$, $w_5, w_6, w_7 \\ge 0$ (无有限上界) 的约束下最大化 $w_7$。\n\n需要在您的程序中完成的任务：\n1. 对于下面的每个测试用例参数集，求解两个线性规划问题，以获得最优生物质通量 $v_5^\\star$（自养）和 $w_7^\\star$（异养）。\n2. 对于每个模型，通过检查在最优解时哪个资源摄取（或光）边界是紧的，从以下各项中确定一个限制性约束：\n   - 自养生物限制性代码：\n     - $1$：$\\text{CO}_2$ 摄取边界 $U_{\\text{CO2}}$ 起约束作用。\n     - $2$：光到 ATP 边界 $U_{\\text{light}}$ 起约束作用。\n     - $3$：$\\text{NH}_4^+$ 摄取边界 $U_{\\text{NH4}}$ 起约束作用。\n     - $4$：$\\text{PO}_4^{3-}$ 摄取边界 $U_{\\text{PO4}}$ 起约束作用。\n   - 异养生物限制性代码：\n     - $1$：乙酸盐摄取边界 $U_{\\text{Ac}}$ 起约束作用。\n     - $2$：氧气摄取边界 $U_{\\text{O2}}$ 起约束作用。\n     - $3$：$\\text{NH}_4^+$ 摄取边界 $U_{\\text{NH4}}$ 起约束作用。\n     - $4$：$\\text{PO}_4^{3-}$ 摄取边界 $U_{\\text{PO4}}$ 起约束作用。\n   如果多个边界同时是紧的，请按上述顺序选择最小的代码。如果在数值容差 $10^{-9}$ 内没有边界是紧的，则在该测试用例中为该模型返回代码 $0$。\n\n3. 构建最终输出为单行：一个顶级列表，每个测试用例包含一个子列表。每个子列表必须严格按照 $[v_5^\\star,\\ w_7^\\star,\\ \\text{auto\\_code},\\ \\text{hetero\\_code}]$ 的顺序包含四个条目。请用标准十进制表示法表示数字。\n\n单位：将所有通量视为任意一致的单位每单位时间；您必须将生长通量输出为无单位的数值浮点数（无单位字符串）。\n\n测试用例集（每个元组为 $(U_{\\text{CO2}},\\ U_{\\text{Ac}},\\ U_{\\text{O2}},\\ U_{\\text{NH4}},\\ U_{\\text{PO4}},\\ U_{\\text{light}})$）：\n- 情况 1：$(10,\\ 5,\\ 20,\\ 10,\\ 10,\\ 100)$。\n- 情况 2：$(10,\\ 5,\\ 20,\\ 10,\\ 10,\\ 5)$。\n- 情况 3：$(10,\\ 0.5,\\ 20,\\ 10,\\ 10,\\ 100)$。\n- 情况 4：$(100,\\ 100,\\ 100,\\ 0.1,\\ 100,\\ 1000)$。\n- 情况 5：$(0.2,\\ 10,\\ 1,\\ 10,\\ 10,\\ 1000)$。\n\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的子列表列表，不含空格，例如：\n\"[[g_auto1,g_hetero1,lim_auto_code1,lim_hetero_code1],[g_auto2,g_hetero2,lim_auto_code2,lim_hetero_code2],...]\"", "solution": "该问题陈述已经过严格验证，并被认为是有效的。它在科学上是合理的、良构的且客观的。它呈现了一个标准的、尽管是简化的通量平衡分析（FBA）练习，被表述为两个可解的线性规划问题。我们将继续提供完整的解决方案。\n\n任务是确定两种代谢模型（一个自养模型和一个异养模型）在各种营养和能量限制下的最大生长通量。这需要为每组给定的参数求解两个线性规划（LP）问题。\n\n在稳态下，细胞内代谢物的浓度是恒定的。此条件由线性系统 $S \\mathbf{v} = \\mathbf{0}$ 表示，其中 $S$ 是包含 $m$ 个代谢物和 $n$ 个反应的 $m \\times n$ 化学计量矩阵，$\\mathbf{v}$ 是 $n \\times 1$ 的反应通量向量。目标是在此稳态约束以及每个通量的上下界 $v_i^{\\text{min}} \\le v_i \\le v_i^{\\text{max}}$ 的条件下，最大化特定通量（通常是生物质形成）。\n\n**模型 A：自养生物**\n\n自养生物的 FBA 问题是在 $S_{\\text{auto}}\\mathbf{v} = \\mathbf{0}$ 和给定通量边界的约束下最大化 $v_5$。化学计量矩阵为：\n$$\nS_{\\text{auto}}=\n\\begin{bmatrix}\n1  0  0  0  -1 \\\\\n0  1  0  0  -0.2 \\\\\n0  0  1  0  -0.1 \\\\\n0  0  0  1  -10\n\\end{bmatrix}\n$$\n稳态条件 $S_{\\text{auto}}\\mathbf{v} = \\mathbf{0}$ 转化为以下线性方程组，其中 $\\mathbf{v} = [v_1, v_2, v_3, v_4, v_5]^T$:\n1. $v_1 - v_5 = 0 \\implies v_1 = v_5$\n2. $v_2 - 0.2 v_5 = 0 \\implies v_2 = 0.2 v_5$\n3. $v_3 - 0.1 v_5 = 0 \\implies v_3 = 0.1 v_5$\n4. $v_4 - 10 v_5 = 0 \\implies v_4 = 10 v_5$\n\n所有通量都与生物质通量 $v_5$ 成正比。为了最大化 $v_5$，我们必须考虑摄取通量 $v_1, v_2, v_3, v_4$ 的上界：\n- $v_1 \\le U_{\\text{CO2}} \\implies v_5 \\le U_{\\text{CO2}}$\n- $v_2 \\le U_{\\text{NH4}} \\implies 0.2 v_5 \\le U_{\\text{NH4}} \\implies v_5 \\le 5 U_{\\text{NH4}}$\n- $v_3 \\le U_{\\text{PO4}} \\implies 0.1 v_5 \\le U_{\\text{PO4}} \\implies v_5 \\le 10 U_{\\text{PO4}}$\n- $v_4 \\le U_{\\text{light}} \\implies 10 v_5 \\le U_{\\text{light}} \\implies v_5 \\le \\frac{U_{\\text{light}}}{10}$\n\n由于所有这些条件都必须满足，最大生物质通量 $v_5^\\star$ 是这些导出上界的最小值：\n$$\nv_5^\\star = \\min\\left( U_{\\text{CO2}}, 5 U_{\\text{NH4}}, 10 U_{\\text{PO4}}, \\frac{U_{\\text{light}}}{10} \\right)\n$$\n\n**模型 B：异养生物**\n\n异养生物的 FBA 问题是在 $S_{\\text{het}}\\mathbf{w} = \\mathbf{0}$ 和通量边界的约束下最大化 $w_7$。化学计量矩阵为：\n$$\nS_{\\text{het}}=\n\\begin{bmatrix}\n1  0  0  0  -1  0  -0.5 \\\\\n0  1  0  0  -2  0  0 \\\\\n0  0  1  0  0  0  -0.2 \\\\\n0  0  0  1  0  0  -0.1 \\\\\n0  0  0  0  10  0  -10 \\\\\n0  0  0  0  2  -1  0\n\\end{bmatrix}\n$$\n对于 $\\mathbf{w} = [w_1, w_2, w_3, w_4, w_5, w_6, w_7]^T$，稳态条件 $S_{\\text{het}}\\mathbf{w} = \\mathbf{0}$ 产生：\n1. $w_1 - w_5 - 0.5 w_7 = 0$\n2. $w_2 - 2 w_5 = 0 \\implies w_2 = 2 w_5$\n3. $w_3 - 0.2 w_7 = 0 \\implies w_3 = 0.2 w_7$\n4. $w_4 - 0.1 w_7 = 0 \\implies w_4 = 0.1 w_7$\n5. $10 w_5 - 10 w_7 = 0 \\implies w_5 = w_7$\n6. $2 w_5 - w_6 = 0 \\implies w_6 = 2 w_5$\n\n从 ATP 平衡（方程 5），ATP 生成通量 ($w_5$) 等于生物质合成通量 ($w_7$)。将 $w_5 = w_7$ 代入其他方程，我们用 $w_7$ 表示所有其他通量：\n- $w_1 = w_7 + 0.5 w_7 = 1.5 w_7$\n- $w_2 = 2 w_7$\n- $w_3 = 0.2 w_7$\n- $w_4 = 0.1 w_7$\n- $w_6 = 2 w_7$\n\n使用摄取通量 $w_1, w_2, w_3, w_4$ 的上界：\n- $w_1 \\le U_{\\text{Ac}} \\implies 1.5 w_7 \\le U_{\\text{Ac}} \\implies w_7 \\le \\frac{U_{\\text{Ac}}}{1.5}$\n- $w_2 \\le U_{\\text{O2}} \\implies 2 w_7 \\le U_{\\text{O2}} \\implies w_7 \\le \\frac{U_{\\text{O2}}}{2}$\n- $w_3 \\le U_{\\text{NH4}} \\implies 0.2 w_7 \\le U_{\\text{NH4}} \\implies w_7 \\le 5 U_{\\text{NH4}}$\n- $w_4 \\le U_{\\text{PO4}} \\implies 0.1 w_7 \\le U_{\\text{PO4}} \\implies w_7 \\le 10 U_{\\text{PO4}}$\n\n因此，最大生物质通量 $w_7^\\star$ 是：\n$$\nw_7^\\star = \\min\\left( \\frac{U_{\\text{Ac}}}{1.5}, \\frac{U_{\\text{O2}}}{2}, 5 U_{\\text{NH4}}, 10 U_{\\text{PO4}} \\right)\n$$\n\n**计算实现**\n\n虽然这些简单的模型允许解析解，但我们将按照要求使用数值 LP 求解器来实现解决方案，这是一种适用于更复杂 FBA 模型的通用方法。我们使用 `scipy.optimize.linprog`。对于每个模型，问题都转换为标准的 LP 形式：最小化 $\\mathbf{c}^T \\mathbf{x}$，约束条件为 $A_{eq} \\mathbf{x} = \\mathbf{b}_{eq}$ 和 $\\mathbf{x}_{\\text{min}} \\le \\mathbf{x} \\le \\mathbf{x}_{\\text{max}}$。\n\n对于自养生物，我们最小化 $-v_5$，所以目标向量是 $\\mathbf{c} = [0, 0, 0, 0, -1]^T$。等式约束由 $A_{eq} = S_{\\text{auto}}$ 和 $\\mathbf{b}_{eq} = \\mathbf{0}$ 给出。边界为 $[(0, U_{\\text{CO2}}), (0, U_{\\text{NH4}}), (0, U_{\\text{PO4}}), (0, U_{\\text{light}}), (0, \\infty)]$。\n\n对于异养生物，我们最小化 $-w_7$，所以 $\\mathbf{c} = [0, 0, 0, 0, 0, 0, -1]^T$。等式约束是 $A_{eq} = S_{\\text{het}}$ 和 $\\mathbf{b}_{eq} = \\mathbf{0}$。边界为 $[(0, U_{\\text{Ac}}), (0, U_{\\text{O2}}), (0, U_{\\text{NH4}}), (0, U_{\\text{PO4}}), (0, \\infty), (0, \\infty), (0, \\infty)]$。\n\n为每个模型求解最优通量向量后，我们确定限制性约束。如果相应的摄取通量与其上界的差值在 $10^{-9}$ 的容差范围内，则认为该约束是紧的。如果多个约束是紧的，则报告指定代码最小的那个。\n- 自养生物摄取通量：$v_1$ (CO2), $v_4$ (light), $v_2$ (NH4), $v_3$ (PO4)。它们的代号分别为 $1, 2, 3, 4$。\n- 异养生物摄取通量：$w_1$ (Ac), $w_2$ (O2), $w_3$ (NH4), $w_4$ (PO4)。它们的代号分别为 $1, 2, 3, 4$。\n\n程序将遍历每个测试用例，解决两个 LP 问题，确定限制性约束，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Formalizes and solves two simplified flux balance analysis models\n    for autotrophic and heterotrophic growth, calculating maximal growth rates\n    and identifying limiting constraints for a suite of test cases.\n    \"\"\"\n    \n    # Stoichiometric matrices and other fixed model parameters\n    S_auto = np.array([\n        [1, 0, 0, 0, -1],\n        [0, 1, 0, 0, -0.2],\n        [0, 0, 1, 0, -0.1],\n        [0, 0, 0, 1, -10]\n    ])\n\n    S_het = np.array([\n        [1, 0, 0, 0, -1, 0, -0.5],\n        [0, 1, 0, 0, -2, 0, 0],\n        [0, 0, 1, 0, 0, 0, -0.2],\n        [0, 0, 0, 1, 0, 0, -0.1],\n        [0, 0, 0, 0, 10, 0, -10],\n        [0, 0, 0, 0, 2, -1, 0]\n    ])\n\n    c_auto = np.array([0, 0, 0, 0, -1])\n    b_eq_auto = np.zeros(S_auto.shape[0])\n\n    c_het = np.array([0, 0, 0, 0, 0, 0, -1])\n    b_eq_het = np.zeros(S_het.shape[0])\n\n    # Numerical tolerance for checking if a constraint is binding\n    TOL = 1e-9\n\n    def solve_autotroph(U_co2, U_nh4, U_po4, U_light):\n        bounds = [\n            (0, U_co2),\n            (0, U_nh4),\n            (0, U_po4),\n            (0, U_light),\n            (0, None)\n        ]\n        \n        res = linprog(c=c_auto, A_eq=S_auto, b_eq=b_eq_auto, bounds=bounds, method='highs')\n        \n        if not res.success:\n            return 0.0, 0\n        \n        v_star = res.x\n        v5_star = v_star[4]\n        \n        # Identify limiting constraint\n        binding_codes = []\n        # Order of checks matters for tie-breaking\n        if abs(v_star[0] - U_co2) = TOL:\n            binding_codes.append(1)\n        if abs(v_star[3] - U_light) = TOL:\n            binding_codes.append(2)\n        if abs(v_star[1] - U_nh4) = TOL:\n            binding_codes.append(3)\n        if abs(v_star[2] - U_po4) = TOL:\n            binding_codes.append(4)\n            \n        auto_code = min(binding_codes) if binding_codes else 0\n        \n        return v5_star, auto_code\n\n    def solve_heterotroph(U_ac, U_o2, U_nh4, U_po4):\n        bounds = [\n            (0, U_ac),\n            (0, U_o2),\n            (0, U_nh4),\n            (0, U_po4),\n            (0, None),\n            (0, None),\n            (0, None)\n        ]\n        \n        res = linprog(c=c_het, A_eq=S_het, b_eq=b_eq_het, bounds=bounds, method='highs')\n        \n        if not res.success:\n            return 0.0, 0\n            \n        w_star = res.x\n        w7_star = w_star[6]\n        \n        # Identify limiting constraint\n        binding_codes = []\n        # Order of checks matters for tie-breaking\n        if abs(w_star[0] - U_ac) = TOL:\n            binding_codes.append(1)\n        if abs(w_star[1] - U_o2) = TOL:\n            binding_codes.append(2)\n        if abs(w_star[2] - U_nh4) = TOL:\n            binding_codes.append(3)\n        if abs(w_star[3] - U_po4) = TOL:\n            binding_codes.append(4)\n            \n        hetero_code = min(binding_codes) if binding_codes else 0\n        \n        return w7_star, hetero_code\n\n    test_cases = [\n        # (U_CO2, U_Ac, U_O2, U_NH4, U_PO4, U_light)\n        (10, 5, 20, 10, 10, 100),\n        (10, 5, 20, 10, 10, 5),\n        (10, 0.5, 20, 10, 10, 100),\n        (100, 100, 100, 0.1, 100, 1000),\n        (0.2, 10, 1, 10, 10, 1000)\n    ]\n\n    results = []\n    for case in test_cases:\n        U_co2, U_ac, U_o2, U_nh4, U_po4, U_light = case\n        \n        v5_star, auto_code = solve_autotroph(U_co2, U_nh4, U_po4, U_light)\n        w7_star, hetero_code = solve_heterotroph(U_ac, U_o2, U_nh4, U_po4)\n        \n        results.append(f\"[{v5_star},{w7_star},{auto_code},{hetero_code}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2548056"}]}