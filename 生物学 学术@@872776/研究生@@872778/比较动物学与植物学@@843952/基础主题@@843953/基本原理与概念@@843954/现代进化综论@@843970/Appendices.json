{"hands_on_practices": [{"introduction": "哈代-温伯格平衡原理是演化生物学的基石，它为没有演化力量作用下的种群提供了一个数学零假设。通过将观察到的基因型频率与哈代-温伯格预期进行比较，我们可以识别并量化非随机交配或选择等过程的影响。本练习 ([@problem_id:2618070]) 旨在通过计算近交系数 $F_{IS}$，实践如何从杂合子缺失的数据中诊断种群内部的交配模式，这是种群遗传学中的一项核心技能。", "problem": "对一个二倍体海洋无脊椎动物物种在某个具有等位基因 $A$ 和 $a$ 的双等位基因座上进行了调查。群体遗传学家从一个大型随机交配样本中估计出等位基因频率为 $p(A)=0.7$ 和 $q(a)=0.3$，并且观测到的杂合子频率（观测杂合度）为 $H_{O}=0.36$。使用哈代-温伯格平衡 (HWE) 的核心定义，即在随机交配且没有进化力量作用的情况下，等位基因频率 $p$ 和 $q$ 通过配子的随机结合决定基因型频率，首先确定 $AA$、$Aa$ 和 $aa$ 在 HWE 下的预期基因型频率。然后，从亚群体内赖特 (Wright) 的近交系数 ($F_{IS}$) 的定义出发——其概念上定义为由于非随机交配或相关过程导致的杂合度相对于 HWE 预期的比例性减少——推导一个将 $F_{IS}$ 与 $H_{O}$ 及 HWE 预期杂合度联系起来的表达式，并用它来计算该基因座的杂合子缺失程度。仅提供 $F_{IS}$ 的最终值，以简化分数形式表示。无需单位。", "solution": "问题陈述展示了群体遗传学中的一个标准情景，该情景是有效且表述清晰的。我们已知一个双等位基因座的等位基因频率以及观测到的杂合子频率。我们的任务是计算近交系数 $F_{IS}$。\n\n设等位基因为 $A$ 和 $a$。群体中这些等位基因的给定频率分别为 $p$ 和 $q$。\n给定的值为：\n- 等位基因 $A$ 的频率：$p = 0.7$\n- 等位基因 $a$ 的频率：$q = 0.3$\n作为基本检查，我们确认等位基因频率之和为 $p + q = 0.7 + 0.3 = 1$。该系统是自洽的。\n样本中观测到的杂合子 ($Aa$) 频率给定为 $H_{O} = 0.36$。\n\n第一步是确定在哈代-温伯格平衡 (HWE) 下的预期基因型频率。HWE 原理假定，在一个大型、随机交配、且不受突变、迁移和选择等进化力量影响的群体中，一个基因座上的基因型频率是等位基因频率的简单函数。具体来说，它们由 $(p+q)^2$ 的二项式展开项给出。\n\n纯合基因型 $AA$ 的预期频率为：\n$$ f(AA)_{exp} = p^2 = (0.7)^2 = 0.49 $$\n杂合基因型 $Aa$ 的预期频率，也称为预期杂合度 ($H_E$)，为：\n$$ H_E = f(Aa)_{exp} = 2pq = 2(0.7)(0.3) = 0.42 $$\n纯合基因型 $aa$ 的预期频率为：\n$$ f(aa)_{exp} = q^2 = (0.3)^2 = 0.09 $$\n这些预期频率的总和必须为 1：$f(AA)_{exp} + f(Aa)_{exp} + f(aa)_{exp} = 0.49 + 0.42 + 0.09 = 1.00$。计算正确。\n\n第二步是根据其定义推导赖特 (Wright) 的近交系数 $F_{IS}$ 的表达式。$F_{IS}$ 衡量亚群体内杂合度与 HWE 预期的偏差。它被定义为观测杂合度 ($H_O$) 相对于 HWE 预期杂合度 ($H_E$) 的比例性减少。\n\n杂合度的绝对减少量是预期值与观测值之差，即 $H_E - H_O$。\n为了将其表示为相对于预期值的比例，我们将此差值除以 $H_E$。这就给出了正式定义：\n$$ F_{IS} = \\frac{H_E - H_O}{H_E} $$\n$F_{IS}$ 的正值表示与 HWE 预期相比存在杂合子缺失，这通常是由于近交或其他形式的非随机交配（例如，群体亚结构、瓦伦德效应 (Wahlund effect)）所致。负值则表示杂合子过剩。\n\n最后一步是使用给定的和计算出的量来计算 $F_{IS}$ 的值。我们有：\n- 预期杂合度, $H_E = 0.42$。\n- 观测杂合度, $H_O = 0.36$。\n\n将这些值代入 $F_{IS}$ 的公式中：\n$$ F_{IS} = \\frac{0.42 - 0.36}{0.42} $$\n$$ F_{IS} = \\frac{0.06}{0.42} $$\n为了将此结果表示为简化分数，我们可以将小数值写成分数并进行化简：\n$$ F_{IS} = \\frac{6/100}{42/100} = \\frac{6}{42} $$\n将分子和分母同时除以它们的最大公约数 $6$，得到：\n$$ F_{IS} = \\frac{1}{7} $$\n这个正值证实了所调查的群体中，相对于随机交配的预期，存在杂合子缺失。", "answer": "$$\\boxed{\\frac{1}{7}}$$", "id": "2618070"}, {"introduction": "一个种群的普查数量（census size）往往会高估其在演化过程中的实际遗传规模。本练习 ([@problem_id:2618153]) 探讨了有效种群大小 ($N_e$) 的概念，它衡量了种群遗传漂变的速度。通过一个关于不均衡性别比的经典案例，你将推导出并计算 $N_e$，从而深刻理解现实世界中的种群统计特征如何影响其演化轨迹。", "problem": "象海豹是极端的一夫多妻制哺乳动物，其中只有一小部分雄性繁衍了大多数后代。考虑一个雌雄异体、随机交配的种群，其性别分离，世代不重叠，并遵循 Wright–Fisher (WF) 模型的假设：配子随机结合、无选择、无突变、无迁移。设在给定的世代中有 $N_m$ 个繁殖雄性和 $N_f$ 个繁殖雌性。关注一个中性的常染色体双等位基因座，其在第 $t$ 代的等位基因频率为 $p_t$，且在两性中相等。通过近交率来定义近交有效种群大小 $N_e$，将其定义为唯一的 $N_e$，使得每代杂合度的损失和每代等位基因频率的抽样方差与大小为 $N_e$ 的理想 WF 种群的相应值相等。从 WF 抽样逻辑和下一代常染色体等位基因频率 $p_{t+1}$ 等于父方和母方配子贡献中等位基因频率的平均值这一规定出发，推导出一个用 $N_m$ 和 $N_f$ 表示的 $N_e$ 的封闭式表达式。\n\n然后，对于一个有 $N_m=20$ 个繁殖雄性和 $N_f=200$ 个繁殖雌性的象海豹群体，计算 $N_e$ 的数值。将最终数值答案表示为一个无单位的精确既约分数。", "solution": "该问题要求为一个具有 $N_m$ 个繁殖雄性和 $N_f$ 个繁殖雌性的雌雄异体种群推导近交有效种群大小 $N_e$。推导之后，必须针对一个特定情况计算 $N_e$ 的数值。\n\n首先，对问题陈述进行验证。\n\n第一步：提取已知条件\n- 模型：雌雄异体、随机交配的种群，遵循 Wright–Fisher (WF) 模型假设。\n- 种群结构：$N_m$ 个繁殖雄性和 $N_f$ 个繁殖雌性。世代不重叠。\n- 基因座遗传学：中性的常染色体双等位基因座。第 $t$ 代的等位基因频率为 $p_t$，在两性中相等。\n- 动态：无选择、无突变、无迁移。\n- $p_{t+1}$ 的定义：第 $t+1$ 代的等位基因频率 $p_{t+1}$ 是父方和母方配子贡献中等位基因频率的平均值。\n- $N_e$ 的定义：近交有效种群大小 $N_e$ 的定义是，等位基因频率的抽样方差与大小为 $N_e$ 的理想 WF 种群的相应值相等。\n- 用于计算的具体参数：$N_m=20$，$N_f=200$。\n\n第二步：使用提取的已知条件进行验证\n该问题具有科学依据，是基于成熟的 Wright–Fisher 模型的群体遗传学标准练习。有效种群大小的概念及其对性别分离种群的推导是一个基础课题。该问题陈述清晰、客观、自洽，为推导提供了所有必要信息。所提供的数值对于给定的物种例子（象海豹）在生物学上是合理的。该问题不违反任何无效性标准。\n\n第三步：结论与行动\n问题被判定为有效。将提供完整解答。\n\n推导过程是通过计算等位基因频率从一代到下一代的抽样方差，并将其与大小为 $N_e$ 的理想化种群中的相应方差相等。\n\n设 $p_t$ 是第 $t$ 代整个种群中一个常染色体基因座上中性等位基因的频率。问题陈述该频率在雄性和雌性中是相等的。第 $t+1$ 代的亲本由从第 $t$ 代随机抽取的 $N_m$ 个繁殖雄性和 $N_f$ 个繁殖雌性组成。\n\n设 $p_m$ 是 $N_m$ 个雄性样本中实现的等位基因频率，而 $p_f$ 是 $N_f$ 个雌性样本中实现的等位基因频率。这些雄性携带 $2N_m$ 个等位基因，雌性携带 $2N_f$ 个等位基因。抽取这些亲本群体的过程等同于从第 $t$ 代的基因库中进行二项式抽样。\n\n在给定 $p_t$ 的条件下，$N_m$ 个雄性样本中等位基因频率的方差是二项式比例的方差：\n$$ \\text{Var}(p_m | p_t) = \\frac{p_t(1-p_t)}{2N_m} $$\n类似地，$N_f$ 个雌性样本中等位基因频率的方差是：\n$$ \\text{Var}(p_f | p_t) = \\frac{p_t(1-p_t)}{2N_f} $$\n问题陈述，下一代 $p_{t+1}$ 的等位基因频率是父方和母方配子贡献中频率的平均值。父方配子贡献中的频率（即由 $N_m$ 个父本产生的配子库）是 $p_m$。母方配子贡献中的频率是 $p_f$。因此，问题将该转换定义为：\n$$ p_{t+1} = \\frac{1}{2} (p_m + p_f) $$\n这个定义通过只考虑亲本的抽样，而不考虑后续形成合子的配子抽样，简化了过程。我们基于这个给定的定义进行推导。\n\n我们现在计算给定 $p_t$ 的条件下 $p_{t+1}$ 的方差。由于雄性和雌性亲本是从第 $t$ 代种群中独立抽样的，随机变量 $p_m$ 和 $p_f$ 是独立的。\n$$ \\text{Var}(p_{t+1} | p_t) = \\text{Var}\\left( \\frac{1}{2} (p_m + p_f) \\right) = \\left(\\frac{1}{2}\\right)^2 (\\text{Var}(p_m) + \\text{Var}(p_f)) $$\n代入 $p_m$ 和 $p_f$ 的方差表达式：\n$$ \\text{Var}(p_{t+1} | p_t) = \\frac{1}{4} \\left( \\frac{p_t(1-p_t)}{2N_m} + \\frac{p_t(1-p_t)}{2N_f} \\right) $$\n$$ \\text{Var}(p_{t+1} | p_t) = \\frac{p_t(1-p_t)}{8} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) $$\n这个表达式给出了在指定的雌雄异体种群中，等位基因频率的单代抽样方差。\n\n根据定义，近交有效种群大小 $N_e$ 是一个理想 Wright-Fisher 种群的大小，该种群会经历相同程度的遗传漂变（即相同的抽样方差）。在一个大小为 $N_e$ 的理想 WF 种群中，单代抽样方差是：\n$$ \\text{Var}(p') = \\frac{p(1-p)}{2N_e} $$\n将两个方差表达式相等，我们就可以解出 $N_e$：\n$$ \\frac{p_t(1-p_t)}{2N_e} = \\frac{p_t(1-p_t)}{8} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) $$\n假设等位基因未被固定或丢失（即 $0  p_t  1$），则 $p_t(1-p_t)$ 项可以从两边消去：\n$$ \\frac{1}{2N_e} = \\frac{1}{8} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) $$\n$$ \\frac{1}{N_e} = \\frac{1}{4} \\left( \\frac{1}{N_m} + \\frac{1}{N_f} \\right) $$\n这提供了 $N_e$ 倒数的表达式。为了得到 $N_e$ 的封闭式表达式，我们可以重新整理这些项：\n$$ \\frac{1}{N_e} = \\frac{1}{4} \\left( \\frac{N_f + N_m}{N_m N_f} \\right) $$\n$$ N_e = \\frac{4 N_m N_f}{N_m + N_f} $$\n这就是所要求的用繁殖雄性和雌性数量表示的近交有效种群大小的封闭式表达式。\n\n接下来，我们为给定的象海豹群体计算 $N_e$ 的数值，其中 $N_m = 20$，$N_f = 200$。\n$$ N_e = \\frac{4 \\times 20 \\times 200}{20 + 200} $$\n$$ N_e = \\frac{16000}{220} $$\n简化分数：\n$$ N_e = \\frac{1600}{22} = \\frac{800}{11} $$\n由于 $11$ 是一个质数，且不能整除 $800$，这个分数是其最简既约形式。繁殖种群的普查规模为 $N_c = N_m + N_f = 20 + 200 = 220$。有效种群大小为 $N_e = 800/11 \\approx 72.73$，这远小于普查规模，说明了偏斜的繁殖性别比对遗传漂变的强烈影响。", "answer": "$$\\boxed{\\frac{800}{11}}$$", "id": "2618153"}, {"introduction": "现代演化综论的一个核心成就是将孟德尔遗传学与达尔文的自然选择理论相结合，为复杂数量性状的演化提供了可预测的框架。本练习 ([@problem_id:2618209]) 运用了数量遗传学的核心工具——育种家方程（breeder's equation）。你将通过分析亲代与子代之间的表型关系来估算遗传力，并据此预测种群对自然选择的响应，这展示了演化生物学的预测能力。", "problem": "一位植物学家在现代演化综论（该理论整合了孟德尔遗传与数量性状）的框架下，研究一种多年生草本植物的野生种群，并评估其叶片面积的演化潜力。叶片面积以平方厘米为单位进行测量。在该理论的标准数量遗传学假设下——随机交配、亲本贡献相等、无选型交配、对所测表型的显性与上位性效应可忽略不计、无基因型与环境的交互作用，以及无母本或父本环境效应——表型方差可分解为加性遗传组分和环境组分。在一个受控的同质园中，测得叶片面积的表型方差为 $V_{P} = 10$（单位为 $\\mathrm{cm}^{4}$）。以双亲表型的平均值（中亲值）为预测变量进行亲子回归分析，估计回归斜率为 $b = 0.4$。一次田间生存力选择事件产生了叶片面积的单代选择差为 $S = 1.5$（单位为 $\\mathrm{cm}^{2}$）。\n\n仅从加性遗传方差、窄义遗传力的核心定义以及现代演化综论中对亲子回归的解释出发，并假设上述条件成立，确定：\n- 叶片面积的加性遗传方差 $V_{A}$，\n- 窄义遗传力 $h^{2}$，以及\n- 叶片面积的预期每代选择响应。\n\n将 $V_{A}$ 以 $\\mathrm{cm}^{4}$ 表示，选择响应以 $\\mathrm{cm}^{2}$ 表示。将所求的三个量均四舍五入至四位有效数字。以单行向量 $\\begin{pmatrix} V_{A}  h^{2}  R \\end{pmatrix}$ 的形式提供最终答案。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- **主题**：现代演化综论框架下的数量遗传学。\n- **性状**：叶片面积，以平方厘米（$\\mathrm{cm}^{2}$）为单位。\n- **假设**：随机交配、亲本贡献相等、无选型交配、显性与上位性效应可忽略不计、无基因型与环境的交互作用，以及无母本或父本环境效应。\n- **方差分解**：表型方差（$V_{P}$）可分解为加性遗传（$V_{A}$）和环境（$V_{E}$）组分：$V_{P} = V_{A} + V_{E}$。\n- **数据**：\n    - 表型方差：$V_{P} = 10$（单位为 $\\mathrm{cm}^{4}$）。\n    - 中亲值-子代回归斜率：$b = 0.4$。\n    - 单代选择差：$S = 1.5$（单位为 $\\mathrm{cm}^{2}$）。\n- **任务**：确定加性遗传方差（$V_{A}$）、窄义遗传力（$h^{2}$）以及预期的每代选择响应（$R$）。\n- **输出要求**：所有三个量均四舍五入至四位有效数字，并以单行向量 $\\begin{pmatrix} V_{A}  h^{2}  R \\end{pmatrix}$ 的形式呈现。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，是数量遗传学中的一个标准练习，而数量遗传学是现代演化综论的核心学科。所提供的假设是入门级问题中典型的简化条件，用以分离加性遗传效应。数据在量纲和事实上是一致的：面积（$\\mathrm{cm}^{2}$）的方差单位为 $(\\mathrm{cm}^{2})^{2} = \\mathrm{cm}^{4}$；回归斜率是无量纲的；选择差与性状具有相同的单位。该问题是适定的，因为它提供了得出唯一解所需的所有信息和定义。术语精确且客观。不存在“科学或事实不健全”、“设置不完整或矛盾”或其他使问题无效的缺陷。\n\n**步骤3：结论与行动**\n问题有效。将构建解答。\n\n根据问题陈述的要求，解答从所涉及数量的基本定义出发。\n\n首先，我们在给定假设下，建立中亲值-子代回归斜率与窄义遗传力之间的关系。窄义遗传力 $h^{2}$ 定义为加性遗传方差 $V_{A}$ 与总表型方差 $V_{P}$ 的比值：\n$$h^{2} = \\frac{V_{A}}{V_{P}}$$\n子代表型（$P_{O}$）对中亲表型（$\\bar{P}_{P}$）的回归斜率 $b$ 由它们的协方差与中亲表型方差的比值给出：\n$$b = \\frac{\\mathrm{cov}(P_{O}, \\bar{P}_{P})}{\\mathrm{var}(\\bar{P}_{P})}$$\n表型是加性遗传值（$A$）和环境离差（$E$）之和，因此 $P = A + E$。在问题假设显性、上位性以及基因型-环境交互作用可忽略不计的情况下，此简化是精确的。中亲表型为 $\\bar{P}_{P} = \\frac{P_{P1} + P_{P2}}{2}$，其中 $P_{P1}$ 和 $P_{P2}$ 是双亲的表型。\n\n首先分析协方差项：\n$$\\mathrm{cov}(P_{O}, \\bar{P}_{P}) = \\mathrm{cov}\\left(A_{O} + E_{O}, \\frac{A_{P1} + A_{P2}}{2} + \\frac{E_{P1} + E_{P2}}{2}\\right)$$\n由于假设亲代与子代之间没有环境相关性（这是同质园设计和“无母本或父本环境效应”条件的结果），环境项不与任何其他项协变。因此：\n$$\\mathrm{cov}(P_{O}, \\bar{P}_{P}) = \\mathrm{cov}\\left(A_{O}, \\frac{A_{P1} + A_{P2}}{2}\\right)$$\n一个子代的加性遗传值 $A_{O}$ 是其亲本加性遗传值的平均值，再加上一个由孟德尔分离引起的组分。具体来说，$A_{O} = \\frac{1}{2}A_{P1} + \\frac{1}{2}A_{P2} + A_{segregation}$。分离组分的期望值为零，且与亲本值不相关。因此：\n$$\\mathrm{cov}(P_{O}, \\bar{P}_{P}) = \\mathrm{cov}\\left(\\frac{1}{2}A_{P1} + \\frac{1}{2}A_{P2}, \\frac{1}{2}(A_{P1} + A_{P2})\\right) = \\frac{1}{4}\\mathrm{var}(A_{P1} + A_{P2})$$\n在随机交配（无选型交配）的假设下，双亲的加性遗传值不相关，因此 $\\mathrm{cov}(A_{P1}, A_{P2}) = 0$。和的方差等于方差的和：\n$$\\mathrm{cov}(P_{O}, \\bar{P}_{P}) = \\frac{1}{4}(\\mathrm{var}(A_{P1}) + \\mathrm{var}(A_{P2})) = \\frac{1}{4}(V_{A} + V_{A}) = \\frac{1}{2}V_{A}$$\n\n接下来，确定中亲表型的方差：\n$$\\mathrm{var}(\\bar{P}_{P}) = \\mathrm{var}\\left(\\frac{P_{P1} + P_{P2}}{2}\\right) = \\frac{1}{4}\\mathrm{var}(P_{P1} + P_{P2})$$\n再次，假设无选型交配，双亲的表型不相关，$\\mathrm{cov}(P_{P1}, P_{P2}) = 0$。因此：\n$$\\mathrm{var}(\\bar{P}_{P}) = \\frac{1}{4}(\\mathrm{var}(P_{P1}) + \\mathrm{var}(P_{P2})) = \\frac{1}{4}(V_{P} + V_{P}) = \\frac{1}{2}V_{P}$$\n\n将这些结果代回斜率 $b$ 的表达式中：\n$$b = \\frac{\\frac{1}{2}V_{A}}{\\frac{1}{2}V_{P}} = \\frac{V_{A}}{V_{P}}$$\n这表明，在指定条件下，中亲值-子代回归的斜率是窄义遗传力的直接估计量：$b = h^{2}$。\n\n在这些原理建立之后，我们可以计算所要求的三个量。\n\n1.  **窄义遗传力 ($h^{2}$)**：\n    已知回归斜率 $b = 0.4$，则窄义遗传力为：\n    $$h^{2} = b = 0.4$$\n    四舍五入至四位有效数字，$h^{2} = 0.4000$。\n\n2.  **加性遗传方差 ($V_{A}$)**：\n    根据遗传力的定义，我们可以重新整理公式以求解 $V_{A}$：\n    $$V_{A} = h^{2} V_{P}$$\n    代入给定值 $V_{P} = 10$ 和我们计算出的 $h^{2} = 0.4$：\n    $$V_{A} = 0.4 \\times 10 = 4$$\n    单位是 $\\mathrm{cm}^{4}$。四舍五入至四位有效数字得到 $V_{A} = 4.000$。\n\n3.  **选择响应 ($R$)**：\n    一代选择的预期响应 $R$ 由育种家方程预测：\n    $$R = h^{2} S$$\n    使用 $h^{2} = 0.4$ 和给定的选择差 $S = 1.5$：\n    $$R = 0.4 \\times 1.5 = 0.6$$\n    单位是 $\\mathrm{cm}^{2}$。四舍五入至四位有效数字得到 $R = 0.6000$。\n\n这三个量分别为 $V_{A} = 4.000$ $\\mathrm{cm}^{4}$，$h^{2} = 0.4000$ 和 $R = 0.6000$ $\\mathrm{cm}^{2}$。现在将它们组合成所要求的行向量格式。", "answer": "$$\\boxed{\\begin{pmatrix} 4.000  0.4000  0.6000 \\end{pmatrix}}$$", "id": "2618209"}]}