{"hands_on_practices": [{"introduction": "在测量生态位之前，我们必须首先定义它所存在的空间。温度、pH值和湿度等环境轴具有不同的单位和尺度，这使得直接比较变得没有意义。本练习[@problem_id:2498806]将探讨一个基本问题：如何以一种生物学上有意义的方式重新缩放这些轴，利用物种的生理耐受性数据来构建一个“距离”具有一致生态学意义的$n$维空间。", "problem": "一个物种的 Hutchinsonian 生态位在其最适点附近可以近似为一个$n$维环境空间中的光滑曲面。考虑三个环境轴：温度 $T$（单位为 $^{\\circ}\\mathrm{C}$）、土壤湿度 $M$（单位为 $\\%$ 体积含水量）和酸度 $P$（单位为 pH）。设绝对适应度为 $W(T,M,P)$，在 $(\\theta_T,\\theta_M,\\theta_P)$ 处有唯一的局部最适点，并假设在最适点附近 $W$ 在各轴上是光滑且可分的。您有生理耐受性测定数据，对于每个轴 $i\\in\\{T,M,P\\}$，确定一个对称偏差 $\\delta_i0$，使得在 $x_i=\\theta_i\\pm \\delta_i$ 时，其表现在该轴上是最大值的固定比例 $r\\in(0,1)$，其中 $r$ 在所有轴上都相同，因为测定是在一个共同的比例标准下进行的（例如，$r$ 对应于一个固定的比例下降，如 $r=0.05$，但不要假定一个具体的数值）。\n\n您希望构建一个无量纲重标度 $y_i=\\phi_i(x_i)$，将 $T$、$M$ 和 $P$ 置于一个共同的、无单位的尺度上，并在以下意义上保持相对适应度梯度：在 $(\\theta_T,\\theta_M,\\theta_P)$ 周围对 $\\log W$ 进行局部二次近似下，等值集近似变为球形，并且当以 $y_i$ 的单位衡量时，$\\log W$ 的梯度大小在各轴之间是可比较的。\n\n在给定的假设下，以下哪种重标度方法最能满足这些要求？\n\n- A. 通过野外站点的环境观测值的样本均值和标准差（SD）来标准化每个轴：$y_i=\\dfrac{x_i-\\mu_i}{s_i}$，其中 $\\mu_i$ 和 $s_i$ 分别是 $x_i$ 在所有站点上的样本均值和标准差。\n\n- B. 使用生理耐受性信息来推断 $\\log W$ 的局部曲率：如果 $W(\\theta_i\\pm \\delta_i)=r\\,W(\\theta_i)$，则设 $\\tau_i=\\dfrac{\\delta_i}{\\sqrt{-2\\ln r}}$ 并定义 $y_i=\\dfrac{x_i-\\theta_i}{\\tau_i}$，对于 $i\\in\\{T,M,P\\}$。\n\n- C. 基于耐受极限，将每个轴进行最小-最大值重标度至单位区间：$y_i=\\dfrac{x_i-(\\theta_i-\\delta_i)}{(\\theta_i+\\delta_i)-(\\theta_i-\\delta_i)}=\\dfrac{x_i-\\theta_i+\\delta_i}{2\\delta_i}$，使得在耐受范围内 $y_i\\in[0,1]$。\n\n- D. 应用异构的、单位特定的变换：$y_T=\\dfrac{T-\\theta_T}{s_T}$，$y_M=\\log(M)-\\log(\\theta_M)$ 和 $y_P=\\log(P)-\\log(\\theta_P)$，混合对数和基于方差的标度方法以减少偏度和均衡离散度。\n\n选择唯一的最佳选项。", "solution": "在尝试任何解答之前，必须先确定问题陈述的有效性。\n\n**步骤1：提取已知条件**\n\n-   一个物种的 Hutchinsonian 生态位由一个三维环境空间中的绝对适应度函数 $W(T, M, P)$ 建模，其坐标轴为温度 $T$（单位为 $^{\\circ}\\mathrm{C}$）、土壤湿度 $M$（单位为 $\\%$ 体积含水量）和酸度 $P$（单位为 pH）。\n-   在 $(\\theta_T, \\theta_M, \\theta_P)$ 处存在一个唯一的局部最适点。\n-   在最适点附近，$W$ 是光滑且可分的，意味着 $W(T, M, P) = W_T(T) W_M(M) W_P(P)$。\n-   对于每个轴 $i \\in \\{T, M, P\\}$，给定一个对称偏差 $\\delta_i  0$。\n-   在点 $x_i = \\theta_i \\pm \\delta_i$ 处（当其他变量保持在其最适值时），适应度是最大适应度的比例 $r \\in (0, 1)$。即，$W(x_i)|_{\\text{其他轴在最适点}} = r \\cdot W(\\theta_T, \\theta_M, \\theta_P)$。比例 $r$ 在所有轴上是恒定的。\n-   目标是找到一个无量纲重标度 $y_i = \\phi_i(x_i)$，满足两个要求：\n    1.  在对 $\\log W$ 进行局部二次近似下，该函数的等值集在重标度后的 $y$ 坐标系中近似变为球形。\n    2.  当以 $y_i$ 的单位衡量时，$\\log W$ 的梯度大小在各轴之间是可比较的。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据**：该问题使用了理论生态学和应用数学中标准、成熟的概念，包括 Hutchinsonian 生态位、适应度函数、可分性和泰勒级数近似（特别是局部二次近似）。重标度变量以统一它们的“生态距离”是生态位建模中一个常见且有意义的任务。其前提是科学合理的。\n-   **适定性**：该问题是适定的。它指定了一个函数、一组假设和一个清晰、可形式化的目标（将椭球形等值集转换为球形等值集）。这种结构允许对所需标度进行唯一的数学推导。\n-   **客观性**：问题陈述是用精确、客观和技术性的语言编写的。它没有歧义和主观陈述。\n-   **缺陷评估**：该问题不违反任何无效标准。它在科学上是合理的、可形式化的、完整的且内部一致的。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。将推导一个解答。\n\n**正确重标度方法的推导**\n\n令 $L(T, M, P) = \\log W(T, M, P)$。$W$ 的可分性假设意味着 $L$ 的可加性：\n$$L(T, M, P) = \\log(W_T(T)W_M(M)W_P(P)) = \\log W_T(T) + \\log W_M(M) + \\log W_P(P)$$\n我们记 $L_i(x_i) = \\log W_i(x_i)$，对于 $i \\in \\{T, M, P\\}$。因此，$L(x_T, x_M, x_P) = L_T(x_T) + L_M(x_M) + L_P(x_P)$。\n\n点 $(\\theta_T, \\theta_M, \\theta_P)$ 是一个最适点，这意味着 $L$ 的一阶偏导数在该点为零：\n$$ \\frac{\\partial L}{\\partial x_i} \\bigg|_{x_i=\\theta_i} = \\frac{dL_i}{dx_i} \\bigg|_{x_i=\\theta_i} = 0 $$\n问题要求使用 $\\log W$ 的局部二次近似。我们对 $L$ 在最适点 $(\\theta_T, \\theta_M, \\theta_P)$ 周围进行二阶泰勒展开。\n$$ L(x_T, x_M, x_P) \\approx L(\\theta_T, \\theta_M, \\theta_P) + \\sum_i \\frac{dL_i}{dx_i}\\bigg|_{\\theta_i} (x_i - \\theta_i) + \\frac{1}{2} \\sum_i \\frac{d^2L_i}{dx_i^2}\\bigg|_{\\theta_i} (x_i - \\theta_i)^2 $$\n由于最适点条件和可分性（这使得混合偏导数为零），这简化为：\n$$ L(\\mathbf{x}) \\approx L(\\mathbf{\\theta}) + \\frac{1}{2} \\sum_i H_{ii} (x_i - \\theta_i)^2 $$\n其中 $H_{ii} = \\frac{d^2L_i}{dx_i^2}\\big|_{\\theta_i}$ 是对数适应度函数沿轴 $i$ 的二阶导数（曲率）。由于 $(\\theta_T, \\theta_M, \\theta_P)$ 是一个最大值点，我们必须有 $H_{ii}  0$。\n\n$L$ 的一个等值集是一个曲面，其上 $L(\\mathbf{x}) = C$（对于某个常数 $C$）。在我们的近似中：\n$$ \\frac{1}{2} \\sum_i H_{ii} (x_i - \\theta_i)^2 = C - L(\\mathbf{\\theta}) = \\text{const'} $$\n这是一个以 $\\mathbf{\\theta}$ 为中心的椭球方程。目标是找到一个重标度 $y_i = \\phi_i(x_i)$，将这些椭球形等值集转换为球面。一个简单且合适的变换是以最适点为中心的线性标度变换：$y_i = c_i (x_i - \\theta_i)$，其中 $c_i$ 是一组标度常数。由此，$(x_i - \\theta_i) = y_i/c_i$。代入等值集方程：\n$$ \\sum_i H_{ii} \\left(\\frac{y_i}{c_i}\\right)^2 = 2\\cdot\\text{const'} \\implies \\sum_i \\frac{H_{ii}}{c_i^2} y_i^2 = \\text{const''} $$\n为使其描述一个球面，$y_i^2$ 的系数必须相等。我们将它们设为一个方便的常数 $-1$。\n$$ \\frac{H_{ii}}{c_i^2} = -1 \\implies c_i^2 = -H_{ii} \\implies c_i = \\sqrt{-H_{ii}} $$\n因此，所需的重标度为 $y_i = \\sqrt{-H_{ii}}(x_i - \\theta_i)$，它可以写成 $y_i = \\frac{x_i - \\theta_i}{1/\\sqrt{-H_{ii}}}$。\n\n接下来，我们必须根据提供的生理耐受性数据来确定 $H_{ii}$。数据表明，对于每个轴 $i$，$W_i(\\theta_i \\pm \\delta_i) = r \\cdot W_i(\\theta_i)$。取自然对数（如选项B的格式所示）：\n$$ \\ln(W_i(\\theta_i \\pm \\delta_i)) = \\ln(r) + \\ln(W_i(\\theta_i)) \\implies L_i(\\theta_i \\pm \\delta_i) = \\ln r + L_i(\\theta_i) $$\n现在，我们将 $L_i(x_i)$ 的二次近似应用于 $x_i = \\theta_i \\pm \\delta_i$：\n$$ L_i(\\theta_i \\pm \\delta_i) \\approx L_i(\\theta_i) + \\frac{1}{2} H_{ii} ((\\theta_i \\pm \\delta_i) - \\theta_i)^2 = L_i(\\theta_i) + \\frac{1}{2} H_{ii} \\delta_i^2 $$\n将 $L_i(\\theta_i \\pm \\delta_i)$ 的两个表达式相等：\n$$ L_i(\\theta_i) + \\ln r = L_i(\\theta_i) + \\frac{1}{2} H_{ii} \\delta_i^2 \\implies \\ln r = \\frac{1}{2} H_{ii} \\delta_i^2 $$\n解出 $H_{ii}$：\n$$ H_{ii} = \\frac{2 \\ln r}{\\delta_i^2} $$\n现在我们可以找到标度分母，我们称之为 $\\tau_i$：\n$$ \\tau_i = \\frac{1}{\\sqrt{-H_{ii}}} = \\frac{1}{\\sqrt{-\\frac{2 \\ln r}{\\delta_i^2}}} = \\frac{1}{\\frac{\\sqrt{-2 \\ln r}}{\\delta_i}} = \\frac{\\delta_i}{\\sqrt{-2 \\ln r}} $$\n最终的变换是 $y_i = \\frac{x_i - \\theta_i}{\\tau_i}$。这与选项B中提出的形式相匹配。这个变换是基础性的，因为高斯函数的形式为 $f(x) \\propto \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$。其对数为 $\\text{const} - \\frac{(x - \\mu)^2}{2\\sigma^2}$。曲率（二阶导数）是 $-\\frac{1}{\\sigma^2}$。因此，$\\sigma^2 = -1/H_{ii}$，标准差是 $\\sigma = 1/\\sqrt{-H_{ii}}$。我们推导出的标度因子 $\\tau_i$ 正是由二次近似所隐含的高斯适应度曲线的标准差。因此，变换 $y_i = (x_i - \\theta_i)/\\tau_i$ 将每个变量转换为相对于其适应度函数宽度的标准分数。\n\n**逐项分析选项**\n\n-   **A. 通过野外站点的环境观测值的样本均值和标准差（SD）来标准化每个轴：$y_i=\\dfrac{x_i-\\mu_i}{s_i}$，其中 $\\mu_i$ 和 $s_i$ 分别是 $x_i$ 在所有站点上的样本均值和标准差。**\n    这种重标度方法是基于一组采样站点的环境变量的分布，而不是基于生物的生理响应。一个环境的均值 $\\mu_i$ 和标准差 $s_i$ 与生物的最适点 $\\theta_i$ 和耐受性（由其适应度函数 $W$ 表示）无关。野外站点甚至可能不包含生理最适点。这个变换没有使用关于 $W$ 的信息，因此不能期望它能使其等值集呈球形。\n    **结论：错误。**\n\n-   **B. 使用生理耐受性信息来推断 $\\log W$ 的局部曲率：如果 $W(\\theta_i\\pm \\delta_i)=r\\,W(\\theta_i)$，则设 $\\tau_i=\\dfrac{\\delta_i}{\\sqrt{-2\\ln r}}$ 并定义 $y_i=\\dfrac{x_i-\\theta_i}{\\tau_i}$，对于 $i\\in\\{T,M,P\\}$。**\n    这个选项精确地匹配我们严格推导的结果。中心点是适应度最适点 $\\theta_i$。标度因子 $\\tau_i$ 直接从对数适应度函数的局部曲率推导出来，并从生理数据 $(\\delta_i, r)$ 正确推断。根据构造，这个变换将 $\\log W$ 的二次近似的椭球形等值集映射到 $y$ 空间中以原点为中心的球面。它也使得梯度大小具有可比性，因为 $\\nabla_{\\mathbf{y}}L \\approx -\\mathbf{y}$，所以偏导数 $\\partial L/\\partial y_i \\approx -y_i$。\n    **结论：正确。**\n\n-   **C. 基于耐受极限，将每个轴进行最小-最大值重标度至单位区间：$y_i=\\dfrac{x_i-(\\theta_i-\\delta_i)}{(\\theta_i+\\delta_i)-(\\theta_i-\\delta_i)}=\\dfrac{x_i-\\theta_i+\\delta_i}{2\\delta_i}$，使得在耐受范围内 $y_i\\in[0,1]$。**\n    这个变换将区间 $[\\theta_i - \\delta_i, \\theta_i + \\delta_i]$ 重标度到 $[0, 1]$。我们可以将其重写为 $y_i - \\frac{1}{2} = \\frac{x_i - \\theta_i}{2\\delta_i}$。等值集方程 $\\sum_i H_{ii} (x_i - \\theta_i)^2 = \\text{const}$ 变为 $\\sum_i H_{ii} (2\\delta_i (y_i - 1/2))^2 = \\text{const}$。代入 $H_{ii} = \\frac{2 \\ln r}{\\delta_i^2}$，$(y_i - 1/2)^2$ 的系数是 $H_{ii} (2\\delta_i)^2_i = (\\frac{2 \\ln r}{\\delta_i^2})(4\\delta_i^2) = 8 \\ln r$。由于这个系数与 $i$ 无关，这个变换也导致了球形的等值集，在 $y$ 空间中以 $(1/2, 1/2, 1/2)$ 为中心。然而，这种标度是基于 $\\delta_i$ 的，而 $\\delta_i$ 本身又依赖于对 $r$ 的任意选择 ($\\delta_i \\propto \\sqrt{-\\ln r}$)。选项B中的标度因子 $\\tau_i$ 对于测定中使用的 $r$ 的选择是不变的，因为 $\\tau_i = \\delta_i / \\sqrt{-2\\ln r} = 1/\\sqrt{-H_{ii}}$，它只依赖于内在曲率。因此，选项B的标度方法比C的更根本、更稳健。因此，B是“最佳”选择。\n    **结论：错误。**\n\n-   **D. 应用异构的、单位特定的变换：$y_T=\\dfrac{T-\\theta_T}{s_T}$，$y_M=\\log(M)-\\log(\\theta_M)$ 和 $y_P=\\log(P)-\\log(\\theta_P)$，混合对数和基于方差的标度方法以减少偏度和均衡离散度。**\n    这个选项是一种临时的变换混合。温度的标度使用了 $s_T$，即环境标准差，根据A中陈述的理由，这是不正确的。对 $M$ 和 $P$ 的对数变换预先假定适应度曲线在对数尺度上是对称的（即对数正态），这与问题的前提——在原始尺度上存在对称偏差 $\\delta_i$——相矛盾。基于问题陈述，对于这种混合变换没有第一性原理的证明。\n    **结论：错误。**", "answer": "$$\\boxed{B}$$", "id": "2498806"}, {"introduction": "生态学家很少能观察到一个物种所有它*可能*存活的地方（即基础生态位）。我们通常只能看到它*实际*存活的地方（即现实生态位），这是一个受扩散障碍等因素限制的子集。本练习[@problem_id:2498812]通过一个简化的几何模型，让您亲手计算这种障碍如何系统性地扭曲我们对生态位真实中心的估计，从而深刻理解基础生态位和现实生态位之间的差异。", "problem": "一个物种的基本哈钦森生态位在环境空间 $\\mathbb{R}^{2}$ 中由实心椭圆表示\n$$\nH \\;=\\; \\left\\{ (e_{1},e_{2}) \\in \\mathbb{R}^{2} \\;:\\; \\frac{(e_{1}-\\mu_{1})^{2}}{a^{2}} + \\frac{(e_{2}-\\mu_{2})^{2}}{b^{2}} \\,\\le\\, 1 \\right\\},\n$$\n其中形心位于 $\\mu \\,=\\, (\\mu_{1},\\mu_{2}) \\,=\\, (0,0)$，半轴为 $a \\,\\, 0$ 和 $b \\,\\, 0$。设环境-地理映射 $\\varphi$ 在重新标度后为恒等映射，因此对所有 $g \\in \\mathbb{R}^{2}$ 都有 $\\varphi(g) \\,=\\, g$；从而 $\\varphi^{-1}(H) \\,=\\, H$。一个扩散障碍 $M$ 排除了所有第一个坐标为负的地理位置，即 $M \\,=\\, \\{(x,y) \\in \\mathbb{R}^{2} : x \\,\\ge\\, 0\\}$，因此只有 $\\varphi^{-1}(H)$ 的右半部分得以实现。假设实现的出现点在 $R \\,=\\, \\varphi^{-1}(H) \\cap M$ 上均匀分布。\n\n一种常见的基于形心的生态位中心估计量使用实现的环境向量的样本均值。在无限采样下，该估计量收敛于环境空间中实现集的几何形心。仅从上述定义和将几何形心计算为适当面积分的第一性原理出发，推导出期望估计量，并量化其相对于真实形心 $\\mu$ 的偏差。具体来说，计算偏差向量的欧几里得范数\n$$\n\\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2}\n$$\n并给出一个用 $a$ 和 $b$ 表示的闭式表达式。\n\n你的最终答案必须是一个单一的闭式解析表达式。不要包含单位。不要提供不等式或方程式。如果必须简化任何常数，请以符号形式进行；本题不需要进行数值四舍五入。", "solution": "对问题陈述进行严格评估如下。\n\n**第1步：提取已知条件**\n-   基本哈钦森生态位是环境空间 $\\mathbb{R}^{2}$ 中的一个实心椭圆 $H$：\n    $$H \\;=\\; \\left\\{ (e_{1},e_{2}) \\in \\mathbb{R}^{2} \\;:\\; \\frac{(e_{1}-\\mu_{1})^{2}}{a^{2}} + \\frac{(e_{2}-\\mu_{2})^{2}}{b^{2}} \\,\\le\\, 1 \\right\\}$$\n-   生态位的真实形心是 $\\mu \\,=\\, (\\mu_{1},\\mu_{2}) \\,=\\, (0,0)$。\n-   椭圆的半轴为 $a \\,\\, 0$ 和 $b \\,\\, 0$。\n-   环境-地理映射是恒等映射，$\\varphi(g) \\,=\\, g$，这意味着潜在分布与生态位相同，$\\varphi^{-1}(H) \\,=\\, H$。\n-   一个扩散障碍 $M$ 将物种限制在地理区域 $M \\,=\\, \\{(x,y) \\in \\mathbb{R}^{2} : x \\,\\ge\\, 0\\}$。\n-   实现的分布 $R$ 是潜在分布与可达区域的交集：$R \\,=\\, \\varphi^{-1}(H) \\cap M \\,=\\, H \\cap M$。\n-   实现的出现点在 $R$ 上均匀分布。\n-   在无限采样下，生态位形心的估计量 $\\hat{\\mu}$ 收敛于实现集 $R$ 的几何形心，我们将其表示为 $\\mathbb{E}[\\hat{\\mu}]$。\n-   任务是计算偏差向量的欧几里得范数，$\\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2}$。\n\n**第2步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题使用了一个公认的生态学概念——哈钦森生态位，并使用标准的几何和分析工具（椭圆、形心、积分）对其进行建模。由扩散障碍导致的基本生态位和实现生态位之间的区别是生态学的核心课题。该问题是对生态位截断的一个简化但科学上有效的表示。\n-   **适定性：** 该问题提供了确定唯一解所需的所有必要定义和约束。无限采样的假设将估计简化为几何形心的确定性计算。定义清晰且数学上形式化。\n-   **客观性：** 语言是形式化和定量的。没有主观或基于观点的陈述。\n\n**第3步：结论与行动**\n该问题是有效的。它有科学依据，适定，客观且自洽。现在将推导完整的解。\n\n**解的推导**\n基本生态位的真实形心给定为 $\\mu = (0,0)$。在无限采样下的估计量 $\\mathbb{E}[\\hat{\\mu}]$ 是实现生态位 $R$ 的几何形心。实现生态位 $R$ 是椭圆\n$$ \\frac{e_{1}^{2}}{a^{2}} + \\frac{e_{2}^{2}}{b^{2}} \\le 1 $$\n中第一个坐标为非负（即 $e_{1} \\ge 0$）的部分。这对应于以原点为中心的实心椭圆的右半部分。\n\n区域 $R$ 的几何形心坐标，我们记为 $(\\hat{\\mu}_{1}, \\hat{\\mu}_{2}) = \\mathbb{E}[\\hat{\\mu}]$，由以下公式给出：\n$$ \\hat{\\mu}_{1} = \\frac{\\iint_{R} e_{1} \\,dA}{\\iint_{R} dA} \\quad \\text{和} \\quad \\hat{\\mu}_{2} = \\frac{\\iint_{R} e_{2} \\,dA}{\\iint_{R} dA} $$\n其中 $dA = de_{1}de_{2}$。\n\n首先，我们计算分母，即区域 $R$ 的面积。完整椭圆 $H$ 的面积是 $\\pi ab$。由于 $R$ 正好是椭圆的一半，其面积为：\n$$ \\text{Area}(R) = \\iint_{R} dA = \\frac{1}{2} \\pi a b $$\n\n接下来，我们计算 $\\hat{\\mu}_{2}$ 的分子。区域 $R$ 关于 $e_{1}$ 轴（直线 $e_{2}=0$）对称。被积函数 $f(e_{1},e_{2})=e_{2}$ 是关于 $e_{2}$ 的奇函数。因此，奇函数在对称域上的积分为零：\n$$ \\iint_{R} e_{2} \\,dA = 0 $$\n这意味着形心的第二个坐标是 $\\hat{\\mu}_{2} = 0$。由于区域的对称性，这是预料之中的。\n\n现在，我们计算 $\\hat{\\mu}_{1}$ 的分子：\n$$ \\iint_{R} e_{1} \\,dA = \\iint_{R} e_{1} \\,de_{1}de_{2} $$\n我们可以在椭圆的右半部分上建立积分。$e_{1}$ 的界限是从 $0$ 到 $a$。对于给定的 $e_{1}$，$e_{2}$ 的界限是从 $-b\\sqrt{1-e_{1}^2/a^2}$ 到 $+b\\sqrt{1-e_{1}^2/a^2}$。\n$$ \\iint_{R} e_{1} \\,dA = \\int_{0}^{a} \\left( \\int_{-b\\sqrt{1-e_{1}^{2}/a^{2}}}^{b\\sqrt{1-e_{1}^{2}/a^{2}}} e_{1} \\,de_{2} \\right) de_{1} $$\n对 $e_{2}$ 积分：\n$$ \\int_{0}^{a} e_{1} \\left[ e_{2} \\right]_{-b\\sqrt{1-e_{1}^{2}/a^{2}}}^{b\\sqrt{1-e_{1}^{2}/a^{2}}} \\,de_{1} = \\int_{0}^{a} e_{1} \\left( 2b\\sqrt{1-\\frac{e_{1}^{2}}{a^{2}}} \\right) de_{1} = 2b \\int_{0}^{a} e_{1} \\sqrt{1-\\frac{e_{1}^{2}}{a^{2}}} \\,de_{1} $$\n为了解这个积分，我们使用换元法，令 $u = 1 - \\frac{e_{1}^{2}}{a^{2}}$。这得到 $du = -\\frac{2e_{1}}{a^{2}}de_{1}$，或 $e_{1}de_{1} = -\\frac{a^{2}}{2}du$。积分的上下限从 $e_{1}=0$ 变为 $u=1$，从 $e_{1}=a$ 变为 $u=0$。\n$$ 2b \\int_{1}^{0} \\sqrt{u} \\left( -\\frac{a^{2}}{2} \\right) du = -a^{2}b \\int_{1}^{0} u^{1/2} du = a^{2}b \\int_{0}^{1} u^{1/2} du $$\n$$ = a^{2}b \\left[ \\frac{u^{3/2}}{3/2} \\right]_{0}^{1} = a^{2}b \\left( \\frac{2}{3}(1)^{3/2} - \\frac{2}{3}(0)^{3/2} \\right) = \\frac{2}{3}a^{2}b $$\n现在我们可以计算 $\\hat{\\mu}_{1}$：\n$$ \\hat{\\mu}_{1} = \\frac{\\frac{2}{3}a^{2}b}{\\frac{1}{2}\\pi ab} = \\frac{2a^{2}b}{3} \\cdot \\frac{2}{\\pi ab} = \\frac{4a}{3\\pi} $$\n因此，估计的形心是 $\\mathbb{E}[\\hat{\\mu}] = (\\hat{\\mu}_{1}, \\hat{\\mu}_{2}) = \\left(\\frac{4a}{3\\pi}, 0\\right)$。\n\n估计量的偏差是估计形心与真实形心之间的差：\n$$ \\text{Bias} = \\mathbb{E}[\\hat{\\mu}] - \\mu = \\left(\\frac{4a}{3\\pi}, 0\\right) - (0,0) = \\left(\\frac{4a}{3\\pi}, 0\\right) $$\n最后，我们计算偏差向量的欧几里得范数：\n$$ \\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2} = \\left\\| \\left(\\frac{4a}{3\\pi}, 0\\right) \\right\\|_{2} = \\sqrt{\\left(\\frac{4a}{3\\pi}\\right)^{2} + 0^{2}} = \\sqrt{\\left(\\frac{4a}{3\\pi}\\right)^{2}} $$\n由于 $a  0$，量 $\\frac{4a}{3\\pi}$ 是正的，所以范数是：\n$$ \\|\\mathbb{E}[\\hat{\\mu}] - \\mu\\|_{2} = \\frac{4a}{3\\pi} $$\n这个表达式量化了因扩散障碍而截断的样本来估计生态位中心所引入的系统误差的大小。偏差仅存在于被截断的轴上，其大小与生态位在该轴上的范围 $a$ 成正比。未受限制轴上的范围 $b$ 不影响偏差的大小。", "answer": "$$\n\\boxed{\\frac{4a}{3\\pi}}\n$$", "id": "2498812"}, {"introduction": "另一个常见的挑战是我们的采样努力并非均匀分布；某些区域比其他区域更容易调查，这导致了“仅有出现”数据（presence-only data）中的采样偏差。本练习[@problem_id:2498835]提供了一个强大的解析解，演示了当采样努力沿某一环境梯度变化时，如何量化并校正估计的生态位中心的偏差。这个例子揭示了在处理现实世界生态数据时，理解并建模采样过程的重要性。", "problem": "一个物种的哈钦森基本生态位 (fundamental Hutchinsonian niche) 在一个二维气候环境空间中表示为概率密度，该空间的坐标轴为温度 $T$ (摄氏度) 和降水量 $P$ (毫米)。设真实的环境占据分布为二元正态分布，其均值向量为 $\\boldsymbol{\\mu} = \\begin{pmatrix}\\mu_{T} \\\\ \\mu_{P}\\end{pmatrix}$，协方差矩阵为\n$$\n\\boldsymbol{\\Sigma} \\;=\\;\n\\begin{pmatrix}\n\\sigma_{T}^{2}  \\rho \\,\\sigma_{T}\\sigma_{P} \\\\\n\\rho \\,\\sigma_{T}\\sigma_{P}  \\sigma_{P}^{2}\n\\end{pmatrix},\n$$\n因此，出现点的环境协变量密度为\n$$\nf_{\\mathbf{X}}(\\mathbf{x}) \\;=\\; \\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}} \\exp\\!\\Big(-\\tfrac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})\\Big),\n$$\n其中 $\\mathbf{x}=\\begin{pmatrix}T \\\\ P\\end{pmatrix}$，而 $|\\boldsymbol{\\Sigma}|$ 表示 $\\boldsymbol{\\Sigma}$ 的行列式。\n\n由于可及性偏差，采集到的仅有出现记录 (Presence-only records) 的抽样努力 (sampling effort) 沿着温度轴单调递增。假设一个简单的对数线性抽样努力模型 $w(\\mathbf{x}) \\propto \\exp(\\beta\\, T)$，其中 $\\beta0$ 为已知常数。在标准的非齐次泊松点过程抽样下，观测到的仅有出现环境密度与 $f_{\\mathbf{X}}(\\mathbf{x})\\,w(\\mathbf{x})$ 成正比。\n\n从这些假设和多元正态分布的定义出发，推导估计的生态位质心中偏差向量的解析表达式，\n$$\n\\boldsymbol{\\Delta} \\;=\\; \\mathbb{E}_{\\text{obs}}[\\mathbf{X}] \\;-\\; \\boldsymbol{\\mu},\n$$\n该表达式用 $\\boldsymbol{\\Sigma}$ 和 $\\beta$ 表示。然后，使用参数值 $\\sigma_{T}=3$、$\\sigma_{P}=200$、$\\rho=0.4$ 和 $\\beta=0.02$ (每摄氏度)，计算 $\\boldsymbol{\\Delta}$ 的数值。将最终数值答案的每个分量四舍五入到 $4$ 位有效数字。用相应坐标轴的单位（温度分量为摄氏度，降水分量为毫米）表示偏差向量的分量，但不要在方框内的答案中包含单位。将你的最终数值答案表示为一个包含 $2$ 个分量的行向量。", "solution": "该问题已经过验证，被认为是科学上合理的、适定的和客观的。不存在矛盾、歧义或逻辑缺陷。我们直接进行推导。\n\n真实的环境占据分布，即基本生态位，是一个二元正态概率密度函数 $f_{\\mathbf{X}}(\\mathbf{x})$，其中 $\\mathbf{X} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\boldsymbol{\\Sigma})$。环境协变量向量为 $\\mathbf{x} = \\begin{pmatrix} T \\\\ P \\end{pmatrix}$。\n\n抽样努力由 $w(\\mathbf{x}) \\propto \\exp(\\beta T)$ 给出，其中 $\\beta  0$ 是一个已知常数。观测到的出现点密度 $f_{\\text{obs}}(\\mathbf{x})$ 与真实占据密度和抽样努力函数的乘积成正比：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto f_{\\mathbf{X}}(\\mathbf{x}) w(\\mathbf{x})\n$$\n代入正态密度和抽样努力模型的表达式，我们得到：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto \\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu})\\right) \\exp(\\beta T)\n$$\n由于指数前因子 $\\frac{1}{2\\pi \\sqrt{|\\boldsymbol{\\Sigma}|}}$ 是一个常数，我们可以将其吸收到比例常数中。问题的核心在于指数部分。让我们合并指数项：\n$$\nf_{\\text{obs}}(\\mathbf{x}) \\propto \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}) + \\beta T\\right)\n$$\n项 $\\beta T$ 可以写成向量形式。令 $\\mathbf{b} = \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix}$。那么 $\\beta T = \\beta \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} T \\\\ P \\end{pmatrix} = \\mathbf{b}^{\\top}\\mathbf{x}$。指数为：\n$$\n\\mathcal{E} = -\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}) + \\mathbf{b}^{\\top}\\mathbf{x}\n$$\n我们展开二次型：\n$$\n\\mathcal{E} = -\\frac{1}{2}(\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} - \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} - \\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}) + \\mathbf{b}^{\\top}\\mathbf{x}\n$$\n由于 $\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x}$ 是一个标量，它等于其转置 $\\mathbf{x}^{\\top}(\\boldsymbol{\\Sigma}^{-1})^{\\top}\\boldsymbol{\\mu} = \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}$，因为 $\\boldsymbol{\\Sigma}^{-1}$ 是对称的。因此，表达式变为：\n$$\n\\mathcal{E} = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b}^{\\top}\\mathbf{x} - \\frac{1}{2}\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}\n$$\n我们将 $\\mathbf{x}$ 的线性项组合在一起：\n$$\n\\mathcal{E} = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + (\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1} + \\mathbf{b}^{\\top})\\mathbf{x} - \\frac{1}{2}\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}\n$$\n这个表达式具有多元正态密度对数的函数形式。一个均值向量为 $\\boldsymbol{\\mu}_{\\text{obs}}$、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的一般正态密度，其对数密度与以下表达式成正比：\n$$\n-\\frac{1}{2}(\\mathbf{x}-\\boldsymbol{\\mu}_{\\text{obs}})^{\\top}\\boldsymbol{\\Sigma}^{-1}(\\mathbf{x}-\\boldsymbol{\\mu}_{\\text{obs}}) = -\\frac{1}{2}\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\mathbf{x} + \\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} - \\frac{1}{2}\\boldsymbol{\\mu}_{\\text{obs}}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}}\n$$\n通过比较我们的 $\\mathcal{E}$ 表达式与一般形式中关于 $\\mathbf{x}^{\\top}$ (或 $\\mathbf{x}$) 的线性项，我们可以确定新的均值向量 $\\boldsymbol{\\mu}_{\\text{obs}}$。\n$$\n\\mathbf{x}^{\\top}\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} = (\\boldsymbol{\\mu}^{\\top}\\boldsymbol{\\Sigma}^{-1} + \\mathbf{b}^{\\top})\\mathbf{x} = \\mathbf{x}^{\\top}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b})\n$$\n该等式必须对所有 $\\mathbf{x}$ 成立，这意味着：\n$$\n\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b}\n$$\n为了求解 $\\boldsymbol{\\mu}_{\\text{obs}}$，即观测分布下的期望值 $\\mathbb{E}_{\\text{obs}}[\\mathbf{X}]$，我们从左侧乘以 $\\boldsymbol{\\Sigma}$：\n$$\n\\boldsymbol{\\Sigma}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu}_{\\text{obs}}) = \\boldsymbol{\\Sigma}(\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{\\mu} + \\mathbf{b})\n$$\n$$\n\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}\n$$\n因此，观测分布 $f_{\\text{obs}}(\\mathbf{x})$ 是一个二元正态分布，其均值为 $\\boldsymbol{\\mu}_{\\text{obs}} = \\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}$，协方差矩阵与原分布相同，仍为 $\\boldsymbol{\\Sigma}$。\n\n偏差向量 $\\boldsymbol{\\Delta}$ 定义为观测均值与真实均值之差：\n$$\n\\boldsymbol{\\Delta} = \\mathbb{E}_{\\text{obs}}[\\mathbf{X}] - \\boldsymbol{\\mu} = \\boldsymbol{\\mu}_{\\text{obs}} - \\boldsymbol{\\mu}\n$$\n代入我们关于 $\\boldsymbol{\\mu}_{\\text{obs}}$ 的结果：\n$$\n\\boldsymbol{\\Delta} = (\\boldsymbol{\\mu} + \\boldsymbol{\\Sigma}\\mathbf{b}) - \\boldsymbol{\\mu} = \\boldsymbol{\\Sigma}\\mathbf{b}\n$$\n这就是偏差向量的解析表达式。现在我们用 $\\boldsymbol{\\Sigma}$ 和 $\\beta$ 的分量来表示它：\n$$\n\\boldsymbol{\\Delta} = \\begin{pmatrix} \\sigma_{T}^{2}  \\rho \\sigma_{T}\\sigma_{P} \\\\ \\rho \\sigma_{T}\\sigma_{P}  \\sigma_{P}^{2} \\end{pmatrix} \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{T}^{2}\\beta + (\\rho \\sigma_{T}\\sigma_{P}) \\cdot 0 \\\\ (\\rho \\sigma_{T}\\sigma_{P})\\beta + \\sigma_{P}^{2} \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} \\beta \\sigma_{T}^{2} \\\\ \\beta \\rho \\sigma_{T}\\sigma_{P} \\end{pmatrix}\n$$\n温度偏差 $\\Delta_T$ 为 $\\beta \\sigma_{T}^{2}$。降水量偏差 $\\Delta_P$ 为 $\\beta \\rho \\sigma_{T}\\sigma_{P}$。\n\n现在，我们使用给定的参数计算 $\\boldsymbol{\\Delta}$ 的数值：$\\sigma_{T}=3$，$\\sigma_{P}=200$，$\\rho=0.4$ 和 $\\beta=0.02$。\n\n偏差的温度分量为：\n$$\n\\Delta_T = \\beta \\sigma_{T}^{2} = (0.02) \\cdot (3^{2}) = 0.02 \\cdot 9 = 0.18\n$$\n偏差的降水分量为：\n$$\n\\Delta_P = \\beta \\rho \\sigma_{T}\\sigma_{P} = (0.02) \\cdot (0.4) \\cdot (3) \\cdot (200) = 0.008 \\cdot 600 = 4.8\n$$\n得到的偏差向量为 $\\boldsymbol{\\Delta} = \\begin{pmatrix} 0.18 \\\\ 4.8 \\end{pmatrix}$。题目要求将每个分量四舍五入到4位有效数字。\n$$\n\\Delta_T = 0.1800\n$$\n$$\n\\Delta_P = 4.800\n$$\n最终数值答案以行向量形式呈现。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1800  4.800 \\end{pmatrix}}\n$$", "id": "2498835"}]}