{"hands_on_practices": [{"introduction": "生命史策略的微小变化可能对种群动态产生巨大影响。然而，并非所有年龄段的生命率变化都具有同等的重要性。本练习将通过一个思想实验，让您亲手计算并比较改善早期与晚期存活率对净生殖率 ($R_0$) 的不同影响，从而揭示种群增长对生命史不同阶段变化的敏感性。[@problem_id:2491615]", "problem": "一个年龄结构种群具有离散的年度年龄组 $x \\in \\{0,1,2,3,4\\}$，其特定年龄存活率（从年龄 $x$ 到年龄 $x+1$）为 $p_x$，特定年龄雌性繁殖力（每位雌性的雌性后代数）为 $m_x$。基线生活史如下：\n- $p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$,\n- $m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$。\n\n考虑对死亡率表进行两种反事实的改变，这两种改变的绝对量值相等，但作用于不同年龄，同时保持所有其他生命率不变：\n- 幼年死亡率变化：将 $p_0$ 增加 $+0.1$。\n- 老年死亡率变化：将 $p_3$ 增加 $+0.1$。\n\n从存活率 $l_x$（其中 $l_0 = 1$ 且 $l_{x+1} = l_x p_x$）、净再生率 $R_0$（每个新生儿预期的终生雌性后代数）和代际时间 $T$（按实际出生数加权的平均繁殖年龄）的定义出发，完成以下任务：\n- 计算基线的 $R_0$ 和 $T$。\n- 计算在幼年死亡率变化和老年死亡率变化下的 $R_0$ 和 $T$。\n- 使用这些结果来证明存活率权重如何导致 $R_0$ 和 $T$ 对幼年与老年死亡率变化的敏感性有所不同。\n\n为评分目的，仅报告两种情景下净再生率变化的比率，\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}},$$\n该比率应为一个纯数（无单位），并四舍五入到四位有效数字。最终答案中不应报告其他数值输出。", "solution": "该问题要求分析人口统计率（特别是净再生率 $R_0$ 和代际时间 $T$）对特定年龄存活率变化的敏感性。我们被要求比较幼年死亡率变化与老年死亡率变化的影响。解决方案将首先建立基线人口统计参数，然后计算两种反事实情景下的参数，最后分析结果以证明人口统计敏感性的基本原理。\n\n基本量的定义如下。存活到年龄 $x$ 的存活率，记为 $l_x$，是一个新生儿存活到年龄 $x$ 的概率。它通过 $l_0 = 1$ 和 $l_{x+1} = l_x p_x$ 递归计算，其中 $p_x$ 是从年龄 $x$ 存活到 $x+1$ 的概率。净再生率 $R_0$ 是一个雌性在一生中预期的雌性后代数量，由 $R_0 = \\sum_{x} l_x m_x$ 给出，其中 $m_x$ 是特定年龄的繁殖力。代际时间 $T$ 是一个队列中母亲在产仔时的平均年龄，计算公式为 $T = \\frac{\\sum_{x} x l_x m_x}{R_0}$。\n\n我们首先计算基线情景的生命表和人口统计率。给定的生命率为：\n- 存活概率：$p_0 = 0.6$, $p_1 = 0.8$, $p_2 = 0.7$, $p_3 = 0.5$。\n- 繁殖力：$m_0 = 0$, $m_1 = 0.5$, $m_2 = 1.2$, $m_3 = 1.0$, $m_4 = 0.4$。\n\n存活率表 $l_x$ 计算如下：\n- $l_0 = 1$\n- $l_1 = l_0 p_0 = 1 \\times 0.6 = 0.6$\n- $l_2 = l_1 p_1 = 0.6 \\times 0.8 = 0.48$\n- $l_3 = l_2 p_2 = 0.48 \\times 0.7 = 0.336$\n- $l_4 = l_3 p_3 = 0.336 \\times 0.5 = 0.168$\n\n使用这些值，我们构建基线生命表：\n| 年龄 $x$ | $p_x$ | $m_x$ | $l_x$ | $l_x m_x$ | $x l_x m_x$ |\n|---|---|---|---|---|---|\n| $0$ | $0.6$ | $0$ | $1$ | $0$ | $0$ |\n| $1$ | $0.8$ | $0.5$ | $0.6$ | $0.3$ | $0.3$ |\n| $2$ | $0.7$ | $1.2$ | $0.48$ | $0.576$ | $1.152$ |\n| $3$ | $0.5$ | $1.0$ | $0.336$ | $0.336$ | $1.008$ |\n| $4$ | - | $0.4$ | $0.168$ | $0.0672$ | $0.2688$ |\n\n根据该表，我们计算基线净再生率 $R_{0, \\text{baseline}}$：\n$$R_{0, \\text{baseline}} = \\sum_{x=0}^{4} l_x m_x = 0 + 0.3 + 0.576 + 0.336 + 0.0672 = 1.2792$$\n以及基线代际时间 $T_{\\text{baseline}}$：\n$$\\sum_{x=0}^{4} x l_x m_x = 0 + 0.3 + 1.152 + 1.008 + 0.2688 = 2.7288$$\n$$T_{\\text{baseline}} = \\frac{\\sum x l_x m_x}{R_{0, \\text{baseline}}} = \\frac{2.7288}{1.2792} \\approx 2.1332$$\n\n接下来，我们评估“幼年死亡率变化”情景，其中 $p_0$ 增加 $0.1$。\n$$p_{0, \\text{young}} = 0.6 + 0.1 = 0.7$$\n这一变化从年龄 $1$ 开始，贯穿整个存活率表。新的存活率 $l'_{x}$ 与基线 $l_x$ 在 $x \\ge 1$ 时通过一个常数因子相关联：$l'_{x} = \\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}} l_x = \\frac{0.7}{0.6}l_x$。\n- $l'_{0} = 1$\n- $l'_{1} = 1 \\times 0.7 = 0.7$\n- $l'_{2} = 0.7 \\times 0.8 = 0.56$\n- $l'_{3} = 0.56 \\times 0.7 = 0.392$\n- $l'_{4} = 0.392 \\times 0.5 = 0.196$\n\n新的净再生率 $R_{0, \\text{young}}$ 为：\n$$R_{0, \\text{young}} = \\sum_{x=0}^{4} l'_{x} m_x = (1)(0) + (0.7)(0.5) + (0.56)(1.2) + (0.392)(1.0) + (0.196)(0.4)$$\n$$R_{0, \\text{young}} = 0 + 0.35 + 0.672 + 0.392 + 0.0784 = 1.4924$$\n净再生率的变化为：\n$$\\Delta R_{0,\\text{young}} = R_{0, \\text{young}} - R_{0, \\text{baseline}} = 1.4924 - 1.2792 = 0.2132$$\n计算新的代际时间 $T_{\\text{young}}$。注意，由于 $m_0=0$，$p_0$ 的变化将 $T$ 表达式的分子和分母乘以相同的因子 $\\frac{p_{0, \\text{young}}}{p_{0, \\text{baseline}}}$，因此 $T$ 保持不变。\n$$\\sum_{x=0}^{4} x l'_{x} m_x = 0 + (1)(0.35) + (2)(0.672) + (3)(0.392) + (4)(0.0784) = 3.1836$$\n$$T_{\\text{young}} = \\frac{3.1836}{1.4924} = \\frac{\\frac{7}{6} \\times 2.7288}{\\frac{7}{6} \\times 1.2792} = T_{\\text{baseline}} \\approx 2.1332$$\n\n现在，我们评估“老年死亡率变化”情景。恢复基线生活史，并将 $p_3$ 增加 $0.1$。\n$$p_{3, \\text{old}} = 0.5 + 0.1 = 0.6$$\n这一变化仅影响从年龄 $4$ 开始的存活率。存活率 $l''_{0}, l''_{1}, l''_{2}, l''_{3}$ 与基线值相同。\n- $l''_{4} = l''_{3} p_{3, \\text{old}} = l_{3, \\text{baseline}} \\times 0.6 = 0.336 \\times 0.6 = 0.2016$\n新的净再生率 $R_{0, \\text{old}}$ 通过将年龄到 $3$ 为止的基线贡献相加，再加上年龄 $4$ 的新贡献来计算：\n$$R_{0, \\text{old}} = \\sum_{x=0}^{3} l_x m_x + l''_{4} m_4 = (0 + 0.3 + 0.576 + 0.336) + (0.2016)(0.4)$$\n$$R_{0, \\text{old}} = 1.212 + 0.08064 = 1.29264$$\n净再生率的变化为：\n$$\\Delta R_{0, \\text{old}} = R_{0, \\text{old}} - R_{0, \\text{baseline}} = 1.29264 - 1.2792 = 0.01344$$\n代际时间 $T_{\\text{old}}$ 将会改变，因为最后一个年龄组的相对贡献被改变了。\n$$\\sum_{x=0}^{4} x l''_{x} m_x = (0+0.3+1.152+1.008) + 4 \\times (0.2016)(0.4) = 2.46 + 0.32256 = 2.78256$$\n$$T_{\\text{old}} = \\frac{2.78256}{1.29264} \\approx 2.1526$$\n\n两种情景中 $\\Delta R_{0}$ 量值的差异揭示了一个基本原理。$R_0$ 对存活概率 $p_j$ 变化的敏感性，取决于存活过年龄 $j$ 的个体未来的总繁殖量。$R_0$ 因 $p_j$ 变化而产生的确切变化由以下公式给出：\n$$\\Delta R_0 = \\left(\\frac{p'_{j}}{p_j}-1\\right) \\sum_{x=j+1}^{\\omega} l_x m_x = \\frac{\\Delta p_j}{p_j} \\sum_{x=j+1}^{\\omega} l_x m_x$$\n对于幼年死亡率变化 ($j=0$)：\n$$\\Delta R_{0,\\text{young}} = \\frac{\\Delta p_0}{p_0} \\sum_{x=1}^{4} l_x m_x = \\frac{0.1}{0.6} \\times (0.3 + 0.576 + 0.336 + 0.0672) = \\frac{0.1}{0.6} \\times 1.2792 = 0.2132$$\n这与我们直接计算的结果相符。影响之所以大，是因为早期存活率的提高使得更多个体能够达到所有后续的繁殖年龄。\n对于老年死亡率变化 ($j=3$)：\n$$\\Delta R_{0,\\text{old}} = \\frac{\\Delta p_3}{p_3} \\sum_{x=4}^{4} l_x m_x = \\frac{\\Delta p_3}{p_3} (l_4 m_4) = \\frac{0.1}{0.5} \\times (0.168 \\times 0.4) = \\frac{0.1}{0.5} \\times 0.0672 = 0.01344$$\n这也与我们的计算结果相符。影响之所以小，是因为晚年存活率的提高仅影响最后一个年龄组的繁殖，而该年龄组的存活率 ($l_4$) 较低，繁殖力也只是中等。\n\n问题要求计算这些变化的比率。\n$$\\frac{\\Delta R_{0,\\text{young}}}{\\Delta R_{0,\\text{old}}} = \\frac{0.2132}{0.01344} \\approx 15.863095...$$\n四舍五入到四位有效数字，比率为 $15.86$。这表明，对于这种生活史，与最老年龄组之一相同的绝对变化量相比，种群增长对最幼年龄组存活率 $0.1$ 的绝对变化量的敏感性要高出 $15$ 倍以上。", "answer": "$$\\boxed{15.86}$$", "id": "2491615"}, {"introduction": "在真实世界中，环境并非一成不变，这给人口统计学测量带来了挑战。本练习将引导您区分两个核心概念：时期净生殖率和世代净生殖率。通过分析一个生命率随时间变化的假设情景，您将学会如何在动态环境中准确解读种群的替代水平，这是生态学研究和保护实践中的一项关键技能。[@problem_id:2491639]", "problem": "一个具有年龄结构的脊椎动物种群有年度年龄组 $a=0,1,2,3$，其中年龄为 $a=1,2,3$ 时可以繁殖。日历时间由 $y$ 索引，当前年份表示为 $y=0$。在 $y=0$ 时，从年龄 $a$ 到 $a+1$ 的横断面年龄别存活概率为 $p_0=0.8$，$p_1=0.7$ 和 $p_2=0.6$。在 $y=0$ 时，年龄别雌性后代数/每雌性为 $m_1=0.5$，$m_2=1.0$ 和 $m_3=0.5$。对于在 $y=-2$ 出生的单个真实出生队列，其实现的存活概率为 $p_0=0.6$（在 $y=-2$ 期间从年龄 $0$ 到 $1$），$p_1=0.5$（在 $y=-1$ 期间从年龄 $1$ 到 $2$），以及 $p_2=0.5$（在 $y=0$ 期间从年龄 $2$ 到 $3$）。同一队列实现的年龄别雌性后代数/每雌性为：年龄 $1$ 时（在 $y=-1$ 期间）$m_1=0.3$，年龄 $2$ 时（在 $y=0$ 期间）$m_2=0.7$，以及年龄 $3$ 时（在 $y=1$ 期间）$m_3=0.4$。\n\n仅使用生命表关于跨年龄存活率和年龄别繁殖率的基本思想，从概念上区分队列净繁殖率和根据单一年份横断面生命率构建的时期净繁殖率，并确定在此情景下以下哪些陈述是正确的。选择所有适用的选项。\n\nA. 队列净繁殖率描述了在特定出生年份的新生个体在其生命所经历的实际日历年中，预期产生的雌性后代数量；它衡量了该队列的更替水平。根据 $y=0$ 年的横断面年龄别生命率组合而成的时期净繁殖率，是针对一个在所有年龄都会经历相同生命率的合成队列；它仅在这些生命率预期会持续存在（例如，在恒定或平稳的环境中）时，才是一个合适的更替指数，否则它是在当前条件下的一个瞬时更替指数。\n\nB. 如果在 $y=0$ 时观察到的年龄分布接近稳定年龄分布，那么即使基础生命率随时间变化，时期净繁殖率和队列净繁殖率也必须相等。\n\nC. 根据给定的数据，在 $y=-2$ 出生的队列的队列净繁殖率小于 $1$，而在 $y=0$ 的时期净繁殖率超过 $1$；这说明了环境条件的改善可导致时期指标相对于较早出生的真实队列高估了更替水平。\n\nD. 时期净繁殖率对于任何时变环境都是一个有意义的更替度量，因为它对当时存在的所有年龄进行了平均，因此捕捉了队列历史。\n\nE. 在一个年龄别存活率和生育率不随时间变化的恒定环境中，队列净繁殖率和时期净繁殖率通常是不同的，因为一个是以特定出生年份为条件，而另一个则不是。", "solution": "合适的起点是生命表框架。令 $l_a$ 表示新生个体存活到年龄 $a$ 的存活率，令 $m_a$ 表示年龄别雌性后代数/每雌性。净繁殖率基本上是每个新生个体一生中预期的雌性后代数，即按存活率加权的年龄别繁殖率的总和。\n\n队列构建和时期构建的区别在于 $l_a$ 和 $m_a$ 是如何跨日历时间进行组合的。\n\n1. 队列构建。队列净繁殖率追踪一个真实的出生队列在其所经历的实际日历年中的情况。如果队列出生于 $y=y_0$，其存活到年龄 $1$ 的存活率为 $l_1=p_0(y_0)$，存活到年龄 $2$ 的存活率为 $l_2=p_0(y_0)\\,p_1(y_0+1)$，存活到年龄 $3$ 的存活率为 $l_3=p_0(y_0)\\,p_1(y_0+1)\\,p_2(y_0+2)$，依此类推，其中 $p_a(y)$ 表示在日历年 $y$ 中从年龄 $a$ 存活到 $a+1$ 的概率。其在年龄 $a$ 的年龄别繁殖率为 $m_a(y_0+a)$，即队列年龄为 $a$ 时所在日历年实现的繁殖率。那么队列净繁殖率为\n$$\nR_0^{\\text{cohort}}=\\sum_{a\\ge 0} l_a\\,m_a,\n$$\n其中总和涵盖所有繁殖年龄，使用该队列所经历的实际 $l_a$ 和实际 $m_a$。这个量度量了特定队列的更替水平，是描述其实现更替成功的恰当指标。\n\n2. 时期构建。时期净繁殖率使用来自单个日历年（比如 $y=0$）的横断面年龄别生命率来构建一个合成队列，该队列在每个年龄都将经历相同的生命率。将 $y=0$ 时的时期存活时间表表示为 $p_a^{(0)}$，时期生育率时间表表示为 $m_a^{(0)}$。合成存活率为 $l_0^{(0)}=1$，$l_1^{(0)}=p_0^{(0)}$，$l_2^{(0)}=p_0^{(0)}p_1^{(0)}$，$l_3^{(0)}=p_0^{(0)}p_1^{(0)}p_2^{(0)}$ 等，时期净繁殖率为\n$$\nR_0^{\\text{period}}(y=0)=\\sum_{a\\ge 0} l_a^{(0)}\\,m_a^{(0)}.\n$$\n这个时期 $R_0$ 是一个合成队列更替指数，只有当 $y=0$ 时的生命率在未来的所有年龄都保持不变（例如，在恒定环境中）时，才能严格地解释为新生个体的更替水平。在时变环境中，它是在当前条件下的瞬时更替指数，而不是任何真实队列的实现更替水平。\n\n计算给定数据的这两个量。\n\n$y=-2$ 年出生的队列：\n- 存活率：$l_0=1$，$l_1=p_0(y=-2)=0.6$，$l_2=p_0(y=-2)\\,p_1(y=-1)=0.6\\times 0.5=0.3$，$l_3=p_0(y=-2)\\,p_1(y=-1)\\,p_2(y=0)=0.6\\times 0.5\\times 0.5=0.15$。\n- 实现的 $m_a$：$m_1(y=-1)=0.3$，$m_2(y=0)=0.7$，$m_3(y=1)=0.4$。\n- 队列净繁殖率：\n$$\nR_0^{\\text{cohort}}=l_1 m_1 + l_2 m_2 + l_3 m_3\n= (0.6)(0.3) + (0.3)(0.7) + (0.15)(0.4)\n= 0.18 + 0.21 + 0.06 = 0.45,\n$$\n该值小于 $1$。\n\n$y=0$ 时的时期：\n- 横断面存活率：$p_0^{(0)}=0.8$，$p_1^{(0)}=0.7$，$p_2^{(0)}=0.6$。\n- 合成存活率：$l_0^{(0)}=1$，$l_1^{(0)}=0.8$，$l_2^{(0)}=0.8\\times 0.7=0.56$，$l_3^{(0)}=0.8\\times 0.7\\times 0.6=0.336$。\n- 横断面生育率：$m_1^{(0)}=0.5$，$m_2^{(0)}=1.0$，$m_3^{(0)}=0.5$。\n- 时期净繁殖率：\n$$\nR_0^{\\text{period}}(0)=l_1^{(0)} m_1^{(0)} + l_2^{(0)} m_2^{(0)} + l_3^{(0)} m_3^{(0)}\n= (0.8)(0.5) + (0.56)(1.0) + (0.336)(0.5)\n= 0.4 + 0.56 + 0.168 = 1.128,\n$$\n该值超过 $1$。\n\n解释和条件。在一个年龄别存活率和生育率不随 $y$ 变化的恒定环境中，队列和时期的构建方式是一致的，因此 $R_0^{\\text{cohort}}=R_0^{\\text{period}}$。在这种情况下，通过欧拉-洛特卡关系，更替阈值 $R_0=1$ 精确对应于零内禀增长率 $r=0$，而 $R_01$ 对应于 $r0$。在时变环境中，$R_0^{\\text{period}}$ 是当前生命率下的一个瞬时指数，并不描述实现的队列更替；$R_0^{\\text{cohort}}$ 关系到特定队列的实现历史。当日历时间上的条件改善时，时期 $R_0$ 可能超过 $1$，即使较早的队列具有 $R_0^{\\text{cohort}}  1$，如上面的计算所示。\n\n逐项分析：\n\nA. 该陈述正确地区分了队列构建（特定出生年份的实现历史）和时期构建（当前横断面生命率下的合成队列），并正确地指出了时期度量在何种情况下是合适的更替指数（当生命率持续存在时，如在恒定或平稳环境中），以及在变化条件下它何时是一个瞬时指数。结论：正确。\n\nB. 当生命率随时间变化时，在 $y=0$ 时观察到的年龄分布表观上接近稳定年龄分布，并不能保证队列和时期净繁殖率相等。稳定性要求生命率不随时间变化（或者对于随机稳定性，要求一个明确定义的随机平稳状态），这与“随时间变化”相矛盾。即使年龄分布看起来近似稳定，在时间趋势下，时期和队列的 $R_0$ 通常也不同。结论：不正确。\n\nC. 计算值给出 $R_0^{\\text{cohort}}=0.45$ 和 $R_0^{\\text{period}}(0)=1.128>1$，这说明了环境条件的改善可以产生一个时期度量，该度量相对于较早的队列高估了更替水平。结论：正确。\n\nD. 时期净繁殖率并非对当前年龄分布进行平均，也未捕捉队列历史；它是根据当前的年龄别生命率构建一个合成队列。除了作为在当前生命率持续存在的假设下的瞬时指数外，不能保证它在任意时变环境中作为更替度量是有意义的。结论：不正确。\n\nE. 在恒定环境中，队列和时期的构建方式是一致的，所以它们并非“通常是不同的”。结论：不正确。", "answer": "$$\\boxed{AC}$$", "id": "2491639"}, {"introduction": "虽然净生殖率 ($R_0$) 衡量了世代更替，但内在增长率 ($r$) 才真正描述了种群的长期动态。$r$ 由欧拉-洛特卡方程隐含定义，通常需要数值方法来求解。本练习要求您编写一个程序来精确求解 $r$，并将其与常用近似值进行比较，从而将理论知识转化为实用的计算能力。[@problem_id:2491650]", "problem": "给定由三个对齐数组组成的离散年龄生命表：年龄（年）、存活率和特定年龄生育率。每个生命表指定了年龄 $x$、存活率表 $l_x$（从出生到年龄 $x$ 的存活概率）和生育率表 $m_x$（一个女性在年龄 $x$ 时每年预期的雌性后代数量）。假设环境不随时间变化，且种群为密度无关，因此在人口统计学稳态增长时，种群以恒定的年内禀增长率 $r$ 呈指数增长或下降，并具有稳定的年龄分布。仅使用以下基本基础：存活率 $l_x$、生育率 $m_x$、净生殖率 $R_0$ 和平均世代时间 $T$ 的定义；以及在一个稳定、指数增长的种群中连接 $l_x$、$m_x$ 和 $r$ 的规范平衡条件。从这些基础出发，推导隐式定义 $r$ 的方程，并设计一个数值程序来求解它。然后，从第一性原理计算 $R_0$ 和 $T$，并用它们来构建近似值 $\\ln(R_0)/T$。最后，量化该近似值相对于数值解 $r$ 的近似误差。\n\n实现一个程序，对于测试套件中的每个生命表，计算：\n- 通过求解隐式平衡条件得到的年内禀增长率 $r$。\n- 近似值 $\\widehat{r}=\\ln(R_0)/T$（每年），其中 $R_0$ 是净生殖率，$T$ 是平均世代时间（年）。\n- 绝对误差 $|r-\\widehat{r}|$。\n\n所有答案中，$r$ 和 $\\widehat{r}$ 必须以每年为单位表示，$T$ 必须以年为单位表示。您打印的数值输出应为无量纲的浮点数，并采用下述指定的固定小数格式。\n\n测试套件：\n- 情况 A（中早期繁殖，增长种群）：\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.7,0.6,0.5,0.35,0.2,0.05\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.2,1.5,1.0,0.2,0.0\\,]$\n- 情况 B（延迟繁殖，增长种群）：\n  - $x=\\,[\\,0,1,2,3,4,5,6,7,8,9,10\\,]$\n  - $l_x=\\,[\\,1.0,0.9,0.82,0.74,0.66,0.58,0.5,0.42,0.34,0.26,0.18\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.0,0.0,0.0,0.0,0.8,1.0,1.0,0.6,0.0\\,]$\n- 情况 C（接近更替水平的早期繁殖）：\n  - $x=\\,[\\,0,1,2,3,4,5\\,]$\n  - $l_x=\\,[\\,1.0,0.8,0.65,0.5,0.3,0.1\\,]$\n  - $m_x=\\,[\\,0.0,0.0,1.0,0.9,0.3,0.0\\,]$\n- 情况 D（下降种群）：\n  - $x=\\,[\\,0,1,2,3,4,5,6\\,]$\n  - $l_x=\\,[\\,1.0,0.6,0.4,0.25,0.12,0.05,0.01\\,]$\n  - $m_x=\\,[\\,0.0,0.0,0.7,0.4,0.1,0.0,0.0\\,]$\n\n算法要求：\n- 从第一性原理推导 $r$ 的隐式方程，并在一个保证解的存在性和唯一性的区间内，使用稳健的求根方法进行数值求解，不依赖于任何闭合形式的捷径。\n- 根据定义计算 $R_0=\\sum_x l_x m_x$ 和 $T=\\left(\\sum_x x\\,l_x m_x\\right)/R_0$。\n- 计算 $\\widehat{r}=\\ln(R_0)/T$ 和绝对误差 $|r-\\widehat{r}|$。\n- 将 $r$、$\\widehat{r}$ 和 $|r-\\widehat{r}|$ 四舍五入到 $6$ 位小数进行输出。\n\n最终输出格式：\n- 您的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一种情况，其本身是一个包含三个浮点数 $[r,\\widehat{r},|r-\\widehat{r}|]$ 的列表，每个数字都精确到小数点后 $6$ 位。例如，打印的结构必须类似于 $[[a_1,b_1,c_1],[a_2,b_2,c_2],\\dots]$，不含任何额外文本。\n- 不提供任何输入；程序必须内嵌测试套件并自行运行至完成。", "solution": "该问题陈述科学合理、定义明确、客观，并包含了完整解决方案所需的所有信息。它代表了定量种群生态学中的一个标准练习。因此，将提供一个完整的解决方案。\n\n问题的核心是从一个离散生命表中确定种群的内禀增长率 $r$，并将其与一个常用近似值进行比较。这需要推导并随后数值求解欧拉-洛特卡方程。\n\n**1. 欧拉-洛特卡方程的推导**\n\n该模型假设一个种群具有离散的年龄组 $x = 0, 1, 2, \\dots, \\omega$，其中 $\\omega$ 是最大年龄。设 $N(x, t)$ 为在时间 $t$ 时年龄组 $x$ 中的雌性数量。基本更新过程由两个关系描述：\n\n首先，在时间 $t$ 的新生雌性数量，记为 $N(0, t)$，是所有年龄组中雌性产生的后代总和：\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(x, t) m_x $$\n这里，$m_x$ 是特定年龄繁殖力，即年龄为 $x$ 的雌性平均产生的雌性后代数量。\n\n其次，在时间 $t$ 年龄为 $x$ 的雌性数量，是出生在时间 $t-x$ 并存活到年龄 $x$ 的雌性数量：\n$$ N(x, t) = N(0, t-x) l_x $$\n其中 $l_x$ 是从出生到年龄 $x$ 的存活概率。\n\n将第二个表达式代入第一个，我们将时间 $t$ 的出生数量与之前时间的出生数量联系起来：\n$$ N(0, t) = \\sum_{x=0}^{\\omega} N(0, t-x) l_x m_x $$\n这是种群的广义更新方程。\n\n问题陈述指出，种群以稳定的年龄结构呈指数增长。这意味着种群规模，特别是新生儿数量，以一个恒定的内禀增长率 $r$ 增长：\n$$ N(0, t) = N(0, 0) e^{rt} $$\n其中 $N(0, 0)$ 是 $t=0$ 时的新生儿数量。由此，时间 $t-x$ 的新生儿数量可以表示为：\n$$ N(0, t-x) = N(0, 0) e^{r(t-x)} = (N(0, 0) e^{rt}) e^{-rx} = N(0, t) e^{-rx} $$\n\n将此代回更新方程得到：\n$$ N(0, t) = \\sum_{x=0}^{\\omega} \\left( N(0, t) e^{-rx} \\right) l_x m_x $$\n对于一个非灭绝的种群，$N(0, t)  0$，所以我们可以将两边都除以 $N(0, t)$。这就得到了规范平衡条件，即离散时间欧拉-洛特卡方程，它隐式地定义了 $r$：\n$$ 1 = \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} $$\n\n**2. 内禀增长率 $r$ 的数值解**\n\n为了求出 $r$，我们必须解方程 $f(r) = 0$，其中：\n$$ f(r) = \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) - 1 $$\n为确保唯一解的存在并能通过数值方法找到，我们检查 $f(r)$ 的性质。它关于 $r$ 的导数是：\n$$ f'(r) = \\frac{d}{dr} \\left( \\sum_{x=0}^{\\omega} l_x m_x e^{-rx} \\right) = - \\sum_{x=0}^{\\omega} x l_x m_x e^{-rx} $$\n由于年龄 $x$、存活率 $l_x$ 和繁殖力 $m_x$ 均为非负，且指数项始终为正，导数 $f'(r)$ 严格为负（假设在任何年龄 $x0$ 时都有繁殖发生）。这种单调性保证了如果 $r$ 的根存在，它就是唯一的。\n\n根的存在性由介值定理保证。当 $r \\to \\infty$ 时，$e^{-rx} \\to 0$（对于 $x0$），所以 $f(r) \\to -1$（假设 $m_0=0$）。当 $r \\to -\\infty$ 时，$e^{-rx} \\to \\infty$（对于 $x0$），所以 $f(r) \\to \\infty$。由于 $f(r)$ 是连续的且变号，所以必须存在一个根。\n\n一个稳健的数值方法，如 Brent 方法，如果给定一个区间 $[a,b]$ 使得 $f(a)$ 和 $f(b)$ 异号，就可以找到这个根。一个方便检查的点是 $r=0$：\n$$ f(0) = \\left( \\sum_{x=0}^{\\omega} l_x m_x \\right) - 1 = R_0 - 1 $$\n其中 $R_0$ 是净生殖率。\n- 如果 $R_0  1$，则 $f(0)  0$，根 $r$ 必须为正。\n- 如果 $R_0  1$，则 $f(0)  0$，根 $r$ 必须为负。\n- 如果 $R_0 = 1$，则 $f(0) = 0$，根为 $r=0$。\n对于具有现实人口统计率的种群，一个如 $[-1, 1]$ 的求根区间通常是足够的。\n\n**3. 辅助人口统计学参数的计算**\n\n问题还要求计算净生殖率 ($R_0$)、平均世代时间 ($T$) 和 $r$ 的一个近似值 ($\\widehat{r}$)。\n\n- **净生殖率 ($R_0$)**：$R_0$ 是一个雌性在其一生中预期的雌性后代数量。对于离散年龄组，它通过对特定年龄存活率和繁殖力的乘积求和来计算：\n$$ R_0 = \\sum_{x=0}^{\\omega} l_x m_x $$\n\n- **平均世代时间 ($T$)**：$T$ 是一批新生儿中母亲的平均年龄。它是特定年龄净生殖表 $l_x m_x$ 的均值：\n$$ T = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{\\sum_{x=0}^{\\omega} l_x m_x} = \\frac{\\sum_{x=0}^{\\omega} x l_x m_x}{R_0} $$\n\n- **$r$ 的近似值 ($\\widehat{r}$)**：一个广泛使用的 $r$ 的近似值是：\n$$ \\widehat{r} = \\frac{\\ln(R_0)}{T} $$\n该近似值由欧拉-洛特卡方程在 $r=0$ 附近的一阶泰勒级数展开推导而来，对于接近更替水平（即 $R_0 \\approx 1$）的种群最为准确。\n\n**4. 量化近似误差**\n\n通过计算数值解 $r$ 和近似值 $\\widehat{r}$ 之间的绝对误差来评估近似的准确性：\n$$ \\text{误差} = |r - \\widehat{r}| $$\n\n实现将遵循这些推导，使用数值库进行高效计算和求根。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for demographic rates r, r_hat, and their error for a suite of life tables.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A (early-to-mid reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.7, 0.6, 0.5, 0.35, 0.2, 0.05],\n            \"mx\": [0.0, 0.0, 1.2, 1.5, 1.0, 0.2, 0.0],\n        },\n        {\n            \"name\": \"Case B (delayed reproduction, growing)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10],\n            \"lx\": [1.0, 0.9, 0.82, 0.74, 0.66, 0.58, 0.5, 0.42, 0.34, 0.26, 0.18],\n            \"mx\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 1.0, 1.0, 0.6, 0.0],\n        },\n        {\n            \"name\": \"Case C (near-replacement with early reproduction)\",\n            \"x\": [0, 1, 2, 3, 4, 5],\n            \"lx\": [1.0, 0.8, 0.65, 0.5, 0.3, 0.1],\n            \"mx\": [0.0, 0.0, 1.0, 0.9, 0.3, 0.0],\n        },\n        {\n            \"name\": \"Case D (declining population)\",\n            \"x\": [0, 1, 2, 3, 4, 5, 6],\n            \"lx\": [1.0, 0.6, 0.4, 0.25, 0.12, 0.05, 0.01],\n            \"mx\": [0.0, 0.0, 0.7, 0.4, 0.1, 0.0, 0.0],\n        }\n    ]\n\n    results_for_print = []\n    \n    for case in test_cases:\n        x = np.array(case[\"x\"], dtype=float)\n        lx = np.array(case[\"lx\"], dtype=float)\n        mx = np.array(case[\"mx\"], dtype=float)\n\n        # 1. Calculate Net Reproductive Rate (R0)\n        # R0 = sum(lx * mx)\n        R0 = np.sum(lx * mx)\n\n        # 2. Solve for the intrinsic rate of increase (r) using the Euler-Lotka equation.\n        # The equation is: sum(lx * mx * exp(-r*x)) = 1\n        # We find the root of the function f(r) = sum(lx * mx * exp(-r*x)) - 1\n        def euler_lotka_func(r_val):\n            return np.sum(lx * mx * np.exp(-r_val * x)) - 1.0\n\n        # If R0 is exactly 1, r is 0. Otherwise, solve numerically.\n        if np.isclose(R0, 1.0):\n            r = 0.0\n        else:\n            # A search bracket of [-1, 1] is robust for typical ecological data.\n            try:\n                r = brentq(euler_lotka_func, -1.0, 1.0)\n            except ValueError:\n                # In case the root is not in [-1, 1], expand the search.\n                # This is unlikely for the given test cases.\n                r = brentq(euler_lotka_func, -5.0, 5.0)\n\n        # 3. Calculate Mean Generation Time (T)\n        # T = sum(x * lx * mx) / R0\n        # If R0 is 0, T is undefined. However, mx values ensure R0 > 0 here.\n        if R0 > 0:\n            T = np.sum(x * lx * mx) / R0\n        else:\n            # This case should not be reached with the provided data.\n            T = np.nan\n\n        # 4. Calculate the approximation r_hat\n        # r_hat = ln(R0) / T\n        if R0 > 0 and T > 0:\n            r_hat = np.log(R0) / T\n        else:\n            r_hat = 0.0 if np.isclose(R0, 1.0) else np.nan\n\n        # 5. Calculate the absolute error\n        error = np.abs(r - r_hat)\n\n        # Append formatted results for the current case\n        sub_list = [f\"{val:.6f}\" for val in [r, r_hat, error]]\n        results_for_print.append(f\"[{','.join(sub_list)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_for_print)}]\")\n\nsolve()\n```", "id": "2491650"}]}