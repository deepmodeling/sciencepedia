## 引言
估算野生动物种群的规模是生态学、进化生物学和保护管理中的一个核心挑战。由于几乎不可能对所有个体进行计数，研究人员必须依赖统计方法从不完整的观测数据中推断种群丰度。[标记重捕法](@entry_id:143626)正是应对这一挑战的最强大、最灵活的工具之一。它通过标记一部分个体，然后在随后的抽样中记录重捕到的标记个体比例，从而对整个种群的规模进行科学估计。这种方法不仅提供了一个数字，更是一个理解[种群动态](@entry_id:136352)、评估管理干预效果和检验生态学理论的窗口。

然而，从原始的捕获数据到可靠的种群估计之间，存在着一系列复杂的统计原理和必须满足的假设。本文旨在系统性地揭示[标记重捕法](@entry_id:143626)的全貌，为读者构建一个从理论到实践的完整知识框架。

在“原理与机制”一章中，我们将深入探讨[标记重捕](@entry_id:150045)模型背后的统计学基础，从经典的封闭种群模型出发，逐步解析更复杂的模型变体，并引入直接估计密度的空间[标记重捕](@entry_id:150045)（SCR）框架。接着，在“应用与跨学科[交叉](@entry_id:147634)”一章中，我们将展示这些方法如何应用于真实世界的生态学问题，如何检验进化假说，以及如何与[基因组学](@entry_id:138123)等前沿领域[交叉](@entry_id:147634)融合，为保护生物学提供关键信息。最后，在“动手实践”部分，我们将通过具体的计算练习，巩固读者对核心概念的理解，并掌握从数据到结论的关键技能。通过这三部分的学习，读者将不仅学会“如何”使用[标记重捕法](@entry_id:143626)，更能深刻理解其“为何”如此重要。

## 原理与机制

本章将深入探讨用于估算种群丰度的[标记重捕法](@entry_id:143626)的核心原理与机制。在前一章介绍其基本背景后，我们将系统地剖析这些统计模型背后的理论基础，从最经典的封闭种群模型出发，逐步扩展到更复杂、更现实的框架，包括开放种群模型和空间模型。本章的目标是不仅阐明“如何”使用这些方法，更要解释“为何”这些方法能够奏效，以及它们所依赖的关键假设。

### 封闭种群模型的基础

[标记重捕](@entry_id:150045)分析的起点是**封闭种群 (closed population)** 的概念。这一概念构成了许多基础估算方法的基石。一个种群被称为封闭的，是指在研究期间，其成员数量保持恒定。为了满足这一条件，必须同时满足两个核心假设：

1.  **种群统计学封闭 (Demographic Closure)**：在整个抽样期间，没有个体出生或死亡。
2.  **地理学封闭 (Geographic Closure)**：在整个抽样期间，没有个体通过迁入 (immigration) 或迁出 (emigration) 进入或离开研究区域。

这些假设共同确保了我们试图估算的总体数量 $N$ 是一个固定的、不变的参数。因此，研究人员在设计研究时，必须审慎地定义其**目标种群 (target population)**，确保该定义与封闭性假设在理论上是一致的。例如，一项旨在估算某个保护区内某种两栖动物丰度的研究，如果采用封闭种群模型，其目标种群必须严格定义为在整个抽样期间（例如，连续四个晚上）持续存在于保护区边界内的所有个体。任何跨越边界的暂时性移动都会违反地理封闭假设，从而可能导致估算结果产生偏差或使其解释变得困难 [@problem_id:2700046]。

#### 基本原理：两样本下的超几何模型

理解封闭种群模型最简单的方式，是通过一个只有两次抽样（$t=1$ 和 $t=2$）的研究。这通常被称为**林肯-彼得森 (Lincoln-Petersen) 估计**。其逻辑直观且优雅：

在第一次抽样中，我们捕捉、标记并释放 $M$ 个个体。这些个体随后返回种群中，并与未标记的个体混合。在第二次抽样中，我们捕捉了 $C$ 个个体，发现其中有 $R$ 个是之前被标记过的。

核心思想是，第二次抽样中已标记个体的比例（$\frac{R}{C}$）应该能反映整个种群中已标记个体的比例（$\frac{M}{N}$）。由此，我们可以推导出丰度的估计值：

$$ \frac{R}{C} \approx \frac{M}{N} \implies \hat{N} = \frac{M \cdot C}{R} $$

这个直观的比例关系背后，是一个严谨的概率模型：**超几何模型 (hypergeometric model)**。我们可以将第二次抽样想象成一个经典的“瓮中抽球”问题：种群这个“瓮”里有 $N$ 个“球”，其中 $M$ 个是已标记的（一种颜色），$N-M$ 个是未标记的（另一种颜色）。我们从中不放回地抽取 $C$ 个球，观察到 $R$ 个标记球的概率由[超几何分布](@entry_id:193745)给出 [@problem_id:2523146]：

$$ P(R=r) = \frac{\binom{M}{r} \binom{N-M}{C-r}}{\binom{N}{C}} $$

这个公式的成立依赖于一套严格的假设，这些假设是所有封闭种群模型的基础 [@problem_id:2523146] [@problem_id:2538661]：

1.  **种群封闭**：如上所述，在两次抽样之间，$N$ 必须恒定。这保证了“瓮”中的总球数和两种颜色球的数量（分别为 $M$ 和 $N-M$）是固定的。
2.  **标记保持与识别**：所有在第一次抽样中施加的标记都必须完好无损地保留到第二次抽样，并且能被准确无误地识别出来。标记丢失或误认会改变分子中组合数 $\binom{M}{r}$ 的[有效值](@entry_id:276804) $M$ 或观测值 $r$，从而破坏模型的有效性。
3.  **标记不影响个体**：标记行为本身不能影响个体的生存概率或其在未来被捕捉的概率。
4.  **[机会均等](@entry_id:637428)的可捕获性 (Equal Catchability)**：在第二次抽样时，种群中的每一个个体（无论是否被标记）都有完全相同的机会被捕获。这是确保第二次抽样可以被视为一次简单随机抽样的关键，从而使得所有 $\binom{N}{C}$ 种可能的样本组合都是等概率的。如果某些个体比其他个体更容易被捕获（例如，因为陷阱偏好或个体行为差异），这个假设就被违反了，超几何模型将不再适用，通常会导致一种名为“非中心[超几何分布](@entry_id:193745)”的更复杂的模型。
5.  **瞬时抽样 (Instantaneous Sampling)**：每次抽样的时间相对于动物的移动和[种群动态](@entry_id:136352)过程来说足够短，可以被视为一个时间点。这确保了抽样是“不放回”的——即在一个抽样期内，个体不会被捕捉、处理、释放后再次被捕捉。如果抽样时间过长，导致个体可以重复进入可捕捉池，那么模型将从[超几何分布](@entry_id:193745)（不放回）转变为二项分布（有放回）。

### 构建[似然函数](@entry_id:141927)与模型扩展

当研究包含多于两次（即 $K$ 次）的抽样时，我们可以利用每个个体完整的**捕获历史 (capture history)** 来构建一个更强大的[统计模型](@entry_id:165873)。捕获历史通常表示为一个长度为 $K$ 的二[进制](@entry_id:634389)向量，例如 `1010` 表示一个个体在第1和第3次抽样中被捕获，但在第2和第4次中未被捕获。

#### 基于多项式框架的[似然函数](@entry_id:141927)

在最简单的模型（即 **$M_0$ 模型**）中，我们假设在所有 $K$ 次抽样中，每个个体的捕获概率 $p$ 都是恒定且独立的。在这种情况下，一个特定个体在 $K$ 次抽样中被捕获 $j$ 次的概率遵循[二项分布](@entry_id:141181)。整个种群的 $N$ 个个体可以被看作是进行了一次多项式试验，每个个体被分到 $K+1$ 个类别之一（被捕获0次，1次，...，K次）。

由此，我们可以构建关于参数 $N$ 和 $p$ 的**[似然函数](@entry_id:141927) (likelihood function)**。该函数表示在给定参数值的情况下，观察到我们实际数据集（即每个捕获频率 $f_j$ 的个体数量，其中 $f_j$ 是被捕获了 $j$ 次的个体数）的概率。这个似然函数可以被精简地表达为 [@problem_id:2523121]：

$$ L(N,p \mid \{f_j\}) = \frac{N!}{(N-n_{\cdot})! \prod_{j=1}^{K} f_j!} \left( \prod_{j=1}^{K} \binom{K}{j}^{f_j} \right) p^{\sum j f_j} (1-p)^{KN - \sum j f_j} $$

其中，$n_{\cdot} = \sum_{j=1}^{K} f_j$ 是被捕获过的不同个体的总数。这个公式的核心在于，它不仅考虑了被观察到的个体，还通过 $(N-n_{\cdot})!$ 和 $(1-p)^{K(N-n_{\cdot})}$ 项，考虑了 $N-n_{\cdot}$ 个从未被我们观察到的个体。这些从未被捕获的个体为估算总数 $N$ 提供了关键信息。

#### 放宽“[机会均等](@entry_id:637428)的可捕获性”假设

“[机会均等](@entry_id:637428)的可捕获性”是[标记重捕](@entry_id:150045)模型中最常被违反的假设之一。幸运的是，我们可以通过构建一系列更复杂的模型来系统地处理这个问题。Otis等人（1978）提出的经典框架，为我们提供了几种标准的模型变体 [@problem_id:2523181]：

*   **$M_0$ (空模型)**：最基础的模型，假设捕获概率 $p$ 对所有个体和所有时间都恒定。它只有2个参数：$N$ 和 $p$。
*   **$M_t$ (时间变异模型)**：假设捕获概率随时间（即抽样场合）变化，但在任何给定时间对所有个体都相同。即 $p_t$。它有 $K+1$ 个参数：$N$ 和 $K$ 个不同的捕获概率 $\{p_1, p_2, \ldots, p_K\}$。
*   **$M_b$ (行为响应模型)**：假设个体的捕获概率会因其首次被捕获而改变。这通常被称为“陷阱效应”（trap-response）。例如，“陷阱害羞”(trap-shy)的动物在首次被捕后会变得更难捕捉，而“陷阱愉悦”(trap-happy)的动物则相反。该模型有两个捕获概率：首次捕捉的概率 $p$ 和重捕概率 $c$。它有3个参数：$N$, $p$ 和 $c$。
*   **$M_{tb}$ (时间和行为交互模型)**：这是最复杂的模型之一，它允许捕获概率同时随时间和行为响应而变化。因此，在每个时间点 $t$，都有一个首次捕捉概率 $p_t$ 和一个重捕概率 $c_t$。由于在第一次抽样时不可能有重捕个体，所以 $c_1$ 是不存在的。该模型总共有 $2K$ 个参数：$N$, $K$ 个 $p_t$ 和 $K-1$ 个 $c_t$。

除了这些，还有考虑个体固有[异质性](@entry_id:275678)的模型（$M_h$），它们假设种群由几个具有不同内在捕捉概率的亚群组成。

#### 参数的可识别性问题

随着模型变得越来越复杂，我们必须面对一个关键的统计问题：**可识别性 (identifiability)**。**[结构可识别性](@entry_id:182904) (Structural identifiability)** 是指，理论上我们能否从完美的数据中唯一地确定模型的参数。如果两个不同的参数组合能产生完全相同的观测数据[分布](@entry_id:182848)，那么这些参数就是不可识别的。例如，在一个具有加性效应的[参数化](@entry_id:272587)模型中，如 $\operatorname{logit}(p_{g,t}) = \alpha_{g} + \beta_{t}$，我们可以给所有的 $\alpha_g$ 加上一个常数 $c$，同时从所有的 $\beta_t$ 中减去同一个常数 $c$，而不会改变任何预测的捕获概率。这种固有的参数冗余意味着模型不是结构可识别的。这可以通过检查期望统计量关于参数的**[雅可比矩阵](@entry_id:264467) (Jacobian matrix)** 的秩来诊断。如果矩阵不是满秩的，则存在参数冗余 [@problem_id:2523166]。

另一方面，**实践可识别性 (Practical identifiability)** 关注的是在给定有限且有噪声的数据的情况下，我们能否精确地估计参数。即使一个模型在结构上是可识别的，如果似然函数在某些参数方向上非常平坦，我们可能仍然无法从数据中获得这些参数的稳定估计。

### 模型评估与[不确定性量化](@entry_id:138597)

选择一个合适的模型后，评估其与数据的**[拟合优度](@entry_id:637026) (goodness-of-fit, GOF)** 至关重要。一个常见的现象是**[过度离散](@entry_id:263748) (overdispersion)**，即观测数据的[方差](@entry_id:200758)远大于模型预测的[方差](@entry_id:200758)。这通常是由于未被模型充分解释的变异来源（如未建模的个体[异质性](@entry_id:275678)）造成的。

GO[F检验](@entry_id:274297)（例如基于偏差统计量 $D$ 的检验）可以帮助我们诊断这个问题。在理想情况下，偏差统计量的值应接近其自由度 $\nu$。如果 $D$ 远大于 $\nu$，则表明[模型拟合](@entry_id:265652)不佳，存在[过度离散](@entry_id:263748)。

为了处理[过度离散](@entry_id:263748)，我们可以使用**[准似然](@entry_id:169341) (quasi-likelihood)** 方法。我们计算一个[方差膨胀因子](@entry_id:163660) $\hat{c} = D/\nu$。如果 $\hat{c} > 1$，它就量化了[过度离散](@entry_id:263748)的程度。然后，我们用这个因子来[调整参数](@entry_id:756220)估计的[方差](@entry_id:200758) [@problem_id:2523118]：

$$ \widehat{\operatorname{Var}}_{\text{adj}}(\hat{N}) = \hat{c} \cdot \widehat{\operatorname{Var}}_{\text{model}}(\hat{N}) $$

这种调整会产生更宽的[置信区间](@entry_id:142297)，从而更诚实地反映了由于模型未完全拟合数据而增加的不确定性。例如，一个95%的置信区间通常是在对数尺度上构建，以确保丰度估计不会出现负值，然后通过指数变换返回到原始尺度。

$$ \text{CI}(\log N) = \log(\hat{N}) \pm z_{0.975} \sqrt{\widehat{\operatorname{Var}}_{\text{adj}}(\log \hat{N})} $$

$$ \text{CI}(N) = \exp(\text{CI}(\log N)) $$

### 引入空间维度：空间[标记重捕](@entry_id:150045)模型 (SCR)

传统的封闭种群模型有一个根本性的限制：它们估算的是种群数量 $N$，而不是种群密度 $D$。要将 $N$ 转换为 $D$，研究人员必须定义一个**有效抽样区域 (Effective Sampling Area, ESA)**，但这通常是事后通过一些[启发式方法](@entry_id:637904)（如在陷阱阵列周围添加一个缓冲区）完成的，缺乏客观性和理论依据。

**空间[标记重捕](@entry_id:150045) (Spatial Capture-Recapture, SCR)** 模型通过从根本上改变建模[范式](@entry_id:161181)，完美地解决了这个问题 [@problem_id:2523133]。SCR模型不再将个体视为简单地“在”或“不在”研究区域内，而是明确地将空间维度整合到模型中。其核心组件包括：

1.  **潜在活动中心 (Latent Activity Centers)**：每个个体 $i$ 都有一个未被观察到的活动中心 $\mathbf{s}_i$，其位置被建模为一个空间点过程。最常见的假设是，这些活动中心遵循一个均匀的**泊松点过程 (Poisson point process)**，其强度参数就是我们感兴趣的[种群密度](@entry_id:138897) $D$。
2.  **距离依赖的[探测函数](@entry_id:192756) (Distance-dependent Detection Function)**：个体在陷阱 $j$（位置为 $\mathbf{x}_j$）被探测到的概率不再是一个恒定的 $p$，而是其活动中心 $\mathbf{s}_i$ 与陷阱位置 $\mathbf{x}_j$ 之间距离 $d(\mathbf{s}_i, \mathbf{x}_j)$ 的函数。一个常用的函数是半正态[探测函数](@entry_id:192756)：
    $$ p(d) = p_0 \exp\left(-\frac{d^2}{2\sigma^2}\right) $$
    这里，$p_0$ 是活动中心与陷阱重合时的基础探测概率，$\sigma$ 是决定探测概率随距离衰减速度的空间[尺度参数](@entry_id:268705)。

在这个框架下，**[种群密度](@entry_id:138897) $D$ 成为了模型的一个基本参数**，可以直接从似然函数中进行估计，从而完全避免了定义ESA的需要。SCR模型的[似然函数](@entry_id:141927)是通过对所有个体所有可能的潜在活动中心位置进行积分（即边缘化）来构建的。对于一个由泊松点过程生成的种群，其[边际似然](@entry_id:636856)函数可以表达为 [@problem_id:2523125]：

$$ L(D) \propto D^n \exp\left(-D \int_{\mathcal{S}} p_{\text{det}}(\mathbf{s}) d\mathbf{s}\right) $$

其中，$n$ 是被探测到的个体总数，$\mathcal{S}$ 是状态空间（即潜在的栖息地），$p_{\text{det}}(\mathbf{s})$ 是一个活动中心位于 $\mathbf{s}$ 的个体在整个研究期间至少被探测一次的总概率。这个总探测概率本身是所有陷阱[探测函数](@entry_id:192756)的综合效应。这个积分项有效地计算了整个空间的“探测体积”，使得密度 $D$ 能够被严谨地估计出来。

### 超越封闭性：开放种群模型简介

许多生态学研究的时间跨度很长，无法满足封闭种群的假设。在这些情况下，我们必须使用**开放种群 (open population)** 模型。这些模型允许种群数量因出生、死亡、迁入和迁出而在不同的抽样时期之间发生变化。

研究的目标也随之转变：从估算一个静态的丰度 $N$，转变为估算动态的人口统计学参数，例如：

*   **表观存活率 (Apparent Survival Rate, $\phi_t$)**：个体从时间 $t$ 存活到时间 $t+1$ **并且**仍然留在研究区域内的概率。注意，这种方法无法区分真实的死亡和永久性迁出，因此称之为“表观”存活率。
*   **重捕率 (Recapture Probability, $p_t$)**：在时间 $t$ 存活且在研究区域内的已标记个体，在当次抽样中被成功捕获的概率。
*   **补充量 (Recruitment)**：在两次抽样之间进入种群的新个体数量（通过出生或迁入）。

最基础的开放种群模型是**科马克-乔利-塞伯 (Cormack-Jolly-Seber, CJS)** 模型 [@problem_id:2538661]。CJS模型是**条件模型 (conditional model)**，它仅使用已标记动物的捕获历史来估计表观存活率 $\phi_t$ 和重捕率 $p_t$。它不直接估计种群丰度或补充量。

为了估计丰度，我们需要更全面的模型，如**乔利-塞伯 (Jolly-Seber, JS)** 模型。在JS框架下，区分两种丰度参数非常重要 [@problem_id:2523167]：

*   **特定时间丰度 ($N_t$)**：在时间点 $t$ 时研究区域内的活体总数。
*   **超种群 ($N^*$)**：在整个研究期间，曾经在研究区域内出现过的所有不同个体的总数。

这两个参数在不同的模型变体中变得可识别：

*   **POPAN模型**（一种JS模型的[参数化](@entry_id:272587)形式）将种群视为一个大小为 $N^*$ 的有限超种群，个体在不同时间以一定概率进入可捕获种群。通过对进入过程、存活和探测过程的联合建模，$N^*$ 成为一个可识别的参数。
*   **[鲁棒设计](@entry_id:269442) (Robust Design)** 是一种强大的混合设计，它在每个主要抽样时期（例如，每年夏天）内部进行数次密集的次级抽样。在次级抽样期间，种群可以被认为是封闭的，因此可以使用封闭种群模型直接估计出该时期的丰度 $N_t$。而在主要抽样时期之间，则使用开放种群模型（如CJS）来估计存活率等参数。

本章系统地介绍了[标记重捕法](@entry_id:143626)的核心原理，从封闭种群模型的基本假设和[似然](@entry_id:167119)构建，到处理异质性的模型扩展，再到评估模型拟合度和[量化不确定性](@entry_id:272064)的方法。我们还探讨了如何通过空间[标记重捕](@entry_id:150045)模型直接估计密度，并简要介绍了开放种群模型的基本概念。这些原理共同构成了一个强大而灵活的工具集，为解答生态学和[演化生物学](@entry_id:145480)中的核心问题提供了坚实的定量基础。