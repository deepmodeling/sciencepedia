{"hands_on_practices": [{"introduction": "捕食者-猎物动态系统的学习始于经典的洛特卡-沃尔泰拉（Lotka–Volterra）模型。虽然该模型形式简单，但对其分析能够揭示生态振荡的核心原理。本练习 [@problem_id:2524775] 邀请您运用动态系统研究中的基本工具——相平面分析法，来探究该模型的内在结构。通过计算猎物和捕食者零增长等斜线在共存平衡点的斜率，您将从几何角度揭示为何该经典模型会预测出永续的、中性稳定的种群循环。", "problem": "考虑由以下常微分方程组给出的经典洛特卡-沃尔泰拉捕食者-猎物模型\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t}=\\alpha x-\\beta x y,\\qquad \\frac{\\mathrm{d}y}{\\mathrm{d}t}=\\delta x y-\\gamma y,\n$$\n其中 $x$ 表示猎物密度，$y$ 表示捕食者密度，$\\alpha,\\beta,\\gamma,\\delta$ 为正数。仅使用猎物和捕食者零增长等倾线（zero-growth isoclines）的定义以及平面中关于斜率和角度的标准几何事实，确定在正象限的共存平衡点处，猎物和捕食者零增长等倾线的斜率，并由此推导出在该点处这两条零增长等倾线之间的夹角。将最终的夹角以弧度表示，并给出一个单一的精确值。此外，简要说明这些斜率如何刻画了共存平衡点附近相平面的局部等倾线几何特征。你最终报告的答案必须仅为以弧度表示的夹角，以精确形式给出，无近似，且在最终方框中不带单位。", "solution": "所述问题具有科学依据，提法恰当且客观。这是数学生态学中动力系统分析的一个标准练习，因此是有效的。我们开始求解。\n\n该系统由洛特卡-沃尔泰拉方程描述：\n$$\n\\frac{\\mathrm{d}x}{\\mathrm{d}t} = f(x, y) = \\alpha x - \\beta x y\n$$\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = g(x, y) = \\delta x y - \\gamma y\n$$\n其中 $x$ 是猎物密度，$y$ 是捕食者密度，$\\alpha, \\beta, \\gamma, \\delta$ 为正数。\n\n首先，我们确定零增长等倾线，即相平面上某个种群变化率为零的曲线。\n\n猎物零增长等倾线（或 $x$-零增长等倾线）由条件 $\\frac{\\mathrm{d}x}{\\mathrm{d}t} = 0$ 定义。将第一个方程设为零可得：\n$$\n\\alpha x - \\beta x y = 0 \\implies x(\\alpha - \\beta y) = 0\n$$\n当 $x=0$（$y$轴）或 $\\alpha - \\beta y = 0$ 时，此方程成立，后者可简化为水平线 $y = \\frac{\\alpha}{\\beta}$。\n\n捕食者零增长等倾线（或 $y$-零增长等倾线）由条件 $\\frac{\\mathrm{d}y}{\\mathrm{d}t} = 0$ 定义。将第二个方程设为零可得：\n$$\n\\delta x y - \\gamma y = 0 \\implies y(\\delta x - \\gamma) = 0\n$$\n当 $y=0$（$x$轴）或 $\\delta x - \\gamma = 0$ 时，此方程成立，后者可简化为垂直线 $x = \\frac{\\gamma}{\\delta}$。\n\n系统的平衡点是猎物和捕食者零增长等倾线的交点。问题指定了“正象限中的共存平衡点”，这对应于非平凡零增长等倾线的交点，其中 $x > 0$ 且 $y > 0$。这个我们记为 $(x^*, y^*)$ 的平衡点，通过求解以下方程组得到：\n$$\ny = \\frac{\\alpha}{\\beta}\n$$\n$$\nx = \\frac{\\gamma}{\\delta}\n$$\n因此，共存平衡点位于点 $(x^*, y^*) = \\left(\\frac{\\gamma}{\\delta}, \\frac{\\alpha}{\\beta}\\right)$。由于所有参数均为正，该点确实在第一象限。\n\n现在，我们确定在该平衡点处零增长等倾线的斜率。\n穿过共存平衡点的猎物零增长等倾线是直线 $y = \\frac{\\alpha}{\\beta}$。这是一条水平线。根据定义，任何水平线的斜率都为零。我们记此斜率为 $m_{prey}$。\n$$\nm_{prey} = 0\n$$\n穿过共存平衡点的捕食者零增长等倾线是直线 $x = \\frac{\\gamma}{\\delta}$。这是一条垂直线。任何垂直线的斜率都是无定义的（或无穷大）。我们记此斜率为 $m_{predator}$。\n\n一条水平线和一条垂直线之间的夹角 $\\theta$ 是一个直角。以弧度表示，直角是 $\\frac{\\pi}{2}$。从几何上看，这是不言而喻的。从解析的角度看，如果我们考虑零增长等倾线的切向量，猎物零增长等倾线 $y = \\frac{\\alpha}{\\beta}$ 的一个切向量是 $\\mathbf{v}_{prey} = (1, 0)$，而捕食者零增长等倾线 $x = \\frac{\\gamma}{\\delta}$ 的一个切向量是 $\\mathbf{v}_{predator} = (0, 1)$。它们之间的夹角 $\\theta$ 由点积公式给出：\n$$\n\\cos(\\theta) = \\frac{\\mathbf{v}_{prey} \\cdot \\mathbf{v}_{predator}}{||\\mathbf{v}_{prey}|| \\cdot ||\\mathbf{v}_{predator}||} = \\frac{(1)(0) + (0)(1)}{\\sqrt{1^2+0^2} \\sqrt{0^2+1^2}} = \\frac{0}{1} = 0\n$$\n在 $[0, \\pi]$ 区间内，使 $\\cos(\\theta)=0$ 成立的角度是 $\\theta = \\frac{\\pi}{2}$。零增长等倾线是正交的。\n\n最后，我们说明这些斜率如何刻画局部等倾线的几何特征。向量场 $(\\frac{\\mathrm{d}x}{\\mathrm{d}t}, \\frac{\\mathrm{d}y}{\\mathrm{d}t})$ 在零增长等倾线上具有特定的方向。\n在猎物零增长等倾线（$y = \\frac{\\alpha}{\\beta}$）上，我们有 $\\frac{\\mathrm{d}x}{\\mathrm{d}t}=0$，因此向量场是纯垂直的：$(0, \\delta x y - \\gamma y)$。流是垂直的。\n在捕食者零增长等倾线（$x = \\frac{\\gamma}{\\delta}$）上，我们有 $\\frac{\\mathrm{d}y}{\\mathrm{d}t}=0$，因此向量场是纯水平的：$(\\alpha x - \\beta x y, 0)$。流是水平的。\n在平衡点处零增长等倾线的正交性意味着，解轨迹在穿过猎物零增长等倾线时必须具有垂直的切向量，而在穿过捕食者零增长等倾线时必须具有水平的切向量。这种垂直相交迫使流围绕平衡点旋转，这是经典洛特卡-沃尔泰拉模型中中性稳定中心的特征。零增长等倾线的这种简单的正交几何结构是围绕共存平衡点存在闭合周期轨道的基本原因。", "answer": "$$\\boxed{\\frac{\\pi}{2}}$$", "id": "2524775"}, {"introduction": "经典的洛特卡-沃尔泰拉模型关于猎物无限增长和线性捕食的假设在现实中往往难以成立。罗森茨威格-麦克阿瑟（Rosenzweig–MacArthur）模型通过引入猎物的自我限制（承载力$K$）和捕食者的饱和效应（Holling II型功能反应），描绘了更为复杂的动态行为。本练习 [@problem_id:2524854] 旨在引导您探究著名的“富集悖论”（paradox of enrichment）——即增加猎物的承载力反而可能破坏系统的稳定性。您将运用雅可比矩阵（Jacobian matrix）分析法，寻找系统发生霍普夫分岔（Hopf bifurcation）的临界条件，从而为稳定平衡点如何转变为极限环振荡提供严格的数学解释。", "problem": "一个资源-消费者系统由带有Holling II型功能性反应的Rosenzweig–MacArthur捕食者-猎物方程建模：\n$$\n\\begin{aligned}\n\\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) - \\frac{a N}{1 + a h N}\\, P,\\\\\n\\frac{dP}{dt} = e\\,\\frac{a N}{1 + a h N}\\, P - m P,\n\\end{aligned}\n$$\n其中$N$是猎物密度，$P$是捕食者密度，$r>0$是猎物的内禀增长率，$K>0$是猎物的环境承载力（富集参数），$a>0$是捕食者的攻击率，$h>0$是处理时间，$e \\in (0,1]$是转化效率，$m>0$是捕食者的人均死亡率。假设参数满足$e>m h$，以确保存在唯一的内平衡点。\n\n从平衡点、雅可比线性化、二维常微分方程（ODE）中线性稳定性和Hopf分岔的迹-行列式判据的定义出发，完成以下任务：\n- 用参数表示内平衡点$(N^{\\ast},P^{\\ast})$。\n- 计算在$(N^{\\ast},P^{\\ast})$处的雅可比矩阵，并将其迹和行列式表示为$K$和各参数的函数。\n- 证明在$(N^{\\ast},P^{\\ast})$处的行列式为正，并且当$K$变化时，迹会穿过零点，通过计算在穿过点处的$\\frac{d}{dK}(\\operatorname{tr} J)$来验证非简并性（横截性）条件。\n- 推导当$\\operatorname{tr} J=0$且$\\det J>0$时的精确临界值$K=K_{\\mathrm{H}}$，这意味着当$K$通过$K_{\\mathrm{H}}$时发生Hopf分岔。\n\n请以$a$、$h$、$e$和$m$的单个、简化的解析表达式形式提供您的最终结果$K_{\\mathrm{H}}$。不需要数值近似或四舍五入。只表达最终的$K_{\\mathrm{H}}$；不要包含单位。", "solution": "该问题是数学生态学中动力系统稳定性分析的一个标准练习。它在科学上是合理的，适定的，并包含了所有必要的信息。因此，这是一个有效的问题，我们继续进行解答。\n\n该系统由以下常微分方程给出：\n$$\n\\begin{aligned}\n\\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) - \\frac{a N P}{1 + a h N} \\\\\n\\frac{dP}{dt} = e\\,\\frac{a N P}{1 + a h N} - m P\n\\end{aligned}\n$$\n参数$r, K, a, h, e, m$均为正常数，且$e \\in (0, 1]$。问题陈述中给出了条件$e > m h$，这保证了唯一内平衡点的存在。\n\n首先，我们确定内平衡点$(N^{\\ast}, P^{\\ast})$，其中$N^{\\ast} > 0$且$P^{\\ast} > 0$。该平衡点通过将两个时间导数都设为零来找到。\n由$\\frac{dP}{dt} = 0$，我们有：\n$$\nP \\left( e\\,\\frac{a N}{1 + a h N} - m \\right) = 0\n$$\n由于对于内平衡点$P^{\\ast} \\neq 0$，我们必须有：\n$$\ne\\,\\frac{a N^{\\ast}}{1 + a h N^{\\ast}} - m = 0\n$$\n$$\ne a N^{\\ast} = m(1 + a h N^{\\ast}) = m + m a h N^{\\ast}\n$$\n$$\nN^{\\ast}(e a - m a h) = m\n$$\n$$\nN^{\\ast} = \\frac{m}{a(e - m h)}\n$$\n条件$e > m h$确保$e - m h > 0$，并且由于$a>0$和$m>0$，因此$N^{\\ast} > 0$。\n\n接下来，由$\\frac{dN}{dt} = 0$，我们有：\n$$\nN \\left( r \\left(1 - \\frac{N}{K}\\right) - \\frac{a P}{1 + a h N} \\right) = 0\n$$\n对于内平衡点，$N^{\\ast} \\neq 0$，所以我们必须有：\n$$\nr \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}}\n$$\n我们可以解出$P^{\\ast}$：\n$$\nP^{\\ast} = \\frac{r(1 + a h N^{\\ast})}{a} \\left(1 - \\frac{N^{\\ast}}{K}\\right)\n$$\n为使$P^{\\ast} > 0$，我们需要$1 - \\frac{N^{\\ast}}{K} > 0$，这意味着条件$K > N^{\\ast}$。\n\n接下来，我们计算系统的雅可比矩阵$J$。令$f(N, P) = \\frac{dN}{dt}$和$g(N, P) = \\frac{dP}{dt}$。\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial N} & \\frac{\\partial f}{\\partial P} \\\\ \\frac{\\partial g}{\\partial N} & \\frac{\\partial g}{\\partial P} \\end{pmatrix}\n$$\n偏导数是：\n$$\n\\frac{\\partial f}{\\partial N} = r - \\frac{2 r N}{K} - \\frac{a(1+ahN)P - aNP(ah)}{(1+ahN)^{2}} = r - \\frac{2 r N}{K} - \\frac{a P}{(1 + a h N)^{2}}\n$$\n$$\n\\frac{\\partial f}{\\partial P} = -\\frac{a N}{1 + a h N}\n$$\n$$\n\\frac{\\partial g}{\\partial N} = \\frac{eaP(1+ahN) - eaNP(ah)}{(1+ahN)^{2}} = \\frac{e a P}{(1 + a h N)^{2}}\n$$\n$$\n\\frac{\\partial g}{\\partial P} = \\frac{e a N}{1 + a h N} - m\n$$\n我们在内平衡点$(N^{\\ast}, P^{\\ast})$处计算雅可比矩阵。我们将此矩阵记为$J^{\\ast}$。其元素为$J_{ij}^{\\ast} = J_{ij}|_{(N^{\\ast}, P^{\\ast})}$。\n从捕食者的平衡条件，我们立即看到：\n$$\nJ_{22}^{\\ast} = \\frac{e a N^{\\ast}}{1 + a h N^{\\ast}} - m = 0\n$$\n其他元素是：\n$$\nJ_{11}^{\\ast} = r - \\frac{2 r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$$\nJ_{12}^{\\ast} = -\\frac{a N^{\\ast}}{1 + a h N^{\\ast}}\n$$\n$$\nJ_{21}^{\\ast} = \\frac{e a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$J^{\\ast}$的迹和行列式由下式给出：\n$$\n\\operatorname{tr} J^{\\ast} = J_{11}^{\\ast} + J_{22}^{\\ast} = J_{11}^{\\ast}\n$$\n$$\n\\det J^{\\ast} = J_{11}^{\\ast} J_{22}^{\\ast} - J_{12}^{\\ast} J_{21}^{\\ast} = 0 - \\left(-\\frac{a N^{\\ast}}{1 + a h N^{\\ast}}\\right)\\left(\\frac{e a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\\right) = \\frac{a^{2} e N^{\\ast} P^{\\ast}}{(1 + a h N^{\\ast})^{3}}\n$$\n由于$a, e, N^{\\ast}, P^{\\ast}, h$均为正，显然$\\det J^{\\ast} > 0$。\n\n当$\\operatorname{tr} J^{\\ast} = 0$且$\\det J^{\\ast} > 0$时，发生Hopf分岔。我们已经确定行列式为正。现在我们寻找使迹为零的$K$的条件。\n$$\n\\operatorname{tr} J^{\\ast} = r - \\frac{2 r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}} = 0\n$$\n为简化此表达式，我们使用猎物的平衡条件$r(1 - \\frac{N^{\\ast}}{K}) = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}}$。代入此式，我们可以重写$J_{11}^{\\ast}$：\n$$\nJ_{11}^{\\ast} = \\left(r - \\frac{r N^{\\ast}}{K}\\right) - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}} = r\\left(1 - \\frac{N^{\\ast}}{K}\\right) - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1 + a h N^{\\ast})^{2}}\n$$\n$$\nJ_{11}^{\\ast} = \\frac{a P^{\\ast}}{1 + a h N^{\\ast}} - \\frac{r N^{\\ast}}{K} - \\frac{a P^{\\ast}}{(1+ahN^{\\ast})^{2}} = \\frac{a P^{\\ast}(1+ahN^{\\ast}) - aP^{\\ast}}{(1+ahN^{\\ast})^2} - \\frac{rN^{\\ast}}{K} = \\frac{a^{2} h N^{\\ast} P^{\\ast}}{(1+ahN^{\\ast})^{2}} - \\frac{rN^{\\ast}}{K}\n$$\n我们将迹设为零：\n$$\n\\frac{a^{2} h N^{\\ast} P^{\\ast}}{(1+ahN^{\\ast})^{2}} - \\frac{rN^{\\ast}}{K} = 0\n$$\n由于$N^{\\ast} > 0$，我们可以将其约去：\n$$\n\\frac{a^{2} h P^{\\ast}}{(1+ahN^{\\ast})^{2}} = \\frac{r}{K}\n$$\n代入$P^{\\ast} = \\frac{r(1 + a h N^{\\ast})}{a} (1 - \\frac{N^{\\ast}}{K})$：\n$$\n\\frac{a^{2} h}{(1+ahN^{\\ast})^{2}} \\frac{r(1 + a h N^{\\ast})}{a} \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{r}{K}\n$$\n简化并除以$r$（因为$r>0$）：\n$$\n\\frac{a h}{1 + a h N^{\\ast}} \\left(1 - \\frac{N^{\\ast}}{K}\\right) = \\frac{1}{K}\n$$\n我们求解$K$。两边同乘以$K(1 + a h N^{\\ast})$：\n$$\na h K \\left(1 - \\frac{N^{\\ast}}{K}\\right) = 1 + a h N^{\\ast}\n$$\n$$\na h (K - N^{\\ast}) = 1 + a h N^{\\ast}\n$$\n$$\na h K - a h N^{\\ast} = 1 + a h N^{\\ast}\n$$\n$$\na h K = 1 + 2 a h N^{\\ast}\n$$\n发生分岔时$K$的临界值，我们记为$K_{\\mathrm{H}}$，是：\n$$\nK_{\\mathrm{H}} = \\frac{1 + 2 a h N^{\\ast}}{a h} = \\frac{1}{ah} + 2N^{\\ast}\n$$\n为验证非简并性（横截性）条件，我们必须检查在$K = K_{\\mathrm{H}}$时$\\frac{d}{dK}(\\operatorname{tr} J^{\\ast}) \\neq 0$。\n迹为$\\operatorname{tr} J^{\\ast} = \\frac{r N^{\\ast}}{K(1+ahN^{\\ast})} [ a h K - (1 + 2 a h N^{\\ast}) ]$。对$K$求导：\n$$\n\\frac{d}{dK}(\\operatorname{tr} J^{\\ast}) = \\frac{r N^{\\ast}}{1+ahN^{\\ast}} \\frac{d}{dK} \\left[ a h - \\frac{1 + 2 a h N^{\\ast}}{K} \\right] = \\frac{r N^{\\ast}}{1+ahN^{\\ast}} \\left( \\frac{1 + 2 a h N^{\\ast}}{K^{2}} \\right)\n$$\n由于所有参数和变量均为正，该导数严格为正。横截性条件得到满足。\n\n最后，我们将$N^{\\ast} = \\frac{m}{a(e - m h)}$的表达式代入$K_{\\mathrm{H}}$的方程中：\n$$\nK_{\\mathrm{H}} = \\frac{1}{ah} + 2 \\left( \\frac{m}{a(e - m h)} \\right)\n$$\n为简化，我们通分：\n$$\nK_{\\mathrm{H}} = \\frac{e - m h + 2 m h}{a h (e - m h)} = \\frac{e + m h}{a h (e - m h)}\n$$\n这就是系统经历Hopf分岔时环境承载力的临界值。", "answer": "$$\n\\boxed{\\frac{e+mh}{ah(e-mh)}}\n$$", "id": "2524854"}, {"introduction": "生态互动并非发生在均匀混合的“真空”中，而是在广阔的空间维度上展开。最后的这个实践练习 [@problem_id:2524831] 将带领我们从常微分方程（ODEs）迈向偏微分方程（PDEs），探索空间移动如何催生出复杂的生态格局。您将亲手设计并执行一个反应-扩散（reaction-diffusion）捕食者-猎物系统的数值模拟。通过调整猎物（$u$）和捕食者（$v$）的相对扩散速率（分别为$D_u$和$D_v$），您将直观地见证斑点、条纹等空间结构的涌现，这一现象的背后机制便是由伟大的科学家 Alan Turing 所提出的扩散驱动不稳定性（diffusion-driven instability）。", "problem": "你的任务是设计并实现一个完整且可复现的数值实验，用于研究双物种捕食者-被捕食者在二维离散网格上的动态，其空间运动通过扩散进行建模，并采用无通量（Neumann）边界条件。生态动力学必须是 Lotka–Volterra 框架下的捕食者-被捕食者类型，但要加入猎物自我限制和捕食者饱和效应，以确保存在一个生物学上合理、全局稳定的均匀平衡点，该平衡点在合适的扩散系数对比下可以展现出扩散驱动的模式形成。\n\n起点（基本基础）：\n- 种群密度是空间和时间的函数，猎物密度记为 $u(x,y,t)$，捕食者密度记为 $v(x,y,t)$。\n- 局部动力学由猎物的内禀增长和捕食者-被捕食者相互作用决定，空间运动由 Fickian 扩散描述，其中通量与梯度成正比。无通量边界要求在边界上的法向导数为零。\n- 空间离散化使用均匀的笛卡尔网格和二阶导数的中心差分，时间离散化使用前向欧拉法作为一阶方法。\n\n待模拟的模型：\n- 设局部动力学为猎物的逻辑斯谛增长和捕食的 Holling II 型功能反应（Rosenzweig–MacArthur 形式）：\n  - 猎物：$u$ 以内禀增长率 $r$ 和环境承载力 $K$ 进行逻辑斯谛增长，并以一个随猎物密度饱和的速率被消耗。\n  - 捕食者：$v$ 通过以效率 $e$ 将消耗的猎物转化为捕食者生物量而增加，其死亡率为 $m$。\n- 加入空间扩散，猎物和捕食者的扩散系数分别为 $D_u$ 和 $D_v$，使得空间扩展动力学满足\n  $$\n  \\frac{\\partial u}{\\partial t} = D_u \\nabla^2 u + f(u,v), \\quad \\frac{\\partial v}{\\partial t} = D_v \\nabla^2 v + g(u,v),\n  $$\n  其中 $f(u,v)$ 和 $g(u,v)$ 是由 Rosenzweig–MacArthur 相互作用定义的局部动力学。\n\n需实现的科学细节：\n1. 设局部动力学为\n   - $f(u,v) = r u \\left(1 - \\frac{u}{K}\\right) - \\frac{a u}{1 + h a u} v$,\n   - $g(u,v) = e \\frac{a u}{1 + h a u} v - m v$,\n   参数固定如下：\n   - $r = 1.0$,\n   - $K = 1.0$,\n   - $a = 2.0$,\n   - $h = 0.5$,\n   - $e = 0.6$,\n   - $m = 0.4$。\n2. 计算由局部动力学所蕴含的唯一正均匀平衡点 $(u^\\ast,v^\\ast)$（即，求解 $f(u^\\ast,v^\\ast) = 0$ 和 $g(u^\\ast,v^\\ast) = 0$ 以得到 $u^\\ast > 0$ 和 $v^\\ast > 0$），并在此平衡点附近用一个小的空间结构化微扰来初始化空间场：\n   $$\n   u_{i,j}(0) = u^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right], \\quad\n   v_{i,j}(0) = v^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right],\n   $$\n   其中 $i,j$ 是整数网格索引，角度以弧度为单位，$\\epsilon = 0.01$ 是微扰振幅。\n3. 使用一个大小为 $N \\times N$（其中 $N = 64$）的二维方形网格，空间步长 $dx = 1$（任意长度单位），显式前向欧拉时间步长 $dt = 0.01$（任意时间单位），并模拟到最终时间 $T = 10$（即恰好 $T/dt = 1000$ 个时间步）。\n4. 通过与中心差分五点拉普拉斯算子一致的离散格式来强制执行无通量边界条件（法向导数为零）。实现离散拉普拉斯算子的方法是：将数组嵌入一层通过跨边界反射构建的虚拟节点（使得一个虚拟节点的值等于第一个内部节点的值，从而在边界上强制一阶导数为零），然后应用标准的五点模板；等效地，用单层镜像反射填充场，并使用其四个最近邻居之和减去中心点值的4倍来近似内部点的 $dx^2 \\nabla^2$。\n5. 在每次更新后，通过将 $u$ 和 $v$ 的下界限定为 $0$ 来确保数值的非负性（以避免因数值误差产生负密度），而不改变其他动力学行为。\n\n定量模式度量：\n- 为了量化空间结构的出现和持续性，在最终时间使用 II 型离散余弦变换 (DCT) 计算最强的非零空间模式相对于均匀模式的主导地位，这在 Neumann（无通量）边界条件下是很自然的：\n  1. 设 $\\mathcal{C}[u]$ 表示在 $t = T$ 时猎物场 $u$ 的二维、正交归一化的 II 型 DCT。\n  2. 设 $P_{k,\\ell} = \\left(\\mathcal{C}[u]_{k,\\ell}\\right)^2$ 为模式 $(k,\\ell)$ 处的功率。\n  3. 定义谱主导指数\n     $$\n     S = \\frac{\\max\\{ P_{k,\\ell} : (k,\\ell) \\neq (0,0) \\}}{P_{0,0}}.\n     $$\n  指数 $S$ 是一个非负实数；较大的值表示更强的空间结构（相对于空间平均值）。\n\n测试套件：\n- 对扩散系数 $(D_u,D_v)$ 使用以下三组参数，同时保持所有其他参数和数值设置如上所述：\n  1. 情况 A（捕食者扩散更快）：$(D_u,D_v) = (0.01, 0.50)$。\n  2. 情况 B（扩散速度相等）：$(D_u,D_v) = (0.10, 0.10)$。\n  3. 情况 C（猎物扩散更快）：$(D_u,D_v) = (0.20, 0.01)$。\n  \n对于每种情况，运行模拟并计算最终时间 $T$ 时猎物的谱主导指数 $S$。要求的程序输出为单行文本，包含一个由三个浮点数组成的列表，按顺序对应 $(S_{\\text{A}}, S_{\\text{B}}, S_{\\text{C}})$，每个数值都四舍五入到恰好 $6$ 位小数。该行必须格式化为无空格的逗号分隔的类 Python 列表，例如，“[0.123456,0.234567,0.345678]”。\n\n你的程序必须是完全自包含的，不接收任何输入，并以指定格式精确输出一行。所有三角函数表达式中的角度都必须解释为弧度。最终的数值答案不需要物理单位，因为所提出的模型是无量纲的。", "solution": "我们使用一个反应扩散框架来模拟空间捕食者-被捕食者系统，该框架基于 Fick 扩散定律和标准的捕食者-被捕食者动力学，后者扩展了 Lotka–Volterra 相互作用，包含了猎物自我限制和捕食者饱和。设 $u(x,y,t)$ 为猎物密度，$v(x,y,t)$ 为捕食者密度。\n\n1. 从第一性原理构建模型：\n   - Fickian 扩散假定扩散通量 $\\mathbf{J}$ 与密度的负梯度成正比，即 $\\mathbf{J}_u = - D_u \\nabla u$ 和 $\\mathbf{J}_v = - D_v \\nabla v$，其中 $D_u$ 和 $D_v$ 是恒定的扩散系数。质量守恒意味着 $\\partial u/\\partial t = -\\nabla \\cdot \\mathbf{J}_u + f(u,v)$ 和 $\\partial v/\\partial t = -\\nabla \\cdot \\mathbf{J}_v + g(u,v)$，从而得到反应扩散方程\n     $$\n     \\frac{\\partial u}{\\partial t} = D_u \\nabla^2 u + f(u,v), \\quad \\frac{\\partial v}{\\partial t} = D_v \\nabla^2 v + g(u,v).\n     $$\n   - Rosenzweig–MacArthur 捕食者-被捕食者动力学提供了\n     $$\n     f(u,v) = r u \\left(1 - \\frac{u}{K}\\right) - \\frac{a u}{1 + h a u} v,\\quad\n     g(u,v) = e \\frac{a u}{1 + h a u} v - m v,\n     $$\n     其中 $r$ 是猎物内禀增长率，$K$ 是环境承载力，$a$ 是攻击率，$h$ 是处理时间，$e$ 是转化效率，$m$ 是捕食者死亡率。\n\n2. 均匀平衡点：\n   - 在一个空间均匀的稳态 $(u^\\ast,v^\\ast)$ 处，我们有 $f(u^\\ast,v^\\ast) = 0$ 和 $g(u^\\ast,v^\\ast) = 0$。对于 $v^\\ast > 0$，捕食者方程简化为\n     $$\n     e \\frac{a u^\\ast}{1 + h a u^\\ast} = m.\n     $$\n     解出 $u^\\ast$ 得\n     $$\n     u^\\ast = \\frac{m}{a(e - m h)},\n     $$\n     前提是 $e - m h > 0$。已知 $u^\\ast$ 后，$v^\\ast$ 可从猎物方程中求出。将 $f(u^\\ast,v^\\ast) = 0$ 两边同除以 $u^\\ast > 0$ 得\n     $$\n     r \\left(1 - \\frac{u^\\ast}{K}\\right) = \\frac{a}{1 + h a u^\\ast} v^\\ast \\quad \\Rightarrow \\quad\n     v^\\ast = \\frac{r \\left(1 - \\frac{u^\\ast}{K}\\right) \\left(1 + h a u^\\ast\\right)}{a}.\n     $$\n   - 参数为 $r = 1.0, K = 1.0, a = 2.0, h = 0.5, e = 0.6, m = 0.4$，我们有 $e - m h = 0.6 - 0.4 \\cdot 0.5 = 0.4 > 0$，所以\n     $$\n     u^\\ast = \\frac{0.4}{2.0 \\cdot 0.4} = 0.5, \\quad\n     v^\\ast = \\frac{1.0 \\cdot \\left(1 - 0.5\\right) \\cdot \\left(1 + 0.5 \\cdot 2.0 \\cdot 0.5\\right)}{2.0} = \\frac{0.5 \\cdot 1.5}{2.0} = 0.375.\n     $$\n\n3. 边界条件与空间离散化：\n   - 无通量（Neumann）边界条件指定法向导数在边界处为零：$\\partial u/\\partial n = 0$ 和 $\\partial v/\\partial n = 0$。在均匀网格（间距为 $dx$）的有限差分背景下，标准的五点模板近似了内部网格点 $(i,j)$ 处的拉普拉斯算子\n     $$\n     \\left(\\nabla^2 w\\right)_{i,j} \\approx \\frac{w_{i+1,j} + w_{i-1,j} + w_{i,j+1} + w_{i,j-1} - 4 w_{i,j}}{dx^2}.\n     $$\n   - Neumann 条件通过构建跨边界镜像反射的虚拟节点来强制执行。对于 $i=0$ 处的左边界，位于 $i=-1$ 的虚拟节点值被设为 $w_{1,j}$，以强制执行离散对称性，从而使边界处的一阶导数为零。这同样适用于所有边界。等效地，在所有方向上用一个单元格的镜像反射来填充数组，并对未填充的内部应用五点模板；这将产生一个与法向导数为零一致的离散拉普拉斯算子。\n\n4. 时间积分与稳定性考虑：\n   - 我们使用时间步长为 $dt$ 的前向欧拉法。每个时间步的离散更新为\n     $$\n     u^{n+1} = u^n + dt \\left( D_u \\nabla^2 u^n + f(u^n, v^n) \\right), \\quad\n     v^{n+1} = v^n + dt \\left( D_v \\nabla^2 v^n + g(u^n, v^n) \\right).\n     $$\n     在我们的测试套件中，$dx = 1$ 且最大扩散系数 $D_{\\max} \\leq 0.50$，显式扩散稳定性约束 $dt \\lesssim \\frac{dx^2}{4 D_{\\max}}$ 表明 $dt \\leq 0.5$。选择 $dt = 0.01$ 是保守且稳定的。反应项可能会施加额外的约束；所选的参数和步长足够小以保持稳定性。我们还在每次更新后强制执行 $u \\geq 0$ 和 $v \\geq 0$ 以保持生物学上的非负性。\n\n5. 初始化：\n   - 我们在 $(u^\\ast,v^\\ast)$ 附近用一个振幅为 $\\epsilon = 0.01$ 的小空间微扰和单个余弦模式进行初始化：\n     $$\n     u_{i,j}(0) = u^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right], \\quad\n     v_{i,j}(0) = v^\\ast \\left[1 + \\epsilon \\cos\\left(\\frac{2\\pi i}{N}\\right) \\cos\\left(\\frac{2\\pi j}{N}\\right)\\right],\n     $$\n     其中 $i,j \\in \\{0,1,\\dots,N-1\\}$，角度以弧度为单位，$N = 64$，$dx = 1$。\n\n6. 使用离散余弦变换进行模式量化：\n   - 在 Neumann 边界条件下，自然的标准正交基由余弦模式构成。因此，我们在最终时间 $T$ 计算带有正交归一化的二维 II 型离散余弦变换 $\\mathcal{C}[u]$。模式 $(k,\\ell)$ 处的功率为 $P_{k,\\ell} = \\left(\\mathcal{C}[u]_{k,\\ell}\\right)^2$。谱主导指数为\n     $$\n     S = \\frac{\\max\\{ P_{k,\\ell} : (k,\\ell) \\neq (0,0) \\}}{P_{0,0}}.\n     $$\n     此处，$P_{0,0}$ 对应于平均（均匀）模式的平方，分子则选取了最强的空间异质性。较大的 $S$ 值表示相对于平均值更强的空间模式。\n\n7. 相对扩散速率的影响：\n   - 情况 A 中 $(D_u,D_v) = (0.01, 0.50)$，捕食者的扩散远快于猎物，这会产生经典的短程激活（猎物）和长程抑制（捕食者）结构。即使没有严格的 Turing 不稳定性，与猎物扩散更强的情况相比，这也倾向于保持或放大猎物的非均匀性，从而产生更大的 $S$ 值。\n   - 情况 B 中 $(D_u,D_v) = (0.10, 0.10)$，两种物种的扩散速度相同，这倾向于均匀地平滑扰动，从而产生中等或较低的 $S$ 值。\n   - 情况 C 中 $(D_u,D_v) = (0.20, 0.01)$，猎物的扩散比捕食者快，这会迅速使猎物均匀化并抑制空间变化，从而导致三个情况中最小的 $S$ 值。\n\n8. 算法：\n   - 预先计算 $(u^\\ast,v^\\ast)$。\n   - 用指定的余弦微扰初始化 $u$ 和 $v$。\n   - 对于 $n = 1$ 到 $T/dt$：\n     - 使用单层镜像填充和五点模板计算 $\\nabla^2 u$ 和 $\\nabla^2 v$。\n     - 用前向欧拉法更新 $u$ 和 $v$。\n     - 通过在零处截断来强制执行 $u \\geq 0$ 和 $v \\geq 0$。\n   - 根据 $t = T$ 时 $u$ 的 DCT-II 计算 $S$。\n   - 对三种扩散情况重复此过程，并返回三个 $S$ 值。\n\n9. 输出规格：\n   - 最终输出必须是单行文本：一个包含三个值 $[S_{\\text{A}},S_{\\text{B}},S_{\\text{C}}]$ 的类 Python 列表，每个值都四舍五入到恰好 6 位小数，且无空格。\n\n此设计将数值方法与底层的生态学和物理学原理联系起来，并提供了一个具体、可测试的度量标准，用于捕捉相对扩散速率的差异如何调节由具有生物学现实修正的 Lotka–Volterra 型相互作用控制的捕食者-被捕食者系统中空间模式的出现和持续性。", "answer": "[1.442888,0.000306,0.000012]", "id": "2524831"}]}