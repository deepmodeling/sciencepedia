{"hands_on_practices": [{"introduction": "汞的生物放大作用始于其向甲基汞（MeHg）的转化，这一过程主要由微生物驱动。为了揭示这一过程的生物学基础，科学家们需要量化特定基因的贡献。本练习将指导您应用统计学方法，通过计算标准化效应量，来评估`hgcA`基因在汞甲基化过程中的关键作用，这是一个连接基因功能与生物地球化学过程的典型研究案例 [@problem_id:2506984]。", "problem": "在微观世界条件下，对一种严格厌氧的硫酸盐还原菌进行汞甲基化分析，其中所有重复实验中的溶解性汞(II)（Hg(II)）和电子供体浓度均保持恒定。测试了两种基因型：野生型和一种靶向缺失了对汞甲基化至关重要的类咕啉蛋白基因的突变体 $\\Delta hgcA$。每种基因型的独立重复微观世界实验产生的甲基汞生成速率（被视为近似正态分布）总结如下：野生型，样本量 $n_{1}=10$，样本平均速率 $\\bar{x}_{1}=0.92$ nmol L$^{-1}$ d$^{-1}$，样本标准差 $s_{1}=0.21$ nmol L$^{-1}$ d$^{-1}$；$\\Delta hgcA$ 型，样本量 $n_{2}=9$，样本平均速率 $\\bar{x}_{2}=0.07$ nmol L$^{-1}$ d$^{-1}$，样本标准差 $s_{2}=0.05$ nmol L$^{-1}$ d$^{-1}$。假设样本独立，组内近似正态分布，且组内方差相等。\n\n从双样本标准化均值差异的核心定义出发，构建合并标准差，并计算比较野生型与 $\\Delta hgcA$ 型的小样本偏差校正后的标准化效应大小（使用基于双样本自由度的 Hedges’ $g$ 校正）。然后，使用标准化均值差异抽样方差的大样本近似法，为此效应大小构建置信水平为 $0.95$ 的近似双侧置信区间，并简要解释该结果在 `hgcA` 在汞甲基化中作用方面的生物学意义。\n\n将效应大小四舍五入至三位有效数字。最终报告的效应大小应表示为无单位的纯数。为清楚起见，只有效应大小的值将作为最终答案评分；置信区间和解释需要在您的计算过程中展示，但不是最终报告值的一部分。", "solution": "核心任务是计算野生型菌株和 $\\Delta hgcA$ 突变型菌株之间的标准化均值差异。我们将计算 Hedges' $g$，这是对 Cohen's $d$ 进行小样本偏差校正后的版本。比较在野生型组（第1组）和 $\\Delta hgcA$ 突变型组（第2组）之间进行。\n\n提供的数据如下：\n- 野生型：$n_{1}=10$，样本均值 $\\bar{x}_{1}=0.92$ nmol L$^{-1}$ d$^{-1}$，样本标准差 $s_{1}=0.21$ nmol L$^{-1}$ d$^{-1}$。\n- $\\Delta hgcA$ 型：$n_{2}=9$，样本均值 $\\bar{x}_{2}=0.07$ nmol L$^{-1}$ d$^{-1}$，样本标准差 $s_{2}=0.05$ nmol L$^{-1}$ d$^{-1}$。\n\n分析过程分为四步：（1）计算合并标准差，（2）计算未校正的效应大小，（3）应用偏差校正以获得 Hedges' $g$，以及（4）为 $g$ 构建置信区间。\n\n首先，我们必须在给定总体方差相等的假设下，计算合并标准差 $s_p$。合并方差 $s_p^2$ 的公式是样本方差的加权平均值，权重由每个样本的自由度决定：\n$$s_p^2 = \\frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}$$\n此双样本比较的总自由度为 $\\nu = n_1 + n_2 - 2 = 10 + 9 - 2 = 17$。\n代入给定值：\n$$(n_1-1)s_1^2 = (10-1)(0.21)^2 = 9(0.0441) = 0.3969$$\n$$(n_2-1)s_2^2 = (9-1)(0.05)^2 = 8(0.0025) = 0.02$$\n因此，合并方差为：\n$$s_p^2 = \\frac{0.3969 + 0.02}{17} = \\frac{0.4169}{17} \\approx 0.0245235$$\n合并标准差是合并方差的平方根：\n$$s_p = \\sqrt{\\frac{0.4169}{17}} \\approx 0.15660$$\n\n其次，我们计算未校正的标准化均值差异，即 Cohen's $d$。这是样本均值之差除以合并标准差。\n$$d = \\frac{\\bar{x}_1 - \\bar{x}_2}{s_p}$$\n均值之差为 $\\bar{x}_1 - \\bar{x}_2 = 0.92 - 0.07 = 0.85$。\n代入数值：\n$$d = \\frac{0.85}{\\sqrt{0.4169/17}} \\approx \\frac{0.85}{0.15660} \\approx 5.4278$$\n\n第三，我们对 Cohen's $d$ 进行小样本偏差校正，以获得 Hedges' $g$。校正因子 $J$ 是总自由度 $\\nu$ 的函数。一个常用且精确的 $J$ 近似值为：\n$$J(\\nu) = 1 - \\frac{3}{4\\nu - 1}$$\n对于 $\\nu = 17$，校正因子为：\n$$J(17) = 1 - \\frac{3}{4(17) - 1} = 1 - \\frac{3}{68 - 1} = 1 - \\frac{3}{67} = \\frac{64}{67} \\approx 0.95522$$\nHedges' $g$ 是校正因子与 Cohen's $d$ 的乘积：\n$$g = J(\\nu) \\times d$$\n$$g \\approx 0.95522 \\times 5.4278 \\approx 5.1848$$\n根据要求四舍五入至三位有效数字，效应大小为 $5.18$。\n\n第四，我们为真实效应大小构建近似的 $95\\%$ 置信区间。使用大样本近似法，Hedges' $g$ 的抽样方差（记为 $V_g$）由以下公式给出：\n$$V_g \\approx \\frac{n_1+n_2}{n_1 n_2} + \\frac{g^2}{2(n_1+n_2)}$$\n代入数值：\n$$V_g \\approx \\frac{10+9}{(10)(9)} + \\frac{(5.1848)^2}{2(10+9)} = \\frac{19}{90} + \\frac{26.882}{38}$$\n$$V_g \\approx 0.21111 + 0.70742 \\approx 0.91853$$\n$g$ 的标准误是其方差的平方根：\n$$SE_g = \\sqrt{V_g} \\approx \\sqrt{0.91853} \\approx 0.9584$$\n双侧 $95\\%$ 置信区间构建为 $g \\pm Z_{\\alpha/2} \\times SE_g$，其中 $\\alpha = 0.05$，标准正态分布的临界值为 $Z_{0.025} \\approx 1.96$。\n误差范围为 $E = 1.96 \\times 0.9584 \\approx 1.8785$。\n因此，置信区间为：\n$$CI_{0.95} = [g - E, g + E] = [5.1848 - 1.8785, 5.1848 + 1.8785] = [3.3063, 7.0633]$$\n因此，效应大小的近似 $95\\%$ 置信区间约为 $[3.31, 7.06]$。\n\n最后，我们解释其生物学意义。计算出的效应大小 Hedges' $g \\approx 5.18$，按照传统标准（通常认为 $g > 0.8$ 为大效应）来看，这是一个非常大的值。该值表明，野生型细菌的平均汞甲基化速率比 $\\Delta hgcA$ 突变体高出五个以上的合并标准差。置信区间 $[3.31, 7.06]$ 完全为正，且远离零点，这以高置信度表明观察到的差异并非由随机抽样变异引起。这一结果为 `hgcA` 基因在汞甲基化过程中的关键作用提供了强有力的统计学证据。该基因的缺失在功能上消除了这一表型，证实了 `hgcA` 对所研究生物体内的这一生物地球化学过程至关重要。", "answer": "$$\n\\boxed{5.18}\n$$", "id": "2506984"}, {"introduction": "当甲基汞进入环境后，它便开始在单个生物体内累积。生态毒理学家使用数学模型来预测和理解这一过程。本练习将引导您从质量守恒等基本原理出发，建立一个描述鱼体内甲基汞浓度动态变化的微分方程模型，该模型将综合考虑摄食吸收、生理排泄和生长稀释等关键因素 [@problem_id:2507035]。", "problem": "一条成年食鱼性鱼类栖息在一个湖泊中，在其所关注的时间尺度内，其猎物体内的甲基汞 (MeHg) 浓度近似恒定。设 $C(t)$ 表示在时间 $t$ 鱼的全身甲基汞浓度（单位湿重鱼体的甲基汞质量），并设 $B(t)$ 表示鱼的生物量。将内部甲基汞质量定义为 $M(t) = C(t)\\,B(t)$。假设以下基本过程和理想化成立：\n\n- 甲基汞的食物摄取通过以比摄食速率 $I$（单位鱼体质量每单位时间的猎物质量）摄食猎物而发生，其吸收效率 $AE$（被吸收的摄入甲基汞的比例）为常数。\n- 猎物体内甲基汞浓度为常数，等于 $C_{\\text{prey}}$（单位猎物质量的甲基汞质量）。\n- 鱼体内甲基汞的消除遵循相对于内部浓度的一级动力学，由消除速率常数 $k_{e}$（每单位时间）表征。\n- 鱼的生物量以比生长速率 $g$（每单位时间）增长，因此有 $\\frac{1}{B}\\,\\frac{dB}{dt} = g$。生长会稀释内部浓度，但不会产生或破坏甲基汞。\n- 不存在甲基汞的其他来源、汇或转化过程。\n\n仅从质量平衡和这些定义出发，完成以下任务：\n\n1. 为 $M(t)$ 写出一个包含食物摄取和消除的质量平衡方程。使用恒等式 $M(t)=C(t)\\,B(t)$ 和 $g$ 的定义，推导出关于 $C(t)$ 的常微分方程。\n2. 在系统浓度达到稳态的假设下，用 $AE$、$I$、$C_{\\text{prey}}$、$k_{e}$ 和 $g$ 推导出稳态甲基汞浓度 $C^{\\ast}$ 的闭合形式表达式。\n3. 将 $C^{\\ast}$ 相对于正参数 $p$ 的弹性（无量纲灵敏度）定义为 $E_{p} \\equiv \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln p}$。计算弹性 $E_{AE}$、$E_{I}$、$E_{C_{\\text{prey}}}$、$E_{k_{e}}$ 和 $E_{g}$。\n4. 将你的最终结果以单行矩阵的形式报告，该矩阵按顺序包含：闭合形式的稳态浓度和五个弹性：$\\big[C^{\\ast},\\,E_{AE},\\,E_{I},\\,E_{k_{e}},\\,E_{g},\\,E_{C_{\\text{prey}}}\\big]$。\n\n最终浓度需以符号形式表示，不要代入数值。弹性必须以精确的闭合形式给出。在最终报告的矩阵中不要包含单位。无需四舍五入。", "solution": "第 1 部分：$C(t)$ 的常微分方程推导\n分析从鱼体内甲基汞总质量 $M(t)$ 的质量平衡开始。$M(t)$ 的变化率是摄取速率与消除速率之差。\n$$ \\frac{dM}{dt} = (\\text{摄取速率}) - (\\text{消除速率}) $$\n食物摄取速率是鱼的生物量 $B(t)$、比摄食速率 $I$、猎物浓度 $C_{\\text{prey}}$ 和吸收效率 $AE$ 的乘积。\n$$ \\text{摄取速率} = AE \\cdot I \\cdot C_{\\text{prey}} \\cdot B(t) $$\n消除速率遵循一级动力学。为了量纲一致性，质量消除速率与总内部质量 $M(t)$ 成正比，速率常数为 $k_{e}$。\n$$ \\text{消除速率} = k_{e} \\cdot M(t) = k_{e} \\cdot C(t) \\cdot B(t) $$\n将这些表达式代入质量平衡方程，得到：\n$$ \\frac{dM}{dt} = AE \\cdot I \\cdot C_{\\text{prey}} \\cdot B(t) - k_{e} C(t) B(t) $$\n给定 $M(t) = C(t) B(t)$。为了求出浓度 $C(t)$ 的动态变化，我们使用乘法法则对该乘积关于时间求导：\n$$ \\frac{dM}{dt} = \\frac{d}{dt}[C(t) B(t)] = \\frac{dC}{dt} B(t) + C(t) \\frac{dB}{dt} $$\n现在，我们将 $\\frac{dM}{dt}$ 的两个表达式相等：\n$$ \\frac{dC}{dt} B(t) + C(t) \\frac{dB}{dt} = AE \\cdot I \\cdot C_{\\text{prey}} \\cdot B(t) - k_{e} C(t) B(t) $$\n为了分离出 $C(t)$ 的动态变化，我们将整个方程除以生物量 $B(t)$（其为严格正值）：\n$$ \\frac{dC}{dt} + C(t) \\left(\\frac{1}{B(t)} \\frac{dB}{dt}\\right) = AE \\cdot I \\cdot C_{\\text{prey}} - k_{e} C(t) $$\n问题将比生长速率定义为 $g = \\frac{1}{B(t)} \\frac{dB}{dt}$。将此定义代入方程，得到：\n$$ \\frac{dC}{dt} + g C(t) = AE \\cdot I \\cdot C_{\\text{prey}} - k_{e} C(t) $$\n最后，重新整理各项，将所有包含 $C(t)$ 的项归到一边，即可得到甲基汞浓度的常微分方程：\n$$ \\frac{dC}{dt} = AE \\cdot I \\cdot C_{\\text{prey}} - (k_{e} + g) C(t) $$\n项 $g C(t)$ 代表了“生长稀释”效应，即随着鱼的生物量增加，浓度降低。\n\n第 2 部分：稳态浓度 $C^{\\ast}$ 的推导\n在稳态时，浓度是恒定的，这意味着其时间导数为零。设 $C^{\\ast}$ 表示稳态浓度。我们令 $\\frac{dC}{dt} = 0$：\n$$ 0 = AE \\cdot I \\cdot C_{\\text{prey}} - (k_{e} + g) C^{\\ast} $$\n对该代数方程求解 $C^{\\ast}$，得到稳态浓度的闭合形式表达式：\n$$ (k_{e} + g) C^{\\ast} = AE \\cdot I \\cdot C_{\\text{prey}} $$\n$$ C^{\\ast} = \\frac{AE \\cdot I \\cdot C_{\\text{prey}}}{k_{e} + g} $$\n\n第 3 部分：弹性的计算\n$C^{\\ast}$ 相对于参数 $p$ 的弹性定义为 $E_{p} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln p}$。这是一个方便的无量纲灵敏度度量。\n为方便计算，我们首先对 $C^{\\ast}$ 的表达式取自然对数：\n$$ \\ln C^{\\ast} = \\ln\\left(\\frac{AE \\cdot I \\cdot C_{\\text{prey}}}{k_{e} + g}\\right) = \\ln(AE) + \\ln(I) + \\ln(C_{\\text{prey}}) - \\ln(k_{e} + g) $$\n现在，我们通过求偏导数来计算所需的弹性。恒等式 $\\frac{\\partial f}{\\partial \\ln p} = p \\frac{\\partial f}{\\partial p}$ 在此很有用。\n\n- 相对于 $AE$ 的弹性：\n$E_{AE} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln(AE)} = \\frac{\\partial}{\\partial \\ln(AE)}[\\ln(AE) + \\ln(I) + \\ln(C_{\\text{prey}}) - \\ln(k_{e} + g)] = 1$。\n\n- 相对于 $I$ 的弹性：\n$E_{I} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln(I)} = \\frac{\\partial}{\\partial \\ln(I)}[\\ln(AE) + \\ln(I) + \\ln(C_{\\text{prey}}) - \\ln(k_{e} + g)] = 1$。\n\n- 相对于 $C_{\\text{prey}}$ 的弹性：\n$E_{C_{\\text{prey}}} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln(C_{\\text{prey}})} = \\frac{\\partial}{\\partial \\ln(C_{\\text{prey}})}[\\ln(AE) + \\ln(I) + \\ln(C_{\\text{prey}}) - \\ln(k_{e} + g)] = 1$。\n\n- 相对于 $k_{e}$ 的弹性：\n$E_{k_{e}} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln(k_{e})} = k_{e} \\frac{\\partial \\ln C^{\\ast}}{\\partial k_{e}} = k_{e} \\frac{\\partial}{\\partial k_{e}}[-\\ln(k_{e} + g)] = k_{e} \\left(-\\frac{1}{k_{e} + g}\\right) = -\\frac{k_{e}}{k_{e} + g}$。\n\n- 相对于 $g$ 的弹性：\n$E_{g} = \\frac{\\partial \\ln C^{\\ast}}{\\partial \\ln(g)} = g \\frac{\\partial \\ln C^{\\ast}}{\\partial g} = g \\frac{\\partial}{\\partial g}[-\\ln(k_{e} + g)] = g \\left(-\\frac{1}{k_{e} + g}\\right) = -\\frac{g}{k_{e} + g}$。\n\n这些弹性量化了每个参数的比例变化所引起的稳态浓度的比例变化。例如，$E_{AE}=1$ 意味着 $AE$ 增加 $1\\%$ 会导致 $C^{\\ast}$ 增加 $1\\%$。$E_{k_e} = -\\frac{k_{e}}{k_{e} + g}$ 意味着 $k_e$ 增加 $1\\%$ 会导致 $C^{\\ast}$ 减少 $\\frac{k_{e}}{k_{e} + g}\\%$。\n\n第 4 部分：最终结果矩阵\n问题要求将最终结果按顺序汇编成一个单行矩阵 $\\big[C^{\\ast},\\,E_{AE},\\,E_{I},\\,E_{k_{e}},\\,E_{g},\\,E_{C_{\\text{prey}}}\\big]$。\n\n矩阵的元素是：\n1. $C^{\\ast} = \\frac{AE \\cdot I \\cdot C_{\\text{prey}}}{k_{e} + g}$\n2. $E_{AE} = 1$\n3. $E_{I} = 1$\n4. $E_{k_{e}} = -\\frac{k_{e}}{k_{e} + g}$\n5. $E_{g} = -\\frac{g}{k_{e} + g}$\n6. $E_{C_{\\text{prey}}} = 1$\n\n将这些元素组装到最终的矩阵中，即可得到解。", "answer": "$$\n\\boxed{\\begin{bmatrix} \\frac{AE \\cdot I \\cdot C_{\\text{prey}}}{k_{e} + g} & 1 & 1 & -\\frac{k_{e}}{k_{e} + g} & -\\frac{g}{k_{e} + g} & 1 \\end{bmatrix}}\n$$", "id": "2507035"}, {"introduction": "生物放大的核心特征是污染物浓度沿食物链逐级升高。本练习模拟了生态学家的真实研究工作，要求您分析食物网数据，以量化甲基汞的放大效应。您将学习如何拟合对数线性回归模型来计算“营养级放大斜率”（TMS），并对模型的统计假设进行严格检验，从而将理论模型与实际数据分析联系起来 [@problem_id:2506965]。", "problem": "给定从稳定氮同位素比（十五氮三角，写作 $\\delta^{15}\\mathrm{N}$）推断出的营养级，以及几个湖泊食物网数据集中相应的甲基汞（MeHg）浓度。在水生生物放大理论中，MeHg浓度跨营养级的乘法增长通常被建模为MeHg浓度与营养级之间的对数线性关系。您的任务是将其形式化为一个统计模型，估计营养级放大斜率（TMS），评估其显著性，量化营养级放大因子（TMF），并检查关键的回归假设和杠杆点。\n\n基本和建模假设：\n- 跨营养级的生物放大意味着浓度的乘法关系，在对数转换下变为加法关系。因此，标准做法是将 $\\log_{10}(\\mathrm{MeHg})$ 建模为营养级的仿射函数。\n- 使用普通最小二乘法（OLS）拟合带有截距的 $\\log_{10}(\\mathrm{MeHg})$ 作为营养级的函数。将斜率表示为营养级放大斜率（TMS），并将营养级放大因子（TMF）计算为斜率以10为底的反函数。\n- 使用Shapiro–Wilk检验在显著性水平 $\\alpha = 0.05$ 下评估残差的正态性。\n- 使用Breusch–Pagan检验评估同方差性，该检验公式化为从平方残差对原始回归变量的辅助回归中计算出的拉格朗日乘数统计量，其零分布为 $\\chi^2$ 分布，自由度等于不包括截距的回归变量数量。\n- 使用杠杆值（帽子矩阵的对角线）识别高杠杆观测值。标记杠杆值大于常用经验法则阈值 $2p/n$ 的点，其中 $p$ 是包括截距在内的回归参数数量，$n$ 是样本大小。\n\n每个数据集需计算的统计输出：\n- 营养级放大斜率（TMS），即 $\\log_{10}(\\mathrm{MeHg})$ 对营养级的OLS斜率。\n- 原假设 $H_0: \\mathrm{TMS} = 0$ 的双边 $t$ 检验 $p$ 值，使用标准OLS方差估计量，自由度为 $n - p$。\n- 营养级放大因子（TMF），计算为 $10^{\\mathrm{TMS}}$（无量纲）。\n- Shapiro–Wilk残差正态性 $p$ 值。\n- Breusch–Pagan同方差性 $p$ 值。\n- 最大杠杆值以及使用阈值 $2p/n$ 识别出的高杠杆点数量。\n- 一个布尔标志 `assumptions_ok`，当且仅当残差正态性和同方差性检验的 $p$ 值均严格大于 $0.05$ 且高杠杆点数量为零时为真。\n\n所有计算必须使用以10为底的对数计算 $\\log_{10}(\\mathrm{MeHg})$。所有MeHg浓度单位均为纳克/克湿重（ng/g wet weight）。营养级是无单位的。将TMF表示为浮点数（无量纲）。TMS是单位营养级上 $\\log_{10}(\\mathrm{ng/g})$ 的斜率。不涉及角度或百分比。将所有浮点输出四舍五入到六位小数。\n\n测试套件：\n为以下五个数据集中的每一个提供结果。对于每个数据集，输入包括一个营养级列表，后跟一个MeHg浓度列表（单位：ng/g湿重）。\n\n- 数据集A（理想情况，放大效应明显）：\n  - 营养级：$[2.0, 2.5, 3.0, 3.5, 4.0, 4.5]$\n  - MeHg (ng/g)：$[0.257, 0.368, 0.474, 0.66, 0.848, 1.19]$\n- 数据集B（斜率接近零，无放大效应）：\n  - 营养级：$[2.0, 2.8, 3.6, 4.4, 5.2]$\n  - MeHg (ng/g)：$[0.31, 0.29, 0.32, 0.30, 0.33]$\n- 数据集C（高营养级处可能存在高杠杆点）：\n  - 营养级：$[2.0, 3.0, 4.0, 5.0, 6.5]$\n  - MeHg (ng/g)：$[0.3, 0.5, 0.8, 1.1, 0.2]$\n- 数据集D（小样本量，放大效应陡峭）：\n  - 营养级：$[2.0, 3.0, 4.0, 5.0]$\n  - MeHg (ng/g)：$[0.2, 0.4, 0.9, 1.8]$\n- 数据集E（人为构造的异方差残差模式）：\n  - 营养级：$[2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0]$\n  - MeHg (ng/g)：$[0.24, 0.30, 0.38, 0.50, 0.70, 0.95, 1.30]$\n\n程序要求：\n- 实现带有截距的OLS，用于 $\\log_{10}(\\mathrm{MeHg})$ 对营养级的回归。\n- 计算上面列出的所有输出，所有假设检验的显著性水平 $\\alpha = 0.05$。\n- 对于Breusch–Pagan检验，使用平方残差对原始设计矩阵（包括截距）的辅助回归，并计算拉格朗日乘数统计量 $LM = n R^2_{\\mathrm{aux}}$，其中 $R^2_{\\mathrm{aux}}$ 是辅助回归的决定系数。$p$ 值为 $1 - F_{\\chi^2_q}(LM)$，其中 $q = p - 1$。\n- 使用阈值 $2p/n$ 标记高杠杆点。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个每个数据集结果的列表，每个结果本身是按以下顺序排列的列表：\n$[\\mathrm{TMS}, p\\_\\mathrm{slope}, \\mathrm{TMF}, p\\_\\mathrm{normality}, p\\_\\mathrm{BP}, \\mathrm{max\\_leverage}, \\mathrm{n\\_high\\_leverage}, \\mathrm{assumptions\\_ok}]$，\n浮点值四舍五入到六位小数。例如，整体结构必须看起来像\n$[[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$\n作为单行Python风格的列表字面量打印。", "solution": "用户的请求是对几个关于汞生物放大的生态数据集进行全面的统计分析。此分析涉及拟合对数线性模型、估计参数以及进行一系列诊断检验以验证模型的假设。该问题在科学上是合理的、定义明确的，并且已提供了解决该问题所需的所有必要细节。解决方案如下。\n\n### **1. 模型设定**\n问题指出，甲基汞（MeHg）跨营养级（TP）的生物放大表现为乘法增长。这种关系通过对数变换被线性化。我们将以10为底的MeHg浓度的对数建模为营养级的线性函数。对于每个观测值 $i=1, \\dots, n$，令 $y_i = \\log_{10}(\\mathrm{MeHg}_i)$ 和 $x_i = \\mathrm{TP}_i$。简单线性回归模型为：\n$$\ny_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i\n$$\n其中 $\\beta_0$ 是截距，$\\beta_1$ 是斜率，$\\epsilon_i$ 是独立同分布的随机误差，假设其服从均值为0、方差恒为 $\\sigma^2$ 的正态分布，即 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n以矩阵形式，模型为 $\\mathbf{y} = X\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中：\n$$\n\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ \\vdots \\\\ y_n \\end{pmatrix}, \\quad\nX = \\begin{pmatrix} 1 & x_1 \\\\ 1 & x_2 \\\\ \\vdots & \\vdots \\\\ 1 & x_n \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_0 \\\\ \\beta_1 \\end{pmatrix}, \\quad\n\\boldsymbol{\\epsilon} = \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\vdots \\\\ \\epsilon_n \\end{pmatrix}\n$$\n回归参数的数量是 $p=2$。\n\n### **2. 使用普通最小二乘法（OLS）进行参数估计**\nOLS估计量 $\\hat{\\boldsymbol{\\beta}}$ 最小化残差平方和 $SSR = \\sum_{i=1}^n (y_i - \\hat{y}_i)^2$。解由正规方程组给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (X^T X)^{-1} X^T \\mathbf{y}\n$$\n斜率估计值 $\\hat{\\beta}_1$ 即为营养级放大斜率（TMS）。\n\n### **3. 营养级放大斜率（TMS）的显著性**\n为了评估营养级与对数转换后的MeHg浓度之间是否存在统计上显著的关系，我们检验原假设 $H_0: \\beta_1 = 0$ 与备择假设 $H_1: \\beta_1 \\neq 0$。检验统计量是一个 $t$ 统计量：\n$$\nt = \\frac{\\hat{\\beta}_1 - 0}{SE(\\hat{\\beta}_1)}\n$$\n其中 $SE(\\hat{\\beta}_1)$ 是斜率估计的标准误。首先，我们用均方误差估计误差项的方差 $\\sigma^2$：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n-p} \\sum_{i=1}^n e_i^2 = \\frac{SSR}{n-p}\n$$\n其中 $e_i = y_i - \\hat{y}_i$ 是残差。系数估计的协方差矩阵为 $\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\hat{\\sigma}^2 (X^T X)^{-1}$。斜率的标准误是该矩阵相应对角元素的平方根：\n$$\nSE(\\hat{\\beta}_1) = \\sqrt{[\\mathrm{Cov}(\\hat{\\boldsymbol{\\beta}})]_{1,1}}\n$$\n在原假设下，该 $t$ 统计量服从具有 $n-p$ 个自由度的学生t分布。双边 $p$ 值计算为 $2 \\cdot P(T_{n-p} > |t|)$。\n\n### **4. 营养级放大因子（TMF）**\nTMF 表示营养级每增加一个单位，MeHg浓度所乘以的因子。它由TMS导出：\n$$\n\\mathrm{TMF} = 10^{\\mathrm{TMS}} = 10^{\\hat{\\beta}_1}\n$$\n\n### **5. 模型假设诊断**\nOLS结果的有效性取决于关于残差的几个假设。我们检查三个关键方面：\n\n**a. 残差的正态性：**\n使用Shapiro–Wilk检验来评估原假设，即残差 $e_i$ 来自一个正态分布的总体。$p$ 值小于显著性水平 $\\alpha = 0.05$ 表明正态性假设被违反。\n\n**b. 残差的同方差性（恒定方差）：**\n使用Breusch–Pagan检验来检查异方差性，即残差的方差是否非恒定。我们使用拉格朗日乘数（LM）版本。这涉及将平方残差 $e_i^2$ 对原始自变量（本例中为一个截距和营养级 $x_i$）进行辅助回归：\n$$\ne_i^2 = \\gamma_0 + \\gamma_1 x_i + \\nu_i\n$$\nLM检验统计量计算为 $LM = n \\cdot R^2_{\\mathrm{aux}}$，其中 $R^2_{\\mathrm{aux}}$ 是此辅助回归的决定系数。在同方差性的原假设（$H_0: \\gamma_1 = 0$）下，$LM$ 统计量服从具有 $p-1$ 个自由度的 $\\chi^2$ 分布。这里 $p-1=1$。$p$ 值小于 $\\alpha=0.05$ 表明存在异方差性的证据。\n\n**c. 高杠杆观测值：**\n杠杆值衡量单个自变量值对拟合模型的影响。杠杆分数 $h_{ii}$ 是帽子矩阵 $H = X(X^T X)^{-1} X^T$ 的对角元素。如果一个观测值的杠杆分数超过某个阈值，则认为它具有高杠杆。一个常用的经验法则是标记 $h_{ii} > 2p/n$ 的点。对于本问题，阈值为 $4/n$。高杠杆点的存在可能会不成比例地影响回归估计。\n\n基于这些检验的结果，设置一个布尔标志 `assumptions_ok`。当且仅当Shapiro–Wilk和Breusch–Pagan检验的 $p$ 值都严格大于 $0.05$ 且没有高杠杆点时，该标志为 `True`。\n\n以下Python代码为每个给定的数据集实现了这整个分析过程。", "answer": "```python\nimport numpy as np\nfrom scipy import stats\n\ndef analyze_dataset(tp, mehg):\n    \"\"\"\n    Performs a full regression analysis for MeHg biomagnification.\n    \n    Args:\n        tp (list): List of trophic positions.\n        mehg (list): List of Methylmercury concentrations (ng/g).\n\n    Returns:\n        list: A list containing the 8 required statistical outputs.\n    \"\"\"\n    x = np.array(tp)\n    y_raw = np.array(mehg)\n    \n    # 1. Data Preparation: log10 transform MeHg and set up design matrix\n    y = np.log10(y_raw)\n    n = len(x)\n    p = 2  # Number of parameters: intercept and slope\n    X = np.vstack([np.ones(n), x]).T\n\n    # 2. OLS Estimation\n    # Using np.linalg.lstsq for numerical stability\n    # beta = [intercept, slope]\n    beta, residuals_sum_sq_arr, _, _ = np.linalg.lstsq(X, y, rcond=None)\n    b0, b1 = beta[0], beta[1]\n    tms = b1\n\n    # Calculate residuals\n    y_pred = X @ beta\n    residuals = y - y_pred\n\n    # 3. TMS Significance (t-test)\n    # Estimate variance of the error term\n    sigma_sq_hat = np.sum(residuals**2) / (n - p)\n    # Covariance matrix of beta estimates\n    try:\n        cov_beta = sigma_sq_hat * np.linalg.inv(X.T @ X)\n        # Standard error of the slope (TMS)\n        se_tms = np.sqrt(cov_beta[1, 1])\n        # t-statistic for the slope\n        t_stat_tms = tms / se_tms\n        # Two-sided p-value from t-distribution\n        p_slope = stats.t.sf(np.abs(t_stat_tms), df=n - p) * 2\n    except np.linalg.LinAlgError:\n        # Handle cases where X.T @ X is singular, though unlikely here\n        p_slope = np.nan\n\n    # 4. Trophic Magnification Factor (TMF)\n    tmf = 10**tms\n\n    # 5. Residual Normality (Shapiro-Wilk Test)\n    if len(residuals) >= 3:\n        _, p_normality = stats.shapiro(residuals)\n    else: # Shapiro-Wilk requires at least 3 samples\n        p_normality = np.nan\n\n    # 6. Residual Homoscedasticity (Breusch-Pagan Test)\n    # Auxiliary regression of squared residuals on X\n    sq_residuals = residuals**2\n    \n    # R-squared of auxiliary regression: R^2 = 1 - RSS/TSS\n    tss_aux = np.sum((sq_residuals - np.mean(sq_residuals))**2)\n    # lstsq returns the residual sum of squares of the auxiliary model\n    _, rss_aux_val_arr, _, _ = np.linalg.lstsq(X, sq_residuals, rcond=None)\n    rss_aux_val = rss_aux_val_arr[0] if len(rss_aux_val_arr) > 0 else np.sum((sq_residuals - X @ np.linalg.lstsq(X, sq_residuals, rcond=None)[0])**2)\n    \n    r_sq_aux = 0.0\n    if tss_aux > 1e-12: # Avoid division by zero\n        r_sq_aux = 1 - rss_aux_val / tss_aux\n    \n    # Lagrange Multiplier (LM) statistic\n    lm_stat = n * r_sq_aux\n    \n    # p-value from chi-squared distribution with df = p-1\n    p_bp = stats.chi2.sf(lm_stat, df=p - 1)\n\n    # 7. Leverage Points\n    try:\n        H = X @ np.linalg.inv(X.T @ X) @ X.T\n        leverage = np.diag(H)\n        max_leverage = np.max(leverage)\n        \n        # Threshold for high leverage\n        leverage_threshold = 2 * p / n\n        n_high_leverage = np.sum(leverage > leverage_threshold)\n    except np.linalg.LinAlgError:\n        max_leverage = np.nan\n        n_high_leverage = np.nan\n\n    # 8. Assumptions Check Flag\n    assumptions_ok = (p_normality > 0.05 if not np.isnan(p_normality) else False) and (p_bp > 0.05) and (n_high_leverage == 0)\n\n    # Compile and round results\n    result_list = [\n        round(tms, 6),\n        round(p_slope, 6),\n        round(tmf, 6),\n        round(p_normality, 6) if not np.isnan(p_normality) else p_normality,\n        round(p_bp, 6),\n        round(max_leverage, 6),\n        int(n_high_leverage) if not np.isnan(n_high_leverage) else n_high_leverage,\n        bool(assumptions_ok)\n    ]\n    \n    return result_list\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on all test cases and print results.\n    \"\"\"\n    test_cases = [\n        (\n            [2.0, 2.5, 3.0, 3.5, 4.0, 4.5], # Dataset A\n            [0.257, 0.368, 0.474, 0.66, 0.848, 1.19]\n        ),\n        (\n            [2.0, 2.8, 3.6, 4.4, 5.2], # Dataset B\n            [0.31, 0.29, 0.32, 0.30, 0.33]\n        ),\n        (\n            [2.0, 3.0, 4.0, 5.0, 6.5], # Dataset C\n            [0.3, 0.5, 0.8, 1.1, 0.2]\n        ),\n        (\n            [2.0, 3.0, 4.0, 5.0], # Dataset D\n            [0.2, 0.4, 0.9, 1.8]\n        ),\n        (\n            [2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0], # Dataset E\n            [0.24, 0.30, 0.38, 0.50, 0.70, 0.95, 1.30]\n        )\n    ]\n\n    all_results = []\n    for tp, mehg in test_cases:\n        result = analyze_dataset(tp, mehg)\n        all_results.append(result)\n\n    # Format the final output as a Python-style list literal string with no spaces\n    string_results = []\n    for res_list in all_results:\n        # Manually convert each item to string to handle bools correctly (`True` not `true`) and nan\n        items_as_strings = []\n        for item in res_list:\n            if isinstance(item, float) and np.isnan(item):\n                items_as_strings.append('nan')\n            else:\n                items_as_strings.append(str(item))\n\n        string_results.append(\"[\" + \",\".join(items_as_strings) + \"]\")\n    \n    final_output_string = \"[\" + \",\".join(string_results) + \"]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "2506965"}]}