{"hands_on_practices": [{"introduction": "我们从一个渔业管理的基础模型开始，即带有恒定配额捕捞的逻辑斯谛增长模型。这项练习 [@problem_id:2506172] 旨在建立寻找种群平衡点和分析其稳定性的核心技能，这对于理解种群如何响应捕捞压力至关重要。通过分析，你将推导出在恒定配额策略下的最大可持续产量（MSY），这是一个关键的管理基准。", "problem": "一个生物量为 $B(t)$（单位：生物量）的单一、充分混合的鱼类种群遵循与密度相关的动态增长，并以恒定的配额 $H \\geq 0$（单位：单位时间生物量）进行捕捞。种群动态由以下连续时间模型描述：\n$$\n\\frac{\\mathrm{d}B}{\\mathrm{d}t} \\;=\\; r\\,B\\left(1 - \\frac{B}{K}\\right) - H,\n$$\n其中 $r>0$ 是内禀人均增长率（单位：1/时间），$K>0$ 是环境承载力（单位：生物量）。假设生物量状态空间为 $B \\geq 0$。\n\n从一维自治微分方程和与密度相关的增长的基本原理出发，完成以下任务：\n\n(a) 通过求解 $\\frac{\\mathrm{d}B}{\\mathrm{d}t}=0$ 推导出所有平衡生物量 $B^{\\ast}$，并确定对于给定的恒定配额 $H$，哪些平衡点是生物学上可行的（即满足 $B^{\\ast}\\geq 0$）。\n\n(b) 使用一维自治系统的线性化方法，根据方程右侧关于 $B$ 的导数在 $B^{\\ast}$ 处取值的符号，对每个可行平衡点 $B^{\\ast}$ 的局部稳定性进行分类。\n\n(c) 根据您的分析，陈述为使系统存在至少一个正的、局部渐近稳定平衡点，配额 $H$ 所需满足的充分必要条件。解释当 $H$ 变化并穿过您所确定的阈值时发生的质性变化。\n\n(d) 定义上确界配额 $H_{\\mathrm{sup}}$ 为所有能使系统至少存在一个正的、局部渐近稳定平衡点的恒定配额 $H$ 的最小上界。用 $r$ 和 $K$ 明确地给出 $H_{\\mathrm{sup}}$。这个值通常与最大可持续产量（MSY）相关，即恒定配额捕捞下的最大可持续产量（MSY）。将您的最终答案以 $r$ 和 $K$ 的封闭解析表达式形式给出。无需四舍五入。方框内的最终答案不应包含单位；在您的推理中请酌情解释单位。", "solution": "对鱼类种群动态的分析始于所给出的关于生物量 $B(t)$ 的常微分方程 $\\frac{\\mathrm{d}B}{\\mathrm{d}t} = rB(1 - \\frac{B}{K}) - H$。其中，$r > 0$ 是内禀增长率，$K > 0$ 是环境承载力，$H \\geq 0$ 是恒定捕捞配额。设方程的右侧为 $f(B) = rB - \\frac{r}{K}B^2 - H$。\n\n首先，我们通过求解方程 $\\frac{\\mathrm{d}B}{\\mathrm{d}t} = 0$ 来推导平衡生物量，记为 $B^{\\ast}$。该条件得出了一个关于 $B^{\\ast}$ 的二次方程：\n$$\nrB^{\\ast}\\left(1 - \\frac{B^{\\ast}}{K}\\right) - H = 0\n$$\n将其整理为标准形式，我们得到：\n$$\n\\frac{r}{K}(B^{\\ast})^2 - rB^{\\ast} + H = 0\n$$\n应用二次公式求解 $B^{\\ast}$：\n$$\nB^{\\ast} = \\frac{-(-r) \\pm \\sqrt{(-r)^2 - 4\\left(\\frac{r}{K}\\right)H}}{2\\left(\\frac{r}{K}\\right)} = \\frac{r \\pm \\sqrt{r^2 - \\frac{4rH}{K}}}{\\frac{2r}{K}}\n$$\n化简该表达式得到两个可能的平衡解：\n$$\nB^{\\ast} = \\frac{K}{2r} \\left( r \\pm r \\sqrt{1 - \\frac{4H}{rK}} \\right) = \\frac{K}{2} \\left( 1 \\pm \\sqrt{1 - \\frac{4H}{rK}} \\right)\n$$\n为了使这些平衡点为实数值，判别式必须为非负，这对捕捞配额 $H$ 施加了一个条件：\n$$\n1 - \\frac{4H}{rK} \\geq 0 \\implies H \\leq \\frac{rK}{4}\n$$\n题目规定平衡点必须是生物学上可行的，意味着 $B^{\\ast} \\geq 0$。鉴于 $K > 0$ 且对于范围在 $0 \\leq H \\leq \\frac{rK}{4}$ 内的 $H$，平方根下的项介于0和1之间。因此，$\\sqrt{1 - \\frac{4H}{rK}} \\leq 1$。\n这两个平衡点，我们记为 $B_{+}^{\\ast}$ 和 $B_{-}^{\\ast}$，分别是：\n$$\nB_{+}^{\\ast} = \\frac{K}{2} \\left( 1 + \\sqrt{1 - \\frac{4H}{rK}} \\right)\n$$\n$$\nB_{-}^{\\ast} = \\frac{K}{2} \\left( 1 - \\sqrt{1 - \\frac{4H}{rK}} \\right)\n$$\n对于这两个解，括号中的项都是非负的。因此，对于所有满足 $0 \\leq H \\leq \\frac{rK}{4}$ 的 $H$，$B_{+}^{\\ast}$ 和 $B_{-}^{\\ast}$ 都是生物学上可行的（即 $B^{\\ast} \\geq 0$）。如果 $H > \\frac{rK}{4}$，则不存在实数平衡点。\n\n接下来，我们使用线性化方法分析这些平衡点的局部稳定性。平衡点 $B^{\\ast}$ 的稳定性由导数 $f'(B) = \\frac{\\mathrm{d}f}{\\mathrm{d}B}$ 在 $B^{\\ast}$ 处取值的符号决定。如果 $f'(B^{\\ast})  0$，平衡点是局部渐近稳定的；如果 $f'(B^{\\ast}) > 0$，则是不稳定的。$f(B)$ 的导数是：\n$$\nf'(B) = \\frac{\\mathrm{d}}{\\mathrm{d}B} \\left( rB - \\frac{r}{K}B^2 - H \\right) = r - \\frac{2r}{K}B\n$$\n我们在每个平衡点处计算这个导数的值，其中 $0 \\leq H  \\frac{rK}{4}$。\n对于较大的平衡点 $B_{+}^{\\ast}$：\n$$\nf'(B_{+}^{\\ast}) = r - \\frac{2r}{K} B_{+}^{\\ast} = r - \\frac{2r}{K} \\left[ \\frac{K}{2} \\left( 1 + \\sqrt{1 - \\frac{4H}{rK}} \\right) \\right] = r - r \\left( 1 + \\sqrt{1 - \\frac{4H}{rK}} \\right) = -r \\sqrt{1 - \\frac{4H}{rK}}\n$$\n由于 $r > 0$ 且当 $H  \\frac{rK}{4}$ 时平方根下的项为正，我们得到 $f'(B_{+}^{\\ast})  0$。因此，平衡点 $B_{+}^{\\ast}$ 是局部渐近稳定的。\n\n对于较小的平衡点 $B_{-}^{\\ast}$：\n$$\nf'(B_{-}^{\\ast}) = r - \\frac{2r}{K} B_{-}^{\\ast} = r - \\frac{2r}{K} \\left[ \\frac{K}{2} \\left( 1 - \\sqrt{1 - \\frac{4H}{rK}} \\right) \\right] = r - r \\left( 1 - \\sqrt{1 - \\frac{4H}{rK}} \\right) = r \\sqrt{1 - \\frac{4H}{rK}}\n$$\n对于 $0 \\leq H  \\frac{rK}{4}$，这个导数为正，$f'(B_{-}^{\\ast}) > 0$。因此，平衡点 $B_{-}^{\\ast}$ 是不稳定的。\n\n根据这个稳定性分析，我们可以给出至少存在一个正的、局部渐近稳定平衡点的必要且充分条件。这样的平衡点 $B_{+}^{\\ast}$ 存在且稳定，当且仅当 $0 \\leq H \\le \\frac{rK}{4}$。平衡点 $B_{+}^{\\ast}$ 在存在时总是正的。当 $H=0$ 时，$B_{+}^{\\ast} = K > 0$。当 $H > 0$ 时，$B_{+}^{\\ast} > \\frac{K}{2} > 0$。因此，条件是 $0 \\leq H \\le \\frac{rK}{4}$。在阈值 $H_{crit} = \\frac{rK}{4}$ 处，系统动态发生关键的质性变化。当 $H$ 增加并接近这个值时，稳定平衡点 $B_{+}^{\\ast}$ 和不稳定平衡点 $B_{-}^{\\ast}$ 相互靠近，在 $H = \\frac{rK}{4}$ 时合并为 $B^{\\ast} = \\frac{K}{2}$。这一事件是鞍结分岔。对于任何捕捞配额 $H > \\frac{rK}{4}$，不存在平衡点，种群生物量 $B(t)$ 将不可避免地下降到零，因为捕捞速率超过了种群的最大可能增长率。\n\n最后，我们确定上确界配额 $H_{\\mathrm{sup}}$。它被定义为所有恒定配额 $H$ 的最小上界，这些配额使得至少存在一个正的、局部渐近稳定的平衡点。这些配额的集合是区间 $[0, \\frac{rK}{4}]$。该集合的上确界是其上边界的值。\n$$\nH_{\\mathrm{sup}} = \\sup \\left[ 0, \\frac{rK}{4} \\right] = \\frac{rK}{4}\n$$\n这个值 $H_{\\mathrm{sup}}$ 是恒定配额捕捞策略下的最大可持续产量（MSY）。它代表了种群可以无限期维持的最大生物量提取率。这个最大产量对应于将种群维持在平衡生物量 $B^{\\ast} = \\frac{K}{2}$，这是产生最高自然增长率的水平。", "answer": "$$\n\\boxed{\\frac{rK}{4}}\n$$", "id": "2506172"}, {"introduction": "在掌握了纯生物学模型之后，我们现在将经济现实融入其中。这项练习 [@problem_id:2506201] 探讨了“开放准入”渔业的概念，在这种渔业中，捕捞努力会不断调整直到利润降为零，从而将生物动态与人类经济行为联系起来。此练习揭示了为何不受管制的渔业常常导致资源过度开发的根本原因。", "problem": "一个渔场中的单一种群鱼类种群由带捕捞的逻辑斯蒂生物量动态模型描述。令生物量为 $B$ (吨)，内禀增长率为 $r$ (每单位时间)，环境承载力为 $K$ (吨)。其生物动态学模型为\n$$\n\\frac{dB}{dt} = r B \\left(1 - \\frac{B}{K}\\right) - H,\n$$\n其中捕捞量 $H$ (吨/单位时间) 与生物量和捕捞努力量 $E$ (努力量单位) 成正比，可捕系数为 $q$ (每努力量单位时间)，因此\n$$\nH = q E B.\n$$\n该渔场获得的捕捞离船价格为常数 $p$ (货币单位/吨)，并面临恒定的单位努力量成本 $c$ (货币单位/每努力量单位)。瞬时经济利润为\n$$\n\\pi = p H - c E = p q B E - c E.\n$$\n在开放准入条件下，努力量会不断调整，直到在生物学稳态下长期经济利润为零，此时努力量和捕捞量均严格为正。仅使用这些定义，推导出开放准入稳态生物量 $B_{\\text{OA}}$ 关于 $p$、$q$ 和 $c$ 的封闭形式表达式。以吨为单位表示 $B_{\\text{OA}}$。然后，根据您从上述定义中的推导，解释在假设的具有内部解 ($E>0$ 和 $H>0$) 的开放准入均衡下，$B_{\\text{OA}}$ 是否依赖于 $r$ 和 $K$。\n\n您最终报告的答案必须是 $B_{\\text{OA}}$ 的单一封闭形式表达式。不需要进行数值计算。", "solution": "所述问题是生物经济学中的一个标准练习，具体来说是推导Gordon-Schaefer模型中的开放准入均衡。问题的前提具有科学依据，数学上一致，且问题提法得当。先验验证确认了该问题的有效性，可以推导出解。\n\n该问题要求确定开放准入条件下的稳态生物量，记为 $B_{\\text{OA}}$。一个开放准入渔业均衡具有两个同时满足的条件：\n1. 生物种群处于稳态，意味着其净变化率为零。\n2. 渔业的经济利润为零，因为参与者（努力量）的自由进入和退出将持续到无法获得超额利润为止。\n\n生物量 $B$ 的动态由带有捕捞项 $H$ 的逻辑斯蒂增长模型给出：\n$$\n\\frac{dB}{dt} = r B \\left(1 - \\frac{B}{K}\\right) - H\n$$\n生物学稳态条件是 $\\frac{dB}{dt} = 0$，这意味着捕捞率必须等于种群的自然增长率：\n$$\nH = r B \\left(1 - \\frac{B}{K}\\right)\n$$\n捕捞量 $H$ 也由生产函数 $H = q E B$ 定义，其中 $E$ 是捕捞努力量，$q$ 是可捕系数。\n\n第二个条件是开放准入下的经济均衡，其中长期经济利润 $\\pi$ 为零。利润由总收入 ($p H$) 和总成本 ($c E$) 之差给出：\n$$\n\\pi = p H - c E\n$$\n代入捕捞量表达式 $H = q E B$，利润方程变为：\n$$\n\\pi = p (q E B) - c E = p q B E - c E\n$$\n为求开放准入均衡，将利润设为零：\n$$\np q B E - c E = 0\n$$\n我们可以提出努力量 $E$ 的公因子：\n$$\nE (p q B - c) = 0\n$$\n问题指定我们必须找到一个努力量和捕捞量都严格为正的内部解。要使捕捞量 $H = q E B$ 为正，努力量 $E$ 和生物量 $B$ 都必须为正（因为 $q$ 是一个正常数）。条件 $E > 0$ 意味着要使乘积为零，分解后的方程中的另一项必须等于零。\n$$\np q B - c = 0\n$$\n这个开放准入模型的基本方程表明，努力量将不断调整，直到生物量被驱使到一个水平 $B_{\\text{OA}}$，在该水平上，每单位努力量产生的收入 $p q B_{\\text{OA}}$ 恰好等于每单位努力量的成本 $c$。这就是“生物经济”均衡条件。\n\n解此方程求得稳态生物量 $B$，我们将其记为 $B_{\\text{OA}}$，得到所需的表达式：\n$$\np q B_{\\text{OA}} = c\n$$\n$$\nB_{\\text{OA}} = \\frac{c}{p q}\n$$\n这个表达式就是以价格 $p$、努力量成本 $c$ 和可捕系数 $q$ 表示的开放准入稳态生物量的封闭形式解。该表达式的单位是吨，与生物量 $B$ 的定义一致。\n\n问题的第二部分询问 $B_{\\text{OA}}$ 是否依赖于生物学参数 $r$（内禀增长率）和 $K$（环境承载力）。经检验推导出的表达式 $B_{\\text{OA}} = \\frac{c}{p q}$，可以明确看出该表达式仅包含经济和技术参数（$p$、$c$、$q$）。生物学参数 $r$ 和 $K$ 不在其中。\n\n因此，在Gordon-Schaefer模型对开放准入渔业的假设下，稳态生物量水平 $B_{\\text{OA}}$ 完全由经济和技术决定，而与鱼类种群的生物学生长特性无关。其逻辑是，努力量将进入或退出渔业，直到每单位努力量的收入与每单位努力量的成本相匹配，而在该模型表述中，这个条件仅取决于生物量水平，而不取决于种群自我补充的速度。生物学参数 $r$ 和 $K$ 对整个系统并非无关紧要；它们通过满足生物学稳态条件 $r B_{\\text{OA}}(1 - B_{\\text{OA}}/K) - q E_{\\text{OA}} B_{\\text{OA}} = 0$ 来决定在这一特定生物量水平 $B_{\\text{OA}}$ 下可以施加的可持续努力量水平 $E_{\\text{OA}}$。然而，它们并不决定均衡生物量水平本身。", "answer": "$$\n\\boxed{\\frac{c}{p q}}\n$$", "id": "2506201"}, {"introduction": "最后的这项练习将我们从简化的确定性模型带入充满环境不确定性的现实世界。这项计算练习 [@problem_id:2506185] 要求你使用模拟来比较不同捕捞控制规则的性能，评估在最大化产量和最小化种群崩溃风险之间的基本权衡。这项实践介绍了管理策略评估（Management Strategy Evaluation, MSE）这一现代渔业管理的核心方法。", "problem": "考虑一个具有密度依赖性增长和环境变率的单物种鱼类种群。令 $X_t$ 表示第 $t$ 年初的捕捞前生物量（单位：公吨）。渔业根据 $X_t$ 应用三种捕捞控制规则之一来确定捕捞量 $H_t$（单位：公吨），剩余的留存量为 $E_t = X_t - H_t$。然后，环境变率作用于 $E_t$，根据一个随机密度依赖性增长模型产生下一年的捕捞前生物量 $X_{t+1}$。你需要实现一个模拟，比较三种捕捞规则在多种参数集下于环境随机性影响下的性能。\n\n基本基础：我们假设通过应用于捕捞后生物量的 Ricker 公式来实现离散时间的密度依赖性增长。具体而言，生物量动态为：\n$$\nX_{t+1} \\;=\\; E_t \\, \\exp\\!\\left( r \\left( 1 - \\frac{E_t}{K} \\right) + \\varepsilon_t \\right),\n$$\n其中 $r$ 是内禀增长率（每年），$K$ 是环境承载力（公吨），$\\varepsilon_t$ 是环境过程噪声。假设 $\\varepsilon_t \\sim \\mathcal{N}(-\\sigma^2/2, \\sigma^2)$ 在时间 $t$ 上独立同分布，从而使得 $\\mathbb{E}\\left[\\exp(\\varepsilon_t)\\right] = 1$。\n\n要比较的三种捕捞控制规则定义如下：\n- 固定配额（索引 $0$）：每年捕捞一个固定的配额 $q$，但不能超过现有种群量，\n$$\nH_t \\;=\\; \\min\\{q,\\, X_t\\}.\n$$\n- 固定捕捞比例（索引 $1$）：捕捞捕捞前生物量的一个固定比例 $u$，\n$$\nH_t \\;=\\; u\\, X_t.\n$$\n- 固定留存量（索引 $2$）：捕捞所有超过固定留存目标 $S$ 的生物量，\n$$\nH_t \\;=\\; \\max\\{0,\\, X_t - S\\}.\n$$\n\n性能指标：对于给定的规则和参数集，模拟 $M$ 个独立的重复时间序列，每个序列长度为 $T$ 年，并从相同的初始条件 $X_0$ 开始。将前 $B$ 年作为预烧期丢弃。令 $n = T - B$ 表示评估窗口的长度。在评估窗口内，计算：\n1. 长期平均渔获量（单位：公吨/年），\n$$\n\\bar{Y} \\;=\\; \\frac{1}{M\\, n} \\sum_{m=1}^{M} \\sum_{t=B}^{T-1} H_t^{(m)}.\n$$\n2. 在阈值 $x_{\\mathrm{th}}$ 下的准灭绝概率（无单位），定义为在评估窗口期间生物量曾低于 $x_{\\mathrm{th}}$ 的重复模拟所占的比例，\n$$\np_{\\mathrm{qe}} \\;=\\; \\frac{1}{M} \\sum_{m=1}^{M} \\mathbb{I}\\!\\left\\{ \\min_{t \\in \\{B,\\dots,T-1\\}} X_t^{(m)}  x_{\\mathrm{th}} \\right\\}.\n$$\n\n决策规则：给定一个风险阈值 $\\alpha$（以小数形式表示），在三种策略中，选择在满足 $p_{\\mathrm{qe}} \\le \\alpha$ 的前提下具有最大 $\\bar{Y}$ 的策略。如果没有策略满足 $p_{\\mathrm{qe}} \\le \\alpha$，则选择具有最小 $p_{\\mathrm{qe}}$ 的策略。若出现平局，首先选择 $\\bar{Y}$ 较大的，然后选择策略索引较小的。每个参数集的输出必须是所选策略的索引，为 $\\{0,1,2\\}$ 中的一个整数。\n\n为确保公平性和可复现性的实现细节：\n- 在同一参数集内，对三种策略使用相同的环境噪声路径（公共随机数）。也就是说，对于每个参数集，生成一个形状为 $T \\times M$ 的 $\\varepsilon_t$ 矩阵一次，并为所有三种策略重复使用它。\n- 为伪随机数生成器使用一个固定的随机种子 $12345$。\n- 生物量和捕捞量以公吨为单位。时间以年为单位。最终输出是无单位的整数。\n\n测试套件（四个参数集，涵盖不同情况）：\n对于每个测试用例 $i \\in \\{1,2,3,4\\}$，使用 $M = 2000$ 个重复进行模拟，风险阈值 $\\alpha = 0.1$，准灭绝阈值 $x_{\\mathrm{th}} = 0.1 K$。参数如下：\n\n- 情况 1（中等生产力，中等变率；理想情况）：\n  - $r = 0.6$, $K = 1000$, $\\sigma = 0.2$, $X_0 = 800$, $T = 200$, $B = 50$,\n  - $q = 200$, $u = 0.3$, $S = 400$.\n\n- 情况 2（中等生产力，高变率）：\n  - $r = 0.6$, $K = 1000$, $\\sigma = 0.6$, $X_0 = 800$, $T = 200$, $B = 50$,\n  - $q = 200$, $u = 0.3$, $S = 400$.\n\n- 情况 3（低生产力，中等变率；安全捕捞的边界情况）：\n  - $r = 0.2$, $K = 1000$, $\\sigma = 0.25$, $X_0 = 700$, $T = 250$, $B = 50$,\n  - $q = 150$, $u = 0.2$, $S = 500$.\n\n- 情况 4（高生产力，较小种群规模；测试饱和效应）：\n  - $r = 0.8$, $K = 300$, $\\sigma = 0.25$, $X_0 = 250$, $T = 180$, $B = 40$,\n  - $q = 120$, $u = 0.35$, $S = 150$.\n\n要求的最终输出格式：你的程序应生成单行输出，其中包含四个参数集的四个选定策略索引，格式为方括号括起来的逗号分隔列表（例如，“[0,2,1,2]”）。", "solution": "所提出的问题是定量渔业管理领域的一项标准练习，该领域是应用生态学的一个子学科。它要求在环境随机性条件下比较三种基本的捕捞控制规则。该问题具有科学依据，设定良好，并且所有参数和条件都得到了明确的规定。因此，该问题被认为是有效的，并将提供一个解决方案。\n\n问题的核心在于，在最大化可再生资源（渔获量）带来的经济或社会效益与确保资源种群（保护）的长期可持续性之间存在的内在权衡。这种权衡通过蒙特卡洛模拟框架进行评估。\n\n**1. 种群与捕捞动态模型**\n\n种群动态由一个离散时间的随机 Ricker 模型描述。第 $t+1$ 年的捕捞前生物量（表示为 $X_{t+1}$）是前一年捕捞后生物量（留存量） $E_t$ 的函数：\n$$\nX_{t+1} = E_t \\exp\\left( r \\left( 1 - \\frac{E_t}{K} \\right) + \\varepsilon_t \\right)\n$$\n这里，$r$ 代表种群的内禀增长率，$K$ 是环境承载力。项 $\\varepsilon_t \\sim \\mathcal{N}(-\\sigma^2/2, \\sigma^2)$ 引入了环境随机性，代表影响补充成功率的各种因素的不可预测的波动。正态分布的特定参数化确保了随机乘数 $\\exp(\\varepsilon_t)$ 的期望值为 $1$，这意味着噪声不会对种群的长期平均生产力引入系统性偏差。\n\n留存量 $E_t$ 是从捕捞前种群量 $X_t$ 中去除捕捞量 $H_t$ 后剩余的生物量，即 $E_t = X_t - H_t$。问题指定了三种不同的捕捞控制规则（HCRs）：\n\n- **固定配额（索引 $0$）**：$H_t = \\min\\{q, X_t\\}$。每年设定一个固定的捕捞目标量 $q$，但捕捞量不能超过可用生物量。此规则易于实施，但如果种群规模 $X_t$ 长期低于配额 $q$，可能导致过度捕捞和种群崩溃。\n\n- **固定捕捞比例（索引 $1$）**：$H_t = u X_t$。捕捞捕捞前生物量的一个固定比例 $u$。此规则能响应种群规模的变化，但在极低的生物量水平下可能无法提供足够的保护，因为捕捞量虽然下降但不会停止。\n\n- **固定留存量（索引 $2$）**：$H_t = \\max\\{0, X_t - S\\}$。捕捞量是超过预定义留存目标 $S$ 的剩余生物量。此规则本质上是保守的，因为它优先保留固定的生物量 $E_t = S$（当 $X_t > S$ 时）用于繁殖，从而在种群丰度较低时保护种群。\n\n**2. 模拟与性能评估**\n\n为了比较这些捕捞控制规则，我们采用蒙特卡洛模拟。对于每个参数集，我们模拟 $M$ 条独立的种群轨迹，时长为 $T$ 年。为确保公平比较，对于每个重复轨迹，所有三种捕捞控制规则都受到相同序列的环境冲击（$\\varepsilon_t$）。这通过使用公共随机数技术来实现。初始的 $B$ 年预烧期被丢弃，以使系统达到统计稳态，确保性能指标不受初始条件 $X_0$ 的影响。\n\n每个捕捞控制规则的性能通过两个指标来评判，这两个指标是在从第 $B$ 年到第 $T-1$ 年的评估窗口内计算的：\n\n1.  **平均渔获量（$\\bar{Y}$）**：此指标量化了年均捕捞量，代表渔业的经济产出。其计算公式为：\n    $$\n    \\bar{Y} = \\frac{1}{M(T-B)} \\sum_{m=1}^{M} \\sum_{t=B}^{T-1} H_t^{(m)}\n    $$\n2.  **准灭绝概率（$p_{\\mathrm{qe}}$）**：此指标量化了保护风险。它是在评估期间，生物量 $X_t$ 至少有一次低于临界阈值 $x_{\\mathrm{th}}$ 的模拟轨迹所占的比例。\n    $$\n    p_{\\mathrm{qe}} = \\frac{1}{M} \\sum_{m=1}^{M} \\mathbb{I}\\left\\{ \\min_{t \\in \\{B,\\dots,T-1\\}} X_t^{(m)}  x_{\\mathrm{th}} \\right\\}\n    $$\n\n**3. 策略选择的决策算法**\n\n最优策略是基于一个将安全性置于渔获量之上的字典序决策规则来选择的。\n\n1.  **识别安全策略**：首先，我们识别出准灭绝风险不超过指定容忍水平 $\\alpha$ 的策略子集。如果一个策略 $i$ 的 $p_{\\mathrm{qe}}^{(i)} \\le \\alpha$，则认为该策略是“安全的”。\n\n2.  **从安全策略中选择**：如果存在一个或多个安全策略，我们选择提供最高平均渔获量 $\\bar{Y}$ 的那个。渔获量的任何平局都通过选择索引较小（$0, 1,$ 或 $2$）的策略来解决。\n\n3.  **从不安全策略中选择**：如果没有策略满足安全标准（即，对所有 $i$ 都有 $p_{\\mathrm{qe}}^{(i)} > \\alpha$），则目标转向最小化风险。我们选择具有最低准灭绝概率 $p_{\\mathrm{qe}}$ 的策略。平局首先通过选择具有较高平均渔获量 $\\bar{Y}$ 的策略来解决，然后是较小的策略索引。\n\n**4. 计算实现**\n\n该解决方案以 Python 脚本的形式实现。对于每个测试用例：\n1.  为保证可复现性，使用一个固定的种子初始化伪随机数生成器。\n2.  一次性生成一个 $T \\times M$ 的环境噪声值（$\\varepsilon_t$）矩阵。\n3.  对于三种策略中的每一种，都在 $M$ 个重复中运行一个为期 $T$ 年的模拟。在每个时间步长都存储生物量 $X_t$ 和捕捞量 $H_t$。\n4.  模拟结束后，使用评估窗口的轨迹数据为每个策略计算性能指标 $\\bar{Y}$ 和 $p_{\\mathrm{qe}}$。\n5.  将结构化决策算法应用于计算出的指标，以确定获胜策略的索引。\n6.  对所有四个测试用例重复此过程，并将得出的索引收集起来并格式化为最终输出。\n7.  使用 NumPy 库来高效地进行模拟动态和指标的向量化计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef select_policy(policy_stats, alpha):\n    \"\"\"\n    Selects the best policy based on the specified decision rule.\n\n    Args:\n        policy_stats (list): A list of dictionaries, where each dictionary\n                             contains 'policy' index, 'yield', and 'p_qe'.\n        alpha (float): The risk threshold for quasi-extinction probability.\n\n    Returns:\n        int: The index of the selected policy (0, 1, or 2).\n    \"\"\"\n    safe_pols = [p for p in policy_stats if p['p_qe'] = alpha]\n\n    if safe_pols:\n        # If safe policies exist, choose the one with the maximum yield.\n        # Tie-breaking: larger yield, then smaller policy index.\n        # This is achieved by maximizing the tuple (yield, -index).\n        best_policy_stat = max(safe_pols, key=lambda p: (p['yield'], -p['policy']))\n        return best_policy_stat['policy']\n    else:\n        # If no safe policies, choose the one with the minimum p_qe.\n        # Tie-breaking: smaller p_qe, then larger yield, then smaller policy index.\n        # This is achieved by minimizing the tuple (p_qe, -yield, index).\n        best_policy_stat = min(policy_stats, key=lambda p: (p['p_qe'], -p['yield'], p['policy']))\n        return best_policy_stat['policy']\n\ndef run_simulation(r, K, sigma, X_0, T, M, B, q, u, S, alpha, x_th_frac):\n    \"\"\"\n    Runs the full simulation for one parameter set and selects the best policy.\n\n    Returns:\n        int: The index of the selected policy for the given parameter set.\n    \"\"\"\n    # Initialize the pseudo-random number generator with a fixed seed for reproducibility.\n    rng = np.random.default_rng(12345)\n    \n    # Generate the common random numbers for environmental noise for all replicates and time steps.\n    # The simulation runs for T years, requiring T-1 transitions from X_0 to X_{T-1}.\n    eps_matrix = rng.normal(loc=-sigma**2 / 2, scale=sigma, size=(T - 1, M))\n\n    policy_params = {'q': q, 'u': u, 'S': S}\n    policy_stats = []\n\n    for i in range(3):  # Iterate through the three policies: 0, 1, 2.\n        # Pre-allocate arrays to store biomass and harvest trajectories.\n        # biomass array stores X_0, ..., X_{T-1}\n        # harvest array stores H_0, ..., H_{T-1}\n        biomass = np.zeros((T, M))\n        harvest = np.zeros((T, M))\n        biomass[0, :] = X_0\n\n        # Simulate population dynamics over time.\n        for t in range(T - 1):\n            X_t = biomass[t, :]\n\n            # Apply the corresponding harvest control rule.\n            if i == 0:  # Constant quota\n                H_t = np.minimum(policy_params['q'], X_t)\n            elif i == 1:  # Constant exploitation fraction\n                H_t = policy_params['u'] * X_t\n            else:  # Constant escapement\n                H_t = np.maximum(0, X_t - policy_params['S'])\n            \n            E_t = X_t - H_t\n            harvest[t, :] = H_t\n            \n            # Project biomass to the next year using the Ricker model.\n            biomass[t + 1, :] = E_t * np.exp(r * (1 - E_t / K) + eps_matrix[t, :])\n            # Ensure biomass does not become negative due to numerical precision issues, although analytically it shouldn't.\n            biomass[t + 1, :] = np.maximum(0, biomass[t + 1, :])\n\n\n        # Calculate harvest for the final year of the evaluation period (t=T-1).\n        X_T_minus_1 = biomass[T - 1, :]\n        if i == 0:\n            H_T_minus_1 = np.minimum(policy_params['q'], X_T_minus_1)\n        elif i == 1:\n            H_T_minus_1 = policy_params['u'] * X_T_minus_1\n        else:\n            H_T_minus_1 = np.maximum(0, X_T_minus_1 - policy_params['S'])\n        harvest[T - 1, :] = H_T_minus_1\n        \n        # Calculate performance metrics over the evaluation window [B, T-1].\n        eval_harvest = harvest[B:T, :]\n        mean_yield = np.mean(eval_harvest)\n\n        eval_biomass = biomass[B:T, :]\n        min_biomass_per_rep = np.min(eval_biomass, axis=0)\n        x_th = x_th_frac * K\n        p_qe = np.mean(min_biomass_per_rep  x_th)\n        \n        policy_stats.append({'policy': i, 'yield': mean_yield, 'p_qe': p_qe})\n\n    return select_policy(policy_stats, alpha)\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run simulations, and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1: moderate productivity, moderate variability\n        {'r': 0.6, 'K': 1000, 'sigma': 0.2, 'X_0': 800, 'T': 200, 'B': 50, 'q': 200, 'u': 0.3, 'S': 400},\n        # Case 2: moderate productivity, high variability\n        {'r': 0.6, 'K': 1000, 'sigma': 0.6, 'X_0': 800, 'T': 200, 'B': 50, 'q': 200, 'u': 0.3, 'S': 400},\n        # Case 3: low productivity, moderate variability\n        {'r': 0.2, 'K': 1000, 'sigma': 0.25, 'X_0': 700, 'T': 250, 'B': 50, 'q': 150, 'u': 0.2, 'S': 500},\n        # Case 4: high productivity, smaller stock size\n        {'r': 0.8, 'K': 300, 'sigma': 0.25, 'X_0': 250, 'T': 180, 'B': 40, 'q': 120, 'u': 0.35, 'S': 150},\n    ]\n\n    # Shared parameters for all test cases\n    M = 2000\n    alpha = 0.1\n    x_th_frac = 0.1\n    \n    results = []\n    for case in test_cases:\n        selected_policy = run_simulation(\n            r=case['r'], K=case['K'], sigma=case['sigma'], X_0=case['X_0'],\n            T=case['T'], M=M, B=case['B'],\n            q=case['q'], u=case['u'], S=case['S'],\n            alpha=alpha, x_th_frac=x_th_frac\n        )\n        results.append(selected_policy)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2506185"}]}