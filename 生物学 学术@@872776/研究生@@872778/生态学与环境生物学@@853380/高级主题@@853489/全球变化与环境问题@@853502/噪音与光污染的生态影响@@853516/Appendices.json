{"hands_on_practices": [{"introduction": "现实世界中的声学环境很少是稳定的；它们的特征是来自间歇性交通等声源的波动声级。为了评估这种噪声的生态影响，我们需要一个单一的、具有代表性的度量标准，来捕捉一段时间内的总声能。本练习 [@problem_id:2483111] 将指导您从第一性原理出发，推导等效连续声级 $L_{eq}$，这是声学中的一个基本量，展示了如何正确地平均对数分贝水平以反映真实的能量暴露。", "problem": "一只在次级公路旁筑巢的具有领地性的鸣禽，因间歇性的车辆经过而经历时变的A计权声级。设瞬时声压为 $p(t)$，参考声压为 $p_{0}=20\\,\\mu \\text{Pa}$。瞬时声压级 (SPL) 定义为 $L(t)=10\\log_{10}\\!\\big(p^{2}(t)/p_{0}^{2}\\big)$，单位为A计权分贝 (dB(A))。在持续时间为 $T$ 的有限观测窗口内，等效连续声级定义为一种假设的稳态声音的声级，该声音在同一时间间隔内产生的时均方声压与实际时变声音相同。\n\n仅从上述定义以及在线性声学中，对于阻抗近似恒定的空气，瞬时声能通量与 $p^{2}(t)$ 成正比这一事实出发，推导等效连续声级 $L_{eq,T}$ 作为 $[0,T]$ 上 $L(t)$ 的泛函表达式。\n\n然后，考虑在 $T=3600\\,\\mathrm{s}$ 内的一个双电平占空比：在 $f=0.8$ 的时间比例内，背景噪声保持在 $L_{1}=42\\,\\mathrm{dB(A)}$ 的稳定水平；在剩余的 $1-f=0.2$ 的时间比例内，间歇性交通将声级提高到 $L_{2}=66\\,\\mathrm{dB(A)}$。使用您推导的表达式，计算此占空比下的等效连续A计权声级 $L_{eq,T}$。将您的最终数值结果四舍五入至四位有效数字，并以 dB(A) 表示。", "solution": "题目陈述具有科学依据，提法恰当且客观。它提供了声学领域的清晰标准定义，并包含了推导唯一、有意义解所需的所有数据。其前提物理上合理，语言清晰明确。我们将进行形式推导和后续计算。\n\n该问题需要一个分为两部分的解答：首先，推导等效连续声级 $L_{eq,T}$ 作为瞬时声压级 $L(t)$ 的泛函表达式；其次，针对一个特定的双电平占空比计算 $L_{eq,T}$。\n\n第1部分：$L_{eq,T}$ 表达式的推导。\n\n根据定义，等效连续声级 $L_{eq,T}$ 是一个稳态声音的声级，该声音在持续时间为 $T$ 的时间间隔内，具有与实际时变声音相同的时均方声压。对声压平方 $p^2(t)$ 进行平均的物理基础是声能通量与该量成正比。因此，$p^2(t)$ 的平均值是衡量在该时间间隔内传递的平均声能的指标。\n\n在时间间隔 $[0, T]$ 上的时均方声压，记作 $\\langle p^2 \\rangle_T$，由以下积分定义：\n$$\n\\langle p^2 \\rangle_T = \\frac{1}{T} \\int_{0}^{T} p^2(t) \\, dt\n$$\n根据题目对 $L_{eq,T}$ 的定义，该声级由 $\\langle p^2 \\rangle_T$ 使用与瞬时声级相同的公式计算得出：\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( \\frac{\\langle p^2 \\rangle_T}{p_0^2} \\right)\n$$\n其中 $p_0$ 是参考声压。代入 $\\langle p^2 \\rangle_T$ 的积分表达式得到：\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( \\frac{1}{p_0^2} \\cdot \\frac{1}{T} \\int_{0}^{T} p^2(t) \\, dt \\right) = 10 \\log_{10} \\! \\left( \\frac{1}{T} \\int_{0}^{T} \\frac{p^2(t)}{p_0^2} \\, dt \\right)\n$$\n为了将 $L_{eq,T}$ 表示为 $L(t)$ 的泛函，我们必须从 $L(t)$ 的定义中找到 $p^2(t)/p_0^2$ 这一项的关系。瞬时声压级 $L(t)$ 给出如下：\n$$\nL(t) = 10 \\log_{10} \\! \\left( \\frac{p^2(t)}{p_0^2} \\right)\n$$\n为了反转这个关系，我们首先两边除以10：\n$$\n\\frac{L(t)}{10} = \\log_{10} \\! \\left( \\frac{p^2(t)}{p_0^2} \\right)\n$$\n接着，我们以10为底对两边取幂：\n$$\n10^{\\frac{L(t)}{10}} = \\frac{p^2(t)}{p_0^2}\n$$\n现在，我们将 $p^2(t)/p_0^2$ 这个比值的表达式代回到 $L_{eq,T}$ 的积分中：\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( \\frac{1}{T} \\int_{0}^{T} 10^{\\frac{L(t)}{10}} \\, dt \\right)\n$$\n这就是在区间 $[0, T]$ 上，等效连续声级 $L_{eq,T}$ 作为瞬时声级 $L(t)$ 的泛函所需的一般表达式。\n\n第2部分：针对指定占空比的计算。\n\n给定一个总周期为 $T = 3600\\,\\mathrm{s}$ 的双电平占空比。在 $f = 0.8$ 的时间比例内，声级为 $L_1 = 42\\,\\mathrm{dB(A)}$；在剩余的 $1-f = 0.2$ 的时间比例内，声级为 $L_2 = 66\\,\\mathrm{dB(A)}$。\n\n在这种情况下，函数 $L(t)$ 是分段常数。在周期 $T$ 上的积分可以分解为对应于两个声级的两部分：\n$$\n\\int_{0}^{T} 10^{\\frac{L(t)}{10}} \\, dt = \\int_{\\text{time at } L_1} 10^{\\frac{L_1}{10}} \\, dt + \\int_{\\text{time at } L_2} 10^{\\frac{L_2}{10}} \\, dt\n$$\n声级为 $L_1$ 的持续时间是 $fT$，声级为 $L_2$ 的持续时间是 $(1-f)T$。由于被积函数在各自的区间内是常数，积分简化为：\n$$\n\\int_{0}^{T} 10^{\\frac{L(t)}{10}} \\, dt = (fT) \\cdot 10^{\\frac{L_1}{10}} + ((1-f)T) \\cdot 10^{\\frac{L_2}{10}}\n$$\n将此代入推导出的 $L_{eq,T}$ 表达式中：\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( \\frac{1}{T} \\left[ (fT) \\cdot 10^{\\frac{L_1}{10}} + ((1-f)T) \\cdot 10^{\\frac{L_2}{10}} \\right] \\right)\n$$\n总持续时间 $T$ 从表达式中消去，表明 $L_{eq,T}$ 仅取决于每个声级的时间比例，而不取决于观测窗口的绝对持续时间：\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( f \\cdot 10^{\\frac{L_1}{10}} + (1-f) \\cdot 10^{\\frac{L_2}{10}} \\right)\n$$\n现在我们代入给定的数值：$f = 0.8$, $L_1 = 42$, 以及 $L_2 = 66$。\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( 0.8 \\cdot 10^{\\frac{42}{10}} + 0.2 \\cdot 10^{\\frac{66}{10}} \\right)\n$$\n$$\nL_{eq,T} = 10 \\log_{10} \\! \\left( 0.8 \\cdot 10^{4.2} + 0.2 \\cdot 10^{6.6} \\right)\n$$\n我们继续计算对数内部的各项：\n$$\n0.8 \\cdot 10^{4.2} = 0.8 \\cdot 15848.93... \\approx 12679.15\n$$\n$$\n0.2 \\cdot 10^{6.6} = 0.2 \\cdot 3981071.7... \\approx 796214.34\n$$\n将这些值相加：\n$$\n12679.15 + 796214.34 = 808893.49\n$$\n最后，我们计算 $L_{eq,T}$：\n$$\nL_{eq,T} = 10 \\log_{10} \\! (808893.49) \\approx 10 \\cdot (5.90788) \\approx 59.0788\\,\\mathrm{dB(A)}\n$$\n题目要求将最终结果四舍五入至四位有效数字。\n$$\nL_{eq,T} \\approx 59.08\\,\\mathrm{dB(A)}\n$$\n这个结果表明，等效声级主要由强度更高的声音决定，尽管它只在较小的时间比例内出现。这是由于分贝标度的对数特性以及我们平均的是声能而非声级。", "answer": "$$\n\\boxed{59.08}\n$$", "id": "2483111"}, {"introduction": "减缓光污染不仅在于减少用光，更在于智能地引导光线。生态危害的很大一部分，从天空辉光到直接眩光，都源于设计拙劣的灯具，这些灯具将光线向侧向和向上传播，造成了光的浪费。本实践 [@problem_id:2483144] 运用光度学的第一性原理，量化了具有相同总能量输出的屏蔽式（全截止）和非屏蔽式（各向同性）光源在地面照度上的巨大差异，揭示了高效、“暗夜友好”照明设计的物理基础。", "problem": "一个市政当局寻求改造街道照明，以减少天空辉光和高角度眩光对夜行动物定向和行为的生态影响，同时保持或改善地面能见度。现比较两种灯具，它们都提供相同的总光通量 $\\Phi$（单位为流明），并安装在水平地面上方相同的高度 $h$（单位为米）：\n\n- 一种全截光型下照灯，其在水平面以上被完全遮挡，被建模为一个理想的、旋转对称的、朝下的朗伯发射体。其光强度作为从向下垂直方向（天底）测量的极角 $\\theta$ 的函数，满足 $I_{\\mathrm{f}}(\\theta)\\propto \\cos\\theta$（对于 $0\\le \\theta \\le \\pi/2$），且 $I_{\\mathrm{f}}(\\theta)=0$（对于 $\\pi/2\\theta\\le \\pi$）。\n\n- 一种遮挡较弱的半截光型球形灯具，由于其对称的半透明外壳，被建模为一个各向同性的点光源。其光强度与方向无关，$I_{\\mathrm{s}}(\\theta)=\\text{恒定}$（对于 $0\\le \\theta \\le \\pi$）。\n\n假设两种灯具都具有轴对称性，并使用以下基本原理：(i) 点光源光度学的平方反比定律，(ii) 光通量定义为光强度对立体角的积分，以及 (iii) 入射角与平面上水平照度之间的几何关系。请从第一性原理出发，除了这些基础知识外不使用任何现成的照明工程公式，推导出每种情况下灯具正下方地面点的水平照度（用 $\\Phi$ 和 $h$ 表示），然后确定其比值\n$$\nR \\equiv \\frac{E_{\\mathrm{full\\ cutoff}}}{E_{\\mathrm{semi\\ cutoff}}}.\n$$\n仅报告 $R$ 的值，作为一个纯数（无单位）。角度应以弧度处理。如果需要任何中间数值常数，请使用精确形式（例如，不要将 $\\pi$ 小数化）。", "solution": "在尝试进行任何解答之前，首先对问题陈述进行验证。\n\n首先，逐字提取已知条件。\n- 两种灯具：一个全截光型下照灯和一个半截光型球形灯具。\n- 两者都提供相同的总光通量 $\\Phi$。\n- 两者都安装在水平地面上方相同的高度 $h$ 处。\n- 全截光型灯具被建模为一个旋转对称的朗伯发射体。\n- 其光强度为 $I_{\\mathrm{f}}(\\theta)\\propto \\cos\\theta$（对于 $0\\le \\theta \\le \\pi/2$），且 $I_{\\mathrm{f}}(\\theta)=0$（对于 $\\pi/2\\theta\\le \\pi$），其中 $\\theta$ 是从向下垂直方向（天底）测量的极角。\n- 半截光型灯具被建模为一个各向同性的点光源。\n- 其光强度为 $I_{\\mathrm{s}}(\\theta)=\\text{恒定}$（对于 $0\\le \\theta \\le \\pi$）。\n- 任务是推导每个灯具正下方的水平照度（$E_{\\mathrm{full\\ cutoff}}$，$E_{\\mathrm{semi\\ cutoff}}$）并求出它们的比值 $R \\equiv \\frac{E_{\\mathrm{full\\ cutoff}}}{E_{\\mathrm{semi\\ cutoff}}}$。\n- 推导必须从第一性原理出发：(i) 平方反比定律，(ii) 光通量定义为光强度的积分，以及 (iii) 水平照度的几何关系。\n\n其次，根据所需标准对问题进行验证。\n- **科学依据**：该问题基于光度学的基本原理，即光强度（$I$）、光通量（$\\Phi$）和照度（$E$）的定义，以及平方反比定律和朗伯余弦定律。这些是物理学和工程学中标准且完善的概念。对灯具的模型是理想化的，但在这种情况下，它们在物理和数学上都是合理的。\n- **适定性**：该问题是适定的。它提供了足够的信息来确定两种强度分布的归一化常数，并随后计算所需的量。目标陈述清晰，可以获得唯一解。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n经审查，该问题具有科学依据、适定、客观，且无明显缺陷。因此，它被认为是有效的。现在开始解答。\n\n光通量 $\\Phi$ 是光强度 $I(\\theta)$ 对总立体角 $\\Omega$ 的积分。对于一个绕垂直轴旋转对称的光源，立体角元为 $d\\Omega = 2\\pi \\sin\\theta \\, d\\theta$，其中 $\\theta$ 是与对称轴（天底）的夹角。\n\n距离光源 $r$ 处的表面上的水平照度 $E_h$ 由平方反比定律给出，并乘以一个入射角的余弦因子。水平面上的入射角等于从天底发出的出射角 $\\theta$。因此，$E_h = \\frac{I(\\theta)}{r^2}\\cos\\theta$。对于灯具正下方的地面点，距离为 $r=h$，角度为 $\\theta=0$。因此，照度为 $E = \\frac{I(0)}{h^2}$。\n\n为了求出比值 $R$，我们必须首先用总光通量 $\\Phi$ 表示每种灯具的 $I(0)$。\n\n情况1：全截光型朗伯灯具\n光强度给定为 $I_{\\mathrm{f}}(\\theta) = C_{\\mathrm{f}} \\cos\\theta$（对于 $0 \\le \\theta \\le \\frac{\\pi}{2}$）和 $I_{\\mathrm{f}}(\\theta) = 0$（对于 $\\theta  \\frac{\\pi}{2}$）。常数 $C_{\\mathrm{f}}$ 通过对总光通量 $\\Phi$ 进行归一化来确定。\n$$\n\\Phi = \\int_{\\text{all space}} I_{\\mathrm{f}}(\\theta) \\, d\\Omega = \\int_{0}^{\\pi/2} (C_{\\mathrm{f}} \\cos\\theta)(2\\pi \\sin\\theta) \\, d\\theta\n$$\n$$\n\\Phi = 2\\pi C_{\\mathrm{f}} \\int_{0}^{\\pi/2} \\sin\\theta \\cos\\theta \\, d\\theta\n$$\n使用换元法 $u = \\sin\\theta$（因此 $du = \\cos\\theta \\, d\\theta$）计算该积分。\n$$\n\\int_{0}^{\\pi/2} \\sin\\theta \\cos\\theta \\, d\\theta = \\int_{\\sin(0)}^{\\sin(\\pi/2)} u \\, du = \\int_{0}^{1} u \\, du = \\left[ \\frac{u^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\n将此结果代回 $\\Phi$ 的表达式中：\n$$\n\\Phi = 2\\pi C_{\\mathrm{f}} \\left(\\frac{1}{2}\\right) = \\pi C_{\\mathrm{f}}\n$$\n由此，我们得到常数 $C_{\\mathrm{f}} = \\frac{\\Phi}{\\pi}$。强度函数为 $I_{\\mathrm{f}}(\\theta) = \\frac{\\Phi}{\\pi}\\cos\\theta$。\n沿天底方向（$\\theta=0$）的强度为 $I_{\\mathrm{f}}(0) = \\frac{\\Phi}{\\pi}\\cos(0) = \\frac{\\Phi}{\\pi}$。\n灯具正下方的照度为：\n$$\nE_{\\mathrm{full\\ cutoff}} = \\frac{I_{\\mathrm{f}}(0)}{h^2} = \\frac{\\Phi}{\\pi h^2}\n$$\n\n情况2：半截光型各向同性灯具\n光强度给定为 $I_{\\mathrm{s}}(\\theta) = C_{\\mathrm{s}}$（一个常数）（对于 $0 \\le \\theta \\le \\pi$）。常数 $C_{\\mathrm{s}}$ 同样通过对总光通量 $\\Phi$ 进行归一化来确定。积分遍及空间中的所有方向。\n$$\n\\Phi = \\int_{\\text{all space}} I_{\\mathrm{s}}(\\theta) \\, d\\Omega = \\int_{0}^{\\pi} C_{\\mathrm{s}}(2\\pi \\sin\\theta) \\, d\\theta\n$$\n$$\n\\Phi = 2\\pi C_{\\mathrm{s}} \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta\n$$\n计算该积分：\n$$\n\\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = [-\\cos\\theta]_{0}^{\\pi} = -(\\cos\\pi - \\cos0) = -(-1 - 1) = 2\n$$\n将此结果代回 $\\Phi$ 的表达式中：\n$$\n\\Phi = 2\\pi C_{\\mathrm{s}} (2) = 4\\pi C_{\\mathrm{s}}\n$$\n由此，我们得到常数 $C_{\\mathrm{s}} = \\frac{\\Phi}{4\\pi}$。对于所有 $\\theta$，强度为 $I_{\\mathrm{s}}(\\theta) = \\frac{\\Phi}{4\\pi}$。\n沿天底方向（$\\theta=0$）的强度为 $I_{\\mathrm{s}}(0) = \\frac{\\Phi}{4\\pi}$。\n灯具正下方的照度为：\n$$\nE_{\\mathrm{semi\\ cutoff}} = \\frac{I_{\\mathrm{s}}(0)}{h^2} = \\frac{\\Phi}{4\\pi h^2}\n$$\n\n最后，计算比值 $R$。\n$$\nR = \\frac{E_{\\mathrm{full\\ cutoff}}}{E_{\\mathrm{semi\\ cutoff}}} = \\frac{\\frac{\\Phi}{\\pi h^2}}{\\frac{\\Phi}{4\\pi h^2}}\n$$\n项 $\\Phi$、$\\pi$ 和 $h^2$ 消去，得到结果：\n$$\nR = 4\n$$\n这个结果表明，对于相同的总能量输出（光通量），完全遮挡的下照灯在其正下方提供的照度是未遮挡的各向同性光源的四倍。这是将光通量集中到向下的半球的直接结果。", "answer": "$$\\boxed{4}$$", "id": "2483144"}, {"introduction": "污染生态学的终极挑战在于将物理压力源与其对种群生存能力的影响联系起来。这项高级练习 [@problem_id:2483119] 旨在弥合这一差距，要求您从零开始构建一个简单的种群模型。您将推导声掩蔽如何减少配偶搜寻机会，然后模拟这种个体层面的机制如何通过代际传播，最终改变整个种群的灭绝风险。", "problem": "您的任务是为一种经历人为噪声掩蔽效应的声音信号物种，形式化并实现一个简单的、机理性的、基于个体的模型。其目标是基于基本原理，推导出掩蔽效应如何减少配偶寻找，减少的配偶寻找如何转化为实际繁殖力，以及这在离散世代中如何传递为种群灭绝风险。然后，您必须实现一个模拟，以估计在指定噪声方案下的灭绝风险。\n\n您必须使用的假设和基本依据：\n- 声音传播：接收声级由于球面扩散而随距离减小，其下降幅度与距离的以$10$为底的对数成正比。使用分贝单位，并采用球面扩散带来的声级下降为每十倍距离$20$分贝。\n- 带有掩蔽的探测：如果信噪比（SNR）超过一个固定的探测标准，雌性就能探测到雄性。将$1$米处的鸣声声源级表示为$S_0$（分贝），环境噪声级表示为$N$（分贝），探测标准表示为$\\theta$（分贝）。推导最大探测距离如何依赖于$S_0$、$N$、$\\theta$和球面扩散系数。\n- 空间相遇率：假设雄性在面积为$A$的栖息地内独立且均匀随机分布，并且在每一代中，个体的位置都会被随机化。使用一个经过充分检验的事实：对于一个均匀泊松点过程，任何面积为$x$的区域内的点数服从泊松分布，其均值等于强度乘以$x$，且该区域内至少有一个点的概率等于一减去有零个点的概率。\n- 生命周期：世代不重叠。在每一代中，每只雌性可能会也可能不会交配。如果交配，她会根据均值为基准繁殖力$b$的泊松分布产下随机数量的卵。卵以概率$s$独立存活至成年。成体在繁殖后死亡。补充群体的性别比期望为$1:1$；您可以在计算雌性和雄性数量作为总丰度的函数时，只跟踪总丰度。如果在最终世代或之前总丰度达到$0$，则发生灭绝。\n\n任务：\n$1.$ 根据球面扩散定律、分贝定义和固定的信噪比探测标准，推导出探测半径$R(N)$作为环境噪声级$N$、声源级$S_0$、探测标准$\\theta$和球面扩散系数的函数。明确写出您的最终表达式。\n$2.$ 使用雄性密度等于雄性数量除以栖息地面积$A$的均匀泊松点过程假设，推导出每一代中单只雌性的交配概率$p_{\\mathrm{mate}}$，作为雄性数量$M$、栖息地面积$A$和您在任务1中推导出的探测半径$R(N)$的函数。\n$3.$ 将您得到的$p_{\\mathrm{mate}}$结果与泊松繁殖假设和独立存活相结合，推导出一代内总丰度从$N_{t}$到$N_{t+1}$的随机转移过程。您的推导应清楚说明减少的配偶寻找如何降低实际繁殖力，并应为您使用的任何分布简化提供理由。\n$4.$ 实现一个蒙特卡洛模拟器，它从一个初始总丰度$N_0$开始，在固定的噪声方案$N$下迭代随机转移过程$T$个世代，并记录是否在第$T$代或之前发生灭绝（总丰度为$0$）。在$R$次独立重复中进行此操作，以小数形式估计灭绝概率$\\hat{q}$。\n\n使用以下常数，所有测试用例共享：\n- 栖息地面积 $A = 10^6$ 平方米。\n- 球面扩散系数 $\\alpha = 20$ 分贝/十倍距离。\n- 1米处声源级 $S_0 = 90$ 分贝。\n- 探测标准 $\\theta = 10$ 分贝。\n- 基准繁殖力 $b = 4$ 卵/每只交配雌性/每代。\n- 幼体存活至成年率 $s = 0.4$。\n- 世代数 $T = 50$，除非测试用例中另有说明。\n- 性别比期望为$1:1$，在每一代中，您应将雄性数量计算为$M = \\lfloor N_t / 2 \\rfloor$，雌性数量计算为$F = N_t - M$。\n\n测试套件：\n对于以下每组参数，计算估计的灭绝概率 $\\hat{q}$（以小数形式，而非百分比）。每个案例指定了环境噪声级$N$（分贝）、初始总丰度$N_0$、世代数$T$和蒙特卡洛重复次数$R$：\n- 案例1：$N = 30$，$N_0 = 100$，$T = 50$，$R = 2000$。\n- 案例2：$N = 50$，$N_0 = 100$，$T = 50$，$R = 2000$。\n- 案例3：$N = 70$，$N_0 = 100$，$T = 50$，$R = 2000$。\n- 案例4：$N = 90$，$N_0 = 100$，$T = 50$，$R = 2000$。\n- 案例5：$N = 50$，$N_0 = 2$，$T = 50$，$R = 2000$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个估计的灭绝概率结果，以逗号分隔的列表形式，按案例1到5的顺序排列，四舍五入到三位小数，并用方括号括起来。例如，所需格式为`[$r_1,r_2,r_3,r_4,r_5]`，其中每个$r_i$是四舍五入到三位小数的小数。\n\n所有计算均不涉及角度，因此不需要角度单位。所有输出均为纯小数；不要使用百分号。输出是无量纲的。程序必须是自包含的，不需要任何输入。您必须通过遵守上述假设和常数来确保科学真实性，并且您的推导必须从提供的基本依据开始，不得使用快捷公式。", "solution": "所述问题具有科学依据，提法恰当且客观。它提出了一个明确的任务，即基于物理学、生态学和概率论的既定原则，推导并实现一个机理性模型。所有必需的参数都已提供，逻辑结构也很合理。因此，该问题被认为是有效的，并将提供完整的解决方案。\n\n解决方案按要求分为四个部分：探测半径的推导、交配概率的推导、种群转移动态的推导以及蒙特卡洛模拟的实现。\n\n**1. 探测半径 $R(N)$ 的推导**\n\n问题指明，接收到的声级由于球面扩散而减小，每十倍距离损失 $\\alpha = 20$ 分贝（dB）。设 $S_0$ 为参考距离 $d_{\\text{ref}} = 1$ 米处的声源级。距离声源 $d  1$ 米处的接收声级 $S_r$ 由声衰减公式给出：\n$$S_r(d) = S_0 - \\alpha \\log_{10}\\left(\\frac{d}{d_{\\text{ref}}}\\right)$$\n给定 $\\alpha = 20$ dB/十倍距离 和 $d_{\\text{ref}} = 1$ m，该式可简化为：\n$$S_r(d) = S_0 - 20 \\log_{10}(d)$$\n信噪比（SNR），以分贝为单位，是接收信号声级与环境噪声级 $N$ 之间的差值：\n$$\\text{SNR}(d) = S_r(d) - N = S_0 - 20 \\log_{10}(d) - N$$\n假设当信噪比超过一个固定的探测标准 $\\theta$ 时，雌性就能探测到雄性的信号。最大探测距离，我们记为探测半径 $R$，是信噪比恰好等于该标准的距离：\n$$\\text{SNR}(R) = \\theta$$\n代入SNR的表达式，我们得到方程：\n$$S_0 - 20 \\log_{10}(R) - N = \\theta$$\n我们现在必须解这个关于 $R$ 的方程。重新整理各项以分离出 $\\log_{10}(R)$：\n$$20 \\log_{10}(R) = S_0 - N - \\theta$$\n$$\\log_{10}(R) = \\frac{S_0 - N - \\theta}{20}$$\n最后，通过应用以10为底的对数的反函数（即以10为底的指数运算），我们找到了探测半径 $R$ 作为噪声级 $N$ 的函数的表达式：\n$$R(N) = 10^{\\frac{S_0 - N - \\theta}{20}}$$\n这就是所要求的表达式。它正确地显示了探测半径随着环境噪声级 $N$ 的增加而减小。\n\n**2. 交配概率 $p_{\\mathrm{mate}}$ 的推导**\n\n假设雄性在面积为 $A$ 的栖息地上根据均匀泊松点过程分布。该过程的强度或密度为 $\\lambda = M/A$，其中 $M$ 是雄性总数。位于栖息地中任何一点的雌性，可以探测到以其为中心、半径为 $R(N)$ 的圆形区域内的任何雄性。该探测区域的面积为：\n$$A_{\\text{det}} = \\pi R(N)^2$$\n根据均匀泊松点过程的性质，在任何面积为 $x$ 的区域内发现的点（雄性）数 $k$ 是一个泊松分布的随机变量，其均值为 $\\mu = \\lambda x$。将此应用于雌性的探测区域 $A_{\\text{det}}$，可探测到的雄性数量 $k$ 服从泊松分布，其均值为：\n$$\\mu = \\lambda A_{\\text{det}} = \\left(\\frac{M}{A}\\right) \\pi R(N)^2$$\n如果雌性探测到至少一只雄性，她就会交配，这对应于事件 $k \\ge 1$。此事件的概率 $p_{\\mathrm{mate}}$ 最容易通过一减去其互补事件 $k=0$（未探测到雄性）的概率来计算。\n$$p_{\\mathrm{mate}} = P(k \\ge 1) = 1 - P(k=0)$$\n对于泊松分布，观察到零个事件的概率由下式给出：\n$$P(k=0) = \\frac{e^{-\\mu}\\mu^0}{0!} = e^{-\\mu}$$\n将此代入 $p_{\\mathrm{mate}}$ 的表达式，我们得到单只雌性的交配概率：\n$$p_{\\mathrm{mate}} = 1 - e^{-\\mu} = 1 - \\exp\\left(-\\frac{M}{A}\\pi R(N)^2\\right)$$\n该表达式正确地形式化了雄性密度、栖息地面积和由声学决定的探测半径之间的关系。\n\n**3. 随机种群转移 $N_{t} \\to N_{t+1}$ 的推导**\n\n种群模型以离散、非重叠的世代进行。我们从第 $t$ 代的总种群数量 $N_t$ 开始。\n首先，将种群分为雄性和雌性。雄性数量为 $M_t = \\lfloor N_t/2 \\rfloor$，雌性数量为 $F_t = N_t - M_t = \\lceil N_t/2 \\rceil$。\n$F_t$ 只雌性中的每一只都有 $p_{\\text{mate}}$ 的概率进行交配，且各雌性的交配事件是相互独立的。因此，已交配的雌性数量 $F_{\\text{mated}}$ 服从二项分布，$F_{\\text{mated}} \\sim \\text{Binomial}(F_t, p_{\\text{mate}})$。\n每只已交配的雌性产下的卵数是一个服从均值为 $b$ 的泊松分布的随机变量。该世代产下的总卵数是 $E_{\\text{total}} = \\sum_{i=1}^{F_{\\text{mated}}} E_i$，其中 $E_i \\sim \\text{Poisson}(b)$。这个总和构成一个复合分布。为了分析和计算的简便性，我们做一个标准的简化：我们用一个单一的泊松分布来近似总卵数 $E_{\\text{total}}$ 的分布，该泊松分布的均值等于预期的总卵数。这种近似保留了繁殖过程的均值。\n预期的已交配雌性数量是 $E[F_{\\text{mated}}] = F_t \\cdot p_{\\text{mate}}$。预期的总卵数是 $E[E_{\\text{total}}] = E[F_{\\text{mated}}] \\cdot b = F_t \\cdot p_{\\text{mate}} \\cdot b$。\n因此，我们将总卵数建模为：\n$$E_{\\text{total}} \\sim \\text{Poisson}(\\lambda_{\\text{eggs}}), \\quad \\text{where} \\quad \\lambda_{\\text{eggs}} = F_t \\cdot p_{\\text{mate}} \\cdot b$$\n接下来，这 $E_{\\text{total}}$ 个卵中的每一个都以独立的概率 $s$ 存活到下一代成为成体。因此，新成体的数量 $N_{t+1}$ 是从服从泊松分布的群体中进行二项抽样的结果。这个过程被称为泊松稀疏化（Poisson thinning）。概率论的一个基本定理指出，如果一个随机变量 $K \\sim \\text{Poisson}(\\lambda)$，并且第二个变量 $N$ 的条件分布为 $N|K \\sim \\text{Binomial}(K, p)$，那么 $N$ 的无条件分布也是泊松分布，其均值为 $\\lambda p$。\n将这个精确的结果应用到我们的模型中，下一代的个体数量 $N_{t+1}$ 服从泊松分布，其均值为 $\\lambda_{t+1} = \\lambda_{\\text{eggs}} \\cdot s$：\n$$N_{t+1} \\sim \\text{Poisson}(F_t \\cdot p_{\\text{mate}} \\cdot b \\cdot s)$$\n通过代入 $F_t$ 和 $p_{\\mathrm{mate}}$ 的完整表达式，我们得到了种群丰度的完整随机转移规则：\n$$N_{t+1} \\sim \\text{Poisson}\\left(\\lceil N_t/2 \\rceil \\cdot b \\cdot s \\cdot \\left[1 - \\exp\\left(-\\frac{\\lfloor N_t/2 \\rfloor}{A}\\pi \\left(10^{\\frac{S_0 - N - \\theta}{20}}\\right)^2\\right)\\right]\\right)$$\n这个转移规则整合了声音掩蔽对交配成功率及其后续人口学后果的影响。\n\n**4. 蒙特卡洛模拟**\n\n为了估计灭绝概率 $\\hat{q}$，我们基于推导出的随机转移规则实现了一个蒙特卡洛模拟。对于由参数（$N, N_0, T, R$）定义的每个测试用例，步骤如下：\n1.  初始化一个灭绝计数器为零。\n2.  执行 $R$ 次独立的重复模拟。\n3.  对于每次重复，从第 $t=0$ 代的初始种群 $N_0$ 开始。\n4.  对种群进行 $T$ 代的迭代。在每一代 $t$ 中，通过从前一节推导的泊松分布中抽取一个随机数来计算新的种群数量 $N_{t+1}$。\n5.  如果在模拟过程中的任何时刻（即，对于任何世代 $t \\in \\{1, \\dots, T\\}$），种群数量 $N_t$ 变为 $0$，则该次重复的种群被宣布灭绝，并且该次重复的模拟终止。\n6.  如果某次重复的种群数量在第 $T$ 代或之前变为 $0$，则将灭绝计数器加一。\n7.  在所有 $R$ 次重复完成后，估计的灭绝概率 $\\hat{q}$ 计算为总灭绝次数除以总重复次数 $R$。\n\n以下代码实现了这个模拟来解决给定的问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ecological modeling problem by simulating population dynamics\n    under different noise regimes and estimating extinction probabilities.\n    \"\"\"\n    \n    # Define constants from the problem statement\n    A = 10**6  # Habitat area in square meters\n    alpha = 20  # Spherical spreading coefficient in dB/decade\n    S0 = 90  # Source level at 1 meter in dB\n    theta = 10  # Detection criterion in dB\n    b = 4  # Baseline fecundity (eggs per mated female)\n    s = 0.4  # Juvenile survival to adulthood\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (N, N0, T, R)\n    test_cases = [\n        (30, 100, 50, 2000),  # Case 1\n        (50, 100, 50, 2000),  # Case 2\n        (70, 100, 50, 2000),  # Case 3\n        (90, 100, 50, 2000),  # Case 4\n        (50, 2, 50, 2000),   # Case 5\n    ]\n\n    results = []\n    for N_noise, N0, T, R_replicates in test_cases:\n        \n        # Calculate noise-dependent detection radius R(N)\n        # This is constant for a given test case.\n        # The exponent can be negative, which is valid and gives R  1.\n        exponent = (S0 - N_noise - theta) / alpha\n        detection_radius = 10**exponent\n        detection_area = np.pi * detection_radius**2\n        \n        extinction_count = 0\n        for _ in range(R_replicates):\n            current_N = N0\n            extinct = False\n            \n            for _ in range(T):\n                if current_N == 0:\n                    extinct = True\n                    break\n                \n                # Determine number of males and females\n                males = np.floor(current_N / 2)\n                females = current_N - males\n                \n                # If there are no males or no females, no reproduction can occur.\n                if males == 0 or females == 0:\n                    current_N = 0\n                    continue\n\n                # Calculate per-female probability of mating\n                # This depends on the number of males M_t and detection area\n                mu = (males / A) * detection_area\n                p_mate = 1 - np.exp(-mu)\n                \n                # Calculate the mean of the Poisson distribution for the next generation\n                lambda_next_gen = females * p_mate * b * s\n                \n                # Draw the next population size from the Poisson distribution\n                current_N = np.random.poisson(lambda_next_gen)\n\n            # Check for extinction at or before the terminal generation T\n            if extinct or current_N == 0:\n                extinction_count += 1\n        \n        # Estimate extinction probability\n        q_hat = extinction_count / R_replicates\n        results.append(q_hat)\n\n    # Final print statement in the exact required format.\n    # Results are rounded to three decimal places.\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n```", "id": "2483119"}]}