{"hands_on_practices": [{"introduction": "物种-面积关系（Species-Area Relationship, SAR）是生态学的一项基本原则，它指出更大的区域倾向于拥有更多的物种。本练习将通过经典的幂律SAR模型 $S = cA^z$，让您亲手实践如何量化栖息地丧失对物种丰富度的直接影响。通过计算保护区面积缩减后预期的物种保留比例，您将对“单一大型或多个小型”（Single Large or Several Small, SLOSS）辩论背后的核心原则以及参数 $z$ 的关键作用获得深刻理解。[@problem_id:2528359]", "problem": "一位景观保护规划师因预算限制，必须缩减一个连续的保护区。该生态区核心分类单元的经验性物种-面积关系（SAR）数据显示，在拟合幂律SAR $S = c A^{z}$时，其对数-对数斜率为 $z = 0.25$。其中，$S$ 是物种丰富度，$A$ 是面积，$c$ 是一个常数。假设系统在平衡状态下遵循SAR，没有时间滞后或灭绝债务，并且其他影响物种丰富度的驱动因素保持不变。总保护区面积将从 $A_{0}$ 减少到 $A_{1} = 0.5 A_{0}$，同时保持一个单一、连接良好的地块，以最大限度地减少边缘效应和隔离效应。\n\n仅以SAR为根本基础，推导保留的物种丰富度比例的期望值，定义为 $R \\equiv S(A_{1})/S(A_{0})$，并计算当 $z = 0.25$ 且 $A_{1}/A_{0} = 0.5$ 时的数值。请以小数形式提供 $R$ 的最终数值。将答案四舍五入至四位有效数字。最终答案不带单位。\n\n在您的推导过程中，简要说明 $R$ 对 $z$ 的依赖性是如何从SAR中产生的，并解释为何这意味着在保护区设计中，当面积减少更为严重时，物种保留率对 $z$ 更为敏感，这对“单个大保护区或多个小保护区”（SLOSS）以及连通性规划具有启示。除了所要求的 $R$ 值外，不要报告任何其他数值。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 物种-面积关系（SAR）模型：$S = c A^{z}$\n- $S$：物种丰富度\n- $A$：面积\n- $c$：一个常数\n- SAR的对数-对数斜率：$z = 0.25$\n- 初始保护区面积：$A_{0}$\n- 最终保护区面积：$A_{1} = 0.5 A_{0}$\n- 假设：系统处于平衡状态，没有时间滞后或灭绝债务。\n- 假设：其他影响物种丰富度的驱动因素保持不变。\n- 假设：保护区保持为单个连续的地块。\n- 保留物种丰富度比例的定义：$R \\equiv S(A_{1})/S(A_{0})$\n- 任务1：推导 $R$ 的表达式。\n- 任务2：根据给定参数计算 $R$ 的数值，并四舍五入至四位有效数字。\n- 任务3：论证 $R$ 对 $z$ 的依赖性及其对保护区设计的启示。\n\n**步骤2：使用提取的已知条件进行验证**\n评估问题的有效性。\n- **科学依据**：该问题基于幂律物种-面积关系 $S = cA^z$，这是生态学和生物地理学中一个基本且得到经验充分支持的模型。给定的 $z = 0.25$ 是大陆和陆地环境中的一个典型且现实的数值。所提及的概念——保护区设计、SLOSS、连通性和滅绝债务——是保护生物学中的标准概念。这些假设虽然是对现实的简化，但对于构建一个可行的理论模型以阐明核心原理是恰当的。\n- **适定性**：问题陈述清晰，提供了推导所需比例 $R$ 并计算其值的所有必要信息。目标明确。存在唯一、稳定且有意义的解。\n- **客观性**：问题以精确、定量和客观的语言进行阐述，不含主观论断。\n\n**步骤3：结论与行动**\n该问题具有科学依据、适定性且客观。它不包含任何使其无效的缺陷。因此，该问题被判定为**有效**。将提供完整解答。\n\n支配物种丰富度（$S$）随面积（$A$）变化的函数关系的基本模型是幂律模型：\n$$S(A) = c A^{z}$$\n在这里，$c$ 是一个与分类单元和区域相关的常数，代表单位面积的物种数量；$z$ 是决定物种丰富度随面积增加速度的指数。\n\n在初始较大的保护区 $A_{0}$ 中，物种丰富度由下式给出：\n$$S_{0} = S(A_{0}) = c A_{0}^{z}$$\n\n面积减少后，在较小面积 $A_{1}$ 中的新物种丰富度为：\n$$S_{1} = S(A_{1}) = c A_{1}^{z}$$\n\n问题将保留的物种丰富度比例 $R$ 定义为最终物种丰富度与初始物种丰富度之比：\n$$R \\equiv \\frac{S_{1}}{S_{0}}$$\n\n将 $S_{1}$ 和 $S_{0}$ 的表达式代入 $R$ 的定义中，得到：\n$$R = \\frac{c A_{1}^{z}}{c A_{0}^{z}}$$\n\n常数 $c$ 与面积无关，因此在分子和分母中可以消去。表达式简化为：\n$$R = \\left(\\frac{A_{1}}{A_{0}}\\right)^{z}$$\n这是面积变化后物种保留比例的一般符号表达式。\n\n问题给出了参数的具体数值。面积减少了一半，所以最终面积与初始面积之比为：\n$$\\frac{A_{1}}{A_{0}} = \\frac{0.5 A_{0}}{A_{0}} = 0.5$$\nSAR的对数-对数斜率已知为 $z = 0.25$。\n\n将这些值代入推导出的 $R$ 方程中：\n$$R = (0.5)^{0.25}$$\n指数 $0.25$ 等价于分数 $\\frac{1}{4}$。因此，计算的是 $0.5$ 的四次方根：\n$$R = (0.5)^{1/4} = \\sqrt[4]{0.5}$$\n计算数值：\n$$R \\approx 0.8408964...$$\n按要求将此结果四舍五入至四位有效数字，我们得到：\n$$R \\approx 0.8409$$\n\n$R$ 对 $z$ 的依赖性在推导出的公式 $R = (A_{1}/A_{0})^{z}$ 中是明确的。对于任何给定的面积减少比例，其中 $A_{1}/A_{0}  1$，$R$ 是 $z$ 的指数递减函数。一个较高的 $z$ 值，意味着更陡峭的SAR斜率和物种数量对面积更强的依赖性，导致在相同的生境面积减少情况下，保留的物种比例（$R$）更小。这是因为 $\\ln(A_{1}/A_{0})$ 是负数，所以该函数随 $z$ 增大而减小。\n\n当面积减少更严重时，物种保留率对 $z$ 的敏感性更加显著。为了将其形式化，考虑 $R$ 对 $z$ 的导数，它衡量了当 $z$ 变化时保留率的变化率：$\\frac{\\partial R}{\\partial z} = (A_{1}/A_{0})^{z} \\ln(A_{1}/A_{0})$。该敏感度的量级 $|\\frac{\\partial R}{\\partial z}|$ 表明了 $z$ 的不确定性对物种损失预测的影响强度。对于现实的保护情景领域，例如给定的 $A_1/A_0 = 0.5$，更严重的面积减少（即更小的 $A_{1}/A_{0}$ 比率）会导致该导数的量级更大。这意味着当计划的生境破坏更严重时，物种损失的预测对 $z$ 的确切值更为敏感。\n\n这对“单个大保护区或多个小保护区”（SLOSS）的辩论和连通性规划具有直接影响。SAR模型表明，将一个大的区域分割成几个较小的区域，即使总面积保持不变，也会导致物种丧失，因为较小的斑块各自支持的物种较少。一个高的 $z$ 值会加剧这种效应，强烈支持“单个大保护区”选项，以最大化任何单个斑块的面积。问题中要求维持“一个单一、连接良好的地块”正是这一原则的直接应用。此外，如果碎片化不可避免，与高 $z$ 值相关的高敏感性强调了创建和维护连通性廊道的至关重要性。这种连通性允许生物体在斑块之间移动，从而将多个小保护区部分地整合成一个功能上更大的复合种群网络，以此缓解SAR模型对孤立碎片所预测的物种损失。", "answer": "$$\n\\boxed{0.8409}\n$$", "id": "2528359"}, {"introduction": "虽然总面积至关重要，但景观的空间布局和渗透性决定了功能连通性。本练习将超越简单的欧几里得距离，使用“有效距离”的概念来模拟生物体在异质性景观中的移动。您将在一个成本表面上实现一个最短路径算法，并将其与一个概率性的定殖模型联系起来，从而对景观结构如何影响集合种群的持续生存和基因交流潜力提供一个机理性的认识。[@problem_id:2528280]", "problem": "给定一个生物体在景观中扩散的移动成本表面的离散栅格表示。考虑一个规则的方形网格，其中每个单元格都具有正的移动成本。允许移动到单元格的八个邻居中的任意一个（四个基本方向和四个对角线方向）。定义穿越成本为 $c_{u}$ 的单元格与其相邻成本为 $c_{v}$ 的单元格之间边的成本为：端点成本的算术平均值乘以欧几里得步长。也就是说，对于基本方向的移动，步长为 $1$；对于对角线方向的移动，步长为 $\\sqrt{2}$。源单元格与目标单元格之间的有效距离 $d_{\\text{eff}}$ 是在这些边权重下，两个单元格中心之间所有有效路径的最小总穿越成本。\n\n假设从源到达目标的繁殖体遵循泊松过程，其平均到达数 $m$ 等于源供应量 $s$ 乘以在有效距离处求值的扩散核 $k(d_{\\text{eff}})$。假设扩散核为指数形式，速率参数为 $\\alpha  0$，因此 $k(d) = \\exp(-\\alpha d)$。使用这些前提，并仅利用泊松分布的性质，推导出定殖概率 $K(d_{\\text{eff}})$ 为至少有一次到达的概率。然后，对于给定的测试套件，计算每种情况下的 $d_{\\text{eff}}$，并返回在 $K(d_{\\text{eff}})$ 下相应的定殖概率。\n\n网格几何与索引：\n- 使用坐标 $(x,y)$，其中 $x$ 是列索引，$y$ 是行索引。\n- 原点 $(0,0)$ 是网格的左上角单元格。\n- 网格形状为高 $H$ 宽 $W$；有效索引满足 $0 \\le y  H$ 和 $0 \\le x  W$。\n\n相邻单元格 $(x,y)$ 和 $(x',y')$ 之间的边穿越成本为\n$$\nw\\big((x,y)\\to(x',y')\\big) \\;=\\; \\frac{c(x,y) + c(x',y')}{2} \\cdot \\ell\\big((x,y),(x',y')\\big),\n$$\n其中\n$$\n\\ell\\big((x,y),(x',y')\\big) \\;=\\; \\begin{cases}\n1,  \\text{若 } |x-x'| + |y-y'| = 1,\\\\\n\\sqrt{2},  \\text{若 } |x-x'| = 1 \\text{ 且 } |y-y'| = 1.\n\\end{cases}\n$$\n\n有效距离的定义：\n$$\nd_{\\text{eff}}(\\text{源},\\text{目标}) \\;=\\; \\min_{\\text{8-邻域路径 } P} \\sum_{e \\in P} w(e).\n$$\n\n定殖模型假设：\n- 期望到达数：$m \\;=\\; s \\cdot k\\!\\left(d_{\\text{eff}}\\right)$。\n- 指数核：$k(d) \\;=\\; \\exp(-\\alpha d)$。\n- 到达事件遵循均值为 $m$ 的泊松过程。\n\n您的程序必须：\n- 通过在具有指定边权的网格上使用正确的Dijkstra最短路径算法计算 $d_{\\text{eff}}$。\n- 根据泊松模型的基本原理，推导并实现 $K(d_{\\text{eff}})$。\n- 按顺序应用于以下测试套件。每个测试用例由成本网格 $C$、源坐标 $(x_s,y_s)$、目标坐标 $(x_t,y_t)$ 以及参数 $\\alpha$ 和 $s$ 定义。\n\n测试套件：\n1.  情况 A（均匀移动成本）：\n    - 网格 $C_A$ 为 $5 \\times 5$，所有条目均等于 $1$。\n    - 源 $(x_s,y_s) = (0,0)$，目标 $(x_t,y_t) = (4,3)$。\n    - 参数：$\\alpha = 0.5$, $s = 3.0$。\n2.  情况 B（零距离边界情况）：\n    - 网格 $C_B$ 为 $5 \\times 5$，所有条目均等于 $1$。\n    - 源 $(x_s,y_s) = (2,2)$，目标 $(x_t,y_t) = (2,2)$。\n    - 参数：$\\alpha = 0.9$, $s = 2.0$。\n3.  情况 C（中央障碍绕行）：\n    - 网格 $C_C$ 是一个 $3 \\times 3$ 的矩阵，由下式给出\n        $$\n        C_C \\;=\\; \\begin{bmatrix}\n        1  1  1\\\\\n        1  100  1\\\\\n        1  1  1\n        \\end{bmatrix}.\n        $$\n    - 源 $(x_s,y_s) = (0,0)$，目标 $(x_t,y_t) = (2,2)$。\n    - 参数：$\\alpha = 0.7$, $s = 1.5$。\n\n答案规范：\n- 对于每种情况，输出定殖概率，形式为四舍五入到恰好 $6$ 位小数的浮点数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件相同（例如，$[r_1,r_2,r_3]$）。\n- 不提供外部输入；将测试套件直接嵌入程序中。", "solution": "所提出的问题是生态建模领域中一个明确定义的练习，具体涉及景观连通性。它要求综合两个部分：一个是用于确定有效距离的图论寻路问题，另一个是用于定殖的概率模型。该问题具有科学依据且内部一致，因此可以得出严谨的解。\n\n总体任务是为几种情景计算定殖概率 $K$。这需要两个主要步骤：首先，根据有效距离 $d_{\\text{eff}}$ 推导函数 $K$；其次，为每个具体情景计算 $d_{\\text{eff}}$。\n\n首先，我们推导定殖概率 $K(d_{\\text{eff}})$ 的表达式。问题陈述，繁殖体到达目标单元格的过程遵循泊松过程。到达数量（我们记为随机变量 $N$）因此遵循均值为 $m$ 的泊松分布。其概率质量函数由下式给出：\n$$\nP(N=k) \\;=\\; \\frac{e^{-m} m^k}{k!}\n$$\n其中 $k$ 是非负整数的到达次数。定殖被定义为至少有一次到达的事件，这对应于 $N \\ge 1$。此事件的概率 $K$ 是零次到达（$N=0$）概率的补集。\n$$\nK(d_{\\text{eff}}) \\;=\\; P(N \\ge 1) \\;=\\; 1 - P(N=0)\n$$\n将 $k=0$ 代入泊松概率质量函数，可得：\n$$\nP(N=0) \\;=\\; \\frac{e^{-m} m^0}{0!} \\;=\\; e^{-m}\n$$\n因此，定殖概率为：\n$$\nK(d_{\\text{eff}}) \\;=\\; 1 - e^{-m}\n$$\n平均到达数 $m$ 被给出为有效距离 $d_{\\text{eff}}$ 的函数：\n$$\nm \\;=\\; s \\cdot k(d_{\\text{eff}})\n$$\n其中 $s$ 是源供应量，$k(d)$ 是一个速率参数为 $\\alpha  0$ 的指数扩散核：\n$$\nk(d) \\;=\\; \\exp(-\\alpha d)\n$$\n通过代换，我们得到定殖概率作为有效距离函数的完整表达式：\n$$\nK(d_{\\text{eff}}) \\;=\\; 1 - \\exp\\left(-s \\cdot \\exp(-\\alpha d_{\\text{eff}})\\right)\n$$\n此公式为定殖模型提供了分析基础。\n\n其次，我们必须设计一种计算有效距离 $d_{\\text{eff}}$ 的方法。问题将 $d_{\\text{eff}}$ 定义为源单元格和目标单元格之间所有有效路径的最小总成本。景观被表示为一个网格，可以解释为一个图，其中每个单元格 $(x,y)$ 是一个节点。一个单元格与其八个邻居（摩尔邻域）之间存在边。连接成本为 $c_u$ 的单元格 $u$ 和成本为 $c_v$ 的单元格 $v$ 的边的权重定义为：\n$$\nw_{uv} \\;=\\; \\frac{c_u + c_v}{2} \\cdot \\ell_{uv}\n$$\n其中 $\\ell_{uv}$ 是单元格中心之间的欧几里得距离，对于基本方向移动为 $1$，对于对角线移动为 $\\sqrt{2}$。由于所有移动成本 $c$ 都被指定为正数，因此所有边权重 $w_{uv}$ 都严格为正。\n\n因此，寻找 $d_{\\text{eff}}$ 的问题是在具有非负边权的图上的经典单源最短路径问题。对于这类问题，Dijkstra 算法是标准且正确的程序。该算法系统地从一个源节点找到到图中所有其他节点的最短路径。\n\nDijkstra 算法的实现如下：\n1.  一个距离数组 `dist` 被初始化，除源单元格的距离设为 $0$ 外，所有单元格的距离都为无穷大。\n2.  使用一个最小优先队列来存储待访问的节点，按它们当前与源的最短距离进行优先排序。最初将源单元格加入队列。\n3.  算法迭代地从优先队列中提取具有最小距离的节点 `(x,y)`。\n4.  对于 `(x,y)` 的每个邻居 `(nx,ny)`，计算通过 `(x,y)` 的潜在新距离为 `dist[y,x] + w`，其中 `w` 是它们之间边的权重。\n5.  如果这个新距离小于当前已知的到 `(nx,ny)` 的距离，则更新距离，并将该邻居以其新的、更短的距离添加到优先队列中。\n6.  当优先队列为空时，过程终止；或者，作为一种优化，当目标节点从队列中被提取时终止。终止时目标单元格在 `dist` 中的值即为有效距离 $d_{\\text{eff}}$。\n\n最终的解决方案是一个算法，对于每个测试用例，它首先在给定的成本网格上执行 Dijkstra 算法以计算指定源和目标单元格之间的 $d_{\\text{eff}}$。然后，它将计算出的 $d_{\\text{eff}}$ 以及给定的参数 $\\alpha$ 和 $s$ 代入推导出的 $K(d_{\\text{eff}})$ 公式中，以获得定殖概率。最终的数值结果按指定精度进行四舍五入。", "answer": "[0.196009,0.864665,0.128400]", "id": "2528280"}, {"introduction": "归根结底，保护规划是在预算、土地可得性和生态目标等约束下做出最优决策。这最后一个练习将我们之前的概念综合到一个用于保护区设计的实用优化框架中。您将构建一个二元整数规划问题，用以选择一个地块组合，使其在遵守预算的同时最大化保护效益，并且至关重要地，通过一个基于流的约束来确保所选的保护区形成一个单一、连通的整体。[@problem_id:2528291]", "problem": "一位保护规划师必须在单一大型或多个小型（SLOSS）框架下设计一个陆地保护区，通过选择规划单元来最大化生态效益，同时受限于预算和单一连续保护区的要求。规划区域被建模为一个简单的无向图，其中顶点代表规划单元，边代表邻接关系。您必须使用的基本原理是：(i) 将图的连通性定义为顶点之间存在路径，(ii) 节点处的流量守恒原则（流量平衡），以及 (iii) 线性预算核算。要求所有选定的规划单元形成一个单一的连通集合，这在生态学上是合理的，可以通过一个基于流量的公式来强制执行，该公式将商品从一个指定的根节点发送到诱导子图内的所有选定单元。\n\n规划单元为 $V=\\{1,2,3,4,5\\}$，线性排列，无向边为 $E=\\{(1,2),(2,3),(3,4),(4,5)\\}$。设 $A$ 是通过将每个无向边 $(i,j)\\in E$ 替换为两个有向弧 $(i,j)$ 和 $(j,i)$ 而得到的有向弧集合。选择单元 $i\\in V$ 的成本和效益分别由 $c_i$ 和 $b_i$ 给出，总可用预算为 $B$。指定的根节点为 $r=3$。数据如下：\n- $c_1=3$, $c_2=2$, $c_3=2$, $c_4=1$, $c_5=3$。\n- $b_1=8$, $b_2=5$, $b_3=4$, $b_4=2$, $b_5=7$。\n- $B=7$。\n\n任务：\n- 构建一个二元整数规划，其决策变量用于选择 $V$ 的一个子集，以最大化 $\\sum_{i\\in V} b_i x_i$，同时满足预算约束 $\\sum_{i\\in V} c_i x_i \\le B$、要求 $x_r=1$ 以及一个单一商品流的连通性约束，该约束确保每个选定单元在由选定单元诱导的子图中都与根节点 $r$ 相连。您的构建必须仅依赖于上述基本原理，并且必须引入并论证为实现连续性所需的所有变量和约束。\n- 使用您的公式和所提供的数据，计算一个可行的连通选择所能实现的最优总效益值。将最终答案表示为一个不带单位的单一数字。无需四舍五入。", "solution": "在尝试任何解答之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n已知条件逐字从问题陈述中提取：\n- **模型框架：** 该问题是在单一大型或多个小型（SLOSS）框架下的一个保护区设计任务，建模于一个简单的无向图上。顶点代表规划单元，边代表邻接关系。\n- **基本原理：** (i) 图的连通性即路径的存在，(ii) 节点处的流量守恒，(iii) 线性预算核算。\n- **连通性强制：** 一个单一商品流的公式确保所有选定的单元形成一个包含指定根节点的单一连通集。\n- **图定义：**\n    - 顶点：$V=\\{1,2,3,4,5\\}$。\n    - 无向边：$E=\\{(1,2),(2,3),(3,4),(4,5)\\}$。\n    - 有向弧：$A$ 是通过将 $E$ 中的每条边替换为两个有向弧而形成的。\n- **问题数据：**\n    - 成本：$c_1=3$, $c_2=2$, $c_3=2$, $c_4=1$, $c_5=3$。\n    - 效益：$b_1=8$, $b_2=5$, $b_3=4$, $b_4=2$, $b_5=7$。\n    - 预算：$B=7$。\n    - 根节点：$r=3$。\n- **任务：**\n    - 构建一个二元整数规划（BIP），以在预算和连通性约束下最大化总效益，并要求选择根节点 $r$。\n    - 计算最优总效益值。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题进行严格的验证检查：\n- **科学依据：** 该问题是运筹学（特别是整数规划）在保护规划中的一个标准的、科学上合理的应用。使用图论和基于流量的约束来模拟空间邻接性是景观生态学和保护区设计文献中一种成熟且有效的方法。该问题牢固地建立在成熟的数学和生态学原理之上。\n- **适定性：** 该问题指定了明确的目标函数（最大化总效益）和一组定义明确的约束（预算、根节点选择、连通性）。它是一个在有限、非空可行集（仅包含根节点的集合是可行的）上的最大化问题，这保证了最优解的存在。该问题是适定的。\n- **客观性：** 问题以精确、量化的术语陈述。所有参数都已明确定义。没有主观、模糊或基于观点的语言。\n- **完整性和一致性：** 所有必要的数据（$V$、$E$、成本、效益、预算、根节点）都已提供。选择根节点（$x_r=1$）的要求与预算是一致的，因为根节点的成本（$c_3=2$）小于总预算（$B=7$）。没有矛盾之处。\n- **现实性和可行性：** 该问题是一个抽象的表示，但它不违反任何物理或逻辑原则。数值的选择是为了一个易于处理的例子。\n\n### 步骤3：结论与行动\n该问题是**有效的**。它是应用于保护生物学的优化领域中一个正确且公式化良好的问题。将提供解答。\n\n### 整数规划公式\n首先，我们按要求构建二元整数规划。\n\n**决策变量：**\n- 对每个规划单元 $i \\in V$，令 $x_i \\in \\{0, 1\\}$ 为一个决策变量。若 $x_i=1$，则选择单元 $i$；若 $x_i=0$，则不选择。\n- 令 $f_{ij} \\ge 0$ 为一个连续变量，表示在有向弧 $(i,j) \\in A$ 上流动的概念性商品的数量。\n\n**目标函数：**\n目标是最大化所选单元的效益总和：\n$$ \\text{最大化 } \\sum_{i \\in V} b_i x_i = 8x_1 + 5x_2 + 4x_3 + 2x_4 + 7x_5 $$\n\n**约束：**\n1.  **预算约束：** 所选单元的总成本不能超过预算 $B$。\n    $$ \\sum_{i \\in V} c_i x_i = 3x_1 + 2x_2 + 2x_3 + 1x_4 + 3x_5 \\le 7 $$\n\n2.  **根节点选择约束：** 必须选择指定的根单元 $r=3$。\n    $$ x_3 = 1 $$\n\n3.  **连通性约束（单一商品流）：** 这些约束确保由选定单元集合 $\\{i \\in V \\mid x_i=1\\}$ 诱导的子图是连通的，并包含根节点 $r=3$。这是通过要求每个选定的非根节点消耗一个由根节点供应的流量单位来实现的，流量被限制在选定节点的路径上。\n\n    a. **根节点($r=3$)处的流量平衡：** 从根节点流出的净流量必须等于其他选定单元（汇点）的数量。\n    $$ \\sum_{(3,j)\\in A} f_{3j} - \\sum_{(j,3)\\in A} f_{j3} = \\sum_{i \\in V \\setminus \\{3\\}} x_i $$\n    对于给定的图，此约束为：\n    $$ (f_{32} + f_{34}) - (f_{23} + f_{43}) = x_1 + x_2 + x_4 + x_5 $$\n\n    b. **非根节点($i \\in V \\setminus \\{3\\}$)处的流量平衡：** 每个选定的非根节点必须消耗一个单位的流量。如果一个节点未被选择，其流入量必须等于其流出量（它充当一个中转点）。\n    $$ \\sum_{(j,i)\\in A} f_{ji} - \\sum_{(i,j)\\in A} f_{ij} = x_i \\quad \\forall i \\in V \\setminus \\{3\\} $$\n    对于给定的图节点：\n    - $i=1$: $f_{21} - f_{12} = x_1$\n    - $i=2$: $(f_{12} + f_{32}) - (f_{21} + f_{23}) = x_2$\n    - $i=4$: $(f_{34} + f_{54}) - (f_{43} + f_{45}) = x_4$\n    - $i=5$: $f_{45} - f_{54} = x_5$\n\n    c. **流量容量约束：** 流量仅限于从选定的节点发出。如果节点 $i$ 未被选择（$x_i=0$），则没有流量可以离开它。这是通过将节点的总流出量与其选择状态相关联来强制执行的。一种正确且常见的写法是：\n    $$ \\sum_{(i,j)\\in A} f_{ij} \\le (|V|-1) x_i \\quad \\forall i \\in V $$\n    此处， $|V|-1 = 4$ 是可能的最大汇点数。\n    - $i=1$: $f_{12} \\le 4x_1$\n    - $i=2$: $f_{21} + f_{23} \\le 4x_2$\n    - $i=3$: $f_{32} + f_{34} \\le 4x_3$\n    - $i=4$: $f_{43} + f_{45} \\le 4x_4$\n    - $i=5$: $f_{54} \\le 4x_5$\n\n至此，二元整数规划的公式构建完成。\n\n### 最优解计算\n对于如此小规模的问题，最优解可以通过系统地枚举所有可行的连通保护区配置并比较它们的总效益来找到。一个可行的配置是规划单元的一个集合 $S \\subseteq V$，它满足：\n1.  包含根节点：$3 \\in S$。\n2.  诱导一个连通子图。\n3.  满足预算：$\\sum_{i \\in S} c_i \\le 7$。\n\n该图是一条线性路径 $1-2-3-4-5$。任何包含节点3的连通子图必须是这条路径上包含节点3的一个连续片段。我们列出所有这样的片段，检查它们的成本是否符合预算，并计算它们的效益。\n\n- **候选集 $S_1 = \\{3\\}$:**\n  - 成本：$c_3 = 2$。预算检查：$2 \\le 7$ (可行)。\n  - 效益：$b_3 = 4$。\n\n- **候选集 $S_2 = \\{2, 3\\}$:**\n  - 成本：$c_2 + c_3 = 2 + 2 = 4$。预算检查：$4 \\le 7$ (可行)。\n  - 效益：$b_2 + b_3 = 5 + 4 = 9$。\n\n- **候选集 $S_3 = \\{3, 4\\}$:**\n  - 成本：$c_3 + c_4 = 2 + 1 = 3$。预算检查：$3 \\le 7$ (可行)。\n  - 效益：$b_3 + b_4 = 4 + 2 = 6$。\n\n- **候选集 $S_4 = \\{1, 2, 3\\}$:**\n  - 成本：$c_1 + c_2 + c_3 = 3 + 2 + 2 = 7$。预算检查：$7 \\le 7$ (可行)。\n  - 效益：$b_1 + b_2 + b_3 = 8 + 5 + 4 = 17$。\n\n- **候选集 $S_5 = \\{2, 3, 4\\}$:**\n  - 成本：$c_2 + c_3 + c_4 = 2 + 2 + 1 = 5$。预算检查：$5 \\le 7$ (可行)。\n  - 效益：$b_2 + b_3 + b_4 = 5 + 4 + 2 = 11$。\n\n- **候选集 $S_6 = \\{3, 4, 5\\}$:**\n  - 成本：$c_3 + c_4 + c_5 = 2 + 1 + 3 = 6$。预算检查：$6 \\le 7$ (可行)。\n  - 效益：$b_3 + b_4 + b_5 = 4 + 2 + 7 = 13$。\n\n- **候选集 $S_7 = \\{1, 2, 3, 4\\}$:**\n  - 成本：$c_1 + c_2 + c_3 + c_4 = 3 + 2 + 2 + 1 = 8$。预算检查：$8  7$ (不可行)。\n\n- **候选集 $S_8 = \\{2, 3, 4, 5\\}$:**\n  - 成本：$c_2 + c_3 + c_4 + c_5 = 2 + 2 + 1 + 3 = 8$。预算检查：$8  7$ (不可行)。\n\n- **候选集 $S_9 = \\{1, 2, 3, 4, 5\\}$:**\n  - 成本：$c_1 + c_2 + c_3 + c_4 + c_5 = 3 + 2 + 2 + 1 + 3 = 11$。预算检查：$11  7$ (不可行)。\n\n比较可行集合的总效益：\n$B(S_1) = 4$\n$B(S_2) = 9$\n$B(S_3) = 6$\n$B(S_4) = 17$\n$B(S_5) = 11$\n$B(S_6) = 13$\n\n这些值中的最大值为17。该效益是通过选择规划单元 $\\{1, 2, 3\\}$ 实现的。总成本为7，用尽了预算。所选集合是连通的且包含根节点。因此，最优总效益为17。", "answer": "$$\\boxed{17}$$", "id": "2528291"}]}