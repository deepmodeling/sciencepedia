{"hands_on_practices": [{"introduction": "在中性理论中，本地群落的动态由内部的随机出生-死亡事件（生态漂变）和外部的个体迁入共同决定。理解迁入过程的定量影响是掌握该理论的关键一步。本练习将引导你运用基本的概率论原理，来量化在一个给定时间窗口内迁入本地群落的个体数量的期望值，从而深化对迁移参数 $m$ 如何调节本地与区域过程之间平衡的理解。[@problem_id:2512184]", "problem": "考虑一个大小固定为 $J$ 的充分混合的局域群落，其演化遵循生物多样性统一中性理论（UNTB）。在这个随机的生–死–迁入过程中，时间由离散的种群动态事件索引。在每个事件中，一个个体死亡，并被一个新个体替代。新个体要么是以每个事件的迁入概率 $m$ 从区域元群落中抽取的迁入个体，要么是以概率 $1 - m$ 由局域产生的后代。假设就其迁入结果而言，这些事件是可交换且独立的。\n\n利用伯努利试验的概率论第一性原理和期望的线性性质，推导在一个包含 $N$ 个种群动态事件的区块中，迁入个体替代事件的期望数量的表达式。然后，对于一个群落大小 $J = 10^{4}$，每个事件的迁入概率 $m = 0.05$，以及 $N = 10^{5}$ 个种群动态事件的情况，计算该表达式的值。将预期的迁入个体数量以计数形式报告。最后，从生态学角度，根据相对于 $J$ 的周转率以及由 $m$ 所隐含的局域群落与元群落之间的耦合关系，简要解释该结果。\n\n你的最终数值答案必须是一个单独的数字（一个计数）。不需要四舍五入。", "solution": "所述问题具有科学依据，提法恰当且客观。它描述了理论生态学中的一个标准模型——Hubbell的生物多样性统一中性理论（UNTB），并要求基于概率论的基本原理进行推导和计算。所有必要的参数均已提供，任务清晰明确。因此，我们可以开始解题。\n\n问题要求计算在一个包含 $N$ 个种群动态事件的区块中，迁入个体替代事件的期望数量。每个种群动态事件都是一个独立的试验，其结果只有两种可能：被迁入个体替代，或被局域产生的后代替代。这种结构对应于一系列伯努利试验。\n\n我们为每个种群动态事件 $i$ 定义一个随机变量 $X_i$，其中 $i$ 的范围从 $1$ 到 $N$。令 $X_i$ 为一个指示变量，使得：\n如果事件 $i$ 的替代是个迁入个体，则 $X_i = 1$。\n如果事件 $i$ 的替代来自局域后代，则 $X_i = 0$。\n\n根据问题陈述，迁入个体替代的概率由参数 $m$ 给出。因此，对于任何事件 $i$：\n$$P(X_i = 1) = m$$\n局域替代的概率是 $1 - m$，所以：\n$$P(X_i = 0) = 1 - m$$\n\n在 $N$ 个事件的区块中，迁入个体替代事件的总数是这些指示变量的总和：\n$$S_N = \\sum_{i=1}^{N} X_i$$\n\n我们被要求求出 $S_N$ 的期望值，记为 $E[S_N]$。我们可以使用期望的线性性质，该性质指出，随机变量之和的期望等于它们各自期望之和。无论这些变量是否独立，该性质都成立。在本问题中，事件被说明是独立的，但即使它们不独立，期望的线性性质也同样适用。\n$$E[S_N] = E\\left[ \\sum_{i=1}^{N} X_i \\right] = \\sum_{i=1}^{N} E[X_i]$$\n\n单个伯努利随机变量 $X_i$ 的期望值计算如下：\n$$E[X_i] = (1 \\times P(X_i = 1)) + (0 \\times P(X_i = 0)) = (1 \\times m) + (0 \\times (1 - m)) = m$$\n\n由于对所有事件概率 $m$ 都是常数，因此对于所有 $i \\in \\{1, 2, \\dots, N\\}$，$E[X_i] = m$。将此代入 $E[S_N]$ 的表达式中：\n$$E[S_N] = \\sum_{i=1}^{N} m = N \\cdot m$$\n这就是推导出的迁入事件期望数量的表达式。迁入个体的总数 $S_N$ 服从二项分布，$S_N \\sim \\text{Binomial}(N, m)$，其期望值已知为 $N \\cdot m$，这与我们从第一性原理的推导相符。\n\n接下来，我们必须用给定的参数来计算这个表达式的值：种群动态事件总数 $N = 10^5$，以及每个事件的迁入概率 $m = 0.05$。\n$$E[S_N] = (10^5) \\times (0.05)$$\n$$E[S_N] = 100000 \\times \\frac{5}{100} = 1000 \\times 5 = 5000$$\n因此，在 $10^5$ 个事件中，预期的迁入个体数量为 $5000$。\n\n最后，我们必须从生态学角度解释这个结果。局域群落的大小为 $J = 10^4 = 10000$ 个个体。种群动态事件的总数为 $N = 10^5$。比率 $N/J = 10^5 / 10^4 = 10$ 代表了已经发生的完整群落周转次数，其中一次周转定义为 $J$ 个个体的替换。\n我们的结果表明，在10次群落周转的过程中，我们预期有 $5000$ 个迁入个体。这意味着，平均每次周转有 $5000 / 10 = 500$ 个迁入个体替代。\n迁入概率 $m = 0.05$ 量化了局域群落与区域元群落之间的耦合程度。这意味着所有死亡事件中有 $5\\%$ 是由来自元群落的个体所替代的。这种水平的迁入可以防止局域群落变得完全孤立。在没有迁入（$m=0$）的情况下，随机的种群动态波动（生态漂变）最终将导致除一个物种外所有物种的消失。在此期间，$5000$ 个迁入个体的涌入不断地从元群落引入物种，将稀有物种从局域灭绝中拯救出来，并维持了比孤立系统中可能达到的更高水平的局域生物多样性。因此，$m=0.05$ 代表一个中度耦合的系统，其中局域漂变和区域迁入在塑造群落组成方面都发挥着重要作用。", "answer": "$$\\boxed{5000}$$", "id": "2512184"}, {"introduction": "基本生物多样性参数 $\\theta$ 是统一中性生物多样性理论的基石，它简洁地概括了在宏群落尺度上新物种的产生速率与因随机事件而灭绝的速率之间的平衡。本练习将指导你从模型的基本假设出发，推导 $\\theta$ 如何由宏群落大小 $J_{m}$ 和物种形成速率 $\\nu$ 决定。掌握这一推导并能解读 $\\theta$ 的值，对于预测群落的物种丰度分布（SAD）形态至关重要。[@problem_id:2512186]", "problem": "在一个大小固定为 $J_{m}$、经历Moran生死动态过程的零和中性集合群落中，每个出生事件以概率 $\\nu$ 导致一次点物种形成。在此中性模型的扩散极限下，已知其稳态物种丰度分布（SAD）与从一个中性演化的单倍体种群的Ewens抽样公式推导出的Fisher对数级数相匹配，其分布参数由基本生物多样性数 $\\theta$ 给出。请仅使用以下基本依据：\n- 零和中性模型的假设（生态漂变、生态等价性，以及在大小为 $J_{m}$ 的集合群落中每个出生事件的点物种形成速率为 $\\nu$）。\n- 具有点物种形成的中性生态漂变与种群遗传学中的中性等位基因模型之间的映射关系，在该模型中，稳态频率谱和抽样分布由一个单一的、按比例缩放的突变/物种形成参数 $\\theta$ 决定，该参数与种群大小和每个出生事件的突变/物种形成概率成比例。\n\n推导在此生态学背景下，$\\theta$ 如何随 $J_{m}$ 和 $\\nu$ 变化，然后计算当 $J_{m}=10^{6}$ 且 $\\nu=10^{-6}$ 时的 $\\theta$。最后，根据 $\\theta$ 的值，说明由此产生的集合群落物种丰度分布（SAD）预计是高度均匀的还是由稀有物种主导的，并用一两句话阐述你的选择理由。\n\n报告 $\\theta$ 的数值，作为一个不带单位的单一数字。无需四舍五入。", "solution": "该问题要求从零和中性集合群落模型的参数推导基本生物多样性数 $\\theta$ 的比例关系，计算 $\\theta$ 的数值，并解释由此产生的物种丰度分布（SAD）。该问题在科学上是合理的，因为它探讨了生物多样性统一中性理论（UNTB）的核心概念。所有必要信息均已提供。\n\n**推导与计算**\n\n该问题要求推导基本生物多样性参数 $\\theta$ 如何依赖于集合群落大小 $J_m$ 和物种形成速率 $\\nu$。虽然可以与种群遗传学模型进行类比，但更直接、更精确的方法是基于生态学的第一性原理，即在稳态下，新物种的产生速率必须与物种的灭绝速率相平衡。\n\n1.  **物种形成速率**：在一个大小为 $J_m$ 的集合群落中，每个出生事件都有 $\\nu$ 的概率产生一个新物种。由于该模型是一个Moran过程，每个事件都有一个出生。因此，新物种产生的总速率是 $J_m \\nu$。\n\n2.  **平衡条件与 $\\theta$ 的推导**：在稳态下，新物种的产生速率必须等于物种的总灭绝速率。正如文章正文部分所讨论的，对于一个Moran过程，这个平衡条件导出的 $\\theta$ 的精确表达式是：\n    $$\n    \\theta = \\frac{J_m \\nu}{1 - \\nu}\n    $$\n    这个公式揭示了 $\\theta$ 与 $J_m$ 和 $\\nu$ 的关系。由于问题中给出的物种形成速率 $\\nu = 10^{-6}$ 非常小，即 $\\nu \\ll 1$，分母 $(1 - \\nu)$ 非常接近1。因此，我们可以使用一个非常精确的近似来表示这种比例关系：\n    $$\n    \\theta \\approx J_m \\nu\n    $$\n    这就是所要求的比例关系推导，它表明 $\\theta$ 近似地与集合群落大小和物种形成速率的乘积成正比。\n\n接下来，我们使用给定的数据计算 $\\theta$ 的数值：$J_m = 10^6$ 和 $\\nu = 10^{-6}$。\n使用近似公式：\n$$\n\\theta \\approx (10^6) \\times (10^{-6}) = 1\n$$\n因此，基本生物多样性数为1。\n\n**物种丰度分布（SAD）的解释**\n\n问题询问由此产生的集合群落SAD预计是高度均匀的还是由稀有物种主导的。稳态SAD是Fisher对数级数，其形状由 $\\theta$ 决定。参数 $\\theta$ 代表了物种形成速率（引入新物种）与生态漂变速率（随机移除物种）之间的平衡。\n\nFisher对数级数分布的固有特征是高度不均匀，绝大多数物种丰度很低（即“稀有”），只有极少数物种丰度很高。因此，“高度均匀”的描述与对数级数SAD是根本不相容的。\n\n$\\theta$ 的大小调节了稀有物种的主导程度。$\\theta=1$ 通常被视为一个临界点。\n- 当 $\\theta \\gg 1$ 时，物种形成非常迅速，导致群落中充斥着大量新产生的、丰度极低的物种，形成一个极长的稀有物种“长尾”。\n- 当 $\\theta \\ll 1$ 时，生态漂变占主导，大多数新物种在有机会繁衍之前就已灭绝，导致群落由少数几个高丰度的物种主导。\n\n我们计算出的值为 $\\theta \\approx 1$。这个值表明，物种形成速率和由生态漂变引起的物种灭绝速率达到了一个关键的平衡。在这种情况下，群落仍然会由大量低丰度物种主导，这是中性理论预测的一个标志性特征。因此，SAD预计将由稀有物种主导。", "answer": "$$\n\\boxed{1}\n$$", "id": "2512186"}, {"introduction": "理论生态学的一个核心任务是用经验数据来严格检验模型的预测。本练习模拟了这一科学实践过程，挑战你将生态学最大熵理论（METE）的预测与一个假设的观测数据集进行比较。你将需要通过变量代换的数学推导，将观测到的遵循幂律分布的个体大小谱转换为能量分布，并利用柯尔莫哥洛夫-斯米尔诺夫（Kolmogorov-Smirnov）检验来评估其与METE预测的指数分布的一致性，这是一个融合了分析推导和计算统计学的综合性实践。[@problem_id:2512240]", "problem": "给定观测到的个体大小谱，其在直径上遵循幂律分布。根据生态学最大熵理论 (METE)，当总丰度和总能量固定时，个体能量分布呈指数形式。您的任务是通过异速生长关系将直径转换为能量，从而形式化两者之间的比较，推导该转换对隐含能量分布的影响，并实施统计拟合优度评估。\n\n形式化设定：\n- 令 $D$ 表示个体直径，其在区间 $[D_{\\min}, D_{\\max}]$ 上的连续概率密度为 $f_D(D)$。\n- 观测值在直径上遵循截断幂律：对于 $D \\in [D_{\\min}, D_{\\max}]$，$f_D(D) \\propto D^{-k}$，其中 $k  0$。\n- 令 $E$ 表示个体能量（例如，代谢率）。假设存在一个严格递增的异速生长映射 $E = c D^{z}$，其中 $c  0$ 且 $z  0$。\n- 在 METE 理论下，个体层面的能量分布是指数的，即当只施加非负性和固定平均能量的约束时，在 $[E_{\\min}, \\infty)$ 上的最大熵密度是在以最小能量 $E_{\\min}$ 为起点的偏移支撑集上的指数分布。\n\n您可以依赖的基本原理：\n- 在非负支撑集上，固定均值下的最大熵原理会产生该支撑集上的一个指数族分布。\n- 概率密度的变量转换定理：如果 $Y = g(X)$ 且 $g$ 是严格单调可微的，则对于适当的 $y$，$f_Y(y) = f_X(g^{-1}(y)) \\left| \\frac{d}{dy} g^{-1}(y) \\right|$。\n- 实数线上的 Kolmogorov–Smirnov 统计量：对于一个经验分布函数为 $F_n(x)$ 的样本和一个完全指定的连续模型分布函数 $F(x)$，Kolmogorov–Smirnov 距离为 $D_{\\mathrm{KS}} = \\sup_x \\left| F_n(x) - F(x) \\right|$。\n\n您的任务：\n1. 使用变量转换定理，从第一性原理出发，推导当 $f_D(D) \\propto D^{-k}$ 且 $E = c D^{z}$ 时，所隐含的能量分布 $f_E(E)$ 的形式。将您的结果表示为 $E$、$k$、$z$ 和 $c$ 的函数，并确定在一般的 $k$ 和 $z$ 下，所隐含的 $f_E(E)$ 是否为指数形式。\n2. 对于从 $[D_{\\min}, D_{\\max}]$ 上的截断幂律分布中抽取的 $N$ 个独立直径样本，通过 $E = c D^{z}$ 将它们转换为能量。采用观测到的最小能量作为 $E_{\\min}$，并根据固定均值下的最大熵原理，通过最大似然法拟合在 $[E_{\\min}, \\infty)$ 上的指数分布参数。利用以下事实：对于支撑在 $[E_{\\min}, \\infty)$ 上的偏移指数分布，其速率参数 $\\lambda$ 的最大似然估计由样本均值 $\\bar{E}$ 和 $E_{\\min}$ 决定。\n3. 计算转换后能量的经验分布函数与拟合的偏移指数模型 $F(E) = 1 - \\exp\\left(-\\lambda \\left(E - E_{\\min}\\right)\\right)$（对于 $E \\ge E_{\\min}$）之间的 Kolmogorov–Smirnov 距离 $D_{\\mathrm{KS}}$。返回 $D_{\\mathrm{KS}}$，形式为浮点数，保留六位小数。\n\n实现要求：\n- 必须使用 $[D_{\\min}, D_{\\max}]$ 上的逆变换采样法对截断幂律进行精确抽样。对于 $k \\ne 1$，使用在 $[D_{\\min}, D_{\\max}]$ 上的归一化形式；对于 $k = 1$，使用在该区间上的对数形式。\n- 每个测试用例使用固定的伪随机种子以确保可复现性。\n- 您的程序必须计算给定测试套件的结果，并输出一行，其中包含一个 Kolmogorov–Smirnov 距离的列表，每个测试用例一个，按指定顺序排列。每个值必须四舍五入到六位小数。\n\n测试套件：\n对于每个测试用例，参数以一个 $7$ 元组 $(N, k, D_{\\min}, D_{\\max}, c, z, \\text{seed})$ 的形式给出：\n- 测试 1：$(40000, 2.5, 1.0, 100.0, 1.0, 2.67, 7)$\n- 测试 2：$(40000, 1.0, 1.0, 1000.0, 0.5, 3.0, 11)$\n- 测试 3：$(40000, 3.5, 0.1, 10.0, 2.0, 1.5, 13)$\n- 测试 4：$(5000, 4.5, 1.0, 1.5, 1.0, 2.0, 17)$\n- 测试 5：$(5000, 2.0, 0.01, 100.0, 1.0, 10.0, 19)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[0.123456,0.234567,0.345678,0.456789,0.567890]\"）。\n- 每个条目必须是保留六位小数的浮点数。\n- 不应打印任何其他文本。", "solution": "所述问题具有科学依据，提法得当且客观。它基于理论生态学（生态学最大熵理论，METE）、异速生长标度以及统计力学（最大熵原理）的既定原则，结合严谨的数学和统计方法（变量转换定理，Kolmogorov-Smirnov 检验），提出了一个连贯的任务。该问题是自洽的，并为得出唯一解提供了所有必要信息。因此，该问题被认定为有效，我们着手进行求解。\n\n解决方案分为两部分。首先，我们进行所需的解析推导。其次，我们概述要实现的数值计算流程。\n\n**第一部分：隐含能量分布的解析推导**\n\n首要任务是在给定个体直径 $D$ 遵循截断幂律且能量随直径呈异速生长关系的情况下，推导出个体能量的概率密度函数 (PDF) $f_E(E)$。\n\n1.  **直径分布：** 直径 $D$ 在区间 $[D_{\\min}, D_{\\max}]$ 上的 PDF 由 $f_D(D) \\propto D^{-k}$ 给出，其中某个 $k  0$。要成为一个有效的 PDF，它必须被归一化。设归一化常数为 $\\mathcal{N}$。\n    $$ \\int_{D_{\\min}}^{D_{\\max}} \\mathcal{N} D^{-k} \\,dD = 1 $$\n    我们必须考虑 $D^{-k}$ 积分的两种情况。\n\n    -   对于 $k \\neq 1$：\n        $$ \\mathcal{N} \\left[ \\frac{D^{1-k}}{1-k} \\right]_{D_{\\min}}^{D_{\\max}} = \\mathcal{N} \\frac{D_{\\max}^{1-k} - D_{\\min}^{1-k}}{1-k} = 1 $$\n        $$ \\implies \\mathcal{N} = \\frac{1-k}{D_{\\max}^{1-k} - D_{\\min}^{1-k}} $$\n    -   对于 $k = 1$：\n        $$ \\mathcal{N} \\left[ \\ln(D) \\right]_{D_{\\min}}^{D_{\\max}} = \\mathcal{N} (\\ln(D_{\\max}) - \\ln(D_{\\min})) = \\mathcal{N} \\ln\\left(\\frac{D_{\\max}}{D_{\\min}}\\right) = 1 $$\n        $$ \\implies \\mathcal{N} = \\frac{1}{\\ln(D_{\\max}/D_{\\min})} $$\n    因此，完整的 PDF 是 $f_D(D) = \\mathcal{N} D^{-k}$，其中 $\\mathcal{N}$ 取相应的值。\n\n2.  **变量转换：** 能量 $E$ 通过异速生长函数 $E = g(D) = c D^z$ 与直径 $D$ 相关，其中 $c  0$ 且 $z  0$。由于 $D0$，此函数是严格递增且可微的。我们可以应用概率密度的变量转换定理：\n    $$ f_E(E) = f_D(g^{-1}(E)) \\left| \\frac{d}{dE} g^{-1}(E) \\right| $$\n    首先，我们求出反函数 $g^{-1}(E)$ 及其导数。\n    $$ E = c D^z \\implies D = \\left(\\frac{E}{c}\\right)^{1/z} \\equiv g^{-1}(E) $$\n    对 $E$ 的导数是：\n    $$ \\frac{dD}{dE} = \\frac{d}{dE} \\left[ c^{-1/z} E^{1/z} \\right] = c^{-1/z} \\frac{1}{z} E^{(1/z) - 1} = \\frac{1}{z c^{1/z}} E^{\\frac{1-z}{z}} $$\n    由于所有参数和变量都是正的，绝对值即函数本身。\n\n3.  **最终的能量分布：** 我们将这些部分代入变量转换公式：\n    $$ f_E(E) = \\left( \\mathcal{N} [D(E)]^{-k} \\right) \\cdot \\left( \\frac{1}{z c^{1/z}} E^{\\frac{1-z}{z}} \\right) $$\n    $$ f_E(E) = \\mathcal{N} \\left[ \\left(\\frac{E}{c}\\right)^{1/z} \\right]^{-k} \\cdot \\frac{1}{z c^{1/z}} E^{\\frac{1-z}{z}} $$\n    $$ f_E(E) = \\mathcal{N} \\left(\\frac{E}{c}\\right)^{-k/z} \\cdot \\frac{1}{z c^{1/z}} E^{\\frac{1-z}{z}} $$\n    $$ f_E(E) = \\mathcal{N} c^{k/z} E^{-k/z} \\cdot \\frac{1}{z c^{1/z}} E^{\\frac{1-z}{z}} $$\n    合并各项得：\n    $$ f_E(E) = \\frac{\\mathcal{N} c^{\\frac{k-1}{z}}}{z} E^{\\frac{-k+1-z}{z}} $$\n    该分布的支撑集是 $[E_{\\min}, E_{\\max}]$，其中 $E_{\\min} = c D_{\\min}^z$ 且 $E_{\\max} = c D_{\\max}^z$。这表明 $f_E(E)$ 是一个幂律分布，$f_E(E) \\propto E^{\\alpha}$，其指数为 $\\alpha = \\frac{1-k-z}{z}$。指数分布的形式为 $f(E) \\propto e^{-\\lambda E}$。推导出的幂律形式与指数形式有根本的不同。因此，在给定假设下，观测到的个体大小谱的幂律分布不会转化为最简单形式 METE 所预测的指数个体能量分布。\n\n**第二部分：数值比较算法**\n\n我们的任务是量化观测数据（转换为能量后）与 METE 预测的偏移指数分布之间的差异。\n\n1.  **从截断幂律中抽样：** 我们使用逆变换采样法生成一个包含 $N$ 个直径的样本 $\\{D_i\\}$。这需要累积分布函数 (CDF) 的逆函数 $F_D^{-1}(u)$，其中 $u$ 是来自 $[0, 1]$ 的均匀随机变量。CDF 为 $F_D(x) = \\int_{D_{\\min}}^x f_D(t) dt$。\n\n    -   对于 $k \\neq 1$：$F_D(D) = \\frac{D^{1-k} - D_{\\min}^{1-k}}{D_{\\max}^{1-k} - D_{\\min}^{1-k}}$。对其求逆得到抽样公式：\n        $$ D = \\left[ D_{\\min}^{1-k} + u(D_{\\max}^{1-k} - D_{\\min}^{1-k}) \\right]^{\\frac{1}{1-k}} $$\n    -   对于 $k = 1$：$F_D(D) = \\frac{\\ln(D) - \\ln(D_{\\min})}{\\ln(D_{\\max}) - \\ln(D_{\\min})}$。对其求逆得到：\n        $$ D = D_{\\min} \\exp\\left( u \\ln\\left(\\frac{D_{\\max}}{D_{\\min}}\\right) \\right) = D_{\\min}\\left(\\frac{D_{\\max}}{D_{\\min}}\\right)^u $$\n\n2.  **拟合 METE 模型：** 生成的直径 $\\{D_i\\}$ 通过 $E_i = c D_i^z$ 转换为能量 $\\{E_i\\}$。METE 的预测是在 $[E_{\\min}, \\infty)$ 上的一个偏移指数分布，其 PDF 为 $f(E; \\lambda) = \\lambda e^{-\\lambda(E - E_{\\min})}$。\n    -   位置参数 $E_{\\min}$ 通过样本最小值 $\\hat{E}_{\\min} = \\min(\\{E_i\\})$ 来估计。\n    -   速率参数 $\\lambda$ 通过最大似然估计法来估计。MLE $\\hat{\\lambda}$ 由下式给出：\n        $$ \\hat{\\lambda} = \\frac{1}{\\bar{E} - \\hat{E}_{\\min}} $$\n    其中 $\\bar{E}$ 是能量的样本均值。\n\n3.  **Kolmogorov-Smirnov 拟合优度：** Kolmogorov-Smirnov (KS) 统计量 $D_{\\mathrm{KS}}$ 衡量了数据的经验累积分布函数 (ECDF) $F_n(E)$ 与拟合模型的 CDF $F(E)$ 之间的最大绝对差。\n    $$ D_{\\mathrm{KS}} = \\sup_E |F_n(E) - F(E)| $$\n    对于一个排序后的样本 $\\{E_{(i)}\\}$，ECDF 是一个阶跃函数 $F_n(E) = (\\text{count of } E_j \\le E) / N$。模型的 CDF 是 $F(E) = 1 - \\exp(-\\hat{\\lambda}(E - \\hat{E}_{\\min}))$，对于 $E \\ge \\hat{E}_{\\min}$。计算使用 `scipy.stats.kstest` 进行，该函数能正确地将经验数据分布与拟合的连续模型（`scipy.stats.expon`，`loc`=$\\hat{E}_{\\min}$ 且 `scale`=$1/\\hat{\\lambda}$）进行比较。此过程为每个测试用例产生所需的 $D_{\\mathrm{KS}}$ 值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (40000, 2.5, 1.0, 100.0, 1.0, 2.67, 7),\n        (40000, 1.0, 1.0, 1000.0, 0.5, 3.0, 11),\n        (40000, 3.5, 0.1, 10.0, 2.0, 1.5, 13),\n        (5000, 4.5, 1.0, 1.5, 1.0, 2.0, 17),\n        (5000, 2.0, 0.01, 100.0, 1.0, 10.0, 19),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, k, D_min, D_max, c, z, seed = case\n        ks_dist = calculate_ks_distance(N, k, D_min, D_max, c, z, seed)\n        results.append(ks_dist)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_ks_distance(N, k, D_min, D_max, c, z, seed):\n    \"\"\"\n    Calculates the Kolmogorov-Smirnov distance for a single test case.\n\n    This function performs the following steps:\n    1. Generates a sample of diameters from a truncated power-law distribution\n       using inverse transform sampling.\n    2. Transforms the diameter sample to an energy sample via an allometric relationship.\n    3. Fits a shifted exponential distribution to the energy sample using maximum\n       likelihood estimation, consistent with the Maximum Entropy Theory of Ecology (METE).\n    4. Computes the Kolmogorov-Smirnov statistic to quantify the goodness-of-fit\n       between the empirical distribution of energies and the fitted exponential model.\n    \"\"\"\n    # Step 1: Generate diameter samples from a truncated power law.\n    rng = np.random.default_rng(seed)\n    u = rng.uniform(0.0, 1.0, N)\n    \n    diameters = None\n    if np.isclose(k, 1.0):\n        # Inverse transform sampling for the k=1 case\n        log_ratio = np.log(D_max / D_min)\n        diameters = D_min * np.exp(u * log_ratio)\n    else:\n        # Inverse transform sampling for the general k != 1 case\n        one_minus_k = 1.0 - k\n        d_min_pow = D_min**one_minus_k\n        d_max_pow = D_max**one_minus_k\n        diameters = (d_min_pow + u * (d_max_pow - d_min_pow))**(1.0 / one_minus_k)\n\n    # Step 2: Transform diameters to energies.\n    energies = c * (diameters**z)\n    \n    # Step 3: Fit a shifted exponential distribution to the energy data.\n    # The location parameter (shift) is estimated by the sample minimum.\n    E_min_obs = np.min(energies)\n    \n    # The rate parameter lambda is estimated by its Maximum Likelihood Estimator (MLE),\n    # which is 1 / (mean - min) for a shifted exponential.\n    E_bar = np.mean(energies)\n    \n    # The `scipy.stats.expon` distribution is parameterized by a location `loc`\n    # and a scale `scale`, where `scale` = 1 / lambda.\n    loc_mle = E_min_obs\n    scale_mle = E_bar - E_min_obs\n    \n    # Step 4: Compute the Kolmogorov-Smirnov distance.\n    # The kstest function compares the empirical data distribution with the\n    # CDF of a specified continuous distribution.\n    # Here, we use the fitted exponential distribution.\n    ks_statistic, _ = stats.kstest(energies, 'expon', args=(loc_mle, scale_mle))\n    \n    return round(ks_statistic, 6)\n\nsolve()\n```", "id": "2512240"}]}