{"hands_on_practices": [{"introduction": "生态过程在局部尺度上通常是非线性的，例如，种群增长率对资源浓度的响应。当我们将这些过程从局部推广到整个异质性景观时，简单的平均并不能得到正确的结果。本练习将引导你使用尺度转换理论中的一个核心工具——泰勒级数近似——来推导景观层面的平均增长率。你将发现，宏观尺度上的结果不仅取决于环境条件的平均值，还与其空间变异性（方差）以及局部响应函数的曲率密切相关，这是一个连接微观机制和宏观格局的普适性原理。[@problem_id:2531004]", "problem": "一个物种占据了景观中的许多小型生境斑块，这些斑块由 $i \\in \\{1,\\dots,n\\}$ 索引，其中非生物驱动因子 $X$（例如，资源浓度）在斑块间变化。假设 $n$ 很大，且斑块是从 $X$ 的一个平稳分布中随机抽取的，该分布的均值为 $\\mu$，方差为 $\\mathrm{Var}(X) = \\sigma^{2}$。设斑块 $i$ 中的局域人均瞬时增长率为 $g_{i} = f(X_{i})$，其中函数 $f$ 在 $\\mu$ 的一个邻域内是二阶连续可微的。景观尺度的人均瞬时增长率是跨斑块的平均值 $G = \\mathrm{E}[f(X)]$。尺度转换理论（Scale Transition Theory, STT）强调，$G$ 同时取决于 $f$ 的非线性以及由 $\\sigma^{2}$ 所编码的环境变异尺度。\n\n仅使用期望的线性性质、方差的定义以及 $f$ 在 $x=\\mu$ 处的二阶泰勒展开，推导 $G$ 的一个二阶近似，保留至 $\\sigma^{2}$ 阶的项并忽略更高阶的项。你的推导必须明确说明 $f$ 在 $\\mu$ 处的曲率如何调节环境异质性对 $G$ 的影响。\n\n然后，将你的通用结果应用于机制性响应\n$$\nf(x) \\;=\\; \\alpha\\,\\frac{x}{K+x},\n$$\n这是一个饱和资源-响应函数。使用参数值 $\\alpha = 3$ (每年)，$K = 4$ (资源单位)，均值 $\\mu = 5$ (资源单位) 以及 $\\sigma^{2} = 4$ (资源单位$^{2}$)。数值计算 $G$ 的二阶近似值。以“每年”为单位表示最终数值答案，并四舍五入到四位有效数字。\n\n最后，用一句话说明在这种情况下，环境异质性是增加还是减少了相对于 $f(\\mu)$ 的 $G$ 值，并根据 $\\mu$ 处曲率的符号来证明你的答案。\n\n注：数值答案以“每年”为单位表示；不要在最终的方框答案中包含单位。", "solution": "问题陈述需要经过验证。\n\n**步骤1：提取已知条件**\n- 一组生境斑块由 $i \\in \\{1, \\dots, n\\}$ 索引，其中 $n$ 很大。\n- 一个非生物驱动因子 $X$ 在斑块间变化，服从一个平稳分布，其均值为 $\\mathrm{E}[X] = \\mu$，方差为 $\\mathrm{Var}(X) = \\sigma^2$。\n- 斑块 $i$ 中的局域人均瞬时增长率为 $g_i = f(X_i)$。\n- 函数 $f$ 在 $\\mu$ 的一个邻域内是二阶连续可微的。\n- 景观尺度的人均瞬时增长率为 $G = \\mathrm{E}[f(X)]$。\n- 具体的响应函数为 $f(x) = \\alpha\\,\\frac{x}{K+x}$。\n- 参数值为：$\\alpha = 3$ (每年)，$K = 4$ (资源单位)，$\\mu = 5$ (资源单位) 以及 $\\sigma^2 = 4$ (资源单位$^2$)。\n- 任务要求使用泰勒展开推导 $G$ 的二阶近似，将其应用于给定函数，计算数值结果，并解释异质性的影响。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于理论生态学的既定原则，特别是尺度转换理论。该理论使用数学近似（如泰勒级数）来理解非线性生态过程如何从局域尺度扩展到景观尺度。函数 $f(x)$ 是一个标准的 Monod 或 Michaelis-Menten 型饱和函数，是描述资源依赖性增长的基础。各项前提都具有科学合理性。\n- **适定性：** 该问题提供了明确的目标和达成目标所需的所有信息。推导步骤已明确，数值计算的所有参数均已给出。存在唯一且有意义的解。\n- **客观性：** 该问题使用精确、形式化的数学和生态学术语进行陈述，没有主观或模糊的语言。\n- **完备性与一致性：** 该问题是自洽的。所提供的参数在量纲上是一致的：$\\mu$ 和 $K$ 的单位是“资源单位”，$\\sigma^2$ 的单位是“资源单位$^2$”。函数 $f(x)$ 在资源单位上是无量纲的，乘以 $\\alpha$（单位为每年）后正确地得到了一个速率。\n\n**步骤3：结论与行动**\n该问题是有效的，因为它具有科学依据、适定且内部一致。将提供解答。\n\n第一个任务是推导景观尺度增长率 $G = \\mathrm{E}[f(X)]$ 的通用二阶近似。我们从函数 $f(X)$ 在均值 $X = \\mu$ 附近的二阶泰勒级数展开开始。\n$$\nf(X) \\approx f(\\mu) + f'(\\mu)(X-\\mu) + \\frac{1}{2}f''(\\mu)(X-\\mu)^2\n$$\n该近似在 $\\mu$ 邻域内的 $X$ 值上有效，并忽略了三阶及更高阶的项。景观尺度增长率 $G$ 是 $f(X)$ 的期望值。我们将期望算子 $\\mathrm{E}[\\cdot]$ 应用于近似式的两边。\n$$\nG = \\mathrm{E}[f(X)] \\approx \\mathrm{E}\\left[f(\\mu) + f'(\\mu)(X-\\mu) + \\frac{1}{2}f''(\\mu)(X-\\mu)^2\\right]\n$$\n根据期望的线性性质，我们可以将算子分配到各项。\n$$\nG \\approx \\mathrm{E}[f(\\mu)] + \\mathrm{E}[f'(\\mu)(X-\\mu)] + \\mathrm{E}\\left[\\frac{1}{2}f''(\\mu)(X-\\mu)^2\\right]\n$$\n项 $f(\\mu)$、$f'(\\mu)$ 和 $f''(\\mu)$ 是常数，因为它们是函数 $f$ 在特定点 $\\mu$ 处求得的导数。因此，它们可以从期望中提取出来。\n$$\nG \\approx f(\\mu) + f'(\\mu)\\mathrm{E}[X-\\mu] + \\frac{1}{2}f''(\\mu)\\mathrm{E}[(X-\\mu)^2]\n$$\n现在我们计算期望项。根据定义，与均值的偏差的期望为零：\n$$\n\\mathrm{E}[X-\\mu] = \\mathrm{E}[X] - \\mathrm{E}[\\mu] = \\mu - \\mu = 0\n$$\n与均值的偏差的平方的期望是方差的定义：\n$$\n\\mathrm{E}[(X-\\mu)^2] = \\mathrm{Var}(X) = \\sigma^2\n$$\n将这些结果代回 $G$ 的表达式，得到二阶近似：\n$$\nG \\approx f(\\mu) + f'(\\mu) \\cdot 0 + \\frac{1}{2}f''(\\mu)\\sigma^2\n$$\n$$\nG \\approx f(\\mu) + \\frac{1}{2}f''(\\mu)\\sigma^2\n$$\n这个结果表明，景观尺度的平均增长率 $G$ 与平均环境下的增长率 $f(\\mu)$ 的偏差，是一个与环境方差 $\\sigma^2$ 以及响应函数在均值处的曲率 $f''(\\mu)$ 成正比的项。\n\n接下来，我们将这个通用结果应用于具体函数 $f(x) = \\alpha \\frac{x}{K+x}$。为此，我们必须计算 $f(x)$ 的一阶和二阶导数。\n函数为 $f(x) = \\alpha x (K+x)^{-1}$。\n使用乘法法则，一阶导数为：\n$$\nf'(x) = \\frac{d}{dx} \\left[ \\alpha x (K+x)^{-1} \\right] = \\alpha \\left[ 1 \\cdot (K+x)^{-1} + x \\cdot (-1)(K+x)^{-2} \\right] = \\alpha \\left[ \\frac{1}{K+x} - \\frac{x}{(K+x)^2} \\right]\n$$\n$$\nf'(x) = \\alpha \\left[ \\frac{(K+x)-x}{(K+x)^2} \\right] = \\frac{\\alpha K}{(K+x)^2}\n$$\n通过对 $f'(x) = \\alpha K (K+x)^{-2}$ 求导得到二阶导数：\n$$\nf''(x) = \\frac{d}{dx} \\left[ \\alpha K (K+x)^{-2} \\right] = \\alpha K \\left[ -2(K+x)^{-3} \\cdot 1 \\right] = -\\frac{2\\alpha K}{(K+x)^3}\n$$\n现在，我们在 $x=\\mu$ 处计算 $f(x)$ 和 $f''(x)$ 的值：\n$$\nf(\\mu) = \\frac{\\alpha \\mu}{K+\\mu}\n$$\n$$\nf''(\\mu) = -\\frac{2\\alpha K}{(K+\\mu)^3}\n$$\n将这些代入我们对 $G$ 的近似式中：\n$$\nG \\approx \\frac{\\alpha \\mu}{K+\\mu} + \\frac{1}{2} \\left( -\\frac{2\\alpha K}{(K+\\mu)^3} \\right) \\sigma^2 = \\frac{\\alpha \\mu}{K+\\mu} - \\frac{\\alpha K \\sigma^2}{(K+\\mu)^3}\n$$\n现在我们代入给定的数值：$\\alpha = 3$，$K = 4$，$\\mu = 5$ 以及 $\\sigma^2 = 4$。\n首先，计算 $f(\\mu)$：\n$$\nf(\\mu) = \\frac{3 \\cdot 5}{4+5} = \\frac{15}{9} = \\frac{5}{3}\n$$\n接下来，计算修正项 $\\frac{1}{2}f''(\\mu)\\sigma^2$：\n$$\n\\frac{1}{2}f''(\\mu)\\sigma^2 = -\\frac{\\alpha K \\sigma^2}{(K+\\mu)^3} = -\\frac{3 \\cdot 4 \\cdot 4}{(4+5)^3} = -\\frac{48}{9^3} = -\\frac{48}{729}\n$$\n将分数 $\\frac{48}{729}$ 的分子和分母同除以它们的最大公约数 $3$ 进行化简，得到 $\\frac{16}{243}$。所以修正项是 $-\\frac{16}{243}$。\n现在，我们计算 $G$ 的近似值：\n$$\nG \\approx \\frac{5}{3} - \\frac{16}{243} = \\frac{5 \\cdot 81}{3 \\cdot 81} - \\frac{16}{243} = \\frac{405}{243} - \\frac{16}{243} = \\frac{389}{243}\n$$\n为了获得四舍五入到四位有效数字的数值：\n$$\nG \\approx \\frac{389}{243} \\approx 1.600823045...\n$$\n四舍五入到四位有效数字得到 $1.601$。\n\n最后，我们判断环境异质性是增加还是减少了相对于 $f(\\mu)$ 的 $G$ 值。这个差异由项 $\\frac{1}{2}f''(\\mu)\\sigma^2$ 给出。由于方差 $\\sigma^2$ 是非负的，影响的符号由曲率 $f''(\\mu)$ 的符号决定。对于给定的饱和函数，$f''(\\mu) = -\\frac{2\\alpha K}{(K+\\mu)^3}$。鉴于 $\\alpha$、$K$ 和 $\\mu$ 都是正的生物学参数，很明显 $f''(\\mu)$ 是负的。负曲率意味着函数是向下凹的（或简称为凹函数）。\n环境异质性降低了相对于 $f(\\mu)$ 的 $G$ 值，因为函数 $f(x)$ 是凹函数，这由其二阶导数 $f''(\\mu)$ 的负号所指示。", "answer": "$$\n\\boxed{1.601}\n$$", "id": "2531004"}, {"introduction": "生态学的尺度依赖性不仅体现在过程上，也深刻地嵌入在空间格局中。生境斑块的物理形态，特别是其边缘部分的比例，直接影响着栖息于其中的物种。本练习将从几何学的角度探讨“边缘效应”，分析斑块的周长-面积比如何决定受边缘影响的区域比例。你将从简单的几何形状（圆形和方形）出发，并进一步探索当边界变得极其复杂，甚至呈现为分形时，边缘效应的标度律会发生怎样的改变，从而揭示空间形态本身的尺度依赖特性。[@problem_id:2530870]", "problem": "一个平面上的孤立生境斑块由一个紧集 $S \\subset \\mathbb{R}^{2}$ 表示，其面积为有限值 $A$，边界为 $\\partial S$。定义一个“边缘影响区”，它包含 $S$ 中所有与边界 $\\partial S$ 的欧几里得距离小于或等于缓冲宽度 $w$ 的点。将该区域的面积记为 $E(w)$，受边缘影响的斑块比例记为 $f(w) = E(w)/A$。假设 $w$ 足够小，使得内平行集（$S$ 被半径为 $w$ 的圆盘进行的形态学腐蚀）为非空。\n\n从闵可夫斯基膨胀和腐蚀的定义以及关于平面上平行体的经过充分检验的几何事实出发——特别是，对于一个具有足够光滑边界的凸集，向外偏移 $w$ 的区域面积等于原始面积加上边界长度乘以 $w$，再加上一个与 $w^{2}$ 成正比的曲率项——推导出 $f(w)$ 关于 $A$、$S$ 的周长 $P$ 和 $w$ 的表达式，当边界光滑性允许时，保留到 $w^{2}$ 阶的项。然后，对于两种具有精确几何形状的简单图形，即半径为 $R$ 的圆和边长为 $L$ 的正方形，计算在 $0  w  \\min\\{R, L/2\\}$ 条件下 $f(w)$ 的精确值，并说明其对 $w$ 的主导依赖关系是如何由比率 $P/A$ 控制的。\n\n接下来，考虑一个斑块，其边界是分形的，即其闵可夫斯基-布利甘（计盒）维数 $D$ 满足 $1  D  2$。假设用长度为 $\\varepsilon$ 的尺子测量的尺度依赖周长在 $\\varepsilon$ 很小时满足标度关系 $P(\\varepsilon) \\asymp C_{D}\\,\\varepsilon^{1-D}$，其中 $C_{D}$ 是一个有限的正闵可夫斯基容度。利用将尺度 $w$ 下的边缘影响区面积与边界的 $w$-邻域（闵可夫斯基香肠）的测度联系起来的第一性原理，推导出在 $w$ 很小时 $f(w)$ 关于 $A$、$w$、$D$ 和 $C_{D}$ 的标度关系。\n\n最后，将两种情况——具有有限周长 $P$ 的可求长边界和 $1  D  2$ 的分形边界——整合为一个单一的紧凑参数表达式 $f(w)$，该表达式能够捕捉 $f(w)$ 对 $w$ 的主导阶依赖关系，并用 $A$、$w$ 以及两个形态学参数 $K$ 和 $\\beta$ 来表示，你必须在推导过程中明确定义这两个参数。将你的最终答案表示为那个关于 $A$、$w$、$K$ 和 $\\beta$ 的单一紧凑解析表达式。不需要单位。不要四舍五入；提供一个精确的符号表达式。", "solution": "所提出的问题是一个关于生态斑块中边缘效应的尺度依赖几何学的多阶段推导。在开始求解之前，需要进行严格的验证。\n\n**问题验证**\n\n步骤1：提取已知条件\n- 生境斑块是一个紧集 $S \\subset \\mathbb{R}^{2}$，具有有限面积 $A$ 和边界 $\\partial S$。\n- “边缘影响区”包含 $S$ 中与边界 $\\partial S$ 的欧几里得距离小于或等于 $w$ 的点。\n- $E(w)$ 是该区域的面积。\n- $f(w) = E(w)/A$ 是受边缘影响的斑块比例。\n- $w$ 很小，确保内平行集为非空。\n- 对于一个具有光滑边界的凸集，向外偏移 $w$ 的区域面积由一个对应于 Steiner 定理的公式给出。\n- 任务1：对于一个周长为 $P$、面积为 $A$ 的形状，推导出 $f(w)$ 直至 $w^2$ 阶的表达式。\n- 任务2：计算半径为 $R$ 的圆和边长为 $L$ 的正方形的精确 $f(w)$，并展示 $P/A$ 比率的作用。\n- 任务3：对于一个分形维数 $D \\in (1, 2)$ 且周长标度关系为 $P(\\varepsilon) \\asymp C_{D}\\,\\varepsilon^{1-D}$ 的边界，推导出 $w$ 很小时 $f(w)$ 的标度关系。\n- 任务4：将可求长（$D=1$）和分形（$1  D  2$）两种情况整合为一个由 $A$、$w$ 以及两个新参数 $K$ 和 $\\beta$ 参数化的单一表达式 $f(w)$。\n\n步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学依据充分**：该问题基于成熟的数学概念，即积分几何（闵可夫斯基和、Steiner 公式）和分形几何（闵可夫斯基-布利甘维数）。这些概念在理论生态学中被标准地应用于模拟空间格局，如边缘效应。其前提在事实上和科学上都是合理的。\n- **适定性良好**：所有术语都经过数学上的精确定义。任务是顺序的，每一步都建立在前一步的基础上，从而导出一个唯一的、可推导的结果。对 $w$、$R$ 和 $L$ 的约束确保了几何构造是明确定义的。\n- **客观性**：语言正式，没有主观或含糊不清的术语。\n- **缺陷清单**：该问题没有违反任何指定的无效标准。它不是不健全、不可形式化、不完整、不切实际、不适定、微不足道或无法验证的。这是一个数学中的标准问题。\n- **缺陷清单**：该问题没有违反任何指定的无效标准。它不是不健全、不可形式化、不完整、不切实际、不适定、微不足道或无法验证的。这是一个数学中的标准问题。\n\n步骤3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、附有推理的解答。\n\n**推导**\n\n问题有四个部分，我们将按顺序解决。\n\n第1部分：光滑、可求长边界的边缘效应\n边缘影响区定义为斑块 $S$ 内部与边界 $\\partial S$ 距离不大于 $w$ 的点的集合。这对应于原始斑块 $S$ 与其被半径为 $w$ 的圆盘（记为 $B_w$）进行形态学腐蚀后的集合之间的集合论差集。腐蚀即为内平行集，$S \\ominus B_w = \\{x \\in S \\mid B_w(x) \\subseteq S\\}$。因此，边缘区的面积为 $E(w) = A - \\text{Area}(S \\ominus B_w)$。\n\n问题提到了 Steiner 公式，该公式用于计算*向外*平行集（闵可夫斯基膨胀）的面积。对于 $\\mathbb{R}^2$ 中的凸集 $K$，完整的 Steiner 定理也给出了在小距离 $w$ 下*内*平行集（腐蚀）的面积。其公式为：\n$$\n\\text{Area}(K \\ominus B_w) = A - Pw + \\pi w^2\n$$\n其中 $A$ 是 $K$ 的面积，$P$ 是其周长。这个公式对于 $\\mathbb{R}^2$ 中的任何凸集都是精确的，包括像正方形这样有角点的图形，而不仅仅是具有光滑边界的集合。问题中提到光滑性是为了证明保留 $w^2$ 项是合理的，该项与边界的总曲率有关（对于任何简单闭合曲线，总曲率为 $2\\pi$，因此有 $\\pi w^2$ 项）。\n\n使用这个定理，我们得到边缘影响区的面积为：\n$$\nE(w) = A - (A - Pw + \\pi w^2) = Pw - \\pi w^2\n$$\n因此，受边缘影响的斑块比例为：\n$$\nf(w) = \\frac{E(w)}{A} = \\frac{Pw - \\pi w^2}{A} = \\frac{P}{A}w - \\frac{\\pi}{A}w^2\n$$\n这个表达式在 $w^2$ 阶内有效。\n\n第2部分：应用于简单几何图形\n我们将推导出的原理应用于圆形和正方形。\n\n对于半径为 $R$ 的圆：\n面积为 $A = \\pi R^2$，周长为 $P = 2\\pi R$。对 $w$ 的条件是 $w  R$。内平行集是一个半径为 $R-w$ 的同心圆。\n边缘区的面积是两个面积之差：\n$$\nE(w) = A_{\\text{circle}}(R) - A_{\\text{circle}}(R-w) = \\pi R^2 - \\pi(R-w)^2 = \\pi R^2 - \\pi(R^2 - 2Rw + w^2) = 2\\pi Rw - \\pi w^2\n$$\n比例为：\n$$\nf(w) = \\frac{E(w)}{A} = \\frac{2\\pi Rw - \\pi w^2}{\\pi R^2} = \\frac{2}{R}w - \\frac{1}{R^2}w^2\n$$\n比率 $P/A = (2\\pi R) / (\\pi R^2) = 2/R$。$f(w)$ 的主导阶项是 $(P/A)w = (2/R)w$，这与我们的一般推导是一致的。\n\n对于边长为 $L$ 的正方形：\n面积为 $A = L^2$，周长为 $P = 4L$。对 $w$ 的条件是 $w  L/2$。正方形是一个凸集，所以我们可以直接应用第1部分的结果。\n$$\nE(w) = Pw - \\pi w^2 = 4Lw - \\pi w^2\n$$\n比例为：\n$$\nf(w) = \\frac{E(w)}{A} = \\frac{4Lw - \\pi w^2}{L^2} = \\frac{4}{L}w - \\frac{\\pi}{L^2}w^2\n$$\n比率 $P/A = (4L)/(L^2) = 4/L$。主导阶依赖关系同样是 $(P/A)w = (4/L)w$。这表明对于可求长边界，当 $w$ 很小时，边缘效应比例的主要决定因素是周长与面积之比。\n\n第3部分：分形边界的边缘效应\n对于一个闵可夫斯基-布利甘维数 $D \\in (1, 2)$ 的边界 $\\partial S$，有限周长 $P$ 的概念不再适用。取而代之的是，边界的“长度”是尺度依赖的，表示为 $P(\\varepsilon) \\asymp C_D \\varepsilon^{1-D}$，其中 $C_D$ 是 $D$ 维闵可夫斯基容度。\n\n边缘影响区面积 $E(w)$ 对应于边界的 $w$-邻域的面积，该邻域也被称为闵可夫斯基香肠。这种邻域的面积可以通过考虑用大小为 $w$ 的圆盘（或方盒）对边界 $\\partial S$ 进行最小覆盖来估算。\n覆盖一个维数为 $D$ 的集合所需的这类圆盘数量 $N(w)$ 满足以下标度关系：\n$$\nN(w) \\asymp \\text{const} \\cdot w^{-D}\n$$\n周长标度关系 $P(\\varepsilon) \\sim N(\\varepsilon)\\varepsilon$ 意味着 $C_D \\varepsilon^{1-D} \\sim (N(\\varepsilon)\\varepsilon)$，这将 $N(w)$ 与 $C_D$ 联系起来。具体来说，$N(w) \\asymp C_D w^{-D}$。\n边缘区的面积 $E(w)$ 近似等于覆盖圆盘的数量乘以每个圆盘的面积，后者与 $w^2$ 成正比。\n$$\nE(w) \\approx N(w) \\times (\\text{一个} w \\text{-圆盘的面积}) \\asymp (C_D w^{-D}) (\\pi w^2)\n$$\n忽略量级为1的无量纲常数，其标度关系为：\n$$\nE(w) \\asymp C_D w^{2-D}\n$$\n进行量纲一致性检查：根据 $P(\\varepsilon)$ 的定义，$[C_D] = [\\text{长度}]^D$，所以 $[E(w)] = [\\text{长度}]^D \\times [\\text{长度}]^{2-D} = [\\text{长度}]^2$，这对于面积是正确的。\n\n因此，对于分形边界，边缘面积比例 $f(w)$ 的标度关系为：\n$$\nf(w) = \\frac{E(w)}{A} \\asymp \\frac{C_D}{A} w^{2-D}\n$$\n\n第4部分：两种情况的整合\n最后的任务是创建一个单一的参数表达式，用于描述 $f(w)$ 的主导阶依赖关系，并且该表达式能同时涵盖可求长边界和分形边界。\n\n情况1：可求长边界。此时 $D=1$。第1部分得到的主导阶项为 $f(w) \\asymp \\frac{P}{A}w$。\n情况2：分形边界。此时 $1  D  2$。第3部分的结果为 $f(w) \\asymp \\frac{C_D}{A} w^{2-D}$。\n\n我们观察到，分形标度定律可以推广到可求长的情况。如果在分形公式中令 $D=1$，我们得到：\n$$\nf(w) \\asymp \\frac{C_1}{A} w^{2-1} = \\frac{C_1}{A} w\n$$\n根据定义 $P(\\varepsilon) \\asymp C_D \\varepsilon^{1-D}$，令 $D=1$ 得到 $P(\\varepsilon) \\asymp C_1 \\varepsilon^0 = C_1$。这意味着对于一条可求长曲线，当尺子尺寸 $\\varepsilon$ 很小时，测得的周长不再依赖于 $\\varepsilon$，且这个极限就是真实周长 $P$。因此，我们可以确定 $C_1 = P$。分形公式正确地再现了可求长情况下的主导项。\n\n因此，$D \\in [1, 2)$ 的标度行为可以被统一。题目要求我们引入两个参数 $K$ 和 $\\beta$。我们提出主导阶依赖关系的通用形式为：\n$$\nf(w) = \\frac{K}{A} w^{\\beta}\n$$\n通过将其与我们推导出的标度定律进行比较，我们如下定义这些参数：\n- 参数 $K$ 是广义周长常数，等于边界的 $D$ 维闵可夫斯基容度 $C_D$。对于 $D=1$，$K=P$，即标准周长。对于 $1  D  2$，$K=C_D$，即分形周长标度关系中的前置因子。其物理量纲为 $[\\text{长度}]^D$。\n- 参数 $\\beta$ 是边缘标度指数，定义为 $\\beta = 2 - D$，其中 $D$ 是边界的闵可夫斯基-布利甘维数。对于可求长边界（$D=1$），$\\beta=1$，产生对 $w$ 的线性依赖关系。对于分形边界（$1  D  2$），指数是次线性的，$0  \\beta  1$。\n\n这个单一表达式概括了在各种边界复杂度下，生境斑块形态与边缘效应程度之间的主导性一阶关系。", "answer": "$$\n\\boxed{\\frac{K}{A} w^{\\beta}}\n$$", "id": "2530870"}, {"introduction": "真实的生态系统是多尺度过程共同作用的复杂综合体。例如，物种的分布可能在宏观尺度上受到气候等环境因素的筛选，而在微观尺度上则由种间竞争决定其能否共存。本练习是一个计算建模任务，要求你构建一个集合群落模型，其中环境筛选和生物竞争这两个过程被明确设定在不同的空间尺度上运行。通过分析模型产生的物种组成差异（β多样性）如何随尺度变化，你将学会如何构建和检验关于多尺度过程相互作用的生态学假说。[@problem_id:2530970]", "problem": "构建一个双尺度元群落共现模型，其中环境筛选在粗粒度（区域间）上运作，而生物相互作用在细粒度（区域内）上运作，并推导出一个关于成对beta多样性如何随粒度变化的、可检验的预测。使用以下基本依据：将成对beta多样性定义为一减去Jaccard相似性，使用伯努利存在指标来模拟环境筛选下的区域适宜性，以及使用无放回抽样来近似模拟限制局域丰富度的竞争排斥。\n\n需要实现的模型规范：\n\n- 区域环境筛选。存在 $S$ 个物种，由 $s \\in \\{1,\\dots,S\\}$ 索引，以及 $R=2$ 个区域，由 $r \\in \\{1,2\\}$ 索引。每个区域有一个标量环境 $E_r \\in [0,1]$。每个物种有一个生态位最适点 $\\mu_s \\in [0,1]$ 和一个共同的生态位耐受度（环境广度）$\\sigma  0$。物种 $s$ 在区域 $r$ 中区域性适宜的概率为\n$$\np_{s,r} \\;=\\; \\exp\\!\\left(-\\frac{(E_r - \\mu_s)^2}{2\\sigma^2}\\right).\n$$\n假设 $\\mu_s$ 是固定的，并作为 $[0,1]$ 上的确定性均匀网格被程序所知，以避免随机变异，$\\mu_s = \\frac{s - 0.5}{S}$。\n\n- 细粒度生物相互作用。在每个区域 $r$ 内，由于竞争（限制性相似和竞争排斥的唯象表示），每个局域样点最多可容纳 $K$ 个物种。样点的群落是通过从区域适宜物种库中无放回地抽取 $K$ 个物种来组合而成的。设 $M_r = \\sum_{s=1}^S p_{s,r}$ 表示区域 $r$ 中区域适宜物种库的期望大小。为遵守容量限制，定义 $K_{\\text{eff},r} = \\min(K, M_r)$。对于在同一区域 $r$ 内独立抽样的两个样点，共享物种的期望数量为\n$$\n\\mathbb{E}[I_r] \\;=\\; \\frac{K_{\\text{eff},r}^2}{M_r},\n$$\n并且这两个样点（它们的并集）的总丰富度的期望值为\n$$\n\\mathbb{E}[U_r] \\;=\\; 2K_{\\text{eff},r} \\;-\\; \\frac{K_{\\text{eff},r}^2}{M_r}.\n$$\n通过这些期望值的比率来近似期望Jaccard相似性（大数定律近似），\n$$\nJ^{\\text{fine}}_r \\;\\approx\\; \\frac{\\mathbb{E}[I_r]}{\\mathbb{E}[U_r]} \\;=\\; \\frac{K_{\\text{eff},r}^2 / M_r}{2K_{\\text{eff},r} - K_{\\text{eff},r}^2 / M_r},\n$$\n并将细粒度非相似性（区域 $r$ 内的成对beta多样性）定义为\n$$\n\\beta^{\\text{fine}}_r \\;=\\; 1 - J^{\\text{fine}}_r.\n$$\n\n- 区域间的粗粒度环境筛选。对于具有适宜性概率 $\\{p_{s,1}\\}$ 和 $\\{p_{s,2}\\}$ 的两个区域，共享物种的期望数量为\n$$\nC \\;=\\; \\sum_{s=1}^S p_{s,1} \\, p_{s,2},\n$$\n并且并集中物种的期望数量为\n$$\nU \\;=\\; \\sum_{s=1}^S \\big(p_{s,1} + p_{s,2} - p_{s,1} p_{s,2}\\big).\n$$\n将期望Jaccard相似性近似为 $J^{\\text{coarse}} \\approx C/U$，并定义粗粒度非相似性为\n$$\n\\beta^{\\text{coarse}} \\;=\\; 1 - J^{\\text{coarse}}.\n$$\n\n- 尺度依赖性预测。对于给定的参数集，定义尺度对比\n$$\n\\Delta \\beta \\;=\\; \\beta^{\\text{coarse}} \\;-\\; \\overline{\\beta^{\\text{fine}}} \\quad \\text{其中} \\quad \\overline{\\beta^{\\text{fine}}} \\;=\\; \\frac{\\beta^{\\text{fine}}_1 + \\beta^{\\text{fine}}_2}{2}.\n$$\n一个正的 $\\Delta \\beta$ 表示beta多样性从细粒度（区域内）到粗粒度（区域间）增加；一个负的 $\\Delta \\beta$ 表示相反情况。\n\n算法说明：\n\n- 使用指定的 $\\mu_s$ 网格确定性地实现模型。\n- 对每个测试案例，计算 $\\Delta \\beta$ 作为一个浮点数，并四舍五入到 $6$ 位小数。\n- 您的程序必须生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n\n测试套件：\n\n为以下参数集 $(S,\\sigma,E_1,E_2,K)$ 计算 $\\Delta \\beta$：\n\n- 案例 1：$(1000, 0.08, 0.2, 0.8, 40)$。\n- 案例 2：$(1000, 0.20, 0.3, 0.7, 10)$。\n- 案例 3：$(1000, 0.12, 0.5, 0.5, 15)$。\n- 案例 4：$(1000, 0.10, 0.15, 0.85, 200)$。\n- 案例 5：$(1000, 0.30, 0.1, 0.9, 3)$。\n\n最终输出格式：\n\n- 您的程序应精确打印一行，其中包含按上述案例顺序排列的 5 个四舍五入值的列表，例如，形如\n$$\n[\\Delta\\beta_1,\\Delta\\beta_2,\\Delta\\beta_3,\\Delta\\beta_4,\\Delta\\beta_5].\n$$\n的输出行。不应打印任何额外文本。", "solution": "问题陈述已经过验证，被认定为有效。它在科学上基于已确立的生态学原理，在数学上是适定的，并且没有歧义或矛盾。所提出的模型是元群落生态学中的一个标准理论结构，它将基于生态位的环境筛选与局域竞争的唯象模型相结合。所使用的近似方法，例如通过期望值的比率来估计Jaccard指数和通过固定容量抽样来模拟竞争，都得到了明确的定义，并且是该领域中常见的易于处理的方法。因此，该问题可以按陈述求解。\n\n任务是为几组参数集计算beta多样性的尺度对比 $\\Delta \\beta$。该对比衡量了粗空间粒度（区域间）和细空间粒度（区域内）beta多样性之间的差异。计算过程根据所提供的模型规范确定性地进行。\n\n设给定案例的参数为 $(S, \\sigma, E_1, E_2, K)$。分步过程如下：\n\n1.  **定义物种生态位最适点**：$S$ 个物种的生态位最适点 $\\mu_s$ 均匀分布在区间 $[0, 1]$ 上。对于每个物种 $s \\in \\{1, \\dots, S\\}$，生态位最适点由以下公式给出：\n    $$\n    \\mu_s = \\frac{s - 0.5}{S}\n    $$\n\n2.  **计算区域适宜性概率**：对于每个物种 $s$ 和每个区域 $r \\in \\{1, 2\\}$，物种适宜于区域环境 $E_r$ 的概率 $p_{s,r}$ 由具有耐受度 $\\sigma$ 的高斯生态位函数确定：\n    $$\n    p_{s,r} = \\exp\\left(-\\frac{(E_r - \\mu_s)^2}{2\\sigma^2}\\right)\n    $$\n    这将产生两个概率向量，$\\{p_{s,1}\\}_{s=1}^S$ 和 $\\{p_{s,2}\\}_{s=1}^S$。\n\n3.  **计算细粒度（区域内）beta多样性**：此计算对每个区域独立进行。\n    a.  首先，我们计算每个区域 $r$ 的区域适宜物种库的期望大小 $M_r$：\n        $$\n        M_r = \\sum_{s=1}^S p_{s,r}\n        $$\n    b.  接下来，我们确定能够栖息于一个局域样点的有效物种数 $K_{\\text{eff},r}$，这考虑了局域丰富度不能超过区域物种库大小的限制：\n        $$\n        K_{\\text{eff},r} = \\min(K, M_r)\n        $$\n    c.  区域内beta多样性 $\\beta^{\\text{fine}}_r$ 是根据两个局域样点之间的Jaccard相似性定义的。Jaccard相似性通过期望交集大小与期望并集大小的比率来近似。\n        $$\n        J^{\\text{fine}}_r \\approx \\frac{\\mathbb{E}[I_r]}{\\mathbb{E}[U_r]} = \\frac{K_{\\text{eff},r}^2 / M_r}{2K_{\\text{eff},r} - K_{\\text{eff},r}^2 / M_r}\n        $$\n        如果 $K_{\\text{eff},r} = 0$，样点为空，我们定义它们的Jaccard相似性为 $1$，因此 $\\beta^{\\text{fine}}_r = 0$。否则，$\\beta^{\\text{fine}}_r = 1 - J^{\\text{fine}}_r$ 的表达式可以进行代数简化：\n        $$\n        \\beta^{\\text{fine}}_r = 1 - \\frac{K_{\\text{eff},r}^2 / M_r}{2K_{\\text{eff},r} - K_{\\text{eff},r}^2 / M_r} = 1 - \\frac{K_{\\text{eff},r}}{2M_r - K_{\\text{eff},r}} = \\frac{2M_r - K_{\\text{eff},r} - K_{\\text{eff},r}}{2M_r - K_{\\text{eff},r}} = \\frac{2(M_r - K_{\\text{eff},r})}{2M_r - K_{\\text{eff},r}}\n        $$\n        此计算对两个区域都进行，得到 $\\beta^{\\text{fine}}_1$ 和 $\\beta^{\\text{fine}}_2$。\n\n4.  **计算平均细粒度beta多样性**：平均细粒度beta多样性 $\\overline{\\beta^{\\text{fine}}}$ 是两个区域值的算术平均值：\n    $$\n    \\overline{\\beta^{\\text{fine}}} = \\frac{\\beta^{\\text{fine}}_1 + \\beta^{\\text{fine}}_2}{2}\n    $$\n\n5.  **计算粗粒度（区域间）beta多样性**：此指标 $\\beta^{\\text{coarse}}$ 量化了整个区域物种库之间的非相似性。\n    a.  首先，我们计算两个区域间共享物种的期望数量 $C$，以及两个区域物种库并集的期望大小 $U$：\n        $$\n        C = \\sum_{s=1}^S p_{s,1} p_{s,2}\n        $$\n        $$\n        U = \\sum_{s=1}^S (p_{s,1} + p_{s,2} - p_{s,1} p_{s,2})\n        $$\n    b.  粗粒度Jaccard相似性近似为 $J^{\\text{coarse}} \\approx C/U$。相应的beta多样性为：\n        $$\n        \\beta^{\\text{coarse}} = 1 - J^{\\text{coarse}} = 1 - \\frac{C}{U} = \\frac{U-C}{U}\n        $$\n        鉴于 $U-C = \\sum (p_{s,1} + p_{s,2} - 2p_{s,1}p_{s,2})$，这变为：\n        $$\n        \\beta^{\\text{coarse}} = \\frac{\\sum_{s=1}^S (p_{s,1} + p_{s,2} - 2p_{s,1}p_{s,2})}{\\sum_{s=1}^S (p_{s,1} + p_{s,2} - p_{s,1}p_{s,2})}\n        $$\n\n6.  **计算尺度对比**：最后，尺度对比 $\\Delta \\beta$ 是粗粒度beta多样性与平均细粒度beta多样性之间的差值：\n    $$\n    \\Delta \\beta = \\beta^{\\text{coarse}} - \\overline{\\beta^{\\text{fine}}}\n    $$\n每个参数集的最终结果按要求四舍五入到 $6$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_delta_beta(S, sigma, E1, E2, K):\n    \"\"\"\n    Computes the scale-dependent beta diversity contrast Delta_beta.\n\n    Args:\n        S (int): Total number of species in the global pool.\n        sigma (float): Common niche tolerance (environmental breadth).\n        E1 (float): Environment of region 1.\n        E2 (float): Environment of region 2.\n        K (int): Local community species capacity due to competition.\n\n    Returns:\n        float: The calculated Delta_beta value.\n    \"\"\"\n    \n    # Step 1: Define Species Niche Optima\n    s_indices = np.arange(1, S + 1)\n    mu_s = (s_indices - 0.5) / S\n\n    # Step 2: Calculate Regional Suitability Probabilities\n    # Vectorized calculation for all species\n    p_s1 = np.exp(-((E1 - mu_s)**2) / (2 * sigma**2))\n    p_s2 = np.exp(-((E2 - mu_s)**2) / (2 * sigma**2))\n\n    # Step 3: Calculate Fine-Grain (Within-Region) Beta Diversity\n    beta_fine = []\n    for p_s_r in [p_s1, p_s2]:\n        # a. Compute expected regional pool size\n        M_r = np.sum(p_s_r)\n\n        # b. Determine effective local capacity\n        K_eff_r = min(K, M_r)\n        \n        # c. Calculate beta_fine_r\n        if K_eff_r == 0:\n            # If a site holds 0 species, communities are empty.\n            # Jaccard similarity is 1 (convention for empty sets), so beta diversity is 0.\n            beta_fine_r = 0.0\n        else:\n            # Numerically stable simplified formula: beta = 2(M-K_eff)/(2M-K_eff)\n            numerator = 2 * (M_r - K_eff_r)\n            denominator = 2 * M_r - K_eff_r\n            if denominator == 0:\n                 # This case implies M_r = K_eff_r / 2, which is impossible since K_eff_r = M_r,\n                 # unless K_eff_r = M_r = 0, which is handled above.\n                 # Conservatively, if it happens, Jaccard is 1 and beta is 0.\n                 beta_fine_r = 0.0\n            else:\n                 beta_fine_r = numerator / denominator\n\n        beta_fine.append(beta_fine_r)\n    \n    beta_fine_1, beta_fine_2 = beta_fine\n\n    # Step 4: Calculate Average Fine-Grain Beta Diversity\n    beta_fine_avg = (beta_fine_1 + beta_fine_2) / 2.0\n\n    # Step 5: Calculate Coarse-Grain (Between-Region) Beta Diversity\n    # a. Compute expected shared species (C) and union size (U)\n    C = np.sum(p_s1 * p_s2)\n    U = np.sum(p_s1 + p_s2 - p_s1 * p_s2)\n    \n    # b. Calculate beta_coarse\n    if U == 0:\n        # If union is empty, regions are identical and empty. Jaccard is 1, beta is 0.\n        beta_coarse = 0.0\n    else:\n        # J_coarse = C / U\n        # beta_coarse = 1 - J_coarse\n        beta_coarse = (U - C) / U\n\n    # Step 6: Compute the Scaling Contrast\n    delta_beta = beta_coarse - beta_fine_avg\n    \n    return delta_beta\n\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (S, sigma, E1, E2, K)\n        (1000, 0.08, 0.2, 0.8, 40),\n        (1000, 0.20, 0.3, 0.7, 10),\n        (1000, 0.12, 0.5, 0.5, 15),\n        (1000, 0.10, 0.15, 0.85, 200),\n        (1000, 0.30, 0.1, 0.9, 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        S, sigma, E1, E2, K = case\n        result = calculate_delta_beta(S, sigma, E1, E2, K)\n        # Round to 6 decimal places\n        results.append(round(result, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2530970"}]}