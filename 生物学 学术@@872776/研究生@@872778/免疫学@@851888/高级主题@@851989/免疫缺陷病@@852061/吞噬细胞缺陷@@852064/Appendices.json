{"hands_on_practices": [{"introduction": "吞噬细胞杀灭病原体的能力通常依赖于一个称为“氧化爆发”的强大生化级联反应。在分析该系统失灵时（例如在慢性肉芽肿病中）会发生什么之前，理解健康过程中的化学计量关系至关重要。本练习提供了一个动手实践的机会，从初始燃料NADPH开始计算关键活性氧的产量，从而巩固所涉及的基本化学转化。[@problem_id:2880997]", "problem": "专业吞噬细胞利用膜结合的烟酰胺腺嘌呤二核苷酸磷酸氧化酶（NOX2）来启动氧化爆发。在此过程中，来自还原型烟酰胺腺嘌呤二核苷酸磷酸（NADPH）的电子流向分子氧，在吞噬体内部生成超氧阴离子。假设以下公认的步骤和条件成立：\n\n1. 每个还原型烟酰胺腺嘌呤二核苷酸磷酸（NADPH）分子提供两个电子，这两个电子一次一个地传递给分子氧，产生超氧阴离子。\n2. 在所考虑的条件下，超氧化物歧化为过氧化氢的反应是定量的。\n3. 髓过氧化物酶（MPO）存在且非速率限制步骤，氯离子和质子充足，且所有产生的过氧化氢都被MPO消耗以生成次氯酸。\n4. 忽略副反应（例如Fenton反应和过氧化氢酶活性），并假设还原当量没有泄漏给其他电子受体。\n\n当NOX2恰好消耗 $1$ nmol的还原型烟酰胺腺嘌呤二核苷酸磷酸（NADPH）时，请仅使用电荷守恒和质量守恒以及上述步骤的标准氧化还原化学计量，计算超氧化物歧化反应生成的过氧化氢（$\\mathrm{H_2O_2}$）和MPO反应生成的次氯酸（$\\mathrm{HOCl}$）的理论产率。\n\n请以一个二元行向量 $\\big(\\mathrm{H_2O_2},\\,\\mathrm{HOCl}\\big)$ 的形式报告您的答案，单位为nmol。请以精确值表示（不进行四舍五入）。", "solution": "该问题要求从给定量的还原型烟酰胺腺嘌呤二核苷酸磷酸（NADPH）出发，计算过氧化氢（$H_2O_2$）和次氯酸（$HOCl$）的理论产率。解决方案是质量和电荷守恒定律的直接应用，通过平衡的化学方程式来表达。我们得到的初始量是$1$ nmol的NADPH。\n\n根据问题定义，该过程分三个离散的、连续的步骤展开。\n\n**第1步：由烟酰胺腺嘌呤二核苷酸磷酸氧化酶（NOX2）生成超氧阴离子（$O_2^{\\cdot-}$）**\n问题陈述每个NADPH分子提供两个电子。氧化半反应为：\n$$NADPH \\rightarrow NADP^+ + H^+ + 2e^-$$\n这两个电子被传递给分子氧（$O_2$）以产生超氧化物。将一个$O_2$分子还原为一个$O_2^{\\cdot -}$分子需要一个电子：\n$$O_2 + e^- \\rightarrow O_2^{\\cdot -}$$\n为了消耗来自一个NADPH分子的两个电子，需要两个$O_2$分子，每个分子接受一个电子。因此，由NOX2催化的总反应是：\n$$NADPH + 2O_2 \\rightarrow NADP^+ + H^+ + 2O_2^{\\cdot -}$$\n根据此化学计量，1摩尔的NADPH产生2摩尔的$O_2^{\\cdot -}$。考虑到消耗了$1$ nmol的NADPH，生成的超氧化物量为：\n$$n_{O_2^{\\cdot -}} = 1 \\text{ nmol } NADPH \\times \\frac{2 \\text{ mol } O_2^{\\cdot -}}{1 \\text{ mol } NADPH} = 2 \\text{ nmol}$$\n\n**第2步：超氧化物歧化为过氧化氢（$H_2O_2$）**\n问题陈述该反应是定量的。超氧化物歧化是一种歧化反应，其中一个超氧阴离子被氧化，另一个被还原。平衡的化学方程式为：\n$$2O_2^{\\cdot -} + 2H^+ \\rightarrow H_2O_2 + O_2$$\n化学计量关系表明，生成$1$摩尔的$H_2O_2$需要$2$摩尔的$O_2^{\\cdot -}$。使用第1步中产生的$2$ nmol $O_2^{\\cdot -}$，生成的$H_2O_2$的理论产率为：\n$$n_{H_2O_2} = 2 \\text{ nmol } O_2^{\\cdot -} \\times \\frac{1 \\text{ mol } H_2O_2}{2 \\text{ mol } O_2^{\\cdot -}} = 1 \\text{ nmol}$$\n这是第一个要求的量。\n\n**第3步：由髓过氧化物酶（MPO）生成次氯酸（$HOCl$）**\n问题指明所有产生的$H_2O_2$都被MPO消耗，且氯离子（$Cl^-$）和质子（$H^+$）充足。由MPO催化的反应为：\n$$H_2O_2 + Cl^- + H^+ \\rightarrow HOCl + H_2O$$\n该反应中$H_2O_2$和$HOCl$的化学计量比为$1:1$。由于所有生成的$1$ nmol $H_2O_2$都被消耗，形成的$HOCl$的量为：\n$$n_{HOCl} = 1 \\text{ nmol } H_2O_2 \\times \\frac{1 \\text{ mol } HOCl}{1 \\text{ mol } H_2O_2} = 1 \\text{ nmol}$$\n这是第二个要求的量。\n\n问题要求以一个二元行向量的形式给出答案，分别表示生成的$H_2O_2$和形成的$HOCl$的产率，单位为 nmol。\n计算得出的$H_2O_2$产率为$1$ nmol。\n计算得出的$HOCl$产率为$1$ nmol。\n因此，最终的答案向量是 $\\big(1,\\,1\\big)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1  1 \\end{pmatrix}}$$", "id": "2880997"}, {"introduction": "如果吞噬细胞无法到达感染部位，其杀伤能力就毫无用处。这个过程涉及沿着血管壁滚动然后牢固地停驻，这是在白细胞黏附缺陷症（LAD）等疾病中会失效的关键第一步。本练习使用一个简化的生物物理模型来探索细胞黏附的动力学，让你能够定量地理解分子结合速率的变化如何极大地影响中性粒细胞停下来并响应炎症信号的能力。[@problem_id:2880994]", "problem": "患有白细胞黏附缺陷症（Leukocyte Adhesion Deficiency, LAD）的中性粒细胞，由于整合素激活存在缺陷，在炎症内皮上的停滞能力受损。考虑一个简化的生物物理模型，该模型描述了在滚动过程中由整合素-细胞间黏附分子（integrin–Intercellular Adhesion Molecule, ICAM）结合介导的中性粒细胞在内皮上的停滞过程。将此黏附过程在细胞层面理想化为一个双态过程：一个滚动状态 $\\mathrm{R}$ 和一个停滞状态 $\\mathrm{A}$。假设如下：\n- 当至少形成一个有效的整合素-ICAM键时，发生从 $\\mathrm{R}$ 到 $\\mathrm{A}$ 的转换，其有效结合速率为 $k_{\\mathrm{on}} L$。其中，$k_{\\mathrm{on}}$ 是微观二维结合速率常数，$L$ 代表一个有效配体可用性因子，该因子与可及的ICAM密度和流动下的相遇频率成正比。\n- 当化学键断裂到足以恢复滚动时，发生从 $\\mathrm{A}$ 到 $\\mathrm{R}$ 的转换，其有效解离速率为 $k_{\\mathrm{off}}$，该速率聚合了在主导壁面剪切应力下化学键失效的各种途径。\n- 大系综、遍历性和时间尺度分离的假设，使得用一个由时齐速率的连续时间双态马尔可夫过程决定的停滞细胞稳态分数 $p_{\\mathrm{A}}^{\\ast}$ 来描述是合理的。\n\n一项患者特异性干预增强了整合素的激活，使得结合速率加倍，解离速率减半，即 $k_{\\mathrm{on}} \\mapsto 2\\,k_{\\mathrm{on}}$ 和 $k_{\\mathrm{off}} \\mapsto k_{\\mathrm{off}}/2$，而 $L$ 保持不变。\n\n仅从可逆双态过程的质量作用动力学和概率通量的稳态平衡出发，首先推导 $p_{\\mathrm{A}}^{\\ast}$ 关于 $k_{\\mathrm{on}}$、$L$ 和 $k_{\\mathrm{off}}$ 的通用表达式。然后，定义无量纲结合参数 $\\alpha \\equiv \\dfrac{k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}$，并将干预后新的稳态停滞分数 $p_{\\mathrm{A,new}}^{\\ast}$ 表示为仅含 $\\alpha$ 的闭式解析函数。\n\n您的最终答案必须是仅用 $\\alpha$ 表示的单个解析表达式。不要包含单位。不要报告中间步骤。不要提供比率；报告 $p_{\\mathrm{A,new}}^{\\ast}$ 本身。", "solution": "我们首先为细胞处于停滞状态$\\mathrm{A}$的概率（记为$p_{\\mathrm{A}}$）建立主方程。系统由两个互斥的状态$\\mathrm{R}$和$\\mathrm{A}$组成，因此它们的概率之和在任何时候都必须为1：\n$$p_{\\mathrm{R}}(t) + p_{\\mathrm{A}}(t) = 1$$\n状态$\\mathrm{A}$中群体的变化率由从$\\mathrm{R}$流入$\\mathrm{A}$的通量与从$\\mathrm{A}$流出到$\\mathrm{R}$的通量之间的平衡决定。从$\\mathrm{R}$到$\\mathrm{A}$的转换以有效速率$k_{\\mathrm{on}} L$发生，而从$\\mathrm{A}$到$\\mathrm{R}$的转换以速率$k_{\\mathrm{off}}$发生。基于质量作用动力学，$p_{\\mathrm{A}}$的时间演化由以下常微分方程描述：\n$$\\frac{dp_{\\mathrm{A}}}{dt} = p_{\\mathrm{R}}(t) \\cdot (k_{\\mathrm{on}} L) - p_{\\mathrm{A}}(t) \\cdot k_{\\mathrm{off}}$$\n我们关心的是稳态条件，此时概率不再随时间变化。这通过将时间导数设为零来定义，即 $\\frac{dp_{\\mathrm{A}}}{dt} = 0$。令 $p_{\\mathrm{A}}^{\\ast}$ 和 $p_{\\mathrm{R}}^{\\ast}$ 表示稳态概率。平衡方程变为：\n$$p_{\\mathrm{R}}^{\\ast} \\cdot (k_{\\mathrm{on}} L) = p_{\\mathrm{A}}^{\\ast} \\cdot k_{\\mathrm{off}}$$\n该方程表示，在稳态下，从$\\mathrm{R}$到$\\mathrm{A}$的总概率通量等于从$\\mathrm{A}$到$\\mathrm{R}$的总概率通量。\n\n为了求解 $p_{\\mathrm{A}}^{\\ast}$，我们使用稳态下的概率守恒：$p_{\\mathrm{R}}^{\\ast} = 1 - p_{\\mathrm{A}}^{\\ast}$。将此代入平衡方程得到：\n$$(1 - p_{\\mathrm{A}}^{\\ast}) \\cdot (k_{\\mathrm{on}} L) = p_{\\mathrm{A}}^{\\ast} \\cdot k_{\\mathrm{off}}$$\n我们现在通过代数方法求解 $p_{\\mathrm{A}}^{\\ast}$：\n$$k_{\\mathrm{on}} L - p_{\\mathrm{A}}^{\\ast} (k_{\\mathrm{on}} L) = p_{\\mathrm{A}}^{\\ast} k_{\\mathrm{off}}$$\n$$k_{\\mathrm{on}} L = p_{\\mathrm{A}}^{\\ast} (k_{\\mathrm{on}} L + k_{\\mathrm{off}})$$\n这就得出了停滞细胞稳态分数的通用表达式：\n$$p_{\\mathrm{A}}^{\\ast} = \\frac{k_{\\mathrm{on}} L}{k_{\\mathrm{on}} L + k_{\\mathrm{off}}}$$\n这就完成了任务的第一部分。\n\n对于第二部分，我们分析干预的效果。新的结合速率常数是 $k'_{\\mathrm{on}} = 2 k_{\\mathrm{on}}$，新的解离速率是 $k'_{\\mathrm{off}} = k_{\\mathrm{off}}/2$。将这些新参数代入我们推导的通用表达式中，即可求得新的稳态停滞分数 $p_{\\mathrm{A,new}}^{\\ast}$：\n$$p_{\\mathrm{A,new}}^{\\ast} = \\frac{k'_{\\mathrm{on}} L}{k'_{\\mathrm{on}} L + k'_{\\mathrm{off}}} = \\frac{(2 k_{\\mathrm{on}}) L}{(2 k_{\\mathrm{on}}) L + \\frac{k_{\\mathrm{off}}}{2}}$$\n问题要求此表达式仅用无量纲参数 $\\alpha \\equiv \\dfrac{k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}$ 来表示。为此，我们将 $p_{\\mathrm{A,new}}^{\\ast}$ 表达式的分子和分母同时除以原始的解离速率 $k_{\\mathrm{off}}$：\n$$p_{\\mathrm{A,new}}^{\\ast} = \\frac{\\frac{2 k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}}{\\frac{2 k_{\\mathrm{on}} L}{k_{\\mathrm{off}}} + \\frac{k_{\\mathrm{off}}/2}{k_{\\mathrm{off}}}}$$\n化简各项，我们得到：\n$$p_{\\mathrm{A,new}}^{\\ast} = \\frac{2 \\left(\\frac{k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}\\right)}{2 \\left(\\frac{k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}\\right) + \\frac{1}{2}}$$\n现在，我们将定义 $\\alpha = \\frac{k_{\\mathrm{on}} L}{k_{\\mathrm{off}}}$ 代入此方程：\n$$p_{\\mathrm{A,new}}^{\\ast} = \\frac{2 \\alpha}{2 \\alpha + \\frac{1}{2}}$$\n为了以更简化的闭式形式呈现，我们将分子和分母同乘以 $2$：\n$$p_{\\mathrm{A,new}}^{\\ast} = \\frac{2 \\cdot (2 \\alpha)}{2 \\cdot (2 \\alpha + \\frac{1}{2})} = \\frac{4 \\alpha}{4 \\alpha + 1}$$\n这就是所要求的、作为无量纲结合参数 $\\alpha$ 函数的新稳态停滞分数的最终表达式。", "answer": "$$\\boxed{\\frac{4\\alpha}{4\\alpha + 1}}$$", "id": "2880994"}, {"introduction": "真实的免疫反应是复杂的，整合了多个连续的步骤。为了真正理解和比较不同的吞噬细胞缺陷，我们可以构建能够捕捉从趋化到杀伤整个过程的计算模型。这项高级练习挑战你构建并使用一个概率模型来预测细菌的清除率，从而提供一个强大的系统级视角，来审视不同阶段的缺陷（如LAD与CGD）是如何独特地损害中性粒细胞的整体功能的。[@problem_id:2881011]", "problem": "您的任务是开发一个基于第一性原理的、机制性的概率模型，用于计算单个中性粒细胞在固定观察窗口期内清除至少一个细菌的概率，然后使用该模型评估哪些参数扰动最能模拟临床吞噬细胞缺陷。您的模型必须整合三个阶段：趋化相遇、吞噬摄入和胞内杀伤。推导和实现必须遵循以下有科学依据的基础：\n\n- 在固定时间窗口内，中性粒细胞与细菌之间的随机相遇事件可建模为泊松过程。如果每分钟相遇率恒定为 $\\lambda$，则在 $T$ 分钟内的相遇次数是一个均值为 $\\mu = \\lambda T$ 的泊松随机变量。\n- 如果这些事件中的每一个都以概率 $p$ 独立成功，则成功事件的数量是一个均值为 $p \\mu$ 的稀疏化泊松随机变量（泊松稀疏化）。\n- 如果后续每个阶段都包含对先前事件的独立伯努利过滤，则序贯稀疏化会产生一个泊松随机变量，其均值等于各阶段概率与上游泊松均值的乘积。\n\n请仅使用这些基本事实以及标准概率法则和量纲分析；不要假设或使用非此基础所能推导出的任何快捷公式。\n\n**模型设定**（所有符号均为适用的随机变量或参数，除非指定单位，否则所有数值均为无量纲）：\n\n- **趋化与相遇**：\n  - 令 $s \\in [0,1]$ 表示一个无量纲的趋化敏感性因子。\n  - 令 $v$ 为中性粒细胞速度，单位为微米/分钟（$\\mu\\mathrm{m}/\\mathrm{min}$）。\n  - 令 $\\sigma$ 为有效搜索截面积，单位为平方微米（$\\mu\\mathrm{m}^2$），用于描述几何捕获效率。\n  - 令 $\\rho$ 为细菌数密度，单位为细胞数/立方微米（$\\mathrm{cells}/\\mu\\mathrm{m}^3$）。\n  - 令 $T$ 为观察持续时间，单位为分钟。\n  - 假设每分钟相遇率为 $\\lambda = s\\, v\\, \\sigma\\, \\rho$，因此窗口期内的预期相遇次数为 $\\mu = \\lambda T$。\n- **吞噬作用**：\n  - 每次相遇独立地以概率 $p_{\\mathrm{in}} \\in [0,1]$ 导致摄入。\n- **杀伤作用**：\n  - 每个被摄入的细菌独立地以概率 $p_{\\mathrm{kill}} \\in [0,1]$ 被杀死。\n- **通过参数扰动模拟临床缺陷**（所有扰动乘数均在 $(0,1]$ 范围内）：\n  - 趋化缺陷（白细胞黏附缺陷(LAD)）：将 $s$ 乘以 $r_{\\mathrm{chem}}$。\n  - 摄入缺陷（例如，调理作用或吞噬受体损伤）：将 $p_{\\mathrm{in}}$ 乘以 $r_{\\mathrm{ingest}}$。\n  - 杀伤缺陷（慢性肉芽肿病(CGD)）：将 $p_{\\mathrm{kill}}$ 乘以 $r_{\\mathrm{kill}}$。\n\n**任务A**：从第一性原理出发，推导清除概率的表达式。清除概率定义为在持续时间为 $T$ 的窗口期内，单个中性粒细胞杀死至少一个细菌的概率。您的推导必须从泊松相遇模型和上述独立性假设开始。\n\n**任务B**：实现一个程序，对下方的每个测试用例，计算：\n- 基线清除概率（无扰动），\n- 在每种扰动类别单独作用下（仅趋化、仅摄入、仅杀伤）的清除概率，\n- 预测的清除概率与所提供的观测清除代理值最接近（绝对差最小）的扰动类别的索引。出于本测试的目的，观测清除代理值被精确定义为模型在由给定索引 $i_{\\mathrm{obs}} \\in \\{0,1,2\\}$ 指定的扰动类别下的预测清除概率，其中 $0$ 表示趋化缺陷（白细胞黏附缺陷(LAD)），$1$ 表示摄入缺陷，$2$ 表示杀伤缺陷（慢性肉芽肿病(CGD)）。如果绝对差出现平局，选择最小的索引。\n\n**数值和单位要求**：\n- 使用的单位为：$v$ 为 $\\mu\\mathrm{m}/\\mathrm{min}$，$\\sigma$ 为 $\\mu\\mathrm{m}^2$，$\\rho$ 为 $\\mathrm{cells}/\\mu\\mathrm{m}^3$，以及 $T$ 为 $\\mathrm{min}$。\n- 所有概率必须表示为 $[0,1]$ 范围的小数，并四舍五入到恰好 $6$ 位小数。\n\n**测试套件**：\n每个测试用例是一个元组 $(s, v, \\sigma, \\rho, T, p_{\\mathrm{in}}, p_{\\mathrm{kill}}, r_{\\mathrm{chem}}, r_{\\mathrm{ingest}}, r_{\\mathrm{kill}}, i_{\\mathrm{obs}})$，其值如下：\n- 用例 1：$(0.8, 12, 50, 1\\times 10^{-4}, 30, 0.6, 0.7, 0.3, 0.5, 0.2, 2)$\n- 用例 2：$(0.1, 5, 20, 1\\times 10^{-5}, 10, 0.5, 0.9, 0.2, 0.3, 0.9, 0)$\n- 用例 3：$(1.0, 20, 100, 5\\times 10^{-4}, 60, 0.8, 0.95, 0.7, 0.1, 0.8, 1)$\n- 用例 4：$(0.6, 8, 30, 5\\times 10^{-5}, 20, 0.9, 0.9, 0.9, 0.05, 0.9, 1)$\n\n**程序输入和输出**：\n- 您的程序必须嵌入上述测试套件（无用户输入）。\n- 对每个测试用例，输出一个包含 $5$ 个条目的列表：$[\\text{baseline}, \\text{chem}, \\text{ingest}, \\text{kill}, \\text{best\\_idx}]$，其中前四个是四舍五入到恰好 $6$ 位小数的清除概率，$\\text{best\\_idx}$ 是如上文所定义的、与观测代理值最佳匹配的缺陷类别的整数索引，取值于 $\\{0,1,2\\}$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，每个元素是对应一个测试用例的列表。例如：$[[x_1,x_2,x_3,x_4,i_1],[y_1,y_2,y_3,y_4,i_2],\\dots]$。", "solution": "该任务是推导并实现一个模型，用以计算单个中性粒细胞在固定时间窗口内杀死至少一个细菌的概率。此过程分为三个连续阶段：趋化相遇、吞噬摄入和胞内杀伤。\n\n该模型的基础是断言中性粒细胞和细菌之间的相遇是由泊松过程描述的随机事件。设 $N_E$ 为表示在 $T$ 分钟的观察持续时间内此类相遇次数的随机变量。相遇率 $\\lambda$ 由几个因子的乘积给出：\n$$ \\lambda = s \\cdot v \\cdot \\sigma \\cdot \\rho $$\n此处，$s$ 是一个无量纲的趋化敏感性因子，$v$ 是中性粒细胞的速度（单位 $\\mu\\mathrm{m}/\\mathrm{min}$），$\\sigma$ 是其有效搜索截面（单位 $\\mu\\mathrm{m}^2$），$\\rho$ 是细菌密度（单位 $\\mathrm{cells}/\\mu\\mathrm{m}^3$）。量纲分析证实 $\\lambda$ 的单位是 $\\mathrm{min}^{-1}$（事件/分钟），这与速率参数的预期相符。\n因此，在时间窗口 $T$ 内的总相遇次数 $N_E$ 服从均值为 $\\mu = \\lambda T$ 的泊松分布：\n$$ N_E \\sim \\mathrm{Poisson}(\\mu) \\quad \\text{其中} \\quad \\mu = s \\cdot v \\cdot \\sigma \\cdot \\rho \\cdot T $$\n观察到 $k$ 次相遇的概率由泊松概率质量函数给出：\n$$ P(N_E = k) = \\frac{e^{-\\mu} \\mu^k}{k!} \\quad \\text{对于 } k \\in \\{0, 1, 2, ...\\} $$\n\n随后的摄入和杀伤阶段被建模为独立的伯努利试验，用于过滤前一阶段的事件。这个过程被称为泊松稀疏化。\n首先，一次相遇以概率 $p_{\\mathrm{in}}$ 导致成功摄入。设 $N_I$ 为被摄入细菌数量的随机变量。根据泊松稀疏化原理，如果来自泊松($\\mu$)过程的事件以概率 $p$被独立选择，则所选事件的数量也服从一个新的泊松分布，其均值为 $p\\mu$。因此，$N_I$ 是一个均值为 $\\mu_I$ 的泊松随机变量：\n$$ \\mu_I = p_{\\mathrm{in}} \\cdot \\mu = p_{\\mathrm{in}} \\cdot s \\cdot v \\cdot \\sigma \\cdot \\rho \\cdot T $$\n$$ N_I \\sim \\mathrm{Poisson}(\\mu_I) $$\n\n其次，每个被摄入的细菌以独立的概率 $p_{\\mathrm{kill}}$ 被杀死。设 $N_K$ 为被杀死细菌数量的随机变量。再次将稀疏化原理应用于摄入的泊松过程，$N_K$ 服从均值为 $\\mu_K$ 的泊松分布：\n$$ \\mu_K = p_{\\mathrm{kill}} \\cdot \\mu_I = p_{\\mathrm{kill}} \\cdot p_{\\mathrm{in}} \\cdot \\mu = p_{\\mathrm{kill}} \\cdot p_{\\mathrm{in}} \\cdot s \\cdot v \\cdot \\sigma \\cdot \\rho \\cdot T $$\n$$ N_K \\sim \\mathrm{Poisson}(\\mu_K) $$\n\n这就完成了被杀死细菌数量分布的推导。问题要求计算“清除概率” $P_{\\text{clear}}$，定义为至少有一个细菌被杀死的概率。这对应于事件 $N_K \\ge 1$。计算这个概率最直接的方法是通过其补集，即零个细菌被杀死的概率 $P(N_K = 0)$。\n使用均值为 $\\mu_K$ 的泊松随机变量的概率质量函数：\n$$ P(N_K = 0) = \\frac{e^{-\\mu_K} (\\mu_K)^0}{0!} = e^{-\\mu_K} $$\n因此，清除概率为：\n$$ P_{\\text{clear}} = P(N_K \\ge 1) = 1 - P(N_K = 0) = 1 - e^{-\\mu_K} $$\n将均值 $\\mu_K$ 的完整表达式代入，我们得到清除概率的最终表达式：\n$$ P_{\\text{clear}}(s, v, \\sigma, \\rho, T, p_{\\mathrm{in}}, p_{\\mathrm{kill}}) = 1 - \\exp(-s \\cdot v \\cdot \\sigma \\cdot \\rho \\cdot T \\cdot p_{\\mathrm{in}} \\cdot p_{\\mathrm{kill}}) $$\n这是任务A所要求从第一性原理推导出的表达式。\n\n对于任务B，我们必须以计算方式实现此模型。对于每个测试用例，我们计算一组值：\n1. 使用测试用例中提供的未扰动参数计算基线清除概率 $P_{\\text{baseline}}$。\n2. 三种扰动后的清除概率，对应于特定的临床缺陷：\n   -   趋化缺陷 (LAD)：$P_{\\text{chem}}$，通过将 $s$ 替换为 $s \\cdot r_{\\mathrm{chem}}$ 来计算。\n   -   摄入缺陷：$P_{\\text{ingest}}$，通过将 $p_{\\mathrm{in}}$ 替换为 $p_{\\mathrm{in}} \\cdot r_{\\mathrm{ingest}}$ 来计算。\n   -   杀伤缺陷 (CGD)：$P_{\\text{kill}}$，通过将 $p_{\\mathrm{kill}}$ 替换为 $p_{\\mathrm{kill}} \\cdot r_{\\mathrm{kill}}$ 来计算。\n3. 与“观测”清除代理值最佳匹配的扰动类别的索引。该代理值由问题唯一定义为模型在由索引 $i_{\\mathrm{obs}} \\in \\{0, 1, 2\\}$ 指定的扰动类别下的自身输出，其中 $0$ 对应趋化缺陷， $1$ 对应摄入缺陷， $2$ 对应杀伤缺陷。“最佳匹配”是通过找到代理值与三个扰动概率（$P_{\\text{chem}}$、$P_{\\text{ingest}}$、$P_{\\text{kill}}$）之间的最小绝对差来确定的。如果出现平局，则选择最小的索引。\n\n每个测试用例的计算算法如下：\na. 计算基线条件和三种扰动条件下各自的复合均值参数 $\\mu_K$。\nb. 使用推导出的公式 $P_{\\text{clear}} = 1 - e^{-\\mu_K}$ 计算所需的四个概率（$P_{\\text{baseline}}$、$P_{\\text{ingest}}$、$P_{\\text{chem}}$、$P_{\\text{kill}}$）。\nc. 使用给定的索引 $i_{\\mathrm{obs}}$ 从扰动概率集合中确定观测代理概率 $P_{\\text{obs}}$。\nd. 计算绝对差：$|P_{\\text{chem}} - P_{\\text{obs}}|$，$|P_{\\text{ingest}} - P_{\\text{obs}}|$，和 $|P_{\\text{kill}} - P_{\\text{obs}}|$。\ne. 确定与最小差对应的索引（$0$、$1$ 或 $2$）。此索引是最终所需的输出值 `best_idx`。\nf. 在最终输出中，所有概率值必须四舍五入到恰好 $6$ 位小数。\n这就完成了程序的逻辑设计。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the neutrophil clearance problem by deriving a probabilistic model and\n    evaluating it against several test cases representing clinical deficiencies.\n    \"\"\"\n    \n    # Test cases as provided in the problem statement.\n    # Each tuple is (s, v, sigma, rho, T, p_in, p_kill, r_chem, r_ingest, r_kill, i_obs)\n    test_cases = [\n        (0.8, 12, 50, 1e-4, 30, 0.6, 0.7, 0.3, 0.5, 0.2, 2),\n        (0.1, 5, 20, 1e-5, 10, 0.5, 0.9, 0.2, 0.3, 0.9, 0),\n        (1.0, 20, 100, 5e-4, 60, 0.8, 0.95, 0.7, 0.1, 0.8, 1),\n        (0.6, 8, 30, 5e-5, 20, 0.9, 0.9, 0.9, 0.05, 0.9, 1),\n    ]\n\n    def calculate_clearance_prob(s, v, sigma, rho, T, p_in, p_kill):\n        \"\"\"\n        Calculates the clearance probability based on the derived model.\n        P_clear = 1 - exp(-s * v * sigma * rho * T * p_in * p_kill)\n        \"\"\"\n        if any(p  0 for p in [s, v, sigma, rho, T, p_in, p_kill]):\n             return 0.0\n\n        mu_k = s * v * sigma * rho * T * p_in * p_kill\n        return 1.0 - np.exp(-mu_k)\n\n    all_results = []\n    for case in test_cases:\n        s, v, sigma, rho, T, p_in, p_kill, r_chem, r_ingest, r_kill, i_obs = case\n\n        # 1. Calculate baseline clearance probability\n        p_baseline = calculate_clearance_prob(s, v, sigma, rho, T, p_in, p_kill)\n\n        # 2. Calculate perturbed clearance probabilities\n        p_chem_defect = calculate_clearance_prob(s * r_chem, v, sigma, rho, T, p_in, p_kill)\n        p_ingest_defect = calculate_clearance_prob(s, v, sigma, rho, T, p_in * r_ingest, p_kill)\n        p_kill_defect = calculate_clearance_prob(s, v, sigma, rho, T, p_in, p_kill * r_kill)\n\n        perturbed_probs = [p_chem_defect, p_ingest_defect, p_kill_defect]\n\n        # 3. Determine the \"observed\" proxy probability\n        p_obs = perturbed_probs[i_obs]\n\n        # 4. Find the best-matching perturbation\n        # Calculate absolute differences from the observed proxy\n        diffs = np.abs(np.array(perturbed_probs) - p_obs)\n        \n        # Find the index of the minimum difference. np.argmin handles ties by choosing the first occurrence (smallest index).\n        best_idx = np.argmin(diffs)\n\n        # 5. Assemble the results for this case\n        result_list = [p_baseline, p_chem_defect, p_ingest_defect, p_kill_defect, best_idx]\n        all_results.append(result_list)\n\n    # Format the final output string as per the exact requirement\n    output_strs = []\n    for res in all_results:\n        # res contains 4 floats and 1 integer\n        # The floats must be rounded to exactly 6 decimal places.\n        s = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f},{res[4]}]\"\n        output_strs.append(s)\n\n    # Final print statement must be a single line.\n    print(f\"[{','.join(output_strs)}]\")\n\nsolve()\n```", "id": "2881011"}]}