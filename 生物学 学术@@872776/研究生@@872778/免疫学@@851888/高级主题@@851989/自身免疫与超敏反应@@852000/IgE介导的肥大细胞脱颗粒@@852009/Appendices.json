{"hands_on_practices": [{"introduction": "为了防止过度的炎症反应，肥大细胞的响应必须受到严密调控。一个关键的负反馈机制是交联的FcεRI受体从细胞表面的快速内化。本练习将使用一个简单而有效的一阶动力学模型来探究这一受体下调过程。通过推导表面受体的半衰期，您将对肥大细胞在初次激活后能够多快地发生功能性脱敏获得定量的理解 [@problem_id:2807402]。", "problem": "I型（速发型）超敏反应中的肥大细胞活化，是由与高亲和力IgE受体（Fc epsilon receptor I, FcεRI）结合的免疫球蛋白E (IgE) 发生交联而引发的。交联后，表面的FcεRI会被内化。假设在抗原暴露后的一个早期、短暂的时间窗口内，表面受体密度 $R(t)$ 遵循具有恒定内化速率的一级内化动力学，其模型为常微分方程 $\\frac{dR}{dt}=-k_{int} R$，初始条件为 $R(0)=R_{0}$。假设在此区间内，受体的再循环或新合成可以忽略不计。从这个微分方程和给定的初始条件出发，推导出表面FcεRI密度下降到其初始值的 $50\\%$ 时的时间 $t_{50}$ 的解析表达式（即 $R(t_{50})=\\frac{1}{2}R_{0}$）。请以仅包含 $k_{int}$ 的单一解析表达式的形式提供最终答案。不要代入数值。如果需要报告数值，可假设 $k_{int}$ 的单位是 $\\mathrm{min}^{-1}$，时间的单位是 $\\mathrm{min}$；但是，对于本题，你的最终答案必须保持符号形式。\n\n此外，请简要地从机理上解释（限于$2$–$3$句话），该模型所描述的内化动力学如何在IgE介导的I型超敏反应中，因重复抗原暴露而导致肥大细胞快速功能性脱敏。你的解释将进行定性评估，不影响最终所需表达式的推导。", "solution": "提交问题陈述以供验证。\n\n按原文提取已知条件如下：\n1.  **控制方程：** 表面受体密度 $R(t)$ 由常微分方程 $\\frac{dR}{dt}=-k_{int} R$ 建模。\n2.  **模型描述：** 该过程为具有恒定内化速率 $k_{int}$ 的一级内化动力学。\n3.  **初始条件：** $R(0)=R_{0}$。\n4.  **假设：** 在所关注的时间窗口内，受体的再循环和新合成可以忽略不计。\n5.  **目标：** 推导当 $R(t_{50})=\\frac{1}{2}R_{0}$ 时的时间 $t_{50}$ 的解析表达式。\n6.  **定性任务：** 从机理上解释这种内化动力学如何导致快速功能性脱敏。\n\n问题经验证。\n-   **科学基础：** 模型 $\\frac{dR}{dt}=-k R$ 是一级动力学过程的标准、基本表示。其在细胞生物学中应用于受体内化是一个经典且科学上合理的简化，广泛用于药代动力学和系统生物学。IgE介导的肥大细胞活化和受体下调的生物学背景是符合事实的。该问题具有科学依据。\n-   **适定性：** 该问题是一个标准的一阶线性齐次常微分方程的初值问题。它是适定的，允许一个唯一且稳定的解，从中可以明确推导出量 $t_{50}$。\n-   **客观性和完整性：** 该问题以精确、客观的语言陈述。所有必要信息（微分方程、初始条件和目标条件）均已提供。它是自洽的，没有矛盾。\n\n结论：该问题是 **有效的**。这是一个解决与生物过程相关的基本微分方程的简单练习。下面进行求解。\n\n控制方程是一个可分离的一阶常微分方程：\n$$\n\\frac{dR}{dt} = -k_{int} R\n$$\n为了求解，我们分离变量 $R$ 和 $t$。这在 $R \\neq 0$ 时是允许的，这个条件在物理上是满足的，因为初始密度 $R_0$ 必须为正。\n$$\n\\frac{1}{R} dR = -k_{int} dt\n$$\n接下来，我们对等式两边进行积分。左边从时间 $t=0$ 时的初始密度 $R_0$ 积分到稍后时间 $t$ 时的密度 $R(t)$。\n$$\n\\int_{R_0}^{R(t)} \\frac{1}{R'} dR' = \\int_{0}^{t} -k_{int} dt'\n$$\n进行积分得到：\n$$\n[\\ln|R'|]_{R_0}^{R(t)} = [-k_{int} t']_{0}^{t}\n$$\n由于受体密度 $R(t)$ 是一个物理量，它必须是非负的。因此我们可以去掉绝对值符号。\n$$\n\\ln(R(t)) - \\ln(R_0) = -k_{int} t - 0\n$$\n利用对数的性质，我们合并左边的项：\n$$\n\\ln\\left(\\frac{R(t)}{R_0}\\right) = -k_{int} t\n$$\n为了得到 $R(t)$ 的显式表达式，我们对等式两边取指数：\n$$\n\\frac{R(t)}{R_0} = \\exp(-k_{int} t)\n$$\n$$\nR(t) = R_0 \\exp(-k_{int} t)\n$$\n该方程描述了表面受体密度随时间的指数衰减。\n\n问题要求计算受体密度降至其初始值 $50\\%$ 时的时间 $t_{50}$。这在数学上表述为 $R(t_{50}) = \\frac{1}{2} R_0$。我们将此条件代入推导出的 $R(t)$ 表达式中：\n$$\n\\frac{1}{2} R_0 = R_0 \\exp(-k_{int} t_{50})\n$$\n我们在等式两边除以 $R_0$ (非零)：\n$$\n\\frac{1}{2} = \\exp(-k_{int} t_{50})\n$$\n为了求解 $t_{50}$，我们对等式两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = \\ln\\left(\\exp(-k_{int} t_{50})\\right)\n$$\n化简得到：\n$$\n-\\ln(2) = -k_{int} t_{50}\n$$\n最后，我们通过除以 $-k_{int}$ 来求解 $t_{50}$：\n$$\nt_{50} = \\frac{\\ln(2)}{k_{int}}\n$$\n这是表面受体群体的半衰期，仅用内化速率常数 $k_{int}$ 表示。\n\n关于定性解释：抗原诱导的IgE-FcεRI复合物的交联不仅触发细胞活化，还触发了这些复合物的快速内化，如模型所示。这种内化耗尽了细胞表面感知和响应抗原所必需的受体。因此，在短时间内再次暴露于相同抗原时，可供交联的受体数量减少，导致下游信号级联减弱和细胞反应变弱，这种现象被称为功能性脱敏。", "answer": "$$\n\\boxed{\\frac{\\ln(2)}{k_{int}}}\n$$", "id": "2807402"}, {"introduction": "肥大细胞激活的生理影响取决于其释放的炎性介质（如组胺）的数量。这种释放是大量离散、随机的“脱颗粒”事件的最终结果。本练习要求您构建一个概率模型，该模型需要考虑颗粒大小和融合模式（完全融合与“亲吻-逃逸”式融合）的异质性。通过计算达到目标组胺浓度所需的融合事件的期望数，您将学习如何将微观的细胞参数与宏观的功能性输出联系起来 [@problem_id:2855067]。", "problem": "在免疫球蛋白E (IgE) 介导的肥大细胞活化中，免疫球蛋白E (IgE) 的高亲和力受体——Fc epsilon受体I (FcεRI) 的交联会触发分泌颗粒的钙依赖性胞吐作用，这些颗粒具有不同的大小和释放模式。考虑一个肥大细胞，其含有两种颗粒群体，即“成熟”颗粒和“未成熟”颗粒，它们会经历完全融合胞吐或短暂的“亲吻-运行”式融合。假设以下有科学依据的事实和参数。\n\n- 基本依据：\n  - 一个颗粒中所含的组胺分子数量是颗粒内游离组胺浓度、颗粒腔体积和Avogadro数的乘积。\n  - 颗粒体积为 $V = \\frac{4}{3}\\pi r^{3}$，其中 $r$ 是颗粒半径。\n  - 在完全融合事件中，颗粒中固定比例的组胺含量被释放；在“亲吻-运行”事件中，释放的比例较小。\n  - 每次融合事件都会根据下述的群体比例，从细胞的颗粒池中独立地、均匀随机地选择一个颗粒。\n\n- 颗粒群体和胞吐参数：\n  - 成熟颗粒的比例 $p_{m} = 0.65$；未成熟颗粒的比例 $p_{i} = 0.35$。\n  - 成熟颗粒半径 $r_{m} = 220 \\ \\mathrm{nm}$；未成熟颗粒半径 $r_{i} = 160 \\ \\mathrm{nm}$。\n  - 两种群体的颗粒内游离组胺浓度均为 $c_{g} = 0.60 \\ \\mathrm{mol \\ L^{-1}}$。\n  - 成熟颗粒完全融合的概率 $f_{m} = 0.55$；未成熟颗粒完全融合的概率 $f_{i} = 0.35$。\n  - 完全融合中释放的内容物比例：成熟颗粒 $\\alpha_{m} = 0.75$，未成熟颗粒 $\\alpha_{i} = 0.85$。\n  - “亲吻-运行”中释放的内容物比例：成熟颗粒 $\\beta_{m} = 0.20$，未成熟颗粒 $\\beta_{i} = 0.30$。\n\n- 细胞外混合目标：\n  - 与释放的组胺混合的细胞周围细胞外微域的体积为 $V_{e} = 12 \\ \\mathrm{pL}$。\n  - 在该微域中要达到的目标组胺浓度为 $c^{\\ast} = 12 \\ \\mu \\mathrm{M}$。\n  - 使用Avogadro数 $N_{A} = 6.022 \\times 10^{23} \\ \\mathrm{mol^{-1}}$。\n  - 取 $1 \\ \\mathrm{nm} = 10^{-9} \\ \\mathrm{m}$ 且 $1 \\ \\mathrm{m^{3}} = 10^{3} \\ \\mathrm{L}$。\n\n假设释放的组胺在微域内瞬时混合，在所考虑的时间尺度内没有重摄取，并且融合事件是独立的。从第一性原理出发，推导所需的颗粒融合事件的期望数量 $N$，使得释放的组胺分子总数的期望值等于在 $V_{e}$ 中达到浓度 $c^{\\ast}$ 所需的量。将 $N$ 以无量纲数的形式报告，并将您的答案四舍五入至三位有效数字。", "solution": "该问题要求我们确定颗粒融合事件的数量 $N$，使得释放的组胺分子总数的期望值等于一个目标量。目标量定义为在细胞外体积 $V_{e}$ 中达到浓度 $c^{\\ast}$ 所需的分子数量。该问题可以通过计算目标分子数，然后除以单次融合事件释放的分子数的期望值来解决。为方便和清晰起见，我们将首先以组胺的摩尔数进行推导，因为Avogadro数 $N_{A}$ 将在最终的比率中被约掉。\n\n首先，让我们计算在细胞外体积 $V_{e}$ 中所需的目标组胺摩尔数 $n_{target}$。它由目标浓度 $c^{\\ast}$ 和体积 $V_{e}$ 的乘积给出。\n$$n_{target} = c^{\\ast} V_{e}$$\n代入给定值：\n$c^{\\ast} = 12 \\ \\mu \\mathrm{M} = 12 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}$\n$V_{e} = 12 \\ \\mathrm{pL} = 12 \\times 10^{-12} \\ \\mathrm{L}$\n$$n_{target} = (12 \\times 10^{-6} \\ \\mathrm{mol \\ L^{-1}}) \\cdot (12 \\times 10^{-12} \\ \\mathrm{L}) = 1.44 \\times 10^{-16} \\ \\mathrm{mol}$$\n\n接下来，我们必须确定在单次随机融合事件中释放的组胺摩尔数的期望值，我们将其表示为 $E[n_{event}]$。一次融合事件可能涉及一个成熟颗粒或一个未成熟颗粒，它们被选择的概率分别为 $p_{m}$ 和 $p_{i}$。根据全期望定律：\n$$E[n_{event}] = p_{m} E[n_{m}] + p_{i} E[n_{i}]$$\n这里，$E[n_{m}]$ 是当一个成熟颗粒发生融合时释放的组胺摩尔数的期望值，而 $E[n_{i}]$ 是一个未成熟颗粒融合时释放的摩尔数的期望值。\n\n我们首先分析成熟颗粒的情况。一个成熟颗粒中所含的组胺总摩尔数 $n_{total, m}$ 是颗粒内浓度 $c_{g}$ 和颗粒体积 $V_{m}$ 的乘积。半径为 $r_{m}$ 的球形颗粒的体积是 $V_{m} = \\frac{4}{3}\\pi r_{m}^{3}$。我们必须确保单位一致。半径 $r_m$ 以 $\\mathrm{nm}$ 为单位给出，我们将其转换为 $\\mathrm{m}$。浓度 $c_g$ 以 $\\mathrm{mol \\ L^{-1}}$ 为单位。我们使用转换因子 $1 \\ \\mathrm{m^3} = 10^3 \\ \\mathrm{L}$。\n$r_{m} = 220 \\ \\mathrm{nm} = 2.2 \\times 10^{-7} \\ \\mathrm{m}$\n$V_{m} = \\frac{4}{3}\\pi (2.2 \\times 10^{-7} \\ \\mathrm{m})^{3} \\cdot (10^{3} \\ \\mathrm{L \\ m^{-3}})$\n$$n_{total, m} = c_{g} V_{m} = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\left( \\frac{4}{3}\\pi (2.2 \\times 10^{-7})^{3} \\cdot 10^{3} \\ \\mathrm{L} \\right)$$\n一次成熟颗粒的融合可以是概率为 $f_{m}$ 的完全融合，释放其内容物的 $\\alpha_{m}$ 比例；也可以是概率为 $(1-f_{m})$ 的“亲吻-运行”式融合，释放其内容物的 $\\beta_{m}$ 比例。因此，从一次成熟颗粒融合中释放的摩尔数期望值为：\n$$E[n_{m}] = n_{total, m} \\cdot [ f_{m}\\alpha_{m} + (1-f_{m})\\beta_{m} ]$$\n我们将成熟颗粒的有效释放比例定义为 $R_{m} = f_{m}\\alpha_{m} + (1-f_{m})\\beta_{m}$。\n$R_{m} = (0.55)(0.75) + (1-0.55)(0.20) = 0.4125 + (0.45)(0.20) = 0.4125 + 0.09 = 0.5025$。\n\n类似地，对于半径为 $r_{i}$ 的未成熟颗粒：\n$r_{i} = 160 \\ \\mathrm{nm} = 1.6 \\times 10^{-7} \\ \\mathrm{m}$\n$V_{i} = \\frac{4}{3}\\pi (1.6 \\times 10^{-7} \\ \\mathrm{m})^{3} \\cdot (10^{3} \\ \\mathrm{L \\ m^{-3}})$\n$$n_{total, i} = c_{g} V_{i} = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\left( \\frac{4}{3}\\pi (1.6 \\times 10^{-7})^{3} \\cdot 10^{3} \\ \\mathrm{L} \\right)$$\n从未成熟颗粒融合中释放的摩尔数期望值为：\n$$E[n_{i}] = n_{total, i} \\cdot [ f_{i}\\alpha_{i} + (1-f_{i})\\beta_{i} ]$$\n未成熟颗粒的有效释放比例为 $R_{i} = f_{i}\\alpha_{i} + (1-f_{i})\\beta_{i}$。\n$R_{i} = (0.35)(0.85) + (1-0.35)(0.30) = 0.2975 + (0.65)(0.30) = 0.2975 + 0.195 = 0.4925$。\n\n现在我们结合这些来求 $E[n_{event}]$：\n$$E[n_{event}] = p_{m} n_{total,m} R_{m} + p_{i} n_{total,i} R_{i}$$\n代入 $n_{total,m}$ 和 $n_{total,i}$ 的表达式：\n$$E[n_{event}] = p_{m} \\left(c_{g} \\frac{4}{3}\\pi r_{m}^{3} \\cdot 10^3 \\right) R_{m} + p_{i} \\left(c_{g} \\frac{4}{3}\\pi r_{i}^{3} \\cdot 10^3 \\right) R_{i}$$\n我们可以提出公因式：\n$$E[n_{event}] = c_{g} \\cdot \\frac{4}{3}\\pi \\cdot 10^3 \\cdot (p_{m}r_{m}^{3}R_{m} + p_{i}r_{i}^{3}R_{i})$$\n让我们计算括号中的值（半径单位为米）：\n$p_{m}r_{m}^{3}R_{m} = (0.65) \\cdot (2.2 \\times 10^{-7})^{3} \\cdot (0.5025) \\approx 3.483 \\times 10^{-21} \\ \\mathrm{m^3}$\n$p_{i}r_{i}^{3}R_{i} = (0.35) \\cdot (1.6 \\times 10^{-7})^{3} \\cdot (0.4925) \\approx 7.068 \\times 10^{-22} \\ \\mathrm{m^3}$\n和 = $3.483 \\times 10^{-21} + 0.7068 \\times 10^{-21} = 4.1898 \\times 10^{-21} \\ \\mathrm{m^3}$\n现在，我们计算 $E[n_{event}]$：\n$$E[n_{event}] = (0.60 \\ \\mathrm{mol \\ L^{-1}}) \\cdot \\frac{4}{3}\\pi \\cdot (10^3 \\ \\mathrm{L \\ m^{-3}}) \\cdot (4.1898 \\times 10^{-21} \\ \\mathrm{m^3})$$\n$$E[n_{event}] \\approx 1.053 \\times 10^{-17} \\ \\mathrm{mol}$$\n\n问题陈述，经过 $N$ 次事件后，释放的总摩尔数的期望值等于目标量。由于每次事件都是独立同分布的，总释放量的期望值为 $N \\cdot E[n_{event}]$。\n$$N \\cdot E[n_{event}] = n_{target}$$\n因此，所需的事件数量 $N$ 是：\n$$N = \\frac{n_{target}}{E[n_{event}]}$$\n代入计算出的值：\n$$N = \\frac{1.44 \\times 10^{-16} \\ \\mathrm{mol}}{1.053 \\times 10^{-17} \\ \\mathrm{mol}} \\approx 13.675$$\n问题要求答案四舍五入到三位有效数字。\n$$N \\approx 13.7$$\n这是一个无量纲数，正如预期。逻辑步骤合理，计算在算术上是正确的。", "answer": "$$\\boxed{13.7}$$", "id": "2855067"}, {"introduction": "将细胞膜上的受体激活与细胞质中的脱颗粒联系起来的是一个复杂的细胞内信号级联。该网络的核心是磷脂酰肌醇循环，它控制着关键的第二信使前体 $PIP_2$ 的可用性。这项高级练习将指导您根据质量作用动力学的基本原理，构建此信号枢纽的计算模型。通过编写代码并模拟一个常微分方程组，您将亲身体验系统生物学方法，用于分析信号通路的动态行为，并预测其对刺激和扰动的响应 [@problem_id:2855010]。", "problem": "要求您为 IgE 介导的肥大细胞脱颗粒信号传导建立一个最小的、机械性的底物循环模型，重点关注在刺激过程中由磷脂酶 C (PLC) 引起的磷脂酰肌醇-4,5-二磷酸 (PIP2) 耗尽，以及由磷脂酰肌醇-4-磷酸-5-激酶 (PIP5K) 催化的再合成。您的模型必须以常微分方程组的形式表述，这些方程源自质量作用动力学，并且必须实现为一个可运行的程序，用于计算指定的量化输出。\n\n从以下基本依据出发：\n- 质量作用定律：对于一个速率常数为 $k$ 的基元转化 $A \\to B$，反应速率为 $v = k [A]$，其中 $[A]$ 表示浓度。\n- 在感兴趣的时间尺度内，磷酸肌醇池是封闭的，其总量守恒（即无输入/输出）：磷脂酰肌醇 (PI)、磷脂酰肌醇-4-磷酸 (PI4P)、PIP2 以及 PIP2 的集总水解产物（记为 $H$，代表二酰基甘油 + 1,4,5-三磷酸肌醇对）的总量 $T$ 在数值误差范围内是恒定的。\n- IgE-FcεRI 受体 I (FcεRI) 的交联会瞬时激活 PLC 的活性；将此表示为一个时间依赖的标量 $u(t)$，它在刺激窗口期内调节 PLC 的速率常数。\n\n模型物种与单位：\n- 物种：$[\\mathrm{PI}]$, $[\\mathrm{PI4P}]$, $[\\mathrm{PIP2}]$, $[H]$，单位均为微摩尔 (µM)。\n- 时间 $t$，单位为秒。\n- 所有速率常数的单位均为 $\\text{s}^{-1}$。\n\n反应方案（所有反应均为基元反应并遵循质量作用动力学）：\n1. $\\mathrm{PI} \\xrightarrow{k_4} \\mathrm{PI4P}$，速率为 $v_1 = k_4 [\\mathrm{PI}]$。\n2. $\\mathrm{PI4P} \\xrightarrow{k_5} \\mathrm{PIP2}$，速率为 $v_2 = k_5 [\\mathrm{PI4P}]$。\n3. $\\mathrm{PIP2} \\xrightarrow{k_{\\mathrm{PLC}} u(t)} H$，速率为 $v_3 = k_{\\mathrm{PLC}} u(t) [\\mathrm{PIP2}]$。\n4. $H \\xrightarrow{k_r} \\mathrm{PI}$，速率为 $v_4 = k_r [H]$。\n5. $\\mathrm{PI4P} \\xrightarrow{k_{p4}} \\mathrm{PI}$，速率为 $v_5 = k_{p4} [\\mathrm{PI4P}]$。\n6. $\\mathrm{PIP2} \\xrightarrow{k_{p5}} \\mathrm{PI4P}$，速率为 $v_6 = k_{p5} [\\mathrm{PIP2}]$。\n\n将刺激函数 $u(t)$ 定义为分段常数函数：\n- 基线：$u(t) = u_0$，当 $t  t_0$。\n- 刺激期：$u(t) = u_1$，当 $t_0 \\le t \\le t_1$。\n- 刺激后：$u(t) = u_0$，当 $t > t_1$。\n\n$t = 0$ 时的初始条件（单位 µM）：\n- $[\\mathrm{PI}](0) = 80$, $[\\mathrm{PI4P}](0) = 15$, $[\\mathrm{PIP2}](0) = 5$, $[H](0) = 0$。\n- 总量 $T_0 = 80 + 15 + 5 + 0 = 100$。\n\n您的任务：\n1. 根据反应方案和质量作用动力学，推导 $[\\mathrm{PI}]$, $[\\mathrm{PI4P}]$, $[\\mathrm{PIP2}]$ 和 $[H]$ 的常微分方程组。\n2. 实现一个数值求解器，用足够精确的方法对该系统从 $t=0$ 到 $t=t_{\\mathrm{end}}$ 进行积分，以将数值上的质量不守恒误差保持在一个小的容差之下。\n3. 对下文定义的每个测试用例，计算所要求的量化输出，并遵循指定的单位和格式。\n\n测试套件（每个用例均使用 $t_0 = 30\\,\\text{s}$，$t_1 = 120\\,\\text{s}$，$t_{\\mathrm{end}} = 300\\,\\text{s}$，以及如上所述的初始条件）：\n- 用例 $1$（基线底物循环）：\n  - 参数：$k_4 = 0.02\\,\\text{s}^{-1}$，$k_5 = 0.05\\,\\text{s}^{-1}$，$k_{\\mathrm{PLC}} = 1\\,\\text{s}^{-1}$，$u_0 = 0.005$，$u_1 = 0.25$，$k_r = 0.02\\,\\text{s}^{-1}$，$k_{p4} = 0.01\\,\\text{s}^{-1}$，$k_{p5} = 0.05\\,\\text{s}^{-1}$。\n  - 待计算输出：在刺激窗口期内，$\\mathrm{PIP2}$ 相对于总磷酸肌醇 $T$ 的最小分数 $f_{\\min}$，即 $f_{\\min} = \\min_{t \\in [t_0,t_1]} \\frac{[\\mathrm{PIP2}](t)}{T_0}$。表示为四位小数的小数（无单位分数）。\n- 用例 $2$（无 PIP5K 介导的 PIP2 再合成）：\n  - 参数：与用例 1 相同，但 $k_5 = 0$。\n  - 待计算输出：一个布尔指标，指示在 $t_{\\mathrm{end}}$ 时 PIP2 是否恢复到基线水平的至少 $0.8$ 倍。形式上，计算 $R = \\mathbf{1}\\left(\\frac{[\\mathrm{PIP2}](t_{\\mathrm{end}})}{[\\mathrm{PIP2}](0)} \\ge 0.8\\right)$。如果为真，输出整数 $1$，否则输出 $0$。\n- 用例 $3$（增强的 5-磷酸酶驱动循环）：\n  - 参数：与用例 1 相同，但 $k_{p5} = 0.20\\,\\text{s}^{-1}$。\n  - 待计算输出：刺激期间 PIP5K 的积分通量，$J_{5} = \\int_{t_0}^{t_1} v_2(t)\\, dt = \\int_{t_0}^{t_1} k_5 [\\mathrm{PI4P}](t)\\, dt$。将 $J_{5}$ 以微摩尔（µM）表示，并四舍五入到三位小数。\n- 用例 $4$（数值质量守恒检验）：\n  - 参数：与用例 1 相同。\n  - 待计算输出：在整个模拟过程中，总物质量与 $T_0$ 的最大绝对偏差，即 $E_{\\max} = \\max_{t\\in[0,t_{\\mathrm{end}}]} \\left|([\\mathrm{PI}]+[\\mathrm{PI4P}]+[\\mathrm{PIP2}]+[H])(t) - T_0\\right|$。以微摩尔（µM）表示，并四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中 $r_1$ 是用例 1 的结果，$r_2$ 是用例 2 的结果，$r_3$ 是用例 3 的结果，$r_4$ 是用例 4 的结果，按此顺序排列。", "solution": "所给出的问题是计算系统生物学中一个适定 (well-posed) 的任务，要求对一个机理模型进行形式化和数值求解。该模型描述了磷酸肌醇代谢的动力学，这是细胞信号传导中的一个关键通路。该问题具有科学依据，数学上一致，并且所有参数和目标都已明确定义。因此，该问题是有效的，并允许进行严格求解。\n\n问题的核心是分析一个从给定反应网络使用质量作用定律推导出的耦合一阶常微分方程组（ODEs）的行为。设物种 $\\mathrm{PI}$、$\\mathrm{PI4P}$、$\\mathrm{PIP2}$ 和 $H$ 的浓度分别由状态变量 $y_1(t)$、$y_2(t)$、$y_3(t)$ 和 $y_4(t)$ 表示，其中 $t$ 是以秒为单位的时间。\n\n反应方案为：\n1.  $\\mathrm{PI} \\xrightarrow{k_4} \\mathrm{PI4P}$，速率为 $v_1 = k_4 y_1$。\n2.  $\\mathrm{PI4P} \\xrightarrow{k_5} \\mathrm{PIP2}$，速率为 $v_2 = k_5 y_2$。\n3.  $\\mathrm{PIP2} \\xrightarrow{k_{\\mathrm{PLC}} u(t)} H$，速率为 $v_3 = k_{\\mathrm{PLC}} u(t) y_3$。\n4.  $H \\xrightarrow{k_r} \\mathrm{PI}$，速率为 $v_4 = k_r y_4$。\n5.  $\\mathrm{PI4P} \\xrightarrow{k_{p4}} \\mathrm{PI}$，速率为 $v_5 = k_{p4} y_2$。\n6.  $\\mathrm{PIP2} \\xrightarrow{k_{p5}} \\mathrm{PI4P}$，速率为 $v_6 = k_{p5} y_3$。\n\n根据这些基元反应，我们通过考虑每个物种的生成和消耗速率来构建常微分方程组：\n-   $\\frac{dy_1}{dt} = (\\text{生成速率}) - (\\text{消耗速率}) = v_4 + v_5 - v_1$\n-   $\\frac{dy_2}{dt} = v_1 + v_6 - v_2 - v_5$\n-   $\\frac{dy_3}{dt} = v_2 - v_3 - v_6$\n-   $\\frac{dy_4}{dt} = v_3 - v_4$\n\n代入速率表达式，得到显式的常微分方程组：\n$$\n\\begin{cases}\n    \\frac{dy_1}{dt} = k_r y_4 + k_{p4} y_2 - k_4 y_1 \\\\\n    \\frac{dy_2}{dt} = k_4 y_1 + k_{p5} y_3 - (k_5 + k_{p4}) y_2 \\\\\n    \\frac{dy_3}{dt} = k_5 y_2 - (k_{p5} + k_{\\mathrm{PLC}} u(t)) y_3 \\\\\n    \\frac{dy_4}{dt} = k_{\\mathrm{PLC}} u(t) y_3 - k_r y_4\n\\end{cases}\n$$\n刺激函数 $u(t)$ 是一个分段常数函数：\n$$\nu(t) = \\begin{cases}\n    u_0  \\text{当 } t  t_0 \\\\\n    u_1  \\text{当 } t_0 \\le t \\le t_1 \\\\\n    u_0  \\text{当 } t > t_1\n\\end{cases}\n$$\n磷酸肌醇总库 $T(t) = y_1(t) + y_2(t) + y_3(t) + y_4(t)$ 是守恒的，因为 $\\frac{d}{dt}(y_1+y_2+y_3+y_4) = 0$。初始总浓度为 $T_0 = T(0) = 80 + 15 + 5 + 0 = 100 \\, \\mu\\text{M}$。\n\n为了解决这个初值问题，我们采用一种数值方法。SciPy 库中的 `scipy.integrate.solve_ivp` 函数是一个合适的选择，因为它提供了一套鲁棒的、自适应步长的求解器。我们将使用默认的 `RK45` 方法（一个 5(4) 阶的显式龙格-库塔方法），该方法适用于如此问题的非刚性问题。为了确保高精度，特别是在用例 4 的质量守恒检验中，我们将设置严格的相对和绝对误差容限（例如 `rtol`=$10^{-12}$，`atol`=$10^{-12}$）。将利用 `dense_output=True` 选项来获得连续的解表示，这对于寻找极值和在特定区间上进行数值积分是必要的。\n\n求解过程如下，依次处理每个测试用例：\n\n**用例 1：最小 PIP2 分数**\n我们使用指定的参数在区间 $[0, t_{\\mathrm{end}}]$ 上求解该常微分方程组。利用密集解，我们在刺激窗口 $[t_0, t_1]$ 内的精细时间点网格上评估 $[\\mathrm{PIP2}](t)$，即 $y_3(t)$。然后确定该网格上比率 $\\frac{y_3(t)}{T_0}$ 的最小值。\n-   $f_{\\min} = \\min_{t \\in [t_0, t_1]} \\frac{y_3(t)}{T_0}$\n-   参数：$k_4=0.02, k_5=0.05, k_{\\mathrm{PLC}}=1, u_0=0.005, u_1=0.25, k_r=0.02, k_{p4}=0.01, k_{p5}=0.05$。时间点 $t_0=30, t_1=120$。\n\n**用例 2：恢复指标**\n再次求解该系统，但将 PIP5K 速率常数 $k_5$ 设为 0。在最终时间点 $t=t_{\\mathrm{end}}$ 评估 $\\mathrm{PIP2}$ 的浓度 $y_3(t)$。将此值与初始浓度 $y_3(0)=5\\,\\mu\\text{M}$ 进行比较。\n-   $R = \\mathbf{1}\\left(\\frac{y_3(t_{\\mathrm{end}})}{y_3(0)} \\ge 0.8\\right)$\n-   参数：与用例 1 相同，但 $k_5=0$。指示函数 $\\mathbf{1}(\\cdot)$ 在条件为真时为 1，否则为 0。\n\n**用例 3：PIP5K 积分通量**\n使用一个提高的 5-磷酸酶速率常数 $k_{p5} = 0.20\\,\\text{s}^{-1}$ 求解该系统。待计算的量是刺激期间由 PIP5K 产生的 $\\mathrm{PIP2}$ 总量，即通量 $v_2(t) = k_5 y_2(t)$ 的时间积分。\n-   $J_5 = \\int_{t_0}^{t_1} v_2(t)\\, dt = \\int_{t_0}^{t_1} k_5 y_2(t)\\, dt$\n-   参数：与用例 1 相同，但 $k_{p5}=0.20$。\n该积分使用 `scipy.integrate.quad` 函数进行数值计算，该函数应用于区间 $[t_0, t_1]$ 上的 $y_2(t)$ 的密集解。\n\n**用例 4：数值质量守恒检验**\n使用与用例 1 相同的参数，以非常高的精度设置求解该系统。在整个模拟区间 $[0, t_{\\mathrm{end}}]$ 的精细网格上评估总物质量浓度 $T(t) = y_1(t)+y_2(t)+y_3(t)+y_4(t)$。然后找出其与初始总物质量 $T_0$ 的最大绝对偏差。\n-   $E_{\\max} = \\max_{t \\in [0, t_{\\mathrm{end}}]} |T(t) - T_0|$\n-   这可作为对积分过程数值完整性的关键验证。\n\n实现过程将把这些步骤整合到一个独立的程序中，该程序顺序执行每个用例，并按要求格式化最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\n\ndef solve():\n    \"\"\"\n    Solves the four test cases for the phosphoinositide signaling model.\n    \"\"\"\n\n    # --- Common parameters and initial conditions ---\n    ic = [80.0, 15.0, 5.0, 0.0]  # [PI, PI4P, PIP2, H] in µM\n    T0 = sum(ic)\n    t_span = (0.0, 300.0)\n    t0, t1, tend = 30.0, 120.0, 300.0\n\n    # --- Test case definitions ---\n    case_params = [\n        # Case 1: Baseline\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n        # Case 2: No PIP2 resynthesis by PIP5K\n        {'k4': 0.02, 'k5': 0.0, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n        # Case 3: Enhanced 5-phosphatase\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.20},\n        # Case 4: Conservation check (same parameters as Case 1)\n        {'k4': 0.02, 'k5': 0.05, 'k_plc': 1.0, 'u0': 0.005, 'u1': 0.25, \n         'kr': 0.02, 'kp4': 0.01, 'kp5': 0.05},\n    ]\n\n    results = []\n\n    # --- ODE system definition ---\n    def model(t, y, p):\n        \"\"\"\n        Defines the system of ODEs for the phosphoinositide cycle.\n        y = [PI, PI4P, PIP2, H]\n        p = dictionary of parameters\n        \"\"\"\n        y1, y2, y3, y4 = y\n        \n        # Stimulation function u(t)\n        u_t = p['u1'] if t0 = t = t1 else p['u0']\n        \n        # Rates of change\n        dy1dt = p['kr'] * y4 + p['kp4'] * y2 - p['k4'] * y1\n        dy2dt = p['k4'] * y1 + p['kp5'] * y3 - (p['k5'] + p['kp4']) * y2\n        dy3dt = p['k5'] * y2 - (p['kp5'] + p['k_plc'] * u_t) * y3\n        dy4dt = p['k_plc'] * u_t * y3 - p['kr'] * y4\n        \n        return [dy1dt, dy2dt, dy3dt, dy4dt]\n\n    # --- Process each test case ---\n    for i, params in enumerate(case_params):\n        case_num = i + 1\n        \n        # Use high accuracy for all cases, especially Case 4\n        rtol, atol = (1e-12, 1e-12) if case_num == 4 else (1e-9, 1e-9)\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=ic,\n            method='RK45',\n            args=(params,),\n            dense_output=True,\n            rtol=rtol,\n            atol=atol\n        )\n\n        if case_num == 1:\n            # Output: minimum fraction f_min of PIP2 during stimulation\n            t_eval_stim = np.linspace(t0, t1, 1000)\n            y_eval_stim = sol.sol(t_eval_stim)\n            pip2_stim = y_eval_stim[2]\n            f_min = np.min(pip2_stim) / T0\n            results.append(f\"{f_min:.4f}\")\n            \n        elif case_num == 2:\n            # Output: boolean indicator of recovery\n            pip2_end = sol.sol(tend)[2]\n            pip2_initial = ic[2]\n            recovery_ratio = pip2_end / pip2_initial\n            R = 1 if recovery_ratio >= 0.8 else 0\n            results.append(str(R))\n            \n        elif case_num == 3:\n            # Output: integrated PIP5K flux during stimulation\n            # v2(t) = k5 * [PI4P](t)\n            v2 = lambda t: params['k5'] * sol.sol(t)[1]\n            J5, _ = quad(v2, t0, t1, epsabs=1e-9, epsrel=1e-9)\n            results.append(f\"{J5:.3f}\")\n            \n        elif case_num == 4:\n            # Output: maximum absolute deviation of total pool from T0\n            t_eval_full = np.linspace(t_span[0], t_span[1], 2000)\n            y_eval_full = sol.sol(t_eval_full)\n            total_pool_t = np.sum(y_eval_full, axis=0)\n            error = np.abs(total_pool_t - T0)\n            E_max = np.max(error)\n            results.append(f\"{E_max:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2855010"}]}