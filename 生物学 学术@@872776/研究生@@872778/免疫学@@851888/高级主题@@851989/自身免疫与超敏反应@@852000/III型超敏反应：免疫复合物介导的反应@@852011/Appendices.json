{"hands_on_practices": [{"introduction": "III型超敏反应的临床表现千差万别，其关键区别在于免疫复合物形成和沉积的时间与地点。本练习通过两个典型的临床案例，挑战您运用免疫学的基本原理——包括初次与再次体液免疫应答的动力学差异——来区分全身性的血清病和局部性的Arthus反应。通过分析这些假设情景，您将学会如何从临床时间线和实验室检查结果中解读潜在的病理生理机制。[@problem_id:2904371]", "problem": "一家生物技术公司正在健康志愿者中测试一种非自体糖蛋白治疗性抗原，命名为抗原X。请考虑以下独立案例。\n\n案例 X：一名先前未接触过抗原 X 的健康志愿者接受了肌肉注射。血清中可检测到抗原血症，直至第 5 天。第 7 天，通过酶联免疫吸附测定法检测到一条新的与抗原 X 结合的免疫球蛋白 G (IgG) 血清条带。第 9 天，该志愿者出现发热、荨麻疹样皮疹和游走性关节痛。尿液分析显示血尿和蛋白尿。血清补体检测显示补体成分C3降低（45 mg/dL；参考范围 90–180 mg/dL），补体成分C4降低（6 mg/dL；参考范围 10–40 mg/dL），总溶血补体 (CH50) 显著降低。肾活检免疫荧光检查显示 IgG 和补体在毛细血管壁呈颗粒状沉积。\n\n案例 Y：另一名志愿者在 6 个月前完成了 3 剂次的抗原 X 注射系列，基线时具有高滴度的抗抗原 X IgG。在前臂掌侧给予了 $10\\,\\mu\\text{g}$ 的抗原 X 皮内试验剂量。6 小时内，注射部位出现一个疼痛、硬结、红斑性的斑块，中心区域有坏死。穿刺活检显示富含中性粒细胞的小血管血管炎伴有纤维蛋白样坏死，直接免疫荧光检查显示血管壁中有 IgG 和补体成分 C3 的颗粒状沉积。血清 C3、C4 和 CH50 在参考范围内。\n\n仅根据原发性与继发性体液免疫应答的动力学以及通过经典补体途径介导的免疫复合物疾病发病机制的基本原理，哪个选项最能恰当地归类案例 X 和案例 Y 的免疫病理学？\n\nA. 案例 X：主动免疫后发生的全身性免疫复合物介导的血清病；案例 Y：由预先形成的抗体引起的局部阿瑟斯反应\n\nB. 案例 X：对抗原 X 的速发型（I型）超敏反应；案例 Y：对抗原 X 包被细胞的抗体依赖性细胞介导的细胞毒性作用（II型）\n\nC. 案例 X：局部阿瑟斯反应；案例 Y：迟发型（IV型）超敏反应\n\nD. 案例 X：由预先形成的抗体引起的加速型血清病；案例 Y：由免疫球蛋白 E (IgE) 介导的经典阿瑟斯反应", "solution": "首先将根据科学严谨性原则对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n\n**通用信息：**\n*   一种非自体糖蛋白治疗剂，命名为“抗原 X”，正在研究中。\n*   任务是根据原发性与继发性体液免疫应答的动力学以及通过经典补体途径介导的免疫复合物疾病的发病机制的基本原理，对两个案例中的免疫病理学进行分类。\n\n**案例 X：**\n*   受试者：一名先前未接触过抗原 X 的健康志愿者。\n*   干预措施：肌肉注射抗原 X。\n*   时间线和观察结果：\n    *   血清中可检测到抗原血症，直至第 5 天。\n    *   第 7 天，检测到与抗原 X 结合的新的血清 IgG。\n    *   第 9 天，受试者出现发热、荨麻疹样皮疹和游走性关节痛。\n*   实验室和活检结果：\n    *   尿液分析：血尿和蛋白尿。\n    *   血清补体：补体成分 C3 降低（45 mg/dL；参考范围 90–180 mg/dL），补体成分 C4 降低（6 mg/dL；参考范围 10–40 mg/dL），总溶血补体 (CH50) 显著降低。\n    *   肾活检：IgG 和补体在毛细血管壁呈颗粒状沉积。\n\n**案例 Y：**\n*   受试者：另一名志愿者，6 个月前完成了 3 剂次的抗原 X 注射系列，基线时具有高滴度的抗抗原 X IgG。\n*   干预措施：$10\\,\\mu\\text{g}$ 的抗原 X 皮内试验剂量。\n*   时间线和观察结果：\n    *   6 小时内，注射部位出现一个疼痛、硬结、红斑性的斑块，伴有中心坏死。\n*   实验室和活检结果：\n    *   皮肤活检：富含中性粒细胞的小血管血管炎伴纤维蛋白样坏死；血管壁中有 IgG 和补体成分 C3 的颗粒状沉积。\n    *   血清补体：C3、C4 和 CH50 水平在参考范围内。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n问题陈述具有科学依据，表述清晰，且客观。\n*   **科学合理性：** 案例 X 和案例 Y 中描述的临床和实验室发现是特定免疫超敏反应的教科书式表现。时间线、症状、补体谱和组织病理学发现与已确立的免疫学原理一致。案例 X 描述了典型的血清病（一种全身性III型超敏反应）。案例 Y 描述了典型的阿瑟斯反应（一种局部III型超敏反应）。\n*   **表述清晰且信息自足：** 问题为鉴别诊断提供了充分、无矛盾的信息。它明确区分了原发性暴露情景（案例 X）和预先致敏情景（案例 Y），这对于关于免疫应答动力学的问题至关重要。\n*   **客观性：** 描述使用了精确和标准的临床及实验室术语，没有主观或含糊的语言。\n\n**步骤 3：结论与行动**\n\n问题有效。将基于基本原理推导解决方案。\n\n**解题推导**\n\n免疫复合物介导的（III型）超敏反应是由抗原-抗体复合物在组织中沉积，导致补体激活和炎症引起的。反应的定位和时间取决于免疫复合物形成的位置和个体的免疫状态。\n\n**案例 X 分析：**\n该志愿者先前没有接触史，需要启动原发性免疫应答。\n1.  **动力学：** 注射的可溶性蛋白抗原（抗原 X）进入循环。原发性体液应答被启动，大约需要 7 到 10 天才能产生显著水平的抗体，主要是 IgM，随后是 IgG。问题陈述中 IgG 在第 7 天被检测到，与此时间线一致。\n2.  **发病机制：** 大约在第 7 到 14 天，随着 IgG 滴度的升高，它会遇到可能仍存在于循环中的抗原。这导致可溶性抗原-抗体（免疫）复合物的形成。这些复合物大小适中，既能逃避网状内皮系统的清除，又容易沉积在小血管壁中，尤其是在肾脏（肾小球）、关节（滑膜）和皮肤中。\n3.  **补体激活：** 沉积复合物中的 IgG 激活经典补体途径。此激活过程消耗补体成分，解释了观察到的血清 C3 降低（45 mg/dL）、C4 降低（6 mg/dL）和 CH50 降低。\n4.  **炎症：** 补体激活片段 C3a 和 C5a 作为过敏毒素，增加血管通透性，并作为中性粒细胞的化学引诱物。中性粒细胞被招募到沉积部位，在试图吞噬复合物时释放裂解酶和活性氧，导致血管炎和组织损伤。\n5.  **临床关联：** 这种全身性血管炎表现为发热、皮疹（荨麻疹）和关节痛（关节痛）。在肾小球的沉积引起肾小球肾炎，导致血尿和蛋白尿。肾活检显示 IgG 和补体的颗粒状沉积是其病征性发现。\n这整个临床图景就是 **全身性免疫复合物病，或称血清病** 的定义，它是由针对外来抗原的主动、原发性免疫引起的。\n\n**案例 Y 分析：**\n该志愿者是预先致敏的，基线时具有高滴度的抗抗原 X IgG。\n1.  **动力学：** 这是一个继发性暴露情景。高水平预先形成的抗体的存在使得在抗原再次引入时能够立即发生反应。\n2.  **发病机制：** 抗原被皮内注射到一个局部区域。循环和组织间液中高浓度的预存 IgG 在注射部位迅速与抗原结合。这会形成大的、不溶性的免疫复合物，并*原位*沉淀在局部血管壁内。\n3.  **补体激活和炎症：** 与案例 X 一样，复合物激活补体，导致强烈的局部炎症反应，其特征是大量中性粒细胞浸润，如活检所见（“富含中性粒细胞的小血管血管炎”）。严重的炎症可导致血管血栓形成和缺血性坏死（“纤维蛋白样坏死”和“中心坏死区域”）。活检证实了 IgG 和 C3 的局部沉积。\n4.  **临床关联：** 反应迅速（数小时内发作）且局限于抗原攻击的部位，产生一个疼痛、肿胀（硬结）和发红（红斑）的病变。因为反应是局部性的，所以全身性补体消耗可忽略不计，这解释了为什么血清 C3、C4 和 CH50 水平保持在正常范围内。\n在预先致敏的个体中，这种局部形式的III型超敏反应被称为 **阿瑟斯反应**。\n\n**评估选项**\n\n*   **A. 案例 X：主动免疫后发生的全身性免疫复合物介导的血清病；案例 Y：由预先形成的抗体引起的局部阿瑟斯反应**\n    *   将案例 X 归类为主动免疫后发生的全身性血清病是正确的，如上文推导。\n    *   将案例 Y 归类为由预先形成的抗体引起的局部阿瑟斯反应也是正确的，如上文推导。\n    *   **结论：正确。**\n\n*   **B. 案例 X：对抗原 X 的速发型（I型）超敏反应；案例 Y：对抗原 X 包被细胞的抗体依赖性细胞介导的细胞毒性作用（II型）**\n    *   案例 X 不是 I 型超敏反应。I 型反应由 IgE 介导，在数分钟内发生，而不是 9 天。它们不会以这种方式引起 C3 和 C4 的消耗。\n    *   案例 Y 不是 II 型超敏反应。抗原是可溶性糖蛋白，而不是固定在细胞表面的抗原。其病理是免疫复合物沉积引起的血管炎，而不是靶向细胞杀伤。\n    *   **结论：不正确。**\n\n*   **C. 案例 X：局部阿瑟斯反应；案例 Y：迟发型（IV型）超敏反应**\n    *   案例 X 描述的是全身性反应（发热、关节痛、肾小球肾炎），而不是像阿瑟斯反应那样的局部反应。\n    *   案例 Y 不是 IV 型超敏反应。IV 型反应由 T 细胞介导，在 48-72 小时达到高峰，并显示单核细胞浸润，而不是观察到的快速、富含中性粒细胞、由抗体和补体介导的反应。\n    *   **结论：不正确。**\n\n*   **D. 案例 X：由预先形成的抗体引起的加速型血清病；案例 Y：由免疫球蛋白 E (IgE) 介导的经典阿瑟斯反应**\n    *   案例 X 不可能是加速型血清病，因为问题陈述该志愿者“先前未接触过”，因此没有预先形成的抗体。其时间线（>7 天）与经典型而非加速型血清病一致。\n    *   案例 Y 的描述不正确，因为阿瑟斯反应是由 IgG（和补体）介导的，而不是 IgE。问题明确指出该志愿者具有高滴度的抗抗原 X IgG。IgE 介导 I 型超敏反应。\n    *   **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2904371"}, {"introduction": "免疫复合物的有效清除是防止III型超敏反应的关键。本练习将引导您从分子相互作用的层面，定量分析红细胞补体受体1（CR1）介导的免疫复合物清除机制。您需要运用化学平衡和质量作用定律的基本原理，通过计算来评估在给定的免疫复合物负荷下，CR1系统的结合能力及其饱和风险。这项实践旨在将抽象的生物物理概念转化为对免疫复合物清除效率受损风险的具体预测。[@problem_id:2904455]", "problem": "III型超敏反应中免疫复合物清除的一个核心机制是，补体调理的免疫复合物通过补体受体1 (CR1) 由红细胞 (RBCs) 转运。考虑一个处于平衡状态且充分混合的血液室，其中补体调理的免疫复合物（配体，记为 $L$）与红细胞上的 CR1 位点（受体，记为 $R$）以 $1{:}1$ 的化学计量比独立且可逆地结合。该结合遵循质量作用平衡，其解离常数 $K_D$ 定义为 $K_D = \\frac{[R]_{\\mathrm{free}}[L]_{\\mathrm{free}}}{[RL]}$，其中 $[RL]$ 是结合复合物的浓度，方括号表示摩尔浓度。\n\n假设参数如下：\n- 总红细胞浓度 $c_{\\mathrm{RBC}} = 5.0 \\times 10^{12}\\,\\text{个细胞}\\cdot\\text{L}^{-1}$。\n- 每个红细胞的 CR1 密度 $N = 500\\,\\text{个位点}\\cdot\\text{细胞}^{-1}$。\n- Avogadro 常数 $N_A = 6.022 \\times 10^{23}\\,\\text{mol}^{-1}$。\n- 总免疫复合物浓度 $[L]_T = 25$ nM (纳摩尔)。\n- 解离常数 $K_D = 15$ nM。\n\n设总受体浓度为 $[R]_T = \\frac{c_{\\mathrm{RBC}} \\times N}{N_A}$ (单位为 $\\text{mol}\\cdot\\text{L}^{-1}$)。不要假设配体远超过受体。将位点占据分数定义为 $\\theta = \\frac{[RL]}{[R]_T}$，该值由精确的有限供给平衡（质量守恒和给定 $K_D$ 下的 $1{:}1$ 结合）得到。对于一个具有 $N$ 个独立 CR1 位点的红细胞，将该细胞的“受体饱和”定义为所有 $N$ 个位点均被占据的事件。在独立性假设下，随机选取的单个红细胞的饱和概率为 $P_{\\mathrm{sat}} = \\theta^{N}$。\n\n此外，将游离免疫复合物分数定义为 $f_{\\mathrm{free}} = \\frac{[L]_{\\mathrm{free}}}{[L]_T}$，并假设当 $f_{\\mathrm{free}} > \\phi$（阈值 $\\phi = 0.25$）时，可操作性地预测为“清除功能受损”。\n\n仅使用上述基本定义（质量守恒和 $K_D$），计算在指定参数值下的 $P_{\\mathrm{sat}}$。然后，使用您计算出的平衡状态，根据所述标准判断是否预测会出现清除功能受损（您无需将此定性预测包含在最终的数值答案中）。将您最终的 $P_{\\mathrm{sat}}$ 值四舍五入到三位有效数字。以科学记数法表示该概率，其为一个无量纲数。", "solution": "本问题要求基于免疫复合物（配体, $L$）与 CR1 位点（受体, $R$）之间 $1{:}1$ 可逆结合的模型，计算一个红细胞 CR1 受体的饱和概率 $P_{\\mathrm{sat}}$。该计算必须源于质量作用平衡的基本原理。\n\n首先，我们确定受体位点的总浓度 $[R]_T$。它由红细胞浓度 $c_{\\mathrm{RBC}}$ 与每个细胞的 CR1 位点数 $N$ 的乘积，再除以 Avogadro 常数 $N_A$ 给出。\n$$[R]_T = \\frac{c_{\\mathrm{RBC}} \\times N}{N_A}$$\n使用所提供的值：$c_{\\mathrm{RBC}} = 5.0 \\times 10^{12}\\,\\text{个细胞}\\cdot\\text{L}^{-1}$，$N = 500\\,\\text{个位点}\\cdot\\text{细胞}^{-1}$，以及 $N_A = 6.022 \\times 10^{23}\\,\\text{mol}^{-1}$。\n$$[R]_T = \\frac{(5.0 \\times 10^{12}) \\times 500}{6.022 \\times 10^{23}} \\text{ mol}\\cdot\\text{L}^{-1}$$\n$$[R]_T = \\frac{2.5 \\times 10^{15}}{6.022 \\times 10^{23}} \\text{ mol}\\cdot\\text{L}^{-1} \\approx 4.1514 \\times 10^{-9} \\text{ mol}\\cdot\\text{L}^{-1}$$\n为了与其他给定浓度保持一致，我们将其表示为纳摩尔（$1 \\text{ nM} = 10^{-9} \\text{ mol}\\cdot\\text{L}^{-1}$）：\n$$[R]_T \\approx 4.1514 \\text{ nM}$$\n\n平衡状态由解离常数 $K_D$ 以及配体和受体的质量守恒定律描述。问题指出不要假设配体远超过量，这意味着我们必须解这个精确的方程组。\n解离平衡为：\n$$K_D = \\frac{[R]_{\\mathrm{free}}[L]_{\\mathrm{free}}}{[RL]}$$\n守恒方程为：\n$$[R]_T = [R]_{\\mathrm{free}} + [RL]$$\n$$[L]_T = [L]_{\\mathrm{free}} + [RL]$$\n根据守恒方程，我们用结合浓度 $[RL]$ 来表示游离浓度：\n$$[R]_{\\mathrm{free}} = [R]_T - [RL]$$\n$$[L]_{\\mathrm{free}} = [L]_T - [RL]$$\n将这些表达式代入 $K_D$ 的定义中：\n$$K_D = \\frac{([R]_T - [RL])([L]_T - [RL])}{[RL]}$$\n将此方程整理成标准的一元二次方程形式 $a x^2 + b x + c = 0$，其中变量 $x$ 是 $[RL]$：\n$$K_D [RL] = [R]_T [L]_T - ([R]_T + [L]_T)[RL] + [RL]^2$$\n$$[RL]^2 - ([R]_T + [L]_T + K_D)[RL] + [R]_T [L]_T = 0$$\n我们使用一元二次方程求根公式来解出 $[RL]$：\n$$[RL] = \\frac{([R]_T + [L]_T + K_D) \\pm \\sqrt{([R]_T + [L]_T + K_D)^2 - 4[R]_T [L]_T}}{2}$$\n浓度 $[RL]$ 必须具有物理意义；具体来说，它不能超过总受体浓度 $[R]_T$ 或总配体浓度 $[L]_T$。带加号的解会得出一个比 $[R]_T$ 和 $[L]_T$ 都大的 $[RL]$ 值，这不符合物理实际。因此，我们必须选择带减号的解：\n$$[RL] = \\frac{([R]_T + [L]_T + K_D) - \\sqrt{([R]_T + [L]_T + K_D)^2 - 4[R]_T [L]_T}}{2}$$\n现在我们代入数值：$[R]_T \\approx 4.1514 \\text{ nM}$，$[L]_T = 25 \\text{ nM}$，以及 $K_D = 15 \\text{ nM}$。\n首先，我们计算和：\n$$[R]_T + [L]_T + K_D \\approx 4.1514 + 25 + 15 = 44.1514 \\text{ nM}$$\n以及积：\n$$[R]_T [L]_T \\approx 4.1514 \\times 25 = 103.785 \\text{ (nM)}^2$$\n将这些值代入 $[RL]$ 的解中：\n$$[RL] \\approx \\frac{44.1514 - \\sqrt{(44.1514)^2 - 4(103.785)}}{2} \\text{ nM}$$\n$$[RL] \\approx \\frac{44.1514 - \\sqrt{1949.346 - 415.14}}{2} \\text{ nM}$$\n$$[RL] \\approx \\frac{44.1514 - \\sqrt{1534.206}}{2} \\text{ nM}$$\n$$[RL] \\approx \\frac{44.1514 - 39.1690}{2} \\text{ nM} = \\frac{4.9824}{2} \\text{ nM} = 2.4912 \\text{ nM}$$\n\n接下来，我们计算位点占据分数 $\\theta$，其定义为 $\\theta = \\frac{[RL]}{[R]_T}$。\n$$\\theta = \\frac{2.4912 \\text{ nM}}{4.1514 \\text{ nM}} \\approx 0.60007$$\n单个红细胞的饱和概率 $P_{\\mathrm{sat}}$ 是所有 $N = 500$ 个独立位点都被占据的概率。这由 $P_{\\mathrm{sat}} = \\theta^N$ 给出。\n$$P_{\\mathrm{sat}} = (0.60007)^{500}$$\n为了计算这个非常小的数，我们使用对数：\n$$\\log_{10}(P_{\\mathrm{sat}}) = 500 \\times \\log_{10}(0.60007) \\approx 500 \\times (-0.221799) \\approx -110.8995$$\n$$P_{\\mathrm{sat}} = 10^{-110.8995} = 10^{0.1005} \\times 10^{-111} \\approx 1.260 \\times 10^{-111}$$\n将结果四舍五入到三位有效数字，我们得到 $P_{\\mathrm{sat}} \\approx 1.26 \\times 10^{-111}$。\n\n最后，问题要求判断是否预测会出现清除功能受损。这需要计算游离配体分数 $f_{\\mathrm{free}} = \\frac{[L]_{\\mathrm{free}}}{[L]_T}$。\n$$[L]_{\\mathrm{free}} = [L]_T - [RL] \\approx 25 \\text{ nM} - 2.4912 \\text{ nM} = 22.5088 \\text{ nM}$$\n$$f_{\\mathrm{free}} = \\frac{22.5088 \\text{ nM}}{25 \\text{ nM}} \\approx 0.9004$$\n清除功能受损的标准是 $f_{\\mathrm{free}} > \\phi$，其中 $\\phi = 0.25$。由于 $0.9004 > 0.25$，因此在这些条件下预测会出现清除功能受损。", "answer": "$$\\boxed{1.26 \\times 10^{-111}}$$", "id": "2904455"}, {"introduction": "补体系统的激活是免疫复合物介导的组织损伤中的核心环节，其特点是复杂的正反馈和精密的负向调控。本练习将带您进入计算免疫学的领域，通过构建和求解一个常微分方程模型，来模拟C3转化酶在免疫复合物表面的动态行为。通过调整关键调控蛋白（如备解素和H因子）的浓度，您将亲手探索补体激活的“开关”行为和稳态转换，从而深入理解炎症反应是如何被触发和控制的。[@problem_id:2904408]", "problem": "一个激活补体的免疫复合物表面支持补体3（C3）转化酶的形成，其表面覆盖分数由 $x \\in [0,1]$ 表示。将免疫复合物上C3转化酶的组装和衰变建模为一个通过C3b沉积实现正反馈的单位点覆盖过程。从质量作用动力学和位点守恒出发，作如下假设：\n\n1. 组装遵循质量作用动力学，其有效组装驱动为 $A_{\\mathrm{eff}}(x)$，可用位点为 $(1 - x)$，组装速率常数为 $k_{\\mathrm{ass}}$。因此，组装通量为 $k_{\\mathrm{ass}} (1 - x) A_{\\mathrm{eff}}(x)$。\n\n2. 衰变与失活以有效的一级速率 $k_{\\mathrm{dec}}$ 发生，该速率取决于调节因子Properdin（稳定剂，记为 $P$）、H因子（Factor H, FH，记为 $H$）和I因子（Factor I, FI，记为 $I$）的浓度。基线衰变速率为 $k_0$。Properdin稳定（降低）基线衰变，而H因子和I因子则增加衰变与失活。假设\n$$\nk_{\\mathrm{dec}}(P,H,I) \\;=\\; \\frac{k_0}{1 + a_P P} \\;+\\; k_H H \\;+\\; k_I I,\n$$\n其中 $a_P$ 是Properdin的稳定系数，而 $k_H$ 和 $k_I$ 分别是H因子和I因子的比例常数。\n\n3. C3转化酶通过C3b沉积对其自身组装产生的正反馈被建模为一个饱和函数\n$$\nA_{\\mathrm{eff}}(x) \\;=\\; A_0 \\;+\\; \\frac{\\alpha \\, x}{K + x},\n$$\n其中 $A_0$ 是基础激活驱动（例如，来自免疫复合物上经典途径的启动），$\\alpha$ 是反馈强度，$K$ 是半饱和常数。\n\n这些假设导出了关于 $x(t)$ 的常微分方程（ODE）：\n$$\n\\frac{dx}{dt} \\;=\\; k_{\\mathrm{ass}} \\, (1 - x) \\, A_{\\mathrm{eff}}(x) \\;-\\; k_{\\mathrm{dec}}(P,H,I)\\, x.\n$$\n\n将工作点定义为在ODE动力学下，从初始条件 $x(0)=x_0$ 达到的动态稳定稳态 $x^\\star \\in [0,1]$，其中 $x_0$ 是一个非常小但为正的值，即 $x_0 = 10^{-9}$。由于正反馈可能引入多个不动点，因此工作点是由此动态选择准则定义的，其本身并非具有最大值或最小值的代数解。\n\n您的任务是编写一个程序，对下面测试套件中的每一组参数，通过对ODE进行数值积分直至收敛来计算 $x^\\star$。在积分过程中强制执行物理边界 $x \\in [0,1]$。按规定使用无量纲变量和参数；无需物理单位。将时间视为无量纲。当 $|x_{n+1} - x_n| < 10^{-10}$ 和 $|\\frac{dx}{dt}| < 10^{-10}$ 同时满足时，认为解已收敛。\n\n测试套件（每个案例提供有序参数 $(A_0,\\alpha,K,k_{\\mathrm{ass}},k_0,a_P,P,k_H,H,k_I,I)$）：\n\n- 案例1：$(0.05,\\,1.2,\\,0.05,\\,1.0,\\,0.3,\\,1.5,\\,0.1,\\,0.6,\\,0.2,\\,0.3,\\,0.1)$\n- 案例2（增加H因子）：$(0.05,\\,1.2,\\,0.05,\\,1.0,\\,0.3,\\,1.5,\\,0.1,\\,0.6,\\,1.0,\\,0.3,\\,0.1)$\n- 案例3（增加Properdin）：$(0.05,\\,1.2,\\,0.05,\\,1.0,\\,0.3,\\,1.5,\\,1.0,\\,0.6,\\,0.2,\\,0.3,\\,0.1)$\n- 案例4（无基础驱动，更强的调节）：$(0.0,\\,0.5,\\,0.05,\\,1.0,\\,0.3,\\,1.5,\\,0.0,\\,0.6,\\,0.5,\\,0.3,\\,0.5)$\n- 案例5（强正反馈）：$(0.02,\\,5.0,\\,0.01,\\,1.0,\\,0.2,\\,1.0,\\,0.3,\\,0.4,\\,0.1,\\,0.2,\\,0.1)$\n\n算法要求：\n\n- 从 $x(0)=10^{-9}$ 开始，使用显式时间步进格式进行积分，其步长 $\\Delta t$ 自适应于瞬时时间尺度 $\\tau = 1/\\left(k_{\\mathrm{ass}}(1-x)A_{\\mathrm{eff}}(x) + k_{\\mathrm{dec}}(P,H,I)\\right)$，例如使用 $\\Delta t = \\min(0.1 \\tau, 1.0)$，并在每一步后将 $x$ 的值限制在 $[0,1]$ 区间内。\n- 当满足上述收敛准则时，或在足够多的步数后停止，以避免无限循环。如果达到最大迭代次数上限仍未收敛，则返回最后计算的 $x$。\n\n答案规格：\n\n- 对于每个案例，将工作点 $x^\\star$ 输出为四舍五入到6位小数的浮点数。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[0.123456,0.234567,0.345678,0.456789,0.567890]$）。不应打印任何额外文本。", "solution": "该问题提出了一个确定性模型，用于描述免疫复合物上C3转化酶表面覆盖度（由分数 $x(t)$ 表示）的动力学。该模型被表述为一个基于质量作用动力学的一阶常微分方程（ODE）。我已验证问题陈述，并发现其具有科学依据、提法适定且内容完整。数值求解的指令，尽管采用了特定的启发式方法来确定时间步长，但是明确且计算上可行的。因此，我将着手求解。\n\n问题的核心是这个ODE：\n$$\n\\frac{dx}{dt} \\;=\\; k_{\\mathrm{ass}} \\, (1 - x) \\, A_{\\mathrm{eff}}(x) \\;-\\; k_{\\mathrm{dec}}(P,H,I)\\, x\n$$\n这里，$x \\in [0,1]$ 是被C3转化酶占据的表面位点的分数。该方程代表了组装过程和衰变过程之间的平衡。\n\n组装通量 $J_{\\mathrm{ass}} = k_{\\mathrm{ass}} \\, (1 - x) \\, A_{\\mathrm{eff}}(x)$，与可用位点分数 $(1-x)$ 和有效组装驱动 $A_{\\mathrm{eff}}(x)$ 成正比。组装驱动模拟了补体系统的一个关键方面：正反馈。它由一个基础激活项 $A_0$ 和一个依赖于现有转化酶覆盖度 $x$ 的饱和反馈项组成：\n$$\nA_{\\mathrm{eff}}(x) \\;=\\; A_0 \\;+\\; \\frac{\\alpha \\, x}{K + x}\n$$\n在这里，$\\alpha$ 代表由C3b沉积介导的正反馈回路的强度，$K$ 是此反馈的半饱和常数。\n\n衰变通量 $J_{\\mathrm{dec}} = k_{\\mathrm{dec}}x$ 是一个一级过程，其有效速率常数 $k_{\\mathrm{dec}}$ 取决于调节蛋白的浓度：\n$$\nk_{\\mathrm{dec}}(P,H,I) \\;=\\; \\frac{k_0}{1 + a_P P} \\;+\\; k_H H \\;+\\; k_I I\n$$\n这模拟了Properdin ($P$) 对转化酶的稳定作用以及由H因子 ($H$) 和I因子 ($I$) 引起的加速衰变。参数 $k_0$、$a_P$、$k_H$ 和 $k_I$ 是量化这些效应的常数。\n\n问题要求计算“工作点”$x^\\star$，它被定义为系统从一个极小的初始覆盖度 $x(0) = x_0 = 10^{-9}$ 演化而来的稳定稳态。稳态是指净变化率为零的点，即 $\\frac{dx}{dt} = 0$。非线性反馈项的存在可能导致多个稳态（双稳态）。通过要求从特定的初始条件进行模拟，问题指定了一个唯一的、动态选择的解。\n\n为了找到 $x^\\star$，我们必须对ODE进行数值积分。问题指定了一个显式时间步进格式。我将采用前向欧拉法，其中状态在每一步 $n$ 按如下方式更新：\n$$\nx_{n+1} = x_n + \\Delta t_n \\cdot f(x_n)\n$$\n其中 $f(x_n) = (\\frac{dx}{dt})|_{x=x_n}$。\n\n时间步长 $\\Delta t_n$ 是自适应的，基于一个为瞬时时间尺度 $\\tau_n$ 设定的启发式规则：\n$$\n\\tau_n = \\frac{1}{k_{\\mathrm{ass}}(1-x_n)A_{\\mathrm{eff}}(x_n) + k_{\\mathrm{dec}}}\n$$\n那么，对于给定的迭代，时间步长为 $\\Delta t_n = \\min(0.1 \\tau_n, 1.0)$。这种自适应方案在系统动力学较快时会调小步长，以确保数值稳定性和准确性。每一步之后，$x$ 的值被限制在物理上有意义的区间 $[0,1]$ 内。\n\n积分过程一直持续到系统收敛到一个稳态。收敛的定义是同时满足两个条件：每一步 $x$ 的变化可以忽略不计，即 $|x_{n+1} - x_n| < 10^{-10}$，并且净变化率接近于零，即 $|\\frac{dx}{dt}| < 10^{-10}$。为了防止陷入无限循环，设置了最大迭代次数。\n\n该算法实现为一个Python函数，它接受一组参数，计算出常数 $k_{\\mathrm{dec}}$，并根据上述规则从 $x_0$ 开始迭代更新 $x$，直到达到收敛。对测试套件中提供的五组参数中的每一组都重复此过程。然后将每个案例最终计算出的稳态值 $x^\\star$ 四舍五入到6位小数，并按指定格式输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state C3 convertase coverage for multiple parameter sets.\n    \"\"\"\n    \n    # Each tuple contains parameters in the order:\n    # (A0, alpha, K, k_ass, k0, aP, P, kH, H, kI, I)\n    test_cases = [\n        (0.05, 1.2, 0.05, 1.0, 0.3, 1.5, 0.1, 0.6, 0.2, 0.3, 0.1),\n        (0.05, 1.2, 0.05, 1.0, 0.3, 1.5, 0.1, 0.6, 1.0, 0.3, 0.1),\n        (0.05, 1.2, 0.05, 1.0, 0.3, 1.5, 1.0, 0.6, 0.2, 0.3, 0.1),\n        (0.0, 0.5, 0.05, 1.0, 0.3, 1.5, 0.0, 0.6, 0.5, 0.3, 0.5),\n        (0.02, 5.0, 0.01, 1.0, 0.2, 1.0, 0.3, 0.4, 0.1, 0.2, 0.1),\n    ]\n\n    results = []\n    for params in test_cases:\n        x_star = compute_steady_state(params)\n        results.append(f\"{x_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef compute_steady_state(params):\n    \"\"\"\n    Computes the steady state x* by numerically integrating the ODE.\n    \n    The function uses an explicit Euler method with an adaptive time step\n    as specified in the problem description.\n    \"\"\"\n    A0, alpha, K, k_ass, k0, aP, P, kH, H, kI, I = params\n\n    # --- Simulation constants ---\n    X0 = 1e-9                      # Initial condition for x\n    MAX_ITERATIONS = 5_000_000     # Safety break to prevent infinite loops\n    CONVERGENCE_TOL_DX = 1e-10     # Tolerance for change in x\n    CONVERGENCE_TOL_DXDT = 1e-10   # Tolerance for rate of change\n    DT_FACTOR = 0.1                # Factor for adaptive time step (0.1 * tau)\n    MAX_DT = 1.0                   # Maximum allowed time step\n\n    # Pre-calculate the constant effective decay rate k_dec\n    k_dec = (k0 / (1.0 + aP * P)) + kH * H + kI * I\n\n    x = X0\n    \n    for _ in range(MAX_ITERATIONS):\n        x_old = x\n        \n        # Calculate the effective assembly drive A_eff(x)\n        A_eff = A0 + (alpha * x) / (K + x)\n        \n        # Calculate the net rate of change of x (dx/dt)\n        assembly_flux = k_ass * (1.0 - x) * A_eff\n        decay_flux = k_dec * x\n        dxdt = assembly_flux - decay_flux\n        \n        # Calculate the adaptive time step delta_t\n        # The prompt defines tau = 1 / (k_ass*(1-x)*A_eff + k_dec).\n        # This is inv_tau = k_ass*(1-x)*A_eff + k_dec.\n        inv_tau = assembly_flux + k_dec\n        \n        # inv_tau should always be non-negative given the problem constraints\n        if inv_tau > 1e-12: # Check for non-zero to avoid division by zero\n            tau = 1.0 / inv_tau\n        else:\n            # Fallback in the unlikely event inv_tau is not positive.\n            # A large tau effectively limits dt to MAX_DT.\n            tau = np.inf\n            \n        dt = min(DT_FACTOR * tau, MAX_DT)\n\n        # Update x using the Forward Euler method\n        x = x + dt * dxdt\n        \n        # Enforce the physical boundary condition x in [0, 1]\n        x = max(0.0, min(1.0, x))\n\n        # Check for convergence\n        step_change = abs(x - x_old)\n        if step_change < CONVERGENCE_TOL_DX and abs(dxdt) < CONVERGENCE_TOL_DXDT:\n            break\n            \n    return x\n\nsolve()\n```", "id": "2904408"}]}