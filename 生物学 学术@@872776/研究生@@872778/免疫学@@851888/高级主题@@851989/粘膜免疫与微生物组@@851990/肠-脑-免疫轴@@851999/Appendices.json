{"hands_on_practices": [{"introduction": "肠道屏障的完整性是维持肠-脑-免疫轴稳态的基石。该屏障通透性的微小变化，可能导致微生物产物进入循环系统，从而引发全身性免疫反应和神经炎症。本练习将引导您应用经典的生物物理模型，亲手计算由紧密连接孔隙半径的微小变化所引起的分子通量改变，从而深入理解肠道通透性在分子层面的调控机制及其宏观功能后果 [@problem_id:2897925]。", "problem": "在肠-脑-免疫轴的背景下，由zonulin（连蛋白）调节的肠道通透性可以改变如异硫氰酸荧光素-葡聚糖（FITC-dextran）等示踪剂的细胞旁转运，从而对全身性免疫激活和神经炎症产生下游影响。考虑一个单层上皮，其中的细胞旁转运通过一个圆柱形紧密连接孔阵列发生。假设以下具有科学依据且广泛使用的基础：\n\n- 菲克扩散定律：对于跨越厚度为 $L$ 的膜的扩散通量，稳态溶质通量 $J$ 满足 $J = P \\,\\Delta C$，其中 $P$ 是通透性，$\\Delta C$ 是跨膜浓度差。\n- 对于通过 $N_{p}$ 个半径为 $r$、长度为 $L$ 的相同圆柱形孔的扩散，通透性可以写为 $P = N_{p}\\,\\frac{\\pi r^{2}}{L}\\,K(\\lambda)\\,H_{D}(\\lambda)\\,D_{s}$，其中 $D_{s}$ 是溶质的自由溶液扩散系数，$\\lambda = a_{s}/r$ 是溶质-孔径尺寸比，$a_{s}$ 是溶质流体动力学半径，$K(\\lambda)$ 是考虑了空间排斥的分配系数，$H_{D}(\\lambda)$ 是考虑了孔内流体动力学拖拽的扩散阻碍因子。\n- 对于圆柱形孔，使用经典的 Renkin 近似：$K(\\lambda) = (1-\\lambda)^{2}$ 和 $H_{D}(\\lambda) = 1 - 2.104\\,\\lambda + 2.09\\,\\lambda^{3} - 0.95\\,\\lambda^{5}$，在 $0 \\le \\lambda  1$ 时有效。\n- 假设为扩散主导的转运（对流溶剂流可忽略不计）、跨膜浓度差 $\\Delta C$ 恒定、膜厚度 $L$ 恒定以及孔数量 $N_{p}$ 恒定。\n\n一次受控的zonulin暴露使紧密连接孔的半径从基线值 $r_{0} = 2.5\\,\\text{nm}$ 增加了 $20$%，达到 $r_{1} = 1.2\\,r_{0}$，而孔密度 $N_{p}$ 保持不变。示踪剂是 $4\\,\\text{kDa}$ 的 FITC-葡聚糖，其流体动力学半径为 $a_{s} = 1.4\\,\\text{nm}$。在这些假设下，计算孔半径增加后 FITC-葡聚糖的稳态扩散通量 $J$ 的倍数变化。将您的答案报告为一个纯数（无量纲），并将结果四舍五入到三位有效数字。", "solution": "问题陈述经评估，被确定为具有科学依据、问题明确、客观且内部一致。它基于多孔介质中生物物理输运的既定原理，特别是该领域中标准的、用于受阻扩散的 Renkin 方程。所有必需的参数均已提供，问题没有歧义。我们将开始推导。\n\n目标是计算稳态扩散通量的倍数变化，表示为比率 $\\frac{J_{1}}{J_{0}}$，其中 $J_{0}$ 是初始通量，$J_{1}$ 是孔半径增加后的最终通量。\n\n根据给定的菲克定律，溶质通量 $J$ 与通透性 $P$ 成正比，即 $J = P\\,\\Delta C$。由于跨膜浓度差 $\\Delta C$ 被声明为恒定，通量之比等于通透性之比：\n$$\n\\frac{J_{1}}{J_{0}} = \\frac{P_{1}\\,\\Delta C}{P_{0}\\,\\Delta C} = \\frac{P_{1}}{P_{0}}\n$$\n通透性 $P$ 由以下表达式给出：\n$$\nP = N_{p}\\,\\frac{\\pi r^{2}}{L}\\,K(\\lambda)\\,H_{D}(\\lambda)\\,D_{s}\n$$\n其中 $r$ 是孔半径，$\\lambda = a_{s}/r$ 是溶质-孔径尺寸比。参数 $N_{p}$（孔数量）、$L$（膜厚度）和 $D_{s}$（自由溶液扩散系数）是恒定的。因此，我们可以将通透性之比写为：\n$$\n\\frac{P_{1}}{P_{0}} = \\frac{N_{p}\\,\\frac{\\pi r_{1}^{2}}{L}\\,K(\\lambda_1)\\,H_{D}(\\lambda_1)\\,D_{s}}{N_{p}\\,\\frac{\\pi r_{0}^{2}}{L}\\,K(\\lambda_0)\\,H_{D}(\\lambda_0)\\,D_{s}}\n$$\n消去常数项（$N_{p}$、$\\pi$、$L$、$D_{s}$），我们得到倍数变化的简化表达式：\n$$\n\\frac{J_{1}}{J_{0}} = \\left(\\frac{r_{1}}{r_{0}}\\right)^{2} \\frac{K(\\lambda_{1})\\,H_{D}(\\lambda_{1})}{K(\\lambda_{0})\\,H_{D}(\\lambda_{0})}\n$$\n现在我们必须根据所提供的数据计算此表达式的各个组成部分。\n\n给定条件是：\n- 初始孔半径：$r_{0} = 2.5\\,\\text{nm}$\n- 溶质流体动力学半径：$a_{s} = 1.4\\,\\text{nm}$\n- 最终孔半径：$r_{1} = 1.2\\,r_{0}$\n\n首先，我们计算初始状态（下标为 $0$）的值：\n孔半径为 $r_{0} = 2.5\\,\\text{nm}$。\n尺寸比为 $\\lambda_{0} = \\frac{a_{s}}{r_{0}} = \\frac{1.4\\,\\text{nm}}{2.5\\,\\text{nm}} = 0.56$。\n该值在有效范围 $0 \\le \\lambda  1$ 内。\n\n分配系数 $K(\\lambda_{0})$ 为：\n$$\nK(\\lambda_{0}) = (1 - \\lambda_{0})^{2} = (1 - 0.56)^{2} = (0.44)^{2} = 0.1936\n$$\n扩散阻碍因子 $H_{D}(\\lambda_{0})$ 为：\n$$\nH_{D}(\\lambda_{0}) = 1 - 2.104\\,\\lambda_{0} + 2.09\\,\\lambda_{0}^{3} - 0.95\\,\\lambda_{0}^{5}\n$$\n代入 $\\lambda_{0} = 0.56$：\n$$\nH_{D}(0.56) = 1 - 2.104(0.56) + 2.09(0.56)^{3} - 0.95(0.56)^{5}\n$$\n$$\nH_{D}(0.56) = 1 - 1.17824 + 2.09(0.175616) - 0.95(0.0550731776)\n$$\n$$\nH_{D}(0.56) = 1 - 1.17824 + 0.36703744 - 0.05231951872\n$$\n$$\nH_{D}(0.56) \\approx 0.13647792\n$$\n初始状态的乘积为 $K(\\lambda_{0})\\,H_{D}(\\lambda_{0}) \\approx 0.1936 \\times 0.13647792 \\approx 0.02642124$。\n\n接下来，我们计算最终状态（下标为 $1$）的值：\n最终孔半径为 $r_{1} = 1.2\\,r_{0} = 1.2 \\times 2.5\\,\\text{nm} = 3.0\\,\\text{nm}$。\n新的尺寸比为 $\\lambda_{1} = \\frac{a_{s}}{r_{1}} = \\frac{1.4\\,\\text{nm}}{3.0\\,\\text{nm}} = \\frac{14}{30} = \\frac{7}{15} \\approx 0.4667$。\n该值也在有效范围 $0 \\le \\lambda  1$ 内。\n\n分配系数 $K(\\lambda_{1})$ 为：\n$$\nK(\\lambda_{1}) = (1 - \\lambda_{1})^{2} = \\left(1 - \\frac{7}{15}\\right)^{2} = \\left(\\frac{8}{15}\\right)^{2} = \\frac{64}{225} \\approx 0.2844\n$$\n扩散阻碍因子 $H_{D}(\\lambda_{1})$ 为：\n$$\nH_{D}(\\lambda_{1}) = 1 - 2.104\\,\\lambda_{1} + 2.09\\,\\lambda_{1}^{3} - 0.95\\,\\lambda_{1}^{5}\n$$\n代入 $\\lambda_{1} = 7/15$：\n$$\nH_{D}\\left(\\frac{7}{15}\\right) = 1 - 2.104\\left(\\frac{7}{15}\\right) + 2.09\\left(\\frac{7}{15}\\right)^{3} - 0.95\\left(\\frac{7}{15}\\right)^{5}\n$$\n$$\nH_{D}\\left(\\frac{7}{15}\\right) \\approx 1 - 2.104(0.46667) + 2.09(0.10163) - 0.95(0.02213)\n$$\n$$\nH_{D}\\left(\\frac{7}{15}\\right) \\approx 1 - 0.98187 + 0.21241 - 0.02102\n$$\n$$\nH_{D}\\left(\\frac{7}{15}\\right) \\approx 0.20952\n$$\n让我们以更高的精度计算：\n$H_{D}\\left(\\frac{7}{15}\\right) = 1 - 0.981866... + 0.2124059... - 0.021026... \\approx 0.209513$\n最终状态的乘积为 $K(\\lambda_{1})\\,H_{D}(\\lambda_{1}) \\approx \\frac{64}{225} \\times 0.209513 \\approx 0.059596$。\n\n最后，我们计算通量的倍数变化：\n$$\n\\frac{J_{1}}{J_{0}} = \\left(\\frac{r_{1}}{r_{0}}\\right)^{2} \\frac{K(\\lambda_{1})\\,H_{D}(\\lambda_{1})}{K(\\lambda_{0})\\,H_{D}(\\lambda_{0})}\n$$\n半径平方的比值为 $(1.2)^{2} = 1.44$。\n$$\n\\frac{J_{1}}{J_{0}} \\approx (1.44) \\times \\frac{0.059596}{0.026421}\n$$\n$$\n\\frac{J_{1}}{J_{0}} \\approx 1.44 \\times 2.2556\n$$\n$$\n\\frac{J_{1}}{J_{0}} \\approx 3.2481\n$$\n将结果四舍五入到三位有效数字，我们得到 $3.25$。", "answer": "$$\n\\boxed{3.25}\n$$", "id": "2897925"}, {"introduction": "当像丁酸这样的短链脂肪酸（SCFA）穿过肠道屏障后，它们如何在复杂的生物网络中发挥其对神经系统的有益作用？在人体研究中，我们往往只能获取观察性数据，这使得理清因果关系变得极具挑战性。本练习将带您进入因果推断的前沿领域，运用有向无环图（DAG）和后门准则（backdoor criterion）这一严谨的工具，来识别和控制混杂因素，从而在复杂的观察数据中准确估计丁酸对小胶质细胞活化的真实因果效应 [@problem_id:2897915]。", "problem": "一项免疫学队列研究量化了肠-脑-免疫轴内循环丁酸盐对中枢神经系统小胶质细胞活化的总因果效应。设暴露为循环丁酸盐浓度，用 $X$ 表示；结果为小胶质细胞活化，用 $Y$ 表示。该研究是观察性的（无随机化），关于有向无环图（DAG）的以下领域知识被认为得到了关于短链脂肪酸和神经免疫信号传导的实验和临床文献的充分支持：\n\n- $M$ 表示肠道微生物组组成，重点是产丁酸盐的分类群；$F$ 表示膳食纤维摄入量；$A$ 表示抗生素暴露；$S$ 表示社会心理压力；$G$ 表示宿主遗传；$I$ 表示全身性炎症；$B$ 表示血脑屏障完整性；$V$ 表示迷走神经张力；$C$ 表示采样日的门诊就诊情况；$U$ 表示一个影响采样计划和分析前条件（例如，距离上一餐的时间或预约依从性倾向）的潜在因子，该因子未被测量。\n\n- $X$ 和 $Y$ 上游的因果关系：\n  - $F \\to M$, $A \\to M$, $S \\to M$, $G \\to M$。\n  - $M \\to X$ （微生物组是丁酸盐的主要来源），$G \\to X$ （转运/代谢的遗传调控）。\n  - $S \\to F$, $A \\to I$, $F \\to I$, $M \\to I$, $S \\to I$。\n  - $G \\to Y$ （小胶质细胞敏感性的遗传调节），$S \\to Y$ （下丘脑-垂体-肾上腺（HPA）轴和儿茶酚胺能效应），$M \\to Y$ （免疫和神经信号传导）。\n  - $X \\to Y$ 效应的中介因子：$X \\to I \\to Y$, $X \\to B \\to Y$, $X \\to V \\to Y$。\n  - 对撞和选择结构：$Y \\to C \\leftarrow U$，以及 $U \\to X$ （分析前因子 $U$ 直接影响 $X$，但除了通过 $C$ 之外不影响 $Y$）。不存在从 $C$ 到任何其他节点的边。\n  - 不存在从 $X$ 到 $M$ 的箭头（在测量的时间尺度上，微生物组影响丁酸盐，反之则不然），也不存在从 $Y$ 到 $X$ 的箭头（在采样时，结果不会因果地改变丁酸盐）。\n\n假设 $X$, $Y$, $M$, $F$, $A$, $S$, $G$, $I$, $B$, $V$ 和 $C$ 是可测量的，而 $U$ 是不可测量的。目标是 $X$ 对 $Y$ 的总因果效应，即对于 $x$ 的相关值，通过对从 $X$ 到 $Y$ 的所有中介路径进行积分得到的数量 $\\mathbb{E}[Y \\mid do(X=x)]$。\n\n仅使用应用于上述DAG的后门准则以及通过调整进行因果识别的定义，选择一个协变量集，该集合是在此观察性设置中识别 $X$ 对 $Y$ 的总因果效应的有效最小充分调整集。如果一个集合满足后门准则且其任何真子集都不满足，则该集合是最小充分的。\n\n选项：\nA. $\\{M, G\\}$\n\nB. $\\{G, F, A, S\\}$\n\nC. $\\{M, G, I\\}$\n\nD. $\\{M, G, C\\}$\n\nE. $\\{M, G, F, A, S\\}$\n\n您的推理应从第一性原理开始：后门准则的定义，以及调整集如何在不以 $X \\to Y$ 的中介因子为条件或通过对撞节点打开虚假关联的情况下，阻断所有后门路径。", "solution": "该问题要求基于所提供的有向无环图（DAG），识别一个最小充分调整集，以估计循环丁酸盐浓度（$X$）对小胶质细胞活化（$Y$）的总因果效应。使用的方法是后门准则。\n\n首先，我们必须根据后门准则形式化充分调整集的定义。对于估计 $X$ 对 $Y$ 的总因果效应，一个协变量集 $Z$ 是充分调整集，如果满足两个条件：\n1.  $Z$ 中没有变量是 DAG 中 $X$ 的后代。\n2.  $Z$ 中的变量阻断了 $X$ 和 $Y$ 之间的所有后门路径。\n\n后门路径是 $X$ 和 $Y$ 之间任何以指向 $X$ 的箭头开始的路径。如果一个集合 $Z$ 是一个充分调整集，并且 $Z$ 的任何真子集都不是充分调整集，那么 $Z$ 就是一个*最小*充分调整集。\n\n分析过程是通过识别从 $X$ 到 $Y$ 的所有后门路径，并确定阻断它们所需的最小协变量集，同时不违反这两个条件。\n\n在给定的DAG中，暴露 $X$ 的父节点是 $\\{M, G, U\\}$。因此，所有后门路径都必须以指向 $X$ 的三个边之一开始：$X \\leftarrow M$、$X \\leftarrow G$ 或 $X \\leftarrow U$。我们逐一审查每种情况。\n\n**情况1：源于 $M$ 的后门路径。**\nDAG 包含边 $M \\to X$ 和 $M \\to Y$。这构成了路径 $X \\leftarrow M \\to Y$。这是一条典型的混杂路径，其中 $M$（肠道微生物组）是 $X$ 和 $Y$ 的共同原因。要阻断这条路径，共同原因 $M$ 必须被包含在调整集 $Z$ 中。此外，还有其他从 $M$ 到 $Y$ 的路径，例如 $M \\to I \\to Y$，这会产生像 $X \\leftarrow M \\to I \\to Y$ 这样的后门路径。还有从 $M$ 的父节点 $\\{F, A, S, G\\}$ 到 $M$ 的路径，这会产生更长的后门路径，例如 $X \\leftarrow M \\leftarrow S \\to Y$。所有包含 $X \\leftarrow M$ 片段的此类路径都可以通过对 $M$ 进行条件化来阻断。因此，$M$ 是调整集的一个必要组成部分，以关闭所有通过它的后门路径。\n\n**情况2：源于 $G$ 的后门路径。**\nDAG 包含边 $G \\to X$ 和 $G \\to Y$。这产生了后门路径 $X \\leftarrow G \\to Y$。在这里，$G$（宿主遗传）是 $X$ 和 $Y$ 的共同原因。要阻断这条简单的混杂路径，$G$ 必须被包含在调整集 $Z$ 中。其他涉及 $G$ 的后门路径，例如 $X \\leftarrow G \\to M \\to Y$，也可以通过对 $G$ 进行条件化来阻断。因此，$G$ 也是调整集的一个必要组成部分。\n\n**情况3：源于 $U$ 的后门路径。**\nDAG 指定了边 $U \\to X$ 和 $Y \\to C \\leftarrow U$。这个结构形成了后门路径 $X \\leftarrow U \\to C \\leftarrow Y$。这条路径上的节点 $C$ 是一个对撞节点，因为有两条箭头指向它（$U \\to C$ 和 $Y \\to C$）。包含对撞节点的路径是自然受阻的，除非对该对撞节点本身或其任一后代进行条件化。问题陈述 $U$ 是一个未测量的潜在因子。为了保持路径 $X \\leftarrow U \\to C \\leftarrow Y$ 的受阻状态，我们*不能*对对撞节点 $C$ 进行条件化。由于在DAG中没有指定 $C$ 的后代，这仅仅意味着 $C$ 不能在调整集 $Z$ 中。\n\n**综合调整集：**\n从分析中，我们推导出对我们的集合 $Z$ 的以下要求：\n-   $M \\in Z$ 以阻断混杂路径 $X \\leftarrow M \\to Y$ 以及所有以 $X \\leftarrow M$ 开始的其他路径。\n-   $G \\in Z$ 以阻断混杂路径 $X \\leftarrow G \\to Y$ 以及所有以 $X \\leftarrow G$ 开始的其他路径。\n-   $C \\notin Z$ 以避免打开路径 $X \\leftarrow U \\to C \\leftarrow Y$，这会从未测量的混杂因子 $U$ 引入偏倚。\n\n满足这些要求的最简单集合是 $Z = \\{M, G\\}$。我们现在必须正式验证这个集合是否是一个最小充分调整集。\n\n**验证 $Z = \\{M, G\\}$：**\n1.  **条件1：$Z$ 中没有 $X$ 的后代。** $X$ 的后代是从 $X$ 出发通过有向路径可以到达的节点。根据问题描述，这些是 $\\{B, V, I\\}$ 及其后代 $\\{Y, C\\}$。集合 $Z = \\{M, G\\}$ 不包含这些节点中的任何一个。条件1满足。\n\n2.  **条件2：$Z$ 阻断所有后门路径。**\n    -   所有以 $X \\leftarrow M$ 开始的路径都通过对 $M \\in Z$ 进行条件化而被阻断。\n    -   所有以 $X \\leftarrow G$ 开始的路径都通过对 $G \\in Z$ 进行条件化而被阻断。\n    -   路径 $X \\leftarrow U \\to C \\leftarrow Y$ 仍然被对撞节点 $C$ 阻断，因为 $C \\notin Z$。\n    因此，$Z=\\{M,G\\}$ 阻断了所有后门路径。条件2满足。\n\n由于两个条件都满足，$\\{M, G\\}$ 是一个充分调整集。\n\n3.  **最小性。**\n    -   子集 $\\{M\\}$ 是否充分？不，它未能阻断路径 $X \\leftarrow G \\to Y$。\n    -   子集 $\\{G\\}$ 是否充分？不，它未能阻断路径 $X \\leftarrow M \\to Y$。\n    由于 $\\{M, G\\}$ 的任何真子集都不是充分的，因此 $\\{M, G\\}$ 是一个最小充分调整集。\n\n现在，我们评估所提供的选项。\n\n**A. $\\{M, G\\}$**\n这个集合是如上所述推导出的最小充分调整集。\n结论：**正确**。\n\n**B. $\\{G, F, A, S\\}$**\n这个集合是不充分的。它不包含 $M$。因此，它未能阻断后门路径 $X \\leftarrow M \\to Y$。对一个混杂因子（$M$）的原因（$F,A,S$ 是 $M$ 的原因）进行条件化，并不能阻断由该混杂因子本身产生的混杂路径。\n结论：**不正确**。\n\n**C. $\\{M, G, I\\}$**\n这个集合包含 $I$（全身性炎症）。DAG 指定了一条路径 $X \\to I \\to Y$，意味着 $I$ 是 $X$ 对 $Y$ 因果效应的一个中介因子。它是 $X$ 的一个后代。为了识别*总*因果效应，对 $X$ 的后代进行条件化违反了后门准则的第一个条件。这会阻断我们意图测量的一部分因果效应。\n结论：**不正确**。\n\n**D. $\\{M, G, C\\}$**\n这个集合包含 $C$（门诊就诊情况）。如前所述，$C$ 是后门路径 $X \\leftarrow U \\to C \\leftarrow Y$ 上的一个对撞节点，其中 $U$ 是未测量的。对一个对撞节点进行条件化会打开该路径，从而在 $X$ 和 $Y$ 之间引入一种虚假的关联（对撞分层偏倚），由于 $U$ 未被测量，这种关联无法被阻断。因此，这不是一个有效的调整集。\n结论：**不正确**。\n\n**E. $\\{M, G, F, A, S\\}$**\n这个集合包含了充分集 $\\{M, G\\}$。额外的变量 $\\{F, A, S\\}$ 不是 $X$ 的后代。添加它们不会打开任何无法阻断的后门路径。因此，这个集合是充分的。但是，它不是最小的，因为其真子集 $\\{M, G\\}$ 也是充分的。问题明确要求的是*最小*充分集。\n结论：**不正确**。\n\n基于对后门准则的严格应用，代表一个有效的最小充分调整集的唯一选项是 $\\{M, G\\}$。", "answer": "$$\\boxed{A}$$", "id": "2897915"}, {"introduction": "将基础机理研究转化为有效的治疗策略，是转化医学的核心目标。在理解了肠-脑-免疫轴的关键分子（如丁酸）的作用机制及其因果关系之后，下一步便是量化其治疗潜力。本练习将让您扮演一位计算药理学家的角色，应用经典的药效学模型（Hill-Emax模型）和现代贝叶斯统计方法，为补充丁酸以抑制实验性自身免疫性脑脊髓炎（EAE）的临床症状这一治疗方案建立剂量-效应关系模型 [@problem_id:2897920]。这是一个真实的计算实践，旨在将理论知识与实验数据相结合，以评估和优化基于肠-脑-免疫轴的干预措施。", "problem": "考虑一个机制性药效学模型，该模型将肠道衍生的短链脂肪酸丁酸盐与调节性T细胞（Treg）扩增以及肠-脑-免疫轴内实验性自身免疫性脑脊髓炎（EAE）临床评分的抑制联系起来。使用以下基本原理：\n\n- 配体-受体相互作用的质量作用定律和协同结合导致的希尔型占据。\n- 将部分靶点结合率映射到效应的Emax药效学模型。\n- 重复测量获得的样本均值的加性高斯测量噪声。\n- 对数尺度下半数有效剂量（ED50）的弱信息先验。\n\n使用希尔系数为 $n_{\\mathrm{H}}$ 的希尔函数 $H(d)$ 来模拟在剂量 $d$ 下由Treg介导的部分结合率：\n$$\nH(d) \\equiv \\frac{d^{n_{\\mathrm{H}}}}{\\mathrm{ED50}^{\\,n_{\\mathrm{H}}} + d^{n_{\\mathrm{H}}}}.\n$$\n使用最大部分抑制率 $E_{\\max}$ 和基线评分 $y_0$ 将此结合率映射到预期的平均EAE临床评分 $y(d)$：\n$$\ny(d) \\equiv y_0 \\left(1 - E_{\\max}\\, H(d)\\right).\n$$\n假设在剂量 $d_i$ 下的观测值 $\\hat{y}_i$ 是样本均值，具有独立的、已知标准误差为 $s_i$ 的高斯噪声：\n$$\n\\hat{y}_i \\sim \\mathcal{N}\\!\\left(y(d_i), s_i^2\\right).\n$$\n对 $\\mathrm{ED50}$ 的自然对数施加一个正态先验：\n$$\n\\ln(\\mathrm{ED50}) \\sim \\mathcal{N}(\\mu, \\sigma^2).\n$$\n\n您的任务是，对于下述测试套件中的每个数据集，通过最大化后验密度（等效于最小化负对数后验）来计算 $\\mathrm{ED50}$ 的最大后验估计（MAP），优化变量为 $\\ln(\\mathrm{ED50})$。在所有情况中，使用 $y_0 = 3.0$、$E_{\\max} = 0.7$ 和 $n_{\\mathrm{H}} = 2$。所有剂量和最终的 $\\mathrm{ED50}$ 都必须以毫摩尔/千克（mmol/kg）为单位。报告每个 $\\mathrm{ED50}$，单位为 mmol/kg，四舍五入到小数点后4位。\n\n测试套件（三种情况）：\n\n- 情况A（信息丰富的宽剂量范围数据）：\n  - 剂量 $d_i$：$0.0$，$0.5$，$1.0$，$2.0$，$4.0$ (mmol/kg)。\n  - 观测平均分 $\\hat{y}_i$：$3.02$，$2.88$，$2.62$，$1.96$，$1.31$。\n  - 标准误差 $s_i$：$0.08$，$0.07$，$0.07$，$0.06$，$0.06$。\n  - 先验参数：$\\mu = \\ln(1.5)$，$\\sigma = 0.7$。\n\n- 情况B（弱效应的低剂量边缘情况）：\n  - 剂量 $d_i$：$0.0$，$0.25$，$0.5$ (mmol/kg)。\n  - 观测平均分 $\\hat{y}_i$：$3.01$，$2.98$，$2.95$。\n  - 标准误差 $s_i$：$0.09$，$0.09$，$0.09$。\n  - 先验参数：$\\mu = \\ln(1.0)$，$\\sigma = 0.3$。\n\n- 情况C（高剂量饱和数据）：\n  - 剂量 $d_i$：$2.0$，$4.0$，$8.0$ (mmol/kg)。\n  - 观测平均分 $\\hat{y}_i$：$2.17$，$1.49$，$1.09$。\n  - 标准误差 $s_i$：$0.05$，$0.05$，$0.05$。\n  - 先验参数：$\\mu = \\ln(3.0)$，$\\sigma = 0.5$。\n\n要求：\n\n- 通过将高斯观测值的负对数似然与 $\\ln(\\mathrm{ED50})$ 的负对数先验相加，将目标函数实现为给定数据集的负对数后验。\n- 对无约束参数 $z \\equiv \\ln(\\mathrm{ED50}) \\in \\mathbb{R}$ 进行优化，并通过 $\\mathrm{ED50} = e^{z}$ 进行反变换。\n- 必须确保在 $d_i = 0$ 和所有正剂量下数值的稳定性。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，[result1,result2,result3]）。\n- 该列表必须按顺序包含情况A、情况B和情况C的三个 $\\mathrm{ED50}$ 估计值，每个值均以 mmol/kg 为单位，并四舍五入到小数点后4位。", "solution": "问题陈述已经过仔细审查，并被确定为有效。这是一个在应用于药效学的贝叶斯统计建模领域中提法明确、有科学依据的问题。它是自洽的，所有必要的参数、数据和函数形式都已指定。不存在逻辑矛盾、事实不准确或含糊不清之处。因此，我们将着手进行正式求解。\n\n问题要求计算参数 $\\mathrm{ED50}$ 的最大后验（MAP）估计。MAP估计是后验分布的众数。根据贝叶斯定理，后验概率密度与似然和先验密度的乘积成正比：\n$$\np(\\mathrm{ED50} \\,|\\, \\text{data}) \\propto p(\\text{data} \\,|\\, \\mathrm{ED50}) \\cdot p(\\mathrm{ED50})\n$$\n最大化后验密度等同于最大化其对数，即对数后验。为了计算稳定性和简化优化，我们使用参数 $z \\equiv \\ln(\\mathrm{ED50})$，因此 $\\mathrm{ED50} = e^z$。无约束参数 $z$ 可以在 $\\mathbb{R}$ 中取任何值。任务是找到使对数后验密度最大化的 $z$ 值，然后将其转换回去以获得 $\\mathrm{ED50}$ 的MAP估计。\n\n对数后验是对数似然和对数先验之和。我们将通过取对数后验的负值来构建目标函数，因为优化程序通常是寻找最小值。\n\n1. **模型与似然**：在给定剂量 $d_i$ 下，预期EAE临床评分 $y(d_i)$ 的模型为：\n$$\ny(d_i) = y_0 \\left(1 - E_{\\max}\\, H(d_i)\\right)\n$$\n其中，部分靶点结合率 $H(d_i)$ 由希尔函数给出：\n$$\nH(d_i) = \\frac{d_i^{n_{\\mathrm{H}}}}{\\mathrm{ED50}^{\\,n_{\\mathrm{H}}} + d_i^{n_{\\mathrm{H}}}}\n$$\n问题指定了常数 $y_0 = 3.0$，$E_{\\max} = 0.7$ 和 $n_{\\mathrm{H}} = 2$。\n用优化参数 $z = \\ln(\\mathrm{ED50})$ 表示，预期评分为：\n$$\ny(d_i; z) = 3.0 \\left(1 - 0.7 \\frac{d_i^2}{e^{2z} + d_i^2}\\right)\n$$\n假设观测值 $\\hat{y}_i$ 来自正态分布 $\\mathcal{N}(y(d_i; z), s_i^2)$。对数似然函数，忽略不依赖于 $z$ 的常数，为：\n$$\n\\ln\\mathcal{L}(z) \\propto -\\frac{1}{2}\\sum_i \\frac{(\\hat{y}_i - y(d_i; z))^2}{s_i^2}\n$$\n\n2. **先验**：为 $z = \\ln(\\mathrm{ED50})$ 指定了正态先验：\n$$\nz \\sim \\mathcal{N}(\\mu, \\sigma^2)\n$$\n对数先验密度，同样忽略常数，为：\n$$\n\\ln p(z) \\propto -\\frac{(z - \\mu)^2}{2\\sigma^2}\n$$\n\n3. **用于最小化的目标函数**：负对数后验，即我们要最小化的目标函数 $J(z)$，是通过将对数似然和对数先验的负值项相加来构建的。我们可以省略常数因子 $\\frac{1}{2}$，因为它不影响最小值的位置：\n$$\nJ(z) = \\sum_i \\left(\\frac{\\hat{y}_i - y(d_i; z)}{s_i}\\right)^2 + \\left(\\frac{z - \\mu}{\\sigma}\\right)^2\n$$\n第一项代表来自数据的加权残差平方和，第二项是来自先验分布的惩罚项。\n\n4. **数值优化**：对于三个测试用例中的每一个，我们实现目标函数 $J(z)$，并使用数值优化算法找到使其最小化的值 $z_{\\mathrm{MAP}}$。先验均值 $\\mu$ 为优化过程提供了一个合适的初始猜测值。一旦找到 $z_{\\mathrm{MAP}}$，通过反变换计算 $\\mathrm{ED50}$ 的MAP估计：\n$$\n\\mathrm{ED50}_{\\mathrm{MAP}} = e^{z_{\\mathrm{MAP}}}\n$$\n此过程应用于每个数据集。每个情况的最终结果按要求四舍五入到小数点后4位。实现将使用 `scipy.optimize.minimize` 来执行数值最小化。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Computes the MAP estimate for ED50 for three different pharmacodynamic datasets.\n\n    The solution involves minimizing the negative log-posterior of a Bayesian model.\n    The model relates drug dose to a clinical score via a Hill-Emax function.\n    The parameter of interest is ED50, and the optimization is performed on its\n    natural logarithm, z = ln(ED50).\n    \"\"\"\n\n    # Define fixed model parameters as specified in the problem statement\n    Y0 = 3.0\n    EMAX = 0.7\n    NH = 2.0\n\n    def negative_log_posterior(z, d, y_obs, s, mu, sigma):\n        \"\"\"\n        Computes the negative log-posterior (proportional to sum of squares).\n\n        This is the objective function for the optimizer. It is composed of the\n        sum of squared weighted residuals (from the Gaussian likelihood) and a\n        regularization term (from the Gaussian prior on z).\n\n        Args:\n            z (float): The current estimate for ln(ED50).\n            d (np.ndarray): Array of doses.\n            y_obs (np.ndarray): Array of observed mean scores.\n            s (np.ndarray): Array of standard errors for the scores.\n            mu (float): The mean of the Normal prior on z.\n            sigma (float): The standard deviation of the Normal prior on z.\n\n        Returns:\n            float: The value of the negative log-posterior (up to a constant).\n        \"\"\"\n        # Calculate model-predicted scores based on the current z = ln(ED50)\n        d_pow_nH = np.power(d, NH)\n        ed50_pow_nH = np.exp(z * NH)\n\n        # The denominator is always positive. For d=0, H=0.\n        denominator = ed50_pow_nH + d_pow_nH\n        H = np.divide(d_pow_nH, denominator, out=np.zeros_like(d_pow_nH, dtype=float), where=denominator != 0)\n\n        y_model = Y0 * (1.0 - EMAX * H)\n\n        # Calculate the sum of squared weighted residuals (likelihood term)\n        likelihood_term = np.sum(((y_obs - y_model) / s)**2)\n\n        # Calculate the prior term\n        prior_term = ((z - mu) / sigma)**2\n\n        return likelihood_term + prior_term\n\n    # Test suite containing the data for all three cases\n    test_cases = [\n        # Case A: Informative wide-dose data\n        {\n            \"d\": np.array([0.0, 0.5, 1.0, 2.0, 4.0]),\n            \"y_obs\": np.array([3.02, 2.88, 2.62, 1.96, 1.31]),\n            \"s\": np.array([0.08, 0.07, 0.07, 0.06, 0.06]),\n            \"prior_mu\": np.log(1.5),\n            \"prior_sigma\": 0.7\n        },\n        # Case B: Low-dose edge case with weak effect\n        {\n            \"d\": np.array([0.0, 0.25, 0.5]),\n            \"y_obs\": np.array([3.01, 2.98, 2.95]),\n            \"s\": np.array([0.09, 0.09, 0.09]),\n            \"prior_mu\": np.log(1.0),\n            \"prior_sigma\": 0.3\n        },\n        # Case C: High-dose saturation data\n        {\n            \"d\": np.array([2.0, 4.0, 8.0]),\n            \"y_obs\": np.array([2.17, 1.49, 1.09]),\n            \"s\": np.array([0.05, 0.05, 0.05]),\n            \"prior_mu\": np.log(3.0),\n            \"prior_sigma\": 0.5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Use the prior mean as the initial guess for the optimization\n        z0 = case[\"prior_mu\"]\n        \n        # Package the data for the current case to pass to the optimizer\n        args = (case[\"d\"], case[\"y_obs\"], case[\"s\"], case[\"prior_mu\"], case[\"prior_sigma\"])\n        \n        # Run the numerical optimization to find z_MAP\n        opt_result = minimize(\n            negative_log_posterior,\n            x0=z0,\n            args=args,\n            method='L-BFGS-B'  # A robust quasi-Newton method\n        )\n        \n        z_map = opt_result.x[0]\n        \n        # Back-transform to get ED50_MAP and round as required\n        ed50_map = np.exp(z_map)\n        results.append(round(ed50_map, 4))\n        \n    # Print the final list of results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2897920"}]}