{"hands_on_practices": [{"introduction": "病毒载体疫苗的有效性始于其在细胞层面的成功递送。本练习旨在阐明一个核心药代动力学和药效学参数：感染复数（MOI）。通过从基本原理推导和计算MOI，您将掌握如何将宏观的给药剂量与微观的细胞转导事件联系起来，这是设计和解释病毒载体实验的关键一步[@problem_id:2905507]。", "problem": "将一种非复制型腺病毒载体疫苗注入一个充分混合的组织隔室中。假设以下基本事实：(i) 感染复数 (MOI) 定义为递送至每个靶细胞的预期感染性病毒颗粒数，(ii) 如果颗粒-细胞相遇是独立且稀少的事件，则任何给定细胞接收到的感染性颗粒数量可以很好地用泊松分布来建模，其均值参数等于MOI，以及 (iii) 靶细胞总数等于组织体积與靶细胞密度的乘积。设施用剂量为 $D$ 个物理颗粒，其中一部分比例 $\\epsilon$ 的颗粒有效到达并成功进入靶细胞，组织体积为 $V$，靶细胞密度为 $\\rho$。\n\n1. 从这些原则出发，推导预期 MOI（记为 $\\lambda$）作为 $D$、$\\epsilon$、$V$ 和 $\\rho$ 的函数的表达式。\n2. 使用您推导的表达式，计算当 $D = 1.2 \\times 10^{10}$ 个物理颗粒，$\\epsilon = 0.04$，$V = 0.90\\,\\mathrm{mL}$，以及 $\\rho = 1.40 \\times 10^{8}\\,\\mathrm{cells/mL}$ 时 $\\lambda$ 的数值。\n\n将 $\\lambda$ 的最终结果表示为一个无量纲数，并四舍五入至三位有效数字。", "solution": "所述问题已经过验证，被认定为具有科学依据、问题表述清晰、客观且自洽。其中不包含逻辑矛盾、不科学的前提或定义不清的术语。因此，该问题被视为有效，并将提供严谨的解答。\n\n主要任务是推导感染复数（记为 $\\lambda$）的表达式，并随后计算其数值。\n\n第1部分：推导 $\\lambda$ 的表达式。\n\n感染复数 (MOI) 定义为递送至每个靶细胞的预期感染性病毒颗粒数。这可以表示为一个比率：\n$$\n\\lambda = \\frac{\\text{有效感染性颗粒总数}}{\\text{靶细胞总数}}\n$$\n让我们将有效感染性颗粒总数记为 $N_{\\text{inf}}$，靶细胞总数记为 $N_{\\text{cell}}$。因此，$\\lambda$ 的表达式为：\n$$\n\\lambda = \\frac{N_{\\text{inf}}}{N_{\\text{cell}}}\n$$\n我们现在必须根据给定参数推导分子和分母的表达式。\n\n分子 $N_{\\text{inf}}$ 是成功感染靶细胞的病毒颗粒数量。问题陈述，总共施用了 $D$ 个物理颗粒的剂量，其中一部分比例 $\\epsilon$ 的颗粒有效到达并成功进入靶细胞。因此，有效感染性颗粒的总数是总剂量与该有效比例的乘积：\n$$\nN_{\\text{inf}} = \\epsilon D\n$$\n分母 $N_{\\text{cell}}$ 是组织隔室中靶细胞的总数。问题给出，靶细胞总数是组织体积 $V$ 和靶细胞密度 $\\rho$ 的乘积。因此：\n$$\nN_{\\text{cell}} = \\rho V\n$$\n将 $N_{\\text{inf}}$ 和 $N_{\\text{cell}}$ 的表达式代入 $\\lambda$ 的方程，我们得到感染复数的一般表达式：\n$$\n\\lambda = \\frac{\\epsilon D}{\\rho V}\n$$\n该表达式代表了泊松分布的均值，该分布用于模拟任何给定细胞接收到的感染性颗粒数量，这与问题陈述一致。问题的第一部分到此结束。\n\n第2部分：$\\lambda$ 的数值计算。\n\n我们已知以下参数的数值：\n-   施用剂量, $D = 1.2 \\times 10^{10}$ 个物理颗粒。\n-   有效比例, $\\epsilon = 0.04$ (无量纲)。\n-   组织体积, $V = 0.90\\,\\mathrm{mL}$。\n-   靶细胞密度, $\\rho = 1.40 \\times 10^{8}\\,\\mathrm{cells/mL}$。\n\n我们将这些值代入我们推导出的 $\\lambda$ 表达式中：\n$$\n\\lambda = \\frac{(0.04) \\times (1.2 \\times 10^{10})}{(1.40 \\times 10^{8}\\,\\mathrm{cells/mL}) \\times (0.90\\,\\mathrm{mL})}\n$$\n首先，让我们分别计算分子和分母。\n分子是：\n$$\nN_{\\text{inf}} = 0.04 \\times 1.2 \\times 10^{10} = 0.048 \\times 10^{10} = 4.8 \\times 10^{8} \\text{ particles}\n$$\n分母是：\n$$\nN_{\\text{cell}} = 1.40 \\times 10^{8}\\,\\mathrm{cells/mL} \\times 0.90\\,\\mathrm{mL} = 1.26 \\times 10^{8} \\text{ cells}\n$$\n现在，我们计算比率：\n$$\n\\lambda = \\frac{4.8 \\times 10^{8}}{1.26 \\times 10^{8}}\n$$\n分子和分母中的因子 $10^{8}$ 相互抵消：\n$$\n\\lambda = \\frac{4.8}{1.26} \\approx 3.8095238...\n$$\n问题要求将结果四舍五入至三位有效数字。前三位有效数字是 $3$、$8$ 和 $0$。第四位数字是 $9$，大于或等于 $5$，所以我们必须将第三位有效数字向上取整。\n$$\n\\lambda \\approx 3.81\n$$\n$\\lambda$ 的结果是一个无量纲量，代表每个细胞的平均感染颗粒数，这与其定义一致。", "answer": "$$\\boxed{3.81}$$", "id": "2905507"}, {"introduction": "有效的病毒载体设计是一个在生物学功能与物理限制之间取得平衡的工程挑战。本练习聚焦于腺相关病毒（AAV）载体的一个关键瓶颈——有限的包装容量。您将通过计算评估一个大型转基因表达盒的可行性，并探索一种先进的解决方案，即多载体策略，以克服这一限制[@problem_id:2905454]。", "problem": "腺相关病毒 (AAV) 载体受到有限包装容量的限制，该容量包含反向末端重复序列 (ITR)。在这个基于AAV的病毒载体疫苗平台的设计练习中，您的任务是评估包装一个大型抗原表达盒的可行性，如果无法容纳，则评估一种基于多载体策略的、概念上合理的替代方案。\n\n使用以下基本且公认的事实：\n- 腺相关病毒 (AAV) 的实际基因组包装上限为$4.7$ kb，此大小包括两个反向末端重复序列 (ITR)。\n- 每个反向末端重复序列 (ITR) 的长度为$0.145$ kb。\n- 表达盒由一个启动子、一个编码序列和一个多聚腺苷酸化信号组成。\n- 基于同源重组 (HR) 的双载体或多载体AAV策略需要相邻载体之间有重叠区域，以便在转导的细胞中重构全长表达盒。\n\n给定一个总长为$6.5$ kb的初始表达盒，由一个$1.2$ kb的启动子、一个$4.9$ kb的编码序列和一个$0.4$ kb的多聚腺苷酸化信号组成。您可以在不改变编码序列的情况下，将启动子小型化至$0.3$ kb，将多聚腺苷酸化信号小型化至$0.1$ kb。请考虑以下设计路径：\n\n1. 从$4.7$ kb的AAV上限包含两个ITR这一事实出发，推导出ITR之间可用于表达盒的最大长度。以千碱基为单位说明此限制。\n2. 确定小型化的单载体设计（启动子$0.3$ kb、编码序列$4.9$ kb、多聚腺苷酸化信号$0.1$ kb）在第1部分的约束下是否能容纳在ITR之间。如果不能容纳，请通过第一性原理计算理论上需要多长的启动子才能容纳，并仅通过比较长度来评论其可行性。\n3. 作为一种概念上合理的替代方案，考虑一种N-载体同源重组策略，其中：\n   - 只有第一个载体携带启动子，只有最后一个载体携带多聚腺苷酸化信号，编码序列被分割到所有$N$个载体中。\n   - 每对相邻的载体共享一个$0.4$ kb的同源重叠区，该重叠区存在于在该连接点相遇的两个载体中。\n   - 所有载体都必须独立地满足第1部分中推导出的ITR之间的容量限制。\n\n从这些约束出发，推导每个载体ITR间内容物最大值的最小可能值的表达式，该表达式是$N$、启动子长度$p$、编码长度$c$、多聚腺苷酸化信号长度$a$和重叠长度$o$的函数。然后，使用$p=0.3$ kb、$c=4.9$ kb、$a=0.1$ kb和$o=0.4$ kb，确定使N-载体设计在第1部分的AAV容量限制下可行的最小整数$N$。最终答案为这个最小的$N$值，不带单位。除了选择满足约束的最小整数外，不需要进行四舍五入。", "solution": "首先必须对所述问题进行严格验证。\n\n## 问题验证\n\n### 步骤1：提取给定条件\n问题陈述中提供的明确数据和条件如下：\n- `腺相关病毒 (AAV) 的实际基因组包装上限为$4.7$ kb，此大小包括两个反向末端重复序列 (ITR)。`\n- `每个反向末端重复序列 (ITR) 的长度为$0.145$ kb。`\n- `表达盒由一个启动子、一个编码序列和一个多聚腺苷酸化信号组成。`\n- `基于同源重组 (HR) 的双载体或多载体AAV策略需要相邻载体之间有重叠区域，以便在转导的细胞中重构全长表达盒。`\n- `初始表达盒总长为$6.5$ kb，由一个$1.2$ kb的启动子、一个$4.9$ kb的编码序列和一个$0.4$ kb的多聚腺苷酸化信号组成。`\n- `小型化启动子长度 ($p$)：$0.3$ kb。`\n- `小型化编码序列长度 ($c$)：$4.9$ kb（未改变）。`\n- `小型化多聚腺苷酸化信号长度 ($a$)：$0.1$ kb。`\n- `同源重叠区长度 ($o$)：$0.4$ kb。`\n- 对于N-载体策略：\n    - `只有第一个载体携带启动子，只有最后一个载体携带多聚腺苷酸化信号，编码序列被分割到所有$N$个载体中。`\n    - `每对相邻的载体共享一个$0.4$ kb的同源重叠区，该重叠区存在于在该连接点相遇的两个载体中。`\n    - `所有载体都必须独立地满足ITR之间的容量限制。`\n\n### 步骤2：使用提取的给定条件进行验证\n根据所需标准对问题进行评估：\n- **科学依据：** 该问题基于分子病毒学和基因治疗的既定原则，特别是关于AAV载体的设计。指定的包装容量、ITR大小、表达盒组分和多载体策略都是该领域的标准概念。数值是符合实际的。该问题明确属于公认的STEM学科范畴。\n- **适定性：** 该问题被构建为一系列逻辑上相互关联的任务。每个部分都要求根据所提供的数据计算一个特定的、可计算的量。可以获得唯一解。\n- **客观性：** 语言技术性强、精确，没有主观或模糊的术语。\n\n该问题不存在任何使其无效的缺陷。它科学合理、可形式化、内部一致且结构良好。\n\n### 步骤3：结论与行动\n问题**有效**。将提供一个合理的解决方案。\n\n## 解\n\n解答将按顺序处理问题的每个部分。\n\n**第1部分：最大表达盒长度**\nAAV病毒粒子的总包装容量 $L_{total}$ 给定为 $4.7$ kb。此上限包括两个反向末端重复序列 (ITR)。单个ITR的长度 $L_{ITR}$ 为 $0.145$ kb。可用于表达盒的空间是两个ITR之间的区域。因此，表达盒的最大允许长度 $L_{cassette,max}$ 是总容量减去两个ITR的长度。\n$$L_{cassette,max} = L_{total} - 2 \\times L_{ITR}$$\n代入给定值：\n$$L_{cassette,max} = 4.7~\\text{kb} - 2 \\times 0.145~\\text{kb} = 4.7~\\text{kb} - 0.29~\\text{kb} = 4.41~\\text{kb}$$\n这是包装在AAV ITR之间的任何遗传物质的绝对上限。\n\n**第2部分：小型化单载体设计的可行性**\n小型化的表达盒由一个长度为 $p = 0.3$ kb 的启动子、一个长度为 $c = 4.9$ kb 的编码序列和一个长度为 $a = 0.1$ kb 的多聚腺苷酸化信号组成。这个小型化表达盒的总长度 $L_{cassette,mini}$ 是其各组分之和：\n$$L_{cassette,mini} = p + c + a = 0.3~\\text{kb} + 4.9~\\text{kb} + 0.1~\\text{kb} = 5.3~\\text{kb}$$\n为了确定该设计是否可行，我们将其总长度与第1部分中推导出的最大容量进行比较：\n$$L_{cassette,mini} = 5.3~\\text{kb} > L_{cassette,max} = 4.41~\\text{kb}$$\n小型化表达盒超过了包装容量。因此，这种单载体设计是不可行的。\n\n为了找到使设计能够容纳所需的理论启动子长度 $p_{req}$，我们将总表达盒长度设定为至多等于最大容量，同时保持编码序列和多聚腺苷酸化信号的长度不变：\n$$p_{req} + c + a \\le L_{cassette,max}$$\n$$p_{req} + 4.9~\\text{kb} + 0.1~\\text{kb} \\le 4.41~\\text{kb}$$\n$$p_{req} + 5.0~\\text{kb} \\le 4.41~\\text{kb}$$\n$$p_{req} \\le 4.41~\\text{kb} - 5.0~\\text{kb}$$\n$$p_{req} \\le -0.59~\\text{kb}$$\n物理长度不能为负。这个结果在科学上是荒谬的，并证实了不可能将 $4.9$ kb 的编码序列连同任何功能性启动子和多聚腺苷酸化信号装入单个AAV载体中，即使它们的长度为零也不行。\n\n**第3部分：N-载体策略的最小N值**\n在一个N-载体策略中，总编码序列 $c$ 由 $N$ 个独立的载体重构而成。设编码序列的独特、非重叠部分表示为 $c'_1, c'_2, \\dots, c'_N$，使得它们的总长度为 $\\sum_{i=1}^N |c'_i| = c$。\n问题规定，相邻载体中存在一个长度为 $o$ 的重叠区域以促进同源重组。这导致每个载体的有效载荷具有特定的结构。\n\n-   **载体1：** 包含启动子、第一个独特的编码片段和一个重叠区域。其有效载荷长度为 $l_1 = p + |c'_1| + o$。\n-   **载体 $i$ ($1  i  N$)：** 中间载体必须在其5'端有一个重叠区域以便与载体 $i-1$ 重组，并在其3'端有另一个重叠区域以便与载体 $i+1$ 重组。其有效载荷包含一个独特的编码片段，两侧各有一个重叠区域。其长度为 $l_i = o + |c'_i| + o = 2o + |c'_i|$。\n-   **载体 $N$：** 包含最后一个重叠区域、最后一个独特的编码片段和多聚腺苷酸化信号。其有效载荷长度为 $l_N = o + |c'_N| + a$。\n\n这些长度 $l_i$ 中的每一个都必须小于或等于最大容量, $l_i \\le L_{cassette,max}$。\n\n为了找到每个载体内容物最大值的最小可能值，我们必须以一种平衡所有载体负载的方式来分割编码序列。使最大负载最小化的最优分布是所有负载均相等，即 $l_1 = l_2 = \\dots = l_N = L$。由此，我们可以用这个平衡负载 $L$ 来表示独特编码片段的长度：\n-   $|c'_1| = L - p - o$\n-   $|c'_i| = L - 2o$  对于 $1  i  N$\n-   $|c'_N| = L - o - a$\n\n这些长度之和必须等于总编码序列长度 $c$：\n$$c = \\sum_{i=1}^N |c'_i| = (L - p - o) + (N-2)(L - 2o) + (L - o - a)$$\n我们求解 $L$：\n$$c = L - p - o + (N-2)L - 2(N-2)o + L - o - a$$\n$$c = (1 + N-2 + 1)L - p - a - (o + 2(N-2)o + o)$$\n$$c = NL - p - a - (2o + 2No - 4o)$$\n$$c = NL - p - a - (2No - 2o)$$\n$$c = NL - p - a - 2o(N-1)$$\n$$NL = p + c + a + 2o(N-1)$$\n$$L = \\frac{p + c + a + 2o(N-1)}{N}$$\n这个 $L$ 的表达式是 $N$ 的函数，并代表了每个载体内容物最大值的最小可能值。\n\n要使设计可行，这个平衡负载 $L$ 不得超过包装容量 $L_{cassette,max}$：\n$$L \\le L_{cassette,max}$$\n$$\\frac{p + c + a + 2o(N-1)}{N} \\le L_{cassette,max}$$\n代入给定值 ($p=0.3$, $c=4.9$, $a=0.1$, $o=0.4$, $L_{cassette,max}=4.41$)：\n$$\\frac{0.3 + 4.9 + 0.1 + 2(0.4)(N-1)}{N} \\le 4.41$$\n$$\\frac{5.3 + 0.8(N-1)}{N} \\le 4.41$$\n$$\\frac{5.3 + 0.8N - 0.8}{N} \\le 4.41$$\n$$\\frac{4.5 + 0.8N}{N} \\le 4.41$$\n由于 $N$ 必须是正整数，我们可以两边同乘以 $N$：\n$$4.5 + 0.8N \\le 4.41N$$\n$$4.5 \\le 4.41N - 0.8N$$\n$$4.5 \\le 3.61N$$\n$$N \\ge \\frac{4.5}{3.61} \\approx 1.2465$$\n由于载体数量 $N$ 必须是整数，满足此条件的最小整数 $N$ 值为 $2$。", "answer": "$$\\boxed{2}$$", "id": "2905454"}, {"introduction": "疫苗接种的最终目标是诱导持久且有效的免疫应答。本高级练习将指导您建立一个计算模型，以模拟CD$8^{+}$ T细胞在接种病毒载体疫苗后的克隆扩增动力学。通过该模型，您将能够定量探究抗原呈递、先天免疫信号等多种生物学因素如何协同作用，共同决定适应性免疫应答的强度，从而深化对疫苗作用机制的理解[@problem_id:2905494]。", "problem": "要求您形式化一个简约的、基于机理的模型，用于描述在用水疱性口炎病毒（VSV）载体免疫后，分化簇$8$阳性（CD$8^{+}$）T细胞的克隆扩增，并实现一个程序来计算蛋白酶体抑制对扩增幅度的影响，同时明确纳入由先天性信号传导改变引起的潜在混杂因素。建模应从核心免疫学原理开始：(i) 由T细胞受体刺激驱动的抗原依赖性克隆扩增需要通过主要组织相容性复合体I类（MHC I）呈递抗原肽，而这是蛋白酶体依赖性的；(ii) 由先天性免疫激活（例如，由活化B细胞的核因子κ-轻链增强子（NF-$\\kappa$B）和I型干扰素驱动的树突状细胞成熟）提供的共刺激会调节有效刺激率；以及(iii) 活化的T细胞会经历死亡，而这种死亡可被炎性微环境调节。随着复制控制和清除，载体抗原的可用性会随时间衰减。\n\n假设抗原特异性CD$8^{+}$ T细胞群体大小$N(t)$采用均匀混合区室模型，其中时间$t$以天为单位。应强制执行以下建模约束：\n- 抗原呈递振幅呈指数衰减，即$A(t) = A_{0}\\,\\exp(-k_{a}\\,t)$，其中$A_{0}$是初始抗原呈递振幅，$k_{a}$是抗原衰减率。蛋白酶体抑制以效率因子$p \\in [0,1]$降低表位生成，因此有效呈递为$A_{\\text{eff}}(t) = p\\,A(t)$。\n- 来自先天性信号的共刺激以因子$i \\in [0,1]$线性调节刺激，其中$i=1$代表基线未受扰动的先天性信号，而$i=0$代表完全废除。设$s_{0}$为基线刺激比例常数；则瞬时人均刺激率为$k_{\\text{stim}}(t) = s_{0}\\,i\\,A_{\\text{eff}}(t)$。\n- 当先天性炎性信号减少时，活化T细胞的人均死亡率会降低。设$d_{0}$为$i = 1$时的基线死亡率。假设在完全先天性抑制下可达到的最低死亡率是$d_{0}$的一个固定分数$\\alpha \\in (0,1)$，并且死亡率在这些极端之间线性依赖于$i$：$k_{\\text{death}}(i) = d_{0}\\,\\big(\\alpha + (1-\\alpha)\\,i\\big)$。这捕捉到了一个混杂效应，即先天性激活减少可以通过降低活化诱导性死亡来部分抵消刺激减少的影响。\n- 克隆动力学遵循质量作用人均速率法则：$\\dfrac{dN}{dt} = \\big(k_{\\text{stim}}(t) - k_{\\text{death}}(i)\\big)\\,N(t)$，初始条件为$N(0) = N_{0}$。\n\n您的任务是：\n- 使用显式格式（如前向欧拉法），以固定的时间步长$\\Delta t$在时间窗口$t \\in [0,T_{\\text{end}}]$上对上述系统进行数值积分。在模拟窗口内确定克隆群体峰值$N_{\\max}$。\n- 对于一组改变蛋白酶体效率$p$、先天性信号因子$i$以及在一个案例中改变抗原衰减率$k_{a}$的案例，计算每个案例中峰值群体相对于基线对照案例的比率。比率为无量纲，并且必须以小数形式报告（不得使用百分号）。\n- 除非在案例中另有说明，否则所有案例均使用以下全局固定参数：$N_{0} = 1.0$，$A_{0} = 1.0$，$k_{a} = 0.7$（单位：天$^{-1}$），$s_{0} = 1.5$（单位：天$^{-1}$每单位标准化抗原），$d_{0} = 0.4$（单位：天$^{-1}$），$\\alpha = 0.6$（无单位），$T_{\\text{end}} = 14.0$（单位：天），以及$\\Delta t = 0.01$（单位：天）。所有数字均为标准十进制表示法。\n- 用于评估您实现的测试套件。对于每个案例，元组为$(p, i, k_{a})$，其中仅当$k_{a}$与默认值不同时才列出；否则使用默认值：\n    - 案例$1$（基线对照）：$(p = 1.0, i = 1.0)$。\n    - 案例$2$（中度蛋白酶体抑制）：$(p = 0.5, i = 1.0)$。\n    - 案例$3$（重度蛋白酶体抑制）：$(p = 0.2, i = 1.0)$。\n    - 案例$4$（中度蛋白酶体抑制伴轻度先天性信号降低）：$(p = 0.5, i = 0.7)$。\n    - 案例$5$（中度蛋白酶体抑制伴重度先天性信号降低）：$(p = 0.5, i = 0.3)$。\n    - 案例$6$（完全蛋白酶体阻断）：$(p = 0.0, i = 1.0)$。\n    - 案例$7$（无蛋白酶体抑制但先天性信号被废除）：$(p = 1.0, i = 0.0)$。\n    - 案例$8$（中度蛋白酶体抑制、轻度先天性信号降低、较慢的抗原衰减）：$(p = 0.5, i = 0.7, k_{a} = 0.3)$。\n- 输出规范：您的程序应生成单行输出，其中包含案例$1$到$8$的峰值比率，按顺序排列，格式为方括号括起来的逗号分隔列表，每个比率四舍五入到小数点后六位（例如，$[1.000000,0.652314,\\dots]$）。不应打印任何其他文本。\n\n在适用的情况下，时间以天为单位。所要求的输出是无量纲比率，必须以小数表示。数值积分步长必须足够小，以确保在给定参数下数值的稳定性和收敛性。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于已确立的免疫学原理，在数学上作为一个具有确定初始值的一阶线性常微分方程是适定的，并提供了一套完整且一致的参数和条件。没有事实错误、歧义或逻辑矛盾。该任务是计算建模中的一个标准练习。\n\n问题的核心是模拟疫苗接种后抗原特异性CD$8^{+}$ T细胞的群体动力学$N(t)$。该动力学由人均速率法则描述：\n$$\n\\frac{dN}{dt} = \\left( k_{\\text{stim}}(t) - k_{\\text{death}}(i) \\right) N(t)\n$$\n这个方程表示由T细胞受体刺激驱动的增殖和细胞死亡的净效应。初始群体给定为$N(0) = N_0$。\n\n刺激率$k_{\\text{stim}}(t)$取决于抗原呈递和共刺激。有效抗原呈递$A_{\\text{eff}}(t)$被建模为一个反映抗原清除的衰减指数函数，并由一个蛋白酶体抑制因子$p \\in [0,1]$进行调节：\n$$\nA_{\\text{eff}}(t) = p \\cdot A_0 \\exp(-k_a t)\n$$\n这里，$A_0$是初始抗原振幅，$k_a$是抗原衰减率。刺激率进一步由一个共刺激因子$i \\in [0,1]$进行缩放，该因子代表先天性免疫激活的水平，以及一个基线常数$s_0$：\n$$\nk_{\\text{stim}}(t) = s_0 \\cdot i \\cdot A_{\\text{eff}}(t) = s_0 i p A_0 \\exp(-k_a t)\n$$\n此公式正确地捕捉了T细胞激活需要抗原和共刺激两个条件的原理。\n\n人均死亡率$k_{\\text{death}}(i)$包含了一个混杂效应，即先天性炎症减少（较低的$i$）可以增加T细胞的存活率。这被建模为$i$的线性函数：\n$$\nk_{\\text{death}}(i) = d_0 \\left( \\alpha + (1-\\alpha)i \\right)\n$$\n其中$d_0$是$i=1$时的基线死亡率，$\\alpha d_0$是$i=0$时的最低死亡率。\n\n该系统的完整微分方程是：\n$$\n\\frac{dN}{dt} = \\left[ s_0 i p A_0 \\exp(-k_a t) - d_0 \\left( \\alpha + (1-\\alpha)i \\right) \\right] N(t)\n$$\n问题要求在时间区间$t \\in [0, T_{\\text{end}}]$（其中$T_{\\text{end}} = 14.0$天）上，使用前向欧拉法和固定的时间步长$\\Delta t = 0.01$天，对这个初值问题进行数值求解。\n\n将时间离散化为$t_j = j \\Delta t$，前向欧拉格式根据第$j$步的状态来近似第$j+1$步的群体：\n$$\nN_{j+1} \\approx N_j + \\Delta t \\cdot \\left. \\frac{dN}{dt} \\right|_{t=t_j, N=N_j}\n$$\n代入控制方程，得到数值实现的迭代更新规则：\n$$\nN_{j+1} = N_j \\left( 1 + \\Delta t \\left[ s_0 i p A_0 \\exp(-k_a t_j) - d_0 \\left( \\alpha + (1-\\alpha)i \\right) \\right] \\right)\n$$\n计算过程如下。我们使用全局固定参数：$N_0 = 1.0$，$A_0 = 1.0$，默认$k_a = 0.7 \\text{ 天}^{-1}$，$s_0 = 1.5 \\text{ 天}^{-1}$，$d_0 = 0.4 \\text{ 天}^{-1}$，以及$\\alpha = 0.6$。\n\n对于每个由参数元组$(p, i, k_a)$定义的指定测试案例，从$N_0$开始应用迭代更新规则执行模拟，直到$t = T_{\\text{end}}$。从得到的群体轨迹$N(t)$中，确定峰值克隆群体大小，$N_{\\max} = \\max_{t \\in [0, T_{\\text{end}}]} N(t)$。\n\n首先，为基线对照案例（案例1：$p=1.0$, $i=1.0$）运行模拟，以确定参考峰值群体$N_{\\max, \\text{control}}$。随后，对八个案例中的每一个，使用其特定参数进行模拟，以找到相应的峰值群体$N_{\\max, \\text{case}}$。每个案例最终所需的输出是无量纲比率$R = N_{\\max, \\text{case}} / N_{\\max, \\text{control}}$。该比率量化了蛋白酶体抑制和改变的先天性信号对T细胞应答幅度的相对影响。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the peak CD8+ T cell population ratio for several scenarios\n    by numerically solving a system of ordinary differential equations.\n    \"\"\"\n\n    # Globally fixed parameters as per the problem description.\n    N0 = 1.0\n    A0 = 1.0\n    DEFAULT_KA = 0.7  # day^-1\n    S0 = 1.5          # day^-1 per unit of normalized antigen\n    D0 = 0.4          # day^-1\n    ALPHA = 0.6       # unitless\n    T_END = 14.0      # days\n    DT = 0.01         # days\n\n    def simulate(p, i, k_a):\n        \"\"\"\n        Numerically integrates the T cell population dynamics using forward Euler\n        and returns the peak population size.\n\n        Args:\n            p (float): Proteasome efficiency factor [0, 1].\n            i (float): Innate signaling factor [0, 1].\n            k_a (float): Antigen decay rate (day^-1).\n\n        Returns:\n            float: The maximum T cell population size over the simulation.\n        \"\"\"\n        num_steps = int(T_END / DT)\n        t_values = np.linspace(0, T_END, num_steps + 1)\n        n_values = np.zeros(num_steps + 1)\n        n_values[0] = N0\n\n        # Pre-calculate the constant death rate for the simulation\n        k_death = D0 * (ALPHA + (1 - ALPHA) * i)\n\n        for j in range(num_steps):\n            t_j = t_values[j]\n            n_j = n_values[j]\n\n            # Calculate time-dependent stimulation rate\n            a_eff = p * A0 * np.exp(-k_a * t_j)\n            k_stim = S0 * i * a_eff\n\n            # Net per-capita growth rate\n            net_rate = k_stim - k_death\n\n            # Forward Euler update step\n            n_values[j+1] = n_j * (1 + DT * net_rate)\n\n            # A guard against non-physical negative populations, although\n            # unlikely for the given parameter ranges.\n            if n_values[j+1]  0:\n                n_values[j+1] = 0.0\n\n        return np.max(n_values)\n\n    # Test suite from the problem statement.\n    # Format: (p, i, k_a) where k_a is optional and defaults to DEFAULT_KA.\n    test_cases_spec = [\n        (1.0, 1.0),         # Case 1 (baseline control)\n        (0.5, 1.0),         # Case 2 (moderate proteasome inhibition)\n        (0.2, 1.0),         # Case 3 (severe proteasome inhibition)\n        (0.5, 0.7),         # Case 4 (moderate PI with mild innate reduction)\n        (0.5, 0.3),         # Case 5 (moderate PI with strong innate reduction)\n        (0.0, 1.0),         # Case 6 (complete proteasome blockade)\n        (1.0, 0.0),         # Case 7 (innate signaling abrogated, no PI)\n        (0.5, 0.7, 0.3),    # Case 8 (as Case 4, but slower antigen decay)\n    ]\n\n    # Process specifications into full (p, i, k_a) tuples for simulation.\n    test_cases = []\n    for case in test_cases_spec:\n        if len(case) == 2:\n            test_cases.append((case[0], case[1], DEFAULT_KA))\n        else:\n            test_cases.append(case)\n\n    # Calculate the peak population for the baseline control case (Case 1).\n    p_baseline, i_baseline, ka_baseline = test_cases[0]\n    n_max_baseline = simulate(p_baseline, i_baseline, ka_baseline)\n\n    ratios = []\n    for p, i, k_a in test_cases:\n        n_max_case = simulate(p, i, k_a)\n        if n_max_baseline > 0:\n            ratio = n_max_case / n_max_baseline\n        else: # Avoid division by zero, though baseline max should be > 1.0\n            ratio = 0.0 if n_max_case > 0 else 1.0\n        ratios.append(f\"{ratio:.6f}\") # Format to exactly six decimal places.\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(ratios)}]\")\n\nsolve()\n```", "id": "2905494"}]}