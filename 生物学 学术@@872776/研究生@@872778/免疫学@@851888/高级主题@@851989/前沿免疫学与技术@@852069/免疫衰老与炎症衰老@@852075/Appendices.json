{"hands_on_practices": [{"introduction": "免疫衰老的一个核心特征是T细胞受体 (TCR) 谱系多样性的显著缩减。随着年龄的增长，少数T细胞克隆会发生寡克隆扩增，占据免疫系统的大部分空间，这种现象被称为“谱系收缩”。本练习旨在挑战您解读典型的免疫谱系数据，将这一高层次的观察结果与其根本的免疫学机制——即胸腺功能退化和持续的抗原刺激——联系起来，从而理解其对抵抗新病原体能力的深远影响。[@problem_id:2239691]", "problem": "一名82岁的患者因频繁且严重的呼吸道感染史而接受免疫学评估。对其外周血进行了精密的分析，重点关注CD8+ T淋巴细胞群体中T细胞受体（TCR）库的多样性。分析显示，该T细胞受体库高度偏斜：仅四个不同的T细胞克隆就占了总CD8+ T细胞数量的55%以上。这种少数克隆主导免疫图景的现象是衰老免疫系统一个有充分记载的特征。\n\n以下哪项陈述为这种偏斜的T细胞受体库提供了最准确的免疫学解释，并指出了其对患者抵御一种他们之前从未接触过的新兴病毒株的能力所产生的最重要后果？\n\nA. 占主导地位的T细胞克隆是由于高度活跃的胸腺产生了大量初始T细胞，这些细胞因其广泛的反应性而被选择。这导致对任何新型病原体都能产生增强的、快速的反应。\n\nB. 这种模式反映了一种T细胞无能状态，即大多数T细胞变得无反应。扩增的克隆是仅存的功能性细胞，但这种状态并不损害从剩余的初始T细胞产生新反应的能力。\n\nC. 这种寡克隆扩增是免疫衰老的标志，由持续性病原体（如潜伏病毒）的终生慢性刺激与年龄相关的胸腺退化共同引起。主要后果是受体库多样性受到严重限制，从而削弱了针对新抗原发起有效初次免疫应答的能力。\n\nD. 少数巨大克隆的存在表明正在发展为T细胞白血病或淋巴瘤。主要后果是恶性转化的可能性，这并不直接影响免疫系统对新感染作出反应的能力。\n\nE. 扩增的克隆是全身性自身免疫的迹象，其中这些T细胞靶向自身抗原。主要后果是组织损伤，但对包括新病毒在内的外来病原体的反应仍然强健且不受影响。", "solution": "问题要求对在一名老年患者中观察到的少数占主导地位的CD8+ T细胞克隆现象，以及其对抵抗新病毒感染的主要后果给出最佳解释。这一情景是免疫衰老对适应性免疫系统影响的一个典型例子。\n\n**步骤1：分析观察结果。**\n关键发现是一个寡克隆T细胞受体库，意味着它由少数（oligo-）克隆主导。在本案例中，四个CD8+ T细胞克隆占据了整个CD8+ T细胞群体的一半以上。这表明T细胞受体（TCR）多样性急剧丧失。一个健康的年轻人拥有高度多样化的受体库，包含数百万个不同的T细胞克隆，每个克隆的频率都非常低。\n\n**步骤2：将观察结果与年龄相关的免疫学变化（免疫衰老）联系起来。**\n两个主要过程导致了这种与年龄相关的转变：\n1.  **胸腺退化（Thymic Involution）：** 胸腺是T细胞发育和成熟的主要场所。随着年龄的增长，胸腺逐渐萎缩，其功能性组织被脂肪取代。这个过程被称为胸腺退化，导致新的初始T细胞的产生急剧下降。\n2.  **慢性抗原刺激和记忆膨胀（Memory Inflation）：** 在一生中，个体会接触到许多病原体。其中一些，如巨细胞病毒（CMV），会建立终身潜伏感染。免疫系统必须持续监视和控制这些潜伏病毒。这种慢性抗原刺激驱动了识别这些持续性抗原的特定T细胞克隆的反复增殖。这导致这些特定记忆T细胞克隆的大量扩增，这种现象有时被称为“记忆膨胀”。\n\n这两个过程共同解释了观察到的模式。由于新产生的初始T细胞非常少，T细胞区室逐渐被这些大规模扩增的记忆T细胞克隆所填充。这“挤占”了其他较少被刺激的T细胞克隆的空间，导致了观察到的寡克隆性以及整个TCR受体库多样性的收缩。\n\n**步骤3：确定对新型病原体免疫的后果。**\n针对一种新病原体（带有新抗原的病原体）的有效初次免疫应答，取决于是否存在一个其TCR能够识别该病原体抗原的初始T细胞克隆。由于潜在病原体的多样性极大，一个高度多样化的初始T细胞受体库对于确保能对任何新威胁有“匹配”的应答至关重要。\n\n在所述的老年患者中，T细胞受体库已经丧失了其多样性。空间被少数针对旧的、持续性抗原的优势记忆克隆所占据。初始T细胞池很小，可用的TCR总多样性急剧减少。因此，存在一个能够识别新病毒抗原的预存T细胞克隆的概率显著降低。这严重损害了启动和发展有效初次T细胞应答的能力，使个体极易受到新感染的攻击。\n\n**步骤4：评估给出的选项。**\n\n*   **A. 这是不正确的。** 胸腺活动随年龄增长而*减少*（退化），而不是增加。免疫衰老的结果是对新型病原体的反应*受损*，而不是增强。\n\n*   **B. 这部分是不正确的。** 虽然一些扩增的细胞可能是终末分化的或“耗竭”的（一种与无能相关的状态），但所描述的核心问题是克隆优势，而不是广泛的无能状态。最重要的是，“这并不损害产生新反应的能力”这一说法是错误的。缩小的初始T细胞池是关键的损害。\n\n*   **C. 这是正确答案。** 它准确地指出了原因（免疫衰老，由胸腺退化和慢性抗原刺激驱动）和主要后果（多样性降低导致对新型病原体的初次应答受损）。\n\n*   **D. 这是不正确的。** 虽然T细胞恶性肿瘤涉及克隆扩增，但它通常是*单克隆*的（单一克隆）。观察到少数（寡克隆）扩增的克隆更具免疫衰老的特征。此外，血液系统恶性肿瘤会深刻地、负面地影响整个免疫系统的能力。\n\n*   **E. 这是不正确的。** 虽然自身免疫可能涉及克隆扩增，但它不是对这种特定年龄相关模式的经典解释。更重要的是，无论其靶标如何，少数克隆的优势本身就会降低受体库多样性，因此*确实*会损害对新外来病原体的反应能力。反应不会保持强健且不受影响。", "answer": "$$\\boxed{C}$$", "id": "2239691"}, {"introduction": "在理解了T细胞克隆扩增的宏观后果后，我们现在将深入探讨调控这一过程的细胞“时钟”。端粒缩短是导致细胞复制性衰老的核心机制，它限制了T细胞克隆的增殖能力。本练习要求您从基本原理出发，推导出一个数学模型来预测T细胞的复制寿命，该模型将整合基线损耗、炎症性衰老（inflammaging）引起的氧化应激以及端粒酶的修复活性等多种因素，从而锻炼您建立定量生物学模型的能力。[@problem_id:2861351]", "problem": "一个克隆扩增的人类T细胞在分裂过程中其端粒会逐渐缩短，当其最短的端粒达到触发DNA损伤反应（DDR）的临界损伤信号阈值时，它会进入复制性衰老。考虑一个T细胞克隆，其在第一次分裂时的平均端粒长度为$\\ell_0$（单位为碱基对），其衰老阈值为$\\ell_c$（单位为碱基对），且$\\ell_0 > \\ell_c$。假设在稳态、非炎症环境中，每次分裂的平均端粒丢失量为$\\Delta \\ell$（单位为碱基对/每次分裂），这反映了末端复制问题和基线氧化损伤。在以活性氧（ROS）水平升高为特征的炎症衰老环境中，假设每次分裂的丢失量乘性增加到$(1+\\eta)\\,\\Delta \\ell$，其中$\\eta \\ge 0$。在T细胞受体（TCR）再次刺激后，端粒酶可以被诱导并部分补偿端粒的丢失。将每次分裂时的端粒酶诱导建模为一个概率为$p \\in [0,1]$的伯努利事件，且各次分裂之间相互独立。当在某次分裂中端粒酶被诱导时，它会恢复稳态下单次分裂丢失量的固定比例$\\alpha \\in [0,1]$，因此该次分裂中端粒长度的变化量减少了$\\alpha\\,\\Delta \\ell$。假设不同分裂间的丢失和增益具有可加性，并假设在端粒长度达到$\\ell_c$之前的细胞死亡可以忽略不计，因此，当预期的总端粒丢失量等于$\\ell_0 - \\ell_c$时，细胞发生衰老。\n\n仅从这些假设和标准的概率期望（期望的线性性质和大数定律）出发，推导该克隆的预期复制寿命$L$（以分裂次数为单位）的解析表达式，其定义为到衰老为止的预期分裂次数。将你的最终答案表示为$\\ell_0$、$\\ell_c$、$\\Delta \\ell$、$\\eta$、$p$和$\\alpha$的闭式函数。不要代入任何数值。最终答案中不得包含任何不等式；它必须是关于$L$的单一解析表达式。", "solution": "该问题要求推导T细胞克隆的预期复制寿命$L$的表达式。该问题陈述经证实具有科学依据、提法恰当且客观。它基于已确立的生物学原理，提供了一个清晰的端粒动力学定量模型，尽管为适合数学练习做了一些简化假设。所有必要的参数都已定义，目标明确。因此，我们开始求解。\n\n触发衰老所需的总端粒缩短量是初始平均端粒长度$\\ell_0$与临界阈值长度$\\ell_c$之间的差值。该总丢失量为$\\ell_0 - \\ell_c$。\n\n问题陈述指出，当预期的总端粒丢失量等于该值时，细胞发生衰老。设$L$为到衰老为止的细胞分裂次数。经过$L$次分裂的预期总端粒丢失量是$L$与单次分裂的预期端粒丢失量（我们将其表示为$E[\\Delta L_{div}]$）的乘积。因此，我们必须求解以下方程：\n$$L \\cdot E[\\Delta L_{div}] = \\ell_0 - \\ell_c$$\n\n我们的首要任务是确定单次分裂中的预期端粒丢失量$E[\\Delta L_{div}]$。该丢失过程受两个因素影响：慢性炎症（炎症衰老）和随机的端粒酶活性。\n\n在稳态环境中，基线的单次分裂端粒丢失量为$\\Delta \\ell$。在特定的炎症衰老环境中，此丢失量乘性增加一个因子$(1+\\eta)$。因此，由末端复制和氧化应激造成的丢失为$(1+\\eta)\\,\\Delta \\ell$。\n\n端粒酶可以抵消这种丢失。其在分裂时的诱导被建模为一个伯努利随机变量，我们可以用一个指示变量$T$来表示。设当端粒酶被诱导时$T=1$（概率为$p$），未被诱导时$T=0$（概率为$1-p$）。该指示变量的期望为$E[T] = 1 \\cdot P(T=1) + 0 \\cdot P(T=0) = p$。\n\n当端粒酶被诱导（$T=1$）时，它会恢复一段长度为$\\alpha\\,\\Delta \\ell$的端粒。这种恢复减少了该次分裂的总丢失量。\n\n现在我们可以将单次分裂中的净端粒丢失量$\\Delta L_{div}$表示为依赖于$T$的随机变量：\n$$\\Delta L_{div} = (1+\\eta)\\,\\Delta \\ell - T \\cdot (\\alpha\\,\\Delta \\ell)$$\n该方程表明，丢失量总是$(1+\\eta)\\,\\Delta \\ell$，但仅当端粒酶被激活（$T=1$）时，它才会减少$\\alpha\\,\\Delta \\ell$。\n\n接下来，我们利用期望的线性性质来计算这个单次分裂丢失量的期望值$E[\\Delta L_{div}]$。\n$$E[\\Delta L_{div}] = E[(1+\\eta)\\,\\Delta \\ell - T \\cdot \\alpha\\,\\Delta \\ell]$$\n项$(1+\\eta)\\,\\Delta \\ell$和$\\alpha\\,\\Delta \\ell$相对于端粒酶诱导这一概率事件是常数。因此，我们可以写出：\n$$E[\\Delta L_{div}] = (1+\\eta)\\,\\Delta \\ell - E[T] \\cdot \\alpha\\,\\Delta \\ell$$\n代入伯努利变量的期望$E[T] = p$，我们得到：\n$$E[\\Delta L_{div}] = (1+\\eta)\\,\\Delta \\ell - p \\cdot \\alpha\\,\\Delta \\ell$$\n提出公因式$\\Delta \\ell$：\n$$E[\\Delta L_{div}] = \\Delta \\ell (1 + \\eta - p \\alpha)$$\n这个表达式代表了每次细胞分裂的平均端粒缩短量，它同时考虑了炎症衰老增加的损伤和随机端粒酶活性的部分修复。问题中提到的大数定律为我们将此期望值用作大量分裂过程中的有效缩短率提供了理论依据。\n\n最后，我们将此结果代回我们关于复制寿命$L$的基本方程中：\n$$L \\cdot [\\Delta \\ell (1 + \\eta - p \\alpha)] = \\ell_0 - \\ell_c$$\n通过将方程两边同时除以预期的单次分裂丢失量来求解$L$，得到最终表达式：\n$$L = \\frac{\\ell_0 - \\ell_c}{\\Delta \\ell (1 + \\eta - p \\alpha)}$$\n这就是在指定模型条件下，T细胞克隆预期复制寿命的闭式解析表达式。该表达式在物理上和生物学上都是一致的：寿命$L$随着初始长度与临界长度之差$(\\ell_0 - \\ell_c)$的增大而增加，并随着净端粒丢失率（分母）的升高而减少。炎症参数($\\eta$)和端粒修复参数($p, \\alpha$)正确地调节了这一速率。", "answer": "$$\n\\boxed{\\frac{\\ell_0 - \\ell_c}{\\Delta \\ell (1 + \\eta - p \\alpha)}}\n$$", "id": "2861351"}, {"introduction": "免疫衰老与炎症性衰老（inflammaging）紧密相连，而线粒体功能障碍是驱动衰老和慢性炎症的关键因素。这项高级练习将引导您构建一个连接生物物理学、细胞生物学和计算科学的多层次模型。您将通过该模型，量化线粒体健康状况（以膜电位 $\\Delta \\psi_m$ 为指标）如何影响活性氧（ROS）的产生，并最终决定NLRP3炎症小体（inflammaging的核心参与者）的活化概率，从而深入理解细胞衰老如何驱动慢性炎症。[@problem_id:2861343]", "problem": "您的任务是构建、校准并应用一个最小化的生物物理概率模型，在免疫衰老和炎症衰老的背景下，将线粒体膜电位、活性氧与炎性体激活联系起来。目标是形式化描述线粒体膜电位的变化如何调节线粒体超氧化物的产生，而线粒体超氧化物的产生又如何调节在已致敏的先天免疫细胞中，含有NOD、LRR和pyrin结构域的蛋白$3$（NLRP$3$）炎性体激活的概率。\n\n建模约束和要求：\n- 使用以下来自免疫学和细胞生物能量学的基础知识：\n  - 在已致敏的髓系细胞中，NLRP$3$的激活需要一个致敏信号和一个危险信号。源自线粒体的活性氧（ROS）可以作为危险信号，增加NLRP$3$激活的可能性。这表明，在给定致敏条件后，NLRP$3$的激活概率随线粒体ROS的增加而增加。\n  - 线粒体超氧化物的生成随线粒体膜电位 $\\Delta \\psi_m$（单位：毫伏）单调增加，并在高 $\\Delta \\psi_m$ 时因电子传递链动力学和泄漏而饱和。\n- 令 $R(\\Delta \\psi_m)$ 表示以归一化任意单位计的预期线粒体超氧化物水平。选择最简单的具有四个参数、单个拐点以及在低和高 $\\Delta \\psi_m$ 处有水平渐近线的可微、单调递增、饱和响应函数族。使用最小二乘法根据所提供的数据校准其参数。\n- 令 $p_{\\mathrm{act}}$ 表示在给定 $\\Delta \\psi_m$ 和致敏分数 $S \\in [0,1]$（无量纲）的情况下，一个已致敏细胞激活NLRP$3$的概率。将 $p_{\\mathrm{act}}$ 建模为已致敏细胞分数 $S$ 与一个随 $R(\\Delta \\psi_m)$ 增加的条件激活概率的乘积，该条件激活概率使用同样的最简单的具有两个自由参数的S形曲线族。通过施加以下条件来确定这两个参数：\n  - 当 $S = 1$ 且 $R$ 等于校准后的 $R(\\Delta \\psi_m)$ 曲线的下渐近线时，条件激活概率等于 $0.1$（即，一旦致敏，存在一个低但非零的基线激活水平）。\n  - 当 $S = 1$ 且 $R$ 等于校准后的 $R(\\Delta \\psi_m)$ 曲线的上渐近线时，条件激活概率等于 $0.9$（即，在高ROS水平下接近饱和）。\n- 使用最小二乘法，根据以下线粒体超氧化物校准数据集来校准 $R(\\Delta \\psi_m)$，其中每对数据为 $(\\Delta \\psi_m \\text{（单位：mV）}, R \\text{（单位：归一化单位）})$：\n  - $(110, 0.10)$, $(130, 0.20)$, $(150, 0.45)$, $(160, 0.60)$, $(170, 0.75)$, $(180, 0.85)$, $(190, 0.92)$.\n- 校准后，在以下测试套件上评估该模型。每个测试用例是一对 $(\\Delta \\psi_m \\text{（单位：mV）}, S)$：\n  - 用例 $1$：$(120, 1.0)$\n  - 用例 $2$：$(150, 0.5)$\n  - 用例 $3$：$(180, 1.0)$\n  - 用例 $4$：$(95, 1.0)$\n  - 用例 $5$：$(200, 0.8)$\n  - 用例 $6$：$(160, 0.0)$\n- 科学真实性：假设除了校准残差外没有外部噪声，并且从 $\\Delta \\psi_m$ 到ROS的映射是细胞群体平均的。\n- 要求的单位和格式：\n  - $\\Delta \\psi_m$ 必须以 $\\mathrm{mV}$ 为单位处理。\n  - ROS水平是 $[0,1]$ 范围内的无量纲归一化任意单位。\n  - 激活概率是 $[0,1]$ 范围内的无量纲小数。\n- 输出规范：\n  - 对于每个测试用例，输出预测的 $p_{\\mathrm{act}}$，四舍五入到恰好 $6$ 位小数。\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[0.123456,0.234567,0.345678,0.456789,0.567890,0.678901]\"）。\n\n交付成果：\n- 实现一个完整、可运行的程序，该程序：\n  - 仅使用提供的校准数据，通过最小二乘法校准 $\\Delta \\psi_m \\mapsto R$ 曲线。\n  - 根据所述边界条件确定条件激活曲线的参数。\n  - 以确切要求的格式评估并打印指定六个测试用例的激活概率。\n\n不提供用户输入；所有数据都已嵌入。确保数值稳定性和可复现性。所有数学运算必须在代码中精确定义。将所有最终概率表示为小数而非百分比，并确保最终输出与指定的列表格式完全匹配。", "solution": "该问题要求构建并校准一个生物物理模型，以描述NLRP$3$炎性体激活的概率。该问题具有科学依据，提法明确且客观。它为建模提供了一个清晰的框架，包括函数形式、校准数据和边界条件。我们将按步骤进行求解。\n\n**1. 模型组件的形式化**\n\n炎性体激活的总概率 $p_{\\mathrm{act}}$ 是已致敏细胞的比例 $S$ 与一个条件概率 $p_{\\mathrm{cond}}$ 的乘积，该条件概率取决于线粒体活性氧（ROS）的水平，记为 $R$。\n$$p_{\\mathrm{act}}(\\Delta \\psi_m, S) = S \\cdot p_{\\mathrm{cond}}(R(\\Delta \\psi_m))$$\nROS水平 $R$ 本身是线粒体膜电位 $\\Delta \\psi_m$ 的函数。\n\n**1.1. 线粒体ROS生成模型 $R(\\Delta \\psi_m)$**\n\n问题规定 $R(\\Delta \\psi_m)$ 必须是一个四参数、可微、单调递增且饱和的函数。在生物物理建模中，对此类关系的标准选择是四参数逻辑（4PL）函数。我们将其定义为：\n$$R(\\Delta \\psi_m) = R_{\\mathrm{min}} + \\frac{R_{\\mathrm{max}} - R_{\\mathrm{min}}}{1 + e^{-k_R (\\Delta \\psi_m - \\psi_0)}}$$\n这里的四个参数是：\n- $R_{\\mathrm{min}}$：下渐近线，表示低 $\\Delta \\psi_m$ 时的基础ROS水平。\n- $R_{\\mathrm{max}}$：上渐近线，表示高 $\\Delta \\psi_m$ 时的饱和ROS水平。\n- $k_R$：陡度参数，控制曲线的斜率。\n- $\\psi_0$：拐点，即响应处于 $R_{\\mathrm{min}}$ 和 $R_{\\mathrm{max}}$ 中间值时 $\\Delta \\psi_m$ 的值。\n\n这四个参数将通过使用最小二乘法将模型拟合到所提供的实验数据来确定。\n\n**1.2. 条件激活概率模型 $p_{\\mathrm{cond}}(R)$**\n\n问题要求为条件概率 $p_{\\mathrm{cond}}(R)$ 使用一个双参数的S形函数。我们选择标准的双参数逻辑函数，它将输入 $R$ 映射到 $(0, 1)$ 范围内的概率：\n$$p_{\\mathrm{cond}}(R) = \\frac{1}{1 + e^{-k_p (R - R_0)}}$$\n待确定的两个参数是：\n- $k_p$：激活概率曲线的陡度参数。\n- $R_0$：拐点，表示条件激活概率为 $0.5$ 时的ROS水平。\n\n**2. ROS模型 $R(\\Delta \\psi_m)$ 的校准**\n\n通过最小化模型预测与校准数据之间的残差平方和来找到参数 $(R_{\\mathrm{min}}, R_{\\mathrm{max}}, k_R, \\psi_0)$。目标是找到 $\\mathrm{argmin} \\sum_{i} (R_i^{\\mathrm{data}} - R(\\Delta \\psi_{m,i}))^2$。\n提供的校准数据集为：\n- $\\Delta \\psi_m$ (单位 mV): $\\{110, 130, 150, 160, 170, 180, 190\\}$\n- $R$ (归一化单位): $\\{0.10, 0.20, 0.45, 0.60, 0.75, 0.85, 0.92\\}$\n\n这是一个非线性回归问题，必须进行数值求解。实现将使用`scipy.optimize.curve_fit`函数提供的Levenberg-Marquardt算法。\n\n**3. 激活概率参数的确定**\n\n参数 $k_p$ 和 $R_0$ 由问题陈述中提供的两个条件确定，这两个条件在 $S=1$ 时适用：\n1. 当ROS水平 $R$ 处于其最小值 $R_{\\mathrm{min}}$ 时，条件激活概率为 $0.1$：$p_{\\mathrm{cond}}(R_{\\mathrm{min}}) = 0.1$。\n2. 当ROS水平 $R$ 处于其最大值 $R_{\\mathrm{max}}$ 时，条件激活概率为 $0.9$：$p_{\\mathrm{cond}}(R_{\\mathrm{max}}) = 0.9$。\n\n将这些代入 $p_{\\mathrm{cond}}(R)$ 的表达式，我们得到一个包含两个方程的方程组：\n$$ \\frac{1}{1 + e^{-k_p (R_{\\mathrm{min}} - R_0)}} = 0.1 $$\n$$ \\frac{1}{1 + e^{-k_p (R_{\\mathrm{max}} - R_0)}} = 0.9 $$\n由第一个方程可得：\n$1 + e^{-k_p (R_{\\mathrm{min}} - R_0)} = 10 \\implies e^{-k_p (R_{\\mathrm{min}} - R_0)} = 9 \\implies -k_p (R_{\\mathrm{min}} - R_0) = \\ln(9)$。\n\n由第二个方程可得：\n$1 + e^{-k_p (R_{\\mathrm{max}} - R_0)} = \\frac{1}{0.9} = \\frac{10}{9} \\implies e^{-k_p (R_{\\mathrm{max}} - R_0)} = \\frac{1}{9} \\implies -k_p (R_{\\mathrm{max}} - R_0) = -\\ln(9)$。\n\n这给出了一个关于 $k_p$ 和 $R_0$ 的线性系统：\n1. $k_p R_0 - k_p R_{\\mathrm{min}} = \\ln(9)$\n2. $k_p R_0 - k_p R_{\\mathrm{max}} = -\\ln(9)$\n\n用第一个方程减去第二个方程得到：\n$k_p(R_{\\mathrm{max}} - R_{\\mathrm{min}}) = 2\\ln(9)$，即\n$$k_p = \\frac{2\\ln(9)}{R_{\\mathrm{max}} - R_{\\mathrm{min}}}$$\n\n将两个方程相加得到：\n$2k_p R_0 - k_p(R_{\\mathrm{min}} + R_{\\mathrm{max}}) = 0$，即\n$$R_0 = \\frac{R_{\\mathrm{min}} + R_{\\mathrm{max}}}{2}$$\n一旦在步骤2的校准中确定了 $R_{\\mathrm{min}}$ 和 $R_{\\mathrm{max}}$，这些公式就允许直接计算 $k_p$ 和 $R_0$。\n\n**4. 测试用例评估**\n\n在所有参数确定后，可以对给定的测试用例评估完整模型。对于每个测试用例 $(\\Delta \\psi_m, S)$：\n1. 使用校准后的4PL函数计算ROS水平 $R = R(\\Delta \\psi_m)$。\n2. 使用导出的参数 $k_p$ 和 $R_0$ 计算条件激活概率 $p_{\\mathrm{cond}}(R)$。\n3. 计算最终激活概率 $p_{\\mathrm{act}} = S \\cdot p_{\\mathrm{cond}}(R)$。\n每个用例的结果将按要求四舍五入到6位小数。对于 $S=0$ 的测试用例6，其计算结果必须为 $p_{\\mathrm{act}} = 0$，这可作为对模型结构的简单验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Constructs, calibrates, and applies the biophysical-probabilistic model.\n    \"\"\"\n\n    # 1. Define the model for R(delta_psi_m)\n    # This is the four-parameter logistic (4PL) function.\n    def four_param_logistic(x, R_min, R_max, k_R, psi_0):\n        \"\"\"\n        Calculates mitochondrial superoxide level R as a function of \n        mitochondrial membrane potential delta_psi_m (x).\n\n        Args:\n            x (float or np.ndarray): delta_psi_m in mV.\n            R_min (float): Lower asymptote of R.\n            R_max (float): Upper asymptote of R.\n            k_R (float): Steepness parameter.\n            psi_0 (float): Inflection point (in mV).\n\n        Returns:\n            float or np.ndarray: The predicted ROS level R.\n        \"\"\"\n        return R_min + (R_max - R_min) / (1 + np.exp(-k_R * (x - psi_0)))\n\n    # 2. Calibrate the R(delta_psi_m) model\n    # Calibration dataset\n    psi_data = np.array([110, 130, 150, 160, 170, 180, 190], dtype=np.float64)\n    R_data = np.array([0.10, 0.20, 0.45, 0.60, 0.75, 0.85, 0.92], dtype=np.float64)\n\n    # Provide reasonable initial guesses for the parameters [R_min, R_max, k_R, psi_0]\n    p0 = [\n        min(R_data),         # R_min guess\n        max(R_data),         # R_max guess\n        0.1,                 # k_R guess (steepness)\n        np.mean(psi_data)    # psi_0 guess (inflection point)\n    ]\n    \n    # Perform least-squares curve fitting to find the optimal parameters.\n    # The parameters are ordered: R_min, R_max, k_R, psi_0\n    params_R, _ = curve_fit(four_param_logistic, psi_data, R_data, p0=p0)\n    R_min_fit, R_max_fit, k_R_fit, psi_0_fit = params_R\n\n    # 3. Define and parameterize the p_cond(R) model\n    # This is the two-parameter logistic function.\n    def conditional_prob_activation(R, k_p, R_0):\n        \"\"\"\n        Calculates the conditional probability of NLRP3 activation given ROS level R.\n\n        Args:\n            R (float or np.ndarray): ROS level.\n            k_p (float): Steepness parameter.\n            R_0 (float): Inflection point (ROS level for 50% probability).\n\n        Returns:\n            float or np.ndarray: The conditional activation probability.\n        \"\"\"\n        # To avoid overflow with large negative exponents\n        # for inputs far from R_0, we can add a stability check,\n        # but numpy handles large exponents gracefully by returning inf.\n        return 1.0 / (1.0 + np.exp(-k_p * (R - R_0)))\n\n    # Determine parameters k_p and R_0 from analytical solution\n    # based on the boundary conditions p_cond(R_min) = 0.1 and p_cond(R_max) = 0.9.\n    R_0_calc = (R_min_fit + R_max_fit) / 2.0\n    \n    # Ensure R_max_fit is not equal to R_min_fit to avoid division by zero\n    if np.isclose(R_max_fit, R_min_fit):\n        k_p_calc = np.inf\n    else:\n        k_p_calc = (2.0 * np.log(9.0)) / (R_max_fit - R_min_fit)\n\n    # 4. Evaluate the full model for each test case\n    test_cases = [\n        (120, 1.0),  # Case 1\n        (150, 0.5),  # Case 2\n        (180, 1.0),  # Case 3\n        (95, 1.0),   # Case 4\n        (200, 0.8),  # Case 5\n        (160, 0.0),  # Case 6\n    ]\n\n    results = []\n    for delta_psi_m, S in test_cases:\n        # Step A: Calculate ROS level R for the given delta_psi_m\n        R_val = four_param_logistic(delta_psi_m, R_min_fit, R_max_fit, k_R_fit, psi_0_fit)\n        \n        # Step B: Calculate conditional activation probability p_cond for that R\n        p_cond = conditional_prob_activation(R_val, k_p_calc, R_0_calc)\n        \n        # Step C: Calculate final activation probability p_act\n        p_act = S * p_cond\n        \n        results.append(p_act)\n\n    # 5. Format and print the final output as specified\n    # The requirement is to round to exactly 6 decimal places.\n    # The f-string format specifier \"{:.6f}\" ensures this.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2861343"}]}