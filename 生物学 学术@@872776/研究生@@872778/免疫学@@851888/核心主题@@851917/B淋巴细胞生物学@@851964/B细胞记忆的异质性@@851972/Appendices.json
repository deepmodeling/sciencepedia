{"hands_on_practices": [{"introduction": "B细胞受体（BCR）对其靶抗原的亲和力是细胞活化的基础。本练习旨在探讨受体-配体结合的生物物理学原理，让您定量地理解高亲和力记忆B细胞如何获得竞争优势。通过推导并应用受体占有率公式 [@problem_id:2853001]，您将掌握记忆B细胞库中选择性活化的物理基础。", "problem": "一个经抗原刺激的B细胞群体包含两个记忆亚群，其B细胞受体(BCR)库对某种可溶性抗原的平均亲和力不同。亚群A富含高亲和力、经过类别转换的记忆B细胞，其平均解离常数(K_D)为 $10\\,\\mathrm{nM}$；亚群B富含较低亲和力的记忆B细胞，其平均解离常数(K_D)为 $100\\,\\mathrm{nM}$。细胞外抗原浓度为 $30\\,\\mathrm{nM}$。假设B细胞受体与抗原之间是可逆的一对一结合，环境充分混合，并且由于抗原的摩尔量远超过总受体，游离抗原浓度可以很好地用总抗原浓度来近似。从质量作用定律和解离常数(K_D)的定义出发，并从第一性原理推导出平衡受体占有率作为游离抗原浓度和解离常数的函数的表达式。使用该表达式，计算在抗原浓度为 $30\\,\\mathrm{nM}$ 时亚群A和亚群B的平衡BCR占有率，然后报告定义为 $B_{\\mathrm{A}}/B_{\\mathrm{B}}$ 的占有率倍数差异。基于受体占有率原理和B细胞信号传导中的激活阈值，简要论证在抗原限制条件下，这种差异将如何影响哪个亚群更可能被激活，无需引用任何额外的经验公式。仅报告倍数差异 $B_{\\mathrm{A}}/B_{\\mathrm{B}}$ 作为你的最终数值答案。将答案四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "该问题提出了一个生物物理化学领域中有效且定义明确的问题，具体涉及受体-配体结合原理在免疫学中的应用。该问题具有科学依据，客观，并包含了完整解答所需的所有信息。\n\n可溶性抗原（作为配体 $L$）与细胞表面的B细胞受体（$R$）的结合可以描述为一个可逆的一对一反应：\n$$\nR + L \\rightleftharpoons RL\n$$\n其中 $RL$ 代表抗原结合的受体复合物。\n\n根据质量作用定律，正向反应（结合）的速率与游离反应物浓度成正比，即 $k_{on}[R][L]$，逆向反应（解离）的速率与复合物浓度成正比，即 $k_{off}[RL]$。此处，$k_{on}$ 是结合速率常数，$k_{off}$ 是解离速率常数。\n\n在平衡状态下，结合速率等于解离速率：\n$$\nk_{on}[R][L] = k_{off}[RL]\n$$\n\n解离常数 $K_D$ 定义为解离速率常数与结合速率常数的比值，也可以用平衡浓度来表示：\n$$\nK_D = \\frac{k_{off}}{k_{on}} = \\frac{[R][L]}{[RL]}\n$$\n较低的 $K_D$ 值表示受体对其配体的亲和力更高，因为只需要较低浓度的配体即可占据一半的受体。\n\n受体占有率（我们记作 $B$）定义为在平衡状态下与配体结合的受体占总受体的比例。如果 $[R_T]$ 是总受体浓度，则：\n$$\nB = \\frac{[RL]}{[R_T]}\n$$\n总受体浓度是游离受体浓度 $[R]$ 和结合受体浓度 $[RL]$ 的总和：\n$$\n[R_T] = [R] + [RL]\n$$\n由此，我们可以将游离受体浓度表示为 $[R] = [R_T] - [RL]$。\n\n将这个 $[R]$ 的表达式代入 $K_D$ 的定义中：\n$$\nK_D = \\frac{([R_T] - [RL])[L]}{[RL]}\n$$\n题目说明，游离抗原浓度 $[L]$ 可以很好地用总抗原浓度（给定为 $30 \\, \\mathrm{nM}$）来近似。如题目所述，当配体的摩尔量远大于总受体浓度时，这是一个有效的假设。\n\n为了推导占有率 $B$ 作为 $[L]$ 和 $K_D$ 的函数，我们对该方程进行重排。首先，我们可以将分数的分子和分母同时除以 $[R_T]$：\n$$\nK_D = \\frac{\\left(1 - \\frac{[RL]}{[R_T]}\\right)[L]}{\\frac{[RL]}{[R_T]}}\n$$\n代入占有率的定义 $B = \\frac{[RL]}{[R_T]}$：\n$$\nK_D = \\frac{(1 - B)[L]}{B}\n$$\n这就是我们所期望的关联 $K_D$、$ [L]$ 和 $B$ 的表达式。现在我们求解 $B$：\n$$\nK_D \\cdot B = (1 - B)[L]\n$$\n$$\nK_D \\cdot B = [L] - B[L]\n$$\n$$\nK_D \\cdot B + B[L] = [L]\n$$\n$$\nB(K_D + [L]) = [L]\n$$\n$$\nB = \\frac{[L]}{K_D + [L]}\n$$\n这是单一位点的Hill-Langmuir方程，也就是题目要求我们从第一性原理推导出的平衡受体占有率表达式。\n\n现在，我们将此公式应用于B细胞亚群A和B。给定数据：\n亚群A的解离常数：$K_{D,A} = 10 \\, \\mathrm{nM}$\n亚群B的解离常数：$K_{D,B} = 100 \\, \\mathrm{nM}$\n游离抗原浓度：$[L] = 30 \\, \\mathrm{nM}$\n\n对于亚群A，平衡占有率 $B_A$ 为：\n$$\nB_A = \\frac{[L]}{K_{D,A} + [L]} = \\frac{30 \\, \\mathrm{nM}}{10 \\, \\mathrm{nM} + 30 \\, \\mathrm{nM}} = \\frac{30}{40} = \\frac{3}{4} = 0.75\n$$\n\n对于亚群B，平衡占有率 $B_B$ 为：\n$$\nB_B = \\frac{[L]}{K_{D,B} + [L]} = \\frac{30 \\, \\mathrm{nM}}{100 \\, \\mathrm{nM} + 30 \\, \\mathrm{nM}} = \\frac{30}{130} = \\frac{3}{13}\n$$\n\n题目要求计算占有率的倍数差异，定义为比率 $B_A / B_B$：\n$$\n\\frac{B_A}{B_B} = \\frac{\\frac{3}{4}}{\\frac{3}{13}} = \\frac{3}{4} \\cdot \\frac{13}{3} = \\frac{13}{4} = 3.25\n$$\n按要求四舍五入到四位有效数字，该值为 $3.250$。\n\n为了论证哪个亚群更可能被激活，我们必须考虑占有率的生物物理意义。B细胞的激活需要多个BCR的交联，这会启动一个细胞内信号级联。这个初始信号的强度是被结合的受体数量的函数。这个数量与受体占有率 $B$ 成正比。在给定的抗原浓度下，更高的占有率意味着更强、更持久的信号。\n\n所描述的条件 $[L] = 30 \\, \\mathrm{nM}$ 代表了一个抗原限制的环境，特别是对于低亲和力的亚群B，因为该抗原浓度远低于其 $100 \\, \\mathrm{nM}$ 的 $K_D$。对于亚群A，该浓度高于其 $10 \\, \\mathrm{nM}$ 的 $K_D$。因此，亚群A达到了 $75\\%$ 的高占有率，而亚群B的占有率要低得多，约为 $23.1\\%$。亚群A的受体占有率高出 $3.25$ 倍，这意味着对于细胞上给定数量的总受体，来自亚群A的B细胞将拥有比来自亚群B的B细胞多 $3.25$ 倍的抗原结合受体。假设激活需要一个共同的信号阈值（即触发反应所需的最小被结合受体数），高亲和力的亚群A更有可能超过这个阈值并被激活。这种基于亲和力的选择原理是生发中心中亲和力成熟过程的基础，在生发中心中，具有更高亲和力BCR的B细胞被优先选择存活和分化。", "answer": "$$\\boxed{3.250}$$", "id": "2853001"}, {"introduction": "亲和力成熟过程中，B细胞因其抗原结合能力的提升而被筛选，这一过程在其基因编码中留下了清晰的进化印记。这项动手编程实践将指导您计算$dN/dS$比率，这是一个用于检测分子选择的强大指标 [@problem_id:2852976]。您将看到该分析如何揭示抗原接触区（CDRs）中的正选择和结构区（FWRs）中的纯化选择，从而为B细胞的适应性进化提供定量特征。", "problem": "您将获得代表B细胞受体（BCR）克隆的免疫球蛋白可变区的密码子水平编码序列：一个种系序列和几个来自记忆B细胞的观测突变序列。在该区域内，互补决定区（CDR）和框架区（FWR）通过密码子索引进行了标注。您的任务是实现一个程序，该程序使用基于密码子计数的首要原则，为每个突变序列分别计算CDR和FWR分区的非同义替换率与同义替换率之比，$dN/dS$。然后，使用计算出的$dN/dS$值，判断该模式是否与CDR中的正选择和FWR中的纯化选择一致，这符合B细胞记忆中亲和力成熟和结构约束下的预期。\n\n使用以下基本依据：\n- 中心法则（脱氧核糖核酸（DNA）到核糖核酸（RNA）到蛋白质）意味着长度为3个核苷酸的密码子根据标准遗传密码被翻译成氨基酸。\n- 体细胞高频突变（SHM）在免疫球蛋白可变区引入点突变。不改变所编码氨基酸的突变称为同义突变，而改变氨基酸的突变称为非同义突变。\n- 在Nei–Gojobori计数框架下，一个密码子中预期的同义位点数 $S$ 的计算方法是：对其三个核苷酸位置中的每一个位置，枚举该位置上3种可能的单核苷酸变化，计算其中有多少种变化会导致相同的氨基酸（同义），将该计数除以3，然后对三个位置求和。一个密码子中预期的非同义位点数是 $N = 3 - S$。\n- 对于种系密码子和突变密码子之间观测到的差异，如果它们恰好相差一个核苷酸，那么当编码的氨基酸相同时，该差异被归类为同义，否则为非同义。对于涉及多个核苷酸的差异，可以依次考虑单核苷酸变化的路径；然而，在本测试套件中，所有密码子的变化要么是相同的，要么是相差单个核苷酸，以确保计数的明确性。\n- 令 $S_{\\mathrm{reg}}$ 和 $N_{\\mathrm{reg}}$ 分别为一个区域 $\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$ 内的总同义和非同义位点数，通过对该区域内所有密码子的位点数求和得到。令 $S^{\\Delta}_{\\mathrm{reg}}$ 和 $N^{\\Delta}_{\\mathrm{reg}}$ 分别为该区域内种系序列和突变序列之间观测到的同义和非同义差异数。使用一个小的连续性校正 $\\varepsilon = 10^{-6}$ 以避免在边界情况下除以零，将同义和非同义替换率定义为 $p_S = \\dfrac{S^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{S_{\\mathrm{reg}} + \\varepsilon}$ 和 $p_N = \\dfrac{N^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{N_{\\mathrm{reg}} + \\varepsilon}$。然后为每个区域计算 $dN/dS = \\dfrac{p_N}{p_S}$。\n- 解释规则：一个具有 $dN/dS_{\\mathrm{CDR}} > 1$ 和 $dN/dS_{\\mathrm{FWR}} < 1$ 的模式，与亲和力驱动的正选择（集中在CDR的抗原接触残基上）以及在记忆B细胞中约束FWR的纯化（结构性）选择相一致。\n\n您的程序必须实现标准遗传密码和上述计数方法。它必须将产生终止密码子的变化视为相对于原始氨基酸的非同义变化。\n\n输入由下面的测试套件固定。所有索引都是基于 $0$ 的密码子索引。每个序列以密码子三联体数组 $\\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}^3$ 的形式提供，长度为 $L = 24$ 个密码子。CDR索引为 $[5,6,7,16,17]$；所有其他密码子为FWR。\n\n种系密码子数组（长度24）：\n[\"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TTT\",\"TCT\",\"AAT\",\"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CAT\",\"TCT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n\n突变密码子数组测试套件（三种情况）：\n- 情况1（预期正选择信号集中在CDR，纯化选择在FWR）：\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TCT\",\"CCT\",\"CAT\",\"GCC\",\"GTC\",\"GGC\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CGT\",\"TTT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n- 情况2（跨区域的近中性混合）：\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TTC\",\"TCC\",\"AGT\",\"GCC\",\"GCT\",\"AGT\",\"CAT\",\"CCT\",\"TCT\",\"GAT\",\"GTT\",\"CAC\",\"TTT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n- 情况3（CDR中同义差异为零且FWR中仅有同义差异的边界情况）：\n[\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"TGT\",\"GAT\",\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"GCT\",\"GTT\",\"CTT\",\"CCT\",\"GGT\",\"CCT\",\"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n\n您的程序必须：\n- 为每个区域 $\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$ 和每个测试用例，实现如上所述的 $S_{\\mathrm{reg}}$、$N_{\\mathrm{reg}}$、$S^{\\Delta}_{\\mathrm{reg}}$、$N^{\\Delta}_{\\mathrm{reg}}$ 的计数。\n- 在 $p_S$ 和 $p_N$ 中使用 $\\varepsilon = 10^{-6}$ 作为连续性校正。\n- 对于每个测试用例，计算两个浮点值 $dN/dS_{\\mathrm{CDR}}$ 和 $dN/dS_{\\mathrm{FWR}}$，以及一个布尔值，指示 $(dN/dS_{\\mathrm{CDR}} > 1)$ 和 $(dN/dS_{\\mathrm{FWR}} < 1)$ 是否同时成立。\n- 将每个 $dN/dS$ 四舍五入到6位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，其中每个元素对应一个测试用例，并且本身是形式为 $[dN/dS_{\\mathrm{CDR}}, dN/dS_{\\mathrm{FWR}}, \\mathrm{boolean}]$ 的列表。例如：[[x11,x12,b1],[x21,x22,b2],[x31,x32,b3]]，其中每个 $xij$ 是一个四舍五入到6位小数的浮点数，每个 $bk$ 是 True 或 False。不应打印额外的文本。\n\n关于科学真实性和解释的说明：\n- 集中在CDR区域的 $dN/dS$ 值升高反映了对改善抗原结合能力的氨基酸变化的筛选，而FWR中降低的 $dN/dS$ 值反映了维持BCR折叠结构的结构性约束。不同案例间的异质性表明，并非所有记忆B细胞都显示出相同的选择特征；根据克隆历史和抗原暴露情况，一些细胞可能表现出近中性或强烈的纯化约束。", "solution": "所提出的问题是计算生物学中一个定义明确且有科学依据的练习，具体涉及分子进化的分析。它要求实现一种量化编码序列选择压力的基本方法——估算非同义替换率与同义替换率之比（$dN/dS$）。此分析将应用于B细胞受体的可变区，这是研究分子水平达尔文选择的经典模型系统。该问题是有效的，因为它基于既定原则，提供了所有必要的数据和定义，并且其逻辑是合理的。我们将采用一种系统性的、基于原则的方法来解决。\n\n目标是计算免疫球蛋白基因的两个不同功能区域——互补决定区（CDR）和框架区（FWR）的 $dN/dS$ 比率，并在体细胞高频突变和亲和力成熟的背景下解释结果。\n\n该解决方案基于以下原则构建：\n\n1.  **标准遗传密码和突变类别**：此分析的基础是中心法则，其中三联体核苷酸密码子被翻译成氨基酸。标准遗传密码定义了这种映射关系。密码子中的点突变根据其对最终氨基酸的影响进行分类。**同义**突变产生编码相同氨基酸的密码子。**非同义**突变产生编码不同氨基酸的密码子。按照惯例，变为终止密码子的突变被视为非同义突变。\n\n2.  **替换潜力的量化（Nei–Gojobori方法）**：在评估观测到的突变之前，我们必须首先量化序列内发生同义和非同义变化的内在潜力。对于给定的密码子，并非所有核苷酸位点接受同义或非同义突变的可能性都相同。Nei–Gojobori方法提供了一种计算潜在同义位点数（$S$）和非同义位点数（$N$）的方法。对于长度为3的密码子，总位点数为3。其步骤如下：\n    -   对于密码子中的3个核苷酸位置中的每一个，我们枚举3种可能的单核苷酸变化。\n    -   我们计算这3种变化中有多少是同义的。设此计数为 $s_j$。位置 $j$ 的同义位点分数为 $s_j/3$。\n    -   密码子的总同义位点数是所有三个位置的总和：$S = \\sum_{j=1}^{3} s_j/3$。\n    -   非同义位点数是剩余部分：$N = 3 - S$。\n    此计算提供了每种类型位点数的期望值。\n\n3.  **观测替换的量化**：我们将突变序列与祖先种系序列逐个密码子进行比较。问题通过保证任何不同的密码子都仅相差一个核苷酸来简化此过程。这使得计数可以明确无误：\n    -   对于每对密码子（种系，突变），如果它们不同，我们将两者都翻译成各自的氨基酸。\n    -   如果氨基酸相同，我们将其计为一个观测到的同义差异，$S^{\\Delta}$。\n    -   如果氨基酸不同，我们将其计为一个观测到的非同义差异，$N^{\\Delta}$。\n\n4.  **区域分析和比率计算**：分析分别对CDR和FWR分区进行。\n    -   首先，通过汇总每个区域（$\\mathrm{reg} \\in \\{\\mathrm{CDR}, \\mathrm{FWR}\\}$）内所有密码子的值，来合计总位点数（$S_{\\mathrm{reg}}$，$N_{\\mathrm{reg}}$）和观测到的差异数（$S^{\\Delta}_{\\mathrm{reg}}$，$N^{\\Delta}_{\\mathrm{reg}}$）。\n    -   接下来，我们计算每个类别的单位点替换率。这些被定义为比例，并使用一个小的连续性校正 $\\varepsilon = 10^{-6}$ 以防止除以零。\n        -   同义替换率是 $p_S = \\dfrac{S^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{S_{\\mathrm{reg}} + \\varepsilon}$。这表示每个可用同义位点上观测到的同义变化数。\n        -   非同义替换率是 $p_N = \\dfrac{N^{\\Delta}_{\\mathrm{reg}} + \\varepsilon}{N_{\\mathrm{reg}} + \\varepsilon}$。这表示每个可用非同义位点上观测到的非同义变化数。\n    -   最终的比率计算为 $dN/dS = \\dfrac{p_N}{p_S}$。这个比率是选择压力的一个度量。$dN/dS > 1$ 表明存在正选择或多样化选择，有利于氨基酸的改变。$dN/dS < 1$ 表明存在负选择或纯化选择，清除了有害的氨基酸改变。$dN/dS \\approx 1$ 表明是中性进化。\n\n5.  **生物学解释**：计算出的值将根据B细胞受体进化的特定假设进行评估：由抗原驱动的亲和力成熟需要在抗原结合位点（CDR）发生氨基酸变化，而免疫球蛋白折叠的结构完整性必须在框架区（FWR）得到维持。这转化为解释规则：如果 $dN/dS_{\\mathrm{CDR}} > 1$（CDR中的正选择）且 $dN/dS_{\\mathrm{FWR}} < 1$（FWR中的纯化选择），则该模式与假设一致。\n\n提供的代码实现了这整个流程。它定义了遗传密码，对序列进行分区，系统地应用Nei–Gojobori计数法来确定每个种系密码子的 $S$ 和 $N$，为每个测试用例计算观测到的差异 $S^{\\Delta}$ 和 $N^{\\Delta}$，并按照规定为每个区域和用例计算最终的 $dN/dS$ 比率和相应的布尔值解释。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating dN/dS ratios for BCR sequences.\n    \"\"\"\n\n    # --- Static Definitions ---\n\n    # The Standard Genetic Code (DNA to Amino Acid)\n    # '*' represents a stop codon.\n    GENETIC_CODE = {\n        'TTT': 'F', 'TTC': 'F', 'TTA': 'L', 'TTG': 'L',\n        'TCT': 'S', 'TCC': 'S', 'TCA': 'S', 'TCG': 'S',\n        'TAT': 'Y', 'TAC': 'Y', 'TAA': '*', 'TAG': '*',\n        'TGT': 'C', 'TGC': 'C', 'TGA': '*', 'TGG': 'W',\n        'CTT': 'L', 'CTC': 'L', 'CTA': 'L', 'CTG': 'L',\n        'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',\n        'CAT': 'H', 'CAC': 'H', 'CAA': 'Q', 'CAG': 'Q',\n        'CGT': 'R', 'CGC': 'R', 'CGA': 'R', 'CGG': 'R',\n        'ATT': 'I', 'ATC': 'I', 'ATA': 'I', 'ATG': 'M',\n        'ACT': 'T', 'ACC': 'T', 'ACA': 'T', 'ACG': 'T',\n        'AAT': 'N', 'AAC': 'N', 'AAA': 'K', 'AAG': 'K',\n        'AGT': 'S', 'AGC': 'S', 'AGA': 'R', 'AGG': 'R',\n        'GTT': 'V', 'GTC': 'V', 'GTA': 'V', 'GTG': 'V',\n        'GCT': 'A', 'GCC': 'A', 'GCA': 'A', 'GCG': 'A',\n        'GAT': 'D', 'GAC': 'D', 'GAA': 'E', 'GAG': 'E',\n        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G',\n    }\n    \n    BASES = ['A', 'C', 'G', 'T']\n\n    # --- Input Data from Problem Statement ---\n    \n    GERMLINE = [\n        \"GCT\",\"GTT\",\"GGT\",\"CCT\",\"ACT\",\"TTT\",\"TCT\",\"AAT\",\"GCT\",\"GTT\",\n        \"GGT\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CAT\",\"TCT\",\"GGT\",\"CCT\",\n        \"ACT\",\"GCT\",\"GTT\",\"GGT\"\n    ]\n\n    TEST_CASES = [\n        # Case 1\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TCT\",\"CCT\",\"CAT\",\"GCC\",\"GTC\",\n         \"GGC\",\"CCT\",\"ACT\",\"TAT\",\"GCT\",\"GTT\",\"CGT\",\"TTT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"],\n        # Case 2\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TTC\",\"TCC\",\"AGT\",\"GCC\",\"GCT\",\n         \"AGT\",\"CAT\",\"CCT\",\"TCT\",\"GAT\",\"GTT\",\"CAC\",\"TTT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"],\n        # Case 3\n        [\"GCC\",\"GTC\",\"GGC\",\"CCC\",\"ACC\",\"TAT\",\"TGT\",\"GAT\",\"GCC\",\"GTC\",\n         \"GGC\",\"CCC\",\"ACC\",\"TAT\",\"GCT\",\"GTT\",\"CTT\",\"CCT\",\"GGT\",\"CCT\",\n         \"ACT\",\"GCT\",\"GTT\",\"GGT\"]\n    ]\n\n    CDR_INDICES = {5, 6, 7, 16, 17}\n    EPSILON = 1e-6\n    \n    # --- Helper Functions ---\n\n    memo_potential_sites = {}\n    def calculate_potential_sites(codon):\n        \"\"\"\n        Calculates the number of potential synonymous (S) and nonsynonymous (N)\n        sites for a given codon using the Nei-Gojobori method.\n        \"\"\"\n        if codon in memo_potential_sites:\n            return memo_potential_sites[codon]\n\n        original_aa = GENETIC_CODE[codon]\n        syn_site_sum = 0.0\n\n        for i in range(3):  # Iterate through codon positions\n            original_base = codon[i]\n            syn_changes_at_pos = 0\n            for new_base in BASES:\n                if new_base == original_base:\n                    continue\n                \n                new_codon_list = list(codon)\n                new_codon_list[i] = new_base\n                new_codon = \"\".join(new_codon_list)\n                \n                new_aa = GENETIC_CODE[new_codon]\n                if new_aa == original_aa:\n                    syn_changes_at_pos += 1\n            \n            syn_site_sum += syn_changes_at_pos / 3.0\n            \n        s_sites = syn_site_sum\n        n_sites = 3.0 - s_sites\n        \n        memo_potential_sites[codon] = (s_sites, n_sites)\n        return s_sites, n_sites\n\n    # --- Main Logic ---\n\n    results = []\n    \n    for mutated_seq in TEST_CASES:\n        # Initialize regional counters\n        stats = {\n            'CDR': {'S_sites': 0.0, 'N_sites': 0.0, 'S_delta': 0, 'N_delta': 0},\n            'FWR': {'S_sites': 0.0, 'N_sites': 0.0, 'S_delta': 0, 'N_delta': 0}\n        }\n\n        for i, (germline_codon, mutated_codon) in enumerate(zip(GERMLINE, mutated_seq)):\n            region = 'CDR' if i in CDR_INDICES else 'FWR'\n            \n            # 1. Calculate and aggregate potential sites for the germline codon\n            s_sites, n_sites = calculate_potential_sites(germline_codon)\n            stats[region]['S_sites'] += s_sites\n            stats[region]['N_sites'] += n_sites\n            \n            # 2. Count observed differences\n            if germline_codon != mutated_codon:\n                germline_aa = GENETIC_CODE[germline_codon]\n                mutated_aa = GENETIC_CODE[mutated_codon]\n                \n                if germline_aa == mutated_aa:\n                    stats[region]['S_delta'] += 1\n                else:\n                    stats[region]['N_delta'] += 1\n\n        # 3. Calculate dN/dS for each region\n        case_results = []\n        for region in ['CDR', 'FWR']:\n            s_sites_total = stats[region]['S_sites']\n            n_sites_total = stats[region]['N_sites']\n            s_delta_total = stats[region]['S_delta']\n            n_delta_total = stats[region]['N_delta']\n\n            p_s = (s_delta_total + EPSILON) / (s_sites_total + EPSILON)\n            p_n = (n_delta_total + EPSILON) / (n_sites_total + EPSILON)\n            \n            dn_ds = p_n / p_s if p_s != 0 else float('inf')\n            \n            case_results.append(dn_ds)\n\n        dnds_cdr, dnds_fwr = case_results\n        \n        # 4. Apply interpretation rule\n        is_consistent = (dnds_cdr > 1) and (dnds_fwr < 1)\n        \n        # 5. Format and store result for the case\n        rounded_dnds_cdr = round(dnds_cdr, 6)\n        rounded_dnds_fwr = round(dnds_fwr, 6)\n        \n        results.append([rounded_dnds_cdr, rounded_dnds_fwr, is_consistent])\n\n    # Final print statement in the exact required format.\n    # The default str() for a list gives the '[...]' format and\n    # the default str() for a boolean is 'True' or 'False'.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str.replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "2852976"}, {"introduction": "一个活化的B细胞分化为记忆细胞还是浆细胞，是由一个复杂的内部基因调控网络决定的，该网络如同一个分子开关。本练习引入一个布尔网络模型来模拟这一关键的细胞命运决定过程 [@problem_id:2853003]。通过寻找该网络的稳态，您将深入了解相互拮抗的转录因子如何能够产生不同且稳定的细胞表型，这是免疫应答异质性背后的核心原则。", "problem": "在B淋巴细胞的分化过程中，B细胞淋巴瘤6 (BCL6)、干扰素调节因子4 (IRF4)、BTB和CNC同源蛋白2 (Bach2)以及B淋巴细胞诱导成熟蛋白1 (Blimp-1) 形成一个核心转录回路，其拮抗与激活是B细胞记忆异质性的基础。经过充分验证的观察结果包括：BCL6是生发中心和记忆命运所必需的，并抑制IRF4；持续或高水平的IRF4会促进Blimp-1的表达和浆细胞命运，同时抑制Bach2；Bach2通过促进BCL6和抑制Blimp-1来支持记忆；Blimp-1拮抗BCL6。在一个最小化的粗粒度模型中，这些相互作用可以被编码为一个同步布尔基因调控网络，其节点为 $B$ (BCL6)、$I$ (IRF4)、$A$ (Bach2) 和 $P$ (Blimp-1)，其中 $1$ 表示转录活跃/高，$0$ 表示不活跃/低。激活表示为逻辑合取，抑制表示为逻辑非。考虑以下与这些相互作用一致的最小更新规则：\n- $B(t+1) = A(t) \\land \\neg P(t)$,\n- $P(t+1) = I(t) \\land \\neg A(t)$,\n- $A(t+1) = B(t) \\land \\neg I(t)$,\n- $I(t+1) = \\neg B(t)$.\n布尔稳态是一个赋值 $(B,I,A,P)\\in\\{0,1\\}^4$，使得 $B(t+1)=B(t)$、$I(t+1)=I(t)$、$A(t+1)=A(t)$ 且 $P(t+1)=P(t)$。定义一个记忆表型稳态为 $B=1$ 且 $P=0$ 的状态，一个浆细胞表型稳态为 $B=0$ 且 $P=1$ 的状态。从上述定义和网络规则出发，确定所有稳态并按表型对其进行分类。然后计算对应于记忆表型的稳态占所有稳态的比例。将最终答案表示为一个无单位的最简分数。", "solution": "问题陈述构成了一个应用于生物学背景的离散动力系统领域中的有效、适定的问题。它以科学为基础，作为一种标准的建模方法，没有矛盾，并包含了获得唯一解所需的所有必要信息。我们将继续进行形式化分析。\n\n所考虑的系统是一个同步布尔网络，有四个节点，由变量 $B$、$I$、$A$ 和 $P$ 表示，每个变量取值于 $\\{0, 1\\}$。稳态是一个状态向量 $(B, I, A, P)$，在应用更新规则后保持不变。这个条件可以转化为一个由四个联立布尔方程组成的方程组：\n$$B = A \\land \\neg P \\quad (1)$$\n$$P = I \\land \\neg A \\quad (2)$$\n$$A = B \\land \\neg I \\quad (3)$$\n$$I = \\neg B \\quad (4)$$\n我们必须找到所有满足这四个方程的状态向量 $(B, I, A, P) \\in \\{0, 1\\}^4$。最直接的方法是代数代入。\n\n从方程 $(4)$ 可知，$I$ 的值完全由 $B$ 的值确定。我们将这个关于 $I$ 的表达式代入方程 $(3)$：\n$$A = B \\land \\neg(\\neg B)$$\n根据布尔代数中的双重否定律，对于任何布尔变量 $X$，都有 $\\neg(\\neg X) = X$。该方程简化为：\n$$A = B \\land B$$\n根据合取的幂等律，$X \\land X = X$。因此，我们找到了任何稳态的一个必要条件：\n$$A = B$$\n这意味着在任何稳态下，节点 $A$ 和 $B$ 的值必须相同。\n\n现在我们有两个用 $B$ 表示的变量，$A$ 和 $I$：$A = B$ 和 $I = \\neg B$。我们可以用这些关系来简化剩下的方程。让我们将它们代入方程 $(2)$：\n$$P = I \\land \\neg A$$\n$$P = (\\neg B) \\land (\\neg B)$$\n再次应用幂等律，我们得到：\n$$P = \\neg B$$\n这个结果表明，$P$ 的值也完全由 $B$ 的值决定。\n\n至此，我们已经推导出了任何稳态的一组必要条件：\n$$A = B$$\n$$I = \\neg B$$\n$$P = \\neg B$$\n这些关系意味着整个状态向量 $(B, I, A, P)$ 由单个变量 $B$ 的值定义。为了确认这些关系是充分且自洽的，我们必须将它们代回唯一未使用的方程，即方程 $(1)$：\n$$B = A \\land \\neg P$$\n$$B = (B) \\land \\neg(\\neg B)$$\n$$B = B \\land B$$\n$$B = B$$\n该方程简化为一个重言式，即一个对 $B$ 的任何值都成立的恒等式。它没有对 $B$ 施加任何额外的约束。因此，任何形式为 $(B, \\neg B, B, \\neg B)$ 的状态向量都是该系统的有效稳态。\n\n由于 $B$ 是一个布尔变量，它可以取两个可能的值，$0$ 或 $1$。每个 $B$ 的值都定义了一个唯一的稳态。\n\n情况1：$B = 0$。\n其他变量的值为：\n$I = \\neg 0 = 1$\n$A = 0$\n$P = \\neg 0 = 1$\n这就得到了稳态 $(B, I, A, P) = (0, 1, 0, 1)$。\n\n情况2：$B = 1$。\n其他变量的值为：\n$I = \\neg 1 = 0$\n$A = 1$\n$P = \\neg 1 = 0$\n这就得到了稳态 $(B, I, A, P) = (1, 0, 1, 0)$。\n\n我们已经严格确定该系统恰好有两个稳态。接下来的任务是根据给定的定义对它们进行分类：\n- 记忆表型稳态：$B=1$ 且 $P=0$。\n- 浆细胞表型稳态：$B=0$ 且 $P=1$。\n\n让我们对找到的两个状态进行分类：\n1. 稳态 $(1, 0, 1, 0)$ 具有 $B=1$ 和 $P=0$。此构型精确匹配记忆表型稳态的定义。\n2. 稳态 $(0, 1, 0, 1)$ 具有 $B=0$ 和 $P=1$。此构型精确匹配浆细胞表型稳态的定义。\n\n稳态总数为 $N_{\\text{total}} = 2$。对应于记忆表型的稳态数量为 $N_{\\text{memory}} = 1$。问题要求计算对应于记忆表型的稳态占所有稳态的比例。该比例计算如下：\n$$\\text{分数} = \\frac{N_{\\text{memory}}}{N_{\\text{total}}} = \\frac{1}{2}$$\n该分数为最简形式。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2853003"}]}