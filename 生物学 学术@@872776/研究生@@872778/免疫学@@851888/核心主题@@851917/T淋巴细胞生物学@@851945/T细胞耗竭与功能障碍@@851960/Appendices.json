{"hands_on_practices": [{"introduction": "在免疫学研究中，区分T细胞耗竭与急性活化是一个关键挑战，因为这两种状态可能共享如PD-1等标志物。一个可靠的鉴定策略必须超越单一标志物，整合稳定的表型特征（如CD39）和功能性读数以实现特异性。这项练习将挑战您设计一个精密的多参数流式细胞术设门策略，这是在研究和临床环境中准确分析T细胞群体的核心技能 [@problem_id:2893499]。", "problem": "一个实验室正在通过多参数流式细胞术，在抗原暴露后的两个时间点对人分化簇 $8$ (CD8) T细胞进行表型分析：一个是 $24$–$72$ 小时的早期激活后窗口期，另一个是第 $21$ 天的慢性刺激环境。该抗体组合允许对程序性死亡蛋白 1 (PD-1)、T细胞免疫球蛋白和黏蛋白结构域蛋白-3 (TIM-3)、淋巴细胞活化基因 3 (LAG-3)、含Ig和ITIM结构域的T细胞免疫受体 (TIGIT)、分化簇 39 (CD39)、分化簇 101 (CD101)、分化簇 69 (CD69)、分化簇 25 (CD25)、分化簇 127 (CD127)、T细胞因子 1 (TCF-1)、胸腺细胞选择相关高迁移率族蛋白 (TOX)、Ki-67、干扰素-γ (IFN-$\\gamma$)、肿瘤坏死因子 (TNF)、白细胞介素-2 (IL-2) 和颗粒酶B进行表面和胞内染色，同时还包括用于定义活的、单个的、CD$3^{+}$ CD$8^{+}$ 抗原经验T细胞的标志物（例如 CD45RA 和 CCR7）。该实验包括用短肽进行 $6$ 小时的再刺激，并进行胞内细胞因子染色。\n\n请使用以下经过充分验证的事实作为您推理的基础：\n- 急性T细胞受体 (TCR) 激活会诱导多种抑制性受体（例如 PD-1、TIM-3、LAG-3、TIGIT）和活化标志物（例如 CD69、CD25）的瞬时上调，同时伴有强劲的细胞因子产生（例如 IL-2、TNF）和增殖（例如 Ki-67），但不会立即对细胞进行重编程。\n- 慢性抗原暴露会驱动一个独特且持久的耗竭程序，其特征是多种抑制性受体的持续共表达，某些表面标志物如 CD39（通常还有 CD101）的富集，一种包括持续性 TOX 表达的转录状态，多功能细胞因子产生能力受损（特别是 IL-2 显著减少），以及回忆性增殖能力降低。\n- 在早期激活窗口期，单个抑制性受体阳性对于判定耗竭缺乏特异性，因为许多此类受体是急性活化效应细胞正常负反馈的一部分。\n\n您必须选择最佳的基于规则的圈门策略，该策略能在 $24$–$72$ 小时窗口期内最大限度地减少将急性活化效应细胞错误分类为耗竭细胞，同时在慢性刺激下对真正的耗竭群体保持特异性。所有策略都始于标准圈门：前向/侧向散射光、单个细胞、活细胞、CD$3^{+}$ CD$8^{+}$，并排除初始表型（例如 CD45RA$^{+}$ CCR7$^{+}$）。哪个选项最合适？\n\nA. 在抗原经验CD$8^{+}$ T细胞中，将“耗竭”定义为 PD-1$^{\\text{high}}$ 或 TIM-3$^{+}$，无论其活化或功能状态如何。在所有时间点，将任何满足任一条件的细胞归类为耗竭细胞。\n\nB. 在抗原经验CD$8^{+}$ T细胞中，通过一个联合圈门来定义“耗竭”：PD-1$^{\\text{high}}$ 且 CD39$^{+}$ 且 (TIM-3$^{+}$ 或 LAG-3$^{+}$ 或 TIGIT$^{+}$)，同时伴有功能损伤（定义为经过 $6$ 小时短肽再刺激后 IL-2 水平低和 TNF 水平低）；此外，在 $24$–$72$ 小时窗口期应用一个排除性子门，以移除 CD69$^{\\text{high}}$ CD25$^{\\text{high}}$ Ki-67$^{\\text{high}}$ 的事件。\n\nC. 在抗原经验CD$8^{+}$ T细胞中，将“耗竭”定义为 TCF-1$^{\\text{high}}$ PD-1$^{+}$ CX3CR1$^{\\text{low}}$，而不评估共抑制性受体的共表达、CD39 或再刺激功能，以避免捕获通常为 TCF-1$^{\\text{low}}$ 的高度活化效应细胞。\n\nD. 将“耗竭”定义为在 PD-1、TIGIT 和细胞毒性T淋巴细胞相关蛋白 $4$ (CTLA-4) 中共表达至少 $2$ 种抑制性受体，同时排除 CD69$^{+}$ 细胞，但不包含 CD39 或功能性读数，以保持简便性并避免胞内染色步骤。\n\n选择最佳选项。", "solution": "在尝试解答之前，必须评估问题陈述的有效性。\n\n**步骤1：提取给定信息**\n- **细胞类型：** 人分化簇 $8$ (CD8) T细胞。\n- **实验时间点：**\n    1.  早期激活后：$24$–$72$ 小时。\n    2.  慢性刺激：第 $21$ 天。\n- **方法：** 带有表面和胞内染色的多参数流式细胞术。\n- **可用标志物：** 程序性死亡蛋白 1 (PD-1)、T细胞免疫球蛋白和黏蛋白结构域蛋白-3 (TIM-3)、淋巴细胞活化基因 3 (LAG-3)、含Ig和ITIM结构域的T细胞免疫受体 (TIGIT)、分化簇 39 (CD39)、分化簇 101 (CD101)、分化簇 69 (CD69)、分化簇 25 (CD25)、分化簇 127 (CD127)、T细胞因子 1 (TCF-1)、胸腺细胞选择相关高迁移率族蛋白 (TOX)、Ki-67、干扰素-γ (IFN-$\\gamma$)、肿瘤坏死因子 (TNF)、白细胞介素-2 (IL-2)、颗粒酶B、CD3、CD8、CD45RA、CCR7。\n- **功能性检测：** 进行 $6$ 小时短肽再刺激，用于胞内细胞因子染色。\n- **初始圈门：** 分析始于活的、单个的、CD$3^{+}$、CD$8^{+}$ 细胞，并排除初始 (CD45RA$^{+}$ CCR7$^{+}$) 群体。\n- **基本事实：**\n    1.  急性T细胞受体 (TCR) 激活导致抑制性受体（如 PD-1、TIM-3、LAG-3、TIGIT）和活化标志物（如 CD69、CD25）的瞬时上调，同时伴有强劲的增殖 (Ki-67) 和细胞因子产生（如 IL-2、TNF），而不会导致稳定的耗竭状态。\n    2.  慢性抗原暴露导致一个持久的耗竭程序，其特征是多种抑制性受体的持续共表达、CD39 和 CD101 等标志物的高水平表达、持续的 TOX 表达以及功能受损（尤其是 IL-2 水平低）。\n    3.  在早期激活期间，单个抑制性受体阳性不是耗竭的特异性标志。\n- **目标：** 确定最佳的圈门策略，该策略能够特异性地识别慢性刺激下的耗竭T细胞，同时最大限度地减少将急性活化效应细胞错误分类为耗竭细胞。\n\n**步骤2：使用提取的给定信息进行验证**\n该问题陈述具有科学依据，使用了T细胞免疫学中的标准术语和概念。所描述的实验设置是现实且普遍执行的。所提供的“事实”准确地代表了当前关于T细胞活化与耗竭的科学共识。问题提法得当，提供了明确的目标和评估选项所需的信息。它没有歧义、矛盾和主观性语言。\n\n**步骤3：结论与行动**\n问题是有效的。可以通过对照给定的基本事实，严格评估每个提议的策略来得出解决方案。\n\n**解决方案推导**\n目标是创建一个过滤器，能够通过真正的耗竭细胞（主要在第$21$天），但拒绝急性活化的细胞（在$24$–$72$小时）。根据所提供的事实，一个稳健的策略必须整合能够区分这两种状态的多个特征。\n- **急性活化状态 ($24$–$72$h)：** PD-1$^{+/\\text{high}}$, TIM-3$^{+}$, LAG-3$^{+}$, TIGIT$^{+}$, CD69$^{\\text{high}}$, CD25$^{\\text{high}}$, Ki-67$^{\\text{high}}$, IL-2$^{\\text{high}}$, TNF$^{\\text{high}}$。关键在于这些细胞功能强大，且其表型是暂时的。\n- **慢性耗竭状态 (第 $21$ 天)：** 多种抑制性受体（如 PD-1、TIM-3、LAG-3、TIGIT）的持续共表达，CD39$^{\\text{high}}$，TOX$^{\\text{high}}$，以及功能受损 (IL-2$^{\\text{low}}$)。\n\n因此，一个成功的策略必须依赖于耗竭的稳定标志物（如CD39）和功能损伤，而不仅仅是两种状态共有的抑制性受体表达。\n\n**逐项分析**\n\n**A. 在抗原经验CD$8^{+}$ T细胞中，将“耗竭”定义为 PD-1$^{\\text{high}}$ 或 TIM-3$^{+}$，无论其活化或功能状态如何。在所有时间点，将任何满足任一条件的细胞归类为耗竭细胞。**\n这个策略存在根本性缺陷。它直接与事实1和事实3相矛盾。事实1指出，急性活化T细胞会瞬时上调PD-1和TIM-3。事实3明确说明，在早期激活窗口期，单个抑制性受体阳性对于判定耗竭不具特异性。使用“或”门控 `PD-1$^{\\text{high}}$` 或 `TIM-3$^{+}$` 是一个经典错误，会导致大量功能性的、急性活化的效应T细胞被错误分类为耗竭细胞，尤其是在 $24$–$72$ 小时的时间点。\n**结论：不正确**。\n\n**B. 在抗原经验CD$8^{+}$ T细胞中，通过一个联合圈门来定义“耗竭”：PD-1$^{\\text{high}}$ 且 CD39$^{+}$ 且 (TIM-3$^{+}$ 或 LAG-3$^{+}$ 或 TIGIT$^{+}$)，同时伴有功能损伤（定义为经过 $6$ 小时短肽再刺激后 IL-2 水平低和 TNF 水平低）；此外，在 $24$–$72$ 小时窗口期应用一个排除性子门，以移除 CD69$^{\\text{high}}$ CD25$^{\\text{high}}$ Ki-67$^{\\text{high}}$ 的事件。**\n这个策略是精细的，并且与所有提供的事实非常吻合。\n1.  **表型：** 它要求多种抑制性受体（`PD-1$^{\\text{high}}$` 以及 `TIM-3/LAG-3/TIGIT` 中的至少一种）的共表达，满足了特异性的要求（事实3）。至关重要的是，它包含了CD39，事实2中强调该标志物在慢性耗竭中富集，并且已知比瞬时表达的抑制性受体更具特异性。\n2.  **功能：** 它结合了耗竭的关键功能标志——细胞因子产生能力受损（`IL-2水平低`和`TNF水平低`），如事实2所述。这是将耗竭细胞与功能性效应细胞分开的关键步骤。\n3.  **排除急性活化：** 在早期时间点增加的排除门（`CD69$^{\\text{high}}$ CD25$^{\\text{high}}$ Ki-67$^{\\text{high}}$` 事件）直接靶向事实1中描述的急性活化细胞的特征。这主动地防止了它们的错误分类。\n这种多层次方法为慢性时间点的真正耗竭提供了最大的特异性，同时在急性时间点积极地最小化了假阳性。\n**结论：正确**。\n\n**C. 在抗原经验CD$8^{+}$ T细胞中，将“耗竭”定义为 TCF-1$^{\\text{high}}$ PD-1$^{+}$ CX3CR1$^{\\text{low}}$，而不评估共抑制性受体的共表达、CD39 或再刺激功能，以避免捕获通常为 TCF-1$^{\\text{low}}$ 的高度活化效应细胞。**\n这个策略存在几个问题。首先，标志物 CX3CR1 未包含在问题陈述提供的可用标志物列表中。这使得该选项根据问题约束在技术上是无效的。其次，更根本的是，`TCF-1$^{\\text{high}}$` `PD-1$^{+}$` 表型定义了一个被称为“祖细胞样耗竭”或“干细胞样”耗竭T细胞的特定亚群。虽然它们是耗竭图景的一部分，但它们不代表整个耗竭细胞群体，特别是那些功能丧失最严重的终末分化的、TCF-1$^{\\text{low}}$ 的效应细胞。问题要求的是识别“耗竭群体”的策略，这意味着一个更普遍的定义。这个策略过于狭窄，遗漏了终末耗竭细胞的主要组成部分。\n**结论：不正确**。\n\n**D. 将“耗竭”定义为在 PD-1、TIGIT 和细胞毒性T淋巴细胞相关蛋白 $4$ (CTLA-4) 中共表达至少 $2$ 种抑制性受体，同时排除 CD69$^{+}$ 细胞，但不包含 CD39 或功能性读数，以保持简便性并避免胞内染色步骤。**\n这个策略有多个缺陷。首先，与选项C一样，它引入了一个未在可用抗体组合列表中列出的标志物 CTLA-4。这违反了问题的前提。其次，它明确指出*避免*使用CD39和功能性读数。根据事实2，这些是慢性耗竭程序的核心特征。忽略它们会丢弃高度特异性的信息，从而削弱策略的有效性。虽然共表达抑制性受体比单标志物分析要好，但仅凭这一点是不够的，因为高度活化的细胞也可以瞬时共表达其中的几种。排除所有 `CD69$^{+}$` 细胞是一种粗略的方法，可能会错误地移除最近遇到抗原的真正耗竭细胞。选项B中的综合方法要优越得多。\n**结论：不正确**。", "answer": "$$\\boxed{B}$$", "id": "2893499"}, {"introduction": "T细胞耗竭涉及深刻的代谢重编程，使细胞从高效的氧化磷酸化转向其他代谢途径。细胞外流量分析通过测量耗氧率（$OCR$）和细胞外酸化率（$ECAR$），使我们能够量化细胞代谢。这项练习提供了解读代谢数据的实践经验，以计算呼吸控制率（$RCR$），这是线粒体健康和偶联效率的关键指标，从而将细胞表型与核心功能缺陷联系起来 [@problem_id:2893535]。", "problem": "一个研究小组正在研究表现出耗竭表型的慢性刺激CD8阳性(CD8+)T细胞的代谢重塑。他们使用细胞外流量分析仪，测量了在供给线粒体底物的情况下，通透化的耗竭CD8+ T细胞的耗氧率(OCR)和细胞外酸化率(ECAR)。注射遵循标准的线粒体压力测试步骤：加入二磷酸腺苷(ADP)以刺激呼吸作用，寡霉素(oligomycin)以抑制三磷酸腺苷(ATP)合酶并揭示质子泄漏，羰基氰化物-p-三氟甲氧基苯腙(FCCP)以解偶联并揭示最大电子传递能力，以及鱼藤酮(rotenone)加抗霉素A(antimycin A)以抑制复合体I和复合体III并揭示非线粒体耗氧。\n\n测得的OCR值（每$10^{6}$个细胞进行标准化）如下：\n- 供给底物的基础值（ADP之前）：$55$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- ADP之后：$115$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- 寡霉素之后：$60$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- FCCP之后：$150$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- 鱼藤酮 $+$ 抗霉素A之后：$22$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n\n在对相同细胞群体（完整细胞）进行的独立糖酵解压力测试配置中，ECAR值（每$10^{6}$个细胞进行标准化）如下：\n- 基础值（无葡萄糖）：$30$ mpH min$^{-1}$\n- 葡萄糖之后：$95$ mpH min$^{-1}$\n- 寡霉素之后：$140$ mpH min$^{-1}$\n- 2-脱氧葡萄糖之后：$18$ mpH min$^{-1}$\n\n假设非线粒体耗氧由加入鱼藤酮(rotenone)加抗霉素A(antimycin A)后剩余的OCR给出，并且呼吸控制率(RCR)根据经过适当背景校正的通透化细胞中ADP刺激的（磷酸化的）呼吸与泄漏呼吸的比值来定义。\n\n仅使用所提供的数据和标准的背景校正原则，计算这些耗竭CD8+ T细胞的呼吸控制率。将您的答案四舍五入至三位有效数字。将RCR报告为无单位值。然后，在您的推理过程中（但不是在最终报告的值中），结合ECAR曲线解释该值如何反映耗竭细胞中氧化磷酸化和糖酵解之间的平衡。", "solution": "所提出的问题是对细胞生物能量学的定量分析，这是细胞生物学和免疫学中的一个标准练习。该问题具有科学依据，阐述清晰，并包含唯一解所需的所有必要数据和定义。因此，该问题被认为是有效的，并将予以解决。\n\n主要任务是计算给定耗竭CD8+ T细胞群体的呼吸控制率(RCR)。RCR是衡量氧化磷酸化偶联效率的基本指标。它量化了电子传递链的耗氧过程与ATP合酶合成三磷酸腺苷(ATP)过程的偶联紧密程度。其定义为存在ATP合酶底物二磷酸腺苷(ADP)时的呼吸速率（状态$3$呼吸）与ATP合成被抑制时的呼吸速率（状态$4$或泄漏呼吸）之比。\n\n实验数据是使用细胞外流量分析仪收集的。问题指出，必须使用“标准的背景校正原则”来解释非线粒体耗氧。加入鱼藤酮(rotenone)和抗霉素A(antimycin A)后测量的耗氧率(OCR)提供了这个值。这些化合物分别抑制电子传递链的复合体I和复合体III，从而停止所有线粒体呼吸。剩余的OCR是由非线粒体耗氧酶引起的。\n\n让我们将测得的OCR值表示如下：\n- $OCR_{ADP} = 115$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- $OCR_{oligo} = 60$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n- $OCR_{rot+AA} = 22$ pmol $\\mathrm{O_{2}}$ min$^{-1}$\n\n$OCR_{rot+AA}$值代表非线粒体耗氧，必须从其他OCR测量值中减去该值，以分离出线粒体部分。\n令 $OCR_{non-mito} = OCR_{rot+AA} = 22$ pmol $\\mathrm{O_{2}}$ min$^{-1}$。\n\nADP刺激的呼吸速率，我们将其表示为$R_{3}$（代表状态$3$），是在过量底物和ADP存在下的线粒体耗氧量。其计算方法是用加入ADP后测得的总OCR减去非线粒体部分。\n$$R_{3} = OCR_{ADP} - OCR_{non-mito}$$\n代入给定值：\n$$R_{3} = 115 - 22 = 93 \\text{ pmol O}_{2} \\text{ min}^{-1}$$\n\n泄漏呼吸速率，我们将其表示为$R_{4}$（代表状态$4$），是未与ATP合成偶联的线粒体耗氧量。它是通过用寡霉素(oligomycin)抑制ATP合酶来测量的。在这种条件下消耗的氧气主要用于抵消质子穿过线粒体内膜的泄漏。该速率的计算方法是用加入寡霉素(oligomycin)后测得的总OCR减去非线粒体部分。\n$$R_{4} = OCR_{oligo} - OCR_{non-mito}$$\n代入给定值：\n$$R_{4} = 60 - 22 = 38 \\text{ pmol O}_{2} \\text{ min}^{-1}$$\n\n呼吸控制率(RCR)定义为这两个速率的比值。\n$$RCR = \\frac{R_{3}}{R_{4}}$$\n代入计算出的$R_{3}$和$R_{4}$的值：\n$$RCR = \\frac{93}{38} \\approx 2.447368...$$\n\n问题要求答案四舍五入到三位有效数字。\n$$RCR \\approx 2.45$$\n\nRCR是一个无量纲的量。计算出的约$2.45$这个值相当低。对于健康、偶联良好的线粒体，RCR值通常要高得多，常在$4$到$10$或更高的范围内，这表明大部分质子动力被有效地用于ATP合成。如此处观察到的低RCR值，表明偶联不良和线粒体功能障碍。这意味着呼吸作用产生的能量有很大一部分以热量的形式耗散掉，用于补偿质子泄漏，而不是转化为ATP的化学能。\n\n这一线粒体功能障碍的发现必须在细胞整体代谢谱的背景下进行解释，为此提供了细胞外酸化率(ECAR)的数据。ECAR是糖酵解速率的一个代表指标。数据显示：\n- 初始ECAR: $30$ mpH min$^{-1}$\n- 加入葡萄糖后，基础糖酵解导致ECAR为$95$ mpH min$^{-1}$。净糖酵解速率为$95 - 30 = 65$ mpH min$^{-1}$。\n- 加入寡霉素(oligomycin)后，它抑制了氧化磷酸化，迫使细胞依赖糖酵解获取ATP，ECAR增加到最大值$140$ mpH min$^{-1}$。这代表了细胞的最大糖酵解能力。\n- 糖酵解储备是最大能力与基础速率之差，为$140 - 95 = 45$ mpH min$^{-1}$。\n\n耗竭的CD8+ T细胞表现出显著的基础糖酵解速率，并且在氧化磷酸化受阻时还具备进一步提高糖酵解的储备能力。低RCR（表明线粒体效率低下、解偶联）和对糖酵解的高度依赖相结合，是T细胞耗竭的典型代谢特征。这些细胞无法通过高效的氧化磷酸化来满足能量需求，被迫上调效率低得多的糖酵解途径。这种代谢重编程是导致耗竭T细胞功能缺陷的核心机制。所提供的数据定量地验证了这一已确立的免疫学原理。", "answer": "$$\\boxed{2.45}$$", "id": "2893535"}, {"introduction": "现代免疫学研究产生了海量的多参数数据集，需要计算方法来综合信息。主成分分析（$PCA$）是一种强大的无监督学习技术，可以降低数据维度并识别主要的变异轴。在这项练习中，您将实施一个分析流程，以构建一个结合了表型和功能标志物的数据驱动“耗竭轴”，学习如何将统计模式与生物学假设对齐 [@problem_id:2893592]。", "problem": "您的任务是基于标准免疫学标志物，形式化并计算T细胞的数据驱动耗竭轴。在T细胞耗竭与功能障碍的情况下，程序性死亡蛋白1（PD-1）的平均荧光强度（MFI）随耗竭程度增加而增加，而细胞因子产生和增殖指数则减少。从核心定义和经过充分检验的事实出发，您的程序必须实现以下流程。\n\n1. 对每个样本使用以下特征集：\n   - PD-1 MFI，记为 $x_{\\mathrm{PD1}}$，\n   - 细胞因子计数，记为 $x_{\\mathrm{CYT}}$，\n   - 增殖指数，记为 $x_{\\mathrm{PROL}}$。\n   将这些特征排列成一个数据矩阵 $X \\in \\mathbb{R}^{n \\times 3}$，其列的顺序为 $(x_{\\mathrm{PD1}}, x_{\\mathrm{CYT}}, x_{\\mathrm{PROL}})$。\n\n2. 对每个特征（列），使用样本均值和样本标准差计算$z$-score标准化。对于值为 $\\{x_{1j}, \\dots, x_{nj}\\}$ 的第 $j$ 列，定义样本均值 $\\mu_j = \\frac{1}{n}\\sum_{i=1}^n x_{ij}$，样本标准差 $\\sigma_j = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^n (x_{ij}-\\mu_j)^2}$，以及对于所有 $\\sigma_j \\neq 0$ 的 $i$，标准化值为 $z_{ij} = \\frac{x_{ij}-\\mu_j}{\\sigma_j}$。如果 $\\sigma_j = 0$，则将该列中所有 $i$ 的 $z_{ij}$ 设为 $0$。将所得矩阵记为 $Z$。\n\n3. 将各样本的耗竭元评分向量 $s \\in \\mathbb{R}^n$ 定义为标准化特征的线性组合：\n   $$ s = Z \\, w, \\quad \\text{其中 } w = \\begin{bmatrix} 1 \\\\ -1 \\\\ -1 \\end{bmatrix}. $$\n   这一选择编码了一个免疫学事实：较高的PD-1 MFI会增加耗竭程度，而较高的细胞因子产生和较高的增殖水平会降低耗竭程度。\n\n4. 使用样本协方差矩阵对 $Z$ 进行主成分分析（PCA）：\n   $$ S = \\frac{1}{n-1} Z^\\top Z. $$\n   令 $(\\lambda_k, v_k)$ 表示 $S$ 的特征对，其中 $v_k \\in \\mathbb{R}^3$ 且 $\\lambda_k \\in \\mathbb{R}_{\\ge 0}$，满足 $S v_k = \\lambda_k v_k$。对每个 $k$，计算主成分得分向量 $t_k = Z v_k \\in \\mathbb{R}^n$。\n\n5. 对每个主成分 $k$，计算 $t_k$ 和 $s$ 之间的样本皮尔逊相关系数：\n   $$ r_k = \\frac{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)(s_i - \\bar{s})}{\\sqrt{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)^2} \\, \\sqrt{\\sum_{i=1}^n (s_i - \\bar{s})^2}}, $$\n   其中 $\\bar{t}_k = \\frac{1}{n}\\sum_{i=1}^n t_{k,i}$ 且 $\\bar{s} = \\frac{1}{n}\\sum_{i=1}^n s_i$。由于 $Z$ 在构建时已按列中心化，因此每个 $t_k$ 和 $s$ 也都是中心化的，但为了保持通用性，您必须按所写公式实现。\n\n6. 选择使 $|r_k|$ 最大化的主成分 $k^\\star$。为解决特征向量固有的符号不确定性问题，需要定向所选主成分，使其与 $s$ 的相关性为非负：如果 $r_{k^\\star} < 0$，则将 $v_{k^\\star}$ 替换为 $-v_{k^\\star}$，并将 $t_{k^\\star}$ 替换为 $-t_{k^\\star}$，这样最终报告的相关性为 $r^\\star = |r_{k^\\star}|$。\n\n您的程序必须将上述流程应用于下面的每个数据集。无需报告物理单位，也没有角度量。最终答案必须是数值浮点数。\n\n测试套件数据集（每行为一个样本，列为 $(x_{\\mathrm{PD1}}, x_{\\mathrm{CYT}}, x_{\\mathrm{PROL}})$）：\n- 数据集 A ($n = 6$):\n  [\n   [$12000$, $400$, $0.72$],\n   [$15000$, $320$, $0.60$],\n   [$18000$, $260$, $0.50$],\n   [$21000$, $200$, $0.41$],\n   [$24000$, $160$, $0.35$],\n   [$27000$, $140$, $0.30$]\n  ]\n- 数据集 B ($n = 5$)，含一个零方差特征：\n  [\n   [$10000$, $200$, $0.65$],\n   [$11000$, $200$, $0.60$],\n   [$13000$, $200$, $0.55$],\n   [$17000$, $200$, $0.40$],\n   [$19000$, $200$, $0.35$]\n  ]\n- 数据集 C ($n = 7$)，细胞因子和增殖之间存在强共線性：\n  [\n   [$8000$, $500$, $0.80$],\n   [$10000$, $480$, $0.76$],\n   [$14000$, $400$, $0.60$],\n   [$16000$, $300$, $0.45$],\n   [$15500$, $320$, $0.48$],\n   [$18000$, $260$, $0.39$],\n   [$20000$, $200$, $0.30$]\n  ]\n\n您的程序必须：\n- 使用如上定义的样本标准差，为每个特征实现$z$-score标准化，并带有零方差保护措施。\n- 计算耗竭元评分 $s$。\n- 通过对 $S$ 进行特征分解来执行PCA。\n- 为每个主成分计算 $r_k$，并选择具有最大 $|r_k|$ 的 $k^\\star$。\n- 定向所选主成分以产生 $r^\\star \\ge 0$。\n- 对每个数据集，输出最终的非负相关性 $r^\\star$，形式为精确到 $6$ 位小数的浮点数。\n\n最终输出格式：您的程序应生成单行输出，其中包含按顺序排列的数据集A、数据集B和数据集C的结果，形式为方括号内以逗号分隔的列表，例如 $[r_A, r_B, r_C]$，其中每个条目在小数点后都恰好有 $6$ 位数字。", "solution": "问题陈述需经过验证。\n\n**步骤1：提取已知条件**\n- **特征**：$x_{\\mathrm{PD1}}$ (PD-1 MFI)，$x_{\\mathrm{CYT}}$ (细胞因子计数)，$x_{\\mathrm{PROL}}$ (增殖指数)。\n- **数据矩阵**：$X \\in \\mathbb{R}^{n \\times 3}$，其列的顺序为 $(x_{\\mathrm{PD1}}, x_{\\mathrm{CYT}}, x_{\\mathrm{PROL}})$。\n- **$z$-score标准化**：对于第 $j$ 列，样本均值为 $\\mu_j = \\frac{1}{n}\\sum_{i=1}^n x_{ij}$，样本标准差为 $\\sigma_j = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^n (x_{ij}-\\mu_j)^2}$。标准化值为 $z_{ij} = \\frac{x_{ij}-\\mu_j}{\\sigma_j}$ (当 $\\sigma_j \\neq 0$)。如果 $\\sigma_j = 0$，则所有 $i$ 的 $z_{ij} = 0$。所得矩阵为 $Z$。\n- **耗竭元评分**：$s = Z \\, w$，其中权重向量 $w = \\begin{bmatrix} 1 \\\\ -1 \\\\ -1 \\end{bmatrix}$。\n- **主成分分析 (PCA)**：基于样本协方差矩阵 $S = \\frac{1}{n-1} Z^\\top Z$。特征对为 $(\\lambda_k, v_k)$，满足 $S v_k = \\lambda_k v_k$。主成分得分向量为 $t_k = Z v_k$。\n- **皮尔逊相关性**：$r_k = \\frac{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)(s_i - \\bar{s})}{\\sqrt{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)^2} \\, \\sqrt{\\sum_{i=1}^n (s_i - \\bar{s})^2}}$，其中 $\\bar{t}_k$ 和 $\\bar{s}$ 是样本均值。\n- **主成分选择**：选择使 $|r_k|$ 最大化的 $k^\\star$。所选主成分被定向，使其与 $s$ 的相关性为非负，得到 $r^\\star = |r_{k^\\star}|$。\n- **数据**：提供了三个数据集（A、B、C），形式为数值矩阵。\n- **输出**：对每个数据集，计算 $r^\\star$ 并以精确到 $6$ 位小数的浮点数报告。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在免疫学和生物统计学方面有充分的依据。T细胞耗竭与PD-1表达呈正相关，与细胞因子产生和增殖呈负相关，这一前提是该领域的基石。由$z$-标准化、PCA和相关性分析组成的分析流程，包含了研究多变量生物数据的标准且适当的统计方法。\n- **适定性**：该问题提供了一个清晰的、确定性的算法。所有数学运算都有明确定义。处理了零方差的特殊情况，确保该过程对所提供的数据集B不会失败。主成分的选择标准是明确的。算法的适定性保证了解的存在性和唯一性。\n- **客观性**：问题以精确的、定量的术语陈述，不含主观或推测性内容。耗竭评分的构建基于既定的生物学原理，并作为模型的已知条件给出。\n\n**步骤3：结论与行动**\n此问题被判定为有效。它在科学上是合理的，数学上是严谨的，并且在算法上是完整的。不存在会妨碍唯一解的矛盾、歧义或信息缺失。我将继续提供一个完整的、有理有据的解答。\n\n目标是形式化并计算T细胞耗竭的一个主轴。这是通过将一个受生物学信息启发的线性模型与一个数据驱动的降维技术相结合来实现的。该过程旨在识别出数据中与预定义耗竭特征最一致的主要变异方向。\n\n该分析流程按几个逻辑步骤进行。\n\n**1. 数据标准化**\n生物数据特征通常具有不同的单位和尺度（例如，荧光强度与无量纲指数）。为了在后续的基于距离和基于方差的分析（如PCA）中同等对待每个特征，我们必须首先对数据进行标准化。问题指定了对数据矩阵 $X$ 的每个特征列 $j$ 进行$z$-score标准化。给定 $n$ 个样本，计算样本均值 $\\mu_j$ 和样本标准差 $\\sigma_j$：\n$$ \\mu_j = \\frac{1}{n}\\sum_{i=1}^n x_{ij} $$\n$$ \\sigma_j = \\sqrt{\\frac{1}{n-1}\\sum_{i=1}^n (x_{ij}-\\mu_j)^2} $$\n在 $\\sigma_j$ 的分母中使用 $n-1$ 提供了对总体方差的无偏估计。标准化矩阵 $Z$ 的元素为 $z_{ij}$：\n$$ z_{ij} = \\frac{x_{ij}-\\mu_j}{\\sigma_j} $$\n此变换将每个特征中心化，使其均值为 $0$，并将其缩放，使其标准差为 $1$。一个关键的边界情况是当某个特征的方差为零时，即 $\\sigma_j = 0$。在这种情况下，按照指示， $Z$ 中相应的列将全部设置为零，从而有效地使其不对方差产生贡献。\n\n**2. 构建耗竭元评分**\n一个简化的、但在免疫学上合理的T细胞耗竭模型被定义为标准化特征的线性组合。耗竭元评分向量 $s \\in \\mathbb{R}^n$ 计算如下：\n$$ s = Z w $$\n其权重向量 $w$ 由下式给出：\n$$ w = \\begin{bmatrix} 1 \\\\ -1 \\\\ -1 \\end{bmatrix} $$\n这种构建编码了生物学先验知识：耗竭随PD-1表达（$x_{\\mathrm{PD1}}$，权重为 $+1$）的增加而增加，并随细胞因子产生（$x_{\\mathrm{CYT}}$，权重为 $-1$）和增殖（$x_{\\mathrm{PROL}}$，权重为 $-1$）的增加而减少。该向量 $s$ 代表一个“目标”耗竭特征。\n\n**3. 主成分分析 (PCA)**\nPCA是一种在数据集中寻找最大方差的正交轴的技术。它揭示了数据的潜在结构，而无需参考任何外部变量。分析是在标准化数据矩阵 $Z$ 上进行的。样本协方差矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$ 的计算方法如下：\n$$ S = \\frac{1}{n-1} Z^\\top Z $$\n由于 $Z$ 的列是均值中心化的，这是计算样本协方差矩阵的正确公式。主轴是 $S$ 的特征向量 $v_k$，通过求解特征值问题得到：\n$$ S v_k = \\lambda_k v_k $$\n特征向量 $v_k$ 是主方向，相应的特征值 $\\lambda_k$ 代表数据在这些方向上投影的方差。主成分得分向量 $t_k \\in \\mathbb{R}^n$ 是数据在由主轴定义的新基底下的坐标：\n$$ t_k = Z v_k $$\n\n**4. 将主成分与耗竭特征对齐**\n下一步是确定哪个主成分（代表内在的方差方向）与我们外在的、基于生物学定义的耗竭元评分 $s$ 最为一致。这种一致性通过计算每个主成分得分向量 $t_k$ 和向量 $s$ 之间的样本皮尔逊相关系数 $r_k$ 来量化。\n$$ r_k = \\frac{\\text{Cov}(t_k, s)}{\\sigma_{t_k} \\sigma_s} = \\frac{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)(s_i - \\bar{s})}{\\sqrt{\\sum_{i=1}^n (t_{k,i} - \\bar{t}_k)^2} \\, \\sqrt{\\sum_{i=1}^n (s_i - \\bar{s})^2}} $$\n由于 $Z$ 的列是均值中心化的，向量 $t_k$ 和 $s$（它们是这些列的线性组合）也是均值中心化的，即 $\\bar{t}_k=0$ 和 $\\bar{s}=0$。然而，通用公式是稳健的。接近 $+1$ 或 $-1$ 的相关系数 $r_k$ 表示存在强线性关系。\n\n**5. 最终耗竭轴的选择与定向**\n通过找到使相关性绝对值 $|r_k|$ 最大化的索引 $k^\\star$，可以识别出与耗竭特征最共线的主成分：\n$$ k^\\star = \\underset{k}{\\operatorname{argmax}} \\, |r_k| $$\n特征向量的定义只到符号为止。将特征向量 $v_k$ 的符号翻转为 $-v_k$ 将会使相应得分 $t_k$ 的符号翻转为 $-t_k$，从而也翻转相关系数 $r_k$ 的符号。为了提供一个规范化的结果，所选主成分被定向为与 $s$ 具有非负相关性。如果 $r_{k^\\star}  0$，我们用 $-v_{k^\\star}$ 替换 $v_{k^\\star}$。最终的一致性度量是由此产生的非负相关性：\n$$ r^\\star = |r_{k^\\star}| $$\n这个值 $r^\\star$ 表示由元评分向量 $s$ 张成的空间与由所选主成分向量 $t_{k^\\star}$ 张成的空间之间的最小夹角的余弦值。一个接近 $1$ 的值表示数据中的主要变异轴与耗竭的生物学模型几乎完全一致。\n\n至此，流程完成。实现现在将对给定的数据集通过计算执行这些步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to process datasets and print the final results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"A\": [\n            [12000, 400, 0.72],\n            [15000, 320, 0.60],\n            [18000, 260, 0.50],\n            [21000, 200, 0.41],\n            [24000, 160, 0.35],\n            [27000, 140, 0.30]\n        ],\n        \"B\": [\n            [10000, 200, 0.65],\n            [11000, 200, 0.60],\n            [13000, 200, 0.55],\n            [17000, 200, 0.40],\n            [19000, 200, 0.35]\n        ],\n        \"C\": [\n            [8000, 500, 0.80],\n            [10000, 480, 0.76],\n            [14000, 400, 0.60],\n            [16000, 300, 0.45],\n            [15500, 320, 0.48],\n            [18000, 260, 0.39],\n            [20000, 200, 0.30]\n        ]\n    }\n\n    results = []\n    # The datasets are processed in the specified order: A, B, C.\n    for key in sorted(test_cases.keys()):\n        data = test_cases[key]\n        r_star = calculate_exhaustion_axis_correlation(data)\n        results.append(f\"{r_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_exhaustion_axis_correlation(X_list):\n    \"\"\"\n    Applies the full data analysis pipeline to a single dataset.\n    \n    Args:\n        X_list (list): A list of lists representing the data matrix X.\n\n    Returns:\n        float: The final non-negative correlation r_star.\n    \"\"\"\n    X = np.array(X_list, dtype=np.float64)\n    n, p = X.shape\n\n    # 1. z-score normalization\n    mu = np.mean(X, axis=0)\n    # Use ddof=1 for sample standard deviation (denominator n-1)\n    sigma = np.std(X, axis=0, ddof=1)\n    \n    Z = np.zeros_like(X)\n    for j in range(p):\n        if sigma[j] != 0:\n            Z[:, j] = (X[:, j] - mu[j]) / sigma[j]\n    \n    # 2. Exhaustion meta-score\n    w = np.array([1, -1, -1])\n    s = Z @ w\n\n    # 3. Principal Component Analysis (PCA)\n    # Covariance matrix of Z\n    if n  2:\n        # Cannot compute covariance for n  2\n        return 0.0\n    S = (Z.T @ Z) / (n - 1)\n    \n    # Eigen-decomposition. eigh is used for symmetric matrices.\n    eigenvalues, eigenvectors = np.linalg.eigh(S)\n\n    # 4. Compute correlations\n    correlations_k = []\n    for k in range(p):\n        v_k = eigenvectors[:, k]\n        t_k = Z @ v_k\n        \n        # Guard against zero-variance principal components\n        if np.std(t_k, ddof=1)  1e-12:\n            r_k = 0.0\n        else:\n            # np.corrcoef implements the Pearson correlation formula\n            # It returns a 2x2 matrix, we need the off-diagonal element\n            r_k = np.corrcoef(t_k, s)[0, 1]\n            # Handle potential NaN from constant vectors, although already guarded\n            if np.isnan(r_k):\n                r_k = 0.0\n        \n        correlations_k.append(r_k)\n\n    # 5. Select component and find final correlation r_star\n    abs_correlations = np.abs(correlations_k)\n    r_star = np.max(abs_correlations)\n    \n    return r_star\n\n# Execute the main function\nsolve()\n```", "id": "2893592"}]}