{"hands_on_practices": [{"introduction": "理解复杂生物系统的一个有效方法是观察移除或禁用某个组分后系统的行为。本练习 [@problem_id:2873658] 模拟了一个基因工程实验，旨在检验您对分拣接头蛋白 TRAM 和 TIRAP 在 TLR4 信号通路中各自独特作用的理解。通过预测一个关键蛋白功能丧失的后果，您可以巩固对信号通路空间分隔基本原则的认识。", "problem": "一名实验室工程师使用成簇规律间隔短回文重复序列 (CRISPR) 技术，在TRIF相关衔接分子 (TRAM) 的位置$2$引入了甘氨酸到丙氨酸的取代 (G$2$A)，该取代废除了其N端豆蔻酰化。经编辑的人源单核细胞衍生的巨噬细胞表达内源性水平的所有Toll样受体4 (TLR4) 通路组分，包括TLR4、CD$14$、髓系分化初级反应蛋白88 (MyD88)、含Toll-白细胞介素-$1$受体结构域的诱导干扰素-β的衔接蛋白 (TRIF) 以及含Toll-白细胞介素-$1$受体结构域的衔接蛋白 (TIRAP，也称为Mal)。使用单次脉冲的脂多糖 (LPS) 进行刺激，并在早期和晚期时间点测量下游读数。\n\n基础知识：\n- Toll样受体 (TLRs) 的模式识别将配体结合与胞质衔接蛋白的招募耦合起来，从而启动信号级联。TLR4可以启动两个分支：\n  - 一个髓系分化初级反应蛋白88 (MyD88) 依赖性分支，由TIRAP在质膜上搭建支架，激活活化B细胞的核因子κ轻链增强子 (NF-κB) 和激活蛋白$1$ (AP-$1$)，诱导肿瘤坏死因子 (TNF) 和白细胞介素-$6$ (IL-$6$)。\n  - 一个含Toll-白细胞介素-$1$受体结构域的诱导干扰素-β的衔接蛋白 (TRIF) 依赖性分支，需要TLR4的内吞作用以及在内体膜上组装TRAM–TRIF复合物，以激活TANK结合激酶$1$ (TBK$1$)、干扰素调节因子3 (IRF3) 和I型干扰素（如干扰素-β (IFN-β)）以及干扰素刺激基因 (ISGs)（如CXCL$10$）。\n- N端甘氨酸豆蔻酰化是一种膜靶向修饰，是某些衔接蛋白与细胞膜的胞质小叶稳定结合所必需的。\n\n在工程改造的细胞中，LPS刺激后进行了以下测量：NF-κB p$65$的早期核转位、TBK$1$和IRF3的磷酸化，以及IFN-β、CXCL$10$和TNF的mRNA诱导。细胞活力和LPS结合与野生型细胞相比确认没有变化。\n\n下列哪种模式最能预测TRAM豆蔻酰化缺陷突变体在响应LPS时的先天免疫信号传导后果？\n\nA. 早期NF-κB p$65$核转位和TNF诱导与野生型相当，而TBK$1$/IRF3磷酸化以及IFN-β/CXCL$10$转录本显著减少。\n\nB. 由于TLR4内吞作用失败，NF-κB和IRF3的激活均被废除，导致TNF、IFN-β和CXCL$10$几乎完全丧失。\n\nC. LPS诱导的IFN-β和CXCL$10$没有变化，因为TIRAP补偿了TRAM豆蔻酰化的丧失，从而将TRIF招募到TLR4。\n\nD. IFN-β和CXCL$10$被增强，因为当胞质TRAM未被隔离在膜上时，它能更有效地与TRIF结合，导致TBK$1$/IRF3激活增加。", "solution": "必须首先验证问题陈述的科学严谨性、一致性和清晰度。\n\n该问题描述了一个分子免疫学实验。我将逐字提取给定信息以开始验证过程。\n\n**步骤1：提取已知信息**\n-   使用成簇规律间隔短回文重复序列 (CRISPR) 修饰，在TRIF相关衔接分子 (TRAM) 的位置$2$引入甘氨酸到丙氨酸的取代 (G$2$A)。\n-   该G$2$A取代废除了TRAM的N端豆蔻酰化。\n-   实验使用人源单核细胞衍生的巨噬细胞，这些细胞表达内源性水平的Toll样受体4 (TLR4)、CD$14$、髓系分化初级反应蛋白88 (MyD88)、含Toll-白细胞介素-$1$受体结构域的诱导干扰素-β的衔接蛋白 (TRIF) 以及含Toll-白细胞介素-$1$受体结构域的衔接蛋白 (TIRAP，也称为Mal)。\n-   脂多糖 (LPS) 是刺激物。\n-   测量的读数包括：NF-κB p$65$的早期核转位、TBK$1$和IRF3的磷酸化，以及IFN-β、CXCL$10$和TNF的mRNA诱导。\n-   对照测量确认细胞活力和LPS结合没有变化。\n-   基础知识1：TLR4启动两个信号分支。\n    -   一个MyD88依赖性分支，由TIRAP在质膜上搭建支架，激活活化B细胞的核因子κ轻链增强子 (NF-κB) 和激活蛋白$1$ (AP-$1$)，诱导肿瘤坏死因子 (TNF) 和白细胞介素-$6$ (IL-$6$)。\n    -   一个TRIF依赖性分支，需要TLR4的内吞作用、在内体膜上组装TRAM–TRIF复合物、激活TANK结合激酶$1$ (TBK$1$) 和干扰素调节因子3 (IRF3)，并诱导I型干扰素（如干扰素-β (IFN-β)）和干扰素刺激基因 (ISGs)（如CXCL$10$）。\n-   基础知识2：N端甘氨酸豆蔻酰化是一种膜靶向修饰，是某些蛋白与细胞膜稳定结合所必需的。\n\n**步骤2：使用提取的已知信息进行验证**\n问题陈述具有科学依据且表述清晰。对TLR4信号传导的描述，包括MyD88依赖性和TRIF依赖性通路在空间和时间上的分离，与已确立的免疫学原理一致。分拣衔接蛋白TIRAP和TRAM的作用描述正确。实验扰动——通过G$2$A突变废除N-豆蔻酰化——是细胞生物学中研究蛋白质定位的一种标准且有效的方法。G$2$A突变特异性地阻止了N-豆蔻酰转移酶的作用，该酶需要一个N端甘氨酸。基础知识为推导解决方案提供了一个自洽的框架。该问题是客观的，没有矛盾，并包含足够的信息来确定唯一的结果。\n\n**步骤3：结论与行动**\n该问题有效。我现在将继续推导解决方案。\n\n问题的核心在于理解废除TRAM的N端豆蔻酰化的后果。\n\n1.  **扰动及其直接影响**：TRAM中的G$2$A突变阻止了其N端豆蔻酰化。所提供的基础知识指出，此修饰是与细胞膜稳定结合所必需的。因此，突变的G$2$A-TRAM蛋白将无法定位于任何细胞膜，包括质膜和内体膜。它将保持为一种可溶的胞质蛋白。\n\n2.  **TRIF依赖性通路的分析**：基础知识明确指出，TRIF依赖性通路需要在**内体膜**上组装TRAM–TRIF复合物。这种组装对于将胞质衔接蛋白TRIF招募到内吞的TLR4受体至关重要。TRAM作为桥接或分拣衔接蛋白，将膜结合受体与下游信号传导机制连接起来。由于突变的G$2$A-TRAM无法定位于内体膜，它不能执行此功能。内吞的TLR4与TRIF之间的联系被打破。因此，整个TRIF依赖性信号级联将被严重损害或消除。该通路的下游事件——TBK$1$和IRF3的激活（磷酸化），以及随后IFN-β和ISG CXCL$10$的转录诱导——将显著减少。\n\n3.  **MyD88依赖性通路的分析**：基础知识指出，MyD88依赖性通路是由另一种分拣衔接蛋白TIRAP在**质膜**上搭建支架的。该通路在LPS与细胞表面的TLR4结合后立即运作，导致NF-κB的早期激活和促炎细胞因子（如TNF）的诱导。问题中描述的基因改造是针对TRAM的。MyD88通路的组分，包括TIRAP、MyD88和TLR4本身，都不受影响。由于TRAM不参与这个早期的、基于质膜的信号分支，MyD88依赖性通路应该能正常运作。因此，预计早期NF-κB p$65$核转位和随后的TNF mRNA诱导将与野生型细胞相当。\n\n4.  **综合预测**：\n    -   MyD88依赖性信号传导（早期）：正常。这意味着正常的早期NF-κB p$65$核转位和正常的TNF mRNA诱导。\n    -   TRIF依赖性信号传导（晚期）：有缺陷。这意味着TBK1/IRF3的磷酸化显著减少，以及IFN-β和CXCL$10$的mRNA诱导显著减少。\n\n现在，我将根据此推导评估每个选项。\n\n**A. 早期NF-κB p$65$核转位和TNF诱导与野生型相当，而TBK$1$/IRF3磷酸化以及IFN-β/CXCL$10$转录本显著减少。**\n该陈述与推导出的后果完全一致。它正确地指出，MyD88依赖性通路（早期NF-κB, TNF）是完整的，而TRIF依赖性通路（TBK1/IRF3, IFN-β/CXCL$10$）由于TRAM定位失败而存在缺陷。\n**结论：正确。**\n\n**B. 由于TLR4内吞作用失败，NF-κB和IRF3的激活均被废除，导致TNF、IFN-β和CXCL$10$几乎完全丧失。**\n这是不正确的，原因有二。首先，介导早期NF-κB激活和TNF产生的MyD88依赖性通路独立于TRAM，应该不受影响。其次，该突变影响的是TRAM的膜锚定，而不是TLR4内吞作用过程本身。问题陈述其他细胞过程（如LPS结合）是正常的，没有理由假设内吞作用会失败。\n**结论：不正确。**\n\n**C. LPS诱导的IFN-β和CXCL$10$没有变化，因为TIRAP补偿了TRAM豆蔻酰化的丧失，从而将TRIF招募到TLR4。**\n这是不正确的。分拣衔接蛋白TIRAP和TRAM具有由其定位和结合伴侣定义的独特、非冗余的作用。TIRAP定位于质膜，并在MyD88通路中起作用。TRAM则是在内体中为TRIF通路所必需。没有公认的生物学机制表明TIRAP会在不同的细胞区室和信号通路中补偿TRAM的功能。这个前提在生物学上是没有根据的。\n**结论：不正确。**\n\n**D. IFN-β和CXCL$10$被增强，因为当胞质TRAM未被隔离在膜上时，它能更有效地与TRIF结合，导致TBK$1$/IRF3激活增加。**\n这是不正确的。信号转导严重依赖于信号复合物的空间组织。TRIF依赖性信号源于内体膜内的TLR4受体。为了让TRAM和TRIF接收这个信号，它们必须被招募到这个特定位置。一个可溶的、胞质的TRAM-TRIF复合物将与上游受体断开连接，因此没有功能。破坏正确定位总是导致功能丧失，而不是增强。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2873658"}, {"introduction": "在接头蛋白定位概念的基础上，本练习 [@problem_id:2873589] 将深入探讨其背后的生物物理学原理。我们将运用一个简单的结合平衡模型，量化分析配体（如质膜上的 $\\mathrm{PI(4,5)P_2}$）的可得性和蛋白亲和力等因素如何精确调控 TIRAP 这类接头蛋白的膜募集过程。这有助于将抽象的“定位”概念转化为具体的、可计算的物理量。", "problem": "Toll样受体（TLR）信号通路的一个核心特征是衔接蛋白招募的空间调控。在质膜上，含有Toll/白细胞介素-1受体域的衔接蛋白（TIRAP）与磷脂酰肌醇4,5-二磷酸（PI(4,5)P$_2$）结合，从而定位并招募骨髓分化初级反应蛋白88（MyD88），以进行MyD88依赖性信号传导。当Toll样受体4（TLR4）通过内吞作用进入内体后，含有TIR结构域的诱导干扰素-β的衔接蛋白（TRIF）依赖性信号通路占主导地位，这一转变通常与磷脂酶C（PLC）介导的质膜上PI(4,5)P$_2$的耗尽有关。假设TIRAP通过单个位点与PI(4,5)P$_2$以$1{:}1$的可逆平衡方式结合，该平衡由解离常数$K_{D}$表征，并且PI(4,5)P$_2$相对于TIRAP是大量过量的，因此游离配体浓度等于总配体浓度。在稳态下，膜结合的TIRAP的分数等于平衡时与PI(4,5)P$_2$结合的TIRAP的分数。\n\n从解离常数$K_{D}$的定义和$1{:}1$结合反应的质量作用定律出发，在$[L]$因结合而没有可测量耗尽的假设下，推导出结合分数关于游离配体浓度$[L]$和$K_{D}$的表达式。然后使用以下科学上合理的参数：\n\n- 基线（质膜，野生型TIRAP）：PI(4,5)P$_2$有效浓度$[L]_{0} = 5\\ \\mu\\mathrm{M}$，以及$K_{D,\\mathrm{wt}} = 2\\ \\mu\\mathrm{M}$。\n- 在与内体转变相关的PLC激活后，一个工程改造的TIRAP变体表现出增强的膜亲和力：PI(4,5)P$_2$有效浓度$[L]_{1} = 1.25\\ \\mu\\mathrm{M}$，以及$K_{D,\\mathrm{mut}} = 0.8\\ \\mu\\mathrm{M}$。\n\n计算稳态下膜结合TIRAP分数的倍数变化，该倍数变化定义为在配体耗尽条件下工程改造变体的结合分数与在基线条件下野生型的结合分数之比。将最终答案表示为无单位的最简分数。不要四舍五入。", "solution": "质膜上的MyD88依赖性组装受含有Toll/白细胞介素-1受体域的衔接蛋白（TIRAP）的膜定位调控，TIRAP与磷脂酰肌醇4,5-二磷酸（PI(4,5)P$_2$）结合。我们使用一个$1{:}1$可逆结合平衡来对此进行建模：\n$$\nE + L \\rightleftharpoons EL,\n$$\n其中$E$表示游离的TIRAP，$L$表示游离的PI(4,5)P$_2$，$EL$表示膜结合的复合物。根据质量作用定律，解离常数定义为\n$$\nK_{D} \\equiv \\frac{[E][L]}{[EL]}.\n$$\n设TIRAP的总浓度为$[E]_{\\mathrm{tot}} = [E] + [EL]$。结合的（也就是与膜相关的）TIRAP的分数是\n$$\nf \\equiv \\frac{[EL]}{[E]_{\\mathrm{tot}}} = \\frac{[EL]}{[E] + [EL]}.\n$$\n根据$K_{D}$的定义，我们有$[EL] = \\frac{[E][L]}{K_{D}}$。代入$f$的分母，得到\n$$\nf = \\frac{[EL]}{[E] + [EL]} = \\frac{\\frac{[E][L]}{K_{D}}}{[E] + \\frac{[E][L]}{K_{D}}} = \\frac{\\frac{[L]}{K_{D}}}{1 + \\frac{[L]}{K_{D}}}.\n$$\n在PI(4,5)P$_2$大量过量的假设下，游离配体浓度$[L]$约等于总配体浓度，因此结合分数简化为\n$$\nf = \\frac{[L]}{[L] + K_{D}}.\n$$\n我们现在计算在两种指定条件下的结合分数。\n\n基线（野生型）：\n$$\n[L]_{0} = 5\\ \\mu\\mathrm{M}, \\quad K_{D,\\mathrm{wt}} = 2\\ \\mu\\mathrm{M} \\quad \\Rightarrow \\quad f_{0} = \\frac{[L]_{0}}{[L]_{0} + K_{D,\\mathrm{wt}}} = \\frac{5}{5 + 2} = \\frac{5}{7}.\n$$\n\n配体耗尽，工程改造的变体：\n$$\n[L]_{1} = 1.25\\ \\mu\\mathrm{M}, \\quad K_{D,\\mathrm{mut}} = 0.8\\ \\mu\\mathrm{M}.\n$$\n将这些表示为有理数很方便：\n$$\n[L]_{1} = \\frac{5}{4}, \\quad K_{D,\\mathrm{mut}} = \\frac{4}{5}.\n$$\n那么\n$$\nf_{1} = \\frac{[L]_{1}}{[L]_{1} + K_{D,\\mathrm{mut}}} = \\frac{\\frac{5}{4}}{\\frac{5}{4} + \\frac{4}{5}} = \\frac{\\frac{5}{4}}{\\frac{25}{20} + \\frac{16}{20}} = \\frac{\\frac{5}{4}}{\\frac{41}{20}} = \\frac{5}{4} \\cdot \\frac{20}{41} = \\frac{100}{164} = \\frac{25}{41}.\n$$\n\n所要求的倍数变化是比率$f_{1}/f_{0}$：\n$$\n\\frac{f_{1}}{f_{0}} = \\frac{\\frac{25}{41}}{\\frac{5}{7}} = \\frac{25}{41} \\cdot \\frac{7}{5} = \\frac{175}{205} = \\frac{35}{41}.\n$$\n\n因此，尽管工程改造的TIRAP变体具有增强的亲和力，但PLC介导的PI(4,5)P$_2$耗尽使膜结合分数相对于野生型基线降低了$\\frac{35}{41}$倍。", "answer": "$$\\boxed{\\frac{35}{41}}$$", "id": "2873589"}, {"introduction": "最后的这项练习 [@problem_id:2873583] 将通路分支和时序调控等概念整合到一个统一的计算模型中。通过使用常微分方程(ODE)对系统进行模拟，您将探索 MyD88 和 TRIF 信号通路在时间上的协同作用，对于实现特定的生物学输出——即 *Ifnb1* 基因的精确转录——是何等关键。这项实践将使您具备从系统层面分析和预测信号网络动态行为的能力。", "problem": "您的任务是编写一个完整、可运行的程序，以形式化一个最小的、在机理上忠实的常微分方程（ODE）模型。该模型模拟Toll样受体$4$ (TLR$4$)的信号传导，捕捉了在质膜上由髓系分化初级反应蛋白$88$ (MyD$88$)依赖的核因子κB (NF-κB)激活，以及在内体中由TIR结构域衔接蛋白诱导的β-干扰素 (TRIF)依赖的干扰素调节因子3 (IRF3)激活。其生物学前提基于经过充分检验的观察结果，即TLR$4$在质膜上通过MyD$88$进行信号传导，并在内吞后切换到TRIF通路；β1-干扰素 (*Ifnb1*)的转录需要NF-κB和IRF3的同时激活。您的程序必须实现一个基于一阶激活/失活的最小分段线性ODE系统，该系统与这些原理一致，并量化延迟内吞作用如何改变*Ifnb1*转录的时间。\n\n模型规格与必要定义：\n- 设$N(t)$表示在时间$t$（分钟）时NF-κB的核内活性，$I(t)$表示IRF3的核内活性。设$t_e$表示TLR$4$内吞的时间（分钟），此时信号传导从MyD$88$切换到TRIF。使用初始条件$N(0)=0$和$I(0)=0$。\n- 对于$0 \\le t  t_e$（质膜，MyD$88$主导）：\n  $$\\frac{dN}{dt} = k_N^{\\mathrm{on}} - k_N^{\\mathrm{off}}\\,N(t), \\quad \\frac{dI}{dt} = -\\,k_I^{\\mathrm{off}}\\,I(t).$$\n- 对于$t \\ge t_e$（内体，TRIF主导）：\n  $$\\frac{dN}{dt} = -\\,k_N^{\\mathrm{off}}\\,N(t), \\quad \\frac{dI}{dt} = k_I^{\\mathrm{on}} - k_I^{\\mathrm{off}}\\,I(t).$$\n- *Ifnb1*转录驱动力被建模为Hill函数的类“与”逻辑乘积：\n  $$T(t) = k_{\\mathrm{tx}} \\cdot \\frac{N(t)^h}{K_N^h + N(t)^h} \\cdot \\frac{I(t)^h}{K_I^h + I(t)^h}.$$\n- 定义半激活时间$t_{1/2}(t_e)$为模拟窗口内使$T(t) \\ge 0.5 \\cdot k_{\\mathrm{tx}}$成立的最小时间$t$。\n- 使用以下参数值，这些值的选择基于科学合理性，并反映了一阶激活/失活过程：\n  - $k_N^{\\mathrm{on}} = 0.15\\,\\mathrm{min}^{-1}$， $k_N^{\\mathrm{off}} = 0.10\\,\\mathrm{min}^{-1}$，\n  - $k_I^{\\mathrm{on}} = 0.12\\,\\mathrm{min}^{-1}$， $k_I^{\\mathrm{off}} = 0.05\\,\\mathrm{min}^{-1}$，\n  - $K_N = 0.3$（无量纲），$K_I = 0.5$（无量纲），$h=3$（无量纲），$k_{\\mathrm{tx}}=1$（无量纲）。\n- 在从$t=0$到$t=t_{\\max}$（其中$t_{\\max}=240\\,\\mathrm{min}$）的均匀时间网格上，使用固定时间步长$\\Delta t = 0.1\\,\\mathrm{min}$进行模拟。所有时间量和输出都必须以分钟为单位表示。\n\n计算任务：\n- 固定基线内吞时间$t_{e,0} = 20\\,\\mathrm{min}$。\n- 对于给定的延迟$d$（分钟），定义$t_e = t_{e,0} + d$并计算$t_{1/2}(t_e)$。\n- 设$b = t_{1/2}(t_{e,0})$为基线半激活时间。对于每个测试的延迟$d$，报告\n  $$x_d = \\begin{cases}\n  t_{1/2}(t_{e,0}+d) - b,  \\text{如果 } t_{1/2}(t_{e,0}+d) \\text{ 和 } b \\text{ 都在 } [0,t_{\\max}] \\text{ 范围内存在，}\\\\\n  -1.0,  \\text{否则。}\n  \\end{cases}$$\n\n测试集：\n- 使用延迟集合（分钟）$D = [0, 30, 60, 120]$。\n- 对于每个$d \\in D$，按上述定义计算$x_d$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个逗号分隔的Python风格列表，内含四个值$[x_0, x_{30}, x_{60}, x_{120}]$，每个值四舍五入到三位小数，用方括号括起来，并以分钟为单位表示。例如，一个可接受的格式是$[0.000,30.000,60.000,120.000]$（此处显示的数字仅为示例；您的程序必须计算实际值）。", "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于既定的免疫学原理，在数学上被良好地表述为一个常微分方程组，并且客观明确，没有歧义。所有必要的参数和条件均已提供，使得该问题是自洽且可解的。\n\n该问题要求对Toll样受体$4$ (TLR$4$)信号传导的分段线性常微分方程（ODE）模型进行模拟。该模型捕捉了两条不同通路的顺序激活：一条是早期的、定位于质膜的、激活NF-κB的MyD$88$依赖性通路；另一条是延迟的、定位于内体的、激活IRF$3$的TRIF依赖性通路。\n\n状态变量是NF-κB的核内活性（用$N(t)$表示）和IRF$3$的核内活性（用$I(t)$表示）。系统动力学在内吞时间$t_e$发生切换。\n\n控制方程如下：\n1.  对于时间区间$0 \\le t  t_e$ (MyD$88$信号传导)：\n    $$\n    \\frac{dN}{dt} = k_N^{\\mathrm{on}} - k_N^{\\mathrm{off}}\\,N(t) \\\\\n    \\frac{dI}{dt} = -\\,k_I^{\\mathrm{off}}\\,I(t)\n    $$\n2.  对于时间区间$t \\ge t_e$ (TRIF信号传导)：\n    $$\n    \\frac{dN}{dt} = -\\,k_N^{\\mathrm{off}}\\,N(t) \\\\\n    \\frac{dI}{dt} = k_I^{\\mathrm{on}} - k_I^{\\mathrm{off}}\\,I(t)\n    $$\n初始条件为$N(0)=0$和$I(0)=0$。\n\n这些是一阶线性常微分方程，可以解析求解。\n对于$0 \\le t  t_e$：\n对于$N(0)=0$，$N(t)$的解是指数趋近于稳态$\\frac{k_N^{\\mathrm{on}}}{k_N^{\\mathrm{off}}}$：\n$$\nN(t) = \\frac{k_N^{\\mathrm{on}}}{k_N^{\\mathrm{off}}} \\left(1 - e^{-k_N^{\\mathrm{off}} t}\\right)\n$$\n对于$I(0)=0$，$I(t)$的解是平凡的，因为没有激活项：\n$$\nI(t) = 0\n$$\n\n对于$t \\ge t_e$：\n这一阶段的解使用$t=t_e$时刻的值作为初始条件。设$\\tau = t - t_e$。\n$N$的初始条件是$N(t_e) = \\frac{k_N^{\\mathrm{on}}}{k_N^{\\mathrm{off}}} \\left(1 - e^{-k_N^{\\mathrm{off}} t_e}\\right)$。\n$N(t)$的方程变为简单的指数衰减：\n$$\nN(t) = N(t_e) \\, e^{-k_N^{\\mathrm{off}} (t - t_e)}\n$$\n$I$的初始条件是$I(t_e) = 0$。$I(t)$的解是指数趋近于其新的稳态$\\frac{k_I^{\\mathrm{on}}}{k_I^{\\mathrm{off}}}$：\n$$\nI(t) = \\frac{k_I^{\\mathrm{on}}}{k_I^{\\mathrm{off}}} \\left(1 - e^{-k_I^{\\mathrm{off}} (t - t_e)}\\right)\n$$\n\n问题指定了在步长为$\\Delta t = 0.1\\,\\mathrm{min}$的离散时间网格上进行数值模拟。我们将使用前向欧拉法，这是一种一阶数值积分方案，适用于此任务。对于微分方程$\\frac{dy}{dt} = f(y, t)$，更新规则为$y_{k+1} = y_k + \\Delta t \\cdot f(y_k, t_k)$。\n\n将其应用于我们的系统：\n设$N_k \\approx N(t_k)$和$I_k \\approx I(t_k)$，其中$t_k = k \\Delta t$。\n对于$t_k  t_e$：\n$$\nN_{k+1} = N_k + \\Delta t \\left( k_N^{\\mathrm{on}} - k_N^{\\mathrm{off}} N_k \\right) \\\\\nI_{k+1} = I_k + \\Delta t \\left( -k_I^{\\mathrm{off}} I_k \\right)\n$$\n对于$t_k \\ge t_e$：\n$$\nN_{k+1} = N_k + \\Delta t \\left( -k_N^{\\mathrm{off}} N_k \\right) \\\\\nI_{k+1} = I_k + \\Delta t \\left( k_I^{\\mathrm{on}} - k_I^{\\mathrm{off}} I_k \\right)\n$$\n\n*Ifnb1*的转录驱动力$T(t)$被建模为一个协同的“与”门，需要$N(t)$和$I(t)$的同时激活：\n$$\nT(t) = k_{\\mathrm{tx}} \\cdot \\frac{N(t)^h}{K_N^h + N(t)^h} \\cdot \\frac{I(t)^h}{K_I^h + I(t)^h}\n$$\n半激活时间$t_{1/2}(t_e)$是$T(t)$达到或超过其最大可能值一半的第一个时间点，即$T(t) \\ge 0.5 \\cdot k_{\\mathrm{tx}}$。\n\n计算流程如下：\n1.  定义一个函数`compute_t_half(t_e)`，它以内吞时间$t_e$作为输入。\n2.  在该函数内部，初始化时间、$N$和$I$数组。设置$N_0=0$和$I_0=0$。\n3.  从$t=0$到$t=t_{\\max}$以步长$\\Delta t$进行迭代。在每一步中，根据$t_{k-1}  t_e$是否成立，使用相应的欧拉更新规则计算$N_k$和$I_k$。\n4.  每一步之后，计算$T(t_k)$。如果$T(t_k) \\ge 0.5 \\cdot k_{\\mathrm{tx}}$，则返回当前时间$t_k$。\n5.  如果循环完成而条件未满足，则返回一个哨兵值（例如，无穷大或一个特殊常量）以表明在模拟窗口内未找到$t_{1/2}$。\n6.  通过使用$t_{e,0} = 20\\,\\mathrm{min}$调用函数，建立基线半激活时间$b = t_{1/2}(t_{e,0})$。\n7.  遍历指定的延迟$d \\in [0, 30, 60, 120]$。对于每个$d$：\n    a. 计算扰动后的内吞时间$t_e = t_{e,0} + d$。\n    b. 计算相应的半激活时间，$t_{1/2, d} = t_{1/2}(t_e)$。\n    c. 如果$b$和$t_{1/2, d}$都成功找到，则计算差值$x_d = t_{1/2, d} - b$。\n    d. 否则，设置$x_d = -1.0$。\n8.  收集所有延迟的$x_d$值，并将输出格式化为一个四舍五入到三位小数的数字列表。\n\n这种结构化的方法确保了正确且稳健的实现，完全遵循问题的规范。使用数值求解器与所提供的模拟参数是一致的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the delay in Ifnb1 transcriptional activation\n    due to delayed TLR4 endocytosis.\n    \"\"\"\n\n    # Model parameters as specified in the problem\n    params = {\n        \"k_N_on\": 0.15,   # min^-1\n        \"k_N_off\": 0.10,  # min^-1\n        \"k_I_on\": 0.12,   # min^-1\n        \"k_I_off\": 0.05,  # min^-1\n        \"K_N\": 0.3,       # dimensionless\n        \"K_I\": 0.5,       # dimensionless\n        \"h\": 3,           # dimensionless\n        \"k_tx\": 1.0,      # dimensionless\n    }\n\n    # Simulation parameters\n    t_max = 240.0  # min\n    dt = 0.1       # min\n\n    # Test suite\n    t_e_baseline = 20.0  # min\n    delays = [0.0, 30.0, 60.0, 120.0]  # min\n\n    def compute_t_half(t_e, params, t_max, dt):\n        \"\"\"\n        Simulates the ODE system for a given endocytosis time t_e and finds\n        the half-activation time for Ifnb1 transcription.\n        \"\"\"\n        # Time grid\n        times = np.arange(0, t_max + dt, dt)\n        num_steps = len(times)\n\n        # State variable arrays\n        N = np.zeros(num_steps)\n        I = np.zeros(num_steps)\n\n        # Initial conditions are N[0] = 0, I[0] = 0, already set by np.zeros\n\n        # Simulation loop using Forward Euler method\n        for k in range(num_steps - 1):\n            t_current = times[k]\n\n            # Apply piecewise ODEs\n            if t_current  t_e:\n                # MyD88-dependent phase (plasma membrane)\n                dN_dt = params[\"k_N_on\"] - params[\"k_N_off\"] * N[k]\n                dI_dt = -params[\"k_I_off\"] * I[k]\n            else:\n                # TRIF-dependent phase (endosome)\n                dN_dt = -params[\"k_N_off\"] * N[k]\n                dI_dt = params[\"k_I_on\"] - params[\"k_I_off\"] * I[k]\n\n            # Update state variables\n            N[k+1] = N[k] + dN_dt * dt\n            I[k+1] = I[k] + dI_dt * dt\n\n            # Calculate transcriptional drive T(t)\n            N_h = N[k+1]**params[\"h\"]\n            I_h = I[k+1]**params[\"h\"]\n            KN_h = params[\"K_N\"]**params[\"h\"]\n            KI_h = params[\"K_I\"]**params[\"h\"]\n            \n            # Avoid division by zero if N or I are zero.\n            # In that case, the Hill term is zero.\n            if KN_h + N_h == 0 or KI_h + I_h == 0:\n                T_k1 = 0.0\n            else:\n                hill_N = N_h / (KN_h + N_h)\n                hill_I = I_h / (KI_h + I_h)\n                T_k1 = params[\"k_tx\"] * hill_N * hill_I\n\n            # Check for crossing the half-activation threshold\n            if T_k1 = 0.5 * params[\"k_tx\"]:\n                return times[k+1]\n\n        # If threshold is not reached within t_max\n        return -1.0\n\n    # Calculate baseline half-activation time\n    baseline_t_half = compute_t_half(t_e_baseline, params, t_max, dt)\n\n    results = []\n    for d in delays:\n        current_t_e = t_e_baseline + d\n        current_t_half = compute_t_half(current_t_e, params, t_max, dt)\n\n        # Check if both baseline and current t_half were found\n        if baseline_t_half != -1.0 and current_t_half != -1.0:\n            x_d = current_t_half - baseline_t_half\n        else:\n            x_d = -1.0\n        \n        results.append(x_d)\n\n    # Format the final output string\n    output_str = f\"[{','.join(f'{val:.3f}' for val in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2873583"}]}