{"hands_on_practices": [{"introduction": "衰老相关β-半乳糖苷酶（SA-β-gal）检测是鉴定衰老细胞的经典方法之一。然而，该检测的准确性和可重复性高度依赖于实验条件，如pH值、底物浓度和孵育时间。本练习将引导你应用酶动力学原理和统计优化方法，来推导出一个标准化的最优实验方案，这体现了将理论知识应用于实验室实践的关键能力。[@problem_id:2555907]", "problem": "衰老相关β-半乳糖苷酶（SA-β-gal）比色法通过将固定后的细胞与生色底物X-gal一同孵育，并对蓝色沉淀的形成进行评分，用于区分衰老细胞和非衰老细胞。考虑两种细胞表型：衰老型（$S$）和非衰老型（$N$）。假设以下基本前提。\n\n1) 酶动力学：对于每种表型 $i \\in \\{S, N\\}$，底物转换遵循Michaelis–Menten动力学，其初始速率 $v_i$ 由下式给出：\n$$\nv_i = V_{\\max,i}(\\mathrm{pH}) \\,\\frac{s}{K_M + s},\n$$\n其中 $s$ 是底物浓度，$K_M$ 是Michaelis常数，$V_{\\max,i}(\\mathrm{pH}) = k_{\\mathrm{cat}} E_i \\, g(\\mathrm{pH})$。此处，$k_{\\mathrm{cat}}$ 是催化常数，$E_i$ 是每个细胞的活性酶量（与溶酶体含量成正比），$g(\\mathrm{pH})$ 是由两个可电离基团建模的pH-活性因子，\n$$\ng(\\mathrm{pH}) = \\frac{1}{1 + 10^{pK_{a1} - \\mathrm{pH}} + 10^{\\mathrm{pH} - pK_{a2}}}.\n$$\n\n2) 表型差异：衰老细胞的溶酶体含量升高，建模为 $E_S = R\\,E_N$，其中已知倍数增加 $R>1$。\n\n3) 产物形成：在孵育时间 $t$ 内，底物消耗可忽略不计，产物累积为 $P_i = v_i \\, t$。\n\n4) 检测统计学：将一个细胞评分为阳性被建模为一个泊松事件，其均值 $\\lambda_i = P_i/T$，其中 $T$ 是一个固定的读数分子尺度常数。$i$ 型细胞被评分为阳性的概率是 $q_i = 1 - \\exp(-\\lambda_i)$。灵敏度是 $q_S$，特异性是正确将非衰老细胞评分为阴性的概率，即 $\\exp(-\\lambda_N)$。该检测的Youden指数是\n$$\nJ = \\text{灵敏度} + \\text{特异性} - 1 = \\exp\\!\\left(-\\frac{P_N}{T}\\right) - \\exp\\!\\left(-\\frac{P_S}{T}\\right).\n$$\n\n假设一个标准化的SA-β-gal实验方案采用以下数值上生理学合理的常数：\n- $g(\\mathrm{pH})$ 中的 $pK_{a1} = 3.8$，$pK_{a2} = 5.5$。\n- $R = 5$。\n- $K_M = 0.50\\,\\text{mM}$。\n- 复合常数 $B \\equiv \\dfrac{c\\,k_{\\mathrm{cat}} E_N}{T} = 0.050\\,\\text{min}^{-1}$，其中 $c$ 将产物转换为光学读数尺度；在最后的数值计算步骤之前，保持 $B$ 为符号形式。\n- 为了标准化和可比性，将检测缓冲液的 $\\mathrm{pH}$ 固定为 $6.0$。\n- 实际限制条件：$0  s \\le s_{\\max}$，其中 $s_{\\max} = 2.00\\,\\text{mM}$；以及 $0  t \\le 180\\,\\text{min}$。\n\n任务：\na) 仅从上述定义出发，推导出 $J$ 作为 $\\mathrm{pH}$、$s$ 和 $t$ 的显式函数。然后，对于固定的 $\\mathrm{pH}$ 和 $R$，证明对于组合的动力学-负载参数 $a \\equiv B\\,t\\,\\dfrac{s}{K_M+s}$，$J$ 存在唯一的最大值，并获得使 $J$ 最大化的 $a^{\\ast}$ 的闭合形式表达式。\n\nb) 使用固定的标准化 $\\mathrm{pH} = 6.0$，根据给定的 $pK_{a1}$ 和 $pK_{a2}$ 计算 $g(6.0)$。利用(a)部分得到的 $a^{\\ast}$，并在 $s \\le s_{\\max}$ 的约束下，选择 $s$ 以最小化所需的 $t$，然后求解相应的最小 $t$。确认所选的 $t$ 满足实际时间约束。\n\n将您的标准化实验方案报告为一个行向量 $(\\mathrm{pH}^{\\ast}, s^{\\ast}, t^{\\ast})$，其中 $\\mathrm{pH}^{\\ast}$ 是无单位的，$s^{\\ast}$ 的单位是 $\\text{mM}$，$t^{\\ast}$ 的单位是 $\\text{min}$。将每个条目四舍五入到三位有效数字。", "solution": "首先将根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   **动力学与产物形成：**\n    -   表型 $i \\in \\{S, N\\}$ 的初始速率：$v_i = V_{\\max,i}(\\mathrm{pH}) \\,\\frac{s}{K_M + s}$\n    -   最大速率：$V_{\\max,i}(\\mathrm{pH}) = k_{\\mathrm{cat}} E_i \\, g(\\mathrm{pH})$\n    -   pH-活性因子：$g(\\mathrm{pH}) = \\frac{1}{1 + 10^{pK_{a1} - \\mathrm{pH}} + 10^{\\mathrm{pH} - pK_{a2}}}$\n    -   产物累积：$P_i = v_i \\, t$（底物消耗可忽略不计）\n-   **表型与检测：**\n    -   酶量关系：$E_S = R\\,E_N$\n    -   检测的泊松均值：$\\lambda_i = P_i/T$\n    -   Youden指数：$J = \\exp(-\\lambda_N) - \\exp(-\\lambda_S)$\n-   **数值常数与约束条件：**\n    -   $pK_{a1} = 3.8$\n    -   $pK_{a2} = 5.5$\n    -   $R = 5$\n    -   $K_M = 0.50\\,\\text{mM}$\n    -   复合常数：$B \\equiv \\dfrac{c\\,k_{\\mathrm{cat}} E_N}{T} = 0.050\\,\\text{min}^{-1}$\n    -   固定的检测pH：$\\mathrm{pH} = 6.0$\n    -   底物浓度约束：$0  s \\le s_{\\max}$，其中 $s_{\\max} = 2.00\\,\\text{mM}$\n    -   孵育时间约束：$0  t \\le 180\\,\\text{min}$\n-   **任务定义：**\n    -   组合参数：$a \\equiv B\\,t\\,\\dfrac{s}{K_M+s}$\n    -   目标：(a) 推导 $J(\\mathrm{pH}, s, t)$，找到使 $J$ 最大化的值 $a^{\\ast}$。(b) 对于 $\\mathrm{pH}=6.0$，找到满足(a)中优化条件同时最小化 $t$ 的底物浓度 $s^{\\ast}$ 和孵育时间 $t^{\\ast}$。报告实验方案 $(\\mathrm{pH}^{\\ast}, s^{\\ast}, t^{\\ast})$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n该问题具有科学依据，采用了酶动力学（Michaelis-Menten）和生物物理化学（pH对活性的依赖性）中的标准模型。其在通过SA-β-gal检测法进行衰老检测中的应用是细胞生物学的一个标准课题。问题是适定的、客观的，并为唯一解提供了足够的信息，但存在一个微小歧义。\n\n常数 $B$ 的定义中存在一个潜在的不一致性。问题陈述 $B \\equiv \\dfrac{c\\,k_{\\mathrm{cat}} E_N}{T}$，其中 $c$ 是一个尺度因子。然而，泊松均值的定义为 $\\lambda_i = P_i/T$。让我们从第一性原理推导 $\\lambda_N$：\n$$\n\\lambda_N = \\frac{P_N}{T} = \\frac{v_N t}{T} = \\frac{\\left(k_{\\mathrm{cat}} E_N g(\\mathrm{pH}) \\frac{s}{K_M+s}\\right) t}{T} = \\left(\\frac{k_{\\mathrm{cat}} E_N}{T}\\right) g(\\mathrm{pH}) t \\frac{s}{K_M+s}\n$$\n如果我们使用给定的 $B$ 的定义，那么 $\\frac{k_{\\mathrm{cat}} E_N}{T} = \\frac{B}{c}$，这导致 $\\lambda_N = \\frac{B}{c} g(\\mathrm{pH}) t \\frac{s}{K_M+s}$。使用 $a$ 的定义，这给出 $\\lambda_N = \\frac{g(\\mathrm{pH})}{c} a$。$c$ 的值没有提供，这将使问题无法解决。\n\n这似乎是问题陈述中的一个印刷错误。保持问题完整性的最合乎逻辑的解决方案是假设常数 $c$ 不是关联核心变量的物理模型的一部分，意味着要么 $c=1$，要么预期的定义是 $B \\equiv \\dfrac{k_{\\mathrm{cat}} E_N}{T}$。这使得 $B$ 成为基本的速率常数组。采用此修正后，我们发现 $\\lambda_N = g(\\mathrm{pH}) \\left( B t \\frac{s}{K_M+s} \\right) = g(\\mathrm{pH}) a$，这使得问题自洽且可解。\n\n**步骤3：结论与行动**\n\n在对常数 $B$ 的定义进行必要且合理的澄清后，该问题被视为**有效**。我们继续进行求解。\n\n### 解答\n\n**a) $J$ 的推导及关于 $a$ 的优化**\n\n首先，我们用给定参数表示泊松均值 $\\lambda_N$ 和 $\\lambda_S$。非衰老表型的均值为：\n$$\n\\lambda_N = \\frac{P_N}{T} = \\frac{v_N t}{T} = \\frac{k_{\\mathrm{cat}} E_N g(\\mathrm{pH})}{T} t \\frac{s}{K_M+s}\n$$\n根据我们的验证分析，我们定义 $B \\equiv \\dfrac{k_{\\mathrm{cat}} E_N}{T} = 0.050\\,\\text{min}^{-1}$。那么 $\\lambda_N$ 变为：\n$$\n\\lambda_N = B g(\\mathrm{pH}) t \\frac{s}{K_M+s}\n$$\n对于衰老表型，我们使用 $E_S = R E_N$：\n$$\n\\lambda_S = \\frac{P_S}{T} = \\frac{v_S t}{T} = \\frac{k_{\\mathrm{cat}} E_S g(\\mathrm{pH})}{T} t \\frac{s}{K_M+s} = \\frac{k_{\\mathrm{cat}} (R E_N) g(\\mathrm{pH})}{T} t \\frac{s}{K_M+s} = R \\lambda_N\n$$\nYouden指数 $J$ 由 $J = \\exp(-\\lambda_N) - \\exp(-\\lambda_S)$ 给出。代入 $\\lambda_S = R\\lambda_N$ 得：\n$$\nJ = \\exp(-\\lambda_N) - \\exp(-R\\lambda_N)\n$$\n代入 $\\lambda_N$ 的完整表达式，得到 $J$ 作为 $\\mathrm{pH}$、$s$ 和 $t$ 的显式函数：\n$$\nJ(\\mathrm{pH}, s, t) = \\exp\\left(- B g(\\mathrm{pH}) t \\frac{s}{K_M+s} \\right) - \\exp\\left(- R B g(\\mathrm{pH}) t \\frac{s}{K_M+s} \\right)\n$$\n问题引入了组合的动力学-负载参数 $a \\equiv B\\,t\\,\\dfrac{s}{K_M+s}$。使用此定义，我们可以写出 $\\lambda_N = g(\\mathrm{pH}) a$。Youden指数 $J$ 现在可以表示为 $a$ 和 $\\mathrm{pH}$ 的函数：\n$$\nJ(a; \\mathrm{pH}) = \\exp\\left(-g(\\mathrm{pH})a\\right) - \\exp\\left(-R g(\\mathrm{pH})a\\right)\n$$\n为了找到在固定 $\\mathrm{pH}$ 和 $R$ 下使 $J$ 最大化的 $a$ 值，我们将 $J$ 对 $a$ 求导，并令导数等于零。设 $C = g(\\mathrm{pH})$ 为此优化的一个常数。\n$$\n\\frac{dJ}{da} = \\frac{d}{da} \\left( \\exp(-Ca) - \\exp(-RCa) \\right) = -C\\exp(-Ca) + RC\\exp(-RCa)\n$$\n令 $\\frac{dJ}{da} = 0$:\n$$\n-C\\exp(-Ca) + RC\\exp(-RCa) = 0\n$$\n因为 $C = g(\\mathrm{pH})  0$，我们可以除以 $-C$:\n$$\n\\exp(-Ca) - R\\exp(-RCa) = 0 \\implies \\exp(-Ca) = R\\exp(-RCa)\n$$\n取两边的自然对数：\n$$\n-Ca = \\ln(R) - RCa\n$$\n$$\nRCa - Ca = \\ln(R) \\implies (R-1)Ca = \\ln(R)\n$$\n解出最优值 $a^{\\ast}$：\n$$\na^{\\ast} = \\frac{\\ln(R)}{(R-1)C} = \\frac{\\ln(R)}{(R-1)g(\\mathrm{pH})}\n$$\n为确认这对应一个最大值，我们检查二阶导数：\n$$\n\\frac{d^2J}{da^2} = \\frac{d}{da} \\left( -C\\exp(-Ca) + RC\\exp(-RCa) \\right) = C^2\\exp(-Ca) - R^2C^2\\exp(-RCa)\n$$\n在极值点 $a=a^{\\ast}$ 处，我们有 $\\exp(-Ca^{\\ast}) = R\\exp(-RCa^{\\ast})$。将此代入二阶导数表达式中：\n$$\n\\left. \\frac{d^2J}{da^2} \\right|_{a=a^{\\ast}} = C^2\\left(R\\exp(-RCa^{\\ast})\\right) - R^2C^2\\exp(-RCa^{\\ast}) = R C^2 \\exp(-RCa^{\\ast}) (1-R)\n$$\n因为 $R1$，$C0$，且指数项为正，所以二阶导数为负。这证实了 $a^{\\ast}$ 对应一个唯一的最大值。\n\n**b) 标准化实验方案的计算**\n\n标准化的实验方案使用固定的pH值，$\\mathrm{pH}^{\\ast} = 6.0$。首先，我们使用 $pK_{a1} = 3.8$ 和 $pK_{a2} = 5.5$ 计算在该pH下的pH-活性因子 $g(\\mathrm{pH})$ 的值。\n$$\ng(6.0) = \\frac{1}{1 + 10^{3.8 - 6.0} + 10^{6.0 - 5.5}} = \\frac{1}{1 + 10^{-2.2} + 10^{0.5}}\n$$\n现在，我们可以计算在该pH下，对于 $R=5$ 时的最优参数 $a^{\\ast}$ 的数值：\n$$\na^{\\ast} = \\frac{\\ln(5)}{(5-1)g(6.0)} = \\frac{\\ln(5)}{4 \\left(\\frac{1}{1 + 10^{-2.2} + 10^{0.5}}\\right)} = \\frac{\\ln(5)}{4} (1 + 10^{-2.2} + 10^{0.5})\n$$\n我们有方程将 $a^{\\ast}$ 与实验参数 $s$ 和 $t$ 联系起来：\n$$\na^{\\ast} = B t \\frac{s}{K_M+s}\n$$\n解出 $t$：\n$$\nt = \\frac{a^{\\ast}}{B} \\frac{K_M+s}{s} = \\frac{a^{\\ast}}{B} \\left(1 + \\frac{K_M}{s}\\right)\n$$\n任务是最小化所需的孵育时间 $t$。对于 $s  0$，$t$ 的表达式是底物浓度 $s$ 的严格递减函数。因此，要最小化 $t$，我们必须最大化 $s$。实际约束是 $0  s \\le s_{\\max}$，其中 $s_{\\max} = 2.00\\,\\text{mM}$。因此，最优底物浓度是 $s^{\\ast} = s_{\\max} = 2.00\\,\\text{mM}$。\n\n相应的最小时间 $t^{\\ast}$ 是：\n$$\nt^{\\ast} = \\frac{a^{\\ast}}{B} \\left(1 + \\frac{K_M}{s_{\\max}}\\right)\n$$\n我们现在代入所有数值：\n-   $B = 0.050\\,\\text{min}^{-1}$\n-   $K_M = 0.50\\,\\text{mM}$\n-   $s_{\\max} = 2.00\\,\\text{mM}$\n-   $R=5$\n-   $\\mathrm{pH} = 6.0$\n\n首先，计算 $a^{\\ast}$:\n$$\na^{\\ast} = \\frac{\\ln(5)}{4} (1 + 10^{-2.2} + 10^{0.5}) \\approx \\frac{1.609438}{4}(1 + 0.006310 + 3.162278) \\approx 0.40236 \\times 4.168588 \\approx 1.67727\n$$\n现在计算 $t^{\\ast}$:\n$$\nt^{\\ast} = \\frac{1.67727}{0.050} \\left(1 + \\frac{0.50}{2.00}\\right) = 33.5454 \\times (1 + 0.25) = 33.5454 \\times 1.25 \\approx 41.9318\\,\\text{min}\n$$\n这个时间 $t^{\\ast} \\approx 41.9\\,\\text{min}$ 完全在 $t \\le 180\\,\\text{min}$ 的实际约束范围内。\n\n因此，标准化的实验方案为 $(\\mathrm{pH}^{\\ast}, s^{\\ast}, t^{\\ast})$。我们将数值四舍五入到三位有效数字进行报告。\n-   $\\mathrm{pH}^{\\ast} = 6.00$\n-   $s^{\\ast} = 2.00\\,\\text{mM}$\n-   $t^{\\ast} = 41.9\\,\\text{min}$\n\n最终的标准化实验方案是 $(6.00, 2.00, 41.9)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6.00  2.00  41.9 \\end{pmatrix}}\n$$", "id": "2555907"}, {"introduction": "p53蛋白是细胞命运决定的核心调控因子，在细胞衰老、凋亡和周期阻滞中扮演着“十字路口”的角色。本练习通过一个经典的p53-Mdm2负反馈回路的数学模型，探索了p53的激活模式——持续性激活或脉冲式振荡——如何决定细胞命运。通过这个练习，你将接触到系统生物学的核心思想，理解信号的“动态编码”对于细胞功能的重要性。[@problem_id:2555932]", "problem": "一个关于抑癌蛋白 p53 及其负调控因子 Mdm2 的、基于机理的简化模型，捕捉了与衰老决定相关的应激诱导动力学的关键特征。考虑一个受质量作用动力学和标准转录控制启发的、包含三个阶段的转录-翻译负反馈回路：\n\n- 令 $x_{1}(t)$ 表示活性 p53 蛋白的浓度。\n- 令 $x_{2}(t)$ 表示由 p53 诱导的 $\\mathrm{Mdm2}$ mRNA 的浓度。\n- 令 $x_{3}(t)$ 表示由 $x_{2}(t)$ 翻译而来的 $\\mathrm{Mdm2}$ 蛋白的浓度。\n\n假设经过适当的无量纲化后，$x_{1}$、$x_{2}$ 和 $x_{3}$ 具有相等的有效一阶降解速率 $k0$。一个振幅为 $S \\ge 0$ 的阶跃式 DNA 损伤信号会增加 p53 的基础合成能力，使其产生项为 $V_{S}=V+\\eta S$，其中 $V0$ 且 $\\eta0$。Mdm2 通过希尔型抑制来抑制 p53 的合成，而 p53 线性诱导 Mdm2 的转录，Mdm2 蛋白则由其 mRNA 线性产生。控制方程组为\n$$\n\\frac{dx_{1}}{dt} \\;=\\; \\frac{V_{S}}{1+\\left(\\frac{x_{3}}{K}\\right)^{n}} \\;-\\; k\\,x_{1},\n$$\n$$\n\\frac{dx_{2}}{dt} \\;=\\; c\\,x_{1} \\;-\\; k\\,x_{2},\n$$\n$$\n\\frac{dx_{3}}{dt} \\;=\\; d\\,x_{2} \\;-\\; k\\,x_{3},\n$$\n其中参数 $K0$，$n \\ge 1$，$c0$ 且 $d0$。令 $x^{\\ast}=(x_{1}^{\\ast},x_{2}^{\\ast},x_{3}^{\\ast})$ 表示在固定 $S$ 值下的一个稳态。将稳态处的局部反馈斜率大小定义为\n$$\n\\phi \\;=\\; -\\left.\\frac{d}{dx_{3}}\\left(\\frac{V_{S}}{1+\\left(\\frac{x_{3}}{K}\\right)^{n}}\\right)\\right|_{x_{3}=x_{3}^{\\ast}} \\;\\; 0,\n$$\n它量化了抑制性反馈的灵敏度。\n\n仅使用化学动力学的基本定律（线性步骤使用质量作用定律，转录控制使用希尔型抑制）和关于 $x^{\\ast}$ 的线性稳定性分析，从第一性原理出发，推导局部反馈斜率大小的唯一临界值 $\\phi_{c}$ 的闭式表达式。该临界值将稳定的稳态动力学（持续激活但无自持脉冲）与自持脉冲状态（通过霍普夫分岔产生的稳定振荡）区分开来。用 $c$、$d$ 和 $k$ 精确表示 $\\phi_{c}$。无需进行数值代入，也无需四舍五入。只需报告 $\\phi_{c}$ 的精确解析表达式。\n\n然后，根据 $\\phi$ 如何通过希尔函数依赖于 $S$，以及公认的细胞衰老条件（例如，细胞周期蛋白依赖性激酶抑制剂如 $\\mathrm{p}21$ 的持续表达），阐明阈值的哪一侧有利于衰老决定，并说明原因。你最终报告的答案必须是 $\\phi_{c}$ 的精确解析表达式。最终报告的答案中不要包含单位；如果需要讨论单位，请在解答叙述中进行。本问题中的所有符号和数字均已在上文定义，所有数学实体必须使用标准微积分和线性系统概念处理。", "solution": "该问题要求推导局部反馈斜率大小的临界值，记为 $\\phi_c$。在给定的 p53-Mdm2 动力学三变量模型中，该值描绘了从稳定稳态到自持振荡的转变。这种转变是霍普夫分岔的特征。推导将基于系统在其一般稳态 $x^{\\ast}=(x_{1}^{\\ast},x_{2}^{\\ast},x_{3}^{\\ast})$ 周围的线性稳定性分析。\n\n常微分方程的控制系统如下所示：\n$$\n\\frac{dx_{1}}{dt} \\;=\\; f_1(x_1, x_2, x_3) \\;=\\; \\frac{V_{S}}{1+\\left(\\frac{x_{3}}{K}\\right)^{n}} \\;-\\; k\\,x_{1}\n$$\n$$\n\\frac{dx_{2}}{dt} \\;=\\; f_2(x_1, x_2, x_3) \\;=\\; c\\,x_{1} \\;-\\; k\\,x_{2}\n$$\n$$\n\\frac{dx_{3}}{dt} \\;=\\; f_3(x_1, x_2, x_3) \\;=\\; d\\,x_{2} \\;-\\; k\\,x_{3}\n$$\n\n为分析稳态 $x^{\\ast}$ 的局部稳定性，我们计算系统的雅可比矩阵 $J$，其元素由 $J_{ij} = \\frac{\\partial f_i}{\\partial x_j}$ 在 $x^{\\ast}$ 处的值给出。\n\n偏导数如下：\n$$\n\\frac{\\partial f_{1}}{\\partial x_{1}} = -k, \\quad \\frac{\\partial f_{1}}{\\partial x_{2}} = 0, \\quad \\frac{\\partial f_{1}}{\\partial x_{3}} = \\frac{d}{dx_{3}}\\left(\\frac{V_{S}}{1+\\left(\\frac{x_{3}}{K}\\right)^{n}}\\right)\n$$\n$$\n\\frac{\\partial f_{2}}{\\partial x_{1}} = c, \\quad \\frac{\\partial f_{2}}{\\partial x_{2}} = -k, \\quad \\frac{\\partial f_{2}}{\\partial x_{3}} = 0\n$$\n$$\n\\frac{\\partial f_{3}}{\\partial x_{1}} = 0, \\quad \\frac{\\partial f_{3}}{\\partial x_{2}} = d, \\quad \\frac{\\partial f_{3}}{\\partial x_{3}} = -k\n$$\n\n问题将局部反馈斜率大小定义为 $\\phi = -\\left.\\frac{d}{dx_{3}}\\left(\\frac{V_{S}}{1+\\left(\\frac{x_{3}}{K}\\right)^{n}}\\right)\\right|_{x_{3}=x_{3}^{\\ast}}$。因此，在稳态处，$\\left.\\frac{\\partial f_{1}}{\\partial x_{3}}\\right|_{x^{\\ast}} = -\\phi$。\n\n在稳态 $x^{\\ast}$ 处计算的雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} -k  0  -\\phi \\\\ c  -k  0 \\\\ 0  d  -k \\end{pmatrix}\n$$\n\n稳态的稳定性由 $J$ 的特征值 $\\lambda$ 决定，这些特征值是特征方程 $\\det(J - \\lambda I) = 0$ 的根，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} -k-\\lambda  0  -\\phi \\\\ c  -k-\\lambda  0 \\\\ 0  d  -k-\\lambda \\end{pmatrix} = 0\n$$\n沿第一行展开行列式得到：\n$$\n(-k-\\lambda) \\begin{vmatrix} -k-\\lambda  0 \\\\ d  -k-\\lambda \\end{vmatrix} - 0 + (-\\phi) \\begin{vmatrix} c  -k-\\lambda \\\\ 0  d \\end{vmatrix} = 0\n$$\n$$\n(-k-\\lambda)((-k-\\lambda)^{2}) - \\phi(cd) = 0\n$$\n$$\n-(k+\\lambda)^{3} - cd\\phi = 0\n$$\n展开此表达式得到特征多项式：\n$$\n\\lambda^3 + 3k\\lambda^2 + 3k^2\\lambda + (k^3 + cd\\phi) = 0\n$$\n\n这是一个三次多项式，形式为 $a_3\\lambda^3 + a_2\\lambda^2 + a_1\\lambda + a_0 = 0$，其系数为：\n$a_3 = 1$\n$a_2 = 3k$\n$a_1 = 3k^2$\n$a_0 = k^3 + cd\\phi$\n\n为使稳态稳定，必须满足劳斯-赫尔维茨稳定性判据。对于三阶系统，这些判据是对于所有 $i \\in \\{0, 1, 2, 3\\}$ 都有 $a_i  0$，以及 $a_2 a_1  a_3 a_0$。由于所有参数 $c, d, k, \\phi$ 均为正，条件 $a_i0$ 得到满足。通过霍普夫分岔产生振荡的临界条件发生在稳定性裕度为零时，即一对特征值穿过虚轴时。这恰好在 $a_2 a_1 = a_3 a_0$ 时发生。\n\n我们寻求使此等式成立的临界值 $\\phi_c$：\n$$\n(3k)(3k^2) = (1)(k^3 + cd\\phi_c)\n$$\n$$\n9k^3 = k^3 + cd\\phi_c\n$$\n$$\n8k^3 = cd\\phi_c\n$$\n求解 $\\phi_c$ 可得唯一的临界值：\n$$\n\\phi_c = \\frac{8k^3}{cd}\n$$\n\n当 $\\phi  \\phi_c$ 时，条件 $a_2 a_1  a_3 a_0$ 成立，意味着所有特征值都具有负实部，稳态是稳定的。这对应于“持续激活但无自持脉冲”的状态。当 $\\phi  \\phi_c$ 时，该条件被违反，导致一对特征值具有正实部，稳态不稳定，并出现一个稳定的极限环（“自持脉冲状态”）。\n\n问题进一步要求确定此阈值的哪一侧有利于衰老决定。所述的细胞衰老生物学要求是 p53 诱导因子“持续[...]表达”。在这个动力学系统的背景下，“持续”信号对应于一个稳定的、不随时间变化的稳态。从这个意义上说，振荡信号是一系列脉冲，而不是持续信号。因此，支持衰老决定的动力学状态是稳态稳定的状态，即由 $\\phi  \\phi_c$ 定义的状态。\n\n应激信号 $S$ 和 $\\phi$ 之间的关系阐明了这一点。随着 $S$ 的增加，Mdm2 蛋白的稳态水平 $x_3^*$ 也增加。反馈斜率大小 $\\phi$ 的表达式可以从其定义中推导出来。由于 $x_3^*$ 随 $S$ 增加而增加，$\\phi$ 是应激信号 $S$ 的单调递增函数。因此，该模型预测低应激水平（$S$ 较小）对应于低的 $\\phi$ 值（$\\phi  \\phi_c$）和稳定的稳态，而高应激水平（$S$ 较大）则对应于高的 $\\phi$ 值（$\\phi > \\phi_c$）和振荡。\n\n尽管这似乎与一些生物学发现（其中高应激导致持续信号）相矛盾，但我们必须根据所提供的模型来回答。在该模型的逻辑中，衰老需要一个持续信号（稳定的稳态，$\\phi  \\phi_c$）。为使信号有效，其振幅也必须很高。p53 的稳态水平 $x_1^*$ 随 $S$ 增加而增加。因此，最有利于衰老的条件是高振幅的持续信号，这发生在应激水平 $S$ 很高但仍低于触发振荡的阈值时。就反馈斜率而言，这对应于从下方接近 $\\phi_c$ 的 $\\phi$ 值。因此，有利于衰老决定的阈值一侧是 $\\phi  \\phi_c$。", "answer": "$$\n\\boxed{\\frac{8k^{3}}{cd}}\n$$", "id": "2555932"}, {"introduction": "在现代衰老研究中，高通量测序技术已成为不可或缺的工具，而转座元件（TE）的去抑制是细胞衰老的一个重要分子标志。本练习模拟了一个真实的生物信息学分析场景，要求你处理RNA测序（RNA-seq）数据，应用负二项分布等统计模型来量化转座元件的表达变化。掌握这一从原始数据到生物学结论的分析流程，对于从海量基因组数据中挖掘新见解至关重要。[@problem_id:2555935]", "problem": "给定一个在衰老细胞与对照细胞中测量的小型、合理的转座子家族RNA测序计数数据集。目标是使用基于原则的计数模型计算倍数变化，并评估衰老过程中去抑制的单侧统计显著性，然后跨多个家族聚合得出的决策。该问题必须通过实现一个完整的程序来解决，该程序应遵循下文描述的最终输出格式。\n\n基于经过充分检验的规则和核心定义的假设：\n- 对于样本$j$中的转座子家族$i$，每个观测到的计数$y_{ij}$被建模为一个离散随机变量的实现，其期望值与测序深度（文库大小）成线性比例。设样本$j$的文库大小为$s_j$。$y_{ij}$的期望值为$s_j \\, \\theta_{ig}$，其中$g \\in \\{0,1\\}$编码生物学条件，对照组为$g=0$，衰老组为$g=1$，而$\\theta_{ig}$是条件$g$下家族$i$的基础单位读段表达率。\n- 相对于泊松模型的过度离散采用负二项分布进行处理，其方差满足$\\mathrm{Var}(y_{ij}) = \\mu_{ij} + \\alpha_i \\, \\mu_{ij}^2$，其中$\\mu_{ij} = s_j \\, \\theta_{ig}$，离散参数$\\alpha_i \\ge 0$取决于家族$i$但与$g$无关。\n- 在给定条件$g$的情况下，假定生物学重复是独立的，并使用Benjamini–Hochberg (BH)程序来控制跨家族的伪发现率（FDR）。\n\n您的任务：\n- 从上述基础出发，通过处理标准化变量$z_{ij} = y_{ij}/s_j$并利用上面陈述的负二项方差关系，为每个家族$i$推导一个离散参数$\\alpha_i$的矩量法估计量，同时认识到$\\mathbb{E}[z_{ij}] = \\theta_{ig}$和$\\mathrm{Var}(z_{ij}) = \\theta_{ig}/s_j + \\alpha_i \\, \\theta_{ig}^2$。使用所有样本为每个家族$i$构建一个单一的估计量$\\widehat{\\alpha}_i$，不使用任何来自外部来源的目标公式或简化公式。\n- 将组别估计量$\\widehat{\\theta}_{i0}$和$\\widehat{\\theta}_{i1}$定义为对照组（$g=0$）和衰老组（$g=1$）内$z_{ij}$的算术平均值。\n- 使用$z_{ij}$的方差公式和您估计的$\\widehat{\\alpha}_i$，推导组均值$\\widehat{\\theta}_{i0}$和$\\widehat{\\theta}_{i1}$的抽样方差，并由此推导出一个Wald型$z$统计量，以检验单侧假设$H_0: \\theta_{i1} \\le \\theta_{i0}$对$H_1: \\theta_{i1}  \\theta_{i0}$。从标准正态分布计算单侧$p$值。不要导入或假设外部的简化结果；从给定的方差公式和独立随机变量均值的性质出发。\n- 对于倍数变化量化，使用伪计数来计算以2为底的倍数变化对数，以避免除以零。定义一个在比率尺度上的伪计数，对应于所有样本平均文库大小下的半个计数：$\\epsilon = \\dfrac{0.5}{\\overline{s}}$，其中$\\overline{s}$是$s_j$的算术平均值。然后计算$\\log_2 \\mathrm{FC}_i = \\log_2 \\left( \\dfrac{\\widehat{\\theta}_{i1} + \\epsilon}{\\widehat{\\theta}_{i0} + \\epsilon} \\right)$。\n- 使用Benjamini–Hochberg升阶程序对所有家族的家族级单侧$p$值进行调整，以获得FDR校正值（也称为$q$值）。\n- 当且仅当两个条件同时满足时，宣布家族$i$发生去抑制：$\\log_2 \\mathrm{FC}_i \\ge 1.0$且BH校正的单侧$q$值$\\le 0.1$。\n\n角度单位和物理单位：\n- 此问题不需要任何角度量或物理单位。\n\n测试套件：\n- 共有$6$个样本，条件标签为$g = [0,0,0,1,1,1]$。相应的文库大小为$s = [20{,}000{,}000, 22{,}000{,}000, 18{,}000{,}000, 21{,}000{,}000, 23{,}000{,}000, 19{,}000{,}000]$。\n- 共有$4$个转座子家族。对于每个家族$i \\in \\{1,2,3,4\\}$，跨$6$个样本的计数向量$[y_{i1}, y_{i2}, y_{i3}, y_{i4}, y_{i5}, y_{i6}]$为：\n  - 家族$1$：$[50, 60, 55, 200, 240, 210]$。\n  - 家族$2$：$[100, 120, 110, 105, 115, 95]$。\n  - 家族$3$：$[0, 0, 1, 35, 45, 40]$。\n  - 家族$4$：$[30, 32, 29, 40, 41, 39]$。\n\n答案规格：\n- 对于每个家族$i$，按$i=1,2,3,4$的顺序，将决策计算为一个整数，其中$1$表示去抑制，$0$表示未去抑制。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个$r_i$是整数$0$或$1$。不应打印任何其他文本。", "solution": "该问题已经过验证，被认为是有效的。它具有科学依据，定义明确，客观，并包含足够的信息以获得唯一解。该模型假设在生物信息学中是分析测序实验计数数据的标准方法。各项任务定义清晰，并遵循差异表达分析的逻辑进展。\n\n该解决方案是通过从提供的基本原则推导出必要的统计估计量和检验统计量来制定的。\n\n设对照组（$g=0$）的样本索引集为$J_0 = \\{1, 2, 3\\}$，衰老组（$g=1$）的样本索引集为$J_1 = \\{4, 5, 6\\}$。每组的重复次数为$n_0 = |J_0| = 3$和$n_1 = |J_1| = 3$。转座子家族的总数为$m=4$。\n\n**步骤 1：标准化的表达率**\n对于每个转座子家族$i \\in \\{1, 2, 3, 4\\}$和样本$j \\in \\{1, ..., 6\\}$，观测到的计数$y_{ij}$通过其对应的文库大小$s_j$进行标准化，以获得标准化的表达率$z_{ij}$：\n$$z_{ij} = \\frac{y_{ij}}{s_j}$$\n根据问题陈述，$z_{ij}$的期望和方差为：\n$$\\mathbb{E}[z_{ij}] = \\theta_{ig}$$\n$$\\mathrm{Var}(z_{ij}) = \\frac{\\theta_{ig}}{s_j} + \\alpha_i \\theta_{ig}^2$$\n其中$g \\in \\{0, 1\\}$是样本$j$的条件，$\\alpha_i$是家族特异性的离散参数。\n\n**步骤 2：组别率估计量**\n家族$i$在对照和衰老条件下的表达率$\\theta_{i0}$和$\\theta_{i1}$，分别通过每组内标准化率$z_{ij}$的算术平均值来估计：\n$$\\widehat{\\theta}_{i0} = \\frac{1}{n_0} \\sum_{j \\in J_0} z_{ij}$$\n$$\\widehat{\\theta}_{i1} = \\frac{1}{n_1} \\sum_{j \\in J_1} z_{ij}$$\n\n**步骤 3：离散参数估计**\n推导离散参数$\\alpha_i$的矩量法估计量。对于给定的家族$i$，此估计量必须对两种条件通用。我们使用组内误差平方和（$WSS_i$）作为基础：\n$$WSS_i = \\sum_{g \\in \\{0,1\\}} \\sum_{j \\in J_g} (z_{ij} - \\widehat{\\theta}_{ig})^2$$\n$WSS_i$的期望可以与基础参数相关联。对于单个组$g$，平方和的期望是：\n$$\\mathbb{E} \\left[ \\sum_{j \\in J_g} (z_{ij} - \\widehat{\\theta}_{ig})^2 \\right] = \\frac{n_g-1}{n_g} \\sum_{j \\in J_g} \\mathrm{Var}(z_{ij})$$\n代入给定的方差公式：\n$$\\mathbb{E} \\left[ \\sum_{j \\in J_g} (z_{ij} - \\widehat{\\theta}_{ig})^2 \\right] = \\frac{n_g-1}{n_g} \\left( \\theta_{ig} \\sum_{j \\in J_g} \\frac{1}{s_j} + n_g \\alpha_i \\theta_{ig}^2 \\right)$$\n对两个组（$g=0, 1$）求和，并将观测到的$WSS_i$与其期望值（参数由其估计值$\\widehat{\\theta}_{ig}$替换）相等，我们得到一个关于$\\widehat{\\alpha}_i$的方程：\n$$WSS_i \\approx \\sum_{g \\in \\{0,1\\}} \\frac{n_g-1}{n_g} \\left( \\widehat{\\theta}_{ig} \\sum_{j \\in J_g} \\frac{1}{s_j} + n_g \\widehat{\\alpha}_i \\widehat{\\theta}_{ig}^2 \\right)$$\n求解$\\widehat{\\alpha}_i$得到：\n$$\\widehat{\\alpha}_i = \\frac{WSS_i - \\sum_{g \\in \\{0,1\\}} \\left( \\frac{n_g-1}{n_g} \\widehat{\\theta}_{ig} \\sum_{j \\in J_g} \\frac{1}{s_j} \\right)}{\\sum_{g \\in \\{0,1\\}} (n_g-1) \\widehat{\\theta}_{ig}^2}$$\n由于离散参数$\\alpha_i$必须为非负数，该估计量以$0$为下限：$\\widehat{\\alpha}_i = \\max(0, \\widehat{\\alpha}_i)$。\n\n**步骤 4：Wald型统计检验**\n为了检验单侧假设$H_0: \\theta_{i1} \\le \\theta_{i0}$对$H_1: \\theta_{i1}  \\theta_{i0}$，我们构建一个Wald型$z$统计量。该统计量基于平均率估计量的差值，$\\Delta_i = \\widehat{\\theta}_{i1} - \\widehat{\\theta}_{i0}$。由于两组独立，该差值的方差为$\\mathrm{Var}(\\Delta_i) = \\mathrm{Var}(\\widehat{\\theta}_{i0}) + \\mathrm{Var}(\\widehat{\\theta}_{i1})$。\n\n每个组均值估计量$\\widehat{\\theta}_{ig}$的抽样方差推导如下：\n$$\\mathrm{Var}(\\widehat{\\theta}_{ig}) = \\mathrm{Var}\\left(\\frac{1}{n_g} \\sum_{j \\in J_g} z_{ij}\\right) = \\frac{1}{n_g^2} \\sum_{j \\in J_g} \\mathrm{Var}(z_{ij})$$\n代入$\\mathrm{Var}(z_{ij})$的模型并插入估计的参数$\\widehat{\\theta}_{ig}$和$\\widehat{\\alpha}_i$，我们得到估计的方差：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\theta}_{ig}) = \\frac{1}{n_g^2} \\left( \\widehat{\\theta}_{ig} \\sum_{j \\in J_g} \\frac{1}{s_j} + n_g \\widehat{\\alpha}_i \\widehat{\\theta}_{ig}^2 \\right)$$\n差值的标准误为$SE(\\Delta_i) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\theta}_{i0}) + \\widehat{\\mathrm{Var}}(\\widehat{\\theta}_{i1})}$。则Wald统计量为：\n$$Z_i = \\frac{\\widehat{\\theta}_{i1} - \\widehat{\\theta}_{i0}}{SE(\\Delta_i)}$$\n在零假设下，$Z_i$近似服从标准正态分布$N(0, 1)$。单侧$p$值是观测到至少与$Z_i$一样大的统计量的概率，由$p_i = P(Z \\ge Z_i) = 1 - \\Phi(Z_i)$给出，其中$\\Phi$是标准正态分布的累积分布函数。\n\n**步骤 5：倍数变化计算**\n为了避免除以零或除以不稳定的小数，添加一个伪计数。伪计数$\\epsilon$在比率尺度上定义，对应于所有样本平均文库大小$\\overline{s} = \\frac{1}{n_0+n_1}\\sum_j s_j$下的$0.5$个计数：\n$$\\epsilon = \\frac{0.5}{\\overline{s}}$$\n以2为底的倍数变化对数计算如下：\n$$\\log_2 \\mathrm{FC}_i = \\log_2 \\left( \\frac{\\widehat{\\theta}_{i1} + \\epsilon}{\\widehat{\\theta}_{i0} + \\epsilon} \\right)$$\n\n**步骤 6：多重检验校正**\n使用Benjamini-Hochberg (BH)程序对$m=4$个家族级$p$值的集合$\\{p_1, p_2, p_3, p_4\\}$进行多重比较校正，以控制伪发现率（FDR）。设$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$是排序后的$p$值。第$k$个排序后$p$值的BH校正$p$值（或称$q$值）为：\n$$q_{(k)} = \\min_{j=k, \\dots, m} \\left( \\frac{m \\cdot p_{(j)}}{j} \\right)$$\n这确保了校正后的p值序列$q_{(1)} \\le q_{(2)} \\le \\dots \\le q_{(m)}$是单调的。得到的$q$值然后映射回其原始家族。\n\n**步骤 7：决策规则**\n当且仅当两个条件同时满足时，宣布一个家族$i$在衰老中发生去抑制：\n1. 对数倍数变化至少为$1.0$：$\\log_2 \\mathrm{FC}_i \\ge 1.0$。\n2. FDR校正的$q$值不大于$0.1$：$q_i \\le 0.1$。\n\n最终输出是针对家族$1$到$4$的二元决策（$1$表示去抑制，$0$表示未去抑制）列表。以下程序实现了这个完整的过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves the transposable element derepression problem by implementing a\n    full statistical analysis pipeline from first principles.\n    \"\"\"\n    # Define the problem data as specified in the test suite.\n    conditions = np.array([0, 0, 0, 1, 1, 1])\n    library_sizes = np.array([\n        20_000_000, 22_000_000, 18_000_000,\n        21_000_000, 23_000_000, 19_000_000\n    ], dtype=np.float64)\n    \n    counts = np.array([\n        [50, 60, 55, 200, 240, 210],  # Family 1\n        [100, 120, 110, 105, 115, 95], # Family 2\n        [0, 0, 1, 35, 45, 40],        # Family 3\n        [30, 32, 29, 40, 41, 39]      # Family 4\n    ], dtype=np.float64)\n\n    num_families = counts.shape[0]\n    \n    # Indices for control (g=0) and senescent (g=1) groups\n    ctrl_indices = np.where(conditions == 0)[0]\n    sene_indices = np.where(conditions == 1)[0]\n    n0 = len(ctrl_indices)\n    n1 = len(sene_indices)\n\n    # Pre-calculate sums of inverse library sizes for each group\n    s_inv_ctrl = np.sum(1.0 / library_sizes[ctrl_indices])\n    s_inv_sene = np.sum(1.0 / library_sizes[sene_indices])\n    \n    family_p_values = []\n    family_log2_fcs = []\n\n    for i in range(num_families):\n        y_i = counts[i, :]\n        \n        # Step 1: Calculate normalized expression rates z_ij\n        z_i = y_i / library_sizes\n        \n        # Step 2: Estimate group-wise rates theta_ig\n        z_ctrl = z_i[ctrl_indices]\n        z_sene = z_i[sene_indices]\n        \n        theta_hat_i0 = np.mean(z_ctrl)\n        theta_hat_i1 = np.mean(z_sene)\n        \n        # Step 3: Estimate dispersion alpha_i\n        # Numerator part\n        wss_i = np.sum((z_ctrl - theta_hat_i0)**2) + \\\n                np.sum((z_sene - theta_hat_i1)**2)\n        \n        shot_noise_term = ((n0 - 1)/n0 * theta_hat_i0 * s_inv_ctrl) + \\\n                          ((n1 - 1)/n1 * theta_hat_i1 * s_inv_sene)\n        \n        numerator_alpha = wss_i - shot_noise_term\n        \n        # Denominator part\n        denominator_alpha = ((n0 - 1) * theta_hat_i0**2) + \\\n                            ((n1 - 1) * theta_hat_i1**2)\n\n        if denominator_alpha  1e-20: # Safeguard against division by zero\n            alpha_hat_i = numerator_alpha / denominator_alpha\n        else:\n            alpha_hat_i = 0.0\n\n        alpha_hat_i = max(0.0, alpha_hat_i)\n\n        # Step 4: Wald-Type Statistical Test\n        # Estimate variance of group mean estimators\n        var_theta_hat_i0 = (theta_hat_i0 * s_inv_ctrl + n0 * alpha_hat_i * theta_hat_i0**2) / n0**2\n        var_theta_hat_i1 = (theta_hat_i1 * s_inv_sene + n1 * alpha_hat_i * theta_hat_i1**2) / n1**2\n        \n        # Standard error of the difference\n        se_delta_i = np.sqrt(var_theta_hat_i0 + var_theta_hat_i1)\n        \n        # Wald z-statistic\n        if se_delta_i  1e-20: # Safeguard against division by zero\n            z_statistic = (theta_hat_i1 - theta_hat_i0) / se_delta_i\n        else:\n            z_statistic = 0.0\n            \n        # One-sided p-value\n        p_value = norm.sf(z_statistic) # Survival function (1 - cdf)\n        family_p_values.append(p_value)\n\n        # Step 5: Fold-Change Calculation\n        mean_s = np.mean(library_sizes)\n        epsilon = 0.5 / mean_s\n        \n        log2_fc = np.log2((theta_hat_i1 + epsilon) / (theta_hat_i0 + epsilon))\n        family_log2_fcs.append(log2_fc)\n\n    # Step 6: Benjamini-Hochberg FDR correction\n    p_values = np.array(family_p_values)\n    num_tests = len(p_values)\n    \n    # Sort p-values and get original indices\n    p_order = p_values.argsort()\n    p_sorted = p_values[p_order]\n    \n    # Calculate BH q-values\n    q_values_sorted = p_sorted * num_tests / np.arange(1, num_tests + 1)\n    \n    # Enforce monotonicity\n    q_values_sorted = np.minimum.accumulate(q_values_sorted[::-1])[::-1]\n    \n    # Clip at 1.0\n    q_values_sorted = np.clip(q_values_sorted, a_min=0, a_max=1)\n    \n    # Reorder q-values to match original family order\n    q_values = np.empty_like(q_values_sorted)\n    q_values[p_order] = q_values_sorted\n\n    # Step 7: Decision Rule\n    results = []\n    for i in range(num_families):\n        is_derepressed = (family_log2_fcs[i] = 1.0) and (q_values[i] = 0.1)\n        results.append(1 if is_derepressed else 0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2555935"}]}