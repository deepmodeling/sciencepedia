{"hands_on_practices": [{"introduction": "将生物过程转化为数学语言是定量理解细胞信号转导的核心技能。这项练习 ([@problem_id:2580063]) 引导我们为环磷酸腺苷（cAMP）的动态建立一个简洁而强大的动力学模型，cAMP是G蛋白偶联受体（GPCR）信号通路中一种普遍存在的第二信使。通过构建和求解描述cAMP合成与降解的微分方程，我们将学会如何预测信号响应的时间进程，并评估磷酸二酯酶（PDE）抑制剂等药物干预的效果。", "problem": "一个与刺激性鸟苷酸核苷结合蛋白（G蛋白）偶联的G蛋白偶联受体（GPCR）激活腺苷酸环化酶（AC），后者在受到阶跃刺激后以恒定速率合成环磷酸腺苷（cAMP）。胞质溶胶中的cAMP被磷酸二酯酶（PDE）通过一级动力学水解。假设胞质溶胶是充分混合的，并且在刺激时基础cAMP水平可以忽略不计。具体来说，在时间 $t=0$ 时，合成速率从 $0$ 阶跃到一个恒定值 $v_{\\text{AC}}$，而一级降解速率常数为 $k_{\\text{PDE}}$。令 $c(t)$ 表示cAMP浓度。\n\n仅从cAMP池的质量守恒和PDE一级降解的假设出发，写出控制方程，并在给定 $c(0)=0$ 的条件下求解 $c(t)$。定义稳态浓度 $c_{\\infty}$ 以及在 $v_{\\text{AC}}$ 发生阶跃后 $c(t)$ 达到 $c_{\\infty}$ 的0.9所需的时间 $t_{0.9}$。\n\n已知 $v_{\\text{AC}}=0.5\\,\\mu\\text{M}\\,\\text{s}^{-1}$ 和 $k_{\\text{PDE}}=0.1\\,\\text{s}^{-1}$。计算：\n- 当 $k_{\\text{PDE}}=0.1\\,\\text{s}^{-1}$ 时 $t_{0.9}$ 的值。\n- 当PDE抑制剂使降解速率常数减半至 $k_{\\text{PDE}}/2$ 时 $t_{0.9}$ 的值。\n- 将 $k_{\\text{PDE}}$ 减半引起的稳态cAMP浓度 $c_{\\infty}$ 的倍数变化。\n\n两个时间均以秒为单位报告，倍数变化以小数（而非百分比）形式报告。所有数值答案均四舍五入至四位有效数字。", "solution": "该问题要求分析环磷酸腺苷（$cAMP$）浓度（记为 $c(t)$）在其合成速率发生阶跃增加后的动力学过程。该过程受质量守恒原理支配。浓度变化率 $\\frac{dc}{dt}$ 是其合成和降解的净结果。\n\n首先，需要对问题陈述进行验证。\n已知条件如下：\n- 系统是一个充分混合的胞质溶胶。\n- 在时间 $t=0$ 时，腺苷酸环化酶（AC）对 $cAMP$ 的合成速率从 $0$ 变为一个恒定值 $v_{\\text{AC}}$。\n- 磷酸二酯酶（PDE）对 $cAMP$ 的降解遵循一级动力学，速率常数为 $k_{\\text{PDE}}$。\n- $cAMP$ 的初始浓度为零：$c(0)=0$。\n- 提供的具体数值为 $v_{\\text{AC}} = 0.5\\,\\mu\\text{M}\\,\\text{s}^{-1}$ 和 $k_{\\text{PDE}} = 0.1\\,\\text{s}^{-1}$。\n\n该问题具有科学依据，因为它描述了一个标准的、已被广泛接受的动力学模型（零级产生，一级衰减），该模型在系统生物学和药理学中常用于模拟信号通路。这是一个适定问题，提供了一个带特定初始条件的一阶常微分方程，从而保证了解的唯一性。语言客观精确。问题是自洽的，提供了求解所需的所有参数和条件。单位在量纲上是一致的。因此，该问题是有效的，可以构建其解。\n\n通过平衡产生和消耗的速率来构建控制微分方程。\n对于 $t \\ge 0$，合成速率是恒定的，由 $v_{\\text{AC}}$ 给出。\n降解速率是一级的，由速率常数 $k_{\\text{PDE}}$ 和浓度 $c(t)$ 的乘积给出。\n因此，控制方程为：\n$$\n\\frac{dc}{dt} = v_{\\text{AC}} - k_{\\text{PDE}}c(t)\n$$\n这是一个一阶线性非齐次常微分方程。我们必须在初始条件 $c(0)=0$ 下求解它。该方程可以整理为：\n$$\n\\frac{dc}{dt} + k_{\\text{PDE}}c(t) = v_{\\text{AC}}\n$$\n这个方程可以通过分离变量法求解：\n$$\n\\frac{dc}{v_{\\text{AC}} - k_{\\text{PDE}}c} = dt\n$$\n我们对等式两边从初始状态（$t=0$, $c=0$）积分到任意状态（$t$, $c(t)$）：\n$$\n\\int_{0}^{c(t)} \\frac{d\\tilde{c}}{v_{\\text{AC}} - k_{\\text{PDE}}\\tilde{c}} = \\int_{0}^{t} d\\tilde{t}\n$$\n计算积分可得：\n$$\n\\left[ -\\frac{1}{k_{\\text{PDE}}} \\ln(v_{\\text{AC}} - k_{\\text{PDE}}\\tilde{c}) \\right]_{0}^{c(t)} = [ \\tilde{t} ]_{0}^{t}\n$$\n$$\n-\\frac{1}{k_{\\text{PDE}}} \\left[ \\ln(v_{\\text{AC}} - k_{\\text{PDE}}c(t)) - \\ln(v_{\\text{AC}}) \\right] = t\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\n-\\frac{1}{k_{\\text{PDE}}} \\ln\\left(\\frac{v_{\\text{AC}} - k_{\\text{PDE}}c(t)}{v_{\\text{AC}}}\\right) = t\n$$\n整理并求解 $c(t)$：\n$$\n\\ln\\left(1 - \\frac{k_{\\text{PDE}}}{v_{\\text{AC}}}c(t)\\right) = -k_{\\text{PDE}}t\n$$\n$$\n1 - \\frac{k_{\\text{PDE}}}{v_{\\text{AC}}}c(t) = \\exp(-k_{\\text{PDE}}t)\n$$\n$$\nc(t) = \\frac{v_{\\text{AC}}}{k_{\\text{PDE}}} \\left( 1 - \\exp(-k_{\\text{PDE}}t) \\right)\n$$\n这是 $c(t)$ 的解析解。\n\n稳态浓度 $c_{\\infty}$ 是当 $t \\to \\infty$ 时的浓度。在此极限下，$\\exp(-k_{\\text{PDE}}t) \\to 0$。\n$$\nc_{\\infty} = \\lim_{t \\to \\infty} c(t) = \\frac{v_{\\text{AC}}}{k_{\\text{PDE}}} (1 - 0) = \\frac{v_{\\text{AC}}}{k_{\\text{PDE}}}\n$$\n$c(t)$ 的解可以用 $c_{\\infty}$ 重写为：\n$$\nc(t) = c_{\\infty} \\left( 1 - \\exp(-k_{\\text{PDE}}t) \\right)\n$$\n时间 $t_{0.9}$ 被定义为 $c(t)$ 达到 $c_{\\infty}$ 的0.9倍时的时间。我们设 $c(t_{0.9}) = 0.9 c_{\\infty}$：\n$$\n0.9 c_{\\infty} = c_{\\infty} \\left( 1 - \\exp(-k_{\\text{PDE}}t_{0.9}) \\right)\n$$\n两边同除以 $c_{\\infty}$（由于 $v_{\\text{AC}}  0$，所以 $c_{\\infty}$ 非零）：\n$$\n0.9 = 1 - \\exp(-k_{\\text{PDE}}t_{0.9})\n$$\n$$\n\\exp(-k_{\\text{PDE}}t_{0.9}) = 1 - 0.9 = 0.1\n$$\n对两边取自然对数：\n$$\n-k_{\\text{PDE}}t_{0.9} = \\ln(0.1) = -\\ln(10)\n$$\n因此，$t_{0.9}$ 的表达式为：\n$$\nt_{0.9} = \\frac{\\ln(10)}{k_{\\text{PDE}}}\n$$\n现在，我们计算所需的数值。\n\n1.  当 $k_{\\text{PDE}} = 0.1\\,\\text{s}^{-1}$ 时 $t_{0.9}$ 的值：\n    $$\n    t_{0.9} = \\frac{\\ln(10)}{0.1} \\approx \\frac{2.302585...}{0.1} = 23.02585...\\,\\text{s}\n    $$\n    四舍五入到四位有效数字得到 $23.03$。\n\n2.  当降解速率常数减半为 $k'_{\\text{PDE}} = k_{\\text{PDE}}/2$ 时 $t_{0.9}$ 的值：\n    新的常数为 $k'_{\\text{PDE}} = 0.1\\,\\text{s}^{-1} / 2 = 0.05\\,\\text{s}^{-1}$。\n    新的时间 $t'_{0.9}$ 是：\n    $$\n    t'_{0.9} = \\frac{\\ln(10)}{k'_{\\text{PDE}}} = \\frac{\\ln(10)}{0.05} \\approx \\frac{2.302585...}{0.05} = 46.0517...\\,\\text{s}\n    $$\n    四舍五入到四位有效数字得到 $46.05$。\n\n3.  将 $k_{\\text{PDE}}$ 减半引起的稳态浓度 $c_{\\infty}$ 的倍数变化：\n    原始稳态浓度为 $c_{\\infty} = v_{\\text{AC}} / k_{\\text{PDE}}$。\n    当 $k'_{\\text{PDE}} = k_{\\text{PDE}}/2$ 时，新的稳态浓度为：\n    $$\n    c'_{\\infty} = \\frac{v_{\\text{AC}}}{k'_{\\text{PDE}}} = \\frac{v_{\\text{AC}}}{k_{\\text{PDE}}/2} = 2 \\left( \\frac{v_{\\text{AC}}}{k_{\\text{PDE}}} \\right) = 2 c_{\\infty}\n    $$\n    倍数变化是新浓度与原始浓度的比值：\n    $$\n    \\text{Fold-change} = \\frac{c'_{\\infty}}{c_{\\infty}} = \\frac{2 c_{\\infty}}{c_{\\infty}} = 2\n    $$\n    以四位有效数字的小数表示为 $2.000$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 23.03  46.05  2.000 \\end{pmatrix}}\n$$", "id": "2580063"}, {"introduction": "理解药物如何产生作用，关键在于区分其与靶点的分子亲和力及在生物系统中的整体效力。这项练习 ([@problem_id:2580019]) 深入探讨了激动剂作用的操作模型，这是一个从数学上将药物-受体亲和力（$K_A$）与决定最终效力的细胞环境（由参数 $\\tau$ 体现）分离开来的药理学框架。通过推导半数有效浓度（EC50）的表达式，我们将揭示为何同一药物在不同组织中的效力可能截然不同，这是药物研发中的一个关键概念。", "problem": "一个药理学系统包含一个配体门控受体，该受体与一个效应器偶联以产生可测量的反应。设激动剂用 $A$ 表示，其平衡解离常数为 $K_A$（亲和力参数），受体-效应器偶联效率和受体储备由一个无量纲的转导参数 $\\tau$（受体储备）概括。系统层面的最大反应能力为 $E_{\\max}$（由组织/测定设定的反应极限）。考虑广泛使用的激动剂作用操作模型（单一位点，单位希尔斜率），该模型将受体占据和刺激-反应偶联结合到剂量-反应函数中\n$$\nE([A]) \\;=\\; \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A \\;+\\; (1+\\tau)\\,[A]}\\,.\n$$\n根据定义，该激动剂在该系统中的观测最大反应为 $E_{\\text{obs,max}} \\equiv \\lim_{[A]\\to\\infty} E([A])$，而半数有效浓度（EC50）是能产生 $E([A]) = \\tfrac{1}{2}\\,E_{\\text{obs,max}}$ 反应的浓度 $[A]$。\n\n严格地从上述模型和这些定义出发，推导以 $K_A$ 和 $\\tau$ 表示的 $\\mathrm{EC}_{50}$ 的闭式表达式。从第一性原理出发，解释受体储备 $\\tau$ 为何以及如何相对于亲和力压缩效价，并陈述在何种有机制依据的条件下，效价在不同组织或实验条件下不与亲和力同步变化（例如，当两个制剂具有相同的 $K_A$ 但 $\\mathrm{EC}_{50}$ 不同时）。你最终报告的答案必须是 $\\mathrm{EC}_{50}$ 作为 $K_A$ 和 $\\tau$ 函数的解析表达式。最终答案中不要包含单位。如果你选择评估任何极限情况，请保持符号形式。无需四舍五入。", "solution": "所述问题具有科学依据，提法明确，且内部一致。它基于由 Black and Leff 引入的、已确立的激动剂作用操作模型，这是定量药理学中的一个基本概念。我们将根据所提供的定义进行严格的推导。\n\n目标是从给定的剂量-反应函数中推导出半数有效浓度 $\\mathrm{EC}_{50}$ 的表达式：\n$$E([A]) = \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A + (1+\\tau)\\,[A]}$$\n此处，$[A]$ 是激动剂浓度，$K_A$ 是平衡解离常数，$\\tau$ 是转导参数，$E_{\\max}$ 是系统的最大可能反应。\n\n首先，我们必须确定观测到的最大反应 $E_{\\text{obs,max}}$，它被定义为当 $[A]$ 趋于无穷大时反应函数的极限。\n$$E_{\\text{obs,max}} \\equiv \\lim_{[A]\\to\\infty} E([A]) = \\lim_{[A]\\to\\infty} \\frac{E_{\\max}\\,\\tau\\,[A]}{K_A + (1+\\tau)\\,[A]}$$\n为了计算这个极限，我们将分子和分母同时除以 $[A]$：\n$$E_{\\text{obs,max}} = \\lim_{[A]\\to\\infty} \\frac{E_{\\max}\\,\\tau}{\\frac{K_A}{[A]} + (1+\\tau)}$$\n当 $[A] \\to \\infty$ 时，项 $\\frac{K_A}{[A]}$ 趋近于 $0$。因此，极限为：\n$$E_{\\text{obs,max}} = \\frac{E_{\\max}\\,\\tau}{0 + (1+\\tau)} = \\frac{E_{\\max}\\,\\tau}{1+\\tau}$$\n此表达式代表了激动剂在此特定系统中可达到的最大反应，如果该激动剂是部分激动剂（对应于 $\\tau$ 不足以使反应能力饱和的情景），该值可能小于理论上的系统最大值 $E_{\\max}$。\n\n接下来，我们使用 $\\mathrm{EC}_{50}$ 的定义：产生相当于观测最大值一半反应的激动剂浓度，即 $E(\\mathrm{EC}_{50}) = \\frac{1}{2}E_{\\text{obs,max}}$。我们将 $E([A])$ 和 $E_{\\text{obs,max}}$ 的表达式代入这个定义方程中：\n$$\\frac{E_{\\max}\\,\\tau\\,\\mathrm{EC}_{50}}{K_A + (1+\\tau)\\,\\mathrm{EC}_{50}} = \\frac{1}{2} \\left( \\frac{E_{\\max}\\,\\tau}{1+\\tau} \\right)$$\n假设激动剂能引起反应，则 $\\tau$ 和 $E_{\\max}$ 均为非零量，因此可以消去方程两边的项 $E_{\\max}\\,\\tau$：\n$$\\frac{\\mathrm{EC}_{50}}{K_A + (1+\\tau)\\,\\mathrm{EC}_{50}} = \\frac{1}{2(1+\\tau)}$$\n为求解 $\\mathrm{EC}_{50}$，我们进行交叉相乘：\n$$2(1+\\tau)\\,\\mathrm{EC}_{50} = K_A + (1+\\tau)\\,\\mathrm{EC}_{50}$$\n然后我们分离含有 $\\mathrm{EC}_{50}$ 的项：\n$$2(1+\\tau)\\,\\mathrm{EC}_{50} - (1+\\tau)\\,\\mathrm{EC}_{50} = K_A$$\n$$(2(1+\\tau) - (1+\\tau))\\,\\mathrm{EC}_{50} = K_A$$\n$$(1+\\tau)\\,\\mathrm{EC}_{50} = K_A$$\n最后，两边除以 $(1+\\tau)$，得到 $\\mathrm{EC}_{50}$ 的闭式表达式：\n$$\\mathrm{EC}_{50} = \\frac{K_A}{1+\\tau}$$\n这就是所要求的解析表达式。\n\n现在，我们必须解释效价（$\\mathrm{EC}_{50}$）和亲和力（$K_A$）之间的关系。效价与 $\\mathrm{EC}_{50}$ 成反比（$\\mathrm{EC}_{50}$ 越小，效价越高），而亲和力与 $K_A$ 成反比（$K_A$ 越小，亲和力越高）。转导参数 $\\tau$ 是衡量受体储备和信号传导效率的指标；根据定义，$\\tau \\ge 0$。\n推导出的表达式 $\\mathrm{EC}_{50} = K_A / (1+\\tau)$ 表明，对于任何具有非零受体储备（$\\tau  0$）的系统，我们有 $1+\\tau  1$，这意味着 $\\mathrm{EC}_{50}  K_A$。\n这意味着引起半数最大*反应*所需的浓度低于达到半数受体*占据*所需的浓度。\n由 $\\tau$ 体现的受体储备有效地放大了受体结合产生的信号。一个高效的系统（大的 $\\tau$）仅需一小部分受体被占据即可产生显著的反应，从而使剂量-反应曲线相对于结合曲线向左移动，并增加了激动剂的表观效价。\n“相对于亲和力压缩效价”这一说法指的是 $\\mathrm{EC}_{50}$ 的数值被“压缩”得小于 $K_A$ 的现象。这种效应的大小由因子 $(1+\\tau)$ 决定。\n\n最后，我们讨论效价不与亲和力同步变化的条件。推导出的公式表明，$\\mathrm{EC}_{50}$ 是两个参数的函数：$K_A$，这是药物-受体相互作用的属性；以及 $\\tau$，这是生物系统（如细胞、组织）的属性。问题给出了一个例子，两个制剂具有相同的 $K_A$ 但 $\\mathrm{EC}_{50}$ 不同。当一个单一激动剂（恒定的 $K_A$）在两个不同的系统（比如系统1和系统2）中进行测试，而这两个系统具有不同的转导参数 $\\tau_1$ 和 $\\tau_2$ 时，就会出现这种情况。其效价分别为：\n$$\\mathrm{EC}_{50,1} = \\frac{K_A}{1+\\tau_1} \\quad \\text{和} \\quad \\mathrm{EC}_{50,2} = \\frac{K_A}{1+\\tau_2}$$\n如果 $\\tau_1 \\neq \\tau_2$，那么必然有 $\\mathrm{EC}_{50,1} \\neq \\mathrm{EC}_{50,2}$，即使激动剂对受体的亲和力 $K_A$ 在两个系统中是相同的。\n从机制上讲，$\\tau$ 反映了受体密度和下游信号转导级联的效率等因素。这些特性在不同的生物学背景下差异很大。因此，在比较以下情况时，效价（$\\mathrm{EC}_{50}$）将无法与亲和力（$K_A$）同步变化：\n1. 不同的组织或细胞类型，它们自然表达不同水平的受体和信号传导组分。\n2. 处于不同生理或病理状态下的同一组织（例如，疾病引起的受体表达变化）。\n3. 受体群体被人为改变的实验制剂，例如通过部分不可逆拮抗作用，这会降低 $\\tau$ 的有效值。\n总之，亲和力是药物与其靶受体之间分子相互作用的特征，而效价则是一个涌现的、依赖于系统的属性，它既反映了这种亲和力，也反映了细胞环境的下游信号放大能力。", "answer": "$$\\boxed{\\frac{K_A}{1+\\tau}}$$", "id": "2580019"}, {"introduction": "现代受体生理学研究日益依赖于计算模型来整合复杂的生物过程并从实验数据中提取深刻见解。这项综合性练习 ([@problem_id:2579988]) 要求我们运用计算系统生物学的方法，构建一个包含受体脱敏、内吞转运和空间分离的内体信号转导的多室模型。这个实践模拟了当代研究工作流程，通过数值模拟和参数拟合来估计未知的动力学速率，并预测如内体信号贡献度这样的复杂细胞行为。", "problem": "给定一个基于G蛋白偶联受体（GPCR）的受体信号传导和arrestin介导的脱敏的机制建模任务。您需要使用质量作用定律和线性常微分方程来构建并求解下述模型，然后进行参数估计和派生预测。您编写的程序必须是一个完整的、可运行的程序，能够执行整个工作流程，并按规定格式打印所要求的输出。\n\n背景和模型设定：\n- 在时间 $t=0$ 时，受体被一个阶跃的激动剂激活，信号传导通过环磷酸腺苷（cAMP）的产生而进行。Beta-arrestin与质膜上的活化受体结合，并介导其内化至内体室，信号传导可能在那里继续。\n- 使用以下状态变量：\n  - $R_p(t)$：质膜上的活化受体。\n  - $R_{pA}(t)$：质膜上与arrestin结合的受体。\n  - $R_e(t)$：内体中的活化受体。\n  - $c(t)$：cAMP浓度。\n- 生成速率：\n  - 质膜cAMP生成速率 $v_p(t) = \\beta_p R_p(t)$。\n  - 内体cAMP生成速率 $v_e(t) = \\beta_e R_e(t)$。\n- 降解：\n  - cAMP以一级速率常数 $k_{\\mathrm{deg}}$ 进行降解。\n- 动力学（质量作用定律）：\n  - $R_p(t)$ 因arrestin结合和失活而减少，相应的速率常数分别为 $k_{\\mathrm{on}}[A]$ 和 $k_{\\mathrm{off}}$。\n  - $R_{pA}(t)$ 因arrestin结合而增加，并因内化而减少，内化速率常数为 $k_{\\mathrm{int}}$。\n  - $R_e(t)$ 因从 $R_{pA}(t)$ 内化而来增加，并因失活而减少，失活速率常数为 $k_{\\mathrm{off},e}$。\n  - $c(t)$ 因 $v_p(t) + v_e(t)$ 而增加，并因 $k_{\\mathrm{deg}} c(t)$ 而减少。\n- $t=0$ 时的初始条件：\n  - $R_p(0) = R_0$, $R_{pA}(0) = 0$, $R_e(0) = 0$, $c(0) = 0$.\n\n需要实现的数学公式：\n- 使用以下方程组，其中 $[A]$ 是arrestin浓度：\n$$\n\\frac{dR_p}{dt} = - k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{off}} R_p,\n\\quad\n\\frac{dR_{pA}}{dt} = k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{int}} R_{pA},\n$$\n$$\n\\frac{dR_e}{dt} = k_{\\mathrm{int}} R_{pA} - k_{\\mathrm{off},e} R_e,\n\\quad\n\\frac{dc}{dt} = \\beta_p R_p + \\beta_e R_e - k_{\\mathrm{deg}} c.\n$$\n\n已知常数（请精确使用这些值）：\n- $R_0 = 1.0$（受体浓度的任意单位）。\n- $\\beta_p = 5.0\\,\\mathrm{nM}\\cdot \\mathrm{s}^{-1}$ 每受体单位。\n- $\\beta_e = 3.0\\,\\mathrm{nM}\\cdot \\mathrm{s}^{-1}$ 每受体单位。\n- $k_{\\mathrm{off}} = 0.02\\,\\mathrm{s}^{-1}$。\n- $k_{\\mathrm{int}} = 0.05\\,\\mathrm{s}^{-1}$。\n- $k_{\\mathrm{off},e} = 0.01\\,\\mathrm{s}^{-1}$。\n- $k_{\\mathrm{deg}} = 0.3\\,\\mathrm{s}^{-1}$。\n\n数据和拟合方案：\n- arrestin浓度 $[A]$ 取两个值：基线值 $[A]_b = 1$（任意单位）和过表达值 $[A]_o = \\alpha$（任意单位），其中 $\\alpha$ 在下文的每个测试案例中指定。\n- 测量的时间网格为\n  $$\n  \\mathcal{T} = [\\,0,\\,10,\\,20,\\,40,\\,60,\\,90,\\,120,\\,180\\,] \\text{ 秒}。\n  $$\n- 对于每个测试案例，必须通过数值积分模型来生成合成的“观测”cAMP数据。积分时使用提供的arrestin结合速率真实值 $k_{\\mathrm{on}}^{\\star}$，并针对 $[A]_b$ 和 $[A]_o$ 两种情况，在时间点 $\\mathcal{T}$ 上进行采样。\n- 使用这两个合成数据集（基线和过表达），通过在共享时间点 $\\mathcal{T}$ 上最小化两个数据集的总残差平方和来估计 $k_{\\mathrm{on}}$。唯一的决策变量是 $k_{\\mathrm{on}}$。在每种条件下，将 $[A]_b$ 和 $[A]_o$ 视为已知常数。对 $k_{\\mathrm{on}}$ 使用非负约束。\n\n派生预测：\n- 将时间窗口 $[0, T]$ 内的内体信号传导程度定义为分数\n  $$\n  \\Phi(T) = \\frac{\\int_{0}^{T} v_e(t)\\,dt}{\\int_{0}^{T} \\left(v_p(t)+v_e(t)\\right)\\,dt},\n  $$\n  在过表达条件 $[A]_o$ 下计算。通过用积分状态 $s_e(t)$ 和 $s_{\\mathrm{tot}}(t)$ 扩展原系统来计算 $\\Phi(T)$，其控制方程为\n  $$\n  \\frac{ds_e}{dt} = v_e(t), \\quad \\frac{ds_{\\mathrm{tot}}}{dt} = v_p(t)+v_e(t),\n  $$\n  初始条件为 $s_e(0)=0$ 和 $s_{\\mathrm{tot}}(0)=0$，因此 $\\Phi(T) = s_e(T)/s_{\\mathrm{tot}}(T)$。\n\n单位和输出：\n- 报告估计的arrestin结合速率 $k_{\\mathrm{on}}$，单位为 $\\mathrm{s}^{-1}$ 每任意arrestin浓度单位，四舍五入到 $6$ 位小数。\n- 报告每个内体信号传导程度 $\\Phi(T)$，为一个在 $[0,1]$ 范围内的无单位小数，四舍五入到 $6$ 位小数。\n\n测试套件：\n- 使用以下三个测试案例。对于每个案例 $i$，使用 $k_{\\mathrm{on}}^{\\star}$ 生成数据并按所述方法拟合 $k_{\\mathrm{on}}$，然后在过表达条件 $[A]_o$ 下计算指定 $T_i$ 的 $\\Phi(T_i)$。\n  - 案例1：$\\alpha=5$， $k_{\\mathrm{on}}^{\\star}=0.08\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$，$T_1=180\\,\\mathrm{s}$。\n  - 案例2：$\\alpha=2$， $k_{\\mathrm{on}}^{\\star}=0.05\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$，$T_2=120\\,\\mathrm{s}$。\n  - 案例3：$\\alpha=8$， $k_{\\mathrm{on}}^{\\star}=0.12\\,\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$，$T_3=60\\,\\mathrm{s}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来：\n  $$\n  [\\,k_1,\\,\\Phi(T_1),\\,k_2,\\,\\Phi(T_2),\\,k_3,\\,\\Phi(T_3)\\,],\n  $$\n  其中 $k_i$ 是案例 $i$ 估计的 $k_{\\mathrm{on}}$（单位为 $\\mathrm{s}^{-1}\\,\\mathrm{AU}^{-1}$），四舍五入到 $6$ 位小数，而 $\\Phi(T_i)$ 是相应的内体信号分数，四舍五入到 $6$ 位小数。不应打印任何其他文本。", "solution": "该问题定义明确且有效。它提出了定量系统药理学中的一个标准任务：基于常微分方程（ODE）的机制模型的构建、校准和分析。该模型描述了G蛋白偶联受体（GPCR）的信号传导、脱敏和运输，这些是细胞生物学中的基本过程。所有参数、初始条件和步骤都以足够的清晰度和科学真实性进行了规定，从而能够得出一个唯一且有意义的解。问题中没有矛盾、歧义或违反科学原理之处。\n\n对于每个测试案例，求解过程系统地分为三个主要阶段：合成数据生成、参数估计和派生生物学量的预测。\n\n模型的核心是以下由四个耦合的一阶线性常微分方程组成的系统，它描述了质膜上的活化受体（$R_p$）、与arrestin结合的质膜受体（$R_{pA}$）、内体中的活化受体（$R_e$）和环磷酸腺苷（$c$）浓度随时间的演变：\n$$\n\\frac{dR_p}{dt} = - (k_{\\mathrm{on}} [A] + k_{\\mathrm{off}}) R_p\n$$\n$$\n\\frac{dR_{pA}}{dt} = k_{\\mathrm{on}} [A] R_p - k_{\\mathrm{int}} R_{pA}\n$$\n$$\n\\frac{dR_e}{dt} = k_{\\mathrm{int}} R_{pA} - k_{\\mathrm{off},e} R_e\n$$\n$$\n\\frac{dc}{dt} = \\beta_p R_p + \\beta_e R_e - k_{\\mathrm{deg}} c\n$$\n该系统满足初始条件 $R_p(0) = R_0 = 1.0$，且 $R_{pA}(0) = R_e(0) = c(0) = 0$。\n\n**1. 合成数据生成**\n对于每个测试案例，我们首先生成合成的“实验”数据。这是一个被称为“孪生实验”的常用程序，用于验证参数估计方法。我们使用提供的arrestin结合速率真实值 $k_{\\mathrm{on}}^{\\star}$ 对4态ODE系统进行数值积分。这一过程在两种不同条件下完成：基线arrestin水平 $[A]_b = 1.0$ 和过表达水平 $[A]_o = \\alpha$。得到的cAMP浓度 $c(t)$ 在指定的时间点 $\\mathcal{T} = [\\,0,\\,10,\\,20,\\,40,\\,60,\\,90,\\,120,\\,180\\,]\\,\\mathrm{s}$ 进行采样。这两组时程数据构成了后续参数估计的基础。数值积分使用 `scipy.integrate` 库中的 `solve_ivp` 函数执行，这是一个用于求解初值问题的稳健工具。\n\n**2. 参数估计**\n下一步是使用上一步生成的合成数据来估计参数 $k_{\\mathrm{on}}$。这被构建为一个非线性最小二乘优化问题。目标是找到使模型的预测cAMP浓度与合成数据之间的残差平方和（SSR）最小化的 $k_{\\mathrm{on}}$ 值。目标函数是：\n$$\n\\mathrm{SSR}(k_{\\mathrm{on}}) = \\sum_{t \\in \\mathcal{T}} \\left(c_{\\mathrm{sim}}(t; k_{\\mathrm{on}}, [A]_b) - c_{\\mathrm{obs}}(t; k_{\\mathrm{on}}^{\\star}, [A]_b)\\right)^2 + \\sum_{t \\in \\mathcal{T}} \\left(c_{\\mathrm{sim}}(t; k_{\\mathrm{on}}, [A]_o) - c_{\\mathrm{obs}}(t; k_{\\mathrm{on}}^{\\star}, [A]_o)\\right)^2\n$$\n此处，$c_{\\mathrm{sim}}$ 表示模型对候选 $k_{\\mathrm{on}}$ 产生的cAMP浓度，$c_{\\mathrm{obs}}$ 是合成数据。最小化过程同时在基线和过表达数据集上进行，以稳健地约束参数。我们使用 `scipy.optimize` 中的 `minimize` 函数和L-BFGS-B算法，该算法可以处理速率常数必须为非负的物理约束，即 $k_{\\mathrm{on}} \\ge 0$。由于数据是由被拟合的相同模型结构生成的，我们预计估计的 $k_{\\mathrm{on}}$ 将与真实值 $k_{\\mathrm{on}}^{\\star}$ 几乎完全相同。\n\n**3. 内体信号分数的预测**\n利用估计出的 $k_{\\mathrm{on}}$ 值（下文表示为 $k_{\\mathrm{on,est}}$），我们计算源自内体室的总信号传导分数 $\\Phi(T)$。该指标定义为：\n$$\n\\Phi(T) = \\frac{\\int_{0}^{T} v_e(t)\\,dt}{\\int_{0}^{T} \\left(v_p(t)+v_e(t)\\right)\\,dt} = \\frac{\\int_{0}^{T} \\beta_e R_e(t)\\,dt}{\\int_{0}^{T} \\left(\\beta_p R_p(t) + \\beta_e R_e(t)\\right)\\,dt}\n$$\n为了精确计算这些积分，我们用两个额外的状态来扩展原始ODE系统：$s_e(t) = \\int_0^t v_e(\\tau) d\\tau$ 和 $s_{\\mathrm{tot}}(t) = \\int_0^t (v_p(\\tau)+v_e(\\tau)) d\\tau$。它们的动力学由以下方程给出：\n$$\n\\frac{ds_e}{dt} = v_e(t) = \\beta_e R_e(t)\n$$\n$$\n\\frac{ds_{\\mathrm{tot}}}{dt} = v_p(t)+v_e(t) = \\beta_p R_p(t) + \\beta_e R_e(t)\n$$\n初始条件为 $s_e(0)=0$ 和 $s_{\\mathrm{tot}}(0)=0$。我们对每个案例，使用估计的参数 $k_{\\mathrm{on,est}}$ 和过表达条件 $[A]_o = \\alpha$，将这个扩展的6态系统从 $t=0$ 积分到指定时间 $T_i$。所求的分数即为积分状态最终值的比率：$\\Phi(T_i) = s_e(T_i) / s_{\\mathrm{tot}}(T_i)$。由于质膜的信号传导在 $t=0$ 时立即开始，因此对于 $T_i  0$，分母 $s_{\\mathrm{tot}}(T_i)$ 保证不为零。\n\n对三个测试案例中的每一个都执行了这整个计算工作流程，并按要求格式化了最终结果。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Solves the GPCR signaling model problem by generating synthetic data,\n    fitting the arrestin association rate k_on, and predicting the endosomal\n    signaling fraction for three test cases.\n    \"\"\"\n    # Known constants, as specified in the problem\n    params_const = {\n        'R0': 1.0,          # Initial active receptor concentration\n        'beta_p': 5.0,      # Plasma membrane cAMP production rate coeff\n        'beta_e': 3.0,      # Endosomal cAMP production rate coeff\n        'k_off': 0.02,      # Receptor deactivation rate\n        'k_int': 0.05,      # Internalization rate\n        'k_off_e': 0.01,    # Endosomal receptor deactivation rate\n        'k_deg': 0.3,       # cAMP degradation rate\n    }\n\n    # Time points for data sampling\n    T_grid = np.array([0., 10., 20., 40., 60., 90., 120., 180.])\n    \n    # Baseline arrestin concentration\n    A_b = 1.0\n\n    # Test cases\n    test_cases = [\n        {'alpha': 5.0, 'k_on_star': 0.08, 'T': 180.0, 'case_id': 1},\n        {'alpha': 2.0, 'k_on_star': 0.05, 'T': 120.0, 'case_id': 2},\n        {'alpha': 8.0, 'k_on_star': 0.12, 'T': 60.0, 'case_id': 3},\n    ]\n\n    final_results = []\n\n    # ODE system function for the 4-state model (fitting)\n    def ode_system_4_states(t, y, k_on, A_val, p):\n        Rp, RpA, Re, c = y\n        dRp_dt = -(k_on * A_val + p['k_off']) * Rp\n        dRpA_dt = k_on * A_val * Rp - p['k_int'] * RpA\n        dRe_dt = p['k_int'] * RpA - p['k_off_e'] * Re\n        dc_dt = p['beta_p'] * Rp + p['beta_e'] * Re - p['k_deg'] * c\n        return [dRp_dt, dRpA_dt, dRe_dt, dc_dt]\n\n    # ODE system function for the 6-state model (prediction)\n    def ode_system_6_states(t, y, k_on, A_val, p):\n        Rp, RpA, Re, c, se, stot = y\n        dRp_dt = -(k_on * A_val + p['k_off']) * Rp\n        dRpA_dt = k_on * A_val * Rp - p['k_int'] * RpA\n        dRe_dt = p['k_int'] * RpA - p['k_off_e'] * Re\n        dc_dt = p['beta_p'] * Rp + p['beta_e'] * Re - p['k_deg'] * c\n        dse_dt = p['beta_e'] * Re\n        dstot_dt = p['beta_p'] * Rp + p['beta_e'] * Re\n        return [dRp_dt, dRpA_dt, dRe_dt, dc_dt, dse_dt, dstot_dt]\n\n    for case in test_cases:\n        alpha = case['alpha']\n        k_on_star = case['k_on_star']\n        T_final = case['T']\n        A_o = alpha\n\n        # 1. Generate Synthetic Data\n        y0_4_states = [params_const['R0'], 0, 0, 0]\n        \n        # Baseline data\n        sol_b_true = solve_ivp(\n            ode_system_4_states, (0, T_grid.max()), y0_4_states,\n            args=(k_on_star, A_b, params_const), t_eval=T_grid, dense_output=True\n        )\n        c_obs_b = sol_b_true.y[3]\n\n        # Overexpression data\n        sol_o_true = solve_ivp(\n            ode_system_4_states, (0, T_grid.max()), y0_4_states,\n            args=(k_on_star, A_o, params_const), t_eval=T_grid, dense_output=True\n        )\n        c_obs_o = sol_o_true.y[3]\n\n        # 2. Parameter Estimation\n        def objective_function(k_on_candidate):\n            k_on_val = k_on_candidate[0]\n            \n            # Simulate baseline\n            sol_b_sim = solve_ivp(\n                ode_system_4_states, (0, T_grid.max()), y0_4_states,\n                args=(k_on_val, A_b, params_const), t_eval=T_grid\n            )\n            c_sim_b = sol_b_sim.y[3]\n\n            # Simulate overexpression\n            sol_o_sim = solve_ivp(\n                ode_system_4_states, (0, T_grid.max()), y0_4_states,\n                args=(k_on_val, A_o, params_const), t_eval=T_grid\n            )\n            c_sim_o = sol_o_sim.y[3]\n            \n            # Sum of squared residuals\n            ssr = np.sum((c_sim_b - c_obs_b)**2) + np.sum((c_sim_o - c_obs_o)**2)\n            return ssr\n        \n        # Initial guess for the optimizer\n        k_on_initial_guess = [0.1]\n        # Bounds for k_on (must be non-negative)\n        bounds = [(0, None)]\n\n        opt_result = minimize(\n            objective_function, k_on_initial_guess, method='L-BFGS-B', bounds=bounds\n        )\n        k_on_estimated = opt_result.x[0]\n\n        # 3. Prediction of Endosomal Signaling Fraction\n        y0_6_states = [params_const['R0'], 0, 0, 0, 0, 0]\n\n        sol_phi = solve_ivp(\n            ode_system_6_states, (0, T_final), y0_6_states,\n            args=(k_on_estimated, A_o, params_const), dense_output=True\n        )\n\n        final_state = sol_phi.y[:, -1]\n        s_e_final = final_state[4]\n        s_tot_final = final_state[5]\n        \n        phi = s_e_final / s_tot_final if s_tot_final != 0 else 0.0\n        \n        # Append results for this case\n        final_results.extend([k_on_estimated, phi])\n\n    # Print a single line of output with all results, formatted to 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in final_results)}]\")\n\nsolve()\n```", "id": "2579988"}]}