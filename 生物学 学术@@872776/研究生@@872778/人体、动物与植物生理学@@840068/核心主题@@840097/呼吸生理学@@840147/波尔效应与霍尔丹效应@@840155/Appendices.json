{"hands_on_practices": [{"introduction": "波尔效应定量地描述了 $pH$ 如何影响血红蛋白的氧亲和力。这项练习要求您从波尔系数 $\\phi$ 的微分定义出发，推导出一个积分形式，从而直接预测在有限 $pH$ 区间内 $P_{50}$ 的变化。掌握这个推导过程 [@problem_id:2613315]，将巩固您对这一关键生理机制数学基础的理解。", "problem": "一份红细胞血红蛋白制剂表现出协同性的氧气结合特性，在生理范围内，其特性可以很好地通过具有恒定希尔系数的希尔关系式来描述。考虑在$\\mathrm{pH}=7.7$和$\\mathrm{pH}=7.2$下测得的两条氧-血红蛋白解离曲线，在这两个$\\mathrm{pH}$值下，希尔系数$n_{H}$相同。在氧分压为$P_{\\mathrm{O}_{2}}$时，氧的饱和分数$Y$由希尔公式建模：\n$$\nY=\\frac{\\left(P_{\\mathrm{O}_{2}}\\right)^{n_{H}}}{\\left(P_{50}\\right)^{n_{H}}+\\left(P_{\\mathrm{O}_{2}}\\right)^{n_{H}}},\n$$\n其中$P_{50}$是$Y=\\tfrac{1}{2}$时的氧分压。玻尔效应由玻尔系数$\\phi$量化，其定义为在饱和度恒定时，$P_{50}$的常用对数（以10为底）对$\\mathrm{pH}$的斜率：\n$$\n\\phi=\\left(\\frac{\\partial \\log_{10} P_{50}}{\\partial \\mathrm{pH}}\\right)_{Y}.\n$$\n仅使用这些定义和经过充分检验的关系，推导出一个用$\\phi$和$\\Delta \\mathrm{pH}$表示的比值$P_{50}\\left(7.2\\right)/P_{50}\\left(7.7\\right)$的解析表达式。然后，在$\\mathrm{pH}$从$7.7$变化到$7.2$的过程中，计算当$\\phi=-0.48$时该比值的大小。将最终数值答案四舍五入至四位有效数字。将该比值表示为无单位的纯数。", "solution": "首先验证问题的科学合理性、一致性和完整性。\n\n已知条件如下：\n1.  饱和分数$Y$作为氧分压$P_{\\mathrm{O}_{2}}$函数的希尔方程：$Y=\\frac{\\left(P_{\\mathrm{O}_{2}}\\right)^{n_{H}}}{\\left(P_{50}\\right)^{n_{H}}+\\left(P_{\\mathrm{O}_{2}}\\right)^{n_{H}}}$。\n2.  $P_{50}$的定义为$Y=\\frac{1}{2}$时的氧分压。\n3.  玻尔系数$\\phi$的定义为恒定饱和度下的斜率：$\\phi=\\left(\\frac{\\partial \\log_{10} P_{50}}{\\partial \\mathrm{pH}}\\right)_{Y}$。\n4.  定义了两个状态：$\\mathrm{pH}_{1} = 7.7$和$\\mathrm{pH}_{2} = 7.2$。\n5.  假定在此范围内，希尔系数$n_{H}$和玻尔系数$\\phi$为常数。\n6.  给定的玻尔系数的具体值为$\\phi=-0.48$。\n7.  任务是推导比值$\\frac{P_{50}(7.2)}{P_{50}(7.7)}$的表达式，然后计算其数值。\n\n该问题是科学有效的。希尔方程是配体与大分子协同结合的标准模型。所提供的玻尔系数的定义是玻尔效应的标准定量度量，玻尔效应描述了血红蛋白氧亲和力的pH依赖性。所给的$\\phi$数值对于人类血红蛋白是符合实际的。该问题是自洽且定义明确的，提供了进行推导和计算所需的所有定义和常数。希尔方程和参数$n_{H}$的引入提供了生理学背景，但如下文所示，计算过程并不直接需要它们，计算完全依赖于所提供的玻尔系数$\\phi$的定义。\n\n解题过程从玻尔系数$\\phi$的定义开始。鉴于$\\phi$是常数，我们可以将偏导数视为关于$\\mathrm{pH}$的全导数，因为$P_{50}$对其他变量（如温度）的依赖性被默认保持恒定。\n$$\n\\phi = \\frac{d(\\log_{10} P_{50})}{d(\\mathrm{pH})}\n$$\n这是一个可分离的一阶常微分方程。我们可以重新整理它，将$\\log_{10} P_{50}$的变化与$\\mathrm{pH}$的变化联系起来：\n$$\nd(\\log_{10} P_{50}) = \\phi \\cdot d(\\mathrm{pH})\n$$\n为了求出当$\\mathrm{pH}$从初始值$\\mathrm{pH}_{i}$变化到最终值$\\mathrm{pH}_{f}$时$P_{50}$的变化，我们在相应状态之间对该表达式进行积分。设初始状态为$(\\mathrm{pH}_{i}, P_{50,i})$，最终状态为$(\\mathrm{pH}_{f}, P_{50,f})$。\n$$\n\\int_{\\log_{10}(P_{50,i})}^{\\log_{10}(P_{50,f})} d(\\log_{10} P_{50}) = \\int_{\\mathrm{pH}_{i}}^{\\mathrm{pH}_{f}} \\phi \\cdot d(\\mathrm{pH})\n$$\n因为$\\phi$是给定的常数，所以可以将其从右侧积分中提出。\n$$\n\\left[ \\log_{10} P_{50} \\right]_{\\log_{10}(P_{50,i})}^{\\log_{10}(P_{50,f})} = \\phi \\int_{\\mathrm{pH}_{i}}^{\\mathrm{pH}_{f}} d(\\mathrm{pH})\n$$\n计算积分可得：\n$$\n\\log_{10}(P_{50,f}) - \\log_{10}(P_{50,i}) = \\phi (\\mathrm{pH}_{f} - \\mathrm{pH}_{i})\n$$\n利用对数性质 $\\log(a) - \\log(b) = \\log(a/b)$，我们将左侧的项合并。令$\\Delta \\mathrm{pH} = \\mathrm{pH}_{f} - \\mathrm{pH}_{i}$。\n$$\n\\log_{10}\\left(\\frac{P_{50,f}}{P_{50,i}}\\right) = \\phi \\cdot \\Delta \\mathrm{pH}\n$$\n为了得到所求的比值$\\frac{P_{50,f}}{P_{50,i}}$，我们对等式两边取反对数（以10为底）：\n$$\n\\frac{P_{50,f}}{P_{50,i}} = 10^{\\phi \\cdot \\Delta \\mathrm{pH}}\n$$\n这就是用$\\phi$和$\\Delta \\mathrm{pH}$表示$P_{50}$值比值的解析表达式。\n\n现在，我们代入问题中给出的具体数值。初始状态为$\\mathrm{pH}_{i} = 7.7$，最终状态为$\\mathrm{pH}_{f} = 7.2$。因此，$\\mathrm{pH}$的变化量为：\n$$\n\\Delta \\mathrm{pH} = \\mathrm{pH}_{f} - \\mathrm{pH}_{i} = 7.2 - 7.7 = -0.5\n$$\n给定的玻尔系数为$\\phi = -0.48$。\n将这些值代入我们推导出的表达式中：\n$$\n\\frac{P_{50}(7.2)}{P_{50}(7.7)} = 10^{(-0.48) \\cdot (-0.5)}\n$$\n$$\n\\frac{P_{50}(7.2)}{P_{50}(7.7)} = 10^{0.24}\n$$\n我们现在计算这个表达式的数值。\n$$\n10^{0.24} \\approx 1.7378008287...\n$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$\n\\frac{P_{50}(7.2)}{P_{50}(7.7)} \\approx 1.738\n$$\n指数$(0.24)$的正号正确地预测了该比值大于$1$，意味着$P_{50}(7.2)  P_{50}(7.7)$。这与已知的玻尔效应一致：$\\mathrm{pH}$的降低（从$7.7$到$7.2$）会降低血红蛋白对氧的亲和力，从而增加达到$50\\%$饱和度所需的分压。", "answer": "$$\n\\boxed{1.738}\n$$", "id": "2613315"}, {"introduction": "除了简单地移动氧结合曲线的位置，$pH$ 的变化还可以改变其陡峭程度，这反映了血红蛋白的表观协同性。本练习将引导您探究希尔系数 $n_H$ 与饱和度为 $50\\%$ 时结合曲线斜率之间的关系。通过分析依赖于 $pH$ 的 $n_H$ 变化如何影响该斜率 [@problem_id:2613358]，您将对血红蛋白的变构调控获得更细致入微的认识。", "problem": "在人类血红蛋白中，波尔效应描述了细胞外酸度的降低（$\\mathrm{pH}$ 升高）如何增加氧亲和力（降低 $P_{50}$），经验测量也表明，作为表观协同性代表指标的希尔系数（记为 $n_H$）本身会随 $\\mathrm{pH}$ 变化。考虑在恒定温度和二氧化碳分压下的氧结合过程（这样霍尔丹效应就不会干扰分析）。设血红蛋白的氧饱和度分数 $S$ 可通过一个希尔型结合关系来描述，其为氧分压 $P_{O_2}$ 的函数，参数为 $P_{50}(\\mathrm{pH})$ 和 $n_H(\\mathrm{pH})$。在 $\\mathrm{pH}=7.4$ 时，$n_H=2.7$；在 $\\mathrm{pH}=7.2$ 时，$n_H=2.3$。\n\n仅从作为一个经过充分检验的协同结合经验性描述的标准希尔型结合模型出发，推导局部斜率 $\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5}$ 的表达式（用 $n_H$ 表示），并说明其如何依赖（或不依赖）于 $P_{50}$。利用此结果判断波尔效应是否能改变该斜率所反映的表观协同性，然后计算比值\n$$\nR \\equiv \\frac{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.2}}{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.4}}.\n$$\n将 $R$ 报告为单个实数，四舍五入至四位有效数字。最终答案中不包含单位。", "solution": "对问题陈述进行验证。\n\n逐字提取已知条件：\n1.  波尔效应：细胞外酸度降低（$\\mathrm{pH}$ 升高）会增加氧亲和力（降低 $P_{50}$）。\n2.  希尔系数 $n_H$ 可随 $\\mathrm{pH}$ 变化。\n3.  分析在恒定温度和二氧化碳分压下进行。\n4.  血红蛋白的氧饱和度分数 $S$ 通过一个希尔型结合关系来描述，是氧分压 $P_{O_2}$ 的函数，参数为 $P_{50}(\\mathrm{pH})$ 和 $n_H(\\mathrm{pH})$。\n5.  在 $\\mathrm{pH}=7.4$ 时，$n_H=2.7$。\n6.  在 $\\mathrm{pH}=7.2$ 时，$n_H=2.3$。\n7.  任务是推导局部斜率 $\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5}$ 关于 $n_H$ 的表达式，分析其对 $P_{50}$ 的依赖性，判断波尔效应对表观协同性的影响，并计算比值 $R \\equiv \\frac{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.2}}{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.4}}$。\n8.  $R$ 的最终数值答案必须四舍五入到四位有效数字。\n\n验证结论：\n该问题有效。其科学基础是生物物理化学（协同结合的希尔模型）和生理学（波尔效应）的既定原理。问题表述清晰，包含了所有必要的数据和明确、客观的目标。给定的参数在生理上是现实的。该问题需要严谨的数学推导和解释，并非微不足道或不适定的问题。\n\n解答：\n出发点是标准的希尔方程，它描述了蛋白质的饱和度分数 $S$ 作为配体（在此为氧气）分压 $P_{O_2}$ 的函数。该方程为：\n$$\nS = \\frac{(P_{O_2})^{n_H}}{(P_{50})^{n_H} + (P_{O_2})^{n_H}}\n$$\n其中 $P_{50}$ 是半数结合位点被占据时（$S=0.5$）的氧分压，$n_H$ 是希尔系数，用于衡量协同性。\n\n为了求得所需的导数，更方便的做法是先将希尔方程重排为其线性化形式，这种形式常用于希尔作图。我们可以写出：\n$$\n\\frac{S}{1-S} = \\frac{\\frac{(P_{O_2})^{n_H}}{(P_{50})^{n_H} + (P_{O_2})^{n_H}}}{1 - \\frac{(P_{O_2})^{n_H}}{(P_{50})^{n_H} + (P_{O_2})^{n_H}}} = \\frac{(P_{O_2})^{n_H}}{(P_{50})^{n_H}} = \\left(\\frac{P_{O_2}}{P_{50}}\\right)^{n_H}\n$$\n对两边取自然对数，得到：\n$$\n\\ln\\left(\\frac{S}{1-S}\\right) = n_H \\ln\\left(\\frac{P_{O_2}}{P_{50}}\\right) = n_H (\\ln P_{O_2} - \\ln P_{50})\n$$\n问题要求的是关于 $\\log_{10} P_{O_2}$ 的导数。我们定义一个新变量 $x = \\log_{10} P_{O_2}$。使用对数的换底公式，$\\ln P_{O_2} = \\ln(10^x) = x \\ln 10$。将此代入方程中得到：\n$$\n\\ln\\left(\\frac{S}{1-S}\\right) = n_H (x \\ln 10 - \\ln P_{50})\n$$\n现在我们对两边关于 $x = \\log_{10} P_{O_2}$ 求导。注意 $S$ 是 $x$ 的函数，而对于给定的 $\\mathrm{pH}$ 值，$n_H$ 和 $P_{50}$ 被视为参数。对左边应用链式法则：\n$$\n\\frac{d}{dx}\\left[\\ln S - \\ln(1-S)\\right] = \\frac{d}{dx}\\left[n_H x \\ln 10 - n_H \\ln P_{50}\\right]\n$$\n$$\n\\left(\\frac{1}{S}\\frac{dS}{dx} - \\frac{1}{1-S}(-1)\\frac{dS}{dx}\\right) = n_H \\ln 10\n$$\n$$\n\\left(\\frac{1}{S} + \\frac{1}{1-S}\\right)\\frac{dS}{dx} = n_H \\ln 10\n$$\n$$\n\\left(\\frac{1-S+S}{S(1-S)}\\right)\\frac{dS}{dx} = n_H \\ln 10\n$$\n$$\n\\frac{1}{S(1-S)}\\frac{dS}{dx} = n_H \\ln 10\n$$\n解出 $\\frac{dS}{dx} = \\frac{dS}{d\\log_{10} P_{O_2}}$，得到斜率的通用表达式：\n$$\n\\frac{dS}{d\\log_{10} P_{O_2}} = (n_H \\ln 10) S(1-S)\n$$\n问题要求在饱和度为一半，即 $S=0.5$ 的点上计算该斜率。代入此值：\n$$\n\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5} = (n_H \\ln 10) (0.5)(1 - 0.5) = (n_H \\ln 10) (0.25)\n$$\n因此，在 $S=0.5$ 处的局部斜率表达式为：\n$$\n\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5} = \\frac{n_H \\ln 10}{4}\n$$\n这个表达式表明，当在对数压力标尺上绘制时，希尔曲线在其中心点（$S=0.5$）的斜率仅取决于希尔系数 $n_H$，而完全独立于参数 $P_{50}$。参数 $P_{50}$ 决定了结合曲线的水平位置（中心），但不决定其在该中心的陡峭程度。\n\n问题询问波尔效应是否能改变此斜率所反映的表观协同性。根据定义，波尔效应是 $P_{50}$ 随 $\\mathrm{pH}$ 的变化。我们推导出的斜率不依赖于 $P_{50}$。然而，问题明确指出希尔系数 $n_H$ 本身会随 $\\mathrm{pH}$ 变化。由于在 $S=0.5$ 处的斜率与 $n_H$ 成正比，且 $n_H$ 随 $\\mathrm{pH}$ 变化，因此表观协同性（由此斜率衡量）确实会改变。生理刺激（$\\mathrm{pH}$ 的变化）既引起了波尔效应（$P_{50}$ 的变化），也引起了 $n_H$ 的变化，这反过来又改变了结合曲线的陡峭程度。\n\n最后，我们必须计算比值 $R$：\n$$\nR \\equiv \\frac{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.2}}{\\left.\\frac{dS}{d\\log_{10} P_{O_2}}\\right|_{S=0.5,\\ \\mathrm{pH}=7.4}}\n$$\n使用我们推导出的斜率公式，我们有：\n$$\nR = \\frac{\\frac{n_H(\\mathrm{pH}=7.2) \\ln 10}{4}}{\\frac{n_H(\\mathrm{pH}=7.4) \\ln 10}{4}}\n$$\n常数项 $\\frac{\\ln 10}{4}$ 在分子和分母中被消去，剩下：\n$$\nR = \\frac{n_H(\\mathrm{pH}=7.2)}{n_H(\\mathrm{pH}=7.4)}\n$$\n问题给出了在 $\\mathrm{pH}=7.2$ 时 $n_H=2.3$ 和在 $\\mathrm{pH}=7.4$ 时 $n_H=2.7$。代入这些值：\n$$\nR = \\frac{2.3}{2.7}\n$$\n进行除法运算并四舍五入到四位有效数字：\n$$\nR \\approx 0.85185185... \\approx 0.8519\n$$\n这个结果表明，在较低的 $\\mathrm{pH}$ 值 $7.2$ 时，表观协同性较低。", "answer": "$$\\boxed{0.8519}$$", "id": "2613358"}, {"introduction": "波尔效应和霍尔丹效应并非孤立存在；它们是复杂气体交换系统中深度交织的组成部分。这最后一个练习将指导您构建一个计算模型，该模型耦合了这些效应以模拟组织中的氧气释放 [@problem_id:2613299]。通过进行灵敏度分析，您将培养系统生理学方面的实践技能，并学会识别哪些参数最关键地控制着这一重要过程。", "problem": "基于以下基本关系和经过充分检验的事实，构建一个将波尔效应 (Bohr effect) 和霍尔丹效应 (Haldane effect) 纳入考虑的从动脉血到组织的氧气 (O2) 释放计算模型。您必须仅使用下述关系作为推导的基础。\n\n1.  氧含量模型。血液中的总氧含量，以 $C_{O_2}$ 表示（单位为 $\\mathrm{mL\\ O_2/dL}$），是溶解氧和血红蛋白结合氧的总和：\n    $$C_{O_2}(P_{O_2}, H, n_H, P_{50}) = \\alpha\\,P_{O_2} + \\underbrace{c_{\\mathrm{cap}}\\,H}_{\\text{每 dL 的容量}}\\,S(P_{O_2}; n_H, P_{50}),$$\n    其中 $P_{O_2}$ 是氧分压，单位为 $\\mathrm{mmHg}$，$H$ 是血细胞比容（以分数表示），$n_H$ 是希尔系数 (Hill coefficient)，$P_{50}$ 是血红蛋白饱和度达到 $50$ 百分比时的 $\\mathrm{mmHg}$ 值，$\\alpha$ 是氧溶解度，$c_{\\mathrm{cap}}$ 是每单位血细胞比容每 $\\mathrm{dL}$ 的 O2 结合能力。\n\n2.  血红蛋白氧饱和度。血红蛋白结合氧的比例（饱和度）遵循希尔关系 (Hill relation)：\n    $$S(P_{O_2}; n_H, P_{50}) = \\frac{P_{O_2}^{n_H}}{P_{50}^{n_H} + P_{O_2}^{n_H}}.$$\n\n3.  波尔效应 (Bohr effect)。$\\mathrm{P}_{50}$ 通过指数关系依赖于二氧化碳分压 (PCO2)：\n    $$P_{50}(P_{CO_2}) = P_{50,\\mathrm{ref}}\\,\\exp\\!\\big(\\phi\\,(P_{CO_2} - P_{CO_2,\\mathrm{ref}})\\big),$$\n    其中 $\\phi$ 是波尔因子，单位为 $\\mathrm{mmHg}^{-1}$，$P_{50,\\mathrm{ref}}$ 是在参考二氧化碳 (CO2) 分压 $P_{CO_2,\\mathrm{ref}}$ 下的参考值。\n\n4.  霍尔丹效应 (Haldane effect)（简化耦合）。静脉血中的二氧化碳 (CO2) 分压由于霍尔丹效应而依赖于脱氧程度：\n    $$P_{CO_2,\\mathrm{v}} = P_{CO_2,\\mathrm{a}} + \\Delta P_{CO_2,\\mathrm{base}} - \\beta\\,(1 - S_{\\mathrm{v}}),$$\n    其中 $P_{CO_2,\\mathrm{a}}$ 是动脉 CO2 分压，$\\Delta P_{CO_2,\\mathrm{base}}$ 是在没有霍尔丹耦合的情况下，$P_{CO_2}$ 穿过组织时的基线增量，$\\beta$ 是一个非负的耦合强度，单位为 $\\mathrm{mmHg}$，$S_{\\mathrm{v}}$ 是在静脉氧分压 $P_{O_2,\\mathrm{v}}$ 下的静脉血氧饱和度。这种耦合反映了脱氧血红蛋白可以携带更多的二氧化碳，从而在给定的二氧化碳负荷下倾向于降低 $P_{CO_2}$。\n\n5.  氧气释放。将向组织的氧气释放定义为\n    $$U(\\phi, n_H, H, \\beta) = C_{O_2}(P_{O_2,\\mathrm{a}}, H, n_H, P_{50}(P_{CO_2,\\mathrm{a}})) - C_{O_2}(P_{O_2,\\mathrm{v}}, H, n_H, P_{50}(P_{CO_2,\\mathrm{v}})),$$\n    其中出现在 $P_{CO_2,\\mathrm{v}}$ 中的静脉饱和度 $S_{\\mathrm{v}}$ 必须与在 $P_{O_2,\\mathrm{v}}$ 下使用由上述 $P_{CO_2,\\mathrm{v}}$ 决定的 $P_{50}$ 的希尔关系相一致。也就是说，$S_{\\mathrm{v}}$ 求解不动点条件\n    $$S_{\\mathrm{v}} = S\\!\\left(P_{O_2,\\mathrm{v}}; n_H, P_{50}\\!\\left(P_{CO_2,\\mathrm{a}} + \\Delta P_{CO_2,\\mathrm{base}} - \\beta\\,(1 - S_{\\mathrm{v}})\\right)\\right).$$\n\n在所有计算中使用的常数和基线生理值：\n- $P_{O_2,\\mathrm{a}} = 95\\ \\mathrm{mmHg}$, $P_{O_2,\\mathrm{v}} = 40\\ \\mathrm{mmHg}$。\n- $P_{CO_2,\\mathrm{a}} = 40\\ \\mathrm{mmHg}$, $P_{CO_2,\\mathrm{ref}} = 40\\ \\mathrm{mmHg}$, $\\Delta P_{CO_2,\\mathrm{base}} = 6\\ \\mathrm{mmHg}$。\n- $P_{50,\\mathrm{ref}} = 26.8\\ \\mathrm{mmHg}$。\n- $\\alpha = 0.003\\ \\mathrm{mL\\ O_2/dL/mmHg}$。\n- $c_{\\mathrm{cap}} = 44.6\\ \\mathrm{mL\\ O_2/dL}$ 每单位血细胞比容（因此当 $H = 0.45$ 且完全饱和时，大约为 $20\\ \\mathrm{mL\\ O_2/dL}$）。\n\n任务。对于每个给定的参数集 $(\\phi, n_H, H, \\beta)$，使用相对大小为 $\\varepsilon$ 的对称乘法扰动，计算 $U$ 相对于每个参数的局部、归一化、逐点的敏感度（弹性）：\n$$E_i = \\frac{U(\\ldots, p_i(1+\\varepsilon), \\ldots)\\ -\\ U(\\ldots, p_i(1-\\varepsilon), \\ldots)}{2\\,\\varepsilon\\,U(\\phi, n_H, H, \\beta)},\\quad i \\in \\{0,1,2,3\\},$$\n其中 $p_0=\\phi$, $p_1=n_H$, $p_2=H$, $p_3=\\beta$，且 $\\varepsilon = 10^{-3}$。\n\n然后，按绝对弹性 $\\lvert E_i\\rvert$ 的降序对参数进行排序；如果出现平局，必须按较小的索引 $i$ 来决定顺序。\n\n您的程序必须为每个测试用例输出一个排名，形式为包含四个整数的列表，对应于索引 $[0,1,2,3]$ 分别代表 $[\\phi, n_H, H, \\beta]$，并按影响从大到小的顺序列出。将所有案例聚合到单个列表中。\n\n测试套件。按所列顺序使用以下五个参数集，每个参数集格式为 $(\\phi\\ \\mathrm{in\\ mmHg^{-1}},\\ n_H,\\ H,\\ \\beta\\ \\mathrm{in\\ mmHg})$：\n- 案例 1：$(0.005,\\ 2.7,\\ 0.45,\\ 4.0)$。\n- 案例 2：$(0.005,\\ 2.7,\\ 0.25,\\ 4.0)$。\n- 案例 3：$(0.010,\\ 2.7,\\ 0.45,\\ 4.0)$。\n- 案例 4：$(0.005,\\ 2.7,\\ 0.45,\\ 0.0)$。\n- 案例 5：$(0.002,\\ 3.2,\\ 0.45,\\ 6.0)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个不含空格的、由整数列表组成的逗号分隔列表，例如，\"[[i00,i01,i02,i03],[i10,i11,i12,i13],...]\"，其中每个内部列表是按给定顺序对一个案例的排名。输出中不应打印任何单位；输出中只允许使用整数。", "solution": "所提出的问题是计算生理学中的一个有效练习。它在科学上基于已建立的血液气体输送模型，问题陈述清晰，并为获得唯一解提供了所有必要信息。问题的核心在于静脉血氧饱和度的耦合、自洽计算，该饱和度依赖于静脉二氧化碳分压，而后者又依赖于静脉血氧饱和度。这个连接了波尔效应 (Bohr effect) 和霍尔丹效应 (Haldane effect) 的反馈回路，需要数值解法。\n\n任务是针对氧气释放函数 $U(\\phi, n_H, H, \\beta)$ 对其四个参数进行敏感度分析：波尔因子 $\\phi$、希尔系数 $n_H$、血细胞比容 $H$ 和霍尔丹耦合强度 $\\beta$。该分析通过计算每个参数的归一化敏感度（或弹性），并按其影响大小进行排序来完成。\n\n对于给定的参数集 $(\\phi, n_H, H, \\beta)$，计算氧气释放量 $U$ 的步骤如下：\n\n首先，我们计算动脉血氧含量 $C_{O_2,\\mathrm{a}}$。其计算公式为：\n$$C_{O_2,\\mathrm{a}} = C_{O_2}(P_{O_2,\\mathrm{a}}, H, n_H, P_{50}(P_{CO_2,\\mathrm{a}})) = \\alpha P_{O_2,\\mathrm{a}} + c_{\\mathrm{cap}} H S_{\\mathrm{a}}$$\n其中 $S_{\\mathrm{a}}$ 是动脉血氧饱和度。动脉的 $P_{50,\\mathrm{a}}$ 由动脉二氧化碳分压 $P_{CO_2,\\mathrm{a}}$ 决定。\n$$P_{50,\\mathrm{a}} = P_{50}(P_{CO_2,\\mathrm{a}}) = P_{50,\\mathrm{ref}}\\,\\exp(\\phi(P_{CO_2,\\mathrm{a}} - P_{CO_2,\\mathrm{ref}}))$$\n根据提供的常数，$P_{CO_2,\\mathrm{a}} = P_{CO_2,\\mathrm{ref}} = 40\\,\\mathrm{mmHg}$，这使得表达式简化为 $P_{50,\\mathrm{a}} = P_{50,\\mathrm{ref}} = 26.8\\,\\mathrm{mmHg}$，无论 $\\phi$ 的值如何。\n然后使用希尔方程 (Hill equation) 计算动脉饱和度 $S_{\\mathrm{a}}$：\n$$S_{\\mathrm{a}} = S(P_{O_2,\\mathrm{a}}; n_H, P_{50,\\mathrm{a}}) = \\frac{P_{O_2,\\mathrm{a}}^{n_H}}{P_{50,\\mathrm{a}}^{n_H} + P_{O_2,\\mathrm{a}}^{n_H}}$$\n由于 $P_{O_2,\\mathrm{a}} = 95\\,\\mathrm{mmHg}$，这个计算是直接的。\n\n其次，我们计算静脉血氧含量 $C_{O_2,\\mathrm{v}}$。由于静脉血氧饱和度 $S_{\\mathrm{v}}$ 和静脉二氧化碳分压 $P_{CO_2,\\mathrm{v}}$ 相互依赖，此计算更为复杂。\n$$C_{O_2,\\mathrm{v}} = C_{O_2}(P_{O_2,\\mathrm{v}}, H, n_H, P_{50}(P_{CO_2,\\mathrm{v}})) = \\alpha P_{O_2,\\mathrm{v}} + c_{\\mathrm{cap}} H S_{\\mathrm{v}}$$\n为了找到正确的 $S_{\\mathrm{v}}$ 值，我们必须求解问题陈述中指定的一个不动点方程。该方程的产生是因为 $S_{\\mathrm{v}}$ 依赖于 $P_{50,\\mathrm{v}}$，而 $P_{50,\\mathrm{v}}$ 依赖于 $P_{CO_2,\\mathrm{v}}$，后者又依赖于 $S_{\\mathrm{v}}$。\n$S_{\\mathrm{v}}$ 的定义关系是：\n$$S_{\\mathrm{v}} = S\\left(P_{O_2,\\mathrm{v}}; n_H, P_{50}\\left(P_{CO_2,\\mathrm{a}} + \\Delta P_{CO_2,\\mathrm{base}} - \\beta(1 - S_{\\mathrm{v}})\\right)\\right)$$\n我们将此方程的右侧定义为函数 $f(S_{\\mathrm{v}})$。我们必须找到函数 $g(S_{\\mathrm{v}}) = S_{\\mathrm{v}} - f(S_{\\mathrm{v}}) = 0$ 的根。$S_{\\mathrm{v}}$ 的关注域是区间 $[0, 1]$。对 $g(S_{\\mathrm{v}})$ 的分析表明，$g(0) \\leq 0$ 且 $g(1) \\geq 0$。此外，对于给定的参数范围，函数 $f(S_{\\mathrm{v}})$ 是连续且单调不增的。这保证了在 $[0, 1]$ 中存在唯一的 $S_{\\mathrm{v}}$ 解，并且可以使用数值求根方法（如 Brent 方法）可靠地找到它。\n\n一旦通过数值方法确定了 $S_{\\mathrm{v}}$，就可以使用满足不动点条件的 $S_{\\mathrm{v}}$ 值来计算静脉血氧含量 $C_{O_2,\\mathrm{v}}$。\n\n第三，计算氧气释放量 $U$ 为动脉和静脉血氧含量之差：\n$$U(\\phi, n_H, H, \\beta) = C_{O_2,\\mathrm{a}} - C_{O_2,\\mathrm{v}}$$\n\n第四，我们计算每个参数 $p_i \\in \\{\\phi, n_H, H, \\beta\\}$ 的弹性 $E_i$。弹性使用对称有限差分法来近似，相对扰动大小为 $\\varepsilon = 10^{-3}$：\n$$E_i = \\frac{U(\\ldots, p_i(1+\\varepsilon), \\ldots) - U(\\ldots, p_i(1-\\varepsilon), \\ldots)}{2\\varepsilon U(\\phi, n_H, H, \\beta)}$$\n这要求在基线参数下以及对四个参数中的每一个进行两次扰动后，分别计算函数 $U$ 的值。\n\n最后，对于每个测试用例，参数 $\\{\\phi, n_H, H, \\beta\\}$ 根据其各自弹性 $|\\lvert E_i\\rvert|$ 的绝对值的降序进行排序。平局通过选择索引较小的参数来解决，其中 $\\phi, n_H, H, \\beta$ 的索引分别为 $0, 1, 2, 3$。\n\n实现将包含一个计算 $U$ 的主函数，该函数内部使用 `scipy` 库中的求根算法来求解 $S_{\\mathrm{v}}$。然后在循环中重复调用此函数，为每个参数和测试用例计算敏感度，之后执行排序并按要求格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes and ranks parameter sensitivities for an oxygen unloading model.\n    \"\"\"\n    # Define constants and baseline physiological values from the problem statement.\n    P_O2_A = 95.0\n    P_O2_V = 40.0\n    P_CO2_A = 40.0\n    P_CO2_REF = 40.0\n    DP_CO2_BASE = 6.0\n    P50_REF = 26.8\n    ALPHA = 0.003\n    C_CAP = 44.6\n    EPSILON = 1e-3\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0.005, 2.7, 0.45, 4.0),  # Case 1\n        (0.005, 2.7, 0.25, 4.0),  # Case 2\n        (0.010, 2.7, 0.45, 4.0),  # Case 3\n        (0.005, 2.7, 0.45, 0.0),  # Case 4\n        (0.002, 3.2, 0.45, 6.0),  # Case 5\n    ]\n\n    def hill_saturation(po2, n_h, p50):\n        \"\"\"Calculates hemoglobin oxygen saturation using the Hill equation.\"\"\"\n        if po2 = 0 or p50 = 0: return 0.0\n        po2_n = po2**n_h\n        p50_n = p50**n_h\n        return po2_n / (p50_n + po2_n)\n\n    def bohr_p50(pco2, phi):\n        \"\"\"Calculates P50 based on PCO2 (Bohr effect).\"\"\"\n        return P50_REF * np.exp(phi * (pco2 - P_CO2_REF))\n\n    def oxygen_content(po2, h, sat):\n        \"\"\"Calculates total oxygen content in blood.\"\"\"\n        return ALPHA * po2 + C_CAP * h * sat\n\n    memo = {}\n\n    def calculate_U(phi, n_h, h, beta):\n        \"\"\"\n        Calculates oxygen unloading U for a given set of parameters.\n        Internally solves a fixed-point problem for venous saturation.\n        \"\"\"\n        param_tuple = (phi, n_h, h, beta)\n        if param_tuple in memo:\n            return memo[param_tuple]\n        \n        # Arterial side calculation\n        p50_a = bohr_p50(P_CO2_A, phi)\n        s_a = hill_saturation(P_O2_A, n_h, p50_a)\n        c_o2_a = oxygen_content(P_O2_A, h, s_a)\n\n        # Venous side calculation (requires solving for S_v)\n        def sv_residual(s_v):\n            \"\"\"\n            Defines the residual function g(S_v) = S_v - f(S_v) for the fixed-point problem.\n            The root of this function is the self-consistent venous saturation.\n            \"\"\"\n            p_co2_v = P_CO2_A + DP_CO2_BASE - beta * (1.0 - s_v)\n            p50_v = bohr_p50(p_co2_v, phi)\n            s_v_calc = hill_saturation(P_O2_V, n_h, p50_v)\n            return s_v - s_v_calc\n\n        # Solve for S_v using Brent's method. The interval [0, 1] is guaranteed\n        # to bracket the unique root. A slightly wider interval is used for\n        # numerical robustness against floating point inaccuracies at boundaries.\n        s_v = brentq(sv_residual, -1e-9, 1.0 + 1e-9)\n        \n        c_o2_v = oxygen_content(P_O2_V, h, s_v)\n        \n        unloading = c_o2_a - c_o2_v\n        memo[param_tuple] = unloading\n        return unloading\n\n    all_rankings = []\n    \n    for params in test_cases:\n        p_base = list(params)\n        memo.clear() # Clear memoization cache for each new test case\n        \n        u_base = calculate_U(*p_base)\n        \n        elasticities = []\n        for i in range(4):\n            # Handle parameters that are zero, where multiplicative perturbation is ineffective.\n            if p_base[i] == 0:\n                elasticities.append(0.0)\n                continue\n                \n            p_plus = p_base[:]\n            p_minus = p_base[:]\n            \n            p_plus[i] *= (1.0 + EPSILON)\n            p_minus[i] *= (1.0 - EPSILON)\n            \n            u_plus = calculate_U(*p_plus)\n            u_minus = calculate_U(*p_minus)\n            \n            if u_base == 0:\n                # This case is physically unlikely but handled for robustness.\n                e_i = 0.0\n            else:\n                e_i = (u_plus - u_minus) / (2.0 * EPSILON * u_base)\n            elasticities.append(e_i)\n        \n        # Create pairs of (absolute elasticity, index) for ranking.\n        indexed_elasticities = [(abs(e), i) for i, e in enumerate(elasticities)]\n        \n        # Sort by absolute elasticity (descending), then by index (ascending) for ties.\n        indexed_elasticities.sort(key=lambda x: (-x[0], x[1]))\n        \n        ranking = [index for val, index in indexed_elasticities]\n        all_rankings.append(ranking)\n        \n    # Format the final output string as specified, without spaces.\n    results_str = [str(r).replace(\" \", \"\") for r in all_rankings]\n    print(f\"[[{','.join(results_str)}]]\")\n\nsolve()\n```", "id": "2613299"}]}