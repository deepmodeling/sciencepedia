{"hands_on_practices": [{"introduction": "促肾上腺皮质激素（ACTH）兴奋试验是评估肾上腺功能的标准临床工具，它直接检验下丘脑-垂体-肾上腺（HPA）轴在应对紧急挑战时的储备能力。本练习的核心在于量化总皮质醇与具有生物活性的游离皮质醇之间的差异，这对于正确解读生理应激反应至关重要。通过应用蛋白质结合动力学原理，您将学习如何基于血浆中结合蛋白的浓度来估算游离皮质醇水平，从而更精确地评估HPA轴的稳态适应能力。", "problem": "一名受试者接受一项标准化的促肾上腺皮质激素 (ACTH) 兴奋试验，以评估其在动态负荷挑战下的下丘脑-垂体-肾上腺 (HPA) 轴的完整性。在静脉推注合成 ACTH 后的 $0$ 分钟（基线）、$30$ 分钟和 $60$ 分钟采集血浆总皮质醇样本。结合蛋白在基线时测量一次，并假设其在 $60$ 分钟的时间间隔内保持恒定。获得以下数据：\n- 总皮质醇：$C_{\\mathrm{tot}}(0) = 260$ nmol/L, $C_{\\mathrm{tot}}(30) = 490$ nmol/L, $C_{\\mathrm{tot}}(60) = 530$ nmol/L。\n- 皮质类固醇结合球蛋白 (CBG) 总浓度：$B_{\\mathrm{CBG}} = 1.2 \\times 10^{-6}$ mol/L。\n- 白蛋白总浓度：$B_{\\mathrm{Alb}} = 6.0 \\times 10^{-4}$ mol/L。\n\n假设每个 CBG 有一个高亲和力结合位点，每个白蛋白有一个皮质醇的低亲和力位点，其结合常数（质量作用定律）分别为 $K_{\\mathrm{CBG}} = 1.0 \\times 10^{7}$ L/mol 和 $K_{\\mathrm{Alb}} = 1.0 \\times 10^{4}$ L/mol。在生理游离皮质醇范围内，假设两种蛋白质均处于低占据条件下，使得质量作用定律简化为关于游离皮质醇的线性结合。\n\n诊断阈值（在临床生理学中广泛使用）为：\n- 总皮质醇峰值标准：$C_{\\mathrm{tot}}(30)$ 和 $C_{\\mathrm{tot}}(60)$ 的最大值必须至少为 $500$ nmol/L。\n- 游离皮质醇峰值标准：$30$ 分钟和 $60$ 分钟时游离皮质醇的最大值必须至少为 $33$ nmol/L。\n\n从皮质醇的质量作用定律和质量守恒出发，推导关联游离皮质醇、总皮质醇和结合蛋白浓度的线性低占据表达式，并用其计算 $0$、$30$ 和 $60$ 分钟时的游离皮质醇。定义动态适应充足性指数\n$$\nS \\equiv \\min\\!\\left(\\frac{\\max\\{C_{\\mathrm{tot}}(30),\\,C_{\\mathrm{tot}}(60)\\}}{500},\\ \\frac{\\max\\{C_{\\mathrm{free}}(30),\\,C_{\\mathrm{free}}(60)\\}}{33}\\right),\n$$\n其中所有皮质醇浓度单位均为 nmol/L。使用上述数据计算 $S$。将最终指数表示为无量纲数，并将答案四舍五入至三位有效数字。", "solution": "该问题在科学上是适定的，并包含足够的信息以获得唯一解。我们进行推导和计算。\n\n血浆中的总皮质醇浓度 $C_{\\mathrm{tot}}$ 是游离皮质醇 $C_{\\mathrm{free}}$、与皮质类固醇结合球蛋白 (CBG) 结合的皮质醇 $C_{\\mathrm{CBG}}$ 以及与白蛋白结合的皮质醇 $C_{\\mathrm{Alb}}$ 的总和。质量守恒原理规定：\n$$C_{\\mathrm{tot}} = C_{\\mathrm{free}} + C_{\\mathrm{CBG}} + C_{\\mathrm{Alb}}$$\n\n皮质醇与这些蛋白质的结合遵循质量作用定律。设 $B_{\\mathrm{CBG, free}}$ 和 $B_{\\mathrm{Alb, free}}$ 分别是 CBG 和白蛋白上游离（未占据）结合位点的浓度。结合常数 $K_{\\mathrm{CBG}}$ 和 $K_{\\mathrm{Alb}}$ 定义如下：\n$$K_{\\mathrm{CBG}} = \\frac{C_{\\mathrm{CBG}}}{C_{\\mathrm{free}} \\cdot B_{\\mathrm{CBG, free}}}$$\n$$K_{\\mathrm{Alb}} = \\frac{C_{\\mathrm{Alb}}}{C_{\\mathrm{free}} \\cdot B_{\\mathrm{Alb, free}}}$$\n\n结合位点的总浓度 $B_{\\mathrm{CBG}}$ 和 $B_{\\mathrm{Alb}}$ 是守恒的：\n$$B_{\\mathrm{CBG}} = B_{\\mathrm{CBG, free}} + C_{\\mathrm{CBG}}$$\n$$B_{\\mathrm{Alb}} = B_{\\mathrm{Alb, free}} + C_{\\mathrm{Alb}}$$\n\n问题指明了低占据条件的假设。这意味着对于每种蛋白质，结合的皮质醇浓度与总结合位点浓度相比可以忽略不计（$C_{\\mathrm{CBG}} \\ll B_{\\mathrm{CBG}}$ 和 $C_{\\mathrm{Alb}} \\ll B_{\\mathrm{Alb}}$）。因此，游离结合位点的浓度可以近似为总蛋白质浓度：\n$$B_{\\mathrm{CBG, free}} \\approx B_{\\mathrm{CBG}}$$\n$$B_{\\mathrm{Alb, free}} \\approx B_{\\mathrm{Alb}}$$\n\n将这些近似值代入质量作用定律方程，得到结合皮质醇浓度的线性关系：\n$$C_{\\mathrm{CBG}} \\approx K_{\\mathrm{CBG}} \\cdot C_{\\mathrm{free}} \\cdot B_{\\mathrm{CBG}}$$\n$$C_{\\mathrm{Alb}} \\approx K_{\\mathrm{Alb}} \\cdot C_{\\mathrm{free}} \\cdot B_{\\mathrm{Alb}}$$\n\n现在我们将这些线性表达式代回到总皮质醇的质量守恒方程中：\n$$C_{\\mathrm{tot}} \\approx C_{\\mathrm{free}} + (K_{\\mathrm{CBG}} B_{\\mathrm{CBG}}) C_{\\mathrm{free}} + (K_{\\mathrm{Alb}} B_{\\mathrm{Alb}}) C_{\\mathrm{free}}$$\n\n提出因子 $C_{\\mathrm{free}}$ 得：\n$$C_{\\mathrm{tot}} \\approx C_{\\mathrm{free}} (1 + K_{\\mathrm{CBG}} B_{\\mathrm{CBG}} + K_{\\mathrm{Alb}} B_{\\mathrm{Alb}})$$\n\n该方程可以重排，以推导出在低占据条件下关联游离皮质醇与总皮质醇所需的线性表达式：\n$$C_{\\mathrm{free}} \\approx \\frac{C_{\\mathrm{tot}}}{1 + K_{\\mathrm{CBG}} B_{\\mathrm{CBG}} + K_{\\mathrm{Alb}} B_{\\mathrm{Alb}}}$$\n\n接下来，我们使用所提供的数据计算分母的值：\n$B_{\\mathrm{CBG}} = 1.2 \\times 10^{-6}$ mol/L\n$K_{\\mathrm{CBG}} = 1.0 \\times 10^{7}$ L/mol\n$B_{\\mathrm{Alb}} = 6.0 \\times 10^{-4}$ mol/L\n$K_{\\mathrm{Alb}} = 1.0 \\times 10^{4}$ L/mol\n\n乘积 $K \\cdot B$ 是无量纲的：\n$$K_{\\mathrm{CBG}} B_{\\mathrm{CBG}} = (1.0 \\times 10^{7} \\text{ L/mol}) \\times (1.2 \\times 10^{-6} \\text{ mol/L}) = 12$$\n$$K_{\\mathrm{Alb}} B_{\\mathrm{Alb}} = (1.0 \\times 10^{4} \\text{ L/mol}) \\times (6.0 \\times 10^{-4} \\text{ mol/L}) = 6$$\n\n代表分布因子的分母为：\n$$1 + K_{\\mathrm{CBG}} B_{\\mathrm{CBG}} + K_{\\mathrm{Alb}} B_{\\mathrm{Alb}} = 1 + 12 + 6 = 19$$\n因此，关系式简化为 $C_{\\mathrm{free}} \\approx \\frac{C_{\\mathrm{tot}}}{19}$。\n\n现在我们可以计算 $t=0$、$t=30$ 和 $t=60$ 分钟时的游离皮质醇浓度。$C_{\\mathrm{free}}$ 的单位将是 nmol/L，与 $C_{\\mathrm{tot}}$ 相同。\n$C_{\\mathrm{tot}}(0) = 260$ nmol/L $\\implies C_{\\mathrm{free}}(0) = \\frac{260}{19}$ nmol/L\n$C_{\\mathrm{tot}}(30) = 490$ nmol/L $\\implies C_{\\mathrm{free}}(30) = \\frac{490}{19}$ nmol/L\n$C_{\\mathrm{tot}}(60) = 530$ nmol/L $\\implies C_{\\mathrm{free}}(60) = \\frac{530}{19}$ nmol/L\n\n最后，我们计算动态适应充足性指数 $S$：\n$$S \\equiv \\min\\!\\left(\\frac{\\max\\{C_{\\mathrm{tot}}(30),\\,C_{\\mathrm{tot}}(60)\\}}{500},\\ \\frac{\\max\\{C_{\\mathrm{free}}(30),\\,C_{\\mathrm{free}}(60)\\}}{33}\\right)$$\n\n首先，我们从数据中找出峰值浓度：\n$$\\max\\{C_{\\mathrm{tot}}(30),\\,C_{\\mathrm{tot}}(60)\\} = \\max\\{490,\\,530\\} = 530 \\text{ nmol/L}$$\n$$\\max\\{C_{\\mathrm{free}}(30),\\,C_{\\mathrm{free}}(60)\\} = \\max\\left\\{\\frac{490}{19},\\,\\frac{530}{19}\\right\\} = \\frac{530}{19} \\text{ nmol/L}$$\n\n现在，我们计算 $\\min$ 函数中的两个比率。所有浓度单位均为 nmol/L，使得这两个比率是无量纲的。\n总皮质醇的比率：\n$$\\frac{530}{500} = 1.06$$\n游离皮质醇的比率：\n$$\\frac{\\max\\{C_{\\mathrm{free}}(30),\\,C_{\\mathrm{free}}(60)\\}}{33} = \\frac{530/19}{33} = \\frac{530}{19 \\times 33} = \\frac{530}{627}$$\n\n对第二个比率进行数值计算：\n$$\\frac{530}{627} \\approx 0.845295...$$\n\n指数 $S$ 是这两个值中的最小值：\n$$S = \\min\\left\\{1.06, \\frac{530}{627}\\right\\} = \\frac{530}{627} \\approx 0.845295...$$\n\n按要求将结果四舍五入至三位有效数字，得到 $0.845$。", "answer": "$$\\boxed{0.845}$$", "id": "2610539"}, {"introduction": "在理解了游离皮质醇在评估HPA轴功能中的重要性（[@problem_id:2610539]）之后，我们进一步探究其作用的分子起点——与糖皮质激素受体（GR）的结合。激素的生理效应最终取决于其受体的占据率，而这一过程受到血浆中缓冲蛋白的精密调控。本练习将引导您从质量作用定律出发，建立一个考虑皮质类固醇结合球蛋白（CBG）缓冲效应的GR占据率模型，从而定量地揭示循环总激素水平如何转化为细胞内真正的生物信号。", "problem": "在应激生理学中，于下丘脑-垂体-肾上腺（HPA）轴内，循环中的皮质醇由皮质类固醇结合球蛋白（CBG）可逆地缓冲，CBG调节了可与细胞内糖皮质激素受体（GR）结合的游离皮质醇的量。在动态平衡调整下，GR介导的转录响应取决于皮质醇占据GR的分数。考虑一个处于稳态的单一、充分混合的区室，并作出以下假设：(i) 皮质醇与CBG以一对一的可逆方式相互作用；(ii) 白蛋白和非特异性结合可忽略不计；(iii) 细胞内游离皮质醇与血浆游离皮质醇迅速达到平衡；(iv) 与CBG相比，GR浓度足够低，以至于GR的结合不会显著干扰由CBG缓冲体系设定的游离皮质醇浓度。\n\n从质量作用定律和质量守恒定律出发，推导GR分数占据率 $f_{\\mathrm{GR}}$ 作为总皮质醇浓度 $C_{\\mathrm{T}}$、总CBG浓度 $B_{\\mathrm{T}}$、CBG解离常数 $K_{d,\\mathrm{CBG}}$ 和GR解离常数 $K_{d,\\mathrm{GR}}$ 的函数的闭式表达式。然后，使用以下生理学上合理的参数（所有浓度单位均为 $\\mathrm{nM}$）计算 $f_{\\mathrm{GR}}$ 的值：\n- 总皮质醇 $C_{\\mathrm{T}} = 600$,\n- 总CBG $B_{\\mathrm{T}} = 1000$,\n- $K_{d,\\mathrm{CBG}} = 40$,\n- $K_{d,\\mathrm{GR}} = 10$.\n\n将最终的分数占据率表示为无单位小数，并四舍五入到四位有效数字。", "solution": "目标是获得GR分数占据率 $f_{\\mathrm{GR}}$，该占据率考虑了皮质类固醇结合球蛋白（CBG）对游离皮质醇的缓冲作用。相关的基本原理是可逆结合的质量作用定律和质量守恒定律。\n\n定义以下浓度：游离皮质醇 $C$、游离CBG $B$、皮质醇–CBG复合物 $BC$，以及总浓度 $C_{\\mathrm{T}}$ 和 $B_{\\mathrm{T}}$。CBG的可逆结合反应为\n$$\n\\mathrm{C} + \\mathrm{CBG} \\rightleftharpoons \\mathrm{CBG}\\!:\\!\\mathrm{C},\n$$\n其解离常数为\n$$\nK_{d,\\mathrm{CBG}} = \\frac{[C][B]}{[BC]}.\n$$\nCBG的质量守恒给出\n$$\nB_{\\mathrm{T}} = B + BC,\n$$\n而皮质醇的质量守恒（在GR结合不会显著消耗主体缓冲液中游离皮质醇的假设下）给出\n$$\nC_{\\mathrm{T}} = C + BC.\n$$\n根据 $K_{d,\\mathrm{CBG}}$ 的定义以及 $B = B_{\\mathrm{T}} - BC$，我们可以将复合物浓度表示为 $C$ 的函数：\n$$\nK_{d,\\mathrm{CBG}} = \\frac{C\\,(B_{\\mathrm{T}} - BC)}{BC} \\quad \\Longrightarrow \\quad BC = \\frac{B_{\\mathrm{T}}\\,C}{K_{d,\\mathrm{CBG}} + C}.\n$$\n将此式代入皮质醇的质量平衡方程，得到关于游离皮质醇 $C$ 的隐式方程：\n$$\nC_{\\mathrm{T}} = C + \\frac{B_{\\mathrm{T}}\\,C}{K_{d,\\mathrm{CBG}} + C}.\n$$\n两边同乘以 $(K_{d,\\mathrm{CBG}} + C)$ 以消去分母：\n$$\nC_{\\mathrm{T}}(K_{d,\\mathrm{CBG}} + C) = C\\,(K_{d,\\mathrm{CBG}} + C) + B_{\\mathrm{T}}\\,C.\n$$\n整理成关于 $C$ 的二次方程：\n$$\n0 = C^{2} + C\\,(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}) - C_{\\mathrm{T}}\\,K_{d,\\mathrm{CBG}}.\n$$\n物理上相关（非负）的根给出了游离皮质醇浓度：\n$$\nC = \\frac{-\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big) + \\sqrt{\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big)^{2} + 4\\,C_{\\mathrm{T}}\\,K_{d,\\mathrm{CBG}}}}{2}.\n$$\n在简单的配体-受体一对一相互作用达到平衡时，GR分数占据率遵循质量作用定律，可表示为\n$$\nf_{\\mathrm{GR}} = \\frac{C}{K_{d,\\mathrm{GR}} + C}.\n$$\n结合起来，包含CBG缓冲作用的所需闭式模型为\n$$\nf_{\\mathrm{GR}}(C_{\\mathrm{T}},B_{\\mathrm{T}},K_{d,\\mathrm{CBG}},K_{d,\\mathrm{GR}}) \\;=\\; \\frac{\\displaystyle \\frac{-\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big) + \\sqrt{\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big)^{2} + 4\\,C_{\\mathrm{T}}\\,K_{d,\\mathrm{CBG}}}}{2}}{\\displaystyle K_{d,\\mathrm{GR}} + \\frac{-\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big) + \\sqrt{\\big(K_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}}\\big)^{2} + 4\\,C_{\\mathrm{T}}\\,K_{d,\\mathrm{CBG}}}}{2}}.\n$$\n现在使用数值 $C_{\\mathrm{T}} = 600$、$B_{\\mathrm{T}} = 1000$、$K_{d,\\mathrm{CBG}} = 40$ 和 $K_{d,\\mathrm{GR}} = 10$（所有单位均为 $\\mathrm{nM}$）进行计算。首先计算 $C$：\n$$\nK_{d,\\mathrm{CBG}} + B_{\\mathrm{T}} - C_{\\mathrm{T}} = 40 + 1000 - 600 = 440,\n$$\n$$\n\\Delta = (440)^{2} + 4\\cdot 600 \\cdot 40 = 193{,}600 + 96{,}000 = 289{,}600,\n$$\n$$\n\\sqrt{\\Delta} \\approx 538.14495,\n$$\n$$\nC = \\frac{-440 + 538.14495}{2} \\approx \\frac{98.14495}{2} \\approx 49.072475.\n$$\n然后计算GR占据率：\n$$\nf_{\\mathrm{GR}} = \\frac{C}{K_{d,\\mathrm{GR}} + C} = \\frac{49.072475}{10 + 49.072475} = \\frac{49.072475}{59.072475} \\approx 0.8307164.\n$$\n四舍五入到四位有效数字，表示为无单位小数，\n$$\nf_{\\mathrm{GR}} \\approx 0.8307.\n$$", "answer": "$$\\boxed{0.8307}$$", "id": "2610528"}, {"introduction": "前述练习（[@problem_id:2610539]、[@problem_id:2610528]）聚焦于HPA轴的核心组分——皮质醇。然而，现代应激生理学研究不再局限于单一指标，而是采用更全面的视角。“稳态负荷”（Allostatic Load）这一概念旨在量化身体因长期适应性调节而付出的累积生理代价。本练习将这一抽象概念具体化为一个可计算的复合指数，这是一个在当代心理神经内分泌学中至关重要的方法。通过这个计算实践，您将学会如何整合来自HPA轴、心血管和代谢系统等多个领域的生物标志物，构建一个能够综合评估慢性应激相关健康风险的量化工具。", "problem": "构建一个程序，通过使用z-分数标准化、基于风险方向的定向和可选权重，从多种生物标志物构建一个综合指数，从而将应激生理学中的异态负荷概念操作化。然后，该程序计算个体的综合得分及其在队列中的中位数秩百分位数。程序必须实现以下有科学依据的定义和规则。\n\n基本定义和规则：\n- 异态负荷是跨系统（如下丘脑-垂体-肾上腺 (HPA) 轴以及心血管、代谢和免疫标志物）累积生理负担的综合表示。该综合指数是根据相对于参考队列的标准化偏差构建的，以消除单位和尺度差异。\n- 对于一个包含 $N$ 个个体和 $B$ 个生物标志物的队列矩阵 $X \\in \\mathbb{R}^{N \\times B}$，生物标志物 $j$ 的列式样本均值 $\\bar{x}_j$ 和样本标准差 $s_j$ 是在使用自由度为 $1$（即贝塞尔校正）的情况下，对可用（非缺失）值计算得出的。对于生物标志物 $j$，其可用值为 $x_{1j},\\dots,x_{n_j j}$，样本均值和样本标准差为：\n$$\n\\bar{x}_j = \\frac{1}{n_j} \\sum_{i=1}^{n_j} x_{ij}, \\quad\ns_j = \\sqrt{ \\frac{1}{n_j - 1} \\sum_{i=1}^{n_j} \\left(x_{ij} - \\bar{x}_j \\right)^2 }.\n$$\n- 观测值 $x_{ij}$ 的z-分数为：\n$$\nz_{ij} = \\frac{x_{ij} - \\bar{x}_j}{s_j}.\n$$\n- 每个生物标志物都有一个风险方向 $r_j \\in \\{+1,-1\\}$，其中 $r_j=+1$ 表示值越大风险越高（例如，血浆皮质醇、收缩压），而 $r_j=-1$ 表示值越大风险越低（例如，心率变异性、高密度脂蛋白胆固醇）。通过将z-分数乘以 $r_j$ 来应用方向。\n- 对于特定个体，在计算综合指数时，分子和分母均不包括缺失值。在队列中方差为零（即 $s_j=0$ 或 $n_j  2$）的生物标志物对所有个体都予以排除。\n- 可以为生物标志物分配可选的非负权重 $w_j$。如果未提供权重，则对所有 $j$ 使用 $w_j=1$。\n\n需要实现的综合指数定义：\n- 对于个体 $i$，设 $J_i$ 为个体 $i$ 具有非缺失值且在整个队列中方差非零的生物标志物集合。综合异态负荷指数是 $J_i$ 上定向z-分数的加权平均值：\n$$\n\\mathrm{ALI}_i = \n\\begin{cases}\n\\dfrac{\\sum_{j \\in J_i} w_j \\, r_j \\, z_{ij}}{\\sum_{j \\in J_i} w_j},   \\text{如果 } \\sum_{j \\in J_i} w_j  0,\\\\[8pt]\n0,   \\text{如果 } \\sum_{j \\in J_i} w_j = 0 \\text{（无有效生物标志物）}。\n\\end{cases}\n$$\n\n需要实现的百分位数定义：\n- 给定队列的 $\\mathrm{ALI}_1,\\dots,\\mathrm{ALI}_N$，目标个体 $t$ 的中位数秩百分位数为：\n$$\n\\mathrm{perc}(t) = \\frac{ \\#\\{ i : \\mathrm{ALI}_i  \\mathrm{ALI}_t \\} + \\tfrac{1}{2} \\#\\{ i : \\mathrm{ALI}_i = \\mathrm{ALI}_t \\} }{N},\n$$\n报告为 $[0,1]$ 范围的小数。\n\n角度单位不适用。所有输出均为无单位。将所有报告的浮点数输出四舍五入到 $6$ 位小数。\n\n为以下测试套件实现上述内容。索引为 $0$ 基。\n\n- 测试用例 1（正常路径，无缺失值，混合方向，等权重）：\n    - 生物标志物（列）：血浆皮质醇 $(\\mu\\text{g}/\\text{dL})$、收缩压 $(\\text{mmHg})$、心率变异性 RMSSD $(\\text{ms})$、高密度脂蛋白 $(\\text{mg}/\\text{dL})$。\n    - 队列矩阵 $X$，$N=6$，$B=4$：\n        - 行 0：$(11.2, 118, 42, 55)$\n        - 行 1：$(16.8, 132, 28, 49)$\n        - 行 2：$(13.5, 125, 36, 61)$\n        - 行 3：$(9.7, 110, 50, 66)$\n        - 行 4：$(14.9, 138, 25, 45)$\n        - 行 5：$(8.9, 115, 58, 70)$\n    - 方向向量 $r = (+1, +1, -1, -1)$。\n    - 权重 $w = (1, 1, 1, 1)$。\n    - 目标索引 $t=2$。\n\n- 测试用例 2（目标中有缺失数据，等权重）：\n    - 生物标志物顺序与测试用例1相同。\n    - 队列矩阵 $X$，$N=5$，$B=4$：\n        - 行 0：$(12.0, 120, 40, 60)$\n        - 行 1：$(15.0, 128, 35, 55)$\n        - 行 2：$(10.5, 115, \\text{NaN}, 58)$\n        - 行 3：$(18.0, 140, 22, 48)$\n        - 行 4：$(9.0, 110, 52, 65)$\n    - 方向向量 $r = (+1, +1, -1, -1)$。\n    - 权重 $w = (1, 1, 1, 1)$。\n    - 目标索引 $t=2$。\n\n- 测试用例 3（排除零方差生物标志物）：\n    - 生物标志物（列）：血浆皮质醇 $(\\mu\\text{g}/\\text{dL})$、C反应蛋白 $(\\text{mg}/\\text{L})$、心率变异性 RMSSD $(\\text{ms})$。\n    - 队列矩阵 $X$，$N=4$，$B=3$：\n        - 行 0：$(12.0, 2.5, 40)$\n        - 行 1：$(12.0, 2.5, 35)$\n        - 行 2：$(14.0, 2.5, 30)$\n        - 行 3：$(10.0, 2.5, 45)$\n    - 方向向量 $r = (+1, +1, -1)$。\n    - 权重 $w = (1, 1, 1)$。\n    - 目标索引 $t=0$。\n\n- 测试用例 4（非均匀权重）：\n    - 生物标志物（列）：血浆皮质醇 $(\\mu\\text{g}/\\text{dL})$、收缩压 $(\\text{mmHg})$、高密度脂蛋白 $(\\text{mg}/\\text{dL})$。\n    - 队列矩阵 $X$，$N=5$，$B=3$：\n        - 行 0：$(13.0, 122, 59)$\n        - 行 1：$(16.0, 135, 50)$\n        - 行 2：$(11.0, 118, 65)$\n        - 行 3：$(14.5, 130, 55)$\n        - 行 4：$(12.5, 125, 62)$\n    - 方向向量 $r = (+1, +1, -1)$。\n    - 权重 $w = (2.0, 1.0, 0.5)$。\n    - 目标索引 $t=4$。\n\n- 测试用例 5（单一个体队列边缘情况；所有生物标志物均被排除；综合指数定义为零；单个个体的中位数秩百分位数为 $0.5$）：\n    - 生物标志物（列）：血浆皮质醇 $(\\mu\\text{g}/\\text{dL})$、高密度脂蛋白 $(\\text{mg}/\\text{dL})$。\n    - 队列矩阵 $X$，$N=1$，$B=2$：\n        - 行 0：$(12.0, 60)$\n    - 方向向量 $r = (+1, -1)$。\n    - 权重 $w = (1.0, 1.0)$。\n    - 目标索引 $t=0$。\n\n您的程序必须为每个测试用例计算：\n- 目标个体的综合异态负荷指数 $\\mathrm{ALI}_t$。\n- 目标个体的中位数秩百分位数 $\\mathrm{perc}(t)$。\n\n最终输出格式：\n- 生成单行输出，其中包含测试套件的结果，格式为用方括号括起来的逗号分隔的配对列表，每个配对为 $[\\mathrm{ALI}_t,\\mathrm{perc}(t)]$，两个值都四舍五入到 $6$ 位小数。例如：$[[0.123456,0.654321],[\\dots],[\\dots]]$。", "solution": "该问题是有效的。它提出了一个清晰、有科学依据且定义明确的任务：将生理学概念“异态负荷”操作化为一个可计算的综合指数。所有定义、公式和约束都清晰明确，从而可以直接和可验证地实现。\n\n解决方案通过遵循一个多步骤、基于原则的过程来实现。\n\n首先，对于队列数据矩阵 $X \\in \\mathbb{R}^{N \\times B}$ 中的每个生物标志物 $j$，我们计算必要的总体统计数据。样本均值 $\\bar{x}_j$ 和样本标准差 $s_j$ 是基于该生物标志物的一组 $n_j$ 个可用（非缺失）测量值计算的。标准差的计算采用贝塞尔校正，在分母中使用 $n_j - 1$，这提供了对总体方差的无偏估计。这对于统计有效性至关重要，尤其是在小样本量的情况下。如果一个生物标志物 $j$ 没有足够的数据点来计算有意义的标准差（即 $n_j  2$），或者其值在整个队列中表现出零方差（即 $s_j = 0$），则该生物标志物被视为无效，并从所有后续计算中排除。这种排除可以防止除以零的错误，并确保只有信息丰富的生物标志物对指数有贡献。\n\n其次，对于每个个体 $i$，我们计算其综合异态负荷指数 $\\mathrm{ALI}_i$。这是通过遍历一组生物标志物（表示为 $J_i$）来执行的，这些生物标志物在队列层面是有效的（如第一步所确定），并且对于个体 $i$ 具有非缺失值 $x_{ij}$。对于每个这样的生物标志物 $j \\in J_i$，个体的测量值 $x_{ij}$ 通过公式 $z_{ij} = (x_{ij} - \\bar{x}_j) / s_j$ 转换为标准化的z-分数。这种标准化消除了生物标志物的原始单位和尺度，使它们能够有意义地组合。\n\n然后，每个z-分数乘以其对应的风险方向因子 $r_j \\in \\{+1, -1\\}$。这一步至关重要，因为它使标准化分数的解释与生理学知识保持一致；例如，皮质醇的高z-分数（$r_j = +1$）和心率变异性的高z-分数（$r_j = -1$），在定向后都表示较低的风险。然后，将定向后的z-分数使用加权平均组合成单个指数 $\\mathrm{ALI}_i$：$\\mathrm{ALI}_i = \\frac{\\sum_{j \\in J_i} w_j r_j z_{ij}}{\\sum_{j \\in J_i} w_j}$。使用权重 $w_j$ 允许领域专家为每个生物标志物分配不同的重要性级别。在特定情况下，如果个体没有有效的、非缺失的生物标志物数据，分母 $\\sum_{j \\in J_i} w_j$ 将为 $0$，其 $\\mathrm{ALI}_i$ 定义为 $0$。\n\n第三，在为队列中所有 $N$ 个个体计算出 $\\mathrm{ALI}$后，使用中位数秩百分位数来量化目标个体 $t$ 的相对位置。这个统计量度 $\\mathrm{perc}(t)$ 计算为 $\\mathrm{perc}(t) = (C_L + 0.5 \\cdot C_E) / N$，其中 $C_L$ 是 $\\mathrm{ALI}$ 分数严格小于 $\\mathrm{ALI}_t$ 的个体数量，$C_E$ 是 $\\mathrm{ALI}$ 分数完全等于 $\\mathrm{ALI}_t$ 的个体数量，$N$ 是总队列大小。这种方法通过有效地为平局组中的每个成员分配该组所跨越的秩的平均值，来稳健地处理平局情况。\n\n最终的实现将这整个逻辑封装在一个程序中，使用 `numpy` 库进行高效的数组操作，确保根据提供的公式正确处理缺失数据（`NaN` 值）并进行精确计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the allostatic load problem for the given test suite.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1\n        {\n            \"X\": np.array([\n                [11.2, 118, 42, 55],\n                [16.8, 132, 28, 49],\n                [13.5, 125, 36, 61],\n                [9.7, 110, 50, 66],\n                [14.9, 138, 25, 45],\n                [8.9, 115, 58, 70]\n            ]),\n            \"r\": np.array([1, 1, -1, -1]),\n            \"w\": np.array([1, 1, 1, 1]),\n            \"t\": 2\n        },\n        # Test case 2\n        {\n            \"X\": np.array([\n                [12.0, 120, 40, 60],\n                [15.0, 128, 35, 55],\n                [10.5, 115, np.nan, 58],\n                [18.0, 140, 22, 48],\n                [9.0, 110, 52, 65]\n            ]),\n            \"r\": np.array([1, 1, -1, -1]),\n            \"w\": np.array([1, 1, 1, 1]),\n            \"t\": 2\n        },\n        # Test case 3\n        {\n            \"X\": np.array([\n                [12.0, 2.5, 40],\n                [12.0, 2.5, 35],\n                [14.0, 2.5, 30],\n                [10.0, 2.5, 45]\n            ]),\n            \"r\": np.array([1, 1, -1]),\n            \"w\": np.array([1, 1, 1]),\n            \"t\": 0\n        },\n        # Test case 4\n        {\n            \"X\": np.array([\n                [13.0, 122, 59],\n                [16.0, 135, 50],\n                [11.0, 118, 65],\n                [14.5, 130, 55],\n                [12.5, 125, 62]\n            ]),\n            \"r\": np.array([1, 1, -1]),\n            \"w\": np.array([2.0, 1.0, 0.5]),\n            \"t\": 4\n        },\n        # Test case 5\n        {\n            \"X\": np.array([\n                [12.0, 60]\n            ]),\n            \"r\": np.array([1, -1]),\n            \"w\": np.array([1.0, 1.0]),\n            \"t\": 0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_ali_and_percentile(case[\"X\"], case[\"r\"], case[\"w\"], case[\"t\"])\n        results.append(result)\n\n    # Format the final output string exactly as specified.\n    # The default string representation of a list in Python does not add spaces.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_ali_and_percentile(X, r, w, t):\n    \"\"\"\n    Computes the Allostatic Load Index (ALI) and midrank percentile for a target individual.\n\n    Args:\n        X (np.ndarray): Cohort matrix (N x B) with individuals as rows, biomarkers as columns.\n        r (np.ndarray): Risk orientation vector (B).\n        w (np.ndarray): Biomarker weight vector (B).\n        t (int): Index of the target individual.\n\n    Returns:\n        list: A list containing [ALI_t, perc_t], both rounded to 6 decimal places.\n    \"\"\"\n    if X.ndim == 1:\n        X = X.reshape(1, -1)\n        \n    N, B = X.shape\n\n    # Step 1: Calculate cohort statistics and identify valid biomarkers\n    # Use nan-aware functions to handle missing data correctly.\n    with np.errstate(invalid='ignore', divide='ignore'):\n        cohort_means = np.nanmean(X, axis=0)\n        cohort_stds = np.nanstd(X, axis=0, ddof=1)\n\n    non_missing_counts = np.sum(~np.isnan(X), axis=0)\n    \n    # A biomarker is valid if it has non-zero variance and at least 2 data points.\n    is_valid_biomarker = (cohort_stds > 0)  (non_missing_counts >= 2)\n\n    # Step 2: Calculate z-scores for all values\n    with np.errstate(invalid='ignore', divide='ignore'):\n        z_scores = (X - cohort_means) / cohort_stds\n\n    # Step 3: Calculate ALI for all individuals in the cohort\n    ali_scores = np.zeros(N)\n    for i in range(N):\n        # Identify the specific biomarkers valid for this individual\n        # (cohort-level validity AND not missing for this individual).\n        individual_mask = is_valid_biomarker  ~np.isnan(X[i, :])\n\n        if not np.any(individual_mask):\n            ali_scores[i] = 0.0\n            continue\n        \n        valid_weights = w[individual_mask]\n        sum_of_weights = np.sum(valid_weights)\n\n        if sum_of_weights > 0:\n            oriented_z = z_scores[i, individual_mask] * r[individual_mask]\n            weighted_oriented_z = valid_weights * oriented_z\n            numerator = np.sum(weighted_oriented_z)\n            ali_scores[i] = numerator / sum_of_weights\n        else:\n            ali_scores[i] = 0.0\n\n    # Step 4: Calculate the target's ALI and midrank percentile\n    target_ali = ali_scores[t]\n\n    # Use np.isclose for robust floating-point comparisons\n    count_less = np.sum(ali_scores  target_ali)\n    count_equal = np.sum(np.isclose(ali_scores, target_ali))\n\n    percentile = (count_less + 0.5 * count_equal) / N\n    \n    return [round(target_ali, 6), round(percentile, 6)]\n\nsolve()\n\n```", "id": "2610489"}]}