{"hands_on_practices": [{"introduction": "任何分离科学的第一步都是对结果进行量化。这个练习提供了计算色谱分离度 $R_s$ 的基础实践，这是衡量分离质量的通用指标。通过解决这个问题 ([@problem_id:2589571])，你将学会如何将原始的色谱图数据——保留时间和峰宽——转化为一个决定性的数字，从而判断分离是否成功。", "problem": "在环境温度下，采用等度和恒定流速条件，对两种小分子代谢物进行反相高效液相色谱（HPLC）分离。这两个分析物峰近似呈高斯分布，其特征可通过保留时间和在每个峰回到基线的点之间测量的基线宽度很好地描述。保留时间分别为 $t_{R,1} = 5.2$ min 和 $t_{R,2} = 6.0$ min。相应的基线峰宽分别为 $w_{b,1} = 0.40$ min 和 $w_{b,2} = 0.45$ min。从色谱分离度的物理意义（即峰中心的分离程度相对于其峰展宽的程度）出发，并利用近高斯峰的展宽可通过测量的基线宽度来量化这一事实，确定这对峰的色谱分离度 $R_s$。然后，根据基线分离的常规标准（当 $R_s \\ge 1.5$ 时），判断是否达到了基线分离。将 $R_s$ 的最终值以无量纲数的形式报告，并将您的答案四舍五入至三位有效数字。", "solution": "所给问题是分析色谱学中的一个标准练习，在尝试解答前需对其进行验证。\n\n首先，逐字提取已知条件：\n- 分析物1的保留时间：$t_{R,1} = 5.2$ min\n- 分析物2的保留时间：$t_{R,2} = 6.0$ min\n- 分析物1的基线峰宽：$w_{b,1} = 0.40$ min\n- 分析物2的基线峰宽：$w_{b,2} = 0.45$ min\n- 问题陈述峰近似呈高斯分布。\n- 基线分离的条件为 $R_s \\ge 1.5$。\n- 任务是确定色谱分离度 $R_s$，并判断是否实现了基线分离。\n- $R_s$ 的最终数值答案必须四舍五入到三位有效数字。\n\n该问题具有科学依据、提法明确且客观。它描述了高效液相色谱（HPLC）中的一个真实场景，并使用了该领域的标准定义和惯例。所有必要数据均已提供，术语明确无歧义。因此，该问题是有效的，我们可以继续求解。\n\n色谱分离度 $R_s$ 的基本概念是量化两个相邻峰之间的分离程度。它定义为两个峰的保留时间之差，并以其平均峰宽进行归一化。这个定义提供了一个衡量峰中心相对于其展宽或分散程度分离得有多好的指标。\n\n对于两个标记为 $1$ 和 $2$ 的峰，其保留时间为 $t_{R,1}$ 和 $t_{R,2}$（其中 $t_{R,2}  t_{R,1}$），其峰中心的分离由差值 $\\Delta t_R = t_{R,2} - t_{R,1}$ 给出。\n\n每个峰的展宽由其宽度来表征。题目提供了基线宽度 $w_{b,1}$ 和 $w_{b,2}$。对于近似高斯分布的峰，基线宽度通常取为峰标准偏差的四倍（$w_b = 4\\sigma$）。分离度的计算考虑了两个峰的平均展宽。平均基线宽度为 $\\frac{1}{2}(w_{b,1} + w_{b,2})$。\n\n综合这些概念，色谱分离度的标准公式为：\n$$R_s = \\frac{t_{R,2} - t_{R,1}}{\\frac{1}{2}(w_{b,1} + w_{b,2})}$$\n这可以改写为：\n$$R_s = \\frac{2(t_{R,2} - t_{R,1})}{w_{b,1} + w_{b,2}}$$\n\n现在，我们将所给的数值代入这个公式。\n保留时间为 $t_{R,1} = 5.2$ min 和 $t_{R,2} = 6.0$ min。\n基线峰宽为 $w_{b,1} = 0.40$ min 和 $w_{b,2} = 0.45$ min。\n\n保留时间之差为：\n$$\\Delta t_R = t_{R,2} - t_{R,1} = 6.0 \\text{ min} - 5.2 \\text{ min} = 0.8 \\text{ min}$$\n\n基线宽度之和为：\n$$w_{b,1} + w_{b,2} = 0.40 \\text{ min} + 0.45 \\text{ min} = 0.85 \\text{ min}$$\n\n现在我们计算分离度 $R_s$：\n$$R_s = \\frac{2 \\times (0.8 \\text{ min})}{0.85 \\text{ min}} = \\frac{1.6}{0.85}$$\n分子和分母中的单位分钟（min）相互抵消，使得 $R_s$ 成为一个无量纲的量，这对于分离度是正确的。\n\n进行除法运算：\n$$R_s \\approx 1.8823529...$$\n\n题目要求答案四舍五入至三位有效数字。因此：\n$$R_s \\approx 1.88$$\n\n最后一步是解释这个结果。基线分离的常规标准（此时两个峰之间的重叠可以忽略不计，小于 $0.1\\%$）是分离度 $R_s \\ge 1.5$。我们计算出的值为 $R_s \\approx 1.88$。由于 $1.88  1.5$，因此满足了基线分离的标准。这两种代谢物在指定的色谱条件下得到了很好的分离。", "answer": "$$\\boxed{1.88}$$", "id": "2589571"}, {"introduction": "一旦你能够衡量分离度，下一步就是学习如何改进它。这个问题 ([@problem_id:2589559]) 将引导你推导总分离度方程，以揭示三个关键的调控因素：柱效 ($N$)、保留因子 ($k$) 和选择性 ($\\alpha$)。这项实践对于培养方法开发的直觉至关重要，因为它定量地证明了为什么调整选择性是分离具挑战性的共流出峰最有效的策略。", "problem": "在对两种结构相近的肽分析物进行反相高效液相色谱（RP-HPLC）分析时，您观察到在当前条件下它们完全共洗脱。您计划改变溶液的pH值或固定相的化学性质来调整选择性因子 $\\alpha$，同时保持塔板数 $N$ 和特征保留因子标度 $k$ 基本不变。\n\n严格从保留时间、容量因子、理论塔板数和色谱分离度的基本定义出发，完成以下任务：\n\n1) 使用以下关系式：(i) 对于分析物 $i$，其保留时间为 $t_{R,i} = t_{0}\\,(1 + k_{i})$，其中 $t_{0}$ 是死时间，$k_{i}$ 是容量因子；(ii) 高斯峰的基线宽度为 $w_{b,i} \\approx 4\\,\\sigma_{i}$，其中 $\\sigma_{i}$ 是时间标准偏差；(iii) 理论塔板数满足 $N_{i} = \\left(t_{R,i}/\\sigma_{i}\\right)^{2}$；以及 (iv) 色谱分离度为 $R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$，推导一个以 $N$（假设 $N_{1} = N_{2} = N$）、$k_{1}$ 和选择性因子 $\\alpha \\equiv k_{2}/k_{1}$ 表示的 $R_{s}$ 的显式表达式。\n\n2) 使用您推导出的表达式，从第一性原理的层面解释，为什么当分析物共洗脱时（即 $\\alpha = 1$），必须优先调整 $\\alpha$ 而不是改变 $N$ 和 $k$ 来实现分离。\n\n3) 在 $N = 16000$ 和 $k_{1} = 2.00$ 的条件下，当选择性因子乘以 1.05 倍后（即新的 $\\alpha = 1.05$），定量评估预期的分离度。假设选择性调整不改变 $N$ 和 $k_{1}$，并且上述高斯峰假设成立。将 $R_{s}$ 报告为一个无单位的纯数，并四舍五入到四位有效数字。", "solution": "所述问题已提交进行严格验证。\n\n步骤 1：提取的已知条件。\n- 该系统涉及对两种分析物（索引为 $i=1$ 和 $i=2$）进行的反相高效液相色谱（RP-HPLC）分析。\n- 初始条件：分析物完全共洗脱。\n- 目标是调整选择性因子 $\\alpha$。\n- 塔板数 $N$ 和保留因子标度 $k$ 被假定为“基本不变”。\n- 关系 (i)：保留时间为 $t_{R,i} = t_{0}\\,(1 + k_{i})$，其中 $t_{0}$ 是死时间，$k_{i}$ 是容量因子。\n- 关系 (ii)：高斯峰基线宽度为 $w_{b,i} \\approx 4\\,\\sigma_{i}$，其中 $\\sigma_{i}$ 是时间标准偏差。\n- 关系 (iii)：理论塔板数为 $N_{i} = \\left(t_{R,i}/\\sigma_{i}\\right)^{2}$。\n- 关系 (iv)：色谱分离度为 $R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$。\n- 推导假设：$N_{1} = N_{2} = N$。\n- 选择性因子定义：$\\alpha \\equiv k_{2}/k_{1}$。\n- 共洗脱的初始条件对应于 $\\alpha = 1$。\n- 用于定量评估的参数：新 $\\alpha = 1.05$，$N = 16000$，$k_{1} = 2.00$。\n\n步骤 2：问题陈述的验证。\n该问题具有科学依据，提法恰当且客观。它完全基于色谱理论的基本、标准定义和原理。给定的方程和参数是分析化学领域的标准。问题是自洽的，没有缺失信息或内部矛盾。提供的数值（$N=16000$, $k=2.00$）对于 HPLC 系统是物理上现实的。该任务是一个标准的教科书练习，旨在测试对控制色谱分离度的因素的理解。\n\n步骤 3：结论。\n该问题被认为是有效的。将构建一个解决方案。\n\n根据要求，该问题分三部分进行解答。\n\n1) 分离度表达式的推导。\n我们从给定的色谱分离度 $R_{s}$ 的定义开始：\n$$R_{s} = \\dfrac{t_{R,2} - t_{R,1}}{\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right)}$$\n分子代表峰顶的分离。使用给定关系式 $t_{R,i} = t_{0}\\,(1 + k_{i})$，分子变为：\n$$t_{R,2} - t_{R,1} = t_{0}(1+k_{2}) - t_{0}(1+k_{1}) = t_{0}(k_{2} - k_{1})$$\n分母代表平均峰宽。首先，我们必须用塔板数 $N_i$ 来表示基线宽度 $w_{b,i}$。根据定义 $N_{i} = (t_{R,i}/\\sigma_{i})^{2}$，我们得到标准偏差 $\\sigma_{i} = t_{R,i}/\\sqrt{N_{i}}$。将此代入基线宽度表达式 $w_{b,i} = 4\\sigma_{i}$，得到：\n$$w_{b,i} = \\frac{4t_{R,i}}{\\sqrt{N_{i}}}$$\n现在，我们将此表达式用于分离度方程的分母，并应用所述假设 $N_{1} = N_{2} = N$：\n$$\\tfrac{1}{2}\\left(w_{b,1} + w_{b,2}\\right) = \\tfrac{1}{2}\\left(\\frac{4t_{R,1}}{\\sqrt{N}} + \\frac{4t_{R,2}}{\\sqrt{N}}\\right) = \\frac{2}{\\sqrt{N}}(t_{R,1} + t_{R,2})$$\n将分子和分母的表达式代回分离度方程，得到：\n$$R_{s} = \\dfrac{t_{0}(k_{2} - k_{1})}{\\frac{2}{\\sqrt{N}}(t_{R,1} + t_{R,2})} = \\frac{\\sqrt{N}}{2} \\frac{t_{0}(k_{2} - k_{1})}{t_{R,1} + t_{R,2}}$$\n为了仅用 $N$、$k_1$ 和 $\\alpha$ 表示 $R_{s}$，我们将 $t_{R,i} = t_{0}(1+k_i)$ 代入此中间表达式的分母：\n$$t_{R,1} + t_{R,2} = t_{0}(1+k_{1}) + t_{0}(1+k_{2}) = t_{0}(2 + k_{1} + k_{2})$$\n这导致：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{t_{0}(k_{2} - k_{1})}{t_{0}(2 + k_{1} + k_{2})} = \\frac{\\sqrt{N}}{2} \\frac{k_{2} - k_{1}}{2 + k_{1} + k_{2}}$$\n最后，我们引入选择性因子 $\\alpha = k_{2}/k_{1}$，这意味着 $k_{2} = \\alpha k_{1}$。将此代入方程，得到最终表达式：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{\\alpha k_{1} - k_{1}}{2 + k_{1} + \\alpha k_{1}} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(\\alpha-1)}{2 + k_{1}(1+\\alpha)}$$\n这就是严格从所给定义推导出的 $R_{s}$ 的所需表达式。\n\n2) 关于选择性 $\\alpha$ 首要性的解释。\n推导出的分离度表达式是与柱效（$N$）、分析物保留（$k_1$）和选择性（$\\alpha$）相关的项的乘积：\n$$R_{s} = \\left(\\frac{\\sqrt{N}}{2}\\right) \\left(\\frac{k_{1}}{2 + k_{1}(1+\\alpha)}\\right) \\left(\\alpha-1\\right)$$\n根据定义，共洗脱意味着分析物具有相同的保留时间，因此具有相同的容量因子：$k_{1} = k_{2}$。因此，选择性因子 $\\alpha = k_{2}/k_{1}$ 精确等于 1。\n如果我们将 $\\alpha=1$ 代入推导出的分离度表达式：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(1-1)}{2 + k_{1}(1+1)} = \\frac{\\sqrt{N}}{2} \\frac{k_{1} \\cdot 0}{2 + 2k_{1}} = 0$$\n这个结果是决定性的。无论塔板数 $N$ 或容量因子 $k_1$ 的值是多少（只要它们是有限的），分离度都为零。$(\\alpha-1)$ 项充当了分离的乘法开关。如果 $\\alpha=1$，该项为零，迫使整个乘积 $R_s$ 为零。可以想象，即使是无限高效的色谱柱（$N \\to \\infty$）产生无限窄的峰，但如果没有选择性（$\\alpha=1$），这些峰仍然会完全重叠，导致分离度为零。因此，要实现任何分离（即，使 $R_{s}  0$），绝对有必要使 $\\alpha \\neq 1$。增加 $N$ 或优化 $k$ 是改善现有分离的次要调整；它们无法从完全共洗脱的状态中创造出分离。建立选择性（$\\alpha  1$）是基本先决条件。\n\n3) 分离度的定量评估。\n我们使用第（1）部分推导出的表达式，并代入给定的数值：$N = 16000$，$k_{1} = 2.00$ 和新的选择性因子 $\\alpha = 1.05$。\n表达式为：\n$$R_{s} = \\frac{\\sqrt{N}}{2} \\frac{k_{1}(\\alpha-1)}{2 + k_{1}(1+\\alpha)}$$\n代入数值：\n$$R_{s} = \\frac{\\sqrt{16000}}{2} \\frac{2.00(1.05-1)}{2 + 2.00(1+1.05)}$$\n我们分别计算各项。塔板数的平方根是：\n$$\\sqrt{16000} = \\sqrt{1600 \\times 10} = 40\\sqrt{10} \\approx 126.4911$$\n分数项的分子是：\n$$2.00(1.05-1) = 2.00(0.05) = 0.100$$\n分数项的分母是：\n$$2 + 2.00(1+1.05) = 2 + 2.00(2.05) = 2 + 4.10 = 6.10$$\n结合这些结果：\n$$R_{s} = \\frac{126.4911}{2} \\left(\\frac{0.100}{6.10}\\right) \\approx 63.24555 \\times 0.01639344 \\approx 1.03669$$\n按要求将结果四舍五入到四位有效数字，我们得到分离度的最终数值答案。\n$$R_s \\approx 1.037$$", "answer": "$$\\boxed{1.037}$$", "id": "2589559"}, {"introduction": "现代色谱方法开发已经超越了单参数的调整，而是系统地描绘整个“设计空间”，以寻找一个稳健的操作区域。这项高级实践 ([@problem_id:2589640]) 整合了柱效、分析物保留和系统压力的模型，以构建方法性能的完整图景。通过在不同条件下模拟分离结果，你将学会主动识别最佳参数，以在满足仪器限制的同时保证分离度，这是分析化学中“质量源于设计”（QbD）方法的基石。", "problem": "要求您编写一个完整的程序，通过将基于物理的塔板模型与标准仪器约束相结合，绘制填充柱上二元等度分离的色谱设计空间。请基于以下基本原理，推导您程序中所需的所有关系式。\n\n- 塔板模型中的定义：理论塔板等效高度 $H$ 和塔板数 $N$ 满足 $H = L/N$，其中 $L$ 是填充床长度。\n- 填充床在等度条件下的 van Deemter 关系式：塔板高度取决于间隙线速度 $u_i$，其关系为 $H(u_i) = A + \\frac{B}{u_i} + C \\, u_i$。\n- 用于反相等度保留的线性溶剂强度模型：对于参数为 $\\log_{10} k_{0,i}$ 和 $S_i$ 的分析物 $i$，其保留因子满足 $\\log_{10} k_i(\\phi) = \\log_{10} k_{0,i} - S_i \\, \\phi$，其中 $\\phi$ 是有机相的体积分数。\n- 选择性和洗脱顺序的定义：对于在给定 $\\phi$ 下具有保留因子 $k_1(\\phi)$ 和 $k_2(\\phi)$ 的两种分析物，先洗脱组分的保留因子为 $k_{\\text{early}}(\\phi) = \\min\\{k_1(\\phi), k_2(\\phi)\\}$，后洗脱组分的保留因子为 $k_{\\text{late}}(\\phi) = \\max\\{k_1(\\phi), k_2(\\phi)\\}$，选择性为 $\\alpha(\\phi) = \\frac{k_{\\text{late}}(\\phi)}{k_{\\text{early}}(\\phi)}$。\n- 使用 Kozeny–Carman 形式描述的填充床层流压降：对于孔隙率为 $\\varepsilon$、颗粒直径为 $d_p$ 的填充床，在表观（达西）流速为 $u$ 时，其压降 $\\Delta P$ 为 $\\Delta P(u,\\phi) = f(\\varepsilon) \\, \\eta(\\phi) \\, \\frac{L}{d_p^2} \\, u$，其中 $f(\\varepsilon) = 180 \\, \\frac{(1-\\varepsilon)^2}{\\varepsilon^3}$，$\\eta(\\phi)$ 是流动相的动力粘度。间隙流速和表观流速之间的关系为 $u_i = \\frac{u}{\\varepsilon}$。\n- 在粘度非理想性可以用对数混合表示的温度条件下，水-乙腈混合物的粘度模型为：$\\ln \\eta(\\phi) = (1 - \\phi) \\, \\ln \\eta_w + \\phi \\, \\ln \\eta_a$，其中 $\\eta_w$ 和 $\\eta_a$ 分别是水和乙腈的纯组分动力粘度。所有粘度单位必须是帕斯卡-秒。\n\n仅使用上述基本原理，推导一个两个色谱峰的分离度 $R_s$ 的可计算表达式，该表达式依赖于塔板数 $N$、选择性 $\\alpha$ 以及后洗脱分析物的保留因子 $k_{\\text{late}}$。然后，将其与 van Deemter 关系式和线性溶剂强度模型结合，以将 $R_s$ 表示为 $u$ 和 $\\phi$ 的函数，并将 Kozeny–Carman 关系式与粘度模型结合，以将 $\\Delta P$ 表示为 $u$ 和 $\\phi$ 的函数。您的最终程序必须：\n\n- 为每个测试用例在 $(u,\\phi)$ 平面上构建一个均匀的矩形网格。\n- 在每个网格点 $(u,\\phi)$，通过 van Deemter 关系式使用 $u_i = \\frac{u}{\\varepsilon}$ 计算塔板数 $N(u)$，通过线性溶剂强度模型计算 $k_1(\\phi)$ 和 $k_2(\\phi)$，并由此确定 $k_{\\text{late}}(\\phi)$ 和 $\\alpha(\\phi)$，然后根据您推导的表达式计算 $R_s(u,\\phi)$。同时，根据对数混合规则计算 $\\eta(\\phi)$，并计算以帕斯卡为单位的 $\\Delta P(u,\\phi)$。\n- 确定由 $R_s(u,\\phi) \\geq 1.5$ 和 $\\Delta P(u,\\phi) \\leq \\Delta P_{\\max}$ 这两个同时满足的约束条件所定义的设计空间区域，其中 $\\Delta P_{\\max}$ 是一个固定的仪器上限。使用 $\\Delta P_{\\max} = 600$ 巴。使用 $1$ 巴 $= 10^5$ 帕斯卡将此上限转换为帕斯卡，即与 $6 \\times 10^7$ 帕斯卡进行比较。\n- 对于每个测试用例，返回一个等于同时满足两个约束条件的网格点所占比例的标量。该比例是无量纲的，并且必须以闭区间 $[0,1]$ 内的浮点数形式报告。\n\n科学和计算要求：\n\n- 所有计算必须使用一致的单位进行：长度单位为米，速度单位为米/秒，粘度单位为帕斯卡-秒，压力单位为帕斯卡。\n- 计算中不出现角度，最终输出中也没有百分比；任何分数形式的量都必须以小数表示。\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[0.42,0.07,1.0]$），列表中的结果与下面给出的测试用例一一对应。\n\n测试套件（每个用例都是独立的；请精确使用所提供的参数）：\n\n- 测试用例 1（正常路径，中等长度色谱柱，在 $\\phi$ 范围中部有挑战性的选择性交叉）：\n  - 色谱柱和填充床：$L = 0.10$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter 参数：$A = 2.0 \\times 10^{-6}$ m, $B = 1.6 \\times 10^{-9}$ m$^2$ s$^{-1}$, $C = 4.0 \\times 10^{-3}$ s。\n  - 分析物 1：$\\log_{10} k_{0,1} = 1.30$, $S_1 = 3.00$。\n  - 分析物 2：$\\log_{10} k_{0,2} = 1.60$, $S_2 = 4.00$。\n  - 粘度端点：$\\eta_w = 8.90 \\times 10^{-4}$ Pa s, $\\eta_a = 3.70 \\times 10^{-4}$ Pa s。\n  - 网格：$\\phi \\in [0.10, 0.60]$，共 $41$ 个均匀间隔的点；$u \\in [2.0 \\times 10^{-4}, 1.2 \\times 10^{-3}]$ m s$^{-1}$，共 $41$ 个均匀间隔的点。\n\n- 测试用例 2（柱长减半的边界条件）：\n  - 色谱柱和填充床：$L = 0.050$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter 参数、分析物和粘度端点与测试用例 1 相同。\n  - 网格与测试用例 1 相同。\n\n- 测试用例 3（较大颗粒和略有不同的弥散参数）：\n  - 色谱柱和填充床：$L = 0.10$ m, $d_p = 2.6 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter 参数：$A = 3.0 \\times 10^{-6}$ m, $B = 2.0 \\times 10^{-9}$ m$^2$ s$^{-1}$, $C = 3.0 \\times 10^{-3}$ s。\n  - 分析物与测试用例 1 相同。\n  - 粘度端点与测试用例 1 相同。\n  - 网格：$\\phi \\in [0.05, 0.60]$，共 $36$ 个均匀间隔的点；$u \\in [3.0 \\times 10^{-4}, 1.5 \\times 10^{-3}]$ m s$^{-1}$，共 $41$ 个均匀间隔的点。\n\n- 测试用例 4（选择性对比度弱的边缘情况）：\n  - 色谱柱和填充床：$L = 0.10$ m, $d_p = 1.7 \\times 10^{-6}$ m, $\\varepsilon = 0.40$。\n  - van Deemter 参数与测试用例 1 相同。\n  - 分析物 1：$\\log_{10} k_{0,1} = 1.40$, $S_1 = 3.20$。\n  - 分析物 2：$\\log_{10} k_{0,2} = 1.41$, $S_2 = 3.30$。\n  - 粘度端点与测试用例 1 相同。\n  - 网格：$\\phi \\in [0.05, 0.60]$，共 $36$ 个均匀间隔的点；$u \\in [2.0 \\times 10^{-4}, 1.0 \\times 10^{-3}]$ m s$^{-1}$，共 $41$ 个均匀间隔的点。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中 $r_j$ 是测试用例 $j$ 中满足 $R_s \\ge 1.5$ 和 $\\Delta P \\le 600$ 巴两个条件的网格点所占的比例。不应打印任何其他文本。", "solution": "问题陈述经过严格验证，被认为是具有科学依据、适定且内部一致的。它基于色谱科学和流体动力学的既定基本原理。为获得唯一的数值解所需的所有必要参数和约束条件均已提供。因此，我将继续进行推导和计算实现。\n\n首先，我们必须推导色谱分离度 $R_s$ 的表达式，该表达式是理论塔板数 $N$、选择性 $\\alpha$ 和后洗脱分析物保留因子 $k_{\\text{late}}$ 的函数。\n\n两个高斯峰之间的分离度定义为它们的峰顶距除以其峰底宽度的平均值：\n$$\nR_s = \\frac{2(t_{R,2} - t_{R,1})}{w_1 + w_2}\n$$\n其中 $t_{R,i}$ 是分析物 $i$ 的保留时间，$w_i$ 是其峰底宽度。保留时间通过 $t_{R,i} = t_0(1+k_i)$ 与色谱柱死时间 $t_0$ 和保留因子 $k_i$ 相关。峰底宽度通过 $w_i = 4 \\frac{t_{R,i}}{\\sqrt{N_i}}$ 与理论塔板数 $N_i$ 相关。\n\n我们做一个标准且合理的近似，即对于两个相近洗脱的峰，它们的塔板数约相等，$N_1 \\approx N_2 = N$。将这些关系代入分离度方程：\n$$\nR_s = \\frac{2(t_0(1+k_2) - t_0(1+k_1))}{\\frac{4 t_0(1+k_1)}{\\sqrt{N}} + \\frac{4 t_0(1+k_2)}{\\sqrt{N}}} = \\frac{\\sqrt{N}}{2} \\frac{k_2 - k_1}{2 + k_1 + k_2}\n$$\n在这里，我们将分析物 $2$ 指定为后洗脱物质，因此 $k_2 = k_{\\text{late}}$，$k_1 = k_{\\text{early}}$。根据定义，选择性为 $\\alpha = \\frac{k_{\\text{late}}}{k_{\\text{early}}}$，这意味着 $k_{\\text{early}} = \\frac{k_{\\text{late}}}{\\alpha}$。将这些代入方程得到：\n$$\nR_s = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} - \\frac{k_{\\text{late}}}{\\alpha}}{2 + \\frac{k_{\\text{late}}}{\\alpha} + k_{\\text{late}}} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} \\left(1-\\frac{1}{\\alpha}\\right)}{2 + k_{\\text{late}}\\left(1+\\frac{1}{\\alpha}\\right)} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} \\left(\\frac{\\alpha-1}{\\alpha}\\right)}{2 + k_{\\text{late}}\\left(\\frac{\\alpha+1}{\\alpha}\\right)} = \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}}(\\alpha-1)}{2\\alpha + k_{\\text{late}}(\\alpha+1)}\n$$\n这是一个有效的表达式。然而，一个更进一步且非常常见的近似将其简化为著名的 Purnell 方程。这个近似是，在分母项中，由于两个峰很接近，它们的保留因子也相似，$k_{\\text{early}} \\approx k_{\\text{late}}$。这将 $2+k_{\\text{early}}+k_{\\text{late}}$ 简化为 $\\approx 2 + 2k_{\\text{late}} = 2(1+k_{\\text{late}})$。应用此近似：\n$$\nR_s \\approx \\frac{\\sqrt{N}}{2} \\frac{k_{\\text{late}} - k_{\\text{early}}}{2(1+k_{\\text{late}})} = \\frac{\\sqrt{N}}{4} \\frac{k_{\\text{late}} - \\frac{k_{\\text{late}}}{\\alpha}}{1+k_{\\text{late}}} = \\frac{\\sqrt{N}}{4} \\frac{k_{\\text{late}}\\left(1-\\frac{1}{\\alpha}\\right)}{1+k_{\\text{late}}}\n$$\n这就得到了我们将用于计算的 Purnell 方程的最终典范形式：\n$$\nR_s(N, \\alpha, k_{\\text{late}}) = \\frac{\\sqrt{N}}{4} \\left(\\frac{\\alpha-1}{\\alpha}\\right) \\left(\\frac{k_{\\text{late}}}{1+k_{\\text{late}}}\\right)\n$$\n\n接下来，我们整合绘制设计空间所需的完整方程组。自变量是表观流速 $u$ 和流动相的有机相体积分数 $\\phi$。\n\n1.  **塔板数 $N(u)$**：塔板数取决于间隙流速 $u_i = u/\\varepsilon$，其中 $\\varepsilon$ 是床层孔隙率。使用给定的 van Deemter 关系式计算塔板高度 $H(u_i)$ 和柱长 $L$：\n    $$\n    H(u_i) = A + \\frac{B}{u_i} + C u_i = A + \\frac{B \\varepsilon}{u} + \\frac{C u}{\\varepsilon}\n    $$\n    $$\n    N(u) = \\frac{L}{H(u)} = \\frac{L}{A + \\frac{B \\varepsilon}{u} + \\frac{C u}{\\varepsilon}}\n    $$\n    请注意，对于给定的色谱柱填料，$N$ 仅是 $u$ 的函数。\n\n2.  **保留与选择性, $k_i(\\phi), \\alpha(\\phi)$**：两种分析物的保留因子由线性溶剂强度模型给出：\n    $$\n    \\log_{10} k_1(\\phi) = \\log_{10} k_{0,1} - S_1 \\phi \\implies k_1(\\phi) = 10^{\\log_{10} k_{0,1} - S_1 \\phi}\n    $$\n    $$\n    \\log_{10} k_2(\\phi) = \\log_{10} k_{0,2} - S_2 \\phi \\implies k_2(\\phi) = 10^{\\log_{10} k_{0,2} - S_2 \\phi}\n    $$\n    由此，我们确定在每个 $\\phi$ 值下的后洗脱物质和选择性：\n    $$\n    k_{\\text{late}}(\\phi) = \\max\\{k_1(\\phi), k_2(\\phi)\\}\n    $$\n    $$\n    k_{\\text{early}}(\\phi) = \\min\\{k_1(\\phi), k_2(\\phi)\\}\n    $$\n    $$\n    \\alpha(\\phi) = \\frac{k_{\\text{late}}(\\phi)}{k_{\\text{early}}(\\phi)}\n    $$\n    这些量仅取决于 $\\phi$。\n\n3.  **压降, $\\Delta P(u, \\phi)$**：压降使用 Kozeny-Carman 方程计算。首先，我们使用所提供的水-乙腈混合物对数混合规则计算流动相粘度 $\\eta(\\phi)$：\n    $$\n    \\ln \\eta(\\phi) = (1 - \\phi) \\ln \\eta_w + \\phi \\ln \\eta_a \\implies \\eta(\\phi) = \\exp\\left((1 - \\phi) \\ln \\eta_w + \\phi \\ln \\eta_a\\right)\n    $$\n    对于给定的色谱柱，几何因子 $f(\\varepsilon)$ 是恒定的：\n    $$\n    f(\\varepsilon) = 180 \\frac{(1-\\varepsilon)^2}{\\varepsilon^3}\n    $$\n    压降则为：\n    $$\n    \\Delta P(u, \\phi) = f(\\varepsilon) \\, \\eta(\\phi) \\, \\frac{L}{d_p^2} \\, u\n    $$\n    其中 $d_p$ 是颗粒直径。\n\n4.  **计算流程**：对于每个测试用例，我们在 $(u, \\phi)$ 平面上构建一个均匀网格。在每个网格点：\n    a. 根据网格点 $u$ 的值计算 $N(u)$。\n    b. 根据网格点 $\\phi$ 的值计算 $k_1(\\phi)$、$k_2(\\phi)$、$k_{\\text{late}}(\\phi)$ 和 $\\alpha(\\phi)$。\n    c. 结合这些值，使用 Purnell 方程计算分离度 $R_s(u, \\phi)$。\n    d. 根据网格点 $\\phi$ 的值计算 $\\eta(\\phi)$。\n    e. 结合这些值计算压降 $\\Delta P(u, \\phi)$。\n    f. 当且仅当 $R_s(u, \\phi) \\geq 1.5$ 和 $\\Delta P(u, \\phi) \\leq 6 \\times 10^7$ Pa 这两个约束条件都满足时，一个网格点才被视为有效设计空间的一部分。\n    g. 测试用例的最终结果是满足这两个条件的总网格点所占的比例。其计算方法为：将有效点的数量相加，然后除以网格中的总点数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chromatographic design space problem for multiple test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    test_cases = [\n        {\n            # Test case 1\n            \"L\": 0.10, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.10, 0.60, 41),\n            \"u_range\": (2.0e-4, 1.2e-3, 41),\n        },\n        {\n            # Test case 2\n            \"L\": 0.050, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.10, 0.60, 41),\n            \"u_range\": (2.0e-4, 1.2e-3, 41),\n        },\n        {\n            # Test case 3\n            \"L\": 0.10, \"dp\": 2.6e-6, \"eps\": 0.40,\n            \"A\": 3.0e-6, \"B\": 2.0e-9, \"C\": 3.0e-3,\n            \"logk0_1\": 1.30, \"S1\": 3.00,\n            \"logk0_2\": 1.60, \"S2\": 4.00,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.05, 0.60, 36),\n            \"u_range\": (3.0e-4, 1.5e-3, 41),\n        },\n        {\n            # Test case 4\n            \"L\": 0.10, \"dp\": 1.7e-6, \"eps\": 0.40,\n            \"A\": 2.0e-6, \"B\": 1.6e-9, \"C\": 4.0e-3,\n            \"logk0_1\": 1.40, \"S1\": 3.20,\n            \"logk0_2\": 1.41, \"S2\": 3.30,\n            \"eta_w\": 8.90e-4, \"eta_a\": 3.70e-4,\n            \"phi_range\": (0.05, 0.60, 36),\n            \"u_range\": (2.0e-4, 1.0e-3, 41),\n        },\n    ]\n\n    # Constraints\n    RS_MIN = 1.5\n    DP_MAX = 6e7  # 600 bar in Pascals\n\n    results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        L, dp, eps = case[\"L\"], case[\"dp\"], case[\"eps\"]\n        A, B, C = case[\"A\"], case[\"B\"], case[\"C\"]\n        logk0_1, S1 = case[\"logk0_1\"], case[\"S1\"]\n        logk0_2, S2 = case[\"logk0_2\"], case[\"S2\"]\n        eta_w, eta_a = case[\"eta_w\"], case[\"eta_a\"]\n        \n        # Construct grid\n        phi_vec = np.linspace(*case[\"phi_range\"])\n        u_vec = np.linspace(*case[\"u_range\"])\n        U, PHI = np.meshgrid(u_vec, phi_vec)\n\n        # 1. Plate Number Calculation (depends on u)\n        ui = U / eps\n        H = A + (B / ui) + (C * ui)\n        N = L / H\n\n        # 2. Retention and Selectivity Calculation (depends on phi)\n        logk1 = logk0_1 - S1 * PHI\n        logk2 = logk0_2 - S2 * PHI\n        k1 = 10**logk1\n        k2 = 10**logk2\n        \n        k_late = np.maximum(k1, k2)\n        k_early = np.minimum(k1, k2)\n        \n        # Avoid division by zero if k_early is zero\n        alpha = np.divide(k_late, k_early, out=np.ones_like(k_late), where=k_early!=0)\n\n        # 3. Resolution Calculation\n        # Purnell equation: Rs = (sqrt(N)/4) * ((alpha-1)/alpha) * (k_late/(1+k_late))\n        term_N = np.sqrt(N) / 4.0\n        term_alpha = np.divide(alpha - 1.0, alpha, out=np.zeros_like(alpha), where=alpha!=0)\n        term_k = k_late / (1.0 + k_late)\n        Rs = term_N * term_alpha * term_k\n        # Ensure Rs is non-negative\n        Rs[Rs  0] = 0\n\n        # 4. Pressure Drop Calculation\n        f_eps = 180.0 * (1.0 - eps)**2 / eps**3\n        log_eta_w = np.log(eta_w)\n        log_eta_a = np.log(eta_a)\n        log_eta = (1.0 - PHI) * log_eta_w + PHI * log_eta_a\n        eta = np.exp(log_eta)\n        \n        DeltaP = f_eps * eta * (L / dp**2) * U\n\n        # 5. Apply constraints and calculate fraction\n        valid_points = (Rs >= RS_MIN)  (DeltaP = DP_MAX)\n        fraction = np.sum(valid_points) / valid_points.size\n        results.append(fraction)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2589640"}]}