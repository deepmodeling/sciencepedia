{"hands_on_practices": [{"introduction": "理解代谢网络所有可能的行为模式，是进行理性工程改造的第一步。本练习通过构建一个简单合成模块的化学计量矩阵，向您介绍通量空间这一基本概念。通过求解其零空间基 [@problem_id:2609236]，您将学会识别和解释基本的代谢模式，例如定义系统稳态能力的无效循环和贯通途径。", "problem": "一个用于相互转换两种代谢物的合成途径的最小胞质模块被设计出来，它包含四个酶催化反应，所有反应都以单向步骤实现。设内部代谢物为 $A$ 和 $B$。这些反应是：\n- $v_{1}$：从环境中摄取 $A$，模型为 $\\varnothing \\rightarrow A$（转运和激活合并）。\n- $v_{2}$：转化 $A \\rightarrow B$（由工程酶催化，单向）。\n- $v_{3}$：转化 $B \\rightarrow A$（由另一种不同的工程酶实现，单向）。\n- $v_{4}$：$B$ 的分泌或汇，模型为 $B \\rightarrow \\varnothing$。\n\n假设在操作条件下所有四个反应都是不可逆的（因此每个通量满足 $v_{i} \\geq 0$，其中 $i \\in \\{1,2,3,4\\}$）。设细胞内化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 4}$，其行对应于代谢物 $(A,B)$，列对应于反应 $(v_{1},v_{2},v_{3},v_{4})$，由上述反应所蕴含的质量平衡给出。在稳态下，细胞内代谢物浓度是恒定的，因此基本质量平衡方程为 $S\\,\\mathbf{v}=\\mathbf{0}$，其中 $\\mathbf{v} = (v_{1},v_{2},v_{3},v_{4})^{\\top}$。\n\n任务：\n- 根据化学计量质量平衡的第一性原理，构建 $S$ 并计算 $\\ker(S)$ 的一个基。从生物化学角度将每个基向量解释为一个独立的稳态通量模式。\n- 考虑不可逆性约束 $v_{i} \\geq 0$，确定基向量的哪些线性组合对应于物理上可行的稳态通量（你可以用参数形式描述所得到的锥）。\n- 作为最终答案，报告同时满足 $S\\,\\mathbf{v}=\\mathbf{0}$ 和所有 $i$ 的 $v_{i} \\geq 0$ 的稳态通量集合的维度。\n\n将你的最终答案以单个整数形式给出。不需要四舍五入，也不需要报告单位。", "solution": "该问题要求使用化学计量原理对稳态下的合成代谢网络进行分析。首先必须对问题进行验证。\n\n问题验证：\n已知条件：\n- 内部代谢物：$A$ 和 $B$。\n- 反应：\n  - $v_{1}: \\varnothing \\rightarrow A$\n  - $v_{2}: A \\rightarrow B$\n  - $v_{3}: B \\rightarrow A$\n  - $v_{4}: B \\rightarrow \\varnothing$\n- 不可逆性约束：$v_{i} \\geq 0$，其中 $i \\in \\{1, 2, 3, 4\\}$。\n- 化学计量矩阵定义：$S \\in \\mathbb{R}^{2 \\times 4}$，行对应于 $(A, B)$，列对应于 $(v_{1}, v_{2}, v_{3}, v_{4})$。\n- 稳态条件：$S\\,\\mathbf{v}=\\mathbf{0}$，其中 $\\mathbf{v} = (v_{1}, v_{2}, v_{3}, v_{4})^{\\top}$。\n\n验证结论：\n该问题具有科学依据，采用了代谢通量分析的标准方法。它适定、客观且自洽，为求解提供了所有必要的信息。该概念模型是一个简化但合理的合成生物电路表示。因此，该问题被认为是有效的。\n\n求解推导：\n第一个任务是构建化学计量矩阵 $S$。条目 $S_{ij}$ 表示代谢物 $i$ 在反应 $j$ 中的化学计量系数。行对应于代谢物 $A$ 和 $B$，列对应于通量 $v_{1}$、$v_{2}$、$v_{3}$ 和 $v_{4}$。\n\n对于代谢物 $A$：\n- 反应 $v_1$ 产生一个 $A$ 分子，系数为 $+1$。\n- 反应 $v_2$ 消耗一个 $A$ 分子，系数为 $-1$。\n- 反应 $v_3$ 产生一个 $A$ 分子，系数为 $+1$。\n- 反应 $v_4$ 不涉及 $A$，系数为 $0$。\n$S$ 的第一行是 $(1, -1, 1, 0)$。\n\n对于代谢物 $B$：\n- 反应 $v_1$ 不涉及 $B$，系数为 $0$。\n- 反应 $v_2$ 产生一个 $B$ 分子，系数为 $+1$。\n- 反应 $v_3$ 消耗一个 $B$ 分子，系数为 $-1$。\n- 反应 $v_4$ 消耗一个 $B$ 分子，系数为 $-1$。\n$S$ 的第二行是 $(0, 1, -1, -1)$。\n\n因此，化学计量矩阵 $S$ 为：\n$$ S = \\begin{pmatrix} 1 & -1 & 1 & 0 \\\\ 0 & 1 & -1 & -1 \\end{pmatrix} $$\n下一个任务是计算 $S$ 的零空间（核）的基，记为 $\\ker(S)$。这等价于求解线性系统 $S\\mathbf{v} = \\mathbf{0}$，其中通量向量为 $\\mathbf{v} = (v_1, v_2, v_3, v_4)^{\\top}$。方程组为：\n$$ v_1 - v_2 + v_3 = 0 $$\n$$ v_2 - v_3 - v_4 = 0 $$\n矩阵 $S$ 处于行阶梯形，其秩为 $2$。变量数量为 $4$，因此零空间的维度是 $4 - \\text{rank}(S) = 4 - 2 = 2$。我们选择两个自由变量，例如 $v_3$ 和 $v_4$。\n设 $v_3 = s$ 和 $v_4 = t$，其中 $s, t \\in \\mathbb{R}$ 为任意参数。\n从第二个方程，我们表示 $v_2$：\n$$ v_2 = v_3 + v_4 = s + t $$\n从第一个方程，我们表示 $v_1$：\n$$ v_1 = v_2 - v_3 = (s + t) - s = t $$\n稳态通量向量 $\\mathbf{v}$ 的通解为：\n$$ \\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\\\ v_4 \\end{pmatrix} = \\begin{pmatrix} t \\\\ s+t \\\\ s \\\\ t \\end{pmatrix} = s \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n$\\ker(S)$ 的一个基由对应于参数 $s$ 和 $t$ 的两个向量构成：\n$$ \\mathbf{b}_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{b}_2 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n这些基向量代表独立的稳态通量模式。\n- 向量 $\\mathbf{b}_1 = (0, 1, 1, 0)^{\\top}$ 表示一个“无效循环”：$A \\rightarrow B \\rightarrow A$。通量 $v_2$ 将 $A$ 转化为 $B$，通量 $v_3$ 将 $B$ 转回 $A$，与环境没有净交换。\n- 向量 $\\mathbf{b}_2 = (1, 1, 0, 1)^{\\top}$ 表示一个“贯通”途径：$\\varnothing \\rightarrow A \\rightarrow B \\rightarrow \\varnothing$。代谢物 $A$ 被输入，转化为 $B$，然后 $B$ 被输出。\n\n接下来，我们应用不可逆性约束 $v_i \\geq 0$，其中 $i \\in \\{1, 2, 3, 4\\}$。一个物理上可行的稳态通量向量 $\\mathbf{v}$ 必须是基向量的线性组合，$\\mathbf{v} = \\alpha_1 \\mathbf{b}_1 + \\alpha_2 \\mathbf{b}_2$。\n$$ \\mathbf{v} = \\alpha_1 \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\alpha_2 \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\alpha_2 \\\\ \\alpha_1 + \\alpha_2 \\\\ \\alpha_1 \\\\ \\alpha_2 \\end{pmatrix} $$\n非负性约束 $v_i \\geq 0$ 对系数 $\\alpha_1$ 和 $\\alpha_2$ 施加了条件：\n1. $v_1 = \\alpha_2 \\geq 0$\n2. $v_2 = \\alpha_1 + \\alpha_2 \\geq 0$\n3. $v_3 = \\alpha_1 \\geq 0$\n4. $v_4 = \\alpha_2 \\geq 0$\n\n结合这些不等式，我们发现一个通量向量是物理可行的，当且仅当其系数 $\\alpha_1$ 和 $\\alpha_2$ 是非负的。也就是说，$\\alpha_1 \\geq 0$ 且 $\\alpha_2 \\geq 0$。\n因此，所有可行稳态通量向量的集合是基向量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 的所有非负线性组合的集合。这个集合在 $\\mathbb{R}^4$ 中形成一个凸锥。\n\n最后的任务是确定这个可行稳态通量集合的维度。一个凸锥的维度是包含它的最小线性子空间的维度。这等于生成该锥的线性无关向量的数量。生成向量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 是线性无关的，因为它们构成了 $S$ 的二维零空间的一个基。\n因此，可行稳态通量集合的维度是 $2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "2609236"}, {"introduction": "一个成功的代谢工程策略必须考虑到工程遗传构建体在生长细胞群体中的稳定性。本实践问题 [@problem_id:2609190] 将引导您建立一个动态模型，该模型结合了质粒带来的适应性负担和其在细胞分裂时的随机分离。通过推导质粒丢失率，您将对这些因素如何共同作用以从群体中清除合成线路获得定量的理解，这是工业生物技术中的一个关键挑战。", "problem": "一个携带质粒的菌株与其不含质粒的分离体在一个混合均匀的恒化器中进行培养。假设质量作用生长和洗出：每个亚群的变化取决于其比生长速率减去恒化器稀释速率。设质粒在固定底物浓度下，在马尔萨斯（连续时间）意义上施加一个恒定的适应性负担，由选择系数 $s  0$ 表示，因此携带质粒细胞的比生长速率为 $\\mu_{P}=(1+s)\\,\\mu_{F}$，其中 $\\mu_{F}$ 是在相同条件下不含质粒细胞的比生长速率。质粒丢失仅由细胞分裂时的分离不稳定性引起。\n\n假设以下受生物物理学启发的质粒分离机制。每个携带质粒的母细胞在复制起始时拥有受调控的拷贝数 $n$ 个质粒。在分裂之前，这 $n$ 个质粒被复制成 $2n$ 个相同的拷贝。在胞质分裂时，这 $2n$ 个质粒拷贝中的每一个都以 $1/2$ 的概率独立地分配到一个给定的子细胞中。当且仅当所有 $2n$ 个拷贝都分配到另一个子细胞时，一个分裂事件才会产生一个不含质粒的子细胞。使用此模型，从第一性原理推导每次分裂的概率 $\\sigma(n)$，即携带质粒的细胞分裂产生一个不含质粒子细胞的概率。\n\n令 $P(t)$ 和 $F(t)$ 分别表示携带质粒和不含质粒细胞的浓度。写出由以下因素决定的确定性动力学：\n- 具有比速率 $\\mu_{P}$ 和 $\\mu_{F}$ 的质量作用生长；\n- 以稀释速率 $D$ 对两个亚群同样施加的恒化器洗出；\n- 以及由于携带质粒细胞每次分裂时以速率 $\\sigma(n)$ 发生分离而导致的从携带质粒到不含质粒的单向状态转换。\n\n从这些动力学中，推导携带质粒比例 $f(t)=\\frac{P(t)}{P(t)+F(t)}$ 的微分方程，并在 $f(t)\\ll 1$ 的极限下，求出由 $f(t)\\approx f(0)\\,\\exp(-k_{\\text{loss}}\\,t)$ 定义的指数丢失速率常数 $k_{\\text{loss}}$。\n\n假设恒化器在由不含质粒细胞主导的稳态下运行，因此底物是恒定的，$\\mu_{F}$ 不随时间变化，并且稀释速率被设定为与不含质粒细胞的生长速率相匹配，即 $D=\\mu_{F}$。使用以下参数值：\n- 质粒拷贝数 $n=3$，\n- 选择系数 $s=-0.15$，\n- 不含质粒细胞的比生长速率 $\\mu_{F}=0.7\\,\\mathrm{h}^{-1}$。\n\n计算 $k_{\\text{loss}}$ 的数值，单位为 $\\mathrm{h}^{-1}$。将你的答案四舍五入到四位有效数字。以 $\\mathrm{h}^{-1}$ 为单位表示最终的丢失速率常数。", "solution": "问题陈述经过验证。\n\n**步骤 1：提取已知条件**\n- 亚群：携带质粒，$P(t)$，和不含质粒，$F(t)$。\n- 生长模型：每个亚群的质量作用生长。\n- 洗出：以速率 $D$ 进行的恒化器稀释。\n- 适应性负担：选择系数 $s  0$。\n- 比生长速率关系：$\\mu_{P} = (1+s)\\mu_{F}$，其中 $\\mu_P$ 和 $\\mu_F$ 分别是携带质粒和不含质粒细胞的比生长速率。\n- 质粒分离机制：\n    - 母细胞中的初始质粒拷贝数：$n$。\n    - 复制后的拷贝数：$2n$。\n    - 分配：$2n$ 个拷贝中的每一个都以 $1/2$ 的概率分配到一个给定的子细胞。\n    - 分离事件：当且仅当所有 $2n$ 个拷贝都分配到另一个子细胞时，一次分裂才会产生一个不含质粒的子细胞。\n    - 每次分裂的分离概率：$\\sigma(n)$。\n- 种群动力学变量：$P(t)$、$F(t)$ 以及比例 $f(t) = \\frac{P(t)}{P(t)+F(t)}$。\n- 极限行为：对于 $f(t) \\ll 1$，有 $f(t) \\approx f(0)\\exp(-k_{\\text{loss}}t)$。\n- 恒化器操作条件：$D = \\mu_F$。\n- 参数值：\n    - 质粒拷贝数：$n = 3$。\n    - 选择系数：$s = -0.15$。\n    - 不含质粒细胞的比生长速率：$\\mu_F = 0.7 \\, \\mathrm{h}^{-1}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了一个关于恒化器中微生物种群动力学和质粒稳定性的标准且成熟的模型。这些假设在理论微生物生态学和合成生物学领域很常见。该问题提法得当，提供了一组明确的任务、所有必要的定义和足够的数据以得出一个唯一的数值解。语言客观而精确。该问题是自洽且内部一致的。\n\n**步骤 3：结论与行动**\n问题有效。将提供解决方案。\n\n**分离概率 $\\sigma(n)$ 的推导**\n一个携带质粒的母细胞将其 $n$ 个质粒复制成 $2n$ 个拷贝。在分裂时，这 $2n$ 个拷贝被分配到两个子细胞之间。每个质粒拷贝的分配是一个独立事件。对于一个特定的子细胞，接收到任何一个给定质粒拷贝的概率是 $1/2$。当且仅当一个子细胞接收到零个拷贝时，才会产生一个分离体（不含质粒）子细胞。这种情况发生在所有 $2n$ 个质粒拷贝都分离到另一个子细胞中时。\n\n让我们考虑两个子细胞，子细胞 A 和子细胞 B。\n单个质粒拷贝进入子细胞 B 的概率是 $1/2$。\n由于 $2n$ 个质粒独立分配，所有 $2n$ 个拷贝都进入子细胞 B 的概率是 $(1/2)^{2n}$。在这种情况下，子细胞 A 是不含质粒的。\n对称地，所有 $2n$ 个拷贝都进入子细胞 A 的概率是 $(1/2)^{2n}$。在这种情况下，子细胞 B 是不含质粒的。\n这些是互斥事件。问题将 $\\sigma(n)$ 定义为每次分裂产生一个不含质粒子细胞的概率。这个事件对应于所描述的两种结果中的任何一种。\n因此，一次分离性分裂的总概率是这两种结果概率的总和：\n$$ \\sigma(n) = \\left(\\frac{1}{2}\\right)^{2n} + \\left(\\frac{1}{2}\\right)^{2n} = 2 \\times \\left(\\frac{1}{2}\\right)^{2n} = 2 \\times 2^{-2n} = 2^{1-2n} $$\n\n**种群动力学方程**\n令 $P(t)$ 和 $F(t)$ 为携带质粒和不含质粒种群的浓度。其动力学由生长、洗出和分离决定。\n携带质粒种群 $P$ 的变化率由其生长、因洗出造成的损失以及因分离造成的有效损失决定。$P$ 种群的总分裂速率为 $\\mu_P P$。这些分裂中有 $\\sigma(n)$ 的部分是分离性的（P $\\rightarrow$ P + F），即一个亲代 P 细胞产生一个子代 P 细胞和一个子代 F 细胞。剩余的 $1-\\sigma(n)$ 部分是正常分裂（P $\\rightarrow$ P + P）。因此，由细胞分裂引起的 P 种群的净增长率为 $[(1-\\sigma(n))\\times 2 + \\sigma(n)\\times 1 - 1]\\mu_P P = (1-\\sigma(n))\\mu_P P$。\n因此，$P(t)$ 的微分方程为：\n$$ \\frac{dP}{dt} = (1-\\sigma(n))\\mu_P P - D P = (\\mu_P(1-\\sigma(n)) - D) P $$\n不含质粒种群 $F$ 以其自身的速率 $\\mu_F$ 生长，以速率 $D$ 被洗出，并通过 P 细胞的分离性分裂获得新成员。由 P 细胞产生 F 细胞的速率为 $\\sigma(n)\\mu_P P$。\n因此，$F(t)$ 的微分方程为：\n$$ \\frac{dF}{dt} = \\mu_F F + \\sigma(n)\\mu_P P - D F = (\\mu_F - D) F + \\sigma(n)\\mu_P P $$\n\n**携带质粒比例 $f(t)$ 的微分方程**\n携带质粒细胞的比例为 $f(t) = P(t) / N(t)$，其中 $N(t) = P(t) + F(t)$ 是总种群大小。我们使用商法则来求其导数：\n$$ \\frac{df}{dt} = \\frac{1}{N} \\frac{dP}{dt} - \\frac{P}{N^2} \\frac{dN}{dt} $$\n首先，我们求 $\\frac{dN}{dt}$：\n$$ \\frac{dN}{dt} = \\frac{dP}{dt} + \\frac{dF}{dt} = (\\mu_P(1-\\sigma(n)) - D) P + ((\\mu_F - D) F + \\sigma(n)\\mu_P P) $$\n$$ \\frac{dN}{dt} = \\mu_P P - \\sigma(n)\\mu_P P - DP + \\mu_F F - DF + \\sigma(n)\\mu_P P = \\mu_P P + \\mu_F F - D(P+F) $$\n设 $\\bar{\\mu}(f) = f\\mu_P + (1-f)\\mu_F$ 为总种群的平均生长速率。则 $\\frac{dN}{dt} = (\\bar{\\mu}(f) - D)N$。\n代入 $\\frac{df}{dt}$ 的方程中：\n$$ \\frac{df}{dt} = \\frac{1}{N}(\\mu_P(1-\\sigma(n)) - D) P - \\frac{P}{N^2}(\\bar{\\mu}(f) - D) N $$\n$$ \\frac{df}{dt} = (\\mu_P(1-\\sigma(n)) - D)f - (\\bar{\\mu}(f) - D)f $$\n$$ \\frac{df}{dt} = f [ \\mu_P(1-\\sigma(n)) - \\bar{\\mu}(f) ] $$\n代入 $\\bar{\\mu}(f) = f\\mu_P + (1-f)\\mu_F$：\n$$ \\frac{df}{dt} = f [ \\mu_P - \\mu_P\\sigma(n) - (f\\mu_P + (1-f)\\mu_F) ] $$\n$$ \\frac{df}{dt} = f [ \\mu_P - \\mu_P\\sigma(n) - f\\mu_P - \\mu_F + f\\mu_F ] $$\n$$ \\frac{df}{dt} = f [ (\\mu_P - \\mu_F) - \\mu_P\\sigma(n) - f(\\mu_P - \\mu_F) ] $$\n\n**指数丢失速率 $k_{\\text{loss}}$**\n在携带质粒细胞稀少（$f(t) \\ll 1$）的极限下，与 $f^2$ 成正比的项可以忽略。方程简化为：\n$$ \\frac{df}{dt} \\approx f [ (\\mu_P - \\mu_F) - \\mu_P\\sigma(n) ] $$\n这是一个形式为 $\\frac{df}{dt} = -k_{\\text{loss}} f$ 的一阶线性常微分方程，其解为 $f(t) = f(0)\\exp(-k_{\\text{loss}}t)$。通过比较，我们确定丢失速率常数 $k_{\\text{loss}}$ 为：\n$$ k_{\\text{loss}} = -[ (\\mu_P - \\mu_F) - \\mu_P\\sigma(n) ] = (\\mu_F - \\mu_P) + \\mu_P\\sigma(n) $$\n我们已知关系式 $\\mu_P = (1+s)\\mu_F$ 和恒化器条件 $D = \\mu_F$。稀释速率 $D$ 从 $f(t)$ 的方程中消去了，所以这个条件只是确保了一个稳态的背景。代入 $\\mu_P$：\n$$ \\mu_F - \\mu_P = \\mu_F - (1+s)\\mu_F = -s\\mu_F $$\n因此，丢失速率常数的表达式为：\n$$ k_{\\text{loss}} = -s\\mu_F + (1+s)\\mu_F\\sigma(n) = \\mu_F[-s + (1+s)\\sigma(n)] $$\n\n**数值计算**\n给定的参数值为：\n- $n = 3$\n- $s = -0.15$\n- $\\mu_F = 0.7 \\, \\mathrm{h}^{-1}$\n\n首先，我们计算 $n=3$ 时的分离概率 $\\sigma(n)$：\n$$ \\sigma(3) = 2^{1-2(3)} = 2^{1-6} = 2^{-5} = \\frac{1}{32} = 0.03125 $$\n接下来，我们将这些值代入 $k_{\\text{loss}}$ 的表达式中：\n$$ k_{\\text{loss}} = 0.7 \\times [-(-0.15) + (1 + (-0.15)) \\times 0.03125] $$\n$$ k_{\\text{loss}} = 0.7 \\times [0.15 + (0.85) \\times 0.03125] $$\n$$ k_{\\text{loss}} = 0.7 \\times [0.15 + 0.0265625] $$\n$$ k_{\\text{loss}} = 0.7 \\times [0.1765625] $$\n$$ k_{\\text{loss}} = 0.12359375 \\, \\mathrm{h}^{-1} $$\n问题要求将答案四舍五入到四位有效数字。\n$$ k_{\\text{loss}} \\approx 0.1236 \\, \\mathrm{h}^{-1} $$\n$k_{\\text{loss}}$ 的这个正值证实了携带质粒的比例随时间呈指数衰减，这与适应性负担（$s0$）和分离不稳定性（$\\sigma(n)0$）的综合效应所预期的相符。", "answer": "$$\\boxed{0.1236}$$", "id": "2609190"}, {"introduction": "测量遗传线路的输出并非总是直接了当，因为荧光蛋白等报告基因自身具有成熟和降解的动力学过程。本计算练习 [@problem_id:2609196] 旨在解决一个逆问题：从观测到的荧光信号中推断出真实的潜在基因表达速率。通过实现一个基于状态空间模型的去卷积算法，您将掌握一项校正实验数据并更准确地了解系统性能的实用技能。", "problem": "考虑一个用于监测生长细胞群中基因表达的荧光蛋白报告基因。其潜在的蛋白质合成速率是一个非负的时变函数 $s(t)$，单位为分子/细胞/小时。荧光仅由成熟形式的报告基因产生。假设以下标准的、在时间 $t=0$ 时初始条件为零的一阶成熟和稀释模型：\n$$\n\\frac{dM}{dt} = s(t) - (k_m + k_d) M(t),\n$$\n$$\n\\frac{dP}{dt} = k_m M(t) - k_d P(t),\n$$\n$$\nF(t) = c\\,P(t),\n$$\n其中 $M(t)$ 是未成熟的非荧光报告基因，$P(t)$ 是成熟的荧光报告基因，$F(t)$ 是以任意单位计量的测量荧光，$k_m$ 是以 $\\mathrm{h}^{-1}$ 为单位的成熟速率，$k_d$ 是以 $\\mathrm{h}^{-1}$ 为单位的有效一阶损失速率（主要由生长引起的稀释主导，降解可忽略不计），$c$ 是以任意单位/分子为单位的荧光校准因子。这些常微分方程编码了质量平衡和一级动力学，是生物化学动力学和合成生物学中公认的报告基因动力学基础。\n\n要求您基于这些定律，通过有原则的解卷积方法，从荧光动力学推断出潜在的合成速率曲线。按以下步骤进行。\n\n1. 时间离散化与输入模型。将时间离散为宽度为 $\\Delta t$（单位为小时）的均匀步长，并采用零阶保持器（ZOH）假设，即将 $s(t)$ 在区间 $[n\\Delta t,(n+1)\\Delta t)$（对于整数 $n \\ge 0$）上近似为分段常数值 $r_n$。令 $x(t) = [M(t)\\;P(t)]^\\top$，并写出连续时间线性时不变状态空间模型\n$$\n\\frac{dx}{dt} = A x(t) + B s(t), \\quad y(t) = C x(t),\n$$\n其中\n$$\nA = \\begin{bmatrix}-(k_m+k_d)  0 \\\\ k_m  -k_d \\end{bmatrix}, \\quad\nB = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad\nC = \\begin{bmatrix} 0  1 \\end{bmatrix}.\n$$\n在步长为 $\\Delta t$ 的ZOH假设下，推导出精确的离散时间模型\n$$\nx_{n+1} = \\Phi x_n + \\Gamma r_n, \\quad y_n = C x_n, \\quad F_n = c\\, y_n,\n$$\n其中 $\\Phi = e^{A \\Delta t}$ 且 $\\Gamma = \\int_{0}^{\\Delta t} e^{A \\tau} B \\, d\\tau$。使用此模型作为基本正向模型，从给定的速率序列 $r$ 生成荧光，并构建从 $r$ 到 $y$ 的线性映射。\n\n2. 推断目标。给定由某个未知的非负速率序列 $r_n$ 生成的荧光序列 $F_n$，通过求解以下非负Tikhonov正则化最小二乘问题来推断 $r$：\n$$\n\\min_{r \\ge 0} \\;\\; \\| H r - y \\|_2^2 \\;+\\; \\lambda \\| D r \\|_2^2,\n$$\n其中 $y_n = F_n / c$ 是成熟报告基因的值，$H$ 是由 $(\\Phi,\\Gamma,C)$ 系统在ZOH下的离散脉冲响应导出的下三角托普利兹卷积矩阵，$D$ 是一阶差分算子 $(Dr)_n = r_{n+1}-r_n$，$\\lambda$ 是一个非负的正则化权重。通过增广线性系统来实现这一点：\n$$\n\\begin{bmatrix} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} r \\approx \\begin{bmatrix} y \\\\ 0 \\end{bmatrix},\n$$\n并求解得到的非负最小二乘问题。\n\n3. 测试套件与所需输出。对于以下三种情况中的每一种，您必须：\n   - 定义时间网格 $t_n = n\\Delta t$，其中 $n=0,1,\\dots,N-1$，样本数 $N = \\lfloor T_{\\text{end}}/\\Delta t \\rfloor$。\n   - 指定一个真实值 $r_{\\text{true}}(t)$（单位为分子/细胞/小时），并在ZOH下对其进行采样，以获得 $r_{\\text{true},n} = r_{\\text{true}}(t)$，其中 $t \\in [n\\Delta t,(n+1)\\Delta t)$。\n   - 通过模拟初始条件为零的离散时间模型来生成 $F_n$。\n   - 使用上述方法从 $F_n$ 推断出 $\\hat r_n$，其中所有测试共享一个固定的 $\\lambda$。\n   - 计算均方根误差\n     $$\n     \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\hat r_n - r_{\\text{true},n}\\right)^2}.\n     $$\n     将此数值报告为浮点值，单位为分子/细胞/小时。\n\n使用以下参数集和曲线；除非另有说明，所有速率单位均为分子/细胞/小时：\n- 情况A（中等成熟速率的高斯脉冲）：\n  - $\\Delta t = 0.05$, $T_{\\text{end}} = 6.0$, $k_m = 1.0$, $k_d = 0.1$, $c = 100.0$,\n  - $r_{\\text{true}}(t) = A \\exp\\left(-\\frac{(t - \\mu)^2}{2\\sigma^2}\\right)$，其中 $A = 500.0$, $\\mu = 2.0$, $\\sigma = 0.3$。\n- 情况B（缓慢成熟速率的持续阶跃）：\n  - $\\Delta t = 0.05$, $T_{\\text{end}} = 6.0$, $k_m = 0.2$, $k_d = 0.1$, $c = 80.0$,\n  - $r_{\\text{true}}(t) = A$ 当 $t \\in [t_{\\text{on}}, t_{\\text{off}})$ 时，否则 $r_{\\text{true}}(t) = 0$，其中 $A = 200.0$, $t_{\\text{on}} = 1.0$, $t_{\\text{off}} = 4.0$。\n- 情况C（极快成熟速率和可忽略稀释的短脉冲）：\n  - $\\Delta t = 0.02$, $T_{\\text{end}} = 3.0$, $k_m = 5.0$, $k_d = 0.0$, $c = 120.0$,\n  - $r_{\\text{true}}(t) = A \\exp\\left(-\\frac{(t - \\mu)^2}{2\\sigma^2}\\right)$，其中 $A = 1000.0$, $\\mu = 1.0$, $\\sigma = 0.05$。\n\n所有情况下，Tikhonov权重均取 $\\lambda = 1.0 \\times 10^{-4}$。所有时间量均以小时为单位。\n\n您的程序必须：\n- 通过矩阵指数为ZOH模型实现精确的离散时间 $(\\Phi,\\Gamma)$。\n- 构建与用于生成荧光的正向模拟一致的脉冲响应和托普利兹矩阵 $H$。\n- 求解增广的非负最小二乘问题以推断 $r$。\n- 计算每种情况下的 $\\mathrm{RMSE}$（单位为分子/细胞/小时），并四舍五入到六位小数。\n\n最终输出格式。您的程序应生成单行输出，包含情况A、B和C的三个 $\\mathrm{RMSE}$ 值，格式为逗号分隔的列表，并用方括号括起来，例如 $[\\alpha,\\beta,\\gamma]$。您输出的数值单位必须是分子/细胞/小时，并四舍五入到六位小数，不得打印任何附加文本。", "solution": "所呈现的问题陈述定义严谨且科学有效。它建立在生物化学动力学和线性系统理论的基本原理之上，这些都是合成生物学领域的标准方法。所有参数、初始条件和目标都已足够清晰和精确地指定，从而允许一个唯一且可验证的解。不存在矛盾、歧义或科学不准确之处。因此，该问题被认为是有效的，我将着手解决它。\n\n任务是从荧光报告基因的测量值中推断出时变的蛋白质合成速率 $s(t)$，这一过程称为解卷积。问题分为三个部分：模型离散化、逆问题的构建以及针对特定测试用例的数值实现。\n\n首先，我们对连续时间状态空间模型进行离散化。该模型由下式给出\n$$ \\frac{dx}{dt} = A x(t) + B s(t), \\quad y(t) = C x(t) $$\n状态为 $x(t) = [M(t)\\;P(t)]^\\top$，矩阵为\n$$ A = \\begin{bmatrix}-(k_m+k_d)  0 \\\\ k_m  -k_d \\end{bmatrix}, \\quad B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 0  1 \\end{bmatrix} $$\n我们以步长 $\\Delta t$ 对时间进行离散化，并假设合成速率 $s(t)$ 是分段常数，即 $s(t) = r_n$ 对于 $t \\in [n\\Delta t, (n+1)\\Delta t)$。这是零阶保持器（ZOH）假设。状态方程在一个区间上的精确解给出了离散时间模型：\n$$ x_{n+1} = \\Phi x_n + \\Gamma r_n, \\quad y_n = C x_n $$\n其中 $x_n = x(n\\Delta t)$ 且 $y_n = y(n\\Delta t)$。状态转移矩阵 $\\Phi$ 和输入矩阵 $\\Gamma$ 由下式给出\n$$ \\Phi = e^{A \\Delta t}, \\quad \\Gamma = \\int_{0}^{\\Delta t} e^{A \\tau} B \\, d\\tau $$\n一个能同时计算这两个矩阵的稳健方法是使用一个增广矩阵的矩阵指数：\n$$ \\begin{bmatrix} \\Phi  \\Gamma \\\\ 0  I \\end{bmatrix} = \\exp\\left( \\begin{bmatrix} A  B \\\\ 0  0 \\end{bmatrix} \\Delta t \\right) $$\n其中右侧的块矩阵大小为 $3 \\times 3$。这种方法数值稳定，并能正确处理如 $k_d=0$ 等特殊情况。\n\n其次，我们构建推断问题。在初始条件为零（$x_0 = [0\\;0]^\\top$）的情况下，时间 $n\\Delta t$ 的状态是离散时间卷积的结果：\n$$ x_n = \\sum_{k=0}^{n-1} \\Phi^{n-1-k} \\Gamma r_k $$\n相应的输出为 $y_n = C x_n$。这种线性关系可以写成矩阵形式 $y = H r$，其中 $y = [y_0, y_1, \\dots, y_{N-1}]^\\top$，$r = [r_0, r_1, \\dots, r_{N-1}]^\\top$，$H$ 是一个下三角托普利兹矩阵。$H$ 的第一列是系统的脉冲响应 $h = [h_0, h_1, \\dots, h_{N-1}]^\\top$，其中 $h_0 = 0$ 且 $h_n = C \\Phi^{n-1} \\Gamma$（对于 $n \\ge 1$）。\n\n解卷积是一个不适定问题，通常对噪声和模型失配很敏感。我们采用Tikhonov正则化来寻找一个稳定且具有物理意义的解。我们寻求最小化一个复合目标函数，该函数平衡了数据保真度和平滑度：\n$$ \\min_{r \\ge 0} \\;\\; \\| H r - y \\|_2^2 \\;+\\; \\lambda \\| D r \\|_2^2 $$\n施加非负约束 $r \\ge 0$ 是因为合成速率不能为负。项 $\\| H r - y \\|_2^2$ 是模型预测与测量数据 $y_n = F_n / c$ 之间的平方误差。项 $\\lambda \\| D r \\|_2^2$ 是一个正则化惩罚项，其中 $D$ 是一阶差分算子 $(Dr)_n = r_{n+1}-r_n$，$\\lambda$ 是正则化权重。这个惩罚项不鼓励推断出的速率 $r$ 出现剧烈波动。\n\n通过增广方程组，该优化问题等效于一个标准的非负最小二乘（NNLS）问题：\n$$ \\min_{r \\ge 0} \\left\\| \\begin{bmatrix} H \\\\ \\sqrt{\\lambda}\\, D \\end{bmatrix} r - \\begin{bmatrix} y \\\\ 0 \\end{bmatrix} \\right\\|_2^2 $$\n这个增广问题可以使用标准的数值线性代数库高效求解。\n\n对于每个测试用例，我们执行以下步骤：\n1.  定义大小为 $N = \\lfloor T_{\\text{end}}/\\Delta t \\rfloor$ 的时间网格，并采样指定的真实合成速率 $r_{\\text{true},n}$。\n2.  使用增广矩阵指数法计算离散时间矩阵 $\\Phi$ 和 $\\Gamma$。\n3.  用 $x_0=0$ 模拟正向模型 $x_{n+1} = \\Phi x_n + \\Gamma r_{\\text{true},n}$，以生成无噪声的报告基因数据序列 $y_n = C x_n$。\n4.  根据系统的脉冲响应构建卷积矩阵 $H$ 和一阶差分矩阵 $D$。\n5.  建立增广系统，并使用NNLS求解器求解估计速率 $\\hat r$。\n6.  最后，计算推断速率 $\\hat r$ 与真实值 $r_{\\text{true}}$ 之间的均方根误差（RMSE），以量化解卷积的准确性：\n    $$ \\mathrm{RMSE} = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\hat r_n - r_{\\text{true},n}\\right)^2} $$\n以下代码实现了此过程，以计算三种指定情况下的RMSE。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm, toeplitz\nfrom scipy.optimize import nnls\n\ndef solve_case(params):\n    \"\"\"\n    Solves a single deconvolution case.\n    \n    1. Generates ground-truth synthesis rate and corresponding fluorescence data.\n    2. Constructs the matrices for the regularized inverse problem.\n    3. Solves the nonnegative least-squares problem to infer the synthesis rate.\n    4. Computes the RMSE between the true and inferred rates.\n    \"\"\"\n    # Unpack parameters and define the time grid\n    dt = params['dt']\n    Tend = params['Tend']\n    km = params['km']\n    kd = params['kd']\n    lambda_val = params['lambda']\n\n    N = int(np.floor(Tend / dt))\n    t_grid = np.arange(N) * dt\n\n    # Generate the ground-truth synthesis rate r_true\n    r_true_func = params['r_true_func']\n    r_true_params = params['r_true_params']\n    r_true = r_true_func(t_grid, r_true_params)\n\n    # Derive discrete-time matrices Phi and Gamma using the augmented matrix exponential\n    A = np.array([[-(km + kd), 0], [km, -kd]])\n    B = np.array([[1], [0]])\n    \n    aug_matrix = np.zeros((3, 3))\n    aug_matrix[0:2, 0:2] = A\n    aug_matrix[0:2, 2] = B.flatten()\n    \n    exp_aug_matrix = expm(aug_matrix * dt)\n    \n    Phi = exp_aug_matrix[0:2, 0:2]\n    Gamma = exp_aug_matrix[0:2, 2].reshape(2, 1)\n\n    # Generate the \"measured\" data y = F/c via forward simulation\n    C = np.array([[0, 1]])\n    x_hist = np.zeros((2, N + 1))  # State history from x_0 to x_N\n    \n    for n in range(N):\n        x_hist[:, n + 1] = Phi @ x_hist[:, n] + Gamma.flatten() * r_true[n]\n    \n    # y_n = C * x_n for n=0,...,N-1\n    y_data = (C @ x_hist[:, 0:N]).flatten()\n\n    # Construct matrices for the inverse problem\n    #\n    # 1. Impulse response h_n\n    h = np.zeros(N)\n    x_impulse = Gamma  # This is x_1 for an impulse input r_0=1\n    if N > 1:\n        h[1] = (C @ x_impulse).item()\n    for n in range(2, N):\n        x_impulse = Phi @ x_impulse  # x_impulse becomes Phi^(n-1)*Gamma\n        h[n] = (C @ x_impulse).item()\n\n    # 2. Toeplitz convolution matrix H\n    H = toeplitz(h, np.zeros(N))\n\n    # 3. First-difference operator D\n    D = np.eye(N, k=1) - np.eye(N)\n    D = D[:-1, :]  # Final size is (N-1) x N\n\n    # Set up and solve the augmented nonnegative least-squares problem\n    H_aug = np.vstack([H, np.sqrt(lambda_val) * D])\n    y_aug = np.concatenate([y_data, np.zeros(N - 1)])\n\n    r_hat, _ = nnls(H_aug, y_aug)\n\n    # Compute the Root-Mean-Square Error (RMSE)\n    rmse = np.sqrt(np.mean((r_hat - r_true)**2))\n    return rmse\n\n\ndef r_gaussian(t, p):\n    \"\"\"Defines a Gaussian pulse for the synthesis rate.\"\"\"\n    return p['A'] * np.exp(-((t - p['mu'])**2) / (2 * p['sigma']**2))\n\ndef r_step(t, p):\n    \"\"\"Defines a step function for the synthesis rate.\"\"\"\n    return p['A'] * ((t >= p['t_on'])  (t  p['t_off']))\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'name': 'A', 'dt': 0.05, 'Tend': 6.0, 'km': 1.0, 'kd': 0.1, 'c': 100.0,\n            'r_true_func': r_gaussian,\n            'r_true_params': {'A': 500.0, 'mu': 2.0, 'sigma': 0.3}\n        },\n        {\n            'name': 'B', 'dt': 0.05, 'Tend': 6.0, 'km': 0.2, 'kd': 0.1, 'c': 80.0,\n            'r_true_func': r_step,\n            'r_true_params': {'A': 200.0, 't_on': 1.0, 't_off': 4.0}\n        },\n        {\n            'name': 'C', 'dt': 0.02, 'Tend': 3.0, 'km': 5.0, 'kd': 0.0, 'c': 120.0,\n            'r_true_func': r_gaussian,\n            'r_true_params': {'A': 1000.0, 'mu': 1.0, 'sigma': 0.05}\n        }\n    ]\n\n    lambda_val = 1.0e-4\n    results = []\n    \n    for case in test_cases:\n        case['lambda'] = lambda_val\n        rmse = solve_case(case)\n        # Format the result to six decimal places as required.\n        results.append(f\"{rmse:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2609196"}]}