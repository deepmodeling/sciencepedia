{"hands_on_practices": [{"introduction": "DNA双螺旋的稳定性是其生物学功能和生物技术应用的核心。紫外吸收光谱法是监测其热变性（或“熔解”）过程的主要实验工具。当双螺旋解链时，碱基堆积作用减弱，导致其在260 nm处的紫外吸光度增加，这一现象被称为“增色效应”。这项练习 [@problem_id:2557099] 让你亲手实践如何将比尔-朗伯定律应用于一个真实的生物物理系统，它要求你将核苷酸组成、浓度和DNA的物理状态（双链与单链）与一个可测量的实验信号定量地联系起来，从而增强你的定量分析能力。", "problem": "通过退火两条长度均为 $20$ 个核苷酸的互补单链寡脱氧核糖核苷酸，制备了一个长度为 $20$ 个碱基对的人工合成脱氧核糖核苷酸（DNA）双链体。在室温下的双螺旋状态下，由于碱基堆积（减色效应），$260$ nm 处的紫外（UV）吸光度会降低；当在总寡聚物浓度相同的情况下完全热变性（解链）成两条无相互作用的无规卷曲单链时，$260$ nm 处的吸光度相对于双链体基线增加，其平均分数增色效应为 $0.30$。\n\n给出在单链状态下，四种脱氧核糖核苷酸在 $260$ nm 处的摩尔消光系数（单位为 $\\mathrm{M^{-1}\\,cm^{-1}}$）如下：$\\varepsilon_{\\mathrm{dA}} = 15400$，$\\varepsilon_{\\mathrm{dG}} = 11500$，$\\varepsilon_{\\mathrm{dC}} = 7400$，$\\varepsilon_{\\mathrm{dT}} = 8700$。假设比尔-朗伯定律 $A = \\varepsilon\\,c\\,\\ell$ 适用，其中 $A$ 是吸光度（无量纲），$\\varepsilon$ 是相应的摩尔消光系数，$c$ 是摩尔浓度，$\\ell$ 是以 cm 为单位的光程。同时假设对于单链状态，总摩尔消光系数等于链上各核苷酸贡献的总和。\n\n两条链在组成上是平衡的：每条 $20$ 核苷酸链（$20$-mer）都精确含有 $5$ 个腺嘌呤、$5$ 个胸腺嘧啶、$5$ 个鸟嘌呤和 $5$ 个胞嘧啶。将一份含有该双链体的溶液（双链体分子浓度为 $2.00 \\times 10^{-6}$ $\\mathrm{M}$）置于光程为 $\\ell = 1.000$ cm 的比色皿中，在 $260$ nm 处进行测量。\n\n从比尔-朗伯定律以及给定的定义和事实出发，并明确考虑通过所述增色效应所描述的双链和单链消光系数之间的关系，计算在总寡聚物浓度和光程不变的情况下，完全解链后在 $260$ nm 处的预期吸光度变化 $\\Delta A = A_{\\mathrm{ss}} - A_{\\mathrm{ds}}$。将您的最终数值结果四舍五入至四位有效数字。以纯数形式表示您的答案（吸光度是无量纲的）。", "solution": "所述问题具有科学依据，提法明确且客观。它基于生物物理化学的既定原理，即比尔-朗伯定律和 DNA 变性过程中观察到的增色效应。求解所需的所有数据和条件均已提供。因此，我们开始进行求解。\n\n目标是计算 DNA 双链体完全热变性后的吸光度变化量 $\\Delta A$。该量定义为：\n$$\n\\Delta A = A_{\\mathrm{ss}} - A_{\\mathrm{ds}}\n$$\n其中 $A_{\\mathrm{ss}}$ 是含有单链 DNA 溶液的吸光度，而 $A_{\\mathrm{ds}}$ 是含有双链 DNA 双链体溶液的吸光度。\n\n问题给出了分数增色效应 $H$，即相对于双链体基线的吸光度分数增加量。其数学表达式为：\n$$\nH = \\frac{A_{\\mathrm{ss}} - A_{\\mathrm{ds}}}{A_{\\mathrm{ds}}} = \\frac{\\Delta A}{A_{\\mathrm{ds}}}\n$$\n根据这个关系，我们可以写出 $A_{\\mathrm{ds}} = \\Delta A / H$。将此代入 $\\Delta A$ 的定义中：\n$$\n\\Delta A = A_{\\mathrm{ss}} - \\frac{\\Delta A}{H}\n$$\n重新整理此方程以求解 $\\Delta A$ 可得：\n$$\n\\Delta A \\left(1 + \\frac{1}{H}\\right) = A_{\\mathrm{ss}}\n$$\n$$\n\\Delta A \\left(\\frac{H+1}{H}\\right) = A_{\\mathrm{ss}}\n$$\n$$\n\\Delta A = A_{\\mathrm{ss}} \\left(\\frac{H}{H+1}\\right)\n$$\n给定 $H$ 的值为 $0.30$。问题现在简化为求完全变性后样品的吸光度 $A_{\\mathrm{ss}}$。\n\n吸光度 $A_{\\mathrm{ss}}$ 由比尔-朗伯定律确定：\n$$\nA_{\\mathrm{ss}} = \\varepsilon_{\\mathrm{strand}} c_{\\mathrm{strand}} \\ell\n$$\n其中 $\\varepsilon_{\\mathrm{strand}}$ 是一条单链的摩尔消光系数，$c_{\\mathrm{strand}}$ 是单链的摩尔浓度，$\\ell$ 是光程。\n\n首先，我们计算一条 $20$ 核苷酸单链的摩尔消光系数 $\\varepsilon_{\\mathrm{strand}}$。该链由 $5$ 个脱氧腺苷（dA）、$5$ 个脱氧鸟苷（dG）、$5$ 个脱氧胞苷（dC）和 $5$ 个脱氧胸苷（dT）组成。基于总摩尔消光系数是各核苷酸贡献之和的假设，我们有：\n$$\n\\varepsilon_{\\mathrm{strand}} = 5 \\cdot \\varepsilon_{\\mathrm{dA}} + 5 \\cdot \\varepsilon_{\\mathrm{dG}} + 5 \\cdot \\varepsilon_{\\mathrm{dC}} + 5 \\cdot \\varepsilon_{\\mathrm{dT}}\n$$\n使用所提供的值（$\\varepsilon_{\\mathrm{dA}} = 15400 \\ \\mathrm{M^{-1}\\,cm^{-1}}$，$\\varepsilon_{\\mathrm{dG}} = 11500 \\ \\mathrm{M^{-1}\\,cm^{-1}}$，$\\varepsilon_{\\mathrm{dC}} = 7400 \\ \\mathrm{M^{-1}\\,cm^{-1}}$，$\\varepsilon_{\\mathrm{dT}} = 8700 \\ \\mathrm{M^{-1}\\,cm^{-1}}$）：\n$$\n\\varepsilon_{\\mathrm{strand}} = 5 \\cdot (15400 + 11500 + 7400 + 8700) \\ \\mathrm{M^{-1}\\,cm^{-1}}\n$$\n$$\n\\varepsilon_{\\mathrm{strand}} = 5 \\cdot (43000) \\ \\mathrm{M^{-1}\\,cm^{-1}} = 215000 \\ \\mathrm{M^{-1}\\,cm^{-1}}\n$$\n\n接下来，我们确定单链的摩尔浓度 $c_{\\mathrm{strand}}$。变性过程是一个双链体分子解离成两个单链分子的过程：$1 \\ \\text{duplex} \\rightarrow 2 \\ \\text{strands}$。因此，完全解链后单链的浓度是初始双链体浓度的两倍。\n给定初始双链体浓度 $c_{\\mathrm{ds}} = 2.00 \\times 10^{-6} \\ \\mathrm{M}$：\n$$\nc_{\\mathrm{strand}} = 2 \\cdot c_{\\mathrm{ds}} = 2 \\cdot (2.00 \\times 10^{-6} \\ \\mathrm{M}) = 4.00 \\times 10^{-6} \\ \\mathrm{M}\n$$\n“在总寡聚物浓度相同的情况下”这一陈述意味着比色皿中核苷酸物质的总量是恒定的，这与此化学计量关系一致。\n\n现在我们可以使用比尔-朗伯定律，在光程为 $\\ell = 1.000 \\ \\mathrm{cm}$ 的条件下计算 $A_{\\mathrm{ss}}$：\n$$\nA_{\\mathrm{ss}} = (215000 \\ \\mathrm{M^{-1}\\,cm^{-1}}) \\cdot (4.00 \\times 10^{-6} \\ \\mathrm{M}) \\cdot (1.000 \\ \\mathrm{cm})\n$$\n$$\nA_{\\mathrm{ss}} = 0.860\n$$\n\n最后，我们将 $A_{\\mathrm{ss}}$ 和 $H$ 的值代入我们推导出的 $\\Delta A$ 表达式中：\n$$\n\\Delta A = A_{\\mathrm{ss}} \\left(\\frac{H}{H+1}\\right) = 0.860 \\left(\\frac{0.30}{1 + 0.30}\\right)\n$$\n$$\n\\Delta A = 0.860 \\left(\\frac{0.30}{1.30}\\right) = 0.860 \\cdot \\frac{3}{13}\n$$\n$$\n\\Delta A \\approx 0.198461538...\n$$\n题目要求结果四舍五入到四位有效数字。\n$$\n\\Delta A \\approx 0.1985\n$$\n这表示当 DNA 双链体溶液完全解链时，在 $260 \\ \\mathrm{nm}$ 处吸光度的总增加量。", "answer": "$$\n\\boxed{0.1985}\n$$", "id": "2557099"}, {"introduction": "DNA双链的熔解过程是理解其稳定性的关键，而从实验熔解曲线中提取热力学参数是生物物理化学中的一项基本技能。对于非自身互补的双链体而言，其熔解温度（$T_m$）依赖于寡核苷酸的浓度，这是双分子反应的典型特征。在这项练习 [@problem_id:2557043] 中，你将从化学平衡和热力学的基本原理出发，推导熔解温度的倒数（$1/T_m$）与总链浓度的对数（$\\ln C_t$）之间的线性关系，并确定其斜率与双链形成的标准焓变（$\\Delta H^{\\circ}$）的联系。这个过程不仅能巩固你对化学平衡和范特霍夫方程的理解，还展示了如何通过实验设计和数据分析来揭示稳定核酸结构的热力学驱动力。", "problem": "一个非自互补的脱氧核糖核酸（DNA）双链体是通过将两条不同的互补链（表示为 $S$ 和 $S'$）以等摩尔量在总单链浓度为 $C_t$（$[S]$ 和 $[S']$ 的总和）的条件下杂交而形成的。假设一个双态转变 $S + S' \\rightleftharpoons D$，其结合反应的标准热力学参数为 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$，压力恒定，离子强度固定，因此 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$ 在转变范围内不随温度变化。解链温度 $T_m$ 定义为所有链中有一半以碱基配对形式存在于双链体中的温度。\n\n仅从 (i) 平衡常数 $K = \\dfrac{[D]}{[S][S']}$ 的质量作用定律，(ii) 解链中点的质量平衡，以及 (iii) 范特霍夫关系式 $\\dfrac{d \\ln K}{d(1/T)} = -\\dfrac{\\Delta H^{\\circ}}{R}$ 出发，推导这种双分子双链体形成过程中 $1/T_m$ 与 $\\ln C_t$ 之间的线性关系。用 $\\Delta H^{\\circ}$ 表示其斜率。\n\n实验上，对 $1/T_m$（单位为 $\\mathrm{K}^{-1}$）与 $\\ln C_t$（其中 $C_t$ 单位为 $\\mathrm{M}$）进行线性回归，得到斜率 $m = -\\,2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$。使用你推导出的关系，计算双链体形成的标准范特霍夫焓变 $\\Delta H^{\\circ}$。以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位表示最终值，包括适当的符号，并将你的答案四舍五入到 $3$ 位有效数字。", "solution": "所述问题具有科学依据、内容自洽且提法明确。它基于化学热力学的基本原理及其在核酸生物物理化学中的应用。该问题是有效的，并且可以进行严格求解。\n\n问题要求推导非自互补DNA双链体形成过程中，解链温度的倒数 $1/T_m$ 与总链浓度的自然对数 $\\ln C_t$ 之间的线性关系。然后要求根据实验数据计算标准焓变 $\\Delta H^{\\circ}$。\n\n两条不同的互补链 $S$ 和 $S'$ 结合形成双链体 $D$ 的反应由以下平衡式给出：\n$$S + S' \\rightleftharpoons D$$\n此结合反应的平衡常数 $K$ 由质量作用定律定义为：\n$$K = \\frac{[D]}{[S][S']}$$\n其中 $[S]$、$[S']$ 和 $[D]$ 分别是平衡时单链和双链体的摩尔浓度。\n\n每种链的总浓度由质量平衡定义。由于链是以等摩尔量加入的，每种链的初始总浓度为 $C_t/2$。因此：\n$$[S]_{total} = [S] + [D] = \\frac{C_t}{2}$$\n$$[S']_{total} = [S'] + [D] = \\frac{C_t}{2}$$\n从这两个方程可以清楚地看出，在平衡的任何时刻，游离单链的浓度都相等：$[S] = [S']$。\n\n解链温度 $T_m$ 定义为总链数的一半结合成双链体时的温度。作为单体单元考虑，链的总浓度为 $C_t$。双链体内的链浓度为 $2[D]$。在 $T = T_m$ 时，处于双链体形式的链的分数为 $1/2$。\n$$\\frac{2[D]}{C_t} = \\frac{1}{2}$$\n根据这个条件，解链温度下双链体的浓度为：\n$$[D] = \\frac{C_t}{4}$$\n现在我们可以使用质量平衡方程确定在 $T = T_m$ 时游离单链的浓度：\n$$[S] = [S]_{total} - [D] = \\frac{C_t}{2} - \\frac{C_t}{4} = \\frac{C_t}{4}$$\n并且由于 $[S] = [S']$：\n$$[S'] = \\frac{C_t}{4}$$\n现在，我们可以用总浓度 $C_t$ 来表示解链温度下的平衡常数 $K(T_m)$：\n$$K(T_m) = \\frac{[D]}{[S][S']} = \\frac{C_t/4}{(C_t/4)(C_t/4)} = \\frac{1}{C_t/4} = \\frac{4}{C_t}$$\n该方程建立了平衡常数与总链浓度之间的关系，此关系仅在对应于该浓度的解链温度 $T_m$ 下有效。\n\n为了将 $T_m$ 与 $C_t$ 联系起来，我们使用范特霍夫关系式。假设 $\\Delta H^{\\circ}$ 和 $\\Delta S^{\\circ}$ 是常数，范特霍夫方程的积分形式将平衡常数 $K$ 与温度 $T$ 联系起来：\n$$\\ln K = -\\frac{\\Delta H^{\\circ}}{RT} + \\frac{\\Delta S^{\\circ}}{R}$$\n该方程在任何温度下都成立，包括 $T_m$。题目要求从微分形式开始，即：\n$$\\frac{d \\ln K}{d(1/T)} = -\\frac{\\Delta H^{\\circ}}{R}$$\n我们已经确定，在解链温度下，$K(T_m) = 4/C_t$。取自然对数得到：\n$$\\ln K(T_m) = \\ln(4) - \\ln(C_t)$$\n由于 $T_m$ 是 $C_t$ 的函数，我们可以对这个表达式进行微分。让我们考虑 $C_t$ 的无穷小变化以及 $T_m$ 的相应变化。对 $\\ln K(T_m)$ 的表达式进行微分得到：\n$$d(\\ln K) = -d(\\ln C_t)$$\n根据范特霍夫方程，温度的无穷小变化 $d(1/T_m)$ 对应于平衡常数的变化 $d(\\ln K)$ 如下：\n$$d(\\ln K) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\n将 $d(\\ln K)$ 的两个表达式相等：\n$$-d(\\ln C_t) = -\\frac{\\Delta H^{\\circ}}{R} d(1/T_m)$$\n整理这个微分方程，得到 $1/T_m$ 对 $\\ln C_t$ 的导数：\n$$\\frac{d(1/T_m)}{d(\\ln C_t)} = \\frac{R}{\\Delta H^{\\circ}}$$\n这个结果表明，$1/T_m$ 对 $\\ln C_t$ 的图像是一条直线，其斜率 $m$ 由下式给出：\n$$m = \\frac{R}{\\Delta H^{\\circ}}$$\n这就是推导出的线性关系和斜率的确定。\n\n问题的第二部分要求使用实验测定的斜率 $m = -2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}$ 计算 $\\Delta H^{\\circ}$。理想气体常数 $R = 8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n从斜率表达式中，我们求解 $\\Delta H^{\\circ}$：\n$$\\Delta H^{\\circ} = \\frac{R}{m}$$\n代入给定值：\n$$\\Delta H^{\\circ} = \\frac{8.314\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}}{-2.00 \\times 10^{-5}\\ \\mathrm{K}^{-1}}$$\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}}$$\n结果是负值，这是预料之中的，因为双链体的形成是一个放热过程，由氢键的形成和碱基堆积相互作用驱动。\n题目要求答案以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位，并四舍五入到3位有效数字。\n$$\\Delta H^{\\circ} = -415700\\ \\mathrm{J\\ mol^{-1}} \\times \\frac{1\\ \\mathrm{kJ}}{1000\\ \\mathrm{J}} = -415.7\\ \\mathrm{kJ\\ mol^{-1}}$$\n四舍五入到三位有效数字，我们得到：\n$$\\Delta H^{\\circ} \\approx -416\\ \\mathrm{kJ\\ mol^{-1}}$$\n这样就完成了所需的计算。", "answer": "$$ \\boxed{-416} $$", "id": "2557043"}, {"introduction": "DNA碱基对的开闭动态是其生物学功能的基础，而亚氨基质子交换实验是探测这些动态的关键手段。马尔可夫状态模型 (MSM) 是一个强大的理论框架，能够将原子级模拟得到的微观状态动力学与宏观实验速率联系起来。本练习要求你应用 MSM 和林德斯特伦-朗交换机制的第一性原理，为一个给定的 DNA 碱基对多状态动力学模型，计算其宏观构象布居和可观测的质子交换速率。通过这个计算实践，你将深入理解如何从一个详细的微观动力学模型出发，通过系统性的粗粒化，定量预测实验可观测量，从而掌握连接理论模型与实验数据的核心技能。", "problem": "给定一组物理上合理的马尔可夫状态模型 (MSM) 规范，这些规范代表单个脱氧核糖核酸 (DNA) 碱基对的分子动力学 (MD) 粗粒化微观态，它可以在闭合和开放构象之间相互转换。开放构象将亚氨基质子暴露于溶剂中，从而实现交换。您的任务是使用马尔可夫过程的第一性原理和 Linderstrøm–Lang 两步交换机制，为每个 MSM 计算开放宏观态的平衡布居和预测的亚氨基质子交换速率。所有要求的输出均为无量纲或按指定的以秒分之一为单位，最终程序必须输出一行包含所有测试用例结果。\n\n将使用的基本原理和定义：\n- 延迟时间为 $\\tau$ 的离散时间 MSM 由一个行随机转移矩阵 $T(\\tau)$ 定义，该矩阵通过 $T(\\tau) = \\exp(\\tau K)$ 从一个连续时间生成元（速率）矩阵 $K$ 获得，其中 $\\exp$ 表示矩阵指数。生成元 $K$ 的非对角元素 $K_{ij} \\ge 0$ (当 $i \\ne j$)，对角元素 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$。\n- 稳态分布 $\\boldsymbol{\\pi}$ 满足 $\\boldsymbol{\\pi}^\\top T(\\tau) = \\boldsymbol{\\pi}^\\top$ 且 $\\sum_i \\pi_i = 1$。当 $K$ 对于能量 $E_i$（以热能 $k_\\mathrm{B}T$ 为单位）满足细致平衡时，则 $\\pi_i \\propto \\exp(-E_i)$。\n- 粗粒化为两个宏观态，闭合态 $\\mathcal{C}$ 和开放态 $\\mathcal{O}$，定义了平衡布居 $p_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i$ 和 $p_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i$。延迟时间为 $\\tau$ 的宏观态转移概率由稳态分布加权平均定义：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau), \\quad\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau).\n$$\n- 假设粗粒化的两态动力学可以很好地由一个具有开放速率常数 $k_\\mathrm{op}$ 和闭合速率常数 $k_\\mathrm{cl}$（单位为 $\\mathrm{s}^{-1}$）的连续时间两态过程描述，该过程能再现延迟时间为 $\\tau$ 时的宏观态转移概率。\n- Linderstrøm–Lang 两步交换模型用于亚氨基质子交换，该模型假设交换仅从开放态发生，其内禀化学速率为 $k_\\mathrm{ch}$（单位为 $\\mathrm{s}^{-1}$）。可观测的交换速率常数 $k_\\mathrm{ex}$（单位为 $\\mathrm{s}^{-1}$）是开放/闭合与化学步骤耦合的结果。\n\n您的任务：\n1. 对于每个测试用例，根据给定的微观态能量和具有基础尝试速率 $a_{ij}$ 的对称连接性，构建连续时间生成元 $K$。对于每个具有基础速率 $a_{ij}$ 的无向边 $(i,j)$：\n   - 设置 $K_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)$ 和 $K_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)$ 以强制满足关于 $E_i$ 的细致平衡。\n   - 对每个 $i$ 设置 $K_{ii} = -\\sum_{j\\ne i} K_{ij}$。\n2. 计算 $T(\\tau) = \\exp(\\tau K)$，然后从 $T(\\tau)$ 计算稳态分布 $\\boldsymbol{\\pi}$。\n3. 计算平衡开放布居 $p_\\mathcal{O}$。\n4. 使用上述稳态分布加权定义，计算宏观态转移概率 $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ 和 $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$。\n5. 推断有效连续时间两态过程的 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$（单位为 $\\mathrm{s}^{-1}$），该过程能精确再现延迟时间 $\\tau$ 时的宏观态转移概率。\n6. 使用 Linderstrøm–Lang 两步机制，根据获得的 $k_\\mathrm{op}$、$k_\\mathrm{cl}$ 和提供的 $k_\\mathrm{ch}$ 计算预测的亚氨基质子交换速率 $k_\\mathrm{ex}$（单位为 $\\mathrm{s}^{-1}$）。\n\n将 $p_\\mathcal{O}$ 表示为无量纲分数，$k_\\mathrm{op}$ 和 $k_\\mathrm{ex}$ 的单位为 $\\mathrm{s}^{-1}$。将所有报告的数字四舍五入到六位小数。\n\n测试套件（所有案例的微观态标记为 $0,1,2,3,4$，闭合宏观态为 $\\mathcal{C}=\\{0,1,2\\}$，开放宏观态为 $\\mathcal{O}=\\{3,4\\}$；延迟时间 $\\tau$ 单位为秒；能量 $E_i$ 单位为 $k_\\mathrm{B}T$；基础速率 $a_{ij}$ 单位为 $\\mathrm{s}^{-1}$）：\n\n- 案例 A（罕见开放，交换受限于闭合；预期为交换机制 $\\mathrm{EX2}$）：\n  - 能量：$[\\,0.0,\\; 0.2,\\; 0.3,\\; 4.0,\\; 4.1\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部：$(0,1):\\, 2.0\\times 10^{6}$；$(1,2):\\, 1.5\\times 10^{6}$；$(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部：$(3,4):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 与 $\\mathcal{O}$ 之间：$(2,3):\\, 2.0\\times 10^{2}$。\n  - 延迟时间：$\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率：$k_\\mathrm{ch} = 1.0\\times 10^{1}$。\n\n- 案例 B（中等程度开放，化学反应受限；预期为交换机制 $\\mathrm{EX1}$）：\n  - 能量：$[\\,0.0,\\; 0.2,\\; 0.3,\\; 2.0,\\; 2.2\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部：$(0,1):\\, 2.0\\times 10^{6}$；$(1,2):\\, 1.5\\times 10^{6}$；$(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部：$(3,4):\\, 8.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 与 $\\mathcal{O}$ 之间：$(2,3):\\, 1.0\\times 10^{3}$。\n  - 延迟时间：$\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率：$k_\\mathrm{ch} = 1.0\\times 10^{5}$。\n\n- 案例 C（极罕见开放；预期为交换机制 $\\mathrm{EX2}$）：\n  - 能量：$[\\,0.0,\\; 0.2,\\; 0.3,\\; 7.0,\\; 7.2\\,]$。\n  - 具有基础尝试速率 $a_{ij}$ 的无向边：\n    - $\\mathcal{C}$ 内部：$(0,1):\\, 2.0\\times 10^{6}$；$(1,2):\\, 1.5\\times 10^{6}$；$(0,2):\\, 5.0\\times 10^{5}$。\n    - $\\mathcal{O}$ 内部：$(3,4):\\, 3.0\\times 10^{5}$。\n    - $\\mathcal{C}$ 与 $\\mathcal{O}$ 之间：$(2,3):\\, 5.0\\times 10^{1}$。\n  - 延迟时间：$\\tau = 1.0\\times 10^{-6}$。\n  - 内禀化学交换速率：$k_\\mathrm{ch} = 1.0$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个结果列表，每个测试用例一个结果，其中每个结果本身是按 $[\\,p_\\mathcal{O},\\; k_\\mathrm{op},\\; k_\\mathrm{ex}\\,]$ 顺序排列的三个数字的列表。\n- 所有数字必须四舍五入到六位小数。\n- 整个输出必须以以下确切格式显示在单行上：\n  - 示例结构（仅作说明）：$[[0.012345,1.234567,0.123456],[\\dots],[\\dots]]$。\n\n不应打印额外的文本或格式。\n\n您的程序必须实现 $K$ 的构建、 $T(\\tau)$ 的计算、$\\boldsymbol{\\pi}$ 的评估、粗粒化、与连续时间两态简化一致的 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$ 的推断，最后是 $k_\\mathrm{ex}$ 的计算，所有这些都需如上所述从第一性原理出发。所有速率必须以 $\\mathrm{s}^{-1}$ 报告，$p_\\mathcal{O}$ 是无量纲的。不涉及角度。不要使用百分号；如果需要任何分数形式的量，它们必须是无量纲的小数。", "solution": "问题陈述已经过严格审查并被确定为有效。这是一个在生物物理化学领域中良定的、有科学依据的问题，需要应用马尔可夫状态模型和化学动力学的第一性原理。所有必要的数据和定义都已提供，并且没有内部矛盾或逻辑谬误。我们现在将继续提供一个完整、合理的解决方案。\n\n该解决方案对每个测试用例都遵循一个系统的六步程序，正如问题陈述中所描述的。微观态从 $0$ 到 $4$ 索引，闭合宏观态 $\\mathcal{C}$ 包括微观态 $\\{0, 1, 2\\}$，开放宏观态 $\\mathcal{O}$ 包括微观态 $\\{3, 4\\}$。\n\n第一步：构建连续时间生成元矩阵 K\n\n生成元矩阵 K，也称为速率矩阵，控制着连续时间马尔可夫过程。其非对角元素 $K_{ij}$ ($i \\ne j$) 代表从状态 $i$ 到状态 $j$ 的转移速率。对角元素 $K_{ii}$ 代表从状态 $i$ 离开的总速率，由 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$ 给出。\n\n问题指定了从微观态能量 $E_i$（以热能 $k_\\mathrm{B}T$ 为单位）和每个连接状态对 $(i,j)$ 的基础尝试速率 $a_{ij}$（单位为 $\\mathrm{s}^{-1}$）构建 $K$ 的方法。这种构建方式旨在满足细致平衡原理。对于每个具有基础速率 $a_{ij}$ 的无向边 $(i,j)$，K 的相应元素为：\n$$\nK_{ij} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_j - E_i}{2} \\right)\n$$\n$$\nK_{ji} = a_{ij}\\,\\exp\\!\\left( -\\frac{E_i - E_j}{2} \\right)\n$$\n所有其他未指定边的非对角元素 $K_{ij}$ 均为零。在填充所有非对角元素后，对角元素计算为 $K_{ii} = -\\sum_{j \\ne i} K_{ij}$。这种构建确保系统如果任其演化，将达到一个与玻尔兹曼统计一致的平衡态。\n\n第二步：计算稳态分布 $\\boldsymbol{\\pi}$ 和转移矩阵 $T(\\tau)$\n\n稳态分布 $\\boldsymbol{\\pi} = (\\pi_0, \\pi_1, \\dots, \\pi_4)$ 给出了占据每个微观态的平衡概率。因为生成元 K 的构建遵循了关于能量 $E_i$ 的细致平衡，所以稳态分布是玻尔兹曼分布。处于状态 $i$ 的概率 $\\pi_i$ 与 $\\exp(-E_i)$ 成正比。通过强制执行归一化条件 $\\sum_i \\pi_i = 1$，我们得到：\n$$\n\\pi_i = \\frac{\\exp(-E_i)}{\\sum_{j} \\exp(-E_j)}\n$$\n与数值计算转移矩阵的主特征向量相比，这种直接从能量计算的方法更稳健、更基本。\n\n离散时间转移矩阵 $T(\\tau)$ 描述了在有限延迟时间 $\\tau$ 内状态之间转移的概率。它通过矩阵指数与生成元 $K$ 相关联：\n$$\nT(\\tau) = \\exp(\\tau K)\n$$\n其中 $\\tau$ 是给定的延迟时间。这将通过数值方法计算。\n\n第三步：计算平衡开放布居 $p_\\mathcal{O}$\n\n系统被粗粒化为两个宏观态：闭合态（$\\mathcal{C}$）和开放态（$\\mathcal{O}$）。开放宏观态的平衡布居 $p_\\mathcal{O}$ 是所有属于 $\\mathcal{O}$ 的微观态的稳态概率之和。类似地，闭合宏观态的布居是 $p_\\mathcal{C}$。\n$$\np_\\mathcal{O} = \\sum_{i \\in \\mathcal{O}} \\pi_i = \\sum_{i=3}^{4} \\pi_i\n$$\n$$\np_\\mathcal{C} = \\sum_{i \\in \\mathcal{C}} \\pi_i = \\sum_{i=0}^{2} \\pi_i = 1 - p_\\mathcal{O}\n$$\n$p_\\mathcal{O}$ 是一个关键的可观测量，代表碱基对处于易于质子交换构象的时间分数。\n\n第四步：计算宏观态转移概率\n\n宏观态转移概率 $P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)$ 和 $P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$ 量化了在延迟时间 $\\tau$ 内，在系统处于平衡状态下，在闭合和开放宏观态之间转换的可能性。它们使用提供的稳态分布加权公式计算：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = \\frac{1}{p_\\mathcal{C}} \\sum_{i \\in \\mathcal{C}} \\pi_i \\sum_{j \\in \\mathcal{O}} T_{ij}(\\tau) = \\frac{\\sum_{i=0}^{2} \\sum_{j=3}^{4} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{C}}\n$$\n$$\nP_{\\mathcal{O}\\to \\mathcal{C}}(\\tau) = \\frac{1}{p_\\mathcal{O}} \\sum_{i \\in \\mathcal{O}} \\pi_i \\sum_{j \\in \\mathcal{C}} T_{ij}(\\tau) = \\frac{\\sum_{i=3}^{4} \\sum_{j=0}^{2} \\pi_i T_{ij}(\\tau)}{p_\\mathcal{O}}\n$$\n细致平衡的一个推论是，宏观态之间的总平衡通量在两个方向上是相等的，这意味着关系 $p_\\mathcal{C} P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} P_{\\mathcal{O}\\to \\mathcal{C}}(\\tau)$。这可以作为一个有用的一致性检查。\n\n第五步：推断有效的两态速率常数 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$\n\n复杂的多态动力学被投影到一个简单的两态连续时间马尔可夫过程：$\\mathcal{C} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\mathcal{O}$。通过要求这个简单模型能再现第四步中计算的宏观态转移概率来推断速率 $k_\\mathrm{op}$ 和 $k_\\mathrm{cl}$。对于一个两态连续过程，在时间 $\\tau$ 内从 $\\mathcal{C}$ 转移到 $\\mathcal{O}$ 的概率为：\n$$\nP_{\\mathcal{C}\\to \\mathcal{O}}(\\tau) = p_\\mathcal{O} \\left(1 - \\exp\\left(-(k_\\mathrm{op} + k_\\mathrm{cl})\\tau\\right)\\right)\n$$\n求解速率之和 $S = k_\\mathrm{op} + k_\\mathrm{cl}$ 得：\n$$\nS = k_\\mathrm{op} + k_\\mathrm{cl} = -\\frac{1}{\\tau} \\ln\\left(1 - \\frac{P_{\\mathcal{C}\\to \\mathcal{O}}(\\tau)}{p_\\mathcal{O}}\\right)\n$$\n在宏观态水平，细致平衡要求 $p_\\mathcal{C} k_\\mathrm{op} = p_\\mathcal{O} k_\\mathrm{cl}$。使用这个关系以及它们的和 $S$ 的表达式，我们可以解出各个速率：\n$$\nk_\\mathrm{op} = S \\cdot p_\\mathcal{O} \\quad \\text{和} \\quad k_\\mathrm{cl} = S \\cdot p_\\mathcal{C}\n$$\n这些方程提供了单位为 $\\mathrm{s}^{-1}$ 的有效开放和闭合速率。\n\n第六步：计算预测的亚氨基质子交换速率 $k_\\mathrm{ex}$\n\n最后一步是使用 Linderstrøm-Lang 两步模型预测实验可观测的亚氨基质子交换速率 $k_\\mathrm{ex}$。该模型假设交换只能在开放状态下以一个内禀化学速率 $k_\\mathrm{ch}$ 发生。动力学方案是：\n$$\n\\text{闭合态} \\underset{k_\\mathrm{cl}}{\\stackrel{k_\\mathrm{op}}{\\rightleftharpoons}} \\text{开放态} \\xrightarrow{k_\\mathrm{ch}} \\text{已交换态}\n$$\n对瞬态“开放”中间体应用稳态近似，我们推导出可观测交换速率常数 $k_\\mathrm{ex}$ 的表达式：\n$$\nk_\\mathrm{ex} = \\frac{k_\\mathrm{op} k_\\mathrm{ch}}{k_\\mathrm{cl} + k_\\mathrm{ch}}\n$$\n这个公式将构象动力学（$k_\\mathrm{op}$、$k_\\mathrm{cl}$）与化学反应步骤（$k_\\mathrm{ch}$）耦合起来。我们可以区分两个极限情况：\n-   EX2 机制（$k_\\mathrm{cl} \\gg k_\\mathrm{ch}$）：$k_\\mathrm{ex} \\approx k_\\mathrm{op} (k_\\mathrm{ch}/k_\\mathrm{cl}) = K_\\mathrm{eq} k_\\mathrm{ch} = (p_\\mathcal{O}/p_\\mathcal{C}) k_\\mathrm{ch}$，此时交换受限于开放-闭合平衡。\n-   EX1 机制（$k_\\mathrm{cl} \\ll k_\\mathrm{ch}$）：$k_\\mathrm{ex} \\approx k_\\mathrm{op}$，此时每个开放事件都会导致成功交换，总速率受限于开放速率。\n\n通过对每个提供的测试案例实施这六个步骤，我们可以计算所需的量：$p_\\mathcal{O}$、$k_\\mathrm{op}$ 和 $k_\\mathrm{ex}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 4.0, 4.1]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 5.0e5),                               # Within O\n                (2, 3, 2.0e2)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e1\n        },\n        {\n            \"name\": \"Case B\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 2.0, 2.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 8.0e5),                               # Within O\n                (2, 3, 1.0e3)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e5\n        },\n        {\n            \"name\": \"Case C\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 7.0, 7.2]),\n            \"edges\": [\n                (0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5),  # Within C\n                (3, 4, 3.0e5),                               # Within O\n                (2, 3, 5.0e1)                                # Between C and O\n            ],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0\n        }\n    ]\n\n    # Common parameters for all cases\n    num_states = 5\n    closed_states = [0, 1, 2]\n    open_states = [3, 4]\n\n    results = []\n    for case in test_cases:\n        energies = case[\"energies\"]\n        edges = case[\"edges\"]\n        tau = case[\"lag_time\"]\n        k_ch = case[\"k_ch\"]\n\n        # Step 1: Construct the generator matrix K\n        K = np.zeros((num_states, num_states))\n        for i, j, a_ij in edges:\n            delta_E = energies[j] - energies[i]\n            K[i, j] = a_ij * np.exp(-delta_E / 2.0)\n            K[j, i] = a_ij * np.exp(delta_E / 2.0)\n        \n        for i in range(num_states):\n            K[i, i] = -np.sum(K[i, :])\n\n        # Step 2: Compute stationary distribution pi and transition matrix T(tau)\n        boltzmann_factors = np.exp(-energies)\n        partition_func = np.sum(boltzmann_factors)\n        pi = boltzmann_factors / partition_func\n        \n        T_tau = expm(K * tau)\n\n        # Step 3: Compute equilibrium open population p_O\n        p_O = np.sum(pi[open_states])\n        p_C = 1.0 - p_O\n\n        # Step 4: Compute macrostate transition probabilities\n        flux_C_to_O = 0.0\n        for i in closed_states:\n            for j in open_states:\n                flux_C_to_O += pi[i] * T_tau[i, j]\n        \n        # Guard against division by zero if a macrostate is unpopulated\n        if p_C > 0:\n            P_C_to_O_tau = flux_C_to_O / p_C\n        else:\n            P_C_to_O_tau = 0.0\n\n        # Step 5: Infer rate constants k_op and k_cl\n        # The argument to log must be positive.\n        # This requires P_C_to_O_tau  p_O.\n        # This is guaranteed by the physics of the model as long as states are connected\n        # and populations are non-zero.\n        log_arg = 1.0 - P_C_to_O_tau / p_O if p_O > 0 else 1.0\n        if log_arg > 0:\n            sum_of_rates = - (1.0 / tau) * np.log(log_arg)\n        else: # Handle limit cases if necessary\n            sum_of_rates = 0.0\n            \n        k_op = sum_of_rates * p_O\n        k_cl = sum_of_rates * p_C\n\n        # Step 6: Compute exchange rate k_ex\n        if (k_cl + k_ch) > 0:\n            k_ex = (k_op * k_ch) / (k_cl + k_ch)\n        else:\n            k_ex = 0.0\n            \n        results.append([p_O, k_op, k_ex])\n\n    # Format the final output string as required\n    results_str = [f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]\n    print(f\"[[{results_str[0][1:-1]}],[{results_str[1][1:-1]}],[{results_str[2][1:-1]}]]\")\n\n# The problem asks for a specific output format, let's adjust the final print statement.\ndef solve_and_print():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 4.0, 4.1]),\n            \"edges\": [(0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5), (3, 4, 5.0e5), (2, 3, 2.0e2)],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e1\n        },\n        {\n            \"name\": \"Case B\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 2.0, 2.2]),\n            \"edges\": [(0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5), (3, 4, 8.0e5), (2, 3, 1.0e3)],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0e5\n        },\n        {\n            \"name\": \"Case C\",\n            \"energies\": np.array([0.0, 0.2, 0.3, 7.0, 7.2]),\n            \"edges\": [(0, 1, 2.0e6), (1, 2, 1.5e6), (0, 2, 5.0e5), (3, 4, 3.0e5), (2, 3, 5.0e1)],\n            \"lag_time\": 1.0e-6,\n            \"k_ch\": 1.0\n        }\n    ]\n    num_states = 5\n    closed_states = [0, 1, 2]\n    open_states = [3, 4]\n    all_results = []\n    for case in test_cases:\n        energies, edges, tau, k_ch = case[\"energies\"], case[\"edges\"], case[\"lag_time\"], case[\"k_ch\"]\n        K = np.zeros((num_states, num_states))\n        for i, j, a_ij in edges:\n            delta_E = energies[j] - energies[i]\n            K[i, j] = a_ij * np.exp(-delta_E / 2.0)\n            K[j, i] = a_ij * np.exp(delta_E / 2.0)\n        for i in range(num_states):\n            K[i, i] = -np.sum(K[i, :])\n        \n        boltzmann_factors = np.exp(-energies)\n        partition_func = np.sum(boltzmann_factors)\n        pi = boltzmann_factors / partition_func\n        \n        T_tau = expm(K * tau)\n        \n        p_O = np.sum(pi[open_states])\n        p_C = 1.0 - p_O\n        \n        flux_C_to_O = np.sum(pi[closed_states, None] * T_tau[closed_states, :][:, open_states])\n        \n        P_C_to_O_tau = flux_C_to_O / p_C if p_C > 1e-12 else 0.0\n        \n        log_arg = 1.0 - P_C_to_O_tau / p_O if p_O > 1e-12 else 1.0\n        sum_of_rates = -np.log(log_arg) / tau if log_arg > 0 else 0.0\n\n        k_op = sum_of_rates * p_O\n        k_cl = sum_of_rates * p_C\n        \n        k_ex = (k_op * k_ch) / (k_cl + k_ch) if (k_cl + k_ch) > 0 else 0.0\n        \n        all_results.append(f\"[{p_O:.6f},{k_op:.6f},{k_ex:.6f}]\")\n        \n    print(f\"[{','.join(all_results)}]\")\n\nsolve_and_print()\n```", "id": "2557089"}]}