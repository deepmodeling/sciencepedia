{"hands_on_practices": [{"introduction": "缓冲溶液的$pH$值计算是生物化学中的一项基本技能，通常使用Henderson-Hasselbalch方程来快速估算。然而，深刻理解该方程的适用范围和其背后的假设至关重要。本练习 ([@problem_id:2587753]) 将引导你从质量平衡和电荷平衡等第一性原理出发，推导并计算缓冲液的$pH$值，从而加深对弱酸解离和缓冲机制核心原理的理解。", "problem": "在温度 $T = 298~\\mathrm{K}$ 下，通过溶解单质子弱酸 $\\mathrm{HA}$ 及其钠盐 $\\mathrm{NaA}$ 来制备一种水性缓冲溶液，其分析浓度分别为 $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ 和 $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$，混合后最终体积可认为不变。在 $T = 298~\\mathrm{K}$ 时，$\\mathrm{HA}$ 的酸解离常数 $K_{a}$ 对应于 $pK_{a} = 5.00$，且 $K_{a} = 10^{-pK_{a}}$。假设溶液为理想溶液（所有离子物种的活度系数均为 $1$），并且钠离子不发生水解。水的离子积为 $K_{w} = 1.0 \\times 10^{-14}$。\n\n请仅从酸解离平衡常数的定义、电中性（电荷平衡）条件、酸根组分的总物料守恒以及酸度定义 $pH = -\\log_{10}\\left[ \\mathrm{H^{+}} \\right]$ 出发，确定溶液的平衡 $pH$ 值。通过将你所做的任何近似与由 $F_{\\mathrm{HA}}$、$F_{\\mathrm{A^{-}}}$ 和 $K_{w}$ 设定的标度进行比较，检验其自洽性，从而证明其合理性。最终 $pH$ 值以纯数形式报告（无单位），并四舍五入至三位有效数字。", "solution": "所述问题具有科学依据，提法明确且客观。它展示了水溶液平衡化学中的一个标准情景。所有必要数据均已提供，且前提与基本化学原理一致。因此，该问题是有效的，可以构建解答。\n\n任务是确定由弱酸 $\\mathrm{HA}$ 及其共轭碱盐 $\\mathrm{NaA}$ 制备的缓冲溶液的平衡 $pH$。我们必须按要求从基本原理出发。\n\n水溶液中存在的化学物种有 $\\mathrm{H}^{+}$、$\\mathrm{OH}^{-}$、$\\mathrm{Na}^{+}$、$\\mathrm{HA}$ 和 $\\mathrm{A}^{-}$。它们的浓度受以下平衡和守恒定律的制约。\n\n1.  **酸解离平衡**：弱酸 $\\mathrm{HA}$ 的解离由其酸解离常数 $K_a$ 描述。\n    $$K_a = \\frac{[\\mathrm{H}^{+}][\\mathrm{A}^{-}]}{[\\mathrm{HA}]}$$\n    已知 $pK_a = 5.00$，则常数 $K_a = 10^{-5.00}$。\n\n2.  **水的自电离**：水的解离建立了水合氢离子和氢氧根离子之间的平衡。\n    $$K_w = [\\mathrm{H}^{+}][\\mathrm{OH}^{-}]$$\n    在 $T = 298~\\mathrm{K}$ 时，$K_w = 1.0 \\times 10^{-14}$。\n\n3.  **物料守恒**：酸根组分（含“A”的物种）的总浓度是初始分析浓度 $F_{\\mathrm{HA}}$ 和 $F_{\\mathrm{A^{-}}}$ 的总和。\n    $$[\\mathrm{HA}] + [\\mathrm{A}^{-}] = F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}$$\n    此处，$F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$，$F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$。\n\n4.  **电中性（电荷平衡）**：整个溶液必须呈电中性。正离子浓度之和必须等于负离子浓度之和。钠盐 $\\mathrm{NaA}$ 是强电解质，完全解离，因此 $[\\mathrm{Na}^{+}] = F_{\\mathrm{A^{-}}}$。\n    $$[\\mathrm{Na}^{+}] + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n    代入 $[\\mathrm{Na}^{+}]$，我们得到：\n    $$F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] = [\\mathrm{A}^{-}] + [\\mathrm{OH}^{-}]$$\n\n这四个方程构成了一个完整的方程组，可以用来确定五个未知浓度。我们的目标是求出 $[\\mathrm{H}^{+}]$。\n\n从电荷平衡方程，我们可以表达出共轭碱的平衡浓度 $[\\mathrm{A}^{-}]$：\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}]$$\n利用水的自电离平衡，我们将 $[\\mathrm{OH}^{-}]$ 替换为 $\\frac{K_w}{[\\mathrm{H}^{+}]}$：\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}$$\n从物料守恒方程，我们表达出弱酸的平衡浓度 $[\\mathrm{HA}]$：\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - [\\mathrm{A}^{-}]$$\n代入 $[\\mathrm{A}^{-}]$ 的表达式：\n$$[\\mathrm{HA}] = (F_{\\mathrm{HA}} + F_{\\mathrm{A^{-}}}) - \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right) = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}$$\n现在，我们将 $[\\mathrm{HA}]$ 和 $[\\mathrm{A}^{-}]$ 的精确表达式代入酸解离平衡方程：\n$$K_a = \\frac{[\\mathrm{H}^{+}] \\left(F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - \\frac{K_w}{[\\mathrm{H}^{+}]}\\right)}{F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]}}$$\n这个方程是精确的，但它构成了一个关于 $[\\mathrm{H}^{+}]$ 的三次多项式。我们可以求解它，但对于缓冲体系，标准做法是使用合理的近似。\n\n问题要求对任何近似进行合理性证明。该溶液是一个 $pK_a = 5.00$ 的缓冲溶液。因此，我们预期 $pH$ 值接近 $5$，意味着 $[\\mathrm{H}^{+}] \\approx 10^{-5}~\\mathrm{M}$ 且 $[\\mathrm{OH}^{-}] = K_w / [\\mathrm{H}^{+}] \\approx 10^{-9}~\\mathrm{M}$。我们将这些值与分析浓度 $F_{\\mathrm{HA}} = 0.100~\\mathrm{M}$ 和 $F_{\\mathrm{A^{-}}} = 0.050~\\mathrm{M}$ 进行比较。\n我们观察到 $[\\mathrm{H}^{+}] \\ll F_{\\mathrm{HA}}$、$[\\mathrm{H}^{+}] \\ll F_{\\mathrm{A^{-}}}$、$[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{HA}}$ 以及 $[\\mathrm{OH}^{-}] \\ll F_{\\mathrm{A^{-}}}$。这表明，在平衡浓度 $[\\mathrm{HA}]$ 和 $[\\mathrm{A}^{-}]$ 的表达式中，与 $F_{\\mathrm{HA}}$ 和 $F_{\\mathrm{A^{-}}}$ 相比，$[\\mathrm{H}^{+}]$ 和 $[\\mathrm{OH}^{-}]$ 这两项可以忽略不计。\n\n让我们应用这个近似：\n$$[\\mathrm{A}^{-}] = F_{\\mathrm{A^{-}}} + [\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}] \\approx F_{\\mathrm{A^{-}}}$$\n$$[\\mathrm{HA}] = F_{\\mathrm{HA}} - [\\mathrm{H}^{+}] + \\frac{K_w}{[\\mathrm{H}^{+}]} \\approx F_{\\mathrm{HA}}$$\n如果 $\\mathrm{HA}$ 的解离程度和 $\\mathrm{A}^{-}$ 的水解程度相对于它们的初始分析浓度来说很小，那么这个近似是有效的。\n将这些近似代入 $K_a$ 表达式，得到简化关系式：\n$$K_a \\approx \\frac{[\\mathrm{H}^{+}]F_{\\mathrm{A^{-}}}}{F_{\\mathrm{HA}}}$$\n求解 $[\\mathrm{H}^{+}]$：\n$$[\\mathrm{H}^{+}] \\approx K_a \\frac{F_{\\mathrm{HA}}}{F_{\\mathrm{A^{-}}}}$$\n我们代入给定值：\n$$[\\mathrm{H}^{+}] \\approx (10^{-5.00}) \\times \\frac{0.100}{0.050} = (1.00 \\times 10^{-5}) \\times 2.00 = 2.00 \\times 10^{-5}~\\mathrm{M}$$\n\n现在，我们对所做的近似进行自洽性检验。使用我们计算出的值 $[\\mathrm{H}^{+}] \\approx 2.00 \\times 10^{-5}~\\mathrm{M}$：\n$$[\\mathrm{OH}^{-}] = \\frac{K_w}{[\\mathrm{H}^{+}]} = \\frac{1.0 \\times 10^{-14}}{2.00 \\times 10^{-5}} = 5.0 \\times 10^{-10}~\\mathrm{M}$$\n我们检查 $[\\mathrm{A}^{-}]$ 近似计算的分数误差：\n相对于 $F_{\\mathrm{A^{-}}}$ 我们忽略的项是 $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$。\n$$\\frac{|[\\mathrm{H}^{+}]-[\\mathrm{OH}^{-}]|}{F_{\\mathrm{A^{-}}}}=\\frac{|2.00 \\times 10^{-5} - 5.0 \\times 10^{-10}|}{0.050} \\approx \\frac{2.00 \\times 10^{-5}}{0.050} = 4.0 \\times 10^{-4}$$\n这对应于 $0.04 \\%$ 的相对误差。\n我们检查 $[\\mathrm{HA}]$ 近似计算的分数误差：\n相对于 $F_{\\mathrm{HA}}$ 我们忽略的项也是 $([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])$，但它以 $([\\mathrm{H}^{+}] - K_w/[\\mathrm{H}^{+}])$ 的形式出现，并带有一个负号。\n$$\\frac{|-([\\mathrm{H}^{+}] - [\\mathrm{OH}^{-}])|}{F_{\\mathrm{HA}}}=\\frac{|-(2.00 \\times 10^{-5} - 5.0 \\times 10^{-10})|}{0.100} \\approx \\frac{2.00 \\times 10^{-5}}{0.100} = 2.0 \\times 10^{-4}$$\n这对应于 $0.02 \\%$ 的相对误差。\n两个误差都非常小，证实了对于所要求的精度，近似 $[\\mathrm{A}^{-}] \\approx F_{\\mathrm{A^{-}}}$ 和 $[\\mathrm{HA}] \\approx F_{\\mathrm{HA}}$ 是合理的。\n\n在 $[\\mathrm{H}^{+}]$ 的值得到验证后，我们现在可以计算 $pH$：\n$$pH = -\\log_{10}([\\mathrm{H}^{+}]) = -\\log_{10}(2.00 \\times 10^{-5})$$\n$$pH = -(\\log_{10}(2.00) + \\log_{10}(10^{-5})) = 5.00 - \\log_{10}(2.00)$$\n使用计算器，$\\log_{10}(2.00) \\approx 0.30103$。\n$$pH \\approx 5.00 - 0.30103 = 4.69897$$\n问题要求答案四舍五入到三位有效数字。\n$$pH \\approx 4.70$$\n这个最终结果与我们的初步评估一致，并且是严格地从给定原理推导出来的，所有近似都经过了严格的合理性证明。", "answer": "$$\\boxed{4.70}$$", "id": "2587753"}, {"introduction": "在掌握了单一缓冲体系后，我们将注意力转向更复杂的多元弱酸滴定过程，这在分析氨基酸和蛋白质时尤其重要。本练习 ([@problem_id:2587709]) 的核心是探讨滴定曲线上的关键点——半当量点，并揭示其$pH$值与酸解离常数（$pK_a$）之间的直接联系。通过这个练习，你将学会如何从实验曲线中提取关于分子质子亲和力的关键热力学信息。", "problem": "在 $25\\,^{\\circ}\\mathrm{C}$ 的水溶液中，用强碱 $ \\mathrm{NaOH} $ 滴定一种记为 $ \\mathrm{H_2A} $ 的二元弱酸。水性介质为稀溶液且离子强度较低，您可以假设所有溶质的行为均为理想行为，强电解质完全解离，并且在所关注的 pH 范围内，水的自电离对质子平衡的贡献可以忽略不计。$ \\mathrm{H_2A} $ 的逐级酸解离常数由其以10为底的负对数 $ pK_{a1} $ 和 $ pK_{a2} $ 给出，其中 $ pK_{a1} = 3.8649 $ 且 $ pK_{a2} = 7.2146 $。初始溶液包含 $25.00\\,\\mathrm{mL}$ 浓度为 $0.01000\\,\\mathrm{M}$ 的 $ \\mathrm{H_2A} $，用浓度为 $0.1000\\,\\mathrm{M}$ 的 $ \\mathrm{NaOH} $ 进行滴定。$ pK_{a2} - pK_{a1} $ 的差值足够大，因此在缓冲区域中，两个去质子化步骤可以被视为是良好分离的。\n\n仅使用逐级酸解离平衡、质量守恒、电中性以及滴定反应化学计量关系的基本定义，确定此次滴定中第一个半等当点和第二个半等当点的 pH 值。从第一性原理出发，为您所做的任何近似提供合理解释。将您的最终数值结果表示为行矩阵 $ \\big[ \\mathrm{pH}_{1/2,1} \\ \\mathrm{pH}_{1/2,2} \\big] $ 的形式，其中 $ \\mathrm{pH}_{1/2,1} $ 是第一个半等当点的 pH 值，$ \\mathrm{pH}_{1/2,2} $ 是第二个半等当点的 pH 值。将您的答案取四位有效数字。在最终报告的行矩阵中不要包含单位。", "solution": "该问题需要经过验证。\n\n### 步骤 1：提取已知条件\n-   体系：用强碱 $\\mathrm{NaOH}$ 滴定二元弱酸 $\\mathrm{H_2A}$。\n-   溶剂：温度为 $25\\,^{\\circ}\\mathrm{C}$ 的水。\n-   初始酸体积：$V_{\\mathrm{H_2A}} = 25.00\\,\\mathrm{mL}$。\n-   初始酸浓度：$[\\mathrm{H_2A}]_{0} = 0.01000\\,\\mathrm{M}$。\n-   滴定剂浓度：$[\\mathrm{NaOH}] = 0.1000\\,\\mathrm{M}$。\n-   酸解离常数：$pK_{a1} = 3.8649$, $pK_{a2} = 7.2146$。\n-   假设：溶质行为理想，强电解质完全解离，水的自电离可忽略不计，且由于 $pK_{a2} - pK_{a1}$ 差值较大，两个去质子化步骤良好分离。\n-   目标：确定第一个和第二个半等当点的 $\\mathrm{pH}$ 值，分别记为 $\\mathrm{pH}_{1/2,1}$ 和 $\\mathrm{pH}_{1/2,2}$。\n-   要求格式：行矩阵 $[\\mathrm{pH}_{1/2,1} \\ \\mathrm{pH}_{1/2,2}]$，结果取四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了一个标准的化学滴定，这是分析化学和生物化学中的一个基本且被充分理解的过程。所提供的 $pK_a$ 值、浓度和体积在物理和化学上都是符合实际的。\n-   **适定性**：该问题是适定的。计算指定点 pH 值所需的所有必要信息均已提供。条件足以确定唯一的解。\n-   **客观性**：该问题以精确、定量的术语陈述，没有歧义或主观解释。\n\n该问题未违反任何有效性标准。它在科学上是合理的、完整的，并且是客观陈述的。\n\n### 步骤 3：结论与行动\n该问题被视为有效。将基于基本原理制定解决方案。\n\n二元酸 $\\mathrm{H_2A}$ 在水中分两步解离，由两个不同的平衡常数 $K_{a1}$ 和 $K_{a2}$ 控制。\n\n第一步解离反应为：\n$$ \\mathrm{H_2A} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{HA^-} + \\mathrm{H_3O^+} $$\n其酸解离常数 $K_{a1}$ 定义为：\n$$ K_{a1} = \\frac{[\\mathrm{HA^-}][\\mathrm{H_3O^+}]}{[\\mathrm{H_2A}]} $$\n$K_{a1}$ 的值由给定的 $pK_{a1}$ 导出：$K_{a1} = 10^{-pK_{a1}} = 10^{-3.8649}$。\n\n第二步解离反应为：\n$$ \\mathrm{HA^-} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{A^{2-}} + \\mathrm{H_3O^+} $$\n其酸解离常数 $K_{a2}$ 定义为：\n$$ K_{a2} = \\frac{[\\mathrm{A^{2-}}][\\mathrm{H_3O^+}]}{[\\mathrm{HA^-}]} $$\n$K_{a2}$ 的值由给定的 $pK_{a2}$ 导出：$K_{a2} = 10^{-pK_{a2}} = 10^{-7.2146}$。\n\n问题明确指出 $pK_{a2} - pK_{a1} = 7.2146 - 3.8649 = 3.3497$，这个值大于3。这个大的差距使得独立处理两个滴定区域是合理的。\n\n**确定第一个半等当点的 pH 值 ($\\mathrm{pH}_{1/2,1}$)**\n\n第一个半等当点定义为滴定过程中，初始摩尔数一半的 $\\mathrm{H_2A}$ 被强碱 $\\mathrm{NaOH}$ 恰好中和的点。中和反应为：\n$$ \\mathrm{H_2A} + \\mathrm{OH^-} \\to \\mathrm{HA^-} + \\mathrm{H_2O} $$\n由于使用的是强碱，该反应基本进行到底。在第一个半等当点，加入的 $\\mathrm{OH^-}$ 的摩尔数等于 $\\mathrm{H_2A}$ 初始摩尔数的一半。从化学计量关系上看，这意味着剩余酸的浓度 $[\\mathrm{H_2A}]$ 等于所形成的其共轭碱的浓度 $[\\mathrm{HA^-}]$。\n$$ [\\mathrm{H_2A}] = [\\mathrm{HA^-}] $$\n这个近似是有效的，因为体系处于第一个缓冲区域，此处的 pH 值足够低，以至于第二步解离（$\\mathrm{HA^-} \\to \\mathrm{A^{2-}}$）受到抑制，并且 pH 值远离7，这证明了根据问题陈述忽略水的自电离是合理的。\n\n为求得 pH 值，需要对 $K_{a1}$ 的表达式进行重排：\n$$ [\\mathrm{H_3O^+}] = K_{a1} \\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]} $$\n对两边取以10为底的负对数，得到亨德森-哈塞尔巴尔赫方程：\n$$ -\\log_{10}([\\mathrm{H_3O^+}]) = -\\log_{10}(K_{a1}) - \\log_{10}\\left(\\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]}\\right) $$\n$$ \\mathrm{pH} = pK_{a1} + \\log_{10}\\left(\\frac{[\\mathrm{HA^-}]}{[\\mathrm{H_2A}]}\\right) $$\n应用第一个半等当点的条件 $[\\mathrm{H_2A}] = [\\mathrm{HA^-}]$，对数项变为 $\\log_{10}(1) = 0$。\n因此，第一个半等当点的 pH 值等于 $pK_{a1}$。\n$$ \\mathrm{pH}_{1/2,1} = pK_{a1} = 3.8649 $$\n\n**确定第二个半等当点的 pH 值 ($\\mathrm{pH}_{1/2,2}$)**\n\n当加入 $1.5$ 当量的碱时，达到第二个半等当点。第一个当量将所有的 $\\mathrm{H_2A}$ 转化为 $\\mathrm{HA^-}$。接下来的半个当量将一半的 $\\mathrm{HA^-}$ 转化为其共轭碱 $\\mathrm{A^{2-}}$。相关反应为：\n$$ \\mathrm{HA^-} + \\mathrm{OH^-} \\to \\mathrm{A^{2-}} + \\mathrm{H_2O} $$\n此时，剩余酸物种 $[\\mathrm{HA^-}]$ 的浓度等于所形成的共轭碱 $[\\mathrm{A^{2-}}]$ 的浓度。\n$$ [\\mathrm{HA^-}] = [\\mathrm{A^{2-}}] $$\n这个条件是有效的，因为体系处于第二个缓冲区域。$pK_a$ 值的大差距确保了完全质子化物种 $\\mathrm{H_2A}$ 的浓度可以忽略不计。这可以通过 $K_{a1}$ 平衡来验证：当 $\\mathrm{pH} \\approx pK_{a2}$ 时，比值 $\\frac{[\\mathrm{H_2A}]}{[\\mathrm{HA^-}]} = \\frac{[\\mathrm{H_3O^+}]}{K_{a1}} \\approx \\frac{10^{-7.2}}{10^{-3.9}} \\approx 10^{-3.3} \\ll 1$。\n\n为求得 pH 值，我们使用 $K_{a2}$ 的表达式：\n$$ [\\mathrm{H_3O^+}] = K_{a2} \\frac{[\\mathrm{HA^-}]}{[\\mathrm{A^{2-}}]} $$\n对两边取以10为底的负对数，得到第二个缓冲体系的亨德森-哈塞尔巴尔赫方程：\n$$ \\mathrm{pH} = pK_{a2} + \\log_{10}\\left(\\frac{[\\mathrm{A^{2-}}]}{[\\mathrm{HA^-}]}\\right) $$\n应用第二个半等当点的条件 $[\\mathrm{HA^-}] = [\\mathrm{A^{2-}}]$，对数项变为 $\\log_{10}(1) = 0$。\n因此，第二个半等当点的 pH 值等于 $pK_{a2}$。\n$$ \\mathrm{pH}_{1/2,2} = pK_{a2} = 7.2146 $$\n\n**最终计算与格式化**\n\n计算出的 pH 值为 $\\mathrm{pH}_{1/2,1} = 3.8649$ 和 $\\mathrm{pH}_{1/2,2} = 7.2146$。问题要求答案取四位有效数字。\n-   将 $3.8649$ 取四位有效数字，得到 $3.865$。\n-   将 $7.2146$ 取四位有效数字，得到 $7.215$。\n\n最终结果以行矩阵的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.865  7.215\n\\end{pmatrix}\n}\n$$", "id": "2587709"}, {"introduction": "在真实的生物大分子中，可滴定残基通常彼此靠近，其质子化行为会相互影响，呈现出协同效应，这使得简单的$pK_a$分析模型不再适用。本高级计算练习 ([@problem_id:2587737]) 将你带入现代生物物理化学研究的前沿，通过构建一个耦合平衡的统计力学模型，并使用全局非线性拟合技术，从模拟的光谱滴定数据中解析出重叠的微观$pK_a$值和相互作用参数。这项实践将使你具备分析复杂生物系统的能力，这些系统中的相互作用是理解蛋白质功能和变构调控的关键。", "problem": "您的任务是设计并分析一个滴定实验，以厘清两个可能相互作用的邻近可滴定残基的重叠酸解离常数（记为 $pK_a$）。该实验使用两种独立的光谱探针，其信号取决于这两个残基的质子化微观状态。您的程序必须针对指定的参数集模拟滴定曲线，然后对组合的探针数据执行全局非线性最小二乘拟合，以恢复 $pK_a$ 值和一个相互作用参数。该问题必须从酸碱平衡和质量作用定律的第一性原理出发解决，并且程序必须实现所推导出的方程，而非使用任何简化公式。\n\n仅从以下基本事实开始：\n- 酸解离常数定义为 $K_a = \\frac{[A^-][H^+]}{[HA]}$，且 $pK_a = -\\log_{10} K_a$。\n- 对于固定的氢离子活度 $[H^+]$，一个位点去质子化的相对倾向由质量作用定律决定。\n- 光谱信号是各微观状态特定信号的布居数加权平均值。\n\n将这两个残基建模为一个具有四种微观状态的耦合双位点酸碱体系：两者均质子化、仅残基 $\\mathrm{A}$ 去质子化、仅残基 $\\mathrm{B}$ 去质子化，以及两者均去质子化。设微观 $pK_a$ 值为 $pK_{a,\\mathrm{A}}$ 和 $pK_{a,\\mathrm{B}}$，并设 $c$ 为一个无量纲的协同因子，使得相对于无耦合的情况，双重去质子化状态的统计权重乘以 $c$（$c = 1$ 对应独立位点；$c  1$ 表示正协同性；$c  1$ 表示负协同性）。设 $\\mathrm{pH}$ 为溶液酸度，视为一个无量纲的量。\n\n对于每个光谱探针 $j \\in \\{1,2\\}$，定义固定的、已知的微观状态特定信号 $s^{(j)}_{00}$、$s^{(j)}_{10}$、$s^{(j)}_{01}$、$s^{(j)}_{11}$，分别对应于四种微观状态：$(00)$ 两者均质子化，$(10)$ 仅 $\\mathrm{A}$ 去质子化，$(01)$ 仅 $\\mathrm{B}$ 去质子化，以及 $(11)$ 两者均去质子化。在给定 $\\mathrm{pH}$ 下观测到的信号是这些微观状态信号的布居数加权平均值。\n\n您的程序必须：\n- 使用质量作用模型计算作为 $\\mathrm{pH}$、$pK_{a,\\mathrm{A}}$、$pK_{a,\\mathrm{B}}$ 和 $c$ 的函数的微观状态权重，将它们归一化为布居数，并用它们计算作为布居数加权平均值的探针信号。\n- 通过评估正向模型，使用已知参数在指定的一组 $\\mathrm{pH}$ 值下生成合成滴定数据，不添加噪声。\n- 对两个探针和所有 $\\mathrm{pH}$ 点进行全局非线性最小二乘拟合，以从组合数据中同时估计 $pK_{a,\\mathrm{A}}$、$pK_{a,\\mathrm{B}}$ 和 $c$。实现参数边界，使得 $pK_{a,\\mathrm{A}}$ 和 $pK_{a,\\mathrm{B}}$ 保持在 $[3,11]$ 范围内，$c$ 保持在 $[10^{-2},10^{2}]$ 范围内。\n- 为每个测试用例返回估计的参数。\n\n对这两个探针使用以下固定的微观状态特定信号（任意单位），这些信号对于拟合模型是已知的：\n- 探针 $\\#1$：$s^{(1)}_{00} = 0.20$，$s^{(1)}_{10} = 1.00$，$s^{(1)}_{01} = 0.25$，$s^{(1)}_{11} = 1.05$。\n- 探针 $\\#2$：$s^{(2)}_{00} = 0.30$，$s^{(2)}_{10} = 0.35$，$s^{(2)}_{01} = 1.10$，$s^{(2)}_{11} = 1.15$。\n\n在所有情况下使用以下 $\\mathrm{pH}$ 网格（无量纲）：\n- $\\mathrm{pH}$ 点：$[4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0]$。\n\n测试套件：\n每个测试用例指定真实的 $(pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$。使用这些真实参数模拟数据，然后进行拟合以恢复它们。\n- 案例 $1$（清晰分离，独立）：$(6.50, 8.20, 1.00)$。\n- 案例 $2$（重叠，独立）：$(6.90, 7.00, 1.00)$。\n- 案例 $3$（中等正协同性）：$(6.80, 7.20, 5.00)$。\n- 案例 $4$（负协同性）：$(6.80, 7.20, 0.20)$。\n\n答案格式和单位：\n- 将 $pK_{a,\\mathrm{A}}$ 和 $pK_{a,\\mathrm{B}}$ 报告为四舍五入到两位小数的无量纲数字。\n- 将 $c$ 报告为四舍五入到两位小数的无量纲数字。\n- 如果您的拟合在内部对位点进行了不同的标记，请在输出前按升序对报告的 $pK_a$ 值进行排序；报告相同的拟合 $c$ 值。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为用方括号括起来的、以逗号分隔的列表的列表。每个内部列表必须包含该用例的三个浮点数 $[pK_{a,\\min}, pK_{a,\\max}, c]$。例如，两个用例的有效输出如下所示：$[[6.50,7.80,1.00],[6.90,7.00,1.00]]$。\n\n您的程序必须是一个完整的、可运行的程序，且只生成一行指定格式的输出，不包含任何其他内容。", "solution": "所提出的问题是生物物理化学中一个适定性的练习，它要求推导和应用一个用于耦合平衡的统计热力学模型。该问题基于可靠的科学原理，且不存在逻辑或事实上的不一致。因此，我们将提供一个完整的解决方案。\n\n该体系由两个可滴定位点 $\\mathrm{A}$ 和 $\\mathrm{B}$ 组成，它们可以存在于四种质子化微观状态之一：$M_{00}$（两位点均质子化，$HA-HB$）、$M_{10}$（位点 $\\mathrm{A}$ 去质子化，$A^{-}-HB$）、$M_{01}$（位点 $\\mathrm{B}$ 去质子化，$HA-B^{-}$）以及 $M_{11}$（两位点均去质子化，$A^{-}-B^{-}$）。目标是从光谱滴定数据中确定内在酸解离常数 $pK_{a,\\mathrm{A}}$ 和 $pK_{a,\\mathrm{B}}$，以及一个量化它们相互作用的参数 $c$。\n\n我们从质量作用定律的第一性原理开始。微观酸解离平衡如下：\n$$\nHA \\rightleftharpoons A^{-} + H^{+} \\quad \\text{with} \\quad K_a = \\frac{[A^{-}][H^{+}]}{[HA]}\n$$\n由此，我们定义 $pK_a = -\\log_{10} K_a$ 并使用 $\\mathrm{pH} = -\\log_{10} [H^{+}]$ 的定义。请注意，根据题目要求，$\\mathrm{pH}$ 被视为无量纲量。\n\n为了对该体系建模，我们定义了四种微观状态中每一种相对于完全质子化状态 $M_{00}$ 的统计权重。按照惯例，$M_{00}$ 的权重设为1，即 $w_{00} = 1$。\n\n$M_{00}$ 和 $M_{10}$ 之间的平衡是 $M_{00} \\rightleftharpoons M_{10} + H^{+}$。其平衡常数是位点 $\\mathrm{A}$ 的微观常数 $K_{a,\\mathrm{A}}$。\n$$\nK_{a,\\mathrm{A}} = \\frac{[M_{10}][H^{+}]}{[M_{00}]} \\implies \\frac{[M_{10}]}{[M_{00}]} = \\frac{K_{a,\\mathrm{A}}}{[H^{+}]} = 10^{-pK_{a,\\mathrm{A}}} \\cdot 10^{\\mathrm{pH}} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}\n$$\n因此，$M_{10}$ 的统计权重为 $w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$。\n根据对位点 $\\mathrm{B}$ 的相同逻辑， $M_{01}$ 的统计权重为 $w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$。\n\n对于双重去质子化状态 $M_{11}$，我们考虑总平衡 $M_{00} \\rightleftharpoons M_{11} + 2H^{+}$。统计权重 $w_{11}$ 由 $[M_{11}]/[M_{00}]$ 给出。在没有耦合的情况下（$c=1$），各位点独立滴定。从 $M_{00}$ 到 $M_{11}$ 的热力学路径涉及两个质子解离，其常数分别为 $K_{a,\\mathrm{A}}$ 和 $K_{a,\\mathrm{B}}$，从而得到 $w_{11, uncoupled} = \\frac{K_{a,\\mathrm{A}}K_{a,\\mathrm{B}}}{[H^{+}]^2} = 10^{2\\cdot\\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$。\n问题引入了一个协同因子 $c$，它修改了 $M_{11}$ 状态的统计权重。这个因子直接反映了位点间的相互作用能。因此，双重去质子化状态的权重为：\n$$\nw_{11} = c \\cdot w_{11, uncoupled} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}\n$$\n$c  1$ 的值表示正协同性（一个位点的去质子化促进另一个位点的去质子化），而 $c  1$ 表示负协同性。\n\n统计权重集为：\n$w_{00} = 1$\n$w_{10} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{A}}}$\n$w_{01} = 10^{\\mathrm{pH} - pK_{a,\\mathrm{B}}}$\n$w_{11} = c \\cdot 10^{2 \\cdot \\mathrm{pH} - pK_{a,\\mathrm{A}} - pK_{a,\\mathrm{B}}}$\n\n每个微观状态的概率（或布居数）是其权重除以所有权重之和，即配分函数 $Z$：\n$$\nZ(\\mathrm{pH}; pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c) = w_{00} + w_{10} + w_{01} + w_{11}\n$$\n布居数为：\n$P_{00} = w_{00}/Z$, $P_{10} = w_{10}/Z$, $P_{01} = w_{01}/Z$, $P_{11} = w_{11}/Z$。\n\n对于每个光谱探针 $j \\in \\{1, 2\\}$，观测到的信号是来自四种微观状态（$s^{(j)}_{00}, s^{(j)}_{10}, s^{(j)}_{01}, s^{(j)}_{11}$）信号的布居数加权平均值：\n$$\nS^{(j)}(\\mathrm{pH}) = P_{00} s^{(j)}_{00} + P_{10} s^{(j)}_{10} + P_{01} s^{(j)}_{01} + P_{11} s^{(j)}_{11}\n$$\n这个方程构成了正向模型，它预测在任何 $\\mathrm{pH}$ 值下，对于给定参数集 $\\theta = (pK_{a,\\mathrm{A}}, pK_{a,\\mathrm{B}}, c)$ 的光谱信号。\n\n为了从实验数据中恢复参数，我们执行一个全局非线性最小二乘拟合。目标是找到参数集 $\\theta_{fit}$，使得在所有探针和所有 $\\mathrm{pH}$ 点上，合成数据（$S^{(j)}_{data}$）与模型预测（$S^{(j)}_{model}$）之间的残差平方和（SSR）最小化：\n$$\n\\text{SSR}(\\theta) = \\sum_{j=1}^{2} \\sum_{i} \\left[ S^{(j)}_{data}(\\mathrm{pH}_i) - S^{(j)}_{model}(\\mathrm{pH}_i; \\theta) \\right]^2\n$$\n此最优化将使用 `scipy.optimize.least_squares` 库函数中实现的 Levenberg-Marquardt 算法进行数值计算。参数边界按规定施加：$pK_a \\in [3, 11]$ 且 $c \\in [10^{-2}, 10^2]$。\n\n每个测试用例的步骤如下：\n$1$. 使用真实参数，通过正向模型在给定的 $\\mathrm{pH}$ 网格上为两个探针生成合成滴定数据。\n$2$. 定义一个残差函数，用于计算给定一组试验参数下，合成数据与模型预测之间的差异。\n$3$. 执行数值最优化，找到使这些残差的平方和最小化的参数。\n$4$. 得到的拟合 $pK_a$ 值必须按升序排序，以确保表示的唯一性，因为模型对于交换位点标签 $\\mathrm{A}$ 和 $\\mathrm{B}$ 是对称的。然后以要求的精度报告最终参数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting coupled pKa values from simulated spectroscopic data.\n    \"\"\"\n\n    # --- Fixed parameters from the problem statement ---\n\n    # Microstate-specific signals for Probe 1 and Probe 2\n    # s_j_ik where j is probe index (0-indexed) and ik is microstate (00, 10, 01, 11)\n    # Microstates: 00 (H-H), 10 (A- - H), 01 (H - B-), 11 (A- - B-)\n    S_MICROSTATE = np.array([\n        [0.20, 1.00, 0.25, 1.05],  # Probe 1 signals\n        [0.30, 0.35, 1.10, 1.15]   # Probe 2 signals\n    ])\n    S00, S10, S01, S11 = S_MICROSTATE[:, 0], S_MICROSTATE[:, 1], S_MICROSTATE[:, 2], S_MICROSTATE[:, 3]\n\n    # pH grid for the titration\n    PH_GRID = np.array([4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5, 8.0, 8.5, 9.0, 9.5, 10.0])\n\n    # Test cases: (pKa_A, pKa_B, c)\n    test_cases = [\n        (6.50, 8.20, 1.00),\n        (6.90, 7.00, 1.00),\n        (6.80, 7.20, 5.00),\n        (6.80, 7.20, 0.20),\n    ]\n\n    def forward_model(ph_values, pka_a, pka_b, c):\n        \"\"\"\n        Calculates the theoretical spectroscopic signal for both probes.\n        \n        Args:\n            ph_values (np.ndarray): Array of pH values.\n            pka_a (float): Microscopic pKa of site A.\n            pka_b (float): Microscopic pKa of site B.\n            c (float): Cooperativity factor.\n\n        Returns:\n            np.ndarray: A (2, N) array where N is the number of pH points.\n                        Row 0 is the signal for Probe 1, Row 1 for Probe 2.\n        \"\"\"\n        # Calculate statistical weights for each microstate at each pH\n        exp_ph_pkaa = 10**(ph_values - pka_a)\n        exp_ph_pkab = 10**(ph_values - pka_b)\n\n        w00 = np.ones_like(ph_values)\n        w10 = exp_ph_pkaa\n        w01 = exp_ph_pkab\n        w11 = c * exp_ph_pkaa * exp_ph_pkab\n        \n        # Partition function (sum of weights)\n        Z = w00 + w10 + w01 + w11\n\n        # Calculate population of each microstate\n        p00 = w00 / Z\n        p10 = w10 / Z\n        p01 = w01 / Z\n        p11 = w11 / Z\n\n        # Calculate predicted signal as population-weighted average\n        # S00, S10, S01, S11 are (2,) arrays (for each probe), broadcasting works\n        signal_p1 = p00 * S00[0] + p10 * S10[0] + p01 * S01[0] + p11 * S11[0]\n        signal_p2 = p00 * S00[1] + p10 * S10[1] + p01 * S01[1] + p11 * S11[1]\n\n        return np.array([signal_p1, signal_p2])\n\n    results = []\n    for case in test_cases:\n        pka_a_true, pka_b_true, c_true = case\n\n        # 1. Generate synthetic data using the true parameters\n        synthetic_data = forward_model(PH_GRID, pka_a_true, pka_b_true, c_true)\n\n        # 2. Define the residual function for the least-squares fitting\n        def residuals(params, ph_grid, data):\n            \"\"\"\n            Calculates the residuals between the model and the data.\n            `params` is a list/tuple: [pka_a, pka_b, c].\n            `data` is the (2, N) array of synthetic measurements.\n            \"\"\"\n            pka_a_fit, pka_b_fit, c_fit = params\n            model_prediction = forward_model(ph_grid, pka_a_fit, pka_b_fit, c_fit)\n            # Flatten the residuals for both probes into a single array\n            return (model_prediction - data).flatten()\n\n        # 3. Perform the nonlinear least-squares fit\n        initial_guess = [7.0, 7.0, 1.0] # A reasonable starting point\n        # Bounds: pKa in [3, 11], c in [0.01, 100]\n        bounds = ([3.0, 3.0, 1e-2], [11.0, 11.0, 1e2])\n        \n        fit_result = least_squares(\n            residuals,\n            initial_guess,\n            bounds=bounds,\n            args=(PH_GRID, synthetic_data),\n            method='trf' # Trust Region Reflective algorithm, good for bounds\n        )\n        \n        # 4. Extract, sort, and format the fitted parameters\n        pka_a_fit, pka_b_fit, c_fit = fit_result.x\n        \n        # Sort pKa values in ascending order\n        pka_sorted = sorted([pka_a_fit, pka_b_fit])\n        \n        # Round to two decimal places\n        pka1_rounded = round(pka_sorted[0], 2)\n        pka2_rounded = round(pka_sorted[1], 2)\n        c_rounded = round(c_fit, 2)\n        \n        results.append([pka1_rounded, pka2_rounded, c_rounded])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2587737"}]}