{"hands_on_practices": [{"introduction": "突触反应的试次间变异性不仅仅是噪声，它包含了关于神经递质释放机制的关键信息。本练习介绍了一种经典的量化分析技术，即变异系数（CV）分析法 [@problem_id:2744497]。通过推导响应幅度的均值和方差与底层二项分布参数（$N$ 和 $p$）之间的关系，您将学会如何利用响应的变异性来估计单个释放位点的释放概率 $p$。", "problem": "您正在两种实验条件下研究单个谷氨酸能突触的突触传递。根据神经递质释放的量子假说，每次试验中，$N$ 个解剖学上定义的释放位点中的每一个最多可以释放一个囊泡，且各释放位点之间相互独立，释放概率 $p$ 相同。因此，在每次试验中，释放的囊泡数量 $k$ 被建模为参数为 $N$ 和 $p$ 的二项随机变量。每次试验的突触后反应幅度 $A$ 被假定为与释放的囊泡数量成正比，其量子大小 $q$ 在各次试验中保持不变，因此有 $A = q\\,k$。假设与随机释放相比，测量噪声和突触后受体噪声可以忽略不计，并且 $q$ 不随条件变化。\n\n仅使用基本定义和经过充分验证的事实：对于二项随机变量 $k \\sim \\mathrm{Bin}(N,p)$，其均值为 $\\mathbb{E}[k] = Np$，方差为 $\\mathrm{Var}(k) = Np(1-p)$；对于随机变量 $X$，其变异系数 (CV) 为 $\\mathrm{CV} = \\sqrt{\\mathrm{Var}(X)}/\\mathbb{E}[X]$。\n\n任务：\n1. 从这些定义和事实出发，推导振幅 $A$ 的 $\\mathrm{CV}^{2}$ 关于 $N$ 和 $p$ 的显式表达式，然后重新整理该表达式，将 $p$ 表示为仅含 $N$ 和 $\\mathrm{CV}$ 的形式。\n2. 在同一突触上进行的另一组独立实验中，通过解剖学和光学测量估计释放位点的数量为 $N = 20$。在两种药理学条件下，测得的 $A$ 的变异系数分别为 $\\mathrm{CV} = 0.5$ 和 $\\mathrm{CV} = 0.3$。使用您推导出的表达式，计算这两种条件下相应的释放概率 $p$。\n\n将最终的概率表示为精确值（分数）。按顺序以 $\\big(p_{\\text{cond 1}},\\,p_{\\text{cond 2}}\\big)$ 的形式提供您的最终答案。不要四舍五入。", "solution": "问题陈述已经过验证。\n\n步骤 1：提取已知条件。\n- 释放的囊泡数量 $k$ 服从二项分布，$k \\sim \\mathrm{Bin}(N,p)$。\n- $N$ 是释放位点的数量。\n- $p$ 是单个位点的释放概率。\n- 突触后反应幅度为 $A = qk$，其中 $q$ 是恒定的量子大小。\n- 测量噪声和突触后受体噪声可以忽略不计。\n- $q$ 在不同条件下保持不变。\n- 二项随机变量 $k$ 的均值：$\\mathbb{E}[k] = Np$。\n- 二项随机变量 $k$ 的方差：$\\mathrm{Var}(k) = Np(1-p)$。\n- 随机变量 $X$ 的变异系数：$\\mathrm{CV} = \\sqrt{\\mathrm{Var}(X)}/\\mathbb{E}[X]$。\n- 对于一组特定实验，$N = 20$。\n- 对于条件 1，测得的变异系数为 $\\mathrm{CV} = 0.5$。\n- 对于条件 2，测得的变异系数为 $\\mathrm{CV} = 0.3$。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为它基于突触传递的量子假说，这是细胞神经科学的基石。所提供的数学模型，使用二项分布及其统计特性，是在给定假设下对该假说的标准且正确的形式化表述。该问题是适定的、客观的且自洽的，为获得唯一解提供了所有必要的定义和数据。不存在矛盾、歧义或科学上的不准确之处。\n\n步骤 3：结论与行动。\n该问题有效。将提供解答。\n\n第一个任务是推导幅度 $\\mathrm{CV}^{2}(A)$ 的平方变异系数的表达式，然后求解释放概率 $p$。\n\n突触后反应幅度 $A$ 是释放囊泡数量 $k$ 的线性函数：\n$$A = qk$$\n其中 $k$ 是一个随机变量，$q$ 是一个常数。利用期望和方差的基本性质，可以将 $A$ 的均值和方差用 $k$ 的均值和方差表示。\n\n$A$ 的均值为：\n$$\\mathbb{E}[A] = \\mathbb{E}[qk] = q\\mathbb{E}[k]$$\n$A$ 的方差为：\n$$\\mathrm{Var}(A) = \\mathrm{Var}(qk) = q^2\\mathrm{Var}(k)$$\n\n问题指出 $k$ 是一个二项随机变量，$k \\sim \\mathrm{Bin}(N,p)$，其均值为 $\\mathbb{E}[k] = Np$，方差为 $\\mathrm{Var}(k) = Np(1-p)$。将这些代入 $A$ 的均值和方差表达式中：\n$$\\mathbb{E}[A] = qNp$$\n$$\\mathrm{Var}(A) = q^2Np(1-p)$$\n\n$A$ 的变异系数，记为 $\\mathrm{CV}(A)$，定义为其标准差与均值的比率：\n$$\\mathrm{CV}(A) = \\frac{\\sqrt{\\mathrm{Var}(A)}}{\\mathbb{E}[A]}$$\n代入 $A$ 的均值和方差表达式：\n$$\\mathrm{CV}(A) = \\frac{\\sqrt{q^2Np(1-p)}}{qNp} = \\frac{q\\sqrt{Np(1-p)}}{qNp} = \\frac{\\sqrt{Np(1-p)}}{Np}$$\n正如预期的那样，常数量子大小 $q$ 被消去了。\n\n因此，平方变异系数 $\\mathrm{CV}^{2}(A)$ 为：\n$$\\mathrm{CV}^{2}(A) = \\left(\\frac{\\sqrt{Np(1-p)}}{Np}\\right)^2 = \\frac{Np(1-p)}{(Np)^2} = \\frac{Np(1-p)}{N^2p^2}$$\n通过约去分子和分母中的 $N$ 和 $p$ 来简化此表达式，得到第一个所需的表达式：\n$$\\mathrm{CV}^{2}(A) = \\frac{1-p}{Np}$$\n\n对于第一个任务的第二部分，我们必须重新整理这个方程，以 $N$ 和 $\\mathrm{CV}$ 来求解 $p$。为简单起见，让 $\\mathrm{CV}$ 表示 $\\mathrm{CV}(A)$。\n$$\\mathrm{CV}^{2} = \\frac{1-p}{Np}$$\n两边同乘以 $Np$：\n$$Np \\cdot \\mathrm{CV}^{2} = 1 - p$$\n将右边含有 $p$ 的项移到左边：\n$$Np \\cdot \\mathrm{CV}^{2} + p = 1$$\n提取公因式 $p$：\n$$p(N \\cdot \\mathrm{CV}^{2} + 1) = 1$$\n最后，分离出 $p$：\n$$p = \\frac{1}{N \\cdot \\mathrm{CV}^{2} + 1}$$\n这是第二个所需的表达式。\n\n第二个任务是使用这个推导出的公式计算两种实验条件下的释放概率。给定的释放位点数量为 $N = 20$。\n\n对于条件 1，变异系数为 $\\mathrm{CV}_1 = 0.5$。释放概率 $p_1$ 为：\n$$p_1 = \\frac{1}{N \\cdot \\mathrm{CV}_1^{2} + 1} = \\frac{1}{20 \\cdot (0.5)^{2} + 1}$$\n我们计算分母的值。因为 $0.5 = \\frac{1}{2}$，所以 $(0.5)^2 = \\frac{1}{4}$。\n$$p_1 = \\frac{1}{20 \\cdot \\frac{1}{4} + 1} = \\frac{1}{5 + 1} = \\frac{1}{6}$$\n\n对于条件 2，变异系数为 $\\mathrm{CV}_2 = 0.3$。释放概率 $p_2$ 为：\n$$p_2 = \\frac{1}{N \\cdot \\mathrm{CV}_2^{2} + 1} = \\frac{1}{20 \\cdot (0.3)^{2} + 1}$$\n我们计算分母的值。因为 $0.3 = \\frac{3}{10}$，所以 $(0.3)^2 = 0.09 = \\frac{9}{100}$。\n$$p_2 = \\frac{1}{20 \\cdot (0.09) + 1} = \\frac{1}{1.8 + 1} = \\frac{1}{2.8}$$\n为了将其表示为精确分数，我们将 $2.8$ 写成 $\\frac{28}{10}$，化简为 $\\frac{14}{5}$。\n$$p_2 = \\frac{1}{\\frac{14}{5}} = \\frac{5}{14}$$\n\n得到的释放概率为 $p_1 = \\frac{1}{6}$ 和 $p_2 = \\frac{5}{14}$。最终答案是这两个值的有序对。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{6}  \\frac{5}{14} \\end{pmatrix}}$$", "id": "2744497"}, {"introduction": "虽然二项分布精确地描述了具有固定数量释放位点的突触，但在实践中，更简单的泊松分布常被用作其近似。本练习 [@problem_id:2744477] 旨在培养您对模型假设的批判性思维，要求您量化这种常见简化所引入的误差和偏差。通过完成此练习，您将深入理解泊松近似的适用条件及其在参数估计中可能产生的系统性影响。", "problem": "根据量子假说，一个突触被建模为具有 $N$ 个独立的释放位点，每个位点在每次试验中以概率 $p$ 释放一个量子。每个量子贡献一个固定的突触后电流 (PSC) 幅值 $q$，因此每次试验的突触后反应为 $Q = q K$，其中 $K$ 是释放的量子数量。在此模型下，$K$ 服从参数为 $N$ 和 $p$ 的二项分布，平均量子含量为 $m = N p$，平均PSC为 $\\mu = \\mathbb{E}[Q] = q \\, \\mathbb{E}[K] = q \\, m$。失效概率（零反应概率）为 $P_{0} = \\mathbb{P}(K=0) = (1-p)^{N}$。一个常见的近似方法是用具有相同均值 $m$ 的泊松分布代替二项分布，在这种情况下，$P_{0}$ 近似为 $\\exp(-m)$。\n两种经验性策略常用于估计 $m$：(i) 假设泊松统计，从失效分数中估计 $m$ 为 $-\\ln(P_{0})$；(ii) 从平均PSC幅值中估计 $m$ 为 $\\mu/q$。假设真实的数据生成过程是参数为 $N$ 和 $p$ 的二项分布，并通过考虑无限次试验极限来忽略采样噪声，计算 $N=20$ 和 $p=0.1$ 时的以下值：\n1. 泊松近似对失效概率的绝对误差，定义为 $\\left|\\exp(-m) - (1-p)^{N}\\right|$。\n2. 在真实的二项过程中，从 $P_{0}$ 与从 $\\mu/q$ 估计 $m$ 时的偏差，定义为 $\\mathbb{E}[-\\ln(P_{0})] - \\mathbb{E}[\\mu/q]$。\n将您的最终结果以一个双分量行向量 $\\big[\\text{$P_{0}$的绝对误差},\\ \\text{$m$的偏差}\\big]$ 的形式报告，四舍五入到四位有效数字。不需要单位。", "solution": "首先验证问题陈述的正确性和可解性。\n\n逐字提取给定条件：\n- 独立释放位点数：$N$\n- 每个位点的释放概率：$p$\n- 每个量子的PSC幅值：$q$\n- 总PSC幅值：$Q = qK$\n- 释放的量子数：$K$\n- $K$ 的分布：参数为 $N$ 和 $p$ 的二项分布。$K \\sim \\text{Bin}(N, p)$。\n- 平均量子含量：$m = Np$\n- 平均PSC：$\\mu = qm$\n- 真实失效概率：$P_{0} = \\mathbb{P}(K=0) = (1-p)^{N}$\n- 失效概率的泊松近似：$\\exp(-m)$\n- $m$ 的估计量 (i)：$-\\ln(P_{0})$\n- $m$ 的估计量 (ii)：$\\mu/q$\n- 假设：真实过程是二项分布。\n- 假设：无限次试验极限（无采样噪声）。\n- 参数：$N=20$，$p=0.1$。\n- 任务1：计算绝对误差 $\\left|\\exp(-m) - (1-p)^{N}\\right|$。\n- 任务2：计算估计 $m$ 时的偏差，定义为 $\\mathbb{E}[-\\ln(P_{0})] - \\mathbb{E}[\\mu/q]$。\n\n验证：\n该问题在科学上基于细胞神经科学的原理，特别是突触传递的量子假说。它提出了二项模型及其泊松近似之间的标准比较。所有术语都明确定义，所需参数已提供（$N=20$，$p=0.1$），并且任务明确且计算上可行。“通过考虑无限次试验极限来忽略采样噪声”的说明澄清了估计量应应用于真实的总体参数，而不是有限样本统计量。这使得问题是适定的。没有矛盾、歧义或事实错误。该问题有效。\n\n我们继续进行求解。\n\n首先，我们计算平均量子含量 $m$，这是泊松近似的参数。\n$$m = Np$$\n代入给定值 $N=20$ 和 $p=0.1$：\n$$m = 20 \\times 0.1 = 2$$\n\n第1部分：泊松近似对失效概率的绝对误差。\n\n真实的失效概率 $P_{0, \\text{bin}}$ 由 $N$ 次试验中零次成功的二项概率给出：\n$$P_{0, \\text{bin}} = \\mathbb{P}(K=0) = \\binom{N}{0} p^0 (1-p)^{N-0} = (1-p)^N$$\n当 $N=20$ 和 $p=0.1$ 时，此值为：\n$$P_{0, \\text{bin}} = (1 - 0.1)^{20} = (0.9)^{20}$$\n\n失效概率的泊松近似 $P_{0, \\text{poi}}$ 由 $\\exp(-m)$ 给出，其中 $m$ 是分布的均值。\n$$P_{0, \\text{poi}} = \\exp(-m) = \\exp(-2)$$\n\n绝对误差是这两个值之间的绝对差。\n$$\\text{Error}_{P_0} = |P_{0, \\text{poi}} - P_{0, \\text{bin}}| = |\\exp(-2) - (0.9)^{20}|$$\n对各项进行数值计算：\n$$(0.9)^{20} \\approx 0.12157665459$$\n$$\\exp(-2) \\approx 0.13533528323$$\n$$\\text{Error}_{P_0} \\approx |0.13533528323 - 0.12157665459| \\approx 0.01375862864$$\n四舍五入到四位有效数字，绝对误差为 $0.01376$。\n\n第2部分：从 $P_{0}$ 与从 $\\mu/q$ 估计 $m$ 时的偏差。\n\n问题将要计算的量定义为 $\\mathbb{E}[-\\ln(P_{0})] - \\mathbb{E}[\\mu/q]$。“通过考虑无限次试验极限来忽略采样噪声”的说明意味着我们应该使用真实的总体参数来评估估计量。在此极限下，观测到的失效分数收敛于真实概率 $P_0 = (1-p)^N$，观测到的平均PSC $\\hat{\\mu}$ 收敛于真实均值 $\\mu = qm = qNp$。\n\n基于泊松假设的第一个 $m$ 的估计量变为：\n$$m_{\\text{est, Poisson}} = -\\ln(P_{0, \\text{bin}}) = -\\ln((1-p)^N) = -N \\ln(1-p)$$\n这表示如果将该估计量应用于由底层二项过程生成的真实失效概率，它将产生的值。\n\n基于平均PSC的第二个 $m$ 的估计量是：\n$$m_{\\text{est, direct}} = \\frac{\\mu}{q} = \\frac{qNp}{q} = Np = m$$\n该估计量正确地恢复了真实的平均量子含量 $m$，因此是 $m$ 的一个渐近无偏估计量。\n\n问题中定义的“偏差”是第一个估计量的渐近值与第二个估计量（即真实值 $m$）之间的差。\n$$\\text{Bias}_m = m_{\\text{est, Poisson}} - m_{\\text{est, direct}} = [-N \\ln(1-p)] - [Np]$$\n代入 $N=20$ 和 $p=0.1$：\n$$\\text{Bias}_m = -20 \\ln(1-0.1) - (20 \\times 0.1) = -20 \\ln(0.9) - 2$$\n对此表达式进行数值计算：\n$$\\ln(0.9) \\approx -0.10536051565$$\n$$\\text{Bias}_m \\approx -20 \\times (-0.10536051565) - 2 \\approx 2.107210313 - 2 = 0.107210313$$\n这个正偏差表明，对由二项过程生成的数据使用基于泊松的公式 $-\\ln(P_0)$ 会高估真实的平均量子含量 $m$。四舍五入到四位有效数字，偏差为 $0.1072$。\n\n最终结果是一个包含 $P_0$ 的绝对误差和 $m$ 的偏差的双分量行向量。\n$$[\\text{Error}_{P_0}, \\text{Bias}_m] = [0.01376, 0.1072]$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01376  0.1072\n\\end{pmatrix}\n}\n$$", "id": "2744477"}, {"introduction": "突触传递并非静态过程，其强度会随着神经元活动而动态变化，这一现象称为突触可塑性。这项高级练习将您带入计算神经科学领域，通过对一种短时程可塑性——双脉冲易化——进行建模来探索这一概念 [@problem_id:2744507]。您需要通过编程模拟生成数据，并拟合一个动态模型来估计基础释放概率和易化幅度，从而将量化假说的静态原理扩展到动态的、更符合生理实际的场景中。", "problem": "您需要实现并评估一个基于第一性原理的估计器，用于估计一个基于促进作用的突触传递量子模型中的参数。该模型基于量子假说和一个简单的促进过程，该过程调节紧密间隔的动作电位之间的释放概率。\n\n模型假设（除明确指定外，所有量均为无量纲）：\n- 存在 $N$ 个独立的释放位点。在每次刺激下，每个位点最多以概率 $p_{\\mathrm{eff}}$ 释放一个量子，且各释放位点之间相互独立。\n- 量子假说：单次刺激下释放的量子数量是一个参数为 $N$ 和 $p_{\\mathrm{eff}}$ 的二项式随机变量。\n- 突触后反应的振幅是释放的量子贡献之和加上加性测量噪声：如果释放了 $k$ 个量子，则振幅为 $A = q \\, k + \\eta$，其中 $q$ 是量子大小，$\\eta$ 是均值为零、方差为 $\\sigma^2$ 的高斯噪声。\n- 配对脉冲刺激：在时间 $t=0$ 施加第一个脉冲，在时间 $t=\\Delta t$ 施加第二个脉冲。第一个脉冲具有基线有效概率 $p_{\\mathrm{eff,1}} = p$，其中 $p$ 是基线释放概率。第二个脉冲的有效概率为 $p_{\\mathrm{eff,2}}(\\Delta t) = \\min\\{1, \\, p \\, F(\\Delta t)\\}$，其中促进作用 $F(t)$ 从其脉冲后值指数衰减至基线值：\n$$\nF(t) \\,=\\, 1 + \\big(F(0^+) - 1\\big)\\, e^{-t/\\tau_F},\n$$\n其中促进时间常数 $\\tau_F$（单位为毫秒）已知。函数 $F(t)$ 是无量纲的且 $F(t) \\ge 1$，$F(0^+)$ 表示第一个脉冲后的瞬时脉冲后值。假设除了此促进过程外，没有耗竭或不应期现象。\n\n需要在您的程序中实现的数据生成协议：\n- 对于每个测试用例，针对给定集合中的每个脉冲间间隔 $\\Delta t$，模拟 $n_{\\mathrm{trials}}$ 次独立的配对脉冲试验。在给定 $\\Delta t$ 的每次试验中：\n    - 从 $\\mathrm{Binomial}(N, p)$ 分布中抽取 $k_1$，并设置 $A_1 = q \\, k_1 + \\eta_1$，其中 $\\eta_1 \\sim \\mathcal{N}(0, \\sigma^2)$。\n    - 计算 $p_{\\mathrm{eff,2}}(\\Delta t) = \\min\\{1, \\, p \\, F(\\Delta t)\\}$，从 $\\mathrm{Binomial}(N, p_{\\mathrm{eff,2}}(\\Delta t))$ 分布中抽取 $k_2$，并设置 $A_2 = q \\, k_2 + \\eta_2$，其中 $\\eta_2 \\sim \\mathcal{N}(0, \\sigma^2)$，且与 $\\eta_1$ 及所有其他随机性无关。\n- 进行估计时，仅使用 $A_1$ 的经验均值（汇集所有 $\\Delta t$ 的数据）和每个 $\\Delta t$ 处 $A_2$ 的经验均值。您可以利用模型所蕴含的独立性结构，但不应假设可以访问未观测到的 $k_1$ 或 $k_2$。\n\n任务：\n- 对于每个测试用例，仅使用上述模拟数据、已知常数 $(N, q, \\sigma, \\tau_F)$ 以及 $\\Delta t$ 值集合，来估计基线释放概率 $p$ 和瞬时脉冲后促进作用 $F(0^+)$。您的估计器应从与模型假设一致的第一性原理推导得出。确保最终估计值遵守物理约束：$0 \\le p \\le 1$ 和 $1 \\le F(0^+) \\le 1/p$。\n\n随机性与可复现性：\n- 使用固定的整数种子 $s_{\\mathrm{base}} = 2025$。对于测试用例索引 $i$（从 $0$ 开始），在模拟该测试用例之前，使用种子 $s_i = s_{\\mathrm{base}} + i$ 初始化伪随机数生成器。给定测试用例的所有随机性都必须从其对应的种子 $s_i$ 派生。\n\n测试套件（四个用例）：\n- 用例 0（促进作用，中等 p 值）：$N = 50$，$p = 0.20$，$F(0^+) = 1.80$，$\\tau_F = 200$ 毫秒，$q = 1.00$ 任意单位，$\\sigma = 0.20$ 任意单位，$\\Delta t \\in \\{10, 20, 50, 100, 200, 500\\}$ 毫秒，$n_{\\mathrm{trials}} = 200$。\n- 用例 1（无促进作用）：$N = 40$，$p = 0.30$，$F(0^+) = 1.00$，$\\tau_F = 150$ 毫秒，$q = 1.00$ 任意单位，$\\sigma = 0.25$ 任意单位，$\\Delta t \\in \\{5, 20, 80, 160, 400\\}$ 毫秒，$n_{\\mathrm{trials}} = 250$。\n- 用例 2（强促进作用，低 p 值）：$N = 60$，$p = 0.05$，$F(0^+) = 2.50$，$\\tau_F = 300$ 毫秒，$q = 0.80$ 任意单位，$\\sigma = 0.15$ 任意单位，$\\Delta t \\in \\{10, 30, 60, 120, 300, 600\\}$ 毫秒，$n_{\\mathrm{trials}} = 300$。\n- 用例 3（高 p 值，弱促进作用）：$N = 30$，$p = 0.50$，$F(0^+) = 1.20$，$\\tau_F = 100$ 毫秒，$q = 1.20$ 任意单位，$\\sigma = 0.30$ 任意单位，$\\Delta t \\in \\{5, 10, 25, 50, 100, 250\\}$ 毫秒，$n_{\\mathrm{trials}} = 400$。\n\n输出规范：\n- 对于每个测试用例，返回一对浮点估计值 $\\big(\\widehat{p}, \\widehat{F(0^+)}\\big)$。\n- 按用例顺序将这四对值聚合到一个列表中。将每个数字四舍五入到 $4$ 位小数。\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，并用方括号括起来，例如 $\\big[\\,[\\widehat{p}_0,\\widehat{F}_0], [\\widehat{p}_1,\\widehat{F}_1], [\\widehat{p}_2,\\widehat{F}_2], [\\widehat{p}_3,\\widehat{F}_3]\\,\\big]$。\n\n注意：\n- 振幅单位为任意单位 (a.u.)；脉冲间间隔单位为毫秒。要求的输出是无单位的浮点数。\n- 在生成最终估计值时，确保数值稳定并强制施加对 $\\widehat{p}$ 和 $\\widehat{F(0^+)}$ 的物理边界约束。", "solution": "该问题要求推导并实现一个基于第一性原理的估计器，用于估计突触传递模型的参数。待估计的参数是基线量子释放概率 $p$ 和瞬时脉冲后促进幅度 $F(0^+)$。该估计必须基于模拟的突触后反应振幅的经验均值。完成此项任务的合适框架是矩估计法（Method of Moments）。\n\n首先，我们建立模型参数与可观测量（即突触后振幅）期望值之间的关系。刺激后的振幅 $A$ 由 $A = qk + \\eta$ 给出，其中 $k$ 是释放的量子数量， $q$ 是量子大小，$\\eta$ 是零均值高斯噪声。量子数量 $k$ 是一个二项式随机变量，$k \\sim \\mathrm{Binomial}(N, p_{\\mathrm{eff}})$，其中 $N$ 是释放位点的数量，$p_{\\mathrm{eff}}$ 是有效释放概率。因此，期望振幅为：\n$$\nE[A] = E[qk + \\eta] = qE[k] + E[\\eta] = qN p_{\\mathrm{eff}} + 0 = qN p_{\\mathrm{eff}}\n$$\n\n对于配对脉冲序列中的第一个脉冲，释放概率是基线概率，因此 $p_{\\mathrm{eff,1}} = p$。第一个响应的期望振幅 $E[A_1]$ 为：\n$$\nE[A_1] = qNp\n$$\n我们已知第一个脉冲振幅的经验均值 $\\bar{A}_1$。通过令样本矩等于理论矩（$\\bar{A}_1 \\approx E[A_1]$），我们推导出 $p$ 的一个估计器：\n$$\n\\widehat{p} = \\frac{\\bar{A}_1}{qN}\n$$\n为确保估计值在物理上有效，我们必须通过对结果进行截断来强制执行约束 $0 \\le \\widehat{p} \\le 1$。\n\n对于在脉冲间间隔 $\\Delta t$ 处发生的第二个脉冲，释放概率因促进作用而增强：$p_{\\mathrm{eff,2}}(\\Delta t) = \\min\\{1, p F(\\Delta t)\\}$。促进函数为 $F(t) = 1 + (F(0^+) - 1)e^{-t/\\tau_F}$。第二个响应的期望振幅 $E[A_2(\\Delta t)]$ 为：\n$$\nE[A_2(\\Delta t)] = qN p_{\\mathrm{eff,2}}(\\Delta t) = qN \\min\\{1, p F(\\Delta t)\\}\n$$\n问题的参数设置使得饱和不是一个影响因素（即 $p F(t)  1$）。这允许我们忽略 $\\min$ 算子，从而为估计目的简化模型：\n$$\nE[A_2(\\Delta t)] \\approx qN p F(\\Delta t) = qNp \\left[ 1 + (F(0^+) - 1)e^{-\\Delta t/\\tau_F} \\right]\n$$\n代入 $E[A_1] = qNp$，我们得到：\n$$\nE[A_2(\\Delta t)] \\approx E[A_1] + E[A_1](F(0^+) - 1)e^{-\\Delta t/\\tau_F}\n$$\n这可以重排为一个适合回归的线性形式：\n$$\nE[A_2(\\Delta t)] - E[A_1] \\approx \\left( E[A_1](F(0^+) - 1) \\right) e^{-\\Delta t/\\tau_F}\n$$\n我们可以定义一个因变量 $Y_{\\Delta t} = \\bar{A}_{2, \\Delta t} - \\bar{A}_1$ 和一个自变量 $X_{\\Delta t} = e^{-\\Delta t/\\tau_F}$，其中 $\\bar{A}_{2, \\Delta t}$ 是在间隔 $\\Delta t$ 处第二个脉冲振幅的经验均值。该模型变成了一个简单的过原点线性回归，$Y_{\\Delta t} \\approx m X_{\\Delta t}$，其斜率 $m = E[A_1](F(0^+) - 1)$。斜率的普通最小二乘估计值 $\\widehat{m}$ 由以下公式给出：\n$$\n\\widehat{m} = \\frac{\\sum_{\\Delta t} X_{\\Delta t} Y_{\\Delta t}}{\\sum_{\\Delta t} X_{\\Delta t}^2} = \\frac{\\sum_{\\Delta t} (\\bar{A}_{2, \\Delta t} - \\bar{A}_1) e^{-\\Delta t/\\tau_F}}{\\sum_{\\Delta t} (e^{-\\Delta t/\\tau_F})^2}\n$$\n从估计的斜率 $\\widehat{m} \\approx \\bar{A}_1(\\widehat{F(0^+)} - 1)$，我们可以解出 $F(0^+)$ 的估计值：\n$$\n\\widehat{F(0^+)} = \\frac{\\widehat{m}}{\\bar{A}_1} + 1\n$$\n该估计值必须遵守物理约束 $F(0^+) \\ge 1$（根据促进作用的定义）和 $p F(0^+) \\le 1$（以保持 $p_{\\mathrm{eff}} \\le 1$）。因此，我们将 $\\widehat{F(0^+)}$ 的最终估计值截断在 $[1, 1/\\widehat{p}]$ 范围内。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final output.\n    \"\"\"\n    s_base = 2025\n    test_cases = [\n        # Case 0: facilitating, moderate p\n        {'N': 50, 'p': 0.20, 'F0_plus': 1.80, 'tau_F': 200, 'q': 1.00, 'sigma': 0.20,\n         'delta_ts': [10, 20, 50, 100, 200, 500], 'n_trials': 200},\n        # Case 1: no facilitation\n        {'N': 40, 'p': 0.30, 'F0_plus': 1.00, 'tau_F': 150, 'q': 1.00, 'sigma': 0.25,\n         'delta_ts': [5, 20, 80, 160, 400], 'n_trials': 250},\n        # Case 2: strong facilitation, low p\n        {'N': 60, 'p': 0.05, 'F0_plus': 2.50, 'tau_F': 300, 'q': 0.80, 'sigma': 0.15,\n         'delta_ts': [10, 30, 60, 120, 300, 600], 'n_trials': 300},\n        # Case 3: high p, weak facilitation\n        {'N': 30, 'p': 0.50, 'F0_plus': 1.20, 'tau_F': 100, 'q': 1.20, 'sigma': 0.30,\n         'delta_ts': [5, 10, 25, 50, 100, 250], 'n_trials': 400},\n    ]\n\n    results = []\n    for i, case in enumerate(test_cases):\n        seed = s_base + i\n        p_hat, F0_plus_hat = solve_case(\n            case['N'], case['p'], case['F0_plus'], case['tau_F'], case['q'], case['sigma'],\n            case['delta_ts'], case['n_trials'], seed\n        )\n        results.append(f\"[{p_hat},{F0_plus_hat}]\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(N, p_true, F0_plus_true, tau_F, q, sigma, delta_ts, n_trials, seed):\n    \"\"\"\n    Simulates synaptic data and estimates parameters for a single test case.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n\n    # Step 1: Data Simulation\n    A1_all_trials = []\n    A2_by_dt = {dt: [] for dt in delta_ts}\n\n    for dt in delta_ts:\n        # Calculate facilitation factor and p_eff for the second pulse\n        F_dt = 1.0 + (F0_plus_true - 1.0) * np.exp(-dt / tau_F)\n        p_eff2 = min(1.0, p_true * F_dt)\n\n        # Draw k1 and k2 from binomial distributions for all trials\n        k1_trials = rng.binomial(N, p_true, size=n_trials)\n        k2_trials = rng.binomial(N, p_eff2, size=n_trials)\n\n        # Draw noise for all trials\n        eta1_trials = rng.normal(0, sigma, size=n_trials)\n        eta2_trials = rng.normal(0, sigma, size=n_trials)\n\n        # Calculate amplitudes\n        A1_trials = q * k1_trials + eta1_trials\n        A2_trials = q * k2_trials + eta2_trials\n\n        A1_all_trials.extend(A1_trials)\n        A2_by_dt[dt].extend(A2_trials)\n\n    # Step 2: Calculate Empirical Means\n    mean_A1 = np.mean(A1_all_trials)\n    mean_A2s = np.array([np.mean(A2_by_dt[dt]) for dt in delta_ts])\n\n    # Step 3: Estimate p\n    p_hat = 0.0\n    if q * N > 1e-9:\n        p_hat = mean_A1 / (q * N)\n    p_hat = np.clip(p_hat, 0.0, 1.0)\n\n    # Step 4: Estimate F(0+) using linear regression\n    # Model: mean_A2(dt) - mean_A1 ≈ m * exp(-dt/tau_F)\n    # where m = mean_A1 * (F(0+)-1)\n    dts_arr = np.array(delta_ts, dtype=float)\n    X = np.exp(-dts_arr / tau_F)\n    Y_prime = mean_A2s - mean_A1\n\n    # Regression for slope m: m_hat = (X^T Y') / (X^T X)\n    numerator = np.dot(X, Y_prime)\n    denominator = np.dot(X, X)\n\n    m_hat = 0.0\n    if denominator > 1e-9:\n        m_hat = numerator / denominator\n\n    # Solve for F(0+) from m_hat ≈ mean_A1 * (F(0+)_hat - 1)\n    F0_plus_hat_init = 1.0\n    if abs(mean_A1) > 1e-9:\n        F0_plus_hat_init = (m_hat / mean_A1) + 1.0\n\n    # Step 5: Enforce constraints on F(0+)\n    # 1. F(0+) >= 1\n    # 2. F(0+) = 1/p_hat\n    lower_bound_F = 1.0\n    upper_bound_F = np.inf\n    if p_hat > 1e-9:\n        upper_bound_F = 1.0 / p_hat\n        \n    F0_plus_hat = np.clip(F0_plus_hat_init, lower_bound_F, upper_bound_F)\n\n    return f\"{p_hat:.4f}\", f\"{F0_plus_hat:.4f}\"\n\nsolve()\n```", "id": "2744507"}]}