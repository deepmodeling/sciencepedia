{"hands_on_practices": [{"introduction": "在深入研究复杂模型之前，我们首先要对长度常数 $\\lambda$ 本身有一个直观的把握。长度常数并非一个孤立的数字，而是由轴突的物理属性决定的。这个练习 [@problem_id:2764076] 引入了“弹性”这一强大的概念，来量化 $\\lambda$ 对其组成参数（如半径 $a$、膜电阻 $R_m$ 和轴向电阻率 $R_i$）变化的敏感度，帮助我们理解神经元可以通过调节哪些生物物理特性来最有效地改变其电信号的传播效率。", "problem": "在一个无源的、均匀的、无限长的圆柱形轴突中，空间长度常数 $ \\lambda $ 表征了膜电位沿电缆的空间衰减。考虑一个半径为 $ a $、单位面积的比膜电阻为 $ R_m $、胞内电阻率为 $ R_i $ 的圆柱体。对于这样的电缆，标准电缆理论表明\n$$\n\\lambda \\;=\\; \\sqrt{\\frac{a\\,R_m}{2\\,R_i}} \\, .\n$$\n将 $ a $、$ R_m $ 和 $ R_i $ 视为独立的正常数，计算 $ \\lambda $ 关于每个参数的弹性，定义为 $ \\partial \\ln \\lambda / \\partial \\ln a $、$ \\partial \\ln \\lambda / \\partial \\ln R_m $ 和 $ \\partial \\ln \\lambda / \\partial \\ln R_i $。然后，根据 $ \\lambda $ 对 $ a $、$ R_m $ 和 $ R_i $ 微小相对变化的分数敏感性，简要解释这些弹性的大小。\n\n请以行矩阵 $ \\begin{pmatrix} \\partial \\ln \\lambda / \\partial \\ln a & \\partial \\ln \\lambda / \\partial \\ln R_m & \\partial \\ln \\lambda / \\partial \\ln R_i \\end{pmatrix} $ 的形式提供最终答案。无需四舍五入；请报告精确值。弹性是无量纲的，因此最终答案中不应包含单位。", "solution": "问题陈述已经过评估，并被认为是有效的。它在科学上基于细胞神经科学（电缆理论）的原理，在数学上是适定的、客观的且自洽的。所有必要信息都已提供，可得唯一解。\n\n空间长度常数 $\\lambda$ 由以下公式给出：\n$$\n\\lambda = \\sqrt{\\frac{a\\,R_m}{2\\,R_i}}\n$$\n其中 $a$ 是轴突半径，$R_m$ 是比膜电阻，$R_i$ 是胞内电阻率。这三个参数 $a$、$R_m$ 和 $R_i$ 被视为独立的正常数。\n\n一个函数（在此例中为 $\\lambda$）关于一个参数（例如 $x$）的弹性，定义为该函数的自然对数对该参数的自然对数的偏导数：\n$$\nE_x = \\frac{\\partial \\ln \\lambda}{\\partial \\ln x}\n$$\n为了计算所需的弹性，我们首先对 $\\lambda$ 的表达式取自然对数：\n$$\n\\ln \\lambda = \\ln \\left( \\left( \\frac{a R_m}{2 R_i} \\right)^{\\frac{1}{2}} \\right)\n$$\n利用对数的性质，该表达式可简化为：\n$$\n\\ln \\lambda = \\frac{1}{2} \\ln \\left( \\frac{a R_m}{2 R_i} \\right) = \\frac{1}{2} \\left[ \\ln(a) + \\ln(R_m) - \\ln(R_i) - \\ln(2) \\right]\n$$\n现在，我们通过计算 $\\ln \\lambda$ 对 $\\ln a$、$\\ln R_m$ 和 $\\ln R_i$ 的偏导数来求这三个弹性。\n\n$1$. 关于半径 $a$ 的弹性：\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln a} = \\frac{\\partial}{\\partial \\ln a} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = \\frac{1}{2} \\frac{\\partial (\\ln a)}{\\partial (\\ln a)} = \\frac{1}{2}\n$$\n\n$2$. 关于比膜电阻 $R_m$ 的弹性：\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln R_m} = \\frac{\\partial}{\\partial \\ln R_m} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = \\frac{1}{2} \\frac{\\partial (\\ln R_m)}{\\partial (\\ln R_m)} = \\frac{1}{2}\n$$\n\n$3$. 关于胞内电阻率 $R_i$ 的弹性：\n$$\n\\frac{\\partial \\ln \\lambda}{\\partial \\ln R_i} = \\frac{\\partial}{\\partial \\ln R_i} \\left[ \\frac{1}{2} \\left( \\ln a + \\ln R_m - \\ln R_i - \\ln 2 \\right) \\right] = -\\frac{1}{2} \\frac{\\partial (\\ln R_i)}{\\partial (\\ln R_i)} = -\\frac{1}{2}\n$$\n\n这些无量纲弹性值的解释是直观的。弹性 $E_x$ 近似为 $\\lambda$ 的相对变化与参数 $x$ 的微小相对变化之比：\n$$\nE_x = \\frac{\\partial \\ln \\lambda}{\\partial \\ln x} \\approx \\frac{\\Delta \\lambda / \\lambda}{\\Delta x / x}\n$$\n因此，$\\lambda$ 的相对变化约等于弹性乘以参数的相对变化：$\\frac{\\Delta \\lambda}{\\lambda} \\approx E_x \\frac{\\Delta x}{x}$。\n\n对于 $a$ 和 $R_m$ 的弹性均为 $\\frac{1}{2}$。这表明轴突半径或膜电阻的微小相对增加（例如，增加 $1\\%$）将导致长度常数相对增加约其一半（增加 $0.5\\%$）。这说明 $\\lambda$ 对 $a$ 和 $R_m$ 的变化具有中等程度的敏感性。\n\n对于 $R_i$ 的弹性为 $-\\frac{1}{2}$。这表明胞内电阻率的微小相对增加（例如，增加 $1\\%$）将导致长度常数相对减少约其一半（减少 $0.5\\%$）。负号表示一种反比关系：增加内部电阻会阻碍信号传播，从而缩短长度常数。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} \\end{pmatrix}}\n$$", "id": "2764076"}, {"introduction": "经典的电缆理论常常假设神经元是无限长的，但这只是一个理想化的简化。真实的树突和轴突都有终点，而终点的电学特性（即边界条件）会显著影响其电生理行为。这个练习 [@problem_id:2764083] 探讨了两种重要的边界条件——“封闭端”和“短路端”——如何影响在电流注入点测得的输入电阻。通过这个练习，您将理解树突的形态和连接性如何共同决定其对突触输入的响应。", "problem": "一根物理长度为 $\\ell$ 的笔直、无源、无分支的树突电缆，其稳态（直流，DC）电生理学特性可用一维空间模型来描述。设 $r_{i}$ 表示单位长度的轴向电阻（单位为 $\\Omega\\,\\text{m}^{-1}$），$r_{m}$ 表示单位长度的膜电阻（单位为 $\\Omega\\,\\text{m}$）。单位长度的膜电流为 $i_{m}(x)=V(x)/r_{m}$，轴向电流满足欧姆定律 $dV/dx=-r_{i} i_{i}(x)$。在稳态下，电流守恒意味着 $di_{i}/dx + i_{m} = 0$。长度常数定义为 $\\lambda=\\sqrt{r_{m}/r_{i}}$。\n\n在电缆的近端 $x=0$ 处注入一个恒定的直流电流 $I$。位于 $x=\\ell$ 的远端以下列两种方式之一进行端接：\n- 密封端：没有轴向电流流出，因此 $i_{i}(\\ell)=0$。\n- 短路端：远端电压被钳制在参考电位，因此 $V(\\ell)=0$。\n\n仅从上述陈述和 $\\lambda$ 的定义出发，推导每种端接方式下的直流输入电阻 $R_{\\text{in}}=\\frac{V(0)}{I}$ 的表达式。然后，使用这些表达式，确定使得两个输入电阻相差小于5%的最小无量纲长度 $\\ell/\\lambda$。计算百分比差异时，以密封端输入电阻为参考。将您的最终答案表示为一个无量纲数，并四舍五入至四位有效数字。不要包含单位。", "solution": "该问题要求在两种不同的边界条件下推导无源树突电缆的输入电阻，然后找出使这两个电阻值在指定容差范围内的最小电缆长度。整个分析将基于所提供的稳态电缆方程。\n\n首先，我们必须推导出膜电位 $V(x)$ 的控制微分方程。问题给出了以下关系：\n1.  电流守恒：$\\frac{di_{i}}{dx} + i_{m} = 0$，可写为 $\\frac{di_{i}}{dx} = -i_{m}(x)$。\n2.  膜电流：$i_{m}(x) = \\frac{V(x)}{r_{m}}$。\n3.  轴向电流（欧姆定律）：$\\frac{dV}{dx} = -r_{i} i_{i}(x)$。\n\n我们对第三个方程关于 $x$ 求导：\n$$ \\frac{d^2V}{dx^2} = -r_{i} \\frac{di_{i}}{dx} $$\n将第一个方程代入此结果，得到：\n$$ \\frac{d^2V}{dx^2} = -r_{i} (-i_{m}(x)) = r_{i} i_{m}(x) $$\n现在，代入第二个方程中的 $i_{m}(x)$：\n$$ \\frac{d^2V}{dx^2} = r_{i} \\frac{V(x)}{r_{m}} = \\frac{r_{i}}{r_{m}} V(x) $$\n问题定义了长度常数 $\\lambda = \\sqrt{r_{m}/r_{i}}$。因此，$\\frac{r_{i}}{r_{m}} = \\frac{1}{\\lambda^2}$。沿电缆的稳态电压的控制方程是一维亥姆霍兹方程，通常称为稳态电缆方程：\n$$ \\frac{d^2V}{dx^2} - \\frac{1}{\\lambda^2} V(x) = 0 $$\n这是一个二阶线性齐次常微分方程。其通解可以用双曲函数表示，这对于有限长度的电缆很方便：\n$$ V(x) = A \\cosh\\left(\\frac{x}{\\lambda}\\right) + B \\sinh\\left(\\frac{x}{\\lambda}\\right) $$\n其中 $A$ 和 $B$ 是待由边界条件确定的常数。\n\n轴向电流 $i_i(x)$ 通过对 $V(x)$ 求导得出：\n$$ i_{i}(x) = -\\frac{1}{r_{i}} \\frac{dV}{dx} = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{x}{\\lambda}\\right) + B \\cosh\\left(\\frac{x}{\\lambda}\\right) \\right] $$\n在近端 ($x=0$)，注入电流 $I$。该电流必须作为轴向电流流入电缆，因此 $i_{i}(0) = I$。\n$$ I = i_{i}(0) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh(0) + B \\cosh(0) \\right] = -\\frac{B}{r_{i}\\lambda} $$\n这给出了其中一个常数：$B = -I r_{i} \\lambda$。另一个常数 $A$ 由远端 ($x=\\ell$) 的条件确定。\n\n情况1：密封端\n边界条件为无轴向电流流出，即 $i_{i}(\\ell)=0$。\n$$ 0 = i_{i}(\\ell) = -\\frac{1}{r_{i}\\lambda} \\left[ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\right] $$\n$$ A \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\n代入 $B = -I r_{i} \\lambda$，我们得到 $A = I r_{i} \\lambda \\coth(\\ell/\\lambda)$。\n输入端的电压为 $V(0) = A \\cosh(0) + B \\sinh(0) = A$。\n密封端情况下的输入电阻 $R_{\\text{in, sealed}}$ 为：\n$$ R_{\\text{in, sealed}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\coth(\\ell/\\lambda)}{I} = r_{i} \\lambda \\coth\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\n情况2：短路端\n边界条件为零电压，即 $V(\\ell)=0$。\n$$ 0 = V(\\ell) = A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) + B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n$$ A \\cosh\\left(\\frac{\\ell}{\\lambda}\\right) = -B \\sinh\\left(\\frac{\\ell}{\\lambda}\\right) \\implies A = -B \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n代入 $B = -I r_{i} \\lambda$，我们得到 $A = I r_{i} \\lambda \\tanh(\\ell/\\lambda)$。\n输入端的电压为 $V(0) = A$。\n短路端情况下的输入电阻 $R_{\\text{in, short}}$ 为：\n$$ R_{\\text{in, short}} = \\frac{V(0)}{I} = \\frac{A}{I} = \\frac{I r_{i} \\lambda \\tanh(\\ell/\\lambda)}{I} = r_{i} \\lambda \\tanh\\left(\\frac{\\ell}{\\lambda}\\right) $$\n\n现在我们必须找出最小的无量纲长度 $L = \\ell/\\lambda$，使得两个输入电阻的差异小于5%，并以 $R_{\\text{in, sealed}}$ 为参考。该条件为：\n$$ \\frac{|R_{\\text{in, sealed}} - R_{\\text{in, short}}|}{R_{\\text{in, sealed}}}  0.05 $$\n对于任意正长度 $\\ell/\\lambda > 0$，我们有 $\\coth(\\ell/\\lambda) > 1$ 和 $0  \\tanh(\\ell/\\lambda)  1$，所以 $R_{\\text{in, sealed}} > R_{\\text{in, short}}$。绝对值是多余的。\n$$ 1 - \\frac{R_{\\text{in, short}}}{R_{\\text{in, sealed}}}  0.05 $$\n代入电阻的表达式：\n$$ 1 - \\frac{r_{i} \\lambda \\tanh(\\ell/\\lambda)}{r_{i} \\lambda \\coth(\\ell/\\lambda)}  0.05 $$\n设 $L = \\ell/\\lambda$。由于 $\\coth(L) = 1/\\tanh(L)$，表达式简化为：\n$$ 1 - \\tanh^2(L)  0.05 $$\n整理该不等式可得：\n$$ \\tanh^2(L) > 0.95 $$\n因为 $L > 0$，所以 $\\tanh(L)$ 是正数，我们可以对两边取平方根：\n$$ \\tanh(L) > \\sqrt{0.95} $$\n函数 $\\tanh(L)$ 在 $L > 0$ 时是单调递增的。对于所有大于等式成立时的值的 $L$，该条件都满足。题目要求“最小无量纲长度”，这对应于这个边界值。\n$$ L = \\arctanh\\left(\\sqrt{0.95}\\right) $$\n使用反双曲正切的对数定义，$\\arctanh(z) = \\frac{1}{2}\\ln\\left(\\frac{1+z}{1-z}\\right)$：\n$$ L = \\frac{1}{2}\\ln\\left(\\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}}\\right) $$\n为了计算数值，我们先计算对数的参数。让我们对分数进行有理化：\n$$ \\frac{1+\\sqrt{0.95}}{1-\\sqrt{0.95}} = \\frac{(1+\\sqrt{0.95})(1+\\sqrt{0.95})}{(1-\\sqrt{0.95})(1+\\sqrt{0.95})} = \\frac{1 + 2\\sqrt{0.95} + 0.95}{1 - 0.95} = \\frac{1.95 + 2\\sqrt{0.95}}{0.05} = 39 + 40\\sqrt{0.95} $$\n所以 $L$ 的表达式是：\n$$ L = \\frac{1}{2}\\ln\\left(39 + 40\\sqrt{0.95}\\right) $$\n现在我们计算其值：\n$$ \\sqrt{0.95} \\approx 0.97467943 $$\n$$ L \\approx \\frac{1}{2}\\ln\\left(39 + 40 \\times 0.97467943\\right) = \\frac{1}{2}\\ln\\left(39 + 38.9871772\\right) = \\frac{1}{2}\\ln(77.9871772) $$\n$$ L \\approx \\frac{1}{2} \\times 4.356550 \\approx 2.178275 $$\n四舍五入到四位有效数字，我们得到 $L = 2.178$。", "answer": "$$\\boxed{2.178}$$", "id": "2764083"}, {"introduction": "现代神经科学研究在很大程度上依赖于计算机模拟，这就要求我们必须能够在连续的解析模型和离散的数值模型之间建立桥梁。这个综合性练习 [@problem_id:2764063] 正是为了实现这一目标。它要求您不仅要推导出输入电阻的解析解（与前一个练习类似），还要从第一性原理出发，构建一个房室模型来数值化地再现这些结果。这是计算神经科学家的必备技能，也是对电缆理论基本原理掌握程度的终极考验。", "problem": "给定一个均匀、被动的、一维圆柱形神经突，其在直流（DC）稳态下的行为由电缆理论描述。该电缆的半径为 $a$（单位：$\\mathrm{m}$），比膜电阻为 $R_m$（单位：$\\Omega\\cdot\\mathrm{m}^2$），比胞内电阻率为 $R_i$（单位：$\\Omega\\cdot\\mathrm{m}$），长度为 $L$（单位：$\\mathrm{m}$）。在近端 $x=0$ 处注入恒定电流 $I$（单位：$\\mathrm{A}$），输入电阻 $R_{\\mathrm{in}}$ 定义为 $R_{\\mathrm{in}} = V(0)/I$，其中 $V(0)$ 是 $x=0$ 处相对于远处接地的稳态电位。\n\n您的任务是：\n- 从第一性原理出发，基于单位长度膜电阻和轴向电阻的定义以及直流电缆方程，推导：\n  1. 长度常数 $\\lambda$（用 $R_m$、$R_i$ 和 $a$ 表示）。\n  2. 在 $x=L$ 处两种不同远端边界条件下，$x=0$ 处输入电阻 $R_{\\mathrm{in}}$ 的解析表达式：\n     - 封口端（在 $x=L$ 处无轴向电流）。\n     - 短路端（在 $x=L$ 处电位钳制为零）。\n- 另外，独立地使用基尔霍夫电流定律（KCL）和均匀离散化方法，实现一个数值化的隔室模型，以近似相同的稳态解。在隔室系统中强制施加两种远端边界条件，并对每种情况数值计算 $R_{\\mathrm{in}}$。通过报告相对误差，将数值计算的 $R_{\\mathrm{in}}$ 与推导出的解析表达式进行比较。\n\n建模和实现要求：\n- 使用以下单位长度电阻的定义：\n  - 单位长度轴向电阻 $r_i = \\dfrac{R_i}{\\pi a^2}$（单位：$\\Omega/\\mathrm{m}$）。\n  - 单位长度膜电阻 $r_m = \\dfrac{R_m}{2\\pi a}$（单位：$\\Omega\\cdot\\mathrm{m}$）。\n- 将电缆离散为 $N$ 个节点，间距均匀为 $\\Delta x$，使得 $(N-1)\\Delta x = L$。为每个内部节点 $i$ 关联一个膜电导 $g_m = \\Delta x / r_m$，为每个末端节点关联一个半膜电导 $g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$。对于相邻节点之间的每个连接，使用轴向电导 $g_a = 1/(r_i \\Delta x)$。在每个节点应用 KCL，以获得节点电压的三对角线性系统。在 $x=0$ 处，将电流 $I$ 注入节点 $0$。对于 $x=L$ 处的远端边界，实现：\n  - 封口：最后一个节点之外无轴向电流（最后一个节点只有一个轴向邻居）。\n  - 短路：施加 $V(L)=0$（在最后一个节点处的狄利克雷条件）。\n- 为了保证数值精度和跨案例的可复现性，按如下方式使用推导出的 $\\lambda$ 选择空间步长：设置 $\\Delta x = \\lambda/800$ 和 $N = \\lceil L/\\Delta x \\rceil + 1$，然后重置 $\\Delta x = L/(N-1)$ 以精确覆盖电缆长度。这要求您从第一性原理计算 $\\lambda$（在您的推导中不要假设或使用任何预先给出的简化公式）。\n- 使用 $I = 1.0$（单位：$\\mathrm{A}$）。尽管中间量带有物理单位，但您最终报告的量是相对误差，是无量纲的。\n- 测试套件（参数在科学上是合理且一致的）：\n  - 所有测试的通用参数：$a = 1.0\\times 10^{-6}\\ \\mathrm{m}$，$R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$，$R_i = 1.0\\ \\Omega\\cdot\\mathrm{m}$，$I = 1.0\\ \\mathrm{A}$。\n  - 三种相对于 $\\lambda$ 指定的电缆长度：$L \\in \\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$。\n  - 对于每个 $L$，评估两种边界条件（封口和短路），并报告数值计算的 $R_{\\mathrm{in}}$ 与您从第一性原理推导的解析 $R_{\\mathrm{in}}$ 之间的相对误差。\n- 输出规范：\n  - 您的程序应生成单行输出，其中包含六个相对误差，以逗号分隔列表的形式包含在方括号中，顺序如下：\n    - $[ \\mathrm{err}_{\\mathrm{sealed}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(0.1\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(\\lambda),\\ \\mathrm{err}_{\\mathrm{sealed}}(4\\lambda),\\ \\mathrm{err}_{\\mathrm{shorted}}(4\\lambda) ]$。\n  - 每个值必须以科学记数法浮点数形式打印，小数点后保留六位数字（例如，$1.234567\\mathrm{e}{-04}$）。\n  - 这些是无量纲的量（无单位）。\n\n交付成果：\n- 一个完整的、可运行的程序，该程序：\n  1. 仅使用基本定义，根据给定的物理参数计算 $\\lambda$。\n  2. 构建并求解实现指定的封口和短路远端边界条件的三对角系统。\n  3. 从第一性原理计算两种边界条件下的解析 $R_{\\mathrm{in}}$。\n  4. 按指定的顺序和格式生成包含六个相对误差的单行输出。", "solution": "所提出的问题经过了严格的验证。\n\n### 步骤 1：提取给定信息\n- **物理参数**：圆柱形神经突半径 $a$ ($\\mathrm{m}$)，比膜电阻 $R_m$ ($\\Omega\\cdot\\mathrm{m}^2$)，比胞内电阻率 $R_i$ ($\\Omega\\cdot\\mathrm{m}$)，电缆长度 $L$ ($\\mathrm{m}$)。\n- **电学条件**：在 $x=0$ 处注入恒定电流 $I$ ($\\mathrm{A}$)。\n- **定义**：\n  - 输入电阻：$R_{\\mathrm{in}} = V(0)/I$，其中 $V(0)$ 是 $x=0$ 处的稳态电位。\n  - 单位长度轴向电阻：$r_i = \\dfrac{R_i}{\\pi a^2}$ ($\\Omega/\\mathrm{m}$)。\n  - 单位长度膜电阻：$r_m = \\dfrac{R_m}{2\\pi a}$ ($\\Omega\\cdot\\mathrm{m}$)。\n- **边界条件（解析）**：\n  - $x=L$ 处为封口端：无轴向电流，意味着 $\\frac{dV}{dx}|_{x=L}=0$。\n  - $x=L$ 处为短路端：电位钳制为零，$V(L)=0$。\n- **数值离散化**：\n  - $N$ 个节点，间距均匀为 $\\Delta x$，使得 $(N-1)\\Delta x = L$。\n  - 内部节点 ($i$) 膜电导：$g_m = \\Delta x / r_m$。\n  - 末端节点膜电导：$g_m^{\\mathrm{end}} = (\\Delta x/2)/r_m$。\n  - 相邻节点间的轴向电导：$g_a = 1/(r_i \\Delta x)$。\n  - 电流 $I$ 注入节点 $0$。\n- **数值空间步长规则**：\n  1. 从第一性原理计算 $\\lambda$。\n  2. 设置初始步长 $\\Delta x = \\lambda/800$。\n  3. 设置节点数 $N = \\lceil L/\\Delta x \\rceil + 1$。\n  4. 重新定义最终步长 $\\Delta x = L/(N-1)$。\n- **测试用例参数**：\n  - $a = 1.0\\times 10^{-6}\\ \\mathrm{m}$\n  - $R_m = 1.0\\ \\Omega\\cdot\\mathrm{m}^2$\n  - $R_i = 1.0\\ \\Omega\\cdot\\mathrm{m}$\n  - $I = 1.0\\ \\mathrm{A}$\n  - $L$ 指定为 $\\{0.1\\lambda,\\ \\lambda,\\ 4\\lambda\\}$。\n\n### 步骤 2：使用提取的给定信息进行验证\n对问题进行有效性评估。\n- **科学基础**：该问题是电缆理论的一个经典应用，而电缆理论是定量细胞电生理学的基石。所有概念、定义和方程都是标准的，并且源自电学的基本原理（欧姆定律、基尔霍夫电流定律）。这是一个教科书级别的问题，而非推测。\n- **适定性**：该问题是适定的。其解析部分涉及求解一个具有明确边界条件的二阶线性常微分方程，这保证了解的唯一性。其数值部分涉及求解一个非奇异的线性代数方程组，因此也具有唯一解。\n- **客观性**：问题以精确、客观和定量的语言陈述，没有任何主观或模棱两可的术语。\n- **完整性**：所有必需的参数、定义和模型规范都已明确提供。数值方法（隔室建模）被详细描述，包括电导的离散化和边界节点的处理。\n- **一致性**：定义和要求在内部是一致的。明确要求从第一性原理进行推导，防止依赖未声明的假设。数值方案是连续模型的已知稳健的有限差分近似。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个计算神经科学领域的标准、适定问题，正确地结合了解析推导、数值实现和验证。将提供一个解决方案。\n\n### 解析推导\n\n**1. 长度常数 $\\lambda$**\n\n我们从第一性原理开始。考虑电缆的一个长度为 $dx$ 的小段。沿该段的轴向电流变化量 $di_a$ 必须等于通过膜漏出的电流 $i_m dx$，其中 $i_m$ 是单位长度的膜电流。根据稳态下的电荷守恒：\n$$\n-di_a= i_m dx\n$$\n轴向电流 $i_a(x)$ 和膜电流 $i_m(x)$ 由欧姆定律给出：\n$$\ni_a(x) = -\\frac{1}{r_i} \\frac{dV(x)}{dx}\n$$\n$$\ni_m(x) = \\frac{V(x)}{r_m}\n$$\n其中 $V(x)$ 是位置 $x$ 处的电压。对轴向电流关于 $x$ 求导：\n$$\n\\frac{di_a}{dx} = -\\frac{1}{r_i} \\frac{d^2V(x)}{dx^2}\n$$\n将这些代入守恒定律 $-di_a/dx = i_m$：\n$$\n\\frac{1}{r_i} \\frac{d^2V(x)}{dx^2} = \\frac{V(x)}{r_m} \\implies \\frac{d^2V}{dx^2} - \\frac{r_i}{r_m} V = 0\n$$\n标准的直流电缆方程写作 $\\lambda^2 \\frac{d^2V}{dx^2} - V = 0$。通过比较，长度常数 $\\lambda$ 定义为：\n$$\n\\lambda^2 = \\frac{r_m}{r_i} \\implies \\lambda = \\sqrt{\\frac{r_m}{r_i}}\n$$\n使用给定的 $r_m$ 和 $r_i$ 基于基本参数的定义：\n$$\nr_m = \\frac{R_m}{2\\pi a} \\quad \\text{和} \\quad r_i = \\frac{R_i}{\\pi a^2}\n$$\n将这些代入 $\\lambda$ 的表达式中：\n$$\n\\lambda = \\sqrt{\\frac{R_m / (2\\pi a)}{R_i / (\\pi a^2)}} = \\sqrt{\\frac{R_m}{2\\pi a} \\cdot \\frac{\\pi a^2}{R_i}} = \\sqrt{\\frac{R_m a}{2 R_i}}\n$$\n这是对长度常数 $\\lambda$ 所需的推导。\n\n**2. 输入电阻 $R_{\\mathrm{in}}$**\n\n电缆方程 $\\lambda^2 V'' - V = 0$ 的通解是：\n$$\nV(x) = A e^{x/\\lambda} + B e^{-x/\\lambda}\n$$\n一种更便于在 $x=L$ 处应用边界条件的形式是使用以远端为中心的双曲函数。令 $y = L-x$。通解为 $V(x) = C \\cosh((L-x)/\\lambda) + D \\sinh((L-x)/\\lambda)$。轴向电流则为：\n$$\ni_a(x) = -\\frac{1}{r_i}\\frac{dV}{dx} = -\\frac{1}{r_i} \\left( -\\frac{C}{\\lambda}\\sinh\\frac{L-x}{\\lambda} - \\frac{D}{\\lambda}\\cosh\\frac{L-x}{\\lambda} \\right) = \\frac{1}{r_i\\lambda} \\left( C\\sinh\\frac{L-x}{\\lambda} + D\\cosh\\frac{L-x}{\\lambda} \\right)\n$$\n在近端 ($x=0$)，注入电流 $I$：$I = i_a(0)$。输入电阻是 $R_{\\mathrm{in}} = V(0)/I$。\n\n**情况 1：封口端**\n$x=L$ 处的边界条件是无轴向电流：$i_a(L) = 0$。\n$$\ni_a(L) = \\frac{1}{r_i\\lambda} \\left( C\\sinh(0) + D\\cosh(0) \\right) = \\frac{D}{r_i\\lambda} = 0 \\implies D=0\n$$\n解简化为 $V(x) = C \\cosh((L-x)/\\lambda)$。在 $x=0$ 处：\n$$\nV(0) = C\\cosh(L/\\lambda)\n$$\n$$\nI = i_a(0) = \\frac{1}{r_i\\lambda} \\left( C\\sinh(L/\\lambda) \\right)\n$$\n输入电阻为：\n$$\nR_{\\mathrm{in, sealed}} = \\frac{V(0)}{I} = \\frac{C\\cosh(L/\\lambda)}{C\\sinh(L/\\lambda) / (r_i\\lambda)} = r_i\\lambda \\coth(L/\\lambda)\n$$\n代入 $\\lambda = \\sqrt{r_m/r_i}$，我们得到 $R_{\\mathrm{in, sealed}} = r_i\\sqrt{r_m/r_i} \\coth(L/\\lambda) = \\sqrt{r_m r_i} \\coth(L/\\lambda)$。$\\sqrt{r_m r_i}$ 是特征阻抗 $Z_c$。\n\n**情况 2：短路端**\n$x=L$ 处的边界条件是 $V(L) = 0$。\n$$\nV(L) = C\\cosh(0) + D\\sinh(0) = C = 0\n$$\n解简化为 $V(x) = D \\sinh((L-x)/\\lambda)$。在 $x=0$ 处：\n$$\nV(0) = D\\sinh(L/\\lambda)\n$$\n$$\nI = i_a(0) = \\frac{1}{r_i\\lambda} \\left( D\\cosh(L/\\lambda) \\right)\n$$\n输入电阻为：\n$$\nR_{\\mathrm{in, shorted}} = \\frac{V(0)}{I} = \\frac{D\\sinh(L/\\lambda)}{D\\cosh(L/\\lambda) / (r_i\\lambda)} = r_i\\lambda \\tanh(L/\\lambda) = \\sqrt{r_m r_i} \\tanh(L/\\lambda)\n$$\n\n### 数值模型\n神经突被离散成 $N$ 个节点，索引为 $i=0, ..., N-1$，位于位置 $x_i = i \\Delta x$。我们在每个节点应用基尔霍夫电流定律（KCL）。\n\n- **内部节点 ($0  i  N-1$)**：流向邻居的轴向电流和膜电流之和为零。\n  $g_a(V_i - V_{i-1}) + g_a(V_i - V_{i+1}) + g_m V_i = 0 \\implies -g_a V_{i-1} + (2g_a + g_m)V_i - g_a V_{i+1} = 0$。\n- **近端节点 ($i=0$)**：注入的电流 $I$ 与流向右侧邻居的电流和通过膜的电流相平衡。\n  $g_a(V_0 - V_1) + g_m^{\\mathrm{end}} V_0 = I \\implies (g_a + g_m^{\\mathrm{end}})V_0 - g_a V_1 = I$。\n\n这些方程构成一个线性系统 $A\\mathbf{V} = \\mathbf{b}$，其中 $\\mathbf{V}=[V_0, ..., V_{N-1}]^T$。系统的最后一行取决于远端边界条件。\n\n- **封口端**：在节点 $i=N-1$ 处应用 KCL。右侧没有邻居。\n  $g_a(V_{N-1} - V_{N-2}) + g_m^{\\mathrm{end}} V_{N-1} = 0 \\implies -g_a V_{N-2} + (g_a + g_m^{\\mathrm{end}})V_{N-1} = 0$。\n  矩阵 $A$ 是三对角的。$\\mathbf{b} = [I, 0, \\dots, 0]^T$。\n- **短路端**：电压固定为 $V_{N-1}=0$。这是一个狄利克雷条件，取代了最后一个节点的 KCL 方程。系统仍求解 $V_0, ..., V_{N-1}$。\n  KCL 方程对 $i=0, \\dots, N-2$ 成立。最后一个方程就是 $V_{N-1} = 0$。\n  这导致一个矩阵 $A$，其中第 $0$ 行到第 $N-2$ 行是三对角的，最后一行是 $[0, \\dots, 0, 1]$。向量 $\\mathbf{b}$ 是 $[I, 0, \\dots, 0]^T$。\n\n求解系统 $A\\mathbf{V}=\\mathbf{b}$ 得到 $\\mathbf{V}$。由于 $I=1\\ \\mathrm{A}$，数值输入电阻为 $R_{\\mathrm{in}}^{\\mathrm{num}} = V_0/I = V_0$。然后计算相对误差为 $|R_{\\mathrm{in}}^{\\mathrm{num}} - R_{\\mathrm{in}}^{\\mathrm{ana}}| / R_{\\mathrm{in}}^{\\mathrm{ana}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the cable theory problem by deriving analytical solutions and implementing \n    a numerical compartmental model to find the input resistance of a neurite \n    under sealed and shorted boundary conditions, and computes the relative error.\n    \"\"\"\n    \n    # Common physical parameters from the problem statement\n    a = 1.0e-6  # radius (m)\n    Rm = 1.0   # specific membrane resistance (Ohm * m^2)\n    Ri = 1.0   # specific intracellular resistivity (Ohm * m)\n    I_inj = 1.0  # injected current (A)\n\n    # --- Step 1: Derive lambda and related parameters from first principles ---\n    # r_i = Ri / (pi * a^2)\n    # r_m = Rm / (2 * pi * a)\n    # lambda = sqrt(r_m / r_i) = sqrt( (Rm / (2*pi*a)) / (Ri / (pi*a^2)) )\n    # lambda = sqrt(Rm * pi * a^2 / (2 * pi * a * Ri)) = sqrt(Rm * a / (2 * Ri))\n    lambda_val = math.sqrt((Rm * a) / (2 * Ri))\n\n    # Calculate r_i and r_m which are needed for analytical and numerical solutions\n    r_i = Ri / (math.pi * a**2)\n    r_m = Rm / (2 * math.pi * a)\n    \n    # Characteristic impedance Z_c = sqrt(r_m * r_i)\n    Z_c = math.sqrt(r_m * r_i)\n\n    # Test cases for cable length as a factor of lambda\n    L_factors = [0.1, 1.0, 4.0]\n    results = []\n\n    for L_factor in L_factors:\n        # --- Step 2: Set up discretization for the current case ---\n        L = L_factor * lambda_val\n        \n        # Follow the problem's rule for determining N and dx\n        dx_initial = lambda_val / 800.0\n        if L == 0:\n            N = 1\n            dx = 0\n        else:\n            N = math.ceil(L / dx_initial) + 1\n            dx = L / (N - 1)\n        \n        if N == 1:\n            # Handle trivial case of zero-length or single-node cable\n            # Sealed: R_in is just the membrane resistance of the single compartment\n            R_in_ana_s = r_m / L if L > 0 else np.inf # Limit as L->0: inf\n            R_in_num_s = 1 / ((dx/2)/r_m) if dx > 0 else np.inf\n            # Shorted: R_in is 0 as it's shorted at x=0\n            R_in_ana_sh = 0.0\n            R_in_num_sh = 0.0\n            \n            err_s = 0.0 if np.isinf(R_in_ana_s) else abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n            err_sh = 0.0\n            results.extend([err_s, err_sh])\n            continue\n            \n        # Compartmental model parameters\n        g_a = 1.0 / (r_i * dx)\n        g_m = dx / r_m\n        g_m_end = (dx / 2.0) / r_m\n\n        # --- Case 1: Sealed End ---\n        # Analytical solution\n        R_in_ana_s = Z_c * (1.0 / math.tanh(L / lambda_val)) # coth(x) = 1/tanh(x)\n\n        # Numerical solution\n        A_s = np.zeros((N, N))\n        b_s = np.zeros(N)\n        b_s[0] = I_inj\n\n        # KCL at node 0\n        A_s[0, 0] = g_a + g_m_end\n        A_s[0, 1] = -g_a\n        # KCL at internal nodes\n        for i in range(1, N - 1):\n            A_s[i, i - 1] = -g_a\n            A_s[i, i] = 2 * g_a + g_m\n            A_s[i, i + 1] = -g_a\n        # KCL at sealed end node N-1\n        A_s[N - 1, N - 2] = -g_a\n        A_s[N - 1, N - 1] = g_a + g_m_end\n\n        V_s = np.linalg.solve(A_s, b_s)\n        R_in_num_s = V_s[0] / I_inj\n        \n        error_s = abs(R_in_num_s - R_in_ana_s) / R_in_ana_s\n        results.append(error_s)\n\n        # --- Case 2: Shorted End ---\n        # Analytical solution\n        R_in_ana_sh = Z_c * math.tanh(L / lambda_val)\n\n        # Numerical solution\n        A_sh = np.zeros((N, N))\n        b_sh = np.zeros(N)\n        b_sh[0] = I_inj\n\n        # KCL at node 0\n        A_sh[0, 0] = g_a + g_m_end\n        A_sh[0, 1] = -g_a\n        # KCL at internal nodes (up to N-2)\n        for i in range(1, N - 1):\n            A_sh[i, i - 1] = -g_a\n            A_sh[i, i] = 2 * g_a + g_m\n            A_sh[i, i + 1] = -g_a\n        # Dirichlet condition at shorted end node N-1\n        A_sh[N - 1, N - 1] = 1.0\n\n        V_sh = np.linalg.solve(A_sh, b_sh)\n        R_in_num_sh = V_sh[0] / I_inj\n        \n        error_sh = abs(R_in_num_sh - R_in_ana_sh) / R_in_ana_sh if R_in_ana_sh != 0 else 0.0\n        results.append(error_sh)\n\n    # Format and print the final output as a single line\n    formatted_results = [\"{:.6e}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2764063"}]}