{"hands_on_practices": [{"introduction": "这项实践将带你掌握蛋白质聚集动力学分析的基本方法。通过分析一个种子诱导的聚合实验数据，你将学习如何分离并量化延伸速率常数 $k_{+}$，这是控制纤维生长速度的关键参数。这个练习阐明了比较有种子和无种子反应如何为我们揭示朊病毒样传播过程中的关键动力学步骤提供重要线索 [@problem_id:2740797]。", "problem": "在错误折叠的微管相关蛋白tau（tau）的朊病毒样传播中，原纤维末端的模板化延伸将可溶性单体转化为原纤维物质。考虑一个混合均匀的反应，其中初始浓度为 $m_{0}$ 的tau单体通过两个过程聚合：产生新原纤维的初级成核作用，以及将单体添加到现有原纤维末端的延伸作用。假设没有断裂和次级成核作用。设 $m(t)$ 表示时间 $t$ 时的可溶性单体浓度，设 $P(t)$ 表示原纤维聚合物的数量浓度（每个聚合物有两个具备生长能力的末端）。根据延伸作用的质量作用动力学，由延伸引起的单体消耗速率与 $m(t)$ 和末端总数的乘积成正比。\n\n在一个未加晶种的对照实验中，在 $37\\,^{\\circ}\\mathrm{C}$ 下，消耗一半单体所需的测量半衰期 $t_{1/2,\\mathrm{unseeded}}$ 为 $20\\,\\mathrm{h}$。在一个在相同条件下进行的加晶种实验中，在 $t=0$ 时引入少量晶种浓度 $P_{0}$，因此对于所有 $t$ 都有 $P(t)\\approx P_{0}$（因为没有断裂，并且与利用预先存在的末端进行的延伸相比，初级成核作用可以忽略不计），在 $P_{0}=0.50\\,\\mathrm{nM}$（聚合物数量浓度）时，测得的半衰期为 $t_{1/2,\\mathrm{seeded}}=1.5\\,\\mathrm{h}$。将加晶种实验的半衰期视作主要由延伸作用决定，并使用质量作用动力学和质量守恒来推导估算延伸速率常数 $k_{+}$ 所需的关系式。\n\n仅使用加晶种的条件和上述假设，计算 $k_{+}$ 并以 $\\mathrm{M^{-1}\\,s^{-1}}$ 为单位表示最终答案。将答案四舍五入至三位有效数字。在计算之前，通过比较 $t_{1/2,\\mathrm{unseeded}}$ 和 $t_{1/2,\\mathrm{seeded}}$，简要说明为什么在加晶种动力学估算中忽略成核作用是合适的，但你的计算应仅基于为加晶种情况推导出的表达式。", "solution": "首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- $m(t)$：时间 $t$ 时的可溶性单体浓度。\n- $m_{0}$：初始单体浓度。\n- $P(t)$：原纤维聚合物的数量浓度。\n- 每个聚合物有两个具备生长能力的末端。\n- 由延伸引起的单体消耗速率与 $m(t)$ 和末端总数成正比（质量作用动力学）。\n- 没有断裂或次级成核作用。\n- 未加晶种的半衰期，$t_{1/2,\\mathrm{unseeded}} = 20\\,\\mathrm{h}$。\n- 加晶种的半衰期，$t_{1/2,\\mathrm{seeded}} = 1.5\\,\\mathrm{h}$。\n- 加晶种实验的初始晶种浓度，$P_{0} = 0.50\\,\\mathrm{nM}$。\n- 在加晶种实验中，对于所有 $t$，$P(t) \\approx P_{0}$。\n- 任务是计算延伸速率常数 $k_{+}$，单位为 $\\mathrm{M^{-1}\\,s^{-1}}$，并四舍五入至三位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了生物物理化学中用于分析蛋白质聚集动力学的标准成核聚合模型。该问题是适定的，提供了足够的信息来确定所求常数 $k_{+}$ 的唯一值，因为在一阶过程的半衰期推导中，未知的初始单体浓度 $m_{0}$ 会被消去。问题陈述客观，并使用了精确的术语。所提供的值对于体外聚集实验是物理上现实的。这些假设（没有断裂，没有次级成核，在加晶种情况下 $P(t) \\approx P_{0}$）是用于分离延伸过程的标准简化方法。该问题不是不适定的、矛盾的或琐碎的。\n\n**第3步：结论与行动**\n问题有效。将提供完整的解答。\n\n**解答推导**\n\n首先，我们说明在加晶种实验中忽略成核作用这一简化的合理性。在未加晶种的对照实验中，单体消耗的半衰期为 $t_{1/2,\\mathrm{unseeded}} = 20\\,\\mathrm{h}$。这个相对较长的时间尺度反映了一个受缓慢的初级成核步骤限制的过程，该步骤是产生随后可以延伸的初始原纤维所必需的。在加晶种实验中，半衰期急剧减少到 $t_{1/2,\\mathrm{seeded}} = 1.5\\,\\mathrm{h}$。这种加速（快了约 $\\frac{20}{1.5} \\approx 13.3$ 倍）表明，引入晶种（$P_{0}$）为单体消耗提供了一个比从头成核途径效率高得多的途径。由预先存在的末端进行的延伸成为主导的动力学过程。因此，在实验的时间尺度上，忽略初级成核对加晶种反应中单体消耗的贡献是合适的。\n\n现在，我们仅基于加晶种的条件进行计算。设 $k_{+}$ 为一个单体分子添加到一个原纤维末端的二级速率常数。问题陈述每个聚合物有 $2$ 个具备生长能力的末端。加晶种实验中活性末端的总浓度为 $2P(t)$。根据假设 $P(t) \\approx P_{0}$（成核和断裂可忽略不计），末端浓度是恒定的，等于 $2P_{0}$。\n\n根据质量作用动力学，单体消耗的速率与单体浓度 $m(t)$ 和活性末端浓度成正比。单体浓度的微分方程为：\n$$\n\\frac{dm(t)}{dt} = -k_{+} \\cdot m(t) \\cdot (2P_{0})\n$$\n这是一个一阶线性常微分方程。我们可以将其重新排列为：\n$$\n\\frac{dm(t)}{m(t)} = -2 k_{+} P_{0} \\, dt\n$$\n我们将此方程从时间 $t=0$ 到任意时间 $t$ 进行积分，对应的单体浓度从 $m(0) = m_{0}$ 到 $m(t)$：\n$$\n\\int_{m_{0}}^{m(t)} \\frac{1}{m'} dm' = -2 k_{+} P_{0} \\int_{0}^{t} dt'\n$$\n$$\n\\ln(m(t)) - \\ln(m_{0}) = -2 k_{+} P_{0} t\n$$\n$$\n\\ln\\left(\\frac{m(t)}{m_{0}}\\right) = -2 k_{+} P_{0} t\n$$\n求解 $m(t)$，我们得到指数衰减函数：\n$$\nm(t) = m_{0} \\exp(-2 k_{+} P_{0} t)\n$$\n半衰期 $t_{1/2,\\mathrm{seeded}}$ 是单体浓度降至其初始值一半时的时间，即 $m(t_{1/2,\\mathrm{seeded}}) = m_{0}/2$。将此代入方程中：\n$$\n\\frac{m_{0}}{2} = m_{0} \\exp(-2 k_{+} P_{0} t_{1/2,\\mathrm{seeded}})\n$$\n$$\n\\frac{1}{2} = \\exp(-2 k_{+} P_{0} t_{1/2,\\mathrm{seeded}})\n$$\n取两边的自然对数，得到：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -2 k_{+} P_{0} t_{1/2,\\mathrm{seeded}}\n$$\n$$\n-\\ln(2) = -2 k_{+} P_{0} t_{1/2,\\mathrm{seeded}}\n$$\n这就给出了半衰期和速率常数之间的直接关系：\n$$\n\\ln(2) = 2 k_{+} P_{0} t_{1/2,\\mathrm{seeded}}\n$$\n我们需要计算 $k_{+}$。重新整理表达式：\n$$\nk_{+} = \\frac{\\ln(2)}{2 P_{0} t_{1/2,\\mathrm{seeded}}}\n$$\n现在，我们代入给定值。单位必须转换为目标答案的基本单位（$\\mathrm{M}$ 和 $\\mathrm{s}$）。\n晶种浓度为 $P_{0} = 0.50\\,\\mathrm{nM} = 0.50 \\times 10^{-9}\\,\\mathrm{M}$。\n半衰期为 $t_{1/2,\\mathrm{seeded}} = 1.5\\,\\mathrm{h}$。我们将小时转换为秒：\n$$\nt_{1/2,\\mathrm{seeded}} = 1.5\\,\\mathrm{h} \\times \\frac{3600\\,\\mathrm{s}}{1\\,\\mathrm{h}} = 5400\\,\\mathrm{s}\n$$\n现在，将这些值代入 $k_{+}$ 的表达式中：\n$$\nk_{+} = \\frac{\\ln(2)}{2 \\cdot (0.50 \\times 10^{-9}\\,\\mathrm{M}) \\cdot (5400\\,\\mathrm{s})}\n$$\n$$\nk_{+} = \\frac{\\ln(2)}{(1.00 \\times 10^{-9}\\,\\mathrm{M}) \\cdot (5400\\,\\mathrm{s})}\n$$\n$$\nk_{+} = \\frac{\\ln(2)}{5.4 \\times 10^{-6}\\,\\mathrm{M \\cdot s}}\n$$\n使用值 $\\ln(2) \\approx 0.693147$：\n$$\nk_{+} \\approx \\frac{0.693147}{5.4 \\times 10^{-6}}\\,\\mathrm{M^{-1}\\,s^{-1}}\n$$\n$$\nk_{+} \\approx 128360.5\\,\\mathrm{M^{-1}\\,s^{-1}}\n$$\n$$\nk_{+} \\approx 1.283605 \\times 10^{5}\\,\\mathrm{M^{-1}\\,s^{-1}}\n$$\n将结果四舍五入至三位有效数字，我们得到：\n$$\nk_{+} = 1.28 \\times 10^{5}\\,\\mathrm{M^{-1}\\,s^{-1}}\n$$", "answer": "$$\\boxed{1.28 \\times 10^{5}}$$", "id": "2740797"}, {"introduction": "真实的实验环境充满复杂性和噪声，如何从中辨别出真正的生物学现象而非实验假象，是一项重大挑战。本练习将聚焦于鉴定蛋白质“株系”这一关键问题，指导你如何设计严谨的实验。你将探索如何利用因子设计和恰当的统计模型，来区分由蛋白质内在结构差异引起的效应和由实验方案变动所导致的变异 [@problem_id:2740712]。", "problem": "您正在使用重组人tau蛋白和α-突触核蛋白，在体外研究错误折叠蛋白质的朊病毒样传播。在一项硫黄素T (ThT) 荧光测定中，您追踪了聚集动力学，并通过一个标量动力学特征（如表观延伸速率常数或滞后期的倒数）来总结每个孔的结果，这个特征被统称为一个读数，它会随着聚集速度的加快而增加。您怀疑，样品制备参数（pH、离子强度和振荡）的变化会改变构象系综，影响成核和延伸速率，因此即使潜在的错误折叠构象异构体相同，也可能产生表观的“株系”差异。您希望设计一个实验和分析方法，以将真正的内在株系效应与实验方案引起的假象分离开来。\n\n请将您的推理建立在以下原则和事实上：\n- 朊病毒样传播涉及模板指导的构象转换，其中种子结构在淀粉样蛋白形成的多聚化方案中调节成核和延伸的速率常数。\n- 宏观读数（例如，ThT动力学）受内在构象因素（例如，种子结构）和外在物理化学条件（例如，酸性/碱性侧链的pH依赖性质子化、盐对静电相互作用的离子屏蔽，以及振荡引起的剪切诱导的断裂）共同影响。由于这些外在因素对活化自由能和有效碰撞频率有影响，在相关范围内，它们对速率常数的影响通常近似为乘积形式。\n- 需要对实验因素进行随机化、区组化和交叉，以识别效应并避免混杂，并且可以使用方差分量来量化内在效应与实验方案效应的大小。\n\n您将进行一项析因实验，该实验在多个独立制备的批次和实验室中操作pH、离子强度和振荡，并且您将在每种实验方案条件下检测多种候选“株系”（操作上定义为具有不同种子历史），并进行重复实验。\n\n问题：哪个选项最能描述一个实验设计和统计框架，它能让您（i）量化有多少表观株系变异可由实验方案差异解释，以及（ii）在校正了实验方案和批次的影响后，检验是否仍然存在内在株系效应？\n\nA. 将每个候选株系与所有实验方案组合进行完全交叉，在板内随机化孔，并包括每个实验室至少$3$个独立制备的批次和至少$2$个实验室。对动力学读数进行对数转换，并拟合一个线性混合效应模型，该模型包含株系和实验方案因素（pH、离子强度、振荡）及其交互作用的固定效应，以及批次和实验室的随机截距，例如，形式为 $y_{s,p,b,\\ell,r}=\\mu + \\alpha_{s} + \\beta_{p} + (\\alpha\\beta)_{s,p} + u_{b} + v_{\\ell} + \\varepsilon_{s,p,b,\\ell,r}$ 的模型，其中 $u_{b}\\sim \\mathcal{N}(0,\\sigma_{b}^{2})$，$v_{\\ell}\\sim \\mathcal{N}(0,\\sigma_{\\ell}^{2})$，以及 $\\varepsilon\\sim \\mathcal{N}(0,\\sigma^{2})$。使用限制性最大似然法估计方差分量，并使用似然比检验或贝叶斯后验区间来评估在校正实验方案后 $\\alpha_{s}$ 项是否仍不为零，并量化可归因于实验方案与内在株系的方差比例。\n\nB. 将每个候选株系分配给一个独特的实验方案，并为该株系固定该方案，以避免扰乱其“天然”构象。数据收集后，对每个株系的读数进行均值中心化以移除株系基线，并使用主成分分析比较各株系中心化后的轮廓以评估聚类情况。将任何剩余的株系间差异归因于内在构象效应。\n\nC. 在不同的实验中一次只改变一个实验方案因素（首先是pH，然后是离子强度，然后是振荡），同时保持其他因素不变。在每个实验中，通过$t$-检验比较各株系。最后，使用Bonferroni校正合并各实验的$p$-值，以在“控制”实验方案的同时推断内在株系效应。\n\nD. 将每个观测值除以所有运行中特定于株系的平均值来进行归一化，然后拟合一个仅包含pH和离子强度因素（忽略振荡和交互作用）的双因素方差分析，以确定实验方案是否能解释表观的株系差异。\n\nE. 在一个两阶段最小二乘法框架中，使用振荡作为株系身份的工具变量，其论点是振荡会改变动力学，但除了通过株系之外对结果没有直接影响。在第一阶段，从振荡预测株系；在第二阶段，将动力学读数对预测的株系进行回归，以估计未受实验方案污染的内在效应。\n\n选择唯一的最佳选项。", "solution": "该问题要求提供一个实验设计和统计框架，用以在一项体外蛋白质聚集测定中，区分蛋白质“株系”的内在结构效应与实验方案诱导的假象。实验涉及操作多个因素（株系身份、pH、离子强度、振荡），并考虑随机变异的来源（制备批次、实验室）。两个主要目标是（i）量化实验方案变异对观测到的动力学读数的贡献，以及（ii）在校正所有其他变异来源后，检验是否存在内在株系效应。\n\n在评估选项之前，让我们根据问题陈述建立一个正确方法应遵循的原则。\n\n1.  **消除混杂效应**：为了将一个因素（例如，株系）的效应与另一个因素（例如，pH）的效应分离开来，实验设计必须是`交叉`的。这意味着第一个因素的每个水平均必须与第二个因素的每个水平组合进行测试。如果某个特定株系只在一种特定实验方案下进行测试，那么这种设计就无法区分株系的效应和实验方案的效应。\n\n2.  **估计交互作用**：一个因素的效应可能依赖于另一个因素的水平。例如，两个株系之间的差异在低pH值时可能比在高pH值时更大。这种现象被称为`交互作用`。`全析因`设计测试所有因素水平的所有组合，是估计主效应和所有可能交互作用的最有效设计。一次只改变一个因素（OFAT）的设计无法估计交互作用。\n\n3.  **建模乘积效应**：问题陈述指出，外在因素对速率常数可能具有近似的`乘积`效应。形如 $Y = A \\times B \\times C$ 的模型可以通过取对数转换为线性的加性模型：$\\log(Y) = \\log(A) + \\log(B) + \\log(C)$。因此，应在`对数转换`后的动力学读数上进行适当的统计分析。\n\n4.  **考虑分层变异**：实验包含多个变异来源。主要关注的因素（株系、pH、离子强度、振荡）是系统控制的，最好作为`固定效应`处理。其他变异来源，如不同的制备`批次`或`实验室`，通常被视为来自一个更大的可能批次或实验室总体的随机样本。它们的影响最好用`随机效应`来建模。一个同时包含固定效应和随机效应的统计模型被称为`线性混合效应模型`。这种方法允许人们估计每个随机来源贡献的方差（例如，$\\sigma_{\\text{batch}}^2$，$\\sigma_{\\text{lab}}^2$），这对于实现目标（i）至关重要。\n\n5.  **假设检验和量化**：在线性混合效应模型框架内，可以通过评估对应于株系的固定效应项在考虑模型中所有其他项之后是否显著不为零，来检验内在株系效应的显著性（目标 ii）。这通常通过F检验或似然比检验来完成。目标（i），即量化方差，是通过分析模型估计的方差分量来实现的。\n\n基于这些原则，我们现在来评估每个选项。\n\n**A. 将每个候选株系与所有实验方案组合进行完全交叉，在板内随机化孔，并包括每个实验室至少$3$个独立制备的批次和至少$2$个实验室。对动力学读数进行对数转换，并拟合一个线性混合效应模型，该模型包含株系和实验方案因素（pH、离子强度、振荡）及其交互作用的固定效应，以及批次和实验室的随机截距，例如，形式为 $y_{s,p,b,\\ell,r}=\\mu + \\alpha_{s} + \\beta_{p} + (\\alpha\\beta)_{s,p} + u_{b} + v_{\\ell} + \\varepsilon_{s,p,b,\\ell,r}$ 的模型，其中 $u_{b}\\sim \\mathcal{N}(0,\\sigma_{b}^{2})$，$v_{\\ell}\\sim \\mathcal{N}(0,\\sigma_{\\ell}^{2})$，以及 $\\varepsilon\\sim \\mathcal{N}(0,\\sigma^{2})$。使用限制性最大似然法估计方差分量，并使用似然比检验或贝叶斯后验区间来评估在校正实验方案后 $\\alpha_{s}$ 项是否仍不为零，并量化可归因于实验方案与内在株系的方差比例。**\n\n这个选项完全符合上述原则。\n-   **实验设计**：`完全交叉`的析因设计对于分离效应和估计交互作用是最佳的。`随机化`是良好设计的一个关键原则。包含多个`批次`和`实验室`可以正确估计这些变异来源。\n-   **统计分析**：正确地提出了`对数转换`来处理乘积效应。使用`线性混合效应模型`是分析这种具有固定效应（株系、实验方案）和随机效应（批次、实验室）的分层数据结构的正确框架。所指定的模型，$y_{s,p,b,\\ell,r}=\\mu + \\alpha_{s} + \\beta_{p} + (\\alpha\\beta)_{s,p} + u_{b} + v_{\\ell} + \\varepsilon_{s,p,b,\\ell,r}$，正确地捕捉了株系的固定效应（$\\alpha_s$）、实验方案的固定效应（$\\beta_p$）、它们的交互作用（$(\\alpha\\beta)_{s,p}$），以及批次（$u_b$）和实验室（$v_\\ell$）的随机效应。使用`限制性最大似然（REML）`来估计方差分量和使用`似然比检验`来进行固定效应的假设检验是标准且合适的方法。该框架直接解决了量化方差和检验校正后株系效应的两个目标。\n-   **结论**：正确。\n\n**B. 将每个候选株系分配给一个独特的实验方案，并为该株系固定该方案，以避免扰乱其“天然”构象。数据收集后，对每个株系的读数进行均值中心化以移除株系基线，并使用主成分分析比较各株系中心化后的轮廓以评估聚类情况。将任何剩余的株系间差异归因于内在构象效应。**\n\n这个选项存在根本性缺陷。\n-   **实验设计**：将每个株系分配给一个独特的实验方案，在株系效应和实验方案效应之间引入了完全的`混杂`。这使得无法确定观察到的差异是由株系还是其独特的实验方案引起的。保护“天然”构象的前提是错误的；科学问题恰恰是表征株系在一定条件范围内的行为。\n-   **统计分析**：均值中心化和主成分分析（PCA）是探索性技术，无法解决混杂问题。PCA会发现数据中的变异模式，但无法将其归因于特定的混杂来源。\n-   **结论**：不正确。\n\n**C. 在不同的实验中一次只改变一个实验方案因素（首先是pH，然后是离子强度，然后是振荡），同时保持其他因素不变。在每个实验中，通过$t$-检验比较各株系。最后，使用Bonferroni校正合并各实验的$p$-值，以在“控制”实验方案的同时推断内在株系效应。**\n\n这个选项描述了一种次优方法。\n-   **实验设计**：“一次只改变一个因素”（OFAT）的设计效率低下，而且关键是`无法估计`实验方案因素之间的`交互作用`（例如，pH和离子强度之间）。系统的真实行为可能取决于这种交互作用。\n-   **统计分析**：分析是零碎的，依赖于一系列`t-检验`。这远不如一个单一、统一的模型强大，后者可以利用整个数据集的信息。合并$p$-值是一种粗糙的证据组合方法，不允许估计效应大小或方差分量，因此未能满足目标（i）。\n-   **结论**：不正确。\n\n**D. 将每个观测值除以所有运行中特定于株系的平均值来进行归一化，然后拟合一个仅包含pH和离子强度因素（忽略振荡和交互作用）的双因素方差分析，以确定实验方案是否能解释表观的株系差异。**\n\n这个选项在其数据处理和建模方面存在缺陷。\n-   **数据处理**：通过特定于株系的平均值进行归一化，在分析前人为地从数据中移除了株系的主效应，而这正是我们想要估计的。这会扭曲数据的方差结构，并可能使后续的统计检验无效。\n-   **统计分析**：双因素方差分析（ANOVA）是一个不完整的模型。它`忽略了振荡`这一指定的实验因素。它`忽略了交互作用`。最重要的是，它不是一个混合效应模型，因此未能正确考虑`批次`和`实验室`的随机效应。忽略这些随机效应会将所有测量值视为独立的，但它们并非独立，这会导致伪重复和可能的假阳性发现。\n-   **结论**：不正确。\n\n**E. 在一个两阶段最小二乘法框架中，使用振荡作为株系身份的工具变量，其论点是振荡会改变动力学，但除了通过株系之外对结果没有直接影响。在第一阶段，从振荡预测株系；在第二阶段，将动力学读数对预测的株系进行回归，以估计未受实验方案污染的内在效应。**\n\n这个选项反映了对所提技术和基础科学的严重误解。\n-   **框架**：工具变量（IV）方法要求“工具”只通过目标变量影响结果。`振荡除了通过株系外对结果没有直接影响`这一前提在事实上是不正确的。问题描述和基础生物物理学表明，振荡（剪切力）对纤维断裂有直接且强烈的影响，从而影响聚集速率，这与具体株系无关。这违反了IV分析的核心“排他性限制”假设。此外，人们不能从像振荡这样的物理参数来“预测”像株系这样实验指定的类别。该技术的应用不合逻辑。\n-   **结论**：不正确。\n\n总之，选项A描述了唯一在方法上合理且全面的方法，它正确地应用了实验设计和统计建模的原则，以满足既定目标。", "answer": "$$\\boxed{A}$$", "id": "2740712"}, {"introduction": "为了理解神经退行性疾病，我们必须将在体外观察到的分子行为与体内的病理过程联系起来。这项综合实践将指导你建立一个描述tau蛋白病理在脑内扩散的计算模型，该模型基于转运和复制两个核心过程。通过将此模型与来自小鼠模型的假设数据进行拟合，你将学习如何估算关键的体内参数，从而将微观过程与宏观的疾病进展联系起来 [@problem_id:2740804]。", "problem": "考虑一个用于tau P301S小鼠品系中错误折叠蛋白质聚集体朊病毒样传播的最小机理模型，重点研究由近似线性、有向的轴突束连接的下游区域。假设以下基本依据，这些依据在细胞和分子神经科学中被广泛用于聚集体传播模型：\n\n- 局部聚集体扩增遵循一级质量作用动力学，因此，在一个区域内，当一个种子到达后，聚集体数量 $A(t)$ 遵循 $\\frac{dA}{dt} = k_r A$，其中 $k_r$ 是有效复制速率常数（单位为 $\\text{week}^{-1}$）。\n- 沿长度为 $\\ell$ 的轴突束的有效有向轴突运输以近似恒定的有效速度 $v$ （单位为 $\\text{mm}/\\text{week}$）发生，因此平均到达时间等于穿越该束的行程时间。\n\n令 $A_0$ 表示到达下游区域瞬间的聚集体数量，并令 $A_\\theta$ 表示一个固定的检测阈值，在该阈值下病理首次被记为存在。观察到的病理发作时间 $t_{\\text{onset}}$ 是从源区域播种到下游区域首次达到 $A_\\theta$ 所经过的时间。\n\n任务：\n\n1. 从上述两个基本依据和标准微积分出发，推导连接 $t_{\\text{onset}}$、$\\ell$、$v$、$k_r$、$A_0$ 和 $A_\\theta$ 的关系式。您的推导应明确区分运输时间和局部复制时间。\n2. 证明该关系式可以表示为关于束长度 $\\ell$ 的线性模型 $t_{\\text{onset}} = s\\,\\ell + c$，并用 $v$、$k_r$、$A_0$ 和 $A_\\theta$ 表示 $s$ 和 $c$。\n3. 设计一个算法，在给定数据 $\\{(\\ell_i, t_i)\\}_{i=1}^n$ 以及已知的 $A_0$ 和 $A_\\theta$ 的情况下，通过将线性模型与数据进行最小二乘拟合来估计 $v$ 和 $k_r$。您的算法应：\n   - 通过最小化 $\\sum_i (t_i - s\\,\\ell_i - c)^2$ 来估计斜率 $s$ 和截距 $c$。\n   - 从 $s$ 和 $c$ 中恢复 $v$ 和 $k_r$。\n   - 确保单位得到正确处理，使得 $v$ 的单位是 $\\text{mm}/\\text{week}$，$k_r$ 的单位是 $\\text{week}^{-1}$。\n\n实现要求：\n\n- 实现一个程序，使用线性化模型上的普通最小二乘法，为下面提供的每个测试用例求解 $v$ 和 $k_r$。对任何对数量使用自然对数。\n- $v$ 和 $k_r$ 的最终数值答案必须四舍五入到三位小数。\n- 您的程序必须生成单行输出，包含以逗号分隔的列表的列表形式的结果，不含多余空格，格式为 \"[[v1,kr1],[v2,kr2],...]\"，其中每个值都是四舍五入到三位小数的浮点数。\n\n测试套件（所有时间单位为周，长度单位为毫米，$A_0$ 和 $A_\\theta$ 的浓度单位任意但相同，因此它们的比率是无量纲的）：\n\n- 案例1（一般情况；多种长度）：\n  - $\\ell = [1.0, 2.0, 4.0, 6.0]$\n  - $t = [17.8095238095, 18.4761904762, 19.8095238095, 21.1428571429]$\n  - $A_0 = 1.0$, $A_\\theta = 162754.79141900392$\n- 案例2（边界包括零长度目标区域）：\n  - $\\ell = [0.0, 3.0, 10.0]$\n  - $t = [7.5, 9.0, 12.5]$\n  - $A_0 = 1.0$, $A_\\theta = 8103.083927575384$\n- 案例3（更长的束长度）：\n  - $\\ell = [2.5, 5.0, 12.5]$\n  - $t = [25.125, 28.25, 37.625]$\n  - $A_0 = 1.0$, $A_\\theta = 59874.14171519782$\n\n答案要求：\n\n- 以 $\\text{mm}/\\text{week}$ 为单位表示 $v$，以 $\\text{week}^{-1}$ 为单位表示 $k_r$。\n- 两者均四舍五入到三位小数。\n- 输出格式必须是单行字符串，形式为 \"[[v1,kr1],[v2,kr2],[v3,kr3]]\"，任何地方都不能有空格。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 局部聚集体扩增动力学：$\\frac{dA}{dt} = k_r A$，其中 $k_r$ 是复制速率常数，单位为 $\\text{week}^{-1}$。\n- 轴突运输模型：沿长度为 $\\ell$ 的束以恒定的有效速度 $v$（单位为 $\\text{mm}/\\text{week}$）运输。平均到达时间为行程时间 $\\ell/v$。\n- 到达时的聚集体数量（复制的初始条件）：$A_0$。\n- 病理检测阈值：$A_\\theta$。\n- 病理发作时间：$t_{\\text{onset}}$，从源播种到下游区域的聚集体数量达到 $A_\\theta$ 的总时间。\n- 用于拟合的数据：一组 $n$ 个测量值 $\\{(\\ell_i, t_i)\\}_{i=1}^n$。\n- 目标：\n    1.  推导 $t_{\\text{onset}}$ 关于 $\\ell$、$v$、$k_r$、$A_0$ 和 $A_\\theta$ 的表达式。\n    2.  证明此关系是一个线性模型 $t_{\\text{onset}} = s\\,\\ell + c$，并找出 $s$ 和 $c$ 的表达式。\n    3.  设计一个最小二乘算法，根据数据估计 $v$ 和 $k_r$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学基础**：问题有效。它采用了一个标准的简化模型来描述错误折叠蛋白质聚集体的传播，这是研究阿尔茨海默病和帕金森病等神经退行性疾病的核心课题。一级复制动力学和恒速运输的假设是此类模型的常见且合理的出发点。\n- **良构性**：问题有效。它结构清晰，有明确的变量、显式的假设，以及一系列导向具体计算目标的任务。推导和参数估计都可获得唯一解。\n- **客观性**：问题有效。语言精确、技术性强，不含任何主观或非科学内容。\n\n**步骤3：结论与行动**\n问题有效。这是一个在定量生物建模方面构思良好的练习，基于生物物理学和数据分析的既定原则。我将继续进行解答。\n\n---\n\n**1. 发作时间关系的推导**\n\n病理的总发作时间 $t_{\\text{onset}}$ 是两个不同顺序过程的时间总和：初始种子从源头传播到下游区域所需的时间（运输时间，$t_{\\text{transport}}$），以及随后局部聚集体群体从其初始种子数量扩增到检测阈值所需的时间（复制时间，$t_{\\text{replication}}$）。\n\n$$t_{\\text{onset}} = t_{\\text{transport}} + t_{\\text{replication}}$$\n\n根据问题陈述，沿长度为 $\\ell$ 的轴突束以有效速度 $v$ 进行的运输过程给出的运输时间为：\n$$t_{\\text{transport}} = \\frac{\\ell}{v}$$\n\n局部复制过程由一级动力学方程控制：\n$$\\frac{dA}{dt} = k_r A(t)$$\n这里的 $t$ 代表自种子到达后经过的时间。这是一个可分离的常微分方程。我们用初始条件来求解它，即在到达时刻（$t=0$），聚集体数量为 $A(0) = A_0$。\n\n$$\\int_{A_0}^{A(t')} \\frac{dA}{A} = \\int_{0}^{t'} k_r dt$$\n$$[\\ln A]_{A_0}^{A(t')} = [k_r t]_{0}^{t'}$$\n$$\\ln(A(t')) - \\ln(A_0) = k_r t'$$\n$$\\ln\\left(\\frac{A(t')}{A_0}\\right) = k_r t'$$\n\n求解聚集体数量 $A(t')$ 作为时间函数：\n$$A(t') = A_0 e^{k_r t'}$$\n\n复制时间 $t_{\\text{replication}}$ 是聚集体数量 $A(t')$ 达到检测阈值 $A_\\theta$ 的时间 $t'$。我们设 $A(t_{\\text{replication}}) = A_\\theta$：\n$$A_\\theta = A_0 e^{k_r t_{\\text{replication}}}$$\n\n我们求解 $t_{\\text{replication}}$：\n$$\\frac{A_\\theta}{A_0} = e^{k_r t_{\\text{replication}}}$$\n两边取自然对数：\n$$\\ln\\left(\\frac{A_\\theta}{A_0}\\right) = k_r t_{\\text{replication}}$$\n$$t_{\\text{replication}} = \\frac{1}{k_r} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$$\n\n结合 $t_{\\text{transport}}$ 和 $t_{\\text{replication}}$ 的表达式，我们得到 $t_{\\text{onset}}$ 的完整关系式：\n$$t_{\\text{onset}} = \\frac{\\ell}{v} + \\frac{1}{k_r} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$$\n\n**2. 模型的线性化**\n\n推导出的关系式可以重新排列，以突出其对束长度 $\\ell$ 的依赖性：\n$$t_{\\text{onset}} = \\left(\\frac{1}{v}\\right)\\ell + \\frac{1}{k_r} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$$\n\n这个表达式是标准线性形式 $y = mx + b$，或者如问题中所述，$t_{\\text{onset}} = s\\,\\ell + c$。通过直接比较，我们可以确定斜率 $s$ 和y轴截距 $c$：\n\n斜率 $s$ 是 $\\ell$ 的系数：\n$$s = \\frac{1}{v}$$\n\n截距 $c$ 是常数项，代表零长度束（$\\ell=0$）的发作时间：\n$$c = \\frac{1}{k_r} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$$\n\n**3. 参数估计算法**\n\n给定一个包含 $n$ 对观测到的束长度和发作时间的数据集 $\\{(\\ell_i, t_i)\\}_{i=1}^n$，以及已知的常数 $A_0$ 和 $A_\\theta$，我们可以估计物理参数 $v$ 和 $k_r$。\n\n该算法流程如下：\n\n- **步骤1：估计斜率（$s$）和截距（$c$）。**\n我们使用普通最小二乘法（OLS）将线性模型 $t_i = s\\,\\ell_i + c$ 拟合到数据。这涉及找到使残差平方和 $SSR = \\sum_{i=1}^n (t_i - (s\\,\\ell_i + c))^2$ 最小化的 $s$ 和 $c$ 的值。\nOLS的标准解析解是：\n$$s = \\frac{n \\sum_{i=1}^n \\ell_i t_i - (\\sum_{i=1}^n \\ell_i)(\\sum_{i=1}^n t_i)}{n \\sum_{i=1}^n \\ell_i^2 - (\\sum_{i=1}^n \\ell_i)^2}$$\n$$c = \\bar{t} - s\\bar{\\ell}$$\n其中 $\\bar{t} = \\frac{1}{n}\\sum_{i=1}^n t_i$ 和 $\\bar{\\ell} = \\frac{1}{n}\\sum_{i=1}^n \\ell_i$。在实践中，这些估计值是使用标准数值库获得的。\n\n- **步骤2：恢复物理参数（$v$ 和 $k_r$）。**\n一旦统计参数 $s$ 和 $c$ 被估计出来，我们反转前一节中推导的关系式来求得物理参数。\n\n从 $s = \\frac{1}{v}$，有效运输速度 $v$ 是：\n$$v = \\frac{1}{s}$$\n单位是一致的：如果 $s$ 的单位是 $\\text{week}/\\text{mm}$，那么 $v$ 的单位是 $\\text{mm}/\\text{week}$。\n\n从 $c = \\frac{1}{k_r} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$，有效复制速率常数 $k_r$ 是：\n$$k_r = \\frac{1}{c} \\ln\\left(\\frac{A_\\theta}{A_0}\\right)$$\n单位是一致的：如果 $c$ 的单位是 $\\text{weeks}$，且对数项是无量纲的，那么 $k_r$ 的单位是 $\\text{week}^{-1}$。\n\n这样就完成了算法的设计。只要 $s \\neq 0$ 和 $c \\neq 0$，该算法就是稳健的。考虑到问题的物理性质，即病理随时间传播，我们预期 $s  0$ 和 $c  0$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the effective transport velocity (v) and replication rate (k_r)\n    for a series of test cases based on a linearized model of prion-like propagation.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"l\": np.array([1.0, 2.0, 4.0, 6.0]),\n            \"t\": np.array([17.8095238095, 18.4761904762, 19.8095238095, 21.1428571429]),\n            \"A0\": 1.0,\n            \"A_theta\": 162754.79141900392\n        },\n        {\n            \"l\": np.array([0.0, 3.0, 10.0]),\n            \"t\": np.array([7.5, 9.0, 12.5]),\n            \"A0\": 1.0,\n            \"A_theta\": 8103.083927575384\n        },\n        {\n            \"l\": np.array([2.5, 5.0, 12.5]),\n            \"t\": np.array([25.125, 28.25, 37.625]),\n            \"A0\": 1.0,\n            \"A_theta\": 59874.14171519782\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        ell = case[\"l\"]\n        t_onset = case[\"t\"]\n        A0 = case[\"A0\"]\n        A_theta = case[\"A_theta\"]\n\n        # Step 1: Estimate slope (s) and intercept (c) using OLS.\n        # np.polyfit with deg=1 performs a linear least-squares fit.\n        # It returns coefficients [slope, intercept].\n        s, c = np.polyfit(ell, t_onset, 1)\n\n        # Step 2: Recover physical parameters v and k_r from s and c.\n        \n        # Velocity v is the reciprocal of the slope s.\n        # s is in week/mm, so v is in mm/week.\n        v = 1.0 / s\n\n        # Replication rate k_r is derived from the intercept c.\n        # c is in weeks, log term is dimensionless, so k_r is in week^-1.\n        # np.log is the natural logarithm.\n        k_r = np.log(A_theta / A0) / c\n        \n        # Round the final values to three decimal places as required.\n        v_rounded = round(v, 3)\n        k_r_rounded = round(k_r, 3)\n\n        results.append([v_rounded, k_r_rounded])\n\n    # Final print statement must produce a single line in the exact specified format.\n    # The str() representation of a list of lists is '[[...], [...]]',\n    # so we remove spaces to match the required format \"[[...],[...]]\".\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2740804"}]}