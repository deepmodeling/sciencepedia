## 引言
空间转录组学正以前所未有的分辨率揭示大脑的[分子结构](@entry_id:140109)，为理解其复杂功能和疾病机制带来了革命。传统的[基因表达分析](@entry_id:138388)方法，如[单细胞RNA测序](@entry_id:142269)，虽然能提供精细的细胞分型，却以牺牲所有空间信息为代价，使得我们无法将分子发现置于其原生组织环境中。这种分子信息与生理结构的分离，构成了理解大脑组织原则的一个核心知识鸿沟。

本文旨在系统性地阐述如何利用[空间转录组学](@entry_id:270096)绘制大[脑基因表达图谱](@entry_id:195209)。我们将带领读者踏上一段从原理到应用的旅程。在“原理与机制”一章中，我们将深入剖析该技术的核心机制，解释空间信息如何被捕获、量化和建模。接着，在“应用与跨学科连接”一章中，我们将展示这项技术如何在神经解剖学、多模态整合和疾病研究等领域发挥强大作用。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为解决实际问题的能力。让我们一同开启探索大脑空间分子世界的旅程。

## 原理与机制

[空间转录组学](@entry_id:270096)作为一个强大的领域，其核心在于能够在完整的组织背景下测量基因表达，从而将分子信息映射回其生理结构。本章将深入探讨支撑这一能力的基本原理和核心技术机制，阐明[空间转录组学](@entry_id:270096)数据是如何生成、量化并最终转化为生物学见解的。我们将从根本上区分空间分辨方法与传统方法的不同之处，剖析两种主要的技术[范式](@entry_id:161181)，并介绍数据分析中的关键概念。

### 空间信息的保留：[空间转录组学](@entry_id:270096)的本质

任何转录组学研究的起点都是组织内的信使RNA（mRNA）分子，每个分子都位于其原始细胞内的特定物理坐标 $\mathbf{X}$ 处。空间转录组学的定义性特征是，在测量基因表达的同时，保留了这些坐标信息。这与传统的解离式[单细胞RNA测序](@entry_id:142269)（scRNA-seq）形成了根本性的对比。

![图 1](https://cdn.jsdelivr.net/gh/jiang-taibai/images/202407232230193.png)

在scRNA-seq工作流程中，组织被酶解成单个细胞的悬浮液。这个过程，特别是随后的彻底混合步骤，不可逆地破坏了所有细胞间的空间邻近关系。当一个细胞被捕获并分配一个[细胞条形码](@entry_id:171163) $C$ 时，这个条形码与细胞的原始位置 $\mathbf{X}$ 是统计上独立的。用信息论的语言来说，$\mathbf{X}$ 和 $C$ 之间的互信息为零，即 $I(\mathbf{X};C)=0$。这意味着关于原始空间位置的信息在测量过程中完全丢失了。[@problem_id:2753072]

相比之下，空间转录组学技术的设计初衷就是为了保留这种信息。它们通过一种原位（*in situ*）捕获或检测策略来实现这一目标。在基于阵列的捕获技术中，mRNA分子从其原始位置 $\mathbf{X}$ [扩散](@entry_id:141445)一段有限的距离，被一个具有已知物理坐标和独特[空间条形码](@entry_id:267996) $B$ 的捕获点捕获。由于[扩散](@entry_id:141445)距离受物理和化学条件的限制（例如，在一个半径 $\rho$ 内），条形码 $B$ 因此成为位置 $\mathbf{X}$ 的一个高度相关的函数。这在条形码和原始坐标之间建立了非零的互信息，$I(\mathbf{X};B)>0$，从而保留了空间信息。[@problem_id:2753072] 简而言之，[空间条形码](@entry_id:267996)作为一个外部施加的[坐标系统](@entry_id:156346)，将测序读段锚定回组织中的特定位置，这是scRNA-seq所不具备的。[@problem_id:2753072]

### 主要技术[范式](@entry_id:161181)

目前，[空间转录组学](@entry_id:270096)领域主要由两大类技术驱动：基于阵列的捕获方法和基于成像的原位方法。它们在分辨率、通量和分子信息的完整性方面做出了不同的权衡。[@problem_id:2752954]

#### 基于阵列的捕获

这类技术，如10x Genomics的Visium平台，依赖于一个预先图案化的表面（通常是玻璃载玻片），上面布满了成千上万个微小的捕获“点”（spot）。

**核心机制：**
1.  **[空间条形码](@entry_id:267996)（Spatial Barcodes）**：每个捕获点上都预先合成了数百万个寡[核苷酸](@entry_id:275639)捕获探针。同一捕获点内的所有探针共享一个独特的、标识该点位置的[核苷酸](@entry_id:275639)序列，这就是**[空间条形码](@entry_id:267996)**。不同捕获点的[空间条形码](@entry_id:267996)则各不相同。制造商提供一个查找表，将每个条形码序列 $b$ 映射到其在二维平面上的物理坐标 $f(b) \in \mathbb{R}^2$。[@problem_id:2752904]
2.  **mRNA捕获与[逆转录](@entry_id:141572)**：将组织切片放置在阵列上并进行透化处理后，细胞内的mRNA分子会释放出来。这些mRNA分子通常带有[poly(A)尾](@entry_id:274750)巴，它们通过[沃森-克里克碱基配对](@entry_id:275890)（A-T）与捕获探针上的poly(dT)序列杂交。随后，以捕获探针为引物进行[逆转录](@entry_id:141572)，合成互补DNA（cDNA）。这个过程将[空间条形码](@entry_id:267996)以及一个用于分子计数的**[唯一分子标识符](@entry_id:192673)（UMI）**（详见后文）共价连接到新生成的cDNA分子上。
3.  **测序与映射**：收集所有cDNA分子，进行扩增和高通量测序。在数据分析阶段，从每个测序读段中提取出[空间条形码](@entry_id:267996)序列。通过与已知的条形码集合 $B$ 进行比对（通常允许少量测序错误的汉明距离校正），可以识别出该cDNA分子来源于哪个捕获点。最后，利用映射函数 $f$ 将基因表达计数归位到其空间坐标上。[@problem_id:2752904]

**特点与权衡**：
*   **通量**：由于依赖于[下一代测序](@entry_id:141347)（NGS），这种方法在基因覆盖面上是无偏的，能够捕获并量化组织中几乎所有带[poly(A)尾](@entry_id:274750)的转录本，实现**转录组范围**的覆盖。
*   **分辨率**：空间分辨率受到捕获点物理尺寸的根本限制。在当前商用平台中，捕获点直径通常为数十微米（例如，$\sim 55 \, \mu\mathrm{m}$），这通常大于单个哺乳[动物细胞](@entry_id:265562)的尺寸。因此，每个点测量的是多个细胞基因表达的**混合信号**。
*   **分子完整性**：标准的poly(dT)捕获策略主要捕获mRNA的$3'$端，提供基于标签的计数，这使得区分在基因主体或$5'$端存在差异的不同转录本亚型变得困难。[@problem_id:2752954]

#### [原位杂交](@entry_id:173572)与测序

另一类方法，包括[单分子荧光原位杂交](@entry_id:180372)（[smFISH](@entry_id:180372)）及其高度[多路复用](@entry_id:266234)的变体（如[MERFISH](@entry_id:191159), seqFISH）和原位测序（ISS），直接在固定的组织内对RNA分子进行成像。

**核心机制（以使用锁式探针和滚环扩增的原位测序为例）：**
1.  **锁式探针（Padlock Probes）**：这是一种精巧设计的[单链DNA](@entry_id:162691)探针，其两端（“臂”）分别与目标cDNA上的两个相邻序列互补。
2.  **特异性连接**：只有当探针的两个臂都与目标cDNA完美杂交，使其两端精确地并置在一起时，[DNA连接酶](@entry_id:139273)才能将探针的两端连接起来，形成一个闭合的DNA环。这个连接步骤对序列匹配要求极高，确保了高度的检测特异性。[@problem_id:2752974]
3.  **滚环扩增（Rolling Circle Amplification, RCA）**：连接成环后，以该环为模板，利用一种具有链[置换](@entry_id:136432)活性的[DNA聚合酶](@entry_id:147287)（如Phi29聚合酶）进行等温扩增。聚合酶会绕着环状模板一圈又一圈地合成，产生一条由数百个模板重复序列组成的长长的[单链DNA](@entry_id:162691)，称为滚环产物（RCP）。
4.  **信号定位与读出**：至关重要的是，RCP在合成过程中通过[引物](@entry_id:192496)物理锚定在原位，并卷曲成一个紧凑的纳米球结构，其大小和共价连接限制了其[扩散](@entry_id:141445)。这就在原始转录本的位置上产生了一个明亮的、可被显微镜检测到的荧光信号点。随后，通过多轮荧光化学反应（如连接测序或合成测序）对这些信号点进行迭代成像，逐个碱基进行序列读出。[@problem_id:2752974]

**特点与权衡**：
*   **分辨率**：这类方法的分辨率由光学衍射极限决定，可达到约$\sim 200-300 \, \mathrm{nm}$。这使得它们能够定位单个mRNA分子，实现**亚细胞级别**的分辨率。
*   **通量**：这些方法是**靶向**的，需要预先设计和合成针对特定基因集的探针。尽管先进技术已能同时检测数千乃至上万个基因，但这仍然不是转录组范围的。此外，对大面积组织进行高分辨率成像非常耗时，限制了全组织尺度的通量。[@problem_id:2752954]

### 从分子到数据：量化、统计与质量控制

将物理世界中的分子转化为可供分析的数字矩阵，需要精确的量化方法、恰当的[统计模型](@entry_id:165873)以及对实验变量的严格控制。

#### 使用[唯一分子标识符](@entry_id:192673)（UMI）进行精确计数

在所有基于测序的[转录组学](@entry_id:139549)方法中，PCR扩增是必要的步骤，但它会引入偏差——一些分子可能被扩增数千次，而另一些则很少。这会导致原始分子数量的严重失真。**[唯一分子标识符](@entry_id:192673)（UMI）**是解决这个问题的关键。[@problem_id:2753044]

UMI是一段短的（例如，$L=10$个[核苷酸](@entry_id:275639)）、随机生成的DNA序列。它在[逆转录](@entry_id:141572)过程中、任何扩增步骤**之前**被添加到每个cDNA分子的末端。这样，每个原始的mRNA分子就被打上了一个独特的标签。在PCR扩增过程中，源自同一个原始分子的所有副本都将携带相同的UMI。测序后，分析软件会将具有相同[空间条形码](@entry_id:267996)、相同基因比对结果和相同UMI的读段归为一组，并只计数一次。这个“去重”过程可以消除PCR扩增偏差带来的影响，从而得到对原始捕获分子数的更准确估计。

UMI的有效性依赖于UMI[序列空间](@entry_id:153584)的巨大。对于一个长度为 $L$ 的UMI，使用4种[核苷酸](@entry_id:275639)，总共存在 $N = 4^L$ 种可能的序列。例如，当 $L=10$ 时，有 $4^{10} \approx 1.05 \times 10^6$ 种可能的UMI。在一个典型的捕获点，如果捕获了某个基因的 $m=600$ 个mRNA分子，由于 $m \ll N$，两个不同的原始分子被偶然分配到相同UMI（即“UMI碰撞”）的概率极低。因此，去重后得到的独特UMI数量约等于原始分子数 $m=600$。值得注意的是，UMI校正的是**扩增偏差**，但无法校正上游步骤（如mRNA捕获或[逆转录](@entry_id:141572)效率）中的偏差。[@problem_id:2753044]

#### 空间转录组数据的统计特性

空间转录组学实验的产出是一个基因×空间位置的**计数矩阵**。正确地为这些计数[数据建模](@entry_id:141456)是所有下游分析的基础。

*   **[泊松分布](@entry_id:147769)（Poisson Model）**：作为[计数过程](@entry_id:260664)的基线模型，泊松分布假设事件（如UMI计数）以一个恒定的速率 $\mu$ 独立发生。其一个关键特征是均值等于[方差](@entry_id:200758)，即 $\mathbb{E}[X] = \mathrm{Var}(X) = \mu$。然而，在生物数据中，这种假设很少成立。[@problem_id:2752901]

*   **过度分散与负二项分布（Overdispersion and Negative Binomial Model）**：在空间[转录组](@entry_id:274025)数据中，我们通常观察到[方差](@entry_id:200758)远大于均值的现象，这被称为**过度分散**。这源于生物学和技术上的[异质性](@entry_id:275678)，例如细胞状态的内在变异或捕获效率的微小差异。**负二项（NB）[分布](@entry_id:182848)**是处理过度分散数据的标准模型。它可以被看作是一个Gamma-Poisson混合模型，其[方差](@entry_id:200758)是均值的二次函数：$\mathrm{Var}(X) = \mu + \alpha\mu^2$，其中 $\alpha > 0$ 是分散参数。当 $\alpha \to 0$ 时，NB[分布](@entry_id:182848)收敛于泊松分布。通过对实际数据进行检验，例如比较样本[方差](@entry_id:200758) $s^2$ 和样本均值 $\bar{x}$，我们通常可以显著地拒绝泊松模型，而支持负[二项模型](@entry_id:275034)。例如，对于一组观测数据，如果计算出的均值为 $\bar{x}=2.5$ 而[方差](@entry_id:200758)为 $s^2 \approx 7.73$，则[方差](@entry_id:200758)远大于均值，表明存在显著的过度分散，N[B模型](@entry_id:159413)是更合适的选择。[@problem_id:2752901]

*   **零膨胀（Zero-Inflation）**：空间数据中经常出现大量的零值。这些零值可能源于“采样性零”（即基因表达水平低，偶然未被捕获到）或“结构性零”（即该基因在该位置确实不表达，或由于技术原因完全捕获失败）。当零值的比例超过了标准NB[分布](@entry_id:182848)所能解释的范围时，就需要使用**[零膨胀模型](@entry_id:756817)**（如[零膨胀负二项模型](@entry_id:756826)，ZINB）。然而，在许多情况下，N[B模型](@entry_id:159413)本身就能很好地解释观测到的零值比例，因此在选择更复杂的模型之前，应先进行检验。[@problem_id:2752901]

#### 实验前因素与[数据质量](@entry_id:185007)

[空间转录组学](@entry_id:270096)实验的成功在很大程度上取决于起始样本的质量。RNA是一种相对不稳定的分子，其完整性至关重要。

*   **RNA完整性数（RIN）**：**RNA完整性数**是一个从1到10的评分，用于量化RNA的降解程度。它通过分析总RNA（主要是核糖体RNA, rRNA）的电泳图谱得出。完整的RNA会显示出清晰的18S和28S rRNA峰，RIN值接近10；而降解的RNA则表现为这些峰的消失和低分子量片段“涂抹”的增加，RIN值较低。[@problem_id:2752965]

*   **死后间隔（Postmortem Interval, PMI）**：PMI是影响RNA质量的关键因素，尤其是在人类或其他[动物研究](@entry_id:168816)中。PMI越长，组织内源性核糖核酸酶（RNase）降解RNA的时间就越长，导致RIN值下降。在ST数据中，这通常表现为每个捕获点检测到的基因数（$G_s$）和UMI数（$U_s$）的减少，以及由于RNA片段化和poly(A)捕获策略导致的严重$3'$端测序偏好。有趣的是，线粒体转录本的比例（$f_{\mathrm{mt}}$）可能会升高，这可能是因为线粒体RNA相对更稳定。[@problem_id:2752965]

*   **组织固定**：福尔马林固定石蜡包埋（FFPE）是保存组织形态的金标准，但对RNA有严重损害。甲醛会引起RNA的化学修饰、片段化和交联，导致RIN值通常很低（$2-4$）。这会阻碍逆转录过程，降低$U_s$和$G_s$。尽管已有专门为FFPE样本优化的ST方案，但与高质量的新鲜冰冻样本相比，其数据产出和灵敏度通常较低。[@problem_id:2752965]

*   **其他因素**：[细胞死亡](@entry_id:169213)后，转录和[剪接](@entry_id:181943)等耗能过程会迅速停止。因此，在PMI较长的样本中观察到的[内含子](@entry_id:144362)读段比例增加，更可能归因于细胞核中未成熟pre-mRNA的滞留和差异性降解，而非死后转录的持续。[@problem_id:2752965]

### 核心分析概念

获得了空间分辨的基因表达计数矩阵后，下一步就是从中提取生物学意义。两个基本的分析任务是识别具有空间模式的基因和根据表达谱对组织进行分割。

#### 识别空间可变基因（SVGs）

一个核心目标是发现那些表达水平随空间位置变化的基因，即**空间可变基因（SVGs）**。重要的是，这个概念不同于传统的**[差异表达](@entry_id:748396)基因（DEGs）**。DEGs通常是在预先定义的解剖区域之间进行比较（例如，比较A区和B区的平均表达）。然而，基因的表达模式可能与已知的解剖结构不完全一致。

考虑这样一个例子：基因$g_1$在一个皮层切片上显示出平滑的前后梯度，但其在A区和B区的平均表达量经过[标准化](@entry_id:637219)后是相同的。传统的DE分析会错过$g_1$，因为它在两个区域间没有差异。然而，它显然是一个SVG。相反，基因$g_2$在A区的表达高于B区，但在每个区域内部其表达是随机的，没有空间模式。$g_2$是一个DEG，但其空间变异完全由已知的解剖标签解释。[@problem_id:2753010]

因此，SVG的严格定义是：一个基因，其表达[分布](@entry_id:182848)在控制了所有已知的非空间[协变](@entry_id:634097)量（如解剖区域标签、[测序深度](@entry_id:178191)）之后，仍然表现出**空间依赖性**（例如，[空间自相关](@entry_id:177050)，即邻近位置的表达值比远处位置更相似）。SVG的检测因此是一个统计检验问题，其零假设是“在给定已知[协变](@entry_id:634097)量的情况下，基因表达与空间坐标无关”。[@problem_id:2753010]

#### 利用空间信息进行[聚类](@entry_id:266727)

另一个核心任务是无监督地识别组织中的功能或细胞结构域，例如大脑皮层的分层。一种直接的方法是对所有捕获点的基因表达谱进行标准聚类（如K-means）。然而，这种**纯表达[聚类](@entry_id:266727)**忽略了至关重要的空间信息。由于单个捕获点的表达数据可能存在噪声，这种方法常常产生“椒盐噪声”式的聚类结果，即在空间上零散、不连续，不符合[组织结构](@entry_id:146183)的生物学现实。[@problem_id:2752929]

**空间信息聚类**通过将表达信息和空间邻近信息结合起来，克服了这一局限性。其核心思想是，在分配聚类标签时，不仅要使同一簇内的点表达谱相似，还要鼓励空间上相邻的点被赋予相同的标签。这通常通过一个联合优化模型实现，例如基于[马尔可夫随机场](@entry_id:751685)（MRF）的模型。这类方法的[目标函数](@entry_id:267263)包含两个部分：一个衡量表达谱的[拟合优度](@entry_id:637026)，另一个惩罚相邻点之间的标签不一致性。通过平衡这两项，空间信息聚类能够生成空间上更平滑、更连续的结构域，从而更准确地反映出诸如皮层分层之类的真实[组织结构](@entry_id:146183)。[@problem_id:2752929]

### 不确定性的传递

最后，必须认识到，从原始组织到最终的生物学结论，整个[空间转录组学](@entry_id:270096)流程的每个阶段都会引入不确定性，并且这些不确定性会层层传递和累积。一个严谨的分析需要对这些不确定性来源有所了解。[@problem_id:2752897]

1.  **分子测量不确定性**：mRNA的捕获和计数是一个固有的[随机过程](@entry_id:159502)，可以用泊松或负二项分布来描述其统计噪声。
2.  **解码不确定性**：测序错误或条形码合成中的缺陷可能导致一个基因的读段被错误地识别为另一个基因，这可以通过一个[混淆矩阵](@entry_id:635058)来建模。
3.  **对齐不确定性**：将组织[病理学](@entry_id:193640)图像与[空间条形码](@entry_id:267996)网格进行对齐可能存在微小误差（抖動），导致表达信号在相邻点之间发生“渗漏”。
4.  **分析不确定性**：下游的[计算模型](@entry_id:152639)，例如用于估计每个捕获点细胞类型比例的**反卷积**模型，其结果的准确性不仅取决于模型本身的假设，还继承了上游所有阶段引入的噪声和误差。例如，[广义最小二乘法](@entry_id:272590)估计细胞类型比例的[方差](@entry_id:200758)，不仅取决于模型设计，还取决于输入表达数据的完整协[方差](@entry_id:200758)结构。[@problem_id:2752897]

理解这些[不确定性的来源](@entry_id:164809)及其如何复合，对于审慎地解释[空间转录组学](@entry_id:270096)结果并做出可靠的[科学推断](@entry_id:155119)至关重要。