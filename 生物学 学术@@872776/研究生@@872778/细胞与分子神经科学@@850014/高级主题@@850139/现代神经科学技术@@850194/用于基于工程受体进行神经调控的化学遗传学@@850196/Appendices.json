{"hands_on_practices": [{"introduction": "化学遗传学工具设计的核心原则之一是实现正交性，即设计的激动剂应优先激活工程受体，而非内源性受体。本练习将指导您应用平衡解离常数（$K_D$）来计算在给定激动剂浓度下不同受体的占有率。通过这项实践，您将掌握如何确定一个“治疗窗口”，即在最大化靶向效应的同时，将脱靶效应控制在可接受范围内的关键技能。[@problem_id:2704789]", "problem": "一项化学遗传学神经调控实验使用了 Kappa Opioid Receptor Designer (KORD)，它是一种工程化的抑制性设计药物独家激活的设计受体 (Designer Receptor Exclusively Activated by Designer Drug, DREADD)，可被 salvinorin B (SalB) 选择性激活。Salvinorin B 与 KORD 和内源性 kappa opioid receptor (KOR) 均可结合，但具有不同的平衡解离常数。测得的解离常数对于 KORD 是 $K_D = 12\\,\\mathrm{nM}$，对于内源性 KOR 是 $K_D = 1\\,\\mu\\mathrm{M}$。假设存在一个混合均匀的细胞外室、反应处于平衡结合状态、配体-受体化学计量比为 $1:1$ 且结合位点独立非协同，并忽略因结合造成的配体消耗。\n\n从质量作用定律和平衡解离常数的定义 $K_D = \\frac{[R][L]}{[RL]}$ 出发，推导出受体群体被配体占据的分数占有率作为游离配体浓度 $[L]$ 和 $K_D$ 的函数，然后确定能使 KORD 的分数占有率至少为 $0.80$，同时使内源性 KOR 的分数占有率严格低于 $0.10$ 的最小游离 SalB 浓度 $[L]$。\n\n将最终的配体浓度以纳摩尔 ($\\mathrm{nM}$) 为单位表示。将答案保留两位有效数字。", "solution": "我们从 $1:1$ 结合的平衡解离常数定义开始：\n$$\nK_D = \\frac{[R][L]}{[RL]} \\, ,\n$$\n其中 $[R]$ 是未结合受体的浓度，$[L]$ 是游离配体的浓度，$[RL]$ 是配体-受体复合物的浓度。总受体浓度为 $[R]_T = [R] + [RL]$。分数占有率 $f$ 定义为\n$$\nf \\equiv \\frac{[RL]}{[R]_T} \\, .\n$$\n我们重排 $K_D$ 的定义，用 $[R]$ 和 $[L]$ 来表示 $[RL]$：\n$$\n[RL] = \\frac{[R][L]}{K_D} \\, .\n$$\n将 $[R] = [R]_T - [RL]$ 代入右侧：\n$$\n[RL] = \\frac{([R]_T - [RL])[L]}{K_D} \\, .\n$$\n解出 $[RL]$：\n$$\n[RL] = \\frac{[R]_T [L]}{K_D + [L]} \\, .\n$$\n两边同除以 $[R]_T$ 得到分数占有率：\n$$\nf([L];K_D) = \\frac{[RL]}{[R]_T} = \\frac{[L]}{K_D + [L]} \\, .\n$$\n\n我们将此公式应用于经历相同游离配体浓度 $[L]$ 的两个受体群体：\n- 对于 Kappa Opioid Receptor Designer (KORD)：$K_D^{\\mathrm{KORD}} = 12\\,\\mathrm{nM}$。\n- 对于内源性 kappa opioid receptor (KOR)：$K_D^{\\mathrm{KOR}} = 1\\,\\mu\\mathrm{M} = 1000\\,\\mathrm{nM}$。\n\n要求是：\n$$\nf_{\\mathrm{KORD}} = \\frac{[L]}{K_D^{\\mathrm{KORD}} + [L]} \\ge 0.80 \\, ,\n$$\n和\n$$\nf_{\\mathrm{KOR}} = \\frac{[L]}{K_D^{\\mathrm{KOR}} + [L]}  0.10 \\, .\n$$\n\n首先，求出使 $f_{\\mathrm{KORD}} \\ge 0.80$ 的最小 $[L]$。解等式求阈值：\n$$\n\\frac{[L]}{K_D^{\\mathrm{KORD}} + [L]} = 0.80 \\;\\;\\Rightarrow\\;\\; [L] = 0.80\\left(K_D^{\\mathrm{KORD}} + [L]\\right) \\, .\n$$\n重排得：\n$$\n[L] - 0.80[L] = 0.80 K_D^{\\mathrm{KORD}} \\;\\;\\Rightarrow\\;\\; 0.20[L] = 0.80 K_D^{\\mathrm{KORD}} \\, ,\n$$\n所以\n$$\n[L] = \\frac{0.80}{0.20} K_D^{\\mathrm{KORD}} = 4 K_D^{\\mathrm{KORD}} \\, .\n$$\n由于 $K_D^{\\mathrm{KORD}} = 12\\,\\mathrm{nM}$，\n$$\n[L]_{\\min,\\mathrm{KORD}} = 4 \\times 12\\,\\mathrm{nM} = 48\\,\\mathrm{nM} \\, .\n$$\n\n接下来，检验该浓度是否能使内源性 KOR 的占有率低于 $0.10$。不等式\n$$\n\\frac{[L]}{K_D^{\\mathrm{KOR}} + [L]}  0.10\n$$\n可解出 $[L]$ 的上界：\n$$\n[L]  0.10\\left(K_D^{\\mathrm{KOR}} + [L]\\right) \\;\\;\\Rightarrow\\;\\; [L] - 0.10[L]  0.10 K_D^{\\mathrm{KOR}} \\, ,\n$$\n$$\n0.90[L]  0.10 K_D^{\\mathrm{KOR}} \\;\\;\\Rightarrow\\;\\; [L]  \\frac{0.10}{0.90} K_D^{\\mathrm{KOR}} = \\frac{1}{9} K_D^{\\mathrm{KOR}} \\, .\n$$\n由于 $K_D^{\\mathrm{KOR}} = 1000\\,\\mathrm{nM}$，\n$$\n[L]  \\frac{1000\\,\\mathrm{nM}}{9} \\approx 111.111\\ldots\\,\\mathrm{nM} \\, .\n$$\n\n现在计算在 $[L] = 48\\,\\mathrm{nM}$ 时内源性 KOR 的占有率：\n$$\nf_{\\mathrm{KOR}}(48\\,\\mathrm{nM}) = \\frac{48}{1000 + 48} = \\frac{48}{1048} \\approx 0.0458\\ldots \\, ,\n$$\n该值严格低于 $0.10$。因此，能使 KORD 占有率达到 $0.80$ 同时保持内源性 KOR 占有率低于 $0.10$ 的最小浓度是 $[L] = 48\\,\\mathrm{nM}$。\n\n保留两位有效数字并以纳摩尔为单位表示，所需浓度为 $48\\,\\mathrm{nM}$。", "answer": "$$\\boxed{48}$$", "id": "2704789"}, {"introduction": "在理想的设计之外，化学遗传学实验在实践中常面临复杂的生物学现实，例如激动剂在体内的代谢。一个典型的例子是，常用的激动剂CNO会部分逆转化为氯氮平，后者具有多种内源性靶点。本练习旨在模拟这一关键问题，教您如何利用已知的代谢物浓度和亲和力数据，来估算其在多个内源性受体上的平均脱靶占有率，从而更准确地解读实验结果。[@problem_id:2704772]", "problem": "一项化学遗传学实验使用氯氮平-N-氧化物（Clozapine-N-oxide, CNO）来激活设计药物特异激活的设计受体（Designer Receptors Exclusively Activated by Designer Drugs, DREADDs），但一部分CNO在大脑中会反向转化为氯氮平（clozapine）。在一个感兴趣的皮层区域，稳态下的微透析测量检测到游离的细胞外clozapine浓度为$10\\,\\text{nM}$。为了评估clozapine可能产生的内源性脱靶结合，我们考虑该区域的三种内源性受体。对于这些受体，clozapine的平衡解离常数是已知的，其相对受体密度是通过先前的定量放射自显影术估计的。假设在质量作用定律下发生简单的可逆结合，并且测得的浓度对应于受体位点处的游离配体浓度。使用以下数据：\n\n- 组胺H1受体：$K_{D,\\mathrm{H1}} = 4\\,\\text{nM}$，相对密度 $B_{\\max,\\mathrm{H1}} = 0.5$（任意单位）。\n- 5-羟色胺5-HT2A受体：$K_{D,\\mathrm{5HT2A}} = 10\\,\\text{nM}$，相对密度 $B_{\\max,\\mathrm{5HT2A}} = 1.0$。\n- 多巴胺D2受体：$K_{D,\\mathrm{D2}} = 150\\,\\text{nM}$，相对密度 $B_{\\max,\\mathrm{D2}} = 2.0$。\n\n从单一位点可逆结合反应中平衡解离常数的定义，以及分数占有率作为处于配体结合状态的受体占总受体分数的定义出发，推导出每个受体分数占有率的表达式，并计算这三种受体的密度加权平均内源性脱靶占有率。将最终结果表示为无单位的小数。将最终答案四舍五入到四位有效数字。", "solution": "该问题要求推导受体的分数占有率，然后计算三种特定受体类型的加权平均占有率。\n\n首先，我们推导分数占有率的通用表达式，记为 $\\theta$。考虑一个受体 $R$ 和一个配体 $L$ 之间形成复合物 $RL$ 的简单可逆结合反应：\n$$ R + L \\rightleftharpoons RL $$\n平衡解离常数 $K_D$ 由平衡时的质量作用定律定义：\n$$ K_D = \\frac{[R][L]}{[RL]} $$\n其中 $[R]$ 是游离、未结合受体的浓度，$[L]$ 是游离配体的浓度，$[RL]$ 是受体-配体复合物的浓度。\n\n分数占有率 $\\theta$ 定义为处于配体结合状态的受体占总受体的分数。受体总浓度 $B_{\\text{total}}$ 是游离受体和结合受体浓度之和：$B_{\\text{total}} = [R] + [RL]$。\n因此，分数占有率为：\n$$ \\theta = \\frac{[RL]}{B_{\\text{total}}} = \\frac{[RL]}{[R] + [RL]} $$\n为了用 $[L]$ 和 $K_D$ 表示 $\\theta$，我们首先对 $K_D$ 的定义进行变换以求解 $[R]$：\n$$ [R] = \\frac{K_D [RL]}{[L]} $$\n将这个 $[R]$ 的表达式代入 $\\theta$ 的方程中：\n$$ \\theta = \\frac{[RL]}{\\frac{K_D [RL]}{[L]} + [RL]} $$\n假设结合受体的浓度不为零，即 $[RL] \\ne 0$，我们可以从分母中提出 $[RL]$ 并化简：\n$$ \\theta = \\frac{[RL]}{[RL] \\left( \\frac{K_D}{[L]} + 1 \\right)} = \\frac{1}{\\frac{K_D}{[L]} + 1} $$\n将分子和分母同乘以 $[L]$，得到标准形式，即Hill-Langmuir方程：\n$$ \\theta = \\frac{[L]}{[L] + K_D} $$\n该表达式给出了单一受体群体的分数占有率，它是游离配体浓度和该配体与受体的解离常数的函数。\n\n接下来，我们应用此公式计算三种内源性受体群体中每一种的分数占有率，使用给定的游离clozapine浓度 $[L] = 10 \\text{ nM}$。\n\n对于组胺H1受体：\n$$ \\theta_{\\mathrm{H1}} = \\frac{[L]}{[L] + K_{D,\\mathrm{H1}}} = \\frac{10}{10 + 4} = \\frac{10}{14} = \\frac{5}{7} $$\n\n对于5-羟色胺5-HT2A受体：\n$$ \\theta_{\\mathrm{5HT2A}} = \\frac{[L]}{[L] + K_{D,\\mathrm{5HT2A}}} = \\frac{10}{10 + 10} = \\frac{10}{20} = \\frac{1}{2} $$\n\n对于多巴胺D2受体：\n$$ \\theta_{\\mathrm{D2}} = \\frac{[L]}{[L] + K_{D,\\mathrm{D2}}} = \\frac{10}{10 + 150} = \\frac{10}{160} = \\frac{1}{16} $$\n\n问题要求计算密度加权平均内源性脱靶占有率，$\\bar{\\theta}$。这是通过计算各个占有率的加权平均值得到的，其中权重是相对受体密度 $B_{\\max,i}$。加权平均的公式是：\n$$ \\bar{\\theta} = \\frac{\\sum_{i} B_{\\max,i} \\cdot \\theta_i}{\\sum_{i} B_{\\max,i}} $$\n给定的相对密度为 $B_{\\max,\\mathrm{H1}} = 0.5$，$B_{\\max,\\mathrm{5HT2A}} = 1.0$，以及 $B_{\\max,\\mathrm{D2}} = 2.0$。\n\n首先，我们计算权重的总和（总相对密度）：\n$$ \\sum_{i} B_{\\max,i} = B_{\\max,\\mathrm{H1}} + B_{\\max,\\mathrm{5HT2A}} + B_{\\max,\\mathrm{D2}} = 0.5 + 1.0 + 2.0 = 3.5 $$\n接下来，我们计算加权占有率的总和：\n$$ \\sum_{i} B_{\\max,i} \\cdot \\theta_i = (B_{\\max,\\mathrm{H1}} \\cdot \\theta_{\\mathrm{H1}}) + (B_{\\max,\\mathrm{5HT2A}} \\cdot \\theta_{\\mathrm{5HT2A}}) + (B_{\\max,\\mathrm{D2}} \\cdot \\theta_{\\mathrm{D2}}) $$\n$$ \\sum_{i} B_{\\max,i} \\cdot \\theta_i = \\left(0.5 \\cdot \\frac{5}{7}\\right) + \\left(1.0 \\cdot \\frac{1}{2}\\right) + \\left(2.0 \\cdot \\frac{1}{16}\\right) $$\n$$ \\sum_{i} B_{\\max,i} \\cdot \\theta_i = \\frac{2.5}{7} + \\frac{1}{2} + \\frac{2}{16} = \\frac{5}{14} + \\frac{1}{2} + \\frac{1}{8} $$\n为了将这些分数相加，我们找到一个公分母，即 $56$：\n$$ \\sum_{i} B_{\\max,i} \\cdot \\theta_i = \\frac{5 \\cdot 4}{14 \\cdot 4} + \\frac{1 \\cdot 28}{2 \\cdot 28} + \\frac{1 \\cdot 7}{8 \\cdot 7} = \\frac{20}{56} + \\frac{28}{56} + \\frac{7}{56} = \\frac{55}{56} $$\n最后，我们计算加权平均占有率 $\\bar{\\theta}$：\n$$ \\bar{\\theta} = \\frac{\\sum_{i} B_{\\max,i} \\cdot \\theta_i}{\\sum_{i} B_{\\max,i}} = \\frac{55/56}{3.5} = \\frac{55/56}{7/2} = \\frac{55}{56} \\cdot \\frac{2}{7} = \\frac{55}{28 \\cdot 7} = \\frac{55}{196} $$\n换算成小数，结果是：\n$$ \\bar{\\theta} = \\frac{55}{196} \\approx 0.2806122... $$\n按要求四舍五入到四位有效数字，得到 $0.2806$。", "answer": "$$\n\\boxed{0.2806}\n$$", "id": "2704772"}, {"introduction": "从理论预测转向实验数据分析，是神经科学研究中的一个重要环节。当表征一个新的DREADD-激动剂系统时，实验上测定其剂量-反应关系并提取关键药理学参数是必不可少的步骤。本练习将要求您编写程序，将希尔方程拟合到模拟的实验数据中，以估算半数效应浓度（$EC_{50}$）和协同性系数（$n$），这是定量药理学中的一项核心计算技能。[@problem_id:2704745]", "problem": "您正在为用于化学遗传学的工程化 G 蛋白偶联受体（例如，专门由设计药物激活的设计受体 (Designer Receptors Exclusively Activated by Designer Drugs, DREADDs)）的剂量-反应关系建模，这些受体在神经元中表达以调节其活动。您获得了三个独立的浓度-反应数据集，这些数据集是为一种选择性激活该工程化受体的激动剂测量的，以分数激活（无单位，根据测定中可测量的最大效应进行归一化）表示。激动剂浓度单位为纳摩尔（nanomolar），您可以假设反应是单调、饱和的，且基线可忽略不计。根据受体理论的基本原理，质量作用结合下的受体占有率及其到效应的映射意味着，一个带有协同性指数的标准基于受体占有率的模型可以捕捉稳态输入-输出非线性。您的任务是编写一个程序，通过拟合用于激动剂浓度-反应曲线的标准单调基于占有率的模型（通常称为 Hill–Langmuir 模型），在所有参数均为正的约束下，估计每个数据集的半数有效浓度和协同性指数。然后，根据估计的协同性指数，为每个数据集判断其信号传导是否具有协同性。\n\n使用以下测试套件，它提供了三个数据集。每个数据集包含浓度（单位为纳摩尔）和归一化反应（无单位）。以下所有数字均为精确值，应按原样使用。\n\n数据集 A：\n- 浓度 (nM): [$0.3$, $1$, $3$, $10$, $30$, $100$, $300$]\n- 反应 (无单位): [$0.0101$, $0.0318$, $0.092$, $0.247$, $0.505$, $0.764$, $0.912$]\n\n数据集 B：\n- 浓度 (nM): [$0.3$, $1$, $3$, $10$, $30$, $100$]\n- 反应 (无单位): [$0.0010$, $0.0105$, $0.081$, $0.495$, $0.905$, $0.988$]\n\n数据集 C：\n- 浓度 (nM): [$5$, $20$, $50$, $200$, $1000$]\n- 反应 (无单位): [$0.0012$, $0.059$, $0.503$, $0.982$, $0.999$]\n\n要求和约束：\n- 将每个数据集拟合到带有协同性指数的标准单调基于占有率的模型，该模型具有一个自由的最大效应参数和零基线。约束半数有效浓度为严格正值，协同性指数为严格正值。所有拟合必须通过非线性最小二乘法进行。\n- 对于每个数据集，估计：\n  - 半数有效浓度 $EC_{50}$，单位为纳摩尔；\n  - 协同性指数 $n$（无量纲）。\n- 对协同性进行布尔分类定义如下：如果 $n > 1$ 则返回 true，否则返回 false。\n- 数值输出要求：\n  - 报告 $EC_{50}$，单位为纳摩尔，四舍五入至三位有效数字。\n  - 报告 $n$，四舍五入至三位有效数字。\n  - 协同性分类必须是布尔值（true 或 false）。\n- 您的程序必须无需用户输入即可运行，并且必须处理所有三个数据集。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表用方括号括起来。每个数据集的结果本身应该是一个包含三个元素的列表，顺序为 [$EC_{50}$, $n$, cooperative]，因此总输出是列表的列表，顺序为 [数据集 A 结果, 数据集 B 结果, 数据集 C 结果]。例如，最终输出格式必须类似于：[[$x_A$, $n_A$, true_or_false],[$x_B$, $n_B$, true_or_false],[$x_C$, $n_C$, true_or_false]]，无任何附加文本。\n\n科学真实性和解释要求：\n- 在估计参数后，解释拟合出的 $n > 1$ 在机制上如何可能源于神经调节中使用的工程化受体系统中的协同信号传导步骤。此解释必须基于基本原理，如质量作用结合、受体占有率和多步信号转导，而不是基于特定于数据集的启发式方法。解释本身是概念性的，属于您的解决方案说明部分；程序仅输出数值和布尔结果。\n\n此问题是自包含的，应能使用任何具有非线性最小二乘法的现代编程语言解决。回答所有涉及物理单位的量时，请使用纳摩尔，并确保角度单位在此处不相关。不使用百分比；所有分数数量均为小数。测试套件涵盖了一个典型的良好采样案例（数据集 A）、一个暗示协同性的陡峭反应（数据集 B），以及一个挑战数值稳健性的稀疏、陡峭案例（数据集 C）。要求的输出仅为浮点数和布尔值，按规定聚合成单行列表表示形式。", "solution": "待拟合的模型是 Hill-Langmuir 方程，它描述了配体浓度 $C$ 与产生的生物反应 $R$ 之间的关系。该模型是药理学中表征激动剂效价和信号反应性质的基石。该方程由下式给出：\n$$ R(C) = R_{max} \\frac{C^n}{EC_{50}^n + C^n} $$\n在此公式中：\n- $C$ 是激动剂的浓度，以纳摩尔 ($nM$) 为单位提供。\n- $R(C)$ 是测得的反应，是一个归一化的无单位量。\n- $R_{max}$ 是系统中可能的最大反应。虽然数据是归一化的，但它们不一定达到最大值 $1$，因此 $R_{max}$ 是一个待估计的自由参数。\n- $EC_{50}$ 是半数有效浓度。它代表激动剂在引起最大反应一半 ($R_{max}/2$) 时的浓度。该参数是激动剂效价的度量。\n- $n$ 是 Hill 系数，一个描述曲线陡峭程度的无量纲参数。它作为协同性的指标。\n\n参数 $\\vec{p} = (EC_{50}, n, R_{max})$ 是通过非线性最小二乘法为每个数据集估计的。这涉及到找到使观测反应 $R_i$ 与模型预测反应 $R(C_i; \\vec{p})$ 之间的平方差（残差）之和最小化的参数值：\n$$ SSR(\\vec{p}) = \\sum_{i=1}^{N} [R_i - R(C_i; \\vec{p})]^2 $$\n其中，总和是对给定数据集中的所有 $N$ 个数据点 $(C_i, R_i)$ 进行的。此最小化必须在所有参数均为严格正值这一具有物理意义的约束下执行：$EC_{50}  0$、$n  0$ 和 $R_{max}  0$。这是一个约束优化问题，可以使用诸如 Levenberg-Marquardt 或信赖域反射（Trust Region Reflective）等算法进行数值求解。\n\n一旦 Hill 系数 $n$ 被估计出来，它就被用来对信号传导机制进行分类。该分类基于以下解释：\n- $n=1$：系统遵循简单的质量作用动力学，类似于 Michaelis-Menten 酶动力学。这表示非协同性结合，即一个激动剂分子的结合不影响其他分子的结合。\n- $n1$：系统表现出正协同性。这意味着一个激动剂分子与受体复合物的结合会增强后续分子的结合亲和力或功效。这会导致一种“超敏”或开关样反应，其曲线比非协同性反应更陡峭。\n- $0n1$：系统表现出负协同性。这意味着一个激动剂分子的结合会降低后续分子的结合亲和力或功效。这会导致一种比非协同性反应更平缓的反应曲线。\n\n在GPCR信号传导的背景下，观察到 $n > 1$ 的Hill系数并不一定意味着受体本身存在协同性配体结合（即受体有多个变构结合位点）。相反，它可以反映从受体激活到下游效应器测量的信号转导级联中的非线性放大步骤。例如，如果一个效应的产生需要多个独立的下游事件同时发生（例如，需要激活多个效应器分子才能打开一个离子通道），这将产生协同效应，表现为 $n > 1$。同样，涉及反馈回路或多步磷酸化的信号通路也可以表现出超敏性，这同样会体现在剂量-反应曲线的陡峭程度上。因此，在DREADD系统中，$n > 1$ 可能暗示了从G蛋白激活到最终测量的神经元活动变化之间存在一个或多个具有内在协同性的生物化学步骤。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits dose-response data to the Hill-Langmuir model to estimate EC50 and \n    the cooperativity exponent n, and classifies the cooperativity.\n    \"\"\"\n\n    # Define the datasets as provided in the problem statement.\n    test_cases = [\n        # Dataset A\n        {'conc': np.array([0.3, 1, 3, 10, 30, 100, 300]), \n         'resp': np.array([0.0101, 0.0318, 0.092, 0.247, 0.505, 0.764, 0.912])},\n        # Dataset B\n        {'conc': np.array([0.3, 1, 3, 10, 30, 100]), \n         'resp': np.array([0.0010, 0.0105, 0.081, 0.495, 0.905, 0.988])},\n        # Dataset C\n        {'conc': np.array([5, 20, 50, 200, 1000]),\n         'resp': np.array([0.0012, 0.059, 0.503, 0.982, 0.999])}\n    ]\n\n    def hill_model(C, ec50, n, rmax):\n        \"\"\"Standard Hill-Langmuir equation.\"\"\"\n        return rmax * (C**n) / (ec50**n + C**n)\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        # Calculate the position of the most significant digit\n        # Then round to the correct number of decimal places\n        return round(x, sf - 1 - int(np.floor(np.log10(abs(x)))))\n\n    results = []\n    \n    for case in test_cases:\n        c_data = case['conc']\n        r_data = case['resp']\n\n        # Provide robust initial guesses for the parameters\n        rmax_guess = np.max(r_data)\n        # Find concentration closest to half-maximal response as EC50 guess\n        ec50_guess_idx = np.argmin(np.abs(r_data - rmax_guess / 2.0))\n        ec50_guess = c_data[ec50_guess_idx]\n        n_guess = 1.0\n        \n        p0 = [ec50_guess, n_guess, rmax_guess]\n\n        # Define strict positive bounds for all parameters as per problem constraints\n        # Use a small positive number to avoid issues at zero\n        lower_bounds = [np.finfo(float).eps, np.finfo(float).eps, np.finfo(float).eps]\n        upper_bounds = [np.inf, np.inf, np.inf]\n        bounds = (lower_bounds, upper_bounds)\n\n        # Perform nonlinear least squares fitting\n        # 'trf' method is robust and suitable for bounds\n        popt, _ = curve_fit(\n            hill_model, \n            c_data, \n            r_data, \n            p0=p0, \n            bounds=bounds,\n            method='trf',\n            max_nfev=5000 # Increased iterations for robustness\n        )\n        \n        ec50_fit, n_fit, rmax_fit = popt\n\n        # Round results to three significant figures\n        ec50_rounded = round_to_sf(ec50_fit, 3)\n        n_rounded = round_to_sf(n_fit, 3)\n\n        # Classify cooperativity based on the unrounded fitted value of n\n        is_cooperative = n_fit > 1.0\n\n        results.append([ec50_rounded, n_rounded, is_cooperative])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        # res[2] is a boolean, convert to lowercase string 'true' or 'false'\n        coop_str = str(res[2]).lower()\n        formatted_results.append(f\"[{res[0]},{res[1]},{coop_str}]\")\n    \n    final_output = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2704745"}]}