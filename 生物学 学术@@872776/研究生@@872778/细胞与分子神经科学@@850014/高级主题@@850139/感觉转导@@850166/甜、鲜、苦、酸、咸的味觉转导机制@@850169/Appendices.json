{"hands_on_practices": [{"introduction": "我们将从最直接的味觉转导机制之一——离子通道门控开始，聚焦于由上皮钠通道 (ENaC) 介导的咸味感知。这个练习通过一个经典的药理学场景，引导你从基本原理（如质量作用定律）出发，推导并应用剂量-反应曲线。通过这个过程 [@problem_id:2760630]，你将学会如何将微观的生物物理常数（如解离常数 $K_d$）与宏观的实验测量值（如半数抑制浓度 $IC_{50}$）联系起来。", "problem": "在一个电压钳制的菌状味觉感受器细胞中，上皮钠通道 (ENaC) 介导了对阿米洛利敏感的钠内流，这对于低盐刺激的转导至关重要。考虑由阿米洛利引起的稳态阻断。阿米洛利是一种孔道阻断剂，它以一对一的方式与传导通路中的单个位点结合，亚基之间没有协同性，并且在测试电位下没有电压依赖性。假设以下经过充分检验的前提：(i) 质量作用定律在平衡状态下决定了阻断剂的结合；(ii) 除了被占据之外，阻断剂的结合不改变未被阻断通道的开放概率；(iii) 宏观电流与未被阻断通道的比例成正比；以及 (iv) 半数抑制浓度 (记为 $IC_{50}$) 是指在其他条件相同的情况下，使宏观电流降低至其对照值一半时的游离阻断剂浓度。\n\n仅从这些前提出发，首先在希尔系数 $n=1$ 的情况下，推导一个将稳态下被阻断通道的比例 $f_{\\mathrm{block}}$ 与游离阿米洛利浓度 $[B]$ 和 $IC_{50}$ 联系起来的表达式。然后，使用此表达式，在给定 $[B]=1\\,\\mu\\mathrm{M}$ 和 $IC_{50}=0.1\\,\\mu\\mathrm{M}$ 的条件下计算 $f_{\\mathrm{block}}$。将你的最终数值结果四舍五入到四位有效数字，并以无单位的小数形式表示。", "solution": "问题陈述已经过验证，被认为是自洽的、有科学依据且表述清晰的。所提供的前提足以进行严谨的推导和后续计算。我们将开始解题。\n\n第一个任务是推导稳态下被阻断通道的比例 $f_{\\mathrm{block}}$ 作为游离阿米洛利浓度 $[B]$ 和半数抑制浓度 $IC_{50}$ 的函数表达式。该模型描述了通道 ($C$) 和阻断剂 ($B$) 之间的一对一结合相互作用，这与希尔系数 $n=1$ 的情况一致。\n\n可逆结合反应为：\n$$ C + B \\rightleftharpoons CB $$\n其中 $CB$ 代表被阻断的通道复合物。\n\n根据前提 (i)，质量作用定律适用于平衡状态。解离常数 $K_d$ 定义为：\n$$ K_d = \\frac{[C][B]}{[CB]} $$\n此处，$[C]$, $[B]$ 和 $[CB]$ 分别是游离通道、游离阻断剂和被阻断通道复合物的平衡浓度。\n\n被阻断通道的比例 $f_{\\mathrm{block}}$ 是被阻断通道浓度与总通道浓度 $[C]_{\\text{total}} = [C] + [CB]$ 的比值：\n$$ f_{\\mathrm{block}} = \\frac{[CB]}{[C] + [CB]} $$\n\n为了用 $[B]$ 和 $K_d$ 表示 $f_{\\mathrm{block}}$，我们首先重新整理 $K_d$ 的定义，用其他物种来表示 $[C]$：\n$$ [C] = \\frac{K_d [CB]}{[B]} $$\n\n将此代入 $f_{\\mathrm{block}}$ 的表达式中得到：\n$$ f_{\\mathrm{block}} = \\frac{[CB]}{\\frac{K_d [CB]}{[B]} + [CB]} $$\n\n假设阻断剂浓度不为零，从而 $[CB]$ 也不为零，我们可以将分子和分母同除以 $[CB]$：\n$$ f_{\\mathrm{block}} = \\frac{1}{\\frac{K_d}{[B]} + 1} $$\n\n通过代数变换，这可以重写为 $n=1$ 时的希尔方程：\n$$ f_{\\mathrm{block}} = \\frac{[B]}{K_d + [B]} $$\n\n现在，我们必须将生物物理常数 $K_d$ 与唯象参数 $IC_{50}$ 联系起来。前提 (iii) 指出，宏观电流 $I$ 与未被阻断通道的比例 $f_{\\text{unblock}}$ 成正比。未被阻断通道的比例由 $f_{\\text{unblock}} = 1 - f_{\\text{block}}$ 给出：\n$$ f_{\\text{unblock}} = 1 - \\frac{[B]}{K_d + [B]} = \\frac{(K_d + [B]) - [B]}{K_d + [B]} = \\frac{K_d}{K_d + [B]} $$\n\n设 $I_{\\text{max}}$ 为不存在阻断剂 ($[B]=0$) 时的对照电流，此时 $f_{\\text{unblock}}=1$。在任意给定阻断剂浓度 $[B]$ 下的电流为：\n$$ I([B]) = I_{\\text{max}} \\cdot f_{\\text{unblock}} = I_{\\text{max}} \\left( \\frac{K_d}{K_d + [B]} \\right) $$\n\n前提 (iv) 定义 $IC_{50}$ 为电流降低至其对照值一半时的阻断剂浓度。因此，在 $[B] = IC_{50}$ 时，我们有 $I(IC_{50}) = \\frac{1}{2} I_{\\text{max}}$。我们可以写出：\n$$ \\frac{1}{2} I_{\\text{max}} = I_{\\text{max}} \\left( \\frac{K_d}{K_d + IC_{50}} \\right) $$\n\n两边同除以 $I_{\\text{max}}$ (对于有意义的实验，该值必须非零) 得到：\n$$ \\frac{1}{2} = \\frac{K_d}{K_d + IC_{50}} $$\n\n解这个关于 $IC_{50}$ 的代数方程，证明了在这些模型假设下它们的等价性：\n$$ K_d + IC_{50} = 2 K_d \\implies IC_{50} = K_d $$\n\n将 $K_d = IC_{50}$ 代入我们推导出的 $f_{\\mathrm{block}}$ 方程，我们得到联系被阻断通道比例、阻断剂浓度和 $IC_{50}$ 的最终表达式：\n$$ f_{\\mathrm{block}} = \\frac{[B]}{IC_{50} + [B]} $$\n推导到此结束。\n\n第二个任务是使用提供的数值计算 $f_{\\mathrm{block}}$：$[B] = 1 \\, \\mu\\mathrm{M}$ 和 $IC_{50} = 0.1 \\, \\mu\\mathrm{M}$。\n\n将这些值代入推导出的公式中：\n$$ f_{\\mathrm{block}} = \\frac{1 \\, \\mu\\mathrm{M}}{0.1 \\, \\mu\\mathrm{M} + 1 \\, \\mu\\mathrm{M}} = \\frac{1}{1.1} $$\n\n结果是一个无量纲的量，这对于一个比例来说是符合预期的。进行除法运算：\n$$ f_{\\mathrm{block}} = \\frac{10}{11} \\approx 0.909090... $$\n\n题目要求将结果四舍五入到四位有效数字。\n$$ f_{\\mathrm{block}} \\approx 0.9091 $$", "answer": "$$\\boxed{0.9091}$$", "id": "2760630"}, {"introduction": "在掌握了单个受体的模型后，我们将把视野扩展到群体层面，探讨基因变异如何塑造味觉感知。这个练习 [@problem_id:2760658] 以 TAS2R38 受体多态性与苯硫脲 (PTC) 苦味感知能力的经典案例为背景，要求你综合运用群体遗传学、基因型特异的受体动力学和表型分类标准。这项综合性练习挑战你连接多个生物学尺度，从等位基因频率和受体功能，最终预测出人群中“超级品尝者”的比例。", "problem": "味觉感受器2型家族 (TAS2R) 中的一种苦味感受器 TAS2R38，通过一个 G 蛋白偶联级联反应（味转导素 (gustducin)、磷脂酶Cβ2 (PLC$\\beta$2)、三磷酸肌醇、瞬时受体电位阳离子通道亚家族M成员5 (TRPM5)）来介导对苯硫脲 (PTC) 和 6-正丙基硫氧嘧啶 (PROP) 的检测，该级联反应将受体占有率转化为转导电流。假设在固定的刺激物浓度下，菌状乳头味觉细胞中的受体转导过程可以由一个基于配体结合和下游增益的希尔型输入-输出函数来概括。在一个针对两种 TAS2R38 单倍型——脯氨酸-丙氨酸-缬氨酸（PAV，记为等位基因 $\\mathrm{P}$）和丙氨酸-缬氨酸-异亮氨酸（AVI，记为等位基因 $\\mathrm{A}$）——处于哈迪-温伯格平衡的群体中，设等位基因频率为 $f_{\\mathrm{P}}=0.6$ 和 $f_{\\mathrm{A}}=0.4$。\n\n在刺激物浓度为 $C^{*}=30\\,\\mu\\text{M}$ 时，假设单个等位基因产物的基因型特异性适应前反应 $R(C^{*})$ 服从希尔函数 $R(C)=E_{\\max}\\,\\dfrac{C^{n}}{EC_{50}^{n}+C^{n}}$，其参数如下：\n- 对于 $\\mathrm{P}$ 等位基因产物：$E_{\\max}^{\\mathrm{P}}=1.0$，$EC_{50}^{\\mathrm{P}}=3\\,\\mu\\text{M}$，以及 $n_{\\mathrm{P}}=1.2$。\n- 对于 $\\mathrm{A}$ 等位基因产物：$E_{\\max}^{\\mathrm{A}}=0.4$，$EC_{50}^{\\mathrm{A}}=300\\,\\mu\\text{M}$，以及 $n_{\\mathrm{A}}=1.0$。\n\n假设在杂合（$\\mathrm{P}/\\mathrm{A}$）味觉细胞中，两种等位基因产物共表达，并以偏向 $\\mathrm{P}$ 等位基因的相对表达权重，加性地贡献于适应前反应：杂合子的适应前反应为 $R_{\\mathrm{het,pre}}(C)=w\\,R_{\\mathrm{P}}(C)+(1-w)\\,R_{\\mathrm{A}}(C)$，其中 $w=0.7$。对于所有基因型，一个与基因型无关的适应因子 $\\alpha=0.85$ 会对适应前反应进行缩放，从而得到有效转导反应 $R_{\\mathrm{eff}}=\\alpha\\,R_{\\mathrm{pre}}$。\n\n在此浓度下，将“超级味觉者”表型定义为任何有效转导反应达到或超过标准 $r^{*}=0.6$ 的个体。仅使用上述假设和关于基因型频率的哈迪-温伯格定律，计算该群体中超级味觉者的预期比例，并以小数形式表示结果。将您的答案四舍五入至四位有效数字。不要使用百分号。", "solution": "问题陈述经分析，被确定为具有科学依据、问题明确且信息自洽。它基于遗传学和生物物理学中已确立的原理，提出了一个味觉转导的定量模型。所有必需的参数和定义均已提供。我们开始进行解答。\n\n任务是计算群体中被归类为“超级味觉者”的比例，其定义为在刺激物浓度 $C^{*} = 30\\,\\mu\\text{M}$ 下，其有效转导反应 $R_{\\mathrm{eff}}$ 达到或超过阈值 $r^{*} = 0.6$ 的个体。解答过程需要三部分的计算：首先，使用哈迪-温伯格原理确定基因型频率；其次，计算每种基因型的有效反应；第三，确定哪些基因型符合超级味觉者标准，并将其群体频率相加。\n\n首先，我们计算处于哈迪-温伯格平衡状态下的群体的基因型频率。两种等位基因的频率分别为：尝味等位基因 $\\mathrm{P}$（PAV单倍型）的频率 $f_{\\mathrm{P}} = 0.6$，以及非尝味等位基因 $\\mathrm{A}$（AVI单倍型）的频率 $f_{\\mathrm{A}} = 0.4$。三种可能的基因型（$\\mathrm{P}/\\mathrm{P}$、$\\mathrm{P}/\\mathrm{A}$、$\\mathrm{A}/\\mathrm{A}$）的频率由以下公式给出：\n-   纯合尝味者（$\\mathrm{P}/\\mathrm{P}$）的频率：$f(\\mathrm{P}/\\mathrm{P}) = f_{\\mathrm{P}}^{2} = (0.6)^{2} = 0.36$\n-   杂合个体（$\\mathrm{P}/\\mathrm{A}$）的频率：$f(\\mathrm{P}/\\mathrm{A}) = 2f_{\\mathrm{P}}f_{\\mathrm{A}} = 2(0.6)(0.4) = 0.48$\n-   纯合非尝味者（$\\mathrm{A}/\\mathrm{A}$）的频率：$f(\\mathrm{A}/\\mathrm{A}) = f_{\\mathrm{A}}^{2} = (0.4)^{2} = 0.16$\n这些频率的总和为 $0.36 + 0.48 + 0.16 = 1.0$，符合要求。\n\n其次，我们计算在刺激物浓度 $C^{*} = 30\\,\\mu\\text{M}$ 下，每种基因型的适应前反应 $R_{\\mathrm{pre}}$ 和有效反应 $R_{\\mathrm{eff}}$。每种等位基因产物的反应由希尔函数 $R(C) = E_{\\max}\\,\\dfrac{C^{n}}{EC_{50}^{n}+C^{n}}$ 决定。\n\n对于 $\\mathrm{P}$ 等位基因产物，参数为 $E_{\\max}^{\\mathrm{P}} = 1.0$，$EC_{50}^{\\mathrm{P}} = 3\\,\\mu\\text{M}$ 和 $n_{\\mathrm{P}} = 1.2$：\n$$R_{\\mathrm{P}}(C^{*}) = 1.0 \\times \\frac{(30)^{1.2}}{(3)^{1.2} + (30)^{1.2}} = \\frac{1}{\\left(\\frac{3}{30}\\right)^{1.2} + 1} = \\frac{1}{0.1^{1.2} + 1}$$\n数值为 $R_{\\mathrm{P}}(30) \\approx \\dfrac{1}{0.0630957 + 1} \\approx 0.940648$。\n\n对于 $\\mathrm{A}$ 等位基因产物，参数为 $E_{\\max}^{\\mathrm{A}} = 0.4$，$EC_{50}^{\\mathrm{A}} = 300\\,\\mu\\text{M}$ 和 $n_{\\mathrm{A}} = 1.0$：\n$$R_{\\mathrm{A}}(C^{*}) = 0.4 \\times \\frac{(30)^{1.0}}{(300)^{1.0} + (30)^{1.0}} = 0.4 \\times \\frac{30}{330} = 0.4 \\times \\frac{1}{11} = \\frac{2}{55}$$\n数值为 $R_{\\mathrm{A}}(30) \\approx 0.036364$。\n\n现在，我们使用适应因子 $\\alpha = 0.85$ 来确定每种基因型的有效反应 $R_{\\mathrm{eff}} = \\alpha R_{\\mathrm{pre}}$。\n\n对于 $\\mathrm{P}/\\mathrm{P}$ 基因型，适应前反应完全由 $\\mathrm{P}$ 等位基因产物决定：\n$R_{\\mathrm{pre, PP}}(30) = R_{\\mathrm{P}}(30) \\approx 0.940648$。\n有效反应是：\n$R_{\\mathrm{eff, PP}} = \\alpha \\times R_{\\mathrm{pre, PP}}(30) = 0.85 \\times 0.940648 \\approx 0.79955$。\n\n对于 $\\mathrm{A}/\\mathrm{A}$ 基因型，适应前反应完全由 $\\mathrm{A}$ 等位基因产物决定：\n$R_{\\mathrm{pre, AA}}(30) = R_{\\mathrm{A}}(30) \\approx 0.036364$。\n有效反应是：\n$R_{\\mathrm{eff, AA}} = \\alpha \\times R_{\\mathrm{pre, AA}}(30) = 0.85 \\times 0.036364 \\approx 0.03091$。\n\n对于杂合 $\\mathrm{P}/\\mathrm{A}$ 基因型，适应前反应是加权和，其中 $w = 0.7$：\n$R_{\\mathrm{pre, PA}}(30) = w R_{\\mathrm{P}}(30) + (1-w) R_{\\mathrm{A}}(30) = (0.7 \\times 0.940648) + (0.3 \\times 0.036364)$。\n$R_{\\mathrm{pre, PA}}(30) \\approx 0.658454 + 0.010909 = 0.669363$。\n有效反应是：\n$R_{\\mathrm{eff, PA}} = \\alpha \\times R_{\\mathrm{pre, PA}}(30) = 0.85 \\times 0.669363 \\approx 0.56896$。\n\n第三，我们根据超级味觉者标准 $R_{\\mathrm{eff}} \\ge r^{*} = 0.6$ 对每种基因型进行分类。\n-   对于 $\\mathrm{P}/\\mathrm{P}$：$R_{\\mathrm{eff, PP}} \\approx 0.79955$。由于 $0.79955 \\ge 0.6$，这些个体是超级味觉者。\n-   对于 $\\mathrm{P}/\\mathrm{A}$：$R_{\\mathrm{eff, PA}} \\approx 0.56896$。由于 $0.56896 < 0.6$，这些个体不是超级味觉者。\n-   对于 $\\mathrm{A}/\\mathrm{A}$：$R_{\\mathrm{eff, AA}} \\approx 0.03091$。由于 $0.03091 < 0.6$，这些个体不是超级味觉者。\n\n在指定条件下，只有 $\\mathrm{P}/\\mathrm{P}$ 基因型符合超级味觉者表型的标准。因此，群体中超级味觉者的预期比例等于 $\\mathrm{P}/\\mathrm{P}$ 基因型的频率。\n\n超级味觉者比例 = $f(\\mathrm{P}/\\mathrm{P}) = 0.36$。\n\n问题要求结果以四舍五入到四位有效数字的小数表示。这得到 $0.3600$。", "answer": "$$\n\\boxed{0.3600}\n$$", "id": "2760658"}, {"introduction": "最后，我们将通过构建动态模型，深入探索甜味、鲜味和苦味共用的 G 蛋白偶联受体 (GPCR) 信号级联。与之前的稳态分析不同，这个练习 [@problem_id:2760644] 让你使用常微分方程 (ODE) 捕捉信号通路中各个组分随时间演变的动态过程。通过这个计算实践，你将建立一个“虚拟”的味觉细胞，并探究信号网络的动力学参数和拓扑结构如何共同决定系统的整体响应特性，例如产生超敏性 (ultrasensitivity) 这一关键的涌现属性。", "problem": "要求您构建并分析一个最小但机理上可信的常微分方程模型，用于描述甜味、鲜味或苦味配体的G蛋白偶联味觉受体转导过程。该模型必须将受体占据、异源三聚体G蛋白激活、Phospholipase C beta 2 (PLCβ2) 活性、三磷酸肌醇 ($IP_3$) 动态、细胞内钙离子 ($Ca^{2+}$) 释放以及 Transient Receptor Potential Melastatin 5 (TRPM5) 通道开放联系起来。所有量均为无量纲，时间单位为任意归一化单位。\n\n在您的推导和实现中，请仅使用以下基本定律和事实作为基础：\n- 用于受体-配体相互作用的质量作用结合定律，以及用于信号中间体的一阶失活。\n- 用于协同过程的希尔型S形激活，包括 $Ca^{2+}$ 依赖的 PLCβ2 激活、$IP_3$ 受体介导的 $Ca^{2+}$ 释放，以及 $Ca^{2+}$ 对 TRPM5 的门控。\n- 因果通路：味觉G蛋白偶联受体的配体占据会激活G蛋白，G蛋白进而刺激PLCβ2；PLCβ2产生$IP_3$，$IP_3$与内质网上的$IP_3$受体结合，从而将$Ca^{2+}$释放到胞质溶胶中；胞质溶胶中的$Ca^{2+}$打开TRPM5通道。\n\n定义以下状态变量，每个变量都是时间 $t$ 的函数：受体激活分数 $R(t)$、激活G蛋白分数 $G(t)$、激活PLCβ2分数 $P(t)$、$IP_3$ 水平 $I(t)$、胞质钙离子浓度 $C(t)$ 和TRPM5开放概率 $T(t)$。令 $L$ 表示细胞外配体浓度，视为一个恒定输入。\n\n实现以下由非负常数参数化的最小ODE组：\n- 基于质量作用定律的受体占据：\n$$\\frac{dR}{dt} = k_{\\mathrm{on}}\\,L\\,(1 - R) - k_{\\mathrm{off}}\\,R.$$\n- 由激活受体引起的G蛋白激活与失活：\n$$\\frac{dG}{dt} = k_{G}^{\\mathrm{act}}\\,R\\,(1 - G) - k_{G}^{\\mathrm{deact}}\\,G.$$\n- 需要 $G$ 和 $Ca^{2+}$ 的PLCβ2激活，具有希尔非线性和一阶失活：\n$$\\frac{dP}{dt} = k_{P}^{\\mathrm{act}}\\,H(G;K_G,n_G)\\,H(C;K_C,n_{P\\_Ca})\\,(1 - P) - k_{P}^{\\mathrm{deact}}\\,P.$$\n- 由激活的PLCβ2产生的$IP_3$以及其一阶降解：\n$$\\frac{dI}{dt} = v_{I}^{\\mathrm{prod}}\\,P\\,(1 - I) - k_{I}^{\\mathrm{deg}}\\,I.$$\n- 由$IP_3$受体控制的$Ca^{2+}$释放以及从胞质溶胶中泵出：\n$$\\frac{dC}{dt} = v_{C}^{\\mathrm{rel}}\\,H(I;K_I,n_I)\\,(1 - C) - v_{C}^{\\mathrm{pump}}\\,C.$$\n- TRPM5门控，作为一个向$Ca^{2+}$依赖的稳态进行的一阶弛豫过程：\n$$\\frac{dT}{dt} = \\frac{H(C;K_T,n_T) - T}{\\tau_T}.$$\n这里 $H(x;K,n)$ 是希尔函数：\n$$H(x;K,n) = \\frac{x^{n}}{K^{n} + x^{n}},$$\n其中 $x \\ge 0$, $K > 0$, 且 $n \\ge 1$。\n\n您的程序必须：\n1. 对于下面的每个测试用例（一个参数集），通过对数间距的一组配体浓度 $L \\in [10^{-6}, 10^{2}]$（采样 $N = 41$ 个点）进行数值积分，将ODE求解至稳态，以计算稳态剂量反应 $T^\\ast(L)$。\n2. 对于每个测试用例，通过将分数响应 $T^\\ast(L)/\\max_{L}T^\\ast(L)$ 在其值位于0.1和0.9之间的范围内拟合到一个希尔函数 $L^{n}/(EC_{50}^{n} + L^{n})$，来估计稳态映射 $L \\mapsto T^\\ast(L)$ 的有效希尔系数 $n_{\\mathrm{eff}}$。如果拟合失败或点数不足，则将 $n_{\\mathrm{eff}}$ 估计为分数响应的logit变换对 $\\log L$ 在中点附近的局部斜率。\n3. 通过将 $n_{\\mathrm{eff}}$ 与阈值 $n_{\\mathrm{th}} = 2.5$ 进行比较，判断测试用例是否为超敏。为每个测试用例输出一个布尔值，指示是否 $n_{\\mathrm{eff}} > n_{\\mathrm{th}}$。\n4. 所有的ODE积分必须强制状态变量的非负性，并使用合理的容差以确保收敛。\n\n除非在测试用例中另有规定，否则所有模拟均使用以下常数：\n- $k_{\\mathrm{on}} = 1.0$, $k_{\\mathrm{off}} = 1.0$, $k_{G}^{\\mathrm{act}} = 5.0$, $k_{G}^{\\mathrm{deact}} = 1.0$, $k_{P}^{\\mathrm{act}} = 2.0$, $k_{P}^{\\mathrm{deact}} = 1.0$, $v_{I}^{\\mathrm{prod}} = 2.0$, $v_{C}^{\\mathrm{rel}} = 5.0$, $K_G = 0.3$, $n_G = 1.0$, $K_C = 0.3$, $K_I = 0.2$, $K_T = 0.3$, $n_T = 3.0$, $\\tau_T = 0.1$。\n\n测试套件（每个案例指定 $(n_{P\\_Ca}, n_I, k_{I}^{\\mathrm{deg}}, v_{C}^{\\mathrm{pump}})$；所有未指定的常数均如上所述）：\n- 案例A（基线协同性）：$(2.0, 2.0, 1.0, 1.0)$。\n- 案例B（强非线性，预期超敏）：$(3.5, 3.0, 0.5, 0.8)$。\n- 案例C（PLCβ2的弱$Ca^{2+}$依赖性）：$(1.0, 2.0, 1.0, 1.0)$。\n- 案例D（强$IP_3$降解和强$Ca^{2+}$泵出）：$(3.0, 3.0, 3.0, 3.0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[resultA,resultB,resultC,resultD]”），其中每个项目都是一个布尔值，按顺序对应于案例 A、B、C 和 D。所有值都是无量纲的；不需要物理单位。最终的布尔值必须不带引号打印。\n\n您的实现必须是一个完整的、可在通用编程语言中运行的程序，并且不得要求任何输入。", "solution": "问题陈述经过验证。\n\n**第1步：提取给定信息**\n- **状态变量**：$R(t)$、$G(t)$、$P(t)$、$I(t)$、$C(t)$、$T(t)$，全部为无量纲。\n- **输入**：配体浓度 $L$，一个常数。\n- **希尔函数**：$H(x;K,n) = \\frac{x^{n}}{K^{n} + x^{n}}$，其中 $x \\ge 0$, $K > 0$, 且 $n \\ge 1$。\n- **ODE系统**：\n    1.  $\\frac{dR}{dt} = k_{\\mathrm{on}}\\,L\\,(1 - R) - k_{\\mathrm{off}}\\,R$\n    2.  $\\frac{dG}{dt} = k_{G}^{\\mathrm{act}}\\,R\\,(1 - G) - k_{G}^{\\mathrm{deact}}\\,G$\n    3.  $\\frac{dP}{dt} = k_{P}^{\\mathrm{act}}\\,H(G;K_G,n_G)\\,H(C;K_C,n_{P\\_Ca})\\,(1 - P) - k_{P}^{\\mathrm{deact}}\\,P$\n    4.  $\\frac{dI}{dt} = v_{I}^{\\mathrm{prod}}\\,P\\,(1 - I) - k_{I}^{\\mathrm{deg}}\\,I$\n    5.  $\\frac{dC}{dt} = v_{C}^{\\mathrm{rel}}\\,H(I;K_I,n_I)\\,(1 - C) - v_{C}^{\\mathrm{pump}}\\,C$\n    6.  $\\frac{dT}{dt} = \\frac{H(C;K_T,n_T) - T}{\\tau_T}$\n- **默认常数**：$k_{\\mathrm{on}} = 1.0$, $k_{\\mathrm{off}} = 1.0$, $k_{G}^{\\mathrm{act}} = 5.0$, $k_{G}^{\\mathrm{deact}} = 1.0$, $k_{P}^{\\mathrm{act}} = 2.0$, $k_{P}^{\\mathrm{deact}} = 1.0$, $v_{I}^{\\mathrm{prod}} = 2.0$, $v_{C}^{\\mathrm{rel}} = 5.0$, $K_G = 0.3$, $n_G = 1.0$, $K_C = 0.3$, $K_I = 0.2$, $K_T = 0.3$, $n_T = 3.0$, $\\tau_T = 0.1$。\n- **测试用例**（指定 $(n_{P\\_Ca}, n_I, k_{I}^{\\mathrm{deg}}, v_{C}^{\\mathrm{pump}})$）：\n    - 案例 A: $(2.0, 2.0, 1.0, 1.0)$\n    - 案例 B: $(3.5, 3.0, 0.5, 0.8)$\n    - 案例 C: $(1.0, 2.0, 1.0, 1.0)$\n    - 案例 D: $(3.0, 3.0, 3.0, 3.0)$\n- **计算任务**：\n    1.  对于 $L \\in [10^{-6}, 10^{2}]$ 范围内的 $N=41$ 个对数间隔点，计算稳态剂量反应 $T^\\ast(L)$。\n    2.  通过将曲线 $T^\\ast(L) / \\max_{L}T^\\ast(L)$ 在响应范围 $[0.1, 0.9]$ 内拟合到希尔函数，来估计有效希尔系数 $n_{\\mathrm{eff}}$，或使用logit-log图的局部斜率作为备用方法。\n    3.  如果 $n_{\\mathrm{eff}} > n_{\\mathrm{th}} = 2.5$，则分类为超敏。\n    4.  为每个案例输出一个布尔值。\n\n**第2步：使用提取的给定信息进行验证**\n- **科学依据**：该问题基于生物化学动力学原理，特别是用于结合的质量作用动力学和一阶衰变，以及用于协同酶促和通道门控过程的希尔函数。这是计算系统生物学中使用的G蛋白偶联受体（GPCR）信号级联的一个标准且机理上合理的简化模型。\n- **适定性**：该问题定义了一个由六个耦合的非线性一阶常微分方程组成的系统。根据Picard-Lindelöf定理，给定一组非负参数和初始条件（所有状态变量从0开始），可以保证在有限时间间隔内存在唯一解。该模型结构包含每个组分的激活和失活/降解项，这表明对于任何恒定输入 $L$，系统将收敛到一个唯一的稳定稳态，从而使问题具有适定性。\n- **客观性**：该问题完全使用客观的数学语言表述，没有主观或模糊的术语。\n- 所有其他验证标准均已满足。该问题是自包含的、计算上可行的，并且与指定的科学领域相关。它不包含矛盾、事实错误或无法验证的声明。\n\n**第3步：结论与行动**\n该问题被判定为**有效**。将构建一个解决方案。\n\n**方法论**\n\n该问题要求分析一个模拟味觉转导通路的动力学系统。该系统由一组6个耦合常微分方程（ODEs）描述，代表关键信号分子的浓度或活性的时间演化。状态向量定义为 $\\vec{y}(t) = [R(t), G(t), P(t), I(t), C(t), T(t)]^T$。\n\n首先，构建一个实现ODE系统 $\\frac{d\\vec{y}}{dt} = f(t, \\vec{y}, \\text{params})$ 的函数，其中 `params` 是一个包含配体浓度 $L$ 以及所有速率常数和希尔参数的结构。未受刺激细胞的初始条件为 $\\vec{y}(0) = \\vec{0}$。\n\n为了生成剂量反应曲线 $T^\\ast(L)$，我们必须确定TRPM5通道的稳态开放概率 $T^\\ast$ 在一系列配体浓度 $L$ 下的值。浓度在区间 $[10^{-6}, 10^{2}]$ 内以对数间隔取 $N=41$ 个点。对于每个 $L$ 值，ODE系统在一个足够长的时间间隔内进行数值积分，以确保系统松弛到其稳态。积分得到的最后一个状态变量 $T(t)$ 的值被视为稳态值 $T^\\ast(L)$。SciPy库中的 `solve_ivp` 函数适合此任务，因为它为求解初值问题提供了鲁棒和自适应的算法。\n\n核心任务是量化剂量反应曲线 $L \\mapsto T^\\ast(L)$ 的“陡峭度”或“开关特性”。这通过估计有效希尔系数 $n_{\\mathrm{eff}}$ 来完成。首先将响应数据 $T^\\ast(L)$ 对其最大值进行归一化，得到分数响应 $T_{\\mathrm{frac}}(L) = T^\\ast(L) / \\max_{L} T^\\ast(L)$。\n\n估计 $n_{\\mathrm{eff}}$ 的主要方法是非线性最小二乘拟合。选取 $0.1 \\le T_{\\mathrm{frac}}(L) \\le 0.9$ 的数据点 $(L, T_{\\mathrm{frac}}(L))$。将这些点拟合到双参数希尔函数 $H(L; EC_{50}, n_{\\mathrm{eff}}) = \\frac{L^{n_{\\mathrm{eff}}}}{EC_{50}^{n_{\\mathrm{eff}}} + L^{n_{\\mathrm{eff}}}}$。使用SciPy优化模块中的 `curve_fit` 函数来找到 $EC_{50}$ 和 $n_{\\mathrm{eff}}$ 的最优值。\n\n对于拟合失败或因目标范围内数据点不足而不可靠的情况，指定了一种备用方法。该方法利用了希尔方程的logit变换所产生的线性关系：\n$$ \\log\\left(\\frac{T_{\\mathrm{frac}}}{1 - T_{\\mathrm{frac}}}\\right) = n_{\\mathrm{eff}} \\log(L) - n_{\\mathrm{eff}} \\log(EC_{50}) $$\n这表明 $\\log(T_{\\mathrm{frac}} / (1 - T_{\\mathrm{frac}}))$ 对 $\\log(L)$ 的图是一条斜率为 $n_{\\mathrm{eff}}$ 的直线。因此，我们通过计算该变换图在响应中点附近（即 $T_{\\mathrm{frac}} \\approx 0.5$ 处）的局部斜率来估计 $n_{\\mathrm{eff}}$。\n\n最后，对于四个测试用例中的每一个，将估计的 $n_{\\mathrm{eff}}$ 与阈值 $n_{\\mathrm{th}} = 2.5$ 进行比较。如果 $n_{\\mathrm{eff}} > n_{\\mathrm{th}}$，则系统响应被归类为超敏，并记录布尔值 `True`。否则，记录为 `False`。整个过程被封装在一个程序中，该程序针对四个指定的参数集执行，并输出布尔结果列表。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the taste transduction ODE model and determines ultrasensitivity\n    for four test cases.\n    \"\"\"\n    \n    # --- Model Definition ---\n    \n    def hill_function(x, K, n):\n        \"\"\"Standard Hill function.\"\"\"\n        # Add a small epsilon to prevent division by zero if x and K are 0\n        x_n = x**n\n        K_n = K**n\n        return x_n / (K_n + x_n + 1e-12)\n\n    def ode_system(t, y, params):\n        \"\"\"The system of 6 ODEs for taste transduction.\"\"\"\n        R, G, P, I, C, T = y\n        \n        # Ensure states remain non-negative\n        R, G, P, I, C, T = max(0, R), max(0, G), max(0, P), max(0, I), max(0, C), max(0, T)\n\n        # Unpack parameters\n        L = params['L']\n        k_on, k_off = params['k_on'], params['k_off']\n        k_G_act, k_G_deact = params['k_G_act'], params['k_G_deact']\n        k_P_act, k_P_deact = params['k_P_act'], params['k_P_deact']\n        v_I_prod, k_I_deg = params['v_I_prod'], params['k_I_deg']\n        v_C_rel, v_C_pump = params['v_C_rel'], params['v_C_pump']\n        tau_T = params['tau_T']\n        K_G, n_G = params['K_G'], params['n_G']\n        K_C, n_P_Ca = params['K_C'], params['n_P_Ca']\n        K_I, n_I = params['K_I'], params['n_I']\n        K_T, n_T = params['K_T'], params['n_T']\n        \n        # ODEs\n        dR_dt = k_on * L * (1.0 - R) - k_off * R\n        dG_dt = k_G_act * R * (1.0 - G) - k_G_deact * G\n        dP_dt = k_P_act * hill_function(G, K_G, n_G) * hill_function(C, K_C, n_P_Ca) * (1.0 - P) - k_P_deact * P\n        dI_dt = v_I_prod * P * (1.0 - I) - k_I_deg * I\n        dC_dt = v_C_rel * hill_function(I, K_I, n_I) * (1.0 - C) - v_C_pump * C\n        dT_dt = (hill_function(C, K_T, n_T) - T) / tau_T\n        \n        return [dR_dt, dG_dt, dP_dt, dI_dt, dC_dt, dT_dt]\n\n    # --- Analysis Functions ---\n    def fit_hill_function(L, T_frac):\n        \"\"\"Fits a Hill function to the dose-response curve to find n_eff.\"\"\"\n        def hill_model(x, n, ec50):\n            return x**n / (ec50**n + x**n)\n\n        # Select data points between 0.1 and 0.9 of max response\n        mask = (T_frac >= 0.1) & (T_frac <= 0.9)\n        L_fit = L[mask]\n        T_frac_fit = T_frac[mask]\n\n        if len(L_fit) < 3:  # Not enough points to fit reliably\n            return None\n\n        try:\n            p0 = [1.0, np.median(L_fit)]  # Initial guess for [n, ec50]\n            bounds = ([0.1, 1e-7], [10.0, 1e3])\n            popt, _ = curve_fit(hill_model, L_fit, T_frac_fit, p0=p0, bounds=bounds)\n            n_eff = popt[0]\n            return n_eff\n        except (RuntimeError, ValueError):\n            return None\n\n    def estimate_n_eff_slope(L, T_frac):\n        \"\"\"Estimates n_eff from the logit-log slope as a fallback.\"\"\"\n        midpoint_idx = np.argmin(np.abs(T_frac - 0.5))\n\n        # Check for valid points around the midpoint for finite difference\n        if midpoint_idx == 0 or midpoint_idx == len(L) - 1:\n            return 1.0 # Cannot compute slope, return default\n\n        # Use indices around the midpoint\n        indices_to_check = [midpoint_idx - 1, midpoint_idx, midpoint_idx + 1]\n        valid_indices = []\n        for i in indices_to_check:\n            if 0.001 < T_frac[i] < 0.999: # Ensure logit is well-behaved\n                valid_indices.append(i)\n        \n        if len(valid_indices) < 2:\n            return 1.0 # Not enough valid points, return default\n\n        # Use finite difference on the valid points\n        # Using two outer points for a more stable slope calculation\n        i1 = valid_indices[0]\n        i2 = valid_indices[-1]\n        if i1 == i2:\n            return 1.0\n\n        logit_y1 = np.log(T_frac[i1] / (1.0 - T_frac[i1]))\n        logit_y2 = np.log(T_frac[i2] / (1.0 - T_frac[i2]))\n        \n        log_L1 = np.log(L[i1])\n        log_L2 = np.log(L[i2])\n\n        if np.isclose(log_L2, log_L1):\n            return 1.0\n\n        n_eff = (logit_y2 - logit_y1) / (log_L2 - log_L1)\n        return n_eff\n    \n    # --- Simulation Setup ---\n    \n    base_params = {\n        'k_on': 1.0, 'k_off': 1.0,\n        'k_G_act': 5.0, 'k_G_deact': 1.0,\n        'k_P_act': 2.0, 'k_P_deact': 1.0,\n        'v_I_prod': 2.0, 'k_I_deg': 1.0,\n        'v_C_rel': 5.0, 'v_C_pump': 1.0,\n        'K_G': 0.3, 'n_G': 1.0,\n        'K_C': 0.3, 'n_P_Ca': 2.0,\n        'K_I': 0.2, 'n_I': 2.0,\n        'K_T': 0.3, 'n_T': 3.0,\n        'tau_T': 0.1,\n    }\n\n    test_cases = {\n        'A': {'n_P_Ca': 2.0, 'n_I': 2.0, 'k_I_deg': 1.0, 'v_C_pump': 1.0},\n        'B': {'n_P_Ca': 3.5, 'n_I': 3.0, 'k_I_deg': 0.5, 'v_C_pump': 0.8},\n        'C': {'n_P_Ca': 1.0, 'n_I': 2.0, 'k_I_deg': 1.0, 'v_C_pump': 1.0},\n        'D': {'n_P_Ca': 3.0, 'n_I': 3.0, 'k_I_deg': 3.0, 'v_C_pump': 3.0},\n    }\n    \n    L_values = np.logspace(-6, 2, 41)\n    y0 = np.zeros(6)\n    t_span = (0, 500) # Integration time, long enough for steady state\n    n_th = 2.5\n    results = []\n\n    # --- Main Loop ---\n    \n    for case_id in ['A', 'B', 'C', 'D']:\n        params = base_params.copy()\n        params.update(test_cases[case_id])\n        \n        T_star = np.zeros_like(L_values)\n        \n        for i, L_val in enumerate(L_values):\n            current_params = params.copy()\n            current_params['L'] = L_val\n            \n            sol = solve_ivp(\n                fun=ode_system,\n                t_span=t_span,\n                y0=y0,\n                method='Radau',\n                args=(current_params,),\n                dense_output=True,\n                rtol=1e-6,\n                atol=1e-8\n            )\n            \n            # The last value is the steady state\n            T_star[i] = sol.y[5, -1]\n        \n        # --- Hill Coefficient Estimation ---\n        T_max = np.max(T_star)\n        if T_max < 1e-6: # No response\n            n_eff = 1.0\n        else:\n            T_frac = T_star / T_max\n            n_eff = fit_hill_function(L_values, T_frac)\n            if n_eff is None:\n                n_eff = estimate_n_eff_slope(L_values, T_frac)\n        \n        is_ultrasensitive = n_eff > n_th\n        results.append(is_ultrasensitive)\n\n    # --- Final Output ---\n    # Python booleans True/False need to be lowercase as 'true'/'false' for output\n    final_output = [str(r).lower() for r in results]\n    print(f\"[{','.join(final_output)}]\")\n\nsolve()\n\n```", "id": "2760644"}]}