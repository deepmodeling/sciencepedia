{"hands_on_practices": [{"introduction": "设计可靠的营养缺陷型菌株是生物安全控制的基石。本练习将超越简单的直觉，介绍一种基于流平衡分析 (Flux Balance Analysis, FBA) 的强大计算方法，用于理性地工程化代谢依赖性。通过将设计挑战构建为一个严格的优化问题，你将学习如何精确识别出实现营养缺陷所需的最小基因敲除组合，这是代谢工程师的一项基本技能。[@problem_id:2716812]", "problem": "您正在利用流通平衡分析 (FBA) 设计一种营养缺陷型生物防护菌株。在稳态下，细胞内代谢物浓度达到平衡，这可以用 $S v = 0$ 来建模，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。反应通量受限于 $L \\le v \\le U$，生长则由一个生物质伪反应的通量表示，该反应的系数向量为 $c$，因此生长速率为 $\\mu = c^{\\top} v$。您可以通过基因敲除来禁用某些反应；在基因-蛋白质-反应 (GPR) 抽象中，假设目标基因与其相关反应之间存在一对一的映射，因此基因敲除会强制相应通量为 $0$。您将构建一个优化问题，选择一个最小的敲除集合，以实现对特定外部供应代谢物的营养缺陷性，然后您将为一个具体的示例网络计算所需的最小敲除数。\n\n请使用线性规划 (LP) 对偶和标准线性化方法，将以下双层设计目标构建为一个单层混合整数线性规划 (MILP) 问题，然后对下面给出的具体实例评估其最优解。该设计目标是最小化敲除数量，使得工程菌株能同时满足以下两种环境条件：\n- 在没有外部代谢物 $X$ 的情况下（环境 $E0$），可实现的最大生长速率为 $0$。\n- 在存在外部代谢物 $X$ 的情况下（环境 $E1$），菌株能够达到至少为 $\\mu^{\\star} > 0$ 的目标生长速率。\n\n使用二元决策变量 $y_j \\in \\{0,1\\}$ 来表示反应 $j$ 是活跃的 ($y_j = 1$) 还是被敲除的 ($y_j = 0$)，并设敲除候选集为 $\\mathcal{K} \\subseteq \\{1,\\dots,n\\}$。对于每个 $j \\in \\mathcal{K}$，在两种环境中都强制执行耦合关系 $0 \\le v_j \\le U_j y_j$。\n\n您的构建必须基于 FBA 的基本形式 $S v = 0$、$L \\le v \\le U$、$\\mu = c^{\\top} v$、两种环境中 $X$ 交换通量边界的定义、LP 的强对偶性，以及对由 $y_j$ 乘以对偶变量产生的双线性项的线性化。除了这些基础知识外，您不应假设任何快捷公式。\n\n然后，在以下为模拟 $X$ 营养缺陷设计的示例网络上评估您的构建。内部代谢物为 $G$、$A$、$B$ 和 $X$。反应 ($v_i$) 如下：\n- $v_1$：葡萄糖输入 $\\varnothing \\to G$，边界为 $0 \\le v_1 \\le 10$。\n- $v_2$：糖酵解 $G \\to 2 A$，不可逆，边界为 $0 \\le v_2 \\le 100$。\n- $v_3$：转化 $A \\to B$，不可逆，边界为 $0 \\le v_3 \\le 100$。\n- $v_4$：合成 $B \\to X$，不可逆，边界为 $0 \\le v_4 \\le 100$。\n- $v_5$：替代合成 $A \\to X$，不可逆，边界为 $0 \\le v_5 \\le 100$。\n- $v_6$：生物质 $A + X \\to \\text{Biomass}$，不可逆，边界为 $0 \\le v_6 \\le 100$。\n- $v_7$：$X$ 输入 $\\varnothing \\to X$，边界为 $0 \\le v_7 \\le b_X$，其中 $b_X$ 取决于环境。\n\n内部代谢物的质量平衡 ($S v = 0$) 为：\n- $G$: $v_1 - v_2 = 0$。\n- $A$: $2 v_2 - v_3 - v_5 - v_6 = 0$。\n- $B$: $v_3 - v_4 = 0$。\n- $X$: $v_4 + v_5 + v_7 - v_6 = 0$。\n\n如上所述，所有反应都是不可逆的。敲除候选集为 $\\mathcal{K} = \\{3,4,5\\}$，即只有 $v_3$、$v_4$ 和 $v_5$ 可以被敲除。生物质目标为 $c^{\\top} v = v_6$。两种环境为：\n- $E0$ (无 $X$ 供应): $b_X = 0$，因此 $0 \\le v_7 \\le 0$。\n- $E1$ (有 $X$ 供应): $b_X = 10$，因此 $0 \\le v_7 \\le 10$。\n\n生长目标为 $\\mu^{\\star} = 5$。\n\n构建单层 MILP，并确定在确保 $E1$ 可行且生物质通量至少为 $\\mu^{\\star}$ 的同时，强制 $E0$ 最大生长为 $0$ 所需的最小敲除数。将您的最终答案报告为一个整数（无单位）。无需四舍五入。", "solution": "所呈现的问题是计算合成生物学领域中一个有效且良态的优化问题。它要求将一个双层优化问题构建为混合整数线性规划（MILP）并为特定实例求解。该问题在科学上基于流通平衡分析（FBA）和代谢工程的原理，提供了一套完整且一致的数据，并且在数学上是可形式化的。我们将着手解决。\n\n解决方案分为两部分。首先，我们从双层目标推导出通用的单层 MILP 构建。其次，我们将此框架应用于给定的示例代谢网络，以确定实现所需营养缺陷表型所需的最小基因敲除数。\n\n设计目标是找到一个由二元变量 $y_j$ 表示的最小基因敲除集，该集合需满足两个条件：\n1. 在环境 $E0$（无外部代谢物 $X$）中，最大可能生长速率必须为 $0$。\n2. 在环境 $E1$（有外部代谢物 $X$）中，生物体必须能够达到至少为 $\\mu^{\\star}$ 的生长速率。\n\n设 $\\mathcal{K}$ 为可被敲除的反应集合。对于 $j \\in \\mathcal{K}$，决策变量 $y_j$ 为 $1$ 表示反应 $j$ 活跃，为 $0$ 表示被敲除。敲除数量为 $\\sum_{j \\in \\mathcal{K}} (1-y_j)$。最小化此值等同于最大化 $\\sum_{j \\in \\mathcal{K}} y_j$。我们将直接最小化敲除数量。\n\n总体的双层问题是：\n$$\n\\min_{y_j \\in \\{0,1\\}, j \\in \\mathcal{K}} \\sum_{j \\in \\mathcal{K}} (1-y_j)\n$$\n受限于：\n$$\n(C1) \\quad \\max_{v^{(0)}} \\{ c^{\\top} v^{(0)} \\mid S v^{(0)}=0, L^{(0)} \\le v^{(0)} \\le U^{(0,y)} \\} \\le 0\n$$\n$$\n(C2) \\quad \\exists v^{(1)} \\text{ s.t. } S v^{(1)}=0, L^{(1)} \\le v^{(1)} \\le U^{(1,y)}, c^{\\top} v^{(1)} \\ge \\mu^{\\star}\n$$\n其中 $U^{(e,y)}$ 表示在环境 $e \\in \\{E0, E1\\}$ 中的上界向量，它依赖于敲除决策 $y$。具体来说，对于 $j \\in \\mathcal{K}$，通量向量 $v$ 的第 $j$ 个分量受限于 $0 \\le v_j \\le U_j y_j$。\n\n环境 $E1$ 的约束 (C2) 是一组线性可行性约束。它要求存在一个满足生长目标的通量向量 $v^{(1)}$。这些约束可以直接包含在最终的 MILP 中。\n\n环境 $E0$ 的约束 (C1) 是对一个内部优化问题解的约束。为了将其转化为一组线性约束，我们引用线性规划的强对偶定理。$E0$ 的原始 FBA 问题是：\n$$\n\\text{(P0)} \\quad \\max_{v^{(0)}} \\quad c^{\\top} v^{(0)}\n$$\n$$\n\\text{s.t.} \\quad S v^{(0)} = 0\n$$\n$$\nL^{(0)} \\le v^{(0)} \\le U^{(0,y)}\n$$\n其对偶问题是：\n$$\n\\text{(D0)} \\quad \\min_{\\lambda, \\alpha, \\beta} \\quad (\\alpha)^{\\top} U^{(0,y)} - (\\beta)^{\\top} L^{(0)}\n$$\n$$\n\\text{s.t.} \\quad S^{\\top} \\lambda + \\alpha - \\beta = c\n$$\n$$\n\\alpha, \\beta \\ge 0, \\quad \\lambda \\text{ 无限制}\n$$\n这里，$\\lambda$、$\\alpha$ 和 $\\beta$ 分别是与约束 $S v^{(0)}=0$、$v^{(0)} \\le U^{(0,y)}$ 和 $v^{(0)} \\ge L^{(0)}$ 相关联的对偶变量。强对偶性断言 (P0) 和 (D0) 的最优目标值相等。因此，约束 $\\max(c^{\\top}v^{(0)}) \\le 0$ 等价于要求对偶目标的最小值小于或等于 $0$。这可以通过要求存在一个可行对偶解 $(\\lambda, \\alpha, \\beta)$ 且其目标值至多为 $0$ 来强制执行。\n\n该约束变为：存在 $(\\lambda, \\alpha, \\beta)$ 使得\n$$\nS^{\\top} \\lambda + \\alpha - \\beta = c\n$$\n$$\n\\alpha, \\beta \\ge 0, \\quad \\lambda \\text{ 无限制}\n$$\n$$\n\\sum_{i \\notin \\mathcal{K}} \\alpha_i U_i^{(0)} + \\sum_{j \\in \\mathcal{K}} \\alpha_j U_j y_j - \\sum_i \\beta_i L_i^{(0)} \\le 0\n$$\n项 $\\sum_{j \\in \\mathcal{K}} \\alpha_j U_j y_j$ 包含变量 $\\alpha_j$ 和 $y_j$ 的乘积。我们通过为每个 $j \\in \\mathcal{K}$ 引入新变量 $z_j = \\alpha_j y_j$ 来线性化这个乘积。这个替换由以下一组线性约束强制执行，其中 $M$ 是一个足够大的正常数（一个“大M”），用作 $\\alpha_j$ 的上界：\n$$\nz_j \\le M y_j\n$$\n$$\nz_j \\ge 0\n$$\n$$\nz_j \\le \\alpha_j\n$$\n$$\nz_j \\ge \\alpha_j - M (1 - y_j)\n$$\n\n结合这些元素，我们得到以下单层 MILP 构建：\n\n**变量：**\n*   $y_j \\in \\{0,1\\}$ 对于 $j \\in \\mathcal{K}$\n*   $v^{(1)}$ ($E1$ 的连续通量向量)\n*   $\\lambda, \\alpha, \\beta$ ($E0$ 的连续对偶变量)\n*   $z_j$ 对于 $j \\in \\mathcal{K}$ (连续线性化变量)\n\n**目标：**\n$$\n\\min \\sum_{j \\in \\mathcal{K}} (1-y_j)\n$$\n\n**约束：**\n$1$. $E1$ 存活约束：\n$$\nS v^{(1)} = 0\n$$\n$$\nL_i^{(1)} \\le v_i^{(1)} \\le U_i^{(1)} \\quad \\forall i \\notin \\mathcal-K\n$$\n$$\n0 \\le v_j^{(1)} \\le U_j y_j \\quad \\forall j \\in \\mathcal{K}\n$$\n$$\nc^{\\top} v^{(1)} \\ge \\mu^{\\star}\n$$\n$2$. $E0$ 营养缺陷约束 (来自 $E0$ FBA 的对偶问题)：\n$$\nS^{\\top} \\lambda + \\alpha - \\beta = c\n$$\n$$\n\\sum_{i \\notin \\mathcal{K}} \\alpha_i U_i^{(0)} + \\sum_{j \\in \\mathcal{K}} z_j U_j - \\sum_i \\beta_i L_i^{(0)} \\le 0\n$$\n$$\nz_j \\le M y_j \\quad \\forall j \\in \\mathcal{K}\n$$\n$$\nz_j \\le \\alpha_j \\quad \\forall j \\in \\mathcal{K}\n$$\n$$\nz_j \\ge \\alpha_j - M (1 - y_j) \\quad \\forall j \\in \\mathcal{K}\n$$\n$$\n\\alpha \\ge 0, \\beta \\ge 0, z_j \\ge 0, \\lambda \\text{ 无限制}\n$$\n这完成了所需的一般构建。\n\n现在，我们对给定的示例网络进行评估。对于如此简单的网络，我们无需构建并计算求解完整的 MILP，而是可以通过对代谢途径的直接逻辑分析来确定解决方案。\n\n网络化学计量如下：\n*   $v_1 - v_2 = 0$\n*   $2 v_2 - v_3 - v_5 - v_6 = 0$\n*   $v_3 - v_4 = 0$\n*   $v_4 + v_5 + v_7 - v_6 = 0$\n生物质反应是 $v_6$，所以 $c^{\\top}v = v_6$。敲除候选集为 $\\mathcal{K} = \\{3,4,5\\}$。\n\n**营养缺陷条件 ($E0$) 分析**\n在环境 $E0$ 中，$X$ 的外部供应为零，所以 $v_7 = 0$。稳态方程变为：\n*   $v_1 = v_2$\n*   $v_3 = v_4$\n*   $v_4 + v_5 = v_6$\n*   $2 v_2 = v_3 + v_5 + v_6$\n\n将 $v_3=v_4$ 和 $v_6=v_4+v_5$ 代入最后一个方程得到：\n$2 v_2 = v_4 + v_5 + (v_4 + v_5) = 2(v_4+v_5)$，简化为 $v_2 = v_4 + v_5$。\n结合这些，我们发现 $v_6 = v_4 + v_5 = v_2 = v_1$。\n由于 $v_1$ 的上界为 $10$，因此没有敲除时的最大可能生长速率为 $v_{6,max} = 10$。\n为强制实现营养缺陷，我们必须确保 $v_6$ 的最大值为 $0$。由于所有反应通量都是非负的，这要求 $v_6=0$。从 $v_6 = v_4 + v_5$ 可知，这必须满足 $v_4=0$ 和 $v_5=0$。\n*   要强制 $v_5 = 0$，我们必须敲除反应 5，即 $y_5 = 0$。\n*   要强制 $v_4 = 0$，我们可以敲除反应 4 ($y_4 = 0$) 或敲除反应 3 ($y_3 = 0$)，因为关系 $v_3=v_4$ 意味着 $v_3=0$ 会导致 $v_4=0$。\n因此，为了诱导对 $X$ 的营养缺陷，我们必须满足逻辑条件 ($y_3=0$ 或 $y_4=0$) 且 ($y_5=0$)。\n满足此条件的最小敲除数为 2。可能的最小敲除集是 $\\{v_3, v_5\\}$ 或 $\\{v_4, v_5\\}$。单个敲除是不够的。例如，仅敲除 $v_5$ ($y_5=0$) 会保留通过 $v_3$ 和 $v_4$ 的途径，从而允许生物质生产。\n\n**存活条件 ($E1$) 分析**\n在环境 $E1$ 中，我们有 $X$ 的外部供应， $0 \\le v_7 \\le 10$。生长速率必须至少为 $\\mu^{\\star}=5$。我们必须检查上面确定的最小敲除策略是否允许这种情况。\n\n情况 1：敲除 $\\{v_3, v_5\\}$ (即 $y_3=0, y_5=0, y_4=1$)。\n通量约束为 $v_3=0$ 和 $v_5=0$。化学计量方程变为：\n*   $v_1 - v_2 = 0$\n*   $2 v_2 - v_6 = 0 \\implies v_6 = 2 v_2$\n*   $v_3 - v_4 = 0 \\implies 0 - v_4 = 0 \\implies v_4 = 0$\n*   $v_7 - v_6 = 0 \\implies v_6 = v_7$\n对于 $v_6=5$ 的生长速率，我们需要 $v_7 = 5$。这是允许的，因为 $0 \\le v_7 \\le 10$。我们还需要 $v_2 = v_6/2 = 2.5$。这要求 $v_1 = 2.5$，这是有效的，因为 $0 \\le v_1 \\le 10$。所有其他通量均为 $v_3=v_4=v_5=0$。因此，此策略有效。\n\n情况 2：敲除 $\\{v_4, v_5\\}$ (即 $y_4=0, y_5=0, y_3=1$)。\n通量约束为 $v_4=0$ 和 $v_5=0$。方程变为：\n*   $v_1 - v_2 = 0$\n*   $2 v_2 - v_3 - v_6 = 0$\n*   $v_3 - v_4 = 0 \\implies v_3 = 0$\n*   $v_7 - v_6 = 0 \\implies v_6 = v_7$\n将 $v_3=0$ 代入第二个方程得到 $2 v_2 - v_6 = 0$，即 $v_6 = 2 v_2$。该方程组与情况 1 相同。$v_6=5$ 的生长速率是可以实现的。\n\n两种最小敲除策略，每种都涉及两次敲除，都满足营养缺陷和存活条件。既然我们已经证明一次敲除是不够的，那么所需的最小敲除数就是 2。", "answer": "$$\n\\boxed{2}\n$$", "id": "2716812"}, {"introduction": "即使最精巧的设计也可能被进化所颠覆。本练习将直面这一挑战，提供一个定量框架来估算突变逃逸出安全控制系统的概率。通过理解“突变靶标大小”这一概念，你将亲手计算单个细胞世代的逃逸率，并由此体会为何组合多个独立的控制机制是确保长期安全性的关键策略。[@problem_id:2716739]", "problem": "一种细菌中的合成遏制设计实现了一种对非标准营养物的营养缺陷型依赖，并可选地包含一个基于毒素的“杀死开关”。请考虑以下与种群遗传学和分子诱变一致的建模假设：\n\n- 每碱基、每分裂的点突变概率为 $\\,\\mu_{b} = 1.0 \\times 10^{-10}\\,$，假设在所有相关位点上相同，并且在各位点和基因座之间是独立的。\n- 在任何遗传模块内，“逃逸”是由一组特定的单核苷酸变化中的任何一个引起的；这些单核苷酸变化是不重叠的，并且每一个本身都足以在该模块内引起逃逸。\n- 不同的遗传模块（例如，营养缺陷型模块和“杀死开关”模块）是不连锁的，并且在单次细胞分裂过程中独立突变。\n- 在此处考虑的单次细胞分裂时间尺度上，插入、缺失、重组、基因转换和选择的影响可以忽略不计。\n\n将有效逃逸突变率 $\\,\\mu_{\\text{eff}}\\,$ 定义为新生细胞已成为逃逸者（即，它可以在没有非标准营养物的情况下生长，并且如果存在“杀死开关”，也不会被其杀死）的每分裂概率。在您的推导中，请仅使用稀有事件组合和独立性的第一性原理。\n\n营养缺陷型模块具有三个遗传上冗余的逃逸途径（任何一个途径发生突变都会导致该模块的逃逸）。每条途径中不同的、赋予逃逸能力的单核苷酸变化的数量为：\n- 途径 A：$\\,25\\,$\n- 途径 B：$\\,12\\,$\n- 途径 C：$\\,8\\,$\n\n基于毒素的“杀死开关”模块有两个不相交的突变靶点，它们可以独立地导致模块逃逸（任何一个靶点突变即可）：\n- 毒素编码序列关键位点：$\\,110\\,$\n- 启动子/操纵子关键核苷酸：$\\,20\\,$\n\n任务：\n1. 从每碱基突变概率和独立性的定义出发，推导当一个模块有 $\\,T\\,$ 个不同的、赋予逃逸能力的单核苷酸靶点时，其在单次分裂中模块级别的逃逸概率表达式。陈述并证明您使用的任何近似方法。\n2. 利用您的结果，推导当逃逸需要两个独立模块（例如，营养缺陷型模块和“杀死开关”模块）同时失效时，设计水平的 $\\,\\mu_{\\text{eff}}\\,$ 表达式，每个模块由其自身的总靶点大小定义。\n3. 对以下情况进行数值估算 $\\,\\mu_{\\text{eff}}\\,$：\n   - 仅实现营养缺陷型模块的单基因座依赖。\n   - 营养缺陷型模块和“杀死开关”模块必须同时失效才能逃逸的双基因座依赖。\n   \n将每个最终数值四舍五入到四位有效数字。用标准科学记数法将您的最终答案表示为无量纲概率。按照上面列出的顺序，将您的两个最终值以单个行向量的形式提供。", "solution": "所述问题具有科学依据，提法明确，并包含足够的信息以得出唯一解。它基于分子遗传学和概率论的既定原理。我们将继续进行推导和求解。\n\n基本已知条件如下：\n每碱基、每分裂的点突变概率为 $\\mu_{b} = 1.0 \\times 10^{-10}$。\n相关位点的突变是独立事件。\n如果一个模块的任何一个特定单核苷酸靶点发生突变，则该模块逃逸。\n只有当其所有组成模块都失效时，整个设计才会逃逸。\n\n分析是按每次细胞分裂进行的。\n\n任务 1：模块级别逃逸概率的推导。\n\n设一个给定的遗传模块包含 $T$ 个不同的、不重叠的单核苷酸位点，在这些位点中，任何一个位点的点突变都足以导致该模块失效（即“逃逸”其预定功能）。在一次细胞分裂中，这些位点中任何一个发生突变的概率为 $\\mu_{b}$。\n\n因此，一个特定位点*不*发生突变的概率是 $1 - \\mu_{b}$。\n为了使模块保持功能，*任何一个* $T$ 个关键位点都不能发生突变。由于突变是独立事件，因此 $T$ 个位点中没有任何一个发生突变的概率是各个不突变概率的乘积：\n$$P(\\text{no escape}) = (1 - \\mu_{b})^{T}$$\n模块逃逸的概率，我们记为 $\\mu_{\\text{module}}$，是该事件的补集。也就是说，如果 $T$ 个位点中至少有一个发生突变，模块就会逃逸。\n$$\\mu_{\\text{module}} = 1 - P(\\text{no escape}) = 1 - (1 - \\mu_{b})^{T}$$\n这是在独立性假设下的精确表达式。\n\n问题要求我们陈述并证明所使用的任何近似方法。鉴于 $\\mu_{b} = 1.0 \\times 10^{-10}$ 是一个极小的数，我们可以对 $(1 - \\mu_{b})^{T}$ 项使用二项式近似。对于一个很小的值 $x$ 和任意实数 $n$，其展开式为 $(1 - x)^{n} \\approx 1 - nx$。\n将此应用于我们的表达式，其中 $x = \\mu_{b}$ 且 $n = T$：\n$$(1 - \\mu_{b})^{T} \\approx 1 - T\\mu_{b}$$\n将此近似值代回 $\\mu_{\\text{module}}$ 的表达式中：\n$$\\mu_{\\text{module}} \\approx 1 - (1 - T\\mu_{b}) = T\\mu_{b}$$\n这种近似的理由是，在 $T$ 个位点中的两个或多个位点同时发生突变的概率可以忽略不计。二项式展开中的下一项是 $\\binom{T}{2}(-\\mu_{b})^2$，其数量级为 $T^2\\mu_{b}^2$。由于 $\\mu_{b}^2$ 的数量级为 $10^{-20}$，对于任何实际的 $T$ 值，该项及所有更高阶的项都小到可以忽略不计。该近似等价于陈述：对于稀有的独立事件，它们并集的概率可以很好地用它们各自概率的总和来近似。\n\n任务 2：两个独立模块的设计级别逃逸概率的推导。\n\n让我们考虑一个由两个独立模块（模块1和模块2）组成的遏制设计，其总单核苷酸靶点大小分别为 $T_{1}$ 和 $T_{2}$。设它们的每分裂逃逸概率分别为 $\\mu_{1}$ 和 $\\mu_{2}$。根据任务1，我们有：\n$$\\mu_{1} \\approx T_{1}\\mu_{b}$$\n$$\\mu_{2} \\approx T_{2}\\mu_{b}$$\n问题指出，要使整个设计失效（即细胞成为“逃逸者”），*两个*模块必须在同一次分裂谱系中同时失效。由于模块被规定为不连锁且独立突变，两个事件同时发生的联合概率是它们各自概率的乘积。\n因此，双模块设计的有效逃逸率 $\\mu_{\\text{eff}}$ 为：\n$$\\mu_{\\text{eff}} = \\mu_{1} \\times \\mu_{2}$$\n代入 $\\mu_{1}$ 和 $\\mu_{2}$ 的近似表达式：\n$$\\mu_{\\text{eff}} \\approx (T_{1}\\mu_{b})(T_{2}\\mu_{b}) = T_{1}T_{2}\\mu_{b}^{2}$$\n该表达式代表了新生细胞获得了使两个遏制模块都失效的突变的每分裂概率。\n\n任务 3：数值估算。\n\n首先，我们必须计算每个模块的总靶点大小 $T$。问题指明，对于每个模块，所列出的任何一个变化都足以导致逃逸。这意味着一个模块的总靶点大小是其不相交的逃逸途径或靶点大小的总和。\n\n对于营养缺陷型模块（我们将其表示为‘aux’），总靶点大小 $T_{\\text{aux}}$ 是其三个冗余途径中靶点的总和：\n$$T_{\\text{aux}} = 25 + 12 + 8 = 45$$\n\n对于基于毒素的“杀死开关”模块（我们将其表示为‘ks’），总靶点大小 $T_{\\text{ks}}$ 是其两个不相交靶点的总和：\n$$T_{\\text{ks}} = 110 + 20 = 130$$\n\n每碱基突变率给定为 $\\mu_{b} = 1.0 \\times 10^{-10}$。\n\n情况 i：单基因座依赖（仅营养缺陷型模块）。\n在这种情况下，设计仅包含营养缺陷型模块。有效逃逸率 $\\mu_{\\text{eff,1}}$ 就是这个单一模块的逃逸率。使用任务1中的公式：\n$$\\mu_{\\text{eff,1}} = \\mu_{\\text{aux}} \\approx T_{\\text{aux}}\\mu_{b} = 45 \\times (1.0 \\times 10^{-10})$$\n$$\\mu_{\\text{eff,1}} = 4.5 \\times 10^{-9}$$\n精确到四位有效数字，结果是 $4.500 \\times 10^{-9}$。\n\n情况 ii：双基因座依赖（营养缺陷型和“杀死开关”模块）。\n在这种情况下，设计要求两个模块同时失效。我们使用任务2中推导的公式：\n$$\\mu_{\\text{eff,2}} \\approx T_{\\text{aux}}T_{\\text{ks}}\\mu_{b}^{2} = (45)(130)(1.0 \\times 10^{-10})^{2}$$\n$$\\mu_{\\text{eff,2}} \\approx 5850 \\times (1.0 \\times 10^{-20})$$\n$$\\mu_{\\text{eff,2}} \\approx 5.85 \\times 10^{3} \\times 10^{-20} = 5.85 \\times 10^{-17}$$\n精确到四位有效数字，结果是 $5.850 \\times 10^{-17}$。\n\n最终答案以行向量的形式呈现。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.500 \\times 10^{-9}  & 5.850 \\times 10^{-17}\n\\end{pmatrix}\n}\n$$", "id": "2716739"}, {"introduction": "任何生物安全策略的最终考验在于其在群体尺度上对抗选择和突变的长期表现。本练习将指导你构建一个计算模型，以模拟具有分层安全控制系统的种群的演化动态。通过实施一个复制子-突变子 (replicator-mutator) 模型，你将探索环境波动和适应性成本如何为补偿性进化创造路径，从而预测安全策略在何种情况下可能最终失效。[@problem_id:2716804]", "problem": "您的任务是实现一个确定性的复制子-变异子模型，用于模拟暴露在两种状态波动环境中的微生物种群中营养缺陷型和自毁开关组件的联合演化。目标是从选择和突变的基本原理出发，指定一个最小但生物学上现实的模型，并计算补偿性演化是否会破坏两个遏制层。这种情况的操作化定义为双重逃逸基因型达到或超过指定的频率阈值。\n\n基本和建模假设：\n- 分子生物学中心法则（CDMB）意味着基因型映射到决定适应度的表型，而选择下的差异性繁殖会改变基因型频率，使其从一代传递到下一代。\n- 在一个包含选择和突变的 Wright–Fisher 模型的确定性、无限种群近似中，基因型频率的更新遵循复制子-变异子动态。如果 $x_i(t)$ 是基因型 $i$ 在第 $t$ 代的频率，$w_i(e)$ 是其在环境 $e$ 中的适应度，并且 $\\mathbf{M}$ 是突变转移矩阵，其元素 $M_{ij}$ 表示 $i$ 型后代变为 $j$ 型的概率，那么一代选择后跟着突变的过程是：\n$$\n\\tilde{x}_i(t) = \\frac{w_i(e_t)\\,x_i(t)}{\\sum_k w_k(e_t)\\,x_k(t)}, \\quad x_j(t+1) = \\sum_i \\tilde{x}_i(t)\\,M_{ij}.\n$$\n- 存在两个工程化的遏制层：营养缺陷型（营养依赖性）和一个自毁开关。每一层都可能完好无损，也可能因突变或补偿性演化而被破坏。\n\n基因型状态空间：\n- 存在四种基因型，每种由两个二元性状编码：营养缺陷型状态和自毁开关状态。\n    - $g_0 = \\mathrm{AK}$：营养缺陷型完好（依赖型），自毁开关完好。\n    - $g_1 = \\mathrm{AM}$：营养缺陷型完好（依赖型），自毁开关突变（失效）。\n    - $g_2 = \\mathrm{CK}$：营养缺陷型被补偿（恢复为原养型），自毁开关完好。\n    - $g_3 = \\mathrm{CM}$：营养缺陷型被补偿，自毁开关突变（双重逃逸）。\n- 初始种群是单态的，$x_0(0) = 1$, $x_1(0) = 0$, $x_2(0) = 0$, $x_3(0) = 0$。\n\n环境与适应度：\n- 环境在宽松状态 $\\mathrm{P}$（营养物存在，自毁开关被抑制）和限制性状态 $\\mathrm{R}$（营养物缺乏，自毁开关被激活）之间交替。\n- 在 $\\mathrm{P}$ 环境中的适应度仅施加代谢负担：\n    - $w_{\\mathrm{AK}}(\\mathrm{P}) = 1 - c_A - c_K$，\n    - $w_{\\mathrm{AM}}(\\mathrm{P}) = 1 - c_A$，\n    - $w_{\\mathrm{CK}}(\\mathrm{P}) = 1 - b_C - c_K$，\n    - $w_{\\mathrm{CM}}(\\mathrm{P}) = 1 - b_C$，\n  其中 $c_A$ 是营养缺陷型工程的负担，$c_K$ 是维持完好自毁开关的负担，$b_C$ 是补偿性原养型的成本。\n- 在 $\\mathrm{R}$ 环境中的适应度因遏制层而施加生存惩罚：\n    - $w_{\\mathrm{AK}}(\\mathrm{R}) = s_A \\, s_K$，\n    - $w_{\\mathrm{AM}}(\\mathrm{R}) = s_A$，\n    - $w_{\\mathrm{CK}}(\\mathrm{R}) = s_K$，\n    - $w_{\\mathrm{CM}}(\\mathrm{R}) = 1$，\n  其中 $s_A \\in (0,1]$ 量化了在营养缺陷型饥饿下的存活率，$s_K \\in (0,1]$ 量化了在激活的自毁开关下的存活率；值越小意味着遏制越强。\n\n突变结构：\n- 设 $u_A$ 为营养缺陷型完好的谱系在每一代中变为补偿型（A→C）的概率，设 $u_K$ 为完好的自毁开关突变为失效状态（K→M）的概率。忽略回复突变。\n- 允许同时发生独立突变时，每种基因型每代的转移概率为：\n    - 从 $\\mathrm{AK}$：以概率 $u_A u_K$ 变为 $\\mathrm{CM}$，以概率 $u_A (1-u_K)$ 变为 $\\mathrm{CK}$，以概率 $(1-u_A) u_K$ 变为 $\\mathrm{AM}$，并以概率 $(1-u_A)(1-u_K)$ 保持为 $\\mathrm{AK}$。\n    - 从 $\\mathrm{AM}$：以概率 $u_A$ 变为 $\\mathrm{CM}$，否则保持为 $\\mathrm{AM}$。\n    - 从 $\\mathrm{CK}$：以概率 $u_K$ 变为 $\\mathrm{CM}$，否则保持为 $\\mathrm{CK}$。\n    - 从 $\\mathrm{CM}$：保持为 $\\mathrm{CM}$。\n\n环境安排：\n- 考虑一个长度为 $L$ 代的周期性安排。在每个周期中，前 $n_R = \\mathrm{round}(f_R \\, L)$ 代是限制性的（$\\mathrm{R}$），剩下的 $L - n_R$ 代是宽松的（$\\mathrm{P}$）。该周期重复进行，直到总共经过 $T$ 代。比例 $f_R \\in [0,1]$ 控制限制性占空比。\n\n“遏制被破坏”的判定规则：\n- 定义一个阈值 $\\tau \\in (0,1)$。经过 $T$ 代后，如果双重逃逸基因型的频率满足 $x_{\\mathrm{CM}}(T) \\ge \\tau$，则宣告补偿性演化破坏了两个遏制层；否则，宣告其没有。\n\n您的任务：\n- 使用上述结构实现复制子-变异子更新，并为每个提供的测试用例计算布尔结果。\n\n测试套件：\n- 使用以下四个测试用例，每个用例指定为一个元组 $(T, L, f_R, s_A, s_K, c_A, c_K, b_C, u_A, u_K, \\tau)$：\n    - 案例1（平衡，强限制，中等负担）：$(T=\\;20000,\\; L=\\;20,\\; f_R=\\;0.5,\\; s_A=\\;0.01,\\; s_K=\\;0.01,\\; c_A=\\;0.01,\\; c_K=\\;0.03,\\; b_C=\\;0.02,\\; u_A=\\;10^{-4},\\; u_K=\\;10^{-4},\\; \\tau=\\;0.5)$。\n    - 案例2（限制稀少，补偿成本高）：$(T=\\;20000,\\; L=\\;100,\\; f_R=\\;0.01,\\; s_A=\\;0.01,\\; s_K=\\;0.01,\\; c_A=\\;0.01,\\; c_K=\\;0.03,\\; b_C=\\;0.05,\\; u_A=\\;10^{-4},\\; u_K=\\;10^{-4},\\; \\tau=\\;0.5)$。\n    - 案例3（始终限制）：$(T=\\;10000,\\; L=\\;10,\\; f_R=\\;1.0,\\; s_A=\\;0.01,\\; s_K=\\;0.01,\\; c_A=\\;0.01,\\; c_K=\\;0.03,\\; b_C=\\;0.02,\\; u_A=\\;10^{-4},\\; u_K=\\;10^{-4},\\; \\tau=\\;0.5)$。\n    - 案例4（遏制屏障不严密且负担高）：$(T=\\_20000,\\_ L=\\_20,\\_ f_R=\\_0.5,\\_ s_A=\\_0.2,\\_ s_K=\\_0.2,\\_ c_A=\\_0.01,\\_ c_K=\\_0.10,\\_ b_C=\\_0.10,\\_ u_A=\\_10^{-4},\\_ u_K=\\_10^{-4},\\_ \\tau=\\_0.5)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个 Python 风格的布尔值列表形式的结果，顺序与测试套件相同，例如 $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{False}]$。不要打印任何额外文本。", "solution": "所提出的问题要求实现一个确定性种群遗传学模型，以模拟一个经过合成工程改造的微生物种群的演化动态。该模型必须考虑在波动环境中的选择和突变。目标是确定一个“双重逃逸”突变体（它已经逃避了两个独立的遏制系统）是否在给定的时间范围内达到指定的频率阈值。\n\n这个问题是有效的。它在科学上基于演化动力学原理，特别是复制子-变异子框架，这是对大型种群的 Wright-Fisher 模型的一个标准确定性近似。问题陈述清晰，为所有测试用例提供了完整的初始条件、确定性更新规则和参数。语言客观，内部设置一致。因此，我们将着手解决。\n\n模型的核心是复制子-变异子方程，它描述了基因型频率在离散、非重叠的世代中的变化。单个世代 $t$ 的过程包括两个步骤：选择，然后是突变。\n\n设 $\\mathbf{x}(t) = [x_0(t), x_1(t), x_2(t), x_3(t)]$ 为第 $t$ 代时四种基因型 $g_0(\\mathrm{AK})$、$g_1(\\mathrm{AM})$、$g_2(\\mathrm{CK})$ 和 $g_3(\\mathrm{CM})$ 的频率行向量。初始状态给定为 $\\mathbf{x}(0) = [1, 0, 0, 0]$。\n\n首先，选择步骤根据当前世代环境 $e_t$ 中的差异适应度来更新频率。基因型 $i$ 的适应度是 $w_i(e_t)$。种群的平均适应度是 $\\bar{w}(t) = \\sum_{k=0}^{3} w_k(e_t) x_k(t)$。选择后基因型 $i$ 的频率是 $\\tilde{x}_i(t)$：\n$$\n\\tilde{x}_i(t) = \\frac{w_i(e_t) x_i(t)}{\\bar{w}(t)}\n$$\n在向量表示法中，这可以写成 $\\tilde{\\mathbf{x}}(t) = \\frac{\\mathbf{x}(t) \\circ \\mathbf{W}(e_t)}{\\mathbf{x}(t) \\cdot \\mathbf{W}(e_t)}$，其中 $\\circ$ 表示逐元素（哈达玛）积，$\\mathbf{W}(e_t)$ 是环境 $e_t$ 的适应度值向量。\n\n其次，突变步骤修改这些选择后的频率。我们定义一个 $4 \\times 4$ 的突变矩阵 $\\mathbf{M}$，其中条目 $M_{ij}$ 是来自基因型为 $i$ 的亲本的后代突变为基因型 $j$ 的概率。下一代的频率 $x_j(t+1)$ 通过对所有可能的亲本来源求和得到：\n$$\nx_j(t+1) = \\sum_{i=0}^{3} \\tilde{x}_i(t) M_{ij}\n$$\n以向量形式，这是一个矩阵乘法：$\\mathbf{x}(t+1) = \\tilde{\\mathbf{x}}(t) \\mathbf{M}$。\n\n现在我们必须根据问题陈述构建该模型的具体组件。\n\n状态空间由四种基因型组成，我们将其索引为 $0$ 到 $3$：\n- $0$: $g_0 = \\mathrm{AK}$（营养缺陷型完好，自毁开关完好）\n- $1$: $g_1 = \\mathrm{AM}$（营养缺陷型完好，自毁开关突变）\n- $2$: $g_2 = \\mathrm{CK}$（营养缺陷型补偿，自毁开关完好）\n- $3$: $g_3 = \\mathrm{CM}$（营养缺陷型补偿，自毁开关突变）\n\n有两种环境，宽松（$\\mathrm{P}$）和限制性（$\\mathrm{R}$），分别对应适应度向量 $\\mathbf{W}_{\\mathrm{P}}$ 和 $\\mathbf{W}_{\\mathrm{R}}$。\n在宽松环境 $\\mathrm{P}$ 中，适应度由代谢成本决定：\n- $w_0(\\mathrm{P}) = 1 - c_A - c_K$\n- $w_1(\\mathrm{P}) = 1 - c_A$\n- $w_2(\\mathrm{P}) = 1 - b_C - c_K$\n- $w_3(\\mathrm{P}) = 1 - b_C$\n所以，$\\mathbf{W}_{\\mathrm{P}} = [1 - c_A - c_K, 1 - c_A, 1 - b_C - c_K, 1 - b_C]$。\n\n在限制性环境 $\\mathrm{R}$ 中，适应度由生存惩罚决定：\n- $w_0(\\mathrm{R}) = s_A s_K$\n- $w_1(\\mathrm{R}) = s_A$\n- $w_2(\\mathrm{R}) = s_K$\n- $w_3(\\mathrm{R}) = 1$\n所以，$\\mathbf{W}_{\\mathrm{R}} = [s_A s_K, s_A, s_K, 1]$。\n\n突变矩阵 $\\mathbf{M}$ 是根据突变概率 $u_A$ (A→C) 和 $u_K$ (K→M) 构建的，忽略了回复突变。该矩阵为：\n$$\n\\mathbf{M} = \\begin{pmatrix}\nM_{00}  & M_{01}  & M_{02}  & M_{03} \\\\\nM_{10}  & M_{11}  & M_{12}  & M_{13} \\\\\nM_{20}  & M_{21}  & M_{22}  & M_{23} \\\\\nM_{30}  & M_{31}  & M_{32}  & M_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(1-u_A)(1-u_K)  & (1-u_A)u_K  & u_A(1-u_K)  & u_A u_K \\\\\n0  & 1-u_A  & 0  & u_A \\\\\n0  & 0  & 1-u_K  & u_K \\\\\n0  & 0  & 0  & 1\n\\end{pmatrix}\n$$\n这是一个上三角矩阵，反映了该模型中逃逸突变的单向性。\n\n环境安排是周期性的，周期长度为 $L$。在每个周期中，前 $n_R = \\mathrm{round}(f_R L)$ 代是限制性的（$\\mathrm{R}$），随后的 $L - n_R$ 代是宽松的（$\\mathrm{P}$）。因此，第 $t$ 代的环境是 $\\mathrm{R}$ 如果 $(t \\pmod L) < n_R$，否则是 $\\mathrm{P}$。\n\n仿真算法如下：\n1. 对于每个测试用例，提取参数：$T, L, f_R, s_A, s_K, c_A, c_K, b_C, u_A, u_K, \\tau$。\n2. 构建适应度向量 $\\mathbf{W}_{\\mathrm{P}}$ 和 $\\mathbf{W}_{\\mathrm{R}}$ 以及突变矩阵 $\\mathbf{M}$。\n3. 计算每个周期内的限制性代数，$n_R = \\mathrm{round}(f_R L)$。\n4. 初始化基因型频率向量 $\\mathbf{x} = [1.0, 0.0, 0.0, 0.0]$。\n5. 从 $t = 0$ 迭代到 $T-1$：\n    a. 根据 $t \\pmod L$ 和 $n_R$ 确定当前环境。选择相应的适应度向量 $\\mathbf{W}_{env}$。\n    b. 应用选择：计算 $\\bar{w} = \\mathbf{x} \\cdot \\mathbf{W}_{env}$。然后计算中间频率 $\\tilde{\\mathbf{x}} = (\\mathbf{x} \\circ \\mathbf{W}_{env}) / \\bar{w}$。\n    c. 应用突变：更新下一代的频率向量：$\\mathbf{x} \\leftarrow \\tilde{\\mathbf{x}} \\mathbf{M}$。\n6. 经过 $T$ 代后，获取双重逃逸突变体的最终频率 $x_3 = \\mathbf{x}[3]$。\n7. 如果 $x_3 \\ge \\tau$，则结果为 `True`，否则为 `False`。\n\n此过程将针对每个测试用例实施，以产生最终的布尔结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a deterministic replicator–mutator model for the joint evolution\n    of auxotrophy and kill-switch components in a microbial population.\n    \"\"\"\n    \n    # Test cases as tuples: (T, L, f_R, s_A, s_K, c_A, c_K, b_C, u_A, u_K, tau)\n    test_cases = [\n        # Case 1 (balanced, strong restriction, moderate burdens)\n        (20000, 20, 0.5, 0.01, 0.01, 0.01, 0.03, 0.02, 1e-4, 1e-4, 0.5),\n        # Case 2 (rare restriction, compensation costly)\n        (20000, 100, 0.01, 0.01, 0.01, 0.01, 0.03, 0.05, 1e-4, 1e-4, 0.5),\n        # Case 3 (always restrictive)\n        (10000, 10, 1.0, 0.01, 0.01, 0.01, 0.03, 0.02, 1e-4, 1e-4, 0.5),\n        # Case 4 (leaky barriers and high burdens)\n        (20000, 20, 0.5, 0.2, 0.2, 0.01, 0.10, 0.10, 1e-4, 1e-4, 0.5),\n    ]\n\n    results = []\n    \n    # Genotype indices: 0:AK, 1:AM, 2:CK, 3:CM\n    for case in test_cases:\n        T, L, f_R, s_A, s_K, c_A, c_K, b_C, u_A, u_K, tau = case\n\n        # 1. Construct model components\n        \n        # Fitness vectors W_P (permissive) and W_R (restrictive)\n        W_P = np.array([\n            1 - c_A - c_K,  # AK fitness in P\n            1 - c_A,          # AM fitness in P\n            1 - b_C - c_K,  # CK fitness in P\n            1 - b_C           # CM fitness in P\n        ])\n\n        W_R = np.array([\n            s_A * s_K,      # AK fitness in R\n            s_A,            # AM fitness in R\n            s_K,            # CK fitness in R\n            1.0             # CM fitness in R\n        ])\n        \n        # Mutation matrix M\n        M = np.array([\n            # AK(0) -> AK(0), AM(1), CK(2), CM(3)\n            [(1-u_A)*(1-u_K), (1-u_A)*u_K, u_A*(1-u_K), u_A*u_K],\n            # AM(1) -> AM(1), CM(3)\n            [0, 1-u_A, 0, u_A],\n            # CK(2) -> CK(2), CM(3)\n            [0, 0, 1-u_K, u_K],\n            # CM(3) -> CM(3)\n            [0, 0, 0, 1]\n        ])\n\n        # 2. Set up simulation\n        \n        # Initial population: monomorphic for AK (genotype 0)\n        x = np.array([1.0, 0.0, 0.0, 0.0])\n        \n        # Environmental schedule\n        n_R = round(f_R * L)\n\n        # 3. Run simulation\n        for t in range(T):\n            # Determine environment for generation t\n            if (t % L)  n_R:\n                W_env = W_R\n            else:\n                W_env = W_P\n\n            # Selection step\n            mean_fitness = np.dot(x, W_env)\n            if mean_fitness = 0: # Population extinction, no escape\n                x[3] = 0.0\n                break\n            \n            x_tilde = (x * W_env) / mean_fitness\n            \n            # Mutation step\n            x = x_tilde @ M\n\n        # 4. Final decision\n        # Check if the double-escape genotype frequency exceeds the threshold\n        undermined = (x[3] >= tau)\n        results.append(undermined)\n\n    # Final print statement in the exact required format.\n    # The default str() for a boolean is 'True' or 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2716804"}]}