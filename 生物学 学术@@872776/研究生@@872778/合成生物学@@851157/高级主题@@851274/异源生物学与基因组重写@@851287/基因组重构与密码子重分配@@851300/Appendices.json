{"hands_on_practices": [{"introduction": "基因重构的一个核心目标是优化蛋白质表达。通过将稀有密码子替换为高效的同义密码子，可以显著提高翻译延伸的速度。该练习 [@problem_id:2742019] 提供了一个基于米氏动力学模型的实践框架，让您亲手计算这种密码子替换对总翻译时长的具体影响。这有助于建立对“密码子优化”背后动力学原理的定量直觉。", "problem": "一个重构项目将单个信使RNA (mRNA) 编码序列中的一个稀有同义密码子替换为一个更常见的同义密码子。假设单个核糖体在密码子 $i$ 处的翻译延伸可以被建模为一个酶催化步骤，其中核糖体接受一个同源氨酰-转运核糖核酸 (tRNA) 三元复合物，其有效可用性与 $t_i$ 成正比，产生一个延伸速度 $v_i$，该速度遵循 Michaelis–Menten 形式，并带有一个依赖于密码子的配对效率因子 $\\eta_i$。具体来说，对于密码子 $i$，\n$$\nv_i \\;=\\; \\frac{k_{\\mathrm{cat}}\\, \\eta_i\\, t_i}{K_M + \\eta_i\\, t_i},\n$$\n且每个密码子的平均停留时间为 $\\tau_i = 1/v_i$。假设核糖体交通效应可以忽略不计，且各密码子的停留时间线性相加，那么对于一个密码子计数为 $u_i$ 的编码序列，其总延伸时间为 $T = \\sum_i u_i \\tau_i$。\n\n给你一个密码子使用向量 $\\mathbf{u}$（基因中每个密码子的计数）和一个 tRNA 可用性向量 $\\mathbf{t}$（每个密码子的相对可用性单位）。在重构前后的序列之间，只有两个同义密码子不同：\n- 稀有密码子 $c_r$ 在重构前的计数为 $u_r = 60$，在重构后被完全移除（其所有实例均被替换）。\n- 常见密码子 $c_f$ 在重构前的计数为 $u_f = 120$，重构后增加到 $u_f' = u_f + u_r$。\n- 所有其他密码子的计数和参数在重构前后保持不变且相同。\n\n动力学参数和密码子特异性量如下：\n- $k_{\\mathrm{cat}} = 20\\,\\mathrm{s}^{-1}$，\n- $K_M = 4$（与 $t_i$ 的相对可用性单位相同），\n- 对于 $c_f$：$t_f = 10$，$\\eta_f = 1.0$，\n- 对于 $c_r$：$t_r = 2$，$\\eta_r = 0.8$。\n\n仅使用上述假设和标准酶动力学，计算仅因将所有 $u_r$ 个 $c_r$ 实例替换为 $c_f$ 所导致的总翻译延伸时间的预测变化，定义为 $\\Delta T = T_{\\mathrm{after}} - T_{\\mathrm{before}}$，单位为秒。你的最终答案以秒为单位，并四舍五入到四位有效数字。", "solution": "所述问题具有科学依据，提法明确，且内容完整。它提出了一个应用于合成生物学中现实问题的标准动力学模型。所有必需的参数都已提供。我们可以开始求解。\n\n目标是计算由密码子重构导致的总翻译延伸时间的变化 $\\Delta T$。这个变化定义为重构后的总时间 $T_{\\mathrm{after}}$ 减去重构前的总时间 $T_{\\mathrm{before}}$：\n$$\n\\Delta T = T_{\\mathrm{after}} - T_{\\mathrm{before}}\n$$\n总延伸时间 $T$ 由每个密码子的停留时间，按其在编码序列中的计数加权后的线性总和给出：\n$$\nT = \\sum_i u_i \\tau_i\n$$\n其中 $u_i$ 是密码子 $i$ 的计数，$\\tau_i$ 是其平均停留时间。\n\n重构前，总时间是所有密码子类型的总和，我们可以将其分解为来自稀有密码子 $c_r$、常见密码子 $c_f$ 以及所有其他密码子的贡献：\n$$\nT_{\\mathrm{before}} = u_r \\tau_r + u_f \\tau_f + \\sum_{k \\neq r, f} u_k \\tau_k\n$$\n重构后，所有 $u_r = 60$ 个稀有密码子 $c_r$ 的实例都被常见密码子 $c_f$ 替换。新的密码子计数变为 $u_r' = 0$ 和 $u_f' = u_f + u_r$。对于 $k \\neq r, f$，所有其他密码子的计数 $u_k$ 保持不变。因此，重构后的总时间为：\n$$\nT_{\\mathrm{after}} = (0) \\tau_r + (u_f + u_r) \\tau_f + \\sum_{k \\neq r, f} u_k \\tau_k = (u_f + u_r) \\tau_f + \\sum_{k \\neq r, f} u_k \\tau_k\n$$\n总延伸时间的变化 $\\Delta T$ 是 $T_{\\mathrm{after}}$ 和 $T_{\\mathrm{before}}$ 之间的差值：\n$$\n\\Delta T = \\left( (u_f + u_r) \\tau_f + \\sum_{k \\neq r, f} u_k \\tau_k \\right) - \\left( u_r \\tau_r + u_f \\tau_f + \\sum_{k \\neq r, f} u_k \\tau_k \\right)\n$$\n代表所有未改变密码子贡献的求和项被消去，剩下：\n$$\n\\Delta T = (u_f + u_r) \\tau_f - u_r \\tau_r - u_f \\tau_f = u_f \\tau_f + u_r \\tau_f - u_r \\tau_r - u_f \\tau_f\n$$\n这个表达式简化为一个紧凑且直观的形式：\n$$\n\\Delta T = u_r (\\tau_f - \\tau_r)\n$$\n这个方程表示，总时间变化是被修改的密码子数量 $u_r$ 乘以每次修改的停留时间变化量 $\\tau_f - \\tau_r$。\n\n接下来，我们必须计算停留时间 $\\tau_r$ 和 $\\tau_f$。平均停留时间 $\\tau_i$ 是延伸速度 $v_i$ 的倒数。从给定的 Michaelis–Menten 模型，我们有：\n$$\n\\tau_i = \\frac{1}{v_i} = \\frac{K_M + \\eta_i t_i}{k_{\\mathrm{cat}} \\eta_i t_i}\n$$\n给定的参数是 $k_{\\mathrm{cat}} = 20\\,\\mathrm{s}^{-1}$ 和 $K_M = 4$。\n\n对于稀有密码子 $c_r$，其特异性量为 $t_r = 2$ 和 $\\eta_r = 0.8$。其停留时间 $\\tau_r$ 为：\n$$\n\\tau_r = \\frac{K_M + \\eta_r t_r}{k_{\\mathrm{cat}} \\eta_r t_r} = \\frac{4 + (0.8)(2)}{20 \\times (0.8)(2)} = \\frac{4 + 1.6}{20 \\times 1.6} = \\frac{5.6}{32} = 0.175\\,\\mathrm{s}\n$$\n对于常见密码子 $c_f$，其量为 $t_f = 10$ 和 $\\eta_f = 1.0$。其停留时间 $\\tau_f$ 为：\n$$\n\\tau_f = \\frac{K_M + \\eta_f t_f}{k_{\\mathrm{cat}} \\eta_f t_f} = \\frac{4 + (1.0)(10)}{20 \\times (1.0)(10)} = \\frac{4 + 10}{200} = \\frac{14}{200} = 0.07\\,\\mathrm{s}\n$$\n最后，我们将计算出的停留时间和稀有密码子的初始计数 $u_r = 60$ 代入 $\\Delta T$ 的表达式中：\n$$\n\\Delta T = 60 \\times (0.07\\,\\mathrm{s} - 0.175\\,\\mathrm{s}) = 60 \\times (-0.105\\,\\mathrm{s})\n$$\n$$\n\\Delta T = -6.3\\,\\mathrm{s}\n$$\n问题要求答案以秒为单位，并四舍五入到四位有效数字。\n$$\n\\Delta T = -6.300\\,\\mathrm{s}\n$$\n负号表示总延伸时间的减少，这是将一个动力学上较慢的密码子替换为一个较快的密码子的预期结果。", "answer": "$$\\boxed{-6.300}$$", "id": "2742019"}, {"introduction": "在成功重构基因组以赋予密码子新功能后，确保翻译过程的精确性是下一个关键挑战。当我们为一个密码子（例如UAG）指定一个新的氨基酸时，必须最大限度地减少内源tRNA对其的错误识别。此练习 [@problem_id:2742133] 深入探讨了核糖体A位点的动力学竞争过程，指导您推导并计算错配事件的稳态概率。通过这个计算，您将更深刻地理解在扩展遗传密码时维持翻译保真度的核心挑战。", "problem": "您正在重构大肠杆菌 (E. coli) 的基因组，以移除所有天然的UAG终止密码子，并通过一个正交转移核糖核酸(tRNA)-氨酰基系统将UAG重编码为一种非天然氨基酸。在一个报告基因的目标UAG密码子处，各种氨酰tRNA竞争核糖体的氨酰基位点（A位点）。在一个简化的、科学上真实的A位点解码模型中，每种tRNA（$i$）（一个经过改造的认知tRNA和两个内源性的近认知tRNA）通过三个基本步骤与核糖体结合：以二级速率常数 $k_{\\text{on},i}^{0}$ 与空的A位点进行双分子结合；以一级速率常数 $k_{\\text{off},i}$ 进行单分子解离；以及以一级速率常数 $k_{\\text{cat},i}$ 进行肽酰基转移（催化）。假设：\n- A位点要么是空的，要么被单个tRNA占据。\n- 当一个tRNA结合后，接下来会发生两个互斥事件中的一个：解离或催化，其速率分别为 $k_{\\text{off},i}$ 和 $k_{\\text{cat},i}$。\n- 在任何解离事件后，A位点返回空状态，竞争重新开始。\n- 所有过程都是无记忆性的（等待时间呈指数分布）。\n- 只有三种tRNA以可观的水平存在：用于UAG的工程改造的认知tRNA（下标 $c$）和两种可以低概率错读UAG的近认知tRNA（下标 $n_{1}$ 和 $n_{2}$）。\n\n在操作的胞内浓度下，tRNA的结合步骤可被视为准一级反应，其有效速率为 $k_{\\text{on},i} \\equiv k_{\\text{on},i}^{0}[{\\rm tRNA}_{i}]$。在 $37\\,^{\\circ}\\mathrm{C}$ 下测得以下参数：\n- 认知tRNA：$k_{\\text{on},c}^{0} = 6.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$， $[{\\rm tRNA}_{c}] = 3.0\\,\\mu\\mathrm{M}$，$k_{\\text{off},c} = 3.0\\ \\mathrm{s}^{-1}$，$k_{\\text{cat},c} = 30.0\\ \\mathrm{s}^{-1}$。\n- 近认知tRNA $n_{1}$：$k_{\\text{on},n_{1}}^{0} = 5.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$， $[{\\rm tRNA}_{n_{1}}] = 0.50\\,\\mu\\mathrm{M}$，$k_{\\text{off},n_{1}} = 120.0\\ \\mathrm{s}^{-1}$，$k_{\\text{cat},n_{1}} = 2.00\\ \\mathrm{s}^{-1}$。\n- 近认知tRNA $n_{2}$：$k_{\\text{on},n_{2}}^{0} = 4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}$， $[{\\rm tRNA}_{n_{2}}] = 0.20\\,\\mu\\mathrm{M}$，$k_{\\text{off},n_{2}} = 150.0\\ \\mathrm{s}^{-1}$，$k_{\\text{cat},n_{2}} = 1.00\\ \\mathrm{s}^{-1}$。\n\n仅从质量作用动力学和上述核糖体上的无记忆性两步竞争出发，推导該UAG密码子处稳态错掺概率 $P_{\\text{mis}}$ 的解析表达式（即在该密码子上完成的肽酰基转移事件是由近认知tRNA $n_{1}$ 或 $n_{2}$ 而不是由认知tRNA $c$ 导致的概率）。然后使用给定参数计算其数值。将您的最终结果四舍五入到四位有效数字，并以纯数（无量纲）形式表示。", "solution": "该问题要求计算在重编码的UAG密码子处的错掺概率 $P_{\\text{mis}}$。该问题陈述清晰，并以应用于核糖体翻译的化学动力学原理为科学基础。我们将通过从给定的反应方案中推导 $P_{\\text{mis}}$ 的解析表达式，然后计算其数值。\n\n问题的核心是三种转移核糖核酸(tRNA)——一种认知tRNA ($c$)和两种近认知tRNA ($n_1$, $n_2$)——对核糖体上空的氨酰基位点（A位点）的动力学竞争。令 $A$ 表示空的A位点。每种tRNA（其中 $i \\in \\{c, n_1, n_2\\}$）与A位点的相互作用由一个三步机制描述：准一级结合、解离和催化（肽酰基转移）。动力学方案如下：\n\n$1$. tRNA$_i$与空A位点 $A$ 的结合：\n$$ A \\xrightarrow{k_{\\text{on},i}} A:tRNA_i $$\n其中 $k_{\\text{on},i}$ 是准一级速率常数，定义为 $k_{\\text{on},i} = k_{\\text{on},i}^{0} [{\\rm tRNA}_{i}]$。\n\n$2$. 一旦复合物 $A:tRNA_i$ 形成，存在两种互斥的不可逆途径：\n($2a$) tRNA$_i$解离，使A位点返回空状态：\n$$ A:tRNA_i \\xrightarrow{k_{\\text{off},i}} A $$\n($2b$) 催化，tRNA$_i$携带的氨基酸被整合到增长的多肽链中。这是在该密码子处竞争的终止步骤：\n$$ A:tRNA_i \\xrightarrow{k_{\\text{cat},i}} \\text{掺入}_i $$\n\n我们关心的是在稳态下，一个掺入事件是由近认知tRNA引起的概率。该概率是总错掺速率与所有掺入事件总速率的比值。令 $V_i$ 为物种 $i$ 的稳态掺入速率。根据定义：\n$$ P_{\\text{mis}} = \\frac{V_{n_1} + V_{n_2}}{V_c + V_{n_1} + V_{n_2}} $$\n\n为求得速率 $V_i$，我们对中间复合物 $A:tRNA_i$ 应用稳态近似。令 $[A]$ 和 $[A:tRNA_i]$ 分别表示空A位点和与tRNA$_i$结合的A位点的稳态浓度（或概率）。对于每种物种 $i$，复合物的生成速率必须等于其消耗速率：\n$$ \\frac{d[A:tRNA_i]}{dt} = k_{\\text{on},i} [A] - (k_{\\text{off},i} + k_{\\text{cat},i}) [A:tRNA_i] = 0 $$\n求解复合物 $[A:tRNA_i]$ 的稳态浓度可得：\n$$ [A:tRNA_i] = \\frac{k_{\\text{on},i}}{k_{\\text{off},i} + k_{\\text{cat},i}} [A] $$\n物种 $i$ 的掺入速率 $V_i$ 是催化步骤的速率：\n$$ V_i = k_{\\text{cat},i} [A:tRNA_i] $$\n代入 $[A:tRNA_i]$ 的表达式：\n$$ V_i = k_{\\text{cat},i} \\left( \\frac{k_{\\text{on},i}}{k_{\\text{off},i} + k_{\\text{cat},i}} \\right) [A] $$\n项 $[A]$ 是所有物种的公因子，在计算比值求 $P_{\\text{mis}}$ 时将被消去。错掺概率的表达式为：\n$$ P_{\\text{mis}} = \\frac{k_{\\text{cat},n_1} \\left( \\frac{k_{\\text{on},n_1}}{k_{\\text{off},n_1} + k_{\\text{cat},n_1}} \\right) [A] + k_{\\text{cat},n_2} \\left( \\frac{k_{\\text{on},n_2}}{k_{\\text{off},n_2} + k_{\\text{cat},n_2}} \\right) [A]}{k_{\\text{cat},c} \\left( \\frac{k_{\\text{on},c}}{k_{\\text{off},c} + k_{\\text{cat},c}} \\right) [A] + k_{\\text{cat},n_1} \\left( \\frac{k_{\\text{on},n_1}}{k_{\\text{off},n_1} + k_{\\text{cat},n_1}} \\right) [A] + k_{\\text{cat},n_2} \\left( \\frac{k_{\\text{on},n_2}}{k_{\\text{off},n_2} + k_{\\text{cat},n_2}} \\right) [A]} $$\n消去 $[A]$ 得到 $P_{\\text{mis}}$ 的最终解析表达式：\n$$ P_{\\text{mis}} = \\frac{ \\sum_{j \\in \\{n_1, n_2\\}} k_{\\text{on},j} \\frac{k_{\\text{cat},j}}{k_{\\text{off},j} + k_{\\text{cat},j}} }{ \\sum_{i \\in \\{c, n_1, n_2\\}} k_{\\text{on},i} \\frac{k_{\\text{cat},i}}{k_{\\text{off},i} + k_{\\text{cat},i}} } $$\n该表达式表示有效催化通量的比值。项 $\\frac{k_{\\text{cat},i}}{k_{\\text{off},i} + k_{\\text{cat},i}}$ 是分配因子，表示tRNA结合后发生催化与解离的概率。\n\n现在，我们使用提供的参数计算数值。\n首先，我们计算准一级速率常数 $k_{\\text{on},i} = k_{\\text{on},i}^{0} [{\\rm tRNA}_{i}]$：\n对于认知物种 $c$：\n$k_{\\text{on},c} = (6.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (3.0 \\times 10^{-6}\\ \\mathrm{M}) = 18.0\\ \\mathrm{s}^{-1}$\n对于近认知物种 $n_1$：\n$k_{\\text{on},n_1} = (5.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (0.50 \\times 10^{-6}\\ \\mathrm{M}) = 2.5\\ \\mathrm{s}^{-1}$\n对于近认知物种 $n_2$：\n$k_{\\text{on},n_2} = (4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (0.20 \\times 10^{-6}\\ \\mathrm{M}) = 0.80\\ \\mathrm{s}^{-1}$\n\n接下来，我们计算每种物种的有效通量项 $S_i = k_{\\text{on},i} \\frac{k_{\\text{cat},i}}{k_{\\text{off},i} + k_{\\text{cat},i}}$。\n$S_c = 18.0 \\times \\frac{30.0}{3.0 + 30.0} = 18.0 \\times \\frac{30.0}{33.0} = \\frac{180}{11}\\ \\mathrm{s}^{-1}$\n$S_{n_1} = 2.5 \\times \\frac{2.00}{120.0 + 2.00} = 2.5 \\times \\frac{2.00}{122.0} = \\frac{5}{122}\\ \\mathrm{s}^{-1}$\n$S_{n_2} = 0.80 \\times \\frac{1.00}{150.0 + 1.00} = 0.80 \\times \\frac{1.00}{151.0} = \\frac{0.8}{151} = \\frac{4}{755}\\ \\mathrm{s}^{-1}$\n\n错掺概率为 $P_{\\text{mis}} = \\frac{S_{n_1} + S_{n_2}}{S_c + S_{n_1} + S_{n_2}}$。\n分子（总错掺通量）为：\n$S_{\\text{mis}} = S_{n_1} + S_{n_2} = \\frac{5}{122} + \\frac{4}{755} = \\frac{5 \\times 755 + 4 \\times 122}{122 \\times 755} = \\frac{3775 + 488}{92110} = \\frac{4263}{92110}\\ \\mathrm{s}^{-1}$\n分母（总掺入通量）为：\n$S_{\\text{total}} = S_c + S_{\\text{mis}} = \\frac{180}{11} + \\frac{4263}{92110}\\ \\mathrm{s}^{-1}$\n\n现在我们计算该比值：\n$P_{\\text{mis}} = \\frac{\\frac{4263}{92110}}{\\frac{180}{11} + \\frac{4263}{92110}} = \\frac{4263}{180 \\times \\frac{92110}{11} + 4263} = \\frac{4263}{180 \\times 8373.\\overline{63} + 4263}$\n为避免舍入误差，我们以高精度进行数值计算：\n$S_c = \\frac{180}{11} \\approx 16.363636...$\n$S_{n_1} = \\frac{5}{122} \\approx 0.0409836...$\n$S_{n_2} = \\frac{4}{755} \\approx 0.0052980...$\n$S_{\\text{mis}} = S_{n_1} + S_{n_2} \\approx 0.0462816...$\n$S_{\\text{total}} = S_c + S_{n_1} + S_{n_2} \\approx 16.363636... + 0.0462816... \\approx 16.409918...$\n$P_{\\text{mis}} = \\frac{S_{\\text{mis}}}{S_{\\text{total}}} \\approx \\frac{0.0462816}{16.409918} \\approx 0.002820349...$\n\n将结果四舍五入到四位有效数字，得到 $0.002820$。", "answer": "$$ \\boxed{0.002820} $$", "id": "2742133"}, {"introduction": "翻译效率不仅取决于单个密码子的使用频率，还受到其上下文，特别是相邻密码子对的影响。本练习 [@problem_id:2742052] 将视角从单个密码子的动力学扩展到序列水平的统计分析，引入了密码子对评分（Codon Pair Score, CPS）这一重要概念。您将通过编写程序来评估密码子重分配策略如何改变一个基因的CPS谱，从而将动力学理论与重构序列的生物信息学分析实践联系起来。", "problem": "给定一个在密码子使用模型下对密码子对偏好的形式化描述，您需要计算编码区在经过一次人工重分配前后，其密码子对得分 (CPS) 谱。此次重分配通过禁止指定的密码子并用指定的同义密码子替换它们，从而改变了密码子的可用性。目标是评估重分配后 CPS 分布的变化情况。\n\n背景与定义：\n- 根据分子生物学中心法则，脱氧核糖核酸 (DNA) 经过转录和翻译，通过密码子生成蛋白质。密码子是来自字母表 $\\{A,C,G,T\\}$ 的三联体。我们将一个编码区视为一个长度为 $N$ 的密码子列表，其中 $N \\ge 2$ 且不存在终止密码子。\n- 令 $\\mathcal{C}$ 表示某一情景下使用的密码子字母表。参考密码子使用分布是一个在 $c \\in \\mathcal{C}$ 上的概率质量函数 $p(c)$，满足 $\\sum_{c \\in \\mathcal{C}} p(c)=1$，并且对于该情景下编码区中可能出现的密码子，有 $p(c)0$。\n- 对于一个密码子列表为 $(c_1,c_2,\\dots,c_N)$ 的编码区，定义相邻有序密码子对 $(c_i,c_{i+1})$，其中 $i=1,\\dots,N-1$。令 $n_{\\text{pairs}}=N-1$。令 $n(a,b)$ 为该区域中密码子对 $(a,b)$ 的观测计数。我们采用独立性模型来计算预期的配对频率，即预期的配对概率为\n$$\nP_{\\text{exp}}(a,b) = p(a)\\,p(b).\n$$\n- 为避免除以零并稳定来自有限样本的估计，我们对观测计数使用参数为 $\\lambda0$ 的拉普拉斯（加性）平滑。令 $M=|\\mathcal{C}|^2$ 为该情景的密码子字母表下可能的有序对的数量。定义平滑后的观测配对概率为\n$$\nP_{\\text{obs}}(a,b) = \\frac{n(a,b)+\\lambda}{n_{\\text{pairs}}+\\lambda\\,M}.\n$$\n- 密码子对 $(a,b)$ 的密码子对得分 (CPS) 定义为观测值与预期值之比的以 2 为底的对数，\n$$\n\\mathrm{CPS}(a,b) = \\log_{2}\\!\\left(\\frac{P_{\\text{obs}}(a,b)}{P_{\\text{exp}}(a,b)}\\right).\n$$\n- 一个编码区的 CPS 谱是一个列表 $\\left[\\mathrm{CPS}(c_i,c_{i+1})\\right]_{i=1}^{N-1}$，通过将每个相邻密码子对赋予在同一情景下根据全局 $P_{\\text{obs}}$ 和 $P_{\\text{exp}}$ 计算出的其 CPS 值而获得。\n- 一次重分配由一个被禁止的密码子集合 $\\mathcal{B}$ 和一个替换映射 $R:\\mathcal{B}\\to \\mathcal{C}$ 指定，该映射以一一对应的方式将每个被禁止的密码子替换为指定的允许的同义密码子。将此重分配应用于一个编码区，意味着将密码子列表中每次出现的 $c\\in\\mathcal{B}$ 替换为 $R(c)$，从而产生一个长度同样为 $N$ 的重编码区域。\n- 重分配后，经过可用性调整的密码子使用分布由下式给出：\n$$\np'(c)=\n\\begin{cases}\n0,  c\\in \\mathcal{B},\\\\\n\\displaystyle \\frac{p(c)}{\\sum_{x \\notin \\mathcal{B}} p(x)},  c\\notin \\mathcal{B},\n\\end{cases}\n$$\n且重分配后的密码子字母表为 $\\mathcal{C}'=\\{c:\\,p'(c)0\\}$。\n\n每个测试案例的任务：\n1) 基线情景：\n- 令 $\\mathcal{C}$ 为给定基线 $p(c)$ 的支撑集。\n- 使用给定的编码区和 $\\lambda$ 计算 $P_{\\text{obs}}$，其中 $M=|\\mathcal{C}|^2$。\n- 计算 $P_{\\text{exp}}(a,b)=p(a)p(b)$。\n- 计算 CPS 表，然后计算 CPS 谱 $\\left[\\mathrm{CPS}(c_i,c_{i+1})\\right]_{i=1}^{N-1}$。\n- 计算 CPS 谱的均值，\n$$\n\\mu_{\\text{before}}=\\frac{1}{N-1}\\sum_{i=1}^{N-1}\\mathrm{CPS}(c_i,c_{i+1}).\n$$\n2) 重分配后情景：\n- 应用重分配以获得重编码后的密码子列表 $(c'_1,\\dots,c'_N)$。\n- 如上构建 $p'$ 和 $\\mathcal{C}'$，并设 $M'=|\\mathcal{C}'|^2$。\n- 根据重编码区域计算 $P_{\\text{obs}}'$ 和 $P_{\\text{exp}}'(a,b)=p'(a)p'(b)$。\n- 计算 CPS 谱 $\\left[\\mathrm{CPS}'(c'_i,c'_{i+1})\\right]_{i=1}^{N-1}$ 及其均值\n$$\n\\mu_{\\text{after}}=\\frac{1}{N-1}\\sum_{i=1}^{N-1}\\mathrm{CPS}'(c'_i,c'_{i+1}).\n$$\n3) 分布变化：\n- 设两个 CPS 谱为 $\\{x_i\\}_{i=1}^{n}$ 和 $\\{y_i\\}_{i=1}^{n}$，其中 $n=N-1$。因为重分配是一一对应的密码子替换，保留了 $N$，所以两个谱的长度相同。定义均值差异为\n$$\n\\Delta\\mu = \\mu_{\\text{after}}-\\mu_{\\text{before}}.\n$$\n- 定义两个经验分布之间的 1-瓦瑟斯坦距离（样本量相等，权重相等）为\n$$\nW_1 = \\frac{1}{n}\\sum_{i=1}^{n}\\left|x_{(i)}-y_{(i)}\\right|,\n$$\n其中 $x_{(1)}\\le \\dots \\le x_{(n)}$ 和 $y_{(1)}\\le \\dots \\le y_{(n)}$ 是排序后的谱。\n\n所有案例均使用以下固定参数：拉普拉斯平滑参数 $\\lambda=0.5$ 和以 2 为底的对数。\n\n测试套件：\n为以下三个测试案例提供结果。在每个案例中，编码区以有序密码子列表形式给出，基线密码子使用 $p$ 以一个字典形式给出，该字典涵盖了区域中可能出现的密码子或其替换密码子，重分配则由禁止集 $\\mathcal{B}$ 和替换映射 $R$ 给出。\n\n- 案例 A (一般情况)：\n    - 编码区密码子列表：[\"AAA\",\"GAA\",\"GGA\",\"AAA\",\"GAG\",\"GGA\",\"AAG\",\"GAA\",\"GGG\",\"AAA\"]。\n    - 基线密码子使用 $p$：\n        - AAA: $0.18$, AAG: $0.12$, GAA: $0.17$, GAG: $0.13$, GGA: $0.20$, GGG: $0.20$。\n      这些概率的总和为 1。\n    - 重分配：$\\mathcal{B}=\\{\\text{\"AAA\"},\\text{\"GAA\"}\\}$，其中 $R(\\text{\"AAA\"})=\\text{\"AAG\"}$，$R(\\text{\"GAA\"})=\\text{\"GAG\"}$。\n\n- 案例 B (边界情况，仅有一对)：\n    - 编码区密码子列表：[\"GGA\",\"GGG\"]。\n    - 基线密码子使用 $p$：\n        - GGA: $0.6$, GGG: $0.4$。\n      这些概率的总和为 1。\n    - 重分配：$\\mathcal{B}=\\{\\text{\"AAA\"}\\}$，其中 $R(\\text{\"AAA\"})=\\text{\"AAG\"}$。请注意，被禁止的密码子并未出现；该区域未发生改变。\n\n- 案例 C (压力测试，有多个被禁止的密码子)：\n    - 编码区密码子列表：[\"AAA\",\"AAA\",\"AAA\",\"GAA\",\"GAA\",\"GGA\",\"GGA\",\"GAG\"]。\n    - 基线密码子使用 $p$：\n        - AAA: $0.4$, AAG: $0.1$, GAA: $0.3$, GAG: $0.1$, GGA: $0.05$, GGG: $0.05$。\n      这些概率的总和为 1。\n    - 重分配：$\\mathcal{B}=\\{\\text{\"AAA\"},\\text{\"GAA\"}\\}$，其中 $R(\\text{\"AAA\"})=\\text{\"AAG\"}$，$R(\\text{\"GAA\"})=\\text{\"GAG\"}$。\n\n程序所需行为：\n- 精确实现上述计算，使用 $\\lambda=0.5$ 和以 2 为底的对数。\n- 对每个案例，计算四个浮点数：$\\mu_{\\text{before}}$、$\\mu_{\\text{after}}$、$\\Delta\\mu$ 和 $W_1$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个案例的结果本身是一个包含四个浮点数的列表，顺序为 [$\\mu_{\\text{before}}$, $\\mu_{\\text{after}}$, $\\Delta\\mu$, $W_1$]。每个浮点数必须四舍五入到小数点后恰好六位。输出中任何地方都不能有空格。例如，一个包含两个案例的输出将类似于“[[0.123456,0.234567,0.111111,0.050000],[...]]”。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于合成生物学和分子遗传学的原理，在数学上是适定的，具有明确的定义和目标，并且没有会妨碍唯一、稳定解的矛盾或模糊之处。关于在一个测试案例中密码子字母表范围的轻微模糊性，通过严格解释优先的计算指令得以解决。我现在将着手构建解决方案。\n\n任务是计算和比较一个编码区在经过指定的密码子重分配前后的密码子对得分 (CPS) 谱。这需要对两种情景系统地应用所提供的统计形式化方法：基线情景和重分配后状态。下面详细说明单个测试案例的整个过程。\n\n首先，我们处理基线情景。一个给定的编码区表示为一个密码子列表 $(c_1, c_2, \\dots, c_N)$，其中 $N$ 是序列的长度，且 $N \\ge 2$。因此，相邻密码子对的数量为 $n_{\\text{pairs}} = N-1$。基线密码子字母表，表示为 $\\mathcal{C}$，定义为给定基线密码子使用概率质量函数 $p(c)$ 的支撑集。可能的密码子对空间的大小为 $M = |\\mathcal{C}|^2$。\n\n为了计算 CPS，对于每个密码子对 $(a,b)$（其中 $a,b \\in \\mathcal{C}$），我们需要两个量：观测概率 $P_{\\text{obs}}(a,b)$ 和预期概率 $P_{\\text{exp}}(a,b)$。预期概率源自一个独立性模型，假设密码子根据分布 $p(c)$ 独立出现：\n$$\nP_{\\text{exp}}(a,b) = p(a)p(b)\n$$\n观测概率是根据序列中每个密码子对的计数计算的。令 $n(a,b)$ 为序列 $(c_1, \\dots, c_N)$ 中密码子对 $(a,b)$ 的观测计数。为了防止未出现的密码子对导致除以零，并为了稳定有限序列的估计，我们使用拉普拉斯平滑，其参数 $\\lambda  0$（给定为 $\\lambda=0.5$）。平滑后的观测概率为：\n$$\nP_{\\text{obs}}(a,b) = \\frac{n(a,b)+\\lambda}{n_{\\text{pairs}}+\\lambda M}\n$$\n密码子对 $(a,b)$ 的密码子对得分是这些概率之比的以 2 为底的对数：\n$$\n\\mathrm{CPS}(a,b) = \\log_{2}\\!\\left(\\frac{P_{\\text{obs}}(a,b)}{P_{\\text{exp}}(a,b)}\\right)\n$$\n使用此公式，为所有可能的密码子对 $(a,b)$（其中 $a,b \\in \\mathcal{C}$）计算一个完整的 CPS 表。然后，通过将每个相邻对 $(c_i, c_{i+1})$ 映射到其预先计算的 CPS 值，来构建给定序列的 CPS 谱：$[\\mathrm{CPS}(c_1,c_2), \\mathrm{CPS}(c_2,c_3), \\dots, \\mathrm{CPS}(c_{N-1},c_N)]$。该谱的均值 $\\mu_{\\text{before}}$ 计算如下：\n$$\n\\mu_{\\text{before}}=\\frac{1}{N-1}\\sum_{i=1}^{N-1}\\mathrm{CPS}(c_i,c_{i+1})\n$$\n\n接下来，我们分析重分配后的情景。一次重分配由一个被禁止的密码子集合 $\\mathcal{B}$ 和一个替换映射 $R$ 定义，该映射将每个被禁止的密码子替换为一个允许的同义密码子。首先，我们将此映射应用于原始密码子列表，以生成一个重编码序列 $(c'_1, c'_2, \\dots, c'_N)$。长度 $N$ 保持不变。\n\n必须调整密码子使用概率以反映新的可用密码子集。新的概率分布 $p'(c)$ 对于任何被禁止的密码子 $c \\in \\mathcal{B}$ 均为零。对于任何允许的密码子 $c \\notin \\mathcal{B}$，其概率在所有允许密码子的概率总和上进行重新归一化：\n$$\np'(c) = \\frac{p(c)}{\\sum_{x \\notin \\mathcal{B}} p(x)}\n$$\n新的密码子字母表 $\\mathcal{C}'$ 是 $p'(c)$ 的支撑集，即 $\\mathcal{C}' = \\{c \\mid p'(c)0\\}$。新的密码子对空间的大小为 $M'=|\\mathcal{C}'|^2$。\n\n重分配后 CPS 谱的计算过程类似。我们使用重编码序列 $(c'_1, \\dots, c'_N)$ 来找到新的观测配对计数 $n'(a,b)$。对于 $a,b \\in \\mathcal{C}'$ 的密码子对 $(a,b)$，新的平滑后观测概率 $P'_{\\text{obs}}(a,b)$ 和预期概率 $P'_{\\text{exp}}(a,b)$ 分别为：\n$$\nP'_{\\text{obs}}(a,b) = \\frac{n'(a,b)+\\lambda}{n_{\\text{pairs}}+\\lambda M'}\n$$\n$$\nP'_{\\text{exp}}(a,b) = p'(a)p'(b)\n$$\n一个密码子对的新 CPS 值为 $\\mathrm{CPS}'(a,b) = \\log_{2}(P'_{\\text{obs}}(a,b) / P'_{\\text{exp}}(a,b))$。重分配后的 CPS 谱为 $[\\mathrm{CPS}'(c'_1,c'_2), \\dots, \\mathrm{CPS}'(c'_{N-1},c'_N)]$，其均值为 $\\mu_{\\text{after}}$。\n\n最后，我们量化两种情景之间的变化。均值的差异很简单：\n$$\n\\Delta\\mu = \\mu_{\\text{after}}-\\mu_{\\text{before}}\n$$\n为了比较 CPS 值的完整分布，我们计算由 CPS 谱表示的两个经验分布之间的 1-瓦瑟斯坦距离 $W_1$。设两个谱为 $\\{x_i\\}_{i=1}^{n}$ 和 $\\{y_i\\}_{i=1}^{n}$，其中 $n = N-1$。我们首先对两个谱进行排序，得到有序统计量 $x_{(1)} \\le \\dots \\le x_{(n)}$ 和 $y_{(1)} \\le \\dots \\le y_{(n)}$。然后，1-瓦瑟斯坦距离是对应排序值之间绝对差的均值：\n$$\nW_1 = \\frac{1}{n}\\sum_{i=1}^{n}\\left|x_{(i)}-y_{(i)}\\right|\n$$\n将此完整过程实现并应用于每个提供的测试案例，以得出所需的四个指标：$\\mu_{\\text{before}}$、$\\mu_{\\text{after}}$、$\\Delta\\mu$ 和 $W_1$。", "answer": "[[0.218556,0.370725,0.152169,0.380908],[0.312948,0.312948,0.000000,0.000000],[0.485121,0.597793,0.112672,0.210948]]", "id": "2742052"}]}