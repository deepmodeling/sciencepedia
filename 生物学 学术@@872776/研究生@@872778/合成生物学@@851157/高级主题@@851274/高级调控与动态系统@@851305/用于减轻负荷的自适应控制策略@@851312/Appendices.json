{"hands_on_practices": [{"introduction": "在设计任何控制策略之前，首要任务是量化理解问题的本质。这项练习将从细胞资源分配的第一性原理出发，构建一个基础模型，帮助你推导出合成蛋白表达与宿主生长速率之间的线性权衡关系([@problem_id:2712681])。这个关系是适应性控制旨在解决的核心挑战，也是理解细胞负荷影响的基石。", "problem": "在翻译受限状态下，使用一个粗粒化蛋白质组分配框架对一个细菌细胞进行建模。蛋白质组被划分为三个部分：质量分数为$\\phi_{R}$的核糖体蛋白，质量分数为$\\phi_{H}$的固定管家部分，以及质量分数为$\\phi_{p}$的合成蛋白部分。蛋白质组守恒施加了线性约束$\\phi_{R} + \\phi_{p} + \\phi_{H} = 1$。假设$\\phi_{H}$由营养条件设定，并且在所考虑的负荷范围内是恒定的，同时假设有恒定比例$\\phi_{0}$的核糖体是非活性的。\n\n以一个经过充分检验的、将细胞生长速率$\\lambda$与活性核糖体蛋白质组分数联系起来的翻译受限生长的经验生长定律为基本依据：\n$$ \\lambda = \\sigma ( \\phi_{R} - \\phi_{0} ), $$\n其中$\\sigma$是每单位核糖体蛋白质组的有效翻译能力。令$\\lambda_{0}$表示在相同环境（相同的$\\phi_{H}$、相同的$\\sigma$、相同的$\\phi_{0}$）中，合成负荷为零（$\\phi_{p} = 0$）时的基线生长速率。\n\n将无量纲蛋白质组成本系数$c$定义为零负荷时生长速率相对于合成蛋白质组分数的相对斜率：\n$$ c \\equiv \\lim_{\\phi_{p} \\to 0} \\frac{\\lambda_{0} - \\lambda(\\phi_{p})}{\\lambda_{0}\\phi_{p}}. $$\n\n仅从蛋白质组守恒约束、$\\phi_{H}$和$\\phi_{0}$的恒定性以及上述生长定律出发，推导出一个关于$\\lambda(\\phi_{p})$的闭合形式的显式表达式，该表达式完全用$\\lambda_{0}$、$c$和$\\phi_{p}$表示。你的最终答案必须是关于$\\lambda(\\phi_{p})$的一个单一的闭合形式解析表达式。不要在最终的方框答案中包含单位。", "solution": "我们的任务是推导细胞生长速率$\\lambda$作为合成蛋白质量分数$\\phi_{p}$的函数表达式，并用基线生长速率$\\lambda_{0}$和成本系数$c$来表示。推导将从给定的基本原理出发。\n\n该系统由两个基本方程描述：\n1. 蛋白质组守恒约束：\n$$ \\phi_{R} + \\phi_{p} + \\phi_{H} = 1 $$\n2. 翻译受限生长定律：\n$$ \\lambda = \\sigma (\\phi_{R} - \\phi_{0}) $$\n参数$\\phi_{H}$（管家蛋白质组分数）、$\\phi_{0}$（非活性核糖体蛋白质组分数）和$\\sigma$（有效翻译能力）在特定的生长环境下被视为常数。\n\n从蛋白质组守恒方程中，我们首先分离出核糖体蛋白分数$\\phi_{R}$，因为它是将蛋白质组组成与生长速率联系起来的变量：\n$$ \\phi_{R} = 1 - \\phi_{H} - \\phi_{p} $$\n将这个$\\phi_{R}$的表达式代入生长定律，得到生长速率$\\lambda$作为$\\phi_{p}$的显式函数：\n$$ \\lambda(\\phi_{p}) = \\sigma ( (1 - \\phi_{H} - \\phi_{p}) - \\phi_{0} ) $$\n通过重新排列括号内的项，我们得到$\\lambda$和$\\phi_{p}$之间的线性关系：\n$$ \\lambda(\\phi_{p}) = \\sigma (1 - \\phi_{H} - \\phi_{0}) - \\sigma \\phi_{p} $$\n\n目标是使用$\\lambda_{0}$和$c$来重新参数化这个表达式。\n首先，我们利用基线生长速率$\\lambda_{0}$的定义，它对应于合成负荷为零的情况，即$\\phi_{p} = 0$。在我们的$\\lambda(\\phi_{p})$表达式中令$\\phi_{p} = 0$，我们得到：\n$$ \\lambda_{0} = \\lambda(0) = \\sigma (1 - \\phi_{H} - \\phi_{0}) $$\n这一项正是我们关于$\\lambda(\\phi_{p})$的线性方程中的常数截距。因此，我们可以将$\\lambda(\\phi_{p})$的表达式简化为：\n$$ \\lambda(\\phi_{p}) = \\lambda_{0} - \\sigma \\phi_{p} $$\n\n接下来，我们必须消去参数$\\sigma$。为此，我们使用无量纲蛋白质组成本系数$c$的定义：\n$$ c \\equiv \\lim_{\\phi_{p} \\to 0} \\frac{\\lambda_{0} - \\lambda(\\phi_{p})}{\\lambda_{0}\\,\\phi_{p}} $$\n这个表达式用极限来定义$c$，而这个极限可以等同于一个导数。重写该表达式可以阐明这一点：\n$$ c = \\frac{1}{\\lambda_{0}} \\lim_{\\phi_{p} \\to 0} \\frac{-(\\lambda(\\phi_{p}) - \\lambda_{0})}{\\phi_{p} - 0} = -\\frac{1}{\\lambda_{0}} \\left( \\frac{d\\lambda}{d\\phi_{p}} \\right)_{\\phi_{p}=0} $$\n现在我们使用我们推导出的表达式来计算$\\lambda(\\phi_{p})$相对于$\\phi_{p}$的导数：\n$$ \\frac{d\\lambda}{d\\phi_{p}} = \\frac{d}{d\\phi_{p}} (\\lambda_{0} - \\sigma \\phi_{p}) = -\\sigma $$\n该导数是一个常数，所以它在$\\phi_{p}=0$处的值也是$-\\sigma$。将此结果代入$c$的公式中：\n$$ c = -\\frac{1}{\\lambda_{0}} (-\\sigma) = \\frac{\\sigma}{\\lambda_{0}} $$\n这就提供了一个用所期望的参数表示的$\\sigma$的表达式：\n$$ \\sigma = c \\lambda_{0} $$\n\n最后，我们将这个$\\sigma$的表达式代回到我们的$\\lambda(\\phi_{p})$方程中：\n$$ \\lambda(\\phi_{p}) = \\lambda_{0} - (c \\lambda_{0}) \\phi_{p} $$\n提出公因子$\\lambda_{0}$，就得到了完全用指定参数表示的、作为合成蛋白分数函数的最终闭合形式生长速率表达式：\n$$ \\lambda(\\phi_{p}) = \\lambda_{0}(1 - c \\phi_{p}) $$\n这个结果表明，随着合成蛋白表达带来的负荷增加，生长速率呈线性下降，其下降速率由基线生长速率和成本系数的乘积决定。", "answer": "$$\\boxed{\\lambda_{0}(1 - c \\phi_{p})}$$", "id": "2712681"}, {"introduction": "理解了理论基础后，下一步便是工程实现。有效的控制离不开可靠的测量，这项实践将聚焦于校准一个“负荷报告器”——这是一种能将细胞内部压力转化为可测量信号的合成生物学传感器([@problem_id:2712619])。通过将模拟的实验数据拟合到希尔函数模型，你将学习如何提取例如灵敏度和半激活点等关键参数，这些参数对于设计和调试反馈控制器至关重要。", "problem": "您正在设计一种用于缓解细胞负荷的自适应控制策略，其中，一个负荷报告基因将异源模块施加的有效资源限制映射到一个诱导型致动器。为了安全地调整控制器，您必须通过扰动实验辨识静态输入输出非线性，并提取与控制相关的可解释参数：半激活点处的灵敏度和半激活输入，从而校准该报告基因。假设以下建模基础：基因调控通常表现出协同结合行为，在稳态下，由于启动子占有率，这种行为可以很好地用 Hill 非线性来近似，并且由于转录-翻译-成熟过程，表现出一阶低通动力学；然而，为了进行校准，您将获得从多次阶梯式诱导中计算出的平台期平均稳态数据，这就不需要对动力学进行显式建模。\n\n将校准过程形式化如下。设异源诱导输入为$u \\ge 0$，稳态报告基因输出为$y \\ge 0$。假设稳态映射为\n$$ f(u; \\theta) = y_0 + y_{\\max}\\frac{u^{n}}{K^{n} + u^{n}}, $$\n其中参数向量为$\\theta = (y_0, y_{\\max}, K, n)$，基线$y_0 \\ge 0$，动态范围$y_{\\max} > 0$，半激活点$K > 0$，Hill 系数$n > 0$。将半激活点处的局部灵敏度定义为稳态增益\n$$ S = \\left.\\frac{d f(u;\\theta)}{d u}\\right|_{u = K}. $$\n从负担缓解的控制设计角度来看，$S$量化了工作点处的小信号放大倍数，而$K$则确定了负担调控响应最灵敏的工作输入。\n\n您的任务是编写一个完整的、可运行的程序，该程序针对下述每个测试用例，根据指定的输入$u_i$和和个生成规则，构建一个确定性稳态数据集$\\{(u_i,y_i)\\}_{i=1}^m$，在物理上有意义的界限下，通过非线性最小二乘法拟合 Hill 参数$\\theta$，并为每个用例返回估计的灵敏度$S$和半激活点$K$。\n\n每个测试用例使用以下数据生成过程。给定参数$(y_0^{\\star}, y_{\\max}^{\\star}, K^{\\star}, n^{\\star})$、噪声幅值$a \\ge 0$、噪声频率$\\omega \\ge 0$和输入网格$\\mathcal{U} = [u_1,\\dots,u_m]$，将测量的稳态定义为\n$$ y_i = y_0^{\\star} + y_{\\max}^{\\star}\\frac{u_i^{n^{\\star}}}{(K^{\\star})^{n^{\\star}} + u_i^{n^{\\star}}} + a \\sin(\\omega u_i), \\quad i \\in \\{1,\\dots,m\\}. $$\n不允许使用随机数；正弦项是一个确定性扰动，用于模拟可重复的制备偏差。您必须拟合$\\theta$以最小化残差平方和$\\sum_{i=1}^m \\left(y_i - f(u_i;\\theta)\\right)^2$，并满足界限$y_0 \\ge 0$、$y_{\\max} \\ge 0$、$K > 0$和$n \\in [\\,0.5,\\,8\\,]$。然后根据拟合出的$\\hat{\\theta}$计算$S$，并报告每个测试用例的$(S, K)$。\n\n测试套件。对于每个测试用例$j \\in \\{1,2,3\\}$，使用以下参数构建$\\mathcal{U}^{(j)}$和$y^{(j)}$。所有数字都是精确的，必须完全按照指定使用。\n\n- 用例 1 (理想情况，中等协同性，动态范围覆盖良好)：\n  - 真实参数：$y_0^{\\star} = 0.05$, $y_{\\max}^{\\star} = 1.2$, $K^{\\star} = 1.0$, $n^{\\star} = 2.5$。\n  - 扰动：$a = 0.01$, $\\omega = 1.7$。\n  - 输入网格：$\\mathcal{U}^{(1)} = [\\,0.0,\\,0.05,\\,0.1,\\,0.2,\\,0.5,\\,1.0,\\,2.0,\\,5.0,\\,10.0\\,]$。\n\n- 用例 2 (接近米氏-门腾的边界状态，小 $K$)：\n  - 真实参数：$y_0^{\\star} = 0.02$, $y_{\\max}^{\\star} = 0.8$, $K^{\\star} = 0.2$, $n^{\\star} = 1.05$。\n  - 扰动：$a = 0.005$, $\\omega = 2.3$。\n  - 输入网格：$\\mathcal{U}^{(2)} = [\\,0.0,\\,0.02,\\,0.05,\\,0.1,\\,0.2,\\,0.4,\\,0.8,\\,1.6\\,]$。\n\n- 用例 3 (边缘情况，高度超敏)：\n  - 真实参数：$y_0^{\\star} = 0.1$, $y_{\\max}^{\\star} = 2.0$, $K^{\\star} = 3.0$, $n^{\\star} = 6.0$。\n  - 扰动：$a = 0.02$, $\\omega = 0.5$。\n  - 输入网格：$\\mathcal{U}^{(3)} = [\\,0.0,\\,0.5,\\,1.0,\\,2.0,\\,3.0,\\,4.0,\\,6.0,\\,9.0\\,]$。\n\n算法和数值要求：\n- 为$\\theta = (y_0, y_{\\max}, K, n)$实现一个非线性最小二乘拟合，其界限为$y_0 \\in [\\,0,\\,+\\infty)$、$y_{\\max} \\in [\\,0,\\,+\\infty)$、$K \\in (\\,0,\\,+\\infty)$、$n \\in [\\,0.5,\\,8\\,]$。使用从数据中推导出的确定性初始猜测策略（例如，使用$\\min y_i$、$\\max y_i$和中点响应输入来初始化$y_0$、$y_{\\max}$和$K$；以及一个固定的初始$n$）。\n- 拟合后，使用定义$S = \\left.\\frac{d f(u;\\hat{\\theta})}{d u}\\right|_{u=\\hat{K}}$从拟合参数$\\hat{y}_0, \\hat{y}_{\\max}, \\hat{K}, \\hat{n}$计算$S$。\n- 对于$u=0$和小$K$的情况，必须通过依赖有界参数而非任何特设的正则化来妥善处理数值稳定性。\n- 任何地方都不允许使用随机性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为$[\\,S^{(1)}, K^{(1)}, S^{(2)}, K^{(2)}, S^{(3)}, K^{(3)}\\,]$，其中$S^{(j)}$和$K^{(j)}$是用例$j$的估计灵敏度和半激活点。每个条目都必须是浮点数。\n\n以无量纲值作答。不涉及物理单位或角度。以指定的列表格式将所有数值结果表示为普通十进制浮点数。", "solution": "所提出的问题是系统辨识和参数估计领域一个定义明确的练习，其背景为合成生物学。它具有科学依据，逻辑上一致，并包含进行唯一、可验证求解所需的所有信息。因此，该问题被认为是有效的。\n\n核心任务是从合成的稳态数据中估计 Hill 型非线性的参数，然后计算与控制相关的指标。该过程包括三个主要阶段：数据生成、通过非线性最小二乘法进行参数拟合，以及计算派生量。\n\n首先，我们对模型进行形式化。输入诱导物浓度 $u$ 和输出报告基因水平 $y$ 之间的稳态关系由 Hill 函数给出：\n$$\ny = f(u; \\theta) = y_0 + y_{\\max}\\,\\frac{u^{n}}{K^{n} + u^{n}}\n$$\n其中 $\\theta = (y_0, y_{\\max}, K, n)$ 是参数向量：$y_0$ 是基线输出，$y_{\\max}$ 是动态范围，$K$ 是半激活浓度（响应达到 $y_0$ 和 $y_0 + y_{\\max}$ 之间一半时的输入 $u$），$n$ 是 Hill 系数，它量化了响应的陡峭程度或协同性。\n\n对于每个测试用例，根据以下规则生成数据集 $\\{(u_i, y_i)\\}_{i=1}^m$：\n$$\ny_i = \\left( y_0^{\\star} + y_{\\max}^{\\star}\\,\\frac{u_i^{n^{\\star}}}{(K^{\\star})^{n^{\\star}} + u_i^{n^{\\star}}} \\right) + a \\,\\sin(\\omega\\,u_i)\n$$\n其中 $(y_0^{\\star}, y_{\\max}^{\\star}, K^{\\star}, n^{\\star})$ 是真实模型参数，而项 $a \\,\\sin(\\omega\\,u_i)$ 代表一个确定性的、结构化的扰动，而不是随机噪声。\n\n第二阶段是参数估计。我们寻求参数向量 $\\hat{\\theta} = (\\hat{y}_0, \\hat{y}_{\\max}, \\hat{K}, \\hat{n})$，该向量最小化测量数据 $y_i$ 和模型预测 $f(u_i; \\theta)$ 之间的残差平方和：\n$$\n\\hat{\\theta} = \\arg\\min_{\\theta} \\sum_{i=1}^m \\left(y_i - f(u_i;\\theta)\\right)^2\n$$\n该最小化过程受制于对参数的物理上有意义的约束：$y_0 \\ge 0$、$y_{\\max} \\ge 0$、$K > 0$ 和 $n \\in [0.5, 8]$。这些约束确保了拟合模型的生物学可解释性。这是一个标准的非线性最小二乘回归问题，可以使用诸如 Levenberg-Marquardt 算法之类的数值算法来求解，例如在 `scipy.optimize.curve_fit` 中实现的算法。对于优化例程，确定性的初始猜测对于可复现性至关重要，并且是根据数据本身构建的：$y_0$ 从 $u=0$ 时的响应初始化，$y_{\\max}$ 从观测到的数据范围初始化，$K$ 从产生半最大响应的输入初始化，而 $n$ 则设置为一个固定的初始值（例如 2）。\n\n最后阶段是从拟合模型 $\\hat{\\theta}$ 计算与控制相关的参数。半激活点就是拟合的参数 $\\hat{K}$。此点处的灵敏度 $S$ 定义为在 $u=\\hat{K}$ 处求值的稳态函数的导数：\n$$\nS = \\left.\\frac{d f(u;\\hat{\\theta})}{d u}\\right|_{u = \\hat{K}}\n$$\n为了找到 $S$ 的表达式，我们将 Hill 函数对 $u$ 求导：\n$$\n\\frac{df}{du} = y_{\\max} \\frac{d}{du}\\left(\\frac{u^n}{K^n + u^n}\\right) = y_{\\max} \\frac{(n u^{n-1})(K^n + u^n) - (u^n)(n u^{n-1})}{(K^n + u^n)^2}\n$$\n简化分子得到：\n$$\n\\frac{df}{du} = y_{\\max} \\frac{n K^n u^{n-1}}{(K^n + u^n)^2}\n$$\n现在，我们在 $u=K$ 处计算这个导数：\n$$\nS = \\left.\\frac{df}{du}\\right|_{u=K} = \\hat{y}_{\\max} \\frac{\\hat{n} \\hat{K}^n \\hat{K}^{\\hat{n}-1}}{(\\hat{K}^{\\hat{n}} + \\hat{K}^{\\hat{n}})^2} = \\hat{y}_{\\max} \\frac{\\hat{n} \\hat{K}^{2\\hat{n}-1}}{(2\\hat{K}^{\\hat{n}})^2} = \\hat{y}_{\\max} \\frac{\\hat{n} \\hat{K}^{2\\hat{n}-1}}{4\\hat{K}^{2\\hat{n}}}\n$$\n这简化为基于拟合参数的灵敏度最终表达式：\n$$\nS = \\frac{\\hat{y}_{\\max} \\hat{n}}{4\\hat{K}}\n$$\n将此过程应用于问题中指定的三个测试用例中的每一个，为每个用例 $j \\in \\{1, 2, 3\\}$ 产生一对值 $(S^{(j)}, K^{(j)})$。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting a Hill function to synthetic data for three\n    test cases and calculates control-relevant parameters S and K.\n    \"\"\"\n\n    # Define the test cases as per the problem statement.\n    test_cases = [\n        {\n            \"case_id\": 1,\n            \"true_params\": {\"y0_star\": 0.05, \"ymax_star\": 1.2, \"K_star\": 1.0, \"n_star\": 2.5},\n            \"disturbance\": {\"a\": 0.01, \"omega\": 1.7},\n            \"u_grid\": np.array([0.0, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0, 10.0])\n        },\n        {\n            \"case_id\": 2,\n            \"true_params\": {\"y0_star\": 0.02, \"ymax_star\": 0.8, \"K_star\": 0.2, \"n_star\": 1.05},\n            \"disturbance\": {\"a\": 0.005, \"omega\": 2.3},\n            \"u_grid\": np.array([0.0, 0.02, 0.05, 0.1, 0.2, 0.4, 0.8, 1.6])\n        },\n        {\n            \"case_id\": 3,\n            \"true_params\": {\"y0_star\": 0.1, \"ymax_star\": 2.0, \"K_star\": 3.0, \"n_star\": 6.0},\n            \"disturbance\": {\"a\": 0.02, \"omega\": 0.5},\n            \"u_grid\": np.array([0.0, 0.5, 1.0, 2.0, 3.0, 4.0, 6.0, 9.0])\n        }\n    ]\n\n    # Model definition: Hill function\n    def hill_function(u, y0, ymax, K, n):\n        \"\"\"\n        Calculates the Hill function response.\n        f(u) = y0 + ymax * u^n / (K^n + u^n)\n        \"\"\"\n        # To avoid potential warnings with u=0 and n1, although not an issue here.\n        # Added a small epsilon to the numerator and denominator for robustness.\n        u_n = np.power(u, n)\n        K_n = np.power(K, n)\n        return y0 + ymax * u_n / (K_n + u_n)\n\n    results = []\n    for case in test_cases:\n        u_data = case[\"u_grid\"]\n        \n        # --- 1. Data Generation ---\n        p_true = case[\"true_params\"]\n        dist = case[\"disturbance\"]\n        \n        y_model = hill_function(u_data, p_true[\"y0_star\"], p_true[\"ymax_star\"], p_true[\"K_star\"], p_true[\"n_star\"])\n        y_noise = dist[\"a\"] * np.sin(dist[\"omega\"] * u_data)\n        y_data = y_model + y_noise\n\n        # --- 2. Parameter Fitting ---\n        \n        # Deterministic initial guess strategy\n        # Initial y0: response at u=0. Assumes u=0 is the first data point.\n        y0_guess = y_data[0]\n        # Initial ymax: max response - min response\n        ymax_guess = np.max(y_data) - y0_guess\n        # Initial K: input at which response is half-maximal\n        y_mid = y0_guess + ymax_guess / 2.0\n        mid_idx = np.argmin(np.abs(y_data - y_mid))\n        K_guess = u_data[mid_idx]\n        if K_guess == 0.0:  # Avoid K=0 as it is out of bounds\n            K_guess = np.median(u_data[u_data > 0]) if np.any(u_data > 0) else 0.1\n        # Initial n: fixed value as suggested\n        n_guess = 2.0\n\n        p0 = [y0_guess, ymax_guess, K_guess, n_guess]\n        \n        # Parameter bounds\n        # y0 >= 0, ymax >= 0, K > 0 (approximated as K >= 1e-9), 0.5 = n = 8\n        bounds = ([0, 0, 1e-9, 0.5], [np.inf, np.inf, np.inf, 8.0])\n\n        # Perform nonlinear least-squares fit\n        p_opt, _ = curve_fit(hill_function, u_data, y_data, p0=p0, bounds=bounds, method='trf')\n        \n        y0_fit, ymax_fit, K_fit, n_fit = p_opt\n\n        # --- 3. Calculation of S and K ---\n        # K is the fitted parameter itself\n        K_est = K_fit\n        # S = (ymax * n) / (4 * K)\n        S_est = (ymax_fit * n_fit) / (4 * K_fit)\n        \n        results.extend([S_est, K_est])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2712619"}, {"introduction": "有了传感器和系统模型，我们现在可以设计控制器了。这项练习深入探讨了反馈控制的核心，通过分析两种常见的控制策略：比例（P）控制和比例-积分（PI）控制([@problem_id:2712643])。通过推导每种策略下的稳态误差，你将揭示控制理论的一个基本原则：积分环节如何通过消除持续存在的误差来提供鲁棒性，从而确保细胞负荷精确地维持在期望的设定点，即使面对未知的扰动。", "problem": "一个感知负荷的资源分配模块被用于减轻合成 *Escherichia coli* 菌株中的宿主负荷。令标量宿主负荷状态表示为$b(t)$，其定义为翻译能力相对于无负荷基线的无量纲分数偏差。假设在标称工作点附近，$b(t)$可以由一个带附加恒定扰动的一阶线性动力学很好地近似：\n$$ \\frac{db}{dt} = -k_{b}(b(t) - b_{0}) + S_{p}u(t) + d, $$\n其中$k_{b} \\gt 0$是在无控制情况下宿主回到基线$b_{0}$的内在弛豫率，$S_{p} \\neq 0$是负荷对控制输入$u(t)$的对象灵敏度（即执行器对负荷的净效应），而$d$是一个未知但恒定的外源负荷。测量输出为$y(t) = b(t)$，控制目标是使用输出反馈来跟踪一个恒定的负荷设定点$r$。\n\n考虑两个驱动相同$u(t)$的控制器：\n- 比例（P）控制：$u(t) = K_{p}(r - y(t))$，其中$K_{p} \\in \\mathbb{R}$。\n- 比例-积分（PI）控制：$u(t) = K_{p}(r - y(t)) + K_{i}\\int_{0}^{t} (r - y(\\tau))d\\tau$，其中$K_{p} \\in \\mathbb{R}$且$K_{i} \\ge 0$。\n\n假设对于所选的增益，闭环系统是内部稳定的，并且在恒定设定点$r$和恒定扰动$d$下，所有信号都稳定到一个稳态。从给定的对象动力学和这些控制器定义出发，根据第一性原理推导比例控制下的稳态跟踪误差$e_{\\mathrm{ss}} = r - y_{\\mathrm{ss}}$，该误差是$K_{p}$、$S_{p}$以及$k_{b}$、$b_{0}$、$r$和$d$的函数。然后，确定比例-积分控制下的稳态误差，并解释在何种条件下积分作用可以消除针对恒定$d$的稳态误差。\n\n将你的最终答案表示为一个单行矩阵$\\big[e_{\\mathrm{ss}}^{(P)} \\;\\; e_{\\mathrm{ss}}^{(PI)}\\big]$，其中每个条目都是用上述符号表示的闭式解析表达式。不要包含单位。如果需要任何近似，请陈述并证明其合理性；否则，请提供精确表达式。", "solution": "该问题要求推导一阶线性系统在比例（P）控制和比例-积分（PI）控制下的稳态跟踪误差。分析将从第一性原理进行，假设闭环系统是稳定的，并且所有信号都收敛到一个稳态。\n\n首先，对问题陈述进行验证。\n给定信息如下：\n对象动力学：$\\frac{db}{dt} = -k_{b}(b(t) - b_{0}) + S_{p}u(t) + d$\n参数：$k_{b} > 0$，$b_{0}$，$S_{p} \\neq 0$，$d$ 是常数。\n输出：$y(t) = b(t)$\n设定点：$r$ 是常数。\nP控制器：$u(t) = K_{p}(r - y(t))$，其中 $K_{p} \\in \\mathbb{R}$。\nPI控制器：$u(t) = K_{p}(r - y(t)) + K_{i}\\int_{0}^{t} (r - y(\\tau))d\\tau$，其中 $K_{p} \\in \\mathbb{R}$，$K_{i} \\ge 0$。\n假设：闭环系统是内部稳定的，并达到稳态。\n目标：推导两种控制器下的稳态跟踪误差 $e_{\\mathrm{ss}} = r - y_{\\mathrm{ss}}$。\n\n问题是有效的。这是线性控制理论中的一个标准练习，基于既定原理。问题是适定的、客观的，并包含足够的信息以获得无矛盾的唯一解。该模型是系统生物学和合成生物学中常用的一种科学上合理的简化。我们开始求解。\n\n让我们首先分析比例（P）控制下的系统。\n控制律为 $u(t) = K_{p}(r - y(t))$。\n将其代入对象动力学，并使用 $y(t) = b(t)$，我们得到输出 $y(t)$ 的闭环微分方程：\n$$\n\\frac{dy}{dt} = -k_{b}(y(t) - b_{0}) + S_{p}K_{p}(r - y(t)) + d\n$$\n在稳态下，当 $t \\to \\infty$ 时，所有时间导数都趋于零。因此，$\\frac{dy}{dt} \\to 0$，输出收敛到一个常数值，$y(t) \\to y_{\\mathrm{ss}}$。方程变为：\n$$\n0 = -k_{b}(y_{\\mathrm{ss}} - b_{0}) + S_{p}K_{p}(r - y_{\\mathrm{ss}}) + d\n$$\n我们现在必须求解这个关于 $y_{\\mathrm{ss}}$ 的代数方程。展开各项：\n$$\n0 = -k_{b}y_{\\mathrm{ss}} + k_{b}b_{0} + S_{p}K_{p}r - S_{p}K_{p}y_{\\mathrm{ss}} + d\n$$\n合并包含 $y_{\\mathrm{ss}}$ 的项：\n$$\n(k_{b} + S_{p}K_{p})y_{\\mathrm{ss}} = k_{b}b_{0} + S_{p}K_{p}r + d\n$$\n对于这个一阶系统，稳定性的假设意味着有效速率常数 $k_{b} + S_{p}K_{p}$ 必须为正，因此非零。我们因此可以解出 $y_{\\mathrm{ss}}$：\n$$\ny_{\\mathrm{ss}} = \\frac{k_{b}b_{0} + S_{p}K_{p}r + d}{k_{b} + S_{p}K_{p}}\n$$\n稳态误差 $e_{\\mathrm{ss}}^{(P)}$ 定义为 $r - y_{\\mathrm{ss}}$。代入 $y_{\\mathrm{ss}}$ 的表达式：\n$$\ne_{\\mathrm{ss}}^{(P)} = r - \\frac{k_{b}b_{0} + S_{p}K_{p}r + d}{k_{b} + S_{p}K_{p}}\n$$\n为了简化，我们将表达式通分：\n$$\ne_{\\mathrm{ss}}^{(P)} = \\frac{r(k_{b} + S_{p}K_{p}) - (k_{b}b_{0} + S_{p}K_{p}r + d)}{k_{b} + S_{p}K_{p}}\n$$\n$$\ne_{\\mathrm{ss}}^{(P)} = \\frac{rk_{b} + rS_{p}K_{p} - k_{b}b_{0} - S_{p}K_{p}r - d}{k_{b} + S_{p}K_{p}}\n$$\n消去 $rS_{p}K_{p}$ 项，得到P控制下稳态误差的最终表达式：\n$$\ne_{\\mathrm{ss}}^{(P)} = \\frac{k_{b}r - k_{b}b_{0} - d}{k_{b} + S_{p}K_{p}} = \\frac{k_{b}(r - b_{0}) - d}{k_{b} + S_{p}K_{p}}\n$$\n这是一个非零误差，它取决于系统参数、设定点 $r$ 和扰动 $d$。\n\n接下来，我们分析比例-积分（PI）控制下的系统。\n控制律为 $u(t) = K_{p}(r - y(t)) + K_{i}\\int_{0}^{t} (r - y(\\tau))d\\tau$。\n在稳态下，所有信号都是常数：$y(t) \\to y_{\\mathrm{ss}}$，$u(t) \\to u_{\\mathrm{ss}}$，以及 $\\frac{dy}{dt} \\to 0$。\n稳态下的对象方程形式不变：\n$$\n0 = -k_{b}(y_{\\mathrm{ss}} - b_{0}) + S_{p}u_{\\mathrm{ss}} + d\n$$\n这要求控制输入 $u(t)$ 趋于一个常数值 $u_{\\mathrm{ss}} = \\frac{k_{b}(y_{\\mathrm{ss}} - b_{0}) - d}{S_{p}}$。\n现在，我们考察控制器。为了使控制输入 $u(t)$ 收敛到一个常数值 $u_{\\mathrm{ss}}$，其时间导数必须趋于零，即 $\\frac{du}{dt} \\to 0$。我们将PI控制律对时间求导：\n$$\n\\frac{du}{dt} = \\frac{d}{dt} \\left[ K_{p}(r - y(t)) + K_{i}\\int_{0}^{t} (r - y(\\tau))d\\tau \\right]\n$$\n使用恒定设定点 $r$ 和微积分基本定理：\n$$\n\\frac{du}{dt} = -K_{p}\\frac{dy}{dt} + K_{i}(r - y(t))\n$$\n现在，我们应用稳态条件：当 $t \\to \\infty$ 时，$\\frac{du}{dt} \\to 0$，$\\frac{dy}{dt} \\to 0$，并且 $y(t) \\to y_{\\mathrm{ss}}$。将这些代入微分后的控制器方程：\n$$\n0 = -K_{p}(0) + K_{i}(r - y_{\\mathrm{ss}})\n$$\n这可以简化为：\n$$\nK_{i}(r - y_{\\mathrm{ss}}) = 0\n$$\n或者，用稳态误差 $e_{\\mathrm{ss}}^{(PI)} = r - y_{\\mathrm{ss}}$ 表示：\n$$\nK_{i}e_{\\mathrm{ss}}^{(PI)} = 0\n$$\n这个方程是积分控制行为的核心。问题要求积分作用消除稳态误差的条件。积分作用由增益为 $K_{i}$ 的项表示。如果 $K_{i} \\neq 0$，则存在积分作用。根据约束条件 $K_{i} \\ge 0$，这意味着 $K_{i} > 0$。\n如果 $K_{i} > 0$，那么要使乘积 $K_{i}e_{\\mathrm{ss}}^{(PI)}$ 为零，必须有 $e_{\\mathrm{ss}}^{(PI)} = 0$。\n因此，只要系统稳定且积分增益 $K_{i}$ 严格为正，PI控制器就会将稳态跟踪误差驱动到零，从而完全抑制恒定扰动 $d$ 并跟踪设定点 $r$。\n如果 $K_{i} = 0$，控制器退化为P控制器，误差由第一部分推导的表达式给出。然而，问题要求的是PI控制下的误差，按照惯例，这意味着存在积分作用，即 $K_{i} > 0$。在此条件下，误差被消除。\n因此，PI控制下的稳态误差为 $e_{\\mathrm{ss}}^{(PI)} = 0$。\n\n最终答案由两个推导出的稳态误差表达式组成。\n对于P控制：$e_{\\mathrm{ss}}^{(P)} = \\frac{k_{b}(r - b_{0}) - d}{k_{b} + S_{p} K_{p}}$。\n对于PI控制（当 $K_{i} > 0$ 时）：$e_{\\mathrm{ss}}^{(PI)} = 0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_{b}(r - b_{0}) - d}{k_{b} + S_{p} K_{p}}  0\n\\end{pmatrix}\n}\n$$", "id": "2712643"}]}