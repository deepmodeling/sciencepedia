## 引言
在细胞这一微观世界中，许多关键分子的数量极低，其动态行为充满了随机性。理解这种随机性对于揭示基因表达、[细胞决策](@entry_id:165282)和疾病发展的深层机制至关重要。传统的确定性模型（如[常微分方程](@entry_id:147024)）只能描述群体平均行为，无法捕捉单细胞水平上广泛存在的[异质性](@entry_id:275678)和“噪声”，这构成了理解生物系统复杂性的一个主要知识鸿沟。为应对这一挑战，本文系统介绍了[随机模拟](@entry_id:168869)的强大框架。在“原理与机制”一章中，我们将从第一性原理出发，推导[化学主方程](@entry_id:161378)（CME）并详解[Gillespie算法](@entry_id:749905)。随后的“应用与跨学科交叉”一章将展示这些工具如何用于解析[基因表达噪声](@entry_id:160943)、指导合成生物学设计，并应用于免疫学、神经科学等领域。最后，“动手实践”部分将通过具体的编程练习，引导您将理论付诸实践。本文旨在为您提供一套完整的理论知识和实践技能，以应对[生物学中的随机性](@entry_id:265013)问题。

## 原理与机制

继前一章对[随机过程](@entry_id:159502)在合成生物学中重要性的宏观介绍之后，本章将深入探讨描述和模拟生化反应网络随机动态的核心理论框架。我们将从第一性原理出发，系统地阐述[化学主方程](@entry_id:161378)（Chemical Master Equation, CME）的构建，并详细介绍Gillespie[随机模拟算法](@entry_id:189454)（Stochastic Simulation Algorithm, SSA）的机制。本章旨在为读者提供一个坚实的理论基础，以便理解和应用这些强大的工具来分析和设计复杂的[生物系统](@entry_id:272986)。

### [化学动力学](@entry_id:144961)的随机性描述

传统的[化学动力学](@entry_id:144961)模型通常采用[常微分方程](@entry_id:147024)（ODEs）来描述反应物浓度的连续变化。这种确定性方法假设在一个宏观体积内，各种分子数量巨大，可以视为连续变量，且[空间分布](@entry_id:188271)均匀。然而，在细胞这一微观环境中，许多关键的分子（如[转录因子](@entry_id:137860)、mRNA或特定蛋白质）的拷贝数可能非常低，从几个到几百个不等。在这种低拷贝数情景下，将分子数量视为连续变量的假设不再成立，更重要的是，反应事件的内在随机性——即哪个反应在何时发生——变得不可忽略。这些随机波动，被称为**内在噪声（intrinsic noise）**，能够显著影响甚至决定细胞的表型和命运。

为了精确捕捉这种随机性，我们需要一个基于概率论的理论框架。该框架建立在几个关键的物理假设之上：
1.  **“充分混合”（Well-mixed）假设**：系统被视为一个空间均一的反应容器。这意味着分子在容器内的[扩散](@entry_id:141445)运动足够快，以至于在两次连续的反应事件之间，每个分子都有均等的机会出现在体积内的任何位置。因此，反应的概率仅取决于系统中分子的总数，而非其空间位置。
2.  **等温定容假设**：反应在恒定的温度和体积 $V$ 中进行。温度恒定保证了反应的微观[速率常数](@entry_id:196199)不变。

“充分混合”假设是该框架的基石，但其有效性并非无条件的。一个实用的检验标准是比较系统内分子扩散的特征时间尺度 $\tau_{\mathrm{diff}}$ 与主导反应的特征时间尺度 $\tau_{\mathrm{rxn}}$。只有当[扩散](@entry_id:141445)远快于反应（即 $\tau_{\mathrm{diff}} \ll \tau_{\mathrm{rxn}}$）时，系统才能在反应发生后迅速恢复空间[均匀性](@entry_id:152612)，从而满足充分混合的条件。如果违反此条件，则需要更复杂的空间分辨模型 [@problem_id:2777132]。在本章中，我们首先在充分混合的假设下展开讨论。

### [化学主方程](@entry_id:161378) (The Chemical Master Equation)

在上述假设下，一个由 $S$ 种分子和 $R$ 种反应构成的化学网络，其状态可以用一个包含每种分子拷贝数的向量 $\mathbf{X}(t) = (X_1(t), X_2(t), \dots, X_S(t))^{\top}$ 来完整描述。由于分子数量是整数，[状态空间](@entry_id:177074)是离散的，$\mathbf{X}(t) \in \mathbb{N}_0^S$。[化学主方程](@entry_id:161378)（CME）正是描述了系统在时刻 $t$ 处于特定状态 $\mathbf{x}$ 的概率 $P(\mathbf{x}, t)$ 如何随时间演化的方程。

#### 从第一性原理推导

CME本质上是一个关于概率的守恒方程，它通过平衡进出每个可能状态的概率流来描述[概率分布](@entry_id:146404)的动态。对于任意一个特定状态 $\mathbf{x}$，其概率 $P(\mathbf{x}, t)$ 的时间变化率 $\frac{\partial P(\mathbf{x},t)}{\partial t}$ 由两部分组成：所有能够跃迁到状态 $\mathbf{x}$ 的过程（增益项）和所有导致系统离开状态 $\mathbf{x}$ 的过程（损失项）。

为了形式化地描述这些跃迁，我们首先需要定义两个核心数学对象：

1.  **状态变化向量（State-Change Vector）**：每个反应通道 $r$ 都与一个整数向量 $\boldsymbol{\nu}_r \in \mathbb{Z}^S$ 相关联，称为**状态变化向量**或**[化学计量](@entry_id:137450)向量**。当反应 $r$ 发生一次时，系统状态从 $\mathbf{x}$ 更新为 $\mathbf{x} + \boldsymbol{\nu}_r$。所有这些向量可以组合成一个 $S \times R$ 的**化学计量矩阵（stoichiometric matrix）** $S$，其中第 $r$ 列就是 $\boldsymbol{\nu}_r$。例如，对于一个包含自由[启动子](@entry_id:156503) $D_f$、结合[启动子](@entry_id:156503) $D_b$、激活剂[单体](@entry_id:136559) $X$ 等6个物种和8个反应的基因激活模块，其状态向量为 $\mathbf{x} = (D_f, D_b, X, X_2, M, P)^{\top}$。反应 $2X \to X_2$ 会使 $X$ 减少2个， $X_2$ 增加1个，因此其状态变化向量为 $\boldsymbol{\nu}_1 = (0, 0, -2, 1, 0, 0)^{\top}$。通过为每个反应写出这样的向量，就可以构建出完整的化学计量矩阵 $S$ [@problem_id:2777142]。

2.  **[倾向函数](@entry_id:181123)（Propensity Function）**：对于每个反应通道 $r$，我们定义一个**[倾向函数](@entry_id:181123)** $a_r(\mathbf{x})$，它给出了当系统处于状态 $\mathbf{x}$ 时，反应 $r$ 发生的瞬时概率率。更精确地说，$a_r(\mathbf{x}) \mathrm{d}t$ 是在给定系统状态为 $\mathbf{X}(t) = \mathbf{x}$ 的条件下，反应 $r$ 将在下一个无穷小时间间隔 $[t, t+\mathrm{d}t)$ 内发生的概率。

基于这两个定义，我们可以写出CME的增益项和损失项：

-   **损失项**：如果系统当前处于状态 $\mathbf{x}$，任何一个反应 $r$ 的发生都会使其离开该状态。发生反应 $r$ 的概率率为 $a_r(\mathbf{x})$。因此，离开状态 $\mathbf{x}$ 的总概率率是所有可能反应的倾向之和，即 $\sum_{r=1}^{R} a_r(\mathbf{x})$。概率的流出速率就是该总概率率乘以当前状态的概率，即 $(\sum_{r=1}^{R} a_r(\mathbf{x})) P(\mathbf{x},t)$。

-   **增益项**：系统要进入状态 $\mathbf{x}$，必须是在之前处于某个状态 $\mathbf{x}'$，然后通过某个反应 $r$ 跃迁而来，满足 $\mathbf{x}' + \boldsymbol{\nu}_r = \mathbf{x}$。这意味着前一状态必定是 $\mathbf{x}' = \mathbf{x} - \boldsymbol{\nu}_r$。从状态 $\mathbf{x} - \boldsymbol{\nu}_r$ 经由反应 $r$ 跃迁到 $\mathbf{x}$ 的概率率，是该反应在起始状态的倾向 $a_r(\mathbf{x} - \boldsymbol{\nu}_r)$ 乘以系统处于该起始状态的概率 $P(\mathbf{x} - \boldsymbol{\nu}_r, t)$。将所有可能的反应 $r$ 的贡献相加，就得到了进入状态 $\mathbf{x}$ 的总[概率流](@entry_id:150949)入速率：$\sum_{r=1}^{R} a_r(\mathbf{x} - \boldsymbol{\nu}_r) P(\mathbf{x} - \boldsymbol{\nu}_r, t)$。

将增益项和损失项合并，我们便得到了[化学主方程](@entry_id:161378)的完整形式：
$$
\frac{\partial P(\mathbf{x},t)}{\partial t} = \sum_{r=1}^{R} \left[ a_{r}(\mathbf{x} - \boldsymbol{\nu}_{r})P(\mathbf{x} - \boldsymbol{\nu}_{r}, t) - a_{r}(\mathbf{x})P(\mathbf{x},t) \right]
$$
这个方程描述了一个在[离散状态空间](@entry_id:146672)上的连续时间[马尔可夫跳跃过程](@entry_id:751684)。它与[确定性速率方程](@entry_id:198813)有着本质区别：CME描述的是整个[概率分布](@entry_id:146404) $P(\mathbf{x},t)$ 在[离散状态空间](@entry_id:146672)上的演化，而确定性方程则描述单一的、连续的浓度轨迹，忽略了所有随机波动。确定性描述是CME在[热力学极限](@entry_id:143061)下（即体积 $V \to \infty$ 且分子数 $\to \infty$，使得浓度保持有限）的一种平均场近似 [@problem_id:2777136]。

### [倾向函数](@entry_id:181123)的推导

[倾向函数](@entry_id:181123) $a_r(\mathbf{x})$ 是连接微观物理过程和C[ME模型](@entry_id:261918)的桥梁。其具体形式取决于反应的分子机制。

对于**[零级反应](@entry_id:176293)**（如 $\emptyset \to A$），[反应速率](@entry_id:139813)与反应物无关，其倾向是一个常数，$a = k$。
对于**[一级反应](@entry_id:136907)**（如 $A \to B$ 或 $A \to \emptyset$），[反应速率](@entry_id:139813)正比于反应物 $A$ 的分子数 $x_A$，其倾向为 $a(x_A) = k x_A$。

对于**二级及以上反应**，推导需要更仔细的[组合学](@entry_id:144343)分析。
考虑一个**异源[二聚化](@entry_id:271116)反应** $A+B \to C$。若系统中有 $x_A$ 个 $A$ 分子和 $x_B$ 个 $B$ 分子，则可以形成 $x_A x_B$ 个不同的 $(A, B)$ 反应物对。如果每个特定的反应物对以微观速率常数 $c$ 发生反应，则总倾向为 $a(x_A, x_B) = c x_A x_B$。

对于**同源二聚化反应** $2X \to Y$，情况则有所不同。系统中有 $x$ 个 $X$ 分子，它们是不可区分的。为了形成一个反应，我们需要选择两个不同的 $X$ 分子。从 $x$ 个分子中选取一个无序对的方式有 $\binom{x}{2} = \frac{x(x-1)}{2}$ 种。如果每个特定的分子对以微观速率常数 $c$ 发生反应，那么总倾向就是所有可能反应对的贡献之和，即：
$$
a(x) = c \binom{x}{2} = c \frac{x(x-1)}{2}
$$
这个组合因子是至关重要的，它源于反应物分子的不可区分性 [@problem_id:2777137]。

这个原理可以推广到更高阶的反应。例如，对于一个三聚化反应 $3X \to Y$，[反应倾向](@entry_id:262886)将正比于从 $x$ 个分子中选取三个无序分子的组[合数](@entry_id:263553) $\binom{x}{3}$：
$$
a(x) = c \binom{x}{3} = c \frac{x(x-1)(x-2)}{6}
$$

一个关键的问题是，如何将这些微观的随机[速率常数](@entry_id:196199) $c$ 与实验中更易测量的宏观[速率常数](@entry_id:196199) $k$ 联系起来。这可以通过在[热力学极限](@entry_id:143061)下要求随机模型与确定性模型一致来实现。例如，对于反应 $3X \to Y$，[确定性速率方程](@entry_id:198813)为 $\frac{d[X]}{dt} = -3k[X]^3$，其中 $[X] = x/(N_A V)$ 是摩尔浓度，$N_A$ 是阿伏伽德罗常数。在随机模型中，$\langle x \rangle$ 的[平均变化率](@entry_id:193432)为 $\frac{d\langle x \rangle}{dt} = -3 \langle a(x) \rangle$。在大数极限下，$\langle a(x) \rangle \approx a(\langle x \rangle)$ 且 $x(x-1)(x-2) \approx x^3$。通过匹配两种描述，我们可以推导出微观与宏观常数之间的关系，对于三聚化反应，这个关系是 $c = \frac{6k}{N_A^2 V^2}$。这表明微观[速率常数](@entry_id:196199) $c$ 依赖于系统的体积 $V$ [@problem_id:2777164]。

### [过程模拟](@entry_id:634927)：Gillespie[随机模拟算法](@entry_id:189454) (SSA)

[化学主方程](@entry_id:161378)是一个庞大的、通常是无限维的[线性常微分方程组](@entry_id:163837)，除了极少数简单情况外，无法求得解析解。直接进行数值求解也因状态空间巨大而变得不可行。这催生了对另一种方法的迫切需求：不是求解[概率分布](@entry_id:146404) $P(\mathbf{x}, t)$ 本身，而是生成遵循该[分布](@entry_id:182848)的系统状态演化轨迹的样本。Daniel T. Gillespie提出的[随机模拟算法](@entry_id:189454)（SSA）正是实现这一目标的里程碑式方法。

SSA的核心思想是，它不是对CME进行离散化或近似求解，而是对CME所描述的底层连续时间[马尔可夫跳跃过程](@entry_id:751684)进行精确的[随机模拟](@entry_id:168869)。因此，通过SSA生成的大量轨迹的统计集合，会严格收敛于CME的解。从这个意义上说，SSA是“统计上精确的” [@problem_id:2777202]。

#### 算法的理论基础：马尔可夫属性

SSA的正确性完全依赖于[马尔可夫过程](@entry_id:160396)的“无记忆性”。在一个处于状态 $\mathbf{x}$ 的系统中，下一个事件何时发生以及是哪个事件发生，仅取决于当前状态 $\mathbf{x}$，而与系统如何到达该状态的历史无关。基于这一属性，Gillespie证明了在任何时刻，我们只需要回答两个问题就能推进模拟：
1.  **下一个反应将在多久后发生？**
2.  **发生的将是哪个反应？**

给定系统状态为 $\mathbf{x}$，每个反应通道 $r$ 可以被看作一个独立的泊松过程，其速率为 $a_r(\mathbf{x})$。所有这些反应通道“竞争”成为下一个发生的事件。根据泊松过程的理论，多个独立[泊松过程的叠加](@entry_id:264543)仍然是一个泊松过程，其总速率是各分过程速率之和，即 $a_0(\mathbf{x}) = \sum_{r=1}^{R} a_r(\mathbf{x})$。一个速率为 $\lambda$ 的泊松过程中，事件之间的时间间隔服从参数为 $\lambda$ 的[指数分布](@entry_id:273894)。因此，下一个反应发生的等待时间 $\tau$ 服从一个参数为 $a_0(\mathbf{x})$ 的[指数分布](@entry_id:273894)。

当一个反应确实发生时，它是反应 $r$ 的概率等于其速率 $a_r(\mathbf{x})$ 在总速率 $a_0(\mathbf{x})$ 中所占的比例，即 $P(\text{反应 } r \text{ 发生}) = \frac{a_r(\mathbf{x})}{a_0(\mathbf{x})}$。

#### 直接法 (The Direct Method)

Gillespie的“直接法”是实现上述思想的最直接的算法：

**初始化**：设定初始时间 $t=0$ 和初始状态 $\mathbf{x} = \mathbf{X}(0)$。设定模拟终止时间 $T_{\max}$。

**迭代循环**（只要 $t  T_{\max}$）：
1.  **计算倾向**：根据当前状态 $\mathbf{x}$，计算所有 $R$ 个反应通道的[倾向函数](@entry_id:181123) $a_r(\mathbf{x})$。
2.  **计算总倾向**：计算总倾向 $a_0(\mathbf{x}) = \sum_{r=1}^{R} a_r(\mathbf{x})$。如果 $a_0(\mathbf{x})=0$，则系统处于吸收态，模拟停止。
3.  **生成等待时间**：生成一个服从 $(0,1)$ 区间[均匀分布](@entry_id:194597)的随机数 $r_1$。计算下一个反应的等待时间 $\tau = \frac{1}{a_0(\mathbf{x})} \ln(\frac{1}{r_1})$。
4.  **选择下一个反应**：生成第二个服从 $(0,1)$ 区间[均匀分布](@entry_id:194597)的随机数 $r_2$。找到满足下列条件的反应索引 $\mu$：
    $$
    \sum_{j=1}^{\mu-1} a_j(\mathbf{x})  r_2 a_0(\mathbf{x}) \le \sum_{j=1}^{\mu} a_j(\mathbf{x})
    $$
    这一步相当于从一个[离散概率分布](@entry_id:166565) $\{p_j = a_j(\mathbf{x})/a_0(\mathbf{x})\}$ 中抽样。
5.  **更新[状态和](@entry_id:193625)时间**：将时间推进 $t \leftarrow t + \tau$，并根据选定的反应 $\mu$ 更新系统状态 $\mathbf{x} \leftarrow \mathbf{x} + \boldsymbol{\nu}_{\mu}$。
6.  **记录与重复**：记录新的状态 $(t, \mathbf{x})$，然后返回步骤1。

每一步都严格遵循[马尔可夫过程](@entry_id:160396)的精确概率法则，因此单次SSA运行产生的轨迹是该过程的一个精确实现 [@problem_id:2777190]。

值得注意的是，算法的“精确性”是理论上的。在实际计算机实现中，误差可能来源于：
-   **数值误差**：使用有限精度[浮点数](@entry_id:173316)进行计算时可能引入舍入误差，尤其是在累加大量倾向值时。
-   **[伪随机数生成器](@entry_id:145648)**：计算机生成的随机数是伪随机的，其周期有限或存在相关性，可能引入系统性偏差。
-   **[蒙特卡洛采样](@entry_id:752171)误差**：我们通常通过运行大量（$N$个）SSA轨迹来估计系统的统计特性（如均值、[方差](@entry_id:200758)）。这些估计值本身是随机的，并带有与 $N^{-1/2}$ 成比例的[采样误差](@entry_id:182646) [@problem_id:2777202]。

### 系统结构与长时行为分析

除了模拟瞬时动态，CME框架还允许我们对系统的结构特性和长期行为进行深入分析。

#### 守恒律与[状态空间](@entry_id:177074)约简

在许多生化网络中，特别是那些“封闭”的（即没有物质流入或流出）网络，存在一些总量保持不变的守恒关系。这些**线性守恒律**可以通过分析化学计量矩阵 $S$ 来系统地找到。任何满足 $c^{\top}S = 0^{\top}$ 的向量 $c$ 都定义了一个[守恒量](@entry_id:150267) $L(\mathbf{x}) = c^{\top}\mathbf{x}$。因为任何状态的改变 $\Delta \mathbf{x}$ 都是 $S$ 列向量的[线性组合](@entry_id:154743)，所以 $c^{\top}\Delta \mathbf{x} = 0$，即 $c^{\top}\mathbf{x}$ 是一个[不变量](@entry_id:148850)。

这些守恒律极大地限制了系统可访问的[状态空间](@entry_id:177074)。从一个初始状态 $\mathbf{x}(0)$ 出发，系统永远无法离开由守恒律定义的[超平面](@entry_id:268044)。所有[可达状态](@entry_id:265999)的集合，称为**[化学计量](@entry_id:137450)相容类（stoichiometric compatibility class）**，是整个[状态空间](@entry_id:177074) $\mathbb{N}_0^S$ 的一个微小[子集](@entry_id:261956)。例如，在一个包含[单体](@entry_id:136559)-二聚体相互转化及二聚体与[启动子](@entry_id:156503)结合的[封闭系统](@entry_id:139565)中，总的[单体](@entry_id:136559)单元数和总的[启动子](@entry_id:156503)数是守恒的。这意味着动态过程被限制在一个由这两个守恒量决定的低维[流形](@entry_id:153038)上，这极大地简化了分析和模拟 [@problem_id:2777158]。

#### [稳态](@entry_id:182458)、遍历性与吸收态

系统在长[时间演化](@entry_id:153943)后会呈现怎样的行为？这取决于其[马尔可夫链](@entry_id:150828)的结构。
-   **[稳态分布](@entry_id:149079)（Stationary Distribution）**：如果一个[概率分布](@entry_id:146404) $\pi(\mathbf{x})$ 不随时间改变，即 $\frac{\partial \pi}{\partial t} = 0$，那么它被称为[稳态分布](@entry_id:149079)。在CME的背景下，这意味着 $\sum_{r=1}^{R} [ a_{r}(\mathbf{x} - \boldsymbol{\nu}_{r})\pi(\mathbf{x} - \boldsymbol{\nu}_{r}) - a_{r}(\mathbf{x})\pi(\mathbf{x}) ] = 0$ 对所有 $\mathbf{x}$ 成立。
-   **遍历性（Ergodicity）**：一个[马尔可夫过程](@entry_id:160396)是遍历的，如果它是**不可约的（irreducible）**（即从任何状态都可能到达任何其他状态）和**[正常返](@entry_id:195139)的（positive recurrent）**（即从任何状态出发，返回该状态的平均时间是有限的）。一个遍历系统拥有唯一的稳态分布 $\pi$，并且无论从哪个初始状态出发，系统在足够长时间后的状态[分布](@entry_id:182848)都会收敛到 $\pi$。证明[正常返](@entry_id:195139)通常需要借助**Foster-Lyapunov条件**等高级工具 [@problem_id:2777141]。

并非所有系统都具有唯一的非平凡[稳态分布](@entry_id:149079)。一个重要的特例是包含**[吸收态](@entry_id:161036)（absorbing states）**的系统。[吸收态](@entry_id:161036)是一个一旦进入就无法离开的状态，其特征是所有离开该状态的[倾向函数](@entry_id:181123)值均为零。

一个典型的例子是只包含降解反应而没有生产反应的系统，例如 $X \to Y$ 和 $X \to \emptyset, Y \to \emptyset$。在这里，状态 $(0,0)$ 就是一个吸收态，因为当 $x=0, y=0$ 时，所有反应的倾向都为零。对于任何有限的初始分子数，由于分子会不断降解，系统最终必然会以概率1落入 $(0,0)$ 态，并且所需时[间期](@entry_id:157879)望是有限的。在这种情况下，唯一的稳态分布是集中在 $(0,0)$ 的一个狄拉克$\delta$[分布](@entry_id:182848)，意味着系统最终的命运是“死亡” [@problem_id:2777177]。

相反，如果在系统中引入持续的生产项（例如 $\emptyset \to X$ 和 $\emptyset \to Y$），哪怕速率极小，情况也会发生根本性改变。生产项确保了系统可以从 $(0,0)$ 状态中“复活”，从而消除了吸收态。如果系统因此变得不可约且[正常返](@entry_id:195139)（这通常可以通过Lyapunov函数来证明），它将拥有一个唯一的、非平凡的[稳态分布](@entry_id:149079)，该[分布](@entry_id:182848)在所有状态上都有正概率。这揭示了一个深刻的原理：一个开放系统（有物质流入）与一个[封闭系统](@entry_id:139565)（无物质流入）在长时行为上有着本质的区别 [@problem_id:2777177]。

#### 再探“充分混合”假设

最后，我们必须再次强调CME和SSA框架的适用边界，即“充分混合”假设。当细胞内存在显著的分子聚集、空间区室化或[反应速率](@entry_id:139813)快于[扩散](@entry_id:141445)速率时，这个假设就会失效。实验上，违反该假设的迹象可能表现为：
-   反应事件之间的**[等待时间分布](@entry_id:262786)不再是[指数分布](@entry_id:273894)**，因为局部反应物耗尽和[扩散](@entry_id:141445)补充过程引入了“记忆” [@problem_id:2777132]。
-   对于一个理论上应服从泊松分布的线性[生灭过程](@entry_id:168595)（例如简单的基因表达），测得的**[法诺因子](@entry_id:136562)（Fano factor）**，即[方差](@entry_id:200758)与均值之比，显著大于1。这通常是由于mRNA在基因位点的“爆发式”合成等局部化生产事件造成的 [@problem_id:2777132]。
-   通过改变细胞体积但保持平均浓度不变的实验，发现推断出的**有效反应速率常数依赖于体积**，这表明速率受到了[扩散](@entry_id:141445)和几何形状的限制 [@problem_id:2777132]。

当出现这些情况时，标准C[ME模型](@entry_id:261918)便不足以描述系统，必须采用更先进的空间分辨随机模型，如[反应-扩散主方程](@entry_id:187799)（Reaction-Diffusion Master Equation, RDME）等。理解CME的原理与机制，也包括了认识其应用的边界。