{"hands_on_practices": [{"introduction": "理解带通滤波器功能的核心在于分析其底层基因线路的动态特性。非相干前馈环（I1-FFL）是实现带通响应的一种经典网络基序，本练习将指导您通过线性系统理论，推导出一个I1-FFL模型在完美适应条件下的传递函数，并解析地求出其峰值响应频率。通过此过程，您将深入理解信号通路如何通过结构设计来实现对特定频率信号的筛选。 [@problem_id:2715264]", "problem": "一种非相干1型前馈环路 (I1-FFL) 是一个三节点遗传基序，其中输入转录因子 $x$ 激活中间调控子 $v$ 和输出基因产物 $z$，而 $v$ 抑制 $z$。考虑一个稳定稳态附近的小扰动，以便应用线性响应理论。令 $v$ 和 $z$ 表示相应物质浓度偏离稳态的量，令 $x$ 表示输入转录因子浓度的小偏差。假设在工作点附近为一阶生成和衰减，因此小信号动力学由以下方程组控制\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x, \\quad \\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v,\n$$\n其中 $\\gamma_{v}>0$ 和 $\\gamma_{z}>0$ 是有效的一阶稀释-降解速率（等效于特征时间的倒数），而 $k_{v}>0$、$k_{x}>0$、$k_{vz}>0$ 是由调控相互作用线性化产生的有效小信号增益。令 $G(s)$ 表示在拉普拉斯域中从 $x$ 到 $z$ 的传递函数，令 $|G(j\\omega)|$ 表示其在角频率 $\\omega$ 处的幅值。\n\n从分子生物学中心法则和一阶质量作用降解出发，并使用线性系统理论作为分析遗传回路中小扰动的成熟分析框架，完成以下任务：\n\n- 推导上述I1-FFL的传递函数 $G(s)$。\n- 从第一性原理出发，推导稳态（零频率）小信号增益恰好为零的条件（即 $z$ 对 $x$ 的阶跃输入的完美适应）。\n- 在该条件下，确定 $|G(j\\omega)|$ 是否在有限的非零频率处出现峰值，如果存在，则计算幅值达到最大值时的角频率 $\\omega_{\\text{peak}}$。用 $\\gamma_{v}$ 和 $\\gamma_{z}$ 表示 $\\omega_{\\text{peak}}$。角频率的单位使用弧度/秒。\n\n你最终报告的答案必须是 $\\omega_{\\text{peak}}$ 关于 $\\gamma_{v}$ 和 $\\gamma_{z}$ 的单个闭式表达式。最终方框内的答案请勿包含单位，也请勿对表达式进行四舍五入或近似。", "solution": "所述问题具有科学依据、内容自洽且定义明确。它描述了一个经典的非相干1型前馈环路 (I1-FFL)，并要求在完美适应条件下分析其小信号频率响应。使用线性化动力学和传递函数分析是完成此项任务的标准且适当的方法。我们将开始求解。\n\n系统动力学由以下线性常微分方程组给出：\n$$\n\\frac{dv}{dt} = -\\gamma_{v}\\, v + k_{v}\\, x\n$$\n$$\n\\frac{dz}{dt} = -\\gamma_{z}\\, z + k_{x}\\, x - k_{vz}\\, v\n$$\n其中所有参数 $\\gamma_v, \\gamma_z, k_v, k_x, k_{vz}$ 均为正常数。\n\n我们的第一个任务是推导从输入 $x$ 到输出 $z$ 的传递函数 $G(s)$。我们对该方程组应用拉普拉斯变换，并假设初始条件为零。令 $X(s)$、$V(s)$ 和 $Z(s)$ 分别是 $x(t)$、$v(t)$ 和 $z(t)$ 的拉普拉斯变换。\n变换后的方程为：\n$$\nsV(s) = -\\gamma_{v} V(s) + k_{v} X(s)\n$$\n$$\nsZ(s) = -\\gamma_{z} Z(s) + k_{x} X(s) - k_{vz} V(s)\n$$\n从第一个方程中，我们求解 $V(s)$ 关于 $X(s)$ 的表达式：\n$$\n(s + \\gamma_{v}) V(s) = k_{v} X(s) \\implies V(s) = \\frac{k_{v}}{s + \\gamma_{v}} X(s)\n$$\n接下来，我们将这个 $V(s)$ 的表达式代入第二个变换后的方程中：\n$$\n(s + \\gamma_{z}) Z(s) = k_{x} X(s) - k_{vz} \\left( \\frac{k_{v}}{s + \\gamma_{v}} \\right) X(s)\n$$\n传递函数 $G(s)$ 定义为比率 $Z(s)/X(s)$。我们重新整理方程以求得此比率：\n$$\nG(s) = \\frac{Z(s)}{X(s)} = \\frac{1}{s + \\gamma_{z}} \\left( k_{x} - \\frac{k_{vz} k_{v}}{s + \\gamma_{v}} \\right)\n$$\n为了将其表示为单个有理函数，我们通分：\n$$\nG(s) = \\frac{k_{x}(s + \\gamma_{v}) - k_{vz} k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n这就是所求的从 $x$ 到 $z$ 的传递函数。\n\n第二个任务是找到完美适应的条件。完美适应意味着输出 $z$ 对输入 $x$ 的恒定阶跃变化的稳态响应为零。在线性系统的背景下，这对应于稳态增益（或零频增益）为零。稳态增益由 $G(s)$ 在 $s=0$ 处的值给出。\n$$\nG(0) = \\frac{k_{x}(0) + k_{x}\\gamma_{v} - k_{vz}k_{v}}{(0 + \\gamma_{z})(0 + \\gamma_{v})} = \\frac{k_{x}\\gamma_{v} - k_{vz}k_{v}}{\\gamma_{z}\\gamma_{v}}\n$$\n为实现完美适应，必须有 $G(0) = 0$。由于 $\\gamma_z > 0$ 且 $\\gamma_v > 0$，分母不为零。因此，分子必须为零：\n$$\nk_{x}\\gamma_{v} - k_{vz}k_{v} = 0\n$$\n这就得出了完美适应的条件：\n$$\nk_{x}\\gamma_{v} = k_{vz}k_{v}\n$$\n\n最后一个任务是在完美适应条件下确定幅值响应 $|G(j\\omega)|$ 的峰值频率。我们将条件 $k_{x}\\gamma_{v} = k_{vz}k_{v}$ 代回到 $G(s)$ 的表达式中：\n$$\nG(s) = \\frac{k_{x}s + k_{x}\\gamma_{v} - k_{x}\\gamma_{v}}{(s + \\gamma_{z})(s + \\gamma_{v})} = \\frac{k_{x}s}{(s + \\gamma_{z})(s + \\gamma_{v})}\n$$\n该传递函数在原点 ($s=0$) 有一个零点，并在 $s=-\\gamma_z$ 和 $s=-\\gamma_v$ 处有两个实极点。这种结构是带通滤波器的典型特征。增益在 $\\omega=0$ 和 $\\omega \\to \\infty$ 时为零，这意味着如果对于 $\\omega > 0$ 存在最大值，它必定出现在一个有限的非零频率处。\n\n为了找到这个峰值频率 $\\omega_{\\text{peak}}$，我们分析频率响应的幅值 $|G(j\\omega)|$。我们通过令 $s=j\\omega$ 来获得频率响应：\n$$\nG(j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})}\n$$\n幅值的平方在求最大值时更易于处理：\n$$\n|G(j\\omega)|^2 = G(j\\omega)G(-j\\omega) = \\frac{k_{x}j\\omega}{(j\\omega + \\gamma_{z})(j\\omega + \\gamma_{v})} \\cdot \\frac{k_{x}(-j\\omega)}{(-j\\omega + \\gamma_{z})(-j\\omega + \\gamma_{v})}\n$$\n$$\n|G(j\\omega)|^2 = \\frac{k_{x}^2 \\omega^2}{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}\n$$\n使 $|G(j\\omega)|$ 最大化的频率 $\\omega_{\\text{peak}}$ 同样也使 $|G(j\\omega)|^2$ 最大化。为了找到这个最大值，我们可以最小化 $|G(j\\omega)|^2$ 中与频率相关的部分的倒数。我们定义一个函数 $H(\\omega)$：\n$$\nH(\\omega) = \\frac{(\\gamma_{z}^2 + \\omega^2)(\\gamma_{v}^2 + \\omega^2)}{\\omega^2}\n$$\n我们旨在找到使 $H(\\omega)$ 最小化的 $\\omega > 0$ 的值。将分子展开并除以 $\\omega^2$ 得到：\n$$\nH(\\omega) = \\frac{\\omega^4 + (\\gamma_{z}^2 + \\gamma_{v}^2)\\omega^2 + \\gamma_{z}^2\\gamma_{v}^2}{\\omega^2} = \\omega^2 + (\\gamma_{z}^2 + \\gamma_{v}^2) + \\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^2}\n$$\n为了求最小值，我们计算 $H(\\omega)$ 对 $\\omega$ 的导数并令其为零：\n$$\n\\frac{dH}{d\\omega} = 2\\omega - 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n对 $\\omega \\neq 0$ 令导数为零：\n$$\n2\\omega = 2\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^3}\n$$\n$$\n\\omega^4 = \\gamma_{z}^2\\gamma_{v}^2\n$$\n由于 $\\omega$ 必须是一个实的、正的频率，我们取两次正平方根：\n$$\n\\omega^2 = \\sqrt{\\gamma_{z}^2\\gamma_{v}^2} = \\gamma_{z}\\gamma_{v} \\quad (\\text{since } \\gamma_z > 0, \\gamma_v > 0)\n$$\n$$\n\\omega = \\sqrt{\\gamma_{z}\\gamma_{v}}\n$$\n这个驻点对应于 $H(\\omega)$ 的一个最小值（因此是 $|G(j\\omega)|^2$ 的一个最大值），因为其二阶导数 $\\frac{d^2H}{d\\omega^2} = 2 + 6\\frac{\\gamma_{z}^2\\gamma_{v}^2}{\\omega^4}$ 对于所有实数 $\\omega \\neq 0$ 都是严格为正的。因此，峰值角频率是两个降解速率的几何平均数。\n$$\n\\omega_{\\text{peak}} = \\sqrt{\\gamma_{v}\\gamma_{z}}\n$$", "answer": "$$\\boxed{\\sqrt{\\gamma_{v}\\gamma_{z}}}$$", "id": "2715264"}, {"introduction": "在掌握了带通滤波器的基本工作原理后，一个自然而然的问题是如何量化其性能并理解设计中的内在权衡。本练习将引导您分析一个典型的带通滤波器模型，推导其峰值增益 $G_{\\mathrm{peak}}$ 和带宽 $\\mathrm{BW}$ 的解析表达式。这项练习的重点是揭示增益与带宽之间的反比关系，这是一个在滤波器设计中普遍存在的、至关重要的基本约束。 [@problem_id:2715227]", "problem": "一个典型的小信号带通遗传滤波器可以通过一个非相干前馈模体来实现，该模体在稳态下实现近乎完美的适应，并对输入波动表现出微分行为。考虑以下线性化常微分方程模型，该模型描述了由输入波动 $u(t)$ 驱动的稳态附近的小信号动态：\n$$\n\\frac{d x}{d t} = -\\gamma\\, x + \\beta\\, u, \\quad \\frac{d y}{d t} = -\\lambda \\gamma\\, y + \\alpha\\big(u - c\\, x\\big),\n$$\n其中 $x$ 是激活臂的小信号活性，其降解或稀释率为 $\\gamma>0$，$y$ 是小信号报告基因输出，其降解率为 $\\lambda \\gamma$（其中 $\\lambda>0$），而 $\\alpha,\\beta,c>0$ 是有效的小信号增益。通过匹配两个臂来施加稳态适应条件（零直流增益），使得 $y$ 对恒定 $u$ 的直流响应为零。在此匹配条件下，推导该滤波器的小信号传递函数 $H(s) = Y(s)/U(s)$。然后，在频域中（令 $s = \\mathrm{i}\\,\\omega$），使用第一性原理执行以下步骤：\n- 确定使幅值 $\\big|H(\\mathrm{i}\\,\\omega)\\big|$ 最大化的角频率 $\\omega_{\\mathrm{peak}}$，并计算相应的峰值增益 $G_{\\mathrm{peak}}=\\big|H(\\mathrm{i}\\,\\omega_{\\mathrm{peak}})\\big|$。\n- 将半功率点定义为两个角频率 $\\omega_{1}$ 和 $\\omega_{2}$，在这两个频率上 $\\big|H(\\mathrm{i}\\,\\omega)\\big|^{2}$ 等于其峰值的一半，并将线性带宽定义为 $\\mathrm{BW}=\\omega_{2}-\\omega_{1}$。\n- 在保持 $\\lambda$ 和所有增益固定的情况下，解析地展示增加 $\\gamma$ 如何改变 $\\mathrm{BW}$ 和 $G_{\\mathrm{peak}}$。\n\n设 $K$ 表示滤波器微分支路的总体小信号高频增益，它在 $H(s)$ 中表现为分子常数。作为最终答案，报告乘积 $\\mathrm{BW}\\times G_{\\mathrm{peak}}$ 关于 $K$ 和 $\\lambda$ 的闭式解析表达式，并以最简形式表示。不需要数值近似，也不需要单位。角频率使用弧度/秒。如果在推导过程中引入了任何中间量，请在最终表达式中将其消除，使其仅依赖于 $K$ 和 $\\lambda$。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n给定的线性化常微分方程组为：\n$$ \\frac{d x}{d t} = -\\gamma\\, x + \\beta\\, u $$\n$$ \\frac{d y}{d t} = -\\lambda \\gamma\\, y + \\alpha\\big(u - c\\, x\\big) $$\n参数定义如下：\n- $x(t)$：激活臂的小信号活性。\n- $y(t)$：小信号报告基因输出。\n- $u(t)$：输入波动。\n- $\\gamma > 0$：$x$ 的降解/稀释率。\n- $\\lambda > 0$：$y$ 降解的无量纲速率常数。\n- $\\alpha, \\beta, c > 0$：有效的小信号增益。\n\n条件：\n- 稳态适应条件意味着 $y$ 对恒定输入 $u$ 的直流（DC）响应为零。\n- 任务是推导传递函数 $H(s) = Y(s)/U(s)$。\n- 然后，求出峰值频率 $\\omega_{\\mathrm{peak}}$ 和峰值增益 $G_{\\mathrm{peak}}$。\n- 根据半功率点定义带宽 $\\mathrm{BW} = \\omega_2 - \\omega_1$。\n- 分析增加 $\\gamma$ 对 $\\mathrm{BW}$ 和 $G_{\\mathrm{peak}}$ 的影响。\n- 将 $K$ 定义为 $H(s)$ 中的分子常数。\n- 最后，报告乘积 $\\mathrm{BW} \\times G_{\\mathrm{peak}}$ 关于 $K$ 和 $\\lambda$ 的表达式。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，描述了一个非相干前馈环的标准线性化模型，这是系统生物学和合成生物学中常见的模体。其数学公式由线性常微分方程组成，适用于小信号分析。该问题是适定的，提供了足够的信息和一组明确的任务，可以导出一个唯一的解。语言客观而精确。不存在矛盾、信息缺失或伪科学主张。在生化反应动力学的背景下，该模型和参数是物理上现实的。\n\n步骤3：结论与行动\n该问题被判定为 **有效**。将推导完整解答。\n\n首先，我们将稳态适应条件形式化。对于一个恒定输入 $u(t) = u_0$，系统达到一个稳态，此时 $dx/dt = 0$ 且 $dy/dt = 0$。\n由第一个方程：\n$$ 0 = -\\gamma x_{ss} + \\beta u_0 \\implies x_{ss} = \\frac{\\beta}{\\gamma} u_0 $$\n由第二个方程：\n$$ 0 = -\\lambda\\gamma y_{ss} + \\alpha(u_0 - c x_{ss}) $$\n代入 $x_{ss}$：\n$$ \\lambda\\gamma y_{ss} = \\alpha\\left(u_0 - c \\frac{\\beta}{\\gamma} u_0\\right) = \\alpha u_0 \\left(1 - \\frac{c\\beta}{\\gamma}\\right) $$\n$y$ 的直流响应为零的条件（即当 $u_0 \\neq 0$ 时 $y_{ss}=0$）要求括号中的项为零。这给出了臂匹配条件：\n$$ 1 - \\frac{c\\beta}{\\gamma} = 0 \\implies \\gamma = c\\beta $$\n\n接下来，我们推导传递函数 $H(s) = Y(s)/U(s)$。我们对系统方程进行拉普拉斯变换，假设小信号变量的初始条件为零：\n$$ sX(s) = -\\gamma X(s) + \\beta U(s) \\implies X(s) = \\frac{\\beta}{s+\\gamma} U(s) $$\n$$ sY(s) = -\\lambda\\gamma Y(s) + \\alpha(U(s) - cX(s)) \\implies Y(s) = \\frac{\\alpha}{s+\\lambda\\gamma} (U(s) - cX(s)) $$\n将 $X(s)$ 代入 $Y(s)$ 的方程中：\n$$ Y(s) = \\frac{\\alpha}{s+\\lambda\\gamma} \\left(U(s) - c \\frac{\\beta}{s+\\gamma} U(s)\\right) = \\frac{\\alpha}{s+\\lambda\\gamma} \\left(1 - \\frac{c\\beta}{s+\\gamma}\\right) U(s) $$\n传递函数为：\n$$ H(s) = \\frac{Y(s)}{U(s)} = \\frac{\\alpha}{s+\\lambda\\gamma} \\frac{s+\\gamma - c\\beta}{s+\\gamma} $$\n应用匹配条件 $\\gamma = c\\beta$：\n$$ H(s) = \\frac{\\alpha}{s+\\lambda\\gamma} \\frac{s+\\gamma - \\gamma}{s+\\gamma} = \\frac{\\alpha s}{(s+\\gamma)(s+\\lambda\\gamma)} $$\n这是一个二阶带通滤波器的传递函数。\n\n为了求出峰值增益，我们分析频率响应的幅值平方，$s = \\mathrm{i}\\omega$：\n$$ |H(\\mathrm{i}\\omega)|^2 = \\left| \\frac{\\alpha \\mathrm{i}\\omega}{(\\mathrm{i}\\omega+\\gamma)(\\mathrm{i}\\omega+\\lambda\\gamma)} \\right|^2 = \\frac{\\alpha^2\\omega^2}{(\\omega^2+\\gamma^2)(\\omega^2+(\\lambda\\gamma)^2)} $$\n为了找到使该函数最大化的频率 $\\omega_{\\mathrm{peak}}$，我们可以对 $z = \\omega^2$ 进行最大化：\n$$ f(z) = \\frac{\\alpha^2 z}{(z+\\gamma^2)(z+\\lambda^2\\gamma^2)} = \\frac{\\alpha^2 z}{z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4} $$\n令导数 $df/dz$ 等于零，我们发现当导数的分子为零时出现最大值：\n$$ \\frac{d}{dz} \\left( \\frac{z}{z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4} \\right) = 0 $$\n$$ 1 \\cdot (z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4) - z \\cdot (2z + \\gamma^2(1+\\lambda^2)) = 0 $$\n$$ -z^2 + \\lambda^2\\gamma^4 = 0 \\implies z_{\\mathrm{peak}} = \\lambda\\gamma^2 $$\n因此，峰值角频率为 $\\omega_{\\mathrm{peak}} = \\sqrt{z_{\\mathrm{peak}}} = \\gamma\\sqrt{\\lambda}$。\n\n峰值增益的平方，$G_{\\mathrm{peak}}^2$，是 $|H(\\mathrm{i}\\omega_{\\mathrm{peak}})|^2 = f(z_{\\mathrm{peak}})$：\n$$ G_{\\mathrm{peak}}^2 = \\frac{\\alpha^2 (\\lambda\\gamma^2)}{(\\lambda\\gamma^2+\\gamma^2)(\\lambda\\gamma^2+\\lambda^2\\gamma^2)} = \\frac{\\alpha^2 \\lambda\\gamma^2}{\\gamma^2(1+\\lambda) \\cdot \\lambda\\gamma^2(1+\\lambda)} = \\frac{\\alpha^2}{\\gamma^2(1+\\lambda)^2} $$\n因此，峰值增益为：\n$$ G_{\\mathrm{peak}} = \\frac{\\alpha}{\\gamma(1+\\lambda)} $$\n\n半功率点 $\\omega_1, \\omega_2$ 是满足 $|H(\\mathrm{i}\\omega)|^2 = \\frac{1}{2} G_{\\mathrm{peak}}^2$ 的频率。令 $z=\\omega^2$。相应的 $z_1, z_2$ 的方程是：\n$$ \\frac{\\alpha^2 z}{(z+\\gamma^2)(z+\\lambda^2\\gamma^2)} = \\frac{1}{2} \\frac{\\alpha^2}{\\gamma^2(1+\\lambda)^2} $$\n$$ 2\\gamma^2(1+\\lambda)^2 z = (z+\\gamma^2)(z+\\lambda^2\\gamma^2) = z^2 + \\gamma^2(1+\\lambda^2)z + \\lambda^2\\gamma^4 $$\n整理后得到一个关于 $z$ 的二次方程：\n$$ z^2 + [\\gamma^2(1+\\lambda^2) - 2\\gamma^2(1+\\lambda)^2]z + \\lambda^2\\gamma^4 = 0 $$\n$$ z^2 - \\gamma^2(1+4\\lambda+\\lambda^2)z + \\lambda^2\\gamma^4 = 0 $$\n设根为 $z_1 = \\omega_1^2$ 和 $z_2 = \\omega_2^2$。根据韦达定理，根的和与积为：\n$$ z_1 + z_2 = \\gamma^2(1+4\\lambda+\\lambda^2) $$\n$$ z_1 z_2 = \\lambda^2\\gamma^4 $$\n线性带宽为 $\\mathrm{BW} = \\omega_2-\\omega_1 = \\sqrt{z_2}-\\sqrt{z_1}$（假设 $\\omega_2>\\omega_1$）。我们可以计算它的平方：\n$$ \\mathrm{BW}^2 = (\\sqrt{z_2}-\\sqrt{z_1})^2 = z_1 + z_2 - 2\\sqrt{z_1 z_2} $$\n代入根的和与积：\n$$ \\mathrm{BW}^2 = \\gamma^2(1+4\\lambda+\\lambda^2) - 2\\sqrt{\\lambda^2\\gamma^4} = \\gamma^2(1+4\\lambda+\\lambda^2) - 2\\lambda\\gamma^2 $$\n$$ \\mathrm{BW}^2 = \\gamma^2(1+2\\lambda+\\lambda^2) = \\gamma^2(1+\\lambda)^2 $$\n带宽为 $\\mathrm{BW} = \\gamma(1+\\lambda)$。\n\n我们现在分析在保持其他参数固定的情况下增加 $\\gamma$ 的影响。\n- 峰值增益为 $G_{\\mathrm{peak}} = \\frac{\\alpha}{\\gamma(1+\\lambda)}$。增加 $\\gamma$ 会导致 $G_{\\mathrm{peak}}$ 减小。\n- 带宽为 $\\mathrm{BW} = \\gamma(1+\\lambda)$。增加 $\\gamma$ 会导致 $\\mathrm{BW}$ 增大。\n这展示了一个基本的增益-带宽权衡。\n\n最后，我们计算乘积 $\\mathrm{BW} \\times G_{\\mathrm{peak}}$：\n$$ \\mathrm{BW} \\times G_{\\mathrm{peak}} = \\left(\\gamma(1+\\lambda)\\right) \\times \\left(\\frac{\\alpha}{\\gamma(1+\\lambda)}\\right) = \\alpha $$\n问题将 $K$ 定义为“滤波器微分支路的总体小信号高频增益，它在 $H(s)$ 中表现为分子常数”。推导出的传递函数是 $H(s) = \\frac{\\alpha s}{(s+\\gamma)(s+\\lambda\\gamma)}$。分子是 $\\alpha s$。“分子常数”明确是 $\\alpha$。关于“高频增益”的描述性子句与 $sH(s)$ 的行为一致，其在 $s \\to \\infty$ 时的极限是 $\\alpha$。因此，我们确定 $K = \\alpha$。\n因此，乘积 $\\mathrm{BW} \\times G_{\\mathrm{peak}}$ 等于 $K$。问题要求用 $K$ 和 $\\lambda$ 来表示结果。结果并不显式地依赖于 $\\lambda$，这可以被解释为对推导过程对无关信息鲁棒性的一种检验。\n\n该乘积的最终表达式就是 $K$。", "answer": "$$\\boxed{K}$$", "id": "2715227"}, {"introduction": "理论分析为我们提供了深刻的洞见，而数值计算则是将理论应用于实践并分析复杂系统的关键桥梁。本练习旨在让您亲手实现一个基因带通滤波器的频率响应分析，从编写代码计算传递函数在不同频率下的增益，到识别峰值频率和半功率截止频率。这项实践不仅能巩固您对滤波器动态特性的理解，还将为您装备上在合成生物学研究中进行线路仿真与表征的实用技能。 [@problem_id:2715289]", "problem": "给定一个遗传网络的小信号线性化模型，该网络实现了一个自适应非相干前馈模体，对输入诱导剂浓度的小扰动起带通滤波器作用。推导应从以下基本原理出发：生化反应网络在稳定稳态附近可通过线性常微分方程（ODE）来近似，这些方程是通过对质量作用动力学或希尔型动力学进行小信号线性化得到的；线性时不变（LTI）系统的频率响应可以通过应用拉普拉斯变换并在虚轴上计算所得传递函数来获得。该模型包含两个内部状态，在小信号极限下，其生成和降解为一阶过程；输出定义为两个内生物种的差值，以编码非相干前馈作用。具体来说，令 $u(t)$ 表示小信号输入，$x(t)$ 和 $z(t)$ 表示内部小信号状态（例如，转录因子活性），$y(t)$ 表示小信号输出（例如，线性单位下的报告荧光）。线性化动力学方程为\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\n其中 $\\alpha > 0$ 和 $\\gamma > 0$ 是有效的一阶降解或稀释速率（单位为 $\\mathrm{s}^{-1}$），$\\beta > 0$ 和 $\\delta \\ge 0$ 是有效的生成增益（单位经选择以使 $y$ 在小信号归一化下是无量纲的）。当两条非相干路径的稳态增益相平衡时，会发生零频率下的完美自适应，这对应于一个参数条件，您应在推导过程中找到该条件。您的任务是通过首先使用第一性原理（对ODE进行拉普拉斯变换，求解输出与输入之比的线性代数解）推导从 $u$ 到 $y$ 的传递函数 $G(s)$，然后在一个覆盖三个数量级的对数角频率网格上数值计算 $|G(j\\omega)|$，从而计算该LTI系统的频率响应幅值。\n\n对于测试套件中提供的每组参数，执行以下操作：\n- 从给定的ODE推导出传递函数 $G(s)$，不使用任何预先记忆的滤波器公式，并将 $|G(j\\omega)|$ 写成 $\\omega$、$\\alpha$、$\\beta$、$\\gamma$ 和 $\\delta$ 的函数。\n- 为了进行数值计算，定义一个估计的中心频率 $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha\\,\\gamma}$（单位为 $\\mathrm{s}^{-1}$）。通过选择\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}} \\sqrt{1000},\n$$\n构建一个包含 $N = 121$ 个角频率 $\\omega_k$ 的对数间隔网格，该网格以 $\\omega_0^{\\mathrm{est}}$ 为中心，精确跨越三个数量级，并在 $\\log_{10}\\omega_{\\min}$ 和 $\\log_{10}\\omega_{\\max}$ 之间对 $\\log_{10} \\omega$ 进行均匀采样 $N$ 个点。\n- 在每个网格点上计算 $|G(j\\omega_k)|$。\n- 识别峰值幅值 $|G|_{\\max}$ 和出现峰值时的相应频率 $\\omega_0$（如果峰值落在网格点之间，则使用最大幅值所在的网格点；无需进行亚网格优化）。\n- 定义半功率幅值阈值 $|G|_{\\mathrm{hp}} = |G|_{\\max} / \\sqrt{2}$。将下截止频率 $\\omega_L$ 和上截止频率 $\\omega_H$ 分别确定为在 $\\omega_0$ 左侧和右侧，其中 $|G(j\\omega)|$ 穿过 $|G|_{\\mathrm{hp}}$ 的频率。在每侧跨越阈值的两个最近采样点之间，使用 $\\log_{10}\\omega$ 对 $\\ln |G|$ 进行线性插值来估计 $\\omega_L$ 和 $\\omega_H$。如果一个截止频率超出了采样范围，则将该情况视为不适定的；但是，所提供的测试套件避免了此类情况。\n- 所有频率均以 $\\mathrm{s}^{-1}$ 表示，四舍五入到六位小数。\n\n测试套件（每种情况以 $(\\alpha, \\gamma, \\beta, \\delta)$ 给出，单位均为 $\\mathrm{s}^{-1}$）：\n1. （情况A）$(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$。\n2. （情况B）$(\\alpha, \\gamma, \\beta, \\delta) = (0.1, 0.1, 1.0, 0.1)$。\n3. （情况C）$(\\alpha, \\gamma, \\beta, \\delta) = (0.005, 0.5, 2.0, 0.5)$。\n4. （情况D）非完美自适应：$(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.198)$。\n\n您的程序必须使用上述步骤，为每个测试用例计算三元组 $[\\omega_L, \\omega_0, \\omega_H]$（单位为 $\\mathrm{s}^{-1}$），每个值四舍五入到六位小数。您的程序应生成一行输出，其中包含按测试套件顺序排列的结果，格式为逗号分隔的Python风格的列表的列表，例如：\n[[wL_A,w0_A,wH_A],[wL_B,w0_B,wH_B],[wL_C,w0_C,wH_C],[wL_D,w0_D,wH_D]]\n不应打印任何额外文本。", "solution": "我们从以下原理出发：在稳定稳态附近，由质量作用动力学或饱和希尔动力学控制的生化反应网络，可以通过描述小信号偏差的线性常微分方程（ODE）来近似。对于线性时不变（LTI）系统，频率响应由传递函数 $G(s)$ 捕获，该函数是输出与输入的拉普拉斯域比率，在 $s = j\\omega$ 处进行求值以进行正弦稳态分析。此方法基于线性系统理论以及拉普拉斯变换对稳定线性ODE的有效性。\n\n给定线性化动力学方程\n$$\n\\frac{dx}{dt} = -\\alpha\\, x + \\beta\\, u, \\quad\n\\frac{dz}{dt} = -\\gamma\\, z + \\delta\\, x, \\quad\ny = x - z,\n$$\n我们应用拉普拉斯变换（使用适用于频率响应的零初始条件）得到\n$$\ns X(s) = -\\alpha X(s) + \\beta U(s), \\quad\ns Z(s) = -\\gamma Z(s) + \\delta X(s), \\quad\nY(s) = X(s) - Z(s).\n$$\n解第一个方程得\n$$\nX(s) = \\frac{\\beta}{s + \\alpha} U(s).\n$$\n代入第二个方程得\n$$\nZ(s) = \\frac{\\delta}{s + \\gamma} X(s) = \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} U(s).\n$$\n因此，\n$$\nY(s) = X(s) - Z(s) = \\left( \\frac{\\beta}{s + \\alpha} - \\frac{\\beta \\delta}{(s + \\alpha)(s + \\gamma)} \\right) U(s) = \\frac{\\beta\\big[(s+\\gamma) - \\delta\\big]}{(s+\\alpha)(s+\\gamma)} U(s).\n$$\n所以，传递函数为\n$$\nG(s) \\equiv \\frac{Y(s)}{U(s)} = \\frac{\\beta\\big(s + \\gamma - \\delta\\big)}{(s + \\alpha)(s + \\gamma)}.\n$$\n由此得出两个关键事实：\n- 零频（稳态）增益为 $G(0) = \\dfrac{\\beta(\\gamma - \\delta)}{\\alpha \\gamma}$，在完美自适应条件 $\\delta = \\gamma$ 下为零，从而在低频处呈现高通特性。\n- 位于 $s = -\\alpha$ 和 $s = -\\gamma$ 的极点在高频处定义了双极点低通行为。结合 $\\delta = \\gamma$ 条件下的低频零点，这形成了带通响应。当 $\\delta$ 接近（但不等于）$\\gamma$ 时，这种定性的带通行为仍然存在，尽管低频增益为有限值。\n\n为了计算幅值响应，在 $s = j\\omega$ 处求值：\n$$\nG(j\\omega) = \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)}.\n$$\n幅值为\n$$\n\\left|G(j\\omega)\\right| = \\left| \\frac{\\beta\\big(j\\omega + \\gamma - \\delta\\big)}{(j\\omega + \\alpha)(j\\omega + \\gamma)} \\right|.\n$$\n对于完美自适应情况 $\\delta = \\gamma$，上式简化为\n$$\n\\left|G(j\\omega)\\right| = \\frac{\\beta \\omega}{\\sqrt{(\\omega^2 + \\alpha^2)(\\omega^2 + \\gamma^2)}}.\n$$\n然而，为了保持通用性，我们将在数值算法中使用未简化的表达式。\n\n数值算法设计：\n1. 对于每组参数 $(\\alpha, \\gamma, \\beta, \\delta)$，基于极点速率的几何平均值定义一个估计的中心频率 $\\omega_0^{\\mathrm{est}} = \\sqrt{\\alpha \\gamma}$。这样做的动机是观察到许多具有分离一阶过程的二阶带通系统，其峰值幅值出现在其主导速率的几何平均值附近。\n2. 通过取\n$$\n\\omega_{\\min} = \\frac{\\omega_0^{\\mathrm{est}}}{\\sqrt{1000}}, \\quad\n\\omega_{\\max} = \\omega_0^{\\mathrm{est}}\\sqrt{1000},\n$$\n构建一个包含 $N = 121$ 个点的对数网格，该网格以 $\\omega_0^{\\mathrm{est}}$ 为中心，精确跨越三个数量级，并在这些边界之间对 $\\log_{10}\\omega$ 进行均匀采样。这种对称的对数跨度确保了对各种 $(\\alpha,\\gamma)$ 值的预期峰值周围的覆盖。\n3. 使用精确的复数表达式在网格上计算 $\\left|G(j\\omega_k)\\right|$。通过取具有最大幅值的网格点来识别离散峰值幅值及其频率 $\\omega_0$。\n4. 计算半功率阈值 $|G|_{\\mathrm{hp}} = |G|_{\\max}/\\sqrt{2}$。为了确定下截止频率 $\\omega_L$，在峰值左侧找到连续的网格索引 $(k,k+1)$，使得 $\\left|G(j\\omega_k)\\right| \\le |G|_{\\mathrm{hp}}$ 且 $\\left|G(j\\omega_{k+1})\\right| \\ge |G|_{\\mathrm{hp}}$。类似地，对于上截止频率 $\\omega_H$，在峰值右侧找到连续的索引 $(k,k+1)$，其中幅值以相反方向穿过阈值。为了数值稳定性，在 $\\log_{10}\\omega$ 对 $\\ln\\left|G\\right|$ 上进行线性插值：\n   - 令 $x = \\log_{10}\\omega$ 且 $y = \\ln\\left|G\\right|$。如果阈值 $y^\\star = \\ln(|G|_{\\mathrm{hp}})$ 位于 $(x_0,y_0)$ 和 $(x_1,y_1)$ 之间，则在以下位置估计交叉点\n     $$\n     x^\\star = x_0 + (x_1 - x_0)\\frac{y^\\star - y_0}{y_1 - y_0}, \\quad \\omega^\\star = 10^{x^\\star}.\n     $$\n   这种插值方法平衡了生物滤波器响应中通常遇到的频率和幅值的宽动态范围。\n5. 将 $\\omega_L$、$\\omega_0$ 和 $\\omega_H$ 四舍五入到六位小数。所有频率单位均为 $\\mathrm{s}^{-1}$。\n\n应用于测试套件：\n- 情况A $(\\alpha, \\gamma, \\beta, \\delta) = (0.02, 0.2, 1.0, 0.2)$ 符合具有分离时间尺度的完美自适应，产生一个清晰的带通响应，峰值在 $\\omega_0 \\approx \\sqrt{0.02 \\cdot 0.2}$ 附近。\n- 情况B $(0.1, 0.1, 1.0, 0.1)$ 具有相同的速率，产生一个对称响应，峰值在 $\\omega_0 \\approx 0.1$ 附近。\n- 情况C $(0.005, 0.5, 2.0, 0.5)$ 增大了增益并拓宽了极点间距，影响了峰值幅值，但对截止位置的相对影响不大。\n- 情况D $(0.02, 0.2, 1.0, 0.198)$ 轻微扰动了完美自适应条件，引入了有限的低频增益，同时保持了一个具有可识别的 $-3\\,\\mathrm{dB}$ 截止频率的明确带通。\n\n附带的程序精确地实现了该算法，并为这四种情况输出一个包含三元组 $[\\omega_L, \\omega_0, \\omega_H]$ 的Python风格列表，按要求四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef magnitude_G(omega, alpha, gamma, beta, delta):\n    \"\"\"\n    Compute |G(j*omega)| for the linearized genetic band-pass model:\n    G(s) = beta * (s + gamma - delta) / ((s + alpha) * (s + gamma))\n    \"\"\"\n    s = 1j * omega\n    num = beta * (s + (gamma - delta))\n    den = (s + alpha) * (s + gamma)\n    G = num / den\n    return np.abs(G)\n\ndef find_cutoff_log_interp(freqs, mags, peak_index):\n    \"\"\"\n    Find omega_L and omega_H as -3 dB cutoffs around the peak magnitude.\n    Interpolate linearly in log10(freq) vs ln(mag).\n    \"\"\"\n    peak_mag = mags[peak_index]\n    target = peak_mag / np.sqrt(2.0)\n    ln_target = np.log(target)\n    logf = np.log10(freqs)\n    lnm = np.log(mags)\n\n    # Find left cutoff: increasing magnitude on the left\n    omega_L = None\n    for k in range(peak_index):\n        if mags[k] = target = mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_L = 10.0 ** x_star\n            break\n\n    # Find right cutoff: decreasing magnitude on the right\n    omega_H = None\n    n = len(freqs)\n    for k in range(peak_index, n - 1):\n        if mags[k] >= target >= mags[k + 1]:\n            x0, x1 = logf[k], logf[k + 1]\n            y0, y1 = lnm[k], lnm[k + 1]\n            if y1 == y0:\n                x_star = x0\n            else:\n                x_star = x0 + (x1 - x0) * (ln_target - y0) / (y1 - y0)\n            omega_H = 10.0 ** x_star\n            break\n\n    return omega_L, omega_H\n\ndef analyze_case(alpha, gamma, beta, delta, N=121):\n    # Estimated center frequency based on pole geometric mean\n    omega0_est = np.sqrt(alpha * gamma)\n    # Three decades total span centered on omega0_est\n    span = np.sqrt(1000.0)\n    wmin = omega0_est / span\n    wmax = omega0_est * span\n    freqs = np.logspace(np.log10(wmin), np.log10(wmax), N)\n\n    mags = magnitude_G(freqs, alpha, gamma, beta, delta)\n\n    # Identify discrete peak\n    peak_index = int(np.argmax(mags))\n    omega0 = freqs[peak_index]\n\n    # Find -3 dB cutoffs\n    omega_L, omega_H = find_cutoff_log_interp(freqs, mags, peak_index)\n\n    # Round to six decimals as required\n    def rnd(x):\n        return round(float(x), 6)\n\n    return rnd(omega_L), rnd(omega0), rnd(omega_H)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (alpha, gamma, beta, delta) in s^-1\n    test_cases = [\n        (0.02, 0.2, 1.0, 0.2),     # Case A: perfect adaptation\n        (0.1, 0.1, 1.0, 0.1),      # Case B: equal rates\n        (0.005, 0.5, 2.0, 0.5),    # Case C: wider separation, higher gain\n        (0.02, 0.2, 1.0, 0.198),   # Case D: imperfect adaptation\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha, gamma, beta, delta = case\n        wL, w0, wH = analyze_case(alpha, gamma, beta, delta, N=121)\n        results.append([wL, w0, wH])\n\n    # Final print statement in the exact required format.\n    # Python-style list of lists with comma-separated entries, single line.\n    print(str(results))\n\nsolve()\n```", "id": "2715289"}]}