{"hands_on_practices": [{"introduction": "理解一个系统何时从稳定的静态切换到振荡状态，是设计合成振荡器的一项基本技能。本练习将指导您完成对经典“压制子”（repressilator）模型的线性化和特征值分析，从而推导出发生 Hopf 分岔（Hopf bifurcation）并产生持续振荡的精确条件。[@problem_id:2781529] 这是一个核心的分析技术，可以揭示振荡出现的关键参数依赖性。", "problem": "考虑一个对称的三基因环形振荡器，其中每个基因依次抑制下一个基因，其动力学在粗粒化蛋白质水平上通过常微分方程（ODE）建模。每个节点都具有基础一阶降解和遵循从标准基因调控现象学推导出的Hill抑制函数的受调控生产。具体来说，令 $x_{1}(t)$、$x_{2}(t)$ 和 $x_{3}(t)$ 表示三个节点的蛋白质浓度，并假设\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -\\gamma x_{1} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{3}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{2}}{d t} \\;=\\; -\\gamma x_{2} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{1}}{K} \\right)^{n}},\\qquad\n\\frac{d x_{3}}{d t} \\;=\\; -\\gamma x_{3} \\;+\\; \\frac{\\alpha}{1 + \\left( \\frac{x_{2}}{K} \\right)^{n}},\n$$\n其中 $\\alpha>0$ 是最大生产速率，$\\gamma>0$ 是一阶降解/稀释速率， $K>0$ 是解离常数， $n>0$ 是Hill系数。假设转录和翻译延迟可忽略不计，因此该描述是恰当的。\n\n存在一个唯一的对称稳态，其中 $x_{1}^{\\ast}=x_{2}^{\\ast}=x_{3}^{\\ast}=s$ 满足 $-\\gamma s + \\alpha/(1+(s/K)^{n})=0$。从上述基本建模假设和线性化的定义出发，执行以下步骤：\n\n- 将系统在稳态 $\\left(s,s,s\\right)$ 附近线性化，并写出雅可比矩阵。\n- 利用线性系统的第一性原理和环的对称性来分析雅可比矩阵的特征值，并根据稳态抑制斜率 $f'(s)$（其中 $f(x)=\\alpha/(1+(x/K)^{n})$）推导出通过Hopf分岔产生自持振荡的解析条件。\n- 仅使用稳态条件和您推导出的起始条件来消去稳态 $s$，从而获得振荡首次出现时的临界最大生产速率 $\\alpha_{c}$ 的闭式表达式，该表达式仅用 $\\gamma$、$K$ 和 $n$ 表示。\n\n答案规格：\n- 仅以 $\\gamma$、$K$ 和 $n$ 的形式，提供 $\\alpha_{c}$ 的单个精确解析表达式作为最终结果。\n- 方框内的最终答案不应包含单位。参数 $\\alpha_{c}$ 的单位是浓度/时间。", "solution": "问题陈述具有科学依据、适定且客观。它提出了合成生物学中的一个经典模型——repressilator，并要求进行标准的稳定性分析，以找出振荡起始的条件。所有必要信息均已提供，问题没有矛盾或含糊之处。因此，我们着手进行解答。\n\n常微分方程组由下式给出：\n$$\n\\frac{d x_{1}}{d t} = -\\gamma x_{1} + f(x_{3})\n$$\n$$\n\\frac{d x_{2}}{d t} = -\\gamma x_{2} + f(x_{1})\n$$\n$$\n\\frac{d x_{3}}{d t} = -\\gamma x_{3} + f(x_{2})\n$$\n其中 $f(x) = \\frac{\\alpha}{1 + (x/K)^{n}}$。系统将在对称稳态 $\\mathbf{x}^{\\ast} = (s, s, s)$ 处进行分析。\n\n首先，我们通过计算雅可比矩阵 $J$ 来将系统在该稳态附近线性化。雅可比矩阵的元素为 $J_{ij} = \\frac{\\partial}{\\partial x_j} (\\frac{dx_i}{dt})$。\n$$\nJ =\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_1 + f(x_3))  \\frac{\\partial}{\\partial x_2}(-\\gamma x_1 + f(x_3))  \\frac{\\partial}{\\partial x_3}(-\\gamma x_1 + f(x_3)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_2 + f(x_1))  \\frac{\\partial}{\\partial x_2}(-\\gamma x_2 + f(x_1))  \\frac{\\partial}{\\partial x_3}(-\\gamma x_2 + f(x_1)) \\\\\n\\frac{\\partial}{\\partial x_1}(-\\gamma x_3 + f(x_2))  \\frac{\\partial}{\\partial x_2}(-\\gamma x_3 + f(x_2))  \\frac{\\partial}{\\partial x_3}(-\\gamma x_3 + f(x_2))\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\gamma  0  f'(x_3) \\\\\nf'(x_1)  -\\gamma  0 \\\\\n0  f'(x_2)  -\\gamma\n\\end{pmatrix}\n$$\n在稳态 $\\mathbf{x}^{\\ast} = (s, s, s)$ 处计算雅可比矩阵，我们得到：\n$$\nJ\\rvert_{\\mathbf{x}^{\\ast}} =\n\\begin{pmatrix}\n-\\gamma  0  f'(s) \\\\\nf'(s)  -\\gamma  0 \\\\\n0  f'(s)  -\\gamma\n\\end{pmatrix}\n$$\n为简化符号，令 $a = f'(s)$。雅可比矩阵是一个循环矩阵：\n$$\nJ =\n\\begin{pmatrix}\n-\\gamma  0  a \\\\\na  -\\gamma  0 \\\\\n0  a  -\\gamma\n\\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(J - \\lambda I) = 0$ 来求出 $J$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} -\\gamma - \\lambda  0  a \\\\ a  -\\gamma - \\lambda  0 \\\\ 0  a  -\\gamma - \\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到：\n$$\n(-\\gamma - \\lambda)^{3} + a^{3} = 0 \\implies (\\gamma + \\lambda)^{3} = a^{3}\n$$\n该方程的根为 $\\gamma + \\lambda = a \\cdot \\omega^{k}$，其中 $\\omega = \\exp(i 2\\pi/3)$ 是一个本原单位立方根，且 $k \\in \\{0, 1, 2\\}$。因此，特征值为：\n$$\n\\lambda_k = a \\cdot \\omega^{k} - \\gamma\n$$\n具体来说，三个特征值是：\n$$\n\\lambda_0 = a \\cdot \\omega^{0} - \\gamma = a - \\gamma\n$$\n$$\n\\lambda_1 = a \\cdot \\omega^{1} - \\gamma = a \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) + i \\frac{a\\sqrt{3}}{2}\n$$\n$$\n\\lambda_2 = a \\cdot \\omega^{2} - \\gamma = a \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) - \\gamma = \\left(-\\gamma - \\frac{a}{2}\\right) - i \\frac{a\\sqrt{3}}{2}\n$$\nHopf分岔标志着自持振荡的开始，它发生在一对共轭复特征值穿过虚轴时。这要求它们的实部变为零，而虚部保持非零。复特征值为 $\\lambda_1$ 和 $\\lambda_2$。\n对实部的条件是 $\\text{Re}(\\lambda_{1,2}) = 0$：\n$$\n-\\gamma - \\frac{a}{2} = 0 \\implies a = -2\\gamma\n$$\n虚部为 $\\text{Im}(\\lambda_{1}) = \\frac{a\\sqrt{3}}{2}$。因为 $\\gamma > 0$，所以 $a = -2\\gamma$ 非零，这意味着在分岔点虚部非零。此外，抑制函数 $f(x)$ 是单调递减的，因此其导数 $a = f'(s)$ 必须为负，这与条件 $a = -2\\gamma$ 一致。\n在此点，实特征值为 $\\lambda_0 = a - \\gamma = -2\\gamma - \\gamma = -3\\gamma$，它严格为负。因此，稳定性的改变完全由穿越虚轴的复数对决定，这证实了Hopf分岔的发生。\n\n现在我们在分岔点有两个条件：\n1. 分岔条件：$f'(s) = -2\\gamma$。\n2. 稳态条件：$\\gamma s = f(s)$。在临界点，此条件为 $\\gamma s = \\frac{\\alpha_c}{1 + (s/K)^{n}}$。\n\n让我们计算导数 $f'(s)$：\n$$\nf'(x) = \\frac{d}{dx} \\left[ \\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-1} \\right] = -\\alpha \\left(1 + \\left(\\frac{x}{K}\\right)^n\\right)^{-2} \\cdot n \\left(\\frac{x}{K}\\right)^{n-1} \\cdot \\frac{1}{K}\n$$\n$$\nf'(s) = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n现在我们使用这两个条件来消去 $s$ 并求解 $\\alpha_c$：\n$$\n-2\\gamma = -\\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2} \\implies 2\\gamma = \\frac{\\alpha_c n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n从稳态条件，我们有 $\\alpha_c = \\gamma s (1 + (s/K)^{n})$。将此代入上述方程：\n$$\n2\\gamma = \\frac{[\\gamma s (1 + (s/K)^{n})] n}{K} \\frac{(s/K)^{n-1}}{(1 + (s/K)^{n})^2}\n$$\n我们可以消去 $\\gamma$ (因为 $\\gamma > 0$)：\n$$\n2 = \\frac{s n}{K} \\frac{(s/K)^{n-1}}{1 + (s/K)^{n}} = \\frac{n (s/K)^n}{1 + (s/K)^{n}}\n$$\n令 $u = (s/K)^n$。方程变为：\n$$\n2 = \\frac{nu}{1+u} \\implies 2(1+u) = nu \\implies 2 + 2u = nu \\implies 2 = u(n-2)\n$$\n解出 $u$：\n$$\nu = \\left(\\frac{s}{K}\\right)^n = \\frac{2}{n-2}\n$$\n对于一个正稳态 $s$，我们需要 $u > 0$，这意味着该系统中振荡的熟知条件：$n > 2$。\n由此，我们求出分岔点处的稳态值：\n$$\ns = K \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\n最后，我们将 $s$ 和 $(s/K)^n$ 的表达式代回稳态方程，以求出临界生产速率 $\\alpha_c$：\n$$\n\\alpha_c = \\gamma s \\left(1 + \\left(\\frac{s}{K}\\right)^n\\right)\n$$\n我们有 $1 + (s/K)^n = 1 + \\frac{2}{n-2} = \\frac{n-2+2}{n-2} = \\frac{n}{n-2}$。\n$$\n\\alpha_c = \\gamma \\left[ K \\left(\\frac{2}{n-2}\\right)^{1/n} \\right] \\left[ \\frac{n}{n-2} \\right]\n$$\n这可以化简为用给定参数表示的 $\\alpha_c$ 的最终闭式表达式：\n$$\n\\alpha_c = \\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}\n$$\n这是最大生产速率的阈值，高于此值，稳态变得不稳定并出现自持振荡。", "answer": "$$\\boxed{\\frac{\\gamma K n}{n-2} \\left(\\frac{2}{n-2}\\right)^{1/n}}$$", "id": "2781529"}, {"introduction": "无量纲化是简化数学模型并揭示其内在标度律（scaling laws）的强大工具。本练习将该技术应用于压制子模型，旨在确定其振荡频率如何依赖于关键的生化参数。[@problem_id:2781524] 通过此分析，您将发现一个重要且可能反直觉的结论，即振荡频率在分岔点处由哪些因素决定。", "problem": "考虑一个由三个相同基因和启动子组成的三基因环形振荡器（抑制子振荡器），其中所有启动子都是通过协同结合起作用的抑制子。每个蛋白质 $X_{i}$（其中 $i \\in \\{1,2,3\\}$）抑制环中下一个基因的转录。假设存在分子生物学中心法则的标准基因表达级联（转录和翻译），以及蛋白质稀释和降解引起的一阶损失。在信使核糖核酸（mRNA）的准稳态假设下，仅含蛋白质的控制性常微分方程（ODE）为\n$$\n\\frac{dX_{1}}{dt} \\;=\\; \\frac{\\beta S}{1 + \\left(\\frac{X_{3}}{K}\\right)^{n}} \\;-\\; \\gamma X_{1}, \\qquad\n\\frac{dX_{2}}{dt} \\;=\\; \\frac{\\beta S}{1 + \\left(\\frac{X_{1}}{K}\\right)^{n}} \\;-\\; \\gamma X_{2}, \\qquad\n\\frac{dX_{3}}{dt} \\;=\\; \\frac{\\beta S}{1 + \\left(\\frac{X_{2}}{K}\\right)^{n}} \\;-\\; \\gamma X_{3}.\n$$\n此处，$t$ 是时间，$\\beta S$ 是最大蛋白质生成速率（其中 $\\beta$ 是参考翻译因子，$S$ 是一个待改变的无量纲启动子强度参数），$K$ 是抑制阈值（半最大常数），$n \\geq 1$ 是希尔系数（协同性），$\\gamma$ 是蛋白质降解/稀释速率（假设三种蛋白质均相同）。所有参数均为正常数，且所有三个节点均相同。\n\n使用无量纲分析，确定在对称稳态经由霍普夫（Hopf）分岔产生持续振荡的起始点，振荡角频率如何随启动子强度 $S$ 的变化而缩放。具体而言：\n1. 通过引入无量纲时间和无量纲蛋白质浓度，对系统进行无量纲化，并确定无量纲最大生成参数。\n2. 在对称稳态点附近对无量纲化系统进行线性化，并确定在霍普夫（Hopf）分岔点出现的无量纲时间下的小振幅振荡的角频率。\n3. 将此角频率转换回有量纲时间，并用模型参数表示为一个封闭形式的解析表达式，明确显示其对 $S$ 的依赖性。\n\n以弧度/单位时间表示最终的角频率。最终答案必须是单一的封闭形式解析表达式。无需进行数值四舍五入。", "solution": "该问题是有效的，因为它科学地基于基因调控网络和动力系统的既定理论，问题陈述清晰，且客观。我们按照指定的步骤进行求解。\n\n三基因抑制子振荡器的控制方程如下：\n$$\n\\frac{dX_{1}}{dt} = \\frac{\\beta S}{1 + \\left(\\frac{X_{3}}{K}\\right)^{n}} - \\gamma X_{1}\n$$\n$$\n\\frac{dX_{2}}{dt} = \\frac{\\beta S}{1 + \\left(\\frac{X_{1}}{K}\\right)^{n}} - \\gamma X_{2}\n$$\n$$\n\\frac{dX_{3}}{dt} = \\frac{\\beta S}{1 + \\left(\\frac{X_{2}}{K}\\right)^{n}} - \\gamma X_{3}\n$$\n其中 $X_{i}$ 是蛋白质浓度，$t$ 是时间，$\\beta, S, K, n, \\gamma$ 是正常数。\n\n1. 无量纲化\n我们引入无量纲变量来简化系统。令时间由蛋白质降解/稀释速率 $\\gamma$ 进行缩放，蛋白质浓度由抑制阈值 $K$ 进行缩放。\n令无量纲时间为 $\\tau = \\gamma t$，无量纲浓度为 $x_{i} = \\frac{X_{i}}{K}$（$i \\in \\{1, 2, 3\\}$）。\n使用链式法则，我们可以用新变量表示 $X_{i}$ 的时间导数：\n$$\n\\frac{dX_{i}}{dt} = \\frac{d(K x_{i})}{d\\tau} \\frac{d\\tau}{dt} = K \\frac{dx_{i}}{d\\tau} \\gamma = K\\gamma \\frac{dx_{i}}{d\\tau}\n$$\n将这些代入第一个 ODE（其他方程依对称性可得）：\n$$\nK\\gamma \\frac{dx_{1}}{d\\tau} = \\frac{\\beta S}{1 + x_{3}^{n}} - \\gamma (Kx_{1})\n$$\n将整个方程除以 $K\\gamma$：\n$$\n\\frac{dx_{1}}{d\\tau} = \\frac{\\beta S}{K\\gamma} \\frac{1}{1 + x_{3}^{n}} - x_{1}\n$$\n我们确定无量纲最大生成参数，记为 $\\alpha$：\n$$\n\\alpha = \\frac{\\beta S}{K\\gamma}\n$$\n完整的无量纲化系统，使用循环索引（其中 $x_{0} \\equiv x_{3}$）为：\n$$\n\\frac{dx_{i}}{d\\tau} = \\frac{\\alpha}{1 + x_{i-1}^{n}} - x_{i}, \\quad i \\in \\{1, 2, 3\\}\n$$\n\n2. 线性化与霍普夫（Hopf）分岔分析\n首先，我们找到系统的对称稳态，其中 $x_{1} = x_{2} = x_{3} = x^{*}$。在此状态下，所有时间导数均为零：\n$$\n0 = \\frac{\\alpha}{1 + (x^{*})^{n}} - x^{*} \\implies x^{*}\\left(1 + (x^{*})^{n}\\right) = \\alpha\n$$\n这是一个关于稳态浓度 $x^{*}$ 的隐式方程，它是参数 $\\alpha$ 和 $n$ 的函数。\n\n接下来，我们围绕这个稳态对系统进行线性化。设状态向量为 $\\mathbf{x} = [x_{1}, x_{2}, x_{3}]^{T}$，系统为 $\\frac{d\\mathbf{x}}{d\\tau} = \\mathbf{F}(\\mathbf{x})$。雅可比矩阵 $J$ 的元素为 $J_{ij} = \\frac{\\partial F_{i}}{\\partial x_{j}}$，在稳态 $\\mathbf{x}^{*} = [x^{*}, x^{*}, x^{*}]^{T}$ 处求值。\n$\\mathbf{F}(\\mathbf{x})$ 的分量为：\n$$\nF_{1}(\\mathbf{x}) = \\frac{\\alpha}{1 + x_{3}^{n}} - x_{1}, \\quad F_{2}(\\mathbf{x}) = \\frac{\\alpha}{1 + x_{1}^{n}} - x_{2}, \\quad F_{3}(\\mathbf{x}) = \\frac{\\alpha}{1 + x_{2}^{n}} - x_{3}\n$$\n在稳态处求值的偏导数为：\n$J_{11} = \\frac{\\partial F_{1}}{\\partial x_{1}} \\bigg|_{\\mathbf{x}^{*}} = -1$\n$J_{12} = \\frac{\\partial F_{1}}{\\partial x_{2}} \\bigg|_{\\mathbf{x}^{*}} = 0$\n$J_{13} = \\frac{\\partial F_{1}}{\\partial x_{3}} \\bigg|_{\\mathbf{x}^{*}} = -\\frac{\\alpha n (x^{*})^{n-1}}{(1 + (x^{*})^{n})^{2}}$\n通过代入稳态条件 $\\alpha = x^{*}(1 + (x^{*})^{n})$，此导数简化为：\n$J_{13} = -\\frac{x^{*}(1 + (x^{*})^{n}) n (x^{*})^{n-1}}{(1 + (x^{*})^{n})^{2}} = -\\frac{n (x^{*})^{n}}{1 + (x^{*})^{n}}$。我们将此项记为 $c$。\n由于系统的循环对称性，雅可比矩阵为：\n$$\nJ =\n\\begin{pmatrix}\n-1  0  c \\\\\nc  -1  0 \\\\\n0  c  -1\n\\end{pmatrix}\n$$\n为了找到稳态的稳定性，我们从特征方程 $\\det(J - \\lambda I) = 0$ 计算 $J$ 的特征值 $\\lambda$：\n$$\n\\det\n\\begin{pmatrix}\n-1-\\lambda  0  c \\\\\nc  -1-\\lambda  0 \\\\\n0  c  -1-\\lambda\n\\end{pmatrix}\n= (-1-\\lambda)((-1-\\lambda)^2 - 0) + c(c^2 - 0) = -(1+\\lambda)^{3} + c^{3} = 0\n$$\n这得出 $(1+\\lambda)^{3} = c^{3}$。$(1+\\lambda)$ 的解是 $c^{3}$ 的三个立方根，即 $c$、$c \\exp(i\\frac{2\\pi}{3})$ 和 $c \\exp(i\\frac{4\\pi}{3})$。因此，特征值 $\\lambda$ 为：\n$$\n\\lambda_{1} = c - 1\n$$\n$$\n\\lambda_{2} = c \\exp(i\\frac{2\\pi}{3}) - 1 = c\\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) - 1 = -\\left(1 + \\frac{c}{2}\\right) + i \\frac{c\\sqrt{3}}{2}\n$$\n$$\n\\lambda_{3} = c \\exp(i\\frac{4\\pi}{3}) - 1 = c\\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) - 1 = -\\left(1 + \\frac{c}{2}\\right) - i \\frac{c\\sqrt{3}}{2}\n$$\n当一对共轭复特征值穿过虚轴时，发生霍普夫（Hopf）分岔。这发生在它们的实部为零时：\n$$\n\\text{Re}(\\lambda_{2,3}) = -\\left(1 + \\frac{c}{2}\\right) = 0 \\implies c = -2\n$$\n$c = -2$ 这个值定义了振荡开始的条件。在此分岔点，特征值的虚部非零，从而给出新生振荡在无量纲时间 $\\tau$ 下的角频率：\n$$\n\\omega_{\\tau} = |\\text{Im}(\\lambda_{2,3})| = \\left|\\pm i \\frac{(-2)\\sqrt{3}}{2}\\right| = | \\mp i\\sqrt{3}| = \\sqrt{3}\n$$\n这个无量纲角频率 $\\omega_{\\tau} = \\sqrt{3}$ 在分岔点是一个常数，完全由网络的3节点环形拓扑结构决定。\n\n3. 有量纲角频率及对 $S$ 的依赖性\n最后，我们将无量纲角频率 $\\omega_{\\tau}$ 转换回有量纲角频率 $\\omega$。无量纲时间下的振荡函数形式为 $\\cos(\\omega_{\\tau}\\tau)$。我们代入无量纲时间的定义 $\\tau = \\gamma t$：\n$$\n\\cos(\\omega_{\\tau}\\tau) = \\cos(\\omega_{\\tau}(\\gamma t)) = \\cos((\\omega_{\\tau}\\gamma)t)\n$$\n根据定义，有量纲角频率 $\\omega$ 是余弦函数参数中 $t$ 的系数。因此：\n$$\n\\omega = \\omega_{\\tau} \\gamma\n$$\n代入我们在霍普夫（Hopf）分岔点找到的值 $\\omega_{\\tau} = \\sqrt{3}$：\n$$\n\\omega = \\gamma \\sqrt{3}\n$$\n这个表达式给出了振荡起始点的角频率。问题询问此频率如何随启动子强度 $S$ 缩放。我们的结果表明，分岔点的角频率仅由蛋白质降解/稀释速率 $\\gamma$ 决定。它与启动子强度 $S$、抑制阈值 $K$、希尔系数 $n$ 和翻译因子 $\\beta$ 无关。\n启动子强度 $S$（以及组合在 $\\alpha$ 中的其他参数）的作用是作为分岔参数。要观察到振荡，$S$ 必须被调节到一个临界值 $S_{c}$，使得 $\\alpha$ 达到满足条件 $c=-2$ 的临界值 $\\alpha_{c}$。对于任意一组参数 $\\{n,K,\\beta,\\gamma\\}$（其中 $n>2$），都存在这样一个临界强度 $S_{c}$。问题要求的是恰好*在这个起始点*的频率，而这个频率是我们推导出的常数值。因此，该频率随 $S$ 的零次幂缩放，即它不依赖于 $S$。", "answer": "$$ \\boxed{\\gamma \\sqrt{3}} $$", "id": "2781524"}, {"introduction": "对于更复杂的基因回路，纯粹的解析方法往往受到限制，此时计算模拟成为必不可少的探索工具。本练习将带领您从解析转向计算，要求您为一个耦合了正负反馈的复杂振荡器编写数值模拟程序。[@problem_id:2781485] 您将通过实施一个具体的分类协议，来系统地探索包括稳态、振荡和双稳态在内的多种动力学行为，并绘制出系统的“相图”。", "problem": "一个耦合环路遗传振荡器可以通过两个基因产物——一个激活物和一个阻遏物——来建模，它们的浓度根据常微分方程（ODE；Ordinary Differential Equation）演化。从质量平衡和带有 Hill 型非线性（一种经过充分检验的经验描述）的转录调控出发，我们考虑以下关于激活物浓度 $x(t)$ 和阻遏物浓度 $y(t)$ 的无量纲模型：\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\n第一个方程的右侧捕捉了一个正反馈环路（激活物自激活，Hill 系数为 $n$），该环路乘以一个负反馈环路（$y$ 的阻遏作用，Hill 系数为 $m$，可调强度为 $R$）。第二个方程的右侧捕捉了 $x$ 对阻遏物的激活作用，其协同性为 $p$。所有参数均为非负。固定以下参数：\n- $n = 3$, $m = 2$, $p = 2$,\n- $K_x = 1$, $K_y = 1$, $K_{xy} = 1$,\n- $k_x = 1$, $k_y = 1$,\n- $d_x = 1$, $d_y = 0.2$,\n- $\\alpha_0 = 0.01$,\n并将 $(\\alpha, R)$ 视为两个控制参数。\n\n您的任务是编写一个完整的、可运行的程序，对于一组给定的 $(\\alpha, R)$ 对，确定其长期动力学行为是稳态（单一吸引子不动点）、持续振荡（极限环），还是双稳态（从不同初始条件达到的两个不同的稳定不动点）。您必须仅使用数值模拟和信号分析来实现分类，从上述 ODE 和以下基于动力系统的定义开始：\n\n- 如果在瞬态过程后，$x(t)$ 和 $y(t)$ 的波动相对振幅较小，并且瞬时导数的范数较小，则认为轨迹是稳定的。\n- 如果在瞬态过程后，轨迹表现出具有足够大相对振幅且包含多个峰值的持续、非衰减的振荡，则认为轨迹是振荡的。\n- 如果两个不同的初始条件都产生非振荡轨迹，并趋向于不同的稳定水平，则认为参数对 $(\\alpha, R)$ 是双稳态的。\n\n请实现以下具体的数值协议，该协议精确地定义了分类方法：\n- 对于每个 $(\\alpha, R)$ 对，从两个初始条件 $z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ 和 $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$ 对 ODE 进行积分，时间区间为 $t \\in [0, T]$，其中 $T = 300$。在该区间内以 $N = 4000$ 个均匀间隔的时间点采样解。\n- 丢弃每个时间序列的前 $60\\%$ 作为瞬态。在剩下的 $40\\%$ 中：\n  - 设 $\\bar{x}$ 为 $x(t)$ 的均值，定义相对振幅 $A_x = \\dfrac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$；对 $y(t)$ 类似地定义 $A_y$。\n  - 计算 $x(t)$ 中局部最大值（峰值）的数量：如果 $x_{i-1}  x_i > x_{i+1}$，则样本 $x_i$ 是一个峰值。\n  - 如果 $A_x \\ge 0.15$ 且分析窗口中 $x(t)$ 的峰值数量至少为 $3$，则单个轨迹被分类为振荡。\n  - 如果 $A_x  0.05$ 且 $A_y  0.05$ 且 $\\|\\left.\\frac{d}{dt}(x,y)\\right|_{t=T}\\|_2  10^{-5}$，则单个轨迹被分类为稳定。\n- 结合两个初始条件的结果，对 $(\\alpha, R)$ 进行最终分类：\n  - 如果两条轨迹都是稳定的，并且它们最后阶段的均值在 $x$ 或 $y$ 上相差至少 $0.2$，则分类为双稳态。\n  - 否则，如果至少有一条轨迹是振荡的，则分类为振荡。\n  - 否则，分类为稳定。\n\n为了与分岔理论联系起来，将稳态、振荡和双稳态的区域解释为被局部稳定性通过典范分岔发生变化的曲线所分隔。特别地，在 $(\\alpha,R)$ 平面中，唯一稳定平衡点让位于振荡的边界预计与 Hopf 分岔相关，而一个稳定平衡点变为两个的边界与鞍结分岔相关。平面中这些分岔曲线相交的点是余维-2点，在二维系统中，当满足适当的非退化条件时，这些点可以包括 Bogdanov–Takens 点。\n\n实现该模型和上述分类协议，并将其应用于以下 $(\\alpha, R)$ 对的测试套件：\n- $(\\alpha, R) = (1.5, 2)$,\n- $(\\alpha, R) = (3.5, 20)$,\n- $(\\alpha, R) = (7.0, 1.0)$,\n- $(\\alpha, R) = (5.0, 30)$,\n- $(\\alpha, R) = (8.0, 0.2)$.\n\n每个测试用例所需的输出是一个整数代码：\n- $0$ 代表稳态，\n- $1$ 代表振荡，\n- $2$ 代表双稳态。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[0,1,2,1,2]$）。不使用物理单位；所有量都是无量纲的。不涉及角度。本问题中的所有数值阈值和常数都是精确的，必须按规定实现。", "solution": "所呈现的问题是一项计算任务，要求对一个给定的常微分方程（ODE）系统进行动力学行为分类，该系统模拟一个合成遗传振荡器。问题陈述是有效的，因为它具有科学依据、问题明确、规定完整且客观。它为此分类提供了一个精确的数值协议，必须无偏差地实现。我的任务是执行这个协议。除了实现所需的内容外，我不会进行理论推测。\n\n该模型描述了激活物蛋白浓度 $x(t)$ 和阻遏物蛋白浓度 $y(t)$ 的时间演化。其动力学由以下无量纲 ODE 系统给出：\n$$\n\\frac{dx}{dt} \\;=\\; k_x\\left[\\alpha_0 + \\alpha\\,\\frac{x^n}{K_x^n + x^n}\\right]\\cdot\\frac{1}{1 + R\\left(\\frac{y}{K_y}\\right)^m} \\;-\\; d_x\\,x,\n$$\n$$\n\\frac{dy}{dt} \\;=\\; k_y\\,\\frac{x^p}{K_{xy}^p + x^p} \\;-\\; d_y\\,y.\n$$\n问题提供了一组固定参数：Hill 系数 $n=3$，$m=2$，$p=2$；解离常数 $K_x=1$，$K_y=1$，$K_{xy}=1$；合成速率 $k_x=1$，$k_y=1$；降解速率 $d_x=1$，$d_y=0.2$；以及基础激活物表达速率 $\\alpha_0=0.01$。参数 $(\\alpha, R)$ 是待变化的控制参数。\n\n任务的核心是实现一个基于数值积分的分类算法。对于每个给定的控制参数对 $(\\alpha, R)$，我们执行以下步骤：\n\n1.  **数值积分**：我们在时间区间 $t \\in [0, T]$（其中 $T=300$）上求解该 ODE 系统。我们必须在 $N=4000$ 个均匀间隔的时间点上生成解。对于每个 $(\\alpha, R)$ 对，此过程执行两次，分别从两个不同的初始条件开始：$z_1(0) = (x_0^{(1)}, y_0^{(1)}) = (10^{-2}, 10^{-2})$ 和 $z_2(0) = (x_0^{(2)}, y_0^{(2)}) = (5, 5)$。这需要一个数值 ODE 求解器，SciPy 库中的 `solve_ivp` 函数非常适合此目的。\n\n2.  **轨迹分析**：对于计算出的两条轨迹中的每一条，我们分析其长期行为。协议规定，时间序列数据的前 $60\\%$ 作为瞬态被丢弃。分析在数据的最后 $40\\%$（从 $t=180$ 到 $t=300$）上进行。\n    在此分析窗口内，我们为每条轨迹计算几个指标：\n    - 平均浓度 $\\bar{x}$ 和 $\\bar{y}$。\n    - 振荡的相对振幅，定义为 $A_x = \\frac{\\max(x) - \\min(x)}{\\max(10^{-8}, \\bar{x})}$ 和 $A_y = \\frac{\\max(y) - \\min(y)}{\\max(10^{-8}, \\bar{y})}$。分母经过正则化以防止除以零。\n    - $x(t)$ 时间序列中局部最大值（峰值）的数量。在时间 $t_i$ 的点 $x_i$ 如果其值大于其直接相邻点，即 $x_{i-1}  x_i > x_{i+1}$，则为一个峰值。\n    - 在最后时间点 $t=T=300$ 处计算的时间导数向量的欧几里得范数 $\\left\\|\\frac{d}{dt}(x,y)\\right\\|_2$。\n\n3.  **单条轨迹分类**：基于这些指标，对每条轨迹进行初步分类。\n    - 如果其相对振幅 $A_x$ 至少为 $0.15$ 且 $x(t)$ 在分析窗口内的峰值数量至少为 $3$，则该轨迹被视为**振荡**。\n    - 如果 $A_x  0.05$，$A_y  0.05$，且最终时间导数的范数小于 $10^{-5}$，则该轨迹被视为**稳定**。\n    请注意，如果不满足这些严格标准，轨迹可能既不被分类为振荡也不被分类为稳定。\n\n4.  **最终系统分类**：根据以下有序逻辑，结合两个初始条件的结果，确定参数对 $(\\alpha, R)$ 的最终分类：\n    - 如果两条轨迹都被分类为稳定，并且它们的分析窗口的均值差异显著，则系统被分类为**双稳态**（代码 $2$）。显著差异的条件是 $|\\bar{x}_1 - \\bar{x}_2| \\ge 0.2$ 或 $|\\bar{y}_1 - \\bar{y}_2| \\ge 0.2$。\n    - 如果不满足双稳态条件，则如果两条轨迹中至少有一条被分类为振荡，则系统被分类为**振荡**（代码 $1$）。\n    - 否则，系统被分类为**稳定**（代码 $0$）。\n\n这个严格的多步骤协议将“稳态”、“振荡”和“双稳态”等定性概念转化为一个具体的、确定性的算法。实现将对每个指定的测试用例精确地遵循此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the synthetic oscillator classification problem by implementing the\n    specified numerical protocol.\n    \"\"\"\n\n    # --- Fixed model parameters ---\n    n = 3.0\n    m = 2.0\n    p = 2.0\n    K_x = 1.0\n    K_y = 1.0\n    K_xy = 1.0\n    k_x = 1.0\n    k_y = 1.0\n    d_x = 1.0\n    d_y = 0.2\n    alpha_0 = 0.01\n\n    def ode_system(t, z, alpha, R):\n        \"\"\"\n        Defines the system of ordinary differential equations for the synthetic oscillator.\n        z = [x, y], where x is activator and y is repressor concentration.\n        \"\"\"\n        x, y = z\n        \n        # Avoid division by zero or negative concentrations, though solver should handle it\n        x = max(0, x)\n        y = max(0, y)\n\n        # Activator equation\n        positive_feedback = alpha * (x**n) / (K_x**n + x**n)\n        repression = 1.0 / (1.0 + R * (y / K_y)**m)\n        dxdt = k_x * (alpha_0 + positive_feedback) * repression - d_x * x\n\n        # Repressor equation\n        activation_of_repressor = k_y * (x**p) / (K_xy**p + x**p)\n        dydt = activation_of_repressor - d_y * y\n\n        return [dxdt, dydt]\n\n    def analyze_trajectory(t, z, alpha, R):\n        \"\"\"\n        Analyzes a single trajectory according to the problem's protocol.\n        \"\"\"\n        x, y = z\n        N = len(t)\n        \n        # Define the analysis window (last 40% of the data)\n        analysis_start_index = int(0.6 * N)\n        x_analysis = x[analysis_start_index:]\n        y_analysis = y[analysis_start_index:]\n        \n        # --- Calculate metrics for classification ---\n\n        # 1. Relative amplitudes\n        mean_x = np.mean(x_analysis)\n        mean_y = np.mean(y_analysis)\n        \n        # Denominator regularized as per problem statement\n        ax_denom = np.max([1e-8, mean_x])\n        ay_denom = np.max([1e-8, mean_y])\n        \n        A_x = (np.max(x_analysis) - np.min(x_analysis)) / ax_denom\n        A_y = (np.max(y_analysis) - np.min(y_analysis)) / ay_denom\n        \n        # 2. Number of peaks in x(t)\n        # A peak is x_i where x_{i-1}  x_i > x_{i+1}\n        peaks = np.sum((x_analysis[1:-1] > x_analysis[:-2])  (x_analysis[1:-1] > x_analysis[2:]))\n\n        # 3. Norm of the derivative at the final time point\n        z_final = z[:, -1]\n        dzdt_final = ode_system(t[-1], z_final, alpha, R)\n        norm_deriv = np.linalg.norm(dzdt_final)\n        \n        # --- Classify the single trajectory ---\n        is_oscillatory = (A_x >= 0.15 and peaks >= 3)\n        is_steady = (A_x  0.05 and A_y  0.05 and norm_deriv  1e-5)\n        \n        return is_oscillatory, is_steady, mean_x, mean_y\n\n    # --- Simulation setup ---\n    T = 300.0\n    N = 4000\n    t_span = [0, T]\n    t_eval = np.linspace(t_span[0], t_span[1], N)\n    \n    # Initial conditions\n    z0_1 = [1e-2, 1e-2]\n    z0_2 = [5.0, 5.0]\n\n    # Test cases from the problem statement\n    test_cases = [\n        (1.5, 2),\n        (3.5, 20),\n        (7.0, 1.0),\n        (5.0, 30),\n        (8.0, 0.2),\n    ]\n\n    results = []\n\n    # --- Main loop to process each test case ---\n    for alpha, R in test_cases:\n        # --- Run simulation for initial condition 1 ---\n        sol1 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_1,\n            t_eval=t_eval,\n            method='RK45', \n            rtol=1e-6, \n            atol=1e-9\n        )\n        is_osc1, is_steady1, mean_x1, mean_y1 = analyze_trajectory(sol1.t, sol1.y, alpha, R)\n\n        # --- Run simulation for initial condition 2 ---\n        sol2 = solve_ivp(\n            fun=lambda t, z: ode_system(t, z, alpha, R),\n            t_span=t_span,\n            y0=z0_2,\n            t_eval=t_eval,\n            method='RK45',\n            rtol=1e-6,\n            atol=1e-9\n        )\n        is_osc2, is_steady2, mean_x2, mean_y2 = analyze_trajectory(sol2.t, sol2.y, alpha, R)\n        \n        # --- Final classification based on the two trajectories ---\n        # The logic follows the if-elif-else structure specified in the problem.\n        \n        # Condition for bistability: both steady and means are different.\n        means_are_different = (abs(mean_x1 - mean_x2) >= 0.2 or abs(mean_y1 - mean_y2) >= 0.2)\n        \n        if is_steady1 and is_steady2 and means_are_different:\n            # Code 2 for bistable\n            result = 2\n        elif is_osc1 or is_osc2:\n            # Code 1 for oscillatory\n            result = 1\n        else:\n            # Code 0 for steady state\n            result = 0\n            \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2781485"}]}