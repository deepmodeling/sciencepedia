{"hands_on_practices": [{"introduction": "非相干前馈环（I-FFL）的一个关键功能是产生瞬时脉冲响应。为了定量地理解这种行为，我们可以使用线性化模型来分析其动态特性。这个练习将引导你推导输出达到峰值所需的时间（$t_p$），这是一个描述电路瞬态响应的关键参数，并揭示它如何依赖于激活和抑制分支的动力学参数 [@problem_id:2747368]。通过这个推导，你将深入理解两个分支的速度差异如何塑造输出脉冲的形状和时机。", "problem": "合成基因线路中的非相干前馈环 (I1-FFL) 通常通过其稳态附近的线性时不变动力学进行建模。考虑一个 I1-FFL，其中输入 $u(t)$ 通过一个快速激活分支同时激活输出，并通过一个独立的处理分支以一定的延迟抑制输出。将这两个分支线性化为由相同输入驱动的一阶滤波器。设 $x(t)$ 为激活分支的输出，$y(t)$ 为抑制分支的输出。假设对于 $t \\ge 0$ 有以下常微分方程：\n$$\n\\tau_{a}\\,\\frac{dx}{dt}=-x+g_{a}\\,u(t),\\qquad \\tau_{r}\\,\\frac{dy}{dt}=-y+g_{r}\\,u(t),\n$$\n初始条件为 $x(0)=0$ 和 $y(0)=0$，其中 $g_{a}>0$ 和 $g_{r}>0$ 是分支增益，$\\tau_{a}>0$ 和 $\\tau_{r}>0$ 是分支时间常数。输出为非相干和\n$$\nZ(t)=x(t)-y(t).\n$$\n设输入为单位阶跃 $u(t)=H(t)$，其中 $H(t)$ 是亥维赛德函数。时间以秒为单位测量，因此请以秒为单位报告 $t_{p}$。\n\n从这些方程和一阶线性系统的标准性质出发，推导在阶跃输入后，$Z(t)$ 在 $t \\ge 0$ 范围内达到其最大值的峰值时间 $t_{p}$ 的闭式解析表达式。将 $t_{p}$ 表示为四个参数 $\\tau_{a}$、$\\tau_{r}$、$g_{a}$ 和 $g_{r}$ 的函数。然后，使用您的表达式，解释存在有限正值 $t_{p}$ 的条件，并解释极限情况 $\\tau_{r}\\gg \\tau_{a}$ 和 $\\tau_{a}\\gg \\tau_{r}$，以及与完美适应相关的特殊情况 $g_{a}=g_{r}$。您最终报告的答案必须是 $t_{p}$ 关于 $\\tau_{a}$、$\\tau_{r}$、$g_{a}$ 和 $g_{r}$ 的单个闭式表达式。无需进行数值计算。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n已知条件逐字提取如下：\n-   对于 $t \\ge 0$ 的微分方程：$\\tau_{a}\\,\\frac{dx}{dt}=-x+g_{a}\\,u(t)$ 和 $\\tau_{r}\\,\\frac{dy}{dt}=-y+g_{r}\\,u(t)$。\n-   初始条件：$x(0)=0$ 和 $y(0)=0$。\n-   参数：$g_{a}>0$、$g_{r}>0$、$\\tau_{a}>0$、$\\tau_{r}>0$。\n-   输出定义：$Z(t)=x(t)-y(t)$。\n-   输入信号：$u(t)=H(t)$，其中 $H(t)$ 是亥维赛德阶跃函数。\n-   目标：推导峰值时间 $t_{p}$ 的闭式表达式并讨论其性质。\n\n该问题具有科学依据，采用了系统生物学和合成生物学中常见的基因线路基序的标准线性化模型。该问题是适定的，提供了求解唯一解所需的一整套线性常微分方程、初始条件和参数约束。其语言客观而精确。因此，该问题被认为是有效的。\n\n求解过程如下。\n\n当 $t > 0$ 时，输入为常数 $u(t) = 1$。微分方程变为：\n$$\n\\tau_{a}\\,\\frac{dx}{dt} + x = g_{a}\n$$\n$$\n\\tau_{r}\\,\\frac{dy}{dt} + y = g_{r}\n$$\n这是一阶线性常微分方程。对于零初始条件下的阶跃输入，其解是一阶系统的标准结果。对于 $x(0)=0$，$x(t)$ 的解是：\n$$\nx(t) = g_{a}(1 - \\exp(-t/\\tau_{a}))\n$$\n同理，对于 $y(0)=0$，$y(t)$ 的解是：\n$$\ny(t) = g_{r}(1 - \\exp(-t/\\tau_{r}))\n$$\n总输出 $Z(t)$ 是这两个响应的非相干和：\n$$\nZ(t) = x(t) - y(t) = g_{a}(1 - \\exp(-t/\\tau_{a})) - g_{r}(1 - \\exp(-t/\\tau_{r}))\n$$\n展开此表达式可得：\n$$\nZ(t) = g_{a} - g_{a}\\exp(-t/\\tau_{a}) - g_{r} + g_{r}\\exp(-t/\\tau_{r}) = (g_{a} - g_{r}) - g_{a}\\exp(-t/\\tau_{a}) + g_{r}\\exp(-t/\\tau_{r})\n$$\n为了找到 $Z(t)$ 达到其最大值的时间 $t_{p}$，我们必须通过将 $Z(t)$ 对时间 $t$ 的一阶导数设为零来找到临界点。\n$$\n\\frac{dZ}{dt} = \\frac{d}{dt} \\left[ (g_{a} - g_{r}) - g_{a}\\exp(-t/\\tau_{a}) + g_{r}\\exp(-t/\\tau_{r}) \\right]\n$$\n$$\n\\frac{dZ}{dt} = -g_{a}\\left(-\\frac{1}{\\tau_{a}}\\right)\\exp(-t/\\tau_{a}) + g_{r}\\left(-\\frac{1}{\\tau_{r}}\\right)\\exp(-t/\\tau_{r})\n$$\n$$\n\\frac{dZ}{dt} = \\frac{g_{a}}{\\tau_{a}}\\exp(-t/\\tau_{a}) - \\frac{g_{r}}{\\tau_{r}}\\exp(-t/\\tau_{r})\n$$\n在 $t = t_{p}$ 处令 $\\frac{dZ}{dt} = 0$ 可得：\n$$\n\\frac{g_{a}}{\\tau_{a}}\\exp(-t_{p}/\\tau_{a}) = \\frac{g_{r}}{\\tau_{r}}\\exp(-t_{p}/\\tau_{r})\n$$\n为了求解 $t_{p}$，我们重新排列方程以分离指数项：\n$$\n\\frac{g_{a}\\tau_{r}}{g_{r}\\tau_{a}} = \\frac{\\exp(-t_{p}/\\tau_{r})}{\\exp(-t_{p}/\\tau_{a})} = \\exp\\left(-t_{p}/\\tau_{r} + t_{p}/\\tau_{a}\\right) = \\exp\\left(t_{p}\\left(\\frac{1}{\\tau_{a}} - \\frac{1}{\\tau_{r}}\\right)\\right)\n$$\n$$\n\\frac{g_{a}\\tau_{r}}{g_{r}\\tau_{a}} = \\exp\\left(t_{p}\\frac{\\tau_{r} - \\tau_{a}}{\\tau_{a}\\tau_{r}}\\right)\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{g_{a}\\tau_{r}}{g_{r}\\tau_{a}}\\right) = t_{p}\\frac{\\tau_{r} - \\tau_{a}}{\\tau_{a}\\tau_{r}}\n$$\n求解 $t_{p}$ 得到表达式：\n$$\nt_{p} = \\frac{\\tau_{a}\\tau_{r}}{\\tau_{r} - \\tau_{a}} \\ln\\left(\\frac{g_{a}\\tau_{r}}{g_{r}\\tau_{a}}\\right)\n$$\n有限的正峰值时间 $t_{p} > 0$ 仅在特定条件下存在。首先，为了使该临界点为最大值点，二阶导数 $\\frac{d^{2}Z}{dt^{2}}$ 在 $t = t_{p}$ 处必须为负。\n$$\n\\frac{d^{2}Z}{dt^{2}} = \\frac{d}{dt}\\left(\\frac{g_{a}}{\\tau_{a}}\\exp(-t/\\tau_{a}) - \\frac{g_{r}}{\\tau_{r}}\\exp(-t/\\tau_{r})\\right) = -\\frac{g_{a}}{\\tau_{a}^{2}}\\exp(-t/\\tau_{a}) + \\frac{g_{r}}{\\tau_{r}^{2}}\\exp(-t/\\tau_{r})\n$$\n在 $t=t_{p}$ 处，我们使用条件 $\\frac{g_{a}}{\\tau_{a}}\\exp(-t_{p}/\\tau_{a}) = \\frac{g_{r}}{\\tau_{r}}\\exp(-t_{p}/\\tau_{r})$。设这个公共值为 $C$。那么 $\\exp(-t_{p}/\\tau_{a}) = C\\frac{\\tau_{a}}{g_{a}}$ 且 $\\exp(-t_{p}/\\tau_{r}) = C\\frac{\\tau_{r}}{g_{r}}$。代入二阶导数：\n$$\n\\left.\\frac{d^{2}Z}{dt^{2}}\\right|_{t=t_{p}} = -\\frac{g_{a}}{\\tau_{a}^{2}}\\left(C\\frac{\\tau_{a}}{g_{a}}\\right) + \\frac{g_{r}}{\\tau_{r}^{2}}\\left(C\\frac{\\tau_{r}}{g_{r}}\\right) = -\\frac{C}{\\tau_{a}} + \\frac{C}{\\tau_{r}} = C\\left(\\frac{1}{\\tau_{r}} - \\frac{1}{\\tau_{a}}\\right) = C\\frac{\\tau_{a} - \\tau_{r}}{\\tau_{a}\\tau_{r}}\n$$\n由于 $g_{a}, g_{r}, \\tau_{a}, \\tau_{r}$ 均为正， $C$ 必为正。因此，要使 $\\left.\\frac{d^{2}Z}{dt^{2}}\\right|_{t=t_{p}}  0$，我们需要 $\\tau_{a} - \\tau_{r}  0$，即 $\\tau_{a}  \\tau_{r}$。激活分支必须比抑制分支快。\n\n当 $\\tau_r  \\tau_a$ 时，$t_p$ 表达式中的分母 $\\tau_r - \\tau_a$ 为正。要使 $t_p$ 为正，分子 $\\ln\\left(\\frac{g_a \\tau_r}{g_r \\tau_a}\\right)$ 也必须为正。这要求 $\\frac{g_a \\tau_r}{g_r \\tau_a}  1$，可简化为 $\\frac{g_a}{\\tau_a}  \\frac{g_r}{\\tau_r}$。这个不等式有明确的物理释义：激活物的初始产生速率 $\\dot{x}(0) = g_a/\\tau_a$ 必须大于抑制物的初始产生速率 $\\dot{y}(0) = g_r/\\tau_r$。这确保了输出 $Z(t)$ 从 $Z(0)=0$ 开始时是上升的，这是出现峰值的一个先决条件。\n\n极限情况和特殊情况的解释：\n-   情况 $\\tau_{r} \\gg \\tau_{a}$：抑制分支比激活分支慢得多。在此极限下，$\\frac{\\tau_{r}}{\\tau_{r}-\\tau_{a}} \\to 1$，且 $t_{p} \\approx \\tau_{a}\\ln\\left(\\frac{g_{a}\\tau_{r}}{g_{r}\\tau_{a}}\\right)$。系统稳健地产生一个脉冲。峰值时间 $t_{p}$ 随着抑制物时间常数 $\\tau_{r}$ 对数增长，这意味着更慢的抑制导致更晚的峰值。\n-   情况 $\\tau_{a} \\gg \\tau_{r}$：激活物比抑制物慢得多。出现最大值的条件 $\\tau_{a}  \\tau_{r}$ 不被满足。不会出现峰值（最大值）。相反，如果 $\\frac{g_a}{\\tau_a}  \\frac{g_r}{\\tau_r}$，输出 $Z(t)$ 初始时会下降，形成一个波谷。\n-   情况 $g_{a} = g_{r}$：这对应于完美适应，此时稳态输出为 $Z(\\infty) = g_a - g_r = 0$。输出精确地返回到其刺激前水平。峰值时间的表达式简化为 $t_{p} = \\frac{\\tau_{a}\\tau_{r}}{\\tau_{r} - \\tau_{a}}\\ln\\left(\\frac{\\tau_{r}}{\\tau_{a}}\\right)$。当且仅当 $\\tau_{r}  \\tau_{a}$ 时存在峰值，这证实了时间动力学，而不仅仅是稳态增益，对脉冲的产生至关重要。\n\n最终推导出的 $t_{p}$ 表达式包含了这些条件。只有当 $\\tau_r  \\tau_a$ 和 $g_a/\\tau_a  g_r/\\tau_r$ 时，它作为峰值时间才具有物理意义。", "answer": "$$\n\\boxed{\\frac{\\tau_{a} \\tau_{r}}{\\tau_{r} - \\tau_{a}} \\ln\\left(\\frac{g_{a} \\tau_{r}}{g_{r} \\tau_{a}}\\right)}\n$$", "id": "2747368"}, {"introduction": "除了产生脉冲，I-FFL 的另一个核心功能是实现精确适应，即在持续的输入信号下，系统输出能够恢复到其初始基线水平。本练习将探讨实现精确适应所需的精确数学条件，并研究一个常见的生物学现实——基因的“渗漏”表达——如何影响这一功能 [@problem_id:2747353]。通过分析稳态行为，你将学会如何评估适应机制的鲁棒性，并理解如何从实验数据中区分适应性响应和基线漂移。", "problem": "考虑一个典型的非相干前馈环 (I-FFL)，其中上游转录因子 $X$ 激活中间阻遏蛋白 $Y$ 和输出基因产物 $Z$，而 $Y$ 抑制 $Z$。假设在感兴趣的操作范围内，系统处于充分混合条件下，并具有线性质作用样生成和一级降解。具体来说，假设 $X$ 是一个外源输入，在时间 $t=0$ 时发生从 $X=X_{0}$ 到 $X=X_{1}$ 的阶跃变化，并在阶跃前后保持恒定。$Y$ 和 $Z$ 的动力学由以下模型描述：\n$$\n\\frac{dY}{dt} \\;=\\; \\alpha_{y}\\,X \\;-\\; \\beta_{y}\\,Y,\n$$\n$$\n\\frac{dZ}{dt} \\;=\\; \\alpha_{1}\\,X \\;-\\; \\alpha_{2}\\,Y \\;+\\; k_{0} \\;-\\; \\beta_{z}\\,Z,\n$$\n其中 $\\alpha_{y}$、$\\alpha_{1}$、$\\alpha_{2}$、$\\beta_{y}$ 和 $\\beta_{z}$ 是正常数，而 $k_{0}\\ge 0$ 代表 $Z$ 的一个泄露性生产项，该项独立于 $X$ 和 $Y$。假设 $X$、$Y$ 和 $Z$ 均为浓度。\n\n从这些方程和针对线性常微分方程的标准稳态推理出发，完成以下任务：\n- 分别用 $X_{0}$ 和 $X_{1}$ 表示 $Y$ 和 $Z$ 的阶跃前和阶跃后稳态。\n- 从这些稳态推导出 $Z$ 对 $X$ 的变化表现出完美适应的条件（即，$Z$ 的稳态值与 $X$ 无关）。\n- 确定泄露性表达 $k_{0}$ 的存在如何影响适应条件，以及从阶跃后稳态中减去阶跃前基线稳态（基线扣除）是否能消除 $k_{0}$ 对观测变化的影响。\n\n令 $\\Delta Z_{\\mathrm{ss,sub}}$ 表示扣除基线后的稳态变化，\n$$\n\\Delta Z_{\\mathrm{ss,sub}} \\;=\\; \\bigl[Z_{\\mathrm{ss}}(X_{1})\\bigr] \\;-\\; \\bigl[Z_{\\mathrm{ss}}(X_{0})\\bigr].\n$$\n请提供一个关于 $\\Delta Z_{\\mathrm{ss,sub}}$ 的单一闭式解析表达式，用 $\\alpha_{1}$、$\\alpha_{2}$、$\\alpha_{y}$、$\\beta_{y}$、$\\beta_{z}$、$k_{0}$、$X_{0}$ 和 $X_{1}$ 表示。你的最终答案必须是一个单一的闭式解析表达式。在最终的方框答案中不要包含单位。不需要进行数值计算或四舍五入。", "solution": "首先将对问题的科学合理性、一致性和客观性进行验证。\n\n### 步骤1：提取已知条件\n问题陈述中给出的已知条件如下：\n- 该系统是一个非相干前馈环 (I-FFL)。\n- 上游转录因子是 $X$，中间阻遏蛋白是 $Y$，输出是 $Z$。\n- $X$ 激活 $Y$ 和 $Z$。\n- $Y$ 抑制 $Z$。\n- 输入 $X$ 是一个在时间 $t=0$ 时从 $X=X_{0}$ 变为 $X=X_{1}$ 的外源阶跃变化。\n- 系统动力学由以下线性常微分方程描述：\n$$\n\\frac{dY}{dt} = \\alpha_{y} X - \\beta_{y} Y\n$$\n$$\n\\frac{dZ}{dt} = \\alpha_{1} X - \\alpha_{2} Y + k_{0} - \\beta_{z} Z\n$$\n- 参数 $\\alpha_{y}$、$\\alpha_{1}$、$\\alpha_{2}$、$\\beta_{y}$ 和 $\\beta_{z}$ 是正常数。\n- $Z$ 的泄露性生产项为 $k_{0} \\ge 0$。\n- 扣除基线后的稳态变化定义为：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\bigl[Z_{\\mathrm{ss}}(X_{1})\\bigr] - \\bigl[Z_{\\mathrm{ss}}(X_{0})\\bigr]\n$$\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题使用线性化模型描述了一个典型的非相干前馈环。这是系统生物学和合成生物学中一个标准的、被广泛研究的网络基序。使用质量作用动力学和一级降解是一种有效且常见的简化方法，用于分析此类回路的基本特性。完美适应的概念是 I-FFL 功能的核心。该问题牢固地建立在化学动力学和系统理论的既定原则之上。\n- **适定性**：该问题定义清晰，包含一个线性常微分方程组和恒定参数。任务是进行稳态分析，这是对此类系统的标准程序，可以得出一个唯一、稳定且有意义的解。所有必要的信息均已提供。\n- **客观性**：语言精确且量化。它使用标准的科学术语，避免了任何主观或模糊的陈述。\n\n该问题不存在科学上不合理、信息缺失或含糊不清等缺陷。这是一个网络基序分析的教科书式范例。\n\n### 步骤3：结论与行动\n问题有效。现在开始推导解答。\n\n问题的核心在于分析系统的稳态。稳态被定义为系统各组分浓度不随时间变化的条件。在数学上，这对应于将时间导数设为零：\n$$\n\\frac{dY}{dt} = 0\n$$\n$$\n\\frac{dZ}{dt} = 0\n$$\n我们将针对一个通用的、恒定的输入水平 $X$ 求解该系统。给定的微分方程变成了一个关于稳态浓度（我们记为 $Y_{\\mathrm{ss}}$ 和 $Z_{\\mathrm{ss}}$）的线性代数方程组：\n$$\n0 = \\alpha_{y} X - \\beta_{y} Y_{\\mathrm{ss}}\n$$\n$$\n0 = \\alpha_{1} X - \\alpha_{2} Y_{\\mathrm{ss}} + k_{0} - \\beta_{z} Z_{\\mathrm{ss}}\n$$\n从第一个方程，我们可以直接解出作为 $X$ 函数的 $Y_{\\mathrm{ss}}$：\n$$\n\\beta_{y} Y_{\\mathrm{ss}} = \\alpha_{y} X \\implies Y_{\\mathrm{ss}}(X) = \\frac{\\alpha_{y}}{\\beta_{y}} X\n$$\n这表明阻遏蛋白 $Y$ 的稳态水平与输入信号 $X$ 成正比。\n\n接下来，我们将 $Y_{\\mathrm{ss}}$ 的这个表达式代入第二个方程来求解 $Z_{\\mathrm{ss}}$：\n$$\n0 = \\alpha_{1} X - \\alpha_{2} \\left(\\frac{\\alpha_{y}}{\\beta_{y}} X\\right) + k_{0} - \\beta_{z} Z_{\\mathrm{ss}}\n$$\n现在我们求解 $Z_{\\mathrm{ss}}$：\n$$\n\\beta_{z} Z_{\\mathrm{ss}} = \\alpha_{1} X - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}} X + k_{0}\n$$\n将 $X$ 因子提出，得到：\n$$\n\\beta_{z} Z_{\\mathrm{ss}} = \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X + k_{0}\n$$\n最后，输出 $Z$ 的稳态浓度作为输入 $X$ 的函数是：\n$$\nZ_{\\mathrm{ss}}(X) = \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X + \\frac{k_{0}}{\\beta_{z}}\n$$\n问题指明了在 $X=X_{0}$ 时的阶跃前稳态和在 $X=X_{1}$ 时的阶跃后稳态。使用推导出的 $Z_{\\mathrm{ss}}(X)$ 的通用公式，它们是：\n- 阶跃前稳态 ($X_{0}$): $Z_{\\mathrm{ss}}(X_{0}) = \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{0} + \\frac{k_{0}}{\\beta_{z}}$\n- 阶跃后稳态 ($X_{1}$): $Z_{\\mathrm{ss}}(X_{1}) = \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{1} + \\frac{k_{0}}{\\beta_{z}}$\n\n当稳态输出 $Z_{\\mathrm{ss}}$ 与输入水平 $X$ 无关时，就会发生完美适应。检查 $Z_{\\mathrm{ss}}(X)$ 的通用表达式，这种无关性要求包含 $X$ 的项的系数为零：\n$$\n\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}} = 0\n$$\n这可以重排为线性化 I-FFL 中完美适应的著名条件：\n$$\n\\alpha_{1} \\beta_{y} = \\alpha_{2} \\alpha_{y}\n$$\n这个条件代表了从 $X$ 到 $Z$ 的两条路径的“平衡”：直接激活路径（强度与 $\\alpha_{1}$ 成正比）和间接抑制路径（强度与 $\\alpha_{2} \\frac{\\alpha_{y}}{\\beta_{y}}$ 成正比）。\n\n泄露性表达项 $k_{0}$ 的存在不影响完美适应的条件，因为 $k_{0}$ 没有出现在表达式 $\\alpha_{1} \\beta_{y} = \\alpha_{2} \\alpha_{y}$ 中。然而，如果满足适应条件，$Z$ 的稳态值将变为 $Z_{\\mathrm{ss}} = \\frac{k_{0}}{\\beta_{z}}$。这意味着泄露性表达设定了系统适应的基线水平。\n\n最后的任务是推导扣除基线后的稳态变化 $\\Delta Z_{\\mathrm{ss,sub}}$ 的表达式。利用其定义以及阶跃前和阶跃后稳态的表达式：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = Z_{\\mathrm{ss}}(X_{1}) - Z_{\\mathrm{ss}}(X_{0})\n$$\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\left[ \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{1} + \\frac{k_{0}}{\\beta_{z}} \\right] - \\left[ \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{0} + \\frac{k_{0}}{\\beta_{z}} \\right]\n$$\n常数项 $\\frac{k_{0}}{\\beta_{z}}$ 被消掉，这表明基线扣除确实消除了泄露性生产项对稳态变化的影响：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{1} - \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) X_{0}\n$$\n提出公因式，得到最终表达式：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\frac{1}{\\beta_{z}} \\left(\\alpha_{1} - \\frac{\\alpha_{2} \\alpha_{y}}{\\beta_{y}}\\right) (X_{1} - X_{0})\n$$\n为了将其表示为不含嵌套分数的单个分数，我们为括号内的项找到一个公分母：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\frac{1}{\\beta_{z}} \\left(\\frac{\\alpha_{1}\\beta_{y} - \\alpha_{2}\\alpha_{y}}{\\beta_{y}}\\right) (X_{1} - X_{0})\n$$\n这给出了最终的闭式解析表达式：\n$$\n\\Delta Z_{\\mathrm{ss,sub}} = \\frac{(\\alpha_{1}\\beta_{y} - \\alpha_{2}\\alpha_{y})(X_{1} - X_{0})}{\\beta_{y}\\beta_{z}}\n$$", "answer": "$$\n\\boxed{\\frac{(\\alpha_{1}\\beta_{y} - \\alpha_{2}\\alpha_{y})(X_{1} - X_{0})}{\\beta_{y}\\beta_{z}}}\n$$", "id": "2747353"}, {"introduction": "掌握了 I-FFL 的基本分析之后，我们可以将其作为一个模块化的工程元件来构建更复杂的生物计算系统。这个练习将挑战你设计一个能够同时对两种不同输入信号实现精确适应的电路 [@problem_id:2747274]。该设计利用了一个共享的抑制臂，并引入了更接近实际的启动子结合模型，展示了如何通过平衡分子通路和比例感知（ratiometric sensing）原理来构建能够处理多路输入信号的、鲁棒的生物信息处理器。", "problem": "一位合成生物学家旨在实现一个双输入非相干前馈环 (I-FFL)，以在输出基因产物中实现适应性和脉冲生成。两个外部诱导物（表示为 $X_{1}$ 和 $X_{2}$）通过两条路径控制一个共同的输出 $Z$：一条直接激活路径和一条通过两个输入共享的中间产物 $Y$ 的间接抑制路径。做出以下设计假设，并且所有变量和参数都已无量纲化。\n\n- $X_{1}$ 和 $X_{2}$ 都被转导成一个单一的有效激活信号 $A$，该信号驱动 $Z$ 的转录。在感兴趣的工作区间内，有效激活物与输入呈线性关系，因此 $A=\\alpha_{1} X_{1}+\\alpha_{2} X_{2}$，其中 $\\alpha_{1}$ 和 $\\alpha_{2}$ 为正常数。\n- 中间产物 $Y$ 响应输入而产生，并通过与 $A$ 作用的同一启动子区域结合来抑制 $Z$，$A$ 和 $Y$ 的结合是互斥的。只有当 $A$ 结合时，$Z$ 的转录才会发生。\n- $A$ 和 $Y$ 与启动子的结合相对于蛋白质的产生和降解是快速的（准平衡结合），其结合分别由解离常数 $K_{A}$ 和 $K_{Y}$ 表征。当 $A$ 结合时，$Z$ 以最大速率 $k_{z}$ 产生，并以速率 $\\delta_{z}$ 降解/稀释。中间产物 $Y$ 的产生速率与输入成正比，并以速率 $\\delta_{y}$ 降解/稀释。\n- 在稳态下的高占据区进行分析，该区域满足 $A/K_{A}\\gg 1$ 和 $Y/K_{Y}\\gg 1$。这是基因回路中比率依赖型启动子逻辑的一个标准工作点。\n\n任务：\n\n$1.$ 从具有三种互斥状态（未结合、$A$-结合或$Y$-结合）的启动子的准平衡热力学占据模型和上述假设出发，写出 $Y(t)$ 和 $Z(t)$ 的常微分方程，并在高占据区推导出有效的 $Z$ 产生项，该项是 $A$、$Y$、$K_{A}$ 和 $K_{Y}$ 的函数。\n\n$2.$ 假设允许输入以最一般的线性方式产生 $Y$，即 $\\dot{Y}=k_{y1} X_{1}+k_{y2} X_{2}-\\delta_{y} Y$，其中 $k_{y1}$ 和 $k_{y2}$ 为正常数。在高占据假设下，推导稳态表达式 $Z_{\\mathrm{ss}}(X_{1},X_{2})$，并用 $A$、$K_{A}$、$K_{Y}$、$k_{z}$、$\\delta_{z}$、$\\delta_{y}$ 以及系数 $\\alpha_{i}$ 和 $k_{yi}$ 表示。\n\n$3.$ 施加对每个输入分别实现完美适应的设计要求：对于所有正值 $X_{1}$ 和 $X_{2}$，当保持 $X_{2}$ 固定时，稳态输出 $Z_{\\mathrm{ss}}$ 必须与 $X_{1}$ 无关；当保持 $X_{1}$ 固定时，$Z_{\\mathrm{ss}}$ 必须与 $X_{2}$ 无关。推导使该条件成立的关于系数向量 $(\\alpha_{1},\\alpha_{2})$ 和 $(k_{y1},k_{y2})$ 的充分必要条件。\n\n$4.$ 在任务3的条件下，特化为一种比例共享路径设计，其中 $Y$ 的产生由相同的有效激活物组合驱动，即 $\\dot{Y}=k_{y} A-\\delta_{y} Y$，其中 $k_{y}0$。在高占据区，计算稳态输出 $Z_{\\mathrm{ss}}$ 的闭式表达式，用 $k_{z}$、$\\delta_{z}$、$k_{y}$、$\\delta_{y}$ 和 $\\gamma\\equiv K_{A}/K_{Y}$ 表示。\n\n请将任务4中得到的 $Z_{\\mathrm{ss}}$ 的单一符号表达式作为你的最终答案。答案中不要包含单位。", "solution": "问题陈述是合成基因回路定量建模方面的一个有效练习。它在科学上基于生物化学动力学和系统生物学的既定原则，问题提法明确，信息充分，可得到唯一解，并用客观、精确的语言表述。因此，我将开始进行推导。\n\n该系统描述了一个双输入非相干前馈环 (I-FFL)，其中两个输入 $X_{1}$ 和 $X_{2}$ 直接和间接地激活输出 $Z$。直接路径是激活性的，而由共享中间产物 $Y$ 介导的间接路径是抑制性的。中心任务是推导稳态输出 $Z_{\\mathrm{ss}}$ 对任一输入变化的完美适应条件，并求出最终的稳态水平。\n\n首先，我解决任务1：写出 $Y(t)$ 和 $Z(t)$ 的常微分方程 (ODE)，并推导 $Z$ 的有效产生项。\n\n中间物种 $Y$ 的动力学在任务2中给出，是输入的线性组合，并伴随一阶降解。因此，$Y(t)$ 的常微分方程为：\n$$ \\frac{dY}{dt} = k_{y1} X_{1} + k_{y2} X_{2} - \\delta_{y} Y $$\n其中 $k_{y1}$ 和 $k_{y2}$ 是产生速率常数，$\\delta_{y}$ 是降解/稀释速率常数。\n\n$Z$ 的产生取决于其启动子被有效激活物 $A$ 占据的分数。启动子可以处于三种互斥状态之一：未结合 ($P_{\\text{free}}$)、被激活物 $A$ 结合 ($P_{A}$) 或被抑制物 $Y$ 结合 ($P_{Y}$)。启动子的总量是恒定的，$P_{\\text{total}} = [P_{\\text{free}}] + [P_{A}] + [P_{Y}]$。假设结合反应处于准平衡状态：\n$P_{\\text{free}} + A \\rightleftharpoons P_{A}$，解离常数为 $K_{A} = \\frac{[P_{\\text{free}}][A]}{[P_{A}]}$。\n$P_{\\text{free}} + Y \\rightleftharpoons P_{Y}$，解离常数为 $K_{Y} = \\frac{[P_{\\text{free}}][Y]}{[P_{Y}]}$。\n\n根据这些关系，我们将 $[P_{A}]$ 和 $[P_{Y}]$ 用 $[P_{\\text{free}}]$ 表示：\n$[P_{A}] = \\frac{[P_{\\text{free}}][A]}{K_{A}}$ 以及 $[P_{Y}] = \\frac{[P_{\\text{free}}][Y]}{K_{Y}}$。\n代入启动子的守恒方程：\n$P_{\\text{total}} = [P_{\\text{free}}] \\left(1 + \\frac{[A]}{K_{A}} + \\frac{[Y]}{K_{Y}}\\right)$。\n\n只有当激活物 $A$ 结合时，$Z$ 才会转录。这种状态的概率，即占据分数 $\\theta_{A}$，为：\n$$ \\theta_{A} = \\frac{[P_{A}]}{P_{\\text{total}}} = \\frac{\\frac{[P_{\\text{free}}][A]}{K_{A}}}{[P_{\\text{free}}] \\left(1 + \\frac{[A]}{K_{A}} + \\frac{[Y]}{K_{Y}}\\right)} = \\frac{\\frac{A}{K_{A}}}{1 + \\frac{A}{K_{A}} + \\frac{Y}{K_{Y}}} $$\n问题指明我们在高占据区工作，其中 $\\frac{A}{K_{A}} \\gg 1$ 和 $\\frac{Y}{K_{Y}} \\gg 1$。在此极限下，分母中的项 $1$ 与另外两项相比可以忽略不计。占据分数简化为：\n$$ \\theta_{A} \\approx \\frac{\\frac{A}{K_{A}}}{\\frac{A}{K_{A}} + \\frac{Y}{K_{Y}}} $$\n这是有效的 $Z$ 产生项，按最大产生速率 $k_{z}$ 进行缩放。因此，$Z(t)$ 的完整常微分方程，包括其以速率 $\\delta_{z}$ 进行的一阶降解，为：\n$$ \\frac{dZ}{dt} = k_{z} \\left( \\frac{\\frac{A}{K_{A}}}{\\frac{A}{K_{A}} + \\frac{Y}{K_{Y}}} \\right) - \\delta_{z} Z $$\n\n接下来，对于任务2，我推导稳态表达式 $Z_{\\mathrm{ss}}(X_{1}, X_{2})$。在稳态下，所有时间导数都为零。\n从 $\\frac{dY}{dt} = 0$，我们得到 $Y$ 的稳态浓度：\n$$ Y_{\\mathrm{ss}} = \\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\delta_{y}} $$\n从 $\\frac{dZ}{dt} = 0$，我们求解 $Z$ 的稳态浓度：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( \\frac{\\frac{A_{\\mathrm{ss}}}{K_{A}}}{\\frac{A_{\\mathrm{ss}}}{K_{A}} + \\frac{Y_{\\mathrm{ss}}}{K_{Y}}} \\right) $$\n有效激活信号给出为 $A = \\alpha_{1} X_{1} + \\alpha_{2} X_{2}$。在稳态下，$A_{\\mathrm{ss}} = \\alpha_{1} X_{1} + \\alpha_{2} X_{2}$。\n将 $A_{\\mathrm{ss}}$ 和 $Y_{\\mathrm{ss}}$ 的表达式代入 $Z_{\\mathrm{ss}}$ 的方程中：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( \\frac{\\frac{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}}{K_{A}}}{\\frac{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}}{K_{A}} + \\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\delta_{y} K_{Y}}} \\right) $$\n为清晰起见，此表达式可以重新整理为：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( 1 + \\left(\\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\delta_{y} K_{Y}}\\right) \\left(\\frac{K_{A}}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}}\\right) \\right)^{-1} = \\frac{k_{z}}{\\delta_{z}} \\left( 1 + \\frac{K_{A}}{\\delta_{y} K_{Y}} \\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}} \\right)^{-1} $$\n\n对于任务3，我寻找完美适应的条件。完美适应要求 $Z_{\\mathrm{ss}}$ 对于所有正值都与 $X_{1}$ 和 $X_{2}$ 无关。这意味着 $Z_{\\mathrm{ss}}$ 的表达式必须为一个常数。审视该表达式，这只有在比率项为常数时才能发生：\n$$ \\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}} = C $$\n其中 $C$ 为某个常数。这意味着 $k_{y1} X_{1} + k_{y2} X_{2} = C (\\alpha_{1} X_{1} + \\alpha_{2} X_{2})$。由于这对所有 $X_{1}  0$ 和 $X_{2}  0$ 都必须成立，方程两边 $X_{1}$ 和 $X_{2}$ 的系数必须相等。这给出了一个由两个方程组成的方程组：\n$k_{y1} = C \\alpha_{1}$\n$k_{y2} = C \\alpha_{2}$\n这要求系数向量 $(\\alpha_{1}, \\alpha_{2})$ 和 $(k_{y1}, k_{y2})$ 成比例。因此，一个充分必要条件是：\n$$ \\frac{k_{y1}}{\\alpha_{1}} = \\frac{k_{y2}}{\\alpha_{2}} $$\n这等价于 $\\alpha_{1} k_{y2} - \\alpha_{2} k_{y1} = 0$。\n\n最后，对于任务4，我分析特定的设计，其中 $\\frac{dY}{dt} = k_{y} A - \\delta_{y} Y$。展开 $A$，我们得到 $\\frac{dY}{dt} = k_{y}(\\alpha_{1} X_{1} + \\alpha_{2} X_{2}) - \\delta_{y} Y$。将其与一般形式 $\\frac{dY}{dt} = k_{y1} X_{1} + k_{y2} X_{2} - \\delta_{y} Y$ 进行比较，我们确定 $k_{y1} = k_{y}\\alpha_{1}$ 和 $k_{y2} = k_{y}\\alpha_{2}$。\n这意味着 $\\frac{k_{y1}}{\\alpha_{1}} = k_{y}$ 和 $\\frac{k_{y2}}{\\alpha_{2}} = k_{y}$。任务3中完美适应的条件得到满足，比例常数为 $C = k_{y}$。\n在此条件下，该比率项变为：\n$$ \\frac{k_{y1} X_{1} + k_{y2} X_{2}}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}} = \\frac{k_{y}\\alpha_{1} X_{1} + k_{y}\\alpha_{2} X_{2}}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}} = \\frac{k_{y}(\\alpha_{1} X_{1} + \\alpha_{2} X_{2})}{\\alpha_{1} X_{1} + \\alpha_{2} X_{2}} = k_{y} $$\n现在，我将这个常数值代回到 $Z_{\\mathrm{ss}}$ 的表达式中：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( 1 + \\frac{K_{A}}{\\delta_{y} K_{Y}} k_{y} \\right)^{-1} $$\n问题将解离常数的比率定义为 $\\gamma \\equiv K_{A} / K_{Y}$。将其代入：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( 1 + \\frac{\\gamma k_{y}}{\\delta_{y}} \\right)^{-1} $$\n简化此表达式得到最终结果：\n$$ Z_{\\mathrm{ss}} = \\frac{k_{z}}{\\delta_{z}} \\left( \\frac{\\delta_{y} + \\gamma k_{y}}{\\delta_{y}} \\right)^{-1} = \\frac{k_{z}}{\\delta_{z}} \\frac{\\delta_{y}}{\\delta_{y} + \\gamma k_{y}} = \\frac{k_{z} \\delta_{y}}{\\delta_{z} \\left(\\delta_{y} + \\gamma k_{y}\\right)} $$\n这就是在完美适应条件下稳态输出的闭式表达式，与输入水平 $X_{1}$ 和 $X_{2}$ 无关，正如所要求的那样。", "answer": "$$\\boxed{\\frac{k_{z} \\delta_{y}}{\\delta_{z} \\left(\\delta_{y} + \\gamma k_{y}\\right)}}$$", "id": "2747274"}]}