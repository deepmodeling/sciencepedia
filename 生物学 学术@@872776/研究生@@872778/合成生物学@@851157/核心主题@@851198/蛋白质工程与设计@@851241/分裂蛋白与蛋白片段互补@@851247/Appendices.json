{"hands_on_practices": [{"introduction": "我们的第一个实践将从最基本但至关重要的定量模型开始。我们将推导控制蛋白质片段互补（PCA）过程中复合物形成的平衡分数的核心方程。理解这个基于质量作用定律的模型，是定量设计和分析任何基于PCA的生物系统的第一步，它将片段的总浓度和它们的结合亲和力（以解离常数 $K_d$ 表示）联系起来。[@problem_id:2774885]", "problem": "在合成生物学中使用的蛋白质片段互补（PFC）技术中，一种蛋白质被分裂成两个片段，此处表示为片段 $A$ 和片段 $B$。当它们相互结合时，会重构形成一个功能性复合物 $C$。考虑一个处于平衡状态的恒温、充分混合的溶液，其中分别含有片段 $A$ 和片段 $B$ 的总分析浓度 $A_T$ 和 $B_T$。假设如下：重构反应的化学计量比为 $1{:}1$，每个片段只有一个结合位点，只形成异源二聚体 $C$（不形成高阶寡聚体或同源二聚体），溶液是理想且稀释的，并且系统遵循质量作用定律的平衡，解离常数为 $K_d$。同时假设 $A_T>0$，$B_T \\ge 0$ 和 $K_d>0$。\n\n请从化学平衡和质量守恒的基本原理出发，推导片段 $A$ 结合到重构复合物中的平衡分数（定义为 $f_A \\equiv C/A_T$）的闭式解析表达式，该表达式是 $A_T$、$B_T$ 和 $K_d$ 的函数。你的最终答案必须是关于 $f_A(A_T,B_T,K_d)$ 的单个闭式解析表达式，且对于物理相关的平衡分支有效，而不是一个方程组。无需进行数值评估，也无需单位，因为 $f_A$ 是无量纲的。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n步骤 1：提取已知条件。\n- 反应物为片段 $A$ 和片段 $B$。\n- 产物为功能性复合物 $C$。\n- 系统是一个处于平衡状态的恒温、充分混合的溶液。\n- 总分析浓度为 $A_T$ 和 $B_T$。\n- 重构反应为 $A + B \\rightleftharpoons C$，化学计量比为 $1{:}1$。\n- 每个片段只有一个结合位点。\n- 只形成异源二聚体 $C$。\n- 溶液是理想且稀释的。\n- 系统遵循质量作用定律的平衡，解离常数为 $K_d$。\n- 约束条件为 $A_T > 0$、$B_T \\ge 0$ 和 $K_d > 0$。\n- 待求量是复合物中片段 $A$ 的平衡分数，定义为 $f_A \\equiv C/A_T$。\n- $f_A$ 的最终表达式必须是关于 $A_T$、$B_T$ 和 $K_d$ 的单个闭式解析函数。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据、提法明确且客观。它描述了一个标准的双分子结合平衡，这是物理化学和生物化学中的一个基本概念。该模型基于质量作用定律和质量守恒定律，这些都是核心原理。所提供的假设（理想溶液、$1{:}1$ 化学计量比、无副反应）是创建易于处理的分析模型的标准简化方法。该问题是自洽的，定义了求所需量（$f_A$）所需的所有必要参数（$A_T$、$B_T$、$K_d$）。约束条件在物理上是一致的。验证标准中列出的缺陷均不存在。\n\n步骤 3：结论与行动。\n问题有效。将推导解答。\n\n由片段 $A$ 和 $B$ 重构功能性复合物 $C$ 的过程由以下平衡反应表示：\n$$\nA + B \\rightleftharpoons C\n$$\n对于处于平衡状态的系统，解离常数 $K_d$ 由质量作用定律定义。考虑解离反应 $C \\rightleftharpoons A + B$ 更为方便。$K_d$ 的表达式为：\n$$\nK_d = \\frac{[A][B]}{[C]}\n$$\n其中 $[A]$、$[B]$ 和 $[C]$ 分别表示游离片段 $A$、游离片段 $B$ 和复合物 $C$ 的平衡浓度。\n\n物种 $A$ 和 $B$ 的总浓度（表示为 $A_T$ 和 $B_T$）是守恒的。这可以通过质量平衡方程表示：\n$$\nA_T = [A] + [C]\n$$\n$$\nB_T = [B] + [C]\n$$\n根据这些守恒定律，我们可以用总浓度和复合物浓度 $[C]$ 来表示游离浓度 $[A]$ 和 $[B]$：\n$$\n[A] = A_T - [C]\n$$\n$$\n[B] = B_T - [C]\n$$\n这些表达式是有效的，因为复合物中某组分的浓度不能超过其总浓度，即 $[C] \\le A_T$ 和 $[C] \\le B_T$。\n\n将这些游离浓度的表达式代入解离常数的方程中，得到：\n$$\nK_d = \\frac{(A_T - [C])(B_T - [C])}{[C]}\n$$\n为了求解 $[C]$，我们将此方程重新排列成多项式形式。两边同乘以 $[C]$ 得：\n$$\nK_d [C] = (A_T - [C])(B_T - [C])\n$$\n展开右侧的乘积：\n$$\nK_d [C] = A_T B_T - A_T [C] - B_T [C] + [C]^2\n$$\n将所有项移到一边，得到一个关于 $[C]$ 的标准二次方程：\n$$\n[C]^2 - (A_T + B_T + K_d)[C] + A_T B_T = 0\n$$\n该方程的形式为 $ax^2 + bx + c = 0$，其中 $x = [C]$，$a = 1$，$b = -(A_T + B_T + K_d)$，$c = A_T B_T$。解由二次公式给出：\n$$\n[C] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n$$\n代入系数：\n$$\n[C] = \\frac{(A_T + B_T + K_d) \\pm \\sqrt{(-(A_T + B_T + K_d))^2 - 4(1)(A_T B_T)}}{2(1)}\n$$\n$$\n[C] = \\frac{(A_T + B_T + K_d) \\pm \\sqrt{(A_T + B_T + K_d)^2 - 4A_T B_T}}{2}\n$$\n这个二次方程产生两个数学解，但只有一个具有物理意义。为了确定正确的根，我们考察一个极限条件下的行为。让我们考虑片段 $B$ 的总浓度为零的情况，即 $B_T = 0$。在这种情况下，不可能形成复合物 $C$，因此必须有 $[C] = 0$。\n将 $B_T = 0$ 代入 $[C]$ 的解中：\n$$\n[C] = \\frac{(A_T + K_d) \\pm \\sqrt{(A_T + K_d)^2 - 0}}{2} = \\frac{(A_T + K_d) \\pm (A_T + K_d)}{2}\n$$\n使用加号的解给出 $[C] = \\frac{2(A_T + K_d)}{2} = A_T + K_d$。这个结果不符合物理实际，因为 $[C]$ 必须为零。\n使用减号的解给出 $[C] = \\frac{(A_T + K_d) - (A_T + K_d)}{2} = 0$。这个结果与物理预期一致。\n因此，对于所有有效的参数值，二次公式中的负号提供了具有物理意义的解。复合物平衡浓度的正确表达式是：\n$$\n[C] = \\frac{1}{2} \\left( (A_T + B_T + K_d) - \\sqrt{(A_T + B_T + K_d)^2 - 4 A_T B_T} \\right)\n$$\n问题要求的是片段 $A$ 结合到复合物中的分数，定义为 $f_A \\equiv [C]/A_T$。我们通过将 $[C]$ 的表达式除以 $A_T$ 来得到这个值：\n$$\nf_A = \\frac{[C]}{A_T} = \\frac{(A_T + B_T + K_d) - \\sqrt{(A_T + B_T + K_d)^2 - 4 A_T B_T}}{2 A_T}\n$$\n这就是 $f_A$ 作为 $A_T$、$B_T$ 和 $K_d$ 函数的最终闭式解析表达式。", "answer": "$$\\boxed{\\frac{(A_T + B_T + K_d) - \\sqrt{(A_T + B_T + K_d)^2 - 4 A_T B_T}}{2 A_T}}$$", "id": "2774885"}, {"introduction": "在理解了基本的双分子相互作用之后，我们来探讨一种常见的工程策略：通过柔性接头将两个蛋白质片段连接起来以提高互补效率。我们将运用高分子物理学的原理来量化这种分子内相互作用的增强效果。这个练习将向您展示如何将物理设计选择（如接头长度）转化为可预测的动力学参数，即“有效摩尔浓度” $c_{\\mathrm{eff}}$，从而连接微观分子设计与宏观系统性能。[@problem_id:2774881]", "problem": "通过使用轮廓长度为 $L$ 的柔性、无规卷曲的多肽连接链将片段 $B$ 连接到片段 $A$ 上，设计了一种蛋白质片段互补分析法。在稀溶液中，片段 $A$ 和 $B$ 以二级速率常数 $k_{\\mathrm{on}}$ (单位为 M⁻¹s⁻¹，其中摩尔浓度 (M) 表示 $\\mathrm{mol\\,L^{-1}}$) 进行双分子缔合。当被连接起来时，该缔合反应变为分子内反应，且实际上为一级反应；其表观速率常数 $k_{\\mathrm{intra}}$ 通常被描述为 $k_{\\mathrm{intra}} = k_{\\mathrm{on}}\\,c_{\\mathrm{eff}}$，其中 $c_{\\mathrm{eff}}$ 是由连接链产生的有效摩尔浓度。\n\n假设：\n- 连接链的长度远大于其持久长度，因此其端到端位移 $\\mathbf{r}$ 可以很好地用高斯链模型来近似。$\\mathbf{r}$ 的平衡概率密度为 $p(\\mathbf{r}) = \\left(\\frac{3}{2\\pi \\langle r^{2}\\rangle}\\right)^{3/2}\\exp\\!\\left(-\\frac{3 r^{2}}{2\\langle r^{2}\\rangle}\\right)$，其中对于 $L \\gg l_{p}$，有 $\\langle r^{2}\\rangle = 2 l_{p} L$，$l_{p}$ 是持久长度。\n- 结合要求片段的界面位于以 $A$ 的界面为中心、半径为 $a$ 的捕获球内。忽略取向和排除体积效应，并假设 $a \\ll \\sqrt{\\langle r^{2}\\rangle}$，因此 $p(\\mathbf{r})$ 在捕获球范围内近似为常数。\n- 阿伏伽德罗常数为 $N_{A} = 6.022\\times 10^{23}\\,\\mathrm{mol^{-1}}$，且 $1\\,\\mathrm{m^{3}} = 10^{3}\\,\\mathrm{L}$。\n\n任务：\n1) 从质量作用动力学和 $p(\\mathbf{r})$ 的定义出发，推导有效摩尔浓度 $c_{\\mathrm{eff}}$ (单位为 $\\mathrm{mol\\,L^{-1}}$) 关于 $p(\\mathbf{r})$、$N_{A}$ 和捕获体积的表达式，并由此在小捕获半径近似下，得到 $k_{\\mathrm{intra}}$ 关于 $k_{\\mathrm{on}}$、$L$ 和 $l_{p}$ 的表达式。\n\n2) 使用第(1)部分的结果，估算当 $L = 10\\,\\mathrm{nm}$，$l_{p} = 0.5\\,\\mathrm{nm}$，捕获半径 $a = 1.0\\,\\mathrm{nm}$ 且 $k_{\\mathrm{on}} = 1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$ 时的 $k_{\\mathrm{intra}}$ 值。将 $k_{\\mathrm{intra}}$ 的最终数值答案四舍五入至三位有效数字，并以 $\\mathrm{s^{-1}}$ 为单位表示。", "solution": "所提出的问题在科学上是合理的、提法恰当且客观的。它基于应用于生物物理系统的高分子物理和化学动力学的既定原理。所有必要的数据和简化假设都已给出，从而可以得到唯一且有意义的解。因此，我们着手进行推导和计算。\n\n该问题分为两部分。首先，我们推导分子内速率常数 $k_{\\mathrm{intra}}$ 的表达式。其次，我们使用给定的参数计算其数值。\n\n第1部分：$k_{\\mathrm{intra}}$的推导\n\n有效摩尔浓度 $c_{\\mathrm{eff}}$ 代表了要达到与相应分子内过程相同的反应速率所需的自由反应物的浓度。它由关系式 $k_{\\mathrm{intra}} = k_{\\mathrm{on}}c_{\\mathrm{eff}}$ 定义，其中 $k_{\\mathrm{on}}$ 是双分子反应的二级速率常数，$k_{\\mathrm{intra}}$ 是分子内反应的一级速率常数。\n\n我们通过令分子内系统和等效的分子间系统中，在定义的相互作用体积内找到反应性片段的概率相等，来推导 $c_{\\mathrm{eff}}$。设捕获体积为 $V_{cap}$，它是一个半径为 $a$ 的球体。\n\n在分子内情况下，单个分子包含由连接链拴系的片段 $A$ 和 $B$。在以片段 $A$ 为中心的捕获体积 $V_{cap}$ 内找到片段 $B$ 的概率，由端到端概率密度函数 $p(\\mathbf{r})$ 在该体积上的积分给出：\n$$\nP_{\\mathrm{intra}} = \\int_{V_{cap}} p(\\mathbf{r}) dV\n$$\n在分子间情况下，我们考虑一个包含自由片段 $A$ 和 $B$ 的溶液。对于一个给定的片段 $A$，在捕获体积 $V_{cap}$ 内找到的片段 $B$ 的平均数量取决于 $B$ 的摩尔浓度，我们将其设为 $c_{\\mathrm{eff}}$。$B$ 分子的数密度是 $c_{\\mathrm{eff}} N_A$。在体积 $V_{cap}$ 内 $B$ 分子的平均数量为：\n$$\nN_{\\mathrm{inter}} = c_{\\mathrm{eff}} N_A V_{cap}\n$$\n有效摩尔浓度 $c_{\\mathrm{eff}}$ 被定义为这样一个浓度，在该浓度下，这个平均分子数等于连接系统中的概率 $P_{\\mathrm{intra}}$。这种等效性将连接链对局部浓度的统计增强效应与一个宏观浓度联系起来。\n$$\nc_{\\mathrm{eff}} N_A V_{cap} = P_{\\mathrm{intra}} = \\int_{V_{cap}} p(\\mathbf{r}) dV\n$$\n解出 $c_{\\mathrm{eff}}$，得到其关于 $p(\\mathbf{r})$、$N_A$ 和捕获体积的通用表达式：\n$$\nc_{\\mathrm{eff}} = \\frac{1}{N_A V_{cap}} \\int_{V_{cap}} p(\\mathbf{r}) dV\n$$\n问题陈述中指出，我们可以假设 $a \\ll \\sqrt{\\langle r^{2}\\rangle}$，这意味着捕获半径远小于连接链的均方根端到端距离。在此条件下，概率密度 $p(\\mathbf{r})$ 在很小的积分体积 $V_{cap}$ 内近似为常数，并可以在球心 $\\mathbf{r} = \\mathbf{0}$ 处取值。\n$$\np(\\mathbf{r}) \\approx p(\\mathbf{0}) \\quad \\text{for } |\\mathbf{r}| \\le a\n$$\n积分简化为：\n$$\n\\int_{V_{cap}} p(\\mathbf{r}) dV \\approx p(\\mathbf{0}) \\int_{V_{cap}} dV = p(\\mathbf{0}) V_{cap}\n$$\n将此结果代入 $c_{\\mathrm{eff}}$ 的表达式中：\n$$\nc_{\\mathrm{eff}} = \\frac{p(\\mathbf{0}) V_{cap}}{N_A V_{cap}} = \\frac{p(\\mathbf{0})}{N_A}\n$$\n捕获体积 $V_{cap}$ 被消掉了。$p(\\mathbf{r})$ 在原点的值可从给定的高斯分布中得出：\n$$\np(\\mathbf{r}) = \\left(\\frac{3}{2\\pi \\langle r^{2}\\rangle}\\right)^{3/2}\\exp\\!\\left(-\\frac{3 r^{2}}{2\\langle r^{2}\\rangle}\\right)\n$$\n在 $\\mathbf{r} = \\mathbf{0}$ 处，$r^2=0$ 且 $\\exp(0)=1$，所以：\n$$\np(\\mathbf{0}) = \\left(\\frac{3}{2\\pi \\langle r^{2}\\rangle}\\right)^{3/2}\n$$\n使用给定的柔性聚合物关系式 $\\langle r^{2}\\rangle = 2 l_{p} L$：\n$$\np(\\mathbf{0}) = \\left(\\frac{3}{2\\pi (2 l_{p} L)}\\right)^{3/2} = \\left(\\frac{3}{4\\pi l_{p} L}\\right)^{3/2}\n$$\n这个 $p(\\mathbf{0})$ 的表达式具有逆体积的单位。如果 $l_p$ 和 $L$ 的单位是米 ($\\mathrm{m}$)，则 $p(\\mathbf{0})$ 的单位是 $\\mathrm{m^{-3}}$。得到的 $c_{\\mathrm{eff}} = p(\\mathbf{0}) / N_A$ 的单位是 $\\mathrm{mol\\,m^{-3}}$。速率常数 $k_{\\mathrm{on}}$ 的单位是 $\\mathrm{M^{-1}\\,s^{-1}}$，即 $\\mathrm{L\\,mol^{-1}\\,s^{-1}}$。为了保持单位一致性，我们必须将 $c_{\\mathrm{eff}}$ 转换为摩尔浓度 (M = $\\mathrm{mol\\,L^{-1}}$)。使用换算关系 $1\\,\\mathrm{m^3} = 10^3\\,\\mathrm{L}$：\n$$\nc_{\\mathrm{eff}} [\\mathrm{mol\\,L^{-1}}] = c_{\\mathrm{eff}} [\\mathrm{mol\\,m^{-3}}] \\times \\frac{1\\,\\mathrm{m^3}}{10^3\\,\\mathrm{L}} = \\frac{p(\\mathbf{0})}{1000 N_A}\n$$\n现在我们可以写出 $k_{\\mathrm{intra}}$ 的最终表达式：\n$$\nk_{\\mathrm{intra}} = k_{\\mathrm{on}} c_{\\mathrm{eff}} = \\frac{k_{\\mathrm{on}}}{1000 N_A} \\left(\\frac{3}{4\\pi l_{p} L}\\right)^{3/2}\n$$\n这就是所求的 $k_{\\mathrm{intra}}$ 关于 $k_{\\mathrm{on}}$、$L$ 和 $l_{p}$ 的表达式，在使用标准单位（$k_{\\mathrm{on}}$ 用 $\\mathrm{M^{-1}\\,s^{-1}}$，所有其他参数用国际单位制单位）时有效。\n\n第2部分：$k_{\\mathrm{intra}}$ 的数值估算\n\n我们已知以下数值：\n$L = 10\\,\\mathrm{nm} = 10 \\times 10^{-9}\\,\\mathrm{m}$\n$l_{p} = 0.5\\,\\mathrm{nm} = 0.5 \\times 10^{-9}\\,\\mathrm{m}$\n$k_{\\mathrm{on}} = 1.0 \\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$\n$N_{A} = 6.022 \\times 10^{23}\\,\\mathrm{mol^{-1}}$\n\n首先，我们用国际单位制计算乘积 $l_p L$：\n$$\nl_p L = (0.5 \\times 10^{-9}\\,\\mathrm{m}) \\times (10 \\times 10^{-9}\\,\\mathrm{m}) = 5.0 \\times 10^{-18}\\,\\mathrm{m^2}\n$$\n接下来，我们计算 $p(\\mathbf{0})$ 表达式中括号内的项：\n$$\n\\frac{3}{4\\pi l_{p} L} = \\frac{3}{4\\pi (5.0 \\times 10^{-18}\\,\\mathrm{m^2})} = \\frac{3}{20\\pi \\times 10^{-18}\\,\\mathrm{m^2}} \\approx 4.7746 \\times 10^{16}\\,\\mathrm{m^{-2}}\n$$\n现在我们计算 $p(\\mathbf{0})$：\n$$\np(\\mathbf{0}) = \\left(4.7746 \\times 10^{16}\\,\\mathrm{m^{-2}}\\right)^{3/2} \\approx 1.0423 \\times 10^{25}\\,\\mathrm{m^{-3}}\n$$\n接下来，我们计算以 $\\mathrm{M}$ 为单位的有效摩尔浓度 $c_{\\mathrm{eff}}$：\n$$\nc_{\\mathrm{eff}} = \\frac{p(\\mathbf{0})}{1000 N_A} = \\frac{1.0423 \\times 10^{25}\\,\\mathrm{m^{-3}}}{1000 \\times (6.022 \\times 10^{23}\\,\\mathrm{mol^{-1}})} \\approx \\frac{1.0423 \\times 10^{25}}{6.022 \\times 10^{26}}\\,\\mathrm{mol\\,L^{-1}} \\approx 0.017308\\,\\mathrm{M}\n$$\n最后，我们计算 $k_{\\mathrm{intra}}$：\n$$\nk_{\\mathrm{intra}} = k_{\\mathrm{on}} c_{\\mathrm{eff}} = (1.0 \\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}) \\times (0.017308\\,\\mathrm{M}) \\approx 17308\\,\\mathrm{s^{-1}}\n$$\n这等于 $1.7308 \\times 10^4\\,\\mathrm{s^{-1}}$。根据题目要求四舍五入到三位有效数字，我们得到最终答案。\n$$\nk_{\\mathrm{intra}} \\approx 1.73 \\times 10^4\\,\\mathrm{s^{-1}}\n$$", "answer": "$$\n\\boxed{1.73 \\times 10^{4}}\n$$", "id": "2774881"}, {"introduction": "最后的实践将理论与现代高通量实验数据相结合，这在当代合成生物学中至关重要。我们将学习如何分析深度突变扫描（DMS）数据，以构建一个预测性的结合自由能模型。通过这个练习，您将掌握如何将复杂的突变效应分解为加性贡献和上位性相互作用，这是现代蛋白质工程和定量生物学中的一项核心技能。[@problem_id:2774873]", "problem": "给定一份来自对分裂蛋白界面进行的蛋白质片段互补分析（PCA）的深度突变扫描数据。每个变体被编码为一个长度为$4$的二进制字符串，其中每个位置表示相对于野生型，在特定界面残基上的单点突变是否存在（$1$）或不存在（$0$）。每个变体的测量PCA读出值是一个在$(0,1)$范围内的无单位值，该值已被归一化，使其与平衡状态下结合复合物的比例成正比。您的任务是推断对结合自由能的加性贡献和成对上位性贡献，并为未见过的组合构建一个预测模型。\n\n使用的基本原理：\n- 两态结合的化学热力学：假设在平衡状态下存在一个未结合态和一个结合态。\n- 玻尔兹曼统计，使用热能$R T$，其中$R$是普适气体常数，$T$是绝对温度。\n- 将自由能线性分解为加性单点项和成对上位性项。\n\n假设：\n- 对于一个变体，其PCA读出值等于在一个固定的总浓度体系下该变体结合复合物的平衡比例，该体系可以在一个有效的两态模型内处理。在这些条件下，结合比例由标准结合自由能差$\\Delta G$通过玻尔兹曼统计确定。\n- 对于一个二进制突变向量为$\\mathbf{m} \\in \\{0,1\\}^4$的变体，其结合自由能遵循一个加性加成对模型：\n  $$\\Delta G(\\mathbf{m}) = \\Delta G_0 + \\sum_{i=1}^{4} a_i m_i + \\sum_{1 \\le i  j \\le 4} e_{ij} m_i m_j,$$\n  其中$\\Delta G_0$是野生型的基线自由能，单位为$\\mathrm{kcal/mol}$；$a_i$是加性系数，单位为$\\mathrm{kcal/mol}$；$e_{ij}$是成对上位性系数，单位为$\\mathrm{kcal/mol}$。\n\n热力学映射要求：\n- 从自由能差为$\\Delta G$的两态系统的玻尔兹曼统计出发，推导平衡结合比例与$\\Delta G$之间的关系。然后反转此关系，将$\\Delta G$表示为所测量的结合比例的函数。使用$R = 0.001987\\ \\mathrm{kcal/(mol \\cdot K)}$和$T = 298\\ \\mathrm{K}$。确保所有$\\Delta G$值的单位都是$\\mathrm{kcal/mol}$。为了数值稳定性，在反转映射时，将测量的比例$y$裁剪到开区间$(\\epsilon, 1-\\epsilon)$内，其中$\\epsilon = 10^{-6}$。\n\n估计要求：\n- 通过对推断出的$\\Delta G$值最小化一个Tikhonov正则化（岭）最小二乘目标函数来估计参数$\\Delta G_0$、$a_i$和$e_{ij}$：\n  $$\\min_{\\theta} \\left\\| \\mathbf{X}\\theta - \\mathbf{g} \\right\\|_2^2 + \\lambda \\left\\| \\mathbf{P}\\theta \\right\\|_2^2,$$\n  其中$\\mathbf{g}$包含训练变体的推断$\\Delta G$值，$\\mathbf{X}$是设计矩阵，其列包括一个截距项、4个加性指示变量$m_i$以及6个成对乘积$m_i m_j$（$1 \\le i  j \\le 4$），$\\theta$堆叠了$[\\Delta G_0, a_1,\\dots,a_4, e_{12}, e_{13}, e_{14}, e_{23}, e_{24}, e_{34}]^\\top$。使用$\\lambda = 0.1$。不要惩罚截距项（即，将$\\mathbf{P}$中对应的对角线元素设为$0$，所有其他对角线元素设为$1$）。\n\n预测要求：\n- 使用拟合的参数，对每个指定的测试变体预测$\\Delta G$和相应的结合比例，使用相同的热力学映射和常数。仅报告预测的结合比例。\n\n训练数据集（二进制变体字符串，测量的PCA读出值）：\n- $0000$: $0.96$\n- $1000$: $0.85$\n- $0100$: $0.88$\n- $0010$: $0.70$\n- $0001$: $0.82$\n- $1010$: $0.78$\n- $0101$: $0.70$\n- $0110$: $0.60$\n- $0011$: $0.58$\n- $1100$: $0.78$\n- $1110$: $0.40$\n- $0111$: $0.35$\n\n测试套件（用于预测的未见过的变体）：\n- 变体 A: $1011$\n- 变体 B: $1101$\n- 变体 C: $0000$\n- 变体 D: $1111$\n\n需要报告的附加诊断指标：\n- 推断的成对上位性系数$e_{13}$，单位为$\\mathrm{kcal/mol}$。\n- 所有上位性系数的绝对值之和，$\\sum_{1 \\le i  j \\le 4} \\lvert e_{ij} \\rvert$，单位为$\\mathrm{kcal/mol}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按以下顺序排列结果：\n  $$[\\text{pred\\_A},\\ \\text{pred\\_B},\\ \\text{pred\\_C},\\ \\text{pred\\_D},\\ e_{13},\\ \\sum \\lvert e_{ij} \\rvert],$$\n  其中每个$\\text{pred\\_X}$是预测的结合比例（在$(0,1)$范围内的无单位值）。所有自由能的中间计算必须以$\\mathrm{kcal/mol}$为单位，且$R = 0.001987\\ \\mathrm{kcal/(mol \\cdot K)}$，$T = 298\\ \\mathrm{K}$。", "solution": "我们从结合的两态热力学模型开始。设未结合态的自由能为$G_{\\mathrm{U}}$，结合态的自由能为$G_{\\mathrm{B}}$。定义标准结合自由能差为$\\Delta G = G_{\\mathrm{B}} - G_{\\mathrm{U}}$。在温度为$T$的热平衡状态下，玻尔兹曼统计表明结合态与未结合态的平衡概率之比由下式给出\n$$\n\\frac{p_{\\mathrm{B}}}{p_{\\mathrm{U}}} = \\exp\\left(-\\beta \\Delta G\\right),\n$$\n其中$\\beta = \\frac{1}{R T}$，$R$是普适气体常数。由于$p_{\\mathrm{B}} + p_{\\mathrm{U}} = 1$，平衡结合比例$f$为\n$$\nf = \\frac{p_{\\mathrm{B}}}{p_{\\mathrm{B}} + p_{\\mathrm{U}}} = \\frac{1}{1 + \\frac{p_{\\mathrm{U}}}{p_{\\mathrm{B}}}} = \\frac{1}{1 + \\exp\\left(\\beta \\Delta G\\right)}.\n$$\n这种logistic关系是具有自由能隙$\\Delta G$的两态配分的直接结果。\n\n为了反转该映射（将$\\Delta G$表示为$f$的函数），我们求解$\\Delta G$：\n$$\nf = \\frac{1}{1 + \\exp\\left(\\beta \\Delta G\\right)} \\quad \\Longrightarrow \\quad \\frac{1-f}{f} = \\exp\\left(\\beta \\Delta G\\right) \\quad \\Longrightarrow \\quad \\Delta G = \\frac{1}{\\beta} \\ln\\!\\left(\\frac{1-f}{f}\\right) = R T \\ln\\!\\left(\\frac{1-f}{f}\\right).\n$$\n我们采用$R = 0.001987\\ \\mathrm{kcal/(mol \\cdot K)}$和$T = 298\\ \\mathrm{K}$，因此$R T$的单位是$\\mathrm{kcal/mol}$，从而$\\Delta G$的单位也是$\\mathrm{kcal/mol}$。为了在$f$极度接近$0$或$1$时保持数值稳定性，我们在应用对数函数之前将$f$裁剪到$(\\epsilon, 1-\\epsilon)$范围内，其中$\\epsilon = 10^{-6}$。\n\n接下来，我们假设一个具有加性单点效应和成对上位性的线性自由能分解模型。对于由二进制向量$\\mathbf{m} \\in \\{0,1\\}^4$编码的变体，我们写出\n$$\n\\Delta G(\\mathbf{m}) = \\Delta G_0 + \\sum_{i=1}^{4} a_i m_i + \\sum_{1 \\le i  j \\le 4} e_{ij} m_i m_j.\n$$\n在这里，$\\Delta G_0$是野生型基线，$a_i$表示突变位置$i$的加性贡献，$e_{ij}$捕捉了当位置$i$和$j$同时突变时的成对上位性偏差。所有参数的单位都是$\\mathrm{kcal/mol}$。\n\n令$\\mathbf{g} \\in \\mathbb{R}^n$为$n$个训练变体的推断自由能向量，它是通过以下方式从测量的结合比例$\\{f_k\\}_{k=1}^n$中获得的\n$$\ng_k = R T \\ln\\!\\left(\\frac{1 - f_k}{f_k}\\right).\n$$\n构建一个设计矩阵$\\mathbf{X} \\in \\mathbb{R}^{n \\times 11}$，其列对应：一个截距项（全为1）、4个加性指示变量$m_i$以及按字典序排列的6个成对乘积$m_i m_j$，即$(1,2), (1,3), (1,4), (2,3), (2,4), (3,4)$。将参数堆叠成\n$$\n\\theta = \\begin{bmatrix} \\Delta G_0  a_1  a_2  a_3  a_4  e_{12}  e_{13}  e_{14}  e_{23}  e_{24}  e_{34} \\end{bmatrix}^\\top.\n$$\n\n我们通过岭回归来估计$\\theta$，这在$\\Delta G$上存在独立同分布的高斯噪声的高斯似然和参数（不包括截距项）上存在零均值高斯先验的条件下，是最大后验（MAP）估计。目标函数为\n$$\n\\min_{\\theta} \\left\\| \\mathbf{X}\\theta - \\mathbf{g} \\right\\|_2^2 + \\lambda \\left\\| \\mathbf{P}\\theta \\right\\|_2^2,\n$$\n其中$\\lambda = 0.1$是正则化强度，$\\mathbf{P} = \\mathrm{diag}(0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)$使得截距项不被惩罚。其闭式解为\n$$\n\\hat{\\theta} = \\left( \\mathbf{X}^\\top \\mathbf{X} + \\lambda \\mathbf{P} \\right)^{-1} \\mathbf{X}^\\top \\mathbf{g}.\n$$\n\n对于任何具有二进制编码$\\mathbf{m}$的测试变体，我们按照与$\\mathbf{X}$的列相同的顺序构建其特征向量$\\mathbf{x} \\in \\mathbb{R}^{11}$，并计算预测的自由能\n$$\n\\widehat{\\Delta G} = \\mathbf{x}^\\top \\hat{\\theta},\n$$\n然后使用正向热力学关系将其映射回预测的结合比例，\n$$\n\\hat{f} = \\frac{1}{1 + \\exp\\!\\left( \\beta \\widehat{\\Delta G} \\right)}, \\quad \\beta = \\frac{1}{R T}.\n$$\n\n实现细节：\n- 在将每个训练读出值$y$裁剪到$(\\epsilon, 1-\\epsilon)$（其中$\\epsilon = 10^{-6}$）后，将其转换为$g = R T \\ln\\!\\left(\\frac{1-y}{y}\\right)$。\n- 按照指定的特征顺序精确构建$\\mathbf{X}$。\n- 使用$\\lambda = 0.1$和未惩罚的截距项的岭回归闭式解求解$\\hat{\\theta}$。\n- 对四个测试变体$1011$、$1101$、$0000$和$1111$预测$\\hat{f}$。\n- 从$\\hat{\\theta}$中提取推断的$e_{13}$（根据指定顺序，是六个成对项中的第二个）。\n- 计算上位性幅度总和$\\sum_{1 \\le i  j \\le 4} \\lvert e_{ij} \\rvert$。\n\n最终程序将这些结果汇总到一个列表中\n$$\n[\\hat{f}_{1011},\\ \\hat{f}_{1101},\\ \\hat{f}_{0000},\\ \\hat{f}_{1111},\\ \\hat{e}_{13},\\ \\sum_{1 \\le i  j \\le 4} \\lvert \\hat{e}_{ij} \\rvert]\n$$\n并将其作为单行、逗号分隔、用方括号括起来的列表打印。按照要求，所有中间的$\\Delta G$计算都以$\\mathrm{kcal/mol}$为单位。这种方法将预测建立在第一性原理（热力学两态模型）之上，同时通过在自由能空间中进行线性建模来解析加性贡献和上位性贡献，这在物理上是有意义的，因为对于独立贡献，自由能是可加的，而上位性在该空间中自然地表示为相互作用项。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef clip01(x, eps=1e-6):\n    return min(max(x, eps), 1.0 - eps)\n\ndef variant_to_features(variant_str):\n    \"\"\"\n    Build feature vector in the order:\n    [1, m1, m2, m3, m4, m1*m2, m1*m3, m1*m4, m2*m3, m2*m4, m3*m4]\n    \"\"\"\n    m = np.array([int(c) for c in variant_str], dtype=float)\n    m1, m2, m3, m4 = m\n    features = [\n        1.0,\n        m1, m2, m3, m4,\n        m1*m2, m1*m3, m1*m4, m2*m3, m2*m4, m3*m4\n    ]\n    return np.array(features, dtype=float)\n\ndef fit_ridge(X, g, lam):\n    \"\"\"\n    Solve (X^T X + lam P) theta = X^T g\n    with P = diag(0, 1, ..., 1) to avoid penalizing intercept.\n    \"\"\"\n    n_features = X.shape[1]\n    XtX = X.T @ X\n    Xtg = X.T @ g\n    P = np.eye(n_features)\n    P[0, 0] = 0.0  # do not penalize intercept\n    A = XtX + lam * P\n    theta = np.linalg.solve(A, Xtg)\n    return theta\n\ndef predict_fraction(theta, variant_str, beta):\n    x = variant_to_features(variant_str)\n    dG = float(x @ theta)\n    # Map to fraction bound via thermodynamic relation\n    f = 1.0 / (1.0 + np.exp(beta * dG))\n    return float(f)\n\ndef solve():\n    # Physical constants\n    R = 0.001987  # kcal/(mol·K)\n    T = 298.0     # K\n    RT = R * T\n    beta = 1.0 / RT\n\n    # Regularization strength\n    lam = 0.1\n\n    # Training data: (variant_str, normalized PCA readout)\n    training_data = [\n        (\"0000\", 0.96),\n        (\"1000\", 0.85),\n        (\"0100\", 0.88),\n        (\"0010\", 0.70),\n        (\"0001\", 0.82),\n        (\"1010\", 0.78),\n        (\"0101\", 0.70),\n        (\"0110\", 0.60),\n        (\"0011\", 0.58),\n        (\"1100\", 0.78),\n        (\"1110\", 0.40),\n        (\"0111\", 0.35),\n    ]\n\n    # Build design matrix X and target vector g (ΔG)\n    X_rows = []\n    g_vals = []\n    for var, y in training_data:\n        y_clipped = clip01(y, eps=1e-6)\n        # Invert fraction -> ΔG in kcal/mol\n        dG = RT * np.log((1.0 - y_clipped) / y_clipped)\n        X_rows.append(variant_to_features(var))\n        g_vals.append(dG)\n    X = np.vstack(X_rows)\n    g = np.array(g_vals, dtype=float)\n\n    # Fit ridge regression in ΔG space\n    theta = fit_ridge(X, g, lam)\n\n    # Test variants for prediction\n    test_variants = [\"1011\", \"1101\", \"0000\", \"1111\"]\n    preds = [predict_fraction(theta, v, beta) for v in test_variants]\n\n    # Extract e_13 and sum of absolute epistasis magnitudes\n    # Parameter ordering: [ΔG0, a1, a2, a3, a4, e12, e13, e14, e23, e24, e34]\n    e13 = float(theta[6])\n    epistasis_coeffs = theta[5:11]\n    sum_abs_e = float(np.sum(np.abs(epistasis_coeffs)))\n\n    results = preds + [e13, sum_abs_e]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2774873"}]}