{"hands_on_practices": [{"introduction": "定向进化的第一步是构建一个多样化的突变体库。这个练习将指导你完成一项基本但至关重要的任务：如何为一个特定的基因，将期望的平均突变数量转化为实验（如易错PCR）中所需的每碱基错误率。掌握这一计算是从理论目标到实际实验方案的关键一步。[@problem_id:2761288]", "problem": "在一个定向进化项目中，你计划使用易错聚合酶链式反应（PCR）来生成一个单基因的突变体库。假设每个基因拷贝只有一个有效的诱变掺入步骤，这意味着在整个基因长度上，每个位置都经历一个诱变掺入事件，该事件可以以相同的概率独立地引入一个错误。设基因长度为 $1.2\\,\\mathrm{kb}$，目标文库每个基因拷贝平均有 $1.5$ 个核苷酸替换。\n\n仅使用以下基本原则：\n- 基因有 $L$ 个位置（碱基对），这里 $L = 1.2\\,\\mathrm{kb}$。\n- 每个碱基都是一个独立的伯努利试验，在每个有效的诱变掺入步骤中，每个碱基的错误概率为 $p$。\n- 每个基因的总突变数是 $L$ 个独立伯努利试验的总和，其期望值是各个期望值的总和。\n\n从第一性原理出发，推导为达到每个基因指定的平均突变数，每个有效的诱变掺入步骤所需的单碱基错误概率 $p$。将你的最终答案表示为无单位小数，并四舍五入到四位有效数字。", "solution": "该问题涉及在给定长度的基因中，由每个碱基具有特定突变概率的过程所产生的预期突变数。\n\n设 $L$ 为基因的长度，单位为碱基对。问题说明 $L = 1.2\\,\\mathrm{kb}$。由于 $1\\,\\mathrm{kb}$ 等于 $1000$ 个碱基对，所以长度为：\n$$L = 1.2 \\times 1000 = 1200 \\text{ 碱基对}$$\n设 $p$ 为每个有效的诱变掺入步骤的单碱基错误概率。这是我们必须确定的量。\n\n根据问题的原则，任何单个碱基位置发生突变的事件都是一个独立的伯努利试验。让我们定义一组随机变量 $\\{X_i\\}_{i=1}^{L}$，其中 $X_i$ 对应于第 $i$ 个碱基位置的结果。\n变量 $X_i$ 可以取两个值：\n- 如果在位置 $i$ 发生突变，则 $X_i = 1$。\n- 如果在位置 $i$ 没有发生突变，则 $X_i = 0$。\n\n在任何给定位置发生突变的概率是 $p$。因此，每个 $X_i$ 的概率质量函数为：\n$$P(X_i = 1) = p$$\n$$P(X_i = 0) = 1 - p$$\n根据定义，单个伯努利试验的期望值 $E[X_i]$ 是：\n$$E[X_i] = (1 \\times P(X_i = 1)) + (0 \\times P(X_i = 0)) = (1 \\times p) + (0 \\times (1-p)) = p$$\n\n单个基因拷贝中的总突变数 $M$ 是这 $L$ 个独立试验结果的总和：\n$$M = \\sum_{i=1}^{L} X_i$$\n问题要求设置条件，使得每个基因拷贝的平均突变数达到目标值 $\\mu = 1.5$。一个随机变量的“平均值”是其期望值 $E[M]$。因此，我们必须计算 $M$ 的期望值。\n\n利用期望的线性性质，即随机变量之和的期望等于它们各自期望之和，我们有：\n$$E[M] = E\\left[\\sum_{i=1}^{L} X_i\\right] = \\sum_{i=1}^{L} E[X_i]$$\n由于假设每个位置具有相同的单碱基错误概率 $p$，所以对于所有的 $i=1, 2, \\dots, L$，期望 $E[X_i]$ 都是相同的。\n$$E[X_i] = p$$\n将此代入总和中：\n$$E[M] = \\sum_{i=1}^{L} p = L \\cdot p$$\n问题指定目标平均突变数为 $\\mu = 1.5$。因此，我们令 $E[M] = \\mu$：\n$$\\mu = L \\cdot p$$\n我们被要求找出满足此条件的 $p$ 值。我们可以重新排列方程来解出 $p$：\n$$p = \\frac{\\mu}{L}$$\n现在，我们代入给定的数值：$\\mu = 1.5$ 和 $L = 1200$。\n$$p = \\frac{1.5}{1200}$$\n进行计算：\n$$p = 0.00125$$\n问题要求最终答案四舍五入到四位有效数字。数字 $0.00125$ 有三位有效数字（数字 $1$、$2$ 和 $5$）。要将此结果表示为四位有效数字，我们必须在末尾添加一个零。\n$$p = 0.001250$$\n这就是在每个 $1.2\\,\\mathrm{kb}$ 的基因上实现平均 $1.5$ 个突变所需的每个有效诱变掺入步骤的单碱基错误概率。", "answer": "$$\\boxed{0.001250}$$", "id": "2761288"}, {"introduction": "创建文库后，下一步是通过施加选择压力来富集功能性变体。这个练习提供了一个量化模型，帮助你理解具有活性的变体如何通过多轮选择实现指数级富集。通过这个练习，你将深入掌握选择过程背后核心的数学原理，并理解为何定向进化如此强大。[@problem_id:2761248]", "problem": "一项基于存活的定向进化实验筛选了一个大型文库，该文库包含两类变体：具有催化活性的和无活性的。在每一轮筛选中，每个分子以其类别条件概率独立存活，存活下来的分子随后被扩增并无偏好地标准化回相同的总种群大小，因此轮后的类别频率仅反映存活情况。设活性变体的初始比例为 $f_{A,0}$，无活性变体的初始比例为 $f_{I,0} = 1 - f_{A,0}$。活性变体的每轮存活概率为 $p_{A} = 0.3$，无活性变体的每轮存活概率为 $p_{I} = 0.01$，且这些概率在各轮中保持不变。假设在各轮和各变体之间，存活事件是独立的，不存在类别间的相互转换，并且扩增相对于活性是无偏好的。\n\n定义第 $r$ 轮后的活性与无活性变体优势比为 $R_{r} = f_{A,r} / f_{I,r}$，其中 $f_{A,r}$ 和 $f_{I,r}$ 分别是活性和无活性变体在轮后的频率。定义经过 $r$ 轮后的富集度为相对于初始优势比的倍数变化，即 $E_{r} = R_{r} / R_{0}$。\n\n从这些定义和条件概率的基本规则出发，推导出 $E_{3}$，并计算当 $p_{A} = 0.3$ 和 $p_{I} = 0.01$ 时的值。将最终答案表示为一个精确值，不进行四舍五入，不带单位。", "solution": "推导过程从所提供的定义开始。设 $N$ 为任何一轮标准化后文库中的分子总数。在第 $r-1$ 轮之后，活性变体的数量为 $N_{A, r-1} = N \\cdot f_{A, r-1}$，无活性变体的数量为 $N_{I, r-1} = N \\cdot f_{I, r-1}$。\n\n在第 $r$ 轮的筛选步骤中，这些种群将接受筛选。每个类别中存活分子的预期数量为：\n- 活性变体的预期存活数量：$N_{A, \\text{surv}} = N_{A, r-1} \\cdot p_{A}$\n- 无活性变体的预期存活数量：$N_{I, \\text{surv}} = N_{I, r-1} \\cdot p_{I}$\n\n问题陈述扩增是无偏好的。这意味着在扩增过程中，活性分子与无活性分子的数量之比保持不变。因此，第 $r$ 轮后的频率之比仅由存活者的比例决定。第 $r$ 轮后活性变体的频率 $f_{A,r}$ 与 $N_{A, \\text{surv}}$ 成正比，无活性变体的频率 $f_{I,r}$ 与 $N_{I, \\text{surv}}$ 成正比。\n\n第 $r$ 轮后的优势比 $R_{r}$ 定义为频率之比：\n$$R_{r} = \\frac{f_{A,r}}{f_{I,r}}$$\n因为频率与各类别的分子数量成正比，所以这个比率等同于分子数量的比率：\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}}$$\n在第 $r$ 轮扩增后的分子数 $N_{A,r}$ 和 $N_{I,r}$ 与筛选步骤中的存活者数量成正比。因此，它们的比率为：\n$$R_{r} = \\frac{N_{A,r}}{N_{I,r}} = \\frac{N_{A, \\text{surv}}}{N_{I, \\text{surv}}} = \\frac{N_{A, r-1} \\cdot p_{A}}{N_{I, r-1} \\cdot p_{I}}$$\n我们认识到比率 $N_{A, r-1} / N_{I, r-1}$ 正是前一轮后的优势比 $R_{r-1}$。这得出了优势比的递推关系：\n$$R_{r} = \\left(\\frac{N_{A, r-1}}{N_{I, r-1}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{r-1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\n这是一个等比数列。我们可以通过递归应用该关系，用初始优势比 $R_{0}$ 来表示 $R_{r}$：\n$$R_{1} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)$$\n$$R_{2} = R_{1} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = \\left(R_{0} \\cdot \\frac{p_{A}}{p_{I}}\\right) \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right) = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{2}$$\n通过归纳法，经过 $r$ 轮后的优势比由下式给出：\n$$R_{r} = R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\n富集度 $E_{r}$ 定义为相对于初始优势比的倍数变化，即 $E_{r} = R_{r} / R_{0}$。代入 $R_{r}$ 的表达式：\n$$E_{r} = \\frac{R_{0} \\cdot \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}}{R_{0}}$$\n初始优势比 $R_{0}$ 被消去，这证实了初始活性变体比例 $f_{A,0}$ 不是必需的。$r$ 轮后富集度的通用公式为：\n$$E_{r} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{r}$$\n问题要求计算 $r=3$ 轮后的富集度 $E_{3}$。我们代入 $r=3$：\n$$E_{3} = \\left(\\frac{p_{A}}{p_{I}}\\right)^{3}$$\n现在，我们代入给定的存活概率数值，$p_{A} = 0.3$ 和 $p_{I} = 0.01$。\n$$E_{3} = \\left(\\frac{0.3}{0.01}\\right)^{3}$$\n概率之比为：\n$$\\frac{0.3}{0.01} = \\frac{3 \\times 10^{-1}}{1 \\times 10^{-2}} = 3 \\times 10^{1} = 30$$\n将此值代回 $E_{3}$ 的表达式中：\n$$E_{3} = (30)^{3} = 30 \\times 30 \\times 30 = 900 \\times 30 = 27000$$\n3轮后的富集度为 $27000$。这是一个精确值。", "answer": "$$\\boxed{27000}$$", "id": "2761248"}, {"introduction": "现代定向进化严重依赖于微流控液滴等超高通量筛选技术，但这也引入了新的挑战，即如何有效地将细胞或分子分配到独立的反应隔间中。这个练习将探讨随机区室化这一关键问题，并向你展示如何利用泊松分布来优化上样密度。通过解决这个问题，你将学会如何最大化产生“单克隆”（即每个液滴只含一个变体）液滴的比例，这是确保筛选准确性的前提。[@problem_id:2761318]", "problem": "在一个基于液滴的定向进化实验中，一个包含 $N$ 个独立变体（例如，细胞或展示酶的微珠）的文库通过随机混合被分隔到 $M$ 个大小相同的液滴中。每个变体独立地进入任何给定液滴的概率为 $1/M$。令 $K$ 表示装入特定液滴中的变体数量。单克隆区室被定义为恰好含有 $1$ 个变体的区室，即 $K=1$。在具有固定载量密度 $\\lambda = N/M$ 的大文库、多液滴极限下，单个液滴的占据统计可以很好地用泊松过程来近似，这可以通过独立随机封装下二项分布的极限来证明。\n\n从独立放置模型出发，并仅使用在 $N$ 和 $M$ 很大且 $\\lambda = N/M$ 固定的情况下有效的基础概率极限，推导单克隆区室的比例 $P(K=1)$ 作为 $\\lambda$ 函数的解析表达式。然后确定使该比例最大化的 $\\lambda \\ge 0$ 的值。仅报告使 $P(K=1)$ 最大化的 $\\lambda$ 值作为你的最终答案。以精确数值形式提供最优值；无需四舍五入，也无需单位。", "solution": "令 $N$ 为变体总数， $M$ 为液滴总数。一个变体进入特定液滴的过程是一个随机事件。对于任何单个变体，假设所有液滴都是等可能的目标，它被封装到一个特定液滴中的概率是 $p = 1/M$。\n\n我们考虑一个任意选择的单个液滴。在该液滴中发现的变体数量（由随机变量 $K$ 表示）可以用二项分布来建模。$N$ 个变体中的每一个都代表一次独立的伯努利试验，其中“成功”对应于变体进入指定的液滴。每次试验的成功概率是 $p = 1/M$。因此，$K$ 的概率质量函数（PMF）由二项式公式给出：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n问题指出，我们关心的是 $N$ 和 $M$ 很大，而它们的比率，即平均载量密度 $\\lambda = N/M$，保持为固定常数的极限情况。在这种情况下，泊松分布作为二项分布的极限而出现。我们将对此进行形式化证明。\n\n我们代入 $p = 1/M$，并且由于 $M=N/\\lambda$，我们有 $p=\\lambda/N$。二项概率质量函数变为：\n$$P(K=k) = \\binom{N}{k} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n我们可以展开二项式系数 $\\binom{N}{k} = \\frac{N!}{k!(N-k)!} = \\frac{N(N-1)\\cdots(N-k+1)}{k!}$。于是概率质量函数为：\n$$P(K=k) = \\frac{N(N-1)\\cdots(N-k+1)}{k!} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n重新整理各项，我们得到：\n$$P(K=k) = \\frac{\\lambda^k}{k!} \\left( \\frac{N(N-1)\\cdots(N-k+1)}{N^k} \\right) \\left(1-\\frac{\\lambda}{N}\\right)^N \\left(1-\\frac{\\lambda}{N}\\right)^{-k}$$\n现在，对于固定的整数 $k$，我们计算当 $N \\to \\infty$ 时每一部分的极限：\n1.  $\\lim_{N\\to\\infty} \\frac{N(N-1)\\cdots(N-k+1)}{N^k} = \\lim_{N\\to\\infty} \\left(1 \\cdot \\left(1-\\frac{1}{N}\\right) \\cdots \\left(1-\\frac{k-1}{N}\\right)\\right) = 1$。\n2.  根据指数函数的基本极限定义，$\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^N = \\exp(-\\lambda)$。\n3.  $\\lim_{N\\to\\infty} \\left(1-\\frac{\\lambda}{N}\\right)^{-k} = (1-0)^{-k} = 1$。\n\n将这些极限相乘，得到泊松分布的概率质量函数：\n$$\\lim_{N\\to\\infty} P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n因此，单个液滴中的变体数量 $K$ 服从均值为 $\\lambda$ 的泊松分布。\n\n单克隆区室被定义为恰好含有一个变体的区室，即 $K=1$。这类区室的比例由 $P(K=1)$ 给出。让我们将这个比例定义为 $\\lambda$ 的函数，记为 $f(\\lambda)$：\n$$f(\\lambda) = P(K=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\lambda \\exp(-\\lambda)$$\n为了找到使该比例在 $\\lambda \\ge 0$ 上最大化的 $\\lambda$ 值，我们必须使用微积分。我们计算 $f(\\lambda)$ 关于 $\\lambda$ 的一阶导数：\n$$\\frac{df}{d\\lambda} = \\frac{d}{d\\lambda} \\left( \\lambda \\exp(-\\lambda) \\right)$$\n使用乘法法则，我们发现：\n$$\\frac{df}{d\\lambda} = (1)\\exp(-\\lambda) + \\lambda(-\\exp(-\\lambda)) = (1-\\lambda)\\exp(-\\lambda)$$\n为了找到临界点，我们将导数设为零：\n$$(1-\\lambda)\\exp(-\\lambda) = 0$$\n由于对于所有实数 $\\lambda$，$\\exp(-\\lambda)$ 都是严格为正的，所以该方程仅在 $1-\\lambda = 0$ 时成立，这得到临界点 $\\lambda=1$。\n\n为了确认这是一个最大值，我们使用二阶导数检验。我们计算 $f(\\lambda)$ 的二阶导数：\n$$\\frac{d^2f}{d\\lambda^2} = \\frac{d}{d\\lambda} \\left( (1-\\lambda)\\exp(-\\lambda) \\right) = (-1)\\exp(-\\lambda) + (1-\\lambda)(-\\exp(-\\lambda)) = (\\lambda-2)\\exp(-\\lambda)$$\n在临界点 $\\lambda=1$ 处计算二阶导数：\n$$\\left.\\frac{d^2f}{d\\lambda^2}\\right|_{\\lambda=1} = (1-2)\\exp(-1) = -\\exp(-1) = -\\frac{1}{e}$$\n由于二阶导数为负（$-\\frac{1}{e}  0$），函数 $f(\\lambda)$ 在 $\\lambda=1$ 处有一个局部最大值。\n\n最后，我们必须检查定义域 $\\lambda \\ge 0$ 的边界。\n在 $\\lambda=0$ 处，$f(0) = 0 \\cdot \\exp(0) = 0$。\n在极限 $\\lambda \\to \\infty$ 时，$f(\\lambda) = \\lambda \\exp(-\\lambda) \\to 0$。\n在临界点的值是 $f(1) = 1 \\cdot \\exp(-1) = 1/e > 0$。由于函数在下边界处为零，在无穷远处趋于零，并且在两者之间为正，因此在 $\\lambda=1$ 处的局部最大值是定义域 $\\lambda \\ge 0$ 上的全局最大值。\n\n因此，使单克隆区室比例最大化的载量密度是 $\\lambda=1$。", "answer": "$$\\boxed{1}$$", "id": "2761318"}]}