{"hands_on_practices": [{"introduction": "要想定量理解并设计CRISPRi/a系统，第一步是能够量化其核心组件——dCas9蛋白——在细胞内的浓度及其与靶标的结合程度。本练习将引导你完成一个典型的定量生物学工作流程：从模拟的蛋白质印迹（Western blot）实验数据出发，计算出dCas9在细胞内的浓度，并利用质量作用定律估算其在目标启动子上的占据率。通过这个练习[@problem_id:2726338]，你将把宏观的实验测量与微观的分子状态联系起来，这是定量合成生物学的一项基本技能。", "problem": "一个细菌菌株经过改造，用于簇状规律间隔短回文重复序列干扰（CRISPRi）。该技术使用失活的Cas9（dCas9），通过单导向RNA（sgRNA）靶向单拷贝染色体上的一个启动子。在稳态指数生长期，启动子被dCas9-sgRNA复合物占据的时间分数，可以近似为该复合物对结合位点的平衡分数占据率。假设dCas9-sgRNA复合物与靶位点之间是一对一结合，脱靶位点的隔离效应可以忽略不计，且时间平均占据率等于平衡占据率。\n\n你使用纯化的dCas9标准品进行蛋白质免疫印迹（Western blot）分析，获得了条带强度与dCas9质量之间的线性校准关系：强度 $I$（任意单位）等于斜率 $\\beta$ 乘以质量 $m$（单位为ng），即 $I = \\beta\\, m$。对于从 $N_{\\text{cells}}$ 个细胞制备的裂解液，你测得的强度为 $I_{\\text{sample}}$。\n\n提供以下已测量和已知的量：\n- 校准斜率 $\\beta = 1.00 \\times 10^{7}$ AU/ng。\n- 来自 $N_{\\text{cells}} = 1.00 \\times 10^{7}$ 个细胞的样品强度 $I_{\\text{sample}} = 5.314 \\times 10^{8}$ AU。\n- dCas9的摩尔质量 $M = 1.60 \\times 10^{5}$ g/mol。\n- 装载了sgRNA且能够结合DNA的dCas9的比例 $f_{\\text{load}} = 0.80$。\n- 每个细胞的有效胞质体积 $V_{\\text{cell}} = 1.00 \\times 10^{-15}$ L。\n- dCas9-sgRNA与靶启动子结合的解离常数 $K_{d} = 2.00 \\times 10^{-9}$ M。\n- 阿伏伽德罗常数 $N_{A} = 6.022 \\times 10^{23}$ mol$^{-1}$。\n\n从质量作用定律和解离常数的定义出发，推导启动子被dCas9-sgRNA占据的平衡分数占据率的表达式，该表达式用游离复合物浓度和 $K_{d}$ 表示。然后，利用上述数据，并假设游离复合物浓度约等于总装载复合物浓度（因为每个细胞的靶位点数量与dCas9分子数量相比可以忽略不计），估算在体内启动子被占据的时间分数，结果以0到1之间的小数表示（无单位）。将你的最终答案四舍五入到四位有效数字。", "solution": "该问题要求推导平衡分数占据率的表达式，并对细菌中基于dCas9的CRISPRi系统的该占据率进行数值估算。将首先验证其前提，然后进行系统性求解。\n\n该问题陈述具有科学依据，提法严谨且客观。它基于化学平衡的基本原理（质量作用定律）以及分子和定量生物学的标准技术（蛋白质免疫印迹，CRISPRi）。所提供的数据在量纲上一致，并且对于细菌系统而言在物理上是合理的。明确说明了简化的假设，即dCas9-sgRNA复合物的游离浓度约等于其总浓度，这是一个标准的、合理的近似，适用于配体（dCas9复合物）远多于受体（启动子靶位点）的系统。因此，该问题被认为是有效的，并将提供解答。\n\n首先，我们推导平衡分数占据率 $\\theta$ 的表达式。dCas9-sgRNA复合物（我们记为 $C$）与启动子靶位点（$P$）的结合可以用可逆反应表示：\n$$ P + C \\rightleftharpoons PC $$\n其中 $PC$ 是启动子与复合物的结合状态。\n\n解离常数 $K_d$ 由平衡时的质量作用定律定义：\n$$ K_d = \\frac{[P]_{\\text{free}} [C]_{\\text{free}}}{[PC]} $$\n其中 $[P]_{\\text{free}}$、$[C]_{\\text{free}}$ 和 $[PC]$ 分别是游离启动子、游离复合物和结合启动子的平衡浓度。\n\n分数占据率 $\\theta$ 定义为被复合物占据的总启动子位点的分数：\n$$ \\theta = \\frac{[PC]}{[P]_{\\text{total}}} $$\n启动子的总浓度 $[P]_{\\text{total}}$ 是其游离形式和结合形式的浓度之和：\n$$ [P]_{\\text{total}} = [P]_{\\text{free}} + [PC] $$\n根据 $K_d$ 的定义，我们可以将 $[P]_{\\text{free}}$ 表示为：\n$$ [P]_{\\text{free}} = \\frac{K_d [PC]}{[C]_{\\text{free}}} $$\n将此代入启动子的质量平衡方程，得到：\n$$ [P]_{\\text{total}} = \\frac{K_d [PC]}{[C]_{\\text{free}}} + [PC] = [PC] \\left( \\frac{K_d}{[C]_{\\text{free}}} + 1 \\right) = [PC] \\left( \\frac{K_d + [C]_{\\text{free}}}{[C]_{\\text{free}}} \\right) $$\n现在，将 $[P]_{\\text{total}}$ 的这个表达式代入 $\\theta$ 的定义中：\n$$ \\theta = \\frac{[PC]}{[PC] \\left( \\frac{K_d + [C]_{\\text{free}}}{[C]_{\\text{free}}} \\right)} = \\frac{[C]_{\\text{free}}}{[C]_{\\text{free}} + K_d} $$\n这就是所要求的分数占据率表达式。\n\n接下来，我们必须根据实验数据计算 $[C]_{\\text{free}}$ 的值。问题陈述我们可以假设 $[C]_{\\text{free}}$ 约等于已装载的（有活性的）dCas9-sgRNA复合物的总浓度 $[C]_{\\text{total, loaded}}$。这个假设是合理的，因为靶启动子在每个细胞中以单拷贝形式存在，这意味着其浓度与dCas9蛋白的典型表达水平相比极低。总启动子位点的浓度为 $[P]_{\\text{total}} = (1 \\text{ 位点/细胞}) / (N_A V_{\\text{cell}}) \\approx 1.66 \\times 10^{-9}$ M，这比我们将要计算的dCas9浓度小几个数量级。\n\n我们继续计算 $[C]_{\\text{total, loaded}}$。\n1.  计算裂解液样品中dCas9的总质量 $m_{\\text{dCas9}}$。Western blot校准关系为 $I = \\beta m$。\n    $$ m_{\\text{dCas9}} = \\frac{I_{\\text{sample}}}{\\beta} = \\frac{5.314 \\times 10^{8} \\text{ AU}}{1.00 \\times 10^{7} \\text{ AU/ng}} = 53.14 \\text{ ng} $$\n    将此质量转换为克：\n    $$ m_{\\text{dCas9}} = 53.14 \\text{ ng} \\times \\frac{10^{-9} \\text{ g}}{1 \\text{ ng}} = 5.314 \\times 10^{-8} \\text{ g} $$\n\n2.  计算单个细胞内活性dCas9-sgRNA复合物的平均浓度。这可以通过首先计算每个细胞的活性复合物的平均摩尔数，然后除以细胞体积来完成。\n    总质量 $m_{\\text{dCas9}}$ 是从 $N_{\\text{cells}}$ 个细胞的裂解液中获得的。每个细胞的dCas9平均质量为：\n    $$ m_{\\text{per cell}} = \\frac{m_{\\text{dCas9}}}{N_{\\text{cells}}} = \\frac{5.314 \\times 10^{-8} \\text{ g}}{1.00 \\times 10^{7} \\text{ cells}} $$\n    每个细胞的dCas9平均摩尔数是该质量除以摩尔质量 $M$：\n    $$ n_{\\text{per cell}} = \\frac{m_{\\text{per cell}}}{M} = \\frac{m_{\\text{dCas9}}}{M \\times N_{\\text{cells}}} = \\frac{5.314 \\times 10^{-8} \\text{ g}}{(1.60 \\times 10^{5} \\text{ g/mol}) \\times (1.00 \\times 10^{7})} $$\n    这些dCas9分子中只有一部分（比例为 $f_{\\text{load}}$）装载了sgRNA并具有活性。因此，每个细胞的活性复合物的平均摩尔数为：\n    $$ n_{\\text{complex, per cell}} = n_{\\text{per cell}} \\times f_{\\text{load}} = \\frac{m_{\\text{dCas9}} \\times f_{\\text{load}}}{M \\times N_{\\text{cells}}} $$\n    这种活性复合物的浓度 $[C]_{\\text{total, loaded}}$ 是每个细胞的摩尔数除以每个细胞的体积 $V_{\\text{cell}}$：\n    $$ [C]_{\\text{total, loaded}} = \\frac{n_{\\text{complex, per cell}}}{V_{\\text{cell}}} = \\frac{m_{\\text{dCas9}} \\times f_{\\text{load}}}{M \\times N_{\\text{cells}} \\times V_{\\text{cell}}} $$\n    代入给定值：\n    $$ [C]_{\\text{total, loaded}} = \\frac{(5.314 \\times 10^{-8} \\text{ g}) \\times 0.80}{(1.60 \\times 10^{5} \\text{ g/mol}) \\times (1.00 \\times 10^{7}) \\times (1.00 \\times 10^{-15} \\text{ L})} $$\n    $$ [C]_{\\text{total, loaded}} = \\frac{4.2512 \\times 10^{-8} \\text{ g}}{1.60 \\times 10^{-3} \\text{ g} \\cdot \\text{L} / \\text{mol}} = 2.657 \\times 10^{-5} \\text{ mol/L} $$\n    所以，$[C]_{\\text{free}} \\approx 2.657 \\times 10^{-5}$ M。\n\n3.  最后，使用推导的表达式计算分数占据率 $\\theta$，其中 $[C]_{\\text{free}} = 2.657 \\times 10^{-5}$ M，给定的 $K_d = 2.00 \\times 10^{-9}$ M。\n    $$ \\theta = \\frac{[C]_{\\text{free}}}{[C]_{\\text{free}} + K_d} = \\frac{2.657 \\times 10^{-5} \\text{ M}}{2.657 \\times 10^{-5} \\text{ M} + 2.00 \\times 10^{-9} \\text{ M}} $$\n    $$ \\theta = \\frac{2.657 \\times 10^{-5}}{2.657 \\times 10^{-5} + 0.000200 \\times 10^{-5}} = \\frac{2.657 \\times 10^{-5}}{2.6572 \\times 10^{-5}} $$\n    $$ \\theta \\approx 0.999924732 $$\n问题要求将最终答案四舍五入到四位有效数字。\n$$ \\theta \\approx 0.9999 $$\n该值表示启动子被dCas9-sgRNA复合物占据的时间分数。我们遵循了四舍五入到四位有效数字的明确指令，尽管从输入数据（特别是具有两位有效数字的 $f_{\\text{load}}$）进行严格的不确定性传播可能会建议一个精度较低的结果。", "answer": "$$ \\boxed{0.9999} $$", "id": "2726338"}, {"introduction": "dCas9介导的转录阻遏（CRISPRi）最直接的机制之一是空间位阻，即dCas9复合物占据了RNA聚合酶（RNAP）的结合位点，从而阻止转录的发生。这个练习将帮助你使用竞争性结合模型来量化这一过程[@problem_id:2726365]。通过将dCas9和RNAP视为争夺同一启动子结合位点的竞争者，你可以推导出转录输出如何依赖于这两种分子的浓度和结合亲和力，从而深刻理解基因调控中的定量权衡关系。", "problem": "一个单拷贝细菌启动子可以被核糖核酸聚合酶（RNAP）或一个被向导RNA编程的无催化活性的CRISPR相关蛋白9（dCas9）所占据，该向导RNA与RNAP结合位点重叠，从而阻止了同时占据。这通过空间位阻实现了成簇规律间隔短回文重复序列干扰（CRISPRi）。假设系统处于平衡结合状态，为单价结合到一个位点，无协同性，并且是具有固定游离浓度的充分混合体系。当RNAP结合时，转录以恒定速率起始；否则起始速率为零。\n\n仅使用质量作用定律和互斥状态的平衡统计占据率，计算在给定以下参数时的期望转录起始速率：\n- RNAP与启动子的解离常数：$K_{d}^{\\mathrm{R}} = 10$ nM。\n- dCas9与重叠位点的解离常数：$K_{d}^{\\mathrm{Cas}} = 5$ nM。\n- 游离RNAP浓度：$[\\mathrm{R}] = 50$ nM。\n- 游离dCas9:向导复合物浓度：$[\\mathrm{Cas}] = 100$ nM。\n- RNAP结合时的最大起始速率：$r_{\\max} = 60$ 次起始/分钟。\n\n以“次起始/分钟”为单位表示最终的转录起始速率。将您的答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，将首先对问题陈述进行严格的验证程序。\n\n**第1步：提取已知条件**\n问题陈述中逐字提供了以下信息：\n- 一个单拷贝细菌启动子可以被核糖核酸聚合酶（RNAP）或无催化活性的CRISPR相关蛋白9（dCas9）占据，但不能同时被占据（互斥占据）。\n- 系统处于平衡状态。\n- 结合是单价的，结合到一个位点，没有协同性。\n- 系统是一个充分混合的体系，游离浓度固定。\n- 当RNAP结合时，转录以恒定速率起始；否则，速率为零。\n- RNAP解离常数：$K_{d}^{\\mathrm{R}} = 10$ nM。\n- dCas9解离常数：$K_{d}^{\\mathrm{Cas}} = 5$ nM。\n- 游离RNAP浓度：$[\\mathrm{R}] = 50$ nM。\n- 游离dCas9:向导复合物浓度：$[\\mathrm{Cas}] = 100$ nM。\n- RNAP结合时的最大起始速率：$r_{\\max} = 60$ 次起始/分钟。\n- 目标是计算期望的转录起始速率。\n- 最终答案必须四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题描述了一个用于基因调控的竞争性结合的标准生物物理模型，特别是通过空间位阻实现的CRISPR干扰（CRISPRi）。在此背景下，使用平衡统计力学和质量作用定律来模拟配体-受体相互作用是一种基本且正确的方法。所提供的参数对于这样的生物系统来说在合理范围内。\n- **良态问题**：该问题是良态的。它提供了所有必要的参数（$K_d$值、游离配体浓度、最大速率），以确定一个唯一、稳定且有意义的解。假设（平衡、固定的游离浓度、互斥结合）都已明确陈述，使得问题可解。\n- **客观性**：该问题使用精确、客观和定量的语言陈述。它不含任何主观性或非科学性主张。\n\n**第3步：结论与行动**\n该问题具有科学有效性、良态性和客观性。它没有违反任何无效标准。因此，将推导一个正式的解。\n\n**解题推导**\n启动子，我们记为 $P$，可以存在于以下三种互斥状态之一：\n1.  未结合（游离启动子）：$P$\n2.  被RNAP结合：$P \\cdot R$\n3.  被dCas9-向导复合物结合：$P \\cdot Cas$\n\n系统处于平衡状态，因此这些状态的相对布居可以用质量作用定律来描述。解离常数定义如下：\n对于RNAP结合反应 $P + R \\rightleftharpoons P \\cdot R$：\n$$K_{d}^{\\mathrm{R}} = \\frac{[P][\\mathrm{R}]}{[P \\cdot R]}$$\n对于dCas9结合反应 $P + Cas \\rightleftharpoons P \\cdot Cas$：\n$$K_{d}^{\\mathrm{Cas}} = \\frac{[P][\\mathrm{Cas}]}{[P \\cdot Cas]}$$\n此处，$[\\mathrm{R}]$ 和 $[\\mathrm{Cas}]$ 分别是RNAP和dCas9的游离浓度，它们是给定的固定常数。\n\n我们关心的是发现启动子被RNAP结合的概率，记为 $p(P \\cdot R)$。这个概率是处于RNAP结合状态的启动子占所有可能启动子状态总布居的分数。\n$$p(P \\cdot R) = \\frac{[P \\cdot R]}{[P] + [P \\cdot R] + [P \\cdot Cas]}$$\n为了简化这个表达式，我们可以将分子和分母同时除以游离启动子的浓度 $[P]$：\n$$p(P \\cdot R) = \\frac{\\frac{[P \\cdot R]}{[P]}}{1 + \\frac{[P \\cdot R]}{[P]} + \\frac{[P \\cdot Cas]}{[P]}}$$\n根据解离常数的定义，我们可以重新整理得到比值 $\\frac{[P \\cdot R]}{[P]}$ 和 $\\frac{[P \\cdot Cas]}{[P]}$ 的表达式：\n$$\\frac{[P \\cdot R]}{[P]} = \\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}}$$\n$$\\frac{[P \\cdot Cas]}{[P]} = \\frac{[\\mathrm{Cas}]}{K_{d}^{\\mathrm{Cas}}}$$\n将这些代入概率表达式，得到用已知的游离浓度和解离常数表示的RNAP结合状态的统计占据率：\n$$p(P \\cdot R) = \\frac{\\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}}}{1 + \\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}} + \\frac{[\\mathrm{Cas}]}{K_{d}^{\\mathrm{Cas}}}}$$\n期望的转录起始速率 $\\langle r \\rangle$ 是每个状态的速率与其状态概率加权之和。根据问题描述，只有当RNAP结合时，转录起始速率为 $r_{\\max}$，而对于未结合和dCas9结合的状态，速率为0。\n$$\\langle r \\rangle = (0) \\cdot p(P) + (r_{\\max}) \\cdot p(P \\cdot R) + (0) \\cdot p(P \\cdot Cas)$$\n$$\\langle r \\rangle = r_{\\max} \\cdot p(P \\cdot R)$$\n因此，期望速率的最终表达式为：\n$$\\langle r \\rangle = r_{\\max} \\left( \\frac{\\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}}}{1 + \\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}} + \\frac{[\\mathrm{Cas}]}{K_{d}^{\\mathrm{Cas}}}} \\right)$$\n现在，我们将给定的数值代入此表达式。首先，我们计算无量纲的占据项：\n$$ \\frac{[\\mathrm{R}]}{K_{d}^{\\mathrm{R}}} = \\frac{50 \\text{ nM}}{10 \\text{ nM}} = 5 $$\n$$ \\frac{[\\mathrm{Cas}]}{K_{d}^{\\mathrm{Cas}}} = \\frac{100 \\text{ nM}}{5 \\text{ nM}} = 20 $$\n接下来，我们计算RNAP结合的概率 $p(P \\cdot R)$：\n$$ p(P \\cdot R) = \\frac{5}{1 + 5 + 20} = \\frac{5}{26} $$\n最后，我们计算期望的转录起始速率：\n$$ \\langle r \\rangle = r_{\\max} \\cdot p(P \\cdot R) = 60 \\frac{\\text{次起始}}{\\text{分钟}} \\times \\frac{5}{26} $$\n$$ \\langle r \\rangle = \\frac{300}{26} \\frac{\\text{次起始}}{\\text{分钟}} = \\frac{150}{13} \\frac{\\text{次起始}}{\\text{分钟}} $$\n为了得到最终的数值答案，我们进行除法运算，并按要求四舍五入到四位有效数字。\n$$ \\langle r \\rangle \\approx 11.53846... \\frac{\\text{次起始}}{\\text{分钟}} $$\n四舍五入到四位有效数字得到 $11.54$ 次起始/分钟。", "answer": "$$\\boxed{11.54}$$", "id": "2726365"}, {"introduction": "基因表达并非一个平滑、恒定的过程，而是在单细胞水平上表现出固有的随机性，通常以“转录爆发”的形式发生。CRISPRa系统如何影响这种随机动态？它仅仅是增加了爆发的频率，还是也增大了每次爆发的“尺寸”？本练习是一个基于代码的实践，你将分析模拟的单细胞荧光数据，通过计算矩（如均值和方差）并运用自助法（bootstrapping）进行统计推断，来揭示CRISPRa调控基因表达的深层机制[@problem_id:2726318]。这项任务将让你接触到定量单细胞生物学的前沿分析方法。", "problem": "给定一个基于脱氧核糖核酸酶失活的规律成簇间隔短回文重复序列 (dCas9) 介导的激活 (CRISPRa) 的建模与推断任务。在许多单细胞实验中，具有转录爆发的双态启动子模型下的稳态蛋白质丰度（与荧光成正比）可以很好地由负二项分布描述。以下广为接受的事实是本问题的起点。\n\n- 在稳态下的转录爆发模型中，单细胞计数可以由均值为 $\\,\\mu\\,$、方差为 $\\,\\sigma^2\\,$ 的负二项分布很好地近似，并满足\n  $$\\sigma^2 \\;=\\; \\mu \\;+\\; \\frac{\\mu^2}{k},$$\n  其中 $\\,k\\,$ 是离散（形状）参数。\n- 在爆发的标准映射中，$\\,\\mu = r\\,b\\,$，其中 $\\,r\\,$ 是爆发频率（缩放到蛋白质水平的有效启动子开启速率），$\\,b\\,$ 是平均爆发大小（每次启动子开启事件产生的蛋白质数量）。在此映射中，$\\,k=r\\,$ 且法诺因子 $\\,F \\equiv \\sigma^2/\\mu = 1 + b\\,$，因此在固定的 $\\,b\\,$ 下改变 $\\,r\\,$（爆发频率）会使 $\\,F\\,$ 保持不变，而改变 $\\,b\\,$ 会使 $\\,F\\,$ 增加。在此，这些关系被视为关于爆发性基因表达稳态统计的、经过充分检验的观测事实。\n\n您的任务是编写一个程序，该程序在给定 CRISPRa 前后合成的单细胞荧光分布的情况下，执行基于矩的分析，以推断激活是增加了爆发频率、爆发大小，还是两者兼有，或者数据是否无定论。您必须完全基于从样本计算出的统计量以及上述关系来做出决策，而不是基于生成参数。\n\n每个测试用例的数据生成协议：\n- 令 $\\,r_{\\mathrm{pre}}\\,$ 和 $\\,b_{\\mathrm{pre}}\\,$ 表示激活前的爆发频率和爆发大小，$\\,r_{\\mathrm{post}}\\,$ 和 $\\,b_{\\mathrm{post}}\\,$ 表示激活后的值。\n- 对于每种条件（激活前和激活后），通过从负二项分布中抽样生成 $\\,N\\,$ 个单细胞荧光值，使用以下参数化：对于整数 $\\,n\\,$ 和成功概率 $\\,p\\,$，样本 $\\,X \\sim \\mathrm{NB}(n,p)\\,$ 的均值为 $\\,\\mathbb{E}[X] = n(1-p)/p\\,$，方差为 $\\,\\mathrm{Var}(X) = n(1-p)/p^2\\,$。使用对应关系 $\\,n = r\\,$ 和 $\\,p = 1/(1+b)\\,$，使得最终分布的均值为 $\\,\\mu = r\\,b\\,$，法诺因子为 $\\,F = 1 + b\\,$。将荧光视为无单位计数（不需要物理单位）。\n- 为保证可复现性，使用固定的基础种子 $\\,12345\\,$，并对于测试用例索引 $\\,i\\,$（从 $\\,0\\,$ 开始），将 $\\,i\\,$ 加到基础种子上用于随机数生成。对于每个条件，使用该种子独立抽取 $\\,N\\,$ 个样本。\n\n为每个测试用例需实现的估计与决策程序：\n1. 计算激活前后的样本均值 $\\,\\widehat{\\mu}\\,$ 和无偏样本方差 $\\,\\widehat{\\sigma}^2\\,$。\n2. 计算激活前后的样本法诺因子 $\\,\\widehat{F} = \\widehat{\\sigma}^2/\\widehat{\\mu}\\,$。\n3. 使用以下公式估计离散参数：\n   $$\\widehat{k} \\;=\\; \\begin{cases}\n   \\dfrac{\\widehat{\\mu}^2}{\\widehat{\\sigma}^2 - \\widehat{\\mu}},  \\text{若 } \\widehat{\\sigma}^2  \\widehat{\\mu},\\\n$$6pt]\n   +\\infty,  \\text{其他情况。}\n   \\end{cases}$$\n4. 使用带有 $\\,B\\,$ 次重采样的非参数自举法，计算差异 $\\,\\Delta \\mu = \\widehat{\\mu}_{\\mathrm{post}} - \\widehat{\\mu}_{\\mathrm{pre}}\\,$、$\\,\\Delta F = \\widehat{F}_{\\mathrm{post}} - \\widehat{F}_{\\mathrm{pre}}\\,$ 和 $\\,\\Delta k = \\widehat{k}_{\\mathrm{post}} - \\widehat{k}_{\\mathrm{pre}}\\,$ 的 $\\,95\\%\\,$ 置信区间。每次自举法复制都在激活前和激活后的样本内独立地进行有放回重采样，重新计算统计量，并存储差异。置信区间是自举法差异分布的第 $\\,2.5\\,$ 和第 $\\,97.5\\,$ 百分位数。为保证可复现性，使用与数据生成相同的、针对每个用例的随机种子来为自举法重采样提供种子。\n5. 用于分类的决策逻辑，为每个测试用例编码为一个整数：\n   - 如果 $\\,\\Delta \\mu\\,$ 的 $\\,95\\%\\,$ 置信区间包含 $\\,0\\,$（即下界 $\\,\\le 0\\,$），则输出 $\\,0\\,$（无法确定激活是否增加了表达）。\n   - 否则，如果 $\\,\\Delta F\\,$ 的 $\\,95\\%\\,$ 置信区间包含 $\\,0\\,$，且 $\\,\\Delta k\\,$ 的 $\\,95\\%\\,$ 置信区间的下界 $\\,\\,0\\,$，则输出 $\\,1\\,$（仅频率增加）。\n   - 否则，如果 $\\,\\Delta F\\,$ 的 $\\,95\\%\\,$ 置信区间的下界 $\\,\\,0\\,$，且 $\\,\\Delta k\\,$ 的 $\\,95\\%\\,$ 置信区间包含 $\\,0\\,$，则输出 $\\,2\\,$（仅大小增加）。\n   - 否则，如果 $\\,\\Delta F\\,$ 和 $\\,\\Delta k\\,$ 的 $\\,95\\%\\,$ 置信区间的下界均 $\\,\\,0\\,$，则输出 $\\,3\\,$（频率和大小均增加）。\n   - 否则，输出 $\\,0\\,$（无定论）。\n\n测试套件：\n- 所有用例均使用 $\\,B = 1000\\,$ 次自举法复制和每个条件下 $\\,N = 1500\\,$ 个细胞。定义 $\\,4\\,$ 个用例，其参数如下，每个用例使用种子 $\\,12345 + i\\,$，其中用例索引 $\\,i \\in \\{0,1,2,3\\}$：\n  1. 用例 $\\,0\\,$（仅频率增加）：$\\,r_{\\mathrm{pre}}=5\\,$, $\\,b_{\\mathrm{pre}}=2.0\\,$, $\\,r_{\\mathrm{post}}=10\\,$, $\\,b_{\\mathrm{post}}=2.0\\,$.\n  2. 用例 $\\,1\\,$（仅大小增加）：$\\,r_{\\mathrm{pre}}=5\\,$, $\\,b_{\\mathrm{pre}}=2.0\\,$, $\\,r_{\\mathrm{post}}=5\\,$, $\\,b_{\\mathrm{post}}=4.0\\,$.\n  3. 用例 $\\,2\\,$（两者均增加）：$\\,r_{\\mathrm{pre}}=5\\,$, $\\,b_{\\mathrm{pre}}=2.0\\,$, $\\,r_{\\mathrm{post}}=10\\,$, $\\,b_{\\mathrm{post}}=3.0\\,$.\n  4. 用例 $\\,3\\,$（接近边界，大小变化微小）：$\\,r_{\\mathrm{pre}}=5\\,$, $\\,b_{\\mathrm{pre}}=2.0\\,$, $\\,r_{\\mathrm{post}}=5\\,$, $\\,b_{\\mathrm{post}}=2.1\\,$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，格式为方括号内以逗号分隔的整数列表，例如 $\\,\\,[1,2,3,0]\\,\\,$。不应打印任何其他文本。", "solution": "所呈现的问题是合成生物学领域中一个定义明确的计算任务，具体涉及 dCas9 介导的基因激活 (CRISPRa) 的分析。它在科学上基于标准的转录爆发双态模型，在数学上是一致的，并为其解决方案提供了完整的规范。因此，该问题被认为是 **有效的**。我们现在开始阐述解决方案。\n\n核心任务是通过分析合成单细胞表达数据的矩，来推断基因激活的模式——即它是调节了爆发频率、爆发大小，还是两者兼而有之。这种推断的基础在于转录爆发模型已确立的统计特性。\n\n**理论框架**\n\n在转录爆发模型下，稳态时的单细胞蛋白质水平可以由负二项分布有效地描述。该模型的关键参数是爆发频率 $r$（对应于启动子切换到激活状态的速率）和平均爆发大小 $b$（在一个激活期间产生的平均蛋白质数量）。平均表达水平 $\\mu$ 和方差 $\\sigma^2$ 与这些参数相关。问题陈述提供了以下基本关系，我们将其作为给定条件接受：\n\n1.  平均表达为 $\\mu = r \\cdot b$。\n2.  方差遵循 $\\sigma^2 = \\mu + \\frac{\\mu^2}{k}$，其中 $k$ 是离散参数。\n3.  关键在于，该模型将爆发参数映射到统计参数，即 $k = r$。\n4.  法诺因子定义为 $F \\equiv \\frac{\\sigma^2}{\\mu}$，它与爆发大小的关系为 $F = 1 + b$。\n\n根据这些关系，我们可以基于潜在生物学参数（$r$ 和 $b$）的变化，推断出可观察统计量（$k$ 和 $F$）的预期变化：\n-   当爆发大小（$b$）恒定时，爆发频率（$r$）的增加将导致离散参数 $k$ 增加，但法诺因子 $F$ 保持不变。均值 $\\mu$ 将会增加。\n-   当爆发频率（$r$）恒定时，爆发大小（$b$）的增加将导致法诺因子 $F$ 增加，但离散参数 $k$ 保持不变。均值 $\\mu$ 也会增加。\n-   $r$ 和 $b$ 同时增加将导致所有三个量：$\\mu$、$k$ 和 $F$ 的增加。\n\n我们的算法将从数据中估计这些统计量，并使用置信区间来确定观察到的变化是否具有统计显著性。\n\n**算法和统计实现**\n\n每个测试用例的执行过程如下：\n\n1.  **数据生成**：对于每种条件（激活前和激活后），我们从负二项分布中生成 $N$ 个样本。问题指定了 $\\mathrm{NB}(n, p)$ 参数化，其中均值为 $n(1-p)/p$。为匹配我们的模型，我们设置成功次数 $n = r$，成功概率 $p = 1/(1+b)$。这确保了生成的数据均值为 $\\mu = r \\cdot b$，法诺因子为 $F = 1+b$。为保证可复现性，对于测试用例索引 $i$，使用 $12345 + i$ 作为随机数生成器的种子。\n\n2.  **矩估计**：根据为激活前和激活后条件生成的样本，我们计算矩的估计值：\n    -   样本均值：$\\widehat{\\mu} = \\frac{1}{N} \\sum_{j=1}^{N} x_j$。\n    -   无偏样本方差：$\\widehat{\\sigma}^2 = \\frac{1}{N-1} \\sum_{j=1}^{N} (x_j - \\widehat{\\mu})^2$。\n    -   样本法诺因子：$\\widehat{F} = \\widehat{\\sigma}^2 / \\widehat{\\mu}$。\n    -   离散参数估计（通过矩量法）：$\\widehat{k} = \\frac{\\widehat{\\mu}^2}{\\widehat{\\sigma}^2 - \\widehat{\\mu}}$。这里处理一个特殊情况：如果抽样波动导致 $\\widehat{\\sigma}^2 \\le \\widehat{\\mu}$，我们设置 $\\widehat{k} = +\\infty$，因为有限的正离散需要过离散（$\\sigma^2  \\mu$）。\n\n3.  **不确定性量化**：为评估变化的统计显著性，我们采用非参数自举法。该过程对 $B = 1000$ 次复制执行：\n    -   对于每次复制，我们从原始的‘激活前’数据集中有放回地抽取 $N$ 个样本，并从‘激活后’数据集中有放回地抽取 $N$ 个样本。\n    -   对于每个自举法重采样的数据集，我们重新计算统计量 $\\widehat{\\mu}^*$、$\\widehat{F}^*$ 和 $\\widehat{k}^*$。\n    -   然后我们计算这次复制的差异：$\\Delta \\mu^* = \\widehat{\\mu}^*_{\\mathrm{post}} - \\widehat{\\mu}^*_{\\mathrm{pre}}$、$\\Delta F^* = \\widehat{F}^*_{\\mathrm{post}} - \\widehat{F}^*_{\\mathrm{pre}}$ 和 $\\Delta k^* = \\widehat{k}^*_{\\mathrm{post}} - \\widehat{k}^*_{\\mathrm{pre}}$。\n    -   这 $B$ 个差异的集合构成了每个统计量的自举分布。每个 $\\Delta$ 的 $95\\%$ 置信区间由其各自自举分布的第 $2.5$ 和第 $97.5$ 百分位数确定。\n\n4.  **决策逻辑**：基于计算出的置信区间 (CI)，根据严格的规则层次进行分类：\n    -   首先，我们检查激活的证据。如果 $\\Delta \\mu$ 的置信区间下界小于或等于 $0$，我们无法断定表达量已增加。结果为无定论，编码为 $0$。\n    -   如果表达量显著增加（$\\Delta \\mu$ 的置信区间下界  0），我们继续确定其机制：\n        -   如果 $\\Delta F$ 的置信区间包含 $0$（爆发大小无显著变化）并且 $\\Delta k$ 的置信区间下界大于 $0$（爆发频率显著增加），我们将其分类为仅频率增加，编码为 $1$。\n        -   如果 $\\Delta F$ 的置信区间下界大于 $0$（爆发大小显著增加）并且 $\\Delta k$ 的置信区间包含 $0$（爆发频率无显著变化），我们将其分类为仅大小增加，编码为 $2$。\n        -   如果 $\\Delta F$ 和 $\\Delta k$ 的置信区间下界均大于 $0$（两者均显著增加），我们将其分类为频率和大小均增加，编码为 $3$。\n    -   如果以上确定机制的具体条件均不满足，则结果被视为无定论，编码为 $0$。\n\n这个结构化的、基于矩的推断流程为从单细胞数据中剖析 CRISPRa 的调控效应提供了一种定量的、统计上严谨的方法。最终的实现将封装这整套逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 0 (frequency-only increase)\n        {'r_pre': 5.0, 'b_pre': 2.0, 'r_post': 10.0, 'b_post': 2.0},\n        # Case 1 (size-only increase)\n        {'r_pre': 5.0, 'b_pre': 2.0, 'r_post': 5.0, 'b_post': 4.0},\n        # Case 2 (both increase)\n        {'r_pre': 5.0, 'b_pre': 2.0, 'r_post': 10.0, 'b_post': 3.0},\n        # Case 3 (near-boundary, small size change)\n        {'r_pre': 5.0, 'b_pre': 2.0, 'r_post': 5.0, 'b_post': 2.1},\n    ]\n\n    base_seed = 12345\n    N = 1500  # Number of cells per condition\n    B = 1000  # Number of bootstrap replicates\n\n    results = []\n    for i, params in enumerate(test_cases):\n        seed = base_seed + i\n        result_code = analyze_case(params, N, B, seed)\n        results.append(result_code)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_stats(samples):\n    \"\"\"\n    Calculates sample mean, variance, Fano factor, and dispersion parameter.\n    \"\"\"\n    if len(samples)  2:\n        return np.nan, np.nan, np.nan, np.nan\n        \n    mu_hat = np.mean(samples)\n    sigma2_hat = np.var(samples, ddof=1) # Unbiased sample variance\n\n    if mu_hat == 0:\n        f_hat = np.nan\n    else:\n        f_hat = sigma2_hat / mu_hat\n    \n    if sigma2_hat > mu_hat and mu_hat > 0:\n        k_hat = mu_hat**2 / (sigma2_hat - mu_hat)\n    else:\n        k_hat = np.inf\n        \n    return mu_hat, sigma2_hat, f_hat, k_hat\n\ndef analyze_case(params, N, B, seed):\n    \"\"\"\n    Performs data generation, statistical analysis, and decision making for one case.\n    \"\"\"\n    # For reproducibility, seed the random number generator for this case.\n    # This seed will be used for both data generation and bootstrapping.\n    rng = np.random.default_rng(seed)\n\n    # 1. Data Generation\n    # Parameter mapping: n = r, p = 1 / (1 + b)\n    n_pre = params['r_pre']\n    p_pre = 1.0 / (1.0 + params['b_pre'])\n    samples_pre = rng.negative_binomial(n_pre, p_pre, size=N)\n\n    n_post = params['r_post']\n    p_post = 1.0 / (1.0 + params['b_post'])\n    samples_post = rng.negative_binomial(n_post, p_post, size=N)\n\n    # 4. Bootstrap procedure\n    bootstrap_diffs_mu = np.zeros(B)\n    bootstrap_diffs_f = np.zeros(B)\n    bootstrap_diffs_k = np.zeros(B)\n\n    for i in range(B):\n        # Resample with replacement\n        resample_pre = rng.choice(samples_pre, size=N, replace=True)\n        resample_post = rng.choice(samples_post, size=N, replace=True)\n\n        # Recalculate statistics for bootstrap samples\n        mu_pre_boot, _, f_pre_boot, k_pre_boot = calculate_stats(resample_pre)\n        mu_post_boot, _, f_post_boot, k_post_boot = calculate_stats(resample_post)\n\n        # Store differences\n        bootstrap_diffs_mu[i] = mu_post_boot - mu_pre_boot\n        bootstrap_diffs_f[i] = f_post_boot - f_pre_boot\n        \n        # Handle infinities in k difference\n        diff_k = k_post_boot - k_pre_boot\n        if np.isinf(k_pre_boot) and np.isinf(k_post_boot):\n             bootstrap_diffs_k[i] = 0.0 # Define inf - inf as 0\n        else:\n             bootstrap_diffs_k[i] = diff_k\n\n    # Compute 95% Confidence Intervals\n    ci_mu = np.percentile(bootstrap_diffs_mu, [2.5, 97.5])\n    # Filter out NaNs that may arise if a bootstrap sample has all zeros for mu\n    valid_f_diffs = bootstrap_diffs_f[~np.isnan(bootstrap_diffs_f)]\n    valid_k_diffs = bootstrap_diffs_k[~np.isnan(bootstrap_diffs_k)]\n    \n    ci_f = np.percentile(valid_f_diffs, [2.5, 97.5])\n    ci_k = np.percentile(valid_k_diffs, [2.5, 97.5])\n\n    # 5. Decision Logic\n    # If the 95% CI for Δμ includes 0 (i.e., lower bound = 0)\n    if ci_mu[0] = 0:\n        return 0\n\n    # Else, if the 95% CI for ΔF includes 0 and the lower bound of the CI for Δk is > 0\n    f_ci_includes_zero = ci_f[0] = 0 and ci_f[1] >= 0\n    k_ci_lower_bound_positive = ci_k[0] > 0\n    if f_ci_includes_zero and k_ci_lower_bound_positive:\n        return 1\n\n    # Else, if lower bound of CI for ΔF is > 0 and the CI for Δk includes 0\n    f_ci_lower_bound_positive = ci_f[0] > 0\n    k_ci_includes_zero = ci_k[0] = 0 and ci_k[1] >= 0\n    if f_ci_lower_bound_positive and k_ci_includes_zero:\n        return 2\n\n    # Else, if the lower bounds of the CIs for both ΔF and Δk are > 0\n    if f_ci_lower_bound_positive and k_ci_lower_bound_positive:\n        return 3\n\n    # Else, inconclusive\n    return 0\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2726318"}]}