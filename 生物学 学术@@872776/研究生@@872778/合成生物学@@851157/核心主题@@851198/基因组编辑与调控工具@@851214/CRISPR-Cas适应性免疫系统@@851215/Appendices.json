{"hands_on_practices": [{"introduction": "任何免疫系统面临的核心挑战之一是区分“自我”与“非我”。对于CRISPR-Cas系统而言，这意味着在有效靶向入侵噬菌体DNA的同时，必须避免对宿主自身基因组发起毁灭性的攻击。这个练习引导我们通过一个基础概率模型，来量化CRISPR系统发生自身免疫的风险，从而揭示进化如何通过调整间隔序列（spacer）长度和PAM序列的特异性来精妙地平衡免疫防御与自身安全 [@problem_id:2725171]。", "problem": "细菌宿主利用成簇规律间隔短回文重复序列（CRISPR）和CRISPR相关（Cas）核酸酶的适应性免疫系统，该系统通过与长度为 $L$ 的间隔序列（spacer）精确互补来识别外源DNA，并需要一个长度为 $m$ 的相邻原型间隔子邻近基序（Protospacer Adjacent Motif, PAM）。为避免自身免疫，宿主基因组中不得含有任何既与间隔序列完全匹配又拥有有效PAM的基因组位点。考虑一个长度为 $N$ 个核苷酸的单一环状染色体，将其建模为一个独立同分布的序列，核苷酸频率为 $\\mathbf{p}=(p_{\\mathrm{A}},p_{\\mathrm{C}},p_{\\mathrm{G}},p_{\\mathrm{T}})$，其中 $\\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b = 1$。一个新获得的间隔序列是从相同的核苷酸分布 $\\mathbf{p}$ 中独立抽取的。PAM由一个简并模式进行位置特异性定义：对于每个PAM位置 $i \\in \\{1,\\dots,m\\}$，一个集合 $S_i \\subseteq \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 指定了该位置允许的核苷酸。如果一个长度为 $L+m$ 的基因组窗口，其前 $L$ 个核苷酸与间隔序列完全匹配，且其后 $m$ 个核苷酸满足PAM的简并性要求（即，对于所有 $i \\in \\{1,\\dots,m\\}$，第 $i$ 个PAM位置上的核苷酸属于 $S_i$），则称该窗口为自我靶向窗口。假设核酸酶只识别这一种方向（PAM紧接在原型间隔子下游）并作用于单链。\n\n将基因组建模为从 $\\mathbf{p}$ 中独立抽取的序列，并在稀有事件情景下，将不同的长度为 $L+m$ 的窗口视为近似独立的试验。仅使用基础概率原理（独立性、乘法法则和稀有事件的泊松近似），推导错误自我靶向率的闭式解析表达式，该率定义为基因组中存在至少一个自我靶向窗口的概率。您的表达式必须写成 $N$、$L$、$m$、$\\mathbf{p}$ 和简并模式 $\\{S_i\\}_{i=1}^{m}$ 的函数。请以单一解析表达式的形式提供最终答案。不要引入任何额外的参数或经验常数。无需进行数值计算。", "solution": "该问题已经过严格验证，被认为适合进行分析。\n\n**步骤1：提取已知条件**\n- 宿主基因组：长度为 $N$ 的单一环状染色体。\n- 基因组模型：独立同分布 (i.i.d.) 序列。\n- 核苷酸频率：$\\mathbf{p}=(p_{\\mathrm{A}},p_{\\mathrm{C}},p_{\\mathrm{G}},p_{\\mathrm{T}})$ 且 $\\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b = 1$。\n- 间隔序列：长度为 $L$，从相同的分布 $\\mathbf{p}$ 中独立抽取。\n- 原型间隔子邻近基序 (PAM)：长度为 $m$。\n- PAM定义：对于每个位置 $i \\in \\{1,\\dots,m\\}$，存在一个允许的核苷酸集合 $S_i \\subseteq \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$。\n- 自我靶向窗口：一个长度为 $L+m$ 的基因组窗口，其前 $L$ 个核苷酸与间隔序列匹配，后 $m$ 个核苷酸满足PAM的简并性要求。\n- 建模假设：\n    1. 核酸酶只识别原型间隔子下游的PAM。\n    2. 不同的长度为 $L+m$ 的窗口被视为近似独立的试验。\n    3. 系统处于稀有事件情景中，这为使用泊松近似提供了依据。\n- 目标：推导错误自我靶向率的闭式解析表达式，该率定义为基因组中存在至少一个自我靶向窗口的概率。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了CRISPR-Cas9靶点识别的一个标准且简化的概率模型，这是合成生物学中的一个基本课题。该问题提法恰当，所有必要的参数（$N$、$L$、$m$、$\\mathbf{p}$、$\\{S_i\\}$）和建模假设都定义清晰。语言客观且正式。该问题避免了所有形式的无效性：它在事实上并非不成立，是可形式化且相关的，是完整的，在给定的理想化条件下是科学上可信的，并且结构良好。\n\n**步骤3：结论与行动**\n问题有效。将推导一个正式的解法。\n\n**推导**\n目标是求出基因组中至少出现一个自我靶向位点的概率。我们将此概率记为 $P(\\text{self-target})$。这对应于 $P(X \\ge 1)$，其中 $X$是代表基因组中自我靶向位点总数的随机变量。\n\n问题指定使用稀有事件的泊松近似。根据这个框架，如果我们有 $K$ 次独立或弱相关的试验，每次成功的概率很小，为 $p$，那么成功总数可以用均值为 $\\lambda = Kp$ 的泊松分布建模。观察到至少一次成功的概率则为 $1 - P(X=0) = 1 - \\exp(-\\lambda)$。\n\n首先，我们必须确定单个随机选择的长度为 $L+m$ 的基因组窗口是一个自我靶向位点的概率，我们称之为 $p_{st}$。一个窗口是自我靶向的，需要满足两个独立的条件：\n1.  其前 $L$ 个核苷酸（原型间隔子）必须与新获得的间隔序列的序列完全匹配。\n2.  其后 $m$ 个核苷酸必须满足PAM识别标准。\n\n我们来计算每个条件的概率。\n\n**1. 间隔序列匹配概率 ($P_{\\text{spacer}}$)**\n间隔序列和基因组序列都是从相同的核苷酸分布 $\\mathbf{p} = (p_{\\mathrm{A}}, p_{\\mathrm{C}}, p_{\\mathrm{G}}, p_{\\mathrm{T}})$ 中抽取的独立同分布序列。我们需要求出基因组中一个特定的 $L$-聚体与一个特定的 $L$-聚体间隔序列匹配的概率。考虑单个位置。如果基因组中的一个核苷酸与间隔序列中的一个核苷酸都是'A'，或都是'C'等，它们就匹配。由于间隔序列和基因组的抽取是独立的，单个位置匹配的概率是：\n$$ P(\\text{match at 1 position}) = p_{\\mathrm{A}} \\cdot p_{\\mathrm{A}} + p_{\\mathrm{C}} \\cdot p_{\\mathrm{C}} + p_{\\mathrm{G}} \\cdot p_{\\mathrm{G}} + p_{\\mathrm{T}} \\cdot p_{\\mathrm{T}} = \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 $$\n由于原型间隔子-间隔序列比对中的所有 $L$ 个位置都是独立的试验，因此基因组窗口中整个长度为 $L$ 的原型间隔子与间隔序列匹配的概率是：\n$$ P_{\\text{spacer}} = \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L $$\n\n**2. 有效PAM的概率 ($P_{\\text{PAM}}$)**\nPAM的固定长度为 $m$，由位置特异性简并模式 $\\{S_i\\}_{i=1}^m$ 定义。对于基因组窗口PAM序列中的每个位置 $i$，核苷酸必须属于集合 $S_i$。在给定基因组位置上的一个核苷酸满足PAM位置 $i$ 约束条件的概率是允许的核苷酸的频率之和：\n$$ P(\\text{valid nucleotide at PAM position } i) = \\sum_{b \\in S_i} p_b $$\n由于PAM中 $m$ 个位置的核苷酸是独立的，一个随机选择的 $m$-聚体满足PAM定义的总概率是每个位置概率的乘积：\n$$ P_{\\text{PAM}} = \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n\n**3. 单个自我靶向窗口的概率 ($p_{st}$)**\n基因组窗口的原型间隔子区域和PAM区域是相邻的，它们的序列由独立的核苷酸抽取决定。因此，间隔序列匹配事件和PAM匹配事件是独立的。单个窗口成为自我靶向窗口的总概率 $p_{st}$ 是它们各自概率的乘积：\n$$ p_{st} = P_{\\text{spacer}} \\times P_{\\text{PAM}} = \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n\n**4. 应用泊松近似**\n细菌染色体是环状的，长度为 $N$。对于一个长度为 $L+m$ 的窗口，有 $N$ 个可能的起始位置。我们将这 $N$ 个窗口视为 $N$ 次近似独立的试验。整个基因组中自我靶向窗口的期望数量 $\\lambda$ 是试验次数乘以单次试验的成功概率：\n$$ \\lambda = N \\cdot p_{st} = N \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) $$\n假设自我靶向窗口的数量 $X$ 服从参数为 $\\lambda$ 的泊松分布，即 $X \\sim \\text{Poisson}(\\lambda)$。\n\n错误自我靶向率是找到至少一个此类窗口的概率，即 $P(X \\ge 1)$。这是找到零个此类窗口的事件 $P(X=0)$ 的互补事件。对于泊松分布，$P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。\n$$ P(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda) $$\n因此，错误自我靶向率为：\n$$ P(\\text{self-target}) = P(X \\ge 1) = 1 - P(X=0) = 1 - \\exp(-\\lambda) $$\n代入 $\\lambda$ 的完整表达式，我们得到错误自我靶向率的最终闭式表达式。", "answer": "$$ \\boxed{1 - \\exp\\left( -N \\left( \\sum_{b \\in \\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}} p_b^2 \\right)^L \\prod_{i=1}^{m} \\left( \\sum_{b \\in S_i} p_b \\right) \\right)} $$", "id": "2725171"}, {"introduction": "CRISPR-Cas复合物与靶标的结合并非一个简单的“开/关”事件，尤其是在面对不完全匹配的序列时。这个练习深入探讨了Cas复合物结合带有错配的靶标后所发生的复杂动力学竞争。通过对干扰（cleavage）、解离（dissociation）和启动适应性免疫（priming）这几个随机过程进行建模，我们可以理解该系统如何根据匹配质量做出精细的生物学决策 [@problem_id:2725185]。", "problem": "一个细菌的成簇规律间隔短回文重复序列（Clustered Regularly Interspaced Short Palindromic Repeats, CRISPR）和CRISPR相关（Cas）I-E型系统利用CRISPR相关抗病毒防御复合体（Cascade）结合到原间隔序列邻近基序（Protospacer Adjacent Motif, PAM）旁边的原间隔序列上。Cascade结合后，可能发生两个相互竞争的随机事件：解离（R环的丢失）和通过干扰（Cas3介导的切割）实现的目标降解。当CRISPR RNA与原间隔序列之间存在错配时，干扰作用可能受损，而如果Cascade保持结合足够长的时间，则可能触发一个较慢的适应性途径（“引导”）。\n\n假设以下基于关于大分子结合中无记忆跃迁的、经过充分检验的生物物理学事实的最小动力学模型：\n- 解离时间是一个指数随机变量 $T_{\\mathrm{off}} \\sim \\mathrm{Exp}(k_{\\mathrm{off}})$，其速率为 $k_{\\mathrm{off}}$。\n- 干扰切割时间是一个指数随机变量 $T_{\\mathrm{int}} \\sim \\mathrm{Exp}(k_{\\mathrm{int}})$，其速率为 $k_{\\mathrm{int}}$。\n- 在给定依赖于错配的速率的条件下，$T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 是独立的。\n- 如果结合的复合物持续时间至少达到一个停留时间阈值 $\\tau_{p}$，则引导被确定性地触发，即如果在 $\\tau_{p}$ 时刻之前既未发生解离也未发生干扰，则引导在该时刻发生。如果干扰先发生，则不会触发引导。如果在 $\\tau_{p}$ 之前发生解离，则不会触发引导。\n\n设原间隔序列长度为 $L = 32$ 个核苷酸，其“种子”区域位于位置 $1$ 到 $8$。设错配谱由错配位置集合 $\\{2,7,10,15,23,28\\}$ 给出。使用以下与种子区域敏感性增强和远端效应减弱相一致的错配到速率的映射关系：\n- 加权的非种子区域错配使用位置权重 $w_{i}$，定义如下\n  - 对于 $i \\in \\{9,\\dots,20\\}$，$w_{i} = 0.5$，\n  - 对于 $i \\in \\{21,\\dots,32\\}$，$w_{i} = 0.2$。\n- 定义种子区域错配数 $M_{s} = \\sum_{i=1}^{8} x_{i}$ 和加权的非种子区域错配和 $M_{n} = \\sum_{i=9}^{32} w_{i} x_{i}$，其中 $x_{i} \\in \\{0,1\\}$ 表示在位置 $i$ 处存在一个错配。\n\n假设一个次优的PAM，它通过固定的因子降低干扰并破坏结合的稳定性，以及完美匹配的基线速率如下：\n- 基线解离速率 $k_{\\mathrm{off}}^{0} = 0.02\\,\\mathrm{s}^{-1}$，\n- 基线干扰速率 $k_{\\mathrm{int}}^{0} = 0.20\\,\\mathrm{s}^{-1}$，\n- PAM失稳因子 $\\delta_{\\mathrm{PAM}} = 1.5$，乘以 $k_{\\mathrm{off}}$，\n- PAM干扰衰减因子 $\\gamma_{\\mathrm{PAM}} = 0.70$，乘以 $k_{\\mathrm{int}}$，\n- 种子区罚分和非种子区罚分：\n  - $k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp\\!\\big(\\alpha_{s} M_{s} + \\alpha_{n} M_{n}\\big)\\,\\delta_{\\mathrm{PAM}}$，其中 $\\alpha_{s} = \\ln(5)$ 且 $\\alpha_{n} = \\ln(2)$，\n  - $k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp\\!\\big(-\\beta_{s} M_{s} - \\beta_{n} M_{n}\\big)\\,\\gamma_{\\mathrm{PAM}}$，其中 $\\beta_{s} = \\ln(4)$ 且 $\\beta_{n} = \\ln(1.5)$。\n- 引导停留时间阈值 $\\tau_{p} = 8\\,\\mathrm{s}$。\n\n从独立指数等待时间（无记忆过程）的定义出发，且不使用任何预先推导的快捷公式，推导在一个单一Cascade结合事件中，干扰不足但引导被触发的概率的解析表达式。在此模型中，将“干扰不足但引导被触发”定义为引导发生且在解离前没有发生干扰切割的事件。然后，根据给定的错配谱和参数，计算此概率的数值。将最终概率四舍五入至三位有效数字，并以小数形式（而非百分比）表示。", "solution": "首先将对所述问题的科学性和逻辑一致性进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n- **系统**：CRISPR-Cas I-E型。\n- **竞争过程**：解离（时间 $T_{\\mathrm{off}}$）和干扰（时间 $T_{\\mathrm{int}}$）。\n- **随机模型**：\n    - $T_{\\mathrm{off}} \\sim \\mathrm{Exp}(k_{\\mathrm{off}})$。\n    - $T_{\\mathrm{int}} \\sim \\mathrm{Exp}(k_{\\mathrm{int}})$。\n    - $T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 是独立的随机变量。\n- **引导条件**：如果Cascade复合物持续到 $\\tau_{p}$，则在 $\\tau_{p}$ 时刻触发引导。持续意味着解离和干扰均未发生。\n- **原间隔序列几何结构**：长度 $L = 32$。种子区域是位置 $1$ 到 $8$。\n- **错配谱**：错配位于位置 $\\{2, 7, 10, 15, 23, 28\\}$。\n- **错配权重**：\n    - 对于 $i \\in \\{9,\\dots,20\\}$，$w_{i} = 0.5$。\n    - 对于 $i \\in \\{21,\\dots,32\\}$，$w_{i} = 0.2$。\n- **错配定义**：\n    - 种子区域错配数 $M_{s} = \\sum_{i=1}^{8} x_{i}$。\n    - 加权的非种子区域错配和 $M_{n} = \\sum_{i=9}^{32} w_{i} x_{i}$，其中 $x_{i} \\in \\{0,1\\}$。\n- **速率参数和方程**：\n    - $k_{\\mathrm{off}}^{0} = 0.02\\,\\mathrm{s}^{-1}$。\n    - $k_{\\mathrm{int}}^{0} = 0.20\\,\\mathrm{s}^{-1}$。\n    - $\\delta_{\\mathrm{PAM}} = 1.5$。\n    - $\\gamma_{\\mathrm{PAM}} = 0.70$。\n    - $\\alpha_{s} = \\ln(5)$, $\\alpha_{n} = \\ln(2)$。\n    - $\\beta_{s} = \\ln(4)$, $\\beta_{n} = \\ln(1.5)$。\n    - $k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp(\\alpha_{s} M_{s} + \\alpha_{n} M_{n})\\,\\delta_{\\mathrm{PAM}}$。\n    - $k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp(-\\beta_{s} M_{s} - \\beta_{n} M_{n})\\,\\gamma_{\\mathrm{PAM}}$。\n- **引导阈值**：$\\tau_{p} = 8\\,\\mathrm{s}$。\n- **目标**：推导并计算定义为“干扰不足但引导被触发”的事件的概率，该事件被明确指定为“引导发生且在解离前没有发生干扰切割的事件”。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，代表了一个简化的、但标准的用于描述生物物理学中竞争性随机过程的动力学模型。对此类无记忆事件的等待时间使用指数分布是这类模型的基石。将速率设置为依赖于错配数量和位置的参数化方法，与CRISPR-Cas9及相关系统的实验观察结果一致。该问题是适定的，提供了计算唯一概率所需的所有必要定义、参数和函数形式。语言是客观和定量的。问题不包含科学谬误、矛盾或歧义。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。将推导解答。\n\n**推导与解答**\n\n目标是计算在引导被触发且复合物的最终命运是解离而非干扰的事件的概率。设该事件为 $A$。我们根据问题陈述将条件形式化。\n\n1.  **“引导发生”**：如果复合物保持结合的时间至少为 $\\tau_p$，则会发生此事件。复合物的寿命由解离或干扰这两个事件中首先发生的那个决定。因此，复合物结合直至时间 $T_{\\mathrm{bound}} = \\min(T_{\\mathrm{off}}, T_{\\mathrm{int}})$。引导的条件是 $T_{\\mathrm{bound}} \\ge \\tau_p$，这等价于两个条件的合取：$T_{\\mathrm{off}} \\ge \\tau_p$ 和 $T_{\\mathrm{int}} \\ge \\tau_p$。\n2.  **“在解离前没有发生干扰切割”**：这是关于两个随机事件发生顺序的陈述。这意味着解离时间小于干扰时间：$T_{\\mathrm{off}}  T_{\\mathrm{int}}$。\n\n结合这些条件，事件 $A$ 是交集：\n$$A = \\{ (T_{\\mathrm{off}} \\ge \\tau_p) \\cap (T_{\\mathrm{int}} \\ge \\tau_p) \\cap (T_{\\mathrm{off}}  T_{\\mathrm{int}}) \\}$$\n时间 $T_{\\mathrm{off}}$ 和 $T_{\\mathrm{int}}$ 分别是速率为 $k_{\\mathrm{off}}$ 和 $k_{\\mathrm{int}}$ 的独立指数随机变量。它们的概率密度函数 (PDF) 分别为 $f_{\\mathrm{off}}(t) = k_{\\mathrm{off}} \\exp(-k_{\\mathrm{off}} t)$ (当 $t \\ge 0$) 和 $f_{\\mathrm{int}}(t) = k_{\\mathrm{int}} \\exp(-k_{\\mathrm{int}} t)$ (当 $t \\ge 0$)。由于独立性，它们的联合PDF为 $f(t_o, t_i) = k_{\\mathrm{off}} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{off}} t_o - k_{\\mathrm{int}} t_i)$ (当 $t_o, t_i \\ge 0$)。\n\n概率 $P(A)$ 通过在 $(t_o, t_i)$ 平面上对联合PDF进行积分得到，积分区域 $D$ 由事件 $A$ 的不等式定义：$t_o \\ge \\tau_p$, $t_i \\ge \\tau_p$, 和 $t_o  t_i$。该区域可以表示为 $t_o \\in [\\tau_p, \\infty)$ 和 $t_i \\in (t_o, \\infty)$，注意到由于 $t_o \\ge \\tau_p$，条件 $t_i > t_o$ 自动确保了 $t_i > \\tau_p$。\n\n积分设置如下：\n$$P(A) = \\int_{\\tau_p}^{\\infty} \\int_{t_o}^{\\infty} f(t_o, t_i) \\, dt_i \\, dt_o = \\int_{\\tau_p}^{\\infty} \\int_{t_o}^{\\infty} k_{\\mathrm{off}} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{off}} t_o - k_{\\mathrm{int}} t_i) \\, dt_i \\, dt_o$$\n\n首先，我们求解关于 $t_i$ 的内层积分：\n$$ \\int_{t_o}^{\\infty} k_{\\mathrm{int}} \\exp(-k_{\\mathrm{int}} t_i) \\, dt_i = \\left[ -\\exp(-k_{\\mathrm{int}} t_i) \\right]_{t_o}^{\\infty} = 0 - (-\\exp(-k_{\\mathrm{int}} t_o)) = \\exp(-k_{\\mathrm{int}} t_o) $$\n\n接下来，将此结果代入外层积分：\n$$ P(A) = \\int_{\\tau_p}^{\\infty} k_{\\mathrm{off}} \\exp(-k_{\\mathrm{off}} t_o) \\, \\exp(-k_{\\mathrm{int}} t_o) \\, dt_o = \\int_{\\tau_p}^{\\infty} k_{\\mathrm{off}} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_o) \\, dt_o $$\n\n现在，我们求解这个积分：\n$$ P(A) = k_{\\mathrm{off}} \\left[ \\frac{-\\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_o)}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\right]_{\\tau_p}^{\\infty} $$\n$$ P(A) = \\frac{-k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\left( \\lim_{t_o \\to \\infty} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) t_o) - \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\right) $$\n因为 $k_{\\mathrm{off}} > 0$ 和 $k_{\\mathrm{int}} > 0$，所以极限为 $0$。\n$$ P(A) = \\frac{-k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\left( 0 - \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\right) $$\n这得出了概率的最终解析表达式：\n$$ P(A) = \\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) $$\n\n现在，我们必须计算速率 $k_{\\mathrm{off}}$ 和 $k_{\\mathrm{int}}$ 的数值。\n首先，我们根据给定的错配谱 $\\{2, 7, 10, 15, 23, 28\\}$ 计算错配数 $M_s$ 和 $M_n$。\n- 种子区域错配（位置 $1-8$）：$\\{2, 7\\}$。因此，$M_s = 2$。\n- 非种子区域错配：$\\{10, 15, 23, 28\\}$。我们应用位置权重。\n    - 位置 $10$ 和 $15$ 处于范围 $\\{9, \\dots, 20\\}$ 内，所以它们的权重是 $w_i = 0.5$。\n    - 位置 $23$ 和 $28$ 处于范围 $\\{21, \\dots, 32\\}$ 内，所以它们的权重是 $w_i = 0.2$。\n- 加权的非种子区域错配和为 $M_n = 1 \\cdot 0.5 + 1 \\cdot 0.5 + 1 \\cdot 0.2 + 1 \\cdot 0.2 = 1.0 + 0.4 = 1.4$。\n\n接下来，我们使用提供的公式计算速率：\n$k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\,\\exp(\\alpha_{s} M_{s} + \\alpha_{n} M_{n})\\,\\delta_{\\mathrm{PAM}}$\n$k_{\\mathrm{off}} = k_{\\mathrm{off}}^{0} \\cdot 5^{M_s} \\cdot 2^{M_n} \\cdot \\delta_{\\mathrm{PAM}} = (0.02) \\cdot (5^{2}) \\cdot (2^{1.4}) \\cdot (1.5) = (0.02) \\cdot (25) \\cdot (2^{1.4}) \\cdot (1.5) = 0.75 \\cdot 2^{1.4} \\, \\mathrm{s}^{-1}$。\n$k_{\\mathrm{off}} \\approx 0.75 \\cdot (2.6390158) \\approx 1.97926185 \\, \\mathrm{s}^{-1}$。\n\n$k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\,\\exp(-\\beta_{s} M_{s} - \\beta_{n} M_{n})\\,\\gamma_{\\mathrm{PAM}}$\n$k_{\\mathrm{int}} = k_{\\mathrm{int}}^{0} \\cdot 4^{-M_s} \\cdot 1.5^{-M_n} \\cdot \\gamma_{\\mathrm{PAM}} = (0.20) \\cdot (4^{-2}) \\cdot (1.5^{-1.4}) \\cdot (0.70)$。\n$k_{\\mathrm{int}} = (0.20) \\cdot \\left(\\frac{1}{16}\\right) \\cdot (1.5^{-1.4}) \\cdot (0.70) = (0.0125) \\cdot (0.70) \\cdot (1.5^{-1.4}) = 0.00875 \\cdot 1.5^{-1.4} \\, \\mathrm{s}^{-1}$。\n$k_{\\mathrm{int}} \\approx 0.00875 / (1.760778) \\approx 0.00496939 \\, \\mathrm{s}^{-1}$。\n\n最后，我们将这些值和 $\\tau_p=8\\,\\mathrm{s}$ 代入概率表达式中：\n$k_{\\mathrm{off}} + k_{\\mathrm{int}} \\approx 1.97926185 + 0.00496939 = 1.98423124 \\, \\mathrm{s}^{-1}$。\n前置因子为：\n$\\frac{k_{\\mathrm{off}}}{k_{\\mathrm{off}} + k_{\\mathrm{int}}} \\approx \\frac{1.97926185}{1.98423124} \\approx 0.9974955$。\n指数项为：\n$\\exp(-(k_{\\mathrm{off}} + k_{\\mathrm{int}}) \\tau_p) \\approx \\exp(-1.98423124 \\cdot 8) = \\exp(-15.8738499) \\approx 1.2766 \\times 10^{-7}$。\n\n最终概率是这两项的乘积：\n$P(A) \\approx (0.9974955) \\cdot (1.2766 \\times 10^{-7}) \\approx 1.27341 \\times 10^{-7}$。\n\n四舍五入到三位有效数字，概率为 $1.27 \\times 10^{-7}$。", "answer": "$$\\boxed{1.27 \\times 10^{-7}}$$", "id": "2725185"}, {"introduction": "CRISPR免疫的分子机制在群体层面会产生深远的生态学和进化后果。这个练习将我们的视角从单个分子提升到整个生态系统，使用常微分方程来模拟细菌与噬菌体之间的“军备竞赛”。通过分析这个模型，我们可以推导出CRISPR免疫能够帮助细菌控制噬菌体流行或与之共存的临界条件，从而将分子水平的效率参数（如切割效率 $\\epsilon$）与宏观的种群稳定性联系起来 [@problem_id:2725290]。", "problem": "一个充分混合的细菌种群由两个亚种群组成：没有成簇规律间隔短回文重复序列 (CRISPR) 免疫的细菌，记为 $B_{s}(t)$，以及具有CRISPR免疫的细菌，记为 $B_{r}(t)$。存在一个密度为 $P(t)$ 的单一裂解性噬菌体种群。假设：\n- 两个细菌亚种群都利用共享资源进行逻辑斯谛增长，其内禀单位个体生长率分别为 $r_{s}$ 和 $r_{r}$，并且对于总细菌生物量 $B_{s}+B_{r}$，有一个共同的环境承载量 $K$。\n- 噬菌体以质量作用速率常数 $\\phi$ 吸附到细菌上。当吸附到非CRISPR细菌 $B_{s}$ 上时，感染总是成功的，伴随着瞬时裂解，每次感染事件的裂解量为 $b$ 个噬菌体（每次吸附到 $B_{s}$ 上净变化为 $b-1$ 个噬菌体）。当吸附到CRISPR细菌 $B_{r}$ 上时，感染以 $1-\\epsilon$ 的概率成功（瞬时裂解，净变化为 $b-1$ 个噬菌体），并以 $\\epsilon$ 的概率被中和（被吸附的噬菌体被摧毁，不发生裂解，也不产生噬菌体）。游离噬菌体以速率 $m$ 衰变。\n- 从 $B_{s}$ 到 $B_{r}$ 存在一个单位个体速率为 $\\mu$ 的组成性间隔序列获取过程，从 $B_{r}$ 到 $B_{s}$ 存在一个单位个体速率为 $\\sigma$ 的间隔序列丢失过程。这些转换过程保持细菌总生物量守恒。\n- 所有参数均为正常数，且 $b>1$，$ \\epsilon \\in [0,1]$。\n\n1. 从质量作用感染动力学和逻辑斯谛增长出发，写出一个与上述假设一致的关于 $(B_{s},B_{r},P)$ 的常微分方程 (ODE) 模型。从质量作用感染和逻辑斯谛资源限制的第一性原理出发，仔细论证每一项。\n\n2. 考虑 $P=0$ 时的无病毒平衡点。在没有噬菌体的情况下细菌生长达到环境承载量饱和状态的假设下，用 $K,\\mu,\\sigma$ 表示平衡值 $(B_{s}^{0},B_{r}^{0})$，并利用方程的结构论证总细菌生物量在 $K$ 处的稳定性。\n\n3. 利用噬菌体方程在无病毒平衡点 $(B_{s}^{0},B_{r}^{0},P=0)$ 附近的线性化，推导出明确的阈值效力 $\\epsilon_{c}$，使得噬菌体种群在其稀有时既不增长也不减少。从生物学角度将此阈值解释为噬菌体排除（对于 $\\epsilon\\epsilon_{c}$）和所有三个种群可能共存（对于 $\\epsilon\\epsilon_{c}$）之间的界限，并陈述使 $\\epsilon_{c}$ 处于区间 $[0,1]$ 内所需的任何参数条件。\n\n请以关于 $b,\\phi,m,K,\\mu,\\sigma$ 的单一闭式解析表达式的形式提供您的最终答案 $\\epsilon_{c}$。不需要进行数值计算，并且最终答案框中不应包含任何单位。如果使用了任何中间近似，必须根据所述假设进行论证。确保每个符号和数字都用LaTeX书写。", "solution": "该问题陈述的科学和数学有效性已经过分析。它提出了一个关于具有演化防御机制的宿主-寄生虫系统的种群动力学的标准模型，尽管经过了简化。逻辑斯谛增长、质量作用动力学和组成性转换的假设是理论生态学中常见的理想化处理。该问题是自洽的、逻辑一致且适定的。因此，它被认为是有效的，并且可以构建一个形式化的解。\n\n问题要求完成三项任务：推导控制常微分方程 (ODE)，分析无病毒平衡点，以及推导关键的CRISPR效力阈值。我们将依次处理每一项。\n\n1. ODE模型的推导\n\n该系统由三个种群组成：易感细菌 $B_s(t)$、抗性（具有CRISPR）细菌 $B_r(t)$ 和噬菌体 $P(t)$。其动力学从第一性原理构建。\n\n易感种群的变化率 $\\frac{dB_s}{dt}$ 是三个效应的总和：\n-   逻辑斯谛增长：该种群以内禀速率 $r_s$ 增长，受到总细菌种群 $B_s+B_r$ 相对于环境承载量 $K$ 的限制。此项为 $r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right)$。\n-   噬菌体捕食：噬菌体以与其密度成正比的速率吸附到易感细菌上，根据质量作用动力学，该速率为 $\\phi P B_s$。每个此类事件都会导致细菌死亡。这是一个损失项，$-\\phi P B_s$。\n-   种群转换：细菌以单位个体速率 $\\mu$ 获取间隔序列并变为抗性，导致一个损失项 $-\\mu B_s$。相反，抗性细菌以单位个体速率 $\\sigma$ 丢失间隔序列并变为易感，导致一个增益项 $\\sigma B_r$。\n结合这些项，得到第一个ODE：\n$$ \\frac{dB_s}{dt} = r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right) - \\phi P B_s - \\mu B_s + \\sigma B_r $$\n\n抗性种群的变化率 $\\frac{dB_r}{dt}$ 的确定方式类似：\n-   逻辑斯谛增长：该种群以其内禀速率 $r_r$ 增长，受到相同的总环境承载量限制。此项为 $r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right)$。\n-   噬菌体捕食：噬菌体以速率 $\\phi B_r P$ 吸附到抗性细菌上。感染仅以概率 $1-\\epsilon$ 成功，导致裂解。因此，$B_r$ 的损失率为 $-(1-\\epsilon)\\phi P B_r$。以概率 $\\epsilon$，感染被中和，细菌存活。\n-   种群转换：该种群以速率 $\\mu B_s$ 从易感菌库中获得个体，并因间隔序列丢失而以速率 $\\sigma B_r$ 失去个体。净变化为 $\\mu B_s - \\sigma B_r$。\n结合这些项，得到第二个ODE：\n$$ \\frac{dB_r}{dt} = r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right) - (1-\\epsilon)\\phi P B_r + \\mu B_s - \\sigma B_r $$\n\n噬菌体种群的变化率 $\\frac{dP}{dt}$ 由感染产生的增殖和自然衰变决定：\n-   来自 $B_s$ 的产生：在 $B_s$ 上的吸附事件以速率 $\\phi P B_s$ 发生。每个事件产生裂解量为 $b$ 的新噬菌体，同时消耗一个，净产生量为 $b-1$。变化率为 $(b-1)\\phi P B_s$。\n-   来自 $B_r$ 的净产生：在 $B_r$ 上的吸附事件以速率 $\\phi P B_r$ 发生。以 $1-\\epsilon$ 的概率，感染成功，产生 $b-1$ 的净变化。以 $\\epsilon$ 的概率，噬菌体被摧毁，净变化为 $-1$。每次吸附到 $B_r$ 上的平均净变化为 $(1-\\epsilon)(b-1) + \\epsilon(-1) = b-1-\\epsilon b + \\epsilon - \\epsilon = b-1-\\epsilon b$。因此，变化率为 $(b-1-\\epsilon b)\\phi P B_r$。\n-   噬菌体衰变：游离噬菌体颗粒以单位个体速率 $m$ 衰变。这是一个损失项，$-mP$。\n结合这些项并提出因子 $P$，得到第三个ODE：\n$$ \\frac{dP}{dt} = (b-1)\\phi P B_s + (b-1-\\epsilon b)\\phi P B_r - mP = P\\left[\\phi(b-1)B_s + \\phi(b-1-\\epsilon b)B_r - m\\right] $$\n\n2. 无病毒平衡点的分析\n\n在无病毒平衡点，$P=0$ 且种群恒定，因此 $\\frac{dB_s}{dt}=0$ 且 $\\frac{dB_r}{dt}=0$。系统简化为：\n$$ 0 = r_s B_s \\left(1 - \\frac{B_s+B_r}{K}\\right) - \\mu B_s + \\sigma B_r $$\n$$ 0 = r_r B_r \\left(1 - \\frac{B_s+B_r}{K}\\right) + \\mu B_s - \\sigma B_r $$\n问题陈述了总细菌生物量达到环境承载量饱和状态的假设，意味着在平衡点，$B_s^0 + B_r^0 = K$。将此代入平衡方程，逻辑斯谛增长项 $r_s B_s^0(1-K/K)$ 和 $r_r B_r^0(1-K/K)$ 均变为零。系统简化为：\n$$ 0 = -\\mu B_s^0 + \\sigma B_r^0 $$\n$$ 0 = \\mu B_s^0 - \\sigma B_r^0 $$\n两个方程都得出相同的条件 $\\mu B_s^0 = \\sigma B_r^0$，这证实了与初始假设的一致性。我们现在求解该线性系统以得到平衡值 $(B_s^0, B_r^0)$：\n1.  $B_s^0 + B_r^0 = K$\n2.  $\\mu B_s^0 = \\sigma B_r^0$\n从第二个方程，我们有 $B_r^0 = \\frac{\\mu}{\\sigma}B_s^0$。将其代入第一个方程：\n$B_s^0 + \\frac{\\mu}{\\sigma}B_s^0 = K \\implies B_s^0\\left(1+\\frac{\\mu}{\\sigma}\\right) = K \\implies B_s^0\\left(\\frac{\\sigma+\\mu}{\\sigma}\\right) = K$。\n这给出了 $B_s^0$ 的平衡值：\n$$ B_s^0 = K \\frac{\\sigma}{\\mu+\\sigma} $$\n然后，从 $B_r^0 = K - B_s^0$ 求得 $B_r^0$：\n$$ B_r^0 = K - K \\frac{\\sigma}{\\mu+\\sigma} = K\\left(\\frac{\\mu+\\sigma-\\sigma}{\\mu+\\sigma}\\right) = K \\frac{\\mu}{\\mu+\\sigma} $$\n为了在没有噬菌体的情况下论证总生物量 $N(t) = B_s(t)+B_r(t)$ 在 $K$ 处的稳定性，我们将 $B_s$ 和 $B_r$ 的ODE在 $P=0$ 时相加：\n$$ \\frac{dN}{dt} = \\frac{dB_s}{dt} + \\frac{dB_r}{dt} = r_s B_s \\left(1 - \\frac{N}{K}\\right) - \\mu B_s + \\sigma B_r + r_r B_r \\left(1 - \\frac{N}{K}\\right) + \\mu B_s - \\sigma B_r $$\n转换项 $-\\mu B_s + \\sigma B_r$ 和 $+\\mu B_s - \\sigma B_r$ 相互抵消，正如转换过程中生物量守恒所规定的。我们得到：\n$$ \\frac{dN}{dt} = \\left(1 - \\frac{N}{K}\\right)(r_s B_s + r_r B_r) $$\n定义一个平均生长率 $\\bar{r}(t) = \\frac{r_s B_s(t) + r_r B_r(t)}{N(t)}$，方程变为 $\\frac{dN}{dt} = N\\bar{r}(t)\\left(1 - \\frac{N}{K}\\right)$。由于 $r_s, r_r > 0$，$\\bar{r}(t)$ 总是正的。这是总生物量 $N$ 的逻辑斯谛方程。对于任何正的初始条件，不动点 $N=K$ 是全局稳定的，因为当 $N  K$ 时，$\\frac{dN}{dt} > 0$，而当 $N > K$ 时，$\\frac{dN}{dt}  0$。\n\n3. 阈值效力 $\\epsilon_c$ 的推导\n\n要确定噬菌体能否入侵一个处于无病毒平衡状态的细菌种群，我们分析噬菌体种群 $P$ 在 $P \\approx 0$ 且 $(B_s, B_r) \\approx (B_s^0, B_r^0)$ 时的动力学。对 $\\frac{dP}{dt}$ 方程进行线性化，我们得到：\n$$ \\frac{dP}{dt} \\approx P \\left[ \\phi(b-1)B_s^0 + \\phi(b-1-\\epsilon b)B_r^0 - m \\right] $$\n指数增长率由方括号内的项给出。噬菌体种群既不增长也不减少的阈值条件是该项等于零。我们将此时的 $\\epsilon$ 定义为 $\\epsilon_c$：\n$$ \\phi(b-1)B_s^0 + \\phi(b-1-\\epsilon_c b)B_r^0 - m = 0 $$\n现在，我们代入 $B_s^0$ 和 $B_r^0$ 的表达式，并求解 $\\epsilon_c$。\n$$ \\phi(b-1)\\left(K\\frac{\\sigma}{\\mu+\\sigma}\\right) + \\phi(b-1-\\epsilon_c b)\\left(K\\frac{\\mu}{\\mu+\\sigma}\\right) = m $$\n两边同除以 $\\phi K$：\n$$ (b-1)\\frac{\\sigma}{\\mu+\\sigma} + (b-1-\\epsilon_c b)\\frac{\\mu}{\\mu+\\sigma} = \\frac{m}{\\phi K} $$\n两边同乘以 $\\mu+\\sigma$：\n$$ (b-1)\\sigma + (b-1)\\mu - \\epsilon_c b \\mu = \\frac{m(\\mu+\\sigma)}{\\phi K} $$\n$$ (b-1)(\\sigma+\\mu) - \\epsilon_c b \\mu = \\frac{m(\\mu+\\sigma)}{\\phi K} $$\n重新整理以求解 $\\epsilon_c b \\mu$：\n$$ \\epsilon_c b \\mu = (b-1)(\\mu+\\sigma) - \\frac{m(\\mu+\\sigma)}{\\phi K} $$\n将 $(\\mu+\\sigma)$ 提出来：\n$$ \\epsilon_c b \\mu = (\\mu+\\sigma) \\left(b-1 - \\frac{m}{\\phi K}\\right) $$\n最后，两边同除以 $b\\mu$ 得到 $\\epsilon_c$：\n$$ \\epsilon_c = \\frac{\\mu+\\sigma}{b\\mu} \\left(b-1 - \\frac{m}{\\phi K}\\right) $$\n要使噬菌体能够入侵，其在不存在CRISPR效力（即$\\epsilon=0$）时的初始增长率必须为正。此增长率是在无病毒平衡点评估的噬菌体方程的雅可比特征值。当$\\epsilon=0$时，$\\frac{1}{P}\\frac{dP}{dt}|_{P \\to 0} = \\phi(b-1)B_s^0 + \\phi(b-1)B_r^0 - m = \\phi(b-1)K - m > 0$。这个条件确保了$\\epsilon_c$中的分子是正的，因此$\\epsilon_c > 0$。要使$\\epsilon_c$在生物学上现实（即 $\\epsilon_c \\le 1$），必须满足 $\\frac{\\mu+\\sigma}{b\\mu} \\left(b-1 - \\frac{m}{\\phi K}\\right) \\le 1$。", "answer": "$$\\boxed{\\frac{\\mu+\\sigma}{b\\mu}\\left(b-1 - \\frac{m}{\\phi K}\\right)}$$", "id": "2725290"}]}