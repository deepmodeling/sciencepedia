{"hands_on_practices": [{"introduction": "gRNA 设计的一个主要目标是最小化脱靶效应。一种直接的方法是采用加权评分系统，根据错配位置对其进行惩罚。这项练习 [@problem_id:2727956] 要求你确定一个合适的评分阈值，以平衡接受错配较少的位点与拒绝具有关键错配的位点，从而为实施设计约束提供实践经验。", "problem": "一个设计团队正在为成簇规律间隔短回文重复序列 (CRISPR) 靶向构建一种向导核糖核酸 (RNA) (gRNA)，并希望通过一个加权错配模型来控制脱靶结合。该模型基于中心法则原理，即碱基对互补决定杂交，而错配会降低有效结合亲和力。假设一个长度为$20$个核苷酸 (nt) 的 gRNA，其位置索引为 $i \\in \\{1,\\dots,20\\}$，其中原型间隔子相邻基序 (PAM) 近端种子区域为 $i \\in \\{1,\\dots,10\\}$，远端区域为 $i \\in \\{11,\\dots,20\\}$。脱靶分数定义为\n$$\nS \\;=\\; \\sum_{i=1}^{20} w_i\\, m_i,\n$$\n其中 $m_i \\in \\{0,1\\}$ 表示在位置 $i$ 处存在错配，$w_i \\ge 0$ 是一个位置罚分权重，量化了在位置 $i$ 处发生错配所带来的能量罚分贡献。决策规则是，当且仅当 $S \\le \\tau$ 时，将一个潜在的脱靶位点视为可接受的，其中 $\\tau \\ge 0$ 是用户选择的阈值。\n\n假设经验生物物理学表明，种子区域的错配比远端区域的错配产生更大的罚分，该团队采用了简化的、按位置分组的权重：\n$$\nw_i \\;=\\; \\begin{cases}\n0.6,  & i \\in \\{1,\\dots,10\\} \\\\\n0.25, & i \\in \\{11,\\dots,20\\}.\n\\end{cases}\n$$\n\n他们希望选择一个单一的阈值 $\\tau$，使其能同时满足以下所有设计要求：\n- 接受在任何位置最多有$1$个错配的所有候选（即，所有满足 $\\sum_i m_i \\le 1$ 的模式都应满足 $S \\le \\tau$）。\n- 拒绝任何在远端区域至少有$3$个错配的候选（即，任何满足 $m_i = 0$ for $i \\in \\{1,\\dots,10\\}$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$ 的模式都应满足 $S > \\tau$）。\n- 拒绝任何在种子区域至少有$2$个错配的候选（即，任何满足 $\\sum_{i=1}^{10} m_i \\ge 2$ 的模式都应满足 $S > \\tau$），不论远端区域是否存在错配。\n\n以下哪个关于 $\\tau$ 的区间能满足所有三个要求？\n\nA. $0.25 \\le \\tau  0.75$\n\nB. $0.6 \\le \\tau  0.75$\n\nC. $0.6 \\le \\tau  1.2$\n\nD. $0.75 \\le \\tau  1.2$", "solution": "必须首先验证问题陈述的科学和逻辑完整性。\n\n步骤1：提取已知条件\n- 向导RNA (gRNA) 长度：$20$个核苷酸 (nt)。\n- 位置索引：$i \\in \\{1, \\dots, 20\\}$。\n- PAM近端种子区域：位置 $i \\in \\{1, \\dots, 10\\}$。\n- 远端区域：位置 $i \\in \\{11, \\dots, 20\\}$。\n- 脱靶分数：$S = \\sum_{i=1}^{20} w_i m_i$。\n- 错配指示符：$m_i \\in \\{0, 1\\}$，其中 $m_i=1$ 表示错配。\n- 位置罚分权重：$w_i \\ge 0$。\n- 具体权重：\n$$\nw_i = \\begin{cases}\n0.6,   i \\in \\{1, \\dots, 10\\} \\\\\n0.25,  i \\in \\{11, \\dots, 20\\}.\n\\end{cases}\n$$\n- 决策规则：一个潜在的脱靶位点是可接受的，当且仅当其分数 $S$ 满足 $S \\le \\tau$，其中 $\\tau \\ge 0$ 是一个阈值。如果 $S  \\tau$，则拒绝。\n- 对 $\\tau$ 的设计要求：\n    1. 接受在任何位置最多有1个错配的所有候选（$\\sum_i m_i \\le 1$）。\n    2. 拒绝任何在远端区域至少有3个错配的候选（对于 $i \\in \\{1, \\dots, 10\\}$，$m_i = 0$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$）。\n    3. 拒绝任何在种子区域至少有2个错配的候选（$\\sum_{i=1}^{10} m_i \\ge 2$），无论远端区域是否有错配。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。它提出了一个用于gRNA脱靶预测的简化但标准的生物物理模型，该模型基于一个既定原则，即错配罚分是位置依赖的，其中种子区域最为关键。在生物信息学评分函数中，使用加权和是一种常见方法。该问题提法得当；它提供了清晰的数学表述和一组约束条件，以确定参数τ的有效范围。所有术语都有定义，数据内部一致。该问题是客观且可形式化的。\n\n步骤3：结论与行动\n问题有效。我们将着手推导解决方案。\n\n任务是找到能够同时满足所有三个设计要求的阈值 $\\tau$ 的区间。每个要求都对 $\\tau$ 施加一个约束。我们将依次分析它们。\n\n要求1：“接受在任何位置最多有$1$个错配的所有候选。”\n这意味着对于任何错配总数 $\\sum_{i=1}^{20} m_i \\le 1$ 的错配模式，其分数 $S$ 必须满足接受条件 $S \\le \\tau$。为了保证对*所有*此类模式都成立，$\\tau$ 必须大于或等于它们中的最大可能分数。\n- 0个错配的情况：$\\sum m_i = 0$。分数为 $S = \\sum w_i (0) = 0$。这要求 $0 \\le \\tau$，这是已知的。\n- 1个错配的情况：$\\sum m_i = 1$。\n    - 如果错配在种子区域 ($i \\in \\{1, \\dots, 10\\}$)，分数为 $S = 1 \\times w_{seed} = 0.6$。\n    - 如果错配在远端区域 ($i \\in \\{11, \\dots, 20\\}$)，分数为 $S = 1 \\times w_{distal} = 0.25$。\n单个错配的最大分数为 $\\max(0.6, 0.25) = 0.6$。因此，为了接受所有单个错配的候选，$\\tau$ 必须至少这么大。\n这给出了我们的第一个不等式：\n$$ \\tau \\ge 0.6 $$\n\n要求2：“拒绝任何在远端区域至少有$3$个错配的候选。”\n这意味着对于任何在 $i \\in \\{1, \\dots, 10\\}$ 范围内 $m_i = 0$ 且 $\\sum_{i=11}^{20} m_i \\ge 3$ 的模式，其分数 $S$ 必须满足拒绝条件 $S  \\tau$。为了保证对*所有*此类模式都成立，$\\tau$ 必须严格小于它们中的最小可能分数。\n这种模式的分数为 $S = (\\sum_{i=11}^{20} m_i) \\times w_{distal}$。\n远端错配的数量至少为3。此类中的最低分数出现在恰好有3个远端错配时。\n$S_{min} = 3 \\times w_{distal} = 3 \\times 0.25 = 0.75$。\n此类中的任何其他模式将有超过3个远端错配，因此分数更高。所以，要拒绝所有这些候选，$\\tau$ 必须严格小于这个最低分数。\n这给出了我们的第二个不等式：\n$$ \\tau  0.75 $$\n\n要求3：“拒绝任何在种子区域至少有$2$个错配的候选。”\n这意味着对于任何种子区域错配数 $\\sum_{i=1}^{10} m_i \\ge 2$ 的模式，其分数 $S$ 必须满足拒绝条件 $S  \\tau$。这必须在不论远端区域错配数量如何的情况下都成立。为了保证对*所有*此类模式都成立，$\\tau$ 必须严格小于它们中的最小可能分数。\n分数为 $S = (\\sum_{i=1}^{10} m_i) \\times w_{seed} + (\\sum_{i=11}^{20} m_i) \\times w_{distal}$。\n种子区域错配的最小数量是2。远端错配的最小数量是0。此类中的最低分数出现在恰好有2个种子区域错配和0个远端错配时。\n$S_{min} = 2 \\times w_{seed} + 0 \\times w_{distal} = 2 \\times 0.6 = 1.2$。\n此类中的任何其他模式将至少有2个种子区域错配或额外的远端错配，导致分数大于或等于1.2。要拒绝所有此类模式，$\\tau$ 必须严格小于此最低分数。\n这给出了我们的第三个不等式：\n$$ \\tau  1.2 $$\n\n结合所有三个不等式：\n1. $\\tau \\ge 0.6$\n2. $\\tau  0.75$\n3. $\\tau  1.2$\n\n$\\tau  0.75$ 和 $\\tau  1.2$ 的交集是更严格的条件，即 $\\tau  0.75$。将其与第一个不等式结合，我们得到 $\\tau$ 的有效区间：\n$$ 0.6 \\le \\tau  0.75 $$\n\n现在我们评估给出的选项。\n\nA. $0.25 \\le \\tau  0.75$\n该区间允许 $\\tau$ 的值小于0.6，例如 $\\tau = 0.5$。如果 $\\tau = 0.5$，一个在种子区域有单个错配的候选的分数为 $S=0.6$。由于 $S > \\tau$，该候选将被拒绝。这违反了要求1，该要求规定所有有一个错配的候选都必须被接受。因此，该选项是**错误的**。\n\nB. $0.6 \\le \\tau  0.75$\n该区间与我们推导出的结果相符。我们来验证一下。此范围内的任何 $\\tau$ 都满足所有三个条件：\n- $\\tau \\ge 0.6$：这满足要求1。一个错配的最大分数为$0.6$，由于 $S=0.6 \\le \\tau$，它被接受。\n- $\\tau  0.75$：这满足要求2。$\\ge 3$ 个远端错配的最低分数为$0.75$，由于 $S \\ge 0.75 > \\tau$，它被拒绝。\n- $\\tau  0.75  1.2$：这满足要求3。$\\ge 2$ 个种子区域错配的最低分数为$1.2$，由于 $S \\ge 1.2 > \\tau$，它被拒绝。\n因此，该选项是**正确的**。\n\nC. $0.6 \\le \\tau  1.2$\n该区间允许 $\\tau$ 的值大于或等于0.75，例如 $\\tau = 0.8$。如果 $\\tau = 0.8$，一个在远端区域恰好有3个错配（且在种子区域没有错配）的候选的分数为 $S = 3 \\times 0.25 = 0.75$。由于 $S \\le \\tau$ ($0.75 \\le 0.8$)，该候选将被接受。这违反了要求2，该要求规定此类候选必须被拒绝。因此，该选项是**错误的**。\n\nD. $0.75 \\le \\tau  1.2$\n这个区间无效有两个原因。首先，如选项C的解释所述，任何 $\\tau \\ge 0.75$ 都违反了要求2。对于边界情况 $\\tau = 0.75$，一个有3个远端错配的候选的分数为 $S=0.75$。拒绝条件是 $S > \\tau$，即 $0.75 > 0.75$。这是错误的，所以该候选被接受，违反了要求。其次，它以一种微妙的方式违反了要求1，因为它将下限强制为0.75，而实际上只需要0.6。然而，对要求2的违反是决定性的。因此，该选项是**错误的**。", "answer": "$$\\boxed{B}$$", "id": "2727956"}, {"introduction": "为了超越简单的评分规则，我们可以利用热力学原理来模拟脱靶结合。错配惩罚可以被概念化为对结合自由能的去稳定化贡献，这反过来又会影响 gRNA 结合到某个位点的概率。这项实践 [@problem_id:2727933] 要求你推导错配惩罚与相对结合占有率之间的数学关系，将脱靶评分的概念建立在物理化学的基础之上。", "problem": "考虑一个用于成簇规律间隔短回文重复序列 (CRISPR) 基因编辑的导向RNA (gRNA) 的设计问题，其中长度为 $L$ 的gRNA通过碱基配对与脱氧核糖核酸 (DNA) 靶标结合。假设一个热力学占据模型，其中对于具有错配模式 $m = (m_{1}, m_{2}, \\dots, m_{L})$ 的特定靶位点，其平衡结合自由能由下式给出。此处 $m_{i} \\in \\{0,1\\}$ 表示在位置 $i$ 上的匹配（$m_{i} = 0$）或错配（$m_{i} = 1$）。\n$$\n\\Delta G(m) = \\Delta G_{0} + \\sum_{i=1}^{L} w_{i} m_{i},\n$$\n式中 $\\Delta G_{0}$ 是完全匹配位点的基准自由能，$w_{i}  0$ 是在位置 $i$ 发生错配时与位置相关的自由能罚分（例如，在原型间隔子邻近基序 (PAM) 附近值更大）。预测的脱靶分数 $S(m)$ 被认为与温度 $T$ 下gRNA-DNA复合物的平衡占据率成正比，在稀疏结合极限下，该占据率与 $\\exp(-\\beta \\Delta G(m))$ 成正比，其中 $\\beta = 1/(k_{B} T)$ 且 $k_{B}$ 是玻尔兹曼常数。\n\n给定两个候选脱靶位点，其错配模式分别为 $m = (m_{1}, \\dots, m_{L})$ 和 $m' = (m'_{1}, \\dots, m'_{L})$，它们在相同的罚分剖面 $w = (w_{1}, \\dots, w_{L})$ 和相同的温度 $T$ 下进行评估。定义分数比\n$$\nR \\equiv \\frac{S(m)}{S(m')}.\n$$\n\n仅从上述热力学模型和加性自由能罚分中所包含的独立性假设出发，推导出一个用 $\\beta$、$w_{i}$、$m_{i}$ 和 $m'_{i}$ 表示的 $\\ln R$ 的闭式表达式。然后，利用该表达式，确定使 $S(m)$ 严格小于 $S(m')$ 时，$\\{m_{i}\\}$、$\\{m'_{i}\\}$ 和 $\\{w_{i}\\}$ 所需满足的充分必要条件。\n\n请以单个闭式解析表达式的形式给出用 $\\beta$、$w_{i}$、$m_{i}$ 和 $m'_{i}$ 表示的 $\\ln R$ 作为最终答案。不需要进行数值计算，最终答案中不应包含单位。", "solution": "所述问题具有科学依据、内容自洽且提法明确。它提出了一个用于生物分子结合的标准（尽管简化了）热力学模型，这是生物物理学和合成生物学中的常用方法。推导所需量所需的所有定义和关系均已提供。该问题是有效的。我们开始推导。\n\n脱靶分数 $S(m)$ 与平衡占据率成正比，在稀疏结合极限和热力学模型下，该占据率与结合自由能相关的玻尔兹曼因子成正比。设 $C$ 为比例常数，它取决于gRNA-蛋白质复合物浓度等因素，但在相同条件下比较两个位点时是相同的。我们有：\n$$\nS(m) = C \\exp(-\\beta \\Delta G(m))\n$$\n其中 $\\beta = 1/(k_{B} T)$。\n类似地，对于具有错配模式 $m'$ 的第二个脱靶位点，其分数为：\n$$\nS(m') = C \\exp(-\\beta \\Delta G(m'))\n$$\n问题将分数比 $R$ 定义为：\n$$\nR \\equiv \\frac{S(m)}{S(m')}\n$$\n代入 $S(m)$ 和 $S(m')$ 的表达式：\n$$\nR = \\frac{C \\exp(-\\beta \\Delta G(m))}{C \\exp(-\\beta \\Delta G(m'))}\n$$\n比例常数 $C$ 被消掉，这对于定义明确的比率至关重要。利用指数函数的性质，我们合并这些项：\n$$\nR = \\exp(-\\beta \\Delta G(m) + \\beta \\Delta G(m')) = \\exp(-\\beta (\\Delta G(m) - \\Delta G(m')))\n$$\n为了找到 $\\ln R$ 的表达式，我们对两边取自然对数：\n$$\n\\ln R = \\ln(\\exp(-\\beta (\\Delta G(m) - \\Delta G(m')))) = -\\beta (\\Delta G(m) - \\Delta G(m'))\n$$\n现在，我们必须用给定的参数来表示自由能的差值 $\\Delta G(m) - \\Delta G(m')$。具有错配模式 $m$ 的位点的自由能由加性模型给出：\n$$\n\\Delta G(m) = \\Delta G_{0} + \\sum_{i=1}^{L} w_{i} m_{i}\n$$\n对于模式为 $m'$ 的位点：\n$$\n\\Delta G(m') = \\Delta G_{0} + \\sum_{i=1}^{L} w_{i} m'_{i}\n$$\n基准自由能 $\\Delta G_{0}$ 对两者是相同的，因为它对应于一个完全匹配的位点（对所有 $i$，$m_i=0$）。罚分权重 $w_i$ 对于两次评估也是相同的。因此，差值为：\n$$\n\\Delta G(m) - \\Delta G(m') = \\left(\\Delta G_{0} + \\sum_{i=1}^{L} w_{i} m_{i}\\right) - \\left(\\Delta G_{0} + \\sum_{i=1}^{L} w_{i} m'_{i}\\right)\n$$\n项 $\\Delta G_{0}$ 被消掉：\n$$\n\\Delta G(m) - \\Delta G(m') = \\sum_{i=1}^{L} w_{i} m_{i} - \\sum_{i=1}^{L} w_{i} m'_{i} = \\sum_{i=1}^{L} (w_{i} m_{i} - w_{i} m'_{i})\n$$\n提出公因式 $w_{i}$，我们得到：\n$$\n\\Delta G(m) - \\Delta G(m') = \\sum_{i=1}^{L} w_{i} (m_{i} - m'_{i})\n$$\n最后，将此结果代回 $\\ln R$ 的表达式中：\n$$\n\\ln R = -\\beta \\sum_{i=1}^{L} w_{i} (m_{i} - m'_{i})\n$$\n这就是所要求的 $\\ln R$ 的闭式表达式。\n\n第二个任务是确定使 $S(m)$ 严格小于 $S(m')$ 的充分必要条件。分数 $S(m)$ 和 $S(m')$ 与占据率成正比，因此是严格为正的量。不等式 $S(m)  S(m')$ 等价于它们的比值小于1：\n$$\n\\frac{S(m)}{S(m')}  1 \\implies R  1\n$$\n自然对数函数 $\\ln(x)$ 对所有 $x > 0$ 都是严格递增函数。因此，对不等式两边取对数会保持其方向：\n$$\n\\ln R  \\ln(1) \\implies \\ln R  0\n$$\n代入我们推导出的 $\\ln R$ 表达式，得到：\n$$\n-\\beta \\sum_{i=1}^{L} w_{i} (m_{i} - m'_{i})  0\n$$\n我们已知 $\\beta = 1/(k_{B} T)$。玻尔兹曼常数 $k_{B}$ 是正的，绝对温度 $T$ 也必须是正的。因此，$\\beta > 0$。所以，$-\\beta$ 是一个负常数。我们可以将不等式两边同时除以 $-\\beta$，并反转不等号的方向：\n$$\n\\sum_{i=1}^{L} w_{i} (m_{i} - m'_{i}) > 0\n$$\n这就是错配模式 $\\{m_{i}\\}$、$\\{m'_{i}\\}$ 和罚分权重 $\\{w_{i}\\}$ 使分数 $S(m)$ 严格小于 $S(m')$ 的充分必要条件。其物理诠释是直接的：位点 $m$ 的加权错配总罚分必须超过位点 $m'$ 的，这导致更高的自由能 $\\Delta G(m)$、更低的结合占据率，从而得到更低的分数。", "answer": "$$\n\\boxed{-\\beta \\sum_{i=1}^{L} w_{i} (m_{i} - m'_{i})}\n$$", "id": "2727933"}, {"introduction": "现代 gRNA 设计集成了多种数据类型以获得最准确的预测。贝叶斯框架非常适合这项任务，因为它可以正式地将来自基因组特征的先验知识与新的实验证据相结合。在这个高级练习 [@problem_id:2727874] 中，你将构建并应用一个贝叶斯模型来计算脱靶活性的后验概率，学习如何根据新数据更新认知。", "problem": "在为成簇规律间隔短回文重复序列（CRISPR）核酸内切酶设计引导RNA（gRNA）序列时，一个核心目标是最大限度地减少脱靶切割，同时保持在靶效率。考虑一个给定gRNA的单一候选脱靶基因组位点。设潜变量 $O \\in \\{0,1\\}$ 表示该位点是否可被脱靶切割（$O=1$）或不可（$O=0$）。你将构建一个贝叶斯框架，其中脱靶活性的先验概率取决于序列相似性和染色质背景，而后验概率则用测序实验证据进行更新。\n\n作为基本基础，使用贝叶斯定理和源自线性预测变量的概率的标准逻辑斯蒂连接函数。假设有以下模型组件。\n\n1. 将序列和染色质特征与脱靶概率联系起来的先验模型。设 $m_{s}$ 为种子区域的错配数，$m_{n}$ 为非种子区域的错配数，$A \\in [0,1]$ 为候选位点的染色质可及性（例如，来自转座酶可及染色质测序），$I_{\\text{ncPAM}} \\in \\{0,1\\}$ 表示前间隔序列邻近基序（PAM）是否为非经典型。设先验脱靶概率为 $p_{0} \\equiv \\mathbb{P}(O=1 \\mid m_{s}, m_{n}, A, I_{\\text{ncPAM}})$，其逻辑斯蒂规约如下：\n$$\n\\operatorname{logit}(p_{0}) \\equiv \\ln\\!\\left(\\frac{p_{0}}{1-p_{0}}\\right) \\;=\\; \\alpha \\;-\\; \\beta_{s}\\, m_{s} \\;-\\; \\beta_{n}\\, m_{n} \\;+\\; \\beta_{A}\\, A \\;-\\; \\beta_{P}\\, I_{\\text{ncPAM}}.\n$$\n\n2. 基于测序的双链断裂检测实验的证据模型（例如，通过测序进行的全基因组无偏见双链断裂识别），由候选位点的读数计数 $R \\in \\{0,1,2,\\ldots\\}$ 概括。以 $O$ 为条件，假设一个泊松读数计数模型，当 $O=1$ 时均值为 $\\lambda_{1}$，当 $O=0$ 时均值为 $\\lambda_{0}$：\n$$\nR \\mid (O=1) \\sim \\operatorname{Poisson}(\\lambda_{1}), \\qquad R \\mid (O=0) \\sim \\operatorname{Poisson}(\\lambda_{0}).\n$$\n\n(a) 从贝叶斯定理和上述定义出发，推导后验概率 $\\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}})$ 的闭式表达式，该表达式用 $\\alpha$, $\\beta_{s}$, $\\beta_{n}$, $\\beta_{A}$, $\\beta_{P}$, $m_{s}$, $m_{n}$, $A$, $I_{\\text{ncPAM}}$, $\\lambda_{1}$, $\\lambda_{0}$, 和 $r$ 表示。\n\n(b) 使用你推导的表达式，计算在以下参数值时的后验概率：\n$$\n\\alpha = -2.5,\\;\\; \\beta_{s} = 1.0,\\;\\; \\beta_{n} = 0.3,\\;\\; \\beta_{A} = 2.0,\\;\\; \\beta_{P} = 0.8,\n$$\n观测到的特征：\n$$\nm_{s} = 1,\\;\\; m_{n} = 2,\\;\\; A = 0.6,\\;\\; I_{\\text{ncPAM}} = 1,\n$$\n以及实验模型和观测值：\n$$\n\\lambda_{1} = 6.0,\\;\\; \\lambda_{0} = 0.5,\\;\\; r = 3.\n$$\n以区间 $[0,1]$ 内的小数形式报告后验概率。将你的答案四舍五入到四位有效数字。不要使用百分号。", "solution": "该问题具有科学依据，提法明确且客观。它展示了贝叶斯统计建模在计算生物学相关问题中的一个标准应用，特别是预测CRISPR-Cas9的脱靶活性。唯一解所需的所有组件都已提供，没有矛盾或含糊之处。因此，该问题是有效的，我们可以继续求解。\n\n设特征集表示为 $\\mathcal{F} = \\{m_{s}, m_{n}, A, I_{\\text{ncPAM}}\\}$。我们的任务是推导脱靶切割的后验概率 $\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$，然后为一组给定的参数和观测值计算其值。\n\n(a) 后验概率的推导。\n\n我们从贝叶斯定理开始。处理优势比（odds）最为方便。一个事件的后验优势比是其后验概率与其补集的后验概率之比。\n$$ \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\frac{\\mathbb{P}(R=r \\mid O=1, \\mathcal{F})}{\\mathbb{P}(R=r \\mid O=0, \\mathcal{F})} \\times \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} $$\n这个方程说明后验优势比是贝叶斯因子和先验优势比的乘积。\n\n问题陈述中指出，在给定状态 $O$ 的条件下，观测值 $R$ 与特征 $\\mathcal{F}$ 条件独立。因此，$\\mathbb{P}(R=r \\mid O, \\mathcal{F}) = \\mathbb{P}(R=r \\mid O)$。\n\n先验概率定义为 $p_{0} \\equiv \\mathbb{P}(O=1 \\mid \\mathcal{F})$。因此，先验优势比为 $\\frac{p_{0}}{1-p_{0}}$。问题给出了这个概率的logit值：\n$$ \\operatorname{logit}(p_{0}) = \\ln\\left(\\frac{p_{0}}{1-p_{0}}\\right) = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\n设这个线性预测变量为 $L_0$。先验优势比可以表示为：\n$$ \\frac{\\mathbb{P}(O=1 \\mid \\mathcal{F})}{\\mathbb{P}(O=0 \\mid \\mathcal{F})} = \\exp(L_0) = \\exp(\\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}}) $$\n\n贝叶斯因子 $BF$ 是在两个假设 $O=1$ 和 $O=0$ 下，观测值 $R=r$ 的似然之比。似然由泊松概率质量函数给出，$P(k; \\lambda) = \\frac{\\lambda^k e^{-\\lambda}}{k!}$。\n$$ BF = \\frac{\\mathbb{P}(R=r \\mid O=1)}{\\mathbb{P}(R=r \\mid O=0)} = \\frac{\\frac{\\lambda_{1}^{r} \\exp(-\\lambda_{1})}{r!}}{\\frac{\\lambda_{0}^{r} \\exp(-\\lambda_{0})}{r!}} = \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(-\\lambda_{1} + \\lambda_{0}) $$\n\n后验优势比是先验优势比和贝叶斯因子的乘积：\n$$ \\text{Odds}_{\\text{post}} = \\frac{\\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})}{\\mathbb{P}(O=0 \\mid R=r, \\mathcal{F})} = \\left[ \\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right)^{r} \\exp(\\lambda_{0} - \\lambda_{1}) \\right] \\times \\exp(L_0) $$\n后验优势比的对数，即后验logit，为：\n$$ \\ln(\\text{Odds}_{\\text{post}}) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + (\\lambda_{0} - \\lambda_{1}) + L_{0} $$\n\n为了得到后验概率，我们记作 $P_{\\text{post}} = \\mathbb{P}(O=1 \\mid R=r, \\mathcal{F})$，我们使用概率 $p$ 与其优势比之间的关系，$p = \\frac{\\text{Odds}}{1 + \\text{Odds}}$。这等同于对对数优势比应用标准逻辑斯蒂函数（sigmoid函数）$\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$。\n设 $Z = \\ln(\\text{Odds}_{\\text{post}})$。则 $P_{\\text{post}} = \\sigma(Z) = \\frac{1}{1 + \\exp(-Z)}$。\n\n代入完整的表达式，后验概率的闭式表达式为：\n$$ \\mathbb{P}(O=1 \\mid R=r, m_{s}, m_{n}, A, I_{\\text{ncPAM}}) = \\frac{1}{1 + \\exp\\left(-\\left( r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} + \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} \\right)\\right)} $$\n这就完成了(a)部分。\n\n(b) 后验概率的计算。\n\n我们得到以下数值：\n参数: $\\alpha = -2.5$, $\\beta_{s} = 1.0$, $\\beta_{n} = 0.3$, $\\beta_{A} = 2.0$, $\\beta_{P} = 0.8$。\n特征: $m_{s} = 1$, $m_{n} = 2$, $A = 0.6$, $I_{\\text{ncPAM}} = 1$。\n实验模型和观测值: $\\lambda_{1} = 6.0$, $\\lambda_{0} = 0.5$, $r = 3$。\n\n首先，我们计算先验对数优势比 $L_0$：\n$$ L_0 = \\alpha - \\beta_{s} m_{s} - \\beta_{n} m_{n} + \\beta_{A} A - \\beta_{P} I_{\\text{ncPAM}} $$\n$$ L_0 = -2.5 - (1.0)(1) - (0.3)(2) + (2.0)(0.6) - (0.8)(1) $$\n$$ L_0 = -2.5 - 1.0 - 0.6 + 1.2 - 0.8 $$\n$$ L_0 = -3.7 $$\n\n接下来，我们计算对数贝叶斯因子 $\\ln(BF)$：\n$$ \\ln(BF) = r \\ln\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) + \\lambda_{0} - \\lambda_{1} $$\n$$ \\ln(BF) = 3 \\ln\\left(\\frac{6.0}{0.5}\\right) + 0.5 - 6.0 $$\n$$ \\ln(BF) = 3 \\ln(12) - 5.5 $$\n使用 $\\ln(12) \\approx 2.4849066$ 的值，\n$$ \\ln(BF) \\approx 3 \\times 2.4849066 - 5.5 = 7.45472 - 5.5 = 1.95472 $$\n\n现在，我们通过将先验对数优势比和对数贝叶斯因子相加来计算后验对数优势比 $Z$：\n$$ Z = L_0 + \\ln(BF) $$\n$$ Z \\approx -3.7 + 1.95472 = -1.74528 $$\n\n最后，我们使用逻辑斯蒂函数计算后验概率 $P_{\\text{post}}$：\n$$ P_{\\text{post}} = \\frac{1}{1 + \\exp(-Z)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + \\exp(-(-1.74528))} = \\frac{1}{1 + \\exp(1.74528)} $$\n$$ P_{\\text{post}} \\approx \\frac{1}{1 + 5.72745} = \\frac{1}{6.72745} \\approx 0.148648 $$\n\n根据要求，将结果四舍五入到四位有效数字，得到 $0.1486$。", "answer": "$$\\boxed{0.1486}$$", "id": "2727874"}]}