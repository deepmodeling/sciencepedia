{"hands_on_practices": [{"introduction": "在改造一个生物体之前，我们常常需要先从自然界中找到一个已经具备所需特性的生物。这个练习将磨练你根据生态和生理线索推断生物体核心代谢策略的能力，正如[@problem_id:2084881]中所示。这对于为新的合成生物学应用进行生物勘探（bioprospecting）来说，是至关重要的第一步。", "problem": "一位微生物学家正在研究一种新发现的细菌，该细菌分离自一个永分层湖的缺氧沉积物。该湖的特点是稳定的分层，其底层（湖底水层）永久缺氧，并且富含由硫酸盐还原菌产生的硫化氢（$\\mathrm{H_2S}$）。这种新发现的细菌仅在能接收到少量过滤阳光的缺氧区的狭窄带中茁壮成长。实验室分析表明，该细菌拥有细菌叶绿素，并在细胞内积累元素硫（$\\mathrm{S^0}$）颗粒。即使提供有机碳源，它在黑暗中也无法生长。\n\n根据这些观察结果，以下哪项最能描述这种细菌的主要代谢策略？\n\nA. 产氧光合作用\n\nB. 使用有机酸作为电子供体的光合异养\n\nC. 使用硫化氢作为能源的化能自养\n\nD. 使用硫化氢作为电子供体的不产氧光合作用\n\nE. 以硫酸盐为最终电子受体的无氧呼吸", "solution": "我们首先提取关键观察结果：\n- 其生境为富含$\\mathrm{H_{2}S}$的缺氧湖底水层，并有一条狭窄的透光带。\n- 该细菌拥有细菌叶绿素。\n- 它在细胞内积累元素硫$\\mathrm{S^{0}}$颗粒。\n- 即使提供有机碳源，它在黑暗中也无法生长。\n\n每个观察结果的逻辑推论：\n1) 细菌叶绿素的存在意味着光能营养，这特别是不产氧光养生物的特征，而不是产氧光养生物（后者使用叶绿素$a$并产生$\\mathrm{O_{2}}$）的特征。\n2) 细胞内$\\mathrm{S^{0}}$颗粒表明$\\mathrm{H_{2}S}$被氧化为$\\mathrm{S^{0}}$，这是基于硫的光合作用的一部分。这是紫硫细菌的诊断性特征，它们在使用$\\mathrm{H_{2}S}$作为电子供体进行不产氧光合作用时，会在细胞内储存$\\mathrm{S^{0}}$。\n3) 即使有有机碳，在黑暗中也无法生长，这排除了光合异养的生活方式（该方式可在无光时转换为化能有机营养）；这表明它是专性光能营养。\n4) 其生态位（缺氧、富含$\\mathrm{H_{2}S}$、有光照的化变层）是进行不产氧光合作用的光养硫细菌的典型生态位。\n\n根据证据评估各个选项：\n- A. 产氧光合作用：错误。产氧光养生物使用$\\mathrm{H_{2}O}$作为电子供体，产生$\\mathrm{O_{2}}$，并利用叶绿素$a$，而不是细菌叶绿素。\n- B. 使用有机酸作为电子供体的光合异养：错误。这无法解释细胞内$\\mathrm{S^{0}}$颗粒的存在，并且将允许其在黑暗中利用有机物生长，而观察结果并非如此。\n- C. 使用硫化氢作为能源的化能自养：错误。化能自养生物不需要光，也不拥有细菌叶绿素；而该生物需要光，并且在黑暗中无法生长。\n- D. 使用硫化氢作为电子供体的不产氧光合作用：正确。这与细菌叶绿素的存在、对光的依赖性、缺氧生境、$\\mathrm{H_{2}S}$的利用以及细胞内$\\mathrm{S^{0}}$的积累相符。一个代表性的总反应是 $\\mathrm{CO_{2}} + 2\\mathrm{H_{2}S} \\xrightarrow{\\text{light}} (\\mathrm{CH_{2}O}) + \\mathrm{H_{2}O} + 2\\mathrm{S^{0}}$。\n- E. 以硫酸盐为最终电子受体的无氧呼吸：错误。这描述的是产生$\\mathrm{H_{2}S}$的硫酸盐还原菌，而不是一种依赖光、氧化$\\mathrm{H_{2}S}$并积累$\\mathrm{S^{0}}$的生物。\n\n因此，其主要代谢策略是使用$\\mathrm{H_{2}S}$作为电子供体的不产氧光合作用。", "answer": "$$\\boxed{D}$$", "id": "2084881"}, {"introduction": "鉴定出潜在的底盘生物后，我们必须能够培养它，并且常常需要面对与其他微生物的竞争。这个练习将从“鉴定”转向“培养”，要求你应用微生物动力学知识来设计一个生物反应器环境，从而为你期望的底盘生物提供竞争优势[@problem_id:2488528]。这阐明了底盘生物的选择与其生长环境的可控性是密不可分的。", "problem": "一个连续搅拌釜反应器（恒化器）中接种了包含厌氧氨氧化菌（anammox）和异养反硝化菌（denitrifiers）的混合菌群。您的任务是配置一种富集培养方案，该方案能选择性地促进anammox菌的生长而非反硝化菌，同时避免菌种被洗出。假设温度恒定为 $30\\,^{\\circ}\\mathrm{C}$，生物质完全悬浮（除水力停留外无额外的生物质截留），并具有以下广为接受的动力学和敏感性特征：\n\n- Anammox菌（自养型；电子供体：$\\mathrm{NH_4^+}$；电子受体：$\\mathrm{NO_2^-}$）：\n  - 最大比生长速率：$\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$。\n  - 半饱和常数：$K_{\\mathrm{NH_4}} = 0.5\\,\\mathrm{mg\\ N\\,L^{-1}}$，$K_{\\mathrm{NO_2}} = 0.3\\,\\mathrm{mg\\ N\\,L^{-1}}$。\n  - 溶解氧（DO）的非竞争性抑制，抑制常数为 $K_{i,\\mathrm{O_2},a} = 0.20\\,\\mathrm{mg\\ O_2\\,L^{-1}}$。\n  - 对游离亚硝酸（FNA，未电离的 $\\mathrm{HNO_2}$）有强烈的敏感性，抑制常数为 $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$；亚硝酸的酸解离常数为 $\\mathrm{p}K_a = 3.25$。\n  - 化学计量学上的最佳进水 $\\mathrm{NO_2^-}:\\mathrm{NH_4^+}$ 比例接近 $1.32:1$（以氮计）。\n\n- 反硝化菌（异养型；使用有机碳作为电子供体；在缺氧条件下使用 $\\mathrm{NO_2^-}$ 或 $\\mathrm{NO_3^-}$ 作为电子受体；当存在 $\\mathrm{O_2}$ 时，优先使用 $\\mathrm{O_2}$）：\n  - 在碳源充足条件下的最大比生长速率：$\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$。\n  - 半饱和常数：对于 $\\mathrm{NO_2^-}/\\mathrm{NO_3^-}$，$K_{\\mathrm{NO_x}} = 0.2\\,\\mathrm{mg\\ N\\,L^{-1}}$；对于有机碳（以化学需氧量 COD 表示），$K_{S,\\mathrm{COD}} = 20\\,\\mathrm{mg\\ COD\\,L^{-1}}$。\n  - 在有溶解氧的情况下，反硝化作用被抑制，好氧呼吸占优势；在没有有机碳的情况下，反硝化菌无法维持生长。\n\n您可以假设以下基本原理：\n- 恒化器稳态持存准则：一个种群只有在其净比生长速率 $\\mu$ 满足 $\\mu \\ge D$（其中 $D$ 是稀释率）时才能存活。\n- 对所需底物的Monod型依赖关系以及溶解氧（DO）和游离亚硝酸（FNA）的非竞争性抑制是这些功能菌群的恰当表征。\n- 总亚硝酸盐氮中FNA（未电离的 $\\mathrm{HNO_2}$）的比例由给定$\\mathrm{pH}$下的酸碱平衡决定。\n\n请考虑以下五种备选操作配置。在所有情况下，除非另有明确说明，否则均过量供应无机碳（碳酸氢盐）以满足自养需求。请选择最能构成一个富集方案的单一配置，该方案能选择性地富集anammox菌而非反硝化菌，同时提供稳健的防止洗出的安全边际。\n\nA. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；无额外添加有机碳（$0\\,\\mathrm{mg\\ COD\\,L^{-1}}$）；$\\mathrm{pH} = 7.5$；供应碳酸氢盐。\n\nB. $D = 0.20\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.50\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 100\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。\n\nC. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NO_3^--N} = 100\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 200\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{NH_4^+-N} = 0\\,\\mathrm{mg\\ N\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。\n\nD. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 50\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。\n\nE. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 10\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 60\\,\\mathrm{mg\\ N\\,L^{-1}}$；无额外添加有机碳（$0\\,\\mathrm{mg\\ COD\\,L^{-1}}$）；$\\mathrm{pH} = 6.7$；供应碳酸氢盐。\n\n根据所述原则，哪个选项最适合选择性地富集anammox菌？", "solution": "首先，将对问题陈述的科学性和逻辑完整性进行验证。\n\n### 步骤1：提取已知条件\n\n- **系统**：连续搅拌釜反应器（恒化器）。\n- **目标**：配置一种富集培养方案，以选择性地促进厌氧氨氧化菌（anammox）生长而非异养反硝化菌，同时避免菌种被洗出。\n- **假设**：恒定温度 $T = 30\\,^{\\circ}\\mathrm{C}$，生物质完全悬浮。\n\n**Anammox菌（自养型）：**\n- 电子供体：$\\mathrm{NH_4^+}$\n- 电子受体：$\\mathrm{NO_2^-}$\n- 最大比生长速率：$\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$\n- 半饱和常数：$K_{\\mathrm{NH_4}} = 0.5\\,\\mathrm{mg\\ N\\,L^{-1}}$，$K_{\\mathrm{NO_2}} = 0.3\\,\\mathrm{mg\\ N\\,L^{-1}}$\n- 溶解氧（DO）非竞争性抑制常数：$K_{i,\\mathrm{O_2},a} = 0.20\\,\\mathrm{mg\\ O_2\\,L^{-1}}$\n- 游离亚硝酸（FNA, $\\mathrm{HNO_2}$）抑制常数：$K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$\n- 亚硝酸的酸解离常数：$\\mathrm{p}K_a = 3.25$\n- 最佳进水比例：$\\mathrm{NO_2^-}:\\mathrm{NH_4^+} \\approx 1.32:1$（以氮计）\n\n**反硝化菌（异养型）：**\n- 电子供体：有机碳（COD）\n- 电子受体：$\\mathrm{NO_2^-}$ 或 $\\mathrm{NO_3^-}$（缺氧），或 $\\mathrm{O_2}$（好氧，优先）\n- 最大比生长速率：$\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$（碳源充足）\n- 半饱和常数：$K_{\\mathrm{NO_x}} = 0.2\\,\\mathrm{mg\\ N\\,L^{-1}}$，$K_{S,\\mathrm{COD}} = 20\\,\\mathrm{mg\\ COD\\,L^{-1}}$\n- 生长需要有机碳。反硝化作用被溶解氧抑制。\n\n**基本原理：**\n- 恒化器持存准则：净比生长速率 $\\mu \\ge D$（稀释率）。在稳态时，$\\mu = D$。\n- 生长动力学由Monod型方程及非竞争性抑制项表示。\n- FNA比例由酸碱平衡决定。\n\n### 步骤2：使用提取的已知条件进行验证\n\n问题陈述描述了恒化器中一个经典的微生物竞争情景，这是生物过程工程和微生物生态学的基石。\n- **科学依据**：该问题基于公认的微生物过程（厌氧氨氧化、反硝化）及其广为接受的动力学特征。给定的动力学参数（$\\mu_{\\max}$, $K_s$, $K_i$）处于科学文献中报道的这些微生物功能群的实际范围内。化学计量比是正确的。\n- **定义明确**：该问题提供了足够的信息和一个明确的目标，允许通过比较不同的操作条件得出一个唯一的、合乎逻辑的解。任务是从一组给定的配置中找出最佳配置，这是一个定义明确的问题。\n- **客观性**：语言技术性强、精确，且没有主观论断。所有参数均已量化。\n\n该问题不违反任何无效性标准。它是环境生物技术领域一个标准的、可解的问题。\n\n### 步骤3：结论与行动\n\n问题有效。将推导完整解答。\n\n### 解答推导\n\n目标是建立一个能为anammox菌提供选择性优势同时抑制反硝化菌的环境。选择策略源于这两个菌群之间的根本代谢差异。\n\n**Anammox菌的选择原则：**\n\n1.  **竞争者的底物限制**：反硝化菌是异养菌，需要有机碳作为电子供体和碳源。Anammox菌是自养菌，使用无机碳（碳酸氢盐）。对抗反硝化菌最有效的选择压力是在完全有机碳限制的条件下操作系统（即，进水中不提供有机碳）。\n2.  **稀释率控制**：Anammox菌是生长缓慢的微生物，给定的 $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$。根据恒化器持存准则，稀释率 $D$ 必须小于目标微生物的净最大比生长速率，以防止其被洗出。因此，要求 $D  \\mu_{a,\\max}$。\n3.  **提供Anammox底物**：反应器必须投加anammox生长所需的底物：铵（$\\mathrm{NH_4^+}$）和亚硝酸盐（$\\mathrm{NO_2^-}$）。为获得最佳性能，进水比例应接近化学计量需求，即 $\\mathrm{NO_2^-}:\\mathrm{NH_4^+} \\approx 1.32:1$。\n4.  **抑制作用的最小化**：\n    - **溶解氧（DO）抑制**：Anammox菌对溶解氧敏感。反应器中的溶解氧浓度必须保持在非常低的水平以最小化抑制。非竞争性抑制因子为 $I_{\\mathrm{O_2}} = K_{i,\\mathrm{O_2},a} / (K_{i,\\mathrm{O_2},a} + [\\mathrm{O_2}])$。\n    - **FNA抑制**：Anammox菌也受到游离亚硝酸（$\\mathrm{HNO_2}$）的抑制。FNA的浓度取决于总亚硝酸盐浓度和$\\mathrm{pH}$值，遵循平衡式 $\\mathrm{HNO_2} \\leftrightarrow \\mathrm{H^+} + \\mathrm{NO_2^-}$。总亚硝酸盐中以FNA形式存在的比例由公式 $\\alpha_{\\mathrm{FNA}} = (1 + 10^{\\mathrm{pH}-\\mathrm{p}K_a})^{-1}$ 给出。较高的$\\mathrm{pH}$（即 $\\mathrm{pH}  \\mathrm{p}K_a$）会显著降低FNA的比例，从而最小化抑制作用。\n\n我们现在将根据这四个原则对每个选项进行评估。\n\n### 逐项分析\n\n**A. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；无额外添加有机碳（$0\\,\\mathrm{mg\\ COD\\,L^{-1}}$）；$\\mathrm{pH} = 7.5$；供应碳酸氢盐。**\n1.  **有机碳**：进水COD为 $0\\,\\mathrm{mg\\ L^{-1}}$。这使得异养反硝化菌缺乏营养，为anammox菌提供了主要的选择压力。\n2.  **稀释率**：$D = 0.05\\,\\mathrm{d^{-1}}$。这远低于 $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$。Anammox菌不会被洗出，并能建立稳定的种群。这提供了一个稳健的操作窗口。\n3.  **底物**：进水同时含有 $\\mathrm{NH_4^+}$ 和 $\\mathrm{NO_2^-}$。其比例为 $[\\mathrm{NO_2^-}] / [\\mathrm{NH_4^+}] = 53 / 40 = 1.325$。这与最佳化学计量比 $1.32$ 极为接近，确保了高效的底物转化。\n4.  **抑制作用**：\n    - **溶解氧**：$[\\mathrm{O_2}] = 0.02\\,\\mathrm{mg\\ L^{-1}}$。抑制因子为 $I_{\\mathrm{O_2}} = 0.20 / (0.20 + 0.02) \\approx 0.91$。这意味着生长速率仅降低了 $9\\%$，影响很小，允许稳健的生长。\n    - **FNA**：在 $\\mathrm{pH} = 7.5$ 和 $\\mathrm{p}K_a = 3.25$ 的条件下，FNA的比例为 $\\alpha_{\\mathrm{FNA}} = (1 + 10^{7.5-3.25})^{-1} = (1 + 10^{4.25})^{-1} \\approx 5.6 \\times 10^{-5}$。这是一个极小的比例。即使有较高的残余亚硝酸盐浓度，FNA浓度也将微不足道，远低于抑制常数 $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$。抑制作用极小。\n\n结论：此配置满足了稳健且具有选择性的anammox富集培养的所有要求。\n判定：**正确**。\n\n**B. $D = 0.20\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.50\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 100\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。**\n1.  **稀释率**：$D = 0.20\\,\\mathrm{d^{-1}}$。这大于anammox菌的最大比生长速率 $\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$。Anammox种群在生物学上不可能存活；它将被完全从反应器中洗出。仅此一点就使该选项无效。\n2.  **有机碳**：供给了 $100\\,\\mathrm{mg\\ COD\\,L^{-1}}$，这将促进包括反硝化菌在内的异养菌的生长。\n3.  **抑制作用**：溶解氧浓度很高（$0.50\\,\\mathrm{mg\\ L^{-1}}$），对anammox菌造成严重抑制：$I_{\\mathrm{O_2}} = 0.20 / (0.20 + 0.50) \\approx 0.286$。有效的 $\\mu_{a,\\max}$ 将降低至 $\\approx 0.12 \\times 0.286 = 0.034\\,\\mathrm{d^{-1}}$，使得被洗出更为确定。在溶解氧和有机碳都存在的情况下，生长快速的好氧异养菌将占主导地位。\n\n结论：此配置保证了anammox菌被洗出，并选择了其他微生物。\n判定：**错误**。\n\n**C. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NO_3^--N} = 100\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 200\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{NH_4^+-N} = 0\\,\\mathrm{mg\\ N\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。**\n1.  **底物**：进水缺乏铵（$\\mathrm{NH_4^+-N} = 0$）。铵是anammox菌必需的底物（电子供体）。没有它，anammox菌无法生长。这种情况使anammox种群因缺乏底物而消亡，导致其被洗出。\n2.  **选择性**：所提供的条件（缺氧、存在硝酸盐和有机碳）对于异养反硝化菌进行常规反硝化是理想的。此配置是为反硝化菌而非anammox菌设计的富集方案。\n\n结论：此配置使anammox菌缺乏必需的底物。\n判定：**错误**。\n\n**D. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.00\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 40\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 53\\,\\mathrm{mg\\ N\\,L^{-1}}$；添加有机碳 $= 50\\,\\mathrm{mg\\ COD\\,L^{-1}}$；$\\mathrm{pH} = 7.5$。**\n1.  **有机碳**：供给了 $50\\,\\mathrm{mg\\ COD\\,L^{-1}}$ 的有机碳。这直接违反了主要的选择原则，因为它为竞争性的异养反硝化菌提供了食物来源。\n2.  **竞争**：反硝化菌（$\\mu_{d,\\max} = 0.80\\,\\mathrm{d^{-1}}$）的生长速度远快于anammox菌（$\\mu_{a,\\max} = 0.12\\,\\mathrm{d^{-1}}$）。通过提供有机碳，两个菌群将竞争共同的电子受体——亚硝酸盐（$\\mathrm{NO_2^-}$）。鉴于其动力学优势，反硝化菌很可能会胜过anammox菌，尤其是在争夺亚硝酸盐方面。这种设置未能选择性地富集anammox菌，反而最多形成一个混合菌群，最坏情况下则形成一个以反硝化菌为主导的菌群。\n\n结论：添加有机碳促进了竞争者的生长，破坏了选择性富集的目标。\n判定：**错误**。\n\n**E. $D = 0.05\\,\\mathrm{d^{-1}}$；$\\mathrm{DO} = 0.02\\,\\mathrm{mg\\ O_2\\,L^{-1}}$；进水$\\mathrm{NH_4^+-N} = 10\\,\\mathrm{mg\\ N\\,L^{-1}}$；进水$\\mathrm{NO_2^--N} = 60\\,\\mathrm{mg\\ N\\,L^{-1}}$；无额外添加有机碳（$0\\,\\mathrm{mg\\ COD\\,L^{-1}}$）；$\\mathrm{pH} = 6.7$；供应碳酸氢盐。**\n1.  **底物**：进水比例为 $[\\mathrm{NO_2^-}] / [\\mathrm{NH_4^+}] = 60 / 10 = 6$。这严重偏离了最佳比例 $1.32$。铵将成为限制性底物，反应器中将残留大量过量的亚硝酸盐。每消耗 $10\\,\\mathrm{mg\\ N\\,L^{-1}}$ 的 $\\mathrm{NH_4^+}$，大约只消耗 $13.2\\,\\mathrm{mg\\ N\\,L^{-1}}$ 的 $\\mathrm{NO_2^-}$。这将导致残余亚硝酸盐的积累，其浓度接近 $60 - 13.2 = 46.8\\,\\mathrm{mg\\ N\\,L^{-1}}$。\n2.  **抑制（FNA）**：$\\mathrm{pH}$值较低，为 $6.7$。在此$\\mathrm{pH}$下，FNA的比例为 $\\alpha_{\\mathrm{FNA}} = (1 + 10^{6.7-3.25})^{-1} = (1 + 10^{3.45})^{-1} \\approx 3.5 \\times 10^{-4}$。在残余亚硝酸盐浓度为 $\\approx 46.8\\,\\mathrm{mg\\ N\\,L^{-1}}$ 的情况下，反应器中的FNA浓度将为 $[\\mathrm{FNA}] \\approx 46.8 \\times 3.5 \\times 10^{-4} \\approx 0.0164\\,\\mathrm{mg\\ N\\,L^{-1}}$。这个值非常接近抑制常数 $K_{i,\\mathrm{FNA}} = 0.020\\,\\mathrm{mg\\ N\\,L^{-1}}$。FNA抑制因子将为 $I_{FNA} = 0.020 / (0.020 + 0.0164) \\approx 0.55$。这对anammox的生长速率构成了严重（$45\\%$）的抑制。\n3.  **稳健性**：考虑溶解氧和FNA双重抑制后，总的最大生长速率为 $\\mu_{a,net,\\max} \\approx \\mu_{a,\\max} \\times I_{\\mathrm{O_2}} \\times I_{FNA} \\approx 0.12 \\times 0.91 \\times 0.55 \\approx 0.060\\,\\mathrm{d^{-1}}$。这个速率仅略高于稀释率 $D = 0.05\\,\\mathrm{d^{-1}}$。该系统缺乏防止被洗出的稳健安全边际。任何导致更高残余亚硝酸盐或更低$\\mathrm{pH}$的微小工艺波动都可能轻易导致anammox菌被洗出。\n\n结论：由于非化学计量的底物投加和低$\\mathrm{pH}$值，此配置设计不佳，这两者共同造成了强烈的FNA抑制，并且没有为操作留下稳健的安全边际。\n判定：**错误**。\n\n**最终总结：**\n\n选项A是唯一正确应用了所有必要原则的配置，以实现对anammox菌的选择性富集并超越反硝化菌。它消除了竞争者的食物来源，使用了安全的稀释率，以正确的化学计量比提供了底物，并最小化了溶解氧和FNA的抑制作用，从而确保了一个稳健而稳定的过程。", "answer": "$$\\boxed{A}$$", "id": "2488528"}, {"introduction": "评估底盘生物的最后一步，也是最具定量性的一步，是预测它能否满足我们的生产目标。本练习将介绍通量平衡分析（Flux Balance Analysis, FBA），这是计算系统生物学的基石[@problem_id:2719662]。你将通过编写代码来模拟一个简化的代谢网络，并确定一个候选底盘是否能达到理论上的最高产物收率，这模拟了我们在代谢工程项目中如何对底盘生物进行计算筛选。", "problem": "给定一个为流平衡分析（Flux Balance Analysis, FBA）构建的线性代谢模型，由化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$、反应通量向量 $v \\in \\mathbb{R}^{n}$、稳态质量平衡约束 $S v = 0$ 以及通量边界 $l \\le v \\le u$ 指定。符号约定为：交换反应写为细胞内代谢物的消耗，系数为-1，因此正通量对应分泌，负通量对应摄取。在厌氧条件下，氧气交换通量必须约束为零。理论产物产率（每单位底物摄取量）在厌氧条件下定义为：当底物摄取通量固定为大小为1（即底物交换通量等于-1）时，在满足 $S v = 0$ 和包括氧气交换固定为零在内的所有边界条件的情况下，产物分泌通量的最优值。一个候选底盘会施加额外的通量边界（例如，基因敲除或容量限制）。问题在于，该候选底盘是否能达到与理论厌氧产率相同的最优产物通量。\n\n您必须编写一个程序，对每个测试用例执行以下操作：\n- 建立线性规划模型，在稳态约束 $S v = 0$、基础边界 $l \\le v \\le u$（厌氧条件，即氧气交换固定为零）以及底物摄取固定为-1的条件下，最大化产物分泌通量 $v_p$。求解该模型以获得理论厌氧产率 $Y^\\star$。\n- 将候选底盘的附加通量边界修改应用于 $(l, u)$，重新求解相同的线性规划问题，得到候选底盘的最优产物通量 $\\hat{Y}$。\n- 返回一个布尔值：当且仅当候选底盘能够在数值容差 $\\varepsilon = 10^{-9}$ 内达到理论厌氧产率，即 $|\\hat{Y} - Y^\\star| \\le \\varepsilon$ 且候选底盘问题可行时，该值为真；否则为假。如果任一线性规划问题不可行，则该情况下的结果视为假。\n\n需使用的基本约束：\n- 稳态质量平衡：$S v = 0$。\n- 通量边界：$l \\le v \\le u$。\n- 厌氧条件：氧气交换通量 $v_{\\mathrm{O2,ex}} = 0$。\n- 底物摄取归一化：底物交换通量 $v_{\\mathrm{sub,ex}} = -1$。\n- 目标：最大化 $v_p$。\n\n所有通量值都使用任意但一致的单位；单位不影响布尔输出。不涉及角度。不涉及百分比。\n\n测试套件（共享的化学计量网络，包含三个不同的候选底盘）：\n\n代谢物（$S$ 的行）：[GLC, PYR, ETOH, CO2, O2]。\n\n反应（$S$ 的列）：[EX_glc, RGly, RFer, RResp, EX_etoh, EX_co2, EX_o2]。\n\n反应解释：\n- EX_glc: 葡萄糖交换（允许摄取）。\n- RGly: 糖酵解，$ \\mathrm{GLC} \\rightarrow 2\\, \\mathrm{PYR}$。\n- RFer: 发酵，$ \\mathrm{PYR} \\rightarrow \\mathrm{ETOH} + \\mathrm{CO2}$。\n- RResp: 呼吸分支，$ \\mathrm{PYR} + \\mathrm{O2} \\rightarrow 3\\, \\mathrm{CO2}$（氧气和水的平衡未明确建模；这是一个追踪内部代谢物池的简化化学计量）。\n- EX_etoh: 乙醇交换（允许分泌）。\n- EX_co2: 二氧化碳交换（允许分泌）。\n- EX_o2: 氧气交换（原则上允许摄取，但在厌氧条件下固定为零）。\n\n化学计量矩阵 $S$（行按所列顺序对应代谢物，列按所列顺序对应反应）：\n- GLC行：$[-1, -1, 0, 0, 0, 0, 0]$。\n- PYR行：$[0, +2, -1, -1, 0, 0, 0]$。\n- ETOH行：$[0, 0, +1, 0, -1, 0, 0]$。\n- CO2行：$[0, 0, +1, +3, 0, -1, 0]$。\n- O2行：$[0, 0, 0, -1, 0, 0, -1]$。\n\n在应用厌氧和底物固定约束之前，按所列顺序排列的各反应的基础通量边界 $(l, u)$：\n- EX_glc: $l = -1$, $u = -1$（将底物摄取通量固定为-1）。\n- RGly: $l = 0$, $u = 1000$。\n- RFer: $l = 0$, $u = 1000$。\n- RResp: $l = 0$, $u = 1000$。\n- EX_etoh: $l = 0$, $u = 1000$。\n- EX_co2: $l = 0$, $u = 1000$。\n- EX_o2: $l = 0$, $u = 0$（厌氧条件）。\n\n产物反应索引：EX_etoh。底物交换索引：EX_glc。氧气交换索引：EX_o2。\n\n测试用例：\n- 情况A（理想情况）：无额外约束。预期：候选底盘达到理论厌氧产率。\n- 情况B（容量受限的发酵）：对RFer施加上限1.5（即为RFer设置 $u = 1.5$）。预期：如果理论产率超过1.5，则候选底盘无法达到理论厌氧产率。\n- 情况C（厌氧条件下的发酵敲除）：对RFer施加上限0（即敲除RFer）。预期：候选底盘问题不可行（在葡萄糖摄取固定且无氧气的情况下），因此无法达到理论产率。\n\n您的程序应使用数值求解器来实现线性规划。对于每种情况，输出一个布尔值，指示候选底盘是否能在容差 $\\varepsilon = 10^{-9}$ 内达到理论厌氧产率。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来，例如：`[True,False,True]`。", "solution": "所述问题是流平衡分析（Flux Balance Analysis, FBA）的一个标准应用，FBA是计算系统生物学中用于预测代谢通量分布的基石。该问题具有科学依据，是良定的，并且其参数已明确指定，足以得到唯一解。因此，该问题被认为是有效的，并将构建一个正式的解决方案。\n\n问题的核心是通过构建和求解一系列线性规划（Linear Programs, LPs）来评估代谢网络在不同约束下的生产能力。一个LP问题旨在优化一个线性目标函数，该函数受一组线性的等式和不等式约束。在此问题中，目标是最大化所需产物的分泌通量 $v_p$。这受到两种主要类型的约束：\n1. 稳态质量平衡约束，$S v = 0$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是化学计量矩阵，$m$ 是代谢物的数量，$n$ 是反应的数量。该约束规定，对于每种代谢物，其总生产速率必须等于总消耗速率。\n2. 热力学和容量约束，表示为每个通量的下界和上界，$l \\le v \\le u$。\n\n对于给定的特定网络，我们有 $m=5$ 种代谢物和 $n=7$ 个反应。化学计量矩阵 $S$ 如下：\n$$\nS = \\begin{pmatrix}\n-1  -1  0  0  0  0  0 \\\\\n 0  2  -1  -1  0  0  0 \\\\\n 0  0  1  0  -1  0  0 \\\\\n 0  0  1  3  0  -1  0 \\\\\n 0  0  0  -1  0  0  -1\n\\end{pmatrix}\n$$\n通量向量为 $v = [v_{\\mathrm{EX\\_glc}}, v_{\\mathrm{RGly}}, v_{\\mathrm{RFer}}, v_{\\mathrm{RResp}}, v_{\\mathrm{EX\\_etoh}}, v_{\\mathrm{EX\\_co2}}, v_{\\mathrm{EX\\_o2}}]^T$。感兴趣的产物是乙醇，因此目标是最大化其交换通量 $v_p = v_{\\mathrm{EX\\_etoh}}$，即通量向量的第 $v_4$ 个分量（使用基于0的索引）。\n\n该优化问题为：\n$$\n\\begin{aligned}\n \\underset{v \\in \\mathbb{R}^7}{\\text{maximize}}\n   v_4 \\\\\n \\text{subject to}\n   S v = 0 \\\\\n    l_i \\le v_i \\le u_i, \\quad \\text{for } i \\in \\{0, 1, \\dots, 6\\}\n\\end{aligned}\n$$\n在计算上，通过最小化目标函数的负值来求解此问题，使用的目标向量 $c \\in \\mathbb{R}^7$ 为 $c = [0, 0, 0, 0, -1, 0, 0]^T$。\n\n首先，我们确定理论厌氧产率 $Y^\\star$。这涉及使用基础通量边界求解LP。问题指定了固定的底物摄取 $v_{\\mathrm{EX\\_glc}} = -1$ 和厌氧条件 $v_{\\mathrm{EX\\_o2}} = 0$。这些条件被纳入基础边界向量中。让我们分析在这些固定通量下 $Sv=0$ 系统：\n方程组为：\n1. $ -v_0 - v_1 = 0 $\n2. $ 2v_1 - v_2 - v_3 = 0 $\n3. $ v_2 - v_4 = 0 $\n4. $ v_2 + 3v_3 - v_5 = 0 $\n5. $ -v_3 - v_6 = 0 $\n\n当 $v_0 = -1$ 且 $v_6 = 0$ 时：\n由方程 $1$：$-(-1) - v_1 = 0 \\implies v_1 = v_{\\mathrm{RGly}} = 1$。\n由方程 $5$：$-v_3 - 0 = 0 \\implies v_3 = v_{\\mathrm{RResp}} = 0$。\n代入方程 $2$：$2(1) - v_2 - 0 = 0 \\implies v_2 = v_{\\mathrm{RFer}} = 2$。\n代入方程 $3$：$2 - v_4 = 0 \\implies v_4 = v_{\\mathrm{EX\\_etoh}} = 2$。\n代入方程 $4$：$2 + 3(0) - v_5 = 0 \\implies v_5 = v_{\\mathrm{EX\\_co2}} = 2$。\n\n在这些固定的摄取/分泌条件下，稳态约束决定了一个唯一的通量向量：$v = [-1, 1, 2, 0, 2, 2, 0]^T$。只要该解满足其他通量边界，即对于基础情况 $v_1, v_2, v_3, v_4, v_5 \\in [0, 1000]$，该解就是可行的。这个唯一解确实在这些边界内。由于只有一种可能的通量分布，最大产物通量被唯一确定。因此，理论厌氧产率为 $Y^\\star = v_4 = 2$。\n\n现在，我们评估每个候选底盘：\n- **情况A（无额外约束）：** 约束与基础情况相同。LP解也相同。候选底盘的最优产物通量为 $\\hat{Y} = 2$。条件 $|\\hat{Y} - Y^\\star| \\le \\varepsilon$ 变为 $|2 - 2| \\le 10^{-9}$，该条件成立。候选底盘问题是可行的。结果为 **真 (True)**。\n\n- **情况B（容量受限的发酵）：** 施加了额外约束 $v_2 = v_{\\mathrm{RFer}} \\le 1.5$。然而，如上文推导，稳态质量平衡（$Sv=0$）和固定底物摄取（$v_0 = -1$）的组合迫使通过发酵反应的通量恰好为 $v_2 = 2$。新的约束 $v_2 \\le 1.5$ 与其他约束的推论直接矛盾。该LP的可行集为空。问题是不可行的。根据问题规则，如果候选底盘问题不可行，结果为 **假 (False)**。\n\n- **情况C（发酵敲除）：** 约束为 $v_2 = v_{\\mathrm{RFer}} = 0$。这是情况B中约束的一个更严格的版本。出于同样的原因，该约束与系统要求 $v_2 = 2$ 相矛盾。问题再次变得不可行。结果为 **假 (False)**。\n\n实现将遵循此逻辑，使用 `scipy.optimize.linprog` 求解所需的LP，并通过求解器的成功状态检查可行性。每种情况的最终布尔输出由候选底盘LP的可行性及其最优值与理论产率 $Y^\\star$ 的数值比较共同决定。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the FBA problem for three test cases to determine if a candidate chassis\n    can achieve the theoretical anaerobic product yield.\n    \"\"\"\n\n    # Define the metabolic network based on the problem statement.\n    # Metabolites (m=5): [GLC, PYR, ETOH, CO2, O2]\n    # Reactions (n=7): [EX_glc, RGly, RFer, RResp, EX_etoh, EX_co2, EX_o2]\n    S = np.array([\n        [-1., -1.,  0.,  0.,  0.,  0.,  0.],  # GLC\n        [ 0.,  2., -1., -1.,  0.,  0.,  0.],  # PYR\n        [ 0.,  0.,  1.,  0., -1.,  0.,  0.],  # ETOH\n        [ 0.,  0.,  1.,  3.,  0., -1.,  0.],  # CO2\n        [ 0.,  0.,  0., -1.,  0.,  0., -1.]   # O2\n    ])\n\n    # Base flux bounds (l, u), incorporating fixed substrate uptake and anaerobic conditions.\n    base_bounds = [\n        (-1.0, -1.0),    # EX_glc\n        (0.0, 1000.0),   # RGly\n        (0.0, 1000.0),   # RFer\n        (0.0, 1000.0),   # RResp\n        (0.0, 1000.0),   # EX_etoh\n        (0.0, 1000.0),   # EX_co2\n        (0.0, 0.0)       # EX_o2\n    ]\n\n    # Reaction indices\n    PRODUCT_IDX = 4    # Index for EX_etoh (product)\n    RFER_IDX = 2       # Index for RFer\n\n    # Numerical tolerance\n    EPSILON = 1e-9\n\n    def setup_and_solve_fba(c_obj, S_mat, bounds_list):\n        \"\"\"\n        A helper function to set up and solve the FBA linear program.\n\n        Args:\n            c_obj (np.array): The objective function vector.\n            S_mat (np.array): The stoichiometric matrix.\n            bounds_list (list of tuples): Flux bounds.\n\n        Returns:\n            tuple: A boolean indicating feasibility and the optimal value.\n        \"\"\"\n        b_eq = np.zeros(S_mat.shape[0])\n        res = linprog(c=c_obj, A_eq=S_mat, b_eq=b_eq, bounds=bounds_list, method='highs')\n        \n        if res.success:\n            # Objective is to maximize, so we negate the result of minimization\n            return True, -res.fun\n        else:\n            # If not successful (e.g., infeasible), return feasibility as False\n            return False, np.nan\n\n    # --- Step 1: Calculate the theoretical anaerobic yield Y_star ---\n    \n    # Objective: maximize product flux (v_p), which is equivalent to minimizing -v_p.\n    c = np.zeros(S.shape[1])\n    c[PRODUCT_IDX] = -1.0\n\n    base_feasible, Y_star = setup_and_solve_fba(c, S, base_bounds)\n\n    # If the base case is infeasible, no candidate can match it.\n    if not base_feasible:\n        print(\"[False,False,False]\")\n        return\n\n    # --- Step 2: Define and evaluate test cases ---\n    \n    # Case A: no additional constraints. Bounds are the same as base.\n    candidate_bounds_A = base_bounds\n    \n    # Case B: capacity-limited fermentation.\n    candidate_bounds_B = [list(b) for b in base_bounds]\n    candidate_bounds_B[RFER_IDX][1] = 1.5\n    \n    # Case C: fermentation knockout.\n    candidate_bounds_C = [list(b) for b in base_bounds]\n    candidate_bounds_C[RFER_IDX][1] = 0.0\n\n    test_case_bounds = [\n        candidate_bounds_A,\n        [tuple(b) for b in candidate_bounds_B],\n        [tuple(b) for b in candidate_bounds_C]\n    ]\n    \n    results = []\n    for bounds in test_case_bounds:\n        candidate_feasible, Y_hat = setup_and_solve_fba(c, S, bounds)\n        \n        # A candidate must have a feasible solution to be considered successful.\n        if not candidate_feasible:\n            results.append(False)\n            continue\n        \n        # If feasible, check if it achieves the theoretical yield within tolerance.\n        can_achieve = abs(Y_hat - Y_star) = EPSILON\n        results.append(can_achieve)\n\n    # --- Step 3: Print final output in the required format ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2719662"}]}