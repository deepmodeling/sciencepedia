{"hands_on_practices": [{"introduction": "在合成生物学中，将理论转化为可预测的实验结果是核心能力。这个练习探讨了一个基本问题：在一个需要构建两个精确连接点的基因整合项目中，我们如何从分子水平的保真度来估算筛选到完美克隆的工作量？[@problem_id:2721167] 通过应用基本的概率论，我们将一个看似复杂的筛选过程简化为一个清晰的数学模型，这对于合理规划实验资源至关重要。", "problem": "一位合成生物学家正在使用由成簇的规律间隔的短回文重复序列 (CRISPR) 引导的同源介导修复 (HDR) 技术，将一个基因盒整合到染色体中。该基因盒需要正确形成恰好两个染色体连接点（一个左同源臂和一个右同源臂），并且只有当两个连接点在核苷酸水平上都正确时，一个克隆才被视为完美整合。假设对于一个给定的整合平台和设计，每个单独的连接点正确形成的概率为 $q$，且与其他连接点的形成相互独立。任何具有至少一个不正确连接点的克隆都被归类为易错克隆，这反映了偏离模板化HDR的错误修复过程，例如非同源末端连接 (NHEJ) 或微同源介导修复。\n\n从独立伯努利事件的概率第一性原理和重复独立试验的期望标准定义出发，推导以下表达式：\n- 两个连接点都完美正确的克隆比例，\n- 易错克隆（即至少有一个不正确连接点）的比例，\n- 以及在筛选的 $N$ 个独立菌落中完美整合克隆的期望数量。\n\n然后，对 $q = 0.92$ 和 $N = 480$ 的情况计算这些表达式的值。所有概率都以小数形式表示（而非百分比）。将所有报告的数值结果四舍五入到四位有效数字。按照以下顺序提供最终的数值结果：完美整合的比例、易错的比例、完美整合克隆的期望数量。您的最终数值输出必须是一个单行矩阵。", "solution": "所提出的问题是将基础概率论应用于生物过程简化模型的标准应用。该问题有科学依据，提法恰当，并包含获得唯一解所需的所有信息。因此，该问题被认为是有效的。我们将开始推导。\n\n令 $L$ 表示左侧染色体连接点正确形成的事件。\n令 $R$ 表示右侧染色体连接点正确形成的事件。\n\n根据问题陈述，任何单个连接点正确形成的概率为 $q$。因此，我们有以下概率：\n$$ P(L) = q $$\n$$ P(R) = q $$\n\n问题明确指出，两个连接点的形成是独立事件。\n\n首先，我们必须推导两个连接点都完美正确的克隆比例的表达式。一个克隆是完美整合的，当且仅当左连接点和右连接点都正确。这对应于事件 $L$ 和 $R$ 的交集。令 $P_{perfect}$ 表示此概率。由于 $L$ 和 $R$ 的独立性，它们交集的概率是它们各自概率的乘积：\n$$ P_{perfect} = P(L \\cap R) = P(L) \\times P(R) = q \\times q = q^2 $$\n\n其次，我们需要推导易错克隆比例的表达式。一个易错克隆被定义为至少有一个不正确的连接点。该事件是一个克隆完美整合（即两个连接点都正确）的逻辑补集。因此，一个克隆是易错的概率，记为 $P_{error}$，是：\n$$ P_{error} = 1 - P_{perfect} $$\n代入我们上面推导的 $P_{perfect}$ 的表达式，我们得到：\n$$ P_{error} = 1 - q^2 $$\n\n第三，我们必须推导在 $N$ 个独立菌落中完美整合克隆的期望数量。令 $X$ 为一个代表在 $N$ 个菌落样本中完美整合克隆数量的随机变量。对 $N$ 个菌落中的每一个进行筛选都是一次独立的伯努利试验，其中“成功”是找到一个完美整合的克隆。在任何一次试验中成功的概率是 $p = P_{perfect} = q^2$。\n\n因此，随机变量 $X$ 服从二项分布，$X \\sim B(N, p)$，其中 $p = q^2$。一个服从二项分布的随机变量的期望值由试验次数和每次试验成功的概率的乘积给出。令 $E[X_{perfect}]$ 表示这个期望。\n$$ E[X_{perfect}] = N \\times p = N \\times q^2 $$\n这也可以使用指示变量从第一性原理推导出来。令 $X_i$ 为第 $i$ 个菌落的指示变量，其中 $i = 1, 2, \\dots, N$。我们定义如果第 $i$ 个菌落是完美整合的，则 $X_i = 1$，否则 $X_i = 0$。$X_i$ 的期望值为：\n$$ E[X_i] = 1 \\cdot P(X_i=1) + 0 \\cdot P(X_i=0) = P(X_i=1) = q^2 $$\n完美克隆的总数是和 $X = \\sum_{i=1}^{N} X_i$。根据期望的线性性质：\n$$ E[X_{perfect}] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i] = \\sum_{i=1}^{N} q^2 = Nq^2 $$\n推导现已完成。\n\n给定具体值 $q = 0.92$ 和 $N = 480$。我们现在将计算推导出的表达式，并将结果四舍五入到四位有效数字。\n\n完美整合克隆的比例是：\n$$ P_{perfect} = q^2 = (0.92)^2 = 0.8464 $$\n\n易错克隆的比例是：\n$$ P_{error} = 1 - q^2 = 1 - 0.8464 = 0.1536 $$\n\n完美整合克隆的期望数量是：\n$$ E[X_{perfect}] = Nq^2 = 480 \\times (0.92)^2 = 480 \\times 0.8464 = 406.272 $$\n将此结果四舍五入到四位有效数字得到 $406.3$。\n\n最终的数值结果是：完美整合克隆的比例为 $0.8464$，易错克隆的比例为 $0.1536$，以及在 $480$ 个样本中完美整合克隆的期望数量为 $406.3$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.8464 & 0.1536 & 406.3 \\end{pmatrix}}$$", "id": "2721167"}, {"introduction": "成功的基因整合通常取决于关键设计参数，如同源臂的长度。此练习超越了固定的成功概率，引导我们建立一个描述整合效率如何随同源臂长度变化的物理模型。[@problem_id:2721188] 我们将学习如何利用泊松过程这一基本随机模型来描述重组事件，并使用最大似然估计方法，根据真实的实验数据来校准我们的模型参数，从而实现对整合策略的定量预测和优化。", "problem": "在出芽酵母中，通过同源重组（HR）进行的染色体整合，转化子具有期望整合的概率随总有效同源长度的增加而增加。考虑一个基于以下假设的机理模型：(i) 沿着同源DNA的有效重组起始事件，以每碱基对（bp）恒定的线性速率密度 $\\alpha$ 发生，构成一个空间泊松过程，(ii) 如果在长度为 $L$ 的可用有效同源区域内的任何位置发生至少一次有效起始事件，则实现一次成功整合，并且 (iii) 每个转化子代表一次独立的伯努利试验，其成功概率等于整合效率 $E(L)$。现给出在其他条件相同的情况下，于四种同源长度下收集的独立数据：\n- 在 $L_1 = 40$ bp 时， $n_1 = 100$ 个转化子中有 $k_1 = 26$ 个整合，\n- 在 $L_2 = 80$ bp 时， $n_2 = 100$ 个转化子中有 $k_2 = 52$ 个整合，\n- 在 $L_3 = 160$ bp 时， $n_3 = 100$ 个转化子中有 $k_3 = 80$ 个整合，\n- 在 $L_4 = 320$ bp 时， $n_4 = 100$ 个转化子中有 $k_4 = 94$ 个整合。\n\n任务：\n1. 从沿着长度为 $L$、速率密度为 $\\alpha$（单位为 $\\mathrm{bp}^{-1}$）的起始泊松模型出发，并根据HR成功的定义（在 $L$ 内至少发生一次起始事件），推导整合效率 $E(L)$ 作为 $L$ 和 $\\alpha$ 的函数表达式。\n2. 对每个长度 $L_i$ 处的 $(k_i,n_i)$ 使用二项抽样模型，写出 $\\alpha$ 的对数似然函数，并通过求解相应的一阶条件来获得 $\\alpha$ 的最大似然估计。\n3. 使用您估计的 $\\alpha$，计算在 $L^{\\star} = 200$ bp 处的预测整合效率。将您的最终答案四舍五入到四位有效数字。将最终效率表示为无单位的小数。不要报告中间结果。仅报告预测效率的最终数值。", "solution": "必须首先严格验证问题陈述。\n\n步骤1：提取已知条件。\n问题提供了以下模型假设和数据：\n(i) 有效重组起始事件以每碱基对（bp）恒定的线性速率密度 $\\alpha$ 沿着同源DNA发生，构成一个空间泊松过程。\n(ii) 如果在长度为 $L$ 的可用有效同源区域内的任何位置发生至少一次有效起始事件，则实现一次成功整合。\n(iii) 每个转化子代表一次独立的伯努利试验，其成功概率等于整合效率 $E(L)$。\n\n所提供的数据包括四组独立数据集：\n- $L_1 = 40$ bp， $k_1 = 26$ 次整合， $n_1 = 100$ 个转化子。\n- $L_2 = 80$ bp， $k_2 = 52$ 次整合， $n_2 = 100$ 个转化子。\n- $L_3 = 160$ bp， $k_3 = 80$ 次整合， $n_3 = 100$ 个转化子。\n- $L_4 = 320$ bp， $k_4 = 94$ 次整合， $n_4 = 100$ 个转化子。\n\n任务是：\n1. 推导整合效率 $E(L)$ 的表达式。\n2. 获得 $\\alpha$ 的最大似然估计（MLE）。\n3. 计算在 $L^{\\star} = 200$ bp 处的预测整合效率，并四舍五入到四位有效数字。\n\n步骤2：使用提取的已知条件进行验证。\n根据验证标准评估该问题。\n- **科学依据：** 该模型是生物物理学和分子生物学中常见的“单次命中”动力学过程的标准简化表示。使用泊松过程描述沿空间维度的随机事件，以及使用二项抽样处理实验结果，是科学领域中公认的统计方法。该问题具有科学现实性。\n- **适定性：** 问题提供了足够的信息来推导模型、构建似然函数和估计参数。预测请求是所推导模型的直接应用。预期最大似然估计（MLE）存在唯一解。\n- **客观性：** 问题以精确的定量术语陈述，没有主观或模糊的语言。\n- **完整性和一致性：** 提供了所有必要的数据（$L_i, k_i, n_i$）和模型假设。没有矛盾之处。\n该问题是应用于生物学问题的数学建模和统计推断的标准练习。它满足有效问题的所有标准。\n\n步骤3：结论与行动。\n该问题被认定为有效。将提供完整的解答。\n\n**第1部分：推导整合效率 $E(L)$**\n设 $N(L)$ 为沿长度为 $L$ 的DNA片段发生的有效重组起始事件数量的随机变量。根据假设（i），$N(L)$ 服从泊松分布，其均值参数为 $\\lambda = \\alpha L$，其中 $\\alpha$ 是以 $\\mathrm{bp}^{-1}$ 为单位的速率密度。其概率质量函数为：\n$$P(N(L) = m) = \\frac{(\\alpha L)^m \\exp(-\\alpha L)}{m!}$$\n对于 $m = 0, 1, 2, \\dots$。\n\n根据假设（ii），如果发生至少一次起始事件，即 $N(L) \\ge 1$，则整合成功。该事件的概率即为整合效率 $E(L)$。\n$$E(L) = P(N(L) \\ge 1)$$\n计算其互补事件的概率更为直接，即整合失败，对应于零次起始事件，$N(L) = 0$。\n$$P(N(L) = 0) = \\frac{(\\alpha L)^0 \\exp(-\\alpha L)}{0!} = \\exp(-\\alpha L)$$\n根据全概率定律，效率为：\n$$E(L) = 1 - P(N(L) = 0) = 1 - \\exp(-\\alpha L)$$\n这就是所要求的整合效率作为 $L$ 和 $\\alpha$ 的函数的表达式。\n\n**第2部分：$\\alpha$的最大似然估计**\n根据假设（iii），对于每个同源长度 $L_i$，$n_i$ 个总转化子中的成功整合数 $k_i$ 服从二项分布，$k_i \\sim \\mathrm{Binomial}(n_i, p_i)$，其中成功概率为 $p_i = E(L_i) = 1 - \\exp(-\\alpha L_i)$。\n\n在长度 $L_i$ 处单个数据点 $(k_i, n_i)$ 的似然函数为：\n$$L_i(\\alpha; k_i, n_i, L_i) = \\binom{n_i}{k_i} p_i^{k_i} (1 - p_i)^{n_i - k_i} = \\binom{n_i}{k_i} (1 - \\exp(-\\alpha L_i))^{k_i} (\\exp(-\\alpha L_i))^{n_i - k_i}$$\n由于四个实验是独立的，完整数据集的总似然函数 $L(\\alpha)$ 是各个似然函数的乘积：\n$$L(\\alpha) = \\prod_{i=1}^{4} L_i(\\alpha) = \\prod_{i=1}^{4} \\binom{n_i}{k_i} (1 - \\exp(-\\alpha L_i))^{k_i} \\exp(-\\alpha L_i(n_i - k_i))$$\n为了找到 $\\alpha$ 的最大似然估计（MLE），我们最大化对数似然函数 $\\ell(\\alpha) = \\ln(L(\\alpha))$。\n$$\\ell(\\alpha) = \\sum_{i=1}^{4} \\left[ \\ln\\binom{n_i}{k_i} + k_i \\ln(1 - \\exp(-\\alpha L_i)) - \\alpha L_i (n_i - k_i) \\right]$$\n通过对 $\\ell(\\alpha)$ 求关于 $\\alpha$ 的导数并令其为零，可以找到最大似然估计量，记作 $\\hat{\\alpha}$。\n$$\\frac{d\\ell}{d\\alpha} = \\sum_{i=1}^{4} \\left[ k_i \\frac{1}{1 - \\exp(-\\alpha L_i)} \\cdot (L_i \\exp(-\\alpha L_i)) - L_i(n_i - k_i) \\right] = 0$$\n这可以整理为：\n$$\\sum_{i=1}^{4} \\frac{k_i L_i \\exp(-\\alpha L_i)}{1 - \\exp(-\\alpha L_i)} = \\sum_{i=1}^{4} L_i(n_i - k_i)$$\n或者，等价地：\n$$\\sum_{i=1}^{4} \\frac{k_i L_i}{\\exp(\\alpha L_i) - 1} = \\sum_{i=1}^{4} L_i(n_i - k_i)$$\n这是一个关于 $\\alpha$ 的非线性方程，必须进行数值求解。我们代入给定的数据：\n$L_1=40, k_1=26, n_1=100$\n$L_2=80, k_2=52, n_2=100$\n$L_3=160, k_3=80, n_3=100$\n$L_4=320, k_4=94, n_4=100$\n\n等式右边（RHS）计算如下：\n$\\mathrm{RHS} = (40)(100-26) + (80)(100-52) + (160)(100-80) + (320)(100-94)$\n$\\mathrm{RHS} = (40)(74) + (80)(48) + (160)(20) + (320)(6) = 2960 + 3840 + 3200 + 1920 = 11920$\n\n等式左边（LHS）为：\n$\\mathrm{LHS}(\\alpha) = \\frac{(26)(40)}{\\exp(40\\alpha) - 1} + \\frac{(52)(80)}{\\exp(80\\alpha) - 1} + \\frac{(80)(160)}{\\exp(160\\alpha) - 1} + \\frac{(94)(320)}{\\exp(320\\alpha) - 1}$\n$\\mathrm{LHS}(\\alpha) = \\frac{1040}{\\exp(40\\alpha) - 1} + \\frac{4160}{\\exp(80\\alpha) - 1} + \\frac{12800}{\\exp(160\\alpha) - 1} + \\frac{30080}{\\exp(320\\alpha) - 1}$\n\n使用数值求根算法（如牛顿-拉弗森法或二分法）求解方程 $\\mathrm{LHS}(\\alpha) = 11920$，得到 $\\alpha$ 的最大似然估计为：\n$$\\hat{\\alpha} \\approx 0.009080875 \\, \\mathrm{bp}^{-1}$$\n\n**第3部分：在 $L^{\\star} = 200$ bp 处的整合效率预测**\n使用估计的参数 $\\hat{\\alpha}$，我们可以预测在新的同源长度 $L^{\\star} = 200$ bp 时的整合效率。\n预测效率 $E(L^{\\star})$ 由第1部分推导的模型给出：\n$$E(L^{\\star}) = 1 - \\exp(-\\hat{\\alpha} L^{\\star})$$\n代入数值 $\\hat{\\alpha} \\approx 0.009080875$ 和 $L^{\\star} = 200$：\n$$E(200) = 1 - \\exp(-0.009080875 \\times 200) = 1 - \\exp(-1.816175)$$\n计算该值：\n$$\\exp(-1.816175) \\approx 0.162645$$\n$$E(200) \\approx 1 - 0.162645 = 0.837355$$\n问题要求将最终答案四舍五入到四位有效数字。\n$$E(200) \\approx 0.8374$$\n这就是在同源长度为 $200$ bp 时的预测整合效率。", "answer": "$$\\boxed{0.8374}$$", "id": "2721188"}, {"introduction": "基因组编辑是一个动态过程，期望的同源指导修复（HDR）与非同源末端连接（NHEJ）等错误修复途径之间存在着激烈的动力学竞争。本练习将我们带入系统动力学建模的核心，通过构建和求解常微分方程组来追踪细胞群体在不同状态下的时间演化。[@problem_id:2721191] 这种方法不仅让我们能够预测整合产物的时间进程，还为我们从时间序列数据中推断关键的切割和修复速率常数提供了严谨的统计框架。", "problem": "一个克隆细胞群体经过基因组编辑，使用了成簇的规律性间隔的短回文重复序列相关蛋白9 (CRISPR-Cas9) 和双链供体模板。在单个基因组位点上，存在四种相互排斥的细胞状态：未切割的野生型 $U$、双链断裂 (DSB) 中间体 $C$、同源指导修复 (HDR) 整合型 $H$ 和非同源末端连接 (NHEJ) 突变型 $N$。假设存在以下由质量作用定律支配的基本一阶转变：$U \\xrightarrow{k_{cut}} C$、$C \\xrightarrow{k_{HDR}} H$ 和 $C \\xrightarrow{k_{NHEJ}} N$。假设没有逆向反应，并且 $U$、$C$、$H$ 和 $N$ 表示在所有时间其总和为 $1$ 的分数。在时间 $t=0$ 时，假设 $U(0)=1$ 且 $C(0)=H(0)=N(0)=0$。\n\n从一阶质量作用动力学和概率守恒的定义出发，推导关于 $U(t)$、$C(t)$、$H(t)$ 和 $N(t)$ 的常微分方程组，并求解该方程组，以获得时间分辨的HDR整合分数 $H(t)$ 作为 $k_{cut}$、$k_{HDR}$、$k_{NHEJ}$ 和 $t$ 的函数的闭式表达式。您的推导过程应明确展示从基本动力学假设到最终表达式的步骤。\n\n然后，使用已解出的表达式，并且不引入任何额外的非物理假设，概述一种基于统计学原理的方法，用于从以下实验设计下的 $U(t)$、$H(t)$ 和 $N(t)$ 的群体时间进程测量中推断 $k_{cut}$、$k_{HDR}$ 和 $k_{NHEJ}$：您在一个早期时间 $t_{u}>0$ 观察 $U(t)$，并在一个从早期到晚期的时间序列 $\\{t_{i}\\}_{i=1}^{m}$（其中 $m \\geq 3$）中观察 $H(t)$ 和 $N(t)$。您的概述应从多项式计数的似然函数结构开始，其概率由模型预测的分数给出，并描述如何恢复然后分离可识别的参数组合。\n\n将您报告的最终结果表示为您推导出的 $H(t)$ 的显式闭式表达式。最终表达式中不需要数值计算或四舍五入，也不需要单位。只报告 $H(t)$ 作为您的最终答案。", "solution": "所提出的问题是化学动力学和参数推断中的一个标准练习，其基础是一个简化但有效的CRISPR-Cas9基因组编辑结果模型。该问题在科学上是合理的、定义明确的，并且包含足够的信息以获得唯一解。我将开始推导。\n\n该系统由代表细胞群体分数的四个相互排斥的状态组成：未切割的野生型 ($U$)、双链断裂中间体 ($C$)、同源指导修复 ($H$) 和非同源末端连接 ($N$)。总分数是守恒的：对于所有时间 $t \\ge 0$，有 $U(t) + C(t) + H(t) + N(t) = 1$。该过程由三个基本的一阶反应控制：\n$1$. $U \\xrightarrow{k_{cut}} C$\n$2$. $C \\xrightarrow{k_{HDR}} H$\n$3$. $C \\xrightarrow{k_{NHEJ}} N$\n\n根据一阶动力学的质量作用定律，我们可以构建描述每个分数变化率的常微分方程组 (ODEs)。\n\n未切割分数 $U$ 的消耗速率与其自身浓度成正比：\n$$ \\frac{dU}{dt} = -k_{cut} U(t) $$\n\n中间分数 $C$ 由 $U$ 产生，并通过转化为 $H$ 和 $N$ 而消耗。$C$ 的总消耗速率为 $(k_{HDR} + k_{NHEJ})C(t)$。定义一个总修复速率常数 $k_{repair} = k_{HDR} + k_{NHEJ}$ 会很方便。\n$$ \\frac{dC}{dt} = k_{cut} U(t) - k_{HDR} C(t) - k_{NHEJ} C(t) = k_{cut} U(t) - (k_{HDR} + k_{NHEJ}) C(t) $$\n\n最终产物分数 $H$ 和 $N$ 由中间体 $C$ 产生：\n$$ \\frac{dH}{dt} = k_{HDR} C(t) $$\n$$ \\frac{dN}{dt} = k_{NHEJ} C(t) $$\n\n初始条件为 $U(0) = 1$ 和 $C(0) = H(0) = N(0) = 0$。我们按顺序求解这个线性常微分方程组。\n\n首先，我们求解 $U(t)$。关于 $U(t)$ 的方程是一个简单的指数衰减：\n$$ \\frac{dU}{U} = -k_{cut} dt \\implies \\int_{U(0)}^{U(t)} \\frac{d\\tilde{U}}{\\tilde{U}} = \\int_{0}^{t} -k_{cut} d\\tau $$\n在 $U(0) = 1$ 的条件下，解为：\n$$ U(t) = \\exp(-k_{cut} t) $$\n\n接下来，我们通过将 $U(t)$ 的表达式代入第二个常微分方程来求解 $C(t)$。令 $k_{repair} = k_{HDR} + k_{NHEJ}$。\n$$ \\frac{dC}{dt} + k_{repair} C(t) = k_{cut} \\exp(-k_{cut} t) $$\n这是一个一阶线性非齐次常微分方程。我们使用积分因子 $I(t) = \\exp(\\int k_{repair} dt) = \\exp(k_{repair} t)$ 来求解它。\n$$ \\frac{d}{dt} \\left( C(t) \\exp(k_{repair} t) \\right) = k_{cut} \\exp(-k_{cut} t) \\exp(k_{repair} t) = k_{cut} \\exp((k_{repair} - k_{cut}) t) $$\n对两边从 $\\tau=0$ 到 $\\tau=t$ 进行积分：\n$$ C(t) \\exp(k_{repair} t) - C(0) \\exp(0) = \\int_0^t k_{cut} \\exp((k_{repair} - k_{cut}) \\tau) d\\tau $$\n已知 $C(0) = 0$，我们有两种情况。\n情况1：$k_{repair} \\neq k_{cut}$。\n$$ C(t) \\exp(k_{repair} t) = k_{cut} \\left[ \\frac{\\exp((k_{repair} - k_{cut}) \\tau)}{k_{repair} - k_{cut}} \\right]_0^t = \\frac{k_{cut}}{k_{repair} - k_{cut}} (\\exp((k_{repair} - k_{cut}) t) - 1) $$\n$$ C(t) = \\frac{k_{cut}}{k_{repair} - k_{cut}} (\\exp(-k_{cut} t) - \\exp(-k_{repair} t)) $$\n情况2：$k_{repair} = k_{cut}$。\n$$ C(t) \\exp(k_{cut} t) = \\int_0^t k_{cut} d\\tau = k_{cut} t $$\n$$ C(t) = k_{cut} t \\exp(-k_{cut} t) $$\n\n最后，我们通过对其速率方程进行积分来求解 $H(t)$，使用已推导出的 $C(t)$ 表达式。\n$$ H(t) - H(0) = \\int_0^t \\frac{dH}{d\\tau} d\\tau = \\int_0^t k_{HDR} C(\\tau) d\\tau $$\n在 $H(0) = 0$ 的条件下：\n$$ H(t) = k_{HDR} \\int_0^t C(\\tau) d\\tau $$\n我们再次考虑两种情况。对于 $k_{repair} \\neq k_{cut}$ 的一般情况：\n$$ H(t) = k_{HDR} \\int_0^t \\frac{k_{cut}}{k_{repair} - k_{cut}} (\\exp(-k_{cut} \\tau) - \\exp(-k_{repair} \\tau)) d\\tau $$\n$$ H(t) = \\frac{k_{HDR} k_{cut}}{k_{repair} - k_{cut}} \\left[ \\frac{\\exp(-k_{cut} \\tau)}{-k_{cut}} - \\frac{\\exp(-k_{repair} \\tau)}{-k_{repair}} \\right]_0^t $$\n$$ H(t) = \\frac{k_{HDR} k_{cut}}{k_{repair} - k_{cut}} \\left[ \\left( -\\frac{\\exp(-k_{cut} t)}{k_{cut}} + \\frac{\\exp(-k_{repair} t)}{k_{repair}} \\right) - \\left( -\\frac{1}{k_{cut}} + \\frac{1}{k_{repair}} \\right) \\right] $$\n$$ H(t) = \\frac{k_{HDR} k_{cut}}{k_{repair} - k_{cut}} \\left[ \\frac{1 - \\exp(-k_{cut} t)}{k_{cut}} - \\frac{1 - \\exp(-k_{repair} t)}{k_{repair}} \\right] $$\n将 $k_{repair} = k_{HDR} + k_{NHEJ}$ 代回，我们得到 $H(t)$ 的闭式表达式：\n$$ H(t) = \\frac{k_{HDR} k_{cut}}{k_{HDR} + k_{NHEJ} - k_{cut}} \\left( \\frac{1 - \\exp(-k_{cut} t)}{k_{cut}} - \\frac{1 - \\exp(-(k_{HDR} + k_{NHEJ}) t)}{k_{HDR} + k_{NHEJ}} \\right) $$\n该表达式在 $k_{cut} \\neq k_{HDR} + k_{NHEJ}$ 时有效。对于退化情况 $k_{cut} = k_{HDR} + k_{NHEJ}$，可以通过取极限或使用相应的 $C(t)$ 表达式直接积分来找到解，其结果为 $H(t) = k_{HDR} \\left( \\frac{1}{k_{cut}} (1 - \\exp(-k_{cut} t)) - t \\exp(-k_{cut} t) \\right)$。通常需要的是一般的非退化解。\n\n现在，对于问题的第二部分，我将概述统计推断程序。目标是从指定的实验数据中推断出三个速率常数 $\\theta = \\{ k_{cut}, k_{HDR}, k_{NHEJ} \\}$。数据包括在单个早期时间 $t_u$ 对 $U$ 的测量，以及在一系列 $m$ 个时间点 $\\{t_i\\}_{i=1}^m$ 对 $H$ 和 $N$ 的测量。观测值是群体分数，这些分数来自于对不同状态下细胞的计数。这意味着基础数据是计数，在每个时间点遵循多项式分布。\n\n基于原理的方法是最大似然估计 (MLE)。\n$1$. **似然函数构建**：设在时间 $t_u$ 分析的细胞总数为 $n_{tot,u}$，其中观察到处于状态 $U$ 的细胞数为 $n_U(t_u)$。在每个时间 $t_i$，设细胞总数为 $n_{tot,i}$，其中观察到处于状态 $H$ 和 $N$ 的细胞数分别为 $n_H(t_i)$ 和 $n_N(t_i)$。将其余计数归为“其他”类别，$n_{other,i} = n_{tot,i} - n_H(t_i) - n_N(t_i)$。每个类别的概率是模型的预测值 $U(t, \\theta)$、$H(t, \\theta)$ 和 $N(t, \\theta)$。在时间 $t_i$，“其他”类别的概率为 $P_{other}(t_i) = 1 - H(t_i) - N(t_i) = U(t_i) + C(t_i)$。整个数据集的对数似然函数是每个独立测量的对数似然函数之和：\n$$ \\mathcal{L}(\\theta) = \\left[ n_U(t_u) \\ln U(t_u, \\theta) + (n_{tot,u} - n_U(t_u)) \\ln(1 - U(t_u, \\theta)) \\right] + \\sum_{i=1}^{m} \\left[ n_H(t_i) \\ln H(t_i, \\theta) + n_N(t_i) \\ln N(t_i, \\theta) + n_{other,i} \\ln(1 - H(t_i, \\theta) - N(t_i, \\theta)) \\right] $$\n任务是找到使 $\\mathcal{L}(\\theta)$ 最大化的参数集 $\\hat{\\theta}$。\n\n$2$. **参数可识别性与分离**：特定的实验设计允许参数被解开和识别。\n   a. **推断 $k_{cut}$**：未切割分数的方程为 $U(t) = \\exp(-k_{cut} t)$。它仅依赖于 $k_{cut}$。在早期时间 $t_u > 0$ 对分数 $\\hat{U}(t_u) = n_U(t_u) / n_{tot,u}$ 的单次测量为 $k_{cut}$ 提供了一个直接但局部的约束。一个初步估计是 $\\hat{k}_{cut} \\approx -\\frac{1}{t_u} \\ln(\\hat{U}(t_u))$。完整的MLE拟合将使用所有数据来精炼这个值，因为 $H(t)$ 和 $N(t)$ 也依赖于 $k_{cut}$。\n   b. **推断分支比**：一个关键的见解来自于 $H$ 与 $N$ 的比率。从它们的控制常微分方程组可知，$\\frac{dH}{dt} / \\frac{dN}{dt} = k_{HDR}/k_{NHEJ}$。对此进行积分意味着累积产物的比率随时间保持不变：$\\frac{H(t)}{N(t)} = \\frac{k_{HDR}}{k_{NHEJ}}$。这是一个强有力的结果。这意味着在任何时间点 $t_i$ 的计数比率 $\\hat{H}(t_i)/\\hat{N}(t_i)$ 都是参数比率 $\\rho = k_{HDR}/k_{NHEJ}$ 的一个估计量。通过汇集所有计数可以获得一个稳健的估计：$\\hat{\\rho} = (\\sum_{i=1}^m n_H(t_i)) / (\\sum_{i=1}^m n_N(t_i))$。因此，这个参数组合是高度可识别的。\n   c. **推断修复时间尺度**：我们现在已经约束了 $k_{cut}$ 和比率 $\\rho = k_{HDR}/k_{NHEJ}$。唯一剩下的自由度是修复速率的总体尺度，可以由 $k_{repair} = k_{HDR} + k_{NHEJ}$ 参数化。$H(t)$ 和 $N(t)$ 的时间动态——特别是它们的增长速率和达到平台期的时间——同时依赖于 $k_{cut}$ 和 $k_{repair}$。在 $k_{cut}$ 和 $\\rho$ 被约束的情况下，通过拟合时间序列 $\\{t_i\\}_{i=1}^m$（$m \\geq 3$ 个点，提供足够的非局部信息）上的实验曲线 $\\hat{H}(t_i)$ 和 $\\hat{N}(t_i)$ 的形状，可以确定 $k_{repair}$ 的值。\n   d. **求解单个速率**：一旦MLE过程得出了可识别组合 $(\\hat{k}_{cut}, \\hat{\\rho}, \\hat{k}_{repair})$ 的估计值，就可以代数求解原始参数：\n      $$ \\hat{k}_{HDR} = \\hat{k}_{repair} \\frac{\\hat{\\rho}}{1 + \\hat{\\rho}} $$\n      $$ \\hat{k}_{NHEJ} = \\hat{k}_{repair} \\frac{1}{1 + \\hat{\\rho}} $$\n在实践中，人们对完整的对数似然函数 $\\mathcal{L}(k_{cut}, k_{HDR}, k_{NHEJ})$ 同时对三个参数进行单次数值优化，以获得MLEs。可识别性的先验分析解释了为什么这种拟合预期会收敛到一个唯一的、稳定的解。估计参数的置信区间可以从费雪信息矩阵的逆矩阵导出，该逆矩阵可以通过对数似然函数在其最大值处的黑塞矩阵的负数来近似。", "answer": "$$ \\boxed{ \\frac{k_{HDR} k_{cut}}{k_{HDR} + k_{NHEJ} - k_{cut}} \\left( \\frac{1 - \\exp(-k_{cut} t)}{k_{cut}} - \\frac{1 - \\exp(-(k_{HDR} + k_{NHEJ}) t)}{k_{HDR} + k_{NHEJ}} \\right) } $$", "id": "2721191"}]}