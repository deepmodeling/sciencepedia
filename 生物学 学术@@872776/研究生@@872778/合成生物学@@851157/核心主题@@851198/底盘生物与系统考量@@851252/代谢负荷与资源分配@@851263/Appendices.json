{"hands_on_practices": [{"introduction": "理解代谢负担始于量化其最直接的组成部分：合成异源蛋白的能量成本。本练习将引导你进行一次生物能量学的“成本核算”，实践如何将中心法则中的分子事件与细胞整体的ATP能量预算联系起来[@problem_id:2750632]。通过计算一个假设蛋白在给定能量供应下的最大合成速率，你将具体地体会到异源表达是如何消耗细胞核心资源的。", "problem": "一个处于稳态的细菌细胞以 $6\\times 10^{9}\\ \\text{ATP s}^{-1}$ 的速率产生三磷酸腺苷 (ATP)。该细胞必须保留 $1\\times 10^{9}\\ \\text{ATP s}^{-1}$ 以维持基线维持过程，如离子稳态、蛋白质质量控制和周转，且这部分用于维持的分配不能减少。剩余的 ATP 可用于异源蛋白质的合成。考虑一个长度为 $300$ 个氨基酸 (aa) 的异源蛋白质。假设以下基于分子生物学中心法则和翻译过程的生物化学测量得出的广泛使用的能量衡算：\n\n- 通过氨酰-tRNA合成酶为一个转移核糖核酸 (tRNA) 装载一个氨基酸，会消耗一个ATP分子生成一磷酸腺苷 (AMP) 和焦磷酸盐，在计算高能磷酸键时，这相当于每个掺入的氨基酸消耗 $2$ 个ATP当量。\n- 每个掺入的氨基酸的延伸过程消耗 $2$ 个三磷酸鸟苷 (GTP) 分子（一个用于递送，一个用于易位）；将每次 GTP 水解计为 $1$ 个ATP当量，因此每个掺入的氨基酸总共消耗 $2$ 个ATP当量。\n- 起始和终止过程共同消耗每个完整多肽链 $2$ 个GTP的固定开销；将其计为每个蛋白质 $2$ 个ATP当量。\n- 忽略转录、信使核糖核酸 (mRNA) 周转、蛋白质折叠和翻译后加工的 ATP 成本，并假设核糖体和前体供应不是限制因素。\n\n在这些假设下，并且不从维持需求中挪用任何 ATP，该 $300$ aa 蛋白质的最大可持续生产速率是多少（以分子/秒为单位）？将您的答案四舍五入至三位有效数字，并以分子 s$^{-1}$ 为单位报告。", "solution": "问题陈述经过验证。\n\n**步骤 1：提取已知条件**\n- 总 ATP 生产速率, $R_{ATP, total} = 6 \\times 10^{9}\\ \\text{ATP s}^{-1}$。\n- 维持 ATP 消耗速率, $R_{ATP, maint} = 1 \\times 10^{9}\\ \\text{ATP s}^{-1}$。\n- 异源蛋白质长度, $L_p = 300$ 氨基酸 (aa)。\n- tRNA 装载成本, $C_{charge} = 2$ ATP当量/氨基酸。\n- 延伸成本, $C_{elong} = 2$ GTP/氨基酸。\n- 能量当量, $1$ GTP $= 1$ ATP当量。\n- 起始和终止的固定成本, $C_{fixed, \\text{GTP}} = 2$ GTP/多肽。\n- 假设：忽略转录、mRNA 周转、蛋白质折叠和翻译后加工的成本。核糖体和前体非限制性。\n- 目标：计算蛋白质的最大可持续生产速率，单位为分子/秒，并四舍五入至三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它基于分子生物学中已确立的生物能量学和代谢衡算原则。所提供的 ATP 生产速率和蛋白质合成成本的数值与*大肠杆菌* (*Escherichia coli*) 等模式生物报告的数据一致。该问题陈述清晰，提供了计算唯一、有意义解所需的所有必要信息。其陈述客观，没有歧义或矛盾。所做的假设，例如忽略转录成本和假设资源非限制性，是此类模型中常用且明确说明的简化，旨在分离翻译负荷的影响。该问题既不琐碎也不故作高深；它需要基于基本原则进行直接但不明显的计算。\n\n**步骤 3：结论与行动**\n问题被认定为有效。将制定解决方案。\n\n解决方案的步骤是：首先确定可用于异源蛋白质合成的净 ATP 通量，然后计算合成单个多肽的总能量成本，最后将可用通量除以单位成本，以求得最大生产速率。\n\n首先，我们计算可用于蛋白质生产的 ATP 供应速率 $R_{ATP, avail}$。这是总 ATP 生产速率 $R_{ATP, total}$ 减去维持过程所需的不可减少的速率 $R_{ATP, maint}$。\n$$R_{ATP, avail} = R_{ATP, total} - R_{ATP, maint}$$\n代入给定值：\n$$R_{ATP, avail} = (6 \\times 10^{9} - 1 \\times 10^{9})\\ \\text{ATP s}^{-1} = 5 \\times 10^{9}\\ \\text{ATP s}^{-1}$$\n这是每秒可用于合成异源蛋白质的总能量货币。\n\n接下来，我们计算合成一个蛋白质分子所需的总 ATP 当量成本，记为 $C_{protein}$。该成本是随蛋白质长度变化的变动成本与起始和终止的固定成本之和。\n\n变动成本与每个氨基酸的掺入有关。对于 $L_p = 300$ 个氨基酸中的每一个，都有两个组成部分：\n1.  装载一个 tRNA 分子的成本, $C_{charge} = 2$ ATP当量/氨基酸。\n2.  延伸成本（tRNA 递送和易位），每个氨基酸消耗 $2$ 个 GTP 分子。鉴于 $1$ GTP 等价于 $1$ ATP，该成本为 $C_{elong} = 2 \\times 1 = 2$ ATP当量/氨基酸。\n\n因此，每个氨基酸的总成本 $C_{aa}$ 为：\n$$C_{aa} = C_{charge} + C_{elong} = 2 + 2 = 4\\ \\text{ATP-equivalents per amino acid}$$\n长度为 $L_p$ 的蛋白质的总变动成本为：\n$$C_{variable} = C_{aa} \\times L_p = 4 \\times 300 = 1200\\ \\text{ATP-equivalents}$$\n起始和终止的固定成本 $C_{fixed}$ 为每个蛋白质 $2$ 个 GTP。这等价于：\n$$C_{fixed} = 2\\ \\text{GTP} \\times \\frac{1\\ \\text{ATP-equivalent}}{1\\ \\text{GTP}} = 2\\ \\text{ATP-equivalents}$$\n合成一个蛋白质分子的总成本是变动成本和固定成本之和：\n$$C_{protein} = C_{variable} + C_{fixed} = 1200 + 2 = 1202\\ \\text{ATP-equivalents per molecule}$$\n最后，蛋白质的最大可持续生产速率 $P_{max}$ 是可用 ATP 供应速率除以每个蛋白质分子的成本：\n$$P_{max} = \\frac{R_{ATP, avail}}{C_{protein}}$$\n代入计算值：\n$$P_{max} = \\frac{5 \\times 10^{9}\\ \\text{ATP s}^{-1}}{1202\\ \\text{ATP molecule}^{-1}} \\approx 4159733.777\\ \\text{molecules s}^{-1}$$\n问题要求答案四舍五入到三位有效数字。\n$$P_{max} \\approx 4.16 \\times 10^{6}\\ \\text{molecules s}^{-1}$$\n这表示在给定的能量约束下，每秒可以合成的蛋白质分子的最大数量。", "answer": "$$\\boxed{4.16 \\times 10^{6}}$$", "id": "2750632"}, {"introduction": "在理解了单个蛋白的合成成本后，我们将更进一步，探讨如何在一条由多个酶组成的代谢通路中优化资源分配。本练习模拟了一个简单的双酶通路，要求你确定最佳的酶质量分配比例，以最小的总蛋白投资实现固定的代谢通量[@problem_id:2750701]。这个练习揭示了平衡通路中各个环节能力的核心思想，这是代谢工程和合成生物学设计中的一个基本原则。", "problem": "在一种细菌中，一条工程化的$2$步线性生物合成途径通过两种串联酶$E_{1}$和$E_{2}$将一种丰富的前体转化为产物。在稳态下，由于上游生理需求，该途径的通量被限制在一个固定值$v$。两种酶都在底物饱和条件下运行，因此每一步的速率都等于其催化能力。假设有以下物理和生物学基础：\n- 在米氏（MM）动力学的饱和条件下，通过步骤$i$的速率为$v_{i} = k_{\\text{cat},i} E_{i}$，其中$k_{\\text{cat},i}$是转换数，$E_{i}$是催化活性酶$i$的摩尔浓度。\n- 通过串联步骤的稳态通量相等，因此$v = v_{1} = v_{2}$。\n- 投入该途径的总蛋白质量与$E_{1} + E_{2}$成正比，因为两种酶每个活性位点的分子质量相等，并且在细胞质中每摩尔蛋白质的成本相同。\n- 除了与质量成比例的成本外，没有诸如拥挤效应或分子伴侣限制等额外限制。\n\n给定$k_{\\text{cat},1} = 100\\ \\text{s}^{-1}$和$k_{\\text{cat},2} = 10\\ \\text{s}^{-1}$。对于一个固定的通量$v$，确定分配给酶$E_{1}$的质量分数，以最小化维持该通量所需的总酶质量。将最终答案表示为一个代表分配给$E_{1}$的总酶质量分数的单个数字（无单位）。您可以提供一个精确分数。如果选择小数表示，请将答案四舍五入到五位有效数字。", "solution": "该问题要求确定细胞资源的优化分配，具体来说，是在一个两步途径中酶$E_{1}$的质量分数，以最小化维持固定代谢通量$v$所需的总酶质量。\n\n设两种酶的摩尔浓度为$E_{1}$和$E_{2}$。问题陈述，两种酶每个活性位点的分子质量相同。因此，最小化总蛋白质量等同于最小化总酶摩尔浓度，我们将其表示为$E_{total}$。\n$$E_{total} = E_{1} + E_{2}$$\n分配给酶$E_{1}$的质量分数与其摩尔分数$f_{1}$等价。\n$$f_{1} = \\frac{E_{1}}{E_{1} + E_{2}} = \\frac{E_{1}}{E_{total}}$$\n根据这个定义，我们可以用总浓度$E_{total}$和分数$f_{1}$来表示各个酶的浓度：\n$$E_{1} = f_{1} E_{total}$$\n$$E_{2} = (1 - f_{1}) E_{total}$$\n每一步酶促反应的速率$v_{i}$由米氏方程在底物饱和条件下给出，简化为$v_{i} = k_{\\text{cat},i} E_{i}$。代入$E_{1}$和$E_{2}$的表达式，得到每一步的催化能力，作为$f_{1}$和$E_{total}$的函数：\n$$v_{1} = k_{\\text{cat},1} E_{1} = k_{\\text{cat},1} f_{1} E_{total}$$\n$$v_{2} = k_{\\text{cat},2} E_{2} = k_{\\text{cat},2} (1 - f_{1}) E_{total}$$\n线性途径的总通量$v$受其最慢步骤（瓶颈）的速率限制。因此，稳态通量$v$是各个步骤能力的最小值。\n$$v = \\min(v_{1}, v_{2}) = \\min(k_{\\text{cat},1} f_{1} E_{total}, k_{\\text{cat},2} (1-f_{1}) E_{total})$$\n目标是找到使达到固定通量$v$所需的总酶浓度$E_{total}$最小化的分数$f_{1}$。我们可以重排通量方程，将$E_{total}$表示为$f_{1}$和常数通量$v$的函数：\n$$E_{total}(f_{1}) = \\frac{v}{\\min(k_{\\text{cat},1} f_{1}, k_{\\text{cat},2} (1-f_{1}))}$$\n为了最小化$E_{total}(f_{1})$，我们必须最大化其分母，我们将其定义为函数$g(f_{1})$：\n$$g(f_{1}) = \\min(k_{\\text{cat},1} f_{1}, k_{\\text{cat},2} (1-f_{1}))$$\n函数$g(f_{1})$表示在区间$f_1 \\in [0, 1]$上两个关于$f_1$的线性函数的最小值。项$k_{\\text{cat},1} f_{1}$是$f_{1}$的单调递增函数，在$f_{1}=0$时从$0$开始。项$k_{\\text{cat},2} (1-f_{1})$是$f_{1}$的单调递减函数，在$f_{1}=0$时从$k_{\\text{cat},2}$开始。这两个函数最小值的最大值出现在它们相等的那一点。在这一点上，途径是完全平衡的，没有任何一个步骤成为瓶颈。\n我们通过将$\\min$函数的两个参数设为相等来找到最优分数$f_{1}$：\n$$k_{\\text{cat},1} f_{1} = k_{\\text{cat},2} (1-f_{1})$$\n解出$f_{1}$：\n$$k_{\\text{cat},1} f_{1} = k_{\\text{cat},2} - k_{\\text{cat},2} f_{1}$$\n$$k_{\\text{cat},1} f_{1} + k_{\\text{cat},2} f_{1} = k_{\\text{cat},2}$$\n$$f_{1} (k_{\\text{cat},1} + k_{\\text{cat},2}) = k_{\\text{cat},2}$$\n$$f_{1} = \\frac{k_{\\text{cat},2}}{k_{\\text{cat},1} + k_{\\text{cat},2}}$$\n这个表达式给出了在给定总酶量的情况下，为最大化途径通量而必须分配给$E_{1}$的总酶分数，这等同于在给定通量下最小化所需的总酶量。\n现在，我们代入给定的转换数值：$k_{\\text{cat},1} = 100\\ \\text{s}^{-1}$和$k_{\\text{cat},2} = 10\\ \\text{s}^{-1}$。\n$$f_{1} = \\frac{10}{100 + 10} = \\frac{10}{110} = \\frac{1}{11}$$\n分配给酶$E_{1}$的最优分数是$\\frac{1}{11}$。", "answer": "$$\\boxed{\\frac{1}{11}}$$", "id": "2750701"}, {"introduction": "前两个练习分别从能量和局部蛋白质分配的角度探讨了代谢负担。然而，细胞是一个庞大而复杂的反应网络。本练习将引导你进入计算系统生物学的领域，学习如何将资源分配的概念整合到全细胞代谢模型中，即构建蛋白质组约束的流平衡分析（p-FBA）[@problem_id:2750686]。你将亲手推导并实现这一约束，通过解决一系列线性规划问题，量化蛋白质组预算如何影响细胞的最大生长速率，体验从基本原理构建预测性计算模型的全过程。", "problem": "要求您实现一个计算模型，该模型通过引入蛋白质组预算约束来扩展经典的流平衡分析（FBA），以捕捉代谢负荷和资源分配。目标是从有效的基础原则出发，推导出一个线性优化问题，其解可以预测最大生长速率。然后，通过计算一小组明确定义的网络中，有蛋白质组约束的最优解与经典FBA最优解的比率，来量化蛋白质组约束如何改变预测的最大生长速率。\n\n使用的基本原理：\n- 细胞内代谢物的稳态质量守恒意味着存在一个形式为 $$S v = 0$$ 的线性约束，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量，两者都定义在一个固定的网络上。\n- 酶催化能力产生不等式 $$v_i \\leq E_i k_{\\text{cat},i},$$ 其中 $v_i$ 是通量，$E_i$ 是催化反应 $i$ 的酶的浓度（或分配量），$k_{\\text{cat},i}$ 是反应 $i$ 的催化转换数，单位为 $\\text{h}^{-1}$。\n- 蛋白质组预算捕捉了总酶分配上的资源约束，即 $$\\sum_i E_i \\leq \\phi_P^{\\max},$$ 其中 $\\phi_P^{\\max}$ 是可用于建模的催化酶的无量纲蛋白质组分数。\n\n基于这些前提，推导出一个完全用通量和催化转换数表示的线性约束，该约束可以整合到FBA中。将生长速率最大化问题表述为有和没有此推导约束的两种线性规划。假设生长速率等于通过生物质生成反应的通量。对每个测试网络求解这两个优化问题，并计算无量纲比率 $r = \\mu_{\\text{prot}} / \\mu_{\\text{classical}}$，其中 $\\mu_{\\text{prot}}$ 是有蛋白质组约束时的最优生长速率，$\\mu_{\\text{classical}}$ 是没有该约束时的最优生长速率。\n\n实现要求：\n- 对于每个网络，您必须在满足 $S v = 0$ 和边界约束 $l \\leq v \\leq u$ 的条件下，最大化线性目标 $c^\\top v$。该目标编码了生物质通量；如果存在多个生物质生成反应，$c$ 可以有多个正值项。\n- 对于有蛋白质组约束的情况，添加您从酶催化能力和蛋白质组预算原则中推导出的单个线性不等式。\n- 不涉及角度。生长速率的单位是 $\\text{h}^{-1}$；然而，您需要输出的比率是无量纲的，并且必须表示为小数。\n\n测试套件：\n对于每种情况，网络由化学计量矩阵 $S$、目标系数向量 $c$、每个通量的下界和上界 $l$ 和 $u$、催化转换数 $k_{\\text{cat}}$（单位 $\\text{h}^{-1}$）以及蛋白质组预算 $\\phi_P^{\\max}$（无量纲）完全指定。在所有情况下，边界都是分量形式的，无界的上界应视为 $+\\infty$。\n\n- 案例A（单路径生长；蛋白质组非限制性）：\n  - $$S = \\begin{bmatrix} 1 & -1 \\end{bmatrix}.$$\n  - $$c = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.$$\n  - $$l = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ +\\infty \\end{bmatrix}.$$\n  - $$k_{\\text{cat}} = \\begin{bmatrix} 1000 \\\\ 1000 \\end{bmatrix} \\ \\text{h}^{-1}.$$\n  - $$\\phi_P^{\\max} = 0.05.$$\n\n- 案例B（单路径生长；蛋白质组限制性）：\n  - $$S = \\begin{bmatrix} 1 & -1 \\end{bmatrix}.$$\n  - $$c = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.$$\n  - $$l = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ +\\infty \\end{bmatrix}.$$\n  - $$k_{\\text{cat}} = \\begin{bmatrix} 1000 \\\\ 1000 \\end{bmatrix} \\ \\text{h}^{-1}.$$\n  - $$\\phi_P^{\\max} = 0.001.$$\n\n- 案例C（两条备选生物质途径；产量与酶效率之间的权衡）：\n  - $$S = \\begin{bmatrix} 1 & -1 & -2 \\end{bmatrix}.$$\n  - $$c = \\begin{bmatrix} 0 \\\\ 1 \\\\ 3 \\end{bmatrix}.$$\n  - $$l = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ +\\infty \\\\ +\\infty \\end{bmatrix}.$$\n  - $$k_{\\text{cat}} = \\begin{bmatrix} 500 \\\\ 2000 \\\\ 100 \\end{bmatrix} \\ \\text{h}^{-1}.$$\n  - $$\\phi_P^{\\max} = 0.02.$$\n\n- 案例D（单路径生长；零蛋白质组预算）：\n  - $$S = \\begin{bmatrix} 1 & -1 \\end{bmatrix}.$$\n  - $$c = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.$$\n  - $$l = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}, \\quad u = \\begin{bmatrix} 10 \\\\ +\\infty \\end{bmatrix}.$$\n  - $$k_{\\text{cat}} = \\begin{bmatrix} 1000 \\\\ 1000 \\end{bmatrix} \\ \\text{h}^{-1}.$$\n  - $$\\phi_P^{\\max} = 0.$$\n\n您的程序必须：\n- 对每种情况，求解两个线性规划问题以获得 $\\mu_{\\text{classical}}$ 和 $\\mu_{\\text{prot}}$。\n- 计算比率 $r = \\mu_{\\text{prot}} / \\mu_{\\text{classical}}$，结果为保留恰好 $6$ 位小数的小数。\n- 生成单行输出，其中包含按 A、B、C、D 案例顺序排列的结果，形式为用逗号分隔并包含在方括号内的列表，例如 $$[r_A, r_B, r_C, r_D].$$\n\n所有输入均已在上方提供；无需用户输入。所有输出都必须是无量纲的小数，并精确到 $6$ 位小数。通过遵循所提供的数据和假设来确保科学真实性。", "solution": "所提出的问题是计算系统生物学中的一个有效练习，具体涉及将资源分配约束整合到流平衡分析中。该问题具有科学依据，提法明确，且解决问题所需的所有参数均已提供。我们将首先推导所需的约束条件，然后构建优化问题。\n\n提供的基本原则是：\n$1$. 每个反应 $i$ 的酶催化能力约束：\n$$v_i \\leq E_i k_{\\text{cat},i}$$\n其中 $v_i$ 是通量，$E_i$ 是酶浓度，$k_{\\text{cat},i}$ 是转换数。问题为所有通量指定了非负下界，因此我们考虑 $v_i \\geq 0$。\n\n$2$. 建模的酶的总蛋白质组预算：\n$$\\sum_i E_i \\leq \\phi_P^{\\max}$$\n其中 $\\phi_P^{\\max}$ 是可用的最大蛋白质组分数。\n\n我们的目标是通过消除酶浓度 $E_i$ 来推导关于通量 $v_i$ 的单个线性约束。从酶催化能力约束出发，我们可以表述维持一个通量 $v_i$ 所需的最小酶浓度。假设 $k_{\\text{cat},i} > 0$，我们重排不等式以求解 $E_i$：\n$$E_i \\geq \\frac{v_i}{k_{\\text{cat},i}}$$\n这个不等式给出了为实现通量 $v_i$ 而必须分配给酶 $i$ 的最小蛋白质组资源。为了满足整个网络的蛋白质组预算，所有酶的这些最小分配量之和不能超过可用的总预算 $\\phi_P^{\\max}$。对所有反应 $i$ 的最小需求求和：\n$$\\sum_i E_i \\geq \\sum_i \\frac{v_i}{k_{\\text{cat},i}}$$\n将此与蛋白质组预算约束相结合，我们得到所需的关系：\n$$\\sum_i \\frac{v_i}{k_{\\text{cat},i}} \\leq \\sum_i E_i \\leq \\phi_P^{\\max}$$\n这就得出了最终的线性不等式，它基于总蛋白质组预算来约束反应通量：\n$$\\sum_i \\frac{v_i}{k_{\\text{cat},i}} \\leq \\phi_P^{\\max}$$\n这个约束可以用向量形式表示为 $a^\\top v \\leq \\phi_P^{\\max}$，其中向量 $a$ 的分量是转换数的倒数，即 $a_i = 1/k_{\\text{cat},i}$。\n\n现在我们可以构建所需的两个线性规划（LP）问题。\n\n$1$. **经典流平衡分析（FBA）：**\n目标是最大化生长速率 $\\mu_{\\text{classical}}$，它由通量的线性组合 $c^\\top v$ 表示。\n- **最大化：** $\\mu_{\\text{classical}} = c^\\top v$\n- **约束条件：**\n  - $S v = 0$ (稳态质量平衡)\n  - $l \\leq v \\leq u$ (通量边界)\n\n$2$. **蛋白质组约束的FBA（p-FBA）：**\n此公式与经典 FBA 相同，只是增加了推导出的蛋白质组约束。\n- **最大化：** $\\mu_{\\text{prot}} = c^\\top v$\n- **约束条件：**\n  - $S v = 0$\n  - $l \\leq v \\leq u$\n  - $\\sum_i \\frac{v_i}{k_{\\text{cat},i}} \\leq \\phi_P^{\\max}$ (蛋白质组预算)\n\n这些是标准的LP问题。为了使用一个执行最小化的典型求解器（如 `scipy.optimize.linprog`）进行计算求解，我们将最大化 $c^\\top v$ 的问题重构为最小化 $-c^\\top v$ 的问题。求解器得到的最优目标值，我们称之为 $\\mu^*$，与最大生长速率的关系为 $\\mu = -\\mu^*$。\n\n对于每个测试案例，我们求解这两个LP问题以找到 $\\mu_{\\text{classical}}$ 和 $\\mu_{\\text{prot}}$。最终要求的量是无量纲比率 $r = \\mu_{\\text{prot}} / \\mu_{\\text{classical}}$，它量化了蛋白质组约束对预测的最大生长速率的影响。实现过程将为每种情况构建适当的矩阵和向量，并使用数值LP求解器。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves for the ratio of proteome-constrained to classical FBA optimal growth rates\n    for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # Case A: single-path growth; proteome non-limiting\n        {\n            \"S\": np.array([[1, -1]]),\n            \"c\": np.array([0, 1]),\n            \"l\": np.array([0, 0]),\n            \"u\": np.array([10, np.inf]),\n            \"k_cat\": np.array([1000, 1000]),\n            \"phi_P_max\": 0.05\n        },\n        # Case B: single-path growth; proteome limiting\n        {\n            \"S\": np.array([[1, -1]]),\n            \"c\": np.array([0, 1]),\n            \"l\": np.array([0, 0]),\n            \"u\": np.array([10, np.inf]),\n            \"k_cat\": np.array([1000, 1000]),\n            \"phi_P_max\": 0.001\n        },\n        # Case C: two alternative biomass routes; trade-off\n        {\n            \"S\": np.array([[1, -1, -2]]),\n            \"c\": np.array([0, 1, 3]),\n            \"l\": np.array([0, 0, 0]),\n            \"u\": np.array([10, np.inf, np.inf]),\n            \"k_cat\": np.array([500, 2000, 100]),\n            \"phi_P_max\": 0.02\n        },\n        # Case D: single-path growth; zero proteome budget\n        {\n            \"S\": np.array([[1, -1]]),\n            \"c\": np.array([0, 1]),\n            \"l\": np.array([0, 0]),\n            \"u\": np.array([10, np.inf]),\n            \"k_cat\": np.array([1000, 1000]),\n            \"phi_P_max\": 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        S = case[\"S\"]\n        c = case[\"c\"]\n        l = case[\"l\"]\n        u = case[\"u\"]\n        k_cat = case[\"k_cat\"]\n        phi_P_max = case[\"phi_P_max\"]\n        \n        # Common parameters for linprog\n        # We maximize c'v by minimizing -c'v\n        c_obj = -c\n        A_eq = S\n        b_eq = np.zeros(S.shape[0])\n        \n        # Create bounds list, replacing np.inf with None for scipy\n        bounds = []\n        for i in range(len(l)):\n            upper_bound = u[i] if u[i] != np.inf else None\n            bounds.append((l[i], upper_bound))\n\n        # 1. Solve classical FBA\n        res_classical = linprog(c=c_obj, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        \n        # The result from minimizing -c'v is -mu\n        mu_classical = -res_classical.fun if res_classical.success else 0.0\n\n        # 2. Solve proteome-constrained FBA\n        # Add the proteome constraint: sum(v_i / k_cat_i) = phi_P_max\n        A_ub_prot = (1 / k_cat).reshape(1, -1)\n        b_ub_prot = [phi_P_max]\n        \n        res_prot = linprog(c=c_obj, A_eq=A_eq, b_eq=b_eq, A_ub=A_ub_prot, b_ub=b_ub_prot, bounds=bounds, method='highs')\n\n        mu_prot = -res_prot.fun if res_prot.success else 0.0\n        \n        # 3. Compute the ratio\n        if mu_classical  1e-9:  # Avoid division by zero\n            ratio = mu_prot / mu_classical\n        else:\n            # If classical growth is zero, the ratio is ill-defined unless proteome-\n            # constrained growth is also zero, in which case one might consider the ratio to be 1.\n            # However, for the given problem, mu_classical is always positive.\n            # Case D gives mu_prot = 0, mu_classical = 10, so ratio is 0.\n            ratio = 0.0\n\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2750686"}]}