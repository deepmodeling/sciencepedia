{"hands_on_practices": [{"introduction": "设计-构建-测试-学习（DBTL）循环的精髓在于迭代和改进。本练习将您置于“学习”阶段，此时来自“设计”阶段的简单预测模型与“测试”阶段的真实实验数据发生了冲突 [@problem_id:2074912]。通过分析预测的线性响应与观察到的饱和行为之间的差异，您将练习识别初始模型所忽略的潜在生物学机制。", "problem": "一组本科生正在遵循设计-构建-测试-学习 (DBTL) 循环开展一个合成生物学项目。他们的目标是在大肠杆菌 (*E. coli*) 中创建一个全细胞生物传感器，以检测一种特定的小分子，即分析物。\n\n**设计阶段：** 学生们设计了一个简单的基因线路。在这个线路中，一个组成型表达的阻遏蛋白与一个启动子结合，从而阻断绿色荧光蛋白 (GFP) 基因的转录。分析物分子可以与该阻遏蛋白结合，导致阻遏蛋白从启动子上脱离。这种解除阻遏的过程使得细胞能够产生GFP，从而产生荧光信号。学生们在“设计”阶段的初始数学模型假设了一个简单的线性关系：他们预测，细胞培养物的稳态荧光输出与添加到生长培养基中的分析物浓度成正比。\n\n**测试阶段：** 学生们在大肠杆菌 (*E. coli*) 中“构建”了该线路，并通过测量不同分析物浓度下的稳态荧光来对其进行“测试”。他们观察到，在低分析物浓度下，荧光确实如预测那样大致呈线性增加。然而，随着他们添加越来越多的分析物，荧光强度的增加变得缓慢，并最终达到一个平台期，此时进一步添加分析物不会引起荧光水平的显著变化。这种观察到的饱和行为与他们最初的线性模型相矛盾。\n\n**学习阶段：** 学生们现在必须从这种差异中“学习”，以完善他们的模型。在他们的初始线性模型未能解释的观察到的饱和现象中，以下哪个生物学因素是最直接和主要的原因？\n\nA. 每个细胞内阻遏蛋白分子的总数是有限的。\n\nB. 细胞酶对分析物分子的降解速率。\n\nC. 细胞合成绿色荧光蛋白的代谢成本。\n\nD. 绿色荧光蛋白成熟为其荧光形式的速率。\n\nE. 用于翻译阻遏蛋白信使RNA (mRNA) 的核糖体数量有限。", "solution": "设 $[A]$ 表示分析物浓度，$R_{\\mathrm{tot}}$ 表示细胞内阻遏蛋白的总浓度（或每个细胞内的数量换算成的浓度），$[R]$ 表示游离阻遏蛋白，$[AR]$ 表示分析物-阻遏蛋白复合物。根据质量作用定律，分析物与阻遏蛋白的结合过程如下：\n$$\nA + R \\rightleftharpoons AR, \\quad K_{A} = \\frac{[A][R]}{[AR]}.\n$$\n阻遏蛋白的质量守恒给出：\n$$\nR_{\\mathrm{tot}} = [R] + [AR] + [RP],\n$$\n其中 $[RP]$ 是与启动子结合的阻遏蛋白。通常，启动子位点的数量与 $R_{\\mathrm{tot}}$ 相比很小，因此对于 $[A]$ 的依赖关系，我们可以将主要的守恒关系写为：\n$$\nR_{\\mathrm{tot}} \\approx [R] + [AR].\n$$\n使用 $[AR] = \\frac{[A][R]}{K_{A}}$，我们得到：\n$$\nR_{\\mathrm{tot}} = [R] \\left( 1 + \\frac{[A]}{K_{A}} \\right)\n\\quad \\Longrightarrow \\quad\n[R] = \\frac{R_{\\mathrm{tot}}}{1 + \\frac{[A]}{K_{A}}}.\n$$\n\n阻遏蛋白与启动子的结合可由下式描述：\n$$\nR + P \\rightleftharpoons RP, \\quad K_{R} = \\frac{[R][P]}{[RP]},\n$$\n其中 $P_{\\mathrm{tot}} = [P] + [RP]$。未结合阻遏蛋白的启动子所占的比例为：\n$$\nf_{\\mathrm{free}} = \\frac{[P]}{P_{\\mathrm{tot}}} = \\frac{K_{R}}{K_{R} + [R]}.\n$$\n假设从游离启动子进行的转录导致GFP的产生，其最大稳态荧光强度为 $F_{\\max}$（由细胞的表达能力和稳态下的成熟速率决定），则荧光强度作为分析物浓度的函数是：\n$$\nF([A]) = F_{\\max} \\, f_{\\mathrm{free}} = F_{\\max} \\, \\frac{K_{R}}{K_{R} + [R]}.\n$$\n将 $[R] = \\frac{R_{\\mathrm{tot}}}{1 + \\frac{[A]}{K_{A}}}$ 代入可得：\n$$\nF([A]) = F_{\\max} \\, \\frac{K_{R}}{K_{R} + \\dfrac{R_{\\mathrm{tot}}}{1 + \\dfrac{[A]}{K_{A}}}}\n= F_{\\max} \\, \\frac{K_{R} \\left( 1 + \\dfrac{[A]}{K_{A}} \\right)}{K_{R} \\left( 1 + \\dfrac{[A]}{K_{A}} \\right) + R_{\\mathrm{tot}}}.\n$$\n\n两种极限情况直接由此得出：\n\n1) 低分析物浓度，$[A] \\ll K_{A}$：\n$$\nF([A]) \\approx F_{\\max} \\, \\frac{K_{R}}{K_{R} + R_{\\mathrm{tot}}}\n+ F_{\\max} \\, \\frac{K_{R} \\, R_{\\mathrm{tot}}}{\\left( K_{R} + R_{\\mathrm{tot}} \\right)^{2}} \\, \\frac{[A]}{K_{A}},\n$$\n该式与 $[A]$ 近似成线性关系，这与在低分析物浓度下的初始观察结果一致。\n\n2) 高分析物浓度，$[A] \\to \\infty$：\n$$\n[R] \\to 0\n\\quad \\Longrightarrow \\quad\nF([A]) \\to F_{\\max}.\n$$\n因此，$F([A])$ 在平台期 $F_{\\max}$ 达到饱和，因为阻遏蛋白池是有限的：一旦基本上所有的阻遏蛋白分子都被分析物结合，启动子就会被完全解除阻遏，此时进一步增加 $[A]$ 无法使表达水平超过最大值。\n\n因此，观察到的饱和现象最直接和主要的原因是阻遏蛋白分子数量的有限性（等效地，可被分析物滴定的结合位点数量有限）。选项B、C、D和E可以调节曲线的位置或绝对最大水平，或影响动力学，但它们不构成对分析物产生饱和剂量-反应关系的主要机理原因；这种饱和现象根本上源于上述模型所捕捉到的有限的阻遏蛋白池和启动子占有率的限制。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "2074912"}, {"introduction": "合成生物学的一个关键挑战是基因元件的背景依赖性；一个在某种细胞“底盘”中功能正常的回路可能在另一种细胞中失效。本问题提出了一个真实的故障排除场景，其中一个基因开关在两种常见的*大肠杆菌*菌株中表现出不同的行为 [@problem_id:1428108]。您的任务是提出一个合理的假设，这将促使您超越电路图本身，思考合成构建体与宿主细胞之间的相互作用如何导致意外的系统故障。", "problem": "一个合成生物学团队正在遵循设计-构建-测试-学习 (DBTL) 循环来创建一个简单的基因开关。他们的“设计”是一个旨在用作诱导型表达系统的质粒。该质粒包含两个关键组成部分：\n1. 一个表达 LacI 阻遏蛋白的基因，由一个弱的组成型启动子驱动。\n2. 一个绿色荧光蛋白 (GFP) 的基因，由一个强的、可被 LacI 阻遏的启动子（$P_{\\text{lac}}$）驱动。\n\n团队“构建”了该质粒，并在两种不同的大肠杆菌菌株中对其进行“测试”。\n- **测试 1：** 在克隆菌株 *E. coli* DH5α 中，该回路工作完美。在没有诱导剂的情况下，细胞显示出非常低的荧光；当加入诱导剂时，荧光强度很高。\n- **测试 2：** 将完全相同的质粒转移到蛋白质表达菌株 *E. coli* BL21(DE3) 中。在这个菌株中，该回路失效。即使在完全没有诱导剂的情况下，细胞也表现出很高的 GFP 荧光。\n\n现在进入“学习”阶段，团队必须提出一个假设来解释这种依赖于宿主背景的失败。根据克隆菌株与蛋白质表达菌株已知的普遍特性，以下哪个假说最能合理解释在 BL21(DE3) 中观察到的高基础（泄露）表达？\n\nA. 在 BL21(DE3) 的细胞质中，GFP 蛋白折叠成其有活性的荧光构象的效率远高于在 DH5α 中，导致相同数量的蛋白质产生更高的荧光信号。\n\nB. 与 DH5α 宿主相比，该质粒的复制起始点在 BL21(DE3) 宿主环境中导致每个细胞的质粒拷贝数显著更高。\n\nC. BL21(DE3) 菌株具有更高浓度的内源性蛋白酶，这些蛋白酶特异性地降解 LacI 阻遏蛋白，从而降低其与 $P_{\\text{lac}}$ 启动子结合的能力。\n\nD. BL21(DE3) 中的核糖体翻译 `gfp` mRNA 序列的速度显著快于 DH5α 中的核糖体，导致 GFP 快速积累。", "solution": "我们首先确定该回路的调控逻辑。LacI 阻遏蛋白由一个弱的组成型启动子产生，而 GFP 报告基因由一个被 LacI 阻遏的强 $P_{\\text{lac}}$ 启动子驱动。在没有诱导剂的情况下，如果活性 LacI 四聚体的细胞内浓度相对于 $P_{\\text{lac}}$ 操纵子位点的数量和启动子的内在强度足够高，阻遏就会成功。当转移到不同宿主中时，任何降低有效 LacI 阻遏作用或增加 $P_{\\text{lac}}$ 有效转录驱动力的因素都可能表现为高基础荧光。\n\n现在我们根据克隆菌株（如 DH5α）和蛋白质表达菌株（如 BL21(DE3)）的已知普遍特性，以及 LacI 阻遏作用的机理要求，来评估每个假说。\n\n- 假说 A（BL21(DE3) 中的折叠效率提高）：增强的折叠效率会使每个 GFP 分子的荧光信号按一个乘法因子 $f$ 进行缩放，而不会改变 $P_{\\text{lac}}$ 的转录状态。这会影响读出灵敏度，但不会将一个被紧密阻遏的启动子转变为转录上去阻遏的状态。完全归因于折叠效率的高基础荧光将意味着，在 DH5α 中同样低的基础表达只是不易被检测到，然而观察到的现象是 BL21(DE3) 中阻遏作用的定性失败。因此，这不是泄露转录最可能的原因。\n\n- 假说 B（BL21(DE3) 中质粒拷贝数更高）：令 $N$ 表示质粒拷贝数。操纵子位点的数量与 $N$ 成正比。由弱启动子产生的 LacI 总量也与 $N$ 成正比，但由于 LacI 启动子很弱而 $P_{\\text{lac}}$ 很强，有效的阻遏需要活性阻遏物的数量大大超过可用操纵子位点的数量，同时要考虑到结合化学计量、非特异性结合和随机波动。在实践中，高拷贝数会滴定阻遏蛋白，而对基于 lac 的启动子进行严密控制通常需要提高 LacI 的表达量（例如，lacI^{q}）以克服操纵子滴定效应。宿主依赖性的 ColE1 类复制起始点控制差异可以改变 $N$，并且表达宿主可能产生与克隆菌株不同的 $N$。因此，BL21(DE3) 中增加的 $N$ 是一个合理的通用机制，它通过使弱 LacI 的供应量相对于强的 $P_{\\text{lac}}$ 启动子数量而言不足，从而增加基础表达，导致泄漏。\n\n- 假说 C（BL21(DE3) 中降解 LacI 的蛋白酶水平更高）：BL21(DE3) 的一个决定性特征是它是蛋白酶缺陷型的（特别是 lon^{-} 和 ompT^{-}），这减少了重组蛋白的蛋白水解作用。“更高浓度的特异性降解 LacI 的内源性蛋白酶”这一说法与此普遍特性相矛盾。这个假说不合理。\n\n- 假说 D（BL21(DE3) 中翻译速度更快）：没有普遍特性表明 BL21(DE3) 的核糖体翻译任意基因的 mRNA 的速度“显著快于”DH5α 的核糖体。此外，任何全局翻译速率的增加都会同时影响 LacI 和 GFP，不会选择性地消除阻遏作用。这不是一个有说服力或普遍性的关于泄露转录的解释。\n\n在这些选项中，与 lac 阻遏回路中已知且常见的失败模式——基因剂量增加导致的操纵子滴定——相符的机制是假说 B。它解释了为什么弱表达的 LacI（来自弱组成型启动子）在 DH5α 中可能足够，但如果宿主环境增加了质粒拷贝数，从而增加了需要被阻遏的强 $P_{\\text{lac}}$ 启动子的数量，在 BL21(DE3) 中就会失败。这也符合一个更广泛的原则，即宿主依赖的复制控制可以调节拷贝数，从而调节对阻遏蛋白的需求。", "answer": "$$\\boxed{B}$$", "id": "1428108"}, {"introduction": "最高效的DBTL循环是由智能的实验设计所驱动的。这项高级练习将我们带到循环的最前端，专注于如何通过计算来优化“测试”阶段，以最大限度地增加“学习”到的信息 [@problem_id:2782988]。您将应用D-最优性原理来选择一组实验输入，从而为希尔（Hill）函数模型的参数化提供最多的信息，这是定量生物学的一个基石。", "problem": "在合成生物学的设计-构建-测试-学习 (DBTL) 循环中，“设计”步骤选择实验输入，以最大化“学习”步骤中的学习质量。考虑一个诱导型基因表达系统，其中稳态报告基因水平通过对诱导剂浓度的Hill响应进行建模。设确定性平均响应由Hill函数 $f(x;\\boldsymbol{\\theta})$ 给出，其中诱导剂浓度 $x$ 严格为正，参数向量为 $\\boldsymbol{\\theta} = (\\alpha,\\beta,K,n)$，且 $\\alpha \\in \\mathbb{R}$，$\\beta \\in \\mathbb{R}$，$K \\in \\mathbb{R}_{>0}$，$n \\in \\mathbb{R}_{>0}$。假设测量噪声为同方差独立高斯噪声，其方差为 $\\sigma^2$，因此在输入 $x_i$ 处的每次观测 $y_i$ 满足 $y_i = f(x_i;\\boldsymbol{\\theta}) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 且各个 $\\varepsilon_i$ 相互独立。目标是在有界输入条件下，选择一个诱导剂浓度的多重集，该多重集对于在指定的名义参数值下估计 $\\boldsymbol{\\theta}$ 是D-最优的。\n\n使用以下基本依据：\n- Hill平均响应为 $f(x;\\boldsymbol{\\theta}) = \\alpha + \\beta \\dfrac{x^n}{K^n + x^n}$。\n- 对于方差 $\\sigma^2$ 已知的独立高斯观测，一个设计 $\\{x_1,\\ldots,x_m\\}$ 的费雪信息矩阵 (FIM) 为 $I(\\boldsymbol{\\theta}) = \\dfrac{1}{\\sigma^2} \\sum_{i=1}^{m} \\left(\\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})\\right)\\left(\\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})\\right)^\\top$。\n- D-最优性准则旨在最大化 $\\det\\!\\left(I(\\boldsymbol{\\theta})\\right)$，当 $I(\\boldsymbol{\\theta})$ 为正定时，这等价于最大化 $\\log \\det\\!\\left(I(\\boldsymbol{\\theta})\\right)$。\n\n任务：编写一个完整程序，该程序为下述每个测试用例，根据以下约束和约定，计算一个D-最优精确设计：\n- 您必须从允许的诱导剂浓度的有限候选集 $\\Gamma \\subset (0,\\infty)$ 中，选择恰好 $m$ 次试验作为一个多重集。重复选择对应于在相同浓度下的技术重复。输入边界由 $\\Gamma$ 强制实施。\n- 对于给定的测试用例，将 $\\boldsymbol{\\theta}$ 和 $\\sigma$ 视为用于局部D-最优设计的已知名义常数。\n- 如果某个设计的 $I(\\boldsymbol{\\theta})$ 是奇异的，则定义 $\\log \\det\\!\\left(I(\\boldsymbol{\\theta})\\right) = -\\infty$。在 $\\log \\det$ 值达到最大值（容差为 $\\tau = 10^{-12}$）的设计中，选择字典序最小的已排序浓度多重集（升序）作为决胜规则。\n- 所有浓度必须以微摩尔（micromolar）为单位，按非递减顺序列出，并以浮点数形式报告。重复值表示重复试验。\n- 不出现角度。输出中不含百分比。\n\n您的程序必须从第一性原理出发计算 $\\nabla_{\\boldsymbol{\\theta}} f(x;\\boldsymbol{\\theta})$，并通过对所有从 $\\Gamma$ 中抽取的、大小为 $m$ 的多重集进行穷举搜索来评估D-最优设计。\n\n测试套件：\n- 案例1（正常路径）：\n  - $\\boldsymbol{\\theta} = (\\alpha,\\beta,K,n) = (10.0, 90.0, 50.0, 2.0)$\n  - $\\sigma = 5.0$\n  - $\\Gamma = [1.0, 5.0, 10.0, 20.0, 40.0, 60.0, 80.0, 100.0]$ 微摩尔\n  - $m = 4$\n- 案例2（解离常数附近有界候选集及更高噪声）：\n  - $\\boldsymbol{\\theta} = (\\alpha,\\beta,K,n) = (5.0, 95.0, 10.0, 2.0)$\n  - $\\sigma = 10.0$\n  - $\\Gamma = [2.0, 5.0, 10.0, 20.0]$ 微摩尔\n  - $m = 4$\n- 案例3（$m  \\dim(\\boldsymbol{\\theta})$ 的欠定边缘情况）：\n  - $\\boldsymbol{\\theta} = (\\alpha,\\beta,K,n) = (2.0, 18.0, 2.0, 3.0)$\n  - $\\sigma = 1.0$\n  - $\\Gamma = [0.5, 1.0, 2.0, 4.0]$ 微摩尔\n  - $m = 2$\n\n必需的最终输出格式：您的程序应生成单行输出，其中包含三个设计。每个设计都是一个微摩尔浓度列表，四舍五入到小数点后六位。这些列表聚合为一个逗号分隔的列表，并用方括号括起来，例如：$[[x_{1,1},x_{1,2},\\ldots],[x_{2,1},\\ldots],[x_{3,1},\\ldots]]$。打印行中不得有空格。\n\n科学真实性说明：\n- 所有候选浓度都严格为正，以避免对数中的不可微性。\n- “学习”步骤使用最大似然估计 (MLE)，其渐近协方差是真实参数处FIM的逆矩阵，这为DBTL中的设计采用D-最优性提供了动机。", "solution": "该问题要求确定一个D-最优实验设计，用于估计Hill函数模型的4个参数 $\\boldsymbol{\\theta} = (\\alpha, \\beta, K, n)$。该设计由从一个有限候选集 $\\Gamma$ 中选出的 $m$ 个诱导剂浓度组成的多重集 $\\{x_1, \\ldots, x_m\\}$ 构成。D-最优性准则旨在最大化费雪信息矩阵 (FIM) $I(\\boldsymbol{\\theta})$ 的行列式，或等效地，最大化其对数 $\\log \\det(I(\\boldsymbol{\\theta}))$。\n\n平均响应由Hill函数给出：\n$$f(x;\\boldsymbol{\\theta}) = \\alpha + \\beta \\dfrac{x^n}{K^n + x^n}$$\n对于方差为 $\\sigma^2$ 的独立高斯观测，一个设计 $D = \\{x_1, \\ldots, x_m\\}$ 的FIM为：\n$$I(\\boldsymbol{\\theta}) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{m} \\left(\\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})\\right) \\left(\\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})\\right)^\\top$$\n最大化 $\\det(I(\\boldsymbol{\\theta}))$ 等价于最大化 $\\det\\left(\\sum_{i=1}^{m} \\mathbf{g}_i \\mathbf{g}_i^\\top\\right)$，其中 $\\mathbf{g}_i = \\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})$，因为常数前置因子 $1/\\sigma^2$ 不会改变最优解的位置。我们定义未缩放的信息矩阵 $M(D) = \\sum_{x_i \\in D} \\mathbf{g}_i \\mathbf{g}_i^\\top$，并寻求最大化其对数行列式 $\\log \\det(M(D))$。\n\n第一性原理推导始于计算梯度向量 $\\nabla_{\\boldsymbol{\\theta}} f(x;\\boldsymbol{\\theta})$，它由关于 $\\boldsymbol{\\theta}$ 中每个参数的偏导数组成。\n\n1.  关于基础水平 $\\alpha$ 的导数：\n    $$\\frac{\\partial f}{\\partial \\alpha} = 1$$\n\n2.  关于动态范围 $\\beta$ 的导数：\n    $$\\frac{\\partial f}{\\partial \\beta} = \\frac{x^n}{K^n + x^n}$$\n\n3.  关于解离常数 $K$ 的导数：\n    $$\\frac{\\partial f}{\\partial K} = \\beta \\frac{\\partial}{\\partial K} \\left( \\frac{x^n}{K^n + x^n} \\right) = \\beta x^n \\frac{\\partial}{\\partial K} \\left( (K^n + x^n)^{-1} \\right)$$\n    使用链式法则：\n    $$\\frac{\\partial f}{\\partial K} = \\beta x^n \\left( -1 \\cdot (K^n + x^n)^{-2} \\cdot \\frac{\\partial}{\\partial K}(K^n) \\right) = -\\beta x^n (K^n + x^n)^{-2} (n K^{n-1})$$\n    $$\\frac{\\partial f}{\\partial K} = - \\frac{\\beta n K^{n-1} x^n}{(K^n + x^n)^2}$$\n\n4.  关于Hill系数 $n$ 的导数：\n    $$\\frac{\\partial f}{\\partial n} = \\beta \\frac{\\partial}{\\partial n} \\left( \\frac{x^n}{K^n + x^n} \\right)$$\n    使用恒等式 $a^b = e^{b \\ln a}$ 并对 $g(n) = \\frac{u(n)}{v(n)}$ 应用商法则，其中 $u(n) = x^n$，$v(n) = K^n + x^n$：\n    $$\\frac{\\partial u}{\\partial n} = x^n \\ln x \\quad \\text{和} \\quad \\frac{\\partial v}{\\partial n} = K^n \\ln K + x^n \\ln x$$\n    $$\\frac{\\partial g}{\\partial n} = \\frac{v \\frac{\\partial u}{\\partial n} - u \\frac{\\partial v}{\\partial n}}{v^2} = \\frac{(K^n + x^n)(x^n \\ln x) - x^n(K^n \\ln K + x^n \\ln x)}{(K^n + x^n)^2}$$\n    $$= \\frac{K^n x^n \\ln x + (x^n)^2 \\ln x - K^n x^n \\ln K - (x^n)^2 \\ln x}{(K^n + x^n)^2} = \\frac{K^n x^n (\\ln x - \\ln K)}{(K^n + x^n)^2}$$\n    因此，\n    $$\\frac{\\partial f}{\\partial n} = \\frac{\\beta K^n x^n \\ln(x/K)}{(K^n + x^n)^2}$$\n\n在名义参数 $\\boldsymbol{\\theta}$ 下，给定浓度 $x$ 的完整梯度向量为：\n$$\\nabla_{\\boldsymbol{\\theta}} f(x;\\boldsymbol{\\theta}) = \\begin{pmatrix} 1 \\\\ \\frac{x^n}{K^n + x^n} \\\\ - \\frac{\\beta n K^{n-1} x^n}{(K^n + x^n)^2} \\\\ \\frac{\\beta K^n x^n \\ln(x/K)}{(K^n + x^n)^2} \\end{pmatrix}$$\n\n通过对从候选集 $\\Gamma$ 中抽取的、所有可能的大小为 $m$ 的多重集进行穷举搜索来找到解。这对应于可重复组合。如果 $|\\Gamma|=k$，则此类多重集的数量为 $\\binom{k+m-1}{m}$。对于每个候选设计 $D = \\{x_1, \\ldots, x_m\\}$，计算过程如下：\n1.  初始化一个 $4 \\times 4$ 的零矩阵 $M(D)$。\n2.  对于 $D$ 中的每个浓度 $x_i$，使用名义参数值计算梯度向量 $\\mathbf{g}_i = \\nabla_{\\boldsymbol{\\theta}} f(x_i;\\boldsymbol{\\theta})$。\n3.  计算外积 $\\mathbf{g}_i \\mathbf{g}_i^\\top$（这是一个 $4 \\times 4$ 的秩为1的矩阵），并将其加到 $M(D)$ 上。\n4.  在对所有 $x_i \\in D$ 求和后，计算目标函数值，即所得矩阵 $M(D)$ 的对数行列式。如果 $M(D)$ 是奇异的，其行列式为0，其对数行列式定义为 $-\\infty$。这可以通过检查 `numpy.linalg.slogdet` 返回的符号来在数值上处理。\n\n最优设计是使该目标函数最大化的设计。生成一个包含所有候选设计及其相应对数行列式值的列表。确定最大对数行列式 $\\mathcal{L}_{max}$。所有对数行列式 $\\mathcal{L}$ 满足 $|\\mathcal{L} - \\mathcal{L}_{max}| \\le \\tau$（其中容差 $\\tau = 10^{-12}$）的设计都被视为最优设计。在该最优设计集合中，问题指定选择其浓度经过排序后（非递减序列）字典序最小的那个。\n\n对于案例3，其中试验次数 $m=2$ 小于参数数量 $d=4$，FIM必然是奇异的。矩阵 $M(D)$ 是 $m=2$ 个秩为1的矩阵之和，因此其秩最多为2。一个秩小于4的 $4 \\times 4$ 矩阵的行列式为0。因此，所有可能的设计都产生 $-\\infty$ 的目标值。决胜规则成为唯一的选择标准。因此，最优设计是从 $\\Gamma$ 中选取的、大小为2的字典序最小的多重集，即 $\\{0.5, 0.5\\}$。这表明对问题中关于欠定情况的标准有正确的解释。", "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Computes D-optimal designs for three test cases by exhaustive search.\n    \"\"\"\n    test_cases = [\n        {\n            \"theta\": (10.0, 90.0, 50.0, 2.0),  # (alpha, beta, K, n)\n            \"sigma\": 5.0,\n            \"gamma\": [1.0, 5.0, 10.0, 20.0, 40.0, 60.0, 80.0, 100.0],\n            \"m\": 4,\n        },\n        {\n            \"theta\": (5.0, 95.0, 10.0, 2.0),\n            \"sigma\": 10.0,\n            \"gamma\": [2.0, 5.0, 10.0, 20.0],\n            \"m\": 4,\n        },\n        {\n            \"theta\": (2.0, 18.0, 2.0, 3.0),\n            \"sigma\": 1.0,\n            \"gamma\": [0.5, 1.0, 2.0, 4.0],\n            \"m\": 2,\n        },\n    ]\n\n    all_results = []\n    tau = 1e-12\n\n    def get_gradient(x, theta):\n        \"\"\"\n        Computes the gradient of the Hill function f with respect to theta.\n        theta = (alpha, beta, K, n)\n        \"\"\"\n        alpha, beta, K, n = theta\n        \n        # To prevent log(0) or division by zero, though problem constraints make it unlikely\n        if x == 0 or K == 0:\n            return np.zeros(4)\n\n        x_n = x**n\n        K_n = K**n\n        denominator = K_n + x_n\n        \n        if denominator == 0:\n            return np.zeros(4)\n        \n        common_term_beta = x_n / denominator\n        \n        # Partial derivatives\n        df_d_alpha = 1.0\n        df_d_beta = common_term_beta\n        df_d_K = -beta * n * (K**(n - 1)) * x_n / (denominator**2)\n        df_d_n = beta * K_n * x_n * np.log(x / K) / (denominator**2)\n        \n        return np.array([df_d_alpha, df_d_beta, df_d_K, df_d_n])\n\n    for case in test_cases:\n        theta = case[\"theta\"]\n        gamma = case[\"gamma\"]\n        m = case[\"m\"]\n        \n        num_params = len(theta)\n        \n        design_candidates = itertools.combinations_with_replacement(gamma, m)\n        \n        evaluated_designs = []\n        \n        for design in design_candidates:\n            fim_unscaled = np.zeros((num_params, num_params))\n            for x_i in design:\n                g = get_gradient(x_i, theta)\n                fim_unscaled += np.outer(g, g)\n            \n            sign, logdet = np.linalg.slogdet(fim_unscaled)\n            \n            # If matrix is singular or not positive definite, logdet is -inf\n            if sign = 0:\n                objective_value = -np.inf\n            else:\n                objective_value = logdet\n            \n            evaluated_designs.append((objective_value, list(design)))\n\n        # Find the maximum log-determinant value\n        if not evaluated_designs:\n            # Should not happen with the given constraints\n            all_results.append([])\n            continue\n            \n        max_log_det = -np.inf\n        for log_det_val, _ in evaluated_designs:\n            if log_det_val  max_log_det:\n                max_log_det = log_det_val\n        \n        # Filter for designs that are optimal within the tolerance\n        best_designs = []\n        for log_det_val, design in evaluated_designs:\n            if abs(log_det_val - max_log_det) = tau:\n                best_designs.append(design)\n        \n        # The first item in best_designs is the lexicographically smallest\n        # because itertools.combinations_with_replacement generates them in order.\n        optimal_design = best_designs[0]\n        all_results.append(optimal_design)\n\n    # Format the final output string exactly as specified\n    def format_list(lst):\n        return f\"[{','.join(f'{x:.6f}' for x in lst)}]\"\n\n    results_as_strings = [format_list(res) for res in all_results]\n    print(f\"[[{','.join(results_as_strings)}]]\")\n\nsolve()\n```", "id": "2782988"}]}