{"hands_on_practices": [{"introduction": "在量化噪声之前，我们必须首先对其不同形式建立坚实的概念性理解。本练习利用一个常见的合成生物学装置——双报告基因质粒——来挑战你根据基本定义区分内在噪声和外在噪声。正确识别变异的来源是分析和工程化生物系统的关键第一步。[@problem_id:1440272]", "problem": "在系统生物学领域，基因表达噪音指的是在相同环境下，遗传上相同的细胞之间观察到的基因产物数量的变异性。这种变异性通常分为两类：\n\n1.  **内在噪音 (Intrinsic Noise)**：这源于转录和翻译等生物化学过程固有的随机性。它会导致单个细胞内的两个相同基因的表达水平彼此不同。这是一种局部效应，特定于每个基因的表达机制。\n2.  **外在噪音 (Extrinsic Noise)**：这来自基因共用的其他细胞组分在数量或状态上的波动。这些组分可以包括RNA聚合酶、核糖体或转录因子等分子。这种噪音以相关的方式影响细胞内的不同基因，并且是群体中细胞间差异的主要原因。\n\n考虑一个合成生物学实验，其中一群细菌细胞被一种类型的质粒转化。这种质粒是“多拷贝”质粒，意味着质粒分子的数量在群体中的不同细胞之间是变化的。每个质粒携带两种不同荧光报告蛋白——绿色荧光蛋白（GFP）和红色荧光蛋白（RFP）的遗传回路。GFP和RFP的基因由相同的、组成型活跃的启动子驱动。\n\n质粒数量的细胞间差异是观察到的荧光变异性的一个重要来源。下列哪个陈述正确地归类了这种噪音来源并提供了正确的推理？\n\nA. 它是一种内在噪音，因为质粒是基因的DNA模板，而模板的变异是基因表达过程所固有的。\nB. 它是一种外在噪音，因为质粒数量作为一个全局细胞变量，同时影响GFP和RFP的基因剂量，导致它们的表达水平在整个细胞群体中呈相关性。\nC. 它同时贡献于内在和外在噪音，因为它既是基因模板的一个特征（内在的），又在群体中变化（外在的）。\nD. 它是一种内在噪音，因为GFP和RFP这两个报告基因是不同的，因此任何与它们相关的变异对于每个特定基因来说都是内在的。\nE. 它是一种外在噪音，因为质粒可以在细胞质内的不同位置移动，这种空间变异是转录过程外部的。", "solution": "我们从同一细胞内两个共表达的报告基因 $G$ 和 $R$ 的细胞间变异性的标准分解开始。令 $X_{G}$ 和 $X_{R}$ 表示GFP和RFP的表达水平。一个方便的表示方法是\n$$\nX_{G} = f_{G}(S) + \\eta_{G}, \\quad X_{R} = f_{R}(S) + \\eta_{R},\n$$\n其中 $S$ 集合了共同影响两个报告基因的共享细胞状态变量（外在因素），而 $\\eta_{G}$ 和 $\\eta_{R}$ 表示在固定 $S$ 的情况下独立的、报告基因特异性的波动（内在因素）。根据定义，不同细胞间 $S$ 的变化会产生 $X_{G}$ 和 $X_{R}$ 的相关波动（外在噪音），而 $\\eta_{G}$ 和 $\\eta_{R}$ 的变化则会在同一细胞内产生两者之间的不相关差异（内在噪音）。\n\n在给定的情景中，共享的状态变量是质粒拷贝数，记为 $N$。因为GFP和RFP都在同一个多拷贝质粒上，并由相同的组成型启动子驱动，所以基因剂量将两个报告基因的表达水平都与 $N$ 成比例地调整。作为一阶近似，可以写成\n$$\nX_{G} = a N + \\epsilon_{G}, \\quad X_{R} = b N + \\epsilon_{R},\n$$\n其中常数 $a$ 和 $b$ 捕捉了每个质粒拷贝的平均表达量，而 $\\epsilon_{G}、\\epsilon_{R}$ 代表在固定 $N$ 时的内在波动。那么，细胞间的协方差为\n$$\n\\mathrm{Cov}(X_{G},X_{R}) = ab\\,\\mathrm{Var}(N) + \\mathrm{Cov}(\\epsilon_{G},\\epsilon_{R}).\n$$\n在同一细胞内，两个不同报告基因的内在组分通常是独立的，因此 $\\mathrm{Cov}(\\epsilon_{G},\\epsilon_{R}) \\approx 0$。因此，主要的相关变异来自于 $\\mathrm{Var}(N)$，即质粒拷贝数在细胞间的变异，这是一个由两个报告基因共享的全局细胞变量。这符合外在噪音的定义。\n\n评估各个选项：\n- A 是不正确的，因为内在噪音指的是在细胞内固定细胞状态下的表达随机性，而不是基因剂量的细胞间变异；拷贝数变异是一个共享的、细胞水平的变量，因此是外在的。\n- B 是正确的：质粒拷贝数 $N$ 作为一个全局变量，同时调节GFP和RFP的基因剂量，从而产生跨细胞的相关表达，这属于外在噪音。\n- C 在此情境下是不正确的，因为所指出的来源明确是 $N$ 的细胞间变异，这是外在的；虽然存在其他内在过程，但它们不是题干中特别指出的来源。\n- D 是不正确的，因为报告基因不同本身并不定义内在噪音；内在噪音会导致同一细胞内两个相同拷贝之间的独立波动，而不是由共享的剂量变量引起的相关性缩放。\n- E 是不正确的，因为质粒的空间移动在这里不是相关的机制，而且无论如何，关键效应是共享的拷贝数变异，根据定义这被归类为外在的。\n\n因此，正确的分类和推理是选项B中的内容。", "answer": "$$\\boxed{B}$$", "id": "1440272"}, {"introduction": "在概念上区分了噪声来源之后，下一步便是对它们进行测量。本练习为你提供了来自双报告基因实验的模拟数据，这是一种用于剖析噪声的系统生物学基石技术。你将应用一个关键的统计公式来计算外在噪声分量，从而将抽象概念转化为对细胞变异性的具体、量化的度量。[@problem_id:1444520]", "problem": "一位合成生物学家正在研究一个细菌群体中基因表达的随机性。该研究使用了一个双报告系统，其中单个质粒携带两个相同的基因启动子。每个启动子驱动一种不同的荧光蛋白的表达：蛋白 C (青色) 和蛋白 Y (黄色)。使用流式细胞术测量单个细胞的荧光强度，从而提供整个群体中蛋白质表达水平的统计快照。\n\n每种蛋白质表达水平的总变异性源于两个来源：“内在噪音”，其特定于每个基因拷贝的生物化学反应；以及“外在噪音”，其源于共享细胞环境的波动并同时影响两个基因。\n\n对流式细胞术数据的分析得出了以下统计矩，其中强度以任意荧光单位 (AFU) 测量：\n- 蛋白 C 的平均强度：$\\mu_C = 1550$ AFU\n- 蛋白 Y 的平均强度：$\\mu_Y = 1620$ AFU\n- 蛋白 C 强度的方差：$\\sigma_C^2 = 1.95 \\times 10^5 \\text{ (AFU)}^2$\n- 蛋白 Y 强度的方差：$\\sigma_Y^2 = 2.05 \\times 10^5 \\text{ (AFU)}^2$\n- 蛋白 C 和蛋白 Y 强度的协方差：$\\mathrm{Cov}(C, Y) = 8.50 \\times 10^4 \\text{ (AFU)}^2$\n\n根据双报告系统中的噪音分解理论，计算由外在噪音引起的变异系数的平方，记为 $\\eta_{ext}^2$。这个量是衡量外在噪音大小的一个关键无量纲指标。将最终答案四舍五入至三位有效数字。", "solution": "在双报告框架中，设 $C$ 和 $Y$ 分别表示由两个相同的启动子驱动不同报告基因所产生的荧光强度。将表达量分解为围绕其均值的乘性波动：\n$$\nC = \\mu_{C}\\left(1 + E + I_{C}\\right), \\quad Y = \\mu_{Y}\\left(1 + E + I_{Y}\\right),\n$$\n其中 $E$ 是两个报告基因共享的外在波动，且 $\\mathbb{E}[E]=0$，而 $I_{C}, I_{Y}$ 是特定于每个报告基因的、独立的、零均值的内在波动。假设 $E$、$I_{C}$ 和 $I_{Y}$ 相互不相关，且 $\\mathrm{Cov}(I_{C}, I_{Y})=0$。\n\n那么 $C$ 和 $Y$ 之间的协方差为\n$$\n\\mathrm{Cov}(C,Y) = \\mu_{C}\\mu_{Y}\\,\\mathrm{Cov}(1+E+I_{C},\\,1+E+I_{Y})\n= \\mu_{C}\\mu_{Y}\\,\\mathrm{Var}(E).\n$$\n将由外在噪音引起的变异系数的平方定义为 $\\eta_{ext}^{2} \\equiv \\mathrm{Var}(E)$。因此，\n$$\n\\eta_{ext}^{2} = \\frac{\\mathrm{Cov}(C,Y)}{\\mu_{C}\\mu_{Y}}.\n$$\n代入给定值 $\\mu_{C}=1550$，$\\mu_{Y}=1620$ 和 $\\mathrm{Cov}(C,Y)=8.50\\times 10^{4}$：\n$$\n\\eta_{ext}^{2} = \\frac{8.50\\times 10^{4}}{1550\\times 1620}\n= \\frac{8.50\\times 10^{4}}{2.511\\times 10^{6}}\n= \\frac{85}{2511}\n\\approx 0.033851056\\ldots\n$$\n四舍五入到三位有效数字，得到\n$$\n\\eta_{ext}^{2} \\approx 0.0339.\n$$\n该结果是无量纲的，符合要求。", "answer": "$$\\boxed{0.0339}$$", "id": "1444520"}, {"introduction": "理解和测量噪声是一回事，而在数学模型中解释其复杂效应则是另一回事。这项高级练习深入探讨了外在噪声对转录爆发模型参数推断产生的微妙但重要的影响。通过推导偏差并建立校正因子，你将更深刻地体会到，为何严谨的噪声分析对于构建准确的基因调控预测模型至关重要。[@problem_id:2774339]", "problem": "给定一个细胞群，其中每个细胞的信使核糖核酸 (mRNA) 计数（记为 $X$）源于脉冲式转录。在给定的外在细胞状态 $A$（代表每个mRNA生命周期内有效脉冲频率的细胞间变异）条件下，mRNA计数 $X \\mid A = a$ 服从形状参数为 $a$、均值为 $a b$ 的负二项 (NB) 分布，其中 $b$ 是平均脉冲大小（每个脉冲产生的分子数）。以下经过充分检验的事实是本问题的基础：(i) 条件均值为 $\\mathbb{E}[X \\mid A = a] = a b$，(ii) 条件方差为 $\\mathrm{Var}(X \\mid A = a) = a b + a b^{2}$，因此条件Fano因子等于 $1 + b$。外在状态 $A$ 是一个正随机变量，其均值为 $\\bar a$，变异系数的平方为 $\\mathrm{CV}_{A}^{2} = \\mathrm{Var}(A)/\\bar a^{2}$，且在细胞间相互独立。除了要求 $A$ 的分布存在前两阶矩之外，无需其他任何假设。\n\n一位从业者通过将观测到的 $X$ 的均值 $\\mu_{\\mathrm{obs}}$ 和方差 $\\sigma_{\\mathrm{obs}}^{2}$与NB矩关系式进行匹配，来朴素地拟合一个忽略了外在变异性的NB模型：对于均值为 $\\mu$、形状参数为 $k$ 的NB分布，其方差为 $\\mu + \\mu^{2}/k$。使用观测矩，得到的朴素矩估计值为 $\\hat{k}_{\\mathrm{NB}} = \\mu_{\\mathrm{obs}}^{2}/(\\sigma_{\\mathrm{obs}}^{2} - \\mu_{\\mathrm{obs}})$ 和 $\\hat{b}_{\\mathrm{NB}} = \\sigma_{\\mathrm{obs}}^{2}/\\mu_{\\mathrm{obs}} - 1$。在脉冲式NB解释下，当映射回脉冲参数 $(a, b)$ 时，有 $\\hat{a}_{\\mathrm{NB}} = \\mu_{\\mathrm{obs}}/\\hat{b}_{\\mathrm{NB}}$。\n\n任务1 (推导)：仅从给定的基础（条件NB均值和方差，以及期望和方差的定义）出发，使用全期望定律和全方差定律，推导出以 $\\bar a$、$b$ 和 $\\mathrm{CV}_{A}^{2}$ 表示的观测均值 $\\mu_{\\mathrm{obs}}$ 和观测方差 $\\sigma_{\\mathrm{obs}}^{2}$ 的公式。然后分析忽略外在变异性的朴素NB拟合所产生的偏差：将 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$ 表示为真实参数 $\\bar a$、$b$ 和 $\\mathrm{CV}_{A}^{2}$ 的函数。\n\n任务2 (校正)：根据你得到的偏差表达式，代数推导出校正因子，以便在 $\\mathrm{CV}_{A}^{2}$ 已知的情况下，从朴素NB矩估计值 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}})$ 中恢复真实参数 $(\\bar a, b)$。你最终的校正估计量必须仅为 $\\hat{a}_{\\mathrm{NB}}$、$\\hat{b}_{\\mathrm{NB}}$ 和 $\\mathrm{CV}_{A}^{2}$ 的显式函数。说明为使校正有良好定义所需的任何定义域条件。\n\n编程任务：实现一个程序，对每个测试用例 $(\\bar a, b, \\mathrm{CV}_{A}^{2})$ 执行以下步骤：\n- 使用你在任务1中推导出的公式计算观测均值 $\\mu_{\\mathrm{obs}}$ 和观测方差 $\\sigma_{\\mathrm{obs}}^{2}$。\n- 根据 $(\\mu_{\\mathrm{obs}}, \\sigma_{\\mathrm{obs}}^{2})$ 计算朴素NB矩估计值 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$。\n- 应用你在任务2中的校正公式，得到仅以 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}}, \\mathrm{CV}_{A}^{2})$ 表示的校正估计值 $(\\hat{a}_{\\mathrm{corr}}, \\hat{b}_{\\mathrm{corr}})$。\n- 对每个测试用例，输出列表 $[\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}}, \\hat{a}_{\\mathrm{corr}}, \\hat{b}_{\\mathrm{corr}}]$，所有四个数字都四舍五入到六位小数。\n\n测试套件（每个元组列出 $(\\bar a, b, \\mathrm{CV}_{A}^{2})$）：\n- 用例A（理想情况）：$(5.0, 2.0, 0.3)$。\n- 用例B（无外在变异性）：$(10.0, 0.5, 0.0)$。\n- 用例C（相对于 $\\bar a$ 的边界类高外在变异性）：$(50.0, 1.0, 1.0)$。\n- 用例D（低脉冲频率和 大 脉冲大小）：$(0.8, 5.0, 0.5)$。\n- 用例E（具有非整数脉冲大小的中等参数）：$(3.2, 1.7, 0.25)$。\n\n最终输出格式：你的程序应生成一行输出，其中包含一个逗号分隔的子列表列表，子列表用方括号括起，顺序与测试套件相同。例如，一个有效的输出行格式为 $[[x_{1},y_{1},z_{1},w_{1}],[x_{2},y_{2},z_{2},w_{2}],\\dots]$，其中每个 $x_{i}, y_{i}, z_{i}, w_{i}$ 是一个四舍五入到六位小数的十进制数。不应打印任何其他文本。", "solution": "该问题要求推导在忽略外在变异性的情况下，脉冲式转录模型参数估计中的偏差，并随后推导消除此偏差的校正因子。分析将从第一性原理出发，使用全期望定律和全方差定律进行。\n\n**任务1：观测矩和朴素估计量偏差的推导**\n\n模型假定，在给定细胞状态 $A=a$ 时，mRNA计数 $X$ 服从负二项分布，$X \\mid A=a \\sim \\mathrm{NB}(\\text{形状}=a, \\text{均值}=ab)$。条件矩如下：\n$$\n\\mathbb{E}[X \\mid A=a] = ab\n$$\n$$\n\\mathrm{Var}(X \\mid A=a) = ab + ab^2\n$$\n外在状态 $A$ 是一个随机变量，其均值为 $\\mathbb{E}[A] = \\bar{a}$，方差为 $\\mathrm{Var}(A)$。$A$ 的变异系数的平方为 $\\mathrm{CV}_{A}^{2} = \\mathrm{Var}(A) / \\bar{a}^2$。\n\n首先，我们推导 $X$ 的无条件（观测）均值 $\\mu_{\\mathrm{obs}}$ 和方差 $\\sigma_{\\mathrm{obs}}^{2}$。\n\n**观测均值 $\\mu_{\\mathrm{obs}}$**\n\n根据全期望定律，观测均值是条件均值的期望：\n$$\n\\mu_{\\mathrm{obs}} = \\mathbb{E}[X] = \\mathbb{E}_{A}[\\mathbb{E}[X \\mid A]]\n$$\n代入条件均值的表达式 $\\mathbb{E}[X \\mid A] = Ab$：\n$$\n\\mu_{\\mathrm{obs}} = \\mathbb{E}_{A}[Ab] = b \\cdot \\mathbb{E}[A]\n$$\n因此，观测均值为：\n$$\n\\mu_{\\mathrm{obs}} = \\bar{a}b\n$$\n\n**观测方差 $\\sigma_{\\mathrm{obs}}^{2}$**\n\n根据全方差定律，观测方差是条件方差的期望与条件均值的方差之和：\n$$\n\\sigma_{\\mathrm{obs}}^{2} = \\mathrm{Var}(X) = \\mathbb{E}_{A}[\\mathrm{Var}(X \\mid A)] + \\mathrm{Var}_{A}(\\mathbb{E}[X \\mid A])\n$$\n我们分别计算每一项。\n\n第一项是条件方差的期望，$\\mathrm{Var}(X \\mid A) = Ab + Ab^2$：\n$$\n\\mathbb{E}_{A}[\\mathrm{Var}(X \\mid A)] = \\mathbb{E}_{A}[A(b+b^2)] = (b+b^2)\\mathbb{E}[A] = \\bar{a}(b+b^2) = \\bar{a}b + \\bar{a}b^2\n$$\n第二项是条件均值的方差，$\\mathbb{E}[X \\mid A] = Ab$：\n$$\n\\mathrm{Var}_{A}(\\mathbb{E}[X \\mid A]) = \\mathrm{Var}_{A}(Ab) = b^2 \\mathrm{Var}(A)\n$$\n使用定义 $\\mathrm{Var}(A) = \\bar{a}^2 \\mathrm{CV}_{A}^{2}$，该项变为：\n$$\n\\mathrm{Var}_{A}(Ab) = b^2 \\bar{a}^2 \\mathrm{CV}_{A}^{2} = (\\bar{a}b)^2 \\mathrm{CV}_{A}^{2}\n$$\n结合这两项，我们得到观测方差：\n$$\n\\sigma_{\\mathrm{obs}}^{2} = (\\bar{a}b + \\bar{a}b^2) + (\\bar{a}b)^2 \\mathrm{CV}_{A}^{2} = \\bar{a}b(1+b) + \\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}\n$$\n\n**朴素估计量的偏差**\n\n朴素分析忽略了外在变异性，并通过将观测矩 $(\\mu_{\\mathrm{obs}}, \\sigma_{\\mathrm{obs}}^{2})$ 与简单NB分布的矩进行匹配来估计参数 $\\hat{a}_{\\mathrm{NB}}$ 和 $\\hat{b}_{\\mathrm{NB}}$。朴素估计量由下式给出：\n$$\n\\hat{b}_{\\mathrm{NB}} = \\frac{\\sigma_{\\mathrm{obs}}^{2}}{\\mu_{\\mathrm{obs}}} - 1\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} = \\frac{\\mu_{\\mathrm{obs}}}{\\hat{b}_{\\mathrm{NB}}}\n$$\n我们代入推导出的 $\\mu_{\\mathrm{obs}}$ 和 $\\sigma_{\\mathrm{obs}}^{2}$ 表达式来求偏差。首先，我们计算比率 $\\sigma_{\\mathrm{obs}}^{2}/\\mu_{\\mathrm{obs}}$：\n$$\n\\frac{\\sigma_{\\mathrm{obs}}^{2}}{\\mu_{\\mathrm{obs}}} = \\frac{\\bar{a}b(1+b) + \\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}}{\\bar{a}b} = (1+b) + \\frac{\\bar{a}^2 b^2 \\mathrm{CV}_{A}^{2}}{\\bar{a}b} = 1+b + \\bar{a}b\\mathrm{CV}_{A}^{2}\n$$\n现在我们求出朴素脉冲大小估计值 $\\hat{b}_{\\mathrm{NB}}$ 的表达式：\n$$\n\\hat{b}_{\\mathrm{NB}} = \\left(1+b + \\bar{a}b\\mathrm{CV}_{A}^{2}\\right) - 1 = b + \\bar{a}b\\mathrm{CV}_{A}^{2} = b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})\n$$\n该结果表明，只要存在外在变异性（$\\mathrm{CV}_{A}^{2} > 0$），$\\hat{b}_{\\mathrm{NB}}$ 就是对真实平均脉冲大小 $b$ 的高估。\n\n接下来，我们求出朴素脉冲频率参数 $\\hat{a}_{\\mathrm{NB}}$ 的表达式：\n$$\n\\hat{a}_{\\mathrm{NB}} = \\frac{\\mu_{\\mathrm{obs}}}{\\hat{b}_{\\mathrm{NB}}} = \\frac{\\bar{a}b}{b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})} = \\frac{\\bar{a}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n该结果表明，当 $\\mathrm{CV}_{A}^{2} > 0$ 时，$\\hat{a}_{\\mathrm{NB}}$ 是对真实平均脉冲频率参数 $\\bar{a}$ 的低估。\n\n**任务2：校正因子的推导**\n\n目标是逆轉偏差，并从朴素估计值 $(\\hat{a}_{\\mathrm{NB}}, \\hat{b}_{\\mathrm{NB}})$ 和已知的外在变异性 $\\mathrm{CV}_{A}^{2}$ 中恢复真实参数 $(\\bar{a}, b)$。我们有以下方程组：\n$$\n(1) \\quad \\hat{a}_{\\mathrm{NB}} = \\frac{\\bar{a}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n$$\n(2) \\quad \\hat{b}_{\\mathrm{NB}} = b(1 + \\bar{a}\\mathrm{CV}_{A}^{2})\n$$\n我们必须求解该方程组以得到 $\\bar{a}$ 和 $b$。\n\n**对 $\\bar{a}$ 的校正**\n\n从方程 $(1)$，我们求解 $\\bar{a}$：\n$$\n\\hat{a}_{\\mathrm{NB}} (1 + \\bar{a}\\mathrm{CV}_{A}^{2}) = \\bar{a}\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} + \\hat{a}_{\\mathrm{NB}}\\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}\n$$\n$$\n\\hat{a}_{\\mathrm{NB}} = \\bar{a} - \\hat{a}_{\\mathrm{NB}}\\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n这给出了 $\\bar{a}$ 的校正估计量，我们记为 $\\hat{a}_{\\mathrm{corr}}$：\n$$\n\\hat{a}_{\\mathrm{corr}} = \\bar{a} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n\n**对 $b$ 的校正**\n\n为了求解 $b$，我们首先重新整理方程 $(2)$：\n$$\nb = \\frac{\\hat{b}_{\\mathrm{NB}}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}\n$$\n我们可以利用我们关于 $\\bar{a}$ 的结果来找到项 $(1 + \\bar{a}\\mathrm{CV}_{A}^{2})$ 的表达式。从 $\\hat{a}_{\\mathrm{corr}}$ 的推导中，我们有 $\\hat{a}_{\\mathrm{NB}} = \\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})$。这似乎不是直接的方法。\n\n让我们换一种方式，使用一个代数恒等式。从 $\\bar{a}$ 的推导中，我们有 $1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2} = \\hat{a}_{\\mathrm{NB}}/\\bar{a}$。让我们把它倒过来。等等。让我们重新检查 $\\bar{a}$ 的表达式：$\\bar{a}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}) = \\hat{a}_{\\mathrm{NB}}$。现在再看方程(1)：$1 + \\bar{a}\\mathrm{CV}_{A}^{2} = \\bar{a}/\\hat{a}_{\\mathrm{NB}}$。这是正确的。将此代入 $b$ 的表达式中：$b = \\frac{\\hat{b}_{\\mathrm{NB}}}{\\bar{a}/\\hat{a}_{\\mathrm{NB}}} = \\frac{\\hat{a}_{\\mathrm{NB}}\\hat{b}_{\\mathrm{NB}}}{\\bar{a}}$。这仅仅是 $\\mu_{\\mathrm{obs}}/\\bar{a} = b$，这是一个同义反复，没有帮助。\n\n一个更有效的方法是将分母 $(1 + \\bar{a}\\mathrm{CV}_{A}^{2})$ 用朴素估计值表示。从方程 $(1)$，我们有 $1 + \\bar{a}\\mathrm{CV}_{A}^{2} = \\frac{\\bar{a}}{\\hat{a}_{\\mathrm{NB}}}$。代入校正后的 $\\bar{a}$ 的表达式 $\\bar{a} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}$：\n$$\n1 + \\bar{a}\\mathrm{CV}_{A}^{2} = 1 + \\left(\\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\\right)\\mathrm{CV}_{A}^{2} = \\frac{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2} + \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}} = \\frac{1}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n现在将此代回 $b$ 的表达式中：\n$$\nb = \\frac{\\hat{b}_{\\mathrm{NB}}}{1 / (1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})} = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n这给出了 $b$ 的校正估计量，记为 $\\hat{b}_{\\mathrm{corr}}$：\n$$\n\\hat{b}_{\\mathrm{corr}} = b = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n\n**校正公式和条件总结**\n\n校正后的估计量为：\n$$\n\\hat{a}_{\\mathrm{corr}} = \\frac{\\hat{a}_{\\mathrm{NB}}}{1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}}\n$$\n$$\n\\hat{b}_{\\mathrm{corr}} = \\hat{b}_{\\mathrm{NB}}(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})\n$$\n为使这些估计量具有物理意义（即为正数），我们需要校正因子 $(1 - \\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2})$ 为正。这意味着定义域条件为：\n$$\n\\hat{a}_{\\mathrm{NB}}\\mathrm{CV}_{A}^{2}  1\n$$\n用真实参数表示，此条件为 $\\frac{\\bar{a}\\mathrm{CV}_{A}^{2}}{1 + \\bar{a}\\mathrm{CV}_{A}^{2}}  1$，对于非负参数，该条件总是满足的，因为它简化为 $0  1$。因此，对于总体矩，校正是总有良好定义的。\n\n推导完成。该逻辑-数学过程揭示了外在变异性的精确量化影响，并建立了对其进行校正的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes naive and corrected estimates for bursty transcription parameters\n    across several test cases.\n    \"\"\"\n\n    # Test suite: each tuple contains (a_bar, b, CV_A^2)\n    test_cases = [\n        (5.0, 2.0, 0.3),   # Case A (happy path)\n        (10.0, 0.5, 0.0),  # Case B (no extrinsic variability)\n        (50.0, 1.0, 1.0),  # Case C (high extrinsic variability)\n        (0.8, 5.0, 0.5),   # Case D (low burst frequency, large burst size)\n        (3.2, 1.7, 0.25),  # Case E (moderate parameters)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a_bar, b, cv2_A = case\n\n        # Step 1: Compute observed moments using derived formulas from Task 1\n        # mu_obs = a_bar * b\n        # sigma2_obs = a_bar*b + a_bar*b^2 + (a_bar*b)^2 * CV_A^2\n        mu_obs = a_bar * b\n        sigma2_obs = a_bar * b * (1 + b) + (a_bar**2) * (b**2) * cv2_A\n\n        # Step 2: Compute naive NB moment estimates\n        # These will be biased if cv2_A > 0\n        \n        # The condition sigma2_obs > mu_obs must hold for b_nb_hat > 0.\n        # sigma2_obs - mu_obs = a_bar*b^2 + (a_bar*b)^2*cv2_A\n        # This is > 0 for a_bar > 0, b > 0.\n        if mu_obs == 0:\n            # Avoid division by zero, though not expected with given test cases.\n            if sigma2_obs == 0:\n                # If mean and variance are 0, this is a degenerate case.\n                b_nb_hat = 0\n            else:\n                # A positive variance with a zero mean is not possible for this model.\n                b_nb_hat = float('inf')\n        else:\n            b_nb_hat = (sigma2_obs / mu_obs) - 1\n\n        # The condition b_nb_hat > 0 must hold for a_nb_hat to be well-defined.\n        if b_nb_hat = 0:\n            # Handle cases that might arise with real, noisy data,\n            # though not with the perfect data from these test cases.\n            a_nb_hat = float('nan')\n        else:\n            a_nb_hat = mu_obs / b_nb_hat\n\n        # Step 3: Apply correction formulas from Task 2 to obtain corrected estimates\n        # Correction factor term\n        correction_factor = 1 - a_nb_hat * cv2_A\n\n        # Check domain condition for correction; correction_factor must be > 0.\n        # As derived, this holds for the true parameters. With sample estimates,\n        # it might be violated. For this problem, it is always satisfied.\n        \n        a_corr = a_nb_hat / correction_factor\n        b_corr = b_nb_hat * correction_factor\n\n        # Step 4: Collect and format the results\n        # Round all four numbers to six decimal places.\n        result_tuple = [\n            round(a_nb_hat, 6),\n            round(b_nb_hat, 6),\n            round(a_corr, 6),\n            round(b_corr, 6)\n        ]\n        results.append(result_tuple)\n\n    # Convert the list of lists to the required string format\n    # [[x1,y1,z1,w1],[x2,y2,z2,w2],...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in results]) + \"]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2774339"}]}