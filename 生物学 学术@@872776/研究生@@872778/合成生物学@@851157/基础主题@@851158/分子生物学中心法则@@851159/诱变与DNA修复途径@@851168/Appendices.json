{"hands_on_practices": [{"introduction": "这项练习将挑战您像遗传学家一样思考，通过解读经典的埃姆斯试验(Ames test)结果来进行推理。通过比较一种化合物在含有或缺失关键DNA修复基因（如 `recA`）的细菌株中的效应，您可以推断出该化合物潜在的诱变机制。这项练习旨在磨练您将特定基因功能与可观察表型联系起来的能力，这是分子遗传学的一项核心技能 [@problem_id:1525597]。", "problem": "一位研究人员正在使用埃姆斯试验（Ames test）来评估一种新型化学物质“化合物Z”（Compound Z）的致突变潜力。该试验使用了一种经过特殊改造的鼠伤寒沙门氏菌（*Salmonella typhimurium*）菌株，该菌株因*hisG*基因发生错义突变而对组氨酸呈营养缺陷型。恢复为组氨酸原养型（*his*⁺）被用作衡量致突变作用的指标。实验中使用了两种不同的测试菌株。\n\n- **菌株1：** 这是一种标准的埃姆斯测试菌株，由于*uvrB*基因的无效突变（*uvrB*⁻），其核苷酸切除修复（NER）途径存在缺陷。这种缺陷增加了其对某些类型诱变剂的敏感性。\n- **菌株2：** 该菌株与菌株1是同基因型的，但经过进一步改造，携带了*recA*基因的无效突变，使其相关基因型为*uvrB*⁻ *recA*⁻。\n\n实验包括将每种菌株的大量细胞接种在基本培养基上，该培养基仅含有痕量组氨酸（以允许最初的几次细胞分裂）和特定浓度的化合物Z。孵育后，对产生的*his*⁺回复突变菌落数量进行计数。\n\n结果如下：\n- 在含有菌株1的平板上，化合物Z诱导了非常多的*his*⁺回复突变菌落，显著高于自发回复突变率。\n- 在含有菌株2的平板上，化合物Z存在时*his*⁺回复突变菌落的数量与缺少该化合物的对照组平板上观察到的自发回复突变率没有区别。\n\n基于这些观察结果，以下哪个陈述为化合物Z的致突变作用提供了最准确和最完整的解释？\n\nA. 化合物Z是一种碱基类似物，在复制过程中被整合到细菌DNA中，直接导致*hisG*基因发生T:A到C:G的转换突变。\n\nB. 化合物Z是一种强效烷化剂，直接修饰鸟嘌呤碱基。这些被修饰的碱基在复制过程中通过与腺嘌呤错配而直接产生致突变作用，但这种效应因RecA蛋白的缺失而受到某种抑制。\n\nC. 化合物Z是一种嵌入剂，能引起移码突变，而UvrB蛋白是某个易错修复途径的一部分，该途径将这些损伤转化为回复突变。\n\nD. 化合物Z引起的DNA损伤本身不直接致突变，但会使DNA复制叉停滞。这种停滞会诱导一个RecA依赖的、易错的DNA修复系统（SOS反应），该系统负责引入导致回复突变的定点突变。\n\nE. 化合物Z是一种小分子，它特异性地激活UvrB蛋白的修复功能，导致其在DNA中引入错误。RecA蛋白是这种异常UvrB活性所需的辅助因子。", "solution": "步骤1：定义遗传背景和相关的DNA修复途径。\n- 菌株1由于*uvrB*基因的无效突变而缺乏核苷酸切除修复能力。因此，它无法通过NER途径去除庞大的、扭曲螺旋的DNA损伤。在埃姆斯菌株中，*uvrB*缺陷会增强对DNA损伤剂的敏感性，因为损伤会持续存在。\n- 菌株2与菌株1是同基因型的，但由于*recA*无效突变而额外缺少RecA。RecA对于同源重组修复和SOS反应的诱导至关重要，它通过促进LexA阻遏蛋白的自切割来诱导SOS反应。SOS反应会上调易错的跨损伤合成聚合酶（如UmuD'_{2}C, DinB），这些聚合酶在绕过停滞的复制叉时会引入突变。\n\n步骤2：根据遗传依赖性解释实验观察结果。\n- 观察：化合物Z在菌株1（*uvrB*⁻）中诱导了大量的*his*⁺回复突变体。这表明Z引起的DNA损伤要么在复制过程中直接产生突变，要么触发了一个致突变途径；在*uvrB*⁻菌株中的高信号表明，没有NER修复，损伤会持续存在，从而放大了致突变的结果。\n- 观察：在菌株2（*uvrB*⁻ *recA*⁻）中，化合物Z未能使回复突变体数量超过自发率。这证明RecA是Z产生致突变效应所必需的。因此，这种致突变作用不是正常复制过程中的直接错配或碱基类似物效应（这在很大程度上是RecA非依赖的），而是依赖于一个RecA介导的途径。\n\n步骤3：推断与RecA依赖性一致的致突变机理类别。\n- RecA依赖性强烈暗示了SOS反应的参与。许多使复制叉停滞的DNA损伤并不直接导致碱基改变，而是通过阻断复制进程，在单链DNA上触发RecA丝的形成，进而导致LexA的切割和SOS调控的易错聚合酶的诱导。这些跨损伤聚合酶引入的定点突变可以将*hisG*的错义突变回复为*his*⁺。缺少RecA会阻止SOS的诱导，从而阻止致突变的跨损伤合成，这就解释了为何菌株2中回复突变体数量没有增加。\n\n步骤4：根据机理推断评估每个选项。\n- 选项A（碱基类似物导致直接的T:A到C:G转换）：直接的碱基类似物致突变发生在复制期间，不需要RecA或SOS反应。因此，在*recA*⁻背景下致突变性应持续存在，这与数据相矛盾。\n- 选项B（烷化剂导致直接的O⁶-G与A错配）：直接错配是RecA非依赖的；*recA*⁻不应消除这种效应。这与观察结果相矛盾。\n- 选项C（嵌入剂引起移码突变，UvrB参与易错修复途径）：该菌株是*uvrB*⁻；援引UvrB依赖的易错处理与在菌株1中观察到的高致突变率不相容。此外，嵌入剂的致突变作用通常不需要RecA。\n- 选项D（损伤导致复制叉停滞，诱导RecA依赖的SOS反应，其易错修复导致回复突变）：这与两个观察结果都相符——在*uvrB*⁻菌株中，损伤持续存在导致高致突变率，并且致突变强烈依赖于RecA来诱导SOS。\n- 选项E（化合物Z激活UvrB引入错误，RecA作为辅助因子）：不相容，因为测试菌株是*uvrB*⁻；没有UvrB活性可以被激活。\n\n步骤5：结论。\n唯一与RecA依赖性以及在*uvrB*⁻背景下效应增强相一致的选项是：化合物Z引起复制停滞的损伤，诱导了RecA依赖的SOS反应，其易错的DNA合成产生了*his*⁺回复突变体。因此，选项D是正确的。", "answer": "$$\\boxed{D}$$", "id": "1525597"}, {"introduction": "这项练习超越了简单的突变计数，深入探讨了突变谱(mutational spectra)中蕴含的丰富信息。在暴露于紫外线等诱变剂后，不同的DNA修复和损伤容忍通路会在基因组上留下独特的“指纹”。通过分析这些谱系特征在不同修复缺陷型突变体中如何变化，您将能破译各通路之间的功能关系，例如判断它们是并行作用还是呈线性的上位(epistatic)关系 [@problem_id:2945691]。", "problem": "在研究脱氧核糖核酸（DNA）经紫外线（UV）照射后的损伤与修复时，有一组经典的观察结果是：UV会在二聚嘧啶位点诱导产生大体积损伤，主要是环丁烷嘧啶二聚体（CPDs）和嘧啶-(6-4)-嘧啶酮光产物。核苷酸切除修复（NER）通过损伤识别和双重切口来切除此类大体积损伤；光裂合酶的光复活作用利用可见光直接逆转CPDs；跨损伤合成（TLS）聚合酶以较高的错误率为代价绕过未修复的损伤；而错配修复（MMR）则纠正复制过程中产生的碱基-碱基错配，但不会移除大体积的光产物。一个普遍的预期是，跨越UV光产物的TLS会产生一个特征性的突变谱，其中富含在二聚嘧啶背景下的$C \\to T$取代和串联的$CC \\to TT$变化。\n\n研究人员对一种细菌在模拟处理后和单次UV脉冲处理后的突变积累系进行了测序，样本包括野生型和几种修复突变体。对于每个菌株，他们计算了在所有检出的突变中，发生在二聚嘧啶背景下的$C \\to T$碱基取代的比例，以及串联$CC \\to TT$双碱基取代的比例。他们还注意到每个谱系的总突变数是否发生了显著变化。关键的观察结果如下：\n\n- 模拟处理的野生型显示出基线突变谱，主要为$G:C \\to A:T$转换（约占取代的$60\\%$），在二聚嘧啶处的$C \\to T$很少见（$\\lt$ $5\\%$），串联$CC \\to TT$基本不存在（$\\approx$ $0\\%$）。\n- 在野生型中，经UV处理后，二聚嘧啶处的$C \\to T$比例上升至$\\approx$ $65\\%$，串联$CC \\to TT$比例为$\\approx$ $8\\%$。\n- 在光裂合酶缺失体（$\\Delta$phr；光裂合酶缺陷）中，经UV处理后，二聚嘧啶处的$C \\to T$进一步增加到$\\approx$ $78\\%$，串联$CC \\to TT$增加到$\\approx$ $15\\%$。\n- 在NER识别突变体（$\\Delta$uvrA；NER缺陷）中，经UV处理后，二聚嘧啶处的$C \\to T$增加到$\\approx$ $82\\%$，串联$CC \\to TT$增加到$\\approx$ $14\\%$。\n- 在TLS聚合酶V突变体（$\\Delta$umuC；TLS缺陷）中，经UV处理后，二聚嘧啶处的$C \\to T$下降到$\\approx$ $24\\%$，串联$CC \\to TT$下降到$\\approx$ $0\\%$；存活者显著减少（定性上，存活率降低），但存活下来的菌株其突变谱相对于野生型而言，UV特征突变减少。\n- 在MMR突变体（$\\Delta$mutS；MMR缺陷）中，经UV处理后，每个谱系的碱基取代总数大约增加了一倍（约$2$倍），但二聚嘧啶处的$C \\to T$比例（$\\approx$ $63\\%$）和串联$CC \\to TT$比例（$\\approx$ $7\\%$）与野生型相似。\n\n假设使用标准定义：此处的上位性指的是，在同一线性通路中的两个组分发生双突变时，其表现出的敏感性不高于最敏感的单突变体（即，一个突变对另一个突变具有上位性），而作用于平行或部分冗余通路中的组分，其双突变体通常比任一单突变体更敏感。\n\n哪个选项最好地整合了基于突变谱推断的作用通路与对双突变体UV敏感性的上位性预测？\n\nA. 移除UV光产物的主要保护性通路是核苷酸切除修复（NER），而$C \\to T$和$CC \\to TT$特征源于跨损伤合成（TLS）绕过未修复的损伤；因此，两个NER组分的双突变体（例如，$\\Delta$uvrA $\\Delta$uvrC）在UV敏感性上将表现出上位性（不比最敏感的单突变体更敏感），而$\\Delta$uvrA $\\Delta$umuC双突变体将比任一单突变体对UV更敏感。\n\nB. 错配修复（MMR）是影响UV诱导突变谱的主要通路，该突变谱主要反映了胞嘧啶脱氨；因此，$\\Delta$mutS $\\Delta$umuC双突变体在UV敏感性上将表现出上位性，而$\\Delta$uvrA $\\Delta$uvrC双突变体即使没有UV照射也将是合成致死的。\n\nC. 在这些条件下，光裂合酶的光复活作用是唯一相关的UV损伤修复方式；因此，$\\Delta$phr $\\Delta$uvrA双突变体在UV敏感性上将表现出上位性，并且TLS在UV照射后的诱变中没有可检测到的作用。\n\nD. 作用于CPDs的碱基切除修复（BER）是移除UV光产物的主要途径；因此，两个BER糖基化酶的双突变体（例如，$\\Delta$xthA $\\Delta$nei）在UV敏感性上具有上位性，且TLS的缺失（例如，$\\Delta$umuC）应增加而非减少存活者中串联$CC \\to TT$突变的比例。\n\n选择唯一的最佳选项。", "solution": "我们从基本原理和DNA修复生物学中已确立的观察结果出发：\n\n- 紫外线（UV）在二聚嘧啶位点诱导产生大体积损伤，特别是环丁烷嘧啶二聚体（CPDs）和嘧啶-(6-4)-嘧啶酮光产物。这些损伤会阻碍复制型聚合酶。\n- 核苷酸切除修复（NER）通过双重切口识别并切除大体积损伤，然后进行重新合成。NER的缺失导致光产物持续存在到S期。\n- 光裂合酶的光复活作用利用可见光直接逆转CPDs；光裂合酶的缺失会增加CPD的持续存在时间，但不影响非CPD损伤。\n- 跨损伤合成（TLS）聚合酶能够以较高的错误率为代价绕过未修复的损伤；跨越UV光产物的合成通常会产生一个特征性的突变谱，其中富含在二聚嘧啶背景下的$C \\to T$取代和串联的$CC \\to TT$变化。\n- 错配修复（MMR）纠正复制错误（错配和小的环），但不移除大体积的光产物；其缺失会增加复制错误的保留，而不改变潜在的损伤谱。\n- 线性通路中的上位性：同一通路中两个组分的双突变体，其敏感性不高于最敏感的单突变体（这些突变具有上位性）。对于平行或部分冗余的通路，双突变体通常比任一单突变体更敏感。\n\n对突变谱的解读：\n\n- 模拟处理的野生型显示出基线的$G:C \\to A:T$转换和可忽略的UV特征；这只是设定了基线。\n- 在野生型中，经UV处理后，二聚嘧啶处的$C \\to T$比例为$\\approx$ $65\\%$，串联$CC \\to TT$为$\\approx$ $8\\%$。这与TLS跨越UV光产物产生典型的UV特征是一致的。\n- 在$\\Delta$phr中，经UV处理后，二聚嘧啶处的$C \\to T$为$\\approx$ $78\\%$，而$CC \\to TT$为$\\approx$ $15\\%$，两者相对于野生型均有所增加。光裂合酶的缺失增加了CPD的持续存在；因此，更多的损伤持续到S期，必须由TLS绕过，从而增加了UV特征。这支持了光裂合酶作为一个与NER平行的保护性通路。\n- 在$\\Delta$uvrA中，经UV处理后，二聚嘧啶处的$C \\to T$为$\\approx$ $82\\%$，而$CC \\to TT$为$\\approx$ $14\\%$，代表了更强的UV特征。NER的缺失使得更多的光产物得以持续存在，再次增加了对TLS的依赖，从而增强了UV特征。这支持了NER是针对大体积UV损伤的主要保护性通路。\n- 在$\\Delta$umuC中，经UV处理后，二聚嘧啶处的$C \\to T$为$\\approx$ $24\\%$，而$CC \\to TT$为$\\approx$ $0\\%$，即存活者中的UV特征被耗尽。如果TLS聚合酶V（UmuC）是大多数UV诱导诱变的原因，这正是预期的结果；没有TLS，细胞更加敏感（存活者更少），而那些确实存活下来的细胞则避免了TLS介导的诱变，因此显示出减少的UV特征突变。\n- 在$\\Delta$mutS中，总突变数增加了约$2$倍，但在二聚嘧啶处的$C \\to T$比例（$\\approx$ $63\\%$）和$CC \\to TT$比例（$\\approx$ $7\\%$）与野生型保持相似。这表明MMR调节了复制错误的总体负担，但并未决定UV损伤谱，这与MMR不移除大体积UV损伤的观点一致。\n\n由此我们推断：\n\n- 针对UV光产物的主要保护性通路是NER（在有光裂合酶的情况下，其作为平行通路贡献力量）。\n- UV特征突变（二聚嘧啶处的$C \\to T$和$CC \\to TT$）源于TLS跨越未修复的光产物。\n- 上位性预测：\n  - 两个NER组分（如UvrA和UvrC）作用于同一线性NER通路；因此$\\Delta$uvrA $\\Delta$uvrC在UV敏感性上应表现出上位性（不比更敏感的单突变体更差，因为任一缺陷都会使NER失效）。\n  - NER和TLS平行作用（一个移除损伤，另一个耐受损伤）。因此，$\\Delta$uvrA $\\Delta$umuC双突变体应比任一单突变体对UV更敏感，因为NER的缺失留下了更多损伤，而TLS的缺失移除了绕行路线，两者结合降低了存活率。\n  - 对于CPDs，光裂合酶和NER也是平行或部分冗余的；因此$\\Delta$phr $\\Delta$uvrA双突变体应比任一单突变体对UV更敏感（不具上位性）。\n  - MMR和TLS在处理UV光产物方面不处于同一线性通路；它们的双突变体不应显示出可归因于单一移除UV损伤通路的经典上位性。\n\n逐项分析选项：\n\nA. 指出NER是主要的保护性通路，UV特征源于TLS。这与数据相符：NER或光裂合酶的缺失增加了UV特征；TLS的缺失减少了它。预测了$\\Delta$uvrA $\\Delta$uvrC的上位性（同一通路）和$\\Delta$uvrA $\\Delta$umuC比任一单突变体更高的敏感性（平行功能）。这两个预测都与基本原理和观察结果一致。结论——正确。\n\nB. 声称MMR是主导，且突变谱主要反映胞嘧啶脱氨。这与数据相矛盾：$\\Delta$mutS显示总突变数增加约$2$倍，但UV特征比例没有大的变化，且UV特征是TLS跨越光产物的典型表现，而非大量脱氨。预测了$\\Delta$mutS $\\Delta$umuC的上位性（不合理，通路不同）和$\\Delta$uvrA $\\Delta$uvrC在无UV时合成致死（无依据；NER的缺失在没有DNA损伤时不是致死的）。结论——不正确。\n\nC. 声称光裂合酶是唯一相关的通路，且TLS无作用。这与UV特征对TLS的强烈依赖性（$\\Delta$umuC使串联$CC \\to TT$突变减少到$\\approx$ $0\\%$）以及NER缺陷增加UV特征的观察结果相冲突。预测了$\\Delta$phr $\\Delta$uvrA的上位性，但光裂合酶和NER是平行作用的；双突变体通常比任一单突变体更敏感。结论——不正确。\n\nD. 声称碱基切除修复（BER）移除CPDs，这在机制上是错误的：BER靶向小的、非大体积的损伤，而不是像CPDs和(6-4)光产物这样的大体积UV光产物。还预测TLS的缺失会增加存活者中$CC \\to TT$的比例，这与在$\\Delta$umuC中观察到的耗尽至$\\approx$ $0\\%$相反。结论——不正确。\n\n因此，只有选项A连贯地整合了基于突变谱的推断和上位性预测。", "answer": "$$\\boxed{A}$$", "id": "2945691"}, {"introduction": "这项实践从定性推理过渡到定量的计算分析，这是现代合成生物学和基因组学的基石。您将解决“突变特征分解”问题，即将一个观察到的复杂突变模式建模为多个已知潜在突变过程的混合体。通过实现非负最小二乘法 (nonnegative least squares, NNLS) 算法，您将定量估计每个过程的贡献，这模拟了癌症基因组学和定向进化实验中的一项常见任务 [@problem_id:2753137]。", "problem": "在合成生物学中，样本的观测突变谱通常被建模为典型突变印记的非负线性组合，这些印记反映了潜在的诱变过程和DNA修复通路活性。在一种归一化方法下，每个谱表示为不同突变类别的相对频率，观测模型可写作 $v \\approx S x$。其中，$v \\in \\mathbb{R}_{\\ge 0}^{m}$ 是观测到的谱，$S \\in \\mathbb{R}_{\\ge 0}^{m \\times n}$ 是一个矩阵，其列为 $n$ 个已知的非负印记向量，$x \\in \\mathbb{R}_{\\ge 0}^{n}$ 是待估计的未知非负贡献。假设归一化后存在加性的、近似高斯的测量噪声，最大似然估计对应于求解非负最小二乘问题 $\\min_{x \\ge 0} \\| S x - v \\|_{2}$。\n\n您的任务是编写一个程序，为下述每个测试用例计算非负最小二乘估计 $\\hat{x} = \\arg\\min_{x \\ge 0} \\| S x - v \\|_{2}$。每个测试用例指定一个矩阵 $S$ 和一个向量 $v$。您的程序必须对每个用例进行数值求解 $\\min_{x \\ge 0} \\| S x - v \\|_{2}$ 并返回解向量。以下所有输入在维度上和生物学上都是合理的（非负的谱和印记）。无需报告物理单位；所有量均为无量纲，且不涉及角度。最终答案应四舍五入到 $6$ 位小数。\n\n您可以无需进一步证明即假设以下基本原理：突变谱的线性模型 $v \\approx S x$，$S$、$v$ 和 $x$ 具有非负性；高斯噪声与最小二乘法之间的联系；以及非负最小二乘问题的凸性。\n\n测试套件：\n- 用例 $1$（良态，精确重建）。$m = 6$，$n = 3$。\n  - $S_{1} = \\begin{bmatrix}\n  0.6  0.1  0.05 \\\\\n  0.1  0.6  0.1 \\\\\n  0.0  0.1  0.6 \\\\\n  0.2  0.0  0.1 \\\\\n  0.05  0.1  0.05 \\\\\n  0.05  0.1  0.1\n  \\end{bmatrix}$\n  - $v_{1} = \\begin{bmatrix} 0.28 \\\\ 0.24 \\\\ 0.15 \\\\ 0.10 \\\\ 0.06 \\\\ 0.07 \\end{bmatrix}$（构造为 $S_{1} \\cdot \\begin{bmatrix} 0.4 \\\\ 0.3 \\\\ 0.2 \\end{bmatrix}$）。\n- 用例 $2$（零谱边界）。$m = 6$，$n = 3$。\n  - $S_{2} = S_{1}$。\n  - $v_{2} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$。\n- 用例 $3$（秩亏印记，多最优解）。$m = 5$，$n = 3$。\n  - $S_{3} = \\begin{bmatrix}\n  0.4  0.4  0.0 \\\\\n  0.2  0.2  0.2 \\\\\n  0.1  0.1  0.4 \\\\\n  0.1  0.1  0.2 \\\\\n  0.2  0.2  0.2\n  \\end{bmatrix}$\n  - $v_{3} = \\begin{bmatrix} 0.2 \\\\ 0.2 \\\\ 0.25 \\\\ 0.15 \\\\ 0.2 \\end{bmatrix}$（构造为 $\\frac{1}{2} c_{1} + \\frac{1}{2} c_{3}$，其中 $c_{1}$ 和 $c_{2}$ 相同）。\n- 用例 $4$（对于锥外的目标欠完备，正解）。$m = 3$，$n = 2$。\n  - $S_{4} = \\begin{bmatrix}\n  1.0  0.2 \\\\\n  0.2  1.0 \\\\\n  0.2  0.2\n  \\end{bmatrix}$\n  - $v_{4} = \\begin{bmatrix} 0.2 \\\\ 0.2 \\\\ 1.0 \\end{bmatrix}$。\n- 用例 $5$（良态，不同的精确混合）。$m = 6$，$n = 3$。\n  - $S_{5} = S_{1}$。\n  - $v_{5} = \\begin{bmatrix} 0.2575 \\\\ 0.31 \\\\ 0.075 \\\\ 0.075 \\\\ 0.065 \\\\ 0.0675 \\end{bmatrix}$（构造为 $S_{1} \\cdot \\begin{bmatrix} 0.35 \\\\ 0.45 \\\\ 0.05 \\end{bmatrix}$）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身都是一个列表，包含了对应测试用例的估计贡献 $\\hat{x}$，顺序与上述用例相同，并四舍五入到 $6$ 位小数（例如，`[[\\dots],[\\dots],\\dots]`）。", "solution": "所提出的问题是数值优化中的一个经典问题，称为非负最小二乘（Nonnegative Least Squares, NNLS）。任务是确定贡献向量 $x$，该向量能最好地将观测到的突变谱 $v$ 解释为已知突变印记（即矩阵 $S$ 的列）的非负线性组合。\n\n该问题被正式表述为找到向量 $\\hat{x}$，以解决以下优化问题：\n$$\n\\hat{x} = \\arg\\min_{x \\ge 0} \\| S x - v \\|_{2}\n$$\n此处，$S \\in \\mathbb{R}_{\\ge 0}^{m \\times n}$ 是印记矩阵，$v \\in \\mathbb{R}_{\\ge 0}^{m}$ 是观测到的谱向量，$x \\in \\mathbb{R}_{\\ge 0}^{n}$ 是未知贡献向量。约束条件 $x \\ge 0$（元素级非负）至关重要，因为负贡献在生物学上没有意义。目标函数是残差向量 $S x - v$ 的欧几里得范数 $\\| \\cdot \\|_{2}$。最小化此范数等价于最小化其平方 $\\| S x - v \\|_{2}^{2}$，这是一种标准的最小二乘公式。\n\n这是一个凸优化问题。目标函数 $f(x) = \\| S x - v \\|_{2}^{2}$ 是关于 $x$ 的二次函数，因此是凸函数。由非负性约束 $\\{x \\in \\mathbb{R}^{n} \\mid x_i \\ge 0 \\text{ for } i=1, \\dots, n\\}$ 定义的可行集是一个凸集。在凸集上最小化凸函数可以保证任何局部最小值也是全局最小值。因此，全局最优解 $\\hat{x}$ 总是存在的。\n\n解的唯一性取决于矩阵 $S$ 的性质。如果 $S$ 的列是线性无关的（即 $S$ 是满列秩的），则NNLS问题的解是唯一的。如果列是线性相关的，如测试用例 $3$ 中明确指出的情况，可能存在无穷多个解可以达到相同的最小残差范数。在这种情况下，数值算法通常会从最优解集合中返回一个特定的解。\n\n解决NNLS问题的一个稳健且广泛使用的方法是由 Lawson 和 Hanson 开发的活性集方法。这种迭代算法确定解向量 $x$ 的哪些分量应为零（“活性集”），哪些应为正，并在每一步中为正分量解决一个无约束的最小二乘问题。该方法保证收敛到正确解。\n\n指定的执行环境允许使用 `scipy` 库。函数 `scipy.optimize.nnls` 提供了 Lawson-Hanson 算法的高效可靠实现。因此，策略将是利用此函数为所提供的 $5$ 个测试用例求解 $\\hat{x}$。\n\n对于每个测试用例 $(S_k, v_k)$，其中 $k \\in \\{1, 2, 3, 4, 5\\}$，步骤如下：\n$1$. 使用 `numpy` 数组定义矩阵 $S_k$ 和向量 $v_k$。\n$2$. 调用 `scipy.optimize.nnls(S_k, v_k)` 函数。该函数返回解向量 $\\hat{x}_k$ 和相应的残差范数。我们只需要解向量。\n$3$. 根据题目要求，将所得向量 $\\hat{x}_k$ 的每个元素四舍五入到 $6$ 位小数。\n$4$. 所有测试用例的最终结果将被收集到一个列表的列表中，并格式化为指定的字符串格式。\n\n对测试用例的简要分析证实了这种方法的适用性：\n- 用例 $1$ 和 $5$ 的构造使得 $v = S x_{true}$，其中 $x_{true}$ 是非负的。由于 $S_1$ 是良态的，唯一的 NNLS 解必须是 $\\hat{x} = x_{true}$。\n- 用例 $2$ 涉及一个零目标向量 $v_2 = 0$。目标是在 $x \\ge 0$ 的约束下最小化 $\\|S_2 x\\|_2$。由于 $S_2$ 的所有元素都是非负的，且其列向量非零，因此只有在 $x=0$ 时才能达到最小值 $0$。\n- 用例 $3$ 涉及一个秩亏矩阵 $S_3$，其中前两列相同。存在无穷多个最优解。`nnls` 求解器将确定性地找到其中一个解。所提供的 $v_3$ 是一个精确组合，因此解的残差范数将为零。\n- 用例 $4$ 是一个目标向量 $v_4$ 不在 $S_4$ 列向量的锥包中的例子。NNLS 解将是 $v_4$ 在此锥上的投影，导致非零的残差范数，且解向量 $\\hat{x}_4$ 将具有正分量。\n\n这种系统地应用标准数值方法是解决给定问题的可靠且正确的方法。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves a series of Nonnegative Least Squares (NNLS) problems\n    related to mutational signature analysis in synthetic biology.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = []\n\n    # Case 1: Well-conditioned, exact reconstruction\n    S1 = np.array([\n        [0.6, 0.1, 0.05],\n        [0.1, 0.6, 0.1],\n        [0.0, 0.1, 0.6],\n        [0.2, 0.0, 0.1],\n        [0.05, 0.1, 0.05],\n        [0.05, 0.1, 0.1]\n    ])\n    v1 = np.array([0.28, 0.24, 0.15, 0.10, 0.06, 0.07])\n    test_cases.append((S1, v1))\n\n    # Case 2: Zero spectrum boundary\n    S2 = S1\n    v2 = np.zeros(6)\n    test_cases.append((S2, v2))\n\n    # Case 3: Rank-deficient signatures, multiple optima\n    S3 = np.array([\n        [0.4, 0.4, 0.0],\n        [0.2, 0.2, 0.2],\n        [0.1, 0.1, 0.4],\n        [0.1, 0.1, 0.2],\n        [0.2, 0.2, 0.2]\n    ])\n    v3 = np.array([0.2, 0.2, 0.25, 0.15, 0.2])\n    test_cases.append((S3, v3))\n    \n    # Case 4: Undercomplete for a target outside the cone, positive solution\n    S4 = np.array([\n        [1.0, 0.2],\n        [0.2, 1.0],\n        [0.2, 0.2]\n    ])\n    v4 = np.array([0.2, 0.2, 1.0])\n    test_cases.append((S4, v4))\n    \n    # Case 5: Well-conditioned, different exact mixture\n    S5 = S1\n    v5 = np.array([0.2575, 0.31, 0.075, 0.075, 0.065, 0.0675])\n    test_cases.append((S5, v5))\n\n    results = []\n    for S, v in test_cases:\n        # Compute the nonnegative least squares solution\n        x, _ = nnls(S, v)\n        \n        # Round the solution vector to 6 decimal places\n        rounded_x = np.round(x, 6).tolist()\n        results.append(rounded_x)\n\n    # Format the final output string as a list of lists, without spaces.\n    # The repr() function provides a string representation of the list of lists.\n    # We remove spaces to create a compact and unambiguous format.\n    final_output = repr(results).replace(\" \", \"\")\n    \n    print(final_output)\n\nsolve()\n```", "id": "2753137"}]}