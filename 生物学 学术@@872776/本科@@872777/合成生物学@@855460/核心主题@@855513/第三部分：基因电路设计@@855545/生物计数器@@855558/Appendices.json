{"hands_on_practices": [{"introduction": "生物计数器的核心是状态转换，就像拨动一个开关。在深入研究复杂的多状态计数器之前，我们必须首先理解最基本单元——单个“比特翻转”——的动态行为。这个练习将带你通过一个简化的数学模型，探索从“0”状态（基因抑制）到“1”状态（基因表达）的转换过程，并计算达到稳态一半所需的时间[@problem_id:2022490]。通过解决这个问题，你将掌握分析基因表达动力学的基础，这对于设计和预测任何合成生物电路的响应时间都至关重要。", "problem": "一位合成生物学家正在构建一个基因拨动开关，这是在细胞中创建生物计数器的一个基本元件。该计数器中一位的状态由报告蛋白的浓度表示。当位为'0'时，编码该蛋白的基因被完全抑制。当位翻转为'1'时，这种抑制被解除，基因开始表达。\n\n考虑该“翻转”过程的一个简化模型。在时间 $t=0$ 时，系统处于'0'状态，因此报告蛋白的信使RNA（mRNA）和报告蛋白本身的浓度都为零。在 $t = 0$ 时，引入一个诱导物分子，它瞬间且完全地解除了抑制。该基因开始被转录并随后被翻译。\n\n对于 $t \\ge 0$，系统的动力学可以由以下过程建模：\n1.  mRNA的浓度 $M(t)$ 以恒定速率 $\\alpha_M$ 产生，并以一级速率常数 $\\delta_M$ 降解。\n2.  报告蛋白的浓度 $P(t)$ 由mRNA翻译而来，其速率与 $M(t)$ 成正比，速率常数为 $\\alpha_P$，并以一级速率常数 $\\delta_P$ 降解。\n\n为简化分析，假设mRNA和蛋白质的降解速率常数相等：$\\delta_M = \\delta_P = \\delta$。\n\n当蛋白质浓度 $P(t)$ 达到其最终长期稳态值的一半时，该位被认为已成功从'0'翻转到'1'。请确定此次翻转发生所需的时间 $T$ 的解析表达式，并用给定的参数表示。", "solution": "问题要求解出蛋白质浓度 $P(t)$ 达到其稳态值一半时的时间 $T$。我们首先需要通过求解描述该模型的微分方程组来找到 $P(t)$ 的表达式。\n\n该微分方程组由以下公式给出：\n1.  mRNA动力学：$\\frac{dM}{dt} = \\alpha_M - \\delta M$\n2.  蛋白质动力学：$\\frac{dP}{dt} = \\alpha_P M - \\delta P$\n\n初始条件为 $M(0) = 0$ 和 $P(0) = 0$。\n\n首先，我们求解mRNA浓度 $M(t)$ 的微分方程。这是一个一阶线性常微分方程。\n$$ \\frac{dM}{dt} + \\delta M = \\alpha_M $$\n可以使用积分因子 $e^{\\int \\delta dt} = e^{\\delta t}$ 来找到解。\n$$ \\frac{d}{dt}(M e^{\\delta t}) = \\alpha_M e^{\\delta t} $$\n对 $t$ 积分：\n$$ M(t) e^{\\delta t} = \\int \\alpha_M e^{\\delta t} dt = \\frac{\\alpha_M}{\\delta} e^{\\delta t} + C_1 $$\n其中 $C_1$ 是积分常数。\n求解 $M(t)$：\n$$ M(t) = \\frac{\\alpha_M}{\\delta} + C_1 e^{-\\delta t} $$\n使用初始条件 $M(0) = 0$：\n$$ 0 = \\frac{\\alpha_M}{\\delta} + C_1 e^0 \\implies C_1 = -\\frac{\\alpha_M}{\\delta} $$\n所以，mRNA浓度作为时间的函数是：\n$$ M(t) = \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\n\n接下来，我们通过代入 $M(t)$ 的表达式来求解蛋白质浓度 $P(t)$ 的微分方程：\n$$ \\frac{dP}{dt} + \\delta P = \\alpha_P M(t) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) $$\n这又是另一个一阶线性常微分方程。积分因子同样是 $e^{\\delta t}$。\n$$ \\frac{d}{dt}(P e^{\\delta t}) = \\alpha_P \\frac{\\alpha_M}{\\delta} (1 - e^{-\\delta t}) e^{\\delta t} = \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) $$\n对 $t$ 积分：\n$$ P(t) e^{\\delta t} = \\int \\frac{\\alpha_P \\alpha_M}{\\delta} (e^{\\delta t} - 1) dt = \\frac{\\alpha_P \\alpha_M}{\\delta} \\left(\\frac{1}{\\delta}e^{\\delta t} - t\\right) + C_2 $$\n其中 $C_2$ 是积分常数。\n求解 $P(t)$：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} + C_2 e^{-\\delta t} $$\n使用初始条件 $P(0)=0$：\n$$ 0 = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - 0 + C_2 e^0 \\implies C_2 = -\\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n将 $C_2$ 代回 $P(t)$ 的表达式中：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} - \\frac{\\alpha_P \\alpha_M}{\\delta} t e^{-\\delta t} - \\frac{\\alpha_P \\alpha_M}{\\delta^2} e^{-\\delta t} $$\n提出常数项，得到 $P(t)$ 的最终表达式：\n$$ P(t) = \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\n\n现在，我们必须找到稳态蛋白质浓度 $P_{ss}$。这是 $P(t)$ 在 $t \\to \\infty$ 时的极限。\n$$ P_{ss} = \\lim_{t \\to \\infty} P(t) = \\lim_{t \\to \\infty} \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta t} - \\delta t e^{-\\delta t} \\right) $$\n由于 $\\delta > 0$，当 $t \\to \\infty$ 时，$e^{-\\delta t}$ 和 $t e^{-\\delta t}$ 都趋近于0。\n$$ P_{ss} = \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n\n问题将翻转时间 $T$ 定义为 $P(T) = \\frac{1}{2} P_{ss}$ 的时间。\n$$ \\frac{\\alpha_P \\alpha_M}{\\delta^2} \\left( 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} \\right) = \\frac{1}{2} \\frac{\\alpha_P \\alpha_M}{\\delta^2} $$\n项 $\\frac{\\alpha_P \\alpha_M}{\\delta^2}$ 从两边消去：\n$$ 1 - e^{-\\delta T} - \\delta T e^{-\\delta T} = \\frac{1}{2} $$\n$$ \\frac{1}{2} = e^{-\\delta T} (1 + \\delta T) $$\n这是一个关于 $T$ 的超越方程。令 $x = \\delta T$。方程变为：\n$$ (1+x)e^{-x} = \\frac{1}{2} \\implies 1+x = \\frac{1}{2} e^x $$\n为了求解 $x$，我们使用朗伯W函数（Lambert W function），它被定义为方程 $W(z)e^{W(z)} = z$ 的解。我们需要将我们的方程变换成这种形式。\n$$ -(1+x) = -\\frac{1}{2}e^x $$\n乘以 $e^{-1}$：\n$$ -(1+x)e^{-1} = -\\frac{1}{2}e^{x-1} $$\n令 $y = -(1+x)$。则 $x = -1-y$。代入可得：\n$$ y e^{-1} = -\\frac{1}{2}e^{(-1-y)-1} = -\\frac{1}{2}e^{-y-2} $$\n$$ y e^{y} = -\\frac{e^{-1}}{2} $$\n所以我们得到 $y e^y = z$ 的形式，其中 $z = -\\frac{1}{2e}$。\n这意味着 $y = W(-\\frac{1}{2e})$，其中 $W$ 是朗伯W函数。\n对于自变量 $z \\in [-1/e, 0)$，朗伯W函数有两个实数分支：主分支 $W_0(z)$（值域为 $[-1, \\infty)$）和下分支 $W_{-1}(z)$（值域为 $(-\\infty, -1]$）。\n我们的自变量是 $z = -1/(2e) \\approx -0.184$，它位于这个区间内。\n由于 $x = \\delta T > 0$，我们有 $y = -(1+x)  -1$。因此，我们必须选择 $W_{-1}$ 分支，因为其值域是 $(-\\infty, -1]$。\n所以，$y = W_{-1}(-\\frac{1}{2e})$。\n现在我们求解 $T$：\n$$ x = -1-y = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ \\delta T = -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) $$\n$$ T = \\frac{1}{\\delta} \\left[ -1 - W_{-1}\\left(-\\frac{1}{2e}\\right) \\right] $$\n这就是翻转时间 $T$ 的最终解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\delta}\\left(-1 - W_{-1}\\left(-\\frac{1}{2e}\\right)\\right)}$$", "id": "2022490"}, {"introduction": "掌握了单个开关的动态特性后，下一步就是将这些基本元件组装成一个功能完整的电路。与电子计数器一样，生物计数器的构建也依赖于严谨的逻辑设计。这个问题挑战你扮演一名电路设计师，为一个三态循环计数器（红→绿→蓝→红）设计关键的逻辑门[@problem_id:2022425]。你需要确定如何利用转录因子和启动子，来精确控制状态的有序转换，从而实现一个由外部脉冲驱动的“分子时钟”。", "problem": "一个合成生物学团队正在一种细菌菌株中设计一个生物计数器。其目标是创建一个电路，使细胞群体能够循环经历三种不同的荧光状态：红色，然后绿色，然后蓝色，再回到红色。每个状态转换都应由外部离散的阿拉伯糖（Ara）脉冲触发。\n\n该电路由三个基因组成：`gR`、`gG` 和 `gB`，它们分别编码红色荧光蛋白（RFP）、绿色荧光蛋白（GFP）和蓝色荧光蛋白（BFP）。在一个巧妙的设计转折中，这些荧光蛋白也被改造为可以作为转录因子发挥作用。阿拉伯糖脉冲由蛋白质 AraC 检测；当阿拉伯糖存在时，会形成复合物 `AraC-Ara`，该复合物作为所有状态推进转录事件的通用共激活剂。电路的设计使得蛋白质降解足够迅速，确保在下一次脉冲到来时，只有当前状态的蛋白质以显著量存在。\n\n该计数器的操作逻辑基于一系列转录`与`门，其中状态转换需要当前状态的蛋白质和 `AraC-Ara` 脉冲信号同时存在。该团队已经成功实现了电路的一部分：\n- **转换 R → G：** `gG` 的启动子（`pG`）仅在 RFP 和 `AraC-Ara` 复合物同时存在时才被激活。\n- **转换 B → R：** `gR` 的启动子（`pR`）仅在 BFP 和 `AraC-Ara` 复合物同时存在时才被激活。\n- **自我抑制：** 为确保干净利落的切换，当转换被触发时，当前状态基因的启动子会被抑制。例如，在 R → G 转换期间，启动子 `pR` 被 RFP 和 `AraC-Ara` 的组合所抑制。\n\n最后一步是为基因 `gB` 设计启动子，记为 `pB`，以处理从绿色状态到蓝色状态的转换。以下哪种针对启动子 `pB` 的调控逻辑方案将正确完成 R → G → B → R 的循环？\n\nA. `pB` 仅由 GFP 激活。\nB. `pB` 仅由 `AraC-Ara` 复合物激活。\nC. `pB` 仅在 GFP 和 `AraC-Ara` 复合物同时存在时才被激活。\nD. `pB` 在 GFP 和 `AraC-Ara` 复合物同时存在时被抑制。\nE. `pB` 仅在 RFP 和 `AraC-Ara` 复合物同时存在时才被激活。", "solution": "为蛋白质的存在定义布尔状态变量：设 $R=1$ 表示 RFP 存在，$G=1$ 表示 GFP 存在，$B=1$ 表示 BFP 存在，其中 $R,G,B \\in \\{0,1\\}$。设 $A \\in \\{0,1\\}$ 表示 $AraC\\text{-}Ara$ 脉冲的存在（$A=1$）或不存在（$A=0$）。设 $P_{R},P_{G},P_{B} \\in \\{0,1\\}$ 分别表示启动子 $pR,pG,pB$ 的激活。\n\n指定的设计原则是，每个正向转换都由一个转录与门控制，该与门需要当前状态的蛋白质和脉冲 $A$ 同时存在。形式上，对于期望的循环 $R \\rightarrow G \\rightarrow B \\rightarrow R$，正确的逻辑是：\n$$\nP_{G} = R \\land A, \\quad P_{B} = G \\land A, \\quad P_{R} = B \\land A.\n$$\n已经实现的陈述符合此规则：\n- $R \\rightarrow G$：给定 $P_{G} = R \\land A$。\n- $B \\rightarrow R$：给定 $P_{R} = B \\land A$。\n- 自我抑制：在从一个状态转换出去的过程中，当前状态的启动子被相同的 $(\\text{当前蛋白质}) \\land A$ 联合体所抑制，以确保干净的切换；例如，在 $R \\rightarrow G$ 期间， $pR$ 被 $R \\land A$ 抑制。\n\n鉴于降解足够迅速，在每次脉冲时，只有当前状态的蛋白质以高水平存在。因此，在一次脉冲（$A=1$）时，只有下一状态的启动子应该被激活，并且只能通过与当前状态蛋白质的联合作用来激活。对于从绿色到蓝色的转换，这需要：\n$$\nP_{B} = G \\land A.\n$$\n\n根据这个要求评估每个选项：\n- 选项 A：$P_{B} = G$。这将在即使 $A=0$ 时也激活 $pB$，导致没有脉冲的自发 $G \\rightarrow B$ 转换，违反了通过脉冲计数的要求。\n- 选项 B：$P_{B} = A$。这将在任何脉冲时激活 $pB$，而不管状态如何（例如，从 $R$ 或 $B$），从而破坏循环顺序。\n- 选项 C：$P_{B} = G \\land A$。这精确地实现了 $G \\rightarrow B$ 所需的与门，并保持了预期的 $R \\rightarrow G \\rightarrow B \\rightarrow R$ 序列。\n- 选项 D：$P_{B} = \\lnot(G \\land A)$。这恰恰在应该发生转换时抑制 $pB$，从而阻止了 $G \\rightarrow B$。\n- 选项 E：$P_{B} = R \\land A$。这会在 $R$ 脉冲期间不适当地激活 $pB$，有导致同时或不正确转换的风险，并打破了严格的序列。\n\n因此，`pB` 的正确调控逻辑是仅在 GFP 和 `AraC-Ara` 同时存在时激活，即选项 C。", "answer": "$$\\boxed{C}$$", "id": "2022425"}, {"introduction": "除了基于转录调控的动态计数器，合成生物学还开辟了利用DNA本身作为信息存储介质的全新途径。这个练习介绍了一种基于DNA重组酶的先进计数器设计，其精巧的“俄罗斯套娃”式嵌套结构能够记录事件序列。你的任务是分析这个系统的状态空间，并计算它在状态重复之前最多能记录多少个独立事件[@problem_id:2022417]。解决这个问题需要将具体的生物学设计抽象为数学模型，从而让你领会如何评估复杂生物计数器的信息存储容量。", "problem": "一位合成生物学家正在设计一个使用DNA作为存储介质的生物事件计数器。该系统由四个不同的、可翻转的DNA片段组成，从最内层到最外层依次标记为1到4。每个片段的方向可以被一种特定的重组酶翻转。现有两种类型的重组酶可用：Cre，它专门作用于`loxP`位点；Flp，它作用于`FRT`位点。两侧被`loxP`位点包围的片段称为“Cre单元”，而被`FRT`位点包围的片段称为“Flp单元”。\n\n这些片段以嵌套的“俄罗斯套娃”结构排列：片段2包含片段1，片段3包含片段2，片段4包含片段3。计数器的状态由四个片段相对于主染色体（外部参考系）的方向向量定义。例如，一个状态可以是（正向、反向、正向、正向）。已经确定，当一个片段被其对应的重组酶翻转时，所有嵌套在其内部的片段也相对于外部参考系被翻转。一个给定重组酶（例如Cre）的脉冲会同时翻转作为该重组酶目标的所有片段（例如所有Cre单元）。\n\n在这个具体设计中，最内层的片段（1）和最外层的片段（4）被指定为Cre单元。两个中间的片段（2和3）被指定为Flp单元。计数器从一个所有四个片段都处于正向方向的初始状态开始。一个“事件”包括施加一个Cre或Flp重组酶的脉冲。\n\n在任何状态（包括初始状态）被重复之前，这个计数器可以记录的唯一的、连续的事件的最大数量 $N$ 是多少？", "solution": "设每个片段的方向由 $x_{i} \\in \\{0,1\\}$ 编码，其中 $i \\in \\{1,2,3,4\\}$，$x_{i}=0$ 表示相对于外部参考系为正向，$x_{i}=1$ 表示反向。初始状态为 $x^{(0)}=(0,0,0,0)$。\n\n一个给定重组酶的脉冲会翻转目标片段，并且根据嵌套结构，也会翻转任何目标片段内部包含的所有片段。因此，对于一个作用于集合 $T \\subset \\{1,2,3,4\\}$ 的脉冲，其对 $x_i$ 的净效应是加上（模2）片段 $i$ 的目标祖先数量的奇偶性，即：\n$$\nx_{i} \\mapsto x_{i} + m_{i}(T) \\quad \\text{with} \\quad m_{i}(T) = \\left(\\sum_{j \\in T,\\, j \\ge i} 1\\right) \\bmod 2.\n$$\n因此，一个脉冲是在 $\\mathbb{Z}_{2}^{4}$ 中的一个平移 $x \\mapsto x + m(T)$，其中 $m(T)=(m_{1}(T),m_{2}(T),m_{3}(T),m_{4}(T))$。\n\n在此设计中，Cre作用于 $T_{C}=\\{1,4\\}$，Flp作用于 $T_{F}=\\{2,3\\}$。计算掩码：\n\n- 对于Cre，$T_{C}=\\{1,4\\}$：\n  - $m_{1}(T_{C}) = (1+1) \\bmod 2 = 0$，\n  - $m_{2}(T_{C}) = 1 \\bmod 2 = 1$ (只计算片段4)，\n  - $m_{3}(T_{C}) = 1 \\bmod 2 = 1$，\n  - $m_{4}(T_{C}) = 1 \\bmod 2 = 1$。\n  因此，\n  $$\n  m^{C}=(0,1,1,1),\n  $$\n  即，一个Cre脉冲将状态向量 $(x_1, x_2, x_3, x_4)$ 映射到 $(x_1, x_2+1, x_3+1, x_4+1)$（模2加法）。\n\n- 对于Flp，$T_{F}=\\{2,3\\}$：\n  - $m_{1}(T_{F}) = (1+1) \\bmod 2 = 0$，\n  - $m_{2}(T_{F}) = (1+1) \\bmod 2 = 0$，\n  - $m_{3}(T_{F}) = 1 \\bmod 2 = 1$，\n  - $m_{4}(T_{F}) = 0$。\n  因此，\n  $$\n  m^{F}=(0,0,1,0),\n  $$\n  即，一个Flp脉冲将状态向量 $(x_1, x_2, x_3, x_4)$ 映射到 $(x_1, x_2, x_3+1, x_4)$（模2加法）。\n\n因此，从 $x^{(0)}=(0,0,0,0)$ 开始，可达状态的集合是仿射集\n$$\n\\{x^{(0)} + a m^{C} + b m^{F} \\mid a,b \\in \\{0,1\\}\\},\n$$\n因为每个脉冲在 $\\mathbb{Z}_{2}^{4}$ 中加上 $m^{C}$ 或 $m^{F}$，并且这些运算是可交换的。因为 $m^{C}$ 和 $m^{F}$ 在 $\\mathbb{Z}_{2}$ 上是线性无关的，所以恰好有 $2^{2}=4$ 个不同的可达状态。因此，最多可以访问4个唯一的状态（包括初始状态）。\n\n一个事件是一个脉冲；为避免任何状态重复（包括初始状态），最多可以通过3个事件访问所有4个不同的状态。例如，应用序列 Flp、Cre、Flp 可以获得四个不同的状态；任何第四个事件都将重复一个先前访问过的状态。因此，在任何状态重复之前记录的唯一的、连续的事件的最大数量是\n$$\nN=4-1=3.\n$$", "answer": "$$\\boxed{3}$$", "id": "2022417"}]}