{"hands_on_practices": [{"introduction": "前馈环路的一个最常见的应用是，对一个持续的输入信号产生一个短暂的脉冲响应。这个练习将带你分析一个典型的1型非相干前馈环路（I1-FFL）的动力学，它被设计用来在细菌中产生一个蛋白质脉冲。通过推导输出蛋白浓度达到峰值所需的时间，你将掌握决定脉冲宽度的核心机制，这是设计这类信号处理电路的基础。[@problem_id:2037511]", "problem": "一位合成生物学家正在设计一个细菌回路，该回路旨在响应持续的环境信号，产生一个输出蛋白 Z 的瞬时脉冲。这是通过使用一个非相干1型前馈环（I1-FFL）来实现的。\n\n该回路的运行方式如下：在时间 $t=0$ 时，持续供给一种诱导物分子，同时启动两个过程。\n1. 抑制蛋白 Y 的生产以恒定速率 $\\beta_Y$ 开始。\n2. 输出蛋白 Z 的生产以恒定速率 $\\beta_Z$ 开始。\n\n两种蛋白 Y 和 Z 都通过一级过程降解，其特征是具有相同的降解速率常数 $\\gamma$。在 $t=0$ 时，Y 和 Z 的浓度均为零。\n\n回路中的“前馈”相互作用规定，一旦抑制蛋白 Y 的浓度达到一个特定的阈值 $K_Y$，蛋白 Z 的生产就会立即完全停止。为了使该回路按预期工作，所选择的参数满足 $K_Y  \\beta_Y / \\gamma$。\n\n找出输出蛋白 Z 的浓度达到其最大值时的时间 $t_{peak}$ 的解析表达式。你的答案应该用给定的参数 $\\beta_Y$、$\\gamma$ 和 $K_Y$ 来表示。", "solution": "令 $Y(t)$ 和 $Z(t)$ 表示蛋白 Y 和 Z 的浓度。在任何停止发生之前，它们的动力学由一级生产和降解控制：\n$$\n\\frac{dY}{dt}=\\beta_{Y}-\\gamma Y,\\quad Y(0)=0,\n$$\n$$\n\\frac{dZ}{dt}=\\beta_{Z}-\\gamma Z,\\quad Z(0)=0.\n$$\n求解 $Y(t)$ 的线性常微分方程得到\n$$\nY(t)=\\frac{\\beta_{Y}}{\\gamma}\\left(1-\\exp(-\\gamma t)\\right).\n$$\n定义 $t_{\\text{off}}$ 为 $Y(t)$ 首次达到阈值 $K_{Y}$ 的时间：\n$$\nY(t_{\\text{off}})=K_{Y}\\quad\\Longrightarrow\\quad \\frac{\\beta_{Y}}{\\gamma}\\left(1-\\exp(-\\gamma t_{\\text{off}})\\right)=K_{Y}.\n$$\n求解 $t_{\\text{off}}$ 得\n$$\n\\exp(-\\gamma t_{\\text{off}})=1-\\frac{\\gamma K_{Y}}{\\beta_{Y}},\\quad t_{\\text{off}}=-\\frac{1}{\\gamma}\\ln\\left(1-\\frac{\\gamma K_{Y}}{\\beta_{Y}}\\right)=\\frac{1}{\\gamma}\\ln\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right).\n$$\n假设 $K_Y  \\beta_Y / \\gamma$ 保证了 $0  1 - \\gamma K_Y / \\beta_Y  1$，因此 $t_{\\text{off}}$ 是有限的正数。\n\n对于 $t  t_{\\text{off}}$，只要 $Z(t)  \\beta_Z / \\gamma$，$dZ/dt = \\beta_Z - \\gamma Z(t) > 0$，所以 $Z(t)$ 是增加的。在 $t = t_{\\text{off}}$，$Z$ 的生产停止，动力学方程变为 $dZ/dt = -\\gamma Z(t)$。由于 $Z(t_{\\text{off}}) > 0$，因此对于 $t \\geq t_{\\text{off}}$，$dZ/dt  0$。因此，$Z(t)$ 的浓度在 $t=t_{\\text{off}}$ 时达到其峰值。所以 $t_{\\text{peak}} = t_{\\text{off}}$。\n\n因此，Z 达到其峰值浓度的时间为：\n$$\nt_{\\text{peak}} = \\frac{1}{\\gamma}\\ln\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right)\n$$", "answer": "$$\\boxed{\\frac{1}{\\gamma}\\ln\\left(\\frac{\\beta_{Y}}{\\beta_{Y}-\\gamma K_{Y}}\\right)}$$", "id": "2037511"}, {"introduction": "与脉冲发生器相辅相成，前馈环路还可以用作信号过滤器，以滤除短暂的噪声，仅对持久的刺激做出响应。本练习将探讨1型相干前馈环路（C1-FFL）如何实现这一“持久性检测”功能。通过分析一个关键生化参数——转录因子与其启动子结合亲和力——的变化如何影响电路的时间滤波特性，你将深入理解参数调控在合成回路设计中的重要性。[@problem_id:2037464]", "problem": "一位合成生物学家在一种细菌中设计了一个基因线路，用作持久性检测器。该线路是一个1型相干前馈环 (C1-FFL)。其结构如下：一个外部化学信号 $S$ 诱导基因X的表达，从而产生蛋白质X。蛋白质X作为一个转录因子，接着激活基因Y的表达，从而产生蛋白质Y。最终输出基因Z（产生荧光蛋白Z）的表达，需要蛋白质X和蛋白质Y同时作为共激活子存在于基因Z的启动子上。\n\n这个线路可以滤除瞬时或短暂的信号。只有当信号 $S$ 的持续时间超过一个特定的最短时间（我们定义为 $T_{min}$）时，才能观察到输出（来自蛋白质Z的荧光）。这种延迟主要是由于蛋白质Y合成并积累到所需浓度所花费的时间。\n\n为使系统正常工作，蛋白质的浓度必须超过一定的激活阈值。蛋白质X对基因Y启动子的激活要求X的浓度 $[X]$ 高于一个阈值 $K_X$。要激活基因Z的启动子，$[X]$ 必须高于 $K_X$ 并且Y的浓度 $[Y]$ 必须高于一个阈值 $K_Y$。阈值常数 $K_Y$ 的值与蛋白质Y对基因Z启动子的结合亲和力成反比；较弱的结合亲和力对应于较高的 $K_Y$ 值。\n\n在基因Z的启动子DNA序列中引入了一个突变。这个突变专门降低了蛋白质Y与该启动子的结合亲和力，但对蛋白质X的结合或线路的其他方面（如蛋白质的产生和降解速率）没有影响。这个修改如何影响产生基因Z输出所需的最小信号持续时间 $T_{min}$？\n\nA. $T_{min}$ 将会增加。\n\nB. $T_{min}$ 将会减少。\n\nC. $T_{min}$ 将保持不变。\n\nD. 在不知道蛋白质Z降解速率的情况下，无法确定对 $T_{min}$ 的影响。\n\nE. 对 $T_{min}$ 的影响取决于蛋白质X对基因Z启动子的结合亲和力。", "solution": "带有AND逻辑门的C1-FFL在基因Z的启动子处要求 $[X] \\geq K_{X}$ 和 $[Y] \\geq K_{Y}$ 才能激活基因Z。在 $t=0$ 时，对于信号 $S$ 的阶跃输入，蛋白质X被诱导，并在 $[X] \\geq K_{X}$ 时激活基因Y。用 $t_{X}$ 表示 $[X]$ 首次超过 $K_{X}$ 的时间。在 $t \\geq t_{X}$ 之后，Y的产生以其激活速率进行，而其降解速率保持不变。\n\n假设在X的持续激活下，Y遵循标准的线性产生-降解动力学：\n$$\n\\frac{d[Y]}{dt}=\\alpha_{Y}-\\delta_{Y}[Y], \\quad t \\geq t_{X},\n$$\n其解为 $[Y](t)$（在最小延迟情景下，从 $[Y](t_{X})=0$ 开始）：\n$$\n[Y](t)=\\frac{\\alpha_{Y}}{\\delta_{Y}}\\left(1-\\exp\\left(-\\delta_{Y}(t-t_{X})\\right)\\right).\n$$\n定义稳态水平为 $Y_{\\mathrm{ss}}=\\alpha_{Y}/\\delta_{Y}$。基因Z在 $[X]\\geq K_{X}$ 和 $[Y]\\geq K_{Y}$ 两个条件都满足的最早时间 $T_{\\min}$ 开启。根据定义，对于 $t\\geq t_{X}$ 有 $[X]\\geq K_{X}$，因此在 $t_{X}$ 之后 $[Y]$ 达到 $K_{Y}$ 所需的最小额外时间可通过求解以下方程得到：\n$$\n[Y](T_{\\min})=K_{Y}\\quad \\Rightarrow \\quad \\frac{\\alpha_{Y}}{\\delta_{Y}}\\left(1-\\exp\\left(-\\delta_{Y}(T_{\\min}-t_{X})\\right)\\right)=K_{Y}.\n$$\n求解 $T_{\\min}$ 可得：\n$$\nT_{\\min}=t_{X}+\\frac{1}{\\delta_{Y}}\\ln\\left(\\frac{Y_{\\mathrm{ss}}}{Y_{\\mathrm{ss}}-K_{Y}}\\right)\n=t_{X}+\\frac{1}{\\delta_{Y}}\\ln\\left(\\frac{\\alpha_{Y}}{\\alpha_{Y}-\\delta_{Y}K_{Y}}\\right),\n$$\n当 $K_Y  Y_{\\mathrm{ss}}$ 时，该表达式有意义。\n\n根据问题描述，突变降低了蛋白质Y与基因Z启动子的结合亲和力。这意味着需要更高浓度的Y才能激活基因Z。因此，激活阈值 $K_Y$ 增加了。\n\n现在我们来分析 $T_{\\min}$ 对 $K_Y$ 的依赖关系。$T_{\\min}$ 的表达式包含 $\\ln(Y_{\\mathrm{ss}}/(Y_{\\mathrm{ss}}-K_Y))$ 这一项。当 $K_Y$ 增加时，分母 $(Y_{\\mathrm{ss}}-K_Y)$ 减小。这使得比率 $Y_{\\mathrm{ss}}/(Y_{\\mathrm{ss}}-K_Y)$ 增加。由于对数函数是单调递增的，所以 $\\ln(Y_{\\mathrm{ss}}/(Y_{\\mathrm{ss}}-K_Y))$ 增加。\n\n因此，增加 $K_Y$ 会导致 $T_{\\min}$ 增加。这意味着需要更长的信号持续时间才能让蛋白质Y的浓度积累到新的、更高的阈值。因此，正确的答案是A。", "answer": "$$\\boxed{A}$$", "id": "2037464"}, {"introduction": "将电路动力学分析与生物进化背景相结合，是合成生物学的一个前沿方向。这个高级练习将我们带回到I1-FFL脉冲发生器，但这次是从细胞适应性的角度来审视它，将其视为一个涉及权衡（如代谢成本与产物毒性）的生物学问题的解决方案。通过优化电路参数以最大化细胞的适应性，我们将探索自然选择如何塑造这些网络基序，并学习如何在设计中量化和平衡不同的生物学成本。[@problem_id:2037473]", "problem": "一个合成生物回路被设计用于保护细胞免受突发的环境胁迫。该回路采用一个1型非相干前馈环（FFL）来产生一种保护性但有毒性的蛋白质 $Z$ 的瞬时脉冲。其工作机制如下：在时间 $t=0$ 时出现一个恒定的胁迫信号，主调节因子 $X$ 被激活。$X$ 同时激活中间调节因子 $Y$ 和输出蛋白 $Z$ 的产生。然后调节因子 $Y$ 会抑制 $Z$ 的产生。\n\n为了分析该系统的进化适应度，我们使用一个简化的回路动力学模型：\n1.  在 $t=0$ 时，$Y$ 开始以恒定速率 $\\alpha_Y$ 产生。$Y$ 的降解速率与其浓度 $[Y]$ 成正比，速率常数为 $\\beta_Y$。初始浓度为 $[Y](0)=0$。\n2.  在 $t=0$ 时，$Z$ 开始以恒定速率 $\\alpha_Z$ 产生。$Z$ 的降解速率与其浓度 $[Z]$ 成正比，速率常数为 $\\beta_Z$。初始浓度为 $[Z](0)=0$。\n3.  $Y$ 的抑制作用被建模为一个急剧开关：当 $Y$ 的浓度首次达到临界阈值 $[Y](T_{off}) = Y_{thr}$ 时，$Z$ 的产生立即完全停止，该时刻定义为 $T_{off}$。你可以假设产生速率 $\\alpha_Y$ 足够大，以确保最终能达到该阈值。\n\n细胞的适应度 $F$ 由一个权衡决定。产生调节因子 $Y$ 会带来代谢成本，而蛋白质 $Z$ 的持续存在会带来毒性成本。我们将总适应度建模为：\n$F = F_{base} - \\text{Cost}_{Y} - \\text{Cost}_{Z}$\n- 代谢成本 $\\text{Cost}_{Y}$ 与 $Y$ 在没有任何下游效应的情况下所能达到的稳态浓度成正比，比例常数为 $c_Y > 0$。\n- 毒性成本 $\\text{Cost}_{Z}$ 与 $Z$ 从 $t=0$ 到 $t=\\infty$ 的总时间积分浓度成正比，比例常数为 $c_Z > 0$。\n\n假设细胞可以通过进化其产生速率 $\\alpha_Y$ 来最大化其适应度，确定无量纲比率 $R = \\dfrac{\\alpha_Y^{opt}}{\\beta_Y Y_{thr}}$ 的最优值，其中 $\\alpha_Y^{opt}$ 是 $Y$ 的最优产生速率。请用给定的参数 $\\alpha_Z, \\beta_Y, \\beta_Z, Y_{thr}, c_Y,$ 和 $c_Z$ 表示你的答案的解析表达式。", "solution": "问题要求解出能最大化适应度函数的最优产生速率 $\\alpha_Y$，然后将此最优值表示为一个特定的无量纲比率。\n\n**步骤1：调节因子Y的动力学及$T_{off}$的确定**\n\n调节蛋白 $Y$ 的浓度随时间的变化由以下微分方程描述：\n$$ \\frac{d[Y]}{dt} = \\alpha_Y - \\beta_Y [Y] $$\n初始条件为 $[Y](0)=0$。这是一个一阶线性常微分方程。其解为：\n$$ [Y](t) = \\frac{\\alpha_Y}{\\beta_Y} (1 - \\exp(-\\beta_Y t)) $$\n当 $[Y](T_{off}) = Y_{thr}$ 时，蛋白质 $Z$ 的产生在时间 $T_{off}$ 停止。我们可以求解 $T_{off}$：\n$$ Y_{thr} = \\frac{\\alpha_Y}{\\beta_Y} (1 - \\exp(-\\beta_Y T_{off})) $$\n$$ \\frac{\\beta_Y Y_{thr}}{\\alpha_Y} = 1 - \\exp(-\\beta_Y T_{off}) $$\n$$ \\exp(-\\beta_Y T_{off}) = 1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y} $$\n对两边取自然对数：\n$$ -\\beta_Y T_{off} = \\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right) $$\n$$ T_{off} = -\\frac{1}{\\beta_Y} \\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right) $$\n如此问题所述，$T_{off}$ 的这个表达式在 $\\alpha_Y > \\beta_Y Y_{thr}$ 时有效。\n\n**步骤2：输出蛋白Z的动力学及毒性成本的计算**\n\n毒性成本与 $Z$ 的总时间积分浓度 $\\int_0^\\infty [Z](t) dt$ 成正比。$[Z]$ 的动力学是分段的：\n- 对于 $0 \\le t  T_{off}$：$\\frac{d[Z]}{dt} = \\alpha_Z - \\beta_Z [Z]$\n- 对于 $t \\ge T_{off}$：$\\frac{d[Z]}{dt} = -\\beta_Z [Z]$\n\n一种直接但冗长的方法是在两个区间求解 $[Z](t)$ 然后积分。一种更巧妙的方法是直接对整个时间域上的微分方程进行积分。\n$$ \\int_0^\\infty \\frac{d[Z]}{dt} dt = \\int_0^\\infty (\\text{Production}) dt - \\int_0^\\infty \\beta_Z [Z] dt $$\n左边是 $[Z](\\infty) - [Z](0)$。由于产生停止且始终存在降解，$[Z](\\infty) = 0$。我们已知 $[Z](0)=0$。因此，左边为 0。产生项在 $t \\in [0, T_{off})$ 时为 $\\alpha_Z$，在其他时候为 0。\n$$ 0 = \\int_0^{T_{off}} \\alpha_Z dt - \\beta_Z \\int_0^\\infty [Z] dt $$\n$$ \\beta_Z \\int_0^\\infty [Z](t) dt = \\alpha_Z T_{off} $$\n因此，总时间积分浓度为：\n$$ \\int_0^\\infty [Z](t) dt = \\frac{\\alpha_Z T_{off}}{\\beta_Z} $$\n\n**步骤3：构建适应度函数**\n\n适应度 $F$ 由 $F = F_{base} - \\text{Cost}_{Y} - \\text{Cost}_{Z}$ 给出。\n代谢成本 $\\text{Cost}_{Y}$与 $Y$ 的稳态浓度成正比，即 $\\frac{\\alpha_Y}{\\beta_Y}$。\n$$ \\text{Cost}_{Y} = c_Y \\frac{\\alpha_Y}{\\beta_Y} $$\n毒性成本 $\\text{Cost}_{Z}$ 与 $Z$ 的总时间积分浓度成正比。\n$$ \\text{Cost}_{Z} = c_Z \\int_0^\\infty [Z](t) dt = c_Z \\frac{\\alpha_Z T_{off}}{\\beta_Z} $$\n代入步骤1中 $T_{off}$ 的表达式：\n$$ \\text{Cost}_{Z} = - c_Z \\frac{\\alpha_Z}{\\beta_Z \\beta_Y} \\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right) $$\n完整的适应度函数，作为可调参数 $\\alpha_Y$ 的函数，是：\n$$ F(\\alpha_Y) = F_{base} - c_Y \\frac{\\alpha_Y}{\\beta_Y} + c_Z \\frac{\\alpha_Z}{\\beta_Z \\beta_Y} \\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right) $$\n\n**步骤4：优化**\n\n为了找到最大化适应度的最优产生速率 $\\alpha_Y^{opt}$，我们将 $F(\\alpha_Y)$ 对 $\\alpha_Y$求导，并令结果为零。\n$$ \\frac{dF}{d\\alpha_Y} = -\\frac{c_Y}{\\beta_Y} + \\frac{c_Z \\alpha_Z}{\\beta_Z \\beta_Y} \\cdot \\frac{d}{d\\alpha_Y}\\left[\\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right)\\right] $$\n对对数项使用链式法则：\n$$ \\frac{d}{d\\alpha_Y}\\left[\\ln\\left(1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}\\right)\\right] = \\frac{1}{1 - \\frac{\\beta_Y Y_{thr}}{\\alpha_Y}} \\cdot \\frac{d}{d\\alpha_Y}\\left(1 - \\beta_Y Y_{thr} \\alpha_Y^{-1}\\right) $$\n$$ = \\frac{1}{\\frac{\\alpha_Y - \\beta_Y Y_{thr}}{\\alpha_Y}} \\cdot ( - \\beta_Y Y_{thr} (-1) \\alpha_Y^{-2}) = \\frac{\\alpha_Y}{\\alpha_Y - \\beta_Y Y_{thr}} \\cdot \\frac{\\beta_Y Y_{thr}}{\\alpha_Y^2} = \\frac{\\beta_Y Y_{thr}}{\\alpha_Y(\\alpha_Y - \\beta_Y Y_{thr})} $$\n将此代回 $F$ 的导数中：\n$$ \\frac{dF}{d\\alpha_Y} = -\\frac{c_Y}{\\beta_Y} + \\frac{c_Z \\alpha_Z}{\\beta_Z \\beta_Y} \\cdot \\frac{\\beta_Y Y_{thr}}{\\alpha_Y(\\alpha_Y - \\beta_Y Y_{thr})} = 0 $$\n$$ \\frac{c_Y}{\\beta_Y} = \\frac{c_Z \\alpha_Z Y_{thr}}{\\beta_Z \\alpha_Y(\\alpha_Y - \\beta_Y Y_{thr})} $$\n现在，我们求解 $\\alpha_Y$。设 $\\alpha_Y^{opt}$ 为最优值，我们暂时将其记为 $\\alpha_Y$。\n$$ c_Y \\beta_Z \\alpha_Y (\\alpha_Y - \\beta_Y Y_{thr}) = c_Z \\alpha_Z \\beta_Y Y_{thr} $$\n这是一个关于 $\\alpha_Y$ 的二次方程：\n$$ (c_Y \\beta_Z) \\alpha_Y^2 - (c_Y \\beta_Z \\beta_Y Y_{thr}) \\alpha_Y - (c_Z \\alpha_Z \\beta_Y Y_{thr}) = 0 $$\n使用二次公式 $\\alpha_Y = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$：\n$$ \\alpha_Y^{opt} = \\frac{c_Y \\beta_Z \\beta_Y Y_{thr} \\pm \\sqrt{(-c_Y \\beta_Z \\beta_Y Y_{thr})^2 - 4(c_Y \\beta_Z)(-c_Z \\alpha_Z \\beta_Y Y_{thr})}}{2 c_Y \\beta_Z} $$\n由于 $\\alpha_Y$ 必须是正的产生速率，我们取正根。\n$$ \\alpha_Y^{opt} = \\frac{c_Y \\beta_Z \\beta_Y Y_{thr} + \\sqrt{c_Y^2 \\beta_Z^2 \\beta_Y^2 Y_{thr}^2 + 4 c_Y c_Z \\alpha_Z \\beta_Z \\beta_Y Y_{thr}}}{2 c_Y \\beta_Z} $$\n为了简化，将分子和分母同时除以 $2 c_Y \\beta_Z$：\n$$ \\alpha_Y^{opt} = \\frac{\\beta_Y Y_{thr}}{2} + \\sqrt{\\frac{c_Y^2 \\beta_Z^2 \\beta_Y^2 Y_{thr}^2 + 4 c_Y c_Z \\alpha_Z \\beta_Z \\beta_Y Y_{thr}}{4 c_Y^2 \\beta_Z^2}} $$\n$$ \\alpha_Y^{opt} = \\frac{\\beta_Y Y_{thr}}{2} + \\sqrt{\\frac{\\beta_Y^2 Y_{thr}^2}{4} + \\frac{c_Z \\alpha_Z \\beta_Y Y_{thr}}{c_Y \\beta_Z}} $$\n\n**步骤5：计算所需的无量纲比率**\n\n问题要求的是比率 $R = \\dfrac{\\alpha_Y^{opt}}{\\beta_Y Y_{thr}}$。\n$$ R = \\frac{1}{\\beta_Y Y_{thr}} \\left[ \\frac{\\beta_Y Y_{thr}}{2} + \\sqrt{\\frac{\\beta_Y^2 Y_{thr}^2}{4} + \\frac{c_Z \\alpha_Z \\beta_Y Y_{thr}}{c_Y \\beta_Z}} \\right] $$\n$$ R = \\frac{1}{2} + \\sqrt{\\frac{1}{(\\beta_Y Y_{thr})^2}\\left(\\frac{\\beta_Y^2 Y_{thr}^2}{4} + \\frac{c_Z \\alpha_Z \\beta_Y Y_{thr}}{c_Y \\beta_Z}\\right)} $$\n$$ R = \\frac{1}{2} + \\sqrt{\\frac{1}{4} + \\frac{c_Z \\alpha_Z}{c_Y \\beta_Z \\beta_Y Y_{thr}}} $$\n这就是最优无量纲比率的最终表达式。", "answer": "$$\\boxed{\\frac{1}{2} + \\sqrt{\\frac{1}{4} + \\frac{c_Z \\alpha_Z}{c_Y \\beta_Z \\beta_Y Y_{thr}}}}$$", "id": "2037473"}]}