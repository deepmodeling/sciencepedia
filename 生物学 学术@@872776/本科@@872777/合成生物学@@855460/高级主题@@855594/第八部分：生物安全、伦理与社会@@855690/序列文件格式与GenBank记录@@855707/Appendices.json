{"hands_on_practices": [{"introduction": "在合成生物学中，能够准确无误地交流序列信息是所有设计和构建工作的基础。本练习将从最基本也是最广泛使用的FASTA格式入手，模拟一个常见的实际场景：向基因合成公司订购一段定制的DNA序列。通过这个练习，你将掌握构建一个结构完整、符合规范的FASTA文件所需的核心技能，确保你的设计意图能够被精确地传达和执行。[@problem_id:2068080]", "problem": "一名合成生物学学生正在设计一种新的 *Escherichia coli* (*E. coli*) 遗传回路。作为该回路的一部分，学生需要订购一个定制设计的、80个碱基对的合成启动子。合成脱氧核糖核酸（Deoxyribonucleic Acid, DNA）的公司要求订单以 FASTA 格式提交。\n\n该公司规定，FASTA 标题行必须遵循以下结构：`>GeneID|Designer|TargetOrganism`。\n对于此特定订单，所需信息如下：\n*   基因ID (GeneID): `pMod_v1`\n*   设计者 (Designer): `A.Lovelace`\n*   目标生物 (TargetOrganism): `E.coli`\n\n该启动子的80个碱基对的DNA序列是：\n`5'-AGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG-3'`\n\n序列数据本身必须根据标准的生物信息学惯例进行格式化。这意味着序列在标题行之后另起一行开始，并且文本行不应超过80个字符。对于长度超过常规行长60个字符的序列，通常会换行到后续行。\n\n以下哪项代表了该合成启动子的正确格式化的 FASTA 提交文件？\n\nA.\n```\n>pMod_v1,A.Lovelace,E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nB.\n```\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTG\nATTAACATGGAGATTACGCG\n```\n\nC.\n```\n>pMod_v1|A.Lovelace|E.coliAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nD.\n```\n>pMod_v1|A.Lovelace|E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTGATTAACATGGAGATTACGCG\n```\n\nE.\n```\n>pMod_v1|A.Lovelace|E.coli\nAGCTTCAAGTTGATTGGAGCGGTCACAGGTTTGCGACGGTATCAGGCTAGAGTCACCTG\nATTAACATGGAGATTACGCG\n```", "solution": "我们从题目描述中确定所需的 FASTA 格式规则：\n- 标题行必须是以“>”开头的单行，格式为“>GeneID|Designer|TargetOrganism”。\n- 序列必须在标题行之后另起一行开始。\n- 每行不得超过80个字符；长度超过60个字符的序列通常会换行，通常每行60个字符。\n\n给定基因ID (GeneID) 为 pMod_v1，设计者 (Designer) 为 A.Lovelace，目标生物 (TargetOrganism) 为 E.coli，正确的标题行应为：\n>pMod_v1|A.Lovelace|E.coli\n\n评估各个选项：\n- A 使用了逗号而不是竖线，因此不正确。\n- B 缺少必需的 FASTA 标题行，因此不正确。\n- C 将序列与标题行放在同一行，违反了序列应另起一行的规则；不正确。\n- D 有正确的标题行，并将整个序列放在下一行。虽然这没有超过80个字符，通常可以接受，但题目强调了对于超过60个字符的序列，通常在60个字符处换行的惯例。\n- E 有正确的标题行，并将80个碱基的序列分成两行，第一行为常规的60个字符长度，剩余的20个字符在下一行，符合标准的生物信息学惯例。\n\n因此，正确格式化的 FASTA 提交文件是选项 E。", "answer": "$$\\boxed{E}$$", "id": "2068080"}, {"introduction": "与简洁的FASTA格式不同，GenBank文件包含了丰富的注释信息，但这些信息并非总是完美无缺。一个优秀的生物信息学家或合成生物学家必须具备审查和验证数据一致性的能力。本练习将引导你深入GenBank记录的内部，通过解析一个复杂的编码序列（CDS）位置描述符，并根据其计算出预期的蛋白质长度。这是一种发现注释错误的实用方法，能够培养你对序列数据进行批判性分析的技能。[@problem_id:2068087]", "problem": "一位生物信息学家正在对新提交的基因组注释进行质量控制检查。他们怀疑一个 GenBank 文件中的某个特定基因条目存在错误。该基因的编码序列（CDS）特征描述如下：\n\n`CDS             complement(join(1201..1350,1501..1602,1820..1984))`\n\n与此 `CDS` 特征相关联的 `/translation` 限定符提供了一个长度为140个氨基酸的氨基酸序列。\n\n根据 GenBank 格式约定：\n- 数字 `a..b` 表示从碱基 `a` 到碱基 `b`（含两端）的连续核苷酸序列。这样一个片段的长度是 `b - a + 1`。\n- `join(loc1, loc2, ...)` 表示 `CDS` 是由按指定顺序连接的每个位置的核苷酸序列构成的。这些连接起来的片段在剪接后形成信使RNA（mRNA）。\n- `complement(...)` 表示该基因位于DNA的互补链上。在计算编码区总长度时，此信息不改变所涉及的总碱基对数。\n- 根据定义，`CDS` 包含终止密码子的编码区。翻译过程将每3个碱基的密码子转换为一个氨基酸，但最后的终止密码子本身*不*被翻译成氨基酸，也不是最终蛋白质链的一部分。\n\n您的任务是根据给定的 `CDS` 位置字符串，确定应产生的蛋白质的正确长度（以氨基酸数量表示）。", "solution": "CDS 的位置由 complement(join(1201..1350,1501..1602,1820..1984)) 给出。总编码长度是三个片段长度的总和，其中每个片段的长度计算为 $b-a+1$。\n\n对于第一个片段 $1201..1350$，其长度为\n$$\nL_{1}=1350-1201+1=150.\n$$\n对于第二个片段 $1501..1602$，其长度为\n$$\nL_{2}=1602-1501+1=102.\n$$\n对于第三个片段 $1820..1984$，其长度为\n$$\nL_{3}=1984-1820+1=165.\n$$\nCDS 的总长度为\n$$\nL=L_{1}+L_{2}+L_{3}=150+102+165=417.\n$$\ncomplement 标志不改变核苷酸的总数。一个 CDS 包含终止密码子，而翻译过程每个密码子使用 $3$ 个核苷酸。因此，密码子的总数为\n$$\nN_{\\text{codons}}=\\frac{L}{3}=\\frac{417}{3}=139.\n$$\n由于终止密码子不被翻译成氨基酸，因此最终蛋白质的长度（以氨基酸计）为\n$$\nN_{\\text{aa}}=N_{\\text{codons}}-1=139-1=138.\n$$\n因此，所提供的 $140$ 个氨基酸的翻译长度与 CDS 坐标不一致。", "answer": "$$\\boxed{138}$$", "id": "2068087"}, {"introduction": "在将设计付诸于湿实验之前，合成生物学家通常会进行“计算机模拟克隆”（in silico cloning），以预测结果并规避潜在问题。这个综合性练习将挑战你从算法层面思考如何完成一个基因克隆项目，即如何在一个质粒载体的GenBank文件中精确地插入一个新基因。这不仅需要你修改DNA序列，更关键的是要系统地更新所有受影响的特征注释，特别是那些位于插入位点下游的特征坐标，这是确保重组质粒注释文件准确性的核心步骤。[@problem_id:2068076]", "problem": "在一个合成生物学项目中，研究人员需要在进行实验室实验之前，对基因插入质粒载体的过程进行计算模拟。该过程涉及编辑载体的 GenBank 文件，以包含新基因的序列和特征。\n\n给定您两个文件：\n1.  `pVector.gb`：一个环状质粒的 GenBank 文件，长度为 5000 个碱基对 (bp)。其 FEATURES 表包含几个注释区域。为了克隆目的，它包含一个定义为 `misc_feature 2501..2506` 的特定特征，其限定符为 `/label=\"CloningSite\"`。您可以假设没有其他注释特征与该位点重叠。\n2.  `myGene.fa`：一个 FASTA (Fast-All) 格式文件，包含一个目的基因的 DNA 序列。该文件中的序列长度为 1500 bp。\n\n任务是生成一个代表重组质粒的新的 GenBank 文件。这通过从 `pVector.gb` 中切除“CloningSite”（`2501..2506`）处的 6 bp 序列，并在此位置插入来自 `myGene.fa` 的 1500 bp 序列来实现。\n\n以下哪个算法流程正确描述了为新的重组质粒生成一个有效的 GenBank 文件所需的所有必要步骤？\n\nA. 解析两个输入文件以提取它们的序列和载体的特征表。通过将 6 bp 的“CloningSite”序列替换为 1500 bp 的基因序列来构建新的、更长的 DNA 序列。更新 `LOCUS` 行中的总长度。在特征表中，移除“CloningSite”特征，为插入的基因添加一个新特征，并对所有完全位于插入点下游的特征，将其起始和终止坐标按序列长度的净变化量（`1500 - 6 = 1494`）进行移位。最后，将更新后的组件组装成一个新的 GenBank 文件。\n\nB. 解析两个输入文件。通过将“CloningSite”序列替换为基因序列来构建新的 DNA 序列。用新的总长度更新 `LOCUS` 行。在特征表中，移除“CloningSite”特征，并在插入位置为该基因添加一个新特征。不修改任何其他现有特征的坐标。将组件组装成一个新的 GenBank 文件。\n\nC. 解析两个输入文件。通过将“CloningSite”序列替换为基因序列来构建新的 DNA 序列。不修改 `LOCUS` 行中指定的总长度。在特征表中，移除“CloningSite”特征，为插入的基因添加一个新特征，并正确移位所有下游特征的坐标。将组件组装成一个新的 GenBank 文件。\n\nD. 解析两个输入文件。通过将 1500 bp 的基因序列附加到原始 5000 bp 载体序列的末尾来构建新的 DNA 序列。将 `LOCUS` 行的总长度更新为 6500 bp。在特征表中，在 `5001..6500` 位置为该基因添加一个新特征。将组件组装成一个新的 GenBank 文件。\n\nE. 解析两个输入文件。通过将“CloningSite”序列替换为基因序列来构建新的 DNA 序列。用新的总长度更新 `LOCUS` 行。在特征表中，移除“CloningSite”特征，为插入的基因添加一个新特征，并对所有完全位于插入点下游的特征，将其起始和终止坐标按插入基因的全长（1500）进行移位。将组件组装成一个新的 GenBank 文件。", "solution": "我们将此编辑过程形式化为对以 GenBank 格式表示的、带注释的环状 DNA 序列进行的坐标变换。\n\n设原始质粒长度为 $L_{\\text{old}}$，删除片段的长度为 $L_{\\text{del}}$，插入基因的长度为 $L_{\\text{ins}}$。净长度变化为 $\\Delta L = L_{\\text{ins}} - L_{\\text{del}}$，新的总长度为 $L_{\\text{new}} = L_{\\text{old}} + \\Delta L$。根据给定值，$L_{\\text{old}}=5000$，$L_{\\text{del}}=6$，$L_{\\text{ins}}=1500$，因此 $\\Delta L = 1494$ 且 $L_{\\text{new}}=6494$。\n\n定义原始载体中的插入区间为坐标 $a..b$，其中 $a=2501$，$b=2506$，并（如题所述）假设没有其他注释特征与 $[a,b]$ 重叠。通过将原始载体序列中位于 $[a,b]$ 的子序列替换为来自 FASTA 文件的完整基因序列，来构建新序列，从而产生一个长度为 $L_{\\text{new}}$ 的连续序列。更新 LOCUS 行以反映 $L_{\\text{new}}$ 并保持环状拓扑结构。\n\n对于特征坐标的更新，应用原地替换编辑的标准坐标移位规则：\n- 移除注释被切除区间的特征（此处指具有识别克隆位点的键和限定符的特征）。\n- 为插入的基因添加一个新特征，其在新坐标系中占据 $[a, a + L_{\\text{ins}} - 1]$。\n- 对于任何完全位于上游的现有特征，即其两个端点都 $\\leq a - 1$，其坐标保持不变。\n- 对于任何完全位于下游的现有特征，即其两个端点都 $\\geq b + 1$，将其起始和终止坐标都移动 $\\Delta L$。\n- 对于与 $[a,b]$ 重叠的特征，需要进行适当的拆分或调整，但题目说明没有重叠，因此这种情况不会发生。\n\n最后，通过组装更新后的 LOCUS 行、包含上述移除、插入和坐标移位的 FEATURES 表以及更新后的 ORIGIN 序列，来重建一个有效的 GenBank 记录。\n\n根据这些必要步骤评估每个选项：\n- 选项 A 指出将 $6$ bp 的区间替换为 $1500$ bp 的基因，更新 LOCUS 长度，移除克隆位点特征，添加基因特征，并将所有下游特征按净变化量 $\\Delta L = 1500 - 6 = 1494$ 进行移位，然后组装一个新的 GenBank 文件。这与正确的坐标变换和元数据更新相匹配。\n- 选项 B 的错误在于没有移位下游特征的坐标，这将导致注释不正确。\n- 选项 C 的错误在于没有更新 LOCUS 总长度，该长度在序列修改后必须更改为 $L_{\\text{new}}$。\n- 选项 D 错误地进行了附加而不是替换，这与在克隆位点进行切除和替换的规定相矛盾。\n- 选项 E 将下游特征移动了 $L_{\\text{ins}}$ 而不是 $\\Delta L$，忽略了 $L_{\\text{del}}$ 的删除，从而导致下游特征位置错误。\n\n因此，唯一正确的流程是选项 A。", "answer": "$$\\boxed{A}$$", "id": "2068076"}]}