{"hands_on_practices": [{"introduction": "合成生物学中的一个核心任务是设计具有特定功能的生物元件。我们可以使用简单的计算模型来指导这一过程，将DNA序列与其功能（如启动子强度）联系起来。[@problem_id:2047890] 这个练习将引导你使用一个基于位置的评分模型，通过在每个位置选择最优的核苷酸，来确定理论上能达到的最大启动子强度。这个过程不仅阐明了序列-功能模型的直接应用，也让你初步体验到将生物元件设计问题转化为优化问题的思路。", "problem": "在一个合成生物学项目中，一位研究人员开发了一个简单的计算模型来预测一个合成启动子的“强度”。该启动子是一个由10个碱基对组成的脱氧核糖核酸（DNA）序列。该模型通过对序列中每个核苷酸碱基（A、C、G、T）的位置依赖权重值进行求和，来计算一个无量纲的启动子强度分数。\n\n对于一个10个碱基对的序列 $B_1B_2B_3B_4B_5B_6B_7B_8B_9B_{10}$，其分数 $S$ 由以下公式给出：\n$$S = \\sum_{i=1}^{10} W(B_i, i)$$\n其中 $W(B_i, i)$ 是碱基 $B_i$ 在位置 $i$ 上的权重。具体的权重值见下表：\n\n| 位置 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| **A** | 3 | -2 | 6 | 1 | 4 | -1 | 5 | 2 | -4 | 7 |\n| **C** | -2 | 5 | 2 | 3 | -1 | 6 | -3 | 4 | 2 | 3 |\n| **G** | 2 | 3 | -1 | 5 | 0 | 2 | 4 | -5 | 6 | -2 |\n| **T** | 1 | 4 | 4 | -2 | 3 | -3 | 2 | 6 | 3 | 4 |\n\n您的任务是找出根据该模型可以达到的理论最大启动子强度分数。请确定这个最大分数。", "solution": "我们寻求在所有 $B_{i}\\in\\{A,C,G,T\\}$ 的选择中，求 $S=\\sum_{i=1}^{10}W(B_{i},i)$ 的最大值。由于该和在各个位置上是可分的，因此最大化问题可以分解为在每个位置上的独立选择。因此，如果我们定义 $m_{i}=\\max_{B\\in\\{A,C,G,T\\}}W(B,i)$，那么理论最大值就是 $S_{\\max}=\\sum_{i=1}^{10}m_{i}$。\n\n根据给定的表格，我们计算每个位置的最大值：\n$m_{1}=3$ (来自A)，$m_{2}=5$ (来自C)，$m_{3}=6$ (来自A)，$m_{4}=5$ (来自G)，$m_{5}=4$ (来自A)，$m_{6}=6$ (来自C)，$m_{7}=5$ (来自A)，$m_{8}=6$ (来自T)，$m_{9}=6$ (来自G)，$m_{10}=7$ (来自A)。\n\n将这些值相加得到\n$$\nS_{\\max}=\\sum_{i=1}^{10}m_{i}=3+5+6+5+4+6+5+6+6+7=53.\n$$\n因此，理论最大启动子强度分数为 53。", "answer": "$$\\boxed{53}$$", "id": "2047890"}, {"introduction": "除了从头设计新序列，我们更常对现有生物元件进行优化和改造。位置权重矩阵 (PWM) 等模型是进行此类分析的有力工具，能够预测单个碱基突变对元件功能的影响。[@problem_id:2047881] 在这个练习中，你将扮演一名生物工程师，对一个已知的启动子序列进行“计算机模拟”的定点突变扫描。通过计算每个可能的单点突变导致的活性变化 ($\\Delta S$)，你将学会如何利用模型来识别最有潜力的改造位点，从而指导后续的湿实验，提高研发效率。", "problem": "在合成生物学中，预测模型常用于在实验室合成之前，估算启动子等遗传元件的强度。一种常见的、用于评估启动子强度的简单模型是位置权重矩阵 (PWM)。该模型根据每个位置上各个核苷酸 (A, C, G, T) 的贡献，为一段脱氧核糖核酸 (DNA) 序列打分。启动子的总预测活性 $S$ 是其序列中每个位置上碱基分数之和。\n\n一位生物工程师正在研究一个长度为5个碱基对 (bp) 的野生型 (WT) 启动子序列：`5'-GATCA-3'`。他们使用以下PWM来预测启动子活性，其中的分数无单位。\n\n**位置权重矩阵 (PWM)**\n\n| 碱基 | 位置 1 | 位置 2 | 位置 3 | 位置 4 | 位置 5 |\n| :--- | :---: |:---: |:---: |:---: |:---: |\n| A    | 0.1   | -1.5  | 0.8   | -1.2  | 0.5   |\n| C    | -0.5  | 0.5   | -0.8  | 1.0   | 0.1   |\n| G    | 1.2   | -1.0  | -0.5  | -0.5  | -1.0  |\n| T    | -1.0  | 1.5   | 0.4   | 0.5   | 1.2   |\n\n该工程师决定进行一次*计算机模拟*突变扫描，以寻找可能增强启动子强度的突变。这包括在野生型序列中系统地制造所有可能的单碱基替换，并计算由此产生的活性变化 $\\Delta S = S_{\\text{mutant}} - S_{\\text{WT}}$。\n\n你的任务是找出导致预测活性最大*增量*的单碱基替换。这个最大的正 $\\Delta S$ 值是多少？\n\n将你的最终答案四舍五入至两位有效数字。", "solution": "位置权重矩阵 (PWM) 模型通过对各位置碱基的贡献求和，为序列赋予一个总分 $S$：\n$$\nS=\\sum_{i=1}^{5} w_{i}(b_{i}),\n$$\n其中 $w_{i}(b_{i})$ 是位置 $i$ 上碱基 $b_{i}$ 的PWM分数。对于在位置 $i$ 处，野生型碱基 $b_{\\text{WT}}$ 替换为突变型碱基 $b_{\\text{mut}}$ 的单碱基替换，其活性变化为\n$$\n\\Delta S=S_{\\text{mutant}}-S_{\\text{WT}}=w_{i}(b_{\\text{mut}})-w_{i}(b_{\\text{WT}}),\n$$\n因为所有其他位置保持不变。\n\n野生型序列为 $5'\\text{-}GATCA\\text{-}3'$，因此位置1到5的碱基分别为 $G, A, T, C, A$。使用PWM：\n\n- 位置 1 (野生型 $G$，分数为 $1.2$)：可能的突变体为 $A, C, T$\n$$\n\\Delta S(A)=0.1-1.2=-1.1,\\quad \\Delta S(C)=-0.5-1.2=-1.7,\\quad \\Delta S(T)=-1.0-1.2=-2.2.\n$$\n位置 1 的最大值为 $-1.1$ (没有增加)。\n\n- 位置 2 (野生型 $A$，分数为 $-1.5$)：可能的突变体为 $C, G, T$\n$$\n\\Delta S(C)=0.5-(-1.5)=2.0,\\quad \\Delta S(G)=-1.0-(-1.5)=0.5,\\quad \\Delta S(T)=1.5-(-1.5)=3.0.\n$$\n位置 2 的最大值为 $3.0$ (有增加)。\n\n- 位置 3 (野生型 $T$，分数为 $0.4$)：可能的突变体为 $A, C, G$\n$$\n\\Delta S(A)=0.8-0.4=0.4,\\quad \\Delta S(C)=-0.8-0.4=-1.2,\\quad \\Delta S(G)=-0.5-0.4=-0.9.\n$$\n位置 3 的最大值为 $0.4$ (有增加)。\n\n- 位置 4 (野生型 $C$，分数为 $1.0$)：可能的突变体为 $A, G, T$\n$$\n\\Delta S(A)=-1.2-1.0=-2.2,\\quad \\Delta S(G)=-0.5-1.0=-1.5,\\quad \\Delta S(T)=0.5-1.0=-0.5.\n$$\n位置 4 的最大值为 $-0.5$ (没有增加)。\n\n- 位置 5 (野生型 $A$，分数为 $0.5$)：可能的突变体为 $C, G, T$\n$$\n\\Delta S(C)=0.1-0.5=-0.4,\\quad \\Delta S(G)=-1.0-0.5=-1.5,\\quad \\Delta S(T)=1.2-0.5=0.7.\n$$\n位置 5 的最大值为 $0.7$ (有增加)。\n\n在所有位置中，最大的正 $\\Delta S$ 是 $3.0$，来自位置2上 $A \\to T$ 的替换。四舍五入到两位有效数字，结果为 $3.0$。", "answer": "$$\\boxed{3.0}$$", "id": "2047881"}, {"introduction": "在许多生物学筛选任务中，我们寻找的目标（如高活性酶）在庞大的分子库中极为罕见，这导致了严重的“类别不平衡”问题。在这种情况下，仅用准确率来评估一个机器学习分类器的性能是远远不够的。[@problem_id:2047917] 这个练习将带你进入一个更真实的场景：评估一个用于筛选稀有高活性酶变体的分类模型。你将学习如何计算F1分数——一个综合了精确率和召回率的指标，它能更稳健地衡量模型在处理不平衡数据时的真实表现，这对于避免在昂贵的实验验证中浪费资源至关重要。", "problem": "一个合成生物学实验室正在使用机器学习模型来筛选一个通过计算生成的大型酶变体库。其主要目标是高效地识别出那些具有极高催化活性的稀有变体，而这些变体的实验验证成本高昂且耗时。\n\n为了评估该模型的预测能力，研究人员在一个包含 20,000 个独特酶变体的库上对其进行了测试。根据先前的详尽分析可知，在该测试集中，恰好有 150 个变体是“高活性”（正类），其余的变体是“低活性”（负类）。\n\n当该分类模型应用于此测试库时，它产生了以下结果：\n- 它正确识别了 120 个高活性变体。\n- 它将 300 个低活性变体错误地分类为高活性。\n\n简单的准确率可能是一个具有误导性的性能指标，尤其是在存在如此严重的类别不平衡的情况下。一个更鲁棒的指标是正类的 F1 分数。F1 分数定义为精确率和召回率的调和平均数。精确率是指在所有预测为正类的样本中，实际为正类的样本所占的比例；而召回率是指在所有实际为正类的样本中，被正确识别的样本所占的比例。\n\n根据模型在测试库上的表现，计算“高活性”类别的 F1 分数。将您的答案以无量纲的小数值形式报告，并四舍五入到三位有效数字。", "solution": "我们已知实际正类的总数和模型的分类结果。定义以下标准量：\n- 真正例：$TP=120$。\n- 假正例：$FP=300$。\n- 实际正例：$P=150$，因此假负例 $FN=P-TP=150-120=30$。\n\n正类的精确率定义为\n$$\\text{Precision}=\\frac{TP}{TP+FP}=\\frac{120}{120+300}=\\frac{120}{420}=\\frac{2}{7}.$$\n\n正类的召回率定义为\n$$\\text{Recall}=\\frac{TP}{TP+FN}=\\frac{120}{120+30}=\\frac{120}{150}=\\frac{4}{5}.$$\n\nF1 分数是精确率和召回率的调和平均数：\n$$F_{1}=\\frac{2\\cdot \\text{Precision}\\cdot \\text{Recall}}{\\text{Precision}+\\text{Recall}}=\\frac{2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}}{\\frac{2}{7}+\\frac{4}{5}}.$$\n\n明确地计算分子和分母：\n$$\\text{Numerator}=2\\cdot \\frac{2}{7}\\cdot \\frac{4}{5}=\\frac{16}{35},\\quad \\text{Denominator}=\\frac{2}{7}+\\frac{4}{5}=\\frac{10}{35}+\\frac{28}{35}=\\frac{38}{35}.$$\n\n因此，\n$$F_{1}=\\frac{\\frac{16}{35}}{\\frac{38}{35}}=\\frac{16}{38}=\\frac{8}{19}.$$\n\n作为小数，并四舍五入到三位有效数字，\n$$\\frac{8}{19}\\approx 0.4210526\\ldots \\rightarrow 0.421.$$", "answer": "$$\\boxed{0.421}$$", "id": "2047917"}]}