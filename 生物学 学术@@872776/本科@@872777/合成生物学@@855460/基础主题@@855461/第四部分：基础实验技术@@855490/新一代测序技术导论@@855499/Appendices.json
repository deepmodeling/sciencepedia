{"hands_on_practices": [{"introduction": "新一代测序 (NGS) 能够产出海量数据，但我们如何判断每一个碱基判读的可靠性呢？Phred 质量分数 ($Q$) 是衡量这种置信度的行业标准。本练习将通过一个实际计算，帮助你将这个抽象的分数转化为具体的错误概率，这是解读测序结果和评估数据质量的一项关键技能 ([@problem_id:2045434])。", "problem": "在一个合成生物学项目中，一名研究人员构建了一个总长度为 $L = 500$ 个碱基对的短合成基因。为验证该序列，他们使用了一个新一代测序（NGS）平台。针对这一特定基因片段的测序输出报告，每个碱基的 Phred 质量分数均为 $Q = 40$。\n\nPhred 质量分数 $Q$ 是衡量自动化 DNA 测序所产生的核碱基识别质量的指标。它由以下公式定义：\n$$Q = -10 \\log_{10}(P_e)$$\n其中 $P_e$ 是相应碱基检出错误的概率。\n\n假设每个碱基位置的测序错误是独立事件，计算在整个 500 碱基对的基因序列中发现至少一个错误碱基检出的概率。\n\n将您的最终答案四舍五入至四位有效数字。", "solution": "给定一个长度为 $L=500$ 个碱基的基因，且每个碱基的 Phred 质量分数均为 $Q=40$。Phred 的定义为\n$$Q=-10\\log_{10}(P_{e}),$$\n因此，每个碱基的错误概率是\n$$P_{e}=10^{-Q/10}.$$\n代入 $Q=40$ 得\n$$P_{e}=10^{-4}.$$\n\n假设各碱基之间是独立的，则所有 $L$ 个碱基都被正确检出（即零错误）的概率是\n$$(1-P_{e})^{L}.$$\n因此，序列中至少有一个错误碱基检出的概率是\n$$P(\\text{至少一个错误})=1-(1-P_{e})^{L}.$$\n代入 $P_{e}=10^{-4}$ 和 $L=500$，\n$$P=1-(1-10^{-4})^{500}.$$\n\n为了进行数值计算，可以写成\n$$(1-10^{-4})^{500}=\\exp\\!\\left(500\\,\\ln(1-10^{-4})\\right).$$\n在 $x=10^{-4}$ 处使用级数 $\\ln(1-x)=-x-\\frac{x^{2}}{2}-\\frac{x^{3}}{3}-\\cdots$，\n$$\\ln(1-10^{-4})\\approx-10^{-4}-\\frac{10^{-8}}{2}-\\frac{10^{-12}}{3}=-0.000100005000000333\\ldots,$$\n因此\n$$500\\,\\ln(1-10^{-4})\\approx-0.050002500000166\\ldots,$$\n且\n$$(1-10^{-4})^{500}\\approx\\exp(-0.0500025)\\approx 0.951227046\\ldots.$$\n因此，\n$$P=1-(1-10^{-4})^{500}\\approx 0.048772953\\ldots,$$\n四舍五入到四位有效数字是 $0.04877$。", "answer": "$$\\boxed{0.04877}$$", "id": "2045434"}, {"introduction": "在评估了单个碱基的质量后，下一个关键问题是：我们测序的数据量是否足够？本练习将向你介绍测序覆盖深度 ($\\lambda$) 的概念，并阐释它与测序项目完整性的关系。通过这项练习，你将学会如何计算平均覆盖深度，并运用泊松分布这一基因组学中常用的统计工具，来预测基因组中可能被遗漏的部分，这对于实验设计至关重要 ([@problem_id:2045416])。", "problem": "一个合成生物学研究团队正在验证一个定制构建的细菌人工染色体 (BAC) 的序列。他们进行了一项新一代测序 (NGS) 实验，并获得了一组短的 DNA 读段。其实验的关键参数如下：\n\n- BAC 基因组的总长度 $L$ 为 200 千碱基对 (kbp)。\n- 生成的读段总数 $N$ 为 9,200。\n- 每个读段的平均长度 $R$ 为 100 碱基对 (bp)。\n\n假设读段在 BAC 基因组上随机且均匀分布，那么任意一个碱基被恰好 $k$ 个读段覆盖的概率 $P(k)$ 可以用泊松分布来建模：$P(k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $\\lambda$ 是整个基因组的平均覆盖深度。\n\n根据这些信息，计算 BAC 基因组中预期覆盖度为零（即未被测序）的理论比例。将你的答案表示为保留三位有效数字的小数。", "solution": "我们用均值（平均深度）为 $\\lambda$ 的泊松分布来为每个碱基的覆盖度建模。在读段随机、均匀放置的假设下，平均深度等于测序的总碱基数除以基因组长度：\n$$\n\\lambda = \\frac{N R}{L}.\n$$\n当 $N=9200$，$R=100$ bp，且 $L=200\\,\\text{kbp}=200000$ bp 时，\n$$\n\\lambda = \\frac{9200 \\cdot 100}{200000} = \\frac{920000}{200000} = 4.6.\n$$\n对于泊松模型，一个碱基的覆盖度为零的概率是\n$$\nP(0) = \\exp(-\\lambda) = \\exp(-4.6).\n$$\n数值计算结果为，\n$$\n\\exp(-4.6) \\approx 0.0100518 \\approx 0.0101 \\text{ (three significant figures)}.\n$$\n因此，BAC 基因组中预期覆盖度为零的理论比例是 $0.0101$。", "answer": "$$\\boxed{0.0101}$$", "id": "2045416"}, {"introduction": "拥有高质量的读长和足够的覆盖度只是成功的一半，最后一步是需要将这些短读长拼接成一个连续的序列。然而，基因组中的重复序列是序列拼接过程中的一个主要障碍，它们会迷惑拼接算法，导致错误的组装结果。本练习通过一个关于串联重复序列的难题，揭示了短读长拼接的一个根本性限制，帮助你深入理解读长、重复序列结构和拼接准确性之间的相互作用 ([@problem_id:2045444])。", "problem": "一家合成生物学公司的生物信息学家正在为一个定制质粒的质量控制流程提供咨询。这些质粒具有一个可变的遗传条形码，该条形码由一个特定DNA序列 `R'` 的 `N` 次串联重复区域实现。这个重复单元 `R'` 的长度为40个碱基对 (bp)。在质粒构建完成后，需要确定拷贝的确切数量 `N`。整个串联重复区域的两侧是独特的已知序列。\n\n质量控制将使用一种短读长测序技术进行，该技术产生的读长（reads）具有恒定长度 `L = 150` bp。然后，将使用标准的基于德布鲁因图的组装算法，从这些读长中重建完整的质粒序列。\n\n只有当拷贝的确切数量 `N` 能够从最终的组装图中明确确定时，条形码区域的组装才被认为是‘已解析’的。考虑到短读长测序的局限性，该组装过程能保证解析的序列 `R'` 的最大整数串联拷贝数 `N_max` 是多少？", "solution": "设重复单元的长度为 $r=40$，读长为 $L=150$。在基于德布鲁因图的组装中，对于一个两侧为独特序列的完美串联重复序列，只有当至少有一个读长能够从左侧的独特序列区开始，跨越所有 $N$ 个重复拷贝，并进入右侧的独特序列区时，其拷贝数 $N$ 才能被明确解析。如果没有这样的桥接读长，重复序列在图中会塌陷，其多重性变得不明确。\n\n如果总重复长度为 $T=N r$，一个长度为 $L$ 的读长要桥接两侧，就必须覆盖重复序列的所有 $T$ 个碱基，并且还要包含来自两侧独特序列区的至少各一个碱基。将读长中包含的最小侧翼碱基总数表示为 $2$（每侧一个碱基），则保证可解析的充分必要条件是\n$$\nL \\geq N r + 2.\n$$\n解出 $N$ 可得\n$$\nN \\leq \\frac{L-2}{r}.\n$$\n由于 $N$ 必须是整数，因此可保证解析的最大拷贝数为\n$$\nN_{\\max}=\\left\\lfloor \\frac{L-2}{r} \\right\\rfloor.\n$$\n代入 $L=150$ 和 $r=40$，\n$$\nN_{\\max}=\\left\\lfloor \\frac{150-2}{40} \\right\\rfloor=\\left\\lfloor \\frac{148}{40} \\right\\rfloor=\\left\\lfloor 3.7 \\right\\rfloor=3.\n$$\n因此，最多可以保证解析 $3$ 个串联拷贝；$4$ 个或更多拷贝则无法保证被解析，因为没有一个读长能够跨越整个重复序列阵列并同时覆盖到两侧的独特序列区。", "answer": "$$\\boxed{3}$$", "id": "2045444"}]}