{"hands_on_practices": [{"introduction": "在分析多重序列比对时，一个核心任务是量化每个位置的保守性。香农熵（$H$）为我们提供了一个强大的数学工具来衡量这种变异性或不确定性。本练习将带你亲手计算一个特定位点的香农熵，这是理解序列保守性并为后续构建序列标识（sequence logos）奠定基础的关键一步。[@problem_id:2121514]", "problem": "一位研究人员正在研究一个同源酶家族中某个关键活性位点残基的保守性。他们从20个相关的蛋白质序列构建了一个多序列比对 (MSA)。在该比对中对应于活性位点残基的某一特定列，他们观察到以下氨基酸分布：12条序列为谷氨酸 (E)，6条为天冬氨酸 (D)，2条为丙氨酸 (A)。在该位置没有出现其他类型的氨基酸。\n\n为了量化该位置的变异性，研究人员决定计算香农熵 $H$。比对中给定位置的香农熵由以下公式定义：\n$$H = -\\sum_{i=1}^{k} p_i \\log_2(p_i)$$\n其中 $k$ 是该位置存在的不同氨基酸类型的数量，$p_i$ 是第 $i$ 种氨基酸类型的频率。\n\n计算该比对特定列的香农熵。结果以比特为单位表示，并保留三位有效数字。", "solution": "共有 $N=20$ 条序列。该列观察到的计数为：$12$ 个 E，$6$ 个 D，以及 $2$ 个 A，所以经验概率为\n$$p_{E}=\\frac{12}{20}=\\frac{3}{5}=0.6,\\quad p_{D}=\\frac{6}{20}=\\frac{3}{10}=0.3,\\quad p_{A}=\\frac{2}{20}=\\frac{1}{10}=0.1.$$\n以比特为单位的香农熵为\n$$H=-\\sum_{i} p_{i}\\log_{2}(p_{i})= -\\left(0.6\\log_{2}(0.6)+0.3\\log_{2}(0.3)+0.1\\log_{2}(0.1)\\right).$$\n使用 $\\log_{2}(x)=\\frac{\\ln x}{\\ln 2}$ 进行数值计算，\n$$\\log_{2}(0.6)\\approx -0.736965594,\\quad \\log_{2}(0.3)\\approx -1.736965594,\\quad \\log_{2}(0.1)\\approx -3.321928095.$$\n因此，\n$$H\\approx -\\left[0.6(-0.736965594)+0.3(-1.736965594)+0.1(-3.321928095)\\right] \\approx 1.295461844.$$\n四舍五入到三位有效数字，得到 $H\\approx 1.30$ 比特。", "answer": "$$\\boxed{1.30}$$", "id": "2121514"}, {"introduction": "“共有序列”并不总是由最常见的残基简单堆砌而成，尤其是在考虑功能和进化关系时。本练习引入了一种更精细的方法，即使用替换计分矩阵来确定共有残基，该方法考虑了氨基酸之间的生物化学相似性。通过这个实践，你将理解为什么在某些情况下，一个非最多数的残基可能因其与该位置其他残基的良好化学兼容性而被选为功能上更合理的代表。[@problem_id:2121462]", "problem": "在生物信息学中，共有序列是从多序列比对（MSA）中推导出来的，用以代表每个位置上最常见的残基。虽然通常由简单多数决定，但更复杂的方法使用打分矩阵来考虑氨基酸的生化相似性。\n\n一位分析师正在研究一个特定酶家族的20条序列组成的多序列比对中的一个关键活性位点位置。在该位置观察到的氨基酸是：\nL, L, L, L, L, L, P, L, L, L, P, L, L, L, L, P, L, P, L, L\n\n使用一种基于打分的方法来确定共有残基。该位置的共有氨基酸被定义为能使总比对分数最大化的氨基酸`X`。候选残基`X`的总分数是通过将该列中每个观察到的残基`Y`的替换分数`S(X, Y)`相加来计算的。待测试的候选残基是异亮氨酸（I）、亮氨酸（L）、脯氨酸（P）和缬氨酸（V）。\n\n相关的替换分数`S(候选, 观察到的)`如下表所示：\n\n| | 观察到的: L | 观察到的: P |\n| :--- | :---: | :---: |\n| **候选: I** | 4 | -1 |\n| **候选: L** | 4 | -4 |\n| **候选: P** | -4 | 7 |\n| **候选: V** | 2 | -2 |\n\n根据这种打分方法，下列哪种氨基酸是该位置的共有残基？\n\nA) I\n\nB) L\n\nC) P\n\nD) V", "solution": "我们得到一个多序列比对列，其中观察到的残基仅包含亮氨酸和脯氨酸。从列表中计数，L出现$16$次，P出现$4$次。将这些计数记为$n_{L}=16$和$n_{P}=4$。\n\n对于一个候选残基$X$，总比对分数定义为\n$$\nT(X)=\\sum_{\\text{observed }Y} S(X,Y)=n_{L}\\,S(X,L)+n_{P}\\,S(X,P).\n$$\n使用提供的替换分数，为每个候选残基计算：\n\n对于$X=\\text{I}$:\n$$\nT(\\text{I})=n_{L}\\,S(\\text{I},\\text{L})+n_{P}\\,S(\\text{I},\\text{P})=16\\cdot 4+4\\cdot(-1)=64-4=60.\n$$\n\n对于$X=\\text{L}$:\n$$\nT(\\text{L})=n_{L}\\,S(\\text{L},\\text{L})+n_{P}\\,S(\\text{L},\\text{P})=16\\cdot 4+4\\cdot(-4)=64-16=48.\n$$\n\n对于$X=\\text{P}$:\n$$\nT(\\text{P})=n_{L}\\,S(\\text{P},\\text{L})+n_{P}\\,S(\\text{P},\\text{P})=16\\cdot(-4)+4\\cdot 7=-64+28=-36.\n$$\n\n对于$X=\\text{V}$:\n$$\nT(\\text{V})=n_{L}\\,S(\\text{V},\\text{L})+n_{P}\\,S(\\text{V},\\text{P})=16\\cdot 2+4\\cdot(-2)=32-8=24.\n$$\n\n最大总分数为$60$，由$X=\\text{I}$得到。因此，根据这种打分方法，共有残基对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "2121462"}, {"introduction": "当一个通过简单多数原则构建的共有序列在实验中失效时，我们该如何系统地设计一个更好的候选序列？本练习模拟了一个真实的科研场景，你将利用信息含量（$R_i$）这一关键指标来评估DNA结合位点各位置的保守程度。根据信息含量的阈值，你将构建一个“功能加权共有序列”，这个过程完美地展示了如何将生物信息学的定量分析转化为指导实验设计的具体策略，从而解决实际的生物学问题。[@problem_id:2121521]", "problem": "一个生物化学家团队正在研究一种新型的DNA结合转录因子。通过高通量筛选实验，他们鉴定了该因子能结合的100种不同的8碱基对DNA序列。为了确定偏好的结合位点，对这些序列进行了多序列比对（MSA）。\n\n根据MSA，计算了8个位置上每个碱基的频率，如下表所示：\n\n| 位置 | A的频率 | C的频率 | G的频率 | T的频率 |\n|:----:|:-------:|:-------:|:-------:|:-------:|\n|   1  |  0.05   |  0.85   |  0.05   |  0.05   |\n|   2  |  0.90   |  0.02   |  0.05   |  0.03   |\n|   3  |  0.01   |  0.01   |  0.97   |  0.01   |\n|   4  |  0.40   |  0.25   |  0.25   |  0.10   |\n|   5  |  0.10   |  0.20   |  0.30   |  0.40   |\n|   6  |  0.95   |  0.02   |  0.01   |  0.02   |\n|   7  |  0.05   |  0.90   |  0.03   |  0.02   |\n|   8  |  0.10   |  0.05   |  0.80   |  0.05   |\n\n通过在每个位置选择最常见的碱基，构建了一条“简单共有”序列。然而，当这条简单共有序列被合成并用于结合实验测试时，它未能显示出与该转录因子有任何显著的亲和力。\n\n首席科学家假设，序列保守性低（即变异性高）的位置可能出于结构原因或为避免负面相互作用而需要一个非优势碱基。为了检验这一假设，您的任务是根据以下规则设计一条“功能加权共有序列”：\n\n1.  对于每个位置 $i$（从1到8），计算信息量 $R_i$。信息量由公式 $R_i = \\log_2(4) - H_i$ 给出，其中 $H_i$ 是该位置的香农熵 (Shannon entropy)。\n2.  香农熵的计算公式为 $H_i = -\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b} \\log_2(p_{i,b})$，其中 $p_{i,b}$ 是碱基 $b$ 在位置 $i$ 的频率。在此计算中，约定当 $p=0$ 时，$p \\log_2(p) = 0$。\n3.  对于每个位置 $i$：\n    a. 如果信息量 $R_i$ 大于或等于阈值 $1.0$ 比特，则选择最常见的碱基。\n    b. 如果信息量 $R_i$ 小于 $1.0$ 比特，则选择*第二*常见的碱基。\n4.  如果最常见或第二常见的碱基存在并列情况，则选择按字母顺序（A、C、G、T）排在最前面的那个碱基。\n\n确定这条8碱基对的功能加权共有序列。", "solution": "我们已知在每个位置 $i \\in \\{1,\\dots,8\\}$ 上，对于碱基 $b \\in \\{A,C,G,T\\}$ 的频率为 $p_{i,b}$。对于每个位置，计算香农熵\n$$\nH_{i}=-\\sum_{b \\in \\{A,C,G,T\\}} p_{i,b}\\log_{2}\\left(p_{i,b}\\right),\n$$\n约定当 $p=0$ 时，$p\\log_{2}(p)=0$，以及信息量\n$$\nR_{i}=\\log_{2}(4)-H_{i}=2-H_{i}.\n$$\n选择规则：如果 $R_{i}\\geq 1.0$ 比特，选择最常见的碱基；如果 $R_{i}  1.0$ 比特，选择第二常见的碱基；按字母顺序（A、C、G、T）解决并列问题。\n\n位置 $1$：$p=(0.05,0.85,0.05,0.05)$。\n$$\nH_{1}=-\\big(0.05\\log_{2}0.05+0.85\\log_{2}0.85+0.05\\log_{2}0.05+0.05\\log_{2}0.05\\big)\\approx 0.8476,\n$$\n所以 $R_{1}=2-0.8476\\approx 1.1524\\geq 1.0$。选择最常见的碱基：$C$。\n\n位置 $2$：$p=(0.90,0.02,0.05,0.03)$。\n$$\nH_{2}\\approx -\\big(0.90\\log_{2}0.90+0.02\\log_{2}0.02+0.05\\log_{2}0.05+0.03\\log_{2}0.03\\big)\\approx 0.6175,\n$$\n所以 $R_{2}\\approx 1.3825\\geq 1.0$。选择最常见的碱基：$A$。\n\n位置 $3$：$p=(0.01,0.01,0.97,0.01)$。\n$$\nH_{3}\\approx -\\big(0.01\\log_{2}0.01+0.01\\log_{2}0.01+0.97\\log_{2}0.97+0.01\\log_{2}0.01\\big)\\approx 0.2417,\n$$\n所以 $R_{3}\\approx 1.7583\\geq 1.0$。选择最常见的碱基：$G$。\n\n位置 $4$：$p=(0.40,0.25,0.25,0.10)$。\n$$\nH_{4}= -\\big(0.40\\log_{2}0.40+0.25\\log_{2}0.25+0.25\\log_{2}0.25+0.10\\log_{2}0.10\\big)\\approx 1.8610,\n$$\n所以 $R_{4}\\approx 0.1390  1.0$。选择第二常见的碱基。频率最高的是 $A$ 的 $0.40$（最高），其次是 $C$ 和 $G$ 的 $0.25$（第二，并列）。按字母顺序解决并列，因此选择 $C$。\n\n位置 $5$：$p=(0.10,0.20,0.30,0.40)$。\n$$\nH_{5}= -\\big(0.10\\log_{2}0.10+0.20\\log_{2}0.20+0.30\\log_{2}0.30+0.40\\log_{2}0.40\\big)\\approx 1.8464,\n$$\n所以 $R_{5}\\approx 0.1536  1.0$。选择第二常见的碱基。频率排序为 $0.40$（最高，$T$），$0.30$（第二，$G$），$0.20$（$C$），$0.10$（$A$）。选择 $G$。\n\n位置 $6$：$p=(0.95,0.02,0.01,0.02)$。\n$$\nH_{6}\\approx -\\big(0.95\\log_{2}0.95+0.02\\log_{2}0.02+0.01\\log_{2}0.01+0.02\\log_{2}0.02\\big)\\approx 0.3616,\n$$\n所以 $R_{6}\\approx 1.6384\\geq 1.0$。选择最常见的碱基：$A$。\n\n位置 $7$：$p=(0.05,0.90,0.03,0.02)$。\n$$\nH_{7}\\approx -\\big(0.05\\log_{2}0.05+0.90\\log_{2}0.90+0.03\\log_{2}0.03+0.02\\log_{2}0.02\\big)\\approx 0.6175,\n$$\n所以 $R_{7}\\approx 1.3825\\geq 1.0$。选择最常见的碱基：$C$。\n\n位置 $8$：$p=(0.10,0.05,0.80,0.05)$。\n$$\nH_{8}= -\\big(0.10\\log_{2}0.10+0.05\\log_{2}0.05+0.80\\log_{2}0.80+0.05\\log_{2}0.05\\big)\\approx 1.0219,\n$$\n所以 $R_{8}\\approx 0.9781  1.0$。选择第二常见的碱基。频率排序为 $0.80$（最高，$G$），$0.10$（第二，$A$），$0.05$（$C$ 和 $T$）。选择 $A$。\n\n按位置收集所选碱基，得到功能加权共有序列：$C,A,G,C,G,A,C,A$，即 $CAGCGACA$。", "answer": "$$\\boxed{CAGCGACA}$$", "id": "2121521"}]}