{"hands_on_practices": [{"introduction": "序列比对的质量可以通过评分系统来量化。这个分数是生物信息学算法用来确定两个序列间“最佳”比对方式的核心。本练习将通过一个简单的评分方案，带你实践计算一个给定比对的总分，这是理解更复杂比对算法如何工作的基础。", "problem": "在生物信息学中，序列比对是比较两个或多个生物序列的一种基本方法。比对的质量通常通过评分系统进行量化。考虑以下两个短肽序列的有间隙比对，它们使用标准的单字母氨基酸代码表示。连字符（`-`）用于表示一个间隙。\n\n序列 1: `M A V L I S Q R T V K`\n序列 2: `M G V L - S R Q T - K`\n\n采用一个简单的评分方案来评估此比对。规则如下：\n- 匹配，即一列中的氨基酸相同，得分为 `+5`。\n- 错配，即一列中的氨基酸不同，得分为 `-3`。\n- 间隙，即一个氨基酸与一个间隙字符（`-`）对齐，罚分为 `-8`。\n\n基于此评分方案，计算给定双序列比对的总比对分数。", "solution": "为了计算总比对分数，我们需要逐列分析比对，并根据所提供的评分方案对每个位置的分数进行求和。\n\n给定的比对是：\n序列 1: `M A V L I S Q R T V K`\n序列 2: `M G V L - S R Q T - K`\n\n评分规则为：\n- 匹配得分 = `+5`\n- 错配得分 = `-3`\n- 间隙罚分 = `-8`\n\n让我们遍历比对的11列，并确定每个位置的比对类型（匹配、错配或间隙）。\n\n1.  位置 1: `M` vs `M`。这是一个**匹配**。\n2.  位置 2: `A` vs `G`。这是一个**错配**。\n3.  位置 3: `V` vs `V`。这是一个**匹配**。\n4.  位置 4: `L` vs `L`。这是一个**匹配**。\n5.  位置 5: `I` vs `-`。这是一个**间隙**。\n6.  位置 6: `S` vs `S`。这是一个**匹配**。\n7.  位置 7: `Q` vs `R`。这是一个**错配**。\n8.  位置 8: `R` vs `Q`。这是一个**错配**。\n9.  位置 9: `T` vs `T`。这是一个**匹配**。\n10. 位置 10: `V` vs `-`。这是一个**间隙**。\n11. 位置 11: `K` vs `K`。这是一个**匹配**。\n\n接下来，我们计算匹配、错配和间隙的总数。\n-   匹配数 = 6（在位置 1、3、4、6、9、11）\n-   错配数 = 3（在位置 2、7、8）\n-   间隙数 = 2（在位置 5、10）\n\n现在，我们通过将各项计数乘以其各自的分数然后求和来计算总分。\n\n总分 = (匹配数 * 匹配得分) + (错配数 * 错配得分) + (间隙数 * 间隙罚分)\n\n代入数值：\n总分 = $(6 \\times 5) + (3 \\times (-3)) + (2 \\times (-8))$\n总分 = $30 - 9 - 16$\n总分 = $21 - 16$\n总分 = $5$\n\n因此，给定比对的总比对分数为 5。", "answer": "$$\\boxed{5}$$", "id": "2136319"}, {"introduction": "我们已经知道如何为一个给定的比对计算分数，但算法是如何在无数种可能的比对中找到得分最高的那一个呢？动态规划为此提供了高效的解决方案。本练习聚焦于 Needleman-Wunsch 算法的核心，通过计算动态规划矩阵中单个单元格的分数，揭示了最优比对分数是如何通过一系列局部最优决策逐步构建起来的。", "problem": "在生物信息学中，Needleman-Wunsch 算法是用于全局序列比对的一种基本方法。它依赖于一种动态规划方法来找到两条序列之间的最优比对得分。该算法会填充一个矩阵 $S$，其中每个单元格 $S_{i,j}$ 存储了序列 A 的前 $i$ 个字符与序列 B 的前 $j$ 个字符的最优比对得分。\n\n单元格 $S_{i,j}$ 的得分由其相邻单元格的得分决定：左上角（对角线）单元格 $S_{i-1,j-1}$、上方单元格 $S_{i-1,j}$ 和左侧单元格 $S_{i,j-1}$。其递推关系如下：\n$$S_{i,j} = \\max \\begin{cases} S_{i-1, j-1} + \\text{score}(a_i, b_j)  \\text{(比对 } a_i \\text{ 和 } b_j\\text{)} \\\\ S_{i-1, j} + d  \\text{(序列 B 中出现空位)} \\\\ S_{i, j-1} + d  \\text{(序列 A 中出现空位)} \\end{cases}$$\n其中，$a_i$ 是序列 A 的第 $i$ 个字符，$b_j$ 是序列 B 的第 $j$ 个字符，$\\text{score}(a_i, b_j)$ 是比对这两个字符的得分，$d$ 是恒定的空位罚分。\n\n假设您正在计算单元格 $S_{i,j}$ 的值，并拥有以下信息：\n- 对角单元格的得分是 $S_{i-1,j-1} = 15$。\n- 上方单元格的得分是 $S_{i-1,j} = 9$。\n- 左侧单元格的得分是 $S_{i,j-1} = 11$。\n- 序列 A 在位置 $i$ 的氨基酸是亮氨酸 (L)。\n- 序列 B 在位置 $j$ 的氨基酸是异亮氨酸 (I)。\n- 得分系统定义为：匹配得 +7，错配得 -4。\n- 线性空位罚分为 $d = -10$。\n\n根据这些值，确定单元格 $S_{i,j}$ 的得分。", "solution": "我们使用 Needleman-Wunsch 动态规划递推公式：\n$$S_{i,j}=\\max\\left\\{S_{i-1,j-1}+\\text{score}(a_{i},b_{j}),\\; S_{i-1,j}+d,\\; S_{i,j-1}+d\\right\\}.$$\n已知 $a_{i}=\\text{L}$ 和 $b_{j}=\\text{I}$，由于 $\\text{L}\\neq\\text{I}$，这是一个错配，所以\n$\\text{score}(a_{i},b_{j})=-4$。\n根据 $S_{i-1,j-1}=15$、$S_{i-1,j}=9$、$S_{i,j-1}=11$ 和 $d=-10$，三个候选得分分别是\n- 对角线：$S_{i-1,j-1}+\\text{score}(a_{i},b_{j})=15+(-4)=11$\n- 上方（B中空位）：$S_{i-1,j}+d=9+(-10)=-1$\n- 左侧（A中空位）：$S_{i,j-1}+d=11+(-10)=1$\n\n取最大值，\n$$S_{i,j}=\\max\\{11,-1,1\\}=11.$$\n因此，单元格 $S_{i,j}$ 的得分是 $11$。", "answer": "$$\\boxed{11}$$", "id": "2136340"}, {"introduction": "在实际的生物学研究中，我们有时会拥有额外的实验证据，例如特定残基之间存在相互作用。将这些外部信息作为约束整合到序列比对中，可以帮助我们找到更具生物学意义的结果。这个高级练习 ([@problem_id:2136318]) 演示了一种强大的技巧，它将一个复杂的带约束比对问题分解为几个更简单的标准比对子问题，从而展示了动态规划方法的灵活性和威力。", "problem": "在结构生物学中，有时实验证据（例如来自化学交联实验的证据）表明，来自两个相互作用的蛋白质的两个特定残基（每个蛋白质各一个）在空间上非常接近。这提供了一个强有力的约束，可以被整合到序列比对算法中，以指导寻找更具生物学意义的比对。\n\n考虑两个蛋白质序列，$X$ 和 $Y$：\n$X = \\text{PAWHEAE}$\n$Y = \\text{HEAGAWGHE}$\n\n您的任务是在一个特定约束下，找到序列 $X$ 和 $Y$ 之间的最优全局比对得分：序列 $X$ 的第三个残基（色氨酸，'W'）必须与序列 $Y$ 的第四个残基（甘氨酸，'G'）对齐。\n\n评分系统由线性空位罚分 $d=8$（即每个空位位置得分为 $-8$）和以下替换矩阵 $S(a, b)$ 定义：\n\n| | A | G | E | H | P | W |\n| :--- | :-: | :-: | :-: | :-: | :-: | :-: |\n| **A** | +4 | -2 | -1 | -2 | -1 | -3 |\n| **G** | -2 | +6 | -2 | -2 | -2 | -2 |\n| **E** | -1 | -2 | +5 | -2 | 0 | -3 |\n| **H** | -2 | -2 | -2 | +8 | -2 | -2 |\n| **P** | -1 | -2 | 0 | -2 | +7 | -4 |\n| **W** | -3 | -2 | -3 | -2 | -4 | +11 |\n\n计算满足指定约束的最优全局比对的得分。最终答案应为一个整数。", "solution": "设 $X=\\text{PAWHEAE}$ 且 $Y=\\text{HEAGAWGHE}$，约束条件为 $X_{3}=\\text{W}$ 必须与 $Y_{4}=\\text{G}$ 对齐。给定线性空位罚分 $d=8$ 和替换得分 $S(\\cdot,\\cdot)$，任何满足该约束的全局比对都可以唯一地分解为：\n- 前缀 $X_{1..2}=\\text{PA}$ 与 $Y_{1..3}=\\text{HEA}$ 的全局比对，\n- 锚定列 $(\\text{W},\\text{G})$，贡献得分 $S(\\text{W},\\text{G})$，\n- 后缀 $X_{4..7}=\\text{HEAE}$ 与 $Y_{5..9}=\\text{AGWHE}$ 的全局比对。\n\n因此，最优约束得分为\n$$\n\\text{得分}=\\underbrace{\\text{NW}(\\text{PA},\\text{HEA})}_{\\text{左侧}}+S(\\text{W},\\text{G})+\\underbrace{\\text{NW}(\\text{HEAE},\\text{AGWHE})}_{\\text{右侧}},\n$$\n其中 $\\text{NW}$ 表示最优Needleman–Wunsch全局比对得分，其递推关系为\n$$\nF(0,0)=0,\\quad F(i,0)=-di,\\quad F(0,j)=-dj,\n$$\n$$\nF(i,j)=\\max\\{F(i-1,j-1)+S(x_{i},y_{j}),\\;F(i-1,j)-d,\\;F(i,j-1)-d\\}.\n$$\n\n计算左侧子问题 $\\text{NW}(\\text{PA},\\text{HEA})$，其中 $d=8$。所需的替换得分为 $S(\\text{P},\\text{H})=-2$, $S(\\text{P},\\text{E})=0$, $S(\\text{P},\\text{A})=-1$, $S(\\text{A},\\text{H})=-2$, $S(\\text{A},\\text{E})=-1$, $S(\\text{A},\\text{A})=4$。初始化 $F(0,0)=0$, $F(0,1)=-8$, $F(0,2)=-16$, $F(0,3)=-24$, $F(1,0)=-8$, $F(2,0)=-16$。然后：\n- $F(1,1)=\\max\\{-2,-16,-16\\}=-2$,\n- $F(1,2)=\\max\\{-8,-24,-10\\}=-8$,\n- $F(1,3)=\\max\\{-17,-32,-16\\}=-16$,\n- $F(2,1)=\\max\\{-10,-10,-24\\}=-10$,\n- $F(2,2)=\\max\\{-3,-16,-18\\}=-3$,\n- $F(2,3)=\\max\\{-4,-24,-11\\}=-4$.\n\n因此 $\\text{NW}(\\text{PA},\\text{HEA})=F(2,3)=-4$。\n\n锚定列贡献得分为 $S(\\text{W},\\text{G})=-2$。\n\n计算右侧子问题 $\\text{NW}(\\text{HEAE},\\text{AGWHE})$，其中 $d=8$。所需的得分包括 $S(\\text{H},\\text{A})=-2$, $S(\\text{H},\\text{G})=-2$, $S(\\text{H},\\text{W})=-2$, $S(\\text{H},\\text{H})=8$, $S(\\text{H},\\text{E})=-2$, $S(\\text{E},\\text{A})=-1$, $S(\\text{E},\\text{G})=-2$, $S(\\text{E},\\text{W})=-3$, $S(\\text{E},\\text{H})=-2$, $S(\\text{E},\\text{E})=5$, $S(\\text{A},\\text{A})=4$, $S(\\text{A},\\text{G})=-2$, $S(\\text{A},\\text{W})=-3$, $S(\\text{A},\\text{H})=-2$, $S(\\text{A},\\text{E})=-1$。初始化 $F(0,j)=-8j$ (对于 $j=0,\\dots,5$) 和 $F(i,0)=-8i$ (对于 $i=0,\\dots,4$)。填充DP矩阵：\n\n行 $i=1$ ($x_{1}=\\text{H}$):\n- $F(1,1)=\\max\\{-2,-16,-16\\}=-2$,\n- $F(1,2)=\\max\\{-10,-24,-10\\}=-10$,\n- $F(1,3)=\\max\\{-18,-32,-18\\}=-18$,\n- $F(1,4)=\\max\\{-16,-40,-26\\}=-16$,\n- $F(1,5)=\\max\\{-34,-48,-24\\}=-24$.\n\n行 $i=2$ ($x_{2}=\\text{E}$):\n- $F(2,1)=\\max\\{-9,-10,-24\\}=-9$,\n- $F(2,2)=\\max\\{-4,-18,-17\\}=-4$,\n- $F(2,3)=\\max\\{-13,-26,-12\\}=-12$,\n- $F(2,4)=\\max\\{-20,-24,-20\\}=-20$,\n- $F(2,5)=\\max\\{-11,-32,-28\\}=-11$.\n\n行 $i=3$ ($x_{3}=\\text{A}$):\n- $F(3,1)=\\max\\{-12,-17,-32\\}=-12$,\n- $F(3,2)=\\max\\{-11,-12,-20\\}=-11$,\n- $F(3,3)=\\max\\{-7,-20,-19\\}=-7$,\n- $F(3,4)=\\max\\{-14,-28,-15\\}=-14$,\n- $F(3,5)=\\max\\{-21,-19,-22\\}=-19$.\n\n行 $i=4$ ($x_{4}=\\text{E}$):\n- $F(4,1)=\\max\\{-25,-20,-40\\}=-20$,\n- $F(4,2)=\\max\\{-14,-19,-28\\}=-14$,\n- $F(4,3)=\\max\\{-14,-15,-22\\}=-14$,\n- $F(4,4)=\\max\\{-9,-22,-22\\}=-9$,\n- $F(4,5)=\\max\\{-9,-27,-17\\}=-9$.\n\n因此 $\\text{NW}(\\text{HEAE},\\text{AGWHE})=F(4,5)=-9$。\n\n将所有部分相加得到\n$$\n\\text{得分}=(-4)+(-2)+(-9)=-15.\n$$", "answer": "$$\\boxed{-15}$$", "id": "2136318"}]}