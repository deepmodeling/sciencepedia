{"hands_on_practices": [{"introduction": "单细胞RNA测序实验的成功不仅取决于先进的实验技术和计算方法，更始于周密的设计。在资源（如经费）有限的现实情况下，研究者必须在两个关键变量之间做出权衡：每个细胞的测序深度和分析的总细胞数量。这项练习将引导你模拟一个真实的科研场景，通过计算来确定最佳实验方案，以在固定预算内最大限度地提高发现稀有细胞类型的机会[@problem_id:2350884]。", "problem": "一位神经科学家正在计划进行一项单细胞RNA测序（scRNA-seq）实验，以发现小鼠海马体中一种假设存在的罕见抑制性中间神经元群体。根据初步数据，她估计这种罕见的细胞类型约占解剖组织中所有细胞的0.1%。她的实验室为这项特定实验准备了10,000美元的固定预算。\n\n实验的总成本包括两个主要部分：\n1.  **细胞制备成本**：这包括细胞解离、捕获和文库制备。成本为每细胞1.00美元。\n2.  **测序成本**：对制备好的文库进行测序的成本为每百万测序读数5.00美元。每个细胞至少20,000个读数的测序深度被认为是可靠识别主要细胞类型的最低要求。\n\n主要的科学目标是捕获足够数量的罕见中间神经元，以便在计算分析后能自信地将它们识别为一个独立的细胞簇。考虑到预算和科学目标，以下哪种实验设计是最佳方案？\n\nA. 分析2,000个细胞，平均测序深度为每个细胞100,000个读数。\n\nB. 分析8,000个细胞，平均测序深度为每个细胞25,000个读数。\n\nC. 分析5,000个细胞，平均测序深度为每个细胞50,000个读数。\n\nD. 分析8,000个细胞，平均测序深度为每个细胞100,000个读数。\n\nE. 分析100个细胞，平均测序深度为每个细胞1,000,000个读数。", "solution": "设稀有细胞比例为 $p=0.001$，总预算为 $B=10000$，每个细胞的制备成本为 $c_{\\text{prep}}=1$，每百万读数的测序成本为 $c_{\\text{seqM}}=5$，每个细胞所需的最低测序深度为 $r_{\\min}=20000$。\n\n对于一个包含 $N$ 个细胞、平均每个细胞有 $r$ 个读数的设计，总读数为\n$$\nR = N r,\n$$\n测序成本为\n$$\nC_{\\text{seq}} = \\frac{R}{10^{6}} \\, c_{\\text{seqM}},\n$$\n制备成本为\n$$\nC_{\\text{prep}} = N \\, c_{\\text{prep}},\n$$\n总成本为\n$$\nC = C_{\\text{prep}} + C_{\\text{seq}}.\n$$\n可行性要求 $C \\leq B$ 且 $r \\geq r_{\\min}$。捕获到的稀有细胞的期望数量为\n$$\n\\mathbb{E}[X] = p N,\n$$\n因此，在满足 $r \\geq r_{\\min}$ 的可行选项中，最大化 $N$ 就能最大化 $\\mathbb{E}[X]$，从而最大化识别稀有细胞簇的能力，前提是测序深度不低于阈值。\n\n评估每个选项：\n\n选项 A: $N=2000$, $r=100000$。\n$$\nR=2000 \\times 100000 = 2 \\times 10^{8},\\quad C_{\\text{seq}}=\\frac{2 \\times 10^{8}}{10^{6}} \\times 5 = 200 \\times 5 = 1000,\n$$\n$$\nC_{\\text{prep}}=2000 \\times 1=2000,\\quad C=2000+1000=3000 \\leq 10000,\\quad r=100000 \\geq 20000,\n$$\n$$\n\\mathbb{E}[X]=0.001 \\times 2000=2.\n$$\n\n选项 B: $N=8000$, $r=25000$。\n$$\nR=8000 \\times 25000 = 2 \\times 10^{8},\\quad C_{\\text{seq}}=\\frac{2 \\times 10^{8}}{10^{6}} \\times 5 = 1000,\n$$\n$$\nC_{\\text{prep}}=8000 \\times 1=8000,\\quad C=8000+1000=9000 \\leq 10000,\\quad r=25000 \\geq 20000,\n$$\n$$\n\\mathbb{E}[X]=0.001 \\times 8000=8.\n$$\n\n选项 C: $N=5000$, $r=50000$。\n$$\nR=5000 \\times 50000 = 2.5 \\times 10^{8},\\quad C_{\\text{seq}}=\\frac{2.5 \\times 10^{8}}{10^{6}} \\times 5 = 250 \\times 5 = 1250,\n$$\n$$\nC_{\\text{prep}}=5000 \\times 1=5000,\\quad C=5000+1250=6250 \\leq 10000,\\quad r=50000 \\geq 20000,\n$$\n$$\n\\mathbb{E}[X]=0.001 \\times 5000=5.\n$$\n\n选项 D: $N=8000$, $r=100000$。\n$$\nR=8000 \\times 100000 = 8 \\times 10^{8},\\quad C_{\\text{seq}}=\\frac{8 \\times 10^{8}}{10^{6}} \\times 5 = 800 \\times 5 = 4000,\n$$\n$$\nC_{\\text{prep}}=8000 \\times 1=8000,\\quad C=8000+4000=12000 > 10000,\n$$\n不可行。\n\n选项 E: $N=100$, $r=1000000$。\n$$\nR=100 \\times 1000000 = 1 \\times 10^{8},\\quad C_{\\text{seq}}=\\frac{1 \\times 10^{8}}{10^{6}} \\times 5 = 100 \\times 5 = 500,\n$$\n$$\nC_{\\text{prep}}=100 \\times 1=100,\\quad C=100+500=600 \\leq 10000,\\quad r=1000000 \\geq 20000,\n$$\n$$\n\\mathbb{E}[X]=0.001 \\times 100=0.1.\n$$\n\n在可行选项（A、B、C、E）中，预期的稀有细胞计数分别为 $2$、$8$、$5$ 和 $0.1$。所有这些都满足 $r \\geq r_{\\min}$。因此，最能满足捕获足够稀有中间神经元这一科学目标的设计，是在保持最低测序深度的前提下拥有最大 $N$ 值的方案，即选项B。", "answer": "$$\\boxed{B}$$", "id": "2350884"}, {"introduction": "获得原始测序数据后，第一步并非直接进行细胞分型，而是严格的质量控制，以剔除低质量或濒死的细胞，避免它们对结果产生干扰。一个普遍使用的质控指标是线粒体基因的表达比例。本练习探讨了一个核心问题：为什么线粒体基因表达比例异常高的细胞通常被视为质量不佳的细胞而被过滤掉，这背后隐藏着怎样的生物学原理？[@problem_id:2350931]。", "problem": "一位神经科学家正在对来自单细胞RNA测序 (scRNA-seq) 实验的数据集进行质量控制分析。该实验旨在鉴定小鼠海马体中的不同细胞类型。scRNA-seq的过程包括将组织解离成单个细胞，然后捕获每个细胞的信使RNA (mRNA)，以测量其基因表达谱，即转录组。\n\n在分析过程中，科学家观察到一小部分捕获的细胞中，映射到线粒体基因组编码基因的转录本百分比异常高，有时甚至超过该细胞总转录本的30-40%，而绝大多数看起来健康的细胞的线粒体转录本百分比低于5%。根据标准做法，科学家在进行细胞类型分类之前，会从数据集中筛选并移除这些高线粒体百分比的细胞。\n\n过滤掉线粒体基因表达百分比异常高的细胞，其最可能的生物学原因是什么？\n\nA. 这些细胞是一种罕见的神经元亚型，其特点是代谢率极高，移除它们是为了避免分析偏向于这种特定的细胞类型。\n\nB. 这些细胞很可能已受损或正在死亡（经历细胞凋亡），在这种状态下，细胞质mRNA会丢失，而线粒体mRNA相对保留，从而人为地增加了其相对丰度。\n\nC. 这些细胞被解离过程中其他破裂细胞释放的游离线粒体污染了，这意味着测得的转录组并非来自单个细胞。\n\nD. 高百分比是一种已知的技术性假象，即用于逆转录的试剂对线粒体mRNA序列的亲和力远高于对核编码mRNA的亲和力。\n\nE. 这些细胞代表了一个以线粒体生物合成为主导细胞过程的发育阶段，而这些前体细胞与成年海马体的研究无关。", "solution": "我们使用标准的单细胞RNA测序质量控制原则来分析这一观察结果。映射到线粒体基因的读段（reads）比例高，被广泛用作细胞完整性受损的指标。当细胞受损或经历细胞凋亡时，细胞质膜的完整性会丧失，细胞质内容物（包括核编码的mRNA）会扩散出去或被降解，导致细胞质mRNA总含量下降。线粒体被双层膜包裹，在早期损伤过程中倾向于更好地保留其转录本，因此线粒体mRNA在这些受损细胞中相对得以保存。因此，即使线粒体RNA的绝对量没有增加，其在剩余捕获的RNA中所占的比例也会上升。这导致细胞的线粒体转录本比例可达到$0.30$到$0.40$，而健康细胞的这一数值通常低于$0.05$。因此，过滤这些细胞是为了移除那些转录组不能代表生理细胞状态的受损或垂死细胞。\n\n评估各个选项：\n- 选项A不太可能，因为即使是具有高代谢率的神经元，其线粒体基因组编码的转录本也不会在其多聚腺苷酸化mRNA中占主导地位；大多数氧化磷酸化组分是核编码的。仅仅因为线粒体比例高而移除一个合法的罕见亚型是不恰当的，这也不是该质控筛选的基本原理。\n- 选项B符合标准的生物学原理：高线粒体比例表明细胞受损或处于凋亡状态，此时细胞质mRNA的丢失会夸大线粒体的相对比例。\n- 选项C与所描述的情况不太一致；虽然环境RNA或偶然的细胞器污染会影响液滴，但对于捕获细胞内高线粒体比例的标准解释是细胞损伤，而不是外源性线粒体在文库中占主导。\n- 选项D不正确；没有标准的技技术性假象表明逆转录会优先扩增所有细胞中的线粒体mRNA从而产生这种模式。高线粒体比例与其他损伤标志物的相关性支持这是一个基于生物学而非试剂的解释。\n- 选项E对于成年海马体来说是不太可能的，而且，线粒体生物合成不会导致线粒体基因组转录本占总mRNA的$0.30$到$0.40$。\n\n因此，支持进行此项筛选的最可能的生物学原因是，这些细胞已受损或正在死亡，导致线粒体转录本的相对丰度被人为抬高。", "answer": "$$\\boxed{B}$$", "id": "2350931"}, {"introduction": "初步的单细胞分析通常能区分开主要的细胞类别，如神经元和胶质细胞，但可能无法揭示某一类别内部的精细亚型。当你在UMAP图上观察到一个形态弥散、可能暗示着内部异质性的大细胞簇时，下一步该如何操作？这项练习将指导你学习一种重要的计算策略——“子集聚类”（sub-clustering），通过对特定细胞群体进行二次分析，从而提升分辨率，发掘隐藏在主细胞类型之下的细胞亚型[@problem_id:2350918]。", "problem": "一个研究团队正在使用单细胞RNA测序（scRNA-seq）技术研究成年小鼠海马体中的细胞多样性。在处理原始测序数据后，他们进行了一套标准的计算分析流程，包括数据标准化、高变基因的识别、使用主成分分析（PCA）进行降维，以及最后的细胞聚类。聚类结果通过均匀流形逼近与投影（UMAP）进行可视化。\n\n这项初步分析成功地区分了主要的细胞类型，包括神经元、小胶质细胞和少突胶质细胞。其中一个特别大且弥散的细胞簇，因其内部所有细胞都稳定且特异性地表达星形胶质细胞的经典标记基因 *Aldh1l1*，而被确认为代表星形胶质细胞。研究人员假设，这个UMAP簇的宽泛、分散的特性表明存在多种转录上不同的星形胶质细胞亚型，而这些亚型在对整个数据集的初步粗粒度分析中未能被解析出来。\n\n为了验证这一假设并更好地解析星形胶质细胞群体内的异质性，该团队利用其现有数据集应采取的最合适、最有针对性的下一步计算分析步骤是什么？\n\nA. 在星形胶质细胞簇与所有其他非星形胶质细胞簇的组合之间进行差异基因表达分析，以鉴定一个更全面的泛星形胶质细胞特异性基因列表。\n\nB. 使用另一种算法，如t-分布随机邻域嵌入（t-SNE），对完整数据集的聚类结果进行重新可视化，希望能通过视觉方式区分出星形胶质细胞的亚型。\n\nC. 结论认为该弥散簇是由细胞捕获效果不佳引起的技术性假象，并在重新运行整个分析流程之前移除属于该簇的所有细胞。\n\nD. 分离出已识别的星形胶质细胞簇中的细胞，创建一个新的、子集化的数据对象，然后仅对这个只包含星形胶质细胞的子集重新执行分析流程（即重新计算高变基因、重新运行PCA和重新聚类）。\n\nE. 回到对完整数据集的原始分析，简单地增加聚类算法的分辨率参数，从而强制在所有细胞类型中生成更多数量的更小的细胞簇。", "solution": "目标：解析一个稳定表达经典星形胶质细胞标记物Aldh1l1的、大而弥散的UMAP簇所提示的星形胶质细胞亚型异质性。\n\n步骤1：解读观察结果并明确分析需求。\n- 弥散簇中Aldh1l1的稳定、特异性表达支持这些细胞是真实的星形胶质细胞，而非技术性假象。\n- UMAP上的弥散性通常反映了连续或多分支的转录变异。要解析这种细胞类型内部的异质性，需要将方差建模和降维分析聚焦于该特定细胞类型。\n\n步骤2：应用scRNA-seq中方差建模和降维的核心原则。\n- 在标准工作流程中，对整个数据集进行高变基因（HVG）筛选时，其结果主要由不同细胞类型间的差异所主导。因此，$G_{\\text{HVG,global}}$ 强调的是区分神经元、小胶质细胞、少突胶质细胞和星形胶质细胞的基因，而不是在星形胶质细胞内部存在变异的基因。\n- 为了解析星形胶质细胞内部的结构，必须在星形胶质细胞子集内重新计算 $G_{\\text{HVG}}$，即 $G_{\\text{HVG,astro}}$，然后在仅包含星形胶质细胞且限定于 $G_{\\text{HVG,astro}}$ 的表达矩阵上重新运行PCA，构建星形胶质细胞间的 $k$-最近邻图，并对该子集进行聚类和UMAP分析。这提高了对星形胶质细胞特异性变异轴的敏感度，并且是Seurat/Scanpy亚群聚类工作流程中的标准最佳实践。\n\n步骤3：根据分析需求评估所提出的选项。\n- 选项A（星形胶质细胞 vs. 非星形胶质细胞的差异表达分析）：该方法旨在识别泛星形胶质细胞标记物，而非区分星形胶质细胞亚型的基因；它不能提高亚型解析度。\n- 选项B（在完整数据集上切换到t-SNE）：在不针对相关子集重新计算HVG和PCA的情况下更换可视化方法，无法可靠地揭示亚型结构；其底层的特征仍然由全局差异主导。\n- 选项C（将星形胶质细胞簇作为假象丢弃）：与强烈的Aldh1l1表达（表明其为真实星形胶质细胞）相矛盾；在没有证据的情况下移除了具有生物学意义的数据。\n- 选项E（提高全局聚类分辨率）：这会强制在所有细胞类型中生成更多的簇，并有被跨细胞类型HVG驱动而导致过度聚类的风险；它没有针对星形胶质细胞特异性方差，并可能不必要地将其他细胞群体分割成碎片。\n- 选项D（对星形胶质细胞进行子集化并重新运行HVG、PCA、聚类）：通过对星形胶质细胞内部的方差进行建模，直接满足了分析需求，最大限度地提高了检测亚型的能力，是标准的目标性方法。\n\n结论：最合适的下一步是对星形胶质细胞簇进行子集化，并对该子集重新运行完整的分析流程，以解析星形胶质细胞内部的异质性。", "answer": "$$\\boxed{D}$$", "id": "2350918"}]}