{"hands_on_practices": [{"introduction": "下一代测序技术产生了海量的文本数据，其中 FASTQ 是存储测序读段（reads）及其质量评分的标准格式。在开始任何生物信息学分析之前，理解这种四行结构是至关重要的第一步。这个练习将帮助你熟悉 FASTQ 文件的基本布局，并学会如何定位包含关键测序质量信息的数据行，为后续的数据评估和分析奠定基础。[@problem_id:2304575]", "problem": "在基因组学领域，FASTQ格式是一种基于文本的格式，用于存储生物序列（通常是核酸序列）及其相应的质量分数。FASTQ文件中的每个条目由四行组成。序列中每个碱基检出的质量使用Phred质量分数进行编码，该分数与碱基检出错误概率相关。这些分数由单个美国信息交换标准代码（ASCII）字符表示。\n\n考虑以下来自FASTQ文件的单个条目：\n\n第1行：`@SRR123456.789 HWUSI-EAS100R:6:73:941:1973#0/1`\n第2行：`GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT`\n第3行：`+`\n第4行：`!''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65`\n\n下列哪一行包含了序列的Phred质量分数？\n\nA. `@SRR123456.789 HWUSI-EAS100R:6:73:941:1973#0/1`\n\nB. `GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT`\n\nC. `+`\n\nD. `!''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65`", "solution": "我们回顾一下FASTQ格式的结构：\n- 第1行以@字符开头，是序列标识符（标题行）。\n- 第2行包含原始核苷酸序列。\n- 第3行以+开头，是分隔行（可以选择性地重复标识符）。\n- 第4行包含以ASCII字符编码的Phred质量分数，与第2行中的每个碱基一一对应。\n\n将此应用于给定的条目：\n- 第1行： \"@SRR123456.789 HWUSI-EAS100R:6:73:941:1973#0/1\" 是标题行。\n- 第2行： \"GATTTGGGGTTCAAAGCAGTATCGATCAAATAGTAAATCCATTTGTTCAACTCACAGTTT\" 是核苷酸序列。\n- 第3行： \"+\" 是分隔行。\n- 第4行： \"!''*((((***+))%%%++)(%%%%).1***-+*''))**55CCF>>>>>>CCCCCCC65\" 是与序列相对应的ASCII编码的Phred质量分数字符串。\n\n因此，包含Phred质量分数的行是第4行，对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "2304575"}, {"introduction": "在上一个练习中，我们学会了在 FASTQ 文件中定位质量分数的字符串。然而，这些 ASCII 字符本身代表什么？它们编码了 Phred 质量分数（$Q$），这是一个与碱基检出错误概率（$P_e$）呈对数关系的度量。通过这个练习，你将把一个具体的 Phred 分数转换为实际的错误概率，从而对测序数据的可靠性有一个直观和定量的理解。[@problem_id:2304520]", "problem": "在基因组学领域，新一代测序 (NGS) 技术彻底改变了我们读取脱氧核糖核酸 (DNA) 序列的能力。在一次测序运行后，一个读长（read）中的每个碱基识别（A、T、C 或 G）都会被赋予一个质量分数，用以表示其识别置信度。最常用的指标是 Phred 质量分数，记为 $Q$。该分数与碱基识别错误的概率（记为 $P_e$）成对数关系。该关系由以下公式定义：\n$$Q = -10 \\log_{10}(P_e)$$\n一位临床遗传学研究员正在分析一名患者的测序数据，以鉴定一个潜在的致病性单核苷酸多态性 (SNP)。分析软件在一个基因的关键位置上标记了一个特定的碱基。对于这个特定的碱基识别，仪器报告的 Phred 质量分数为 $Q = 20$。\n\n计算这个特定碱基识别错误的概率 $P_e$。请用小数表示您的答案。", "solution": "我们已知 Phred 质量分数的关系式 $Q=-10\\log_{10}(P_{e})$ 以及报告值 $Q=20$。将 $Q=20$ 代入方程，求解 $P_{e}$：\n$$20=-10\\log_{10}(P_{e}).$$\n方程两边同时除以 $-10$：\n$$\\log_{10}(P_{e})=-2.$$\n使用基数 $10$ 将对数方程重写为指数形式：\n$$P_{e}=10^{-2}.$$\n将其表示为小数：\n$$P_{e}=0.01.$$", "answer": "$$\\boxed{0.01}$$", "id": "2304520"}, {"introduction": "除了读取单个碱基序列，下一代测序的双末端测序（paired-end sequencing）策略还能揭示基因组的空间结构信息。通过对已知长度范围的 DNA 碎片的两个末端进行测序，我们可以推断样本基因组相对于参考基因组发生的结构变异。当一对读段在参考基因组上的映射距离远超预期时，这往往预示着样本基因组中存在一个大片段的缺失。这个练习将引导你像一位基因组学家一样思考，利用比对数据来推断复杂基因组变异，展示 NGS 数据在结构变异检测中的强大威力。[@problem_id:2304570]", "problem": "在一个基因组学研究项目中，一位科学家正在使用具有双末端测序策略的新一代测序（NGS）平台分析人类DNA样本。通过片段化基因组DNA来制备DNA文库，并进行大小筛选，以创建一个片段平均长度为 $L_{frag} = 485$ 个碱基对（bp）、标准差为 $\\sigma = 45$ bp的文库。测序仪为每个片段生成一对读段（reads），每个片段的两端各一个。然后将这些读段对与人类参考基因组进行比对。\n\n在分析比对数据时，一个特定的读段对引起了科学家的注意。该读段对中的两个读段都以预期的正向-反向方向唯一地映射到7号染色体上。然而，映射到的位置异常地相距甚远。在参考基因组上，从正向读段最5'端坐标到反向读段最3'端坐标测量的总距离观测值为 $D_{map} = 5320$ bp。\n\n假设这个异常大的映射距离是由DNA样本相对于参考基因组的单个、连续的杂合性缺失引起的，计算这个缺失的大小。以碱基对（bp）为单位表示您的答案。", "solution": "定义 $s$ 为缺失的大小（以碱基对为单位）。在双末端测序中，对于一个没有结构变异的、方向正确的读段对，其在参考基因组上映射的外部距离（从正向读段的最5'端碱基到反向读段的最3'端碱基）等于生成这些读段的DNA分子的物理片段长度。用 $L$ 表示此片段长度。因此，在没有变异的情况下，我们期望\n$$\nD_{map} = L.\n$$\n如果样本中相对于参考基因组存在一个大小为 $s$ 的缺失，并且测序片段跨越了这个缺失，那么参考基因组在两个读段的锚定点之间就包含了一个额外的、长度为 $s$ 的连续片段，而这个片段在样本分子中是不存在的。因此，在参考基因组上映射的距离会增加 $s$：\n$$\nD_{map} = L + s.\n$$\n求解缺失大小可得\n$$\ns = D_{map} - L.\n$$\n对于从文库中抽取的典型片段，$L$ 可以很好地由文库的平均长度 $L_{frag}$ 近似；因此，缺失大小的点估计值为\n$$\n\\hat{s} = D_{map} - L_{frag}.\n$$\n代入给定值 $D_{map} = 5320$ bp 和 $L_{frag} = 485$ bp，\n$$\n\\hat{s} = 5320 - 485 = 4835 \\text{ bp}.\n$$\n所提供的标准差描述了文库插入片段大小的离散程度，但不会改变由这单个异常读段对得出的点估计值。", "answer": "$$\\boxed{4835}$$", "id": "2304570"}]}