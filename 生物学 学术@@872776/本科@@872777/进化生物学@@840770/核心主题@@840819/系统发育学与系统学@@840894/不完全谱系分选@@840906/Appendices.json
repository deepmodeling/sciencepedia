{"hands_on_practices": [{"introduction": "系统发育树是理解物种间演化关系的基础，但单个基因的演化历史（基因树）可能与物种树不一致。这种基因树与物种树拓扑结构之间的冲突，即“不一致性”（discordance），是理解不完全谱系分选（Incomplete Lineage Sorting, ILS）的第一步。本练习通过一个经典的例子——人类、黑猩猩和大猩猩的演化关系，帮助你掌握“一致性”（concordance）与“不一致性”这两个核心定义，为后续深入学习打下基础。[@problem_id:1940289]", "problem": "在进化生物学中，一个物种群体的进化史由一棵物种树表示。然而，单个基因的进化史（被称为基因树）可能并不总是与物种树相匹配。当基因树的拓扑结构与物种树的拓扑结构不同时，它被称为“不一致”(discordant)。造成这种情况的一个主要原因是称为“不完全谱系分选”(Incomplete Lineage Sorting, ILS) 的过程，该过程描述了基因拷贝（等位基因）未能在物种最近的共同祖先种群中溯祖合并，从而导致与物种史相冲突的基因史。当基因树与物种树具有相同的拓扑结构时，它被称为“一致”(concordant)。\n\n考虑三种大型猿类的公认物种系统发育关系：人类 (H)、黑猩猩 (C) 和大猩猩 (G)。物种树显示人类和黑猩猩是姐妹类群，而大猩猩是外类群。这种关系用括号表示法表示为 `((H, C), G)`。\n\n对这三个物종中某一特定基因的基因组分析揭示了其基因树存在三种可能的拓扑关系。根据所提供的物种树 `((H, C), G)`，请将以下三种基因树拓扑结构分类为“一致”(concordant) 或“不一致”(discordant)，并选择正确的选项。\n\n1. `((H, C), G)`\n2. `((H, G), C)`\n3. `((C, G), H)`\n\nA) 一致: 1; 不一致: 2, 3\n\nB) 一致: 2; 不一致: 1, 3\n\nC) 一致: 3; 不一致: 1, 2\n\nD) 一致: 1, 2; 不一致: 3", "solution": "我们已知三个分类单元的物种树：人类 (H)、黑猩猩 (C) 和大猩猩 (G)，其拓扑结构为 $((H, C), G)$。根据定义，当且仅当一个基因树的拓扑结构与物种树完全相同时，它才是一致的，否则就是不一致的。不完全谱系分选 (ILS) 是一个已知的可能导致不一致的机制，但判断一致/不一致的标准严格地是其拓扑结构是否与物种树相等。\n\n评估每个基因树与物种树的对应关系：\n\n1.  基因树 1: `((H, C), G)`。这与物种树 `((H, C), G)` 的拓扑结构完全相同，因此根据定义它是一致的。\n2.  基因树 2: `((H, G), C)`。该拓扑结构与 `((H, C), G)` 不同，因此根据定义它是不一致的。\n3.  基因树 3: `((C, G), H)`。该拓扑结构也与 `((H, C), G)` 不同，因此根据定义它是不一致的。\n\n因此，正确的分类是：一致：1；不一致：2, 3，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1940289"}, {"introduction": "理解了基因树与物种树可能不一致后，下一个关键问题是：这种不一致性发生的概率有多大？多物种溯祖理论为我们提供了量化不完全谱系分选（ILS）的数学工具，揭示了其概率与物种分化间隔时间 $T$ 和祖先有效种群大小 $N_e$ 密切相关。本练习将引导你应用核心的溯祖模型公式，通过计算一个特定场景下的ILS概率，来直观感受这两个关键演化参数如何共同决定基因树的拓扑结构。[@problem_id:1940287]", "problem": "在演化生物学中，特定基因的基因树的分支模式可能与物种树的分支模式不匹配，这种现象被称为不完全谱系分选（Incomplete Lineage Sorting, ILS）。当物种形成事件快速连续发生时，这种不一致性更可能出现，导致基因谱系没有足够的时间分选成交互单系群。\n\n考虑三个近缘物种：A、B和C。物种系统发育表明A和B是姐妹种，它们从一个共同祖先分化出来的时间比它们与物种C分化的时间更晚近。由于ILS导致观察到与此物种树冲突的基因树的概率，可以使用溯祖理论框架进行建模。对于一个对称的三分类单元树，该概率由以下表达式给出：\n$$P(\\text{ILS}) = \\frac{2}{3} \\exp\\left(-\\frac{T}{2N_e}\\right)$$\n此处，$T$ 代表第一个物种形成事件（A和B的祖先从通往C的谱系中分离）与第二个物种形成事件（A和B的分离）之间的时间间隔，以世代为单位。参数 $N_e$ 是此时间间隔内物种A和B的祖先种群的有效种群大小。\n\n假设对这三个物种的一项分析揭示了一个特殊情况，即两个物种形成事件之间的时间间隔 $T$ 正好等于祖先谱系的有效种群大小 $N_e$。根据此信息，计算不完全谱系分选的概率。将最终答案四舍五入到三位有效数字。", "solution": "我们已知一个对称三分类单元物种树的ILS概率为：\n$$\nP(\\text{ILS}) = \\frac{2}{3} \\exp\\left(-\\frac{T}{2N_{e}}\\right)\n$$\n题目告知我们时间间隔等于有效种群大小，所以 $T = N_{e}$。将此代入表达式可得：\n$$\nP(\\text{ILS}) = \\frac{2}{3} \\exp\\left(-\\frac{N_{e}}{2N_{e}}\\right) = \\frac{2}{3} \\exp\\left(-\\frac{1}{2}\\right)\n$$\n为了提供一个四舍五入到三位有效数字的数值，我们计算：\n$$\n\\exp\\left(-\\frac{1}{2}\\right) \\approx 0.60653066\n$$\n因此：\n$$\nP(\\text{ILS}) \\approx \\frac{2}{3} \\times 0.60653066 \\approx 0.40435377\n$$\n四舍五入到三位有效数字可得：\n$$\nP(\\text{ILS}) \\approx 0.404\n$$", "answer": "$$\\boxed{0.404}$$", "id": "1940287"}, {"introduction": "不完全谱系分选（ILS）的一个惊人推论是，在某些特定条件下，最常见的基因树拓扑结构并非是真正的物种树结构，这一参数空间被称为“异常区域”（anomaly zone）。这一现象对仅靠“投票法”（即选择最常见的基因树）来推断物种树的传统方法提出了严峻挑战。本练习将带你探索“异常区域”背后的数学原理，通过计算进入该区域的临界条件，深刻理解极短的内部分支长度如何能够颠覆我们对系统发育信号的直观判断。[@problem_id:1940292]", "problem": "在进化生物学中，多物种溯祖模型被用来描述基因谱系如何在物种树的分支内进行分选。这个过程被称为不完全谱系分选 (Incomplete Lineage Sorting, ILS)，有时可能导致基因树的拓扑结构与物种树不同。一个特别有趣的现象是“异常区域”，这是一个参数空间区域，在此区域中，与物种树拓扑结构相匹配的基因树拓扑结构并非最可能的那一个。\n\n考虑一个包含四个物种（A, B, C, D）的模型，其进化关系由对称物种树 $S = ((A,B),(C,D))$ 描述。在此拓扑结构中，(A,B) 形成一个演化支，(C,D) 形成一个姐妹演化支。通往 A 和 B 共同祖先的内部分支，以及通往 C 和 D 共同祖先的内部分支，长度均为 $x$。连接 (A,B) 演化支和 (C,D) 演化支的祖先的中心内部分支长度为 $y$。所有分支长度均以溯祖单位度量。\n\n在多物种溯祖模型下，这四个物种的三种可能的无根基因树拓扑结构的概率由以下公式给出：\n- $P(T_1|S)$: 一致拓扑结构 $T_1 = ((A,B),(C,D))$ 的概率\n- $P(T_2|S)$: 不一致拓扑结构 $T_2 = ((A,C),(B,D))$ 的概率\n- $P(T_3|S)$: 不一致拓扑结构 $T_3 = ((A,D),(B,C))$ 的概率\n\n这些概率是分支长度 $x$ 和 $y$ 的函数：\n$P(T_1|S) = 1 - \\frac{2}{3}\\exp(-y) - \\frac{1}{3}\\exp(-2x-y)$\n$P(T_2|S) = \\frac{1}{3}\\exp(-y) - \\frac{1}{6}\\exp(-2x-y)$\n$P(T_3|S) = \\frac{1}{3}\\exp(-y) - \\frac{1}{6}\\exp(-2x-y)$\n\n如果一致基因树 $T_1$ 的概率小于至少一个不一致基因树的概率，则称该系统处于异常区域。\n\n假设通过基因组分析，估计末端内部分支长度为 $x = 0.15$ 溯祖单位。计算中心分支长度 $y$（以溯祖单位计）可能的最大值，使得系统落入异常区域。将最终答案四舍五入到四位有效数字。", "solution": "我们已知在多物种溯祖模型下，三种无根基因树拓扑结构的概率为：\n$$P(T_{1}\\mid S)=1-\\frac{2}{3}\\exp(-y)-\\frac{1}{3}\\exp(-2x-y)$$\n$$P(T_{2}\\mid S)=\\frac{1}{3}\\exp(-y)-\\frac{1}{6}\\exp(-2x-y)$$\n$$P(T_{3}\\mid S)=\\frac{1}{3}\\exp(-y)-\\frac{1}{6}\\exp(-2x-y)$$\n系统处于异常区域的条件是，一致拓扑结构的概率小于至少一个不一致拓扑结构的概率。由于 $P(T_{2}\\mid S)=P(T_{3}\\mid S)$，该条件简化为 $P(T_{1}\\mid S)  P(T_{2}\\mid S)$。\n将公式代入不等式：\n$$1-\\frac{2}{3}\\exp(-y)-\\frac{1}{3}\\exp(-2x-y)  \\frac{1}{3}\\exp(-y)-\\frac{1}{6}\\exp(-2x-y)$$\n将与 $y$ 相关的指数项移到不等式右侧，常数项留在左侧：\n$$1  \\left(\\frac{2}{3} + \\frac{1}{3}\\right)\\exp(-y) + \\left(\\frac{1}{3} - \\frac{1}{6}\\right)\\exp(-2x-y)$$\n$$1  \\exp(-y) + \\frac{1}{6}\\exp(-2x-y)$$\n提取公因式 $\\exp(-y)$:\n$$1  \\exp(-y)\\left(1 + \\frac{1}{6}\\exp(-2x)\\right)$$\n为了解出 $y$，我们对不等式两边进行整理：\n$$\\exp(y)  1 + \\frac{1}{6}\\exp(-2x)$$\n$$y  \\ln\\left(1 + \\frac{1}{6}\\exp(-2x)\\right)$$\n该不等式定义了异常区域。要找到 $y$ 可能的最大值，我们计算该不等式的边界。将给定的 $x = 0.15$ 代入：\n$$y_{max} = \\ln\\left(1 + \\frac{1}{6}\\exp(-2 \\times 0.15)\\right) = \\ln\\left(1 + \\frac{1}{6}\\exp(-0.3)\\right)$$\n计算数值：\n$$\\exp(-0.3) \\approx 0.740818$$\n$$y_{max} \\approx \\ln\\left(1 + \\frac{0.740818}{6}\\right) = \\ln(1 + 0.12347) = \\ln(1.12347)$$\n$$y_{max} \\approx 0.11643$$\n将结果四舍五入到四位有效数字，我们得到 $y \\approx 0.1164$。因此，中心分支长度 $y$ 的最大值为 $0.1164$ 溯祖单位，使得系统落入异常区域。", "answer": "$$\\boxed{0.1164}$$", "id": "1940292"}]}