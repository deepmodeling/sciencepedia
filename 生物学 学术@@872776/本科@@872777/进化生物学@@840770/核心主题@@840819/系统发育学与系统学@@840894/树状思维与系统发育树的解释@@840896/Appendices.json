{"hands_on_practices": [{"introduction": "系统发育树上的统计支持度（如自举支持率）是评估进化关系可靠性的关键指标。这项练习旨在培养批判性解读这些数值的能力，这对于评估进化假说和做出明智的分类学决策至关重要。通过这个案例 [@problem_id:1976078]，你将学会区分统计上的稳健性与生物学上的确定性，避免对系统发育分析结果的常见误解。", "problem": "一位演化生物学家正在研究一种新发现的深渊腹足动物属，*Bathyspirula*。传统上，根据螺壳的卷曲模式，已知的五个物种被初步划分为两个亚属：一个包含物种 *A* 和 *B*，另一个包含物种 *C*、*D* 和 *E*。为了检验这一假说，该生物学家对所有五个物种的线粒体基因进行了测序，并构建了一棵系统发育树。\n\n所得的分子系统发育结果强烈支持*Bathyspirula*属相对于其外群的单系性。将物种 *A* 与其余四个物种（*B*、*C*、*D*、*E*）分开的节点的自举支持率为98%。然而，分子数据也揭示了一种与基于形态学的分类相冲突的新关系：物种 *B*、*C* 和 *D* 形成一个独特的支系，而物种 *E* 是其姐妹群。定义这个 (B, C, D) 支系的节点的自举支持率为65%。\n\n基于这一分子结果，一位同事建议正式放弃旧的基于形态学的亚属分类，并建立一个新的分类科“Bathyspirulidae”，对应于 (B, C, D) 支系。考虑到这些相互矛盾的数据及相关的统计支持，以下哪项代表了最科学合理的结论和建议？\n\nA. 分子数据明确证实了物种B、C和D形成一个自然群体。基于形态学的分类是错误的，应立即修订以建立新的“Bathyspirulidae”科。\n\nB. (B, C, D) 支系65%的自举支持率较弱，表明树的这一部分存在显著的不确定性。在分析更多数据（如核基因或其他形态特征）以解决冲突之前，不应正式采用提议的“Bathyspirulidae”科。\n\nC. 65%的自举值意味着 (B, C, D) 支系是真实演化分组的概率为65%。这个概率足够高，可以证明新的科级命名是合理的。\n\nD. 因为对 (B, C, D) 支系的支持率低，整个分子数据集都不可靠，应予以忽略。应保留基于螺壳形态的原始分类，不作修改。\n\nE. 系统发育树的解析度很差，表现为物种A与该属其余物种分裂的支持率很弱（65%）。因此，根本无法得出任何分类学结论。", "solution": "这个问题的核心是在系统发育的背景下，正确解释自举支持率的含义和强度，尤其是在做出正式的分类学决策时。\n\n首先，我们来理解自举法（bootstrap method）。自举法是一种统计学上的重抽样技术，用于评估系统发育树中节点的置信度。在此过程中，从原始序列比对中随机有放回地抽取列，以创建一个相同大小的新数据集。然后根据这个新数据集构建一棵系统发育树。这个过程会重复多次（通常是100或1000次）。给定节点（或支系）的自举支持率，是指在这些重复构建的树中，该特定节点出现的百分比。它衡量的是在数据扰动下，数据对该特定分组支持的一致性程度。\n\n现在我们来分析给出的自举值：\n1.  **将物种A与(B, C, D, E)分开的节点的98%支持率：** 这是一个非常高的值。它表明在98%的自举重复中，物种A被发现是所研究群体中最早分化出来的谱系。这种关系被认为得到了非常强有力的支持，是稳健的。\n2.  **定义(B, C, D)支系的节点的65%支持率：** 这是一个相对较低的值。它意味着由物种B、C和D组成的支系在100次自举重复中只被恢复了65次。虽然这比随机机会要好，但通常被认为是弱支持或边际支持。在重复实验中有很大可能（35%）发现了B、C、D相对于E的其他排列方式，这表明遗传数据对于这个特定分组存在冲突或缺乏强信号。\n\n有了这些理解，我们可以评估每个选项：\n\n**A. 分子数据明确证实了物种B、C和D形成一个自然群体。基于形态学的分类是错误的，应立即修订以建立新的“Bathyspirulidae”科。**\n这种说法过于绝对。65%的自举值远非“明确”。进行重大的分类学修订，例如建立一个新科，需要非常强的证据。鉴于分子分组(B, C, D)与形态学分组相冲突，并且其本身只得到微弱支持，立即进行修订是不合理的。\n\n**B. (B, C, D) 支系65%的自举支持率较弱，表明树的这一部分存在显著的不确定性。在分析更多数据（如核基因或其他形态特征）以解决冲突之前，不应正式采用提议的“Bathyspirulidae”科。**\n这是最合理、最科学的结论。它正确地将65%的支持率认定为弱支持，并承认由此产生的不确定性。它明智地建议采取保守的方法：暂停分类学修订，并寻求更多数据来解决冲突。这是系统学在面对信号冲突或统计支持薄弱时的标准做法。增加来自其他非连锁基因（如核基因）的数据或重新评估形态学，既可能加强对(B, C, D)支系的支持，也可能支持一个替代的假说。\n\n**C. 65%的自举值意味着 (B, C, D) 支系是真实演化分组的概率为65%。这个概率足够高，可以证明新的科级命名是合理的。**\n这种说法代表了对自举值的一种常见且严重的误解。自举值是衡量重抽样稳健性的指标，而不是该支系为“真”的直接后验概率。它反映的是给定数据集中系统发育信号的一致性，而不是该支系在自然界中存在的绝对概率。因此，该选项的前提存在根本性缺陷。\n\n**D. 因为对 (B, C, D) 支系的支持率低，整个分子数据集都不可靠，应予以忽略。应保留基于螺壳形态的原始分类，不作修改。**\n这是一种过度反应。该数据集并非完全不可靠；例如，它为物种 *A* 是该群体其余物种的姐妹群提供了非常强的支持（98%）。树的一部分支持率较弱，并不会使另一部分的强支持率失效。完全忽略分子数据将意味着忽视一个关于该群体演化历史的潜在重要线索，尽管目前尚未解决。对(B, C, D)的65%支持率虽然不是决定性的，但它是一个可检验的假说，应进一步研究，而不是被摒弃。\n\n**E. 系统发育树的解析度很差，表现为物种A与该属其余物种分裂的支持率很弱（65%）。因此，根本无法得出任何分类学结论。**\n这种说法误读了所提供的信息。物种A与该属其余物种分裂的支持率是98%，这是非常强的，而不是弱的。65%的值涉及(B, C, D, E)群体内部一个不同的、更晚近的节点。该陈述错误地将弱支持率应用到了错误的节点上，使其结论无效。\n\n总而言之，选项B准确地反映了对系统发育证据的专业和谨慎的解释，承认了弱支持节点的局限性，并建议了正确的科学行动方案。", "answer": "$$\\boxed{B}$$", "id": "1976078"}, {"introduction": "当不同的数据集（例如形态学和分子数据）产生不同的系统发育树时，我们需要一种方法来量化它们之间的拓扑差异。本练习 [@problem_id:1976067] 将带你动手计算鲁棒逊-范德斯（Robinson-Foulds, RF）距离，这是一种基于树所包含的分支划分（bipartitions）来量化比较系统发育树拓扑结构的基本方法。掌握这种方法能让你客观地评估不同进化假说之间的一致性程度。", "problem": "一位进化生物学家为一组六个假想的昆虫物种（标记为A、B、C、D、E和F）构建了两棵系统发育树。第一棵树基于形态特征，而第二棵树基于一组同源基因序列。这些无根树的拓扑结构以Newick格式表示如下：\n\n基于形态的树：`((A,B),(C,(D,(E,F))));`\n基于分子的树：`(((A,F),B),C,(D,E));`\n\n该生物学家希望使用对称差距离（也称为Robinson-Foulds (RF) 距离）来量化这两种进化关系假说之间的冲突。该距离是通过比较每棵树所包含的二分集（也称为分割）集合来计算的。一个二分集是通过在概念上“切断”树的任意一个内部枝而形成的，这将叶节点分类单元的集合划分为两个非空的不相交子集。RF距离是存在于一棵树中但不存在于另一棵树中的非平凡二分集的总数。一个非平凡二分集是指其两个子集均至少包含两个分类单元的二分集。\n\n计算基于形态的树和基于分子的树之间的Robinson-Foulds距离。", "solution": "令分类单元集合为 $X=\\{A,B,C,D,E,F\\}$。对于一个包含 $|X|=6$ 个分类单元的无根完全解析（二叉）树，非平凡二分集（内部边）的数量为 $|X|-3=3$。Robinson-Foulds距离是两棵树的分割集合的对称差的大小：\n$$\nd_{\\mathrm{RF}}(T_{1},T_{2})=\\left|S(T_{1})\\triangle S(T_{2})\\right|=\\left|S(T_{1})\\right|+\\left|S(T_{2})\\right|-2\\left|S(T_{1})\\cap S(T_{2})\\right|.\n$$\n\n通过切断内部边来确定每棵树的三个非平凡二分集。\n\n对于基于形态的树 $((A,B),(C,(D,(E,F))));$，其内部边产生：\n$$\nS_{\\mathrm{morph}}=\\Big\\{\\{A,B\\}\\mid\\{C,D,E,F\\},\\ \\{E,F\\}\\mid\\{A,B,C,D\\},\\ \\{D,E,F\\}\\mid\\{A,B,C\\}\\Big\\}.\n$$\n\n对于基于分子的树 $(((A,F),B),C,(D,E));$，其内部边产生：\n$$\nS_{\\mathrm{mol}}=\\Big\\{\\{D,E\\}\\mid\\{A,B,C,F\\},\\ \\{A,B,F\\}\\mid\\{C,D,E\\},\\ \\{A,F\\}\\mid\\{B,C,D,E\\}\\Big\\}.\n$$\n\n将二分集视为无序的（每个二分集与其补集相等），$S_{\\mathrm{morph}}$ 中的三个分割均不与 $S_{\\mathrm{mol}}$ 中的任何一个匹配，因此\n$$\n\\left|S_{\\mathrm{morph}}\\cap S_{\\mathrm{mol}}\\right|=0.\n$$\n因此，\n$$\nd_{\\mathrm{RF}}=\\left|S_{\\mathrm{morph}}\\right|+\\left|S_{\\mathrm{mol}}\\right|-2\\cdot 0=3+3=6.\n$$", "answer": "$$\\boxed{6}$$", "id": "1976067"}, {"introduction": "在系统发育基因组学中，串联分析有时会得到极高的自举支持率，但这可能是一种假象，由少数信号强烈但具有误导性的基因驱动。这项高级练习 [@problem_id:1976074] 将探讨基因树与物种树冲突这一现代系统发育学的核心问题。你将学习超越简单的自举值，通过分析基因和位点的一致性因子，来判断一个强支持的进化关系是否反映了全基因组的共识。", "problem": "在系统发育基因组学领域，对许多基因进行串联分析有时会产生一个节点具有100%自举支持率的物种树，这表明完全的确定性。然而，这种高支持率有时可能是一种假象，即少数具有非常强烈且一致信号的基因压倒了基因组大部分区域中存在的更复杂和相互冲突的信号。\n\n一个研究团队正在使用一个包含1000个遗传位点的数据集来研究四个分类单元（A、B、C、D）之间的关系。标准的串联最大似然分析得出的拓扑结构为 $T_1 = ((A,B),(C,D))$，其中将(A,B)分支与(C,D)分支分开的中心二分法具有100%的自举支持率。为了研究这种强支持的来源，研究人员根据估计的进化速率将这1000个位点分为两组：“快速进化”组和“缓慢进化”组。然后，他们分析了这四个分类单元的三种可能的二分法的支持情况：$T_1 = ((A,B),(C,D))$、$T_2 = ((A,C),(B,D))$ 和 $T_3 = ((A,D),(B,C))$。\n\n他们的分析数据总结如下：\n\n**F组（快速进化的位点）：**\n- 位点总数：20\n- 比对位点总数：50,000\n- 支持 $T_1$ 的基因树数量：19\n- 支持 $T_2$ 的基因树数量：1\n- 支持 $T_3$ 的基因树数量：0\n- 支持 $T_1$ 的位点数量：45,000\n- 支持 $T_2$ 的位点数量：3,000\n- 支持 $T_3$ 的位点数量：2,000\n\n**S组（缓慢进化的位点）：**\n- 位点总数：980\n- 比对位点总数：1,200,000\n- 支持 $T_1$ 的基因树数量：382\n- 支持 $T_2$ 的基因树数量：343\n- 支持 $T_3$ 的基因树数量：255\n- 支持 $T_1$ 的位点数量：400,000\n- 支持 $T_2$ 的位点数量：420,000\n- 支持 $T_3$ 的位点数量：380,000\n\n为了量化单个基因的影响，该团队定义了一个名为系统发育信号强度（PSS）的度量指标。对于给定的位点集和特定的拓扑结构 $T_i$，PSS 定义为支持 $T_i$ 的比对位点总数与支持 $T_i$ 的基因树数量的比值。\n$$ \\text{PSS}(\\text{Set}, T_i) = \\frac{\\text{Number of sites in Set supporting } T_i}{\\text{Number of gene trees in Set supporting } T_i} $$\n计算快速进化组中主要拓扑结构 $T_1$ 的PSS与缓慢进化组中相同拓扑结构 $T_1$ 的PSS之比。该比率 $R = \\frac{\\text{PSS}(\\text{Set F}, T_1)}{\\text{PSS}(\\text{Set S}, T_1)}$，衡量了与缓慢进化组中的典型支持基因相比，快速进化组中的典型支持基因对 $T_1$ 的系统发育信号强度要强多少。\n\n将你的最终答案四舍五入到三位有效数字。", "solution": "我们已知一个集合和一个拓扑结构 $T_{i}$ 的系统发育信号强度（PSS）度量指标为\n$$\n\\text{PSS}(\\text{Set}, T_{i}) = \\frac{\\text{Number of sites in Set supporting } T_{i}}{\\text{Number of gene trees in Set supporting } T_{i}}.\n$$\n对于F组（快速进化）中的拓扑结构 $T_{1}$，支持位点数为 $45000$，支持基因树数为 $19$，因此\n$$\n\\text{PSS}(\\text{Set F}, T_{1}) = \\frac{45000}{19}.\n$$\n对于S组（缓慢进化）中的拓扑结构 $T_{1}$，支持位点数为 $400000$，支持基因树数为 $382$，因此\n$$\n\\text{PSS}(\\text{Set S}, T_{1}) = \\frac{400000}{382}.\n$$\n所求的比率为\n$$\nR = \\frac{\\text{PSS}(\\text{Set F}, T_{1})}{\\text{PSS}(\\text{Set S}, T_{1})} = \\frac{\\frac{45000}{19}}{\\frac{400000}{382}} = \\frac{45000}{19}\\cdot\\frac{382}{400000} = \\frac{45000\\cdot 382}{19\\cdot 400000}.\n$$\n将分子和分母同除以 $1000$ 进行化简：\n$$\nR = \\frac{45\\cdot 382}{19\\cdot 400}.\n$$\n将 $382$ 分解为 $2\\cdot 191$ 并与 $400$ 约去公因数 $2$：\n$$\nR = \\frac{45\\cdot 191}{19\\cdot 200} = \\frac{8595}{3800} = \\frac{1719}{760}.\n$$\n计算小数值并四舍五入到三位有效数字：\n$$\nR \\approx 2.261842\\dots \\approx 2.26 \\text{ (three significant figures)}.\n$$", "answer": "$$\\boxed{2.26}$$", "id": "1976074"}]}