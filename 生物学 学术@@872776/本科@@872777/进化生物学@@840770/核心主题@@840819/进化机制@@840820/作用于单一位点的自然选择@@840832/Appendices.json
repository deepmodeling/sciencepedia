{"hands_on_practices": [{"introduction": "我们从一个基础练习开始。本题将运用群体遗传学的核心原理，预测当一个显性等位基因处于选择劣势时，其频率在单代内如何变化。这个练习模拟了自然界中一个常见的场景：一个显眼的性状增加了被捕食的风险，从而让我们能够量化选择的直接后果 [@problem_id:1950152]。", "problem": "在一个大型、隔离的珊瑚礁鱼类种群中，一个具有显性等位基因 $A$ 和隐性等位基因 $a$ 的单一基因决定了体色。至少含有一个 $A$ 等位基因的个体（基因型为 $AA$ 和 $Aa$）表现出鲜艳、显眼的颜色模式。具有纯合隐性基因型（$aa$）的个体表现出隐蔽、伪装的模式。\n\n由于差异性捕食，颜色显眼的鱼类存活率较低。具体来说，它们从合子存活到繁殖年龄的概率比伪装型鱼类低20%。\n\n假设该种群随机交配，世代不重叠，并且自然选择是作用于该基因座的唯一进化力量。如果种群基因库中显性等位基因 $A$ 的初始频率为0.5，那么下一代基因库中隐性等位基因 $a$ 的频率将是多少？\n\n答案请以四位有效数字的数值形式给出。", "solution": "设 $p$ 为显性等位基因 $A$ 的频率，$q$ 为隐性等位基因 $a$ 的频率。题目给出的等位基因 $A$ 的初始频率为 $p_0 = 0.5$。由于该基因座只有两个等位基因，因此等位基因 $a$ 的初始频率为 $q_0 = 1 - p_0 = 1 - 0.5 = 0.5$。\n\n题目描述了基于表型的选择。显眼表型（基因型为 $AA$ 和 $Aa$）的存活率比伪装表型（基因型为 $aa$）低20%。我们可以通过为每种基因型分配相对适应度值（$w$）来量化这一点。我们将最成功的基因型，即伪装型 $aa$ 的适应度设为1。\n$w_{aa} = 1.0$\n\n显眼基因型（$AA$ 和 $Aa$）的适应度低20%，这意味着它们的适应度为 $1 - 0.20 = 0.80$。\n$w_{AA} = 0.80$\n$w_{Aa} = 0.80$\n\n假设种群最初处于哈迪-温伯格平衡状态，合子中三种基因型的频率为：\n$AA$ 的频率 $= p_0^2 = (0.5)^2 = 0.25$\n$Aa$ 的频率 $= 2p_0q_0 = 2(0.5)(0.5) = 0.50$\n$aa$ 的频率 $= q_0^2 = (0.5)^2 = 0.25$\n\n选择作用后，每种基因型对下一代基因库的贡献与其初始频率乘以其相对适应度成正比。为了找到新的等位基因频率，我们必须首先计算种群的平均适应度 $\\bar{w}$。\n$\\bar{w} = (\\text{freq}(AA) \\times w_{AA}) + (\\text{freq}(Aa) \\times w_{Aa}) + (\\text{freq}(aa) \\times w_{aa})$\n$\\bar{w} = (p_0^2 \\times w_{AA}) + (2p_0q_0 \\times w_{Aa}) + (q_0^2 \\times w_{aa})$\n代入数值：\n$\\bar{w} = (0.25 \\times 0.80) + (0.50 \\times 0.80) + (0.25 \\times 1.0)$\n$\\bar{w} = 0.20 + 0.40 + 0.25 = 0.85$\n\n现在，我们可以计算下一代中隐性等位基因 $a$ 的频率，记为 $q_1$。选择后一个等位基因的频率是携带该等位基因的基因型频率之和（按其携带的等位基因拷贝数加权），再通过平均适应度进行归一化。\n选择后 $aa$ 基因型的频率是 $\\frac{q_0^2 w_{aa}}{\\bar{w}}$。\n选择后 $Aa$ 基因型的频率是 $\\frac{2p_0q_0 w_{Aa}}{\\bar{w}}$。\n等位基因 $a$ 的频率是 $aa$ 纯合子的频率加上 $Aa$ 杂合子频率的一半。\n$q_1 = \\frac{q_0^2 w_{aa}}{\\bar{w}} + \\frac{1}{2}\\left(\\frac{2p_0q_0 w_{Aa}}{\\bar{w}}\\right)$\n$q_1 = \\frac{q_0^2 w_{aa} + p_0q_0 w_{Aa}}{\\bar{w}}$\n代入初始频率和适应度值：\n$q_1 = \\frac{(0.5)^2 \\times 1.0 + (0.5)(0.5) \\times 0.80}{0.85}$\n$q_1 = \\frac{0.25 \\times 1.0 + 0.25 \\times 0.80}{0.85}$\n$q_1 = \\frac{0.25 + 0.20}{0.85}$\n$q_1 = \\frac{0.45}{0.85}$\n$q_1 = \\frac{45}{85} = \\frac{9}{17}$\n\n为了得到最终的数值答案，我们将分数转换为小数，并四舍五入到四位有效数字。\n$q_1 = \\frac{9}{17} \\approx 0.52941176...$\n四舍五入到四位有效数字，我们得到0.5294。", "answer": "$$\\boxed{0.5294}$$", "id": "1950152"}, {"introduction": "并非所有有利性状都能迅速传播。本练习将探讨一个有利但隐性的等位基因的动态变化，揭示其频率在稀有时为何增加得通常十分缓慢 [@problem_id:1950139]。通过使用积分近似，我们将计算等位基因频率发生特定变化所需的时间，这有助于我们理解决定演化速率的关键因素。", "problem": "一种虚构的深海真菌 *Noctiluca crypta* 的种群通常不发光。一个罕见的隐性等位基因，我们称之为 $a$，当个体为纯合子 ($aa$) 时，它赋予了生物发光的能力。这种生物发光现象能吸引更多富含营养的微生物，从而在深海环境中提供了一种选择优势。显性等位基因 $A$ 导致不发光的表型。\n\n假设该真菌种群数量庞大，是二倍体，并且进行随机交配。发光个体（$aa$）的相对适应度为 $1+s$，其中 $s$ 是选择系数。不发光个体（$AA$ 和 $Aa$）的相对适应度均为 1。\n\n最初，种群中 $a$ 等位基因的频率为 $p_0 = 0.01$。$aa$ 基因型的选择系数给定为 $s = 0.05$。\n\n计算 $a$ 等位基因的频率从 $0.01$ 增加到 $0.02$ 所需的世代数。在此计算中，您可以将世代数视为一个连续变量，并假设选择系数足够小，以至于某些近似是有效的。将最终答案四舍五入至三位有效数字。", "solution": "设 $p$ 为隐性等位基因 $a$ 的频率，$q=1-p$ 为显性等位基因 $A$ 的频率。三种基因型 $AA$、$Aa$ 和 $aa$ 的初始频率由哈代-温伯格平衡比例给出：分别为 $q^2$、$2pq$ 和 $p^2$。\n\n各基因型的相对适应度值如下：\n- $AA$ 的适应度 ($w_{AA}$) = 1\n- $Aa$ 的适应度 ($w_{Aa}$) = 1\n- $aa$ 的适应度 ($w_{aa}$) = $1+s$\n\n种群的平均适应度 $\\bar{w}$ 是各种基因型适应度按其频率加权的平均值：\n$$ \\bar{w} = q^2 w_{AA} + 2pq w_{Aa} + p^2 w_{aa} $$\n$$ \\bar{w} = (1-p)^2(1) + 2p(1-p)(1) + p^2(1+s) $$\n$$ \\bar{w} = (1 - 2p + p^2) + (2p - 2p^2) + p^2(1+s) $$\n$$ \\bar{w} = 1 - p^2 + p^2 + sp^2 = 1 + sp^2 $$\n\n下一代 $a$ 等位基因的频率 $p'$，可通过计算选择后基因库中 $a$ 等位基因的比例得出。$aa$ 纯合子贡献全部 $a$ 等位基因，而 $Aa$ 杂合子贡献一半的 $a$ 等位基因。\n$$ p' = \\frac{p^2 w_{aa} + \\frac{1}{2}(2pq w_{Aa})}{\\bar{w}} = \\frac{p^2(1+s) + pq(1)}{1+sp^2} $$\n代入 $q=1-p$：\n$$ p' = \\frac{p^2(1+s) + p(1-p)}{1+sp^2} = \\frac{p^2 + sp^2 + p - p^2}{1+sp^2} = \\frac{p+sp^2}{1+sp^2} $$\n\n一代中等位基因频率的变化 $\\Delta p$ 为：\n$$ \\Delta p = p' - p = \\frac{p+sp^2}{1+sp^2} - p = \\frac{p+sp^2 - p(1+sp^2)}{1+sp^2} $$\n$$ \\Delta p = \\frac{p+sp^2 - p - sp^3}{1+sp^2} = \\frac{sp^2(1-p)}{1+sp^2} $$\n\n题目允许我们将世代数 $t$ 视为连续变量。因此，我们可以用微分 $\\frac{dp}{dt}$ 来近似离散变化 $\\Delta p$：\n$$ \\frac{dp}{dt} \\approx \\frac{sp^2(1-p)}{1+sp^2} $$\n由于题目指出 $s$ 很小，并且我们正在考虑低等位基因频率（$p \\le 0.02$），分母中的项 $sp^2$ 非常接近于零（$s p^2 \\le 0.05 \\times (0.02)^2 = 2 \\times 10^{-5}$）。因此，我们可以做出近似 $1+sp^2 \\approx 1$。\n$$ \\frac{dp}{dt} \\approx sp^2(1-p) $$\n\n为了求出频率从 $p_0$ 变化到 $p_t$ 所需的世代数 $t$，我们重新整理并积分：\n$$ dt = \\frac{dp}{s p^2(1-p)} $$\n$$ t = \\int_0^t dt' = \\frac{1}{s}\\int_{p_0}^{p_t} \\frac{1}{p^2(1-p)} dp $$\n\n我们对被积函数使用部分分式分解：\n$$ \\frac{1}{p^2(1-p)} = \\frac{A}{p} + \\frac{B}{p^2} + \\frac{C}{1-p} $$\n两边同乘以 $p^2(1-p)$ 得到：\n$$ 1 = Ap(1-p) + B(1-p) + Cp^2 $$\n- 令 $p=0$，我们得到 $1 = B(1) \\implies B=1$。\n- 令 $p=1$，我们得到 $1 = C(1)^2 \\implies C=1$。\n- 为了求出 $A$，我们可以比较 $p^2$ 项的系数：$0 = -A + C \\implies A=C=1$。\n因此分解结果为 $\\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{1-p}$。\n\n现在我们可以进行积分：\n$$ t = \\frac{1}{s} \\int_{p_0}^{p_t} \\left(\\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{1-p}\\right) dp $$\n$$ t = \\frac{1}{s} \\left[ \\ln|p| - \\frac{1}{p} - \\ln|1-p| \\right]_{p_0}^{p_t} $$\n$$ t = \\frac{1}{s} \\left[ \\ln\\left(\\frac{p}{1-p}\\right) - \\frac{1}{p} \\right]_{p_0}^{p_t} $$\n$$ t = \\frac{1}{s} \\left[ \\left(\\ln\\left(\\frac{p_t}{1-p_t}\\right) - \\frac{1}{p_t}\\right) - \\left(\\ln\\left(\\frac{p_0}{1-p_0}\\right) - \\frac{1}{p_0}\\right) \\right] $$\n\n现在我们代入给定值：$s = 0.05$，$p_0 = 0.01$ 和 $p_t = 0.02$。\n\n对于上限，$p_t = 0.02$：\n$$ \\ln\\left(\\frac{0.02}{1-0.02}\\right) - \\frac{1}{0.02} = \\ln\\left(\\frac{0.02}{0.98}\\right) - 50 \\approx -3.8918 - 50 = -53.8918 $$\n\n对于下限，$p_0 = 0.01$：\n$$ \\ln\\left(\\frac{0.01}{1-0.01}\\right) - \\frac{1}{0.01} = \\ln\\left(\\frac{0.01}{0.99}\\right) - 100 \\approx -4.5951 - 100 = -104.5951 $$\n\n现在，我们计算 $t$：\n$$ t = \\frac{1}{0.05} \\left[ (-53.8918) - (-104.5951) \\right] $$\n$$ t = 20 \\times (104.5951 - 53.8918) $$\n$$ t = 20 \\times 50.7033 $$\n$$ t \\approx 1014.066 $$\n\n将结果四舍五入至三位有效数字，得到 1010。", "answer": "$$\\boxed{1010}$$", "id": "1950139"}, {"introduction": "自然选择并非总是将种群推向单一方向。本题将介绍一种更复杂的选择模式——次显性（或称“杂合子劣势”），即杂合子具有最低的适应度 [@problem_id:1950127]。我们将推导出决定一个新等位基因最终是被淘汰还是被固定的临界“引爆点”频率，这一概念对于理解从基因驱动技术到物种形成等现象至关重要。", "problem": "在一种控制农业害虫物种的策略中，人们开发出了一种转基因品系。这些转基因昆虫是合成等位基因 $A$ 的纯合子，而野生型种群是等位基因 $a$ 的纯合子。该基因座上的等位基因表现出次显性（杂合子劣势），三种可能基因型（$AA$、$Aa$、$aa$）的相对适应度如下：\n- $w_{AA} = 1 - s_1$\n- $w_{Aa} = 1 - s_2$\n- $w_{aa} = 1$\n\n此处，$s_1$ 和 $s_2$ 是满足 $s_2  s_1  0$ 的正选择系数，这确保了杂合子（$Aa$）具有最低的适应度。当释放转基因昆虫后，合并种群中等位基因 $A$ 的初始频率为 $p_0$。等位基因 $A$ 的长期命运——固定（频率变为1）或丢失（频率变为0）——取决于这个初始频率。\n\n假设存在一个具有不重叠世代的大型随机交配种群，请确定作为临界点的初始频率 $p_0$ 的具体值，该值将两种可能的长期结果分离开来。请用 $s_1$ 和 $s_2$ 将此值表示为一个解析表达式。", "solution": "设 $p$ 表示选择前等位基因 $A$ 的频率，$q = 1 - p$ 表示等位基因 $a$ 的频率。在随机交配条件下，合子基因型频率分别为 $AA$ 的 $p^{2}$、$Aa$ 的 $2 p q$ 和 $aa$ 的 $q^{2}$。经过生活力选择后，其中 $w_{AA} = 1 - s_{1}$，$w_{Aa} = 1 - s_{2}$，$w_{aa} = 1$，平均适应度为\n$$\\bar{w} = p^{2} w_{AA} + 2 p q w_{Aa} + q^{2} w_{aa}.$$\n选择后等位基因 $A$ 的频率为\n$$p' = \\frac{p^{2} w_{AA} + p q w_{Aa}}{\\bar{w}}.$$\n一个内部平衡点 $p^{*} \\in (0,1)$ 满足 $p' = p$。使用生活力选择的标准恒等式，\n$$\\Delta p = p' - p = \\frac{p q \\left(w_{A} - w_{a}\\right)}{\\bar{w}},$$\n其中边际适应度为 $w_{A} = p w_{AA} + q w_{Aa}$ 和 $w_{a} = p w_{Aa} + q w_{aa}$，任何内部平衡点都必须满足 $w_{A} = w_{a}$。因此\n$$p w_{AA} + q w_{Aa} = p w_{Aa} + q w_{aa}.$$\n整理可得\n$$p \\left(w_{AA} - w_{Aa}\\right) = q \\left(w_{aa} - w_{Aa}\\right),$$\n所以\n$$\\frac{p}{q} = \\frac{w_{aa} - w_{Aa}}{w_{AA} - w_{Aa}}, \\qquad p^{*} = \\frac{w_{aa} - w_{Aa}}{(w_{aa} - w_{Aa}) + (w_{AA} - w_{Aa})}.$$\n代入 $w_{AA} = 1 - s_{1}$，$w_{Aa} = 1 - s_{2}$ 和 $w_{aa} = 1$ 可得\n$$w_{aa} - w_{Aa} = s_{2}, \\qquad w_{AA} - w_{Aa} = s_{2} - s_{1},$$\n所以不稳定的平衡点（临界点）是\n$$p^{*} = \\frac{s_{2}}{s_{2} + (s_{2} - s_{1})} = \\frac{s_{2}}{2 s_{2} - s_{1}}.$$\n在 $s_{2}  s_{1}  0$ 的条件下，我们有 $0  p^{*}  1$，这个阈值将等位基因 $A$ 的丢失（$p_{0}  p^{*}$）与固定（$p_{0}  p^{*}$）分离开来。", "answer": "$$\\boxed{\\frac{s_{2}}{2 s_{2} - s_{1}}}$$", "id": "1950127"}]}