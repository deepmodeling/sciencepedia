## 引言
在群体遗传学中，量化群体内部的遗传变异是理解演化过程的基石。一个群体的遗传组成并非静止不变，而是受到自然选择、突变、遗传漂变和基因流等多种力量的塑造。然而，在能够深入分析这些复杂的[演化动力](@entry_id:273961)之前，我们首先需要一个精确的数学框架来描述和量化群体的遗传状态。本文旨在填补这一基础知识缺口，系统性地介绍计算[基因型频率](@entry_id:141286)的核心方法及其在[演化生物学](@entry_id:145480)中的应用。

本文将分为三个核心部分。在“原理与机制”一章中，我们将学习如何计算基因型和等位基因频率，并深入探讨作为演化零假设的哈迪-温伯格[平衡模型](@entry_id:636099)及其在多等位基因、[性连锁遗传](@entry_id:143671)和近亲繁殖等情境下的扩展。接下来，“应用与跨学科联系”一章将展示这些计算方法如何在生态学、[医学遗传学](@entry_id:262833)、古遗传学和农业等不同领域中发挥关键作用，从而揭示进化力量的实际影响。最后，“动手实践”部分将通过一系列互动练习，帮助您巩固所学知识，将理论应用于解决具体问题。通过本文的学习，您将掌握描述种群遗传结构的基本工具，为进一步探索演化的奥秘奠定坚实的基础。

## 原理与机制

在[群体遗传学](@entry_id:146344)中，核心任务之一是量化群体内部的遗传变异。通过描述和预测群体中[基因型频率](@entry_id:141286)的变化，我们可以洞察作用于其上的演化力量。本章将系统地阐述计算[基因型频率](@entry_id:141286)的基本原理，介绍作为演化[零假设](@entry_id:265441)的哈迪-温伯格[平衡模型](@entry_id:636099)，并探讨在更复杂情境（包括多等位基因、[性连锁遗传](@entry_id:143671)）及其在演化压力（如自然选择和[近亲繁殖](@entry_id:263386)）下的应用。

### 描述遗传变异：[基因型频率](@entry_id:141286)与等位基因频率

群体遗传组成的量化始于两个基本度量：**[基因型频率](@entry_id:141286)**和**等位基因频率**。

**[基因型频率](@entry_id:141286)**是指群体中携带某一特定基因型的个体所占的比例。计算方法非常直观：将具有该基因型的个体数量除以群体总个体数。

假设我们正在研究一个模式植物——[拟南芥](@entry_id:268689)（*Arabidopsis thaliana*）的群体。在一个包含400棵植株的样本中，我们关注一个具有两个等位基因（$T_1$ 和 $T_2$）的遗传位点。基因分型结果显示，有144棵植株的基因型为 $T_1T_1$，192棵为 $T_1T_2$，64棵为 $T_2T_2$。我们可以如下计算各基因型的观测频率 [@problem_id:1912589]：

- $T_1T_1$ 的频率：$f(T_1T_1) = \frac{144}{400} = 0.36$
- $T_1T_2$ 的频率：$f(T_1T_2) = \frac{192}{400} = 0.48$
- $T_2T_2$ 的频率：$f(T_2T_2) = \frac{64}{400} = 0.16$

这三个频率之和为 $0.36 + 0.48 + 0.16 = 1.0$，这符合预期，因为它们共同构成了整个群体。

与[基因型频率](@entry_id:141286)密切相关的是**等位基因频率**，它衡量的是群体[基因库](@entry_id:267957)中某一特定等位基因所占的比例。对于一个[二倍体生物的](@entry_id:173042)常[染色体](@entry_id:276543)位点，每个个体携带两个等位基因。因此，一个大小为 $N$ 的群体，其基因库中总共含有 $2N$ 个等位基因。

计算等位基因频率有两种常用方法：

1.  **从基因型计数计算**：一个纯[合子](@entry_id:146894)（如 $T_1T_1$）携带两个 $T_1$ 等位基因，而一个[杂合子](@entry_id:276964)（$T_1T_2$）只携带一个。因此，$T_1$ 等位基因的频率（通常用 $p$ 表示）可以表示为：
    $p = f(T_1) = \frac{2 \times (\text{基因型} T_1T_1 \text{的个体数}) + (\text{基因型} T_1T_2 \text{的个体数})}{2 \times (\text{总个体数})}$
    
    以上述[拟南芥](@entry_id:268689)群体为例：
    $p = f(T_1) = \frac{2 \times 144 + 192}{2 \times 400} = \frac{288 + 192}{800} = \frac{480}{800} = 0.6$
    
    同理，$T_2$ 等位基因的频率（通常用 $q$ 表示）为：
    $q = f(T_2) = \frac{2 \times 64 + 192}{2 \times 400} = \frac{128 + 192}{800} = \frac{320}{800} = 0.4$
    
    由于该位点只有这两个等位基因，它们的频率之和必须为1，即 $p + q = 0.6 + 0.4 = 1.0$。

2.  **从[基因型频率](@entry_id:141286)计算**：一旦[基因型频率](@entry_id:141286)已知，计算等位基因频率会更简单。等位基因 $T_1$ 的频率是纯合子 $T_1T_1$ 频率与[杂合子](@entry_id:276964) $T_1T_2$ 频率的一半之和。
    $p = f(T_1T_1) + \frac{1}{2} f(T_1T_2)$
    
    使用我们之前计算出的频率：
    $p = 0.36 + \frac{1}{2}(0.48) = 0.36 + 0.24 = 0.6$
    
    这个结果与从计数法得到的结果完全一致。

### 哈迪-温伯格平衡：演化的零假设模型

知道了在一个世代中如何描述遗传变异后，下一个自然而然的问题是：这些频率在传给下一[代时](@entry_id:173412)会发生什么变化？20世纪初，Godfrey Hardy 和 Wilhelm Weinberg 独立地提出了一个数学模型，为这个问题提供了一个基准答案。这个模型被称为**哈迪-温伯格原理**（Hardy-Weinberg Principle），它描述了在一个“理想”群体中等位基因和[基因型频率](@entry_id:141286)的稳定性。

这个理想群体必须满足五个核心假设：
1.  **群体极大**（没有[遗传漂变](@entry_id:145594)）。
2.  **没有突变**。
3.  **没有[基因流](@entry_id:140922)**（没有个体迁入或迁出）。
4.  **随机交配**（个体择偶与其基因型无关）。
5.  **没有自然选择**（所有基因型在生存和繁殖上具有同等能力）。

当这些条件全部满足时，哈迪-温伯格原理预言：
1.  群体的[等位基因频率](@entry_id:146872)将代代保持不变。
2.  经过一代随机交配后，[基因型频率](@entry_id:141286)将达到一个平衡状态，并且此后保持不变。这个平衡状态的频率可以由等位基因频率直接预测。

对于一个具有两个等位基因（$A$ 和 $a$，频率分别为 $p$ 和 $q$）的位点，[随机交配](@entry_id:149892)等同于从[基因库](@entry_id:267957)中随机抽取两个等位基因来组成一个[合子](@entry_id:146894)。形成纯合子 $AA$ 的概率是 $p \times p = p^2$。形成纯合子 $aa$ 的概率是 $q \times q = q^2$。形成杂合子 $Aa$ 的方式有两种（从父本获得 $A$ 而从母本获得 $a$，或者反之），因此其概率为 $(p \times q) + (q \times p) = 2pq$。

因此，**哈迪-温伯格平衡**（HWE）时的[基因型频率](@entry_id:141286)为：
$f(AA) = p^2$
$f(Aa) = 2pq$
$f(aa) = q^2$

这三者之和为 $p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$。

例如，在一个大型、孤立的珊瑚礁生态系统中，研究人员发现一种决定珊瑚[耐热性](@entry_id:153708)的基因。该基因有两个[共显性](@entry_id:142824)等位基因：耐热型 $T_H$ 和敏感型 $T_S$。经测定，[等位基因频率](@entry_id:146872)分别为 $f(T_H) = p = 0.75$ 和 $f(T_S) = q = 0.25$。如果该群体处于哈迪-温伯格平衡，我们可以预测其[基因型频率](@entry_id:141286) [@problem_id:1912602]：

- 纯合耐热型 ($T_H T_H$) 的预期频率: $p^2 = (0.75)^2 = 0.5625$
- 杂合型 ($T_H T_S$) 的预期频率: $2pq = 2(0.75)(0.25) = 0.375$
- 纯合敏感型 ($T_S T_S$) 的预期频率: $q^2 = (0.25)^2 = 0.0625$

哈迪-温伯格原理的重要性不在于它在自然界中被普遍满足——事实上，它的假设几乎总是被违反的。它的真正威力在于提供了一个**零假设**。如果一个群体的观测[基因型频率](@entry_id:141286)显著偏离了哈迪-温伯格预期的频率，这就强烈暗示至少有一个[演化机制](@entry_id:196221)（如自然选择、[遗传漂变](@entry_id:145594)或[非随机交配](@entry_id:184998)）正在该群体中发挥作用。

### 哈迪-温伯格原理的应用与扩展

#### 显隐性关系下的频率推断

在许多情况下，等位基因之间存在显隐性关系，使得[杂合子](@entry_id:276964)和纯合显性个体的表型无法区分。尽管如此，如果群体处于哈迪-温伯格平衡，我们仍然可以利用[隐性纯合子](@entry_id:273509)的频率来推断所有遗传信息。

因为隐性性状只在纯合隐性基因型（例如 $aa$）中表达，所以具有该表型的个体频率直接对应于[基因型频率](@entry_id:141286) $q^2$。由此，我们可以推算出等位基因频率和其它[基因型频率](@entry_id:141286)。

考虑一个甲虫种群，其翅鞘上的虹彩斑点是一种隐性性状。在一个包含25,000只甲虫的样本中，观察到225只具有虹彩斑点。假设该种群处于平衡状态，我们可以计算纯合显性基因型的预期频率 [@problem_id:1912573]：

1.  **计算 $q^2$**: 隐性表型的频率即为 $q^2$。
    $q^2 = \frac{225}{25000} = 0.009$

2.  **计算 $q$**: 对 $q^2$ 开方得到[隐性等位基因](@entry_id:274167)的频率。
    $q = \sqrt{0.009} \approx 0.09487$

3.  **计算 $p$**: 由于 $p + q = 1$，显性等位基因的频率为：
    $p = 1 - q \approx 1 - 0.09487 = 0.90513$

4.  **计算 $p^2$**: 纯合显性基因型的预期频率为 $p^2$。
    $p^2 \approx (0.90513)^2 \approx 0.819$

这一方法在人类遗传学和[公共卫生](@entry_id:273864)领域尤为重要。例如，对于许多罕见的遗传病，它们是由隐性等位基因纯合引起的。假设一种名为“Tilorian [嗅觉缺失](@entry_id:168272)症”的罕见病症在10,000人中发现4例患者。我们可以估算该群体中携带致病基因的[杂合子](@entry_id:276964)（即携带者）数量 [@problem_id:1912572]：

- [隐性纯合子](@entry_id:273509)频率：$q^2 = \frac{4}{10000} = 0.0004$
- [隐性等位基因频率](@entry_id:204755)：$q = \sqrt{0.0004} = 0.02$
- 显性等位基因频率：$p = 1 - q = 1 - 0.02 = 0.98$
- 杂合子频率：$2pq = 2(0.98)(0.02) = 0.0392$
- 预期携带者数量：$10000 \times 0.0392 = 392$ 人。

这个例子 [@problem_id:1912572] 和另一个类似的野生花卉问题 [@problem_id:1912616] 都揭示了一个重要现象：对于罕见的隐性性状，致病等位基因绝大多数存在于表型正常的杂合携带者中，而非存在于表现出性状的患者中。

#### 多等位基因系统

哈迪-温伯格模型可以轻松扩展到两个以上等位基因的位点。如果一个位点有 $k$ 个等位基因 ($A_1, A_2, ..., A_k$)，其频率分别为 $p_1, p_2, ..., p_k$（且 $\sum p_i = 1$），则在随机交配后：

- 任何纯[合子](@entry_id:146894) $A_iA_i$ 的频率为 $p_i^2$。
- 任何杂合子 $A_iA_j$ 的频率为 $2p_ip_j$。

所有[基因型频率](@entry_id:141286)之和仍为1：$(\sum p_i)^2 = 1$。

例如，在一种深海嗜极微生物中，一个影响其[耐热性](@entry_id:153708)的基因位点 `ThR` 有三个等位基因：$ThR_A, ThR_B, ThR_C$，频率分别为 $0.53, 0.28, 0.19$。要计算该群体中所有杂合个体的总预期频率，我们可以计算所有纯[合子](@entry_id:146894)频率之和，然后用1减去它 [@problem_id:1912581]：

- 纯合子频率之和 = $f(ThR_AThR_A) + f(ThR_BThR_B) + f(ThR_CThR_C)$
  $= (0.53)^2 + (0.28)^2 + (0.19)^2$
  $= 0.2809 + 0.0784 + 0.0361 = 0.3954$

- [杂合子](@entry_id:276964)总频率 = $1 - (\text{纯合子总频率})$
  $= 1 - 0.3954 = 0.6046$

因此，超过60%的个体是杂合子。

#### [性连锁基因](@entry_id:174414)位点

对于位于[性染色体](@entry_id:169219)上的基因，计算方式需要根据性别进行调整。以人类或果蝇的[XY型性别决定系统](@entry_id:152880)为例，雌性（XX）为[二倍体](@entry_id:268054)，而雄性（XY）对于X染色体上的基因是[半合子](@entry_id:138359)（hemizygous）。

这意味着：
- 在雄性中，X[连锁基因](@entry_id:264106)的[基因型频率](@entry_id:141286)等于该群体的[等位基因频率](@entry_id:146872)。即，拥有 $X^A$ 等位基因的雄性（基因型为 $X^A Y$）的频率就是 $p$。
- 在雌性中，[基因型频率](@entry_id:141286)遵循标准的哈迪-温伯格比例：$f(X^A X^A) = p^2$, $f(X^A X^B) = 2pq$, $f(X^B X^B) = q^2$。

这种差异导致了一个重要的结果：对于罕见的X连锁隐性性状（频率为 $q$），其在雄性中出现的频率（$q$）远高于在雌性中出现的频率（$q^2$）。

以一个经典的果蝇实验为例，红眼等位基因 $X^R$ 对白眼等位基因 $X^r$ 为显性。在一个群体中，我们观察到1290只红眼雄蝇和430只白眼雄蝇。我们可以利用雄性的数据来预测雌性中的[杂合子](@entry_id:276964)数量 [@problem_id:1912571]：

1.  **从雄性推断[等位基因频率](@entry_id:146872)**: 白眼雄蝇的频率直接等于 $X^r$ 等位基因的频率 $q$。
    $q = \frac{430}{1290 + 430} = \frac{430}{1720} = 0.25$
    因此，$p = 1 - q = 0.75$。

2.  **预测雌性杂合子频率**: 雌性中[杂合子](@entry_id:276964) ($X^R X^r$) 的预期频率为 $2pq$。
    $f(X^R X^r) = 2(0.75)(0.25) = 0.375$

3.  **计算预期数量**: 如果我们有一个包含2000只雌蝇的样本，预期的杂合子数量为：
    $2000 \times 0.375 = 750$ 只。

在收集实际数据时，我们可能会分别得到[两性](@entry_id:147613)的基因型计数。例如，对一种吉丁虫的X连锁颜色基因进行调查，得到了雌性（$X^G X^G, X^G X^B, X^B X^B$）和雄性（$X^G Y, X^B Y$）的个体数。计算整个群体中每种基因型的频率，只需将该基因型的计数除以样本总人数即可 [@problem_id:1912593]。这是一个直接的描述性统计，它为后续更复杂的分析（如检验群体是否处于平衡状态）提供了基础数据。

### 对哈迪-温伯格平衡的偏离：演化的动力

当哈迪-温伯格的假设被打破时，群体就会发生演化。分析这些偏离情况，正是理解[演化机制](@entry_id:196221)的关键。

#### 自然选择

自然选择通过差异性的生存和繁殖来改变等位基因频率。一个简单的模型是**活力选择**（viability selection），即不同基因型的个体在达到繁殖年龄前的存活率不同。

设想一个沿海节肢动物种群，其对某种海洋生物毒素的耐受性由一个基因位点控制。在繁殖前，该群体的[基因型频率](@entry_id:141286)为 $f(AA) = 0.10, f(Aa) = 0.20, f(aa) = 0.70$。此时，一场[藻华](@entry_id:185666)爆发导致所有 $aa$ 基因型的个体在繁殖前死亡。幸存的 $AA$ 和 $Aa$ 个体随机交配。我们可以计算下一代[合子](@entry_id:146894)的预期[基因型频率](@entry_id:141286) [@problem_id:1912618]。

1.  **计算幸存者中的[基因型频率](@entry_id:141286)**:
    选择事件后，只有 $AA$ 和 $Aa$ 个体存活。幸存个体的总比例为 $0.10 + 0.20 = 0.30$。
    在幸存者群体中，重新计算[基因型频率](@entry_id:141286)：
    $f_{幸存}(AA) = \frac{0.10}{0.30} = \frac{1}{3}$
    $f_{幸存}(Aa) = \frac{0.20}{0.30} = \frac{2}{3}$

2.  **计算幸存者中的[等位基因频率](@entry_id:146872)**:
    幸存者繁殖群体中的等位基因 $A$ 的频率（记为 $p'$）为：
    $p' = f_{幸存}(AA) + \frac{1}{2} f_{幸存}(Aa) = \frac{1}{3} + \frac{1}{2} \left(\frac{2}{3}\right) = \frac{2}{3}$
    因此，$a$ 的频率 $q' = 1 - p' = \frac{1}{3}$。

3.  **计算下一代[合子](@entry_id:146894)的[基因型频率](@entry_id:141286)**:
    幸存者[随机交配](@entry_id:149892)，其产生的下一代[合子](@entry_id:146894)的[基因型频率](@entry_id:141286)将遵循新的哈迪-温伯格比例：
    $f_{子代}(AA) = (p')^2 = \left(\frac{2}{3}\right)^2 = \frac{4}{9}$
    $f_{子代}(Aa) = 2p'q' = 2\left(\frac{2}{3}\right)\left(\frac{1}{3}\right) = \frac{4}{9}$
    $f_{子代}(aa) = (q')^2 = \left(\frac{1}{3}\right)^2 = \frac{1}{9}$

这个过程清晰地展示了自然选择如何通过改变繁殖群体的构成，从而导致后代[等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)的系统性变化，这是演化的核心机制。

#### [非随机交配](@entry_id:184998)：近亲繁殖

**[近亲繁殖](@entry_id:263386)**（Inbreeding）是指[亲缘关系](@entry_id:172505)较近的个体之间的交配。它是一种常见的[非随机交配](@entry_id:184998)形式。[近亲繁殖](@entry_id:263386)的主要遗传后果是增加了后代中纯[合子](@entry_id:146894)的比例，并相应地减少了杂合子的比例。值得注意的是，**[近亲繁殖](@entry_id:263386)本身并不改变群体的[等位基因频率](@entry_id:146872)**，但它会显著改变[基因型频率](@entry_id:141286)的[分布](@entry_id:182848)。

这种效应可以用**[近交系数](@entry_id:190186)（$F$）**来量化。$F$ 定义为一个群体中任一个体在某一[基因座](@entry_id:177958)上的两个等位基因是**同源等位基因**（identical by descent, IBD）的概率。同源等位基因是指它们都复制自一个[共同祖先](@entry_id:175919)的同一份基因拷贝。

在存在[近亲繁殖](@entry_id:263386)的情况下，[基因型频率](@entry_id:141286)的预期值需要从哈迪-温伯格比例进行修正，其公式由 Sewall Wright 提出：
- $f(AA) = p^2 + Fpq$
- $f(Aa) = 2pq(1-F)$
- $f(aa) = q^2 + Fpq$

从公式中可以看出，相对于随机交配（$F=0$），近亲繁殖（$F > 0$）会使[杂合子](@entry_id:276964)的频率减少 $2pqF$，并将这部[分频](@entry_id:162771)率平均分配给两种纯合子。

例如，一个部分自花[授粉](@entry_id:140665)的植物种群，其等位基因 $A_1$ 的频率 $p=0.65$。由于其混合[交配系统](@entry_id:151977)（自交和异交），该种群达到了一个[近交](@entry_id:263386)平衡，测得的[近交系数](@entry_id:190186) $F=0.25$。我们可以计算该群体中[杂合子](@entry_id:276964) $A_1A_2$ 的预期频率 [@problem_id:1912588]：

1.  **计算 $q$**:
    $q = 1 - p = 1 - 0.65 = 0.35$

2.  **计算[随机交配](@entry_id:149892)下的杂合子频率**:
    $2pq = 2(0.65)(0.35) = 0.455$

3.  **应用[近交系数](@entry_id:190186)修正**:
    $f(A_1A_2) = 2pq(1-F) = 0.455(1 - 0.25) = 0.455(0.75) = 0.34125$

四舍五入到三位[有效数字](@entry_id:144089)，[杂合子](@entry_id:276964)的预期频率为 $0.341$。这显著低于[随机交配](@entry_id:149892)下预期的 $0.455$，清晰地展示了[近亲繁殖](@entry_id:263386)对群体遗传结构的重塑作用。

综上所述，计算[基因型频率](@entry_id:141286)不仅是群体遗传学的基本功，更是我们诊断和理解[演化过程](@entry_id:175749)的强大工具。通过比较观测频率与基于不同模型（如哈迪-温伯格平衡、选择模型、近交模型）的预期频率，我们可以推断出塑造生命多样性的潜在机制。