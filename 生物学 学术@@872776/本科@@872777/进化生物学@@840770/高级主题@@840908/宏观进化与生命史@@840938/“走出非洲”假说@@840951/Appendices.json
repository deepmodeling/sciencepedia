{"hands_on_practices": [{"introduction": "“出非洲”假说的核心预测之一是，随着与非洲的地理距离增加，人类群体的遗传多样性会逐渐降低。这种模式是“系列奠基者效应”的结果，即一小群个体从其祖先群体中分离出来建立新群体，导致遗传多样性的丢失。本练习将通过一个简化的数学模型，帮助你亲手计算奠基者效应对遗传多样性的影响，从而直观地理解这一关键的群体遗传学过程[@problem_id:1973164]。", "problem": "“走出非洲”假说认为，现代人类起源于非洲，并随后迁徙到世界各地。这种扩张的一个关键遗传学特征是连续奠基者效应，即从现有种群中连续迁徙出去，导致遗传多样性随着与非洲地理距离的增加而逐步降低。\n\n考虑这一过程的一个简化定量模型。假设一个种群的遗传多样性用其平均杂合度 $H$ 来衡量。非洲的一个祖先种群具有初始杂合度 $H_0$。一小群奠基者迁徙出去建立一个新的种群。这个奠基事件起到了遗传瓶颈的作用。新建立种群的期望杂合度 $H_{new}$ 与其源种群的杂合度 $H_{source}$ 之间的关系由以下公式给出：\n$$H_{new} = H_{source} \\left(1 - \\frac{1}{2N}\\right)$$\n其中 $N$ 是这个小的奠基群体的有效种群大小。\n\n假设人类走出非洲的迁徙是一系列离散的奠基事件。在每次事件中，一个有效种群大小为 $N=50$ 的小奠基群体分支出来，到一个新的区域定居。在每次这样的事件之后，新建立的种群规模增长，并最终成为下一次迁徙的源种群。为了使一个后代种群的杂合度降至原始非洲祖先种群杂合度的75%以下，需要的最少连续奠基事件次数 $k$ 是多少？", "solution": "奠基事件公式指出，如果一个源种群的杂合度为 $H_{\\text{source}}$，那么一个新建立的种群将具有杂合度\n$$\nH_{\\text{new}}=H_{\\text{source}}\\left(1-\\frac{1}{2N}\\right).\n$$\n将此公式对 $k$ 次连续的奠基事件进行递归应用，得到\n$$\nH_{k}=H_{0}\\left(1-\\frac{1}{2N}\\right)^{k}.\n$$\n我们要求杂合度降至 $H_{0}$ 的 $\\frac{3}{4}$ 以下，所以\n$$\nH_{k}  \\frac{3}{4}H_{0}.\n$$\n由于 $H_{0}0$，两边同除以 $H_{0}$：\n$$\n\\left(1-\\frac{1}{2N}\\right)^{k}  \\frac{3}{4}.\n$$\n代入给定的 $N=50$，该式变为\n$$\n\\left(1-\\frac{1}{100}\\right)^{k}=\\left(\\frac{99}{100}\\right)^{k}  \\frac{3}{4}.\n$$\n两边取自然对数。因为 $\\ln\\!\\left(\\frac{99}{100}\\right)  0$，所以两边同除以 $\\ln\\!\\left(\\frac{99}{100}\\right)$ 时不等号反向：\n$$\nk\\,\\ln\\!\\left(\\frac{99}{100}\\right)  \\ln\\!\\left(\\frac{3}{4}\\right)\n\\quad\\Longrightarrow\\quad\nk > \\frac{\\ln\\!\\left(\\frac{3}{4}\\right)}{\\ln\\!\\left(\\frac{99}{100}\\right)}.\n$$\n数值上，\n$$\n\\ln\\!\\left(\\frac{3}{4}\\right)\\approx -0.287682072,\\qquad \\ln\\!\\left(\\frac{99}{100}\\right)\\approx -0.010050336,\n$$\n所以\n$$\nk > \\frac{-0.287682072}{-0.010050336}\\approx 28.63.\n$$\n因此，满足该不等式的最小整数 $k$ 是\n$$\nk=29.\n$$\n快速检验表明 $\\left(\\frac{99}{100}\\right)^{28}\\approx 0.755 > \\frac{3}{4}$ 且 $\\left(\\frac{99}{100}\\right)^{29}\\approx 0.747  \\frac{3}{4}$，证实了 $k=29$。", "answer": "$$\\boxed{29}$$", "id": "1973164"}, {"introduction": "在理解了奠基者效应如何从理论上减少遗传多样性之后，下一步是学习如何量化不同人群之间的遗传分化。群体遗传学家使用固定指数（$F_{ST}$）等统计量来衡量这种分化程度，这对于检验“出非洲”假说的预测至关重要。通过这个练习，你将使用假设的等位基因频率数据，亲手计算$F_{ST}$值，掌握一项解读人类迁徙历史研究的基本技能[@problem_id:1973172]。", "problem": "一位群体遗传学家正在研究人类群体间的遗传分化，以检验“走出非洲”假说的预测。该研究人员分析了一个特定的单核苷酸多态性（SNP），这是DNA上一个在个体之间存在差异的位点。在这个特定的基因座上，存在两个等位基因，分别标记为‘A’和‘G’。\n\n从三个假定大小相等且规模庞大的群体中收集了等位基因频率的数据：\n1.  来自肯尼亚的马赛人群体。\n2.  来自东亚的汉族群体。\n3.  来自欧洲的巴斯克群体。\n\n每个群体中等位基因‘A’的频率记录如下：\n-   马赛人：$p_1 = 0.50$\n-   汉族人：$p_2 = 0.85$\n-   巴斯克人：$p_3 = 0.95$\n\n这些群体间的遗传分化程度可以用固定指数 $F_{ST}$ 来量化。该指数由以下关系定义：\n-   在哈迪-温伯格平衡下，单个群体的预期杂合度（$H$）由 $H = 2pq$ 给出，其中 $p$ 是一个等位基因的频率，而 $q = 1-p$ 是另一个等位基因的频率。\n-   亚群体内的平均杂合度 $H_S$ 是各个亚群体预期杂合度的算术平均值。\n-   总预期杂合度 $H_T$ 计算为 $H_T = 2\\bar{p}\\bar{q}$，其中 $\\bar{p}$ 和 $\\bar{q}$ 是所有亚群体中等位基因的平均频率。\n-   固定指数则计算为 $F_{ST} = \\frac{H_T - H_S}{H_T}$。\n\n计算这三个群体的 $F_{ST}$ 值，该值量化了它们之间的总体遗传分化。将你的最终答案四舍五入到三位有效数字。", "solution": "给定三个大小相等的亚群体，其等位基因A的频率分别为 $p_{1}=0.50$，$p_{2}=0.85$ 和 $p_{3}=0.95$。在哈迪-温伯格平衡下，亚群体 $i$ 的预期杂合度为 $H_{i}=2p_{i}q_{i}$，其中 $q_{i}=1-p_{i}$。因此，\n$$\nH_{1}=2\\cdot \\frac{1}{2}\\cdot \\frac{1}{2}=\\frac{1}{2},\\quad\nH_{2}=2\\cdot \\frac{17}{20}\\cdot \\frac{3}{20}=\\frac{51}{200},\\quad\nH_{3}=2\\cdot \\frac{19}{20}\\cdot \\frac{1}{20}=\\frac{19}{200}.\n$$\n亚群体内的平均杂合度是算术平均值：\n$$\nH_{S}=\\frac{H_{1}+H_{2}+H_{3}}{3}=\\frac{\\frac{1}{2}+\\frac{51}{200}+\\frac{19}{200}}{3}=\\frac{\\frac{100}{200}+\\frac{51}{200}+\\frac{19}{200}}{3}=\\frac{\\frac{170}{200}}{3}=\\frac{17}{60}.\n$$\n因为各亚群体大小相等，所以平均等位基因频率是\n$$\n\\bar{p}=\\frac{p_{1}+p_{2}+p_{3}}{3}=\\frac{\\frac{1}{2}+\\frac{17}{20}+\\frac{19}{20}}{3}=\\frac{\\frac{10}{20}+\\frac{17}{20}+\\frac{19}{20}}{3}=\\frac{\\frac{46}{20}}{3}=\\frac{23}{30},\n$$\n所以 $\\bar{q}=1-\\bar{p}=\\frac{7}{30}$。总预期杂合度为\n$$\nH_{T}=2\\bar{p}\\bar{q}=2\\cdot \\frac{23}{30}\\cdot \\frac{7}{30}=\\frac{322}{900}=\\frac{161}{450}.\n$$\n固定指数定义为 $F_{ST}=\\frac{H_{T}-H_{S}}{H_{T}}$。计算分子：\n$$\nH_{T}-H_{S}=\\frac{161}{450}-\\frac{17}{60}=\\frac{322}{900}-\\frac{255}{900}=\\frac{67}{900}.\n$$\n因此，\n$$\nF_{ST}=\\frac{\\frac{67}{900}}{\\frac{161}{450}}=\\frac{67}{900}\\cdot \\frac{450}{161}=\\frac{67}{322}\\approx 0.208074\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.208$。", "answer": "$$\\boxed{0.208}$$", "id": "1973172"}, {"introduction": "现代进化生物学不仅致力于描述模式，更要检验产生这些模式背后过程的竞争性假说。本练习将介绍一种前沿的统计方法——近似贝叶斯计算（ABC），让你体验科学家如何利用遗传数据来评估关于“出非洲”迁徙的复杂历史模型。通过计算后验概率，你将学会如何严谨地结合先验知识和数据证据来做出科学推断[@problem_id:1973148]。", "problem": "群体遗传学家正在研究一个新发现的非洲以外的孤立人类群体的群体历史。一个关键的争论点是，在“走出非洲”迁移事件中，产生该群体的非洲祖先群体的性质。现有两种相互竞争的假说：\n\n*   **模型1：单一来源 (SS) 模型。** 该模型假定迁移群体源自一个单一、庞大且遗传上充分混合（随机交配）的非洲祖先群体。\n*   **模型2：混合来源 (AS) 模型。** 该模型提出，迁移群体是由两个在遗传上相互隔离了很长一段时间的、不同的非洲祖先亚群体之间最近发生的一次混合事件形成的。\n\n为了区分这两种模型，研究人员采用了一种近似贝叶斯计算 (ABC) 拒绝抽样分析方法。他们首先从新发现群体的基因组数据中计算出一个包含四个遗传汇总统计量的向量。然后，他们在SS模型和AS模型下各模拟了1,000,000个数据集，模型参数（如有效群体大小和分化时间）从宽泛的先验分布中抽取。对于每个模拟数据集，他们计算了相同的汇总统计量向量。\n\n如果一个模拟的汇总统计量向量与观测到的汇总统计量向量之间的欧几里得距离小于一个很小的容差阈值 $\\epsilon$，则该模拟被“接受”。该分析的结果如下：\n*   单一来源 (SS) 模型的接受模拟次数：$125$。\n*   混合来源 (AS) 模型的接受模拟次数：$375$。\n\n根据先验的人类学和考古学证据（这些证据表明更简单的群体历史可能性更大），研究人员在分析遗传数据之前为这两个模型分配了先验概率：$P(M_{SS}) = 0.75$ 和 $P(M_{AS}) = 0.25$。\n\n利用这些信息，计算混合来源 (AS) 模型的后验概率 $P(M_{AS} | \\text{Data})$。选择代表该概率的选项。\n\nA. 0.25\n\nB. 0.50\n\nC. 0.75\n\nD. 0.90\n\nE. 3.00", "solution": "该问题要求在给定近似贝叶斯计算 (ABC) 分析结果和对模型的先验信念的情况下，计算混合来源模型的后验概率 $P(M_{AS} | \\text{Data})$。这是一个贝叶斯模型选择问题。\n\n根据新数据更新我们对模型信念的核心工具是贝叶斯定理。对于两个竞争模型 $M_{SS}$ 和 $M_{AS}$，它们的后验概率之比（后验比）与它们的先验概率之比（先验比）以及它们的边际似然之比（贝叶斯因子）相关。\n\n该关系由以下公式给出：\n$$\n\\frac{P(M_{AS} | \\text{Data})}{P(M_{SS} | \\text{Data})} = \\frac{P(\\text{Data} | M_{AS})}{P(\\text{Data} | M_{SS})} \\times \\frac{P(M_{AS})}{P(M_{SS})}\n$$\n这可以表述为：后验比 = 贝叶斯因子 $\\times$ 先验比。\n\n让我们计算每一项。\n\n**第1步：计算先验比**\n\n问题给出了两个模型的先验概率：\n$P(M_{SS}) = 0.75$\n$P(M_{AS}) = 0.25$\n\n支持混合来源 (AS) 模型相对于单一来源 (SS) 模型的先验比为：\n$$\n\\text{Prior Odds}_{AS,SS} = \\frac{P(M_{AS})}{P(M_{SS})} = \\frac{0.25}{0.75} = \\frac{1}{3}\n$$\n\n**第2步：计算贝叶斯因子**\n\n贝叶斯因子 $BF_{AS,SS}$ 是数据在每个模型下的边际似然之比，即 $P(\\text{Data} | M_{AS}) / P(\\text{Data} | M_{SS})$。在 ABC 框架中，边际似然 $P(\\text{Data} | M_i)$ 难以直接计算。因此，它通过模型 $M_i$ 下模拟的接受率来近似。\n\n设 $N_{total}$ 是为每个模型执行的总模拟次数，$N_{AS}$ 和 $N_{SS}$ 分别是每个模型的接受模拟次数。\n$N_{total} = 1,000,000$\n$N_{SS} = 125$\n$N_{AS} = 375$\n\n边际似然近似为：\n$P(\\text{Data} | M_{SS}) \\approx \\frac{N_{SS}}{N_{total}}$\n$P(\\text{Data} | M_{AS}) \\approx \\frac{N_{AS}}{N_{total}}$\n\n因此，支持 AS 模型的贝叶斯因子可以通过接受模拟次数的比率来近似：\n$$\nBF_{AS,SS} = \\frac{P(\\text{Data} | M_{AS})}{P(\\text{Data} | M_{SS})} \\approx \\frac{N_{AS}/N_{total}}{N_{SS}/N_{total}} = \\frac{N_{AS}}{N_{SS}}\n$$\n代入给定值：\n$$\nBF_{AS,SS} = \\frac{375}{125} = 3\n$$\n这意味着在混合来源模型下，观测到的遗传数据出现的可能性是在单一来源模型下的3倍。\n\n**第3步：计算后验比**\n\n现在我们可以结合贝叶斯因子和先验比来求后验比。\n$$\n\\text{Posterior Odds}_{AS,SS} = BF_{AS,SS} \\times \\text{Prior Odds}_{AS,SS} = 3 \\times \\frac{1}{3} = 1\n$$\n\n**第4步：将后验比转换为后验概率**\n\n后验比是后验概率的比值：\n$$\n\\text{Posterior Odds}_{AS,SS} = \\frac{P(M_{AS} | \\text{Data})}{P(M_{SS} | \\text{Data})} = 1\n$$\n这意味着 $P(M_{AS} | \\text{Data}) = P(M_{SS} | \\text{Data})$。由于这里只考虑这两个模型，它们的后验概率之和必须为1：\n$$\nP(M_{AS} | \\text{Data}) + P(M_{SS} | \\text{Data}) = 1\n$$\n将其中一个代入另一个，我们得到：\n$$\nP(M_{AS} | \\text{Data}) + P(M_{AS} | \\text{Data}) = 1\n$$\n$$\n2 \\times P(M_{AS} | \\text{Data}) = 1\n$$\n$$\nP(M_{AS} | \\text{Data}) = 0.5\n$$\n因此，在观测到遗传数据后，这两个模型的可能性是相等的。数据对更复杂模型的大力支持（$BF=3$）恰好被对更简单模型的强烈先验信念（先验比 = 1/3）所抵消。\n\n计算出的混合来源 (AS) 模型的后验概率为 0.50。这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1973148"}]}