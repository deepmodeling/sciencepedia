{"hands_on_practices": [{"introduction": "这个练习提供了一个经典案例，展示了文化实践如何成为一种强大的选择力量。我们将通过一个涉及宗教禁食的假想情景，来计算这种行为如何直接影响一个与新陈代谢相关的等位基因的频率，从而揭示基因-文化协同进化的基本作用机制。通过这个动手计算，你将能够把抽象的群体遗传学概念与具体的进化结果联系起来 [@problem_id:1932474]。", "problem": "在一个孤立的人类种群中，一项文化传统要求每年进行为期一个月的严格集体斋戒。这一习俗已经延续了数百代。在此期间有效储存和利用能量储备的能力受到一个名为*METF*的单一基因的影响，该基因有两个等位基因：一个“节俭”等位基因*T*和一个“挥霍”等位基因*t*。\n\n各种基因型的相对终生繁殖成功率估计如下：\n- 基因型为*tt*的个体在斋戒期间会遇到严重困难，导致其相对繁殖成功率为0.70。\n- 基因型为*TT*的个体非常适应斋戒，但在食物供应充足的现代，其终生繁殖成功率略有下降，使其相对繁殖成功率为0.95。\n- 杂合子个体 (*Tt*) 表现出最高的总体成功率，他们能够成功度过斋戒期，而没有*TT*基因型的长期劣势。他们的相对繁殖成功率被归一化为1.0。\n\n假设该种群处于一代的开始，斋戒期之前，并且该基因座处于哈迪-温伯格平衡状态。节俭等位基因*T*的初始频率为0.30。\n\n计算经过这一代选择（包括年度斋戒的影响）后，基因库中*T*等位基因的频率。将最终答案四舍五入到四位有效数字。", "solution": "设$T$的初始等位基因频率为$p=0.30$，$t$的初始等位基因频率为$q=1-p=0.70$。在选择前，根据哈迪-温伯格平衡，基因型频率分别为$TT$为$p^{2}$，$Tt$为$2pq$，$tt$为$q^{2}$。\n\n设相对适应度分别为$w_{TT}=0.95$，$w_{Tt}=1.0$和$w_{tt}=0.70$。选择后，平均适应度为\n$$\n\\bar{w}=p^{2}w_{TT}+2pq\\,w_{Tt}+q^{2}w_{tt}.\n$$\n选择后$T$的等位基因频率为\n$$\np'=\\frac{p^{2}w_{TT}+pq\\,w_{Tt}}{\\bar{w}}.\n$$\n\n代入给定值：\n- $p^{2}=0.09$, $2pq=2(0.30)(0.70)=0.42$, $q^{2}=0.49$。\n- $\\bar{w}=0.09(0.95)+0.42(1.0)+0.49(0.70)=0.0855+0.42+0.343=0.8485$。\n- 分子 $=p^{2}w_{TT}+pq\\,w_{Tt} = 0.09(0.95)+0.30(0.70)(1.0)=0.0855+0.21=0.2955$。\n\n因此，\n$$\np'=\\frac{0.2955}{0.8485}\\approx 0.348261\\dots\n$$\n四舍五入到四位有效数字，\n$$\np'\\approx 0.3483.\n$$", "answer": "$$\\boxed{0.3483}$$", "id": "1932474"}, {"introduction": "基因-文化协同进化是一个动态过程，其中选择压力会随着文化的发展而改变甚至逆转。这个问题探讨了这样一个情景：一种饮食上的转变使得一个曾经有益的基因变得不再必要，甚至带有轻微的代价。通过计算等位基因频率在多代中的变化，你将模拟“松弛选择”的过程，并观察文化变迁如何导致遗传适应性的丧失 [@problem_id:1932473]。", "problem": "在一个孤立的人群中，中和一种传统食用的野生块茎中发现的轻度有毒化合物的能力由基因*TNP*控制。该基因有两个等位基因：一个编码功能性中和酶的显性等位基因*A*，以及一个非功能性的隐性等位基因*a*。多代以来，这种块茎一直是主食，导致*a*等位基因受到强烈的不利选择。\n\n一次重大的文化和农业转变发生，导致人们完全并永久地停止食用这种块茎。由于他们的饮食中不再含有这种毒素，产生中和酶不再有任何益处。事实上，其生产现在会带来轻微的代谢成本。这逆转了选择压力。适应度成本是加性的：基因型为*AA*的个体相对适应度为 $1-2s$，杂合子（*Aa*）的相对适应度为 $1-s$，而基因型为*aa*的个体（不产生任何酶）的相对适应度为 $1$。\n\n在饮食转变的时刻（第0代），*a*等位基因的频率（我们记为 $q_0$）为 $0.01$。与代谢成本相关的选择系数 $s$ 为 $0.005$。假设种群数量庞大，交配是随机的，且选择是作用于该基因的唯一进化动力，计算自饮食转变以来500代后*a*等位基因的频率。将你的最终答案四舍五入到三位有效数字。", "solution": "问题要求在给定初始频率 $q_0$ 和一个对“A”等位基因具有加性适应度成本的选择模型下，计算 $t=500$ 代后“a”等位基因的频率。\n\n首先，我们定义参数和模型。\n- “A”等位基因的频率：$p$\n- “a”等位基因的频率：$q$\n- 约束条件：$p+q=1$\n- 各基因型的相对适应度值：\n    - $w_{AA} = 1 - 2s$\n    - $w_{Aa} = 1 - s$\n    - $w_{aa} = 1$\n- “a”的初始频率：$q_0 = 0.01$\n- 选择系数：$s = 0.005$\n- 世代数：$t = 500$\n\n每代等位基因频率的变化取决于群体的平均适应度 $\\bar{w}$。\n$$ \\bar{w} = p^2 w_{AA} + 2pq w_{Aa} + q^2 w_{aa} $$\n代入适应度值：\n$$ \\bar{w} = p^2 (1 - 2s) + 2pq (1 - s) + q^2 (1) $$\n$$ \\bar{w} = p^2 - 2sp^2 + 2pq - 2spq + q^2 $$\n$$ \\bar{w} = (p^2 + 2pq + q^2) - 2s(p^2 + pq) $$\n使用 $p^2 + 2pq + q^2 = (p+q)^2 = 1$ 并提出因子 $p$：\n$$ \\bar{w} = 1 - 2s p(p+q) = 1 - 2sp $$\n\n接下来，我们计算下一代“a”等位基因的频率 $q'$。这是选择后基因库中“a”等位基因的频率。\n$$ q' = \\frac{(\\text{选择后Aa的频率}) \\times \\frac{1}{2} + (\\text{选择后aa的频率}) \\times 1}{\\text{选择后频率之和}} $$\n这可以简化为：\n$$ q' = \\frac{p q w_{Aa} + q^2 w_{aa}}{\\bar{w}} $$\n代入适应度值：\n$$ q' = \\frac{p q (1 - s) + q^2}{1 - 2sp} $$\n我们可以重写 $p = 1-q$：\n$$ q' = \\frac{(1-q)q(1-s) + q^2}{1 - 2s(1-q)} = \\frac{q - sq - q^2 + sq^2 + q^2}{1 - 2s + 2sq} = \\frac{q - sq + sq^2}{1 - 2s + 2sq} $$\n“a”频率的每代变化量是 $\\Delta q = q' - q$。\n$$ \\Delta q = \\frac{q - sq + sq^2}{1 - 2s + 2sq} - q = \\frac{q - sq + sq^2 - q(1 - 2s + 2sq)}{1 - 2s + 2sq} $$\n$$ \\Delta q = \\frac{q - sq + sq^2 - q + 2sq - 2sq^2}{1 - 2s + 2sq} = \\frac{sq - sq^2}{1 - 2s + 2sq} = \\frac{sq(1-q)}{\\bar{w}} $$\n代入 $p=1-q$：\n$$ \\Delta q = \\frac{spq}{\\bar{w}} $$\n由于选择系数 $s=0.005$ 很小，我们可以近似认为频率随时间连续变化。我们还可以近似平均适应度 $\\bar{w} = 1-2sp \\approx 1$。\n因此，我们可以写出 $q$ 随时间 $t$（以代为单位）变化的微分方程：\n$$ \\frac{dq}{dt} \\approx spq = s q (1-q) $$\n这是标准的逻辑斯蒂增长方程。我们通过分离变量法来求解它：\n$$ \\frac{dq}{q(1-q)} = s \\, dt $$\n我们对两边进行积分，时间从 $0$ 到 $t$，频率从 $q_0$ 到 $q_t$：\n$$ \\int_{q_0}^{q_t} \\frac{1}{q(1-q)} \\, dq = \\int_0^t s \\, dt $$\n右边的积分就是 $st$。对于左边的积分，我们使用部分分式分解：$\\frac{1}{q(1-q)} = \\frac{1}{q} + \\frac{1}{1-q}$。\n$$ \\int_{q_0}^{q_t} \\left(\\frac{1}{q} + \\frac{1}{1-q}\\right) \\, dq = [\\ln|q| - \\ln|1-q|]_{q_0}^{q_t} = \\left[\\ln\\left(\\frac{q}{1-q}\\right)\\right]_{q_0}^{q_t} $$\n计算定积分：\n$$ \\ln\\left(\\frac{q_t}{1-q_t}\\right) - \\ln\\left(\\frac{q_0}{1-q_0}\\right) = st $$\n重新整理方程以求解 $q_t$：\n$$ \\ln\\left(\\frac{q_t}{1-q_t}\\right) = \\ln\\left(\\frac{q_0}{1-q_0}\\right) + st $$\n对两边取指数：\n$$ \\frac{q_t}{1-q_t} = \\frac{q_0}{1-q_0} \\exp(st) $$\n设 $R_t = \\frac{q_t}{1-q_t}$。那么 $R_t = R_0 \\exp(st)$。我们可以用 $R_t$ 来表示 $q_t$ 并求解：\n$q_t = R_t(1-q_t) \\implies q_t = R_t - R_t q_t \\implies q_t(1+R_t) = R_t \\implies q_t = \\frac{R_t}{1+R_t}$。\n\n现在，我们可以代入给定的值：\n$q_0 = 0.01$\n$s = 0.005$\n$t = 500$ 代\n\n首先，计算初始比率 $R_0$：\n$$ R_0 = \\frac{q_0}{1-q_0} = \\frac{0.01}{1-0.01} = \\frac{0.01}{0.99} $$\n接下来，计算指数项：\n$$ st = 0.005 \\times 500 = 2.5 $$\n现在，计算 $t=500$ 时的 $R_t$：\n$$ R_{500} = R_0 \\exp(st) = \\frac{0.01}{0.99} \\exp(2.5) $$\n使用计算器，$\\exp(2.5) \\approx 12.18249$。\n$$ R_{500} \\approx \\frac{0.01}{0.99} \\times 12.18249 \\approx 0.1230555 $$\n最后，从 $R_{500}$ 计算 $q_{500}$：\n$$ q_{500} = \\frac{R_{500}}{1+R_{500}} \\approx \\frac{0.1230555}{1+0.1230555} = \\frac{0.1230555}{1.1230555} \\approx 0.1095719 $$\n题目要求答案四舍五入到三位有效数字。\n$$ q_{500} \\approx 0.110 $$", "answer": "$$\\boxed{0.110}$$", "id": "1932473"}, {"introduction": "文化实践通常像一个缓冲器，保护群体免受某些环境压力的影响，但这种保护并非总是完美的。这个练习模拟了一个更为复杂的场景，其中一个不完美的文化行为（净水仪式）调节了来自病原体的自然选择。你将推导出一个易感等位基因的平衡频率，从而揭示文化可靠性与遗传成本之间的相互作用如何维持群体内的遗传多样性 [@problem_id:1932459]。", "problem": "在一个大型、与世隔绝的人类群体中，一种水媒病原体呈地方性流行。该群体有一种文化传承的净水仪式，如果正确执行，可以使水变得安全，并完全保护个体免受该病原体的侵害。然而，由于仪式执行中偶尔会出现失误，在任何一代中，净水失败的概率为 $p$，这会使整个人群暴露于病原体之下。\n\n对这种病原体的易感性由一个具有两个等位基因 *S*（易感）和 *R*（抗性）的单一基因控制，该生物体为二倍体。其遗传和选择背景如下：\n- 抗性等位基因 *R* 是显性的，这意味着 *RR* 和 *SR* 两种基因型在表型上都对该病原体具有抗性。\n- 易感等位基因 *S* 是隐性的，这意味着只有 *SS* 基因型在表型上是易感的。\n- *RR* 基因型带有一个固有的、隐性的适合度代价 $s_r$（其中 $0  s_r  1$），这意味着无论病原体是否存在，其适合度在每一代都会降低 $s_r$。*SR* 和 *SS* 基因型没有这个固有代价。\n- 如果暴露于病原体（当仪式失败时发生），易感的 *SS* 个体将遭受 $s_p$ 的适合度降低（其中 $0  s_p  1$）。\n\n总结一下在两种可能的环境状态下各基因型的相对适合度 (`w`)：\n1.  **仪式成功（概率为 $1-p$）**：$w_{SS} = 1$, $w_{SR} = 1$, $w_{RR} = 1 - s_r$。\n2.  **仪式失败（概率为 $p$）**：$w_{SS} = 1 - s_p$, $w_{SR} = 1$, $w_{RR} = 1 - s_r$。\n\n假设随机交配、种群规模巨大，并且维持着一个稳定的多态性平衡，请推导易感等位基因 *S* 的平衡频率的表达式，用 $p$、$s_r$ 和 $s_p$ 表示。", "solution": "问题要求解易感等位基因 `S` 的稳定平衡频率。我们用 `q` 表示等位基因 `S` 的频率，用 `1-q` 表示等位基因 `R` 的频率。由于环境在两种状态（仪式成功或失败）之间波动，长期的进化动态由每种基因型在这些状态下的平均适合度决定。我们将计算每种基因型的算术平均适合度，这在弱选择的情况下是一个有效的近似。\n\n步骤 1：计算 `SS` 基因型的平均相对适合度 `\\bar{w}_{SS}`。\n`SS` 基因型有 `1-p` 的概率其适合度为 `1`，有 `p` 的概率其适合度为 `1 - s_p`。\n$$\n\\bar{w}_{SS} = (1-p) \\times 1 + p \\times (1 - s_p) = 1 - p s_p\n$$\n\n步骤 2：计算 `SR` 基因型的平均相对适合度 `\\bar{w}_{SR}`。\n`SR` 基因型有 `1-p` 的概率其适合度为 `1`，有 `p` 的概率其适合度为 `1`。\n$$\n\\bar{w}_{SR} = (1-p) \\times 1 + p \\times 1 = 1\n$$\n\n步骤 3：计算 `RR` 基因型的平均相对适合度 `\\bar{w}_{RR}`。\n`RR` 基因型有 `1-p` 的概率其适合度为 `1 - s_r`，有 `p` 的概率其适合度为 `1 - s_r`。\n$$\n\\bar{w}_{RR} = (1-p) \\times (1 - s_r) + p \\times (1 - s_r) = (1-p+p) \\times (1 - s_r) = 1 - s_r\n$$\n\n步骤 4：分析适合度景观，找出稳定多态性平衡的条件。\n如果杂合子具有最高的适合度（超显性或杂合子优势），则存在稳定的多态性平衡。让我们比较一下平均适合度值：\n- `\\bar{w}_{SR}  \\bar{w}_{SS}`，因为 `1  1 - p s_p`，可简化为 `p s_p  0`。由于 `p  0` 且 `s_p  0`，此条件成立。\n- `\\bar{w}_{SR}  \\bar{w}_{RR}`，因为 `1  1 - s_r`，可简化为 `s_r  0`。由于 `s_r  0`，此条件也成立。\n由于杂合子 `SR` 的平均适合度高于两种纯合子 `SS` 和 `RR`，将会出现导致稳定多态性平衡的平衡选择。\n\n步骤 5：计算平衡频率 `q_{eq}`。\n在平衡状态下，等位基因频率的变化量 `\\Delta q` 为零。在一个单位点、双等位基因系统中，`\\Delta q` 的通用方程为：\n$$\n\\Delta q = \\frac{q(1-q)}{\\bar{w}} [q(\\bar{w}_{SS} - \\bar{w}_{SR}) + (1-q)(\\bar{w}_{SR} - \\bar{w}_{RR})]\n$$\n其中 `\\bar{w}` 是群体的平均适合度。对于多态性平衡（其中 `0  q  1`）下的 `\\Delta q = 0`，方括号中的项必须为零：\n$$\nq_{eq}(\\bar{w}_{SS} - \\bar{w}_{SR}) + (1-q_{eq})(\\bar{w}_{SR} - \\bar{w}_{RR}) = 0\n$$\n让我们定义相对于杂合子的、针对纯合子的选择系数：\n- 针对 `SS` 的选择：`t = \\bar{w}_{SR} - \\bar{w}_{SS} = 1 - (1 - p s_p) = p s_p`\n- 针对 `RR` 的选择：`s = \\bar{w}_{SR} - \\bar{w}_{RR} = 1 - (1 - s_r) = s_r`\n\n平衡方程可以重写为 `q = q_{eq}`：\n$$\nq(-t) + (1-q)(s) = 0\n$$\n$$\n-qt + s - qs = 0\n$$\n$$\ns = qt + qs = q(t+s)\n$$\n求解 `q_{eq}`：\n$$\nq_{eq} = \\frac{s}{s+t}\n$$\n现在，代入 `s` 和 `t` 的表达式：\n$$\nq_{eq} = \\frac{s_r}{s_r + p s_p}\n$$\n这就是易感等位基因 `S` 的稳定平衡频率。", "answer": "$$\\boxed{\\frac{s_r}{s_r + p s_p}}$$", "id": "1932459"}]}