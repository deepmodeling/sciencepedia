{"hands_on_practices": [{"introduction": "系统发育树是病毒的“家族树”，理解其结构使我们能够追溯耐药性等重要性状的演化历史。本练习旨在帮助你将一个特定的流行病学情景——耐药性突变仅出现一次——与其在系统发育树上产生的特定模式联系起来。掌握这种联系是解读进化历史的一项基本技能。[@problem_id:1953611]", "problem": "在一项公共卫生调查中，科学家们正在追踪一种新型、快速突变的RNA病毒的演化。一种强大的新型抗病毒药物已被用于治疗受感染的患者。几个月后，开始出现耐药性病例。对来自一大群患者的病毒样本进行基因测序，揭示了药物敏感性和药物耐药性病毒株的存在。流行病学团队的一个关键假设是，赋予耐药性的特定基因突变仅在一名患者体内发生过一次，随后通过传播扩散到其他个体。\n\n假设这个单一起源假说是正确的，如果科学家们根据所有采样的病毒（包括耐药和敏感的）的序列构建一个系统发育树，他们最有可能观察到以下哪种模式？\n\nA. 耐药毒株将形成一个单系群（一个分支）。\n\nB. 耐药毒株将随机散布在整个树中，与敏感毒株混合在一起。\n\nC. 耐药毒株将只在系统发育树的末端被发现，形成一个并系群。\n\nD. 系统发育树将显示从根部分出的两个不同分支，一个包含所有耐药毒株，另一个包含所有敏感毒株。\n\nE. 耐药毒株将聚集在一起，但它们不会共享一个对它们来说是唯一的最近共同祖先。", "solution": "问题要求我们根据耐药性突变仅发生一次这一关键信息，预测耐药病毒株在系统发育树上的模式。\n\n首先，让我们理解系统发育树代表什么。系统发育树是一种图表，描绘了一组生物体（或在本例中是病毒）之间的演化关系。分支模式说明了不同谱系如何随着时间的推移从共同祖先分化而来。树的根代表树中所有实体的最近共同祖先，而末端（或叶子）代表单个采样的病毒。\n\n问题的核心在于“单一起源假说”。这意味着，赋予耐药性的特定突变是在某一时刻，在单个患者的病毒种群中出现的。这个突变的病毒随后复制，其后代通过传播传递给了其他患者。\n\n让我们追踪这一事件对演化历史的影响：\n1.  在突变事件发生之前，种群中的所有病毒都是药物敏感的。这些祖先谱系构成了系统发育树的“主干”和许多分支。\n2.  在这些演化谱系中的某一个谱系的特定点上，发生了耐药性突变。这个点对应于未来系统发育树上的一个内部节点（一个共同祖先）。\n3.  从这个特定祖先演化而来的所有病毒都将继承该耐药性突变。\n4.  因此，带有该突变的原始病毒及其所有后代形成了一个独特的耐药病毒谱系。\n\n现在，让我们将此与系统发育术语联系起来。一个由共同祖先及其所有后代组成的群体被称为**单系群**（**monophyletic group**），或一个**分支**（**clade**）。由于在这种情况下，所有耐药病毒共享一个单一的共同祖先（第一个拥有该突变的病毒），并且这个祖先对它们来说是唯一的（即其其他亲属，如其姐妹谱系，不属于耐药群体），因此耐药病毒将在树上形成一个单一、独特的分支。\n\n让我们基于这一理解来分析给出的选项：\n\nA. **耐药毒株将形成一个单系群（一个分支）。** 这是正确的描述。单一的突变事件创造了一个单一的耐药祖先病毒。源自此事件的传播链中的所有后续病毒都是其后代。根据定义，这个包含共同祖先及其所有后代的群体是一个单系群或分支。\n\nB. **耐药毒株将随机散布在整个树中，与敏感毒株混合在一起。** 如果耐药性在不同病毒谱系中多次独立出现，则会预期出现这种模式。这种现象被称为趋同演化。它直接与单一起源假说相矛盾。\n\nC. **耐药毒株将只在系统发育树的末端被发现，形成一个并系群。** 并系群包含一个共同祖先但并非其所有后代。单一起源情景意味着所有后代都将携带该性状，而不仅仅是其中一部分。虽然耐药毒株确实位于其各自支系的末端，但说它们形成一个并系群是不正确的，并且该描述不完整，因为它忽略了核心的分组原则。\n\nD. **系统发育树将显示从根部分出的两个不同分支，一个包含所有耐药毒株，另一个包含所有敏感毒株。** 这将意味着耐药性突变发生在疫情爆发的最开始，就在所有采样病毒的第一个共同祖先处。问题指出，耐药性是在药物部署“几个月后”出现的，这意味着突变发生在疫情初步爆发之后很久，在一个已经建立且多样化的病毒种群中。\n\nE. **耐药毒株将聚集在一起，但它们不会共享一个对它们来说是唯一的最近共同祖先。** 这描述的是一个多系群，如果耐药性状出现在几个不共享直接共同祖先的不同谱系中（即趋同演化），但我们根据该性状错误地将它们分组，就会出现这种情况。这同样与单一起源假说相矛盾。\n\n因此，与耐药性状单一起源相一致的唯一模式是，所有耐药病毒将形成一个单一的单系群（一个分支）。", "answer": "$$\\boxed{A}$$", "id": "1953611"}, {"introduction": "虽然系统发育树提出了关于进化关系的假说，但并非树中的所有分支都同样可靠。像自举法 (bootstrapping) 这样的统计方法对于评估我们对这些分组的信心至关重要。这个实践问题要求你解释一个关键的统计指标——自举值，帮助你学会批判性地评估系统发育结论的稳健性。[@problem_id:1953582]", "problem": "一个公共卫生研究团队正在调查一种新发现的病原体——“冠状呼吸病毒”（Coronal Respiratory Virus, CRV）的爆发。他们从四个不同城市——Alston、Benton、Canton和Denton——的感染者身上收集并测序了完整的病毒基因组。为了解这些病毒分离株之间的传播途径和进化关系，他们根据比对后的基因组序列构建了一棵系统发育树。\n\n为了评估其系统发育树分支模式的统计置信度，他们进行了自举分析（bootstrap analysis），生成了1000个重复数据集。在他们最终的树中，一个特定的分支点（一个节点）将来自Alston和Benton的病毒分离株归为一个单一的进化枝（clade），而将来自Canton和Denton的分离株排除在外。计算得出，这个特定节点的自举支持值（bootstrap support value）为42%。\n\n根据这些信息，对于定义“Alston-Benton”进化枝的节点，其42%的自举支持值最准确的解释是什么？\n\nA. 将Alston-Benton谱系与其他谱系分开的进化分歧事件发生得非常迅速。\n\nB. 这个低值表明来自Alston和Benton的病毒基因组很可能是两个亲缘关系更远的CRV谱系之间发生重组事件的结果。\n\nC. 整棵系统发育树在统计上是不可靠的，不应从其描绘的任何关系中得出结论。\n\nD. 关于来自Alston和Benton的病毒形成一个独特的单系群这一假说，其统计置信度很低；数据未能稳健地支持这一特定分组，以排除其他可能的分组方式。\n\nE. 分析有力地证实了，与来自Canton或Denton的病毒相比，来自Alston和Benton的病毒彼此之间拥有更近的共同祖先。", "solution": "一个进化枝的自举支持值定义为在自举重复数据集中该进化枝被重现的比例。设 $N$ 为自举重复的次数，设 $k$ 为特定进化枝出现的重复次数。自举比例 $B$ 为\n$$\nB=\\frac{k}{N}\n$$\n在本例中，$N=1000$，报告的支持率为 $B=0.42$，这意味着 $k = B \\times N = 0.42 \\times 1000 = 420$。因此，Alston-Benton进化枝在1000棵自举树中仅出现了420次，表明对该特定分组的统计支持度很低。\n\n对此的解释：\n- 高的自举值（通常接近0.95或更高，具体取决于上下文）表明对该进化枝有强而稳健的支持；0.42的值表明在重抽样数据集中，其他替代的分组方式出现得更频繁，因此对该分组的置信度较低。\n- 这个度量涉及推断出的进化枝在重抽样下的稳定性，并不直接意味着任何特定的进化速率或过程。\n\n对各选项的评估：\n- A是错误的，因为自举支持值不衡量分歧的速度；它衡量的是对一个拓扑结构的重抽样支持度。\n- B是错误的，因为仅凭一个低的自举值并不能推断出重组；许多因素（如有限的系统发育信号、同oplasy、模型误设、取样）都可能降低支持度，并且不能仅从一个低的 $B$ 值来诊断重组。\n- C是错误的，因为一个节点的低支持度并不会使整棵树无效；不同的节点可以有不同的自举值，对于树中得到良好支持的部分，仍然可以得出结论。\n- D是正确的，因为0.42的自举值表明，对于Alston和Benton形成一个独特的单系群这一假说，其统计置信度很低；数据未能稳健地支持这个进化枝，以排除其他替代方案。\n- E是错误的，因为0.42并不能有力地证实Alston和Benton相对于Canton或Denton拥有更近的共同祖先；有力的证实需要高得多的支持度。\n\n因此，最准确的解释是D。", "answer": "$$\\boxed{D}$$", "id": "1953582"}, {"introduction": "系统动力学（Phylodynamics）通过使用数学模型，将进化树与流行病动态联系起来。例如，出生-死亡模型使我们能够直接从系统发育树中估算传播率等参数。在本练习中，你将通过推导一个表达式来比较关于公共卫生干预如何影响病毒传播率的两个竞争性假说，从而深入了解该方法的核心机制，并展示系统发育树如何为公共卫生提供定量数据。[@problem_id:1953536]", "problem": "在亲缘动态学领域，研究人员使用病毒基因序列来重建系统发育树，这些树记录了病原体的传播历史。可以使用统计模型（如出生-死亡过程）分析这些树，以推断关键的流行病学参数。\n\n考虑一个简化的流行病出生-死亡模型。在这个模型中，“出生”对应于病毒传播事件，以速率 $\\lambda$ 发生；“死亡”代表感染个体从感染池中被移除（例如，通过康复或死亡），以速率 $\\mu$ 发生。此外，感染个体会以速率 $\\psi$ 被采样用于测序，这些样本在重建的系统发育树中表现为叶尖。\n\n对于一个重建的系统发育树，在一个具有可能随时间变化的传播速率 $\\lambda(t)$ 和恒定速率 $\\mu$ 和 $\\psi$ 的模型下，其对数似然 $\\ln L$ 由以下公式给出：\n$$ \\ln L = \\sum_{i=1}^{N} \\ln(\\lambda(\\tau_i)) - \\int_{0}^{T_{end}} (\\lambda(t) + \\mu + \\psi) k(t) dt $$\n这里，$N$ 是在时间 $\\tau_i$ 发生的传播事件（树的内部节点）的总数，$T_{end}$ 是最近样本的时间，$k(t)$ 是在时间 $t$ 共同传播的病毒谱系数量。积分项可以看作是涉及树的总分支长度。\n\n假设在时间 $t_{int}$ 实施了一项重大的公共卫生干预措施。为了评估其有效性，我们比较了关于传播速率的两个竞争模型：\n1.  **零模型 ($M_0$):** 恒定的传播速率，$\\lambda(t) = \\lambda_0$。\n2.  **备择模型 ($M_1$):** 分段常数传播速率，当 $t < t_{int}$ 时 $\\lambda(t) = \\lambda_1$，当 $t \\ge t_{int}$ 时 $\\lambda(t) = \\lambda_2$。\n\n从重建的病毒系统发育树中，提取了以下汇总统计量：\n-   在 $t_{int}$ 之前的传播事件数：$N_1$\n-   在 $t_{int}$ 或之后发生的传播事件数：$N_2$\n-   在 $t_{int}$ 之前的总分支持续时间（谱系-年）：$L_1 = \\int_0^{t_{int}} k(t) dt$\n-   在 $t_{int}$ 或之后发生的总分支持续时间（谱系-年）：$L_2 = \\int_{t_{int}}^{T_{end}} k(t) dt$\n\n最大化每个模型对数似然的传播速率的最大似然估计 (MLEs) 如下：\n-   对于 $M_0$：$\\hat{\\lambda}_0 = \\frac{N_1 + N_2}{L_1 + L_2}$\n-   对于 $M_1$：$\\hat{\\lambda}_1 = \\frac{N_1}{L_1}$ 和 $\\hat{\\lambda}_2 = \\frac{N_2}{L_2}$\n\n你的任务是计算备择模型和零模型的最大对数似然之差。令 $\\hat{L}_0$ 和 $\\hat{L}_1$ 分别为模型 $M_0$ 和 $M_1$ 在其对应最大似然估计处评估的似然。\n\n确定 $\\Delta \\ln L = \\ln \\hat{L}_1 - \\ln \\hat{L}_0$ 关于 $N_1$、$N_2$、$L_1$ 和 $L_2$ 的解析表达式。", "solution": "我们从一个重建的系统发育树在出生-死亡模型下的一般对数似然函数开始，该模型具有可能随时间变化的传播速率：\n$$\n\\ln L = \\sum_{i=1}^{N} \\ln(\\lambda(\\tau_{i})) - \\int_{0}^{T_{end}} \\left(\\lambda(t) + \\mu + \\psi\\right) k(t) \\, dt\n$$\n我们将忽略不依赖于 $\\lambda$ 的项，因为它们在计算似然差时会抵消。\n\n**模型 $M_0$ (零模型): $\\lambda(t) = \\lambda_0$**\n对数似然函数为：\n$$\n\\ln L_0(\\lambda_0) = \\sum_{i=1}^{N_1+N_2} \\ln(\\lambda_0) - \\int_0^{T_{end}} \\lambda_0 k(t) dt = (N_1+N_2)\\ln(\\lambda_0) - \\lambda_0 (L_1+L_2)\n$$\n代入其最大似然估计 (MLE) $\\hat{\\lambda}_0 = \\frac{N_1 + N_2}{L_1 + L_2}$，得到最大对数似然值：\n$$\n\\ln \\hat{L}_0 = (N_1+N_2)\\ln\\left(\\frac{N_1+N_2}{L_1+L_2}\\right) - \\frac{N_1+N_2}{L_1+L_2}(L_1+L_2)\n$$\n$$\n\\ln \\hat{L}_0 = (N_1+N_2)\\ln\\left(\\frac{N_1+N_2}{L_1+L_2}\\right) - (N_1+N_2)\n$$\n\n**模型 $M_1$ (备择模型): $\\lambda(t) = \\begin{cases} \\lambda_1 & t < t_{int} \\\\ \\lambda_2 & t \\ge t_{int} \\end{cases}$**\n对数似然函数可以分为两部分：\n$$\n\\ln L_1(\\lambda_1, \\lambda_2) = \\left( N_1 \\ln(\\lambda_1) - \\int_0^{t_{int}} \\lambda_1 k(t) dt \\right) + \\left( N_2 \\ln(\\lambda_2) - \\int_{t_{int}}^{T_{end}} \\lambda_2 k(t) dt \\right)\n$$\n$$\n\\ln L_1(\\lambda_1, \\lambda_2) = N_1 \\ln(\\lambda_1) - \\lambda_1 L_1 + N_2 \\ln(\\lambda_2) - \\lambda_2 L_2\n$$\n代入其MLEs $\\hat{\\lambda}_1 = \\frac{N_1}{L_1}$ 和 $\\hat{\\lambda}_2 = \\frac{N_2}{L_2}$，得到最大对数似然值：\n$$\n\\ln \\hat{L}_1 = N_1 \\ln\\left(\\frac{N_1}{L_1}\\right) - \\frac{N_1}{L_1} L_1 + N_2 \\ln\\left(\\frac{N_2}{L_2}\\right) - \\frac{N_2}{L_2} L_2\n$$\n$$\n\\ln \\hat{L}_1 = N_1 \\ln\\left(\\frac{N_1}{L_1}\\right) + N_2 \\ln\\left(\\frac{N_2}{L_2}\\right) - (N_1+N_2)\n$$\n\n**计算对数似然差**\n现在我们计算 $\\Delta \\ln L = \\ln \\hat{L}_1 - \\ln \\hat{L}_0$：\n$$\n\\Delta \\ln L = \\left( N_1 \\ln\\left(\\frac{N_1}{L_1}\\right) + N_2 \\ln\\left(\\frac{N_2}{L_2}\\right) - (N_1+N_2) \\right) - \\left( (N_1+N_2)\\ln\\left(\\frac{N_1+N_2}{L_1+L_2}\\right) - (N_1+N_2) \\right)\n$$\n$-(N_1+N_2)$ 项相互抵消，剩下：\n$$\n\\Delta \\ln L = N_1 \\ln\\left(\\frac{N_1}{L_1}\\right) + N_2 \\ln\\left(\\frac{N_2}{L_2}\\right) - (N_1+N_2)\\ln\\left(\\frac{N_1+N_2}{L_1+L_2}\\right)\n$$\n这就是备择模型相对于零模型的对数似然比统计量，它量化了允许传播速率随时间变化的模型的改进程度。", "answer": "$$\\boxed{N_{1}\\ln\\!\\left(\\frac{N_{1}}{L_{1}}\\right)+N_{2}\\ln\\!\\left(\\frac{N_{2}}{L_{2}}\\right)-(N_{1}+N_{2})\\ln\\!\\left(\\frac{N_{1}+N_{2}}{L_{1}+L_{2}}\\right)}$$", "id": "1953536"}]}