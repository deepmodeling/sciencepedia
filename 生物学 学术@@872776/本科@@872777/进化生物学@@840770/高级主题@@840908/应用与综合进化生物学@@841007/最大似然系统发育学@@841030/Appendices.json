{"hands_on_practices": [{"introduction": "在最大似然分析中，整个树的似然值是所有位点似然值的总和。然而，深入研究每个位点对不同拓扑结构的支持度，可以揭示数据内部的冲突信号。这个实践练习将带你通过比较逐位点对数似然得分，来精确定位那些导致系统发育冲突的关键字符，这是解决复杂演化难题的一项核心技能 [@problem_id:1946225]。", "problem": "一个进化生物学家团队正在研究四种新发现的嗜热细菌的系统发育关系，这四种细菌被暂定命名为*Species A*、*Species B*、*Species C*和*Species D*。他们从一个参与热休克响应的关键基因中收集了DNA序列数据，得到了一个10个位点的序列比对。使用最大似然（ML）法进行的分析，为关于它们进化分支模式的两个相互冲突的假说提供了高度的统计支持。这两个相互竞争的树拓扑结构，以 Newick 格式表示如下：\n\n- **假说 1:** `((Species A, Species B), (Species C, Species D));`\n- **假说 2:** `((Species A, Species C), (Species B, Species D));`\n\n为了解决这一冲突，研究人员计算了在给定两种树拓扑结构的情况下，序列比对中每个位点的对数似然分数。这些分数代表在给定特定树和进化模型的情况下，在单个位点上观察到数据的对数概率，如下表所示。更高（负得更少）的对数似然分数表明树与该位点的数据拟合得更好。\n\n| 位点索引 | 假说1的对数似然 | 假说2的对数似然 |\n|:----------:|:-------------------------------:|:-------------------------------:|\n|      1     |             -3.15             |             -3.15             |\n|      2     |             -4.82             |             -2.91             |\n|      3     |             -3.50             |             -4.95             |\n|      4     |             -5.11             |             -3.04             |\n|      5     |             -2.88             |             -4.76             |\n|      6     |             -5.20             |             -5.15             |\n|      7     |             -4.67             |             -2.55             |\n|      8     |             -3.01             |             -4.89             |\n|      9     |             -5.50             |             -3.23             |\n|     10     |             -3.12             |             -3.18             |\n\n您的任务是找出基因序列中哪些特定位点为假说2提供了比假说1更强的支持。如果一个位点对于假说2的对数似然分数比其对于假说1的对数似然分数大至少1.8，则认为该位点为假说2提供了“强力支持”。\n\n下列哪组位点索引代表了所有为假说2提供强力支持的位点？\n\nA. 位点 3, 5, 8\n\nB. 位点 2, 4, 7\n\nC. 位点 2, 4, 7, 9\n\nD. 位点 2, 7, 9\n\nE. 位点 2, 4, 6, 7, 9\n\nF. 位点 4", "solution": "对于每个位点索引 $i$，我们将支持假说2的对数似然差异定义为 $\\Delta_{i}=\\ell_{2,i}-\\ell_{1,i}$，其中 $\\ell_{2,i}$ 和 $\\ell_{1,i}$ 分别是在假说2和假说1下的每位点对数似然。一个位点为假说2提供强力支持，当且仅当 $\\Delta_{i}\\geq 1.8$。\n\n使用表格计算每个位点的 $\\Delta_{i}$：\n位点 $1$: $\\Delta_{1}=(-3.15)-(-3.15)=0.00$。\n位点 $2$: $\\Delta_{2}=(-2.91)-(-4.82)=1.91\\geq 1.8$。\n位点 $3$: $\\Delta_{3}=(-4.95)-(-3.50)=-1.45$。\n位点 $4$: $\\Delta_{4}=(-3.04)-(-5.11)=2.07\\geq 1.8$。\n位点 $5$: $\\Delta_{5}=(-4.76)-(-2.88)=-1.88$。\n位点 $6$: $\\Delta_{6}=(-5.15)-(-5.20)=0.05$。\n位点 $7$: $\\Delta_{7}=(-2.55)-(-4.67)=2.12\\geq 1.8$。\n位点 $8$: $\\Delta_{8}=(-4.89)-(-3.01)=-1.88$。\n位点 $9$: $\\Delta_{9}=(-3.23)-(-5.50)=2.27\\geq 1.8$。\n位点 $10$: $\\Delta_{10}=(-3.18)-(-3.12)=-0.06$。\n\n因此，满足 $\\Delta_{i}\\geq 1.8$ 的位点是 $2,4,7,9$，这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1946225"}, {"introduction": "准确的系统发育推断始于高质量的数据，尤其是序列比对。一个看似微小的比对错误可能会在分析中被放大，最终扭曲我们对演化历史的理解。本练习旨在通过具体计算，量化一个非同源序列的错误比对如何影响成对距离的估算，并最终导致特定分支长度的计算出现偏差 [@problem_id:1946190]。", "problem": "一位演化生物学家正在使用一个总长度为 $L=2500$ 个碱基对 (bp) 的基因序列，为三个物种（A、B 和 C）构建系统发育树。公认的演化关系是物种 B 和 C 为姐妹群，A 为外群。分析方法包括估计每对物种之间的演化距离，然后计算无根树的外部支长度。\n\n任意两个序列之间的演化距离 $v$（定义为每个位点的预期替换数）是根据差异位点的比例 $p$，使用 Jukes-Cantor (JC69) 模型估计的：\n$$v = -\\frac{3}{4} \\ln(1 - \\frac{4}{3}p)$$\n其中 $\\ln$ 是自然对数。对于这个三物种树，通往物种 C 的外部支长度（记为 $v_C$）由以下公式给出：\n$$v_C = \\frac{1}{2}(v_{AC} + v_{BC} - v_{AB})$$\n其中 $v_{AB}$、$v_{AC}$ 和 $v_{BC}$ 是物种 A、B 和 C 之间的两两距离。\n\n这三个物种的基因比对大部分是直接的。在一个 $2480$ bp 的区域内，观察到的差异数量为：$D'_{AB} = 248$，$D'_{AC} = 248$，$D'_{BC} = 124$。然而，一个 $N=20$ bp 的小片段被证明难以比对。生物学家考虑了该片段的两种可能的比对情景。\n\n**情景 1（正确比对）：** 该比对使用真实的同源片段。\n- 来自 A 的片段：`AAAAAAAAAAAAAAAAAAAA`\n- 来自 B 的片段：`AAAAAAAAAAAAAAAAAAGG`\n- 来自 C 的片段：`AAAAAAAAAAAAAAAAAAAA`\n\n**情景 2（错误比对）：** 由于一个优先考虑序列相似性而忽略同源性的软件错误，一个来自物种 C 的非同源片段被错误地比对。这个片段被认为是趋同演化的结果，使其在表面上与外群 A 的序列相似。\n- 来自 A 的片段：`AAAAAAAAAAAAAAAAAAAA`\n- 来自 B 的片段：`AAAAAAAAAAAAAAAAAAGG`\n- 来自 C 的片段：`AAAAAAAAAATTTTTTTTTT`\n\n这种比对错误被怀疑会人为地夸大通往物种 C 分支上的估计演化速率。为了量化这种效应，请计算在正确比对 ($v_{C,corr}$) 和错误比对 ($v_{C,mis}$) 下物种 C 的分支长度。你的任务是计算夸大因子，定义为比率 $\\frac{v_{C,mis}}{v_{C,corr}}$。\n\n将最终答案四舍五入到三位有效数字。", "solution": "我们使用 JC69 距离估计量 $v= -\\frac{3}{4}\\ln\\!\\bigl(1-\\frac{4}{3}p\\bigr)$，并且对于三物种无根树，通往物种 C 的外部支长度为：\n$$\nv_{C}=\\frac{1}{2}\\left(v_{AC}+v_{BC}-v_{AB}\\right).\n$$\n记 $s_{XY}=1-\\frac{4}{3}p_{XY}$，则 $v_{XY}=-\\frac{3}{4}\\ln s_{XY}$。于是\n$$\nv_{C}=\\frac{1}{2}\\left(-\\frac{3}{4}\\ln s_{AC}-\\frac{3}{4}\\ln s_{BC}+\\frac{3}{4}\\ln s_{AB}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{s_{AC}s_{BC}}{s_{AB}}\\right).\n$$\n\n从 2480 bp 的区域：$D'_{AB}=248$, $D'_{AC}=248$, $D'_{BC}=124$。\n对于 20 bp 的片段：\n\n情景 1（正确）：\n- 片段差异：$d_{AB}=2$, $d_{AC}=0$, $d_{BC}=2$。\n- 总计（在 $L=2500$ 中）：$D_{AB}=250$, $D_{AC}=248$, $D_{BC}=126$。\n- 比例：$p_{AB}=\\frac{250}{2500}=\\frac{1}{10}$, $p_{AC}=\\frac{248}{2500}=\\frac{62}{625}$, $p_{BC}=\\frac{126}{2500}=\\frac{63}{1250}$。\n- 因此\n$$\ns_{AB}=1-\\frac{4}{3}\\cdot\\frac{1}{10}=\\frac{13}{15},\\quad\ns_{AC}=1-\\frac{4}{3}\\cdot\\frac{62}{625}=\\frac{1627}{1875},\\quad\ns_{BC}=1-\\frac{4}{3}\\cdot\\frac{63}{1250}=\\frac{583}{625}.\n$$\n所以\n$$\nv_{C,\\mathrm{corr}}=-\\frac{3}{8}\\ln\\!\\left(\\frac{\\frac{1627}{1875}\\cdot\\frac{583}{625}}{\\frac{13}{15}}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{1627\\cdot 583\\cdot 15}{1875\\cdot 625\\cdot 13}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right).\n$$\n数值上，$v_{C,\\mathrm{corr}}\\approx 2.56253\\times 10^{-2}$。\n\n情景 2（错误比对）：\n- 片段差异：$d_{AB}=2$, $d_{AC}=10$, $d_{BC}=10$。\n- 总计：$D_{AB}=250$, $D_{AC}=258$, $D_{BC}=134$。\n- 比例：$p_{AB}=\\frac{1}{10}$, $p_{AC}=\\frac{258}{2500}=\\frac{129}{1250}$, $p_{BC}=\\frac{134}{2500}=\\frac{67}{1250}$。\n- 因此\n$$\ns_{AB}=\\frac{13}{15},\\quad\ns_{AC}=1-\\frac{4}{3}\\cdot\\frac{129}{1250}=\\frac{539}{625},\\quad\ns_{BC}=1-\\frac{4}{3}\\cdot\\frac{67}{1250}=\\frac{1741}{1875}.\n$$\n所以\n$$\nv_{C,\\mathrm{mis}}=-\\frac{3}{8}\\ln\\!\\left(\\frac{\\frac{539}{625}\\cdot\\frac{1741}{1875}}{\\frac{13}{15}}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{539\\cdot 1741\\cdot 15}{625\\cdot 1875\\cdot 13}\\right)\n=-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right).\n$$\n数值上，$v_{C,\\mathrm{mis}}\\approx 2.96565\\times 10^{-2}$。\n\n夸大因子为\n$$\n\\frac{v_{C,\\mathrm{mis}}}{v_{C,\\mathrm{corr}}}\n=\\frac{-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right)}{-\\frac{3}{8}\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right)}\n=\\frac{\\ln\\!\\left(\\frac{14{,}075{,}985}{15{,}234{,}375}\\right)}{\\ln\\!\\left(\\frac{14{,}228{,}115}{15{,}234{,}375}\\right)}\n\\approx 1.15731.\n$$\n四舍五入到三位有效数字，夸大因子为 $1.16$。", "answer": "$$\\boxed{1.16}$$", "id": "1946190"}, {"introduction": "真实世界的遗传数据集，例如仅包含单核苷酸多态性（SNP）位点的数据，常常不完全符合标准演化模型的假设，这引入了所谓的“确定性偏倚”（ascertainment bias）。这个练习将展示最大似然框架的强大之处：它允许我们通过数学方法调整似然函数来校正这类偏倚。通过推导校正项，你将学会如何确保在处理经过筛选的数据时，也能获得更准确的演化速率估计 [@problem_id:1946207]。", "problem": "一位计算生物学家正在分析一组DNA序列，这些序列来自两个被假定从一个共同祖先分化而来的物种。其演化历史由一个简单的双分类单元树表示，其中有一条连接这两个物种的枝长为 `v` 的分支。枝长 `v` 代表每个位点的期望替换数。该数据集经过筛选，仅包含 `K` 个被鉴定为单核苷酸多态性（SNPs）的位点，这意味着这些位点上的核苷酸在这两个物种之间存在差异。\n\n沿该分支的演化过程由 Jukes-Cantor (JC69) 模型建模。根据该模型，一个特定的起始核苷酸（例如，“A”）在沿分支演化后保持不变的概率为 `p_{ii}(v) = \\frac{1}{4} + \\frac{3}{4}\\exp(-4v/3)`。它变为一个特定的不同核苷酸（例如，从“A”到“G”）的概率为 `p_{ij}(v) = \\frac{1}{4} - \\frac{1}{4}\\exp(-4v/3)`。假设祖先序列的核苷酸分布遵循模型的平衡频率，即 `\\pi_A = \\pi_C = \\pi_G = \\pi_T = 1/4`。\n\n该生物学家意识到，对这个经过筛选的数据集使用标准的似然分析将导致对枝长 `v` 的估计产生偏差。数据集的标准（未校正）对数似然为 `l_{\\text{uncorrected}}(v)`，其计算方法是对 `K` 个观察到的SNP的对数似然求和。正确的对数似然 `l_{\\text{corrected}}(v)` 必须通过以仅观察到变异位点为条件来解释这种确定性偏倚（ascertainment bias）。\n\n您的任务是量化此校正。推导校正项的表达式，该校正项是正确和不正确对数似然之间的差值：`\\Delta(v) = l_{\\text{corrected}}(v) - l_{\\text{uncorrected}}(v)`。将您的答案表示为 `K` 和 `v` 的函数。", "solution": "我们将一个位点上观察到的两个核苷酸建模为长度为 $v$ 的单个 JC69 分支的起点和终点，其中起始碱基按平衡分布 $\\pi_{i} = 1/4$ 分布。设 $p_{ii}(v)$ 和 $p_{ij}(v)$ 为问题中给出的 JC69 转换概率。\n\n对于一个位点，观察到的模式的未校正似然为 $P(\\text{pattern} \\mid v)$。由于数据集经过筛选，仅包含变异（SNP）位点，因此校正后的似然以变异性为条件：\n$$\nP(\\text{pattern} \\mid v, \\text{variable}) \\;=\\; \\frac{P(\\text{pattern} \\mid v)}{P(\\text{variable} \\mid v)}.\n$$\n取对数并对 $K$ 个独立的 SNP 位点求和，得到\n$$\nl_{\\text{corrected}}(v) \\;=\\; l_{\\text{uncorrected}}(v) \\;-\\; K \\ln\\!\\big(P(\\text{variable} \\mid v)\\big).\n$$\n因此，校正项为\n$$\n\\Delta(v) \\;=\\; l_{\\text{corrected}}(v) - l_{\\text{uncorrected}}(v) \\;=\\; -\\,K \\ln\\!\\big(P(\\text{variable} \\mid v)\\big).\n$$\n\n剩下的任务是计算在 JC69 模型下 $P(\\text{variable} \\mid v)$ 的值。两个核苷酸相同的概率为\n$$\nP(\\text{equal} \\mid v) \\;=\\; \\sum_{i \\in \\{A,C,G,T\\}} \\pi_{i}\\, p_{ii}(v)\n\\;=\\; \\sum_{i} \\frac{1}{4}\\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-4v/3)\\right)\n\\;=\\; \\frac{1}{4} + \\frac{3}{4}\\exp(-4v/3).\n$$\n因此，\n$$\nP(\\text{variable} \\mid v) \\;=\\; 1 - P(\\text{equal} \\mid v)\n\\;=\\; 1 - \\left(\\frac{1}{4} + \\frac{3}{4}\\exp(-4v/3)\\right)\n\\;=\\; \\frac{3}{4}\\left(1 - \\exp(-4v/3)\\right).\n$$\n将此代入 $\\Delta(v)$ 的表达式中，得到\n$$\n\\Delta(v) \\;=\\; -\\,K \\,\\ln\\!\\left(\\frac{3}{4}\\left[1 - \\exp(-4v/3)\\right]\\right).\n$$", "answer": "$$\\boxed{-K \\ln\\!\\left(\\frac{3}{4}\\left[1 - \\exp(-4v/3)\\right]\\right)}$$", "id": "1946207"}]}