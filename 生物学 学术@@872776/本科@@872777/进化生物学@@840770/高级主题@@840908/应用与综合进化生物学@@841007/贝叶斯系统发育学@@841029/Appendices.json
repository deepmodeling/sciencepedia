{"hands_on_practices": [{"introduction": "理论联系实践是掌握贝叶斯系统发育学的关键。本节的练习将带你从模拟输出中提取核心信息。马尔科夫链蒙特卡洛（MCMC）方法的核心产出是来自后验分布的大量系统发育树样本，而我们将学习如何将这些样本转化为对演化关系的可量化置信度。这个练习将向你展示如何通过计算支系在 MCMC 样本中出现的频率来估算其后验概率，这是衡量系统发育支持度的基本指标 ([@problem_id:1911287])。", "problem": "一位进化生物学家正在研究三种新发现的嗜极古菌物种（分别命名为物种A、物种B和物种C）之间的系统发育关系。为了推断它们的演化历史，她使用贝叶斯推断框架分析了它们的核糖体RNA基因序列。该分析涉及马尔可夫链蒙特卡洛（MCMC）模拟，该模拟从后验概率分布中对系统发育树进行抽样。\n\n在MCMC模拟收敛后，从后验分布中总共保留了3,000棵树。抽样得到的树拓扑结构总结如下：\n- 物种A和物种B互为最近亲缘的拓扑结构，表示为 `((A,B),C)`，出现了2,150次。\n- 物种A和物种C互为最近亲缘的拓扑结构，表示为 `((A,C),B)`，出现了600次。\n- 物种B和物种C互为最近亲缘的拓扑结构，表示为 `((B,C),A)`，出现了250次。\n\n根据这个MCMC样本，包含物种A和物种B但不包括物种C的分支的后验概率是多少？将您的答案表示为保留三位有效数字的小数。", "solution": "在使用MCMC进行贝叶斯系统发育推断时，一个分支的后验概率是通过它在抽样的后验树中出现的频率来估计的。对于包含物种A和物种B但不包括物种C的分支，该分支仅存在于拓扑结构`((A,B),C)`中。MCMC样本在总共$3000$棵树中包含了$2150$个这种拓扑结构的实例。因此，估计的后验概率为\n$$\np(\\text{clade }\\{A,B\\})=\\frac{2150}{3000}=\\frac{43}{60}.\n$$\n转换为小数并四舍五入到三位有效数字，\n$$\n\\frac{43}{60}=0.716\\overline{6}\\approx 0.717.\n$$", "answer": "$$\\boxed{0.717}$$", "id": "1911287"}, {"introduction": "贝叶斯推断的强大功能依赖于 MCMC 模拟的可靠性，而一个关键前提是算法必须达到“收敛”，即它已经充分探索了所有可能的树空间，从而真实地反映了后验分布。如果模拟运行时间太短，结果可能只是反映了某个局部的、非全局最优的区域，从而产生误导性结论 ([@problem_id:1911230])。本练习将探讨一种至关重要的诊断方法：通过比较两次独立 MCMC 运行的结果来评估收敛性，这是确保结论稳健性的标准操作 ([@problem_id:1911269])。", "problem": "一位演化生物学家正在研究一组新发现的嗜极细菌的系统发育关系。为此，他们收集了DNA序列数据，并正在使用贝叶斯推断方法。该分析涉及一种称为马尔可夫链蒙特卡洛（MCMC）模拟的计算方法，用以探索可能的系统发育树及其相关参数的广阔空间。为确保结果的稳健性，该生物学家从不同的随机树开始，进行了两次完全独立的MCMC模拟。每次运行都会生成大量的树样本，从中可以估计出每个不同分支（clade，一个由一个祖先及其所有后代组成的群体）的后验概率。\n\n在合并两次运行的结果以得出关于细菌关系的最终结论之前，生物学家必须验证两次模拟是否已收敛到相同的后验分布。未能收敛将表明MCMC搜索不完整，结果不可靠。\n\n下列哪种图形化方法最直接、最全面地评估了两次独立运行中所有分支的后验概率估计是否一致？\n\nA. 绘制两次运行的似然得分对数与迭代次数的关系图，并目测检查两条曲线是否都达到了一个稳定的平台期。\n\nB. 对两次运行的树的合并后验分布中采样的所有分支长度创建一个单一的直方图。\n\nC. 生成一个散点图，其中每个点对应一个特定的分支，其x坐标是第一次运行得到的后验概率，y坐标是第二次运行得到的后验概率。\n\nD. 分别从每次运行中构建一致树（consensus tree），并检查它们的拓扑结构是否相同。", "solution": "我们寻求一种图形化方法，能够直接且全面地评估两次独立的MCMC运行中，所有分支的后验概率估计是否一致。设两次运行中观察到的所有不同分支的集合由 $i$ 索引，并令 $p_{i}^{(1)}$ 和 $p_{i}^{(2)}$ 分别表示从运行1和运行2中估计出的分支 $i$ 的后验概率。在生成相同后验分布意义上的收敛意味着对于所有的 $i$ 都有 $p_{i}^{(1)} \\approx p_{i}^{(2)}$。一种绘制配对点 $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ 的图形化方法可以直接检验这种相等性；如果两次运行对所有分支的结果都一致，那么这些点应该落在直线 $y=x$ 附近，任何偏离都会立即揭示不一致之处。\n\n评估各个选项：\n- 选项A（似然得分对数与迭代次数的轨迹图）：一个稳定的平台期表明每个链内部表现出平稳性，但相等或稳定的似然值并不能保证两次运行在树空间上采样了相同的后验分布，也不能保证分支的后验概率匹配。对于分支级别的一致性评估，这种方法是间接的且不够全面。\n- 选项B（合并分支长度的单一的直方图）：合并两次运行的结果会掩盖运行之间的差异，并且没有解决分支后验概率的问题。它既不是跨运行的比较，也不是以分支为中心的。\n- 选项C（两次运行的分支后验概率的散点图）：对于每个分支 $i$，绘制 $\\left(p_{i}^{(1)},p_{i}^{(2)}\\right)$ 可以直接评估所有分支间的一致性。靠近 $y=x$ 的点表明一致性；离群点则识别出存在差异的特定分支。只在一次运行中出现的分支可以在另一次运行中用零表示，从而保持了评估的全面性。\n- 选项D（比较一致树拓扑）：即使许多分支的概率存在显著差异，也可能出现相同的一致树拓拓扑，因为一致树会对支持度设置阈值并丢弃定量的差异。这种方法不够敏感，也不够全面。\n\n因此，跨运行的分支后验概率散点图（选项C）提供了最直接和最全面的对一致性的评估。", "answer": "$$\\boxed{C}$$", "id": "1911269"}, {"introduction": "除了推断单一的演化树，贝叶斯方法的真正威力在于它能够比较和检验不同的科学假说。例如，我们可以提出关于演化速率在整个生命之树上是恒定不变（严格分子钟）还是随谱系变化（松弛分子钟）的竞争模型。本练习将指导你如何使用贝叶斯因子（Bayes Factor）这一强大工具，通过比较不同模型的边际似然值，来量化支持其中一个模型的证据强度，从而做出科学推断 ([@problem_id:1911261])。", "problem": "一位进化生物学家正在研究一个新发现的嗜极古菌分支中分子进化的节奏。利用来自一个保守基因的DNA序列，该生物学家旨在比较系统发育树上两种关于进化速率的竞争模型。第一种模型是严格分子钟（$M_S$），它假设核苷酸替换速率在进化树的所有分支上都是恒定的。第二种模型是不相关宽松分子钟（$M_R$），它假定每个分支都有其自身的进化速率，该速率是从一个共享的潜在分布中独立抽取的。\n\n为了在贝叶斯框架下正式比较这两种模型，该生物学家使用一种计算密集型方法计算了每种模型下数据的边际似然。分析得出的严格分子钟模型的边际对数似然为 $\\ln[P(\\text{Data}|M_S)] = -15,820.5$，宽松分子钟模型的边际对数似然为 $\\ln[P(\\text{Data}|M_R)] = -15,808.5$。\n\n您的任务有两部分：\n1.  计算 $2\\ln(BF_{RS})$ 的值，其中 $BF_{RS}$ 是比较宽松分子钟模型（$M_R$）与严格分子钟模型（$M_S$）的贝叶斯因子。\n2.  根据您的计算和下面提供的 $2\\ln(BF)$ 值的标准解释量表，确定支持首选模型的证据强度。\n\n**$2\\ln(BF)$ 的解释量表：**\n- $0 \\le 2\\ln(BF) \\le 2$：证据不值一提。\n- $2  2\\ln(BF) \\le 6$：正面证据。\n- $6  2\\ln(BF) \\le 10$：强证据。\n- $2\\ln(BF) > 10$：非常强的证据。\n\n选择正确提供计算值和相应解释的选项。\n\nA. $24$；强证据。\nB. $12$；正面证据。\nC. $-24$；证据强烈支持严格分子钟模型。\nD. $24$；非常强的证据。\nE. $12$；非常强的证据。", "solution": "将比较宽松分子钟模型与严格分子钟模型的贝叶斯因子定义为\n$$\nBF_{RS}=\\frac{P(\\text{Data}\\mid M_{R})}{P(\\text{Data}\\mid M_{S})}.\n$$\n取自然对数可得\n$$\n\\ln(BF_{RS})=\\ln\\!\\big[P(\\text{Data}\\mid M_{R})\\big]-\\ln\\!\\big[P(\\text{Data}\\mid M_{S})\\big].\n$$\n使用给定的边际对数似然，\n$$\n\\ln(BF_{RS})=\\left(-15808.5\\right)-\\left(-15820.5\\right)=12.\n$$\n因此，\n$$\n2\\ln(BF_{RS})=2\\times 12=24.\n$$\n由于 $2\\ln(BF_{RS})=24$，并且解释量表指出大于 $10$ 的值表示非常强的证据，因此数据提供了非常强的证据支持宽松分子钟模型 $M_{R}$ 优于严格分子钟模型 $M_{S}$。正确的选项是报告值为 $24$ 和非常强证据的那个。", "answer": "$$\\boxed{D}$$", "id": "1911261"}]}