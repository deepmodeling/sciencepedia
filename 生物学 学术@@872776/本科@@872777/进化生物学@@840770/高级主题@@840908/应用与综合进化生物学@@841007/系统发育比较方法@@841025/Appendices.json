{"hands_on_practices": [{"introduction": "比较生物学中的一个核心挑战是，密切相关的物种并非独立的统计数据点。为了解决这个问题，系统发育独立比较法（Phylogenetically Independent Contrasts, PIC）应运而生，它将来自相关物种的性状数据转换为一组统计上独立的值。本练习 [@problem_id:1761373] 将带你亲手实践 PIC 的基本算法，让你了解如何利用进化时间来标准化性状差异，从而揭示性状间的协同进化模式。", "problem": "一位演化生物学家正在研究一小组圣甲虫的体型演化。她为三个物种构建了系统发育树并收集了体型数据：*Rhinoceps ferox*、*Goliathus parvus* 和 *Chalcosoma medius*。系统发育关系如下：*R. ferox* 和 *G. parvus* 是姐妹种，它们的共同祖先所代表的分支与 *C. medius* 是姐妹群。\n\n代表演化时间（单位：百万年，Myr）的枝长如下：\n- 从 *R. ferox* 和 *G. parvus* 的共同祖先到现今 *R. ferox* 的分支长度为 2 Myr。\n- 从 *R. ferox* 和 *G. parvus* 的共同祖先到现今 *G. parvus* 的分支长度为 2 Myr。\n- 从这个三物种树的根节点到 *R. ferox* 和 *G. parvus* 的共同祖先的分支长度为 3 Myr。\n- 从树的根节点到现今 *C. medius* 的分支长度为 5 Myr。\n\n这些物种的成年平均体长为：\n- *Rhinoceps ferox*：45.5 毫米\n- *Goliathus parvus*：52.1 毫米\n- *Chalcosoma medius*：38.0 毫米\n\n为了准备比较分析，必须计算体长性状的系统发育独立对比值。使用该方法的标准算法，计算在这个三物种树的根节点处计算出的独立对比值的数值。假设性状演化遵循布朗运动模型。将您的答案四舍五入到三位有效数字。", "solution": "该问题要求计算一个三物种树根节点处的系统发育独立对比值。我们将使用 Felsenstein 的算法，该算法从树的末端（叶节点）向根节点进行计算。\n\n为清晰起见，我们用符号表示物种及其性状和枝长。\n设物种 A 为 *Rhinoceps ferox*，物种 B 为 *Goliathus parvus*，物种 C 为 *Chalcosoma medius*。\n性状值（体长）如下：\n$x_A = 45.5$ 毫米\n$x_B = 52.1$ 毫米\n$x_C = 38.0$ 毫米\n\n枝长如下：\n- 指向 A 的末端分支，$v_A = 2$ Myr。\n- 指向 B 的末端分支，$v_B = 2$ Myr。\n- 指向 C 的末端分支，$v_C = 5$ Myr。\n- 指向 A 和 B 共同祖先（我们称之为节点1）的内部分支，其长度为 $v_{1, \\text{stem}} = 3$ Myr。\n\n对于这棵树，该算法包括两个主要部分：首先，计算姐妹种 A 和 B 之间的对比值，并估计它们共同祖先（节点1）的状态；其次，计算节点1和物种 C 之间的对比值。\n\n**步骤1：计算姐妹种 A 和 B 之间的对比值。**\n第一个独立对比值 $C_1$ 是 A 和 B 之间性状值的差异，通过其枝长之和的平方根进行标准化。减法的顺序是任意的；我们将计算 $x_B - x_A$。\n$$\nC_1 = \\frac{x_B - x_A}{\\sqrt{v_A + v_B}}\n$$\n代入数值：\n$$\nC_1 = \\frac{52.1 - 45.5}{\\sqrt{2 + 2}} = \\frac{6.6}{\\sqrt{4}} = \\frac{6.6}{2} = 3.3\n$$\n\n**步骤2：估计共同祖先（节点1）的性状值。**\n节点1的性状值 $x_1$ 被估计为其后代性状值的加权平均值，其中权重是相应枝长的倒数。\n$$\nx_1 = \\frac{\\frac{1}{v_A}x_A + \\frac{1}{v_B}x_B}{\\frac{1}{v_A} + \\frac{1}{v_B}}\n$$\n由于 $v_A = v_B = 2$，这可以简化为算术平均值：\n$$\nx_1 = \\frac{x_A + x_B}{2} = \\frac{45.5 + 52.1}{2} = \\frac{97.6}{2} = 48.8\n$$\n因此，节点1处祖先的估计体长为 48.8 毫米。\n\n**步骤3：更新节点1的枝长。**\n在下一步计算中，节点1现在扮演一个叶节点的角色。它的枝长需要进行调整，以说明步骤2中估计引入的方差。新的枝长 $v'_1$ 是其原始主干枝长加上一个与从其延伸出的分支长度相关的项。\n$$\nv'_1 = v_{1, \\text{stem}} + \\frac{v_A v_B}{v_A + v_B}\n$$\n代入数值：\n$$\nv'_1 = 3 + \\frac{2 \\times 2}{2 + 2} = 3 + \\frac{4}{4} = 3 + 1 = 4\n$$\n节点1调整后的枝长为 4 Myr。\n\n**步骤4：计算根节点处的对比值。**\n最后一步是计算树根节点处的对比值。这个对比值 $C_{\\text{root}}$ 是在新表征的节点1和剩余物种 C 之间计算的。我们使用它们各自的性状值（$x_1$ 和 $x_C$）和枝长（$v'_1$ 和 $v_C$）。\n$$\nC_{\\text{root}} = \\frac{x_1 - x_C}{\\sqrt{v'_1 + v_C}}\n$$\n代入计算出的和给定的数值：\n$$\nC_{\\text{root}} = \\frac{48.8 - 38.0}{\\sqrt{4 + 5}} = \\frac{10.8}{\\sqrt{9}} = \\frac{10.8}{3} = 3.6\n$$\n在根节点处计算出的独立对比值为 3.6。\n\n**步骤5：最终四舍五入。**\n问题要求答案四舍五入到三位有效数字。计算出的值为 3.6，表示为三位有效数字时为 3.60。", "answer": "$$\\boxed{3.60}$$", "id": "1761373"}, {"introduction": "虽然独立比较法对于连续性状非常有效，但我们需要不同的工具来处理离散特征，例如花的颜色或某种结构的有无。最大简约法（Maximum Parsimony）是一种基础方法，通过寻找需要最少进化改变的演化情景来推断祖先状态。这个练习 [@problem_id:1761335] 将引导你理解简约法重建的逻辑，这是理解分类性状演化历史的一项关键技能。", "problem": "一位植物学家正在研究一个由五个假设的植物物种组成的小演化支的花色演化历史，这五个物种是：*Floris aenigma*、*Floris bardi*、*Floris caeruleus*、*Floris duo* 和 *Floris electra*。根据分子数据，它们的系统发育关系已经明确确立。物种 *F. aenigma* 和 *F. bardi* 是姐妹群，形成一个独特的谱系。物种 *F. duo* 和 *F. electra* 也是姐妹群。包含 *F. duo* 和 *F. electra* 的演化支又与 *F. caeruleus* 构成姐妹群。最后，包含 *F. aenigma* 和 *F. bardi* 的谱系与包含 *F. caeruleus*、*F. duo* 和 *F. electra* 的谱系构成姐妹群。\n\n这五个现存物种的花色观察如下：\n- *F. aenigma*：蓝色\n- *F. bardi*：红色\n- *F. caeruleus*：蓝色\n- *F. duo*：红色\n- *F. electra*：红色\n\n使用最大简约性原则，确定基部节点（所有五个物种的共同祖先）最可能的祖先花色状态（蓝色或红色）以及所需的最小演化改变次数（从蓝色到红色或从红色到蓝色的状态转换）。下列哪个陈述准确地描述了该重建结果？\n\nA. 祖先状态明确为蓝色，共发生 2 次演化改变。\n\nB. 祖先状态明确为红色，共发生 2 次演化改变。\n\nC. 祖先状态不明确（可能为蓝色或红色），共发生 2 次演化改变。\n\nD. 祖先状态明确为蓝色，共发生 3 次演化改变。\n\nE. 祖先状态不明确（可能为蓝色或红色），共发生 3 次演化改变。\n\nF. 根据给定信息无法进行重建。", "solution": "该问题要求使用最大简约性原则，在给定的系统发育树上重建基部节点的祖先状态。最大简约性原则指出，需要最少演化改变的演化假说是最优的。我们可以使用一种常被称为Fitch算法的两步算法来解决这个问题。\n\n首先，让我们表示系统发育树和性状状态。我们可以用物种的首字母来表示它们：A (*F. aenigma*)、B (*F. bardi*)、C (*F. caeruleus*)、D (*F. duo*) 和 E (*F. electra*)。状态为蓝色 (L) 和红色 (R)。\n在树的末端观察到的状态是：A=L, B=R, C=L, D=R, E=R。\n\n系统发育树的文字描述对应于括号表示法 ((A, B), (C, (D, E)))。让我们标记内部节点：\n- `N1`：D 和 E 的最近共同祖先。\n- `N2`：C、D 和 E 的最近共同祖先（即 C 和 `N1` 的共同祖先）。\n- `N3`：A 和 B 的最近共同祖先。\n- `N4`：基部节点，所有五个物种的最近共同祖先（即 `N2` 和 `N3` 的共同祖先）。\n\n**第一步：自下而上的状态集分配**\n在这一步中，我们从树的末端向上工作到根节点（`N4`），为每个内部节点分配一个可能的状态集。我们还计算总的改变次数（简约性分数）。\n\n从两个后代节点确定父节点状态集的规则如下：\n- 如果后代的状态集有非空交集，则父节点的状态集就是这个交集。\n- 如果后代的状态集交集为空，则父节点的状态集是它们的并集。在这种情况下，我们将演化改变的计数器加一。\n\n让我们应用这个规则：\n\n1.  **节点 `N1`（D 和 E 的祖先）：**\n    -   后代 D 的状态集是 {R}。\n    -   后代 E 的状态集是 {R}。\n    -   {R} 和 {R} 的交集是 {R}。\n    -   所以，`N1` 的状态集是 {R}。\n    -   交集非空，所以改变次数增加 0。\n\n2.  **节点 `N3`（A 和 B 的祖先）：**\n    -   后代 A 的状态集是 {L}。\n    -   后代 B 的状态集是 {R}。\n    -   {L} 和 {R} 的交集为空。\n    -   并集是 {L, R}。所以，`N3` 的状态集是 {L, R}。\n    -   交集为空，所以我们增加改变次数：分数 = 1。\n\n3.  **节点 `N2`（C 和 `N1` 的祖先）：**\n    -   后代 C 的状态集是 {L}。\n    -   后代 `N1` 的状态集是 {R}。\n    -   {L} 和 {R} 的交集为空。\n    -   并集是 {L, R}。所以，`N2` 的状态集是 {L, R}。\n    -   交集为空，所以我们增加改变次数：分数 = 1 + 1 = 2。\n\n4.  **节点 `N4`（基部节点，`N2` 和 `N3` 的祖先）：**\n    -   后代 `N2` 的状态集是 {L, R}。\n    -   后代 `N3` 的状态集是 {L, R}。\n    -   {L, R} 和 {L, R} 的交集是 {L, R}。\n    -   所以，`N4` 的状态集是 {L, R}。\n    -   交集非空，所以改变次数增加 0。\n\n在第一步结束时，总的最小演化改变次数（简约性分数）是 2。基部节点 `N4` 的状态集是 {L, R}。\n\n**第二步：自上而下的最终状态分配**\n基部节点 `N4` 的状态集 {L, R} 表明祖先状态是不明确的。无论是蓝色 (L) 还是红色 (R) 作为祖先状态，都会导致相同的总改变次数（2 次）。让我们来验证一下。\n\n自上而下这一步的规则是：\n- 如果一个后代节点的状态集包含其父节点被分配的状态，那么该后代就被分配那个状态。\n- 如果一个后代节点的状态集不包含其父节点的状态，我们可以从该后代的状态集中选择任何一个状态。这会强制在通往该后代的枝上发生一次改变。\n\n**情景 1：假设基部节点 `N4` 是蓝色 (L)。**\n- `N4` = L。\n- `N3` 的状态集是 {L, R}。它包含 L，所以我们分配 `N3` = L。\n- `N2` 的状态集是 {L, R}。它包含 L，所以我们分配 `N2` = L。\n- 现在我们看这些节点的子节点：\n    - 从 `N3`=L：A 是 L（无改变），B 是 R（1 次改变）。\n    - 从 `N2`=L：C 是 L（无改变），`N1` 必须被分配一个状态。`N1` 的状态集是 {R}，不包含 L。所以我们从它的状态集中分配一个状态给 `N1`，即 `N1`=R。这需要在从 `N2` 到 `N1` 的枝上发生 1 次改变。\n- 此情景的总改变次数：1（对于 B） + 1（对于 `N1`）= 2。\n\n**情景 2：假设基部节点 `N4` 是红色 (R)。**\n- `N4` = R。\n- `N3` 的状态集是 {L, R}。它包含 R，所以我们分配 `N3` = R。\n- `N2` 的状态集是 {L, R}。它包含 R，所以我们分配 `N2` = R。\n- 现在我们看这些节点的子节点：\n    - 从 `N3`=R：A 是 L（1 次改变），B 是 R（无改变）。\n    - 从 `N2`=R：C 是 L（1 次改变），`N1` 的状态集是 {R}，包含 R。所以我们分配 `N1`=R（无改变）。\n- 此情景的总改变次数：1（对于 A） + 1（对于 C）= 2。\n\n两种情景都导致总共 2 次改变，这是我们在第一步中计算出的最小可能分数。由于蓝色和红色对于基部节点的状态都是同样简约的选择，因此祖先状态是不明确的。\n\n因此，该重建需要至少 2 次演化改变，并且基部节点的祖先状态是不明确的（可能是蓝色或红色）。这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1761335"}, {"introduction": "在学习了如何校正系统发育关系后，理解如果不这样做会发生什么至关重要。这个思想实验 [@problem_id:1953885] 通过对比标准回归分析（OLS）和考虑系统发育关系的回归分析（PGLS），揭示了共享祖先如何掩盖真实的相关性或制造虚假的关联。通过分析这些看似矛盾的结果，你将对系统发育比较方法为何对于得出准确的进化结论至关重要，建立起更深刻的直觉。", "problem": "一位进化生物学家正在研究一个包含50种蜥蜴的演化支中两个连续性状之间的关系：前臂长度（性状X）和攀爬速度（性状Y）。她假设较长的前臂可能会带来生物力学上的优势，从而导致更快的攀爬速度。为了检验这一假设，她对数据进行了两种不同的统计分析。\n\n首先，她进行了一项标准的普通最小二乘法（OLS）回归分析，该分析将这50个物种中的每一个都视为一个独立的数据点。此分析未能发现前臂长度和攀爬速度之间存在统计学上显著的关系（p > 0.05）。\n\n其次，考虑到物种因共享祖先而非独立的特性，她进行了一项系统发育广义最小二乘法（PGLS）回归分析。这种方法与OLS类似，但它整合了这50种蜥蜴的进化树（系统发育），以考虑亲缘关系较近的物种预计会彼此更相似这一事实。PGLS分析揭示了前臂长度和攀爬速度之间存在一个高度显著的正相关关系（p < 0.01）。\n\n鉴于这些相互矛盾的结果，下列哪个陈述提供了最合理的进化解释？\n\nA. PGLS的结果是一个统计假象（假阳性），因为添加系统发育信息人为地夸大了性状之间的相关性。作出更少假设的OLS结果应被认为更可靠。\n\nB. 前臂长度和攀爬速度之间的关系在整个系统发育过程中正在非常迅速地、趋同地进化。许多独立的谱系已经独立地进化出了性状间的相似关系。\n\nC. 这一显著关系主要由少数古老的进化事件驱动。例如，一个早期的祖先可能进化出了长前臂和快的攀爬速度，它的许多后代继承了这种组合，而另一个主要谱系则保留了短前臂和慢的攀爬速度。这造成了性状值的大规模系统发育聚类，而这是OLS分析所忽略的。\n\nD. OLS的结果是一个假阴性。PGLS方法只是一种统计功效更强的检验，因此无论进化模式如何，它都更有可能检测到任何真实的相关性。", "solution": "目标是理解当一个非系统发育回归显示无显著相关性，而一个系统发育回归显示有显著相关性时，可以推断出什么。这种情况考验了系统发育信号的核心概念及其对性状相关性分析的影响。\n\n让我们来分析这两种分析方法：\n1.  **普通最小二乘法（OLS）回归：** 这种标准的统计方法假设所有数据点都是独立同分布的。当应用于物种数据时，它实际上忽略了它们共享的进化历史。\n2.  **系统发育广义最小二乘法（PGLS）回归：** 这种方法根据物种共享的进化历史（系统发育）明确地模拟了它们之间的预期协方差。它纠正了亲缘关系近的物种并非独立观测值这一事实。\n\n关键的观察是两者结果的差异：\n- OLS（忽略系统发育）：无显著相关性。\n- PGLS（考虑系统发育）：显著正相关。\n\n让我们根据这一差异来评估各个选项：\n\n**A. PGLS的结果是一个统计假象... OLS结果...应被认为更可靠。**\n这是不正确的。在处理物种数据时，OLS回归中数据点独立性的基本假设被违反了。物种是分支进化过程的产物，因此它们不是独立的。PGLS旨在纠正这一特定问题，使其结果在比较性研究的背景下更为可靠，而非更不可靠。当系统发育影响存在时忽略它，可能导致不正确的推断和虚高的I型错误率（假阳性），但也可能掩盖真实的模式，导致II型错误（假阴性），正如本问题所示。\n\n**B. 前臂长度和攀爬速度之间的关系正在非常迅速地、趋同地进化...**\n这描述了一种情景，即相关性在进化树上反复、独立地出现。如果许多谱系都在独立地进化出更长的前臂和更快的攀爬速度，那么这些独立事件即使在OLS框架下也会为相关性提供强有力的统计证据。在这样一个“高度趋同”的情景中，我们预期OLS也会发现一个显著的结果，而且可能是一个非常强的结果。由于OLS*没有*发现显著结果，所以这种解释是不太可能的。\n\n**C. 这一显著关系主要由少数古老的进化事件驱动...**\n这是最合理的解释。想象一下这些蜥蜴的进化树。假设在它们历史的早期，该谱系分裂成两个主要演化支。在一个演化支中，一个关键祖先进化出了长前臂和相应的快速攀爬速度；它的所有后代（比如25个物种）都继承了这一性状组合。在另一个主要演化支中，短前臂和慢速的祖先状态被保留下来，它的25个后代也继承了那种组合。\n\n从将所有50个物种视为散点图上独立点的OLS角度来看，你会看到两团点：一簇是低X值和低Y值，另一簇是高X值和高Y值。在每个簇内部，可能没有明显的趋势，因此跨越所有50个点的总体回归线可能是平坦且不显著的。OLS分析之所以失败，是因为变异不是随机分布的，而是受系统发育结构化的。\n\nPGLS分析正确地识别出主要的“事件”是这两个大演化支之间的转变。它正确地将这种相关性归因于这一深远的进化历史，揭示了潜在的正相关关系，而这种关系在其他情况下会被系统发育惯性（即亲缘关系近的物种倾向于彼此相似）所掩盖。因此，两种检验之间的差异直接指向数据中存在强烈的系统发育信号，其中相关性是由主要的、古老的转变而非许多小的、独立的转变所确立的。\n\n**D. OLS的结果是一个假阴性。PGLS方法只是一种统计功效更强的检验...**\n这是一种过度简化，并可能具有误导性。虽然PGLS有时可以提高统计功效，但在所有情况下它并非普遍比OLS“功效更强”。它的主要功能是为数据中的误差结构提供一个*正确*的模型。事实上，如果OLS回归显示出一个显著的结果，而这个结果纯粹是系统发育结构的假象（例如，两个不相关的演化支恰好在两个性状上都存在差异），PGLS分析可以在考虑系统发育后正确地显示出相关性*不*显著。如果一个检验的基本假设被违反，那么它的功效就无关紧要了。关键在于PGLS正确地模拟了进化过程，而在本案例中，这个正确的模型揭示了一个不正确的OLS模型所忽略的模式。C中的解释更精确地说明了导致这种统计结果的具体进化模式。\n\n因此，最准确的解释是，相关性是真实的，但是是系统发育结构化的，源于进化树深处的重大转变。", "answer": "$$\\boxed{C}$$", "id": "1953885"}]}