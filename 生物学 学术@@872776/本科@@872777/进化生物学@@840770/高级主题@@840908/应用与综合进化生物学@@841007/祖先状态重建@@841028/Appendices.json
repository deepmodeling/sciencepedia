{"hands_on_practices": [{"introduction": "祖先状态重建的核心是评估不同的演化假说。简约法是最直观的方法之一，其原则是寻找需要最少演化步骤的解释。这个练习将带你入门，通过一个清晰的案例 [@problem_id:1908137]，学习如何在一个给定的系统发育树上，一步步计算解释现有性状分布所需的最小改变次数。", "problem": "一位演化生物学家正在研究一组虚构昆虫的幼虫行为演化。五个现存物种之间的演化关系（系统发育）描述如下：*Glimmerwing*和*Shadowspinner*是姐妹物种（它们共享一个最近的共同祖先）。这对物种的最近亲是*Stonemantle*物种。另一对姐妹物种，*Sunstreaker*和*Duskdiver*，形成一个独立的、不同的演化支。包含*Glimmerwing*、*Shadowspinner*和*Stonemantle*的演化支与包含*Sunstreaker*和*Duskdiver*的演化支本身是姐妹群，它们源自所有五个物种的唯一共同祖先。\n\n正在研究的一个关键性状是幼虫的取食行为，其可以是两种状态之一：‘取食型’（幼虫主动消耗食物）或‘非取食型’（幼虫完全依靠卵中的卵黄储备发育）。在五个现存物种中观察到的状态如下：\n- *Glimmerwing*：取食型\n- *Shadowspinner*：取食型\n- *Stonemantle*：非取食型\n- *Sunstreaker*：取食型\n- *Duskdiver*：非取食型\n\n假设所有五个物种的共同祖先是‘非取食型’，请确定解释系统发育树上这种性状分布所需的最少演化变化次数（即‘取食型’和‘非取食型’状态之间的转换）。这个值被称为总简约性分数。", "solution": "设两种幼虫状态用符号$F$（取食型）和$N$（非取食型）表示。将五个物种缩写如下：$G$ = Glimmerwing $(F)$，$H$ = Shadowspinner $(F)$，$T$ = Stonemantle $(N)$，$U$ = Sunstreaker $(F)$，$D$ = Duskdiver $(N)$。系统发育树为 $(((G,H),T),(U,D))$，其中根节点$R$是所有五个物种的共同祖先。定义内部节点：$X$为$G$和$H$的最近共同祖先，$A$为$X$和$T$的祖先，$B$为$U$和$D$的祖先。\n\n使用Fitch简约性算法。对于每个节点$v$，设$S_{v}$为使以$v$为根的子树中变化最小的可能状态集合。\n\n叶节点集合：\n$$\nS_{G}=\\{F\\},\\quad S_{H}=\\{F\\},\\quad S_{T}=\\{N\\},\\quad S_{U}=\\{F\\},\\quad S_{D}=\\{N\\}.\n$$\n\n自下而上计算内部节点集合：\n- 对于$X$（子节点为$G$和$H$），$S_{X}=S_{G}\\cap S_{H}=\\{F\\}$（没有增加变化）。\n- 对于$A$（子节点为$X$和$T$），$S_{A}=S_{X}\\cap S_{T}=\\emptyset$，因此设$S_{A}=S_{X}\\cup S_{T}=\\{F,N\\}$并增加$1$次变化。\n- 对于$B$（子节点为$U$和$D$），$S_{B}=S_{U}\\cap S_{D}=\\emptyset$，因此设$S_{B}=S_{U}\\cup S_{D}=\\{F,N\\}$并增加$1$次变化。\n- 对于根节点$R$（子节点为$A$和$B$），$S_{R}=S_{A}\\cap S_{B}=\\{F,N\\}$（没有额外的变化）。\n\n因此，在根节点未指定的情况下，最小变化次数为$1+1=2$。现在引入给定的根节点状态：所有五个物种的祖先是$N$。由于$N\\in S_{R}$，我们指定$R=N$，而不会引起任何额外的变化。\n\n自上而下分配状态以实现最小值：\n- 选择$A=N$和$B=N$，因为$N\\in S_{A}$且$N\\in S_{B}$，这样可以避免在分支$R\\to A$和$R\\to B$上产生额外的变化。\n- 在演化支$A$中：从$A=N$到$X=\\{F\\}$需要一次变化$N\\to F$；从$A=N$到$T=N$不需要变化；从$X=F$到$G=F$和$H=F$不需要变化。\n- 在演化支$B$中：从$B=N$到$U=F$需要一次变化$N\\to F$；从$B=N$到$D=N$不需要变化。\n\n因此，总简约性分数为$1+1=2$，这是与观察到的末端状态和指定的非取食型根节点相容的最小值。", "answer": "$$\\boxed{2}$$", "id": "1908137"}, {"introduction": "简约法不仅能计算演化变化的次数，更能帮助我们重建具体的演化路径，甚至揭示出复杂的演化事件，例如性状的“逆转”。在这个关于蝾螈繁殖模式的练习中 [@problem_id:1908182]，你将应用简约法来推断一个性状何时以及如何恢复到其祖先状态。这展示了祖先状态重建在讲述详细演化故事中的力量。", "problem": "为了解一个相关的蝾螈物种群的繁殖方式的演化，我们对其进行了研究。已知该整个类群的祖先状态是包含水生幼体阶段的生活史。一些物种演化出了直接发育，其幼体孵化时即为微缩成体，完全跳过了幼体阶段。\n\n现给出六个物种（一个外群 O 和五个内群物种 A, B, C, D, E）观察到的繁殖方式及其系统发育关系。\n\n**观察到的性状：**\n- 物种 O（外群）：水生幼体\n- 物种 A：直接发育\n- 物种 B：水生幼体\n- 物种 C：直接发育\n- 物种 D：直接发育\n- 物种 E：直接发育\n\n**系统发育关系：**\n其关系描述如下：姐妹物种 A 和 B 形成一个演化支。该演化支继而与物种 C 构成姐妹群。这个更大的 (A, B, C) 演化支与物种 D 构成姐妹群。这整个 (A, B, C, D) 演化支与物种 E 构成姐妹群。最后，物种 O 是整个内群 (A, B, C, D, E) 的外群。\n\n使用最大简约性原则（即，倾向于需要最少演化改变次数的解释），确定该性状最可能的演化历史。以下哪个陈述正确地描述了这一历史？\n\nA. 2 次改变；在导致物种 B 的谱系中，发生了从直接发育到水生幼体的逆转。\n\nB. 2 次改变；直接发育在导致物种 E 的谱系中和导致 (A, B, C, D) 祖先的谱系中独立演化。\n\nC. 3 次改变；直接发育演化了一次，随后在导致物种 O 和物种 B 的谱系中丢失。\n\nD. 3 次改变；直接发育在三个独立的谱系中独立演化。\n\nE. 1 次改变；直接发育在内群的祖先中演化了一次，而物种 B 代表一个观察错误。", "solution": "设祖先状态和外群状态为水生幼体，编码为 $0$，直接发育编码为 $1$。观察到的末端状态为：$A=1$，$B=0$，$C=1$，$D=1$，$E=1$，以及外群 $O=0$。内群的拓扑结构是梳状树 $(((((A,B),C),D),E))$，其中 $O$ 是内群根节点的外群。\n\n使用状态集，自下而上地应用 Fitch 简约性算法：\n- 在叶节点处：$S(A)=\\{1\\}$, $S(B)=\\{0\\}$, $S(C)=\\{1\\}$, $S(D)=\\{1\\}$, $S(E)=\\{1\\}$, $S(O)=\\{0\\}$。\n- 节点 $(A,B)$：$S(AB)=S(A)\\cap S(B)=\\emptyset$，因此 $S(AB)=S(A)\\cup S(B)=\\{0,1\\}$，这会增加 1 次改变。\n- 节点 $(AB,C)$：$S(ABC)=S(AB)\\cap S(C)=\\{1\\}$，增加 0 次改变。\n- 节点 $(ABC,D)$：$S(ABCD)=S(ABC)\\cap S(D)=\\{1\\}$，增加 0 次改变。\n- 节点 $(ABCD,E)$（内群根节点）：$S(ABCDE)=S(ABCD)\\cap S(E)=\\{1\\}$，增加 0 次改变。\n- 带有外群的根节点：$S(\\text{root})=S(ABCDE)\\cap S(O)=\\emptyset$，因此取并集 $\\{0,1\\}$ 并增加 1 次改变。\n\n因此，最小改变次数为 $1+1=2$。一个与最小化改变次数一致的自上而下的状态分配方法是，将内群根节点的状态设为 $1$（因为 $S(ABCDE)=\\{1\\}$），并将状态 $1$ 向下传播到内部支系 $ABC$ 和 $AB$。在节点 $AB$（其状态集为 $S(AB)=\\{0,1\\}$），选择状态 $1$ 以避免在内部支系上产生额外的改变。这样，末端唯一的差异是在支系 $B$ 上，需要一次从 $1 \\to 0$ 的改变（逆转为水生幼体）。另一次改变是，在从总祖先（与状态为 $0$ 的 $O$ 共享）到内群根节点的支系上，发生了一次从 $0 \\to 1$ 的单一演化起源。\n\n这得出的演化历史是：在内群的基部有一次直接发育的获得，在谱系 B 中有一次向水生幼体的逆转，即 2 次改变，并在 B 中有一次逆转，这与选项 A 相符。", "answer": "$$\\boxed{A}$$", "id": "1908182"}, {"introduction": "除了简约法，最大似然法是另一种强大但概念上不同的重建祖先状态的工具。该方法并非寻找最少的改变，而是基于一个明确的演化模型，来计算哪种祖先状态最有可能（具有最高的概率）产生我们今天观察到的性状分布。通过这个练习 [@problem_id:1908136]，你将直接比较这两种方法，并理解为何不同的方法和假设可能对同一个演化问题得出不同的结论。", "problem": "一位演化生物学家正在研究家犬的行为演化。基于基因组数据，构建了一个包含四个特定品种的简化系统发育树。该树由两个主要分支组成，它们共享一个共同的祖先，这个祖先代表了这家犬系统发育的根。第一个分支包含 German Shepherd 和 Border Collie。第二个分支包含 Pug 和 Beagle。\n\n这位生物学家对重建“牧羊本能”这一复杂行为性状的祖先状态感兴趣。对于每个品种，该性状被分为两种离散状态之一：牧羊（H）或非牧羊（N）。四个品种的观察状态如下：\n- German Shepherd: H\n- Border Collie: H\n- Pug: N\n- Beagle: N\n\n已知所有家犬的祖先——狼，就这一特定性状类别而言，被归类为非牧羊（N）。你的任务是使用两种不同的计算方法来重建这家犬系统发育树根部该性状的状态。\n\n**第一部分：简约性分析**\n将最大简约性原则应用于此系统发育和性状数据。确定解释所观察到的牧羊本能分布所需的最少演化变化次数（即从 H 到 N 或从 N 到 H）。\n\n**第二部分：最大似然分析**\n对于最大似然分析，提出了一个简单的非对称性状演化模型。该模型假设，在系统发育树的任何给定分支上，性状从牧羊变为非牧羊（一次丢失事件）的概率为 $p_{\\text{H}\\to\\text{N}} = 0.3$，而从非牧羊变为牧羊（一次获得事件）的概率为 $p_{\\text{N}\\to\\text{H}} = 0.1$。因此，状态保持为牧羊的概率是 $p_{\\text{H}\\to\\text{H}} = 0.7$，状态保持为非牧羊的概率是 $p_{\\text{N}\\to\\text{N}} = 0.9$。假设这些概率在系统发育树的所有分支上都是一致的。\n\n计算根部祖先具有牧羊性状的似然与具有非牧羊性状的似然之比，定义为 $R = \\frac{L(\\text{root state = H})}{L(\\text{root state = N})}$。\n\n你的任务是给出第一部分中的最少变化次数，以及第二部分中比率 $R$ 的数值。将 $R$ 的值四舍五入到四位有效数字。", "solution": "简约性分析：这个有四个末端的有根树由两个“樱桃”组成：分支 A 包含 German Shepherd 和 Border Collie，两者都被观察为 $H$；分支 B 包含 Pug 和 Beagle，两者都被观察为 $N$。使用 Fitch 简约性程序，在叶节点处分配集合：分支 A 的两个成员均为 $\\{H\\}$，分支 B 的两个成员均为 $\\{N\\}$。在支撑每个“樱桃”的内部节点上，交集非空，因此分支 A 的祖先处为 $\\{H\\}$，分支 B 的祖先处为 $\\{N\\}$。在根节点处，$\\{H\\}$ 和 $\\{N\\}$ 的交集为空，因此在分隔 $H$ 和 $N$ 子树的单一边上需要一次变化。因此，解释所观察到的分布所需的最少变化次数是 $1$。\n\n最大似然分析：每个分支具有相同的转移概率\n$$\np_{\\text{H}\\to\\text{H}}=0.7,\\quad p_{\\text{H}\\to\\text{N}}=0.3,\\quad p_{\\text{N}\\to\\text{H}}=0.1,\\quad p_{\\text{N}\\to\\text{N}}=0.9.\n$$\n对于分支 A（两个 $H$ 叶节点），给定该分支祖先状态 $i\\in\\{H,N\\}$ 时子树的条件似然为\n$$\nf_{A}(H)=(p_{\\text{H}\\to\\text{H}})^{2}=0.7^{2}=0.49,\\qquad f_{A}(N)=(p_{\\text{N}\\to\\text{H}})^{2}=0.1^{2}=0.01.\n$$\n对于分支 B（两个 $N$ 叶节点），条件似然为\n$$\nf_{B}(H)=(p_{\\text{H}\\to\\text{N}})^{2}=0.3^{2}=0.09,\\qquad f_{B}(N)=(p_{\\text{N}\\to\\text{N}})^{2}=0.9^{2}=0.81.\n$$\n设 $L(H)$ 表示在根节点为 $H$ 的条件下观察到末端状态的似然，而 $L(N)$ 表示在根节点为 $N$ 的条件下的似然。对两个内部分支祖先的未知状态求和，得到\n$$\ng_{A}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{A}(N)=0.7\\cdot 0.49+0.3\\cdot 0.01=0.346,\n$$\n$$\ng_{B}(H)=p_{\\text{H}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{H}\\to\\text{N}}\\,f_{B}(N)=0.7\\cdot 0.09+0.3\\cdot 0.81=0.306,\n$$\n所以\n$$\nL(H)=g_{A}(H)\\,g_{B}(H)=0.346\\cdot 0.306=0.105876.\n$$\n类似地，\n$$\ng_{A}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{A}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{A}(N)=0.1\\cdot 0.49+0.9\\cdot 0.01=0.058,\n$$\n$$\ng_{B}(N)=p_{\\text{N}\\to\\text{H}}\\,f_{B}(H)+p_{\\text{N}\\to\\text{N}}\\,f_{B}(N)=0.1\\cdot 0.09+0.9\\cdot 0.81=0.738,\n$$\n所以\n$$\nL(N)=g_{A}(N)\\,g_{B}(N)=0.058\\cdot 0.738=0.042804.\n$$\n所求的比率为\n$$\nR=\\frac{L(\\text{root state}=H)}{L(\\text{root state}=N)}=\\frac{0.105876}{0.042804}\\approx 2.474,\n$$\n四舍五入到四位有效数字。\n\n因此，在简约性分析下，最少变化次数为 $1$，似然比 $R$ 约为 $2.474$。", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 2.474 \\end{pmatrix}}$$", "id": "1908136"}]}