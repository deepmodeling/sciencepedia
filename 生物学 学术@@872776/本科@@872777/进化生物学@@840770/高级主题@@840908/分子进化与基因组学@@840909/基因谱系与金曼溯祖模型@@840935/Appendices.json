{"hands_on_practices": [{"introduction": "金氏溯祖理论的核心思想是追溯样本中基因谱系的合并过程。这个练习将带你完成最基本的计算：估算样本中第一对谱系发生合并所需的预期时间。通过这个实践，你将掌握溯祖事件发生速率与有效种群大小及样本量之间的基本关系 [@problem_id:1931569]。", "problem": "一位群体遗传学家正在使用基因组数据研究一种致病细菌的近代进化史。这些细菌被维持在一个大型受控的实验室环境中，其种群动态可以用单倍体生物的Wright-Fisher模型来近似。有效种群大小 $N_e$ 被估计为一个常数 $5.0 \\times 10^7$。\n\n从这个种群中，该遗传学家从一个包含 $n = 25$ 个个体细菌的样本中，获得了一个非重组基因的完整DNA序列。使用溯祖理论，她希望确定其样本中最早祖先事件的预期时间尺度。\n\n计算回溯时间，直到抽样的基因谱系中发生第一个溯祖事件所需的预期代数。答案以代为单位，并四舍五入到三位有效数字。", "solution": "我们使用针对具有恒定有效种群大小 $N_{e}$ 的单倍体Wright-Fisher种群的标准溯祖模型，来为样本谱系建模。当存在 $k$ 个祖先谱系时，任何特定一对在紧邻的前一代中发生溯祖的概率是 $1/N_{e}$（单倍体），并且存在 $\\binom{k}{2}$ 个不同的谱系对。对于大的 $N_e$ 值，在同一代中发生多次溯祖的概率可以忽略不计，因此到下一个溯祖事件的等待时间近似服从参数为\n$$\np_{k} \\approx \\frac{\\binom{k}{2}}{N_{e}},\n$$\n的几何分布，它可以很好地被一个速率为\n$$\n\\lambda_{k} = \\frac{\\binom{k}{2}}{N_{e}}.\n$$\n的指数分布所近似。因此，在给定 $k$ 个谱系的情况下，到下一个溯祖事件的预期等待时间（以代为单位）是\n$$\n\\mathbb{E}[T_{k}] = \\frac{1}{\\lambda_{k}} = \\frac{N_{e}}{\\binom{k}{2}}.\n$$\n对于一个大小为 $n=25$ 的样本中的最早祖先事件，我们令 $k=n$：\n$$\n\\mathbb{E}[T_{\\text{first}}] = \\frac{N_{e}}{\\binom{25}{2}} = \\frac{5.0 \\times 10^{7}}{\\frac{25 \\cdot 24}{2}} = \\frac{5.0 \\times 10^{7}}{300}.\n$$\n进行除法运算并四舍五入到三位有效数字，得到\n$$\n\\mathbb{E}[T_{\\text{first}}] = 1.67 \\times 10^{5}.\n$$\n这就是在25个抽样谱系中，回溯到第一个溯祖事件所需的预期代数。", "answer": "$$\\boxed{1.67 \\times 10^{5}}$$", "id": "1931569"}, {"introduction": "基因谱系不仅有其时间深度，还有其拓扑结构或“形状”。这个练习将引导你探讨一个关键概念：在随机合并的过程中，并非所有谱系树的形状都是等概率的。通过分析一个包含四个谱系的简单系统，你将学会如何利用组合推理来计算得到一个特定（完全对称）拓扑结构的可能性 [@problem_id:1931613]。", "problem": "考虑一个由四个服务器节点（标记为 N1, N2, N3, N4）组成的全连接分布式网络。每个节点最初都拥有一个唯一的、独立的祖先数据块。该系统经历一个随机的成对同步过程以确保数据一致性。在该过程的每一步中，都会随机选择一对具有不同数据历史的节点，并将其数据块合并。此事件之后，它们被视为一个具有共享数据历史的单一实体。例如，如果 N1 和 N2 合并，它们会形成一个新的实体 (N1,N2)，此时系统实际上包含三个不同的数据谱系：(N1,N2), N3 和 N4。该过程持续进行，直到所有节点的数据都可以追溯到单个共同的祖先数据块，从而形成一个完整的谱系历史。\n\n在任何给定时间，任何一对不同的数据谱系被选中进行下一次合并事件的概率是相等的。\n\n如果四个初始节点形成两对，这两对独立合并，然后这两个产生的祖先谱系再合并，那么这个谱系历史就被定义为“完全对称”的。例如，一个 N1 和 N2 合并、N3 和 N4 合并，然后所产生的实体 (N1,N2) 和 (N3,N4) 再合并的历史是完全对称的。\n\n确定这个四节点系统随机生成的谱系历史是完全对称的精确概率。将你的最终答案表示为最简分数形式。", "solution": "该问题要求在一个随机合并过程中，为一个包含 $n=4$ 个谱系的样本获得一个完全对称的谱系拓扑的概率，这等同于标准的 Kingman 溯祖模型。设四个初始谱系为 L1, L2, L3 和 L4，分别对应于节点 N1, N2, N3 和 N4。\n\n生成谱系的过程涉及一系列三个合并（溯祖）事件：\n1.  谱系数量从 4 减少到 3。\n2.  谱系数量从 3 减少到 2。\n3.  谱系数量从 2 减少到 1，到达最近共同祖先 (Most Recent Common Ancestor, MRCA)。\n\n谱系的拓扑结构由这些合并事件的顺序决定。在每一步中，任何一对现存的谱系都有同等可能成为下一对合并的谱系。\n\n**步骤1：第一次合并事件 (4个谱系 -> 3个谱系)**\n\n最初，有 $k=4$ 个谱系。不同谱系对的数量由二项式系数给出：\n$$ \\binom{4}{2} = \\frac{4 \\times 3}{2} = 6 $$\n这些谱系对是 {L1,L2}, {L1,L3}, {L1,L4}, {L2,L3}, {L2,L4}, {L3,L4}。\n当这 6 对中的一对合并时，过程开始。由于所有谱系对成为*第一对*合并的概率都相等，因此第一对的选择尚不限制最终的拓扑形状。根据对称性，我们可以假设任何特定的一对首先合并来分析该过程，而不失一般性。我们假设首先合并的谱系对是 {L1, L2}。此事件后，系统包含 $k=3$ 个谱系：{(L1,L2), L3, L4}。\n\n**步骤2：第二次合并事件 (3个谱系 -> 2个谱系)**\n\n系统现在有 3 个谱系。我们将其标记为 A = (L1,L2), B = L3, 和 C = L4。可用于下一次合并的不同谱系对的数量是：\n$$ \\binom{3}{2} = \\frac{3 \\times 2}{2} = 3 $$\n可能的谱系对是 {A, B}, {A, C}, 和 {B, C}。代入原始谱系标签，这些对应于以下谱系对：\n1.  {(L1,L2), L3}\n2.  {(L1,L2), L4}\n3.  {L3, L4}\n\n问题定义了“完全对称”的拓扑。为了使最终拓扑对称，四个初始谱系必须首先被划分为两个独立合并的对。由于我们假设 {L1, L2} 在第一步合并，对称拓扑要求剩下的两个独立谱系 {L3, L4} 必须在第二步合并。\n\n因此，在第二次合并事件的三个等可能结果中，只有一个结果——即 {L3, L4} 的合并——会导致对称拓扑。另外两个结果，即 L3 或 L4 与祖先谱系 (L1,L2) 合并，将导致不对称或“不平衡”的拓扑（例如 (((L1,L2),L3),L4)）。\n\n第二次合并是特定谱系对 {L3, L4} 的概率是：\n$$ P(\\text{second merge is {L3,L4}}) = \\frac{\\text{Number of symmetric-forming outcomes}}{\\text{Total number of outcomes}} = \\frac{1}{3} $$\n\n**步骤3：第三次合并事件 (2个谱系 -> 1个谱系)**\n\n如果第二个事件是 {L3, L4} 的合并，系统将剩下 $k=2$ 个谱系：{(L1,L2), (L3,L4)}。只有一对可能的谱系可以合并：\n$$ \\binom{2}{2} = 1 $$\n这最后一次合并将以概率 1 发生，从而完成完全对称的谱系 ((L1,L2),(L3,L4))。\n\n**结论**\n\n获得对称拓扑的总概率完全由在第二次合并事件中做出正确选择的概率决定。第一个事件可以是任何一对，而一旦剩下两个谱系，第三个事件就是确定性的。关键的转折点是从 3 个谱系过渡到 2 个谱系，其中三个可能事件中只有一个能导向所需的对称结构。\n\n因此，总概率就是在步骤 2 中计算出的概率。\n$$ P(\\text{symmetric topology}) = \\frac{1}{3} $$\n由于过程的对称性，这个结果与哪一对首先合并无关。对于第一对的任何选择，第二对（在三种可能性中）总有且仅有一个选择会产生对称拓扑。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "1931613"}, {"introduction": "溯祖理论的强大之处在于其模型可以调整以适应真实的生物学情景。本练习探讨了基因组不同部分（常染色体与X染色体）的溯祖历史差异，这源于它们不同的遗传模式和有效种群大小。通过解决这个问题，你将理解遗传系统如何直接影响我们对共同祖先时间的预期，并学会如何为特定基因座调整溯祖模型的关键参数 [@problem_id:1931615]。", "problem": "考虑一个假设的蛾类物种，Arcturian Sky-Moth，其群体大小恒定为 $N$ 个个体，并遵循标准Wright-Fisher群体遗传学模型的假设。这包括离散、不重叠的世代和随机交配。该物种是二倍体，其性别决定系统类似于人类：雌性是同配性别（XX），雄性是异配性别（XY）。群体中的性别比始终为1:1（即雄性和雌性数量相等）。\n\n一位进化生物学家正在研究该物种中两个不同中性基因座的深层祖先历史。一个基因座位于常染色体上，另一个位于X染色体上。根据Kingman溯祖模型，群体内一个基因座上所有基因拷贝的平均或期望最近共同祖先时间（$E[T_{MRCA}]$）与该基因座的有效群体大小（$N_e$）成正比。\n\n确定X连锁基因座与常染色体基因座的期望最近共同祖先时间的理论比率。将您的答案表示为单个闭式解析表达式。", "solution": "我们给定一个Wright-Fisher群体，其中有 $N$ 个二倍体个体，雄性和雌性数量相等，以及一个位于常染色体或X染色体上的中性基因座。在Kingman溯祖模型下，一个基因座的MRCA期望时间与该基因座特异性的有效群体大小成正比，因此对于两个基因座 $L_{1}$ 和 $L_{2}$，\n$$\n\\frac{E[T_{MRCA}(L_{1})]}{E[T_{MRCA}(L_{2})]}=\\frac{N_{e}^{L_{1}}}{N_{e}^{L_{2}}}.\n$$\n因此，只需计算比率 $N_{e}^{X}/N_{e}^{A}$。\n\n设 $N_{f}$ 和 $N_{m}$ 分别表示雌性和雄性的数量。性别比为 $1:1$，因此\n$$\nN_{f}=\\frac{N}{2},\\qquad N_{m}=\\frac{N}{2}.\n$$\n\n常染色体基因座：\n- 每一代中常染色体基因拷贝的总数是\n$$\nM_{A}=2N.\n$$\n- 在Wright-Fisher基因拷贝模型中，第 $t$ 代的每个基因拷贝从第 $t-1$ 代的 $M_{A}$ 个拷贝中均匀选择其亲本，因此一对谱系的每代溯祖概率为 $1/M_{A}$。\n- 二倍体常染色体基因座的连续时间Kingman溯祖模型的成对溯祖速率为 $1/(2N_{e}^{A})$。匹配离散和连续参数化可得\n$$\n\\frac{1}{M_{A}}=\\frac{1}{2N_{e}^{A}}\\quad\\Longrightarrow\\quad 2N_{e}^{A}=M_{A}=2N\\quad\\Longrightarrow\\quad N_{e}^{A}=N.\n$$\n\nX连锁基因座：\n- 每一代中X染色体拷贝的总数是\n$$\nM_{X}=2N_{f}+1\\cdot N_{m}=2\\cdot\\frac{N}{2}+\\frac{N}{2}=\\frac{3N}{2}.\n$$\n- 为了证明对这 $M_{X}$ 个拷贝的亲本选择是均匀的，请注意每个后代都恰好遗传一个母方X染色体。每代母方X染色体传递的总数是 $N$，而母方X染色体拷贝有 $2N_{f}$ 个，因此每个母方X染色体拷贝的预期后代X拷贝数为 $N/(2N_{f})=1$。只有雌性后代会遗传父方X染色体；有 $N/2$ 个雌性后代和 $N_{m}$ 个父方X染色体拷贝，因此每个父方X染色体拷贝的预期后代X拷贝数为 $(N/2)/N_{m}=1$。因此，每个X染色体拷贝具有相等的预期繁殖产出，并且Wright-Fisher模型中X基因座的亲本选择在 $M_{X}$ 个拷贝上是均匀的。所以，一对X谱系的每代溯祖概率为 $1/M_{X}$。\n- 与X基因座的Kingman参数化进行匹配可得\n$$\n\\frac{1}{M_{X}}=\\frac{1}{2N_{e}^{X}}\\quad\\Longrightarrow\\quad 2N_{e}^{X}=M_{X}=\\frac{3N}{2}\\quad\\Longrightarrow\\quad N_{e}^{X}=\\frac{3N}{4}.\n$$\n\n因此，根据 $E[T_{MRCA}]$ 与 $N_{e}$ 的正比关系，\n$$\n\\frac{E[T_{MRCA}(X)]}{E[T_{MRCA}(A)]}=\\frac{N_{e}^{X}}{N_{e}^{A}}=\\frac{\\frac{3N}{4}}{N}=\\frac{3}{4}.\n$$", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "1931615"}]}