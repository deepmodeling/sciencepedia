## 引言
在群体遗传学领域，揭示自然选择在基因组上留下的印记，是理解物种[适应性进化](@entry_id:176122)的核心。尽管存在如[Tajima's D](@entry_id:166949)等多种统计方法来识别偏离中性模型的遗传变异模式，但它们常常难以明确区分自然选择与种群规模变化等不同进化力量的影响。为了解决这一知识空白，特别是为了更精确地识别近期发生的强正选择（即[选择性扫描](@entry_id:169307)）所特有的信号，Justin Fay和Chung-I Wu提出了一种更为专门化的H检验。

本文将带领读者深入探索Fay and Wu H检验。在接下来的内容中，你将学习到：
*   **原理与机制**：我们将剖析H检验的核心数学构建，理解它是如何通过捕捉高频衍生等位基因的过剩来工作的，并探讨其关键前提——等位基因极化。
*   **应用与跨学科联系**：通过一系列来自自然界、农业[驯化](@entry_id:156246)乃至肿瘤[基因组学](@entry_id:138123)的实例，我们将展示H检验在识别选择性清除和[平衡选择](@entry_id:150481)中的强大应用，并讨论重组率和[选择模式](@entry_id:144214)等复杂因素的影响。
*   **动手实践**：通过一系列精心设计的练习，你将有机会亲自应用H检验的逻辑，以巩固对理论知识的理解。

## 原理与机制

在群体遗传学中，检测自然选择在基因组上留下的印记是理解[适应性进化](@entry_id:176122)过程的核心任务。虽然多种统计检验，如[Tajima's D](@entry_id:166949)，能够识别[等位基因频率谱](@entry_id:168112)（Site Frequency Spectrum, SFS）中偏离中性预期的模式，但它们往往难以区分不同进化力量（如群体规模变化与自然选择）造成的影响。为了更精确地识别特定类型的选择，特别是近期发生的强正选择（即选择性扫描），Justin Fay 和 Chung-I Wu 提出了一种更为专门化的检验方法——H检验。本章将深入探讨Fay and Wu H检验的基本原理、核心机制及其在实践中的应用。

### [选择性扫描](@entry_id:169307)的特征：高频衍生等位基因

要理解H检验的设计思想，我们必须首先明确一个**近期强正[选择性扫描](@entry_id:169307)（recent, strong positive selective sweep）**在基因组上留下的独特分子信号。当一个新的有利突变出现并受到强[正选择](@entry_id:165327)时，它会在群体中迅速增加频率，甚至最终被固定。在这个过程中，不仅有利突变本身的频率发生改变，其所在[染色体](@entry_id:276543)片段上的连锁中性变异也会被“搭便车”式地带到高频率，这一现象被称为**遗传搭车（genetic hitchhiking）**。

这个过程导致了一种非常特殊的[等位基因频率](@entry_id:146872)[分布](@entry_id:182848)模式：在受选择的[基因座](@entry_id:177958)附近，遗传多样性总体水平下降，但与中性模型下的预期相比，**高频率的衍生等位基因（derived alleles）**出现异常过剩。所谓**衍生等位基因**，是指通过突变新产生的等位基因，与之相对的是**祖先等位基因（ancestral allele）**，即物种分化前的原始状态。相比之下，较早完成的[选择性扫描](@entry_id:169307)，其信号会因后续新突变的不断积累而逐渐模糊，表现为低频衍生等位基因的增多。Fay and Wu H检验正是为了特异性地捕捉由遗传搭车效应导致的近期高频衍生等位基因过剩这一关键信号而设计的。

### Fay and Wu H 检验的构建模块

Fay and Wu的H统计量是通过比较群体突变参数 $\theta$ 的两个不同估计量来构建的。在二倍体群体中，$\theta = 4N_e\mu$，其中 $N_e$ 是有效群体大小，$\mu$ 是突变率。这两个估计量对SFS的不同部分具有不同的敏感性。

#### [核苷酸多样性](@entry_id:164565)：$\theta_{\pi}$

第一个估计量是**[核苷酸多样性](@entry_id:164565)（nucleotide diversity）**，记为 $\theta_{\pi}$ 或 $\pi$。它被定义为从群体中随机抽取的两条序列之间每个[核苷酸](@entry_id:275639)位点的平[均差](@entry_id:138238)异数。这个值可以通过对样本中所有[多态性](@entry_id:159475)位点进行加权平均来计算：

$$ \theta_{\pi} = \sum_{i} 2p_i(1-p_i) $$

其中，求和遍历所有多态性位点，$p_i$ 是第 $i$ 个位点上衍生等位基因的频率。从公式可以看出，$p_i(1-p_i)$ 这一项在等位基因频率为中等（即 $p_i=0.5$）时达到最大值。因此，$\theta_{\pi}$ 主要受中等频率变异的贡献影响，对频率极高或极低的等位基因不敏感。

#### 高频等位基因估计量：$\theta_{H}$

第二个估计量是Fay and Wu特别构建的，记为 $\theta_{H}$。它旨在捕捉高频衍生等位基因的信号，其计算公式为：

$$ \theta_{H} = \sum_{i} 2p_i^2 $$

与 $\theta_{\pi}$ 不同，$\theta_{H}$ 的计算涉及到衍生[等位基因频率](@entry_id:146872)的平方项 $p_i^2$。这个平方项赋予了高频率等位基因极大的权重。例如，一个频率为 $0.9$ 的衍生等位基因对 $\theta_{H}$ 的贡献与一个频率为 $0.3$ 的等位基因相比，前者是后者的 $0.9^2 / 0.3^2 = 9$ 倍。这种设计使得 $\theta_{H}$ 对SFS中是否存在高频衍生等位基因的“峰”异常敏感。

#### 一个关键要求：利用外类群进行极化

计算 $\theta_{H}$ 的一个绝对前提是能够区分祖先等位基因和衍生等位基因，从而确定每个位点的衍生等位基因频率 $p_i$。如果无法区分，我们只能知道次要等位基因频率（minor allele frequency），而 $\theta_{H}$ 的计算将无从谈起。因此，进行H检验时，必须获得一个**外[类群](@entry_id:182524)（outgroup）**物种的同源基因序列。外类群是一个与研究群体（内[类群](@entry_id:182524)）亲缘关系较近但已发生分化的物种。

通过将内[类群](@entry_id:182524)的序列与外[类群](@entry_id:182524)序列进行比对，我们可以根据简约性原则推断祖先状态：如果某个多态性位点的等位基因之一与外类群的[核苷酸](@entry_id:275639)相同，则该等位基因被认为是祖先等位基因，而另一个则是衍生等位基因。例如，在研究人类群体的某个基因时，通常使用黑猩猩的同源序列作为外类群来确定等位基因的祖先/衍生状态。这个过程被称为**等位基因极化（polarization）**。

### H 统计量的综合与解释

Fay and Wu的H统计量被简单地定义为这两个估计量之差：

$$ H = \theta_{\pi} - \theta_{H} $$

这个简单的差值背后蕴含着深刻的进化信息。在中性进化模型下，可以证明 $\theta_{\pi}$ 和 $\theta_{H}$ 都是 $\theta$ 的[无偏估计量](@entry_id:756290)，它们的[期望值](@entry_id:153208)相等。因此，在中性条件下，我们预期 $H$ 的值接近于零。

当近期发生了一次强烈的选择性扫描，遗传搭车效应会导致连锁的中性衍生等位基因被“携带”至高频率。这种SFS的扭曲会使得 $\theta_{H}$ 的值被不成比例地放大，而 $\theta_{\pi}$ 由于对中频等位基因更敏感，其值可能变化不大甚至减小（因为中频变异被扫描清除了）。结果便是 $\theta_{H}$ 显著大于 $\theta_{\pi}$，从而导致 $H$ 统计量呈现出大的负值。因此，一个显著的**负H值**是近期正[选择性扫描](@entry_id:169307)的有力证据。

为了更直观地理解 $\theta_{H}$ 相对于 $\theta_{\pi}$ 的敏感性差异，我们可以考察单个位点上两个估计量的比值 $R(p) = \frac{\theta_H}{\theta_{\pi}} = \frac{2p^2}{2p(1-p)} = \frac{p}{1-p}$。假设在场景A中，一个有利突变被选择到高频 $p_A = 0.90$；在场景B中，一个[中性突变](@entry_id:176508)处于典型的低频状态 $p_B = 0.10$。我们可以计算在这两种场景下，该比值的差异有多大：

$$ Q = \frac{R(p_A)}{R(p_B)} = \frac{p_A/(1-p_A)}{p_B/(1-p_B)} = \frac{0.90/(1-0.90)}{0.10/(1-0.10)} = \frac{0.90/0.10}{0.10/0.90} = \frac{9}{1/9} = 81 $$

这个计算结果惊人地显示，对于高频等位基因，$\theta_H$ 相对于 $\theta_{\pi}$ 的敏感度是低频等位基因的81倍。这从数学上清晰地揭示了H检验为何能如此有效地捕捉到高频衍生等位基因的信号。

### 统计检验的逻辑：[零假设](@entry_id:265441)

与所有统计检验一样，Fay and Wu H检验的目的是评估观测数据是否显著偏离一个预设的**[零假设](@entry_id:265441)（null hypothesis）**。对于H检验而言，其零假设是**标[准中性](@entry_id:184567)模型（standard neutral model）**。该模型假定群体处于恒定的有效群体大小，所有突变都是中性的（不受选择影响），且交配是随机的。

在该模型下，$\mathbb{E}[\theta_{\pi}] = \theta$ 且 $\mathbb{E}[\theta_{H}] = \theta$。因此，H统计量的[期望值](@entry_id:153208)为：

$$ \mathbb{E}[H] = \mathbb{E}[\theta_{\pi} - \theta_{H}] = \mathbb{E}[\theta_{\pi}] - \mathbb{E}[\theta_{H}] = \theta - \theta = 0 $$

当研究人员从实际数据中计算出一个非零的H值时，他们需要确定这个值偏离零的程度是否足够大，以至于在零假设成立的情况下不大可能随机发生。这通常通过计算机模拟（如溯祖模拟）来构建H值在[零假设](@entry_id:265441)下的[分布](@entry_id:182848)，然后计算观测到的H值在该[分布](@entry_id:182848)中的[p值](@entry_id:136498)。一个足够小的p值（例如 $p \lt 0.05$）将使我们拒绝[零假设](@entry_id:265441)，并推断有非中性进化力量（如[正选择](@entry_id:165327)）在起作用。

### 实践应用：一个计算实例

让我们通过一个具体的例子来演示H统计量的计算过程。假设我们从一个群体中获得了10个个体的DNA序列，并使用外[类群](@entry_id:182524)序列来确定等位基因的极性。数据如下：

**序列数据 (n=10):**
外类群: `GATTACA**C**GT**A**GCT**G**GGTAC`
样本 1: `GATTACA**T**GT**A**GCT**A**GGTAC`
样本 2: `GATTACA**T**GT**A**GCT**G**GGTAC`
样本 3: `GATTACA**C**GT**C**GCT**A**GGTAC`
样本 4: `GATTACA**T**GT**A**GCT**A**GGTAC`
样本 5: `GATTACA**T**GT**C**GCT**A**GGTAC`
样本 6: `GATTACA**T**GT**C**GCT**G**GGTAC`
样本 7: `GATTACA**T**GT**A**GCT**A**GGTAC`
样本 8: `GATTACA**T**GT**C**GCT**G**GGTAC`
样本 9: `GATTACA**T**GT**A**GCT**A**GGTAC`
样本 10:`GATTACA**C**GT**A**GCT**A**GGTAC`

1.  **识别多态性位点 (SNPs) 并确定衍生[等位基因频率](@entry_id:146872)**
    我们发现有3个SNP位点（粗体显示）。
    - SNP 1: 外[类群](@entry_id:182524)为'C'，样本中有8个'T'。因此衍生等位基因是'T'，其计数 $k_1 = 8$，频率 $p_1 = 8/10 = 0.8$。
    - SNP 2: 外[类群](@entry_id:182524)为'A'，样本中有4个'C'。因此衍生等位基因是'C'，其计数 $k_2 = 4$，频率 $p_2 = 4/10 = 0.4$。
    - SNP 3: 外类群为'G'，样本中有7个'A'。因此衍生等位基因是'A'，其计数 $k_3 = 7$，频率 $p_3 = 7/10 = 0.7$。

2.  **计算 $\theta_{\pi}$**
    $$ \theta_{\pi} = \sum_{i=1}^{3} 2p_i(1-p_i) = 2(0.8)(0.2) + 2(0.4)(0.6) + 2(0.7)(0.3) $$
    $$ \theta_{\pi} = 0.32 + 0.48 + 0.42 = 1.22 $$

3.  **计算 $\theta_{H}$**
    这里我们使用一个更通用的 $\theta_H$ 定义，它适用于样本数据：$\theta_H = \sum_{i} \frac{2 k_i^2}{n(n-1)}$，其中 $n=10$ 是样本量。
    $$ \theta_H = \frac{2 \cdot 8^2}{10(9)} + \frac{2 \cdot 4^2}{10(9)} + \frac{2 \cdot 7^2}{10(9)} $$
    $$ \theta_H = \frac{128}{90} + \frac{32}{90} + \frac{98}{90} = \frac{258}{90} \approx 2.867 $$

4.  **计算 H 统计量**
    $$ H = \theta_{\pi} - \theta_{H} = 1.22 - 2.867 \approx -1.65 $$

计算得到的 $H \approx -1.65$ 是一个负值，这与存在高频衍生等位基因（如SNP 1和SNP 3）的观察结果一致，提示该[基因座](@entry_id:177958)可能经历了近期的正选择。

### 重要考量与局限性

虽然Fay and Wu H检验是检测选择性扫描的强大工具，但其有效性依赖于一些关键假设，其中最重要的是对祖先等位基因状态的正确推断。

#### 外类群选择的陷阱

H检验的结论严重依赖于外[类群](@entry_id:182524)的适用性。如果选择了一个不合适的外类群，可能会导致对等位基因的错误极化，从而得出完全错误的结论。

设想一个场景：真实的衍生等位基因频率为 $p=0.92$，这是一个典型的高频衍生等位基因，会导致 $\theta_H$ 很高，从而 $H \ll 0$。现在，如果研究者错误地选择了一个非常远缘的外[类群](@entry_id:182524)，而这个外[类群](@entry_id:182524)在该位点上恰好拥有这个频率为 $0.92$ 的等位基因，那么研究者会错误地将其指定为祖先等位基因。这样一来，原来的祖先等位基因（频率为 $1-p = 0.08$）就会被错误地当成衍生等位基因。

在这种错误极化下，计算 $\theta_{\pi}$ 的值保持不变，因为 $2p(1-p) = 2(1-p)p$。然而，$\theta_H$ 的值会发生剧变。原来对 $\theta_H$ 的贡献与 $p^2 = 0.92^2$ 成正比，现在变为与 $(1-p)^2 = 0.08^2$ 成正比。这个贡献会从一个非常大的值骤降为一个非常小的值。结果是，新的 $\theta_H$ 将远小于 $\theta_{\pi}$，导致 $H$ 统计量从原来的强负值翻转为正值。一个强烈的[正选择](@entry_id:165327)信号可能会被错误地解读为[平衡选择](@entry_id:150481)或[群体结构](@entry_id:148599)等其他进化模式的信号。因此，谨慎选择[系统发育](@entry_id:137790)关系适中的外[类群](@entry_id:182524)是成功应用H检验的基石。