{"hands_on_practices": [{"introduction": "在生物信息学中，许多任务都涉及高效地处理海量序列数据。第一个练习聚焦于一个基本问题：计算蛋白质序列中氨基酸的频率。通过这项实践 [@problem_id:1426309]，您将学会批判性地评估不同的基础数据结构，并为特定的常见任务选择在速度和内存方面都提供最佳性能的结构。", "problem": "一位生物信息学家正在开发一个用于分析蛋白质序列的轻量级软件工具。该工具的一个核心功能是统计给定蛋白质序列中20种标准氨基酸各自的出现次数。蛋白质序列表示为单字母代码的字符串，其中每个字母对应一种氨基酸。\n\n考虑一个长度为 $N$ 的蛋白质序列。任务是遍历该序列一次，并维护20种标准氨基酸中每一种的计数。在同时考虑时间和空间效率的情况下，对于这个特定问题，以下哪种数据结构是存储这些计数的最佳选择？\n\nA. 一个单向链表，其中每个节点包含一个双元素记录：一个氨基酸字符和它的整数计数。\n\nB. 一个包含20个整数的固定大小数组，其中从0到19的每个索引都预先分配给一种唯一的标准氨基酸。\n\nC. 一个哈希表（也称为字典或关联数组），其中键是氨基酸字符，值是它们的整数计数。\n\nD. 一个平衡二叉搜索树，其中每个节点存储一个氨基酸字符和它的整数计数。该树按氨基酸字符的字母顺序排序。", "solution": "设蛋白质序列的长度为 $N$，氨基酸字母表的固定大小为 $k=20$。任务是对序列进行单次遍历，并增加与每个氨基酸字符相关联的计数器的值。\n\n我们需要一个从每个氨基酸字符到计数器索引的映射，以及对每个字符执行增量操作。\n\n- 选项A（单向链表）：对于每个字符，定位其节点需要对最多 $k$ 个节点进行顺序搜索，导致每个字符的成本为 $\\Theta(k)$，总时间为 $T_{A}(N)=\\Theta(Nk)$。空间复杂度为 $S_{A}=\\Theta(k)$，外加指针开销，并且非连续的内存布局会损害缓存局部性。\n\n- 选项B（包含 $k$ 个整数的固定大小数组）：预先指定一个从氨基酸字符到索引的双射 $f:\\Sigma\\to\\{0,1,\\dots,k-1\\}$。对于每个字符 $c$，在最坏情况下以 $\\Theta(1)$ 时间执行直接递增操作 $a[f(c)]\\mathrel{+}=1$。总时间为 $T_{B}(N)=\\Theta(N)$，空间为 $S_{B}=\\Theta(k)$，具有最小的常数因子和极佳的缓存局部性。\n\n- 选项C（哈希表）：使用哈希，每个字符的期望更新时间为 $\\Theta(1)$，因此总期望时间为 $T_{C}(N)=\\Theta(N)$，但由于哈希计算、冲突处理和键存储，常数因子较大。空间复杂度为 $S_{C}=\\Theta(k)$，但有显著的开销，这对于固定的较小 $k$ 值来说是不必要的。\n\n- 选项D（平衡二叉搜索树）：每次更新的成本为 $\\Theta(\\log k)$，总时间为 $T_{D}(N)=\\Theta(N\\log k)$，空间复杂度为 $S_{D}=\\Theta(k)$，并带有指针和节点的开销，这对于固定的较小 $k$ 值来说，严格差于直接索引。\n\n在这些选项中，对于大小为 $k=20$ 的固定字母表，单个固定大小数组同时最小化了时间（最坏情况为 $\\Theta(N)$ 且常数因子最小）和空间（连续的 $k$ 个整数，没有键或指针的开销）。因此，最合适的选择是选项B。", "answer": "$$\\boxed{B}$$", "id": "1426309"}, {"introduction": "生物系统是由相互作用的通路组成的复杂网络。为了理解这些联系，我们常常需要识别不同过程之间共享的共同分子。这个练习 [@problem_id:1426296] 要求您找出柠檬酸循环和尿素循环所共有的代谢物，展示了像集合这样的抽象数据结构如何能够优雅而高效地解决涉及生物集合比较和交集的问题。", "problem": "在代谢网络分析中，识别不同生化途径之间的共享分子对于理解这些途径如何相互关联至关重要。考虑两个核心代谢途径：柠檬酸循环（也称为Krebs循环）和尿素循环。\n\n您会得到两个字符串列表，其中每个字符串是参与其中一个途径的一种代谢物的名称。有些代谢物可能同时参与两个途径。\n\n柠檬酸循环及其直接关联物质中的代谢物列表：\n`[\"Citrate\", \"Isocitrate\", \"alpha-Ketoglutarate\", \"Succinyl-CoA\", \"Succinate\", \"Fumarate\", \"Malate\", \"Oxaloacetate\", \"Aspartate\"]`\n\n尿素循环中的代谢物列表：\n`[\"Carbamoyl phosphate\", \"Ornithine\", \"Citrulline\", \"Aspartate\", \"Argininosuccinate\", \"Fumarate\", \"Arginine\"]`\n\n您的任务是根据所提供的列表，确定柠檬酸循环和尿素循环共有的唯一代谢物的数量。", "solution": "令 $C$ 表示为柠檬酸循环及其直接关联物质列出的唯一代谢物集合，令 $U$ 表示为尿素循环列出的唯一代谢物集合。根据题意：\n$$\nC = \\{\\text{Citrate}, \\text{Isocitrate}, \\text{alpha-Ketoglutarate}, \\text{Succinyl-CoA}, \\text{Succinate}, \\text{Fumarate}, \\text{Malate}, \\text{Oxaloacetate}, \\text{Aspartate}\\}\n$$\n$$\nU = \\{\\text{Carbamoyl phosphate}, \\text{Ornithine}, \\text{Citrulline}, \\text{Aspartate}, \\text{Argininosuccinate}, \\text{Fumarate}, \\text{Arginine}\\}\n$$\n我们需要确定两个途径共有的唯一代谢物的数量，也就是交集 $C \\cap U$ 的基数：\n$$\nC \\cap U = \\{\\text{Fumarate}, \\text{Aspartate}\\}\n$$\n因此，唯一共有代谢物的数量是其基数：\n$$\n|C \\cap U| = 2\n$$", "answer": "$$\\boxed{2}$$", "id": "1426296"}, {"introduction": "反馈回路是控制生物网络行为和稳定性的关键调控模体。识别这些回路是系统生物学中的一项核心任务，但这需要从简单的列表转向更复杂的图表示。在这个高级练习 [@problem_id:1426317] 中，您将设计一种算法，从一个相互作用列表中找出所有由三个蛋白质组成的负反馈回路，从而获得在网络建模和重要结构模式搜索方面的实践经验。", "problem": "在系统生物学中，细胞过程由复杂的基因和蛋白质调控网络所控制。这些网络可以被建模为有向图，其中节点代表蛋白质，边代表调控相互作用，例如激活或抑制。这些网络中的一个关键调控基序是反馈回路，其中一个蛋白质通过一系列中间体，最终调控其自身的活动。\n\n一个三蛋白质反馈回路是一个长度为三的简单环路，表示为像 `A → B → C → A` 这样的路径，其中 `A`、`B` 和 `C` 是不同的蛋白质，而 `→` 表示一个有向的调控相互作用。每个相互作用都有一个符号：'+' 代表激活，'-' 代表抑制。\n\n反馈回路的整体特性由其组成的相互作用的符号的乘积决定。如果一个回路的符号乘积为负（即，它包含奇数个抑制步骤），则该回路被归类为**负反馈回路**。相反，如果一个回路的符号乘积为正（即，它包含偶数个抑制步骤），则该回路是**正反馈回路**。\n\n给定一个无序列表，其中包含实验观察到的、独特的成对蛋白质相互作用。您的任务是分析这个网络，并确定独特的三蛋白质**负反馈回路**的总数。一个回路是由所涉及的三个蛋白质的集合定义的；因此，环路 `A → B → C → A` 与 `B → C → A → B` 被认为是同一个独特的回路。\n\n观察到的相互作用列表，指定为（源蛋白质，目标蛋白质，相互作用符号），如下所示：\n\n`[('P1', 'P2', '+'), ('P2', 'P3', '-'), ('P3', 'P1', '+'), ('P1', 'P4', '+'), ('P4', 'P5', '+'), ('P5', 'P1', '+'), ('P4', 'P2', '-'), ('P2', 'P5', '-'), ('P6', 'P7', '-'), ('P7', 'P8', '-'), ('P8', 'P6', '-'), ('P3', 'P5', '+'), ('P5', 'P7', '+'), ('P7', 'P3', '-'), ('P8', 'P1', '-'), ('P9', 'P1', '+'), ('P2', 'P9', '+'), ('P9', 'P4', '-')]`", "solution": "我们将网络建模为一个有向带符号图。一个由不同蛋白质 $A, B, C$ 构成的三蛋白质有向环路存在的充要条件是，有向边 $(A,B)$、$(B,C)$ 和 $(C,A)$ 全部存在。环路的符号是乘积 $s(A,B)\\,s(B,C)\\,s(C,A)$，其中每条边的符号 $s(\\cdot, \\cdot)$ 对于激活是 $+1$，对于抑制是 $-1$。负反馈回路是乘积为 $-1$ 的回路，即包含奇数条抑制性边。一个回路通过集合 $\\{A,B,C\\}$ 进行唯一计数；循环移位被视为相同。\n\n根据给定的相互作用，出向带符号邻居如下：\n- $P1$：$P1 \\to P2$ $(+)$, $P1 \\to P4$ $(+)$\n- $P2$：$P2 \\to P3$ $(-)$, $P2 \\to P5$ $(-)$, $P2 \\to P9$ $(+)$\n- $P3$：$P3 \\to P1$ $(+)$, $P3 \\to P5$ $(+)$\n- $P4$：$P4 \\to P5$ $(+)$, $P4 \\to P2$ $(-)$\n- $P5$：$P5 \\to P1$ $(+)$, $P5 \\to P7$ $(+)$\n- $P6$：$P6 \\to P7$ $(-)$\n- $P7$：$P7 \\to P8$ $(-)$, $P7 \\to P3$ $(-)$\n- $P8$：$P8 \\to P6$ $(-)$, $P8 \\to P1$ $(-)$\n- $P9$：$P9 \\to P1$ $(+)$, $P9 \\to P4$ $(-)$\n\n我们通过扫描长度为二的路径并检查其闭合性来枚举所有有向三元环：\n\n- $\\{P1,P2,P3\\}$ 通过 $P1 \\to P2$ $(+)$, $P2 \\to P3$ $(-)$, $P3 \\to P1$ $(+)$ 得到乘积 $(+1)\\cdot(-1)\\cdot(+1)=-1$，所以是负反馈。\n- $\\{P1,P2,P5\\}$ 通过 $P1 \\to P2$ $(+)$, $P2 \\to P5$ $(-)$, $P5 \\to P1$ $(+)$ 得到乘积 $(+1)\\cdot(-1)\\cdot(+1)=-1$，所以是负反馈。\n- $\\{P1,P2,P9\\}$ 通过 $P1 \\to P2$ $(+)$, $P2 \\to P9$ $(+)$, $P9 \\to P1$ $(+)$ 得到乘积 $(+1)\\cdot(+1)\\cdot(+1)=+1$，所以是正反馈。\n- $\\{P1,P4,P5\\}$ 通过 $P1 \\to P4$ $(+)$, $P4 \\to P5$ $(+)$, $P5 \\to P1$ $(+)$ 得到乘积 $(+1)\\cdot(+1)\\cdot(+1)=+1$，所以是正反馈。\n- $\\{P2,P4,P9\\}$ 通过 $P2 \\to P9$ $(+)$, $P9 \\to P4$ $(-)$, $P4 \\to P2$ $(-)$ 得到乘积 $(+1)\\cdot(-1)\\cdot(-1)=+1$，所以是正反馈。\n- $\\{P3,P5,P7\\}$ 通过 $P3 \\to P5$ $(+)$, $P5 \\to P7$ $(+)$, $P7 \\to P3$ $(-)$ 得到乘积 $(+1)\\cdot(+1)\\cdot(-1)=-1$，所以是负反馈。\n- $\\{P6,P7,P8\\}$ 通过 $P6 \\to P7$ $(-)$, $P7 \\to P8$ $(-)$, $P8 \\to P6$ $(-)$ 得到乘积 $(-1)\\cdot(-1)\\cdot(-1)=-1$，所以是负反馈。\n\n列表中的其他任何三个不同蛋白质的组合都不能完成一个有向环路，这通过检查所有可能的长度为二的路径是否具有闭合性 $C \\to A$ 得以验证。\n\n因此，独特的（包含奇数条抑制性边的）三蛋白质负反馈回路正是这四个集合 $\\{\\text{P1},\\text{P2},\\text{P3}\\}$、$\\{\\text{P1},\\text{P2},\\text{P5}\\}$、$\\{\\text{P3},\\text{P5},\\text{P7}\\}$ 和 $\\{\\text{P6},\\text{P7},\\text{P8}\\}$。因此，独特的负反馈回路的总数是 $4$。", "answer": "$$\\boxed{4}$$", "id": "1426317"}]}