{"hands_on_practices": [{"introduction": "积分反馈控制的一个核心特征是其能够完全适应持续的扰动，这一特性被称为“鲁棒完美适应” (robust perfect adaptation)。与会留下稳态误差的比例控制不同，积分控制会累积误差，迫使系统输出最终精确地返回其设定点。这项练习将通过分析系统在持续扰动下的定性行为，帮助您建立对这一关键差异的直观理解，这是诊断和设计控制系统的重要第一步。[@problem_id:1439507]", "problem": "在一个合成生物学项目中，一株 E. coli 经过改造，用于生产一种有价值的代谢物‘代谢物X’。其基因回路被设计用于将代谢物X的胞内浓度维持在一个特定的设定点 $C_0$ 的稳态水平。目前正在考虑两种调控反馈回路的潜在设计。第一种是比例反馈控制器，其中产生代谢物X的酶的合成速率，其调整量与设定点 $C_0$ 和当前浓度 $C(t)$ 之间的差值成正比。第二种是积分反馈控制器，其中该酶的合成速率，其调整量基于设定点 $C_0$ 和当前浓度 $C(t)$ 之间差值随时间的累积（积分）值。\n\n为了测试该系统的行为，进行了一项实验。细胞最初处于稳态，代谢物X的浓度在设定点 $C_0$。在时间 $t=0$ 时，通过激活一个转运蛋白的基因引入一个持续的扰动，该蛋白以恒定的速率将代谢物X持续泵出细胞。然后监测代谢物X的浓度 $C(t)$。\n\n下面是四种关于 $t > 0$ 时浓度 $C(t)$ 可能的时间演化描述。这些描述中，哪一个是积分反馈控制系统所独有的特征？\n\nA. 浓度 $C(t)$ 最初降至 $C_0$ 以下。然后反馈系统被激活，导致浓度增加，经过一段时间的调整后，浓度精确地返回到原始设定点浓度 $C_0$。\n\nB. 浓度 $C(t)$ 最初降至 $C_0$ 以下。然后反馈系统被激活，导致浓度增加，但它稳定在一个新的、恒定的稳态浓度 $C_f$ 上，该浓度严格小于原始设定点 $C_0$。\n\nC. 浓度 $C(t)$ 从 $C_0$ 开始下降并持续降低，直至达到一个新的、非常低的稳态浓度，系统没有表现出明显的反作用来抵消下降并朝 $C_0$ 回归的趋势。\n\nD. 浓度 $C(t)$ 最初降至 $C_0$ 以下，但反馈系统过度校正，导致浓度上升到 $C_0$ 以上，然后再次下降到其以下，从而围绕某个低于 $C_0$ 的值产生持续振荡。", "solution": "设 $C(t)$ 表示代谢物X的胞内浓度。设酶合成控制输入为 $u(t)$，并设持续的输出扰动（在 $t=0$ 时激活）为一个常数 $d>0$，代表外排速率。考虑关于扰动前稳态 $C_{0}$ 的线性化对象模型：\n$$\n\\frac{dC}{dt}=p\\,u-k\\,C-d,\n$$\n其中 $p>0$ 将酶合成速率映射到代谢物X的净产量，而 $k>0$ 代表总的一阶损失或稀释。在扰动前（$d=0$），系统处于稳态 $C=C_{0}$，存在某个满足以下条件的基线输入 $u=u_{0}$：\n$$\n0=p\\,u_{0}-k\\,C_{0}\\quad\\Rightarrow\\quad u_{0}=\\frac{k}{p}C_{0}.\n$$\n定义偏差 $x(t)=C(t)-C_{0}$ 和 $v(t)=u(t)-u_{0}$。从对象动态方程中减去扰动前的平衡方程，得到 $t\\geq 0$ 时的偏差动态：\n$$\n\\frac{dx}{dt}=p\\,v-k\\,x-d.\n$$\n设调节目标是维持 $C(t)\\to C_{0}$，等价于 $x(t)\\to 0$。定义调节误差 $e(t)=C_{0}-C(t)=-x(t)$。\n\n比例控制：$v(t)=K_{p}\\,e(t)=-K_{p}\\,x(t)$，其中 $K_{p}>0$。代入对象模型得到\n$$\n\\frac{dx}{dt}=p\\big(-K_{p}x\\big)-k\\,x-d=-(pK_{p}+k)\\,x-d.\n$$\n在稳态下，$dx/dt=0$ 给出\n$$\n0=-(pK_{p}+k)\\,x_{\\text{ss}}-d\\quad\\Rightarrow\\quad x_{\\text{ss}}=-\\frac{d}{pK_{p}+k}.\n$$\n因此稳态误差为\n$$\ne_{\\text{ss}}=-x_{\\text{ss}}=\\frac{d}{pK_{p}+k}>0,\n$$\n所以 $C_{\\text{ss}}=C_{0}-e_{\\text{ss}}<C_{0}$。这与描述B相符。\n\n积分控制：$dv/dt=K_{i}\\,e(t)=-K_{i}\\,x(t)$，其中 $K_{i}>0$。为研究稳态，将所有时间导数设为零。在稳态下，$dv/dt=0$ 意味着 $x_{\\text{ss}}=0$。因此 $C_{\\text{ss}}=C_{0}$，即不存在稳态误差。此外，$dx/dt=0$ 给出 $p\\,v_{\\text{ss}}-k\\,x_{\\text{ss}}-d=0$。代入 $x_{\\text{ss}}=0$ 得到 $v_{\\text{ss}}=d/p$。这表明积分控制器已将稳态输入调整为 $u_{\\text{ss}}=u_{0}+d/p$，以精确抵消扰动。这种对持续扰动的完美适应是积分控制的标志性特征，与描述A相符。", "answer": "$$\\boxed{A}$$", "id": "1439507"}, {"introduction": "细胞如何利用分子元件实现积分控制？“对偶积分反馈” (antithetic integral feedback) 模体是在自然和合成生物回路中都发现的一个强有力范例。这项练习探讨了受控分子的稳态设定点是如何由控制器本身的动力学参数决定的。通过分析这个回路，您将发现一个精妙的设计原则：只需改变控制器分子的产生速率，即可调节系统的设定点，从而在基因改造和系统级行为之间建立了直接联系。[@problem_id:1439451]", "problem": "一个合成生物学家团队正在设计一种细菌菌株，以稳定地维持一种荧光蛋白 $X$ 的细胞内浓度。该控制系统是一个实现对抗性积分反馈机制的基因回路。该机制涉及两种额外的控制分子 $Z_1$ 和 $Z_2$。控制这些物种浓度（分别表示为 $x$、$z_1$ 和 $z_2$）的生物化学网络由以下一系列过程定义：\n\n1.  蛋白 $X$ 以速率 $\\mu$ 组成性产生。\n2.  蛋白 $X$ 进行一级降解，速率常数为 $\\delta$。\n3.  控制分子 $Z_1$ 作为 $X$ 降解的催化剂。该过程的反应速率为 $k x z_1$。\n4.  控制分子 $Z_1$ 以速率 $k_1$ 组成性产生。\n5.  控制分子 $Z_2$ 通过 $X$ 催化的过程产生，其产生速率为 $k_2 x$。\n6.  控制分子 $Z_1$ 和 $Z_2$ 在双分子反应中相互湮灭，速率常数为 $\\eta$。\n\n最初，回路参数设置为：$\\mu = 100$ nM/min，$\\delta = 0.1$ min$^{-1}$，$k = 1.0$ nM$^{-1}$min$^{-1}$，$k_1 = 50.0$ nM/min，$k_2 = 1.70$ min$^{-1}$，以及 $\\eta = 1.0$ nM$^{-1}$min$^{-1}$。\n\n通过定向进化，筛选出一种细菌变体，其编码 $Z_1$ 的基因的启动子中存在一个突变。这个突变使其产生速率降低到一个新值 $k'_1 = \\frac{1}{2} k_1$，而系统的所有其他参数保持不变。\n\n计算这个进化后的变体中蛋白 $X$ 的新稳态浓度。你的最终答案需以 nM 为单位表示，并四舍五入到三位有效数字。", "solution": "设 $x$、$z_{1}$ 和 $z_{2}$ 分别表示 $X$、$Z_{1}$ 和 $Z_{2}$ 的浓度。根据所列的过程，质量作用动力学方程为：\n$$\n\\frac{dx}{dt}=\\mu-\\delta x-k x z_{1},\n$$\n$$\n\\frac{dz_{1}}{dt}=k_{1}-\\eta z_{1} z_{2},\n$$\n$$\n\\frac{dz_{2}}{dt}=k_{2} x-\\eta z_{1} z_{2}.\n$$\n在稳态时，将所有时间导数设为零。根据 $z_{1}$ 和 $z_{2}$ 的方程，\n$$\n0=k_{1}-\\eta z_{1} z_{2}, \\quad 0=k_{2} x-\\eta z_{1} z_{2}.\n$$\n通过共同的湮灭项使等式右边相等，可得出\n$$\nk_{1}=\\eta z_{1} z_{2}=k_{2} x \\implies x^{\\ast}=\\frac{k_{1}}{k_{2}}.\n$$\n因此，$x$ 的稳态设定点与 $\\mu$、$\\delta$、$k$ 和 $\\eta$ 无关。在突变下，$k_{1}'=\\frac{1}{2}k_{1}$，所以新的稳态是\n$$\nx'^{\\ast}=\\frac{k_{1}'}{k_{2}}=\\frac{1}{2}\\frac{k_{1}}{k_{2}}.\n$$\n代入给定的数值 $k_{1}=50.0\\,\\text{nM/min}$ 和 $k_{2}=1.70\\,\\text{min}^{-1}$ 可得\n$$\nx'^{\\ast}=\\frac{1}{2}\\cdot\\frac{50.0}{1.70}\\,\\text{nM}=\\frac{25.0}{1.70}\\,\\text{nM}\\approx 14.705882\\ldots\\,\\text{nM}.\n$$\n四舍五入到三位有效数字，得出 $14.7$，单位为 nM。", "answer": "$$\\boxed{14.7}$$", "id": "1439451"}, {"introduction": "一个系统不仅仅要达到正确的稳态，其达到稳态的*方式*——即其瞬态动力学——也至关重要。这个问题要求您从稳态分析转向求解描述系统随时间响应的完整微分方程。通过推导蛋白质浓度的解析解，您将获得模拟反馈回路动态性能的实践经验，并了解像阻尼这样的参数如何塑造系统对变化的响应。[@problem_id:1439500]", "problem": "一个合成生物电路被设计用于将蛋白质 $P$ 的浓度维持在一个期望的设定点，该设定点由外部信号分子 $S$ 的浓度决定。该电路的动力学由一个积分反馈控制的简化模型描述：\n$$\\frac{dE}{dt} = k_I (S(t) - P(t))$$\n$$\\frac{dP}{dt} = k_P E(t) - \\gamma P(t)$$\n此处，$P(t)$ 是蛋白质的浓度，$E(t)$ 是控制器的一个内部状态变量，$S(t)$ 是信号分子的浓度，它作为 $P$ 的设定点。参数 $k_I$、$k_P$ 和 $\\gamma$ 是正常数，分别代表积分增益、产生增益和蛋白质的降解速率。\n\n在 $t < 0$ 时，系统初始处于稳态，信号浓度为常数 $S(t) = S_0$。在时间 $t=0$ 时，信号浓度突变为一个新的常数值 $S(t) = 2S_0$（对于 $t \\ge 0$）。\n\n系统的参数经过调节，使得 $P(t)$ 对此阶跃变化的响应是临界阻尼的。求出对于所有时间 $t \\ge 0$ 蛋白质浓度 $P(t)$ 的解析表达式。你的最终答案应该用 $S_0$、$\\gamma$ 和 $t$ 表示。", "solution": "我们从给定的系统开始：\n$$\\frac{dE}{dt} = k_{I}\\left(S(t)-P(t)\\right), \\qquad \\frac{dP}{dt} = k_{P}E(t) - \\gamma P(t).$$\n将关于 $P$ 的方程对时间求导，并代入来自 $E$ 方程的 $\\frac{dE}{dt}$ 以消去 $E$：\n$$\\frac{d^{2}P}{dt^{2}} = k_{P}\\frac{dE}{dt} - \\gamma \\frac{dP}{dt} = k_{P}k_{I}\\left(S(t)-P(t)\\right) - \\gamma \\frac{dP}{dt}.$$\n整理得到标准的二阶线性常微分方程：\n$$\\frac{d^{2}P}{dt^{2}} + \\gamma \\frac{dP}{dt} + k_{P}k_{I} P = k_{P}k_{I} S(t).$$\n齐次部分的特征方程是 $r^{2} + \\gamma r + k_{P}k_{I} = 0$。当判别式为零时，发生临界阻尼：\n$$\\gamma^{2} - 4 k_{P}k_{I} = 0 \\quad \\Longrightarrow \\quad k_{P}k_{I} = \\frac{\\gamma^{2}}{4}.$$\n对于 $t<0$，$S(t)=S_{0}$ 且系统处于稳态，因此 $P=S_{0}$ 且 $0 = k_{P}E - \\gamma P$ 意味着 $E = \\frac{\\gamma}{k_{P}} S_{0}$。根据状态的连续性，在 $t=0^{+}$ 时我们有\n$$P(0) = S_{0}, \\qquad E(0) = \\frac{\\gamma}{k_{P}} S_{0}.$$\n对于 $t \\ge 0$，输入是常数 $S(t)=2S_{0}$，所以一个特解是 $P_{p} = 2S_{0}$。在临界阻尼条件下，特征方程在 $-\\frac{\\gamma}{2}$ 处有一个二重根，通解是\n$$P(t) = 2S_{0} + \\left(A + B t\\right)\\exp\\!\\left(-\\frac{\\gamma}{2} t\\right).$$\n从初始条件确定 $A$ 和 $B$。根据 $P(0)=S_{0}$，\n$$S_{0} = 2S_{0} + A \\quad \\Longrightarrow \\quad A = -S_{0}.$$\n在 $t=0^{+}$ 时用两种方法计算 $\\frac{dP}{dt}$。从状态方程得到，\n$$\\left.\\frac{dP}{dt}\\right|_{0^{+}} = k_{P}E(0) - \\gamma P(0) = k_{P}\\left(\\frac{\\gamma}{k_{P}} S_{0}\\right) - \\gamma S_{0} = 0.$$\n从通解形式得到，\n$$\\frac{dP}{dt} = \\left(B - \\frac{\\gamma}{2}(A + Bt)\\right)\\exp\\!\\left(-\\frac{\\gamma}{2} t\\right),$$\n所以在 $t=0$ 时，\n$$0 = B - \\frac{\\gamma}{2}A \\quad \\Longrightarrow \\quad B = \\frac{\\gamma}{2}A = -\\frac{\\gamma S_{0}}{2}.$$\n代入 $A$ 和 $B$ 得到，对于所有 $t \\ge 0$，\n$$P(t) = 2S_{0} - S_{0}\\left(1 + \\frac{\\gamma}{2} t\\right)\\exp\\!\\left(-\\frac{\\gamma}{2} t\\right).$$\n该表达式只依赖于 $S_{0}$、$\\gamma$ 和 $t$，符合要求。", "answer": "$$\\boxed{2S_{0} - S_{0}\\left(1 + \\frac{\\gamma}{2} t\\right)\\exp\\!\\left(-\\frac{\\gamma}{2} t\\right)}$$", "id": "1439500"}]}