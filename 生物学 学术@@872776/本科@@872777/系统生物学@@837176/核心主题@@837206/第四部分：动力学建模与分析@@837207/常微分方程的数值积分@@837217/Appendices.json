{"hands_on_practices": [{"introduction": "要真正掌握常微分方程的数值积分，必须从理论走向实践。我们从一个基础练习开始：将前向欧拉法应用于一个典型的生物系统。本练习模拟一个简单的两步代谢途径，让您将微分方程组转化为分步数值模拟，从而获得具体的实践经验。掌握这项技能是为您将来模拟更复杂的生物网络迈出的第一步。[@problem_id:1455809]", "problem": "细胞中的一个简单代谢途径涉及底物A转化为中间产物B，然后B再转化为最终产物C。A和B的浓度动态，分别表示为$S_A(t)$和$S_B(t)$，可以用一个常微分方程组（ODE）来建模：\n$$\n\\frac{dS_A}{dt} = -k_1 S_A\n$$\n$$\n\\frac{dS_B}{dt} = k_1 S_A - k_2 S_B\n$$\n反应的速率常数分别为 $k_1 = 0.5\\ \\text{s}^{-1}$ 和 $k_2 = 0.2\\ \\text{s}^{-1}$。在时间 $t=0$ 时，初始浓度为 $S_A(0) = 100.0\\ \\mu\\text{M}$ 和 $S_B(0) = 0.0\\ \\mu\\text{M}$。\n\n使用固定时间步长 $\\Delta t = 0.1\\ \\text{s}$ 的前向欧拉法，计算在时间 $t = 0.2\\ \\text{s}$ 时底物A和底物B的近似浓度。\n\n按顺序提供您对 $S_A(0.2)$ 和 $S_B(0.2)$ 的答案。以 $\\mu\\text{M}$ 为单位表示您的最终答案，并四舍五入到三位有效数字。", "solution": "我们被要求使用时间步长 $\\Delta t=0.1$ 的前向欧拉法来近似计算 $t=0.2$ 时的 $S_{A}(t)$ 和 $S_{B}(t)$。该常微分方程组为\n$$\n\\frac{dS_{A}}{dt}=-k_{1}S_{A}, \\quad \\frac{dS_{B}}{dt}=k_{1}S_{A}-k_{2}S_{B},\n$$\n其中 $k_{1}=0.5$, $k_{2}=0.2$，初始条件为 $S_{A}(0)=100.0$, $S_{B}(0)=0.0$。\n\n前向欧拉法的更新公式为\n$$\nS_{A}^{n+1}=S_{A}^{n}+\\Delta t\\left(-k_{1}S_{A}^{n}\\right)=S_{A}^{n}\\left(1-k_{1}\\Delta t\\right),\n$$\n$$\nS_{B}^{n+1}=S_{B}^{n}+\\Delta t\\left(k_{1}S_{A}^{n}-k_{2}S_{B}^{n}\\right),\n$$\n其中 $S_{A}^{n}\\approx S_{A}(n\\Delta t)$ 且 $S_{B}^{n}\\approx S_{B}(n\\Delta t)$。\n\n计算 $S_{A}$ 的因子：\n$$\n1-k_{1}\\Delta t=1-0.5\\cdot 0.1=0.95.\n$$\n\n从 $t=0$ 到 $t=0.1$ 的步骤：\n$$\nS_{A}^{1}=S_{A}^{0}\\cdot 0.95=100.0\\cdot 0.95=95.0,\n$$\n$$\nS_{B}^{1}=S_{B}^{0}+\\Delta t\\left(k_{1}S_{A}^{0}-k_{2}S_{B}^{0}\\right)=0.0+0.1\\left(0.5\\cdot 100.0-0.2\\cdot 0.0\\right)=0.1\\cdot 50.0=5.0.\n$$\n\n从 $t=0.1$ 到 $t=0.2$ 的步骤：\n$$\nS_{A}^{2}=S_{A}^{1}\\cdot 0.95=95.0\\cdot 0.95=90.25,\n$$\n$$\nS_{B}^{2}=S_{B}^{1}+\\Delta t\\left(k_{1}S_{A}^{1}-k_{2}S_{B}^{1}\\right)=5.0+0.1\\left(0.5\\cdot 95.0-0.2\\cdot 5.0\\right).\n$$\n计算括号内的值：\n$$\n0.5\\cdot 95.0=47.5,\\quad 0.2\\cdot 5.0=1.0,\\quad 47.5-1.0=46.5,\n$$\n所以\n$$\nS_{B}^{2}=5.0+0.1\\cdot 46.5=5.0+4.65=9.65.\n$$\n\n因此 $S_{A}(0.2)\\approx 90.25$ 且 $S_{B}(0.2)\\approx 9.65$。四舍五入到三位有效数字，得到 $S_{A}(0.2)=90.3$ 和 $S_{B}(0.2)=9.65$。", "answer": "$$\\boxed{\\begin{pmatrix}90.3  9.65\\end{pmatrix}}$$", "id": "1455809"}, {"introduction": "虽然前向欧拉法简单直观，但其应用并非没有陷阱。一个至关重要的概念是数值稳定性；选择不当的时间步长可能会导致结果在物理上毫无意义。本练习将引导您为一个简单的降解模型计算其保持数值稳定所需的最大时间步长，从而让您对这一关键限制有一个定量的理解。[@problem_id:1455787]", "problem": "一位系统生物学家正在对一种名为“Suppressor-Y”的特定蛋白质在细胞内施用一种能完全中止新蛋白质合成的药物后的降解过程进行建模。研究发现，Suppressor-Y的浓度（记为 $C(t)$）根据以下一阶常微分方程 (ODE) 减少：\n$$\n\\frac{dC}{dt} = -kC\n$$\n其中降解速率常数为 $k = 5.0 \\, \\text{s}^{-1}$。\n\n为了对此过程进行数值模拟，该生物学家决定使用前向欧拉法。数值方法的稳定性至关重要，因为不稳定的方法可能会产生振幅不断增大的振荡解或指数增长的解，这对于降解过程来说在物理上是荒谬的。对于此类问题，只有当时间步长 $h$ 选择得足够小时，前向欧拉法才是稳定的。\n\n确定将前向欧拉法应用于此模型时，使其保持数值稳定的时间步长 $h$ 的最大值。请以秒为单位表示您的答案。", "solution": "我们考虑线性常微分方程 $\\frac{dC}{dt}=-kC$，其中 $k0$。将前向欧拉法应用于 $C^{\\prime}(t)=f(C)$，得到更新公式\n$$\nC_{n+1}=C_{n}+h f(C_{n})=C_{n}-hk\\,C_{n}=(1-hk)\\,C_{n}.\n$$\n对于线性检验方程 $y^{\\prime}=\\lambda y$，当前向欧拉法的放大因子满足以下条件时，该方法是绝对稳定的：\n$$\n|1+h\\lambda| \\le 1.\n$$\n此处 $\\lambda=-k$，因此稳定性条件变为\n$$\n|1-hk| \\le 1.\n$$\n该不等式等价于双重不等式\n$$\n-1 \\le 1-hk \\le 1.\n$$\n从右侧不等式 $1-hk \\le 1$ 中，我们得到 $-hk \\le 0$，并且由于 $k0$，这意味着 $h \\ge 0$。从左侧不等式 $-1 \\le 1-hk$ 中，我们得到 $-2 \\le -hk$，两边同乘以 $-1$ 后得到 $2 \\ge hk$，即 $hk \\le 2$。综合两者可得，对于一个正步长 $h>0$，条件是\n$$\n0  h \\le 2/k\n$$\n因此，最大的稳定时间步长为 $h_{max} = 2/k$。\n将 $k = 5.0 \\, \\text{s}^{-1}$ 代入，我们得到：\n$$\nh_{max} = \\frac{2}{5.0} = 0.4 \\, \\text{s}.\n$$", "answer": "$$\\boxed{0.4}$$", "id": "1455787"}, {"introduction": "现在，我们将面对系统生物学中的一个常见挑战：刚性系统（stiff systems），即系统中包含多个时间尺度差异巨大的过程。在这种情况下，使用像前向欧拉法这样的简单方法，即使时间步长看似合理，也可能导致灾难性的失败。本练习将让您亲身体验这种不稳定性，并揭示为何理解“刚度”对于选择正确的数值积分器至关重要。[@problem_id:1455796]", "problem": "在一个简化的细胞信号通路模型中，蛋白质 `A` 可以可逆地转换为其活性形式 `B`。该过程可以用以下基元反应来描述：\n$$ A \\underset{k_r}{\\stackrel{k_f}{\\rightleftharpoons}} B $$\n`A` 和 `B` 的浓度（分别表示为 $C_A(t)$ 和 $C_B(t)$）的变化率由以下耦合常微分方程组 (ODEs) 控制：\n$$ \\frac{dC_A}{dt} = -k_f C_A + k_r C_B $$\n$$ \\frac{dC_B}{dt} = k_f C_A - k_r C_B $$\n假设正向速率常数 $k_f = 100.0 \\text{ s}^{-1}$，逆向速率常数 $k_r = 1.0 \\text{ s}^{-1}$。在时间 $t=0$ 时，初始浓度为 $C_A(0) = 1.00 \\text{ \\mu M}$ 和 $C_B(0) = 0.00 \\text{ \\mu M}$。\n\n您的任务是应用前向欧拉法，以近似计算在时间 $t = 0.06 \\text{ s}$ 时蛋白质 `B` 的浓度。使用固定时间步长 $h = 0.03 \\text{ s}$。\n\n请将 `B` 浓度的最终答案以微摩尔/升 ($\\mu M$) 为单位表示，并四舍五入到三位有效数字。", "solution": "我们用耦合常微分方程组来模拟这个可逆转换\n$$\n\\frac{dC_{A}}{dt}=-k_{f}C_{A}+k_{r}C_{B}, \\qquad \\frac{dC_{B}}{dt}=k_{f}C_{A}-k_{r}C_{B},\n$$\n初始条件为 $C_{A}(0)=1.00$ 和 $C_{B}(0)=0.00$，参数为 $k_{f}=100.0$ 和 $k_{r}=1.0$。使用固定步长 $h=0.03$ 的前向欧拉法更新公式如下\n$$\nC_{A}^{n+1}=C_{A}^{n}+h\\left(-k_{f}C_{A}^{n}+k_{r}C_{B}^{n}\\right), \\qquad\nC_{B}^{n+1}=C_{B}^{n}+h\\left(k_{f}C_{A}^{n}-k_{r}C_{B}^{n}\\right).\n$$\n我们进行两步计算以达到 $t=0.06$。\n\n第 1 步 (从 $t=0$ 到 $t=0.03$)：使用 $C_{A}^{0}=1.00$，$C_{B}^{0}=0.00$，\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{0}=-k_{f}C_{A}^{0}+k_{r}C_{B}^{0}=-100.0\\cdot 1.00+1.0\\cdot 0.00=-100.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{0}=k_{f}C_{A}^{0}-k_{r}C_{B}^{0}=100.0\\cdot 1.00-1.0\\cdot 0.00=100.0.\n$$\n因此，\n$$\nC_{A}^{1}=1.00+0.03\\cdot(-100.0)=1.00-3.00=-2.00,\n$$\n$$\nC_{B}^{1}=0.00+0.03\\cdot(100.0)=3.00.\n$$\n\n第 2 步 (从 $t=0.03$ 到 $t=0.06$)：使用 $C_{A}^{1}=-2.00$，$C_{B}^{1}=3.00$，\n$$\n\\left.\\frac{dC_{A}}{dt}\\right|_{1}=-k_{f}C_{A}^{1}+k_{r}C_{B}^{1}=-100.0\\cdot(-2.00)+1.0\\cdot 3.00=203.0,\n$$\n$$\n\\left.\\frac{dC_{B}}{dt}\\right|_{1}=k_{f}C_{A}^{1}-k_{r}C_{B}^{1}=100.0\\cdot(-2.00)-1.0\\cdot 3.00=-203.0.\n$$\n因此，\n$$\nC_{A}^{2}=-2.00+0.03\\cdot 203.0=-2.00+6.09=4.09,\n$$\n$$\nC_{B}^{2}=3.00+0.03\\cdot(-203.0)=3.00-6.09=-3.09.\n$$\n因此，在 $t=0.06$ 时的前向欧拉近似值给出 $C_{B}(0.06)\\approx -3.09$。四舍五入到三位有效数字，该值为 $-3.09$。", "answer": "$$\\boxed{-3.09}$$", "id": "1455796"}]}