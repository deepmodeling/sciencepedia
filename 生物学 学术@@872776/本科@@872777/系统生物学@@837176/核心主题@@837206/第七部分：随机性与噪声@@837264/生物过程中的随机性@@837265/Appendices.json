{"hands_on_practices": [{"introduction": "生灭过程是理解分子群体随机性的基石模型。本练习将引导您推导一个简单基因表达系统的稳态概率分布，揭示了生产/降解速率与最终蛋白质数量的泊松分布之间的根本联系。掌握这一基础模型是分析更复杂随机现象的关键 [@problem_id:1468478]。", "problem": "在一个合成生物学实验中，一种经过基因工程改造的细菌被设计用于生产一种荧光蛋白。单个蛋白质分子的产生是一个随机事件，其发生的平均生产速率为常数 $k$。每个荧光蛋白分子一旦合成，就可能独立且随机地被降解。任何单个蛋白质分子在单位时间内被降解的概率是一个常数 $\\gamma$。令 $n$ 为在给定时刻细菌内的荧光蛋白分子数量。\n\n当系统运行很长时间并达到统计平衡后，在单个细菌中发现恰好 $n$ 个荧光蛋白分子的概率分布 $P(n)$ 是什么？请将您的答案 $P(n)$ 表示为分子数 $n$、生产速率 $k$ 以及单个分子的降解速率常数 $\\gamma$ 的函数。", "solution": "令 $P(n, t)$ 为在时刻 $t$ 细胞内有 $n$ 个分子的概率。系统的状态是整数 $n$。我们可以使用化学主方程来模拟 $P(n, t)$ 的时间演化，该方程考虑了流入和流出状态 $n$ 的概率流。\n\n改变分子数量的过程有两个：\n1.  **生产（出生）：** 新分子以恒定速率 $k$ 产生。此过程使系统从状态 $n-1$ 跃迁到状态 $n$。该跃迁的速率为 $k$。\n2.  **降解（死亡）：** 现有分子被降解。如果存在 $n$ 个分子，且每个分子以速率常数 $\\gamma$ 独立降解，则细胞的总降解速率为 $n\\gamma$。此过程使系统从状态 $n$ 跃迁到状态 $n-1$。\n\n状态 $n$ 的主方程由概率流的平衡给出：\n$$ \\frac{dP(n,t)}{dt} = (\\text{流入状态 } n \\text{ 的通量}) - (\\text{流出状态 } n \\text{ 的通量}) $$\n\n流入状态 $n$ 的通量来自两个来源：\n- 从状态 $n-1$ 的生产：速率为 $k \\times P(n-1, t)$。\n- 从状态 $n+1$ 的降解：速率为 $\\gamma(n+1) \\times P(n+1, t)$。\n\n流出状态 $n$ 的通量也有两部分贡献：\n- 从状态 $n$ 的生产：这导致系统进入状态 $n+1$。速率为 $k \\times P(n, t)$。\n- 从状态 $n$ 的降解：这导致系统进入状态 $n-1$。速率为 $\\gamma n \\times P(n, t)$。\n\n合并这些项，主方程为：\n$$ \\frac{dP(n,t)}{dt} = \\left[ k P(n-1, t) + \\gamma(n+1) P(n+1, t) \\right] - \\left[ k P(n, t) + \\gamma n P(n, t) \\right] $$\n该方程对 $n \\ge 1$ 成立。对于 $n=0$ 的情况，不存在降解，因此方程略有不同：\n$$ \\frac{dP(0,t)}{dt} = \\gamma(1) P(1, t) - k P(0, t) $$\n\n问题要求的是统计平衡时的概率分布，即稳态分布。在稳态下，概率不随时间变化，因此对所有 $n$ 都有 $\\frac{dP(n,t)}{dt} = 0$。我们将稳态概率表示为 $P(n)$。\n\n将时间导数设为零，我们得到：\n对于 $n \\ge 1$：\n$$ 0 = k P(n-1) + \\gamma(n+1) P(n+1) - (k + \\gamma n) P(n) $$\n对于 $n = 0$：\n$$ 0 = \\gamma P(1) - k P(0) \\implies k P(0) = \\gamma P(1) $$\n\n对于这样的一维系统，稳态条件意味着任何两个相邻状态之间的净概率流必须为零。这就是细致平衡原理。从状态 $n$ 到 $n+1$ 的通量必须等于从状态 $n+1$ 到 $n$ 的通量。\n$$ \\text{通量}(n \\to n+1) = \\text{通量}(n+1 \\to n) $$\n$$ k P(n) = \\gamma (n+1) P(n+1) $$\n\n这个单一关系对所有 $n \\ge 0$ 都成立，并且等价于整套稳态主方程。现在我们得到了一个关于概率的递推关系：\n$$ P(n+1) = \\frac{k}{\\gamma(n+1)} P(n) $$\n\n我们可以通过迭代来求解：\n对于 $n=0$：$P(1) = \\frac{k}{\\gamma(1)} P(0)$\n对于 $n=1$：$P(2) = \\frac{k}{\\gamma(2)} P(1) = \\frac{k}{2\\gamma} \\left(\\frac{k}{\\gamma} P(0)\\right) = \\frac{1}{2} \\left(\\frac{k}{\\gamma}\\right)^2 P(0)$\n对于 $n=2$：$P(3) = \\frac{k}{\\gamma(3)} P(2) = \\frac{k}{3\\gamma} \\left(\\frac{1}{2} \\left(\\frac{k}{\\gamma}\\right)^2 P(0)\\right) = \\frac{1}{3 \\cdot 2} \\left(\\frac{k}{\\gamma}\\right)^3 P(0) = \\frac{1}{3!} \\left(\\frac{k}{\\gamma}\\right)^3 P(0)$\n\n通过归纳法，我们可以看出一般模式：\n$$ P(n) = \\frac{1}{n!} \\left(\\frac{k}{\\gamma}\\right)^n P(0) $$\n\n为了求出 $P(0)$，我们使用归一化条件，即所有概率的总和必须为 1：\n$$ \\sum_{n=0}^{\\infty} P(n) = 1 $$\n$$ \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{k}{\\gamma}\\right)^n P(0) = 1 $$\n$$ P(0) \\sum_{n=0}^{\\infty} \\frac{1}{n!} \\left(\\frac{k}{\\gamma}\\right)^n = 1 $$\n\n我们认出这个和是指数函数的泰勒级数展开式，$\\sum_{n=0}^{\\infty} \\frac{x^n}{n!} = \\exp(x)$，其中 $x = k/\\gamma$。\n$$ P(0) \\exp\\left(\\frac{k}{\\gamma}\\right) = 1 $$\n$$ P(0) = \\frac{1}{\\exp\\left(\\frac{k}{\\gamma}\\right)} = \\exp\\left(-\\frac{k}{\\gamma}\\right) $$\n\n最后，我们将 $P(0)$ 的表达式代回到 $P(n)$ 的公式中：\n$$ P(n) = \\frac{1}{n!} \\left(\\frac{k}{\\gamma}\\right)^n \\exp\\left(-\\frac{k}{\\gamma}\\right) $$\n这就是均值为 $\\lambda = k/\\gamma$ 的泊松分布。", "answer": "$$\\boxed{\\frac{\\left(\\frac{k}{\\gamma}\\right)^{n} \\exp\\left(-\\frac{k}{\\gamma}\\right)}{n!}}$$", "id": "1468478"}, {"introduction": "虽然解析解功能强大，但大多数生物系统过于复杂，需要依赖计算机模拟。本练习介绍了广泛使用的Gillespie算法的核心组成部分：反应倾向性（propensity）的计算。通过为一个包含二聚化反应的系统计算总事件发生率，您将亲身体验随机化学动力学模拟的第一步 [@problem_id:1468506]。", "problem": "在一个单细胞内基因调控网络的简化模型中，一种蛋白质 $P$ 会被生产出来，并随后形成二聚体 $D$。该系统的动力学由四个基本随机反应控制。在任意时刻，蛋白质 $P$ 和二聚体 $D$ 的分子数分别表示为 $N_P$ 和 $N_D$。\n\n这四个反应是：\n1.  **生产**：一个新的蛋白质 $P$ 分子被合成。这是一个零级过程，以恒定的随机速率 $k_{prod}$ 发生。\n2.  **降解**：一个蛋白质 $P$ 分子被降解。这是一个一级过程，每个 $P$ 分子都有独立的降解几率，由随机速率常数 $k_{deg}$ 描述。\n3.  **二聚化**：两个蛋白质 $P$ 分子结合形成一个二聚体 $D$ 分子。这是一个二级过程，由随机速率常数 $k_{dimer}$ 描述。\n4.  **解离**：一个二聚体 $D$ 分子分解成两个蛋白质 $P$ 分子。这是一个一级过程，由随机速率常数 $k_{diss}$ 描述。\n\n总事件速率 $a_{tot}$ 定义为系统中所有可能反应的瞬时速率之和。这个量对于随机模拟算法至关重要，因为它决定了到下一个分子事件发生的时间。\n\n给定以下速率常数和系统在某一特定时刻的状态：\n-   $k_{prod} = 2.50 \\, \\text{s}^{-1}$\n-   $k_{deg} = 0.15 \\, \\text{s}^{-1}$\n-   $k_{dimer} = 0.0040 \\, \\text{s}^{-1}$\n-   $k_{diss} = 0.80 \\, \\text{s}^{-1}$\n-   蛋白质分子数，$N_P = 60$\n-   二聚体分子数，$N_D = 25$\n\n计算此刻总事件速率 $a_{tot}$ 的数值。以 $\\text{s}^{-1}$ 为单位表示你的答案，并四舍五入到三位有效数字。", "solution": "总事件速率是所有反应倾向性（propensity）之和。对于这四个反应，其反应倾向分别为：\n- 生产（零级）：$a_{prod} = k_{prod}$。\n- 降解（关于 $P$ 是一级）：$a_{deg} = k_{deg} N_{P}$。\n- 二聚化（关于 $P$ 是二级）：$a_{dimer} = k_{dimer} \\binom{N_{P}}{2} = k_{dimer} \\frac{N_{P}(N_{P}-1)}{2}$。\n- 解离（关于 $D$ 是一级）：$a_{diss} = k_{diss} N_{D}$。\n\n因此，\n$$\na_{tot} = a_{prod} + a_{deg} + a_{dimer} + a_{diss}\n= k_{prod} + k_{deg} N_{P} + k_{dimer} \\frac{N_{P}(N_{P}-1)}{2} + k_{diss} N_{D}.\n$$\n\n代入给定值，\n$$\na_{prod} = 2.50, \\quad\na_{deg} = 0.15 \\times 60 = 9.00, \\quad\na_{dimer} = 0.0040 \\times \\frac{60 \\times 59}{2} = 0.0040 \\times 1770 = 7.08, \\quad\na_{diss} = 0.80 \\times 25 = 20.0.\n$$\n\n求和，\n$$\na_{tot} = 2.50 + 9.00 + 7.08 + 20.0 = 38.58.\n$$\n\n四舍五入到三位有效数字，\n$$\na_{tot} = 38.6.\n$$", "answer": "$$\\boxed{38.6}$$", "id": "1468506"}, {"introduction": "系统生物学的一个核心挑战是剖析影响基因表达的不同噪声来源。这个问题阐释了如何通过一个巧妙的双报告基因实验来区分内在噪声（源自基因自身的表达过程）和外在噪声（源自共享的细胞环境）。您将利用假设的实验数据，练习计算这些噪声分量，从而架起理论概念与实验数据分析之间的桥梁 [@problem_id:1468474]。", "problem": "一位研究人员正在研究一个细菌细胞群体中，由合成启动子 $P_{syn}$ 控制的基因表达的随机性。为了剖析噪声的不同来源，研究人员采用了一种涉及双报告基因系统的实验策略。构建了一个质粒，其上携带两个荧光报告基因：一个编码绿色荧光蛋白（GFP），另一个编码青色荧光蛋白（CFP）。这两个基因分别由相同的 $P_{syn}$ 启动子拷贝独立调控。\n\n在细菌培养物达到稳态后，测量了大量单个细胞的荧光强度。设 $G$ 和 $C$ 分别表示 GFP 和 CFP 的荧光强度，单位为任意荧光单位（AFU）。对群体数据的统计分析得到以下各阶矩：\n\n- GFP 平均强度：$\\langle G \\rangle = 1.60 \\times 10^3$ AFU\n- GFP 强度平方的平均值：$\\langle G^2 \\rangle = 2.768 \\times 10^6$ AFU$^2$\n- GFP 和 CFP 强度乘积的平均值：$\\langle G C \\rangle = 2.688 \\times 10^6$ AFU$^2$\n\n假设由于两个报告基因表达盒的设计相同，CFP 的平均表达水平与 GFP 相同，即 $\\langle C \\rangle = \\langle G \\rangle$。对于一个给定基因的总噪声可以分解为两个部分：内在噪声，它源于该基因自身表达过程中的随机生化事件；以及外在噪声，它源于同时影响两个报告基因的共享细胞因子的波动。\n\n计算外在噪声强度与内在噪声强度的比值 $\\frac{\\eta_{\\text{ext}}^2}{\\eta_{\\text{int}}^2}$。答案以实数形式报告，并四舍五入到三位有效数字。", "solution": "双报告基因分解法假设每个报告基因的表达是其特有的内在部分与两者共享的外在部分之和。设平均值为 $\\mu=\\langle G \\rangle=\\langle C \\rangle$。那么可以写作 $G=\\mu+X+E$ 和 $C=\\mu+Y+E$，其中 $X$ 和 $Y$ 是独立的内在波动，其平均值为零，方差相同，为 $\\sigma_{\\text{int}}^{2}$；$E$ 是外在波动，其平均值为零，方差为 $\\sigma_{\\text{ext}}^{2}$。根据这个模型，\n$$\n\\operatorname{Var}(G)=\\sigma_{\\text{int}}^{2}+\\sigma_{\\text{ext}}^{2},\\qquad \\operatorname{Cov}(G,C)=\\sigma_{\\text{ext}}^{2}.\n$$\n将噪声强度（变异系数的平方）定义为\n$$\n\\eta_{\\text{tot}}^{2}=\\frac{\\operatorname{Var}(G)}{\\mu^{2}},\\quad \\eta_{\\text{ext}}^{2}=\\frac{\\sigma_{\\text{ext}}^{2}}{\\mu^{2}}=\\frac{\\operatorname{Cov}(G,C)}{\\mu^{2}},\\quad \\eta_{\\text{int}}^{2}=\\frac{\\sigma_{\\text{int}}^{2}}{\\mu^{2}}.\n$$\n因此，\n$$\n\\frac{\\eta_{\\text{ext}}^{2}}{\\eta_{\\text{int}}^{2}}=\\frac{\\sigma_{\\text{ext}}^{2}}{\\sigma_{\\text{int}}^{2}}=\\frac{\\operatorname{Cov}(G,C)}{\\operatorname{Var}(G)-\\operatorname{Cov}(G,C)}.\n$$\n从数据中计算所需的矩：\n$$\n\\operatorname{Var}(G)=\\langle G^{2}\\rangle-\\langle G\\rangle^{2}=2.768\\times 10^{6}-(1.60\\times 10^{3})^{2}=2.768\\times 10^{6}-2.56\\times 10^{6}=2.08\\times 10^{5},\n$$\n$$\n\\operatorname{Cov}(G,C)=\\langle GC\\rangle-\\langle G\\rangle\\langle C\\rangle=2.688\\times 10^{6}-2.56\\times 10^{6}=1.28\\times 10^{5}.\n$$\n因此，\n$$\n\\frac{\\eta_{\\text{ext}}^{2}}{\\eta_{\\text{int}}^{2}}=\\frac{1.28\\times 10^{5}}{2.08\\times 10^{5}-1.28\\times 10^{5}}=\\frac{1.28\\times 10^{5}}{0.80\\times 10^{5}}=1.6.\n$$\n四舍五入到三位有效数字，结果是 $1.60$。", "answer": "$$\\boxed{1.60}$$", "id": "1468474"}]}