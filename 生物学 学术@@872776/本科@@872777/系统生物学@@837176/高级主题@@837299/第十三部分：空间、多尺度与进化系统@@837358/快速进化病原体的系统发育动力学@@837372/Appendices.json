{"hands_on_practices": [{"introduction": "在系统动力学中，病毒的演化速度是一个关键参数，它就像一个“分子钟”，为我们揭示流行病的时间尺度。本练习将模拟一个实验室场景，你将学习如何从时间序列的基因测序数据中直接测量这个演化速率。这是进行任何演化分析的基础技能，它将让你亲身体验如何将原始的核苷酸替换计数转化为一个标准化的演化速率。", "problem": "研究人员正在受控的实验室环境中研究一种名为“Corvusvirus”的新型RNA病毒的演化。他们用遗传上同质的病毒群体感染一个大型细胞培养物，由此启动了一项实验。培养物被持续培养，并在不同的时间间隔提取病毒样本。对于每个样本，一个长度为 $L=1200$ 个核苷酸的特定基因被进行了测序。通过将每个时间点 $t$ 的序列与 $t=0$ 时的原始病毒序列进行比较，确定了核苷酸替换的平均数 $S$。实验数据如下：\n\n- 在 $t=0$ 天时，$S=0.0$\n- 在 $t=25$ 天时，$S=1.4$\n- 在 $t=50$ 天时，$S=3.1$\n- 在 $t=75$ 天时，$S=4.6$\n- 在 $t=100$ 天时，$S=6.0$\n\n为了量化演化速率，通过将数据拟合到一条穿过原点 $(0,0)$ 的直线上，来确定替换累积的速率。然后，使用这个速率来计算病毒的平均替换率。将您的最终答案以“替换数/位点/年”为单位表示。假设一年有365天。将您的最终答案四舍五入到两位有效数字。", "solution": "我们将替换累积建模为一个通过原点的线性函数 $S(t)=k t$，其中 $k$ 是每个基因每天的替换速率。在约束直线通过原点的条件下，$k$ 的最小二乘估计值通过最小化 $\\sum_{i}(S_{i}-k t_{i})^{2}$ 求得，可得\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}k}\\sum_{i}(S_{i}-k t_{i})^{2}=-2\\sum_{i}t_{i}(S_{i}-k t_{i})=0 \\;\\;\\Rightarrow\\;\\; k=\\frac{\\sum_{i} t_{i} S_{i}}{\\sum_{i} t_{i}^{2}}。\n$$\n使用 $t=\\{25,50,75,100\\}$ 天和 $S=\\{1.4,3.1,4.6,6.0\\}$ 的数据，计算总和\n$$\n\\sum t_{i} S_{i}=25\\cdot 1.4+50\\cdot 3.1+75\\cdot 4.6+100\\cdot 6.0=35+155+345+600=1135,\n$$\n$$\n\\sum t_{i}^{2}=25^{2}+50^{2}+75^{2}+100^{2}=625+2500+5625+10000=18750。\n$$\n因此，\n$$\nk=\\frac{1135}{18750}=\\frac{227}{3750}\\;\\text{替换数/基因/天}。\n$$\n通过除以基因长度 $L=1200$ 个位点并乘以每年365天，可将此速率转换为以“替换数/位点/年”为单位：\n$$\nr=\\left(\\frac{227}{3750}\\right)\\left(\\frac{365}{1200}\\right)=\\frac{227\\cdot 365}{3750\\cdot 1200}=\\frac{82855}{4500000}=\\frac{16571}{900000}\\;\\text{替换数/位点/年}。\n$$\n数值上，$\\frac{16571}{900000}\\approx 0.018412\\ldots$，四舍五入到两位有效数字为 $0.018$。", "answer": "$$\\boxed{0.018}$$", "id": "1458642"}, {"introduction": "一旦我们知道了分子钟的“滴答”速率，我们就可以用它来追溯演化的时间。在这个练习中，你将应用一个已知的替换率来计算两个病毒序列的“最近公共祖ce时间”（TMRCA）。这项核心技术对于追溯疫情暴发的源头和理解其早期传播历史至关重要。", "problem": "一位流行病学家正在调查一种新发现的RNA病毒在某局部社区的传播情况。为了了解其近期的进化史，研究人员从两名不同的感染者身上同时采集了两个病毒样本。这些病毒的基因组被测序和比较。\n\n该病毒基因组是一条长度为 $L = 2500$ 个核苷酸的单链RNA。对两个序列的比较显示，它们之间存在 $D = 15$ 个核苷酸的差异。根据对相关病毒的广泛研究，平均替换率估计为 $\\mu = 1.25 \\times 10^{-3}$ 次替换/位点/年。\n\n假设替换率恒定（即“分子钟”），估计这两个病毒谱系分化自共同祖先以来所经过的时间。这个值被称为最近共同祖先的时间（TMRCA）。\n\n答案以年为单位，并四舍五入至三位有效数字。", "solution": "我们将替换建模为一个遵循严格分子钟的泊松过程，其每个位点的恒定速率为 $\\mu$（替换数/位点/年）。对于两个在同一时间采样、在 $t$ 年前分化的序列，每个谱系都以速率 $\\mu$ 独立累积替换，因此它们之间每个位点的预期总替换数为 $2\\mu t$。在长度为 $L$ 的基因组上，预期的差异数因此为\n$$\n\\mathbb{E}[D]=2\\mu L t.\n$$\n求解 $t$ 可得\n$$\nt=\\frac{D}{2\\mu L}.\n$$\n代入给定值 $D=15$，$L=2500$ 和 $\\mu=1.25 \\times 10^{-3}$ 替换数/位点/年：\n$$\nt=\\frac{15}{2 \\cdot \\left(1.25 \\times 10^{-3}\\right)\\cdot 2500}.\n$$\n逐步计算分母：\n$$\n\\left(1.25 \\times 10^{-3}\\right)\\cdot 2500=3.125,\\quad 2\\cdot 3.125=6.25.\n$$\n因此，\n$$\nt=\\frac{15}{6.25}=2.4\\ \\text{年}.\n$$\n四舍五入到三位有效数字，结果为 $2.40$ 年。\n\n关于多重替换校正的说明：使用 Jukes–Cantor 校正，首先计算观察到的差异比例 $p=D/L=15/2500=0.006$，然后计算校正后的距离 $d=-\\frac{3}{4}\\ln\\!\\left(1-\\frac{4p}{3}\\right)\\approx 0.006024$，最后得到 $t=d/(2\\mu)\\approx 2.41$ 年。鉴于 $p$ 值非常小，该校正可以忽略不计，因此上述更简单的泊松估计是合适的。", "answer": "$$\\boxed{2.40}$$", "id": "1458657"}, {"introduction": "系统发育树是强大的工具，但它们是对更复杂现实的简化。本练习探讨了一个核心问题：当我们忽略单个宿主体内的病毒多样性时会发生什么？通过对传播瓶颈进行建模，你将发现预先存在的少数病毒变异株如何可能被误认为是宿主间传播过程中发生的新突变[@problem_id:1458609]，这对准确解释流行病的动态至关重要。", "problem": "在对快速演化的病毒进行研究时，一种常见的简化方法是用单一的“共有”基因组序列来代表受感染个体内的整个病毒群体。然而，这种方法可能会掩盖病毒演化的潜在动态，特别是宿主内多样性的作用。\n\n考虑这个场景的一个简化模型。一个初始宿主感染了一种病毒，该宿主内的病毒群体由一个准种组成，包含两种变体：主变体 $V_M$ 和次变体 $v_m$。这两种变体仅相差一个核苷酸。在初始宿主中，主变体 $V_M$ 的频率为 $p$，次变体 $v_m$ 的频率为 $1-p$。已知 $p > 0.5$。宿主的共有序列被定义为频率大于0.5的变体的序列。\n\n然后，病毒从初始宿主传播到一个新的、未受感染的受体宿主。这个传播事件涉及一个严重的瓶颈，即只有一个病毒颗粒被传播。某个特定变体被传播的概率等于它在初始宿主中的频率。这个被传播的单个病毒颗粒随后在受体宿主中迅速复制，其基因型成为该宿主新的共有序列。\n\n计算受体宿主的共有序列为次变体 $v_m$ 的概率。这种结果将导致仅基于共有序列的系统发育分析错误地推断出在两个宿主之间发生了突变，而不是预先存在的少数变体的传播。请用 $p$ 来表示你的答案。", "solution": "设初始宿主携带两种变体：频率为 $p$ 的主变体 $V_{M}$ 和频率为 $1-p$ 的次变体 $v_{m}$，其中 $p>0.5$。根据共有序列的定义，初始宿主的共有序列是 $V_{M}$。\n\n传播过程只涉及一个病毒颗粒。从一个变体频率为 $(p, 1-p)$ 的群体中抽样单个颗粒，对于“传播 $v_{m}$”这一事件来说，是一次伯努利试验，其成功概率等于其频率。因此，传播的颗粒是 $v_{m}$ 的概率为\n$$\n\\Pr(\\text{transmit } v_{m})=1-p.\n$$\n\n在感染受体后，被传播的颗粒迅速复制，使其基因型在新宿主中达到频率 $1$。由于共有序列被定义为频率大于 $0.5$ 的变体，因此受体宿主的共有序列将等于被传播的基因型。因此，受体宿主的共有序列是 $v_{m}$ 的概率等于 $v_{m}$ 被传播的概率：\n$$\n\\Pr(\\text{recipient consensus is } v_{m})=1-p.\n$$\n\n因为 $p>0.5$，初始宿主的共有序列是 $V_{M}$，所以这个事件对应于宿主之间在没有新突变的情况下共有序列发生了表面上的变化；这一结果的概率是 $1-p$。", "answer": "$$\\boxed{1-p}$$", "id": "1458609"}]}