{"hands_on_practices": [{"introduction": "贝叶斯网络中的一个基本应用是进行预测性推理，即根据上游原因推断下游结果的概率。这个问题通过一个简化的酶动力学模型，展示了概率如何在网络中沿着因果链传播。通过计算在给定酶构象的情况下底物未结合的最终概率，你将练习使用全概率定律来处理未被观测到的中间变量，这是理解复杂生物通路中信号流动的核心技能。[@problem_id:1418698]", "problem": "在一个简化的酶动力学模型中，一个特定酶的功能由一个涉及三个随机变量的贝叶斯网络来描述：构象 ($C$)、活性水平 ($A$) 和底物结合状态 ($B$)。该网络具有一个因果结构，其中构象影响活性水平，而活性水平又决定了底物结合状态 ($C \\to A \\to B$)。\n\n这些变量具有以下状态：\n-   构象 ($C$): 高活性构象 ($C_H$) 或低活性构象 ($C_L$)。\n-   活性水平 ($A$): 活性 ($A_T$) 或非活性 ($A_I$)。\n-   底物结合状态 ($B$): 已结合 ($B_D$) 或未结合 ($B_U$)。\n\n概率关系定义如下：\n\n1.  酶处于高活性构象的先验概率为：\n    $P(C = C_H) = 0.3$\n\n2.  在给定酶的构象条件下，其活性水平的条件概率为：\n    $P(A = A_T | C = C_H) = 0.9$\n    $P(A = A_T | C = C_L) = 0.2$\n\n3.  在给定酶的活性水平条件下，底物结合状态的条件概率为：\n    $P(B = B_D | A = A_T) = 0.85$\n    $P(B = B_D | A = A_I) = 0.05$\n\n已知酶处于其高活性构象 ($C = C_H$)，求底物分子未结合 ($B = B_U$) 的概率。请以精确的小数值给出答案。", "solution": "题目要求我们计算在贝叶斯网络 $C \\to A \\to B$ 中的条件概率 $P(B=B_{U} \\mid C=C_{H})$。根据对中间变量 $A$ 的全概率公式，并利用在给定 $A$ 的条件下 $B$ 与 $C$ 条件独立的性质，我们有\n$$\nP(B=B_{U} \\mid C=C_{H})=\\sum_{a \\in \\{A_{T},A_{I}\\}} P(B=B_{U} \\mid A=a, C=C_{H})\\,P(A=a \\mid C=C_{H})\n= \\sum_{a \\in \\{A_{T},A_{I}\\}} P(B=B_{U} \\mid A=a)\\,P(A=a \\mid C=C_{H}).\n$$\n根据给定的概率，\n$$\nP(A=A_{T} \\mid C=C_{H})=0.9 \\quad \\Rightarrow \\quad P(A=A_{I} \\mid C=C_{H})=1-0.9=0.1,\n$$\n以及\n$$\nP(B=B_{D} \\mid A=A_{T})=0.85 \\quad \\Rightarrow \\quad P(B=B_{U} \\mid A=A_{T})=1-0.85=0.15,\n$$\n$$\nP(B=B_{D} \\mid A=A_{I})=0.05 \\quad \\Rightarrow \\quad P(B=B_{U} \\mid A=A_{I})=1-0.05=0.95.\n$$\n因此，\n$$\nP(B=B_{U} \\mid C=C_{H})=0.15 \\cdot 0.9 + 0.95 \\cdot 0.1 = 0.135 + 0.095 = 0.23.\n$$", "answer": "$$\\boxed{0.23}$$", "id": "1418698"}, {"introduction": "生物调控网络远比简单的线性链条复杂，常常包含如前馈环路 (Feed-Forward Loop, FFL) 这样的典型“网络基序”。这个练习将引导你探索一种更高级的推理形式：诊断性推理。当观测到一个上游原因和一个下游结果时，我们需要推断中间变量的状态，这对于理解不同调控路径如何协同作用以及解释“解释消除”现象至关重要。[@problem_id:1418697]", "problem": "在系统生物学中，基因调控网络通常使用概率图模型进行建模。考虑一个简单的网络基序，称为相干1型前馈环（FFL），它涉及三个基因：一个主调节基因 `A`，以及两个靶基因 `B` 和 `C`。调控相互作用如下：\n1.  基因 `A` 激活基因 `B` 的表达。\n2.  基因 `A` 激活基因 `C` 的表达。\n3.  基因 `B` 也激活基因 `C` 的表达。\n\n每个基因的状态可以是“激活”（用1表示）或“非激活”（用0表示）。基于大量的实验数据，其概率关系由以下条件概率描述：\n\n-   在基因A状态给定的情况下，基因B被激活的概率：\n    -   $P(B=1|A=1) = 0.80$\n    -   $P(B=1|A=0) = 0.10$\n\n-   在基因A和基因B状态给定的情况下，基因C被激活的概率：\n    -   $P(C=1|A=1, B=1) = 0.95$\n    -   $P(C=1|A=1, B=0) = 0.50$\n    -   $P(C=1|A=0, B=1) = 0.40$\n    -   $P(C=1|A=0, B=0) = 0.05$\n\n进行了一项实验，并得到了一个特定的观察结果：基因A和基因C都被发现处于“激活”状态。根据这一观察结果，计算基因B也处于“激活”状态的概率。将您的答案表示为保留三位有效数字的小数。", "solution": "设 $A, B, C$ 分别代表基因A、基因B和基因C被激活的事件。设 $\\neg A, \\neg B, \\neg C$ 代表它们未被激活的事件。题目从前馈环（FFL）的结构中提供了以下条件概率：\n-   $P(B|A) = 0.80$\n-   $P(B|\\neg A) = 0.10$\n-   $P(C|A, B) = 0.95$\n-   $P(C|A, \\neg B) = 0.50$\n-   $P(C|\\neg A, B) = 0.40$\n-   $P(C|\\neg A, \\neg B) = 0.05$\n\n我们需要求解在基因A和基因C都被激活的条件下，基因B也被激活的概率。这即是条件概率 $P(B | A, C)$。\n\n根据条件概率的定义，我们可以写出：\n$$P(B | A, C) = \\frac{P(A, B, C)}{P(A, C)}$$\n\n分母中的联合概率 $P(A, C)$ 可以通过对基因B的状态进行边缘化来求得。这是全概率公式的应用：\n$$P(A, C) = P(A, B, C) + P(A, \\neg B, C)$$\n\n将此代入我们关于 $P(B | A, C)$ 的表达式中：\n$$P(B | A, C) = \\frac{P(A, B, C)}{P(A, B, C) + P(A, \\neg B, C)}$$\n\n现在，我们必须使用贝叶斯网络的链式法则来表示联合概率 $P(A, B, C)$ 和 $P(A, \\neg B, C)$。网络结构由依赖关系定义：$A$ 是 $B$ 的父节点，而 $A$ 和 $B$ 都是 $C$ 的父节点。这三个变量的联合概率由下式给出：\n$$P(A, B, C) = P(A) P(B|A) P(C|A, B)$$\n\n使用这个结构，我们可以写出我们需要的项：\n-   对于三者都激活的情况：\n    $$P(A, B, C) = P(A) P(B|A) P(C|A, B)$$\n-   对于A和C激活，但B不激活的情况：\n    $$P(A, \\neg B, C) = P(A) P(\\neg B|A) P(C|A, \\neg B)$$\n\n现在我们将这些表达式代回 $P(B | A, C)$ 的方程中：\n$$P(B | A, C) = \\frac{P(A) P(B|A) P(C|A, B)}{P(A) P(B|A) P(C|A, B) + P(A) P(\\neg B|A) P(C|A, \\neg B)}$$\n\n项 $P(A)$，即基因A被激活的先验概率，可以方便地从分子和分母中约去：\n$$P(B | A, C) = \\frac{P(B|A) P(C|A, B)}{P(B|A) P(C|A, B) + P(\\neg B|A) P(C|A, \\neg B)}$$\n\n我们从题目描述中得到以下数值：\n-   $P(B|A) = P(B=1|A=1) = 0.80$\n-   $P(C|A, B) = P(C=1|A=1, B=1) = 0.95$\n-   $P(C|A, \\neg B) = P(C=1|A=1, B=0) = 0.50$\n\n我们还需要 $P(\\neg B|A)$，即在A被激活的条件下B未被激活的概率。这可以计算为：\n$$P(\\neg B|A) = P(B=0|A=1) = 1 - P(B=1|A=1) = 1 - 0.80 = 0.20$$\n\n现在，我们将这些数值代入我们的最终表达式中：\n$$P(B | A, C) = \\frac{0.80 \\times 0.95}{(0.80 \\times 0.95) + (0.20 \\times 0.50)}$$\n\n首先，计算乘积：\n-   分子：$0.80 \\times 0.95 = 0.76$\n-   分母中的第二项：$0.20 \\times 0.50 = 0.10$\n\n现在，将这些值代回分数中：\n$$P(B | A, C) = \\frac{0.76}{0.76 + 0.10} = \\frac{0.76}{0.86}$$\n\n最后，我们计算小数值并四舍五入到三位有效数字：\n$$\\frac{0.76}{0.86} \\approx 0.8837209...$$\n四舍五入到三位有效数字，我们得到 $0.884$。", "answer": "$$\\boxed{0.884}$$", "id": "1418697"}, {"introduction": "对于包含成百上千个节点的真实生物网络，之前练习中的精确推理在计算上是不可行的。在这种情况下，我们必须依赖于像吉布斯采样 (Gibbs sampling) 这样的近似推理方法。这个问题为你提供了一个了解这些强大算法工作原理的窗口，它聚焦于吉布斯采样中的单个更新步骤。你将计算在给定其邻居状态的条件下，单个蛋白质状态的条件概率，这是马尔可夫链蒙特卡洛 (MCMC) 方法的核心操作。[@problem_id:1418760]", "problem": "在系统生物学中，蛋白质相互作用通常被建模为一个网络，其中每个蛋白质的状态会影响其邻居。考虑一个蛋白质复合物形成的简化模型，该复合物由四个蛋白质 P1、P2、P3 和 P4 组成的线性链表示。每个蛋白质 $P_i$ 的状态由一个二元变量 $X_i \\in \\{0, 1\\}$ 描述，其中 $X_i=1$ 表示蛋白质处于“激活”状态（被招募到复合物中），而 $X_i=0$ 表示其处于“非激活”状态。\n\n该系统的行为由遵循玻尔兹曼分布的联合概率分布描述，$P(X_1, X_2, X_3, X_4) \\propto \\exp(-E/k_B T)$，其中 $k_B$ 是玻尔兹曼常数，$T$ 是温度。能量函数 $E$ 取决于链中相邻蛋白质之间的相互作用：\n$$E(X_1, X_2, X_3, X_4) = -J(X_1 X_2 + X_2 X_3 + X_3 X_4)$$\n此处，$J > 0$ 是一个代表相互作用强度的常数，它在能量上倾向于使相邻蛋白质处于相同状态。为方便起见，所有热效应都被吸收到一个单一的无量纲参数 $\\alpha = J/(k_B T)$ 中。因此，给定构型 $\\mathbf{X} = (X_1, X_2, X_3, X_4)$ 的概率可以表示为：\n$$P(\\mathbf{X}) \\propto \\exp(\\alpha (X_1 X_2 + X_2 X_3 + X_3 X_4))$$\n\n为了研究该系统的性质（在现实世界场景中，该系统因规模过大而无法进行精确推断），研究人员采用了吉布斯采样（Gibbs sampling）。这种迭代方法是在给定所有其他变量当前状态的条件下，一次一个地从其条件分布中对每个变量进行采样。\n\n假设经过几次迭代后，系统处于状态 $(X_1=1, X_3=0, X_4=1)$。根据吉布斯采样协议，下一步是通过从其条件概率分布中为 $X_2$ 抽取一个新值来更新蛋白质 P2 的状态。计算蛋白质 P2 的新状态为激活的概率，即求 $P(X_2=1 | X_1=1, X_3=0, X_4=1)$。请用 $\\alpha$ 的函数表示你的答案。", "solution": "我们使用给定能量的玻尔兹曼分布，因此对于任何构型 $\\mathbf{X}$，\n$$\nP(\\mathbf{X}) \\propto \\exp\\!\\left(\\alpha\\,(X_{1}X_{2}+X_{2}X_{3}+X_{3}X_{4})\\right).\n$$\n在吉布斯采样中，用于更新 $X_{2}$ 的条件概率为\n$$\nP(X_{2}=1 \\mid X_{1},X_{3},X_{4})=\\frac{P(X_{2}=1,X_{1},X_{3},X_{4})}{P(X_{2}=0,X_{1},X_{3},X_{4})+P(X_{2}=1,X_{1},X_{3},X_{4})}.\n$$\n对于固定的 $(X_{1},X_{3},X_{4})$，指数中依赖于 $X_{2}$ 的项是 $\\alpha(X_{1}X_{2}+X_{2}X_{3})$，而 $\\alpha X_{3}X_{4}$ 与 $X_{2}$ 无关，在条件比率中被消去。因此，\n$$\nP(X_{2}=x \\mid X_{1},X_{3},X_{4}) \\propto \\exp\\!\\left(\\alpha\\,(X_{1}x+xX_{3})\\right).\n$$\n所以，\n$$\nP(X_{2}=1 \\mid X_{1},X_{3},X_{4})=\\frac{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)+\\exp(0)}=\\frac{\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}{1+\\exp\\!\\left(\\alpha\\,(X_{1}+X_{3})\\right)}.\n$$\n代入给定值 $X_{1}=1$，$X_{3}=0$，$X_{4}=1$（注意 $X_{4}$ 不影响条件概率），\n$$\nP(X_{2}=1 \\mid X_{1}=1,X_{3}=0,X_{4}=1)=\\frac{\\exp(\\alpha)}{1+\\exp(\\alpha)}=\\frac{1}{1+\\exp(-\\alpha)}.\n$$", "answer": "$$\\boxed{\\frac{1}{1+\\exp(-\\alpha)}}$$", "id": "1418760"}]}