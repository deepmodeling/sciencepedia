{"hands_on_practices": [{"introduction": "在系统生物学研究中，我们常常会遇到样本量小或数据分布未知的挑战，例如在研究细菌持留性时。在这种情况下，自助法是评估参数不确定性的理想工具。这个入门练习 [@problem_id:1420137] 将带您体验自助法分析的最后一步：如何从一组已排序的自助法重抽样均值中，准确地解读并提取出置信区间。", "problem": "一位系统生物学研究者正在研究细菌持留性，这是一种一小部分微生物群体在致死剂量的抗生素作用下存活下来的现象。该研究者使用八个重复培养的*Escherichia coli*培养物进行了一项实验。每个培养物都用高浓度的ampicillin处理，经过一段时间后，通过计数剩余的菌落形成单位 (CFUs) 来确定存活分数。测量得到以下八个存活分数：\n$$ \\{1.72, 1.41, 1.55, 3.15, 1.63, 1.88, 1.39, 1.61\\} \\times 10^{-5} $$\n为了量化从这个小样本且非正态分布的数据集中估计真实平均存活分数的不确定性，研究者进行了一项计算自举分析。该分析包括从原始数据中生成 $B=10,000$ 个自举重抽样样本，并计算每个重抽样样本的均值。这就产生了一个包含10,000个自举均值的分布。将这些均值按升序排列后，记录了排序后列表中的一些关键值。排序后列表中特定位置的值如下：\n- 第250个值: $1.59 \\times 10^{-5}$\n- 第500个值: $1.64 \\times 10^{-5}$\n- 第9500个值: $2.31 \\times 10^{-5}$\n- 第9750个值: $2.42 \\times 10^{-5}$\n\n使用自举分析得到的这些信息，采用百分位数法确定平均存活分数的90%置信区间。给出该区间的下界和上界。将您的最终答案（下界和上界）以 $10^{-5}$ 为单位表示，并将每个值四舍五入到三位有效数字。", "solution": "我们希望使用自举百分位数法求出均值的90%置信区间。设 $B$ 为自举重抽样样本的数量，并设 $\\{\\bar{x}^{*(1)},\\ldots,\\bar{x}^{*(B)}\\}$ 表示按升序排列的自举均值。对于一个名义覆盖率为 $1-\\alpha=0.90$ 的双侧百分位数区间，其下界和上界取自排序后的自举分布中的经验分位数 $p_{\\text{lower}}=\\alpha/2$ 和 $p_{\\text{upper}}=1-\\alpha/2$ 处的值：\n$$\n\\text{CI}_{\\text{percentile}}=\\left[\\bar{x}^{*}_{(\\lfloor p_{\\text{lower}} B \\rfloor)}\\,,\\,\\bar{x}^{*}_{(\\lceil p_{\\text{upper}} B \\rceil)}\\right].\n$$\n这里 $B=10000$ 且 $\\alpha=0.10$，因此\n$$\np_{\\text{lower}}=0.05,\\quad p_{\\text{upper}}=0.95,\\quad p_{\\text{lower}} B=500,\\quad p_{\\text{upper}} B=9500.\n$$\n题目给出了在这些排名上的精确排序自举值：\n- 第500个值 (0.05分位数): $1.64 \\times 10^{-5}$，\n- 第9500个值 (0.95分位数): $2.31 \\times 10^{-5}$。\n因此，平均存活分数的90%自举百分位置信区间是\n$$\n\\left[1.64 \\times 10^{-5},\\,2.31 \\times 10^{-5}\\right].\n$$\n将这些界限以 $10^{-5}$ 为单位表示，得到数对 $\\left(1.64,\\,2.31\\right)$，它们已经精确到三位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}1.64  2.31\\end{pmatrix}}$$", "id": "1420137"}, {"introduction": "在掌握了解读方法后，我们向前追溯一步，直接处理自助法模拟的原始输出。这个练习 [@problem_id:1420159] 提供了一组关于群体感应激活阈值的自助法复制值。您的任务是亲自对这些数据进行排序和计算，应用标准的百分位插值法来构建置信区间，从而亲身体验从原始模拟数据到最终不确定性评估的全过程。", "problem": "一位系统生物学研究者正在研究群体感应（quorum sensing），这是一种细菌中的细胞间通讯机制。他们培养了一个经过基因工程改造的细菌菌株，该菌株在群体感应激活的启动子控制下表达绿色荧光蛋白（GFP）。研究者在不同细胞密度下测量了平均GFP荧光强度。\n\n为了量化群体感应回路的灵敏度，研究者将“激活阈值”定义为平均GFP荧光强度达到实验中观察到的最大荧光强度50%时的细胞密度。为了估计该激活阈值的不确定性，研究者进行了一项自助法（bootstrap）分析。从原始实验数据中，生成了大量的自助法样本，并对每个样本计算其激活阈值。这个过程得到了激活阈值的自助法复制值的分布。\n\n以下是激活阈值的20个自助法复制值，单位为 $10^7$ cells/mL：\n1.15, 1.21, 1.13, 1.19, 1.25, 1.14, 1.28, 1.17, 1.22, 1.16, 1.20, 1.12, 1.26, 1.30, 1.10, 1.18, 1.23, 1.27, 1.11, 1.24\n\n使用这组自助法复制样本，计算激活阈值的95%百分位数自助法置信区间的宽度。百分位数 $P$ 的值应通过以下线性插值方法确定：\n1.  计算排序值 $R = p \\times (N-1) + 1$，其中 $p=P/100$ 是百分位（例如，对于第2.5个百分位，$p=0.025$），$N$ 是数据点的总数。\n2.  令 $k = \\lfloor R \\rfloor$ 为排序值的整数部分，$d = R - k$ 为其小数部分。\n3.  百分位数的值为 $V = S_k + d \\times (S_{k+1} - S_k)$，其中 $S_k$ 是排序后数据列表中的第k个值（使用从1开始的索引，因此 $S_1$ 是最小值）。\n\n请以 cells/mL 为单位，给出置信区间宽度的最终答案，并四舍五入到三位有效数字。", "solution": "我们获得了激活阈值的20个自助法复制值（单位为 $10^{7}$ cells/mL）。为了构建95%百分位数自助法置信区间，我们使用指定的线性插值方法计算第2.5和第97.5个百分位数。设 $N=20$，并将升序排列的复制样本表示为 $S_{1},\\dots,S_{20}$。\n\n首先，对数据进行排序：\n$$\nS_{1}=1.10,\\ S_{2}=1.11,\\ S_{3}=1.12,\\ S_{4}=1.13,\\ S_{5}=1.14,\\ S_{6}=1.15,\\ S_{7}=1.16,\\ S_{8}=1.17,\\ S_{9}=1.18,\\ S_{10}=1.19,\n$$\n$$\nS_{11}=1.20,\\ S_{12}=1.21,\\ S_{13}=1.22,\\ S_{14}=1.23,\\ S_{15}=1.24,\\ S_{16}=1.25,\\ S_{17}=1.26,\\ S_{18}=1.27,\\ S_{19}=1.28,\\ S_{20}=1.30.\n$$\n\n对于第2.5个百分位数，取 $p=0.025$。使用给定的插值法：\n$$\nR=p\\,(N-1)+1=0.025 \\times 19 + 1=1.475,\\quad k=\\lfloor R \\rfloor=1,\\quad d=R-k=0.475.\n$$\n因此，\n$$\nV_{2.5} = S_{1} + d\\,(S_{2}-S_{1}) = 1.10 + 0.475\\,(1.11-1.10) = 1.10 + 0.00475 = 1.10475.\n$$\n\n对于第97.5个百分位数，取 $p=0.975$。则\n$$\nR=p\\,(N-1)+1=0.975 \\times 19 + 1=19.525,\\quad k=\\lfloor R \\rfloor=19,\\quad d=R-k=0.525.\n$$\n因此，\n$$\nV_{97.5} = S_{19} + d\\,(S_{20}-S_{19}) = 1.28 + 0.525\\,(1.30-1.28) = 1.28 + 0.0105 = 1.2905.\n$$\n\n因此，95%置信区间（单位为 $10^{7}$ cells/mL）为\n$$\n[\\,1.10475,\\ 1.2905\\,].\n$$\n其宽度（单位为 $10^{7}$ cells/mL）为\n$$\n\\Delta = 1.2905 - 1.10475 = 0.18575.\n$$\n\n由于原始值的单位是 $10^{7}$ cells/mL，因此以 cells/mL 为单位的宽度为\n$$\nW = 0.18575 \\times 10^{7} = 1.8575 \\times 10^{6}\\ \\text{cells/mL}.\n$$\n四舍五入到三位有效数字，结果是\n$$\n1.86 \\times 10^{6}.\n$$", "answer": "$$\\boxed{1.86 \\times 10^{6}}$$", "id": "1420159"}, {"introduction": "最后一个练习将引导您进入一个更高级的应用场景，它来自于高通量功能基因组学。该问题 [@problem_id:1420152] 揭示了一个深刻的观点：对于某些特定统计量（如比例），我们不一定需要进行耗时的计算机模拟。通过深入理解重抽样过程的本质，我们可以用一个解析模型（本例中为二项分布）来直接描述它，从而高效地为深度突变扫描实验中中性突变的比例提供精确的不确定性估计。", "problem": "一个系统生物学实验室正在使用深度突变扫描（DMS）研究一种特定酶中单氨基酸替换的功能性后果。这个高通量实验为每个突变产生一个连续的“适应度分数”$s$。适应度分数为 $s=0$ 表示中性突变（对功能没有影响），$s0$ 表示有害突变，而 $s>0$ 表示有益突变。\n\n由于固有的实验噪音和检测方法的分辨率，任何适应度分数 $s$ 在范围 $|s| \\le 0.05$ 内的突变都被认为是功能上中性的。在一个初步实验中，对25个不同的突变测量了以下25个适应度分数：\n$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15]$\n\n为了基于这个有限的样本量化中性突变比例的统计不确定性，您的任务是执行重采样分析。具体来说，您的目标是确定中性突变真实比例的95%置信区间。为了实现这一目标，您应该构思生成 $B=10000$ 个重采样数据集。每个重采样数据集是通过从原始数据集 $S$ 中*有放回地*抽取25个适应度分数来构建的。对于这 $10000$ 个重采样数据集中的每一个，都将计算中性突变的比例。然后，95%置信区间由这10000个比例所构成分布的第2.5和第97.5百分位数给出。\n\n计算该95%置信区间的下界和上界。将您的答案以一对值的形式报告，下界在前，并四舍五入到三位有效数字。", "solution": "我们首先将每个适应度分数 $s \\in S$ 分类，如果 $|s| \\le 0.05$，则为中性。在给定的列表中，\n$$S = [-1.21, -0.99, -0.87, -0.65, -0.53, -0.48, -0.33, -0.29, -0.21, -0.15, -0.11, -0.08, -0.04, -0.02, 0.01, 0.03, 0.04, 0.07, 0.10, 0.14, 0.22, 0.35, 0.58, 0.91, 1.15],$$\n中性分数为 $-0.04, -0.02, 0.01, 0.03, 0.04$，因此在总共 $n=25$ 个中，中性计数值为 $c=5$。观察到的中性比例是\n$$\\hat{p} = \\frac{c}{n} = \\frac{5}{25} = 0.2.$$\n\n在自助法程序中，每个重采样数据集都是通过从 $S$ 中有放回地抽取 $n=25$ 个分数来构建的。每次抽取都来自将质量 $1/n$ 置于每个观测分数上的经验分布；因此，抽到中性分数的概率等于 $\\hat{p}$。因此，在一个自助法重采样样本中，中性突变的数量 $K$ 服从\n$$K \\sim \\operatorname{Binomial}(n, \\hat{p}), \\quad \\text{with } n=25, \\ \\hat{p}=0.2.$$\n中性比例的自助法分布是 $K/n$。$95\\%$ 百分比的自助法百分位数区间对应于 $K/n$ 的 $0.025$ 和 $0.975$ 分位数，即值 $k_{\\mathrm{L}}$ 和 $k_{\\mathrm{U}}$ 满足\n$$\\Pr(K \\leq k_{\\mathrm{L}}) \\geq 0.025 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{L}}-1)  0.025,$$\n$$\\Pr(K \\leq k_{\\mathrm{U}}) \\geq 0.975 \\ \\text{and} \\ \\Pr(K \\leq k_{\\mathrm{U}}-1)  0.975.$$\n\n二项概率为\n$$\\Pr(K=k) = \\binom{25}{k} (0.2)^{k} (0.8)^{25-k}.$$\n使用 $P_{k}=\\Pr(K=k)$ 和递推关系计算下尾部\n$$\\frac{P_{k+1}}{P_{k}} = \\frac{25-k}{k+1} \\cdot \\frac{0.2}{0.8} = \\frac{25-k}{k+1} \\cdot 0.25.$$\n从以下开始\n$$P_{0} = 0.8^{25} \\approx 0.003776,$$\n$$P_{1} = P_{0} \\cdot 25 \\cdot 0.25 \\approx 0.0236,$$\n所以\n$$\\Pr(K \\leq 0) \\approx 0.003776  0.025,\\quad \\Pr(K \\leq 1) \\approx 0.003776 + 0.0236 = 0.0274 \\geq 0.025.$$\n因此 $k_{\\mathrm{L}}=1$，给出下界 $k_{\\mathrm{L}}/n = 1/25 = 0.04$。\n\n对于上尾部，继续计算累积和：\n$$P_{2} = 3 P_{1} \\approx 0.0708,\\ \\ P_{3} \\approx 0.1356,\\ \\ P_{4} \\approx 0.1865,\\ \\ P_{5} \\approx 0.1958,$$\n$$P_{6} \\approx 0.1631,\\ \\ P_{7} \\approx 0.1107,\\ \\ P_{8} \\approx 0.06227,\\ \\ P_{9} \\approx 0.02941.$$\n累积概率：\n$$\\Pr(K \\leq 8) \\approx 0.9521  0.975,\\quad \\Pr(K \\leq 9) \\approx 0.9815 \\geq 0.975.$$\n因此 $k_{\\mathrm{U}}=9$，给出上界 $k_{\\mathrm{U}}/n = 9/25 = 0.36$。\n\n因此，使用所述的自助法百分位数方法，中性突变真实比例的 $95\\%$ 置信区间为 $[0.04, 0.36]$。四舍五入到三位有效数字，结果为 $[0.0400, 0.360]$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.0400  0.360 \\end{pmatrix}}$$", "id": "1420152"}]}