{"hands_on_practices": [{"introduction": "在系统生物学中，从海量数据中重建网络的第一步往往是识别潜在的联系。当两个基因的表达水平同步变化时——即它们倾向于同时升高或降低——我们可能推断它们之间存在功能关联。这项练习将引导你使用皮尔逊相关系数（一种量化线性关系的统计工具）来分析一组假设的基因表达数据，这是在处理真实的转录组学数据时一项基础而关键的技能。[@problem_id:1462518]", "problem": "一位系统生物学家正在通过分析癌细胞对一种新治疗药物的反应，来研究一个潜在的基因调控网络。在五个独立的细胞培养样本中测量了四个关键基因（基因A、基因B、基因C和基因D）的表达水平，每个样本都用该药物处理了不同的时长。目标是识别出表达水平协同变化的基因对，这可能表明它们属于同一调控通路或受到共调控。归一化的表达数据如下：\n\n- 样本1：基因A = 2.0, 基因B = 5.0, 基因C = 1.1, 基因D = 3.0\n- 样本2：基因A = 3.0, 基因B = 4.0, 基因C = 1.6, 基因D = 1.0\n- 样本3：基因A = 5.0, 基因B = 2.0, 基因C = 2.4, 基因D = 2.0\n- 样本4：基因A = 4.0, 基因B = 3.0, 基因C = 2.1, 基因D = 4.0\n- 样本5：基因A = 6.0, 基因B = 1.0, 基因C = 3.3, 基因D = 5.0\n\n在系统生物学中，重建基因网络的常见第一步是计算所有可能基因对的表达谱之间的相关性。根据所提供的数据，计算所有基因对的皮尔逊相关系数。哪对基因表现出最强的正相关性？\n\nA. 基因A和基因B\n\nB. 基因A和基因C\n\nC. 基因A和基因D\n\nD. 基因B和基因C\n\nE. 基因B和基因D\n\nF. 基因C和基因D", "solution": "我们使用两个基因 $X$ 和 $Y$ 在 $n=5$ 个样本中的皮尔逊相关系数公式：\n$$\nr_{XY}=\\frac{\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)\\left(y_{i}-\\bar{y}\\right)}{\\sqrt{\\left(\\sum_{i=1}^{n}\\left(x_{i}-\\bar{x}\\right)^{2}\\right)\\left(\\sum_{i=1}^{n}\\left(y_{i}-\\bar{y}\\right)^{2}\\right)}},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值。\n\n数据向量：\n- $A=(2,3,5,4,6)$, $B=(5,4,2,3,1)$, $C=(1.1,1.6,2.4,2.1,3.3)$, $D=(3,1,2,4,5)$.\n\n均值：\n$$\n\\bar{A}=\\frac{2+3+5+4+6}{5}=4,\\quad \\bar{B}=\\frac{5+4+2+3+1}{5}=3,\\quad \\bar{C}=\\frac{10.5}{5}=2.1,\\quad \\bar{D}=\\frac{15}{5}=3.\n$$\n\n偏差：\n- $A-\\bar{A}=(-2,-1,1,0,2)$,\n- $B-\\bar{B}=(2,1,-1,0,-2)$,\n- $C-\\bar{C}=(-1.0,-0.5,0.3,0.0,1.2)$,\n- $D-\\bar{D}=(0,-2,-1,1,2)$.\n\n平方和：\n$$\nS_{A}=\\sum(A-\\bar{A})^{2}=10,\\quad S_{B}=10,\\quad S_{C}=1.0+0.25+0.09+0+1.44=2.78=\\frac{139}{50},\\quad S_{D}=10.\n$$\n\n每对的交叉乘积和：\n- $S_{AB}=\\sum(A-\\bar{A})(B-\\bar{B})=(-2)(2)+(-1)(1)+(1)(-1)+0\\cdot 0+(2)(-2)=-10$,\n- $S_{AC}=(-2)(-1.0)+(-1)(-0.5)+(1)(0.3)+0\\cdot 0+(2)(1.2)=5.2=\\frac{26}{5}$,\n- $S_{AD}=(-2)(0)+(-1)(-2)+(1)(-1)+0\\cdot 1+(2)(2)=5$,\n- $S_{BC}=(2)(-1.0)+(1)(-0.5)+(-1)(0.3)+0\\cdot 0+(-2)(1.2)=-5.2=-\\frac{26}{5}$,\n- $S_{BD}=(2)(0)+(1)(-2)+(-1)(-1)+0\\cdot 1+(-2)(2)=-5$,\n- $S_{CD}=(-1.0)(0)+(-0.5)(-2)+(0.3)(-1)+0\\cdot 1+(1.2)(2)=3.1=\\frac{31}{10}$.\n\n相关系数：\n$$\nr_{AB}=\\frac{-10}{\\sqrt{10\\cdot 10}}=-1,\n$$\n$$\nr_{AC}=\\frac{\\frac{26}{5}}{\\sqrt{10\\cdot \\frac{139}{50}}}=\\frac{\\frac{26}{5}}{\\sqrt{\\frac{139}{5}}}=\\frac{26\\sqrt{5}}{5\\sqrt{139}}\\approx 0.986,\n$$\n$$\nr_{AD}=\\frac{5}{\\sqrt{10\\cdot 10}}=\\frac{1}{2}=0.5,\n$$\n$$\nr_{BC}=-\\frac{26\\sqrt{5}}{5\\sqrt{139}}\\approx -0.986,\n$$\n$$\nr_{BD}=\\frac{-5}{\\sqrt{10\\cdot 10}}=-\\frac{1}{2}=-0.5,\n$$\n$$\nr_{CD}=\\frac{\\frac{31}{10}}{\\sqrt{\\frac{139}{5}}}=\\frac{31\\sqrt{5}}{10\\sqrt{139}}\\approx 0.588.\n$$\n\n在所有正相关中，$r_{AC}\\approx 0.986$ 是最大的。因此，具有最强正相关性的基因对是基因A和基因C。", "answer": "$$\\boxed{B}$$", "id": "1462518"}, {"introduction": "相关性虽然能揭示关联，但无法阐明调控的底层逻辑。为了更深入地理解基因调控，科学家们常常使用布尔网络模型，将基因的活动简化为“开启”或“关闭”状态。本练习模拟了一个逆向工程过程，你将根据实验观察到的输入（转录因子状态）和输出（基因表达状态），推导出控制基因表达的精确布尔逻辑规则。[@problem_id:1462564]", "problem": "在系统生物学中，一个常见的任务是从实验数据中反向工程基因调控网络。考虑这样一个网络的简化模型，其中单个基因（我们称之为基因`G`）的表达受两种不同转录因子（TF）（名为A和B）存在与否的控制。转录因子（TF）是一种蛋白质，它通过与特定的DNA序列结合，来调节遗传信息从DNA转录为信使RNA的速率。\n\n我们进行了一项实验，以确定控制基因`G`表达的逻辑。转录因子（TF）的状态和基因`G`的最终状态由二进制值表示：`1`表示转录因子存在且活跃，或基因被表达（开启）；而`0`表示转录因子不存在或不活跃，或基因未被表达（关闭）。\n\n实验观察结果如下：\n1.  当TF A不存在（`A=0`）且TF B不存在（`B=0`）时，基因`G`不表达（`G=0`）。\n2.  当TF A不存在（`A=0`）且TF B存在（`B=1`）时，基因`G`不表达（`G=0`）。\n3.  当TF A存在（`A=1`）且TF B不存在（`B=0`）时，基因`G`表达（`G=1`）。\n4.  当TF A存在（`A=1`）且TF B存在（`B=1`）时，基因`G`不表达（`G=0`）。\n\n你的任务是根据TF A和TF B的状态，确定以下哪个布尔逻辑规则正确地模拟了基因`G`的调控。在下面的选项中，$\\land$代表逻辑与运算符，$\\lor$代表逻辑或运算符，$\\lnot$代表逻辑非运算符，$\\oplus$代表逻辑异或（XOR）运算符。\n\nA. $A \\lor B$\n\nB. $A \\land B$\n\nC. $(\\lnot A) \\land B$\n\nD. $A \\land (\\lnot B)$\n\nE. $A \\oplus B$", "solution": "设 $A,B,G \\in \\{0,1\\}$。根据观察结果：\n- 对于 $(A,B)=(0,0)$，有 $G=0$。\n- 对于 $(A,B)=(0,1)$，有 $G=0$。\n- 对于 $(A,B)=(1,0)$，有 $G=1$。\n- 对于 $(A,B)=(1,1)$，有 $G=0$。\n\n使用规范的积之和（sum-of-products）范式构造，$G$ 是对应于 $G=1$ 的行的所有最小项的析取。在 $(A,B)=(1,0)$ 处恰好有一行满足此条件，其最小项是 $A \\land (\\lnot B)$。因此，\n$$\nG = A \\land (\\lnot B).\n$$\n现在对照选项进行验证：\n- 选项A: $A \\lor B$ 得出 $G(0,1)=1$，这与 $G=0$ 矛盾。\n- 选项B: $A \\land B$ 得出 $G(1,1)=1$，这与 $G=0$ 矛盾。\n- 选项C: $(\\lnot A) \\land B$ 得出 $G(0,1)=1$，这与 $G=0$ 矛盾。\n- 选项D: $A \\land (\\lnot B)$ 得出 $G(0,0)=0$，$G(0,1)=0$，$G(1,0)=1$，$G(1,1)=0$，与所有观察结果匹配。\n- 选项E: $A \\oplus B$ 得出 $G(0,1)=1$，这与 $G=0$ 矛盾。\n\n因此，正确的规则是 $A \\land (\\lnot B)$，即选项D。", "answer": "$$\\boxed{D}$$", "id": "1462564"}, {"introduction": "在现实研究中，不同的实验方法（如基因敲除、过表达分析）可能会对同一基因网络产生不一致甚至相互矛盾的结果。因此，整合来自多种来源的证据对于构建可靠的网络至关重要。本练习将介绍一种简单而有效的数据整合策略——“多数投票”法，你将通过合并来自三个不同虚拟实验的数据，构建一个仅包含被多重证据支持的相互作用的共识网络。[@problem_id:1462515]", "problem": "在计算系统生物学中，一个常见的任务是从多个高通量实验数据集中重建基因调控网络。不同的实验技术，如基因敲除、过表达研究和共表达分析，常常为成对的基因相互作用提供相互矛盾的证据。一种简单而有效的方法来协调这些差异是基于“多数投票”原则构建一个共识网络。\n\n考虑一组由字母A到L表示的12个基因。为了识别这些基因的相互作用对，进行了三种不同的实验。\n\n1.  一项**基因敲除 (KO)** 实验产生了一个推定的相互作用列表 `L_KO`。\n2.  一项**过表达 (OE)** 实验产生了一个列表 `L_OE`。\n3.  一项转录组学数据的**共表达 (CE)** 分析产生了第三个列表 `L_CE`。\n\n这些相互作用被表示为基因的无序对。为保持一致性，所有基因对都按字母顺序列出，例如，(A, B) 而不是 (B, A)。\n\n观察到的相互作用列表如下：\n\n-   `L_KO = { (A, B), (A, C), (B, D), (C, F), (F, H), (G, I), (H, J), (I, K) }`\n-   `L_OE = { (A, B), (B, D), (B, E), (E, F), (F, H), (G, I), (J, L), (K, L) }`\n-   `L_CE = { (A, B), (C, F), (D, G), (E, F), (F, H), (I, K), (K, L) }`\n\n您的任务是构建一个最终的共识网络。纳入的规则是：一个相互作用只有在三个实验列表 (`L_KO`, `L_OE`, `L_CE`) 中至少出现两次时，才会被保留在最终网络中。\n\n确定最终共识基因调控网络中相互作用（边）的总数。", "solution": "给定三个无序基因相互作用对的集合：\n$$L_{\\mathrm{KO}}=\\{(A,B),(A,C),(B,D),(C,F),(F,H),(G,I),(H,J),(I,K)\\},$$\n$$L_{\\mathrm{OE}}=\\{(A,B),(B,D),(B,E),(E,F),(F,H),(G,I),(J,L),(K,L)\\},$$\n$$L_{\\mathrm{CE}}=\\{(A,B),(C,F),(D,G),(E,F),(F,H),(I, K),(K,L)\\}.$$\n共识规则是，如果一个相互作用在三个列表中至少出现两次，则将其包括在内。对于任何基因对 $e$，定义计数\n$$c(e)=|\\{S\\in\\{L_{\\mathrm{KO}},L_{\\mathrm{OE}},L_{\\mathrm{CE}}\\}: e\\in S\\}|.$$\n我们计算三个列表并集中每个基因对的 $c(e)$ 值，并保留那些 $c(e)\\geq 2$ 的基因对。\n\n所有观察到的基因对的并集是\n$$\\{(A,B),(A,C),(B,D),(C,F),(F,H),(G,I),(H,J),(I,K),(B,E),(E,F),(J,L),(K,L),(D,G)\\}.$$\n现在统计出现次数：\n- $(A,B)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{OE}},L_{\\mathrm{CE}}$ 中，所以 $c((A,B))=3$。\n- $(A,C)$ 只出现在 $L_{\\mathrm{KO}}$ 中，所以 $c((A,C))=1$。\n- $(B,D)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{OE}}$ 中，所以 $c((B,D))=2$。\n- $(C,F)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{CE}}$ 中，所以 $c((C,F))=2$。\n- $(F,H)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{OE}},L_{\\mathrm{CE}}$ 中，所以 $c((F,H))=3$。\n- $(G,I)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{OE}}$ 中，所以 $c((G,I))=2$。\n- $(H,J)$ 只出现在 $L_{\\mathrm{KO}}$ 中，所以 $c((H,J))=1$。\n- $(I,K)$ 出现在 $L_{\\mathrm{KO}},L_{\\mathrm{CE}}$ 中，所以 $c((I,K))=2$。\n- $(B,E)$ 只出现在 $L_{\\mathrm{OE}}$ 中，所以 $c((B,E))=1$。\n- $(E,F)$ 出现在 $L_{\\mathrm{OE}},L_{\\mathrm{CE}}$ 中，所以 $c((E,F))=2$。\n- $(J,L)$ 只出现在 $L_{\\mathrm{OE}}$ 中，所以 $c((J,L))=1$。\n- $(K,L)$ 出现在 $L_{\\mathrm{OE}},L_{\\mathrm{CE}}$ 中，所以 $c((K,L))=2$。\n- $(D,G)$ 只出现在 $L_{\\mathrm{CE}}$ 中，所以 $c((D,G))=1$。\n\n保留那些 $c(e)\\geq 2$ 的基因对，得到共识边集\n$$\\{(A,B),(B,D),(C,F),(F,H),(G,I),(I,K),(E,F),(K,L)\\},$$\n其中包含 $8$ 个相互作用。\n\n因此，最终共识网络中的相互作用总数为 $8$。", "answer": "$$\\boxed{8}$$", "id": "1462515"}]}