{"hands_on_practices": [{"introduction": "MCMC的核心在于Metropolis-Hastings算法，它引导我们智能地探索参数空间。每一步，我们都会提出一个新的候选参数值，并通过计算“接受概率”来决定是移动到新值还是停留在当前值。这个概率直接反映了新参数值相对于当前值在解释观测数据方面的好坏程度。这个练习 [@problem_id:1444253] 将带你亲手计算一个关键的MCMC步骤，让你在一个简单的酶促反应模型中，深入理解算法的决策机制。", "problem": "一位系统生物学家正在研究一个简单的酶促反应，其中底物蛋白S被激酶磷酸化生成产物P。该反应被建模为一级动力学过程。在时间 $t$ 时，磷酸化产物 $[P](t)$ 的浓度由以下方程描述：\n$$[P](t) = [S]_0 (1 - \\exp(-kt))$$\n其中 $[S]_0$ 是底物S的初始浓度，$k$ 是磷酸化速率常数。该生物学家旨在使用贝叶斯推断方法，特别是Metropolis-Hastings马尔可夫链蒙特卡洛（MCMC）算法，从实验数据中估计 $k$ 的值。\n\n实验在初始底物浓度为 $[S]_0 = 1.0 \\, \\mu\\text{M}$ 的条件下进行。在三个不同的时间点测量了产物P的浓度，得到以下数据集：\n- 在 $t_1 = 1.0$ 分钟时，测得浓度为 $[P]_1 = 0.25 \\, \\mu\\text{M}$。\n- 在 $t_2 = 2.0$ 分钟时，测得浓度为 $[P]_2 = 0.45 \\, \\mu\\text{M}$。\n- 在 $t_3 = 5.0$ 分钟时，测得浓度为 $[P]_3 = 0.70 \\, \\mu\\text{M}$。\n\n假设测量误差是独立的，并且服从均值为零、已知标准差为 $\\sigma = 0.05 \\, \\mu\\text{M}$ 的高斯分布。对于贝叶斯分析，速率常数 $k$ 的先验分布选择为区间 $[0, 1.0 \\, \\text{min}^{-1}]$ 上的均匀分布。\n\n在MCMC模拟的一个步骤中，链的当前状态是 $k_{current} = 0.30 \\, \\text{min}^{-1}$。提出了一个新的候选状态 $k_{prop} = 0.35 \\, \\text{min}^{-1}$。计算此提议移动的Metropolis-Hastings接受概率 $\\alpha$。将您的最终答案四舍五入到三位有效数字。", "solution": "我们使用具有已知标准差 $\\sigma$ 的独立高斯误差来对观测值建模，因此给定 $k$ 的似然函数为\n$$\nL(k) = \\prod_{i=1}^{3} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\!\\left(-\\frac{\\left([P]_{i}-[P](t_{i};k)\\right)^{2}}{2\\sigma^{2}}\\right),\n$$\n其中 $[P](t;k) = [S]_{0}\\left(1-\\exp(-kt)\\right)$。$k$ 的先验分布是 $[0,1]$ 上的均匀分布，并且 $k_{current}=0.30$ 和 $k_{prop}=0.35$ 都在此区间内，因此先验比率为 $1$。假设提议分布是对称的（因此提议密度比为 $1$），则Metropolis-Hastings接受概率为\n$$\n\\alpha = \\min\\!\\left(1,\\frac{L(k_{prop})}{L(k_{current})}\\right)\n= \\min\\!\\left(1,\\exp\\!\\left(-\\frac{\\sum_{i=1}^{3}\\left(r_{prop,i}^{2}-r_{curr,i}^{2}\\right)}{2\\sigma^{2}}\\right)\\right),\n$$\n其中残差为 $r_{(\\cdot),i} = [P]_{i}-[P](t_{i};k_{(\\cdot)})$。\n\n使用 $[S]_{0}=1.0$，$\\sigma=0.05$，时间 $t_{1}=1.0$，$t_{2}=2.0$，$t_{3}=5.0$，以及观测值 $[P]_{1}=0.25$，$[P]_{2}=0.45$，$[P]_{3}=0.70$，计算模型预测值：\n- 对于 $k_{current}=0.30$：\n$$\n[P](1;0.30)=1-\\exp(-0.30)=0.2591817793,\\quad\n[P](2;0.30)=1-\\exp(-0.60)=0.4511883639,\\quad\n[P](5;0.30)=1-\\exp(-1.50)=0.7768698399.\n$$\n残差及其平方：\n$$\nr_{curr,1}=0.25-0.2591817793=-0.0091817793,\\quad r_{curr,1}^{2}\\approx 0.0000843051,\n$$\n$$\nr_{curr,2}=0.45-0.4511883639=-0.0011883639,\\quad r_{curr,2}^{2}\\approx 0.00000141221,\n$$\n$$\nr_{curr,3}=0.70-0.7768698399=-0.0768698399,\\quad r_{curr,3}^{2}\\approx 0.00590897229,\n$$\n所以\n$$\n\\mathrm{SSE}_{current}=\\sum r_{curr,i}^{2}\\approx 0.00599468957.\n$$\n\n- 对于 $k_{prop}=0.35$：\n$$\n[P](1;0.35)=1-\\exp(-0.35)=0.2953119103,\\quad\n[P](2;0.35)=1-\\exp(-0.70)=0.5034146962,\\quad\n[P](5;0.35)=1-\\exp(-1.75)=0.8262260565.\n$$\n残差及其平方：\n$$\nr_{prop,1}=0.25-0.2953119103=-0.0453119103,\\quad r_{prop,1}^{2}\\approx 0.00205316922,\n$$\n$$\nr_{prop,2}=0.45-0.5034146962=-0.0534146962,\\quad r_{prop,2}^{2}\\approx 0.00285312977,\n$$\n$$\nr_{prop,3}=0.70-0.8262260565=-0.1262260565,\\quad r_{prop,3}^{2}\\approx 0.01593301734,\n$$\n所以\n$$\n\\mathrm{SSE}_{prop}=\\sum r_{prop,i}^{2}\\approx 0.02083931633.\n$$\n\n因此\n$$\n\\Delta \\mathrm{SSE}=\\mathrm{SSE}_{prop}-\\mathrm{SSE}_{current}\\approx 0.01484462676,\\quad\n2\\sigma^{2}=2\\cdot(0.05)^{2}=0.005,\n$$\n似然比为\n$$\n\\frac{L(k_{prop})}{L(k_{current})}=\\exp\\!\\left(-\\frac{\\Delta \\mathrm{SSE}}{2\\sigma^{2}}\\right)\n=\\exp\\!\\left(-\\frac{0.01484462676}{0.005}\\right)=\\exp(-2.96892535)\\approx 0.0514.\n$$\n因此，\n$$\n\\alpha=\\min(1,0.0514)=0.0514,\n$$\n保留三位有效数字。", "answer": "$$\\boxed{0.0514}$$", "id": "1444253"}, {"introduction": "运行MCMC后，我们得到的是参数的后验分布，而不仅仅是单一的最优估计值。分析这些分布的结构至关重要，特别是参数之间的相关性，它可以揭示模型的辨识度问题。通过计算从后验分布中抽取的样本的相关系数，我们可以量化参数之间的线性关系。这个练习 [@problem_id:1444240] 将指导你如何通过计算皮尔逊相关系数来评估逻辑生长模型中两个关键参数（增长率$r$和环境容纳量$K$）之间的依赖关系。", "problem": "一位系统生物学家正在研究酵母培养物的生长动态。种群增长由逻辑斯谛方程建模：\n$$ \\frac{dN}{dt} = r N \\left(1 - \\frac{N}{K}\\right) $$\n其中 $N$ 是种群大小，$t$ 是时间，$r$ 是内禀增长率，$K$ 是环境承载能力。\n\n为了从实验数据中估计 $r$ 和 $K$ 的值，该生物学家使用马尔可夫链蒙特卡洛（MCMC）算法进行贝叶斯推断。这种计算技术从后验概率分布中生成一系列参数值（称为样本），该后验概率分布表示在观察数据后对参数的更新认知。分析 MCMC 输出的一个关键步骤是检查估计参数之间的相关性，因为强相关性可能表明模型是病态的，或者数据对于区分参数效应的信息量不足。\n\nMCMC 模拟为参数对 $(r, K)$ 产生了大量的样本。为了进行快速分析，该生物学家随机选择了其中的五个样本：\n\n- 样本1: ($r_1=0.55$, $K_1=980$)\n- 样本2: ($r_2=0.48$, $K_2=1050$)\n- 样本3: ($r_3=0.51$, $K_3=1010$)\n- 样本4: ($r_4=0.60$, $K_4=950$)\n- 样本5: ($r_5=0.45$, $K_5=1100$)\n\n$r$ 的单位是 小时$^{-1}$，$K$ 的单位是千个细胞。\n\n基于这个后验样本子集，计算增长率 $r$ 和环境承载能力 $K$ 之间的样本皮尔逊相关系数。该系数提供了两个参数之间线性关联的定量度量。最终答案应为一个无量纲数。将最终答案四舍五入到三位有效数字。", "solution": "目标是为给定的五对增长率 $r$ 和环境承载能力 $K$ 的样本计算样本皮尔逊相关系数 $\\rho_{r,K}$。对于一组 $n$ 个样本，两个变量 $x$ 和 $y$ 之间的样本皮尔逊相关系数的公式是：\n$$ \\rho_{x,y} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}} $$\n在我们的例子中，$x$ 对应于增长率 $r$，$y$ 对应于环境承载能力 $K$，样本数量为 $n=5$。\n\n首先，我们计算 $r$ 和 $K$ 的样本均值。\n给定的 $r$ 样本为 $\\{0.55, 0.48, 0.51, 0.60, 0.45\\}$。\n$r$ 的样本均值是：\n$$ \\bar{r} = \\frac{1}{5} \\sum_{i=1}^{5} r_i = \\frac{0.55 + 0.48 + 0.51 + 0.60 + 0.45}{5} = \\frac{2.59}{5} = 0.518 $$\n\n给定的 $K$ 样本为 $\\{980, 1050, 1010, 950, 1100\\}$。\n$K$ 的样本均值是：\n$$ \\bar{K} = \\frac{1}{5} \\sum_{i=1}^{5} K_i = \\frac{980 + 1050 + 1010 + 950 + 1100}{5} = \\frac{5090}{5} = 1018 $$\n\n接下来，我们计算每个样本与均值的偏差，即 $(r_i - \\bar{r})$ 和 $(K_i - \\bar{K})$。我们还将计算这些偏差的乘积以及这些偏差的平方。\n\n对于 $i=1$：\n$r_1 - \\bar{r} = 0.55 - 0.518 = 0.032$\n$K_1 - \\bar{K} = 980 - 1018 = -38$\n$(r_1 - \\bar{r})(K_1 - \\bar{K}) = (0.032)(-38) = -1.216$\n$(r_1 - \\bar{r})^2 = (0.032)^2 = 0.001024$\n$(K_1 - \\bar{K})^2 = (-38)^2 = 1444$\n\n对于 $i=2$：\n$r_2 - \\bar{r} = 0.48 - 0.518 = -0.038$\n$K_2 - \\bar{K} = 1050 - 1018 = 32$\n$(r_2 - \\bar{r})(K_2 - \\bar{K}) = (-0.038)(32) = -1.216$\n$(r_2 - \\bar{r})^2 = (-0.038)^2 = 0.001444$\n$(K_2 - \\bar{K})^2 = (32)^2 = 1024$\n\n对于 $i=3$：\n$r_3 - \\bar{r} = 0.51 - 0.518 = -0.008$\n$K_3 - \\bar{K} = 1010 - 1018 = -8$\n$(r_3 - \\bar{r})(K_3 - \\bar{K}) = (-0.008)(-8) = 0.064$\n$(r_3 - \\bar{r})^2 = (-0.008)^2 = 0.000064$\n$(K_3 - \\bar{K})^2 = (-8)^2 = 64$\n\n对于 $i=4$：\n$r_4 - \\bar{r} = 0.60 - 0.518 = 0.082$\n$K_4 - \\bar{K} = 950 - 1018 = -68$\n$(r_4 - \\bar{r})(K_4 - \\bar{K}) = (0.082)(-68) = -5.576$\n$(r_4 - \\bar{r})^2 = (0.082)^2 = 0.006724$\n$(K_4 - \\bar{K})^2 = (-68)^2 = 4624$\n\n对于 $i=5$：\n$r_5 - \\bar{r} = 0.45 - 0.518 = -0.068$\n$K_5 - \\bar{K} = 1100 - 1018 = 82$\n$(r_5 - \\bar{r})(K_5 - \\bar{K}) = (-0.068)(82) = -5.576$\n$(r_5 - \\bar{r})^2 = (-0.068)^2 = 0.004624$\n$(K_5 - \\bar{K})^2 = (82)^2 = 6724$\n\n现在，我们将这些量相加。\n相关系数的分子是偏差乘积之和：\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})(K_i - \\bar{K}) = -1.216 - 1.216 + 0.064 - 5.576 - 5.576 = -13.52 $$\n\n分母中的项是偏差平方之和：\n$$ \\sum_{i=1}^{5} (r_i - \\bar{r})^2 = 0.001024 + 0.001444 + 0.000064 + 0.006724 + 0.004624 = 0.01388 $$\n$$ \\sum_{i=1}^{5} (K_i - \\bar{K})^2 = 1444 + 1024 + 64 + 4624 + 6724 = 13880 $$\n\n现在，将这些总和代入相关系数公式中：\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{0.01388 \\times 13880}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{\\sqrt{192.6544}} $$\n$$ \\rho_{r,K} = \\frac{-13.52}{13.8800144} \\approx -0.97406243... $$\n\n将结果四舍五入到三位有效数字，我们得到 -0.974。强的负相关性表明，在此模型和数据下，较高的增长率 $r$ 估计值与较低的环境承载能力 $K$ 估计值相关联，反之亦然。", "answer": "$$\\boxed{-0.974}$$", "id": "1444240"}, {"introduction": "参数推断并非建模的终点；我们还必须检验模型本身是否能够很好地描述我们研究的生物系统。后验预测检验是一种强大的模型批判方法，它通过使用从后验分布中抽取的参数来模拟新的数据集，并将其与我们的真实观测数据进行比较。这个练习 [@problem_id:1444232] 让你执行一个简化的后验预测检验，以评估经典的逻辑斯蒂增长模型是否足以捕捉观察到的细菌生长动态。", "problem": "一位系统生物学家正在研究一个细菌培养物的生长动态。假设种群大小 $N(t)$（以千个细胞为单位）遵循逻辑斯谛增长模型。逻辑斯谛微分方程的解析解由下式给出：\n$$N(t) = \\frac{K N_0}{N_0 + (K - N_0) \\exp(-rt)}$$\n其中，$t$ 是时间（单位为小时），$N_0$ 是初始种群大小，$r$ 是内禀增长率（单位为 $\\text{hour}^{-1}$），$K$ 是环境承载力（单位为千个细胞）。\n\n实验从 $N_0 = 10$ 千个细胞的初始种群开始。在几个时间点测量了种群大小，得到以下实验数据：\n\n| 时间, $t$ (小时) | 种群数量, $N(t)$ (千个细胞) |\n|:-------------------:|:---------------------------------------:|\n| 10                  | 70                                      |\n| 20                  | 260                                     |\n| 30                  | 510                                     |\n| 40                  | 580                                     |\n\n为了推断模型参数 $r$ 和 $K$，该生物学家使用马尔可夫链蒙特卡洛（MCMC）算法进行了贝叶斯分析。这个过程生成了一个后验分布，表示给定数据下 $r$ 和 $K$ 的可能值。以下是从该MCMC后验分布中抽取的三个代表性样本：\n\n*   样本 1：$(r_1, K_1) = (0.19 \\text{ hour}^{-1}, 610 \\text{ 千个细胞})$\n*   样本 2：$(r_2, K_2) = (0.21 \\text{ hour}^{-1}, 590 \\text{ 千个细胞})$\n*   样本 3：$(r_3, K_3) = (0.22 \\text{ hour}^{-1}, 580 \\text{ 千个细胞})$\n\n您的任务是进行后验预测检验。这包括使用来自后验分布的参数样本来模拟新的生长曲线，并将它们与原始实验数据进行比较。根据您的分析，下列哪个陈述最准确地评估了逻辑斯谛增长模型对该数据集的充分性？\n\nA. 该模型拟合良好。观测到的数据点系统地落在从后验分布模拟的轨迹范围内。这表明模型足够灵活以解释数据，并且推断出的参数与观测结果一致。\n\nB. 该模型存在系统性偏差，因此拟合效果不佳。例如，在 $t=20$ 小时，所有模拟轨迹预测的种群大小都大于观测数据点260。这种持续的差异表明模型无法完全复制观测到的动态。\n\nC. 该模型过拟合数据。样本1的轨迹几乎完美匹配数据点的事实表明，MCMC过程找到了一个单一的“最佳”解，而忽略了系统中的真实不确定性。\n\nD. 后验参数样本变化太大，使得模型不具预测性。模拟轨迹的广泛分布表明，参数 $r$ 和 $K$ 没有被数据很好地约束，因此该模型不能用于可靠的预测。", "solution": "我们已知逻辑斯谛解\n$$\nN(t)=\\frac{K N_{0}}{N_{0}+(K-N_{0})\\exp(-r t)},\n$$\n其中 $N_{0}=10$。对于每个后验样本 $(r_{i},K_{i})$，定义预测轨迹\n$$\nN_{i}(t)=\\frac{K_{i} N_{0}}{N_{0}+(K_{i}-N_{0})\\exp(-r_{i} t)}.\n$$\n我们将计算 $t\\in\\{10,20,30,40\\}$ 时的 $N_{i}(t)$，并与观测数据 $\\{70,260,510,580\\}$ 进行比较。\n\n样本 1：$(r_{1},K_{1})=(0.19,610)$。\n这里 $K_{1}-N_{0}=600$ 且 $K_{1}N_{0}=6100$，所以\n$$\nN_{1}(t)=\\frac{6100}{10+600\\exp(-0.19 t)}.\n$$\n- 在 $t=10$ 时：$\\exp(-0.19\\cdot 10)=\\exp(-1.9)\\approx 0.149568$，分母 $\\approx 10+600\\cdot 0.149568=99.7408$，因此 $N_{1}(10)\\approx 6100/99.7408\\approx 61.1$。\n- 在 $t=20$ 时：$\\exp(-3.8)\\approx 0.022371$，分母 $\\approx 10+600\\cdot 0.022371=23.4226$，因此 $N_{1}(20)\\approx 6100/23.4226\\approx 260.3$。\n- 在 $t=30$ 时：$\\exp(-5.7)\\approx 0.003331$，分母 $\\approx 10+600\\cdot 0.003331=11.9986$，因此 $N_{1}(30)\\approx 6100/11.9986\\approx 508.4$。\n- 在 $t=40$ 时：$\\exp(-7.6)\\approx 0.000498$，分母 $\\approx 10+600\\cdot 0.000498=10.2988$，因此 $N_{1}(40)\\approx 6100/10.2988\\approx 592.8$。\n\n样本 2：$(r_{2},K_{2})=(0.21,590)$。\n这里 $K_{2}-N_{0}=580$ 且 $K_{2}N_{0}=5900$，所以\n$$\nN_{2}(t)=\\frac{5900}{10+580\\exp(-0.21 t)}.\n$$\n- 在 $t=10$ 时：$\\exp(-2.1)\\approx 0.122456$，分母 $\\approx 10+580\\cdot 0.122456=81.024$，因此 $N_{2}(10)\\approx 5900/81.024\\approx 72.8$。\n- 在 $t=20$ 时：$\\exp(-4.2)\\approx 0.014996$，分母 $\\approx 10+580\\cdot 0.014996=18.6977$，因此 $N_{2}(20)\\approx 5900/18.6977\\approx 315.6$。\n- 在 $t=30$ 时：$\\exp(-6.3)\\approx 0.001829$，分母 $\\approx 10+580\\cdot 0.001829=11.0608$，因此 $N_{2}(30)\\approx 5900/11.0608\\approx 533.5$。\n- 在 $t=40$ 时：$\\exp(-8.4)\\approx 0.000225$，分母 $\\approx 10+580\\cdot 0.000225=10.1305$，因此 $N_{2}(40)\\approx 5900/10.1305\\approx 582.3$。\n\n样本 3：$(r_{3},K_{3})=(0.22,580)$。\n这里 $K_{3}-N_{0}=570$ 且 $K_{3}N_{0}=5800$，所以\n$$\nN_{3}(t)=\\frac{5800}{10+570\\exp(-0.22 t)}.\n$$\n- 在 $t=10$ 时：$\\exp(-2.2)\\approx 0.110803$，分母 $\\approx 10+570\\cdot 0.110803=73.1577$，因此 $N_{3}(10)\\approx 5800/73.1577\\approx 79.3$。\n- 在 $t=20$ 时：$\\exp(-4.4)\\approx 0.012277$，分母 $\\approx 10+570\\cdot 0.012277=17.000$，因此 $N_{3}(20)\\approx 5800/17.000\\approx 341.2$。\n- 在 $t=30$ 时：$\\exp(-6.6)\\approx 0.001365$，分母 $\\approx 10+570\\cdot 0.001365=10.778$，因此 $N_{3}(30)\\approx 5800/10.778\\approx 538.1$。\n- 在 $t=40$ 时：$\\exp(-8.8)\\approx 0.000151$，分母 $\\approx 10+570\\cdot 0.000151=10.0859$，因此 $N_{3}(40)\\approx 5800/10.0859\\approx 575.1$。\n\n与在 $(10,20,30,40)$ 小时的观测数据 $(70,260,510,580)$ 进行比较：\n- 在 $t=10$ 时：预测值约为 $61.1$、$72.8$、$79.3$；观测值 $70$ 在此范围内。\n- 在 $t=20$ 时：预测值约为 $260.3$、$315.6$、$341.2$；观测值 $260$ 位于下边缘，实际上在此范围内。\n- 在 $t=30$ 时：预测值约为 $508.4$、$533.5$、$538.1$；观测值 $510$ 在此范围内。\n- 在 $t=40$ 时：预测值约为 $592.8$、$582.3$、$575.1$；观测值 $580$ 在此范围内。\n\n因此，基于所提供样本的后验预测轨迹形成了一个包络，其中包含了所有时间点的观测数据。这支持了逻辑斯谛模型是充分的，并且在没有系统性偏差、没有过拟合，且后验分布被合理约束的情况下捕捉了观测到的动态的结论。在给定的陈述中，这对应于选项A。", "answer": "$$\\boxed{A}$$", "id": "1444232"}]}