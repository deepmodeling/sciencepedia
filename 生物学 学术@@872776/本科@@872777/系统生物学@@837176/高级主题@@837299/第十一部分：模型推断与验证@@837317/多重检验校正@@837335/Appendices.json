{"hands_on_practices": [{"introduction": "在进行大规模数据分析时，一个常见的陷阱是在众多检验中“挑选”出显著结果。这个练习将通过一个思想实验揭示，即使没有任何真实的生物学效应，仅凭偶然性，我们也能够预期在基因子集中发现“显著”的结果。通过这个计算，你将直观地理解为何多重检验校正是不可或缺的，以避免被随机噪音误导 [@problem_id:1450327]。", "problem": "一位生物信息学家利用核糖核酸（RNA）测序实验的数据，进行了一项差异基因表达分析，以比较处理样本和对照样本。该分析覆盖了整个小鼠基因组，共包含 $N_{total} = 22,000$ 个基因。对每个单个基因的假设检验，使用了 $\\alpha = 0.05$ 的标准显著性阈值。在对结果进行初步调查后，该研究人员决定关注一个预先定义的、已知参与代谢途径的基因集，该基因集包含 $N_{subset} = 800$ 个基因。在这个子集中，研究人员报告称发现了 $k = 45$ 个基因的未经校正的p值小于阈值 $\\alpha = 0.05$。\n\n为了严格评估这一发现，我们想确定仅凭随机机会所预期的结果。假设处理对任何基因都没有实际影响（即，对于所有22,000个基因，无差异表达的原假设都为真），那么在代谢途径子集中，p值小于0.05的基因的期望数量是多少？\n\nA. 0.05\n\nB. 1\n\nC. 40\n\nD. 45\n\nE. 1100", "solution": "假设对于所有基因，原假设都为真，因此每个基因的p值在区间 $[0,1]$ 上服从均匀分布。对于一个固定的显著性阈值 $\\alpha$，单个基因的p值满足 $p  \\alpha$ 的概率是 $\\alpha$。\n\n为代谢子集中的 $N_{subset}$ 个基因定义指示变量：对于基因 $i$，如果其p值小于 $\\alpha$，则令 $X_{i}=1$，否则令 $X_{i}=0$。在原假设下，对于每个 $i$，有 $P(X_{i}=1)=\\alpha$，因此 $\\mathbb{E}[X_{i}]=\\alpha$。\n\n令 $S=\\sum_{i=1}^{N_{subset}} X_{i}$ 为子集中p值满足 $p  \\alpha$ 的基因总数。根据期望的线性性质，\n$$\n\\mathbb{E}[S]=\\sum_{i=1}^{N_{subset}} \\mathbb{E}[X_{i}]=N_{subset}\\,\\alpha.\n$$\n将 $N_{subset}=800$ 和 $\\alpha=0.05$ 代入可得\n$$\n\\mathbb{E}[S]=800 \\times 0.05=40.\n$$\n这对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1450327"}, {"introduction": "理解了多重检验的必要性之后，我们来学习第一种防御方法：Bonferroni校正。这种方法旨在严格控制“家族错误率”（Family-Wise Error Rate, FWER），即在所有检验中至少出现一个假阳性的概率。这个练习将带你将这个概念付诸实践，计算在高通量蛋白质组学研究中如何调整显著性阈值以保持统计严谨性 [@problem_id:1450318]。", "problem": "一个药理学家团队正在研究细胞对一种新开发的抗癌药物的反应。他们使用质谱法进行了一项大规模定量蛋白质组学实验，以比较接受药物治疗的癌细胞与未经处理的对照组细胞中的蛋白质表达水平。该实验同时测量了5000种不同蛋白质的丰度。\n\n对于每种蛋白质，都进行了一项统计检验，以确定其表达水平是否因药物治疗而发生显著改变。该团队希望在所有5000次检验中控制至少出现一次错误发现（I型错误）的概率。他们决定将严格的总体错误率（FWER）维持在0.05。为此，他们将使用Bonferroni校正来调整每个单独蛋白质检验的显著性阈值。\n\n计算必须用于5000个单独统计检验中的每一个的新显著性阈值（通常记为$\\alpha'$）。将您的答案以科学记数法表示，并保留两位有效数字。", "solution": "我们希望在$m=5000$个独立的假设检验中，将总体错误率（FWER）控制在$\\alpha=0.05$的水平。使用Bonferroni校正，我们设定单次检验的显著性阈值$\\alpha'$，使得并集界保证$m\\alpha' \\leq \\alpha$。因此，经过Bonferroni校正的阈值为\n$$\n\\alpha'=\\frac{\\alpha}{m}.\n$$\n代入$\\alpha=0.05$和$m=5000$，\n$$\n\\alpha'=\\frac{0.05}{5000}=\\frac{5\\times 10^{-2}}{5\\times 10^{3}}=\\left(\\frac{5}{5}\\right)\\times 10^{-2-3}=1\\times 10^{-5}.\n$$\n用科学记数法表示并保留两位有效数字，得到\n$$\n\\alpha' = 1.0 \\times 10^{-5}.\n$$", "answer": "$$\\boxed{1.0 \\times 10^{-5}}$$", "id": "1450318"}, {"introduction": "虽然Bonferroni校正很严格，但有时可能过于保守，导致我们错过一些真实的发现。Benjamini-Hochberg (BH) 程序提供了一种更强大、更现代的替代方案，它控制的是“错误发现率”（False Discovery Rate, FDR），即在所有声称的发现中假阳性所占的预期比例。通过这个练习，你将一步步地应用BH程序，学习如何在保持统计可靠性的同时，提高发现潜在真实效应的能力 [@problem_id:1450361]。", "problem": "一位系统生物学家正在进行一项代谢组学实验，以确定在新药物治疗下代谢物浓度的变化。对五个不同的关键代谢物，在比较了治疗组和对照组后，进行了统计检验，得到了以下p值：0.005、0.02、0.06、0.07 和 0.5。\n\n为了解决多重假设检验的问题，该生物学家决定使用 Benjamini-Hochberg 程序来控制错误发现率 (FDR)。期望的FDR被设定为25% (即 $Q = 0.25$)。\n\n根据 Benjamini-Hochberg 程序，以下哪一组代表了所有被认为具有统计显著性的p值？\n\nA. 0.005\n\nB. 0.005, 0.02\n\nC. 0.005, 0.02, 0.06\n\nD. 0.005, 0.02, 0.06, 0.07\n\nE. 0.005, 0.02, 0.06, 0.07, 0.5", "solution": "我们应用 Benjamini-Hochberg (BH) 程序。设假设数量为 $m=5$，目标错误发现率为 $Q=0.25$，将p值按升序排列为\n$$\np_{(1)}=0.005,\\quad p_{(2)}=0.02,\\quad p_{(3)}=0.06,\\quad p_{(4)}=0.07,\\quad p_{(5)}=0.5.\n$$\nBH 临界值为\n$$\nc_{i}=\\frac{i}{m}Q,\\quad i=1,2,3,4,5.\n$$\n当 $m=5$ 且 $Q=0.25$ 时，这些临界值为\n$$\nc_{1}=0.05,\\quad c_{2}=0.1,\\quad c_{3}=0.15,\\quad c_{4}=0.2,\\quad c_{5}=0.25.\n$$\n我们寻找满足 $p_{(k)} \\le c_k$ 的最大索引 $k$。逐一检查：\n$$\np_{(1)}=0.005\\leq 0.05,\\quad p_{(2)}=0.02\\leq 0.1,\\quad p_{(3)}=0.06\\leq 0.15,\\quad p_{(4)}=0.07\\leq 0.2,\\quad p_{(5)}=0.5\\nleq 0.25.\n$$\n因此，满足条件的最大索引是 $k=4$，所以显著的p值是 $0.005,\\,0.02,\\,0.06,\\,0.07$，对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "1450361"}]}