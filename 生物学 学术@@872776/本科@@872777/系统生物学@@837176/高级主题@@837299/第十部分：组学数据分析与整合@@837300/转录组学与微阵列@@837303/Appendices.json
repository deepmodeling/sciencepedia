{"hands_on_practices": [{"introduction": "基因表达的变化是转录组学分析的核心。为了量化这些变化，研究人员通常使用对数倍数变化（log fold-change），特别是以2为底的对数（$log_2$ fold-change）。该指标不仅能对称地表示上调和下调的基因，还有利于后续的统计分析。这项练习将帮助你掌握这个关键指标的计算和解读方法。[@problem_id:1476365]", "problem": "在一次使用DNA微阵列的转录组学研究中，一位生物学家调查了一种新型药物对癌细胞系基因表达的影响。该实验将药物处理过的细胞（实验条件）中的基因表达与未处理的细胞（对照条件）中的表达进行比较。经过杂交和扫描后，标准化的荧光强度被用作每个基因表达水平的代表指标。\n\n对于一个特定的目标基因 *Oncostatin M (OSM)*，在对照样本中测得的标准化强度为6400任意荧光单位。在经过药物处理的实验样本中，*OSM* 的标准化强度为800任意荧光单位。\n\n量化表达变化的标准方法是log2倍数变化，其定义为实验条件下的表达水平与对照条件下表达水平之比，再取以2为底的对数。\n\n根据这些数据，以下哪个陈述最准确地描述了 *OSM* 基因的表达变化？\n\nA. 该基因被下调，其在药物处理样本中的表达水平比对照样本低3倍。\n\nB. 该基因被下调，其在药物处理样本中的表达水平是对照样本水平的八分之一。\n\nC. 该基因被上调，其在药物处理样本中的表达水平比对照样本高8倍。\n\nD. 该基因被下调了8倍，意味着其表达减少了800%。\n\nE. log2倍数变化为3，表明该基因显著上调。", "solution": "目标是计算基因 *OSM* 的log2倍数变化，并解释其含义以选择正确的陈述。\n\n设 $I_{exp}$ 为实验（药物处理）样本中的表达水平（强度），$I_{ctrl}$ 为对照（未处理）样本中的表达水平。\n根据题干，我们有：\n$I_{exp} = 800$ 任意荧光单位\n$I_{ctrl} = 6400$ 任意荧光单位\n\nlog2倍数变化 (Log2 FC) 定义为：\n$$ \\text{Log2 FC} = \\log_{2}\\left(\\frac{I_{exp}}{I_{ctrl}}\\right) $$\n\n首先，我们计算实验强度与对照强度的比率：\n$$ \\text{Ratio} = \\frac{I_{exp}}{I_{ctrl}} = \\frac{800}{6400} = \\frac{8}{64} = \\frac{1}{8} $$\n\n现在，我们可以通过取该比率以2为底的对数来计算log2倍数变化：\n$$ \\text{Log2 FC} = \\log_{2}\\left(\\frac{1}{8}\\right) $$\n\n为了简化，我们可以将 $\\frac{1}{8}$ 表示为2的幂。因为 $8 = 2^3$，我们有 $\\frac{1}{8} = \\frac{1}{2^3} = 2^{-3}$。\n将此代回方程：\n$$ \\text{Log2 FC} = \\log_{2}(2^{-3}) $$\n\n使用对数性质 $\\log_{b}(b^{x}) = x$，我们得到：\n$$ \\text{Log2 FC} = -3 $$\n\n现在我们必须解释这个结果。\n负的Log2 FC值表示该基因在实验条件下的表达低于对照条件；这被称为下调。\n正的Log2 FC值将表示上调。\nLog2 FC为0将表示表达没有变化。\n\n变化的幅度由Log2 FC的绝对值决定。线性倍数变化为 $2^{|\\text{Log2 FC}|}$。在本例中，线性倍数变化为 $2^{|-3|} = 2^{3} = 8$。\n由于Log2 FC是负数，这意味着该基因被下调了8倍。换句话说，药物处理样本中的表达水平是对照样本中表达水平的 $\\frac{1}{8}$，这与我们最初的比率计算相符。\n\n让我们评估给出的选项：\nA. 该基因被下调，其在药物处理样本中的表达水平比对照样本低3倍。这是不正确的。它混淆了log2倍数变化值(-3)和线性倍数变化(8)。减少3倍意味着表达是对照的1/3，而不是1/8。\nB. 该基因被下调，其在药物处理样本中的表达水平是对照样本水平的八分之一。这是正确的。该基因被下调（负的log倍数变化），且表达比率为 $I_{exp}/I_{ctrl} = 1/8$。\nC. 该基因被上调，其在药物处理样本中的表达水平比对照样本高8倍。这是不正确的。它正确地识别了倍数变化的幅度(8)，但错误地解释了符号。负的log倍数变化意味着下调，而不是上调。\nD. 该基因被下调了8倍，意味着其表达减少了800%。这是不正确的。减少8倍意味着新水平是原始水平的 $1/8$。减少100%意味着表达变为0。在这种情况下，减少800%在数学上是没有意义的，因为你不能将一个值减少超过其自身100%的量。陈述百分比变化的正确方式是减少 $(1 - 1/8) \\times 100\\% = 87.5\\%$。\nE. log2倍数变化为3，表明该基因显著上调。这是不正确的。计算出的Log2 FC是-3，而不是3。\n\n因此，唯一准确描述基因表达变化的陈述是B。", "answer": "$$\\boxed{B}$$", "id": "1476365"}, {"introduction": "微阵列数据并非生物现实的完美写照，它常常受到各种技术因素的干扰。这个练习揭示了一个典型的技术假象：当探针结合区域恰好存在单核苷酸多态性（SNP）时，不同等位基因的杂交效率差异会造成基因表达水平的虚假信号。通过这个练习，你将把分子生物学、物理化学和数据分析联系起来，学会如何量化这种由探针亲和力差异导致的测量偏差。[@problem_id:1476331]", "problem": "一位生物学家正在分析微阵列数据，以识别表达数量性状基因座 (eQTLs)，这是一种影响基因表达水平的遗传变异。对于一个特定基因，分析显示其表观表达水平与一个单核苷酸多态性 (SNP) 的基因型之间存在强关联。基因型为 GG 的个体一致地显示出比基因型为 AA 的个体更低的微阵列信号。\n\n经过更仔细的检查，发现用于测量该基因表达的微阵列探针与信使RNA (mRNA) 上一个包含该SNP位点本身的区域发生杂交。该探针序列与'A'等位基因产生的转录本完美匹配，但与'G'等位基因产生的转录本形成错配。\n\n假设该基因的真实生物学表达水平实际上对所有基因型都是相同的，并且观测到的信号差异纯粹是由探针结合亲和力差异引起的技术假象。你的任务是量化这一假象。\n\n计算表观表达倍数变化，即GG基因型与AA基因型测得的荧光强度之比 ($I_{GG} / I_{AA}$)。\n\n**给定参数：**\n- 与完美匹配的'A'等位基因转录本相比，探针与错配的'G'等位基因转录本结合的标准Gibbs自由能罚分为 $\\Delta\\Delta G^\\circ_{\\text{MM}} = +6.20 \\text{ kJ/mol}$。\n- 微阵列杂交在 $T = 318.15 \\text{ K}$ 的恒定温度下进行。\n- 普适气体常数为 $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。\n\n**说明：**\n- 假设测量的荧光强度与热力学平衡时与探针结合的mRNA量成正比。\n- 微阵列芯片点上的探针浓度是饱和的，这意味着与目标mRNA的浓度相比，探针是大量过量的。\n- 计算比率 $I_{GG} / I_{AA}$ 的数值。\n- 将最终答案四舍五入至三位有效数字。", "solution": "问题要求计算表观表达水平的比率 $I_{GG} / I_{AA}$，即两种纯合基因型测得的荧光强度之比。问题的核心在于将测量的强度与探针-mRNA结合的热力学联系起来。\n\n首先，我们为测量的强度建立一个模型。问题陈述强度 $I$ 与结合到探针上的mRNA量成正比。结合的mRNA量，即探针-mRNA复合物的浓度，由结合平衡决定：\n$$ \\text{Probe} + \\text{mRNA} \\rightleftharpoons \\text{Probe-mRNA Complex} $$\n此反应的结合常数由下式给出：\n$$ K_a = \\frac{[\\text{Complex}]}{[\\text{Probe}]_{\\text{free}} [\\text{mRNA}]_{\\text{free}}} $$\n问题陈述探针浓度是饱和的，这意味着它是大量过量的。这允许一个关键的简化：游离探针的浓度约等于总探针浓度，$[\\text{Probe}]_{\\text{free}} \\approx [\\text{Probe}]_{\\text{total}}$，对于一个给定的微阵列芯片点来说，这是一个常数。此外，由于探针过量，只有一小部分总mRNA会结合在复合物中。因此，我们也可以将游离mRNA的浓度近似为总mRNA浓度，即 $[\\text{mRNA}]_{\\text{free}} \\approx [\\text{mRNA}]_{\\text{total}}$。\n\n有了这些简化，复合物的浓度为：\n$$ [\\text{Complex}] \\approx K_a \\cdot [\\text{Probe}]_{\\text{total}} \\cdot [\\text{mRNA}]_{\\text{total}} $$\n总mRNA浓度 $[\\text{mRNA}]_{\\text{total}}$ 与基因的真实生物学表达水平成正比，我们将其记为 $E$。所以，$[\\text{mRNA}]_{\\text{total}} = k'E$，其中 $k'$ 是某个比例常数。\n测量的强度 $I$ 与 $[\\text{Complex}]$ 成正比。因此，我们可以写出：\n$$ I \\propto [\\text{Complex}] \\approx K_a \\cdot ([\\text{Probe}]_{\\text{total}} \\cdot k') \\cdot E $$\n将所有常数合并成一个单一的比例常数 $C$，我们得到测量强度、结合亲和力和真实表达之间的简单关系：\n$$ I = C \\cdot K_a \\cdot E $$\n问题陈述真实表达水平 $E$ 对所有基因型都是相同的。强度的差异源于结合亲和力 $K_a$ 的差异。\n\n设 $K_{\\text{PM}}$ 为完美匹配（探针与'A'等位基因的mRNA结合）的结合常数，而 $K_{\\text{MM}}$ 为错配（探针与'G'等位基因的mRNA结合）的结合常数。\n\n对于基因型为AA的个体，所有转录本都是'A'型。其强度为：\n$$ I_{AA} = C \\cdot K_{\\text{PM}} \\cdot E $$\n对于基因型为GG的个体，所有转录本都是'G'型。其强度为：\n$$ I_{GG} = C \\cdot K_{\\text{MM}} \\cdot E $$\n表观表达倍数变化是这些强度的比率：\n$$ \\frac{I_{GG}}{I_{AA}} = \\frac{C \\cdot K_{\\text{MM}} \\cdot E}{C \\cdot K_{\\text{PM}} \\cdot E} = \\frac{K_{\\text{MM}}}{K_{\\text{PM}}} $$\n现在，我们必须将结合常数与给定的热力学数据联系起来。反应的标准Gibbs自由能 $\\Delta G^\\circ$ 与其平衡常数 $K_a$ 之间的关系是：\n$$ \\Delta G^\\circ = -RT \\ln(K_a) \\implies K_a = \\exp\\left(-\\frac{\\Delta G^\\circ}{RT}\\right) $$\n设 $\\Delta G^\\circ_{\\text{PM}}$ 为完美匹配结合的标准Gibbs自由能。问题给出了错配罚分 $\\Delta\\Delta G^\\circ_{\\text{MM}}$，这是错配情况下的额外自由能。正的罚分表示一个较不利（较不自发）的反应。\n$$ \\Delta G^\\circ_{\\text{MM}} = \\Delta G^\\circ_{\\text{PM}} + \\Delta\\Delta G^\\circ_{\\text{MM}} $$\n现在我们可以用这些自由能来表示结合常数的比率：\n$$ \\frac{K_{\\text{MM}}}{K_{\\text{PM}}} = \\frac{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{MM}}}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{PM}}}{RT}\\right)} = \\frac{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{PM}} + \\Delta\\Delta G^\\circ_{\\text{MM}}}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{PM}}}{RT}\\right)} $$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以简化表达式：\n$$ \\frac{K_{\\text{MM}}}{K_{\\text{PM}}} = \\frac{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{PM}}}{RT}\\right) \\exp\\left(-\\frac{\\Delta\\Delta G^\\circ_{\\text{MM}}}{RT}\\right)}{\\exp\\left(-\\frac{\\Delta G^\\circ_{\\text{PM}}}{RT}\\right)} = \\exp\\left(-\\frac{\\Delta\\Delta G^\\circ_{\\text{MM}}}{RT}\\right) $$\n所以，表观倍数变化仅由错配罚分和温度决定。现在我们代入给定的数值。确保单位一致是至关重要的。能量单位必须是焦耳，以匹配气体常数 $R$ 的单位。\n\n给定：\n$\\Delta\\Delta G^\\circ_{\\text{MM}} = +6.20 \\text{ kJ/mol} = 6200 \\text{ J/mol}$\n$R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n$T = 318.15 \\text{ K}$\n\n首先，计算指数的值：\n$$ -\\frac{\\Delta\\Delta G^\\circ_{\\text{MM}}}{RT} = -\\frac{6200 \\text{ J/mol}}{(8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}) \\cdot (318.15 \\text{ K})} $$\n$$ -\\frac{\\Delta\\Delta G^\\circ_{\\text{MM}}}{RT} = -\\frac{6200}{2645.2041} \\approx -2.34386 $$\n现在计算最终的比率：\n$$ \\frac{I_{GG}}{I_{AA}} = \\exp(-2.34386) \\approx 0.095965 $$\n问题要求答案四舍五入到三位有效数字。\n$$ \\frac{I_{GG}}{I_{AA}} \\approx 0.0960 $$\n这意味着GG基因型的信号仅为AA基因型信号的约9.6%，从而造成了GG个体中该基因被强烈下调的假象，而实际上这只是一个测量假象。", "answer": "$$\\boxed{0.0960}$$", "id": "1476331"}, {"introduction": "在理解了特定的技术假象之后，我们将视野拓宽到整个数据预处理流程。为什么不能简单地对原始荧光强度值取平均？这项练习将深入探讨像RMA这样的高级算法背后的原理，解释背景校正、标准化和探针效应建模为何至关重要。掌握这些概念是准确分析和解读任何微阵列数据的基础。[@problem_id:1476338]", "problem": "在转录组学领域，一种能同时测量数千个基因表达水平的常用工具是 Affymetrix GeneChip 基因芯片。对于每个基因，芯片上都有一个“探针组”（probeset），由11到20个不同的、长度为25个碱基对的寡核苷酸序列组成，这些序列被称为探针。每个探针被设计用来与目标基因转录出的信使核糖核酸（mRNA）的特定片段结合。在与来自生物样本的荧光标记mRNA进行杂交后，对芯片进行扫描，并为每个探针记录一个原始的数值“强度”值，该值与结合的mRNA数量成正比。\n\n一位刚接触此类数据分析的初级研究员提出了一种简单直接的方法来为每个基因获取单一的表达值：直接计算其对应探针组内所有探针的原始强度值的算术平均值。\n\n然而，成熟的生物信息学分析流程使用的是更复杂、多步骤的算法，例如鲁棒多芯片平均算法（Robust Multi-array Average, RMA）。请指出以下哪些陈述为RMA这类算法在方法论上优于简单平均原始强度的有效理由。\n\nA. 简单平均忽略了来自芯片表面的背景噪音和非特异性结合产生的信号，而RMA算法的初始步骤中明确地对这些因素进行建模和校正。\n\nB. 单个探针组内的各个探针因其核苷酸序列的差异，对目标mRNA具有固有的不同结合亲和力。简单平均将所有探针视为具有同等的代表性，而RMA的汇总步骤则通过统计学方法建模并解释了这些个体探针效应。\n\nC. 针对单个芯片进行简单平均无法校正实验中不同基因芯片之间存在的系统性的、非生物学的变异（例如，激光强度或样本制备的差异）。RMA通过应用跨芯片的标准化程序来解决这个问题。\n\nD. 简单的算术平均值对离群测量值（例如，受灰尘颗粒或划痕影响的探针）高度敏感，而RMA汇总步骤中使用的稳健统计方法旨在减少受此类极端值的影响。\n\nE. RMA之所以更受青睐，是因为它是第一个有效使用错配（Mismatch, MM）探针的算法，这种探针含有一个碱基的改变，可以更准确地减去背景信号，而这是简单平均法所不具备的特性。\n\nF. RMA算法中的对数转换步骤主要是为了与处理原始线性尺度强度相比，显著提高汇总计算的计算速度。\n\n你最终的答案应由所有正确选项对应的字母组成的字符串，并按字母顺序连接（例如，“ACF”）。", "solution": "目标是评估每个陈述，以确定其是否构成了选择鲁棒多芯片平均（Robust Multi-array Average, RMA）算法而非简单算术平均原始探针强度来进行芯片数据汇总的有效理由。\n\n我们来逐一分析每个选项：\n\n**陈述 A：** 正确。原始探针强度是目标信使核糖核酸（mRNA）特异性杂交产生的真实信号、芯片板本身的背景荧光以及非特异性杂交（其他分子与探针结合）产生的噪音的复合体。对原始强度进行简单平均会将这些信号源和噪音源混为一谈。RMA算法以一个背景校正步骤开始，该步骤对背景和非特异性结合成分进行建模和扣除，从而提供对真实信号更准确的估计。\n\n**陈述 B：** 正确。尽管一个探针组中的所有探针都靶向同一个基因，但它们25个碱基对的序列是不同的。这些序列差异导致探针-靶标双链体的热力学稳定性不同，从而产生变化的结合亲和力和效率。简单算术平均隐含地假设所有探针的性能都相同，这在生物学和化学上都是错误的。RMA的汇总步骤，通常使用一种称为中位数平滑法（median polish）的方法，对数据拟合一个加性模型，形式为 `log2(Intensity) = Gene Expression + Probe Affinity + Error`。这明确地将“探针效应”作为一个独立的项进行建模，防止它对最终的基因表达估计产生偏倚。\n\n**陈-述 C：** 正确。当使用多个基因芯片进行实验时（例如，比较处理组和对照组），确保观察到的任何基因表达差异都是由生物学原因而非技术性假象引起的至关重要。系统性变异可能源于不同芯片间的样本量、染料标记效率、杂交条件或扫描仪设置的差异。这可能导致一个芯片的整体强度分布与另一个芯片不同。简单平均无法解决这种芯片间的变异。RMA包含一个分位数标准化步骤，该步骤强制实验中所有芯片的探针强度分布相同，使它们可以直接进行比较。\n\n**陈述 D：** 正确。基因芯片数据是出了名的嘈杂，由于芯片上的物理缺陷、灰尘或其他随机错误，少数探针产生异常强度值（离群值）是很常见的。算术平均值是一个非稳健的统计量，意味着它受离群值的影响很大。一个具有人为高强度的探针就能显著地使整个探针组的平均值发生偏斜。RMA使用稳健的统计程序。例如，其汇总步骤使用中位数平滑法，该方法依赖于中位数。中位数对离群值具有稳健性，这意味着最终的表达量度受一个或几个错误探针测量的影响较小，从而提供了更稳定、更可靠的估计。\n\n**陈述 E：** 错误。这个陈述错误地描述了RMA的工作原理。Affymetrix芯片在历史上既包含完全匹配（Perfect Match, PM）探针，也包含错配（Mismatch, MM）探针（其中心一个碱基对被故意错配）。早期的算法如MAS5使用MM探针的强度作为非特异性结合的估计值，从PM探针的强度中减去。然而，RMA算法的一个关键创新是决定*完全忽略*MM探针。RMA的设计者论证并表明，MM探针也会结合大量的特异性靶标，并且用它们进行背景校正通常引入的方差比消除的更多。因此，RMA的优越性并非基于使用MM探针，而是基于*不*使用它们，并仅对PM探针采用基于模型的背景校正。\n\n**陈述 F：** 错误。对数转换（特别是以2为底）是RMA中的一个关键步骤，但其主要目的是统计上的，而非计算上的。原始强度数据通常具有高度偏态的分布，并且表现出方差随均值增加的特性（即，强度越高的信号越不稳定）。应用对数转换使数据分布更对称（更接近正态分布），并稳定了在整个表达水平范围内的方差。这些特性对于后续分析步骤中使用的统计模型（如线性模型）是非常理想的。计算对数的操作增加了一个计算步骤，本质上并不会加快处理速度。\n\n因此，在给出的选项中，RMA优越性的有效理由是A、B、C和D。将这些字母按字母顺序连接起来得到“ABCD”。", "answer": "$$\\boxed{ABCD}$$", "id": "1476338"}]}