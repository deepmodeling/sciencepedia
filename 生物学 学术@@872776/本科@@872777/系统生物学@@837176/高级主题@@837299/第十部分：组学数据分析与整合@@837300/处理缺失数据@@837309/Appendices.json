{"hands_on_practices": [{"introduction": "处理缺失数据是分析生物数据集时遇到的一个基本挑战。第一个练习将介绍一种最简单的技术——均值插补，即用该特征的观测值的平均值来替代缺失值。通过完成这个练习 [@problem_id:1437187]，你将亲手实践如何将这种基本方法应用于基因表达矩阵，并获得直观的理解。", "problem": "一个研究小组正在研究人类细胞对一种新型治疗化合物的转录响应。他们测量了四个重复细胞培养物（标记为 S1、S2、S3、S4）中五个关键信号基因（标记为 G1、G2、G3、G4、G5）的表达水平。数据以标准化的表达单位表示，并被组织在一个矩阵中，其中行对应基因，列对应重复样本。\n\n由于微阵列玻片上的一个污点，重复样本 S3 中基因 G3 的表达值无法读取。记录的数据集如下，其中 'X' 表示缺失值：\n\n- **G1:** [2.15, 2.30, 2.25, 2.18]\n- **G2:** [0.88, 0.95, 0.91, 1.02]\n- **G3:** [1.54, 1.71, X, 1.60]\n- **G4:** [3.40, 3.11, 3.25, 3.32]\n- **G5:** [0.45, 0.39, 0.41, 0.44]\n\n为了在进行进一步统计分析之前补全数据集，该团队决定采用一种基本的数据插补技术。你的任务是使用基因层面的均值插补法计算 'X' 的值。该技术涉及将特定基因的缺失值替换为来自所有其他重复样本中该同一基因的观测表达值的算术平均值。\n\n计算重复样本 S3 中基因 G3 的插补表达值。将最终答案四舍五入至三位有效数字。", "solution": "我们使用基因层面的均值插补法：用同一基因的观测值的算术平均值来替换缺失值。对于基因 G3，在可用的重复样本中，其观测到的表达值为 $1.54$、$1.71$ 和 $1.60$。\n\n插补值 $X$ 计算如下\n$$\nX=\\frac{1}{3}\\left(1.54+1.71+1.60\\right).\n$$\n首先，将观测值相加：\n$$\n1.54+1.71=3.25,\\quad 3.25+1.60=4.85.\n$$\n除以观测值的数量：\n$$\nX=\\frac{4.85}{3}=1.616\\overline{6}.\n$$\n四舍五入至三位有效数字，得到\n$$\nX\\approx 1.62.\n$$", "answer": "$$\\boxed{1.62}$$", "id": "1437187"}, {"introduction": "插补方法的选择不仅仅是一个技术细节，它能显著影响下游分析的结果。本练习 [@problem_id:1437170] 要求你比较两种不同插补技术（简单的均值插补和更能感知上下文的 k-最近邻(k-NN)方法）对差异表达分析结论的影响。通过计算两组显著基因集之间的杰卡德距离 (Jaccard distance)，你将量化生物学结论对缺失数据处理方式的敏感性。", "problem": "在一项研究细胞对新药反应的系统生物学实验中，研究人员测量了五个基因（A、B、C、D、E）在三个对照样本（C1、C2、C3）和三个处理样本（T1、T2、T3）中的表达水平。得到的数据集包含一些缺失值，用 `NA` 表示。\n\n| 基因 | C1   | C2   | C3   | T1   | T2   | T3   |\n|:----:|:----:|:----:|:----:|:----:|:----:|:----:|\n| A    | 2.0  | 3.0  | 2.5  | 6.0  | 5.0  | 5.5  |\n| B    | 8.0  | 9.0  | 7.0  | 3.0  | NA   | 4.0  |\n| C    | 4.0  | 5.0  | 6.0  | 4.5  | 5.5  | 5.0  |\n| D    | 10.0 | 11.0 | NA   | 10.5 | 9.5  | 10.0 |\n| E    | 1.0  | 2.0  | 3.0  | 8.0  | 9.0  | NA   |\n\n为了评估缺失数据对结论的影响，您必须比较两种插补策略：均值插补和 k-近邻（k-NN）插补。\n\n1.  **均值插补**：对于一个给定的基因，任何 `NA` 值都由该基因在所有其他样本中观测到的表达值的算术平均值替换。\n2.  **k-近邻（k-NN）插补**：对于本问题，使用 `k=1`。要为一个基因的缺失值进行插补，首先要确定其“最近邻”。两个基因之间的距离定义为其表达向量之间的欧氏距离，该距离*仅*在两个基因都有观测值的样本集上计算。距离最小的基因为最近邻。如果最近邻存在并列情况，则选择按字母顺序排在最前面的基因。然后，`NA` 值被替换为这个最近邻在对应 `NA` 的样本中的表达值。\n\n插补后，如果一个基因的差异表达分数（DES）超过一个阈值，则该基因被分类为显著差异表达（SDE）基因。DES 定义为处理组的平均表达量与对照组的平均表达量之差的绝对值：\n$$\n\\text{DES} = |\\text{mean}(\\text{Treated}) - \\text{mean}(\\text{Control})|\n$$\n如果一个基因的 $\\text{DES} > 3.7$，则它被认为是SDE基因。\n\n您的任务是计算使用均值插补法识别出的SDE基因集合（$S_{\\text{mean}}$）与使用1-NN插补法识别出的SDE基因集合（$S_{\\text{1-NN}}$）之间的 Jaccard 距离。Jaccard 距离定义为：\n$$\nD_J(S_{\\text{mean}}, S_{\\text{1-NN}}) = 1 - \\frac{|S_{\\text{mean}} \\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}} \\cup S_{\\text{1-NN}}|}\n$$\n将您的最终答案表示为保留三位有效数字的小数。", "solution": "我们将对照样本表示为 $C1, C2, C3$，处理样本表示为 $T1, T2, T3$。共有三个缺失值：$B(T2)$、$D(C3)$ 和 $E(T3)$。\n\n均值插补：\n对于每个受影响的基因，用其在所有样本中观测值的均值替换缺失值。\n\n- 基因 $B$：观测值为 $8.0, 9.0, 7.0, 3.0, 4.0$，所以\n$$\n\\overline{B}_{\\text{obs}}=\\frac{8+9+7+3+4}{5}=\\frac{31}{5}=6.2,\\quad B(T2)\\leftarrow 6.2.\n$$\n- 基因 $D$：观测值为 $10.0, 11.0, 10.5, 9.5, 10.0$，所以\n$$\n\\overline{D}_{\\text{obs}}=\\frac{10+11+10.5+9.5+10}{5}=\\frac{51}{5}=10.2,\\quad D(C3)\\leftarrow 10.2.\n$$\n- 基因 $E$：观测值为 $1.0, 2.0, 3.0, 8.0, 9.0$，所以\n$$\n\\overline{E}_{\\text{obs}}=\\frac{1+2+3+8+9}{5}=\\frac{23}{5}=4.6,\\quad E(T3)\\leftarrow 4.6.\n$$\n\n使用均值插补法计算每个基因的 DES。对于一个基因 $G$，其对照组均值为 $\\overline{G}_{C}$，处理组均值为 $\\overline{G}_{T}$，\n$$\n\\text{DES}(G)=|\\overline{G}_{T}-\\overline{G}_{C}|.\n$$\n- $A$：$\\overline{A}_{C}=\\frac{2.0+3.0+2.5}{3}=2.5$，$\\overline{A}_{T}=\\frac{6.0+5.0+5.5}{3}=5.5$，所以 $\\text{DES}(A)=|5.5-2.5|=3.0$。\n- $B$：$\\overline{B}_{C}=\\frac{8+9+7}{3}=8$，$\\overline{B}_{T}=\\frac{3.0+6.2+4.0}{3}=\\frac{13.2}{3}=4.4$，所以 $\\text{DES}(B)=|4.4-8|=3.6$。\n- $C$：$\\overline{C}_{C}=\\frac{4+5+6}{3}=5$，$\\overline{C}_{T}=\\frac{4.5+5.5+5.0}{3}=5$，所以 $\\text{DES}(C)=0$。\n- $D$：$\\overline{D}_{C}=\\frac{10.0+11.0+10.2}{3}=\\frac{31.2}{3}=10.4$，$\\overline{D}_{T}=\\frac{10.5+9.5+10.0}{3}=10$，所以 $\\text{DES}(D)=|10-10.4|=0.4$。\n- $E$：$\\overline{E}_{C}=\\frac{1+2+3}{3}=2$，$\\overline{E}_{T}=\\frac{8+9+4.6}{3}=\\frac{21.6}{3}=7.2$，所以 $\\text{DES}(E)=|7.2-2|=5.2$。\n\n阈值为 $3.7$，SDE基因是那些 $\\text{DES}>3.7$ 的基因。因此，在均值插补下，\n$$\nS_{\\text{mean}}=\\{E\\}.\n$$\n\n1-NN 插补（$k=1$）：\n对于有缺失值的基因，通过在观测样本交集上计算欧氏距离来确定其最近邻。对于基因 $X$ 和 $Y$，使用两个基因都有观测值的样本集 $S$，\n$$\nd(X,Y)=\\sqrt{\\sum_{s\\in S}(x_{s}-y_{s})^{2}},\n$$\n我们使用 $d^{2}(X,Y)$ 进行比较。\n\n- 对于 $B$（在 $T2$ 处缺失）：\n    - 在 $\\{C1,C2,C3,T1,T3\\}$ 上的 $d^{2}(B,A)$：\n    $$\n    (8-2)^{2}+(9-3)^{2}+(7-2.5)^{2}+(3-6)^{2}+(4-5.5)^{2}=36+36+20.25+9+2.25=103.5.\n    $$\n    - 在 $\\{C1,C2,C3,T1,T3\\}$ 上的 $d^{2}(B,C)$：\n    $$\n    (8-4)^{2}+(9-5)^{2}+(7-6)^{2}+(3-4.5)^{2}+(4-5)^{2}=16+16+1+2.25+1=36.25.\n    $$\n    - 在 $\\{C1,C2,T1,T3\\}$ 上的 $d^{2}(B,D)$：\n    $$\n    (8-10)^{2}+(9-11)^{2}+(3-10.5)^{2}+(4-10)^{2}=4+4+56.25+36=100.25.\n    $$\n    - 在 $\\{C1,C2,C3,T1\\}$ 上的 $d^{2}(B,E)$：\n    $$\n    (8-1)^{2}+(9-2)^{2}+(7-3)^{2}+(3-8)^{2}=49+49+16+25=139.\n    $$\n    最小值为 $36.25$，邻居为 $C$，所以 $B(T2)\\leftarrow C(T2)=5.5$。\n\n- 对于 $D$（在 $C3$ 处缺失）：\n    - 在 $\\{C1,C2,T1,T2,T3\\}$ 上的 $d^{2}(D,A)$：\n    $$\n    (10-2)^{2}+(11-3)^{2}+(10.5-6)^{2}+(9.5-5)^{2}+(10-5.5)^{2}=64+64+20.25+20.25+20.25=188.75.\n    $$\n    - 在 $\\{C1,C2,T1,T3\\}$ 上的 $d^{2}(D,B)$：\n    $$\n    (10-8)^{2}+(11-9)^{2}+(10.5-3)^{2}+(10-4)^{2}=4+4+56.25+36=100.25.\n    $$\n    - 在 $\\{C1,C2,T1,T2,T3\\}$ 上的 $d^{2}(D,C)$：\n    $$\n    (10-4)^{2}+(11-5)^{2}+(10.5-4.5)^{2}+(9.5-5.5)^{2}+(10-5)^{2}=36+36+36+16+25=149.\n    $$\n    - 在 $\\{C1,C2,T1,T2\\}$ 上的 $d^{2}(D,E)$：\n    $$\n    (10-1)^{2}+(11-2)^{2}+(10.5-8)^{2}+(9.5-9)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    最小值为 $100.25$，邻居为 $B$，所以 $D(C3)\\leftarrow B(C3)=7.0$。\n\n- 对于 $E$（在 $T3$ 处缺失）：\n    - 在 $\\{C1,C2,C3,T1,T2\\}$ 上的 $d^{2}(E,A)$：\n    $$\n    (1-2)^{2}+(2-3)^{2}+(3-2.5)^{2}+(8-6)^{2}+(9-5)^{2}=1+1+0.25+4+16=22.25.\n    $$\n    - 在 $\\{C1,C2,C3,T1\\}$ 上的 $d^{2}(E,B)$：\n    $$\n    (1-8)^{2}+(2-9)^{2}+(3-7)^{2}+(8-3)^{2}=49+49+16+25=139.\n    $$\n    - 在 $\\{C1,C2,C3,T1,T2\\}$ 上的 $d^{2}(E,C)$：\n    $$\n    (1-4)^{2}+(2-5)^{2}+(3-6)^{2}+(8-4.5)^{2}+(9-5.5)^{2}=9+9+9+12.25+12.25=51.5.\n    $$\n    - 在 $\\{C1,C2,T1,T2\\}$ 上的 $d^{2}(E,D)$：\n    $$\n    (1-10)^{2}+(2-11)^{2}+(8-10.5)^{2}+(9-9.5)^{2}=81+81+6.25+0.25=168.5.\n    $$\n    最小值为 $22.25$，邻居为 $A$，所以 $E(T3)\\leftarrow A(T3)=5.5$。\n\n使用 1-NN 插补法计算每个基因的 DES：\n- $A$：不变，$\\overline{A}_{C}=2.5$，$\\overline{A}_{T}=5.5$，$\\text{DES}(A)=3.0$。\n- $B$：$\\overline{B}_{C}=8$，$\\overline{B}_{T}=\\frac{3.0+5.5+4.0}{3}=\\frac{12.5}{3}$，所以\n$$\n\\text{DES}(B)=\\left|\\frac{12.5}{3}-8\\right|=\\left|\\,\\frac{12.5-24}{3}\\,\\right|=\\frac{11.5}{3}\\approx 3.833\\ldots\n$$\n- $C$：$\\text{DES}(C)=0$。\n- $D$：$\\overline{D}_{C}=\\frac{10+11+7}{3}=\\frac{28}{3}$，$\\overline{D}_{T}=10$，所以\n$$\n\\text{DES}(D)=\\left|10-\\frac{28}{3}\\right|=\\frac{2}{3}\\approx 0.666\\ldots\n$$\n- $E$：$\\overline{E}_{C}=2$，$\\overline{E}_{T}=\\frac{8+9+5.5}{3}=\\frac{22.5}{3}=7.5$，所以 $\\text{DES}(E)=|7.5-2|=5.5$。\n\n阈值为 $3.7$，1-NN 插补法下的 SDE 基因为\n$$\nS_{\\text{1-NN}}=\\{B,E\\}.\n$$\n\nJaccard 距离：\n$$\nS_{\\text{mean}}=\\{E\\},\\quad S_{\\text{1-NN}}=\\{B,E\\},\\quad |S_{\\text{mean}}\\cap S_{\\text{1-NN}}|=1,\\quad |S_{\\text{mean}}\\cup S_{\\text{1-NN}}|=2.\n$$\n因此，\n$$\nD_{J}=1-\\frac{|S_{\\text{mean}}\\cap S_{\\text{1-NN}}|}{|S_{\\text{mean}}\\cup S_{\\text{1-NN}}|}=1-\\frac{1}{2}=\\frac{1}{2}=0.5.\n$$\n保留三位有效数字，结果是 $0.500$。", "answer": "$$\\boxed{0.500}$$", "id": "1437170"}, {"introduction": "对于动态系统，我们可以利用对底层生物学机制的理解来进行更复杂的插补。这个高级练习 [@problem_id:1437209] 探讨了一种基于模型的方法，其背景是一个由常微分方程 (ODE) 描述的基因开关。你将实现一个迭代算法，该算法同时估计未知的模型参数并插补缺失的时间序列数据点，从而展示了机理模型如何指导数据的补全。", "problem": "一位系统生物学家正在研究一个构建在细菌宿主中的合成基因触发开关。该开关由两种蛋白质A和B组成，它们相互抑制对方的合成。蛋白质浓度 $A(t)$ 和 $B(t)$ 的动态变化由一个常微分方程组（ODEs）建模。为了进行计算分析，该系统使用时间步长为 $\\Delta t$ 的前向欧拉法进行离散化：\n\n$A_{i+1} = A_i + \\Delta t \\left( \\frac{\\alpha_A}{1 + B_i^2} - \\delta A_i \\right)$\n$B_{i+1} = B_i + \\Delta t \\left( \\frac{\\alpha_B}{1 + A_i^2} - \\delta B_i \\right)$\n\n此处，$A_i$ 和 $B_i$ 是时间步 $i$ 时的浓度。参数 $\\alpha_A$ 和 $\\alpha_B$ 是最大生产速率，$\\delta$ 是降解/稀释速率，假设两种蛋白质的该速率相同。浓度单位为纳摩尔（nM），时间单位为小时。\n\n根据先前的实验，以下参数已知：$\\alpha_A = 20.0$，$\\delta = 0.5$，使用的时间步长为 $\\Delta t = 1.0$。生产速率 $\\alpha_B$ 未知，需要从实验数据中估计。\n\n进行了一次时间序列测量，得到以下数据：\n- 在 $t=0$ (i=0) 时：$A_0 = 0.20$ nM, $B_0 = 4.0$ nM。\n- 在 $t=1$ (i=1) 时：$A_1 = 1.50$ nM, $B_1 = 3.5$ nM。\n- 在 $t=2$ (i=2) 时：$A_2 = 2.50$ nM。$B_2$ 的测量值已损坏且缺失。\n\n为了处理缺失的数据点并估计未知参数，您需要使用一个称为耦合插补-估计（CIE）的程序。该程序是迭代的。\n\n**初始化（迭代 k=0）：**\n- 未知参数的初始猜测值为 $\\alpha_B^{(0)} = 10.0$。\n- 缺失数据点 $B_2^{(0)}$ 的初始猜测值通过沿用上一个有效观测值获得：$B_2^{(0)} = B_1$。\n\n**迭代更新（对于 k = 1, 2, ...）：**\n每次迭代 $k$ 包含按顺序执行的两个步骤：\n\n1.  **参数估计：** 计算参数的新估计值 $\\alpha_B^{(k)}$。这是通过找到使B动态在所有可用时间区间上的平方误差和最小化的 $\\alpha_B$ 值来完成的。B动态的模型可以重排为 $\\frac{B_{i+1} - B_i}{\\Delta t} + \\delta B_i = \\alpha_B \\left( \\frac{1}{1 + A_i^2} \\right)$。使用数据集，包括缺失点的当前插补值（$B_2^{(k-1)}$），进行线性最小二乘拟合，以找到最优的 $\\alpha_B^{(k)}$。对于一组数据点 $(x_j, y_j)$，使 $\\sum_j (y_j - c \\cdot x_j)^2$ 最小化的模型 $y_j = c \\cdot x_j$ 的通解为 $c = \\frac{\\sum_j x_j y_j}{\\sum_j x_j^2}$。\n\n2.  **数据插补：** 使用本次迭代第（1）部分新更新的参数估计值 $\\alpha_B^{(k)}$，通过 $B$ 在步骤 $i=1$ 时的前向欧拉方程，计算缺失数据点 $B_2^{(k)}$ 的新估计值。\n\n您的任务是计算CIE算法经过两次完整迭代后，缺失浓度 $B_2$ 的插补值。将此值 $B_2^{(2)}$ 的最终答案以nM为单位表示，并四舍五入到三位有效数字。", "solution": "我们使用 $B$ 的前向欧拉离散化：\n$$\nB_{i+1} = B_{i} + \\Delta t\\left(\\frac{\\alpha_{B}}{1 + A_{i}^{2}} - \\delta B_{i}\\right),\n$$\n以及用于参数估计的重排后的线性形式：\n$$\n\\frac{B_{i+1} - B_{i}}{\\Delta t} + \\delta B_{i} = \\alpha_{B}\\left(\\frac{1}{1 + A_{i}^{2}}\\right).\n$$\n定义 $x_{i} = \\frac{1}{1 + A_{i}^{2}}$ 和 $y_{i} = \\frac{B_{i+1} - B_{i}}{\\Delta t} + \\delta B_{i}$。已知 $\\Delta t = 1$ 和 $\\delta = 0.5$，数据为 $A_{0} = 0.20$，$A_{1} = 1.50$，$B_{0} = 4.0$，$B_{1} = 3.5$，所需的 $x_{i}$ 为\n$$\nx_{0} = \\frac{1}{1 + (0.20)^{2}} = \\frac{1}{1.04} = \\frac{25}{26},\\qquad\nx_{1} = \\frac{1}{1 + (1.50)^{2}} = \\frac{1}{3.25} = \\frac{4}{13}.\n$$\n初始化给出 $\\alpha_{B}^{(0)} = 10.0$ 和 $B_{2}^{(0)} = B_{1} = 3.5$。\n\n迭代 $k=1$，参数估计：使用 $B_{2}^{(0)}$，\n$$\ny_{0} = (B_{1} - B_{0}) + \\delta B_{0} = (3.5 - 4.0) + 0.5\\cdot 4.0 = \\frac{3}{2},\n$$\n$$\ny_{1}^{(0)} = (B_{2}^{(0)} - B_{1}) + \\delta B_{1} = (3.5 - 3.5) + 0.5\\cdot 3.5 = \\frac{7}{4}.\n$$\n$\\alpha_{B}$ 的最小二乘估计量为\n$$\n\\alpha_{B}^{(1)} = \\frac{\\sum_{i=0}^{1} x_{i}y_{i}}{\\sum_{i=0}^{1} x_{i}^{2}}\n= \\frac{\\frac{25}{26}\\cdot\\frac{3}{2} + \\frac{4}{13}\\cdot\\frac{7}{4}}{\\left(\\frac{25}{26}\\right)^{2} + \\left(\\frac{4}{13}\\right)^{2}}\n= \\frac{\\frac{75}{52} + \\frac{7}{13}}{\\frac{625}{676} + \\frac{16}{169}}\n= \\frac{\\frac{103}{52}}{\\frac{689}{676}}\n= \\frac{103}{52}\\cdot\\frac{676}{689}\n= \\frac{1339}{689}.\n$$\n迭代 $k=1$，在 $i=1$ 处进行数据插补：\n$$\nB_{2}^{(1)} = B_{1} + \\left(\\frac{\\alpha_{B}^{(1)}}{1 + A_{1}^{2}} - \\delta B_{1}\\right)\n= 3.5 + \\left(\\alpha_{B}^{(1)}\\cdot\\frac{4}{13} - 0.5\\cdot 3.5\\right)\n= \\frac{7}{2} + \\left(\\frac{1339}{689}\\cdot\\frac{4}{13} - \\frac{7}{4}\\right)\n= \\frac{7}{4} + \\frac{5356}{8957} = \\frac{84123}{35828}.\n$$\n\n迭代 $k=2$，参数估计：使用 $B_{2}^{(1)}$，\n$$\ny_{1}^{(1)} = (B_{2}^{(1)} - B_{1}) + \\delta B_{1} = B_{2}^{(1)} - \\frac{7}{4} = \\alpha_{B}^{(1)}\\cdot\\frac{4}{13} = \\frac{5356}{8957}.\n$$\n因此\n$$\n\\alpha_{B}^{(2)} = \\frac{\\frac{25}{26}\\cdot\\frac{3}{2} + \\frac{4}{13}\\cdot\\frac{5356}{8957}}{\\left(\\frac{25}{26}\\right)^{2} + \\left(\\frac{4}{13}\\right)^{2}}\n= \\frac{\\frac{75}{52} + \\frac{21424}{116441}}{\\frac{689}{676}}\n= \\frac{\\frac{757471}{465764}}{\\frac{689}{676}}\n= \\frac{757471}{465764}\\cdot\\frac{676}{689}\n= \\frac{512050396}{320911396}.\n$$\n迭代 $k=2$，数据插补：\n$$\nB_{2}^{(2)} = B_{1} + \\left(\\frac{\\alpha_{B}^{(2)}}{1 + A_{1}^{2}} - \\delta B_{1}\\right)\n= \\frac{7}{4} + \\alpha_{B}^{(2)}\\cdot\\frac{4}{13}\n= \\frac{7}{4} + \\frac{512050396}{320911396} \\cdot \\frac{4}{13}\n= \\frac{7}{4} + \\frac{2048201584}{4171848148}.\n$$\n数值上，$\\frac{2048201584}{4171848148} \\approx 0.490957846$，因此\n$$\nB_{2}^{(2)} \\approx 1.75 + 0.490957846 = 2.240957846.\n$$\n四舍五入到三位有效数字，得到 $2.24$。", "answer": "$$\\boxed{2.24}$$", "id": "1437209"}]}