{"hands_on_practices": [{"introduction": "在分析高通量生物学数据时，我们得到的结果往往混合了生物信号和技术噪声。主成分分析（PCA）作为一种强大的探索性工具，其首要任务就是帮助我们识别数据中最大的变异来源。这个练习模拟了一个在生物信息学分析中非常常见的情景：当最显著的变异（PC1）来源于实验批次效应时，我们如何解读后续的主成分，并从中寻找真正有意义的生物学差异。[@problem_id:1428867]", "problem": "一位系统生物学家正在研究两组（健康个体和患有特定疾病的患者）组织样本的基因表达谱。其目标是识别在这两种状况之间存在差异表达的基因。由于后勤限制，这些样本是在两个独立的实验室批次中收集和处理的。\n\n在对每个样本的数千个基因的表达水平进行量化后，该生物学家对所得的数据矩阵进行了主成分分析 (PCA)。分析显示，捕获了数据集中最大方差的第一主成分 (PC1) 完美地根据样本所属的处理批次将其分开了，而不是根据它们的健康状况（健康 vs. 患病）。\n\n假设实验在其他方面进行得很好，并且两组之间的生物学差异是显著的，那么以下哪项最可能描述了第二主成分 (PC2) 捕获的信息？\n\nA. 健康组织样本与患病组织样本之间的生物学变异。\n\nB. 与批次或健康状况均不相关的随机实验噪声。\n\nC. 批次效应和生物学变异的线性组合。\n\nD. 所有收集样本的平均基因表达水平。\n\nE. 次要的、独立的技术性假象，例如单个批次内试剂质量的差异。", "solution": "将均值中心化后的数据矩阵定义为 $X \\in \\mathbb{R}^{n \\times p}$，其列（基因）经过中心化处理，使得每一列的均值为零。PCA 寻找能够最大化投影方差的标准正交载荷向量 $\\{v_{k}\\}$，其得分为 $t_{k} = X v_{k}$ 且 $v_{i}^{\\top} v_{j} = \\delta_{ij}$。第一主成分 $v_{1}$ 最大化 $\\operatorname{Var}(X v_{1})$ 并捕获了主要的变异来源。\n\n鉴于 PC1 完美地按处理批次分开了样本，数据 $X$ 中的主要方差是由批次效应引起的。根据定义，PC2 是在满足 $v_{2}^{\\top} v_{1} = 0$ 的约束条件下最大化方差的方向 $v_{2}$，也就是说，它捕获了与 PC1 中反映的批次方向正交的第二大变异来源。\n\n在实验其他方面进行良好且健康组与患病组之间的生物学差异显著的假设下，下一个最大的、与批次正交的变异来源最可能是与疾病相关的生物学信号。因此，PC2 预计会捕获健康组织样本与患病组织样本之间的生物学变异。\n\n选项 D 与 PCA 的预处理不一致，因为均值中心化会移除平均信号，所以平均表达水平不会由主成分来表示。选项 C 在这里具有误导性：虽然任何 PC 都是原始变量（基因）的线性组合，但 PC2 与 PC1 正交，因此不包含由 PC1 代表的批次方差；它不是一个仍然携带批次效应方差的混合体。选项 B（随机噪声）不太可能主导 PC2，因为题目明确假设生物学差异是显著的。选项 E（另一个技术性假象）因为题目陈述实验在其他方面进行得很好而变得不太可能。\n\n因此，最可能的解释是 PC2 捕获了与疾病相关的生物学变异。", "answer": "$$\\boxed{A}$$", "id": "1428867"}, {"introduction": "一旦我们识别出某个主成分可能代表一个特定的生物学过程，我们就可以超越简单的可视化，将其转化为一个可量化的指标。这个动手练习将指导你如何利用 PCA 的载荷（loadings）作为权重，来计算一个“元基因”分数。这种方法能够将一组相关基因的活性总结成一个单一而强大的数值，极大地简化了对复杂通路活性的评估。[@problem_id:1428922]", "problem": "在系统生物学中，主成分分析 (PCA) 是一种强大的技术，用于降低大型数据集（例如癌症患者的基因表达谱）的维度。一个常见的应用是推导出一个“元基因分数”，以概括生物通路的活性。\n\n一位研究人员正在研究癌细胞中的一种特定代谢通路，该通路涉及四个关键基因：基因A、基因B、基因C和基因D。他们对一个大型基因表达数据集进行了PCA分析，发现第一个主成分 (PC1) 与该通路的整体活性密切相关。他们决定使用PC1的载荷作为权重，为新样本创建一个通路活性分数。\n\n这四个基因的PC1载荷如下：\n- 基因A：0.65\n- 基因B：0.55\n- 基因C：-0.40\n- 基因D：0.30\n\n一个新肿瘤样本被分析，并测量了这四个基因的标准化表达值（z-scores）：\n- 基因A：2.20\n- 基因B：1.80\n- 基因C：1.50\n- 基因D：-1.10\n\n这个新样本的通路活性分数的计算方法是，将每个基因的表达值与其对应的PC1载荷相乘，然后求和。请计算这个新肿瘤样本的通路活性分数。将最终答案四舍五入到三位有效数字。", "solution": "问题要求我们计算一个新肿瘤样本的“通路活性分数”。该分数的定义是每个基因的标准化表达值与其对应的第一个主成分 (PC1) 载荷的乘积之和。这等同于计算表达向量和载荷向量的点积。\n\n设PC1载荷向量为 $\\mathbf{w}$，基因表达值向量为 $\\mathbf{g}$。\n基因A、B、C和D的载荷向量 $\\mathbf{w}$ 如下所示：\n$$ \\mathbf{w} = \\begin{pmatrix} 0.65 \\\\ 0.55 \\\\ -0.40 \\\\ 0.30 \\end{pmatrix} $$\n\n新样本的基因表达向量 $\\mathbf{g}$ 如下所示：\n$$ \\mathbf{g} = \\begin{pmatrix} 2.20 \\\\ 1.80 \\\\ 1.50 \\\\ -1.10 \\end{pmatrix} $$\n\n通路活性分数 $S$ 计算为点积 $\\mathbf{w} \\cdot \\mathbf{g}$：\n$$ S = \\sum_{i=1}^{4} w_i g_i = w_A g_A + w_B g_B + w_C g_C + w_D g_D $$\n\n现在，我们将给定的数值代入此公式：\n$$ S = (0.65)(2.20) + (0.55)(1.80) + (-0.40)(1.50) + (0.30)(-1.10) $$\n\n我们逐项计算每个乘积项：\n- 对于基因A：$0.65 \\times 2.20 = 1.43$\n- 对于基因B：$0.55 \\times 1.80 = 0.99$\n- 对于基因C：$-0.40 \\times 1.50 = -0.60$\n- 对于基因D：$0.30 \\times -1.10 = -0.33$\n\n现在，我们将这些乘积相加，以得到最终分数：\n$$ S = 1.43 + 0.99 - 0.60 - 0.33 $$\n$$ S = 2.42 - 0.60 - 0.33 $$\n$$ S = 1.82 - 0.33 $$\n$$ S = 1.49 $$\n\n问题要求答案保留三位有效数字。计算出的值 $1.49$ 已经有三位有效数字。\n\n因此，通路活性分数为1.49。", "answer": "$$\\boxed{1.49}$$", "id": "1428922"}, {"introduction": "在 PCA 图上观察到不同组别（例如健康与疾病）的样本点出现分离是一个令人兴奋的发现，但这是否是真实的生物学效应，还是仅仅是偶然？这个练习将引导你运用一种强大的统计方法——置换检验（permutation test），来严格评估这种分离的统计显著性。通过计算 p 值，我们可以为我们的发现提供坚实的统计学支持，从而区分真正的生物信号和随机噪声。[@problem_id:1428911]", "problem": "在一项试点系统生物学研究中，研究人员测量了六个个体中两个基因（基因1，基因2）的表达水平。其中三个个体来自健康队列（H），另外三个被诊断患有某种特定疾病（D）。表达数据以（基因1，基因2）对的形式记录如下：\n- 健康个体：H1=(1, 5), H2=(2, 5), H3=(1, 4)\n- 患病个体：D1=(5, 1), D2=(5, 2), D3=(4, 1)\n\n为了探索数据中变异的主轴，研究人员进行了主成分分析（PCA）。首先，通过减去所有六个个体的平均表达水平，对每个基因的数据进行中心化。然后，确定第一主成分（PC1）。PC1是样本协方差矩阵对应于最大特征值的标准化特征向量。然后将所有六个个体的中心化数据投影到PC1上，为每个个体获得一个单一得分。\n\n定义一个分离度量 $\\Delta$，其值为患病组的平均PC1得分与健康组的平均PC1得分之间的绝对差。为了评估观察到的分离是否具有统计显著性，必须计算一个p值。p值定义为：在所有可能将三个“患病”标签分配给六个个体的情况中，导致分离度量 $\\Delta$ 大于或等于从原始H/D标签获得的度量 $\\Delta_{obs}$ 的情况所占的比例。\n\n计算这个p值。将最终答案四舍五入到三位有效数字。", "solution": "题目要求计算一个p值，以评估健康组和患病组沿第一主成分（PC1）分离的统计显著性。这需要执行主成分分析（PCA），然后进行置换检验。\n\n**步骤1：整理数据并计算均值**\n数据矩阵 $X$（样本 $\\times$ 基因）为：\n$$\nX = \\begin{pmatrix}\n1 & 5 \\\\\n2 & 5 \\\\\n1 & 4 \\\\\n5 & 1 \\\\\n5 & 2 \\\\\n4 & 1\n\\end{pmatrix}\n$$\n对所有六个个体计算每个基因（列）的均值：\n基因1的均值： $\\mu_1 = \\frac{1+2+1+5+5+4}{6} = \\frac{18}{6} = 3$\n基因2的均值： $\\mu_2 = \\frac{5+5+4+1+2+1}{6} = \\frac{18}{6} = 3$\n\n**步骤2：中心化数据**\n从 $X$ 的每一行减去均值向量 $(\\mu_1, \\mu_2) = (3, 3)$，得到中心化数据矩阵 $X_c$：\n$$\nX_c = \\begin{pmatrix}\n1-3 & 5-3 \\\\\n2-3 & 5-3 \\\\\n1-3 & 4-3 \\\\\n5-3 & 1-3 \\\\\n5-3 & 2-3 \\\\\n4-3 & 1-3\n\\end{pmatrix} = \\begin{pmatrix}\n-2 & 2 \\\\\n-1 & 2 \\\\\n-2 & 1 \\\\\n2 & -2 \\\\\n2 & -1 \\\\\n1 & -2\n\\end{pmatrix}\n$$\n\n**步骤3：计算样本协方差矩阵**\n样本协方差矩阵 $C$ 由 $C = \\frac{1}{n-1} X_c^T X_c$ 给出，其中 $n=6$。\n$$\nC = \\frac{1}{5} \\begin{pmatrix} -2 & -1 & -2 & 2 & 2 & 1 \\\\ 2 & 2 & 1 & -2 & -1 & -2 \\end{pmatrix} \\begin{pmatrix}\n-2 & 2 \\\\\n-1 & 2 \\\\\n-2 & 1 \\\\\n2 & -2 \\\\\n2 & -1 \\\\\n1 & -2\n\\end{pmatrix}\n$$\n协方差矩阵的元素为：\n$C_{11} = \\frac{1}{5} ((-2)^2 + (-1)^2 + (-2)^2 + 2^2 + 2^2 + 1^2) = \\frac{1}{5}(4+1+4+4+4+1) = \\frac{18}{5} = 3.6$\n$C_{22} = \\frac{1}{5} (2^2 + 2^2 + 1^2 + (-2)^2 + (-1)^2 + (-2)^2) = \\frac{1}{5}(4+4+1+4+1+4) = \\frac{18}{5} = 3.6$\n$C_{12} = C_{21} = \\frac{1}{5} ((-2)(2) + (-1)(2) + (-2)(1) + (2)(-2) + (2)(-1) + (1)(-2)) = \\frac{1}{5}(-4-2-2-4-2-2) = \\frac{-16}{5} = -3.2$\n所以，协方差矩阵是：\n$$\nC = \\begin{pmatrix} 3.6 & -3.2 \\\\ -3.2 & 3.6 \\end{pmatrix}\n$$\n\n**步骤4：求解特征值和第一主成分（PC1）**\n为了找到特征值 $\\lambda$，我们求解特征方程 $\\det(C - \\lambda I) = 0$：\n$$\n(3.6 - \\lambda)(3.6 - \\lambda) - (-3.2)(-3.2) = 0\n$$\n$$\n(3.6 - \\lambda)^2 = (3.2)^2 = 10.24\n$$\n$$\n3.6 - \\lambda = \\pm 3.2\n$$\n两个特征值为 $\\lambda_1 = 3.6 + 3.2 = 6.8$ 和 $\\lambda_2 = 3.6 - 3.2 = 0.4$。\n第一主成分（PC1）是与最大特征值 $\\lambda_1=6.8$ 相关联的特征向量。设该特征向量为 $v_1 = (v_{11}, v_{12})^T$。\n$$\n(C - \\lambda_1 I)v_1 = 0 \\implies \\begin{pmatrix} 3.6-6.8 & -3.2 \\\\ -3.2 & 3.6-6.8 \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} -3.2 & -3.2 \\\\ -3.2 & -3.2 \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到方程 $-3.2 v_{11} - 3.2 v_{12} = 0$，可以简化为 $v_{11} = -v_{12}$。\n一个未标准化的特征向量是 $(1, -1)^T$。为了将其标准化，我们除以它的模 $\\sqrt{1^2 + (-1)^2} = \\sqrt{2}$。\n所以，第一主成分是 $w_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n**步骤5：将中心化数据投影到PC1上**\n每个个体的PC1得分是通过将其中心化数据向量投影到 $w_1$ 上计算的：得分 $= X_c \\cdot w_1$。\n- H1得分: $(-2, 2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-2 - 2) = -4/\\sqrt{2}$\n- H2得分: $(-1, 2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-1 - 2) = -3/\\sqrt{2}$\n- H3得分: $(-2, 1) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(-2 - 1) = -3/\\sqrt{2}$\n- D1得分: $(2, -2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(2 + 2) = 4/\\sqrt{2}$\n- D2得分: $(2, -1) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(2 + 1) = 3/\\sqrt{2}$\n- D3得分: $(1, -2) \\cdot \\frac{1}{\\sqrt{2}}(1, -1) = \\frac{1}{\\sqrt{2}}(1 + 2) = 3/\\sqrt{2}$\n六个PC1得分的集合是：$\\{-4/\\sqrt{2}, -3/\\sqrt{2}, -3/\\sqrt{2}, 4/\\sqrt{2}, 3/\\sqrt{2}, 3/\\sqrt{2}\\}$。\n\n**步骤6：计算观察到的分离度量 $\\Delta_{obs}$**\n- 健康组（H1, H2, H3）的平均得分：$\\mu_H = \\frac{1}{3} (-4/\\sqrt{2} - 3/\\sqrt{2} - 3/\\sqrt{2}) = \\frac{-10}{3\\sqrt{2}}$\n- 患病组（D1, D2, D3）的平均得分：$\\mu_D = \\frac{1}{3} (4/\\sqrt{2} + 3/\\sqrt{2} + 3/\\sqrt{2}) = \\frac{10}{3\\sqrt{2}}$\n观察到的分离度量为 $\\Delta_{obs} = |\\mu_D - \\mu_H| = |\\frac{10}{3\\sqrt{2}} - (\\frac{-10}{3\\sqrt{2}})| = \\frac{20}{3\\sqrt{2}}$。\n\n**步骤7：执行置换检验**\n零假设是标签是随机分配的。我们需要找到所有标签置换中，能产生分离度量 $\\Delta_{perm} \\ge \\Delta_{obs}$ 的置换所占的比例。将3个“D”标签分配给6个个体的总方式数为 $\\binom{6}{3} = \\frac{6 \\times 5 \\times 4}{3 \\times 2 \\times 1} = 20$。\n\nPC1得分是固定的；我们只置换它们的标签。让我们使用乘以 $\\sqrt{2}$ 简化后的得分进行计算：$S = \\{-4, -3, -3, 3, 3, 4\\}$。这些得分的总和为0。\n对于 $S$ 的任意一个划分为两个包含三个元素的组 $G_1$ 和 $G_2$，它们的和分别为 $S_1$ 和 $S_2 = -S_1$。\n这个划分的分离度量是 $\\Delta_{perm} = |\\frac{S_2/3}{\\sqrt{2}} - \\frac{S_1/3}{\\sqrt{2}}| = |\\frac{-S_1 - S_1}{3\\sqrt{2}}| = \\frac{2|S_1|}{3\\sqrt{2}}$。\n我们观察到的分离度量是 $\\Delta_{obs} = \\frac{20}{3\\sqrt{2}}$，这对应于 $|S_1| = 10$。\n\n我们需要找到在20种划分中，其中一组得分之和的绝对值 $|S_1| \\ge 10$ 的划分数量。\n让我们列出从 $S = \\{-4, -3, -3, 3, 3, 4\\}$ 中选取三个得分的所有可能的和。\n我们想找到3个元素的组合，其和 $\\le -10$ 或 $\\ge 10$。\n让我们分析极端可能性：\n- 为了得到最负的和，我们选择三个最小的得分：$\\{-4, -3, -3\\}$。和为 $-10$。这得到 $|S_1|=10$。这个组合对应于原始的标签分配。\n- 为了得到最正的和，我们选择三个最大的得分：$\\{3, 3, 4\\}$。和为 $10$。这得到 $|S_1|=10$。这个组合是第一个组合的补集。\n\n其他任何三个得分的组合将导致和在-10和10之间。例如：\n- $\\{-4, -3, 3\\}$ 的和为-4，所以 $|S_1|  10$。\n- $\\{-3, -3, 4\\}$ 的和为-2，所以 $|S_1|  10$。\n\n因此，只有两种组合（标签的置换）能产生等于观察到的分离度量：\n1. 第1组得分为 $\\{-4, -3, -3\\}$，第2组得分为 $\\{3, 3, 4\\}$。$|S_1|=10$。\n2. 第1组得分为 $\\{3, 3, 4\\}$，第2组得分为 $\\{-4, -3, -3\\}$。$|S_1|=10$。\n\n没有组合能产生严格大于观察值的分离度量。\n产生 $\\Delta_{perm} \\ge \\Delta_{obs}$ 的标签分配数量为2。\n\n**步骤8：计算p值**\np值是“成功”置换的数量除以总置换数。\n$$\np = \\frac{\\text{满足 } |S_1| \\ge 10 \\text{ 的置换数}}{\\text{总置换数}} = \\frac{2}{20} = 0.1\n$$\n\n**步骤9：四舍五入最终答案**\n题目要求答案四舍五入到三位有效数字。\n$p = 0.100$。", "answer": "$$\\boxed{0.100}$$", "id": "1428911"}]}