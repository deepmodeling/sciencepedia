{"hands_on_practices": [{"introduction": "许多机器学习模型要求输入是数值型的。然而，生物学数据常常包含分类型变量，例如细胞系名称或基因型。本练习将指导你应用“独热编码”（one-hot encoding），这是一种将这类分类标签转换为模型可以理解的数值格式的基本技术 [@problem_id:1426091]。", "problem": "在一次系统生物学实验中，一位研究人员正在分析来自几种癌细胞系的转录组数据，以构建一个预测药物敏感性的机器学习模型。数据集中的一个特征是`Cell_Line`（细胞系）类型，它是一个分类变量。为了在大多数机器学习算法中使用该特征，必须先将其转换为数值格式。\n\n研究人员有来自五个实验样本的数据序列，其中的`Cell_Line`值按以下顺序记录：\n`['MCF7', 'HeLa', 'A549', 'HeLa', 'MCF7']`\n\n你的任务是对此序列应用独热编码。编码表示中的新列必须对应于按字母顺序排序的唯一细胞系类别（'A549'、'HeLa'、'MCF7'）。\n\n将得到的独热编码数据呈现为一个单一矩阵，其中每一行对应原始序列中的一个样本，每一列对应于指定字母顺序中的一个细胞系类别。", "solution": "题目要求我们对一个分类变量进行独热编码，并按指定的字母顺序排列类别。独热编码将每个类别映射到 $\\mathbb{R}^{k}$ 中的一个标准基向量，其中 $k$ 是唯一类别的数量，$1$ 的位置由所选的类别顺序决定。\n\n设唯一类别的集合为 $C=\\{\\text{A549},\\text{HeLa},\\text{MCF7}\\}$，并施加字母顺序 $(\\text{A549},\\text{HeLa},\\text{MCF7})$。根据此顺序分配标准基向量来定义编码映射 $h:C\\to\\{0,1\\}^{3}$：\n$$\nh(\\text{A549})=(1,0,0),\\quad h(\\text{HeLa})=(0,1,0),\\quad h(\\text{MCF7})=(0,0,1).\n$$\n给定样本序列顺序为 $[\\text{MCF7},\\text{HeLa},\\text{A549},\\text{HeLa},\\text{MCF7}]$，构建独热编码矩阵 $Y$，其中第 $i$ 行等于对第 $i$ 个样本应用 $h$ 的结果：\n$$\nY=\\begin{pmatrix}\nh(\\text{MCF7})\\\\\nh(\\text{HeLa})\\\\\nh(\\text{A549})\\\\\nh(\\text{HeLa})\\\\\nh(\\text{MCF7})\n\\end{pmatrix}\n=\\begin{pmatrix}\n0  0  1\\\\\n0  1  0\\\\\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix}.\n$$\n每一列按顺序对应于 $(\\text{A549},\\text{HeLa},\\text{MCF7})$，每一行对应于原始序列中的样本。", "answer": "$$\\boxed{\\begin{pmatrix}0  0  1\\\\0  1  0\\\\1  0  0\\\\0  1  0\\\\0  0  1\\end{pmatrix}}$$", "id": "1426091"}, {"introduction": "我们如何用数值来表示像DNA这样长度可变的生物序列呢？本实践介绍了一种强大的方法——k-mer频率分析，它能将DNA序列转换为固定大小的数值向量，便于机器学习模型的处理。这项练习将带你完成从原始DNA序列到归一化特征向量的转换过程 [@problem_id:1426083]。", "problem": "在生物信息学中，机器学习模型常用于分析脱氧核糖核酸 (DNA) 序列。一个关键的预处理步骤涉及将这些由字符（A、C、G、T）组成的可变长度序列转换为固定大小的数值特征向量。一种常见的方法是 k-mer 频率分析。\n\n一个“k-mer”被定义为 DNA 序列中任意长度为 $k$ 的连续子序列。“k-mer 频率向量”是指对于给定序列，其分量为每种可能的 k-mer 的计数的一个向量，其中分量的顺序由 k-mer 的字典序（字母序）决定。对于 DNA，字典序为 A  C  G  T。\n\n为了确保来自不同长度序列的特征向量具有可比性，这些原始计数向量必须被归一化。其中一种技术是 L2 归一化，即原始频率向量的每个分量都除以该向量的欧几里得范数（其各分量平方和的平方根）。\n\n考虑以下 DNA 序列：\n`S = GATTACATATACCA`\n\n你的任务是为该序列生成 L2 归一化的 2-mer（$k=2$）特征向量。作为最终答案，请提供该归一化向量中对应于 2-mer `AT` 的分量值。将你的最终答案四舍五入到四位有效数字。", "solution": "一个 2-mer 是序列中任意连续的符号对。对于一个长度为 $n$ 的序列，有 $n-1$ 个重叠的 2-mer。对于 $S=\\text{GATTACATATACCA}$，$n=14$，因此有 $14-1=13$ 个 2-mer：\n$$\\text{GA},\\ \\text{AT},\\ \\text{TT},\\ \\text{TA},\\ \\text{AC},\\ \\text{CA},\\ \\text{AT},\\ \\text{TA},\\ \\text{AT},\\ \\text{TA},\\ \\text{AC},\\ \\text{CC},\\ \\text{CA}.$$\n计数出现次数得到\n$$\\text{AT}:3,\\quad \\text{TA}:3,\\quad \\text{AC}:2,\\quad \\text{CA}:2,\\quad \\text{GA}:1,\\quad \\text{TT}:1,\\quad \\text{CC}:1.$$\n令 $c(w)$ 表示 2-mer $w$ 的原始计数。对于给定的 2-mer $w$，其 L2 归一化分量为\n$$\\frac{c(w)}{\\left(\\sum_{u} c(u)^{2}\\right)^{1/2}},$$\n其中求和遍及所有可能的 2-mer。使用上述非零计数，\n$$\\left\\|c\\right\\|_{2}=\\left(3^{2}+3^{2}+2^{2}+2^{2}+1^{2}+1^{2}+1^{2}\\right)^{1/2}=\\left(29\\right)^{1/2}.$$\n对于 $w=\\text{AT}$，$c(\\text{AT})=3$，所以归一化分量为\n$$\\frac{3}{\\sqrt{29}}.$$\n数值上，\n$$\\frac{3}{\\sqrt{29}}\\approx 0.557086\\ldots,$$\n四舍五入到四位有效数字为\n$$0.5571.$$", "answer": "$$\\boxed{0.5571}$$", "id": "1426083"}, {"introduction": "构建数据预处理流程不仅仅是应用单个步骤，操作的顺序也至关重要。本问题挑战你批判性地思考移除异常值和数据归一化之间的相互作用。理解这种关系对于创建稳健可靠的分析工作流至关重要，因为顺序的选择会显著影响最终的分析结果 [@problem_id:1426104]。", "problem": "一位系统生物学学生正在分析一个特定酶在不同实验条件下测得的米氏常数（$K_m$）数据集。该数据集表示为一个正值列表：$X = \\{x_1, x_2, \\dots, x_N\\}$。由于测量误差，该学生怀疑数据集中存在异常值。目标是在进一步建模之前对数据进行预处理。考虑的两个预处理步骤是：\n\n1.  **异常值剔除**：识别并移除统计上的极端数据点。此操作通过丢棄某些点来修改数据集。\n2.  **Z-score标准化**：使用公式 $z_i = (x_i - \\mu) / \\sigma$ 将每个数据点 $x_i$ 转换为Z-score $z_i$，其中 $\\mu$ 是数据集的样本均值，$\\sigma$ 是样本标准差。\n\n该学生不确定应用这两个步骤的正确顺序。考虑一个异常大的离群值对样本均值（$\\mu$）和样本标准差（$\\sigma$）计算的影响。基于此考虑，正确的程序顺序及其主要理由是什么？\n\nA. **顺序**：先标准化，再剔除异常值。**理由**：先进行标准化可以确保包括异常值在内的所有数据点都在同一尺度上，从而使异常值的识别更加稳健和客观。\n\nB. **顺序**：先剔除异常值，再标准化。**理由**：异常值会显著扭曲均值并夸大标准差。先将其剔除可以确保用于标准化的参数（$\\mu$ 和 $\\sigma$）更能代表非异常值数据的集中趋势和离散程度。\n\nC. **顺序**：先标准化，再剔除异常值。**理由**：Z-score专门用于识别异常值。因此，必须先计算所有点的Z-score，以找出哪些是异常值。\n\nD. **顺序**：先剔除异常值，再标准化。**理由**：剔除异常值会减小数据集的大小，从而简化并加速后续的标准化计算，而不会改变结果。\n\nE. **顺序**：顺序无关紧要。**理由**：由于两者都是数据处理技术，它们的顺序可以互换，并且对于非异常值点会得到相同的预处理数据集。", "solution": "设数据集为 $X=\\{x_{1},x_{2},\\dots,x_{N}\\}$，其样本均值和样本标准差为\n$$\n\\mu=\\frac{1}{N}\\sum_{i=1}^{N}x_{i},\\qquad \\sigma=\\sqrt{\\frac{1}{N-1}\\sum_{i=1}^{N}(x_{i}-\\mu)^{2}}.\n$$\n假设一个观测值，记为 $x_{o}$，相对于其余数据是一个异常大的异常值。设不包含该点的数据的均值为\n$$\n\\mu_{\\text{clean}}=\\frac{1}{N-1}\\sum_{i\\neq o}x_{i}.\n$$\n那么，完整样本的均值可以精确地写为\n$$\n\\mu=\\frac{1}{N}\\left(x_{o}+\\sum_{i\\neq o}x_{i}\\right)=\\frac{1}{N}x_{o}+\\frac{N-1}{N}\\mu_{\\text{clean}}=\\mu_{\\text{clean}}+\\frac{1}{N}\\bigl(x_{o}-\\mu_{\\text{clean}}\\bigr).\n$$\n因为 $x_{o}$ 很大，$\\mu$ 被项 $\\frac{1}{N}(x_{o}-\\mu_{\\text{clean}})$ 拉向 $x_{o}$。\n\n对于方差，根据定义，\n$$\n\\sigma^{2}=\\frac{1}{N-1}\\left[(x_{o}-\\mu)^{2}+\\sum_{i\\neq o}(x_{i}-\\mu)^{2}\\right].\n$$\n当 $|x_{o}|$ 相对于其他 $x_{i}$ 极大时，项 $(x_{o}-\\mu)^{2}$ 在总和中占主导地位，因此 $\\sigma^{2}$ 会因为异常值的存在而被夸大。在极端情况下，这得出了近似值\n$$\n\\sigma\\approx \\frac{1}{\\sqrt{N-1}}|x_{o}-\\mu|.\n$$\n因此，在受污染的数据上计算出的异常值的Z-score满足\n$$\n|z_{o}|=\\left|\\frac{x_{o}-\\mu}{\\sigma}\\right|\\approx \\sqrt{N-1},\n$$\n这表明，尽管 $x_{o}$ 在原始单位中可以任意大，但其Z-score并不会无限制地增长，因为 $\\sigma$ 会同时被夸大。此外，对于任何典型的非异常值 $x_{i}$，其Z-score\n$$\nz_{i}=\\frac{x_{i}-\\mu}{\\sigma}\n$$\n由于被夸大的 $\\sigma$ 和偏移的 $\\mu$，其Z-score的绝对值会减小，这使得如果在剔除异常值之前计算Z-score，通过Z-score识别异常值会变得不那么敏感。\n\n因此：\n- 如果先进行标准化，那么在 $z_{i}=(x_{i}-\\mu)/\\sigma$ 中使用的 $\\mu$ 和 $\\sigma$ 都会被 $x_{o}$ 扭曲，从而掩盖了异常值，并产生不能代表非异常值数据集中趋势和离散程度的Z-score。\n- 如果先剔除异常值（使用不依赖于受污染的 $\\mu$ 和 $\\sigma$ 的方法，例如基于IQR的规则或基于领域知识的阈值），然后计算\n$$\n\\mu_{\\text{clean}}=\\frac{1}{N'}\\sum_{i=1}^{N'}x_{i},\\qquad \\sigma_{\\text{clean}}=\\sqrt{\\frac{1}{N'-1}\\sum_{i=1}^{N'}(x_{i}-\\mu_{\\text{clean}})^{2}}\n$$\n在大小为 $N'$ 的清洗后样本上，用于后续Z-score标准化的参数就能代表非异常值数据。\n\n因此，正确的程序顺序是先剔除异常值，然后进行Z-score标准化。主要理由是异常值会显著扭曲均值并夸大标准差；先将其剔除会得到能反映非异常值数据集中趋势和离散程度的 $\\mu$ 和 $\\sigma$，从而改善标准化以及之后任何基于Z-score的异常值检测。这对应于选项B，而选项A、C、D和E是错误的，因为使用受污染的参数进行缩放并不能提高稳健性（A、C），计算上的便利不是主要的统计原因（D），而且顺序确实会改变最终的参数，从而改变标准化后的数据（E）。", "answer": "$$\\boxed{B}$$", "id": "1426104"}]}