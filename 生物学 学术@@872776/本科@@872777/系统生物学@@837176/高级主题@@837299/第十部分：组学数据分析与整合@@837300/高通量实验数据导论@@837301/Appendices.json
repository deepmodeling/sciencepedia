{"hands_on_practices": [{"introduction": "任何严谨的数据分析，第一步都是质量控制。高通量实验有时会因技术失误产生异常样本，在分析的初始阶段识别并处理这些样本至关重要。本练习将帮助你理解如何运用主成分分析（PCA）这一强大的可视化工具，在它影响下游分析结果之前，识别出这些潜在的离群样本。[@problem_id:1440854]", "problem": "一个研究团队正在研究癌组织和健康组织之间的分子差异。他们从一组患者中收集了10个肿瘤样本和10个相应的邻近健康组织样本。为了分析基因活性，他们对所有20个样本进行了核糖核酸（RNA）测序实验。该实验的原始输出是一个“计数矩阵”，其中每一行对应一个特定的基因，每一列对应20个生物样本中的一个。矩阵中每个单元格的值是一个整数，表示在该样本中映射到该基因的测序读数（reads）的数量。\n\n生成计数矩阵后，首席生物信息学家担心其中一个健康组织样本可能由于文库制备阶段疑似的技术错误而成为异常值。这可能意味着其整体基因表达谱与其他所有样本都截然不同。该团队的最终目标是进行统计分析，以识别在肿瘤组和健康组之间差异表达的基因。\n\n在进行任何统计比较或数据标准化之前，以下哪项质量控制（QC）程序是基于样本的整体表达谱与其他样本的关系来视觉识别潜在异常*样本*的最合适的*初始*步骤？\n\nA. 对计数矩阵应用一种标准化方法，例如M值的修剪均值（Trimmed Mean of M-values, TMM），以调整样本间测序深度的差异。\n\nB. 使用降维技术，例如主成分分析（Principal Component Analysis, PCA），将样本绘制在二维空间中，并目视检查远离主要聚类的样本。\n\nC. 对每个基因进行t检验，以确定在肿瘤组和健康组之间存在显著差异的基因的初步列表。\n\nD. 对每个基因，计算其在所有20个样本中的平均表达值和方差，然后过滤掉方差较低的基因。\n\nE. 生成火山图，该图绘制了每个基因的统计显著性（p值）与变化幅度（倍数变化）的关系。", "solution": "题目要求我们在进行任何标准化或统计检验之前，选择最合适的初始QC步骤，以根据整体表达谱关系视觉识别潜在的异常样本。\n\n其目标是以无监督的方式评估样本之间的关系，以检测某个样本是否在全局上与其他样本不同。在RNA测序的质量控制中，用于此目的的标准方法是使用无监督降维方法来可视化样本间的距离。主成分分析（Principal Component Analysis, PCA）被广泛用于将高维的基因表达谱投影到低维空间（通常是前两个主成分），以便能够目视检查聚类和异常值。因此，通过PCA绘制样本图直接满足了识别远离主要聚类的样本的要求。\n\n针对此目标评估每个选项：\n- 选项A（TMM标准化）是一个标准化步骤，而不是一种可视化方法，并且题目明确将此操作定义为在标准化和差异检验之前的QC可视化步骤。尽管标准化对于下游分析和改进PCA很重要，但它本身并不是检测异常值的可视化QC步骤。\n- 选项B（PCA）是一种无监督的、全局的、可视化的QC方法，通过检查样本在主成分空间中与主要聚类的距离来检测异常样本，这正符合要求。\n- 选项C（对每个基因进行t检验）是一种有监督的差异表达分析，而不是初始QC步骤，并且在QC之前不当地进行了统计检验。\n- 选项D（过滤低方差基因）是一个特征选择步骤，可能会改善某些分析的信号，但它不是一种可视化或识别异常样本的方法，并且不应在初始QC之前执行。\n- 选项E（火山图）需要统计检验结果，并且不是针对样本级别异常值的初始QC可视化方法。\n\n因此，基于整体表达谱关系视觉识别潜在异常样本的最合适的初始QC程序是PCA。\n\n因此，正确选项是B。", "answer": "$$\\boxed{B}$$", "id": "1440854"}, {"introduction": "确认数据质量后，下一步便是量化生物学效应。本练习专注于计算对数2倍数变化（log2 fold change），这是描述基因在两种条件下表达水平变化程度的基本指标。你还将学习在这些计算中使用“伪计数”（pseudocount）的实际必要性，以处理低表达基因并确保计算的稳定性。[@problem_id:1440835]", "problem": "一个分子生物学家团队正在研究一种癌细胞系对新型治疗剂 `Compound-Z` 的转录响应。他们进行了一项RNA测序实验来测量基因表达水平。该实验包括对照组的三个生物学重复（用载体溶液处理的细胞）和处理组的三个生物学重复（暴露于 `Compound-Z` 的细胞）。对于一个特定的目标基因 `TFG-1`，其原始表达计数记录如下：\n\n-   **对照组计数：** 38, 51, 44\n-   **处理组计数：** 285, 330, 297\n\n在生物信息学分析中，为防止出现除以零的问题，并稳定低计数基因的倍数变化估计的方差，通常会在进一步计算之前，将一个称为“伪计数”的小常数加到每个原始计数值上。对于本题，您需要使用1作为伪计数。\n\n计算 `TFG-1` 表达的log2倍数变化。其定义为，在对所有原始测量值应用伪计数后，处理组平均表达量与对照组平均表达量之比的以2为底的对数。将您的最终答案四舍五入到三位有效数字。", "solution": "我们给定的对照组计数为 $38,51,44$，处理组计数为 $285,330,297$。将伪计数 $p=1$ 加到每个原始测量值上。\n\n计算经伪计数调整后的组均值：\n$$\\bar{C}=\\frac{(38+1)+(51+1)+(44+1)}{3}=\\frac{39+52+45}{3}=\\frac{136}{3},$$\n$$\\bar{T}=\\frac{(285+1)+(330+1)+(297+1)}{3}=\\frac{286+331+298}{3}=\\frac{915}{3}=305.$$\n\n倍数变化是处理组均值与对照组均值之比：\n$$\\mathrm{FC}=\\frac{\\bar{T}}{\\bar{C}}=\\frac{305}{136/3}=\\frac{915}{136}.$$\n\nlog2倍数变化为\n$$\\log_{2}(\\mathrm{FC})=\\log_{2}\\!\\left(\\frac{915}{136}\\right)=\\frac{\\ln\\!\\left(\\frac{915}{136}\\right)}{\\ln 2}\\approx 2.750165\\ldots$$\n\n四舍五入到三位有效数字，得到 $2.75$。", "answer": "$$\\boxed{2.75}$$", "id": "1440835"}, {"introduction": "基因表达的巨大变化并不总是可靠的发现。统计显著性（以p值表示）不仅取决于变化的幅度，还取决于重复样本间数据的一致性。本练习将挑战你批判性地思考，为何一个具有巨大倍数变化的基因可能在统计上并不显著，这是避免假阳性结果的关键概念。[@problem_id:1440845]", "problem": "一位初级生物信息学家正在分析一项核糖核酸（RNA）测序实验的数据，该实验旨在鉴定受一种新型抗癌药物影响的基因。该实验比较了用药处理的癌细胞系与未经处理的对照组的基因表达水平，每种条件都有多个生物学重复。\n\n对数千个被测基因的分析得出了两个关键指标：\n1.  **Log2(倍数变化)：**衡量表达变化幅度的指标。$+2$ 的值意味着该基因在处理组中的表达量是 $2^2=4$ 倍。$-2$ 的值意味着其表达量是 $2^{-2}=1/4$ 倍。\n2.  **$p$值：** 假设药物没有实际效果（即原假设），观测到至少与测量值一样极端的倍数变化的概率。一个小的$p$值（例如，小于$0.05$）表明观测到的变化具有统计显著性，并且不太可能是由随机机会造成的。\n\n这位生物信息学家发现一个名为GEN-X的特定基因，其Log2(倍数变化)非常大，为+6.0。然而，计算出的相应$p$值为0.35。一位资深科学家审查了这一结果，并立即得出结论：尽管GEN-X的平均表达量发生了巨大变化，但仅凭这些数据，它并不是一个有力的药物靶点候选者。\n\n下列哪个陈述为“一个基因具有非常大的倍数变化，同时p值却很高（不显著）”这一现象提供了最准确、最根本的统计学解释？\n\nA. 用于计算p值的数学模型已知对高表达基因不准确，本应使用另一种统计检验方法。\n\nB. +6.0的Log2(倍数变化)在生物学上是不太可能的，因此必定是由于针对该特定基因的样本存在技术错误或污染所致。\n\nC. 巨大的平均倍数变化伴随着实验组内重复样本之间表达水平的极高变异性，从而降低了结果的统计置信度。\n\nD. p值只是衡量原假设为真的概率，因此0.35的值意味着药物有35%的可能性没有效果，这对于临床应用来说太高了。\n\nE. 高p值表明，虽然倍数变化很大，但变化的方向不一致；一些重复样本显示上调，而另一些则显示下调。", "solution": "此题的目标是理解实验生物学中三个关键统计概念之间的关系：效应大小（由倍数变化衡量）、统计显著性（由p值衡量）和数据变异性（方差）。\n\n**步骤1：理解各项指标**\n- **Log2(倍数变化)为+6.0：**这代表**效应大小**。+6.0的值意味着在药物处理组中，GEN-X的平均表达量比对照组高$2^6 = 64$倍。这是一个非常大的表观效应。该值通常由每组中重复样本的*平均*表达水平计算得出。\n- **p值为0.35：**这代表**统计显著性**。像0.35这样的高p值意味着，如果我们假设药物没有实际效果（即原假设为真），那么仅由实验中的随机变异，就有35%的概率观测到如此大小或更大的倍数变化。按照惯例，p值必须很低（例如  0.05）才能拒绝原假设，并声称结果是“统计显著的”。当p值为0.35时，我们无法拒绝原假设；我们无法确信观测到的变化是真实的。\n\n**步骤2：联系效应大小、方差和显著性**\n核心问题是：一个巨大的效应大小（64倍的平均变化）怎么会不具有统计显著性？\n\n统计检验，例如Student's t-test（或用于RNA-seq的更复杂的模型，如DESeq2或edgeR中的模型），其基本原理是将效应大小与数据的变异性进行比较。检验统计量的一个简化概念公式是：\n\n$$ \\text{Test Statistic} = \\frac{\\text{Signal}}{\\text{Noise}} = \\frac{\\text{Difference between group means}}{\\text{Variability within groups (Standard Error)}} $$\n\n- **分子**（信号）与倍数变化相关。大的倍数变化意味着大的分子。\n- **分母**（噪音）是衡量我们对均值估计不确定性的指标。它直接由每组内部数据点（重复样本的表达水平）的**方差**计算得出。高方差意味着高噪音。\n\np值是由这个检验统计量计算出来的。要得到一个高（不显著）的p值，检验统计量必须很小。在我们的例子中，我们知道分子（信号）很大，因为倍数变化很大。要使整个检验统计量变小，唯一的方法就是分母（噪音）也非常大，甚至相对于信号来说更大。\n\n一个非常大的分母意味着GEN-X在重复样本中的表达水平的变异性极高。例如，处理组的表达值可能是(10, 50, 1000)，而对照组是(0.5, 1, 15)。处理组的平均表达量远高于对照组的平均表达量，从而导致了巨大的倍数变化。然而，每组*内部*数值的巨大离散程度（高方差）使得我们无法自信地断定平均值的差异是由于药物作用，而不仅仅是该基因在细胞中随机、不一致的行为。高p值正反映了这种信心的缺乏。\n\n**步骤3：评估各个选项**\n\n*   **A. 用于计算p值的数学模型已知对高表达基因不准确，本应使用另一种统计检验方法。**\n    这是不正确的。虽然选择正确的统计模型很重要，但效应大小因方差过大而不显著的现象是统计学的基础，并且可能在任何有效的检验中发生。它不是特定模型对高表达基因存在局限性而产生的人为结果。\n\n*   **B. +6.0的Log2(倍数变化)在生物学上是不太可能的，因此必定是由于针对该特定基因的样本存在技术错误或污染所致。**\n    这是不正确的。64倍的变化虽然很大，但在生物学上并非完全不可能，特别是对于那些从接近零的基础表达变为被强烈激活的基因。在没有进一步证据的情况下，不能仅凭其幅度就断定为错误。\n\n*   **C. 巨大的平均倍数变化伴随着实验组内重复样本之间表达水平的极高变异性，从而降低了结果的统计置信度。**\n    这是正确的解释。它准确地指出了组内高方差是导致大效应大小（倍数变化）可能产生低统计显著性（高p值）的原因。这是对该情景的直接统计学解释。\n\n*   **D. p值只是衡量原假设为真的概率，因此0.35的值意味着药物有35%的可能性没有效果，这对于临床应用来说太高了。**\n    这代表了对p值一种常见但错误的解释。p值是在*原假设为真*的条件下，观测到当前数据（或更极端数据）的概率。它**不是**原假设为真的概率。因此，该陈述基于一个错误的定义。\n\n*   **E. 高p值表明，虽然倍数变化很大，但变化的方向不一致；一些重复样本显示上调，而另一些则显示下调。**\n    这个说法看似合理，但不是最精确或最根本的原因。倍数变化是根据*平均*表达量计算的。+6.0的巨大正向倍数变化意味着处理组的平均值是对照组平均值的64倍。如果处理组的某些重复样本是下调的，这种情况极不可能发生。更直接、更确切的原因仅仅是组*内*数值的分布范围很广（即方差大），即使所有处理组的重复样本都高于所有对照组的重复样本。高方差是根本原因，这使得C成为更好的答案。\n\n因此，最准确的解释是重复样本间的高度变异性。", "answer": "$$\\boxed{C}$$", "id": "1440845"}]}