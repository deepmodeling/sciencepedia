{"hands_on_practices": [{"introduction": "在系统生物学中，整合来自不同分子层面的数据是理解复杂生物过程的关键。一个基本例子是分析从基因转录为mRNA到翻译为蛋白质之间的时间延迟，这有助于我们量化中心法则的动态过程。这项练习将通过计算一组基因的mRNA和蛋白质丰度峰值之间的平均时间差，让你初步体验时间序列多组学数据的整合[@problem_id:1467791]。", "problem": "在系统生物学领域，一个核心目标是理解从基因到功能性蛋白质的信息流。此过程的一个关键方面是基因转录为信使RNA（mRNA）与随后该mRNA翻译成蛋白质之间的时间延迟。一个研究小组对同步化的酵母细胞进行了一项时程实验，以测量几个参与细胞周期调控的关键基因的这一延迟。\n\n通过分析转录组（mRNA丰度）和蛋白质组（蛋白质丰度）数据，研究人员确定了在初始同步后，每种分子丰度达到峰值的时间点。下面提供了五个特定基因的数据。时间以分钟为单位，从细胞周期阶段开始时计算。\n\n- **基因 CLN2：** mRNA 峰值在 15 分钟；蛋白质峰值在 25 分钟。\n- **基因 CLB5：** mRNA 峰值在 32 分钟；蛋白质峰值在 50 分钟。\n- **基因 CDC20：** mRNA 峰值在 45 分钟；蛋白质峰值在 62 分钟。\n- **基因 SIC1：** mRNA 峰值在 60 分钟；蛋白质峰值在 71 分钟。\n- **基因 PDS1：** mRNA 峰值在 48 分钟；蛋白质峰值在 68 分钟。\n\n假设每个基因的时间滞后为其蛋白质峰值时间与其mRNA峰值时间之差，计算这组基因的平均时间滞后。答案以分钟为单位，四舍五入至三位有效数字。", "solution": "每个基因的时间滞后定义为蛋白质峰值时间减去mRNA峰值时间。对每个基因计算：\n$$\\Delta t_{\\text{CLN2}} = 25 - 15 = 10,$$\n$$\\Delta t_{\\text{CLB5}} = 50 - 32 = 18,$$\n$$\\Delta t_{\\text{CDC20}} = 62 - 45 = 17,$$\n$$\\Delta t_{\\text{SIC1}} = 71 - 60 = 11,$$\n$$\\Delta t_{\\text{PDS1}} = 68 - 48 = 20.$$\n\n这五个基因的平均时间滞后是其算术平均值：\n$$\\bar{\\Delta t} = \\frac{1}{5}\\left(10 + 18 + 17 + 11 + 20\\right) = \\frac{76}{5} = 15.2.$$\n四舍五入至三位有效数字，结果仍为$15.2$。", "answer": "$$\\boxed{15.2}$$", "id": "1467791"}, {"introduction": "在理解了如何整合不同类型数据后，下一步是建立量化模型来描述它们之间的关系。多元线性回归是一种强大的工具，可以用来预测一个变量（如代谢物丰度）如何依赖于多个其他变量（如酶的表达水平）。通过这个练习，你将应用普通最小二乘法来构建一个预测模型，从而深入理解基因表达如何影响代谢途径的产出[@problem_id:1467795]。", "problem": "一位系统生物学家正在研究一种生物发光细菌中关键代谢物 'Luminol-X' 的生物合成途径。该合成过程被认为遵循一个简单的两步酶促途径，其中前体物质在酶E1的作用下转化为中间体，然后该中间体在酶E2的作用下转化为Luminol-X。\n\n为了量化酶水平与代谢物产量之间的关系，该生物学家从 $n=10$ 个独立的细菌培养物中收集了数据。对于每个培养物 $i$，他们测量了酶E1（记为 $x_{1i}$）和酶E2（记为 $x_{2i}$）的基因表达水平，以及Luminol-X的最终丰度（记为 $y_i$）。基因表达以“相对表达单位”为单位进行测量，代谢物丰度以“相对丰度单位 (RAU)”为单位进行测量。\n\n该生物学家建议使用以下形式的多元线性回归模型来对代谢物丰度进行建模：\n$$y_i = \\beta_0 + \\beta_1 x_{1i} + \\beta_2 x_{2i} + \\epsilon_i$$\n其中 $\\beta_0, \\beta_1, \\beta_2$ 是回归系数，而 $\\epsilon_i$ 代表随机误差。\n\n从实验数据计算得出的汇总统计数据如下：\n- 样本数量，$n = 10$\n- 变量之和：\n    - $\\sum_{i=1}^{n} x_{1i} = 55.0$\n    - $\\sum_{i=1}^{n} x_{2i} = 55.0$\n    - $\\sum_{i=1}^{n} y_{i} = 328.0$\n- 平方和：\n    - $\\sum_{i=1}^{n} x_{1i}^2 = 385.0$\n    - $\\sum_{i=1}^{n} x_{2i}^2 = 385.0$\n- 交叉积之和：\n    - $\\sum_{i=1}^{n} x_{1i} x_{2i} = 336.0$\n    - $\\sum_{i=1}^{n} x_{1i} y_{i} = 2059.0$\n    - $\\sum_{i=1}^{n} x_{2i} y_{i} = 2110.0$\n\n使用普通最小二乘法，计算回归系数 $\\beta_1$ 的值，该系数代表酶E1表达对Luminol-X丰度的“效应”。将您的答案四舍五入到三位有效数字。该系数的单位为 `RAU / 相对表达单位`。", "solution": "我们通过多元线性回归对响应进行建模\n$$y_{i}=\\beta_{0}+\\beta_{1}x_{1i}+\\beta_{2}x_{2i}+\\epsilon_{i}.$$\n普通最小二乘估计量满足正规方程组\n$$(X^{\\top}X)\\hat{\\beta}=X^{\\top}y,$$\n其中 $X$ 的列由一列1、$x_{1}$ 和 $x_{2}$ 组成。斜率系数也可以等价地通过对变量进行中心化并求解以下方程组来获得：\n$$\\begin{pmatrix}S_{11}  S_{12} \\\\ S_{12}  S_{22}\\end{pmatrix}\\begin{pmatrix}\\hat{\\beta}_{1} \\\\ \\hat{\\beta}_{2}\\end{pmatrix}=\\begin{pmatrix}S_{1y} \\\\ S_{2y}\\end{pmatrix},$$\n其中\n$$\\bar{x}_{1}=\\frac{\\sum x_{1i}}{n},\\quad \\bar{x}_{2}=\\frac{\\sum x_{2i}}{n},\\quad \\bar{y}=\\frac{\\sum y_{i}}{n},$$\n$$S_{11}=\\sum x_{1i}^{2}-n\\bar{x}_{1}^{2},\\quad S_{22}=\\sum x_{2i}^{2}-n\\bar{x}_{2}^{2},\\quad S_{12}=\\sum x_{1i}x_{2i}-n\\bar{x}_{1}\\bar{x}_{2},$$\n$$S_{1y}=\\sum x_{1i}y_{i}-n\\bar{x}_{1}\\bar{y},\\quad S_{2y}=\\sum x_{2i}y_{i}-n\\bar{x}_{2}\\bar{y}.$$\n根据给定数据，计算均值：\n$$\\bar{x}_{1}=\\frac{55.0}{10}=5.5,\\quad \\bar{x}_{2}=\\frac{55.0}{10}=5.5,\\quad \\bar{y}=\\frac{328.0}{10}=32.8.$$\n计算中心化后的和：\n$$S_{11}=385.0-10\\cdot(5.5)^{2}=385.0-302.5=82.5,$$\n$$S_{22}=385.0-10\\cdot(5.5)^{2}=82.5,$$\n$$S_{12}=336.0-10\\cdot(5.5)(5.5)=336.0-302.5=33.5,$$\n$$S_{1y}=2059.0-10\\cdot(5.5)(32.8)=2059.0-1804.0=255.0,$$\n$$S_{2y}=2110.0-10\\cdot(5.5)(32.8)=2110.0-1804.0=306.0.$$\n使用克莱姆法则求解 $\\hat{\\beta}_{1}$：\n$$\\hat{\\beta}_{1}=\\frac{S_{22}S_{1y}-S_{12}S_{2y}}{S_{11}S_{22}-S_{12}^{2}}=\\frac{(82.5)(255.0)-(33.5)(306.0)}{(82.5)(82.5)-(33.5)^{2}}.$$\n计算分子和分母：\n$$(82.5)(255.0)=21037.5,\\quad (33.5)(306.0)=10251.0,$$\n$$(82.5)(82.5)=6806.25,\\quad (33.5)^{2}=1122.25,$$\n所以\n$$\\hat{\\beta}_{1}=\\frac{21037.5-10251.0}{6806.25-1122.25}=\\frac{10786.5}{5684}=1.89769595\\ldots$$\n四舍五入到三位有效数字，该系数为 $1.90$，单位为 RAU / 相对表达单位。", "answer": "$$\\boxed{1.90}$$", "id": "1467795"}, {"introduction": "现代系统生物学的一个前沿挑战是解析异质性组织样本（如肿瘤）中不同细胞类型的构成比例。一种尖端方法是利用单细胞多组学图谱作为参考，对“大块”组织数据进行“解卷积”。这项综合练习将引导你完成一个多步骤分析流程：首先利用给定的单细胞参考数据定义细胞类型特异性分子标志，然后构建一个线性混合模型来估算大块样本中各种细胞类型的比例，这充分展示了整合不同尺度和模态数据的强大能力[@problem_id:1467785]。", "problem": "在系统生物学中，对异质性整体组织样本的细胞组成进行解卷积是一项基本挑战。一种有效的方法是利用单细胞多组学参考图谱。\n\n一位研究人员使用一种技术，从一小块组织活检中生成了一个参考图谱，该技术可以同时分析相同单细胞的转录组和染色质可及性。对此单细胞数据进行了一项使用整合性非负矩阵分解 (iNMF) 的计算分析。iNMF 算法将单细胞RNA测序 (scRNA-seq) 表达矩阵和单细胞转座酶可及染色质测序 (scATAC-seq) 可及性矩阵分解为一个共享的细胞-因子矩阵 $H$ 和特定模态的特征-因子矩阵。\n\n该分析识别出 $K=3$ 个潜在因子，这些因子被确定对应于存在的三种主要细胞类型：神经元（因子1）、星形胶质细胞（因子2）和小胶质细胞（因子3）。得到的细胞-因子矩阵 $H \\in \\mathbb{R}_{\\ge 0}^{3 \\times 6}$ 提供了 $C=6$ 个单细胞中每一个在三个因子上的载荷。其形式如下：\n$$\nH = \\begin{pmatrix}\n9  8  1  1  2  1 \\\\\n1  1  8  9  1  2 \\\\\n1  2  1  1  8  9\n\\end{pmatrix}\n$$\n其中行对应因子1、2、3，列对应细胞 $c_1$ 到 $c_6$。\n\n相应的原始 scRNA-seq 基因表达计数矩阵 $X_{RNA} \\in \\mathbb{R}_{\\ge 0}^{4 \\times 6}$，对于 $G=4$ 个基因，其形式如下：\n$$\nX_{RNA} = \\begin{pmatrix}\n10  12  1  2  1  1 \\\\\n15  14  2  1  2  2 \\\\\n1  1  20  22  3  2 \\\\\n2  1  1  2  18  16\n\\end{pmatrix}\n$$\n其中行对应基因 $g_1, g_2, g_3, g_4$，列对应相同的六个细胞。\n\n另外，对来自同一来源的更大组织样本进行了整体蛋白质组学测量。测量得到 $Q=2$ 种蛋白质的丰度向量 $y_{prot}$ 为：\n$$\ny_{prot} = \\begin{pmatrix} 6.1 \\\\ 6.15 \\end{pmatrix}\n$$\n已知蛋白质1是基因1的产物，蛋白质2是基因4的产物。\n\n您的任务是使用单细胞参考数据对整体蛋白质组学样本进行解卷积。假设如下：\n1.  每个单细胞属于其在矩阵 $H$ 中载荷最大的细胞类型（因子）。\n2.  一种细胞类型的蛋白质特征是相应基因在该类型所有单细胞中的平均基因表达量。\n3.  整体蛋白质组学向量是细胞类型蛋白质特征的线性组合，其权重为各自在整体样本中的比例。设神经元、星形胶质细胞和小胶质细胞的比例分别为 $p_N, p_A, p_M$，其中 $p_N+p_A+p_M=1$。\n\n计算整体组织样本中星形胶质细胞的比例 ($p_A$)。请将您的答案表示为保留三位有效数字的小数。", "solution": "iNMF 细胞-因子矩阵 $H$ 将每个细胞分配给其载荷最大的因子：\n- 对于 $c_{1}$：$(9,1,1)$，所以是神经元。\n- 对于 $c_{2}$：$(8,1,2)$，所以是神经元。\n- 对于 $c_{3}$：$(1,8,1)$，所以是星形胶质细胞。\n- 对于 $c_{4}$：$(1,9,1)$，所以是星形胶质细胞。\n- 对于 $c_{5}$：$(2,1,8)$，所以是小胶质细胞。\n- 对于 $c_{6}$：$(1,2,9)$，所以是小胶质细胞。\n\n因此，神经元：$\\{c_{1},c_{2}\\}$，星形胶质细胞：$\\{c_{3},c_{4}\\}$，小胶质细胞：$\\{c_{5},c_{6}\\}$。\n\n每种细胞类型的蛋白质特征是其相应基因在所属细胞中的平均表达量。蛋白质1对应基因1（$X_{RNA}$ 的第1行），蛋白质2对应基因4（$X_{RNA}$ 的第4行）。从\n$$\nX_{RNA}=\\begin{pmatrix}\n10  12  1  2  1  1 \\\\\n15  14  2  1  2  2 \\\\\n1  1  20  22  3  2 \\\\\n2  1  1  2  18  16\n\\end{pmatrix},\n$$\n我们为每种细胞类型计算：\n\n- 神经元 ($c_{1},c_{2}$)：基因1平均值 $=\\frac{10+12}{2}=11$，基因4平均值 $=\\frac{2+1}{2}=1.5$。因此 $s_{N}=\\begin{pmatrix}11\\\\1.5\\end{pmatrix}$。\n- 星形胶质细胞 ($c_{3},c_{4}$)：基因1平均值 $=\\frac{1+2}{2}=1.5$，基因4平均值 $=\\frac{1+2}{2}=1.5$。因此 $s_{A}=\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}$。\n- 小胶质细胞 ($c_{5},c_{6}$)：基因1平均值 $=\\frac{1+1}{2}=1$，基因4平均值 $=\\frac{18+16}{2}=17$。因此 $s_{M}=\\begin{pmatrix}1\\\\17\\end{pmatrix}$。\n\n设整体蛋白质组学向量为 $y_{prot}=\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}$。具有比例 $p_{N},p_{A},p_{M}$ 且 $p_{N}+p_{A}+p_{M}=1$ 的线性混合模型是\n$$\n\\begin{pmatrix}6.1\\\\6.15\\end{pmatrix}\n= p_{N}\\begin{pmatrix}11\\\\1.5\\end{pmatrix}\n+ p_{A}\\begin{pmatrix}1.5\\\\1.5\\end{pmatrix}\n+ p_{M}\\begin{pmatrix}1\\\\17\\end{pmatrix}.\n$$\n按分量展开，得到\n$$\n11p_{N}+1.5p_{A}+1p_{M}=6.1,\\qquad 1.5p_{N}+1.5p_{A}+17p_{M}=6.15,\\qquad p_{N}+p_{A}+p_{M}=1.\n$$\n使用 $p_{A}=1-p_{N}-p_{M}$ 并代入前两个方程：\n$$\n11p_{N}+1.5(1-p_{N}-p_{M})+p_{M}=6.1 \\;\\Rightarrow\\; 9.5p_{N}-0.5p_{M}=4.6,\n$$\n$$\n1.5p_{N}+1.5(1-p_{N}-p_{M})+17p_{M}=6.15 \\;\\Rightarrow\\; 15.5p_{M}=4.65 \\;\\Rightarrow\\; p_{M}=\\frac{4.65}{15.5}=\\frac{93}{310}=0.3.\n$$\n然后从 $9.5p_{N}-0.5p_{M}=4.6$ 可得，\n$$\n9.5p_{N}-0.5\\cdot 0.3=4.6 \\;\\Rightarrow\\; 9.5p_{N}=4.75 \\;\\Rightarrow\\; p_{N}=\\frac{4.75}{9.5}=0.5.\n$$\n最后，\n$$\np_{A}=1-p_{N}-p_{M}=1-0.5-0.3=0.2.\n$$\n保留三位有效数字， $p_{A}=0.200$。", "answer": "$$\\boxed{0.200}$$", "id": "1467785"}]}