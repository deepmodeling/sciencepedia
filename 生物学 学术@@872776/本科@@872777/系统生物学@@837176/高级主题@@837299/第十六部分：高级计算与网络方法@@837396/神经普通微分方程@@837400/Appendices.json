{"hands_on_practices": [{"introduction": "神经 ODE 的核心是一个定义系统动态的神经网络。理解这个网络的结构——特别是其可学习参数的数量——是构建和评估这些模型的第一步。这个练习将帮助你把生物系统的维度（例如，蛋白质的数量）与定义其动态的神经网络的架构和复杂性具体联系起来[@problem_id:1453836]。", "problem": "在系统生物学领域，研究人员旨在为生物网络的复杂动力学建模。一种现代方法是使用神经微分方程（Neural ODE）从时间序列数据中学习其控制方程。\n\n考虑一个简化的信号通路，其中包含 $N_p = 5$ 种不同的蛋白质。该系统在任意时间 $t$ 的状态由一个状态向量 $\\mathbf{y}(t) \\in \\mathbb{R}^{N_p}$ 描述，其中 $\\mathbf{y}(t)$ 的第 $i$ 个分量表示第 $i$ 种蛋白质的浓度。其动力学由自治常微分方程系统 $\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y}; \\theta)$ 建模，其中函数 $f$ 由一个全连接前馈神经网络表示。该网络将当前状态向量 $\\mathbf{y}$ 作为输入，并输出其时间导数 $\\frac{d\\mathbf{y}}{dt}$。网络的全部可学习参数用 $\\theta$ 表示。\n\n这个神经网络的架构如下：\n1.  一个接收状态向量 $\\mathbf{y}$ 的输入层。\n2.  一个包含 $N_h = 32$ 个神经元的隐藏层。\n3.  一个生成导数向量 $\\frac{d\\mathbf{y}}{dt}$ 的输出层。\n\n每一层都与下一层全连接，没有任何跳跃连接。隐藏层和输出层各自都有自己的偏置向量。\n\n计算神经网络函数 $f$ 中可学习参数的总数（即所有权重和偏置的总和）。", "solution": "该网络实现了一个从维度为 $N_{p}$ 的输入到大小为 $N_{h}$ 的隐藏层，然后再到维度为 $N_{p}$ 的输出的映射。对于一个从大小为 $a$ 到大小为 $b$ 的全连接层，权重的数量是 $ba$，偏置的数量是 $b$。\n\n隐藏层参数：\n- 从输入层到隐藏层的权重：$N_{h} \\times N_{p}$。\n- 隐藏层的偏置：$N_{h}$。\n\n输出层参数：\n- 从隐藏层到输出层的权重：$N_{p} \\times N_{h}$。\n- 输出层的偏置：$N_{p}$。\n\n因此，可学习参数的总数为\n$$\n(N_{h}N_{p} + N_{h}) + (N_{p}N_{h} + N_{p}) = 2N_{p}N_{h} + N_{h} + N_{p}.\n$$\n代入 $N_{p} = 5$ 和 $N_{h} = 32$ 得\n$$\n2 \\cdot 5 \\cdot 32 + 32 + 5 = 320 + 37 = 357.\n$$", "answer": "$$\\boxed{357}$$", "id": "1453836"}, {"introduction": "真实的生物系统经常会受到离散事件的干扰，例如药物注射或环境的突然变化。这个练习将向你展示如何在一个连续时间的常微分方程框架内，对这类“跳跃”事件进行建模。掌握这项技能对于创建现实的生物干预模拟至关重要[@problem_id:1453781]。", "problem": "在一个简化的系统生物学模型中，蛋白质“P”的浓度（记作 $z(t)$，单位为微摩尔/升（$\\mu M$））是使用神经普通微分方程（Neural ODE）进行建模的。系统的动力学由以下方程控制：\n$$\n\\frac{dz(t)}{dt} = f_\\theta(z(t))\n$$\n其中函数 $f_\\theta$ 是一个非常简单的神经网络层，表示为一个不含偏置项的线性变换：$f_\\theta(z) = w \\cdot z$。参数 $w$ 代表蛋白质P生成和降解的净速率常数。\n\n系统在时间 $t=0$ 时具有一个初始浓度。在稍后的某个特定时间，一位研究人员向细胞培养物中注射一种化合物，导致蛋白质P的浓度发生瞬时变化。\n\n给定以下参数：\n- 初始浓度（$t=0$时）：$z_0 = 10.0$ $\\mu M$\n- 神经ODE参数：$w = -0.50$ $s^{-1}$\n- 注射时间：$t_{inject} = 2.0$ $s$\n- 因注射引起的瞬时浓度增加：$\\Delta z = 50.0$ $\\mu M$\n\n计算在最终时间 $t_{final} = 4.0$ $s$ 时蛋白质P的浓度。最终答案以微摩尔/升（$\\mu M$）为单位表示，并四舍五入到三位有效数字。", "solution": "给定神经ODE $\\frac{dz(t)}{dt} = w z(t)$，在 $t = t_{\\text{inject}}$ 时有一个跳跃（瞬时增加）$\\Delta z$。对于 $0 \\leq t  t_{\\text{inject}}$，该线性ODE的解可通过分离变量法得到：\n$$\n\\frac{dz}{z} = w \\, dt \\quad \\Rightarrow \\quad \\ln|z| = w t + C \\quad \\Rightarrow \\quad z(t) = C \\exp(w t).\n$$\n应用初始条件 $z(0) = z_{0}$ 得到 $C = z_{0}$，因此\n$$\nz(t) = z_{0} \\exp(w t), \\quad 0 \\leq t  t_{\\text{inject}}.\n$$\n在注射点的左极限为\n$$\nz\\!\\left(t_{\\text{inject}}^{-}\\right) = z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right).\n$$\n注射导致一个瞬时跳跃：\n$$\nz\\!\\left(t_{\\text{inject}}^{+}\\right) = z\\!\\left(t_{\\text{inject}}^{-}\\right) + \\Delta z = z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right) + \\Delta z.\n$$\n对于 $t \\geq t_{\\text{inject}}$，动力学再次遵循 $\\frac{dz}{dt} = w z$，初始条件为在 $t_{\\text{inject}}$ 时的 $z\\!\\left(t_{\\text{inject}}^{+}\\right)$，得到\n$$\nz(t) = z\\!\\left(t_{\\text{inject}}^{+}\\right) \\exp\\!\\left(w (t - t_{\\text{inject}})\\right).\n$$\n在 $t = t_{\\text{final}}$ 处求值并合并各项，得到闭合形式解\n$$\nz(t_{\\text{final}}) = \\left[z_{0} \\exp\\!\\left(w t_{\\text{inject}}\\right) + \\Delta z \\right] \\exp\\!\\left(w (t_{\\text{final}} - t_{\\text{inject}})\\right) = z_{0} \\exp\\!\\left(w t_{\\text{final}}\\right) + \\Delta z \\exp\\!\\left(w (t_{\\text{final}} - t_{\\text{inject}})\\right).\n$$\n现在代入给定值 $z_{0} = 10.0$，$w = -0.50$，$t_{\\text{inject}} = 2.0$，$t_{\\text{final}} = 4.0$ 以及 $\\Delta z = 50.0$：\n$$\nz(4.0) = 10.0 \\exp(-2.0) + 50.0 \\exp(-1.0).\n$$\n数值上，\n$$\n\\exp(-2.0) \\approx 0.1353352832, \\quad \\exp(-1.0) \\approx 0.3678794412,\n$$\n所以\n$$\nz(4.0) \\approx 10.0 \\times 0.1353352832 + 50.0 \\times 0.3678794412 \\approx 1.353352832 + 18.39397206 \\approx 19.74732489.\n$$\n四舍五入到三位有效数字，在 $t_{\\text{final}} = 4.0$ s 时的浓度是 19.7 微摩尔/升。", "answer": "$$\\boxed{19.7}$$", "id": "1453781"}, {"introduction": "训练好一个神经 ODE 后，我们得到了一个描述系统动态的“黑箱”函数 $f(\\mathbf{y}; \\theta)$。下一步是理解这个模型预测了什么样的行为。这个练习将演示如何运用来自经典动力系统理论的工具，例如线性稳定性分析，来探索模型的内在特性，比如识别对应于可观测生物表型的稳定平衡点[@problem_id:1453817]。", "problem": "一位系统生物学家正在使用神经微分方程 (Neural ODE) 来为一个合成双稳态基因开关的动力学建模。系统状态由一个二维向量 $\\mathbf{y}(t) = [y_1(t), y_2(t)]^T$ 描述，代表两种相互抑制的蛋白质的浓度。该动力学由方程 $\\frac{d\\mathbf{y}}{dt} = f(\\mathbf{y})$ 控制，其中 $f$ 是一个由神经网络学习得到的向量场。\n\n模型训练后，识别出了三个平衡点（也称为不动点或稳态），在这些点上 $f(\\mathbf{y}) = \\mathbf{0}$。我们将这些点标记为 $\\mathbf{y}_A$、$\\mathbf{y}_B$ 和 $\\mathbf{y}_C$。为了分析这些平衡点的稳定性，在每个点上计算了雅可比矩阵 $J(\\mathbf{y}) = \\frac{\\partial f}{\\partial \\mathbf{y}}$。得到的矩阵如下：\n\n对于点 $\\mathbf{y}_A$：\n$$ J_A = \\begin{pmatrix} -1  -3 \\\\ -3  -1 \\end{pmatrix} $$\n\n对于点 $\\mathbf{y}_B$：\n$$ J_B = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} $$\n\n对于点 $\\mathbf{y}_C$：\n$$ J_C = \\begin{pmatrix} -2  1 \\\\ 1  -2 \\end{pmatrix} $$\n\n基于对这些雅可比矩阵的线性稳定性分析，判断每个平衡点的性质。如果小扰动随时间衰减，使系统返回平衡状态，则该稳态被分类为“稳定”的。如果小扰动增长，导致系统偏离平衡状态，则该稳态是“不稳定”的。鞍点是一种特殊类型的不稳定平衡点。\n\n下列哪个陈述正确地分类了这三个平衡点？\n\nA. $\\mathbf{y}_A$：稳定节点，$\\mathbf{y}_B$：鞍点，$\\mathbf{y}_C$：鞍点\n\nB. $\\mathbf{y}_A$：鞍点，$\\mathbf{y}_B$：稳定节点，$\\mathbf{y}_C$：稳定节点\n\nC. $\\mathbf{y}_A$：稳定节点，$\\mathbf{y}_B$：稳定节点，$\\mathbf{y}_C$：稳定节点\n\nD. $\\mathbf{y}_A$：不稳定节点，$\\mathbf{y}_B$：鞍点，$\\mathbf{y}_C$：鞍点\n\nE. $\\mathbf{y}_A$：鞍点，$\\mathbf{y}_B$：不稳定节点，$\\mathbf{y}_C$：不稳定节点", "solution": "为了通过线性稳定性对每个平衡点进行分类，我们使用线性化原理：对于一个系统 $\\dot{\\mathbf{y}}=f(\\mathbf{y})$ 及其平衡点 $\\mathbf{y}^{\\ast}$，在 $\\mathbf{y}^{\\ast}$ 附近的扰动 $\\mathbf{z}=\\mathbf{y}-\\mathbf{y}^{\\ast}$ 的动力学由 $\\dot{\\mathbf{z}}=J(\\mathbf{y}^{\\ast})\\mathbf{z}$ 控制。沿着 $J(\\mathbf{y}^{\\ast})$ 的一个特征值为 $\\lambda$ 的特征向量 $v$，解的行为表现为 $\\mathbf{z}(t)=c\\,\\exp(\\lambda t)v$。因此，如果所有特征值的实部都为负，则平衡点是稳定的（对于实特征值是节点）；如果至少有一个特征值的实部为正，而另一个的实部为负，则为鞍点（不稳定）；如果所有特征值的实部都为正，则为不稳定节点。\n\n通过特征多项式 $\\det(J-\\lambda I)=0$ 计算每个雅可比矩阵的特征值。\n\n对于 $\\mathbf{y}_{A}$，其雅可比矩阵为 $J_{A}=\\begin{pmatrix}-1  -3 \\\\ -3  -1\\end{pmatrix}$：\n$$\n\\det\\!\\begin{pmatrix}-1-\\lambda  -3 \\\\ -3  -1-\\lambda\\end{pmatrix}\n=(-1-\\lambda)^{2}-9=0.\n$$\n这得到 $(\\lambda+1)^{2}=9$，所以 $\\lambda=-1\\pm 3$，即 $\\lambda_{1}=2$ 和 $\\lambda_{2}=-4$。由于特征值符号相反，$\\mathbf{y}_{A}$ 是一个鞍点（不稳定）。\n\n对于 $\\mathbf{y}_{B}$，其雅可比矩阵为 $J_{B}=\\begin{pmatrix}-2  1 \\\\ 1  -2\\end{pmatrix}$：\n$$\n\\det\\!\\begin{pmatrix}-2-\\lambda  1 \\\\ 1  -2-\\lambda\\end{pmatrix}\n=(-2-\\lambda)^{2}-1=0.\n$$\n这得到 $(\\lambda+2)^{2}=1$，所以 $\\lambda=-2\\pm 1$，即 $\\lambda_{1}=-1$ 和 $\\lambda_{2}=-3$。两个特征值都是负实数，因此 $\\mathbf{y}_{B}$ 是一个稳定节点。\n\n对于 $\\mathbf{y}_{C}$，由于 $J_{C}=J_{B}$，其特征值相同，为 $\\lambda_{1}=-1$ 和 $\\lambda_{2}=-3$。因此，$\\mathbf{y}_{C}$ 也是一个稳定节点。\n\n因此，正确的分类是：$\\mathbf{y}_{A}$：鞍点，$\\mathbf{y}_{B}$：稳定节点，$\\mathbf{y}_{C}$：稳定节点，这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1453817"}]}