{"hands_on_practices": [{"introduction": "系统发育群落生态学的第一步，通常是量化一组物种中所包含的演化历史总量。系统发育多样性（Phylogenetic Diversity, PD）是实现这一目标最基本的度量，它计算了连接群落中所有成员的唯一演化路径的总分支长度。这项基础练习 [@problem_id:1872006] 将引导您为一个简单的假想群落直接计算PD值，从而帮助您构建解读系统发育树的核心技能。", "problem": "一位生态学家正在研究一个新发现的、孤立的火山口湖中的两栖动物群落组成。一项全面调查揭示了这里存在正好四种不同的两栖动物物种，我们称之为物种A、B、C和D。随后进行了一项分子分析，以重建这四个物种的进化历史。得出的系统发育树是有根的，其分支长度以百万年（myr）为单位进行校准，结构如下：\n\n1.  该系统发育树的根节点是所有四个物种的单一共同祖先。\n2.  从根节点，一个分支直接通向物种D的谱系。这个末端分支的长度是39.2百万年。\n3.  同样从根节点，另一个分支通向一个代表物种A、B和C最近共同祖先的节点。这个内部分支的长度是22.8百万年。\n4.  从(A, B, C)的祖先节点，一个分支直接通向物种C的谱系。这个末端分支的长度是16.4百万年。\n5.  同样从(A, B, C)的祖先节点，另一个分支通向一个代表物种A和B最近共同祖先的节点。这个内部分支的长度是11.3百万年。\n6.  最后，从(A, B)的祖先节点分出两个末端分支：一个通向物种A，长度为5.1百万年；另一个通向物种B，长度也为5.1百万年。\n\n用于量化群落中所代表的进化历史的一个关键指标是系统发育多样性（Phylogenetic Diversity, PD）。对于一个给定的群落，PD被定义为将该群落中存在的所有物种连接到系统发育树根节点的最小生成路径上所有分支长度的总和。\n\n计算在火山口湖中发现的两栖动物群落的总系统发育多样性（PD）。以百万年（myr）为单位表示您的最终答案，并四舍五入到三位有效数字。", "solution": "一组物种的系统发育多样性（PD）被定义为将这些物种连接到根的最小生成子树中所有分支长度的总和。对于包含所有四个物种A、B、C和D的群落，最小生成子树就是所描述的整个树。因此，PD等于树中所有唯一分支长度的总和。\n\n设 $L(e)$ 表示分支 $e$ 的长度。那么\n$$\n\\mathrm{PD}=\\sum_{e \\in E} L(e),\n$$\n其中 $E$ 包括以下分支：\n- 根到D: $L_{rD}=39.2$,\n- 根到ABC祖先: $L_{r,ABC}=22.8$,\n- ABC祖先到C: $L_{ABC,C}=16.4$,\n- ABC祖先到AB祖先: $L_{ABC,AB}=11.3$,\n- AB祖先到A: $L_{AB,A}=5.1$,\n- AB祖先到B: $L_{AB,B}=5.1$。\n\n将它们相加，\n$$\n\\mathrm{PD}=39.2+22.8+16.4+11.3+5.1+5.1.\n$$\n分步计算：\n$$\n39.2+22.8=62.0,\\quad 62.0+16.4=78.4,\\quad 78.4+11.3=89.7,\\quad 89.7+5.1=94.8,\\quad 94.8+5.1=99.9.\n$$\n因此，总PD为99.9百万年，这已经有三位有效数字。", "answer": "$$\\boxed{99.9}$$", "id": "1872006"}, {"introduction": "除了简单地衡量演化历史，我们还可以利用系统发育模式来推断塑造群落的生态过程。这项练习 [@problem_id:1871983] 介绍了净亲缘关系指数（Net Relatedness Index, NRI），这是一个强有力的工具，用于检验群落中的物种是否比随机预期的关系更近（系统发育聚集）或更远（系统发育超散）。通过为两种不同环境计算和比较NRI，您将学习如何将系统发育结构与环境过滤和竞争这两种潜在的组装机制联系起来。", "problem": "一位生态学家正在研究构建两种不同环境中植物群落的过程。Alpha样地的土壤胁迫性强、养分含量低，而Beta样地的土壤资源丰富、呈中性。该生态学家假设，在Alpha样地的胁迫环境中，群落构建将由生境过滤主导（即只有具备某些保守性状的物种才能生存），从而形成一个由亲缘关系较近的物种组成的群落。在Beta样地的良好环境中，她假设竞争将是主导力量，由于近缘物种相互竞争而被排除，从而形成一个由亲缘关系较远的物种组成的群落。\n\n为了检验这一假设，她从一个由五个物种（S1、S2、S3、S4、S5）组成的区域物种库中调查了这两个样地中存在的物种。她还编制了一个所有物种对之间的系统发育距离矩阵，距离以进化分歧的百万年（Mya）为单位。\n\n群落组成如下：\n- **Alpha样地群落**：{S1, S2, S3}\n- **Beta样地群落**：{S1, S3, S5}\n\n区域物种库的系统发育距离矩阵如下：\n$$\n\\begin{array}{c|ccccc}\n  \\text{S1}  \\text{S2}  \\text{S3}  \\text{S4}  \\text{S5} \\\\\n\\hline\n\\text{S1}  0  20  25  80  90 \\\\\n\\text{S2}  20  0  5  85  95 \\\\\n\\text{S3}  25  5  0  88  98 \\\\\n\\text{S4}  80  85  88  0  10 \\\\\n\\text{S5}  90  95  98  10  0 \\\\\n\\end{array}\n$$\n\n为了量化系统发育结构，她使用了净亲缘关系指数（NRI），这是一个衡量群落中物种总体亲缘关系的标准化指标。正的NRI值表示物种间的亲缘关系比随机预期的更近（系统发育聚集），表明存在生境过滤。负的NRI值表示物种间的亲缘关系比随机预期的更远（系统发育超散），表明存在竞争。NRI的计算公式为：\n$$\n\\text{NRI} = -1 \\times \\frac{\\text{MPD}_{\\text{obs}} - \\mu_{\\text{MPD}_{\\text{null}}}}{\\sigma_{\\text{MPD}_{\\text{null}}}}\n$$\n其中，$\\text{MPD}_{\\text{obs}}$ 是观测到的群落平均成对距离，计算方法为该群落内所有可能的物种对之间系统发育距离的平均值。通过一个从区域物种库中随机生成相同大小群落的零模型，确定了MPD的期望均值和标准差分别为 $\\mu_{\\text{MPD}_{\\text{null}}} = 60.0$ Mya 和 $\\sigma_{\\text{MPD}_{\\text{null}}} = 15.0$ Mya。\n\n计算Alpha样地和Beta样地的NRI，并选择正确报告其数值并结合生态学家的假说解释其生态学意义的选项。\n\nA. Alpha样地的NRI $\\approx 2.89$（系统发育聚集），Beta样地的NRI $\\approx -0.73$（系统发育超散）。这表明在Alpha样地，生境过滤是主导作用，而在Beta样地，竞争是主导作用。\n\nB. Alpha样地的NRI $\\approx -0.73$（系统发育超散），Beta样地的NRI $\\approx 2.89$（系统发育聚集）。这表明在Alpha样地，竞争是主导作用，而在Beta样地，生境过滤是主导作用。\n\nC. 两个样地都显示出系统发育聚集（正的NRI），表明生境过滤是两种环境中主要的群落构建过程。\n\nD. 两个样地都显示出系统发育超散（负的NRI），表明竞争是两种环境中主要的群落构建过程。\n\nE. 两个样地的NRI都接近于零，表明在这两种生境中，群落构建在系统发育方面是随机的。", "solution": "我们使用观测到的平均成对距离（MPD）的定义，对于一个大小为 $n$ 的群落，它是其物种间所有成对系统发育距离的平均值。对于 $n=3$，唯一的物种对数量为 $\\binom{3}{2}=3$，所以\n$$\n\\text{MPD}_{\\text{obs}}=\\frac{d_{12}+d_{13}+d_{23}}{3}.\n$$\n净亲缘关系指数（Net Relatedness Index）定义为\n$$\n\\text{NRI}=-\\frac{\\text{MPD}_{\\text{obs}}-\\mu_{\\text{MPD}_{\\text{null}}}}{\\sigma_{\\text{MPD}_{\\text{null}}}},\n$$\n其中 $\\mu_{\\text{MPD}_{\\text{null}}}=60.0$ 且 $\\sigma_{\\text{MPD}_{\\text{null}}}=15.0$。\n\n对于Alpha样地，群落为 $\\{\\text{S1},\\text{S2},\\text{S3}\\}$。从矩阵中得到的成对距离为 $d(\\text{S1},\\text{S2})=20$，$d(\\text{S1},\\text{S3})=25$ 和 $d(\\text{S2},\\text{S3})=5$。因此，\n$$\n\\text{MPD}_{\\text{obs, Alpha}}=\\frac{20+25+5}{3}=\\frac{50}{3}.\n$$\n然后\n$$\n\\text{NRI}_{\\text{Alpha}}=-\\frac{\\frac{50}{3}-60}{15}=-\\frac{\\frac{50-180}{3}}{15}=-\\frac{-130}{45}=\\frac{26}{9}\\approx 2.89,\n$$\n这是一个正值，表明系统发育聚集，与生境过滤的假说一致。\n\n对于Beta样地，群落为 $\\{\\text{S1},\\text{S3},\\text{S5}\\}$。成对距离为 $d(\\text{S1},\\text{S3})=25$，$d(\\text{S1},\\text{S5})=90$ 和 $d(\\text{S3},\\text{S5})=98$。因此，\n$$\n\\text{MPD}_{\\text{obs, Beta}}=\\frac{25+90+98}{3}=\\frac{213}{3}=71.\n$$\n然后\n$$\n\\text{NRI}_{\\text{Beta}}=-\\frac{71-60}{15}=-\\frac{11}{15}\\approx -0.73,\n$$\n这是一个负值，表明系统发育超散，与竞争的假说一致。\n\n因此，Alpha样地表现出系统发育聚集，Beta样地表现出系统发育超散，这与生态学家的假说相符。正确选项是A。", "answer": "$$\\boxed{A}$$", "id": "1871983"}, {"introduction": "在自然界中，生态过程很少独立作用；例如，环境梯度常常与地理距离相关联，这会混淆我们的分析。这项高级练习 [@problem_id:1872002] 介绍了一种关键的统计技术——偏Mantel检验，它使生态学家能够厘清这些相互关联的因素。通过完成此计算，您将理解如何统计控制一个混淆变量（如扩散限制），以分离出另一个变量（如生境过滤）对群落组成的真实影响。", "problem": "一位生态学家正在研究一个由25个孤立湖泊组成的区域性网络中，构建浮游动物群落的各种过程。目前主要考虑三个假说：\n1.  **生境过滤（Habitat Filtering）**：群落组成的差异主要由环境条件的差异（例如，pH值、温度、营养水平）驱动。\n2.  **扩散限制（Dispersal Limitation）**：群落组成的差异主要由湖泊之间的地理距离驱动，因为它限制了生物体的移动。\n3.  **系统发育生态位保守性/竞争（Phylogenetic Niche Conservatism/Competition）**：亲缘关系较近的物种具有相似的环境耐受性和竞争能力，这可能影响它们的共存模式。\n\n为了厘清这些效应，该生态学家构建了三个相异性矩阵，每个矩阵都比较了25个湖泊中所有可能的湖泊对：\n-   **群落相异性矩阵（$D_{comm}$）**：一个由Bray-Curtis相异性值组成的矩阵，量化了任意两个湖泊之间浮游动物群落的差异程度。\n-   **环境距离矩阵（$D_{env}$）**：一个由归一化欧几里得距离组成的矩阵，量化了任意两个湖泊之间环境条件的差异程度。\n-   **地理距离矩阵（$D_{geo}$）**：一个由任意两个湖泊之间直线地理距离组成的矩阵。\n\n使用简单Mantel检验的初步分析揭示了这些矩阵向量化的下三角矩阵之间的以下皮尔逊相关系数：\n-   群落相异性与环境距离之间的相关性：$r(D_{comm}, D_{env}) = 0.55$\n-   群落相异性与地理距离之间的相关性：$r(D_{comm}, D_{geo}) = 0.40$\n-   环境距离与地理距离之间的相关性：$r(D_{env}, D_{geo}) = 0.70$\n\n该生态学家观察到环境是空间结构化的（即，邻近的湖泊往往具有相似的环境，如较高的$r(D_{env}, D_{geo})$值所示）。为了分离环境对群落结构的纯粹影响，有必要控制地理距离的混淆效应。\n\n计算偏Mantel相关系数，该系数在统计上保持地理距离（$D_{geo}$）恒定的情况下，量化了群落相异性（$D_{comm}$）与环境距离（$D_{env}$）之间的关系。将您的最终答案四舍五入到三位有效数字。", "solution": "我们要求解在控制地理距离的情况下，群落相异性与环境距离之间的偏Mantel相关性。将向量化下三角矩阵之间的皮尔逊相关性表示为 $r_{xy} = r(D_{comm},D_{env})$、$r_{xz} = r(D_{comm},D_{geo})$ 和 $r_{yz} = r(D_{env},D_{geo})$。偏相关公式为\n$$\nr_{xy.z} = \\frac{r_{xy} - r_{xz}r_{yz}}{\\sqrt{\\left(1 - r_{xz}^{2}\\right)\\left(1 - r_{yz}^{2}\\right)}}.\n$$\n代入给定值 $r_{xy} = 0.55$、$r_{xz} = 0.40$ 和 $r_{yz} = 0.70$：\n$$\n\\text{numerator} = 0.55 - (0.40)(0.70) = 0.55 - 0.28 = 0.27,\n$$\n$$\n\\text{denominator} = \\sqrt{\\left(1 - 0.40^{2}\\right)\\left(1 - 0.70^{2}\\right)} = \\sqrt{(1 - 0.16)(1 - 0.49)} = \\sqrt{0.84 \\times 0.51} = \\sqrt{0.4284}.\n$$\n计算比率：\n$$\nr_{xy.z} = \\frac{0.27}{\\sqrt{0.4284}} \\approx \\frac{0.27}{0.65452273} \\approx 0.4125\\ldots\n$$\n四舍五入到三位有效数字，结果是 $0.413$。", "answer": "$$\\boxed{0.413}$$", "id": "1872002"}]}