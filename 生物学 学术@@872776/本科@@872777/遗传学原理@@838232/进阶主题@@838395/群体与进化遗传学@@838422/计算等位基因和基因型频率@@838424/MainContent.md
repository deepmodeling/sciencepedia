## 引言
在生命的宏伟蓝图中，演化是核心主题，而群体则是演化的基本单位。要理解物种如何适应、变化并产生多样性，我们必须首先能够量化群体内部的遗传构成。[群体遗传学](@entry_id:146344)正是为此而生，它使用数学工具来描述基因在群体中的[分布](@entry_id:182848)和传承规律。本文的核心议题——计算等位基因和[基因型频率](@entry_id:141286)，是进入这一领域的敲门砖。它解决了一个根本问题：我们如何将个体的遗传信息（基因型）转化为描述整个群体遗传特征的定量数据？通过掌握这些计算，我们将能够追踪遗传变异在代际间的传递，并判断演化是否正在发生。

本文将引导你系统地掌握[群体遗传学](@entry_id:146344)的基本分析方法。在第一章“原理与机制”中，你将学习计算等位基因和[基因型频率](@entry_id:141286)的基础方法，并深入理解作为演化“零假设”的哈迪-温伯格原理。随后的第二章“应用与跨学科联系”将视野拓宽，展示这些看似抽象的公式如何在[医学遗传学](@entry_id:262833)、物种保护、[法医学](@entry_id:170501)和进化研究等前沿领域中发挥关键作用。最后，在“动手实践”部分，你将有机会运用所学知识解决具体问题，巩固并深化对这些核心概念的理解。读完本文，你将不仅掌握一套计算技能，更能领会[群体遗传学](@entry_id:146344)作为连接微观基因与宏观生命现象的桥梁所具有的深刻意义。

## 原理与机制

[群体遗传学](@entry_id:146344)的核心是理解群体中基因变异的[分布](@entry_id:182848)规律及其随时间变化的动态过程。本章将深入探讨描述群体遗传结构的基本度量——[等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)的计算方法。在此基础上，我们将阐述群体遗传学的基石——哈迪-温伯格原理，并展示如何利用该原理来分析理想群体的遗传构成。最后，我们将讨论当理想条件被打破时，如存在迁移和自然选择等演化力量时，群体的[等位基因频率](@entry_id:146872)将如何发生改变。

### 基本概念：等位基因频率与[基因型频率](@entry_id:141286)

一个群体中的所有个体所携带的全部基因构成了一个**基因库 (gene pool)**。对于某个特定的[基因座](@entry_id:177958)，群体中可能存在多种不同的**等位基因 (alleles)**。我们在群体水平上描述遗传变异的两个基本指标是**[基因型频率](@entry_id:141286) (genotype frequency)** 和 **[等位基因频率](@entry_id:146872) (allele frequency)**。

**[基因型频率](@entry_id:141286)**是指群体中某一特定基因型的个体所占的比例。例如，对于一个由 $N$ 个个体组成的二倍体群体，如果[基因座](@entry_id:177958) $A$ 有两种等位基因（$A$ 和 $a$），那么群体中就存在三种基因型：$AA$、$Aa$ 和 $aa$。若它们的个体数分别为 $N_{AA}$、$N_{Aa}$ 和 $N_{aa}$，则三种[基因型频率](@entry_id:141286)分别为：

$f(AA) = \frac{N_{AA}}{N}$
$f(Aa) = \frac{N_{Aa}}{N}$
$f(aa) = \frac{N_{aa}}{N}$

其中 $N = N_{AA} + N_{Aa} + N_{aa}$。

**[等位基因频率](@entry_id:146872)**则是指在一个群体的[基因库](@entry_id:267957)中，某个特定等位基因所占的比例。对于一个[二倍体](@entry_id:268054)群体，每个个体有两个等位基因。因此，一个包含 $N$ 个个体的群体，其基因库中总共有 $2N$ 个等位基因。等位基因 $A$ 的频率，通常用 $p$ 表示，可以通过清[点群](@entry_id:142456)体中所有 $A$ 等位基因的数量并除以总等位基因数来计算。由于每个 $AA$ 个体携带两个 $A$ 等位基因，每个 $Aa$ 个体携带一个 $A$ 等位基因，因此 $A$ 的总数是 $2N_{AA} + N_{Aa}$。于是，等位基因 $A$ 和 $a$ 的频率（分别用 $p$ 和 $q$ 表示）可以计算如下：

$p = f(A) = \frac{2 N_{AA} + N_{Aa}}{2N}$

$q = f(a) = \frac{2 N_{aa} + N_{Aa}}{2N}$

显然，$p + q = 1$。

另一种等价的计算方法是利用[基因型频率](@entry_id:141286)：

$p = f(AA) + \frac{1}{2} f(Aa)$

$q = f(aa) + \frac{1}{2} f(Aa)$

当基因型可以直接从表型中推断时，这些计算就变得非常直接。例如，在[不完全显性](@entry_id:143623)或[共显性](@entry_id:142824)的情况下，[杂合子](@entry_id:276964)的表型与两种纯合子都不同。

设想一个对某种开花植物的野外研究，其花色由一对等位基因 $R$（红色）和 $W$（白色）控制，且表现为[不完全显性](@entry_id:143623)：$RR$ 基因型为红色花， $WW$ 为白色花，而 $RW$ 杂合子为粉色花。在一个包含200株植物的样本中，研究人员发现98株红花、84株粉花和18株白花。由于表型与基因型一一对应，我们可以直接得到基因型计数：$N_{RR}=98$，$N_{RW}=84$，$N_{WW}=18$。总样本数 $N=200$。利用上述公式，我们可以计算 $R$ 等位基因的频率 $p$ [@problem_id:1472691]：

$p = f(R) = \frac{2 \times N_{RR} + N_{RW}}{2N} = \frac{2 \times 98 + 84}{2 \times 200} = \frac{196 + 84}{400} = \frac{280}{400} = 0.70$

相应地，$W$ 等位基因的频率 $q = 1 - p = 0.30$。这个简单的例子 [@problem_id:1472683] 体现了从可观察数据中量化群体遗传变异的基本方法。

### 哈迪-温伯格原理：演化的[零假设](@entry_id:265441)模型

计算出一个群体当前的[等位基因频率](@entry_id:146872)后，一个自然而然的问题是：这些频率在下一代会如何变化？英国数学家 G. H. Hardy 和德国医生 Wilhelm Weinberg 在1908年各自独立地给出了答案，他们的结论被称为**哈迪-温伯格原理 (Hardy-Weinberg Principle)**，也称为哈迪-温伯格平衡 (Hardy-Weinberg Equilibrium, HWE)。

该原理指出，在一个满足特定条件的理想群体中，[等位基因频率](@entry_id:146872)和[基因型频率](@entry_id:141286)将代代保持不变。这些理想条件是：
1.  **群体极大** (不存在[遗传漂变](@entry_id:145594))。
2.  **[随机交配](@entry_id:149892)** (个体择偶不依赖于该[基因座](@entry_id:177958)的基因型)。
3.  **没有突变** (等位基因不会转变为其他形式)。
4.  **没有迁移** (没有来自或去往其他群体的基因流)。
5.  **没有自然选择** (所有基因型具有同等的生存和繁殖能力)。

在这些条件下，对于一个具有两个等位基因 $A$ 和 $a$（频率分别为 $p$ 和 $q$）的[基因座](@entry_id:177958)，子代的[基因型频率](@entry_id:141286)可以通过简单的概率论推导得出。随机交配等同于从[基因库](@entry_id:267957)中随机抽取两个等位基因来组成一个个体。因此，子代是 $AA$ 基因型的概率是 $p \times p = p^2$；是 $aa$ 基因型的概率是 $q \times q = q^2$；是 $Aa$ 基因型的概率则有两种方式（从父亲处获得 $A$ 且从母亲处获得 $a$，或反之），概率为 $(p \times q) + (q \times p) = 2pq$。

因此，在哈迪-温伯格平衡状态下，[基因型频率](@entry_id:141286)由[等位基因频率](@entry_id:146872)唯一确定：

$f(AA) = p^2$
$f(Aa) = 2pq$
$f(aa) = q^2$

并且，这些频率之和为 $p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$。

重要的是，处于平衡状态的群体，其下一代的等位基因频率将保持不变。新的等位基因频率 $p'$ 为：
$p' = f(AA) + \frac{1}{2} f(Aa) = p^2 + \frac{1}{2}(2pq) = p^2 + pq = p(p+q) = p \times 1 = p$
这证明了在理想条件下，遗传变异可以稳定地维持在群体中，群体并不会自动“退化”或失去变异。哈迪-温伯格原理因此构成了[群体遗传学](@entry_id:146344)的基石，它提供了一个**[零假设](@entry_id:265441)**：如果一个群体的[基因型频率](@entry_id:141286)偏离了HWE的预测，或者其[等位基因频率](@entry_id:146872)随时间发生了变化，那么就意味着至少有一个演化力量正在起作用。

#### 哈迪-温伯格原理的应用

哈迪-温伯格原理在实践中有广泛的应用，特别是在无法直接观察到所有基因型的情况下。

**1. 从[等位基因频率](@entry_id:146872)预测[基因型频率](@entry_id:141286)**
如果一个群体被假定处于HWE，并且我们知道其[等位基因频率](@entry_id:146872)，我们就可以预测其[基因型频率](@entry_id:141286)。例如，在一个假定处于HWE的植物群体中，已知显性等位基因 $P$ 的频率为 $p = 0.7$，那么纯合显性个体（$PP$）的期望频率就是 $p^2 = (0.7)^2 = 0.49$ [@problem_id:1472656]。同样，如果已知隐性等位基因 $d$ 的频率为 $q = 0.4$，那么显性等位基因 $D$ 的频率 $p = 1 - q = 0.6$。该群体中杂合基因型（$Dd$）的期望频率就是 $2pq = 2 \times 0.6 \times 0.4 = 0.48$ [@problem_id:1472682]。

**2. 从表型频率估算等位基因频率和[基因型频率](@entry_id:141286)**
当存在[完全显性](@entry_id:146900)时，我们无法从表型上区分纯合显性个体（$AA$）和杂合个体（$Aa$）。然而，只要群体处于HWE，我们仍然可以估算等位基因频率。关键在于，隐性表型个体必然是纯合隐性基因型（$aa$）。因此，隐性表型的频率就等于 $q^2$。

例如，一项研究发现，在一个假定处于HWE的人类群体中，某种[常染色体隐性遗传](@entry_id:270708)病的[发病率](@entry_id:172563)为 $0.04$。这意味着 $f(aa) = q^2 = 0.04$。由此我们可以计算隐性等位基因的频率 [@problem_id:1472635]：
$q = \sqrt{q^2} = \sqrt{0.04} = 0.2$

显性等位基因的频率则为：
$p = 1 - q = 1 - 0.2 = 0.8$

更进一步，我们可以估算群体中携带者的频率（即杂合子频率）。在关于人类对苯硫脲（PTC）尝味能力的调查中，假设在一个包含25000人的大群体中，发现9100人是不能尝出味道的（隐性性状，基因型为 $tt$）。该群体被假定处于HWE。我们可以首先计算隐性表型的频率 [@problem_id:1472688]：

$f(tt) = q^2 = \frac{9100}{25000} = 0.364$

[隐性等位基因](@entry_id:274167) $t$ 的频率为：
$q = \sqrt{0.364} \approx 0.603$

显性等位基因 $T$ 的频率为：
$p = 1 - q \approx 1 - 0.603 = 0.397$

因此，杂合子（$Tt$，即携带者）的期望频率为：
$f(Tt) = 2pq \approx 2 \times 0.397 \times 0.603 \approx 0.479$

这个结果揭示了一个重要的现象：对于稀有的隐性遗传病，携带者（杂合子）在群体中的频率远高于患者（纯合隐性）的频率。

### 哈迪-温伯格原理的扩展

哈迪-温伯格模型可以被扩展以适应更复杂的遗传情景。

#### 多等位基因

许多[基因座](@entry_id:177958)在群体中存在两个以上的等位基因。例如人类的[ABO血型系统](@entry_id:271820)。HWE原理同样适用于这种情况。假设一个[基因座](@entry_id:177958)有三个等位基因，其频率分别为 $p$, $q$, 和 $r$，且 $p+q+r=1$。在随机交配下，[基因型频率](@entry_id:141286)由多项式展开 $(p+q+r)^2$ 给出：

$p^2 + q^2 + r^2 + 2pq + 2pr + 2qr = 1$

其中，$p^2, q^2, r^2$ 分别是三种纯[合子](@entry_id:146894)的频率，而 $2pq, 2pr, 2qr$ 是三种[杂合子](@entry_id:276964)的频率。

考虑一个虚构的[生物发光](@entry_id:152697)乌贼种群，其发光颜色由三个[共显性](@entry_id:142824)等位基因 $L^B$ (蓝光), $L^R$ (红光), 和 $L^Y$ (黄光) 控制。假设该群体处于HWE，红光等位基因 $L^R$ 的频率 $p_R = 0.4$，并且群体中有 $0.09$ 的个体发出纯黄光（基因型为 $L^Y L^Y$）。我们可以推断其他频率。纯黄光个体的频率是 $p_Y^2$，因此 [@problem_id:1472664]：

$p_Y^2 = 0.09 \implies p_Y = \sqrt{0.09} = 0.3$

由于所有等位基因频率之和为1：
$p_B + p_R + p_Y = 1$
$p_B = 1 - p_R - p_Y = 1 - 0.4 - 0.3 = 0.3$

现在我们可以计算发出品红色光（蓝光和红光的混合，基因型为 $L^B L^R$）的乌贼的期望频率：
$f(L^B L^R) = 2 p_B p_R = 2 \times 0.3 \times 0.4 = 0.24$

#### X连锁等位基因

对于位于[性染色体](@entry_id:169219)上的基因，[HWE的应用](@entry_id:152465)需要稍作调整。在XY型[性别决定](@entry_id:148324)的物种（如人类和果蝇）中，雌性（XX）在该[基因座](@entry_id:177958)上有两个等位基因，而雄性（XY）只有一个。

这意味着对于雄性，其表型直接反映了其[X染色体](@entry_id:156721)上的等位基因。因此，在雄性中表现出X连锁隐性性状的频率就等于该[隐性等位基因](@entry_id:274167)在整个[基因库](@entry_id:267957)中的频率 $q$。

对于雌性，由于她们有两个[X染色体](@entry_id:156721)，其[基因型频率](@entry_id:141286)仍然遵循标准的HWE公式：$f(XX_{dom}) = p^2$, $f(XX_{het}) = 2pq$, $f(XX_{rec}) = q^2$。

例如，在一个虚构的啮齿动物群体中，眼色由X染色体上的基因控制，红眼($R$)对黑眼($r$)为显性。调查发现，每20只雄性中有1只有黑眼。我们可以直接推断出黑眼等位基因 $r$ 的频率 $q_X$ [@problem_id:1472673]：

$q_X = f(\text{黑眼雄性}) = \frac{1}{20} = 0.05$

显性等位基因 $R$ 的频率 $p_X = 1 - q_X = 0.95$。

利用这些等位基因频率，我们可以预测雌性中[杂合子](@entry_id:276964)（$Rr$）的频率：
$f(\text{杂合雌性}) = 2 p_X q_X = 2 \times 0.95 \times 0.05 = 0.095$

这一区别解释了为什么X连锁隐性性状在雄性中比在雌性中更常见：雄性中出现的频率是 $q$，而雌性中是 $q^2$。只要 $q  1$，$q^2$ 总是小于 $q$。

### 偏离哈迪-温伯格平衡：[演化机制](@entry_id:196221)

哈迪-温伯格原理的真正力量在于，当一个群体的观测数据不符合其预测时，它能促使我们去探究是哪个或哪些[演化机制](@entry_id:196221)在起作用。下面我们讨论两种导致等位基因频率改变的主要机制。

#### [基因流](@entry_id:140922) (迁移)

**基因流 (Gene flow)** 或 **迁移 (migration)** 是指等位基因在不同群体之间的移动。当个体从一个群体迁移到另一个群体并参与繁殖时，它们就将自己的等位基因引入了新的基因库，从而可能改变该群体的[等位基因频率](@entry_id:146872)。

基因流的效果可以用一个简单的模型来量化。假设一个岛屿群体（resident），其等位基因 $A$ 的频率为 $p_{island}$。现在，有一部分来自大陆群体（mainland）的个体迁移到岛上，大陆群体中 $A$ 的频率为 $p_{mainland}$。如果新一代的[基因库](@entry_id:267957)中，来自迁移者的等位基因占了比例 $m$，那么来自原岛屿居民的等位基因则占比例 $1-m$。混合后的新一代群体的[等位基因频率](@entry_id:146872) $p'$ 将是两个来源的加权平均值：

$p' = (1-m) p_{island} + m \cdot p_{mainland}$

[基因流](@entry_id:140922)的总[体效应](@entry_id:261475)是使不同群体间的遗传差异减小，即均质化。

考虑一个旨在恢复某濒危植物的保育项目。一个孤立岛屿上的初始种群等位基因 $P$ 的频率经计算为 $p_{island} = 0.8$。为了增加[遗传多样性](@entry_id:201444)，从一个大陆种群（其中 $p_{mainland} = 0.95$）引入个体。该项目使得下一代[基因库](@entry_id:267957)中有 $m=0.10$ 的比例来自大陆迁移者。我们可以计算迁移事件后岛屿群体的新[等位基因频率](@entry_id:146872) $p'$ [@problem_id:1472634]：

$p' = (1-0.10) \times 0.8 + 0.10 \times 0.95 = 0.9 \times 0.8 + 0.1 \times 0.95 = 0.72 + 0.095 = 0.815$

在这次迁移事件之后，如果群体进行随机交配，那么下一代的[基因型频率](@entry_id:141286)将符合以 $p' = 0.815$ 和 $q' = 1 - p' = 0.185$ 为基础的哈迪-温伯格平衡。因此，杂合子（$Pp$）的期望频率为：

$f(Pp) = 2p'q' = 2 \times 0.815 \times 0.185 \approx 0.3016$

#### 自然选择

**自然选择 (Natural selection)** 是指不同基因型的个体因其表型差异而具有不同的生存和繁殖成功率。这是最具方向[性的演化](@entry_id:163338)驱动力。选择作用于个体，但其后果体现在群体[等位基因频率](@entry_id:146872)的代际变化上。

为了量化选择，我们引入**适合度 (fitness)** 的概念，它衡量一个个体将其基因传递给下一代的能力。通常我们使用**相对适合度 (relative fitness, $w$)**，即把最适基因型的适合度定为1，其他基因型的适合度则表示为相对于最适者的比例。

选择过程可以被模型化如下：
1.  在一个世代的开始（[受精](@entry_id:274949)时），假设群体处于HWE，基因型 $BB$, $Bb$, $bb$ 的频率分别为 $p_0^2$, $2p_0q_0$, $q_0^2$。
2.  在个体从幼年到成年的存活过程中，选择发生作用。三种基因型的相对适合度（存活率）分别为 $w_{BB}$, $w_{Bb}$, $w_{bb}$。存活到成年的个体中，三种基因型的相对比例变为 $p_0^2 w_{BB}$, $2p_0q_0 w_{Bb}$, $q_0^2 w_{bb}$。
3.  为了得到存活者中各基因型的实际频率，我们需要用一个[标准化](@entry_id:637219)因子——群体的**平均适合度 ($\bar{w}$)** 来除。$\bar{w}$ 是所有个体适合度的加权平均值：
    $\bar{w} = p_0^2 w_{BB} + 2p_0q_0 w_{Bb} + q_0^2 w_{bb}$
4.  这些存活下来的成年个体进行[随机交配](@entry_id:149892)，产生下一代。下一代的[等位基因频率](@entry_id:146872)（$p_1$）将由这些成年个体的基因库决定。等位基因 $B$ 的新频率 $p_1$ 为：
    $p_1 = \frac{p_0^2 w_{BB} + p_0q_0 w_{Bb}}{\bar{w}}$

这个过程可以逐代迭代，以模拟等位基因频率在持续选择压力下的演变。

让我们分析一个具体案例 [@problem_id:1472690]：一个昆虫群体被引入到一个新岛屿，其等位基因 $b$ 的初始频率 $q_0 = 0.8$（因此 $p_0=0.2$）。由于环境中的一种毒素，不同基因型的存活率（即相对适合度）不同：$w_{BB}=0.90$, $w_{Bb}=0.75$, $w_{bb}=0.30$。

**第一代选择后：**
首先计算初始群体的平均适合度 $\bar{w}_0$：
$\bar{w}_0 = (0.2)^2(0.90) + 2(0.2)(0.8)(0.75) + (0.8)^2(0.30) = 0.036 + 0.24 + 0.192 = 0.468$

然后计算第一代成年个体中 $B$ 等位基因的频率 $p_1$：
$p_1 = \frac{(0.2)^2(0.90) + (0.2)(0.8)(0.75)}{0.468} = \frac{0.036 + 0.12}{0.468} = \frac{0.156}{0.468} = \frac{1}{3}$

**第二代选择后：**
现在，第二代始于 $p_1 = 1/3$ 和 $q_1 = 2/3$。我们重复计算过程。
计算第二代的平均适合度 $\bar{w}_1$：
$\bar{w}_1 = (\frac{1}{3})^2(0.90) + 2(\frac{1}{3})(\frac{2}{3})(0.75) + (\frac{2}{3})^2(0.30) = \frac{1}{9}(0.9) + \frac{4}{9}(0.75) + \frac{4}{9}(0.3) = \frac{0.9+3.0+1.2}{9} = \frac{5.1}{9} = \frac{17}{30}$

计算第二代成年个体中 $B$ 等位基因的频率 $p_2$：
$p_2 = \frac{(\frac{1}{3})^2(0.90) + (\frac{1}{3})(\frac{2}{3})(0.75)}{\frac{17}{30}} = \frac{\frac{1}{9}(0.9) + \frac{2}{9}(0.75)}{\frac{17}{30}} = \frac{\frac{0.9+1.5}{9}}{\frac{17}{30}} = \frac{\frac{2.4}{9}}{\frac{17}{30}} = \frac{8}{30} \times \frac{30}{17} = \frac{8}{17}$

$p_2 \approx 0.4706$

这个例子生动地展示了自然选择如何能够迅速地改变一个群体的遗传构成，使适应性更强的等位基因（在这种情况下是 $B$）频率显著增加。

综上所述，通过计算等位基因和[基因型频率](@entry_id:141286)，并利用哈迪-温伯格原理作为基准，我们不仅可以描述群体在某一时刻的遗传结构，更能够理解和量化驱动群体演化的各种机制。