{"hands_on_practices": [{"introduction": "全基因组关联研究（GWAS）可能涉及数百万次统计检验，每个遗传变异对应一次。如此巨大的检验数量带来了一个主要的统计挑战：仅凭偶然就可能发现大量假阳性关联。本练习 [@problem_id:1494362] 将指导您计算Bonferroni校正，这是一种调整显著性阈值以控制此多重检验问题的基本方法。", "problem": "一个遗传学家团队正在进行一项全基因组关联分析 (GWAS)，以识别与一种新发现的复杂疾病相关的遗传标记。GWAS涉及扫描许多个体的基因组，以确定与对照组相比，任何特定的遗传变异是否在患有该疾病的人群中更为常见。本研究中分析的遗传变异是单核苷酸多态性 (SNPs)。\n\n在这项特定研究中，研究人员同时检验 $m = 1,000,000$ 个独立的SNP与该疾病的统计关联。传统上，对于单次统计检验，显著性的p值阈值 (α水平) 设定为 $\\alpha = 0.05$。然而，进行如此大量的检验会显著增加纯粹由偶然性导致至少出现一个“假阳性”结果（I类错误）的概率。\n\n为了应对这个多重检验问题，研究团队决定控制总体错误率 (FWER)，FWER定义为在所有进行的检验中犯一个或多个I类错误的概率。他们的目标是将FWER保持在0.05或以下。为实现这一目标，他们将对其显著性阈值应用Bonferroni校正。\n\n给定待检验的独立SNP数量和期望的FWER，计算单个SNP要被认为是统计显著所需满足的新的、经过Bonferroni校正的p值阈值。请用科学记数法表示你的答案。", "solution": "在Bonferroni程序下，总体错误率满足Bonferroni不等式：\n$$\n\\text{FWER} \\leq \\sum_{i=1}^{m} \\alpha_{i}.\n$$\n如果 $m$ 个检验中的每一个都以相同的单次检验显著性水平 $\\alpha^{*}$ 进行，那么\n$$\n\\text{FWER} \\leq m \\alpha^{*}.\n$$\n为了将FWER控制在期望水平 $\\alpha$，选择 $\\alpha^{*}$ 使得\n$$\nm \\alpha^{*} \\leq \\alpha \\quad \\Rightarrow \\quad \\alpha^{*} = \\frac{\\alpha}{m}.\n$$\n当 $\\alpha = 0.05$ 且 $m = 1{,}000{,}000 = 10^{6}$ 时，将 $0.05$ 写作 $5 \\times 10^{-2}$ 并计算\n$$\n\\alpha^{*} = \\frac{5 \\times 10^{-2}}{10^{6}} = 5 \\times 10^{-2-6} = 5 \\times 10^{-8}.\n$$\n因此，经过Bonferroni校正的p值阈值为 $5 \\times 10^{-8}$。", "answer": "$$\\boxed{5 \\times 10^{-8}}$$", "id": "1494362"}, {"introduction": "在鉴定出一个统计上显著的关联后，下一个关键步骤是量化其强度。在病例-对照研究中，比值比（Odds Ratio, OR）是衡量效应大小的标准指标，它表示携带某个特定等位基因会使个体具有某种性状或疾病的几率增加多少。这个练习题 [@problem_id:1494345] 让您能直接从研究数据中计算比值比，将原始数字与有意义的生物学解释联系起来。", "problem": "一个研究团队正在调查影响人类昼夜节律的遗传因素。他们进行了一项病例对照研究，以检验一种特定的单核苷酸多态性（SNP）（一种常见的遗传变异类型）与个人睡眠时型之间的潜在关联。该 SNP 在人群中有两种已知的等位基因，分别命名为 'T' 和 'C'。\n\n该研究涉及两组参与者：\n1.  一组“病例组”，由被识别为“夜晚型”的个体组成。\n2.  一组“对照组”，由被识别为“早晨型”的个体组成。\n\n该 SNP 的基因分型结果如下：\n- 在夜晚型组中，发现有 850 人携带 'T' 等位基因，而 1150 人携带 'C' 等位基因。\n- 在早晨型组中，发现有 750 人携带 'T' 等位基因，而 1450 人携带 'C' 等位基因。\n\n根据这些数据，计算夜晚型组中的个体与早晨型组中的个体相比，拥有 'T' 等位基因（相对于 'C' 等位基因）的比值差异的乘法因子。将您的最终答案四舍五入到三位有效数字。", "solution": "题目要求我们计算夜晚型（病例组）与早晨型（对照组）之间拥有 'T' 等位基因与 'C' 等位基因的比值的差异乘法因子。这就是比值比（odds ratio）。\n\n我们将一组中拥有 'T' 与 'C' 的比值定义为该组中 'T' 数量与 'C' 数量的比率。对于夜晚型组，其比值为\n$$\nO_{\\text{evening}}=\\frac{850}{1150}.\n$$\n对于早晨型组，其比值为\n$$\nO_{\\text{morning}}=\\frac{750}{1450}.\n$$\n比值比是这两个比值的比率：\n$$\n\\text{OR}=\\frac{O_{\\text{evening}}}{O_{\\text{morning}}}=\\frac{\\frac{850}{1150}}{\\frac{750}{1450}}=\\frac{850\\cdot 1450}{1150\\cdot 750}.\n$$\n通过约去公因数来简化。将 $850=85\\cdot 10$，$1450=145\\cdot 10$，$1150=115\\cdot 10$，$750=75\\cdot 10$ 代入，得到\n$$\n\\text{OR}=\\frac{85\\cdot 145}{115\\cdot 75}.\n$$\n将分子和分母同除以 $5$：\n$$\n\\text{OR}=\\frac{17\\cdot 29}{23\\cdot 15}=\\frac{493}{345}.\n$$\n计算其小数近似值并四舍五入到三位有效数字：\n$$\n\\frac{493}{345}\\approx 1.4289855\\ldots \\approx 1.43.\n$$\n因此，在夜晚型组中，拥有 'T' 等位基因与 'C' 等位基因的比值要高出约 $1.43$ 倍。", "answer": "$$\\boxed{1.43}$$", "id": "1494345"}, {"introduction": "当审视GWAS结果时，我们很容易将更小的 $p$ 值等同于更大的生物学效应，但这是一个常见且严重的误解。此问题 [@problem_id:1494349] 旨在挑战您批判性地思考影响 $p$ 值的各种因素。这有助于您区分统计显著性与遗传变异对性状的实际效应大小。", "problem": "一名遗传学专业的学生正在分析一项关于成人身高的大规模全基因组关联研究 (GWAS) 的结果。在这项研究中，研究人员在一个包含50万个体的队列中，测试了基因组中数百万个单核苷酸多态性 (SNP) 与身高的关联。该学生发现了两个位于不同染色体上的新SNP，它们的显著性水平均通过了全基因组显著性阈值：\n\n- SNP-1 的 p 值为 $1 \\times 10^{-12}$。\n- SNP-2 的 p 值为 $1 \\times 10^{-30}$。\n\n基于此，该学生得出结论：SNP-2 对身高的生物学效应一定比 SNP-1 更大，因为它的 p 值要小得多（即更显著）。以下哪个陈述为“该结论不一定成立”提供了最准确的理由？\n\nA. SNP-2 的 p 值非常小，很可能代表一种由未经校正的群体分层引起的统计假象，因此不能与 SNP-1 的 p 值进行比较。\nB. p 值是原假设（无关联）为真的概率；因此，两个 p 值都非常接近于零，以至于它们之间的任何差异在推断生物学效应方面都毫无意义。\nC. 关联的统计显著性（由 p 值表示）是变异效应大小和检测到该效应的统计功效的函数。在一个大型研究中，一个效应很小但非常常见的 SNP，可能比一个生物学效应确实更大但很罕见的 SNP 获得更低的 p 值。\nD. SNP-2 一定位于一个高度连锁不平衡 (LD) 的区域，这意味着它的 p 值被许多邻近 SNP 的效应夸大了，而 SNP-1 很可能是其所在区域的唯一致病变异。\nE. 低于常规全基因组显著性阈值 ($5 \\times 10^{-8}$) 的 p 值都被认为具有同等的证据效力，并且科学标准规定，当 p 值都具有如此高的统计显著性时，不应去解读其数值大小上的差异。", "solution": "这个问题的核心是要理解 GWAS 中的 p 值代表什么，以及哪些因素会影响它。这名学生的错误是一个常见的误解：将统计显著性直接等同于生物学效应大小。\n\n首先，我们来定义关键术语。在此背景下，p 值是指在原假设为真的前提下，观测到像实际观测到的关联统计量（如卡方值或回归系数的Z分数）一样极端或更极端的统计量的概率。原假设 ($H_0$) 是该 SNP 对性状（身高）没有影响。更小的 p 值提供了更强的证据来拒绝原假设。另一方面，效应大小是对现象量级的一种定量度量，例如，SNP-2 的一个等位基因平均使身高增加多少毫米。\n\n关键点在于，用于导出 p 值的检验统计量并非单纯是效应大小的函数。对于像身高这样的数量性状，其关联性通常使用线性回归模型进行检验。一个 SNP 效应的 Z 分数大约为：\n$$ Z \\approx \\frac{\\beta}{\\text{SE}(\\beta)} $$\n其中 $\\beta$ 是估计的效应大小，而 $\\text{SE}(\\beta)$ 是其标准误。\n\n标准误与样本量 ($N$) 的平方根成反比，并且也取决于 SNP 的方差，该方差是其次要等位基因频率 (MAF) 的函数。具体来说，对于具有较高 MAF 的 SNP（即常见变异）以及对于较大的样本量，$\\text{SE}(\\beta)$ 会更小。\n$$ \\text{SE}(\\beta) \\propto \\frac{1}{\\sqrt{N \\times \\text{MAF} \\times (1-\\text{MAF})}} $$\n因此，Z 分数大约为：\n$$ Z \\propto \\beta \\sqrt{N \\times \\text{MAF} \\times (1-\\text{MAF})} $$\n一个更显著（更小）的 p 值对应于一个更大的 Z 分数绝对值。从这个关系中，我们可以看出，可以通过几种方式获得大的 Z 分数：\n1.  大的效应大小 ($\\beta$)。\n2.  非常大的样本量 ($N$)。\n3.  高的次要等位基因频率（MAF 接近 0.5），这会使 $\\text{MAF} \\times (1-\\text{MAF})$ 项最大化。\n\n在我们的情景中，SNP-2 的 p 值远小于 SNP-1。学生假设这是因为 SNP-2 的效应大小 ($\\beta_2$) 远大于 $\\beta_1$。然而，完全有可能 SNP-2 是一个比 SNP-1 更常见的变异（具有更高的 MAF）。例如，SNP-2 可能 MAF 为 0.40，对身高有较小影响（例如，增加 0.5 毫米），而 SNP-1 可能是一个 MAF 为 0.01 的罕见变异，但具有更大的效应（例如，增加 2 毫米）。在一项非常大的研究中 (N=500,000)，检测常见 SNP-2 效应的巨大统计功效，可能会导致其 p 值比那个罕见但影响更大的 SNP-1 的 p 值还要极端。因此，在不考虑 SNP 等位基因频率的情况下，不能断定更小的 p 值意味着更大的效应大小。\n\n现在我们来评估各个选项：\n\nA. 这是不正确的。虽然群体分层可能导致假阳性，但没有理由假设它是一个 SNP 的原因而不是另一个的原因，或者一个极小的 p 值更有可能是假象。执行得当的 GWAS 会对此进行校正。这是一个可能的混杂因素，但不是 p 值和效应大小不一致的根本原因。\n\nB. 这个选项包含了一个对 p 值的常见且严重的误解。p 值是 P(数据或更极端的数据 | $H_0$)，而不是 P($H_0$ | 数据)。此外，$10^{-12}$ 和 $10^{-30}$ 的 p 值之间的差异是天文数字级的，在统计学上非常有意义；它意味着拒绝原假设的证据对于 SNP-2 来说要强大得多。该选项在两个方面都是错误的。\n\nC. 这个选项正确地指出了这种关系。它指出统计显著性（p 值）受到效应大小和统计功效（其本身又取决于样本量和等位基因频率）等多种因素的共同影响。它正确地提供了一个情景：一个效应小的常见变异可能比一个效应大的罕见变异产生更显著的 p 值。这是最准确的解释。\n\nD. 这是一个看似合理但错误的解释。连锁不平衡 (LD) 意味着 SNP 会一起遗传。一个显著的 SNP 可能只是附近一个真正致病变异的“标签”。然而，这并不能解释根本问题。即使 SNP-2 只是一个标签，标签和真正致病变异的 p 值都受到效应大小、MAF 和样本量的相同影响。LD 解释了为什么信号可能不位于致病变异处，但它并没有切断 p 值、效应大小和等位基因频率之间的联系。\n\nE. 这在事实上是错误的。虽然 $5 \\times 10^{-8}$ 是一个宣告显著性的常规*阈值*，但这并不意味着所有低于该阈值的 p 值都是等效的。一个 $10^{-30}$ 的 p 值代表着比一个 $10^{-9}$ 的 p 值强大得多的对原假设的拒绝。从统计证据的角度来看，这种量级上的差异是高度可解释的。", "answer": "$$\\boxed{C}$$", "id": "1494349"}]}