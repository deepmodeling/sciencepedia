{"hands_on_practices": [{"introduction": "系统免疫学的核心任务之一是将复杂的生物相互作用网络形式化，以便进行严谨的分析。第一步是将免疫系统的组分（如细胞和细胞因子）抽象为网络中的节点，并将它们之间的相互作用（如激活或抑制）表示为连接节点的边。这项练习 [@problem_id:2270582] 将引导你完成这一基本过程，将一个简单的免疫反应描述转化为一个有向图，并分析其结构特性，例如计算不同组分之间信号传导路径的数量。", "problem": "在一个简化的免疫反应模型中，我们考虑一个由几个关键组分之间的相互作用构成的网络。我们模型中的组分是：细胞因子白细胞介素-2 (IL-2)、T细胞、自然杀伤(NK)细胞、细胞因子γ-干扰素 (IFN-gamma) 和巨噬细胞。\n\n相互作用定义如下：\n1. IL-2 激活T细胞。\n2. IL-2 激活NK细胞。\n3. 活化的T细胞产生IFN-gamma。\n4. 活化的NK细胞产生IFN-gamma。\n5. IFN-gamma 激活巨噬细胞。\n\n我们可以将此系统表示为一个有向图，其中每个组分是一个节点，每个相互作用是一条有向边。“组分X影响组分Y”形式的相互作用，由一条从节点X指向节点Y的有向边表示。长度为 $k$ 的路径是一个由 $k$ 条相连的边组成的序列，并按正确的方向遍历。\n\n计算该网络中存在的长度恰好为2的所有不同路径的总数。", "solution": "确定节点和有向边。节点集为 $V=\\{\\text{IL-2}, \\text{T}, \\text{NK}, \\text{IFN-gamma}, \\text{Macrophage}\\}$。有向边集为\n$$\nE=\\{(\\text{IL-2},\\text{T}),\\;(\\text{IL-2},\\text{NK}),\\;(\\text{T},\\text{IFN-gamma}),\\;(\\text{NK},\\text{IFN-gamma}),\\;(\\text{IFN-gamma},\\text{Macrophage})\\}.\n$$\n长度为 2 的路径是由两条连续的有向边 $(X,Y)$ 和 $(Y,Z)$ 组成的序列。在有向图中，长度为2的路径总数可以通过对所有中间节点 $v$ 的入度与出度的乘积求和来计算：\n$$\n\\text{Number of length-}2\\text{ paths}=\\sum_{v\\in V}\\deg^{-}(v)\\deg^{+}(v).\n$$\n计算每个节点的 $\\deg^{-}(v)$ 和 $\\deg^{+}(v)$：\n- 对于 $\\text{IL-2}$：$\\deg^{-}(\\text{IL-2})=0$, $\\deg^{+}(\\text{IL-2})=2$。\n- 对于 $\\text{T}$：$\\deg^{-}(\\text{T})=1$, $\\deg^{+}(\\text{T})=1$。\n- 对于 $\\text{NK}$：$\\deg^{-}(\\text{NK})=1$, $\\deg^{+}(\\text{NK})=1$。\n- 对于 $\\text{IFN-gamma}$：$\\deg^{-}(\\text{IFN-gamma})=2$, $\\deg^{+}(\\text{IFN-gamma})=1$。\n- 对于 $\\text{Macrophage}$：$\\deg^{-}(\\text{Macrophage})=1$, $\\deg^{+}(\\text{Macrophage})=0$。\n因此，\n$$\n\\sum_{v\\in V}\\deg^{-}(v)\\deg^{+}(v)\n=0\\cdot 2+1\\cdot 1+1\\cdot 1+2\\cdot 1+1\\cdot 0\n=0+1+1+2+0\n=4.\n$$\n等价地，我们也可以显式地枚举出所有长度为2的路径：\n- $\\text{IL-2}\\to\\text{T}\\to\\text{IFN-gamma}$，\n- $\\text{IL-2}\\to\\text{NK}\\to\\text{IFN-gamma}$，\n- $\\text{T}\\to\\text{IFN-gamma}\\to\\text{Macrophage}$，\n- $\\text{NK}\\to\\text{IFN-gamma}\\to\\text{Macrophage}$。\n总共有 $4$ 条不同的长度为2的路径。", "answer": "$$\\boxed{4}$$", "id": "2270582"}, {"introduction": "在建立了免疫网络的静态“地图”之后，下一步是理解信息如何在这个网络中流动并随时间演变。布尔网络模型为此提供了一个强大的框架，它将蛋白质或细胞的复杂活性简化为“开启”(ON)或“关闭”(OFF)的离散状态。通过这项实践 [@problem_id:2270603]，你将模拟一个信号通路的动态行为，应用简单的逻辑规则来追踪系统中每个组分的状态如何随时间步进而变化，并最终达到一个稳定的平衡状态。", "problem": "在系统生物学中，细胞过程通常使用布尔网络进行建模，其中蛋白质被表示为可以处于两种状态之一的节点：开启（用 1 表示）或关闭（用 0 表示）。每个蛋白质在下一时间步 `t+1` 的状态由其他蛋白质在当前时间步 `t` 的状态根据一组逻辑规则确定。这被称为同步更新机制。\n\n考虑一个简化的信号通路，涉及一个外部信号 `S` 和四种蛋白质：`P1`、`P2`、`P3` 以及一种抑制性蛋白质 `I1`。这些相互作用由以下规则控制：\n- 一条“激活”规则 `A -> B` 意味着如果 `A` 在 `t` 时刻是开启状态，那么 `B` 在 `t+1` 时刻将是开启状态。\n- 一条“抑制”规则 `A -| B` 意味着如果 `A` 在 `t` 时刻是开启状态，那么 `B` 在 `t+1` 时刻将是关闭状态，并且这种抑制优先于任何激活信号。\n\n具体的网络拓扑结构如下：\n1.  外部信号 `S` 激活 `P1`。\n2.  `P1` 激活 `P2`。\n3.  `P1` 也激活抑制蛋白 `I1`。\n4.  `P2` 激活 `P3`。\n5.  `I1` 抑制 `P3`。\n\n更形式化地说，蛋白质在 `t+1` 时刻的状态由以下布尔逻辑规则确定：\n- `P1(t+1)` 为开启当且仅当 `S(t)` 为开启。\n- `P2(t+1)` 为开启当且仅当 `P1(t)` 为开启。\n- `I1(t+1)` 为开启当且仅当 `P1(t)` 为开启。\n- `P3(t+1)` 为开启当且仅当 `P2(t)` 为开启且 `I1(t)` 为关闭。\n\n在时间 `t=0` 时，所有蛋白质（`P1`、`P2`、`P3`、`I1`）都处于关闭状态。对于所有时间 `t >= 0`，外部信号 `S` 永久保持在开启状态。系统将以离散时间步（`t=1, 2, 3, ...`）演化，并最终达到一个稳态，在该状态下，每个蛋白质的开启/关闭状态不再改变。\n\n蛋白质的最终稳态构型是什么？请用一个有序四元组 `(P1, P2, I1, P3)` 来表示你的答案，其中 1 代表开启，0 代表关闭。\n\nA) (1, 1, 1, 1)\n\nB) (1, 1, 1, 0)\n\nC) (1, 1, 0, 1)\n\nD) (1, 0, 1, 0)\n\nE) (0, 0, 0, 0)", "solution": "在同步更新机制下，布尔更新方程为\n$$P1(t+1)=S(t),$$\n$$P2(t+1)=P1(t),$$\n$$I1(t+1)=P1(t),$$\n$$P3(t+1)=P2(t)\\land \\neg I1(t).$$\n给定初始条件 $P1(0)=0$，$P2(0)=0$，$I1(0)=0$，$P3(0)=0$ 以及对于所有 $t\\geq 0$ 的持续输入 $S(t)=1$，我们计算前几个同步更新。\n\n在 $t=1$ 时：\n$$P1(1)=S(0)=1,$$\n$$P2(1)=P1(0)=0,$$\n$$I1(1)=P1(0)=0,$$\n$$P3(1)=P2(0)\\land \\neg I1(0)=0\\land \\neg 0=0\\land 1=0.$$\n\n在 $t=2$ 时：\n$$P1(2)=S(1)=1,$$\n$$P2(2)=P1(1)=1,$$\n$$I1(2)=P1(1)=1,$$\n$$P3(2)=P2(1)\\land \\neg I1(1)=0\\land \\neg 0=0\\land 1=0.$$\n\n在 $t=3$ 时：\n$$P1(3)=S(2)=1,$$\n$$P2(3)=P1(2)=1,$$\n$$I1(3)=P1(2)=1,$$\n$$P3(3)=P2(2)\\land \\neg I1(2)=1\\land \\neg 1=1\\land 0=0.$$\n\n在所有后续时间里，由于对于所有 $t$ 都有 $S(t)=1$，我们得到对于所有 $t\\geq 1$ 都有 $P1(t)=1$，因此对于所有 $t\\geq 2$ 都有 $P2(t)=1$ 和 $I1(t)=1$。抑制作用通过 $\\neg I1(t)$ 项在 $P3$ 的逻辑中占主导，因此对于所有 $t\\geq 2$，我们得到\n$$P3(t+1)=P2(t)\\land \\neg I1(t)=1\\land 0=0.$$\n因此，系统达到并保持在稳态 $(P1,P2,I1,P3)=(1,1,1,0)$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2270603"}, {"introduction": "虽然布尔网络擅长于模拟逻辑开关，但免疫系统的许多方面，如细胞群体的增长和衰减，最好用连续变化的量来描述。这时，常微分方程(ODEs)就成为了首选的建模工具。这个练习 [@problem_id:2270549] 让你深入研究一个描述抗体分泌细胞动态变化的ODE模型，你不仅需要理解模型的生物学假设，还需要通过求解方程和进行微积分分析，来预测一个关键的生物学可测量指标：长寿命浆细胞群体达到其峰值所需的时间。", "problem": "一位系统免疫学家正在建立一个模型，以理解感染清除后抗体反应的持续性。该模型考虑了两种分泌抗体的细胞群体：短寿命浆母细胞 $B(t)$ 和长寿命浆细胞 $P(t)$。在时间 $t=0$ 时，对应于抗原被完全清除，浆母细胞的初始种群为 $B_0$，且不存在长寿命浆细胞，因此 $P(0)=0$。\n\n对于 $t \\ge 0$，这些细胞群体的动力学由以下常微分方程组 (ODEs) 描述：\n$$\n\\frac{dB}{dt} = -(\\delta_B + f) B(t)\n$$\n$$\n\\frac{dP}{dt} = f B(t) - \\delta_P P(t)\n$$\n\n此处，$\\delta_B$ 是浆母细胞自然死亡和终末分化的总速率，$f$ 是浆母细胞分化为长寿命浆细胞的速率，而 $\\delta_P$ 是长寿命浆细胞的极低死亡率。注意，初始种群 $B_0$ 是一个正常数。\n\n通过实验数据确定了以下参数值：\n- $\\delta_B = 1.25 \\text{ day}^{-1}$\n- $\\delta_P = 0.0040 \\text{ day}^{-1}$\n- $f = 0.15 \\text{ day}^{-1}$\n\n计算长寿命浆细胞群体 $P(t)$ 达到其最大值的时间。答案以天为单位，并四舍五入到三位有效数字。", "solution": "给定 $t \\ge 0$ 时的系统，其中 $B(0)=B_{0}$ 且 $P(0)=0$：\n$$\n\\frac{dB}{dt}=-(\\delta_{B}+f)B(t), \\qquad \\frac{dP}{dt}=f B(t)-\\delta_{P}P(t).\n$$\n首先，直接将关于 $B(t)$ 的方程作为一阶常系数线性常微分方程求解：\n$$\nB(t)=B_{0}\\exp\\big(-(\\delta_{B}+f)t\\big).\n$$\n接下来，使用积分因子法求解关于 $P(t)$ 的线性常微分方程。写出\n$$\n\\frac{dP}{dt}+\\delta_{P}P(t)=f B_{0}\\exp\\big(-(\\delta_{B}+f)t\\big).\n$$\n积分因子为 $\\mu(t)=\\exp(\\delta_{P} t)$，我们得到\n$$\n\\frac{d}{dt}\\big(P(t)\\exp(\\delta_{P} t)\\big)=f B_{0}\\exp\\big((\\delta_{P}-\\delta_{B}-f)t\\big).\n$$\n从 $0$ 到 $t$ 积分，并利用 $P(0)=0$ 可得\n$$\nP(t)\\exp(\\delta_{P} t)=f B_{0}\\int_{0}^{t}\\exp\\big((\\delta_{P}-\\delta_{B}-f)s\\big)\\,ds.\n$$\n对于 $\\delta_{P}\\neq \\delta_{B}+f$，\n$$\n\\int_{0}^{t}\\exp\\big((\\delta_{P}-\\delta_{B}-f)s\\big)\\,ds=\\frac{\\exp\\big((\\delta_{P}-\\delta_{B}-f)t\\big)-1}{\\delta_{P}-\\delta_{B}-f},\n$$\n所以\n$$\nP(t)=\\frac{f B_{0}}{\\delta_{B}+f-\\delta_{P}}\\Big(\\exp(-\\delta_{P} t)-\\exp\\big(-(\\delta_{B}+f)t\\big)\\Big).\n$$\n为求 $P(t)$ 达到最大值的时间，令 $\\frac{dP}{dt}=0$。根据常微分方程，临界点满足\n$$\nf B(t)-\\delta_{P}P(t)=0.\n$$\n代入 $B(t)$ 和 $P(t)$ 的表达式，\n$$\nf B_{0}\\exp\\big(-(\\delta_{B}+f)t\\big)=\\delta_{P}\\,\\frac{f B_{0}}{\\delta_{B}+f-\\delta_{P}}\\Big(\\exp(-\\delta_{P} t)-\\exp\\big(-(\\delta_{B}+f)t\\big)\\Big).\n$$\n两边同除以 $f B_{0}$ 并重新整理可得\n$$\n(\\delta_{B}+f)\\exp\\big(-(\\delta_{B}+f)t\\big)=\\delta_{P}\\exp(-\\delta_{P} t).\n$$\n等价于，\n$$\n\\exp\\big(-(\\delta_{B}+f-\\delta_{P})t\\big)=\\frac{\\delta_{P}}{\\delta_{B}+f},\n$$\n这就得到\n$$\nt_{\\max}=\\frac{1}{\\delta_{B}+f-\\delta_{P}}\\ln\\!\\left(\\frac{\\delta_{B}+f}{\\delta_{P}}\\right).\n$$\n代入给定的参数值 $\\delta_{B}=1.25\\ \\text{day}^{-1}$，$f=0.15\\ \\text{day}^{-1}$ 和 $\\delta_{P}=0.0040\\ \\text{day}^{-1}$：\n$$\n\\delta_{B}+f=1.40,\\quad \\delta_{B}+f-\\delta_{P}=1.396,\\quad \\frac{\\delta_{B}+f}{\\delta_{P}}=350,\n$$\n所以\n$$\nt_{\\max}=\\frac{1}{1.396}\\,\\ln(350)\\approx \\frac{5.857933}{1.396}\\approx 4.19623\\ \\text{days}.\n$$\n四舍五入到三位有效数字，时间为 $4.20$ 天。", "answer": "$$\\boxed{4.20}$$", "id": "2270549"}]}