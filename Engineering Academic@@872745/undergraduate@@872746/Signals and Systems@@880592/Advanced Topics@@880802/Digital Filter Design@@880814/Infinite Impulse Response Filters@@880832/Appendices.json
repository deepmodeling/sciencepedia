{"hands_on_practices": [{"introduction": "The defining characteristic of an IIR filter is its recursive nature, where the output depends on past outputs. This first exercise [@problem_id:1727048] provides a direct, hands-on look at how a single feedback coefficient controls the decay rate of the filter's impulse response, a key factor in designing effects like echo and reverberation. By calculating the coefficient for a specific decay, you will build an intuition for the relationship between a filter's mathematical description and its temporal behavior.", "problem": "A simple digital audio feedback system is being designed to create a basic echo effect. The output signal, $y[n]$, at any discrete time index $n$, is determined by the input signal, $x[n]$, and the output from the previous time step, $y[n-1]$. The relationship is governed by the difference equation:\n$$y[n] = x[n] + \\alpha y[n-1]$$\nHere, $\\alpha$ is a positive real constant representing the feedback strength. The system is causal and is initially at rest, meaning $y[n] = 0$ for all $n  0$.\n\nTo test the system's temporal characteristics, a unit impulse input is applied at $n=0$. This input is defined as $x[0] = 1$ and $x[n] = 0$ for all other integer values of $n$.\n\nDetermine the exact value of the feedback coefficient $\\alpha$ such that the magnitude of the system's output at time $n=2$ is exactly half the magnitude of the output at time $n=0$. Express your answer as a closed-form analytic expression.", "solution": "The system is defined by the causal linear difference equation $y[n] = x[n] + \\alpha y[n-1]$ with initial rest $y[n] = 0$ for $n  0$. For a unit impulse input defined by $x[0] = 1$ and $x[n] = 0$ for $n \\neq 0$, compute the output recursively.\n\nAt $n=0$:\n$$\ny[0] = x[0] + \\alpha y[-1] = 1 + \\alpha \\cdot 0 = 1.\n$$\n\nAt $n=1$:\n$$\ny[1] = x[1] + \\alpha y[0] = 0 + \\alpha \\cdot 1 = \\alpha.\n$$\n\nAt $n=2$:\n$$\ny[2] = x[2] + \\alpha y[1] = 0 + \\alpha \\cdot \\alpha = \\alpha^{2}.\n$$\n\nThus, for this impulse input, $y[n] = \\alpha^{n}$ for $n \\geq 0$. The requirement is that the magnitude at $n=2$ is half the magnitude at $n=0$:\n$$\n|y[2]| = \\frac{1}{2} |y[0]|.\n$$\nSince $\\alpha$ is a positive real constant, the magnitudes reduce to values, so\n$$\n\\alpha^{2} = \\frac{1}{2}.\n$$\nSolving for $\\alpha$ and selecting the positive root gives\n$$\n\\alpha = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}.\n$$", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2}}}$$", "id": "1727048"}, {"introduction": "Real-world filter implementations can sometimes deviate from their ideal design due to hardware faults or component tolerances. This practice [@problem_id:1727038] simulates such a scenario, where a critical feedback coefficient in a second-order notch filter is nullified. You will analyze the resulting transfer function to determine how this 'defect' transforms the filter's characteristics, providing a valuable lesson in system robustness and the interpretation of pole-zero diagrams.", "problem": "A digital signal processing engineer is designing a second-order Infinite Impulse Response (IIR) notch filter to remove a specific sinusoidal interference from a signal. The filter's input-output relationship is described by the linear constant-coefficient difference equation:\n\n$$y[n] = a_1 y[n-1] + a_2 y[n-2] + b_0 x[n] + b_1 x[n-1] + b_2 x[n-2]$$\n\nFor a standard notch filter designed to eliminate a digital frequency $\\omega_0$ and having a sharpness controlled by a parameter $r$ (where $0  r  1$), the coefficients are set as follows:\n$b_0 = 1$\n$b_1 = -2\\cos(\\omega_0)$\n$b_2 = 1$\n$a_1 = 2r\\cos(\\omega_0)$\n$a_2 = -r^2$\n\nYou may assume that the notch frequency $\\omega_0$ is not $0$, $\\pi/2$, or $\\pi$.\n\nDuring the physical implementation of the filter, a manufacturing defect occurs, causing the feedback coefficient $a_1$ to be permanently fixed at zero. All other coefficients ($a_2, b_0, b_1, b_2$) retain their originally designed values.\n\nWhich of the following options best describes the type of filter that results from this defect?\n\nA. An all-pass filter.\n\nB. A low-pass filter.\n\nC. A stable Finite Impulse Response (FIR) filter.\n\nD. A notch filter with resonant peaks at digital frequencies $\\omega = \\pm \\frac{\\pi}{2}$.\n\nE. An unstable filter.", "solution": "We start from the given linear constant-coefficient difference equation for an LTI second-order IIR filter:\n$$\ny[n] = a_{1} y[n-1] + a_{2} y[n-2] + b_{0} x[n] + b_{1} x[n-1] + b_{2} x[n-2]\n$$\nTaking the $z$-transform and solving for the transfer function $H(z) = \\frac{Y(z)}{X(z)}$ gives the standard relation\n$$\nH(z) = \\frac{b_{0} + b_{1} z^{-1} + b_{2} z^{-2}}{1 - a_{1} z^{-1} - a_{2} z^{-2}}.\n$$\nFor the designed notch filter, the intended coefficients are $b_{0} = 1$, $b_{1} = -2 \\cos(\\omega_{0})$, $b_{2} = 1$, $a_{1} = 2 r \\cos(\\omega_{0})$, and $a_{2} = - r^{2}$ with $0  r  1$. Due to the defect, $a_{1}$ is fixed at zero while $a_{2}$ and all $b$-coefficients remain as designed. Therefore, the implemented transfer function becomes\n$$\nH(z) = \\frac{1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2}}{1 - 0 \\cdot z^{-1} - (-r^{2}) z^{-2}} = \\frac{1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2}}{1 + r^{2} z^{-2}}.\n$$\n\nNext, identify zeros and poles:\n- The numerator factorizes as\n$$\n1 - 2 \\cos(\\omega_{0}) z^{-1} + z^{-2} = \\left(1 - \\exp(j \\omega_{0}) z^{-1}\\right)\\left(1 - \\exp(-j \\omega_{0}) z^{-1}\\right),\n$$\nso the zeros are at $z = \\exp(\\pm j \\omega_{0})$, i.e., on the unit circle at angles $\\pm \\omega_{0}$. This guarantees a frequency notch at $\\omega = \\pm \\omega_{0}$. The given assumption that $\\omega_{0} \\neq 0, \\frac{\\pi}{2}, \\pi$ avoids special edge cases.\n- The denominator is $1 + r^{2} z^{-2} = 0 \\implies z^{2} + r^{2} = 0 \\implies z = \\pm j r$. Thus the poles are at radius $r$ and angles $\\pm \\frac{\\pi}{2}$. Because $0  r  1$, both poles lie strictly inside the unit circle. Hence the filter is BIBO-stable (all poles strictly inside the unit circle), so it is not unstable.\n\nThis filter is not FIR because the denominator is not equal to $1$, so it is an IIR filter. It is not all-pass because the zeros on the unit circle at $z = \\exp(\\pm j \\omega_{0})$ are not paired with reciprocal conjugate poles to yield unity magnitude across all frequencies. It is not low-pass either, as the frequency response is not characterized by attenuation at high frequencies and passband near zero; instead, the denominator will produce resonant behavior at specific frequencies.\n\nTo see the resonant behavior, evaluate the frequency response on the unit circle $z = \\exp(j \\omega)$:\n$$\nH\\!\\left(\\exp(j \\omega)\\right) = \\frac{1 - 2 \\cos(\\omega_{0}) \\exp(-j \\omega) + \\exp(-j 2 \\omega)}{1 + r^{2} \\exp(-j 2 \\omega)}.\n$$\nThe magnitude of the denominator is\n$$\n\\left|1 + r^{2} \\exp(-j 2 \\omega)\\right|^{2} = \\left(1 + r^{2} \\exp(-j 2 \\omega)\\right)\\left(1 + r^{2} \\exp(j 2 \\omega)\\right) = 1 + r^{4} + 2 r^{2} \\cos(2 \\omega).\n$$\nThis achieves its minimum when $\\cos(2 \\omega)$ is minimal, i.e., when $\\cos(2 \\omega) = -1$, which occurs at $2 \\omega = \\pi + 2 k \\pi$, equivalently $\\omega = \\pm \\frac{\\pi}{2} + k \\pi$. Within the principal range, this gives $\\omega = \\pm \\frac{\\pi}{2}$. At these frequencies,\n$$\n\\left|1 + r^{2} \\exp(-j 2 \\omega)\\right| = \\left|1 - r^{2}\\right|,\n$$\nwhich is the smallest possible value for $0  r  1$, so the overall magnitude $\\left|H\\!\\left(\\exp(j \\omega)\\right)\\right|$ exhibits resonant peaks at $\\omega = \\pm \\frac{\\pi}{2}$.\n\nMeanwhile, the zeros at $z = \\exp(\\pm j \\omega_{0})$ ensure a notch exactly at $\\omega = \\pm \\omega_{0}$; the assumption $\\omega_{0} \\neq \\frac{\\pi}{2}$ avoids coinciding with the resonance directions. Therefore, the defective filter is best described as a notch filter (still notching at $\\omega_{0}$) with resonant peaks at the digital frequencies $\\omega = \\pm \\frac{\\pi}{2}$.\n\nHence, among the given options, the correct description is a notch filter with resonant peaks at $\\omega = \\pm \\frac{\\pi}{2}$.", "answer": "$$\\boxed{D}$$", "id": "1727038"}, {"introduction": "While IIR filters are efficient, they can become unstable if their poles lie outside the unit circle. This final exercise shifts from analysis to design, challenging you to stabilize an unstable IIR system using a feedback controller [@problem_id:1727051]. This practice illustrates the powerful concept of pole-zero cancellation, a fundamental technique used in control systems and advanced signal processing to modify and stabilize system behavior.", "problem": "A causal, linear time-invariant (LTI) system, denoted as System 1, is known to be unstable. Its behavior is described by the transfer function $H_1(z) = \\frac{1}{1 - 3z^{-1}}$. To stabilize the system, a controller with a transfer function $G(z)$ is placed in a standard negative feedback configuration around System 1. In this configuration, the overall system's output $Y(z)$ is related to its input $X(z)$ by the expression $Y(z) = H_1(z) [X(z) - G(z)Y(z)]$.\n\nThe controller $G(z)$ is to be designed such that it meets two criteria:\n1. The controller $G(z)$ itself must be a causal, stable, first-order filter.\n2. The resulting overall closed-loop system, with transfer function $H(z) = Y(z)/X(z)$, must be a causal and stable Finite Impulse Response (FIR) filter.\n\nDetermine the transfer function $G(z)$ for the controller that satisfies these requirements.", "solution": "Start from the given negative-feedback interconnection:\n$$Y(z) = H_{1}(z)\\big[X(z) - G(z)Y(z)\\big], \\quad H_{1}(z) = \\frac{1}{1 - 3 z^{-1}}.$$\nSolve for the closed-loop transfer function $H(z) = \\frac{Y(z)}{X(z)}$:\n$$Y(z) + H_{1}(z)G(z)Y(z) = H_{1}(z)X(z) \\;\\Rightarrow\\; \\big[1 + H_{1}(z)G(z)\\big]Y(z) = H_{1}(z)X(z),$$\n$$H(z) = \\frac{H_{1}(z)}{1 + H_{1}(z)G(z)}.$$\nImpose that the controller $G(z)$ be a causal, stable, first-order filter. A simple choice satisfying this is a first-order FIR form\n$$G(z) = g_{0} + g_{1} z^{-1},$$\nwhich is causal and BIBO-stable for any finite $g_{0}, g_{1}$. Substitute into the closed-loop expression and simplify:\n$$H(z) = \\frac{\\frac{1}{1 - 3 z^{-1}}}{1 + \\frac{1}{1 - 3 z^{-1}}\\big(g_{0} + g_{1} z^{-1}\\big)} = \\frac{1}{1 - 3 z^{-1} + g_{0} + g_{1} z^{-1}} = \\frac{1}{(1 + g_{0}) + (g_{1} - 3) z^{-1}}.$$\nFor $H(z)$ to be a causal, stable FIR filter, its denominator must be a nonzero constant (no $z^{-1}$ term). Hence enforce\n$$g_{1} - 3 = 0 \\;\\Rightarrow\\; g_{1} = 3.$$\nThen\n$$H(z) = \\frac{1}{1 + g_{0}},$$\nwhich is a constant FIR (length-1), causal and stable provided $1 + g_{0} \\neq 0$. Choosing, for simplicity, $g_{0} = 0$ yields unity closed-loop gain $H(z) = 1$ and the controller\n$$G(z) = 3 z^{-1},$$\nwhich is a causal, stable, first-order FIR filter, satisfying both design requirements.", "answer": "$$\\boxed{3 z^{-1}}$$", "id": "1727051"}]}