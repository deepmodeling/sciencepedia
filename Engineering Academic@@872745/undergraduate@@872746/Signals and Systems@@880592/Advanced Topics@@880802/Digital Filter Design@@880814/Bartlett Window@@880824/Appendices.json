{"hands_on_practices": [{"introduction": "The first step in understanding any window function is to apply it directly to a signal. This exercise provides fundamental practice in calculating the coefficients of a Bartlett window and performing the point-wise multiplication to taper a signal, a core operation in digital signal processing for mitigating spectral leakage. Mastering this basic mechanic is essential before exploring the window's more advanced properties. [@problem_id:1699596]", "problem": "In digital signal processing, window functions are often applied to finite-length signals to reduce spectral leakage when performing a Fourier transform. Consider a finite-length discrete-time signal $x[n]$ defined by the sequence $\\{1, 2, 3, 2, 1\\}$ for $n = 0, 1, 2, 3, 4$ respectively, and $x[n]=0$ for all other values of $n$.\n\nThis signal is to be multiplied by a 5-point causal Bartlett (triangular) window, $w[n]$. The general formula for a causal Bartlett window of length $N$ is given by:\n$$w[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}$$\nfor integers $n$ in the range $0 \\le n \\le N-1$.\n\nThe resulting windowed signal, $y[n]$, is the point-wise product of the input signal and the window function, such that $y[n] = x[n] \\cdot w[n]$.\n\nDetermine the output sequence for $y[n]$ over the interval $n=0, 1, 2, 3, 4$. Present your answer as a sequence of numbers in a single row, corresponding to the values of $y[0], y[1], y[2], y[3], y[4]$.", "solution": "We are given a finite-length signal $x[n]$ with $x[0]=1$, $x[1]=2$, $x[2]=3$, $x[3]=2$, $x[4]=1$, and $x[n]=0$ otherwise, and a 5-point causal Bartlett window $w[n]$ defined for $0 \\leq n \\leq N-1$ by\n$$\nw[n] = 1 - \\frac{2 \\left| n - \\frac{N-1}{2} \\right|}{N-1}.\n$$\nFor $N=5$, we have $N-1=4$ and $\\frac{N-1}{2}=2$, so\n$$\nw[n] = 1 - \\frac{2 |n-2|}{4} = 1 - \\frac{|n-2|}{2}, \\quad n=0,1,2,3,4.\n$$\nEvaluate $w[n]$ at each $n$:\n- For $n=0$: $|0-2|=2 \\Rightarrow w[0] = 1 - \\frac{2}{2} = 0$.\n- For $n=1$: $|1-2|=1 \\Rightarrow w[1] = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n- For $n=2$: $|2-2|=0 \\Rightarrow w[2] = 1 - 0 = 1$.\n- For $n=3$: $|3-2|=1 \\Rightarrow w[3] = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n- For $n=4$: $|4-2|=2 \\Rightarrow w[4] = 1 - \\frac{2}{2} = 0$.\n\nThe windowed signal is $y[n] = x[n] w[n]$. Compute each value:\n- $y[0] = 1 \\cdot 0 = 0$.\n- $y[1] = 2 \\cdot \\frac{1}{2} = 1$.\n- $y[2] = 3 \\cdot 1 = 3$.\n- $y[3] = 2 \\cdot \\frac{1}{2} = 1$.\n- $y[4] = 1 \\cdot 0 = 0$.\n\nThus, the output sequence over $n=0,1,2,3,4$ is $(0, 1, 3, 1, 0)$.", "answer": "$$\\boxed{\\begin{pmatrix}0  1  3  1  0\\end{pmatrix}}$$", "id": "1699596"}, {"introduction": "Window functions are not just for spectral analysis; they are often used as the impulse responses for FIR filters. This problem explores the effect of a Bartlett-windowed filter on a random noise signal, connecting the window's shape to the statistical properties of the filter's output. By calculating the output power, you will discover the important relationship between a filter's energy and its ability to suppress or pass noise. [@problem_id:1699598]", "problem": "A digital signal processing system is designed to analyze a noisy data stream. The input to the system, $x[n]$, is modeled as a sequence of uncorrelated random variables, representing discrete-time white noise. This noise process has a mean of zero and a variance of one.\n\nThe signal $x[n]$ is processed by a Finite Impulse Response (FIR) filter. The impulse response of this filter, denoted by $h[n]$, is defined by a Bartlett (triangular) window of an odd length $N  1$. The coefficients of the impulse response are given by the formula:\n$$h[n] = 1 - \\frac{2\\left|n - \\frac{N-1}{2}\\right|}{N-1}, \\quad \\text{for } n = 0, 1, \\dots, N-1$$\nand $h[n] = 0$ otherwise.\n\nDetermine the total average power of the filter's output signal, $y[n]$. Express your answer as a closed-form analytic expression in terms of the filter length $N$.", "solution": "The output signal $y[n]$ of a Linear Time-Invariant (LTI) system with impulse response $h[n]$ is given by the convolution of the input signal $x[n]$ with $h[n]$, i.e., $y[n] = x[n] * h[n] = \\sum_{k=-\\infty}^{\\infty} h[k]x[n-k]$.\n\nThe total average power of the output signal, $P_y$, is defined as the expected value of its squared magnitude, $P_y = E\\left[|y[n]|^2\\right]$. Since the filter impulse response $h[n]$ is real-valued, the output $y[n]$ is also real-valued, so $P_y = E\\left[y[n]^2\\right]$.\n\nSubstituting the convolution sum for $y[n]$:\n$$P_y = E\\left[ \\left( \\sum_{k=0}^{N-1} h[k]x[n-k] \\right) \\left( \\sum_{l=0}^{N-1} h[l]x[n-l] \\right) \\right]$$\n$$P_y = E\\left[ \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]x[n-k]x[n-l] \\right]$$\nBy linearity of expectation, we can move the expectation operator inside the sums:\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]E[x[n-k]x[n-l]]$$\nThe term $E[x[n-k]x[n-l]]$ is the autocorrelation of the input signal, $R_{xx}[(n-k)-(n-l)] = R_{xx}[l-k]$.\n\nThe input $x[n]$ is given as zero-mean, unit-variance white noise. This means its autocorrelation function is $R_{xx}[m] = \\sigma_x^2 \\delta[m] = 1 \\cdot \\delta[m]$, where $\\delta[m]$ is the Kronecker delta function.\nTherefore, $E[x[n-k]x[n-l]] = \\delta[l-k]$. The expression for the output power simplifies significantly because the term is non-zero only when $l=k$:\n$$P_y = \\sum_{k=0}^{N-1} \\sum_{l=0}^{N-1} h[k]h[l]\\delta[l-k] = \\sum_{k=0}^{N-1} h[k]h[k] = \\sum_{k=0}^{N-1} h[k]^2$$\nThis result shows that for a unit-variance white noise input, the output power is equal to the energy of the filter's impulse response.\n\nNow we must calculate this sum using the given expression for $h[n]$. Since $N$ is specified as an odd integer greater than 1, we can define an integer $M = \\frac{N-1}{2}$, where $M \\ge 1$. The impulse response can be written as:\n$$h[n] = 1 - \\frac{|n - M|}{M}, \\quad \\text{for } n = 0, 1, \\dots, 2M$$\nThe sum for the power is:\n$$P_y = \\sum_{n=0}^{2M} \\left( 1 - \\frac{|n - M|}{M} \\right)^2$$\nThis sum is symmetric about the center point $n=M$. We can rewrite it by separating the central term ($n=M$) and combining the symmetric pairs of terms around the center.\n$$P_y = \\left( h[M] \\right)^2 + \\sum_{n=0}^{M-1} \\left(h[n]\\right)^2 + \\sum_{n=M+1}^{2M} \\left(h[n]\\right)^2$$\nDue to symmetry, $h[n] = h[2M-n]$. Thus, the two sums are equal.\n$$P_y = \\left( h[M] \\right)^2 + 2\\sum_{n=0}^{M-1} \\left(h[n]\\right)^2$$\nAt the center, $n=M$, we have $h[M] = 1 - \\frac{|M - M|}{M} = 1$.\nFor $n  M$, we have $|n-M| = M-n$, so $h[n] = 1 - \\frac{M-n}{M} = \\frac{n}{M}$.\nSubstituting these into the power equation:\n$$P_y = 1^2 + 2\\sum_{n=0}^{M-1} \\left( \\frac{n}{M} \\right)^2 = 1 + \\frac{2}{M^2} \\sum_{n=0}^{M-1} n^2$$\nThe sum starts at $n=0$, but the first term is $0^2=0$, so we can start the sum from $n=1$:\n$$P_y = 1 + \\frac{2}{M^2} \\sum_{n=1}^{M-1} n^2$$\nWe use the standard formula for the sum of the first $m$ squares: $\\sum_{k=1}^{m} k^2 = \\frac{m(m+1)(2m+1)}{6}$. Here, $m=M-1$.\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)((M-1)+1)(2(M-1)+1)}{6} \\right]$$\n$$P_y = 1 + \\frac{2}{M^2} \\left[ \\frac{(M-1)M(2M-1)}{6} \\right] = 1 + \\frac{(M-1)(2M-1)}{3M}$$\nNow, we combine the terms with a common denominator of $3M$:\n$$P_y = \\frac{3M + (M-1)(2M-1)}{3M} = \\frac{3M + (2M^2 - 3M + 1)}{3M} = \\frac{2M^2 + 1}{3M}$$\nFinally, we substitute back $M = \\frac{N-1}{2}$:\n$$P_y = \\frac{2\\left(\\frac{N-1}{2}\\right)^2 + 1}{3\\left(\\frac{N-1}{2}\\right)} = \\frac{2\\frac{(N-1)^2}{4} + 1}{\\frac{3(N-1)}{2}} = \\frac{\\frac{(N-1)^2}{2} + 1}{\\frac{3(N-1)}{2}}$$\nMultiplying the numerator and denominator by 2 gives the final expression:\n$$P_y = \\frac{(N-1)^2 + 2}{3(N-1)}$$\nThis is the total average power of the output signal as a function of $N$.", "answer": "$$\\boxed{\\frac{(N-1)^{2} + 2}{3(N-1)}}$$", "id": "1699598"}, {"introduction": "Theoretical insight often leads to practical efficiency in filter design. The Bartlett window's definition as the convolution of two rectangular windows is not just a mathematical curiosity; it is the key to a highly efficient implementation. This advanced problem challenges you to derive a polyphase decomposition for a Bartlett filter, transforming a direct-form convolution into a more computationally streamlined structure. [@problem_id:1699569]", "problem": "A causal Finite Impulse Response (FIR) filter is characterized by an impulse response $h[n]$ that is a Bartlett (triangular) window of length $N=2M-1$, where $M$ is a positive integer. This impulse response can be generated by convolving a rectangular window $w_R[n]$ of length $M$ with itself, i.e., $h[n] = w_R[n] * w_R[n]$. The rectangular window is defined as $w_R[n] = 1$ for $0 \\leq n \\leq M-1$, and $w_R[n] = 0$ otherwise.\n\nFor this specific problem, we impose the constraint that the length of the rectangular window, $M$, is an even integer, which can be expressed as $M=2K$ for some positive integer $K$.\n\nThe goal is to design a computationally efficient implementation of this filter using a 2-component Type I polyphase decomposition. The filter's transfer function, $H(z)$, can be expressed in terms of its polyphase components $E_0(z)$ and $E_1(z)$ as:\n$$H(z) = E_0(z^2) + z^{-1}E_1(z^2)$$\n\nYour task is to derive the analytical expressions for the polyphase components $E_0(z)$ and $E_1(z)$. Express your answers as a function of $z$ and the integer $K$. Present your final answer as a 2-element row matrix of the form $\\begin{pmatrix} E_0(z)  E_1(z) \\end{pmatrix}$.", "solution": "We start from the causal rectangular window of even length $M=2K$, with $w_{R}[n]=1$ for $0 \\leq n \\leq 2K-1$ and $w_{R}[n]=0$ otherwise. Its $z$-transform is\n$$\nW_{R}(z)=\\sum_{n=0}^{2K-1}z^{-n}=\\frac{1-z^{-2K}}{1-z^{-1}}.\n$$\nThe Bartlett (triangular) impulse response is the convolution $h[n]=w_{R}[n]*w_{R}[n]$, so its transfer function is\n$$\nH(z)=W_{R}(z)^{2}=\\left(\\frac{1-z^{-2K}}{1-z^{-1}}\\right)^{2}.\n$$\n\nFor a 2-branch Type I polyphase decomposition we write\n$$\nH(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2}),\n$$\nwhere\n$$\nE_{0}(z)=\\sum_{m}h[2m]z^{-m},\\quad E_{1}(z)=\\sum_{m}h[2m+1]z^{-m}.\n$$\n\nExploit the fact that $M=2K$ is even. Then $W_{R}(z)$ has equal even and odd polyphase components:\n$$\nW_{R}(z)=E_{0}^{(R)}(z^{2})+z^{-1}E_{1}^{(R)}(z^{2}),\\quad E_{0}^{(R)}(z)=E_{1}^{(R)}(z)=\\sum_{m=0}^{K-1}z^{-m}.\n$$\nIndeed,\n$$\nW_{R}(z)=\\sum_{n=0}^{2K-1}z^{-n}=\\sum_{m=0}^{K-1}z^{-2m}+z^{-1}\\sum_{m=0}^{K-1}z^{-2m}=(1+z^{-1})\\sum_{m=0}^{K-1}z^{-2m}.\n$$\n\nNow square $W_{R}(z)$ to obtain $H(z)$ and match to the Type I form. Let $u=z^{2}$ and denote $S(u)=\\sum_{m=0}^{K-1}u^{-m}=\\frac{1-u^{-K}}{1-u^{-1}}$. Since $E_{0}^{(R)}(u)=E_{1}^{(R)}(u)=S(u)$, we have\n$$\nH(z)=\\big(E_{0}^{(R)}(z^2)+z^{-1}E_{1}^{(R)}(z^2)\\big)^{2}=E_{0}^{(R)}(z^2)^{2}+2z^{-1}E_{0}^{(R)}(z^2)E_{1}^{(R)}(z^2)+z^{-2}E_{1}^{(R)}(z^2)^{2}.\n$$\nComparing with $H(z)=E_{0}(z^2)+z^{-1}E_{1}(z^2)$, we can group terms and identify the components:\n$$\nE_{0}(z^2)=E_{0}^{(R)}(z^2)^{2}+z^{-2}E_{1}^{(R)}(z^2)^{2} \\quad \\text{and} \\quad E_{1}(z^2)=2E_{0}^{(R)}(z^2)E_{1}^{(R)}(z^2).\n$$\nSubstituting $u=z^2$ and $S(u)$, we find the expressions for the components as functions of $u$:\n$$\nE_{0}(u)=S(u)^{2}+u^{-1}S(u)^{2}=(1+u^{-1})S(u)^{2},\n$$\n$$\nE_{1}(u)=2S(u)S(u)=2S(u)^{2}.\n$$\nFinally, replace $u$ by $z$ to express the polyphase components as functions of $z$ and $K$:\n$$\nE_{0}(z)=(1+z^{-1})\\left(\\sum_{m=0}^{K-1}z^{-m}\\right)^{2}=(1+z^{-1})\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2},\n$$\n$$\nE_{1}(z)=2\\left(\\sum_{m=0}^{K-1}z^{-m}\\right)^{2}=2\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2}.\n$$\nThese satisfy $H(z)=E_{0}(z^{2})+z^{-1}E_{1}(z^{2})$ and match the required lengths for the even and odd polyphase branches when $M=2K$.", "answer": "$$\\boxed{\\begin{pmatrix}(1+z^{-1})\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2}  2\\left(\\frac{1-z^{-K}}{1-z^{-1}}\\right)^{2}\\end{pmatrix}}$$", "id": "1699569"}]}