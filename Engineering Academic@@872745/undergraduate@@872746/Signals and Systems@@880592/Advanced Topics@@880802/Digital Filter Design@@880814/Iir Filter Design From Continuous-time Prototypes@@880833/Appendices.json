{"hands_on_practices": [{"introduction": "The bilinear transform is the cornerstone of modern IIR filter design, providing a bridge from the continuous-time s-plane to the discrete-time z-plane. Its power lies in a unique, non-linear mapping of the entire frequency axis, which avoids the aliasing issues found in other methods. This first exercise [@problem_id:1726036] invites you to investigate the most fundamental aspect of this mapping: how the DC behavior of an analog prototype is preserved in its digital counterpart.", "problem": "In the design of digital Infinite Impulse Response (IIR) filters, a common technique is to transform a well-understood analog filter prototype into a digital filter. Consider a digital signal processing engineer who is using the bilinear transform for this purpose. The relationship between the complex frequency variable $s$ of the analog domain and the complex variable $z$ of the digital domain is given by the formula:\n$$s = \\frac{2}{T} \\left( \\frac{z-1}{z+1} \\right)$$\nwhere $T$ is the sampling period of the digital system.\n\nThe engineer wants to ensure that the low-frequency behavior of the filter is correctly translated from the analog prototype to the digital filter. The gain of the analog filter at Direct Current (DC), which represents its response to a constant input, is determined by evaluating its transfer function $H_a(s)$ at $s=0$. Which of the following points in the z-plane corresponds to this critical DC point ($s=0$) of the analog s-plane?\n\nA. $z = 1$\nB. $z = -1$\nC. $z = 0$\nD. $z = j$\nE. A point that depends on the value of the sampling period $T$.", "solution": "The problem asks to find the location in the z-plane that corresponds to the point $s=0$ in the s-plane, according to the bilinear transform. The bilinear transform provides a mapping between the s-plane (used for continuous-time systems) and the z-plane (used for discrete-time systems).\n\nThe given relationship is:\n$$s = \\frac{2}{T} \\left( \\frac{z-1}{z+1} \\right)$$\n\nWe are interested in the specific case where $s=0$, which corresponds to the Direct Current (DC) frequency in the analog domain. To find the corresponding point in the z-plane, we substitute $s=0$ into the equation:\n$$0 = \\frac{2}{T} \\left( \\frac{z-1}{z+1} \\right)$$\n\nFor this equation to be true, the term on the right-hand side must be zero. The constant factor $\\frac{2}{T}$ is non-zero, as the sampling period $T$ must be a finite, positive value. Therefore, the fractional part must be equal to zero:\n$$\\frac{z-1}{z+1} = 0$$\n\nA fraction is equal to zero if and only if its numerator is zero and its denominator is non-zero.\nSetting the numerator to zero gives:\n$$z - 1 = 0$$\nSolving for $z$, we get:\n$$z = 1$$\n\nWe must also verify that the denominator is not zero at this value of $z$. The denominator is $z+1$. Substituting $z=1$ into the denominator:\n$$1 + 1 = 2$$\nSince the denominator is 2 (which is non-zero), our solution $z=1$ is valid.\n\nThis result shows that the point $s=0$ in the s-plane maps to the point $z=1$ in the z-plane, regardless of the sampling period $T$. This is a fundamental property of the bilinear transform. It ensures that the DC gain of the analog prototype filter is mapped to the DC gain of the resulting digital filter, as the point $z=1$ corresponds to the zero frequency point ($\\omega=0$) on the unit circle in the z-plane ($z = e^{j\\omega T} \\implies z = e^{j \\cdot 0 \\cdot T} = e^0 = 1$).\n\nComparing our result with the given options:\nA. $z = 1$ (Matches our result)\nB. $z = -1$ (Incorrect)\nC. $z = 0$ (Incorrect)\nD. $z = j$ (Incorrect)\nE. A point that depends on the value of the sampling period $T$. (Incorrect, as $T$ cancelled out)\n\nThus, the correct option is A.", "answer": "$$\\boxed{A}$$", "id": "1726036"}, {"introduction": "Understanding the forward transformation from an analog prototype to a digital filter is only half the story. A robust understanding comes from being able to reverse the process, a skill useful for analyzing or verifying an existing digital filter's origin. In this practice [@problem_id:1726288], you will perform an inverse bilinear transformation, working backward from a given digital filter transfer function $H(z)$ to find the original analog prototype $H(s)$ from which it was derived.", "problem": "A first-order digital Infinite Impulse Response (IIR) filter is used to process a discrete-time signal. This filter is characterized by the z-domain transfer function:\n$$H(z) = \\frac{0.2 + 0.2z^{-1}}{1 - 0.6z^{-1}}$$\nIt is known that this digital filter was designed from a continuous-time analog prototype filter, $H(s)$, using the bilinear transformation. The sampling period used in the design was $T = 0.005$ s. The relationship for the bilinear transformation is defined as:\n$$s = \\frac{2}{T} \\left( \\frac{1 - z^{-1}}{1 + z^{-1}} \\right)$$\nDetermine the transfer function $H(s)$ of the original analog prototype filter. Express your answer as a rational function of the complex frequency variable $s$.", "solution": "We are given the digital filter transfer function $H(z) = \\dfrac{0.2 + 0.2 z^{-1}}{1 - 0.6 z^{-1}}$ and the bilinear transformation relationship $s = \\dfrac{2}{T} \\left( \\dfrac{1 - z^{-1}}{1 + z^{-1}} \\right)$ with $T = 0.005$. The bilinear transform maps the analog prototype to the digital filter via\n$$\nH_{d}(z) = H_{a}\\!\\left( \\frac{2}{T} \\frac{1 - z^{-1}}{1 + z^{-1}} \\right).\n$$\nTo recover $H_{a}(s)$, we invert the substitution by expressing $z^{-1}$ in terms of $s$. Using $z = \\dfrac{1 + \\frac{sT}{2}}{1 - \\frac{sT}{2}}$ gives\n$$\nz^{-1} = \\frac{1 - \\frac{sT}{2}}{1 + \\frac{sT}{2}}.\n$$\nWith $T = 0.005 = \\dfrac{1}{200}$, we have $\\dfrac{sT}{2} = \\dfrac{s}{400}$, so\n$$\nz^{-1} = \\frac{1 - \\frac{s}{400}}{1 + \\frac{s}{400}} = \\frac{400 - s}{400 + s}.\n$$\nRewrite the given $H(z)$ as\n$$\nH(z) = \\frac{\\frac{1}{5} \\left( 1 + z^{-1} \\right)}{1 - \\frac{3}{5} z^{-1}}.\n$$\nSubstitute $z^{-1} = \\dfrac{400 - s}{400 + s}$. First compute the numerator:\n$$\n1 + z^{-1} = 1 + \\frac{400 - s}{400 + s} = \\frac{(400 + s) + (400 - s)}{400 + s} = \\frac{800}{400 + s},\n$$\nso the numerator becomes\n$$\n\\frac{1}{5} \\left( 1 + z^{-1} \\right) = \\frac{1}{5} \\cdot \\frac{800}{400 + s} = \\frac{160}{400 + s}.\n$$\nNext compute the denominator:\n$$\n1 - \\frac{3}{5} z^{-1} = 1 - \\frac{3}{5} \\cdot \\frac{400 - s}{400 + s} = \\frac{(400 + s) - \\frac{3}{5}(400 - s)}{400 + s}.\n$$\nEvaluate the numerator of this fraction:\n$$\n(400 + s) - \\frac{3}{5}(400 - s) = 400 + s - 240 + \\frac{3}{5}s = 160 + \\frac{8}{5}s.\n$$\nHence,\n$$\n1 - \\frac{3}{5} z^{-1} = \\frac{160 + \\frac{8}{5}s}{400 + s}.\n$$\nTherefore,\n$$\nH_{a}(s) = H_{d}(z)\\bigg|_{z^{-1} = \\frac{400 - s}{400 + s}} = \\frac{\\frac{160}{400 + s}}{\\frac{160 + \\frac{8}{5}s}{400 + s}} = \\frac{160}{160 + \\frac{8}{5}s}.\n$$\nSimplify by multiplying numerator and denominator by $5$ and then dividing by $8$:\n$$\nH_{a}(s) = \\frac{800}{800 + 8s} = \\frac{100}{s + 100}.\n$$\nThis is the analog prototype transfer function whose bilinear transform with $T = 0.005$ yields the given $H(z)$.", "answer": "$$\\boxed{\\frac{100}{s+100}}$$", "id": "1726288"}, {"introduction": "While the bilinear transform is powerful, its advantages are best understood by comparing it to alternative techniques. The impulse invariance method, for example, offers a more direct time-domain approach but comes with a significant caveat. This exercise [@problem_id:1726011] presents a hypothetical scenario to reveal a critical flaw in the impulse invariance method, helping you understand why the bilinear transform's frequency warping is often a necessary and desirable feature for reliable filter design.", "problem": "An engineer is designing a digital Infinite Impulse Response (IIR) filter. The design process starts with a continuous-time (analog) prototype filter, and its characteristics are then transformed into the discrete-time domain. The chosen transformation technique is the impulse invariance method, where the impulse response of the digital filter, $h[n]$, is a scaled, sampled version of the analog filter's impulse response, $h_a(t)$, such that $h[n] = T_s h_a(nT_s)$, where $T_s$ is the sampling period.\n\nThe engineer selects a practical analog high-pass filter as the prototype. This prototype has a frequency response $H_a(j\\Omega)$ that is approximately zero for low frequencies and approaches a constant non-zero value for very high frequencies. That is, the filter is not band-limited and has significant energy as the analog frequency $\\Omega$ approaches infinity.\n\nAssuming the engineer proceeds with this design choice, what is the most significant and unavoidable adverse consequence that results from applying the impulse invariance method to this type of non-band-limited analog filter prototype?\n\nA. The resulting digital filter will be guaranteed to be unstable, regardless of the stability of the analog prototype.\nB. The high-frequency components of the analog filter's response will alias into the low-frequency band of the digital filter, fundamentally distorting the filter's intended frequency characteristic.\nC. The order of the resulting digital filter will be significantly higher than the order of the analog prototype, leading to an inefficient implementation.\nD. The resulting digital filter will exhibit severe non-linear phase distortion exclusively in its passband, while the stopband remains unaffected.\nE. The method will transform the analog high-pass filter into a digital all-pass filter, removing any frequency selectivity.", "solution": "Given the impulse invariance method, the digital impulse response is defined as $h[n] = T_{s} h_{a}(nT_{s})$. Define the continuous-time Fourier transform (CTFT) of the analog impulse response as\n$$\nH_{a}(j\\Omega) = \\int_{-\\infty}^{\\infty} h_{a}(t)e^{-j\\Omega t}\\,dt,\n$$\nand the discrete-time Fourier transform (DTFT) of the digital impulse response as\n$$\nH_{d}(e^{j\\omega}) = \\sum_{n=-\\infty}^{\\infty} h[n]e^{-j\\omega n} = T_{s}\\sum_{n=-\\infty}^{\\infty} h_{a}(nT_{s})e^{-j\\omega n}.\n$$\nApplying the Poisson summation formula, which relates the DTFT of sampled sequences to a periodic summation of the CTFT,\n$$\n\\sum_{n=-\\infty}^{\\infty} h_{a}(nT_{s})e^{-j\\omega n} = \\frac{1}{T_{s}}\\sum_{k=-\\infty}^{\\infty} H_{a}\\!\\left(j\\left(\\frac{\\omega - 2\\pi k}{T_{s}}\\right)\\right),\n$$\nwe obtain\n$$\nH_{d}(e^{j\\omega}) = \\sum_{k=-\\infty}^{\\infty} H_{a}\\!\\left(j\\left(\\frac{\\omega - 2\\pi k}{T_{s}}\\right)\\right).\n$$\nThis shows that the digital frequency response is a periodic alias-sum of shifted copies of the analog frequency response $H_{a}(j\\Omega)$, with shifts spaced by $\\frac{2\\pi}{T_{s}}$ in the analog frequency variable.\n\nIf the analog prototype is non-band-limited and has significant high-frequency content, specifically with $|H_{a}(j\\Omega)|$ approaching a non-zero constant as $\\Omega \\to \\infty$, then the terms corresponding to $k \\neq 0$ in the above sum contribute non-negligibly for every $\\omega \\in [-\\pi,\\pi]$, because\n$$\n\\Omega_{k}(\\omega) = \\frac{\\omega - 2\\pi k}{T_{s}}\n$$\nhas large magnitude for $|k|$ large, at which $H_{a}(j\\Omega_{k}(\\omega))$ is approximately constant and non-zero. Consequently, these high-frequency components fold into (alias into) the baseband of the digital frequency response, thereby distorting the intended high-pass characteristic by adding undesired low-frequency energy.\n\nThis aliasing is inherent to impulse invariance unless $H_{a}(j\\Omega)$ is effectively band-limited to $|\\Omega| \\lt \\pi/T_{s}$, which is not the case here by assumption. Therefore, the most significant and unavoidable adverse consequence is aliasing of high-frequency content into the low-frequency band of the digital filter.\n\nTo rule out the other options:\n- Stability is preserved under impulse invariance for a stable analog prototype with poles $s_{p}$ having $\\Re\\{s_{p}\\} \\lt 0$, since they map to $z_{p} = e^{s_{p}T_{s}}$ with $|z_{p}| = e^{\\Re\\{s_{p}\\}T_{s}} \\lt 1$. Hence A is false.\n- The filter order is not increased by impulse invariance; the number of poles is preserved. Hence C is false.\n- Aliasing affects both magnitude and phase across the entire band; it is not confined exclusively to the passband nor does it spare the stopband. Hence D is false.\n- Impulse invariance does not transform a high-pass filter into an all-pass filter; the selectivity is distorted by aliasing but not converted to all-pass. Hence E is false.\n\nTherefore, the correct choice is that high-frequency components alias into the low-frequency band, fundamentally distorting the frequency characteristic.", "answer": "$$\\boxed{B}$$", "id": "1726011"}]}