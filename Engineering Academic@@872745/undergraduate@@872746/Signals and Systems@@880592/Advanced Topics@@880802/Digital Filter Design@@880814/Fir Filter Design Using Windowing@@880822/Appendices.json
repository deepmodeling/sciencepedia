{"hands_on_practices": [{"introduction": "The journey into FIR filter design begins with understanding how to transform an ideal, yet impractical, filter into a real-world tool. This first practice guides you through the fundamental process of deriving the coefficients for a simple low-pass filter by truncating the ideal impulse response—an operation equivalent to using a rectangular window. Completing this exercise [@problem_id:1719431] will solidify your grasp of the core connection between the frequency and time domains in filter design.", "problem": "A digital signal processing system is being designed to remove high-frequency noise. The system uses a linear phase Finite Impulse Response (FIR) filter with 7 taps. Its impulse response, denoted $h[n]$, is therefore real-valued, symmetric, and has a finite duration.\n\nThe design procedure starts with the frequency response of an ideal low-pass filter, $H_d(e^{j\\omega})$, which is defined over one period $-\\pi \\le \\omega < \\pi$ as:\n$$ H_d(e^{j\\omega}) = \\begin{cases} 1 & \\text{for } |\\omega| \\le \\frac{\\pi}{2} \\\\ 0 & \\text{for } \\frac{\\pi}{2} < |\\omega| \\le \\pi \\end{cases} $$\nThe corresponding ideal impulse response, $h_d[n]$, is found by taking the inverse transform of $H_d(e^{j\\omega})$.\n\nTo create the 7-tap filter, the ideal impulse response $h_d[n]$ is truncated to be non-zero only for indices $n$ from $-3$ to $3$. This creates a non-causal, zero-phase filter with coefficients denoted as $h_{nc}[n]$. The coefficients are defined as:\n$$ h_{nc}[n] = \\begin{cases} h_d[n] & \\text{for } n \\in \\{-3, -2, -1, 0, 1, 2, 3\\} \\\\ 0 & \\text{otherwise} \\end{cases} $$\nDetermine the seven non-zero coefficients of this non-causal filter, $h_{nc}[-3], h_{nc}[-2], \\dots, h_{nc}[3]$. Present your answer as a sequence of these seven values, ordered by increasing index from $n=-3$ to $n=3$. Your answers must be exact analytical expressions in terms of constants like $\\pi$.", "solution": "The ideal low-pass filter with cutoff frequency $\\omega_{c}=\\frac{\\pi}{2}$ has frequency response $H_{d}(\\exp(j\\omega))=1$ for $|\\omega|\\leq \\frac{\\pi}{2}$ and $0$ otherwise on $[-\\pi,\\pi)$. The corresponding ideal impulse response is given by the inverse DTFT:\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\int_{-\\pi}^{\\pi}H_{d}(\\exp(j\\omega))\\exp(j\\omega n)\\,d\\omega\n=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\\exp(j\\omega n)\\,d\\omega.\n$$\nFor $n=0$,\n$$\nh_{d}[0]=\\frac{1}{2\\pi}\\int_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}1\\,d\\omega=\\frac{1}{2\\pi}\\left(\\pi\\right)=\\frac{1}{2}.\n$$\nFor $n\\neq 0$,\n$$\nh_{d}[n]=\\frac{1}{2\\pi}\\left[\\frac{\\exp(j\\omega n)}{j n}\\right]_{-\\frac{\\pi}{2}}^{\\frac{\\pi}{2}}\n=\\frac{1}{2\\pi j n}\\left(\\exp\\!\\left(j\\frac{\\pi n}{2}\\right)-\\exp\\!\\left(-j\\frac{\\pi n}{2}\\right)\\right)\n=\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right).\n$$\nThus,\n$$\nh_{d}[n]=\\begin{cases}\n\\frac{1}{2}, & n=0, \\\\\n\\frac{1}{\\pi n}\\sin\\!\\left(\\frac{\\pi n}{2}\\right), & n\\neq 0.\n\\end{cases}\n$$\nThe 7-tap non-causal zero-phase filter is obtained by truncation to $n\\in\\{-3,-2,-1,0,1,2,3\\}$, so $h_{nc}[n]=h_{d}[n]$ for these $n$. Evaluating each:\n- For $n=-3$: $\\sin\\!\\left(-\\frac{3\\pi}{2}\\right)=1$, hence $h_{nc}[-3]=\\frac{1}{\\pi(-3)}\\cdot 1=-\\frac{1}{3\\pi}$.\n- For $n=-2$: $\\sin(-\\pi)=0$, hence $h_{nc}[-2]=0$.\n- For $n=-1$: $\\sin\\!\\left(-\\frac{\\pi}{2}\\right)=-1$, hence $h_{nc}[-1]=\\frac{1}{-\\pi}\\cdot(-1)=\\frac{1}{\\pi}$.\n- For $n=0$: $h_{nc}[0]=\\frac{1}{2}$.\n- For $n=1$: $\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$, hence $h_{nc}[1]=\\frac{1}{\\pi}$.\n- For $n=2$: $\\sin(\\pi)=0$, hence $h_{nc}[2]=0$.\n- For $n=3$: $\\sin\\!\\left(\\frac{3\\pi}{2}\\right)=-1$, hence $h_{nc}[3]=-\\frac{1}{3\\pi}$.\n\nTherefore, ordered from $n=-3$ to $n=3$, the seven coefficients are $-\\frac{1}{3\\pi},\\,0,\\,\\frac{1}{\\pi},\\,\\frac{1}{2},\\,\\frac{1}{\\pi},\\,0,\\,-\\frac{1}{3\\pi}$.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{3\\pi} & 0 & \\frac{1}{\\pi} & \\frac{1}{2} & \\frac{1}{\\pi} & 0 & -\\frac{1}{3\\pi}\\end{pmatrix}}$$", "id": "1719431"}, {"introduction": "A filter's performance is not just about which frequencies it passes or blocks; its impact on the signal's timing is equally important. Linear-phase FIR filters, a common outcome of the windowing method, are prized for preserving a signal's waveform by delaying all frequency components equally. This exercise [@problem_id:1719382] asks you to calculate this constant delay, known as group delay, based on a filter's length, reinforcing a simple but critical relationship for any audio or communications engineer.", "problem": "In a digital audio workstation, a specific equalization plugin is implemented using a Finite Impulse Response (FIR) filter. To ensure that the plugin does not introduce phase distortion, which can alter the waveform's shape and be audible as a smearing of transients, the filter is designed to have a precisely linear phase response. The design is accomplished using a standard windowing technique, resulting in an impulse response that is symmetric about its center. The specification for the filter's impulse response requires it to be non-zero for a total of 31 discrete time samples. What is the constant time delay, known as group delay, that this plugin introduces to all frequency components of the audio signal? Express your answer in units of samples.", "solution": "The group delay of a filter is defined as the negative derivative of its phase response with respect to angular frequency $\\omega$. Let the frequency response of the filter be $H(e^{j\\omega})$, which can be expressed in polar form as $H(e^{j\\omega}) = |H(e^{j\\omega})|e^{j\\theta(\\omega)}$, where $\\theta(\\omega)$ is the phase response. The group delay, $\\tau_g(\\omega)$, is given by:\n$$ \\tau_g(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega} $$\n\nThe problem states that the filter is a Finite Impulse Response (FIR) filter of length $N=31$. The frequency response of a causal FIR filter is given by the Discrete-Time Fourier Transform (DTFT) of its impulse response $h[n]$:\n$$ H(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n]e^{-j\\omega n} $$\n\nThe crucial piece of information is that the filter has a linear phase response. For a causal FIR filter to have linear phase, its impulse response $h[n]$ must be symmetric or anti-symmetric about its midpoint. The problem specifies a symmetric impulse response, which is the standard for filters designed via the windowing method for applications like equalization. This symmetry condition is:\n$$ h[n] = h[N-1-n] \\quad \\text{for } n = 0, 1, \\dots, N-1 $$\n\nThe problem gives the filter length as $N=31$, which is an odd number. Let's find the center of symmetry. The midpoint index is $M = \\frac{N-1}{2}$. For $N=31$, the midpoint is $M = \\frac{31-1}{2} = 15$. The symmetry is about the sample $h[15]$.\n\nWe can now analyze the frequency response by factoring out a term corresponding to a linear phase shift of $M$ samples:\n$$ H(e^{j\\omega}) = \\sum_{n=0}^{N-1} h[n]e^{-j\\omega n} = e^{-j\\omega M} \\sum_{n=0}^{N-1} h[n]e^{-j\\omega(n-M)} $$\nLet's examine the summation term:\n$$ \\sum_{n=0}^{N-1} h[n]e^{-j\\omega(n-M)} = \\sum_{n=0}^{2M} h[n]e^{-j\\omega(n-M)} $$\nWe can split this sum into three parts: the term at the center of symmetry ($n=M$), the terms before the center ($n<M$), and the terms after the center ($n>M$).\n$$ = h[M]e^{-j\\omega(M-M)} + \\sum_{n=0}^{M-1} h[n]e^{-j\\omega(n-M)} + \\sum_{n=M+1}^{2M} h[n]e^{-j\\omega(n-M)} $$\n$$ = h[M] + \\sum_{n=0}^{M-1} h[n]e^{-j\\omega(n-M)} + \\sum_{n=M+1}^{2M} h[n]e^{-j\\omega(n-M)} $$\nLet's change the index of the second summation. Let $k = 2M - n$. As $n$ goes from $M+1$ to $2M$, $k$ goes from $M-1$ to $0$. So, $n = 2M-k$.\nThe second sum becomes:\n$$ \\sum_{k=0}^{M-1} h[2M-k]e^{-j\\omega((2M-k)-M)} = \\sum_{k=0}^{M-1} h[2M-k]e^{-j\\omega(M-k)} $$\nUsing the symmetry property $h[k] = h[N-1-k] = h[2M-k]$, we get:\n$$ \\sum_{k=0}^{M-1} h[k]e^{j\\omega(k-M)} $$\nReplacing the index $k$ with $n$ for clarity and substituting back:\n$$ \\sum_{n=0}^{N-1} h[n]e^{-j\\omega(n-M)} = h[M] + \\sum_{n=0}^{M-1} h[n]e^{-j\\omega(n-M)} + \\sum_{n=0}^{M-1} h[n]e^{j\\omega(n-M)} $$\n$$ = h[M] + \\sum_{n=0}^{M-1} h[n] \\left( e^{-j\\omega(n-M)} + e^{j\\omega(n-M)} \\right) $$\nUsing Euler's formula, $e^{jx} + e^{-jx} = 2\\cos(x)$:\n$$ = h[M] + \\sum_{n=0}^{M-1} 2h[n]\\cos(\\omega(n-M)) $$\nSince $\\cos(-x) = \\cos(x)$, this can be written as:\n$$ A(\\omega) = h[M] + \\sum_{n=0}^{M-1} 2h[n]\\cos(\\omega(M-n)) $$\nThis expression, $A(\\omega)$, is a purely real-valued function of $\\omega$.\nSo, the total frequency response is:\n$$ H(e^{j\\omega}) = A(\\omega) e^{-j\\omega M} $$\nFor this filter, the phase response $\\theta(\\omega)$ is the phase of the complex exponential term, which is $-\\omega M$ (assuming $A(\\omega)$ is positive, which is the case for the passband of a standard filter).\n$$ \\theta(\\omega) = - \\omega M $$\nThis is a linear function of $\\omega$, hence the name \"linear-phase filter\".\nNow, we can compute the group delay:\n$$ \\tau_g(\\omega) = -\\frac{d\\theta(\\omega)}{d\\omega} = -\\frac{d}{d\\omega}(-\\omega M) = M $$\nThe group delay is a constant, equal to the index of the center of symmetry of the impulse response.\n\nFor the given filter, the length is $N=31$. The group delay in samples is:\n$$ \\tau_g = M = \\frac{N-1}{2} = \\frac{31-1}{2} = \\frac{30}{2} = 15 $$\nTherefore, the filter introduces a constant delay of 15 samples to all frequency components.", "answer": "$$\\boxed{15}$$", "id": "1719382"}, {"introduction": "Real-world filter design involves managing trade-offs between performance and complexity. While simple windows are easy to apply, more advanced windows like the Kaiser window offer tunable parameters to meet specific design criteria. In this practice [@problem_id:1719395], you will use empirical design formulas to determine the best possible performance for a fixed filter length, learning how to balance transition bandwidth and stopband attenuation—a key skill in practical engineering scenarios.", "problem": "An engineer is tasked with designing a low-pass Finite Impulse Response (FIR) filter to preprocess a noisy signal from a sensor. The design must be implemented using the Kaiser window method. Due to strict hardware memory constraints on the embedded system, the filter length is fixed at $N=65$. The desired frequency response specifications are a passband edge frequency of $\\omega_p = 0.3\\pi$ radians/sample and a stopband edge frequency of $\\omega_s = 0.4\\pi$ radians/sample.\n\nThe empirical design formulas for the Kaiser window are as follows:\n1.  The relationship between the filter length $N$, the stopband attenuation $A_s$ (in dB), and the transition width $\\Delta\\omega = \\omega_s - \\omega_p$ is given by the approximation:\n    $$ (N-1) \\Delta\\omega = \\frac{A_s - 8}{2.285} $$\n2.  The Kaiser window parameter $\\beta$ is determined by the stopband attenuation $A_s$:\n    $$ \\beta = \\begin{cases} 0.1102(A_s - 8.7), & \\text{for } A_s > 50 \\\\ 0.5842(A_s - 21)^{0.4} + 0.07886(A_s - 21), & \\text{for } 21 \\le A_s \\le 50 \\\\ 0, & \\text{for } A_s < 21 \\end{cases} $$\n\nGiven the fixed filter length and the specified transition width, determine the maximum stopband attenuation $A_s$ that can be achieved. Then, find the value of the parameter $\\beta$ required to realize this design.\n\nProvide your answer as two numerical values: the attenuation $A_s$ (in dB) and the parameter $\\beta$. Round your final answers to three significant figures.", "solution": "We use the given Kaiser window empirical relation between filter length, transition width, and stopband attenuation:\n$$(N-1)\\Delta\\omega=\\frac{A_{s}-8}{2.285}.$$\nGiven $N=65$ and $\\Delta\\omega=\\omega_{s}-\\omega_{p}=0.4\\pi-0.3\\pi=0.1\\pi=\\frac{\\pi}{10}$, we solve for $A_{s}$:\n$$A_{s}=8+2.285\\,(N-1)\\Delta\\omega=8+2.285\\cdot 64\\cdot \\frac{\\pi}{10}=8+14.624\\,\\pi.$$\nNumerically, using $\\pi\\approx 3.14159265$, this gives\n$$A_{s}\\approx 8+14.624\\times 3.14159265=53.9426509\\ \\text{dB}.$$\nSince $A_{s}>50$, the appropriate formula for the Kaiser parameter is\n$$\\beta=0.1102\\,(A_{s}-8.7).$$\nSubstituting the computed $A_{s}$:\n$$\\beta=0.1102\\,(53.9426509-8.7)=0.1102\\times 45.2426509\\approx 4.98574003.$$\nRounding both to three significant figures yields $A_{s}\\approx 53.9$ and $\\beta\\approx 4.99$.", "answer": "$$\\boxed{\\begin{pmatrix} 53.9 & 4.99 \\end{pmatrix}}$$", "id": "1719395"}]}