{"hands_on_practices": [{"introduction": "Designing a digital filter often begins with a trusted analog prototype, but the bilinear transform, a popular conversion method, distorts the frequency axis. This first exercise [@problem_id:1720731] introduces the essential technique of frequency prewarping, which compensates for this distortion. You will practice applying the core prewarping formula to calculate the precise analog frequency needed to achieve a target cutoff frequency in the digital domain.", "problem": "A signal processing engineer is tasked with designing a digital low-pass filter for a high-fidelity audio system. The design methodology involves translating a well-characterized continuous-time (analog) filter prototype into a discrete-time (digital) filter using the Bilinear Transform. The audio system operates with a sampling frequency, $F_s$, of $20.0 \\text{ kHz}$.\n\nThe primary design specification is that the resulting digital filter must exhibit its cutoff frequency (conventionally the -3 dB attenuation point) at precisely one-half of the Nyquist frequency of the system. The Bilinear Transform is known to cause a non-linear compression, or \"warping,\" of the frequency axis when mapping from the continuous-time domain to the discrete-time domain. To counteract this effect and achieve the desired digital cutoff frequency, the cutoff frequency of the analog prototype must be appropriately pre-adjusted, a technique known as frequency prewarping.\n\nCalculate the required prewarped cutoff frequency that must be used for the analog filter prototype. Express your answer in kilohertz (kHz) and round it to three significant figures.", "solution": "The bilinear transform maps continuous-time angular frequency $\\Omega$ (in radians per second) to discrete-time angular frequency $\\omega$ (in radians per sample) by\n$$\n\\omega=2\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right),\n$$\nwhere $T=\\frac{1}{F_{s}}$ is the sampling period. To prewarp a desired digital cutoff to an analog prototype cutoff, solve for $\\Omega$:\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nThe specification requires the digital cutoff at one-half the Nyquist frequency. The Nyquist frequency is $\\frac{F_{s}}{2}$, so the desired digital cutoff in hertz is $f_{d}=\\frac{F_{s}}{4}$. The corresponding discrete-time angular frequency is\n$$\n\\omega_{c}=\\frac{2\\pi f_{d}}{F_{s}}=\\frac{2\\pi}{F_{s}}\\cdot\\frac{F_{s}}{4}=\\frac{\\pi}{2}.\n$$\nHence the prewarped analog angular cutoff is\n$$\n\\Omega_{p}=2F_{s}\\tan\\!\\left(\\frac{\\omega_{c}}{2}\\right)=2F_{s}\\tan\\!\\left(\\frac{\\pi}{4}\\right)=2F_{s}.\n$$\nConverting to hertz, $f_{p}=\\frac{\\Omega_{p}}{2\\pi}$, gives\n$$\nf_{p}=\\frac{2F_{s}}{2\\pi}=\\frac{F_{s}}{\\pi}.\n$$\nWith $F_{s}=20.0\\ \\text{kHz}$, this becomes\n$$\nf_{p}=\\frac{20.0}{\\pi}\\ \\text{kHz}\\approx 6.366\\ \\text{kHz}.\n$$\nRounding to three significant figures yields $6.37\\ \\text{kHz}$.", "answer": "$$\\boxed{6.37}$$", "id": "1720731"}, {"introduction": "To fully appreciate why prewarping is a crucial step, it is instructive to see what goes wrong when it is omitted. This practice [@problem_id:1720719] simulates a common engineering mistake where a direct, linear frequency correspondence is incorrectly assumed between the analog and digital domains. By calculating the resulting error, you will gain a tangible understanding of the frequency compression caused by the bilinear transform and why prewarping is indispensable for accurate filter design.", "problem": "In digital filter design, the bilinear transform is a common method for converting an analog filter design into a digital one. This transform maps the entire $j\\Omega$ axis of the complex s-plane onto the unit circle $z = e^{j\\omega}$ of the z-plane, but the mapping is nonlinear. The relationship between the analog frequency $\\Omega$ (in rad/s) and the digital frequency $\\omega$ (in rad/sample) is given by $\\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)$, where $T$ is the sampling period in seconds. To compensate for this nonlinearity, a technique called frequency prewarping is typically used.\n\nAn engineer is designing a first-order digital low-pass filter based on an analog prototype with the transfer function $H_a(s) = \\frac{\\Omega_c}{s + \\Omega_c}$, where $\\Omega_c$ is the analog cutoff frequency. The design specification requires the final digital filter to have a 3-dB cutoff frequency at a desired digital frequency $\\omega_d$. The 3-dB cutoff frequency is the frequency at which the filter's magnitude response is $1/\\sqrt{2}$ times its DC gain; for the given $H_a(s)$, this occurs precisely at the frequency $\\Omega = \\Omega_c$.\n\nThe engineer, however, neglects to apply frequency prewarping. Instead, they make a common mistake by assuming a direct correspondence between the frequency values. They set the analog cutoff frequency $\\Omega_c$ in the prototype filter to be numerically equal to the desired digital cutoff frequency $\\omega_d$.\n\nGiven a desired digital cutoff frequency $\\omega_d = 0.2\\pi$ radians/sample and a sampling period $T = 0.5$ s, this mistake leads to an actual digital cutoff frequency, $\\omega_a$, that differs from the desired $\\omega_d$. Calculate the relative error in the cutoff frequency, defined as $\\epsilon = \\frac{\\omega_a - \\omega_d}{\\omega_d}$.\n\nProvide your answer for the relative error $\\epsilon$ as a decimal value rounded to three significant figures.", "solution": "The bilinear transform maps analog and digital frequencies by the relation\n$$\n\\Omega=\\frac{2}{T}\\tan\\!\\left(\\frac{\\omega}{2}\\right),\n$$\nso a given analog frequency $\\Omega$ corresponds to a digital frequency\n$$\n\\omega=2\\,\\arctan\\!\\left(\\frac{\\Omega T}{2}\\right).\n$$\nFor the first-order analog low-pass prototype $H_{a}(s)=\\frac{\\Omega_{c}}{s+\\Omega_{c}}$, the $3$-dB cutoff occurs at $\\Omega=\\Omega_{c}$. Without prewarping, the engineer sets $\\Omega_{c}=\\omega_{d}$ (numerically). Therefore, the actual digital cutoff frequency after the bilinear transform is\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\Omega_{c}T}{2}\\right)=2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right).\n$$\nThe relative error is defined as\n$$\n\\epsilon=\\frac{\\omega_{a}-\\omega_{d}}{\\omega_{d}}=\\frac{2\\,\\arctan\\!\\left(\\frac{\\omega_{d}T}{2}\\right)-\\omega_{d}}{\\omega_{d}}.\n$$\nWith $\\omega_{d}=0.2\\pi=\\frac{\\pi}{5}$ and $T=0.5$, we have\n$$\n\\frac{\\omega_{d}T}{2}=\\frac{\\left(\\frac{\\pi}{5}\\right)\\left(\\frac{1}{2}\\right)}{2}=\\frac{\\pi}{20},\n$$\nso\n$$\n\\omega_{a}=2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right),\\quad\n\\epsilon=\\frac{2\\,\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-\\frac{\\pi}{5}}{\\frac{\\pi}{5}}=\\frac{10}{\\pi}\\arctan\\!\\left(\\frac{\\pi}{20}\\right)-1.\n$$\nNumerically evaluating,\n$$\n\\omega_{d} = 0.2\\pi \\approx 0.628319,\n$$\n$$\n\\omega_{a} = 2\\,\\arctan\\!\\left(\\frac{0.2\\pi \\cdot 0.5}{2}\\right) = 2\\,\\arctan(0.05\\pi) \\approx 2\\,\\arctan(0.15708) \\approx 0.311613.\n$$\nThe relative error is\n$$\n\\epsilon=\\frac{0.311613-0.628319}{0.628319}\\approx -0.504.\n$$\nRounded to three significant figures, the relative error is $-0.504$.", "answer": "$$\\boxed{-0.504}$$", "id": "1720719"}, {"introduction": "The frequency warping effect of the bilinear transform is not uniform; it becomes dramatically more pronounced as frequencies increase. This final thought experiment [@problem_id:1720749] pushes the prewarping concept to its theoretical limit by asking what happens as the target digital frequency, $\\omega_d$, approaches the Nyquist frequency, $\\pi$. Exploring this boundary case provides deep insight into the compressive nature of the mapping, $\\Omega_a = \\frac{2}{T} \\tan(\\frac{\\omega_d}{2})$, and the practical constraints it places on filter design.", "problem": "In digital signal processing, a common technique for designing a digital Infinite Impulse Response (IIR) filter is to start with an analog filter prototype and transform it into the digital domain using the bilinear transformation. This transformation maps the continuous-time frequency axis to the discrete-time frequency axis, but the mapping is non-linear, a phenomenon known as frequency warping.\n\nTo ensure that a critical frequency in the digital filter (e.g., a cutoff frequency) at a target value $\\omega_d$ (in rad/sample) is correctly placed, the corresponding critical frequency of the analog prototype, $\\Omega_a$ (in rad/s), must be \"prewarped\" before the transformation. The relationship used for this prewarping is given by the formula:\n$$\n\\Omega_a = \\frac{2}{T} \\tan\\left(\\frac{\\omega_d}{2}\\right)\n$$\nwhere $T$ is the sampling period in seconds. This ensures that after the bilinear transformation is applied to the analog filter with frequency $\\Omega_a$, the resulting digital filter has its critical frequency at the desired $\\omega_d$.\n\nConsider a scenario where an engineer is designing a low-pass digital filter and wants the cutoff frequency $\\omega_d$ to be as high as physically possible, i.e., arbitrarily close to the Nyquist frequency. The Nyquist frequency for a discrete-time system is $\\pi$ rad/sample. What is the limiting value of the required prewarped analog frequency $\\Omega_a$ as the target digital frequency $\\omega_d$ approaches the Nyquist frequency from below?\n\nChoose the correct statement describing this limiting behavior.\n\nA. The frequency approaches $0$.\nB. The frequency approaches $\\frac{\\pi}{T}$.\nC. The frequency approaches $\\frac{2}{T}$.\nD. The frequency approaches infinity.\nE. The limit does not exist and is not infinite.", "solution": "We start from the prewarping relationship between the desired discrete-time critical frequency $\\omega_{d}$ (in rad/sample) and the required analog prototype critical frequency $\\Omega_{a}$ (in rad/s):\n$$\n\\Omega_{a}=\\frac{2}{T}\\tan\\left(\\frac{\\omega_{d}}{2}\\right).\n$$\nThe Nyquist frequency is $\\omega_N = \\pi$ rad/sample. The question asks for the limiting behavior of $\\Omega_{a}$ as $\\omega_{d}\\to \\pi^{-}$, i.e., as $\\omega_{d}$ approaches $\\pi$ from below.\n\nLet's examine the argument of the tangent function, $\\theta = \\frac{\\omega_d}{2}$. As $\\omega_{d}\\to \\pi^{-}$, we have $\\theta\\to \\frac{\\pi}{2}^{-}$.\n\nThe prewarping formula can be written in terms of $\\theta$:\n$$\n\\Omega_{a}=\\frac{2}{T}\\tan(\\theta).\n$$\nWe now take the limit:\n$$\n\\lim_{\\omega_{d}\\to \\pi^{-}}\\Omega_{a}=\\frac{2}{T}\\lim_{\\theta\\to \\frac{\\pi}{2}^{-}}\\tan(\\theta).\n$$\nUsing the standard trigonometric limit\n$$\n\\lim_{\\theta\\to \\frac{\\pi}{2}^{-}}\\tan(\\theta)=+\\infty,\n$$\nit follows that\n$$\n\\lim_{\\omega_{d}\\to \\pi^{-}}\\Omega_{a}=+\\infty.\n$$\nTherefore, as the target digital frequency approaches the Nyquist frequency from below, the required prewarped analog frequency grows without bound. Among the given options, this corresponds to option D.", "answer": "$$\\boxed{D}$$", "id": "1720749"}]}