{"hands_on_practices": [{"introduction": "The defining characteristic of a linear phase FIR filter is a specific symmetry in its impulse response, $h[n]$. This time-domain property is what guarantees a linear phase response in the frequency domain. This first exercise [@problem_id:1733159] provides a foundational practice in applying this symmetry condition to a simple 3-tap filter, allowing you to determine the precise coefficient value that ensures the filter behaves as intended.", "problem": "A causal, real-valued Finite Impulse Response (FIR) filter is being designed for a digital audio processing application. The filter's design specifies a length of 3, which means its impulse response, denoted by $h[n]$, is non-zero only for the discrete time indices $n = 0, 1,$ and $2$.\n\nThe impulse response is given by the expression:\n$$h[n] = (c-1)\\delta[n] + 4\\delta[n-1] + (2c+1)\\delta[n-2]$$\nwhere $\\delta[n]$ represents the Kronecker delta function, and $c$ is a real-valued coefficient that must be carefully chosen.\n\nTo prevent phase distortion in the audio signal, the filter must possess the property of having a generalized linear phase. Determine the numerical value of the coefficient $c$ that ensures this property is met.", "solution": "A length-3 causal FIR with impulse response\n$$\nh[n] = (c-1)\\delta[n] + 4\\delta[n-1] + (2c+1)\\delta[n-2]\n$$\nhas nonzero samples\n$$\nh[0]=c-1,\\quad h[1]=4,\\quad h[2]=2c+1.\n$$\nFor a real-coefficient FIR filter to have generalized linear phase, a necessary and sufficient time-domain condition is symmetry or antisymmetry of the impulse response about the midpoint index $n_{0}=(N-1)/2$. With length $N=3$, the order is $M=N-1=2$ and $n_{0}=1$. Thus the conditions are\n$$\n\\text{symmetric: } h[n]=h[M-n]\\quad\\text{or}\\quad\\text{antisymmetric: } h[n]=-h[M-n].\n$$\nFor antisymmetry with odd $N$, the center tap must satisfy $h[n_{0}]=-h[n_{0}]$, which implies $h[1]=0$. Here $h[1]=4$, so antisymmetry is impossible. Therefore we must impose symmetry:\n$$\nh[0]=h[2]\\;\\;\\Longrightarrow\\;\\; c-1=2c+1.\n$$\nSolving gives\n$$\nc-1=2c+1\\;\\;\\Longrightarrow\\;\\;-c-2=0\\;\\;\\Longrightarrow\\;\\; c=-2.\n$$\nWith $c=-2$, the impulse response is $h[0]=-3$, $h[1]=4$, $h[2]=-3$, which is symmetric about $n=1$, ensuring generalized linear phase.", "answer": "$$\\boxed{-2}$$", "id": "1733159"}, {"introduction": "The primary motivation for designing linear phase filters is to achieve a constant group delay. This ensures that all frequency components of a signal pass through the filter with the same time delay, preventing phase distortion and preserving the signal's waveform. This practice [@problem_id:1733201] demonstrates the beautifully simple relationship between a filter's length, $N$, and its group delay, allowing for a quick and direct calculation of this crucial performance metric.", "problem": "In a digital communication system, a signal is passed through a causal Finite Impulse Response (FIR) filter to remove unwanted noise. To preserve the integrity of the signal's waveform, the filter is designed to have a linear phase characteristic, which ensures that all frequency components are delayed by the same amount. The impulse response of this filter, $h[n]$, has a finite duration, with a total length of $N=11$ non-zero samples. Calculate the constant group delay of this filter. Express your answer in units of samples.", "solution": "For a causal FIR filter of length $N$, the impulse response $h[n]$ is nonzero for $0 \\leq n \\leq N-1$. A linear-phase FIR has symmetry (or antisymmetry) about its midpoint index \n$$\nn_{0}=\\frac{N-1}{2}.\n$$\nIts discrete-time Fourier transform can be written as\n$$\nH(\\exp(j\\omega))=\\sum_{n=0}^{N-1}h[n]\\exp(-j\\omega n)=\\exp(-j\\omega n_{0})B(\\omega),\n$$\nwhere $B(\\omega)$ is a real-valued function (up to sign) determined by the symmetry type. The phase of $H(\\exp(j\\omega))$ is therefore\n$$\n\\phi(\\omega)=-\\omega n_{0}+\\phi_{B},\n$$\nwhere $\\phi_{B}$ is constant with respect to $\\omega$ (piecewise constant, ignoring isolated frequencies at zeros). By definition, the group delay is\n$$\n\\tau_{g}(\\omega)=-\\frac{d\\phi(\\omega)}{d\\omega}=n_{0}=\\frac{N-1}{2},\n$$\nwhich is constant for all $\\omega$.\n\nWith $N=11$, the constant group delay is\n$$\n\\tau_{g}=\\frac{11-1}{2}=5\\ \\text{samples}.\n$$", "answer": "$$\\boxed{5}$$", "id": "1733201"}, {"introduction": "Moving from analysis to synthesis, this final exercise challenges you to design a linear phase filter from the ground up. By leveraging the specific properties of a Type I linear phase filter—namely its odd length and symmetric impulse response—you can construct a system of equations to meet desired performance specifications. This problem [@problem_id:1733204] exemplifies a realistic design scenario where a filter must be created to nullify specific frequencies while satisfying a gain constraint, bringing together the core concepts of the chapter into a practical application.", "problem": "A causal Finite Impulse Response (FIR) filter of length $N$ is a digital filter defined by its impulse response $h[n]$, which is non-zero only for $n=0, 1, \\dots, N-1$. We are interested in a specific class of such filters known as Type I linear phase FIR filters. These filters are characterized by a real-valued and symmetric impulse response, $h[n] = h[N-1-n]$, and an odd filter length $N$.\n\nYour task is to design such a filter that meets a set of specific criteria. The filter must be the shortest possible non-trivial Type I linear phase FIR filter that satisfies the following two conditions:\n1.  It must completely nullify the frequency components at angular frequencies $\\omega_1 = \\pi/3$ radians/sample and $\\omega_2 = \\pi/2$ radians/sample.\n2.  Its DC gain, defined as the value of the filter's frequency response at $\\omega=0$, must be unity.\n\nA filter is considered non-trivial if at least one of its impulse response coefficients is non-zero.\n\nDetermine the coefficients $h[n]$ for $n=0, 1, \\dots, N-1$ for this filter. Present the coefficients as a row vector $(h[0], h[1], \\dots, h[N-1])$.", "solution": "A Type I linear phase Finite Impulse Response (FIR) filter has an odd length, which we can write as $N=2M+1$ for some integer $M \\ge 0$, and a symmetric impulse response, $h[n] = h[N-1-n]$. The frequency response of such a filter can be expressed as $H(e^{j\\omega}) = A_e(\\omega)e^{-j\\omega M}$, where $A_e(\\omega)$ is the real-valued amplitude response.\n\nThe amplitude response is given by the formula:\n$$A_e(\\omega) = h[M] + \\sum_{k=1}^{M} 2h[M-k] \\cos(k\\omega)$$\nThe problem requires us to find the shortest non-trivial filter. This means we must find the smallest integer $M \\ge 1$ for which a non-trivial solution exists. The case $M=0$ corresponds to $N=1$, with a single coefficient $h[0]$. To nullify any frequency, we would need $h[0]=0$, which is the trivial filter. Thus, we start by checking $M=1$.\n\n**Case 1: M = 1 (Filter length N = 3)**\nFor $M=1$, the filter length is $N=2(1)+1=3$. The impulse response is $\\{h[0], h[1], h[2]\\}$. By symmetry, $h[0]=h[2]$.\nThe amplitude response is:\n$$A_e(\\omega) = h[1] + 2h[0]\\cos(\\omega)$$\nThe filter must nullify frequencies $\\omega_1 = \\pi/3$ and $\\omega_2 = \\pi/2$. This means the amplitude response must be zero at these frequencies.\n1.  At $\\omega_2 = \\pi/2$: $A_e(\\pi/2) = h[1] + 2h[0]\\cos(\\pi/2) = h[1] + 2h[0](0) = 0 \\implies h[1] = 0$.\n2.  At $\\omega_1 = \\pi/3$: $A_e(\\pi/3) = h[1] + 2h[0]\\cos(\\pi/3) = h[1] + 2h[0](\\frac{1}{2}) = 0 \\implies h[1] + h[0] = 0$.\n\nFrom the first condition, we have $h[1]=0$. Substituting this into the second condition gives $0 + h[0] = 0$, so $h[0]=0$.\nSince $h[0]=h[2]$, this means $h[2]=0$. All coefficients ($h[0], h[1], h[2]$) are zero. This is the trivial filter, which is not allowed. Therefore, a filter of length $N=3$ cannot satisfy the given conditions.\n\n**Case 2: M = 2 (Filter length N = 5)**\nFor $M=2$, the filter length is $N=2(2)+1=5$. The impulse response is $\\{h[0], h[1], h[2], h[3], h[4]\\}$. By symmetry, $h[0]=h[4]$ and $h[1]=h[3]$.\nThe amplitude response is:\n$$A_e(\\omega) = h[2] + 2h[1]\\cos(\\omega) + 2h[0]\\cos(2\\omega)$$\nAgain, we apply the nulling conditions:\n1.  At $\\omega_2 = \\pi/2$: $A_e(\\pi/2) = h[2] + 2h[1]\\cos(\\pi/2) + 2h[0]\\cos(\\pi) = 0$.\n    Since $\\cos(\\pi/2)=0$ and $\\cos(\\pi)=-1$, we get:\n    $h[2] + 2h[1](0) + 2h[0](-1) = 0 \\implies h[2] - 2h[0] = 0 \\implies h[2] = 2h[0]$.\n2.  At $\\omega_1 = \\pi/3$: $A_e(\\pi/3) = h[2] + 2h[1]\\cos(\\pi/3) + 2h[0]\\cos(2\\pi/3) = 0$.\n    Since $\\cos(\\pi/3)=1/2$ and $\\cos(2\\pi/3)=-1/2$, we get:\n    $h[2] + 2h[1](\\frac{1}{2}) + 2h[0](-\\frac{1}{2}) = 0 \\implies h[2] + h[1] - h[0] = 0$.\n\nWe now have a system of two linear equations relating the coefficients:\n(i) $h[2] = 2h[0]$\n(ii) $h[2] + h[1] - h[0] = 0$\n\nSubstitute equation (i) into (ii):\n$(2h[0]) + h[1] - h[0] = 0 \\implies h[0] + h[1] = 0 \\implies h[1] = -h[0]$.\n\nWe can now express all independent coefficients in terms of $h[0]$:\n- $h[1] = -h[0]$\n- $h[2] = 2h[0]$\n\nSince we can choose a non-zero $h[0]$, this leads to a non-trivial filter. As $M=1$ yielded no solution, $M=2$ (i.e., $N=5$) is the shortest possible length.\n\nThe final condition is that the DC gain is unity. The DC gain is the frequency response at $\\omega=0$:\n$$H(e^{j0}) = \\sum_{n=0}^{4} h[n] = h[0] + h[1] + h[2] + h[3] + h[4]$$\nUsing symmetry ($h[3]=h[1], h[4]=h[0]$), this becomes:\n$$H(e^{j0}) = h[0] + h[1] + h[2] + h[1] + h[0] = 2h[0] + 2h[1] + h[2]$$\nNow substitute the relations we found: $h[1]=-h[0]$ and $h[2]=2h[0]$.\n$$H(e^{j0}) = 2h[0] + 2(-h[0]) + (2h[0]) = 2h[0] - 2h[0] + 2h[0] = 2h[0]$$\nThe condition is that the DC gain is 1, so:\n$$2h[0] = 1 \\implies h[0] = \\frac{1}{2}$$\nNow we can find all the coefficients:\n- $h[0] = \\frac{1}{2}$\n- $h[1] = -h[0] = -\\frac{1}{2}$\n- $h[2] = 2h[0] = 2(\\frac{1}{2}) = 1$\n- $h[3] = h[1] = -\\frac{1}{2}$\n- $h[4] = h[0] = \\frac{1}{2}$\n\nThe coefficients of the filter are $h[n] = \\{\\frac{1}{2}, -\\frac{1}{2}, 1, -\\frac{1}{2}, \\frac{1}{2}\\}$.\nThe final answer is the row vector $(h[0], h[1], h[2], h[3], h[4])$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2}  -\\frac{1}{2}  1  -\\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}$$", "id": "1733204"}]}