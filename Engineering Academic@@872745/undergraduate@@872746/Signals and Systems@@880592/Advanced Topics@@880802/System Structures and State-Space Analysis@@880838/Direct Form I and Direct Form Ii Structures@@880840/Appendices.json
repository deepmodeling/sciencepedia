{"hands_on_practices": [{"introduction": "A digital filter's transfer function is its defining characteristic, describing how it modifies the magnitude and phase of different frequency components of a signal. The Direct Form II structure is a computationally efficient method for implementing a filter described by such a function. This first exercise provides practice in the fundamental skill of deriving the system's transfer function, $H(z)$, directly from the difference equations that represent its Direct Form II implementation, bridging the gap between a practical block diagram and its theoretical description [@problem_id:1714613].", "problem": "A discrete-time, linear time-invariant (LTI) system, such as one used in a digital audio equalizer, is implemented using a computational structure known as the Direct Form II realization. This structure is efficient in terms of memory as it minimizes the number of delay elements.\n\nThe system's behavior is described by the relationship between its input sequence $x[n]$, its output sequence $y[n]$, and an internal intermediate sequence $w[n]$. The intermediate sequence $w[n]$ is generated from the input and its own past values according to the recursive difference equation:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nThe output sequence $y[n]$ is then formed from the current and past values of this intermediate sequence according to the non-recursive difference equation:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nFor a particular configuration of this system, the filter coefficients are given as:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nDetermine the overall transfer function $H(z) = Y(z)/X(z)$ of the system.", "solution": "The problem asks for the transfer function $H(z)$ of a system described by two difference equations that define its Direct Form II structure. The transfer function is the ratio of the Z-transform of the output, $Y(z)$, to the Z-transform of the input, $X(z)$. We can find this by first taking the Z-transform of each difference equation and then combining them algebraically.\n\nThe first equation relates the intermediate signal $w[n]$ to the input signal $x[n]$:\n$$w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2]$$\nWe apply the Z-transform to this equation. Using the time-shifting property of the Z-transform, which states that $\\mathcal{Z}\\{f[n-k]\\} = z^{-k}F(z)$, we get:\n$$W(z) = X(z) - a_1 z^{-1} W(z) - a_2 z^{-2} W(z)$$\nNow, we rearrange this equation to find the relationship between $W(z)$ and $X(z)$. We group all terms involving $W(z)$ on one side:\n$$W(z) + a_1 z^{-1} W(z) + a_2 z^{-2} W(z) = X(z)$$\nFactoring out $W(z)$, we have:\n$$W(z) (1 + a_1 z^{-1} + a_2 z^{-2}) = X(z)$$\nThis allows us to express the ratio of $W(z)$ to $X(z)$ as a transfer function, let's call it $H_1(z)$:\n$$H_1(z) = \\frac{W(z)}{X(z)} = \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\n\nNext, we consider the second equation, which relates the output signal $y[n]$ to the intermediate signal $w[n]$:\n$$y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2]$$\nAgain, we apply the Z-transform and its time-shifting property:\n$$Y(z) = b_0 W(z) + b_1 z^{-1} W(z) + b_2 z^{-2} W(z)$$\nFactoring out $W(z)$ from the right side gives:\n$$Y(z) = W(z) (b_0 + b_1 z^{-1} + b_2 z^{-2})$$\nThis defines the transfer function from the intermediate signal to the output, let's call it $H_2(z)$:\n$$H_2(z) = \\frac{Y(z)}{W(z)} = b_0 + b_1 z^{-1} + b_2 z^{-2}$$\n\nThe overall transfer function $H(z) = Y(z)/X(z)$ is the product of these two transfer functions, as the system is a cascade of $H_1(z)$ followed by $H_2(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{Y(z)}{W(z)} \\cdot \\frac{W(z)}{X(z)} = H_2(z) H_1(z)$$\nSubstituting the expressions for $H_1(z)$ and $H_2(z)$:\n$$H(z) = (b_0 + b_1 z^{-1} + b_2 z^{-2}) \\cdot \\left( \\frac{1}{1 + a_1 z^{-1} + a_2 z^{-2}} \\right)$$\n$$H(z) = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form of the transfer function for a second-order IIR filter in Direct Form II.\n\nFinally, we substitute the given numerical values for the coefficients:\n$a_1 = -0.7$\n$a_2 = 0.1$\n$b_0 = 2$\n$b_1 = 0.5$\n$b_2 = -0.3$\n\nPlugging these into the general expression for $H(z)$:\n$$H(z) = \\frac{2 + (0.5) z^{-1} + (-0.3) z^{-2}}{1 + (-0.7) z^{-1} + (0.1) z^{-2}}$$\n$$H(z) = \\frac{2 + 0.5 z^{-1} - 0.3 z^{-2}}{1 - 0.7 z^{-1} + 0.1 z^{-2}}$$\nThis is the final closed-form expression for the system's transfer function.", "answer": "$$\\boxed{\\frac{2 + 0.5z^{-1} - 0.3z^{-2}}{1 - 0.7z^{-1} + 0.1z^{-2}}}$$", "id": "1714613"}, {"introduction": "Moving from design to analysis, a common engineering task is to characterize an unknown system. This process, often called system identification, involves deducing the system's internal properties from its observed behavior. The impulse response of a linear time-invariant (LTI) system uniquely defines it, and this exercise demonstrates how to work backward from a few measured samples of the impulse response to determine the filter's unknown feedback coefficients [@problem_id:1714591]. This practice reinforces the intimate link between a filter's time-domain difference equation and its real-world output.", "problem": "An engineer is tasked with characterizing an unknown causal, second-order Linear Time-Invariant (LTI) digital filter. This type of filter is often implemented using a Direct Form structure, and its input-output relationship can be described by a general rational transfer function $H(z)$:\n$$H(z) = \\frac{Y(z)}{X(z)} = \\frac{b_0 + b_1 z^{-1} + b_2 z^{-2}}{1 + a_1 z^{-1} + a_2 z^{-2}}$$\nThis is the general form for a second-order Infinite Impulse Response (IIR) filter.\n\nThrough preliminary analysis, the engineer determines that the filter has a simple feedforward path, described by the coefficients $b_0 = 2$, $b_1 = 0$, and $b_2 = 0$. To determine the feedback coefficients, a unit impulse input, defined as $x[n] = \\delta[n]$, is applied to the filter. The first three samples of the resulting output impulse response, $h[n]$, are measured to be:\n$h[0] = 2$\n$h[1] = 1.6$\n$h[2] = 0.48$\n\nBased on this information, determine the numerical values of the feedback coefficients $a_1$ and $a_2$. The answer should be provided as an ordered pair $(a_1, a_2)$.", "solution": "For a causal second-order LTI IIR filter with transfer function\n$$H(z)=\\frac{Y(z)}{X(z)}=\\frac{b_{0}+b_{1}z^{-1}+b_{2}z^{-2}}{1+a_{1}z^{-1}+a_{2}z^{-2}},$$\nthe corresponding time-domain difference equation is obtained by multiplying both sides by the denominator and taking the inverse $z$-transform:\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=b_{0}x[n]+b_{1}x[n-1]+b_{2}x[n-2].$$\nGiven $b_{0}=2$, $b_{1}=0$, and $b_{2}=0$, this simplifies to\n$$y[n]+a_{1}y[n-1]+a_{2}y[n-2]=2x[n].$$\nWith an impulse input $x[n]=\\delta[n]$ and zero initial conditions (causality and initial rest), the output is the impulse response $h[n]=y[n]$, which satisfies\n$$h[n]+a_{1}h[n-1]+a_{2}h[n-2]=2\\delta[n].$$\nEvaluate this recurrence for $n=0,1,2$ using $h[-1]=0$ and $h[-2]=0$:\n- For $n=0$:\n$$h[0]+a_{1}h[-1]+a_{2}h[-2]=2 \\implies h[0]=2,$$\nconsistent with the measurement.\n- For $n=1$:\n$$h[1]+a_{1}h[0]+a_{2}h[-1]=0 \\implies h[1]+a_{1}h[0]=0 \\implies a_{1}=-\\frac{h[1]}{h[0]}.$$\nUsing $h[1]=1.6=\\frac{8}{5}$ and $h[0]=2$,\n$$a_{1}=-\\frac{\\frac{8}{5}}{2}=-\\frac{8}{10}=-\\frac{4}{5}.$$\n- For $n=2$:\n$$h[2]+a_{1}h[1]+a_{2}h[0]=0 \\implies a_{2}=-\\frac{h[2]+a_{1}h[1]}{h[0]}.$$\nUsing $h[2]=0.48=\\frac{12}{25}$, $h[1]=\\frac{8}{5}$, and $a_{1}=-\\frac{4}{5}$,\n$$h[2]+a_{1}h[1]=\\frac{12}{25}-\\frac{4}{5}\\cdot\\frac{8}{5}=\\frac{12}{25}-\\frac{32}{25}=-\\frac{20}{25}=-\\frac{4}{5},$$\nhence\n$$a_{2}=-\\frac{-\\frac{4}{5}}{2}=\\frac{4}{5}\\cdot\\frac{1}{2}=\\frac{2}{5}.$$\nTherefore, the feedback coefficients are $a_{1}=-\\frac{4}{5}$ and $a_{2}=\\frac{2}{5}$.", "answer": "$$\\boxed{\\left(-\\frac{4}{5}, \\frac{2}{5}\\right)}$$", "id": "1714591"}, {"introduction": "A system's complete behavior is composed of both its response to an external input and its own \"natural\" response. This natural response, or zero-input response, describes how the system behaves when the input is removed but energy remains stored in its internal memory elements (delays). This practice explores these internal dynamics by requiring you to calculate the output of a filter given only its initial state [@problem_id:1714608]. Mastering this concept is crucial for understanding the transient behavior and stability of recursive filters, which are determined by the roots of the system's characteristic equation.", "problem": "A digital resonator, a key component in audio synthesis and filtering, is implemented using a second-order Direct Form II structure. In this structure, an input signal $x[n]$ is first processed to generate an intermediate state signal $w[n]$ according to the difference equation:\n$$w[n] = x[n] + w[n-1] - \\frac{1}{2} w[n-2]$$\nThe final output signal $y[n]$ is synthesized from the state signal via a second equation:\n$$y[n] = w[n] - w[n-2]$$\nAt time $n=0$, the input to the resonator is turned off, meaning $x[n] = 0$ for all $n \\ge 0$. However, due to prior activity, the memory elements of the filter (the delay blocks) hold non-zero initial values. Specifically, the values corresponding to the state signal are $w[-1] = 1$ and $w[-2] = 2$.\n\nYour task is to determine the resulting output of the system for $n \\ge 0$. This output is known as the zero-input response, $y_{zi}[n]$. Find a closed-form expression for $y_{zi}[n]$ for $n \\ge 0$.", "solution": "Since $x[n]=0$ for all $n \\ge 0$, the state equation reduces to the homogeneous linear constant-coefficient difference equation\n$$\nw[n] - w[n-1] + \\frac{1}{2} w[n-2] = 0.\n$$\nThe characteristic equation is\n$$\nr^{2} - r + \\frac{1}{2} = 0,\n$$\nwith roots\n$$\nr_{1,2} = \\frac{1 \\pm \\mathrm{i}}{2} = \\rho \\exp(\\pm \\mathrm{i}\\theta), \\quad \\rho = 2^{-1/2}, \\quad \\theta = \\frac{\\pi}{4}.\n$$\nThus the general solution is\n$$\nw[n] = \\alpha r_{1}^{n} + \\beta r_{2}^{n}.\n$$\nUse the given initial state values to find $w[0]$ and $w[1]$ from the recursion:\n$$\nw[0] = x[0] + w[-1] - \\frac{1}{2} w[-2] = 0 + 1 - \\frac{1}{2}\\cdot 2 = 0,\n$$\n$$\nw[1] = x[1] + w[0] - \\frac{1}{2} w[-1] = 0 + 0 - \\frac{1}{2}\\cdot 1 = -\\frac{1}{2}.\n$$\nImposing $w[0]=0$ gives $\\alpha + \\beta = 0 \\Rightarrow \\beta = -\\alpha$. Then\n$$\nw[1] = \\alpha r_{1} + \\beta r_{2} = \\alpha(r_{1} - r_{2}) = -\\frac{1}{2}.\n$$\nSince $r_{1} - r_{2} = \\mathrm{i}$, it follows that $\\alpha \\mathrm{i} = -\\frac{1}{2}$, hence $\\alpha = \\frac{\\mathrm{i}}{2}$ and $\\beta = -\\frac{\\mathrm{i}}{2}$. Therefore,\n$$\nw[n] = \\frac{\\mathrm{i}}{2}\\left(r_{1}^{n} - r_{2}^{n}\\right) = -\\rho^{n} \\sin(n\\theta) = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right).\n$$\nThe output is $y[n] = w[n] - w[n-2]$, so for $n \\ge 0$,\n$$\ny_{zi}[n] = -2^{-n/2} \\sin\\left(\\frac{\\pi}{4} n\\right) + 2^{-(n-2)/2} \\sin\\left(\\frac{\\pi}{4} (n-2)\\right).\n$$\nThis is the desired closed-form zero-input response.", "answer": "$$\\boxed{2^{-(n-2)/2}\\sin\\left(\\frac{\\pi}{4}(n-2)\\right)-2^{-n/2}\\sin\\left(\\frac{\\pi}{4}n\\right)}$$", "id": "1714608"}]}