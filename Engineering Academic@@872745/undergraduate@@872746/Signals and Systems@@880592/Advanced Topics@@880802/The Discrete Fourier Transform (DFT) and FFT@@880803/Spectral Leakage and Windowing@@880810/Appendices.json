{"hands_on_practices": [{"introduction": "In the idealized world of theory, a pure sinusoid has a spectrum with two infinitely sharp lines. However, real-world analysis is always performed on finite-length signal segments. This exercise explores the consequences of this truncation, which is equivalent to applying a rectangular window, and helps build an intuition for the resulting spectral smearing known as spectral leakage. Understanding the shape of this leakage, with its characteristic main lobe and side lobes, is the first step toward managing it. [@problem_id:1753673]", "problem": "An engineer is analyzing a discrete-time signal $x[n]$ known to be a pure deterministic sinusoid with amplitude $A$ and a constant, normalized angular frequency $\\omega_0$, where $0 < \\omega_0 < \\pi$. The signal is given by the expression $x[n] = A \\cos(\\omega_0 n)$.\n\nFor practical analysis using a digital computer, only a finite-length segment of the signal can be processed. This truncation is modeled by multiplying the ideal signal $x[n]$ by a rectangular window function, $w_R[n]$. The window is of length $M$ and is defined as $w_R[n] = 1$ for $0 \\le n \\le M-1$ and $w_R[n] = 0$ otherwise. The resulting signal to be analyzed is $y[n] = x[n] w_R[n]$.\n\nThe engineer then computes the Discrete-Time Fourier Transform (DTFT) of the windowed signal, denoted as $Y(e^{j\\omega})$. Which of the following options provides the most accurate qualitative description of the magnitude spectrum, $|Y(e^{j\\omega})|$, for the principal frequency range $-\\pi < \\omega < \\pi$?\n\nA. Two infinitely sharp impulses (Dirac delta functions) located precisely at frequencies $\\omega = \\omega_0$ and $\\omega = -\\omega_0$.\n\nB. A single broad central peak (main lobe) centered at $\\omega = 0$, accompanied by a series of smaller, decaying ripples (sidelobes) that extend across the frequency range.\n\nC. Two prominent peaks (main lobes), centered near the frequencies $\\omega = \\omega_0$ and $\\omega = -\\omega_0$, with each peak being accompanied by a series of smaller, decaying ripples (sidelobes).\n\nD. A spectrum with a constant, non-zero magnitude across the entire frequency range from $-\\pi$ to $\\pi$.\n\nE. A series of equally spaced, equally high impulses located at integer multiples of the frequency $\\frac{2\\pi}{M}$.", "solution": "We start from the given signal and window:\n$$x[n]=A\\cos(\\omega_{0} n),\\quad w_{R}[n]=\\begin{cases}1,&0\\leq n\\leq M-1\\\\ 0,&\\text{otherwise}\\end{cases},\\quad y[n]=x[n]w_{R}[n].$$\nUsing Euler's identity, write the cosine as\n$$x[n]=\\frac{A}{2}\\left(\\exp(j\\omega_{0} n)+\\exp(-j\\omega_{0} n)\\right),$$\nso\n$$y[n]=\\frac{A}{2}\\left(w_{R}[n]\\exp(j\\omega_{0} n)+w_{R}[n]\\exp(-j\\omega_{0} n)\\right).$$\nDefine the DTFT by\n$$Y(e^{j\\omega})=\\sum_{n=-\\infty}^{\\infty}y[n]\\exp(-j\\omega n).$$\nBy linearity and the modulation property of the DTFT,\n$$\\mathcal{F}\\{w_{R}[n]\\exp(j\\omega_{0} n)\\}=W_{R}(e^{j(\\omega-\\omega_{0})}),\\quad \\mathcal{F}\\{w_{R}[n]\\exp(-j\\omega_{0} n)\\}=W_{R}(e^{j(\\omega+\\omega_{0})}),$$\nso\n$$Y(e^{j\\omega})=\\frac{A}{2}\\left(W_{R}(e^{j(\\omega-\\omega_{0})})+W_{R}(e^{j(\\omega+\\omega_{0})})\\right).$$\nThe DTFT of the length-$M$ rectangular window is the Dirichlet kernel (up to a linear phase):\n$$W_{R}(e^{j\\omega})=\\sum_{n=0}^{M-1}\\exp(-j\\omega n)=\\exp\\!\\left(-j\\omega\\frac{M-1}{2}\\right)\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}.$$\nTherefore,\n$$|W_{R}(e^{j\\omega})|=\\left|\\frac{\\sin\\!\\left(\\frac{M\\omega}{2}\\right)}{\\sin\\!\\left(\\frac{\\omega}{2}\\right)}\\right|,$$\nwhich has a main lobe centered at $\\omega=0$ with decaying sidelobes. Substituting into $Y(e^{j\\omega})$ gives\n$$|Y(e^{j\\omega})|=\\frac{A}{2}\\left|W_{R}(e^{j(\\omega-\\omega_{0})})+W_{R}(e^{j(\\omega+\\omega_{0})})\\right|,$$\nwhich, qualitatively, is the superposition of two shifted copies of the Dirichlet magnitude, one centered at $\\omega=\\omega_{0}$ and the other at $\\omega=-\\omega_{0}$. Because $0<\\omega_{0}<\\pi$, both peaks lie within the principal range $-\\pi<\\omega<\\pi$. Each of these two peaks exhibits a main lobe with accompanying decaying sidelobes due to the rectangular window.\n\nHence, the correct qualitative description is two prominent main lobes centered near $\\omega=\\pm\\omega_{0}$, each with sidelobes.\n\nComparing with the options:\n- A is incorrect because truncation by a finite window broadens deltas into main lobes with sidelobes.\n- B is the spectrum of the window alone (centered at $0$), not of the modulated windowed sinusoid.\n- C matches the derived structure.\n- D is incorrect; the magnitude is not flat.\n- E describes a line spectrum for periodic/discrete frequencies, not the DTFT of a finite segment.\n\nTherefore, the correct choice is C.", "answer": "$$\\boxed{C}$$", "id": "1753673"}, {"introduction": "While the rectangular window is the simplest way to truncate a signal, its significant spectral leakage can obscure important details. This practice presents a common and challenging scenario in signal processing: detecting a very weak signal in the presence of a much stronger one. By comparing the performance of a rectangular window to a Hann window, you will quantify the crucial trade-off between a window's main-lobe width and its side-lobe suppression capabilities. [@problem_id:1753664]", "problem": "An engineer is analyzing a signal from a sensor using a Discrete Fourier Transform (DFT). The signal is sampled at a frequency $f_s = 10 \\text{ kHz}$ and a block of $N=1000$ samples is collected for analysis. The signal is known to contain a very strong sinusoidal component and a potentially very weak sinusoidal component. The total signal can be modeled as $x(t) = s_1(t) + s_2(t)$, where:\n\n1.  The strong component is $s_1(t) = A_1 \\cos(2\\pi f_1 t)$ with amplitude $A_1 = 1.0$ (in arbitrary units) and frequency $f_1 = 1002 \\text{ Hz}$.\n2.  The weak component is $s_2(t) = A_2 \\cos(2\\pi f_2 t)$ with amplitude $A_2 = 0.0050$ (in the same units) and frequency $f_2 = 1055 \\text{ Hz}$.\n\nThe engineer wants to determine if the weak signal $s_2(t)$ can be detected in the DFT spectrum. A common criterion for detectability is that the magnitude of the weak signal's contribution at a given DFT frequency bin must be greater than the spectral leakage from the strong signal at that same bin. The engineer focuses their analysis on the DFT bin whose frequency is closest to $f_2$.\n\nThe magnitude contribution of a windowed sinusoid of amplitude $A$ with a normalized frequency of $k_{sig}$ to the DFT magnitude at an observed integer bin $k_{obs}$ can be approximated as $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$. Here, $\\Delta k = k_{obs} - k_{sig}$ is the normalized frequency difference, $G(\\Delta k)$ is the normalized magnitude response of the window's spectrum, and $C$ is a scaling constant that depends on the window type and DFT length.\n\nThe values for the normalized magnitude response $G(\\Delta k)$ for a rectangular window (i.e., no windowing) and a Hann window are provided in the table below for the specific $\\Delta k$ values relevant to this problem.\n\n| Window Type  | $G$ at $\\Delta k = 0.5$ | $G$ at $\\Delta k = 4.8$ |\n|--------------|-------------------------|-------------------------|\n| Rectangular  | 0.640                   | 0.0400                  |\n| Hann         | 0.450                   | 0.000500                |\n\nLet $R_{rect}$ be the ratio of the weak signal's magnitude to the strong signal's leakage magnitude at the analysis bin when using a rectangular window. Similarly, let $R_{Hann}$ be the same ratio when using a Hann window.\n\nTo quantify the benefit of using the Hann window in this specific scenario, calculate the improvement factor, defined as the ratio $R_{Hann} / R_{rect}$. Report your final answer rounded to three significant figures.", "solution": "The DFT bin spacing is $\\Delta f = \\frac{f_{s}}{N}$. With $f_{s}=10 \\times 10^{3}$ and $N=1000$, $\\Delta f = 10$. The bin centers are at $k \\Delta f$ with integer $k$.\n\nThe frequency $f_{2}=1055$ lies exactly midway between bins $k=105$ (at $1050$) and $k=106$ (at $1060$). Choosing the lower bin $k_{obs}=105$ makes the weak component detuning $|\\Delta k|=|k_{obs}-k_{sig,2}|=|105-105.5|=0.5$, and the strong component at $f_{1}=1002$ has $k_{sig,1}=\\frac{f_{1}}{\\Delta f}=100.2$, so its detuning to $k_{obs}=105$ is $|\\Delta k|=|105-100.2|=4.8$. These are exactly the $\\Delta k$ values provided in the table.\n\nFor a given window, the magnitude contribution at $k_{obs}$ from a sinusoid of amplitude $A$ is $|X[k_{obs}]| \\approx C \\cdot A \\cdot |G(\\Delta k)|$, where $C$ depends on the window and $N$, and $G$ is the window’s normalized magnitude response.\n\nDefine $R$ as the ratio of the weak component’s magnitude to the strong component’s leakage magnitude at $k_{obs}$. For a given window,\n$$\nR=\\frac{C \\cdot A_{2} \\cdot |G(0.5)|}{C \\cdot A_{1} \\cdot |G(4.8)|}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{|G(0.5)|}{|G(4.8)|}.\n$$\nThus $C$ cancels within each ratio.\n\nFor the rectangular window,\n$$\nR_{rect}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}.\n$$\nFor the Hann window,\n$$\nR_{Hann}=\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}.\n$$\nThe improvement factor is\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.450}{0.000500}}{\\frac{A_{2}}{A_{1}} \\cdot \\frac{0.640}{0.0400}}=\\frac{0.450/0.000500}{0.640/0.0400}=\\frac{0.450 \\cdot 0.0400}{0.000500 \\cdot 0.640}.\n$$\nCompute the numerator and denominator:\n$$\n0.450 \\cdot 0.0400=0.018, \\quad 0.000500 \\cdot 0.640=0.000320.\n$$\nHence\n$$\n\\frac{R_{Hann}}{R_{rect}}=\\frac{0.018}{0.000320}=56.25.\n$$\nRounded to three significant figures, this is $56.3$.", "answer": "$$\\boxed{56.3}$$", "id": "1753664"}, {"introduction": "Window functions are not just tools for mitigating leakage; their well-defined mathematical properties can be exploited for high-precision measurements. This advanced problem demonstrates how to perform frequency estimation with sub-bin accuracy, a technique often used in scientific and engineering applications. By deriving a relationship between the magnitude ratio $r$ of adjacent DFT bins and the true signal's fractional frequency offset $\\delta$, you will see how the predictable shape of a window's spectrum can be used to interpolate between DFT results. [@problem_id:1753689]", "problem": "In high-precision frequency estimation, specialized window functions are used to control spectral leakage. An engineer is working with a custom, real-valued, symmetric window function, $w[n]$, of length $N$. For the purpose of frequency correction, the crucial property of this window is the analytical form of its Discrete-Time Fourier Transform (DTFT), $W(\\omega)$. Near its main lobe, for a normalized frequency offset $\\nu$ (measured in units of Discrete Fourier Transform (DFT) bin widths), the magnitude of the DTFT is accurately modeled by the function:\n$$ |W(\\nu)| = C \\left| \\frac{\\sin(\\pi \\nu)}{\\nu (\\nu^2 - 1)(\\nu^2 - 4)} \\right| $$\nwhere $C$ is a scaling constant.\n\nA test signal, assumed to be a pure sinusoid, is sampled and processed using an $N$-point DFT with this window. The analysis reveals that the signal's energy is spread between two adjacent DFT bins, $k_p$ and $k_{p+1}$, which have the largest magnitudes. The true normalized frequency of the sinusoid is known to lie between these bins and can be expressed as $\\nu_0 = k_p + \\delta$, where $\\delta$ is the fractional frequency offset from bin $k_p$, with $0 < \\delta < 1$.\n\nThe ratio of the magnitudes of these two dominant bins is measured to be $r = \\frac{|X[k_{p+1}]|}{|X[k_p]|}$. For a sufficiently large DFT length $N$, this measurement corresponds to the ratio of the window's DTFT magnitudes evaluated at the respective offsets from the true frequency. Specifically, the bin $k_p$ is at an offset of $-\\delta$ from the true frequency $\\nu_0$, and the bin $k_{p+1}$ is at an offset of $1-\\delta$. Due to the symmetry of the window's magnitude spectrum, $|W(\\nu)| = |W(-\\nu)|$, this ratio can be expressed as $r \\approx \\frac{|W(1-\\delta)|}{|W(\\delta)|}$.\n\nYour task is to derive a closed-form analytic expression for the fractional frequency offset $\\delta$ in terms of the measured magnitude ratio $r$.", "solution": "The problem requires us to find an expression for the fractional frequency offset $\\delta$ based on the ratio of the magnitudes of the two largest adjacent DFT bins, $r$. We are given the relationship $r \\approx \\frac{|W(1-\\delta)|}{|W(\\delta)|}$ and the model for the window's DTFT magnitude spectrum:\n$$ |W(\\nu)| = C \\left| \\frac{\\sin(\\pi \\nu)}{\\nu (\\nu^2 - 1)(\\nu^2 - 4)} \\right| $$\n\nFirst, we set up the ratio using the given expression for $|W(\\nu)|$. The offset for the bin at $k_{p+1}$ is $1-\\delta$, and for the bin at $k_p$ is $\\delta$.\n\n$$ r = \\frac{|W(1-\\delta)|}{|W(\\delta)|} = \\frac{C \\left| \\frac{\\sin(\\pi (1-\\delta))}{(1-\\delta) ((1-\\delta)^2 - 1)((1-\\delta)^2 - 4)} \\right|}{C \\left| \\frac{\\sin(\\pi \\delta)}{\\delta (\\delta^2 - 1)(\\delta^2 - 4)} \\right|} $$\n\nThe constant $C$ cancels out. We can also simplify the trigonometric term. Using the identity $\\sin(\\pi - x) = \\sin(x)$, we have $\\sin(\\pi(1-\\delta)) = \\sin(\\pi - \\pi\\delta) = \\sin(\\pi\\delta)$. Since $\\delta$ is in the range $(0, 1)$, $\\sin(\\pi\\delta)$ is positive. Therefore, $|\\sin(\\pi(1-\\delta))| = |\\sin(\\pi\\delta)| = \\sin(\\pi\\delta)$, and these terms cancel each other out.\n\nThe expression for $r$ simplifies to a ratio of the polynomial parts:\n$$ r = \\left| \\frac{\\frac{1}{(1-\\delta) ((1-\\delta)^2 - 1)((1-\\delta)^2 - 4)}}{\\frac{1}{\\delta (\\delta^2 - 1)(\\delta^2 - 4)}} \\right| = \\left| \\frac{\\delta (\\delta^2 - 1)(\\delta^2 - 4)}{(1-\\delta) ((1-\\delta)^2 - 1)((1-\\delta)^2 - 4)} \\right| $$\n\nNow, let's expand and simplify the factors in the denominator.\nThe term $(1-\\delta)^2 - 1$ can be expanded as $1 - 2\\delta + \\delta^2 - 1 = \\delta^2 - 2\\delta = \\delta(\\delta - 2)$.\nThe term $(1-\\delta)^2 - 4$ can be expanded as $1 - 2\\delta + \\delta^2 - 4 = \\delta^2 - 2\\delta - 3$. Factoring this quadratic gives $(\\delta - 3)(\\delta + 1)$.\n\nSubstituting these factored forms back into the denominator:\n$$ (1-\\delta) ((1-\\delta)^2 - 1)((1-\\delta)^2 - 4) = (1-\\delta) [\\delta(\\delta-2)] [(\\delta-3)(\\delta+1)] $$\nNote that $(1-\\delta) = -(\\delta-1)$.\n\nThe numerator can be factored as:\n$$ \\delta (\\delta^2 - 1)(\\delta^2 - 4) = \\delta (\\delta - 1)(\\delta + 1)(\\delta - 2)(\\delta + 2) $$\n\nNow substitute these factored forms back into the expression for $r$:\n$$ r = \\left| \\frac{\\delta (\\delta - 1)(\\delta + 1)(\\delta - 2)(\\delta + 2)}{-(\\delta - 1) [\\delta(\\delta-2)] [(\\delta-3)(\\delta+1)]} \\right| $$\n\nWe can cancel out several common terms from the numerator and denominator: $\\delta$, $(\\delta-1)$, $(\\delta+1)$, and $(\\delta-2)$.\n$$ r = \\left| \\frac{\\cancel{\\delta} \\cancel{(\\delta - 1)} \\cancel{(\\delta + 1)} \\cancel{(\\delta - 2)} (\\delta + 2)}{- \\cancel{(\\delta - 1)} [\\cancel{\\delta}\\cancel{(\\delta-2)}] [(\\delta-3)\\cancel{(\\delta+1)}]} \\right| $$\n$$ r = \\left| \\frac{\\delta + 2}{-(\\delta - 3)} \\right| = \\left| \\frac{\\delta + 2}{3 - \\delta} \\right| $$\n\nWe are given that $0 < \\delta < 1$. In this interval:\n- The numerator, $\\delta + 2$, is always positive (it ranges from 2 to 3).\n- The denominator, $3 - \\delta$, is also always positive (it ranges from 2 to 3).\nTherefore, the expression inside the absolute value is positive, and we can remove the absolute value signs.\n\n$$ r = \\frac{\\delta + 2}{3 - \\delta} $$\n\nOur final step is to solve this equation for $\\delta$ in terms of $r$.\n$$ r (3 - \\delta) = \\delta + 2 $$\n$$ 3r - r\\delta = \\delta + 2 $$\nRearrange the terms to isolate $\\delta$:\n$$ 3r - 2 = \\delta + r\\delta $$\n$$ 3r - 2 = \\delta(1 + r) $$\n$$ \\delta = \\frac{3r - 2}{1 + r} $$\n\nThis is the final expression for the fractional frequency offset $\\delta$.", "answer": "$$\\boxed{\\frac{3r - 2}{r + 1}}$$", "id": "1753689"}]}