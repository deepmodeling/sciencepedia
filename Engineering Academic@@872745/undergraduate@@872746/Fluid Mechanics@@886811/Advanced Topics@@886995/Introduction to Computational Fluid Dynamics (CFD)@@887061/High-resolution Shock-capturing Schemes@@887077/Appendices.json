{"hands_on_practices": [{"introduction": "The inviscid Burgers' equation serves as a fundamental prototype for understanding nonlinear wave phenomena, including the formation of shock waves. By analyzing a Riemann problem—a simple setup with a sharp initial discontinuity—we can uncover the essential conditions that determine whether the flow evolves into a shock or a smooth rarefaction wave. This practice [@problem_id:1761771] challenges you to apply these principles to predict the formation and direction of a shock wave based solely on the initial left and right states.", "problem": "Consider the one-dimensional inviscid Burgers' equation, a fundamental model for studying the formation of shock waves in fluid dynamics:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x} \\left( \\frac{u^2}{2} \\right) = 0\n$$\nWe are interested in the solution to a Riemann problem for this equation, which is defined by a piecewise-constant initial condition at time $t=0$:\n$$\nu(x, 0) = \n\\begin{cases} \nu_L & \\text{if } x < 0 \\\\\nu_R & \\text{if } x > 0 \n\\end{cases}\n$$\nwhere $u_L$ and $u_R$ are constant states. Depending on the values of $u_L$ and $u_R$, the initial discontinuity at $x=0$ can evolve into either a shock wave (a moving discontinuity) or a rarefaction wave (a smooth, spreading wave).\n\nWhich of the following initial conditions for the states $(u_L, u_R)$ will result in a single shock wave that propagates to the right (i.e., in the positive $x$ direction) for all time $t > 0$?\n\nA. $u_L = 2, u_R = 1$\n\nB. $u_L = 1, u_R = 2$\n\nC. $u_L = -1, u_R = -2$\n\nD. $u_L = -2, u_R = 1$\n\nE. $u_L = 1, u_R = -2$", "solution": "We consider the scalar conservation law with convex flux $f(u) = \\frac{u^{2}}{2}$, so $f'(u) = u$ and $f''(u) = 1 > 0$. For the Riemann problem with left and right states $(u_{L},u_{R})$, the wave pattern is determined as follows:\n- If $u_{L} < u_{R}$ (increasing data), the solution is a rarefaction wave.\n- If $u_{L} > u_{R}$ (decreasing data), the solution is a shock satisfying the Rankine–Hugoniot and Lax entropy conditions.\n\nFor a shock between $u_{L}$ and $u_{R}$, the Rankine–Hugoniot condition gives the shock speed\n$$\ns = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{u_{R}^{2}}{2} - \\frac{u_{L}^{2}}{2}}{u_{R} - u_{L}} = \\frac{u_{L} + u_{R}}{2}.\n$$\nThe Lax entropy condition for a convex flux requires\n$$\nf'(u_{L}) > s > f'(u_{R}) \\quad \\Longleftrightarrow \\quad u_{L} > s > u_{R}.\n$$\nWhen $u_{L} > u_{R}$, one has $u_{R} < \\frac{u_{L} + u_{R}}{2} < u_{L}$, so the Lax condition holds automatically.\n\nA single shock that propagates to the right requires both $u_{L} > u_{R}$ (to have a shock) and $s = \\frac{u_{L} + u_{R}}{2} > 0$ (to move right). We check each option:\n- A: $u_{L} = 2$, $u_{R} = 1$. Here $u_{L} > u_{R}$, so a shock forms, and $s = \\frac{2 + 1}{2} = \\frac{3}{2} > 0$, so it propagates to the right.\n- B: $u_{L} = 1$, $u_{R} = 2$. Since $u_{L} < u_{R}$, this is a rarefaction, not a shock.\n- C: $u_{L} = -1$, $u_{R} = -2$. Since $u_{L} > u_{R}$, a shock forms, but $s = \\frac{-1 + (-2)}{2} = -\\frac{3}{2} < 0$, so it propagates to the left.\n- D: $u_{L} = -2$, $u_{R} = 1$. Since $u_{L} < u_{R}$, this is a rarefaction, not a shock.\n- E: $u_{L} = 1$, $u_{R} = -2$. Since $u_{L} > u_{R}$, a shock forms, but $s = \\frac{1 + (-2)}{2} = -\\frac{1}{2} < 0$, so it propagates to the left.\n\nTherefore, only option A yields a single shock moving to the right for all $t > 0$.", "answer": "$$\\boxed{A}$$", "id": "1761771"}, {"introduction": "While high-order accuracy is desirable for resolving smooth flows, classic schemes like the Lax-Wendroff method often struggle near sharp discontinuities. Their tendency to produce spurious oscillations can lead to catastrophic failures, such as generating non-physical negative pressures or densities. This hands-on calculation [@problem_id:1761785] will guide you through a single time step of the Lax-Wendroff scheme applied to a strong expansion, demonstrating precisely how it fails and underscoring the need for more robust, non-oscillatory methods for shock capturing.", "problem": "A computational fluid dynamics engineer is simulating the one-dimensional flow of a perfect gas using the Euler equations. The simulation employs the two-step Lax-Wendroff scheme to achieve second-order accuracy in space and time. During a test case involving a strong expansion wave, the simulation crashes, reporting non-physical results. Your task is to analyze the cause of this failure by performing a single time-step calculation for a specific grid cell.\n\nThe state of the gas in any cell $j$ is described by a vector of conserved variables $\\mathbf{U}_j = [\\rho_j, (\\rho u)_j, E_j]^T$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total energy per unit volume. The flux vector is $\\mathbf{F}(\\mathbf{U}_j) = [(\\rho u)_j, (\\rho u^2 + p)_j, (u(E+p))_j]^T$. The gas obeys the ideal gas law with the equation of state for pressure given by $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$.\n\nThe two-step Lax-Wendroff scheme updates the state in cell $i$ from time $n$ to $n+1$ as follows:\n\n1.  **Predictor Step**: Calculate the state at the cell interfaces ($i-1/2$ and $i+1/2$) at a half-time step ($n+1/2$). For an interface $j+1/2$ between cells $j$ and $j+1$:\n    $$ \\mathbf{U}_{j+1/2}^{n+1/2} = \\frac{1}{2}(\\mathbf{U}_j^n + \\mathbf{U}_{j+1}^n) - \\frac{\\Delta t}{2\\Delta x}(\\mathbf{F}(\\mathbf{U}_{j+1}^n) - \\mathbf{F}(\\mathbf{U}_j^n)) $$\n\n2.  **Corrector Step**: Use the predicted interface states to update the state of cell $i$:\n    $$ \\mathbf{U}_i^{n+1} = \\mathbf{U}_i^n - \\frac{\\Delta t}{\\Delta x}(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2}) - \\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})) $$\n\nConsider the following non-dimensional initial conditions at time $t=0$ for three adjacent cells, which represent a strong expansion:\n-   **Cell $i-1$**: $\\rho_{i-1} = 1.0$, $u_{i-1} = 0.0$, $p_{i-1} = 1.0$\n-   **Cell $i$**: $\\rho_i = 0.1$, $u_i = 4.0$, $p_i = 0.01$\n-   **Cell $i+1$**: $\\rho_{i+1} = 0.1$, $u_{i+1} = 4.0$, $p_{i+1} = 0.01$\n\nUse the following parameters for your calculation:\n-   Ratio of specific heats: $\\gamma = 1.4$\n-   Time step to grid spacing ratio: $\\frac{\\Delta t}{\\Delta x} = 0.1$\n\nCalculate the pressure $p_i^{n+1}$ in cell $i$ after one time step. Express your answer in the same non-dimensional units as the initial conditions, rounded to three significant figures.", "solution": "We work with the conserved variables $\\mathbf{U}=[\\rho,\\,m,\\,E]^{T}$ where $m=\\rho u$, and the Euler flux $\\mathbf{F}(\\mathbf{U})=[m,\\,\\rho u^{2}+p,\\,u(E+p)]^{T}$. The ideal-gas pressure satisfies $p=(\\gamma-1)\\left(E-\\frac{1}{2}\\rho u^{2}\\right)$, hence $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$.\n\nGiven $\\gamma=1.4$ and $\\Delta t/\\Delta x=\\lambda=0.1$, the three cell states at time $n$ are:\n- Cell $i-1$: $\\rho_{i-1}=1$, $u_{i-1}=0$, $p_{i-1}=1$, so $m_{i-1}=0$ and $E_{i-1}=\\frac{1}{\\gamma-1}+0=\\frac{1}{0.4}=2.5$. Thus\n$$\n\\mathbf{U}_{i-1}=[1,\\,0,\\,2.5]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i-1})=[0,\\,1,\\,0]^{T}.\n$$\n- Cell $i$: $\\rho_{i}=0.1$, $u_{i}=4$, $p_{i}=0.01$, so $m_{i}=0.4$ and $E_{i}=\\frac{0.01}{0.4}+\\frac{1}{2}(0.1)(4^{2})=0.025+0.8=0.825$. Thus\n$$\n\\mathbf{U}_{i}=[0.1,\\,0.4,\\,0.825]^{T},\\quad\n\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}.\n$$\n- Cell $i+1$ equals cell $i$, so $\\mathbf{U}_{i+1}=\\mathbf{U}_{i}$ and $\\mathbf{F}(\\mathbf{U}_{i+1})=\\mathbf{F}(\\mathbf{U}_{i})$.\n\nPredictor at $i-\\tfrac{1}{2}$:\n$$\n\\mathbf{U}_{i-1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i-1}+\\mathbf{U}_{i})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i})-\\mathbf{F}(\\mathbf{U}_{i-1})\\right).\n$$\nComponentwise,\n$$\n\\rho_{L}=\\tfrac{1}{2}(1+0.1)-\\tfrac{0.1}{2}(0.4-0)=0.53,\n$$\n$$\nm_{L}=\\tfrac{1}{2}(0+0.4)-\\tfrac{0.1}{2}(1.61-1)=0.1695,\n$$\n$$\nE_{L}=\\tfrac{1}{2}(2.5+0.825)-\\tfrac{0.1}{2}(3.34-0)=1.4955.\n$$\nThen $u_{L}=m_{L}/\\rho_{L}=0.1695/0.53=1695/5300$, and\n$$\np_{L}=(\\gamma-1)\\left(E_{L}-\\tfrac{1}{2}\\rho_{L}u_{L}^{2}\\right)\n=0.4\\left(1.4955-\\tfrac{1}{2}\\cdot 0.53\\cdot\\left(\\tfrac{1695}{5300}\\right)^{2}\\right)\n\\approx 0.5873583942.\n$$\nHence the left interface flux uses these primitives:\n$$\n\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})=\n\\bigl[m_{L},\\,\\rho_{L}u_{L}^{2}+p_{L},\\,u_{L}(E_{L}+p_{L})\\bigr]\n\\approx\n\\bigl[0.1695,\\,0.6415664232,\\,0.6661216945\\bigr]^{T}.\n$$\n\nPredictor at $i+\\tfrac{1}{2}$:\n$$\n\\mathbf{U}_{i+1/2}^{n+1/2}=\\tfrac{1}{2}(\\mathbf{U}_{i}+\\mathbf{U}_{i+1})-\\tfrac{\\lambda}{2}\\left(\\mathbf{F}(\\mathbf{U}_{i+1})-\\mathbf{F}(\\mathbf{U}_{i})\\right)\n=\\mathbf{U}_{i},\n$$\nso $\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})=\\mathbf{F}(\\mathbf{U}_{i})=[0.4,\\,1.61,\\,3.34]^{T}$.\n\nCorrector for cell $i$:\n$$\n\\mathbf{U}_{i}^{n+1}=\\mathbf{U}_{i}^{n}-\\lambda\\left(\\mathbf{F}(\\mathbf{U}_{i+1/2}^{n+1/2})-\\mathbf{F}(\\mathbf{U}_{i-1/2}^{n+1/2})\\right).\n$$\nCompute the flux difference and update:\n$$\n\\Delta \\mathbf{F}=\\bigl[0.4-0.1695,\\,1.61-0.6415664232,\\,3.34-0.6661216945\\bigr]^{T}\n=\\bigl[0.2305,\\,0.9684335768,\\,2.6738783055\\bigr]^{T},\n$$\n$$\n\\mathbf{U}_{i}^{n+1}=[0.1,\\,0.4,\\,0.825]^{T}-0.1\\,\\Delta \\mathbf{F}\n=\\bigl[0.07695,\\,0.30315664232,\\,0.5576121694505\\bigr]^{T}.\n$$\n\nRecover $p_{i}^{n+1}$ from the EOS:\n$$\np_{i}^{n+1}=(\\gamma-1)\\left(E_{i}^{n+1}-\\tfrac{1}{2}\\rho_{i}^{n+1}(u_{i}^{n+1})^2\\right)\n=(\\gamma-1)\\left(E_{i}^{n+1}-\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\\right).\n$$\nWith $\\rho_{i}^{n+1}=0.07695$, $m_{i}^{n+1}=0.30315664232$, we have\n$$\n\\frac{(m_{i}^{n+1})^{2}}{2\\rho_{i}^{n+1}}\n=\\frac{0.0919039497827365}{0.1539}\\approx 0.597166664,\n$$\nso\n$$\np_{i}^{n+1}=0.4\\left(0.5576121694505-0.597166664\\right)\\approx -0.0158218.\n$$\nRounded to three significant figures, this yields the non-physical negative pressure noted in the crash.", "answer": "$$\\boxed{-1.58 \\times 10^{-2}}$$", "id": "1761785"}, {"introduction": "Modern high-resolution schemes, like those based on Roe's approximate Riemann solver, are designed to overcome the failures of simpler methods. However, even these advanced tools have subtleties, such as the potential to create physically impossible \"expansion shocks.\" This exercise [@problem_id:1761745] delves into a critical diagnostic for this issue, which requires an \"entropy fix,\" by having you analyze a specific flow scenario known as a transonic rarefaction and calculate the properties that signal the need for this crucial correction.", "problem": "Consider the one-dimensional Euler equations for an ideal gas, which are commonly used in computational fluid dynamics (CFD). The system is described by the state vector $U$ and flux vector $F(U)$:\n$$U = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix}$$\nwhere $\\rho$ is the density, $u$ is the velocity, $E$ is the total energy per unit volume, and $p$ is the pressure. The gas is a perfect gas with an equation of state $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$, where the adiabatic index is $\\gamma = 1.4$.\n\nA Riemann problem is defined by two constant states, a left state ($U_L$) and a right state ($U_R$), separated by a discontinuity at $x=0$. At time $t=0$, the states are:\n- Left state ($x<0$): $\\rho_L = 1.0 \\text{ kg/m}^3$, $u_L = 0.9 \\text{ m/s}$, $p_L = 1.0 \\text{ Pa}$.\n- Right state ($x>0$): $\\rho_R = 0.1 \\text{ kg/m}^3$, $u_R = 2.0 \\text{ m/s}$, $p_R = 0.2 \\text{ Pa}$.\n\nRoe's approximate Riemann solver computes a numerical flux at the interface based on a linearized problem. This involves calculating Roe-averaged quantities, denoted by a hat accent. The necessary formulas are:\n- Roe-averaged velocity: $\\hat{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$\n- Roe-averaged total enthalpy: $\\hat{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$, where $H = (E+p)/\\rho$.\n- Roe-averaged speed of sound: $\\hat{c} = \\sqrt{(\\gamma-1)(\\hat{H} - \\frac{1}{2}\\hat{u}^2)}$\n\nThe eigenvalues of the Roe-averaged Jacobian matrix are $\\hat{\\lambda}_1 = \\hat{u} - \\hat{c}$, $\\hat{\\lambda}_2 = \\hat{u}$, and $\\hat{\\lambda}_3 = \\hat{u} + \\hat{c}$. The corresponding eigenvalues for a general state $U$ are $\\lambda_1(U) = u - c$, $\\lambda_2(U) = u$, and $\\lambda_3(U) = u + c$, where $c = \\sqrt{\\gamma p / \\rho}$.\n\nFor the given flow configuration, a numerical instability known as an entropy-violating expansion shock can occur. This is associated with a \"transonic\" characteristic wave family, for which the characteristic speed $\\lambda_k(U)$ changes sign across the interface (i.e., $\\lambda_k(U_L)$ and $\\lambda_k(U_R)$ have opposite signs).\n\nCalculate the Roe-averaged eigenvalue, $\\hat{\\lambda}_k$, corresponding to this specific transonic wave family. Round your final answer to four significant figures and express it in m/s.", "solution": "We are given the one-dimensional Euler equations for a perfect gas with $\\gamma=1.4$, and a Riemann problem with left and right states. The characteristic speeds for a state $U$ are $\\lambda_{1}(U)=u-c$, $\\lambda_{2}(U)=u$, $\\lambda_{3}(U)=u+c$, where $c=\\sqrt{\\gamma p/\\rho}$. The Roe-averaged speeds are $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$, $\\hat{\\lambda}_{2}=\\hat{u}$, $\\hat{\\lambda}_{3}=\\hat{u}+\\hat{c}$, with\n$$\n\\hat{u}=\\frac{\\sqrt{\\rho_{L}}u_{L}+\\sqrt{\\rho_{R}}u_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{H}=\\frac{\\sqrt{\\rho_{L}}H_{L}+\\sqrt{\\rho_{R}}H_{R}}{\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}},\\quad\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)},\n$$\nand $H=(E+p)/\\rho$ with $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$, hence\n$$\nH=\\frac{\\gamma}{\\gamma-1}\\frac{p}{\\rho}+\\frac{1}{2}u^{2}.\n$$\n\nFirst, compute the left and right sound speeds and characteristic speeds to identify the transonic wave family:\n$$\nc_{L}=\\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}}=\\sqrt{1.4\\cdot\\frac{1.0}{1.0}}=\\sqrt{1.4}\\approx 1.183215956,\n$$\n$$\nc_{R}=\\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}}=\\sqrt{1.4\\cdot\\frac{0.2}{0.1}}=\\sqrt{2.8}\\approx 1.673320053.\n$$\nThen\n$$\n\\lambda_{1}(U_{L})=u_{L}-c_{L}\\approx 0.9-1.183215956\\approx -0.283215956,\\quad \\lambda_{2}(U_{L})=u_{L}=0.9,\\quad \\lambda_{3}(U_{L})=u_{L}+c_{L}\\approx 2.083215956,\n$$\n$$\n\\lambda_{1}(U_{R})=u_{R}-c_{R}\\approx 2.0-1.673320053\\approx 0.326679947,\\quad \\lambda_{2}(U_{R})=u_{R}=2.0,\\quad \\lambda_{3}(U_{R})=u_{R}+c_{R}\\approx 3.673320053.\n$$\nOnly the $k=1$ family changes sign across the interface (negative on the left, positive on the right), so the transonic wave family is $k=1$. Therefore we must compute $\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}$.\n\nCompute the total enthalpies:\n$$\n\\frac{\\gamma}{\\gamma-1}=\\frac{1.4}{0.4}=3.5,\\quad\nH_{L}=3.5\\frac{p_{L}}{\\rho_{L}}+\\frac{1}{2}u_{L}^{2}=3.5\\cdot 1.0+\\frac{1}{2}\\cdot 0.9^{2}=3.5+0.405=3.905,\n$$\n$$\nH_{R}=3.5\\frac{p_{R}}{\\rho_{R}}+\\frac{1}{2}u_{R}^{2}=3.5\\cdot\\frac{0.2}{0.1}+\\frac{1}{2}\\cdot 2.0^{2}=3.5\\cdot 2.0+2.0=9.0.\n$$\nCompute Roe averages. With $\\sqrt{\\rho_{L}}=1$ and $\\sqrt{\\rho_{R}}=\\sqrt{0.1}\\approx 0.316227766$, the common denominator is\n$$\nD=\\sqrt{\\rho_{L}}+\\sqrt{\\rho_{R}}=1+0.316227766016838\\approx 1.316227766016838.\n$$\nThen\n$$\n\\hat{u}=\\frac{1\\cdot 0.9+0.316227766016838\\cdot 2.0}{D}=\\frac{1.532455532033676}{1.316227766016838}\\approx 1.1642784,\n$$\n$$\n\\hat{H}=\\frac{1\\cdot 3.905+0.316227766016838\\cdot 9.0}{D}=\\frac{6.751049894151542}{1.316227766016838}\\approx 5.129089409.\n$$\nNow compute the Roe sound speed:\n$$\n\\hat{u}^{2}\\approx (1.1642784)^{2}=1.35554419270656,\\quad \\frac{1}{2}\\hat{u}^{2}\\approx 0.67777209635328,\n$$\n$$\n\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\approx 5.129089409-0.67777209635328\\approx 4.45131731264672,\n$$\n$$\n\\hat{c}=\\sqrt{(\\gamma-1)\\left(\\hat{H}-\\frac{1}{2}\\hat{u}^{2}\\right)}=\\sqrt{0.4\\cdot 4.45131731264672}\\approx \\sqrt{1.780526925058688}\\approx 1.3343638.\n$$\nTherefore, for the transonic family $k=1$,\n$$\n\\hat{\\lambda}_{1}=\\hat{u}-\\hat{c}\\approx 1.1642784-1.3343638\\approx -0.1700854\\ \\text{m/s}.\n$$\nRounding to four significant figures gives $-0.1701$ in m/s.", "answer": "$$\\boxed{-0.1701}$$", "id": "1761745"}]}