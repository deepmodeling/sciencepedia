{"hands_on_practices": [{"introduction": "The first step in controlling any physical system is to develop a mathematical model that describes its behavior. This practice explores this crucial step using the example of a magnetic levitation system, the core technology behind high-speed Maglev trains. We will analyze the nonlinear dynamics of a magnetically levitated ball and use linearization—a fundamental technique in control engineering—to derive a transfer function that approximates its behavior around a stable levitation point, revealing the system's inherent instability [@problem_id:1574534].", "problem": "Consider a simplified model of a magnetic levitation (Maglev) system designed to suspend a small ferromagnetic ball of mass $m$. An electromagnet is positioned directly above the ball. The vertical dynamics of the ball are governed by the force of gravity and the magnetic attraction from the electromagnet.\n\nLet $y(t)$ be the size of the air gap between the bottom of the electromagnet and the top of the ball, with the positive $y$ direction defined as downwards. The force of gravity is $F_g = mg$, acting in the positive $y$ direction, where $g$ is the acceleration due to gravity. The magnetic force is an attractive force, acting in the negative $y$ direction (upwards), and is modeled by the equation $F_{mag} = k \\frac{i(t)^2}{y(t)^2}$, where $i(t)$ is the current flowing through the electromagnet's coil and $k$ is a positive physical constant.\n\nThe system is unstable but can be held in equilibrium at a specific air gap $y_0$ by providing a constant current $i_0$. For a control system analysis, we are interested in the behavior of the system for small deviations from this equilibrium point. Let the input to the system be the small deviation in current, $u(t) = i(t) - i_0$, and the output be the corresponding small deviation in the air gap, $Y(t) = y(t) - y_0$.\n\nAssuming these deviations are small, derive the linearized transfer function $G(s) = \\frac{Y(s)}{U(s)}$ for the system. Express your answer in terms of the equilibrium air gap $y_0$, the equilibrium current $i_0$, and the gravitational acceleration $g$.", "solution": "Define the positive $y$ direction downward. The forces on the ball are gravity $F_{g}=mg$ (downward, positive) and magnetic attraction $F_{mag}=k \\frac{i(t)^{2}}{y(t)^{2}}$ (upward, negative in the $y$-positive convention). By Newton’s second law,\n$$\nm \\ddot{y}(t)=mg-\\frac{k\\,i(t)^{2}}{y(t)^{2}}.\n$$\nAn equilibrium at $(y_{0},i_{0})$ satisfies $\\ddot{y}=0$, hence\n$$\n0=mg-\\frac{k\\,i_{0}^{2}}{y_{0}^{2}}\\quad\\Rightarrow\\quad mg=\\frac{k\\,i_{0}^{2}}{y_{0}^{2}}.\n$$\nLet small deviations be $Y(t)=y(t)-y_{0}$ and $u(t)=i(t)-i_{0}$. Define $f(y,i)=mg-\\frac{k i^{2}}{y^{2}}$. The linearized dynamics about $(y_{0},i_{0})$ are\n$$\nm \\ddot{Y}(t)=\\left.\\frac{\\partial f}{\\partial y}\\right|_{0} Y(t)+\\left.\\frac{\\partial f}{\\partial i}\\right|_{0} u(t),\n$$\nwith\n$$\n\\frac{\\partial f}{\\partial y}=2k\\frac{i^{2}}{y^{3}},\\quad \\frac{\\partial f}{\\partial i}=-2k\\frac{i}{y^{2}}.\n$$\nEvaluating at $(y_{0},i_{0})$ gives\n$$\nm \\ddot{Y}(t)=\\frac{2k i_{0}^{2}}{y_{0}^{3}}\\,Y(t)-\\frac{2k i_{0}}{y_{0}^{2}}\\,u(t).\n$$\nUse the equilibrium relation $mg=\\frac{k i_{0}^{2}}{y_{0}^{2}}$ to eliminate $k/m$:\n$$\n\\frac{k}{m}=\\frac{g y_{0}^{2}}{i_{0}^{2}}.\n$$\nDivide by $m$ to obtain\n$$\n\\ddot{Y}(t)=\\frac{2g}{y_{0}}\\,Y(t)-\\frac{2g}{i_{0}}\\,u(t).\n$$\nTaking Laplace transforms with zero initial conditions,\n$$\ns^{2}Y(s)=\\frac{2g}{y_{0}}\\,Y(s)-\\frac{2g}{i_{0}}\\,U(s),\n$$\nwhich rearranges to\n$$\n\\frac{Y(s)}{U(s)}=\\frac{-\\frac{2g}{i_{0}}}{s^{2}-\\frac{2g}{y_{0}}}.\n$$\nThus, the linearized transfer function expressed in terms of $y_{0}$, $i_{0}$, and $g$ is as above.", "answer": "$$\\boxed{\\frac{-\\frac{2 g}{i_{0}}}{s^{2}-\\frac{2 g}{y_{0}}}}$$", "id": "1574534"}, {"introduction": "With a model in hand, we can design a controller to make the system behave as we desire. This exercise delves into the world of soft robotics, where actuators are made from flexible materials. You will see how a simple proportional feedback controller can fundamentally alter the dynamics of a pneumatic actuator, and you will calculate the precise controller gain needed to achieve a critically damped response—the fastest possible return to a target position without any overshoot [@problem_id:1574544].", "problem": "A single-chamber pneumatic soft actuator is used in a robotic manipulator. The bending motion of this actuator can be modeled as a simplified second-order Linear Time-Invariant (LTI) system. The relationship between the input gauge pressure $P(t)$ and the resulting tip angle $\\theta(t)$ (in radians) is described by the following differential equation:\n$$ J \\frac{d^{2}\\theta(t)}{dt^{2}} + B \\frac{d\\theta(t)}{dt} + K \\theta(t) = \\alpha P(t) $$\nHere, $J$ represents the effective rotational inertia of the actuator, $B$ is the viscous damping coefficient due to material and air friction, $K$ is the effective rotational stiffness of the actuator's elastic body, and $\\alpha$ is a constant that converts pressure into torque. All these parameters ($J, B, K, \\alpha$) are positive real constants.\n\nTo control the actuator's tip angle, a proportional controller is implemented. This controller adjusts the input pressure based on the error between a constant desired angle $\\theta_{d}$ and the measured current angle $\\theta(t)$. The control law is given by:\n$$ P(t) = K_{c} (\\theta_{d} - \\theta(t)) $$\nwhere $K_{c}$ is the proportional controller gain.\n\nDetermine the analytical expression for the controller gain $K_{c}$ that ensures the closed-loop system exhibits a critically damped response. Express your answer in terms of $J$, $B$, $K$, and $\\alpha$.", "solution": "The plant dynamics are given by\n$$\nJ \\frac{d^{2}\\theta(t)}{dt^{2}} + B \\frac{d\\theta(t)}{dt} + K \\theta(t) = \\alpha P(t),\n$$\nwith proportional control law\n$$\nP(t) = K_{c}\\left(\\theta_{d} - \\theta(t)\\right).\n$$\nSubstitute the control law into the plant equation:\n$$\nJ \\frac{d^{2}\\theta}{dt^{2}} + B \\frac{d\\theta}{dt} + K \\theta = \\alpha K_{c}\\theta_{d} - \\alpha K_{c}\\theta.\n$$\nCollect the terms in $\\theta$ on the left-hand side:\n$$\nJ \\frac{d^{2}\\theta}{dt^{2}} + B \\frac{d\\theta}{dt} + \\left(K + \\alpha K_{c}\\right)\\theta = \\alpha K_{c}\\theta_{d}.\n$$\nThe closed-loop dynamics (homogeneous part) that govern the pole locations are\n$$\nJ \\frac{d^{2}\\theta}{dt^{2}} + B \\frac{d\\theta}{dt} + \\left(K + \\alpha K_{c}\\right)\\theta = 0,\n$$\nwith characteristic polynomial\n$$\nJ s^{2} + B s + \\left(K + \\alpha K_{c}\\right) = 0.\n$$\nFor a critically damped second-order system, the characteristic polynomial must have a repeated real root, which is equivalent to requiring that the discriminant be zero:\n$$\nB^{2} - 4 J \\left(K + \\alpha K_{c}\\right) = 0.\n$$\nSolve for $K_{c}$:\n$$\nK + \\alpha K_{c} = \\frac{B^{2}}{4 J}\n\\quad \\Longrightarrow \\quad\n\\alpha K_{c} = \\frac{B^{2}}{4 J} - K\n\\quad \\Longrightarrow \\quad\nK_{c} = \\frac{B^{2} - 4 J K}{4 J \\alpha}.\n$$\nThis $K_{c}$ makes the closed-loop system critically damped.", "answer": "$$\\boxed{\\frac{B^{2}-4 J K}{4 J \\alpha}}$$", "id": "1574544"}, {"introduction": "State-feedback control is a powerful modern technique, but it requires knowledge of all the system's state variables, which are often not directly measurable. This problem addresses this common real-world challenge through the design of a state observer for a building's climate control system. By measuring the temperature in just one zone, you will design an observer that can accurately estimate the temperatures in all zones, enabling sophisticated control strategies even with limited sensor information [@problem_id:1574548].", "problem": "Consider a simplified thermal model for a building with two zones, managed by a Heating, Ventilation, and Air Conditioning (HVAC) system. Zone 1 is a server room with significant internal heat generation, and Zone 2 is an adjacent office space. The system's thermal dynamics are described by the following coupled linear differential equations, where all temperatures are measured in Kelvin (K), time in seconds (s), energy in Joules (J) and power in Watts (W):\n\n$C_1 \\frac{dT_1}{dt} = -K_{1a}(T_1 - T_a) - K_{12}(T_1 - T_2) - \\alpha(T_1 - T_a) + u_1(t)$\n$C_2 \\frac{dT_2}{dt} = -K_{2a}(T_2 - T_a) + K_{12}(T_1 - T_2) + \\alpha(T_1 - T_2)$\n\nHere, $T_1(t)$ and $T_2(t)$ are the temperatures of Zone 1 and Zone 2, respectively. $T_a$ is the constant ambient outside temperature. The control input $u_1(t)$ represents the net heat rate added to Zone 1 by the HVAC system and internal electronic equipment. The parameters of the system are given as:\n- Thermal capacitance of Zone 1: $C_1 = 1.0 \\times 10^5 \\text{ J/K}$\n- Thermal capacitance of Zone 2: $C_2 = 1.75 \\times 10^5 \\text{ J/K}$\n- Thermal conductance to ambient for Zone 1: $K_{1a} = 150 \\text{ W/K}$\n- Thermal conductance to ambient for Zone 2: $K_{2a} = 175 \\text{ W/K}$\n- Thermal conductance between zones: $K_{12} = 200 \\text{ W/K}$\n- Advective heat transfer coefficient due to one-way airflow from Zone 1 to Zone 2: $\\alpha = 150 \\text{ W/K}$\n\nThe system is to be controlled based on state feedback, but a sensor is only available to measure the temperature in Zone 2. A Luenberger observer is designed to estimate the temperatures in both zones. Let the state variables be the temperature deviations from ambient: $x_1 = T_1 - T_a$ and $x_2 = T_2 - T_a$. The state-space representation is $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u_1(t)$, with the measurement being $y = x_2$.\n\nYour task is to determine the observer gain vector $L = \\begin{pmatrix} L_1 \\\\ L_2 \\end{pmatrix}$ for a full-state observer with dynamics $\\dot{\\hat{\\mathbf{x}}} = A\\hat{\\mathbf{x}} + B u_1(t) + L(y - \\hat{y})$. The observer is to be designed such that the eigenvalues (poles) of the observer error dynamics are placed at $-0.010 \\text{ s}^{-1}$ and $-0.012 \\text{ s}^{-1}$.\n\nExpress the components of the gain vector $L$ as a row matrix $\\begin{pmatrix} L_1  L_2 \\end{pmatrix}$, with values given in units of $\\text{s}^{-1}$.", "solution": "Define the deviation states $x_{1} = T_{1} - T_{a}$ and $x_{2} = T_{2} - T_{a}$. Since $T_{a}$ is constant, $\\dot{x}_{i} = \\dot{T}_{i}$. Rewrite the given dynamics in terms of $x_{1},x_{2}$:\n$$\nC_{1}\\dot{x}_{1} = -(K_{1a}+\\alpha)x_{1} - K_{12}(x_{1}-x_{2}) + u_{1}\n= -(K_{1a}+K_{12}+\\alpha)x_{1} + K_{12}x_{2} + u_{1},\n$$\n$$\nC_{2}\\dot{x}_{2} = -K_{2a}x_{2} + (K_{12}+\\alpha)(x_{1}-x_{2})\n= (K_{12}+\\alpha)x_{1} - (K_{2a}+K_{12}+\\alpha)x_{2}.\n$$\nThus the state-space model $\\dot{\\mathbf{x}} = A\\mathbf{x} + B u_{1}$ with $y = x_{2}$ has\n$$\nA = \\begin{pmatrix}\n-\\dfrac{K_{1a}+K_{12}+\\alpha}{C_{1}}  \\dfrac{K_{12}}{C_{1}}\\\\[6pt]\n\\dfrac{K_{12}+\\alpha}{C_{2}}  -\\dfrac{K_{2a}+K_{12}+\\alpha}{C_{2}}\n\\end{pmatrix},\\quad\nB = \\begin{pmatrix} \\dfrac{1}{C_{1}} \\\\[4pt] 0 \\end{pmatrix},\\quad\nC = \\begin{pmatrix} 0  1 \\end{pmatrix}.\n$$\nWith the observer $\\dot{\\hat{\\mathbf{x}}} = A\\hat{\\mathbf{x}} + Bu_{1} + L(y-\\hat{y})$, the error $\\mathbf{e} = \\mathbf{x}-\\hat{\\mathbf{x}}$ evolves as\n$$\n\\dot{\\mathbf{e}} = (A - L C)\\mathbf{e},\\quad L = \\begin{pmatrix} L_{1} \\\\ L_{2} \\end{pmatrix}.\n$$\nSince $$LC = \\begin{pmatrix} 0  L_{1} \\\\ 0  L_{2} \\end{pmatrix},$$ we have\n$$\nA - LC = \\begin{pmatrix}\na_{11}  a_{12} - L_{1}\\\\\na_{21}  a_{22} - L_{2}\n\\end{pmatrix},\\quad\n\\text{where } a_{11} = -\\dfrac{K_{1a}+K_{12}+\\alpha}{C_{1}},\\; a_{12} = \\dfrac{K_{12}}{C_{1}},\\; a_{21} = \\dfrac{K_{12}+\\alpha}{C_{2}},\\; a_{22} = -\\dfrac{K_{2a}+K_{12}+\\alpha}{C_{2}}.\n$$\nThe characteristic polynomial is\n$$\np(\\lambda) = \\det\\!\\big(\\lambda I - (A - LC)\\big)\n= \\lambda^{2} - \\lambda\\big(a_{11}+a_{22}-L_{2}\\big) + \\big(a_{11}(a_{22}-L_{2}) - a_{21}(a_{12}-L_{1})\\big).\n$$\nWe desire poles at $-0.010$ and $-0.012$, so the desired polynomial is\n$$\np_{d}(\\lambda) = (\\lambda+0.010)(\\lambda+0.012) = \\lambda^{2} + 0.022\\,\\lambda + 0.00012.\n$$\nMatching coefficients gives\n$$\na_{11}+a_{22}-L_{2} = -0.022,\\quad\na_{11}(a_{22}-L_{2}) - a_{21}(a_{12}-L_{1}) = 0.00012.\n$$\nCompute the entries of $A$ using the given parameters:\n$$\na_{11} = -\\dfrac{150+200+150}{1.0\\times 10^{5}} = -0.005,\\quad\na_{12} = \\dfrac{200}{1.0\\times 10^{5}} = 0.002,\n$$\n$$\na_{21} = \\dfrac{200+150}{1.75\\times 10^{5}} = \\dfrac{350}{175000} = 0.002,\\quad\na_{22} = -\\dfrac{175+200+150}{1.75\\times 10^{5}} = -\\dfrac{525}{175000} = -0.003.\n$$\nFirst, from the trace condition,\n$$\nL_{2} = a_{11}+a_{22}+0.022 = (-0.005) + (-0.003) + 0.022 = 0.014.\n$$\nNext, from the constant term condition, write\n$$\n0.00012 = \\big(a_{11}a_{22} - a_{21}a_{12}\\big) - a_{11}L_{2} + a_{21}L_{1}.\n$$\nCompute\n$$\na_{11}a_{22} - a_{21}a_{12} = (-0.005)(-0.003) - (0.002)(0.002) = 0.000015 - 0.000004 = 0.000011,\n$$\n$$\n-a_{11}L_{2} = -(-0.005)(0.014) = 0.00007.\n$$\nThus\n$$\n0.00012 = 0.000011 + 0.00007 + a_{21}L_{1} \\;\\Rightarrow\\; a_{21}L_{1} = 0.00012 - 0.000081 = 0.000039,\n$$\n$$\nL_{1} = \\dfrac{0.000039}{0.002} = 0.0195.\n$$\nTherefore,\n$$\nL = \\begin{pmatrix} 0.0195 \\\\ 0.014 \\end{pmatrix},\n$$\nwhich yields observer error dynamics with eigenvalues at the desired locations. A quick check: $\\operatorname{tr}(A-LC) = a_{11}+a_{22}-L_{2} = -0.022$ and $\\det(A-LC) = 0.00012$, matching the target polynomial $\\lambda^{2} + 0.022\\lambda + 0.00012$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.0195  0.014 \\end{pmatrix}}$$", "id": "1574548"}]}