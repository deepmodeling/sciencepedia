{"hands_on_practices": [{"introduction": "The first step in mastering the bilinear transformation is learning the core mechanical process of converting a continuous-time system into a discrete-time one. This practice provides a direct, hands-on application of this crucial technique. By taking a simple first-order analog transfer function $H_a(s)$ and a given sampling period $T$, you will perform the algebraic substitution that maps the $s$-plane to the $z$-plane, yielding the equivalent digital transfer function $H_d(z)$ [@problem_id:1559640].", "problem": "A control systems engineer is tasked with replacing an analog signal processing unit with a digital equivalent. The analog unit is a stable, first-order system whose behavior is described by the continuous-time transfer function $H_a(s)$, given by:\n\n$$H_a(s) = \\frac{3}{s+2}$$\n\nTo create the digital version, the engineer decides to use the bilinear transformation method. The system will be sampled with a sampling period of $T = 1$ second.\n\nDetermine the transfer function $H_d(z)$ of the resulting discrete-time system. Express your answer as a rational function of $z$.", "solution": "We use the bilinear (Tustin) transformation, which maps the continuous-time Laplace variable $s$ to the discrete-time $z$-domain via\n$$\ns=\\frac{2}{T}\\cdot\\frac{z-1}{z+1}.\n$$\nFor a given continuous-time transfer function $H_{a}(s)$, the discrete-time transfer function obtained by the bilinear transform is\n$$\nH_{d}(z)=H_{a}\\!\\left(\\frac{2}{T}\\cdot\\frac{z-1}{z+1}\\right).\n$$\n\nGiven $H_{a}(s)=\\dfrac{3}{s+2}$ and $T=1$, substitute $s=\\dfrac{2(z-1)}{z+1}$:\n$$\nH_{d}(z)=\\frac{3}{\\dfrac{2(z-1)}{z+1}+2}.\n$$\nCombine terms in the denominator over the common denominator $(z+1)$:\n$$\n\\dfrac{2(z-1)}{z+1}+2=\\frac{2(z-1)+2(z+1)}{z+1}=\\frac{2z-2+2z+2}{z+1}=\\frac{4z}{z+1}.\n$$\nThus,\n$$\nH_{d}(z)=\\frac{3}{\\dfrac{4z}{z+1}}=3\\cdot\\frac{z+1}{4z}=\\frac{3(z+1)}{4z}.\n$$\nThis is a rational function of $z$, as required.", "answer": "$$\\boxed{\\frac{3(z+1)}{4z}}$$", "id": "1559640"}, {"introduction": "Understanding a transformation often means being able to reverse it. This exercise challenges you to work backward, starting with a given digital filter transfer function $H(z)$ and deducing the original analog filter $H_a(s)$ from which it was derived [@problem_id:1559637]. Completing this task solidifies your grasp of the algebraic relationship between the $s$ and $z$ variables and demonstrates the one-to-one mapping that the bilinear transform provides.", "problem": "In digital control systems, continuous-time analog filters are often converted into discrete-time digital filters for implementation on microcontrollers. A common method for this conversion is the bilinear transformation.\n\nA simple digital filter has been implemented with a transfer function in the z-domain given by:\n$$H(z) = \\frac{z+1}{z-0.9}$$\nThis digital filter was obtained from an original analog filter, $H(s)$, using the bilinear transformation with a sampling period of $T = 0.1$ seconds.\n\nYour task is to reverse the process and determine the transfer function $H(s)$ of the original continuous-time analog filter.", "solution": "We use the bilinear (Tustin) transformation. The analog-to-digital mapping is\n$$\ns=\\frac{2}{T}\\frac{z-1}{z+1},\n$$\nequivalently,\n$$\nz=\\frac{1+\\frac{T}{2}s}{1-\\frac{T}{2}s}.\n$$\nTo recover the analog transfer function from the given digital one, substitute the above expression for $z$ into $H(z)$ and define $H(s)=H\\!\\left(z(s)\\right)$:\n$$\nH(s)=\\frac{z(s)+1}{z(s)-\\frac{9}{10}},\\quad z(s)=\\frac{1+\\frac{T}{2}s}{1-\\frac{T}{2}s}.\n$$\nCompute the numerator and denominator:\n$$\nz(s)+1=\\frac{1+\\frac{T}{2}s}{1-\\frac{T}{2}s}+1=\\frac{2}{1-\\frac{T}{2}s},\n$$\n$$\nz(s)-\\frac{9}{10}=\\frac{1+\\frac{T}{2}s}{1-\\frac{T}{2}s}-\\frac{9}{10}\n=\\frac{\\left(1+\\frac{T}{2}s\\right)-\\frac{9}{10}\\left(1-\\frac{T}{2}s\\right)}{1-\\frac{T}{2}s}\n=\\frac{\\frac{1}{10}+\\frac{19}{20}\\cdot\\frac{T}{2}s}{1-\\frac{T}{2}s}.\n$$\nTherefore,\n$$\nH(s)=\\frac{\\frac{2}{1-\\frac{T}{2}s}}{\\frac{\\frac{1}{10}+\\frac{19}{20}\\cdot\\frac{T}{2}s}{1-\\frac{T}{2}s}}\n=\\frac{2}{\\frac{1}{10}+\\frac{19}{20}\\cdot\\frac{T}{2}s}.\n$$\nWith the given sampling period $T=\\frac{1}{10}$, this becomes\n$$\nH(s)=\\frac{2}{\\frac{1}{10}+\\frac{19}{200}s}\n=\\frac{2}{\\frac{1}{200}\\left(20+19s\\right)}\n=\\frac{400}{19s+20}.\n$$\nThis is the continuous-time transfer function whose bilinear transform with $T=\\frac{1}{10}$ yields the given $H(z)$.", "answer": "$$\\boxed{\\frac{400}{19s+20}}$$", "id": "1559637"}, {"introduction": "While the bilinear transformation is excellent at preserving the stability of an analog system, it comes with a significant side effect known as frequency warping. This practice moves beyond pure calculation to explore this fundamental concept, which is a non-linear mapping between the analog frequency $\\Omega$ and the digital frequency $\\omega$ [@problem_id:1726279]. By analyzing why a filter designed this way cannot have a linear phase, you will gain critical insight into the limitations and design considerations inherent to this powerful method.", "problem": "A signals and systems student is designing a discrete-time Infinite Impulse Response (IIR) filter. The design procedure begins with the selection of a stable, causal, third-order analog Butterworth prototype filter with transfer function $H_a(s)$. The student then applies the bilinear transformation, defined by the substitution $s = k \\frac{1-z^{-1}}{1+z^{-1}}$ where $k$ is a real positive constant, to map the analog filter into a discrete-time filter with transfer function $H_d(z)$. Upon analyzing the frequency response $H_d(e^{j\\omega})$, the student correctly observes that the phase response, $\\angle H_d(e^{j\\omega})$, is not a linear function of the digital frequency $\\omega$.\n\nWhich of the following statements provides the most fundamental reason inherent to the bilinear transformation method that explains this observation?\n\nA. Linear phase is theoretically achievable only for Finite Impulse Response (FIR) filters, so any IIR filter, regardless of its design method, will have a non-linear phase.\n\nB. The analog Butterworth prototype filter does not have a linear phase response to begin with. The bilinear transformation merely translates this pre-existing non-linearity into the digital domain.\n\nC. The bilinear transformation establishes a non-linear mapping, known as frequency warping, between the analog frequency axis ($\\Omega$) and the digital frequency axis ($\\omega$). This warping distorts the phase function, making a linear phase response in the digital domain impossible.\n\nD. The order of the Butterworth filter is odd (three). Had an even-order prototype been chosen, the resulting pole-zero symmetry in the z-plane would have guaranteed a linear phase response.\n\nE. The bilinear transformation is a rational function of $z$, which always introduces more poles than zeros into the transfer function $H_d(z)$, thereby preventing the symmetry required for linear phase.", "solution": "The bilinear transformation is defined by the substitution\n$$\ns = k\\,\\frac{1 - z^{-1}}{1 + z^{-1}},\n$$\nwith $k0$. To analyze the digital frequency response, set $z$ on the unit circle as $z=\\exp(j\\omega)$. Then\n$$\n1 - z^{-1} = 1 - \\exp(-j\\omega) = \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\left(\\exp\\!\\left(\\frac{j\\omega}{2}\\right) - \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\right) = \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\,2j\\sin\\!\\left(\\frac{\\omega}{2}\\right),\n$$\n$$\n1 + z^{-1} = 1 + \\exp(-j\\omega) = \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\left(\\exp\\!\\left(\\frac{j\\omega}{2}\\right) + \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\right) = \\exp\\!\\left(-\\frac{j\\omega}{2}\\right)\\,2\\cos\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nHence\n$$\n\\frac{1 - z^{-1}}{1 + z^{-1}} = \\frac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)} = j\\tan\\!\\left(\\frac{\\omega}{2}\\right),\n$$\nand therefore on the unit circle\n$$\ns = jk\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nIf we denote the analog frequency by $\\Omega$ via $s = j\\Omega$, then the bilinear transformation induces the nonlinear frequency mapping\n$$\n\\Omega = k\\tan\\!\\left(\\frac{\\omega}{2}\\right).\n$$\nFor the frequency responses, the discrete-time response obtained by bilinear transformation satisfies\n$$\nH_{d}(\\exp(j\\omega)) = H_{a}(s)\\bigg|_{s = k\\frac{1 - z^{-1}}{1 + z^{-1}},\\,z=\\exp(j\\omega)} = H_{a}\\!\\left(j\\,k\\tan\\!\\left(\\frac{\\omega}{2}\\right)\\right) = H_{a}\\!\\left(j\\,\\Omega(\\omega)\\right).\n$$\nConsequently, the digital phase is the analog phase composed with the warped frequency:\n$$\n\\angle H_{d}(\\exp(j\\omega)) = \\angle H_{a}\\!\\left(j\\,\\Omega(\\omega)\\right).\n$$\nEven if, hypothetically, the analog phase were linear in $\\Omega$, say\n$$\n\\angle H_{a}(j\\Omega) = \\alpha\\,\\Omega + \\beta,\n$$\nthen the resulting discrete-time phase would be\n$$\n\\angle H_{d}(\\exp(j\\omega)) = \\alpha\\,k\\,\\tan\\!\\left(\\frac{\\omega}{2}\\right) + \\beta,\n$$\nwhich is not a linear function of $\\omega$ due to the $\\tan(\\omega/2)$ term. Therefore, the nonlinearity of the phase in the digital domain is fundamentally tied to the bilinear transformationâ€™s inherent nonlinear frequency mapping (frequency warping) $\\Omega = k\\tan(\\omega/2)$.\n\nAssessing the options:\n- A is generally true for exact linear phase in causal, stable systems (it essentially requires an FIR with symmetric or antisymmetric impulse response), but it is not specific to the bilinear transformation method.\n- B is true that Butterworth analog filters lack linear phase, but this is not the most fundamental reason inherent to bilinear transformation; even a hypothetical linear-phase analog would become nonlinear in the digital domain due to warping.\n- C directly cites the inherent nonlinear mapping $\\Omega = k\\tan(\\omega/2)$ of the bilinear transformation, which by composition destroys linearity in $\\omega$ and is the fundamental reason asked for.\n- D is false; odd versus even order does not produce linear phase for IIR via bilinear transformation.\n- E is false; the bilinear transformation does not universally create a pole-zero count imbalance guaranteeing nonlinearity of phase.\n\nThus, the most fundamental reason inherent to the bilinear transformation is the nonlinear frequency mapping (frequency warping), as stated in option C.", "answer": "$$\\boxed{C}$$", "id": "1726279"}]}