{"hands_on_practices": [{"introduction": "A transfer function provides an input-output description of a system, but how does it relate to the internal state dynamics? This first exercise explores the fundamental consequence of a pole-zero cancellation on any corresponding state-space realization. By analyzing a simple transfer function, you will demonstrate why such a cancellation mathematically guarantees that the internal model is 'non-minimal'â€”meaning it must be either uncontrollable or unobservable, or both [@problem_id:1706947].", "problem": "Consider a single-input, single-output (SISO) Linear Time-Invariant (LTI) system. The relationship between the Laplace transform of the input, $U(s)$, and the Laplace transform of the output, $Y(s)$, is given by the transfer function:\n$$G(s) = \\frac{Y(s)}{U(s)} = \\frac{s + 1}{s^2 + 3s + 2}$$\nA control engineer aims to implement this system using a two-dimensional state-space model of the form:\n$$ \\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t) $$\n$$ y(t) = C \\mathbf{x}(t) + D u(t) $$\nwhere $\\mathbf{x}(t)$ is the 2x1 state vector, $A$ is a 2x2 matrix, $B$ is a 2x1 matrix, $C$ is a 1x2 matrix, and we can assume the scalar $D=0$.\n\nWhich of the following statements is necessarily true for *any* valid two-dimensional state-space realization of this transfer function?\n\nA. The realization is always controllable and always observable.\n\nB. The realization is always controllable, but might be unobservable.\n\nC. The realization is always observable, but might be uncontrollable.\n\nD. The realization must be either uncontrollable, or unobservable, or both.\n\nE. Whether the realization is controllable or observable depends entirely on the chosen state variables, and it is possible to find a realization that is both controllable and observable.", "solution": "We start from the given transfer function\n$$G(s)=\\frac{Y(s)}{U(s)}=\\frac{s+1}{s^{2}+3s+2}.$$\nFactor the denominator:\n$$s^{2}+3s+2=(s+1)(s+2),$$\nso\n$$G(s)=\\frac{s+1}{(s+1)(s+2)}=\\frac{1}{s+2}.$$\nTherefore, the transfer function reduces to a first-order strictly proper form, and its McMillan degree is\n$$n_{\\min}=1.$$\n\nAny state-space realization $(A,B,C,D)$ with $D=0$ satisfies\n$$G(s)=C(sI-A)^{-1}B.$$\nFundamental realization theory states:\n- A realization is minimal if and only if it is both controllable and observable.\n- The minimal dimension of any realization equals the McMillan degree of $G(s)$.\n\nSince $n_{\\min}=1$, any two-dimensional realization is necessarily non-minimal. Hence, by the minimality criterion, it cannot be both controllable and observable. Equivalently, every such two-dimensional realization must be either uncontrollable, or unobservable, or both.\n\nThus, among the options, the statement that is necessarily true for any valid two-dimensional realization is that it must be either uncontrollable, or unobservable, or both.", "answer": "$$\\boxed{D}$$", "id": "1706947"}, {"introduction": "Building on the concept of non-minimal realizations, we now move to a multi-input, multi-output (MIMO) system where the picture is more nuanced. A hidden mode might be uncontrollable from one input but not another, or unobservable at one output but visible elsewhere. This practice challenges you to diagnose the precise reason for a pole-zero cancellation in a specific input-output channel, forcing a distinction between uncontrollability related to the input matrix $B$ and unobservability related to the output matrix $C$ [@problem_id:1573650].", "problem": "A linear time-invariant (LTI) system with two inputs, $\\mathbf{u}(t) = [u_1(t), u_2(t)]^T$, and two outputs, $\\mathbf{y}(t) = [y_1(t), y_2(t)]^T$, is described by the state-space representation $\\dot{\\mathbf{x}} = A\\mathbf{x} + B\\mathbf{u}$ and $\\mathbf{y} = C\\mathbf{x}$, where $\\mathbf{x} \\in \\mathbb{R}^2$ is the state vector. The system matrices are given by:\n\n$$\nA = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  3 \\\\ 1  1 \\end{pmatrix}\n$$\n\nThe transfer function from an input $u_j$ to an output $y_i$ is denoted by $G_{ij}(s)$. Upon calculating the transfer function $G_{22}(s)$ from input $u_2$ to output $y_2$, it is observed that one of the system's poles (an eigenvalue of matrix $A$) is cancelled, meaning it does not appear as a pole of $G_{22}(s)$. This phenomenon is known as a \"hidden mode\" for that specific input-output channel.\n\nIdentify the correct physical reason for this pole-zero cancellation in the transfer function $G_{22}(s)$.\n\nA. The mode corresponding to the cancelled pole is unobservable from output $y_1$.\n\nB. The mode corresponding to the cancelled pole is uncontrollable from input $u_1$.\n\nC. The mode corresponding to the cancelled pole is unobservable from output $y_2$.\n\nD. The mode corresponding to the cancelled pole is uncontrollable from input $u_2$.\n\nE. The mode corresponding to the cancelled pole is unstable.\n\nF. The cancellation occurs due to a numerical coincidence without a physical basis.", "solution": "We consider the MIMO LTI system with state-space realization $\\dot{\\mathbf{x}} = A\\mathbf{x} + B\\mathbf{u}$ and $\\mathbf{y} = C\\mathbf{x}$, where\n$$\nA = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1  0 \\\\ 1  2 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0  3 \\\\ 1  1 \\end{pmatrix}.\n$$\nThe transfer matrix is given by the standard formula\n$$\nG(s) = C\\,(sI - A)^{-1} B.\n$$\nSince $A$ is diagonal, we have\n$$\n(sI - A)^{-1} = \\begin{pmatrix} \\frac{1}{s+1}  0 \\\\ 0  \\frac{1}{s+2} \\end{pmatrix}.\n$$\nCompute\n$$\n(sI - A)^{-1} B = \\begin{pmatrix} \\frac{1}{s+1}  0 \\\\ \\frac{1}{s+2}  \\frac{2}{s+2} \\end{pmatrix}.\n$$\nThen\n$$\nG(s) = C \\begin{pmatrix} \\frac{1}{s+1}  0 \\\\ \\frac{1}{s+2}  \\frac{2}{s+2} \\end{pmatrix}\n= \\begin{pmatrix}\n0  3 \\\\\n1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{s+1}  0 \\\\\n\\frac{1}{s+2}  \\frac{2}{s+2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{3}{s+2}  \\frac{6}{s+2} \\\\\n\\frac{1}{s+1} + \\frac{1}{s+2}  \\frac{2}{s+2}\n\\end{pmatrix}.\n$$\nTherefore,\n$$\nG_{22}(s) = \\frac{2}{s+2}.\n$$\nThe system poles (eigenvalues of $A$) are $-1$ and $-2$, but $G_{22}(s)$ only has the pole at $-2$; the pole at $-1$ is cancelled in this input-output channel.\n\nTo identify the physical reason, we analyze controllability and observability relative to input $u_{2}$ and output $y_{2}$. The $u_{2}$ input vector is the second column of $B$,\n$$\nb_{2} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}.\n$$\nThe eigenvalue $-1$ corresponds to the eigenvector $v_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. A mode at $\\lambda$ is controllable from input $u_{2}$ if the corresponding left eigenvector $w^{T}$ satisfies $w^{T} b_{2} \\neq 0$. For the diagonal $A$, we can take $w_{1}^{T} = \\begin{pmatrix} 1  0 \\end{pmatrix}$ for $\\lambda = -1$, yielding\n$$\nw_{1}^{T} b_{2} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix} = 0,\n$$\nso the $-1$ mode is uncontrollable from $u_{2}$. Consequently, it cannot appear as a pole in the transfer function from $u_{2}$ to any output.\n\nTo exclude unobservability as the cause, we check observability of the $-1$ mode from output $y_{2}$. The output row for $y_{2}$ is $c_{2}^{T} = \\begin{pmatrix} 1  1 \\end{pmatrix}$, and\n$$\nc_{2}^{T} v_{1} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1 \\neq 0,\n$$\nso the $-1$ mode is observable from $y_{2}$. Therefore, the cancellation in $G_{22}(s)$ is due to uncontrollability from input $u_{2}$, not unobservability, instability, or numerical coincidence. The correct choice is D.", "answer": "$$\\boxed{D}$$", "id": "1573650"}, {"introduction": "This final practice addresses the most critical lesson in pole-zero cancellation: its potential to hide internal instability. A system can have a perfectly stable transfer function while its internal states are growing without bound, a catastrophic failure scenario in any real-world application. Through a step-by-step analysis, this problem reveals how an unstable mode can be rendered both uncontrollable and unobservable, making it invisible to the transfer function and underscoring the necessity of a full state-space analysis for ensuring system stability [@problem_id:2713329].", "problem": "Consider a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) state-space system described by the matrices\n$$\nA=\\begin{pmatrix}\n2  0  0\\\\\n0  -1  0\\\\\n0  0  -3\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n0\\\\\n1\\\\\n1\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n0  1  1\n\\end{pmatrix},\\quad\nD=0.\n$$\nUsing only fundamental definitions from linear systems and control (state equation, output equation, Laplace transformation, and the definitions of controllability, observability, internal asymptotic stability, and minimal realization), carry out the following steps:\n\n1) Derive the input-output transfer function $G(s)$ of the given realization starting from the state and output equations via the Laplace transform.\n\n2) Determine whether the transfer function $G(s)$ is asymptotically stable by identifying the locations of its poles in the complex plane. Explain clearly how a pole-zero cancellation in $G(s)$, if present, relates to the internal dynamics of the provided realization.\n\n3) Analyze the controllability and observability of the realization by explicitly forming the controllability and observability matrices and assessing their ranks. Identify any state component that is both uncontrollable and unobservable.\n\n4) Construct the minimal realization by removing any uncontrollable and/or unobservable modes and write down the state matrix of the minimal realization. Explain how this minimal realization relates to $G(s)$ and to internal asymptotic stability of the original realization (as a property of the autonomous dynamics).\n\n5) Report the numerical value of the unstable internal eigenvalue that is masked by a pole-zero cancellation in the transfer function but present in the original realization. Your final answer must be a single real number with no units. No rounding is required.", "solution": "The problem statement is well-defined, self-contained, and grounded in the fundamental principles of linear control theory. It is free from scientific error, ambiguity, or contradiction. Therefore, the problem is valid, and we shall proceed with a rigorous, step-by-step analysis as demanded.\n\nThe system is described by the state-space equations:\n$$\n\\dot{x}(t) = Ax(t) + Bu(t) \\\\\ny(t) = Cx(t) + Du(t)\n$$\nwith the given matrices:\n$$\nA=\\begin{pmatrix}\n2  0  0\\\\\n0  -1  0\\\\\n0  0  -3\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n0\\\\\n1\\\\\n1\n\\end{pmatrix},\\quad\nC=\\begin{pmatrix}\n0  1  1\n\\end{pmatrix},\\quad\nD=0\n$$\n\n**1) Derivation of the Transfer Function $G(s)$**\n\nWe begin by applying the Laplace transform to the state and output equations, assuming zero initial conditions ($x(0)=0$).\n$$\nsX(s) = AX(s) + BU(s) \\\\\nY(s) = CX(s) + DU(s)\n$$\nFrom the state equation, we solve for the state vector in the frequency domain, $X(s)$:\n$$\n(sI - A)X(s) = BU(s) \\implies X(s) = (sI - A)^{-1}BU(s)\n$$\nwhere $I$ is the $3 \\times 3$ identity matrix. Substituting this into the output equation yields:\n$$\nY(s) = C(sI - A)^{-1}BU(s) + DU(s) = \\left( C(sI - A)^{-1}B + D \\right) U(s)\n$$\nThe transfer function $G(s)$ is the ratio $Y(s)/U(s)$, hence:\n$$\nG(s) = C(sI - A)^{-1}B + D\n$$\nWe first compute the matrix $(sI - A)^{-1}$:\n$$\nsI - A = \\begin{pmatrix} s  0  0 \\\\ 0  s  0 \\\\ 0  0  s \\end{pmatrix} - \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  -3 \\end{pmatrix} = \\begin{pmatrix} s-2  0  0 \\\\ 0  s+1  0 \\\\ 0  0  s+3 \\end{pmatrix}\n$$\nSince $sI - A$ is a diagonal matrix, its inverse is simply the matrix of reciprocal diagonal elements:\n$$\n(sI - A)^{-1} = \\begin{pmatrix} \\frac{1}{s-2}  0  0 \\\\ 0  \\frac{1}{s+1}  0 \\\\ 0  0  \\frac{1}{s+3} \\end{pmatrix}\n$$\nNow we perform the matrix multiplication $C(sI-A)^{-1}B$. Given $D=0$:\n$$\nG(s) = \\begin{pmatrix} 0  1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{s-2}  0  0 \\\\ 0  \\frac{1}{s+1}  0 \\\\ 0  0  \\frac{1}{s+3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = \\begin{pmatrix} 0  \\frac{1}{s+1}  \\frac{1}{s+3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nG(s) = (0)\\left(\\frac{1}{s-2}\\right)(0) + (1)\\left(\\frac{1}{s+1}\\right)(1) + (1)\\left(\\frac{1}{s+3}\\right)(1) = \\frac{1}{s+1} + \\frac{1}{s+3}\n$$\nCombining the terms gives the final form of the transfer function:\n$$\nG(s) = \\frac{(s+3) + (s+1)}{(s+1)(s+3)} = \\frac{2s+4}{s^2+4s+3}\n$$\n\n**2) Stability Analysis of $G(s)$ and Pole-Zero Cancellation**\n\nThe poles of the transfer function $G(s)$ are the roots of its denominator polynomial, which are $s_1 = -1$ and $s_2 = -3$. Since both poles have strictly negative real parts, they lie in the open left-half of the complex plane. Consequently, the input-output system described by $G(s)$ is asymptotically stable.\n\nHowever, the internal stability of the system is determined by the eigenvalues of the state matrix $A$. Since $A$ is a diagonal matrix, its eigenvalues are its diagonal entries: $\\lambda_1 = 2$, $\\lambda_2 = -1$, and $\\lambda_3 = -3$. These are the system's modes.\nThe set of transfer function poles is $\\{\\text{-}1, \\text{-}3\\}$, which is a proper subset of the set of system eigenvalues $\\{2, \\text{-}1, \\text{-}3\\}$. The eigenvalue $\\lambda_1 = 2$ is not represented as a pole of $G(s)$. This signifies that a pole-zero cancellation has occurred during the computation of the transfer function. The dynamic mode associated with the eigenvalue $\\lambda_1=2$ is therefore either uncontrollable or unobservable (or both), making it \"hidden\" from an input-output perspective.\nCrucially, since $\\operatorname{Re}(\\lambda_1) = 2  0$, this hidden mode is unstable. The existence of an unstable eigenvalue means the overall system is not internally asymptotically stable, despite the stability of its transfer function.\n\n**3) Controllability and Observability Analysis**\n\nWe assess controllability and observability for the $n=3$ system.\n\nFor controllability, we form the controllability matrix $\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}$:\n$$\nAB = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  -3 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ -3 \\end{pmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  -3 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 9 \\end{pmatrix}\n$$\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0  0 \\\\ 1  -1  1 \\\\ 1  -3  9 \\end{pmatrix}\n$$\nThe first row of $\\mathcal{C}$ is a zero vector, which immediately implies that the matrix is rank-deficient. The rank of $\\mathcal{C}$ is $2$, which is less than the system order $n=3$. Therefore, the system is not controllable. The zero first row corresponds to the first state variable, $x_1$, which is associated with the eigenvalue $\\lambda_1=2$. This mode is uncontrollable.\n\nFor observability, we form the observability matrix $\\mathcal{O} = \\begin{pmatrix} C^T  A^T C^T  (A^T)^2 C^T \\end{pmatrix}^T = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}$:\n$$\nCA = \\begin{pmatrix} 0  1  1 \\end{pmatrix}\\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  -3 \\end{pmatrix} = \\begin{pmatrix} 0  -1  -3 \\end{pmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{pmatrix} 0  -1  -3 \\end{pmatrix}\\begin{pmatrix} 2  0  0 \\\\ 0  -1  0 \\\\ 0  0  -3 \\end{pmatrix} = \\begin{pmatrix} 0  1  9 \\end{pmatrix}\n$$\n$$\n\\mathcal{O} = \\begin{pmatrix} 0  1  1 \\\\ 0  -1  -3 \\\\ 0  1  9 \\end{pmatrix}\n$$\nThe first column of $\\mathcal{O}$ is a zero vector, meaning the matrix is rank-deficient. The rank of $\\mathcal{O}$ is $2$, which is less than $n=3$. Therefore, the system is not observable. The zero first column indicates that changes in the first state variable, $x_1$, have no effect on the output. The mode associated with the eigenvalue $\\lambda_1=2$ is unobservable.\n\nThe state component corresponding to the eigenvalue $\\lambda_1=2$ is confirmed to be both uncontrollable and unobservable.\n\n**4) Minimal Realization and Internal Stability**\n\nA minimal realization of a transfer function is one that is both completely controllable and completely observable. It only represents the dynamics that connect the input to the output. Given that the mode at $\\lambda_1=2$ is both uncontrollable and unobservable, it can be removed to form the minimal realization.\nThe original system states $x_2$ and $x_3$ correspond to the controllable and observable subsystem. We construct the minimal realization by taking the parts of the matrices $A$, $B$, and $C$ corresponding to these two states.\nThe state matrix of the minimal realization, $A_{min}$, is:\n$$\nA_{min} = \\begin{pmatrix} -1  0 \\\\ 0  -3 \\end{pmatrix}\n$$\nThe corresponding input and output matrices are $B_{min} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ and $C_{min} = \\begin{pmatrix} 1  1 \\end{pmatrix}$. The transfer function of this minimal realization $(A_{min}, B_{min}, C_{min}, D)$ is identical to $G(s)$ derived previously. The eigenvalues of $A_{min}$ are $\\{-1, -3\\}$, both of which are stable. This minimal realization is therefore internally asymptotically stable.\n\nHowever, the internal stability of the *original* realization is dictated by the eigenvalues of the original matrix $A = \\operatorname{diag}(2, -1, -3)$. Due to the presence of the eigenvalue $\\lambda = 2$ in the right-half plane, the original system is internally unstable. The unstable dynamic is completely decoupled from both the input and the output, a fact that explains the pole-zero cancellation.\n\n**5) Unstable Internal Eigenvalue**\n\nThe internal dynamics of the system are governed by the eigenvalues of the matrix $A$. The eigenvalues are $\\{2, -1, -3\\}$. An eigenvalue $\\lambda$ corresponds to an unstable mode if its real part is non-negative, $\\operatorname{Re}(\\lambda) \\geq 0$. In this case, the eigenvalue $\\lambda_1 = 2$ satisfies this condition. This is the unstable internal eigenvalue that is masked by the pole-zero cancellation in the transfer function $G(s)$. The numerical value is $2$.", "answer": "$$\n\\boxed{2}\n$$", "id": "2713329"}]}