{"hands_on_practices": [{"introduction": "A Kalman filter's performance heavily relies on its initial setup, which must accurately reflect our prior knowledge of the system. This first practice explores the crucial role of the initial state covariance matrix, $P_{0|0}$, in quantifying our confidence in the initial state estimate. By considering a satellite with a precisely known initial position but a highly uncertain initial velocity, you will learn how to translate qualitative knowledge into quantitative filter parameters that guide the filter's initial behavior [@problem_id:1587015].", "problem": "An aerospace engineer is tasked with implementing a Kalman filter to estimate the attitude (orientation) of a new nanosatellite. The estimation is simplified to a single axis of rotation. The state vector for the filter is defined as $x_k = \\begin{pmatrix} \\theta_k \\\\ \\omega_k \\end{pmatrix}$, where $\\theta_k$ is the angular position and $\\omega_k$ is the angular velocity at discrete time step $k$.\n\nAt the moment of deployment from the launch vehicle (time $k=0$), a star tracker provides a reasonably precise measurement of the initial angular position, $\\theta_0$. However, a failure in the onboard gyroscope during the deployment sequence means there is no trustworthy information about the satellite's initial angular velocity, $\\omega_0$. The engineering team decides to initialize the state estimate with the measured position and a zero velocity, $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_0 \\\\ 0 \\end{pmatrix}$.\n\nThe initial state covariance matrix, $P_{0|0}$, which represents the uncertainty in this initial estimate, is initialized as a diagonal matrix:\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^2 & 0 \\\\ 0 & \\sigma_{\\omega}^2 \\end{pmatrix}\n$$\nHere, $\\sigma_{\\theta}^2$ is the variance of the error in the initial angular position estimate, and $\\sigma_{\\omega}^2$ is the variance of the error in the initial angular velocity estimate.\n\nTo configure the Kalman filter to properly reflect the high confidence in the initial position measurement and the extreme lack of confidence in the initial velocity assumption, which of the following initialization strategies for the variances is most appropriate?\n\nA. A small value for $\\sigma_{\\theta}^2$ and a large value for $\\sigma_{\\omega}^2$.\n\nB. A large value for $\\sigma_{\\theta}^2$ and a small value for $\\sigma_{\\omega}^2$.\n\nC. Small values for both $\\sigma_{\\theta}^2$ and $\\sigma_{\\omega}^2$.\n\nD. Large values for both $\\sigma_{\\theta}^2$ and $\\sigma_{\\omega}^2$.\n\nE. A small value for $\\sigma_{\\theta}^2$ and set $\\sigma_{\\omega}^2 = 0$, since the initial velocity estimate is set to zero.", "solution": "We are given the initial state estimate $\\hat{x}_{0|0} = \\begin{pmatrix} \\theta_{0} \\\\ 0 \\end{pmatrix}$ and the initial covariance\n$$\nP_{0|0} = \\begin{pmatrix} \\sigma_{\\theta}^{2} & 0 \\\\ 0 & \\sigma_{\\omega}^{2} \\end{pmatrix}.\n$$\nIn a Kalman filter, the covariance $P$ encodes uncertainty: a smaller variance means higher confidence in the corresponding state component, while a larger variance means lower confidence. The influence of uncertainty on the weighting of new measurements is governed by the Kalman gain\n$$\nK_{k} = P_{k|k-1} H^{T} \\left(H P_{k|k-1} H^{T} + R\\right)^{-1},\n$$\nso larger entries in $P_{k|k-1}$ lead to a larger gain and faster correction by measurements; smaller entries lead to a smaller gain and less correction.\n\nAt $k=0$, the star tracker provides a precise measurement of $\\theta_{0}$, so we should set $\\sigma_{\\theta}^{2}$ small to reflect high confidence in the initial position. There is no trustworthy information about $\\omega_{0}$; the chosen initial value of zero is arbitrary. Therefore, we should set $\\sigma_{\\omega}^{2}$ large to reflect high uncertainty and allow the filter to quickly correct the initial velocity estimate as information becomes available through process dynamics and subsequent measurements.\n\nEvaluating the options:\n- A uses a small $\\sigma_{\\theta}^{2}$ and a large $\\sigma_{\\omega}^{2}$, which correctly encodes high confidence in position and low confidence in velocity.\n- B would wrongly downweight the precise position and overconfidently trust the arbitrary zero velocity.\n- C would be overconfident in the unknown velocity.\n- D would unnecessarily distrust the precise position measurement.\n- E sets $\\sigma_{\\omega}^{2}=0$, implying absolute certainty in the velocity, which is the opposite of the stated lack of confidence and would inhibit necessary corrections.\n\nTherefore, the appropriate choice is A.", "answer": "$$\\boxed{A}$$", "id": "1587015"}, {"introduction": "A core assumption of the Kalman filter is that its internal model accurately represents the system's true dynamics. This exercise demonstrates a powerful diagnostic technique: analyzing the innovation sequence, $\\nu_k$, to detect a mismatch between the filter's model and reality. You will calculate the expected innovation when a filter assuming constant velocity tracks an object that is actually accelerating, revealing a key statistical signature of modeling error [@problem_id:1587047].", "problem": "A ground-based radar station is tracking a small asteroid. The station's tracking software employs a discrete-time Kalman filter to estimate the asteroid's one-dimensional position and velocity along the line of sight.\n\nThe filter is designed based on a Constant Velocity (CV) model, which assumes the asteroid's dynamics are described by the following state-space model:\n- State vector: $x_k = \\begin{bmatrix} p_k \\\\ v_k \\end{bmatrix}$, where $p_k$ is position and $v_k$ is velocity.\n- State transition matrix: $F = \\begin{bmatrix} 1 & \\Delta t \\\\ 0 & 1 \\end{bmatrix}$, with a time step of $\\Delta t = 1.0$ s.\n- Process noise covariance matrix: $Q = \\begin{bmatrix} 0.25 & 0.5 \\\\ 0.5 & 1.0 \\end{bmatrix}$ in units of m$^2$ and s.\n- Measurement matrix: $H = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$, as the radar measures position directly.\n- Measurement noise variance: $R = 4.0$ m$^2$.\n\nThe filter is initialized at time $k=0$ with the following *a posteriori* (updated) estimates:\n- Initial state estimate: $\\hat{x}_{0|0} = \\begin{bmatrix} 0 \\\\ 100 \\end{bmatrix}$ (position in m, velocity in m/s).\n- Initial error covariance: $P_{0|0} = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}$.\n\nUnbeknownst to the tracking software designers, the asteroid is actually subject to a small, constant acceleration from solar radiation pressure. Its true motion is governed by a Constant Acceleration (CA) model with an acceleration of $a = 2.0$ m/s$^2$. The true state of the asteroid at $k=0$ perfectly matches the filter's initial estimate: true position $p_0^{true} = 0$ m and true velocity $v_0^{true} = 100$ m/s.\n\nA key diagnostic for filter performance is the innovation sequence, $\\nu_k = z_k - H \\hat{x}_{k|k-1}$, where $z_k$ is the measurement and $\\hat{x}_{k|k-1}$ is the *a priori* state estimate at time $k$. If the filter model were perfect, this sequence would be zero-mean. Due to the unmodeled acceleration, this will not be the case.\n\nCalculate the expected value (mean) of the innovation, $E[\\nu_2]$, at time step $k=2$. Express your answer in meters, rounded to three significant figures.", "solution": "We use the CV Kalman filter recursions with state transition $F=\\begin{bmatrix}1 & 1 \\\\ 0 & 1\\end{bmatrix}$, measurement matrix $H=\\begin{bmatrix}1 & 0\\end{bmatrix}$, process covariance $Q=\\begin{bmatrix}0.25 & 0.5 \\\\ 0.5 & 1.0\\end{bmatrix}$, and measurement variance $R=4.0$, with $\\Delta t=1$.\n\nThe true asteroid motion follows a constant acceleration $a$:\n$$\np_{k}=p_{k-1}+v_{k-1}\\Delta t+\\tfrac{1}{2}a\\Delta t^{2},\\quad v_{k}=v_{k-1}+a\\Delta t.\n$$\nWith $p_{0}=0$, $v_{0}=100$, and $\\Delta t=1$, the true positions are\n$$\np_{1}^{\\text{true}}=100+\\tfrac{1}{2}a,\\qquad p_{2}^{\\text{true}}=200+2a.\n$$\nMeasurements are $z_{k}=p_{k}^{\\text{true}}+\\text{noise}$, with $E[z_{k}]=p_{k}^{\\text{true}}$.\n\nKalman filter initialization is $\\hat{x}_{0|0}=\\begin{bmatrix}0\\\\100\\end{bmatrix}$ and $P_{0|0}=0$. Predict to $k=1$:\n$$\n\\hat{x}_{1|0}=F\\hat{x}_{0|0}=\\begin{bmatrix}100\\\\100\\end{bmatrix},\\quad P_{1|0}=FP_{0|0}F^{T}+Q=Q.\n$$\nInnovation at $k=1$ is $\\nu_{1}=z_{1}-H\\hat{x}_{1|0}$, with expected value\n$$\nE[\\nu_{1}]=E[z_{1}]-H\\hat{x}_{1|0}=(100+\\tfrac{1}{2}a)-100=\\tfrac{1}{2}a.\n$$\nCompute the Kalman gain at $k=1$:\n$$\nS_{1}=HP_{1|0}H^{T}+R=Q_{11}+R=0.25+4=\\tfrac{17}{4},\\quad\nK_{1}=P_{1|0}H^{T}S_{1}^{-1}=\\frac{1}{S_{1}}\\begin{bmatrix}Q_{11}\\\\Q_{21}\\end{bmatrix}=\\begin{bmatrix}\\tfrac{1}{17}\\\\ \\tfrac{2}{17}\\end{bmatrix}.\n$$\nUpdate expectation at $k=1$:\n$$\nE[\\hat{x}_{1|1}]=\\hat{x}_{1|0}+K_{1}E[\\nu_{1}]\n=\\begin{bmatrix}100\\\\100\\end{bmatrix}\n+\\begin{bmatrix}\\tfrac{1}{17}\\\\ \\tfrac{2}{17}\\end{bmatrix}\\cdot \\tfrac{1}{2}a\n=\\begin{bmatrix}100+\\tfrac{a}{34}\\\\ 100+\\tfrac{a}{17}\\end{bmatrix}.\n$$\nPredict to $k=2$:\n$$\nE[\\hat{x}_{2|1}]=F\\,E[\\hat{x}_{1|1}]\n=\\begin{bmatrix}1 & 1\\\\ 0 & 1\\end{bmatrix}\n\\begin{bmatrix}100+\\tfrac{a}{34}\\\\ 100+\\tfrac{a}{17}\\end{bmatrix}\n=\\begin{bmatrix}200+\\tfrac{3a}{34}\\\\ 100+\\tfrac{a}{17}\\end{bmatrix}.\n$$\nTherefore, the expected innovation at $k=2$ is\n$$\nE[\\nu_{2}]=E[z_{2}]-H\\,E[\\hat{x}_{2|1}]=p_{2}^{\\text{true}}-\\left(200+\\tfrac{3a}{34}\\right)\n=\\left(200+2a\\right)-\\left(200+\\tfrac{3a}{34}\\right)=\\frac{65}{34}a.\n$$\nWith $a=2.0$, this yields\n$$\nE[\\nu_{2}]=\\frac{65}{34}\\cdot 2=\\frac{65}{17}\\approx 3.823529\\ldots\n$$\nRounded to three significant figures, this is $3.82$.", "answer": "$$\\boxed{3.82}$$", "id": "1587047"}, {"introduction": "Real-world sensors are prone to glitches and outliers, which can corrupt the state estimate and cause a Kalman filter to diverge. This final practice introduces a formal statistical method for validating incoming data called the Normalized Innovation Squared (NIS) test. You will apply this chi-squared ($\\chi^2$) test to a radar measurement to determine if it is plausible or should be rejected, a critical function for building robust, real-world estimation systems [@problem_id:1587043].", "problem": "A self-driving vehicle's navigation system uses a Kalman filter to track a leading car. The state of the leading car is modeled in one dimension (longitudinal motion) by its position $p$ and velocity $v$. The state vector at discrete time step $k$ is given by $x_k = [p_k, v_k]^T$.\n\nThe system dynamics are described by a linear state-space model:\n$$x_k = F x_{k-1} + w_{k-1}$$\n$$z_k = H x_k + v_k$$\n\nwhere:\n- $F = \\begin{pmatrix} 1 & \\Delta t \\\\ 0 & 1 \\end{pmatrix}$ is the state transition matrix, with a time step of $\\Delta t = 0.5$ s.\n- $w_{k-1}$ is the process noise, modeled as a zero-mean Gaussian with covariance matrix $Q = \\begin{pmatrix} \\frac{\\Delta t^4}{4} & \\frac{\\Delta t^3}{2} \\\\ \\frac{\\Delta t^3}{2} & \\Delta t^2 \\end{pmatrix} \\sigma_a^2$. The standard deviation of the unmodeled acceleration is $\\sigma_a = 0.2 \\text{ m/s}^2$.\n- $z_k$ is the scalar measurement of the car's position from a RADAR sensor.\n- $H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$ is the measurement matrix.\n- $v_k$ is the measurement noise, modeled as a zero-mean Gaussian with variance $R = \\sigma_z^2$, where the sensor's measurement standard deviation is $\\sigma_z = 1.0$ m.\n\nAt the end of time step $k-1$, the filter's posterior state estimate and its error covariance are:\n$$\\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\text{ m} \\\\ 2.0 \\text{ m/s} \\end{pmatrix}, \\quad P_{k-1|k-1} = \\begin{pmatrix} 0.5 & 0.1 \\\\ 0.1 & 0.2 \\end{pmatrix} \\text{ m}^2 \\text{ or } (\\text{m/s})^2$$\n\nAt time step $k$, a new measurement arrives: $z_k = 15.0$ m.\n\nTo prevent filter divergence due to sensor glitches, a validation gate is applied to each new measurement. This is done by performing a chi-squared ($\\chi^2$) test on the Normalized Innovation Squared (NIS), $\\epsilon_k$. The measurement $z_k$ is rejected as an outlier if its NIS value exceeds a predetermined threshold. For a measurement dimension of 1, the critical value of the $\\chi^2$ distribution for a significance level of $\\alpha = 0.01$ is $\\chi^2_{1, 0.01} = 6.635$.\n\nBased on a chi-squared test with this significance level, what is the calculated NIS value for the measurement $z_k$, and should the measurement be accepted or rejected?\n\nA. The NIS is approximately 9.69, and the measurement should be rejected.\n\nB. The NIS is approximately 9.69, and the measurement should be accepted.\n\nC. The NIS is approximately 15.1, and the measurement should be rejected.\n\nD. The NIS is approximately 5.45, and the measurement should be accepted.\n\nE. The NIS is approximately 5.45, and the measurement should be rejected.", "solution": "We use the standard discrete Kalman filter prediction and innovation equations for a constant-velocity model. The prediction step is\n$$\n\\hat{x}_{k|k-1} = F \\hat{x}_{k-1|k-1}, \\qquad P_{k|k-1} = F P_{k-1|k-1} F^{T} + Q.\n$$\nWith $\\Delta t = 0.5$, we have\n$$\nF = \\begin{pmatrix} 1 & 0.5 \\\\ 0 & 1 \\end{pmatrix}, \\quad \\hat{x}_{k-1|k-1} = \\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix}.\n$$\nTherefore,\n$$\n\\hat{x}_{k|k-1} = \\begin{pmatrix} 1 & 0.5 \\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix} 10.0 \\\\ 2.0 \\end{pmatrix} = \\begin{pmatrix} 11.0 \\\\ 2.0 \\end{pmatrix}.\n$$\nThe process noise covariance for $\\sigma_{a} = 0.2$ is\n$$\nQ = \\begin{pmatrix} \\frac{\\Delta t^{4}}{4} & \\frac{\\Delta t^{3}}{2} \\\\ \\frac{\\Delta t^{3}}{2} & \\Delta t^{2} \\end{pmatrix}\\sigma_{a}^{2}\n= \\begin{pmatrix} \\frac{0.5^{4}}{4} & \\frac{0.5^{3}}{2} \\\\ \\frac{0.5^{3}}{2} & 0.5^{2} \\end{pmatrix} (0.2)^{2}\n= \\begin{pmatrix} 0.000625 & 0.0025 \\\\ 0.0025 & 0.01 \\end{pmatrix}.\n$$\nCompute $F P_{k-1|k-1} F^{T}$:\n$$\nF P_{k-1|k-1} = \\begin{pmatrix} 1 & 0.5 \\\\ 0 & 1 \\end{pmatrix}\\begin{pmatrix} 0.5 & 0.1 \\\\ 0.1 & 0.2 \\end{pmatrix} = \\begin{pmatrix} 0.55 & 0.2 \\\\ 0.1 & 0.2 \\end{pmatrix},\n$$\n$$\nF P_{k-1|k-1} F^{T} = \\begin{pmatrix} 0.55 & 0.2 \\\\ 0.1 & 0.2 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\\\ 0.5 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.65 & 0.2 \\\\ 0.2 & 0.2 \\end{pmatrix}.\n$$\nThus,\n$$\nP_{k|k-1} = \\begin{pmatrix} 0.65 & 0.2 \\\\ 0.2 & 0.2 \\end{pmatrix} + \\begin{pmatrix} 0.000625 & 0.0025 \\\\ 0.0025 & 0.01 \\end{pmatrix} = \\begin{pmatrix} 0.650625 & 0.2025 \\\\ 0.2025 & 0.21 \\end{pmatrix}.\n$$\nWith $H = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$, the innovation (measurement residual) is\n$$\ny_{k} = z_{k} - H \\hat{x}_{k|k-1} = 15.0 - 11.0 = 4.0,\n$$\nand the innovation covariance is\n$$\nS_{k} = H P_{k|k-1} H^{T} + R = 0.650625 + (1.0)^{2} = 1.650625.\n$$\nThe Normalized Innovation Squared (NIS) is\n$$\n\\epsilon_{k} = y_{k}^{T} S_{k}^{-1} y_{k} = \\frac{y_{k}^{2}}{S_{k}} = \\frac{16}{1.650625} \\approx 9.69.\n$$\nFor a one-dimensional measurement with significance level $\\alpha = 0.01$, the threshold is $\\chi^{2}_{1,0.01} = 6.635$. Since $9.69 > 6.635$, the measurement should be rejected as an outlier. This corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1587043"}]}