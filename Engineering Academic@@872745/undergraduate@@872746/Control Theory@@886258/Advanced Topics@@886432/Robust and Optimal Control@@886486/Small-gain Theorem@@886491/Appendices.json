{"hands_on_practices": [{"introduction": "Real-world components often have physical limitations. For example, an electric heater cannot supply infinite power. This exercise explores how to handle such a common nonlinearity—actuator saturation—within a control loop. By modeling the system as a feedback interconnection of a linear plant and a nonlinear saturation block, we can use the small-gain theorem to calculate the maximum controller gain that guarantees stability, regardless of how severely the actuator saturates. This practice provides a concrete example of how to ensure robust performance in the face of predictable physical constraints [@problem_id:1611071].", "problem": "A control system is designed to regulate the temperature of a chemical process in a bioreactor. The bioreactor's thermal dynamics are modeled by a linear time-invariant system. The transfer function from the input power of the heater, $v(t)$ in watts (W), to the normalized dimensionless temperature output, $y(t)$, is given by:\n$$P(s) = \\frac{b}{s+a}$$\nwhere the parameters are $a = 0.15 \\text{ s}^{-1}$ and $b = 0.05 \\text{ W}^{-1}\\cdot\\text{s}^{-1}$. The plant is assumed to be stable, with $a > 0$.\n\nA simple proportional controller with a positive gain $K$ is used. It takes the error signal $e(t) = r(t) - y(t)$, where $r(t)$ is the desired reference temperature, and computes a desired heater power $u(t) = K \\cdot e(t)$.\n\nThe heater is the actuator, and it cannot supply infinite power. The actual power $v(t)$ delivered by the heater is constrained by a saturation nonlinearity. If the controller requests power $u(t)$, the delivered power is $v(t) = \\text{sat}(u(t))$, which is defined as:\n$$ v(t) = \\begin{cases} u(t)  \\text{if } |u(t)| \\le P_{max} \\\\ P_{max} \\cdot \\text{sgn}(u(t))  \\text{if } |u(t)| > P_{max} \\end{cases} $$\nHere, $P_{max}$ is the positive maximum power rating of the heater.\n\nThe closed-loop system can be analyzed as a negative feedback interconnection of a linear system and a nonlinear operator. Using the small-gain theorem, determine the maximum value of the positive controller gain $K$ that guarantees the stability of the closed-loop system for any reference input $r(t)$ and for any positive value of the maximum power $P_{max}$. The gain $K$ has units of $\\text{W}$. Express your answer as a real number. Round your final answer to two significant figures.", "solution": "We view the closed-loop as a Lur’e interconnection between a linear time-invariant system and a static nonlinearity. Define the signals as follows: the controller output is $u(t)=K e(t)=K(r(t)-y(t))$, the actuator output is $v(t)=\\text{sat}(u(t))$, and the plant output is $y(t)$. The plant transfer function from $v$ to $y$ is $P(s)=\\frac{b}{s+a}$ with $a0$, $b0$.\n\nIntroduce $w:=u$ (input to the nonlinearity) and $z:=v$ (output of the nonlinearity). The interconnection equations are\n$$\ny = P z, \\quad w = K(r - y) = K r - K P z.\n$$\nThus, the linear map from $z$ to $w$ is $-K P(s)$, and $r$ enters additively as an exogenous input $K r$. The saturation operator $\\text{sat}(\\cdot)$ satisfies the global Lipschitz bound\n$$\n|\\,\\text{sat}(u_{1}) - \\text{sat}(u_{2})\\,| \\le |u_{1} - u_{2}|\n$$\nfor all $u_{1},u_{2}$, so its induced gain is bounded by $1$ in any signal norm. Therefore, by the small-gain theorem, a sufficient condition for input-output stability of the feedback interconnection for any reference input and any positive $P_{max}$ is\n$$\n\\| -K P \\|_{\\infty} \\cdot 1  1 \\quad \\Longleftrightarrow \\quad K \\, \\|P\\|_{\\infty}  1.\n$$\nWe compute the $\\mathcal{H}_{\\infty}$ norm of $P(s)=\\frac{b}{s+a}$. For $\\omega \\in \\mathbb{R}$,\n$$\n|P(j\\omega)| = \\frac{b}{\\sqrt{\\omega^{2}+a^{2}}},\n$$\nwhich is strictly decreasing in $|\\omega|$ because the denominator $\\sqrt{\\omega^{2}+a^{2}}$ increases with $|\\omega|$. Hence the maximum occurs at $\\omega=0$, yielding\n$$\n\\|P\\|_{\\infty} = \\sup_{\\omega} |P(j\\omega)| = \\frac{b}{a}.\n$$\nThe small-gain condition becomes\n$$\nK \\cdot \\frac{b}{a}  1 \\quad \\Longleftrightarrow \\quad K  \\frac{a}{b}.\n$$\nWith the given parameters $a=0.15$ and $b=0.05$, we obtain\n$$\nK_{\\max} = \\frac{a}{b} = \\frac{0.15}{0.05} = 3.\n$$\nRounding to two significant figures gives $3.0$.", "answer": "$$\\boxed{3.0}$$", "id": "1611071"}, {"introduction": "Mathematical models are always approximations of reality. A crucial task in control engineering is to design systems that remain stable even when the true plant dynamics differ from our model. This practice investigates a fundamental aspect of robust stability by comparing two different types of modeling errors: a simple error in the system's static gain and a more complex error related to unmodeled phase lag. By applying the small-gain theorem to both scenarios, you will discover a key feature of this powerful tool—it primarily considers the \"size\" or norm of the uncertainty, not its specific structure. This exercise [@problem_id:1611059] reveals why the theorem can be conservative, yet provides a universal guarantee of stability.", "problem": "A control engineer is designing a feedback system for a single-joint robotic arm. The nominal model of the arm's actuator and joint dynamics is represented by a first-order transfer function $P_0(s) = \\frac{A}{s+a}$, where $A$ and $a$ are positive real constants. A simple proportional controller, $C(s)=K$ with $K0$, is used in a standard negative feedback configuration.\n\nThe engineer knows the nominal model $P_0(s)$ is an approximation and that the true plant, $P(s)$, has multiplicative uncertainty, such that $P(s) = P_0(s)(1 + \\Delta(s))$. Two possible sources of this uncertainty are considered:\n\n1.  **Static Gain Error**: The actuator's gain is slightly off from the nominal value. This uncertainty is modeled as a pure real gain $\\Delta_1(s) = \\delta_1$, where $\\delta_1$ is an unknown real constant. Let $|\\delta_1|_{\\max}$ be the maximum tolerable magnitude of this gain error that guarantees closed-loop stability for all possible values of $\\delta_1$ within this bound.\n\n2.  **Unmodeled Phase Lag**: There are unmodeled high-frequency dynamics that primarily introduce phase lag. This is approximated by a scaled first-order all-pass filter, $\\Delta_2(s) = \\delta_2 \\frac{s - \\omega_0}{s + \\omega_0}$, where $\\delta_2$ is an unknown real constant and $\\omega_0$ is a positive constant representing the frequency scale of the unmodeled dynamics. Let $|\\delta_2|_{\\max}$ be the maximum tolerable magnitude of the scaling factor $\\delta_2$ that guarantees closed-loop stability.\n\nBased on a robust stability analysis, determine the value of the ratio $R = \\frac{|\\delta_1|_{\\max}}{|\\delta_2|_{\\max}}$.\n\nChoose the correct option from the following:\n\nA. $R = \\frac{a}{AK}$\n\nB. $R = \\frac{AK}{a+AK}$\n\nC. $R = 1$\n\nD. $R = \\frac{a+AK}{AK}$\n\nE. $R$ depends on the value of $\\omega_0$.", "solution": "The nominal plant is $P_{0}(s)=\\frac{A}{s+a}$ with $A0$ and $a0$, and the controller is $C(s)=K$ with $K0$. The nominal loop transfer function is\n$$\nL_{0}(s)=C(s)P_{0}(s)=\\frac{AK}{s+a}.\n$$\nThe complementary sensitivity function is\n$$\nT_{0}(s)=\\frac{L_{0}(s)}{1+L_{0}(s)}=\\frac{\\frac{AK}{s+a}}{1+\\frac{AK}{s+a}}=\\frac{AK}{s+(a+AK)}.\n$$\nFor multiplicative plant uncertainty $P(s)=P_{0}(s)\\left(1+\\Delta(s)\\right)$, the standard robust stability condition via the small-gain theorem is\n$$\n\\|\\Delta\\|_{\\infty}\\,\\|T_{0}\\|_{\\infty}1,\n$$\nso the maximum tolerable magnitude satisfies\n$$\n|\\delta|_{\\max}=\\frac{1}{\\|T_{0}\\|_{\\infty}}.\n$$\nWe now compute $\\|T_{0}\\|_{\\infty}$. Since $T_{0}(s)=\\dfrac{AK}{s+(a+AK)}$ is a stable first-order low-pass transfer function, its magnitude on the imaginary axis is\n$$\n|T_{0}(j\\omega)|=\\frac{AK}{\\sqrt{(a+AK)^{2}+\\omega^{2}}}.\n$$\nThe maximum over $\\omega\\in\\mathbb{R}$ occurs at $\\omega=0$, hence\n$$\n\\|T_{0}\\|_{\\infty}=|T_{0}(0)|=\\frac{AK}{a+AK}.\n$$\nTherefore,\n$$\n|\\delta|_{\\max}=\\frac{1}{\\|T_{0}\\|_{\\infty}}=\\frac{a+AK}{AK}.\n$$\n\nCase 1 (Static gain error): $\\Delta_{1}(s)=\\delta_{1}$ has $\\|\\Delta_{1}\\|_{\\infty}=|\\delta_{1}|$, so\n$$\n|\\delta_{1}|_{\\max}=\\frac{a+AK}{AK}.\n$$\nThis bound is also exact by direct pole location: with $P(s)=\\dfrac{A(1+\\delta_{1})}{s+a}$, the closed-loop pole is at $s=-(a+AK(1+\\delta_{1}))$, which remains in the open left half-plane for all $|\\delta_{1}|\\leq \\dfrac{a+AK}{AK}$; the limiting case is the most negative $\\delta_{1}$.\n\nCase 2 (Unmodeled phase lag): $\\Delta_{2}(s)=\\delta_{2}\\dfrac{s-\\omega_{0}}{s+\\omega_{0}}$ is stable and all-pass, satisfying for all real $\\omega$,\n$$\n\\left|\\frac{j\\omega-\\omega_{0}}{j\\omega+\\omega_{0}}\\right|=1,\n$$\nhence $\\|\\Delta_{2}\\|_{\\infty}=|\\delta_{2}|$. The same small-gain bound yields\n$$\n|\\delta_{2}|_{\\max}=\\frac{a+AK}{AK},\n$$\nindependent of $\\omega_{0}$.\n\nThus the ratio is\n$$\nR=\\frac{|\\delta_{1}|_{\\max}}{|\\delta_{2}|_{\\max}}=\\frac{\\frac{a+AK}{AK}}{\\frac{a+AK}{AK}}=1,\n$$\nwhich does not depend on $\\omega_{0}$.", "answer": "$$\\boxed{C}$$", "id": "1611059"}, {"introduction": "Many systems exhibit behavior that changes over time. Components can heat up, power supplies can fluctuate, or environmental conditions can vary, causing system parameters to drift. This problem moves beyond static uncertainties to address a system with a time-varying gain, which oscillates periodically. To solve this, you will need to determine the induced $L_2$-gain of this time-varying operator. This practice [@problem_id:1611065] showcases the versatility of the small-gain theorem, demonstrating its ability to guarantee stability not just for LTI systems with fixed uncertainties, but also for more complex systems whose characteristics evolve over time.", "problem": "A feedback control system is constructed by interconnecting a stable Linear Time-Invariant (LTI) system, denoted by $G$, with a time-varying multiplier, $k(t)$. The output of $G$, let's call it $y_G$, is fed as the input to the multiplier. The output of the multiplier, $y_k$, is then subtracted from an external reference signal $u$ to produce the input for $G$. That is, the input to $G$ is $e_G = u - y_k$.\n\nThe stable LTI system $G$ is known to have an induced $L_2$-gain of $\\gamma_G$. The induced $L_2$-gain of a system is defined as the smallest non-negative number $\\gamma$ such that the $L_2$-norm of its output is bounded by $\\gamma$ times the $L_2$-norm of its input for all possible inputs.\n\nThe time-varying multiplier $k(t)$ is characterized by the relation $y_k(t) = k(t) y_G(t)$, where the gain function is a pure sinusoid with a DC offset, given by\n$$k(t) = A + B \\sin(\\omega t)$$\nHere, $A$, $B$, and $\\omega$ are real constants. This model can represent a system component with a nominal gain $A$ subject to periodic fluctuations of amplitude $|B|$.\n\nTo ensure the stability of the entire closed-loop system for all possible values of $\\omega$ and any initial state, a conservative stability criterion must be used. Assuming that the parameters are such that a stable solution is possible (specifically, that $1 - \\gamma_G |A|  0$), determine the maximum permissible magnitude of the oscillatory component, $|B|$, that guarantees the stability of the closed-loop system based on the small-gain theorem.\n\nExpress your answer as a closed-form analytic expression in terms of $\\gamma_G$ and $A$.", "solution": "Let $G$ be a stable LTI system with induced $L_{2}$-gain $\\gamma_{G}$, so for all inputs $e_{G}$,\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}.\n$$\nThe time-varying multiplier $k(t)$ maps $y_{G}$ to $y_{k}$ via $y_{k}(t)=k(t)y_{G}(t)$ with $k(t)=A+B\\sin(\\omega t)$. The induced $L_{2}$-gain of the multiplication operator $K$ is the essential supremum of $|k(t)|$:\n$$\n\\gamma_{K}=\\operatorname{ess\\,sup}_{t}|k(t)|=\\sup_{s\\in[-1,1]}|A+Bs|.\n$$\nSince $A+Bs$ ranges over the interval $[A-|B|,A+|B|]$, its maximum absolute value is\n$$\n\\gamma_{K}=|A|+|B|.\n$$\nIn the feedback interconnection $e_{G}=u-y_{k}$, we have\n$$\n\\|y_{G}\\|_{2} \\leq \\gamma_{G}\\|e_{G}\\|_{2}=\\gamma_{G}\\|u-y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\|y_{k}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}+\\gamma_{G}\\gamma_{K}\\|y_{G}\\|_{2}.\n$$\nRearranging yields\n$$\n\\left(1-\\gamma_{G}\\gamma_{K}\\right)\\|y_{G}\\|_{2}\\leq \\gamma_{G}\\|u\\|_{2}.\n$$\nBy the small-gain theorem, the closed-loop is $L_{2}$-stable for all $\\omega$ if\n$$\n\\gamma_{G}\\gamma_{K}1.\n$$\nSubstituting $\\gamma_{K}=|A|+|B|$ gives\n$$\n\\gamma_{G}\\left(|A|+|B|\\right)1 \\quad \\Longrightarrow \\quad |B|\\frac{1}{\\gamma_{G}}-|A|.\n$$\nUnder the stated assumption $1-\\gamma_{G}|A|0$, the right-hand side is positive, and the largest admissible oscillation magnitude that guarantees stability is\n$$\n|B|_{\\max}=\\frac{1}{\\gamma_{G}}-|A|.\n$$\nThis bound is independent of $\\omega$, thus valid for all $\\omega$.", "answer": "$$\\boxed{\\frac{1}{\\gamma_{G}}-|A|}$$", "id": "1611065"}]}