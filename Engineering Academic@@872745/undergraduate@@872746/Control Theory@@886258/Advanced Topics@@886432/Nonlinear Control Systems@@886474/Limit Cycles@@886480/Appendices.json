{"hands_on_practices": [{"introduction": "To build a solid intuition for limit cycles, we begin with a foundational example. This exercise grounds the abstract concept in a tangible physical system: a mass controlled by a simple relay. By applying fundamental kinematic principles, you will trace the block's motion through one full cycle, directly calculating how the controller's switching action sustains a periodic oscillation. This hands-on analysis [@problem_id:1588857] provides a clear, step-by-step view of how a limit cycle trajectory is formed in the phase plane.", "problem": "A simple positioning system consists of a block of mass $m$ free to slide on a frictionless horizontal track. The position of the block at time $t$ is given by $y(t)$. A controller exerts a force $u(t)$ on the block based on its position. The controller operates as an ideal relay, applying a constant force of magnitude $F_0$ in the direction opposite to the block's displacement from the origin.\n\nThe dynamics of the system are described by the equation:\n$$m\\ddot{y}(t) = u(t)$$\nwhere the control force is given by:\n$$u(t) = -F_0 \\text{sgn}(y(t))$$\nHere, $F_0$ is a positive constant, and the signum function, $\\text{sgn}(x)$, is defined to be $1$ for $x  0$ and $-1$ for $x  0$. Assume the force switches direction instantaneously as the block passes through the origin ($y=0$).\n\nThe block is initially at rest, $\\dot{y}(0) = 0$, at a position $y(0) = y_0$, where $y_0$ is a positive constant. After its release, the system enters a sustained, periodic oscillation, a phenomenon known as a limit cycle.\n\nDetermine the period, $T$, of this limit cycle. Express your answer as a symbolic expression in terms of $m$, $F_0$, and $y_0$.", "solution": "The equation of motion is $m \\ddot{y}(t) = -F_{0}\\,\\text{sgn}\\!\\left(y(t)\\right)$. Thus, the acceleration is piecewise constant:\n- For $y(t)  0$, $\\ddot{y} = -\\frac{F_{0}}{m}$.\n- For $y(t)  0$, $\\ddot{y} = +\\frac{F_{0}}{m}$.\nThe initial conditions are $y(0) = y_{0}  0$ and $\\dot{y}(0) = 0$.\n\nFrom $t=0$ until the first crossing of the origin, the motion has constant acceleration $a_{1} = -\\frac{F_{0}}{m}$. Using the kinematic relation under constant acceleration,\n$$\ny(t) = y_{0} + \\dot{y}(0)\\,t + \\frac{1}{2} a_{1} t^{2} = y_{0} - \\frac{F_{0}}{2m} t^{2},\n$$\nthe time $t_{1}$ to reach $y=0$ is found by solving $0 = y_{0} - \\frac{F_{0}}{2m} t_{1}^{2}$, which gives\n$$\nt_{1} = \\sqrt{\\frac{2 m y_{0}}{F_{0}}}.\n$$\nThe velocity at this crossing is obtained from $\\dot{y}(t) = \\dot{y}(0) + a_{1} t$, yielding\n$$\n\\dot{y}(t_{1}) = -\\frac{F_{0}}{m}\\, t_{1} = -\\sqrt{\\frac{2 F_{0} y_{0}}{m}}.\n$$\n\nImmediately after crossing into $y0$, the control switches to $u=+F_{0}$, so the acceleration is $a_{2} = +\\frac{F_{0}}{m}$. The time to decelerate from velocity $\\dot{y}(t_{1})$ to zero is found from $\\dot{y}(t_{1}+\\tau) = \\dot{y}(t_{1}) + \\frac{F_{0}}{m}\\,\\tau = 0$, giving\n$$\n\\tau = \\sqrt{\\frac{2 m y_{0}}{F_{0}}} = t_{1}.\n$$\nThe displacement during this deceleration satisfies $0 = \\dot{y}(t_{1})^{2} + 2 \\left(\\frac{F_{0}}{m}\\right) s$, hence\n$$\ns = -\\frac{m}{2 F_{0}} \\dot{y}(t_{1})^{2} = -\\frac{m}{2 F_{0}} \\left(\\frac{2 F_{0} y_{0}}{m}\\right) = -y_{0},\n$$\nso the turning point is at $y=-y_{0}$ with zero velocity at time $t = t_{1} + \\tau = 2 t_{1}$.\n\nBy symmetry, the subsequent intervals are identical:\n- From $y=-y_{0}$, $\\dot{y}=0$ to $y=0$: time $t_{1}$.\n- From $y=0$ to $y=+y_{0}$, $\\dot{y}=0$: time $t_{1}$.\n\nTherefore, the full period to return to the initial state $(y,\\dot{y})=(y_{0},0)$ is\n$$\nT = 4 t_{1} = 4 \\sqrt{\\frac{2 m y_{0}}{F_{0}}}.\n$$\nThis corresponds to a symmetric, periodic motion with constant-magnitude, piecewise-constant acceleration toward the origin and instantaneous switching at $y=0$.", "answer": "$$\\boxed{4 \\sqrt{\\frac{2 m y_{0}}{F_{0}}}}$$", "id": "1588857"}, {"introduction": "The ultimate goal of control theory is not just to analyze systems, but to design them to meet specific performance criteria. This final practice moves from analysis to synthesis, challenging you to actively modify an undesirable limit cycle caused by a time delay. By leveraging your understanding of the phase conditions that create oscillations, you will determine the precise derivative gain for a PD controller that alters the system's dynamics. This exercise [@problem_id:1588885] demonstrates the practical power of limit cycle analysis in engineering design, showing how it enables us to tame or even eliminate unwanted oscillations.", "problem": "A position control system for an unmanned robotic arm is being analyzed. The arm's dynamics are modeled by a second-order transfer function, $G_p(s) = \\frac{K}{s(s+a)}$, where $K$ and $a$ are positive real constants representing the system gain and a damping-related parameter, respectively. The system is driven by a simple relay actuator that provides a control signal of magnitude $M$. A significant processing delay of $\\tau$ seconds is present in the control loop, which cannot be neglected. This delay causes the system to exhibit a limit cycle, an undesirable sustained oscillation.\n\nTo mitigate this oscillation, a simple derivative feedback path is introduced by implementing a Proportional-Derivative (PD) controller of the form $C(s) = 1 + K_d s$ just before the relay actuator. The goal is to alter the characteristics of the limit cycle.\n\nDetermine the exact value of the derivative gain $K_d$ that will shift the frequency of the limit cycle to a new, specific value of $\\omega_1 = \\frac{\\pi}{2\\tau}$. Express your final answer as an analytic expression in terms of the plant parameter $a$.", "solution": "We analyze the relay-induced limit cycle using the describing function method. The loop consists of a linear prefilter $C(s)=1+K_{d}s$ before the ideal relay of magnitude $M$, followed by the linear dynamics $G_{p}(s)\\exp(-s\\tau)$ with $G_{p}(s)=\\frac{K}{s(s+a)}$. For a sinusoidal oscillation of frequency $\\omega$, the harmonic balance condition is\n$$\n1+N(A_{v})\\,C(j\\omega)\\,G_{p}(j\\omega)\\,\\exp(-j\\omega\\tau)=0,\n$$\nwhere $N(A_{v})=\\frac{4M}{\\pi A_{v}}$ is the describing function of the ideal relay (no hysteresis), with $A_{v}$ the amplitude at the relay input. Since $N(A_{v})$ is real and positive, the oscillation frequency is determined by the phase condition\n$$\n\\angle\\big\\{C(j\\omega)\\,G_{p}(j\\omega)\\,\\exp(-j\\omega\\tau)\\big\\}=-\\pi.\n$$\nCompute the phase contributions:\n- $C(j\\omega)=1+j\\omega K_{d}$ has phase $\\phi_{C}=\\arctan(\\omega K_{d})$.\n- $G_{p}(j\\omega)=\\frac{K}{j\\omega\\,(j\\omega+a)}$ has phase\n$$\n\\phi_{p}=-\\left(\\frac{\\pi}{2}+\\arctan\\!\\left(\\frac{\\omega}{a}\\right)\\right),\n$$\nsince $1/(j\\omega)$ contributes $-\\frac{\\pi}{2}$ and $1/(j\\omega+a)$ contributes $-\\arctan(\\omega/a)$, while $K0$ adds zero phase.\n- The delay contributes $\\phi_{\\tau}=-\\omega\\tau$.\n\nThus the total phase is\n$$\n\\phi_{\\text{tot}}=\\arctan(\\omega K_{d})-\\left(\\frac{\\pi}{2}+\\arctan\\!\\left(\\frac{\\omega}{a}\\right)+\\omega\\tau\\right).\n$$\nImposing $\\phi_{\\text{tot}}=-\\pi$ at the desired frequency $\\omega_{1}=\\frac{\\pi}{2\\tau}$ gives\n$$\n\\arctan(\\omega_{1}K_{d})-\\left(\\frac{\\pi}{2}+\\arctan\\!\\left(\\frac{\\omega_{1}}{a}\\right)+\\frac{\\pi}{2}\\right)=-\\pi,\n$$\nwhich simplifies to\n$$\n\\arctan(\\omega_{1}K_{d})=\\arctan\\!\\left(\\frac{\\omega_{1}}{a}\\right).\n$$\nBecause both sides lie in $(-\\frac{\\pi}{2},\\frac{\\pi}{2})$, it follows that\n$$\n\\omega_{1}K_{d}=\\frac{\\omega_{1}}{a}\\quad\\Longrightarrow\\quad K_{d}=\\frac{1}{a}.\n$$\nThe magnitude condition would determine the oscillation amplitude (involving $K$ and $M$), but it does not affect the frequency-setting value of $K_{d}$. Therefore, the exact derivative gain that enforces the limit cycle frequency $\\omega_{1}=\\frac{\\pi}{2\\tau}$ is $K_{d}=\\frac{1}{a}$.", "answer": "$$\\boxed{\\frac{1}{a}}$$", "id": "1588885"}]}