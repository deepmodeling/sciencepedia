{"hands_on_practices": [{"introduction": "The first step in designing a decentralized control system is to understand the interactions between inputs and outputs. The Relative Gain Array (RGA) is a powerful analytical tool that quantifies these interactions and helps us choose the best pairing of control loops. This practice will guide you through calculating a key RGA metric to evaluate a system's suitability for decentralized control and select the most promising pairing strategy [@problem_id:1605982].", "problem": "A chemical engineer is designing a decentralized control system for a thermal mixing unit. The system has two manipulated inputs: the flow rate of a hot stream, $u_1$, and the flow rate of a cold stream, $u_2$. The goal is to control two process outputs: the total volumetric flow rate of the mixed stream, $y_1$, and the final temperature of the mixed stream, $y_2$.\n\nFor small deviations from a desired operating point, the steady-state relationship between the inputs and outputs is described by the linear model $\\Delta\\mathbf{y} = K \\Delta\\mathbf{u}$, where $\\mathbf{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$, $\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$, and $K$ is the system's steady-state gain matrix. For this specific process, the gain matrix has been experimentally determined to be:\n$$\nK = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\n\nTo assess the degree of interaction between the control loops, the engineer decides to use Relative Gain Array (RGA) analysis. The RGA matrix, $\\Lambda$, is calculated as $\\Lambda = K \\circ (K^{-1})^T$, where $\\circ$ denotes the element-wise (Hadamard) product. A summary metric for interaction is Bristol's RGA number, $\\eta_{RGA}$, defined for an $n \\times n$ system as:\n$$\n\\eta_{RGA} = \\sum_{i=1}^{n} \\sum_{j=1}^{n} |\\lambda_{ij} - \\delta_{ij}|\n$$\nwhere $\\lambda_{ij}$ are the elements of the RGA matrix $\\Lambda$, and $\\delta_{ij}$ is the Kronecker delta ($\\delta_{ij}=1$ if $i=j$ and $\\delta_{ij}=0$ if $i \\neq j$).\n\nYou are tasked with two objectives:\n1.  Calculate the value of Bristol's RGA number, $\\eta_{RGA}$, for this system. Round your final answer to three significant figures.\n2.  Based on your analysis, select the statement below that best describes the system's characteristics and the appropriate control pairing strategy. The proposed \"direct\" pairing is to use input $u_1$ to control output $y_1$ and input $u_2$ to control output $y_2$.\n\nA. The system has very strong interactions, and a decentralized control strategy using the direct pairing is highly inadvisable as it will likely lead to instability.\n\nB. The system has significant interactions, and while the direct pairing might be stable, its performance will be severely degraded compared to a multivariable controller.\n\nC. The system is perfectly decoupled, meaning the direct pairing will function as two independent single-loop controllers without any cross-effects.\n\nD. The system exhibits weak interactions, and a decentralized control strategy using the direct pairing ($u_1 \\to y_1$, $u_2 \\to y_2$) is recommended and expected to perform well.\n\nE. The system interactions suggest that the pairing should be reversed ($u_1 \\to y_2$, $u_2 \\to y_1$) for effective control.\n\nProvide your answer as a pair: the numerical value for $\\eta_{RGA}$ and the letter corresponding to the correct statement.", "solution": "The problem asks for the calculation of Bristol's Relative Gain Array (RGA) number, $\\eta_{RGA}$, and an interpretation of this value for a given 2x2 system.\n\n**Step 1: Calculate the inverse of the gain matrix K.**\nThe given steady-state gain matrix is:\n$$\nK = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix}\n$$\nFirst, we find the determinant of $K$:\n$$\n\\det(K) = (0.8)(0.8) - (0.2)(0.2) = 0.64 - 0.04 = 0.60\n$$\nThe inverse of a 2x2 matrix $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ is $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\nApplying this formula to $K$:\n$$\nK^{-1} = \\frac{1}{0.60} \\begin{pmatrix} 0.8 & -0.2 \\\\ -0.2 & 0.8 \\end{pmatrix} = \\begin{pmatrix} \\frac{0.8}{0.6} & -\\frac{0.2}{0.6} \\\\ -\\frac{0.2}{0.6} & \\frac{0.8}{0.6} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\n\n**Step 2: Calculate the RGA matrix, $\\Lambda$.**\nThe RGA matrix is defined as $\\Lambda = K \\circ (K^{-1})^T$.\nFirst, we find the transpose of $K^{-1}$. Since $K^{-1}$ is a symmetric matrix, its transpose is equal to itself:\n$$\n(K^{-1})^T = \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\nNow, we perform the element-wise (Hadamard) product of $K$ and $(K^{-1})^T$:\n$$\n\\Lambda = K \\circ (K^{-1})^T = \\begin{pmatrix} 0.8 & 0.2 \\\\ 0.2 & 0.8 \\end{pmatrix} \\circ \\begin{pmatrix} \\frac{4}{3} & -\\frac{1}{3} \\\\ -\\frac{1}{3} & \\frac{4}{3} \\end{pmatrix}\n$$\n$$\n\\Lambda = \\begin{pmatrix} 0.8 \\times \\frac{4}{3} & 0.2 \\times (-\\frac{1}{3}) \\\\ 0.2 \\times (-\\frac{1}{3}) & 0.8 \\times \\frac{4}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{3.2}{3} & -\\frac{0.2}{3} \\\\ -\\frac{0.2}{3} & \\frac{3.2}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{16}{15} & -\\frac{1}{15} \\\\ -\\frac{1}{15} & \\frac{16}{15} \\end{pmatrix}\n$$\nAs a check, the sum of elements in any row or column of an RGA matrix must be 1. For the first row: $\\frac{16}{15} - \\frac{1}{15} = \\frac{15}{15} = 1$. The calculation is correct.\n\n**Step 3: Calculate Bristol's RGA number, $\\eta_{RGA}$.**\nThe definition given is $\\eta_{RGA} = \\sum_{i=1}^{2} \\sum_{j=1}^{2} |\\lambda_{ij} - \\delta_{ij}|$.\nThe Kronecker delta matrix for a 2x2 system is the identity matrix $I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\nSo we need to calculate:\n$$\n\\eta_{RGA} = |\\lambda_{11}-1| + |\\lambda_{12}-0| + |\\lambda_{21}-0| + |\\lambda_{22}-1|\n$$\nSubstituting the values from our calculated $\\Lambda$:\n$$\n\\eta_{RGA} = \\left|\\frac{16}{15}-1\\right| + \\left|-\\frac{1}{15}-0\\right| + \\left|-\\frac{1}{15}-0\\right| + \\left|\\frac{16}{15}-1\\right|\n$$\n$$\n\\eta_{RGA} = \\left|\\frac{1}{15}\\right| + \\left|-\\frac{1}{15}\\right| + \\left|-\\frac{1}{15}\\right| + \\left|\\frac{1}{15}\\right|\n$$\n$$\n\\eta_{RGA} = \\frac{1}{15} + \\frac{1}{15} + \\frac{1}{15} + \\frac{1}{15} = \\frac{4}{15}\n$$\nNow, we convert this fraction to a decimal and round to three significant figures:\n$$\n\\eta_{RGA} = \\frac{4}{15} \\approx 0.26666...\n$$\nRounding to three significant figures gives $\\eta_{RGA} = 0.267$.\n\n**Step 4: Interpret the result and choose the correct statement.**\nAn RGA number, $\\eta_{RGA}$, of 0 indicates a perfectly decoupled system (diagonal or anti-diagonal). As the number increases from 0, it indicates a stronger degree of interaction. The value of $\\eta_{RGA} \\approx 0.267$ is small and close to 0, which signifies weak interaction between the control loops.\n\nFurthermore, we examine the RGA matrix $\\Lambda$ itself.\n$$\n\\Lambda = \\begin{pmatrix} 16/15 & -1/15 \\\\ -1/15 & 16/15 \\end{pmatrix} \\approx \\begin{pmatrix} 1.067 & -0.067 \\\\ -0.067 & 1.067 \\end{pmatrix}\n$$\nThe rule of thumb for pairing is to choose input-output pairs corresponding to RGA elements ($\\lambda_{ij}$) that are positive and close to 1.\nFor the direct pairing ($u_1 \\to y_1$, $u_2 \\to y_2$), the corresponding RGA elements are $\\lambda_{11} = 16/15$ and $\\lambda_{22} = 16/15$. Both are positive and very close to 1.\nFor the reversed pairing ($u_1 \\to y_2$, $u_2 \\to y_1$), the RGA elements are $\\lambda_{21} = -1/15$ and $\\lambda_{12} = -1/15$. These are negative, indicating that this pairing would lead to instability or reverse action in the loops.\n\nTherefore, the weak interaction (small $\\eta_{RGA}$) and the RGA elements close to 1 for the diagonal pairing strongly suggest that the direct pairing ($u_1 \\to y_1$, $u_2 \\to y_2$) is a good choice for a decentralized control strategy.\n\nLet's evaluate the options:\nA: Incorrect. Interactions are weak, not strong.\nB: Incorrect. Performance degradation should be minimal due to weak interactions.\nC: Incorrect. The system is not perfectly decoupled, as $\\eta_{RGA} \\neq 0$ and the off-diagonal elements of $\\Lambda$ are not zero.\nD: Correct. The interactions are weak, and the direct pairing is the recommended strategy.\nE: Incorrect. The reversed pairing is strongly discouraged by the negative RGA elements.\n\nThe final answer consists of the numerical value 0.267 and the letter D.", "answer": "$$\\boxed{\\begin{pmatrix} 0.267 & D \\end{pmatrix}}$$", "id": "1605982"}, {"introduction": "Once we've assessed the interactions in a system, it's crucial to understand their consequences on system dynamics. Strong interactions can lead to poor performance or even instability when simple decentralized controllers are used. This problem delves into the heart of this issue, challenging you to determine the stability limits of a coupled system under decentralized control, thereby linking the abstract concept of interaction to the critical outcome of stability [@problem_id:1568231].", "problem": "Consider a manufacturing process involving two coupled first-order thermal subsystems. The relationship between the vector of heater inputs, $u(s) = \\begin{pmatrix} u_1(s) \\\\ u_2(s) \\end{pmatrix}$, and the vector of temperature outputs, $y(s) = \\begin{pmatrix} y_1(s) \\\\ y_2(s) \\end{pmatrix}$, is described by the transfer function matrix $G(s)$:\n\n$$\nG(s) = \\begin{pmatrix} \\frac{1}{s+a} & \\frac{\\epsilon}{s+a} \\\\ \\frac{\\epsilon}{s+a} & \\frac{1}{s+b} \\end{pmatrix}\n$$\n\nHere, $a$ and $b$ are positive real constants representing the open-loop pole locations of the individual subsystems, and $\\epsilon$ is a real, dimensionless constant representing the strength of the thermal coupling.\n\nA decentralized proportional control scheme is implemented to regulate the temperatures. The control law is given by $u_1(t) = -K y_1(t)$ and $u_2(t) = -K y_2(t)$, where $K$ is a positive, real-valued proportional gain. The system parameters are specifically chosen such that the relation $b = a+K$ is satisfied.\n\nFor the system to be stable, the absolute value of the coupling parameter, $|\\epsilon|$, must not exceed a certain maximum value. Determine this maximum value, $|\\epsilon_{max}|$. Express your answer as a single closed-form analytic expression in terms of the parameters $a$ and $K$.", "solution": "The closed-loop system with decentralized static output feedback $u=-Ky$ has its characteristic equation given by the zeros of the determinant $D(s)=\\det(I+K G(s))$. With a controller matrix being $K \\cdot I$, where $I$ is the identity matrix, and\n$$\nG(s)=\\begin{pmatrix}\n\\frac{1}{s+a} & \\frac{\\epsilon}{s+a} \\\\\n\\frac{\\epsilon}{s+a} & \\frac{1}{s+b}\n\\end{pmatrix},\n$$\nwe obtain\n$$\nI+K G(s)=\\begin{pmatrix}\n1+\\frac{K}{s+a} & \\frac{K\\epsilon}{s+a} \\\\\n\\frac{K\\epsilon}{s+a} & 1+\\frac{K}{s+b}\n\\end{pmatrix},\n$$\nso\n$$\nD(s)=\\left(1+\\frac{K}{s+a}\\right)\\left(1+\\frac{K}{s+b}\\right)-\\left(\\frac{K\\epsilon}{s+a}\\right)^{2}.\n$$\nThe roots of the characteristic equation are the values of $s$ for which $D(s)=0$. To find these roots, we can find a common denominator and solve for the numerator being zero. The common denominator is $(s+a)^2(s+b)$. The numerator polynomial $N(s)$ is:\n$$\nN(s)=(s+a+K)(s+a)(s+b+K) - K^{2}\\epsilon^{2}(s+b).\n$$\nUsing the given relation $b=a+K$, we have $s+b=s+a+K$ and $s+b+K=s+a+2K$. Substituting these into $N(s)$:\n$$\nN(s)=(s+a+K)(s+a)(s+a+2K) - K^{2}\\epsilon^{2}(s+a+K).\n$$\nFactoring out the common term $(s+a+K)$:\n$$\nN(s)=(s+a+K)\\big[(s+a)(s+a+2K)-K^{2}\\epsilon^{2}\\big].\n$$\nThe denominator of the full transfer function is $(s+a)^2(s+b) = (s+a)^2(s+a+K)$. A pole-zero cancellation occurs at $s=-(a+K)$. Therefore, the closed-loop characteristic equation reduces to the quadratic factor being zero:\n$$\n(s+a)(s+a+2K)-K^{2}\\epsilon^{2}=0.\n$$\nExpanding this gives the quadratic equation:\n$$\ns^{2}+2(a+K)s+\\big(a(a+2K)-K^{2}\\epsilon^{2}\\big)=0.\n$$\nBy the Routhâ€“Hurwitz criterion for second-order polynomials, asymptotic stability requires that all coefficients be positive. Since $a>0$ and $K>0$, the coefficient $2(a+K)$ is automatically positive. The stability condition thus reduces to the constant term being positive:\n$$\na(a+2K)-K^{2}\\epsilon^{2}>0\n$$\n$$\nK^{2}\\epsilon^{2}<a(a+2K)\\quad\\Longrightarrow\\quad |\\epsilon|<\\frac{\\sqrt{a(a+2K)}}{K}.\n$$\nThe maximum allowable magnitude for the coupling parameter at the boundary of stability is therefore:\n$$\n|\\epsilon_{\\max}|=\\frac{\\sqrt{a(a+2K)}}{K}.\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{a(a+2K)}}{K}}$$", "id": "1568231"}, {"introduction": "After analyzing system interactions and their potential for instability, a natural next step is to design a solution that actively cancels them out. This strategy, known as decoupling, uses a precompensator to make the plant appear non-interactive from the perspective of the controllers. This exercise puts you in the designer's seat, tasking you with deriving the ideal decoupler elements to transform a coupled system into a simple, diagonal one, making subsequent controller design straightforward [@problem_id:1568170].", "problem": "Consider a linear, time-invariant, Two-Input Two-Output (TITO) process that models the interaction between two variables in a chemical reactor. The process is described by the following transfer function matrix $G(s)$:\n$$\nG(s) = \\begin{pmatrix} G_{11}(s) & G_{12}(s) \\\\ G_{21}(s) & G_{22}(s) \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{s+1} & \\frac{1}{s+3} \\\\ \\frac{1.5}{s+4} & \\frac{3}{s+2} \\end{pmatrix}\n$$\nTo simplify the control design, a precompensator, also known as a decoupler, $D(s)$, is introduced. The decoupler is designed with the general structure:\n$$\nD(s) = \\begin{pmatrix} 1 & d_{12}(s) \\\\ d_{21}(s) & 1 \\end{pmatrix}\n$$\nThe objective is to select the transfer functions for the off-diagonal elements, $d_{12}(s)$ and $d_{21}(s)$, such that the compensated system, described by the apparent plant matrix $Q(s) = G(s)D(s)$, is diagonal. This decoupling action ensures that the first input only influences the first output, and the second input only influences the second output.\n\nDetermine the analytic expressions for the decoupler elements $d_{12}(s)$ and $d_{21}(s)$. Present your final answer as a single 1x2 row matrix with $d_{12}(s)$ as the first element and $d_{21}(s)$ as the second element.", "solution": "We are given the TITO plant\n$$\nG(s)=\\begin{pmatrix}\nG_{11}(s) & G_{12}(s)\\\\\nG_{21}(s) & G_{22}(s)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{2}{s+1} & \\frac{1}{s+3}\\\\\n\\frac{1.5}{s+4} & \\frac{3}{s+2}\n\\end{pmatrix},\n$$\nand a right precompensator (decoupler)\n$$\nD(s)=\\begin{pmatrix}\n1 & d_{12}(s)\\\\\nd_{21}(s) & 1\n\\end{pmatrix}.\n$$\nThe compensated (apparent) plant is\n$$\nQ(s)=G(s)D(s).\n$$\nMatrix multiplication gives\n$$\nQ(s)=\\begin{pmatrix}\nG_{11}+G_{12}d_{21} & G_{11}d_{12}+G_{12}\\\\\nG_{21}+G_{22}d_{21} & G_{21}d_{12}+G_{22}\n\\end{pmatrix}.\n$$\nTo achieve decoupling, we require the off-diagonal entries to be zero:\n$$\nG_{11}d_{12}+G_{12}=0,\\qquad G_{21}+G_{22}d_{21}=0.\n$$\nSolving these linear equations for the decoupler elements yields\n$$\nd_{12}(s)=-\\frac{G_{12}(s)}{G_{11}(s)},\\qquad d_{21}(s)=-\\frac{G_{21}(s)}{G_{22}(s)}.\n$$\nSubstituting the given transfer functions,\n$$\nd_{12}(s)=-\\frac{\\frac{1}{s+3}}{\\frac{2}{s+1}}=-\\frac{s+1}{2(s+3)},\n\\qquad\nd_{21}(s)=-\\frac{\\frac{1.5}{s+4}}{\\frac{3}{s+2}}=-\\frac{1.5(s+2)}{3(s+4)}=-\\frac{s+2}{2(s+4)}.\n$$\nVerification of decoupling:\n$$\nQ_{12}=G_{11}d_{12}+G_{12}=\\frac{2}{s+1}\\left(-\\frac{s+1}{2(s+3)}\\right)+\\frac{1}{s+3}=-\\frac{1}{s+3}+\\frac{1}{s+3}=0,\n$$\n$$\nQ_{21}=G_{21}+G_{22}d_{21}=\\frac{1.5}{s+4}+\\frac{3}{s+2}\\left(-\\frac{s+2}{2(s+4)}\\right)=\\frac{1.5}{s+4}-\\frac{1.5}{s+4}=0.\n$$\nThus the chosen $d_{12}(s)$ and $d_{21}(s)$ achieve a diagonal apparent plant $Q(s)$.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{s+1}{2(s+3)} & -\\frac{s+2}{2(s+4)}\\end{pmatrix}}$$", "id": "1568170"}]}