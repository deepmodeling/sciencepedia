{"hands_on_practices": [{"introduction": "Most modern control systems are implemented on digital computers, which operate in discrete time steps. This necessitates converting the continuous-time differential equations that model physical systems, like the drone in this problem, into discrete-time difference equations. This exercise [@problem_id:1583869] provides hands-on practice with the standard Zero-Order Hold (ZOH) method, a fundamental technique for finding an exact discrete-time equivalent for a linear system.", "problem": "A simplified model for the lateral dynamics of a quadcopter drone operating in a vertical plane is described by a continuous-time state-space representation $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + B\\mathbf{u}(t)$. The state vector is defined as $\\mathbf{x} = [p, \\dot{p}, \\phi, \\dot{\\phi}]^T$, where $p$ is the horizontal position, $\\dot{p}$ is the horizontal velocity, $\\phi$ is the roll angle relative to the vertical axis, and $\\dot{\\phi}$ is the roll angular velocity. The input vector is $\\mathbf{u} = [u_1, u_2]^T$, where $u_1$ is the control input related to the roll torque and $u_2$ is a direct horizontal thrust force.\n\nThe system dynamics are given by the matrices:\n$$\nA = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1/m \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}\n$$\nwhere $g$ is the acceleration due to gravity, $m$ is the mass of the drone, and $\\eta$ is a positive constant representing the effectiveness of the roll torque control.\n\nTo implement a digital controller, this continuous-time model must be converted into an equivalent discrete-time model of the form $\\mathbf{x}_{k+1} = A_d \\mathbf{x}_k + B_d \\mathbf{u}_k$, where $T_s$ is the sampling period. This conversion is performed assuming that the control input vector $\\mathbf{u}(t)$ is held constant over each sampling interval $[kT_s, (k+1)T_s)$, which corresponds to a Zero-Order Hold (ZOH) on the inputs.\n\nDetermine the discrete-time input matrix $B_d$. Express your answer as a matrix in terms of the symbolic parameters $g$, $m$, $\\eta$, and $T_s$.", "solution": "Under a Zero-Order Hold on the inputs, the exact discrete-time matrices are given by\n$$\nA_{d}=\\exp(A T_{s}), \\quad B_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau)\\, B \\, \\mathrm{d}\\tau.\n$$\nThus we need $\\exp(A \\tau)$. Since $A$ is strictly upper triangular, its powers vanish beyond order three. Compute the needed powers:\n$$\nA=\\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{2}=\\begin{pmatrix} 0 & 0 & g & 0 \\\\ 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{3}=\\begin{pmatrix} 0 & 0 & 0 & g \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad\nA^{4}=0.\n$$\nTherefore,\n$$\n\\exp(A \\tau)=I + A \\tau + \\frac{A^{2} \\tau^{2}}{2} + \\frac{A^{3} \\tau^{3}}{6}\n=\\begin{pmatrix}\n1 & \\tau & \\frac{g \\tau^{2}}{2} & \\frac{g \\tau^{3}}{6} \\\\\n0 & 1 & g \\tau & \\frac{g \\tau^{2}}{2} \\\\\n0 & 0 & 1 & \\tau \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.\n$$\nNext compute $\\exp(A \\tau) B$ using\n$$\nB=\\begin{pmatrix} 0 & 0 \\\\ 0 & \\frac{1}{m} \\\\ 0 & 0 \\\\ \\eta & 0 \\end{pmatrix}.\n$$\nThe result is\n$$\n\\exp(A \\tau) B\n=\n\\begin{pmatrix}\n\\frac{\\eta g \\tau^{3}}{6} & \\frac{\\tau}{m} \\\\\n\\frac{\\eta g \\tau^{2}}{2} & \\frac{1}{m} \\\\\n\\eta \\tau & 0 \\\\\n\\eta & 0\n\\end{pmatrix}.\n$$\nIntegrating entrywise from $\\tau=0$ to $\\tau=T_{s}$ yields\n$$\nB_{d}=\\int_{0}^{T_{s}} \\exp(A \\tau) B \\, \\mathrm{d}\\tau\n=\n\\begin{pmatrix}\n\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\\n\\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\\n\\frac{\\eta T_{s}^{2}}{2} & 0 \\\\\n\\eta T_{s} & 0\n\\end{pmatrix}.\n$$\nThis is the discrete-time input matrix under a Zero-Order Hold with sampling period $T_{s}$.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\eta g T_{s}^{4}}{24} & \\frac{T_{s}^{2}}{2 m} \\\\ \\frac{\\eta g T_{s}^{3}}{6} & \\frac{T_{s}}{m} \\\\ \\frac{\\eta T_{s}^{2}}{2} & 0 \\\\ \\eta T_{s} & 0\\end{pmatrix}}$$", "id": "1583869"}, {"introduction": "A key characteristic of multivariable systems is that the system's response depends not only on the magnitude of the inputs but also on their relative contributions—the \"direction\" of the input vector. This practice [@problem_id:1583894] explores this concept of directional gain by asking you to find the specific combination of constant inputs that maximally excites one of the system's outputs. You will use the steady-state gain matrix, $G(0)$, to solve this foundational multivariable optimization problem.", "problem": "A thin, thermally conductive plate is modeled as a stable 2-input, 2-output Linear Time-Invariant (LTI) system. The inputs, $u_1(t)$ and $u_2(t)$, are control voltages applied to two independent heating elements. The outputs, $y_1(t)$ and $y_2(t)$, represent the temperature deviations from ambient at two distinct sensor locations on the plate.\n\nThe dynamical relationship between the vector of input Laplace transforms, $U(s) = \\begin{pmatrix} U_1(s) \\\\ U_2(s) \\end{pmatrix}$, and the vector of output Laplace transforms, $Y(s) = \\begin{pmatrix} Y_1(s) \\\\ Y_2(s) \\end{pmatrix}$, is described by the transfer function matrix $G(s)$:\n\n$$ Y(s) = G(s) U(s) $$\n\nwhere\n$$ G(s) = \\begin{pmatrix} \\frac{2}{s+1} & \\frac{1}{s+2} \\\\ \\frac{-1}{s+3} & \\frac{3}{s+1} \\end{pmatrix} $$\n\nA control strategy involves applying a constant input vector, $u(t) = u_0 = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$, to the system. The total input \"effort\" is constrained, requiring the input vector to be a unit vector, i.e., $\\sqrt{u_1^2 + u_2^2} = 1$.\n\nYour task is to determine the specific constant unit input vector $u_0$ that maximizes the steady-state temperature deviation at the first sensor location, $y_1$. Express your answer as the two components of this unit vector, $[u_1, u_2]$, in a row matrix.", "solution": "We consider a stable LTI system with transfer matrix $G(s)$ and a constant input $u(t)=u_{0}=\\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}$ satisfying $u_{1}^{2}+u_{2}^{2}=1$. In the Laplace domain, a constant input corresponds to $U(s)=\\frac{u_{0}}{s}$. The output in the Laplace domain is $Y(s)=G(s)U(s)$, and the steady-state value of $y_{1}(t)$ is obtained via the final value theorem. Since the system is stable, the final value theorem applies and gives\n$$\ny_{1,\\text{ss}}=\\lim_{t\\to\\infty}y_{1}(t)=\\lim_{s\\to 0}sY_{1}(s)=\\lim_{s\\to 0}s\\left(\\text{row}_{1}\\!\\left(G(s)\\right)U(s)\\right)=\\text{row}_{1}\\!\\left(G(0)\\right)u_{0}.\n$$\nEvaluating $G(0)$ yields\n$$\nG(0)=\\begin{pmatrix} \\frac{2}{1} & \\frac{1}{2} \\\\ \\frac{-1}{3} & \\frac{3}{1} \\end{pmatrix}=\\begin{pmatrix} 2 & \\frac{1}{2} \\\\ -\\frac{1}{3} & 3 \\end{pmatrix},\n$$\nso\n$$\ny_{1,\\text{ss}}=\\begin{pmatrix} 2 & \\frac{1}{2} \\end{pmatrix}\\begin{pmatrix} u_{1} \\\\ u_{2} \\end{pmatrix}=2u_{1}+\\frac{1}{2}u_{2}.\n$$\nWe must maximize $2u_{1}+\\frac{1}{2}u_{2}$ subject to $u_{1}^{2}+u_{2}^{2}=1$. Define the vector $v=\\begin{pmatrix} 2 \\\\ \\frac{1}{2} \\end{pmatrix}$. Then $y_{1,\\text{ss}}=v^{\\top}u_{0}$. By the Cauchy–Schwarz inequality,\n$$\nv^{\\top}u_{0}\\leq \\|v\\|_{2}\\,\\|u_{0}\\|_{2}=\\|v\\|_{2},\n$$\nwith equality if and only if $u_{0}$ is parallel to $v$, i.e., $u_{0}=\\frac{v}{\\|v\\|_{2}}$. The norm of $v$ is\n$$\n\\|v\\|_{2}=\\sqrt{2^{2}+\\left(\\frac{1}{2}\\right)^{2}}=\\sqrt{\\frac{17}{4}}=\\frac{\\sqrt{17}}{2}.\n$$\nTherefore,\n$$\nu_{0}^{\\star}=\\frac{1}{\\|v\\|_{2}}\\begin{pmatrix} 2 \\\\ \\frac{1}{2} \\end{pmatrix}=\\frac{2}{\\sqrt{17}}\\begin{pmatrix} 2 \\\\ \\frac{1}{2} \\end{pmatrix}=\\begin{pmatrix} \\frac{4}{\\sqrt{17}} \\\\ \\frac{1}{\\sqrt{17}} \\end{pmatrix}.\n$$\nExpressed as a row matrix for $[u_{1},u_{2}]$, the maximizing unit input vector is $\\begin{pmatrix} \\frac{4}{\\sqrt{17}} & \\frac{1}{\\sqrt{17}} \\end{pmatrix}$.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{4}{\\sqrt{17}} & \\frac{1}{\\sqrt{17}} \\end{pmatrix}}$$", "id": "1583894"}, {"introduction": "The theoretical ability to control a system can be compromised by real-world physical failures. This problem [@problem_id:1583841] investigates the consequences of an actuator fault that mechanically couples two inputs, effectively reducing the system's control authority. By analyzing the constrained system, you will discover how such a failure can lead to uncontrollable dynamics, manifesting as fixed poles that cannot be shifted by any state-feedback controller.", "problem": "A two-input, three-state Linear Time-Invariant (LTI) system is described by the state-space equation $\\dot{x}(t) = Ax(t) + Bu(t)$, where $x(t) \\in \\mathbb{R}^3$ is the state vector and $u(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\end{pmatrix}$ is the input vector. The system matrices are given by:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n-6 & -11 & -6\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n1 & 0 \\\\\n0 & 1 \\\\\n0 & 0\n\\end{pmatrix}\n$$\nInitially, the system is fully controllable, meaning that for any desired set of three stable complex numbers, a state-feedback controller of the form $u(t) = -Kx(t)$ can be designed to place the closed-loop system poles at precisely those locations.\n\nSuppose that due to a mechanical fault in the actuator linkage, the two control inputs become coupled by the rigid constraint $u_1(t) = \\alpha u_2(t)$, where the constant $\\alpha$ is given as $-\\frac{4}{3}$. This failure effectively reduces the number of independent control signals from two to one. As a result, the set of achievable closed-loop pole locations is drastically reduced. In fact, one or more of the system's poles become fixed and cannot be moved by any state-feedback law applied to the constrained system.\n\nDetermine the numerical value(s) of any such fixed, unmovable pole(s) of the system under this actuator constraint. If there is more than one such pole, list all of them.", "solution": "Under the constraint $u_{1}(t)=\\alpha u_{2}(t)$ with $\\alpha=-\\frac{4}{3}$, define the single input $v(t)=u_{2}(t)$ so that $u(t)=\\begin{pmatrix}\\alpha \\\\ 1\\end{pmatrix}v(t)$. The effective input matrix becomes\n$$\nb \\equiv B\\begin{pmatrix}\\alpha \\\\ 1\\end{pmatrix}=\\alpha b_{1}+b_{2}=\\begin{pmatrix}\\alpha \\\\ 1 \\\\ 0\\end{pmatrix},\\quad \\text{with }\\alpha=-\\frac{4}{3}.\n$$\nThus the constrained system is SISO:\n$$\n\\dot{x}(t)=Ax(t)+b\\,v(t),\\qquad v(t)=-k^{T}x(t),\n$$\ngiving the closed-loop matrix $A_{\\text{cl}}=A-bk^{T}$. In a SISO system, any uncontrollable eigenvalue of $(A,b)$ is a fixed (unmovable) pole under state feedback. By the PBH controllability test, an eigenvalue $\\lambda$ of $A$ is uncontrollable if there exists a nonzero row vector $w^{T}$ such that\n$$\nw^{T}A=\\lambda w^{T},\\qquad w^{T}b=0.\n$$\n\nFirst, compute the eigenvalues of $A$. The characteristic polynomial is\n$$\n\\det(sI-A)=s^{3}+6s^{2}+11s+6=(s+1)(s+2)(s+3),\n$$\nso the eigenvalues are $\\lambda\\in\\{-1,-2,-3\\}$.\n\nLet $q$ be a (column) eigenvector of $A^{T}$ for eigenvalue $\\lambda$, i.e., $A^{T}q=\\lambda q$. Writing $q=\\begin{pmatrix}q_{1}\\\\ q_{2}\\\\ q_{3}\\end{pmatrix}$ and using\n$$\nA^{T}=\\begin{pmatrix}\n0 & 0 & -6\\\\\n1 & 0 & -11\\\\\n0 & 1 & -6\n\\end{pmatrix},\n$$\nthe eigenvector equations yield\n$$\n-6q_{3}=\\lambda q_{1},\\qquad q_{1}-11q_{3}=\\lambda q_{2},\\qquad q_{2}-6q_{3}=\\lambda q_{3}.\n$$\nFrom these,\n$$\nq_{2}=(\\lambda+6)q_{3},\\qquad q_{1}=-\\frac{6}{\\lambda}q_{3}.\n$$\nThe PBH condition $w^{T}b=0$ becomes $q^{T}b=0$, i.e.,\n$$\n\\alpha q_{1}+q_{2}=0 \\;\\;\\Longleftrightarrow\\;\\; \\alpha\\left(-\\frac{6}{\\lambda}q_{3}\\right)+(\\lambda+6)q_{3}=0.\n$$\nFor nonzero $q_{3}$ this reduces to\n$$\n-\\frac{6\\alpha}{\\lambda}+\\lambda+6=0 \\;\\;\\Longleftrightarrow\\;\\; \\lambda^{2}+6\\lambda-6\\alpha=0.\n$$\nSubstitute $\\alpha=-\\frac{4}{3}$ to obtain\n$$\n\\lambda^{2}+6\\lambda+8=0 \\;\\;\\Longleftrightarrow\\;\\; (\\lambda+2)(\\lambda+4)=0,\n$$\nso the candidate uncontrollable eigenvalues are $\\lambda=-2$ and $\\lambda=-4$. Only those which are also eigenvalues of $A$ can be fixed poles. Since the eigenvalues of $A$ are $\\{-1,-2,-3\\}$, the only common value is $\\lambda=-2$.\n\nTherefore, the constrained system has a fixed, unmovable pole at $\\lambda=-2$; the other two poles remain assignable within the controllable subspace.", "answer": "$$\\boxed{-2}$$", "id": "1583841"}]}