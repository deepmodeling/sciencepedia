{"hands_on_practices": [{"introduction": "This first practice is a foundational exercise that goes to the heart of the Smith predictor's design. By deriving the closed-loop transfer function under the assumption of a perfect model, you will see precisely how this control structure mathematically isolates the process time delay from the feedback loop's characteristic equation. This result is the key to understanding why the Smith predictor allows for more aggressive controller tuning than standard feedback control on systems with large delays. [@problem_id:1611252]", "problem": "In a chemical processing plant, a control system is designed to regulate the concentration of a product. The process has a transfer function given by $P(s) = P_0(s)\\exp(-s\\tau)$, where $P_0(s)$ represents the dynamics of the chemical reactor and $\\exp(-s\\tau)$ represents a pure time delay $\\tau$ due to the transport of the product to a downstream sensor.\n\nTo overcome the challenges posed by this time delay, a Smith predictor control scheme is implemented. The scheme uses a controller with transfer function $C(s)$. The output of the controller, $U(s)$, is fed to the actual process to produce the output $Y(s)$.\n\nThe feedback signal, $B(s)$, which is compared with the setpoint $R(s)$, is synthesized as follows:\n$B(s) = Y_m(s) + (Y(s) - Y_{pred}(s))$\nwhere:\n- $Y(s)$ is the actual measured output of the process.\n- $Y_m(s)$ is the output of a mathematical model of the process *without* the time delay.\n- $Y_{pred}(s)$ is the output of a mathematical model of the *entire* process, *including* the time delay.\n\nAssume that the mathematical models used within the Smith predictor are a perfect match for the actual process. That is, the model for the delay-free part is $\\hat{P}_0(s) = P_0(s)$ and the model for the full process is $\\hat{P}(s) = P(s)$.\n\nYour task is to derive the overall closed-loop transfer function of the system, defined as $G_{cl}(s) = \\frac{Y(s)}{R(s)}$. Express your answer in terms of $C(s)$, $P_0(s)$, and $\\tau$.", "solution": "The actual process is given by $P(s)=P_{0}(s)\\exp(-s\\tau)$. With input $U(s)$, the true output is\n$$\nY(s)=P(s)U(s)=P_{0}(s)\\exp(-s\\tau)\\,U(s).\n$$\nThe Smith predictor constructs\n$$\nB(s)=Y_{m}(s)+\\big(Y(s)-Y_{\\text{pred}}(s)\\big),\n$$\nwhere, under perfect model matching, the internal models are $\\hat{P}_{0}(s)=P_{0}(s)$ and $\\hat{P}(s)=P(s)$. Hence\n$$\nY_{m}(s)=\\hat{P}_{0}(s)U(s)=P_{0}(s)U(s), \\quad Y_{\\text{pred}}(s)=\\hat{P}(s)U(s)=P(s)U(s)=Y(s).\n$$\nTherefore,\n$$\nB(s)=Y_{m}(s)+\\big(Y(s)-Y_{\\text{pred}}(s)\\big)=P_{0}(s)U(s).\n$$\nThe controller input is the error $E(s)=R(s)-B(s)$, and the controller output is\n$$\nU(s)=C(s)E(s)=C(s)\\big(R(s)-B(s)\\big)=C(s)\\big(R(s)-P_{0}(s)U(s)\\big).\n$$\nRearranging,\n$$\nU(s)+C(s)P_{0}(s)U(s)=C(s)R(s)\\quad\\Rightarrow\\quad U(s)=\\frac{C(s)}{1+C(s)P_{0}(s)}\\,R(s).\n$$\nThe actual output is then\n$$\nY(s)=P_{0}(s)\\exp(-s\\tau)\\,U(s)=P_{0}(s)\\exp(-s\\tau)\\,\\frac{C(s)}{1+C(s)P_{0}(s)}\\,R(s).\n$$\nThus the overall closed-loop transfer function is\n$$\nG_{cl}(s)=\\frac{Y(s)}{R(s)}=\\frac{C(s)P_{0}(s)\\exp(-s\\tau)}{1+C(s)P_{0}(s)}.\n$$", "answer": "$$\\boxed{\\frac{C(s)P_{0}(s)\\exp(-s\\tau)}{1+C(s)P_{0}(s)}}$$", "id": "1611252"}, {"introduction": "Building on the ideal case, this exercise moves from theory to practical design. Once the Smith predictor structure has effectively removed the time delay from the primary feedback loop, the challenge becomes designing a controller for the remaining delay-free part of the process. This problem guides you through synthesizing a controller, $G_c(s)$, to achieve a specific, desired performance for the system, which is a core task in applying the Smith predictor method. [@problem_id:1611279]", "problem": "Consider a process with a transfer function $G(s) = G_m(s) e^{-\\theta s}$, where $G_m(s) = \\frac{K}{\\tau s + 1}$ represents the delay-free dynamics and $e^{-\\theta s}$ represents a pure time delay. Here, $K$, $\\tau$, and $\\theta$ are positive real constants representing the process gain, process time constant, and delay time, respectively.\n\nA feedback control system is designed for this process. The design strategy involves creating a controller, $G_c(s)$, based on the delay-free part of the process, $G_m(s)$. In this control architecture, the effective closed-loop transfer function from the setpoint, $R(s)$, to the output of the delay-free model, $Y_m(s)$, is given by:\n$$\n\\frac{Y_m(s)}{R(s)} = \\frac{G_c(s) G_m(s)}{1 + G_c(s) G_m(s)}\n$$\nThe design specification requires this effective closed-loop response to behave as a simple first-order system with a desired time constant $\\tau_{cl}$:\n$$\n\\frac{Y_m(s)}{R(s)} = \\frac{1}{\\tau_{cl} s + 1}\n$$\nwhere $\\tau_{cl}$ is a positive real constant.\n\nDetermine the transfer function of the controller, $G_c(s)$, that is required to meet this design specification. Express your answer as a function of $K$, $\\tau$, and $\\tau_{cl}$.", "solution": "The effective closed-loop transfer function for the delay-free model is given by\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{G_{c}(s)G_{m}(s)}{1+G_{c}(s)G_{m}(s)}.\n$$\nDefine the loop transfer function as $L(s)=G_{c}(s)G_{m}(s)$. Then the closed-loop form becomes\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{L(s)}{1+L(s)}.\n$$\nTo meet the specification\n$$\n\\frac{Y_{m}(s)}{R(s)}=\\frac{1}{\\tau_{cl}s+1},\n$$\nwe require\n$$\n\\frac{L(s)}{1+L(s)}=\\frac{1}{\\tau_{cl}s+1}.\n$$\nSolve this for $L(s)$:\n$$\nL(s)=\\frac{\\frac{1}{\\tau_{cl}s+1}}{1-\\frac{1}{\\tau_{cl}s+1}}=\\frac{\\frac{1}{\\tau_{cl}s+1}}{\\frac{\\tau_{cl}s}{\\tau_{cl}s+1}}=\\frac{1}{\\tau_{cl}s}.\n$$\nThus\n$$\nG_{c}(s)G_{m}(s)=\\frac{1}{\\tau_{cl}s}.\n$$\nWith $G_{m}(s)=\\frac{K}{\\tau s+1}$, solve for $G_{c}(s)$:\n$$\nG_{c}(s)=\\frac{\\frac{1}{\\tau_{cl}s}}{\\frac{K}{\\tau s+1}}=\\frac{\\tau s+1}{K\\,\\tau_{cl}\\,s}.\n$$\nEquivalently, this is a proportional-integral form\n$$\nG_{c}(s)=\\frac{\\tau}{K\\tau_{cl}}+\\frac{1}{K\\tau_{cl}s}.\n$$\nEither expression satisfies the design requirement and depends only on $K$, $\\tau$, and $\\tau_{cl}$. The delay parameter does not enter because the specification is imposed on the delay-free model response.", "answer": "$$\\boxed{\\frac{\\tau s+1}{K\\,\\tau_{cl}\\,s}}$$", "id": "1611279"}, {"introduction": "The performance of a Smith predictor in the real world hinges on the accuracy of its internal model. This final practice explores the crucial topic of model mismatch, a scenario where the model differs from the actual process. By analyzing how the system responds when the model dynamics are significantly slower than the true process, you will develop critical intuition about the predictor's robustness and learn to anticipate the consequences of modeling errors. [@problem_id:1611238]", "problem": "A process control engineer is tasked with implementing a Smith predictor control scheme for a chemical reactor. The reactor's dynamic behavior is well-approximated by a first-order-plus-dead-time (FOPDT) process with the transfer function $G_p(s)$. The engineer models the process as $G_m(s)$ to design the Smith predictor.\n\nThe actual process transfer function is:\n$$G_p(s) = \\frac{K_p}{\\tau_p s + 1} e^{-\\theta_p s}$$\n\nThe model transfer function used in the Smith predictor is:\n$$G_m(s) = \\frac{K_m}{\\tau_m s + 1} e^{-\\theta_m s}$$\n\nThe Smith predictor structure uses a primary controller, $C(s)$, and the process model $G_m(s)$ to generate a control signal. Due to an error during the system identification phase, the engineer correctly identifies the process gain ($K_m = K_p$) and the time delay ($\\theta_m = \\theta_p$), but significantly overestimates the process time constant. That is, the model time constant $\\tau_m$ is much larger than the actual process time constant $\\tau_p$ (i.e., $\\tau_m \\gg \\tau_p$). The primary controller $C(s)$ is tuned based on the slow model dynamics $(\\tau_m)$ to achieve a responsive, non-oscillatory behavior for the *ideal* case where the model is perfect.\n\nGiven this significant mismatch where the model is much slower than the actual process, which of the following statements best describes the qualitative shape of the closed-loop system's response to a unit step change in the setpoint?\n\nA. The response will exhibit a large initial overshoot followed by oscillations before settling.\n\nB. The response will be smooth and sluggish, with a settling time much longer than the ideal case.\n\nC. The response will show an initial inverse behavior, where the output first moves in the opposite direction of the setpoint change before rising.\n\nD. The response will be nearly identical to the ideal response (as if the model were perfect), demonstrating the robustness of the Smith predictor.\n\nE. The response will initially be very slow, matching the model's time constant $\\tau_m$, and then will rapidly accelerate towards the setpoint.", "solution": "We start by rewriting the process and model as the product of a pure delay and a delay-free first-order part. Define\n$$\nG_{p}(s)=\\exp(-\\theta s)\\,G_{p0}(s),\\quad G_{p0}(s)=\\frac{K_{p}}{\\tau_{p}s+1},\n$$\n$$\nG_{m}(s)=\\exp(-\\theta s)\\,G_{m0}(s),\\quad G_{m0}(s)=\\frac{K_{m}}{\\tau_{m}s+1},\n$$\nwith $K_{m}=K_{p}$ and $\\theta_{m}=\\theta_{p}=\\theta$, and with the mismatch $\\tau_{m}\\gg \\tau_{p}$ so that the model is much slower than the actual plant.\n\nIn the standard Smith predictor, the controller $C(s)$ acts on the error between the reference and a “predicted” output that uses the delay-free model and a correction from the delayed mismatch. A convenient algebraic form of the Smith predictor is given by the following predictor signal:\n$$\n\\hat{y}(s)=G_{m0}(s)\\,u(s)+\\big[y(s)-\\exp(-\\theta s)\\,G_{m0}(s)\\,u(s)\\big],\n$$\nso that the controller input is $e(s)=r(s)-\\hat{y}(s)$ and $u(s)=C(s)\\,e(s)$. Substituting $\\hat{y}(s)$ into $e(s)$ gives\n$$\ne(s)=r(s)-y(s)-G_{m0}(s)\\,u(s)+\\exp(-\\theta s)\\,G_{m0}(s)\\,u(s).\n$$\nTherefore,\n$$\nu(s)=C(s)\\big[r(s)-y(s)\\big]-C(s)\\,G_{m0}(s)\\big[1-\\exp(-\\theta s)\\big]\\,u(s).\n$$\nRearranging terms yields\n$$\n\\big[1+C(s)\\,G_{m0}(s)\\big(1-\\exp(-\\theta s)\\big)\\big]\\,u(s)=C(s)\\big[r(s)-y(s)\\big].\n$$\nThe actual plant output satisfies $y(s)=\\exp(-\\theta s)\\,G_{p0}(s)\\,u(s)$. Eliminating $u(s)$ leads to the closed-loop transfer function from $r$ to $y$:\n$$\n\\frac{y(s)}{r(s)}=\\frac{\\exp(-\\theta s)\\,C(s)\\,G_{p0}(s)}{1+C(s)\\,G_{m0}(s)+\\exp(-\\theta s)\\,C(s)\\big(G_{p0}(s)-G_{m0}(s)\\big)}.\n$$\nIn the ideal case $G_{p0}(s)=G_{m0}(s)$, the delayed mismatch term cancels and one recovers the nominal delay-compensated response\n$$\n\\frac{y(s)}{r(s)}=\\frac{\\exp(-\\theta s)\\,C(s)\\,G_{m0}(s)}{1+C(s)\\,G_{m0}(s)},\n$$\nwhich behaves like the delay-free loop shaped by $C(s)$, followed by the pure delay $\\exp(-\\theta s)$.\n\nWith the given mismatch $\\tau_{m}\\gg\\tau_{p}$, the model is significantly slower than the plant. For the same $K_{p}$, one has\n$$\nG_{p0}(s)=\\frac{K_{p}}{\\tau_{p}s+1},\\quad G_{m0}(s)=\\frac{K_{p}}{\\tau_{m}s+1},\\quad \\text{with}\\ \\tau_{m}\\gg \\tau_{p}.\n$$\nHence $G_{p0}(s)-G_{m0}(s)$ is positive real for frequencies of interest (the actual plant has a much larger bandwidth and larger magnitude than the slow model over a wide range). The denominator of the closed-loop transfer function includes the additional delayed term\n$$\n\\exp(-\\theta s)\\,C(s)\\big(G_{p0}(s)-G_{m0}(s)\\big),\n$$\nwhich introduces a delayed positive contribution to the loop dynamics. Qualitatively, this produces the following mechanism:\n- For $t<\\theta$, the correction term $y(t)-\\big[\\exp(-\\theta s)\\,G_{m0}(s)\\,u(s)\\big]^{\\vee}$ is zero (both the actual and model-delayed outputs have not yet changed), so the controller only “sees” the slow, delay-free model $G_{m0}(s)$. Because $C(s)$ was tuned to make the slow model respond quickly and without oscillation, it applies a relatively strong control effort to accelerate the sluggish model trajectory.\n- At $t=\\theta$ and beyond, the actual plant, being much faster than the model, produces an output that rises much more quickly than the model-predicted trajectory. The delayed mismatch term $\\exp(-\\theta s)\\,C(s)\\big(G_{p0}(s)-G_{m0}(s)\\big)$ then feeds back a correction that suddenly reduces the error seen by the controller. However, because the controller has already driven the input strongly for a duration of length $\\theta$, the actual output typically overshoots the setpoint once the plant starts responding. The delayed mismatch feedback can further induce underdamped behavior, manifesting as oscillations, before the system settles.\n\nTherefore, when the model time constant is greatly overestimated relative to the actual process, the closed-loop step response typically shows a substantial overshoot right after the delay elapses, possibly followed by oscillations, before settling. This behavior matches option A, and contradicts the other options:\n- Not B: the plant is faster than the model; the response is not smooth and sluggish but rather aggressive.\n- Not C: there is no nonminimum-phase zero to produce an inverse response.\n- Not D: large mismatch of dynamics breaks the nominal Smith predictor equivalence.\n- Not E: the output does not first follow the slow model; it remains flat during the delay and then rises faster than the model, causing overshoot rather than an initially slow rise that later accelerates.\n\nThus, the best qualitative description is a large overshoot with possible oscillations before settling.", "answer": "$$\\boxed{A}$$", "id": "1611238"}]}