{"hands_on_practices": [{"introduction": "The core function of an op-amp's input stage is to convert a differential input voltage into a current signal. The efficiency of this voltage-to-current conversion is quantified by a parameter called transconductance, denoted as $g_m$. In this exercise [@problem_id:1312241], we will calculate this fundamental parameter for the transistors in a differential pair, revealing the direct relationship between the DC bias current and the op-amp's small-signal amplification capability.", "problem": "An electronics engineer is analyzing the input stage of a simplified, legacy-style general-purpose operational amplifier. The input stage consists of a differential pair made from two identical Bipolar Junction Transistors (BJTs). This differential pair is biased by an ideal constant current source, known as a tail current source, which provides a total current of $I_{TAIL} = 19.2 \\, \\mu\\text{A}$. The amplifier operates with dual power supplies of $V_{CC} = +15 \\text{ V}$ and $V_{EE} = -15 \\text{ V}$ at an ambient temperature of $T = 300 \\text{ K}$.\n\nFor the purpose of small-signal analysis, it is assumed that with zero differential input voltage, the tail current $I_{TAIL}$ is split perfectly and equally between the collector currents of the two transistors in the pair.\n\nUsing the physical constants provided below, calculate the small-signal transconductance, $g_m$, for one of these input transistors under these bias conditions.\n\n- Boltzmann constant, $k_B = 1.38 \\times 10^{-23} \\text{ J/K}$\n- Elementary charge, $e = 1.60 \\times 10^{-19} \\text{ C}$\n\nExpress your answer in amperes per volt (A/V). Round your final answer to three significant figures.", "solution": "For a BJT in forward active region, the small-signal transconductance is defined by\n$$\ng_{m}=\\frac{\\partial I_{C}}{\\partial V_{BE}}=\\frac{I_{C}}{V_{T}},\n$$\nwhere the thermal voltage is\n$$\nV_{T}=\\frac{k_{B}T}{e}.\n$$\nWith a perfectly symmetric differential pair at zero differential input, the collector current of each transistor is half of the tail current, so\n$$\nI_{C}=\\frac{I_{TAIL}}{2}.\n$$\nTherefore,\n$$\ng_{m}=\\frac{I_{C}}{V_{T}}=\\frac{\\frac{I_{TAIL}}{2}}{\\frac{k_{B}T}{e}}=\\frac{e\\,I_{TAIL}}{2k_{B}T}.\n$$\nSubstitute the given numerical values, using $I_{TAIL}=19.2\\times 10^{-6}\\,\\text{A}$, $T=300\\,\\text{K}$, $k_{B}=1.38\\times 10^{-23}\\,\\text{J/K}$, and $e=1.60\\times 10^{-19}\\,\\text{C}$:\n$$\nV_{T}=\\frac{k_{B}T}{e}=\\frac{(1.38\\times 10^{-23})(300)}{1.60\\times 10^{-19}}=2.5875\\times 10^{-2}\\,\\text{V},\n$$\n$$\nI_{C}=\\frac{19.2\\times 10^{-6}}{2}=9.6\\times 10^{-6}\\,\\text{A},\n$$\n$$\ng_{m}=\\frac{9.6\\times 10^{-6}}{2.5875\\times 10^{-2}}=3.7101449\\times 10^{-4}\\,\\text{A/V}.\n$$\nRounding to three significant figures gives\n$$\ng_{m}=3.71\\times 10^{-4}\\,\\text{A/V}.\n$$\nThe supply voltages do not enter this calculation under the given assumptions, because $g_{m}$ depends only on the bias current and temperature.", "answer": "$$\\boxed{3.71 \\times 10^{-4}}$$", "id": "1312241"}, {"introduction": "To achieve the high voltage gain characteristic of op-amps, the current signal from the input stage is passed through a very high resistance. Modern op-amps create this high resistance using transistors in an 'active load' configuration. This practice [@problem_id:1312233] investigates how the finite output resistance of these active load transistors, a non-ideality modeled by the Early voltage, impacts the overall voltage gain of the amplifier stage. By comparing the ideal and actual scenarios, you will quantify the importance of the active load's quality.", "problem": "An analog circuit designer is analyzing the first stage of a two-stage operational amplifier to understand the impact of simplifying assumptions on performance predictions. This stage is a differential amplifier consisting of two identical NMOS input transistors (Q1 and Q2) and a PMOS current-mirror active load (Q3 and Q4). The output of the stage is taken from the node connecting the drains of Q2 and Q4.\n\nFor the analysis, assume that all four transistors are biased such that the magnitude of their drain current is identical, denoted as $|I_D|$. The transconductance of the NMOS input transistors is $g_m$. The channel-length modulation effect is modeled using the Early voltage. The Early voltage for the NMOS transistors is $V_{AN} = 35 \\text{ V}$, and for the PMOS transistors, it is $V_{AP} = 45 \\text{ V}$. For all calculations, you may use the standard small-signal approximation for the output resistance, $r_o \\approx |V_A| / |I_D|$, where $V_A$ is the corresponding Early voltage.\n\nThe designer wishes to quantify the effect of idealizing the active load. Calculate the ratio of the actual DC voltage gain of this differential stage to the gain that would be calculated if the Early voltage of the PMOS active load transistors were assumed to be infinite. Express your answer as a decimal rounded to three significant figures.", "solution": "The small-signal voltage gain magnitude of a single-ended differential stage can be written as the product of the effective transconductance from the differential input to the output current and the small-signal resistance seen at the output node:\n$$\nA_{v} = G_{m,\\text{eff}} \\, R_{\\text{out}}.\n$$\nIn this topology with a PMOS current-mirror active load, under the given assumptions, the only nonideality to be considered in the active load is the finite output resistance due to the Early effect. The PMOS transconductance is not specified and is not needed for the ratio requested. Therefore, the effective transconductance factor $G_{m,\\text{eff}}$ is the same in both the actual and the idealized cases, and it cancels in the ratio of gains. Hence, the ratio of the actual gain to the idealized gain equals the ratio of the corresponding output resistances:\n$$\n\\frac{A_{v,\\text{actual}}}{A_{v,\\text{ideal}}} = \\frac{R_{\\text{out, actual}}}{R_{\\text{out, ideal}}}.\n$$\n\nAt the output node (drain of $Q_{2}$ and $Q_{4}$), the small-signal resistance to AC ground is the parallel combination of the NMOS output resistance $r_{oN}$ and the PMOS output resistance $r_{oP}$:\n$$\nR_{\\text{out, actual}} = r_{oN} \\parallel r_{oP} = \\frac{r_{oN} r_{oP}}{r_{oN} + r_{oP}}.\n$$\nIf the PMOS Early voltage is assumed infinite, then $r_{oP} \\to \\infty$, so\n$$\nR_{\\text{out, ideal}} = r_{oN}.\n$$\nTherefore,\n$$\n\\frac{A_{v,\\text{actual}}}{A_{v,\\textual}} = \\frac{r_{oN} \\parallel r_{oP}}{r_{oN}} = \\frac{r_{oP}}{r_{oN} + r_{oP}} = \\frac{1}{1 + \\frac{r_{oN}}{r_{oP}}}.\n$$\n\nUsing the small-signal approximation for output resistance $r_{o} \\approx \\frac{|V_{A}|}{|I_{D}|}$ for each device,\n$$\nr_{oN} = \\frac{V_{AN}}{|I_{D}|}, \\quad r_{oP} = \\frac{V_{AP}}{|I_{D}|}.\n$$\nSubstituting into the ratio,\n$$\n\\frac{A_{v,\\text{actual}}}{A_{v,\\text{ideal}}} = \\frac{\\frac{V_{AP}}{|I_{D}|}}{\\frac{V_{AN}}{|I_{D}|} + \\frac{V_{AP}}{|I_{D}|}} = \\frac{V_{AP}}{V_{AN} + V_{AP}}.\n$$\nWith $V_{AN} = 35$ and $V_{AP} = 45$,\n$$\n\\frac{A_{v,\\text{actual}}}{A_{v,\\text{ideal}}} = \\frac{45}{35 + 45} = \\frac{45}{80} = 0.5625 \\approx 0.563 \\text{ (to three significant figures)}.\n$$", "answer": "$$\\boxed{0.563}$$", "id": "1312233"}, {"introduction": "Beyond small-signal amplification, an op-amp's performance is also defined by its large-signal dynamic behavior, particularly its slew rate. The slew rate dictates the maximum speed at which the output voltage can change and is a critical specification for high-frequency applications. This problem [@problem_id:1312204] delves into the internal mechanism of slew rate limiting, showing how it is determined by the maximum current the input stage can provide to charge or discharge the internal compensation capacitor, and why this often results in asymmetric positive and negative slew rates.", "problem": "A simplified two-stage model is used to analyze the asymmetric slew rate of a particular type of Operational Amplifier (op-amp). The internal structure consists of a first transconductance stage followed by a second inverting gain stage. A Miller compensation capacitor, with capacitance $C_C$, is connected between the input and output of the second stage. The op-amp's overall slew rate is limited by the maximum current that the first stage can deliver to charge or discharge this capacitor at the input node of the second stage.\n\nBased on the design of the first stage, its current driving capabilities are asymmetric:\n1.  When subjected to a large input signal that causes the op-amp's output voltage to increase, the first stage acts as a current sink, drawing a maximum current of $I_{sink,max}$ from the input node of the second stage.\n2.  When subjected to a large input signal that causes the op-amp's output voltage to decrease, the first stage acts as a current source, pushing a maximum current of $I_{source,max}$ into the input node of the second stage.\n\nFor the op-amp under consideration, the biasing results in the following maximum available currents from the first stage:\n$I_{sink,max} = 22.0 \\, \\mu\\text{A}$\n$I_{source,max} = 9.50 \\, \\mu\\text{A}$\n\nCalculate the theoretical ratio of the positive-going slew rate ($SR_+$) to the negative-going slew rate ($SR_-$). Express your answer as a single numerical value, rounded to three significant figures.", "solution": "The slew rate is set by the maximum current that the first stage can supply to charge or discharge the Miller capacitor $C_{C}$ at the input node of the second stage. Let the input node of the second stage have voltage $v_{n}$ and the output be $v_{o}$. The current through $C_{C}$ from node $n$ to the output is\n$$\ni_{C} = C_{C}\\,\\frac{d}{dt}\\left(v_{n}-v_{o}\\right).\n$$\nLet $i_{f}$ be the current delivered by the first stage into the node (positive when sourcing into the node). By KCL at the node and neglecting the second stage input current,\n$$\ni_{f} = i_{C} = C_{C}\\left(\\frac{dv_{n}}{dt}-\\frac{dv_{o}}{dt}\\right).\n$$\nDuring slew-rate limiting, the second stage saturates and $v_{n}$ is approximately constant, so $\\frac{dv_{n}}{dt}\\approx 0$. Hence,\n$$\n\\frac{dv_{o}}{dt} = -\\frac{i_{f}}{C_{C}}.\n$$\nTherefore, the magnitude of the slew rate is\n$$\nSR = \\left|\\frac{dv_{o}}{dt}\\right| = \\frac{|i_{f}|}{C_{C}}.\n$$\nFrom the problem statement, when the output increases (positive-going), the first stage acts as a current sink, so $|i_{f}| = I_{sink,max}$ and\n$$\nSR_{+} = \\frac{I_{sink,max}}{C_{C}}.\n$$\nWhen the output decreases (negative-going), the first stage acts as a current source, so $|i_{f}| = I_{source,max}$ and\n$$\nSR_{-} = \\frac{I_{source,max}}{C_{C}}.\n$$\nThus, the ratio is independent of $C_{C}$:\n$$\n\\frac{SR_{+}}{SR_{-}} = \\frac{I_{sink,max}}{I_{source,max}}.\n$$\nSubstituting the given values $I_{sink,max}=22.0\\times 10^{-6}\\ \\text{A}$ and $I_{source,max}=9.50\\times 10^{-6}\\ \\text{A}$,\n$$\n\\frac{SR_{+}}{SR_{-}} = \\frac{22.0}{9.50} = \\frac{44}{19} \\approx 2.315789\\ldots\n$$\nRounded to three significant figures, this is $2.32$.", "answer": "$$\\boxed{2.32}$$", "id": "1312204"}]}