{"hands_on_practices": [{"introduction": "The law of mass conservation is a cornerstone of continuum mechanics, stating that the mass of a material body is invariant under deformation. A key skill is relating the mass density in the initial, undeformed state (Lagrangian description) to the density in the current, deformed state (Eulerian description). This exercise [@problem_id:2871720] provides direct practice in this transformation, using the Jacobian determinant of the deformation gradient to track how density evolves and verifying that total mass remains constant.", "problem": "A compressible continuum body occupies the reference configuration $\\mathcal{B}_0=\\{ \\mathbf{X}=(X_1,X_2,X_3) \\mid 0 \\le X_1 \\le L_1,\\ 0 \\le X_2 \\le L_2,\\ 0 \\le X_3 \\le L_3 \\}$ at time $t=0$, with a prescribed referential mass density field\n$$\n\\rho_0(\\mathbf{X}) = \\rho_{00}\\left[ 1 + \\eta \\frac{X_1}{L_1}\\frac{X_2}{L_2}\\exp\\!\\left(-\\frac{X_3}{L_3}\\right)\\right],\n$$\nwhere $\\rho_{00}0$, $L_10$, $L_20$, $L_30$, and $\\eta-1$ are constants. The motion is given by a smooth, one-to-one deformation mapping $\\boldsymbol{\\chi}:\\mathcal{B}_0\\times[0,T]\\to\\mathbb{R}^3$ of the form\n$$\n\\begin{aligned}\nx_1 = (1+\\alpha t)\\,X_1,\\\\\nx_2 = (1+\\beta t^2)\\,X_2,\\\\\nx_3 = (1+\\gamma t)\\,X_3 + \\delta t\\,X_1 X_2,\n\\end{aligned}\n$$\nwhere $\\alpha,\\beta,\\gamma,\\delta$ are real constants, and $t$ satisfies $1+\\alpha t0$, $1+\\beta t^20$, and $1+\\gamma t0$. For this motion, the deformation gradient is lower triangular, and its Jacobian determinant is\n$$\nJ(\\mathbf{X},t) = (1+\\alpha t)(1+\\beta t^2)(1+\\gamma t).\n$$\n\nUsing only the conservation of mass for a continuum and fundamental kinematics, derive the current mass density field $\\rho(\\mathbf{x},t)$ in closed form as a function of $(\\mathbf{x},t)$ and the given data. Then verify conservation of total mass by evaluating the total mass $M(t)$ of the body at time $t$ and showing that it is independent of $t$, determining its value in terms of the given constants.\n\nProvide your final answer as the explicit symbolic expression for $\\rho(\\mathbf{x},t)$ in kilogram per cubic meter (kg/m$^3$). No numerical rounding is required. The verification of mass conservation and the expression for $M(t)$ should appear in your solution, but the final boxed answer should consist only of the expression for $\\rho(\\mathbf{x},t)$.", "solution": "The problem statement has been evaluated and is determined to be valid. It is a well-posed problem in continuum mechanics, free of scientific or logical flaws, and all necessary information for its solution is provided.\n\nThe fundamental principle governing the distribution of mass is the law of conservation of mass. In the material description, this law takes the form\n$$\n\\rho_0(\\mathbf{X}) = J(\\mathbf{X}, t) \\rho(\\boldsymbol{\\chi}(\\mathbf{X}, t), t)\n$$\nwhere $\\rho_0(\\mathbf{X})$ is the mass density in the reference configuration $\\mathcal{B}_0$, $\\rho(\\mathbf{x}, t)$ is the mass density in the current configuration $\\mathcal{B}_t$, $\\boldsymbol{\\chi}$ is the deformation mapping from $\\mathcal{B}_0$ to $\\mathcal{B}_t$ such that $\\mathbf{x} = \\boldsymbol{\\chi}(\\mathbf{X}, t)$, and $J = \\det(\\mathbf{F})$ is the determinant of the deformation gradient $\\mathbf{F} = \\nabla_{\\mathbf{X}}\\boldsymbol{\\chi}$.\n\nThe problem requires us to find $\\rho$ as an explicit function of the spatial coordinates $\\mathbf{x} = (x_1, x_2, x_3)$ and time $t$. To achieve this, we first rearrange the mass conservation equation to solve for the current density $\\rho$:\n$$\n\\rho(\\mathbf{x}, t) = \\frac{\\rho_0(\\mathbf{X}(\\mathbf{x}, t))}{J(\\mathbf{X}(\\mathbf{x}, t), t)}\n$$\nThis expression indicates that we must express the material coordinates $\\mathbf{X}$ and the Jacobian $J$ in terms of the spatial coordinates $\\mathbf{x}$ and time $t$.\n\nThe problem provides the Jacobian determinant as a function of time only:\n$$\nJ(t) = (1+\\alpha t)(1+\\beta t^2)(1+\\gamma t)\n$$\nThis is consistent with a calculation of the determinant of the deformation gradient $\\mathbf{F}$, where $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$, derived from the given motion:\n$$\n\\mathbf{F} = \\begin{pmatrix} 1+\\alpha t  0  0 \\\\ 0  1+\\beta t^2  0 \\\\ \\delta t X_2  \\delta t X_1  1+\\gamma t \\end{pmatrix}\n$$\nThe determinant is indeed $\\det(\\mathbf{F}) = (1+\\alpha t)(1+\\beta t^2)(1+\\gamma t)$, which is spatially uniform as given.\n\nNext, we find the inverse mapping $\\mathbf{X} = \\boldsymbol{\\chi}^{-1}(\\mathbf{x}, t)$ by solving the motion equations for $X_1, X_2, X_3$:\nFrom $x_1 = (1+\\alpha t)X_1$, we obtain:\n$$\nX_1 = \\frac{x_1}{1+\\alpha t}\n$$\nFrom $x_2 = (1+\\beta t^2)X_2$, we obtain:\n$$\nX_2 = \\frac{x_2}{1+\\beta t^2}\n$$\nFrom $x_3 = (1+\\gamma t)X_3 + \\delta t X_1 X_2$, we substitute the expressions for $X_1$ and $X_2$ to solve for $X_3$:\n$$\nx_3 = (1+\\gamma t)X_3 + \\delta t \\left(\\frac{x_1}{1+\\alpha t}\\right) \\left(\\frac{x_2}{1+\\beta t^2}\\right)\n$$\n$$\n(1+\\gamma t)X_3 = x_3 - \\frac{\\delta t x_1 x_2}{(1+\\alpha t)(1+\\beta t^2)}\n$$\n$$\nX_3 = \\frac{1}{1+\\gamma t}\\left(x_3 - \\frac{\\delta t x_1 x_2}{(1+\\alpha t)(1+\\beta t^2)}\\right)\n$$\nWe now have the complete inverse mapping $\\mathbf{X}(\\mathbf{x}, t)$.\n\nThe referential density is given as:\n$$\n\\rho_0(\\mathbf{X}) = \\rho_{00}\\left[ 1 + \\eta \\frac{X_1}{L_1}\\frac{X_2}{L_2}\\exp\\left(-\\frac{X_3}{L_3}\\right)\\right]\n$$\nWe substitute the expressions for $X_1, X_2, X_3$ into this equation to obtain $\\rho_0(\\mathbf{X}(\\mathbf{x}, t))$:\n\\begin{align*}\n\\rho_0(\\mathbf{X}(\\mathbf{x}, t)) = \\rho_{00}\\left[ 1 + \\eta \\frac{1}{L_1}\\left(\\frac{x_1}{1+\\alpha t}\\right)\\frac{1}{L_2}\\left(\\frac{x_2}{1+\\beta t^2}\\right) \\times \\right. \\\\\n\\quad \\left. \\exp\\left(-\\frac{1}{L_3} \\left( \\frac{1}{1+\\gamma t}\\left(x_3 - \\frac{\\delta t x_1 x_2}{(1+\\alpha t)(1+\\beta t^2)}\\right) \\right) \\right) \\right]\n\\end{align*}\nFinally, we divide by the Jacobian $J(t)$ to find the current density $\\rho(\\mathbf{x}, t)$:\n$$\n\\rho(\\mathbf{x},t) = \\frac{\\rho_{00}}{(1+\\alpha t)(1+\\beta t^2)(1+\\gamma t)}\\left[ 1 + \\frac{\\eta x_1 x_2}{L_1 L_2 (1+\\alpha t)(1+\\beta t^2)} \\exp\\left(-\\frac{1}{L_3(1+\\gamma t)}\\left(x_3 - \\frac{\\delta t x_1 x_2}{(1+\\alpha t)(1+\\beta t^2)}\\right)\\right)\\right]\n$$\nThis is the closed-form expression for the current mass density field.\n\nTo verify the conservation of total mass, we compute the total mass $M(t)$ in the current configuration $\\mathcal{B}_t$:\n$$\nM(t) = \\int_{\\mathcal{B}_t} \\rho(\\mathbf{x}, t) \\, dV_{\\mathbf{x}}\n$$\nBy changing the integration variable to the material coordinates $\\mathbf{X}$, where $dV_{\\mathbf{x}} = J \\, dV_{\\mathbf{X}}$, the integral becomes:\n$$\nM(t) = \\int_{\\mathcal{B}_0} \\rho(\\boldsymbol{\\chi}(\\mathbf{X}, t), t) J(\\mathbf{X}, t) \\, dV_{\\mathbf{X}}\n$$\nUsing the mass conservation principle, $\\rho J = \\rho_0$, this simplifies to:\n$$\nM(t) = \\int_{\\mathcal{B}_0} \\rho_0(\\mathbf{X}) \\, dV_{\\mathbf{X}} = M_0\n$$\nThis demonstrates that the total mass $M(t)$ is constant and equal to the initial mass $M_0$. We now compute this value by integrating $\\rho_0(\\mathbf{X})$ over the reference volume $\\mathcal{B}_0$:\n$$\nM_0 = \\int_{0}^{L_3} \\int_{0}^{L_2} \\int_{0}^{L_1} \\rho_{00}\\left[ 1 + \\eta \\frac{X_1}{L_1}\\frac{X_2}{L_2}\\exp\\left(-\\frac{X_3}{L_3}\\right)\\right] \\, dX_1 dX_2 dX_3\n$$\nWe separate the integral into two parts:\n$$\nM_0 = \\rho_{00} \\int_{0}^{L_3} \\int_{0}^{L_2} \\int_{0}^{L_1} dX_1 dX_2 dX_3 + \\rho_{00}\\eta \\int_{0}^{L_3} \\int_{0}^{L_2} \\int_{0}^{L_1} \\frac{X_1}{L_1}\\frac{X_2}{L_2}\\exp\\left(-\\frac{X_3}{L_3}\\right) \\, dX_1 dX_2 dX_3\n$$\nThe first integral is the volume of the body multiplied by $\\rho_{00}$:\n$$\n\\rho_{00} (L_1 L_2 L_3)\n$$\nThe second integral can be separated into a product of three one-dimensional integrals:\n$$\n\\frac{\\rho_{00}\\eta}{L_1 L_2} \\left(\\int_0^{L_1} X_1 dX_1\\right) \\left(\\int_0^{L_2} X_2 dX_2\\right) \\left(\\int_0^{L_3} \\exp\\left(-\\frac{X_3}{L_3}\\right) dX_3\\right)\n$$\nEvaluating each integral:\n$$\n\\int_0^{L_1} X_1 dX_1 = \\left[\\frac{X_1^2}{2}\\right]_0^{L_1} = \\frac{L_1^2}{2}\n$$\n$$\n\\int_0^{L_2} X_2 dX_2 = \\left[\\frac{X_2^2}{2}\\right]_0^{L_2} = \\frac{L_2^2}{2}\n$$\n$$\n\\int_0^{L_3} \\exp\\left(-\\frac{X_3}{L_3}\\right) dX_3 = \\left[-L_3 \\exp\\left(-\\frac{X_3}{L_3}\\right)\\right]_0^{L_3} = -L_3(\\exp(-1) - \\exp(0)) = L_3(1 - \\exp(-1))\n$$\nSubstituting these results back into the expression for the second part:\n$$\n\\frac{\\rho_{00}\\eta}{L_1 L_2} \\left(\\frac{L_1^2}{2}\\right) \\left(\\frac{L_2^2}{2}\\right) \\left(L_3(1 - \\exp(-1))\\right) = \\rho_{00}\\eta \\frac{L_1 L_2 L_3}{4} (1 - \\exp(-1))\n$$\nThus, the total mass $M_0$ is:\n$$\nM(t) = M_0 = \\rho_{00} L_1 L_2 L_3 + \\rho_{00}\\eta \\frac{L_1 L_2 L_3}{4} (1 - \\exp(-1)) = \\rho_{00} L_1 L_2 L_3 \\left[1 + \\frac{\\eta}{4}\\left(1 - \\exp(-1)\\right)\\right]\n$$\nSince this value is independent of time $t$, conservation of total mass is verified.", "answer": "$$\n\\boxed{\\frac{\\rho_{00}}{(1+\\alpha t)(1+\\beta t^2)(1+\\gamma t)}\\left[ 1 + \\frac{\\eta x_1 x_2}{L_1 L_2 (1+\\alpha t)(1+\\beta t^2)} \\exp\\left(-\\frac{1}{L_3(1+\\gamma t)}\\left(x_3 - \\frac{\\delta t x_1 x_2}{(1+\\alpha t)(1+\\beta t^2)}\\right)\\right)\\right]}\n$$", "id": "2871720"}, {"introduction": "The Cauchy stress tensor, $\\boldsymbol{\\sigma}$, provides a complete description of the state of internal forces at a point within a continuum. To make this abstract concept concrete, we must relate it to the physical force per unit area, or traction vector $\\mathbf{t}$, acting on a specific surface passing through that point. This practice problem [@problem_id:2871778] guides you through deriving and applying Cauchy's fundamental relation, $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$, deepening your physical intuition by decomposing the resulting traction into its normal and shear components.", "problem": "At a material point in a homogeneous, static continuum with negligible body couples, the Cauchy stress tensor (in megapascal (MPa)) with respect to a fixed Cartesian basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ is\n$$\n\\boldsymbol{\\sigma} \\;=\\;\n\\begin{pmatrix}\n80  30  -20 \\\\\n30  50  10 \\\\\n-20  10  100\n\\end{pmatrix} \\;\\text{MPa}.\n$$\nConsider the plane through the point whose unit normal is\n$$\n\\mathbf{n} \\;=\\; \\left(\\frac{2}{3}\\right)\\mathbf{e}_{1} \\;-\\; \\left(\\frac{1}{3}\\right)\\mathbf{e}_{2} \\;+\\; \\left(\\frac{2}{3}\\right)\\mathbf{e}_{3}.\n$$\nStarting from the balance of linear momentum and balance of angular momentum for a continuum, derive the relation that connects the traction vector acting on an oriented plane to the stress tensor. Then, for the given $\\boldsymbol{\\sigma}$ and $\\mathbf{n}$, compute the traction vector $\\mathbf{t}$ acting on the plane. Decompose $\\mathbf{t}$ into its normal component $\\mathbf{t}_{n}$ (parallel to $\\mathbf{n}$) and its shear component $\\mathbf{t}_{s}$ (tangent to the plane), and briefly interpret the physical meaning of the sign of the normal component. Finally, report the magnitude of the shear traction $\\|\\mathbf{t}_{s}\\|$ as a single exact value in MPa. Express the final result in MPa, exactly (no rounding). Do not include any units in your final answer.", "solution": "The posed problem is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded problem within the domain of continuum mechanics, with complete and consistent data. We may proceed with the solution.\n\nThe problem requires the derivation of Cauchy's stress relation from the fundamental balance laws of a continuum, followed by its application to a specific stress state.\n\nFirst, we derive the relationship between the traction vector $\\mathbf{t}$ and the Cauchy stress tensor $\\boldsymbol{\\sigma}$. This relationship is a direct consequence of the balance of linear momentum. For a static continuum in the absence of body forces for simplicity (or for a vanishingly small volume where body forces are higher order terms), the integral form of the balance of linear momentum for an arbitrary volume $V$ with boundary surface $\\partial V$ states that the net force on the body is zero:\n$$\n\\int_{\\partial V} \\mathbf{t} \\, dA = \\mathbf{0}\n$$\nHere, $\\mathbf{t}$ is the traction vector field on the surface $\\partial V$. The traction $\\mathbf{t}$ at a point depends on the orientation of the surface, specified by its unit normal vector $\\mathbf{n}$. We denote this dependence as $\\mathbf{t}(\\mathbf{n})$.\n\nConsider a small tetrahedron at the material point of interest, with three faces lying on the planes orthogonal to the Cartesian basis vectors $\\{\\mathbf{e}_{1}, \\mathbf{e}_{2}, \\mathbf{e}_{3}\\}$ and a fourth face with an arbitrary unit normal $\\mathbf{n}$. Let the area of this fourth face be $dA$. The areas of the other three faces are $dA_j = (\\mathbf{n} \\cdot \\mathbf{e}_j) dA = n_j dA$ for $j=1, 2, 3$. The outward unit normals to these faces are $-\\mathbf{e}_1$, $-\\mathbf{e}_2$, and $-\\mathbf{e}_3$.\n\nApplying the balance of linear momentum to this tetrahedron gives:\n$$\n\\mathbf{t}(\\mathbf{n}) dA + \\mathbf{t}(-\\mathbf{e}_1) dA_1 + \\mathbf{t}(-\\mathbf{e}_2) dA_2 + \\mathbf{t}(-\\mathbf{e}_3) dA_3 + (\\text{body forces}) = \\mathbf{0}\n$$\nCauchy's postulate states that $\\mathbf{t}(-\\mathbf{n}) = -\\mathbf{t}(\\mathbf{n})$. Applying this, we have $\\mathbf{t}(-\\mathbf{e}_j) = -\\mathbf{t}(\\mathbf{e}_j)$. The traction vector on a surface with normal $\\mathbf{e}_j$ is defined as the $j$-th column of the stress tensor, denoted by $\\boldsymbol{\\sigma}_j$. So, $\\mathbf{t}(\\mathbf{e}_j) = \\boldsymbol{\\sigma}_j$.\nSubstituting these into the momentum equation and using $dA_j = n_j dA$:\n$$\n\\mathbf{t}(\\mathbf{n}) dA - \\boldsymbol{\\sigma}_1 (n_1 dA) - \\boldsymbol{\\sigma}_2 (n_2 dA) - \\boldsymbol{\\sigma}_3 (n_3 dA) + (\\text{body forces}) = \\mathbf{0}\n$$\nThe body force term is proportional to the volume of the tetrahedron, which scales with $h^3$ (where $h$ is a characteristic length), while surface forces scale with $h^2$. Dividing by $dA$ and taking the limit as the tetrahedron shrinks to the point ($h \\to 0$), the body force term vanishes. This leaves:\n$$\n\\mathbf{t}(\\mathbf{n}) = n_1 \\boldsymbol{\\sigma}_1 + n_2 \\boldsymbol{\\sigma}_2 + n_3 \\boldsymbol{\\sigma}_3\n$$\nThis can be written in component form. Let $\\mathbf{t} = t_i \\mathbf{e}_i$ and $\\boldsymbol{\\sigma}_j = \\sigma_{ij} \\mathbf{e}_i$. Then:\n$$\nt_i = n_1 \\sigma_{i1} + n_2 \\sigma_{i2} + n_3 \\sigma_{i3} = \\sum_{j=1}^{3} \\sigma_{ij} n_j\n$$\nThis is the component form of the matrix-vector product, known as Cauchy's stress relation:\n$$\n\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}\n$$\nThe balance of angular momentum for a continuum with negligible body couples leads to the conclusion that the Cauchy stress tensor must be symmetric, i.e., $\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^T$. The given stress tensor is indeed symmetric.\n\nNow, we compute the traction vector $\\mathbf{t}$ for the given stress tensor $\\boldsymbol{\\sigma}$ and normal vector $\\mathbf{n}$.\nThe components of the stress tensor and normal vector are:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} 80  30  -20 \\\\ 30  50  10 \\\\ -20  10  100 \\end{pmatrix} \\;\\text{MPa} \\quad \\text{and} \\quad \\mathbf{n} = \\frac{1}{3} \\begin{pmatrix} 2 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\nWe calculate $\\mathbf{t} = \\boldsymbol{\\sigma} \\mathbf{n}$:\n$$\n\\mathbf{t} = \\frac{1}{3} \\begin{pmatrix} 80  30  -20 \\\\ 30  50  10 \\\\ -20  10  100 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\\\ 2 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 80(2) + 30(-1) - 20(2) \\\\ 30(2) + 50(-1) + 10(2) \\\\ -20(2) + 10(-1) + 100(2) \\end{pmatrix}\n$$\n$$\n\\mathbf{t} = \\frac{1}{3} \\begin{pmatrix} 160 - 30 - 40 \\\\ 60 - 50 + 20 \\\\ -40 - 10 + 200 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 90 \\\\ 30 \\\\ 150 \\end{pmatrix} = \\begin{pmatrix} 30 \\\\ 10 \\\\ 50 \\end{pmatrix} \\;\\text{MPa}\n$$\nSo, $\\mathbf{t} = 30\\mathbf{e}_1 + 10\\mathbf{e}_2 + 50\\mathbf{e}_3$ MPa.\n\nNext, we decompose $\\mathbf{t}$ into a normal component $\\mathbf{t}_n$ and a shear component $\\mathbf{t}_s$. The normal component is the projection of $\\mathbf{t}$ onto the direction of $\\mathbf{n}$. Its magnitude is the normal stress $\\sigma_n$.\n$$\n\\sigma_n = \\mathbf{t} \\cdot \\mathbf{n} = \\begin{pmatrix} 30 \\\\ 10 \\\\ 50 \\end{pmatrix} \\cdot \\left(\\frac{1}{3} \\begin{pmatrix} 2 \\\\ -1 \\\\ 2 \\end{pmatrix}\\right) = \\frac{1}{3} (30(2) + 10(-1) + 50(2)) = \\frac{1}{3} (60 - 10 + 100) = \\frac{150}{3} = 50 \\;\\text{MPa}\n$$\nThe normal traction vector is $\\mathbf{t}_n = \\sigma_n \\mathbf{n}$:\n$$\n\\mathbf{t}_n = 50 \\left(\\frac{1}{3} \\begin{pmatrix} 2 \\\\ -1 \\\\ 2 \\end{pmatrix}\\right) = \\frac{1}{3} \\begin{pmatrix} 100 \\\\ -50 \\\\ 100 \\end{pmatrix} \\;\\text{MPa}\n$$\nThe physical meaning of the sign of the normal component $\\sigma_n = +50$ MPa is that the stress is tensile. A positive sign indicates that the traction vector's normal component points in the same direction as the outward normal $\\mathbf{n}$, signifying that the material on opposite sides of the plane is being pulled apart.\n\nThe shear component $\\mathbf{t}_s$ is the component of $\\mathbf{t}$ tangent to the plane. It is given by $\\mathbf{t}_s = \\mathbf{t} - \\mathbf{t}_n$:\n$$\n\\mathbf{t}_s = \\begin{pmatrix} 30 \\\\ 10 \\\\ 50 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 100 \\\\ -50 \\\\ 100 \\end{pmatrix} = \\begin{pmatrix} 90/3 - 100/3 \\\\ 30/3 + 50/3 \\\\ 150/3 - 100/3 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -10 \\\\ 80 \\\\ 50 \\end{pmatrix} \\;\\text{MPa}\n$$\nFinally, we compute the magnitude of the shear traction, $\\|\\mathbf{t}_s\\|$:\n$$\n\\|\\mathbf{t}_s\\|^2 = (\\mathbf{t}_s \\cdot \\mathbf{t}_s) = \\left(\\frac{1}{3}\\right)^2 ((-10)^2 + 80^2 + 50^2) = \\frac{1}{9}(100 + 6400 + 2500) = \\frac{9000}{9} = 1000\n$$\n$$\n\\|\\mathbf{t}_s\\| = \\sqrt{1000} = \\sqrt{100 \\times 10} = 10\\sqrt{10} \\;\\text{MPa}\n$$\nAlternatively, using the orthogonal decomposition $\\mathbf{t} = \\mathbf{t}_n + \\mathbf{t}_s$, we have $\\|\\mathbf{t}\\|^2 = \\|\\mathbf{t}_n\\|^2 + \\|\\mathbf{t}_s\\|^2$.\n$$\n\\|\\mathbf{t}\\|^2 = 30^2 + 10^2 + 50^2 = 900 + 100 + 2500 = 3500\n$$\n$$\n\\|\\mathbf{t}_n\\|^2 = \\sigma_n^2 = 50^2 = 2500\n$$\n$$\n\\|\\mathbf{t}_s\\|^2 = \\|\\mathbf{t}\\|^2 - \\|\\mathbf{t}_n\\|^2 = 3500 - 2500 = 1000\n$$\n$$\n\\|\\mathbf{t}_s\\| = \\sqrt{1000} = 10\\sqrt{10}\n$$\nThe results are consistent. The magnitude of the shear traction is $10\\sqrt{10}$ MPa.", "answer": "$$\\boxed{10\\sqrt{10}}$$", "id": "2871778"}, {"introduction": "Conservation laws are not just theoretical constructs; they are the governing equations we solve to predict the behavior of real-world structures. The Finite Element Method (FEM) offers a powerful numerical technique for solving the momentum balance equation in its integral, or weak, form. This advanced coding exercise [@problem_id:2871735] bridges theory and computation, challenging you to implement the assembly of the residual vector—the discretized form of the momentum balance—which is the heart of a modern structural analysis solver.", "problem": "A two-dimensional, small-strain, quasi-static linear elastic body occupies the rectangular domain $\\Omega = [0,1] \\times [0,1]$ in meters with unit thickness $h = 1\\,\\mathrm{m}$. Let $\\boldsymbol{u} = (u_x,u_y)$ denote the displacement field. Starting from the local balance of linear momentum in the absence of inertia and the principle of virtual work, use a standard Galerkin Finite Element Method (FEM) discretization with bilinear quadrilateral elements to assemble the global residual vector associated with the weak form of linear momentum balance, including contributions from internal stresses, a prescribed volumetric body force, and a prescribed boundary traction. Adopt isotropic linear elasticity under plane strain.\n\nYour program must construct and assemble the global residual vector $\\boldsymbol{R}(\\boldsymbol{u})$ for the following fixed mesh and data, then evaluate it for the specified test suite. The residual vector must be ordered as $\\boldsymbol{R} = [R_{0x},R_{0y},R_{1x},R_{1y},\\dots,R_{5x},R_{5y}]$, where the subscript denotes the global node index and component $(x,y)$.\n\nMesh:\n- Nodes with coordinates in meters:\n  - Node $0$: $(x_0,y_0) = (0,0)$\n  - Node $1$: $(x_1,y_1) = (0.5,0)$\n  - Node $2$: $(x_2,y_2) = (1,0)$\n  - Node $3$: $(x_3,y_3) = (0,1)$\n  - Node $4$: $(x_4,y_4) = (0.5,1)$\n  - Node $5$: $(x_5,y_5) = (1,1)$\n- Elements (four-node bilinear quadrilateral, Q4) with local node order $\\{1,2,3,4\\}$ corresponding to global node indices as listed:\n  - Element $0$: $[0,1,4,3]$\n  - Element $1$: $[1,2,5,4]$\n- Neumann boundary $\\Gamma_t$: the right boundary at $x=1$, i.e., the edge connecting nodes $2$ and $5$.\n\nDiscretization requirements:\n- Use bilinear Q4 isoparametric interpolation for displacements with standard shape functions $\\{N_i(r,s)\\}$ on the parent square $(r,s) \\in [-1,1]^2$. The finite element fields must be integrated using tensor-product Gauss quadrature with $2\\times 2$ Gauss points for domain integrals and $2$-point Gauss quadrature for edge integrals. The element Jacobian-based mapping from $(r,s)$ to physical coordinates $(x,y)$ must be used for all integrals.\n- Kinematics: small-strain tensor $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\mathsf{T}\\right)$.\n- Constitutive law (plane strain): $\\boldsymbol{\\sigma} = \\mathsf{D}\\,\\boldsymbol{\\varepsilon}$ with Young’s modulus $E$ and Poisson’s ratio $\\nu$; use Lamé parameters $\\lambda = \\dfrac{\\nu E}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\dfrac{E}{2(1+\\nu)}$, and\n  $$\n  \\mathsf{D} = \n  \\begin{bmatrix}\n  \\lambda + 2\\mu  \\lambda  0\\\\\n  \\lambda  \\lambda + 2\\mu  0\\\\\n  0  0  \\mu\n  \\end{bmatrix}.\n  $$\n- Body force $\\boldsymbol{b}$ has units $\\mathrm{N/m^3}$ and traction $\\bar{\\boldsymbol{t}}$ has units $\\mathrm{N/m^2}$. The line integral over $\\Gamma_t$ must account for the unit thickness $h=1\\,\\mathrm{m}$.\n- Degrees of Freedom (DOF) ordering: for each global node $i$, the local DOF pair is $(u_{ix},u_{iy})$, and the global residual is ordered as $[0x,0y,1x,1y,\\dots,5x,5y]$.\n- No essential (Dirichlet) boundary conditions are to be applied; evaluate the residual for the provided nodal displacement vectors as-is.\n\nTest suite:\n- Your program must assemble $\\boldsymbol{R}(\\boldsymbol{u})$ for each of the following three test cases and output the three residual vectors.\n\nCase $\\mathbf{1}$ (general load with zero displacement):\n- Material: $E = 2.10\\times 10^{11}\\,\\mathrm{Pa}$, $\\nu = 0.3$.\n- Thickness: $h = 1\\,\\mathrm{m}$.\n- Nodal displacement: $\\boldsymbol{u}(\\text{nodes}) = \\boldsymbol{0}$ at all nodes.\n- Body force: $\\boldsymbol{b} = (0,\\,-\\rho g)$ with $\\rho = 7800\\,\\mathrm{kg/m^3}$ and $g = 9.81\\,\\mathrm{m/s^2}$; express $\\boldsymbol{b}$ in $\\mathrm{N/m^3}$.\n- Traction: uniform on $\\Gamma_t$ with $\\bar{\\boldsymbol{t}} = (1.0\\times 10^6,\\,0)\\,\\mathrm{N/m^2}$.\n\nCase $\\mathbf{2}$ (rigid body motion check):\n- Material: $E = 7.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.25$.\n- Thickness: $h = 1\\,\\mathrm{m}$.\n- Body force: $\\boldsymbol{b} = (0,\\,0)\\,\\mathrm{N/m^3}$.\n- Traction: $\\bar{\\boldsymbol{t}} = (0,\\,0)\\,\\mathrm{N/m^2}$.\n- Nodal displacement: impose a rigid translation plus small rigid rotation about the origin. Use translation $\\boldsymbol{t}_0 = (0.002,\\,-0.003)\\,\\mathrm{m}$ and rotation angle $\\omega = 0.1$ in radians. For a point $(x,y)$ in meters, define\n  $$\n  \\boldsymbol{u}(x,y) = \\boldsymbol{t}_0 + \\begin{bmatrix} -\\omega\\,y \\\\ \\omega\\,x \\end{bmatrix}.\n  $$\n  Evaluate this at each node to set the nodal DOFs.\n\nCase $\\mathbf{3}$ (uniform strain state):\n- Material: $E = 7.0\\times 10^{10}\\,\\mathrm{Pa}$, $\\nu = 0.33$.\n- Thickness: $h = 1\\,\\mathrm{m}$.\n- Body force: $\\boldsymbol{b} = (0,\\,0)\\,\\mathrm{N/m^3}$.\n- Traction: $\\bar{\\boldsymbol{t}} = (0,\\,0)\\,\\mathrm{N/m^2}$.\n- Nodal displacement: impose a linear displacement field corresponding to uniform normal strains without shear. For a point $(x,y)$ in meters, set\n  $$\n  \\boldsymbol{u}(x,y) = \\begin{bmatrix} \\alpha\\,x \\\\ \\beta\\,y \\end{bmatrix},\\quad \\alpha = 2.0\\times 10^{-4},\\ \\beta = -1.0\\times 10^{-4}.\n  $$\n  Evaluate this at each node to set the nodal DOFs.\n\nAngle unit requirement:\n- All angles are in radians.\n\nPhysical unit requirement:\n- Express the residual entries in Newtons $\\mathrm{N}$.\n\nFinal output format requirement:\n- Your program should produce a single line of output containing the three residual vectors as a comma-separated list enclosed in square brackets. Each residual vector must be printed as a Python-style list of floats ordered as specified above. For example (illustrative only): $[[r_{1,0},\\dots,r_{1,11}],[r_{2,0},\\dots,r_{2,11}],[r_{3,0},\\dots,r_{3,11}]]$.", "solution": "The problem statement poses a standard verification exercise in computational solid mechanics using the Finite Element Method (FEM). It requires the assembly of the global residual vector for a linear elastic body under several loading and displacement scenarios. The problem is scientifically grounded, well-posed for the task of residual evaluation, and provides all necessary data for a unique numerical solution. The physics, mathematics, and discretization procedures are consistent with established principles of continuum mechanics and FEM. The test cases are canonical checks for FEM implementations: a loaded structure with zero displacement, a rigid body motion test, and a uniform strain (patch) test. The problem is therefore deemed valid.\n\nThe solution proceeds by implementing the Galerkin FEM for two-dimensional, plane strain, linear elasticity. The global residual vector $\\boldsymbol{R}$ is defined as the difference between the internal force vector $\\boldsymbol{F}_{\\text{int}}$ and the external force vector $\\boldsymbol{F}_{\\text{ext}}$:\n$$ \\boldsymbol{R} = \\boldsymbol{F}_{\\text{int}} - \\boldsymbol{F}_{\\text{ext}} $$\nFor a system to be in equilibrium, $\\boldsymbol{R}$ must be zero. The evaluation of $\\boldsymbol{R}$ for a given (non-equilibrium) displacement state $\\boldsymbol{u}$ reveals the nodal forces required to restore equilibrium.\n\nThe weak form of the equilibrium equation, derived from the principle of virtual work, leads to the definitions of the force vectors. For any admissible virtual displacement $\\delta\\boldsymbol{u}$ with corresponding virtual strain $\\delta\\boldsymbol{\\varepsilon}$, we have:\n$$ \\delta\\boldsymbol{d}^T \\boldsymbol{R} = \\int_{\\Omega} \\delta\\boldsymbol{\\varepsilon}^T \\boldsymbol{\\sigma} \\, dV - \\left( \\int_{\\Omega} \\delta\\boldsymbol{u}^T \\boldsymbol{b} \\, dV + \\int_{\\Gamma_t} \\delta\\boldsymbol{u}^T \\bar{\\boldsymbol{t}} \\, dA_t \\right) = 0 $$\nwhere $\\boldsymbol{d}$ are the nodal displacements, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{b}$ is the body force per unit volume, $\\bar{\\boldsymbol{t}}$ is the prescribed traction on the boundary $\\Gamma_t$, $dV$ is the differential volume element, and $dA_t$ is the differential area element on the traction boundary. For a 2D problem of unit thickness $h=1\\,\\mathrm{m}$, $dV = h\\,dA$ and $dA_t = h\\,dS$, where $dA$ and $dS$ are area and line elements in the 2D plane respectively.\n\nDiscretizing the domain $\\Omega$ into finite elements, the global residual vector $\\boldsymbol{R}$ is assembled from element-level contributions $\\boldsymbol{r}^e$:\n$$ \\boldsymbol{R} = \\sum_{e} \\boldsymbol{A}_e^T \\boldsymbol{r}^e $$\nwhere $\\boldsymbol{A}_e$ is the assembly operator for element $e$. The element residual vector $\\boldsymbol{r}^e$ is computed by integrating over the element domain $\\Omega_e$ and its boundary $\\Gamma_t^e$:\n$$ \\boldsymbol{r}^e = \\int_{\\Omega_e} h \\mathbf{B}^T \\boldsymbol{\\sigma} \\, dA - \\left( \\int_{\\Omega_e} h \\mathbf{N}^T \\boldsymbol{b} \\, dA + \\int_{\\Gamma_t^e} h \\mathbf{N}^T \\bar{\\boldsymbol{t}} \\, dS \\right) $$\nHere, $\\mathbf{N}$ is the matrix of shape functions interpolating the displacement field, $\\boldsymbol{u}^h = \\mathbf{N} \\boldsymbol{d}^e$, and $\\mathbf{B}$ is the kinematic matrix relating nodal displacements to strain, $\\boldsymbol{\\varepsilon}^h = \\mathbf{B} \\boldsymbol{d}^e$. The stress is given by the linear elastic constitutive law for plane strain, $\\boldsymbol{\\sigma} = \\mathsf{D} \\boldsymbol{\\varepsilon}^h$, using the provided material matrix $\\mathsf{D}$.\n\nThe problem specifies isoparametric bilinear quadrilateral (Q4) elements. The integrals are evaluated numerically using Gaussian quadrature. A $2 \\times 2$ rule is used for area integrals over the element's parent domain $[-1,1]^2$, and a $2$-point rule is used for line integrals over the parent edge $[-1,1]$.\n\nThe implementation proceeds as follows for each test case:\n1.  **Initialization**: Set material parameters ($E, \\nu$), compute Lamé parameters ($\\lambda, \\mu$), and construct the elasticity matrix $\\mathsf{D}$. Define the body force $\\boldsymbol{b}$ and traction $\\bar{\\boldsymbol{t}}$. Define the mesh geometry and connectivity.\n2.  **Displacement Field**: For the given test case, compute the prescribed displacement vector for all degrees of freedom (DOFs) of the mesh.\n3.  **Assembly**: Initialize the global residual vector $\\boldsymbol{R}$ to zero. Iterate through each element of the mesh:\n    a.  **Internal Forces**: Loop over the $2 \\times 2$ Gauss quadrature points. At each point, compute the Jacobian of the mapping from parent to physical coordinates, the B-matrix, the strain from the element's nodal displacements, and the resulting stress. The contribution to the element internal force vector is calculated and added to the element's residual.\n    b.  **Body Forces**: If applicable, at each Gauss point, compute the contribution to the element external force vector from body forces. This is subtracted from the element's residual.\n    c.  **Traction Forces**: If the element has an edge on the traction boundary $\\Gamma_t$, loop over the $2$ Gauss points along that edge. Compute the contribution to the element external force vector and subtract it from the element's residual.\n    d.  **Scatter-Add**: Add the computed element residual vector into the corresponding positions in the global residual vector $\\boldsymbol{R}$.\n4.  **Output**: Store the final vector $\\boldsymbol{R}$ for the test case. After processing all cases, format the results as required.\n\nThe implementation is structured into functions for clarity: calculating shape functions and their derivatives, computing the B-matrix, and the main routine that orchestrates the assembly for each case. The results for the three specified cases are calculated and presented in the required format.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FEM residual assembly problem for three test cases.\n    \"\"\"\n    \n    # ------------------ Discretization Setup ------------------\n\n    # Mesh data\n    nodes = np.array([\n        [0.0, 0.0], [0.5, 0.0], [1.0, 0.0], # Nodes 0, 1, 2\n        [0.0, 1.0], [0.5, 1.0], [1.0, 1.0]  # Nodes 3, 4, 5\n    ])\n    elements = np.array([\n        [0, 1, 4, 3],  # Element 0\n        [1, 2, 5, 4]   # Element 1\n    ], dtype=int)\n    \n    h = 1.0  # Thickness in meters\n\n    # Gauss quadrature points and weights\n    gauss_points_1d = np.array([-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)])\n    gauss_weights_1d = np.array([1.0, 1.0])\n    \n    gauss_points_2d = np.array([\n        (gauss_points_1d[0], gauss_points_1d[0]),\n        (gauss_points_1d[1], gauss_points_1d[0]),\n        (gauss_points_1d[0], gauss_points_1d[1]),\n        (gauss_points_1d[1], gauss_points_1d[1])\n    ])\n    gauss_weights_2d = np.array([\n        gauss_weights_1d[0] * gauss_weights_1d[0],\n        gauss_weights_1d[1] * gauss_weights_1d[0],\n        gauss_weights_1d[0] * gauss_weights_1d[1],\n        gauss_weights_1d[1] * gauss_weights_1d[1]\n    ])\n\n    # ------------------ FEM Helper Functions ------------------\n\n    def get_shape_functions(r, s):\n        N = np.zeros(4)\n        N[0] = 0.25 * (1.0 - r) * (1.0 - s)\n        N[1] = 0.25 * (1.0 + r) * (1.0 - s)\n        N[2] = 0.25 * (1.0 + r) * (1.0 + s)\n        N[3] = 0.25 * (1.0 - r) * (1.0 + s)\n        return N\n\n    def get_shape_function_derivatives_parent(r, s):\n        grad_N_parent = np.zeros((4, 2))\n        grad_N_parent[0, :] = [-0.25 * (1.0 - s), -0.25 * (1.0 - r)]\n        grad_N_parent[1, :] = [ 0.25 * (1.0 - s), -0.25 * (1.0 + r)]\n        grad_N_parent[2, :] = [ 0.25 * (1.0 + s),  0.25 * (1.0 + r)]\n        grad_N_parent[3, :] = [-0.25 * (1.0 + s),  0.25 * (1.0 - r)]\n        return grad_N_parent\n\n    def get_B_matrix(grad_N_phys):\n        B = np.zeros((3, 8))\n        for i in range(4):\n            B[0, 2 * i] = grad_N_phys[i, 0]\n            B[1, 2 * i + 1] = grad_N_phys[i, 1]\n            B[2, 2 * i] = grad_N_phys[i, 1]\n            B[2, 2 * i + 1] = grad_N_phys[i, 0]\n        return B\n        \n    def get_N_matrix(N):\n        N_mat = np.zeros((2, 8))\n        for i in range(4):\n            N_mat[0, 2*i] = N[i]\n            N_mat[1, 2*i+1] = N[i]\n        return N_mat\n\n    # ------------------ Test Cases Setup ------------------\n\n    test_cases = [\n        {\n            \"E\": 2.10e11, \"nu\": 0.3, \"h\": 1.0,\n            \"b\": np.array([0, -7800 * 9.81]),\n            \"traction_element\": 1, \"traction_edge_local_nodes\": [1, 2],\n            \"traction\": np.array([1.0e6, 0]),\n            \"u_func\": lambda x, y: (0.0, 0.0)\n        },\n        {\n            \"E\": 7.0e10, \"nu\": 0.25, \"h\": 1.0,\n            \"b\": np.array([0, 0]),\n            \"traction_element\": -1, # No traction\n            \"u_func\": lambda x, y: (0.002 - 0.1 * y, -0.003 + 0.1 * x)\n        },\n        {\n            \"E\": 7.0e10, \"nu\": 0.33, \"h\": 1.0,\n            \"b\": np.array([0, 0]),\n            \"traction_element\": -1, # No traction\n            \"u_func\": lambda x, y: (2.0e-4 * x, -1.0e-4 * y)\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Material properties\n        E, nu = case[\"E\"], case[\"nu\"]\n        lame_lambda = (nu * E) / ((1 + nu) * (1 - 2 * nu))\n        lame_mu = E / (2 * (1 + nu))\n        D_matrix = np.array([\n            [lame_lambda + 2 * lame_mu, lame_lambda, 0],\n            [lame_lambda, lame_lambda + 2 * lame_mu, 0],\n            [0, 0, lame_mu]\n        ])\n\n        # Body forces\n        b_vec = case[\"b\"]\n        \n        # Displacements\n        u_global = np.zeros(nodes.shape[0] * 2)\n        u_func = case[\"u_func\"]\n        for i in range(nodes.shape[0]):\n            u_global[2*i:2*i+2] = u_func(nodes[i, 0], nodes[i, 1])\n\n        # Assembly\n        R_global = np.zeros_like(u_global)\n\n        for e_idx, conn in enumerate(elements):\n            coords_e = nodes[conn]\n            d_e = u_global[np.repeat(conn * 2, 2) + np.tile([0, 1], 4)]\n            r_e = np.zeros(8)\n            \n            # Volume integrals for internal and body forces\n            for i in range(len(gauss_points_2d)):\n                r, s = gauss_points_2d[i]\n                w = gauss_weights_2d[i]\n                \n                grad_N_parent = get_shape_function_derivatives_parent(r, s)\n                J_matrix = grad_N_parent.T @ coords_e\n                detJ = np.linalg.det(J_matrix)\n                invJ = np.linalg.inv(J_matrix)\n                \n                grad_N_phys = grad_N_parent @ invJ.T\n                \n                B_matrix = get_B_matrix(grad_N_phys)\n                strain = B_matrix @ d_e\n                stress = D_matrix @ strain\n\n                r_e += B_matrix.T @ stress * detJ * w * h\n\n                if np.any(b_vec):\n                    N_vec = get_shape_functions(r, s)\n                    N_matrix = get_N_matrix(N_vec)\n                    r_e -= N_matrix.T @ b_vec * detJ * w * h\n            \n            # Surface integral for traction forces\n            if e_idx == case.get(\"traction_element\", -1):\n                t_bar = case[\"traction\"]\n                # Edge between local nodes 1 and 2 (r=1) of element 1\n                for i in range(len(gauss_points_1d)):\n                    s = gauss_points_1d[i]\n                    w = gauss_weights_1d[i]\n                    \n                    r = 1.0\n                    N_vec = get_shape_functions(r, s)\n                    # Use only shape functions corresponding to edge nodes 1 and 2\n                    N_on_edge = np.zeros(4)\n                    N_on_edge[1] = 0.5 * (1 - s) # local node 2 in problem desc is conn[1]\n                    N_on_edge[2] = 0.5 * (1 + s) # local node 3 in problem desc is conn[2] (e.g. node 5)\n                    N_matrix = get_N_matrix(N_on_edge)\n\n                    # Jacobian for straight line element on y-axis\n                    detJ_line = 0.5 * 1.0 # 0.5 * edge_length\n\n                    r_e -= N_matrix.T @ t_bar * detJ_line * w * h\n            \n            # Assemble element residual into global vector\n            for i in range(4):\n                node_idx = conn[i]\n                R_global[2*node_idx : 2*node_idx+2] += r_e[2*i : 2*i+2]\n        \n        all_results.append(R_global.tolist())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "2871735"}]}