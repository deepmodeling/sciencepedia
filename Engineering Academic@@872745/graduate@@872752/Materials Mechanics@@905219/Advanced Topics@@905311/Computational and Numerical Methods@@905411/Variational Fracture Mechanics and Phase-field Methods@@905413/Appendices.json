{"hands_on_practices": [{"introduction": "This practice serves as a foundational exercise in the calculus of variations as applied to fracture mechanics. By deriving the one-dimensional stationary crack profile from the Ambrosio–Tortorelli energy functional, you will gain direct insight into how a diffuse, regularized representation of a crack emerges from minimizing a specific energy form [@problem_id:2929068]. This exercise is crucial for understanding the mathematical structure of phase-field models and verifying the core concept of $\\Gamma$-convergence, where the regularized energy correctly approximates that of a sharp crack.", "problem": "Consider a one-dimensional stationary phase-field representation of a single, sharp crack located at the origin in an infinite elastic body under vanishing elastic driving. Let the crack phase-field be denoted by $d(x)$, where $x \\in \\mathbb{R}$, with $d(x) \\in [0,1]$, $d(x)=1$ indicating fully broken and $d(x)=0$ indicating intact material. The regularized crack surface density in the so-called Ambrosio–Tortorelli (AT2) model is taken, in normalized form, as the functional\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\nwhere $\\ell0$ is the internal length scale parameter that controls the width of the diffused crack zone. Assume the physically motivated boundary conditions $d(0)=1$ (crack peak at the origin) and $\\lim_{x\\to\\infty} d(x)=0$ (intact far field). The total crack surface measure corresponding to the two faces of the crack is modeled by $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$.\n\nUsing only first principles of the calculus of variations (Euler–Lagrange equation and admissible boundary conditions), perform the following:\n\n- Derive the stationarity condition for $d(x)$ associated with $\\Gamma_{\\ell}^{+}[d]$ on $x\\in(0,\\infty)$ and solve the resulting ordinary differential equation subject to $d(0)=1$ and $\\lim_{x\\to\\infty} d(x)=0$.\n- Evaluate the exact value of\n$$\nS_\\ell[d^{\\star}] \\;=\\; 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] \\;=\\; 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d^{\\star}(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x,\n$$\nwhere $d^{\\star}$ denotes the stationary (minimizing) profile you obtained.\n\nExpress the final answer as a single exact number. No rounding is required. The quantity $S_\\ell[d^{\\star}]$ is dimensionless by construction, so no units are needed.", "solution": "The problem statement is first subjected to validation.\n\n**Step 1: Extract Givens**\n- The functional for the regularized crack surface density for $x0$ is given by:\n$$\n\\Gamma_{\\ell}^{+}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,d(x)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\n- The phase-field variable is $d(x)$, where $d(x) \\in [0,1]$.\n- The internal length scale is $\\ell  0$.\n- The domain of integration is $x \\in [0, \\infty)$.\n- The boundary conditions are $d(0)=1$ and $\\lim_{x\\to\\infty} d(x)=0$.\n- The total crack surface measure is $S_\\ell[d] \\coloneqq 2\\,\\Gamma_{\\ell}^{+}[d]$.\n- The objective is to find the stationary profile $d^{\\star}(x)$ and evaluate $S_\\ell[d^{\\star}]$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses the Ambrosio–Tortorelli (AT2) model, a fundamental and widely accepted framework in the phase-field theory of fracture. It is a standard regularization of a sharp-interface crack problem. The functional is mathematically and physically sound.\n- **Well-Posed:** The problem is well-posed. It is a classic problem in the calculus of variations: minimizing a convex functional subject to well-defined boundary conditions. Such problems typically admit a unique and stable solution.\n- **Objective:** The problem is stated using precise mathematical language, with all terms explicitly defined.\n- **Verdict:** The problem is scientifically valid, well-posed, objective, and complete. It is a standard exercise in variational mechanics and contains no flaws.\n\n**Step 3: Proceed to Solution**\nThe problem requires finding the stationary path $d^{\\star}(x)$ that minimizes the functional $\\Gamma_{\\ell}^{+}[d]$ and then evaluating the total crack surface measure $S_\\ell[d^{\\star}]$. This is accomplished by using the Euler–Lagrange equation.\n\nThe integrand of the functional is\n$$\nL(d, d') = \\frac{1}{2\\,\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}\n$$\nwhere $d' \\equiv \\frac{\\mathrm{d}d}{\\mathrm{d}x}$. The Euler–Lagrange equation, which provides the stationarity condition, is\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0\n$$\nWe compute the necessary partial derivatives of $L$:\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{1}{2\\,\\ell}\\,(2d) = \\frac{d}{\\ell}\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{\\ell}{2}\\,(2d') = \\ell\\,d'\n$$\nSubstituting these expressions into the Euler–Lagrange equation gives:\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\ell\\,d'\\right) = 0\n$$\n$$\n\\frac{d}{\\ell} - \\ell\\,d'' = 0\n$$\nRearranging this yields a second-order linear homogeneous ordinary differential equation with constant coefficients:\n$$\nd'' - \\frac{1}{\\ell^2}\\,d = 0\n$$\nThe characteristic equation for this ODE is $r^2 - \\frac{1}{\\ell^2} = 0$. The roots are $r_{1,2} = \\pm\\frac{1}{\\ell}$. The general solution is therefore\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nwhere $C_1$ and $C_2$ are constants to be determined from the boundary conditions.\n\nThe first boundary condition is $\\lim_{x\\to\\infty} d(x) = 0$. As $x \\to \\infty$, the term $\\exp\\left(\\frac{x}{\\ell}\\right)$ grows without bound. For the limit of $d(x)$ to be zero, its coefficient must be zero. Thus, we must have $C_1 = 0$. The solution simplifies to\n$$\nd(x) = C_2 \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nThe second boundary condition is $d(0)=1$. Applying this condition gives:\n$$\nd(0) = C_2 \\exp(0) = C_2 \\cdot 1 = C_2\n$$\nTherefore, $C_2 = 1$. The unique stationary profile $d^{\\star}(x)$ that satisfies the boundary conditions is\n$$\nd^{\\star}(x) = \\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nNow, we must evaluate the total crack surface measure $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = 2\\,\\Gamma_{\\ell}^{+}[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,(d^{\\star}(x))^{2} + \\frac{\\ell}{2}\\,\\big(d^{\\star}{}'(x)\\big)^{2} \\right)\\,\\mathrm{d}x\n$$\nWe need the terms $(d^{\\star}(x))^2$ and $(d^{\\star}{}'(x))^2$. First, we compute the derivative $d^{\\star}{}'(x)$:\n$$\nd^{\\star}{}'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = -\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\n$$\nNow we square both $d^{\\star}(x)$ and $d^{\\star}{}'(x)$:\n$$\n(d^{\\star}(x))^2 = \\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\n$$\n(d^{\\star}{}'(x))^2 = \\left(-\\frac{1}{\\ell}\\exp\\left(-\\frac{x}{\\ell}\\right)\\right)^2 = \\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\n$$\nSubstitute these into the integral for $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{\\ell}{2}\\,\\frac{1}{\\ell^2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\nSimplify the integrand:\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) + \\frac{1}{2\\,\\ell}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right)\\,\\mathrm{d}x\n$$\n$$\nS_\\ell[d^{\\star}] = 2 \\int_{0}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\nWe can move the constant factor $\\frac{2}{\\ell}$ outside the integral:\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x\n$$\nNow we evaluate the definite integral:\n$$\n\\int_{0}^{\\infty} \\exp\\left(-\\frac{2x}{\\ell}\\right) \\,\\mathrm{d}x = \\left[ -\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right) \\right]_{0}^{\\infty}\n$$\n$$\n= \\lim_{x\\to\\infty}\\left(-\\frac{\\ell}{2}\\exp\\left(-\\frac{2x}{\\ell}\\right)\\right) - \\left(-\\frac{\\ell}{2}\\exp(0)\\right)\n$$\n$$\n= 0 - \\left(-\\frac{\\ell}{2}\\right) = \\frac{\\ell}{2}\n$$\nFinally, substitute this result back into the expression for $S_\\ell[d^{\\star}]$:\n$$\nS_\\ell[d^{\\star}] = \\frac{2}{\\ell} \\cdot \\left(\\frac{\\ell}{2}\\right) = 1\n$$\nThe value of the regularized surface energy for the optimal profile is exactly $1$, which is independent of the length scale parameter $\\ell$. This is a fundamental result demonstrating that the Ambrosio–Tortorelli functional correctly approximates the surface energy of a sharp crack, which is normalized to $1$ in this problem setup (corresponding to a single crack face of unit energy). The total measure $S_\\ell[d^\\star]$ accounts for two faces, but the integral was taken over $x \\in (0,\\infty)$, representing one side of a symmetric crack. The formulation $S_\\ell[d] = 2\\,\\Gamma_{\\ell}^{+}[d]$ correctly captures the energy of one half-crack of surface $1$. Had the integral been over $(-\\infty, \\infty)$ with $d(x)=\\exp(-|x|/\\ell)$, the result for the full crack would be $2$. The question as posed results in $1$. Wait, let me re-read the setup. $S_\\ell[d] = 2\\,\\Gamma_{\\ell}^{+}[d]$ models the *two* faces. $\\Gamma_{\\ell}^{+}[d]$ is on the half-domain. So the calculation represents the total energy.\nSo, $\\Gamma_{\\ell}^{+}[d^{\\star}] = \\frac{1}{2}$. Then $S_\\ell[d^{\\star}] = 2 \\times \\frac{1}{2} = 1$. The calculation is correct. My interpretation is correct. The result is $1$.", "answer": "$$\\boxed{1}$$", "id": "2929068"}, {"introduction": "Moving from the structure of a crack to the conditions for its formation, this exercise connects the abstract energy functional to a tangible engineering property: the material's tensile strength. You will analyze the stability of an undamaged material state to determine the critical stress at which damage initiates, a process known as bifurcation analysis [@problem_id:2929086]. This practice demonstrates how phase-field models intrinsically capture nucleation criteria, providing a powerful tool for predicting failure initiation without ad-hoc assumptions.", "problem": "Consider a one-dimensional slender bar of length $L$ and unit cross-sectional area made of a linear elastic brittle material, loaded in uniform tension so that the axial Green-Lagrange strain can be identified with the engineering strain $ \\varepsilon $ in the small-strain limit. The elastic energy density is $ \\psi_{e}(\\varepsilon) = \\tfrac{1}{2} E \\varepsilon^{2} $, where $E$ is Young’s modulus. The material is modeled by a variational phase-field formulation of brittle fracture of the Ambrosio–Tortorelli type (AT1), with damage variable $ d \\in [0,1] $, degradation function $ g(d) = (1-d)^{2} $, and crack surface density functional characterized by the Griffith critical energy release rate $ G_{c} $ and the regularization length $ \\ell $. The total energy per unit cross-sectional area is\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x.\n$$\nAssume $ L \\gg \\ell $ so that boundary layers are negligible and analyze homogeneous perturbations of the undamaged state. Using first principles of variational stability under the unilateral damage irreversibility constraint $ d \\ge 0 $, determine the explicit expression for the critical axial Cauchy stress $ \\sigma_{c} $ at which the undamaged state $ d=0 $ loses local minimality to an infinitesimal homogeneous damage perturbation. For one-dimensional small-strain elasticity, you may use $ \\sigma = E \\varepsilon $.\n\nThen, evaluate $ \\sigma_{c} $ numerically for $ E = 50\\ \\mathrm{GPa} $, $ G_{c} = 2.4\\ \\mathrm{kJ/m^{2}} $, and $ \\ell = 0.30\\ \\mathrm{mm} $. Express your final stress in $ \\mathrm{MPa} $ and round your answer to four significant figures.", "solution": "The problem requires the determination of the critical stress for the initiation of damage in a one-dimensional bar, modeled using a phase-field approach to brittle fracture. The analysis is to be performed under the assumption of homogeneous damage perturbations.\n\nThe total energy of the system per unit cross-sectional area is given by the functional:\n$$\n\\Psi[d;\\varepsilon] \\,=\\, \\int_{0}^{L} \\left[ g(d)\\,\\psi_{e}(\\varepsilon) \\;+\\; G_{c}\\left( \\frac{d}{\\ell} \\;+\\; \\frac{\\ell}{2}\\,(d')^{2} \\right) \\right] \\,\\mathrm{d}x\n$$\nThe provided constitutive laws are the elastic energy density $\\psi_{e}(\\varepsilon) = \\frac{1}{2} E \\varepsilon^{2}$ and the degradation function $g(d) = (1-d)^{2}$. The problem specifies an analysis of homogeneous perturbations of the undamaged state, $d=0$. A homogeneous field $d(x)$ is spatially constant, i.e., $d(x) = \\delta$ for some constant $\\delta$. Consequently, the derivative term vanishes, $d'(x) = 0$.\n\nUnder this simplification, the integrand becomes constant along the length $L$ of the bar. We can define an effective energy density $\\Phi$ (energy per unit volume) for a state of homogeneous strain $\\varepsilon$ and homogeneous damage $\\delta$:\n$$\n\\Phi(\\delta; \\varepsilon) = g(\\delta)\\psi_e(\\varepsilon) + G_c \\frac{\\delta}{\\ell}\n$$\nSubstituting the given forms for $g(d)$ and $\\psi_e(\\varepsilon)$ yields:\n$$\n\\Phi(\\delta; \\varepsilon) = (1-\\delta)^{2} \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + G_c \\frac{\\delta}{\\ell}\n$$\nThe undamaged state corresponds to $\\delta=0$. We must investigate the stability of this state. In the calculus of variations, a state is a local minimum if the energy increases for any admissible infinitesimal perturbation. Here, the damage variable is subject to the unilateral irreversibility constraint $d \\ge 0$, which for our homogeneous analysis means $\\delta \\ge 0$.\n\nFor the state $\\delta=0$ to be a local minimum, the first variation of the energy with respect to an admissible perturbation must be non-negative. Admissible perturbations are of the form $\\delta  0$. This requires the directional derivative of $\\Phi$ with respect to $\\delta$ at $\\delta=0$ to be non-negative. We compute the first derivative of $\\Phi$ with respect to $\\delta$:\n$$\n\\frac{\\partial \\Phi}{\\partial \\delta} = -2(1-\\delta) \\left(\\frac{1}{2} E \\varepsilon^{2}\\right) + \\frac{G_c}{\\ell} = -2(1-\\delta)\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell}\n$$\nEvaluating this at the undamaged state, $\\delta=0$:\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} = -2\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell}\n$$\nThe condition for local stability of the state $\\delta=0$ is therefore:\n$$\n\\left. \\frac{\\partial \\Phi}{\\partial \\delta} \\right|_{\\delta=0} \\ge 0 \\quad \\implies \\quad -2\\psi_e(\\varepsilon) + \\frac{G_c}{\\ell} \\ge 0\n$$\nThis simplifies to:\n$$\n\\psi_e(\\varepsilon) \\le \\frac{G_c}{2\\ell}\n$$\nThe undamaged state $d=0$ loses its local minimality when this condition is first violated. The critical point is therefore defined by the equality, which represents the threshold at which the driving force for damage exactly balances the resistance.\n$$\n\\psi_{e,c} = \\frac{G_c}{2\\ell}\n$$\nwhere $\\psi_{e,c}$ is the critical elastic energy density stored in the material at the onset of damage.\n\nTo find the critical stress $\\sigma_c$, we relate the elastic energy density $\\psi_e$ to the Cauchy stress $\\sigma$. For one-dimensional linear elasticity, $\\sigma = E\\varepsilon$, which implies $\\varepsilon = \\sigma/E$. Substituting this into the expression for $\\psi_e$:\n$$\n\\psi_e(\\sigma) = \\frac{1}{2}E \\left(\\frac{\\sigma}{E}\\right)^2 = \\frac{\\sigma^2}{2E}\n$$\nAt the critical condition, we have $\\psi_e(\\sigma_c) = \\psi_{e,c}$:\n$$\n\\frac{\\sigma_c^2}{2E} = \\frac{G_c}{2\\ell}\n$$\nSolving for the critical stress $\\sigma_c$ gives the analytical expression:\n$$\n\\sigma_c^2 = \\frac{E G_c}{\\ell} \\quad \\implies \\quad \\sigma_c = \\sqrt{\\frac{E G_c}{\\ell}}\n$$\nThis is the required explicit expression for the critical stress.\n\nNow, we evaluate this expression numerically with the provided data. The parameters must first be converted to base SI units.\nYoung's modulus: $E = 50\\ \\mathrm{GPa} = 50 \\times 10^9\\ \\mathrm{Pa}$.\nGriffith critical energy release rate: $G_c = 2.4\\ \\mathrm{kJ/m^2} = 2.4 \\times 10^3\\ \\mathrm{J/m^2}$.\nRegularization length: $\\ell = 0.30\\ \\mathrm{mm} = 0.30 \\times 10^{-3}\\ \\mathrm{m}$.\n\nSubstituting these values into the expression for $\\sigma_c$:\n$$\n\\sigma_c = \\sqrt{\\frac{(50 \\times 10^9\\ \\mathrm{Pa}) \\cdot (2.4 \\times 10^3\\ \\mathrm{J/m^2})}{0.30 \\times 10^{-3}\\ \\mathrm{m}}}\n$$\nThe units are consistent, as $(\\mathrm{Pa} \\cdot \\mathrm{J/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N\\cdot m/m^2}) / \\mathrm{m} = (\\mathrm{N/m^2} \\cdot \\mathrm{N/m}) / \\mathrm{m} = \\mathrm{N^2/m^4} = \\mathrm{Pa^2}$.\n$$\n\\sigma_c = \\sqrt{\\frac{120 \\times 10^{12}}{0.30 \\times 10^{-3}}} \\ \\mathrm{Pa} = \\sqrt{400 \\times 10^{15}}\\ \\mathrm{Pa} = \\sqrt{4 \\times 10^{17}}\\ \\mathrm{Pa}\n$$\n$$\n\\sigma_c = 2 \\sqrt{10^{17}}\\ \\mathrm{Pa} = 2 \\sqrt{10 \\times 10^{16}}\\ \\mathrm{Pa} = 2 \\sqrt{10} \\times 10^8\\ \\mathrm{Pa}\n$$\nUsing the value $\\sqrt{10} \\approx 3.16227766$:\n$$\n\\sigma_c \\approx 2 \\times 3.16227766 \\times 10^8\\ \\mathrm{Pa} \\approx 6.32455532 \\times 10^8\\ \\mathrm{Pa}\n$$\nThe problem requires the answer in Megapascals ($\\mathrm{MPa}$), where $1\\ \\mathrm{MPa} = 10^6\\ \\mathrm{Pa}$.\n$$\n\\sigma_c \\approx 632.455532\\ \\mathrm{MPa}\n$$\nRounding to four significant figures, we obtain:\n$$\n\\sigma_c = 632.5\\ \\mathrm{MPa}\n$$", "answer": "$$\n\\boxed{632.5}\n$$", "id": "2929086"}, {"introduction": "Real-world applications of phase-field models rely on robust numerical methods, as analytical solutions are rarely available for complex geometries and loadings. This advanced practice guides you through developing a finite element solver for the governing phase-field differential equation, including the implementation of an adaptive mesh refinement (AMR) strategy [@problem_id:2929128]. Mastering this problem will equip you with the skills to efficiently resolve the sharp gradients inherent to phase-field solutions, a critical capability for accurate and computationally tractable simulations.", "problem": "Consider a one-dimensional, nondimensionalized phase-field fracture model posed on a closed interval $\\left[0,L\\right]$ with a scalar phase-field $d:\\left[0,L\\right]\\to\\left[0,1\\right]$. The model is derived from the variational formulation in which $d$ minimizes the functional\n$$\n\\mathcal{E}[d] \\;=\\; \\int_{0}^{L} \\left( \\frac{l}{2}\\,\\left(\\frac{dd}{dx}\\right)^{2} \\;+\\; \\frac{1}{2\\,l}\\,d^{2} \\;+\\; h(x)\\,\\left(1-d\\right)^{2} \\right)\\,d x,\n$$\nwhere $l0$ is a regularization length scale and $h(x)\\ge 0$ is a prescribed nondimensional history field that encodes the tensile elastic energy contribution. Assume natural (homogeneous Neumann) boundary conditions at $x=0$ and $x=L$.\n\nYour tasks are:\n- Starting from the fundamental definition of stationarity of $\\mathcal{E}[d]$ with respect to all smooth test variations, derive the Euler–Lagrange equation and its weak form. Do not assume any closed-form solution for $d$; instead, rely solely on the calculus of variations and properties of integrals, including integration by parts, to arrive at the weak form that is suitable for numerical approximation.\n- Design a Galerkin Finite Element Method (FEM) with continuous, piecewise-linear basis functions over a partition of $\\left[0,L\\right]$ into subintervals, and assemble the corresponding linear system for the weak form you derived. You must use quadrature to integrate spatially varying coefficients.\n- Construct a residual-based a posteriori error indicator suitable for a linear reaction–diffusion type Partial Differential Equation (PDE) of the form\n$$\n-\\,\\alpha\\,\\frac{d^{2} d}{d\\,x^{2}} \\;+\\; \\beta(x)\\,d \\;=\\; f(x),\n$$\nwhere $\\alpha0$, $\\beta(x)\\ge 0$, and $f(x)$ are induced by your weak form. Use a standard elementwise $L^{2}$-residual indicator of the form\n$$\n\\eta_{e} \\;=\\; h_{e}\\,\\left\\|\\, f(x) \\,-\\, \\beta(x)\\,d_{h}(x) \\,\\right\\|_{L^{2}(e)},\n$$\nwhere $h_{e}$ is the element length and $d_{h}$ is the piecewise-linear FEM solution. Use Gaussian quadrature to evaluate the norms. You may ignore inter-element flux jump terms for this assignment, but you must clearly motivate why the in-element residual alone is consistent for continuous, piecewise-linear approximations on a one-dimensional mesh.\n- Implement Adaptive Mesh Refinement (AMR), defined here as the loop: solve $\\rightarrow$ estimate $\\rightarrow$ mark $\\rightarrow$ refine, with Dörfler (bulk) marking. Use a marking parameter $\\theta\\in\\left(0,1\\right)$ and select the minimal subset of elements whose sum of squared indicators reaches at least a fraction $\\theta$ of the global sum of squared indicators. Refine marked elements by bisection. Stop when the global estimator falls below a tolerance or when a maximum number of elements is reached.\n- Compute the discrete energy $\\mathcal{E}[d_{h}]$ using the same quadrature rule employed in assembly and report it as the scalar output for each test case below.\n\nDiscretization and algorithmic specifications:\n- Use continuous, piecewise-linear basis functions on an initially uniform mesh with $N_{0}$ elements on $\\left[0,L\\right]$.\n- Use Gaussian quadrature with $2$ points per element for all elementwise integrals with spatially varying coefficients.\n- Use Dörfler marking with parameter $\\theta$.\n- Refine by element bisection (in one spatial dimension), ensuring that the mesh remains conforming.\n- Terminate AMR when the global error estimator first satisfies $\\eta \\le \\text{tol}$, where $\\eta := \\left(\\sum_{e}\\eta_{e}^{2}\\right)^{1/2}$, or when the mesh reaches a maximum number of elements $N_{\\max}$, whichever occurs first.\n\nTest suite:\n- Common parameters for all test cases:\n  - Domain length $L = 1$.\n  - Initial number of elements $N_{0} = 20$.\n  - Marking parameter $\\theta = 0.5$.\n  - Tolerance $\\text{tol} = 10^{-4}$.\n  - Maximum elements $N_{\\max} = 4000$.\n\n- Define the following three test cases by specifying $l$ and $h(x)$:\n  - Case A (localized driving):\n    - $l = 0.02$.\n    - $h(x) = 4.0 \\,\\exp\\!\\left(-\\dfrac{\\left(x-0.5\\right)^{2}}{2\\,\\sigma^{2}}\\right)$ with $\\sigma = 0.07$.\n  - Case B (left-loaded, piecewise constant):\n    - $l = 0.01$.\n    - $h(x) = 3.0$ for $x \\in [0,0.25]$ and $h(x) = 0$ otherwise.\n  - Case C (smooth oscillatory):\n    - $l = 0.05$.\n    - $h(x) = 2.0\\,\\sin^{2}\\!\\left(\\pi x\\right)$.\n\nRequired final output:\n- For each case, compute the discrete energy $\\mathcal{E}[d_{h}]$ upon AMR termination.\n- Your program should produce a single line of output containing the three energies in a comma-separated Python list with each value rounded to six decimal places, for example, `[E_A,E_B,E_C]`.\n- Since the model is nondimensional, no physical units are required or permitted in the output.\n\nYour final deliverable must be a complete, runnable program that:\n- Implements the derivation you used to construct the solver (weak form based on the stated energy).\n- Uses piecewise-linear FEM with Gaussian quadrature as specified.\n- Implements the residual-based AMR loop with Dörfler marking, stopping criteria, and bisection refinement.\n- Computes and outputs the energies for the three cases in the exact single-line format `[E_A,E_B,E_C]`, rounded to six decimal places.", "solution": "The problem posed is a well-defined exercise in computational mechanics, specifically the numerical solution of a variational problem using the Finite Element Method (FEM) with adaptive mesh refinement. It is scientifically grounded in the phase-field theory of fracture, mathematically consistent, and provides all necessary information for a unique solution. The problem is therefore deemed valid.\n\nThe solution process involves four main stages:\n1.  Derivation of the governing equation in its weak form from the principle of stationary energy.\n2.  Discretization of the weak form using the Galerkin FEM with piecewise-linear basis functions.\n3.  Formulation of an a posteriori error indicator and an adaptive mesh refinement strategy.\n4.  Implementation of the full algorithm to solve the specified test cases.\n\n### 1. Derivation of the Weak and Strong Form\n\nThe problem is to find the function $d(x)$ that minimizes the energy functional $\\mathcal{E}[d]$ on the domain $x \\in [0, L]$:\n$$\n\\mathcal{E}[d] = \\int_{0}^{L} \\mathcal{L}(x, d(x), d'(x)) \\,dx, \\quad \\text{where} \\quad \\mathcal{L}(x, d, d') = \\frac{l}{2}(d')^2 + \\frac{1}{2l}d^2 + h(x)(1-d)^2.\n$$\nA minimizer $d(x)$ must satisfy the condition of stationarity, which states that the first variation of the functional, $\\delta\\mathcal{E}[d; v]$, must be zero for all admissible variations $v(x)$. The first variation is defined as:\n$$\n\\delta\\mathcal{E}[d; v] = \\left. \\frac{d}{d\\epsilon} \\mathcal{E}[d + \\epsilon v] \\right|_{\\epsilon=0} = 0.\n$$\nLet us compute the derivative with respect to $\\epsilon$:\n$$\n\\frac{d}{d\\epsilon} \\int_{0}^{L} \\left[ \\frac{l}{2}(d' + \\epsilon v')^2 + \\frac{1}{2l}(d + \\epsilon v)^2 + h(x)(1 - (d + \\epsilon v))^2 \\right] dx.\n$$\nDifferentiating under the integral sign gives:\n$$\n\\int_{0}^{L} \\left[ l(d' + \\epsilon v') v' + \\frac{1}{l}(d + \\epsilon v) v + 2h(x)(1 - d - \\epsilon v)(-v) \\right] dx.\n$$\nSetting $\\epsilon=0$, we obtain the stationarity condition:\n$$\n\\int_{0}^{L} \\left[ l d' v' + \\frac{1}{l} d v - 2h(x)(1 - d)v \\right] dx = 0.\n$$\nRearranging the terms, we arrive at the **weak form** of the problem: Find $d \\in H^1([0,L])$ such that for all test functions $v \\in H^1([0,L])$,\n$$\n\\int_{0}^{L} l \\frac{dd}{dx} \\frac{dv}{dx} \\,dx + \\int_{0}^{L} \\left(\\frac{1}{l} + 2h(x)\\right) d v \\,dx = \\int_{0}^{L} 2h(x) v \\,dx.\n$$\nTo derive the strong form, we apply integration by parts to the first term of the weak form:\n$$\n\\int_{0}^{L} l d' v' \\,dx = \\left[ l d' v \\right]_0^L - \\int_{0}^{L} l d'' v \\,dx.\n$$\nSubstituting this into the weak form yields:\n$$\n\\left[ l d' v \\right]_0^L - \\int_{0}^{L} l d'' v \\,dx + \\int_{0}^{L} \\left(\\frac{1}{l} + 2h(x)\\right) d v \\,dx = \\int_{0}^{L} 2h(x) v \\,dx.\n$$\nCombining all integral terms:\n$$\n\\int_{0}^{L} \\left[ -l d'' + \\left(\\frac{1}{l} + 2h(x)\\right)d - 2h(x) \\right] v \\,dx + \\left[ l \\frac{dd}{dx} v \\right]_0^L = 0.\n$$\nSince this equation must hold for any arbitrary smooth test function $v(x)$, by the fundamental lemma of calculus of variations, the integrand must be zero. This gives the **Euler-Lagrange equation**:\n$$\n-l \\frac{d^2d}{dx^2} + \\left(\\frac{1}{l} + 2h(x)\\right)d = 2h(x).\n$$\nThe boundary term $\\left[ l d' v \\right]_0^L = l d'(L)v(L) - l d'(0)v(0)$ must also vanish. Since $v(0)$ and $v(L)$ are arbitrary, this implies the **natural (homogeneous Neumann) boundary conditions**, as stated in the problem:\n$$\n\\frac{dd}{dx}(0) = 0 \\quad \\text{and} \\quad \\frac{dd}{dx}(L) = 0.\n$$\n\n### 2. Galerkin Finite Element Formulation\n\nWe employ the Galerkin method, where the solution $d(x)$ and test function $v(x)$ are approximated from the same finite-dimensional space spanned by continuous, piecewise-linear basis functions $N_i(x)$. The approximate solution is $d_h(x) = \\sum_{j} d_j N_j(x)$, where $d_j$ are the unknown nodal values.\nSubstituting $d_h(x)$ into the weak form and choosing $v(x)$ to be each basis function $N_i(x)$ in turn, we obtain a system of linear equations $\\mathbf{K}\\mathbf{d} = \\mathbf{f}$, where $\\mathbf{d}$ is the vector of nodal values $\\{d_j\\}$. The entries of the global stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{f}$ are:\n$$\nK_{ij} = \\int_{0}^{L} l N_i' N_j' \\,dx + \\int_{0}^{L} \\left(\\frac{1}{l} + 2h(x)\\right) N_i N_j \\,dx\n$$\n$$\nf_i = \\int_{0}^{L} 2h(x) N_i \\,dx\n$$\nThese global integrals are assembled by summing contributions from each element $e = [x_k, x_{k+1}]$ of length $h_e = x_{k+1}-x_k$. On element $e$, the local stiffness and mass matrices, and the local force vector, are defined for local basis functions. For piecewise-linear shape functions, the derivative part can be integrated exactly. Since $N_k' = -1/h_e$ and $N_{k+1}' = 1/h_e$ on the element, the local stiffness matrix is:\n$$\n\\mathbf{K}^e_{\\text{stiff}} = \\frac{l}{h_e} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}.\n$$\nThe terms involving the spatially varying coefficient $h(x)$ are integrated numerically using $2$-point Gaussian quadrature on a reference element $\\hat{e} = [-1, 1]$. The local mass matrix and force vector contributions are:\n$$\n\\mathbf{K}^e_{\\text{mass}, ab} \\approx \\frac{h_e}{2} \\sum_{q=1}^{2} w_q \\left( \\frac{1}{l} + 2h(x_q) \\right) \\hat{N}_a(\\xi_q) \\hat{N}_b(\\xi_q)\n$$\n$$\n\\mathbf{f}^e_{a} \\approx \\frac{h_e}{2} \\sum_{q=1}^{2} w_q \\left( 2h(x_q) \\right) \\hat{N}_a(\\xi_q)\n$$\nwhere $\\xi_q \\in \\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$ are the quadrature points, $w_q=1$ are the weights, $x_q$ is the corresponding physical coordinate, and $\\hat{N}_{a,b}$ are the basis functions on the reference element.\n\n### 3. A Posteriori Error Indicator and AMR\n\nThe derived Euler-Lagrange equation, $-l d'' + (\\frac{1}{l} + 2h(x))d = 2h(x)$, is of the reaction-diffusion type $-\\alpha d'' + \\beta(x)d = f(x)$, with $\\alpha = l$, $\\beta(x) = \\frac{1}{l} + 2h(x)$, and $f(x) = 2h(x)$. The residual of the PDE for the finite element solution $d_h$ is $R(x) = f(x) - (-\\alpha d_h'' + \\beta(x) d_h)$. Since $d_h$ is piecewise-linear, its second derivative $d_h''$ is zero within each element. The element-wise residual is therefore $R_e(x) = f(x) - \\beta(x)d_h(x)$. The specified error indicator is the element-wise $L^2$-norm of this residual, scaled by the element size $h_e$:\n$$\n\\eta_{e} = h_{e} \\|R_e\\|_{L^2(e)} = h_{e} \\left( \\int_{e} \\left( f(x) - \\beta(x)d_{h}(x) \\right)^2 dx \\right)^{1/2}.\n$$\nThe full a posteriori error estimate also includes terms for the jumps in the flux, $[l d_h']$, at inter-element boundaries. For continuous, piecewise-linear ($P1$) approximations in 1D, the Galerkin orthogonality condition implies that the flux jump at a node is balanced by the integral of the element-wise residual over adjacent elements. Consequently, the magnitude of the jump term is controlled by the element residuals. While neglecting the jump terms renders the indicator a less accurate *estimator* of the true error norm, it remains a consistent *indicator* for adaptive refinement. It correctly identifies elements with large error contributions, which is sufficient for guiding the marking process in an AMR algorithm. The squared norm is computed using $2$-point Gaussian quadrature.\n\nThe AMR algorithm is as follows:\n1.  **Solve**: On the current mesh, assemble and solve the linear system for the nodal solution $\\mathbf{d}$.\n2.  **Estimate**: Compute the indicator $\\eta_e$ for each element and the global estimator $\\eta = (\\sum_e \\eta_e^2)^{1/2}$.\n3.  **Check termination**: If $\\eta \\le \\text{tol}$ or the number of elements exceeds $N_{\\max}$, stop.\n4.  **Mark**: Use Dörfler (bulk) marking. Sort elements by their $\\eta_e$ values in descending order. Mark the smallest set of elements whose cumulative squared error contribution is at least the fraction $\\theta$ of the total squared error $\\eta^2$.\n5.  **Refine**: Bisect each marked element, creating a new node at its midpoint. Generate a new conforming mesh and proceed to the next iteration.\n\n### 4. Discrete Energy Calculation\n\nUpon termination of the AMR loop, the final discrete energy $\\mathcal{E}[d_h]$ is computed on the final mesh. The integral is again split into a sum over elements $e$:\n$$\n\\mathcal{E}[d_h] = \\sum_e \\left[ \\int_e \\frac{l}{2}(d_h')^2 dx + \\int_e \\left( \\frac{1}{2l}d_h^2 + h(x)(1-d_h)^2 \\right) dx \\right].\n$$\nThe first term, involving the constant derivative $d_h' = (d_{k+1}-d_k)/h_e$ on each element, is integrated exactly: $\\frac{l}{2h_e}(d_{k+1}-d_k)^2$. The second integral is computed using $2$-point Gaussian quadrature. The sum of these contributions over all elements gives the total energy.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csc_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef solve():\n    \"\"\"\n    Main driver function to run the specified test cases and print the results.\n    \"\"\"\n\n    # Common parameters for all test cases\n    common_params = {\n        'L': 1.0,\n        'N0': 20,\n        'theta': 0.5,\n        'tol': 1e-4,\n        'N_max': 4000,\n    }\n\n    # Quadrature points and weights for a 2-point Gauss rule on [-1, 1]\n    quad_points = np.array([-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)])\n    quad_weights = np.array([1.0, 1.0])\n    \n    # Case A: Localized driving force\n    sigma_A = 0.07\n    h_A = lambda x: 4.0 * np.exp(-(x - 0.5)**2 / (2.0 * sigma_A**2))\n    case_A_params = {'l': 0.02, 'h_func': h_A}\n\n    # Case B: Piecewise constant driving force\n    h_B = lambda x: 3.0 if x = 0.0 and x = 0.25 else 0.0\n    case_B_params = {'l': 0.01, 'h_func': np.vectorize(h_B)}\n\n    # Case C: Smooth oscillatory driving force\n    h_C = lambda x: 2.0 * np.sin(np.pi * x)**2\n    case_C_params = {'l': 0.05, 'h_func': h_C}\n    \n    test_cases = [case_A_params, case_B_params, case_C_params]\n    \n    results = []\n    for params in test_cases:\n        energy = adaptive_fem_solver(\n            L=common_params['L'],\n            N0=common_params['N0'],\n            l=params['l'],\n            h_func=params['h_func'],\n            theta=common_params['theta'],\n            tol=common_params['tol'],\n            N_max=common_params['N_max'],\n            quad_points=quad_points,\n            quad_weights=quad_weights\n        )\n        results.append(energy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef adaptive_fem_solver(L, N0, l, h_func, theta, tol, N_max, quad_points, quad_weights):\n    \"\"\"\n    Implements the solve-estimate-mark-refine adaptive loop.\n    \"\"\"\n    # Initialize mesh\n    nodes = np.linspace(0, L, N0 + 1)\n    \n    while True:\n        num_elements = len(nodes) - 1\n        elements = np.array([[i, i + 1] for i in range(num_elements)])\n\n        # 1. Solve\n        d = assemble_and_solve(nodes, elements, l, h_func, quad_points, quad_weights)\n\n        # 2. Estimate\n        eta_e = compute_error_indicators(nodes, elements, d, l, h_func, quad_points, quad_weights)\n        eta_global = np.sqrt(np.sum(eta_e**2))\n\n        # 3. Check termination criteria\n        if eta_global = tol or num_elements = N_max:\n            break\n\n        # 4. Mark\n        marked_indices = mark_elements(eta_e, theta)\n        \n        # 5. Refine\n        nodes = refine_mesh(nodes, elements, marked_indices)\n\n    # Compute final energy on the terminal mesh\n    final_energy = compute_energy(nodes, elements, d, l, h_func, quad_points, quad_weights)\n    return final_energy\n\ndef assemble_and_solve(nodes, elements, l, h_func, quad_points, quad_weights):\n    \"\"\"\n    Assembles the global stiffness matrix and force vector, then solves the system.\n    \"\"\"\n    num_nodes = len(nodes)\n    K = lil_matrix((num_nodes, num_nodes))\n    f = np.zeros(num_nodes)\n    \n    # Basis functions on reference element [-1, 1]\n    N_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for i, elem in enumerate(elements):\n        n1, n2 = elem\n        x1, x2 = nodes[n1], nodes[n2]\n        he = x2 - x1\n\n        # Stiffness part (exact)\n        K_stiff_e = (l / he) * np.array([[1, -1], [-1, 1]])\n\n        # Mass part and force vector (using quadrature)\n        K_mass_e = np.zeros((2, 2))\n        f_e = np.zeros(2)\n\n        for q_idx, xi in enumerate(quad_points):\n            w = quad_weights[q_idx]\n            x_q = x1 + (xi + 1) * he / 2\n            h_val = h_func(x_q)\n            \n            beta_val = 1/l + 2*h_val\n            f_val = 2*h_val\n\n            for a in range(2):\n                f_e[a] += f_val * N_ref[a](xi) * w * he / 2\n                for b in range(2):\n                    K_mass_e[a, b] += beta_val * N_ref[a](xi) * N_ref[b](xi) * w * he / 2\n        \n        K_e = K_stiff_e + K_mass_e\n        \n        # Assemble into global system\n        for a in range(2):\n            f[elem[a]] += f_e[a]\n            for b in range(2):\n                K[elem[a], elem[b]] += K_e[a, b]\n\n    # Solve the linear system\n    K_csc = csc_matrix(K)\n    d = spsolve(K_csc, f)\n    return d\n\ndef compute_error_indicators(nodes, elements, d, l, h_func, quad_points, quad_weights):\n    \"\"\"\n    Computes the residual-based a posteriori error indicator for each element.\n    \"\"\"\n    num_elements = len(elements)\n    eta_e = np.zeros(num_elements)\n    \n    N_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for i, elem in enumerate(elements):\n        n1, n2 = elem\n        x1, x2 = nodes[n1], nodes[n2]\n        he = x2 - x1\n        d1, d2 = d[n1], d[n2]\n        \n        integral_val = 0\n        for q_idx, xi in enumerate(quad_points):\n            w = quad_weights[q_idx]\n            x_q = x1 + (xi + 1) * he / 2\n            \n            d_h_q = d1 * N_ref[0](xi) + d2 * N_ref[1](xi)\n            h_val = h_func(x_q)\n            \n            beta_val = 1/l + 2*h_val\n            f_val = 2*h_val\n            \n            residual_sq = (f_val - beta_val * d_h_q)**2\n            integral_val += residual_sq * w\n            \n        eta_e[i] = he * np.sqrt(integral_val * he / 2)\n        \n    return eta_e\n\ndef mark_elements(eta_e, theta):\n    \"\"\"\n    Performs Dörfler (bulk) marking.\n    \"\"\"\n    eta_total_sq = np.sum(eta_e**2)\n    sorted_indices = np.argsort(eta_e)[::-1]\n    \n    cumulative_sum = 0.0\n    marked_indices = []\n    \n    for idx in sorted_indices:\n        cumulative_sum += eta_e[idx]**2\n        marked_indices.append(idx)\n        if cumulative_sum = theta * eta_total_sq:\n            break\n            \n    return marked_indices\n\ndef refine_mesh(nodes, elements, marked_indices):\n    \"\"\"\n    Refines the mesh by bisecting marked elements.\n    \"\"\"\n    midpoints_to_add = set()\n    for idx in marked_indices:\n        n1, n2 = elements[idx]\n        midpoint = (nodes[n1] + nodes[n2]) / 2\n        midpoints_to_add.add(midpoint)\n        \n    new_nodes_list = sorted(list(np.union1d(nodes, list(midpoints_to_add))))\n    return np.array(new_nodes_list)\n\ndef compute_energy(nodes, elements, d, l, h_func, quad_points, quad_weights):\n    \"\"\"\n    Computes the discrete energy of the system.\n    \"\"\"\n    total_energy = 0\n    N_ref = [lambda xi: (1 - xi) / 2, lambda xi: (1 + xi) / 2]\n\n    for i, elem in enumerate(elements):\n        n1, n2 = elem\n        x1, x2 = nodes[n1], nodes[n2]\n        he = x2 - x1\n        d1, d2 = d[n1], d[n2]\n        \n        # Stiffness energy (exact)\n        d_prime = (d2 - d1) / he\n        energy_stiff = (l / 2) * (d_prime**2) * he\n\n        # Mass/source energy (quadrature)\n        energy_mass_source = 0\n        for q_idx, xi in enumerate(quad_points):\n            w = quad_weights[q_idx]\n            x_q = x1 + (xi + 1) * he / 2\n            \n            d_h_q = d1 * N_ref[0](xi) + d2 * N_ref[1](xi)\n            h_val = h_func(x_q)\n\n            integrand = (1 / (2*l)) * d_h_q**2 + h_val * (1 - d_h_q)**2\n            energy_mass_source += integrand * w\n            \n        energy_mass_source *= he / 2\n        \n        total_energy += energy_stiff + energy_mass_source\n        \n    return total_energy\n\nsolve()\n```", "id": "2929128"}]}