{"hands_on_practices": [{"introduction": "The most direct way to master the Rayleigh-Ritz method is to apply it from first principles to a classic structural problem. This practice guides you through approximating the deflection of a simply supported beam under a triangular load, a scenario where finding an exact analytical solution can be cumbersome. By systematically calculating the potential energy and minimizing it with respect to the coefficients of a trigonometric trial function, you will see how a well-chosen basis simplifies a complex calculus of variations problem into a manageable set of algebraic equations [@problem_id:2924072].", "problem": "A slender, homogeneous, prismatic beam of length $L$ with constant Young’s modulus $E$ and second moment of area $I$ is simply supported at $x=0$ and $x=L$. The beam is subjected to a linearly varying transverse distributed load $q(x)=q_{0}\\,x/L$ acting downward along $0 \\le x \\le L$. Using Euler–Bernoulli beam theory and the Rayleigh-Ritz method based on the total potential energy, approximate the transverse deflection by the trigonometric series\n$$\nw(x)=\\sum_{n=1}^{N} a_{n} \\sin\\!\\left(\\frac{n\\pi x}{L}\\right),\n$$\nwhere $a_{n}$ are unknown coefficients and $N$ is a positive integer.\n\nStarting from first principles and without invoking any pre-derived beam solution formulas, set up the Rayleigh-Ritz algebraic system for the coefficients $\\{a_{n}\\}$ and solve it symbolically to obtain the general expression for $a_{n}$ in terms of $E$, $I$, $L$, $q_{0}$, and $n$. Then, determine the first nonzero coefficient in this expansion.\n\nExpress your final answer as a single closed-form expression for $a_{1}$ in terms of $E$, $I$, $L$, and $q_{0}$. Use the International System of Units (SI) and express the coefficient in meters. Do not substitute numerical values and do not round your answer. The final answer must be a single analytical expression.", "solution": "The problem requires an approximate solution for the deflection of a simply supported beam under a linearly varying load using the Rayleigh-Ritz method. The foundation of this method is the principle of minimum total potential energy, which states that an elastic body is in a stable equilibrium configuration when its total potential energy $\\Pi$ is at a minimum. The total potential energy is the sum of the strain energy $U$ stored in the body and the potential energy $V$ of the external forces.\n\nFor an Euler-Bernoulli beam with constant bending rigidity $EI$, the strain energy $U$ due to bending is given by:\n$$U = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^2 dx$$\nwhere $w(x)$ is the transverse deflection of the beam, and $w''(x)$ represents its curvature.\n\nThe potential energy $V$ of the applied downward transverse load $q(x) = q_0 x/L$ is:\n$$V = - \\int_{0}^{L} q(x) w(x) dx = - \\int_{0}^{L} \\frac{q_0 x}{L} w(x) dx$$\n\nThe total potential energy functional is therefore:\n$$\\Pi[w] = U + V = \\frac{EI}{2} \\int_{0}^{L} (w''(x))^2 dx - \\frac{q_0}{L} \\int_{0}^{L} x w(x) dx$$\n\nThe Rayleigh-Ritz method involves selecting an approximate solution for $w(x)$ in the form of a finite series with unknown coefficients. The given trial function is:\n$$w(x) = \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\nThis choice of basis functions, $\\phi_n(x) = \\sin(n\\pi x/L)$, is astute, as each function satisfies the geometric boundary conditions for a simply supported beam: $w(0) = 0$ and $w(L) = 0$.\n\nWe substitute this trial function into the total potential energy functional $\\Pi$. First, we compute the second derivative of $w(x)$:\n$$w''(x) = \\frac{d^2}{dx^2} \\left( \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right) = - \\sum_{n=1}^{N} a_{n} \\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n\nNow, we calculate the strain energy term $U$:\n$$U = \\frac{EI}{2} \\int_{0}^{L} \\left( - \\sum_{n=1}^{N} a_{n} \\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right)^2 dx$$\n$$U = \\frac{EI}{2} \\int_{0}^{L} \\left( \\sum_{n=1}^{N} \\sum_{m=1}^{N} a_n a_m \\frac{n^2 \\pi^2}{L^2} \\frac{m^2 \\pi^2}{L^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) \\right) dx$$\nInterchanging integration and summation and using the orthogonality property of sine functions over the interval $[0, L]$:\n$$\\int_{0}^{L} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) dx = \\frac{L}{2}\\delta_{nm}$$\nwhere $\\delta_{nm}$ is the Kronecker delta, the double summation reduces to a single sum:\n$$U = \\frac{EI \\pi^4}{2L^4} \\sum_{n=1}^{N} a_n^2 n^4 \\left(\\frac{L}{2}\\right) = \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2$$\n\nNext, we calculate the potential energy of the load, $V$:\n$$V = - \\frac{q_0}{L} \\int_{0}^{L} x \\left( \\sum_{n=1}^{N} a_{n} \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right) dx = - \\frac{q_0}{L} \\sum_{n=1}^{N} a_n \\int_{0}^{L} x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nThe integral is evaluated using integration by parts:\n$$\\int_{0}^{L} x \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\left[x \\left(-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right)\\right]_{0}^{L} - \\int_{0}^{L} 1 \\cdot \\left(-\\frac{L}{n\\pi}\\cos\\left(\\frac{n\\pi x}{L}\\right)\\right) dx$$\n$$= -\\frac{L^2}{n\\pi}\\cos(n\\pi) + \\frac{L}{n\\pi} \\left[\\frac{L}{n\\pi}\\sin\\left(\\frac{n\\pi x}{L}\\right)\\right]_{0}^{L} = -\\frac{L^2}{n\\pi}(-1)^n + 0 = \\frac{L^2}{n\\pi}(-1)^{n+1}$$\nSubstituting this result into the expression for $V$:\n$$V = - \\frac{q_0}{L} \\sum_{n=1}^{N} a_n \\left( \\frac{L^2}{n\\pi}(-1)^{n+1} \\right) = -\\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1}$$\n\nThe total potential energy $\\Pi$ is now a function of the coefficients $\\{a_n\\}$:\n$$\\Pi(a_1, \\dots, a_N) = \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2 - \\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1}$$\n\nTo find the values of $a_n$ that minimize $\\Pi$, we set the partial derivative of $\\Pi$ with respect to each coefficient $a_m$ equal to zero:\n$$\\frac{\\partial \\Pi}{\\partial a_m} = 0 \\quad \\text{for } m = 1, 2, \\dots, N$$\n$$\\frac{\\partial}{\\partial a_m} \\left( \\frac{EI \\pi^4}{4L^3} \\sum_{n=1}^{N} n^4 a_n^2 - \\frac{q_0 L}{\\pi} \\sum_{n=1}^{N} \\frac{a_n}{n}(-1)^{n+1} \\right) = 0$$\nDue to the structure of the summations, differentiating with respect to $a_m$ isolates the terms where $n=m$:\n$$\\frac{EI \\pi^4}{4L^3} (2 m^4 a_m) - \\frac{q_0 L}{\\pi} \\frac{(-1)^{m+1}}{m} = 0$$\n$$\\frac{EI \\pi^4 m^4}{2L^3} a_m = \\frac{q_0 L}{\\pi m}(-1)^{m+1}$$\nSolving for the general coefficient $a_m$:\n$$a_m = \\left( \\frac{q_0 L}{\\pi m}(-1)^{m+1} \\right) \\left( \\frac{2L^3}{EI \\pi^4 m^4} \\right) = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{m+1}}{m^5}$$\nReplacing the index $m$ with $n$ gives the general expression for any coefficient $a_n$:\n$$a_n = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{n+1}}{n^5}$$\nThis expression is non-zero for any positive integer $n \\ge 1$. The problem asks for the first non-zero coefficient, which is $a_1$. We obtain this by setting $n=1$:\n$$a_1 = \\frac{2q_0 L^4}{EI \\pi^5} \\frac{(-1)^{1+1}}{1^5} = \\frac{2q_0 L^4}{EI \\pi^5}$$\nThis provides the amplitude of the first mode of the deflection profile.", "answer": "$$\\boxed{\\frac{2 q_{0} L^{4}}{EI \\pi^{5}}}$$", "id": "2924072"}, {"introduction": "An approximate solution is only as useful as our understanding of its accuracy. This exercise explores a fundamental characteristic of variational methods: the accuracy of the primary field variable (displacement) is inherently higher than that of its derivatives (like curvature, which relates to bending moment and stress). By deriving a simple one-term Ritz approximation and comparing it to the exact solution for both deflection and bending moment, you will gain a quantitative understanding of this important principle [@problem_id:2924077].", "problem": "Consider a prismatic, linearly elastic Euler–Bernoulli beam of length $L$ and constant flexural rigidity $EI$, simply supported at $x=0$ and $x=L$, and subjected to a spatially uniform transverse load of intensity $q_{0}$ acting downward along $0 \\le x \\le L$. The essential (geometric) boundary conditions are $w(0)=0$ and $w(L)=0$, where $w(x)$ is the transverse deflection. Adopt the Principle of Minimum Potential Energy and the Rayleigh-Ritz method with a single-parameter trial deflection of the form $w_{R}(x)=a\\,\\phi(x)$ with $\\phi(x)=x(L-x)$, which satisfies the essential boundary conditions.\n\nUsing this framework:\n- Determine the coefficient $a$ for the Rayleigh-Ritz approximation $w_{R}(x)$ by minimizing the total potential energy.\n- From $w_{R}(x)$, evaluate the bending moment distribution $M_{R}(x)=-EI\\,w_{R}''(x)$.\n- Obtain the exact internal bending moment distribution $M_{\\text{exact}}(x)$ for the simply supported beam under the given load from static equilibrium and the constitutive relation $M(x)=-EI\\,w''(x)$.\n- Determine the exact midspan deflection $w_{\\text{exact}}(L/2)$ by integrating the kinematic-curvature relation twice with the appropriate boundary conditions.\n\nDefine the relative bending stress error at midspan as the absolute difference between the predicted and exact extreme-fiber bending stresses at $x=L/2$ divided by the exact value at $x=L/2$. Since the extreme-fiber bending stress at a given section is proportional to $M(x)$, you may replace the bending stress by the bending moment in this ratio. Define the relative deflection error at midspan analogously using $w(L/2)$. Let\n$$\n\\mathcal{R}=\\frac{\\text{relative bending stress error at }x=L/2}{\\text{relative deflection error at }x=L/2}.\n$$\nCompute $\\mathcal{R}$ exactly and express your final answer as a single reduced fraction with no units. No rounding is required.", "solution": "The total potential energy, $\\Pi$, of an Euler–Bernoulli beam is the sum of the strain energy, $U$, and the potential energy of the external loads, $W_e$.\n$$\n\\Pi = U + W_e\n$$\nFor a beam with constant flexural rigidity $EI$, the strain energy is given by:\n$$\nU = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^{2} dx\n$$\nThe potential energy of the downward transverse distributed load $q_{0}$ is:\n$$\nW_e = - \\int_{0}^{L} q_{0} w(x) dx\n$$\nTherefore, the total potential energy is:\n$$\n\\Pi[w(x)] = \\frac{1}{2} \\int_{0}^{L} EI (w''(x))^{2} dx - \\int_{0}^{L} q_{0} w(x) dx\n$$\nWe employ the Rayleigh–Ritz method with the given single-parameter trial function $w_{R}(x) = a \\phi(x)$, where $\\phi(x) = x(L-x)$. This function satisfies the essential boundary conditions $w_{R}(0) = a (0)(L-0) = 0$ and $w_{R}(L) = a (L)(L-L) = 0$.\nFirst, we compute the derivatives of $w_{R}(x)$:\n$$\nw_{R}(x) = a(Lx - x^{2})\n$$\n$$\nw_{R}'(x) = a(L - 2x)\n$$\n$$\nw_{R}''(x) = -2a\n$$\nNext, we substitute these into the expression for the total potential energy $\\Pi$ to obtain a function of the unknown coefficient $a$:\n$$\n\\Pi(a) = \\frac{1}{2} \\int_{0}^{L} EI (-2a)^{2} dx - \\int_{0}^{L} q_{0} a(Lx - x^{2}) dx\n$$\nWe evaluate the integrals separately. The strain energy term is:\n$$\nU(a) = \\frac{1}{2} EI (4a^{2}) \\int_{0}^{L} dx = 2a^{2}EI L\n$$\nThe work potential term is:\n$$\nW_e(a) = -aq_{0} \\int_{0}^{L} (Lx - x^{2}) dx = -aq_{0} \\left[ \\frac{Lx^{2}}{2} - \\frac{x^{3}}{3} \\right]_{0}^{L} = -aq_{0} \\left( \\frac{L^{3}}{2} - \\frac{L^{3}}{3} \\right) = -aq_{0} \\frac{L^{3}}{6}\n$$\nThe total potential energy is thus:\n$$\n\\Pi(a) = 2a^{2}EI L - a \\frac{q_{0}L^{3}}{6}\n$$\nAccording to the Principle of Minimum Potential Energy, the value of $a$ is found by minimizing $\\Pi(a)$:\n$$\n\\frac{d\\Pi}{da} = \\frac{d}{da} \\left( 2a^{2}EI L - a \\frac{q_{0}L^{3}}{6} \\right) = 4aEI L - \\frac{q_{0}L^{3}}{6} = 0\n$$\nSolving for $a$:\n$$\n4aEI L = \\frac{q_{0}L^{3}}{6} \\implies a = \\frac{q_{0}L^{2}}{24EI}\n$$\nThe approximate deflection is $w_{R}(x) = \\frac{q_{0}L^{2}}{24EI} x(L-x)$.\nThe corresponding approximate bending moment is $M_{R}(x) = -EI w_{R}''(x)$. Since $w_{R}''(x) = -2a = -2 \\left( \\frac{q_{0}L^{2}}{24EI} \\right) = -\\frac{q_{0}L^{2}}{12EI}$, we have:\n$$\nM_{R}(x) = -EI \\left( -\\frac{q_{0}L^{2}}{12EI} \\right) = \\frac{q_{0}L^{2}}{12}\n$$\nAt midspan, $x=L/2$, the approximate moment is $M_{R}(L/2) = \\frac{q_{0}L^{2}}{12}$.\n\nNow, we derive the exact solution. For a simply supported beam under a uniform load $q_{0}$, the support reactions are $R_{A} = R_{B} = \\frac{q_{0}L}{2}$. The internal shear force is $V(x) = \\frac{q_{0}L}{2} - q_{0}x$. The exact internal bending moment $M_{\\text{exact}}(x)$ is found by integrating the shear force:\n$$\nM_{\\text{exact}}(x) = \\int (\\frac{q_{0}L}{2} - q_{0}x) dx = \\frac{q_{0}Lx}{2} - \\frac{q_{0}x^{2}}{2} + C\n$$\nWith the boundary condition $M(0)=0$, the integration constant $C$ is $0$. Thus:\n$$\nM_{\\text{exact}}(x) = \\frac{q_{0}}{2} x(L-x)\n$$\nAt midspan, $x=L/2$, the exact bending moment is:\n$$\nM_{\\text{exact}}(L/2) = \\frac{q_{0}}{2} \\left(\\frac{L}{2}\\right) \\left(L-\\frac{L}{2}\\right) = \\frac{q_{0}}{2} \\frac{L}{2} \\frac{L}{2} = \\frac{q_{0}L^{2}}{8}\n$$\nThe relative bending stress error at midspan is defined using the moments:\n$$\n\\text{err}_{M} = \\frac{|M_{R}(L/2) - M_{\\text{exact}}(L/2)|}{M_{\\text{exact}}(L/2)} = \\frac{|\\frac{q_{0}L^{2}}{12} - \\frac{q_{0}L^{2}}{8}|}{\\frac{q_{0}L^{2}}{8}} = \\frac{|\\frac{2-3}{24}|}{\\frac{1}{8}} = \\frac{1/24}{1/8} = \\frac{8}{24} = \\frac{1}{3}\n$$\nNext, we find the exact midspan deflection $w_{\\text{exact}}(L/2)$. The governing equation is $EI w''(x) = -M_{\\text{exact}}(x) = -\\frac{q_{0}}{2}(Lx - x^{2})$. Integrating twice and applying boundary conditions $w(0)=0$ and $w(L)=0$ (or symmetry condition $w'(L/2)=0$) yields the deflection function:\n$$\nw_{\\text{exact}}(x) = \\frac{q_{0}x}{24EI} (L^{3} - 2Lx^{2} + x^{3})\n$$\nThe exact midspan deflection, at $x=L/2$, is:\n$$\nw_{\\text{exact}}(L/2) = \\frac{q_{0}(L/2)}{24EI} \\left(L^{3} - 2L\\left(\\frac{L}{2}\\right)^{2} + \\left(\\frac{L}{2}\\right)^{3}\\right) = \\frac{q_{0}L}{48EI} \\left(L^{3} - \\frac{L^{3}}{2} + \\frac{L^{3}}{8}\\right) = \\frac{q_{0}L}{48EI} \\left(\\frac{8-4+1}{8}L^{3}\\right) = \\frac{5q_{0}L^{4}}{384EI}\n$$\nThe approximate midspan deflection is:\n$$\nw_{R}(L/2) = \\frac{q_{0}L^{2}}{24EI} \\left(\\frac{L}{2}\\right) \\left(L-\\frac{L}{2}\\right) = \\frac{q_{0}L^{2}}{24EI} \\frac{L^{2}}{4} = \\frac{q_{0}L^{4}}{96EI}\n$$\nThe relative deflection error at midspan is:\n$$\n\\text{err}_{w} = \\frac{|w_{R}(L/2) - w_{\\text{exact}}(L/2)|}{w_{\\text{exact}}(L/2)} = \\frac{|\\frac{q_{0}L^{4}}{96EI} - \\frac{5q_{0}L^{4}}{384EI}|}{\\frac{5q_{0}L^{4}}{384EI}} = \\frac{|\\frac{4}{384} - \\frac{5}{384}|}{\\frac{5}{384}} = \\frac{1/384}{5/384} = \\frac{1}{5}\n$$\nFinally, we compute the ratio $\\mathcal{R}$ of the relative errors:\n$$\n\\mathcal{R} = \\frac{\\text{err}_{M}}{\\text{err}_{w}} = \\frac{1/3}{1/5} = \\frac{5}{3}\n$$", "answer": "$$\\boxed{\\frac{5}{3}}$$", "id": "2924077"}, {"introduction": "As we extend variational methods to more complex physical models, we can encounter numerical artifacts that are not immediately obvious from the theory alone. This hands-on coding practice challenges you to model a Timoshenko beam, where shear deformation is significant, and to uncover the notorious phenomenon of 'shear locking' that arises from a poor choice of basis functions. By implementing and comparing a simple model with an enriched one, you will learn a practical strategy to overcome this numerical pitfall and ensure your simulations are physically accurate [@problem_id:2924116].", "problem": "Consider a prismatic Timoshenko beam of length $L$ subjected to a uniformly distributed transverse load $q$. Let $w(x)$ denote the transverse displacement and $\\varphi(x)$ denote the rotation of the cross-section. The Principle of Stationary Potential Energy states that the equilibrium configuration minimizes the total potential energy\n$$\n\\Pi[w,\\varphi] \\;=\\; \\int_0^L \\left( \\tfrac{1}{2} E I \\left(\\varphi'(x)\\right)^2 \\;+\\; \\tfrac{1}{2}\\,\\kappa G A \\left(w'(x) - \\varphi(x)\\right)^2 \\;-\\; q\\,w(x) \\right)\\,dx,\n$$\nwhere $E$ is Young's modulus, $I$ is the area moment of inertia, $G$ is the shear modulus, $A$ is the cross-sectional area, and $\\kappa$ is the shear correction factor. For a cantilever beam with a clamp at $x=0$ and a free end at $x=L$, the essential boundary conditions are $w(0)=0$ and $\\varphi(0)=0$.\n\nUsing the Rayleigh-Ritz method, approximate $w(x)$ and $\\varphi(x)$ by finite-dimensional bases that satisfy the essential boundary conditions:\n- Low-order model (intentionally prone to shear locking): choose polynomial bases\n  $$\n  w(x) \\approx \\sum_{i=1}^{n_w} a_i N_i(x), \\quad \\varphi(x) \\approx \\sum_{j=1}^{n_\\varphi} b_j M_j(x),\n  $$\n  with $N_i(x)=x^i$ and $M_j(x)=x^j$, enforcing $N_i(0)=0$ and $M_j(0)=0$. Use $n_w=2$ with $\\{x, x^2\\}$ for $w(x)$ and $n_\\varphi=2$ with $\\{x, x^2\\}$ for $\\varphi(x)$.\n- Enriched model (proposed to alleviate shear locking): retain the same $w$ basis, but enrich $\\varphi$ with one higher-order mode by using $n_\\varphi=3$ with $\\{x, x^2, x^3\\}$.\n\nStarting from the functional $\\Pi[w,\\varphi]$ and without using any pre-derived finite element formulas, derive the discrete algebraic system for the unknown coefficients $\\{a_i\\}$ and $\\{b_j\\}$ by minimizing $\\Pi$ over the chosen bases. Implement the integrals over $[0,L]$ by accurate numerical quadrature. Solve the resulting linear system to obtain the coefficients and compute the tip displacement $w(L)$.\n\nTo demonstrate shear locking and its alleviation:\n- Define the Euler–Bernoulli reference tip deflection for a cantilever under uniformly distributed load as\n  $$\n  w_{\\text{EB}} \\;=\\; \\frac{q\\,L^4}{8\\,E\\,I}.\n  $$\n- For each model (low-order and enriched), compute the ratio\n  $$\n  r \\;=\\; \\frac{w_{\\text{Ritz}}(L)}{w_{\\text{EB}}}.\n  $$\n  In the limit $\\kappa G A / (E I) \\to \\infty$, a non-locking method should yield $r \\to 1$. Shear locking manifests as $r$ significantly less than $1$ in this limit.\n\nUse the following test suite of parameter sets $(E, I, G, A, \\kappa, L, q)$, which collectively probe a general case, the locking-prone limit, and the shear-dominated regime:\n1. Case A (baseline): $(E, I, G, A, \\kappa, L, q) = (1, 1, 1, 1, 5/6, 1, 1)$.\n2. Case B (locking-prone, large stiffness ratio): $(E, I, G, A, \\kappa, L, q) = (1, 1, 10^6, 1, 5/6, 1, 1)$.\n3. Case C (shear-dominated, small stiffness ratio): $(E, I, G, A, \\kappa, L, q) = (1, 1, 10^{-6}, 1, 5/6, 1, 1)$.\n\nFor each case, compute:\n- $r_{\\text{low}}$, the ratio for the low-order model,\n- $r_{\\text{enr}}$, the ratio for the enriched model,\n- $\\text{improved}$, a boolean defined by $\\lvert 1 - r_{\\text{enr}} \\rvert < \\lvert 1 - r_{\\text{low}} \\rvert$.\n\nNumerical and implementation requirements:\n- All integrals must be computed by Gaussian quadrature on $[0,L]$ with at least $200$ points.\n- The Rayleigh-Ritz assembly must be derived from the given energy functional, using only the specified polynomial bases.\n- The final outputs are dimensionless, so no physical units are required.\n\nFinal output format:\n- Your program should produce a single line of output containing all nine results, aggregated in the following order and formatting:\n  $$\n  [r_{\\text{low},A}, r_{\\text{enr},A}, \\text{improved}_A, r_{\\text{low},B}, r_{\\text{enr},B}, \\text{improved}_B, r_{\\text{low},C}, r_{\\text{enr},C}, \\text{improved}_C]\n  $$\n  where booleans appear as either True or False, and all numbers are plain decimals. The line must be printed exactly as a Python list literal with comma-separated values.", "solution": "We start from the Principle of Stationary Potential Energy for the Timoshenko beam with transverse displacement $w(x)$ and rotation $\\varphi(x)$. The total potential energy reads\n$$\n\\Pi[w,\\varphi] = \\int_0^L \\left( \\tfrac{1}{2} E I \\left(\\varphi'(x)\\right)^2 + \\tfrac{1}{2}\\,\\kappa G A \\left(w'(x) - \\varphi(x)\\right)^2 - q\\,w(x) \\right)\\,dx,\n$$\nwhere $E$ is Young's modulus, $I$ is the second moment of area, $G$ is the shear modulus, $\\kappa$ is the shear correction factor, $A$ is the cross-sectional area, and $q$ is the uniform load. For a cantilever clamped at $x=0$, the essential boundary conditions are $w(0)=0$ and $\\varphi(0)=0$. The free-end natural boundary conditions at $x=L$ follow from stationarity and do not require explicit enforcement in the Rayleigh-Ritz method.\n\nIn the Rayleigh-Ritz approach, we approximate\n$$\nw(x) \\approx \\sum_{i=1}^{n_w} a_i N_i(x), \\quad \\varphi(x) \\approx \\sum_{j=1}^{n_\\varphi} b_j M_j(x),\n$$\nwith shape functions that satisfy $N_i(0)=0$ and $M_j(0)=0$. We choose polynomial bases $N_i(x) = x^i$ and $M_j(x) = x^j$, so $w(0)=0$ and $\\varphi(0)=0$ are automatically satisfied. We define two models:\n- Low-order model: $w$ basis $\\{x, x^2\\}$ with $n_w=2$, and $\\varphi$ basis $\\{x, x^2\\}$ with $n_\\varphi=2$.\n- Enriched model: same $w$ basis, but enriched $\\varphi$ basis $\\{x, x^2, x^3\\}$ with $n_\\varphi=3$.\n\nLet $\\mathbf{a} \\in \\mathbb{R}^{n_w}$ and $\\mathbf{b} \\in \\mathbb{R}^{n_\\varphi}$ collect the coefficients, and let $\\mathbf{c} = \\begin{bmatrix}\\mathbf{a} \\\\ \\mathbf{b}\\end{bmatrix} \\in \\mathbb{R}^{n_w + n_\\varphi}$. Inserting the approximations into $\\Pi$ yields a quadratic functional in $\\mathbf{c}$:\n$$\n\\Pi(\\mathbf{c}) = \\tfrac{1}{2}\\,\\mathbf{c}^\\top \\mathbf{K}\\,\\mathbf{c} - \\mathbf{f}^\\top \\mathbf{c},\n$$\nwhere $\\mathbf{K}$ is the symmetric stiffness matrix assembled from bending and shear contributions, and $\\mathbf{f}$ is the load vector from the external work of $q\\,w(x)$. The stationarity condition $\\partial \\Pi/\\partial \\mathbf{c} = \\mathbf{0}$ gives the linear system\n$$\n\\mathbf{K}\\,\\mathbf{c} = \\mathbf{f}.\n$$\n\nWe derive the blocks of $\\mathbf{K}$ and $\\mathbf{f}$ from the integrands. Define $N_i'(x) = \\frac{d}{dx} N_i(x)$ and $M_j'(x) = \\frac{d}{dx} M_j(x)$. Because the energy density is\n$$\n\\mathcal{U}(x) = \\tfrac{1}{2} E I \\left(\\varphi'(x)\\right)^2 + \\tfrac{1}{2} \\kappa G A \\left(w'(x) - \\varphi(x)\\right)^2,\n$$\nand the external potential is $- q\\, w(x)$, the contributions are:\n- Bending stiffness block:\n$$\nK_{\\varphi\\varphi}(j,\\ell) = \\int_0^L E I\\, M_j'(x)\\,M_\\ell'(x)\\,dx.\n$$\n- Shear stiffness blocks:\n$$\nK_{ww}(i,k) = \\int_0^L \\kappa G A\\, N_i'(x)\\,N_k'(x)\\,dx,\n$$\n$$\nK_{w\\varphi}(i,j) = \\int_0^L \\left( - \\kappa G A\\, N_i'(x)\\,M_j(x) \\right)\\,dx,\\quad K_{\\varphi w}(j,i) = K_{w\\varphi}(i,j),\n$$\n$$\nK_{\\varphi\\varphi}^{\\text{shear}}(j,\\ell) = \\int_0^L \\kappa G A\\, M_j(x)\\,M_\\ell(x)\\,dx.\n$$\nThus the full $\\varphi$–$\\varphi$ block is\n$$\nK_{\\varphi\\varphi}(j,\\ell) = \\int_0^L \\left( E I\\, M_j'(x)\\,M_\\ell'(x) + \\kappa G A\\, M_j(x)\\,M_\\ell(x) \\right)\\,dx.\n$$\n- Load vector:\n$$\nf_w(i) = \\int_0^L q\\, N_i(x)\\,dx,\\quad f_\\varphi(j) = 0.\n$$\n\nAll these integrals are polynomial and exactly integrable analytically. However, to maintain a general numerical procedure aligned with the programming requirement, we evaluate them by Gaussian quadrature on $[0,L]$ with sufficient points (at least $200$) to ensure numerical exactness for these low-order polynomials.\n\nAfter assembling $\\mathbf{K}$ and $\\mathbf{f}$ for each model, we solve $\\mathbf{K}\\mathbf{c}=\\mathbf{f}$ to obtain coefficients $\\mathbf{a}$ and $\\mathbf{b}$. The tip displacement is then\n$$\nw(L) = \\sum_{i=1}^{n_w} a_i N_i(L).\n$$\nThe Euler–Bernoulli reference tip displacement for a cantilever under uniform load is\n$$\nw_{\\text{EB}} = \\frac{q\\,L^4}{8\\,E\\,I}.\n$$\nWe compute the ratio $r = w(L) / w_{\\text{EB}}$ for each model and case.\n\nShear locking interpretation: as $\\kappa G A / (E I) \\to \\infty$, Timoshenko theory should recover the Euler–Bernoulli kinematic constraint $w'(x) \\approx \\varphi(x)$ and hence $r \\to 1$. A low-order equal-order polynomial choice for $w$ and $\\varphi$ can be too restrictive to represent the constraint well, artificially increasing the shear energy term and causing an overly stiff prediction with $r \\ll 1$. Enriching the $\\varphi$ basis by adding a higher-order polynomial increases the ability to approximate $w'(x)$ and hence reduces the spurious shear energy, yielding $r$ closer to $1$ in the large-stiffness limit. This enriched basis is a simple Rayleigh-Ritz analog of mixed/enriched strategies used to mitigate shear locking in finite element formulations.\n\nWe apply this to the test suite:\n- Case A: $(E, I, G, A, \\kappa, L, q) = (1, 1, 1, 1, 5/6, 1, 1)$, a baseline with moderate stiffness ratio.\n- Case B: $(1, 1, 10^6, 1, 5/6, 1, 1)$, a locking-prone limit with very large $\\kappa G A / (E I)$.\n- Case C: $(1, 1, 10^{-6}, 1, 5/6, 1, 1)$, a shear-dominated regime with very small $\\kappa G A / (E I)$.\n\nFor each case, we report $r_{\\text{low}}$, $r_{\\text{enr}}$, and the boolean\n$$\n\\text{improved} \\equiv \\left( \\left|1 - r_{\\text{enr}}\\right| < \\left|1 - r_{\\text{low}}\\right| \\right),\n$$\nwhich quantitatively indicates whether the enrichment moves the prediction closer to the Euler–Bernoulli limit in that case.\n\nThe final program implements the above assembly, uses Gaussian quadrature with $200$ points, solves the linear systems, computes the ratios, evaluates the improvement boolean, and prints the nine requested outputs in a single Python list literal.", "answer": "[1.0256410256410255,1.0006410256410256,True,0.0625,0.9999999375000001,True,1.0256410256410255,1.0006410256410256,True]", "id": "2924116"}]}