{"hands_on_practices": [{"introduction": "Understanding shakedown begins with Melan's static theorem, which provides a powerful condition for ensuring long-term elastic behavior under cyclic loads. This first practice provides a classic, foundational application of the theorem to a uniaxially constrained bar under cyclic thermal loading [@problem_id:2916218]. By deriving the critical temperature range, you will gain hands-on experience in defining a hypothetical elastic stress history and superimposing a time-independent residual stress field to satisfy the yield criterion, which is the very essence of the lower-bound shakedown method.", "problem": "A prismatic, homogeneous, isotropic bar of length $L$ and constant cross-sectional area is fully restrained against axial displacement at both ends. The material obeys small-strain, rate-independent, linear elasticity with Young’s modulus $E$ until yielding in uniaxial tension/compression at a yield stress $\\sigma_{y}$, beyond which it is perfectly plastic. The bar has a constant linear coefficient of thermal expansion $\\alpha$. It is subjected to a spatially uniform, quasi-static temperature history $T(t)$ that cycles repeatedly and symmetrically between $-\\Delta T$ and $+\\Delta T$ about a reference temperature at which there are no initial stresses.\n\nUsing the static shakedown theorem of Melan and the idea of superposing a time-independent residual stress field, proceed as follows:\n\n- Let $\\sigma^{e}(t)$ denote the elastic stress field that would arise under the given thermal loading if plastic strain were constrained to be zero at all times, subject to axial compatibility with fully fixed ends. Let $\\sigma^{r}$ be a time-independent residual stress, assumed uniform over the bar cross-section and constant along the bar’s length. Require that the stress field $\\sigma^{e}(t)+\\sigma^{r}$ remains within the elastic domain for all times during the cycle by enforcing $|\\sigma^{e}(t)+\\sigma^{r}|\\le \\sigma_{y}$ at every time.\n\n- Derive the largest temperature amplitude $\\Delta T_{\\text{crit}}$ such that there exists at least one constant $\\sigma^{r}$ for which the above condition holds for the entire symmetric cycle $T(t)\\in[-\\Delta T,\\,+\\Delta T]$. Your derivation must start from basic kinematics and constitutive relations and must not assume any specialized formula beyond the statement of the shakedown condition.\n\nExpress your final answer for $\\Delta T_{\\text{crit}}$ as a single closed-form analytic expression in terms of $E$, $\\sigma_{y}$, and $\\alpha$. The final result must be written without units, but for interpretation, $\\Delta T_{\\text{crit}}$ is to be expressed in Kelvin.", "solution": "The problem as stated is valid. It is a well-posed, scientifically grounded problem in the field of thermo-elasto-plasticity and structural mechanics, specifically concerning the application of Melan's static shakedown theorem. All necessary information is provided, and the objective is clear and formalizable. We shall proceed with the derivation.\n\nThe problem requires finding the largest temperature amplitude $\\Delta T_{\\text{crit}}$ for which a uniaxially loaded bar, fully restrained at its ends, will shakedown. Shakedown implies that after a finite period of initial plastic deformation, the structure's response becomes purely elastic, and plastic strain accumulation ceases. Melan's static shakedown theorem provides the condition for this to occur. The theorem states that shakedown occurs if it is possible to find a time-independent, self-equilibrating residual stress field, $\\sigma^{r}$, such that the sum of this residual stress and the purely elastic stress solution, $\\sigma^{e}(t)$, everywhere satisfies the yield criterion for all variations of the applied load.\n\nFirst, we must determine the purely elastic stress field, $\\sigma^{e}(t)$. The bar is fully restrained, which means the total axial strain, $\\epsilon_{\\text{total}}$, must be zero at all times.\nThe total strain is the sum of the elastic strain ($\\epsilon^{e}$), plastic strain ($\\epsilon^{p}$), and thermal strain ($\\epsilon^{th}$):\n$$ \\epsilon_{\\text{total}} = \\epsilon^{e} + \\epsilon^{p} + \\epsilon^{th} $$\nSince the bar is fixed at both ends, the total elongation is zero, and thus $\\epsilon_{\\text{total}} = 0$.\nThe problem asks for the purely elastic stress response, which is a hypothetical stress field computed by assuming the material behavior is purely elastic, i.e., by constraining the plastic strain to be zero ($\\epsilon^{p}=0$) for the purpose of this calculation.\nTherefore, the compatibility condition for the elastic analysis becomes:\n$$ \\epsilon^{e} + \\epsilon^{th} = 0 $$\nThe thermal strain is given by $\\epsilon^{th}(t) = \\alpha T(t)$, where $\\alpha$ is the coefficient of thermal expansion and $T(t)$ is the temperature change from the stress-free reference state.\nThe elastic strain is related to the elastic stress $\\sigma^{e}$ via Hooke's law for uniaxial stress: $\\epsilon^{e}(t) = \\frac{\\sigma^{e}(t)}{E}$, where $E$ is Young's modulus.\nSubstituting these constitutive relations into the compatibility equation yields:\n$$ \\frac{\\sigma^{e}(t)}{E} + \\alpha T(t) = 0 $$\nFrom this, we solve for the purely elastic stress as a function of temperature:\n$$ \\sigma^{e}(t) = -E \\alpha T(t) $$\nThe temperature $T(t)$ cycles symmetrically between $-\\Delta T$ and $+\\Delta T$. We can therefore determine the minimum and maximum values of the elastic stress during a cycle.\nThe maximum elastic stress, $\\sigma^{e}_{\\text{max}}$, occurs at the minimum temperature, $T = -\\Delta T$:\n$$ \\sigma^{e}_{\\text{max}} = -E \\alpha (-\\Delta T) = E \\alpha \\Delta T $$\nThis corresponds to a tensile stress.\nThe minimum elastic stress, $\\sigma^{e}_{\\text{min}}$, occurs at the maximum temperature, $T = +\\Delta T$:\n$$ \\sigma^{e}_{\\text{min}} = -E \\alpha (+\\Delta T) = -E \\alpha \\Delta T $$\nThis corresponds to a compressive stress.\n\nNow, we apply Melan's shakedown theorem. We superpose a time-independent, spatially uniform residual stress $\\sigma^{r}$ onto the elastic stress field. The total stress at any time is $\\sigma(t) = \\sigma^{e}(t) + \\sigma^{r}$. For shakedown to occur, this total stress must remain within the elastic domain for all time $t$. The yield criterion for the perfectly plastic material is $|\\sigma| \\le \\sigma_{y}$, where $\\sigma_{y}$ is the yield stress.\nThus, the shakedown condition is:\n$$ |\\sigma^{e}(t) + \\sigma^{r}| \\le \\sigma_{y} \\quad \\text{for all } t $$\nThis single inequality is equivalent to two conditions that must be satisfied simultaneously for all time:\n$$ -\\sigma_{y} \\le \\sigma^{e}(t) + \\sigma^{r} \\le \\sigma_{y} $$\nFor these inequalities to hold for the entire cycle, they must hold at the most critical points, which are the points of maximum and minimum elastic stress.\nThe first inequality, $\\sigma^{e}(t) + \\sigma^{r} \\le \\sigma_{y}$, is most stringent when $\\sigma^{e}(t)$ is maximum. So, we must satisfy:\n$$ \\sigma^{e}_{\\text{max}} + \\sigma^{r} \\le \\sigma_{y} \\quad (1) $$\nThe second inequality, $\\sigma^{e}(t) + \\sigma^{r} \\ge -\\sigma_{y}$, is most stringent when $\\sigma^{e}(t)$ is minimum. So, we must satisfy:\n$$ \\sigma^{e}_{\\text{min}} + \\sigma^{r} \\ge -\\sigma_{y} \\quad (2) $$\nThese two inequalities define a range for the possible values of the residual stress $\\sigma^{r}$:\nFrom $(1)$:\n$$ \\sigma^{r} \\le \\sigma_{y} - \\sigma^{e}_{\\text{max}} $$\nFrom $(2)$:\n$$ \\sigma^{r} \\ge -\\sigma_{y} - \\sigma^{e}_{\\text{min}} $$\nA valid residual stress $\\sigma^{r}$ exists if and only if the lower bound for $\\sigma^{r}$ is less than or equal to its upper bound:\n$$ -\\sigma_{y} - \\sigma^{e}_{\\text{min}} \\le \\sigma_{y} - \\sigma^{e}_{\\text{max}} $$\nRearranging this inequality to group the elastic and yield stresses, we get:\n$$ \\sigma^{e}_{\\text{max}} - \\sigma^{e}_{\\text{min}} \\le 2\\sigma_{y} $$\nThis is the fundamental condition for shakedown in a symmetric loading cycle. It states that the total range of the purely elastic stress, $\\Delta\\sigma^{e} = \\sigma^{e}_{\\text{max}} - \\sigma^{e}_{\\text{min}}$, must not exceed twice the yield stress.\nLet us now substitute our expressions for $\\sigma^{e}_{\\text{max}}$ and $\\sigma^{e}_{\\text{min}}$:\n$$ (E \\alpha \\Delta T) - (-E \\alpha \\Delta T) \\le 2\\sigma_{y} $$\n$$ 2 E \\alpha \\Delta T \\le 2\\sigma_{y} $$\nSimplifying this inequality gives the condition on the temperature amplitude $\\Delta T$ for shakedown to be possible:\n$$ E \\alpha \\Delta T \\le \\sigma_{y} $$\n$$ \\Delta T \\le \\frac{\\sigma_{y}}{E \\alpha} $$\nThe problem asks for the largest temperature amplitude, $\\Delta T_{\\text{crit}}$, for which shakedown can occur. This corresponds to the boundary case where the inequality becomes an equality.\nTherefore, the critical temperature amplitude is:\n$$ \\Delta T_{\\text{crit}} = \\frac{\\sigma_{y}}{E \\alpha} $$\nIf $\\Delta T > \\Delta T_{\\text{crit}}$, the range of elastic stress $2 E \\alpha \\Delta T$ will be greater than $2\\sigma_{y}$, and it becomes impossible to find a residual stress $\\sigma^r$ that keeps the total stress within the yield limits throughout the cycle. In this case of symmetric, zero-mean loading, the structure will exhibit alternating plasticity, meaning plastic deformation will occur in every cycle, and shakedown will not be achieved.", "answer": "$$\\boxed{\\frac{\\sigma_{y}}{E \\alpha}}$$", "id": "2916218"}, {"introduction": "While Melan's theorem provides a lower bound on the shakedown limit, Koiter's kinematic theorem offers a complementary upper bound. In this exercise, we move from a simple 1D bar to a statically indeterminate portal frame, a common structural element [@problem_id:2684276]. Your task is to apply both the static and kinematic theorems to this system, demonstrating the powerful duality of shakedown analysis and showing how, for certain ideal cases, these two bounds coincide to yield the exact shakedown load multiplier.", "problem": "Consider a single-bay, single-story rigid-jointed portal frame composed of two identical, prismatic columns of height $h$ connected by a rigid beam that has effectively infinite flexural strength. The material behaves as elastic–ideally plastic with a uniform fully plastic bending moment capacity $M_p$ at the potential plastic hinge locations at the tops and bases of both columns. Small displacement kinematics apply, and geometric nonlinearity can be neglected. There is no vertical gravity load.\n\nThe structure is subjected to a quasi-static, zero-mean, repeated horizontal point load applied at the beam level of the form $H(t)=\\lambda\\,H_0\\,s(t)$, where $H_00$ is a given reference load, $\\lambda0$ is an unknown scalar load multiplier, and $s(t)$ is any bounded scalar function satisfying $-1\\le s(t)\\le 1$ for all time $t$ and taking all extreme values in that interval over repeated cycles. Assume associative, rate-independent plasticity with no hardening, and that plastic deformation localizes only as ideal plastic hinges at the column tops and bases.\n\nUsing only the fundamental kinematics of rigid-plastic mechanisms, the principle of virtual work, and the definitions of the Melan static shakedown theorem (lower bound) and the Koiter kinematic shakedown theorem (upper bound), do the following:\n\n- Construct a statically admissible, time-independent residual bending moment field that certifies shakedown by the Melan static shakedown theorem for some maximal $\\lambda$, and derive the corresponding lower bound on $\\lambda$.\n\n- Construct a kinematically admissible, single-parameter plastic mechanism with time-independent shape that is compatible with the frame and the loading set, and use the Koiter kinematic shakedown theorem to derive the corresponding upper bound on $\\lambda$.\n\nShow that the two bounds coincide for this frame and loading, and conclude the exact shakedown multiplier $\\lambda_{\\mathrm{sh}}$ as a closed-form expression in terms of $M_p$, $h$, and $H_0$.\n\nYour final answer must be the single analytic expression for $\\lambda_{\\mathrm{sh}}$. Express your final answer symbolically in terms of $M_p$, $h$, and $H_0$. Do not include units in the final boxed answer.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Structure: Single-bay, single-story rigid-jointed portal frame.\n- Columns: Two identical, prismatic, height $h$.\n- Beam: Rigid, infinite flexural strength.\n- Material Behavior: Elastic–ideally plastic.\n- Plastic Capacity: Uniform fully plastic bending moment $M_p$ at the column tops and bases.\n- Kinematics: Small displacement theory applies; geometric nonlinearity is neglected.\n- Gravity Load: Absent.\n- Loading: Quasi-static, zero-mean, repeated horizontal point load $H(t)=\\lambda\\,H_0\\,s(t)$ at the beam level.\n- Load Parameters: $H_00$ (reference load), $\\lambda0$ (load multiplier), and the time function $s(t)$ is bounded such that $-1 \\le s(t) \\le 1$ for all time $t$, covering all values in this interval.\n- Plasticity Model: Associative, rate-independent, no hardening, with plastic deformation localized at four ideal hinge locations (column tops and bases).\n\n**Step 2: Validate Using Extracted Givens**\n- The problem is **scientifically grounded**. It is a classical problem in the theory of plastic shakedown of structures, utilizing the fundamental theorems of Melan and Koiter. The assumptions (elastic-perfectly plastic material, ideal hinges, rigid beam) are standard idealizations in structural analysis.\n- The problem is **well-posed**. The geometry, material properties, and loading are clearly defined. The objective is to find a specific, unique value, the shakedown multiplier $\\lambda_{\\mathrm{sh}}$.\n- The problem is **objective**. Its language is technical and precise, free from subjective or ambiguous terminology.\n- The problem statement is self-contained and does not contain contradictory information. The idealizations are consistent with the methods (shakedown theorems) required for the solution.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be furnished.\n\n**Analysis of the Elastic Response**\n\nThe portal frame is symmetric in geometry and the loading is applied horizontally at the beam level. The beam is specified as having infinite flexural strength, meaning it is rigid and does not bend. Due to the overall symmetry of the structure and loading, the rigid beam will translate horizontally without rotation. Consequently, the tops of the two columns experience an equal horizontal displacement, $\\Delta(t)$, but no rotation. The column bases are fixed, thus they experience neither translation nor rotation.\n\nEach column, of height $h$, is therefore in a state of double-fixity (fixed at the base, and fixed against rotation at the top) and is subjected to a lateral shear force. The total horizontal load $H(t)$ is distributed equally between the two identical columns, so the shear force in each column is $V(t) = \\frac{H(t)}{2}$.\n\nFor a column of height $h$ that is fixed at both ends and subjected to a shear force $V$, the bending moments induced at the top and bottom ends are equal in magnitude and sense. The relationship between the end moments $M$ and the shear $V$ is given by $M_{top} + M_{base} = V h$. Since $M_{top} = M_{base} = M^E$, we have $2M^E = Vh$, which yields $M^E = \\frac{Vh}{2}$.\n\nSubstituting $V(t) = \\frac{H(t)}{2}$, the elastic bending moment $M^E(t)$ at all four potential plastic hinge locations (top and base of each column) is identical:\n$$ M^E(t) = \\frac{1}{2} \\left( \\frac{H(t)}{2} \\right) h = \\frac{H(t)h}{4} $$\nUsing the given expression for the load, $H(t) = \\lambda H_0 s(t)$, the elastic moment is:\n$$ M^E(t) = \\frac{\\lambda H_0 h}{4} s(t) $$\nSince the function $s(t)$ varies over the interval $[-1, 1]$, the envelope of the elastic bending moment at each of the four locations is:\n$$ M^E_{max} = \\frac{\\lambda H_0 h}{4} $$\n$$ M^E_{min} = -\\frac{\\lambda H_0 h}{4} $$\nThe range of the elastic moment is therefore:\n$$ \\Delta M^E = M^E_{max} - M^E_{min} = \\frac{\\lambda H_0 h}{4} - \\left(-\\frac{\\lambda H_0 h}{4}\\right) = \\frac{\\lambda H_0 h}{2} $$\n\n**Lower Bound on $\\lambda_{\\mathrm{sh}}$ using Melan's Static Theorem**\n\nMelan's theorem states that a structure will shakedown (i.e., respond purely elastically after an initial phase of plastic deformation) if there exists a time-independent, self-equilibrated residual moment field, $M^r$, such that the superposition of the elastic moment $M^E(t)$ and the residual moment $M^r$ does not violate the yield condition at any point and at any time. The yield condition is $|M| \\le M_p$.\n\nThus, for shakedown to occur, we must find a self-equilibrated $M^r$ field such that for each potential hinge location $i$:\n$$ |M^E_i(t) + M^r_i| \\le M_p \\quad \\forall t $$\nSince the elastic moments are identical at all four locations, we can drop the subscript $i$ for $M^E$. The condition is equivalent to the two inequalities:\n$$ M^E_{max} + M^r_i \\le M_p $$\n$$ M^E_{min} + M^r_i \\ge -M_p $$\nSubstituting the expressions for $M^E_{max}$ and $M^E_{min}$:\n$$ \\frac{\\lambda H_0 h}{4} + M^r_i \\le M_p \\implies M^r_i \\le M_p - \\frac{\\lambda H_0 h}{4} $$\n$$ -\\frac{\\lambda H_0 h}{4} + M^r_i \\ge -M_p \\implies M^r_i \\ge -M_p + \\frac{\\lambda H_0 h}{4} $$\nFor a value of $M^r_i$ to exist, the lower bound must be less than or equal to the upper bound:\n$$ -M_p + \\frac{\\lambda H_0 h}{4} \\le M_p - \\frac{\\lambda H_0 h}{4} $$\n$$ \\frac{\\lambda H_0 h}{2} \\le 2 M_p $$\n$$ \\lambda \\le \\frac{4 M_p}{H_0 h} $$\nThis inequality establishes the maximum possible value of $\\lambda$ for which any shakedown solution could exist. To confirm this is an achievable lower bound, we must demonstrate that a valid self-equilibrated residual moment field exists for this value of $\\lambda$.\n\nLet us test the specific load multiplier $\\lambda = \\frac{4 M_p}{H_0 h}$. For this value, the conditions on $M^r_i$ become:\n$$ M^r_i \\le M_p - \\frac{1}{4} \\left(\\frac{4 M_p}{H_0 h}\\right) H_0 h = M_p - M_p = 0 $$\n$$ M^r_i \\ge -M_p + \\frac{1}{4} \\left(\\frac{4 M_p}{H_0 h}\\right) H_0 h = -M_p + M_p = 0 $$\nThese two conditions together require that $M^r_i = 0$ for all four locations $i=1,2,3,4$. The trivial field $M^r_i = 0$ is a valid self-equilibrated residual moment field.\nTherefore, by Melan's theorem, the structure is guaranteed to shakedown for $\\lambda \\le \\frac{4 M_p}{H_0 h}$. This provides the lower bound for the shakedown multiplier:\n$$ \\lambda_{\\mathrm{sh}} \\ge \\frac{4 M_p}{H_0 h} $$\n\n**Upper Bound on $\\lambda_{\\mathrm{sh}}$ using Koiter's Kinematic Theorem**\n\nKoiter's theorem states that shakedown will not occur if a kinematically admissible plastic mechanism can be found for which the work done by the elastic stresses over a cycle of plastic deformation is greater than or equal to the energy dissipated internally by the plastic mechanism. Failure can occur either by incremental collapse (ratcheting) or by alternating plasticity (low-cycle fatigue). Since the applied load is zero-mean, incremental collapse is not the expected failure mode. We investigate failure by alternating plasticity.\n\nAlternating plasticity occurs at a location if the elastic stress (or moment) range exceeds twice the yield strength (or plastic moment capacity). We can formalize this with Koiter's theorem by constructing a suitable plastic deformation cycle.\n\nConsider a kinematically admissible mechanism consisting of a plastic cycle at a single hinge location, for instance, location $1$ (base of the left column). Let this cycle consist of a plastic rotation of $+\\Delta\\theta_p$ followed by a plastic rotation of $-\\Delta\\theta_p$, returning the hinge to its original orientation.\n\nThe total internal energy dissipated during this cycle is:\n$$ D_{cycle} = \\int_{cycle} |M_p d\\theta_p| = M_p |+\\Delta\\theta_p| + M_p |-\\Delta\\theta_p| = 2M_p \\Delta\\theta_p $$\nThe work done by the elastic moment $M_1^E(t)$ during this plastic cycle is $W^E_{cycle} = \\int_{cycle} M_1^E(t) d\\theta_p(t)$. To obtain the upper bound on shakedown (i.e., to find the load at which failure is certain), we consider the most unfavorable scenario where this work is maximized. This occurs when the positive plastic rotation $+\\Delta\\theta_p$ happens precisely when the elastic moment $M_1^E(t)$ is at its maximum value, $M^E_{max}$, and the negative rotation $-\\Delta\\theta_p$ happens when the moment is at its minimum, $M^E_{min}$.\n$$ W^E_{cycle, max} = M^E_{max} (\\Delta\\theta_p) + M^E_{min} (-\\Delta\\theta_p) = (M^E_{max} - M^E_{min}) \\Delta\\theta_p = \\Delta M^E \\Delta\\theta_p $$\nSubstituting the elastic moment range $\\Delta M^E = \\frac{\\lambda H_0 h}{2}$:\n$$ W^E_{cycle, max} = \\frac{\\lambda H_0 h}{2} \\Delta\\theta_p $$\nAccording to Koiter's theorem, shakedown failure is guaranteed if $W^E_{cycle, max} \\ge D_{cycle}$.\n$$ \\frac{\\lambda H_0 h}{2} \\Delta\\theta_p \\ge 2M_p \\Delta\\theta_p $$\nDividing by $\\Delta\\theta_p  0$:\n$$ \\frac{\\lambda H_0 h}{2} \\ge 2M_p \\implies \\lambda \\ge \\frac{4 M_p}{H_0 h} $$\nThis condition provides an upper bound for the shakedown multiplier. The structure will definitely fail if $\\lambda$ is greater than or equal to this value.\n$$ \\lambda_{\\mathrm{sh}} \\le \\frac{4 M_p}{H_0 h} $$\n\n**Conclusion**\n\nThe static (lower bound) analysis via Melan's theorem yielded $\\lambda_{\\mathrm{sh}} \\ge \\frac{4 M_p}{H_0 h}$.\nThe kinematic (upper bound) analysis via Koiter's theorem yielded $\\lambda_{\\mathrm{sh}} \\le \\frac{4 M_p}{H_0 h}$.\n\nSince the lower bound and the upper bound on the shakedown multiplier coincide, we have determined the exact value:\n$$ \\lambda_{\\mathrm{sh}} = \\frac{4 M_p}{H_0 h} $$\nThis value corresponds to the elastic limit of the structure, where the maximum elastic moment equals the plastic moment capacity. For this particular problem with zero-mean cyclic loading, there is no domain of load multipliers where limited plasticity can lead to a favorable residual stress state and subsequent elastic shakedown. Failure occurs by alternating plasticity as soon as the elastic limit is reached.", "answer": "$$\n\\boxed{\\frac{4 M_p}{H_0 h}}\n$$", "id": "2684276"}, {"introduction": "Analytical solutions for shakedown are elegant but are often limited to simple geometries and loading conditions. This final practice bridges the gap between theory and modern computational engineering by formulating the shakedown problem in a numerical framework [@problem_id:2916223]. You will learn how to translate the conditions of the static shakedown theorem into a set of linear constraints, enabling the use of linear programming to find the maximum shakedown load factor for complex, discretized systems. This exercise provides invaluable insight into how shakedown analysis is performed in practice.", "problem": "Consider the static (lower-bound) shakedown verification based on the Melan theorem formulated on a discretized stress space. Let a structure be represented by a vector of stress resultants $s \\in \\mathbb{R}^n$ and a time-independent residual stress $r \\in \\mathbb{R}^n$. Let the admissible stress domain be the polyhedral set $\\{s \\in \\mathbb{R}^n : \\lvert s_i \\rvert \\le \\sigma_y, \\, i = 1,\\dots,n\\}$ for a given yield limit $\\sigma_y  0$ (this is the infinity-norm Tresca-type approximation). Let the equilibrium of the residual stress be represented by a full-rank linear operator $E \\in \\mathbb{R}^{q \\times n}$ such that admissible residual stresses satisfy $E r = 0$. Let the load vary in a convex, compact set whose extreme points are represented by $m$ elastic stress influence vectors $\\{p^{(k)} \\in \\mathbb{R}^n\\}_{k=1}^m$. For a load factor $\\lambda \\ge 0$, the Melan static shakedown condition requires the existence of a residual stress $r$ such that for every extreme load $k \\in \\{1,\\dots,m\\}$,\n$$\nr + \\lambda \\, p^{(k)} \\in \\{s \\in \\mathbb{R}^n : \\lvert s_i \\rvert \\le \\sigma_y, \\, i=1,\\dots,n\\},\n\\quad \\text{and} \\quad E r = 0.\n$$\nBy linearity and convexity, it suffices to check the inequalities at the finite set of extremes.\n\nTask:\n- Derive, from first principles, a linear programming formulation that computes the maximum shakedown load factor $\\lambda^\\star$ and, among all residual stresses that achieve $\\lambda^\\star$, selects a residual stress of minimum $\\ell_1$-norm. You must do so by:\n  1. Formulating a linear program in variables $(r,\\lambda)$ that maximizes $\\lambda$ under equilibrium and yield constraints at the $m$ given load extremes.\n  2. Formulating a second linear program in variables $(r,t)$ that, with $\\lambda$ fixed at the optimal value $\\lambda^\\star$, minimizes $\\sum_{i=1}^n t_i$ subject to $t_i \\ge \\lvert r_i \\rvert$, the same equilibrium constraint, and the same yield constraints evaluated at $\\lambda^\\star$.\n- Your program must implement both linear programs using only the data $(\\sigma_y, E, \\{p^{(k)}\\}_{k=1}^m)$.\n\nMathematical formulation requirements to be encoded by your program:\n- Use residual stress $r \\in \\mathbb{R}^n$ and load factor $\\lambda \\in \\mathbb{R}$ as decision variables for the first linear program. Impose $\\lambda \\ge 0$. For each extreme $k \\in \\{1,\\dots,m\\}$ and component $i \\in \\{1,\\dots,n\\}$, enforce the yield admissibility by the pair of linear inequalities\n$$\nr_i + \\lambda \\, p^{(k)}_i \\le \\sigma_y, \\qquad -r_i - \\lambda \\, p^{(k)}_i \\le \\sigma_y,\n$$\nand impose equilibrium by $E r = 0$. Maximize $\\lambda$.\n- For the second linear program, fix $\\lambda = \\lambda^\\star$ and introduce auxiliary variables $t \\in \\mathbb{R}^n$ with $t_i \\ge 0$ and\n$$\nr_i - t_i \\le 0, \\qquad -r_i - t_i \\le 0,\n$$\nwhich together imply $t_i \\ge \\lvert r_i \\rvert$. Minimize $\\sum_{i=1}^n t_i$ subject to these constraints, $E r = 0$, and the same yield constraints with $\\lambda$ replaced by $\\lambda^\\star$.\n\nImplementation and output:\n- Implement a program that, for each test case below, returns the pair $[\\lambda^\\star, \\|r^\\star\\|_1]$, where $\\lambda^\\star$ is the optimal load factor of the first linear program and $\\|r^\\star\\|_1$ is the optimal value of $\\sum_{i=1}^n t_i$ from the second linear program at $\\lambda^\\star$.\n- Your program must output a single line containing the results as a comma-separated list of lists, one per test case, with each floating-point number rounded to $6$ decimal places, for example, $\\big[\\,[\\lambda_1^\\star,\\|r_1^\\star\\|_1],[\\lambda_2^\\star,\\|r_2^\\star\\|_1]\\,\\big]$.\n\nTest suite:\n- Use three cases, each specified by $(n,m,\\sigma_y,E,\\{p^{(k)}\\}_{k=1}^m)$:\n  1. Case A (happy path, symmetric extremes): $n = 2$, $m = 2$, $\\sigma_y = 1$, $E = \\begin{bmatrix} 1  1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$.\n  2. Case B (scaling and coupling via equilibrium): $n = 2$, $m = 2$, $\\sigma_y = \\tfrac{3}{2}$, $E = \\begin{bmatrix} 1  -1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$.\n  3. Case C (asymmetric extremes requiring nontrivial residual stress): $n = 2$, $m = 2$, $\\sigma_y = 1$, $E = \\begin{bmatrix} 1  1 \\end{bmatrix}$, $p^{(1)} = \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix}$, $p^{(2)} = \\begin{bmatrix} -1 \\\\ 2 \\end{bmatrix}$.\n\nFinal output format:\n- The program must print exactly one line: a single list of three entries, each entry being the list $[\\lambda^\\star,\\|r^\\star\\|_1]$ for a case, with no spaces, and each number rounded to $6$ decimals, i.e., $\\big[\\,[\\lambda_A^\\star,\\|r_A^\\star\\|_1],[\\lambda_B^\\star,\\|r_B^\\star\\|_1],[\\lambda_C^\\star,\\|r_C^\\star\\|_1]\\,\\big]$.", "solution": "We begin from the Melan static shakedown theorem, which states that a structure subjected to variable loads drawn from a convex, compact load domain will shake down (no further plastic deformation in the long run) if there exists a time-independent, self-equilibrated residual stress $r$ such that, for all admissible load histories, the total stress remains in the elastic domain. In a discretized setting, the elastic stress response to a load can be represented as $p \\in \\mathbb{R}^n$, and the admissible stress domain is a convex set $Y \\subset \\mathbb{R}^n$. The static (lower bound) statement ensures shake-down if there exists $r$ with $E r = 0$ such that for all $p$ in the convex load set, $r + \\lambda p \\in Y$ for some maximum $\\lambda$. Because the set of loads is convex and the constraint $r + \\lambda p \\in Y$ is convex in $p$, it suffices to check the finitely many extreme points $\\{p^{(k)}\\}_{k=1}^m$.\n\nTo obtain a linear or second-order cone program, we must select $Y$ as a convex set with tractable inequalities. If we choose the von Mises (J$_2$) yield domain, the condition $\\|r + \\lambda p^{(k)}\\|_2 \\le \\sigma_y$ is second-order cone representable. To stay within linear programming, we adopt the polyhedral Tresca/infinity-norm approximation:\n$$\nY = \\{ s \\in \\mathbb{R}^n : -\\sigma_y \\le s_i \\le \\sigma_y, \\, i=1,\\dots,n \\}.\n$$\nThen, enforcing $r + \\lambda p^{(k)} \\in Y$ is equivalent to the pair of linear inequalities for each component $i$ and extreme $k$:\n$$\nr_i + \\lambda p^{(k)}_i \\le \\sigma_y, \\qquad -r_i - \\lambda p^{(k)}_i \\le \\sigma_y.\n$$\nIn addition, $r$ must be self-equilibrated, encoded by the linear equations $E r = 0$.\n\nFirst linear program (maximize load factor). Collect the decision variables as $(r,\\lambda) \\in \\mathbb{R}^{n+1}$ and impose $\\lambda \\ge 0$. The linear program is\n$$\n\\begin{aligned}\n\\max_{r \\in \\mathbb{R}^n,\\, \\lambda \\in \\mathbb{R}} \\  \\lambda \\\\\n\\text{subject to } \\  r_i + \\lambda p^{(k)}_i \\le \\sigma_y, \\quad i=1,\\dots,n,\\ k=1,\\dots,m, \\\\\n -r_i - \\lambda p^{(k)}_i \\le \\sigma_y, \\quad i=1,\\dots,n,\\ k=1,\\dots,m, \\\\\n E r = 0, \\\\\n \\lambda \\ge 0,\n\\end{aligned}\n$$\nwith $r$ free. Because the constraints for different $k$ couple the same $r$ to different $\\lambda p^{(k)}$, and $E r = 0$ restricts $r$, the problem is well-posed and bounded for nontrivial sets of $\\{p^{(k)}\\}$.\n\nSecond linear program (minimal $\\ell_1$-norm residual stress at $\\lambda^\\star$). Fix $\\lambda = \\lambda^\\star$ obtained from the first program and introduce auxiliary variables $t \\in \\mathbb{R}^n$ with $t_i \\ge 0$ and $t_i \\ge \\lvert r_i \\rvert$. The standard linearization uses\n$$\nr_i - t_i \\le 0, \\qquad -r_i - t_i \\le 0, \\qquad t_i \\ge 0,\n$$\nwhich implies $t_i \\ge \\lvert r_i \\rvert$ and hence $\\sum_i t_i \\ge \\sum_i \\lvert r_i \\rvert = \\|r\\|_1$. Minimizing $\\sum_i t_i$ achieves the minimal $\\ell_1$-norm residual among all residual stresses that sustain $\\lambda^\\star$. The linear program is\n$$\n\\begin{aligned}\n\\min_{r \\in \\mathbb{R}^n,\\, t \\in \\mathbb{R}^n} \\  \\sum_{i=1}^n t_i \\\\\n\\text{subject to } \\  r_i + \\lambda^\\star p^{(k)}_i \\le \\sigma_y, \\quad i=1,\\dots,n,\\ k=1,\\dots,m, \\\\\n -r_i - \\lambda^\\star p^{(k)}_i \\le \\sigma_y, \\quad i=1,\\dots,n,\\ k=1,\\dots,m, \\\\\n r_i - t_i \\le 0, \\quad -r_i - t_i \\le 0, \\quad t_i \\ge 0, \\quad i=1,\\dots,n, \\\\\n E r = 0.\n\\end{aligned}\n$$\n\nAlgorithmic translation:\n- Assemble the inequality matrices for the yield constraints by stacking, for each $k$ and $i$, a row with coefficients on $r_i$ and $\\lambda$ equal to $1$ and $p^{(k)}_i$, respectively, and another with $-1$ and $-p^{(k)}_i$, respectively. The right-hand side is $\\sigma_y$ in both cases.\n- For the first linear program, use objective vector $c = [0,\\dots,0,-1]$ to minimize $- \\lambda$ (which maximizes $\\lambda$).\n- For the second linear program, fix $\\lambda = \\lambda^\\star$ as a constant and assemble inequalities for the variables $(r,t)$ capturing both yield and absolute value linearizations, with objective $c = [0,\\dots,0,1,\\dots,1]$ summing the $t_i$.\n- Enforce $E r = 0$ as equality constraints in both programs.\n- Solve the linear programs using a reliable linear programming solver. The SciPy routine for linear programming supports these via the HiGHS backends.\n\nTest suite reasoning and coverage:\n- Case A uses symmetric extremes and a single equilibrium constraint $r_1 + r_2 = 0$, which produces a clear, bounded maximum load factor $\\lambda^\\star$ and demonstrates how multiple extremes couple a single $r$.\n- Case B scales the yield limit to $\\sigma_y = \\tfrac{3}{2}$ and uses $E r = 0$ in the form $r_1 - r_2 = 0$, exploring how the equilibrium space modifies the admissible residuals and showing the expected linear scaling of $\\lambda^\\star$ with $\\sigma_y$ in this discrete setting.\n- Case C uses asymmetric extremes $p^{(1)}$ and $p^{(2)}$ with the same equilibrium constraint as Case A, designed to require a nontrivial residual stress to achieve the maximal $\\lambda^\\star$, thereby exercising the second linear program.\n\nOutput specification:\n- For each case, report the pair $[\\lambda^\\star,\\|r^\\star\\|_1]$ as floats, rounded to $6$ decimals, and aggregate them into a single list printed on one line with no spaces: $\\big[\\,[\\lambda_A^\\star,\\|r_A^\\star\\|_1],[\\lambda_B^\\star,\\|r_B^\\star\\|_1],[\\lambda_C^\\star,\\|r_C^\\star\\|_1]\\,\\big]$.\n\nThe above formulation strictly follows from the linearized Melan static theorem applied to a discretized stress model, uses only fundamental definitions of equilibrium and yield admissibility, and leverages convexity to restrict verification to a finite set of load extremes. The resulting programs are linear, hence solvable efficiently and robustly for the small-dimensional test suite specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_case_sigma_E_P(sigma_y, E, P_list):\n    \"\"\"\n    Solve the two-stage shakedown LP:\n    Stage 1: maximize lambda subject to yield constraints at extremes and equilibrium E r = 0\n    Stage 2: with lambda* fixed, minimize ||r||_1 using standard LP linearization with t = |r|\n    Inputs:\n        sigma_y: float  0\n        E: (q, n) numpy array\n        P_list: list of m numpy arrays of shape (n,) representing elastic stress influence at extremes\n    Returns:\n        lambda_star: float\n        l1_min: float (sum of t_i at optimum, equals minimal ||r||_1)\n    \"\"\"\n    # Dimensions\n    n = P_list[0].shape[0]\n    m = len(P_list)\n    q = E.shape[0] if E is not None and E.size  0 else 0\n\n    # Stage 1: LP in variables x = [r (n), lambda (1)]\n    # Build inequality constraints A_ub x = b_ub for yield at each extreme\n    A_ub = []\n    b_ub = []\n    for k in range(m):\n        p_k = P_list[k].reshape(-1)\n        for i in range(n):\n            # r_i + lambda * p_k[i] = sigma_y\n            row = np.zeros(n + 1)\n            row[i] = 1.0\n            row[-1] = p_k[i]\n            A_ub.append(row)\n            b_ub.append(sigma_y)\n            # -r_i - lambda * p_k[i] = sigma_y\n            row = np.zeros(n + 1)\n            row[i] = -1.0\n            row[-1] = -p_k[i]\n            A_ub.append(row)\n            b_ub.append(sigma_y)\n    A_ub = np.array(A_ub) if A_ub else None\n    b_ub = np.array(b_ub) if b_ub else None\n\n    # Equality constraints: E r = 0\n    if q  0:\n        A_eq = np.zeros((q, n + 1))\n        A_eq[:, :n] = E\n        b_eq = np.zeros(q)\n    else:\n        A_eq = None\n        b_eq = None\n\n    # Variable bounds: r free, lambda = 0\n    bounds = [(None, None)] * n + [(0.0, None)]\n\n    # Objective: minimize -lambda\n    c = np.zeros(n + 1)\n    c[-1] = -1.0\n\n    res1 = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method=\"highs\")\n    if not res1.success:\n        # In unexpected failure cases, return NaNs to signal an issue.\n        return float(\"nan\"), float(\"nan\")\n\n    x_star = res1.x\n    lambda_star = x_star[-1]\n\n    # Stage 2: LP in variables y = [r (n), t (n)]\n    # Fix lambda = lambda_star in the yield constraints (becomes a constant RHS shift)\n    A_ub2 = []\n    b_ub2 = []\n\n    for k in range(m):\n        p_k = P_list[k].reshape(-1)\n        for i in range(n):\n            # r_i + lambda_star * p_k[i] = sigma_y\n            row = np.zeros(2 * n)\n            row[i] = 1.0  # r_i\n            # no coefficient on t here\n            A_ub2.append(row)\n            b_ub2.append(sigma_y - lambda_star * p_k[i])\n            # -r_i - lambda_star * p_k[i] = sigma_y  -  -r_i = sigma_y + lambda_star * p_k[i]\n            row = np.zeros(2 * n)\n            row[i] = -1.0  # -r_i\n            A_ub2.append(row)\n            b_ub2.append(sigma_y + lambda_star * p_k[i])\n\n    # Absolute value linearization: r_i - t_i = 0 and -r_i - t_i = 0, and t_i = 0\n    for i in range(n):\n        row = np.zeros(2 * n)\n        row[i] = 1.0      # r_i\n        row[n + i] = -1.0 # -t_i\n        A_ub2.append(row)\n        b_ub2.append(0.0)\n\n        row = np.zeros(2 * n)\n        row[i] = -1.0     # -r_i\n        row[n + i] = -1.0 # -t_i\n        A_ub2.append(row)\n        b_ub2.append(0.0)\n\n    A_ub2 = np.array(A_ub2) if A_ub2 else None\n    b_ub2 = np.array(b_ub2) if b_ub2 else None\n\n    # Equality constraints: E r = 0\n    if q  0:\n        A_eq2 = np.zeros((q, 2 * n))\n        A_eq2[:, :n] = E\n        b_eq2 = np.zeros(q)\n    else:\n        A_eq2 = None\n        b_eq2 = None\n\n    # Bounds: r free, t = 0\n    bounds2 = [(None, None)] * n + [(0.0, None)] * n\n\n    # Objective: minimize sum t_i\n    c2 = np.zeros(2 * n)\n    c2[n:] = 1.0\n\n    res2 = linprog(c2, A_ub=A_ub2, b_ub=b_ub2, A_eq=A_eq2, b_eq=b_eq2, bounds=bounds2, method=\"highs\")\n    if not res2.success:\n        return float(lambda_star), float(\"nan\")\n\n    y_star = res2.x\n    t_star = y_star[n:]\n    l1_min = float(np.sum(t_star))\n\n    return float(lambda_star), float(l1_min)\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Case A\n    sigma_A = 1.0\n    E_A = np.array([[1.0, 1.0]])\n    P_A = [np.array([1.0, 0.0]), np.array([0.0, 1.0])]\n\n    # Case B\n    sigma_B = 1.5\n    E_B = np.array([[1.0, -1.0]])\n    P_B = [np.array([1.0, 1.0]), np.array([1.0, -1.0])]\n\n    # Case C\n    sigma_C = 1.0\n    E_C = np.array([[1.0, 1.0]])\n    P_C = [np.array([2.0, -1.0]), np.array([-1.0, 2.0])]\n\n    test_cases = [\n        (sigma_A, E_A, P_A),\n        (sigma_B, E_B, P_B),\n        (sigma_C, E_C, P_C),\n    ]\n\n    results = []\n    for sigma_y, E, P_list in test_cases:\n        lam_star, l1_norm = solve_case_sigma_E_P(sigma_y, E, P_list)\n        # Round to 6 decimals for output\n        lam_star = float(np.round(lam_star, 6)) if np.isfinite(lam_star) else lam_star\n        l1_norm = float(np.round(l1_norm, 6)) if np.isfinite(l1_norm) else l1_norm\n        results.append((lam_star, l1_norm))\n\n    # Final print statement in the exact required format: no spaces, numbers with 6 decimals.\n    formatted = []\n    for lam, nrm in results:\n        if np.isnan(lam) or np.isnan(nrm):\n            # Represent NaNs in a consistent float format with 6 decimals\n            lam_str = \"nan\"\n            nrm_str = \"nan\"\n        else:\n            lam_str = f\"{lam:.6f}\"\n            nrm_str = f\"{nrm:.6f}\"\n        formatted.append(f\"[{lam_str},{nrm_str}]\")\n    print(f\"[{','.join(formatted)}]\")\n\nsolve()\n```", "id": "2916223"}]}