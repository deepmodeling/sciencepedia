{"hands_on_practices": [{"introduction": "This practice serves as a foundational exercise in translating physical material properties into the mathematical framework of linear elasticity. You will construct the full $6 \\times 6$ compliance matrix for an orthotropic material using its engineering constants, a critical first step in analyzing anisotropic solids [@problem_id:2696799]. This process reinforces the relationship between measurable quantities like Young's modulus and the components of the fourth-order compliance tensor.", "problem": "A homogeneous, linearly elastic, orthotropic solid is aligned with an orthonormal material basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ such that the principal material directions coincide with the coordinate axes. Let the elastic description be given by the fourth-order compliance tensor $\\boldsymbol{S}$ in the small-strain, small-stress regime so that the generalized Hooke’s law reads $\\varepsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}$. Adopt Voigt notation with the ordering $\\{11,22,33,23,31,12\\}$ and use engineering shear strains, namely $\\gamma_{23}=2\\varepsilon_{23}$, $\\gamma_{31}=2\\varepsilon_{31}$, and $\\gamma_{12}=2\\varepsilon_{12}$. The independent orthotropic elastic constants are prescribed as follows: Young’s moduli $E_{1}=150\\,\\mathrm{GPa}$, $E_{2}=100\\,\\mathrm{GPa}$, $E_{3}=80\\,\\mathrm{GPa}$, shear moduli $G_{23}=40\\,\\mathrm{GPa}$, $G_{31}=35\\,\\mathrm{GPa}$, $G_{12}=50\\,\\mathrm{GPa}$, and principal Poisson’s ratios $\\nu_{12}=0.25$, $\\nu_{23}=0.30$, $\\nu_{31}=0.28$.\n\nStarting from the general linear elastic relation and the definition of orthotropy in its principal axes, and invoking the reciprocity/symmetry condition that follows from the Maxwell–Betti theorem for linear elastic materials, derive the structure of the compliance matrix in Voigt form for an orthotropic solid under the stated engineering shear convention. Then, using the given data, assemble the full $6\\times 6$ compliance matrix $[\\mathbf{S}]$ in Voigt notation.\n\nExpress each entry of the final matrix numerically in units of $\\mathrm{GPa}^{-1}$. Round each matrix entry to four significant figures. Provide your final answer as the $6\\times 6$ matrix.", "solution": "The constitutive relation for a linearly elastic material is the generalized Hooke's law, which relates the second-order strain tensor $\\boldsymbol{\\varepsilon}$ to the second-order stress tensor $\\boldsymbol{\\sigma}$ via the fourth-order compliance tensor $\\boldsymbol{S}$:\n$$\n\\varepsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}\n$$\nwhere summation over repeated indices $k$ and $l$ is implied. For a homogeneous orthotropic material with its principal material directions aligned with the axes of an orthonormal basis $\\{\\mathbf{e}_1, \\mathbf{e}_2, \\mathbf{e}_3\\}$, the constitutive relations for the components of the strain tensor can be written in terms of the engineering elastic constants as follows:\n$$\n\\varepsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}\\sigma_{22} - \\frac{\\nu_{31}}{E_3}\\sigma_{33}\n$$\n$$\n\\varepsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}\\sigma_{22} - \\frac{\\nu_{32}}{E_3}\\sigma_{33}\n$$\n$$\n\\varepsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}\\sigma_{22} + \\frac{1}{E_3}\\sigma_{33}\n$$\nFor the shear components, the tensorial shear strains are related to the shear stresses by:\n$$\n\\varepsilon_{23} = \\frac{1}{2G_{23}}\\sigma_{23}, \\quad \\varepsilon_{31} = \\frac{1}{2G_{31}}\\sigma_{31}, \\quad \\varepsilon_{12} = \\frac{1}{2G_{12}}\\sigma_{12}\n$$\nThe problem requires the use of Voigt notation with engineering shear strains. The stress and strain vectors, $\\{\\boldsymbol{\\sigma}\\}$ and $\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}}$, are defined as:\n$$\n\\{\\boldsymbol{\\sigma}\\} = \\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\\\ \\sigma_{23} \\\\ \\sigma_{31} \\\\ \\sigma_{12} \\end{pmatrix}, \\quad \\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = \\begin{pmatrix} \\varepsilon_1 \\\\ \\varepsilon_2 \\\\ \\varepsilon_3 \\\\ \\varepsilon_4 \\\\ \\varepsilon_5 \\\\ \\varepsilon_6 \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ \\gamma_{23} \\\\ \\gamma_{31} \\\\ \\gamma_{12} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ 2\\varepsilon_{23} \\\\ 2\\varepsilon_{31} \\\\ 2\\varepsilon_{12} \\end{pmatrix}\n$$\nIn this notation, the constitutive law is written in matrix form: $\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = [\\mathbf{S}] \\{\\boldsymbol{\\sigma}\\}$, where $[\\mathbf{S}]$ is the $6 \\times 6$ compliance matrix. For an orthotropic material aligned with the coordinate axes, this matrix takes a specific block-diagonal form:\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} & 0 & 0 & 0 \\\\\nS_{21} & S_{22} & S_{23} & 0 & 0 & 0 \\\\\nS_{31} & S_{32} & S_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & S_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & S_{55} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & S_{66}\n\\end{pmatrix}\n$$\nThe existence of a strain energy density function (a consequence of the material being elastic, not merely hypoelastic) implies the major symmetry of the compliance tensor, $S_{ijkl} = S_{klij}$. This condition, a result of the Maxwell-Betti reciprocity theorem applied to a material element, ensures that the compliance matrix $[\\mathbf{S}]$ is symmetric, i.e., $S_{IJ} = S_{JI}$.\n\nBy comparing the matrix equation $\\{\\boldsymbol{\\varepsilon}\\}_{\\text{eng}} = [\\mathbf{S}] \\{\\boldsymbol{\\sigma}\\}$ with the component-wise constitutive equations, we can identify the entries of $[\\mathbf{S}]$.\nFor the normal components:\n$$\n\\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\end{pmatrix}\n=\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} \\\\\nS_{21} & S_{22} & S_{23} \\\\\nS_{31} & S_{32} & S_{33}\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{21}}{E_2} & -\\frac{\\nu_{31}}{E_3} \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{32}}{E_3} \\\\\n-\\frac{\\nu_{13}}{E_1} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3}\n\\end{pmatrix}\n\\begin{pmatrix} \\sigma_{11} \\\\ \\sigma_{22} \\\\ \\sigma_{33} \\end{pmatrix}\n$$\nThe symmetry of the matrix, $S_{IJ}=S_{JI}$, imposes the following constraints on the Poisson's ratios:\n$S_{12} = S_{21} \\implies -\\frac{\\nu_{21}}{E_2} = -\\frac{\\nu_{12}}{E_1} \\implies \\frac{\\nu_{12}}{E_1} = \\frac{\\nu_{21}}{E_2}$\n$S_{13} = S_{31} \\implies -\\frac{\\nu_{31}}{E_3} = -\\frac{\\nu_{13}}{E_1} \\implies \\frac{\\nu_{13}}{E_1} = \\frac{\\nu_{31}}{E_3}$\n$S_{23} = S_{32} \\implies -\\frac{\\nu_{32}}{E_3} = -\\frac{\\nu_{23}}{E_2} \\implies \\frac{\\nu_{23}}{E_2} = \\frac{\\nu_{32}}{E_3}$\nUsing these symmetry relations and the provided independent constants ($\\nu_{12}$, $\\nu_{23}$, $\\nu_{31}$), we can write the upper-left $3 \\times 3$ sub-matrix of $[\\mathbf{S}]$ as:\n$$\n\\begin{pmatrix}\nS_{11} & S_{12} & S_{13} \\\\\nS_{21} & S_{22} & S_{23} \\\\\nS_{31} & S_{32} & S_{33}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{12}}{E_1} & -\\frac{\\nu_{31}}{E_3} \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{23}}{E_2} \\\\\n-\\frac{\\nu_{31}}{E_3} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3}\n\\end{pmatrix}\n$$\nFor the shear components, using the engineering shear strain definition:\n$\\varepsilon_4 = \\gamma_{23} = 2\\varepsilon_{23} = 2 \\left( \\frac{1}{2G_{23}}\\sigma_{23} \\right) = \\frac{1}{G_{23}}\\sigma_{23}$.\nFrom the Voigt form, we have $\\varepsilon_4 = S_{44}\\sigma_4 = S_{44}\\sigma_{23}$.\nComparing these, we find $S_{44} = \\frac{1}{G_{23}}$.\nBy identical reasoning for the other shear components:\n$S_{55} = \\frac{1}{G_{31}}$\n$S_{66} = \\frac{1}{G_{12}}$\nCombining these results, the complete symbolic compliance matrix is:\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{12}}{E_1} & -\\frac{\\nu_{31}}{E_3} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{23}}{E_2} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{31}}{E_3} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1}{G_{23}} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\frac{1}{G_{31}} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1}{G_{12}}\n\\end{pmatrix}\n$$\nWe now substitute the provided numerical values: $E_1=150\\,\\mathrm{GPa}$, $E_2=100\\,\\mathrm{GPa}$, $E_3=80\\,\\mathrm{GPa}$, $G_{23}=40\\,\\mathrm{GPa}$, $G_{31}=35\\,\\mathrm{GPa}$, $G_{12}=50\\,\\mathrm{GPa}$, $\\nu_{12}=0.25$, $\\nu_{23}=0.30$, $\\nu_{31}=0.28$. The units of the compliance matrix entries will be $\\mathrm{GPa}^{-1}$.\n\n$S_{11} = \\frac{1}{150} \\approx 0.0066666... \\to 0.006667$\n$S_{22} = \\frac{1}{100} = 0.01000$\n$S_{33} = \\frac{1}{80} = 0.01250$\n$S_{12} = S_{21} = -\\frac{0.25}{150} \\approx -0.0016666... \\to -0.001667$\n$S_{13} = S_{31} = -\\frac{0.28}{80} = -0.003500$\n$S_{23} = S_{32} = -\\frac{0.30}{100} = -0.003000$\n$S_{44} = \\frac{1}{40} = 0.02500$\n$S_{55} = \\frac{1}{35} \\approx 0.0285714... \\to 0.02857$\n$S_{66} = \\frac{1}{50} = 0.02000$\n\nAll off-diagonal entries not in the upper-left $3 \\times 3$ block or on the main diagonal are zero. Assembling the final matrix with entries rounded to four significant figures:\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\n0.006667 & -0.001667 & -0.003500 & 0 & 0 & 0 \\\\\n-0.001667 & 0.01000 & -0.003000 & 0 & 0 & 0 \\\\\n-0.003500 & -0.003000 & 0.01250 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0.02500 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0.02857 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0.02000\n\\end{pmatrix}\n$$\nThis is the final numerical representation of the compliance matrix $[\\mathbf{S}]$ in $\\mathrm{GPa}^{-1}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.006667 & -0.001667 & -0.003500 & 0 & 0 & 0 \\\\\n-0.001667 & 0.01000 & -0.003000 & 0 & 0 & 0 \\\\\n-0.003500 & -0.003000 & 0.01250 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0.02500 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0.02857 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0.02000\n\\end{pmatrix}\n}\n$$", "id": "2696799"}, {"introduction": "With the compliance matrix defined, we can now use it to predict a material's deformation under applied loads. This exercise demonstrates a direct application of the orthotropic constitutive law by calculating the longitudinal and lateral strains in a material subjected to a simple uniaxial stress [@problem_id:2696784]. Solving this problem provides concrete insight into how anisotropy governs material response, particularly the role of Young's moduli and Poisson's ratios in different directions.", "problem": "An orthotropic, linearly elastic solid has principal material axes aligned with the Cartesian coordinates $x_{1}$, $x_{2}$, and $x_{3}$. The constitutive relation is given by the fourth-order compliance tensor $\\boldsymbol{S}$ via $\\varepsilon_{ij}=\\boldsymbol{S}_{ijkl}\\,\\sigma_{kl}$, where $\\varepsilon_{ij}$ is the small-strain tensor and $\\sigma_{ij}$ is the Cauchy stress tensor. The material’s engineering constants (along the orthotropic axes) are:\n- Young’s moduli: $E_{1}=160\\ \\mathrm{GPa}$, $E_{2}=12\\ \\mathrm{GPa}$, $E_{3}=12\\ \\mathrm{GPa}$,\n- Poisson ratios: $\\nu_{12}=0.30$, $\\nu_{13}=0.25$, $\\nu_{23}=0.35$,\n- Shear moduli: $G_{12}=5\\ \\mathrm{GPa}$, $G_{31}=5\\ \\mathrm{GPa}$, $G_{23}=4\\ \\mathrm{GPa}$.\n\nAssume the standard orthotropic symmetry and reciprocal relations hold (so that the compliance tensor has the usual major and minor symmetries). The solid is subjected to a uniaxial stress state with $\\sigma_{11}=200\\ \\mathrm{MPa}$ and all other stress components zero, i.e., $\\sigma_{22}=\\sigma_{33}=\\sigma_{23}=\\sigma_{31}=\\sigma_{12}=0$.\n\nUsing the fourth-order compliance tensor for an orthotropic linear elastic material in its principal directions, determine the longitudinal strain $\\varepsilon_{11}$ and the lateral strains $\\varepsilon_{22}$ and $\\varepsilon_{33}$.\n\nAnswer specification:\n- Express each strain as a dimensionless decimal.\n- Round each strain to four significant figures.", "solution": "The constitutive relations for a linearly elastic, orthotropic material with its principal axes aligned with the coordinate axes are given by:\n$$ \\varepsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}\\sigma_{22} - \\frac{\\nu_{31}}{E_3}\\sigma_{33} $$\n$$ \\varepsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}\\sigma_{22} - \\frac{\\nu_{32}}{E_3}\\sigma_{33} $$\n$$ \\varepsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}\\sigma_{22} + \\frac{1}{E_3}\\sigma_{33} $$\n$$ \\gamma_{23} = 2\\varepsilon_{23} = \\frac{1}{G_{23}}\\sigma_{23} $$\n$$ \\gamma_{31} = 2\\varepsilon_{31} = \\frac{1}{G_{31}}\\sigma_{31} $$\n$$ \\gamma_{12} = 2\\varepsilon_{12} = \\frac{1}{G_{12}}\\sigma_{12} $$\nThe symmetry of the compliance tensor requires the reciprocal relations to hold: $\\frac{\\nu_{ij}}{E_i} = \\frac{\\nu_{ji}}{E_j}$.\n\nThe problem specifies a state of uniaxial stress in the $x_1$ direction. The stress tensor components are:\n$$ \\sigma_{11} = 200\\ \\mathrm{MPa} = 200 \\times 10^6\\ \\mathrm{Pa} $$\n$$ \\sigma_{22} = \\sigma_{33} = \\sigma_{23} = \\sigma_{31} = \\sigma_{12} = 0 $$\nSubstituting these stress components into the constitutive equations for the normal strains yields a significant simplification:\nFor the longitudinal strain $\\varepsilon_{11}$:\n$$ \\varepsilon_{11} = \\frac{1}{E_1}\\sigma_{11} - \\frac{\\nu_{21}}{E_2}(0) - \\frac{\\nu_{31}}{E_3}(0) = \\frac{\\sigma_{11}}{E_1} $$\nFor the lateral strain $\\varepsilon_{22}$:\n$$ \\varepsilon_{22} = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} + \\frac{1}{E_2}(0) - \\frac{\\nu_{32}}{E_3}(0) = -\\frac{\\nu_{12}}{E_1}\\sigma_{11} = -\\nu_{12} \\varepsilon_{11} $$\nFor the lateral strain $\\varepsilon_{33}$:\n$$ \\varepsilon_{33} = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} - \\frac{\\nu_{23}}{E_2}(0) + \\frac{1}{E_3}(0) = -\\frac{\\nu_{13}}{E_1}\\sigma_{11} = -\\nu_{13} \\varepsilon_{11} $$\nNotice that only $E_1$, $\\nu_{12}$, and $\\nu_{13}$ are required for this specific calculation. The other constants are extraneous for this particular load case.\n\nNow, we substitute the given numerical values:\n$E_1 = 160\\ \\mathrm{GPa} = 160 \\times 10^9\\ \\mathrm{Pa}$\n$\\sigma_{11} = 200\\ \\mathrm{MPa} = 200 \\times 10^6\\ \\mathrm{Pa}$\n$\\nu_{12} = 0.30$\n$\\nu_{13} = 0.25$\n\nCalculate the longitudinal strain $\\varepsilon_{11}$:\n$$ \\varepsilon_{11} = \\frac{200 \\times 10^6\\ \\mathrm{Pa}}{160 \\times 10^9\\ \\mathrm{Pa}} = \\frac{200}{160000} = \\frac{1}{800} = 0.00125 $$\nCalculate the lateral strain $\\varepsilon_{22}$:\n$$ \\varepsilon_{22} = -\\nu_{12} \\times \\varepsilon_{11} = -0.30 \\times 0.00125 = -0.000375 $$\nCalculate the lateral strain $\\varepsilon_{33}$:\n$$ \\varepsilon_{33} = -\\nu_{13} \\times \\varepsilon_{11} = -0.25 \\times 0.00125 = -0.0003125 $$\nThe problem demands the answers be rounded to four significant figures.\n- For $\\varepsilon_{11} = 0.00125$, the four significant figure representation is $0.001250$.\n- For $\\varepsilon_{22} = -0.000375$, the four significant figure representation is $-0.0003750$.\n- For $\\varepsilon_{33} = -0.0003125$, the value already has four significant figures ($3, 1, 2, 5$).\n\nThus, the final values for the strains are:\n$\\varepsilon_{11} = 0.001250$\n$\\varepsilon_{22} = -0.0003750$\n$\\varepsilon_{33} = -0.0003125$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.001250 & -0.0003750 & -0.0003125\n\\end{pmatrix}\n}\n$$", "id": "2696784"}, {"introduction": "Moving from analytical calculation to computational mechanics, this final practice addresses the efficient implementation of constitutive laws. You will write code to perform the tensor contraction $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$, explicitly leveraging the symmetries of the compliance and stress tensors to optimize the computation [@problem_id:2696786]. This task highlights the practical importance of tensor symmetries in numerical methods like the Finite Element Method, where such operations are performed billions of times.", "problem": "You are to implement the contraction between a fourth-order compliance tensor and a symmetric stress tensor in three-dimensional elasticity, exploiting tensor symmetries to avoid redundant computations. The mathematical goal is to compute the small-strain tensor $\\boldsymbol{\\varepsilon}$ from a given compliance tensor $\\boldsymbol{S}$ and a given Cauchy stress tensor $\\boldsymbol{\\sigma}$ via the relation $\\boldsymbol{\\varepsilon} = \\boldsymbol{S} : \\boldsymbol{\\sigma}$. The implementation must explicitly use component loops and exploit symmetries to minimize arithmetic work.\n\nStart from the following fundamental base:\n- In the small-strain, linear-elastic regime, the constitutive equation can be written as $\\varepsilon_{ij} = S_{ijkl}\\,\\sigma_{kl}$, where $S_{ijkl}$ is the fourth-order compliance tensor and $\\sigma_{kl}$ is the Cauchy stress tensor.\n- Balance of angular momentum implies $\\sigma_{ij} = \\sigma_{ji}$, that is, $\\boldsymbol{\\sigma}$ is symmetric.\n- For linear elastic materials derivable from a strain energy density, the fourth-order compliance tensor has both minor and major symmetries: $S_{ijkl} = S_{jikl} = S_{ijlk} = S_{klij}$.\n- For an isotropic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$, a standard, well-tested representation of the compliance tensor is\n$$\nS_{ijkl} \\;=\\; \\frac{1+\\nu}{2E}\\,\\big(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}\\big)\\;-\\;\\frac{\\nu}{E}\\,\\delta_{ij}\\delta_{kl},\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\nTask requirements:\n1. Implement a baseline “naive” contraction using explicit loops that directly evaluates\n$$\n\\varepsilon_{ij}^{\\mathrm{naive}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\,\\sigma_{kl}.\n$$\n2. Implement an “efficient” contraction using explicit loops that exploits the symmetries $\\sigma_{kl}=\\sigma_{lk}$ and $S_{ijkl}=S_{ijlk}$ to avoid redundant computations by summing only over $k\\le l$ with appropriate weights:\n$$\n\\varepsilon_{ij}^{\\mathrm{eff}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=k}^{3} w_{kl}\\,S_{ijkl}\\,\\sigma_{kl}, \\quad \\text{where} \\quad\nw_{kl} \\;=\\; \\begin{cases}\n1, & k=l,\\\\\n2, & k<l.\n\\end{cases}\n$$\nFurther exploit $\\varepsilon_{ij}=\\varepsilon_{ji}$ to compute only the upper-triangular components $i\\le j$ and mirror them to the lower triangle.\n\n3. For numerical instantiation, construct the components $S_{ijkl}$ from $E$ and $\\nu$ using the isotropic form given above. Assume all quantities are in the International System of Units (SI). Use $E$ in $\\mathrm{Pa}$, $\\nu$ dimensionless, and $\\boldsymbol{\\sigma}$ in $\\mathrm{Pa}$. The resulting strain $\\boldsymbol{\\varepsilon}$ is dimensionless. All stress tensors $\\boldsymbol{\\sigma}$ are symmetric by construction.\n\n4. For each test case, compute the maximum absolute entrywise difference between the naive and efficient contractions,\n$$\nd \\;=\\; \\max_{1\\le i,j\\le 3} \\big| \\varepsilon_{ij}^{\\mathrm{naive}} - \\varepsilon_{ij}^{\\mathrm{eff}} \\big|,\n$$\nand report $d$ as a floating-point number in absolute strain (dimensionless). No angles are involved. The output must aggregate all test-case results into a single line formatted as a comma-separated Python-style list, e.g., $[d_1,d_2,\\dots]$.\n\nUse the following test suite that covers a general case, hydrostatic loading, pure shear, the zero-stress boundary, a nearly incompressible material, and an auxetic material. In each case, provide $E$ and $\\nu$ and a symmetric $\\boldsymbol{\\sigma}$ in $\\mathrm{Pa}$:\n\n- Case $1$ (general stress, typical metal): $E = 210\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.3$,\n  $$\n  \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n  100\\times 10^{6} & 20\\times 10^{6} & -30\\times 10^{6} \\\\\n  20\\times 10^{6} & -50\\times 10^{6} & 10\\times 10^{6} \\\\\n  -30\\times 10^{6} & 10\\times 10^{6} & 80\\times 10^{6}\n  \\end{bmatrix}\\,\\mathrm{Pa}.\n  $$\n- Case $2$ (hydrostatic compression): $E = 70\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.33$, $\\boldsymbol{\\sigma} = -100\\times 10^{6}\\,\\mathrm{Pa}\\,\\mathbf{I}$.\n- Case $3$ (pure shear): $E = 30\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.25$,\n  $$\n  \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n  0 & 50\\times 10^{6} & 0 \\\\\n  50\\times 10^{6} & 0 & 0 \\\\\n  0 & 0 & 0\n  \\end{bmatrix}\\,\\mathrm{Pa}.\n  $$\n- Case $4$ (zero stress boundary): $E = 10\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.2$,\n  $$\n  \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n  0 & 0 & 0 \\\\\n  0 & 0 & 0 \\\\\n  0 & 0 & 0\n  \\end{bmatrix}\\,\\mathrm{Pa}.\n  $$\n- Case $5$ (nearly incompressible): $E = 1\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = 0.499$,\n  $$\n  \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n  1\\times 10^{6} & 0.2\\times 10^{6} & -0.1\\times 10^{6} \\\\\n  0.2\\times 10^{6} & -2\\times 10^{6} & 0.05\\times 10^{6} \\\\\n  -0.1\\times 10^{6} & 0.05\\times 10^{6} & 3\\times 10^{6}\n  \\end{bmatrix}\\,\\mathrm{Pa}.\n  $$\n- Case $6$ (auxetic material): $E = 5\\times 10^{9}\\,\\mathrm{Pa}$, $\\nu = -0.25$,\n  $$\n  \\boldsymbol{\\sigma} \\;=\\; \\begin{bmatrix}\n  5\\times 10^{6} & 0.7\\times 10^{6} & -0.4\\times 10^{6} \\\\\n  0.7\\times 10^{6} & 0.5\\times 10^{6} & 0.9\\times 10^{6} \\\\\n  -0.4\\times 10^{6} & 0.9\\times 10^{6} & -3\\times 10^{6}\n  \\end{bmatrix}\\,\\mathrm{Pa}.\n  $$\n\nYour program must:\n- Construct $S_{ijkl}$ from each pair $\\{E,\\nu\\}$.\n- Compute $\\boldsymbol{\\varepsilon}^{\\mathrm{naive}}$ and $\\boldsymbol{\\varepsilon}^{\\mathrm{eff}}$ using explicit loops as described.\n- For each case, compute $d$ as above.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[d_1,d_2,d_3,d_4,d_5,d_6]$. Each $d$ must be reported in absolute strain (dimensionless).", "solution": "The objective is to compute the second-order strain tensor $\\boldsymbol{\\varepsilon}$ from the second-order Cauchy stress tensor $\\boldsymbol{\\sigma}$ using the fourth-order compliance tensor $\\boldsymbol{S}$. This relationship is defined by the constitutive equation of linear elasticity, which in component form is $\\varepsilon_{ij} = S_{ijkl}\\sigma_{kl}$. The summation here is implied over the indices $k$ and $l$, ranging from $1$ to $3$. We are tasked to implement two distinct computational methods for this tensor contraction and compare their results.\n\nThe problem relies on several fundamental principles of continuum mechanics:\n1.  Symmetry of the stress tensor, $\\sigma_{kl} = \\sigma_{lk}$. This is a direct consequence of the balance of angular momentum, which dictates that in the absence of body couples, the stress tensor must be symmetric.\n2.  Minor symmetries of the compliance tensor, $S_{ijkl} = S_{ijlk} = S_{jikl}$. The first equality, $S_{ijkl} = S_{ijlk}$, is required to ensure that the contraction $S_{ijkl}\\sigma_{kl}$ is well-defined given the symmetry of $\\boldsymbol{\\sigma}$. The second, $S_{ijkl} = S_{jikl}$, arises from the symmetry of the strain tensor, $\\varepsilon_{ij} = \\varepsilon_{ji}$, which is itself a consequence of the definition of the small strain tensor from the displacement gradient.\n3.  Major symmetry of the compliance tensor, $S_{ijkl} = S_{klij}$. This symmetry holds for hyperelastic materials, where the stress-strain relationship is derivable from a scalar strain energy density function, $\\Psi$. In this case, $S_{ijkl} = \\frac{\\partial^2 \\Psi}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$.\n\nThe problem specifies an isotropic material, for which the compliance tensor has a standard form dependent on two material constants, Young's modulus $E$ and Poisson's ratio $\\nu$. The component form is given as:\n$$\nS_{ijkl} \\;=\\; \\frac{1+\\nu}{2E}\\,\\big(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}\\big)\\;-\\;\\frac{\\nu}{E}\\,\\delta_{ij}\\delta_{kl}\n$$\nHere, $\\delta$ is the Kronecker delta, defined as $\\delta_{ab}=1$ if $a=b$ and $\\delta_{ab}=0$ if $a \\neq b$.\n\nOur solution will be constructed systematically as follows.\n\n**1. Construction of the Compliance Tensor $S_{ijkl}$**\n\nFirst, we must programmatically construct the $3 \\times 3 \\times 3 \\times 3$ components of the tensor $\\boldsymbol{S}$ using the provided formula for isotropic materials. This involves creating a four-dimensional array and populating its $3^4=81$ components based on the given $E$ and $\\nu$. This is achieved by iterating through all index combinations $(i, j, k, l)$ from $0$ to $2$ (in programming, corresponding to $1$ to $3$ in mathematical notation) and applying the formula. The Kronecker delta $\\delta_{ab}$ is equivalent to an identity matrix.\n\n**2. Implementation of the Naive Contraction**\n\nThe \"naive\" method directly implements the full tensor contraction as written:\n$$\n\\varepsilon_{ij}^{\\mathrm{naive}} \\;=\\; \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\,\\sigma_{kl}\n$$\nThis requires a set of four nested loops. For each component $(i, j)$ of the resulting strain tensor $\\boldsymbol{\\varepsilon}^{\\mathrm{naive}}$, we sum over all $3 \\times 3 = 9$ combinations of $(k, l)$. The total arithmetic work for computing the full $\\boldsymbol{\\varepsilon}$ tensor involves $3 \\times 3 \\times 3 \\times 3 = 81$ multiplications and additions for each of the $9$ components of $\\boldsymbol{\\varepsilon}$, although most components of $\\boldsymbol{S}$ are zero.\n\n**3. Implementation of the Efficient Contraction**\n\nThe \"efficient\" method exploits the symmetries of $\\boldsymbol{\\sigma}$ and $\\boldsymbol{S}$. The sum over $k$ and $l$ can be rewritten to avoid redundant calculations.\nStarting with the naive sum:\n$$ \\sum_{k=1}^{3}\\sum_{l=1}^{3} S_{ijkl}\\sigma_{kl} = \\sum_{k=l} S_{ijkl}\\sigma_{kl} + \\sum_{k \\neq l} S_{ijkl}\\sigma_{kl} $$\nThe second term can be split: $\\sum_{k < l} S_{ijkl}\\sigma_{kl} + \\sum_{k > l} S_{ijkl}\\sigma_{kl}$.\nUsing symmetries $S_{ijkl}=S_{ijlk}$ and $\\sigma_{kl}=\\sigma_{lk}$, we can show that $\\sum_{k > l} S_{ijkl}\\sigma_{kl} = \\sum_{k < l} S_{ijlk}\\sigma_{lk} = \\sum_{k < l} S_{ijkl}\\sigma_{kl}$.\nTherefore, the full sum becomes:\n$$ \\sum_{k=l} S_{ijkl}\\sigma_{kl} + 2\\sum_{k < l} S_{ijkl}\\sigma_{kl} = \\sum_{k=1}^{3}\\sum_{l=k}^{3} w_{kl}\\,S_{ijkl}\\,\\sigma_{kl} $$\nwhere the weight $w_{kl}$ is $1$ for $k=l$ and $2$ for $k<l$. This reduces the number of terms in the inner summation from $9$ to $6$.\n\nFurthermore, the resulting strain tensor $\\boldsymbol{\\varepsilon}$ is itself symmetric, $\\varepsilon_{ij} = \\varepsilon_{ji}$. This allows us to compute only the components where $i \\le j$ (the upper triangle, including the diagonal) and then obtain the lower triangular components by reflection: $\\varepsilon_{ji} = \\varepsilon_{ij}$ for $j < i$. This reduces the number of $\\boldsymbol{\\varepsilon}$ components to compute from $9$ to $6$. The implementation will thus consist of loops for $i$ from $0$ to $2$ and $j$ from $i$ to $2$, inside which the efficient summation over $k$ and $l$ is performed. Finally, the lower triangle of $\\boldsymbol{\\varepsilon}^{\\mathrm{eff}}$ is populated.\n\n**4. Numerical Comparison**\n\nFor each test case provided, we will compute both $\\boldsymbol{\\varepsilon}^{\\mathrm{naive}}$ and $\\boldsymbol{\\varepsilon}^{\\mathrm{eff}}$. The maximum absolute difference, $d = \\max_{1\\le i,j\\le 3} |\\varepsilon_{ij}^{\\mathrm{naive}} - \\varepsilon_{ij}^{\\mathrm{eff}}|$, is then calculated. Mathematically, the two methods are identical, so $d$ is expected to be zero. In floating-point arithmetic, due to potential differences in the order of operations, $d$ might be a very small non-zero number, on the order of machine precision. This value serves as a numerical verification of the correctness of the efficient implementation. The code provided in the final answer will perform these steps for all specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for tensor contraction.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E in Pa, nu dimensionless, sigma in Pa)\n    test_cases = [\n        (210e9, 0.3, np.array([\n            [100e6, 20e6, -30e6],\n            [20e6, -50e6, 10e6],\n            [-30e6, 10e6, 80e6]\n        ])),\n        (70e9, 0.33, -100e6 * np.identity(3)),\n        (30e9, 0.25, np.array([\n            [0, 50e6, 0],\n            [50e6, 0, 0],\n            [0, 0, 0]\n        ])),\n        (10e9, 0.2, np.zeros((3, 3))),\n        (1e9, 0.499, np.array([\n            [1e6, 0.2e6, -0.1e6],\n            [0.2e6, -2e6, 0.05e6],\n            [-0.1e6, 0.05e6, 3e6]\n        ])),\n        (5e9, -0.25, np.array([\n            [5e6, 0.7e6, -0.4e6],\n            [0.7e6, 0.5e6, 0.9e6],\n            [-0.4e6, 0.9e6, -3e6]\n        ]))\n    ]\n\n    results = []\n    for E, nu, sigma in test_cases:\n        # 1. Construct the fourth-order compliance tensor S\n        S = construct_compliance_tensor(E, nu)\n\n        # 2. Compute strain using the naive contraction\n        epsilon_naive = naive_contraction(S, sigma)\n\n        # 3. Compute strain using the efficient contraction\n        epsilon_eff = efficient_contraction(S, sigma)\n\n        # 4. Compute the maximum absolute difference\n        diff = np.max(np.abs(epsilon_naive - epsilon_eff))\n        results.append(diff)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef construct_compliance_tensor(E, nu):\n    \"\"\"\n    Constructs the 3x3x3x3 isotropic compliance tensor S_ijkl.\n    \"\"\"\n    S = np.zeros((3, 3, 3, 3))\n    delta = np.identity(3)\n    \n    # Coefficients from the isotropic compliance formula\n    c1 = (1.0 + nu) / (2.0 * E)\n    c2 = -nu / E\n\n    # Populate the tensor using explicit loops over indices (i,j,k,l)\n    for i in range(3):\n        for j in range(3):\n            for k in range(3):\n                for l in range(3):\n                    term1 = delta[i, k] * delta[j, l] + delta[i, l] * delta[j, k]\n                    term2 = delta[i, j] * delta[k, l]\n                    S[i, j, k, l] = c1 * term1 + c2 * term2\n    return S\n\ndef naive_contraction(S, sigma):\n    \"\"\"\n    Computes strain = S : sigma using naive loops (4 nested loops).\n    epsilon_ij = sum_{k,l} S_ijkl * sigma_kl\n    \"\"\"\n    epsilon = np.zeros((3, 3))\n    for i in range(3):\n        for j in range(3):\n            sum_val = 0.0\n            for k in range(3):\n                for l in range(3):\n                    sum_val += S[i, j, k, l] * sigma[k, l]\n            epsilon[i, j] = sum_val\n    return epsilon\n\ndef efficient_contraction(S, sigma):\n    \"\"\"\n    Computes strain = S : sigma using loops that exploit tensor symmetries.\n    \"\"\"\n    epsilon = np.zeros((3, 3))\n    \n    # Compute the upper triangle of epsilon (i <= j)\n    for i in range(3):\n        for j in range(i, 3):\n            sum_val = 0.0\n            # Inner sum exploits symmetry of sigma and minor symmetry of S\n            for k in range(3):\n                for l in range(k, 3):\n                    weight = 1.0 if k == l else 2.0\n                    sum_val += weight * S[i, j, k, l] * sigma[k, l]\n            epsilon[i, j] = sum_val\n            \n    # Fill the lower triangle using symmetry of epsilon\n    for i in range(3):\n        for j in range(i): # j < i\n            epsilon[i, j] = epsilon[j, i]\n            \n    return epsilon\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2696786"}]}