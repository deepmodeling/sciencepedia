{"hands_on_practices": [{"introduction": "The abstract components of the elasticity tensor gain physical meaning when connected to measurable material properties. This foundational exercise guides you through the essential process of constructing the full stiffness matrix for an orthotropic material starting from its experimentally determined engineering constants. It reinforces the fundamental relationship between the compliance and stiffness tensors and introduces the critical concept of positive definiteness, which ensures the material model is physically stable. [@problem_id:2697094]", "problem": "An orthotropic, linearly elastic composite lamina has its material symmetry axes aligned with the global Cartesian axes. Under the assumptions of small strains and small rotations, the stress–strain law is of the generalized Hooke type, $\\sigma_{ij} = C_{ijkl}\\,\\varepsilon_{kl}$, where $C_{ijkl}$ is the fourth-order stiffness tensor. The nine measured engineering constants (assumed to be mutually consistent within experimental uncertainty) are:\n- Longitudinal Young’s moduli: $E_1 = 64\\,\\text{GPa}$, $E_2 = 12\\,\\text{GPa}$, $E_3 = 8\\,\\text{GPa}$.\n- Poisson ratios: $\\nu_{12} = 0.28$, $\\nu_{23} = 0.35$, $\\nu_{31} = 0.04$.\n- Shear moduli: $G_{12} = 4.5\\,\\text{GPa}$, $G_{23} = 3.2\\,\\text{GPa}$, $G_{31} = 3.9\\,\\text{GPa}$.\n\nStarting from the tensorial form of linear elasticity and the definitions of the engineering constants under independent uniaxial and pure shear loadings, do the following:\n\n1) Using Voigt notation, construct the full $6\\times 6$ stiffness matrix $[\\mathbf{C}]$ for this orthotropic material. You must start by assembling the $6\\times 6$ compliance matrix $[\\mathbf{S}]$ from the given engineering constants via their definitions (including the reciprocity relations $\\nu_{ij}/E_i = \\nu_{ji}/E_j$ that follow from strain energy symmetry), and then invert the appropriate blocks to obtain $[\\mathbf{C}]$.\n\n2) Using the strain energy density $W = \\tfrac{1}{2}\\,\\varepsilon_{ij} C_{ijkl} \\varepsilon_{kl}$ as the fundamental positivity criterion, check the positive definiteness of $[\\mathbf{C}]$ by evaluating the eigenvalues of $[\\mathbf{C}]$. Because of the orthotropic structure in Voigt form, you may exploit the block structure induced by normal and shear components, but you must make your reasoning explicit.\n\nReport, as your final answer, the minimum eigenvalue of the full $6\\times 6$ stiffness matrix $[\\mathbf{C}]$ in gigapascals. Round your answer to four significant figures and express it in $\\text{GPa}$.", "solution": "We begin from generalized Hooke’s law, $\\sigma_{ij} = C_{ijkl}\\,\\varepsilon_{kl}$, and the strain energy density $W = \\tfrac{1}{2}\\,\\varepsilon_{ij} C_{ijkl} \\varepsilon_{kl}$. Symmetry of $C_{ijkl}$ follows from existence of a strain energy function and implies the major symmetry $C_{ijkl} = C_{klij}$, which in Voigt notation ensures a symmetric stiffness matrix $[\\mathbf{C}]$. For an orthotropic material aligned with the axes, the Voigt $6\\times 6$ stiffness and compliance matrices are block-diagonal in the sense that normal and shear subspaces do not couple.\n\nStep 1: Build the compliance matrix $[\\mathbf{S}]$ from engineering constants. By definition of the Young’s moduli and Poisson ratios under uniaxial stress in direction $i$, the normal compliance block has entries\n$$\nS_{11} = \\frac{1}{E_1},\\quad S_{22} = \\frac{1}{E_2},\\quad S_{33} = \\frac{1}{E_3},\\quad\nS_{12} = -\\frac{\\nu_{12}}{E_1} = -\\frac{\\nu_{21}}{E_2},\\quad\nS_{13} = -\\frac{\\nu_{13}}{E_1} = -\\frac{\\nu_{31}}{E_3},\\quad\nS_{23} = -\\frac{\\nu_{23}}{E_2} = -\\frac{\\nu_{32}}{E_3}.\n$$\nThe reciprocity relations $\\nu_{ij}/E_i = \\nu_{ji}/E_j$ enforce the symmetry of $[\\mathbf{S}]$. The shear compliance entries follow from the definition of the shear moduli, $S_{44} = 1/G_{23}$, $S_{55} = 1/G_{31}$, $S_{66} = 1/G_{12}$.\n\nGiven $E_1 = 64\\,\\text{GPa}$, $E_2 = 12\\,\\text{GPa}$, $E_3 = 8\\,\\text{GPa}$, we obtain\n$$\nS_{11} = \\frac{1}{64},\\quad S_{22} = \\frac{1}{12},\\quad S_{33} = \\frac{1}{8}.\n$$\nThe independent Poisson ratios are $\\nu_{12} = 0.28$, $\\nu_{23} = 0.35$, $\\nu_{31} = 0.04$. Reciprocity gives the remaining ones:\n$$\n\\nu_{21} = \\nu_{12}\\,\\frac{E_2}{E_1} = 0.28\\,\\frac{12}{64} = 0.0525,\\quad\n\\nu_{32} = \\nu_{23}\\,\\frac{E_3}{E_2} = 0.35\\,\\frac{8}{12} = 0.233\\overline{3},\\quad\n\\nu_{13} = \\nu_{31}\\,\\frac{E_1}{E_3} = 0.04\\,\\frac{64}{8} = 0.32.\n$$\nHence,\n$$\nS_{12} = -\\frac{\\nu_{12}}{E_1} = -\\frac{0.28}{64} = -\\frac{7}{1600},\\quad\nS_{13} = -\\frac{\\nu_{13}}{E_1} = -\\frac{0.32}{64} = -\\frac{1}{200},\\quad\nS_{23} = -\\frac{\\nu_{23}}{E_2} = -\\frac{0.35}{12} = -\\frac{7}{240}.\n$$\nFor the shear compliances, with $G_{12} = 4.5\\,\\text{GPa}$, $G_{23} = 3.2\\,\\text{GPa}$, $G_{31} = 3.9\\,\\text{GPa}$, we have\n$$\nS_{44} = \\frac{1}{G_{23}} = \\frac{1}{3.2},\\quad\nS_{55} = \\frac{1}{G_{31}} = \\frac{1}{3.9},\\quad\nS_{66} = \\frac{1}{G_{12}} = \\frac{1}{4.5}.\n$$\nThus the compliance matrix in Voigt form is\n$$\n[\\mathbf{S}] =\n\\begin{pmatrix}\n\\frac{1}{64} & -\\frac{7}{1600} & -\\frac{1}{200} & 0 & 0 & 0 \\\\\n-\\frac{7}{1600} & \\frac{1}{12} & -\\frac{7}{240} & 0 & 0 & 0 \\\\\n-\\frac{1}{200} & -\\frac{7}{240} & \\frac{1}{8} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1}{3.2} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\frac{1}{3.9} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1}{4.5}\n\\end{pmatrix}.\n$$\n\nTo obtain the stiffness matrix $[\\mathbf{C}]$, invert the $3\\times 3$ normal compliance block and use the shear moduli directly for the shear part (since the compliance shear blocks are diagonal). Denote the normal compliance block as\n$$\n[\\mathbf{S}]_{\\text{n}} = \\begin{pmatrix}\n\\frac{1}{64} & -\\frac{7}{1600} & -\\frac{1}{200}\\\\\n-\\frac{7}{1600} & \\frac{1}{12} & -\\frac{7}{240}\\\\\n-\\frac{1}{200} & -\\frac{7}{240} & \\frac{1}{8}\n\\end{pmatrix}.\n$$\nIts determinant is\n$$\n\\det([\\mathbf{S}]_{\\text{n}}) = \\frac{132,449}{921,600,000} \\approx 1.43716364\\times 10^{-4}\\,,\n$$\nso it is invertible. The cofactor expressions give the inverse exactly as rational numbers:\n$$\n[\\mathbf{C}]_{\\text{n}} = [\\mathbf{S}]_{\\text{n}}^{-1} =\n\\frac{1}{\\det([\\mathbf{S}]_{\\text{n}})}\\,\n\\begin{pmatrix}\n\\frac{551}{57,600} & \\frac{133}{192,000} & \\frac{209}{384,000}\\\\\n\\frac{133}{192,000} & \\frac{617}{320,000} & \\frac{917}{1,920,000}\\\\\n\\frac{209}{384,000} & \\frac{917}{1,920,000} & \\frac{9,853}{7,680,000}\n\\end{pmatrix}.\n$$\nEquivalently, each entry can be written as a reduced rational over the common denominator $132,449$:\n$$\nC_{11} = \\frac{8,816,000}{132,449} \\approx 66.5615,\\quad\nC_{22} = \\frac{1,776,960}{132,449} \\approx 13.4162,\\quad\nC_{33} = \\frac{1,182,360}{132,449} \\approx 8.92691,\n$$\n$$\nC_{12} = \\frac{638,400}{132,449} \\approx 4.81997,\\quad\nC_{13} = \\frac{501,600}{132,449} \\approx 3.78712,\\quad\nC_{23} = \\frac{440,160}{132,449} \\approx 3.32324.\n$$\nThe shear stiffnesses are simply\n$$\nC_{44} = G_{23} = 3.2,\\quad C_{55} = G_{31} = 3.9,\\quad C_{66} = G_{12} = 4.5.\n$$\nTherefore, in Voigt notation and units of $\\text{GPa}$, the full stiffness matrix is\n$$\n[\\mathbf{C}] =\n\\begin{pmatrix}\n66.5615 & 4.81997 & 3.78712 & 0 & 0 & 0 \\\\\n4.81997 & 13.4162 & 3.32324 & 0 & 0 & 0 \\\\\n3.78712 & 3.32324 & 8.92691 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 3.2 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 3.9 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 4.5\n\\end{pmatrix}\\quad\\text{(GPa)}.\n$$\n\nStep 2: Positive definiteness via the strain energy criterion. For linear elasticity, $W = \\tfrac{1}{2}\\,\\varepsilon^{\\mathsf{T}}[\\mathbf{C}]\\,\\varepsilon > 0$ for all nonzero strain vectors $\\varepsilon$ if and only if $[\\mathbf{C}]$ is symmetric positive definite. The Voigt $[\\mathbf{C}]$ here is block diagonal with respect to $\\{\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33}\\}$ and the shear components $\\{\\gamma_{23},\\gamma_{31},\\gamma_{12}\\}$, so its eigenvalues consist of:\n- The three eigenvalues of the $3\\times 3$ normal block $[\\mathbf{C}]_{\\text{n}}$.\n- The three shear moduli $C_{44} = 3.2$, $C_{55} = 3.9$, $C_{66} = 4.5$.\n\nWe compute the eigenvalues of $[\\mathbf{C}]_{\\text{n}}$. Using the rotationally invariant quantities\n$$\nI_1 = \\operatorname{tr}([\\mathbf{C}]_{\\text{n}}) \\approx 88.9156,\\quad\nI_2 = \\sum_{\\text{principal }2\\times 2\\text{ minors}} \\approx 1{,}558.738,\\quad\nI_3 = \\det([\\mathbf{C}]_{\\text{n}}) = \\frac{1}{\\det([\\mathbf{S}]_{\\text{n}})} \\approx 6{,}958.150,\n$$\nand the standard three-eigenvalue formula for symmetric $3\\times 3$ matrices (via the depressed cubic and angle method), one obtains approximately\n$$\n\\lambda_1 \\approx 67.28,\\quad \\lambda_2 \\approx 14.57,\\quad \\lambda_3 \\approx 7.06\\quad\\text{(GPa)}.\n$$\nAll three are strictly positive. Therefore, the full $6\\times 6$ stiffness matrix is positive definite if and only if the shear entries are also positive, which they are: $3.2>0$, $3.9>0$, $4.5>0$.\n\nFinally, the minimum eigenvalue of the full $6\\times 6$ stiffness matrix is the smallest among $\\{\\lambda_1,\\lambda_2,\\lambda_3, 3.2, 3.9, 4.5\\}$, namely $3.2\\,\\text{GPa}$. Rounding to four significant figures (and expressing in $\\text{GPa}$) yields $3.200\\,\\text{GPa}$.", "answer": "$$\\boxed{3.200}$$", "id": "2697094"}, {"introduction": "In engineering practice, it is often necessary to approximate a complex anisotropic material with a simpler, isotropic model. This advanced problem demonstrates how to find the \"best-fit\" isotropic tensor by formulating the task as a least-squares projection in tensor space, using the mathematically convenient Kelvin representation. By deriving the optimal bulk and shear moduli from tensor invariants, you will gain insight into model reduction and the deep connection between a tensor's structure and its physical character. [@problem_id:2697044]", "problem": "An experimental campaign provides a measured fourth-order elastic stiffness tensor $C$ for a homogeneous, linearly elastic solid. The tensor $C$ has the standard minor and major symmetries and is represented in the Kelvin mapping as a symmetric $6 \\times 6$ matrix $C^{K}$ acting on the Kelvin vector of a symmetric second-order strain tensor $\\varepsilon$ via $\\sigma^{K} = C^{K} \\varepsilon^{K}$, where the Kelvin vectorization is defined by\n$$\n\\varepsilon^{K} = \n\\begin{pmatrix}\n\\varepsilon_{11} \\\\\n\\varepsilon_{22} \\\\\n\\varepsilon_{33} \\\\\n\\sqrt{2}\\,\\varepsilon_{23} \\\\\n\\sqrt{2}\\,\\varepsilon_{13} \\\\\n\\sqrt{2}\\,\\varepsilon_{12}\n\\end{pmatrix}.\n$$\nThe Kelvin inner product between two fourth-order tensors $A$ and $B$ is induced by the Frobenius inner product of their Kelvin matrices: $A :\\!:\\, B = \\mathrm{tr}\\!\\left(\\left(A^{K}\\right)^{\\mathsf{T}} B^{K}\\right)$. The isotropic fourth-order stiffness subspace is parameterized by the bulk modulus $K$ and the shear modulus $\\mu$ through the decomposition of the linear Hooke law\n$$\n\\sigma = K\\,(\\mathrm{tr}\\,\\varepsilon)\\,I + 2\\,\\mu\\,\\mathrm{dev}\\,\\varepsilon,\n$$\nequivalently,\n$$\nC^{\\mathrm{iso}} = 3K\\,P^{\\mathrm{vol}} + 2\\mu\\,P^{\\mathrm{dev}},\n$$\nwhere $P^{\\mathrm{vol}}{}_{ijkl} = \\tfrac{1}{3}\\delta_{ij}\\delta_{kl}$ and $P^{\\mathrm{dev}} = I^{\\mathrm{sym}} - P^{\\mathrm{vol}}$ with $I^{\\mathrm{sym}}{}_{ijkl} = \\tfrac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$.\n\nStarting from these definitions, formulate the least-squares projection problem that seeks the closest isotropic tensor $C^{\\mathrm{iso}}(K,\\mu)$ to the measured $C$ under the Kelvin norm (i.e., minimizing the Kelvin-norm squared of $C - C^{\\mathrm{iso}}$), and derive from first principles the optimality conditions that determine the best-fit moduli $(K^{\\star},\\mu^{\\star})$ in terms of invariant contractions of $C$. Then evaluate $(K^{\\star},\\mu^{\\star})$ for the following measured Kelvin stiffness matrix $C^{K}$ (in $\\mathrm{GPa}$), given in the ordered basis $(11,22,33,\\sqrt{2}\\,23,\\sqrt{2}\\,13,\\sqrt{2}\\,12)$:\n$$\nC^{K} = \n\\begin{pmatrix}\n182 & 88 & 92 & 0 & 0 & 0 \\\\\n88 & 175 & 85 & 0 & 0 & 0 \\\\\n92 & 85 & 178 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 47 & 2 & -1 \\\\\n0 & 0 & 0 & 2 & 44 & 1 \\\\\n0 & 0 & 0 & -1 & 1 & 46\n\\end{pmatrix}.\n$$\nExpress your final numerical values of $(K^{\\star},\\mu^{\\star})$ in $\\mathrm{GPa}$ and round your answers to four significant figures. Your final answer must be a single row vector containing the two numbers in the order $(K^{\\star},\\mu^{\\star})$.", "solution": "The objective is to find the bulk modulus $K$ and shear modulus $\\mu$ that minimize the squared Kelvin-norm distance between the measured stiffness tensor $C$ and its isotropic approximation $C^{\\mathrm{iso}}(K, \\mu)$. The objective function to minimize is:\n$$\nf(K, \\mu) = \\left\\| C - C^{\\mathrm{iso}}(K, \\mu) \\right\\|_{K}^{2}\n$$\nThe Kelvin norm is induced by the inner product defined as $A :\\!:\\, B = \\mathrm{tr}\\!\\left(\\left(A^{K}\\right)^{\\mathsf{T}} B^{K}\\right)$, where $A^K$ and $B^K$ are the Kelvin matrix representations. The squared norm is $\\| A \\|_{K}^{2} = A :\\!:\\, A$.\n\nThe isotropic stiffness tensor $C^{\\mathrm{iso}}$ is given by the decomposition:\n$$\nC^{\\mathrm{iso}}(K, \\mu) = 3K\\,P^{\\mathrm{vol}} + 2\\mu\\,P^{\\mathrm{dev}}\n$$\nwhere $P^{\\mathrm{vol}}$ and $P^{\\mathrm{dev}}$ are the volumetric and deviatoric projection tensors, respectively. Substituting this into the objective function yields:\n$$\nf(K, \\mu) = \\left( C - 3K\\,P^{\\mathrm{vol}} - 2\\mu\\,P^{\\mathrm{dev}} \\right) :\\!:\\, \\left( C - 3K\\,P^{\\mathrm{vol}} - 2\\mu\\,P^{\\mathrm{dev}} \\right)\n$$\nExpanding this using the bilinearity of the inner product:\n$$\nf(K, \\mu) = C:\\!:C - 6K(C:\\!:P^{\\mathrm{vol}}) - 4\\mu(C:\\!:P^{\\mathrm{dev}}) + 9K^2(P^{\\mathrm{vol}}:\\!:P^{\\mathrm{vol}}) + 4\\mu^2(P^{\\mathrm{dev}}:\\!:P^{\\mathrm{dev}}) + 12K\\mu(P^{\\mathrm{vol}}:\\!:P^{\\mathrm{dev}})\n$$\nTo simplify this expression, we must evaluate the inner products of the projection tensors. The projectors are defined as $P^{\\mathrm{vol}}{}_{ijkl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl}$ and $P^{\\mathrm{dev}} = I^{\\mathrm{sym}} - P^{\\mathrm{vol}}$, with $I^{\\mathrm{sym}}{}_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})$. The indices run from $1$ to $3$.\n\nFirst, we establish the orthogonality of $P^{\\mathrm{vol}}$ and $P^{\\mathrm{dev}}$:\n$$\nP^{\\mathrm{vol}}:\\!:P^{\\mathrm{dev}} = P^{\\mathrm{vol}}:\\!:(I^{\\mathrm{sym}} - P^{\\mathrm{vol}}) = P^{\\mathrm{vol}}:\\!:I^{\\mathrm{sym}} - P^{\\mathrm{vol}}:\\!:P^{\\mathrm{vol}}\n$$\nWe compute the required contractions:\n$$\nP^{\\mathrm{vol}}:\\!:P^{\\mathrm{vol}} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{kl}\\right):\\!:\\left(\\frac{1}{3}\\delta_{ab}\\delta_{cd}\\right) = \\frac{1}{9}\\delta_{ijab}\\delta_{klcd} = \\frac{1}{9}\\sum_{i,j,k,l} \\delta_{ij}\\delta_{ij}\\delta_{kl}\\delta_{kl} = \\frac{1}{9} (\\sum_{i}\\delta_{ii})(\\sum_{k}\\delta_{kk}) = \\frac{1}{9}(3)(3) = 1\n$$\n$$\nP^{\\mathrm{vol}}:\\!:I^{\\mathrm{sym}} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{kl}\\right):\\!:\\left(\\frac{1}{2}(\\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc})\\right) = \\frac{1}{6} \\sum_{i,j,k,l} \\delta_{ij}\\delta_{kl}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) = \\frac{1}{6}(\\delta_{ik}\\delta_{ki} + \\delta_{ik}\\delta_{ik}) = \\frac{1}{3}\\sum_{i,k}\\delta_{ik} = \\frac{1}{3}(3) = 1\n$$\nTherefore, $P^{\\mathrm{vol}}:\\!:P^{\\mathrm{dev}} = 1 - 1 = 0$. The projectors are orthogonal, which decouples the optimization problem.\n\nThe norm of $P^{\\mathrm{dev}}$ is needed:\n$$\n\\|P^{\\mathrm{dev}}\\|_{K}^{2} = P^{\\mathrm{dev}}:\\!:P^{\\mathrm{dev}} = (I^{\\mathrm{sym}} - P^{\\mathrm{vol}}):\\!:(I^{\\mathrm{sym}} - P^{\\mathrm{vol}}) = I^{\\mathrm{sym}}:\\!:I^{\\mathrm{sym}} - 2(I^{\\mathrm{sym}}:\\!:P^{\\mathrm{vol}}) + P^{\\mathrm{vol}}:\\!:P^{\\mathrm{vol}}\n$$\nWe calculate $I^{\\mathrm{sym}}:\\!:I^{\\mathrm{sym}}$:\n$$\nI^{\\mathrm{sym}}:\\!:I^{\\mathrm{sym}} = \\frac{1}{4}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}):\\!:\\,(\\delta_{ac}\\delta_{bd} + \\delta_{ad}\\delta_{bc}) = \\frac{1}{4} \\sum_{i,j,k,l} (\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})^2 = \\frac{1}{4}(\\delta_{ik}^2 \\delta_{jl}^2 + 2\\delta_{ik}\\delta_{jl}\\delta_{il}\\delta_{jk} + \\delta_{il}^2\\delta_{jk}^2)\n$$\nSumming over indices gives $\\sum \\delta_{ik}^2 \\delta_{jl}^2 = 9$, $\\sum \\delta_{il}^2\\delta_{jk}^2=9$, and $\\sum \\delta_{ik}\\delta_{jl}\\delta_{il}\\delta_{jk} = \\sum \\delta_{ij}\\delta_{ji} = 3$.\n$$\nI^{\\mathrm{sym}}:\\!:I^{\\mathrm{sym}} = \\frac{1}{4}(9 + 2(3) + 9) = \\frac{24}{4} = 6\n$$\nSo, $\\|P^{\\mathrm{dev}}\\|_{K}^{2} = 6 - 2(1) + 1 = 5$.\n\nThe objective function simplifies to:\n$$\nf(K, \\mu) = C:\\!:C - 6K(C:\\!:P^{\\mathrm{vol}}) - 4\\mu(C:\\!:P^{\\mathrm{dev}}) + 9K^2 + 20\\mu^2\n$$\nFor optimality, the partial derivatives with respect to $K$ and $\\mu$ must be zero:\n$$\n\\frac{\\partial f}{\\partial K} = -6(C:\\!:P^{\\mathrm{vol}}) + 18K = 0 \\implies K^{\\star} = \\frac{1}{3}(C:\\!:P^{\\mathrm{vol}})\n$$\n$$\n\\frac{\\partial f}{\\partial \\mu} = -4(C:\\!:P^{\\mathrm{dev}}) + 40\\mu = 0 \\implies \\mu^{\\star} = \\frac{1}{10}(C:\\!:P^{\\mathrm{dev}})\n$$\nThese are the optimality conditions for the best-fit moduli $(K^{\\star}, \\mu^{\\star})$.\n\nNext, we evaluate the contractions using the Kelvin matrix representation. The inner product is $A:\\!:B = \\mathrm{tr}((A^K)^{\\mathsf{T}} B^K) = \\mathrm{tr}(A^K B^K)$ since $A^K$ is symmetric.\nThe Kelvin matrix for $P^{\\mathrm{vol}}$ is:\n$$\n(P^{\\mathrm{vol}})^K = \\frac{1}{3}\n\\begin{pmatrix}\n1 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 1 & 0 & 0 & 0 \\\\\n1 & 1 & 1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n$$\nThe contraction $C:\\!:P^{\\mathrm{vol}}$ is:\n$$\nC:\\!:P^{\\mathrm{vol}} = \\mathrm{tr}(C^K (P^{\\mathrm{vol}})^K) = \\frac{1}{3}\\mathrm{tr}\n\\begin{pmatrix}\n\\sum_{j=1}^3 C^K_{1j} & \\dots \\\\\n\\sum_{j=1}^3 C^K_{2j} & \\dots \\\\\n\\sum_{j=1}^3 C^K_{3j} & \\dots \\\\\n\\vdots & \\ddots\n\\end{pmatrix}\n= \\frac{1}{3}\\sum_{i=1}^3 \\sum_{j=1}^3 C^K_{ij}\n$$\nUsing the provided matrix $C^K$:\n$$\n\\sum_{i,j=1}^3 C^K_{ij} = (182+88+92) + (88+175+85) + (92+85+178) = 362 + 348 + 355 = 1065\n$$\nSo, $C:\\!:P^{\\mathrm{vol}} = \\frac{1065}{3} = 355$.\nThe optimal bulk modulus is:\n$$\nK^{\\star} = \\frac{1}{3}(355) = \\frac{355}{3} \\approx 118.333... \\text{ GPa}\n$$\nFor the shear modulus, we need $C:\\!:P^{\\mathrm{dev}} = C:\\!:(I^{\\mathrm{sym}} - P^{\\mathrm{vol}}) = C:\\!:I^{\\mathrm{sym}} - C:\\!:P^{\\mathrm{vol}}$.\nThe contraction $C:\\!:I^{\\mathrm{sym}}$ corresponds to the trace of the Kelvin matrix, $C:\\!:I^{\\mathrm{sym}} = \\mathrm{tr}(C^K (I^{\\mathrm{sym}})^K) = \\mathrm{tr}(C^K I_6) = \\mathrm{tr}(C^K)$.\n$$\n\\mathrm{tr}(C^K) = 182 + 175 + 178 + 47 + 44 + 46 = 672\n$$\nThen, $C:\\!:P^{\\mathrm{dev}} = 672 - 355 = 317$.\nThe optimal shear modulus is:\n$$\n\\mu^{\\star} = \\frac{1}{10}(317) = 31.7 \\text{ GPa}\n$$\nRounding these values to four significant figures gives:\n$K^{\\star} = 118.3$ GPa\n$\\mu^{\\star} = 31.70$ GPa\nThe final answer is presented as a row vector $(K^{\\star}, \\mu^{\\star})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 118.3 & 31.70 \\end{pmatrix}}\n$$", "id": "2697044"}, {"introduction": "This capstone problem challenges you to move from pen-and-paper theory to practical computational implementation, a crucial skill in modern mechanics. You will write a program to compute the effective elastic properties of a material with a given microstructural texture by averaging rotated stiffness tensors. The exercise culminates in classifying the emergent macroscopic symmetry, synthesizing concepts of tensor transformation, homogenization, and group averaging into a powerful tool for computational materials science. [@problem_id:2697083]", "problem": "Implement a program that, given a base fourth-order elasticity tensor and a finite set of discrete orientations with weights, computes the weighted arithmetic mean of the rotated tensors and classifies the symmetry of the averaged tensor among four candidate symmetry classes: isotropic, cubic (aligned with the coordinate axes), transversely isotropic about the Cartesian axis $z$, and orthotropic (aligned with the Cartesian axes). The classification should be made by projecting the averaged tensor onto each symmetry class and selecting the class that minimizes the relative Frobenius norm error.\n\nYou must base your derivation and implementation on the following fundamental principles:\n- The linear elastic constitutive relation (Hooke’s law): $\\,\\sigma_{ij} = C_{ijkl}\\,\\varepsilon_{kl}\\,$, where $\\,\\sigma_{ij}\\,$ is the stress tensor, $\\,\\varepsilon_{kl}\\,$ is the strain tensor, and $\\,C_{ijkl}\\,$ is the fourth-order stiffness tensor that obeys the minor and major symmetries $\\,C_{ijkl} = C_{jikl} = C_{ijlk} = C_{klij}\\,$.\n- The tensorial change-of-basis rule under a proper rotation $\\,R \\in \\mathrm{Special\\ Orthogonal\\ group\\ (SO(3))}\\,$: the components of a fourth-order tensor transform as $\\,C'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} C_{pqrs}\\,$.\n- Weighted arithmetic averaging: given orientations $\\,\\{R^{(a)}\\}_{a=1}^{A}\\,$ and normalized weights $\\,\\{w^{(a)}\\}_{a=1}^{A}\\,$ with $\\,w^{(a)} \\ge 0\\,$ and $\\,\\sum_{a=1}^{A} w^{(a)} = 1\\,$, the averaged tensor is $\\,\\overline{C}_{ijkl} = \\sum_{a=1}^{A} w^{(a)}\\, R^{(a)}_{ip} R^{(a)}_{jq} R^{(a)}_{kr} R^{(a)}_{ls} C_{pqrs}\\,$.\n- Orthogonal projection onto a symmetry class defined by a rotation group $\\,\\mathcal{G}\\,$: the projection is achieved by group averaging $\\,\\Pi_{\\mathcal{G}}(C) = \\langle g \\cdot C \\rangle_{g \\in \\mathcal{G}} = \\frac{1}{|\\mathcal{G}|}\\sum_{g \\in \\mathcal{G}} g \\cdot C\\,$, which yields the closest tensor (in the Frobenius norm) invariant under $\\,\\mathcal{G}\\,$.\n- The isotropic projection can be written using the standard isotropic projectors $\\,J_{ijkl}=\\frac{1}{3}\\delta_{ij}\\delta_{kl}\\,$ and $\\,K_{ijkl}=\\frac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk}) - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\\,$ as $\\,C_{\\mathrm{iso}} = 3\\kappa\\,J + 2\\mu\\,K\\,$, where the bulk modulus $\\,\\kappa\\,$ and shear modulus $\\,\\mu\\,$ are determined from invariants of $\\,C\\,$.\n\nAngle measures must be treated in radians. No physical units are required for the final answer because the classification is unitless.\n\nImplement the classification rule as follows:\n- For a given averaged tensor $\\,\\overline{C}\\,$, compute the best approximations $\\,C_{\\mathrm{iso}}, C_{\\mathrm{cubic}}, C_{\\mathrm{TI}}, C_{\\mathrm{ortho}}\\,$ by projecting onto the isotropic, cubic, transversely isotropic about $\\,z\\,$, and orthotropic (aligned) classes, respectively.\n- Compute the relative Frobenius norm errors $\\,e_{\\star} = \\frac{\\| \\overline{C} - C_{\\star} \\|_{F}}{\\| \\overline{C} \\|_{F}}\\,$ for each class $\\,\\star \\in \\{\\mathrm{iso}, \\mathrm{cubic}, \\mathrm{TI}, \\mathrm{ortho}\\}\\,$ and pick the class with the smallest error.\n- Report the symmetry class as an integer code: $\\,0 \\to \\mathrm{isotropic}\\,$, $\\,1 \\to \\mathrm{cubic}\\,$, $\\,2 \\to \\mathrm{transversely\\ isotropic\\ about\\ } z\\,$, $\\,3 \\to \\mathrm{orthotropic\\ (aligned)}\\,$.\n\nUse the following five test cases. Each test case specifies a base stiffness tensor and a set of orientations with weights. Build each base stiffness tensor as stated, then perform the weighted averaging over the given orientations, and finally classify.\n\nConventions for constructing base tensors and rotations:\n- Build an isotropic stiffness tensor from bulk modulus $\\,\\kappa\\,$ and shear modulus $\\,\\mu\\,$ as $\\,C_{\\mathrm{iso}} = 3\\kappa\\,J + 2\\mu\\,K\\,$.\n- Build a cubic stiffness tensor from $\\,C_{11}, C_{12}, C_{44}\\,$ in Voigt notation, aligned with the Cartesian axes, and convert to full components $\\,C_{ijkl}\\,$ consistent with the minor and major symmetries.\n- Build an orthotropic stiffness tensor from engineering constants $\\,E_{1}, E_{2}, E_{3}, \\nu_{12}, \\nu_{23}, \\nu_{13}, G_{12}, G_{23}, G_{13}\\,$ by constructing the compliance matrix in Voigt form, enforcing reciprocal relations $\\,\\nu_{ji} = \\nu_{ij}\\,E_{j}/E_{i}\\,$, then inverting to get the stiffness in Voigt form, and converting to full components $\\,C_{ijkl}\\,$.\n- Use the $\\,\\mathrm{ZYX}\\,$ Euler convention for general orientations: $\\,R = R_{z}(\\alpha)\\,R_{y}(\\beta)\\,R_{x}(\\gamma)\\,$, with $\\,\\alpha, \\beta, \\gamma\\,$ in radians.\n- For pure rotations about $\\,z\\,$ by angle $\\,\\theta\\,$, use $\\,R_{z}(\\theta)\\,$.\n\nTest suite:\n- Test case $\\,1\\,$ (expected class: transversely isotropic about $\\,z\\,$, code $\\,2\\,$):\n  - Base tensor: orthotropic from engineering constants $\\,E_{1}=140\\,$, $\\,E_{2}=100\\,$, $\\,E_{3}=60\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{23}=0.20\\,$, $\\,\\nu_{13}=0.22\\,$, $\\,G_{12}=50\\,$, $\\,G_{23}=30\\,$, $\\,G_{13}=40\\,$.\n  - Orientations: $\\,\\theta_{k} = \\frac{2\\pi k}{36}\\,$ for $\\,k \\in \\{0,1,\\dots,35\\}\\,$ about $\\,z\\,$.\n  - Weights: uniform $\\,w^{(k)} = \\frac{1}{36}\\,$.\n- Test case $\\,2\\,$ (expected class: isotropic, code $\\,0\\,$):\n  - Base tensor: isotropic with $\\,\\kappa = 80\\,$ and $\\,\\mu = 30\\,$.\n  - Orientations (five $\\,\\mathrm{ZYX}\\,$ Euler triplets in radians):\n    - $\\,(\\alpha,\\beta,\\gamma) = (0.3, 1.0, -0.7)\\,$ with weight $\\,0.10\\,$,\n    - $\\,(\\alpha,\\beta,\\gamma) = (1.2, 0.5, 0.9)\\,$ with weight $\\,0.20\\,$,\n    - $\\,(\\alpha,\\beta,\\gamma) = (-0.8, 2.0, 1.5)\\,$ with weight $\\,0.30\\,$,\n    - $\\,(\\alpha,\\beta,\\gamma) = (2.4, -1.0, 0.4)\\,$ with weight $\\,0.25\\,$,\n    - $\\,(\\alpha,\\beta,\\gamma) = (-1.1, 1.3, -2.2)\\,$ with weight $\\,0.15\\,$.\n- Test case $\\,3\\,$ (expected class: cubic, code $\\,1\\,$):\n  - Base tensor: cubic with $\\,C_{11} = 240\\,$, $\\,C_{12} = 140\\,$, $\\,C_{44} = 80\\,$.\n  - Orientations: identity only $\\,R = I\\,$.\n  - Weights: $\\,1\\,$.\n- Test case $\\,4\\,$ (expected class: transversely isotropic about $\\,z\\,$, code $\\,2\\,$):\n  - Base tensor: cubic with $\\,C_{11} = 240\\,$, $\\,C_{12} = 140\\,$, $\\,C_{44} = 80\\,$.\n  - Orientations: $\\,\\theta_{k} = \\frac{2\\pi k}{36}\\,$ for $\\,k \\in \\{0,1,\\dots,35\\}\\,$ about $\\,z\\,$.\n  - Weights: uniform $\\,w^{(k)} = \\frac{1}{36}\\,$.\n- Test case $\\,5\\,$ (expected class: orthotropic, code $\\,3\\,$):\n  - Base tensor: same orthotropic tensor as in test case $\\,1\\,$.\n  - Orientations: identity only $\\,R = I\\,$.\n  - Weights: $\\,1\\,$.\n\nSymmetry projections to implement:\n- Isotropic: use invariants $\\,\\kappa = \\frac{1}{9} C_{iijj}\\,$ and $\\,\\mu = \\frac{1}{10}\\big(C_{ijij} - \\frac{1}{3} C_{iijj}\\big)\\,$ computed from the given $\\,C\\,$ and form $\\,C_{\\mathrm{iso}} = 3\\kappa\\,J + 2\\mu\\,K\\,$.\n- Cubic: group-average over the $\\,24\\,$ proper rotations of the cube (the rotational octahedral group).\n- Transversely isotropic about $\\,z\\,$: approximate the continuous group by uniform sampling with $\\,72\\,$ equally spaced rotations about $\\,z\\,$.\n- Orthotropic (aligned): group-average over the set $\\,\\{I, R_{x}(\\pi), R_{y}(\\pi), R_{z}(\\pi)\\}\\,$.\n\nYour program should produce a single line of output containing the resulting symmetry class codes for the five test cases as a comma-separated list enclosed in square brackets, for example $\\,\\big[2,0,1,2,3\\big]\\,$.", "solution": "The task is to implement a computational procedure to determine the effective elastic symmetry of a material microstructure represented by a weighted average of a base elasticity tensor over a set of discrete orientations. The classification is to be performed by finding the closest symmetric tensor among four candidate classes: isotropic, cubic, transversely isotropic, and orthotropic.\n\nThe solution is structured into five primary stages:\n1.  Representation and construction of the fourth-order elasticity tensor, $C_{ijkl}$.\n2.  Construction of the base elasticity tensors for each test case from given physical parameters.\n3.  Transformation of the base tensor under rotations and computation of the weighted average.\n4.  Projection of the averaged tensor onto each of the four specified symmetry subspaces.\n5.  Classification based on the minimum relative Frobenius norm error.\n\n**1. Tensor Representation and Conversion**\n\nThe elasticity tensor $C_{ijkl}$, relating stress $\\sigma_{ij}$ to strain $\\varepsilon_{kl}$ via Hooke's Law $\\sigma_{ij} = C_{ijkl} \\varepsilon_{kl}$, is a fourth-order tensor with $3^4 = 81$ components. Due to the symmetries of the stress and strain tensors, it possesses minor symmetries ($C_{ijkl} = C_{jikl} = C_{ijlk}$). Due to the existence of a strain-energy density function, it also possesses major symmetry ($C_{ijkl} = C_{klij}$). These symmetries reduce the number of independent components to at most $21$.\n\nFor computational purposes, it is convenient to use the $6 \\times 6$ Voigt matrix representation, $C_{IJ}$. The mapping from tensor indices $(i,j)$ (where $i, j \\in \\{1, 2, 3\\}$) to Voigt indices $I \\in \\{1, \\dots, 6\\}$ is defined as:\n$11 \\to 1$, $22 \\to 2$, $33 \\to 3$, $23 \\text{ or } 32 \\to 4$, $13 \\text{ or } 31 \\to 5$, $12 \\text{ or } 21 \\to 6$.\n\nA function will be implemented to convert a given $6 \\times 6$ Voigt matrix $C_{IJ}$ into the full $3 \\times 3 \\times 3 \\times 3$ tensor $C_{ijkl}$. Using $0$-based indexing for implementation, the mapping from pairs $(i,j)$ to a Voigt index is given by a dictionary: `{(0,0):0, (1,1):1, (2,2):2, (1,2):3, (2,1):3, (0,2):4, (2,0):4, (0,1):5, (1,0):5}`. The tensor components are then populated as $C_{ijkl} = C_{IJ}$ where $I$ is the Voigt index for $(i,j)$ and $J$ for $(k,l)$.\n\n**2. Base Tensor Construction**\n\nThree types of base tensors are required for the test cases.\n\n*   **Isotropic Tensor:** An isotropic tensor is defined by two independent constants, for instance, the bulk modulus $\\kappa$ and the shear modulus $\\mu$. It is constructed as $C_{\\mathrm{iso}} = 3\\kappa J + 2\\mu K$, where $J$ and $K$ are the standard fourth-order isotropic basis tensors:\n    $$\n    J_{ijkl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n    $$\n    $$\n    K_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n    $$\n    Here, $\\delta_{ij}$ is the Kronecker delta.\n\n*   **Cubic Tensor:** A cubic tensor, aligned with the coordinate axes, has three independent constants, often given in Voigt notation as $C_{11}$, $C_{12}$, and $C_{44}$. The $6 \\times 6$ Voigt matrix is constructed first and then converted to the full tensor representation.\n    $$\n    C_{\\mathrm{cubic}}^{\\mathrm{Voigt}} = \\begin{pmatrix}\n    C_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\\\\n    C_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\\\\n    C_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\\\\n    0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n    0 & 0 & 0 & 0 & C_{44} & 0 \\\\\n    0 & 0 & 0 & 0 & 0 & C_{44}\n    \\end{pmatrix}\n    $$\n\n*   **Orthotropic Tensor:** An orthotropic tensor is defined by nine independent constants. The problem specifies these as engineering constants: three Young's moduli ($E_1, E_2, E_3$), three Poisson's ratios ($\\nu_{12}, \\nu_{23}, \\nu_{13}$), and three shear moduli ($G_{12}, G_{23}, G_{13}$). The $6 \\times 6$ compliance matrix $S$ is constructed first, ensuring symmetry by enforcing the relations $\\nu_{ji} = \\nu_{ij} (E_j/E_i)$.\n    $$\n    S^{\\mathrm{Voigt}}_{11} = 1/E_1, \\quad S^{\\mathrm{Voigt}}_{12} = -\\nu_{12}/E_1, \\quad S^{\\mathrm{Voigt}}_{44} = 1/G_{23}, \\quad \\dots\n    $$\n    The stiffness matrix in Voigt form is obtained by inversion, $C^{\\mathrm{Voigt}} = (S^{\\mathrm{Voigt}})^{-1}$. This is then converted to the full tensor $C_{ijkl}$.\n\n**3. Tensor Transformation and Averaging**\n\n*   **Rotation:** A rotation of the coordinate system is described by a proper orthogonal matrix $R \\in \\mathrm{SO}(3)$, where $R^T R = I$ and $\\det(R)=1$. The components of the elasticity tensor in the new basis are given by the transformation law:\n    $$\n    C'_{ijkl} = R_{ip} R_{jq} R_{kr} R_{ls} C_{pqrs}\n    $$\n    This operation is a quadruple tensor product, which is efficiently computed using Einstein summation, e.g., `numpy.einsum`. Rotations are constructed either as simple rotations about a Cartesian axis or using the ZYX Euler angle convention $R = R_z(\\alpha) R_y(\\beta) R_x(\\gamma)$.\n\n*   **Weighted Averaging:** Given a set of $A$ discrete orientations $\\{R^{(a)}\\}$ with corresponding non-negative weights $\\{w^{(a)}\\}$ such that $\\sum_{a=1}^A w^{(a)} = 1$, the weighted arithmetic mean of the rotated tensors is:\n    $$\n    \\overline{C}_{ijkl} = \\sum_{a=1}^{A} w^{(a)} (C^{(a)})'_{ijkl} = \\sum_{a=1}^{A} w^{(a)} R^{(a)}_{ip} R^{(a)}_{jq} R^{(a)}_{kr} R^{(a)}_{ls} C_{pqrs}\n    $$\n    This yields the effective tensor $\\overline{C}$ for the composite material.\n\n**4. Symmetry Projections**\n\nThe core of the classification lies in projecting the averaged tensor $\\overline{C}$ onto the vector space of tensors belonging to each symmetry class. The projection $\\Pi_{\\mathcal{G}}(C)$ of a tensor $C$ onto the space of tensors invariant under a group $\\mathcal{G}$ is given by the group average:\n$$\n\\Pi_{\\mathcal{G}}(C) = \\frac{1}{|\\mathcal{G}|} \\sum_{g \\in \\mathcal{G}} g \\cdot C\n$$\nwhere $g \\cdot C$ denotes the rotation of $C$ by the group element $g$. This projection yields the closest tensor in the specified symmetry class, as measured by the Frobenius norm.\n\n*   **Isotropic Projection:** The projection $C_{\\mathrm{iso}}$ is obtained by first calculating the effective bulk and shear moduli of the tensor $\\overline{C}$ and then reconstructing an isotropic tensor from them.\n    $$\n    \\kappa = \\frac{1}{9} \\overline{C}_{iijj}, \\qquad \\mu = \\frac{1}{10} \\left( \\overline{C}_{ijij} - \\frac{1}{3} \\overline{C}_{iijj} \\right)\n    $$\n    Then, $C_{\\mathrm{iso}} = 3\\kappa J + 2\\mu K$.\n\n*   **Orthotropic Projection (aligned):** The symmetry group $\\mathcal{G}_{\\mathrm{ortho}}$ consists of the identity and rotations by $\\pi$ radians about the three Cartesian axes: $\\mathcal{G}_{\\mathrm{ortho}} = \\{I, R_x(\\pi), R_y(\\pi), R_z(\\pi)\\}$. The group size is $|\\mathcal{G}_{\\mathrm{ortho}}| = 4$.\n    $$\n    C_{\\mathrm{ortho}} = \\frac{1}{4} \\left( I\\cdot\\overline{C} + R_x(\\pi)\\cdot\\overline{C} + R_y(\\pi)\\cdot\\overline{C} + R_z(\\pi)\\cdot\\overline{C} \\right)\n    $$\n\n*   **Cubic Projection:** The symmetry group is the rotational octahedral group $\\mathcal{G}_{\\mathrm{cubic}}$, which has $|\\mathcal{G}_{\\mathrm{cubic}}| = 24$ elements. These are the proper rotations that leave a cube aligned with the coordinate axes invariant. We systematically generate these 24 rotation matrices and perform the group average.\n\n*   **Transversely Isotropic Projection (about z):** The symmetry group is the continuous special orthogonal group $\\mathrm{SO}(2)$ of rotations about the $z$-axis. The projection integral is approximated by a discrete sum over a sufficiently large number $N$ of uniformly spaced rotations. As specified, we use $N=72$.\n    $$\n    C_{\\mathrm{TI}} \\approx \\frac{1}{N} \\sum_{k=0}^{N-1} R_z(\\theta_k)\\cdot\\overline{C}, \\quad \\text{where } \\theta_k = \\frac{2\\pi k}{N}\n    $$\n\n**5. Classification Criterion**\n\nFor the averaged tensor $\\overline{C}$, we compute the four projections $C_{\\mathrm{iso}}$, $C_{\\mathrm{cubic}}$, $C_{\\mathrm{TI}}$, and $C_{\\mathrm{ortho}}$. The final classification is determined by selecting the symmetry class $\\star$ that minimizes the relative Frobenius norm error:\n$$\ne_{\\star} = \\frac{\\| \\overline{C} - C_{\\star} \\|_F}{\\| \\overline{C} \\|_F}\n$$\nwhere $\\|T\\|_F = \\sqrt{T_{ijkl} T_{ijkl}}$ is the Frobenius norm. The class corresponding to $\\min\\{e_{\\mathrm{iso}}, e_{\\mathrm{cubic}}, e_{\\mathrm{TI}}, e_{\\mathrm{ortho}}\\}$ is chosen, and its integer code ($0, 1, 2, \\text{ or } 3$) is reported. This procedure is applied to each of the five test cases specified. The implementation follows in the final answer.\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import inv\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n\n    # --- Tensor and Voigt Utilities ---\n\n    # 0-based index map: (i,j) -> Voigt index\n    VOIGT_MAP = {\n        (0, 0): 0, (1, 1): 1, (2, 2): 2,\n        (1, 2): 3, (2, 1): 3,\n        (0, 2): 4, (2, 0): 4,\n        (0, 1): 5, (1, 0): 5,\n    }\n\n    def voigt_to_tensor(c_voigt):\n        \"\"\"Converts a 6x6 Voigt stiffness matrix to a 3x3x3x3 tensor.\"\"\"\n        C = np.zeros((3, 3, 3, 3))\n        for i in range(3):\n            for j in range(3):\n                for k in range(3):\n                    for l in range(3):\n                        I = VOIGT_MAP[(i, j)]\n                        J = VOIGT_MAP[(k, l)]\n                        C[i, j, k, l] = c_voigt[I, J]\n        return C\n\n    # --- Base Tensor Construction ---\n\n    def build_iso_tensor(kappa, mu):\n        \"\"\"Builds an isotropic stiffness tensor from bulk and shear moduli.\"\"\"\n        delta = np.eye(3)\n        J = (1/3) * np.einsum('ij,kl->ijkl', delta, delta)\n        K_sym = 0.5 * (np.einsum('ik,jl->ijkl', delta, delta) + np.einsum('il,jk->ijkl', delta, delta))\n        K = K_sym - J\n        return 3 * kappa * J + 2 * mu * K\n\n    def build_cubic_tensor(c11, c12, c44):\n        \"\"\"Builds a cubic stiffness tensor from Voigt components.\"\"\"\n        C_voigt = np.zeros((6, 6))\n        C_voigt[0, 0] = C_voigt[1, 1] = C_voigt[2, 2] = c11\n        C_voigt[0, 1] = C_voigt[0, 2] = C_voigt[1, 2] = c12\n        C_voigt[1, 0] = C_voigt[2, 0] = C_voigt[2, 1] = c12\n        C_voigt[3, 3] = C_voigt[4, 4] = C_voigt[5, 5] = c44\n        return voigt_to_tensor(C_voigt)\n\n    def build_ortho_tensor(E1, E2, E3, nu12, nu23, nu13, G12, G23, G13):\n        \"\"\"Builds an orthotropic stiffness tensor from engineering constants.\"\"\"\n        # Enforce reciprocity for compliance matrix symmetry\n        nu21 = nu12 * E2 / E1\n        nu31 = nu13 * E3 / E1\n        nu32 = nu23 * E3 / E2\n        \n        S_voigt = np.array([\n            [1/E1, -nu21/E2, -nu31/E3, 0, 0, 0],\n            [-nu12/E1, 1/E2, -nu32/E3, 0, 0, 0],\n            [-nu13/E1, -nu23/E2, 1/E3, 0, 0, 0],\n            [0, 0, 0, 1/G23, 0, 0],\n            [0, 0, 0, 0, 1/G13, 0],\n            [0, 0, 0, 0, 0, 1/G12]\n        ])\n        C_voigt = inv(S_voigt)\n        return voigt_to_tensor(C_voigt)\n\n    # --- Rotation and Transformation ---\n\n    def get_rotation_matrix(axis, angle):\n        \"\"\"Generates a rotation matrix for a given axis and angle (radians).\"\"\"\n        axis = np.asarray(axis)\n        axis = axis / np.linalg.norm(axis)\n        c = np.cos(angle)\n        s = np.sin(angle)\n        t = 1 - c\n        x, y, z = axis\n        return np.array([\n            [t*x*x + c,   t*x*y - s*z, t*x*z + s*y],\n            [t*x*y + s*z, t*y*y + c,   t*y*z - s*x],\n            [t*x*z - s*y, t*y*z + s*x, t*z*z + c]\n        ])\n\n    def get_zyx_rotation(alpha, beta, gamma):\n        \"\"\"Generates a ZYX Euler rotation matrix.\"\"\"\n        Rx = get_rotation_matrix([1, 0, 0], gamma)\n        Ry = get_rotation_matrix([0, 1, 0], beta)\n        Rz = get_rotation_matrix([0, 0, 1], alpha)\n        return Rz @ Ry @ Rx\n\n    def rotate_tensor(C, R):\n        \"\"\"Rotates a fourth-order tensor C by rotation matrix R.\"\"\"\n        return np.einsum('ip,jq,kr,ls,pqrs->ijkl', R, R, R, R, C, optimize=True)\n\n    # --- Symmetry Groups and Projections ---\n\n    def get_cubic_group():\n        \"\"\"Generates the 24 rotation matrices of the cubic symmetry group.\"\"\"\n        group = []\n        p = list(itertools.permutations([0, 1, 2]))\n        for perm in p:\n            # Even permutations\n            if (perm[0] - perm[1]) * (perm[1] - perm[2]) * (perm[2] - perm[0]) > 0:\n                signs = [(1, 1, 1), (1, -1, -1), (-1, 1, -1), (-1, -1, 1)]\n            # Odd permutations\n            else:\n                signs = [(-1, -1, -1), (-1, 1, 1), (1, -1, 1), (1, 1, -1)]\n\n            for s in signs:\n                R = np.zeros((3, 3))\n                R[0, perm[0]] = s[0]\n                R[1, perm[1]] = s[1]\n                R[2, perm[2]] = s[2]\n                group.append(R)\n        return group\n\n    CUBIC_GROUP = get_cubic_group()\n    ORTHO_GROUP = [np.eye(3), \n                   get_rotation_matrix([1, 0, 0], np.pi),\n                   get_rotation_matrix([0, 1, 0], np.pi),\n                   get_rotation_matrix([0, 0, 1], np.pi)]\n\n    def project(C, group):\n        \"\"\"Projects tensor C onto the symmetry space defined by the group.\"\"\"\n        C_proj = np.zeros_like(C)\n        for R in group:\n            C_proj += rotate_tensor(C, R)\n        return C_proj / len(group)\n\n    def project_iso(C):\n        \"\"\"Projects tensor C onto the isotropic space.\"\"\"\n        C_iijj = np.einsum('iijj->', C)\n        C_ijij = np.einsum('ijij->', C)\n        kappa = C_iijj / 9.0\n        mu = (C_ijij - C_iijj / 3.0) / 10.0\n        return build_iso_tensor(kappa, mu)\n\n    def project_ti_z(C):\n        \"\"\"Projects tensor C onto the TI space (z-axis) via discrete average.\"\"\"\n        N = 72\n        C_proj = np.zeros_like(C)\n        for k in range(N):\n            theta = 2 * np.pi * k / N\n            R = get_rotation_matrix([0, 0, 1], theta)\n            C_proj += rotate_tensor(C, R)\n        return C_proj / N\n\n    # --- Test Cases and Main Logic ---\n\n    test_cases = [\n        # Case 1: Ortho base -> TI average\n        {\n            \"base_type\": \"ortho\",\n            \"params\": {\"E1\": 140, \"E2\": 100, \"E3\": 60, \"nu12\": 0.25, \"nu23\": 0.20, \"nu13\": 0.22,\n                       \"G12\": 50, \"G23\": 30, \"G13\": 40},\n            \"orientations\": [\n                {\"type\": \"z_rot\", \"angle\": 2 * np.pi * k / 36, \"weight\": 1/36} for k in range(36)\n            ]\n        },\n        # Case 2: Iso base -> Iso average\n        {\n            \"base_type\": \"iso\",\n            \"params\": {\"kappa\": 80, \"mu\": 30},\n            \"orientations\": [\n                {\"type\": \"zyx\", \"angles\": (0.3, 1.0, -0.7), \"weight\": 0.10},\n                {\"type\": \"zyx\", \"angles\": (1.2, 0.5, 0.9), \"weight\": 0.20},\n                {\"type\": \"zyx\", \"angles\": (-0.8, 2.0, 1.5), \"weight\": 0.30},\n                {\"type\": \"zyx\", \"angles\": (2.4, -1.0, 0.4), \"weight\": 0.25},\n                {\"type\": \"zyx\", \"angles\": (-1.1, 1.3, -2.2), \"weight\": 0.15},\n            ]\n        },\n        # Case 3: Cubic base -> Cubic\n        {\n            \"base_type\": \"cubic\",\n            \"params\": {\"c11\": 240, \"c12\": 140, \"c44\": 80},\n            \"orientations\": [{\"type\": \"identity\", \"weight\": 1.0}]\n        },\n        # Case 4: Cubic base -> TI average\n        {\n            \"base_type\": \"cubic\",\n            \"params\": {\"c11\": 240, \"c12\": 140, \"c44\": 80},\n            \"orientations\": [\n                {\"type\": \"z_rot\", \"angle\": 2 * np.pi * k / 36, \"weight\": 1/36} for k in range(36)\n            ]\n        },\n        # Case 5: Ortho base -> Ortho\n        {\n            \"base_type\": \"ortho\",\n            \"params\": {\"E1\": 140, \"E2\": 100, \"E3\": 60, \"nu12\": 0.25, \"nu23\": 0.20, \"nu13\": 0.22,\n                       \"G12\": 50, \"G23\": 30, \"G13\": 40},\n            \"orientations\": [{\"type\": \"identity\", \"weight\": 1.0}]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Build base tensor\n        if case[\"base_type\"] == \"iso\":\n            base_C = build_iso_tensor(**case[\"params\"])\n        elif case[\"base_type\"] == \"cubic\":\n            base_C = build_cubic_tensor(**case[\"params\"])\n        elif case[\"base_type\"] == \"ortho\":\n            base_C = build_ortho_tensor(**case[\"params\"])\n\n        # 2. Compute averaged tensor\n        avg_C = np.zeros((3, 3, 3, 3))\n        for o in case[\"orientations\"]:\n            if o[\"type\"] == \"identity\":\n                R = np.eye(3)\n            elif o[\"type\"] == \"z_rot\":\n                R = get_rotation_matrix([0, 0, 1], o[\"angle\"])\n            elif o[\"type\"] == \"zyx\":\n                R = get_zyx_rotation(*o[\"angles\"])\n            \n            avg_C += o[\"weight\"] * rotate_tensor(base_C, R)\n\n        # 3. Project onto symmetry classes\n        C_iso = project_iso(avg_C)\n        C_cubic = project(avg_C, CUBIC_GROUP)\n        C_ti = project_ti_z(avg_C)\n        C_ortho = project(avg_C, ORTHO_GROUP)\n        \n        projections = [C_iso, C_cubic, C_ti, C_ortho]\n\n        # 4. Calculate errors and classify\n        norm_avg_C = np.linalg.norm(avg_C)\n        if norm_avg_C  1e-9: # Handle zero tensor case\n             errors = [np.linalg.norm(p) for p in projections]\n        else:\n             errors = [np.linalg.norm(avg_C - p) / norm_avg_C for p in projections]\n        \n        class_code = np.argmin(errors)\n        results.append(class_code)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "answer": "$$\n\\boxed{[2,0,1,2,3]}\n$$", "id": "2697083"}]}