{"hands_on_practices": [{"introduction": "The cornerstone of plasticity theory is the yield criterion, which defines the boundary of the elastic domain in stress space. This first practice solidifies your understanding of this fundamental concept by applying the von Mises ($J_2$) yield criterion to a given multiaxial stress state. By starting from first principles to compute the deviatoric stress and its second invariant, you will gain hands-on experience in the essential calculation used to determine whether a material has yielded. [@problem_id:2652054]", "problem": "A homogeneous, isotropic metal at small strain obeys a rate-independent $J_2$ (second invariant of the deviatoric stress) plasticity model with combined hardening, but at the loading instant of interest the kinematic backstress is zero and the isotropic hardening radius equals the current yield stress. The Cauchy stress tensor is diagonal with principal stresses and all shear components zero, specifically $\\boldsymbol{\\sigma}=\\operatorname{diag}(300,150,0)\\,\\text{MPa}$. The current yield stress is $\\sigma_{y}=200\\,\\text{MPa}$. \n\nStarting from the fundamental definitions of mean stress, deviatoric stress, and the second invariant $J_2$ of the deviatoric stress, compute the von Mises equivalent stress $\\sigma_{eq}$ and use the $J_2$ yield criterion with isotropic hardening to decide whether the state is elastic or plastic. \n\nReport only the numerical value of $\\sigma_{eq}$, expressed in megapascal (MPa) and rounded to four significant figures, as your final answer. Any classification (elastic or plastic) should be justified in your working but not included in the final reported number.", "solution": "The problem statement is well-posed, internally consistent, and scientifically grounded in the principles of continuum mechanics. We may proceed with the solution.\n\nThe task is to compute the von Mises equivalent stress, $\\sigma_{eq}$, for the given stress state and determine if the material is yielding. The analysis will proceed from the fundamental definitions as demanded.\n\nThe given Cauchy stress tensor, $\\boldsymbol{\\sigma}$, is diagonal, meaning the coordinate axes align with the principal stress directions. The principal stresses are:\n$$ \\sigma_1 = 300\\,\\text{MPa} $$\n$$ \\sigma_2 = 150\\,\\text{MPa} $$\n$$ \\sigma_3 = 0\\,\\text{MPa} $$\nIn matrix form, the stress tensor is:\n$$ \\boldsymbol{\\sigma} = \\begin{pmatrix} 300  0  0 \\\\ 0  150  0 \\\\ 0  0  0 \\end{pmatrix} \\,\\text{MPa} $$\n\nFirst, we compute the mean stress (or hydrostatic stress), $\\sigma_m$, which is defined as one-third of the trace of the stress tensor, $\\operatorname{tr}(\\boldsymbol{\\sigma})$:\n$$ \\sigma_m = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3} (\\sigma_1 + \\sigma_2 + \\sigma_3) $$\nSubstituting the given principal stress values:\n$$ \\sigma_m = \\frac{1}{3} (300 + 150 + 0) = \\frac{450}{3} = 150\\,\\text{MPa} $$\nThe mean stress represents the purely volumetric component of the stress state.\n\nSecond, we determine the deviatoric stress tensor, $\\boldsymbol{s}$, which causes shape change (distortion). It is obtained by subtracting the hydrostatic part from the total stress tensor:\n$$ \\boldsymbol{s} = \\boldsymbol{\\sigma} - \\sigma_m \\boldsymbol{I} $$\nwhere $\\boldsymbol{I}$ is the second-order identity tensor. The principal components of the deviatoric stress tensor are:\n$$ s_1 = \\sigma_1 - \\sigma_m = 300 - 150 = 150\\,\\text{MPa} $$\n$$ s_2 = \\sigma_2 - \\sigma_m = 150 - 150 = 0\\,\\text{MPa} $$\n$$ s_3 = \\sigma_3 - \\sigma_m = 0 - 150 = -150\\,\\text{MPa} $$\nThe deviatoric stress tensor in matrix form is:\n$$ \\boldsymbol{s} = \\begin{pmatrix} 150  0  0 \\\\ 0  0  0 \\\\ 0  0  -150 \\end{pmatrix} \\,\\text{MPa} $$\nBy definition, the deviatoric stress tensor is traceless: $\\operatorname{tr}(\\boldsymbol{s}) = 150 + 0 + (-150) = 0$.\n\nThird, we compute the second invariant of the deviatoric stress tensor, $J_2$. This scalar quantity is a measure of the magnitude of the deviatoric stress and is central to the von Mises yield criterion. It is defined as:\n$$ J_2 = \\frac{1}{2} s_{ij}s_{ji} = \\frac{1}{2} \\operatorname{tr}(\\boldsymbol{s}^2) $$\nUsing the principal deviatoric stresses, this becomes:\n$$ J_2 = \\frac{1}{2} (s_1^2 + s_2^2 + s_3^2) $$\nSubstituting the computed values:\n$$ J_2 = \\frac{1}{2} (150^2 + 0^2 + (-150)^2) = \\frac{1}{2} (22500 + 0 + 22500) = \\frac{45000}{2} = 22500\\,\\text{MPa}^2 $$\n\nThe von Mises equivalent stress, $\\sigma_{eq}$, is related to $J_2$ by the definition:\n$$ \\sigma_{eq} = \\sqrt{3 J_2} $$\nSubstituting the value of $J_2$:\n$$ \\sigma_{eq} = \\sqrt{3 \\times 22500} = \\sqrt{67500} = 150\\sqrt{3}\\,\\text{MPa} $$\n\nTo check for elastic or plastic behavior, we compare $\\sigma_{eq}$ with the current yield stress, $\\sigma_y$. The problem states that kinematic backstress is zero, and the isotropic hardening radius is equal to the current yield stress, $\\sigma_y = 200\\,\\text{MPa}$. The yield function for $J_2$ plasticity with isotropic hardening is:\n$$ f = \\sigma_{eq} - \\sigma_y $$\nThe state is elastic if $f  0$, and plastic if $f \\ge 0$. We must first evaluate $\\sigma_{eq}$ numerically:\n$$ \\sigma_{eq} = 150\\sqrt{3} \\approx 150 \\times 1.7320508... \\approx 259.8076...\\,\\text{MPa} $$\nNow, we evaluate the yield function:\n$$ f \\approx 259.81\\,\\text{MPa} - 200\\,\\text{MPa} = 59.81\\,\\text{MPa} $$\nSince $f > 0$ (or, equivalently, $\\sigma_{eq} > \\sigma_y$), the material is currently in a plastic state.\n\nThe problem requests the final answer as the numerical value of $\\sigma_{eq}$ in megapascal, rounded to four significant figures.\n$$ \\sigma_{eq} \\approx 259.8\\,\\text{MPa} $$\nThis is the value to be reported.", "answer": "$$\\boxed{259.8}$$", "id": "2652054"}, {"introduction": "Hardening models describe how a material’s resistance to plastic flow evolves with deformation, and combined hardening models are essential for capturing complex cyclic behaviors. This exercise challenges you to analytically trace the stress-strain response of a material with both linear isotropic and kinematic hardening through a full loading and reversal cycle. Successfully completing this practice will provide deep insight into how these models work together to represent key phenomena like the Bauschinger effect, where the yield strength is reduced upon load reversal. [@problem_id:2652033]", "problem": "A rate-independent, small-strain, uniaxial specimen made of a metallic alloy is modeled by isotropic linear elasticity combined with classical von Mises ($J_2$) plasticity with associated flow, linear kinematic hardening (Prager’s rule), and linear isotropic hardening. Let the elastic modulus be $E = 210 \\times 10^{3} \\ \\mathrm{MPa}$, the initial yield stress be $\\sigma_{y0} = 250 \\ \\mathrm{MPa}$, the kinematic hardening modulus be $H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$, and the isotropic hardening modulus be $H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$. The initial state is stress-free and plastic-strain-free with zero backstress and zero isotropic hardening variable.\n\nA prescribed uniaxial strain history is applied quasi-statically as follows: starting from $\\varepsilon = 0$, the axial strain increases monotonically to $\\varepsilon = 0.006$, and then monotonically decreases to $\\varepsilon = -0.002$. Assume small strain kinematics $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$, linear elasticity $\\sigma = E \\, \\varepsilon^{e}$, the von Mises yield condition with kinematic and isotropic hardening in the uniaxial case, and associated flow. Use the scalar reduced uniaxial equations consistent with these definitions to compute the evolution of the backstress $\\alpha(\\varepsilon)$, the accumulated plastic strain $\\kappa(\\varepsilon)$, and the axial Cauchy stress $\\sigma(\\varepsilon)$ along the entire history, identifying the elastic and plastic segments and the reversal point at which yielding re-initiates in reverse.\n\nReport only the final axial Cauchy stress at the end of the loading history, that is, at $\\varepsilon = -0.002$. Express the stress in $\\mathrm{MPa}$ and round your answer to four significant figures.", "solution": "The problem is first validated.\n\nStep 1: Extract Givens\n- Material model: Rate-independent, small-strain, uniaxial, isotropic linear elasticity with von Mises ($J_2$) plasticity.\n- Hardening model: Combined linear kinematic hardening (Prager's rule) and linear isotropic hardening.\n- Elastic modulus: $E = 210 \\times 10^{3} \\ \\mathrm{MPa}$.\n- Initial yield stress: $\\sigma_{y0} = 250 \\ \\mathrm{MPa}$.\n- Kinematic hardening modulus: $H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$.\n- Isotropic hardening modulus: $H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$.\n- Initial conditions: stress-free, plastic-strain-free, zero backstress, zero accumulated plastic strain.\n- Strain history: Monotonic increase from $\\varepsilon = 0$ to $\\varepsilon = 0.006$, then monotonic decrease to $\\varepsilon = -0.002$.\n- Kinematics: Small strain, $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$.\n- Constitutive relations: $\\sigma = E \\, \\varepsilon^{e}$, associated flow rule.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, objective, and complete. It describes a standard problem in the theory of plasticity, a subfield of solid mechanics. All necessary parameters and initial/boundary conditions are provided. The model is a classical one (von Mises plasticity with combined hardening), and the request is to apply it to a simple uniaxial loading path. The problem does not violate any scientific principles, is not ambiguous, and is directly related to the topic of hardening models in plasticity.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe problem requires the calculation of the final stress in a specimen undergoing a prescribed uniaxial strain history. The material behavior is governed by linear elasticity and $J_2$ plasticity with combined linear isotropic and kinematic hardening.\n\nThe fundamental equations for the uniaxial case are:\n1.  Additive decomposition of strain: $\\varepsilon = \\varepsilon^e + \\varepsilon^p$, where $\\varepsilon$ is the total strain, $\\varepsilon^e$ is the elastic strain, and $\\varepsilon^p$ is the plastic strain.\n2.  Linear elastic law: $\\sigma = E \\varepsilon^e = E(\\varepsilon - \\varepsilon^p)$.\n3.  Yield condition: The von Mises criterion with combined hardening reduces to $f(\\sigma, \\alpha, \\kappa) = |\\sigma - \\alpha| - (\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa) \\le 0$, where $\\alpha$ is the backstress and $\\kappa$ is the accumulated plastic strain.\n4.  Hardening laws:\n    -   Kinematic hardening (Prager's rule): $\\dot{\\alpha} = H_{\\mathrm{kin}} \\dot{\\varepsilon}^p$.\n    -   Isotropic hardening: $\\dot{\\kappa} = |\\dot{\\varepsilon}^p|$.\n5.  Flow rule: Associated flow implies $\\dot{\\varepsilon}^p = \\dot{\\lambda} \\operatorname{sgn}(\\sigma - \\alpha)$, where $\\dot{\\lambda} \\ge 0$ is the plastic multiplier. The Kuhn-Tucker conditions apply: $\\dot{\\lambda} \\ge 0$, $f \\le 0$, $\\dot{\\lambda}f = 0$.\n\nThe analysis is performed in segments corresponding to the applied strain history.\n\nPart 1: Monotonic loading from $\\varepsilon = 0$ to $\\varepsilon_1 = 0.006$.\n\nSegment A: Elastic Loading ($0 \\le \\varepsilon \\le \\varepsilon_y$)\nInitially, $\\varepsilon^p = 0$, $\\alpha = 0$, $\\kappa = 0$. The response is elastic: $\\sigma = E\\varepsilon$.\nYielding initiates when $|\\sigma| = \\sigma_{y0}$. Since loading is tensile, this occurs at $\\sigma = \\sigma_{y0}$. The corresponding yield strain is:\n$$ \\varepsilon_y = \\frac{\\sigma_{y0}}{E} = \\frac{250}{210 \\times 10^3} = \\frac{1}{840} \\approx 0.00119 $$\nSince $\\varepsilon_1 = 0.006 > \\varepsilon_y$, plastic deformation will occur.\n\nSegment B: Plastic Loading ($\\varepsilon_y  \\varepsilon \\le \\varepsilon_1 = 0.006$)\nIn this segment, the yield criterion is active: $\\sigma - \\alpha = \\sigma_{y0} + H_{\\mathrm{iso}}\\kappa$. Differentiating with respect to a time-like parameter gives $\\dot{\\sigma} - \\dot{\\alpha} = H_{\\mathrm{iso}}\\dot{\\kappa}$.\nFor tensile plastic loading, $\\dot{\\varepsilon}^p > 0$, so $\\dot{\\kappa} = \\dot{\\varepsilon}^p$. The hardening rates are $\\dot{\\alpha} = H_{\\mathrm{kin}}\\dot{\\varepsilon}^p$ and $\\dot{\\kappa} = \\dot{\\varepsilon}^p$.\nThe stress rate is $\\dot{\\sigma} = E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p)$.\nSubstituting these into the consistency condition:\n$$ E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p) - H_{\\mathrm{kin}}\\dot{\\varepsilon}^p = H_{\\mathrm{iso}}\\dot{\\varepsilon}^p $$\n$$ E\\dot{\\varepsilon} = (E + H_{\\mathrm{kin}} + H_{\\mathrm{iso}})\\dot{\\varepsilon}^p $$\nThe plastic strain rate is $\\dot{\\varepsilon}^p = \\frac{E}{E + H}\\dot{\\varepsilon}$, where $H = H_{\\mathrm{kin}} + H_{\\mathrm{iso}}$.\nThe tangent modulus in the plastic range is $E_T = \\frac{d\\sigma}{d\\varepsilon} = E(1 - \\frac{\\dot{\\varepsilon}^p}{\\dot{\\varepsilon}}) = E(1 - \\frac{E}{E+H}) = \\frac{EH}{E+H}$.\nLet's compute the values for the state at the reversal point, $\\varepsilon_1 = 0.006$:\n$H = 4000 + 600 = 4600 \\ \\mathrm{MPa}$.\n$E+H = 210000 + 4600 = 214600 \\ \\mathrm{MPa}$.\n$E_T = \\frac{210000 \\times 4600}{214600} \\approx 4501.4 \\ \\mathrm{MPa}$.\nThe stress at $\\varepsilon_1$ is:\n$$ \\sigma_1 = \\sigma_{y0} + E_T (\\varepsilon_1 - \\varepsilon_y) = 250 + \\frac{210000 \\times 4600}{214600} \\left(0.006 - \\frac{250}{210000}\\right) $$\n$$ \\sigma_1 = 250 + \\left(\\frac{4830000}{1073}\\right) \\left(\\frac{101}{21000}\\right) = 250 + \\frac{23230}{1073} = \\frac{291480}{1073} \\approx 271.65 \\ \\mathrm{MPa} $$\nThe total plastic strain at this point is found by integrating the plastic strain rate:\n$$ \\varepsilon_1^p = \\int_{\\varepsilon_y}^{\\varepsilon_1} \\frac{E}{E+H} d\\varepsilon = \\frac{E}{E+H} (\\varepsilon_1 - \\varepsilon_y) = \\frac{210000}{214600} \\left(0.006 - \\frac{1}{840}\\right) = \\frac{101}{21460} \\approx 0.0047064 $$\nThe internal state variables at reversal are:\n$$ \\kappa_1 = \\varepsilon_1^p = \\frac{101}{21460} \\approx 0.0047064 $$\n$$ \\alpha_1 = H_{\\mathrm{kin}} \\varepsilon_1^p = 4000 \\left(\\frac{101}{21460}\\right) = \\frac{20200}{1073} \\approx 18.83 \\ \\mathrm{MPa} $$\n\nPart 2: Monotonic unloading from $\\varepsilon_1 = 0.006$ to $\\varepsilon_f = -0.002$.\n\nSegment C: Elastic Unloading ($\\varepsilon_{ry}  \\varepsilon \\le \\varepsilon_1$)\nUpon reversal, the material unloads elastically. The plastic strain and internal variables remain constant: $\\varepsilon^p = \\varepsilon_1^p$, $\\alpha = \\alpha_1$, $\\kappa = \\kappa_1$.\nThe stress-strain relation is $\\sigma - \\sigma_1 = E(\\varepsilon - \\varepsilon_1)$.\nReverse yielding occurs when the yield criterion is met in compression: $\\sigma - \\alpha_1 = -(\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa_1)$.\nThe stress at reverse yield, $\\sigma_{ry}$, is:\n$$ \\sigma_{ry} = \\alpha_1 - (\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa_1) = \\frac{20200}{1073} - \\left(250 + 600 \\times \\frac{101}{21460}\\right) = \\frac{20200}{1073} - \\left(250 + \\frac{3030}{1073}\\right) = \\frac{17170}{1073} - 250 = -\\frac{251080}{1073} \\approx -234.00 \\ \\mathrm{MPa} $$\nThe size of the elastic stress range is $\\sigma_1 - \\sigma_{ry} = 2(\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa_1) = 2(250 + 600 \\frac{101}{21460}) = \\frac{542560}{1073} \\approx 505.65 \\ \\mathrm{MPa}$.\nThe strain at reverse yield, $\\varepsilon_{ry}$, is:\n$$ \\varepsilon_{ry} = \\varepsilon_1 + \\frac{\\sigma_{ry} - \\sigma_1}{E} = 0.006 - \\frac{2(\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa_1)}{E} = 0.006 - \\frac{542560}{1073 \\times 210000} \\approx 0.006 - 0.0024078 = 0.0035922 $$\n\nSegment D: Reverse Plastic Loading ($\\varepsilon_f \\le \\varepsilon \\le \\varepsilon_{ry}$)\nThe final target strain is $\\varepsilon_f = -0.002$. Since $\\varepsilon_f  \\varepsilon_{ry}$, the material undergoes reverse plastic flow. The tangent modulus for reverse plastic flow is the same, $E_T = \\frac{EH}{E+H}$.\nThe final stress $\\sigma_f$ is found by starting from the reverse yield point and following the plastic stress-strain path:\n$$ \\sigma_f = \\sigma_{ry} + E_T(\\varepsilon_f - \\varepsilon_{ry}) $$\nThe strain increment in this plastic segment is $\\Delta\\varepsilon_{pl} = \\varepsilon_f - \\varepsilon_{ry} \\approx -0.002 - 0.0035922 = -0.0055922$.\nThe stress increment is $\\Delta\\sigma_{pl} = E_T \\Delta\\varepsilon_{pl} \\approx 4501.4 \\times (-0.0055922) \\approx -25.17 \\ \\mathrm{MPa}$.\nThe final stress is:\n$$ \\sigma_f = \\sigma_{ry} + \\Delta\\sigma_{pl} \\approx -234.00 + (-25.17) = -259.17 \\ \\mathrm{MPa} $$\nLet us perform the calculation with exact fractions for precision:\n$$ \\sigma_f = -\\frac{251080}{1073} + \\left(\\frac{210000 \\times 4600}{214600}\\right) \\left(-0.002 - \\left(0.006 - \\frac{2(\\sigma_{y0} + H_{\\mathrm{iso}}\\kappa_1)}{E}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} + E_T \\left(-0.008 + \\frac{2}{E}\\left(250 + \\frac{3030}{1073}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} + \\frac{4830000}{1073} \\left(-0.008 + \\frac{2}{210000}\\frac{271280}{1073}\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} - \\frac{38640}{1073} + \\frac{4830000}{1073} \\frac{542560}{210000 \\times 1073} $$\n$$ \\sigma_f = -\\frac{289720}{1073} + \\frac{23 \\times 542560}{1073^2} = \\frac{-289720 \\times 1073 + 12478880}{1073^2} $$\n$$ \\sigma_f = \\frac{-310869560 + 12478880}{1151329} = -\\frac{298390680}{1151329} \\approx -259.17019 \\ \\mathrm{MPa} $$\nRounding to four significant figures, the final axial stress is $-259.2 \\ \\mathrm{MPa}$.", "answer": "$$ \\boxed{-259.2} $$", "id": "2652033"}, {"introduction": "Translating constitutive theories into robust numerical solvers is a critical skill in modern solid mechanics. This final practice guides you through the development of a return-mapping algorithm, the standard method for integrating elastoplastic equations in computational software. You will implement the full elastic-predictor and plastic-corrector sequence for a uniaxial case with combined hardening, providing a concrete understanding of how these complex material models are put into practice. [@problem_id:2652024]", "problem": "Implement a small-strain uniaxial return-mapping algorithm (radial return) for an elastic-plastic material with linear isotropic hardening, linear kinematic hardening, and their combination. The problem is posed in purely mathematical terms with physically meaningful units: stress in megapascals (MPa) and strain dimensionless. Start from the additive strain decomposition, linear elasticity, and an associative rate-independent plasticity model with a uniaxial yield function. Do not use any pre-derived update shortcut formula; derive the update by enforcing consistency at the end of the increment.\n\nAssume the following constitutive structure in uniaxial small strain:\n- Additive decomposition: $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$.\n- Linear elasticity: $\\sigma = E\\,\\varepsilon^{e}$ with Young’s modulus $E$.\n- Yield function in uniaxial form: $f(\\sigma,\\alpha,\\kappa) = |\\sigma - \\alpha| - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa\\right)$, where $\\alpha$ is the uniaxial backstress for kinematic hardening, $\\kappa$ is the accumulated plastic strain, $\\sigma_{y}^{0}$ is the initial yield stress, and $H_{\\text{iso}}$ is the linear isotropic hardening modulus.\n- Associative flow rule and hardening evolution in rate form: $\\dot{\\varepsilon}^{p} = \\dot{\\gamma}\\,\\operatorname{sign}(\\sigma-\\alpha)$, $\\dot{\\kappa} = \\dot{\\gamma}$, and $\\dot{\\alpha} = C\\,\\dot{\\varepsilon}^{p}$, where $\\dot{\\gamma} \\ge 0$ is the plastic multiplier enforcing $f \\le 0$ and $\\dot{\\gamma} f = 0$.\n\nGiven a strain increment $\\Delta \\varepsilon$ over a time step from state $n$ to $n+1$ with known state variables $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$, implement the following algorithm to compute $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$:\n\n1. Compute the elastic trial stress using $\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta \\varepsilon$.\n2. Evaluate the trial yield function $f_{\\text{tr}} = |\\sigma_{\\text{tr}} - \\alpha^{n}| - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right)$.\n3. If $f_{\\text{tr}} \\le 0$ (within a numerical tolerance you must define), accept an elastic step with $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}) = (\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$.\n4. If $f_{\\text{tr}} > 0$, enforce plastic consistency at $n+1$ with associative flow and linear hardening to determine the plastic correction. Use a return-mapping that preserves the loading direction $\\operatorname{sign}(\\sigma_{\\text{tr}}-\\alpha^{n})$ during the increment, and update $(\\sigma, \\varepsilon^{p}, \\kappa, \\alpha)$ accordingly.\n\nDesign a program that applies this update for a fixed test suite of cases. All stresses (including the backstress $\\alpha$) must be expressed in $\\mathrm{MPa}$, and all strains (including $\\varepsilon^{p}$ and $\\kappa$) are dimensionless. The output for each test case must be a list of four floats rounded to six decimal places in the order $[\\sigma^{n+1}\\,(\\mathrm{MPa}), \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}\\,(\\mathrm{MPa})]$.\n\nTest Suite (use exactly these parameter values):\n- Case A (isotropic hardening only, plastic step): $E = 210000\\,\\mathrm{MPa}$, $\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$, $H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$, $C = 0\\,\\mathrm{MPa}$, $\\sigma^{n} = 0\\,\\mathrm{MPa}$, $\\varepsilon^{p\\,n} = 0$, $\\kappa^{n} = 0$, $\\alpha^{n} = 0\\,\\mathrm{MPa}$, $\\Delta \\varepsilon = 0.003$.\n- Case B (isotropic hardening only, elastic step): $E = 210000\\,\\mathrm{MPa}$, $\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$, $H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$, $C = 0\\,\\mathrm{MPa}$, $\\sigma^{n} = 0\\,\\mathrm{MPa}$, $\\varepsilon^{p\\,n} = 0$, $\\kappa^{n} = 0$, $\\alpha^{n} = 0\\,\\mathrm{MPa}$, $\\Delta \\varepsilon = 0.001$.\n- Case C (kinematic hardening only, plastic step): $E = 210000\\,\\mathrm{MPa}$, $\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$, $H_{\\text{iso}} = 0\\,\\mathrm{MPa}$, $C = 30000\\,\\mathrm{MPa}$, $\\sigma^{n} = 260\\,\\mathrm{MPa}$, $\\alpha^{n} = 50\\,\\mathrm{MPa}$, $\\varepsilon^{p\\,n} = 50/30000$, $\\kappa^{n} = 50/30000$, $\\Delta \\varepsilon = 0.002$.\n- Case D (combined hardening with reverse loading, plastic step): $E = 210000\\,\\mathrm{MPa}$, $\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$, $H_{\\text{iso}} = 2000\\,\\mathrm{MPa}$, $C = 40000\\,\\mathrm{MPa}$, $\\sigma^{n} = 376\\,\\mathrm{MPa}$, $\\alpha^{n} = 120\\,\\mathrm{MPa}$, $\\varepsilon^{p\\,n} = 120/40000$, $\\kappa^{n} = 120/40000$, $\\Delta \\varepsilon = -0.003$.\n- Case E (boundary case exactly at yield, elastic): $E = 210000\\,\\mathrm{MPa}$, $\\sigma_{y}^{0} = 300\\,\\mathrm{MPa}$, $H_{\\text{iso}} = 500\\,\\mathrm{MPa}$, $C = 0\\,\\mathrm{MPa}$, $\\sigma^{n} = 200\\,\\mathrm{MPa}$, $\\alpha^{n} = 0\\,\\mathrm{MPa}$, $\\kappa^{n} = 0.1$, $\\varepsilon^{p\\,n} = 0.1$, $\\Delta \\varepsilon = (350 - 200)/210000$.\n\nYour program should apply the same algorithm to all cases above. Use a strict but reasonable numerical tolerance when deciding $f_{\\text{tr}} \\le 0$ for elasticity. The final program output must be a single line containing a list of results for Cases A–E in order, formatted as a comma-separated Python-like list of lists with each float rounded to six decimal places; for example, in the form $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$.", "solution": "The problem requires the implementation of a uniaxial return-mapping algorithm for a generalized elastic-plastic material model incorporating both linear isotropic and linear kinematic hardening. The derivation must proceed from first principles, specifically the additive strain decomposition, linear elasticity, the given yield criterion, and the associative flow and hardening rules. A numerical tolerance for the elastic-plastic transition must be defined; a value of $10^{-7}$ is chosen, as it is sufficiently small relative to the stress magnitudes ($\\mathrm{MPa}$) to ensure accuracy.\n\nThe objective is to compute the state variables $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$ at the end of an increment, given the state at the beginning of the increment $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$ and the total strain increment $\\Delta \\varepsilon$.\n\nThe algorithm begins with an elastic trial step. The trial stress, $\\sigma_{\\text{tr}}$, is computed assuming the entire strain increment $\\Delta\\varepsilon$ is purely elastic:\n$$ \\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon $$\nThe trial state is then checked against the yield condition using the state variables from step $n$:\n$$ f_{\\text{tr}} = |\\sigma_{\\text{tr}} - \\alpha^{n}| - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right) $$\nIf $f_{\\text{tr}} \\le 0$, the assumption of a purely elastic step is correct. The material has not yielded, or is unloading elastically. The final state is the trial state:\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}}, \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n}, \\quad \\kappa^{n+1} = \\kappa^{n}, \\quad \\alpha^{n+1} = \\alpha^{n} $$\nIf $f_{\\text{tr}} > 0$, the trial state lies outside the yield surface, which is physically inadmissible. A plastic correction is required. This correction, known as the return map, must bring the stress state back to an updated yield surface, satisfying the consistency condition $f^{n+1}(\\sigma^{n+1}, \\alpha^{n+1}, \\kappa^{n+1}) = 0$.\n\nThe plastic evolution is governed by the associative flow and hardening rules, which are integrated over the increment using a backward Euler scheme. This is a standard implicit method that ensures unconditional stability. The increments of the plastic state variables are:\n$$ \\Delta\\varepsilon^{p} = \\varepsilon^{p\\,n+1} - \\varepsilon^{p\\,n} = \\Delta\\gamma \\, \\operatorname{sign}(\\sigma^{n+1} - \\alpha^{n+1}) $$\n$$ \\Delta\\kappa = \\kappa^{n+1} - \\kappa^{n} = \\Delta\\gamma $$\n$$ \\Delta\\alpha = \\alpha^{n+1} - \\alpha^{n} = C\\,\\Delta\\varepsilon^{p} $$\nwhere $\\Delta\\gamma \\ge 0$ is the total consistency parameter over the increment.\n\nThe return-mapping algorithm assumes that the direction of plastic flow remains constant throughout the correction and is determined by the trial state. Let this direction be $R$:\n$$ R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n}) $$\nThis simplifies the evolution equations:\n$$ \\Delta\\varepsilon^{p} = \\Delta\\gamma \\, R \\quad \\implies \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma \\, R $$\n$$ \\Delta\\kappa = \\Delta\\gamma \\quad \\implies \\quad \\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma $$\n$$ \\Delta\\alpha = C \\, \\Delta\\gamma \\, R \\quad \\implies \\quad \\alpha^{n+1} = \\alpha^{n} + C \\, \\Delta\\gamma \\, R $$\nThe stress at step $n+1$ is obtained by correcting the trial stress for the plastic strain that occurs during the increment:\n$$ \\sigma^{n+1} = E (\\varepsilon^{n+1} - \\varepsilon^{p\\,n+1}) = E(\\varepsilon^n + \\Delta\\varepsilon - \\varepsilon^{p,n} - \\Delta\\varepsilon^p) = \\sigma^n + E\\Delta\\varepsilon - E\\Delta\\varepsilon^p = \\sigma_{\\text{tr}} - E\\,\\Delta\\varepsilon^{p} $$\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R $$\nAll updated state variables are now expressed in terms of the single unknown scalar $\\Delta\\gamma$. To find $\\Delta\\gamma$, we enforce the plastic consistency condition $f^{n+1} = 0$:\n$$ f^{n+1} = |\\sigma^{n+1} - \\alpha^{n+1}| - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1}\\right) = 0 $$\nLet us substitute the expressions for the updated variables. First, the relative stress:\n$$ \\sigma^{n+1} - \\alpha^{n+1} = (\\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R) - (\\alpha^{n} + C\\,\\Delta\\gamma\\,R) = (\\sigma_{\\texttr} - \\alpha^{n}) - (E+C)\\,\\Delta\\gamma\\,R $$\nSince the plastic correction reduces the magnitude of the relative stress from the trial value, the term $(\\sigma^{n+1} - \\alpha^{n+1})$ maintains the same sign $R$ as $(\\sigma_{\\text{tr}} - \\alpha^{n})$. Thus, we can take the absolute value:\n$$ |\\sigma^{n+1} - \\alpha^{n+1}| = |\\sigma_{\\text{tr}} - \\alpha^{n}| - (E+C)\\,\\Delta\\gamma $$\nThe updated yield stress is:\n$$ \\sigma_{y}^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,(\\kappa^{n} + \\Delta\\gamma) $$\nEquating the two expressions as per the consistency condition:\n$$ |\\sigma_{\\text{tr}} - \\alpha^{n}| - (E+C)\\,\\Delta\\gamma = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n} + H_{\\text{iso}}\\,\\Delta\\gamma $$\nRearranging to solve for $\\Delta\\gamma$:\n$$ |\\sigma_{\\text{tr}} - \\alpha^{n}| - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}) = (E + C + H_{\\text{iso}})\\,\\Delta\\gamma $$\nThe left-hand side is precisely the trial yield function value, $f_{\\text{tr}}$. This yields the final expression for the plastic multiplier increment:\n$$ \\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}} $$\nSince $f_{\\text{tr}} > 0$ and the material moduli $E, C, H_{\\text{iso}}$ are non-negative ($E > 0$), it follows that $\\Delta\\gamma > 0$, as required.\n\nThe complete algorithm for one increment is as follows:\n1.  Compute trial stress: $\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon$.\n2.  Compute trial yield function: $f_{\\text{tr}} = |\\sigma_{\\text{tr}} - \\alpha^{n}| - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n})$.\n3.  If $f_{\\text{tr}} \\le 10^{-7}$, the step is elastic. The updated state is $(\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$.\n4.  If $f_{\\text{tr}} > 10^{-7}$, the step is plastic.\n    a. Calculate $\\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}}$.\n    b. Determine flow direction $R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n})$.\n    c. Update stress: $\\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R$.\n    d. Update internal variables:\n       $\\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma\\,R$.\n       $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma$.\n       $\\alpha^{n+1} = \\alpha^{n} + C\\,\\Delta\\gamma\\,R$.\nThis procedure is directly implemented in the following program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef update_state(E, sig_y0, H_iso, C, sig_n, ep_n, kap_n, alp_n, d_eps):\n    \"\"\"\n    Computes the updated state variables for a uniaxial elastic-plastic material\n    with combined linear isotropic and kinematic hardening using a return-mapping algorithm.\n\n    Args:\n        E (float): Young's modulus (MPa)\n        sig_y0 (float): Initial yield stress (MPa)\n        H_iso (float): Isotropic hardening modulus (MPa)\n        C (float): Kinematic hardening modulus (MPa)\n        sig_n (float): Stress at the beginning of the increment (MPa)\n        ep_n (float): Plastic strain at the beginning of the increment\n        kap_n (float): Accumulated plastic strain at the beginning of the increment\n        alp_n (float): Backstress at the beginning of the increment (MPa)\n        d_eps (float): Total strain increment\n\n    Returns:\n        tuple: Updated state variables (sig_np1, ep_np1, kap_np1, alp_np1)\n    \"\"\"\n    # Numerical tolerance for yield check\n    TOL = 1e-7\n\n    # 1. Compute elastic trial stress\n    sig_tr = sig_n + E * d_eps\n\n    # 2. Evaluate trial yield function\n    sig_y_n = sig_y0 + H_iso * kap_n\n    f_tr = np.abs(sig_tr - alp_n) - sig_y_n\n\n    # 3. Check for yielding\n    if f_tr = TOL:\n        # Elastic step\n        sig_np1 = sig_tr\n        ep_np1 = ep_n\n        kap_np1 = kap_n\n        alp_np1 = alp_n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n    else:\n        # 4. Plastic step: enforce consistency\n        # Calculate plastic multiplier increment\n        denominator = E + C + H_iso\n        d_gamma = f_tr / denominator\n\n        # Determine flow direction\n        R = np.sign(sig_tr - alp_n)\n\n        # Update state variables\n        kap_np1 = kap_n + d_gamma\n        ep_np1 = ep_n + d_gamma * R\n        alp_np1 = alp_n + C * d_gamma * R\n        sig_np1 = sig_tr - E * d_gamma * R\n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Isotropic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.003},\n        # Case B: Isotropic hardening only, elastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.001},\n        # Case C: Kinematic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 0.0, 'C': 30000.0, 'sig_n': 260.0, 'alp_n': 50.0, 'ep_n': 50.0/30000.0, 'kap_n': 50.0/30000.0, 'd_eps': 0.002},\n        # Case D: Combined hardening with reverse loading, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 2000.0, 'C': 40000.0, 'sig_n': 376.0, 'alp_n': 120.0, 'ep_n': 120.0/40000.0, 'kap_n': 120.0/40000.0, 'd_eps': -0.003},\n        # Case E: Boundary case exactly at yield, elastic\n        {'E': 210000.0, 'sig_y0': 300.0, 'H_iso': 500.0, 'C': 0.0, 'sig_n': 200.0, 'alp_n': 0.0, 'kap_n': 0.1, 'ep_n': 0.1, 'd_eps': (350.0 - 200.0)/210000.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters and call the update function\n        sig_np1, ep_np1, kap_np1, alp_np1 = update_state(\n            case['E'], case['sig_y0'], case['H_iso'], case['C'],\n            case['sig_n'], case['ep_n'], case['kap_n'], case['alp_n'],\n            case['d_eps']\n        )\n        \n        # Round results to six decimal places and store as a list\n        result = [\n            round(sig_np1, 6),\n            round(ep_np1, 6),\n            round(kap_np1, 6),\n            round(alp_np1, 6)\n        ]\n        results.append(result)\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[1.0,2.0,...],[3.0,4.0,...]]\n    # map(str, results) converts each inner list to its string representation.\n    # ','.join() combines these strings with commas.\n    # The outer brackets are added manually.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2652024"}]}