{"hands_on_practices": [{"introduction": "To truly grasp the implications of the Prandtl-Reuss equations, we begin with a foundational exercise. This problem connects the abstract constitutive theory to a tangible, physical phenomenon: the permanent deformation that remains after a material is stretched beyond its elastic limit and then unloaded. By deriving the residual strain from first principles for a simple uniaxial test, you will build a concrete understanding of how plastic strain accumulates and how it is distinguished from recoverable elastic strain. [@problem_id:2673839]", "problem": "Consider a small-strain, isotropic elastoplastic solid obeying the associative Prandtl–Reuss equations for the Second Deviatoric Stress Invariant ($J_2$) flow theory with linear isotropic hardening. The total small strain tensor is additively decomposed as $\\boldsymbol{\\varepsilon}=\\boldsymbol{\\varepsilon}^{e}+\\boldsymbol{\\varepsilon}^{p}$, and the elastic response is linear with Young’s modulus $E$. The yield function is of von Mises type with isotropic hardening, $f(\\boldsymbol{\\sigma},\\bar{\\varepsilon}^{p})=\\sigma_{\\mathrm{eq}}-\\sigma_{y}(\\bar{\\varepsilon}^{p})\\le 0$, where $\\sigma_{\\mathrm{eq}}=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}$ is the equivalent stress built from the deviatoric stress $\\mathbf{s}$, and $\\sigma_{y}(\\bar{\\varepsilon}^{p})=\\sigma_{y0}+H\\,\\bar{\\varepsilon}^{p}$ with constant initial yield strength $\\sigma_{y0}$ and hardening modulus $H$. The plastic flow is associative (Prandtl–Reuss), and the equivalent plastic strain is defined by $d\\bar{\\varepsilon}^{p}=\\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}^{p}:d\\boldsymbol{\\varepsilon}^{p}}$.\n\nA uniaxial tension test is performed along the $x_1$ direction: the specimen is monotonically strained to a total axial strain $\\varepsilon_{\\max}$ that is strictly greater than the elastic yield strain, and then unloaded to zero stress without reverse plastic flow. Assume small strains and that the stress state during loading is uniaxial tension with $\\sigma_{11}=\\sigma0$, $\\sigma_{22}=\\sigma_{33}=0$, and all shear stresses zero.\n\nDerive, from first principles of the above model, an expression for the residual axial strain after complete unloading, $\\varepsilon_{\\mathrm{res}}$, in terms of $E$, $H$, $\\sigma_{y0}$, and $\\varepsilon_{\\max}$, and then evaluate it for\n$E=200\\,\\mathrm{GPa}$, $\\sigma_{y0}=300\\,\\mathrm{MPa}$, $H=1.2\\,\\mathrm{GPa}$, and $\\varepsilon_{\\max}=0.015$. You may assume $\\varepsilon_{\\max}\\sigma_{y0}/E$ so that plasticity occurs before unloading. Round your final numerical answer to four significant figures and express it as a dimensionless decimal (no units).", "solution": "We start from the small-strain additive decomposition $\\boldsymbol{\\varepsilon}=\\boldsymbol{\\varepsilon}^{e}+\\boldsymbol{\\varepsilon}^{p}$ and linear elasticity. Under uniaxial stress $\\sigma_{11}=\\sigma0$, we have the axial elastic relation\n$$\n\\sigma=E\\,\\varepsilon^{e}_{11}=E\\left(\\varepsilon_{11}-\\varepsilon^{p}_{11}\\right).\n$$\nThe von Mises yield function with linear isotropic hardening is\n$$\nf(\\boldsymbol{\\sigma},\\bar{\\varepsilon}^{p})=\\sigma_{\\mathrm{eq}}-\\sigma_{y}(\\bar{\\varepsilon}^{p})=\\sigma_{\\mathrm{eq}}-\\big(\\sigma_{y0}+H\\bar{\\varepsilon}^{p}\\big)\\le 0.\n$$\nFor uniaxial stress $\\sigma_{22}=\\sigma_{33}=0$, the deviatoric components are $s_{11}=\\tfrac{2}{3}\\sigma$, $s_{22}=s_{33}=-\\tfrac{1}{3}\\sigma$, giving $\\sigma_{\\mathrm{eq}}=\\sqrt{\\tfrac{3}{2}\\,\\mathbf{s}:\\mathbf{s}}=|\\sigma|=\\sigma$ for $\\sigma0$.\n\nThe associative Prandtl–Reuss flow rule is\n$$\nd\\boldsymbol{\\varepsilon}^{p}=d\\lambda\\,\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}}=d\\lambda\\,\\frac{3}{2}\\,\\frac{\\mathbf{s}}{\\sigma_{\\mathrm{eq}}}.\n$$\nUsing the definition of the equivalent plastic strain,\n$$\nd\\bar{\\varepsilon}^{p}=\\sqrt{\\tfrac{2}{3}\\,d\\boldsymbol{\\varepsilon}^{p}:d\\boldsymbol{\\varepsilon}^{p}}=\\sqrt{\\tfrac{2}{3}\\left(d\\lambda\\,\\tfrac{3}{2}\\,\\tfrac{\\mathbf{s}}{\\sigma_{\\mathrm{eq}}}\\right):\\left(d\\lambda\\,\\tfrac{3}{2}\\,\\tfrac{\\mathbf{s}}{\\sigma_{\\mathrm{eq}}}\\right)}=d\\lambda,\n$$\nso $d\\bar{\\varepsilon}^{p}=d\\lambda$. In uniaxial tension ($\\sigma0$), the axial plastic strain increment follows from the flow direction:\n$$\nd\\varepsilon^{p}_{11}=d\\lambda\\,\\frac{3}{2}\\frac{s_{11}}{\\sigma_{\\mathrm{eq}}}=d\\lambda\\,\\frac{3}{2}\\frac{(2/3)\\sigma}{\\sigma}=d\\lambda=d\\bar{\\varepsilon}^{p}.\n$$\nThus, during monotonic uniaxial tension, the axial plastic strain equals the equivalent plastic strain, $\\varepsilon^{p}_{11}=\\bar{\\varepsilon}^{p}$ (up to the accumulated value).\n\nDuring plastic loading ($f=0$ and loading continues), the consistency condition $df=0$ gives\n$$\nd\\sigma_{\\mathrm{eq}}-H\\,d\\bar{\\varepsilon}^{p}=0.\n$$\nWith $\\sigma_{\\mathrm{eq}}=\\sigma$ for $\\sigma0$, we have $d\\sigma=H\\,d\\bar{\\varepsilon}^{p}$. From elasticity,\n$$\nd\\sigma=E\\big(d\\varepsilon_{11}-d\\varepsilon^{p}_{11}\\big)=E\\big(d\\varepsilon_{11}-d\\bar{\\varepsilon}^{p}\\big).\n$$\nEquating the two,\n$$\nE\\big(d\\varepsilon_{11}-d\\bar{\\varepsilon}^{p}\\big)=H\\,d\\bar{\\varepsilon}^{p}\\quad\\Longrightarrow\\quad d\\bar{\\varepsilon}^{p}=\\frac{E}{E+H}\\,d\\varepsilon_{11}.\n$$\nPlasticity starts when $\\sigma=\\sigma_{y0}$, which corresponds to the elastic yield strain\n$$\n\\varepsilon_{y}=\\frac{\\sigma_{y0}}{E}.\n$$\nIntegrating from first yield ($\\varepsilon_{11}=\\varepsilon_{y}$, $\\bar{\\varepsilon}^{p}=0$) to the maximum total strain $\\varepsilon_{11}=\\varepsilon_{\\max}$ reached at the end of loading,\n$$\n\\bar{\\varepsilon}^{p}\\big|_{\\mathrm{end}}=\\int_{\\varepsilon_{y}}^{\\varepsilon_{\\max}}\\frac{E}{E+H}\\,d\\varepsilon_{11}=\\frac{E}{E+H}\\,\\big(\\varepsilon_{\\max}-\\varepsilon_{y}\\big).\n$$\nAt this point, the stress equals the current yield stress, and unloading to zero stress is elastic (no further plastic straining) for rate-independent isotropic hardening under reverse-free unloading. Therefore, when $\\sigma\\to 0$ on unloading, the elastic strain vanishes ($\\varepsilon^{e}_{11}\\to 0$), and the residual strain is purely plastic:\n$$\n\\varepsilon_{\\mathrm{res}}=\\varepsilon^{p}_{11}\\big|_{\\mathrm{end}}=\\bar{\\varepsilon}^{p}\\big|_{\\mathrm{end}}=\\frac{E}{E+H}\\left(\\varepsilon_{\\max}-\\frac{\\sigma_{y0}}{E}\\right).\n$$\n\nNow evaluate numerically. Convert moduli to consistent units (e.g., $\\mathrm{MPa}$): $E=200\\,\\mathrm{GPa}=200{,}000\\,\\mathrm{MPa}$, $H=1.2\\,\\mathrm{GPa}=1{,}200\\,\\mathrm{MPa}$, and $\\sigma_{y0}=300\\,\\mathrm{MPa}$. The elastic yield strain is\n$$\n\\varepsilon_{y}=\\frac{\\sigma_{y0}}{E}=\\frac{300}{200{,}000}=0.0015.\n$$\nThe plastic multiplier factor is\n$$\n\\frac{E}{E+H}=\\frac{200{,}000}{200{,}000+1{,}200}=\\frac{200{,}000}{201{,}200}=\\frac{500}{503}\\approx 0.9940357853.\n$$\nThus,\n$$\n\\varepsilon_{\\mathrm{res}}=\\frac{E}{E+H}\\left(\\varepsilon_{\\max}-\\varepsilon_{y}\\right)=\\left(\\frac{500}{503}\\right)\\left(0.015-0.0015\\right)=\\left(\\frac{500}{503}\\right)(0.0135)\\approx 0.0134194831.\n$$\nRounded to four significant figures and expressed as a dimensionless decimal, the residual strain is $0.01342$.", "answer": "$$\\boxed{0.01342}$$", "id": "2673839"}, {"introduction": "Moving from analytical derivation to computational implementation, we now explore the mathematical foundation of the algorithms used in modern simulations. This practice frames the core of the plastic update—the return-mapping algorithm—as a constrained optimization problem. By demonstrating that the physically derived radial return formula is equivalent to the solution of a closest-point projection problem, you will gain a deeper, more geometric insight into why and how these numerical methods work. [@problem_id:2673804]", "problem": "Consider infinitesimal (small) strain, rate-independent, associative von Mises plasticity (also called second invariant of deviatoric stress (J2) plasticity) with the Prandtl–Reuss flow rule and perfect plasticity (no hardening). Let the Cauchy stress be a symmetric tensor $\\boldsymbol{\\sigma} \\in \\mathbb{R}^{3 \\times 3}$, with deviatoric part $\\mathbf{s} = \\operatorname{dev}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} - \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$ and hydrostatic pressure $p = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$. The von Mises yield function is\n$$\nf(\\boldsymbol{\\sigma}) = \\sqrt{\\tfrac{3}{2}}\\,\\|\\mathbf{s}\\|_F - \\sigma_y \\le 0,\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm and $\\sigma_y  0$ is the yield stress. The Prandtl–Reuss flow rule for associative plasticity specifies the plastic strain increment direction as the outward normal to the yield surface in stress space.\n\nFor a fixed time step and a given elastic predictor (trial stress) $\\boldsymbol{\\sigma}^{\\text{tr}}$, the incremental variational principle for this perfect plasticity model in the deviatoric stress space reduces to the following convex minimization problem:\n- Minimize over the deviatoric stress $\\mathbf{s} \\in \\mathbb{R}^{3 \\times 3}$ with $\\operatorname{tr}(\\mathbf{s})=0$ the objective\n$$\n\\Phi(\\mathbf{s}) = \\tfrac{1}{2}\\,\\|\\mathbf{s} - \\mathbf{s}^{\\text{tr}}\\|_F^2\n$$\nsubject to the von Mises admissibility constraint\n$$\n\\sqrt{\\tfrac{3}{2}}\\,\\|\\mathbf{s}\\|_F \\le \\sigma_y.\n$$\nNote that the hydrostatic part $p = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma}^{\\text{tr}})$ remains unchanged by plastic flow for this model and time step, so the full updated stress is $\\boldsymbol{\\sigma} = \\mathbf{s} + p\\,\\mathbf{I}$.\n\nYour task is to implement:\n1) A numerical solver for the above minimization problem in deviatoric stress space using an iterative projected-gradient method (or an equally robust first-order method) that converges to the unique minimizer for any trial deviatoric stress $\\mathbf{s}^{\\text{tr}}$.\n2) An analytical closed-form mapping obtained from enforcing the Prandtl–Reuss flow direction and consistency at the end of the time step (often called the “radial return” in deviatoric space).\n3) A verification routine that, for each provided trial stress, computes:\n   - the numerically minimized deviatoric stress $\\mathbf{s}^{\\star}_{\\text{num}}$ and the corresponding updated full stress $\\boldsymbol{\\sigma}_{\\text{num}} = \\mathbf{s}^{\\star}_{\\text{num}} + p\\,\\mathbf{I}$,\n   - the analytical deviatoric stress $\\mathbf{s}^{\\star}_{\\text{rad}}$ and updated full stress $\\boldsymbol{\\sigma}_{\\text{rad}} = \\mathbf{s}^{\\star}_{\\text{rad}} + p\\,\\mathbf{I}$,\n   - the plastic multiplier increment $\\Delta\\gamma$ for both methods, defined by the consistency of the Prandtl–Reuss equations in perfect plasticity with shear modulus $\\mu$ (see details below).\nFinally, for each test case, report a boolean indicating whether both the updated full stresses and the plastic multiplier increments from the two approaches agree within a prescribed numerical tolerance.\n\nFoundational base you may use:\n- Linear elasticity in small strain: $\\boldsymbol{\\sigma} = \\mathbb{C}:(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^p)$, with Lamé shear modulus $\\mu = \\tfrac{E}{2(1+\\nu)}$ derived from Young’s modulus $E$ and Poisson’s ratio $\\nu$.\n- The deviatoric/hydrostatic decomposition $\\boldsymbol{\\sigma} = \\mathbf{s} + p\\,\\mathbf{I}$, the Frobenius norm $\\|\\cdot\\|_F$, and basic convex optimization principles (existence and uniqueness for strictly convex objectives with convex feasible sets).\n- Associative flow for J2 plasticity (Prandtl–Reuss): the plastic strain increment direction is normal to the yield surface, and consistency at the end of the step determines the plastic multiplier increment $\\Delta\\gamma$ when the step is plastic.\n\nMaterial constants and units:\n- Use $E = 210 \\times 10^9$ in Pascals, $\\nu = 0.3$, so that $\\mu = \\tfrac{E}{2(1+\\nu)}$ in Pascals.\n- Use yield stress $\\sigma_y = 400 \\times 10^6$ in Pascals.\n- All stresses supplied below are in Pascals. The output booleans are dimensionless.\n\nTest suite (trial stresses):\nLet $\\mathbf{I}$ denote the $3 \\times 3$ identity. Define the following $3 \\times 3$ symmetric trial stresses $\\boldsymbol{\\sigma}^{\\text{tr}}_k$:\n- Case 1 (inside): $\\mathbf{s}_1^{\\text{tr}} = \\operatorname{diag}(100\\!\\times\\!10^6,\\,-50\\!\\times\\!10^6,\\,-50\\!\\times\\!10^6)$, $p_1 = 50\\!\\times\\!10^6$, $\\boldsymbol{\\sigma}^{\\text{tr}}_1 = \\mathbf{s}_1^{\\text{tr}} + p_1 \\mathbf{I}$.\n- Case 2 (on yield): $\\mathbf{s}_2^{\\text{tr}} = \\sigma_y \\,\\operatorname{diag}\\!\\big(\\tfrac{2}{3},\\,-\\tfrac{1}{3},\\,-\\tfrac{1}{3}\\big)$, $p_2 = -20\\!\\times\\!10^6$, $\\boldsymbol{\\sigma}^{\\text{tr}}_2 = \\mathbf{s}_2^{\\text{tr}} + p_2 \\mathbf{I}$.\n- Case 3 (slightly outside): $\\mathbf{s}_3^{\\text{tr}} = 1.05\\,\\mathbf{s}_2^{\\text{tr}}$, $p_3 = 30\\!\\times\\!10^6$, $\\boldsymbol{\\sigma}^{\\text{tr}}_3 = \\mathbf{s}_3^{\\text{tr}} + p_3 \\mathbf{I}$.\n- Case 4 (far outside): Let $r_y = \\sqrt{\\tfrac{2}{3}}\\,\\sigma_y$ and $a = \\tfrac{3\\,r_y}{\\sqrt{2}}$. Set $\\mathbf{s}_4^{\\text{tr}} = \\operatorname{diag}(a,\\,-a,\\,0)$, $p_4 = -100\\!\\times\\!10^6$, $\\boldsymbol{\\sigma}^{\\text{tr}}_4 = \\mathbf{s}_4^{\\text{tr}} + p_4 \\mathbf{I}$.\n- Case 5 (zero): $\\boldsymbol{\\sigma}^{\\text{tr}}_5 = \\mathbf{0}$.\n- Case 6 (pure hydrostatic): $\\boldsymbol{\\sigma}^{\\text{tr}}_6 = 120\\!\\times\\!10^6\\,\\mathbf{I}$.\n- Case 7 (outside with off-diagonals): \n$$\n\\mathbf{s}_7^{\\text{tr}} = 10^8\\begin{bmatrix}\n2  -1  0.5\\\\\n-1  -3  0.2\\\\\n0.5  0.2  1\n\\end{bmatrix},\\quad\np_7 = 15\\!\\times\\!10^6,\\quad \\boldsymbol{\\sigma}^{\\text{tr}}_7 = \\mathbf{s}_7^{\\text{tr}} + p_7 \\mathbf{I}.\n$$\n\nVerification and output specification:\n- For each case $k \\in \\{1,\\dots,7\\}$, compute $\\boldsymbol{\\sigma}_{\\text{num}}$ by numerically solving the minimization problem in $\\mathbf{s}$ and then reconstructing the full stress by adding the unchanged hydrostatic part $p\\,\\mathbf{I}$. Also compute $\\Delta\\gamma_{\\text{num}}$ from the Prandtl–Reuss consistency implied by the numerical minimizer.\n- In parallel, compute the analytically returned stress $\\boldsymbol{\\sigma}_{\\text{rad}}$ from the closed-form radial mapping derived from the Prandtl–Reuss equations with perfect plasticity and the corresponding plastic multiplier increment $\\Delta\\gamma_{\\text{rad}}$.\n- For each case, evaluate a boolean that is true if and only if both\n  1) the relative Frobenius norm difference between $\\boldsymbol{\\sigma}_{\\text{num}}$ and $\\boldsymbol{\\sigma}_{\\text{rad}}$ is no larger than $10^{-10}$, and\n  2) the relative difference between $\\Delta\\gamma_{\\text{num}}$ and $\\Delta\\gamma_{\\text{rad}}$ is no larger than $10^{-12}$ (taking zero as an allowed exact value for elastic steps).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,...]\").\n\nAngle units do not apply. No percentages are involved. The final booleans are dimensionless.", "solution": "The problem presented is a standard and well-posed problem in computational solid mechanics, specifically concerning the implementation of a return-mapping algorithm for rate-independent $J_2$ perfect plasticity. The core task is to find the closest point projection of a trial deviatoric stress state onto the von Mises yield surface, which is an ellipsoid in the principal stress space and a sphere in the space of deviatoric tensors equipped with the Frobenius norm. We are asked to solve this problem using two methods—an analytical, closed-form solution and an iterative numerical method—and to verify their agreement.\n\nFirst, we establish the mathematical framework. The Cauchy stress tensor $\\boldsymbol{\\sigma}$ is additively decomposed into its deviatoric part $\\mathbf{s}$ and hydrostatic part $p\\mathbf{I}$, where $\\mathbf{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\mathbf{I}$ and $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$. For the $J_2$ flow theory, the hydrostatic response is purely elastic, so the plastic flow does not affect the pressure, $p = p^{\\text{tr}}$. The problem is thus reduced to the space of deviatoric stresses.\n\nThe von Mises yield criterion is given as $f(\\boldsymbol{\\sigma}) = \\sqrt{\\frac{3}{2}}\\|\\mathbf{s}\\|_F - \\sigma_y \\le 0$. The set of admissible deviatoric stresses is a closed ball centered at the origin in the $5$-dimensional space of symmetric deviatoric tensors, defined by the constraint $\\|\\mathbf{s}\\|_F \\le \\sqrt{\\frac{2}{3}}\\sigma_y$. Let us define the radius of this ball as $r_y = \\sqrt{\\frac{2}{3}}\\sigma_y$.\n\nThe problem is to minimize the objective function $\\Phi(\\mathbf{s}) = \\frac{1}{2}\\|\\mathbf{s} - \\mathbf{s}^{\\text{tr}}\\|_F^2$ subject to the constraint $\\|\\mathbf{s}\\|_F \\le r_y$. This is a classical Euclidean projection problem of a point $\\mathbf{s}^{\\text{tr}}$ onto a closed convex set (a ball of radius $r_y$).\n\n**Analytical Solution (Radial Return Mapping)**\n\nThe existence and uniqueness of the solution $\\mathbf{s}^\\star$ is guaranteed by the strict convexity of the objective function and the closed, convex nature of the feasible set. The solution can be found by inspecting the Karush-Kuhn-Tucker (KKT) conditions, but for a projection onto a ball, the solution is geometrically intuitive.\n\nLet the trial yield function value be $f^{\\text{tr}} = \\sqrt{\\frac{3}{2}}\\|\\mathbf{s}^{\\text{tr}}\\|_F - \\sigma_y$. Two cases arise:\n\n1.  **Elastic Step**: If $f^{\\text{tr}} \\le 0$, which is equivalent to $\\|\\mathbf{s}^{\\text{tr}}\\|_F \\le r_y$, the trial stress $\\mathbf{s}^{\\text{tr}}$ is already within the admissible region. Since $\\mathbf{s}^{\\text{tr}}$ is the unconstrained minimizer of $\\Phi(\\mathbf{s})$, it is also the constrained minimizer. Thus, the updated deviatoric stress is $\\mathbf{s}^\\star_{\\text{rad}} = \\mathbf{s}^{\\text{tr}}$. In this case, there is no plastic deformation, so the plastic multiplier increment is $\\Delta\\gamma_{\\text{rad}} = 0$.\n\n2.  **Plastic Step**: If $f^{\\text{tr}}  0$, or $\\|\\mathbf{s}^{\\text{tr}}\\|_F  r_y$, the trial stress is outside the yield surface. The closest point in the ball to $\\mathbf{s}^{\\text{tr}}$ lies on the boundary (the yield surface) and in the same direction from the origin as $\\mathbf{s}^{\\text{tr}}$. This is the \"radial return\" concept. The solution is obtained by scaling $\\mathbf{s}^{\\text{tr}}$ back to the surface of the ball:\n    $$\n    \\mathbf{s}^\\star_{\\text{rad}} = r_y \\frac{\\mathbf{s}^{\\text{tr}}}{\\|\\mathbf{s}^{\\text{tr}}\\|_F} = \\sqrt{\\frac{2}{3}}\\sigma_y \\frac{\\mathbf{s}^{\\text{tr}}}{\\|\\mathbf{s}^{\\text{tr}}\\|_F}.\n    $$\n    The corresponding plastic multiplier increment $\\Delta\\gamma_{\\text{rad}}$ is determined from the discrete constitutive equations. The elastic predictor-plastic corrector scheme gives the updated stress as $\\mathbf{s} = \\mathbf{s}^{\\text{tr}} - 2\\mu\\Delta\\boldsymbol{\\varepsilon}^p$, where $\\mu$ is the shear modulus. The associative flow rule for $J_2$ plasticity states $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma \\sqrt{\\frac{3}{2}}\\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|_F}$. Substituting this into the stress update and using the fact that for a plastic step, $\\mathbf{s}$ and $\\mathbf{s}^{\\text{tr}}$ are collinear (i.e., $\\frac{\\mathbf{s}}{\\|\\mathbf{s}\\|_F} = \\frac{\\mathbf{s}^{\\text{tr}}}{\\|\\mathbf{s}^{\\text{tr}}\\|_F}$ for $\\mathbf{s}^{\\text{tr}} \\neq \\mathbf{0}$):\n    $$\n    \\mathbf{s} = \\mathbf{s}^{\\text{tr}} - 2\\mu\\Delta\\gamma \\sqrt{\\frac{3}{2}}\\frac{\\mathbf{s}^{\\text{tr}}}{\\|\\mathbf{s}^{\\text{tr}}\\|_F}.\n    $$\n    Taking the Frobenius norm of both sides leads to $\\|\\mathbf{s}\\|_F = \\|\\mathbf{s}^{\\text{tr}}\\|_F - 2\\mu\\Delta\\gamma\\sqrt{\\frac{3}{2}}$. Since the final state is on the yield surface, $\\|\\mathbf{s}\\|_F = r_y = \\sqrt{\\frac{2}{3}}\\sigma_y$. Solving for $\\Delta\\gamma$ gives:\n    $$\n    \\Delta\\gamma_{\\text{rad}} = \\frac{\\|\\mathbf{s}^{\\text{tr}}\\|_F - r_y}{2\\mu\\sqrt{3/2}} = \\frac{\\|\\mathbf{s}^{\\text{tr}}\\|_F - \\sqrt{2/3}\\sigma_y}{2\\mu\\sqrt{3/2}} = \\frac{\\sqrt{3/2}\\|\\mathbf{s}^{\\text{tr}}\\|_F - \\sigma_y}{3\\mu} = \\frac{f^{\\text{tr}}}{3\\mu}.\n    $$\n\nIn both cases, the full updated stress is reconstructed as $\\boldsymbol{\\sigma}_{\\text{rad}} = \\mathbf{s}^\\star_{\\text{rad}} + p^{\\text{tr}}\\mathbf{I}$.\n\n**Numerical Solution (Projected Gradient Method)**\n\nThe problem is solved numerically using the projected gradient method, an iterative first-order algorithm suitable for constrained convex optimization. The iteration is given by:\n$$\n\\mathbf{s}_{k+1} = P_C(\\mathbf{s}_k - \\alpha \\nabla\\Phi(\\mathbf{s}_k)),\n$$\nwhere $P_C$ is the projection operator onto the feasible set $C = \\{\\mathbf{s} \\in \\mathbb{R}^{3 \\times 3} \\mid \\operatorname{tr}(\\mathbf{s})=0, \\|\\mathbf{s}\\|_F \\le r_y\\}$, and $\\alpha$ is the step size. The gradient of the objective function is $\\nabla\\Phi(\\mathbf{s}) = \\mathbf{s} - \\mathbf{s}^{\\text{tr}}$. The iteration becomes:\n$$\n\\mathbf{s}_{k+1} = P_C((1-\\alpha)\\mathbf{s}_k + \\alpha \\mathbf{s}^{\\text{tr}}).\n$$\nThe projection $P_C(\\mathbf{T})$ of a deviatoric tensor $\\mathbf{T}$ is simply its radial return to the ball of radius $r_y$: $P_C(\\mathbf{T}) = \\min\\left(1, \\frac{r_y}{\\|\\mathbf{T}\\|_F}\\right)\\mathbf{T}$. For convergence, the step size $\\alpha$ must be in the range $(0, 2/L)$ where $L$ is the Lipschitz constant of the gradient. For our problem, $L=1$, so any $\\alpha \\in (0, 2)$ guarantees convergence. We choose $\\alpha=0.5$ for robustness and initialize with $\\mathbf{s}_0 = \\mathbf{0}$. The iteration continues until the change $\\|\\mathbf{s}_{k+1} - \\mathbf{s}_k\\|_F$ falls below a specified tolerance.\n\nLet the converged numerical solution be $\\mathbf{s}^\\star_{\\text{num}}$. To find the corresponding plastic multiplier $\\Delta\\gamma_{\\text{num}}$, we rearrange the stress update equation $\\mathbf{s}^\\star_{\\text{num}} = \\mathbf{s}^{\\text{tr}} - 2\\mu\\Delta\\boldsymbol{\\varepsilon}^p$. Taking the inner product (Frobenius dot product) with $\\mathbf{s}^\\star_{\\text{num}}$ yields:\n$$\n\\|\\mathbf{s}^\\star_{\\text{num}}\\|_F^2 = \\mathbf{s}^\\star_{\\text{num}}:\\mathbf{s}^{\\text{tr}} - 2\\mu\\Delta\\gamma_{\\text{num}}\\sqrt{\\frac{3}{2}}\\|\\mathbf{s}^\\star_{\\text{num}}\\|_F.\n$$\nSolving for $\\Delta\\gamma_{\\text{num}}$ (for $\\|\\mathbf{s}^\\star_{\\text{num}}\\|_F  0$):\n$$\n\\Delta\\gamma_{\\text{num}} = \\frac{\\mathbf{s}^\\star_{\\text{num}}:\\mathbf{s}^{\\text{tr}} - \\|\\mathbf{s}^\\star_{\\text{num}}\\|_F^2}{2\\mu\\sqrt{3/2}\\|\\mathbf{s}^\\star_{\\text{num}}\\|_F}.\n$$\nThis formula is general. If the step is elastic, the numerical solution converges to $\\mathbf{s}^\\star_{\\text{num}} = \\mathbf{s}^{\\text{tr}}$, causing the numerator to become zero, hence $\\Delta\\gamma_{\\text{num}} = 0$. If the step is plastic, it provides the value consistent with the numerical solution. For $\\mathbf{s}^{\\text{tr}}=\\mathbf{0}$, the solution is $\\mathbf{s}^\\star_{\\text{num}}=\\mathbf{0}$ and $\\Delta\\gamma_{\\text{num}}=0$. The full stress is $\\boldsymbol{\\sigma}_{\\text{num}} = \\mathbf{s}^\\star_{\\text{num}} + p^{\\text{tr}}\\mathbf{I}$.\n\n**Verification**\n\nFor each test case, we compute the results from both methods and verify their agreement according to two criteria:\n1.  The relative difference in the Frobenius norm of the full stress tensors: $\\frac{\\|\\boldsymbol{\\sigma}_{\\text{num}} - \\boldsymbol{\\sigma}_{\\text{rad}}\\|_F}{\\|\\boldsymbol{\\sigma}_{\\text{rad}}\\|_F} \\le 10^{-10}$. If $\\|\\boldsymbol{\\sigma}_{\\text{rad}}\\|_F=0$, the absolute difference $\\|\\boldsymbol{\\sigma}_{\\text{num}}\\|_F$ is checked against the tolerance.\n2.  The relative difference between the plastic multipliers: $\\frac{|\\Delta\\gamma_{\\text{num}} - \\Delta\\gamma_{\\text{rad}}|}{|\\Delta\\gamma_{\\text{rad}}|} \\le 10^{-12}$. If $\\Delta\\gamma_{\\text{rad}}=0$, the absolute value $|\\Delta\\gamma_{\\text{num}}|$ is checked against a small tolerance.\n\nA boolean `True` is reported if and only if both conditions are satisfied.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the J2 plasticity problem using analytical and numerical methods,\n    and verifies their agreement for a suite of test cases.\n    \"\"\"\n\n    # Material constants\n    E = 210e9  # Young's modulus in Pa\n    NU = 0.3   # Poisson's ratio\n    SIGMA_Y = 400e6  # Yield stress in Pa\n    MU = E / (2.0 * (1.0 + NU))  # Shear modulus in Pa\n    # Radius of the yield surface in deviatoric stress space\n    R_Y = np.sqrt(2.0/3.0) * SIGMA_Y\n\n    def get_deviatoric(sigma):\n        \"\"\"Computes the deviatoric part of a 3x3 stress tensor.\"\"\"\n        return sigma - (1.0/3.0) * np.trace(sigma) * np.eye(3)\n\n    def get_pressure(sigma):\n        \"\"\"Computes the hydrostatic pressure from a 3x3 stress tensor.\"\"\"\n        return (1.0/3.0) * np.trace(sigma)\n\n    def frobenius_norm(tensor):\n        \"\"\"Computes the Frobenius norm of a tensor.\"\"\"\n        return np.linalg.norm(tensor, 'fro')\n\n    def solve_analytical(sigma_tr):\n        \"\"\"\n        Computes the updated stress and plastic multiplier using the\n        analytical radial return method.\n        \"\"\"\n        s_tr = get_deviatoric(sigma_tr)\n        p = get_pressure(sigma_tr)\n        \n        norm_s_tr = frobenius_norm(s_tr)\n        \n        # Check if trial stress is inside or on the yield surface\n        yield_func_val = np.sqrt(3.0/2.0) * norm_s_tr - SIGMA_Y\n        \n        if yield_func_val = 1e-12:  # Elastic or on-surface step\n            s_star = s_tr\n            delta_gamma = 0.0\n        else:  # Plastic step\n            s_star = R_Y * s_tr / norm_s_tr\n            delta_gamma = (np.sqrt(3.0/2.0) * norm_s_tr - SIGMA_Y) / (3.0 * MU)\n\n        sigma_star = s_star + p * np.eye(3)\n        return sigma_star, delta_gamma\n\n    def solve_numerical(sigma_tr, alpha=0.5, tol=1e-15, max_iter=1000):\n        \"\"\"\n        Computes the updated stress and plastic multiplier using a\n        projected gradient method.\n        \"\"\"\n        s_tr = get_deviatoric(sigma_tr)\n        p = get_pressure(sigma_tr)\n\n        s_num = np.zeros((3, 3))  # Initial guess s_0 = 0\n\n        for _ in range(max_iter):\n            s_old = s_num\n            # Gradient descent step\n            s_arg = (1.0 - alpha) * s_old + alpha * s_tr\n            \n            # Projection onto the feasible set\n            norm_s_arg = frobenius_norm(s_arg)\n            if norm_s_arg  R_Y:\n                s_num = R_Y * s_arg / norm_s_arg\n            else:\n                s_num = s_arg\n            \n            # Convergence check\n            norm_s_old = frobenius_norm(s_old)\n            if frobenius_norm(s_num - s_old)  tol * (1.0 + norm_s_old):\n                break\n        \n        # Compute the corresponding plastic multiplier\n        norm_s_num = frobenius_norm(s_num)\n        if norm_s_num  1e-15:\n            delta_gamma_num = 0.0\n        else:\n            dot_product = np.sum(s_num * s_tr)  # s_num : s_tr\n            numerator = dot_product - norm_s_num**2\n            denominator = 2.0 * MU * np.sqrt(3.0/2.0) * norm_s_num\n            delta_gamma_num = numerator / denominator\n\n        sigma_num = s_num + p * np.eye(3)\n        return sigma_num, delta_gamma_num\n\n    # Define test cases\n    I = np.eye(3)\n    s1_tr = np.diag([100e6, -50e6, -50e6])\n    p1 = 50e6\n    s2_tr = SIGMA_Y * np.diag([2.0/3.0, -1.0/3.0, -1.0/3.0])\n    p2 = -20e6\n    s3_tr = 1.05 * s2_tr\n    p3 = 30e6\n    a = np.sqrt(3.0) * SIGMA_Y\n    s4_tr = np.diag([a, -a, 0.0])\n    p4 = -100e6\n    s7_tr = 1e8 * np.array([[2.0, -1.0,  0.5],\n                             [-1.0, -3.0, 0.2],\n                             [0.5,  0.2, 1.0]])\n    p7 = 15e6\n\n    test_cases_tr = [\n        s1_tr + p1 * I,\n        s2_tr + p2 * I,\n        s3_tr + p3 * I,\n        s4_tr + p4 * I,\n        np.zeros((3, 3)),\n        120e6 * I,\n        s7_tr + p7 * I\n    ]\n\n    results = []\n    \n    TOL_STRESS = 1e-10\n    TOL_GAMMA_REL = 1e-12\n    TOL_GAMMA_ABS = 1e-15\n\n    for sigma_tr in test_cases_tr:\n        # Analytical solution\n        sigma_rad, delta_gamma_rad = solve_analytical(sigma_tr)\n        \n        # Numerical solution\n        sigma_num, delta_gamma_num = solve_numerical(sigma_tr)\n        \n        # Verification\n        # 1. Stress comparison\n        norm_sigma_rad = frobenius_norm(sigma_rad)\n        norm_diff_sigma = frobenius_norm(sigma_num - sigma_rad)\n        \n        if norm_sigma_rad  1e-15:\n            sigma_ok = norm_diff_sigma  TOL_STRESS\n        else:\n            sigma_ok = (norm_diff_sigma / norm_sigma_rad) = TOL_STRESS\n            \n        # 2. Plastic multiplier comparison\n        if abs(delta_gamma_rad)  TOL_GAMMA_ABS:\n            gamma_ok = abs(delta_gamma_num)  TOL_GAMMA_ABS\n        else:\n            gamma_ok = abs(delta_gamma_num - delta_gamma_rad) / abs(delta_gamma_rad) = TOL_GAMMA_REL\n\n        results.append(sigma_ok and gamma_ok)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2673804"}, {"introduction": "The final step is to synthesize these concepts into a robust numerical tool, the kind used in engineering analysis. In this practice, you will implement a complete uniaxial constitutive update for a material that includes hardening, a crucial feature for modeling real metals. More importantly, you will learn the critical skill of verification by designing a suite of numerical experiments to confirm that your model correctly captures key physical behaviors, such as elastic unloading and the expansion of the yield surface. [@problem_id:2673864]", "problem": "Design and implement a small-strain uniaxial constitutive update for an associative von Mises (second deviatoric invariant, J2) elastoplastic model governed by the Prandtl-Reuss equations with linear isotropic hardening. The goal is to verify, via a loading–unloading–reloading numerical experiment, that the implemented model exhibits elastic unloading and correctly recovers the yield surface upon reloading. The solution must be principle-based and must not rely on pre-assembled formulas beyond the fundamental base specified below. All stresses must be expressed in megapascal (MPa), and all strains must be dimensionless. Angles do not appear in this problem. All final outputs must be booleans.\n\nFundamental base to be used:\n- Kinematics: small-strain additive decomposition $\\,\\varepsilon = \\varepsilon^e + \\varepsilon^p\\,$, where $\\,\\varepsilon\\,$ is the total strain, $\\,\\varepsilon^e\\,$ is the elastic strain, and $\\,\\varepsilon^p\\,$ is the plastic strain.\n- Linear elasticity: $\\,\\sigma = E\\varepsilon^e = E(\\varepsilon - \\varepsilon^p)\\,$, where $\\,\\sigma\\,$ is the Cauchy stress and $\\,E\\,$ is Young’s modulus.\n- Von Mises yield condition (J2): in general, $\\,f(\\sigma,\\alpha) = \\sigma_{\\mathrm{eq}} - \\sigma_y(\\alpha) \\le 0\\,$, where $\\,\\sigma_{\\mathrm{eq}} = \\sqrt{\\tfrac{3}{2}}\\,\\|s\\|\\,$ is the equivalent stress with $\\,s\\,$ the deviatoric stress, and $\\,\\sigma_y(\\alpha)\\,$ is the current yield stress depending on the hardening variable $\\,\\alpha\\,$.\n- Associative flow (Prandtl-Reuss): $\\,\\dot{\\varepsilon}^p = \\dot{\\lambda}\\dfrac{\\partial f}{\\partial \\sigma}\\,$ with $\\,\\dot{\\lambda} \\ge 0\\,$, $\\,f \\le 0\\,$, and $\\,\\dot{\\lambda}f = 0\\,$ (Kuhn–Tucker conditions), and the consistency condition $\\,\\dot{\\lambda}\\dot{f} = 0\\,$ during plastic loading.\n- Linear isotropic hardening: $\\,\\sigma_y(\\alpha) = \\sigma_{y0} + H\\alpha\\,$, where $\\,\\sigma_{y0}\\,$ is the initial yield stress and $\\,H\\,$ is the hardening modulus. The hardening variable $\\,\\alpha\\,$ is the accumulated equivalent plastic strain, with $\\,\\dot{\\alpha} = \\dot{\\lambda}\\,$ for J2 associative plasticity.\n\nIn uniaxial stress states, you may reduce the general J2 relations consistently to one dimension using the fact that the von Mises equivalent stress equals the absolute value of the axial stress, i.e., $\\,\\sigma_{\\mathrm{eq}} = |\\sigma|\\,$, and that the associative flow implies plastic straining occurs along the axial direction with sign given by the axial stress. The program must implement an incremental return-mapping update that, at each prescribed total strain, enforces the yield condition and the flow rule with hardening, respecting the elastic domain when applicable and performing a plastic correction when required.\n\nYour program must:\n- Implement a uniaxial update that takes as input a sequence of total strains $\\,\\{\\varepsilon_n\\}\\,$ and material parameters $\\,E\\,$, $\\,\\sigma_{y0}\\,$, $\\,H\\,$, starting from $\\,\\varepsilon^p_0 = 0\\,$ and $\\,\\alpha_0 = 0\\,$.\n- At each step $\\,n\\,$, compute the stress $\\,\\sigma_n\\,$, plastic strain $\\,\\varepsilon^p_n\\,$, and hardening variable $\\,\\alpha_n\\,$ by enforcing the fundamental base (elastic predictor and, if needed, a plastic corrector consistent with associative J2 plasticity and linear isotropic hardening).\n- Use a robust tolerance for yield evaluation and report booleans for the required checks below.\n\nTest suite:\nImplement the following four independent test cases, each defined by material parameters and a prescribed strain path. All stresses must be in MPa and strains dimensionless.\n\n- Test A (elastic unloading verification after plastic loading):\n  - Material: $\\,E = 210000\\,$, $\\,\\sigma_{y0} = 300\\,$, $\\,H = 1200\\,$.\n  - Strain path: `[0.0, 0.0050, 0.0025, 0.0]`.\n  - Required boolean outcome: true if and only if both of the following hold during unloading from $\\,0.0050\\,$ to $\\,0.0\\,$:\n    - The plastic strain $\\,\\varepsilon^p\\,$ remains constant within a relative tolerance of $\\,10^{-10}\\,$.\n    - The secant slope $\\,\\dfrac{\\Delta \\sigma}{\\Delta \\varepsilon}\\,$ on each unloading segment equals $\\,E\\,$ within a relative tolerance of $\\,10^{-8}\\,$.\n\n- Test B (purely elastic loading–unloading):\n  - Material: $\\,E = 70000\\,$, $\\,\\sigma_{y0} = 300\\,$, $\\,H = 500\\,$.\n  - Strain path: `[0.0, 0.0020, 0.0]`.\n  - Required boolean outcome: true if and only if:\n    - $\\,\\varepsilon^p = 0\\,$ at all steps within an absolute tolerance of $\\,10^{-14}\\,$.\n    - The secant slopes $\\,\\dfrac{\\Delta \\sigma}{\\Delta \\varepsilon}\\,$ on loading and unloading both equal $\\,E\\,$ within a relative tolerance of $\\,10^{-12}\\,$.\n\n- Test C (yield boundary handling at near-onset loading):\n  - Material: $\\,E = 200000\\,$, $\\,\\sigma_{y0} = 250\\,$, $\\,H = 1000\\,$.\n  - Strain path: `[0.0, 0.0012505]`.\n  - Required boolean outcome: true if and only if:\n    - The yield function residual $\\,r = |\\sigma| - (\\sigma_{y0} + H\\alpha)\\,$ at the final step satisfies $\\,|r| \\le 10^{-9}\\,$.\n    - The hardening variable increases from zero, i.e., $\\,\\alpha > 0\\,$.\n\n- Test D (re-yield stress recovery upon reloading after elastic unloading from plastic state):\n  - Material: $\\,E = 200000\\,$, $\\,\\sigma_{y0} = 250\\,$, $\\,H = 1000\\,$.\n  - Strain path stages:\n    - Load to a plastic state and unload to zero: `[0.0, 0.0050, 0.0]`.\n    - Then define the predicted re-yield strain $\\,\\varepsilon_{\\mathrm{pred}} = \\varepsilon^p_{\\star} + \\dfrac{\\sigma_{y0} + H\\alpha_{\\star}}{E}\\,$, where $\\,\\varepsilon^p_{\\star}\\,$ and $\\,\\alpha_{\\star}\\,$ are the plastic strain and hardening variable recorded at the end of the first loading (before unloading).\n    - Reload using two steps bracketing the predicted re-yield: $\\,\\varepsilon_{\\mathrm{pred}} - 10^{-6}\\,$ and $\\,\\varepsilon_{\\mathrm{pred}} + 10^{-6}\\,$.\n  - Required boolean outcome: true if and only if all of the following hold:\n    - At $\\,\\varepsilon_{\\mathrm{pred}} - 10^{-6}\\,$, the step is elastic: $\\,\\alpha\\,$ equals $\\,\\alpha_{\\star}\\,$ within an absolute tolerance of $\\,10^{-12}\\,$.\n    - At $\\,\\varepsilon_{\\mathrm{pred}} + 10^{-6}\\,$, the yield function residual $\\,r = |\\sigma| - (\\sigma_{y0} + H\\alpha)\\,$ satisfies $\\,|r| \\le 10^{-9}\\,$ and $\\,\\alpha > \\alpha_{\\star}\\,$.\n\nYour program must produce a single line of output containing the four boolean results for tests A–D as a comma-separated list enclosed in square brackets (e.g., \"[True,False,True,True]\").", "solution": "The problem requires the design and implementation of a constitutive update algorithm for a uniaxial, small-strain, associative $J_2$ elastoplastic model with linear isotropic hardening. The validity of the implementation is to be verified through a series of four numerical experiments.\n\nThe problem statement is scientifically grounded, well-posed, and complete. It describes a standard model in continuum plasticity, provides all necessary equations, material parameters, initial conditions, and loading histories. The validation criteria are objective and numerically verifiable. Therefore, the problem is valid, and a solution will be derived from the fundamental principles provided.\n\nThe core of the solution is an incremental update procedure based on a backward Euler integration scheme, commonly known as a return-mapping algorithm. This algorithm consists of an elastic predictor step followed by a plastic corrector step if the yield condition is violated. We will derive this algorithm for the specified one-dimensional case.\n\nLet the state at the beginning of a time increment (step $n$) be known: $(\\sigma_{n}, \\varepsilon^{p}_{n}, \\alpha_{n})$. We are given the total strain at the end of the increment, $\\varepsilon_{n+1}$. Our goal is to compute the state $(\\sigma_{n+1}, \\varepsilon^{p}_{n+1}, \\alpha_{n+1})$.\n\nThe fundamental relations, discretized over the increment from $n$ to $n+1$, are:\n1.  Additive strain decomposition: $\\varepsilon_{n+1} = \\varepsilon^{e}_{n+1} + \\varepsilon^{p}_{n+1}$\n2.  Linear elastic stress-strain relation: $\\sigma_{n+1} = E \\cdot \\varepsilon^{e}_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1})$\n3.  Discrete flow rule: $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta\\varepsilon^{p} = \\varepsilon^{p}_{n} + \\Delta\\lambda \\cdot \\text{sign}(\\sigma_{n+1})$\n4.  Discrete hardening law: $\\alpha_{n+1} = \\alpha_{n} + \\Delta\\alpha = \\alpha_{n} + \\Delta\\lambda$\n5.  Yield condition: $f_{n+1} = |\\sigma_{n+1}| - (\\sigma_{y0} + H \\alpha_{n+1}) \\le 0$\n6.  Kuhn-Tucker loading/unloading conditions: $\\Delta\\lambda \\ge 0$, $f_{n+1} \\le 0$, $\\Delta\\lambda \\cdot f_{n+1} = 0$\n\nHere, $\\Delta\\lambda$ is the increment in the plastic multiplier, which quantifies the amount of plastic flow within the step. The term $\\text{sign}(\\sigma_{n+1})$ arises from the evaluation of $\\partial f/\\partial \\sigma = \\partial |\\sigma|/\\partial \\sigma$ for the uniaxial case.\n\nThe algorithm proceeds in two main stages for each increment.\n\n**Step 1: Elastic Predictor**\nFirst, we assume the entire strain increment is purely elastic. This is equivalent to setting the plastic multiplier increment to zero, $\\Delta\\lambda = 0$. The resulting \"trial\" state is calculated:\n- Trial plastic strain: $\\varepsilon^{p, \\text{tr}}_{n+1} = \\varepsilon^{p}_{n}$\n- Trial hardening variable: $\\alpha^{\\text{tr}}_{n+1} = \\alpha_{n}$\n- Trial stress: $\\sigma^{\\text{tr}}_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{p, \\text{tr}}_{n+1}) = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$\n\n**Step 2: Yield Check and Plastic Corrector**\nNext, we check if this trial stress violates the yield condition defined by the state at the beginning of the increment. We evaluate the yield function at the trial state:\n$$f^{\\text{tr}} = |\\sigma^{\\text{tr}}_{n+1}| - \\sigma_{y}(\\alpha_{n}) = |\\sigma^{\\text{tr}}_{n+1}| - (\\sigma_{y0} + H \\alpha_{n})$$\n\nThere are two possible outcomes:\n\n**Case I: Elastic Step ($f^{\\text{tr}} \\le 0$)**\nIf the trial yield function is not positive, the trial stress is within or on the yield surface. The assumption of an elastic step was correct. The state at the end of the increment is the trial state:\n- $\\sigma_{n+1} = \\sigma^{\\text{tr}}_{n+1}$\n- $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n}$\n- $\\alpha_{n+1} = \\alpha_{n}$\nIn this case, $\\Delta\\lambda = 0$, satisfying the Kuhn-Tucker conditions.\n\n**Case II: Plastic Step ($f^{\\text{tr}}  0$)**\nIf the trial yield function is positive, the trial stress lies outside the yield surface, which is physically inadmissible. Plastic deformation must occur to return the stress state to the yield surface. The state must be updated such that the consistency condition, $f_{n+1} = 0$, is satisfied. This is the plastic corrector or \"return mapping\" step.\n\nWe must find the non-negative value of $\\Delta\\lambda$ that satisfies the governing equations. Substitute the flow rule (3) into the elastic law (2):\n$$\\sigma_{n+1} = E (\\varepsilon_{n+1} - (\\varepsilon^{p}_{n} + \\Delta\\lambda \\cdot \\text{sign}(\\sigma_{n+1})))$$\nRecognizing that $\\sigma^{\\text{tr}}_{n+1} = E(\\varepsilon_{n+1} - \\varepsilon^{p}_{n})$ and that the direction of stress does not change sign during correction for this simple model, so $\\text{sign}(\\sigma_{n+1}) = \\text{sign}(\\sigma^{\\text{tr}}_{n+1})$, we have:\n$$\\sigma_{n+1} = \\sigma^{\\text{tr}}_{n+1} - E \\cdot \\Delta\\lambda \\cdot \\text{sign}(\\sigma^{\\text{tr}}_{n+1})$$\nTaking the absolute value of both sides gives:\n$$|\\sigma_{n+1}| = |\\sigma^{\\text{tr}}_{n+1}| - E \\cdot \\Delta\\lambda$$\n\nThe final stress must lie on the updated yield surface, so from the yield condition (5) and hardening law (4):\n$$|\\sigma_{n+1}| = \\sigma_{y0} + H \\alpha_{n+1} = \\sigma_{y0} + H (\\alpha_{n} + \\Delta\\lambda)$$\n\nEquating the two expressions for $|\\sigma_{n+1}|$:\n$$|\\sigma^{\\text{tr}}_{n+1}| - E \\cdot \\Delta\\lambda = \\sigma_{y0} + H \\alpha_{n} + H \\cdot \\Delta\\lambda$$\nWe can now solve for the unknown consistency parameter $\\Delta\\lambda$:\n$$|\\sigma^{\\text{tr}}_{n+1}| - (\\sigma_{y0} + H \\alpha_{n}) = (E + H) \\Delta\\lambda$$\nThe left side is precisely the trial yield function, $f^{\\text{tr}}$. Therefore:\n$$\\Delta\\lambda = \\frac{f^{\\text{tr}}}{E + H} = \\frac{|\\sigma^{\\text{tr}}_{n+1}| - (\\sigma_{y0} + H \\alpha_{n})}{E + H}$$\nSince we are in the plastic case ($f^{\\text{tr}}  0$) and both $E$ and $H$ are non-negative material constants ($E0$), it follows that $\\Delta\\lambda  0$, consistent with the Kuhn-Tucker conditions.\n\nWith $\\Delta\\lambda$ determined, the state variables are updated:\n1.  Hardening variable: $\\alpha_{n+1} = \\alpha_{n} + \\Delta\\lambda$\n2.  Plastic strain: $\\varepsilon^{p}_{n+1} = \\varepsilon^{p}_{n} + \\Delta\\lambda \\cdot \\text{sign}(\\sigma^{\\text{tr}}_{n+1})$\n3.  Stress: $\\sigma_{n+1} = E (\\varepsilon_{n+1} - \\varepsilon^{p}_{n+1})$\n\nThis concludes the derivation of the update algorithm. The algorithm is robust and will be implemented to perform the required numerical experiments. For each test case, the specified strain path will be discretized, and the state will be updated incrementally using this logic. The final state at each step is then used to verify the conditions laid out in the problem statement.", "answer": "```python\nimport numpy as np\n\ndef _uniaxial_update_step(current_state, next_total_strain, E, sigy0, H):\n    \"\"\"\n    Performs a single incremental update step for the uniaxial J2 model.\n\n    Args:\n        current_state (tuple): (sigma_n, ep_n, alpha_n).\n        next_total_strain (float): Total strain at step n+1.\n        E (float): Young's modulus.\n        sigy0 (float): Initial yield stress.\n        H (float): Hardening modulus.\n\n    Returns:\n        tuple: (sigma_n+1, ep_n+1, alpha_n+1).\n    \"\"\"\n    _, ep_n, alpha_n = current_state\n\n    # Elastic predictor\n    sig_tr = E * (next_total_strain - ep_n)\n\n    # Yield function check\n    f_tr = np.abs(sig_tr) - (sigy0 + H * alpha_n)\n\n    if f_tr = 1e-12:  # Using a small tolerance for floating point comparisons\n        # Elastic step\n        sig_n1 = sig_tr\n        ep_n1 = ep_n\n        alpha_n1 = alpha_n\n    else:\n        # Plastic corrector\n        delta_lambda = f_tr / (E + H)\n        alpha_n1 = alpha_n + delta_lambda\n        # np.sign(0) is 0, which is correct for sig_tr = 0\n        ep_n1 = ep_n + delta_lambda * np.sign(sig_tr)\n        sig_n1 = E * (next_total_strain - ep_n1)\n\n    return sig_n1, ep_n1, alpha_n1\n\ndef run_simulation(material_params, strain_path, initial_state=(0.0, 0.0, 0.0)):\n    \"\"\"\n    Runs a full simulation over a given strain path.\n\n    Args:\n        material_params (tuple): (E, sigy0, H).\n        strain_path (list): Sequence of total strains.\n        initial_state (tuple): Initial state (sigma, ep, alpha).\n\n    Returns:\n        tuple: (strains, sigmas, eps, alphas) history lists.\n    \"\"\"\n    E, sigy0, H = material_params\n    \n    strains = list(strain_path)\n    sigmas = [initial_state[0]]\n    eps = [initial_state[1]]  # Plastic strains\n    alphas = [initial_state[2]]\n\n    current_state = initial_state\n    for i in range(len(strains) - 1):\n        next_strain = strains[i+1]\n        next_state = _uniaxial_update_step(current_state, next_strain, E, sigy0, H)\n        \n        sigmas.append(next_state[0])\n        eps.append(next_state[1])\n        alphas.append(next_state[2])\n        current_state = next_state\n        \n    return strains, np.array(sigmas), np.array(eps), np.array(alphas)\n\n\ndef test_A():\n    \"\"\"Elastic unloading verification after plastic loading.\"\"\"\n    E, sigy0, H = 210000.0, 300.0, 1200.0\n    strain_path = [0.0, 0.0050, 0.0025, 0.0]\n    strains, sigmas, eps, _ = run_simulation((E, sigy0, H), strain_path)\n\n    # Unloading occurs from state 1 to 2, and 2 to 3.\n    # Check 1: Plastic strain remains constant during unloading.\n    # ep_1 is the plastic strain after first load, it should not be zero.\n    ep_check1 = np.isclose(eps[2], eps[1], rtol=1e-10, atol=0)\n    ep_check2 = np.isclose(eps[3], eps[2], rtol=1e-10, atol=0)\n    ep_const_check = ep_check1 and ep_check2\n\n    # Check 2: Secant slope on unloading segments equals E.\n    # Avoid division by zero, although strain diffs are non-zero here.\n    slope12 = (sigmas[2] - sigmas[1]) / (strains[2] - strains[1])\n    slope_check1 = np.isclose(slope12, E, rtol=1e-8, atol=0)\n    \n    slope23 = (sigmas[3] - sigmas[2]) / (strains[3] - strains[2])\n    slope_check2 = np.isclose(slope23, E, rtol=1e-8, atol=0)\n    \n    slope_E_check = slope_check1 and slope_check2\n    \n    return ep_const_check and slope_E_check\n\ndef test_B():\n    \"\"\"Purely elastic loading-unloading.\"\"\"\n    E, sigy0, H = 70000.0, 300.0, 500.0\n    strain_path = [0.0, 0.0020, 0.0]\n    strains, sigmas, eps, _ = run_simulation((E, sigy0, H), strain_path)\n\n    # Check 1: Plastic strain is zero throughout.\n    ep_zero_check = np.all(np.abs(eps) = 1e-14)\n    \n    # Check 2: Secant slopes on loading and unloading equal E.\n    slope01 = (sigmas[1] - sigmas[0]) / (strains[1] - strains[0])\n    slope12 = (sigmas[2] - sigmas[1]) / (strains[2] - strains[1])\n    \n    slope_load_check = np.isclose(slope01, E, rtol=1e-12, atol=0)\n    slope_unload_check = np.isclose(slope12, E, rtol=1e-12, atol=0)\n    slope_E_check = slope_load_check and slope_unload_check\n\n    return ep_zero_check and slope_E_check\n\ndef test_C():\n    \"\"\"Yield boundary handling at near-onset loading.\"\"\"\n    E, sigy0, H = 200000.0, 250.0, 1000.0\n    strain_path = [0.0, 0.0012505]\n    _, sigmas, _, alphas = run_simulation((E, sigy0, H), strain_path)\n\n    final_sigma = sigmas[-1]\n    final_alpha = alphas[-1]\n\n    # Check 1: Yield function residual is near zero.\n    residual = np.abs(final_sigma) - (sigy0 + H * final_alpha)\n    residual_check = abs(residual) = 1e-9\n\n    # Check 2: Hardening variable has increased.\n    hardening_check = final_alpha  0\n\n    return residual_check and hardening_check\n\ndef test_D():\n    \"\"\"Re-yield stress recovery upon reloading.\"\"\"\n    E, sigy0, H = 200000.0, 250.0, 1000.0\n    material_params = (E, sigy0, H)\n    \n    # Stage 1: Load to a plastic state and unload to zero.\n    load_unload_path = [0.0, 0.0050, 0.0]\n    _, sig_hist1, ep_hist1, alpha_hist1 = run_simulation(material_params, load_unload_path)\n    \n    ep_star = ep_hist1[1]  # at peak strain\n    alpha_star = alpha_hist1[1] # at peak strain\n\n    # State at the end of unloading\n    initial_state_reload = (sig_hist1[2], ep_hist1[2], alpha_hist1[2])\n\n    # Stage 2: Define reloading path\n    # Predicted re-yield strain\n    eps_pred = ep_star + (sigy0 + H * alpha_star) / E\n    eps_A = eps_pred - 1e-6\n    eps_B = eps_pred + 1e-6\n    \n    reload_path = [0.0, eps_A, eps_B]\n    \n    # Stage 3: Run reloading simulation\n    _, sig_hist2, ep_hist2, alpha_hist2 = run_simulation(material_params, reload_path, initial_state=initial_state_reload)\n\n    # Check 1: Step to eps_A is elastic\n    # alpha at eps_A (index 1 in reload history) should equal alpha_star\n    alpha_A = alpha_hist2[1]\n    check_elastic = np.isclose(alpha_A, alpha_star, atol=1e-12, rtol=0)\n\n    # Check 2: Step to eps_B is plastic\n    sig_B = sig_hist2[2]\n    alpha_B = alpha_hist2[2]\n    \n    # Yield function residual check\n    residual_B = np.abs(sig_B) - (sigy0 + H * alpha_B)\n    check_residual = abs(residual_B) = 1e-9\n    \n    # Hardening increase check\n    check_hardening = alpha_B  alpha_star\n    \n    check_plastic = check_residual and check_hardening\n    \n    return check_elastic and check_plastic\n\n\ndef solve():\n    \"\"\"\n    Executes all test cases and prints the results in the required format.\n    \"\"\"\n    results = [test_A(), test_B(), test_C(), test_D()]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2673864"}]}