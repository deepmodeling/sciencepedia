{"hands_on_practices": [{"introduction": "The principle of superposition finds its most classic and powerful application in the analysis of statically indeterminate structures. This exercise provides a fundamental hands-on application by asking you to determine the reaction force in a propped cantilever beam. By decomposing the indeterminate system into a superposition of simpler, determinate loading cases and enforcing geometric compatibility, you will practice the core strategy that unlocks solutions to a vast class of structural mechanics problems [@problem_id:630180].", "problem": "A uniform beam of length $L$ and constant flexural rigidity $EI$ is fixed (cantilevered) at the end $x=0$ and rests on a simple support (a prop) at the end $x=L$. This configuration is known as a propped cantilever beam. The beam is subjected to a distributed vertical load, $w(x)$, that varies linearly from an intensity of $w_1$ at the fixed end to an intensity of $w_2$ at the propped end. The load distribution is thus given by:\n$$\nw(x) = w_1 + (w_2 - w_1) \\frac{x}{L}\n$$\nThis system is statically indeterminate. To solve for the support reactions, one must consider the deflection of the beam. The principle of superposition is a powerful method for this analysis.\n\nUsing the principle of superposition, derive an expression for the vertical reaction force, $R_B$, at the simple support located at $x=L$.\n\nTo aid in the derivation, the downward deflections at the free end of a cantilever beam of length $L$ for some standard load cases are provided:\n1.  A point load $P$ at the free end: $\\delta_P = \\frac{PL^3}{3EI}$\n2.  A uniformly distributed load of constant intensity $w$: $\\delta_w = \\frac{wL^4}{8EI}$\n3.  A triangularly distributed load, with intensity $0$ at the fixed end and $w_{max}$ at the free end: $\\delta_{tri} = \\frac{w_{max}L^4}{30EI}$", "solution": "We superpose the actual linearly varying load on a cantilever with an upward point-reaction $R_B$ at $x=L$, and enforce zero deflection at $x=L$.\n\n1.  Decompose the load\n    $$w(x)=w_1+\\frac{w_2-w_1}{L}x = \\underbrace{w_1}_{\\text{uniform}}+\\underbrace{\\frac{w_2-w_1}{L}x}_{\\text{triangular}}$$\n2.  Deflection at free end ($x=L$) due to the uniform part\n    $$\\delta_{\\text{uni}} = \\frac{w_1L^4}{8EI}$$\n3.  Deflection due to the triangular part (zero at fixed, $w_2-w_1$ at free)\n    $$\\delta_{\\text{tri}} = \\frac{(w_2-w_1)L^4}{30EI}$$\n4.  Deflection due to upward point load $R_B$ at free end (downward convention)\n    $$\\delta_{R_B} = -\\frac{R_B L^3}{3EI}$$\n5.  Compatibility: total deflection at $x=L$ vanishes\n    $$\\delta_{\\text{uni}}+\\delta_{\\text{tri}}+\\delta_{R_B}=0 \\implies \\frac{w_1L^4}{8EI}+\\frac{(w_2-w_1)L^4}{30EI}-\\frac{R_B L^3}{3EI}=0$$\n6.  Solve for $R_B$\n    $$\\frac{L^4}{EI}\\Bigl(\\frac{w_1}{8}+\\frac{w_2-w_1}{30}\\Bigr) = \\frac{R_B L^3}{3EI} \\implies R_B = 3L\\Bigl(\\frac{w_1}{8}+\\frac{w_2-w_1}{30}\\Bigr) = \\frac{L(11w_1+4w_2)}{40}$$", "answer": "$$\\boxed{\\frac{L(11w_1+4w_2)}{40}}$$", "id": "630180"}, {"introduction": "Moving beyond one-dimensional structural elements, superposition is equally vital for analyzing two-dimensional stress fields in continuum mechanics. This problem explores the stress concentration around a circular hole, a critical topic in design and fracture mechanics. You will superpose the known stress fields from different loading conditions (biaxial tension and internal pressure) to analyze a more complex scenario, demonstrating how the principle allows us to build solutions for intricate problems from a library of fundamental cases [@problem_id:630098].", "problem": "An infinite, thin, isotropic, and linear elastic plate contains a circular hole of radius $R$. The plate is subjected to a remote biaxial stress field, with principal stresses $\\sigma_x$ and $\\sigma_y$ acting along the Cartesian axes $x$ and $y$, respectively. Additionally, the boundary of the hole is subjected to a uniform internal pressure $p$.\n\nThe stress components in polar coordinates $(r, \\theta)$ around a circular hole in an infinite plate for different loading cases are given. The angle $\\theta$ is measured counter-clockwise from the positive $x$-axis.\n\n1.  For a remote uniaxial tension $\\sigma_0$ acting along the $x$-axis, the tangential stress at the hole boundary ($r=R$) is given by the Kirsch equation:\n    $$ \\sigma_{\\theta\\theta}(R, \\theta) = \\sigma_0 (1 - 2\\cos(2\\theta)) $$\n2.  For a uniform internal pressure $p$ applied to the hole boundary, with zero stress at infinity, the LamÃ© solution gives the tangential stress at the boundary as:\n    $$ \\sigma_{\\theta\\theta}(R) = p $$\n\nUsing the principle of superposition, derive an expression for the internal pressure $p$ in terms of $\\sigma_x$ and $\\sigma_y$ that makes the minimum tangential stress at the boundary of the hole equal to zero. You may assume that $\\sigma_x > \\sigma_y > 0$.", "solution": "We superpose three loading cases: remote tension $\\sigma_x$ along $x$, remote tension $\\sigma_y$ along $y$, and internal pressure $p$.\n\n1.  Remote uniaxial tension $\\sigma_x$ along $x$ (Kirsch):\n    $$\\sigma_{\\theta\\theta}^{(x)}(R,\\theta)=\\sigma_x\\bigl(1-2\\cos2\\theta\\bigr)$$\n2.  Remote uniaxial tension $\\sigma_y$ along $y$ is equivalent to Kirsch with $\\theta \\to \\theta + \\frac{\\pi}{2}$:\n    $$\\sigma_{\\theta\\theta}^{(y)}(R,\\theta) = \\sigma_y\\bigl[1-2\\cos2\\bigl(\\theta+\\frac{\\pi}{2}\\bigr)\\bigr] = \\sigma_y\\bigl(1+2\\cos2\\theta\\bigr)$$\n3.  Uniform internal pressure $p$ gives\n    $$\\sigma_{\\theta\\theta}^{(p)}(R)=p$$\nBy superposition,\n$$\\sigma_{\\theta\\theta}(R,\\theta) = \\sigma_x(1-2\\cos2\\theta)+\\sigma_y(1+2\\cos2\\theta)+p = \\bigl(\\sigma_x+\\sigma_y+p\\bigr)+2(\\sigma_y-\\sigma_x)\\cos2\\theta$$\nSince $\\sigma_x > \\sigma_y$, the coefficient $2(\\sigma_y-\\sigma_x)0$, so the minimum occurs at $\\cos2\\theta=1$:\n$$\\sigma_{\\min} = (\\sigma_x+\\sigma_y+p)+2(\\sigma_y-\\sigma_x) = -\\sigma_x+3\\sigma_y+p$$\nRequiring $\\sigma_{\\min}=0$ yields\n$$p=\\sigma_x-3\\sigma_y$$", "answer": "$$\\boxed{\\sigma_x-3\\sigma_y}$$", "id": "630098"}, {"introduction": "In modern engineering, the principle of superposition forms the bedrock of efficient computational analysis, particularly in the context of the Finite Element Method. This practice exercise challenges you to implement this principle computationally, using the concept of influence vectors to analyze a system under various load patterns without repeatedly solving the governing matrix equations. This approach of pre-computing responses to unit loads and assembling the final solution is a cornerstone of advanced structural analysis and design optimization, showcasing the principle's relevance in high-performance computing [@problem_id:2699158].", "problem": "A discrete linear elastic system is modeled by a symmetric positive definite stiffness matrix $K \\in \\mathbb{R}^{n \\times n}$, relating nodal displacement vector $u \\in \\mathbb{R}^{n}$ to nodal force vector $f \\in \\mathbb{R}^{n}$ via the linear equilibrium equation $K u = f$. By the linearity of the mapping $f \\mapsto u$, the principle of superposition holds. You are asked to compute responses for many sparse load patterns efficiently, without explicitly forming $K^{-1}$ and without refactorizing $K$ more than once per test case, by assembling responses from a small set of canonical influence solutions. Assume $K$ is time-invariant and independent of $f$.\n\nStart from fundamental momentum balance and linear elasticity assumptions: equilibrium of the discrete system enforces $K u = f$, with $K$ arising from a stable linear constitutive relation and compatible kinematics so that $K$ is symmetric positive definite. Use these principles to design an algorithm from first principles that minimizes repeated work across many load patterns by exploiting linearity. Do not use any prepackaged shortcut specific to a problem domain other than general linear algebra.\n\nYour program must solve the following test suite using $0$-based indexing for degrees of freedom. All physical units must be observed: stiffness entries are in newtons per meter ($\\mathrm{N/m}$), forces are in newtons ($\\mathrm{N}$), displacements are in meters ($\\mathrm{m}$), and strain energy is in joules ($\\mathrm{J}$). For each test case, precompute a minimal set of canonical influence responses and then, for each load pattern, assemble the displacement vector using superposition from those influence responses. For each load pattern, report only the total strain energy $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$ in joules. Express each strain energy in joules as a decimal number rounded to six decimal places.\n\nConstraints that must be satisfied by your program for each test case:\n- Perform at most a single matrix factorization of $K$ per test case.\n- Do not explicitly form $K^{-1}$.\n- Use superposition by precomputing influence responses corresponding to a prescribed set of loadable degrees of freedom.\n- Each given load vector has nonzero entries only at the specified loadable degrees of freedom.\n\nTest suite. There are $3$ independent test cases. For each test case, a stiffness matrix $K$, a set $\\mathcal{I}$ of loadable degree-of-freedom indices, and a list of load vectors $\\{ f^{(j)} \\}$ are specified. Indices are $0$-based, and vectors are listed in coordinate order.\n\n- Test case $1$:\n  - Size $n = 4$.\n  - Stiffness\n    $$K_1 = 1000 \\cdot\n    \\begin{bmatrix}\n    2  -1  0  0 \\\\\n    -1  2  -1  0 \\\\\n    0  -1  2  -1 \\\\\n    0  0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - Loadable indices $\\mathcal{I}_1 = \\{0, 3\\}$.\n  - Load vectors (in newtons):\n    $$f_1^{(1)} = \\begin{bmatrix} 100 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_1^{(2)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 50 \\end{bmatrix}, \\quad\n      f_1^{(3)} = \\begin{bmatrix} 60 \\\\ 0 \\\\ 0 \\\\ 40 \\end{bmatrix}, \\quad\n      f_1^{(4)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}.$$\n\n- Test case $2$:\n  - Size $n = 5$.\n  - Stiffness\n    $$K_2 = 1500 \\cdot\n    \\begin{bmatrix}\n    2  -1  0  0  0 \\\\\n    -1  2  -1  0  0 \\\\\n    0  -1  2  -1  0 \\\\\n    0  0  -1  2  -1 \\\\\n    0  0  0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - Loadable indices $\\mathcal{I}_2 = \\{1, 4\\}$.\n  - Load vectors (in newtons):\n    $$f_2^{(1)} = \\begin{bmatrix} 0 \\\\ 120 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_2^{(2)} = \\begin{bmatrix} 0 \\\\ 80 \\\\ 0 \\\\ 0 \\\\ 40 \\end{bmatrix}, \\quad\n      f_2^{(3)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 100 \\end{bmatrix}, \\quad\n      f_2^{(4)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}.$$\n\n- Test case $3$:\n  - Size $n = 3$.\n  - Stiffness\n    $$K_3 = 500 \\cdot\n    \\begin{bmatrix}\n    2  -1  0 \\\\\n    -1  2  -1 \\\\\n    0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - Loadable indices $\\mathcal{I}_3 = \\{1\\}$.\n  - Load vectors (in newtons):\n    $$f_3^{(1)} = \\begin{bmatrix} 0 \\\\ 75 \\\\ 0 \\end{bmatrix}, \\quad\n      f_3^{(2)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_3^{(3)} = \\begin{bmatrix} 0 \\\\ 150 \\\\ 0 \\end{bmatrix}.$$\n\nRequired output. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list should have one entry per test case, in the same order as above. Each entry must be a list of decimal numbers, where each number is the strain energy $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$ in joules for the corresponding load vector in the order given, rounded to six decimal places. For example, the overall format should be\n$$[\\,[U_{1}^{(1)}, U_{1}^{(2)}, \\dots],\\ [U_{2}^{(1)}, U_{2}^{(2)}, \\dots],\\ [U_{3}^{(1)}, U_{3}^{(2)}, \\dots]\\,],$$\nwith all $U$ expressed in $\\mathrm{J}$ as decimal numbers rounded to six decimal places.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The discrete linear elastic system is governed by the equilibrium equation $K u = f$, where $K \\in \\mathbb{R}^{n \\times n}$ is the symmetric positive definite stiffness matrix, $u \\in \\mathbb{R}^{n}$ is the nodal displacement vector, and $f \\in \\mathbb{R}^{n}$ is the nodal force vector.\n- **Principle of Superposition**: The linearity of the map $f \\mapsto u$ is explicitly stated.\n- **Strain Energy**: The total strain energy is given by the formula $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$.\n- **Constraints on Method**:\n    1.  Perform at most one matrix factorization of $K$ per test case.\n    2.  Do not explicitly compute the matrix inverse $K^{-1}$.\n    3.  Use superposition by precomputing responses to canonical loads.\n    4.  Load vectors are sparse, with non-zero entries only at specified loadable degrees of freedom (DOFs).\n- **Test Cases**: Three test cases are provided. Each consists of a stiffness matrix $K$, a set of loadable DOF indices $\\mathcal{I}$, and a list of load vectors $\\{ f^{(j)} \\}$.\n    - **Test Case 1**:\n        - $n = 4$\n        - $K_1 = 1000 \\cdot [[2, -1, 0, 0], [-1, 2, -1, 0], [0, -1, 2, -1], [0, 0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_1 = \\{0, 3\\}$\n        - $f_1^{(1)} = [100, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_1^{(2)} = [0, 0, 0, 50]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_1^{(3)} = [60, 0, 0, 40]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_1^{(4)} = [0, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n    - **Test Case 2**:\n        - $n = 5$\n        - $K_2 = 1500 \\cdot [[2, -1, 0, 0, 0], [-1, 2, -1, 0, 0], [0, -1, 2, -1, 0], [0, 0, -1, 2, -1], [0, 0, 0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_2 = \\{1, 4\\}$\n        - $f_2^{(1)} = [0, 120, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_2^{(2)} = [0, 80, 0, 0, 40]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_2^{(3)} = [0, 0, 0, 0, 100]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_2^{(4)} = [0, 0, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n    - **Test Case 3**:\n        - $n = 3$\n        - $K_3 = 500 \\cdot [[2, -1, 0], [-1, 2, -1], [0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_3 = \\{1\\}$\n        - $f_3^{(1)} = [0, 75, 0]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_3^{(2)} = [0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$, $f_3^{(3)} = [0, 150, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n- **Output Requirement**: For each test case, report a list of strain energies for each load vector, rounded to six decimal places, in a nested list format.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is founded on the fundamental principles of linear elasticity and structural mechanics, namely the equilibrium equation $K u = f$ for a discrete system and the principle of superposition which is a direct consequence of linearity. The stiffness matrices provided are symmetric and (as is well-known for this structure) positive definite, consistent with stable elastic systems. The definition of strain energy $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$ is correct for a linear elastic system. The problem is scientifically sound.\n- **Well-Posed**: The stiffness matrix $K$ is stated to be symmetric positive definite, which means it is invertible. Therefore, for any given force vector $f$, a unique displacement vector $u = K^{-1}f$ exists. The problem is well-posed.\n- **Objectivity**: The problem is specified using precise mathematical notation and objective physical quantities. There are no subjective or ambiguous statements.\n- **Completeness and Consistency**: All necessary data ($K$, $\\mathcal{I}$, $f^{(j)}$) and formulas are provided for each test case. The constraints on the solution method are clearly defined and not contradictory. The problem is self-contained and consistent.\n- **Feasibility**: The numerical values and matrix structures are standard for academic problems in mechanics. There are no physically impossible conditions or dimensionally inconsistent data.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is scientifically grounded, well-posed, objective, and complete. A solution will be constructed based on exploiting the principle of superposition as required.\n\n### Solution Derivation\nThe governing equation of the static, discrete linear elastic system is\n$$K u = f$$\nwhere $K$ is the stiffness matrix, $u$ is the displacement vector, and $f$ is the force vector. Since $K$ is a constant matrix, this represents a linear transformation from the space of forces to the space of displacements. The formal solution is $u = K^{-1}f$. This linearity gives rise to the principle of superposition.\n\nThe problem specifies that for any given test case, all applied load vectors $f$ have non-zero components only at a small, fixed set of degrees of freedom (DOFs), denoted by the index set $\\mathcal{I}$. Let the canonical basis vector for the $k$-th DOF be $e_k$, which is a vector with a value of $1$ at index $k$ and $0$ elsewhere. Any such load vector $f$ can be expressed as a linear combination of these basis vectors for $k \\in \\mathcal{I}$:\n$$f = \\sum_{k \\in \\mathcal{I}} f_k e_k$$\nwhere $f_k$ is the magnitude of the force applied at DOF $k$.\n\nBy the principle of superposition, the displacement response $u$ to the combined load $f$ is the sum of the scaled responses to each individual component of the load:\n$$u = K^{-1}f = K^{-1} \\left( \\sum_{k \\in \\mathcal{I}} f_k e_k \\right) = \\sum_{k \\in \\mathcal{I}} f_k (K^{-1} e_k)$$\n\nThis structure suggests an efficient computational strategy. We can precompute a set of \"influence vectors.\" An influence vector, which we denote as $u^{(k)}$, is the displacement response of the system to a unit load applied at a single DOF $k$. Mathematically, $u^{(k)}$ is the solution to the linear system:\n$$K u^{(k)} = e_k$$\nThus, $u^{(k)} = K^{-1}e_k$. Note that $u^{(k)}$ is simply the $k$-th column of the inverse matrix $K^{-1}$. However, the problem forbids the explicit computation of $K^{-1}$. Instead, we can solve the system $K u^{(k)} = e_k$ for each $k \\in \\mathcal{I}$ to find the required influence vectors.\n\nOnce the set of influence vectors $\\{u^{(k)} \\mid k \\in \\mathcal{I}\\}$ is precomputed, the displacement response $u^{(j)}$ for any given load vector $f^{(j)}$ can be assembled rapidly by linear combination:\n$$u^{(j)} = \\sum_{k \\in \\mathcal{I}} f_k^{(j)} u^{(k)}$$\nwhere $f_k^{(j)}$ is the $k$-th component of the vector $f^{(j)}$.\n\nFinally, the strain energy $U^{(j)}$ for each load case is calculated using its definition:\n$$U^{(j)} = \\frac{1}{2} (f^{(j)})^{\\mathsf{T}} u^{(j)}$$\n\nThe overall algorithm for each test case is as follows:\n1.  **Precomputation**:\n    a.  Factorize the stiffness matrix $K$ once. Since $K$ is symmetric and positive definite, Cholesky factorization ($K = LL^{\\mathsf{T}}$) is the most efficient choice. This single factorization adheres to the problem constraints.\n    b.  For each index $k$ in the set of loadable DOFs $\\mathcal{I}$:\n        i.  Construct the unit load vector $e_k$.\n        ii. Solve the linear system $K u^{(k)} = e_k$ to find the influence vector $u^{(k)}$. This is done efficiently using the precomputed Cholesky factors (forward and backward substitution), avoiding re-factorization and explicit inversion.\n    c.  Store the computed influence vectors $\\{u^{(k)}\\}_{k \\in \\mathcal{I}}$.\n\n2.  **Response Calculation**:\n    a.  For each load vector $f^{(j)}$ provided in the test case:\n        i.  Initialize the total displacement vector $u^{(j)}$ to the zero vector.\n        ii. Assemble the total displacement by summing the contributions from each loadable DOF: $u^{(j)} = \\sum_{k \\in \\mathcal{I}} f_k^{(j)} u^{(k)}$.\n        iii. Compute the strain energy: $U^{(j)} = \\frac{1}{2} (f^{(j)})^{\\mathsf{T}} u^{(j)}$.\n    b.  Collect the computed energies for all load vectors in the test case.\n\nThis algorithm satisfies all problem constraints by performing only one factorization per test case, avoiding explicit matrix inversion, and leveraging superposition to efficiently compute responses for multiple load scenarios.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import cho_factor, cho_solve\n\ndef solve():\n    \"\"\"\n    Solves a series of linear elastic problems using the principle of superposition.\n    For each test case, it pre-computes influence vectors for a set of loadable\n    degrees of freedom and then assembles the response for various load patterns.\n    The final output is the strain energy for each load pattern.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"K\": 1000.0 * np.array([\n                [2, -1, 0, 0],\n                [-1, 2, -1, 0],\n                [0, -1, 2, -1],\n                [0, 0, -1, 2]\n            ]),\n            \"loadable_indices\": [0, 3],\n            \"load_vectors\": [\n                np.array([100.0, 0, 0, 0]),\n                np.array([0, 0, 0, 50.0]),\n                np.array([60.0, 0, 0, 40.0]),\n                np.array([0, 0, 0, 0])\n            ]\n        },\n        {\n            \"K\": 1500.0 * np.array([\n                [2, -1, 0, 0, 0],\n                [-1, 2, -1, 0, 0],\n                [0, -1, 2, -1, 0],\n                [0, 0, -1, 2, -1],\n                [0, 0, 0, -1, 2]\n            ]),\n            \"loadable_indices\": [1, 4],\n            \"load_vectors\": [\n                np.array([0, 120.0, 0, 0, 0]),\n                np.array([0, 80.0, 0, 0, 40.0]),\n                np.array([0, 0, 0, 0, 100.0]),\n                np.array([0, 0, 0, 0, 0])\n            ]\n        },\n        {\n            \"K\": 500.0 * np.array([\n                [2, -1, 0],\n                [-1, 2, -1],\n                [0, -1, 2]\n            ]),\n            \"loadable_indices\": [1],\n            \"load_vectors\": [\n                np.array([0, 75.0, 0]),\n                np.array([0, 0, 0]),\n                np.array([0, 150.0, 0])\n            ]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        K = case[\"K\"]\n        loadable_indices = case[\"loadable_indices\"]\n        load_vectors = case[\"load_vectors\"]\n        n = K.shape[0]\n        \n        # Precomputation Step\n        # 1. Factorize the stiffness matrix K = L L^T once.\n        # Since K is symmetric positive-definite, Cholesky factorization is used.\n        try:\n            c, low = cho_factor(K, lower=True)\n        except np.linalg.LinAlgError:\n            # This should not happen for the given valid matrices.\n            # Handle error gracefully if it occurs in a general case.\n            all_results.append([])\n            continue\n\n        # 2. Compute and store influence vectors for each loadable DOF.\n        # An influence vector u_k is the response to a unit load e_k at DOF k.\n        influence_vectors = {}\n        for k in loadable_indices:\n            # Create the unit load vector e_k.\n            e_k = np.zeros(n)\n            e_k[k] = 1.0\n            \n            # Solve K u_k = e_k using the precomputed Cholesky factorization.\n            u_k = cho_solve((c, low), e_k)\n            influence_vectors[k] = u_k\n\n        # Response Calculation Step\n        case_energies = []\n        for f in load_vectors:\n            # Assemble the total displacement u using superposition.\n            u = np.zeros(n)\n            for k in loadable_indices:\n                force_component = f[k]\n                if force_component != 0.0:\n                    u += force_component * influence_vectors[k]\n            \n            # Calculate strain energy U = 0.5 * f^T * u.\n            energy = 0.5 * np.dot(f, u)\n            \n            # Round to six decimal places as required.\n            case_energies.append(round(energy, 6))\n            \n        all_results.append(case_energies)\n\n    # Format the final output string exactly as specified.\n    # The str() of a list of lists is close, we just remove spaces.\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```", "id": "2699158"}]}