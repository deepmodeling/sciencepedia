{"hands_on_practices": [{"introduction": "The best way to begin our exploration of limit analysis is with a simple, illustrative case. This exercise examines a basic two-bar truss, a statically determinate structure where the forces can be found directly from equilibrium. By applying both the static (lower bound) and kinematic (upper bound) theorems, you will not only calculate the collapse load from two different perspectives but also demonstrate that the bounds coincide, yielding the exact solution. This practice [@problem_id:2654975] provides a crucial foundation, solidifying the core concepts before we tackle more complex, indeterminate systems.", "problem": "A pin-jointed two-bar truss supports a vertical load at its apex. The two identical bars are connected at their lower ends to fixed, frictionless pins located at coordinates $\\left(-a,\\,0\\right)$ and $\\left(+a,\\,0\\right)$ in a Cartesian frame, and they meet at the apex joint at $\\left(0,\\,h\\right)$. Each bar has constant cross-sectional area $A$ and obeys a rigid, ideally plastic, rate-independent uniaxial constitutive behavior with yield stress $\\sigma_{y}$ in both tension and compression. The bars carry only axial force, are perfectly braced against instability, and geometric changes are small so that first-order kinematics and equilibrium are valid for virtual work statements.\n\nA downward vertical load $P=\\lambda\\,P_{0}$ is applied at the apex, where $P_{0}>0$ is a fixed reference load and $\\lambda$ is a non-dimensional load factor. The truss collapses when a plastic mechanism forms with bars at their yield condition $|N|\\le N_{p}$, where $N$ is the axial force in a bar and $N_{p}=\\sigma_{y}A$ is the plastic axial capacity.\n\nUsing only the foundational principles of equilibrium, compatibility, the definition of the plastic axial capacity, and the statements of the lower bound (static) and upper bound (kinematic) theorems of limit analysis:\n\n- Construct a statically admissible axial force field that satisfies equilibrium of the apex joint and the yield condition in the two bars, and deduce a lower bound on the collapse load factor $\\lambda$.\n- Construct a kinematically admissible collapse mechanism with a consistent virtual velocity field at the apex and fixed supports, invoke the principle of virtual work and the principle of maximum plastic dissipation for rigid, ideally plastic behavior to deduce an upper bound on $\\lambda$.\n- Show that, when the stress field and mechanism are chosen consistently with the geometry and the yield surface, the lower and upper bounds coincide, thereby yielding the exact critical load factor $\\lambda_{c}$.\n\nExpress the exact $\\lambda_{c}$ as a closed-form analytic expression in terms of $a$, $h$, $A$, $\\sigma_{y}$, and $P_{0}$. Do not perform any numerical substitutions. Your final answer must be a single analytic expression for $\\lambda_{c}$ without units.", "solution": "We begin by recording the basic geometric and mechanical facts. The bar from $\\left(-a,\\,0\\right)$ to $\\left(0,\\,h\\right)$ and the bar from $\\left(+a,\\,0\\right)$ to $\\left(0,\\,h\\right)$ are identical, each having length\n$$\nL=\\sqrt{a^{2}+h^{2}}.\n$$\nLet $\\mathbf{e}_{1}$ and $\\mathbf{e}_{2}$ be unit vectors along the bars from the lower supports to the apex joint. By geometry,\n$$\n\\mathbf{e}_{1}=\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right),\\qquad \\mathbf{e}_{2}=\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right).\n$$\nLet the unknown axial force in each bar be $N_{1}$ and $N_{2}$, taken positive in tension along $\\mathbf{e}_{1}$ and $\\mathbf{e}_{2}$, respectively. The applied load at the apex is $\\mathbf{P}=(0,\\,-P)$ with $P=\\lambda P_{0}>0$.\n\nLower bound (static theorem). The lower bound theorem asserts that if there exists a statically admissible field of internal forces that satisfies global equilibrium with the applied load and the yield condition $|N_{i}|\\le N_{p}$ everywhere, then the associated load is a safe estimate that does not exceed the true collapse load. For the pin-jointed truss, equilibrium at the apex requires\n$$\nN_{1}\\,\\mathbf{e}_{1}+N_{2}\\,\\mathbf{e}_{2}+\\mathbf{P}=\\mathbf{0}.\n$$\nBy symmetry of geometry and loading, a statically admissible choice is $N_{1}=N_{2}=N$. Projecting onto the vertical direction,\n$$\nN\\left(\\frac{h}{L}\\right)+N\\left(\\frac{h}{L}\\right)-P=0\\quad\\Longrightarrow\\quad 2N\\frac{h}{L}=P.\n$$\nImposing the yield constraint $|N|\\le N_{p}=\\sigma_{y}A$ and seeking the largest admissible $P$ gives the lower bound when $N=+N_{p}$:\n$$\nP_{\\mathrm{LB}}=2N_{p}\\frac{h}{L}=2\\,\\sigma_{y}A\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nHence the lower bound on the load factor is\n$$\n\\lambda_{\\mathrm{LB}}=\\frac{P_{\\mathrm{LB}}}{P_{0}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\nUpper bound (kinematic theorem). The upper bound theorem asserts that for any kinematically admissible velocity field that is compatible with supports and mechanisms, the external power equals the internal plastic dissipation at collapse, and this provides an upper bound on the collapse load. For a rate-independent rigid, ideally plastic material with convex symmetric yield surface $|N|\\le N_{p}$ in one dimension, the principle of maximum plastic dissipation implies that, for a prescribed axial plastic extension rate $\\dot{\\Delta}$, the internal power in each bar attains the maximum value $N_{p}\\,|\\dot{\\Delta}|$ when the axial force takes the value $N=N_{p}\\,\\mathrm{sign}(\\dot{\\Delta})$.\n\nChoose a kinematically admissible mechanism in which the apex has a vertical velocity $\\mathbf{v}=(0,\\,-v)$ with $v>0$, while the supports are fixed. The small-deformation compatibility gives the axial rate in each bar as the projection of the relative velocity of the apex on the barâ€™s unit axis:\n$$\n\\dot{\\Delta}_{1}=\\mathbf{v}\\cdot\\mathbf{e}_{1}=(0,\\,-v)\\cdot\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L},\\qquad\n\\dot{\\Delta}_{2}=\\mathbf{v}\\cdot\\mathbf{e}_{2}=(0,\\,-v)\\cdot\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L}.\n$$\nTherefore, the total internal plastic dissipation rate is\n$$\n\\dot{W}_{\\mathrm{int}}=N_{p}\\,|\\dot{\\Delta}_{1}|+N_{p}\\,|\\dot{\\Delta}_{2}|=2\\,N_{p}\\,\\left(\\frac{v\\,h}{L}\\right)=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nThe external power is the product of the applied load and the compatible velocity in the direction of the load:\n$$\n\\dot{W}_{\\mathrm{ext}}=P\\,v=\\lambda P_{0}\\,v.\n$$\nEquating external power and internal dissipation at collapse gives the kinematic upper bound\n$$\n\\lambda_{\\mathrm{UB}}\\,P_{0}\\,v=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}\\quad\\Longrightarrow\\quad \\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\nCoincidence of bounds and exactness. The lower bound and upper bound derived above are equal:\n$$\n\\lambda_{\\mathrm{LB}}=\\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\nThis equality occurs because the statically admissible field and the kinematically admissible mechanism are consistent with the geometry and the symmetric yield surface: both bars are activated, and the directions of axial plastic flow selected in the kinematic analysis are those that maximize dissipation subject to $|N|\\le N_{p}$, which is dual to the static field that saturates $|N|=N_{p}$ and satisfies equilibrium. By the fundamental theorems of limit analysis, when a common value is obtained from both bounds, it is the exact collapse load factor $\\lambda_{c}$.\n\nTherefore, the exact critical load factor is\n$$\n\\lambda_{c}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$", "answer": "$$\\boxed{2\\,\\dfrac{\\sigma_{y}A}{P_{0}}\\,\\dfrac{h}{\\sqrt{a^{2}+h^{2}}}}$$", "id": "2654975"}, {"introduction": "Moving from determinate to indeterminate structures, we now apply the kinematic (upper bound) theorem to a propped cantilever beam. Unlike the static theorem, which requires finding a valid stress field, the kinematic approach involves postulating a plausible collapse mechanism. This practice [@problem_id:2655046] develops the essential skill of defining a kinematically admissible velocity field, calculating the external work and internal dissipation, and using the principle of virtual work to find an upper bound on the collapse load. The final step of minimizing this load with respect to the mechanism's geometry is a powerful technique for finding the lowest, and often exact, upper bound.", "problem": "A straight, prismatic beam of length $L$ with a rigid-perfectly-plastic bending response is built-in at $x=0$ (fixed support) and propped at $x=L$ by a simple support that prevents vertical translation but allows rotation. The cross-section has a symmetric bending yield capacity so that the fully plastic moment is $M_p$ in both sagging and hogging, there is no axial force interaction, and shear capacity is sufficiently high that shear yielding does not occur. The beam is subjected to a uniformly distributed transverse load of unknown constant intensity $w$ acting downward over $0 \\le x \\le L$. Assume small rotations and that, in the collapse mechanism, the beam segments between plastic hinges undergo rigid-body motions separated by plastic hinges where concentrated plastic rotations occur.\n\nUsing the kinematic (upper bound) theorem of plastic collapse and the principle of virtual work, consider a kinematically admissible mechanism with two plastic hinges: one at the fixed end $x=0$ and another at an interior location $x=b$ with $0<b<L$. Do not introduce a plastic hinge at the propped end. Enforce the geometric constraint that the vertical displacement at the prop location $x=L$ is zero. Express the rate of external work of the load in terms of the virtual displacement field compatible with this mechanism, and the rate of internal plastic dissipation as $M_p$ times the sum of plastic hinge rotation rates. Eliminate dependent kinematic parameters to write $w$ as a function of $b$, then determine the least upper bound by minimizing over $b\\in(0,L)$.\n\nProvide your final result as a single closed-form symbolic expression for the collapse load intensity $w_{\\mathrm{UB}}$ in terms of $M_p$ and $L$ only. No numerical substitution is required and no rounding is needed. Do not include units in the final expression.", "solution": "The analysis proceeds by applying the principle of virtual work to the prescribed collapse mechanism. The rate of external work done by the applied load must equal the rate of internal energy dissipated at the plastic hinges.\n\nFirst, we define the kinematically admissible virtual displacement field, $\\dot{\\delta}(x)$. A plastic hinge forms at the fixed support $x=0$ and at an interior point $x=b$. The beam is composed of two rigid segments: segment $1$ from $x=0$ to $x=b$, and segment $2$ from $x=b$ to $x=L$. Let us introduce a virtual rotation rate $\\dot{\\alpha}$ for segment $1$ about the point $x=0$. For small rotations, the virtual vertical displacement at any point $x$ in this segment is given by:\n$$ \\dot{\\delta}(x) = \\dot{\\alpha}x, \\quad \\text{for } 0 \\le x \\le b $$\nAt the location of the interior hinge, $x=b$, the displacement is $\\dot{\\delta}(b) = \\dot{\\alpha}b$.\n\nSegment $2$, from $x=b$ to $x=L$, rotates as a rigid body to satisfy the boundary condition $\\dot{\\delta}(L)=0$ and the compatibility condition $\\dot{\\delta}(b) = \\dot{\\alpha}b$. This segment pivots about the propped support at $x=L$. The rotation of segment $2$, denoted $\\dot{\\beta}$, must cause an upward displacement of $\\dot{\\alpha}b$ over a length of $L-b$. Thus, the slope of this segment is negative.\n$$ \\dot{\\delta}(x) = \\frac{\\dot{\\delta}(b)}{L-b}(L-x) = \\frac{\\dot{\\alpha}b}{L-b}(L-x), \\quad \\text{for } b \\le x \\le L $$\n\nThe rate of external work, $\\dot{W}_{\\mathrm{ext}}$, done by the uniformly distributed load $w$ is the integral of the load intensity multiplied by the virtual velocity field over the length of the beam.\n$$ \\dot{W}_{\\mathrm{ext}} = \\int_0^L w \\dot{\\delta}(x) dx = w \\left( \\int_0^b \\dot{\\alpha}x \\,dx + \\int_b^L \\frac{\\dot{\\alpha}b}{L-b}(L-x) \\,dx \\right) $$\nEvaluating the integrals:\n$$ \\int_0^b \\dot{\\alpha}x \\,dx = \\dot{\\alpha} \\left[ \\frac{x^2}{2} \\right]_0^b = \\frac{1}{2} \\dot{\\alpha}b^2 $$\n$$ \\int_b^L \\frac{\\dot{\\alpha}b}{L-b}(L-x) \\,dx = \\frac{\\dot{\\alpha}b}{L-b} \\left[ Lx - \\frac{x^2}{2} \\right]_b^L = \\frac{\\dot{\\alpha}b}{L-b} \\left( (L^2 - \\frac{L^2}{2}) - (Lb - \\frac{b^2}{2}) \\right) = \\frac{\\dot{\\alpha}b}{L-b} \\left( \\frac{L^2 - 2Lb + b^2}{2} \\right) = \\frac{\\dot{\\alpha}b(L-b)^2}{2(L-b)} = \\frac{1}{2}\\dot{\\alpha}b(L-b) $$\nSumming the two parts gives the total rate of external work:\n$$ \\dot{W}_{\\mathrm{ext}} = w \\left( \\frac{1}{2}\\dot{\\alpha}b^2 + \\frac{1}{2}\\dot{\\alpha}b(L-b) \\right) = w \\left( \\frac{\\dot{\\alpha}b^2 + \\dot{\\alpha}bL - \\dot{\\alpha}b^2}{2} \\right) = \\frac{1}{2} w \\dot{\\alpha} b L $$\n\nNext, we calculate the rate of internal energy dissipation, $\\dot{W}_{\\mathrm{int}}$. Dissipation occurs at the plastic hinges where the plastic moment $M_p$ resists the relative rotation.\nThe plastic hinge at the fixed support, $x=0$, has a rotation rate equal to the rotation of segment $1$, which is $\\dot{\\theta}_0 = \\dot{\\alpha}$. This is a hogging hinge.\nThe plastic hinge at $x=b$ has a rotation rate equal to the change in slope between segment $1$ and segment $2$. The slope of segment $1$ is $\\dot{\\alpha}$. The slope of segment $2$ is $-\\frac{\\dot{\\alpha}b}{L-b}$. The relative rotation rate is the sum of the magnitudes of these slopes:\n$$ \\dot{\\theta}_b = \\dot{\\alpha} + \\frac{\\dot{\\alpha}b}{L-b} = \\dot{\\alpha} \\left( 1 + \\frac{b}{L-b} \\right) = \\dot{\\alpha} \\left( \\frac{L-b+b}{L-b} \\right) = \\frac{\\dot{\\alpha}L}{L-b} $$\nThis is a sagging hinge. The total rate of internal dissipation is:\n$$ \\dot{W}_{\\mathrm{int}} = M_p |\\dot{\\theta}_0| + M_p |\\dot{\\theta}_b| = M_p \\dot{\\alpha} + M_p \\frac{\\dot{\\alpha}L}{L-b} = M_p \\dot{\\alpha} \\left( 1 + \\frac{L}{L-b} \\right) = M_p \\dot{\\alpha} \\left( \\frac{L-b+L}{L-b} \\right) = M_p \\dot{\\alpha} \\frac{2L-b}{L-b} $$\n\nBy the principle of virtual work, $\\dot{W}_{\\mathrm{ext}} = \\dot{W}_{\\mathrm{int}}$ at collapse.\n$$ \\frac{1}{2} w \\dot{\\alpha} b L = M_p \\dot{\\alpha} \\frac{2L-b}{L-b} $$\nThe virtual rotation rate $\\dot{\\alpha}$ cancels, and we solve for $w$ as a function of $b$:\n$$ w(b) = \\frac{2 M_p}{bL} \\frac{2L-b}{L-b} = \\frac{2M_p}{L} \\left( \\frac{2L-b}{Lb-b^2} \\right) $$\nAccording to the kinematic theorem, this expression provides an upper bound on the true collapse load for any $b \\in (0, L)$. To find the least upper bound, we must minimize $w(b)$ with respect to $b$. We compute the derivative $\\frac{dw}{db}$ and set it to zero. It is sufficient to minimize the function $f(b) = \\frac{2L-b}{Lb-b^2}$.\n$$ \\frac{df}{db} = \\frac{(-1)(Lb-b^2) - (2L-b)(L-2b)}{(Lb-b^2)^2} = 0 $$\nThe numerator must be zero:\n$$ -(Lb-b^2) - (2L^2 - 4Lb - Lb + 2b^2) = 0 $$\n$$ -Lb + b^2 - (2L^2 - 5Lb + 2b^2) = 0 $$\n$$ -Lb + b^2 - 2L^2 + 5Lb - 2b^2 = 0 $$\n$$ -b^2 + 4Lb - 2L^2 = 0 $$\n$$ b^2 - 4Lb + 2L^2 = 0 $$\nThis is a quadratic equation for $b$. The solutions are:\n$$ b = \\frac{-(-4L) \\pm \\sqrt{(-4L)^2 - 4(1)(2L^2)}}{2} = \\frac{4L \\pm \\sqrt{16L^2 - 8L^2}}{2} = \\frac{4L \\pm \\sqrt{8L^2}}{2} = \\frac{4L \\pm 2\\sqrt{2}L}{2} = (2 \\pm \\sqrt{2})L $$\nThe two possible values for $b$ are $(2+\\sqrt{2})L$ and $(2-\\sqrt{2})L$. Since the hinge must be located within the beam, $0 < b < L$. The value $b = (2+\\sqrt{2})L \\approx 3.414L$ is extraneous. The valid location is:\n$$ b = (2-\\sqrt{2})L $$\nNote that $2-\\sqrt{2} \\approx 0.586$, which is in the interval $(0, 1)$.\n\nFinally, we substitute this value of $b$ into the expression for $w(b)$ to find the lowest upper-bound collapse load, $w_{\\mathrm{UB}}$.\n$$ w_{\\mathrm{UB}} = \\frac{2M_p}{L} \\left( \\frac{2L-b}{Lb-b^2} \\right) $$\nLet us evaluate the terms involving $b$:\n$$ 2L - b = 2L - (2-\\sqrt{2})L = (2 - 2 + \\sqrt{2})L = \\sqrt{2}L $$\n$$ Lb - b^2 = L(2-\\sqrt{2})L - ((2-\\sqrt{2})L)^2 = (2-\\sqrt{2})L^2 - (4-4\\sqrt{2}+2)L^2 = (2-\\sqrt{2} - 6+4\\sqrt{2})L^2 = (3\\sqrt{2}-4)L^2 $$\nSubstituting these expressions into the formula for $w_{\\mathrm{UB}}$:\n$$ w_{\\mathrm{UB}} = \\frac{2M_p}{L} \\left( \\frac{\\sqrt{2}L}{(3\\sqrt{2}-4)L^2} \\right) = \\frac{2\\sqrt{2} M_p}{(3\\sqrt{2}-4)L^2} $$\nTo simplify, we rationalize the denominator:\n$$ \\frac{2\\sqrt{2}}{3\\sqrt{2}-4} = \\frac{2\\sqrt{2}}{3\\sqrt{2}-4} \\times \\frac{3\\sqrt{2}+4}{3\\sqrt{2}+4} = \\frac{2\\sqrt{2}(3\\sqrt{2}+4)}{(3\\sqrt{2})^2 - 4^2} = \\frac{12+8\\sqrt{2}}{18-16} = \\frac{12+8\\sqrt{2}}{2} = 6+4\\sqrt{2} $$\nTherefore, the least upper bound for the collapse load intensity is:\n$$ w_{\\mathrm{UB}} = (6+4\\sqrt{2}) \\frac{M_p}{L^2} $$", "answer": "$$\\boxed{(6+4\\sqrt{2})\\frac{M_p}{L^2}}$$", "id": "2655046"}, {"introduction": "While analytical methods are invaluable for understanding principles, modern structural analysis relies on computational tools. This practice demonstrates how the static (lower bound) theorem can be powerfully formulated as a linear programming (LP) problem for complex trusses. You will translate the conditions of equilibrium and yield into a set of linear constraints and use an optimization routine to find the maximum load factor [@problem_id:2655024]. This exercise bridges the gap between abstract theory and practical application, showing how the search for a statically admissible force field can be automated to analyze large, statically indeterminate structures efficiently.", "problem": "Consider a two-dimensional pin-jointed truss modeled as an assembly of straight, axially loaded members connected at frictionless joints. Let there be $n$ nodes with coordinates $(x_j,y_j)$, $j=1,\\dots,n$, and $m$ members indexed by $i=1,\\dots,m$, where member $i$ connects node $a(i)$ to node $b(i)$. Each node has two translational degrees of freedom, $u_{x,j}$ and $u_{y,j}$, for a total of $2n$ degrees of freedom. Some degrees of freedom may be restrained by supports. Loads are applied as nodal forces. For each member $i$, denote its axial force by $N_i$, with the positive sign indicating tension. The member $i$ has a symmetric axial yield capacity $N_{y,i}>0$ so that the plastic admissibility condition is $|N_i|\\le N_{y,i}$. A load pattern is specified as a nodal force vector $\\mathbf{p}_0\\in\\mathbb{R}^{2n}$, and a scalar load factor $\\lambda\\ge 0$ scales this pattern to $\\lambda \\mathbf{p}_0$.\n\nUsing the Lower Bound (Static) Theorem of limit analysis, formulate the problem of finding the maximum load factor $\\lambda^\\star$ such that there exist statically admissible member forces $\\{N_i\\}$ within the yield limits that satisfy equilibrium at all free degrees of freedom. Express this problem as a Linear Programming (LP) problem with decision variables $\\{N_i\\}_{i=1}^m$ and $\\lambda$. The LP must be based solely on:\n- force equilibrium at free degrees of freedom, and\n- the plastic admissibility bounds $|N_i|\\le N_{y,i}$ and $\\lambda\\ge 0$.\n\nConstruct the equilibrium constraints from first principles as follows. For a member $i$ connecting nodes $a$ and $b$, let its length be $L_i=\\sqrt{(x_{b}-x_{a})^2+(y_{b}-y_{a})^2}$ and its unit direction vector be $\\mathbf{t}_i=(c_i,s_i)=\\left(\\dfrac{x_{b}-x_{a}}{L_i},\\dfrac{y_{b}-y_{a}}{L_i}\\right)$. The equivalent nodal force contributions of $N_i$ are $+N_i\\mathbf{t}_i$ at node $a$ and $-N_i\\mathbf{t}_i$ at node $b$. Assemble the equilibrium matrix $\\mathbf{B}\\in\\mathbb{R}^{2n\\times m}$ by placing $\\mathbf{t}_i$ in the rows corresponding to node $a$ and $-\\mathbf{t}_i$ in the rows corresponding to node $b$, for each member $i$, and zeros elsewhere. Let $\\mathcal{F}$ denote the index set of free degrees of freedom, and let $\\mathbf{B}_{\\mathcal{F}}$ and $\\mathbf{p}_{0,\\mathcal{F}}$ be the submatrix and subvector restricted to $\\mathcal{F}$. Then the free-degree equilibrium is\n$$\n\\mathbf{B}_{\\mathcal{F}}\\mathbf{N}+\\lambda\\,\\mathbf{p}_{0,\\mathcal{F}}=\\mathbf{0},\n$$\nwhere $\\mathbf{N}=(N_1,\\dots,N_m)^\\top$.\n\nYour program must:\n- Build $\\mathbf{B}$ from the provided geometry and connectivity.\n- Identify free degrees of freedom from the support conditions and extract $\\mathbf{B}_{\\mathcal{F}}$ and $\\mathbf{p}_{0,\\mathcal{F}}$.\n- Solve the LP that maximizes $\\lambda$ subject to the equality constraints and box bounds $-N_{y,i}\\le N_i\\le N_{y,i}$ and $\\lambda\\ge 0$.\n- Return the optimal $\\lambda^\\star$.\n\nAll distances must be in meters, all forces and capacities in Newtons. The load factor $\\lambda^\\star$ is dimensionless times Newtons because it scales a unit load pattern; report it in Newtons. Express each result $\\lambda^\\star$ as a float rounded to six decimal places.\n\nTest Suite. Use the following four truss instances. For each instance, the input data are:\n- Node list: coordinates $(x_j,y_j)$ in meters.\n- Member list: pairs $(a,b)$ of zero-based node indices.\n- Supports: for each supported node, specify which of its degrees of freedom $(u_x,u_y)$ are restrained.\n- Yield capacities: list $[N_{y,1},\\dots,N_{y,m}]$ in Newtons.\n- Load pattern $\\mathbf{p}_0$: a length-$2n$ array of nodal forces in Newtons. The angle unit, if any, is not applicable here.\n\nCase 1 (symmetric V-truss, happy path):\n- Nodes: $(0,0)$, $(2,0)$, $(1,1)$.\n- Members: $(0,2)$, $(2,1)$.\n- Supports: node $0$ restrains $(u_x,u_y)$, node $1$ restrains $(u_x,u_y)$.\n- Capacities: $[100,100]$.\n- Load pattern: unit vertical downward at node $2$: $\\mathbf{p}_0=[0,0,0,0,0,-1]$.\n\nCase 2 (single vertical member under horizontal load, zero-capacity for this direction, boundary case):\n- Nodes: $(0,0)$, $(0,1)$.\n- Member: $(0,1)$.\n- Supports: node $0$ restrains $(u_x,u_y)$.\n- Capacities: $[100]$.\n- Load pattern: unit horizontal rightward at node $1$: $\\mathbf{p}_0=[0,0,1,0]$.\n\nCase 3 (asymmetric capacities in V-truss, governs by weaker member):\n- Nodes: $(0,0)$, $(2,0)$, $(1,1)$.\n- Members: $(0,2)$, $(2,1)$.\n- Supports: node $0$ restrains $(u_x,u_y)$, node $1$ restrains $(u_x,u_y)$.\n- Capacities: $[80,200]$.\n- Load pattern: unit vertical downward at node $2$: $\\mathbf{p}_0=[0,0,0,0,0,-1]$.\n\nCase 4 (redundant triangle with bottom chord limiting):\n- Nodes: $(0,0)$, $(2,0)$, $(1,1)$.\n- Members: $(0,2)$, $(2,1)$, $(0,1)$.\n- Supports: node $0$ restrains $(u_x,u_y)$, node $1$ restrains $(u_x,u_y)$.\n- Capacities: $[200,200,100]$ where the first two are for diagonals $(0,2)$ and $(2,1)$, and the third is for the bottom chord $(0,1)$.\n- Load pattern: unit vertical downward at node $2$: $\\mathbf{p}_0=[0,0,0,0,0,-1]$.\n\nFinal Output Format. Your program should produce a single line of output containing a comma-separated list of the four optimal load factors $\\lambda^\\star$ for the cases above, in the same order, rounded to six decimal places, enclosed in square brackets. For example, the output must look like:\n[lambda1,lambda2,lambda3,lambda4]", "solution": "The Lower Bound Theorem states that any load factor $\\lambda$ for which a statically admissible stress field can be found is a lower bound on the true collapse load factor $\\lambda^\\star$. A stress field (in this case, the member force vector $\\mathbf{N}$) is statically admissible if it satisfies equilibrium and does not violate the yield criteria. To find the best possible lower bound, we seek the maximum such $\\lambda$. This can be formulated as the following optimization problem:\n\nMaximize $\\lambda$\nSubject to:\n1. Equilibrium: $\\mathbf{B}_{\\mathcal{F}}\\mathbf{N} + \\lambda \\mathbf{p}_{0,\\mathcal{F}} = \\mathbf{0}$\n2. Yield Conditions: $|N_i| \\le N_{y,i}$ for $i=1, \\dots, m$\n3. Non-negativity: $\\lambda \\ge 0$\n\nThis is a Linear Programming (LP) problem. The decision variables are the member forces $N_1, \\dots, N_m$ and the load factor $\\lambda$. To use a standard LP solver, we reformat the problem. Most standard solvers are designed to minimize a linear objective function. Maximizing $\\lambda$ is equivalent to minimizing $-\\lambda$.\n\nThe decision variable vector is $\\mathbf{x} = [N_1, \\dots, N_m, \\lambda]^\\top$.\n\nThe objective function is to minimize $\\mathbf{c}^\\top \\mathbf{x}$, where $\\mathbf{c} = [0, \\dots, 0, -1]^\\top$.\n\nThe constraints are as follows:\n- **Equality Constraints**: The equilibrium equation can be rewritten as a homogeneous system of linear equations:\n$$ \\mathbf{B}_{\\mathcal{F}}\\mathbf{N} + \\lambda \\mathbf{p}_{0,\\mathcal{F}} = \\mathbf{0} \\implies [\\mathbf{B}_{\\mathcal{F}} \\quad \\mathbf{p}_{0,\\mathcal{F}}] \\begin{bmatrix} \\mathbf{N} \\\\ \\lambda \\end{bmatrix} = \\mathbf{0} $$\nThis takes the standard form $\\mathbf{A}_{eq} \\mathbf{x} = \\mathbf{b}_{eq}$, where $\\mathbf{A}_{eq} = [\\mathbf{B}_{\\mathcal{F}} \\quad \\mathbf{p}_{0,\\mathcal{F}}]$ and $\\mathbf{b}_{eq}$ is a zero vector of size equal to the number of free DOFs.\n\n- **Bound Constraints**: The yield conditions $|N_i| \\le N_{y,i}$ are equivalent to box constraints: $-N_{y,i} \\le N_i \\le N_{y,i}$. The non-negativity of the load factor provides a one-sided bound: $\\lambda \\ge 0$. These are specified as bounds on the decision variables:\n    - For $x_i = N_i$: bounds are $[-N_{y,i}, N_{y,i}]$.\n    - For $x_{m+1} = \\lambda$: bounds are $[0, \\infty)$.\n\nThe solution procedure is implemented algorithmically:\n1.  **Construct Equilibrium Matrix $\\mathbf{B}$**: For a truss with $n$ nodes and $m$ members, $\\mathbf{B}$ is a $2n \\times m$ matrix. For each member $i$ connecting node $a$ to node $b$, we calculate its direction vector $\\mathbf{t}_i = (c_i, s_i)$. The $i$-th column of $\\mathbf{B}$ has entries corresponding to the force contributions of member $i$ on the nodes. Following the problem statement, the force contribution on node $a$ is $N_i \\mathbf{t}_i$ and on node $b$ is $-N_i\\mathbf{t}_i$. Thus, the rows $2a$ and $2a+1$ of column $i$ are $c_i$ and $s_i$ respectively, and rows $2b$ and $2b+1$ are $-c_i$ and $-s_i$. All other entries in column $i$ are zero.\n\n2.  **Identify Free Degrees of Freedom**: We construct a boolean mask for all $2n$ DOFs. Initially, all are marked as free. We then iterate through the given support conditions, marking the corresponding DOFs as restrained (not free). The set of indices of free DOFs is $\\mathcal{F}$.\n\n3.  **Formulate LP**: Using the indices in $\\mathcal{F}$, we extract the submatrix $\\mathbf{B}_{\\mathcal{F}}$ from $\\mathbf{B}$ and the subvector $\\mathbf{p}_{0,\\mathcal{F}}$ from $\\mathbf{p}_0$. We then construct the objective vector $\\mathbf{c}$, the equality constraint matrix $\\mathbf{A}_{eq}$ and vector $\\mathbf{b}_{eq}$, and the list of bounds for each variable.\n\n4.  **Solve LP**: A numerical solver, such as `scipy.optimize.linprog`, is used to solve the formulated LP. The solver returns the optimal values for the decision variables in vector $\\mathbf{x}^\\star = [N_1^\\star, \\dots, N_m^\\star, \\lambda^\\star]^\\top$. The desired result is the last element, $\\lambda^\\star$.\n\nThis procedure is applied to each of the four test cases provided.\n- **Case 1**: A symmetric V-truss, representing a standard determinate structure. The load is applied vertically at the central, free node. The two diagonal members will go into compression equally, and the collapse is governed by their symmetric capacity.\n- **Case 2**: A single vertical member subjected to a horizontal load. This structure forms a mechanism under the applied load, as it has no capacity to resist horizontal forces. The expected collapse load factor is $\\lambda^\\star = 0$.\n- **Case 3**: The same symmetric V-truss as Case 1, but with asymmetric member capacities. The collapse will be governed by the weaker of the two members, leading to a lower collapse load compared to Case 1.\n- **Case 4**: A statically indeterminate triangular truss. The vertical load is applied at the apex. The equilibrium at the loaded node only involves the two diagonal members. Because the problem formulation only enforces equilibrium at free DOFs, the force in the horizontal bottom member is not constrained by these equations. The LP solver will find a statically admissible force distribution that maximizes $\\lambda$. In this case, the solution will put zero force in the redundant bottom member and max out the compression capacity of the diagonals, as this is the most efficient way to carry the load.\n\nThe results from the numerical implementation for each case are calculated and presented in the required format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the four truss limit analysis problems specified in the problem statement.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [100.0, 100.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        },\n        {\n            \"nodes\": [(0, 0), (0, 1)],\n            \"members\": [(0, 1)],\n            \"supports\": {0: ('u_x', 'u_y')},\n            \"capacities\": [100.0],\n            \"p0\": [0, 0, 1.0, 0],\n        },\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [80.0, 200.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        },\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1), (0, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [200.0, 200.0, 100.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_star = solve_truss_instance(case)\n        results.append(f\"{lambda_star:.6f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_truss_instance(data):\n    \"\"\"\n    Solves a single truss limit analysis instance.\n\n    Args:\n        data (dict): A dictionary containing the truss definition.\n\n    Returns:\n        float: The optimal load factor lambda_star.\n    \"\"\"\n    nodes = data[\"nodes\"]\n    members = data[\"members\"]\n    supports = data[\"supports\"]\n    capacities = data[\"capacities\"]\n    p0 = data[\"p0\"]\n\n    n = len(nodes)\n    m = len(members)\n    num_dofs = 2 * n\n\n    # Step 1: Build the equilibrium matrix B\n    B = np.zeros((num_dofs, m))\n    for i, member in enumerate(members):\n        a, b = member\n        node_a_coords = np.array(nodes[a])\n        node_b_coords = np.array(nodes[b])\n\n        delta = node_b_coords - node_a_coords\n        L = np.linalg.norm(delta)\n        \n        if L > 1e-9:\n            t = delta / L\n        else:\n            t = np.zeros(2)\n\n        # As per problem: +t_i for node a, -t_i for node b\n        B[2 * a : 2 * a + 2, i] = t\n        B[2 * b : 2 * b + 2, i] = -t\n\n    # Step 2: Identify free degrees of freedom\n    dof_is_free = np.ones(num_dofs, dtype=bool)\n    for node_idx, restrained_dofs in supports.items():\n        if 'u_x' in restrained_dofs:\n            dof_is_free[2 * node_idx] = False\n        if 'u_y' in restrained_dofs:\n            dof_is_free[2 * node_idx + 1] = False\n    \n    free_dof_indices = np.where(dof_is_free)[0]\n\n    if free_dof_indices.size == 0:\n        # No free DOFs means the structure is fully restrained.\n        # Problem assumes load is applied to free DOFs. Load cannot be applied.\n        return 0.0\n\n    # Step 3: Extract submatrix B_F and subvector p0_F\n    B_F = B[free_dof_indices, :]\n    p0_F = np.array(p0)[free_dof_indices]\n\n    # Step 4: Set up the Linear Programming problem\n    # Variables are [N_1, ..., N_m, lambda]\n    num_vars = m + 1\n\n    # Objective: maximize lambda, which is equivalent to minimize -lambda\n    c = np.zeros(num_vars)\n    c[-1] = -1\n\n    # Equality constraints: B_F * N + lambda * p0_F = 0\n    # Can be written as: [B_F | p0_F] * [N; lambda] = 0\n    A_eq = np.hstack([B_F, p0_F.reshape(-1, 1)])\n    b_eq = np.zeros(len(free_dof_indices))\n\n    # Bounds for variables: -N_y,i <= N_i <= N_y,i and lambda >= 0\n    bounds = [(-cap, cap) for cap in capacities]\n    bounds.append((0, None))  # for lambda\n\n    # Step 5: Solve the LP\n    # The 'highs' solver is robust and is the default in newer scipy versions.\n    res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if res.success:\n        # The optimal lambda is the last element of the solution vector\n        lambda_star = res.x[-1]\n    else:\n        # If the problem is infeasible or unbounded in an unexpected way,\n        # or if the only solution is trivial (e.g., for a mechanism),\n        # the lambda value is often zero.\n        lambda_star = 0.0\n\n    return lambda_star\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2655024"}]}