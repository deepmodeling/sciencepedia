{"hands_on_practices": [{"introduction": "The essence of the variational approach is to replace a sharp crack discontinuity with a continuous, regularized field known as the phase field. This first practice delves into the mathematical heart of this concept in a simplified one-dimensional setting. By applying the calculus of variations, you will analyze the stationary profile of the phase field and, most importantly, connect the abstract parameters of the model back to the cornerstone physical quantity in fracture mechanics: the critical energy release rate $G_c$ [@problem_id:2709354]. This exercise is fundamental for understanding how the regularized energy functional is calibrated to represent real material behavior.", "problem": "Consider a one-dimensional, out-of-plane unit-thickness setting for a variational phase-field description of brittle fracture. Let $d(x)$ denote an integrity-type phase-field variable with $d(x)\\in[0,1]$, where $d(x)=0$ denotes a fully developed crack and $d(x)\\to 1$ denotes intact material far from the crack. The fracture surface energy per unit out-of-plane thickness is modeled by\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\!\\left(d(x),d'(x)\\right)\\,\\mathrm{d}x,\n$$\nwith a simplified crack surface density\n$$\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\,\\bigg[\\,\\frac{1}{2\\,\\ell}\\,\\big(1-d\\big)^{2} \\;+\\; \\frac{\\ell}{2}\\,\\big(d'\\big)^{2}\\,\\bigg],\n$$\nwhere $G_{c}$ is the critical energy release rate, $\\ell0$ is the internal length, and $c_{0}0$ is a dimensionless normalization constant to be determined by calibration.\n\nAssume a stationary, even phase-field profile centered at $x=0$ that satisfies $d(0)=0$, $d(x)\\to 1$ as $|x|\\to\\infty$, and is given by\n$$\nd(x) \\;=\\; 1 - \\exp\\!\\big(-|x|/\\ell\\big).\n$$\n\nStarting from the calculus of variations for the above functional and using standard boundary conditions at infinity for an isolated crack, compute the fracture surface energy associated with this profile and determine the value of $c_{0}$ required so that $\\mathcal{E}_{\\Gamma}[d]=G_{c}$, i.e., the energy associated with a single, fully developed crack equals $G_{c}$. Provide your final answer as a single closed-form value for $c_{0}$. No rounding is required, and no physical units are to be reported for $c_{0}$.", "solution": "The starting point is the fracture surface energy functional\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x,\n\\quad\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell}\\,(1-d)^{2} + \\frac{\\ell}{2}\\,(d')^{2}\\right].\n$$\nA stationary profile $d(x)$ satisfies the Euler–Lagrange equation associated with the integrand\n$$\nf(d,d') \\;=\\; \\frac{1}{2\\,\\ell}\\,(1-d)^{2} + \\frac{\\ell}{2}\\,(d')^{2}.\n$$\nCompute the first variations:\n$$\n\\frac{\\partial f}{\\partial d} \\;=\\; \\frac{1}{2\\,\\ell}\\cdot 2(1-d)\\cdot(-1) \\;=\\; -\\,\\frac{1}{\\ell}\\,(1-d),\n\\qquad\n\\frac{\\partial f}{\\partial d'} \\;=\\; \\frac{\\ell}{2}\\cdot 2\\,d' \\;=\\; \\ell\\,d'.\n$$\nHence the Euler–Lagrange equation on any interval where $d$ is smooth is\n$$\n\\frac{\\partial f}{\\partial d} \\;-\\; \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(\\frac{\\partial f}{\\partial d'}\\right) \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\;\n-\\,\\frac{1}{\\ell}\\,(1-d) \\;-\\; \\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(\\ell\\,d'\\right) \\;=\\; 0,\n$$\nthat is,\n$$\n\\ell\\,d'' \\;+\\; \\frac{1}{\\ell}\\,(1-d) \\;=\\; 0\n\\;\\;\\Longleftrightarrow\\;\\;\nd'' \\;+\\; \\frac{1}{\\ell^{2}}\\,(1-d) \\;=\\; 0,\n$$\nto be imposed on $x0$ and $x0$ separately with symmetry about $x=0$ and boundary conditions $d(0)=0$ and $d(x)\\to 1$ as $|x|\\to\\infty$.\n\nOn $x0$, the ordinary differential equation is\n$$\nd'' \\;-\\; \\frac{1}{\\ell^{2}}\\,d \\;=\\; -\\,\\frac{1}{\\ell^{2}}.\n$$\nA particular solution is $d_{p}(x)=1$. The homogeneous solution is $d_{h}(x)=A\\,\\exp(x/\\ell)+B\\,\\exp(-x/\\ell)$. Boundedness as $x\\to +\\infty$ enforces $A=0$. Imposing $d(0)=0$ yields $0=1+B$, so $B=-1$. Thus, for $x0$,\n$$\nd(x) \\;=\\; 1 - \\exp(-x/\\ell).\n$$\nBy even symmetry about $x=0$, the full profile is\n$$\nd(x) \\;=\\; 1 - \\exp\\!\\big(-|x|/\\ell\\big),\n$$\nwhich matches the assumed stationary profile and is thus consistent with the Euler–Lagrange equation on $x\\neq 0$.\n\nNext, we evaluate the fracture surface energy integral. For the given $d(x)$, we have\n$$\n1 - d(x) \\;=\\; \\exp\\!\\big(-|x|/\\ell\\big),\n$$\n$$\nd'(x) \\;=\\; \n\\begin{cases}\n\\frac{1}{\\ell}\\,\\exp(-x/\\ell),  x>0, \\\\\n-\\frac{1}{\\ell}\\,\\exp(x/\\ell),  x0.\n\\end{cases}\n$$\nHence\n$$\n\\big(1-d(x)\\big)^{2} \\;=\\; \\exp\\!\\big(-2|x|/\\ell\\big),\n\\qquad\n\\big(d'(x)\\big)^{2} \\;=\\; \\frac{1}{\\ell^{2}}\\,\\exp\\!\\big(-2|x|/\\ell\\big).\n$$\nThe surface energy density becomes\n$$\n\\gamma_{\\ell}(d,d') \\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big) + \\frac{\\ell}{2}\\cdot \\frac{1}{\\ell^{2}}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\right]\n\\;=\\; \\frac{1}{c_{0}}\\left[\\frac{1}{2\\,\\ell} + \\frac{1}{2\\,\\ell}\\right]\\exp\\!\\big(-2|x|/\\ell\\big)\n\\;=\\; \\frac{1}{c_{0}}\\,\\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big).\n$$\nTherefore,\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x\n\\;=\\;\n\\frac{1}{c_{0}}\\,\\int_{-\\infty}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\,\\mathrm{d}x.\n$$\nThe integrand is even, so\n$$\n\\int_{-\\infty}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2|x|/\\ell\\big)\\,\\mathrm{d}x\n\\;=\\;\n2\\int_{0}^{\\infty} \\frac{1}{\\ell}\\,\\exp\\!\\big(-2x/\\ell\\big)\\,\\mathrm{d}x\n\\;=\\;\n2\\cdot \\frac{1}{\\ell}\\cdot \\left[\\,-\\frac{\\ell}{2}\\,\\exp\\!\\big(-2x/\\ell\\big)\\,\\right]_{0}^{\\infty}\n\\;=\\;\n2\\cdot \\frac{1}{\\ell}\\cdot \\frac{\\ell}{2}\n\\;=\\;\n1.\n$$\nIt follows that\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x \\;=\\; \\frac{1}{c_{0}}.\n$$\nThus the fracture surface energy for this stationary profile is\n$$\n\\mathcal{E}_{\\Gamma}[d] \\;=\\; G_{c}\\,\\frac{1}{c_{0}}.\n$$\nCalibrating to a single, fully developed crack requires $\\mathcal{E}_{\\Gamma}[d]=G_{c}$, which implies\n$$\nG_{c}\\,\\frac{1}{c_{0}} \\;=\\; G_{c}\n\\;\\;\\Longrightarrow\\;\\;\nc_{0} \\;=\\; 1.\n$$\nThis value of $c_{0}$ ensures that the fracture surface energy of the stationary profile equals $G_{c}$, independent of the internal length $\\ell$.", "answer": "$$\\boxed{1}$$", "id": "2709354"}, {"introduction": "A theoretical model is only as good as its numerical implementation. A crucial parameter in phase-field models is the intrinsic length scale, $\\ell$, which governs the width of the smeared crack representation. This practice addresses the critical question of how to set up a valid simulation: the computational mesh must be fine enough to accurately resolve this physical length scale. Using standard interpolation error theory, you will derive a quantitative criterion that links the required mesh size $h$ to the model parameter $\\ell$ and a desired accuracy tolerance, a foundational step for any reliable finite element or finite difference simulation of phase-field fracture [@problem_id:2709362].", "problem": "Consider the regularized variational formulation of brittle fracture based on the Ambrosio–Tortorelli approximation with quadratic crack density (often called the AT-2 model). In the absence of elastic coupling, the stationary damage field $d(x)$ minimizes the fracture regularization functional on the half-line $x \\ge 0$,\n$$\n\\Psi_{\\ell}[d] \\;=\\; \\int_{0}^{\\infty} \\left( \\frac{1}{2\\,\\ell}\\,w(d) \\;+\\; \\frac{\\ell}{2}\\,|d'(x)|^{2} \\right)\\,\\mathrm{d}x,\n$$\nwith $w(d) = d^{2}$, subject to the boundary conditions $d(0)=1$ (fully broken at the crack face) and $\\lim_{x\\to\\infty} d(x)=0$ (intact far from the crack). Here $\\ell0$ is the phase-field regularization length scale and $d\\in[0,1]$ is the scalar damage field.\n\na) Starting from the Euler–Lagrange equation for $\\Psi_{\\ell}[d]$, determine the stationary one-dimensional profile $d(x)$ consistent with the stated boundary conditions, and characterize its decay away from $x=0$.\n\nb) Suppose $d(x)$ is to be approximated near $x=0$ using continuous, piecewise-linear finite elements on a uniform mesh of size $h$ on $[0,h]$. Let $I_{h}[d](x)$ denote the linear interpolant of $d(x)$ through the nodal values at $x=0$ and $x=h$. Impose the accuracy requirement that the maximum pointwise absolute interpolation error over the first element satisfies\n$$\n\\max_{x\\in[0,h]} \\,|\\,d(x) - I_{h}[d](x)\\,| \\;\\le\\; \\varepsilon,\n$$\nfor a prescribed tolerance $\\varepsilon\\in(0,1)$. Using only the decay profile of $d$ obtained in part a) and standard interpolation error bounds for linear elements expressed in terms of the supremum of $|d''(x)|$ on $[0,h]$, derive a mesh-size criterion $h \\le h_{\\max}(\\ell,\\varepsilon)$.\n\nProvide your final result as a single closed-form analytic expression for $h_{\\max}(\\ell,\\varepsilon)$ in terms of $\\ell$ and $\\varepsilon$. If you were to evaluate it numerically, express the mesh size in meters in the International System of Units (SI). Do not substitute numbers; report the symbolic expression only in your final answer.", "solution": "The problem statement is first subjected to critical validation. The problem asks for the solution of a one-dimensional equilibrium problem from the phase-field theory of brittle fracture, specifically the Ambrosio-Tortorelli (AT-2) model, and a subsequent finite element interpolation error analysis. The functional $\\Psi_{\\ell}[d]$, the degradation function $w(d)$, the boundary conditions, and the use of the Euler-Lagrange equation are all standard and well-established components of this theory. The second part of the problem, concerning the derivation of a mesh-size criterion based on standard interpolation error bounds, is a routine procedure in numerical analysis for partial differential equations. The problem is scientifically grounded, well-posed, objective, and internally consistent. It contains all necessary information for a unique solution. Therefore, the problem is deemed valid and a rigorous solution is attainable.\n\nPart a): Determination of the stationary damage profile $d(x)$.\n\nThe stationary field $d(x)$ is one that minimizes the given functional $\\Psi_{\\ell}[d]$. According to the calculus of variations, such a field must satisfy the Euler-Lagrange equation corresponding to the Lagrangian (the integrand) of the functional. The Lagrangian $L(d, d')$ is\n$$\nL(d, d') \\;=\\; \\frac{1}{2\\ell} w(d) + \\frac{\\ell}{2} |d'(x)|^2.\n$$\nGiven $w(d) = d^2$, the Lagrangian becomes\n$$\nL(d, d') \\;=\\; \\frac{d^2}{2\\ell} + \\frac{\\ell}{2} (d')^2.\n$$\nThe Euler-Lagrange equation is given by\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( \\frac{\\partial L}{\\partial d'} \\right) = 0.\n$$\nFirst, we compute the required partial derivatives of $L$:\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{2d}{2\\ell} = \\frac{d}{\\ell}.\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\frac{\\ell}{2} (2d') = \\ell d'.\n$$\nSubstituting these expressions into the Euler-Lagrange equation, we obtain\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\ell d') = 0,\n$$\nwhich simplifies to a second-order linear ordinary differential equation with constant coefficients:\n$$\n\\ell d''(x) - \\frac{1}{\\ell} d(x) = 0 \\quad \\implies \\quad d''(x) - \\frac{1}{\\ell^2} d(x) = 0.\n$$\nThe characteristic equation for this ODE is $r^2 - 1/\\ell^2 = 0$, which has the real roots $r_{1,2} = \\pm 1/\\ell$. The general solution for $d(x)$ is therefore a linear combination of exponential functions:\n$$\nd(x) = C_1 \\exp\\left(\\frac{x}{\\ell}\\right) + C_2 \\exp\\left(-\\frac{x}{\\ell}\\right),\n$$\nwhere $C_1$ and $C_2$ are integration constants determined by the boundary conditions.\n\nThe boundary conditions are $d(0)=1$ and $\\lim_{x\\to\\infty} d(x)=0$.\nThe condition at infinity, $\\lim_{x\\to\\infty} d(x)=0$, must be satisfied. As $x \\to \\infty$, the term $\\exp(x/\\ell)$ grows unbounded. To ensure the limit is zero, its coefficient must be zero. Therefore, we must have $C_1=0$.\nThe solution simplifies to\n$$\nd(x) = C_2 \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\nNow we apply the boundary condition at $x=0$, which is $d(0)=1$:\n$$\nd(0) = C_2 \\exp\\left(-\\frac{0}{\\ell}\\right) = C_2 \\cdot 1 = 1 \\quad \\implies \\quad C_2=1.\n$$\nThus, the stationary one-dimensional profile for the damage field is\n$$\nd(x) = \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\nThis solution represents an exponential decay of the damage field away from the fully broken state at $x=0$, with a characteristic length scale determined by the regularization parameter $\\ell$.\n\nPart b): Derivation of the mesh-size criterion $h \\le h_{\\max}(\\ell,\\varepsilon)$.\n\nWe must derive a condition on the mesh size $h$ for the first element $[0,h]$ to ensure that the maximum pointwise interpolation error does not exceed a tolerance $\\varepsilon \\in (0,1)$. The accuracy requirement is\n$$\n\\max_{x\\in[0,h]} | d(x) - I_{h}[d](x) | \\le \\varepsilon,\n$$\nwhere $I_{h}[d](x)$ is the linear interpolant of $d(x)$ over $[0,h]$.\n\nThe problem specifies using the standard interpolation error bound for linear elements, which is\n$$\n\\max_{x\\in[a,b]} |f(x) - I_h[f](x)| \\le \\frac{(b-a)^2}{8} \\sup_{z\\in[a,b]} |f''(z)|.\n$$\nFor our case, the function is $d(x)$, the interval is $[0,h]$, so $a=0$ and $b=h$. The bound becomes\n$$\n\\max_{x\\in[0,h]} |d(x) - I_{h}[d](x)| \\le \\frac{h^2}{8} \\sup_{z\\in[0,h]} |d''(z)|.\n$$\nWe need to compute the second derivative of $d(x) = \\exp(-x/\\ell)$.\nThe first derivative is\n$$\nd'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(\\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = -\\frac{1}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\nThe second derivative is\n$$\nd''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left(-\\frac{1}{\\ell} \\exp\\left(-\\frac{x}{\\ell}\\right)\\right) = \\left(-\\frac{1}{\\ell}\\right)^2 \\exp\\left(-\\frac{x}{\\ell}\\right) = \\frac{1}{\\ell^2} \\exp\\left(-\\frac{x}{\\ell}\\right).\n$$\nNext, we determine the supremum of $|d''(x)|$ on the interval $[0,h]$. Since $\\ell  0$, the function $d''(x) = \\frac{1}{\\ell^2} \\exp(-x/\\ell)$ is positive and monotonically decreasing for $x \\ge 0$. Its maximum value on the interval $[0,h]$ is attained at $x=0$.\n$$\n\\sup_{z\\in[0,h]} |d''(z)| = d''(0) = \\frac{1}{\\ell^2} \\exp(0) = \\frac{1}{\\ell^2}.\n$$\nSubstituting this maximum value into the error bound expression, we obtain\n$$\n\\max_{x\\in[0,h]} |d(x) - I_{h}[d](x)| \\le \\frac{h^2}{8} \\left( \\frac{1}{\\ell^2} \\right) = \\frac{h^2}{8\\ell^2}.\n$$\nTo satisfy the prescribed accuracy requirement, we enforce the condition\n$$\n\\frac{h^2}{8\\ell^2} \\le \\varepsilon.\n$$\nWe can now solve for the mesh size $h$. Rearranging the inequality gives\n$$\nh^2 \\le 8 \\ell^2 \\varepsilon.\n$$\nSince $h$ must be a positive length, we take the positive square root of both sides:\n$$\nh \\le \\sqrt{8 \\ell^2 \\varepsilon} = \\ell \\sqrt{8\\varepsilon}.\n$$\nSimplifying the radical term, $\\sqrt{8} = \\sqrt{4 \\cdot 2} = 2\\sqrt{2}$. The condition on $h$ becomes\n$$\nh \\le 2\\ell\\sqrt{2\\varepsilon}.\n$$\nThis inequality is the requested mesh-size criterion. The maximum allowed mesh size, $h_{\\max}$, corresponds to the upper bound of this relation.\n$$\nh_{\\max}(\\ell, \\varepsilon) = 2\\ell\\sqrt{2\\varepsilon}.\n$$\nThis is the final symbolic expression. Regarding the note on units, if $\\ell$ is expressed in meters (m), then $h_{\\max}$ will also be in meters, as $\\varepsilon$ is a dimensionless quantity.", "answer": "$$\n\\boxed{2\\ell\\sqrt{2\\varepsilon}}\n$$", "id": "2709362"}, {"introduction": "Solving the coupled system of equations for mechanical deformation and phase-field evolution is the central task in simulating fracture. This final practice guides you through the implementation of a complete, albeit simple, solver based on the powerful alternate minimization (AM) scheme. By treating the problem as a block coordinate descent on the total energy functional, you will iteratively solve for the displacement and phase fields and observe how the system's total energy monotonically decreases towards a stable equilibrium [@problem_id:2709351]. This hands-on exercise not only provides a blueprint for a working solver but also demonstrates how the underlying energy principles can be directly leveraged to construct a robust and physically meaningful convergence criterion.", "problem": "Consider a one-dimensional, nondimensionalized elastic bar on the interval $[0,L]$ with a scalar displacement field $u(x)$ and a scalar phase-field fracture variable $d(x)$, where $d(x)$ approximates damage with $d(x)=0$ denoting intact material and $d(x)=1$ denoting fully broken material. The variational approach to fracture seeks minimizers of the total energy with respect to both $u$ and $d$. In this problem, you will implement an alternate minimization scheme to numerically demonstrate, in principle, that the total energy is nonincreasing over the iterations, and you will use the monotonic decrease in the total energy as a convergence criterion to stop the iterations.\n\nFundamental base and model:\n- The principle of minimum potential energy states that, for fixed boundary conditions, the physically realized fields minimize the total energy. We use a standard phase-field regularization of brittle fracture in one dimension. The nondimensionalized total energy functional is\n$$\n\\mathcal{E}(u,d) \\;=\\; \\int_0^L \\left[ g(d)\\,\\frac{E}{2}\\,\\left(u'(x)\\right)^2 \\;+\\; G_c\\left(\\frac{d(x)^2}{4\\ell} \\;+\\; \\ell\\,\\left(d'(x)\\right)^2\\right) \\right]\\,\\mathrm{d}x,\n$$\nwhere $E$ is a dimensionless elastic modulus, $G_c$ is a nondimensionalized critical energy release rate, $\\ell$ is a nondimensionalized internal length scale, and $g(d)$ is a degradation function. Let $g(d) = (1-d)^2 + \\kappa$, with $\\kappa0$ a small residual stiffness parameter to maintain ellipticity. The bar is subject to Dirichlet displacement boundary conditions $u(0)=0$ and $u(L)=\\bar{U}$.\n\nDiscretization and numerical scheme:\n- Discretize the interval $[0,L]$ using $N$ nodes with uniform spacing $h = L/(N-1)$.\n- Use second-order finite differences (edge-based central differences) for gradients. Denote by $\\Delta u_i = u_{i+1}-u_i$ and $\\Delta d_i = d_{i+1}-d_i$ on edges between nodes $i$ and $i+1$.\n- Discrete energy approximation:\n  - The elastic energy is approximated by\n    $$\n    \\mathcal{E}_{\\text{el}}(u,d) \\approx \\sum_{i=0}^{N-2} \\frac{1}{2}\\,\\frac{E\\,g_{i+\\frac{1}{2}}}{h}\\,\\left(\\Delta u_i\\right)^2,\n    $$\n    with $g_{i+\\frac{1}{2}} = \\frac{1}{2}(g(d_i)+g(d_{i+1}))$.\n  - The fracture surface energy is approximated by\n    $$\n    \\mathcal{E}_{\\text{frac}}(d) \\approx \\sum_{i=0}^{N-1} G_c\\,\\frac{d_i^2}{4\\ell}\\,h \\;+\\; \\sum_{i=0}^{N-2} G_c\\,\\ell\\,\\frac{\\left(\\Delta d_i\\right)^2}{h}.\n    $$\n  - The total energy is $\\mathcal{E}(u,d) \\approx \\mathcal{E}_{\\text{el}}(u,d) + \\mathcal{E}_{\\text{frac}}(d)$.\n- Alternate minimization (also called block coordinate descent):\n  - With $d$ fixed, minimize $\\mathcal{E}(u,d)$ over $u$ subject to $u(0)=0$ and $u(L)=\\bar{U}$. This yields a linear system with a symmetric positive definite (SPD) stiffness matrix because $g(d)\\ge \\kappa0$.\n  - With $u$ fixed, minimize $\\mathcal{E}(u,d)$ over $d$ without additional constraints. The Euler–Lagrange equation discretizes to an SPD linear system of the form $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$ with\n    $$\n    \\mathbf{A}_d \\;=\\; \\underbrace{\\mathbf{K}_{\\text{grad}}}_{\\text{from } \\ell(d')^2} \\;+\\; \\underbrace{\\operatorname{diag}\\!\\big(2\\,\\psi_i\\,h\\big)}_{\\text{from } g'(d)\\psi}\\;+\\; \\underbrace{\\operatorname{diag}\\!\\left(\\frac{G_c}{2\\ell}\\,h\\right)}_{\\text{from } d^2/(4\\ell)},\n    $$\n    where $\\psi_i$ is a nodal approximation of the elastic energy density $\\psi(u)=\\frac{E}{2}(u')^2$, and $\\mathbf{b}_d$ has components $(\\mathbf{b}_d)_i = 2\\,\\psi_i\\,h$.\n  - We do not enforce irreversibility or bound constraints in this demonstration so that each subproblem is an unconstrained convex minimization, ensuring the energy is nonincreasing at each substep in exact arithmetic.\n- Energy density nodal approximation: compute edge strains $\\varepsilon_{i+\\frac{1}{2}}=\\Delta u_i/h$ and edge elastic energies $\\psi_{i+\\frac{1}{2}}=\\frac{E}{2}\\varepsilon_{i+\\frac{1}{2}}^2$, then set $\\psi_0=\\psi_{\\frac{1}{2}}$, $\\psi_{N-1}=\\psi_{N-\\frac{3}{2}}$, and for interior nodes $i$ use $\\psi_i=\\frac{1}{2}(\\psi_{i-\\frac{1}{2}}+\\psi_{i+\\frac{1}{2}})$.\n\nTasks:\n1. Implement the described alternate minimization algorithm. Initialize with $d^{(0)}_i=0$ for all nodes $i$. In each iteration $k$:\n   - Solve for $u^{(k+1)}$ with $d^{(k)}$ fixed.\n   - Compute and record the total energy $\\mathcal{E}(u^{(k+1)},d^{(k)})$.\n   - Solve for $d^{(k+1)}$ with $u^{(k+1)}$ fixed.\n   - Compute and record the total energy $\\mathcal{E}(u^{(k+1)},d^{(k+1)})$.\n2. Demonstrate numerically that the total energy sequence over substeps is nonincreasing, up to floating-point tolerance. Use a mixed tolerance criterion: given energies $\\{E_j\\}_{j\\ge 0}$ recorded after every substep, check $E_{j+1}\\le E_j + \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}}\\,E_j$ with $\\varepsilon_{\\text{abs}}=10^{-14}$ and $\\varepsilon_{\\text{rel}}=10^{-12}$.\n3. Use the total energy decrease as a convergence criterion. After each full alternate-minimization cycle (i.e., after updating both $u$ and $d$), compute the relative decrease\n   $$\n   r_k \\;=\\; \\frac{\\mathcal{E}\\big(u^{(k)},d^{(k)}\\big) - \\mathcal{E}\\big(u^{(k+1)},d^{(k+1)}\\big)}{\\max\\!\\left(\\mathcal{E}\\big(u^{(k)},d^{(k)}\\big),\\,10^{-16}\\right)}.\n   $$\n   Stop when $r_k  \\text{tol}$ or a maximum number of iterations is reached.\n\nTest suite:\n- For each test case, all quantities are nondimensional, so no physical units are required. Use the following parameter sets:\n  - Case A (general case): $L=1.0$, $N=101$, $E=1.0$, $G_c=0.01$, $\\ell=0.02$, $\\kappa=10^{-6}$, $\\bar{U}=0.2$, $\\text{tol}=10^{-10}$, $\\text{max\\_iter}=200$.\n  - Case B (near-elastic, tiny load): $L=1.0$, $N=51$, $E=1.0$, $G_c=0.01$, $\\ell=0.02$, $\\kappa=10^{-6}$, $\\bar{U}=10^{-4}$, $\\text{tol}=10^{-12}$, $\\text{max\\_iter}=200$.\n  - Case C (more compliant fracture): $L=1.0$, $N=101$, $E=1.0$, $G_c=0.005$, $\\ell=0.05$, $\\kappa=10^{-6}$, $\\bar{U}=0.2$, $\\text{tol}=10^{-10}$, $\\text{max\\_iter}=200$.\n\nProgram requirements:\n- Your program must compute, for each case, the following outputs:\n  - A boolean indicating whether the recorded total energies are nonincreasing over all substeps within the run, using the mixed tolerance test specified above.\n  - The number of full alternate-minimization iterations performed until convergence or until the maximum number of iterations is reached.\n  - The final total energy value rounded to eight decimal places.\n- Final output format: Your program should produce a single line of output containing a flat, comma-separated list enclosed in square brackets. The list must concatenate, in order, the triple for each case. Specifically, output\n  $$\n  [\\text{mono\\_A},\\text{iter\\_A},\\text{energy\\_A},\\text{mono\\_B},\\text{iter\\_B},\\text{energy\\_B},\\text{mono\\_C},\\text{iter\\_C},\\text{energy\\_C}],\n  $$\n  where each $\\text{mono\\_*}$ is either $\\text{True}$ or $\\text{False}$, each $\\text{iter\\_*}$ is an integer, and each $\\text{energy\\_*}$ is a float rounded to eight decimal places.", "solution": "The problem statement presents a well-defined task in computational solid mechanics. It is scientifically grounded in the variational theory of fracture using a standard phase-field model. All parameters, equations, boundary conditions, and numerical procedures are specified with sufficient clarity and are internally consistent. The problem does not violate any principles of physics or mathematics; it is objective and formalizable. Therefore, the problem is deemed valid and a solution will be provided.\n\nThe objective is to implement an alternate minimization scheme for a one-dimensional phase-field fracture problem. This scheme iteratively solves for the displacement field $u(x)$ and the phase field $d(x)$ to find a minimizer of a total energy functional $\\mathcal{E}(u,d)$. The primary tasks are to demonstrate numerically that the total energy is non-increasing across the minimization substeps and to use this energy decrease as a convergence criterion.\n\nThe solution is constructed by discretizing the problem domain and the governing energy functional, then solving the resulting subproblems for $u$ and $d$ in an alternating sequence.\n\n**1. Discretization and State Variables**\n\nThe one-dimensional domain $[0,L]$ is discretized into $N$ nodes, indexed $i=0, 1, \\dots, N-1$. The uniform spacing between nodes is $h = L/(N-1)$. The displacement and phase fields are represented by nodal value vectors $\\mathbf{u} = [u_0, u_1, \\dots, u_{N-1}]^T$ and $\\mathbf{d} = [d_0, d_1, \\dots, d_{N-1}]^T$.\n\n**2. Total Energy Functional**\n\nThe total energy $\\mathcal{E}(u,d)$ is the sum of the elastic energy $\\mathcal{E}_{\\text{el}}(u,d)$ and the fracture energy $\\mathcal{E}_{\\text{frac}}(d)$. Following the provided discretization:\n\nThe elastic energy is:\n$$\n\\mathcal{E}_{\\text{el}}(\\mathbf{u},\\mathbf{d}) = \\sum_{i=0}^{N-2} \\frac{E}{2h} g_{i+\\frac{1}{2}} (u_{i+1}-u_i)^2\n$$\nwhere $g(d) = (1-d)^2+\\kappa$ and the edge-centered degradation value is $g_{i+\\frac{1}{2}} = \\frac{1}{2}(g(d_i) + g(d_{i+1}))$.\n\nThe fracture energy is:\n$$\n\\mathcal{E}_{\\text{frac}}(\\mathbf{d}) = \\sum_{i=0}^{N-1} G_c \\frac{d_i^2}{4\\ell} h + \\sum_{i=0}^{N-2} G_c \\ell \\frac{(d_{i+1}-d_i)^2}{h}\n$$\n\n**3. Alternate Minimization Subproblems**\n\nThe core of the algorithm is the alternate minimization loop. At each iteration $k$, we first solve for $\\mathbf{u}^{(k+1)}$ while keeping $\\mathbf{d}^{(k)}$ fixed, then solve for $\\mathbf{d}^{(k+1)}$ while keeping $\\mathbf{u}^{(k+1)}$ fixed.\n\n**3.1. Minimization with respect to Displacement $u$**\n\nFor a fixed phase field $\\mathbf{d}$, we minimize $\\mathcal{E}(\\mathbf{u},\\mathbf{d})$ with respect to $\\mathbf{u}$, subject to the boundary conditions $u_0=0$ and $u_{N-1}=\\bar{U}$. This is equivalent to solving $\\frac{\\partial \\mathcal{E}_{\\text{el}}}{\\partial u_i} = 0$ for the interior nodes $i=1, \\dots, N-2$. The derivative for an interior node $u_i$ is:\n$$\n\\frac{\\partial \\mathcal{E}_{\\text{el}}}{\\partial u_i} = \\frac{\\partial}{\\partial u_i} \\left[ \\frac{E}{2h}g_{i-\\frac{1}{2}}(u_i-u_{i-1})^2 + \\frac{E}{2h}g_{i+\\frac{1}{2}}(u_{i+1}-u_i)^2 \\right] = 0\n$$\nThis yields a system of linear equations:\n$$\n\\frac{E}{h}g_{i-\\frac{1}{2}}(u_i-u_{i-1}) - \\frac{E}{h}g_{i+\\frac{1}{2}}(u_{i+1}-u_i) = 0\n$$\nRearranging for $i=1, \\dots, N-2$:\n$$\n-\\left(\\frac{E}{h}g_{i-\\frac{1}{2}}\\right)u_{i-1} + \\left(\\frac{E}{h}g_{i-\\frac{1}{2}} + \\frac{E}{h}g_{i+\\frac{1}{2}}\\right)u_i - \\left(\\frac{E}{h}g_{i+\\frac{1}{2}}\\right)u_{i+1} = 0\n$$\nThis defines a linear system $\\mathbf{K}_u \\mathbf{u}_{\\text{int}} = \\mathbf{f}_u$ for the unknown interior displacements $\\mathbf{u}_{\\text{int}} = [u_1, \\dots, u_{N-2}]^T$. The stiffness matrix $\\mathbf{K}_u$ is an $(N-2) \\times (N-2)$ symmetric tridiagonal matrix.\nThe diagonal entries are $(\\mathbf{K}_u)_{j,j} = \\frac{E}{h}(g_{j-\\frac{1}{2}} + g_{j+\\frac{1}{2}})$ for $j=1, \\dots, N-2$ (using local matrix indices).\nThe off-diagonal entries are $(\\mathbf{K}_u)_{j,j+1} = (\\mathbf{K}_u)_{j+1,j} = -\\frac{E}{h}g_{j+\\frac{1}{2}}$.\nThe boundary conditions $u_0=0$ and $u_{N-1}=\\bar{U}$ modify the equations for $i=1$ and $i=N-2$, respectively. For $i=1$, the $u_0$ term is zero. For $i=N-2$, the term $-\\frac{E}{h}g_{N-\\frac{3}{2}}u_{N-1}$ becomes a known value moved to the right-hand side, so the last component of the force vector $\\mathbf{f}_u$ is $f_{N-2} = \\frac{E}{h}g_{N-\\frac{3}{2}}\\bar{U}$. All other components of $\\mathbf{f}_u$ are zero. Since $g(d) \\ge \\kappa  0$, the matrix $\\mathbf{K}_u$ is symmetric and positive definite (SPD), guaranteeing a unique solution.\n\n**3.2. Minimization with respect to Phase Field $d$**\n\nFor a fixed displacement field $\\mathbf{u}$, we minimize $\\mathcal{E}(\\mathbf{u},\\mathbf{d})$ with respect to $\\mathbf{d}$. The problem statement provides the form of the resulting linear system $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$. This system is derived from setting $\\frac{\\partial \\mathcal{E}}{\\partial d_i} = 0$ for all nodes $i=0, \\dots, N-1$. The energy is approximated quadratically around the elastic driving force, leading to the specified system.\n\nFirst, we compute the nodal elastic energy density $\\psi_i$. The edge strains $\\varepsilon_{i+\\frac{1}{2}} = (u_{i+1}-u_i)/h$ and edge energy densities $\\psi_{i+\\frac{1}{2}} = \\frac{E}{2}\\varepsilon_{i+\\frac{1}{2}}^2$ are calculated. Then, nodal values are assigned as specified:\n$$\n\\psi_0 = \\psi_{\\frac{1}{2}}, \\quad \\psi_{N-1} = \\psi_{N-\\frac{3}{2}}, \\quad \\psi_i = \\frac{1}{2}(\\psi_{i-\\frac{1}{2}} + \\psi_{i+\\frac{1}{2}}) \\text{ for } i=1, \\dots, N-2.\n$$\nThe linear system is $\\mathbf{A}_d \\mathbf{d} = \\mathbf{b}_d$, where the $N \\times N$ matrix $\\mathbf{A}_d$ and $N$-vector $\\mathbf{b}_d$ are constructed as follows. The vector $\\mathbf{b}_d$ has components $(\\mathbf{b}_d)_i = 2\\psi_i h$. The symmetric, tridiagonal matrix $\\mathbf{A}_d$ is the sum of three contributions:\n1.  From the gradient term $\\ell(d')^2$: This yields a discrete Laplacian operator. The contribution to the matrix is $\\frac{2G_c \\ell}{h}$ on the diagonal at indices $i=0$ and $i=N-1$, $\\frac{4G_c \\ell}{h}$ on the diagonal for interior indices $i=1, \\dots, N-2$, and $-\\frac{2G_c \\ell}{h}$ on the sub- and super-diagonals.\n2.  From strain energy dependence $g''(d)\\psi$: The second derivative of $g(d)$ is $g''(d) = 2$. This adds $2\\psi_i h$ to the diagonal entry $(\\mathbf{A}_d)_{i,i}$.\n3.  From the surface term $d^2/(4\\ell)$: This adds $\\frac{G_c h}{2\\ell}$ to the diagonal entry $(\\mathbf{A}_d)_{i,i}$.\n\nCombining these, the system matrix $\\mathbf{A}_d$ is SPD, and the system can be solved efficiently for $\\mathbf{d}$.\n\n**4. Algorithm and Convergence**\n\nThe overall algorithm is as follows:\n1.  **Initialization**: Set iteration counter $k=0$. Initialize the phase field $\\mathbf{d}^{(0)}$ to a zero vector. Compute the corresponding linear elastic displacement field $\\mathbf{u}^{(0)}$ with components $u_i^{(0)} = \\bar{U} \\cdot i / (N-1)$. Compute the initial total energy $E_{\\text{prev}} = \\mathcal{E}(\\mathbf{u}^{(0)}, \\mathbf{d}^{(0)})$.\n2.  **Iteration Loop**: For $k=0, 1, \\dots, \\text{max_iter}-1$:\n    a. Solve for $\\mathbf{u}^{(k+1)}$ using $\\mathbf{d}^{(k)}$.\n    b. Record the energy $\\mathcal{E}(\\mathbf{u}^{(k+1)}, \\mathbf{d}^{(k)})$.\n    c. Solve for $\\mathbf{d}^{(k+1)}$ using $\\mathbf{u}^{(k+1)}$.\n    d. Compute the new total energy $E_{\\text{new}} = \\mathcal{E}(\\mathbf{u}^{(k+1)}, \\mathbf{d}^{(k+1)})$. Record this energy.\n    e. Check for convergence by calculating the relative energy decrease $r_k = (E_{\\text{prev}} - E_{\\text{new}})/\\max(E_{\\text{prev}}, 10^{-16})$. If $r_k  \\text{tol}$, terminate the loop.\n    f. Update for the next iteration: $E_{\\text{prev}} = E_{\\text{new}}$.\n3.  **Post-processing**: After the loop finishes, verify that the sequence of all recorded energies is non-increasing within the specified numerical tolerance: $E_{j+1} \\le E_j + \\varepsilon_{\\text{abs}} + \\varepsilon_{\\text{rel}} E_j$.\n4.  **Output**: Return the monotonicity check result, the total number of iterations performed, and the final converged energy.\n\nThis procedure constitutes a complete and robust method for solving the specified problem. The implementation follows these steps precisely.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A (general case)\n        (1.0, 101, 1.0, 0.01, 0.02, 1e-6, 0.2, 1e-10, 200),\n        # Case B (near-elastic, tiny load)\n        (1.0, 51, 1.0, 0.01, 0.02, 1e-6, 1e-4, 1e-12, 200),\n        # Case C (more compliant fracture)\n        (1.0, 101, 1.0, 0.005, 0.05, 1e-6, 0.2, 1e-10, 200),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        L, N, E, Gc, l, kappa, U_bar, tol, max_iter = params\n        is_monotonic, iters, final_energy = solve_case(L, N, E, Gc, l, kappa, U_bar, tol, max_iter)\n        all_results.extend([is_monotonic, iters, round(final_energy, 8)])\n\n    # Format and print the final output string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef solve_case(L, N, E, Gc, l, kappa, U_bar, tol, max_iter):\n    \"\"\"\n    Solves a single instance of the phase-field fracture problem.\n    \n    Returns:\n        tuple: (is_monotonic, iterations, final_energy)\n    \"\"\"\n    h = L / (N - 1)\n    x = np.linspace(0, L, N)\n    \n    # --- Helper Functions ---\n\n    def compute_total_energy(u, d):\n        # Elastic energy\n        g = (1 - d)**2 + kappa\n        g_mid = 0.5 * (g[:-1] + g[1:])\n        du = u[1:] - u[:-1]\n        el_energy = np.sum(0.5 * E * g_mid / h * du**2)\n        \n        # Fracture energy\n        frac_surf = np.sum(Gc * d**2 / (4 * l) * h)\n        dd = d[1:] - d[:-1]\n        frac_grad = np.sum(Gc * l * (dd**2) / h)\n        \n        return el_energy + frac_surf + frac_grad\n\n    def solve_for_u(d):\n        g = (1 - d)**2 + kappa\n        g_mid = 0.5 * (g[:-1] + g[1:])\n        k_stiff_edge = E * g_mid / h\n        \n        # System for interior nodes u_1, ..., u_{N-2}\n        num_internal_nodes = N - 2\n        diag = k_stiff_edge[:-1] + k_stiff_edge[1:]\n        off_diag = -k_stiff_edge[1:-1]\n        \n        Ku = np.zeros((3, num_internal_nodes))\n        Ku[0, 1:] = off_diag\n        Ku[1, :] = diag\n        Ku[2, :-1] = off_diag\n        \n        fu = np.zeros(num_internal_nodes)\n        fu[-1] = k_stiff_edge[-1] * U_bar\n        \n        u_internal = solve_banded((1, 1), Ku, fu)\n        \n        u = np.zeros(N)\n        u[1:-1] = u_internal\n        u[-1] = U_bar\n        return u\n\n    def solve_for_d(u):\n        # Calculate nodal elastic energy density psi\n        eps_edge = (u[1:] - u[:-1]) / h\n        psi_edge = 0.5 * E * eps_edge**2\n        \n        psi = np.zeros(N)\n        psi[0] = psi_edge[0]\n        psi[-1] = psi_edge[-1]\n        psi[1:-1] = 0.5 * (psi_edge[:-1] + psi_edge[1:])\n\n        # Assemble and solve Ad * d = bd\n        bd = 2 * psi * h\n\n        # Build Ad matrix (tridiagonal, N x N)\n        # K_grad part\n        diag_Ad = np.full(N, 4 * Gc * l / h)\n        diag_Ad[0] = 2 * Gc * l / h\n        diag_Ad[-1] = 2 * Gc * l / h\n        off_diag_Ad = np.full(N - 1, -2 * Gc * l / h)\n        \n        # Other diagonal contributions\n        diag_Ad += 2 * psi * h\n        diag_Ad += Gc * h / (2 * l)\n        \n        Ad_banded = np.zeros((3, N))\n        Ad_banded[0, 1:] = off_diag_Ad\n        Ad_banded[1, :] = diag_Ad\n        Ad_banded[2, :-1] = off_diag_Ad\n        \n        d_new = solve_banded((1, 1), Ad_banded, bd)\n        return d_new\n\n    # --- Alternate Minimization Loop ---\n    \n    # Initialization\n    d_k = np.zeros(N)\n    u_k = x * U_bar / L  # Linear elastic solution for d=0\n    \n    energy_k = compute_total_energy(u_k, d_k)\n    all_energies = [energy_k]\n    \n    iters_done = 0\n    for k in range(max_iter):\n        iters_done = k + 1\n        energy_prev_cycle = energy_k\n        \n        # Step 1: u-minimization\n        u_k_plus_1 = solve_for_u(d_k)\n        all_energies.append(compute_total_energy(u_k_plus_1, d_k))\n        \n        # Step 2: d-minimization\n        d_k_plus_1 = solve_for_d(u_k_plus_1)\n        energy_k = compute_total_energy(u_k_plus_1, d_k_plus_1)\n        all_energies.append(energy_k)\n        \n        # Update state for next iteration\n        u_k = u_k_plus_1\n        d_k = d_k_plus_1\n        \n        # Check for convergence\n        rel_decr = (energy_prev_cycle - energy_k) / max(energy_prev_cycle, 1e-16)\n        if rel_decr  tol:\n            break\n            \n    # --- Post-processing ---\n    \n    # Check for non-increasing energy property (monotonicity)\n    is_monotonic = True\n    eps_abs = 1e-14\n    eps_rel = 1e-12\n    for i in range(len(all_energies) - 1):\n        if all_energies[i+1] > all_energies[i] + eps_abs + eps_rel * all_energies[i]:\n            is_monotonic = False\n            break\n            \n    return is_monotonic, iters_done, energy_k\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2709351"}]}