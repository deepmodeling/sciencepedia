{"hands_on_practices": [{"introduction": "In the transition from infinitesimal to finite deformation theory, one of the most crucial conceptual hurdles is understanding why the displacement gradient, $\\nabla \\boldsymbol{u}$, is no longer a suitable measure of strain. This exercise provides a definitive clarification by analyzing a pure rigid-body rotation, a motion that by definition involves zero physical strain. You will demonstrate that while proper nonlinear strain measures like the Green-Lagrange tensor $\\boldsymbol{E}$ correctly yield zero, the displacement gradient can be arbitrarily large, confirming that it conflates genuine deformation with rotation [@problem_id:2639548].", "problem": "A three-dimensional elastic body undergoes a homogeneous rigid rotation about the fixed $z$-axis by an angle $\\theta = \\frac{2\\pi}{3}$ (radians). The motion is defined by $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$ with respect to a reference configuration, where\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\phantom{-}\\cos\\theta  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\nStarting only from the foundational definitions of the deformation gradient $\\boldsymbol{F}$, the Right Cauchy–Green tensor $\\boldsymbol{C}$, the Green–Lagrange strain tensor $\\boldsymbol{E}$, the left Cauchy–Green tensor $\\boldsymbol{b}$, and the Euler–Almansi strain tensor $\\boldsymbol{e}$, do the following:\n\n- Derive $\\boldsymbol{F}$ for this motion and use it to demonstrate that both $\\boldsymbol{E}$ and $\\boldsymbol{e}$ vanish everywhere in the body.\n- Define the displacement field $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$ and compute the material displacement gradient $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$.\n- Compute the Frobenius norm of the material displacement gradient, $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$, where $\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$ for any second-order tensor $\\boldsymbol{A}$.\n\nThis construction serves as a counterexample showing that large rigid body rotations can produce a large displacement gradient while leaving all strain tensors equal to zero. Report as your final answer the exact value of $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$ for $\\theta = \\frac{2\\pi}{3}$. No units are required. Express your answer in exact form; do not approximate or round.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted.\n- Motion: $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$\n- Rotation matrix:\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\phantom{-}\\cos\\theta  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n- Angle of rotation: $\\theta = \\frac{2\\pi}{3}$\n- Foundational definitions: Deformation gradient $\\boldsymbol{F}$, Right Cauchy–Green tensor $\\boldsymbol{C}$, Green–Lagrange strain tensor $\\boldsymbol{E}$, left Cauchy–Green tensor $\\boldsymbol{b}$, Euler–Almansi strain tensor $\\boldsymbol{e}$.\n- Displacement field: $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$\n- Material displacement gradient: $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$\n- Frobenius norm: $\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$\n\nValidation proceeds. The problem is a standard exercise in continuum mechanics, specifically in the topic of finite deformation kinematics. It is scientifically grounded, well-posed, objective, and internally consistent. It contains all necessary information for a unique solution. The problem serves to illustrate the important distinction between the displacement gradient, which can be large in a rigid rotation, and strain, which is zero for such a motion. The problem statement is therefore valid. We proceed to the solution.\n\nThe motion of the body is given by the mapping $\\boldsymbol{x} = \\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{R}\\boldsymbol{X}$, where $\\boldsymbol{X}$ is the position vector of a particle in the reference configuration and $\\boldsymbol{x}$ is its position in the current configuration. The matrix $\\boldsymbol{R}$ is constant for this homogeneous deformation.\n\nStep 1: Derive the deformation gradient $\\boldsymbol{F}$ and strain tensors $\\boldsymbol{E}$ and $\\boldsymbol{e}$.\nThe deformation gradient tensor $\\boldsymbol{F}$ is defined as the material gradient of the motion:\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\nabla_{\\! \\boldsymbol{X}} (\\boldsymbol{R}\\boldsymbol{X})\n$$\nSince $\\boldsymbol{R}$ is a constant matrix with respect to the material coordinates $\\boldsymbol{X}$, the derivative is simply:\n$$\n\\boldsymbol{F} = \\boldsymbol{R}\n$$\nThe Right Cauchy–Green tensor $\\boldsymbol{C}$ is defined as $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$. Substituting $\\boldsymbol{F} = \\boldsymbol{R}$:\n$$\n\\boldsymbol{C} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R}\n$$\nThe matrix $\\boldsymbol{R}$ represents a rotation, which is an orthogonal transformation. A property of any orthogonal tensor is that its transpose is its inverse, so $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor. Therefore:\n$$\n\\boldsymbol{C} = \\boldsymbol{I}\n$$\nThe Green–Lagrange strain tensor $\\boldsymbol{E}$ is defined as $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$. Using our result for $\\boldsymbol{C}$:\n$$\n\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\nwhere $\\boldsymbol{O}$ is the zero tensor.\n\nNext, we consider the spatial strain tensor. The left Cauchy–Green tensor $\\boldsymbol{b}$ is defined as $\\boldsymbol{b} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$. Substituting $\\boldsymbol{F} = \\boldsymbol{R}$:\n$$\n\\boldsymbol{b} = \\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}}\n$$\nAgain, from the orthogonality of $\\boldsymbol{R}$, we have $\\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{I}$. Thus:\n$$\n\\boldsymbol{b} = \\boldsymbol{I}\n$$\nThe Euler–Almansi strain tensor $\\boldsymbol{e}$ is defined as $\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{b}^{-1})$. Since $\\boldsymbol{b} = \\boldsymbol{I}$, its inverse is also the identity, $\\boldsymbol{b}^{-1} = \\boldsymbol{I}^{-1} = \\boldsymbol{I}$. Substituting this into the definition of $\\boldsymbol{e}$:\n$$\n\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\nBoth the Green–Lagrange and Euler–Almansi strain tensors are zero, which is the correct and expected result for a rigid body motion, as it induces no deformation or stretching.\n\nStep 2: Compute the material displacement gradient, $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$.\nThe displacement vector field $\\boldsymbol{u}$ is defined as $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$. Substituting the given motion $\\boldsymbol{x} = \\boldsymbol{R}\\boldsymbol{X}$:\n$$\n\\boldsymbol{u} = \\boldsymbol{R}\\boldsymbol{X} - \\boldsymbol{X} = (\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}\n$$\nThe material displacement gradient is the tensor $\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}$.\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} [(\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}]\n$$\nSince the tensor $(\\boldsymbol{R} - \\boldsymbol{I})$ is constant for a homogeneous motion:\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\boldsymbol{R} - \\boldsymbol{I}\n$$\nThis demonstrates that even with zero strain, the displacement gradient is non-zero.\n\nStep 3: Compute the Frobenius norm of the material displacement gradient, $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$.\nThe Frobenius norm is defined as $\\|\\boldsymbol{H}\\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H})}$. We first compute the product $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = (\\boldsymbol{R} - \\boldsymbol{I})^{\\mathsf{T}}(\\boldsymbol{R} - \\boldsymbol{I}) = (\\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{I})(\\boldsymbol{R} - \\boldsymbol{I})\n$$\nExpanding the product gives:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I}\n$$\nUsing the orthogonality property $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$:\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{I} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I} = 2\\boldsymbol{I} - (\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}})\n$$\nNow we take the trace of this expression. The trace is a linear operator:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = \\operatorname{tr}(2\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}}) = 2\\operatorname{tr}(\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R}) - \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})\n$$\nIn three dimensions, $\\operatorname{tr}(\\boldsymbol{I}) = 3$. Also, $\\operatorname{tr}(\\boldsymbol{R}) = \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})$. So:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 2(3) - 2\\operatorname{tr}(\\boldsymbol{R}) = 6 - 2\\operatorname{tr}(\\boldsymbol{R})\n$$\nThe trace of the given rotation matrix $\\boldsymbol{R}$ is:\n$$\n\\operatorname{tr}(\\boldsymbol{R}) = \\cos\\theta + \\cos\\theta + 1 = 2\\cos\\theta + 1\n$$\nSubstituting this into the expression for the trace of $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$:\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 6 - 2(2\\cos\\theta + 1) = 6 - 4\\cos\\theta - 2 = 4 - 4\\cos\\theta\n$$\nThe Frobenius norm is the square root:\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = \\sqrt{4 - 4\\cos\\theta} = 2\\sqrt{1 - \\cos\\theta}\n$$\nThe problem specifies the angle of rotation $\\theta = \\frac{2\\pi}{3}$. We must evaluate the expression for this value. The cosine of this angle is:\n$$\n\\cos\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2}\n$$\nSubstituting this value:\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = 2\\sqrt{1 - \\left(-\\frac{1}{2}\\right)} = 2\\sqrt{1 + \\frac{1}{2}} = 2\\sqrt{\\frac{3}{2}}\n$$\nTo simplify the expression:\n$$\n2\\sqrt{\\frac{3}{2}} = 2 \\frac{\\sqrt{3}}{\\sqrt{2}} = \\frac{2\\sqrt{3}\\sqrt{2}}{2} = \\sqrt{6}\n$$\nThe exact value of the Frobenius norm of the material displacement gradient is $\\sqrt{6}$. This large value, where the norm is greater than $1$, coupled with zero strain, correctly illustrates the counter-intuitive nature of finite rotation kinematics when analyzed with measures developed for infinitesimal deformations.", "answer": "$$\\boxed{\\sqrt{6}}$$", "id": "2639548"}, {"introduction": "Having established that new kinematic tools are needed for finite deformations, we now turn to the cornerstone of modern continuum mechanics: the polar decomposition. This powerful theorem states that any deformation can be multiplicatively decomposed into a pure stretch and a rigid rotation. This practice guides you through the explicit calculation of the polar decomposition for the fundamental case of simple shear, allowing you to build intuition for the right stretch tensor $\\boldsymbol{U}$ and the rotation tensor $\\boldsymbol{R}$ and contrast them with the familiar additive split from linear elasticity [@problem_id:2639541].", "problem": "A homogeneous body undergoes planar simple shear with deformation gradient expressed in an orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ by\n$$\n\\mathbf{F} \\;=\\; \\mathbf{I} \\;+\\; \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2},\n$$\nwhere $\\gamma \\in \\mathbb{R}$ is the shear amount. Work entirely within the framework of finite deformation kinematics. Starting only from core definitions, derive the right polar decomposition $\\mathbf{F}=\\mathbf{R}\\,\\mathbf{U}$, where $\\mathbf{R}$ is orthogonal with $\\mathbf{R}^{T}\\mathbf{R}=\\mathbf{I}$ and $\\det\\mathbf{R}=+1$, and $\\mathbf{U}$ is symmetric positive-definite (SPD). In particular:\n\n1. Using the definition of the right Cauchy–Green tensor $\\mathbf{C}=\\mathbf{F}^{T}\\mathbf{F}$ and the definition of the right stretch as the principal square root $\\mathbf{U}=\\mathbf{C}^{1/2}$, compute $\\mathbf{U}$ explicitly in the given basis as a $3\\times 3$ matrix.\n\n2. Compute the orthogonal factor $\\mathbf{R}=\\mathbf{F}\\,\\mathbf{U}^{-1}$ explicitly and identify its action in the $\\mathbf{e}_{1}$–$\\mathbf{e}_{2}$ plane as a planar rotation by some angle $\\theta(\\gamma)$ about the $\\mathbf{e}_{3}$ axis.\n\n3. Compute the symmetric–skew split of $\\mathbf{F}$, namely $\\tfrac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ and $\\tfrac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$, and compare this linear split with the nonlinear polar factors you obtained. Explain their agreement at small $\\gamma$ and their differences at finite $\\gamma$.\n\nReport, as your final answer, the exact expression for the rotation angle $\\theta(\\gamma)$ of $\\mathbf{R}$ in radians, chosen continuously with $\\theta(0)=0$ and $\\theta(\\gamma)0$ for $\\gamma0$. Do not include units in the final answer box; interpret the angle in radians.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n- The deformation gradient for a homogeneous body undergoing planar simple shear is given in an orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ as:\n$$\n\\mathbf{F} = \\mathbf{I} + \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}\n$$\n- The shear amount is $\\gamma \\in \\mathbb{R}$.\n- The framework is finite deformation kinematics.\n- The objective is to find the right polar decomposition $\\mathbf{F}=\\mathbf{R}\\,\\mathbf{U}$, where $\\mathbf{R}$ is a proper orthogonal tensor ($\\mathbf{R}^{T}\\mathbf{R}=\\mathbf{I}$, $\\det\\mathbf{R}=+1$) and $\\mathbf{U}$ is a symmetric positive-definite (SPD) tensor.\n- Task 1: Compute the right stretch tensor $\\mathbf{U}$ from the definition $\\mathbf{U} = \\mathbf{C}^{1/2}$, where $\\mathbf{C} = \\mathbf{F}^{T}\\mathbf{F}$ is the right Cauchy–Green tensor.\n- Task 2: Compute the rotation tensor $\\mathbf{R}$ from $\\mathbf{R}=\\mathbf{F}\\,\\mathbf{U}^{-1}$ and identify its action as a rotation by an angle $\\theta(\\gamma)$.\n- Task 3: Compute the symmetric-skew split of $\\mathbf{F}$, $\\tfrac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ and $\\tfrac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$, and compare it with the polar factors $\\mathbf{R}$ and $\\mathbf{U}$.\n- The final answer is to be the expression for the angle $\\theta(\\gamma)$, with the specified conditions that $\\theta(0)=0$ and $\\theta(\\gamma)0$ for $\\gamma0$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is a fundamental exercise in continuum mechanics, specifically in the area of finite deformation kinematics. All concepts, such as the deformation gradient, polar decomposition, and Cauchy-Green tensors, are well-established.\n2.  **Well-Posed**: The problem is well-posed. The existence and uniqueness of the right polar decomposition are guaranteed for any invertible deformation gradient. Here, $\\det(\\mathbf{F})=1$, so $\\mathbf{F}$ is invertible. The problem provides all necessary information and a clear objective. The condition on the sign of the angle $\\theta(\\gamma)$ is interpreted as a convention for reporting the answer, which resolves any potential ambiguity.\n3.  **Objective**: The problem is stated in precise, objective mathematical language.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n## Solution\n\nThe matrix representation of the deformation gradient $\\mathbf{F}$ in the basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ is\n$$\n[F] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n### Part 1: Computation of the Right Stretch Tensor U\n\nThe right Cauchy-Green tensor $\\mathbf{C}$ is defined as $\\mathbf{C} = \\mathbf{F}^{T}\\mathbf{F}$. Its matrix representation is\n$$\n[C] = [F]^{T}[F] = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  1+\\gamma^{2}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThe right stretch tensor $\\mathbf{U}$ is the unique symmetric positive-definite square root of $\\mathbf{C}$, i.e., $\\mathbf{U}=\\mathbf{C}^{1/2}$. Since $\\mathbf{C}$ is block-diagonal, $\\mathbf{U}$ will have the same structure. The lower-right $1 \\times 1$ block is $1$, so its square root is $1$. We need to find the square root of the upper-left $2 \\times 2$ block, which we denote as $C_{2D}$:\n$$\nC_{2D} = \\begin{pmatrix} 1  \\gamma \\\\ \\gamma  1+\\gamma^{2} \\end{pmatrix}\n$$\nFor a $2 \\times 2$ symmetric positive-definite matrix $M$, its square root is given by the formula\n$$\n\\sqrt{M} = \\frac{1}{\\sqrt{\\text{tr}(M) + 2\\sqrt{\\det(M)}}} \\left( M + \\sqrt{\\det(M)} I \\right)\n$$\nFor $C_{2D}$, we have $\\text{tr}(C_{2D}) = 1 + (1+\\gamma^{2}) = 2+\\gamma^{2}$ and $\\det(C_{2D}) = 1(1+\\gamma^{2}) - \\gamma^{2} = 1$.\nSubstituting these into the formula, we find the matrix for the $2 \\times 2$ part of $\\mathbf{U}$, denoted $U_{2D}$:\n$$\nU_{2D} = \\frac{1}{\\sqrt{(2+\\gamma^{2}) + 2\\sqrt{1}}} \\left( \\begin{pmatrix} 1  \\gamma \\\\ \\gamma  1+\\gamma^{2} \\end{pmatrix} + \\sqrt{1} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2  \\gamma \\\\ \\gamma  2+\\gamma^{2} \\end{pmatrix}\n$$\nTherefore, the full matrix for $\\mathbf{U}$ is\n$$\n[U] = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n### Part 2: Computation of the Rotation Tensor R and Angle $\\theta(\\gamma)$\n\nThe rotation tensor $\\mathbf{R}$ is computed as $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$. First, we find the inverse of $\\mathbf{U}$. Since $\\det(\\mathbf{U}) = \\sqrt{\\det(\\mathbf{C})} = \\sqrt{1} = 1$, we can find $[U]^{-1}$ by taking the inverse of the $2 \\times 2$ block $U_{2D}$.\n$\\det(U_{2D}) = (\\frac{1}{\\sqrt{4+\\gamma^{2}}})^{2} [2(2+\\gamma^{2}) - \\gamma^{2}] = \\frac{1}{4+\\gamma^{2}}(4+\\gamma^{2}) = 1$.\n$$\n[U_{2D}]^{-1} = \\frac{1}{\\det(U_{2D})} \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma \\\\ -\\gamma  2 \\end{pmatrix} = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma \\\\ -\\gamma  2 \\end{pmatrix}\n$$\nThe full matrix for $\\mathbf{U}^{-1}$ is\n$$\n[U^{-1}] = \\begin{pmatrix} \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}}  -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nNow, we compute $[R] = [F][U^{-1}]$:\n$$\n[R] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 1(2+\\gamma^{2}) + \\gamma(-\\gamma)  1(-\\gamma) + \\gamma(2)  0 \\\\ 0(2+\\gamma^{2}) + 1(-\\gamma)  0(-\\gamma) + 1(2)  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2  \\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nThis matrix corresponds to a rotation about the $\\mathbf{e}_{3}$ axis. The standard matrix for a counter-clockwise (CCW) rotation by an angle $\\theta$ is $\\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}$. The computed matrix $[R]$ has the form $\\begin{pmatrix} C  S \\\\ -S  C \\end{pmatrix}$, which represents a clockwise rotation.\nComparing $[R]$ to the standard CCW rotation matrix gives:\n$$\n\\cos\\theta = \\frac{2}{\\sqrt{4+\\gamma^{2}}}, \\quad -\\sin\\theta = \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}} \\implies \\sin\\theta = -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}\n$$\nThis implies that $\\tan\\theta = \\frac{\\sin\\theta}{\\cos\\theta} = -\\frac{\\gamma}{2}$, so the standard CCW angle is $\\theta_{std} = \\arctan(-\\gamma/2) = -\\arctan(\\gamma/2)$. However, the problem specifies that the angle $\\theta(\\gamma)$ must be chosen such that $\\theta(\\gamma)0$ for $\\gamma0$. This is a directive on how to report the angle. The calculated rotation is clockwise by a magnitude of $\\arctan(\\gamma/2)$ for $\\gamma0$. We thus define the required angle $\\theta(\\gamma)$ to be this positive magnitude.\n$$\n\\theta(\\gamma) = \\arctan\\left(\\frac{\\gamma}{2}\\right)\n$$\nThis choice satisfies $\\theta(0)=0$ and is positive for $\\gamma0$.\n\n### Part 3: Comparison with Symmetric-Skew Split\n\nThe additive decomposition of $\\mathbf{F}$ is $\\mathbf{F} = \\mathbf{E}_{symm} + \\mathbf{W}_{skew}$, where $\\mathbf{E}_{symm} = \\frac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ and $\\mathbf{W}_{skew} = \\frac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$.\n$$\n[E_{symm}] = \\frac{1}{2}\\left(\\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1  \\gamma/2  0 \\\\ \\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n[W_{skew}] = \\frac{1}{2}\\left(\\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\\right) = \\begin{pmatrix} 0  \\gamma/2  0 \\\\ -\\gamma/2  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nIn the theory of small deformations, where $\\mathbf{F} = \\mathbf{I} + \\nabla\\mathbf{u}$ and $\\|\\nabla\\mathbf{u}\\| \\ll 1$, the stretch tensor $\\mathbf{U}$ is approximated by $\\mathbf{I}+\\boldsymbol{\\epsilon}$ and the rotation tensor $\\mathbf{R}$ by $\\mathbf{I}+\\boldsymbol{\\omega}$, where $\\boldsymbol{\\epsilon} = \\text{symm}(\\nabla\\mathbf{u})$ is the infinitesimal strain tensor and $\\boldsymbol{\\omega} = \\text{skew}(\\nabla\\mathbf{u})$ is the infinitesimal rotation tensor.\nFor this problem, $\\nabla\\mathbf{u} = \\mathbf{F}-\\mathbf{I} = \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}$.\nThen $\\boldsymbol{\\epsilon} = \\frac{\\gamma}{2}(\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2} + \\mathbf{e}_{2}\\otimes\\mathbf{e}_{1})$, so $\\mathbf{I}+\\boldsymbol{\\epsilon}$ has the matrix $[E_{symm}]$.\nAnd $\\boldsymbol{\\omega} = \\frac{\\gamma}{2}(\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2} - \\mathbf{e}_{2}\\otimes\\mathbf{e}_{1})$, which has the matrix $[W_{skew}]$.\n\nLet us expand $\\mathbf{U}$ and $\\mathbf{R}$ for small $\\gamma$:\nUsing Taylor expansion $(1+x)^{-1/2} \\approx 1 - x/2$ for small $x$:\n$$\n\\frac{1}{\\sqrt{4+\\gamma^{2}}} = \\frac{1}{2}(1+\\gamma^{2}/4)^{-1/2} \\approx \\frac{1}{2}(1-\\gamma^{2}/8)\n$$\n$$\n[U]_{11} = \\frac{2}{\\sqrt{4+\\gamma^{2}}} \\approx 2 \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) = 1-\\frac{\\gamma^{2}}{8} \\approx 1\n$$\n$$\n[U]_{12} = \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}} \\approx \\gamma \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) \\approx \\frac{\\gamma}{2}\n$$\n$$\n[U]_{22} = \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}} \\approx (2+\\gamma^{2}) \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) = (1+\\frac{\\gamma^{2}}{2})(1-\\frac{\\gamma^{2}}{8}) \\approx 1+\\frac{3\\gamma^{2}}{8} \\approx 1\n$$\nTo first order in $\\gamma$, $[U] \\approx \\begin{pmatrix} 1  \\gamma/2  0 \\\\ \\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix} = [E_{symm}]$. This shows that for small shear, the right stretch tensor $\\mathbf{U}$ corresponds to the symmetric part of $\\mathbf{F}$. For finite $\\gamma$, they differ, with $\\mathbf{U}$ being the geometrically correct measure of local stretch.\n\nFor the rotation tensor $\\mathbf{R}$:\n$$\n[R] = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix} \\approx \\begin{pmatrix} 1-\\frac{\\gamma^{2}}{8}  \\frac{\\gamma}{2}  0 \\\\ -\\frac{\\gamma}{2}  1-\\frac{\\gamma^{2}}{8}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\nTo first order in $\\gamma$, $[R] \\approx \\begin{pmatrix} 1  \\gamma/2  0 \\\\ -\\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix} = [I] + [W_{skew}]$. This shows that for small shear, the rotation tensor $\\mathbf{R}$ corresponds to an infinitesimal rotation given by the skew-symmetric part of $\\mathbf{F}$. For finite $\\gamma$, $\\mathbf{R}$ is a finite rotation, a proper orthogonal tensor, while $\\mathbf{I}+\\mathbf{W}_{skew}$ is not orthogonal.\n\nIn summary, the additive split $\\mathbf{F} = \\mathbf{E}_{symm} + \\mathbf{W}_{skew}$ provides the first-order approximation to the multiplicative decomposition $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$ in the small deformation limit. The polar decomposition is the geometrically and physically correct decomposition for finite deformations.", "answer": "$$\\boxed{\\arctan\\left(\\frac{\\gamma}{2}\\right)}$$", "id": "2639541"}, {"introduction": "While analytical examples like simple shear are essential for building intuition, real-world problems in computational mechanics require a general and robust method for computing the polar decomposition for any valid deformation gradient $\\mathbf{F}$. This advanced practice bridges the gap between theory and numerical implementation by exploring the link between polar decomposition and the Singular Value Decomposition (SVD). By deriving and implementing an SVD-based algorithm, you will not only gain a practical tool but also prove a deeper result: the rotation factor $\\mathbf{R}$ is the 'closest' proper rotation to $\\mathbf{F}$, connecting the kinematic decomposition to a fundamental variational principle [@problem_id:2886399].", "problem": "You are given a square matrix representing a finite deformation gradient in materials mechanics. Let the deformation gradient be a real matrix $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$ with $\\det(\\mathbf{F})  0$. The right polar decomposition seeks a proper rotation $\\mathbf{R} \\in \\mathrm{SO}(n)$ and a symmetric positive-definite stretch $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ such that $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$. All angles in this problem must be interpreted in radians.\n\nYour tasks:\n\n1) Starting only from the fundamental definitions of the singular value decomposition, orthogonal matrices, Frobenius norm, and symmetric positive-definite matrices, derive an algorithm that computes the right polar decomposition of $\\mathbf{F}$ using the singular value decomposition. The algorithm must work for any $\\mathbf{F}$ with $\\det(\\mathbf{F})  0$, and it must return $\\mathbf{R} \\in \\mathrm{SO}(n)$ and $\\mathbf{U}$ symmetric positive-definite.\n\n2) Prove that the rotation $\\mathbf{R}$ produced by your algorithm is the unique minimizer of the problem\n$$\n\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F,\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm, and that the associated $\\mathbf{U} = \\mathbf{R}^\\top \\mathbf{F}$ is symmetric positive-definite. Your proof must be principle-based, starting from the unitary invariance of the Frobenius norm and standard spectral inequalities, without assuming the target result.\n\n3) Implement a program that:\n- Computes the singular value decomposition of each given test matrix $\\mathbf{F}$.\n- Uses your derived algorithm to compute $\\mathbf{R}$ and $\\mathbf{U}$ for each case.\n- For each test case, computes a single real-valued diagnostic that quantitatively verifies one of the core properties implied by your derivation and proof.\n\nUse the following test suite of deformation gradients:\n- Case 1 (two-dimensional diagonal stretch): $\\mathbf{F}_1 = \\begin{bmatrix} 2.0  0.0 \\\\ 0.0  0.5 \\end{bmatrix}$. Output the absolute difference between $\\|\\mathbf{F}_1 - \\mathbf{R}_1\\|_F$ and the value $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$, where $\\sigma_i$ are the singular values of $\\mathbf{F}_1$.\n- Case 2 (two-dimensional rotated stretch): Let $\\theta = 0.4$ (radians), $\\mathbf{R}_{\\mathrm{true}} = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{bmatrix}$, and $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(1.2, 0.8)$. Define $\\mathbf{F}_2 = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$. Output $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$.\n- Case 3 (three-dimensional general symmetric stretch with nontrivial eigenbasis): Let $\\phi = 0.6$ (radians), $\\mathbf{Q} = \\begin{bmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{bmatrix}$, $\\mathbf{D} = \\operatorname{diag}(1.5, 0.9, 1.1)$, and $\\mathbf{U}_{\\mathrm{true}} = \\mathbf{Q}\\mathbf{D}\\mathbf{Q}^\\top$. Let $\\alpha = -0.7$ (radians) and $\\mathbf{R}_{\\mathrm{true}}^{(x)} = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{bmatrix}$. Define $\\mathbf{F}_3 = \\mathbf{R}_{\\mathrm{true}}^{(x)} \\mathbf{U}_{\\mathrm{true}}$. Output $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$.\n- Case 4 (two-dimensional ill-conditioned stretch): Let $\\beta = 1.1$ (radians), $\\mathbf{R}_{\\beta} = \\begin{bmatrix} \\cos\\beta  -\\sin\\beta \\\\ \\sin\\beta  \\cos\\beta \\end{bmatrix}$, and $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(10^{-6}, 3.0)$. Define $\\mathbf{F}_4 = \\mathbf{R}_{\\beta} \\mathbf{U}_{\\mathrm{true}}$. Output the absolute difference between $\\|\\mathbf{F}_4 - \\mathbf{R}_4\\|_F$ and the value $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$.\n\nAll computations must assume angles in radians. Your program must aggregate the four diagnostics into a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of Cases 1 through 4. Each diagnostic must be a real number (a float). It is acceptable to round the outputs to a fixed number of decimal places, but you must be consistent across all four outputs.\n\nNotes:\n- The singular values in the expressions above refer to those of the corresponding $\\mathbf{F}$ in each case.\n- Ensure all $\\mathbf{F}_k$ used have strictly positive determinants so that a proper rotation exists in the polar decomposition.", "solution": "The problem posed is a standard exercise in continuum mechanics and linear algebra. It is well-posed, scientifically grounded, and contains all necessary information for a complete and unique solution. The specified test cases are consistent with the theoretical framework and have determinants greater than zero, as required. The problem is therefore deemed valid.\n\nThe solution is presented in three parts, as requested: first, the derivation of the algorithm for right polar decomposition; second, the proof of the associated minimization property; and third, an explanation of the implementation applied to the test cases.\n\n### 1. Algorithm Derivation for Right Polar Decomposition\n\nThe objective is to find a proper rotation matrix $\\mathbf{R} \\in \\mathrm{SO}(n)$ (i.e., $\\mathbf{R}^\\top\\mathbf{R}=\\mathbf{I}$ and $\\det(\\mathbf{R})=+1$) and a symmetric positive-definite stretch tensor $\\mathbf{U}$ such that for a given deformation gradient $\\mathbf{F}$ with $\\det(\\mathbf{F})  0$, the right polar decomposition holds:\n$$ \\mathbf{F} = \\mathbf{R}\\mathbf{U} $$\nWe start from the Singular Value Decomposition (SVD) of $\\mathbf{F}$, which is defined for any real matrix $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$ as:\n$$ \\mathbf{F} = \\mathbf{V} \\mathbf{\\Sigma} \\mathbf{W}^\\top $$\nHere, $\\mathbf{V}$ and $\\mathbf{W}$ are orthogonal matrices ($\\mathbf{V}^\\top\\mathbf{V} = \\mathbf{I}$, $\\mathbf{W}^\\top\\mathbf{W} = \\mathbf{I}$), and $\\mathbf{\\Sigma}$ is a diagonal matrix containing the singular values $\\sigma_i \\ge 0$ of $\\mathbf{F}$. Since the problem states $\\det(\\mathbf{F})  0$, $\\mathbf{F}$ is invertible, which implies that all singular values are strictly positive, $\\sigma_i  0$.\n\nWe seek to express $\\mathbf{R}$ and $\\mathbf{U}$ in terms of $\\mathbf{V}$, $\\mathbf{\\Sigma}$, and $\\mathbf{W}$. A natural construction is to group the orthogonal and symmetric parts of the SVD. Let us propose the following candidates for $\\mathbf{R}$ and $\\mathbf{U}$:\n$$ \\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top $$\n$$ \\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top $$\nWe must verify that these choices satisfy the required properties.\n\nFirst, check if the decomposition is valid:\n$$ \\mathbf{R}\\mathbf{U} = (\\mathbf{V}\\mathbf{W}^\\top)(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{V}(\\mathbf{W}^\\top\\mathbf{W})\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{I}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{F} $$\nThe decomposition is correct.\n\nSecond, verify the properties of $\\mathbf{U}$.\nSymmetry:\n$$ \\mathbf{U}^\\top = (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top = (\\mathbf{W}^\\top)^\\top \\mathbf{\\Sigma}^\\top \\mathbf{W}^\\top = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{U} $$\nsince $\\mathbf{\\Sigma}$ is diagonal and thus symmetric. $\\mathbf{U}$ is symmetric.\n\nPositive-definiteness: For any non-zero vector $\\mathbf{x} \\in \\mathbb{R}^n$, we examine the quadratic form $\\mathbf{x}^\\top\\mathbf{U}\\mathbf{x}$:\n$$ \\mathbf{x}^\\top\\mathbf{U}\\mathbf{x} = \\mathbf{x}^\\top (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) \\mathbf{x} = (\\mathbf{W}^\\top\\mathbf{x})^\\top \\mathbf{\\Sigma} (\\mathbf{W}^\\top\\mathbf{x}) $$\nLet $\\mathbf{y} = \\mathbf{W}^\\top\\mathbf{x}$. Since $\\mathbf{W}$ is orthogonal and $\\mathbf{x} \\neq \\mathbf{0}$, $\\mathbf{y} \\neq \\mathbf{0}$. The expression becomes:\n$$ \\mathbf{y}^\\top \\mathbf{\\Sigma} \\mathbf{y} = \\sum_{i=1}^n \\sigma_i y_i^2 $$\nAs established, $\\sigma_i  0$ for all $i$. Since $\\mathbf{y} \\neq \\mathbf{0}$, at least one $y_i \\neq 0$. Thus, $\\sum_{i=1}^n \\sigma_i y_i^2  0$. This confirms that $\\mathbf{U}$ is positive-definite.\n\nThird, verify the properties of $\\mathbf{R}$.\nOrthogonality:\n$$ \\mathbf{R}^\\top\\mathbf{R} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top(\\mathbf{V}\\mathbf{W}^\\top) = (\\mathbf{W}\\mathbf{V}^\\top)(\\mathbf{V}\\mathbf{W}^\\top) = \\mathbf{W}(\\mathbf{V}^\\top\\mathbf{V})\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{W}^\\top = \\mathbf{I} $$\n$\\mathbf{R}$ is orthogonal.\n\nProper rotation: We must ensure $\\det(\\mathbf{R}) = +1$.\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}) $$\nFrom the SVD, $\\det(\\mathbf{F}) = \\det(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{\\Sigma})\\det(\\mathbf{W}) = (\\det(\\mathbf{V})\\det(\\mathbf{W})) \\prod_{i=1}^n \\sigma_i$.\nGiven $\\det(\\mathbf{F})  0$ and knowing $\\prod \\sigma_i  0$, it must be that $\\det(\\mathbf{V})\\det(\\mathbf{W})  0$.\nThe determinants of orthogonal matrices can only be $+1$ or $-1$. Therefore, $\\det(\\mathbf{V})$ and $\\det(\\mathbf{W})$ must have the same sign. Their product is necessarily $+1$.\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\nThus, $\\mathbf{R}$ is a proper rotation matrix, i.e., $\\mathbf{R} \\in \\mathrm{SO}(n)$.\n\nThe algorithm derived from these first principles is as follows:\n1.  For a given matrix $\\mathbf{F}$ with $\\det(\\mathbf{F})  0$, compute its SVD: $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$.\n2.  The rotation matrix is $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$.\n3.  The stretch tensor is $\\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$. Alternatively, it can be computed via $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$.\n\n### 2. Proof of Minimality and Uniqueness\n\nWe must prove that $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ is the unique minimizer of the problem $\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F$.\n\nThe Frobenius norm squared is $\\|\\mathbf{A}\\|_F^2 = \\operatorname{Tr}(\\mathbf{A}^\\top\\mathbf{A})$. We expand the objective function:\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}((\\mathbf{F} - \\mathbf{Q})^\\top(\\mathbf{F} - \\mathbf{Q})) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F} - \\mathbf{F}^\\top\\mathbf{Q} - \\mathbf{Q}^\\top\\mathbf{F} + \\mathbf{Q}^\\top\\mathbf{Q}) $$\nSince $\\mathbf{Q} \\in \\mathrm{SO}(n)$, $\\mathbf{Q}$ is orthogonal, so $\\mathbf{Q}^\\top\\mathbf{Q} = \\mathbf{I}$ and $\\operatorname{Tr}(\\mathbf{I}) = n$. Also, $\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}((\\mathbf{F}^\\top\\mathbf{Q})^\\top) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$.\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\|\\mathbf{F}\\|_F^2 + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) $$\nMinimizing this expression with respect to $\\mathbf{Q}$ is equivalent to maximizing the term $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$.\n\nSubstitute the SVD of $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ into the trace:\n$$ \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\operatorname{Tr}((\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) $$\nUsing the cyclic property of the trace, $\\operatorname{Tr}(\\mathbf{ABC}) = \\operatorname{Tr}(\\mathbf{CAB})$:\n$$ \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}\\mathbf{W}) $$\nLet $\\mathbf{Z} = \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W}$. Since $\\mathbf{V}$, $\\mathbf{Q}$, and $\\mathbf{W}$ are orthogonal, their product $\\mathbf{Z}$ is also orthogonal. We want to maximize $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ over all orthogonal $\\mathbf{Z}$ that can be formed from a $\\mathbf{Q} \\in \\mathrm{SO}(n)$.\n$$ \\det(\\mathbf{Z}) = \\det(\\mathbf{V}^\\top)\\det(\\mathbf{Q})\\det(\\mathbf{W}) = \\det(\\mathbf{V})^{-1} (+1) \\det(\\mathbf{W}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\nThe last step is because $\\det(\\mathbf{V}) = \\det(\\mathbf{V}^\\top)$ for orthogonal matrices with determinant $\\pm 1$, or simply because $\\det(\\mathbf{V})^2=1$. More rigorously, $\\det(\\mathbf{V}^\\top\\mathbf{V})=1 \\implies \\det(\\mathbf{V}^\\top)\\det(\\mathbf{V})=1 \\implies \\det(\\mathbf{V})^2=1$. So $\\det(\\mathbf{V}^\\top)=\\det(\\mathbf{V})$.\nThus, we must maximize $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ over all $\\mathbf{Z} \\in \\mathrm{SO}(n)$.\n\nThe trace is $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) = \\sum_{i=1}^n \\sigma_i Z_{ii}$. By von Neumann's trace inequality, $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_i \\sigma_i(\\mathbf{\\Sigma})\\sigma_i(\\mathbf{Z})$. The singular values of $\\mathbf{\\Sigma}$ are $\\sigma_i$ and the singular values of an orthogonal matrix $\\mathbf{Z}$ are all $1$.\n$$ \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_{i=1}^n \\sigma_i $$\nEquality holds if $\\mathbf{\\Sigma}$ and $\\mathbf{Z}$ can be simultaneously diagonalized by the same pair of orthogonal matrices. Since $\\mathbf{\\Sigma}$ is already diagonal, this condition implies that $\\mathbf{Z}$ must also be diagonal. An orthogonal diagonal matrix must have diagonal entries of $\\pm 1$.\nTo maximize $\\sum_i \\sigma_i Z_{ii}$ where $\\sigma_i  0$ and $Z_{ii} = \\pm 1$, we must choose $Z_{ii}=+1$ for all $i$. This leads to the unique choice $\\mathbf{Z} = \\mathbf{I}$.\nThe identity matrix $\\mathbf{I}$ is in $\\mathrm{SO}(n)$ since $\\det(\\mathbf{I})=+1$.\nTherefore, the maximum of $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ is achieved uniquely when $\\mathbf{Z} = \\mathbf{I}$.\n\nSetting $\\mathbf{Z} = \\mathbf{I}$ gives the optimal $\\mathbf{Q}$:\n$$ \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W} = \\mathbf{I} \\implies \\mathbf{Q} = \\mathbf{V}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{W}^\\top $$\nThis is precisely the matrix $\\mathbf{R}$ derived in the previous section. This proves that $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ is the unique minimizer of $\\|\\mathbf{F} - \\mathbf{Q}\\|_F$ for $\\mathbf{Q} \\in \\mathrm{SO}(n)$.\n\nThe proof that the associated stretch tensor $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ is symmetric and positive-definite has already been demonstrated in the algorithm derivation section.\n\n### 3. Implementation and Verification\n\nThe Python implementation will follow the derived algorithm. For each test matrix $\\mathbf{F}_k$, we perform the following steps:\n1.  Construct $\\mathbf{F}_k$.\n2.  Compute its SVD using `numpy.linalg.svd`: $\\mathbf{V}$, $\\mathbf{S}$ (vector of singular values), $\\mathbf{W}^\\top$.\n3.  Calculate $\\mathbf{R}_k = \\mathbf{V} \\mathbf{W}^\\top$.\n4.  Calculate the required diagnostic quantity.\n\nFor Cases $1$ and $4$, the diagnostic is $|\\,\\|\\mathbf{F}_k - \\mathbf{R}_k\\|_F - \\sqrt{\\sum (\\sigma_i - 1)^2}\\,|$.\nFrom the proof in Section 2, the minimum value of the objective function is:\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\|\\mathbf{F}\\|_F^2 + n - 2 \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) $$\nWe showed that $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) = \\sum \\sigma_i$. Also, $\\|\\mathbf{F}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}^2\\mathbf{W}^\\top) = \\operatorname{Tr}(\\mathbf{\\Sigma}^2) = \\sum \\sigma_i^2$.\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\sum \\sigma_i^2 + n - 2\\sum \\sigma_i = \\sum_{i=1}^n (\\sigma_i^2 - 2\\sigma_i + 1) = \\sum_{i=1}^n (\\sigma_i - 1)^2 $$\nTaking the square root, we get exactly $\\|\\mathbf{F} - \\mathbf{R}\\|_F = \\sqrt{\\sum (\\sigma_i - 1)^2}$.\nTherefore, the diagnostic for Cases $1$ and $4$ is expected to be zero, up to floating-point precision errors. This serves as a quantitative verification of our minimization proof.\n\nFor Cases $2$ and $3$, the matrices $\\mathbf{F}_k$ are constructed in the form $\\mathbf{F}_k = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$, where $\\mathbf{R}_{\\mathrm{true}}$ is a proper rotation and $\\mathbf{U}_{\\mathrm{true}}$ is symmetric positive-definite. This is, by definition, the right polar decomposition. Since the polar decomposition of an invertible matrix is unique, our algorithm must recover $\\mathbf{R}_k = \\mathbf{R}_{\\mathrm{true}}$ and $\\mathbf{U}_k = \\mathbf{U}_{\\mathrm{true}}$. The diagnostics $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$ and $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$ are therefore expected to be zero, up to numerical precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the right polar decomposition for several deformation gradients and\n    calculates specific diagnostic values to verify the theoretical results.\n    \"\"\"\n\n    # --- Test Case 1: 2D diagonal stretch ---\n    F1 = np.array([[2.0, 0.0], [0.0, 0.5]])\n\n    # --- Test Case 2: 2D rotated stretch ---\n    theta = 0.4\n    R_true2 = np.array([[np.cos(theta), -np.sin(theta)],\n                        [np.sin(theta), np.cos(theta)]])\n    U_true2 = np.diag([1.2, 0.8])\n    F2 = R_true2 @ U_true2\n\n    # --- Test Case 3: 3D general symmetric stretch ---\n    phi = 0.6\n    Q3 = np.array([[np.cos(phi), -np.sin(phi), 0.0],\n                   [np.sin(phi), np.cos(phi), 0.0],\n                   [0.0, 0.0, 1.0]])\n    D3 = np.diag([1.5, 0.9, 1.1])\n    U_true3 = Q3 @ D3 @ Q3.T\n    \n    alpha = -0.7\n    R_true3_x = np.array([[1.0, 0.0, 0.0],\n                          [0.0, np.cos(alpha), -np.sin(alpha)],\n                          [0.0, np.sin(alpha), np.cos(alpha)]])\n    F3 = R_true3_x @ U_true3\n\n    # --- Test Case 4: 2D ill-conditioned stretch ---\n    beta = 1.1\n    R_beta4 = np.array([[np.cos(beta), -np.sin(beta)],\n                        [np.sin(beta), np.cos(beta)]])\n    U_true4 = np.diag([1e-6, 3.0])\n    F4 = R_beta4 @ U_true4\n\n    test_cases = [\n        {'F': F1, 'type': 'diag_check'},\n        {'F': F2, 'type': 'R_check', 'R_true': R_true2},\n        {'F': F3, 'type': 'U_check', 'U_true': U_true3},\n        {'F': F4, 'type': 'diag_check'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        F = case['F']\n        \n        # Core algorithm: Right Polar Decomposition using SVD\n        # F = V @ Sigma @ Wt\n        V, S_vec, Wt = np.linalg.svd(F)\n        \n        # Check for reflection and correct if necessary.\n        # This handles the general case, but for this problem det(F)>0 is given.\n        if np.linalg.det(V) * np.linalg.det(Wt)  0:\n            V_corr = V.copy()\n            V_corr[:, -1] *= -1\n            R = V_corr @ Wt\n        else:\n            R = V @ Wt\n\n        if case['type'] == 'diag_check':\n            # Diagnostic: | ||F - R||_F - sqrt(sum((sigma_i - 1)^2)) |\n            norm_F_minus_R = np.linalg.norm(F - R, 'fro')\n            norm_s_minus_1 = np.sqrt(np.sum((S_vec - 1)**2))\n            diagnostic = np.abs(norm_F_minus_R - norm_s_minus_1)\n            results.append(diagnostic)\n            \n        elif case['type'] == 'R_check':\n            # Diagnostic: ||R - R_true||_F\n            R_true = case['R_true']\n            diagnostic = np.linalg.norm(R - R_true, 'fro')\n            results.append(diagnostic)\n\n        elif case['type'] == 'U_check':\n            # U can be computed as U = R.T @ F\n            U = R.T @ F\n            U_true = case['U_true']\n            # Diagnostic: ||U - U_true||_F\n            diagnostic = np.linalg.norm(U - U_true, 'fro')\n            results.append(diagnostic)\n\n    # Format the output as a comma-separated list of floats in a single line.\n    # Use scientific notation for consistency and to handle very small numbers.\n    formatted_results = [f\"{res:.8e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2886399"}]}