{"hands_on_practices": [{"introduction": "Understanding the Principle of Strain Equivalence begins with applying it to a fundamental scenario. This practice guides you through the process of deriving the constitutive response of a damaged material under uniaxial tension, starting from the Helmholtz free energy. By applying the PSE, you will see how it naturally leads to the concept of an effective Young's modulus, providing a tangible link between the internal damage variable $D$ and the macroscopic stiffness degradation of the material [@problem_id:2912583].", "problem": "An initially undamaged, macroscopically isotropic, linear elastic solid is modeled with an internal scalar damage variable $D \\in [0,1)$ according to the principle of strain equivalence in continuum damage mechanics. Consider a uniaxial tension test along the $x_{1}$ direction on a prismatic specimen with traction-free lateral faces. Let the undamaged Young’s modulus be $E_{0}=210~\\text{GPa}$ and the Poisson’s ratio be $\\nu=0.3$. The scalar damage is fixed at $D=0.2$ during loading. Denote the nominal (Cauchy) axial strain by $\\varepsilon \\equiv \\varepsilon_{11}$.\n\nStarting from the undamaged Helmholtz free energy density of linear isotropic elasticity written in terms of the Lamé parameters,\n$$\n\\psi_{0}(\\varepsilon_{ij})=\\tfrac{1}{2}\\lambda_{0}\\left(\\operatorname{tr}\\varepsilon\\right)^{2}+\\mu_{0}\\,\\varepsilon:\\varepsilon,\n$$\nwhere $\\lambda_{0}$ and $\\mu_{0}$ are related to $E_{0}$ and $\\nu$ by\n$$\n\\lambda_{0}=\\frac{E_{0}\\,\\nu}{(1+\\nu)(1-2\\nu)},\\qquad \\mu_{0}=\\frac{E_{0}}{2(1+\\nu)},\n$$\nand applying the principle of strain equivalence, derive the nominal axial Cauchy stress $\\sigma_{11}$ as a function of the imposed axial strain $\\varepsilon$ under uniaxial tension with traction-free lateral faces. You must impose the lateral stress-free conditions and eliminate any unknown lateral strains.\n\nExpress your final answer for $\\sigma_{11}$ in gigapascals (GPa) as a function of $\\varepsilon$. Provide an exact expression; do not approximate or round.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. We proceed directly to the derivation.\n\nThe formulation is based on the principle of strain equivalence in continuum damage mechanics. This principle asserts that the constitutive response of a damaged material can be derived from the response of the undamaged material. Specifically, the Helmholtz free energy density of the damaged material, $\\psi$, is related to the undamaged free energy density, $\\psi_0$, by the scalar damage variable $D \\in [0, 1)$:\n$$\n\\psi(\\boldsymbol{\\varepsilon}, D) = (1-D)\\psi_0(\\boldsymbol{\\varepsilon})\n$$\nThe Cauchy stress tensor, $\\boldsymbol{\\sigma}$, is obtained from the thermodynamic state law:\n$$\n\\boldsymbol{\\sigma} = \\frac{\\partial\\psi}{\\partial\\boldsymbol{\\varepsilon}} = \\frac{\\partial}{\\partial\\boldsymbol{\\varepsilon}} \\left[ (1-D)\\psi_0(\\boldsymbol{\\varepsilon}) \\right]\n$$\nGiven that the damage variable $D$ is fixed during the deformation process, its derivative with respect to strain is zero. Therefore, the stress in the damaged material is a simple scaling of the stress that would exist in an undamaged material under the same strain field, $\\boldsymbol{\\sigma}_0$:\n$$\n\\boldsymbol{\\sigma} = (1-D) \\frac{\\partial\\psi_0}{\\partial\\boldsymbol{\\varepsilon}} = (1-D)\\boldsymbol{\\sigma}_0\n$$\nThe undamaged free energy density is provided as $\\psi_{0}(\\varepsilon_{ij})=\\frac{1}{2}\\lambda_{0}(\\operatorname{tr}\\boldsymbol{\\varepsilon})^{2}+\\mu_{0}\\,\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{\\varepsilon}:\\boldsymbol{\\varepsilon} = \\varepsilon_{kl}\\varepsilon_{kl}$. The corresponding undamaged stress tensor is:\n$$\n\\sigma_{0,ij} = \\frac{\\partial\\psi_0}{\\partial\\varepsilon_{ij}} = \\lambda_0(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\delta_{ij} + 2\\mu_0\\varepsilon_{ij}\n$$\nThis is the standard form of Hooke's law for linear isotropic elasticity. The constitutive equation for the damaged solid is thus:\n$$\n\\sigma_{ij} = (1-D) \\left[ \\lambda_{0}(\\operatorname{tr}\\boldsymbol{\\varepsilon})\\delta_{ij} + 2\\mu_{0}\\varepsilon_{ij} \\right]\n$$\nThis equation describes a linear elastic material with effective Lamé parameters $\\lambda = (1-D)\\lambda_0$ and $\\mu = (1-D)\\mu_0$.\n\nWe analyze a uniaxial tension test along the $x_{1}$ direction. The lateral faces are traction-free, which imposes the conditions $\\sigma_{22} = \\sigma_{33} = 0$. All shear stresses are also zero. The strain tensor is diagonal, $\\varepsilon_{ij} = \\operatorname{diag}(\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33})$. The axial strain is $\\varepsilon_{11} \\equiv \\varepsilon$. Due to the isotropy of the material and loading, the lateral strains must be equal, $\\varepsilon_{22} = \\varepsilon_{33} \\equiv \\varepsilon_{L}$. The trace of the strain tensor is $\\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon + 2\\varepsilon_{L}$.\n\nTo determine the unknown lateral strain $\\varepsilon_{L}$, we apply the condition $\\sigma_{22} = 0$:\n$$\n\\sigma_{22} = (1-D) \\left[ \\lambda_0(\\varepsilon + 2\\varepsilon_L) + 2\\mu_0\\varepsilon_{L} \\right] = 0\n$$\nBecause $D = 0.2 < 1$, the term $(1-D)$ is non-zero, so the expression in the brackets must be zero:\n$$\n\\lambda_0\\varepsilon + (2\\lambda_0 + 2\\mu_0)\\varepsilon_L = 0\n$$\nSolving for $\\varepsilon_L$ gives:\n$$\n\\varepsilon_L = -\\frac{\\lambda_0}{2(\\lambda_0 + \\mu_0)}\\varepsilon\n$$\nThe coefficient in this relation is equal to the undamaged Poisson's ratio, $\\nu$. This is demonstrated by substituting the definitions of $\\lambda_0$ and $\\mu_0$ in terms of $E_0$ and $\\nu$:\n$$\n\\lambda_0 + \\mu_0 = \\frac{E_{0}\\,\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E_{0}}{2(1+\\nu)} = \\frac{2E_{0}\\nu + E_{0}(1-2\\nu)}{2(1+\\nu)(1-2\\nu)} = \\frac{E_{0}}{2(1+\\nu)(1-2\\nu)}\n$$\nThe ratio is then:\n$$\n\\frac{\\lambda_0}{2(\\lambda_0 + \\mu_0)} = \\frac{\\frac{E_{0}\\,\\nu}{(1+\\nu)(1-2\\nu)}}{2 \\left( \\frac{E_{0}}{2(1+\\nu)(1-2\\nu)} \\right)} = \\frac{\\frac{E_{0}\\,\\nu}{(1+\\nu)(1-2\\nu)}}{\\frac{E_{0}}{(1+\\nu)(1-2\\nu)}} = \\nu\n$$\nThus, we find the familiar relation for lateral contraction, $\\varepsilon_L = -\\nu\\varepsilon$.\n\nNow we derive the expression for the axial stress $\\sigma_{11}$ as a function of the axial strain $\\varepsilon$:\n$$\n\\sigma_{11} = (1-D) \\left[ \\lambda_0(\\operatorname{tr}\\boldsymbol{\\varepsilon}) + 2\\mu_0\\varepsilon_{11} \\right]\n$$\nSubstituting $\\operatorname{tr}\\boldsymbol{\\varepsilon} = \\varepsilon + 2\\varepsilon_L = \\varepsilon - 2\\nu\\varepsilon = \\varepsilon(1-2\\nu)$ and $\\varepsilon_{11} = \\varepsilon$:\n$$\n\\sigma_{11} = (1-D) \\left[ \\lambda_0\\varepsilon(1-2\\nu) + 2\\mu_0\\varepsilon \\right] = (1-D) \\left[ \\lambda_0(1-2\\nu) + 2\\mu_0 \\right] \\varepsilon\n$$\nThe term in the square brackets is the undamaged Young's modulus, $E_0$:\n$$\n\\lambda_0(1-2\\nu) + 2\\mu_0 = \\frac{E_{0}\\,\\nu}{(1+\\nu)(1-2\\nu)}(1-2\\nu) + 2\\left(\\frac{E_{0}}{2(1+\\nu)}\\right) = \\frac{E_{0}\\nu}{1+\\nu} + \\frac{E_{0}}{1+\\nu} = \\frac{E_0(\\nu+1)}{1+\\nu} = E_0\n$$\nThis confirms the relationship. The final expression for the axial stress is:\n$$\n\\sigma_{11} = (1-D)E_0\\varepsilon\n$$\nThis result indicates that the effective Young's modulus for the damaged material under uniaxial tension is $E_{eff} = (1-D)E_0$.\n\nFinally, we substitute the provided numerical values, $E_0 = 210~\\text{GPa}$ and $D=0.2$. The problem requires $\\sigma_{11}$ to be expressed in GPa.\n$$\nE_{eff} = (1-0.2) \\times 210~\\text{GPa} = 0.8 \\times 210~\\text{GPa} = 168~\\text{GPa}\n$$\nThe relation between the nominal axial stress and strain is therefore:\n$$\n\\sigma_{11} = 168\\varepsilon\n$$\nwhere $\\sigma_{11}$ is in GPa.", "answer": "$$\n\\boxed{168\\varepsilon}\n$$", "id": "2912583"}, {"introduction": "While theoretical derivations are crucial, a key aspect of continuum damage mechanics is connecting the abstract damage variable to measurable quantities. This exercise bridges that gap by using experimental stress-strain data from a uniaxial tension test. You will apply the Principle of Strain Equivalence in reverse to quantify the level of internal damage at a specific point on the material's loading curve, a fundamental skill for model calibration and validation [@problem_id:2675957].", "problem": "A quasi-brittle cementitious composite is tested in uniaxial tension under small strains. The material is modeled as linearly elastic in the undamaged state with Young’s modulus $E_0$, and it undergoes isotropic scalar damage $D \\in [0,1)$ with no plasticity. Under the principle of strain equivalence (PSE), the small-strain elastic constitutive response of the damaged material is obtained by replacing the true Cauchy stress by an effective stress that produces the same strain in an equivalent undamaged material. Assume isothermal conditions and negligible rate effects.\n\nFrom the initial, strictly undamaged regime of the test, the following two stress–strain measurements are recorded: at axial strain $\\varepsilon_1 = 5.00 \\times 10^{-5}$, the axial Cauchy stress is $\\sigma_1 = 1.575\\ \\mathrm{MPa}$; at axial strain $\\varepsilon_2 = 1.00 \\times 10^{-4}$, the axial Cauchy stress is $\\sigma_2 = 3.150\\ \\mathrm{MPa}$. At a later stage of the same monotonic test, when damage is present but plastic strain is still negligible, the measured axial strain and stress are $\\varepsilon^\\star = 1.50 \\times 10^{-3}$ and $\\sigma^\\star = 12.00\\ \\mathrm{MPa}$.\n\nStarting from the definitions of small strain and Cauchy stress, linear elasticity in the undamaged state, and the principle of strain equivalence (PSE), do the following:\n\n1. Determine the undamaged Young’s modulus $E_0$ from the initial measurements $\\left(\\varepsilon_1,\\sigma_1\\right)$ and $\\left(\\varepsilon_2,\\sigma_2\\right)$.\n2. Derive a closed-form expression for the damage variable $D$ at an arbitrary state in terms of the measured stress $\\sigma$, the measured strain $\\varepsilon$, and the undamaged Young’s modulus $E_0$.\n3. Evaluate $D$ at the state $\\left(\\varepsilon^\\star,\\sigma^\\star\\right)$ using your result from part $2$ and the value of $E_0$ from part $1$.\n\nReport the final value of $D$ as a pure number (no units), rounded to four significant figures.", "solution": "The problem is first subjected to a rigorous validation.\n\nStep 1: Extract Givens.\nThe problem provides the following information:\n- Material model: Quasi-brittle cementitious composite, linearly elastic in the undamaged state, isotropic scalar damage $D \\in [0,1)$, no plasticity.\n- Governing principle: Principle of strain equivalence (PSE).\n- Undamaged Young's modulus: $E_0$.\n- Initial measurements in the undamaged regime ($D=0$):\n  - State 1: strain $\\varepsilon_1 = 5.00 \\times 10^{-5}$, Cauchy stress $\\sigma_1 = 1.575\\ \\mathrm{MPa}$.\n  - State 2: strain $\\varepsilon_2 = 1.00 \\times 10^{-4}$, Cauchy stress $\\sigma_2 = 3.150\\ \\mathrm{MPa}$.\n- Measurement in a damaged state:\n  - State $\\star$: strain $\\varepsilon^\\star = 1.50 \\times 10^{-3}$, Cauchy stress $\\sigma^\\star = 12.00\\ \\mathrm{MPa}$.\n- Conditions: Small strains, uniaxial tension, isothermal, negligible rate effects.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is assessed for validity.\n- **Scientifically Grounded**: The problem is based on the well-established theory of continuum damage mechanics for quasi-brittle materials. The principle of strain equivalence is a standard hypothesis in this field. The given stress and strain values are realistic for a cementitious composite under uniaxial tension.\n- **Well-Posed**: The problem provides sufficient and consistent data to determine the requested quantities. The tasks are clearly defined, leading to a unique solution. The consistency of initial data is verified: $\\frac{\\sigma_1}{\\varepsilon_1} = \\frac{1.575\\ \\mathrm{MPa}}{5.00 \\times 10^{-5}} = 31500\\ \\mathrm{MPa}$ and $\\frac{\\sigma_2}{\\varepsilon_2} = \\frac{3.150\\ \\mathrm{MPa}}{1.00 \\times 10^{-4}} = 31500\\ \\mathrm{MPa}$. The constant ratio confirms the initial linear elastic behavior.\n- **Objective**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n\nStep 3: Verdict and Action.\nThe problem is scientifically sound, self-contained, and well-posed. It is therefore deemed **valid**. A solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Determination of the undamaged Young’s modulus $E_0$.\nIn the initial, strictly undamaged regime, the material behaves as a linear elastic solid. For uniaxial tension under small strains, the relationship between the axial Cauchy stress $\\sigma$ and the axial strain $\\varepsilon$ is given by Hooke's Law:\n$$ \\sigma = E_0 \\varepsilon $$\nwhere $E_0$ is the undamaged Young's modulus. From the two provided measurements in this regime, we can compute $E_0$.\nUsing the first data point $(\\varepsilon_1, \\sigma_1)$:\n$$ E_0 = \\frac{\\sigma_1}{\\varepsilon_1} = \\frac{1.575\\ \\mathrm{MPa}}{5.00 \\times 10^{-5}} = 31500\\ \\mathrm{MPa} $$\nUsing the second data point $(\\varepsilon_2, \\sigma_2)$:\n$$ E_0 = \\frac{\\sigma_2}{\\varepsilon_2} = \\frac{3.150\\ \\mathrm{MPa}}{1.00 \\times 10^{-4}} = 31500\\ \\mathrm{MPa} $$\nBoth measurements yield the same value, confirming the consistency of the data. Thus, the undamaged Young's modulus is:\n$$ E_0 = 31500\\ \\mathrm{MPa} = 3.15 \\times 10^{4}\\ \\mathrm{MPa} = 3.15 \\times 10^{10}\\ \\mathrm{Pa} $$\n\nPart 2: Derivation of a closed-form expression for the damage variable $D$.\nThe principle of strain equivalence (PSE) postulates that the strain response of a damaged material is identical to the strain response of the same material in a fictitious undamaged state, provided that the Cauchy stress $\\sigma$ is replaced by an effective stress $\\tilde{\\sigma}$.\nThe constitutive law for the undamaged material is $\\varepsilon = f(\\tilde{\\sigma}, E_0)$. For linear elasticity in one dimension, this is:\n$$ \\varepsilon = \\frac{\\tilde{\\sigma}}{E_0} $$\nThe effective stress $\\tilde{\\sigma}$ is defined in terms of the Cauchy stress $\\sigma$ and the isotropic scalar damage variable $D$ as:\n$$ \\tilde{\\sigma} = \\frac{\\sigma}{1-D} $$\nThis relation reflects that the stress is carried only by the undamaged portion of the material cross-section.\nSubstituting the expression for the effective stress into the undamaged constitutive law gives the constitutive law for the damaged material:\n$$ \\varepsilon = \\frac{1}{E_0} \\left( \\frac{\\sigma}{1-D} \\right) $$\nThis equation relates the measurable quantities, stress $\\sigma$ and strain $\\varepsilon$, to the internal state variable $D$ and the material constant $E_0$. To derive an expression for $D$, we rearrange this equation:\n$$ E_0 (1-D) \\varepsilon = \\sigma $$\n$$ 1-D = \\frac{\\sigma}{E_0 \\varepsilon} $$\nSolving for $D$, we obtain the required closed-form expression:\n$$ D = 1 - \\frac{\\sigma}{E_0 \\varepsilon} $$\nThis expression is valid for any state $(\\sigma, \\varepsilon)$ where damage is present.\n\nPart 3: Evaluation of $D$ at the state $(\\varepsilon^\\star, \\sigma^\\star)$.\nWe now use the derived expression for $D$ and the given values for the damaged state, $(\\varepsilon^\\star, \\sigma^\\star)$, along with the value of $E_0$ determined in Part 1.\nThe given values are:\n$$ \\sigma^\\star = 12.00\\ \\mathrm{MPa} $$\n$$ \\varepsilon^\\star = 1.50 \\times 10^{-3} $$\n$$ E_0 = 31500\\ \\mathrm{MPa} $$\nSubstituting these values into the expression for $D$:\n$$ D = 1 - \\frac{\\sigma^\\star}{E_0 \\varepsilon^\\star} = 1 - \\frac{12.00\\ \\mathrm{MPa}}{(31500\\ \\mathrm{MPa}) \\times (1.50 \\times 10^{-3})} $$\nThe units of MPa in the numerator and denominator cancel, as required for the dimensionless damage variable $D$.\n$$ D = 1 - \\frac{12.00}{31500 \\times 1.50 \\times 10^{-3}} = 1 - \\frac{12.00}{47.25} $$\n$$ D = 1 - 0.25396825... $$\n$$ D \\approx 0.74603175 $$\nThe problem requires the result to be rounded to four significant figures.\n$$ D \\approx 0.7460 $$\nThe value is within the theoretical bounds $D \\in [0,1)$.", "answer": "$$\n\\boxed{0.7460}\n$$", "id": "2675957"}, {"introduction": "Modern solid mechanics heavily relies on computational modeling to predict the behavior of complex materials. This advanced practice challenges you to implement a coupled plasticity-damage model within a standard numerical algorithm. You will see how the Principle of Strain Equivalence provides a powerful and elegant framework for this coupling, where the plastic flow and hardening laws are formulated in the \"effective\" stress space, neatly separating the plastic and damage mechanisms [@problem_id:2675932]. This exercise represents a key step towards developing robust finite element simulations for inelastic materials.", "problem": "Implement a three-dimensional small-strain elastoplastic constitutive update with isotropic hardening and scalar isotropic damage that enforces the Principle of Strain Equivalence (PSE). The update must act on the effective (damage-free) stress space and then map back to the Cauchy stress using a scalar degradation. Your task is to derive, implement, and test a radial return-mapping algorithm for a von Mises (J2) solid with linear isotropic hardening, modified by PSE. All computations must be performed in the small-strain regime, in three dimensions, and all stress-like quantities must be expressed in megapascals (MPa).\n\nFundamental base and definitions to use:\n- Small-strain kinematics with additive decomposition: the total strain increment is applied to the elastic strain and plastic strain additively, with plastic strain remaining deviatoric. Denote the total strain at the end of the step by $\\varepsilon_{n+1}$ and the previously accumulated plastic strain by $\\varepsilon_p^n$.\n- Isotropic linear elasticity in the effective (damage-free) configuration: the effective stress is given by $\\tilde{\\sigma} = \\mathbb{C}_0 : (\\varepsilon - \\varepsilon_p)$, where $\\mathbb{C}_0$ is the fourth-order isotropic elasticity tensor characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$. The Lamé constants are $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$.\n- Deviatoric-hydrostatic split: for any stress tensor $\\sigma$, define the deviatoric part $s = \\sigma - \\dfrac{1}{3} \\operatorname{tr}(\\sigma) \\, \\mathbf{I}$ and the hydrostatic part $\\dfrac{1}{3}\\operatorname{tr}(\\sigma)\\,\\mathbf{I}$, where $\\mathbf{I}$ is the identity tensor.\n- J2 yield function in the effective space: let the von Mises equivalent effective stress be $\\tilde{\\sigma}_{\\mathrm{eq}} = \\sqrt{\\dfrac{3}{2}} \\, \\| \\tilde{s} \\|$, where $\\tilde{s}$ is the deviatoric part of $\\tilde{\\sigma}$ and $\\| \\cdot \\|$ is the Frobenius norm. The yield function is $f(\\tilde{\\sigma}, \\kappa) = \\tilde{\\sigma}_{\\mathrm{eq}} - \\left(\\sigma_{y0} + H \\kappa\\right)$, where $\\kappa$ is the accumulated equivalent plastic strain, $\\sigma_{y0}$ is the initial yield stress, and $H$ is the linear isotropic hardening modulus.\n- Associated flow and consistency in the effective space: when yielding occurs, plastic flow is governed by the associated flow rule and the consistency condition in the effective space, and plastic strain remains deviatoric.\n- Principle of Strain Equivalence (PSE): the Cauchy stress is obtained from the effective stress by a scalar degradation $\\sigma = (1-D)\\, \\tilde{\\sigma}$, where $D \\in [0,1)$ is a scalar damage variable.\n- Damage evolution: define a monotone damage function of the accumulated equivalent plastic strain, $D(\\kappa) = 1 - \\exp(-a \\kappa)$, with damage parameter $a > 0$. Enforce damage irreversibility as $D_{n+1} = \\max\\{D^n, D(\\kappa_{n+1})\\}$.\n\nYou must:\n- Formulate the elastic predictor in the effective space using the trial elastic strain $\\varepsilon_{n+1} - \\varepsilon_p^n$ and compute the trial effective stress $\\tilde{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}_0 : (\\varepsilon_{n+1} - \\varepsilon_p^n)$.\n- Check the trial yield condition in the effective space. If elastic, accept the trial state in the effective space; otherwise, perform a radial return mapping in the effective deviatoric stress space, enforcing the consistency condition for linear isotropic hardening to determine the plastic multiplier increment and the updated internal variables.\n- Update the accumulated equivalent plastic strain $\\kappa_{n+1}$, the plastic strain tensor $\\varepsilon_p^{n+1}$ (deviatoric), and the effective stress $\\tilde{\\sigma}_{n+1}$.\n- Apply PSE to obtain the Cauchy stress $\\sigma_{n+1} = (1 - D_{n+1}) \\tilde{\\sigma}_{n+1}$ with $D_{n+1} = \\max\\{D^n, 1-\\exp(-a \\kappa_{n+1})\\}$.\n- Use three-dimensional tensors and compute outputs in megapascals. Strains are dimensionless.\n\nMaterial parameters (use these constants for all test cases):\n- Young’s modulus $E = 210000$ (MPa).\n- Poisson’s ratio $\\nu = 0.3$.\n- Initial yield stress $\\sigma_{y0} = 250$ (MPa).\n- Isotropic hardening modulus $H = 1000$ (MPa).\n- Damage parameter $a = 5$ (dimensionless).\n\nTest suite:\nEach test case provides $(\\varepsilon_{n+1}, \\varepsilon_p^n, \\kappa^n, D^n)$, where strains are symmetric $3 \\times 3$ tensors. The prior plastic strain $\\varepsilon_p^n$ is deviatoric and, when $\\kappa^n > 0$, is chosen consistent with $\\kappa^n$ in a uniaxial plasticity direction as $\\varepsilon_p^n = \\kappa^n \\, \\mathrm{diag}(1, -\\tfrac{1}{2}, -\\tfrac{1}{2})$, which satisfies $\\operatorname{tr}(\\varepsilon_p^n) = 0$ and $\\|\\varepsilon_p^n\\| = \\kappa^n \\sqrt{\\tfrac{3}{2}}$. The prior damage is $D^n = 1 - \\exp(-a \\kappa^n)$.\n\n- Test case $1$ (elastic regime):\n  - $\\varepsilon_{n+1} = \\mathrm{diag}(0.0001, 0, 0)$.\n  - $\\kappa^n = 0$.\n  - $\\varepsilon_p^n = \\mathbf{0}$.\n  - $D^n = 0$.\n- Test case $2$ (onset of plasticity):\n  - $\\varepsilon_{n+1} = \\mathrm{diag}(0.002, 0, 0)$.\n  - $\\kappa^n = 0$.\n  - $\\varepsilon_p^n = \\mathbf{0}$.\n  - $D^n = 0$.\n- Test case $3$ (continued plasticity from a pre-plastic state):\n  - $\\varepsilon_{n+1} = \\mathrm{diag}(0.001, 0, 0)$.\n  - $\\kappa^n = 0.05$.\n  - $\\varepsilon_p^n = 0.05 \\, \\mathrm{diag}(1, -\\tfrac{1}{2}, -\\tfrac{1}{2})$.\n  - $D^n = 1 - \\exp(-a \\cdot 0.05)$.\n- Test case $4$ (high prior damage, small additional loading):\n  - $\\varepsilon_{n+1} = \\mathrm{diag}(0.0002, 0, 0)$.\n  - $\\kappa^n = 0.3$.\n  - $\\varepsilon_p^n = 0.3 \\, \\mathrm{diag}(1, -\\tfrac{1}{2}, -\\tfrac{1}{2})$.\n  - $D^n = 1 - \\exp(-a \\cdot 0.3)$.\n- Test case $5$ (boundary case: zero strain, virgin state):\n  - $\\varepsilon_{n+1} = \\mathbf{0}$.\n  - $\\kappa^n = 0$.\n  - $\\varepsilon_p^n = \\mathbf{0}$.\n  - $D^n = 0$.\n\nProgram requirements and outputs:\n- Implement the constitutive update described above, operating in the effective space for elasticity and plastic return mapping, then apply PSE to obtain the Cauchy stress.\n- For each test case, compute the updated Cauchy stress tensor $\\sigma_{n+1}$, the updated damage $D_{n+1}$, and the updated accumulated equivalent plastic strain $\\kappa_{n+1}$.\n- Report, for each test case, the list $[\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, D_{n+1}, \\kappa_{n+1}]$, where $\\sigma_{ii}$ are in megapascals (MPa), and $D_{n+1}$ and $\\kappa_{n+1}$ are dimensionless.\n- Round each reported number to $6$ decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list of the five per-case lists, enclosed in square brackets (for example, $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[\\dots],\\dots]$), with no embedded spaces.\n\nNo user input is required. The program must be completely self-contained and run as-is. Ensure numerical robustness by handling the case where the trial effective deviatoric stress vanishes to avoid division by zero. All mathematical steps must be derived from the base definitions above, without using any pre-supplied shortcut formulas in the problem statement. Express all stress outputs in MPa and round to $6$ decimals as specified.", "solution": "The posed problem is a standard exercise in computational inelasticity, requiring the implementation of a constitutive update for a material exhibiting J2 plasticity with linear isotropic hardening, coupled with isotropic damage. The coupling is prescribed by the Principle of Strain Equivalence (PSE), which postulates that the constitutive response in the effective (undamaged) configuration is identical to that of a virgin material. The Cauchy stress is then recovered by a scalar degradation of the effective stress. We shall proceed by first deriving the return-mapping algorithm in the effective space and then applying the damage model.\n\nThe algorithmic framework is an elastic-predictor, plastic-corrector scheme. Given the state at step $n$ (plastic strain $\\varepsilon_p^n$, accumulated equivalent plastic strain $\\kappa^n$, damage $D^n$) and the total strain $\\varepsilon_{n+1}$ at the end of the increment, we seek to find the state at step $n+1$.\n\nThe fundamental material properties are Young's modulus $E$, Poisson's ratio $\\nu$, initial yield stress $\\sigma_{y0}$, hardening modulus $H$, and damage parameter $a$. From $E$ and $\\nu$, we define the Lamé constants, which govern the initial isotropic elastic response:\n$$ \\mu = \\frac{E}{2(1+\\nu)} $$\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\n\n**1. Elastic Predictor Step**\n\nWe first assume the entire strain increment is elastic. The trial elastic strain at the end of the step is:\n$$ \\varepsilon_{el}^{\\mathrm{tr}} = \\varepsilon_{n+1} - \\varepsilon_p^n $$\nThe trial effective stress, $\\tilde{\\sigma}^{\\mathrm{tr}}$, is computed using the undamaged isotropic elasticity tensor, $\\mathbb{C}_0$:\n$$ \\tilde{\\sigma}^{\\mathrm{tr}} = \\mathbb{C}_0 : \\varepsilon_{el}^{\\mathrm{tr}} = \\lambda \\operatorname{tr}(\\varepsilon_{el}^{\\mathrm{tr}}) \\mathbf{I} + 2\\mu \\varepsilon_{el}^{\\mathrm{tr}} $$\nwhere $\\mathbf{I}$ is the second-order identity tensor. Since plastic strain $\\varepsilon_p^n$ is deviatoric, $\\operatorname{tr}(\\varepsilon_p^n) = 0$, leading to $\\operatorname{tr}(\\varepsilon_{el}^{\\mathrm{tr}}) = \\operatorname{tr}(\\varepsilon_{n+1})$.\n\nThe trial effective stress is decomposed into its hydrostatic and deviatoric parts:\n$$ \\tilde{\\sigma}^{\\mathrm{tr}} = \\tilde{p}^{\\mathrm{tr}}\\mathbf{I} + \\tilde{s}^{\\mathrm{tr}} $$\nwhere $\\tilde{p}^{\\mathrm{tr}} = \\frac{1}{3}\\operatorname{tr}(\\tilde{\\sigma}^{\\mathrm{tr}})$ and $\\tilde{s}^{\\mathrm{tr}}$ is the deviatoric part. The trial von Mises equivalent effective stress is then:\n$$ \\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\tilde{s}^{\\mathrm{tr}} : \\tilde{s}^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2}} \\| \\tilde{s}^{\\mathrm{tr}} \\|_F $$\n\n**2. Yield Criterion Check**\n\nWe evaluate the yield function, $f$, using the trial effective stress and the previous hardening state:\n$$ f^{\\mathrm{tr}} = \\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}} - (\\sigma_{y0} + H \\kappa^n) $$\nIf $f^{\\mathrm{tr}} \\leq 0$, the assumption was correct; the step is purely elastic. The final state variables are the trial ones:\n$$ \\tilde{\\sigma}_{n+1} = \\tilde{\\sigma}^{\\mathrm{tr}} \\quad, \\quad \\varepsilon_p^{n+1} = \\varepsilon_p^n \\quad, \\quad \\kappa_{n+1} = \\kappa^n $$\n\n**3. Plastic Corrector Step (Radial Return)**\n\nIf $f^{\\mathrm{tr}} > 0$, plastic flow occurs. We must enforce the consistency condition, $f(\\tilde{\\sigma}_{n+1}, \\kappa_{n+1}) = 0$, at the end of the step. The plastic flow is governed by an associated flow rule in the effective space. The integrated form gives the plastic strain increment $\\Delta\\varepsilon_p$:\n$$ \\Delta\\varepsilon_p = \\varepsilon_p^{n+1} - \\varepsilon_p^n = \\Delta\\gamma \\frac{\\partial f}{\\partial \\tilde{\\sigma}} \\bigg|_{\\tilde{\\sigma}_{n+1}} $$\nwhere $\\Delta\\gamma \\ge 0$ is the plastic multiplier increment. The normal to the yield surface is:\n$$ \\mathbf{N}_{n+1} = \\frac{\\partial f}{\\partial \\tilde{\\sigma}} \\bigg|_{\\tilde{\\sigma}_{n+1}} = \\frac{3}{2} \\frac{\\tilde{s}_{n+1}}{\\tilde{\\sigma}_{\\mathrm{eq}, n+1}} $$\nThe updated effective stress is related to the trial stress by $\\tilde{\\sigma}_{n+1} = \\tilde{\\sigma}^{\\mathrm{tr}} - \\mathbb{C}_0 : \\Delta\\varepsilon_p$. Since $\\Delta\\varepsilon_p$ is deviatoric (as $\\mathbf{N}_{n+1}$ is deviatoric), the hydrostatic part of the effective stress is unchanged: $\\operatorname{tr}(\\tilde{\\sigma}_{n+1}) = \\operatorname{tr}(\\tilde{\\sigma}^{\\mathrm{tr}})$. The deviatoric part updates as:\n$$ \\tilde{s}_{n+1} = \\tilde{s}^{\\mathrm{tr}} - 2\\mu \\Delta\\varepsilon_p = \\tilde{s}^{\\mathrm{tr}} - 2\\mu \\Delta\\gamma \\mathbf{N}_{n+1} $$\nSubstituting the expression for $\\mathbf{N}_{n+1}$ shows $\\tilde{s}_{n+1}$ is collinear with $\\tilde{s}^{\\mathrm{tr}}$. This is the \"radial return\" property. Taking the norm of the deviatoric update equation leads to:\n$$ \\tilde{\\sigma}_{\\mathrm{eq}, n+1} = \\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}} - 3\\mu \\Delta\\gamma $$\nThe consistency condition at step $n+1$ requires $\\tilde{\\sigma}_{\\mathrm{eq}, n+1} = \\sigma_{y0} + H \\kappa_{n+1}$. For J2 plasticity, the increment in accumulated plastic strain is identical to the plastic multiplier, $\\Delta\\kappa = \\Delta\\gamma$. Thus, $\\kappa_{n+1} = \\kappa^n + \\Delta\\gamma$. Substituting this into the consistency condition gives:\n$$ \\tilde{\\sigma}_{\\mathrm{eq}, n+1} = \\sigma_{y0} + H(\\kappa^n + \\Delta\\gamma) $$\nSolving the two equations for $\\tilde{\\sigma}_{\\mathrm{eq}, n+1}$ and $\\Delta\\gamma$:\n$$ \\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}} - 3\\mu \\Delta\\gamma = \\sigma_{y0} + H \\kappa^n + H \\Delta\\gamma $$\nRearranging for $\\Delta\\gamma$:\n$$ \\Delta\\gamma = \\frac{\\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}} - (\\sigma_{y0} + H\\kappa^n)}{3\\mu + H} = \\frac{f^{\\mathrm{tr}}}{3\\mu + H} $$\nWith $\\Delta\\gamma$ known, we update the internal variables:\n$$ \\kappa_{n+1} = \\kappa^n + \\Delta\\gamma $$\nThe updated effective deviatoric stress is found by scaling the trial deviatoric stress back to the new yield surface:\n$$ \\tilde{s}_{n+1} = \\tilde{s}^{\\mathrm{tr}} \\frac{\\tilde{\\sigma}_{\\mathrm{eq}, n+1}}{\\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}}} = \\tilde{s}^{\\mathrm{tr}} \\frac{\\sigma_{y0} + H \\kappa_{n+1}}{\\tilde{\\sigma}_{\\mathrm{eq}}^{\\mathrm{tr}}} $$\nThe full effective stress tensor is then recomposed:\n$$ \\tilde{\\sigma}_{n+1} = \\tilde{s}_{n+1} + \\frac{1}{3}\\operatorname{tr}(\\tilde{\\sigma}^{\\mathrm{tr}})\\mathbf{I} $$\nThe plastic strain tensor is updated:\n$$ \\varepsilon_p^{n+1} = \\varepsilon_p^n + \\Delta\\varepsilon_p = \\varepsilon_p^n + \\Delta\\gamma \\sqrt{\\frac{3}{2}} \\frac{\\tilde{s}^{\\mathrm{tr}}}{\\|\\tilde{s}^{\\mathrm{tr}}\\|_F} $$\n\n**4. Damage and Cauchy Stress Update**\n\nFinally, we apply the PSE. First, the damage variable $D$ is updated based on the new accumulated plastic strain $\\kappa_{n+1}$:\n$$ D_{\\mathrm{trial}} = 1 - \\exp(-a \\kappa_{n+1}) $$\nDamage is an irreversible process, so we enforce:\n$$ D_{n+1} = \\max(D^n, D_{\\mathrm{trial}}) $$\nThe Cauchy stress $\\sigma_{n+1}$ is then obtained by degrading the effective stress:\n$$ \\sigma_{n+1} = (1 - D_{n+1}) \\tilde{\\sigma}_{n+1} $$\nThis completes the constitutive update for one increment. This algorithm is implemented for each of the provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the constitutive update for all test cases.\n    \"\"\"\n\n    # Material parameters (MPa)\n    E = 210000.0\n    nu = 0.3\n    sigy0 = 250.0\n    H = 1000.0\n    a = 5.0\n\n    # Test cases\n    test_cases = [\n        # Test case 1 (elastic regime)\n        {\n            \"eps_n1\": np.diag([0.0001, 0, 0]),\n            \"kappa_n\": 0.0,\n            \"eps_p_n\": np.zeros((3, 3)),\n            \"D_n\": 0.0\n        },\n        # Test case 2 (onset of plasticity)\n        {\n            \"eps_n1\": np.diag([0.002, 0, 0]),\n            \"kappa_n\": 0.0,\n            \"eps_p_n\": np.zeros((3, 3)),\n            \"D_n\": 0.0\n        },\n        # Test case 3 (continued plasticity)\n        {\n            \"eps_n1\": np.diag([0.001, 0, 0]),\n            \"kappa_n\": 0.05,\n            \"eps_p_n\": 0.05 * np.diag([1.0, -0.5, -0.5]),\n            \"D_n\": 1.0 - np.exp(-a * 0.05)\n        },\n        # Test case 4 (high prior damage, small load)\n        {\n            \"eps_n1\": np.diag([0.0002, 0, 0]),\n            \"kappa_n\": 0.3,\n            \"eps_p_n\": 0.3 * np.diag([1.0, -0.5, -0.5]),\n            \"D_n\": 1.0 - np.exp(-a * 0.3)\n        },\n        # Test case 5 (zero strain, virgin state)\n        {\n            \"eps_n1\": np.zeros((3, 3)),\n            \"kappa_n\": 0.0,\n            \"eps_p_n\": np.zeros((3, 3)),\n            \"D_n\": 0.0\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        sigma_n1, D_n1, kappa_n1 = constitutive_update(\n            case[\"eps_n1\"], case[\"eps_p_n\"], case[\"kappa_n\"], case[\"D_n\"],\n            E, nu, sigy0, H, a\n        )\n        \n        # Extract diagonal stress components and format the result\n        result_list = [\n            round(sigma_n1[0, 0], 6),\n            round(sigma_n1[1, 1], 6),\n            round(sigma_n1[2, 2], 6),\n            round(D_n1, 6),\n            round(kappa_n1, 6)\n        ]\n        results.append(result_list)\n    \n    # Format the final output string as a list of lists.\n    final_output = f\"[{','.join([f'[{\",\".join(map(str, r))}]' for r in results])}]\"\n    print(final_output)\n\ndef constitutive_update(eps_n1, eps_p_n, kappa_n, D_n, E, nu, sigy0, H, a):\n    \"\"\"\n    Performs a 3D small-strain elastoplastic-damage constitutive update.\n    \n    Args:\n        eps_n1 (np.ndarray): Total strain tensor at step n+1.\n        eps_p_n (np.ndarray): Plastic strain tensor at step n.\n        kappa_n (float): Accumulated equivalent plastic strain at step n.\n        D_n (float): Damage variable at step n.\n        E, nu, sigy0, H, a: Material parameters.\n    \n    Returns:\n        tuple: (sigma_n1, D_n1, kappa_n1) - updated state variables.\n    \"\"\"\n    # 1. Material constants\n    mu = E / (2 * (1 + nu))\n    lambda_ = E * nu / ((1 + nu) * (1 - 2 * nu))\n    I = np.identity(3)\n    \n    # 2. Elastic predictor step\n    # Trial elastic strain\n    eps_el_tr = eps_n1 - eps_p_n\n    \n    # Trial effective stress\n    tr_eps_el_tr = np.trace(eps_el_tr)\n    sigma_tilde_tr = lambda_ * tr_eps_el_tr * I + 2 * mu * eps_el_tr\n    \n    # Trial deviatoric effective stress and its norm\n    p_tilde_tr = np.trace(sigma_tilde_tr) / 3.0\n    s_tilde_tr = sigma_tilde_tr - p_tilde_tr * I\n    norm_s_tilde_tr = np.linalg.norm(s_tilde_tr, 'fro')\n    \n    # 3. Yield criterion check\n    # Handle the case of zero deviatoric stress to avoid division by zero\n    if norm_s_tilde_tr < 1e-12:\n        sigma_eq_tilde_tr = 0.0\n    else:\n        sigma_eq_tilde_tr = np.sqrt(3.0 / 2.0) * norm_s_tilde_tr\n        \n    sigma_y_n = sigy0 + H * kappa_n\n    f_tr = sigma_eq_tilde_tr - sigma_y_n\n    \n    # 4. Update state variables: elastic or plastic step\n    if f_tr <= 1e-9:  # Elastic step (with tolerance)\n        sigma_tilde_n1 = sigma_tilde_tr\n        kappa_n1 = kappa_n\n        # eps_p_n1 is eps_p_n, not needed further\n    else:  # Plastic corrector step (radial return)\n        # Calculate plastic multiplier increment\n        delta_gamma = f_tr / (3 * mu + H)\n        \n        # Update accumulated plastic strain\n        kappa_n1 = kappa_n + delta_gamma\n        \n        # Update yield stress\n        sigma_y_n1 = sigy0 + H * kappa_n1\n        \n        # Update effective deviatoric stress (radial return)\n        s_tilde_n1 = s_tilde_tr * (sigma_y_n1 / sigma_eq_tilde_tr)\n        \n        # Recompose effective stress tensor\n        sigma_tilde_n1 = s_tilde_n1 + p_tilde_tr * I\n        \n        # (Optional) Update plastic strain tensor if needed for subsequent steps\n        # n_tr = s_tilde_tr / norm_s_tilde_tr\n        # delta_eps_p = delta_gamma * np.sqrt(3.0 / 2.0) * n_tr\n        # eps_p_n1 = eps_p_n + delta_eps_p\n\n    # 5. Damage and Cauchy stress update\n    D_trial = 1.0 - np.exp(-a * kappa_n1)\n    D_n1 = max(D_n, D_trial)\n    \n    sigma_n1 = (1.0 - D_n1) * sigma_tilde_n1\n    \n    return sigma_n1, D_n1, kappa_n1\n\nsolve()\n\n```", "id": "2675932"}]}