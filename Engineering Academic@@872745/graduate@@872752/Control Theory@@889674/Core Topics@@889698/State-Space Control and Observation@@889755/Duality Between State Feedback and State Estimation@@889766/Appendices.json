{"hands_on_practices": [{"introduction": "The principle of duality provides a powerful intellectual shortcut, allowing us to solve two seemingly different problems—state-feedback control and state estimation—with a single theoretical framework. This first practice invites you to experience this symmetry firsthand by translating a standard pole-placement controller design technique into its dual form for designing a state observer [@problem_id:2693646]. By working through the mechanics, you will gain a concrete understanding of how the controllability of a pair $(A, B)$ mirrors the observability of its dual, $(A^\\top, C^\\top)$.", "problem": "Consider a linear time-invariant system with state-space model given by $\\dot{x} = A x + B u$ and $y = C x$, where $A \\in \\mathbb{R}^{n \\times n}$, $B \\in \\mathbb{R}^{n \\times m}$, and $C \\in \\mathbb{R}^{p \\times n}$. Assume $(A,B)$ is controllable and $(A,C)$ is observable. In the state-feedback control problem with $u = -K x$, a standard design method for $K$ in the single-input case is to choose $K$ such that the characteristic polynomial of $A - B K$ matches a desired monic polynomial by coefficient matching, guaranteeing closed-loop stability and transient performance according to the chosen polynomial.\n\nTask:\n1. Construct the dual estimation method for the observer gain $L$ in the state estimation problem $\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$ by appealing to the principle of duality. Explicitly relate the estimator gain $L$ to a state-feedback gain computed on an appropriate dual system using the same coefficient-matching principle.\n\n2. Apply your dual construction to the following specific system and verify correctness:\n   - Let $A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}$, $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, and $C = \\begin{bmatrix} 1 & 0 \\end{bmatrix}$.\n   - Using state-feedback control design by characteristic polynomial matching, place the controller poles at $s = -2$ and $s = -5$.\n   - Using your dual estimator design method, place the observer error dynamics poles at $s = -6$ and $s = -7$.\n   - Verify that the designed estimator gain $L$ yields observer error dynamics $\\dot{e} = (A - L C) e$ with the specified poles, and that, with the output-feedback law $u = -K \\hat{x}$, the overall closed-loop augmented system exhibits the separation structure in which the eigenvalues are the union of the controller poles and observer poles.\n\nExpress your final answer as the entries of the estimator gain $L$ arranged in a single row vector, i.e., list the components of $L$ in order as a row matrix. No rounding is required and no units are involved. The final answer must be only this row vector.", "solution": "The problem is well-posed and grounded in the fundamental principles of linear control theory, specifically concerning state-space design methods. It is complete, consistent, and requires the application of the duality principle, a standard and verifiable concept. Therefore, the problem is valid and I will proceed with its solution.\n\nThe solution is divided into two parts as requested. First, the theoretical construction of the dual estimation method is presented. Second, this method is applied to the given system, and the results are verified.\n\n**1. Dual Construction of the Observer Gain**\n\nThe problem of state-feedback control for a linear time-invariant system $\\dot{x} = A x + B u$ involves finding a state-feedback gain matrix $K$ such that the control law $u = -K x$ places the eigenvalues of the closed-loop system matrix, $A - B K$, at desired locations in the complex plane. The characteristic polynomial of the closed-loop system is given by $\\det(sI - (A - B K))$. This pole placement is possible if and only if the pair $(A, B)$ is controllable.\n\nThe problem of state estimation, or observer design, is to construct an estimate $\\hat{x}$ of the state $x$ using the system's output $y$. The Luenberger observer is described by the dynamics $\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$, where $L$ is the observer gain matrix. The state estimation error is defined as $e = x - \\hat{x}$. The dynamics of this error are found by subtracting the observer dynamics from the system dynamics:\n$$ \\dot{e} = \\dot{x} - \\dot{\\hat{x}} = (A x + B u) - (A \\hat{x} + B u + L(C x - C \\hat{x})) = A(x - \\hat{x}) - L C (x - \\hat{x}) = (A - L C)e $$\nThe goal of observer design is to choose $L$ such that the error $e(t)$ converges to zero. This is achieved by placing the eigenvalues of the error dynamics matrix, $A - L C$, at desired stable locations. The characteristic polynomial of the error dynamics is $\\det(sI - (A - L C))$. This pole placement is possible if and only if the pair $(A, C)$ is observable.\n\nThe principle of duality in control theory connects the state-feedback problem with the observer design problem. The eigenvalues of a matrix are identical to the eigenvalues of its transpose. Therefore, the eigenvalues of $A - L C$ are the same as the eigenvalues of $(A - L C)^T = A^T - C^T L^T$.\n\nNow, consider a \"dual\" system described by the state-space pair $(A_{dual}, B_{dual}) = (A^T, C^T)$. For this dual system, the state-feedback pole placement problem is to find a gain $K_{dual}$ such that the eigenvalues of the dual closed-loop matrix, $A_{dual} - B_{dual} K_{dual} = A^T - C^T K_{dual}$, are at desired locations.\n\nBy comparing the matrix for the observer error characteristic equation, $A^T - C^T L^T$, with the matrix for the dual control problem, $A^T - C^T K_{dual}$, we establish a direct correspondence. If we set the observer gain $L$ such that $L^T = K_{dual}$, then the observer poles (eigenvalues of $A - L C$) will be identical to the closed-loop poles of the dual system (eigenvalues of $A^T - C^T K_{dual}$).\n\nThus, the dual estimation method is as follows:\nTo find the observer gain $L$ that places the eigenvalues of $(A - L C)$ at a set of desired locations $\\{p_1, \\dots, p_n\\}$, one solves the equivalent state-feedback pole placement problem for the dual system $(A^T, C^T)$. That is, find the feedback gain $K_{dual}$ that places the eigenvalues of $(A^T - C^T K_{dual})$ at the same locations $\\{p_1, \\dots, p_n\\}$. The required observer gain is then given by $L = K_{dual}^T$.\n\nThe condition for the existence of such a $K_{dual}$ is that the pair $(A^T, C^T)$ must be controllable. A fundamental theorem of linear systems states that $(A, C)$ is observable if and only if $(A^T, C^T)$ is controllable. This confirms the consistency of the duality principle.\n\n**2. Application and Verification**\n\nWe are given the system with matrices:\n$$ A = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1 & 0 \\end{bmatrix} $$\n\nFirst, as a preliminary step, we design the state-feedback controller gain $K = \\begin{bmatrix} k_1 & k_2 \\end{bmatrix}$ to place the poles at $s = -2$ and $s = -5$. The desired characteristic polynomial is $p_c(s) = (s+2)(s+5) = s^2 + 7s + 10$.\nThe closed-loop matrix is $A - BK$:\n$$ A - BK = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1 & k_2 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -2 - k_1 & -3 - k_2 \\end{bmatrix} $$\nThe characteristic polynomial is $\\det(sI - (A-BK)) = s(s+3+k_2) - (-(2+k_1)) = s^2 + (3+k_2)s + (2+k_1)$.\nMatching coefficients with $s^2 + 7s + 10$:\n$3+k_2 = 7 \\implies k_2 = 4$.\n$2+k_1 = 10 \\implies k_1 = 8$.\nSo, the controller gain is $K = \\begin{bmatrix} 8 & 4 \\end{bmatrix}$.\n\nNext, we design the observer gain $L$ using the dual method. The desired observer error poles are at $s = -6$ and $s = -7$. The desired observer characteristic polynomial is $p_o(s) = (s+6)(s+7) = s^2 + 13s + 42$.\nWe construct the dual system $(A^T, C^T)$:\n$$ A^T = \\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix}, \\quad C^T = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} $$\nWe seek a dual feedback gain $K_{dual} = \\begin{bmatrix} k_{d1} & k_{d2} \\end{bmatrix}$ to place the poles of the dual system at $s = -6$ and $s = -7$.\nThe dual closed-loop matrix is $A^T - C^T K_{dual}$:\n$$ A^T - C^T K_{dual} = \\begin{bmatrix} 0 & -2 \\\\ 1 & -3 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\begin{bmatrix} k_{d1} & k_{d2} \\end{bmatrix} = \\begin{bmatrix} -k_{d1} & -2-k_{d2} \\\\ 1 & -3 \\end{bmatrix} $$\nIts characteristic polynomial is $\\det(sI - (A^T-C^T K_{dual})) = (s+k_{d1})(s+3) - (-(2+k_{d2})) = s^2 + (3+k_{d1})s + (3k_{d1} + 2 + k_{d2})$.\nMatching coefficients with $p_o(s) = s^2 + 13s + 42$:\n$s^1$: $3+k_{d1} = 13 \\implies k_{d1} = 10$.\n$s^0$: $3k_{d1} + 2 + k_{d2} = 42 \\implies 3(10) + 2 + k_{d2} = 42 \\implies 32 + k_{d2} = 42 \\implies k_{d2} = 10$.\nThe dual gain is $K_{dual} = \\begin{bmatrix} 10 & 10 \\end{bmatrix}$.\nThe observer gain is $L = K_{dual}^T = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$.\n\n**Verification:**\nWe verify that this gain $L$ places the observer poles correctly. The error dynamics matrix is $A-LC$:\n$$ A - LC = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix} - \\begin{bmatrix} 10 & 0 \\\\ 10 & 0 \\end{bmatrix} = \\begin{bmatrix} -10 & 1 \\\\ -12 & -3 \\end{bmatrix} $$\nThe characteristic polynomial is $\\det(sI - (A-LC)) = \\det \\begin{bmatrix} s+10 & -1 \\\\ 12 & s+3 \\end{bmatrix} = (s+10)(s+3) - (-12) = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$.\nThis polynomial has roots at $s = -6$ and $s = -7$, which are the desired observer poles. The verification is successful.\n\nFinally, we verify the separation principle for the combined system with state-feedback from the estimated state, $u = -K\\hat{x}$. The state equations for the augmented system comprising the plant state $x$ and the estimation error $e$ are:\n$$ \\dot{x} = A x + B u = A x - B K \\hat{x} = A x - B K(x - e) = (A - B K)x + B K e $$\n$$ \\dot{e} = (A - L C)e $$\nIn matrix form:\n$$ \\frac{d}{dt} \\begin{bmatrix} x \\\\ e \\end{bmatrix} = \\begin{bmatrix} A-BK & BK \\\\ 0 & A-LC \\end{bmatrix} \\begin{bmatrix} x \\\\ e \\end{bmatrix} $$\nThe system matrix is block upper-triangular. Therefore, its set of eigenvalues is the union of the eigenvalues of the diagonal blocks, $A - BK$ and $A - LC$. The eigenvalues of $A-BK$ are the controller poles $\\{-2, -5\\}$, and the eigenvalues of $A-LC$ are the observer poles $\\{-6, -7\\}$. The eigenvalues of the complete output-feedback system are indeed $\\{-2, -5, -6, -7\\}$. This confirms the separation structure.\n\nThe required final answer is the estimator gain $L$ expressed as a row vector.\nWe found $L = \\begin{bmatrix} 10 \\\\ 10 \\end{bmatrix}$. The corresponding row vector is $\\begin{pmatrix} 10 & 10 \\end{pmatrix}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n10 & 10\n\\end{pmatrix}\n}\n$$", "id": "2693646"}, {"introduction": "While pole placement grants us the freedom to assign observer error dynamics arbitrarily, this raises a crucial design question: where *should* the poles be placed? This exercise explores the boundary between deterministic design and optimal estimation [@problem_id:2748160]. You will first use pole placement to achieve a desired performance and then contrast this with the result from a Kalman filter, which places poles optimally based on the system's noise characteristics, providing insight into the trade-offs inherent in observer design.", "problem": "Consider a continuous-time, linear, time-invariant system with state-space matrices $A \\in \\mathbb{R}^{n \\times n}$ and $C \\in \\mathbb{R}^{m \\times n}$. The state observer error dynamics under a static output injection gain $L \\in \\mathbb{R}^{n \\times m}$ are governed by the matrix $A - L C$.\n\nPart 1. Starting only from the definitions of observability and controllability and the Popov–Belevitch–Hautus test, derive why, for any observable pair $(A,C)$ and for any monic polynomial $p(\\lambda) = \\lambda^{n} + \\alpha_{n-1} \\lambda^{n-1} + \\cdots + \\alpha_{1} \\lambda + \\alpha_{0}$ with roots strictly in the open left half-plane, there exists an output injection matrix $L$ such that the characteristic polynomial of $A - L C$ equals $p(\\lambda)$. Your derivation must proceed from first principles and fundamental definitions, without invoking pre-packaged formulas.\n\nPart 2. Specialize to the second-order system with\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\nChoose the desired eigenvalues for $A - L C$ to be $\\lambda_{1} = -2$ and $\\lambda_{2} = -5$. Determine explicitly the entries of $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ that realize these eigenvalues by direct computation of the characteristic polynomial of $A - L C$ and coefficient matching.\n\nPart 3. For the same system in Part $2$, consider the stochastic state-space model\n$$\n\\dot{x}(t) = A x(t) + w(t), \\quad y(t) = C x(t) + v(t),\n$$\nwith zero-mean, white, Gaussian process noise $w(t)$ and measurement noise $v(t)$, mutually independent, with covariances $\\mathbb{E}[w(t) w(\\tau)^{\\top}] = Q \\delta(t - \\tau)$ and $\\mathbb{E}[v(t) v(\\tau)] = R \\delta(t - \\tau)$, where\n$$\nQ = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \\quad R = 1.\n$$\nCompute the steady-state Kalman filter gain $L_{\\mathrm{KF}} \\in \\mathbb{R}^{2 \\times 1}$ by solving the continuous-time algebraic Riccati equation for the error covariance $P \\in \\mathbb{R}^{2 \\times 2}$ and evaluating $L_{\\mathrm{KF}} = P C^{\\top} R^{-1}$. Then, in words, contrast the conceptual basis of the eigenvalue placement gain in Part $2$ with the steady-state Kalman gain derived here.\n\nAnswer specification: Report your final answer as a row matrix containing the four entries $\\ell_{1}$, $\\ell_{2}$, $k_{1}$, $k_{2}$, where $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$ is the eigenvalue placement gain from Part $2$ and $L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$ is the Kalman gain from Part $3$. Provide the exact values; do not round.", "solution": "The problem is subjected to validation and found to be well-posed, scientifically sound, and internally consistent. It is a standard problem in linear systems theory and optimal estimation. We shall proceed with the solution.\n\nPart 1: Derivation of Observer Pole Placement\nThe objective is to demonstrate that for an observable pair $(A,C)$, where $A \\in \\mathbb{R}^{n \\times n}$ and $C \\in \\mathbb{R}^{m \\times n}$, it is always possible to find an output injection gain $L \\in \\mathbb{R}^{n \\times m}$ such that the characteristic polynomial of the observer error dynamics matrix, $A-LC$, matches any specified monic polynomial $p(\\lambda)$ of degree $n$. This property is known as pole placement or pole assignment for observers. The derivation will rely on the principle of duality in control theory.\n\nThe poles of the observer are the eigenvalues of the matrix $A-LC$. The characteristic polynomial of $A-LC$ is given by $\\det(\\lambda I - (A-LC))$. A fundamental property of determinants is that $\\det(M) = \\det(M^{\\top})$ for any square matrix $M$. Therefore, the eigenvalues of $A-LC$ are identical to the eigenvalues of its transpose, $(A-LC)^{\\top} = A^{\\top} - C^{\\top}L^{\\top}$.\n\nLet us define a \"dual\" system. For the primal system governed by matrices $(A, C)$, we define a dual system with state matrix $A' = A^{\\top}$ and input matrix $B' = C^{\\top}$. We also define a state feedback gain for this dual system as $K' = L^{\\top}$. The closed-loop matrix for this dual system under state feedback is $A' - B'K' = A^{\\top} - C^{\\top}L^{\\top}$.\n\nFrom this construction, it is evident that the problem of finding an observer gain $L$ to place the eigenvalues of $A-LC$ at desired locations is mathematically equivalent to the problem of finding a state-feedback gain $K' = L^{\\top}$ to place the eigenvalues of $A^{\\top} - C^{\\top}L^{\\top}$ at the same locations. The latter is the standard state-feedback pole placement problem for the system $(A', B') = (A^{\\top}, C^{\\top})$.\n\nA cornerstone theorem of control theory states that arbitrary pole placement via state feedback is possible if and only if the system is controllable. Therefore, if we can prove that the dual system $(A^{\\top}, C^{\\top})$ is controllable, then we can always find a gain $K'$ (and thus an $L$) to achieve any desired characteristic polynomial. The linkage between the observability of the primal system and the controllability of the dual system is established using the Popov–Belevitch–Hautus (PBH) test.\n\nThe PBH test for observability states that the pair $(A, C)$ is observable if and only if the matrix\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\nhas full column rank $n$ for all complex numbers $\\lambda \\in \\mathbb{C}$.\n\nThe problem statement posits that the pair $(A,C)$ is observable. Thus, for any $\\lambda \\in \\mathbb{C}$,\n$$\n\\mathrm{rank} \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix} = n.\n$$\nSince the rank of a matrix is equal to the rank of its transpose, we have\n$$\n\\mathrm{rank} \\left( \\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}^{\\top} \\right) = \\mathrm{rank} \\begin{pmatrix} (A - \\lambda I)^{\\top} & C^{\\top} \\end{pmatrix} = \\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I & C^{\\top} \\end{pmatrix} = n.\n$$\nThis last condition, $\\mathrm{rank} \\begin{pmatrix} A^{\\top} - \\lambda I & C^{\\top} \\end{pmatrix} = n$ for all $\\lambda \\in \\mathbb{C}$, is precisely the PBH test for controllability of the pair $(A^{\\top}, C^{\\top})$.\n\nTherefore, if the pair $(A,C)$ is observable, the pair $(A^{\\top}, C^{\\top})$ is controllable. By the state-feedback pole placement theorem, for a controllable system, a gain matrix $K'$ can be found to assign the eigenvalues of the closed-loop system $A^{\\top}-C^{\\top}K'$ to any desired set of locations. These locations are the roots of the specified monic polynomial $p(\\lambda)$. By setting $K'=L^{\\top}$, we find the observer gain $L$ that places the poles of the observer dynamics matrix $A-LC$ at these same locations. The requirement that the roots of $p(\\lambda)$ lie in the open left half-plane ensures the stability of the observer, which is the practical objective. This completes the derivation.\n\nPart 2: Computation of Eigenvalue Placement Gain\nWe are given the system with matrices\n$$\nA = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.\n$$\nThe output injection gain is $L = \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix}$. The matrix $A-LC$ is computed as:\n$$\nA - LC = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} \\\\ \\ell_{2} \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\ell_{1} & 0 \\\\ \\ell_{2} & 0 \\end{pmatrix} = \\begin{pmatrix} -\\ell_{1} & 1 \\\\ -\\ell_{2} & 0 \\end{pmatrix}.\n$$\nThe characteristic polynomial of $A-LC$ is\n$$\n\\det(\\lambda I - (A-LC)) = \\det \\begin{pmatrix} \\lambda + \\ell_{1} & -1 \\\\ \\ell_{2} & \\lambda \\end{pmatrix} = \\lambda(\\lambda + \\ell_{1}) - (-1)(\\ell_{2}) = \\lambda^{2} + \\ell_{1}\\lambda + \\ell_{2}.\n$$\nThe desired eigenvalues are $\\lambda_{1} = -2$ and $\\lambda_{2} = -5$. The desired characteristic polynomial is\n$$\np(\\lambda) = (\\lambda - \\lambda_{1})(\\lambda - \\lambda_{2}) = (\\lambda + 2)(\\lambda + 5) = \\lambda^{2} + 7\\lambda + 10.\n$$\nBy matching the coefficients of the computed and desired characteristic polynomials, we obtain:\n$$\n\\ell_{1} = 7, \\quad \\ell_{2} = 10.\n$$\nThus, the required gain matrix is $L = \\begin{pmatrix} 7 \\\\ 10 \\end{pmatrix}$.\n\nPart 3: Computation of Steady-State Kalman Gain and Conceptual Contrast\nWe are given process and measurement noise with covariance intensities $Q=I$ and $R=1$. The steady-state Kalman filter gain $L_{\\mathrm{KF}}$ is given by $L_{\\mathrm{KF}} = PC^{\\top}R^{-1}$, where $P$ is the symmetric, positive-definite solution to the continuous-time algebraic Riccati equation (CARE):\n$$\nAP + PA^{\\top} - PC^{\\top}R^{-1}CP + Q = 0.\n$$\nLet $P = \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix}$. Substituting the given matrices $A, C, Q, R$:\n$$\n\\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\\\ p_{12} & p_{22} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\nEvaluating each term:\n$$\n\\begin{pmatrix} p_{12} & p_{22} \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} p_{12} & 0 \\\\ p_{22} & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11} \\\\ p_{12} \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{12} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} 2p_{12} & p_{22} \\\\ p_{22} & 0 \\end{pmatrix} - \\begin{pmatrix} p_{11}^{2} & p_{11}p_{12} \\\\ p_{11}p_{12} & p_{12}^{2} \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\nThis matrix equation yields a system of algebraic equations for the entries of $P$:\n1. $2p_{12} - p_{11}^{2} + 1 = 0$\n2. $p_{22} - p_{11}p_{12} = 0$\n3. $-p_{12}^{2} + 1 = 0$\n\nFrom equation ($3$), we find $p_{12}^{2} = 1$, which gives $p_{12} = \\pm 1$. The eigenvalues of the Kalman filter error dynamics matrix $A - L_{\\mathrm{KF}}C = \\begin{pmatrix} -p_{11} & 1 \\\\ -p_{12} & 0 \\end{pmatrix}$ must lie in the open left half-plane for stability. The characteristic polynomial is $\\lambda^{2} + p_{11}\\lambda + p_{12} = 0$. For stable roots, the Routh-Hurwitz stability criterion requires all coefficients to be positive. Thus, we must have $p_{11} > 0$ and $p_{12} > 0$. We must therefore select $p_{12} = 1$.\n\nSubstituting $p_{12}=1$ into equation ($1$):\n$$\n2(1) - p_{11}^{2} + 1 = 0 \\implies p_{11}^{2} = 3.\n$$\nSince we require $p_{11} > 0$, we have $p_{11} = \\sqrt{3}$.\n\nSubstituting $p_{11}=\\sqrt{3}$ and $p_{12}=1$ into equation ($2$):\n$$\np_{22} - (\\sqrt{3})(1) = 0 \\implies p_{22} = \\sqrt{3}.\n$$\nThe steady-state error covariance is $P = \\begin{pmatrix} \\sqrt{3} & 1 \\\\ 1 & \\sqrt{3} \\end{pmatrix}$. We verify that this matrix is positive definite: $p_{11}=\\sqrt{3} > 0$ and $\\det(P) = (\\sqrt{3})(\\sqrt{3}) - 1^{2} = 3-1=2>0$.\n\nThe steady-state Kalman gain $L_{\\mathrm{KF}}$ is then:\n$$\nL_{\\mathrm{KF}} = PC^{\\top}R^{-1} = \\begin{pmatrix} \\sqrt{3} & 1 \\\\ 1 & \\sqrt{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} (1) = \\begin{pmatrix} \\sqrt{3} \\\\ 1 \\end{pmatrix}.\n$$\nLetting $L_{\\mathrm{KF}} = \\begin{pmatrix} k_{1} \\\\ k_{2} \\end{pmatrix}$, we have $k_{1} = \\sqrt{3}$ and $k_{2} = 1$.\n\nConceptual Contrast:\nThe eigenvalue placement gain $L$ from Part $2$ is chosen deterministically to achieve an arbitrary, user-specified dynamic response for the observer error. The choice of poles (here, $-2$ and $-5$) is dictated by design specifications like desired settling time or damping, but is otherwise arbitrary. This method completely ignores any stochastic aspects of the system, such as process or measurement noise.\n\nIn stark contrast, the steady-state Kalman gain $L_{\\mathrm{KF}}$ from Part $3$ is not arbitrary. It is uniquely determined as the optimal gain that minimizes the variance of the state estimation error, based on the statistical properties of the system, namely the process noise covariance $Q$ and the measurement noise covariance $R$. The resulting observer poles are not directly specified by the designer but are an outcome of this optimization. The Kalman filter provides the best possible estimate in the mean-square sense by systematically balancing the confidence in the system model against the confidence in the measurements. The pole placement method enforces a desired behavior, while the Kalman filter derives an optimal behavior from the underlying stochastic reality of the system.", "answer": "$$\n\\boxed{\\begin{pmatrix} 7 & 10 & \\sqrt{3} & 1 \\end{pmatrix}}\n$$", "id": "2748160"}, {"introduction": "The elegance of duality extends beyond full-order systems. This advanced practice challenges you to design a reduced-order observer, a more efficient estimator that reconstructs only the unmeasured states [@problem_id:2703165]. By deriving the observer for a partitioned system and again invoking duality, you will see how this fundamental symmetry persists even in more complex and practical observer structures.", "problem": "Consider the single-input single-output linear time-invariant plant with state-space model\n$$\n\\dot{x} = A x + b u,\\qquad y = c^{\\top} x,\n$$\nwhere\n$$\nA = \\begin{pmatrix}\n2 & 1 & 0\\\\\n0 & 3 & 1\\\\\n0 & 0 & 4\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix},\\quad\nc = \\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}.\n$$\nAssume the time-derivative of the measured output, $\\dot{y}$, is available noiselessly. You will design a minimal-order (order $2$) observer to reconstruct the unmeasured state components using the measured output and the known input.\n\nStart from the fundamental state equations and the definition of the state estimate, without invoking any prepackaged observer design formulas. Proceed by (i) partitioning the state according to the measured and unmeasured components, (ii) deriving the reduced-order observer dynamics that use $y$, $\\dot{y}$, and $u$, and (iii) obtaining the observer error dynamics explicitly. The desired observer error characteristic polynomial is\n$$\np_{\\text{des}}(s) = s^{2} + s + 1.\n$$\nLet $L \\in \\mathbb{R}^{2 \\times 1}$ denote the injection gain that appears in the reduced-order observer dynamics you derive. Denote by $\\alpha$ the first component of $L$.\n\nBy invoking the duality between state estimation and state feedback, explain why the same scalar $\\alpha$ also determines the first component of the gain in the dual reduced-order controller that places the same internal characteristic polynomial for the transposed plant with input channel aligned with $c$. Do not compute the dual controller gain numerically; only use duality to justify the correspondence of the first component.\n\nWhat is the exact value of $\\alpha$? Provide your answer as an exact number. No rounding is required.", "solution": "The problem statement is subjected to validation.\n\nGivens:\nA linear time-invariant system is described by the state-space model\n$$\n\\dot{x} = Ax + bu, \\qquad y = c^{\\top}x\n$$\nwith matrices\n$$\nA = \\begin{pmatrix}\n2 & 1 & 0\\\\\n0 & 3 & 1\\\\\n0 & 0 & 4\n\\end{pmatrix},\\quad\nb = \\begin{pmatrix}0\\\\0\\\\1\\end{pmatrix},\\quad\nc = \\begin{pmatrix}1\\\\0\\\\0\\end{pmatrix}.\n$$\nThe state vector is $x \\in \\mathbb{R}^3$. The input $u$ and output $y$ are scalars. The time-derivative of the output, $\\dot{y}$, is available. A minimal-order observer of order $2$ is to be designed. The desired characteristic polynomial for the observer error dynamics is $p_{\\text{des}}(s) = s^{2} + s + 1$. The observer gain is $L \\in \\mathbb{R}^{2 \\times 1}$, and its first component is denoted by $\\alpha$.\n\nValidation:\nThe problem is scientifically grounded in the field of control theory, specifically concerning state estimation and the principle of duality. The system is third-order ($n=3$) with a single output ($p=1$), for which a minimal-order observer should be of order $n-p = 2$. The given matrices define a system that is both controllable and observable, which are necessary conditions for the design of a state-feedback controller and a state observer, respectively. The system parameters are fully specified. The objective is clearly stated. The assumption of the availability of $\\dot{y}$ is an explicit condition, not a flaw, and is a standard starting point for the design of certain types of observers. The problem is self-contained, consistent, and well-posed. The problem is deemed valid.\n\nSolution:\nThe system output is $y = c^\\top x = x_1$. Since $y$ is measured, the state $x_1$ is known. The unmeasured states are $x_2$ and $x_3$. We partition the state vector as $x = \\begin{pmatrix} x_1 \\\\ x_u \\end{pmatrix}$, where $x_1$ is the measured component and $x_u = \\begin{pmatrix} x_2 \\\\ x_3 \\end{pmatrix}$ is the vector of unmeasured components.\n\nWe partition the system matrices $A$ and $b$ accordingly:\n$$\n\\dot{x} =\n\\begin{pmatrix} \\dot{x}_1 \\\\ \\dot{x}_u \\end{pmatrix}\n=\n\\begin{pmatrix} A_{11} & A_{12} \\\\ A_{21} & A_{22} \\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_u \\end{pmatrix}\n+\n\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}\nu\n$$\nFrom the given matrices, we identify the blocks:\n$$\nA_{11} = 2, \\quad A_{12} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}\n$$\n$$\nA_{21} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}, \\quad A_{22} = \\begin{pmatrix} 3 & 1 \\\\ 0 & 4 \\end{pmatrix}\n$$\n$$\nb_1 = 0, \\quad b_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n\nThe state equations in partitioned form are:\n$$\n\\dot{x}_1 = A_{11} x_1 + A_{12} x_u + b_1 u = 2x_1 + x_2\n$$\n$$\n\\dot{x}_u = A_{21} x_1 + A_{22} x_u + b_2 u = A_{22} x_u + b_2 u\n$$\nThe dynamics of the unmeasured states $x_u$ are driven by $x_u$ itself and the known input $u$. To estimate $x_u$, we require an \"output\" from this subsystem. The first equation can be rearranged as:\n$$\nA_{12} x_u = \\dot{x}_1 - A_{11} x_1 - b_1 u\n$$\nSince $y = x_1$, we have $\\dot{y} = \\dot{x}_1$. The problem states that $\\dot{y}$ is available. We can thus construct a pseudo-output $y_u$ for the unmeasured subsystem:\n$$\ny_u = \\dot{y} - A_{11} y - b_1 u = \\dot{y} - 2y\n$$\nThis signal $y_u$ is related to the unmeasured states by $y_u = A_{12} x_u$. Let $C_u = A_{12} = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$.\n\nWe now design a Luenberger observer for the subsystem described by:\n$$\n\\dot{x}_u = A_{22} x_u + b_2 u, \\quad y_u = C_u x_u\n$$\nLet $\\hat{x}_u$ be the estimate of $x_u$. The dynamics of the reduced-order observer are given by:\n$$\n\\dot{\\hat{x}}_u = A_{22} \\hat{x}_u + b_2 u + L(y_u - \\hat{y}_u)\n$$\nwhere $\\hat{y}_u = C_u \\hat{x}_u$ and $L \\in \\mathbb{R}^{2 \\times 1}$ is the observer injection gain. The observer uses the signals $y$, $\\dot{y}$ (via $y_u$), and $u$, as required.\n\nThe estimation error is $e_u = x_u - \\hat{x}_u$. Its dynamics are derived as follows:\n$$\n\\dot{e}_u = \\dot{x}_u - \\dot{\\hat{x}}_u = (A_{22} x_u + b_2 u) - (A_{22} \\hat{x}_u + b_2 u + L(y_u - C_u \\hat{x}_u))\n$$\n$$\n\\dot{e}_u = A_{22}(x_u - \\hat{x}_u) - L(C_u x_u - C_u \\hat{x}_u) = A_{22}e_u - L C_u e_u = (A_{22} - L C_u)e_u\n$$\nThe stability of the observer is determined by the eigenvalues of the matrix $A_{obs} = A_{22} - L C_u$. The characteristic polynomial of the error dynamics is $\\det(sI - A_{obs})$.\nLet $L = \\begin{pmatrix} \\alpha \\\\ l_2 \\end{pmatrix}$. Then\n$$\nLC_u = \\begin{pmatrix} \\alpha \\\\ l_2 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} \\alpha & 0 \\\\ l_2 & 0 \\end{pmatrix}\n$$\n$$\nA_{obs} = A_{22} - LC_u = \\begin{pmatrix} 3 & 1 \\\\ 0 & 4 \\end{pmatrix} - \\begin{pmatrix} \\alpha & 0 \\\\ l_2 & 0 \\end{pmatrix} = \\begin{pmatrix} 3-\\alpha & 1 \\\\ -l_2 & 4 \\end{pmatrix}\n$$\nThe characteristic polynomial is:\n$$\np(s) = \\det \\begin{pmatrix} s-(3-\\alpha) & -1 \\\\ l_2 & s-4 \\end{pmatrix} = (s-3+\\alpha)(s-4) + l_2\n$$\n$$\np(s) = s^2 - 4s - 3s + 12 + \\alpha s - 4\\alpha + l_2 = s^2 + (\\alpha-7)s + (12-4\\alpha+l_2)\n$$\nThis must be equal to the desired polynomial $p_{\\text{des}}(s) = s^2+s+1$. By comparing coefficients:\n1.  Coefficient of $s$: $\\alpha - 7 = 1 \\implies \\alpha = 8$.\n2.  Constant term: $12 - 4\\alpha + l_2 = 1 \\implies 12 - 4(8) + l_2 = 1 \\implies 12 - 32 + l_2 = 1 \\implies -20 + l_2 = 1 \\implies l_2 = 21$.\nThe observer gain is $L = \\begin{pmatrix} 8 \\\\ 21 \\end{pmatrix}$. The first component is $\\alpha = 8$.\n\nNow, we address the duality aspect. The principle of duality in LTI systems relates the problem of state estimation (observer design) for a system $(A, C)$ to the problem of state-feedback control for the dual system $(A^\\top, C^\\top)$.\nThe reduced-order observer design involved placing the eigenvalues of the matrix $A_{22} - L C_u$. The relevant system pair is $(A_{22}, C_u)$.\nThe dual control problem corresponds to the system with dynamics matrix $A_{22}^\\top$ and input matrix $C_u^\\top$. Let this dual subsystem be $\\dot{\\zeta} = A_{22}^\\top \\zeta + C_u^\\top v_{sub}$. A state-feedback controller for this system has the form $v_{sub} = -K_{dual}^\\top \\zeta$, leading to a closed-loop matrix $A_{22}^\\top - C_u^\\top K_{dual}^\\top$.\n\nThe problem refers to \"the dual reduced-order controller for the transposed plant\". The transposed plant system is $\\dot{z} = A^\\top z + c v$. We partition $z$ dually to $x$, i.e., $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$ where $z_1$ is a scalar and $z_2 \\in \\mathbb{R}^2$. The partitioned dual dynamics are:\n$$\n\\begin{pmatrix} \\dot{z}_1 \\\\ \\dot{z}_2 \\end{pmatrix} = \\begin{pmatrix} A_{11}^\\top & A_{21}^\\top \\\\ A_{12}^\\top & A_{22}^\\top \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} + \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} v\n$$\nWith $A_{21}^\\top = \\begin{pmatrix} 0 & 0 \\end{pmatrix}$, $c_1 = 1$, and $c_2 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, the equations become:\n$$\n\\dot{z}_1 = A_{11}^\\top z_1 + c_1 v = 2z_1 + v\n$$\n$$\n\\dot{z}_2 = A_{12}^\\top z_1 + A_{22}^\\top z_2\n$$\nThis structure represents a cascade system where the dynamics of $z_2$ are driven by $z_1$. The pair $(A_{22}^\\top, A_{12}^\\top)$ is controllable because its dual, the pair $(A_{22}, A_{12}) = (A_{22}, C_u)$, is observable (which was a prerequisite for designing the observer). A \"reduced-order controller\" can be interpreted as designing a feedback law for the $z_2$ subsystem by treating $z_1$ as a control input. Specifically, we can stabilize the $z_2$ subsystem by setting $z_1$ as a linear function of $z_2$: $z_1 = -K_2^\\top z_2$. This yields the closed-loop dynamics for the subsystem:\n$$\n\\dot{z}_2 = (A_{22}^\\top - A_{12}^\\top K_2^\\top)z_2\n$$\nThe eigenvalues of this subsystem are the roots of its characteristic polynomial, $\\det(sI - (A_{22}^\\top - A_{12}^\\top K_2^\\top))$.\nThe characteristic polynomial of the observer error dynamics is $\\det(sI - (A_{22} - L C_u))$.\nUsing the property that $\\det(M) = \\det(M^\\top)$, the observer polynomial can be written as:\n$$\n\\det(sI - (A_{22} - L C_u)) = \\det((sI - (A_{22} - L C_u))^\\top) = \\det(sI - (A_{22}^\\top - C_u^\\top L^\\top))\n$$\nWe have $C_u = A_{12}$. To make the internal characteristic polynomial of the dual controller identical to the observer error characteristic polynomial, we must have:\n$$\n\\det(sI - (A_{22}^\\top - A_{12}^\\top K_2^\\top)) = \\det(sI - (A_{22}^\\top - A_{12}^\\top L^\\top))\n$$\nThis identity holds if we choose the controller gain $K_2$ to be equal to the observer gain $L$. Thus, $K_2=L$.\nThe first component of the observer gain $L$ is $\\alpha$. Consequently, the first component of the dual controller gain $K_2$ must also be $\\alpha$. This correspondence is a direct result of the duality principle, without needing to numerically compute $K_2$.\n\nThe value of $\\alpha$ was previously calculated as $8$.", "answer": "$$\n\\boxed{8}\n$$", "id": "2703165"}]}