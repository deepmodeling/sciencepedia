{"hands_on_practices": [{"introduction": "This first exercise serves as a direct confirmation of the deterministic separation principle. By considering a system where the controller and observer poles are specified, you can verify that the dynamics of state feedback and state estimation are independent. The poles of the overall system are simply the combined set of the individual controller and observer poles [@problem_id:1601329].", "problem": "Consider a second-order Linear Time-Invariant (LTI) system. The state of this system is not directly measurable, so a full-order Luenberger observer is designed to estimate the state vector. A state-feedback controller is then implemented using these estimated states.\n\nThe control system designer has two objectives:\n1.  The desired closed-loop dynamics for the state-feedback controller should correspond to poles located at $\\{-3, -5\\}$.\n2.  The error dynamics of the state observer should be significantly faster than the controller dynamics. To achieve this, the observer poles are placed at $\\{-30, -50\\}$.\n\nAssuming the controller and observer are designed independently and then combined to form the complete regulatory system, what are the poles of the overall closed-loop system?\n\nSelect the correct set of poles from the options below.\n\nA. $\\{-3, -5\\}$\n\nB. $\\{-30, -50\\}$\n\nC. $\\{-33, -55\\}$\n\nD. $\\{-3, -5, -30, -50\\}$\n\nE. The poles cannot be determined without the system matrices $A$, $B$, and $C$.", "solution": "Let the LTI plant be given by $\\dot{x} = A x + B u$, $y = C x$, where $x \\in \\mathbb{R}^{2}$ is not directly measurable. A full-order Luenberger observer and state-feedback controller are designed as follows:\n- State-feedback control law using the estimated state: $u = -K \\hat{x}$ with desired closed-loop poles at $\\{-3,-5\\}$, so that $A - B K$ has eigenvalues $\\{-3,-5\\}$.\n- Observer: $\\dot{\\hat{x}} = A \\hat{x} + B u + L(y - C \\hat{x})$ with observer poles at $\\{-30,-50\\}$, so that $A - L C$ has eigenvalues $\\{-30,-50\\}$.\n\nDefine the estimation error $e = x - \\hat{x}$. Then, using $u = -K \\hat{x}$,\n$$\n\\dot{x} = A x + B u = A x + B(-K \\hat{x}) = A x - B K (x - e) = (A - B K) x + B K e.\n$$\nThe observer error dynamics are derived as\n$$\n\\dot{e} = \\dot{x} - \\dot{\\hat{x}} = \\left(A x + B u\\right) - \\left(A \\hat{x} + B u + L(y - C \\hat{x})\\right) = A(x - \\hat{x}) - L(C x - C \\hat{x}) = (A - L C) e.\n$$\nStack the plant state and error into $z = \\begin{pmatrix} x \\\\ e \\end{pmatrix}$. The combined closed-loop dynamics become\n$$\n\\begin{pmatrix} \\dot{x} \\\\ \\dot{e} \\end{pmatrix}\n=\n\\begin{pmatrix}\nA - B K  B K \\\\\n0  A - L C\n\\end{pmatrix}\n\\begin{pmatrix} x \\\\ e \\end{pmatrix}.\n$$\nThis closed-loop system matrix is block upper triangular. Its eigenvalues are the union of the eigenvalues of its diagonal blocks. Therefore, the closed-loop poles are the union of the controller poles (eigenvalues of $A - B K$) and observer error poles (eigenvalues of $A - L C$), namely\n$$\n\\{-3,-5\\} \\cup \\{-30,-50\\} = \\{-3,-5,-30,-50\\}.\n$$\nBy the separation principle, this result holds when the controller and observer are designed independently and then combined.\n\nThus, the correct option is D.", "answer": "$$\\boxed{D}$$", "id": "1601329"}, {"introduction": "Building on the foundation of the previous exercise, this problem explores a critical corollary of the separation principle. We investigate the scenario where a stabilizing controller is paired with an unstable observer, a common pitfall in practical design. This practice underscores that the stability of the composite system is not guaranteed by the controller alone and depends crucially on the stability of the estimator as well [@problem_id:1601363].", "problem": "An engineer is designing a control system for an unstable process modeled as a continuous-time Linear Time-Invariant (LTI) system. The system dynamics are described by the state-space equations $\\dot{x}(t) = Ax(t) + Bu(t)$ and $y(t) = Cx(t)$, where $x(t)$ is the state vector, $u(t)$ is the control input, and $y(t)$ is the measured output.\n\nThe system matrices are given as:\n$$\nA = \\begin{pmatrix} 0  1 \\\\ 3  -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  0 \\end{pmatrix}\n$$\n\nA full state-feedback controller of the form $u(t) = -Kx(t)$ is not feasible because not all states are directly measurable. Therefore, an observer-based controller is proposed. The control law will be $u(t) = -K\\hat{x}(t)$, where $\\hat{x}(t)$ is the state estimate provided by a Luenberger observer.\n\nA state-feedback gain $K = \\begin{pmatrix} 11  4 \\end{pmatrix}$ has been designed, which is known to place the poles of the state-feedback system ($A-BK$) in stable locations. For the observer, a gain matrix $L = \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix}$ has been chosen.\n\nYour task is to analyze the stability of the complete closed-loop system, which consists of the plant, the observer, and the state-feedback law. Calculate the value of the closed-loop pole with the largest real part. Round your final answer to three significant figures.", "solution": "The stability of the overall observer-based control system is determined by the set of all its closed-loop poles. According to the principle of separation in control theory, the set of poles of the combined system (plant with an observer-based controller) is the union of the set of poles of the state-feedback regulator and the set of poles of the observer.\n\nWe need to find these two sets of poles independently.\n\nFirst, we determine the poles of the state-feedback regulator. These are the eigenvalues of the matrix $(A-BK)$. The state-feedback gain is given as $K = \\begin{pmatrix} 11  4 \\end{pmatrix}$.\nThe matrix $(A-BK)$ is calculated as:\n$$\nA - BK = \\begin{pmatrix} 0  1 \\\\ 3  -2 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 11  4 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 3  -2 \\end{pmatrix} - \\begin{pmatrix} 0  0 \\\\ 11  4 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -8  -6 \\end{pmatrix}\n$$\nThe poles are the roots of the characteristic equation, $\\det(\\lambda I - (A-BK)) = 0$.\n$$\n\\det\\left( \\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ -8  -6 \\end{pmatrix} \\right) = \\det\\begin{pmatrix} \\lambda  -1 \\\\ 8  \\lambda+6 \\end{pmatrix} = 0\n$$\n$$\n\\lambda(\\lambda+6) - (-1)(8) = \\lambda^{2} + 6\\lambda + 8 = 0\n$$\nFactoring this polynomial gives:\n$$\n(\\lambda+2)(\\lambda+4) = 0\n$$\nSo, the poles of the state-feedback regulator are $\\lambda_{1} = -2$ and $\\lambda_{2} = -4$. Both poles have negative real parts, confirming that the controller is stabilizing.\n\nSecond, we determine the poles of the state observer. These are the eigenvalues of the matrix $(A-LC)$. The observer gain is given as $L = \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix}$.\nThe matrix $(A-LC)$ is calculated as:\n$$\nA - LC = \\begin{pmatrix} 0  1 \\\\ 3  -2 \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 3  -2 \\end{pmatrix} - \\begin{pmatrix} -4  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 4  1 \\\\ 2  -2 \\end{pmatrix}\n$$\nThe observer poles are the roots of the characteristic equation, $\\det(\\lambda I - (A-LC)) = 0$.\n$$\n\\det\\left( \\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} - \\begin{pmatrix} 4  1 \\\\ 2  -2 \\end{pmatrix} \\right) = \\det\\begin{pmatrix} \\lambda-4  -1 \\\\ -2  \\lambda+2 \\end{pmatrix} = 0\n$$\n$$\n(\\lambda-4)(\\lambda+2) - (-1)(-2) = \\lambda^{2} - 2\\lambda - 8 - 2 = \\lambda^{2} - 2\\lambda - 10 = 0\n$$\nWe use the quadratic formula, $\\lambda = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$, to find the roots of this equation, with $a=1$, $b=-2$, and $c=-10$.\n$$\n\\lambda = \\frac{-(-2) \\pm \\sqrt{(-2)^{2} - 4(1)(-10)}}{2(1)} = \\frac{2 \\pm \\sqrt{4 + 40}}{2} = \\frac{2 \\pm \\sqrt{44}}{2} = 1 \\pm \\sqrt{11}\n$$\nSo, the poles of the observer are $\\lambda_{3} = 1 + \\sqrt{11}$ and $\\lambda_{4} = 1 - \\sqrt{11}$. Because the pole $1 + \\sqrt{11}$ has a positive real part, the observer is unstable.\n\nThe set of all closed-loop poles for the complete system is the union of these two sets: $\\{-2, -4, 1 + \\sqrt{11}, 1 - \\sqrt{11}\\}$.\n\nThe question asks for the pole with the largest real part. We compare the real parts of all four poles:\n$\\text{Re}(-2) = -2$\n$\\text{Re}(-4) = -4$\n$\\text{Re}(1 + \\sqrt{11}) = 1 + \\sqrt{11} \\approx 1 + 3.3166 = 4.3166$\n$\\text{Re}(1 - \\sqrt{11}) = 1 - \\sqrt{11} \\approx 1 - 3.3166 = -2.3166$\n\nThe pole with the largest real part is $1 + \\sqrt{11}$. We need to provide its numerical value rounded to three significant figures.\nValue $= 1 + \\sqrt{11} \\approx 4.3166247...$\nRounding to three significant figures, we get $4.32$.\nSince there is a pole with a positive real part, the overall system is unstable, despite the controller design being stable.", "answer": "$$\\boxed{4.32}$$", "id": "1601363"}, {"introduction": "This final practice moves from deterministic pole placement to the realm of stochastic optimal control, applying the separation principle to a full Linear-Quadratic-Gaussian (LQG) problem. You will be guided through the process of designing a steady-state LQR controller and a Kalman-Bucy filter by solving their respective Algebraic Riccati Equations. This comprehensive exercise culminates in verifying that the principle holds, demonstrating that the certainty equivalence of LQG control leads to the same convenient separation of eigenvalues [@problem_id:2753856].", "problem": "Consider the continuous-time linear time-invariant system with process and measurement noise\n$$\\dot{x}(t) = A x(t) + B u(t) + G w(t), \\quad y(t) = C x(t) + v(t),$$\nwhere $x(t) \\in \\mathbb{R}^{2}$, $u(t) \\in \\mathbb{R}^{2}$, and $y(t) \\in \\mathbb{R}^{2}$. The process noise $w(t)$ and the measurement noise $v(t)$ are zero-mean, mutually independent, white signals with covariances $W \\succ 0$ and $V \\succ 0$, respectively. The matrices are given by\n$$\nA = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix},\\quad\nB = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\\quad\nC = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\\quad\nG = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix},\n$$\n$$\nQ = \\begin{pmatrix} 3  0 \\\\ 0  3 \\end{pmatrix},\\quad\nR = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix},\\quad\nW = \\begin{pmatrix} 3  0 \\\\ 0  7 \\end{pmatrix},\\quad\nV = \\begin{pmatrix} 4  0 \\\\ 0  4 \\end{pmatrix}.\n$$\nAll pairs satisfy the usual stabilizability and detectability conditions. Design:\n- the steady-state Linear Quadratic Regulator (LQR) state-feedback $u(t) = -F x(t)$ that minimizes the quadratic cost $\\int_{0}^{\\infty} \\left( x(t)^{\\top} Q x(t) + u(t)^{\\top} R u(t) \\right) \\, dt$,\n- the steady-state Kalman-Bucy filter (continuous-time) $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - C \\hat{x}(t)\\big)$.\n\nUsing only first principles and well-tested facts about algebraic Riccati equations and estimator-based control, do the following:\n1. Compute the steady-state LQR gain $F$ and the steady-state Kalman gain $L$.\n2. Form the error $e(t) = x(t) - \\hat{x}(t)$ and write the autonomous augmented deterministic dynamics in coordinates $\\xi(t) = \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ with $v(t) \\equiv 0$ for the purpose of eigenvalue analysis. Identify the associated system matrix $M$.\n3. Verify by explicit eigenvalue computation that the separation principle holds: the spectrum of $M$ equals the multiset union of the spectra of $A - B F$ and $A - L C$, and that the augmented closed loop is stable.\n\nReport as your final answer the characteristic polynomial of the augmented closed-loop matrix $M$ in factored form as a single analytic expression in the indeterminate $\\lambda$. Do not include units. No rounding is required.", "solution": "The problem posed is a standard exercise in Linear-Quadratic-Gaussian (LQG) control for a continuous-time linear time-invariant (LTI) system. It requires the design of a steady-state Linear Quadratic Regulator (LQR) and a steady-state Kalman-Bucy filter, followed by an analysis of the combined closed-loop system to verify the separation principle. The problem is well-defined, scientifically sound, and contains all necessary information for a unique solution. We shall proceed with the derivation.\n\nThe system dynamics are given by:\n$$ \\dot{x}(t) = A x(t) + B u(t) + G w(t) $$\n$$ y(t) = C x(t) + v(t) $$\nwith matrices, cost function weights, and noise covariances:\n$$ A = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix},\\ B = I_{2}, \\ C = I_{2}, \\ G = I_{2} $$\n$$ Q = 3 I_{2},\\ R = 4 I_{2},\\ W = \\begin{pmatrix} 3  0 \\\\ 0  7 \\end{pmatrix},\\ V = 4 I_{2} $$\nwhere $I_{2}$ is the $2 \\times 2$ identity matrix.\n\nFirst, we compute the steady-state LQR gain $F$. The gain is given by $F = R^{-1} B^{\\top} P$, where $P$ is the unique, symmetric, positive-semidefinite solution to the continuous-time Algebraic Riccati Equation (CARE):\n$$ A^{\\top} P + P A - P B R^{-1} B^{\\top} P + Q = 0 $$\nGiven that $A$, $B$, $R$, and $Q$ are all diagonal matrices, the solution $P$ must also be diagonal. Let $P = \\text{diag}(p_1, p_2)$. The matrix equation decouples into two independent scalar algebraic Riccati equations.\nWith $R^{-1} = \\frac{1}{4}I_2$ and $B=I_2$, we have $B R^{-1} B^{\\top} = \\frac{1}{4}I_2$.\n\nFor the first diagonal element, $p_1$:\n$$ 2(0.5)p_1 - p_1(\\frac{1}{4})p_1 + 3 = 0 \\implies \\frac{1}{4}p_1^2 - p_1 - 3 = 0 \\implies p_1^2 - 4p_1 - 12 = 0 $$\nFactoring yields $(p_1 - 6)(p_1 + 2) = 0$. For $P$ to be positive-semidefinite, we must choose the non-negative root, so $p_1 = 6$.\n\nFor the second diagonal element, $p_2$:\n$$ 2(-1.5)p_2 - p_2(\\frac{1}{4})p_2 + 3 = 0 \\implies \\frac{1}{4}p_2^2 + 3p_2 - 3 = 0 \\implies p_2^2 + 12p_2 - 12 = 0 $$\nUsing the quadratic formula, $p_2 = \\frac{-12 \\pm \\sqrt{12^2 - 4(1)(-12)}}{2} = \\frac{-12 \\pm \\sqrt{144 + 48}}{2} = \\frac{-12 \\pm \\sqrt{192}}{2}$. Since $\\sqrt{192} = \\sqrt{64 \\times 3} = 8\\sqrt{3}$, we have $p_2 = \\frac{-12 \\pm 8\\sqrt{3}}{2} = -6 \\pm 4\\sqrt{3}$. For positive-semidefiniteness, we must choose $p_2 = 4\\sqrt{3} - 6 > 0$.\nThus, $P = \\begin{pmatrix} 6  0 \\\\ 0  4\\sqrt{3} - 6 \\end{pmatrix}$.\nThe LQR gain is $F = R^{-1} B^{\\top} P = \\frac{1}{4}I_2 \\cdot I_2 \\cdot P = \\frac{1}{4}P$.\n$$ F = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\sqrt{3} - \\frac{3}{2} \\end{pmatrix} $$\n\nNext, we compute the steady-state Kalman gain $L$. The gain is given by $L = S C^{\\top} V^{-1}$, where $S$ is the steady-state error covariance, which is the unique, symmetric, positive-semidefinite solution to the filter ARE:\n$$ A S + S A^{\\top} - S C^{\\top} V^{-1} C S + G W G^{\\top} = 0 $$\nThe effective process noise covariance is $Q_{noise} = G W G^{\\top} = I_2 W I_2 = W$. Since $A$, $C$, $V$, and $Q_{noise}$ are diagonal, $S$ must also be diagonal. Let $S = \\text{diag}(s_1, s_2)$. With $V^{-1} = \\frac{1}{4}I_2$ and $C=I_2$, we have $C^{\\top} V^{-1} C = \\frac{1}{4}I_2$. The matrix equation decouples.\n\nFor the first diagonal element, $s_1$:\n$$ 2(0.5)s_1 - s_1(\\frac{1}{4})s_1 + 3 = 0 \\implies \\frac{1}{4}s_1^2 - s_1 - 3 = 0 \\implies s_1^2 - 4s_1 - 12 = 0 $$\nThis is identical to the equation for $p_1$, so $s_1 = 6$.\n\nFor the second diagonal element, $s_2$:\n$$ 2(-1.5)s_2 - s_2(\\frac{1}{4})s_2 + 7 = 0 \\implies \\frac{1}{4}s_2^2 + 3s_2 - 7 = 0 \\implies s_2^2 + 12s_2 - 28 = 0 $$\nFactoring yields $(s_2 + 14)(s_2 - 2) = 0$. For $S$ to be positive-semidefinite, we must choose the non-negative root, so $s_2 = 2$.\nThus, $S = \\begin{pmatrix} 6  0 \\\\ 0  2 \\end{pmatrix}$.\nThe Kalman gain is $L = S C^{\\top} V^{-1} = S \\cdot I_2 \\cdot \\frac{1}{4}I_2 = \\frac{1}{4}S$.\n$$ L = \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} $$\n\nNow, we construct the autonomous augmented system. The control law is $u(t) = -F \\hat{x}(t)$. The state equation becomes $\\dot{x} = Ax - BF\\hat{x}$. The estimation error is $e(t) = x(t) - \\hat{x}(t)$. The dynamics of the error are derived from $\\dot{e} = \\dot{x} - \\dot{\\hat{x}}$.\nFor the deterministic part of the analysis (setting $w(t)=0, v(t)=0$), we have $y(t) = C x(t)$.\n$$ \\dot{\\hat{x}} = A\\hat{x} + Bu + L(y-C\\hat{x}) = A\\hat{x} - BF\\hat{x} + L(Cx - C\\hat{x}) $$\n$$ \\dot{e} = (Ax-BF\\hat{x}) - (A\\hat{x} - BF\\hat{x} + LCx - LC\\hat{x}) = A(x-\\hat{x}) - LC(x-\\hat{x}) = (A-LC)e $$\nThe state dynamics can be written in terms of $x$ and $e$ by substituting $\\hat{x} = x-e$:\n$$ \\dot{x} = Ax - BF(x-e) = (A-BF)x + BFe $$\nThe augmented system with state $\\xi(t) = \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$ is:\n$$ \\dot{\\xi}(t) = \\begin{pmatrix} \\dot{x} \\\\ \\dot{e} \\end{pmatrix} = \\begin{pmatrix} A-BF  BF \\\\ \\mathbf{0}  A-LC \\end{pmatrix} \\begin{pmatrix} x \\\\ e \\end{pmatrix} $$\nThe system matrix is $M = \\begin{pmatrix} A-BF  BF \\\\ \\mathbf{0}  A-LC \\end{pmatrix}$.\nThe eigenvalues of a block triangular matrix are the eigenvalues of its diagonal blocks. This demonstrates the separation principle: the set of eigenvalues of the closed-loop observer-based controller is the union of the eigenvalues of the state-feedback controller and the eigenvalues of the observer error dynamics.\n$\\text{spectrum}(M) = \\text{spectrum}(A-BF) \\cup \\text{spectrum}(A-LC)$.\n\nWe compute the required matrices and their spectra.\nThe controller closed-loop matrix is:\n$$ A - BF = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\sqrt{3} - \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 0.5 - 1.5  0 \\\\ 0  -1.5 - (\\sqrt{3} - 1.5) \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -\\sqrt{3} \\end{pmatrix} $$\nThe eigenvalues of $A-BF$ are $\\lambda_{c1} = -1$ and $\\lambda_{c2} = -\\sqrt{3}$.\n\nThe estimator closed-loop matrix is:\n$$ A - LC = \\begin{pmatrix} 0.5  0 \\\\ 0  -1.5 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{2}  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0.5 - 1.5  0 \\\\ 0  -1.5 - 0.5 \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix} $$\nThe eigenvalues of $A-LC$ are $\\lambda_{o1} = -1$ and $\\lambda_{o2} = -2$.\n\nThe eigenvalues of the augmented system matrix $M$ are collectively $\\{-1, -\\sqrt{3}, -1, -2\\}$. All eigenvalues have negative real parts, so the augmented closed-loop system is stable. The separation principle is explicitly verified.\n\nThe final task is to report the characteristic polynomial of $M$, which is $p(\\lambda) = \\det(\\lambda I - M)$. Given the eigenvalues of $M$, the polynomial in factored form is:\n$$ p(\\lambda) = (\\lambda - (-1)) (\\lambda - (-1)) (\\lambda - (-\\sqrt{3})) (\\lambda - (-2)) $$\n$$ p(\\lambda) = (\\lambda + 1)^2 (\\lambda + \\sqrt{3}) (\\lambda + 2) $$\nThis is the final result.", "answer": "$$\\boxed{(\\lambda+1)^{2}(\\lambda+2)(\\lambda+\\sqrt{3})}$$", "id": "2753856"}]}