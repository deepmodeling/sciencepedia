{"hands_on_practices": [{"introduction": "This first practice explores a cornerstone of observer-based control: the separation principle. By deriving the reference-to-output transfer function, you will demonstrate how, under ideal conditions, the controller's tracking performance can be designed independently of the observer dynamics. This exercise [@problem_id:2755501] provides a concrete, computational look at why the observer poles do not appear in the ideal closed-loop reference response.", "problem": "Consider the single-input single-output linear time-invariant plant described by the state-space equations\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\nwith\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad D = 0.$$\nThe plant is controlled by a dynamic output-feedback controller formed by a full-state observer (Luenberger observer) and a state-feedback law. The observer is\n$$\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y(t) - \\hat{y}(t)\\big), \\quad \\hat{y}(t) = C \\hat{x}(t),$$\nwith observer gain\n$$L = \\begin{pmatrix} 46 \\\\ 413 \\end{pmatrix},$$\nand the control input is\n$$u(t) = -K \\hat{x}(t) + N r(t), \\quad K = \\begin{pmatrix} 7 & 3 \\end{pmatrix},$$\nwhere $r(t)$ is the reference input and $N$ is a scalar prefilter chosen to achieve unit steady-state tracking for a step reference under ideal conditions. Assume zero initial conditions $x(0) = 0$ and $\\hat{x}(0) = 0$.\n\nUsing only the definitions of the Laplace transform for linear time-invariant systems and the state-space representation of the controller-observer interconnection, do the following:\n\n1. Derive the closed-loop reference-to-output transfer function $T_{yr}(s) = \\frac{Y(s)}{R(s)}$ explicitly in terms of the given matrices and gains, and determine the value of the prefilter $N$ that yields unit steady-state gain for a unit step reference $r(t) = 1$ for $t \\ge 0$.\n2. Compute the time-domain response $y(t)$ for $t \\ge 0$ to the unit step reference by performing an inverse Laplace transform of $T_{yr}(s)\\frac{1}{s}$.\n3. Briefly discuss, from first principles of the closed-loop state-space formulation, why the observer poles do not affect this reference-tracking response in the ideal case specified by the initial conditions.\n\nProvide your final answer as a single closed-form expression for $y(t)$ for $t \\ge 0$. No numerical rounding is required, and no physical units are needed.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in linear control theory and contains sufficient information for a unique, verifiable solution. We will proceed with the derivation and calculation.\n\nThe system is described by the plant equations:\n$$ \\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t) $$\nand the observer-based controller:\n$$ \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C\\hat{x}(t)) $$\n$$ u(t) = -K \\hat{x}(t) + N r(t) $$\nTo analyze the closed-loop system, we introduce the state estimation error $e(t) = x(t) - \\hat{x}(t)$. The derivative of the error is:\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) = [A x(t) + B u(t)] - [A \\hat{x}(t) + B u(t) + L(C x(t) - C \\hat{x}(t))] $$\n$$ \\dot{e}(t) = A(x(t) - \\hat{x}(t)) - LC(x(t) - \\hat{x}(t)) = (A - LC)e(t) $$\nThe control input $u(t)$ can be expressed in terms of $x(t)$ and $e(t)$:\n$$ u(t) = -K \\hat{x}(t) + N r(t) = -K(x(t) - e(t)) + N r(t) = -K x(t) + K e(t) + N r(t) $$\nSubstituting this into the plant state equation gives:\n$$ \\dot{x}(t) = A x(t) + B(-K x(t) + K e(t) + N r(t)) = (A - BK)x(t) + BK e(t) + BN r(t) $$\nWe can now write the full closed-loop dynamics using the augmented state vector $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$:\n$$ \\frac{d}{dt} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} r(t) $$\n$$ y(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} $$\nThe system matrix is block upper-triangular, which exemplifies the separation principle: the closed-loop eigenvalues are the union of the eigenvalues of the state-feedback regulator, given by $\\det(sI - (A-BK)) = 0$, and the eigenvalues of the observer, given by $\\det(sI - (A-LC)) = 0$.\n\nTaking the Laplace transform of the augmented system, with initial conditions $x(0)=0$ and $\\hat{x}(0)=0$ (which implies $e(0) = x(0) - \\hat{x}(0) = 0$), we get:\n$$ s \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} + \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix} R(s) $$\nThis decouples into two equations:\n$$ s X(s) = (A-BK)X(s) + BK E(s) + BN R(s) $$\n$$ s E(s) = (A-LC)E(s) $$\nFrom the second equation, $(sI - (A-LC))E(s) = e(0)$. Since $e(0)=0$, we have $E(s)=0$ for all $s$ for which $(sI-(A-LC))$ is invertible. This means the error state remains zero for all time.\nThe first equation thus simplifies to:\n$$ s X(s) = (A-BK)X(s) + BN R(s) $$\n$$ (sI - (A-BK))X(s) = BN R(s) \\implies X(s) = (sI - (A-BK))^{-1} BN R(s) $$\nThe output is $Y(s) = C X(s)$. Therefore, the transfer function $T_{yr}(s) = Y(s)/R(s)$ is:\n$$ T_{yr}(s) = N C(sI - (A-BK))^{-1} B $$\nThis answers the first part of the question regarding the form of the transfer function. We now substitute the given matrices:\n$A = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$, $K = \\begin{pmatrix} 7 & 3 \\end{pmatrix}$.\nFirst, calculate $A-BK$:\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 7 & 3 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 7 & 3 \\end{pmatrix} $$\n$$ A-BK = \\begin{pmatrix} 0 & 1 \\\\ -3 & -4 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 7 & 3 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix} $$\nNow, find $(sI - (A-BK))^{-1}$:\n$$ sI - (A-BK) = \\begin{pmatrix} s & -1 \\\\ 10 & s+7 \\end{pmatrix} $$\n$$ \\det(sI - (A-BK)) = s(s+7) - (10)(-1) = s^2 + 7s + 10 $$\n$$ (sI - (A-BK))^{-1} = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} $$\nNow, we compute $C(sI - (A-BK))^{-1} B$:\n$$ C(sI - (A-BK))^{-1} B = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n$$ = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{s^2+7s+10} $$\nThe transfer function is $T_{yr}(s) = \\frac{N}{s^2+7s+10}$.\nTo achieve unit steady-state gain for a step input, the DC gain must be $1$. We use the Final Value Theorem, which states that for a stable system, the steady-state value is $\\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} s T_{yr}(s) \\frac{1}{s} = T_{yr}(0)$.\n$$ T_{yr}(0) = \\frac{N}{0^2+7(0)+10} = \\frac{N}{10} $$\nSetting $T_{yr}(0) = 1$ yields $\\frac{N}{10} = 1$, so $N=10$.\nThe closed-loop transfer function is $T_{yr}(s) = \\frac{10}{s^2+7s+10}$.\n\nFor the second task, we compute the time-domain response $y(t)$ for a unit step reference $r(t)=1$ for $t \\ge 0$, which means $R(s) = \\frac{1}{s}$.\n$$ Y(s) = T_{yr}(s) R(s) = \\frac{10}{s^2+7s+10} \\cdot \\frac{1}{s} = \\frac{10}{s(s+2)(s+5)} $$\nWe use partial fraction expansion:\n$$ Y(s) = \\frac{A_{pfe}}{s} + \\frac{B_{pfe}}{s+2} + \\frac{C_{pfe}}{s+5} $$\nThe coefficients are found using the residue method:\n$$ A_{pfe} = \\lim_{s \\to 0} s Y(s) = \\lim_{s \\to 0} \\frac{10}{(s+2)(s+5)} = \\frac{10}{(2)(5)} = 1 $$\n$$ B_{pfe} = \\lim_{s \\to -2} (s+2) Y(s) = \\lim_{s \\to -2} \\frac{10}{s(s+5)} = \\frac{10}{(-2)(3)} = -\\frac{5}{3} $$\n$$ C_{pfe} = \\lim_{s \\to -5} (s+5) Y(s) = \\lim_{s \\to -5} \\frac{10}{s(s+2)} = \\frac{10}{(-5)(-3)} = \\frac{10}{15} = \\frac{2}{3} $$\nThus,\n$$ Y(s) = \\frac{1}{s} - \\frac{5}{3} \\frac{1}{s+2} + \\frac{2}{3} \\frac{1}{s+5} $$\nTaking the inverse Laplace transform gives the time response for $t \\ge 0$:\n$$ y(t) = 1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t) $$\n\nFinally, for the third task, we explain why the observer poles do not affect the reference-tracking response. The response of the system to both an input and initial conditions is given by the full solution to the state equations. In the Laplace domain, for the augmented system $(x, e)$, this is:\n$$ \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = (sI - \\mathcal{A}_{cl})^{-1} \\left( \\begin{pmatrix} x(0) \\\\ e(0) \\end{pmatrix} + \\mathcal{B}_{cl} R(s) \\right) $$\nwhere $\\mathcal{A}_{cl} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix}$ and $\\mathcal{B}_{cl} = \\begin{pmatrix} BN \\\\ 0 \\end{pmatrix}$.\nThe output is $Y(s) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = C X(s)$. We only need to solve for $X(s)$:\n$$ \\begin{pmatrix} sI-(A-BK) & -BK \\\\ 0 & sI-(A-LC) \\end{pmatrix} \\begin{pmatrix} X(s) \\\\ E(s) \\end{pmatrix} = \\begin{pmatrix} x(0)+BNR(s) \\\\ e(0) \\end{pmatrix} $$\nThis gives $(sI-(A-LC))E(s) = e(0)$ and $(sI-(A-BK))X(s) - BK E(s) = x(0)+BNR(s)$.\nSolving for $E(s)$ and $X(s)$:\n$$ E(s) = (sI-(A-LC))^{-1} e(0) $$\n$$ X(s) = (sI-(A-BK))^{-1} (x(0) + BNR(s)) + (sI-(A-BK))^{-1} BK (sI-(A-LC))^{-1} e(0) $$\nThe output is $Y(s) = C X(s)$. The expression for $Y(s)$ has three parts: response to $R(s)$, response to $x(0)$, and response to $e(0)$. The observer poles, which are the poles of $(sI-(A-LC))^{-1}$, only appear in the term multiplied by the initial estimation error $e(0)$.\nThe problem specifies the ideal case where system and observer start from rest: $x(0)=0$ and $\\hat{x}(0)=0$. This implies $e(0) = x(0) - \\hat{x}(0) = 0$. With $x(0)=0$ and $e(0)=0$, the expression for $X(s)$ simplifies to:\n$$ X(s) = (sI-(A-BK))^{-1} BNR(s) $$\nThe resulting output response $Y(s) = C(sI-(A-BK))^{-1} BNR(s)$ depends only on the regulator poles (eigenvalues of $A-BK$) and not on the observer poles (eigenvalues of $A-LC$). The observer modes are not excited because the initial estimation error is zero. This is a direct consequence of the separation principle and the specified zero initial conditions.", "answer": "$$\n\\boxed{1 - \\frac{5}{3}\\exp(-2t) + \\frac{2}{3}\\exp(-5t)}\n$$", "id": "2755501"}, {"introduction": "While the separation principle simplifies tracking design, it does not mean the observer is invisible to all signals. This practice [@problem_id:2755436] investigates the crucial issue of noise sensitivity by deriving the transfer function from measurement noise to the plant output. You will discover that this transfer function explicitly depends on the observer gain $L$, highlighting the fundamental trade-off between estimation speed and noise amplification in controller design.", "problem": "Consider a strictly proper, Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) plant given in state-space form by the equations\n$$\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),$$\nwith\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}.$$\nAn observer-based state-feedback controller is implemented with full-order Luenberger observer and static state feedback. The controller uses the measured output\n$$y_{m}(t) = y(t) + v(t),$$\nwhere $v(t)$ is additive measurement noise. The control law and observer are\n$$u(t) = -K \\hat{x}(t), \\quad \\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big),$$\nwith gains\n$$K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}.$$\nAssume zero initial conditions for $x(t)$ and $\\hat{x}(t)$. Using only fundamental state-space relations and the definition of the Luenberger observer, derive the closed-loop transfer function from the measurement noise input $v(t)$ to the plant output $y(t)$. Present your final answer as a single real-rational function of the Laplace variable $s$, denoted $G_{v \\to y}(s)$, where $Y(s) = G_{v \\to y}(s) V(s)$ under zero initial conditions. Then, by analyzing the derived expression, identify any finite zeros introduced by the observer dynamics and explain qualitatively how their locations depend on the observer gain $L$.\n\nYour final answer must be the single analytic expression for $G_{v \\to y}(s)$ in closed form. No numerical rounding is required and no units are needed.", "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim:\n- Plant model: $\\dot{x}(t) = A x(t) + B u(t)$, $y(t) = C x(t)$\n- Plant matrices: $A = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix}$, $B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $C = \\begin{pmatrix} 1 & 0 \\end{pmatrix}$\n- Measured output: $y_{m}(t) = y(t) + v(t)$\n- Control law: $u(t) = -K \\hat{x}(t)$\n- Observer dynamics: $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L\\big(y_{m}(t) - C \\hat{x}(t)\\big)$\n- Gain matrices: $K = \\begin{pmatrix} 6 & 4 \\end{pmatrix}$, $L = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix}$\n- Initial conditions: $x(0)=0$ and $\\hat{x}(0)=0$.\n- Objective: Derive the transfer function $G_{v \\to y}(s) = Y(s)/V(s)$ and analyze the zeros introduced by the observer.\n\nThe validation is performed. The problem is scientifically grounded in established principles of linear control theory, specifically the design of observer-based state-feedback controllers. It is well-posed, with all necessary data and definitions provided for a unique solution to be derived. The problem is objective and uses precise, standard terminology. No contradictions, ambiguities, or factual unsoundness are present. Therefore, the problem is deemed valid and a solution will be furnished.\n\nThe derivation will proceed from first principles using state-space analysis, which is the most rigorous method. The overall closed-loop system dynamics are described by the plant state $x(t)$ and the observer state $\\hat{x}(t)$. A more insightful representation is achieved using the plant state $x(t)$ and the estimation error $e(t) = x(t) - \\hat{x}(t)$.\n\nFirst, we derive the dynamics of the estimation error $e(t)$.\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\nSubstituting the given equations for $\\dot{x}(t)$ and $\\dot{\\hat{x}}(t)$:\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y_m(t) - C\\hat{x}(t))\\big) $$\nThe terms $B u(t)$ cancel. We substitute $y_m(t) = y(t) + v(t) = C x(t) + v(t)$:\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L\\big(C x(t) + v(t) - C\\hat{x}(t)\\big) $$\nGrouping terms with $x(t)$ and $\\hat{x}(t)$:\n$$ \\dot{e}(t) = A \\big(x(t) - \\hat{x}(t)\\big) - L C \\big(x(t) - \\hat{x}(t)\\big) - L v(t) $$\nRecognizing $e(t) = x(t) - \\hat{x}(t)$, we obtain the error dynamics:\n$$ \\dot{e}(t) = (A - LC) e(t) - L v(t) $$\nThis equation shows that the error dynamics are driven by the measurement noise $v(t)$ and are independent of the state $x(t)$, a key feature of the Luenberger observer.\n\nNext, we derive the dynamics of the plant state $x(t)$ under feedback. The control law is $u(t) = -K \\hat{x}(t)$. We express $\\hat{x}(t)$ as $x(t) - e(t)$.\n$$ u(t) = -K (x(t) - e(t)) $$\nSubstituting this into the plant state equation:\n$$ \\dot{x}(t) = A x(t) + B u(t) = A x(t) - B K (x(t) - e(t)) $$\n$$ \\dot{x}(t) = (A - BK) x(t) + BK e(t) $$\nThe state dynamics depend on both the state $x(t)$ and the estimation error $e(t)$.\n\nWe now have a combined state-space system in terms of the state vector $\\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$:\n$$ \\begin{pmatrix} \\dot{x}(t) \\\\ \\dot{e}(t) \\end{pmatrix} = \\begin{pmatrix} A-BK & BK \\\\ 0 & A-LC \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -L \\end{pmatrix} v(t) $$\nThe output equation is $y(t) = C x(t) = \\begin{pmatrix} C & 0 \\end{pmatrix} \\begin{pmatrix} x(t) \\\\ e(t) \\end{pmatrix}$.\n\nThe block-triangular structure of the system matrix demonstrates the separation principle: the poles of the closed-loop system are the union of the controller poles (eigenvalues of $A-BK$) and the observer poles (eigenvalues of $A-LC$).\n\nWe apply the Laplace transform to these equations, with zero initial conditions:\n$$ sX(s) = (A-BK)X(s) + BKE(s) $$\n$$ sE(s) = (A-LC)E(s) - LV(s) $$\n$$ Y(s) = CX(s) $$\n\nFrom the second equation, we solve for $E(s)$:\n$$ (sI - (A-LC))E(s) = -LV(s) \\implies E(s) = -(sI - A + LC)^{-1} L V(s) $$\nFrom the first equation, we solve for $X(s)$:\n$$ (sI - (A-BK))X(s) = BKE(s) \\implies X(s) = (sI - A + BK)^{-1} BKE(s) $$\nSubstituting the expression for $E(s)$ into the one for $X(s)$:\n$$ X(s) = -(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\nFinally, we find the output $Y(s)$:\n$$ Y(s) = CX(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L V(s) $$\nThe transfer function $G_{v \\to y}(s) = Y(s)/V(s)$ is therefore:\n$$ G_{v \\to y}(s) = -C(sI - A + BK)^{-1} BK (sI - A + LC)^{-1} L $$\nNow, we substitute the given numerical matrices.\n\nFirst, calculate the controller matrix $A_c = A-BK$:\n$$ BK = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} $$\n$$ A_c = A - BK = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ -10 & -7 \\end{pmatrix} $$\nThe characteristic polynomial for the controller is $\\det(sI - A_c) = \\det\\begin{pmatrix} s & -1 \\\\ 10 & s+7 \\end{pmatrix} = s(s+7) + 10 = s^2 + 7s + 10$.\n\nNext, calculate the observer matrix $A_o = A-LC$:\n$$ LC = \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} $$\n$$ A_o = A - LC = \\begin{pmatrix} 0 & 1 \\\\ -4 & -3 \\end{pmatrix} - \\begin{pmatrix} 10 & 0 \\\\ 8 & 0 \\end{pmatrix} = \\begin{pmatrix} -10 & 1 \\\\ -12 & -3 \\end{pmatrix} $$\nThe characteristic polynomial for the observer is $\\det(sI - A_o) = \\det\\begin{pmatrix} s+10 & -1 \\\\ 12 & s+3 \\end{pmatrix} = (s+10)(s+3) + 12 = s^2 + 13s + 30 + 12 = s^2 + 13s + 42$.\n\nThe denominator of $G_{v \\to y}(s)$ is the product of these two characteristic polynomials:\n$$ D(s) = (s^2 + 7s + 10)(s^2 + 13s + 42) = s^4 + 20s^3 + 143s^2 + 424s + 420 $$\nThe numerator is $N(s) = -C \\cdot \\text{adj}(sI - A_c) \\cdot BK \\cdot \\text{adj}(sI - A_o) \\cdot L$.\nA simpler calculation is to compute the numerator polynomial using intermediate terms:\n$N(s) = - \\text{det}(D(s)) \\cdot C(sI-A_c)^{-1}BK(sI-A_o)^{-1}L$\n$N(s) = - C \\cdot \\text{adj}(sI-A_c) \\cdot BK \\cdot \\text{adj}(sI-A_o) \\cdot L$\nLet's compute the product term by term:\n$$ C \\cdot \\text{adj}(sI - A_c) = \\begin{pmatrix} 1 & 0 \\end{pmatrix} \\begin{pmatrix} s+7 & 1 \\\\ -10 & s \\end{pmatrix} = \\begin{pmatrix} s+7 & 1 \\end{pmatrix} $$\n$$ \\text{adj}(sI - A_o) \\cdot L = \\begin{pmatrix} s+3 & 1 \\\\ -12 & s+10 \\end{pmatrix} \\begin{pmatrix} 10 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 10(s+3) + 8 \\\\ -120 + 8(s+10) \\end{pmatrix} = \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix} $$\nNow, let's assemble the numerator: $N(s) = - \\big( C \\cdot \\text{adj}(sI-A_c) \\big) \\cdot BK \\cdot \\big( \\text{adj}(sI-A_o) \\cdot L \\big)$. This is wrong, order matters. Let's use `C(sI-Ac)^{-1} * BK * (sI-Ao)^{-1} L`\n$$ C(sI-A_c)^{-1}BK = \\frac{1}{s^2+7s+10} \\begin{pmatrix} s+7 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 6 & 4 \\end{pmatrix} = \\frac{1}{s^2+7s+10} \\begin{pmatrix} 6 & 4 \\end{pmatrix} $$\n$$ (sI-A_o)^{-1}L = \\frac{1}{s^2+13s+42} \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix} $$\n$$ G_{v \\to y}(s) = - \\left( \\frac{1}{s^2+7s+10} \\begin{pmatrix} 6 & 4 \\end{pmatrix} \\right) \\left( \\frac{1}{s^2+13s+42} \\begin{pmatrix} 10s+38 \\\\ 8s-40 \\end{pmatrix} \\right) $$\n$$ G_{v \\to y}(s) = \\frac{- (6(10s+38) + 4(8s-40))}{(s^2+7s+10)(s^2+13s+42)} = \\frac{- (60s+228 + 32s-160)}{s^4+20s^3+143s^2+424s+420} $$\n$$ G_{v \\to y}(s) = \\frac{-(92s+68)}{s^4+20s^3+143s^2+424s+420} $$\n\nFor the second part of the question, we analyze this expression. The transfer function has a single finite zero at the root of the numerator, $s_z$, where $92s_z + 68 = 0$, which gives $s_z = -68/92 = -17/23$.\nThis zero is not present in the original plant, which has a transfer function $P(s) = C(sI-A)^{-1}B = \\frac{1}{s^2+3s+4}$ and no finite zeros. The zero is introduced by the controller-observer combination.\nThe zero of $G_{v \\to y}(s)$ is related to the zero of the dynamic compensator transfer function, $C_K(s)$, which maps the measured output $y_m$ to the control input $u$. This compensator is given by $C_K(s) = -K(sI - A + BK + LC)^{-1}L$. The zeros of $C_K(s)$ are the roots of the numerator polynomial $-K \\cdot \\text{adj}(sI - A + BK + LC) \\cdot L$.\nQualitatively, the numerator polynomial, which we calculated as $-(92s+68)$, has coefficients that are linear combinations of the elements of $K$ and $L$. For instance, the coefficient of $s$ is $60+32$, which came from $6(10) + 4(8)$, or more generally, from terms involving products like $k_i l_j$. Therefore, the location of this zero is directly manipulated by the choice of the observer gain matrix $L$. Varying $L$ reshapes the numerator polynomial of the compensator and, consequently, shifts the transmission zero from the measurement noise to the plant output.", "answer": "$$ \\boxed{\\frac{-92s-68}{s^4 + 20s^3 + 143s^2 + 424s + 420}} $$", "id": "2755436"}, {"introduction": "Bridging theory and practice is a hallmark of advanced engineering. This final exercise challenges you to design an experiment to empirically verify the theoretical independence of the reference-tracking transfer function from the observer gain, a concept explored in our first practice [@problem_id:2755501]. You must consider real-world non-idealities like measurement noise and initial transients to select a methodologically sound system identification protocol [@problem_id:2755556].", "problem": "Consider a Linear Time-Invariant (LTI) plant described by the state-space equations\n$$\\dot{x}(t)=A x(t)+B u(t), \\quad y(t)=C x(t),$$\nwith no direct term, so $D=0$. A full-order Luenberger observer is used together with static state-feedback and a reference prefilter. The controller-observer interconnection is\n$$u(t)=-K \\hat{x}(t)+N r(t),$$\n$$\\dot{\\hat{x}}(t)=A \\hat{x}(t)+B u(t)+L\\big(y(t)-C \\hat{x}(t)\\big),$$\nwhere $x(t)\\in\\mathbb{R}^n$, $u(t)\\in\\mathbb{R}^m$, $y(t)\\in\\mathbb{R}^p$, and $r(t)\\in\\mathbb{R}^q$. Assume that $(A,B)$ is stabilizable, $(A,C)$ is detectable, $A-BK$ is Hurwitz, and $A-LC$ is Hurwitz. The prefilter $N$ is chosen to achieve a desired steady-state tracking property and does not depend on $L$.\n\nStarting from these first principles and under the standard definition of a transfer function as the input-output map with $0$ initial conditions, show that the closed-loop transfer function from $r$ to $y$, denoted $T_{yr}(s)$, is independent of the observer gain $L$. Your derivation must eliminate internal variables and be based only on the above interconnection and the definitions of state-space to transfer-function mapping, without invoking any pre-memorized separation theorems.\n\nYou are then asked to design an empirically testable verification method for this independence that does not rely on knowing $(A,B,C)$. You will repeat a frequency-domain identification of $T_{yr}(s)$ while varying $L$ but keeping $K$ (and $N$) fixed, and you must account for identification bias due to measurement noise and initial transients in $\\hat{x}(t)$.\n\nWhich of the following experimental protocols provides a sound method to verify the independence of $T_{yr}(s)$ from $L$?\n\nA. Keep $K$ and $N$ fixed. Choose several stabilizing $L$ with distinct spectra. For each $L$, either reset to $0$ initial conditions or discard an initial time window long enough that the observer error transient governed by $A-LC$ is negligible. Apply the same persistently exciting $r(t)$ (e.g., filtered white noise) that is uncorrelated with measurement noise. Estimate the nonparametric Frequency Response Function (FRF) $\\widehat{T}_{yr}(\\mathrm{j}\\omega)$ using the closed-loop cross-spectral method $\\widehat{T}_{yr}(\\mathrm{j}\\omega)=\\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$ with Welch averaging, and compute asymptotic $95\\%$ confidence intervals. Conclude independence if the FRFs for different $L$ agree within confidence bounds over the excited band.\n\nB. Keep $K$ fixed and vary $L$. Use a single step input $r(t)$ for each $L$ and fit a second-order output-error model to $(r,y)$ for each experiment. Conclude independence if the two estimated natural frequencies match within $5\\%$.\n\nC. Keep $K$ fixed and vary $L$. Do not apply $r(t)$; instead rely on ambient measurement noise entering $y(t)$ to excite the loop, and identify $T_{yr}(s)$ from $(r,y)$ by treating $r(t)\\equiv 0$ and using an instrumental-variables estimator. Conclude independence if the identified models match.\n\nD. Keep $K$ fixed and vary $L$. Apply identical white-noise $r(t)$ signals in each experiment. Identify the transfer function from $r$ to $u$, and conclude independence of $T_{yr}(s)$ from $L$ if the $r\\to u$ transfer functions match across $L$.\n\nSelect the single best option.", "solution": "This problem consists of two parts. The first is a theoretical derivation to demonstrate a property of a controller-observer system. The second is to evaluate experimental methods for verifying this property. I will address each in turn, after validating the problem statement.\n\nThe problem statement is valid. It presents a standard configuration in linear control theory—a plant under state-feedback control with a Luenberger observer—and asks for a derivation of a known property, followed by an evaluation of system identification protocols. The premises are scientifically sound, well-posed, and objective. All assumptions, such as stabilizability, detectability, and Hurwitz stability of the closed-loop poles, are standard and appropriate. I will proceed with the solution.\n\n**Part 1: Derivation of the Transfer Function $T_{yr}(s)$**\n\nThe objective is to derive the transfer function $T_{yr}(s)$ from the reference input $r(t)$ to the plant output $y(t)$. The definition of a transfer function assumes all initial conditions are zero.\n\nThe given system equations are:\n1. Plant: $\\dot{x}(t) = A x(t) + B u(t)$\n2. Output: $y(t) = C x(t)$\n3. Control Law: $u(t) = -K \\hat{x}(t) + N r(t)$\n4. Observer: $\\dot{\\hat{x}}(t) = A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))$\n\nWe apply the Laplace transform to these equations, assuming zero initial conditions, i.e., $x(0)=0$ and $\\hat{x}(0)=0$. Let $X(s)$, $Y(s)$, $U(s)$, $\\hat{X}(s)$, and $R(s)$ be the Laplace transforms of $x(t)$, $y(t)$, $u(t)$, $\\hat{x}(t)$, and $r(t)$, respectively.\n\nThe transformed equations are:\n1. $sX(s) = AX(s) + BU(s)$\n2. $Y(s) = CX(s)$\n3. $U(s) = -K\\hat{X}(s) + NR(s)$\n4. $s\\hat{X}(s) = A\\hat{X}(s) + BU(s) + L(Y(s) - C\\hat{X}(s))$\n\nTo analyze the relationship between the true state $x(t)$ and the estimated state $\\hat{x}(t)$, we define the observer error $e(t) = x(t) - \\hat{x}(t)$. The dynamics of this error are found by differentiating $e(t)$:\n$$ \\dot{e}(t) = \\dot{x}(t) - \\dot{\\hat{x}}(t) $$\nSubstitute the expressions for $\\dot{x}(t)$ and $\\dot{\\hat{x}}(t)$:\n$$ \\dot{e}(t) = \\big(A x(t) + B u(t)\\big) - \\big(A \\hat{x}(t) + B u(t) + L(y(t) - C \\hat{x}(t))\\big) $$\nThe terms $B u(t)$ cancel. We substitute $y(t) = C x(t)$:\n$$ \\dot{e}(t) = A x(t) - A \\hat{x}(t) - L(C x(t) - C \\hat{x}(t)) $$\n$$ \\dot{e}(t) = (A - LC)\\big(x(t) - \\hat{x}(t)\\big) = (A - LC)e(t) $$\nThis is the observer error dynamics. It is a linear system driven only by its own state. The reference input $r(t)$ does not appear in this equation, meaning the error dynamics are decoupled from the reference command.\n\nTaking the Laplace transform of the error dynamics with zero initial conditions, $e(0) = x(0) - \\hat{x}(0) = 0 - 0 = 0$, we get:\n$$ sE(s) = (A - LC)E(s) $$\n$$ \\big(sI - (A - LC)\\big)E(s) = 0 $$\nThe problem states that $A - LC$ is Hurwitz, meaning all its eigenvalues have strictly negative real parts. The matrix $\\big(sI - (A - LC)\\big)$ is singular only if $s$ is an eigenvalue of $A - LC$. For any $s$ in the closed right-half complex plane ($\\text{Re}(s) \\ge 0$), this matrix is invertible. The equation must hold for all $s$ for which the transforms are defined. Since $E(s)$ is a vector of rational functions, for it to be zero over a region of the complex plane, it must be identically zero. Therefore, $E(s) = 0$ for all $s$.\n\nThis implies $X(s) - \\hat{X}(s) = 0$, or $X(s) = \\hat{X}(s)$. This is a crucial intermediate result. It means that, under the ideal conditions of zero initial state and no noise, the Laplace transform of the state estimate is identical to the transform of the true state.\n\nNow, we substitute $\\hat{X}(s) = X(s)$ into the control law (3):\n$$ U(s) = -KX(s) + NR(s) $$\nNext, substitute this expression for $U(s)$ into the plant state-space equation (1):\n$$ sX(s) = AX(s) + B\\big(-KX(s) + NR(s)\\big) $$\n$$ sX(s) = (A - BK)X(s) + BNR(s) $$\nWe can now solve for $X(s)$ in terms of $R(s)$:\n$$ \\big(sI - (A - BK)\\big)X(s) = BNR(s) $$\n$$ X(s) = (sI - A + BK)^{-1}BNR(s) $$\nThe problem states that $A-BK$ is Hurwitz, so the inverse $(sI - A + BK)^{-1}$ exists for $\\text{Re}(s) \\ge 0$.\n\nFinally, we find the output $Y(s)$ using equation (2):\n$$ Y(s) = CX(s) = C(sI - A + BK)^{-1}BNR(s) $$\nThe transfer function matrix from $r$ to $y$ is $T_{yr}(s)$ such that $Y(s) = T_{yr}(s)R(s)$. Therefore,\n$$ T_{yr}(s) = C(sI - A + BK)^{-1}BN $$\nThis final expression for the transfer function $T_{yr}(s)$ depends on the plant matrices $A$, $B$, $C$ and the controller gains $K$ and $N$. It does not depend on the observer gain matrix $L$. This completes the derivation.\n\n**Part 2: Evaluation of Experimental Protocols**\n\nThe task is to select the best experimental protocol to verify the independence of $T_{yr}(s)$ from $L$ without knowledge of $A$, $B$, and $C$.\n\n**Option A Analysis**\nThis protocol proposes to keep $K$ and $N$ fixed, choose several distinct stabilizing gains $L$, and for each $L$, identify the Frequency Response Function (FRF) $\\widehat{T}_{yr}(\\mathrm{j}\\omega)$ and compare the results.\n- **Handling Transients**: The protocol correctly advises to either reset initial conditions or discard an initial time window. This is critical because non-zero initial conditions $e(0)$ will cause a transient $e(t) = e^{(A-LC)t}e(0)$ in the observer error. The dynamics of this transient depend on $L$. To measure the steady-state transfer function, this transient effect must be eliminated.\n- **Excitation Signal**: It specifies a persistently exciting input $r(t)$ (e.g., filtered white noise). This is necessary to obtain sufficient information to identify the FRF over a broad frequency range.\n- **Identification Method**: It proposes the cross-spectral method $\\widehat{T}_{yr}(\\mathrm{j}\\omega) = \\widehat{S}_{yr}(\\omega)/\\widehat{S}_{rr}(\\omega)$. In a realistic setting, the measured output $y_m(t)$ is contaminated with noise, $y_m(t) = y(t) + v(t)$. This measurement noise $v(t)$ propagates through the observer, affecting $\\hat{x}(t)$ and $u(t)$. However, as long as the external reference $r(t)$ is uncorrelated with the measurement noise $v(t)$, the cross-spectrum $S_{y_m r}(\\omega)$ is unaffected by $v(t)$. Thus, this estimator yields an asymptotically unbiased estimate of the true FRF $T_{yr}(\\mathrm{j}\\omega)$.\n- **Statistical Comparison**: It suggests computing confidence intervals and checking for agreement within these bounds. This provides a statistically rigorous basis for concluding whether the identified functions are the same or different.\nThis protocol is comprehensive, methodologically sound, and adheres to best practices in system identification.\n**Verdict: Correct.**\n\n**Option B Analysis**\nThis protocol uses a step input and fits a second-order model.\n- **Excitation Signal**: A step input is not persistently exciting. Its energy is concentrated at low frequencies, making it unsuitable for identifying a full frequency response.\n- **Model Structure**: The true system order is unknown and is likely not $2$. Forcing an incorrect low-order model structure (model-order misspecification) will lead to a biased, inaccurate estimate of the transfer function.\n- **Comparison Metric**: Comparing only one or two parameters (like natural frequencies) of a wrongly-structured model is a grossly insufficient test for the equality of two transfer functions.\nThis protocol is deeply flawed and is unlikely to produce a reliable conclusion.\n**Verdict: Incorrect.**\n\n**Option C Analysis**\nThis protocol suggests not applying an external reference $r(t)$ and relying on ambient noise for excitation.\n- **No Input**: The quantity to be identified is $T_{yr}(s)$, the transfer function from $r$ to $y$. It is impossible to identify this transfer function if the input $r(t)$ is identically zero. There is no cause-and-effect relationship to measure.\n- **Excitation Source**: The system dynamics would be driven by measurement noise $v(t)$. One could attempt to identify the transfer function from $v(t)$ to $y_m(t)$. As shown in the preliminary analysis, this transfer function, $T_{y_m v}(s)$, *does* depend on $L$. An experiment would show that the system's noise response changes with $L$, which is expected and does not contradict the theory about $T_{yr}(s)$. This protocol is fundamentally misguided.\n**Verdict: Incorrect.**\n\n**Option D Analysis**\nThis protocol suggests identifying the transfer function from $r$ to $u$, $T_{ur}(s)$, and checking if it is independent of $L$.\n- **Theoretical Basis**: The theoretical transfer function is $T_{ur}(s) = N - K(sI-A+BK)^{-1}BN$. This is indeed independent of $L$. So, the fundamental idea is valid.\n- **Protocol Completeness**: The protocol is naively stated. It says \"identify the transfer function\" without specifying a method or accounting for practical issues. In the presence of measurement noise $v(t)$ on $y(t)$, the observer error $e(t)$ is non-zero and a function of $v(t)$ and $L$. The control signal is $u(t) = -K(x(t)-e(t)) + Nr(t)$. Thus, $u(t)$ is contaminated by a noise term that depends on $L$. A simple identification method (e.g., based on ordinary least-squares) would produce a biased estimate of $T_{ur}(s)$, and this bias would be $L$-dependent. This would lead to the erroneous conclusion that $T_{ur}(s)$ depends on $L$.\n- **Comparison to A**: Option A explicitly prescribes a method (cross-spectral analysis) that overcomes this very problem of noise-induced bias. Option D does not. Therefore, Option A is a complete and robust protocol, while Option D is an incomplete and fragile one.\n**Verdict: Incorrect.**\n\n**Conclusion**\nOption A describes a rigorous and practically feasible experimental design that correctly accounts for the major challenges in closed-loop system identification, namely initial transients and measurement noise. It is the only option that represents a sound scientific method for the proposed verification task.", "answer": "$$\\boxed{A}$$", "id": "2755556"}]}