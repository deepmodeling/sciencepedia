{"hands_on_practices": [{"introduction": "A transfer function provides an external, input-output description of a system, while a state-space realization offers a view into its internal dynamics. This exercise provides fundamental practice in bridging this gap by constructing a state-space model from a given transfer function [@problem_id:2724248]. You will apply a systematic procedure to derive the controllable companion form, a canonical structure that is instrumental in control design, and then verify if the resulting model is minimal, a critical step in ensuring the realization is efficient and well-behaved.", "problem": "Consider the single-input single-output transfer function $G(s)$ with a monic denominator polynomial and a proper numerator polynomial\n$$\nG(s) \\;=\\; \\frac{2 s^{3} + 3 s^{2} + 7 s + 5}{s^{3} + 4 s^{2} + 5 s + 2}.\n$$\nStart from the state-space definition of a transfer function $G(s) = D + C\\,(s I - A)^{-1} B$ and the notion of controllable companion canonical form, which places the denominator coefficients of the transfer function into a companion matrix representation for the state matrix. Using only these foundational ideas, do the following:\n- Construct a controllable companion form realization of $G(s)$ by explicitly determining the matrices $A \\in \\mathbb{R}^{3 \\times 3}$, $B \\in \\mathbb{R}^{3 \\times 1}$, $C \\in \\mathbb{R}^{1 \\times 3}$, and the scalar $D \\in \\mathbb{R}$.\n- Justify that the realization you obtain is minimal by verifying controllability and observability from first principles, without invoking any unproven shortcuts. Briefly state why a balanced realization exists in principle for this system once minimality and stability are established.\n- For your final reported value, compute the determinant $\\det(A)$ as a real number.\n\nReport only the value of $\\det(A)$ as your final answer. No rounding is required.", "solution": "The problem givens are a single-input single-output (SISO) transfer function\n$$\nG(s) \\;=\\; \\frac{2 s^{3} + 3 s^{2} + 7 s + 5}{s^{3} + 4 s^{2} + 5 s + 2}\n$$\nand the state-space model definition $G(s) = D + C(sI - A)^{-1}B$. The problem requires the construction of a controllable companion form realization, a proof of its minimality, a justification for the existence of a balanced realization, and the computation of the determinant of the state matrix $A$. The problem is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. Therefore, it is deemed valid, and we proceed with the solution.\n\nThe order of the numerator and denominator polynomials are equal, both being $3$. This means the transfer function is proper, but not strictly proper. To find a state-space realization, we must first separate the transfer function into a constant term $D$ and a strictly proper part $G_{sp}(s)$ using polynomial long division.\n$$\nG(s) = D + G_{sp}(s) = D + \\frac{N_r(s)}{P(s)}\n$$\nwhere $P(s) = s^{3} + 4 s^{2} + 5 s + 2$ is the denominator polynomial. The constant $D$ is the ratio of the leading coefficients of the numerator and the denominator.\n$$\nD = \\frac{2}{1} = 2\n$$\nThe remainder polynomial $N_r(s)$ is found by subtracting $D \\cdot P(s)$ from the original numerator.\n$$\nN_r(s) = (2 s^{3} + 3 s^{2} + 7 s + 5) - 2(s^{3} + 4 s^{2} + 5 s + 2)\n$$\n$$\nN_r(s) = (2 s^{3} + 3 s^{2} + 7 s + 5) - (2s^{3} + 8 s^{2} + 10 s + 4)\n$$\n$$\nN_r(s) = -5 s^{2} - 3 s + 1\n$$\nThus, the transfer function is decomposed as:\n$$\nG(s) = 2 + \\frac{-5 s^{2} - 3 s + 1}{s^{3} + 4 s^{2} + 5 s + 2}\n$$\nNow, we construct the controllable companion form realization for the strictly proper part $G_{sp}(s)$. Let the denominator be $P(s) = s^3 + a_2 s^2 + a_1 s + a_0$ and the numerator of the strictly proper part be $N_r(s) = b_2 s^2 + b_1 s + b_0$. By comparison, we have:\n$a_2 = 4$, $a_1 = 5$, $a_0 = 2$.\n$b_2 = -5$, $b_1 = -3$, $b_0 = 1$.\n\nThe controllable companion form matrices $(A, B, C)$ for a third-order system are defined as:\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -a_0  -a_1  -a_2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0  b_1  b_2 \\end{pmatrix}\n$$\nSubstituting the coefficients, we obtain the realization:\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1  -3  -5 \\end{pmatrix}, \\quad D = 2\n$$\n\nNext, we verify the minimality of this realization. A realization is minimal if and only if it is both controllable and observable.\n\nTo verify controllability, we form the controllability matrix $\\mathcal{C}$ and check its rank.\n$$\n\\mathcal{C} = \\begin{pmatrix} B  AB  A^2B \\end{pmatrix}\n$$\nWe compute the columns:\n$B = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$\n$AB = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix}$\n$A^2B = A(AB) = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ -5+16 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -4 \\\\ 11 \\end{pmatrix}$\nThe controllability matrix is:\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  0  1 \\\\ 0  1  -4 \\\\ 1  -4  11 \\end{pmatrix}\n$$\nIts determinant is $\\det(\\mathcal{C}) = 1 \\cdot (0 \\cdot (-4) - 1 \\cdot 1) = -1$. Since $\\det(\\mathcal{C}) \\neq 0$, the matrix has full rank ($3$), and the system is controllable. This is expected, as we constructed the realization in controllable companion form.\n\nTo verify observability, we form the observability matrix $\\mathcal{O}$ and check its rank.\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\end{pmatrix}\n$$\nWe compute the rows:\n$C = \\begin{pmatrix} 1  -3  -5 \\end{pmatrix}$\n$CA = \\begin{pmatrix} 1  -3  -5 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix} = \\begin{pmatrix} 10  1+25  -3+20 \\end{pmatrix} = \\begin{pmatrix} 10  26  17 \\end{pmatrix}$\n$CA^2 = (CA)A = \\begin{pmatrix} 10  26  17 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix} = \\begin{pmatrix} -34  10-85  26-68 \\end{pmatrix} = \\begin{pmatrix} -34  -75  -42 \\end{pmatrix}$\nThe observability matrix is:\n$$\n\\mathcal{O} = \\begin{pmatrix} 1  -3  -5 \\\\ 10  26  17 \\\\ -34  -75  -42 \\end{pmatrix}\n$$\nIts determinant is:\n$\\det(\\mathcal{O}) = 1(26(-42) - 17(-75)) - (-3)(10(-42) - 17(-34)) - 5(10(-75) - 26(-34))$\n$\\det(\\mathcal{O}) = 1(-1092 + 1275) + 3(-420 + 578) - 5(-750 + 884)$\n$\\det(\\mathcal{O}) = 1(183) + 3(158) - 5(134) = 183 + 474 - 670 = -13$.\nSince $\\det(\\mathcal{O}) \\neq 0$, the matrix has full rank ($3$), and the system is observable. Because the realization is both controllable and observable, it is minimal. This implies there are no pole-zero cancellations in the original transfer function $G(s)$.\n\nA balanced realization exists for any linear time-invariant system that is both minimal (controllable and observable) and stable. We have established minimality. We now check stability. The system's poles are the eigenvalues of the state matrix $A$, which are the roots of the characteristic equation $\\det(sI - A) = 0$. By construction, this is the denominator polynomial $P(s) = s^{3} + 4 s^{2} + 5 s + 2 = 0$. We can find the roots by testing integer factors of the constant term $2$.\nFor $s=-1$: $(-1)^3 + 4(-1)^2 + 5(-1) + 2 = -1 + 4 - 5 + 2 = 0$.\nFor $s=-2$: $(-2)^3 + 4(-2)^2 + 5(-2) + 2 = -8 + 16 - 10 + 2 = 0$.\nFactoring out $(s+1)(s+2) = s^2+3s+2$, we find $P(s) = (s^2+3s+2)(s+1) = (s+1)^2(s+2)$.\nThe eigenvalues (poles) are $\\lambda_1 = -1$ (with algebraic multiplicity $2$) and $\\lambda_2 = -2$. Since all eigenvalues have strictly negative real parts, the system is asymptotically stable. As the system is minimal and stable, the controllability and observability Gramians exist, are positive definite, and a balancing transformation can be found. Thus, a balanced realization exists.\n\nFinally, we compute the determinant of the state matrix $A$.\n$$\nA = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ -2  -5  -4 \\end{pmatrix}\n$$\nUsing cofactor expansion along the first row:\n$$\n\\det(A) = 0 \\cdot \\det\\begin{pmatrix} 0  1 \\\\ -5  -4 \\end{pmatrix} - 1 \\cdot \\det\\begin{pmatrix} 0  1 \\\\ -2  -4 \\end{pmatrix} + 0 \\cdot \\det\\begin{pmatrix} 0  0 \\\\ -2  -5 \\end{pmatrix}\n$$\n$$\n\\det(A) = -1 \\cdot ((0)(-4) - (1)(-2)) = -1 \\cdot (0 - (-2)) = -1 \\cdot (2) = -2\n$$\nAlternatively, the determinant of a companion matrix of this form is given by $(-1)^{n-1}(-a_0)$ or by noting that $\\det(A) = (-1)^n \\det(-A)$ and $\\det(-A) = (-1)^n \\cdot (\\text{characteristic polynomial evaluated at } s=0)$.\n$\\det(sI-A) = s^3+4s^2+5s+2$.\nAt $s=0$, $\\det(-A) = 2$.\nFor $n=3$, $\\det(-A) = (-1)^3 \\det(A) = -\\det(A)$.\nSo, $-\\det(A) = 2$, which gives $\\det(A) = -2$. The result is consistent.", "answer": "$$\n\\boxed{-2}\n$$", "id": "2724248"}, {"introduction": "A state-space realization is not guaranteed to be minimal; it may contain states that are either impossible to influence with the input or whose behavior is invisible to the output. This practice moves beyond a simple rank test for minimality to a deeper diagnostic analysis [@problem_id:2724291]. By computing the unreachable and unobservable subspaces directly, you will learn to dissect a system's state-space structure, identifying precisely which dynamics are redundant and paving the way for systematic model reduction.", "problem": "Consider the Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) state-space system\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t),\n$$\nwith state $x(t) \\in \\mathbb{R}^{4}$, input $u(t) \\in \\mathbb{R}$, and output $y(t) \\in \\mathbb{R}$, where\n$$\nA = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  0  0 \\\\\n0  0  -1  1 \\\\\n0  0  0  -2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1  0  0  0\n\\end{bmatrix}.\n$$\nUse first principles of controllability and observability for state-space systems to detect nonminimality by explicitly computing the nullspaces of the controllability and observability matrices and interpreting them in terms of unreachability and unobservability.\n\nTasks:\n1. Using the definition of the controllable subspace for an LTI system, form the controllability matrix\n$$\n\\mathcal{C} = \\begin{bmatrix} B  A B  A^{2} B  A^{3} B \\end{bmatrix},\n$$\nand compute the nullspace of $\\mathcal{C}^{\\top}$.\n2. Using the definition of the unobservable subspace for an LTI system, form the observability matrix\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ C A \\\\ C A^{2} \\\\ C A^{3} \\end{bmatrix},\n$$\nand compute the nullspace of $\\mathcal{O}$.\n3. Explain how these nullspaces reveal unreachability and unobservability in the given system and infer whether the system is minimal. Determine the order $n_{\\min}$ of a minimal realization obtained by removing unreachable and unobservable state components.\n\nAnswer specification:\n- Your final reported answer must be the single integer value of $n_{\\min}$.\n- No rounding is required.\n- Do not include any units in the final reported answer.", "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. It represents a standard exercise in linear systems theory. We proceed with the solution.\n\nThe system is a linear time-invariant (LTI) state-space model of order $n=4$:\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t)\n$$\nwith matrices\n$$\nA = \\begin{bmatrix}\n0  1  0  0 \\\\\n0  0  0  0 \\\\\n0  0  -1  1 \\\\\n0  0  0  -2\n\\end{bmatrix}, \\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0 \\\\ 0\n\\end{bmatrix}, \\quad\nC = \\begin{bmatrix}\n1  0  0  0\n\\end{bmatrix}.\n$$\nA system realization is minimal if and only if it is both completely controllable and completely observable. We will assess these two properties in sequence.\n\nFirst, we analyze the controllability of the system. The controllable subspace, $\\mathcal{S}_c$, is the subspace of states reachable from the origin. It is defined as the range of the controllability matrix $\\mathcal{C}$. The problem instructs us to form this matrix:\n$$\n\\mathcal{C} = \\begin{bmatrix} B  A B  A^{2} B  A^{3} B \\end{bmatrix}\n$$\nWe compute the necessary matrix products:\n$$\nB = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$$\nAB = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  -1  1 \\\\ 0  0  0  -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\n$$\nA^2B = A(AB) = \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  -1  1 \\\\ 0  0  0  -2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}\n$$\nSince $A^2B$ is the zero vector, it follows that all higher powers will also be zero: $A^3B = A(A^2B) = 0$.\nThe controllability matrix is therefore:\n$$\n\\mathcal{C} = \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{bmatrix}\n$$\nThe rank of $\\mathcal{C}$ is $\\text{rank}(\\mathcal{C}) = 2$. Since $\\text{rank}(\\mathcal{C})  n = 4$, the system is not completely controllable. The states that are not reachable form the unreachable subspace, $\\mathcal{S}_{ur}$, which is the orthogonal complement of the controllable subspace $\\mathcal{S}_c = \\mathcal{R}(\\mathcal{C})$. The unreachable subspace is equivalent to the nullspace of the transpose of the controllability matrix, $\\mathcal{S}_{ur} = \\mathcal{N}(\\mathcal{C}^{\\top})$. We compute this nullspace.\n$$\n\\mathcal{C}^{\\top} = \\begin{bmatrix} 0  1  0  0 \\\\ 1  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{bmatrix}\n$$\nWe seek vectors $v = [v_1, v_2, v_3, v_4]^{\\top}$ such that $\\mathcal{C}^{\\top}v = 0$. This leads to the system of equations $v_2 = 0$ and $v_1 = 0$. The variables $v_3$ and $v_4$ are free. Thus, any vector in $\\mathcal{N}(\\mathcal{C}^{\\top})$ can be written as:\n$$\nv = v_3 \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + v_4 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\nThe nullspace of $\\mathcal{C}^{\\top}$, which is the unreachable subspace, is spanned by the basis vectors $\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\}$. The dimension of the unreachable subspace is $2$. This subspace corresponds to the third and fourth components of the state vector, which cannot be influenced by the input $u(t)$.\n\nSecond, we analyze the observability of the system. The unobservable subspace, $\\mathcal{S}_{uo}$, is the set of initial states that produce zero output for all time with zero input. It is defined as the nullspace of the observability matrix $\\mathcal{O}$.\n$$\n\\mathcal{O} = \\begin{bmatrix} C \\\\ C A \\\\ C A^{2} \\\\ C A^{3} \\end{bmatrix}\n$$\nWe compute the necessary matrix products:\n$$\nC = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix}\n$$\n$$\nCA = \\begin{bmatrix} 1  0  0  0 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  -1  1 \\\\ 0  0  0  -2 \\end{bmatrix} = \\begin{bmatrix} 0  1  0  0 \\end{bmatrix}\n$$\n$$\nCA^2 = (CA)A = \\begin{bmatrix} 0  1  0  0 \\end{bmatrix} \\begin{bmatrix} 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  -1  1 \\\\ 0  0  0  -2 \\end{bmatrix} = \\begin{bmatrix} 0  0  0  0 \\end{bmatrix}\n$$\nSince $CA^2$ is the zero vector, $CA^3 = (CA^2)A = 0$. The observability matrix is:\n$$\n\\mathcal{O} = \\begin{bmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{bmatrix}\n$$\nThe rank of $\\mathcal{O}$ is $\\text{rank}(\\mathcal{O}) = 2$. Since $\\text{rank}(\\mathcal{O})  n = 4$, the system is not completely observable. The unobservable subspace $\\mathcal{S}_{uo}$ is the nullspace of $\\mathcal{O}$. We seek vectors $x = [x_1, x_2, x_3, x_4]^{\\top}$ such that $\\mathcal{O}x = 0$. This leads to the system of equations $x_1 = 0$ and $x_2 = 0$. The variables $x_3$ and $x_4$ are free. Any vector in $\\mathcal{N}(\\mathcal{O})$ can be written as:\n$$\nx = x_3 \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{bmatrix} + x_4 \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{bmatrix}\n$$\nThe nullspace of $\\mathcal{O}$, which is the unobservable subspace, is spanned by the basis vectors $\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\}$. The dimension of the unobservable subspace is $2$. This indicates that the third and fourth components of the state vector have no effect on the output $y(t)$.\n\nThe system is neither controllable nor observable, and therefore the realization is not minimal. The order of a minimal realization, $n_{\\min}$, is the dimension of the subspace of states that are both controllable and observable. This is given by the dimension of the intersection of the controllable subspace $\\mathcal{S}_c$ and the observable subspace $\\mathcal{S}_o$.\nFrom our analysis:\nThe controllable subspace is the range of $\\mathcal{C}$: $\\mathcal{S}_c = \\mathcal{R}(\\mathcal{C}) = \\text{span}\\{[0,1,0,0]^{\\top}, [1,0,0,0]^{\\top}\\} = \\text{span}\\{e_1, e_2\\}$.\nThe observable subspace $\\mathcal{S}_o$ is the orthogonal complement of the unobservable subspace $\\mathcal{S}_{uo}$.\n$\\mathcal{S}_{uo} = \\mathcal{N}(\\mathcal{O}) = \\text{span}\\{[0,0,1,0]^{\\top}, [0,0,0,1]^{\\top}\\} = \\text{span}\\{e_3, e_4\\}$.\nTherefore, $\\mathcal{S}_o = (\\mathcal{S}_{uo})^\\perp = (\\text{span}\\{e_3, e_4\\})^\\perp = \\text{span}\\{e_1, e_2\\}$.\nThe intersection is $\\mathcal{S}_{co} = \\mathcal{S}_c \\cap \\mathcal{S}_o = \\text{span}\\{e_1, e_2\\} \\cap \\text{span}\\{e_1, e_2\\} = \\text{span}\\{e_1, e_2\\}$.\nThe dimension of this subspace is $n_{\\min} = \\dim(\\mathcal{S}_{co}) = 2$.\nThe minimal realization of this system has order $2$. This corresponds to the subsystem $(A_{11}, B_1, C_1)$ associated with states $x_1$ and $x_2$, which is both controllable and observable. The dynamics of states $x_3$ and $x_4$ are both unreachable from the input and unobservable from the output.\nThe order of the minimal realization is $n_{\\min} = 2$.", "answer": "$$\\boxed{2}$$", "id": "2724291"}, {"introduction": "In practical engineering, a system's mathematical model is often unknown and must be derived from experimental data. This exercise introduces a cornerstone technique in system identification that builds a state-space model from a sequence of input-output measurements, known as Markov parameters [@problem_id:2724259]. You will construct a block Hankel matrix from this data and discover how its rank remarkably reveals the McMillan degree—the order of the minimal underlying system—which is the central insight of the Ho-Kalman realization algorithm.", "problem": "Consider a discrete-time, linear time-invariant (LTI) Multiple-Input Multiple-Output (MIMO) system with single input and three outputs. Its Markov parameters are defined by $h_{k} = C A^{k-1} B$ for $k \\geq 1$, where $A \\in \\mathbb{R}^{n \\times n}$, $B \\in \\mathbb{R}^{n \\times 1}$, $C \\in \\mathbb{R}^{3 \\times n}$, and the direct feedthrough matrix is $D = 0$. Suppose the Markov parameters $h_{k} \\in \\mathbb{R}^{3 \\times 1}$ are given implicitly by the modal superposition\n$$\nh_{k} \\;=\\; \\sum_{i=1}^{3} \\lambda_{i}^{\\,k-1} \\, a_{i} \\, b_{i},\n$$\nwith the distinct scalars $\\lambda_{1} = \\tfrac{1}{2}$, $\\lambda_{2} = -\\tfrac{1}{3}$, $\\lambda_{3} = \\tfrac{1}{4}$, the nonzero output-direction vectors $a_{1} = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$, $a_{2} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$, $a_{3} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$ in $\\mathbb{R}^{3}$, and the nonzero input-direction scalars $b_{1} = 1$, $b_{2} = 2$, $b_{3} = 3$. For fixed positive integers $f$ and $p$, the block Hankel matrix $H_{f,p}$ associated with the Ho–Kalman (HK) algorithm is defined by\n$$\nH_{f,p}\n\\;=\\;\n\\begin{bmatrix}\nh_{1}  h_{2}  \\cdots  h_{p} \\\\\nh_{2}  h_{3}  \\cdots  h_{p+1} \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\nh_{f}  h_{f+1}  \\cdots  h_{f+p-1}\n\\end{bmatrix}\n\\in \\mathbb{R}^{3 f \\times 1 \\cdot p}.\n$$\n\nTasks:\n1. Construct the explicit $9 \\times 3$ block Hankel matrix $H_{3,3}$ using the definition above and the specified $h_{k}$. Write out $h_{1}$ through $h_{5}$ numerically and populate $H_{3,3}$ accordingly.\n2. Starting from the foundational definitions of controllability and observability, and the Ho–Kalman factorization $H_{f,p} = O_{f} \\, C_{p}$ with the block observability matrix $O_{f}$ and block controllability matrix $C_{p}$, derive why, for a minimal realization and for $f \\geq n$ and $p \\geq n$, one has $\\operatorname{rank}(H_{f,p}) = n$, where $n$ is the McMillan degree (system order).\n3. For the provided Markov parameters, exhibit an explicit factorization of $H_{3,3}$ as $O_{3} C_{3}$, show that both $O_{3}$ and $C_{3}$ have inner-dimension rank equal to $3$, and hence compute $\\operatorname{rank}(H_{3,3})$.\n4. Report the inferred minimal system order $n$ as a single integer. No rounding is necessary. No units are required. Your final answer must be a single number.\n\nYour final reported answer must be the value of $n$ only.", "solution": "The problem is subjected to validation and is found to be well-posed, scientifically grounded, and contains sufficient information for a unique solution. We proceed with the analysis.\n\nThe problem requires the determination of the minimal system order, or McMillan degree $n$, of a discrete-time linear time-invariant system. The system has a single input and three outputs. Its dynamics are characterized by a sequence of Markov parameters $h_k \\in \\mathbb{R}^{3 \\times 1}$, for $k \\ge 1$. The direct feedthrough matrix is $D=0$.\n\nThe Markov parameters are given by the modal superposition:\n$$\nh_{k} \\;=\\; \\sum_{i=1}^{3} \\lambda_{i}^{k-1} \\, a_{i} \\, b_{i}\n$$\nwith distinct scalars $\\lambda_1 = \\frac{1}{2}$, $\\lambda_2 = -\\frac{1}{3}$, $\\lambda_3 = \\frac{1}{4}$, output-direction vectors $a_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$, $a_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}$, $a_3 = \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix}$, and input-direction scalars $b_1 = 1$, $b_2 = 2$, $b_3 = 3$.\n\nThis expression for $h_k$ can be written in vector form as:\n$$\nh_k = \\lambda_1^{k-1} b_1 a_1 + \\lambda_2^{k-1} b_2 a_2 + \\lambda_3^{k-1} b_3 a_3 = \\begin{pmatrix} 1 \\cdot (\\frac{1}{2})^{k-1} \\\\ 2 \\cdot (-\\frac{1}{3})^{k-1} \\\\ 3 \\cdot (\\frac{1}{4})^{k-1} \\end{pmatrix}\n$$\n\n**Task 1: Construction of the Block Hankel Matrix $H_{3,3}$**\n\nFirst, we compute the necessary Markov parameters $h_1$ through $h_5$:\nFor $k=1$: $h_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$\nFor $k=2$: $h_2 = \\begin{pmatrix} \\frac{1}{2} \\\\ 2(-\\frac{1}{3}) \\\\ 3(\\frac{1}{4}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{2}{3} \\\\ \\frac{3}{4} \\end{pmatrix}$\nFor $k=3$: $h_3 = \\begin{pmatrix} (\\frac{1}{2})^2 \\\\ 2(-\\frac{1}{3})^2 \\\\ 3(\\frac{1}{4})^2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{2}{9} \\\\ \\frac{3}{16} \\end{pmatrix}$\nFor $k=4$: $h_4 = \\begin{pmatrix} (\\frac{1}{2})^3 \\\\ 2(-\\frac{1}{3})^3 \\\\ 3(\\frac{1}{4})^3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{8} \\\\ -\\frac{2}{27} \\\\ \\frac{3}{64} \\end{pmatrix}$\nFor $k=5$: $h_5 = \\begin{pmatrix} (\\frac{1}{2})^4 \\\\ 2(-\\frac{1}{3})^4 \\\\ 3(\\frac{1}{4})^4 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{16} \\\\ \\frac{2}{81} \\\\ \\frac{3}{256} \\end{pmatrix}$\n\nThe block Hankel matrix $H_{3,3}$ is defined as:\n$$\nH_{3,3} = \\begin{bmatrix} h_1  h_2  h_3 \\\\ h_2  h_3  h_4 \\\\ h_3  h_4  h_5 \\end{bmatrix}\n$$\nSubstituting the computed values, the $9 \\times 3$ matrix $H_{3,3}$ is:\n$$\nH_{3,3} = \\begin{pmatrix}\n1  \\frac{1}{2}  \\frac{1}{4} \\\\\n2  -\\frac{2}{3}  \\frac{2}{9} \\\\\n3  \\frac{3}{4}  \\frac{3}{16} \\\\\n\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{8} \\\\\n-\\frac{2}{3}  \\frac{2}{9}  -\\frac{2}{27} \\\\\n\\frac{3}{4}  \\frac{3}{16}  \\frac{3}{64} \\\\\n\\frac{1}{4}  \\frac{1}{8}  \\frac{1}{16} \\\\\n\\frac{2}{9}  -\\frac{2}{27}  \\frac{2}{81} \\\\\n\\frac{3}{16}  \\frac{3}{64}  \\frac{3}{256}\n\\end{pmatrix}\n$$\n\n**Task 2: Derivation of the Rank Property of the Hankel Matrix**\n\nThe Markov parameters of a state-space realization $(A, B, C)$ are $h_k = C A^{k-1} B$. The block Hankel matrix $H_{f,p}$ can be factored as the product of the block observability matrix $O_f$ and the block controllability matrix $C_p$.\n$$\nO_f = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{f-1} \\end{bmatrix} \\in \\mathbb{R}^{(3f) \\times n} \\quad , \\quad C_p = \\begin{bmatrix} B  AB  \\cdots  A^{p-1}B \\end{bmatrix} \\in \\mathbb{R}^{n \\times p}\n$$\nThe factorization is $H_{f,p} = O_f C_p$:\n$$\nH_{f,p} = \\begin{bmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{f-1} \\end{bmatrix} \\begin{bmatrix} B  AB  \\cdots  A^{p-1}B \\end{bmatrix} = \\begin{bmatrix} CB  CAB  \\cdots  CA^{p-1}B \\\\ CAB  CA^2B  \\cdots  CA^pB \\\\ \\vdots  \\vdots  \\ddots  \\vdots \\\\ CA^{f-1}B  CA^fB  \\cdots  CA^{f+p-2}B \\end{bmatrix}\n$$\nA realization is minimal if and only if it is both controllable and observable. For a system of order $n$, this means the controllability Gramian $C_n$ and observability Gramian $O_n$ have full rank: $\\operatorname{rank}(C_n) = n$ and $\\operatorname{rank}(O_n) = n$. By the Cayley-Hamilton theorem, any power of $A$ higher than $n-1$ is a linear combination of lower powers. This implies that if $\\operatorname{rank}(C_n)=n$, then $\\operatorname{rank}(C_p)=n$ for all $p \\ge n$. Similarly, if $\\operatorname{rank}(O_n)=n$, then $\\operatorname{rank}(O_f)=n$ for all $f \\ge n$.\n\nFor a minimal realization of order $n$, and for choices of $f \\ge n$ and $p \\ge n$, we have $\\operatorname{rank}(O_f) = n$ and $\\operatorname{rank}(C_p) = n$. The rank of the product $H_{f,p} = O_f C_p$ is bounded by $\\operatorname{rank}(H_{f,p}) \\le \\min(\\operatorname{rank}(O_f), \\operatorname{rank}(C_p)) = \\min(n, n) = n$.\nBy Sylvester's rank inequality, $\\operatorname{rank}(O_f) + \\operatorname{rank}(C_p) - n \\le \\operatorname{rank}(O_f C_p)$.\nSubstituting the ranks, we get $n + n - n \\le \\operatorname{rank}(H_{f,p})$, which simplifies to $n \\le \\operatorname{rank}(H_{f,p})$.\nCombining the two inequalities, $n \\le \\operatorname{rank}(H_{f,p}) \\le n$, it is established that $\\operatorname{rank}(H_{f,p}) = n$. The McMillan degree $n$ is thus equal to the rank of the Hankel matrix for sufficiently large $f$ and $p$.\n\n**Task 3: Factorization of $H_{3,3}$ and Rank Computation**\n\nThe given modal form of $h_k$ suggests a diagonal realization $(A,B,C)$ of order $n=3$. We can construct such a realization and verify its minimality. Let $n=3$ and define:\n$$\nA = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  -\\frac{1}{3}  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix}\n$$\n$$\nB = \\begin{pmatrix} b_1 \\\\ b_2 \\\\ b_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nC = \\begin{bmatrix} a_1  a_2  a_3 \\end{bmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = I_3\n$$\nThis realization $(A,B,C)$ generates the given Markov parameters, as $C A^{k-1} B = I_3 A^{k-1} B = \\sum_{i=1}^3 \\lambda_i^{k-1} b_i e_i = \\sum_{i=1}^3 \\lambda_i^{k-1} b_i a_i = h_k$, where $e_i$ are the standard basis vectors, which are equivalent to the given $a_i$.\n\nThis realization is minimal. For a diagonal system with distinct eigenvalues $\\lambda_i$, it is controllable if and only if all components of $B$ are nonzero. Here $B = [1, 2, 3]^T$, so it is controllable. It is observable if and only if all columns of $C$ are nonzero. Here $C=I_3$, so it is observable. Since the realization is controllable and observable, it is minimal, and its order $n=3$ is the McMillan degree of the system.\n\nWith this minimal realization, we construct $O_3$ and $C_3$:\n$$\nO_3 = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\end{bmatrix} = \\begin{bmatrix} I_3 \\\\ A \\\\ A^2 \\end{bmatrix} = \\begin{pmatrix}\n1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\\\\n\\frac{1}{2}  0  0 \\\\\n0  -\\frac{1}{3}  0 \\\\\n0  0  \\frac{1}{4} \\\\\n\\frac{1}{4}  0  0 \\\\\n0  \\frac{1}{9}  0 \\\\\n0  0  \\frac{1}{16}\n\\end{pmatrix}\n$$\nThis is a $9 \\times 3$ matrix. The first three rows form an identity matrix, which guarantees that the three columns are linearly independent. Thus, $\\operatorname{rank}(O_3) = 3$.\n\n$$\nC_3 = \\begin{bmatrix} B  AB  A^2B \\end{bmatrix} = \\begin{pmatrix} 1  \\frac{1}{2}  \\frac{1}{4} \\\\ 2  -\\frac{2}{3}  \\frac{2}{9} \\\\ 3  \\frac{3}{4}  \\frac{3}{16} \\endpmatrix}\n$$\nThis is a $3 \\times 3$ matrix. Its determinant is:\n$$\n\\det(C_3) = \\det\\begin{pmatrix} b_1  \\lambda_1 b_1  \\lambda_1^2 b_1 \\\\ b_2  \\lambda_2 b_2  \\lambda_2^2 b_2 \\\\ b_3  \\lambda_3 b_3  \\lambda_3^2 b_3 \\end{pmatrix} = b_1 b_2 b_3 \\det\\begin{pmatrix} 1  \\lambda_1  \\lambda_1^2 \\\\ 1  \\lambda_2  \\lambda_2^2 \\\\ 1  \\lambda_3  \\lambda_3^2 \\end{pmatrix}\n$$\nThe determinant is the product of $b_1 b_2 b_3$ and a Vandermonde determinant. Since $b_i \\neq 0$ and $\\lambda_i$ are distinct, this determinant is nonzero.\n$\\det(C_3) = (1 \\cdot 2 \\cdot 3) \\cdot ( (-\\frac{1}{3}) - \\frac{1}{2} ) \\cdot ( \\frac{1}{4} - \\frac{1}{2} ) \\cdot ( \\frac{1}{4} - (-\\frac{1}{3}) ) = 6 \\cdot (-\\frac{5}{6}) \\cdot (-\\frac{1}{4}) \\cdot (\\frac{7}{12}) = \\frac{35}{24} \\neq 0$.\nTherefore, $C_3$ is full rank, $\\operatorname{rank}(C_3) = 3$.\n\nThe factorization $H_{3,3} = O_3 C_3$ holds, and since we have shown that $\\operatorname{rank}(O_3)=3$ and $\\operatorname{rank}(C_3)=3$, we conclude from Sylvester's inequality that $\\operatorname{rank}(H_{3,3})=3$.\n\n**Task 4: Inferred Minimal System Order $n$**\n\nThe Ho-Kalman algorithm states that the minimal system order $n$ is equal to the rank of the block Hankel matrix, provided $f$ and $p$ are sufficiently large (i.e., $f \\ge n$ and $p \\ge n$).\nWe have computed $\\operatorname{rank}(H_{3,3}) = 3$. This implies that the minimal order is $n=3$. This is consistent with our choice of $f=3$ and $p=3$.\n\nThe minimal system order is $n=3$.", "answer": "$$\n\\boxed{3}\n$$", "id": "2724259"}]}