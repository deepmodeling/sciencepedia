{"hands_on_practices": [{"introduction": "To begin our practical exploration of feedback linearization, we must first master its fundamental mathematical tools. The Lie bracket is a crucial operator from differential geometry that measures the non-commutativity of two vector fields. In control theory, it helps us understand how the system's natural dynamics, represented by the drift field $f(x)$, interact with the control action, represented by the control field $g(x)$. This exercise provides direct practice in computing the Lie bracket, a skill that is essential for verifying the conditions required for full state linearization [@problem_id:1575296].", "problem": "Consider a two-dimensional nonlinear control system with state vector $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$. The dynamics of the system are described by the affine state-space model $\\dot{x} = f(x) + g(x)u$, where $u$ is a scalar control input. The system's drift vector field $f(x)$ and control vector field $g(x)$ are given by:\n$$f(x) = \\begin{pmatrix} x_2 \\\\ -x_1^2 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\nIn the analysis of such systems, a key tool is the Lie bracket, denoted as $[f, g]$, which defines a new vector field derived from $f$ and $g$. Compute the Lie bracket $[f, g](x)$ for the given vector fields. Express your answer as a column vector.", "solution": "The Lie bracket of two smooth vector fields $f$ and $g$ on $\\mathbb{R}^{n}$ is defined componentwise by\n$$\n[f,g](x) = Dg(x)\\,f(x) - Df(x)\\,g(x),\n$$\nwhere $Df(x)$ and $Dg(x)$ are the Jacobian matrices of $f$ and $g$ evaluated at $x$. For the given fields,\n$$\nf(x) = \\begin{pmatrix} x_{2} \\\\ -x_{1}^{2} \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\nFirst compute the Jacobians. For $f$, with components $f_{1}(x) = x_{2}$ and $f_{2}(x) = -x_{1}^{2}$, we have\n$$\nDf(x) = \\begin{pmatrix}\n\\frac{\\partial f_{1}}{\\partial x_{1}}  \\frac{\\partial f_{1}}{\\partial x_{2}} \\\\\n\\frac{\\partial f_{2}}{\\partial x_{1}}  \\frac{\\partial f_{2}}{\\partial x_{2}}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  1 \\\\\n-2x_{1}  0\n\\end{pmatrix}.\n$$\nFor $g$, both components are constant, so\n$$\nDg(x) = \\begin{pmatrix}\n0  0 \\\\\n0  0\n\\end{pmatrix}.\n$$\nTherefore,\n$$\n[f,g](x) = Dg(x)\\,f(x) - Df(x)\\,g(x) = 0 - \\begin{pmatrix}\n0  1 \\\\\n-2x_{1}  0\n\\end{pmatrix}\n\\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix}\n= - \\begin{pmatrix}\n1 \\\\\n0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-1 \\\\\n0\n\\end{pmatrix}.\n$$\nAn equivalent verification via the component formula $[f,g]_{i} = \\sum_{j} \\left( f_{j}\\frac{\\partial g_{i}}{\\partial x_{j}} - g_{j}\\frac{\\partial f_{i}}{\\partial x_{j}} \\right)$ also yields $[f,g](x) = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}$, since $g$ is constant and thus $\\frac{\\partial g_{i}}{\\partial x_{j}} = 0$ for all $i,j$.", "answer": "$$\\boxed{\\begin{pmatrix}-1 \\\\ 0\\end{pmatrix}}$$", "id": "1575296"}, {"introduction": "A central concept in feedback linearization is the relative degree, which quantifies the number of times the output must be differentiated with respect to time before the control input explicitly appears. This value determines the order of the resulting linear input-output dynamics and is fundamental to constructing the required coordinate transformation and control law. This practice problem focuses on the methodical calculation of the relative degree using Lie derivatives, a core step in analyzing any nonlinear system for potential linearization [@problem_id:1575306].", "problem": "Consider a nonlinear single-input, single-output system described by the following state-space equations:\n$$\n\\begin{aligned}\n\\dot{x}_1 = x_1 x_2 \\\\\n\\dot{x}_2 = u\n\\end{aligned}\n$$\nHere, $x_1$ and $x_2$ represent the state variables of the system, and $u$ is the control input. The system's output is defined as $y = x_1$.\n\nDetermine the relative degree of this system with respect to the specified output $y$.", "solution": "We write the system in control-affine form $\\dot{x} = f(x) + g(x)u$ with output $y = h(x)$:\n$$\nf(x) = \\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_{1}.\n$$\nThe relative degree $r$ at a point is the smallest positive integer such that $L_{g}L_{f}^{r-1}h(x) \\neq 0$, where $L_{f}$ and $L_{g}$ denote Lie derivatives along $f$ and $g$, respectively.\n\nFirst Lie derivatives:\n$$\nL_{g}h(x) = \\frac{\\partial h}{\\partial x}g(x) = \\begin{pmatrix} 1  0 \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0,\n$$\nso the input $u$ does not appear in $\\dot{y}$ and the relative degree is at least $2$.\n\nCompute $L_{f}h$:\n$$\nL_{f}h(x) = \\frac{\\partial h}{\\partial x}f(x) = \\begin{pmatrix} 1  0 \\end{pmatrix}\\begin{pmatrix} x_{1}x_{2} \\\\ 0 \\end{pmatrix} = x_{1}x_{2}.\n$$\nThen\n$$\nL_{g}L_{f}h(x) = \\frac{\\partial (x_{1}x_{2})}{\\partial x}g(x) = \\begin{pmatrix} x_{2}  x_{1} \\end{pmatrix}\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = x_{1}.\n$$\nThus, for $x_{1} \\neq 0$, $L_{g}L_{f}h(x) \\neq 0$ and the input appears in the second derivative of the output, so the relative degree is $r=2$ on the set $\\{x \\mid x_{1} \\neq 0\\}$.\n\nEquivalently, by direct differentiation,\n$$\n\\dot{y} = \\dot{x}_{1} = x_{1}x_{2}, \\quad \\ddot{y} = \\dot{x}_{1}x_{2} + x_{1}\\dot{x}_{2} = x_{1}x_{2}^{2} + x_{1}u,\n$$\nand the coefficient of $u$ in $\\ddot{y}$ is $x_{1}$, confirming the relative degree $2$ for $x_{1} \\neq 0$. At $x_{1}=0$, $L_{g}L_{f}^{k}h(x)$ remains zero for all $k \\geq 1$ (one finds $L_{g}L_{f}^{k}h(x) = k x_{1} x_{2}^{k-1}$), so the relative degree is not well-defined at that point. The standard answer is $r=2$ (away from $x_{1}=0$).", "answer": "$$\\boxed{2}$$", "id": "1575306"}, {"introduction": "This comprehensive exercise serves as a capstone, integrating the concepts of Lie derivatives and relative degree to perform a complete feedback linearization from first principles. You will transform a nonlinear system into the Byrnes-Isidori normal form, which cleanly separates the dynamics into an external, linearizable part and an internal, unobservable part (the zero dynamics). This process not only yields the linearizing control law but also provides critical insight into the system's internal stability, a key consideration for any practical application [@problem_id:2707935].", "problem": "Consider the single-input, single-output nonlinear system with state $x=\\begin{pmatrix}x_1  x_2\\end{pmatrix}^{\\top}$ and output $y$ given by\n$$\\dot{x}_1 = x_2,\\quad \\dot{x}_2 = -x_1 + x_2^3 + u,\\quad y = x_1.$$\nStarting only from the foundational definitions of Lie derivatives, vector fields, relative degree, and diffeomorphisms, perform the following tasks:\n1. Construct the Byrnes–Isidori coordinates by taking successive Lie derivatives of the output along the drift and input vector fields. Explicitly state the coordinate transformation and verify that it is a local diffeomorphism on the domain of interest.\n2. Determine the relative degree and write the system in normal form in the constructed coordinates, identifying the external (chain of integrators) and any internal dynamics. Clearly state the dimension and explicit equations of the internal dynamics, if any.\n3. Design a static state feedback of the form $u=\\alpha(x)+\\beta(x)\\,v$ that achieves input-output linearization with unity high-frequency gain for the linearized input $v$. Express the final feedback $u(x,v)$ as a closed-form analytical expression.\n\nNo numerical approximation is required. Report your final answer as the analytic expression for $u(x,v)$ only. Do not include units. If you find internal dynamics, you may discuss their properties in your derivation, but the final reported answer must be $u(x,v)$.", "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, and objective. It represents a standard problem in the field of nonlinear control theory, specifically concerning feedback linearization. All required information is provided, and the problem is free of contradictions or ambiguities. We may therefore proceed with a rigorous solution.\n\nThe system is given by the state equations\n$$ \\dot{x}_1 = x_2 $$\n$$ \\dot{x}_2 = -x_1 + x_2^3 + u $$\nwith state vector $x = \\begin{pmatrix} x_1  x_2 \\end{pmatrix}^{\\top}$ and output $y = x_1$. This system is of the single-input, single-output (SISO) affine form $\\dot{x} = f(x) + g(x)u$, where the drift vector field $f(x)$, the input vector field $g(x)$, and the output function $h(x)$ are identified as:\n$$ f(x) = \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix}, \\quad g(x) = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad h(x) = x_1 $$\nThe state dimension is $n=2$.\n\nTo perform feedback linearization, we must first determine the relative degree of the system. The relative degree, $r$, is the number of times the output $y=h(x)$ must be differentiated with respect to time before the input $u$ explicitly appears. This is found by computing successive Lie derivatives of $h(x)$ along the vector fields $f(x)$ and $g(x)$. The Lie derivative of a scalar field $\\phi(x)$ along a vector field $V(x)$ is defined as $L_V \\phi(x) = \\frac{\\partial \\phi}{\\partial x} V(x)$, where $\\frac{\\partial \\phi}{\\partial x}$ is the gradient of $\\phi$.\n\nThe first time derivative of the output $y$ is:\n$$ \\dot{y} = \\frac{d}{dt}h(x) = \\frac{\\partial h}{\\partial x} \\dot{x} = \\frac{\\partial h}{\\partial x} (f(x) + g(x)u) = L_f h(x) + L_g h(x) u $$\nWe compute the necessary Lie derivatives. The gradient of $h(x)$ is $\\frac{\\partial h}{\\partial x} = \\begin{pmatrix} 1  0 \\end{pmatrix}$.\n$$ L_g h(x) = \\frac{\\partial h}{\\partial x} g(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 0 $$\nSince $L_g h(x) = 0$, the input $u$ does not appear in the first derivative of $y$. The relative degree must be greater than $1$. The expression for $\\dot{y}$ simplifies to:\n$$ \\dot{y} = L_f h(x) = \\frac{\\partial h}{\\partial x} f(x) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix} = x_2 $$\n\nWe proceed to the second time derivative of the output:\n$$ \\ddot{y} = \\frac{d}{dt} (L_f h(x)) = \\frac{\\partial(L_f h(x))}{\\partial x} \\dot{x} = \\frac{\\partial(L_f h(x))}{\\partial x} (f(x) + g(x)u) = L_f^2 h(x) + L_g L_f h(x) u $$\nHere, $L_f^2 h(x)$ denotes $L_f(L_f h(x))$ and $L_g L_f h(x)$ denotes $L_g(L_f h(x))$. We had $L_f h(x) = x_2$.\nThe gradient is $\\frac{\\partial(L_f h(x))}{\\partial x} = \\frac{\\partial(x_2)}{\\partial x} = \\begin{pmatrix} 0  1 \\end{pmatrix}$.\nNow we compute the Lie derivatives for the second-order term:\n$$ L_f^2 h(x) = \\frac{\\partial(L_f h(x))}{\\partial x} f(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} x_2 \\\\ -x_1 + x_2^3 \\end{pmatrix} = -x_1 + x_2^3 $$\n$$ L_g L_f h(x) = \\frac{\\partial(L_f h(x))}{\\partial x} g(x) = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = 1 $$\nSince $L_g L_f h(x) = 1 \\neq 0$, the input $u$ appears in the second derivative of $y$. Therefore, the relative degree of the system is $r=2$.\n\nThe first task is to construct the Byrnes–Isidori coordinates. For a system with relative degree $r$, the first $r$ coordinates of the transformation $z = \\Phi(x)$ are given by the successive Lie derivatives of $h(x)$:\n$$ z_1 = \\phi_1(x) = h(x) = x_1 $$\n$$ z_2 = \\phi_2(x) = L_f h(x) = x_2 $$\nThe coordinate transformation is thus $z = \\Phi(x) = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$. This is the identity transformation. To verify it is a local diffeomorphism, we compute its Jacobian matrix:\n$$ J_{\\Phi}(x) = \\frac{\\partial \\Phi}{\\partial x} = \\begin{pmatrix} \\frac{\\partial z_1}{\\partial x_1}  \\frac{\\partial z_1}{\\partial x_2} \\\\ \\frac{\\partial z_2}{\\partial x_1}  \\frac{\\partial z_2}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\nThe determinant of the Jacobian is $\\det(J_{\\Phi}(x)) = 1$, which is non-zero for all $x \\in \\mathbb{R}^2$. Thus, the transformation is a global diffeomorphism.\n\nThe second task is to determine the relative degree, write the system in normal form, and discuss internal dynamics.\nAs determined, the relative degree is $r=2$. The state dimension is $n=2$. Since $r=n$, the system is fully state-linearizable, and there are no internal dynamics. The dimension of the internal dynamics is $n-r=2-2=0$.\nThe system dynamics in the new coordinates $z = (z_1, z_2)^{\\top}$ constitute the normal form.\n$$ \\dot{z}_1 = \\frac{d}{dt}(h(x)) = L_f h(x) = z_2 $$\n$$ \\dot{z}_2 = \\frac{d}{dt}(L_f h(x)) = L_f^2 h(x) + L_g L_f h(x) u $$\nSubstituting the expressions we found:\n$$ \\dot{z}_1 = z_2 $$\n$$ \\dot{z}_2 = (-x_1 + x_2^3) + (1)u $$\nSince the coordinate transformation is the identity ($z_1=x_1, z_2=x_2$), we can write the normal form entirely in terms of $z$:\n$$ \\dot{z}_1 = z_2 $$\n$$ \\dot{z}_2 = -z_1 + z_2^3 + u $$\nThis system is composed solely of the external dynamics, which form a chain of two integrators perturbed by nonlinear terms.\n\nThe third task is to design a static state feedback controller $u = \\alpha(x) + \\beta(x)v$ that achieves input-output linearization. The objective is to obtain a linear input-output response of the form $y^{(r)} = v$, which for this system is $\\ddot{y}=v$. The expression for $\\ddot{y}$ is:\n$$ \\ddot{y} = L_f^2 h(x) + L_g L_f h(x) u = (-x_1 + x_2^3) + u $$\nSetting this equal to the new input $v$:\n$$ v = (-x_1 + x_2^3) + u $$\nSolving for the control input $u$ yields the feedback law:\n$$ u(x,v) = v - (-x_1 + x_2^3) = x_1 - x_2^3 + v $$\nThis control law is in the form $u = \\alpha(x) + \\beta(x)v$, with $\\alpha(x) = x_1 - x_2^3$ and $\\beta(x) = 1$. The general form of the feedback law that cancels the nonlinearities and sets the gain for the new input is $u = \\frac{1}{L_gL_f^{r-1}h(x)}(-L_f^r h(x)+v)$. For our system with $r=2$, this gives:\n$$ u = \\frac{1}{L_gL_f h(x)}(-L_f^2 h(x)+v) = \\frac{1}{1}(-(-x_1+x_2^3)+v) = x_1 - x_2^3 + v $$\nThe term multiplying $v$ after feedback is $\\beta(x)L_gL_f h(x)=(1)(1)=1$, confirming unity high-frequency gain for the linearized input $v$, as required. The resulting closed-loop system is $\\ddot{y}=v$, representing a double integrator.\n\nThe final analytical expression for the control law is therefore $u(x,v) = x_1 - x_2^3 + v$.", "answer": "$$\\boxed{x_1 - x_2^{3} + v}$$", "id": "2707935"}]}