{"hands_on_practices": [{"introduction": "In classical control theory, controllability is a powerful concept that guarantees the existence of a stabilizing feedback law. This exercise forces us to reconsider this guarantee in the context of networked systems. By analyzing a simple scalar system with random packet dropouts on the actuation link, we will demonstrate that deterministic controllability is not sufficient for stabilizability and derive the critical packet success probability required to overcome the inherent instability of the plant [@problem_id:2727000]. This practice provides a foundational understanding of why stochastic effects fundamentally alter stability conditions.", "problem": "Consider a scalar discrete-time plant in a Networked Control System (NCS) with actuation packet dropouts modeled as a multiplicative Bernoulli process. The plant evolves as $x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$, where $x_k \\in \\mathbb{R}$ is the state, $u_k \\in \\mathbb{R}$ is the control input, $a \\in \\mathbb{R}$ and $b \\in \\mathbb{R}\\setminus\\{0\\}$ are fixed parameters, and $\\{\\gamma_k\\}_{k \\ge 0}$ is an independent and identically distributed (i.i.d.) sequence with $\\gamma_k \\in \\{0,1\\}$ representing whether the control packet sent at time $k$ is successfully applied at the actuator. The success probability is $\\mathbb{P}\\{\\gamma_k = 1\\} = p$ and the dropout probability is $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$, with $0 \\le p \\le 1$. The controller has perfect, instantaneous state information and applies static state feedback $u_k = K x_k$ with a constant gain $K \\in \\mathbb{R}$. The goal is mean-square stabilization, namely $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$.\n\nYou are given the concrete plant with $a = 2$ and $b = 1$. In the deterministic sense (no losses), the pair $(a,b)$ is controllable because $b \\ne 0$. However, over the lossy actuation channel, mean-square stabilizability may fail for some values of $p$ despite deterministic controllability.\n\nTasks:\n- Starting from the definition of mean-square stability and the law of total expectation, derive the one-step second-moment recursion for $\\mathbb{E}[x_{k+1}^2]$ under the feedback $u_k = K x_k$ and the i.i.d. Bernoulli packet model described above. Show how the resulting multiplicative factor on $\\mathbb{E}[x_k^2]$ depends on $a$, $b$, $K$, and $p$, and determine the choice of $K$ that minimizes this factor.\n- From this derivation, obtain the condition on $p$ (in terms of $a$ and $b$) that is necessary and sufficient for the existence of a static gain $K$ that achieves mean-square stability.\n- Specialize your expression to the given plant with $a = 2$ and $b = 1$, and compute the critical success probability $p^{\\star}$ (the infimum of $p$ for which mean-square stabilization is possible). Then use $p = 0.70$ to argue briefly why this provides a counterexample where deterministic controllability holds but mean-square stabilizability fails, and explain the underlying reason in terms of the competing effects of open-loop growth during dropouts and control action during successful transmissions.\n\nGive your final answer as the exact value of the critical success probability $p^{\\star}$ for $a = 2$ and $b = 1$. No rounding is required. Do not include units in your final answer.", "solution": "The problem statement is first validated.\n\n**Step 1: Extract Givens**\n- Plant dynamics: $x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,u_k$\n- State: $x_k \\in \\mathbb{R}$\n- Control input: $u_k \\in \\mathbb{R}$\n- Plant parameters: $a \\in \\mathbb{R}$, $b \\in \\mathbb{R}\\setminus\\{0\\}$\n- Packet dropout model: $\\{\\gamma_k\\}_{k \\ge 0}$ is an independent and identically distributed (i.i.d.) Bernoulli sequence with $\\gamma_k \\in \\{0,1\\}$.\n- Probabilities: $\\mathbb{P}\\{\\gamma_k = 1\\} = p$ and $\\mathbb{P}\\{\\gamma_k = 0\\} = 1-p$, where $0 \\le p \\le 1$.\n- Controller: Static state feedback $u_k = K x_k$ with a constant gain $K \\in \\mathbb{R}$.\n- Objective: Mean-square stabilization, i.e., $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$.\n- Specific parameters: $a = 2$ and $b = 1$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard, fundamental problem in the theory of Networked Control Systems (NCS) and stochastic control. The Bernoulli model for packet dropouts is a widely used and accepted simplification.\n- **Well-Posed:** The problem is well-defined, with a clear objective and sufficient information to derive a unique solution for the critical probability.\n- **Objective:** The problem is stated using precise mathematical language, free from subjective or ambiguous terms.\n- **Conclusion:** The problem is valid as it is scientifically sound, well-posed, objective, and contains no internal contradictions or missing information.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Derivation of the Second-Moment Recursion**\nWe begin with the closed-loop system dynamics, substituting the control law $u_k = K x_k$ into the plant equation:\n$$x_{k+1} = a\\,x_k + b\\,\\gamma_k\\,(K x_k) = (a + b K \\gamma_k) x_k$$\nThe goal is mean-square stability, which concerns the evolution of the second moment of the state, $\\mathbb{E}[x_k^2]$. We derive the one-step recursion for this quantity.\n$$x_{k+1}^2 = ((a + b K \\gamma_k) x_k)^2 = (a + b K \\gamma_k)^2 x_k^2$$\nTo compute the expectation $\\mathbb{E}[x_{k+1}^2]$, we use the law of total expectation, conditioning on the information available at time $k$, which we denote by the filtration $\\mathcal{F}_k$. The state $x_k$ is $\\mathcal{F}_k$-measurable, while the random variable $\\gamma_k$ is independent of $\\mathcal{F}_k$ due to the i.i.d. assumption.\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[\\mathbb{E}[x_{k+1}^2 | \\mathcal{F}_k]] = \\mathbb{E}[\\mathbb{E}[(a + b K \\gamma_k)^2 x_k^2 | \\mathcal{F}_k]]$$\nSince $x_k$ is known given $\\mathcal{F}_k$, it can be treated as a constant inside the inner expectation:\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2 | \\mathcal{F}_k]]$$\nBecause $\\gamma_k$ is independent of $\\mathcal{F}_k$, the conditioning does not affect its expectation:\n$$\\mathbb{E}[x_{k+1}^2] = \\mathbb{E}[x_k^2 \\mathbb{E}[(a + b K \\gamma_k)^2]] = \\mathbb{E}[(a + b K \\gamma_k)^2] \\mathbb{E}[x_k^2]$$\nThe term $\\mathbb{E}[(a + b K \\gamma_k)^2]$ is the multiplicative factor for the second moment. We can expand this expectation using the definition of the Bernoulli random variable $\\gamma_k$:\n\\begin{align*} \\mathbb{E}[(a + b K \\gamma_k)^2] = (a + b K \\cdot 1)^2 \\mathbb{P}\\{\\gamma_k = 1\\} + (a + b K \\cdot 0)^2 \\mathbb{P}\\{\\gamma_k = 0\\} \\\\ = (a + b K)^2 p + a^2 (1-p) \\end{align*}\nThus, the one-step second-moment recursion is:\n$$\\mathbb{E}[x_{k+1}^2] = \\left[ p(a + bK)^2 + (1-p)a^2 \\right] \\mathbb{E}[x_k^2]$$\nFor the system to be mean-square stable, we require $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$, which holds if and only if the multiplicative factor is strictly less than $1$:\n$$p(a + bK)^2 + (1-p)a^2  1$$\n\n**Optimal Gain and Condition for Stabilizability**\nTo find the condition for the *existence* of a stabilizing gain $K$, we must find the gain $K$ that minimizes this factor and check if that minimum value can be made less than $1$. Let $f(K) = p(a + bK)^2 + (1-p)a^2$. This is a quadratic function of $K$. We find the minimum by taking the derivative with respect to $K$ and setting it to zero.\n$$\\frac{df}{dK} = \\frac{d}{dK} \\left[ p(a^2 + 2abK + b^2K^2) + (1-p)a^2 \\right] = p(2ab + 2b^2K)$$\nAssuming $p > 0$ and $b \\ne 0$ (as given), we set the derivative to $0$:\n$$2ab + 2b^2K = 0 \\implies K = -\\frac{2ab}{2b^2} = -\\frac{a}{b}$$\nThis optimal gain, let's call it $K^{\\star} = -a/b$, minimizes the factor. The second derivative $\\frac{d^2f}{dK^2} = 2pb^2 > 0$, confirming it is a minimum.\nSubstituting $K^{\\star}$ back into the factor gives the minimum possible value:\n$$\\min_K f(K) = p\\left(a + b\\left(-\\frac{a}{b}\\right)\\right)^2 + (1-p)a^2 = p(a-a)^2 + (1-p)a^2 = a^2(1-p)$$\nThe system is mean-square stabilizable if and only if this minimum factor is less than $1$. Note that if the open-loop plant is already mean-square stable (i.e., $|a|1$), it is stable for any $p \\in [0,1]$ (with $K=0$, the factor is $a^2  1$). The interesting case is when $|a| \\ge 1$. The necessary and sufficient condition for stabilizability is:\n$$a^2(1-p)  1$$\nSolving for the success probability $p$:\n$$1-p  \\frac{1}{a^2} \\implies p  1 - \\frac{1}{a^2}$$\n\n**Specialization and Counterexample**\nWe are given the specific plant parameters $a=2$ and $b=1$. Since $|a| = 2 > 1$, the open-loop system is unstable. The condition for mean-square stabilizability is:\n$$p  1 - \\frac{1}{2^2} = 1 - \\frac{1}{4} = \\frac{3}{4}$$\nThe critical success probability $p^{\\star}$ is the infimum of the set of probabilities $p$ for which stabilization is possible. Therefore:\n$$p^{\\star} = \\frac{3}{4} = 0.75$$\nNow we consider the case where $p=0.70$.\nSince $0.70  0.75$, our derived condition $p > p^{\\star}$ is not met. This implies that for a success probability of $p=0.70$, the system is not mean-square stabilizable by any static state feedback gain $K$.\nThis provides a counterexample to the notion that deterministic controllability implies stabilizability under stochastic losses. The pair $(a,b)=(2,1)$ is controllable since the controllability matrix $[b]$ has rank $1$. If there were no packet losses ($p=1$), we could choose $K=-2$ to make the closed-loop pole $a+bK = 2-2=0$, achieving deadbeat stability.\nHowever, with $p=0.70$, the minimum possible value of the second-moment amplification factor is $a^2(1-p) = 2^2(1-0.70) = 4(0.30) = 1.2$. Since this minimum factor is greater than $1$, $\\mathbb{E}[x_k^2]$ will diverge for any choice of $K$.\nThe underlying reason is a competition between two effects. During a packet dropout, which occurs with probability $1-p$, the system evolves according to its unstable open-loop dynamics $x_{k+1} = ax_k$. The state's squared magnitude is amplified by $a^2$. During a successful transmission, which occurs with probability $p$, the controller can act to reduce the state's magnitude via $x_{k+1} = (a+bK)x_k$. The most effective control action (with $K^{\\star}=-a/b$) nullifies the state completely. Mean-square stability depends on the weighted average of these two outcomes. The condition $a^2(1-p)1$ shows that even with a perfect controller that is active with probability $p$, the expected growth during dropouts, $a^2(1-p)$, must itself be less than unity. If packet dropouts are too frequent (i.e., $p$ is too small), the explosive growth during the uncontrolled steps overwhelms any stabilizing action taken during the controlled steps.", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "2727000"}, {"introduction": "Just as packet loss on the actuation link can destabilize a system, loss on the sensing link can make the system state impossible to track. This practice shifts our focus to the problem of state estimation with a Kalman filter that receives measurements over an unreliable network. You will derive a precise, fundamental limit on the packet loss probability, beyond which the estimation error is guaranteed to grow without bound [@problem_id:2726935]. This critical probability is elegantly expressed in terms of the spectral radius of the system's unstable and observable dynamics, providing a deep insight into the core factors that govern estimation stability.", "problem": "Consider a discrete-time Networked Control System (NCS) where a sensor transmits measurements over a lossy network to a state estimator that runs the optimal Kalman filter conditioned on which measurements arrive. The packet loss process is modeled as an independent and identically distributed Bernoulli process. You may assume all random variables are mutually independent across time and with each other, and that the estimator knows whether a packet has arrived at each time.\n\nPart A (scalar case). Let the plant be the scalar linear time-invariant stochastic system\n$$\nx_{k+1} = a\\,x_{k} + w_{k}, \\qquad y_{k} = x_{k} + v_{k},\n$$\nwith $|a|1$, where $w_{k} \\sim \\mathcal{N}(0,Q)$ and $v_{k} \\sim \\mathcal{N}(0,R)$ with $Q0$ and $R0$. At each time $k$, the sensorâ€™s packet is dropped with probability $p \\in (0,1)$ and delivered with probability $1-p$. The estimator applies the standard Kalman time update at every step, and the standard Kalman measurement update only when a packet arrives. Starting from an arbitrary finite initial error covariance, use first principles (the Kalman covariance recursion and basic properties of geometric series for independent packet drops) to derive the critical loss probability $p_{c}$ such that the expected estimation error covariance diverges if and only if $p \\ge p_{c}$. Express $p_{c}$ as a symbolic function of $a$.\n\nPart B (multi-dimensional case). Consider now the multi-dimensional linear time-invariant stochastic system\n$$\nx_{k+1} = A\\,x_{k} + w_{k}, \\qquad y_{k} = C\\,x_{k} + v_{k},\n$$\nwith $w_{k} \\sim \\mathcal{N}(0,W)$, $v_{k} \\sim \\mathcal{N}(0,V)$, $W \\succeq 0$, $V \\succ 0$. Assume the pair $(A,C)$ is detectable and that $A$ has at least one eigenvalue $\\lambda$ with $|\\lambda|1$; let $A_{u}$ denote the restriction of $A$ to the smallest $A$-invariant subspace spanned by the eigenvectors associated with eigenvalues of $A$ satisfying $|\\lambda|1$ that are observable from $C$, and let $\\rho(A_{u})$ be the spectral radius of $A_{u}$. As in the scalar case, packets are dropped independently with probability $p \\in (0,1)$ and delivered with probability $1-p$, and the estimator applies the optimal Kalman filter conditioned on arrival events. By reasoning from the covariance growth along unstable modes over consecutive packet losses and using only well-tested facts about linear systems and Kalman filtering, generalize your result from Part A to obtain a closed-form symbolic expression for the critical loss probability $p_{c}$ in terms of $\\rho(A_{u})$.\n\nYour final answer must be a single, closed-form analytic expression for $p_{c}$ in the multi-dimensional case (which reduces to the scalar case when $A=a$ and $C=1$). Do not include units. No numerical rounding is required.", "solution": "This problem requires the derivation of a critical packet loss probability for the stability of a Kalman filter operating over a lossy network. We first validate the problem statement.\n\n**Problem Validation**\n\nStep 1: Extract Givens.\n\nPart A (Scalar Case):\n-   System: $x_{k+1} = a\\,x_{k} + w_{k}$ and $y_{k} = x_{k} + v_{k}$.\n-   Parameters: $|a|1$, $w_{k} \\sim \\mathcal{N}(0,Q)$ with $Q0$, $v_{k} \\sim \\mathcal{N}(0,R)$ with $R0$.\n-   Network: Packet loss is an i.i.d. Bernoulli process with drop probability $p \\in (0,1)$.\n-   Estimator: Optimal Kalman filter, applying time updates always and measurement updates only upon packet arrival.\n-   Objective: Find critical probability $p_{c}$ such that the expected estimation error covariance diverges if and only if $p \\ge p_{c}$.\n\nPart B (Multi-dimensional Case):\n-   System: $x_{k+1} = A\\,x_{k} + w_{k}$ and $y_{k} = C\\,x_{k} + v_{k}$.\n-   Parameters: $w_{k} \\sim \\mathcal{N}(0,W)$ with $W \\succeq 0$, $v_{k} \\sim \\mathcal{N}(0,V)$ with $V \\succ 0$.\n-   Assumptions: $(A,C)$ is detectable, and $A$ has at least one eigenvalue $\\lambda$ with $|\\lambda|1$.\n-   Definitions: $A_{u}$ is the restriction of $A$ to the smallest $A$-invariant subspace spanned by eigenvectors of unstable ($|\\lambda|1$) and observable eigenvalues. $\\rho(A_{u})$ is the spectral radius of $A_{u}$.\n-   Network and Estimator: Same as Part A.\n-   Objective: Generalize the result from Part A to find $p_{c}$ in terms of $\\rho(A_{u})$.\n\nThe final answer should be the expression for $p_c$ from the multi-dimensional case.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, well-posed, and objective. It is a standard problem in the analysis of networked control systems, based on fundamental principles of linear systems and estimation theory (Kalman filtering). All terms are precisely defined, the assumptions are standard and sufficient for analysis (e.g., detectability of $(A,C)$ is crucial), and the problem structure is logical. There are no contradictions, missing data, or scientifically unsound premises.\n\nStep 3: Verdict and Action.\nThe problem is valid. We proceed to the solution.\n\n**Part A: Scalar Case**\n\nLet $P_{k|k-1}$ denote the a priori error covariance at time $k$, defined as $\\mathbb{E}[(x_k - \\hat{x}_{k|k-1})^2]$, and let $P_{k|k}$ be the a posteriori error covariance. For brevity, we let $P_k = P_{k|k-1}$. The Kalman filter equations are as follows:\n\n1.  **Time Update:** The a priori covariance for the next step is computed from the a posteriori covariance of the current step. This update occurs regardless of packet loss.\n    $$P_{k+1|k} = a P_{k|k} a^T + Q = a^2 P_{k|k} + Q$$\n\n2.  **Measurement Update:** The a posteriori covariance is computed from the a priori covariance. This update depends on whether the measurement packet arrives. Let $\\gamma_k$ be a Bernoulli random variable, where $\\gamma_k=1$ indicates a packet drop at time $k$ (with probability $p$) and $\\gamma_k=0$ indicates an arrival (with probability $1-p$).\n\n    If a packet arrives ($\\gamma_k=0$):\n    The Kalman gain is $K_k = P_k (P_k + R)^{-1}$.\n    The a posteriori covariance is $P_{k|k} = (1-K_k) P_k = P_k - P_k^2 (P_k + R)^{-1} = \\frac{P_k R}{P_k+R}$.\n\n    If a packet is dropped ($\\gamma_k=1$):\n    No new information is received, so the a posteriori estimate is the same as the a priori estimate, $\\hat{x}_{k|k} = \\hat{x}_{k|k-1}$. Thus, the error covariance does not change: $P_{k|k} = P_k$.\n\nWe can combine these into a single stochastic recurrence relation for the a priori covariance $P_k$:\n$$P_{k+1} = a^2 P_{k|k} + Q = \\begin{cases} a^2 \\frac{P_k R}{P_k + R} + Q  \\text{with probability } 1-p \\\\ a^2 P_k + Q  \\text{with probability } p \\end{cases}$$\nLet us define two maps corresponding to arrival and drop:\n$g_1(P) = a^2 \\frac{PR}{P+R} + Q$\n$g_0(P) = a^2 P + Q$\n\nThe condition for divergence of the expected error covariance, $\\mathbb{E}[P_k]$, can be determined by analyzing the behavior of the system under long sequences of packet drops. When a packet arrives, the error covariance is \"reset.\" For large $P_k$, the update map $g_1(P_k)$ approaches a finite value: $\\lim_{P_k \\to \\infty} g_1(P_k) = a^2 R + Q$. This update counteracts the error growth. When a packet is dropped, the error covariance grows according to $g_0(P_k)$, which for large $P_k$ scales as $a^2 P_k$.\n\nThe stability of the expected covariance is dictated by the balance between the growth factor $a^2$ during a drop and the probability of this event occurring. The expected value $\\mathbb{E}[P_k]$ is an average over all possible sequences of drops and arrivals. The sequences that dominate the expectation and lead to divergence are those with many consecutive drops.\n\nConsider a sequence of $m$ consecutive packet drops. The covariance grows as $g_0^m(P)$. This term grows, very roughly, by a factor of $(a^2)^m$. The probability of such a sequence of $m$ drops is $p^m$. The contribution of such paths to the expected covariance involves terms of the form $p^m (a^2)^m = (p a^2)^m$. For the expectation to remain bounded, the sum over $m$ of these dominant terms must converge. This requires the base of the geometric series to be less than $1$.\n$$p a^2  1$$\nConversely, if $p a^2 \\ge 1$, the sum diverges, indicating that the expected covariance grows without bound. The critical probability $p_c$ is the value of $p$ at which this transition occurs:\n$$p_c a^2 = 1 \\implies p_c = \\frac{1}{a^2}$$\nSince the problem states $|a|1$, we have $a^2 = |a|^2 > 1$, so $p_c \\in (0,1)$ is a valid probability.\n\nThis heuristic argument can be made more formal by analyzing the recursion for $\\mathbb{E}[P_k]$. Taking the expectation of the stochastic recursion:\n$$\\mathbb{E}[P_{k+1}] = p \\, \\mathbb{E}[a^2 P_k + Q] + (1-p) \\, \\mathbb{E}\\left[a^2 \\frac{P_k R}{P_k + R} + Q\\right]$$\nThe function $h(P) = \\frac{PR}{P+R}$ is concave. By Jensen's inequality, $\\mathbb{E}[h(P_k)] \\le h(\\mathbb{E}[P_k])$. This yields an upper bound on the evolution of $\\bar{P}_k = \\mathbb{E}[P_k]$:\n$$\\bar{P}_{k+1} \\le p a^2 \\bar{P}_k + (1-p) a^2 \\frac{\\bar{P}_k R}{\\bar{P}_k + R} + Q$$\nThe right-hand side defines a map $\\psi(\\bar{P})$. Stability is ensured if this map is a contraction for large $\\bar{P}$, which is determined by its derivative (or slope) at infinity:\n$$\\lim_{\\bar{P}\\to\\infty} \\frac{d\\psi}{d\\bar{P}} = \\lim_{\\bar{P}\\to\\infty} \\left( p a^2 + (1-p) a^2 \\frac{R^2}{(\\bar{P}+R)^2} \\right) = p a^2$$\nIf $p a^2  1$, the map is a contraction at infinity, ensuring that $\\bar{P}_k$ is bounded. This confirms that $p_c = 1/a^2$ is the critical probability.\n\n**Part B: Multi-dimensional Case**\n\nWe now generalize this reasoning to the multi-dimensional system. The stochastic Riccati equation for the a priori covariance matrix $P_k = P_{k|k-1}$ is:\n$$P_{k+1} = \\begin{cases} A (P_k - P_k C^T (C P_k C^T + V)^{-1} C P_k) A^T + W  \\text{with probability } 1-p \\\\ A P_k A^T + W  \\text{with probability } p \\end{cases}$$\nThe stability of $\\mathbb{E}[P_k]$ depends on the interplay between the unstable dynamics of $A$ and the corrective action of the measurement update.\n\nThe assumption that the pair $(A,C)$ is detectable is critical. This means that any unobservable modes of the system are stable. The error covariance associated with these stable, unobservable modes will remain bounded. Therefore, divergence of the total error covariance can only be caused by modes that are both unstable and observable.\n\nThe problem defines $A_u$ as the restriction of $A$ to the subspace spanned by eigenvectors of unstable and observable modes. The dynamics on this critical subspace govern the overall stability of the estimation error. The growth of the error covariance associated with this subspace during a packet drop is dictated by the map $P \\mapsto A_u P A_u^T$. The \"gain\" of this linear operator on matrices determines the rate of covariance growth. The spectral radius of this operator, which dictates its asymptotic norm growth, is $\\rho(A_u)^2$.\n\nFollowing the logic from the scalar case, after $m$ consecutive packet drops (an event with probability $p^m$), the norm of the error covariance matrix on the unstable-observable subspace grows by a factor proportional to $(\\rho(A_u)^2)^m$. The contribution of these high-error paths to the expected covariance matrix involves terms that scale like $p^m (\\rho(A_u)^2)^m = (p \\rho(A_u)^2)^m$.\n\nFor the expected covariance to be bounded, the effective geometric series formed by these terms must converge, which requires the common ratio to be less than $1$:\n$$p \\, \\rho(A_u)^2  1$$\nThe critical packet loss probability $p_c$ is found at the stability boundary:\n$$p_c \\, \\rho(A_u)^2 = 1$$\nThis gives the expression for the critical probability in the multi-dimensional case:\n$$p_c = \\frac{1}{\\rho(A_u)^2}$$\nThis general result is consistent with the scalar case. For the scalar system, $A=a$ and $C=1$. The system is observable. Since $|a|1$, the single mode is unstable and observable. Thus, $A_u = a$, and $\\rho(A_u) = |a|$. The formula yields $p_c = \\frac{1}{|a|^2} = \\frac{1}{a^2}$, matching the result from Part A.", "answer": "$$\n\\boxed{\\frac{1}{\\rho(A_u)^2}}\n$$", "id": "2726935"}, {"introduction": "After establishing the fundamental challenges that packet loss poses to control and estimation, it is natural to explore mitigation strategies. This exercise examines a common and intuitive network-level solution: the Automatic Repeat reQuest (ARQ) protocol, where a packet can be re-sent if it fails to arrive. By first deriving an \"effective\" packet loss probability for a system with a limited number of retries, you will then quantify precisely how this network-layer enhancement expands the region of mean-square stability for an unstable plant [@problem_id:2726978]. This bridges the gap between communication protocol design and control system performance.", "problem": "A single-input scalar plant is controlled over a lossy digital actuation link in a Networked Control System (NCS). The plant evolves in discrete time according to the linear time-invariant model\n$$\nx_{k+1} = a\\,x_k + b\\,u_k,\n$$\nwith known constants $a \\in \\mathbb{R}$ and $b \\in \\mathbb{R} \\setminus \\{0\\}$. At each sampling instant $k$, the controller computes a static state-feedback $u_k = K\\,x_k$ and transmits it to the actuator over a wireless link that experiences independent and identically distributed (i.i.d.) per-attempt packet loss with probability $p \\in (0,1)$. The communication protocol uses an Automatic Repeat reQuest (ARQ) scheme that permits at most $r$ retries within the sampling period; that is, there are at most $r+1$ transmission attempts per sampling period for the same control value $K\\,x_k$. If at least one attempt succeeds in that period, the actuator applies the intended input $u_k = K\\,x_k$ for that period; otherwise, no control is applied, i.e., $u_k = 0$ for that period. Assume the sampling period is chosen so that all $r$ retries, if used, occur within the period, and that sensing is perfect and instantaneous at the controller (the only impairment is on the actuation link). Also assume $|a| > 1$ so that the open-loop plant is unstable.\n\n1) Starting from the multiplication rule of probability for independent events, derive the effective packet loss probability over a sampling period, denoted $p_{\\mathrm{eff}}$, as a function of $p$ and $r$.\n\n2) Using the definition of mean-square stability, and modeling the reception event by a Bernoulli random variable $\\gamma_k \\in \\{0,1\\}$ with $\\mathbb{P}[\\gamma_k = 1] = 1 - p_{\\mathrm{eff}}$ that indicates successful actuation within period $k$, write the one-step conditional second-moment evolution of $x_k$ under the closed-loop random dynamics\n$$\nx_{k+1} = \\bigl(a + bK\\,\\gamma_k\\bigr)\\,x_k.\n$$\nBy minimizing the conditional second-moment growth factor with respect to the static gain $K$, obtain a necessary and sufficient condition on $p_{\\mathrm{eff}}$ (in terms of $a$) for the existence of some $K \\in \\mathbb{R}$ that ensures mean-square stability.\n\n3) Combining parts $1)$ and $2)$, solve for the largest base per-attempt loss probability $p_{\\max}(a,r)$ as an explicit closed-form function of $a$ and $r$ such that there exists a static gain $K$ achieving mean-square stability under the above ARQ scheme with at most $r$ retries. Provide your final answer as a single analytic expression for $p_{\\max}(a,r)$, with no units.", "solution": "The problem as stated is scientifically grounded, well-posed, and complete. It presents a standard scenario in networked control systems theory and requests a rigorous derivation based on fundamental principles of probability and stability theory. All required data and definitions are provided, and there are no internal contradictions or ambiguities. I will therefore proceed to solve the problem in three parts as requested.\n\nThe first step is to determine the effective packet loss probability, $p_{\\mathrm{eff}}$, for a given sampling period. The communication protocol allows for one initial transmission and up to $r$ retries, for a total of at most $m = r+1$ transmission attempts within one sampling period. A packet is considered lost for the period if and only if all $m$ attempts fail. The attempts are stated to be independent and identically distributed (i.i.d.), with a per-attempt failure probability of $p$. The probability of a successful transmission in a single attempt is thus $1-p$.\nThe event of an effective packet loss for the sampling period $k$ is the conjunction of $m=r+1$ independent failure events. Using the multiplication rule for independent events, the probability of this is:\n$$\np_{\\mathrm{eff}} = \\mathbb{P}[\\text{attempt 1 fails AND attempt 2 fails AND ... AND attempt } m \\text{ fails}]\n$$\n$$\np_{\\mathrm{eff}} = \\mathbb{P}[\\text{attempt 1 fails}] \\times \\mathbb{P}[\\text{attempt 2 fails}] \\times \\dots \\times \\mathbb{P}[\\text{attempt } m \\text{ fails}]\n$$\nSince each attempt has a failure probability of $p$, this simplifies to:\n$$\np_{\\mathrm{eff}} = p \\times p \\times \\dots \\times p \\quad (r+1 \\text{ times})\n$$\n$$\np_{\\mathrm{eff}} = p^{r+1}\n$$\nThis expression provides the effective packet loss probability as a function of the per-attempt loss probability $p$ and the maximum number of retries $r$.\n\nThe second part of the problem requires finding a condition for mean-square stability. The closed-loop dynamics are given by the stochastic difference equation:\n$$\nx_{k+1} = (a + bK\\gamma_k)x_k\n$$\nwhere $\\gamma_k$ is a Bernoulli random variable. This variable models the outcome of the communication over the sampling period $k$. Specifically, $\\gamma_k=1$ if the control input is successfully received (at least one of the $r+1$ attempts succeeds), and $\\gamma_k=0$ if all attempts fail. The probability of successful reception is $1 - p_{\\mathrm{eff}}$, so $\\mathbb{P}[\\gamma_k=1] = 1 - p_{\\mathrm{eff}}$. The probability of failure is $p_{\\mathrm{eff}}$, so $\\mathbb{P}[\\gamma_k=0] = p_{\\mathrm{eff}}$.\n\nA discrete-time linear stochastic system of this form is mean-square stable if and only if $\\lim_{k \\to \\infty} \\mathbb{E}[x_k^2] = 0$. This is guaranteed if the conditional expectation of the squared state one step ahead, given the current state, decreases on average. We analyze the evolution of the second moment of the state, $\\mathbb{E}[x_k^2]$. Let us compute the conditional second moment:\n$$\n\\mathbb{E}[x_{k+1}^2 | x_k] = \\mathbb{E}[(a + bK\\gamma_k)^2 x_k^2 | x_k]\n$$\nSince $x_k$ is known at time step $k$, we can factor it out of the expectation:\n$$\n\\mathbb{E}[x_{k+1}^2 | x_k] = x_k^2 \\mathbb{E}[(a + bK\\gamma_k)^2]\n$$\nThe expectation is taken over the random variable $\\gamma_k$. By the law of total expectation for discrete random variables:\n$$\n\\mathbb{E}[(a + bK\\gamma_k)^2] = (a + bK(1))^2 \\mathbb{P}[\\gamma_k=1] + (a + bK(0))^2 \\mathbb{P}[\\gamma_k=0]\n$$\n$$\n\\mathbb{E}[(a + bK\\gamma_k)^2] = (a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}\n$$\nFor the system to be mean-square stable, there must exist a gain $K$ such that this second-moment growth factor is strictly less than $1$:\n$$\n(a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}  1\n$$\nLet us define the function $G(K) = (a + bK)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}$. We need to find if the minimum value of $G(K)$ with respect to $K$ is less than $1$. $G(K)$ is a quadratic function of $K$. Since $b \\neq 0$ and $p \\in (0,1)$ implies $p_{\\mathrm{eff}} \\in (0,1)$, the coefficient of the $K^2$ term, which is $b^2(1-p_{\\mathrm{eff}})$, is positive. Therefore, the parabola $G(K)$ opens upwards and has a unique minimum. To find the minimum, we compute the derivative with respect to $K$ and set it to zero:\n$$\n\\frac{dG}{dK} = 2b(a+bK)(1 - p_{\\mathrm{eff}}) = 0\n$$\nSince $b \\neq 0$ and $1-p_{\\mathrm{eff}} \\neq 0$, the optimal gain $K^*$ that minimizes $G(K)$ is given by $a+bK^*=0$, which yields $K^* = -a/b$.\nSubstituting this optimal gain back into the expression for $G(K)$, we find the minimum value of the growth factor:\n$$\n\\min_K G(K) = G(K^*) = (a + b(-a/b))^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}}\n$$\n$$\n\\min_K G(K) = (a - a)^2 (1 - p_{\\mathrm{eff}}) + a^2 p_{\\mathrm{eff}} = 0 + a^2 p_{\\mathrm{eff}} = a^2 p_{\\mathrm{eff}}\n$$\nThe necessary and sufficient condition for the existence of a stabilizing gain $K$ is that this minimum growth factor is less than $1$:\n$$\na^2 p_{\\mathrm{eff}}  1\n$$\nThis can be rewritten as a condition on the effective loss probability:\n$$\np_{\\mathrm{eff}}  \\frac{1}{a^2}\n$$\nThis is the condition on $p_{\\mathrm{eff}}$ required for mean-square stabilizability.\n\nFinally, the third part requires us to combine these two results to find the largest per-attempt loss probability $p_{\\max}(a,r)$ for which a stabilizing static gain exists.\nFrom part $1$, we have $p_{\\mathrm{eff}} = p^{r+1}$.\nFrom part $2$, the condition for stabilizability is $p_{\\mathrm{eff}}  1/a^2$.\nSubstituting the first expression into the second gives the condition on the per-attempt probability $p$:\n$$\np^{r+1}  \\frac{1}{a^2}\n$$\nSince $p$ must be non-negative, and $r+1  0$, we can take the $(r+1)$-th root of both sides of the inequality without changing its direction:\n$$\np  \\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}\n$$\nThe problem asks for the largest per-attempt loss probability, $p_{\\max}$, for which stability can be achieved. This corresponds to the supremum of the set of all such valid probabilities $p$. Thus, we have:\n$$\np_{\\max}(a,r) = \\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}\n$$\nThis expression gives the boundary of the stability region in terms of the per-attempt packet loss probability $p$ as a function of the plant parameter $a$ and the number of retries $r$. For any $p  p_{\\max}(a,r)$, a gain $K$ can be found to stabilize the system in the mean-square sense.", "answer": "$$\\boxed{\\left(\\frac{1}{a^2}\\right)^{\\frac{1}{r+1}}}$$", "id": "2726978"}]}