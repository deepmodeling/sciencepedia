{"hands_on_practices": [{"introduction": "To begin our practical exploration of the Néel temperature, we start with a foundational calculation using mean-field theory. This powerful approximation, while neglecting fluctuations, provides invaluable physical intuition and a first estimate for the ordering temperature. By applying it to a standard unfrustrated lattice, this practice solidifies your understanding of how magnetic interactions and lattice geometry cooperate to establish long-range antiferromagnetic order below $T_N$ [@problem_id:37392].", "problem": "Consider a system of localized spins on a simple cubic (sc) lattice, described by the Heisenberg Hamiltonian:\n$$H = - J_1 \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j - J_2 \\sum_{\\langle\\langle ik \\rangle\\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_k$$\nHere, $\\mathbf{S}_i$ is the spin operator for the site $i$, which has a spin quantum number $S$. The first sum runs over all unique nearest-neighbor (NN) pairs, with an antiferromagnetic exchange coupling $J_1  0$. The second sum runs over all unique next-nearest-neighbor (NNN) pairs, with an exchange coupling $J_2$ of arbitrary sign.\n\nThe simple cubic lattice is a bipartite lattice, meaning it can be divided into two interpenetrating sublattices, A and B, such that any site on sublattice A has all its nearest neighbors on sublattice B, and vice-versa. At low temperatures, the system is assumed to order into a Néel antiferromagnetic state, where the average spin on sublattice A is antiparallel to the average spin on sublattice B, i.e., $\\langle \\mathbf{S}_A \\rangle = - \\langle \\mathbf{S}_B \\rangle$.\n\nUsing mean-field theory, determine the Néel temperature, $T_N$, which marks the transition from the high-temperature paramagnetic phase to the ordered antiferromagnetic phase. Express your answer in terms of $J_1$, $J_2$, $S$, and the Boltzmann constant $k_B$.", "solution": "To determine the Néel temperature $T_N$ for the simple cubic lattice with the given Heisenberg Hamiltonian, we use mean-field theory. The Hamiltonian is:\n\n$$\nH = -J_1 \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j - J_2 \\sum_{\\langle\\langle ik \\rangle\\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_k\n$$\n\nwhere $J_1  0$ (antiferromagnetic), $J_2$ is arbitrary, and the lattice is bipartite with sublattices A and B. In the Néel state, $\\langle \\mathbf{S}_A \\rangle = -\\langle \\mathbf{S}_B \\rangle$. Near $T_N$, the order parameter is small, so we linearize the mean-field equations.\n\nEach site has $z_1 = 6$ nearest neighbors (NN) and $z_2 = 12$ next-nearest neighbors (NNN). For a spin on sublattice A:\n- NN are on sublattice B, with average spin $\\langle \\mathbf{S}_B \\rangle = -m \\hat{n}$.\n- NNN are on sublattice A, with average spin $\\langle \\mathbf{S}_A \\rangle = m \\hat{n}$.\n\nThe mean-field Hamiltonian for a spin on A is:\n$$\nH_i^{\\text{MF}} = - \\mathbf{S}_i \\cdot \\mathbf{B}_{\\text{eff},A}\n$$\nwhere the effective field $\\mathbf{B}_{\\text{eff},A}$ is derived from the interactions by summing the contributions from all neighbors. The effective field on a spin on sublattice A is given by:\n$$\n\\mathbf{B}_{\\text{eff},A} = z_1 (-J_1) (-\\langle \\mathbf{S}_A \\rangle) + z_2 (-J_2) (\\langle \\mathbf{S}_A \\rangle)\n$$\nWait, this is not correct. The field is from neighbors. Let's restart the derivation of the effective field. The energy of a spin $S_i$ on site $i \\in A$ is $H_i = S_i \\cdot \\left( -J_1 \\sum_{j \\in NN(i)} \\langle S_j \\rangle - J_2 \\sum_{k \\in NNN(i)} \\langle S_k \\rangle \\right)$. Since $j \\in B$ and $k \\in A$, and with $\\langle S_A \\rangle = m\\hat{n}$ and $\\langle S_B \\rangle = -m\\hat{n}$, this becomes:\n$$H_i = S_i \\cdot \\left( -J_1 z_1 (-m\\hat{n}) - J_2 z_2 (m\\hat{n}) \\right) = S_i \\cdot \\left( (z_1 J_1 - z_2 J_2) m\\hat{n} \\right)$$\nComparing with the Zeeman form $H_i = -S_i \\cdot B_{eff, A}$, we find\n$$\n\\mathbf{B}_{\\text{eff},A} = -(z_1 J_1 - z_2 J_2) m\\hat{n} = (-z_1 J_1 + z_2 J_2) m \\hat{n}\n$$\nIn the linear regime near $T_N$, the average spin on A is:\n$$\n\\langle \\mathbf{S}_A \\rangle = \\frac{S(S+1)}{3 k_B T} \\mathbf{B}_{\\text{eff},A}\n$$\nSubstituting $\\langle \\mathbf{S}_A \\rangle = m \\hat{n}$:\n$$\nm \\hat{n} = \\frac{S(S+1)}{3 k_B T} (-z_1 J_1 + z_2 J_2) m \\hat{n}\n$$\nAssuming $m \\neq 0$ (at the transition, $m$ is infinitesimal but non-zero in the ordered phase), we divide both sides by $m \\hat{n}$:\n$$\n1 = \\frac{S(S+1)}{3 k_B T} (-z_1 J_1 + z_2 J_2)\n$$\nSolving for $T = T_N$:\n$$\nT_N = \\frac{S(S+1)}{3 k_B} (-z_1 J_1 + z_2 J_2)\n$$\nSubstitute $z_1 = 6$ and $z_2 = 12$:\n$$\nT_N = \\frac{S(S+1)}{3 k_B} (-6 J_1 + 12 J_2) = \\frac{2 S(S+1)}{k_B} (-J_1 + 2 J_2)\n$$\nThis expression gives the Néel temperature in terms of $J_1$, $J_2$, $S$, and $k_B$. Since $J_1  0$, the term $-J_1$ is positive, favoring antiferromagnetism. A positive $J_2$ (ferromagnetic NNN coupling) also enhances $T_N$ for this ordering pattern, while a negative $J_2$ (antiferromagnetic NNN coupling) frustrates the order and reduces $T_N$.", "answer": "$$\n\\boxed{T_N = \\frac{2 S \\left(S + 1\\right) \\left(- J_{1} + 2 J_{2}\\right)}{k_{B}}}\n$$", "id": "37392"}, {"introduction": "Having mastered the basics on a simple lattice, we now venture into the fascinating realm of geometric frustration. On lattices like the triangular grid, competing antiferromagnetic interactions on neighboring bonds cannot all be simultaneously satisfied, preventing simple collinear ordering. This exercise challenges you to adapt mean-field theory to a non-collinear, three-sublattice magnetic structure, revealing the characteristic $120^\\circ$ order and demonstrating how frustration fundamentally suppresses the Néel temperature compared to an unfrustrated counterpart [@problem_id:2843736].", "problem": "Consider a quantum Heisenberg antiferromagnet on a two-dimensional triangular Bravais lattice with nearest-neighbor exchange. The Hamiltonian is\n$$\nH \\;=\\; J \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j \\,,\n$$\nwith $J0$ and spin magnitude $S$ on each site. The lattice coordination number is $z=6$. Assume an isotropic model without single-ion anisotropy or external field, and apply Weiss mean-field theory (also called molecular-field theory): replace neighboring spins by their thermal averages and linearize the self-consistency equations near the ordering temperature. As the incipient antiferromagnetic order on the triangular lattice is known to be noncollinear with a three-sublattice $120^\\circ$ pattern, introduce three sublattices $A$, $B$, and $C$ and corresponding uniform sublattice magnetizations $\\mathbf{m}_A$, $\\mathbf{m}_B$, and $\\mathbf{m}_C$, defined by $\\mathbf{m}_\\alpha \\equiv \\langle \\mathbf{S}_i \\rangle$ for $i$ on sublattice $\\alpha$.\n\nStarting only from the Hamiltonian above and the Curie (high-temperature) response of a single quantum spin,\n$$\n\\langle \\mathbf{S} \\rangle \\;=\\; \\frac{S(S+1)}{3 k_B T} \\, \\mathbf{h}_{\\mathrm{eff}} \\,,\n$$\nwhere the on-site effective field is defined by the local Zeeman form $H_{\\mathrm{site}} = - \\mathbf{h}_{\\mathrm{eff}} \\cdot \\mathbf{S}$, derive the linearized mean-field equations for $\\mathbf{m}_A$, $\\mathbf{m}_B$, and $\\mathbf{m}_C$. Diagonalize the resulting coupling in sublattice space to identify the mode that first becomes unstable upon cooling and extract the corresponding mean-field Néel temperature. Express the final result for the Néel temperature $T_N$ as a symbolic expression in terms of $J$, $S$, and $k_B$.\n\nIn your reasoning, clarify how the noncollinear $120^\\circ$ pattern enters the mean-field instability condition and how it sets the scale of the ordering temperature relative to a hypothetical collinear antiferromagnet on a bipartite lattice with the same coordination.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It presents a canonical problem in the statistical mechanics of frustrated magnetism, utilizing standard and appropriate theoretical tools. All necessary information, including the Hamiltonian, lattice structure, and the linearized high-temperature response of a spin, is provided. Therefore, the problem is valid and a solution will be provided.\n\nThe system is described by the Heisenberg Hamiltonian $H = J \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$ with antiferromagnetic coupling $J0$ on a two-dimensional triangular lattice. The coordination number of this lattice is $z=6$. The triangular lattice is not bipartite and exhibits geometric frustration. To accommodate the expected $120^\\circ$ noncollinear magnetic ordering, we partition the lattice into three equivalent sublattices, labeled $A$, $B$, and $C$. Each site on a given sublattice is surrounded by three nearest neighbors on each of the other two sublattices. For instance, a site on sublattice $A$ has $z_{AB}=3$ neighbors on sublattice $B$ and $z_{AC}=3$ neighbors on sublattice $C$.\n\nWe apply the Weiss mean-field theory (MFT). In MFT, the spin operator $\\mathbf{S}_j$ of a neighboring site $j$ is replaced by its thermal average, the sublattice magnetization $\\mathbf{m}_\\alpha = \\langle \\mathbf{S}_j \\rangle$ where $j \\in \\alpha$. The mean-field Hamiltonian for a single spin $\\mathbf{S}_i$ located on sublattice $A$ is given by:\n$$\nH_{i \\in A}^{\\text{MF}} = \\mathbf{S}_i \\cdot \\sum_{j \\text{ nn of } i} J \\langle \\mathbf{S}_j \\rangle = \\mathbf{S}_i \\cdot \\left( J \\sum_{j \\in B, \\text{nn}} \\mathbf{m}_B + J \\sum_{j \\in C, \\text{nn}} \\mathbf{m}_C \\right)\n$$\nGiven that there are $z_{AB}=3$ neighbors on sublattice $B$ and $z_{AC}=3$ on sublattice $C$, this simplifies to:\n$$\nH_{i \\in A}^{\\text{MF}} = \\mathbf{S}_i \\cdot (3J\\mathbf{m}_B + 3J\\mathbf{m}_C)\n$$\nThe problem defines the effective magnetic field $\\mathbf{h}_{\\mathrm{eff}}$ via the local Zeeman-like term $H_{\\mathrm{site}} = - \\mathbf{h}_{\\mathrm{eff}} \\cdot \\mathbf{S}$. By comparing this with the expression for $H_{i \\in A}^{\\text{MF}}$, we identify the effective field acting on a spin in sublattice $A$:\n$$\n\\mathbf{h}_{\\mathrm{eff}, A} = -3J(\\mathbf{m}_B + \\mathbf{m}_C)\n$$\nBy symmetry, the effective fields on sublattices $B$ and $C$ are:\n$$\n\\mathbf{h}_{\\mathrm{eff}, B} = -3J(\\mathbf{m}_A + \\mathbf{m}_C)\n$$\n$$\n\\mathbf{h}_{\\mathrm{eff}, C} = -3J(\\mathbf{m}_A + \\mathbf{m}_B)\n$$\nThe problem provides the high-temperature (Curie) response of a single spin to an effective field, which is used to establish the self-consistency condition near the ordering temperature $T_N$:\n$$\n\\mathbf{m}_\\alpha = \\frac{S(S+1)}{3k_B T} \\mathbf{h}_{\\mathrm{eff}, \\alpha}\n$$\nSubstituting the expressions for the effective fields, we obtain a system of linearized equations for the sublattice magnetizations:\n$$\n\\mathbf{m}_A = -\\frac{S(S+1)}{3k_B T} [3J(\\mathbf{m}_B + \\mathbf{m}_C)] = -\\frac{JS(S+1)}{k_B T} (\\mathbf{m}_B + \\mathbf{m}_C)\n$$\n$$\n\\mathbf{m}_B = -\\frac{JS(S+1)}{k_B T} (\\mathbf{m}_A + \\mathbf{m}_C)\n$$\n$$\n\\mathbf{m}_C = -\\frac{JS(S+1)}{k_B T} (\\mathbf{m}_A + \\mathbf{m}_B)\n$$\nWe can rearrange this system into a matrix eigenvalue problem. Let us organize the vector components of magnetization into a column vector $\\vec{\\mathbf{m}} = (\\mathbf{m}_A, \\mathbf{m}_B, \\mathbf{m}_C)^T$. The equations become:\n$$\nT \\begin{pmatrix} \\mathbf{m}_A \\\\ \\mathbf{m}_B \\\\ \\mathbf{m}_C \\end{pmatrix} = -\\frac{JS(S+1)}{k_B} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{m}_A \\\\ \\mathbf{m}_B \\\\ \\mathbf{m}_C \\end{pmatrix}\n$$\nThis is an eigenvalue equation of the form $T\\vec{\\mathbf{m}} = \\mathcal{M} \\vec{\\mathbf{m}}$. A non-trivial solution for the magnetizations $\\mathbf{m}_\\alpha$ exists if $T$ is an eigenvalue of the matrix $\\mathcal{M}$. The ordering temperature, or Néel temperature $T_N$, is the highest positive eigenvalue, as this represents the temperature at which the system first becomes unstable to forming long-range order upon cooling from the disordered paramagnetic phase.\n\nLet the coupling matrix be $K = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix}$. The eigenvalues of $\\mathcal{M}$ are the eigenvalues of $K$ scaled by the constant factor $-\\frac{JS(S+1)}{k_B}$. We first find the eigenvalues $\\mu$ of $K$ by solving the characteristic equation $\\det(K - \\mu I) = 0$:\n$$\n\\det \\begin{pmatrix} -\\mu  1  1 \\\\ 1  -\\mu  1 \\\\ 1  1  -\\mu \\end{pmatrix} = -\\mu(\\mu^2 - 1) - 1(-\\mu - 1) + 1(1 + \\mu) = -\\mu^3 + 3\\mu + 2 = 0\n$$\nThis cubic equation can be factored as $(\\mu - 2)(\\mu+1)^2 = 0$. The eigenvalues of $K$ are therefore $\\mu_1 = 2$ and a degenerate eigenvalue $\\mu_2 = \\mu_3 = -1$.\n\nThe corresponding eigenvalues for the temperature $T$ are:\nFor $\\mu=2$: $T_1 = -\\frac{JS(S+1)}{k_B} (2) = -2\\frac{JS(S+1)}{k_B}$. This is a negative temperature and thus unphysical for a phase transition upon cooling. The corresponding eigenvector is $(1,1,1)^T$, representing a ferromagnetic alignment of sublattice magnetizations, which is unstable for an antiferromagnetic interaction $J0$.\n\nFor $\\mu=-1$: $T_2 = T_3 = -\\frac{JS(S+1)}{k_B} (-1) = \\frac{JS(S+1)}{k_B}$. This temperature is positive and physical. The eigenvector $(\\mathbf{m}_A, \\mathbf{m}_B, \\mathbf{m}_C)^T$ for this degenerate eigenvalue must satisfy $(K - (-1)I)\\vec{\\mathbf{m}} = 0$, which is:\n$$\n\\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix} \\begin{pmatrix} \\mathbf{m}_A \\\\ \\mathbf{m}_B \\\\ \\mathbf{m}_C \\end{pmatrix} = 0\n$$\nThis yields the condition $\\mathbf{m}_A + \\mathbf{m}_B + \\mathbf{m}_C = 0$. This condition is precisely what defines the noncollinear $120^\\circ$ spin structure, where the three sublattice magnetization vectors are coplanar, have equal magnitude, are separated by angles of $120^\\circ$, and sum to zero.\n\nThe highest physical transition temperature is the Néel temperature $T_N$. In this case, there is only one positive eigenvalue. Therefore, the mean-field Néel temperature for the triangular lattice antiferromagnet is:\n$$\nT_N = \\frac{JS(S+1)}{k_B}\n$$\n\nTo understand the impact of frustration, we compare this result to that of a hypothetical bipartite lattice with the same coordination number $z=6$, such as a simple cubic lattice. For a bipartite lattice with AF coupling $J>0$, the mean-field theory yields $T_N^{\\text{bipartite}} = \\frac{zJS(S+1)}{3k_B}$. With $z=6$:\n$$\nT_N^{\\text{bipartite}} = \\frac{6JS(S+1)}{3k_B} = \\frac{2JS(S+1)}{k_B}\n$$\nComparing the two results, we find $T_N^{\\text{triangular}} = \\frac{1}{2} T_N^{\\text{bipartite}}$. The geometric frustration of the triangular lattice prevents a simple collinear arrangement where every pair of neighboring spins is antiparallel. In the $120^\\circ$ structure, the effective antiferromagnetic coupling felt by a spin is reduced. The sum of interactions from a spin's neighbors, which would align perfectly antiparallel for an unfrustrated lattice, is now a partial, frustrated sum. This frustration weakens the molecular field that drives the ordering, resulting in a significantly lower Néel temperature compared to an unfrustrated system with the same number of neighbors and interaction strength.", "answer": "$$\\boxed{T_N = \\frac{J S (S+1)}{k_B}}$$", "id": "2843736"}, {"introduction": "Our final practice makes the leap from analytical approximations to the powerful techniques of modern computational physics. For many quantum systems, precisely determining the Néel temperature requires large-scale numerical simulations, such as Quantum Monte Carlo (QMC). This problem provides a practical glimpse into this process, focusing on the crucial data analysis step where the principles of finite-size scaling are used to extract a high-precision estimate for $T_N$ from raw simulation output. Using hypothetical QMC data for the Binder ratio, you will implement the standard \"curve crossing\" method to pinpoint the critical point, a technique central to the study of phase transitions [@problem_id:2843722].", "problem": "You are given the task of designing and testing a sign-problem-free Quantum Monte Carlo (QMC) analysis strategy to estimate the Néel temperature $T_{\\mathrm{N}}$ of a quantum Heisenberg antiferromagnet with spin $S=1/2$ on a three-dimensional (3D) bipartite, unfrustrated lattice. Your program must implement the analysis stage that takes as input finite-size data that would be produced by a Stochastic Series Expansion (SSE) QMC, and outputs an estimate of $T_{\\mathrm{N}}$ by exploiting scale-invariant observables.\n\nFundamental base to be used:\n- The Hamiltonian is $H = J \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$ with $J0$ on a bipartite, unfrustrated 3D lattice, where $\\langle ij \\rangle$ are nearest neighbors and $\\mathbf{S}_i$ are spin-$1/2$ operators.\n- The partition function is $Z = \\mathrm{Tr}\\, e^{-\\beta H}$ with $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant and $T$ is temperature.\n- In a sign-problem-free SSE sampling on a bipartite unfrustrated antiferromagnet, one can obtain estimators for the staggered magnetization $\\mathbf{m}_{\\mathrm{s}}$ and its moments $\\langle m_{\\mathrm{s}}^2 \\rangle$ and $\\langle m_{\\mathrm{s}}^4 \\rangle$ at temperature $T$ and linear size $L$.\n- Define the Binder ratio (dimensionless) for one component of the staggered order parameter as $U_4(T,L) = 1 - \\frac{\\langle m_{\\mathrm{s}}^4 \\rangle}{3 \\langle m_{\\mathrm{s}}^2 \\rangle^2}$. Renormalization-group theory and finite-size scaling imply that dimensionless quantities such as $U_4$ become approximately scale-invariant at the critical temperature, i.e., $U_4(T_{\\mathrm{N}},L)$ is approximately independent of $L$ up to subleading corrections.\n- Therefore, at $T = T_{\\mathrm{N}}$, the curves $U_4(T,L)$ for different $L$ cross, and the temperature where the across-$L$ variance of $U_4$ is minimized provides a consistent estimator of $T_{\\mathrm{N}}$.\n\nYour program must:\n- For each test case below, treat the provided $U_4(T,L)$ data as QMC outputs sampled at discrete temperatures and sizes $L$.\n- Interpolate $U_4(T,L)$ as a function of $T$ for each fixed $L$ using a shape-preserving method defined on the convex hull of the provided temperatures for that $L$.\n- Define the objective function $F(T) = \\frac{1}{N_L} \\sum_{i=1}^{N_L} \\left(U_4(T,L_i) - \\overline{U}_4(T)\\right)^2$, where $N_L$ is the number of sizes and $\\overline{U}_4(T) = \\frac{1}{N_L}\\sum_{i=1}^{N_L} U_4(T,L_i)$ is the size-average at fixed $T$.\n- Estimate $T_{\\mathrm{N}}$ for the case as the minimizer $T^\\star$ of $F(T)$ over the intersection of the temperature intervals where all $L$ have data (i.e., the common domain of the interpolants). If the minimizer lies on the boundary of the common interval, return that boundary value.\n- Express the final temperatures in units of $J/k_B$, rounded to $4$ decimal places.\n\nTest suite:\n- Case A (happy path; clean, monotonic data; sizes $L \\in \\{8,12,16\\}$; common temperature grid $T \\in [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$ with $T$ in units of $J/k_B$):\n  - $U_4(T,8)$ at $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$: $[0.58,0.54,0.55,0.45,0.36,0.28,0.16]$.\n  - $U_4(T,12)$ at $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$: $[0.60,0.56,0.53,0.40,0.30,0.22,0.12]$.\n  - $U_4(T,16)$ at $T = [0.80,0.90,0.95,1.00,1.05,1.10,1.20]$: $[0.62,0.58,0.50,0.36,0.26,0.18,0.10]$.\n- Case B (noisy data; same sizes and grid as Case A):\n  - $U_4(T,8)$: $[0.579,0.541,0.551,0.452,0.358,0.279,0.162]$.\n  - $U_4(T,12)$: $[0.603,0.557,0.528,0.401,0.297,0.219,0.118]$.\n  - $U_4(T,16)$: $[0.618,0.584,0.498,0.357,0.264,0.176,0.101]$.\n- Case C (incomplete temperatures for one size; intersection of domains still brackets the crossing):\n  - Sizes $L \\in \\{8,12,16\\}$.\n  - For $L=8$: temperatures $[0.82,0.90,0.94,0.98,1.06,1.16]$, values $[0.566,0.542,0.525,0.438,0.342,0.162]$.\n  - For $L=12$: temperatures $[0.82,0.90,0.98,1.06,1.16]$, values $[0.588,0.562,0.402,0.301,0.122]$.\n  - For $L=16$: temperatures $[0.82,0.90,0.94,0.98,1.06,1.16]$, values $[0.607,0.582,0.505,0.365,0.256,0.104]$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for Cases A, B, and C, in that order, as a comma-separated list of the three estimated $T_{\\mathrm{N}}$ values enclosed in square brackets, each rounded to $4$ decimal places, for example $[0.9450,0.9460,0.9440]$.\n- Units: all temperatures must be reported in $J/k_B$.", "solution": "The problem as stated is a well-posed exercise in the numerical analysis of simulated data, a standard procedure in computational condensed matter physics for determining a critical temperature from finite-size scaling. The underlying physical principles—the Heisenberg model, the Néel transition, finite-size scaling, and the use of the Binder cumulant—are all sound and firmly established. The specified methodology is a canonical approach for estimating the critical point. The problem is therefore valid.\n\nThe objective is to estimate the Néel temperature, $T_{\\mathrm{N}}$, of a spin-$1/2$ quantum Heisenberg antiferromagnet on a three-dimensional bipartite lattice. This is achieved by analyzing finite-size data for the Binder ratio, $U_4(T,L)$, which is presumed to be obtained from sign-problem-free Quantum Monte Carlo simulations. The value of $T_{\\mathrm{N}}$ is taken to be the temperature at which the curves of $U_4$ versus $T$ for different system sizes $L$ exhibit a common crossing point. This crossing point is located by finding the temperature $T$ that minimizes the variance of $U_4(T,L)$ across the different sizes $L$.\n\nThe Hamiltonian of the system is given by $H = J \\sum_{\\langle ij \\rangle} \\mathbf{S}_i \\cdot \\mathbf{S}_j$ with exchange coupling $J > 0$. We work in units where the Boltzmann constant $k_B = 1$ and the temperature is measured in units of $J$. The Binder ratio is defined as $U_4(T,L) = 1 - \\frac{\\langle m_{\\mathrm{s}}^4 \\rangle}{3 \\langle m_{\\mathrm{s}}^2 \\rangle^2}$, where $m_{\\mathrm{s}}$ is one component of the staggered magnetization vector. This quantity is dimensionless and, according to renormalization-group theory, becomes independent of system size $L$ at the critical temperature $T_{\\mathrm{N}}$, up to scaling corrections.\n\nThe computational procedure involves the following steps:\n\n1.  **Interpolation of Data**: For each system size $L_i$, the provided discrete data points $(T_j, U_4(T_j, L_i))$ are used to construct a continuous function $U_4(T, L_i)$. The problem requires a \"shape-preserving\" interpolation method. For this purpose, the Piecewise Cubic Hermite Interpolating Polynomial (PCHIP) is an appropriate choice. PCHIP preserves the monotonicity of the original data segments, thus avoiding the introduction of spurious oscillations that could interfere with the subsequent minimization step. In the provided implementation, this is accomplished using `scipy.interpolate.PchipInterpolator`.\n\n2.  **Definition of the Common Temperature Domain**: The minimization of the objective function must be performed over a temperature interval where interpolated data is available for all system sizes. For each size $L_i$, the interpolation is valid on the convex hull of its temperature points, which is the interval $[\\min(T_{ij}), \\max(T_{ij})]$. The common domain for the analysis is therefore the intersection of these intervals, given by $[T_{\\min}, T_{\\max}]$, where $T_{\\min} = \\max_i(\\min_j(T_{ij}))$ and $T_{\\max} = \\min_i(\\max_j(T_{ij}))$.\n\n3.  **Objective Function**: The crossing point is estimated by minimizing an objective function $F(T)$ that quantifies the spread of the $U_4$ values at a given temperature $T$. The function is defined as the variance of the interpolated $U_4(T,L_i)$ values across the $N_L$ system sizes:\n    $$F(T) = \\frac{1}{N_L} \\sum_{i=1}^{N_L} \\left(U_4(T,L_i) - \\overline{U}_4(T)\\right)^2$$\n    where $\\overline{U}_4(T) = \\frac{1}{N_L}\\sum_{i=1}^{N_L} U_4(T,L_i)$ is the mean value at temperature $T$. This variance can be directly computed using `numpy.var`.\n\n4.  **Numerical Minimization**: The Néel temperature $T_{\\mathrm{N}}$ is estimated as the temperature $T^\\star$ that minimizes $F(T)$ within the common domain $[T_{\\min}, T_{\\max}]$. A one-dimensional bounded optimization routine, `scipy.optimize.minimize_scalar` with the `method='bounded'` option, is employed to find this minimum. This method is robust and guarantees that the solution remains within the specified interval.\n\nThis entire procedure is encapsulated into a function and applied to each of the three test cases provided. The final estimated temperatures are rounded to four decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import PchipInterpolator\nfrom scipy.optimize import minimize_scalar\n\ndef estimate_neel_temp(case_data):\n    \"\"\"\n    Estimates the Néel temperature T_N for a single test case.\n\n    Args:\n        case_data (list): A list of tuples, where each tuple contains\n                          (L, temperatures, U4_values) for a system size.\n\n    Returns:\n        float: The estimated Néel temperature T_N.\n    \"\"\"\n    interpolators = []\n    temp_intervals = []\n\n    # Step 1: Create a shape-preserving interpolator for each system size.\n    # PchipInterpolator is a good choice for preserving monotonicity.\n    for _, temps, u4_vals in case_data:\n        # PchipInterpolator requires data to be sorted by the independent variable.\n        sorted_indices = np.argsort(temps)\n        sorted_temps = np.array(temps)[sorted_indices]\n        sorted_u4_vals = np.array(u4_vals)[sorted_indices]\n        \n        interpolators.append(PchipInterpolator(sorted_temps, sorted_u4_vals))\n        temp_intervals.append((min(temps), max(temps)))\n\n    # Step 2: Determine the common temperature domain for analysis.\n    # This is the intersection of the temperature ranges for all sizes.\n    t_min_common = max(interval[0] for interval in temp_intervals)\n    t_max_common = min(interval[1] for interval in temp_intervals)\n\n    # Step 3: Define the objective function F(T), which is the variance of\n    # the U4 values across different sizes at a fixed temperature T.\n    def objective_function(T):\n        \"\"\" The function to be minimized. \"\"\"\n        if not (t_min_common = T = t_max_common):\n             return np.inf  # Return a large value outside the valid domain\n        \n        u4_at_T = np.array([interp(T) for interp in interpolators])\n        # np.var calculates the population variance by default (ddof=0),\n        # which matches the formula provided in the problem.\n        return np.var(u4_at_T)\n\n    # Step 4: Find the temperature T that minimizes the objective function\n    # within the common domain.\n    result = minimize_scalar(\n        objective_function,\n        bounds=(t_min_common, t_max_common),\n        method='bounded'\n    )\n\n    neel_temp = result.x\n    return neel_temp\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the analysis, and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Happy path\n        [\n            (8, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.58, 0.54, 0.55, 0.45, 0.36, 0.28, 0.16]),\n            (12, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.60, 0.56, 0.53, 0.40, 0.30, 0.22, 0.12]),\n            (16, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.62, 0.58, 0.50, 0.36, 0.26, 0.18, 0.10]),\n        ],\n        # Case B: Noisy data\n        [\n            (8, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.579, 0.541, 0.551, 0.452, 0.358, 0.279, 0.162]),\n            (12, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.603, 0.557, 0.528, 0.401, 0.297, 0.219, 0.118]),\n            (16, [0.80, 0.90, 0.95, 1.00, 1.05, 1.10, 1.20], [0.618, 0.584, 0.498, 0.357, 0.264, 0.176, 0.101]),\n        ],\n        # Case C: Incomplete temperatures\n        [\n            (8, [0.82, 0.90, 0.94, 0.98, 1.06, 1.16], [0.566, 0.542, 0.525, 0.438, 0.342, 0.162]),\n            (12, [0.82, 0.90, 0.98, 1.06, 1.16], [0.588, 0.562, 0.402, 0.301, 0.122]),\n            (16, [0.82, 0.90, 0.94, 0.98, 1.06, 1.16], [0.607, 0.582, 0.505, 0.365, 0.256, 0.104]),\n        ]\n    ]\n\n    results = []\n    for case in test_cases:\n        tn_estimate = estimate_neel_temp(case)\n        # Format the result to 4 decimal places.\n        results.append(f\"{tn_estimate:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2843722"}]}