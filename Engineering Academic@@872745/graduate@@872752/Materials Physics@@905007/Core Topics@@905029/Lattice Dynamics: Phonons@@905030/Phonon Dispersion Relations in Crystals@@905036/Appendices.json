{"hands_on_practices": [{"introduction": "Understanding phonon dispersion begins with the simplest possible model: an infinite chain of identical masses connected by springs. This exercise walks you through the fundamental derivation of the dispersion relation $\\omega(q)$ from first principles, applying Newton's second law to a line of atoms. By solving this canonical problem [@problem_id:2848415], you will build a solid intuition for how the collective motion of atoms gives rise to wave-like excitations (phonons) and see directly how their frequency depends on their wavevector.", "problem": "Consider an infinite one-dimensional monatomic Bravais lattice of identical atoms of mass $M$, with lattice constant $a$. Neighboring atoms are coupled by identical, linear, harmonic springs with spring constant $K$ that act only between nearest neighbors. Assume small displacements $u_n(t)$ from equilibrium so that Hooke's law is valid. Impose Born–von Karman (BvK) periodic boundary conditions on a chain of $N$ atoms and then take the limit $N \\to \\infty$ at the end if needed. \n\nStarting from Newton's second law and Hooke's law for the restoring forces between nearest neighbors, derive the linear equations of motion for the displacements $\\{u_n(t)\\}$. From these equations, construct the dynamical matrix $D(q)$ in reciprocal space for this monatomic lattice and solve the corresponding eigenvalue problem to obtain the explicit analytic form of the phonon angular frequency $\\omega(q)$ for wave vector $q$ in the first Brillouin zone of the one-dimensional lattice. \n\nUse radians for all angular quantities, and take the first Brillouin zone to be $q \\in [-\\pi/a,\\pi/a]$. Express the final frequency $\\omega(q)$ in radians per second as a closed-form analytic expression in terms of $K$, $M$, $a$, and $q$. Your final answer must be a single expression for $\\omega(q)$ (do not include an equality sign). No numerical evaluation or rounding is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- System: Infinite one-dimensional monatomic Bravais lattice.\n- Atomic properties: Mass $M$.\n- Lattice geometry: Lattice constant $a$.\n- Interactions: Linear harmonic springs with spring constant $K$, acting between nearest neighbors only.\n- Dynamics: Small displacements $u_n(t)$ from equilibrium.\n- Governing laws: Newton's second law, Hooke's law.\n- Boundary conditions: Born–von Karman (BvK) periodic boundary conditions on a chain of $N$ atoms, with the limit $N \\to \\infty$.\n- Tasks:\n    1. Derive the linear equations of motion for $\\{u_n(t)\\}$.\n    2. Construct the dynamical matrix $D(q)$.\n    3. Solve the eigenvalue problem to find the phonon angular frequency $\\omega(q)$.\n- Domain: Wave vector $q$ is in the first Brillouin zone, $q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$.\n- Required output format: A single closed-form analytic expression for $\\omega(q)$ in terms of $K$, $M$, $a$, and $q$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a canonical exercise in solid-state physics, concerning the lattice dynamics of a one-dimensional monatomic chain.\n- **Scientifically Grounded:** The problem is based on fundamental principles of classical mechanics (Newton's second law, Hooke's law) and standard models of condensed matter physics (Bravais lattice, Born-von Karman conditions). It is scientifically sound.\n- **Well-Posed:** All necessary parameters ($M$, $K$, $a$) are provided. The objective is clearly defined, and the problem structure leads to a unique and meaningful solution for the dispersion relation $\\omega(q)$.\n- **Objective:** The problem is stated in precise, unambiguous scientific language.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. It is a standard, well-posed problem in introductory solid-state physics. A full solution will be provided.\n\nWe begin by modeling the one-dimensional lattice. The equilibrium position of the $n$-th atom is given by $x_n = na$, where $n$ is an integer. Let $u_n(t)$ be the displacement of the $n$-th atom from its equilibrium position. The analysis assumes small displacements, so Hooke's law applies.\n\nThe force exerted on the $n$-th atom is the sum of forces from its nearest neighbors, the atoms at positions $(n-1)$ and $(n+1)$.\nThe force from the atom at $(n+1)$ on the atom at $n$, denoted $F_{n \\leftarrow n+1}$, is due to the extension of the spring connecting them. The change in length of this spring is $(x_{n+1} + u_{n+1}) - (x_n + u_n) - a = (na+a+u_{n+1}) - (na+u_n) - a = u_{n+1} - u_n$. According to Hooke's law, this results in a restoring force on atom $n$ given by $F_{n \\leftarrow n+1} = K(u_{n+1} - u_n)$.\nSimilarly, the force from the atom at $(n-1)$ on the atom at $n$ is $F_{n \\leftarrow n-1}$. The extension of the spring between atoms $n$ and $(n-1)$ is $(x_n+u_n)-(x_{n-1}+u_{n-1})-a = u_n - u_{n-1}$. This results in a restoring force on atom $n$ given by $F_{n \\leftarrow n-1} = -K(u_n - u_{n-1})$.\n\nThe total force on the $n$-th atom is the sum of these two forces:\n$$F_n = F_{n \\leftarrow n+1} + F_{n \\leftarrow n-1} = K(u_{n+1} - u_n) - K(u_n - u_{n-1}) = K(u_{n+1} + u_{n-1} - 2u_n)$$\nAccording to Newton's second law, $F_n = M \\ddot{u}_n$, where $\\ddot{u}_n = \\frac{d^2u_n}{dt^2}$. This gives the equation of motion for the $n$-th atom:\n$$M \\ddot{u}_n(t) = K \\left( u_{n+1}(t) + u_{n-1}(t) - 2u_n(t) \\right)$$\nThis is the linear equation of motion for the displacement $u_n(t)$.\n\nDue to the translational symmetry of the lattice, we seek traveling wave solutions (normal modes) of the form:\n$$u_n(t) = A \\exp[i(q x_n - \\omega t)] = A \\exp[i(qna - \\omega t)]$$\nwhere $A$ is the amplitude, $q$ is the wave vector, and $\\omega$ is the angular frequency. Substituting this ansatz into the equation of motion requires the following terms:\n$$ \\ddot{u}_n(t) = (-i\\omega)^2 u_n(t) = -\\omega^2 u_n(t) $$\n$$ u_{n+1}(t) = A \\exp[i(q(n+1)a - \\omega t)] = u_n(t) \\exp(iqa) $$\n$$ u_{n-1}(t) = A \\exp[i(q(n-1)a - \\omega t)] = u_n(t) \\exp(-iqa) $$\nSubstituting these into the equation of motion yields:\n$$ M(-\\omega^2) u_n(t) = K \\left( u_n(t)\\exp(iqa) + u_n(t)\\exp(-iqa) - 2u_n(t) \\right) $$\nFor a non-trivial solution ($u_n(t) \\neq 0$), we can divide by $u_n(t)$:\n$$ -M\\omega^2 = K (\\exp(iqa) + \\exp(-iqa) - 2) $$\nUsing Euler's identity, $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, we have:\n$$ -M\\omega^2 = K(2\\cos(qa) - 2) = -2K(1 - \\cos(qa)) $$\n$$ M\\omega^2 = 2K(1 - \\cos(qa)) $$\nThis equation is the phonon dispersion relation. We can simplify it using the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$:\n$$ M\\omega^2(q) = 2K \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\nThis expression relates the angular frequency $\\omega$ to the wave vector $q$.\n\nThe problem also requires the construction of the dynamical matrix $D(q)$. The general form of the equations of motion in matrix form is $M\\omega^2 \\vec{u} = D(q) \\vec{u}$. For a monatomic basis, this becomes a scalar equation $M\\omega^2 = D(q)$. The dynamical matrix is the spatial Fourier transform of the interatomic force constants $\\Phi_{nn'}$. The equation of motion can be written as $M\\ddot{u}_n = -\\sum_{n'} \\Phi_{nn'} u_{n'}$. From our derived EOM, $M \\ddot{u}_n = K u_{n+1} + K u_{n-1} - 2K u_{n}$, we can identify the force constants:\n$$ \\Phi_{nn} = 2K $$\n$$ \\Phi_{n, n+1} = -K $$\n$$ \\Phi_{n, n-1} = -K $$\n$$ \\Phi_{nn'} = 0 \\quad \\text{for } |n-n'|  1 $$\nThe dynamical matrix (a scalar in this case) is given by:\n$$ D(q) = \\sum_{n'} \\Phi_{n, n'} \\exp[iq(x_{n'} - x_n)] $$\nDue to translational invariance, this sum is independent of $n$. Let $n=0$:\n$$ D(q) = \\sum_{n'} \\Phi_{0, n'} \\exp[iq x_{n'}] = \\Phi_{0,0} + \\Phi_{0,1}\\exp(iqa) + \\Phi_{0,-1}\\exp(-iqa) $$\n$$ D(q) = 2K - K\\exp(iqa) - K\\exp(-iqa) = 2K - K(\\exp(iqa) + \\exp(-iqa)) $$\n$$ D(q) = 2K - 2K\\cos(qa) = 2K(1 - \\cos(qa)) $$\nThe eigenvalue problem is $M\\omega^2(q) = D(q)$, which gives:\n$$ M\\omega^2(q) = 2K(1 - \\cos(qa)) = 4K \\sin^2\\left(\\frac{qa}{2}\\right) $$\nThis confirms the result obtained previously.\n\nSolving for $\\omega(q)$, we take the square root. Since frequency is a physically positive quantity, we take the positive root:\n$$ \\omega^2(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right) $$\n$$ \\omega(q) = \\sqrt{\\frac{4K}{M}} \\sqrt{\\sin^2\\left(\\frac{qa}{2}\\right)} = \\sqrt{\\frac{4K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\nThe absolute value is necessary because the wave vector $q$ belongs to the first Brillouin zone, $q \\in [-\\frac{\\pi}{a}, \\frac{\\pi}{a}]$, for which the argument of the sine function, $\\frac{qa}{2}$, ranges from $-\\frac{\\pi}{2}$ to $\\frac{\\pi}{2}$. In this interval, $\\sin(\\frac{qa}{2})$ can be negative, whereas $\\omega$ must be non-negative.\n\nThe final expression for the phonon angular frequency is:\n$$ \\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right| $$\nThis is the dispersion relation for the one-dimensional monatomic chain. It shows that for small $q$ (long wavelengths), $\\omega \\approx a\\sqrt{K/M}|q|$, which is a linear relationship characteristic of acoustic waves. At the boundary of the Brillouin zone, $q = \\pm \\frac{\\pi}{a}$, the frequency reaches its maximum value $\\omega_{max} = 2\\sqrt{\\frac{K}{M}}$.", "answer": "$$ \\boxed{2\\sqrt{\\frac{K}{M}} \\left|\\sin\\left(\\frac{qa}{2}\\right)\\right|} $$", "id": "2848415"}, {"introduction": "While the nearest-neighbor model provides a good first approximation, real materials exhibit more complex interactions. This practice [@problem_id:2848436] demonstrates how to refine the one-dimensional chain model by including next-nearest-neighbor interactions, which is often necessary to explain anomalies or specific features observed in experimental dispersion curves. You will derive the modified dispersion relation and, crucially, use mock experimental data to determine the relative strength of these longer-range forces, a common task in materials modeling.", "problem": "A monatomic cubic crystal is probed along the crystallographic direction $[100]$, and the acoustic branch exhibits a deviation from the simple sinusoidal shape expected from only nearest-neighbor harmonic interactions as the wave vector approaches the Brillouin zone boundary at the high-symmetry point $X$. To rationalize this anomaly, consider a one-dimensional monatomic chain model representing longitudinal phonons along $[100]$, with lattice spacing $a$, atomic mass $m$, and harmonic interactions up to next-nearest neighbors characterized by force constants $C_{1}$ (nearest neighbor) and $C_{2}$ (next-nearest neighbor). \n\nStarting only from Newton’s second law and the definition of the plane-wave normal mode $u_{n}(t)=u\\,\\exp(i k n a - i \\omega t)$ for the displacement of the $n$-th atom, derive the dispersion relation $\\omega(k)$ for this chain including both $C_{1}$ and $C_{2}$. Then use the experimentally observed ratio of frequencies\n$\\omega(k_{0})/\\omega(X)=0.96$ at $k_{0}=3\\pi/(4a)$ and $X=\\pi/a$ to eliminate the unknowns $m$ and $C_{1}$ and solve for the ratio $\\alpha=C_{2}/C_{1}$. \n\nProvide your final value of $\\alpha$ rounded to $3$ significant figures. The final answer is dimensionless and should be given as a pure number without units.", "solution": "The problem requires the derivation of the phonon dispersion relation for a one-dimensional monatomic chain with nearest and next-nearest neighbor interactions, and then the determination of the ratio of the force constants. The problem is well-posed and scientifically grounded. We proceed with the derivation from first principles.\n\nLet the equilibrium position of the $n$-th atom be $na$, where $a$ is the lattice spacing. Let $u_n$ be the longitudinal displacement of the $n$-th atom from its equilibrium position. In a harmonic approximation, the force exerted on an atom is linearly proportional to the relative displacement of its neighbors.\n\nThe force on the $n$-th atom due to its nearest neighbors at positions $(n-1)a$ and $(n+1)a$ is given by Hooke's law:\n$F_{n, \\text{nn}} = C_1(u_{n+1} - u_n) + C_1(u_{n-1} - u_n) = C_1(u_{n+1} + u_{n-1} - 2u_n)$, where $C_1$ is the nearest-neighbor force constant.\n\nThe force on the $n$-th atom due to its next-nearest neighbors at positions $(n-2)a$ and $(n+2)a$ is:\n$F_{n, \\text{nnn}} = C_2(u_{n+2} - u_n) + C_2(u_{n-2} - u_n) = C_2(u_{n+2} + u_{n-2} - 2u_n)$, where $C_2$ is the next-nearest-neighbor force constant.\n\nThe total force $F_n$ on the $n$-th atom is the sum of these contributions. According to Newton's second law, the equation of motion for the $n$-th atom of mass $m$ is $m \\ddot{u}_n = F_n$:\n$$m \\frac{d^2 u_n}{dt^2} = C_1(u_{n+1} + u_{n-1} - 2u_n) + C_2(u_{n+2} + u_{n-2} - 2u_n)$$\n\nWe seek plane-wave solutions, representing the normal modes of the chain, of the form given in the problem statement:\n$$u_n(t) = u \\exp(i(kna - \\omega t))$$\nwhere $k$ is the wave vector, $\\omega$ is the angular frequency, and $u$ is the amplitude. The displacements of the neighboring atoms are related by a phase factor:\n$u_{n\\pm p}(t) = u \\exp(i(k(n\\pm p)a - \\omega t)) = u_n(t) \\exp(\\pm ikpa)$.\nThe second time derivative is $\\ddot{u}_n = (-i\\omega)^2 u_n = -\\omega^2 u_n$.\n\nSubstituting these into the equation of motion:\n$$-\\omega^2 m u_n = C_1(u_n e^{ika} + u_n e^{-ika} - 2u_n) + C_2(u_n e^{i2ka} + u_n e^{-i2ka} - 2u_n)$$\nFor a non-trivial solution ($u_n \\neq 0$), we can divide by $u_n$:\n$$-\\omega^2 m = C_1(e^{ika} + e^{-ika} - 2) + C_2(e^{i2ka} + e^{-i2ka} - 2)$$\nUsing the Euler identity $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we get:\n$$-\\omega^2 m = C_1(2\\cos(ka) - 2) + C_2(2\\cos(2ka) - 2)$$\n$$\\omega^2 m = 2C_1(1 - \\cos(ka)) + 2C_2(1 - \\cos(2ka))$$\nEmploying the trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\\omega^2 m = 2C_1 \\left(2\\sin^2\\left(\\frac{ka}{2}\\right)\\right) + 2C_2 \\left(2\\sin^2\\left(\\frac{2ka}{2}\\right)\\right)$$\n$$\\omega^2 m = 4C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + 4C_2 \\sin^2(ka)$$\nThis gives the dispersion relation $\\omega(k)$:\n$$\\omega^2(k) = \\frac{4}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)$$\nTaking the positive square root for the frequency:\n$$\\omega(k) = 2 \\sqrt{\\frac{1}{m} \\left(C_1 \\sin^2\\left(\\frac{ka}{2}\\right) + C_2 \\sin^2(ka)\\right)}$$\nThis completes the first part of the problem.\n\nNext, we must determine the ratio $\\alpha = C_2/C_1$ using the provided experimental data. Let us rewrite $\\omega^2(k)$ in terms of $\\alpha$:\n$$\\omega^2(k) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{ka}{2}\\right) + \\alpha \\sin^2(ka)\\right)$$\nThe problem gives the ratio of frequencies at two specific wave vectors: $k_0 = 3\\pi/(4a)$ and the Brillouin zone boundary point $X$, where $k_X = \\pi/a$.\n\nFirst, we evaluate $\\omega^2(k)$ at $k_X = \\pi/a$:\n$$ka = \\pi \\implies \\frac{ka}{2} = \\frac{\\pi}{2}$$\n$$\\omega^2(X) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{\\pi}{2}\\right) + \\alpha \\sin^2(\\pi)\\right) = \\frac{4C_1}{m} \\left(1^2 + \\alpha \\cdot 0^2\\right) = \\frac{4C_1}{m}$$\n\nNext, we evaluate $\\omega^2(k)$ at $k_0 = 3\\pi/(4a)$:\n$$ka = \\frac{3\\pi}{4} \\implies \\frac{ka}{2} = \\frac{3\\pi}{8}$$\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\sin^2\\left(\\frac{3\\pi}{8}\\right) + \\alpha \\sin^2\\left(\\frac{3\\pi}{4}\\right)\\right)$$\nWe use the identities $\\sin^2(\\theta) = (1-\\cos(2\\theta))/2$ and $\\sin(3\\pi/4) = \\sqrt{2}/2$:\n$$\\sin^2\\left(\\frac{3\\pi}{8}\\right) = \\frac{1 - \\cos(3\\pi/4)}{2} = \\frac{1 - (-\\sqrt{2}/2)}{2} = \\frac{2+\\sqrt{2}}{4}$$\n$$\\sin^2\\left(\\frac{3\\pi}{4}\\right) = \\left(\\frac{\\sqrt{2}}{2}\\right)^2 = \\frac{2}{4} = \\frac{1}{2}$$\nSubstituting these into the expression for $\\omega^2(k_0)$:\n$$\\omega^2(k_0) = \\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\alpha \\frac{1}{2}\\right)$$\n\nNow we construct the ratio $\\omega^2(k_0)/\\omega^2(X)$:\n$$\\frac{\\omega^2(k_0)}{\\omega^2(X)} = \\frac{\\frac{4C_1}{m} \\left(\\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}\\right)}{\\frac{4C_1}{m}} = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\nThe problem provides the frequency ratio $\\omega(k_0)/\\omega(X) = 0.96$. Squaring this value gives the ratio of the squared frequencies:\n$$\\left(\\frac{\\omega(k_0)}{\\omega(X)}\\right)^2 = 0.96^2 = 0.9216$$\nWe can now form an equation for $\\alpha$:\n$$0.9216 = \\frac{2+\\sqrt{2}}{4} + \\frac{\\alpha}{2}$$\nSolving for $\\alpha$:\n$$\\frac{\\alpha}{2} = 0.9216 - \\frac{2+\\sqrt{2}}{4}$$\n$$\\alpha = 2 \\left(0.9216 - \\frac{2+\\sqrt{2}}{4}\\right) = 1.8432 - (1 + \\frac{\\sqrt{2}}{2}) = 0.8432 - \\frac{\\sqrt{2}}{2}$$\nTo obtain the numerical value, we use $\\sqrt{2} \\approx 1.41421356$:\n$$\\alpha \\approx 0.8432 - \\frac{1.41421356}{2} = 0.8432 - 0.70710678 = 0.13609322$$\nThe problem requires the value rounded to $3$ significant figures.\n$$\\alpha \\approx 0.136$$\nThis positive value for $\\alpha$ signifies that the next-nearest neighbor interaction is also a restoring force, which is physically expected for a stable crystal lattice.", "answer": "$$\\boxed{0.136}$$", "id": "2848436"}, {"introduction": "Translating a crystal as a whole requires no energy, a principle that manifests as the Acoustic Sum Rule (ASR) in lattice dynamics calculations. This computational exercise [@problem_id:2848329] addresses the practical consequences of violating this rule, which often occurs due to numerical limitations in real-world simulations, leading to unphysical frequency gaps for acoustic modes at the Brillouin zone center. By implementing a correction scheme, you will gain hands-on experience with enforcing fundamental physical symmetries in a computational setting, a vital skill for producing reliable simulation results.", "problem": "Write a complete program that, starting from the harmonic lattice-dynamical equations and the definition of the dynamical matrix, quantifies the effect of violating the acoustic sum rule on the low-wave-vector behavior of acoustic branches by computing spurious gaps at the Brillouin-zone center and applying a correction that enforces translational invariance.\n\nUse the following fundamental base. In the harmonic approximation, the equation of motion for small displacements is Newton's second law, $M \\,\\ddot{\\mathbf{u}} = -\\Phi \\,\\mathbf{u}$, where $M$ is the diagonal mass matrix and $\\Phi$ is the force-constant matrix. A plane-wave ansatz $\\mathbf{u}_{\\kappa}(n,t) = \\boldsymbol{\\epsilon}_{\\kappa} \\,\\mathrm{e}^{\\mathrm{i}(q R_{n} - \\omega t)}$ leads to the eigenproblem for the dynamical matrix $D(q)$,\n$$\nD_{\\kappa\\kappa'}(q)\\,\\boldsymbol{\\epsilon}_{\\kappa'} = \\omega^{2}(q)\\,\\boldsymbol{\\epsilon}_{\\kappa},\n$$\nwith\n$$\nD_{\\kappa\\kappa'}(q) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\\,\\mathrm{e}^{\\mathrm{i} q R},\n$$\nwhere $m_{\\kappa}$ is the mass of atom $\\kappa$ in the reference unit cell, $\\Phi_{\\kappa\\kappa'}(R)$ are real-space force-constant blocks coupling atom $\\kappa$ in the reference cell to atom $\\kappa'$ in the cell displaced by lattice vector $R$, and $q$ is the crystal wave vector (angles in radians). Translational invariance implies the acoustic sum rule, $\\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R) = 0$ for every $\\kappa$. If this rule is not satisfied, a uniform translation is not a zero-energy mode, and an unphysical nonzero acoustic frequency appears at the Brillouin-zone center $\\Gamma$ ($q=0$).\n\nYour program must do the following for each provided test case:\n1. Construct $D(q)$ at the Brillouin-zone center $q=0$ using the given real-space force constants and masses. In all cases, take the one-dimensional lattice constant as $a = 1$, so that $R \\in \\{ \\ldots, -2, -1, 0, 1, 2, \\ldots \\}$ is expressed in multiples of $a$, and angles are in radians.\n2. Compute the smallest eigenvalue $\\lambda_{\\min}$ of $D(0)$, which corresponds to the acoustic branch. Define the spurious acoustic gap at $\\Gamma$ as $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$.\n3. Apply an acoustic sum rule correction in real space by modifying, for each atom $\\kappa$, the onsite block as\n$$\n\\Phi_{\\kappa\\kappa}(0) \\leftarrow \\Phi_{\\kappa\\kappa}(0) - \\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R),\n$$\nleaving all offsite blocks unchanged. This imposes $\\sum_{\\kappa',R} \\Phi_{\\kappa\\kappa'}(R) = 0$ exactly for each atom $\\kappa$.\n4. Recompute $D(0)$ and the corrected spurious gap $\\omega_{\\Gamma}^{(\\mathrm{corr})}$.\n5. Report, for each test case, the pair of values $\\left[\\omega_{\\Gamma}, \\omega_{\\Gamma}^{(\\mathrm{corr})}\\right]$.\n\nUse nondimensionalized units where the reference mass and stiffness are $m_{0}=1$ and $K_{0}=1$, so that angular frequencies are expressed in the natural unit $\\sqrt{K_{0}/m_{0}}$. Report all angular frequency outputs in this nondimensional unit, rounded to six decimals.\n\nImplement the following test suite. In every case, only scalar displacements along the chain are considered (one degree of freedom per atom).\n\nTest case A (monatomic chain, acoustic sum rule satisfied):\n- Number of atoms in the unit cell: $N=1$ with mass $m_{1}=1$.\n- Nearest-neighbor spring stiffness $K=1$.\n- Nonzero real-space force constants:\n  - $\\Phi_{11}(0) = 2$,\n  - $\\Phi_{11}(+1) = -1$,\n  - $\\Phi_{11}(-1) = -1$.\n- Expected physical behavior: exact translational invariance and zero acoustic gap.\n\nTest case B (monatomic chain, acoustic sum rule violated):\n- Number of atoms in the unit cell: $N=1$ with mass $m_{1}=1$.\n- Nearest-neighbor spring stiffness $K=1$ with a small onsite perturbation $\\varepsilon = 0.02$ that violates the sum rule.\n- Nonzero real-space force constants:\n  - $\\Phi_{11}(0) = 2 + 0.02$,\n  - $\\Phi_{11}(+1) = -1$,\n  - $\\Phi_{11}(-1) = -1$.\n- Expected physical behavior: nonzero spurious gap at $\\Gamma$ that vanishes after correction.\n\nTest case C (diatomic chain, mixed masses, acoustic sum rule violated):\n- Number of atoms in the unit cell: $N=2$ with masses $m_{1}=1$ and $m_{2}=2$.\n- Nearest-neighbor spring stiffness $K=1$ with small onsite perturbations $\\varepsilon_{1} = 0.01$ and $\\varepsilon_{2} = -0.005$.\n- Nonzero real-space force constants:\n  - Onsite: $\\Phi_{11}(0) = 2 + 0.01$, $\\Phi_{22}(0) = 2 - 0.005$,\n  - Inter-sublattice within the same cell: $\\Phi_{12}(0) = -1$, $\\Phi_{21}(0) = -1$,\n  - Inter-sublattice to neighboring cells: $\\Phi_{12}(-1) = -1$, $\\Phi_{21}(+1) = -1$.\n- All other $\\Phi_{\\kappa\\kappa'}(R)$ are zero.\n- Expected physical behavior: nonzero spurious gap at $\\Gamma$ that vanishes after correction.\n\nFinal output format:\n- Your program should produce a single line of output containing the six results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[\\omega_{\\Gamma}^{(A)},\\,\\omega_{\\Gamma}^{(A,\\mathrm{corr})},\\,\\omega_{\\Gamma}^{(B)},\\,\\omega_{\\Gamma}^{(B,\\mathrm{corr})},\\,\\omega_{\\Gamma}^{(C)},\\,\\omega_{\\Gamma}^{(C,\\mathrm{corr})}\\big],\n$$\nrounded to six decimals, in the nondimensional unit $\\sqrt{K_{0}/m_{0}}$. For example: \"[0.000000,0.000000,0.141421,0.000000,0.040693,0.000000]\".", "solution": "The problem posed is a standard exercise in lattice dynamics and is thus deemed valid. It is scientifically grounded in the principles of solid-state physics, is well-posed with all necessary information provided, and is stated in an objective, formal language. We shall proceed with the solution.\n\nThe central task is to analyze the effect of violating the acoustic sum rule (ASR) on the phonon frequencies at the Brillouin-zone center ($\\Gamma$-point, wave vector $q=0$). Translational invariance of the crystal lattice dictates that a uniform displacement of all atoms must be a zero-energy mode, corresponding to a zero-frequency acoustic phonon branch at $q=0$. This physical requirement is mathematically encoded in the ASR.\n\nThe starting point is the eigenvalue equation for the dynamical matrix, $D(q)$:\n$$\n\\sum_{\\kappa'} D_{\\kappa\\kappa'}(q)\\,\\epsilon_{\\kappa'}^{\\nu} = \\omega_{\\nu}^{2}(q)\\,\\epsilon_{\\kappa}^{\\nu}\n$$\nwhere $\\omega_{\\nu}(q)$ and $\\boldsymbol{\\epsilon}^{\\nu}$ are the frequency and polarization vector of the phonon mode $(\\nu, q)$, respectively. The dynamical matrix is defined in terms of the real-space interatomic force constants $\\Phi_{\\kappa\\kappa'}(R)$ and atomic masses $m_{\\kappa}$ as:\n$$\nD_{\\kappa\\kappa'}(q) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\\,\\mathrm{e}^{\\mathrm{i} q R}\n$$\nHere, $\\kappa$ and $\\kappa'$ index the atoms within a unit cell, and $R$ is a lattice vector.\n\nAt the Brillouin-zone center ($q=0$), the exponential factor becomes unity, and the dynamical matrix simplifies to:\n$$\nD_{\\kappa\\kappa'}(0) = \\frac{1}{\\sqrt{m_{\\kappa} m_{\\kappa'}}} \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)\n$$\n\nThe acoustic sum rule arises from the condition that no net force should act on any atom if the entire crystal is translated by a uniform vector. This implies that for each atom $\\kappa$, the sum of all forces exerted on it by all other atoms in the crystal must be zero. This leads to the condition:\n$$\n\\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) = 0 \\quad \\text{for each } \\kappa\n$$\nIf this rule is satisfied, it can be shown that one of the eigenvectors of $D(0)$ is proportional to $(\\sqrt{m_1}, \\sqrt{m_2}, \\dots, \\sqrt{m_N})$, and its corresponding eigenvalue is zero, ensuring that $\\omega(q=0) = 0$ for the three acoustic branches.\n\nIn numerical calculations, particularly when force constants are derived from finite-range models or ab-initio calculations, small numerical errors can lead to a violation of the ASR.\n$$\n\\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) = \\Delta_{\\kappa} \\neq 0\n$$\nThis violation, $\\Delta_{\\kappa}$, results in a non-zero eigenvalue for the acoustic mode at $q=0$, creating an unphysical \"gap\" in the acoustic spectrum. The spurious frequency is given by $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$, where $\\lambda_{\\min}$ is the smallest eigenvalue of $D(0)$.\n\nTo rectify this, the ASR must be enforced. A common correction scheme modifies the on-site force constants $\\Phi_{\\kappa\\kappa}(0)$ as follows:\n$$\n\\Phi'_{\\kappa\\kappa}(0) = \\Phi_{\\kappa\\kappa}(0) - \\Delta_{\\kappa} = \\Phi_{\\kappa\\kappa}(0) - \\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R)\n$$\nAll other force constants ($\\kappa \\neq \\kappa'$ or $R \\neq 0$) are left unchanged. By construction, the new set of force constants $\\Phi'$ now satisfies the ASR for each $\\kappa$:\n$$\n\\sum_{\\kappa', R} \\Phi'_{\\kappa\\kappa'}(R) = \\sum_{\\kappa', R} \\Phi_{\\kappa\\kappa'}(R) - \\Delta_{\\kappa} = \\Delta_{\\kappa} - \\Delta_{\\kappa} = 0\n$$\nRecomputing the dynamical matrix $D'(0)$ with these corrected force constants will yield a zero eigenvalue for the acoustic mode, thus eliminating the spurious gap.\n\nThe procedure for each test case is as follows:\n1.  Construct the $N \\times N$ matrix $S$ with elements $S_{\\kappa\\kappa'} = \\sum_{R} \\Phi_{\\kappa\\kappa'}(R)$, where $N$ is the number of atoms in the unit cell. The indices $\\kappa, \\kappa'$ will be mapped from $1, \\dots, N$ to $0, \\dots, N-1$ for computation.\n2.  Construct the uncorrected dynamical matrix $D(0)$ with elements $D_{\\kappa\\kappa'}(0) = S_{\\kappa\\kappa'} / \\sqrt{m_{\\kappa} m_{\\kappa'}}$.\n3.  Calculate the eigenvalues of the Hermitian matrix $D(0)$ and find the minimum eigenvalue $\\lambda_{\\min}$. The initial spurious gap is $\\omega_{\\Gamma} = \\sqrt{\\max(\\lambda_{\\min}, 0)}$.\n4.  For each atom $\\kappa$, compute the ASR violation $\\Delta_{\\kappa} = \\sum_{\\kappa'} S_{\\kappa\\kappa'}$.\n5.  Construct the corrected matrix $S'$ by modifying the diagonal elements of $S$: $S'_{\\kappa\\kappa} = S_{\\kappa\\kappa} - \\Delta_{\\kappa}$.\n6.  Construct the corrected dynamical matrix $D'(0)$ with elements $D'_{\\kappa\\kappa'}(0) = S'_{\\kappa\\kappa'} / \\sqrt{m_{\\kappa} m_{\\kappa'}}$.\n7.  Calculate the eigenvalues of $D'(0)$ to find the corrected minimum eigenvalue $\\lambda'_{\\min}$ and the corrected gap $\\omega_{\\Gamma}^{(\\mathrm{corr})} = \\sqrt{\\max(\\lambda'_{\\min}, 0)}$, which is expected to be zero.\n\nAll calculations are performed using nondimensionalized units where $m_0=1$ and $K_0=1$. The one-dimensional lattice constant is $a=1$. The final frequencies are reported in units of $\\sqrt{K_0/m_0}$.\n\nFor Test Case A (monatomic, ASR satisfied), we have $N=1$ and $m_1=1$. The sum of force constants is $\\sum_R \\Phi_{11}(R) = 2 - 1 - 1 = 0$. This immediately gives $D_{11}(0)=0$, so $\\omega_{\\Gamma}=0$. The correction term $\\Delta_1$ is also $0$, so the corrected gap remains $0$.\n\nFor Test Case B (monatomic, ASR violated), $N=1$ and $m_1=1$. The sum is $\\sum_R \\Phi_{11}(R) = 2.02 - 1 - 1 = 0.02$. Thus, $D_{11}(0)=0.02$, and $\\omega_{\\Gamma}=\\sqrt{0.02}$. The correction is $\\Delta_1=0.02$, leading to a corrected $\\Phi'_{11}(0) = 2.02 - 0.02 = 2$. The corrected sum is $0$, yielding $\\omega_{\\Gamma}^{(\\mathrm{corr})}=0$.\n\nFor Test Case C (diatomic, ASR violated), $N=2$ with $m_1=1, m_2=2$. The matrix of sums $S_{\\kappa\\kappa'}$ is first computed. The violations $\\Delta_1 = \\sum_{\\kappa'} S_{1\\kappa'}$ and $\\Delta_2 = \\sum_{\\kappa'} S_{2\\kappa'}$ are non-zero. The eigenvalues of the resulting $2 \\times 2$ matrix $D(0)$ produce a non-zero $\\omega_{\\Gamma}$. After applying the corrections to $S_{11}$ and $S_{22}$, the recomputed matrix $D'(0)$ will have a zero eigenvalue, giving $\\omega_{\\Gamma}^{(\\mathrm{corr})}=0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating and correcting spurious acoustic gaps\n    at the Gamma point due to acoustic sum rule violations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            # Test case A (monatomic chain, acoustic sum rule satisfied)\n            \"name\": \"A\",\n            \"masses\": np.array([1.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.0,\n                (1, 1, 1): -1.0,\n                (1, 1, -1): -1.0,\n            }\n        },\n        {\n            # Test case B (monatomic chain, acoustic sum rule violated)\n            \"name\": \"B\",\n            \"masses\": np.array([1.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.02,\n                (1, 1, 1): -1.0,\n                (1, 1, -1): -1.0,\n            }\n        },\n        {\n            # Test case C (diatomic chain, mixed masses, ASR violated)\n            \"name\": \"C\",\n            \"masses\": np.array([1.0, 2.0]),\n            \"force_constants\": {\n                (1, 1, 0): 2.01,\n                (2, 2, 0): 1.995,\n                (1, 2, 0): -1.0,\n                (2, 1, 0): -1.0,\n                (1, 2, -1): -1.0,\n                (2, 1, 1): -1.0,\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        masses = case[\"masses\"]\n        fc_dict = case[\"force_constants\"]\n        num_atoms = len(masses)\n\n        # Step 1: Compute S_k_kp = sum_R Phi_k_kp(R)\n        sum_phi = np.zeros((num_atoms, num_atoms))\n        for (k1, k2, R), value in fc_dict.items():\n            # Convert 1-based atom indices to 0-based array indices\n            sum_phi[k1 - 1, k2 - 1] += value\n\n        # Step 2: Compute the uncorrected dynamical matrix D(0) and the spurious gap\n        \n        # Function to compute gap from a sum_phi matrix\n        def compute_gap(s_phi, m):\n            n_atoms = len(m)\n            d0 = np.zeros((n_atoms, n_atoms))\n            for i in range(n_atoms):\n                for j in range(n_atoms):\n                    d0[i, j] = s_phi[i, j] / np.sqrt(m[i] * m[j])\n            \n            # The dynamical matrix at q=0 is real and symmetric, use eigvalsh\n            eigenvalues = np.linalg.eigvalsh(d0)\n            min_eigenvalue = np.min(eigenvalues)\n            \n            # The problem defines the gap from the smallest eigenvalue\n            # guarding against small negative numerical noise becoming NaN\n            gap = np.sqrt(max(0, min_eigenvalue))\n            return gap\n\n        omega_gamma = compute_gap(sum_phi, masses)\n        results.append(omega_gamma)\n\n        # Step 3: Apply acoustic sum rule correction\n        sum_phi_corr = sum_phi.copy()\n        for k in range(num_atoms):\n            # ASR violation for atom k is the sum over its row in sum_phi\n            asr_violation = np.sum(sum_phi[k, :])\n            # The correction is applied to the on-site sum_phi element\n            sum_phi_corr[k, k] -= asr_violation\n\n        # Step 4: Recompute the gap with the corrected force constants\n        omega_gamma_corr = compute_gap(sum_phi_corr, masses)\n        results.append(omega_gamma_corr)\n\n    # Final print statement in the exact required format.\n    # Format each result to six decimal places.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2848329"}]}