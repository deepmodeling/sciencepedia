{"hands_on_practices": [{"introduction": "Understanding macroscopic transport properties begins with a firm grasp of microscopic scattering processes. This first practice establishes that crucial link by guiding you through the derivation of the transport relaxation rate, $1/\\tau_{\\mathrm{tr}}$, from first principles. Starting with Fermi's golden rule for a canonical model of screened impurity scattering, you will see how the momentum-degrading factor $(1-\\cos\\theta)$ naturally arises and proves essential for correctly quantifying how collisions relax an electrical current [@problem_id:2803304].", "problem": "Consider an isotropic, parabolic-band electron gas in a crystalline solid with dispersion $\\,\\varepsilon_{\\mathbf{k}} = \\hbar^{2} k^{2} / (2m)\\,$ and a spherical Fermi surface of radius $\\,k_{F}\\,$ at zero temperature. Elastic scattering is caused by a dilute concentration $\\,n_{i}\\,$ of static ionized impurities of charge $\\,Z e\\,$. In the Born approximation, the transition probability between wavevectors $\\,\\mathbf{k}\\,$ and $\\,\\mathbf{k}'\\,$ is modeled by\n$$\nW_{\\mathbf{k}\\mathbf{k}'} \\;=\\; \\frac{2\\pi}{\\hbar}\\,n_{i}\\,\\big|V(\\mathbf{k}-\\mathbf{k}')\\big|^{2}\\,\\delta\\!\\big(\\varepsilon_{\\mathbf{k}}-\\varepsilon_{\\mathbf{k}'}\\big),\n$$\nwhere the impurity potential is statically screened (Thomas–Fermi screening) with Fourier transform\n$$\nV(\\mathbf{q}) \\;=\\; \\frac{4\\pi Z e^{2}}{\\varepsilon\\,(q^{2}+\\kappa^{2})},\n$$\nwith $\\,\\varepsilon\\,$ the background dielectric constant and $\\,\\kappa\\,$ the screening wavevector. Starting from the steady-state, spatially uniform Boltzmann Transport Equation (BTE) and Fermi’s golden rule, and using the definition of the transport relaxation rate that includes the momentum-degrading factor $\\,\\big(1-\\cos\\theta\\big)\\,$ (where $\\,\\theta\\,$ is the scattering angle between $\\,\\mathbf{k}\\,$ and $\\,\\mathbf{k}'\\,$), derive the exact closed-form expression for the impurity-limited transport relaxation rate $\\,1/\\tau_{\\mathrm{tr}}(k_{F})\\,$ on the Fermi surface in three spatial dimensions. Express your final answer as a single analytic expression in terms of $\\,m\\,$, $\\,\\hbar\\,$, $\\,k_{F}\\,$, $\\,n_{i}\\,$, $\\,Z\\,$, $\\,e\\,$, $\\,\\varepsilon\\,$, and $\\,\\kappa\\,$. Do not substitute numerical values. The final result must be given as one closed-form expression. No rounding is required.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It represents a standard, canonical problem in condensed matter physics concerning electron transport theory. All provided information is sufficient, consistent, and free from any scientific or logical flaws. Therefore, a solution will be provided.\n\nThe objective is to derive the transport relaxation rate, $1/\\tau_{\\mathrm{tr}}$, for electrons on the Fermi surface. This rate is defined as the total probability of scattering from a state $\\mathbf{k}$ to any other state $\\mathbf{k}'$, weighted by the factor $(1-\\cos\\theta)$, which accounts for the degradation of momentum along the initial direction. Here, $\\theta$ is the angle between the initial wavevector $\\mathbf{k}$ and the final wavevector $\\mathbf{k}'$. The definition is given by\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\sum_{\\mathbf{k}'} W_{\\mathbf{k}\\mathbf{k}'} (1 - \\cos\\theta)\n$$\nwhere $W_{\\mathbf{k}\\mathbf{k}'}$ is the transition probability per unit time from state $\\mathbf{k}$ to $\\mathbf{k}'$. In the thermodynamic limit, the sum over discrete states $\\mathbf{k}'$ is replaced by an integral over $\\mathbf{k}'$-space, with the density of states per unit volume being $1/(2\\pi)^3$.\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\int \\frac{d^3k'}{(2\\pi)^3} W_{\\mathbf{k}\\mathbf{k}'} (1 - \\cos\\theta)\n$$\nWe are given the transition probability from Fermi's golden rule under the Born approximation:\n$$\nW_{\\mathbf{k}\\mathbf{k}'} = \\frac{2\\pi}{\\hbar} n_{i} |V(\\mathbf{k}-\\mathbf{k}')|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'})\n$$\nSubstituting this into the expression for the relaxation rate yields:\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\int \\frac{d^3k'}{(2\\pi)^3} \\frac{2\\pi n_{i}}{\\hbar} |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta),\n$$\nwhere the momentum transfer is $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}'$. Simplifying the constant prefactor gives:\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{n_{i}}{4\\pi^2 \\hbar} \\int d^3k' |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta)\n$$\nTo evaluate the integral, we use spherical coordinates for $\\mathbf{k}'$, with the polar axis chosen along the direction of $\\mathbf{k}$. Thus, $d^3k' = k'^2 dk' d\\Omega = k'^2 \\sin\\theta dk' d\\theta d\\phi$. The angle $\\theta$ in the volume element is the same as the scattering angle. The integral over the azimuthal angle $\\phi$ from $0$ to $2\\pi$ gives a factor of $2\\pi$ due to cylindrical symmetry of the integrand.\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{2\\pi n_{i}}{4\\pi^2 \\hbar} \\int_0^\\infty k'^2 dk' \\int_0^\\pi \\sin\\theta d\\theta \\, |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta)\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(\\mathbf{k})} = \\frac{n_{i}}{2\\pi \\hbar} \\int_0^\\infty k'^2 dk' \\int_0^\\pi |V(\\mathbf{q})|^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\nThe Dirac delta function enforces energy conservation. For a parabolic band $\\varepsilon_k = \\hbar^2 k^2 / (2m)$, the argument of the delta function is $\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'} = \\frac{\\hbar^2}{2m}(k^2 - k'^2)$. We use the property $\\delta(g(x)) = \\sum_{i} \\frac{\\delta(x-x_i)}{|g'(x_i)|}$. Here, $g(k') = \\frac{\\hbar^2}{2m}(k^2 - k'^2)$, whose root for $k' > 0$ is $k'=k$. The derivative is $g'(k') = -\\frac{\\hbar^2 k'}{m}$, so $|g'(k)| = \\frac{\\hbar^2 k}{m}$. Thus,\n$$\n\\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) = \\frac{m}{\\hbar^2 k} \\delta(k' - k)\n$$\nSubstituting this into our integral allows us to perform the integration over $k'$:\n$$\n\\int_0^\\infty k'^2 \\delta(\\varepsilon_{\\mathbf{k}} - \\varepsilon_{\\mathbf{k}'}) dk' = \\int_0^\\infty k'^2 \\frac{m}{\\hbar^2 k} \\delta(k' - k) dk' = k^2 \\frac{m}{\\hbar^2 k} = \\frac{mk}{\\hbar^2}\n$$\nThe relaxation rate expression now becomes an integral over the scattering angle $\\theta$ only:\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i}}{2\\pi \\hbar} \\left( \\frac{mk}{\\hbar^2} \\right) \\int_0^\\pi |V(\\mathbf{q})|^2 (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i} m k}{2\\pi \\hbar^3} \\int_0^\\pi |V(\\mathbf{q})|^2 (1 - \\cos\\theta) \\sin\\theta d\\theta\n$$\nThe squared magnitude of the momentum transfer is $q^2 = |\\mathbf{k} - \\mathbf{k}'|^2 = k^2 + k'^2 - 2\\mathbf{k}\\cdot\\mathbf{k}'$. Since scattering is elastic, $k'=k$, so $q^2 = 2k^2(1 - \\cos\\theta)$.\nThe Fourier transform of the screened potential is $V(q) = \\frac{4\\pi Z e^2}{\\varepsilon (q^2 + \\kappa^2)}$. Its square is:\n$$\n|V(\\mathbf{q})|^2 = \\left( \\frac{4\\pi Z e^2}{\\varepsilon} \\right)^2 \\frac{1}{(q^2 + \\kappa^2)^2} = \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} \\frac{1}{(2k^2(1 - \\cos\\theta) + \\kappa^2)^2}\n$$\nSubstituting this into the integral for the relaxation rate:\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{n_{i} m k}{2\\pi \\hbar^3} \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} \\int_0^\\pi \\frac{(1 - \\cos\\theta)\\sin\\theta}{(2k^2(1 - \\cos\\theta) + \\kappa^2)^2} d\\theta\n$$\nLet us evaluate the integral. We perform a change of variable to $x = 1 - \\cos\\theta$. Then $dx = \\sin\\theta d\\theta$. The limits of integration change from $\\theta \\in [0, \\pi]$ to $x \\in [0, 2]$.\n$$\nI = \\int_0^2 \\frac{x}{(2k^2 x + \\kappa^2)^2} dx\n$$\nThis integral can be solved using a further substitution $y = 2k^2 x + \\kappa^2$, which implies $dy = 2k^2 dx$ and $x = (y-\\kappa^2)/(2k^2)$. The limits become $y \\in [\\kappa^2, 4k^2 + \\kappa^2]$.\n$$\nI = \\int_{\\kappa^2}^{4k^2+\\kappa^2} \\frac{(y-\\kappa^2)/(2k^2)}{y^2} \\frac{dy}{2k^2} = \\frac{1}{4k^4} \\int_{\\kappa^2}^{4k^2+\\kappa^2} \\left( \\frac{1}{y} - \\frac{\\kappa^2}{y^2} \\right) dy\n$$\n$$\nI = \\frac{1}{4k^4} \\left[ \\ln|y| + \\frac{\\kappa^2}{y} \\right]_{\\kappa^2}^{4k^2+\\kappa^2} = \\frac{1}{4k^4} \\left\\{ \\left( \\ln(4k^2+\\kappa^2) + \\frac{\\kappa^2}{4k^2+\\kappa^2} \\right) - \\left( \\ln(\\kappa^2) + \\frac{\\kappa^2}{\\kappa^2} \\right) \\right\\}\n$$\n$$\nI = \\frac{1}{4k^4} \\left\\{ \\ln\\left(\\frac{4k^2+\\kappa^2}{\\kappa^2}\\right) + \\frac{\\kappa^2 - (4k^2+\\kappa^2)}{4k^2+\\kappa^2} \\right\\} = \\frac{1}{4k^4} \\left\\{ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right\\}\n$$\nNow, we combine all the pieces. The prefactor is $\\frac{n_{i} m k}{2\\pi \\hbar^3} \\frac{16\\pi^2 Z^2 e^4}{\\varepsilon^2} = \\frac{8\\pi n_{i} m k Z^2 e^4}{\\hbar^3 \\varepsilon^2}$.\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{8\\pi n_{i} m k Z^2 e^4}{\\hbar^3 \\varepsilon^2} \\times \\frac{1}{4k^4} \\left[ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right]\n$$\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k)} = \\frac{2\\pi n_{i} m Z^2 e^4}{\\hbar^3 \\varepsilon^2 k^3} \\left[ \\ln\\left(1 + \\frac{4k^2}{\\kappa^2}\\right) - \\frac{4k^2}{4k^2+\\kappa^2} \\right]\n$$\nThe problem asks for the rate on the Fermi surface, so we evaluate this expression at $k = k_F$:\n$$\n\\frac{1}{\\tau_{\\mathrm{tr}}(k_F)} = \\frac{2\\pi n_{i} m Z^2 e^4}{\\hbar^3 \\varepsilon^2 k_F^3} \\left[ \\ln\\left(1 + \\frac{4k_F^2}{\\kappa^2}\\right) - \\frac{4k_F^2}{4k_F^2+\\kappa^2} \\right]\n$$\nThis is the final closed-form expression for the impurity-limited transport relaxation rate on the Fermi surface, commonly known as the Brooks-Herring formula.", "answer": "$$\n\\boxed{\\frac{2 \\pi n_{i} m Z^{2} e^{4}}{\\hbar^{3} \\varepsilon^{2} k_{F}^{3}} \\left[ \\ln\\left(1 + \\frac{4 k_{F}^{2}}{\\kappa^{2}}\\right) - \\frac{4 k_{F}^{2}}{4 k_{F}^{2} + \\kappa^{2}} \\right]}\n$$", "id": "2803304"}, {"introduction": "The relaxation time approximation (RTA) is a cornerstone of transport theory, but its assumptions can obscure important physics. This exercise challenges you to move beyond the RTA by solving the Boltzmann Transport Equation as an integral equation for a system with anisotropic, forward-peaked scattering. By contrasting the full solution with the RTA prediction [@problem_id:2803361], you will develop a much deeper intuition for why the collision integral is not a simple decay process and how its structure determines the true transport coefficients.", "problem": "Consider a three-dimensional crystal with a single isotropic parabolic band with energy dispersion $\\varepsilon_{\\mathbf{k}} = \\hbar^{2} k^{2} / (2 m^{\\ast})$. The system is at low temperature so that only electronic states at the Fermi energy contribute to transport, and a uniform, static electric field $\\mathbf{E} = E \\hat{\\mathbf{z}}$ is applied. Assume elastic, spinless scattering by static disorder that is statistically isotropic in space, so that the differential scattering rate per unit solid angle from a state with direction $\\hat{\\mathbf{k}}$ to $\\hat{\\mathbf{k}}'$ depends only on the scattering angle $\\gamma$ between them.\n\nAdopt the following forward-peaked toy model for the differential scattering kernel:\n$$\nW(\\gamma) \\equiv W(\\cos\\gamma) \\;=\\; A \\,\\frac{1 - g^{2}}{\\left(1 + g^{2} - 2 g \\cos\\gamma\\right)^{3/2}},\n$$\nwhere $A > 0$ is a constant with units of rate per solid angle and $0 \\le g < 1$ controls the forward-peaked character (larger $g$ is more forward-peaked).\n\nWork in the steady-state, spatially uniform, linear-response regime and linearize the Boltzmann transport equation about the Fermi-Dirac equilibrium $f_{0}(\\varepsilon)$. Denote the nonequilibrium correction by $f_{1}(\\mathbf{k})$, with $|f_{1}| \\ll 1$. Do not assume any a priori relaxation time form for the collision integral.\n\nUsing only the structure of the linearized collision operator for elastic, angle-dependent scattering on a spherical Fermi surface, and without invoking any shortcut transport formulas, carry out the following steps:\n\n1. Derive the scalar integral equation governing the angular dependence of $f_{1}(\\hat{\\mathbf{k}})$ on the Fermi surface. Show that for an electric field along $\\hat{\\mathbf{z}}$, the solution can be taken proportional to $\\cos\\theta$, where $\\theta$ is the polar angle of $\\hat{\\mathbf{k}}$ with respect to $\\hat{\\mathbf{z}}$, and identify the corresponding eigenvalue of the collision operator as an angular integral over $W(\\gamma)$.\n\n2. Define the exact conductivity $\\sigma_{\\mathrm{full}}$ (along $\\hat{\\mathbf{z}}$) obtained from this full-scattering solution and the conductivity $\\sigma_{\\mathrm{RTA}}$ obtained by the relaxation-time approximation that replaces the collision operator by $-f_{1}(\\hat{\\mathbf{k}})/\\tau_{0}$ with $1/\\tau_{0} \\equiv \\int d\\Omega' \\, W(\\gamma)$, where $d\\Omega'$ is the solid-angle element for $\\hat{\\mathbf{k}}'$ and $\\gamma$ is the angle between $\\hat{\\mathbf{k}}$ and $\\hat{\\mathbf{k}}'$. Express the ratio $R(g) \\equiv \\sigma_{\\mathrm{full}}/\\sigma_{\\mathrm{RTA}}$ purely in terms of angular integrals over $W(\\gamma)$.\n\n3. For the given $W(\\gamma)$, evaluate these angular integrals exactly and obtain a closed-form expression for $R(g)$ as a function of $g$.\n\nYour final answer must be a single simplified analytic expression for $R(g)$ in terms of $g$ only, with no numerical evaluation required and no units. You may assume that any common prefactors depending on band parameters and on $A$ cancel in the ratio.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, and self-contained. Therefore, a full solution is provided.\n\nThe steady-state, spatially uniform Boltzmann Transport Equation (BTE) is given by\n$$\n\\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{field}} + \\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{coll}} = 0\n$$\nThe field term for a uniform electric field $\\mathbf{E}$ is $\\left(\\frac{\\partial f}{\\partial t}\\right)_{\\text{field}} = -\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f$.\nThe distribution function is linearized as $f(\\mathbf{k}) = f_{0}(\\varepsilon_{\\mathbf{k}}) + f_{1}(\\mathbf{k})$, where $f_0$ is the equilibrium Fermi-Dirac distribution and $f_1$ is the non-equilibrium correction.\nThe field term is linearized by approximating $f \\approx f_0$:\n$$\n-\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f_0 = -\\frac{e\\mathbf{E}}{\\hbar} \\cdot (\\nabla_{\\mathbf{k}} \\varepsilon_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon} = -e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon}\n$$\nFor elastic scattering on a spherical Fermi surface, the linearized collision operator acting on $f_1$ is\n$$\n\\left(\\frac{\\partial f_1}{\\partial t}\\right)_{\\text{coll}} = \\int d\\Omega' \\, W(\\gamma) [f_1(\\mathbf{k}') - f_1(\\mathbf{k})]\n$$\nwhere $d\\Omega'$ is the solid-angle element for the scattered wavevector $\\mathbf{k}'$, and $\\gamma$ is the angle between $\\mathbf{k}$ and $\\mathbf{k}'$. The wavevectors $\\mathbf{k}$ and $\\mathbf{k}'$ are restricted to the Fermi surface.\n\nThe linearized BTE is thus\n$$\n-e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\varepsilon} = \\int d\\Omega' \\, W(\\gamma) [f_1(\\mathbf{k}') - f_1(\\mathbf{k})]\n$$\nAt low temperatures, $\\frac{\\partial f_0}{\\partial \\varepsilon}$ is sharply peaked at the Fermi energy $\\varepsilon_F$, so we seek a solution of the form\n$f_1(\\mathbf{k}) = \\Phi(\\hat{\\mathbf{k}}) \\left(-\\frac{\\partial f_0}{\\partial \\varepsilon}\\right)$. Substituting this into the BTE and cancelling the common factor $\\left(-\\frac{\\partial f_0}{\\partial \\varepsilon}\\right)$, we obtain an integral equation for the angular part $\\Phi(\\hat{\\mathbf{k}})$:\n$$\ne(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) = \\int d\\Omega' \\, W(\\gamma) [\\Phi(\\hat{\\mathbf{k}}) - \\Phi(\\hat{\\mathbf{k}}')]\n$$\nWith $\\mathbf{E} = E \\hat{\\mathbf{z}}$ and $\\mathbf{v}_{\\mathbf{k}} = v_F \\hat{\\mathbf{k}}$, where $v_F$ is the Fermi velocity, the left-hand side becomes $e E v_F (\\hat{\\mathbf{z}} \\cdot \\hat{\\mathbf{k}}) = e E v_F \\cos\\theta$. Here, $\\theta$ is the polar angle of $\\hat{\\mathbf{k}}$ with respect to the $\\hat{\\mathbf{z}}$-axis.\n\n**1. Derivation of the scalar integral equation and eigenvalue identification**\n\nThe integral equation for $\\Phi(\\hat{\\mathbf{k}})$ on the Fermi surface is:\n$$\ne E v_F \\cos\\theta = \\int d\\Omega' \\, W(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{k}}') [\\Phi(\\hat{\\mathbf{k}}) - \\Phi(\\hat{\\mathbf{k}}')]\n$$\nThe right-hand side is a linear operator acting on $\\Phi$. Let's call it $\\mathcal{L}[\\Phi]$.\nThe source term $e E v_F \\cos\\theta$ is proportional to the spherical harmonic $Y_{1,0}(\\hat{\\mathbf{k}})$. The collision operator $\\mathcal{L}$ is rotationally invariant because its kernel $W$ depends only on the relative angle $\\gamma = \\arccos(\\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{k}}')$. Consequently, the spherical harmonics $Y_{lm}(\\hat{\\mathbf{k}})$ are its eigenfunctions. The solution $\\Phi(\\hat{\\mathbf{k}})$ must therefore be in the same spherical harmonic subspace as the source term, i.e., proportional to $\\cos\\theta$.\nLet us assume the solution form $\\Phi(\\hat{\\mathbf{k}}) = c \\cos\\theta$ for some constant $c$.\n$$\ne E v_F \\cos\\theta = c \\left[ \\cos\\theta \\int d\\Omega' W(\\gamma) - \\int d\\Omega' W(\\gamma) \\cos\\theta' \\right]\n$$\nThe collision operator's action on an eigenfunction $Y_{lm}$ is $\\mathcal{L}[Y_{lm}] = (\\Lambda_0 - \\Lambda_l) Y_{lm}$, where $\\Lambda_l$ are the eigenvalues of the integral part of the operator, given by $\\Lambda_l = 2\\pi \\int_{-1}^{1} W(x) P_l(x) dx$, with $x=\\cos\\gamma$ and $P_l(x)$ being the Legendre polynomials.\nFor our solution proportional to $\\cos\\theta \\propto P_1(\\cos\\theta)$, we are interested in the $l=1$ eigenvalue of the operator $\\mathcal{L}$. The driving term corresponds to $l=1$.\n$$\n\\mathcal{L}[c \\cos\\theta] = c(\\Lambda_0 - \\Lambda_1) \\cos\\theta\n$$\nThe BTE becomes $e E v_F \\cos\\theta = c(\\Lambda_0 - \\Lambda_1) \\cos\\theta$. The eigenvalue of the collision operator corresponding to the $l=1$ mode is $\\Lambda_0 - \\Lambda_1$.\nThis eigenvalue can be expressed as an angular integral over $W(\\gamma)$:\n$$\n\\Lambda_0 - \\Lambda_1 = 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) P_0(\\cos\\gamma) d(\\cos\\gamma) - 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) P_1(\\cos\\gamma) d(\\cos\\gamma)\n$$\nSince $P_0(x)=1$ and $P_1(x)=x$:\n$$\n\\Lambda_0 - \\Lambda_1 = 2\\pi \\int_{-1}^{1} W(\\cos\\gamma) (1 - \\cos\\gamma) d(\\cos\\gamma) = \\int d\\Omega' W(\\gamma) (1-\\cos\\gamma)\n$$\nThis quantity is the transport scattering rate, often denoted $1/\\tau_{\\text{tr}}$.\n\n**2. Conductivity ratio**\n\nThe electrical current density along $\\hat{\\mathbf{z}}$ is $j_z = -e \\int v_z f_1(\\mathbf{k}) \\frac{d^3k}{(2\\pi)^3}$ (for spinless electrons).\nUsing $f_1(\\mathbf{k}) = \\Phi(\\hat{\\mathbf{k}}) (-\\frac{\\partial f_0}{\\partial \\varepsilon})$, we have $\\Phi(\\hat{\\mathbf{k}}) = c \\cos\\theta = \\frac{e E v_F}{\\Lambda_0 - \\Lambda_1} \\cos\\theta$.\nThe integral over energy yields the density of states at the Fermi level, $D(\\varepsilon_F)$, for a given spin. Let's group the energy- and band-related constants into a prefactor $C_0 = \\frac{e^2 v_F^2 D(\\varepsilon_F)}{4\\pi}$.\n$$\nj_z = C_0 \\frac{E}{\\Lambda_0 - \\Lambda_1} \\int d\\Omega \\, \\cos^2\\theta\n$$\nWith $\\int \\cos^2\\theta \\, d\\Omega = 4\\pi/3$, we get $j_z = \\frac{C_0 E}{3(\\Lambda_0 - \\Lambda_1)} (4\\pi)$. The full conductivity $\\sigma_{\\mathrm{full}} = j_z/E$ is:\n$$\n\\sigma_{\\mathrm{full}} = \\frac{4\\pi C_0}{3(\\Lambda_0 - \\Lambda_1)}\n$$\n\nIn the relaxation-time approximation (RTA), the collision operator is simplified to $\\mathcal{L}_{\\mathrm{RTA}}[f_1] = -f_1/\\tau_0$, where the problem defines $1/\\tau_0 = \\int d\\Omega' W(\\gamma)$. This corresponds to our eigenvalue $\\Lambda_0$. The BTE in RTA is $-e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}})(-\\frac{\\partial f_0}{\\partial\\varepsilon}) = -f_1/\\tau_0 = -\\Lambda_0 f_1$.\nThis gives $f_{1, \\mathrm{RTA}}(\\mathbf{k}) = \\frac{e(\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}})}{\\Lambda_0} (-\\frac{\\partial f_0}{\\partial\\varepsilon}) = \\frac{e E v_F \\cos\\theta}{\\Lambda_0} (-\\frac{\\partial f_0}{\\partial\\varepsilon})$.\nThe RTA conductivity $\\sigma_{\\mathrm{RTA}}$ is found by the same current calculation, replacing $(\\Lambda_0-\\Lambda_1)^{-1}$ with $\\Lambda_0^{-1}$:\n$$\n\\sigma_{\\mathrm{RTA}} = \\frac{4\\pi C_0}{3 \\Lambda_0}\n$$\nThe ratio $R(g) = \\sigma_{\\mathrm{full}} / \\sigma_{\\mathrm{RTA}}$ is:\n$$\nR(g) = \\frac{\\Lambda_0}{\\Lambda_0 - \\Lambda_1} = \\frac{\\int d\\Omega' \\, W(\\gamma)}{\\int d\\Omega' \\, W(\\gamma) (1-\\cos\\gamma)} = \\frac{\\int_{-1}^{1} W(\\cos\\gamma) d(\\cos\\gamma)}{\\int_{-1}^{1} W(\\cos\\gamma) (1-\\cos\\gamma) d(\\cos\\gamma)}\n$$\n\n**3. Evaluation for the given kernel**\n\nThe given scattering kernel is $W(\\cos\\gamma) = A \\frac{1 - g^{2}}{(1 + g^{2} - 2 g \\cos\\gamma)^{3/2}}$.\nThis expression is proportional to the generating function for Legendre polynomials:\n$$\n\\sum_{l=0}^\\infty (2l+1) g^l P_l(x) = \\frac{1-g^2}{(1+g^2-2gx)^{3/2}}\n$$\nwhere $x=\\cos\\gamma$. Thus, we can write $W(x) = A \\sum_{l=0}^\\infty (2l+1) g^l P_l(x)$.\nWe can now find the eigenvalues $\\Lambda_l$ using the orthogonality of Legendre polynomials $\\int_{-1}^{1} P_l(x) P_j(x) dx = \\frac{2}{2l+1}\\delta_{lj}$.\n$$\n\\Lambda_l = 2\\pi \\int_{-1}^{1} W(x) P_l(x) dx = 2\\pi \\int_{-1}^{1} \\left(A \\sum_{j=0}^\\infty (2j+1) g^j P_j(x)\\right) P_l(x) dx\n$$\n$$\n\\Lambda_l = 2\\pi A \\sum_{j=0}^\\infty (2j+1) g^j \\left(\\frac{2}{2l+1}\\delta_{lj}\\right) = 2\\pi A (2l+1) g^l \\frac{2}{2l+1} = 4\\pi A g^l\n$$\nThis gives us the required eigenvalues for $l=0$ and $l=1$:\n$$\n\\Lambda_0 = 4\\pi A g^0 = 4\\pi A\n$$\n$$\n\\Lambda_1 = 4\\pi A g^1 = 4\\pi A g\n$$\nAlternatively, one can compute the integrals directly. Let $x = \\cos\\gamma$.\n$$\n\\int_{-1}^{1} (1+g^2-2gx)^{-3/2} dx = \\left[\\frac{1}{g\\sqrt{1+g^2-2gx}}\\right]_{-1}^{1} = \\frac{1}{g}\\left(\\frac{1}{1-g} - \\frac{1}{1+g}\\right) = \\frac{2}{1-g^2}\n$$\nSo $\\int_{-1}^{1} W(x) dx = A(1-g^2)\\frac{2}{1-g^2} = 2A$, and $\\Lambda_0 = 2\\pi(2A) = 4\\pi A$.\n$$\n\\int_{-1}^{1} x(1+g^2-2gx)^{-3/2} dx = \\frac{2g}{1-g^2}\n$$\nSo $\\int_{-1}^{1} W(x)x dx = A(1-g^2)\\frac{2g}{1-g^2} = 2Ag$, and $\\Lambda_1 = 2\\pi(2Ag) = 4\\pi Ag$.\nBoth methods yield the same results.\n\nFinally, we compute the ratio $R(g)$:\n$$\nR(g) = \\frac{\\Lambda_0}{\\Lambda_0 - \\Lambda_1} = \\frac{4\\pi A}{4\\pi A - 4\\pi A g} = \\frac{4\\pi A}{4\\pi A(1-g)} = \\frac{1}{1-g}\n$$\nThis result demonstrates that for highly forward-peaked scattering ($g \\to 1$), the relaxation-time approximation, which uses the total scattering rate, grossly underestimates the conductivity. The transport scattering rate, which correctly weights scattering events by $(1-\\cos\\gamma)$, goes to zero, leading to a much higher conductivity than predicted by RTA.", "answer": "$$\\boxed{\\frac{1}{1-g}}$$", "id": "2803361"}, {"introduction": "Modern transport theory, particularly in the context of first-principles computations, treats the collision process through a spectral analysis of the linearized collision operator. This final practice brings you to this contemporary viewpoint by introducing the concept of 'relaxons'—the eigenmodes of the collision operator. Through a hands-on numerical exercise, you will diagonalize the collision operator to see how different modes contribute to physical currents and entropy production [@problem_id:2803343], providing a concrete understanding of the methods that power today's predictive materials modeling.", "problem": "You are given the linearized Boltzmann transport equation for carriers in a crystalline solid, written in the space of crystal momentum states after linearization about equilibrium. In the symmetrized representation, the collision operator is a symmetric, positive semidefinite matrix $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ acting on a state amplitude vector $|\\psi\\rangle \\in \\mathbb{R}^{N}$. A steady-state in the presence of a weak thermodynamic driving field is defined by the linear system\n$$\n\\mathbf{A}\\,|\\psi\\rangle = |d\\rangle,\n$$\nwhere $|d\\rangle$ represents the driving term induced by, for example, a small uniform temperature gradient. The physical current of interest (such as the heat current) is modeled as a linear functional\n$$\nJ = \\langle j | \\psi \\rangle,\n$$\nwhere $|j\\rangle \\in \\mathbb{R}^{N}$ is a given current-coupling vector in the same symmetrized space. The entropy production rate (per a fixed normalization volume) in the steady state is given by the quadratic form\n$$\n\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle \\ge 0.\n$$\nThe eigenmodes of $\\mathbf{A}$, called relaxons, are obtained by the spectral decomposition\n$$\n\\mathbf{A} = \\sum_{i=1}^{N} \\lambda_i\\, |e_i\\rangle \\langle e_i|,\n$$\nwith orthonormal eigenvectors $|e_i\\rangle$ and nonnegative eigenvalues $\\lambda_i \\ge 0$. Express the steady state, the current, and the entropy production as modal sums over relaxons, and design an algorithm that, for a given symmetric matrix $\\mathbf{A}$ and vectors $|d\\rangle$, $|j\\rangle$, computes:\n- the total current $J$,\n- the total entropy production $\\dot{S}$,\n- the per-mode current contributions $J_i$,\n- the per-mode entropy production contributions $\\dot{S}_i$,\nwhere the modal contributions are defined in the eigenbasis of $\\mathbf{A}$. To ensure numerical stability, use a pseudoinverse convention: define a small cutoff $\\varepsilon = 10^{-10}$, and include in the sums only those modes with $\\lambda_i > \\varepsilon$.\n\nStart from fundamental bases appropriate to materials physics and transport theory: the structure of the linearized Boltzmann equation, the principle of detailed balance, the Onsager reciprocity constraints that permit symmetrization of the collision operator, and the entropy production nonnegativity (Boltzmann’s $H$-theorem). Do not assume any shortcut formulas; obtain expressions for the modal contributions directly from the eigen-decomposition and linear algebra.\n\nAll quantities in this problem are non-dimensionalized; report all outputs as dimensionless floating-point numbers rounded to $6$ decimal places.\n\nYour program must:\n- Diagonalize each given $\\mathbf{A}$ using a numerically stable eigen-decomposition suitable for symmetric matrices.\n- Project $|d\\rangle$ and $|j\\rangle$ onto the relaxon eigenbasis.\n- Compute per-mode contributions using the pseudoinverse rule with threshold $\\varepsilon = 10^{-10}$.\n- Report the results with eigenmodes ordered by nondecreasing eigenvalues $\\lambda_i$.\n\nTest suite:\nFor each test case, $\\mathbf{A}$ is symmetric by construction and already in the symmetrized representation.\n\n- Test case $1$ (general well-conditioned):\n  - $\\mathbf{A}_1 = \\begin{bmatrix} 2.0 & -0.5 & 0.0 \\\\ -0.5 & 1.5 & -0.2 \\\\ 0.0 & -0.2 & 1.0 \\end{bmatrix}$\n  - $|d_1\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ -0.2 \\end{bmatrix}$\n  - $|j_1\\rangle = \\begin{bmatrix} 0.8 \\\\ -0.3 \\\\ 0.4 \\end{bmatrix}$\n\n- Test case $2$ (near-conserved relaxon dominating):\n  - $\\mathbf{A}_2 = \\begin{bmatrix} 10^{-4} & 0.0 & 0.0 \\\\ 0.0 & 1.0 & 0.1 \\\\ 0.0 & 0.1 & 2.0 \\end{bmatrix}$\n  - $|d_2\\rangle = \\begin{bmatrix} 0.2 \\\\ 0.1 \\\\ -0.1 \\end{bmatrix}$\n  - $|j_2\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\n- Test case $3$ (orthogonality causing zero current but positive dissipation):\n  - $\\mathbf{A}_3 = \\begin{bmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.0 & 0.9 & 0.0 \\\\ 0.0 & 0.0 & 1.1 \\end{bmatrix}$\n  - $|d_3\\rangle = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$\n  - $|j_3\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\nFor each test case with $N=3$, your program must output a block of $8$ numbers in the following order:\n- first the total current $J$,\n- then the total entropy production $\\dot{S}$,\n- then the three per-mode current contributions $J_1, J_2, J_3$,\n- then the three per-mode entropy production contributions $\\dot{S}_1, \\dot{S}_2, \\dot{S}_3$,\nwhere modes are ordered by ascending $\\lambda_i$.\n\nFinal output format:\nYour program should produce a single line of output containing all results for all test cases as a comma-separated list enclosed in square brackets, with no spaces. Concatenate the three $8$-number blocks in the order of the test cases. Each number must be rounded to $6$ decimal places. For example, the overall shape is\n$[J^{(1)},\\dot{S}^{(1)},J^{(1)}_1,J^{(1)}_2,J^{(1)}_3,\\dot{S}^{(1)}_1,\\dot{S}^{(1)}_2,\\dot{S}^{(1)}_3, J^{(2)},\\dot{S}^{(2)},\\dots, J^{(3)},\\dot{S}^{(3)},\\dots]$.", "solution": "The problem statement is subjected to rigorous validation before any attempt at a solution.\n\n### Step 1: Extract Givens\n\nThe givens are extracted verbatim from the problem statement:\n-   The steady-state linearized Boltzmann transport equation: $\\mathbf{A}\\,|\\psi\\rangle = |d\\rangle$, where $\\mathbf{A} \\in \\mathbb{R}^{N \\times N}$ is a symmetric, positive semidefinite collision operator, $|\\psi\\rangle \\in \\mathbb{R}^{N}$ is the state amplitude vector, and $|d\\rangle \\in \\mathbb{R}^{N}$ is the driving term.\n-   The physical current: $J = \\langle j | \\psi \\rangle$, where $|j\\rangle \\in \\mathbb{R}^{N}$ is a current-coupling vector.\n-   The entropy production rate: $\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle \\ge 0$.\n-   The spectral decomposition of the collision operator: $\\mathbf{A} = \\sum_{i=1}^{N} \\lambda_i\\, |e_i\\rangle \\langle e_i|$, with orthonormal eigenvectors $|e_i\\rangle$ and nonnegative eigenvalues $\\lambda_i \\ge 0$.\n-   A numerical cutoff for the pseudoinverse convention: $\\varepsilon = 10^{-10}$. Modes with $\\lambda_i > \\varepsilon$ are included in sums.\n-   Test Case $1$:\n    -   $\\mathbf{A}_1 = \\begin{bmatrix} 2.0 & -0.5 & 0.0 \\\\ -0.5 & 1.5 & -0.2 \\\\ 0.0 & -0.2 & 1.0 \\end{bmatrix}$\n    -   $|d_1\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.5 \\\\ -0.2 \\end{bmatrix}$\n    -   $|j_1\\rangle = \\begin{bmatrix} 0.8 \\\\ -0.3 \\\\ 0.4 \\end{bmatrix}$\n-   Test Case $2$:\n    -   $\\mathbf{A}_2 = \\begin{bmatrix} 10^{-4} & 0.0 & 0.0 \\\\ 0.0 & 1.0 & 0.1 \\\\ 0.0 & 0.1 & 2.0 \\end{bmatrix}$\n    -   $|d_2\\rangle = \\begin{bmatrix} 0.2 \\\\ 0.1 \\\\ -0.1 \\end{bmatrix}$\n    -   $|j_2\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\endbmatrix}$\n-   Test Case $3$:\n    -   $\\mathbf{A}_3 = \\begin{bmatrix} 1.2 & 0.0 & 0.0 \\\\ 0.0 & 0.9 & 0.0 \\\\ 0.0 & 0.0 & 1.1 \\end{bmatrix}$\n    -   $|d_3\\rangle = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$\n    -   $|j_3\\rangle = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is analyzed against the specified validation criteria.\n-   **Scientifically Grounded**: The problem is rooted in the fundamental theory of electron and phonon transport in crystalline solids. The linearized Boltzmann equation, the concept of a symmetrized collision operator (a consequence of microscopic reversibility and detailed balance), the definition of entropy production, and the spectral analysis of the collision operator (relaxon modes) are all standard and central concepts in modern condensed matter physics.\n-   **Well-Posed**: The problem is well-posed. For a given symmetric positive semidefinite matrix $\\mathbf{A}$ and a driving term $|d\\rangle$, the system $\\mathbf{A}|\\psi\\rangle = |d\\rangle$ has a unique solution within the subspace orthogonal to the null space of $\\mathbf{A}$. The use of a pseudoinverse with a cutoff $\\varepsilon$ provides a regularized, numerically stable, and physically meaningful way to handle near-zero eigenvalues, which correspond to quasi-conserved quantities. The inputs are provided, and the required outputs are clearly defined.\n-   **Objective**: The problem is stated in precise, objective mathematical language. The matrices and vectors are defined without ambiguity.\n-   **No other flaws are detected**: The problem is self-contained, consistent, and computationally feasible. It does not contain any of the listed flaws such as unsoundness, non-formalizability, incompleteness, unrealism, or triviality.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. We proceed to a complete, reasoned solution.\n\n### Solution Derivation\n\nThe objective is to express the steady-state solution $|\\psi\\rangle$, the current $J$, and the entropy production $\\dot{S}$ in terms of the eigenmodes (relaxons) of the collision operator $\\mathbf{A}$.\n\nThe collision operator $\\mathbf{A}$ is a real symmetric matrix, so it possesses a complete, orthonormal basis of eigenvectors $\\{|e_i\\rangle\\}_{i=1}^N$ with corresponding real eigenvalues $\\{\\lambda_i\\}_{i=1}^N$. The orthonormality condition is $\\langle e_i | e_k \\rangle = \\delta_{ik}$, where $\\delta_{ik}$ is the Kronecker delta. Any vector in the state space $\\mathbb{R}^N$ can be expanded in this basis.\n\nWe expand the state vector $|\\psi\\rangle$ and the driving vector $|d\\rangle$ in the relaxon basis:\n$$\n|\\psi\\rangle = \\sum_{i=1}^{N} \\psi_i |e_i\\rangle, \\quad \\text{where} \\quad \\psi_i = \\langle e_i | \\psi \\rangle\n$$\n$$\n|d\\rangle = \\sum_{i=1}^{N} d_i |e_i\\rangle, \\quad \\text{where} \\quad d_i = \\langle e_i | d \\rangle\n$$\nThe coefficients $\\psi_i$ and $d_i$ are the projections of the respective vectors onto the eigenvector $|e_i\\rangle$.\n\nWe substitute these expansions into the steady-state Boltzmann equation $\\mathbf{A}|\\psi\\rangle = |d\\rangle$:\n$$\n\\mathbf{A}\\left(\\sum_{i=1}^{N} \\psi_i |e_i\\rangle\\right) = \\sum_{i=1}^{N} d_i |e_i\\rangle\n$$\nBy linearity of $\\mathbf{A}$, and using the eigenvalue equation $\\mathbf{A}|e_i\\rangle = \\lambda_i |e_i\\rangle$, we obtain:\n$$\n\\sum_{i=1}^{N} \\psi_i (\\mathbf{A}|e_i\\rangle) = \\sum_{i=1}^{N} \\psi_i \\lambda_i |e_i\\rangle = \\sum_{i=1}^{N} d_i |e_i\\rangle\n$$\nDue to the orthonormality of the basis $\\{|e_i\\rangle\\}$, we can equate the coefficients for each mode $i$:\n$$\n\\lambda_i \\psi_i = d_i\n$$\nTo solve for $\\psi_i$, we must consider the value of $\\lambda_i$. If $\\lambda_i \\ne 0$, then $\\psi_i = d_i / \\lambda_i$. If $\\lambda_i = 0$, the equation $0 \\cdot \\psi_i = d_i$ requires $d_i=0$ for a solution to exist. This is the Fredholm alternative: a solution exists only if the driving term is orthogonal to the null space of $\\mathbf{A}$. The null space modes correspond to conserved quantities (e.g., total momentum in a crystal with perfect translational symmetry). The problem specifies a pseudoinverse convention with a threshold $\\varepsilon = 10^{-10}$. This leads to the following expression for the state vector coefficients:\n$$\n\\psi_i = \\begin{cases} d_i / \\lambda_i & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\nThe full state vector is thus $|\\psi\\rangle = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{\\langle e_i | d \\rangle}{\\lambda_i} |e_i\\rangle$.\n\nNow, we derive the expressions for the current $J$ and entropy production $\\dot{S}$. First, we expand the current-coupling vector $|j\\rangle$:\n$$\n|j\\rangle = \\sum_{i=1}^{N} j_i |e_i\\rangle, \\quad \\text{where} \\quad j_i = \\langle e_i | j \\rangle\n$$\nThe total current $J = \\langle j | \\psi \\rangle$ is:\n$$\nJ = \\left\\langle \\sum_{k=1}^{N} j_k |e_k\\rangle \\middle| \\sum_{i=1}^{N} \\psi_i |e_i\\rangle \\right\\rangle = \\sum_{i,k=1}^{N} j_k \\psi_i \\langle e_k | e_i \\rangle = \\sum_{i=1}^{N} j_i \\psi_i\n$$\nSubstituting the expression for $\\psi_i$:\n$$\nJ = \\sum_{i: \\lambda_i > \\varepsilon} j_i \\frac{d_i}{\\lambda_i} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{\\langle e_i | j \\rangle \\langle e_i | d \\rangle}{\\lambda_i}\n$$\nThe per-mode contribution to the current, $J_i$, is the $i$-th term in this sum:\n$$\nJ_i = \\begin{cases} \\frac{\\langle e_i | j \\rangle \\langle e_i | d \\rangle}{\\lambda_i} & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\nThe total current is the sum of these contributions: $J = \\sum_{i=1}^{N} J_i$.\n\nNext, we evaluate the entropy production $\\dot{S} = \\langle \\psi | \\mathbf{A} | \\psi \\rangle$. Using the fact that $\\mathbf{A}|\\psi\\rangle = |d\\rangle$ for the steady state, we can write $\\dot{S} = \\langle \\psi | d \\rangle$. Let us use this form, as it is computationally efficient:\n$$\n\\dot{S} = \\left\\langle \\sum_{k=1}^{N} \\psi_k |e_k\\rangle \\middle| \\sum_{i=1}^{N} d_i |e_i\\rangle \\right\\rangle = \\sum_{i,k=1}^{N} \\psi_k d_i \\langle e_k | e_i \\rangle = \\sum_{i=1}^{N} \\psi_i d_i\n$$\nSubstituting the expression for $\\psi_i$:\n$$\n\\dot{S} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{d_i}{\\lambda_i} d_i = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{d_i^2}{\\lambda_i} = \\sum_{i: \\lambda_i > \\varepsilon} \\frac{(\\langle e_i | d \\rangle)^2}{\\lambda_i}\n$$\nThe per-mode contribution to the entropy production, $\\dot{S}_i$, is the $i$-th term in this sum:\n$$\n\\dot{S}_i = \\begin{cases} \\frac{(\\langle e_i | d \\rangle)^2}{\\lambda_i} & \\text{if } \\lambda_i > \\varepsilon \\\\ 0 & \\text{if } \\lambda_i \\le \\varepsilon \\end{cases}\n$$\nThe total entropy production is the sum of these contributions: $\\dot{S} = \\sum_{i=1}^{N} \\dot{S}_i$. As $\\lambda_i \\ge 0$, it is guaranteed that $\\dot{S}_i \\ge 0$ and thus $\\dot{S} \\ge 0$, consistent with the second law of thermodynamics.\n\nThe computational algorithm is as follows:\n$1$. For each test case $(\\mathbf{A}, |d\\rangle, |j\\rangle)$, perform an eigendecomposition of the symmetric matrix $\\mathbf{A}$ to obtain the eigenvalues $\\lambda_i$ and the corresponding matrix of orthonormal eigenvectors $\\mathbf{E}$ (whose columns are $|e_i\\rangle$). A numerically stable algorithm such as `numpy.linalg.eigh` is appropriate; it returns eigenvalues sorted in non-decreasing order, which satisfies the problem requirement.\n$2$. For each eigenmode $i=1, \\dots, N$:\n    a. Extract the eigenvalue $\\lambda_i$ and eigenvector $|e_i\\rangle$.\n    b. Project the driving and current vectors onto the eigenvector to get the coefficients: $d_i = \\langle e_i | d \\rangle = |e_i\\rangle^T |d\\rangle$ and $j_i = \\langle e_i | j \\rangle = |e_i\\rangle^T |j\\rangle$.\n    c. Apply the pseudoinverse rule. If $\\lambda_i > \\varepsilon = 10^{-10}$, compute the modal contributions $J_i = (j_i d_i) / \\lambda_i$ and $\\dot{S}_i = d_i^2 / \\lambda_i$. Otherwise, set $J_i=0$ and $\\dot{S}_i=0$.\n$3$. Sum the modal contributions to find the total current $J = \\sum_i J_i$ and total entropy production $\\dot{S} = \\sum_i \\dot{S}_i$.\n$4$. Collect the results for each test case in the specified order: $[J, \\dot{S}, J_1, J_2, J_3, \\dot{S}_1, \\dot{S}_2, \\dot{S}_3]$.\n$5$. Format all numerical results as floating-point numbers rounded to $6$ decimal places.", "answer": "[0.264627,0.852924,0.065879,0.301297,-0.102549,0.038234,0.311409,0.503282,2000.000000,4000.000000,2000.000000,-0.000001,0.000000,4000.000000,0.000002,0.000000,0.000000,1.111111,0.000000,0.000000,0.000000,1.111111,0.000000,0.000000]", "id": "2803343"}]}