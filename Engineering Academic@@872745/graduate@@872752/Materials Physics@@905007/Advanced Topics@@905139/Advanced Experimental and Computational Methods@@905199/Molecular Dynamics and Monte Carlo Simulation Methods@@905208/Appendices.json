{"hands_on_practices": [{"introduction": "The brute-force calculation of all pairwise interactions in a system of $N$ particles scales as $\\mathcal{O}(N^2)$, a computational barrier that makes large simulations intractable. This practice explores the cell list and Verlet list algorithms, which cleverly reduce this cost to $\\mathcal{O}(N)$ by exploiting the short-range nature of most interatomic forces. By analyzing the computational complexity of these methods, you will gain insight into how modern simulation codes achieve the performance necessary to study systems with millions of atoms [@problem_id:2842554].", "problem": "A monatomic fluid is simulated by molecular dynamics (MD) with periodic boundary conditions (PBC) in a three-dimensional rectangular box of dimensions $L_{x} \\times L_{y} \\times L_{z}$ containing $N$ identical particles at uniform number density $\\rho = N / V$ with $V = L_{x} L_{y} L_{z}$. Interparticle forces derive from a pair potential that is truncated at a finite cutoff radius $r_{c}$, so that forces vanish identically for pair separations greater than $r_{c}$. The dominant computational cost per force-evaluation step is the number of scalar pairwise distance computations between candidate particle pairs; all other costs may be neglected. Assume the thermodynamic limit with $N \\to \\infty$ at fixed $\\rho$ so that boundary-layer corrections are negligible.\n\nStarting only from the fundamental definition of number density and the locality of interactions due to the finite cutoff, do the following:\n\n1) Using the uniform-density approximation, derive the expected number of interacting neighbors per particle as a function of $\\rho$ and $r_{c}$, and deduce the expected number of unique interacting pairs in the system. Use this to obtain the computational complexity, in big-$\\mathcal{O}$ notation and with explicit leading-order dependence on $N$, $r_{c}$, and $L_{x}, L_{y}, L_{z}$ where appropriate, for the following algorithms:\n\n- A naive all-pairs search that checks all $\\binom{N}{2}$ pairs.\n- A direct cell-list search without a stored neighbor list, using a regular grid of cubic cells of edge $a$ that partitions the box, where each particle interacts only with particles in its own cell and those cells whose minimal image distances allow separations $\\le r_{c}$.\n\nClearly state and justify the choice of $a$ that minimizes the number of candidate pair checks while guaranteeing no missed interactions, and derive the leading-order expected number of candidate pair distance computations per force-evaluation step.\n\n2) Consider a Verlet neighbor list algorithm with a skin thickness $r_{s} > 0$. The Verlet neighbor-list radius is $r_{v} = r_{c} + r_{s}$. At each force-evaluation step, forces are computed by checking the current Verlet list and evaluating pairwise distances for all listed pairs; the list is rebuilt every $m$ time steps using a cell-list-assisted construction that enumerates candidate pairs within $r_{v}$ exactly once each. Derive, in the uniform-density approximation, the leading-order expected number of pair-distance evaluations per force-evaluation step for:\n\n- Force computation using the existing Verlet list.\n- The amortized neighbor-list rebuild cost per step, given that the rebuild uses a cell list with cubic cells of edge $a$ chosen to minimize candidate enumeration cost while guaranteeing no missed pairs within $r_{v}$.\n\nCombine these to produce the total leading-order cost per force-evaluation step.\n\n3) Now specialize to a cubic box with $L_{x} = L_{y} = L_{z} = L$ and adopt the following explicit implementation choices that are widely used in practice:\n\n- For the direct cell-list method without a stored neighbor list, choose cubic cells of edge $a = r_{c}$ and enumerate all candidate unique pairs by checking the home cell and all neighboring cells required to ensure that all pairs with separation $\\le r_{c}$ are considered exactly once.\n- For the Verlet neighbor-list method, rebuild the Verlet list of radius $r_{v} = r_{c} + r_{s}$ every $m$ steps using cubic cells of edge $a = r_{v}$ to enumerate candidate unique pairs for the rebuild, and compute forces each step by checking all pairs in the Verlet list exactly once.\n\nUnder these assumptions, define $R$ to be the ratio of the expected number of pairwise distance computations per force-evaluation step for the Verlet neighbor-list method (including the amortized rebuild cost) to that of the direct cell-list method without a stored neighbor list. Derive a closed-form analytical expression for $R$ expressed only in terms of $r_{c}$, $r_{s}$, and $m$. Provide $R$ as a single simplified symbolic expression. No numerical evaluation is required.", "solution": "We begin from the locality of the pair potential with finite cutoff radius $r_{c}$ and the uniform number density $\\rho = N / V$, where $V = L_{x} L_{y} L_{z}$. In the thermodynamic limit with uniform density, the expected number of neighbors per particle within a distance $r$ is given by the product of density and the volume of a ball of radius $r$:\n$$\nn(r) = \\rho \\, \\frac{4}{3} \\pi r^{3}.\n$$\nThis follows from integrating the uniform density over the spherical region of radius $r$ centered on a tagged particle. Consequently, the expected number of unique pairs whose separation is $\\le r$ in a large system is\n$$\nP(r) = \\frac{1}{2} N \\, n(r) = \\frac{1}{2} N \\, \\rho \\, \\frac{4}{3} \\pi r^{3}.\n$$\nThe factor of $1/2$ avoids double counting pairs.\n\nPart 1: Complexity for naive all-pairs and direct cell lists.\n\n- Naive all-pairs search. The naive algorithm checks all $\\binom{N}{2} = \\frac{N(N-1)}{2}$ pairs, yielding a leading-order number of distance computations per step of $\\frac{1}{2} N^{2}$ and computational complexity $\\mathcal{O}(N^{2})$, independent of $r_{c}$ and the box dimensions for the checking stage (although only a fraction $\\sim P(r_{c}) / \\binom{N}{2}$ are interacting). Thus, in leading order,\n$$\nC_{\\text{naive}} \\sim \\frac{1}{2} N^{2}.\n$$\n\n- Direct cell-list search without a stored neighbor list. Partition the box into a regular grid of cubic cells of edge $a$. A sufficient condition to guarantee that all pairs with separation $\\le r_{c}$ are enumerated is that, for each particle, one checks its own cell and all neighboring cells intersecting the ball of radius $r_{c}$. A standard near-optimal choice is $a = r_{c}$: this minimizes the number of cells in the stencil while ensuring coverage. With $a = r_{c}$ in three dimensions, the stencil comprises the home cell plus its $3 \\times 3 \\times 3 - 1 = 26$ neighbors, for a total of $27$ cells; by organizing pair enumeration to avoid double counting (for example, by assigning each unique pair to exactly one cell-cell interaction task and using $i<j$ within a cell), each unique candidate pair is checked exactly once.\n\nThe expected number of particles in a cell is $\\rho a^{3} = \\rho r_{c}^{3}$. For a tagged particle, the expected number of candidate partners in the union of the $27$ cells is $\\rho \\times 27 a^{3} = 27 \\rho r_{c}^{3}$. Counting unique pairs across all particles gives a factor $\\frac{1}{2}$:\n$$\nC_{\\text{cell}} \\sim \\frac{1}{2} N \\, (27 \\rho r_{c}^{3}) = \\frac{27}{2} N \\rho r_{c}^{3}.\n$$\nTherefore, the leading-order complexity is $\\mathcal{O}(N \\rho r_{c}^{3}) = \\mathcal{O}\\!\\left(N \\frac{N}{V} r_{c}^{3}\\right)$, i.e.,\n$$\nC_{\\text{cell}} = \\Theta\\!\\left(\\frac{N^{2} r_{c}^{3}}{L_{x} L_{y} L_{z}}\\right),\n$$\nwith the explicit leading constant as above under the uniform-density assumption and the $a = r_{c}$ choice.\n\nPart 2: Verlet neighbor list with skin thickness and amortized rebuild.\n\nLet the Verlet neighbor-list radius be $r_{v} = r_{c} + r_{s}$ with skin $r_{s} > 0$. Two contributions to the per-step cost arise:\n\n- Force computation using the current Verlet list. The list contains all pairs whose separation is $\\le r_{v}$ at the time of the last rebuild. The expected number of unique pairs in the list is $P(r_{v}) = \\frac{1}{2} N \\rho \\frac{4}{3} \\pi r_{v}^{3}$. At each force-evaluation step, one checks each listed pair once to determine if it lies within $r_{c}$ and, if so, to compute the force. Thus the leading-order per-step cost from force computation is\n$$\nC_{\\text{VL,force}} \\sim \\frac{1}{2} N \\rho \\frac{4}{3} \\pi r_{v}^{3}.\n$$\n\n- Amortized neighbor-list rebuild cost. Assume the neighbor list is rebuilt every $m$ steps using a cell-list-assisted enumeration of candidates within $r_{v}$. Choose the cell edge for the rebuild as $a = r_{v}$ to minimize the stencil and guarantee coverage for radius $r_{v}$. By the same reasoning as in Part 1, a rebuild requires checking each unique candidate pair within the union of the $27$ cells once, giving\n$$\nC_{\\text{VL,build}} \\sim \\frac{1}{2} N \\, (27 \\rho r_{v}^{3}) = \\frac{27}{2} N \\rho r_{v}^{3}.\n$$\nAmortized over $m$ steps, the per-step rebuild cost is\n$$\n\\frac{1}{m} C_{\\text{VL,build}} \\sim \\frac{27}{2m} N \\rho r_{v}^{3}.\n$$\n\nCombining the two contributions, the total leading-order expected number of pair-distance computations per force-evaluation step is\n$$\nC_{\\text{VL,total}} \\sim \\frac{1}{2} N \\rho \\left(\\frac{4}{3} \\pi r_{v}^{3}\\right) \\;+\\; \\frac{1}{m} \\left(\\frac{27}{2} N \\rho r_{v}^{3}\\right)\n= \\frac{1}{2} N \\rho \\left[\\left(\\frac{4}{3} \\pi\\right) r_{v}^{3} + \\left(\\frac{27}{m}\\right) r_{v}^{3}\\right].\n$$\n\nPart 3: Closed-form ratio under specified choices.\n\nUnder the stated choices,\n- Direct cell-list method without a stored neighbor list uses $a = r_{c}$, with cost\n$$\nC_{\\text{cell}} \\sim \\frac{27}{2} N \\rho r_{c}^{3}.\n$$\n- Verlet neighbor list uses $r_{v} = r_{c} + r_{s}$, with per-step total cost\n$$\nC_{\\text{VL,total}} \\sim \\frac{1}{2} N \\rho \\left[\\left(\\frac{4}{3} \\pi\\right) r_{v}^{3} + \\left(\\frac{27}{m}\\right) r_{v}^{3}\\right].\n$$\n\nDefine $R$ as the ratio of these costs:\n$$\nR \\equiv \\frac{C_{\\text{VL,total}}}{C_{\\text{cell}}}\n= \\frac{\\frac{1}{2} N \\rho \\left[\\left(\\frac{4}{3} \\pi\\right) r_{v}^{3} + \\left(\\frac{27}{m}\\right) r_{v}^{3}\\right]}{\\frac{27}{2} N \\rho r_{c}^{3}}\n= \\frac{r_{v}^{3}}{r_{c}^{3}} \\left[\\frac{\\frac{4}{3} \\pi}{27} + \\frac{27/m}{27}\\right].\n$$\nSimplifying constants and substituting $r_{v} = r_{c} + r_{s}$,\n$$\nR = \\left(\\frac{r_{c} + r_{s}}{r_{c}}\\right)^{3} \\left(\\frac{4 \\pi}{81} + \\frac{1}{m}\\right).\n$$\nThis dimensionless closed-form expression depends only on $r_{c}$, $r_{s}$, and $m$, as required. It was obtained by starting from the fundamental definitions of uniform density and finite-range interactions, and by enumerating candidate pairs in physically motivated search volumes under the specified cell-edge choices that minimize candidate enumeration subject to exact coverage.", "answer": "$$\\boxed{\\left(\\frac{r_{c}+r_{s}}{r_{c}}\\right)^{3}\\left(\\frac{4\\pi}{81}+\\frac{1}{m}\\right)}$$", "id": "2842554"}, {"introduction": "Simulating materials under realistic experimental conditions often requires working in ensembles where pressure and temperature are held constant, such as the isothermal-isobaric (NPT) ensemble. This exercise delves into the statistical mechanics underpinning the Metropolis Monte Carlo algorithm by requiring the derivation of the acceptance probability for a volume change move [@problem_id:2842521]. Successfully deriving and applying this rule demonstrates a command of how partition functions and the principle of detailed balance translate into practical simulation algorithms.", "problem": "You are simulating a three-dimensional atomic system of identical particles in the isothermal–isobaric ensemble (constant number of particles, pressure, and temperature; NPT) using the Metropolis Monte Carlo method. Consider an isotropic volume-change trial move, where the cubic simulation box volume changes from $V$ to $V'$ and all particle coordinates are scaled uniformly so that their fractional coordinates remain unchanged.\n\nStarting from first principles, use the following foundation:\n- In the isothermal–isobaric ensemble at temperature $T$ and external pressure $P$, the equilibrium configurational probability density is proportional to the Boltzmann factor $\\exp[-\\beta (U + P V)]$ with $\\beta = 1/(k_B T)$, where $U$ is the potential energy. Under the isotropic coordinate scaling $V \\to V'$ with uniform scaling of particle coordinates, the configurational volume element transforms with a Jacobian factor proportional to $V^N$, where $N$ is the number of particles.\n- The Metropolis acceptance criterion enforces detailed balance using the ratio of the equilibrium probabilities and the ratio of proposal probabilities. Assume the proposal distribution for the trial volume change is symmetric in $\\ln V$, so the forward and reverse proposal probabilities cancel.\n\nTasks:\n1) Derive, from the above foundations, the expression for the acceptance probability for an isotropic volume-update trial move that changes $(\\mathbf{r}^N, V)$ to $(\\mathbf{r}'^{\\,N}, V')$ by uniform scaling of coordinates, explicitly showing how the Jacobian factor $V^N$ enters the acceptance criterion.\n\n2) Evaluate the acceptance probability numerically for the following scenario, working in reduced units such that $k_B T = 1$ (so that $\\beta = 1$), volume is measured in units of $\\sigma^3$, and pressure is measured in units of $k_B T/\\sigma^3$:\n- Number of particles: $N = 108$.\n- Current volume: $V = 1000$.\n- Proposed volume: $V' = 1001$ (isotropic scaling).\n- External pressure: $P = 1.0$.\n- Upon scaling the coordinates, the potential energy increases by $\\Delta U = U' - U = 0.5$.\n\nCompute the Metropolis acceptance probability for this trial move. Round your final answer to four significant figures. Express your final answer as a dimensionless number (no units).", "solution": "**Part 1: Derivation of the Acceptance Probability**\n\nThe Metropolis algorithm ensures that the simulation samples from the desired equilibrium ensemble by enforcing the condition of detailed balance. For a transition from an old state, $o$, to a new state, $n$, the detailed balance equation is:\n$$ \\pi(o) T(o \\to n) = \\pi(n) T(n \\to o) $$\nwhere $\\pi(s)$ is the equilibrium probability of state $s$ and $T(o \\to n)$ is the transition probability. The transition probability is a product of the proposal probability, $g(o \\to n)$, and the acceptance probability, $A(o \\to n)$. The standard Metropolis choice for the acceptance probability is:\n$$ A(o \\to n) = \\min\\left(1, \\frac{\\pi(n) g(n \\to o)}{\\pi(o) g(o \\to n)}\\right) $$\nIn the isothermal-isobaric (NPT) ensemble, a microstate is defined by the particle coordinates $\\mathbf{r}^N = \\{\\mathbf{r}_1, \\dots, \\mathbf{r}_N\\}$ and the volume $V$. The problem specifies an isotropic volume change move where the simulation box, assumed to be cubic, changes volume from $V$ to $V'$, and all particle coordinates are scaled uniformly. This implies that the scaled coordinates, $\\mathbf{s}_i = V^{-1/3}\\mathbf{r}_i$, remain invariant during the move. Therefore, it is most convenient to define the state of the system by the set of scaled coordinates $\\mathbf{s}^N$ and the volume $V$. The trial move is then a transition from an old state $o = (\\mathbf{s}^N, V)$ to a new state $n = (\\mathbf{s}^N, V')$.\n\nThe problem states that the equilibrium configurational probability density is proportional to $\\exp[-\\beta(U+PV)]$. This probability density must be understood in the context of the variables used to define the state. The fundamental phase space volume element for the configurational degrees of freedom is $d\\mathbf{r}^N$. To express the probability density in terms of our chosen state variables $(\\mathbf{s}^N, V)$, we must perform a change of variables from $\\mathbf{r}^N$ to $\\mathbf{s}^N$. The differential volume element transforms as:\n$$ d\\mathbf{r}^N = \\prod_{i=1}^N d\\mathbf{r}_i = \\prod_{i=1}^N (V d\\mathbf{s}_i) = V^N d\\mathbf{s}^N $$\nThe factor $V^N$ is the Jacobian of this transformation, as given in the problem's foundation. The probability of finding the system in the infinitesimal phase space volume $d\\mathbf{s}^N dV$ around the state $(\\mathbf{s}^N, V)$ is therefore:\n$$ p_{eq}(\\mathbf{s}^N, V) d\\mathbf{s}^N dV \\propto \\exp[-\\beta(U(\\mathbf{r}^N(\\mathbf{s}^N,V)) + PV)] V^N d\\mathbf{s}^N dV $$\nThus, the equilibrium probability density, $\\pi(\\mathbf{s}^N, V)$, in the space of scaled coordinates and volume, is:\n$$ \\pi(\\mathbf{s}^N, V) \\propto V^N \\exp[-\\beta(U + PV)] $$\nThis expression explicitly incorporates the Boltzmann factor and the Jacobian factor $V^N$, as required by the problem's foundations.\n\nWe can now compute the ratio of equilibrium probabilities for the trial move $o \\to n$, where $o=(\\mathbf{s}^N, V)$ and $n=(\\mathbf{s}^N, V')$. The potential energy of the old state is $U = U(\\mathbf{r}^N)$ and that of the new state is $U' = U(\\mathbf{r}'^N)$.\n$$ \\frac{\\pi(n)}{\\pi(o)} = \\frac{\\pi(\\mathbf{s}^N, V')}{\\pi(\\mathbf{s}^N, V)} = \\frac{(V')^N \\exp[-\\beta(U' + PV')]}{V^N \\exp[-\\beta(U + PV)]} $$\nThis simplifies to:\n$$ \\frac{\\pi(n)}{\\pi(o)} = \\left(\\frac{V'}{V}\\right)^N \\exp[-\\beta((U' - U) + P(V' - V))] $$\nNext, we consider the ratio of proposal probabilities, $g(n \\to o)/g(o \\to n)$. The move is from $(\\mathbf{s}^N, V)$ to $(\\mathbf{s}^N, V')$, so the proposal is effectively for the volume, $g(V \\to V')$. The reverse move requires proposing $V$ from $V'$, $g(V' \\to V)$. The problem statement provides the explicit assumption that \"the forward and reverse proposal probabilities cancel\". This translates to:\n$$ \\frac{g(n \\to o)}{g(o \\to n)} = \\frac{g(V' \\to V)}{g(V \\to V')} = 1 $$\nSubstituting the probability ratios into the Metropolis acceptance formula, we obtain the expression for the acceptance probability of the volume-change move:\n$$ A(V \\to V') = \\min\\left(1, \\left(\\frac{V'}{V}\\right)^N \\exp[-\\beta((U' - U) + P(V' - V))]\\right) $$\nThis expression can be written more compactly by combining the terms inside the exponential function:\n$$ A(V \\to V') = \\min\\left(1, \\exp\\left[N\\ln\\left(\\frac{V'}{V}\\right) - \\beta(U' - U) - \\beta P(V' - V)\\right]\\right) $$\nThis is the final derived expression for the acceptance probability, founded upon the principles laid out in the problem statement. The Jacobian factor $V^N$ from the coordinate transformation manifests as the term $N\\ln(V'/V)$ in the argument of the exponential.\n\n**Part 2: Numerical Evaluation**\n\nFor the second task, we must compute the numerical value of this acceptance probability given the following parameters in reduced units:\n- Number of particles: $N = 108$\n- Current volume: $V = 1000$\n- Proposed volume: $V' = 1001$\n- External pressure: $P = 1.0$\n- Change in potential energy: $\\Delta U = U' - U = 0.5$\n- Inverse temperature: $\\beta = 1 / (k_B T) = 1$\n\nFirst, we calculate the change in volume, $\\Delta V$:\n$$ \\Delta V = V' - V = 1001 - 1000 = 1 $$\nLet us denote the argument of the exponential in the acceptance probability formula as $X$:\n$$ X = N\\ln\\left(\\frac{V'}{V}\\right) - \\beta(\\Delta U + P\\Delta V) $$\nSubstituting the given values:\n$$ X = 108 \\ln\\left(\\frac{1001}{1000}\\right) - 1 \\times (0.5 + 1.0 \\times 1) $$\n$$ X = 108 \\ln(1.001) - 1.5 $$\nWe now compute the numerical value of $X$:\n$$ \\ln(1.001) \\approx 0.00099950033 $$\n$$ X \\approx 108 \\times 0.00099950033 - 1.5 $$\n$$ X \\approx 0.107946036 - 1.5 $$\n$$ X \\approx -1.392053964 $$\nThe acceptance probability is $A = \\min(1, \\exp(X))$. Since $X$ is negative, $\\exp(X)$ is less than $1$, so the acceptance probability is:\n$$ A = \\exp(X) = \\exp(-1.392053964) $$\n$$ A \\approx 0.24856620 $$\nThe problem requires the answer to be rounded to four significant figures.\n$$ A \\approx 0.2486 $$\nThis is the final numerical result for the acceptance probability of the specified trial move.", "answer": "$$\\boxed{0.2486}$$", "id": "2842521"}, {"introduction": "A key goal of molecular simulation is to predict macroscopic material properties, but simulations are performed on finite systems, often with periodic boundary conditions that can introduce artifacts. This practice tackles the critical task of bridging the gap between simulation and reality by applying a correction for finite-size effects on a calculated transport property [@problem_id:2842544]. By correcting the measured self-diffusion coefficient for hydrodynamic interactions, you will practice an essential skill in moving from raw simulation data to physically meaningful bulk properties.", "problem": "A single-component Newtonian liquid is simulated by Molecular Dynamics (MD) under Periodic Boundary Conditions (PBC) in a cubic box of edge length $L$. The self-diffusion coefficient measured from the long-time slope of the mean-squared displacement in this finite, periodically replicated system is denoted $D_{L}$. In fluids, the self-diffusion coefficient is related to the single-particle mobility $\\mu$ by the Einstein relation $D = k_{B} T \\mu$, where $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature. Hydrodynamic interactions under PBC modify the long-wavelength flow fields, producing a finite-size reduction of the mobility relative to the infinite-system limit that scales inversely with $L$ for a cubic lattice due to the Ewald summation of the Oseen tensor. The leading-order correction involves a dimensionless lattice-sum constant for the cubic geometry, commonly attributed to Hasimoto.\n\nStarting from linear response and Stokes flow for an incompressible Newtonian fluid, argue that the leading-order periodic-image contribution produces a mobility shift proportional to $1/(\\eta L)$, where $\\eta$ is the shear viscosity of the fluid, and use the Einstein relation to convert this to a leading-order correction to $D_{L}$. For a cubic box, use the Hasimoto lattice constant $\\xi = 2.837297$ to determine the corrected infinite-system diffusion coefficient $D_{\\infty}$ from the Yeh–Hummer (YH) approach for cubic PBC.\n\nThen, apply your result to the following data:\n- $D_{L} = 2.150 \\times 10^{-9}$ $\\mathrm{m^{2}\\,s^{-1}}$,\n- $T = 300$ $\\mathrm{K}$,\n- $\\eta = 0.89$ $\\mathrm{mPa\\,s}$,\n- $L = 3.0$ $\\mathrm{nm}$,\n- $k_{B} = 1.380\\,649 \\times 10^{-23}$ $\\mathrm{J\\,K^{-1}}$,\n- $\\xi = 2.837297$.\n\nExpress your final $D_{\\infty}$ in $\\mathrm{m^{2}\\,s^{-1}}$ and round your answer to four significant figures.", "solution": "The problem statement poses a valid and well-defined question in the field of computational materials physics. It is scientifically grounded, relying on established principles of statistical mechanics and hydrodynamics as applied to molecular dynamics simulations. All necessary data are provided, the terminology is precise, and the objective is clear. Thus, we proceed to the solution.\n\nThe problem asks for two things: first, to provide a theoretical argument for the form of the leading-order finite-size correction to the self-diffusion coefficient under periodic boundary conditions (PBC), and second, to apply this correction to a given set of simulation data.\n\nThe connection between the self-diffusion coefficient $D$ and the single-particle mobility $\\mu$ is given by the Einstein relation:\n$$D = k_{B} T \\mu$$\nwhere $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature. The mobility $\\mu$ relates the drift velocity $\\mathbf{v}$ of a particle to an applied force $\\mathbf{F}$ via $\\mathbf{v} = \\mu \\mathbf{F}$.\n\nIn an infinite, incompressible Newtonian fluid with shear viscosity $\\eta$, the fluid velocity field $\\mathbf{u}(\\mathbf{r})$ generated by a point force $\\mathbf{F}$ at the origin is described by the Oseen tensor, which is the Green's function for the Stokes equations. In a simulation employing PBC in a cubic box of side length $L$, a particle interacts not only with its surroundings in the central cell but also with its own periodic images. The long-range nature of hydrodynamic interactions means that these image interactions do not decay sufficiently fast to be negligible.\n\nThe velocity of a tagged particle under the influence of an external force $\\mathbf{F}$ is the sum of its velocity in an infinite medium (related to the infinite-system mobility $\\mu_{\\infty}$) and the collective contribution from the flow fields generated by all its periodic images, which are also subject to the force $\\mathbf{F}$. The total velocity of the particle must also account for a uniform backflow that ensures the total momentum of the simulation cell remains zero. The effective mobility in the finite system of size $L$, denoted $\\mu_{L}$, is thus different from $\\mu_{\\infty}$. The correction, $\\Delta\\mu = \\mu_{L} - \\mu_{\\infty}$, arises from the sum of the Oseen tensor over the periodic lattice sites.\n\nA formal calculation, typically performed using the Ewald summation method to handle the conditionally convergent lattice sum, yields the leading-order correction to the mobility. For a single particle in a cubic periodic box, this correction is given by:\n$$\\mu_{L} = \\mu_{\\infty} - \\frac{\\xi}{6\\pi\\eta L}$$\nwhere $\\xi$ is the dimensionless Hasimoto constant for a cubic lattice, which accounts for the specific geometry of the periodic images. The term arises from the long-wavelength-$k$ divergence in the Fourier representation of the Oseen tensor.\n\nA simpler, dimensional argument supports this scaling. The correction to mobility, $\\Delta\\mu$, is a consequence of hydrodynamic interactions propagated through the viscous medium over the length scale of the system, $L$. Therefore, $\\Delta\\mu$ must be a function of $\\eta$ and $L$. The physical units are: $[\\mu] = \\text{velocity}/\\text{force} = \\mathrm{m \\cdot s^{-1} \\cdot N^{-1}} = \\mathrm{s \\cdot kg^{-1}}$. The units of viscosity are $[\\eta] = \\mathrm{Pa \\cdot s} = \\mathrm{kg \\cdot m^{-1} \\cdot s^{-1}}$. The units of length are $[L] = \\mathrm{m}$. The only combination of $\\eta$ and $L$ that yields the units of mobility is $(\\eta L)^{-1}$, since $[\\eta L] = \\mathrm{kg \\cdot s^{-1}}$. Thus, we must have $\\Delta\\mu \\propto (\\eta L)^{-1}$. The proportionality constant is a dimensionless number which depends on the lattice geometry, in this case $-\\xi / (6\\pi)$.\n\nHaving established the relationship for mobility, we use the Einstein relation to translate it to diffusion coefficients. We have $D_{L} = k_{B} T \\mu_{L}$ and $D_{\\infty} = k_{B} T \\mu_{\\infty}$. Substituting these into the mobility equation:\n$$\\frac{D_{L}}{k_{B} T} = \\frac{D_{\\infty}}{k_{B} T} - \\frac{\\xi}{6\\pi\\eta L}$$\nMultiplying by $k_{B} T$ gives the Yeh–Hummer correction formula for the self-diffusion coefficient:\n$$D_{L} = D_{\\infty} - \\frac{k_{B} T \\xi}{6\\pi\\eta L}$$\nTo find the corrected diffusion coefficient for an infinite system, $D_{\\infty}$, we rearrange this formula:\n$$D_{\\infty} = D_{L} + \\frac{k_{B} T \\xi}{6\\pi\\eta L}$$\n\nNow, we apply this formula to the provided data. First, all values must be in base SI units.\n- $D_{L} = 2.150 \\times 10^{-9}$ $\\mathrm{m^{2}\\,s^{-1}}$\n- $T = 300$ $\\mathrm{K}$\n- $\\eta = 0.89$ $\\mathrm{mPa\\,s} = 0.89 \\times 10^{-3}$ $\\mathrm{kg\\,m^{-1}\\,s^{-1}}$\n- $L = 3.0$ $\\mathrm{nm} = 3.0 \\times 10^{-9}$ $\\mathrm{m}$\n- $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J\\,K^{-1}}$\n- $\\xi = 2.837297$\n\nWe calculate the correction term, $\\Delta D = \\frac{k_B T \\xi}{6\\pi\\eta L}$:\n$$ \\Delta D = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\times (300\\,\\mathrm{K}) \\times 2.837297}{6\\pi \\times (0.89 \\times 10^{-3}\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}) \\times (3.0 \\times 10^{-9}\\,\\mathrm{m})} $$\n$$ \\Delta D = \\frac{1.175836 \\times 10^{-20}\\,\\mathrm{J}}{5.031557 \\times 10^{-11}\\,\\mathrm{kg\\,s^{-1}}} $$\nNoting that $\\mathrm{J} = \\mathrm{kg\\,m^2\\,s^{-2}}$, the units of the correction are $\\mathrm{m^2\\,s^{-1}}$, as expected.\n$$ \\Delta D \\approx 0.233690 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}} $$\nFinally, we compute $D_{\\infty}$:\n$$ D_{\\infty} = D_{L} + \\Delta D = (2.150 \\times 10^{-9}) + (0.233690 \\times 10^{-9})\\,\\mathrm{m^2\\,s^{-1}} $$\n$$ D_{\\infty} = 2.383690 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}} $$\nRounding the result to four significant figures as requested:\n$$ D_{\\infty} \\approx 2.384 \\times 10^{-9}\\,\\mathrm{m^2\\,s^{-1}} $$", "answer": "$$\\boxed{2.384 \\times 10^{-9}}$$", "id": "2842544"}]}