{"hands_on_practices": [{"introduction": "This first exercise grounds our understanding of order-disorder transitions in the classic Bragg-Williams mean-field theory. By working through this canonical model for a binary alloy, you will derive the famous discontinuity in specific heat at the critical temperature. This practice is fundamental because it provides a direct, quantitative link between the microscopic order parameter and a macroscopic, experimentally observable thermodynamic property, illustrating the predictive power of mean-field approaches. [@problem_id:115512]", "problem": "In the Bragg-Williams mean-field theory of order-disorder transitions in a binary alloy AB, we consider $N$ atoms ($N/2$ of type A and $N/2$ of type B) on a lattice with coordination number $z$. The lattice is bipartite, consisting of two sublattices, $\\alpha$ and $\\beta$, each with $N/2$ sites. The degree of long-range order is described by an order parameter $S$, which ranges from $S=1$ (perfect order) to $S=0$ (complete disorder).\n\nWithin this model, the configurational energy $U(S)$, which is the part of the internal energy dependent on the atomic arrangement, is given by\n$$\nU(S) = U_{disordered} - \\frac{N z V_0}{8} S^2\n$$\nwhere $U_{disordered}$ is the energy of the completely disordered state ($S=0$), and $V_0 = \\epsilon_{AA} + \\epsilon_{BB} - 2\\epsilon_{AB}$ is a positive energy parameter related to the nearest-neighbor interaction energies $\\epsilon_{ij}$.\n\nThe configurational entropy $\\mathcal{S}(S)$ is given by\n$$\n\\mathcal{S}(S) = -N k_B \\left[ \\left(\\frac{1+S}{2}\\right) \\ln\\left(\\frac{1+S}{2}\\right) + \\left(\\frac{1-S}{2}\\right) \\ln\\left(\\frac{1-S}{2}\\right) \\right]\n$$\nwhere $k_B$ is the Boltzmann constant.\n\nThe system undergoes a second-order phase transition at a critical temperature $T_c$, below which a non-zero order parameter $S$ is stable. At the transition, the configurational specific heat exhibits a discontinuity.\n\nUsing the provided expressions for energy and entropy, derive the magnitude of the discontinuity in the configurational specific heat per atom, $\\Delta c_{conf} = \\frac{\\Delta C_{conf}}{N}$, where $C_{conf} = \\frac{dU(S)}{dT}$, at the critical temperature $T_c$.", "solution": "The equilibrium state of the system at a given temperature $T$ is found by minimizing the Helmholtz free energy $F(S, T) = U(S) - T\\mathcal{S}(S)$ with respect to the order parameter $S$.\n\nThe free energy per atom, $f(S, T) = F(S, T)/N$, is:\n$$\nf(S, T) = \\frac{U_{disordered}}{N} - \\frac{z V_0}{8} S^2 + k_B T \\left[ \\left(\\frac{1+S}{2}\\right) \\ln\\left(\\frac{1+S}{2}\\right) + \\left(\\frac{1-S}{2}\\right) \\ln\\left(\\frac{1-S}{2}\\right) \\right]\n$$\nTo find the equilibrium value of $S$, we set the derivative of $F$ with respect to $S$ to zero: $\\frac{\\partial F}{\\partial S} = 0$.\n$$\n\\frac{\\partial F}{\\partial S} = -\\frac{N z V_0}{4} S + N k_B T \\frac{d}{dS} \\left[ \\left(\\frac{1+S}{2}\\right) \\ln\\left(\\frac{1+S}{2}\\right) + \\left(\\frac{1-S}{2}\\right) \\ln\\left(\\frac{1-S}{2}\\right) \\right] = 0\n$$\nLet's compute the derivative of the entropy term:\n$$\n\\frac{d}{dS} \\left[ \\dots \\right] = \\frac{1}{2}\\ln\\left(\\frac{1+S}{2}\\right) + \\frac{1+S}{2} \\cdot \\frac{1}{(1+S)/2} \\cdot \\frac{1}{2} - \\frac{1}{2}\\ln\\left(\\frac{1-S}{2}\\right) - \\frac{1-S}{2} \\cdot \\frac{1}{(1-S)/2} \\cdot \\frac{1}{2}\n$$\n$$\n= \\frac{1}{2}\\ln\\left(\\frac{1+S}{1-S}\\right) + \\frac{1}{4} - \\frac{1}{4} = \\frac{1}{2}\\ln\\left(\\frac{1+S}{1-S}\\right) = \\text{arctanh}(S)\n$$\nSubstituting this into the equilibrium condition:\n$$\n-\\frac{N z V_0}{4} S + N k_B T \\cdot \\text{arctanh}(S) = 0\n$$\n$$\n\\frac{z V_0}{4 k_B T} S = \\text{arctanh}(S)\n$$\nWhich can be written as the self-consistency equation for $S$:\n$$\nS = \\tanh\\left(\\frac{z V_0}{4 k_B T} S\\right)\n$$\nFor $T$ above the critical temperature $T_c$, the only solution to this equation is $S=0$. A non-zero solution for $S$ appears when the slope of the right-hand side at $S=0$ is greater than or equal to the slope of the left-hand side (which is 1). The critical temperature $T_c$ corresponds to the condition where the slopes are equal.\n$$\n\\left. \\frac{d}{dS} \\tanh\\left(\\frac{z V_0}{4 k_B T} S\\right) \\right|_{S=0} = \\frac{z V_0}{4 k_B T_c} \\text{sech}^2(0) = \\frac{z V_0}{4 k_B T_c} = 1\n$$\nThis gives the critical temperature:\n$$\nT_c = \\frac{z V_0}{4 k_B}\n$$\nFor temperatures just below $T_c$, $S$ is small. We can expand the $\\tanh$ function for small arguments: $\\tanh(x) \\approx x - \\frac{x^3}{3}$.\nLet $a = \\frac{z V_0}{4 k_B T} = \\frac{T_c}{T}$. The self-consistency equation is $S = \\tanh(aS)$.\n$$\nS \\approx aS - \\frac{(aS)^3}{3}\n$$\nFor $S \\neq 0$, we can divide by $S$:\n$$\n1 \\approx a - \\frac{a^3 S^2}{3} \\implies S^2 \\approx \\frac{3(a-1)}{a^3}\n$$\nWe are interested in the limit $T \\to T_c^-$. In this limit, $a = T_c/T \\to 1^+$. Let $T = T_c - \\delta T$, where $\\delta T$ is small and positive.\n$a = \\frac{T_c}{T_c - \\delta T} = \\frac{1}{1 - \\delta T / T_c} \\approx 1 + \\frac{\\delta T}{T_c}$. So $a-1 \\approx \\frac{\\delta T}{T_c} = \\frac{T_c-T}{T_c}$.\nAlso, $a^3 \\approx 1$. Thus, for $T \\to T_c^-$:\n$$\nS^2 \\approx 3\\left(\\frac{T_c-T}{T_c}\\right)\n$$\nNow, we find the configurational specific heat, $C_{conf} = \\frac{dU}{dT}$.\n$$\nC_{conf} = \\frac{d}{dT} \\left( U_{disordered} - \\frac{N z V_0}{8} S(T)^2 \\right) = -\\frac{N z V_0}{8} \\frac{d(S^2)}{dT}\n$$\nFrom our expression for $S^2$ near $T_c$:\n$$\n\\frac{d(S^2)}{dT} \\approx \\frac{d}{dT} \\left[ 3\\left(1 - \\frac{T}{T_c}\\right) \\right] = -\\frac{3}{T_c}\n$$\nSo, as $T \\to T_c^-$, the specific heat is:\n$$\nC_{conf}(T \\to T_c^-) = -\\frac{N z V_0}{8} \\left(-\\frac{3}{T_c}\\right) = \\frac{3 N z V_0}{8 T_c}\n$$\nNow, substitute $T_c = \\frac{z V_0}{4 k_B}$:\n$$\nC_{conf}(T \\to T_c^-) = \\frac{3 N z V_0}{8} \\frac{1}{\\frac{z V_0}{4 k_B}} = \\frac{3 N z V_0}{8} \\frac{4 k_B}{z V_0} = \\frac{12}{8} N k_B = \\frac{3}{2} N k_B\n$$\nFor $T > T_c$, the order parameter $S=0$ and is constant with temperature. Thus, $U(S=0)$ is constant, and $C_{conf}(T>T_c) = \\frac{dU(0)}{dT} = 0$.\n\nThe discontinuity in the specific heat at $T_c$ is:\n$$\n\\Delta C_{conf} = C_{conf}(T_c^-) - C_{conf}(T_c^+) = \\frac{3}{2} N k_B - 0 = \\frac{3}{2} N k_B\n$$\nThe problem asks for the discontinuity in the specific heat per atom, $\\Delta c_{conf} = \\Delta C_{conf} / N$.\n$$\n\\Delta c_{conf} = \\frac{1}{N} \\left( \\frac{3}{2} N k_B \\right) = \\frac{3}{2} k_B\n$$", "answer": "$$\n\\boxed{\\frac{3}{2}k_B}\n$$", "id": "115512"}, {"introduction": "Moving from a specific microscopic model to a more general phenomenological framework, this practice explores the versatility of Landau theory. You will investigate how a material's order parameter behaves under the influence of both conjugate and non-conjugate external fields, a common scenario in functional materials. By deriving an expression for the third-order non-linear susceptibility, this exercise highlights how Landau theory elegantly captures the complex, non-linear responses that are critical to many technological applications. [@problem_id:115469]", "problem": "In the framework of Landau theory, a second-order phase transition is characterized by an order parameter $\\eta$ that continuously evolves from zero at the critical temperature $T_c$. Consider a material where the Gibbs free energy $G$ near such a transition can be described by an expansion in the order parameter $\\eta$. The system is not only subject to temperature $T$ but also to an external field $h$ that is conjugate to the order parameter, and an additional generalized stress field $\\sigma$ that is not conjugate to $\\eta$.\n\nThe Gibbs free energy density is given by the expression:\n$$\nG(\\eta, T, \\sigma, h) = G_0(T) + \\frac{1}{2}\\alpha(T)\\eta^2 + \\frac{1}{4}\\beta\\eta^4 - \\frac{1}{2}\\gamma\\sigma\\eta^2 - h\\eta\n$$\nHere, $G_0(T)$ is the background free energy of the high-symmetry phase. The coefficient $\\alpha(T)$ is assumed to have a linear temperature dependence, $\\alpha(T) = \\alpha_0(T-T_c)$, where $T_c$ is the transition temperature at zero stress ($\\sigma=0$). The parameters $\\alpha_0$, $\\beta$, and $\\gamma$ are positive-definite material constants. The term $-\\frac{1}{2}\\gamma\\sigma\\eta^2$ represents the coupling between the stress and the order parameter, which is symmetric in $\\eta$. The term $-h\\eta$ is the standard coupling to the conjugate field.\n\nThe response of the order parameter to the conjugate field is characterized by susceptibilities. The linear susceptibility is $\\chi_1 = (\\partial \\eta / \\partial h)_{h=0}$. Higher-order terms describe the non-linear response of the system.\n\nYou are tasked to derive the expression for the third-order non-linear susceptibility, defined as:\n$$\n\\chi_3 = \\left(\\frac{\\partial^3 \\eta}{\\partial h^3}\\right)_{h=0, \\sigma}\n$$\nDerive the expression for $\\chi_3$ as a function of temperature $T$ for the ordered phase, which exists below the stress-dependent critical temperature $T_c(\\sigma)$. Express your final answer in terms of $T$, the zero-stress critical temperature $T_c$, the stress $\\sigma$, and the material constants $\\alpha_0$, $\\beta$, and $\\gamma$.", "solution": "The equilibrium condition for the order parameter $\\eta$ is found by minimizing the Gibbs free energy with respect to $\\eta$:\n$$\n\\frac{\\partial G}{\\partial\\eta} = \\alpha(T)\\eta + \\beta\\eta^3 - \\gamma\\sigma\\eta - h = 0\n$$\nLet's define an effective quadratic coefficient that incorporates the stress, $\\alpha_{\\text{eff}}(T, \\sigma) = \\alpha(T) - \\gamma\\sigma = \\alpha_0(T-T_c) - \\gamma\\sigma$. The equilibrium equation becomes:\n$$\n\\alpha_{\\text{eff}}\\eta + \\beta\\eta^3 = h\n$$\nTo find the susceptibilities, we differentiate this equation with respect to the conjugate field $h$.\nFirst derivative, $\\frac{d}{dh}$:\n$$\n\\left(\\alpha_{\\text{eff}} + 3\\beta\\eta^2\\right) \\frac{d\\eta}{dh} = 1 \\quad \\Rightarrow \\quad \\frac{d\\eta}{dh} = \\frac{1}{\\alpha_{\\text{eff}} + 3\\beta\\eta^2}\n$$\nIn the ordered phase, we evaluate this at $h=0$. For $h=0$, the non-zero equilibrium order parameter $\\eta_0$ satisfies $\\alpha_{\\text{eff}}\\eta_0 + \\beta\\eta_0^3 = 0$, which gives $\\eta_0^2 = -\\frac{\\alpha_{\\text{eff}}}{\\beta}$. This requires $\\alpha_{\\text{eff}}  0$, which defines the ordered phase. The stress-dependent critical temperature is $T_c(\\sigma) = T_c + \\frac{\\gamma\\sigma}{\\alpha_0}$. The ordered phase exists for $T  T_c(\\sigma)$.\n\nTo find the third-order susceptibility, we continue differentiating. Let $A(\\eta) = \\alpha_{\\text{eff}} + 3\\beta\\eta^2$. Then $\\frac{d\\eta}{dh} = A^{-1}$.\nSecond derivative, $\\frac{d}{dh}\\left(\\frac{d\\eta}{dh}\\right)$:\n$$\n\\frac{d^2\\eta}{dh^2} = \\frac{d}{dh}(A^{-1}) = -A^{-2} \\frac{dA}{dh} = -A^{-2} \\left(\\frac{dA}{d\\eta}\\frac{d\\eta}{dh}\\right) = -A^{-2} (6\\beta\\eta)(A^{-1}) = -6\\beta\\eta A^{-3}\n$$\nThird derivative, $\\frac{d}{dh}\\left(\\frac{d^2\\eta}{dh^2}\\right)$:\n$$\n\\frac{d^3\\eta}{dh^3} = \\frac{d}{dh}(-6\\beta\\eta A^{-3}) = -6\\beta \\left[ \\frac{d\\eta}{dh}A^{-3} + \\eta(-3A^{-4})\\frac{dA}{dh} \\right]\n$$\n$$\n= -6\\beta \\left[ A^{-1} A^{-3} - 3\\eta A^{-4} (6\\beta\\eta A^{-1}) \\right] = -6\\beta \\left[ A^{-4} - 18\\beta\\eta^2 A^{-5} \\right]\n$$\n$$\n= -6\\beta A^{-5} (A - 18\\beta\\eta^2)\n$$\nNow, we evaluate this expression at $h=0$, where $\\eta_0^2 = -\\alpha_{\\text{eff}}/\\beta$ and $A_0 = \\alpha_{\\text{eff}} + 3\\beta\\eta_0^2 = \\alpha_{\\text{eff}} + 3\\beta(-\\alpha_{\\text{eff}}/\\beta) = -2\\alpha_{\\text{eff}}$:\n$$\n\\chi_3 = \\left.\\frac{d^3\\eta}{dh^3}\\right|_{h=0} = -6\\beta (A_0)^{-5} (A_0 - 18\\beta\\eta_0^2)\n$$\n$$\n= -6\\beta (-2\\alpha_{\\text{eff}})^{-5} \\left( (-2\\alpha_{\\text{eff}}) - 18\\beta(-\\alpha_{\\text{eff}}/\\beta) \\right)\n$$\n$$\n= -6\\beta \\frac{1}{-32\\alpha_{\\text{eff}}^5} \\left( -2\\alpha_{\\text{eff}} + 18\\alpha_{\\text{eff}} \\right) = \\frac{6\\beta}{32\\alpha_{\\text{eff}}^5} (16\\alpha_{\\text{eff}})\n$$\n$$\n= \\frac{96\\beta\\alpha_{\\text{eff}}}{32\\alpha_{\\text{eff}}^5} = \\frac{3\\beta}{\\alpha_{\\text{eff}}^4}\n$$\nFinally, substituting the definition of $\\alpha_{\\text{eff}}$:\n$$\n\\chi_3 = \\frac{3\\beta}{\\left[\\alpha_0(T-T_c) - \\gamma\\sigma\\right]^4}\n$$", "answer": "$$\\boxed{\\frac{3\\beta}{\\bigl[\\alpha_0(T-T_c)-\\gamma\\sigma\\bigr]^4}}$$", "id": "115469"}, {"introduction": "This final practice bridges theory with modern computational materials physics, demonstrating how first-principles calculations are used to parameterize statistical models. You will implement a computational analysis based on the cluster expansion method to determine ordered ground states and predict transition temperatures for a 2D alloy. This exercise provides hands-on experience with the powerful techniques researchers use to model and understand the delicate balance of interactions that governs phase stability in complex materials. [@problem_id:2844973]", "problem": "You are asked to implement and analyze the convergence of a cluster expansion for order-disorder transitions on a two-dimensional square lattice by systematically adding pair clusters (effective pair interactions) and tracking both the stability of ground states and the critical temperature. Your program must be a complete, runnable program that produces the specified output. The goal is to reason from first principles, starting from the definition of the configurational energy in terms of effective pair interactions and a mean-field linear-stability criterion.\n\nA binary alloy on a square lattice is modeled by Ising-like pseudospins $s_{\\mathbf{R}} \\in \\{-1,+1\\}$ on lattice sites $\\mathbf{R} = (x,y)$ with periodic boundary conditions. The configurational Hamiltonian is\n$$\n\\mathcal{H} = -\\frac{1}{2}\\sum_{\\mathbf{R}}\\sum_{\\boldsymbol{\\delta}\\neq \\mathbf{0}} J(\\boldsymbol{\\delta})\\, s_{\\mathbf{R}}\\, s_{\\mathbf{R}+\\boldsymbol{\\delta}},\n$$\nwhere $J(\\boldsymbol{\\delta})$ are translationally invariant effective pair interactions (cluster expansion coefficients for pair clusters) in electronvolts. The energy per site is\n$$\n\\varepsilon = \\frac{\\mathcal{H}}{N},\n$$\nwith $N$ the number of sites.\n\nThe mean-field transition temperature is to be obtained from the linear stability of the disordered state under pair interactions. For a translationally invariant pair interaction, the interaction matrix is diagonalized by plane waves labeled by wave vector $\\mathbf{q}$ in the Brillouin zone, with eigenvalues given by the lattice Fourier series of $J(\\boldsymbol{\\delta})$. The mean-field instability condition sets the critical temperature $T_c$ when the largest eigenvalue first destabilizes the disordered state. You must implement this criterion from first principles by constructing the interaction matrix in reciprocal space via its lattice Fourier series and identifying its largest eigenvalue. Use the Boltzmann constant $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$ to express $T_c$ in Kelvin.\n\nYou must analyze convergence by truncating the true interaction at a sequence of real-space cutoffs $R_c$, which defines a systematic addition of clusters by increasing interaction range. For each cutoff in the sequence, you must compute:\n- The ground state among four candidate long-range ordered patterns at fixed concentration, by comparing their energy per site computed from the truncated Hamiltonian. The candidate patterns are:\n  - Ferromagnetic (index $0$): $s_{x,y} = +1$ for all sites.\n  - Checkerboard (index $1$), ordering vector $(\\pi,\\pi)$: $s_{x,y} = (-1)^{x+y}$.\n  - Stripe-$x$ (index $2$), ordering vector $(\\pi,0)$: $s_{x,y} = (-1)^x$.\n  - Stripe-$y$ (index $3$), ordering vector $(0,\\pi)$: $s_{x,y} = (-1)^y$.\n- The mean-field critical temperature $T_c$ in Kelvin from the truncated interaction by computing the largest eigenvalue of the interaction matrix in reciprocal space as described above. You must discretize the Brillouin zone using the reciprocal vectors of an $L\\times L$ real-space supercell with periodic boundary conditions and take the maximum over the discrete wave vectors. Use $L = 32$. Express $T_c$ in Kelvin, rounded to one decimal place.\n\nYou are given three scientifically plausible test cases that define a “true” interaction $J(\\boldsymbol{\\delta})$ up to a maximum range, and a common set of cutoffs. For each test case, you must build the truncated interaction for each cutoff and return the ground state index and $T_c$. The cutoff list is\n$$\nR_c \\in \\{1.0,\\;1.5,\\;2.0,\\;3.0,\\;4.0\\}.\n$$\n\nFor all test cases, restrict displacements $\\boldsymbol{\\delta}=(\\Delta x,\\Delta y)$ to integer components with Euclidean norm $r=\\sqrt{(\\Delta x)^2+(\\Delta y)^2}$ satisfying $0r\\leq 4.0$, and impose $J(-\\boldsymbol{\\delta})=J(\\boldsymbol{\\delta})$.\n\nTest Case A (antiferromagnetic nearest neighbor plus small long-range tail):\n- Base interactions (in electronvolts):\n  - Nearest neighbors $(\\pm 1,0)$ and $(0,\\pm 1)$: $J = -0.030$.\n  - Next-nearest neighbors (diagonals) $(\\pm 1,\\pm 1)$: $J = +0.004$.\n  - Second neighbors along axes $(\\pm 2,0)$ and $(0,\\pm 2)$: $J = -0.002$.\n- Long-range tail for any $\\boldsymbol{\\delta}$ not already assigned and with $0r\\leq 4.0$:\n  $$\n  J_{\\mathrm{tail}}(\\boldsymbol{\\delta}) = \\frac{0.001\\,(-1)^{\\Delta x+\\Delta y}}{r^3}.\n  $$\n\nTest Case B (competing short-range interactions near a stripe instability, plus anisotropic tail):\n- Base interactions (in electronvolts):\n  - Nearest neighbors $(\\pm 1,0)$ and $(0,\\pm 1)$: $J = +0.010$.\n  - Next-nearest neighbors (diagonals) $(\\pm 1,\\pm 1)$: $J = -0.007$.\n  - Second neighbors along axes $(\\pm 2,0)$ and $(0,\\pm 2)$: $J = -0.002$.\n- Long-range tail for any $\\boldsymbol{\\delta}$ not already assigned and with $0r\\leq 4.0$:\n  $$\n  J_{\\mathrm{tail}}(\\boldsymbol{\\delta}) = \\frac{0.0008\\,(-1)^{\\Delta x}}{r^3}.\n  $$\n\nTest Case C (small short-range but long-range stripe-selective couplings dominate):\n- Base interactions (in electronvolts):\n  - Nearest neighbors $(\\pm 1,0)$ and $(0,\\pm 1)$: $J = +0.001$.\n- Long-range stripe-selective couplings along the $x$-axis only, for $\\Delta y=0$ and $|\\Delta x|\\in\\{1,2,3,4\\}$:\n  $$\n  J(\\Delta x,0) \\mathrel{+}= \\frac{0.004\\,(-1)^{\\Delta x}}{(\\lvert \\Delta x\\rvert)^2}.\n  $$\n- Weak background tail for any $\\boldsymbol{\\delta}$ with $0r\\leq 4.0$ not already assigned:\n  $$\n  J_{\\mathrm{tail}}(\\boldsymbol{\\delta}) = \\frac{0.0005\\,(-1)^{\\Delta x}}{1+r^2}.\n  $$\n\nImplementation requirements:\n- Use an $L\\times L$ square lattice with $L=32$ and periodic boundary conditions in both directions.\n- For each cutoff $R_c$, truncate the true interaction by retaining only those $\\boldsymbol{\\delta}$ with $r\\le R_c$.\n- For each truncated interaction, compute:\n  - The energy per site $\\varepsilon$ for the four candidate states listed above and select the ground state index.\n  - The mean-field $T_c$ in Kelvin by constructing the lattice Fourier series of the truncated $J(\\boldsymbol{\\delta})$ on the $32\\times 32$ reciprocal grid and taking the largest eigenvalue. Round $T_c$ to one decimal place.\n- Physical units must be handled correctly. Report $T_c$ in Kelvin, rounded to one decimal.\n- Angles for wave vectors are implicit in radians through the periodic boundary conditions on the $L\\times L$ grid.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case in order $\\mathrm{A}$, $\\mathrm{B}$, $\\mathrm{C}$, include a nested list of two lists:\n  - The first is the list of ground state indices for each cutoff in the given order.\n  - The second is the list of corresponding $T_c$ values in Kelvin, each rounded to one decimal place.\n- Concretely, the final output must have the form\n$$\n\\big[\\,[\\,[g_1,g_2,g_3,g_4,g_5],\\,[T_1,T_2,T_3,T_4,T_5]\\,],\\;[\\,[\\cdots],\\,[\\cdots]\\,],\\;[\\,[\\cdots],\\,[\\cdots]\\,]\\,\\big],\n$$\nwhere $g_k$ are integers in $\\{0,1,2,3\\}$ and $T_k$ are floating-point numbers.\n\nDesign for coverage:\n- Test Case $\\mathrm{A}$ is a generic antiferromagnetic nearest-neighbor dominated case with a small long-range tail.\n- Test Case $\\mathrm{B}$ embodies strong competition between short-range terms and demonstrates a ground-state change upon adding clusters.\n- Test Case $\\mathrm{C}$ is an edge case where small but long-range interactions control the ordering vector and set $T_c$, despite weak short-range terms. This tests sensitivity to long-range $J_{\\alpha}$ and shows the physical meaning of small-amplitude but long-range interactions through their cumulative effect.\n\nYour program must be self-contained, require no user input, and adhere strictly to the execution constraints provided separately.", "solution": "The problem proposed is scientifically valid and well-posed. It constitutes a standard exercise in the mean-field theory of order-disorder transformations in alloys, a fundamental topic in computational materials physics. The model is a generalized Ising model on a two-dimensional square lattice, with configurational energy defined by a cluster expansion truncated at the pair-interaction level. All parameters, physical constants, and computational procedures are specified without ambiguity. The problem is grounded in established physical principles, mathematically formalizable, and its solution is unique and verifiable.\n\nWe will now proceed with the derivation of the required quantities and the outline of the computational algorithm.\n\n**1. Theoretical Framework**\n\nThe configurational Hamiltonian is given as:\n$$\n\\mathcal{H} = -\\frac{1}{2}\\sum_{\\mathbf{R}}\\sum_{\\boldsymbol{\\delta}\\neq \\mathbf{0}} J(\\boldsymbol{\\delta})\\, s_{\\mathbf{R}}\\, s_{\\mathbf{R}+\\boldsymbol{\\delta}}\n$$\nwhere $s_{\\mathbf{R}} \\in \\{-1, +1\\}$ is the pseudospin at lattice site $\\mathbf{R}$, and $J(\\boldsymbol{\\delta})$ are the effective pair interactions for a displacement vector $\\boldsymbol{\\delta}$. The energy per site, $\\varepsilon = \\mathcal{H}/N$ for a total of $N$ sites, in a perfectly ordered periodic structure, simplifies due to translational invariance:\n$$\n\\varepsilon = -\\frac{1}{2}\\sum_{\\boldsymbol{\\delta}\\neq \\mathbf{0}} J(\\boldsymbol{\\delta})\\, \\langle s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} \\rangle\n$$\nwhere the average $\\langle \\dots \\rangle$ is constant over the lattice. For a simple ordered pattern characterized by a single ordering wave vector $\\mathbf{k}$, such that $s_{\\mathbf{R}} \\propto e^{i\\mathbf{k}\\cdot\\mathbf{R}}$, the product of spins is $s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} \\propto e^{i\\mathbf{k}\\cdot\\mathbf{R}} e^{-i\\mathbf{k}\\cdot(\\mathbf{R}+\\boldsymbol{\\delta})} = e^{-i\\mathbf{k}\\cdot\\boldsymbol{\\delta}}$. With appropriate normalization, we can relate these patterns to specific cosine arguments. The four candidate ground states correspond to evaluating the energy at specific high-symmetry wave vectors:\n- **Ferromagnetic (FM, index $0$)**: $s_{\\mathbf{R}}=+1$. The ordering vector is $\\mathbf{k}=(0,0)$. The spin product is $s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} = 1$. The energy is $\\varepsilon_{\\text{FM}} = -\\frac{1}{2}\\sum_{\\boldsymbol{\\delta}} J(\\boldsymbol{\\delta})$.\n- **Checkerboard (AFM, index $1$)**: $s_{x,y}=(-1)^{x+y}$. The ordering vector is $\\mathbf{k}=(\\pi,\\pi)$. The spin product is $s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} = (-1)^{\\Delta x+\\Delta y}$. The energy is $\\varepsilon_{\\text{AFM}} = -\\frac{1}{2}\\sum_{\\boldsymbol{\\delta}} J(\\boldsymbol{\\delta})(-1)^{\\Delta x+\\Delta y}$.\n- **Stripe-x (index $2$)**: $s_{x,y}=(-1)^{x}$. The ordering vector is $\\mathbf{k}=(\\pi,0)$. The spin product is $s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} = (-1)^{\\Delta x}$. The energy is $\\varepsilon_{\\text{Stripe-x}} = -\\frac{1}{2}\\sum_{\\boldsymbol{\\delta}} J(\\boldsymbol{\\delta})(-1)^{\\Delta x}$.\n- **Stripe-y (index $3$)**: $s_{x,y}=(-1)^{y}$. The ordering vector is $\\mathbf{k}=(0,\\pi)$. The spin product is $s_{\\mathbf{R}}s_{\\mathbf{R}+\\boldsymbol{\\delta}} = (-1)^{\\Delta y}$. The energy is $\\varepsilon_{\\text{Stripe-y}} = -\\frac{1}{2}\\sum_{\\boldsymbol{\\delta}} J(\\boldsymbol{\\delta})(-1)^{\\Delta y}$.\n\nThe ground state among these candidates is the one with the minimum energy.\n\nThe mean-field critical temperature, $T_c$, is determined by the stability of the high-temperature disordered phase. A concentration wave of wave vector $\\mathbf{q}$ becomes unstable when the corresponding susceptibility diverges. This occurs when the condition $k_{\\mathrm{B}}T = \\tilde{J}(\\mathbf{q})$ is met, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\tilde{J}(\\mathbf{q})$ is the lattice Fourier transform of the interaction matrix:\n$$\n\\tilde{J}(\\mathbf{q}) = \\sum_{\\boldsymbol{\\delta}\\neq\\mathbf{0}} J(\\boldsymbol{\\delta}) e^{-i\\mathbf{q}\\cdot\\boldsymbol{\\delta}}\n$$\nGiven the enforced symmetry $J(\\boldsymbol{\\delta}) = J(-\\boldsymbol{\\delta})$, this simplifies to a cosine series:\n$$\n\\tilde{J}(\\mathbf{q}) = \\sum_{\\boldsymbol{\\delta}\\neq\\mathbf{0}} J(\\boldsymbol{\\delta}) \\cos(\\mathbf{q}\\cdot\\boldsymbol{\\delta})\n$$\nThe physical transition temperature $T_c$ corresponds to the first instability to appear upon cooling, which is governed by the global maximum of the interaction eigenvalue spectrum. Thus:\n$$\nk_{\\mathrm{B}}T_c = \\max_{\\mathbf{q}} \\left\\{ \\tilde{J}(\\mathbf{q}) \\right\\}\n$$\nThe maximization is performed over all wave vectors $\\mathbf{q}$ in the first Brillouin zone.\n\n**2. Computational Procedure**\n\nThe algorithm to solve the problem is as follows:\n\n1.  **Interaction Generation**: For each test case, we first construct the full \"true\" interaction potential $J(\\boldsymbol{\\delta})$ as a dictionary mapping displacement vectors $\\boldsymbol{\\delta}=(\\Delta x, \\Delta y)$ to their interaction energy values. This is done by iterating over all integer coordinates $(\\Delta x, \\Delta y)$ such that their Euclidean norm $r = \\sqrt{(\\Delta x)^2+(\\Delta y)^2}$ satisfies $0  r \\le 4.0$. The rules specified for each test case are applied sequentially to determine the values of $J(\\boldsymbol{\\delta})$, respecting the precedence of rules and the handling of additive or overriding assignments. The symmetry $J(\\boldsymbol{\\delta}) = J(-\\boldsymbol{\\delta})$ is inherent in the provided formulae.\n\n2.  **Convergence Loop**: For each test case, we iterate through the prescribed sequence of real-space cutoffs $R_c \\in \\{1.0, 1.5, 2.0, 3.0, 4.0\\}$.\n    - **Truncation**: A truncated interaction dictionary, $J_{\\text{trunc}}$, is created for each $R_c$ by including only those pairs $(\\boldsymbol{\\delta}, J(\\boldsymbol{\\delta}))$ from the true potential for which $r \\le R_c$.\n\n3.  **Ground State Calculation**: For each $J_{\\text{trunc}}$:\n    - We calculate the energies $\\varepsilon_{\\text{FM}}$, $\\varepsilon_{\\text{AFM}}$, $\\varepsilon_{\\text{Stripe-x}}$, and $\\varepsilon_{\\text{Stripe-y}}$ using the formulae derived above, summing over all pairs in $J_{\\text{trunc}}$.\n    - The ground state is identified by finding the minimum among these four energies. The corresponding index ($0$, $1$, $2$, or $3$) is recorded.\n\n4.  **Critical Temperature Calculation**: For each $J_{\\text{trunc}}$:\n    - The wave vector $\\mathbf{q}$ is discretized on a grid corresponding to the reciprocal lattice of an $L \\times L$ supercell with $L=32$. The allowed vectors are $\\mathbf{q} = (\\frac{2\\pi n_x}{L}, \\frac{2\\pi n_y}{L})$ for integers $n_x, n_y \\in [0, L-1]$.\n    - A real-space grid `J_grid` of size $L \\times L$ is constructed. For each pair $(\\boldsymbol{\\delta}, J(\\boldsymbol{\\delta}))$ in $J_{\\text{trunc}}$ with $\\boldsymbol{\\delta}=(\\Delta x, \\Delta y)$, the value $J(\\boldsymbol{\\delta})$ is placed at the grid index `(dy % L, dx % L)`. The interaction at the origin, $J(\\mathbf{0})$, is zero.\n    - The two-dimensional Fast Fourier Transform (FFT) is applied to `J_grid` to compute $\\tilde{J}(\\mathbf{q})$ for all discretized $\\mathbf{q}$ vectors simultaneously.\n    - The maximum real part of the resulting FFT array gives $J_{\\text{max}} = \\max_{\\mathbf{q}} \\tilde{J}(\\mathbf{q})$.\n    - The critical temperature is then calculated as $T_c = J_{\\text{max}} / k_{\\mathrm{B}}$, where $k_{\\mathrm{B}} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$. The result is converted to Kelvin and rounded to one decimal place.\n\nThis procedure is repeated for all cutoffs and all test cases, and the results are aggregated into the specified output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the cluster expansion convergence problem for three test cases.\n    \"\"\"\n    k_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    L = 32\n    cutoffs = [1.0, 1.5, 2.0, 3.0, 4.0]\n    max_dist = 4.0\n\n    test_cases_params = [\n        # Test Case A\n        {\n            'base': {\n                (1, 0): -0.030, (0, 1): -0.030,\n                (1, 1): 0.004,\n                (2, 0): -0.002, (0, 2): -0.002,\n            },\n            'additive': {},\n            'tail': lambda dx, dy, r: 0.001 * ((-1)**(dx + dy)) / (r**3)\n        },\n        # Test Case B\n        {\n            'base': {\n                (1, 0): 0.010, (0, 1): 0.010,\n                (1, 1): -0.007,\n                (2, 0): -0.002, (0, 2): -0.002,\n            },\n            'additive': {},\n            'tail': lambda dx, dy, r: 0.0008 * ((-1)**dx) / (r**3)\n        },\n        # Test Case C\n        {\n            'base': {\n                (1, 0): 0.001, (0, 1): 0.001,\n            },\n            'additive': {\n                (dx, 0): (0.004 * ((-1)**dx)) / (abs(dx)**2) for dx in range(1, 5)\n            },\n            'tail': lambda dx, dy, r: 0.0005 * ((-1)**dx) / (1 + r**2)\n        }\n    ]\n\n    final_results = []\n\n    for params in test_cases_params:\n        # 1. Generate the full \"true\" interaction dictionary\n        j_true = {}\n        assigned_pairs = set()\n\n        # Apply base interactions\n        for (dx, dy), val in params['base'].items():\n            for sdx in [dx, -dx]:\n                for sdy in [dy, -dy]:\n                    if sdx != 0 or sdy != 0:\n                        j_true[(sdx, sdy)] = val\n                        assigned_pairs.add(tuple(sorted((abs(sdx), abs(sdy)))) if sdx*sdy != 0 else (abs(sdx),abs(sdy)))\n\n        # Apply additive interactions\n        for (dx, dy), add_val in params['additive'].items():\n            for sdx in [dx, -dx]:\n                if (sdx, dy) not in j_true:\n                    j_true[(sdx, dy)] = 0.0\n                j_true[(sdx, dy)] += add_val\n                assigned_pairs.add(tuple(sorted((abs(sdx),abs(dy)))) if sdx*dy != 0 else (abs(sdx),abs(dy)))\n\n\n        # Apply tail interactions\n        max_coord = int(np.ceil(max_dist))\n        for dx in range(-max_coord, max_coord + 1):\n            for dy in range(-max_coord, max_coord + 1):\n                if dx == 0 and dy == 0:\n                    continue\n                \n                r = np.sqrt(dx**2 + dy**2)\n                if r > max_dist:\n                    continue\n\n                canonical_pair = tuple(sorted((abs(dx),abs(dy)))) if dx*dy != 0 else (abs(dx),abs(dy))\n                if canonical_pair not in assigned_pairs:\n                    val = params['tail'](dx, dy, r)\n                    if (dx, dy) not in j_true:\n                       j_true[(dx, dy)] = val\n\n        # Ensure symmetry J(d) = J(-d) for all pairs\n        all_deltas = list(j_true.keys())\n        for dx, dy in all_deltas:\n            val = j_true.get((dx, dy))\n            if (-dx, -dy) not in j_true:\n                j_true[(-dx, -dy)] = val\n\n        gs_indices = []\n        tc_values = []\n\n        # 2. Loop through cutoffs\n        for r_c in cutoffs:\n            j_truncated = {\n                delta: val for delta, val in j_true.items() \n                if np.sqrt(delta[0]**2 + delta[1]**2) = r_c\n            }\n            if not j_truncated:\n                gs_indices.append(0) # Or handle as error\n                tc_values.append(0.0)\n                continue\n\n            # 3. Calculate ground state energy\n            energies = [0.0, 0.0, 0.0, 0.0]\n            for (dx, dy), val in j_truncated.items():\n                energies[0] += val  # FM\n                energies[1] += val * ((-1)**(dx + dy))  # Checkerboard\n                energies[2] += val * ((-1)**dx)  # Stripe-x\n                energies[3] += val * ((-1)**dy)  # Stripe-y\n            \n            energies = [-0.5 * e for e in energies]\n            gs_index = np.argmin(energies)\n            gs_indices.append(gs_index)\n\n            # 4. Calculate critical temperature\n            j_grid = np.zeros((L, L), dtype=float)\n            for (dx, dy), val in j_truncated.items():\n                j_grid[dy % L, dx % L] += val\n            \n            j_fourier = np.fft.fft2(j_grid)\n            j_max = np.max(np.real(j_fourier))\n            \n            tc = 0.0\n            if j_max > 0:\n                tc = j_max / k_B\n            \n            tc_values.append(round(tc, 1))\n\n        final_results.append(f\"[[{','.join(map(str, gs_indices))}],[{','.join(map(str, tc_values))}]]\")\n\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "2844973"}]}