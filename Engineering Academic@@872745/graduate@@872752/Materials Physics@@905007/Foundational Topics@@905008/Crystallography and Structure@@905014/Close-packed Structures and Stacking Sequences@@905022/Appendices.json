{"hands_on_practices": [{"introduction": "The face-centered cubic (fcc) and hexagonal close-packed (hcp) structures represent the two simplest and most common ways to achieve the densest possible packing of identical spheres. This fundamental exercise challenges you to derive, from first principles, the key geometric relationships that define these structures. By relating the sphere radius $r$ to the conventional lattice parameters and calculating the packing fraction, you will rigorously demonstrate why both structures, despite their different stacking sequences, share the same maximal packing density [@problem_id:2808480].", "problem": "A monatomic crystal is modeled as a dense packing of identical rigid spheres of radius $r$ arranged in close-packed stacking sequences. Consider the two canonical close-packed structures: Face-Centered Cubic (fcc) with ABC stacking and Hexagonal Close-Packed (hcp) with AB stacking. For the fcc structure, let $a_{\\mathrm{fcc}}$ denote the conventional cubic lattice parameter. For the hcp structure, let $a_{\\mathrm{hcp}}$ denote the basal-plane lattice parameter and $c$ denote the out-of-plane lattice parameter of the conventional hexagonal unit cell. Starting from the geometric definition of close-packed triangular layers of touching spheres and the conventional definitions of $a_{\\mathrm{fcc}}$, $a_{\\mathrm{hcp}}$, and $c$, do the following without invoking any pre-memorized structure-specific formulas:\n\n- Derive the relationships between $r$ and $a_{\\mathrm{fcc}}$ for the fcc structure, and between $r$ and $a_{\\mathrm{hcp}}$ for the hcp structure.\n- Using the hard-sphere stacking geometry, determine the ideal ratio $c/a_{\\mathrm{hcp}}$ for the hcp structure.\n- Using only geometric facts and the above relations, compute the packing fraction $\\eta$ (the fraction of unit-cell volume occupied by the spheres) for each conventional unit cell and demonstrate that the two values coincide. Express the common analytic value.\n\nReport your final result as a single row matrix containing, in order, the three exact expressions $\\left(r/a_{\\mathrm{fcc}},\\, r/a_{\\mathrm{hcp}},\\, \\eta\\right)$. Do not round. No units are required because all quantities are dimensionless ratios or pure numbers.", "solution": "The problem statement presented is a standard, well-posed exercise in solid-state physics and crystallography. It is scientifically grounded, self-contained, and free of contradictions or ambiguities. It requests fundamental derivations based on geometric first principles, which is a valid and instructive task. We may proceed with the solution.\n\nThe problem requires the derivation of geometric relationships and the packing fraction for the Face-Centered Cubic (fcc) and Hexagonal Close-Packed (hcp) structures, modeling atoms as identical rigid spheres of radius $r$.\n\nFirst, we analyze the fcc structure. The conventional unit cell is a cube with lattice parameter $a_{\\mathrm{fcc}}$. Atoms are located at the $8$ corners and in the center of the $6$ faces. In a close-packed structure, the spheres are in contact. Within the fcc unit cell, the spheres touch along the face diagonal. A face diagonal connects two opposite corners of a face, passing through the atom at the face center. The length of this diagonal accommodates the radius of the corner atom, the diameter of the face-centered atom, and the radius of the other corner atom. Thus, the length of the face diagonal is $r + 2r + r = 4r$.\nFrom the geometry of a cube with side length $a_{\\mathrm{fcc}}$, the length of the face diagonal is given by the Pythagorean theorem: $\\sqrt{a_{\\mathrm{fcc}}^2 + a_{\\mathrm{fcc}}^2} = a_{\\mathrm{fcc}}\\sqrt{2}$.\nEquating these two expressions for the face diagonal length gives:\n$$a_{\\mathrm{fcc}}\\sqrt{2} = 4r$$\nThis establishes the relationship between the sphere radius $r$ and the lattice parameter $a_{\\mathrm{fcc}}$. From this, we derive the requested ratio $r/a_{\\mathrm{fcc}}$:\n$$\\frac{r}{a_{\\mathrm{fcc}}} = \\frac{\\sqrt{2}}{4} = \\frac{1}{2\\sqrt{2}}$$\n\nNext, we analyze the hcp structure. An hcp structure is formed by stacking close-packed planes in an ABAB... sequence. The conventional unit cell is a right prism with a hexagonal base. The lattice parameters are $a_{\\mathrm{hcp}}$ for the side length of the hexagonal base and $c$ for the height of the prism.\nIn the basal plane (e.g., the A layer), the atoms are arranged in a close-packed triangular lattice. The centers of adjacent, touching spheres are separated by a distance of $2r$. This distance corresponds to the lattice parameter $a_{\\mathrm{hcp}}$.\n$$a_{\\mathrm{hcp}} = 2r$$\nFrom this, the ratio $r/a_{\\mathrm{hcp}}$ is immediately:\n$$\\frac{r}{a_{\\mathrm{hcp}}} = \\frac{1}{2}$$\n\nNow, we determine the ideal ratio $c/a_{\\mathrm{hcp}}$. This ratio is determined by the spacing between the close-packed planes. A sphere in the B layer rests in the hollow formed by three touching spheres in the A layer. Let the centers of the three spheres in the A layer be at positions $A_1$, $A_2$, and $A_3$, and the center of the sphere in the B layer be at position $B$. These four points form a regular tetrahedron, as all spheres are in contact. The edge length of this tetrahedron is the distance between the centers of any two touching spheres, which is $2r = a_{\\mathrm{hcp}}$.\nThe height of this tetrahedron is the perpendicular distance from the B layer to the A layer, which is exactly half the height of the conventional unit cell, $c/2$.\nWe can calculate the height of a regular tetrahedron with side length $s = a_{\\mathrm{hcp}}$. The apex of the tetrahedron (point $B$) projects onto the center (centroid) of the equilateral triangular base formed by $A_1$, $A_2$, and $A_3$. The distance from any vertex of an equilateral triangle of side $s$ to its centroid is $d = \\frac{s}{\\sqrt{3}}$.\nUsing the Pythagorean theorem, the height $h_t$ of the tetrahedron satisfies $s^2 = h_t^2 + d^2$.\n$$h_t^2 = s^2 - \\left(\\frac{s}{\\sqrt{3}}\\right)^2 = s^2 - \\frac{s^2}{3} = \\frac{2s^2}{3}$$\n$$h_t = s\\sqrt{\\frac{2}{3}}$$\nSubstituting $h_t = c/2$ and $s = a_{\\mathrm{hcp}}$:\n$$\\frac{c}{2} = a_{\\mathrm{hcp}}\\sqrt{\\frac{2}{3}}$$\nThis gives the ideal $c/a_{\\mathrm{hcp}}$ ratio:\n$$\\frac{c}{a_{\\mathrm{hcp}}} = 2\\sqrt{\\frac{2}{3}} = \\sqrt{\\frac{8}{3}}$$\n\nFinally, we compute the packing fraction, $\\eta$, for both structures. The packing fraction is defined as the total volume of spheres within a unit cell divided by the volume of the unit cell itself, $\\eta = N V_{\\text{sphere}} / V_{\\text{cell}}$. The volume of a single sphere is $V_{\\text{sphere}} = \\frac{4}{3}\\pi r^3$.\n\nFor the fcc structure:\nThe number of atoms per conventional unit cell, $N_{\\mathrm{fcc}}$, is $8$ corner atoms $\\times$ ($1/8$ per cell) + $6$ face atoms $\\times$ ($1/2$ per cell) = $1 + 3 = 4$.\nThe volume of the unit cell is $V_{\\mathrm{fcc}} = a_{\\mathrm{fcc}}^3$. Using our derived relation $a_{\\mathrm{fcc}} = 2\\sqrt{2}r$:\n$$V_{\\mathrm{fcc}} = (2\\sqrt{2}r)^3 = 8 \\cdot 2\\sqrt{2} r^3 = 16\\sqrt{2}r^3$$\nThe packing fraction $\\eta_{\\mathrm{fcc}}$ is:\n$$\\eta_{\\mathrm{fcc}} = \\frac{N_{\\mathrm{fcc}} V_{\\text{sphere}}}{V_{\\mathrm{fcc}}} = \\frac{4 \\cdot \\frac{4}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\frac{16}{3}\\pi r^3}{16\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\n\nFor the hcp structure:\nThe number of atoms per conventional hexagonal unit cell, $N_{\\mathrm{hcp}}$, is $12$ corner atoms $\\times$ ($1/6$ per cell) + $2$ face-center atoms $\\times$ ($1/2$ per cell) + $3$ interior atoms = $2 + 1 + 3 = 6$.\nThe volume of the hexagonal unit cell, $V_{\\mathrm{hcp}}$, is the area of its hexagonal base multiplied by its height $c$. The base is composed of $6$ equilateral triangles of side length $a_{\\mathrm{hcp}}$. The area of one such triangle is $\\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2$.\nThe area of the base is $A_{\\text{base}} = 6 \\cdot \\frac{\\sqrt{3}}{4} a_{\\mathrm{hcp}}^2 = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2$.\nThe cell volume is $V_{\\mathrm{hcp}} = A_{\\text{base}} \\cdot c = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\cdot c$.\nUsing $c = a_{\\mathrm{hcp}}\\sqrt{8/3}$:\n$$V_{\\mathrm{hcp}} = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^2 \\left( a_{\\mathrm{hcp}}\\sqrt{\\frac{8}{3}} \\right) = \\frac{3\\sqrt{3}}{2} a_{\\mathrm{hcp}}^3 \\frac{2\\sqrt{2}}{\\sqrt{3}} = 3\\sqrt{2} a_{\\mathrm{hcp}}^3$$\nNow substitute $a_{\\mathrm{hcp}} = 2r$:\n$$V_{\\mathrm{hcp}} = 3\\sqrt{2} (2r)^3 = 3\\sqrt{2} \\cdot 8r^3 = 24\\sqrt{2}r^3$$\nThe packing fraction $\\eta_{\\mathrm{hcp}}$ is:\n$$\\eta_{\\mathrm{hcp}} = \\frac{N_{\\mathrm{hcp}} V_{\\text{sphere}}}{V_{\\mathrm{hcp}}} = \\frac{6 \\cdot \\frac{4}{3}\\pi r^3}{24\\sqrt{2}r^3} = \\frac{8\\pi r^3}{24\\sqrt{2}r^3} = \\frac{\\pi}{3\\sqrt{2}}$$\nAs demonstrated, the packing fractions are identical: $\\eta_{\\mathrm{fcc}} = \\eta_{\\mathrm{hcp}} = \\frac{\\pi}{3\\sqrt{2}}$. This result is expected, as both fcc and hcp are different stacking sequences of the same close-packed planes, leading to the same maximum possible packing density for identical spheres.\n\nThe final result is the ordered set of expressions for $r/a_{\\mathrm{fcc}}$, $r/a_{\\mathrm{hcp}}$, and the common packing fraction $\\eta$.\n$r/a_{\\mathrm{fcc}} = \\frac{\\sqrt{2}}{4}$\n$r/a_{\\mathrm{hcp}} = \\frac{1}{2}$\n$\\eta = \\frac{\\pi}{3\\sqrt{2}}$\nThese are the required exact analytical values.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{4}  \\frac{1}{2}  \\frac{\\pi}{3\\sqrt{2}} \\end{pmatrix}}$$", "id": "2808480"}, {"introduction": "Beyond the ideal fcc and hcp structures, many materials exhibit complex, long-period stacking sequences known as polytypes. This practice moves from ideal cases to the systematic analysis of such structures, using a hypothetical periodic sequence as an example. You will determine the sequence's minimal repeating period and, by applying principles of translational symmetry, deduce its Bravais lattice type, culminating in the assignment of its formal Ramsdell notation [@problem_id:2808431].", "problem": "A close-packed crystal is built by stacking identical two-dimensional hexagonal layers along a single axis. The allowed lateral registries of a layer relative to the one below are the three distinct sites $A$, $B$, and $C$, with the rule that no two adjacent layers may occupy the same registry. Consider an experimentally inferred infinite stacking described by the fragment\n$$\nA\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C\\,\\ldots\n$$\nwhich continues periodically without defect. Starting only from the definitions of close-packed stacking and three-dimensional translational symmetry, determine the minimal repeating period $n$ (the smallest positive integer $n$ such that the sequence of layer registries repeats exactly after $n$ layers), and from this deduce the Ramsdell notation, which consists of the integer $n$ followed by a letter indicating the Bravais lattice type: hexagonal ($H$), cubic ($C$), or rhombohedral ($R$). Do not use any tabulated polytype catalogs or pre-memorized classification rules; instead, reason from first principles about how the stacking operations compose and how translational symmetry constrains the Bravais lattice.\n\nAs your final numerical answer, report only the integer minimal repeating period $n$. Provide the exact integer (no rounding).", "solution": "The problem requires an analysis of a given infinite, periodic stacking sequence of close-packed hexagonal layers to determine its minimal repeating period, $n$, and its Bravais lattice type, leading to the Ramsdell notation. The analysis must be based on first principles.\n\nThe given stacking sequence fragment is $A\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C\\ldots$. The layers are stacked along an axis, say the $z$-axis, and the labels $A, B, C$ denote the three possible lateral registries of the layers. The rule is that adjacent layers cannot have the same registry, e.g., no $AA$ or $BB$ stackings.\n\n**Step 1: Determination of the Minimal Period $n$**\n\nThe problem states that the sequence continues periodically. This implies that the given fragment is a repeating unit or contains one or more repeating units. Let the sequence be denoted by $S = (S_1, S_2, S_3, \\ldots)$. The minimal period $n$ is the smallest positive integer such that $S_{k+n} = S_k$ for all $k \\ge 1$.\n\nThe given fragment is $U = A\\,B\\,A\\,B\\,C\\,B\\,C\\,A\\,C$. It has a length of $9$. Let us assume this is the repeating unit, so the full sequence is $U, U, U, \\ldots$. This implies a period of $n=9$. We must verify that this is the *minimal* period. A period $p  9$ would imply that the prefix of length $p$ repeats to form the sequence. Let's check for all possible periods $p \\in \\{1, 2, \\ldots, 8\\}$.\n\nA sequence has period $p$ if $S_k = S_{k+p}$ for all $k$. We check this condition against the given fragment $U = S_1 S_2 \\ldots S_9$.\n- $p=1$: $S_1=A, S_2=B$. $S_1 \\neq S_2$. Period is not $1$.\n- $p=2$: $S_1=A, S_3=A$. This is consistent. However, $S_3=A, S_5=C$. $S_3 \\neq S_5$. Period is not $2$.\n- $p=3$: $S_1=A, S_4=B$. $S_1 \\neq S_4$. Period is not $3$.\n- $p=4$: $S_1=A, S_5=C$. $S_1 \\neq S_5$. Period is not $4$.\n- $p=5$: $S_1=A, S_6=B$. $S_1 \\neq S_6$. Period is not $5$.\n- $p=6$: $S_1=A, S_7=C$. $S_1 \\neq S_7$. Period is not $6$.\n- $p=7$: $S_2=B, S_9=C$. $S_2 \\neq S_9$. Period is not $7$.\n- $p=8$: $S_1=A, S_9=C$. $S_1 \\neq S_9$. Period is not $8$.\n\nSince no integer $p  9$ is a period of the sequence defined by the fragment, the minimal period must be $n=9$.\n\n**Step 2: Determination of the Bravais Lattice Type**\n\nThe Bravais lattice of a close-packed structure is either Hexagonal ($H$) or Rhombohedral ($R$). The cubic case ($C$) is a special, higher-symmetry instance of the rhombohedral lattice. The distinction between $H$ and $R$ is a matter of three-dimensional translational symmetry.\n\nLet the 2D hexagonal layers lie in the $xy$-plane. The lattice vectors of this 2D hexagonal net are $\\vec{a}_1$ and $\\vec{a}_2$. The lateral registries $A, B, C$ can be represented by fractional coordinate vectors within the 2D unit cell. A standard choice is:\n$$\n\\vec{\\tau}_A = (0,0) \\quad ; \\quad \\vec{\\tau}_B = \\left(\\frac{1}{3}, \\frac{2}{3}\\right) \\quad ; \\quad \\vec{\\tau}_C = \\left(\\frac{2}{3}, \\frac{1}{3}\\right)\n$$\nThese vectors represent shifts relative to a common origin. Note that $\\vec{\\tau}_A+\\vec{\\tau}_B+\\vec{\\tau}_C = (1,1)$, which is a 2D lattice vector, so $\\vec{\\tau}_C \\equiv -(\\vec{\\tau}_A+\\vec{\\tau}_B)$ modulo the lattice. We can model the types as elements of the cyclic group $\\mathbb{Z}_3$: $A \\equiv 0$, $B \\equiv 1$, $C \\equiv 2$. With this, $\\vec{\\tau}_B + \\vec{\\tau}_B = 2\\vec{\\tau}_B = (2/3, 4/3) \\equiv (2/3, 1/3) = \\vec{\\tau}_C$. Similarly, $\\vec{\\tau}_B + \\vec{\\tau}_C = (1,1) \\equiv (0,0) = \\vec{\\tau}_A$. Hence, addition of layer types corresponds to vector addition of their registry vectors modulo the 2D lattice.\n\nA structure has a rhombohedral Bravais lattice if and only if there are centering translations in its hexagonal cell description. A necessary condition is that the stacking period $n$ must be a multiple of $3$. In our case, $n=9$, so this condition is met.\n\nThe rhombohedral centering implies the existence of a translational symmetry vector of the form $\\vec{v} = \\vec{t} + \\frac{c}{3}\\hat{z}$, where $c$ is the height of the hexagonal unit cell ($c=nc_0$, with $c_0$ being the spacing between layers) and $\\vec{t}$ is a centering vector in the $xy$-plane. For the reverse (\"R\") setting, $\\vec{t}$ can be $\\vec{\\tau}_B$ or for the obverse setting, $\\vec{\\tau}_C$. Let's test for the existence of such a symmetry.\n\nWe test if a translation by $\\vec{v} = \\vec{\\tau}_B + \\frac{nc_0}{3}\\hat{z}$ maps the crystal onto itself. Let an atom be in layer $k$ of type $S_k$. Its position is $\\vec{p} = \\vec{R}_{2D} + \\vec{\\tau}_{S_k} + (k-1)c_0\\hat{z}$, where $\\vec{R}_{2D}$ is a 2D lattice vector.\nApplying the translation $\\vec{v}$ to $\\vec{p}$:\n$$\n\\vec{p}' = \\vec{p} + \\vec{v} = \\vec{R}_{2D} + \\vec{\\tau}_{S_k} + (k-1)c_0\\hat{z} + \\vec{\\tau}_B + \\frac{n}{3}c_0\\hat{z}\n$$\n$$\n\\vec{p}' = \\vec{R}_{2D} + (\\vec{\\tau}_{S_k} + \\vec{\\tau}_B) + \\left(k-1+\\frac{n}{3}\\right)c_0\\hat{z}\n$$\nThe new position $\\vec{p}'$ is in layer $k' = k + n/3$. For $\\vec{v}$ to be a lattice vector, $\\vec{p}'$ must be a valid position for an atom of the same type as the original atom at $\\vec{p}$. However, the basis of a rhombohedral cell is smaller. A translation by a lattice vector takes an atom to an equivalent site, which must have an identical environment. This means the type of atom might change according to the basis. The condition for the Bravais lattice to be rhombohedral is that the entire crystal structure is invariant under this translation.\nThis requires that the point $\\vec{p}'$ corresponds to an atomic site in the crystal. This means the layer type at $k'$ must be consistent with the lateral shift. That is, the position $\\vec{R}_{2D} + (\\vec{\\tau}_{S_k} + \\vec{\\tau}_B)$ must be a site for an atom of type $S_{k+n/3}$. This will be true if:\n$$\n\\vec{\\tau}_{S_k} + \\vec{\\tau}_B \\equiv \\vec{\\tau}_{S_{k+n/3}} \\pmod{\\text{2D lattice}}\n$$\nThis must hold for all layers $k$ in the period. Using the $\\mathbb{Z}_3$ representation, this is $S_k + 1 \\equiv S_{k+n/3} \\pmod 3$.\n\nLet's test this for our sequence. $n=9$, so $n/3=3$. The layer types are $S = (A,B,A,B,C,B,C,A,C)$ or in $\\mathbb{Z}_3$: $S = (0,1,0,1,2,1,2,0,2)$. We check if $S_{k+3} \\equiv S_k+1 \\pmod 3$ for $k=1, \\ldots, 9$.\n- $k=1$: $S_4 = 1$. $S_1+1 = 0+1=1$. (Correct)\n- $k=2$: $S_5 = 2$. $S_2+1 = 1+1=2$. (Correct)\n- $k=3$: $S_6 = 1$. $S_3+1 = 0+1=1$. (Correct)\n- $k=4$: $S_7 = 2$. $S_4+1 = 1+1=2$. (Correct)\n- $k=5$: $S_8 = 0$. $S_5+1 = 2+1=3 \\equiv 0$. (Correct)\n- $k=6$: $S_9 = 2$. $S_6+1 = 1+1=2$. (Correct)\n- $k=7$: $S_{10}=S_1=0$. $S_7+1 = 2+1=3 \\equiv 0$. (Correct)\n- $k=8$: $S_{11}=S_2=1$. $S_8+1 = 0+1=1$. (Correct)\n- $k=9$: $S_{12}=S_3=0$. $S_9+1 = 2+1=3 \\equiv 0$. (Correct)\n\nThe condition holds for all $k$. This confirms the existence of the rhombohedral centering translation. Therefore, the Bravais lattice is Rhombohedral ($R$).\nThe Ramsdell notation is the integer $n$ followed by the letter for the lattice type. For this structure, it is $9R$.\n\nThe problem asks for the minimal repeating period $n$. Based on our analysis, this is $n=9$.", "answer": "$$\n\\boxed{9}\n$$", "id": "2808431"}, {"introduction": "The stability of different stacking sequences is ultimately governed by energy. This advanced practice connects crystallographic structure to a key physical property: the intrinsic stacking fault energy ($\\gamma_{\\text{ISF}}$), the energy cost of creating the simplest planar defect in an fcc crystal. You will perform a task common in modern computational materials science by analyzing a provided set of hypothetical Density Functional Theory (DFT) data, accounting for finite-size effects to extrapolate the true bulk value of $\\gamma_{\\text{ISF}}$ [@problem_id:2808552].", "problem": "You are given three Density Functional Theory (DFT) pseudopotential datasets for face-centered cubic (fcc) close-packed slabs built along the $\\{111\\}$ planes. Each slab contains a single intrinsic stacking fault embedded in vacuum. Your task is to compute the intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$ of each material by extrapolating the excess energy per area to infinite slab thickness using fundamental definitions and finite-size corrections consistent with isotropic linear elasticity.\n\nDefinition and physical base:\n- In a close-packed fcc lattice, the ideal stacking sequence along $\\langle 111 \\rangle$ is $ABCABC\\ldots$. An intrinsic stacking fault is a local disruption of this sequence that can be viewed as the removal of a close-packed plane, e.g., $ABCACABC\\ldots$.\n- The intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$ is defined as the excess energy per unit area of a crystal containing a single intrinsic fault relative to the perfect crystal,\n  $$\n  \\gamma_{\\text{ISF}} \\equiv \\lim_{L \\to \\infty} \\frac{E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)}{m A},\n  $$\n  where $E_{\\text{fault}}(L)$ and $E_{\\text{perfect}}(L)$ are the total energies of a slab of thickness $L$ (measured along the stacking direction), $A$ is the in-plane area of the two-dimensional primitive cell of the $\\{111\\}$ plane, and $m$ is the number of stacking faults contained in the periodic supercell. In the provided datasets, $m=1$ for all cases. Because both structures have the same free surfaces, the difference $E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)$ removes surface energy and surface stress to leading order.\n- For a single-fault slab with traction-free parallel surfaces, the residual finite-size correction to the excess energy density arises from the long-range elastic field reflected by the free surfaces. Mirror symmetry about the slab midplane implies that only odd inverse powers of $L$ enter in the far-field expansion. Thus, the excess energy density admits an asymptotic expansion,\n  $$\n  \\frac{E_{\\text{fault}}(L) - E_{\\text{perfect}}(L)}{m A} = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right),\n  $$\n  where $\\gamma_{\\infty} \\equiv \\gamma_{\\text{ISF}}$ is the infinite-thickness limit that you must determine, and $c_1$, $c_3$ are material-dependent coefficients that encode elastic image interactions.\n\nGeometric base:\n- For an fcc lattice with cubic lattice parameter $a$, the interplanar spacing for $\\{111\\}$ planes is $d_{111} = a/\\sqrt{3}$, and the in-plane area of the two-dimensional primitive cell of the $\\{111\\}$ plane is $A = (\\sqrt{3}/2)\\,a^2$.\n- For a slab composed of $n$ close-packed planes, the thickness is $L = n\\,d_{111}$.\n\nComputational task:\n- For each dataset below, use the fundamental definition to compute the raw excess energy densities,\n  $$\n  \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{m A},\n  $$\n  for the given sequence of thicknesses $L_i$ associated with the listed numbers of layers $n_i$.\n- Then, using the asymptotic expansion above grounded in isotropic linear elasticity and symmetry, determine $\\gamma_{\\infty}$ by performing a least-squares fit of $\\gamma(L)$ versus the basis $\\{1, 1/L, 1/L^3\\}$ across the provided values of $L$.\n- Report $\\gamma_{\\infty}$ in millijoules per square meter (mJ/m$^2$), rounded to three decimal places. Use the exact conversion factor $1~\\text{J/m}^2 = 0.06241509~\\text{eV}/\\text{\\AA}^2$. Angles are not used in this problem.\n- All energies are given in electronvolts (eV), lengths in Angstroms ($\\text{\\AA}$), and areas in square Angstroms ($\\text{\\AA}^2$). Express final answers in mJ/m$^2$, rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3]$), where each $x_k$ is the rounded value of $\\gamma_{\\infty}$ for dataset $k$.\n\nTest suite (all datasets have $m=1$):\n\nDataset 1:\n- Cubic lattice parameter: $a = 4.05~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [8, 10, 14, 18, 24]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]$.\n\nDataset 2:\n- Cubic lattice parameter: $a = 3.60~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [12, 16, 20, 28, 36]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]$.\n\nDataset 3:\n- Cubic lattice parameter: $a = 3.30~\\text{\\AA}$.\n- Numbers of close-packed layers: $n = [10, 12, 15, 22, 30]$.\n- Perfect slab total energies (eV): $E_{\\text{perfect}} = [-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]$.\n- Faulted slab total energies (eV): $E_{\\text{fault}} = [-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]$.\n\nRequirements to ensure universal applicability:\n- Do not assume any external file input; the data above are embedded in your code.\n- Use only algebra, geometry of the fcc lattice, and least-squares regression to implement the extrapolation.\n- The final output must be a single line containing a Python list with three floating-point numbers representing $\\gamma_{\\infty}$ for the three datasets in mJ/m$^2$, each rounded to three decimals, with no units included in the output line.", "solution": "The problem as stated is subjected to validation. All givens, including the physical definitions, governing equations, geometric relations, material-specific data sets, and computational requirements, have been extracted and analyzed. The problem is scientifically grounded in the principles of solid-state physics and computational materials science, specifically concerning the calculation of planar defect energies. The methodology described, which involves extrapolating finite-size slab calculations to the bulk limit using an asymptotic expansion derived from elasticity theory, is a standard and well-posed procedure. The problem is objective, self-contained, and free of contradictions or ambiguities. Therefore, the problem is deemed valid and a rigorous solution will be presented.\n\nThe objective is to compute the intrinsic stacking fault energy, $\\gamma_{\\text{ISF}}$, for three distinct face-centered cubic (fcc) materials. This quantity represents the energy cost per unit area to create a stacking fault in an infinitely large crystal. We are provided with total energy data from Density Functional Theory (DFT) calculations for finite-thickness slabs, both with and without a fault. The solution requires extrapolating these finite-size results to the limit of infinite thickness.\n\nThe process for each dataset is as follows:\n\n1.  **Calculation of Geometric Parameters**: For an fcc crystal with a given cubic lattice parameter $a$, the geometry of the $\\{111\\}$ planes dictates the slab dimensions. The interplanar spacing along the $\\langle 111 \\rangle$ direction is $d_{111} = a/\\sqrt{3}$. The two-dimensional primitive cell of a $\\{111\\}$ plane has an area $A = (\\sqrt{3}/2)a^2$. For a slab constructed from $n$ such planes, its thickness is $L = n \\cdot d_{111}$. These parameters are computed for each material.\n\n2.  **Calculation of Finite-Size Stacking Fault Energies**: The problem provides total energies for a perfect slab, $E_{\\text{perfect}}(L_i)$, and a slab containing a single intrinsic stacking fault, $E_{\\text{fault}}(L_i)$, for several thicknesses $L_i$. The raw, or finite-size, stacking fault energy density, $\\gamma(L_i)$, is defined as the excess energy per unit area. With a single fault ($m=1$), this is:\n    $$\n    \\gamma(L_i) = \\frac{E_{\\text{fault}}(L_i) - E_{\\text{perfect}}(L_i)}{A}\n    $$\n    This calculation is performed for each available slab thickness for each material. The units of $\\gamma(L_i)$ are electronvolts per square Angstrom ($\\text{eV}/\\text{\\AA}^2$).\n\n3.  **Extrapolation to Infinite Thickness**: The interaction between the stacking fault and the free surfaces of the slab introduces a finite-size error that depends on the slab thickness $L$. Based on linear elasticity theory and the symmetry of the slab, this dependence can be expressed as an asymptotic expansion in odd inverse powers of $L$:\n    $$\n    \\gamma(L) = \\gamma_{\\infty} + \\frac{c_1}{L} + \\frac{c_3}{L^3} + \\mathcal{O}\\!\\left(\\frac{1}{L^5}\\right)\n    $$\n    Here, $\\gamma_{\\infty}$ is the desired intrinsic stacking fault energy $\\gamma_{\\text{ISF}}$, and $c_1$ and $c_3$ are coefficients related to elastic interactions. To determine $\\gamma_{\\infty}$, we fit this model to the computed data points $(\\gamma(L_i), L_i)$. This constitutes a linear least-squares regression problem. We seek the coefficients $\\beta = [\\gamma_{\\infty}, c_1, c_3]^T$ that minimize the sum of squared residuals for the system of linear equations:\n    $$\n    \\begin{pmatrix}\n    1  1/L_1  1/L_1^3 \\\\\n    1  1/L_2  1/L_2^3 \\\\\n    \\vdots  \\vdots  \\vdots \\\\\n    1  1/L_N  1/L_N^3\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    \\gamma_{\\infty} \\\\\n    c_1 \\\\\n    c_3\n    \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    \\gamma(L_1) \\\\\n    \\gamma(L_2) \\\\\n    \\vdots \\\\\n    \\gamma(L_N)\n    \\end{pmatrix}\n    $$\n    This system, denoted as $X\\beta = y$, is solved for the parameter vector $\\beta$. The first component of the solution vector, $\\beta_0$, corresponds to $\\gamma_{\\infty}$.\n\n4.  **Unit Conversion and Final Reporting**: The value of $\\gamma_{\\infty}$ obtained from the fit is in units of $\\text{eV}/\\text{\\AA}^2$. It must be converted to milli-Joules per square meter ($\\text{mJ}/\\text{m}^2$). Using the provided conversion factor $1~\\text{J/m}^2 = 0.06241509~\\text{eV/\\AA}^2$, the conversion is:\n    $$\n    \\gamma_{\\infty} [\\text{mJ/m}^2] = \\gamma_{\\infty} [\\text{eV/\\AA}^2] \\times \\frac{1}{0.06241509~\\text{eV/\\AA}^2 \\cdot \\text{m}^{-2} \\cdot \\text{J}^{-1}} \\times 1000~\\text{mJ/J}\n    $$\n    The final numerical result for each dataset is rounded to three decimal places as specified. This procedure is implemented for all three datasets to obtain the final list of results.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the intrinsic stacking fault energy (ISF) for three materials\n    by extrapolating finite-size slab DFT data to infinite thickness.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"a\": 4.05,  # Cubic lattice parameter in Angstroms\n            \"n\": np.array([8, 10, 14, 18, 24]),  # Number of layers\n            \"E_perfect\": np.array([-25.3908, -32.5908, -46.9908, -61.3908, -82.9908]),  # eV\n            \"E_fault\": np.array([-25.2098, -32.4215, -46.8309, -61.2382, -82.8424]),  # eV\n        },\n        {\n            \"a\": 3.60,\n            \"n\": np.array([12, 16, 20, 28, 36]),\n            \"E_perfect\": np.array([-42.2329, -57.4329, -72.6329, -103.0329, -133.4329]),\n            \"E_fault\": np.array([-42.2012, -57.4051, -72.6079, -103.0114, -133.4129]),\n        },\n        {\n            \"a\": 3.30,\n            \"n\": np.array([10, 12, 15, 22, 30]),\n            \"E_perfect\": np.array([-36.6048, -44.6048, -56.6048, -84.6048, -116.6048]),\n            \"E_fault\": np.array([-36.5937, -44.5957, -56.5972, -84.5994, -116.6007]),\n        },\n    ]\n\n    # Constants\n    m = 1  # Number of stacking faults in the supercell\n    # Conversion factor: 1 J/m^2 = 0.06241509 eV/A^2\n    # This implies 1 eV/A^2 = (1 / 0.06241509) J/m^2\n    eV_A2_to_mJ_m2 = (1.0 / 0.06241509) * 1000.0\n\n    results = []\n\n    for case in test_cases:\n        a = case[\"a\"]\n        n_layers = case[\"n\"]\n        E_perfect = case[\"E_perfect\"]\n        E_fault = case[\"E_fault\"]\n\n        # Step 1: Calculate geometric parameters\n        # Interplanar spacing for {111} planes\n        d_111 = a / np.sqrt(3)\n        # Area of the 2D primitive cell of the {111} plane\n        Area = (np.sqrt(3) / 2.0) * a**2\n        # Slab thickness for each n\n        L = n_layers * d_111\n\n        # Step 2: Calculate finite-size stacking fault energies (gamma(L))\n        # Energy difference between faulted and perfect slabs\n        delta_E = E_fault - E_perfect\n        # Raw SFE in eV/A^2\n        gamma_L = delta_E / (m * Area)\n\n        # Step 3: Perform least-squares fit for extrapolation\n        # Model: gamma(L) = gamma_inf + c1/L + c3/L^3\n        # We need to solve a linear system X * beta = y where beta = [gamma_inf, c1, c3]\n        \n        # Construct the design matrix X\n        # The columns are the basis functions: 1, 1/L, 1/L^3\n        X = np.vstack([np.ones_like(L), 1.0 / L, 1.0 / L**3]).T\n        \n        # The dependent variable vector y is gamma_L\n        y = gamma_L\n        \n        # Solve the least-squares problem\n        coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n        \n        # The extrapolated ISF energy is the first coefficient (the intercept)\n        gamma_inf_eV_A2 = coeffs[0]\n\n        # Step 4: Convert units and round\n        gamma_inf_mJ_m2 = gamma_inf_eV_A2 * eV_A2_to_mJ_m2\n        \n        rounded_result = round(gamma_inf_mJ_m2, 3)\n        results.append(rounded_result)\n\n    # Format the final output as a string representing a list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2808552"}]}