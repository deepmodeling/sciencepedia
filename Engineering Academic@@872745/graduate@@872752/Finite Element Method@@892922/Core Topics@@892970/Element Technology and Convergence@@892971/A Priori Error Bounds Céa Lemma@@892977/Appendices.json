{"hands_on_practices": [{"introduction": "Céa's lemma provides a powerful guarantee, but its power rests on specific mathematical foundations. This first exercise [@problem_id:2539778] focuses on these foundations, specifically the crucial role of coercivity. By analyzing different bilinear forms, you will learn to distinguish between those that satisfy the necessary conditions for the Lax-Milgram theorem and Céa's lemma, and those that do not, thereby solidifying your understanding of why these conditions are essential for a well-posed problem and a reliable error estimate.", "problem": "Let $V$ be the Sobolev space $H_0^1(0,1)$ endowed with the norm $\\lVert u \\rVert_V := \\lVert u' \\rVert_{L^2(0,1)}$. Recall the following foundational facts:\n- A bilinear form $a(\\cdot,\\cdot)$ on $V$ is said to be bounded if there exists $M \\in \\mathbb{R}_{0}$ such that $\\lvert a(u,v) \\rvert \\le M \\lVert u \\rVert_V \\lVert v \\rVert_V$ for all $u,v \\in V$.\n- A bilinear form $a(\\cdot,\\cdot)$ on $V$ is said to be coercive if there exists $\\alpha \\in \\mathbb{R}_{0}$ such that $a(u,u) \\ge \\alpha \\lVert u \\rVert_V^2$ for all $u \\in V$.\n- The Poincaré inequality on $(0,1)$ states that there exists $C_P \\in \\mathbb{R}_{0}$ such that $\\lVert u \\rVert_{L^2(0,1)} \\le C_P \\lVert u' \\rVert_{L^2(0,1)}$ for all $u \\in H_0^1(0,1)$.\n- The Lax–Milgram theorem requires boundedness and coercivity of the bilinear form to guarantee well-posedness of the variational problem. Céa’s lemma (a priori error estimate for the Galerkin method) requires, in particular, well-posedness of the continuous problem and boundedness and coercivity of the bilinear form.\n\nWhich option below exhibits a bilinear form that is bounded but not coercive on $V$, and correctly explains why Céa’s lemma cannot be applied, explicitly relating this to the failure of the Lax–Milgram theorem?\n\nA. Define $a(u,v) := \\int_0^1 u(x)\\,v(x)\\,dx$ on $V$. This $a(\\cdot,\\cdot)$ is bounded by the Poincaré inequality and the Cauchy–Schwarz inequality, but not coercive with respect to $\\lVert \\cdot \\rVert_V = \\lVert \\cdot' \\rVert_{L^2(0,1)}$. Therefore the Lax–Milgram theorem does not guarantee existence and uniqueness for all right-hand sides, and Céa’s lemma cannot be applied because its coercivity hypothesis fails.\n\nB. Define $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx - \\int_0^1 u(x)\\,v(x)\\,dx$ on $V$. This $a(\\cdot,\\cdot)$ is not coercive because of the negative sign in front of the $L^2(0,1)$ term; hence the Lax–Milgram theorem fails and Céa’s lemma cannot be applied.\n\nC. Define $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx$ on $V$. This $a(\\cdot,\\cdot)$ is bounded and coercive; therefore the Lax–Milgram theorem holds and Céa’s lemma yields an a priori error bound.\n\nD. Let $V := L^2(0,1)$ with its standard norm and define $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx$. This $a(\\cdot,\\cdot)$ is bounded but not coercive, hence the Lax–Milgram theorem fails and Céa’s lemma cannot be applied.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- The vector space is $V = H_0^1(0,1)$, which is the Sobolev space of functions on $(0,1)$ that are in $L^2(0,1)$, have a weak derivative in $L^2(0,1)$, and satisfy the boundary conditions $u(0)=u(1)=0$.\n- The norm on $V$ is defined as $\\lVert u \\rVert_V := \\lVert u' \\rVert_{L^2(0,1)}$.\n- A bilinear form $a(\\cdot,\\cdot)$ on $V$ is bounded if $\\exists M \\in \\mathbb{R}_{0}$ such that $\\lvert a(u,v) \\rvert \\le M \\lVert u \\rVert_V \\lVert v \\rVert_V$ for all $u,v \\in V$.\n- A bilinear form $a(\\cdot,\\cdot)$ on $V$ is coercive if $\\exists \\alpha \\in \\mathbb{R}_{0}$ such that $a(u,u) \\ge \\alpha \\lVert u \\rVert_V^2$ for all $u \\in V$.\n- The Poincaré inequality states $\\exists C_P \\in \\mathbb{R}_{0}$ such that $\\lVert u \\rVert_{L^2(0,1)} \\le C_P \\lVert u' \\rVert_{L^2(0,1)}$ for all $u \\in H_0^1(0,1)$. This inequality guarantees that $\\lVert \\cdot \\rVert_V$ is indeed a norm on $V$.\n- The Lax–Milgram theorem and Céa’s lemma require the bilinear form to be both bounded and coercive.\n\nThe question is to identify the option that presents a bilinear form that is bounded but not coercive on the space $V$ with the given norm $\\lVert \\cdot \\rVert_V$, and correctly explains the consequences.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, objective, complete, and consistent. It is a standard problem in the functional analysis foundations of the finite element method. The definitions and theorems cited are correct. The space $V=H_0^1(0,1)$ and the norm $\\lVert u \\rVert_V = \\lVert u' \\rVert_{L^2(0,1)}$ are standard. The problem is formalizable and relevant to the specified topic.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed to the solution by analyzing each option.\n\nWe analyze each option based on the provided definitions for the space $V=H_0^1(0,1)$ and the norm $\\lVert u \\rVert_V = \\lVert u' \\rVert_{L^2(0,1)}$.\n\n**Analysis of Option A**\nThe bilinear form is $a(u,v) := \\int_0^1 u(x)\\,v(x)\\,dx$. This is the standard $L^2(0,1)$ inner product, denoted $(u,v)_{L^2}$.\n\n- **Boundedness**: We test if $| a(u,v) | \\le M \\lVert u \\rVert_V \\lVert v \\rVert_V$ for some constant $M0$.\nBy the Cauchy–Schwarz inequality, we have:\n$$|a(u,v)| = \\left| \\int_0^1 u(x)v(x)dx \\right| \\le \\lVert u \\rVert_{L^2(0,1)} \\lVert v \\rVert_{L^2(0,1)}$$\nUsing the Poincaré inequality stated in the problem, $\\lVert u \\rVert_{L^2(0,1)} \\le C_P \\lVert u' \\rVert_{L^2(0,1)} = C_P \\lVert u \\rVert_V$, we can write:\n$$|a(u,v)| \\le (C_P \\lVert u' \\rVert_{L^2(0,1)}) (C_P \\lVert v' \\rVert_{L^2(0,1)}) = C_P^2 \\lVert u \\rVert_V \\lVert v \\rVert_V$$\nWith $M=C_P^2  0$, the bilinear form is bounded. The statement in the option is correct.\n\n- **Coercivity**: We test if $a(u,u) \\ge \\alpha \\lVert u \\rVert_V^2$ for some constant $\\alpha  0$.\n$$a(u,u) = \\int_0^1 u(x)^2 dx = \\lVert u \\rVert_{L^2(0,1)}^2$$\nThe condition for coercivity becomes $\\lVert u \\rVert_{L^2(0,1)}^2 \\ge \\alpha \\lVert u' \\rVert_{L^2(0,1)}^2$ for all non-zero $u \\in V$. This is equivalent to checking if the Rayleigh quotient $\\frac{\\lVert u \\rVert_{L^2(0,1)}^2}{\\lVert u' \\rVert_{L^2(0,1)}^2}$ is bounded below by a positive constant $\\alpha$.\nConsider the sequence of functions $u_n(x) = \\sin(n\\pi x)$ for $n \\in \\mathbb{N}$. These functions are in $H_0^1(0,1)$ since $u_n(0) = \\sin(0) = 0$ and $u_n(1) = \\sin(n\\pi)=0$.\nWe compute the norms:\n$$\\lVert u_n \\rVert_{L^2(0,1)}^2 = \\int_0^1 \\sin^2(n\\pi x)dx = \\frac{1}{2}$$\nThe derivative is $u_n'(x) = n\\pi\\cos(n\\pi x)$.\n$$\\lVert u_n' \\rVert_{L^2(0,1)}^2 = \\int_0^1 (n\\pi\\cos(n\\pi x))^2 dx = (n\\pi)^2 \\int_0^1 \\cos^2(n\\pi x)dx = \\frac{(n\\pi)^2}{2}$$\nThe ratio is:\n$$\\frac{a(u_n, u_n)}{\\lVert u_n \\rVert_V^2} = \\frac{\\lVert u_n \\rVert_{L^2(0,1)}^2}{\\lVert u_n' \\rVert_{L^2(0,1)}^2} = \\frac{1/2}{(n\\pi)^2/2} = \\frac{1}{(n\\pi)^2}$$\nAs $n \\to \\infty$, this ratio approaches $0$. The infimum of this ratio over all $u \\in V$ is $0$. Therefore, there exists no constant $\\alpha  0$ that satisfies the coercivity condition for all $u \\in V$. The bilinear form is not coercive. The statement in the option is correct.\n\n- **Reasoning**: The option states that because coercivity fails, the Lax–Milgram theorem does not guarantee well-posedness, and Céa's lemma cannot be applied. This is a direct consequence of the theorems' hypotheses, which both require coercivity. The reasoning is correct.\n\n- **Verdict on Option A**: The bilinear form is bounded but not coercive, and the explanation is correct. This option matches the requirements of the question. **Correct**.\n\n**Analysis of Option B**\nThe bilinear form is $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx - \\int_0^1 u(x)\\,v(x)\\,dx$.\n\n- **Boundedness**: From the analysis of A, both terms are bounded with respect to the $\\lVert \\cdot \\rVert_V$ norm.\n$$|a(u,v)| \\le |\\int_0^1 u'v'dx| + |\\int_0^1 uv dx| \\le \\lVert u' \\rVert_{L^2}\\lVert v' \\rVert_{L^2} + \\lVert u \\rVert_{L^2}\\lVert v \\rVert_{L^2}$$\n$$|a(u,v)| \\le \\lVert u \\rVert_V \\lVert v \\rVert_V + C_P^2 \\lVert u \\rVert_V \\lVert v \\rVert_V = (1+C_P^2) \\lVert u \\rVert_V \\lVert v \\rVert_V$$\nThe form is bounded.\n\n- **Coercivity**: We test if $a(u,u) \\ge \\alpha \\lVert u \\rVert_V^2$.\n$$a(u,u) = \\int_0^1 (u'(x))^2 dx - \\int_0^1 u(x)^2 dx = \\lVert u' \\rVert_{L^2(0,1)}^2 - \\lVert u \\rVert_{L^2(0,1)}^2$$\nUsing the Poincaré inequality $\\lVert u \\rVert_{L^2(0,1)}^2 \\le C_P^2 \\lVert u' \\rVert_{L^2(0,1)}^2$:\n$$a(u,u) \\ge \\lVert u' \\rVert_{L^2(0,1)}^2 - C_P^2 \\lVert u' \\rVert_{L^2(0,1)}^2 = (1 - C_P^2) \\lVert u' \\rVert_{L^2(0,1)}^2$$\nFor the interval $(0,1)$, the optimal Poincaré constant is $C_P = 1/\\pi$. Since $\\pi \\approx 3.14159$, we have $C_P^2 = 1/\\pi^2  1$. Thus, the factor $(1 - C_P^2)$ is positive. Let $\\alpha = 1 - C_P^2  0$. Then\n$$a(u,u) \\ge \\alpha \\lVert u' \\rVert_{L^2(0,1)}^2 = \\alpha \\lVert u \\rVert_V^2$$\nThe bilinear form **is coercive**. The option's claim that it is \"not coercive because of the negative sign\" is an incorrect oversimplification.\n\n- **Verdict on Option B**: The claim of non-coercivity is false. **Incorrect**.\n\n**Analysis of Option C**\nThe bilinear form is $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx$.\n\n- **Boundedness**:\n$$|a(u,v)| = |\\int_0^1 u'v'dx| \\le \\lVert u' \\rVert_{L^2(0,1)} \\lVert v' \\rVert_{L^2(0,1)} = \\lVert u \\rVert_V \\lVert v \\rVert_V$$\nThe form is bounded with $M=1$.\n\n- **Coercivity**:\n$$a(u,u) = \\int_0^1 (u'(x))^2 dx = \\lVert u' \\rVert_{L^2(0,1)}^2 = \\lVert u \\rVert_V^2$$\nThis implies $a(u,u) \\ge 1 \\cdot \\lVert u \\rVert_V^2$, so the form is coercive with $\\alpha=1$.\n\n- **Reasoning**: The option correctly identifies that the form is both bounded and coercive. However, the question asks for a form that is **not** coercive. Therefore, this option does not answer the question.\n\n- **Verdict on Option C**: While factually correct, this option does not satisfy the condition of being non-coercive. **Incorrect**.\n\n**Analysis of Option D**\nThe option begins by redefining the space $V := L^2(0,1)$. This contradicts the problem's premise where $V$ is defined as $H_0^1(0,1)$. A problem option cannot redefine the core givens of the problem statement.\nFurthermore, the bilinear form $a(u,v) := \\int_0^1 u'(x)\\,v'(x)\\,dx$ is not defined for general functions $u, v \\in L^2(0,1)$, as their derivatives may not exist or may not be in $L^2$. The domain of this bilinear form cannot be $L^2(0,1) \\times L^2(0,1)$. The formulation is mathematically nonsensical.\n\n- **Verdict on Option D**: This option is fundamentally flawed and inconsistent with the problem setup. **Incorrect**.\n\n**Conclusion**\nOnly Option A correctly identifies a bilinear form that is bounded but not coercive on the specified space with the specified norm, and provides a correct explanation for the failure of the Lax-Milgram and Céa's lemma.", "answer": "$$\\boxed{A}$$", "id": "2539778"}, {"introduction": "While Céa's lemma guarantees that the finite element solution is quasi-optimal, the quality of this \"optimality\" is dictated by the stability constant $M/\\alpha$. This exercise [@problem_id:2539773] explores a singularly perturbed reaction-diffusion problem where this constant's behavior is non-trivial. Calculating how $M/\\alpha$ scales with the diffusion parameter $\\epsilon$ will reveal how an a priori bound, while formally valid, can become asymptotically pessimistic and practically uninformative, highlighting the crucial need to analyze the constants that we often hide in asymptotic notation.", "problem": "Consider the one-dimensional reaction–diffusion model on the open interval $(0,1)$ with homogeneous Dirichlet boundary conditions, where $0\\epsilon \\ll 1$:\n$$\n\\epsilon\\,u''-u=f \\quad \\text{in }(0,1), \\qquad u(0)=u(1)=0.\n$$\nAdopt the coercive variational formulation obtained by multiplying the equation by $-1$ and integrating by parts, so that the bilinear form and linear functional are\n$$\na(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx, \\qquad \\ell(v)=-\\int_{0}^{1}f(x)\\,v(x)\\,dx,\n$$\nfor all $u,v\\in H_{0}^{1}(0,1)$. Work with the norm $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$. Using only core definitions (continuity and coercivity of bilinear forms) and well-tested facts (the sharp Poincaré inequality on $(0,1)$), perform the following:\n\n1. Determine the smallest coercivity constant $\\alpha0$ and a valid continuity constant $M0$ such that\n$$\na(v,v)\\ge \\alpha\\,\\|v\\|_{H_{0}^{1}(0,1)}^{2}\\quad \\text{for all } v\\in H_{0}^{1}(0,1), \n$$\nand\n$$\n|a(w,v)|\\le M\\,\\|w\\|_{H_{0}^{1}(0,1)}\\,\\|v\\|_{H_{0}^{1}(0,1)}\\quad \\text{for all } w,v\\in H_{0}^{1}(0,1).\n$$\n\n2. Then, express the ratio $M/\\alpha$ in closed form in terms of $\\epsilon$ only, using the optimal constant in the Poincaré inequality on $(0,1)$.\n\nFinally, briefly state how the scaling of $M/\\alpha$ as $\\epsilon\\to 0$ affects the pre-asymptotic reliability of the a priori error estimate provided by Céa’s lemma in the Finite Element Method (FEM).\n\nImportant: Express your final answer for $M/\\alpha$ as a single closed-form analytic expression in terms of $\\epsilon$, with no numerical approximation or rounding.", "solution": "The problem as stated is mathematically and scientifically sound, self-contained, and well-posed. It is a standard exercise in the a priori analysis of the Finite Element Method for a singularly perturbed problem. We proceed with the solution.\n\nThe task is to find the coercivity constant $\\alpha$ and a continuity constant $M$ for the bilinear form\n$$ a(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx $$\nwith respect to the norm $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$.\n\nFirst, we determine the smallest coercivity constant $\\alpha$. The coercivity condition is $a(v,v) \\ge \\alpha \\|v\\|_{H_{0}^{1}(0,1)}^{2}$ for all $v \\in H_0^1(0,1)$. Substituting the definitions of the bilinear form and the norm, we have:\n$$ \\epsilon\\int_{0}^{1}(v'(x))^{2}\\,dx+\\int_{0}^{1}(v(x))^{2}\\,dx \\ge \\alpha \\int_{0}^{1}(v'(x))^{2}\\,dx. $$\nUsing the notation of $L^2$-norms, $\\|v'\\|_{L^2(0,1)}^2 = \\int_0^1 (v'(x))^2 dx$ and $\\|v\\|_{L^2(0,1)}^2 = \\int_0^1 (v(x))^2 dx$, the inequality becomes:\n$$ \\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2} \\ge \\alpha \\|v'\\|_{L^2(0,1)}^{2}. $$\nTo find the smallest possible value for $\\alpha$, we compute the infimum of the Rayleigh quotient:\n$$ \\alpha = \\inf_{v \\in H_0^1(0,1), v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2(0,1)}^2} = \\inf_{v \\neq 0} \\frac{\\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2}}{\\|v'\\|_{L^2(0,1)}^2} = \\epsilon + \\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}. $$\nThe term $\\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}$ can be made arbitrarily close to zero. To demonstrate this, consider the sequence of functions $v_n(x) = \\sin(n\\pi x)$ for $n \\in \\{1, 2, 3, \\dots\\}$, which belong to $H_0^1(0,1)$. The squared $L^2$-norm of $v_n$ is $\\|v_n\\|_{L^2(0,1)}^2 = \\int_0^1 \\sin^2(n\\pi x)dx = \\frac{1}{2}$, and the squared $L^2$-norm of its derivative is $\\|v_n'\\|_{L^2(0,1)}^2 = \\int_0^1 (n\\pi)^2 \\cos^2(n\\pi x)dx = \\frac{(n\\pi)^2}{2}$. The ratio is $\\frac{\\|v_n\\|_{L^2(0,1)}^2}{\\|v_n'\\|_{L^2(0,1)}^2} = \\frac{1}{(n\\pi)^2}$, which tends to $0$ as $n \\to \\infty$. Thus, the infimum is $0$.\nTherefore, the smallest (optimal) coercivity constant is $\\alpha = \\epsilon$.\n\nNext, we determine a valid continuity constant $M$. The continuity condition is $|a(w,v)| \\le M \\|w\\|_{H_{0}^{1}(0,1)} \\|v\\|_{H_{0}^{1}(0,1)}$ for all $w, v \\in H_0^1(0,1)$. Using the specified norm, this is:\n$$ |a(w,v)| \\le M \\|w'\\|_{L^2(0,1)} \\|v'\\|_{L^2(0,1)}. $$\nApplying the triangle inequality and the Cauchy-Schwarz inequality to the bilinear form:\n$$ |a(w,v)| = \\left|\\epsilon\\int_{0}^{1}w'v'\\,dx+\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\left|\\int_{0}^{1}w'v'\\,dx\\right| + \\left|\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\|w\\|_{L^2} \\|v\\|_{L^2}. $$\nTo obtain a bound in terms of $\\|w'\\|_{L^2}$ and $\\|v'\\|_{L^2}$ only, we use the sharp Poincaré inequality on $(0,1)$, which states that for any $v \\in H_0^1(0,1)$, $\\|v\\|_{L^2} \\le C_P \\|v'\\|_{L^2}$. The sharp constant $C_P$ is given by $1/\\sqrt{\\lambda_1}$, where $\\lambda_1$ is the smallest eigenvalue of the operator $-d^2/dx^2$ with homogeneous Dirichlet boundary conditions. The eigenvalues are $\\lambda_n = (n\\pi)^2$ for $n=1,2,\\dots$, so $\\lambda_1 = \\pi^2$. Thus, the sharp inequality is $\\|v\\|_{L^2} \\le \\frac{1}{\\pi}\\|v'\\|_{L^2}$.\nSubstituting this into our bound for $|a(w,v)|$:\n$$ |a(w,v)| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\left(\\frac{1}{\\pi}\\|w'\\|_{L^2}\\right) \\left(\\frac{1}{\\pi}\\|v'\\|_{L^2}\\right) = \\left(\\epsilon + \\frac{1}{\\pi^2}\\right) \\|w'\\|_{L^2} \\|v'\\|_{L^2}. $$\nThis demonstrates that $M = \\epsilon + \\frac{1}{\\pi^2}$ is a valid continuity constant. To verify it is the smallest possible, we must check if the supremum is attained. The supremum is\n$$ M = \\sup_{w,v \\neq 0} \\frac{|a(w,v)|}{\\|w'\\|_{L^2}\\|v'\\|_{L^2}} \\ge \\sup_{v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2}^2} = \\sup_{v \\neq 0} \\left(\\epsilon + \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}\\right) = \\epsilon + \\sup_{v \\neq 0} \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}. $$\nThe supremum of the ratio $\\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}$ is the reciprocal of the smallest eigenvalue $\\lambda_1=\\pi^2$, which is $1/\\pi^2$. This supremum is attained by the first eigenfunction $v_1(x) = \\sin(\\pi x)$. Hence, the optimal continuity constant is $M = \\epsilon + \\frac{1}{\\pi^2}$.\n\nThe ratio $M/\\alpha$ is then:\n$$ \\frac{M}{\\alpha} = \\frac{\\epsilon + \\frac{1}{\\pi^2}}{\\epsilon} = 1 + \\frac{1}{\\epsilon \\pi^2}. $$\n\nFinally, we analyze the effect of this ratio on Céa's lemma. The lemma provides the a priori error estimate for the finite element solution $u_h$ relative to the exact solution $u$:\n$$ \\|u - u_h\\|_{H_0^1(0,1)} \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_{H_0^1(0,1)}. $$\nHere, $V_h$ is the finite-dimensional subspace of $H_0^1(0,1)$, and the norm is as specified, $\\|v\\|_{H_0^1(0,1)} = \\|v'\\|_{L^2(0,1)}$. The constant of stability is $\\frac{M}{\\alpha} = 1 + \\frac{1}{\\epsilon \\pi^2}$. In the singularly perturbed regime where $\\epsilon \\to 0$, this constant scales as $O(\\epsilon^{-1})$ and grows without bound. A very large stability constant renders the estimate quantitatively poor in the pre-asymptotic regime (i.e., for practical mesh sizes $h$). Although the estimate remains formally valid, it becomes an extreme overestimation of the true error, making it an unreliable tool for predicting the accuracy of the numerical solution for small $\\epsilon$. This degradation of the a priori error bound due to a problem parameter is a well-known issue in numerical analysis.", "answer": "$$\n\\boxed{1 + \\frac{1}{\\epsilon \\pi^{2}}}\n$$", "id": "2539773"}, {"introduction": "Theory is best understood when seen in action. This final hands-on practice [@problem_id:2539864] invites you to write a program to numerically verify the core statement of Céa's lemma for the one-dimensional Poisson equation. By computing both the Galerkin solution $u_h$ and the true best-approximation $p_h$, you will measure the ratio of their respective error norms. This exercise not only provides practical experience in implementing FEM but also reveals a profound property of this specific problem: the Galerkin approximation is not just quasi-optimal, it is truly the optimal solution in the energy norm, making the theoretical bound sharp and equal to one.", "problem": "Consider the one-dimensional Poisson boundary value problem on the unit interval with homogeneous Dirichlet boundary conditions: find $u \\in H_0^1(0,1)$ such that\n$$\n- u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = u(1) = 0,\n$$\nin its variational form: find $u \\in H_0^1(0,1)$ satisfying\n$$\na(u,w) = \\ell(w) \\quad \\text{for all } w \\in H_0^1(0,1),\n$$\nwhere the bilinear form and linear form are given by\n$$\na(v,w) := \\int_0^1 v'(x)\\,w'(x)\\,dx, \\qquad \\ell(w) := \\int_0^1 f(x)\\,w(x)\\,dx.\n$$\nLet the exact solution be chosen as\n$$\nu(x) := e^x \\sin(\\pi x),\n$$\nso that $f$ is determined by the equation. Define the energy norm induced by $a(\\cdot,\\cdot)$ as\n$$\n\\|v\\|_a := \\sqrt{a(v,v)} = \\left(\\int_0^1 |v'(x)|^2\\,dx\\right)^{1/2}.\n$$\n\nLet $V_h \\subset H_0^1(0,1)$ be the standard continuous, piecewise linear finite element space on a uniform mesh of $N$ elements with nodes $x_i = i/N$ for $i=0,1,\\dots,N$, and where the only degrees of freedom are at the interior nodes $x_1,\\dots,x_{N-1}$. The Galerkin finite element approximation $u_h \\in V_h$ is defined by\n$$\na(u_h,w_h) = \\ell(w_h) \\quad \\text{for all } w_h \\in V_h.\n$$\nDefine the $a(\\cdot,\\cdot)$-best approximation $p_h \\in V_h$ of $u$ as the unique element such that\n$$\na(u - p_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h,\n$$\nequivalently, $a(p_h,w_h) = a(u,w_h)$ for all $w_h \\in V_h$.\n\nYour task is to implement a program that, for a small test suite of mesh sizes, numerically computes the ratio\n$$\nR_h := \\frac{\\|u - u_h\\|_a}{\\inf_{v_h \\in V_h} \\|u - v_h\\|_a} = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a},\n$$\nand verifies that it remains uniformly bounded above by the ideal bound arising from the continuity and coercivity properties of $a(\\cdot,\\cdot)$ with respect to $\\|\\cdot\\|_a$. In particular, your program must:\n- Assemble the stiffness matrix corresponding to $a(\\cdot,\\cdot)$ on $V_h$.\n- Assemble the load vector corresponding to $\\ell(\\cdot)$ using the exact right-hand side $f$ induced by the chosen exact solution $u$.\n- Compute $u_h$ by solving the Galerkin system.\n- Compute $p_h$ by solving the $a(\\cdot,\\cdot)$-orthogonal projection system, i.e., by assembling the right-hand side with entries $a(u,\\phi_i)$, where $\\{\\phi_i\\}$ are the nodal basis functions of $V_h$.\n- Evaluate the energy-norm errors $\\|u - u_h\\|_a$ and $\\|u - p_h\\|_a$ by accurate numerical quadrature of $\\int_0^1 |(u' - u_h')|^2\\,dx$ and $\\int_0^1 |(u' - p_h')|^2\\,dx$.\n- From first principles, determine the continuity constant $M$ and coercivity constant $\\alpha$ of $a(\\cdot,\\cdot)$ with respect to $\\|\\cdot\\|_a$. Use these to produce the ideal uniform upper bound for $R_h$.\n- Return both the list of ratios $R_h$ for the test suite and the bound used for verification, together with a boolean indicating whether all ratios satisfy the bound within a small numerical tolerance.\n\nUse the following test suite of mesh element counts (number of elements): $N \\in \\{2,4,8,16\\}$. These choices test:\n- $N=2$: a minimal nontrivial space with a single interior degree of freedom (edge case).\n- $N=4$: a coarse mesh (general case).\n- $N=8$ and $N=16$: progressively refined meshes to test stability under refinement.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, specifically in the format\n$$\n[\\;R_{2},\\;R_{4},\\;R_{8},\\;R_{16},\\;B,\\;T\\;],\n$$\nwhere $R_{N}$ denotes the computed ratio for the given $N$, $B$ is the computed ideal bound derived from the continuity and coercivity constants, and $T$ is a boolean indicating whether all ratios are less than or equal to $B$ up to a small positive tolerance (you may choose a reasonable fixed tolerance, e.g., $10^{-8}$). All outputs are dimensionless real numbers or booleans; there are no physical units or angles involved. The final outputs must be of types float for each $R_N$ and $B$, and boolean for $T$.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Problem**: One-dimensional Poisson equation $- u''(x) = f(x)$ for $x \\in (0,1)$, with homogeneous Dirichlet boundary conditions $u(0) = u(1) = 0$.\n- **Variational Formulation**: Find $u \\in H_0^1(0,1)$ such that $a(u,w) = \\ell(w)$ for all $w \\in H_0^1(0,1)$.\n- **Bilinear Form**: $a(v,w) := \\int_0^1 v'(x)\\,w'(x)\\,dx$.\n- **Linear Form**: $\\ell(w) := \\int_0^1 f(x)\\,w(x)\\,dx$.\n- **Exact Solution**: $u(x) := e^x \\sin(\\pi x)$. This determines $f(x) = -u''(x)$.\n- **Energy Norm**: $\\|v\\|_a := \\sqrt{a(v,v)} = \\left(\\int_0^1 |v'(x)|^2\\,dx\\right)^{1/2}$.\n- **Finite Element Space**: $V_h \\subset H_0^1(0,1)$ is the space of continuous, piecewise linear functions on a uniform mesh of $N$ elements with nodes at $x_i = i/N$ for $i=0, \\dots, N$.\n- **Galerkin Approximation**: $u_h \\in V_h$ is defined by $a(u_h,w_h) = \\ell(w_h)$ for all $w_h \\in V_h$.\n- **Best Approximation**: $p_h \\in V_h$ is defined by $a(u - p_h, w_h) = 0$ for all $w_h \\in V_h$.\n- **Objective**: Compute the ratio $R_h := \\frac{\\|u - u_h\\|_a}{\\inf_{v_h \\in V_h} \\|u - v_h\\|_a} = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a}$ for $N \\in \\{2, 4, 8, 16\\}$, find the ideal upper bound $B$ for this ratio from continuity and coercivity constants, and verify if $R_h \\le B$.\n- **Output Format**: $[\\;R_{2},\\;R_{4},\\;R_{8},\\;R_{16},\\;B,\\;T\\;]$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is a standard application of the Finite Element Method (FEM) to the 1D Poisson equation. It involves fundamental concepts like variational formulation, Galerkin approximation, and a priori error estimation via Céa's lemma. All aspects are firmly rooted in the mathematical theory of numerical analysis for partial differential equations.\n- **Well-Posedness**: The 1D Poisson problem with Dirichlet boundary conditions is a classic well-posed problem. The associated bilinear form $a(\\cdot,\\cdot)$ is symmetric and positive definite on $H_0^1(0,1)$, guaranteeing a unique solution to both the continuous and discrete problems via the Lax-Milgram theorem and its discrete analogue.\n- **Objectivity**: The problem is stated using precise, unambiguous mathematical language.\n- **Completeness and Consistency**: All necessary definitions, equations, and data are provided. The exact solution $u(x)$ satisfies the boundary conditions, and it uniquely determines the right-hand side $f(x)$. The definitions for $u_h$ and $p_h$ are standard and consistent. There are no contradictions.\n- **Relation to Topic**: The problem is directly concerned with the numerical verification of the constant appearing in Céa's lemma, which is a cornerstone of a priori error analysis in FEM.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a well-defined, self-contained, and theoretically sound exercise in numerical analysis. A complete solution will be provided.\n\n### Solution\nThe task is to compute the ratio $R_h = \\|u - u_h\\|_a / \\|u - p_h\\|_a$ and compare it to its theoretical bound derived from Céa's lemma.\n\n**1. Theoretical Analysis of the Bound**\n\nCéa's lemma provides an a priori error bound for the Galerkin approximation. For a bilinear form $a(\\cdot,\\cdot)$ and a finite element space $V_h \\subset V$, the lemma states that the error in the energy norm is bounded by:\n$$\n\\|u - u_h\\|_a \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_a\n$$\nwhere $M$ is the continuity constant and $\\alpha$ is the coercivity constant of $a(\\cdot,\\cdot)$ with respect to the energy norm $\\|\\cdot\\|_a$. The problem defines $p_h$ as the best approximation, so $\\inf_{v_h \\in V_h} \\|u - v_h\\|_a = \\|u - p_h\\|_a$. Thus, the ratio is bounded as:\n$$\nR_h = \\frac{\\|u - u_h\\|_a}{\\|u - p_h\\|_a} \\le \\frac{M}{\\alpha} = B\n$$\nWe must determine the constants $M$ and $\\alpha$ for the given problem.\n\n- **Continuity**: We seek the smallest constant $M$ such that $|a(v,w)| \\le M \\|v\\|_a \\|w\\|_a$ for all $v, w \\in H_0^1(0,1)$.\nThe bilinear form is $a(v,w) = \\int_0^1 v'(x)w'(x)dx$. By the Cauchy-Schwarz inequality for integrals:\n$$\n|a(v,w)| = \\left| \\int_0^1 v'(x)w'(x)dx \\right| \\le \\left(\\int_0^1 |v'(x)|^2dx\\right)^{1/2} \\left(\\int_0^1 |w'(x)|^2dx\\right)^{1/2}\n$$\nBy definition of the energy norm, $\\|v\\|_a = \\left(\\int_0^1 |v'(x)|^2dx\\right)^{1/2}$. Therefore:\n$$\n|a(v,w)| \\le \\|v\\|_a \\|w\\|_a\n$$\nThis inequality holds with a constant of $1$. This bound is sharp, so the continuity constant is $M=1$.\n\n- **Coercivity**: We seek the largest constant $\\alpha$ such that $a(v,v) \\ge \\alpha \\|v\\|_a^2$ for all $v \\in H_0^1(0,1)$.\nBy definition:\n$$\na(v,v) = \\int_0^1 |v'(x)|^2dx = \\|v\\|_a^2\n$$\nThis implies $a(v,v) \\ge 1 \\cdot \\|v\\|_a^2$. The bound is sharp, so the coercivity constant is $\\alpha=1$.\n\nThe ideal uniform upper bound for the ratio $R_h$ is $B = M/\\alpha = 1/1 = 1$.\n\n**2. Identity of the Galerkin and Best Approximations**\n\nA crucial observation specific to this problem simplifies the analysis. The continuous solution $u$ satisfies $a(u, w) = \\ell(w)$ for all $w \\in H_0^1(0,1)$. This holds in particular for any test function $w_h \\in V_h$, so $a(u, w_h) = \\ell(w_h)$ for all $w_h \\in V_h$.\n\nThe Galerkin approximation $u_h$ is defined by $a(u_h, w_h) = \\ell(w_h)$ for all $w_h \\in V_h$.\nCombining these, we get $a(u, w_h) = a(u_h, w_h)$, which implies:\n$$\na(u - u_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h.\n$$\nThis is the property of Galerkin orthogonality. Now, compare this to the definition of the best approximation $p_h$:\n$$\na(u - p_h, w_h) = 0 \\quad \\text{for all } w_h \\in V_h.\n$$\nThe definitions are identical. This implies $a(u_h, w_h) = a(p_h, w_h)$, or $a(u_h - p_h, w_h) = 0$ for all $w_h \\in V_h$. Since $u_h - p_h \\in V_h$, we can choose $w_h = u_h - p_h$, yielding $a(u_h - p_h, u_h - p_h) = \\|u_h - p_h\\|_a^2 = 0$. Since $\\|\\cdot\\|_a$ is a norm on $V_h$, this implies $u_h - p_h = 0$, so $u_h = p_h$.\n\nTheoretically, the Galerkin approximation and the best approximation are the same function. Therefore, the error norms must be identical, $\\|u-u_h\\|_a = \\|u-p_h\\|_a$, and the ratio $R_h$ must be exactly $1$. Any deviation from $1$ in the numerical computation will be due to approximation errors, primarily the numerical quadrature used to assemble the load vector for $u_h$.\n\n**3. Numerical Implementation Strategy**\n\nWe will implement the finite element procedure for the given values of $N$.\n- **Exact Solution and Derivatives**:\nThe exact solution is $u(x) = e^x \\sin(\\pi x)$. Its derivative is $u'(x) = e^x (\\sin(\\pi x) + \\pi \\cos(\\pi x))$. The right-hand side is $f(x) = -u''(x) = -e^x((1 - \\pi^2)\\sin(\\pi x) + 2\\pi \\cos(\\pi x))$.\n\n- **FEM Discretization**:\nWe use standard linear basis \"hat\" functions $\\{\\phi_i(x)\\}_{i=1}^{N-1}$ associated with the interior nodes $x_i = i/h$ where $h=1/N$. The FEM solutions are of the form $v_h(x) = \\sum_{i=1}^{N-1} c_i \\phi_i(x)$.\n\n- **Stiffness Matrix**: The entries of the stiffness matrix $A$ are $A_{ij} = a(\\phi_j, \\phi_i)$. For a uniform mesh with step size $h$, this results in the $(N-1) \\times (N-1)$ tridiagonal matrix:\n$$\nA = \\frac{1}{h} \\begin{pmatrix} 2  -1   \\\\ -1  2  -1  \\\\  \\ddots  \\ddots  \\ddots \\\\   -1  2  -1 \\\\    -1  2 \\end{pmatrix}\n$$\n\n- **Load Vector for $u_h$**: The vector $\\mathbf{b}$ has entries $b_i = \\ell(\\phi_i) = \\int_0^1 f(x) \\phi_i(x) dx$. This integral will be computed numerically using high-precision quadrature (`scipy.integrate.quad`) over the support of $\\phi_i(x)$, which is $(x_{i-1}, x_{i+1})$.\n\n- **Load Vector for $p_h$**: The vector $\\mathbf{d}$ for the best approximation system has entries $d_i = a(u, \\phi_i) = \\int_0^1 u'(x)\\phi_i'(x) dx$. Integrating by parts gives an exact formula without requiring numerical quadrature:\n$$\nd_i = \\int_{x_{i-1}}^{x_i} u'(x)\\frac{1}{h}dx + \\int_{x_i}^{x_{i+1}} u'(x)\\frac{-1}{h}dx = \\frac{1}{h}\\left( [u(x)]_{x_{i-1}}^{x_i} - [u(x)]_{x_i}^{x_{i+1}} \\right) = \\frac{1}{h}(2u(x_i) - u(x_{i-1}) - u(x_{i+1}))\n$$\nAny numerical difference between the computed solutions $\\tilde{u}_h$ and $\\tilde{p}_h$ will stem from the quadrature error in computing $\\mathbf{b}$ versus the high-precision evaluation of $\\mathbf{d}$.\n\n- **Solving and Error Calculation**: We solve the linear systems $A\\mathbf{u}_h = \\mathbf{b}$ and $A\\mathbf{p}_h = \\mathbf{d}$ to find the coefficient vectors. The resulting functions are $u_h(x)$ and $p_h(x)$. Their derivatives are piecewise constant, e.g., $u_h'(x) = (u_{h,k+1} - u_{h,k})/h$ on element $(x_k, x_{k+1})$. The error norms squared, $\\|u-u_h\\|_a^2 = \\int_0^1 |u'(x)-u_h'(x)|^2 dx$ and $\\|u-p_h\\|_a^2 = \\int_0^1 |u'(x)-p_h'(x)|^2 dx$, are computed by summing the integrals over each element, again using `scipy.integrate.quad` for accuracy.\n\nFinally, the ratio $R_N$ is calculated for each $N$, and the list of results is compiled along with the theoretical bound $B=1.0$ and a boolean check $T$ for whether all ratios satisfy $R_N \\le B$ within a small tolerance.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the 1D Poisson problem using FEM, computes the ratio of Galerkin error\n    to best-approximation error, and verifies it against the theoretical bound.\n    \"\"\"\n    test_cases = [2, 4, 8, 16]\n    ratios = []\n    \n    # Exact solution and its derivatives\n    # u(x) = exp(x) * sin(pi*x)\n    u_func = lambda x: np.exp(x) * np.sin(np.pi * x)\n    # u'(x) = exp(x) * (sin(pi*x) + pi*cos(pi*x))\n    u_prime_func = lambda x: np.exp(x) * (np.sin(np.pi * x) + np.pi * np.cos(np.pi * x))\n    # f(x) = -u''(x) = -exp(x) * ((1-pi^2)*sin(pi*x) + 2*pi*cos(pi*x))\n    f_func = lambda x: -np.exp(x) * ((1.0 - np.pi**2) * np.sin(np.pi * x) + 2.0 * np.pi * np.cos(np.pi * x))\n    \n    # Derivation in solution text shows M=1, alpha=1.\n    bound_B = 1.0\n    \n    for N in test_cases:\n        h = 1.0 / N\n        dim = N - 1\n        x_nodes = np.linspace(0.0, 1.0, N + 1)\n        \n        # Assemble stiffness matrix A\n        if dim > 0:\n            main_diag = np.full(dim, 2.0)\n            off_diag = np.full(dim - 1, -1.0)\n            A = (np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)) / h\n        elif dim == 0: # Should not happen with N>=2\n            A = np.array([])\n        \n        # Assemble load vector b for u_h using numerical quadrature for \\int f*phi_i dx\n        b = np.zeros(dim)\n        for i in range(dim):\n            node_idx = i + 1\n            x_im1, x_i, x_ip1 = x_nodes[node_idx-1], x_nodes[node_idx], x_nodes[node_idx+1]\n            \n            # Integrand over [x_{i-1}, x_i]\n            integrand1 = lambda x: f_func(x) * (x - x_im1) / h\n            # Integrand over [x_i, x_{i+1}]\n            integrand2 = lambda x: f_func(x) * (x_ip1 - x) / h\n            \n            val1, _ = quad(integrand1, x_im1, x_i, epsabs=1e-14, epsrel=1e-14)\n            val2, _ = quad(integrand2, x_i, x_ip1, epsabs=1e-14, epsrel=1e-14)\n            b[i] = val1 + val2\n\n        # Assemble load vector d for p_h using the exact formula for a(u, phi_i)\n        d = np.zeros(dim)\n        for i in range(dim):\n            node_idx = i + 1\n            x_im1, x_i, x_ip1 = x_nodes[node_idx-1], x_nodes[node_idx], x_nodes[node_idx+1]\n            d[i] = (2.0 * u_func(x_i) - u_func(x_im1) - u_func(x_ip1)) / h\n\n        # Solve for coefficients\n        if dim > 0:\n            coeffs_uh = np.linalg.solve(A, b)\n            coeffs_ph = np.linalg.solve(A, d)\n        else: # N=1 case, not in test suite\n            coeffs_uh = np.array([])\n            coeffs_ph = np.array([])\n            \n        # Add boundary values (0)\n        c_full = np.concatenate(([0.0], coeffs_uh, [0.0]))\n        p_full = np.concatenate(([0.0], coeffs_ph, [0.0]))\n\n        # Numerically compute the energy norm errors ||u - u_h||_a^2 and ||u - p_h||_a^2\n        err_uh_sq = 0.0\n        err_ph_sq = 0.0\n        \n        for k in range(N):\n            xk, xkp1 = x_nodes[k], x_nodes[k+1]\n            \n            # u_h'(x) is constant on (xk, xkp1)\n            uh_prime_val = (c_full[k+1] - c_full[k]) / h\n            # p_h'(x) is constant on (xk, xkp1)\n            ph_prime_val = (p_full[k+1] - p_full[k]) / h\n            \n            # Integrand for ||u - u_h||_a^2\n            integrand_uh = lambda x: (u_prime_func(x) - uh_prime_val)**2\n            # Integrand for ||u - p_h||_a^2\n            integrand_ph = lambda x: (u_prime_func(x) - ph_prime_val)**2\n            \n            # Accumulate integral over each element\n            err_uh_sq += quad(integrand_uh, xk, xkp1, epsabs=1e-14, epsrel=1e-14)[0]\n            err_ph_sq += quad(integrand_ph, xk, xkp1, epsabs=1e-14, epsrel=1e-14)[0]\n\n        # Compute the ratio R_h\n        if err_ph_sq  1e-15: # Avoid division by zero if p_h is extremely accurate\n             ratio = 1.0 if err_uh_sq  1e-15 else np.inf\n        else:\n            ratio = np.sqrt(err_uh_sq) / np.sqrt(err_ph_sq)\n        \n        ratios.append(ratio)\n    \n    # Verify if all ratios satisfy the bound R_h = B + tolerance\n    tolerance = 1e-8\n    test_passed = all(r = bound_B + tolerance for r in ratios)\n    \n    final_output = ratios + [bound_B, test_passed]\n\n    # Format the output as a string\n    output_str = f\"[{','.join(map(str, final_output))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2539864"}]}