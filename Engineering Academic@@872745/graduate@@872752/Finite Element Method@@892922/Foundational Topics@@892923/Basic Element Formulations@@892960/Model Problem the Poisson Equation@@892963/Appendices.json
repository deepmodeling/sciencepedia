{"hands_on_practices": [{"introduction": "The journey from the continuous weak formulation of the Poisson equation to a solvable algebraic system begins at the element level. This first practice focuses on the fundamental building block of a finite element code: the element stiffness matrix. By deriving this matrix from first principles for a standard reference triangle, you will gain a concrete understanding of how the differential operator is discretized and see how geometric information is encoded into the algebraic system [@problem_id:2579542].", "problem": "Consider the model Poisson problem $-\\Delta u = f$ on a single reference element used in the Finite Element Method (FEM). Let $\\widehat{T}$ denote the reference right triangle in $\\mathbb{R}^{2}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. Let $\\{\\widehat{N}_{1},\\widehat{N}_{2},\\widehat{N}_{3}\\}$ be the standard linear Lagrange shape functions associated with these vertices. The element stiffness matrix $K^{e} \\in \\mathbb{R}^{3 \\times 3}$ for the Laplace operator with unit diffusion is defined by the bilinear form\n$$\nK^{e}_{ij} \\;=\\; \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}, \\quad i,j \\in \\{1,2,3\\}.\n$$\nStarting from the weak form of the Poisson equation and the definition of the linear shape functions on $\\widehat{T}$, derive $K^{e}$ explicitly by first principles (do not assume any precomputed element matrices), and use your derivation to verify symmetry and to rigorously characterize definiteness. In particular, determine whether $K^{e}$ is strictly positive definite or only positive semidefinite, and identify the nullspace if it exists.\n\nYour final reported quantity must be the exact value of $\\det(K^{e})$ as a single real number. No rounding is required and no units apply. Provide the full derivation and justification, then report only $\\det(K^{e})$ as the final answer.", "solution": "The problem requires the derivation and analysis of the element stiffness matrix $K^{e}$ for the Laplace operator on the standard two-dimensional linear triangular reference element, $\\widehat{T}$. The vertices of $\\widehat{T}$ are given as $\\widehat{\\mathbf{x}}_1 = (0,0)$, $\\widehat{\\mathbf{x}}_2 = (1,0)$, and $\\widehat{\\mathbf{x}}_3 = (0,1)$.\n\nFirst, we must determine the linear Lagrange shape functions $\\{\\widehat{N}_{1}, \\widehat{N}_{2}, \\widehat{N}_{3}\\}$ associated with these vertices. A linear function on $\\mathbb{R}^{2}$ has the general form $\\widehat{N}(\\widehat{x}, \\widehat{y}) = a\\widehat{x} + b\\widehat{y} + c$. The shape function $\\widehat{N}_{i}$ is defined by the property $\\widehat{N}_{i}(\\widehat{\\mathbf{x}}_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nFor $\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = a_1\\widehat{x} + b_1\\widehat{y} + c_1$:\nThe conditions are $\\widehat{N}_{1}(0,0)=1$, $\\widehat{N}_{1}(1,0)=0$, $\\widehat{N}_{1}(0,1)=0$.\nFrom $\\widehat{N}_{1}(0,0)=1$, we get $c_1=1$.\nFrom $\\widehat{N}_{1}(1,0)=0$, we get $a_1 + c_1 = 0 \\implies a_1 = -1$.\nFrom $\\widehat{N}_{1}(0,1)=0$, we get $b_1 + c_1 = 0 \\implies b_1 = -1$.\nThus, $\\widehat{N}_{1}(\\widehat{x}, \\widehat{y}) = 1 - \\widehat{x} - \\widehat{y}$.\n\nFor $\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = a_2\\widehat{x} + b_2\\widehat{y} + c_2$:\nThe conditions are $\\widehat{N}_{2}(0,0)=0$, $\\widehat{N}_{2}(1,0)=1$, $\\widehat{N}_{2}(0,1)=0$.\nFrom $\\widehat{N}_{2}(0,0)=0$, we get $c_2=0$.\nFrom $\\widehat{N}_{2}(1,0)=1$, we get $a_2 = 1$.\nFrom $\\widehat{N}_{2}(0,1)=0$, we get $b_2 = 0$.\nThus, $\\widehat{N}_{2}(\\widehat{x}, \\widehat{y}) = \\widehat{x}$.\n\nFor $\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = a_3\\widehat{x} + b_3\\widehat{y} + c_3$:\nThe conditions are $\\widehat{N}_{3}(0,0)=0$, $\\widehat{N}_{3}(1,0)=0$, $\\widehat{N}_{3}(0,1)=1$.\nFrom $\\widehat{N}_{3}(0,0)=0$, we get $c_3=0$.\nFrom $\\widehat{N}_{3}(1,0)=0$, we get $a_3 = 0$.\nFrom $\\widehat{N}_{3}(0,1)=1$, we get $b_3 = 1$.\nThus, $\\widehat{N}_{3}(\\widehat{x}, \\widehat{y}) = \\widehat{y}$.\n\nNext, we compute the gradients of these shape functions. As the functions are linear, their gradients are constant vectors.\n$$\n\\nabla \\widehat{N}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad\n\\nabla \\widehat{N}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}.\n$$\n\nThe entries of the element stiffness matrix $K^{e}$ are defined by $K^{e}_{ij} = \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}$. Since the gradients are constant, the dot products $\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}$ are also constant. Therefore, the integral is simply the product of this constant value and the area of the domain $\\widehat{T}$.\n$$\nK^{e}_{ij} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\int_{\\widehat{T}} 1 \\, d\\widehat{x} = (\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j}) \\cdot \\text{Area}(\\widehat{T}).\n$$\nThe area of the right triangle with vertices $(0,0)$, $(1,0)$, and $(0,1)$ is $\\text{Area}(\\widehat{T}) = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 1 \\times 1 = \\frac{1}{2}$.\n\nWe now compute the dot products of the gradients:\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{1} = (-1)^2 + (-1)^2 = 2$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{2} = (-1)(1) + (-1)(0) = -1$.\n$\\nabla \\widehat{N}_{1} \\cdot \\nabla \\widehat{N}_{3} = (-1)(0) + (-1)(1) = -1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{2} = (1)^2 + (0)^2 = 1$.\n$\\nabla \\widehat{N}_{2} \\cdot \\nabla \\widehat{N}_{3} = (1)(0) + (0)(1) = 0$.\n$\\nabla \\widehat{N}_{3} \\cdot \\nabla \\widehat{N}_{3} = (0)^2 + (1)^2 = 1$.\n\nUsing these values and $\\text{Area}(\\widehat{T}) = \\frac{1}{2}$, we assemble the matrix $K^{e}$:\n$K^{e}_{11} = 2 \\times \\frac{1}{2} = 1$.\n$K^{e}_{12} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{13} = -1 \\times \\frac{1}{2} = -\\frac{1}{2}$.\n$K^{e}_{22} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n$K^{e}_{23} = 0 \\times \\frac{1}{2} = 0$.\n$K^{e}_{33} = 1 \\times \\frac{1}{2} = \\frac{1}{2}$.\n\nBy commutativity of the dot product, $\\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} = \\nabla \\widehat{N}_{j} \\cdot \\nabla \\widehat{N}_{i}$, which implies $K^{e}_{ij} = K^{e}_{ji}$. The matrix is symmetric. The full matrix is:\n$$\nK^{e} = \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n2  -1  -1 \\\\\n-1  1  0 \\\\\n-1  0  1\n\\end{pmatrix}.\n$$\n\nNow, we analyze the definiteness of $K^{e}$. Consider an arbitrary vector $\\mathbf{v} = (v_1, v_2, v_3)^T \\in \\mathbb{R}^3$ and the associated quadratic form $\\mathbf{v}^T K^e \\mathbf{v}$. Let $\\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\sum_{j=1}^{3} v_j \\widehat{N}_j(\\widehat{\\mathbf{x}})$ be a function in the finite element space. The quadratic form is:\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\sum_{i=1}^{3} \\sum_{j=1}^{3} v_i K^{e}_{ij} v_j = \\sum_{i,j} v_i v_j \\int_{\\widehat{T}} \\nabla \\widehat{N}_{i} \\cdot \\nabla \\widehat{N}_{j} \\, d\\widehat{x}\n$$\nBy linearity of integration and differentiation, this becomes:\n$$\n\\mathbf{v}^T K^e \\mathbf{v} = \\int_{\\widehat{T}} \\left( \\sum_{i=1}^{3} v_i \\nabla \\widehat{N}_{i} \\right) \\cdot \\left( \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_{j} \\right) \\, d\\widehat{x} = \\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x}.\n$$\nSince the integrand $|\\nabla \\widehat{u}_h|^2$ is non-negative, the integral is non-negative. Therefore, $\\mathbf{v}^T K^e \\mathbf{v} \\geq 0$ for all $\\mathbf{v} \\in \\mathbb{R}^3$, which proves that $K^{e}$ is positive semidefinite.\n\nFor $K^{e}$ to be positive definite, $\\mathbf{v}^T K^e \\mathbf{v} = 0$ must imply $\\mathbf{v} = \\mathbf{0}$. The condition $\\mathbf{v}^T K^e \\mathbf{v} = 0$ is equivalent to $\\int_{\\widehat{T}} |\\nabla \\widehat{u}_h|^2 \\, d\\widehat{x} = 0$. Since the integrand is continuous and non-negative, this implies $\\nabla \\widehat{u}_h(\\widehat{\\mathbf{x}}) = \\mathbf{0}$ for all $\\widehat{\\mathbf{x}} \\in \\widehat{T}$.\n$$\n\\nabla \\widehat{u}_h = \\nabla \\left( \\sum_{j=1}^{3} v_j \\widehat{N}_j \\right) = \\sum_{j=1}^{3} v_j \\nabla \\widehat{N}_j = v_1 \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} + v_2 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + v_3 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -v_1 + v_2 \\\\ -v_1 + v_3 \\end{pmatrix}.\n$$\nSetting the gradient to zero gives the system:\n$$\n-v_1 + v_2 = 0 \\implies v_1 = v_2\n$$\n$$\n-v_1 + v_3 = 0 \\implies v_1 = v_3\n$$\nThus, $\\nabla \\widehat{u}_h = \\mathbf{0}$ if and only if $v_1 = v_2 = v_3$. Any vector of the form $\\mathbf{v} = c(1, 1, 1)^T$ for a scalar $c \\in \\mathbb{R}$ will result in $\\mathbf{v}^T K^e \\mathbf{v} = 0$. If $c \\neq 0$, then $\\mathbf{v} \\neq \\mathbf{0}$. This proves that $K^{e}$ is not positive definite; it is only positive semidefinite.\nThe set of such vectors forms the nullspace (kernel) of $K^e$:\n$$\n\\text{ker}(K^e) = \\{ \\mathbf{v} \\in \\mathbb{R}^3 : K^e \\mathbf{v} = \\mathbf{0} \\} = \\text{span} \\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right\\}.\n$$\nThe physical meaning is that constant functions $\\widehat{u}_h = c \\sum \\widehat{N}_j = c(1) = c$ have zero gradient, and thus zero \"strain energy\" $\\int |\\nabla u|^2$.\n\nFinally, we must compute the determinant of $K^{e}$. A fundamental theorem of linear algebra states that a square matrix is singular (i.e., not invertible) if and only if its nullspace is non-trivial. As we have shown that $\\text{dim}(\\text{ker}(K^e)) = 1$, the matrix $K^{e}$ is singular. The determinant of any singular matrix is zero.\nTherefore, $\\det(K^{e}) = 0$.\n\nFor completeness, we verify this by direct computation:\n$$\n\\det(K^{e}) = \\det \\begin{pmatrix}\n1  -\\frac{1}{2}  -\\frac{1}{2} \\\\\n-\\frac{1}{2}  \\frac{1}{2}  0 \\\\\n-\\frac{1}{2}  0  \\frac{1}{2}\n\\end{pmatrix}\n$$\n$$\n= 1 \\left( (\\frac{1}{2})(\\frac{1}{2}) - (0)(0) \\right) - (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(\\frac{1}{2}) - (0)(-\\frac{1}{2}) \\right) + (-\\frac{1}{2}) \\left( (-\\frac{1}{2})(0) - (\\frac{1}{2})(-\\frac{1}{2}) \\right)\n$$\n$$\n= 1 \\left( \\frac{1}{4} \\right) + \\frac{1}{2} \\left( -\\frac{1}{4} \\right) - \\frac{1}{2} \\left( \\frac{1}{4} \\right)\n$$\n$$\n= \\frac{1}{4} - \\frac{1}{8} - \\frac{1}{8} = \\frac{1}{4} - \\frac{2}{8} = \\frac{1}{4} - \\frac{1}{4} = 0.\n$$\nThe calculation confirms the theoretical result. The final answer is $0$.", "answer": "$$\n\\boxed{0}\n$$", "id": "2579542"}, {"introduction": "The global stiffness matrix is assembled by summing local contributions, and its structure dictates the qualitative behavior of the numerical solution. This exercise explores the critical link between mesh geometry and a desirable solution property known as the Discrete Maximum Principle (DMP). You will conduct a thought experiment to see how specific mesh features, such as obtuse angles, can lead to a violation of the M-matrix condition, providing a tangible example of why mesh quality is paramount for obtaining physically meaningful results [@problem_id:2579531].", "problem": "Consider the model problem for the Poisson equation: find $u:\\Omega \\to \\mathbb{R}$ such that $-\\Delta u = f$ in $\\Omega$ with $u = 0$ on $\\partial \\Omega$, where $\\Omega \\subset \\mathbb{R}^2$ is a polygonal domain. Let $V_h$ be the conforming space of continuous, piecewise linear functions ($P_1$ finite elements) over a shape-regular triangulation $\\mathcal{T}_h$ of $\\Omega$. The Galerkin method seeks $u_h \\in V_h$ such that $\\int_{\\Omega} \\nabla u_h \\cdot \\nabla v_h \\, dx = \\int_{\\Omega} f v_h \\, dx$ for all $v_h \\in V_h$ vanishing on $\\partial \\Omega$. For data $f \\le 0$ (pointwise almost everywhere), the continuous maximum principle implies $u \\le 0$ in $\\Omega$. A commonly used sufficient algebraic condition for the discrete maximum principle is that the assembled stiffness matrix has nonpositive off-diagonal entries and is an $M$-matrix.\n\nYour task is to identify a concrete mesh construction that contains an obtuse triangle and, for homogeneous Dirichlet boundary conditions, actually violates the discrete maximum principle for $P_1$ elements. Select the option that both:\n- specifies a triangulation with enough detail to identify an interior edge whose assembled off-diagonal stiffness entry becomes positive, and\n- correctly explains the algebraic reason in terms of the signs of the assembled off-diagonal stiffness entries.\n\nChoose exactly one option.\n\nA. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, and two additional vertices $k=(0.5,0.26)$ (just above the segment $\\overline{ij}$) and $\\ell=(0.5,0.80)$ (well above $\\overline{ij}$). Include the two triangles $T_1 = \\triangle(i,j,k)$ and $T_2 = \\triangle(i,j,\\ell)$ in the triangulation, and complete the mesh on $\\Omega$ with any shape-regular triangulation that uses these vertices and imposes $u_h=0$ on $\\partial \\Omega$. The angle at $k$ opposite the interior edge $(i,j)$ is obtuse, with $\\alpha_k \\approx \\pi - 2\\arctan\\left(\\frac{0.01}{0.25}\\right)$, so $\\cot \\alpha_k  0$ with large magnitude, while the angle at $\\ell$ opposite $(i,j)$ is acute, with $\\cot \\alpha_\\ell > 0$ but moderate. Therefore, the assembled off-diagonal entry for the interior edge $(i,j)$ satisfies $K_{ij} = -\\tfrac{1}{2}\\big(\\cot \\alpha_k + \\cot \\alpha_\\ell\\big) > 0$. This breaks the nonpositivity of off-diagonals, so the stiffness matrix is not an $M$-matrix and the discrete maximum principle can be violated for some $f \\le 0$.\n\nB. Let $\\Omega$ be the right triangle with vertices $(0,0)$, $(1,0)$, $(0,1)$. Insert a single interior node $p=(0.5,0.10)$ and connect $p$ to all three vertices to form three triangles, one of which has an obtuse angle at $p$ opposite the boundary edge $[(0,0),(1,0)]$. Since this produces a positive off-diagonal between the boundary nodes $(0,0)$ and $(1,0)$, the discrete maximum principle is violated.\n\nC. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, and place $k=(0.5,0.60)$ and $\\ell=(0.5,0.80)$ above the segment $\\overline{ij}$. Include $T_1=\\triangle(i,j,k)$ and $T_2=\\triangle(i,j,\\ell)$ and complete the mesh on $\\Omega$ with $u_h=0$ on $\\partial \\Omega$. Although both angles opposite $(i,j)$ in $T_1$ and $T_2$ are acute, the presence of two adjacent triangles around the interior edge is enough to force a violation of the discrete maximum principle due to mesh anisotropy.\n\nD. Let $\\Omega = (0,1)^2$. Introduce interior nodes $i=(0.25,0.25)$ and $j=(0.75,0.25)$, take $k=(0.5,0.40)$ slightly above $\\overline{ij}$ and use the boundary vertex $\\ell=(0.5,1)$, and triangulate so that $T_1=\\triangle(i,j,k)$ and $T_2=\\triangle(i,j,\\ell)$ are included. The angle at $k$ opposite $(i,j)$ is obtuse, hence the discrete maximum principle must fail because an obtuse angle always forces a positive assembled off-diagonal $K_{ij}$.", "solution": "The problem statement poses a valid question within the established theory of the finite element method for second-order elliptic partial differential equations. The premises are scientifically sound, the terminology is standard, and the task is a well-posed constructive problem. We will therefore proceed with the analysis.\n\nThe core of this problem rests upon the formula for the off-diagonal entries of the stiffness matrix $K$ for the negative Laplacian operator discretized with continuous, piecewise linear ($P_1$) basis functions. Let $i$ and $j$ be the indices of two distinct nodes in the triangulation $\\mathcal{T}_h$. The corresponding off-diagonal entry of the stiffness matrix is $K_{ij} = a(\\phi_j, \\phi_i) = \\int_{\\Omega} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx$, where $\\phi_i$ and $\\phi_j$ are the Lagrangian basis functions associated with nodes $i$ and $j$.\n\nThis integral is non-zero only if nodes $i$ and $j$ belong to a common triangle. If the edge connecting nodes $i$ and $j$, denoted by $e_{ij}$, is an interior edge of the mesh, it is typically shared by two triangles, say $T_1$ and $T_2$. Let the vertices of these triangles be $(i, j, k)$ and $(i, j, \\ell)$, respectively. The angles in $T_1$ and $T_2$ opposite the shared edge $e_{ij}$ are denoted by $\\alpha_k$ and $\\alpha_\\ell$. A standard result from finite element analysis states that the contribution from a single triangle $T_1$ to the stiffness entry is $\\int_{T_1} \\nabla \\phi_i \\cdot \\nabla \\phi_j \\, dx = -\\frac{1}{2} \\cot \\alpha_k$.\n\nConsequently, the assembled off-diagonal entry for the interior edge $e_{ij}$ is the sum of contributions from both triangles:\n$$ K_{ij} = -\\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_\\ell) $$\nA sufficient condition for the discrete maximum principle (DMP) to hold is that the stiffness matrix (for interior nodes) is an $M$-matrix. A necessary property of an $M$-matrix is that all its off-diagonal entries are non-positive. Thus, we require $K_{ij} \\le 0$ for all $i \\neq j$. From the formula above, this is equivalent to the condition:\n$$ \\cot \\alpha_k + \\cot \\alpha_\\ell \\ge 0 $$\nThis is a local, geometry-based condition often called the Delaunay condition. An angle $\\alpha$ is acute if $0  \\alpha  \\pi/2$, for which $\\cot \\alpha  0$. An angle is obtuse if $\\pi/2  \\alpha  \\pi$, for which $\\cot \\alpha  0$. If both $\\alpha_k$ and $\\alpha_\\ell$ are acute, the condition is trivially satisfied and $K_{ij}  0$. A violation, leading to $K_{ij}  0$, can only occur if one of the angles is obtuse, say $\\alpha_k  \\pi/2$, such that its negative cotangent is large enough in magnitude to overcome the positive cotangent of the other angle: $|\\cot \\alpha_k|  \\cot \\alpha_\\ell$.\n\nWe now evaluate each option based on this principle.\n\n**Option A:**\nThis option proposes a specific mesh geometry. Let the nodes be $i=(0.25, 0.25)$, $j=(0.75, 0.25)$, $k=(0.5, 0.26)$, and $\\ell=(0.5, 0.80)$. The common edge is $\\overline{ij}$, which has length $d_{ij}=0.5$.\nFor triangle $T_1 = \\triangle(i,j,k)$, the vertex $k$ is at a height of $h_k = 0.26 - 0.25 = 0.01$ above the midpoint of $\\overline{ij}$. This is an isosceles triangle. The angle $\\alpha_k$ at vertex $k$ is obtuse. We can calculate its cotangent. The angle $\\theta$ at the base is given by $\\tan \\theta = h_k / (d_{ij}/2) = 0.01 / 0.25 = 1/25$. The angle $\\alpha_k = \\pi - 2\\theta$. Thus, $\\cot \\alpha_k = \\cot(\\pi-2\\theta) = -\\cot(2\\theta) = -\\frac{1-\\tan^2\\theta}{2\\tan\\theta} = -\\frac{1-(1/25)^2}{2(1/25)} = -\\frac{1 - 1/625}{2/25} = -\\frac{624/625}{2/25} = -\\frac{624}{625} \\cdot \\frac{25}{2} = -\\frac{312}{25} = -12.48$. This is a large-magnitude negative number.\nFor triangle $T_2 = \\triangle(i,j,\\ell)$, the vertex $\\ell$ is at a height of $h_\\ell = 0.80 - 0.25 = 0.55$ above the midpoint of $\\overline{ij}$. The angle $\\alpha_\\ell$ is acute. The angle $\\phi$ at the base is given by $\\tan \\phi = h_\\ell / (d_{ij}/2) = 0.55 / 0.25 = 55/25 = 11/5$. This is incorrect, $\\phi$ is not the base angle. The half angle at vertex $\\ell$, let's call it $\\gamma$, satisfies $\\tan \\gamma = (d_{ij}/2)/h_\\ell = 0.25/0.55 = 25/55 = 5/11$. Then $\\cot \\alpha_\\ell = \\frac{1-\\tan^2\\gamma}{2\\tan\\gamma} = \\frac{1-(5/11)^2}{2(5/11)} = \\frac{1-25/121}{10/11} = \\frac{96/121}{10/11} = \\frac{96}{110} = \\frac{48}{55} \\approx 0.8727$.\nThe sum of the cotangents is $\\cot \\alpha_k + \\cot \\alpha_\\ell = -12.48 + \\frac{48}{55} \\approx -12.48 + 0.8727 = -11.6073  0$.\nTherefore, the assembled off-diagonal entry is $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)  0$. This violates the non-positivity condition. The reasoning provided in the option is entirely consistent with this derivation.\nVerdict: **Correct**.\n\n**Option B:**\nThis option describes a triangulation where an obtuse angle is formed opposite a *boundary* edge. The nodes on the boundary are subject to Dirichlet conditions ($u_h = 0$). In the assembly of the linear system $Ku=F$, the equations corresponding to boundary nodes are not solved for; they are eliminated from the system. The matrix properties, such as being an M-matrix, that guarantee the DMP are required for the reduced stiffness matrix corresponding only to the *interior* degrees of freedom. An off-diagonal entry between two boundary nodes, such as $K_{(0,0),(1,0)}$, does not appear in this reduced system and has no influence on the interior solution's adherence to the DMP. Therefore, the reasoning is fundamentally flawed.\nVerdict: **Incorrect**.\n\n**Option C:**\nThis option proposes a configuration with nodes $i=(0.25,0.25)$, $j=(0.75,0.25)$, $k=(0.5,0.60)$, and $\\ell=(0.5,0.80)$. Both triangles $T_1 = \\triangle(i,j,k)$ and $T_2 = \\triangle(i,j,\\ell)$ are isosceles with a common base $\\overline{ij}$.\nFor $T_1$, the height is $h_k = 0.60 - 0.25 = 0.35$. The half-angle at $k$ is $\\gamma_k$ where $\\tan \\gamma_k = (0.5/2)/0.35 = 0.25/0.35 = 5/7  1$. Thus $\\gamma_k  \\pi/4$, which implies the full angle $\\alpha_k  \\pi/2$. It is acute, and $\\cot \\alpha_k  0$.\nFor $T_2$, the height is $h_\\ell = 0.80 - 0.25 = 0.55$. The half-angle at $\\ell$ is $\\gamma_\\ell$ where $\\tan \\gamma_\\ell = 0.25/0.55 = 5/11  1$. Thus the full angle $\\alpha_\\ell  \\pi/2$. It is also acute, and $\\cot \\alpha_\\ell  0$.\nThe assembled off-diagonal is $K_{ij} = -\\frac{1}{2}(\\cot \\alpha_k + \\cot \\alpha_\\ell)$. Since both cotangents are positive, their sum is positive, and $K_{ij}$ must be negative. The non-positivity condition is satisfied. The claim that this configuration forces a violation of the DMP is false; on the contrary, for this specific edge, the condition is met. The term \"mesh anisotropy\" is used vaguely and does not justify the incorrect conclusion.\nVerdict: **Incorrect**.\n\n**Option D:**\nThis option proposes a geometry with an obtuse triangle and makes the claim that an obtuse angle \"always forces a positive assembled off-diagonal $K_{ij}$.\" This claim is a logical fallacy. The sign of $K_{ij}$ depends on the sign of $-(\\cot \\alpha_k + \\cot \\alpha_\\ell)$. For $K_{ij}$ to be positive, we need $\\cot \\alpha_k + \\cot \\alpha_\\ell  0$. If one angle, $\\alpha_k$, is obtuse, $\\cot \\alpha_k$ is negative. This is a necessary condition, but not sufficient. If the other angle, $\\alpha_\\ell$, is acute and sufficiently \"sharp\" (close to $0$), its cotangent will be large and positive, potentially making the sum non-negative.\nLet us examine the specific geometry provided: $i=(0.25,0.25)$, $j=(0.75,0.25)$, $k=(0.5,0.40)$, $\\ell=(0.5,1)$.\nFor $T_1 = \\triangle(i,j,k)$, height $h_k=0.40-0.25=0.15$. Half-angle $\\gamma_k$ at $k$ has $\\tan \\gamma_k = (0.5/2)/0.15 = 0.25/0.15 = 5/3  1$. Thus, $\\alpha_k  \\pi/2$ (obtuse). We calculate $\\cot \\alpha_k = \\frac{1-\\tan^2\\gamma_k}{2\\tan\\gamma_k} = \\frac{1-(5/3)^2}{2(5/3)} = \\frac{1-25/9}{10/3} = \\frac{-16/9}{10/3} = -\\frac{16}{30} = -\\frac{8}{15}$.\nFor $T_2 = \\triangle(i,j,\\ell)$, height $h_\\ell = 1-0.25=0.75$. Half-angle $\\gamma_\\ell$ at $\\ell$ has $\\tan \\gamma_\\ell = (0.5/2)/0.75 = 0.25/0.75 = 1/3  1$. Thus, $\\alpha_\\ell  \\pi/2$ (acute). We calculate $\\cot \\alpha_\\ell = \\frac{1-(1/3)^2}{2(1/3)} = \\frac{1-1/9}{2/3} = \\frac{8/9}{2/3} = \\frac{12}{9} = \\frac{4}{3}$.\nThe sum is $\\cot \\alpha_k + \\cot \\alpha_\\ell = -8/15 + 4/3 = (-8 + 20)/15 = 12/15  0$.\nThe assembled stiffness entry is $K_{ij} = -\\frac{1}{2}(12/15)  0$.\nThe non-positivity condition is satisfied for this edge. The example provided in the option directly contradicts its own fallacious claim.\nVerdict: **Incorrect**.\n\nBased on this rigorous analysis, Option A is the only one that provides both a correct geometric construction and a correct algebraic explanation for the violation of the non-positivity of off-diagonal stiffness matrix entries, which is a key condition for the discrete maximum principle.", "answer": "$$\\boxed{A}$$", "id": "2579531"}, {"introduction": "Moving from local analysis to a global perspective, this final practice involves implementing a complete FEM solver to verify a cornerstone of the method's theory. The solution to the Poisson equation can be characterized as the minimizer of an energy functional, and the finite element solution is the best approximation in this energy sense. This coding challenge allows you to numerically demonstrate that as the mesh is refined, the energy of the computed solution monotonically decreases, converging towards the true minimum [@problem_id:2579540].", "problem": "Consider the model boundary value problem of the Poisson equation on the unit square. Let $\\Omega=(0,1)^2$, let $f:\\Omega\\to\\mathbb{R}$ be smooth, and consider the Dirichlet problem\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega,\\qquad u=0 \\quad \\text{on } \\partial\\Omega.\n$$\nThe corresponding energy functional is\n$$\nJ(v) = \\tfrac{1}{2}\\int_{\\Omega}\\lvert \\nabla v \\rvert^2\\,\\mathrm{d}x - \\int_{\\Omega} f\\, v\\,\\mathrm{d}x,\n$$\ndefined for $v$ in the Sobolev space $H_0^1(\\Omega)$.\n\nYou are to verify numerically, using a conforming Finite Element Method (FEM) with continuous piecewise linear shape functions on conforming triangulations of $\\Omega$, that $J(u_h)$ decreases monotonically under uniform mesh refinement, where $u_h$ denotes the unique Galerkin solution in the conforming finite element space $V_h \\subset H_0^1(\\Omega)$. The verification must be done by computing $J(u_h)$ directly from the assembled discrete bilinear and linear forms on a sequence of uniformly refined nested meshes.\n\nFundamental starting point:\n- Use the weak form based on the first principles of the calculus of variations: $u\\in H_0^1(\\Omega)$ is characterized as the unique minimizer of $J$ over $H_0^1(\\Omega)$, equivalently satisfying $\\int_{\\Omega} \\nabla u\\cdot\\nabla v\\,\\mathrm{d}x = \\int_{\\Omega} f v\\,\\mathrm{d}x$ for all $v\\in H_0^1(\\Omega)$.\n- For conforming discretizations $V_h\\subset H_0^1(\\Omega)$, the Galerkin solution $u_h\\in V_h$ is the unique minimizer of $J$ restricted to $V_h$.\n\nAlgorithmic specification to implement:\n- Construct uniform, shape-regular, nested triangulations by partitioning $\\Omega$ into $N\\times N$ congruent squares and subdividing each square along the lower-left to upper-right diagonal, where $N\\in\\mathbb{N}$. This produces two right triangles per square. The nodes of the refinement with $2N$ are a superset of those for $N$, ensuring nested conforming spaces.\n- Use continuous, piecewise linear basis functions (conforming $P^1$ finite elements) with homogeneous essential boundary conditions enforced strongly by zeroing the boundary degrees of freedom.\n- Assemble the global stiffness matrix by summing element contributions of the integral $\\int_T \\nabla \\phi_i\\cdot\\nabla \\phi_j\\,\\mathrm{d}x$ over each triangle $T$, which is exactly computable because the gradients of $P^1$ basis functions are elementwise constant.\n- Assemble the global load vector by summing element contributions of the integral $\\int_T f\\,\\phi_i\\,\\mathrm{d}x$ for each element $T$. For general smooth $f$, approximate this integral with a high-order quadrature that is sufficiently accurate to make the monotonic behavior detectable. Use at least degree-$5$ Gaussian quadrature on triangles. For the special case $f\\equiv 1$, you must compute the element load exactly using the identity $\\int_T \\phi_i\\,\\mathrm{d}x = \\lvert T\\rvert/3$, where $\\lvert T\\rvert$ is the area of triangle $T$, to avoid unnecessary quadrature error.\n- Solve the linear system for the interior degrees of freedom to obtain $u_h$.\n- Compute the discrete energy value from the assembled operators as\n$$\nJ(u_h) = \\tfrac{1}{2}\\, \\mathbf{u}^\\top \\mathbf{K}\\,\\mathbf{u} - \\mathbf{u}^\\top \\mathbf{b},\n$$\nwhere $\\mathbf{K}$ is the stiffness matrix restricted to interior nodes, $\\mathbf{b}$ is the corresponding load vector, and $\\mathbf{u}$ is the vector of interior nodal values of $u_h$.\n\nTests to perform:\n- Test A (constant forcing, exact element loads): $f(x,y)=1$ for all $(x,y)\\in\\Omega$, with mesh parameters $N\\in\\{1,2,4,8,16,32\\}$. Check whether the sequence $\\{J(u_h)\\}$ is non-increasing within a numerical tolerance of $10^{-12}$.\n- Test B (trigonometric forcing, quadrature): $f(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ with mesh parameters $N\\in\\{2,4,8,16,32\\}$. Use at least degree-$5$ triangular Gaussian quadrature for load assembly. Check non-increasing within a tolerance of $10^{-10}$.\n- Test C (exponential forcing, quadrature): $f(x,y)=\\mathrm{e}^{x+y}$ with mesh parameters $N\\in\\{2,4,8,16\\}$. Use at least degree-$5$ triangular Gaussian quadrature for load assembly. Check non-increasing within a tolerance of $10^{-10}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the three boolean results of the monotonicity checks for Tests A, B, and C, respectively, as a comma-separated list enclosed in square brackets, for example, $[\\text{True},\\text{True},\\text{True}]$.\n- No additional text should be printed.\n\nNo physical units are involved. All angles, where applicable in any auxiliary computation, are to be in radians. All percentages, if any arise in intermediate checks, must be treated as decimals and are not part of the required output. Ensure that your program is fully self-contained, requires no input, and uses only the specified libraries.", "solution": "The problem statement poses a request for the numerical verification of a fundamental property of conforming Galerkin finite element methods. The problem is scientifically valid, mathematically well-posed, and provides a complete and unambiguous specification for its implementation. No flaws, contradictions, or invalid premises are present.\n\nThe core principle to be verified is a direct consequence of the Rayleigh-Ritz minimization principle applied to nested, conforming approximation spaces. Given a sequence of uniformly refined meshes $\\mathcal{T}_{h_k}$ such that the mesh size $h_k \\to 0$, we obtain a corresponding sequence of nested finite element spaces $V_{h_1} \\subset V_{h_2} \\subset \\dots \\subset H_0^1(\\Omega)$. The Galerkin solution $u_{h_k} \\in V_{h_k}$ is, by definition, the unique minimizer of the energy functional $J(v)$ over the space $V_{h_k}$.\n$$\nJ(u_{h_k}) = \\min_{v_h \\in V_{h_k}} J(v_h)\n$$\nSince $V_{h_k} \\subset V_{h_{k+1}}$, any function in $V_{h_k}$ is also a candidate trial function in the minimization over $V_{h_{k+1}}$. In particular, $u_{h_k} \\in V_{h_{k+1}}$. Therefore, the minimum energy over the larger space $V_{h_{k+1}}$ cannot be greater than the energy evaluated at any function from that space, including $u_{h_k}$.\n$$\nJ(u_{h_{k+1}}) \\le J(u_{h_k})\n$$\nThis demonstrates that the sequence of energy values $\\{J(u_{h_k})\\}$ for the Galerkin solutions on a sequence of nested, conforming finite element spaces must be monotonically non-increasing. The problem is to verify this theoretical result numerically.\n\nThe implementation proceeds as follows, adhering to the algorithmic specification.\n\n**1. Discretization and Finite Element Space**\nThe domain $\\Omega=(0,1)^2$ is discretized using a uniform grid of $N \\times N$ squares, each with side length $h=1/N$. Each square is subdivided into two right-angled, isosceles triangles by its lower-left to upper-right diagonal. This produces a conforming triangulation $\\mathcal{T}_h$. The finite element space $V_h$ is composed of continuous functions that are piecewise linear polynomials on each triangle $T \\in \\mathcal{T}_h$ and vanish on the boundary $\\partial\\Omega$. A basis for $V_h$ is given by the set of nodal \"hat\" functions $\\{\\phi_i\\}$ associated with the interior nodes of the mesh.\n\n**2. Algebraic Formulation**\nThe Galerkin solution $u_h = \\sum_{i \\in \\mathcal{I}} u_i \\phi_i(x)$ (where $\\mathcal{I}$ is the set of interior node indices) is found by solving the linear algebraic system $\\mathbf{K}\\mathbf{u} = \\mathbf{b}$. The system is restricted to the $(N-1)^2$ interior degrees of freedom, which corresponds to a strong enforcement of the homogeneous Dirichlet boundary conditions.\nThe entries of the stiffness matrix $\\mathbf{K}$ and load vector $\\mathbf{b}$ are:\n$$\n\\mathbf{K}_{ij} = a(\\phi_j, \\phi_i) = \\int_\\Omega \\nabla \\phi_j \\cdot \\nabla \\phi_i \\, dx \\quad \\text{and} \\quad \\mathbf{b}_i = L(\\phi_i) = \\int_\\Omega f \\phi_i \\, dx\n$$\nThese global matrices are assembled by summing element-wise contributions. For each triangle $T$, we compute the $3 \\times 3$ element stiffness matrix $K^e$ and $3 \\times 1$ element load vector $b^e$.\n\n**3. Element Matrix and Vector Computation**\nThe entries of $K^e$ are computed using an affine mapping $F_T: \\hat{T} \\to T$ from a reference triangle $\\hat{T}$ to the physical triangle $T$. Since the basis functions $\\phi_i$ are linear, their gradients are constant on each element. This allows for the exact computation of the element stiffness matrix:\n$$\nK^e_{\\alpha\\beta} = \\int_T \\nabla\\phi_\\alpha \\cdot \\nabla\\phi_\\beta \\, dx = |T| (\\nabla\\phi_\\alpha \\cdot \\nabla\\phi_\\beta)\n$$\nwhere $|T|$ is the element area, and $\\nabla\\phi_\\alpha = (B_T^{-1})^\\top \\nabla\\hat{\\phi}_\\alpha$ with $B_T$ being the Jacobian of the affine map.\n\nThe element load vector $b^e$ is computed according to the problem specification:\n- For $f(x,y) = 1$, the integral is exact: $b^e_\\alpha = \\int_T \\phi_\\alpha \\, dx = |T|/3$.\n- For general smooth $f$, numerical quadrature is required. A $6$-point symmetric quadrature rule, which is exact for polynomials up to degree $5$, is employed as specified. The integral on an element $T$ is approximated as:\n$$\nb^e_\\alpha = \\int_T f \\phi_\\alpha \\, dx \\approx |T| \\sum_{q=1}^{6} w_q f(x_q) \\hat{\\phi}_\\alpha(\\hat{x}_q)\n$$\nwhere $\\{w_q, \\hat{x}_q\\}$ are the quadrature weights and points on the reference element, and $x_q = F_T(\\hat{x}_q)$ are the corresponding points on the physical element.\n\n**4. Energy Computation and Verification**\nOnce the system $\\mathbf{K}\\mathbf{u}=\\mathbf{b}$ is solved for the vector of interior nodal values $\\mathbf{u}$, the energy of the Galerkin solution $u_h$ is computed. A direct consequence of the Galerkin equation $\\mathbf{K}\\mathbf{u}=\\mathbf{b}$ is that the energy can be calculated efficiently as:\n$$\nJ(u_h) = \\frac{1}{2}\\mathbf{u}^\\top \\mathbf{K} \\mathbf{u} - \\mathbf{u}^\\top \\mathbf{b} = \\frac{1}{2}\\mathbf{u}^\\top \\mathbf{b} - \\mathbf{u}^\\top \\mathbf{b} = -\\frac{1}{2}\\mathbf{u}^\\top \\mathbf{b}\n$$\nThis formula is used for the computation. For each test case, the sequence of energy values $\\{J(u_h)\\}$ is computed for the specified mesh refinement levels $N$. The monotonicity is then checked by verifying that $J(u_{h_{k+1}}) - J(u_{h_k}) \\le \\tau$ for each refinement step, where $\\tau$ is the specified numerical tolerance. The final output is a list of boolean values indicating the success of this check for each test.", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main solver function to run all specified tests and print the final result.\n    \"\"\"\n    # Test A: Constant forcing function f(x,y) = 1\n    # Use exact integration for the load vector.\n    f_A = lambda x, y: np.ones_like(x)\n    N_A = [1, 2, 4, 8, 16, 32]\n    result_A = run_test(f_A, N_A, use_quadrature=False, tol=1e-12)\n\n    # Test B: Trigonometric forcing function\n    f_B = lambda x, y: np.sin(np.pi * x) * np.sin(np.pi * y)\n    N_B = [2, 4, 8, 16, 32]\n    result_B = run_test(f_B, N_B, use_quadrature=True, tol=1e-10)\n\n    # Test C: Exponential forcing function\n    f_C = lambda x, y: np.exp(x + y)\n    N_C = [2, 4, 8, 16]\n    result_C = run_test(f_C, N_C, use_quadrature=True, tol=1e-10)\n\n    results = [result_A, result_B, result_C]\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_test(f, N_values, use_quadrature, tol):\n    \"\"\"\n    Runs a single test case for a given function, mesh sizes, and tolerance.\n    \"\"\"\n    energies = []\n    for N in N_values:\n        energy = compute_fem_energy(N, f, use_quadrature)\n        energies.append(energy)\n    \n    is_monotonic = True\n    for i in range(1, len(energies)):\n        # Check if J(h_{i}) = J(h_{i-1}) within the given tolerance\n        if energies[i] - energies[i-1]  tol:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\n# 6-point symmetric quadrature rule for triangles, exact for degree 5.\n# Source: FEniCS project, derived from a rule attributed to Strang, Fix, and Zienkiewicz.\n# Points are in barycentric coordinates. Weights sum to 1.0.\nalpha_q = 0.108103018168070\nbeta_q = 0.445948490915965\ngamma_q = 0.816847572980459\ndelta_q = 0.091576213509771\nw1_q = 0.223381589678011\nw2_q = 0.109951743655322\n\nBARY_POINTS = np.array([\n    [beta_q, beta_q, alpha_q], [beta_q, alpha_q, beta_q], [alpha_q, beta_q, beta_q],\n    [delta_q, delta_q, gamma_q], [delta_q, gamma_q, delta_q], [gamma_q, delta_q, delta_q]\n])\nQUAD_WEIGHTS = np.array([w1_q, w1_q, w1_q, w2_q, w2_q, w2_q])\n\ndef compute_fem_energy(N, f, use_quadrature):\n    \"\"\"\n    Computes the discrete energy J(u_h) for a given mesh parameter N and forcing f.\n    \"\"\"\n    h = 1.0 / N\n    num_nodes_total = (N + 1)**2\n    num_nodes_interior = (N - 1)**2\n\n    # Map from global grid coordinates (ix, iy) to a single global index k\n    def global_idx(ix, iy):\n        return iy * (N + 1) + ix\n\n    # Map from global node index to interior node index\n    interior_nodes_map = {}\n    is_interior = np.zeros(num_nodes_total, dtype=bool)\n    interior_counter = 0\n    for iy in range(1, N):\n        for ix in range(1, N):\n            k = global_idx(ix, iy)\n            is_interior[k] = True\n            interior_nodes_map[k] = interior_counter\n            interior_counter += 1\n\n    K = np.zeros((num_nodes_interior, num_nodes_interior), dtype=np.float64)\n    b = np.zeros(num_nodes_interior, dtype=np.float64)\n\n    # Gradients of shape functions on the reference element ((0,0),(1,0),(0,1))\n    # \\phi_1 = 1-xi-eta, \\phi_2 = xi, \\phi_3 = eta\n    grad_phi_ref = np.array([[-1., -1.], [1., 0.], [0., 1.]], dtype=np.float64)\n\n    # Loop over all squares in the grid to define the triangles\n    for j_sq in range(N):\n        for i_sq in range(N):\n            # Global grid indices of the four corners of the square\n            n00_idx, n10_idx = (i_sq, j_sq), (i_sq + 1, j_sq)\n            n01_idx, n11_idx = (i_sq, j_sq + 1), (i_sq + 1, j_sq + 1)\n            \n            # Vertices of the square\n            v00, v10 = np.array([i_sq*h, j_sq*h]), np.array([(i_sq+1)*h, j_sq*h])\n            v01, v11 = np.array([i_sq*h, (j_sq+1)*h]), np.array([(i_sq+1)*h, (j_sq+1)*h])\n            \n            triangles = [\n                ((n00_idx, n10_idx, n11_idx), (v00, v10, v11)),\n                ((n00_idx, n01_idx, n11_idx), (v00, v01, v11)),\n            ]\n\n            for (node_indices, vertices) in triangles:\n                v1, v2, v3 = vertices\n                \n                # Affine map from reference element: x = B * \\hat{x} + v1\n                B = np.array([v2 - v1, v3 - v1]).T\n                B_inv_T = linalg.inv(B).T\n                area = 0.5 * np.abs(linalg.det(B))\n\n                grad_phi_phys = grad_phi_ref @ B_inv_T\n                Ke = (grad_phi_phys @ grad_phi_phys.T) * area\n\n                be = np.zeros(3, dtype=np.float64)\n                if not use_quadrature:\n                    be.fill(area / 3.0)\n                else:\n                    phys_points = BARY_POINTS @ np.array([v1, v2, v3])\n                    # Values of shape functions on reference element are the barycentric coordinates\n                    phi_vals_at_quad_points = BARY_POINTS\n                    f_vals = f(phys_points[:, 0], phys_points[:, 1])\n                    for i in range(3):\n                        integrand = f_vals * phi_vals_at_quad_points[:, i]\n                        be[i] = area * np.sum(QUAD_WEIGHTS * integrand)\n\n                global_node_ids = [global_idx(ix, iy) for (ix, iy) in node_indices]\n                \n                for i in range(3):\n                    gi = global_node_ids[i]\n                    if is_interior[gi]:\n                        mi = interior_nodes_map[gi]\n                        b[mi] += be[i]\n                        for j in range(3):\n                            gj = global_node_ids[j]\n                            if is_interior[gj]:\n                                mj = interior_nodes_map[gj]\n                                K[mi, mj] += Ke[i, j]\n\n    u = linalg.solve(K, b)\n    energy = -0.5 * np.dot(u, b)\n    return energy\n\nsolve()\n```", "id": "2579540"}]}