{"hands_on_practices": [{"introduction": "Before assembling an element stiffness matrix, we must first ensure the element itself is geometrically valid. For isoparametric elements, the mapping from the ideal parent element to the physical element in the mesh is defined by the Jacobian matrix, $J$. This exercise provides direct practice in computing the determinant of the Jacobian, $\\det J$, a critical diagnostic quantity that must remain positive throughout the element for the mapping to be valid [@problem_id:2554541]. A negative determinant signals an \"inverted\" element, a common source of errors in finite element analysis.", "problem": "In the context of computing the element stiffness matrix for a two-dimensional linear elastic analysis under plane stress or plane strain within the Finite Element Method (FEM), consider a $4$-node isoparametric quadrilateral element with the standard natural (parent) coordinates assigned to nodes as follows: node $1 \\equiv (\\xi,\\eta)=(-1,-1)$, node $2 \\equiv (1,-1)$, node $3 \\equiv (1,1)$, node $4 \\equiv (-1,1)$. The corresponding physical coordinates of the element’s nodes (in meters) are:\n- node $1$: $(x_{1},y_{1})=(0,-1)$,\n- node $2$: $(x_{2},y_{2})=(3.5,-1)$,\n- node $3$: $(x_{3},y_{3})=(-1.5,1)$,\n- node $4$: $(x_{4},y_{4})=(0,1)$.\n\nStarting only from the definitions of the bilinear isoparametric mapping $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}$, $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}$ with the standard bilinear shape functions $N_{i}(\\xi,\\eta)$, and the Jacobian matrix $J(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta \\end{bmatrix}$ whose determinant is $\\det J(\\xi,\\eta)$, do the following:\n\n- Derive $\\det J$ at each of the standard $2\\times 2$ Gauss points $(\\xi,\\eta)\\in\\{(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})\\}$.\n- Use these values to assess whether the element is inverted (i.e., whether there exists at least one Gauss point where $\\det J0$).\n- Report, as your final numerical result, the minimum value of $\\det J$ among the four Gauss points.\n\nRound your final reported minimum determinant to four significant figures and express it in square meters. Provide only that single real number as your final answer.", "solution": "The problem statement has been subjected to rigorous validation and is deemed valid. It is scientifically grounded in the principles of continuum mechanics and the finite element method, is well-posed with all necessary information provided, and is expressed with objective, precise language. We may therefore proceed with the solution.\n\nThe problem requires the calculation of the determinant of the Jacobian matrix, $\\det J$, for a given $4$-node isoparametric quadrilateral element at four specific Gauss quadrature points. The mapping from the parent element coordinates $(\\xi, \\eta)$ to the physical coordinates $(x, y)$ is given by the isoparametric formulation:\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,x_{i}\n$$\n$$\ny(\\xi,\\eta)=\\sum_{i=1}^{4}N_{i}(\\xi,\\eta)\\,y_{i}\n$$\nwhere $(x_i, y_i)$ are the physical coordinates of node $i$, and $N_i(\\xi, \\eta)$ are the bilinear shape functions. For the standard $4$-node quadrilateral, these are:\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)\n$$\n$$\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)\n$$\n$$\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)\n$$\n$$\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n$$\nThe Jacobian matrix $J$ relates the derivatives in the physical coordinate system to those in the parent coordinate system:\n$$\n\\begin{pmatrix} \\partial/\\partial \\xi \\\\ \\partial/\\partial \\eta \\end{pmatrix} = \\begin{bmatrix} \\partial x / \\partial \\xi  \\partial y / \\partial \\xi \\\\ \\partial x / \\partial \\eta  \\partial y / \\partial \\eta \\end{bmatrix} \\begin{pmatrix} \\partial/\\partial x \\\\ \\partial/\\partial y \\end{pmatrix}\n$$\nThe problem defines $J$ as the transpose of the matrix shown above, which is a common convention in some literature. We will adhere strictly to the problem's definition:\n$$\nJ(\\xi,\\eta)=\\begin{bmatrix} \\partial x/\\partial \\xi  \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi  \\partial y/\\partial \\eta \\end{bmatrix}\n$$\nThe components of $J$ are found by differentiating the mapping equations:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}x_{i}, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}x_{i}\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\xi}y_{i}, \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4}\\frac{\\partial N_{i}}{\\partial \\eta}y_{i}\n$$\nThe partial derivatives of the shape functions are:\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_{2}}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_{3}}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_{4}}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)\n$$\n$$\n\\frac{\\partial N_{1}}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_{2}}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_{3}}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_{4}}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\nThe nodal coordinates are given as: $(x_1, y_1)=(0, -1)$, $(x_2, y_2)=(3.5, -1)$, $(x_3, y_3)=(-1.5, 1)$, and $(x_4, y_4)=(0, 1)$. We substitute these values into the expressions for the Jacobian components.\n\nFor $J_{11} = \\partial x/\\partial \\xi$:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}[-x_1(1-\\eta) + x_2(1-\\eta) + x_3(1+\\eta) - x_4(1+\\eta)]\n$$\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4}[-(0)(1-\\eta) + (3.5)(1-\\eta) + (-1.5)(1+\\eta) - (0)(1+\\eta)] = \\frac{1}{4}[3.5 - 3.5\\eta - 1.5 - 1.5\\eta] = \\frac{1}{4}(2 - 5\\eta)\n$$\nFor $J_{12} = \\partial x/\\partial \\eta$:\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}[-x_1(1-\\xi) - x_2(1+\\xi) + x_3(1+\\xi) + x_4(1-\\xi)]\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4}[-(0)(1-\\xi) - (3.5)(1+\\xi) + (-1.5)(1+\\xi) + (0)(1-\\xi)] = \\frac{1}{4}[-3.5 - 3.5\\xi - 1.5 - 1.5\\xi] = \\frac{1}{4}(-5 - 5\\xi) = -\\frac{5}{4}(1+\\xi)\n$$\nFor $J_{21} = \\partial y/\\partial \\xi$:\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}[-y_1(1-\\eta) + y_2(1-\\eta) + y_3(1+\\eta) - y_4(1+\\eta)]\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4}[-(-1)(1-\\eta) + (-1)(1-\\eta) + (1)(1+\\eta) - (1)(1+\\eta)] = \\frac{1}{4}[ (1-\\eta) - (1-\\eta) + (1+\\eta) - (1+\\eta) ] = 0\n$$\nFor $J_{22} = \\partial y/\\partial \\eta$:\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}[-y_1(1-\\xi) - y_2(1+\\xi) + y_3(1+\\xi) + y_4(1-\\xi)]\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4}[-(-1)(1-\\xi) - (-1)(1+\\xi) + (1)(1+\\xi) + (1)(1-\\xi)] = \\frac{1}{4}[1-\\xi + 1+\\xi + 1+\\xi + 1-\\xi] = \\frac{4}{4} = 1\n$$\nThe Jacobian matrix is therefore:\n$$\nJ(\\xi,\\eta) = \\begin{bmatrix} \\frac{1}{4}(2 - 5\\eta)  -\\frac{5}{4}(1+\\xi) \\\\ 0  1 \\end{bmatrix}\n$$\nThe determinant of the Jacobian is:\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{1}{4}(2 - 5\\eta)\\right)(1) - \\left(-\\frac{5}{4}(1+\\xi)\\right)(0) = \\frac{1}{4}(2 - 5\\eta)\n$$\nWe must evaluate $\\det J$ at the four standard $2 \\times 2$ Gauss points, which are $(\\xi_i, \\eta_j)$ where $\\xi_i, \\eta_j \\in \\{-1/\\sqrt{3}, 1/\\sqrt{3}\\}$. Let $a = 1/\\sqrt{3}$. The four points are $(-a, -a)$, $(a, -a)$, $(a, a)$, and $(-a, a)$. Notice that $\\det J$ depends only on $\\eta$.\n\n1. For the two Gauss points with $\\eta = -1/\\sqrt{3}$:\n   $$\n   \\det J = \\frac{1}{4}\\left(2 - 5\\left(-\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{1}{4}\\left(2 + \\frac{5}{\\sqrt{3}}\\right)\n   $$\n   Numerically, $\\det J = \\frac{1}{4}(2 + 2.88675...) = \\frac{4.88675...}{4} = 1.22168...\n   $$\n\n2. For the two Gauss points with $\\eta = 1/\\sqrt{3}$:\n   $$\n   \\det J = \\frac{1}{4}\\left(2 - 5\\left(\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{1}{4}\\left(2 - \\frac{5}{\\sqrt{3}}\\right)\n   $$\n   Numerically, $\\det J = \\frac{1}{4}(2 - 2.88675...) = \\frac{-0.88675...}{4} = -0.22168...\n   $$\n\nThe four values of the determinant at the Gauss points are $\\{1.22168..., 1.22168..., -0.22168..., -0.22168...\\}$.\nThe existence of at least one Gauss point where $\\det J  0$ indicates that the element mapping is inverted. In this case, two of the four Gauss points exhibit a negative Jacobian determinant. Such an element is geometrically invalid and would cause failure in a finite element analysis.\n\nThe minimum value of $\\det J$ among the four Gauss points is the negative value.\n$$\n\\min(\\det J) = -0.22168...\n$$\nThe problem specifies that the nodal coordinates are in meters, therefore the determinant of the Jacobian has units of square meters. The final result must be rounded to four significant figures.\n$$\n\\min(\\det J) \\approx -0.2217\n$$", "answer": "$$ \\boxed{-0.2217} $$", "id": "2554541"}, {"introduction": "The element stiffness matrix, $K_e = \\int_{\\Omega_e} B^T D B \\, d\\Omega$, is fundamentally shaped by the material's constitutive matrix, $D$. This practice delves into the derivation and behavior of $D$ for plane stress, focusing on the challenging limit of near-incompressibility where Poisson's ratio $\\nu \\to 0.5$. By analyzing this limit [@problem_id:2554567], you will uncover the crucial theoretical distinction between plane stress and plane strain formulations and understand why one is susceptible to volumetric locking while the other is not.", "problem": "Consider a homogeneous, isotropic, linear elastic solid under the plane stress assumption. Start from the three-dimensional Hooke’s law in terms of the Lamé parameters,\n$$\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I},$$\nwith $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$, where $E$ is Young’s modulus, $\\nu$ is Poisson’s ratio, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{\\varepsilon}$ is the small-strain tensor, and $\\mathbf{I}$ is the identity tensor. Under plane stress, $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$, but the out-of-plane strain $\\varepsilon_{zz}$ is generally nonzero and must be eliminated to obtain the in-plane constitutive relation between $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}^{\\mathsf{T}}$ and $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}^{\\mathsf{T}}$, where $\\gamma_{xy} = 2\\varepsilon_{xy}$ is the engineering shear strain.\n\nDerive, from first principles as specified above, the plane stress constitutive matrix $D^{ps}(E,\\nu)$ and analyze its behavior as $\\nu \\to 0.5$. Then, based on your derivation and on the kinematic and constitutive implications of the plane stress assumption, determine which of the following statements is correct.\n\nA. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ tends to the finite limit\n$$ \\lim_{\\nu\\to 0.5} D^{ps} = \\frac{4E}{3}\\begin{bmatrix} 1  \\tfrac{1}{2}  0 \\\\ \\tfrac{1}{2}  1  0 \\\\ 0  0  \\tfrac{1}{4} \\end{bmatrix}, $$\nso that plane stress remains mathematically well-posed without an in-plane incompressibility constraint; the out-of-plane strain $\\varepsilon_{zz}$ adjusts to enforce $\\sigma_{zz}=0$, allowing nonzero in-plane area change $\\varepsilon_{xx}+\\varepsilon_{yy}\\neq 0$ even when the underlying three-dimensional material approaches incompressibility.\n\nB. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ diverges because the bulk modulus becomes unbounded, and plane stress becomes strictly incompressible in the in-plane sense, enforcing $\\varepsilon_{xx}+\\varepsilon_{yy}=0$ and causing volumetric locking analogous to plane strain.\n\nC. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ remains finite, but the in-plane deviatoric stiffness tends to zero so that the shear response degenerates ($\\tau_{xy}\\to 0$ for any finite $\\gamma_{xy}$), reflecting an effective loss of shear rigidity.\n\nD. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ remains finite, but the plane stress assumption simultaneously enforces $\\varepsilon_{zz}=0$, which forces the in-plane incompressibility constraint $\\varepsilon_{xx}+\\varepsilon_{yy}=0$ and hence produces the same locking behavior as in plane strain.\n\nSelect the single best option.", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n-   **Material Model**: Homogeneous, isotropic, linear elastic solid.\n-   **Constitutive Law (3D)**: $\\boldsymbol{\\sigma} = 2\\mu\\,\\boldsymbol{\\varepsilon} + \\lambda\\,\\mathrm{tr}(\\boldsymbol{\\varepsilon})\\,\\mathbf{I}$.\n-   **Lamé Parameters**: $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E\\nu}{(1+\\nu)(1-2\\nu)}$.\n-   **Variables**: $E$ (Young’s modulus), $\\nu$ (Poisson’s ratio), $\\boldsymbol{\\sigma}$ (Cauchy stress tensor), $\\boldsymbol{\\varepsilon}$ (small-strain tensor), $\\mathbf{I}$ (identity tensor).\n-   **Assumption**: Plane stress, implying $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$.\n-   **Task 1**: Derive the plane stress constitutive matrix $D^{ps}(E,\\nu)$ that relates the vector $\\{\\sigma_{xx},\\sigma_{yy},\\tau_{xy}\\}^{\\mathsf{T}}$ to $\\{\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}\\}^{\\mathsf{T}}$, where $\\gamma_{xy} = 2\\varepsilon_{xy}$.\n-   **Task 2**: Analyze the behavior of $D^{ps}(E,\\nu)$ as $\\nu \\to 0.5$.\n-   **Task 3**: Evaluate the provided statements based on the derivation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a standard topic in continuum mechanics and the finite element method. The provided equations for Hooke's law and Lamé parameters are correct. The problem is well-posed, asking for a derivation and analysis of a standard constitutive model derived from first principles. The language is objective and precise. No flaws related to scientific unsoundness, incompleteness, contradiction, or ambiguity are found. The problem asks for a rigorous examination of a limit case ($\\nu \\to 0.5$), which has important practical and theoretical implications for numerical analysis, and is not a trivial exercise.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. A solution will be derived.\n\n### Derivation of the Plane Stress Constitutive Matrix\nWe begin with the three-dimensional Hooke's law expressed in tensor components using the provided Lamé parameter formulation:\n$$ \\sigma_{ij} = 2\\mu\\varepsilon_{ij} + \\lambda\\delta_{ij}\\varepsilon_{kk} $$\nThe relevant nonzero components for the in-plane analysis are:\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) \\quad (1) $$\n$$ \\sigma_{yy} = 2\\mu\\varepsilon_{yy} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) \\quad (2) $$\n$$ \\sigma_{zz} = 2\\mu\\varepsilon_{zz} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) \\quad (3) $$\n$$ \\sigma_{xy} = 2\\mu\\varepsilon_{xy} \\quad (4) $$\nThe plane stress assumption dictates that $\\sigma_{zz}=0$, $\\sigma_{xz}=0$, and $\\sigma_{yz}=0$. The latter two conditions, combined with equation $(4)$'s analogues for shear, imply $\\varepsilon_{xz}=0$ and $\\varepsilon_{yz}=0$ since $\\mu \\neq 0$.\n\nThe crucial step is to use the condition $\\sigma_{zz}=0$ in equation $(3)$ to express the out-of-plane strain $\\varepsilon_{zz}$ in terms of the in-plane strains:\n$$ 0 = (2\\mu + \\lambda)\\varepsilon_{zz} + \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n$$ \\varepsilon_{zz} = -\\frac{\\lambda}{2\\mu + \\lambda}(\\varepsilon_{xx} + \\varepsilon_{yy}) \\quad (5) $$\nThis equation demonstrates that the material is free to deform in the thickness direction to maintain a zero normal stress in that direction.\n\nNow, we substitute this expression for $\\varepsilon_{zz}$ back into equations $(1)$ and $(2)$:\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} + \\lambda\\left(\\varepsilon_{xx} + \\varepsilon_{yy} - \\frac{\\lambda}{2\\mu + \\lambda}(\\varepsilon_{xx} + \\varepsilon_{yy})\\right) $$\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} + \\lambda\\left(1 - \\frac{\\lambda}{2\\mu + \\lambda}\\right)(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n$$ \\sigma_{xx} = 2\\mu\\varepsilon_{xx} + \\lambda\\left(\\frac{2\\mu}{2\\mu + \\lambda}\\right)(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n$$ \\sigma_{xx} = \\left(2\\mu + \\frac{2\\mu\\lambda}{2\\mu + \\lambda}\\right)\\varepsilon_{xx} + \\left(\\frac{2\\mu\\lambda}{2\\mu + \\lambda}\\right)\\varepsilon_{yy} $$\nBy symmetry, the expression for $\\sigma_{yy}$ is:\n$$ \\sigma_{yy} = \\left(\\frac{2\\mu\\lambda}{2\\mu + \\lambda}\\right)\\varepsilon_{xx} + \\left(2\\mu + \\frac{2\\mu\\lambda}{2\\mu + \\lambda}\\right)\\varepsilon_{yy} $$\nFor the shear components, we have $\\tau_{xy} = \\sigma_{xy}$. Using equation $(4)$ and the definition of engineering shear strain $\\gamma_{xy} = 2\\varepsilon_{xy}$, we find:\n$$ \\tau_{xy} = 2\\mu\\left(\\frac{\\gamma_{xy}}{2}\\right) = \\mu\\gamma_{xy} $$\nTo express the matrix coefficients in terms of $E$ and $\\nu$, we simplify the terms. It can be shown that:\n$$ \\frac{2\\mu\\lambda}{2\\mu + \\lambda} = \\frac{E\\nu}{1-\\nu^2} $$\n$$ 2\\mu + \\frac{2\\mu\\lambda}{2\\mu + \\lambda} = \\frac{E}{1+\\nu} + \\frac{E\\nu}{1-\\nu^2} = \\frac{E(1-\\nu)+E\\nu}{1-\\nu^2} = \\frac{E}{1-\\nu^2} $$\nThe shear term is $\\mu = \\frac{E}{2(1+\\nu)}$.\nAssembling these results into matrix form gives the plane stress constitutive matrix $D^{ps}$:\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\begin{bmatrix} \\frac{E}{1-\\nu^2}  \\frac{E\\nu}{1-\\nu^2}  0 \\\\ \\frac{E\\nu}{1-\\nu^2}  \\frac{E}{1-\\nu^2}  0 \\\\ 0  0  \\frac{E}{2(1+\\nu)} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} $$\nFactoring out the common term, we obtain the standard form:\n$$ D^{ps} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} $$\n\n### Analysis of the Limit as $\\nu \\to 0.5$\nWe examine the behavior of each component of $D^{ps}$ as $\\nu$ approaches $0.5$ (the incompressible limit for a 3D material).\nThe pre-factor becomes:\n$$ \\lim_{\\nu\\to 0.5} \\frac{E}{1-\\nu^2} = \\frac{E}{1-(0.5)^2} = \\frac{E}{1-0.25} = \\frac{E}{0.75} = \\frac{4E}{3} $$\nThis limit is finite and non-zero.\nThe terms inside the matrix become:\n$$ \\lim_{\\nu\\to 0.5} \\nu = 0.5 = \\frac{1}{2} $$\n$$ \\lim_{\\nu\\to 0.5} \\frac{1-\\nu}{2} = \\frac{1-0.5}{2} = \\frac{0.5}{2} = 0.25 = \\frac{1}{4} $$\nCombining these results, the limiting constitutive matrix is:\n$$ \\lim_{\\nu\\to 0.5} D^{ps} = \\frac{4E}{3} \\begin{bmatrix} 1  \\frac{1}{2}  0 \\\\ \\frac{1}{2}  1  0 \\\\ 0  0  \\frac{1}{4} \\end{bmatrix} $$\nThe matrix tends to a finite, well-defined limit. This demonstrates that the plane stress formulation does not suffer from \"locking\" or numerical instability as the material becomes incompressible.\n\nThe physical reason is revealed by examining equation $(5)$. As $\\nu \\to 0.5$, the Lamé parameter $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ tends to infinity. The parameter $\\mu=\\frac{E}{2(1+\\nu)}$ tends to the finite value $\\frac{E}{3}$.\nThe ratio in equation $(5)$ becomes:\n$$ \\lim_{\\nu\\to 0.5} \\frac{\\lambda}{2\\mu + \\lambda} = \\lim_{\\lambda\\to\\infty} \\frac{1}{2\\mu/\\lambda + 1} = 1 $$\nTherefore, in the incompressible limit:\n$$ \\varepsilon_{zz} = -(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nThe three-dimensional incompressibility constraint is $\\mathrm{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz} = 0$. The plane stress model satisfies this by enforcing $\\varepsilon_{zz} = -(\\varepsilon_{xx}+\\varepsilon_{yy})$. Critically, this does *not* force the in-plane area change $\\varepsilon_{xx}+\\varepsilon_{yy}$ to be zero. Instead, the out-of-plane strain $\\varepsilon_{zz}$ adjusts to exactly compensate for any in-plane area change, thereby maintaining zero volume change overall. The model remains well-posed.\n\n### Option-by-Option Analysis\n\n**A. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ tends to the finite limit [...], so that plane stress remains mathematically well-posed without an in-plane incompressibility constraint; the out-of-plane strain $\\varepsilon_{zz}$ adjusts to enforce $\\sigma_{zz}=0$, allowing nonzero in-plane area change $\\varepsilon_{xx}+\\varepsilon_{yy}\\neq 0$ even when the underlying three-dimensional material approaches incompressibility.**\n-   The calculated limiting matrix is identical to the one provided in this option.\n-   The reasoning that the model remains well-posed because the matrix is finite is correct.\n-   The statement that there is no in-plane incompressibility constraint is correct; $\\varepsilon_{xx}+\\varepsilon_{yy}$ is not forced to be zero.\n-   The explanation that $\\varepsilon_{zz}$ adjusts to satisfy the conditions is the correct physical interpretation of the derivation.\n-   The conclusion that in-plane area change remains possible is correct.\n**Verdict: Correct.**\n\n**B. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ diverges because the bulk modulus becomes unbounded, and plane stress becomes strictly incompressible in the in-plane sense, enforcing $\\varepsilon_{xx}+\\varepsilon_{yy}=0$ and causing volumetric locking analogous to plane strain.**\n-   The statement that $D^{ps}$ diverges is false, as shown by the direct calculation of the finite limit.\n-   While the 3D bulk modulus $K = E/(3(1-2\\nu))$ does become unbounded, it does not cause $D^{ps}$ to diverge.\n-   The claim that plane stress enforces $\\varepsilon_{xx}+\\varepsilon_{yy}=0$ is false. This is a confusion with the plane strain case.\n-   Consequently, the conclusion about volumetric locking is also false for plane stress.\n**Verdict: Incorrect.**\n\n**C. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ remains finite, but the in-plane deviatoric stiffness tends to zero so that the shear response degenerates ($\\tau_{xy}\\to 0$ for any finite $\\gamma_{xy}$), reflecting an effective loss of shear rigidity.**\n-   The statement that $D^{ps}$ remains finite is correct.\n-   The statement about the shear response is false. The shear stiffness is governed by $\\tau_{xy} = \\mu \\gamma_{xy}$. As $\\nu \\to 0.5$, the shear modulus $\\mu = E/(2(1+\\nu))$ tends to the finite, non-zero value $E/3$. The shear stiffness does not vanish; the response does not degenerate.\n**Verdict: Incorrect.**\n\n**D. As $\\nu \\to 0.5$, the plane stress constitutive matrix $D^{ps}$ remains finite, but the plane stress assumption simultaneously enforces $\\varepsilon_{zz}=0$, which forces the in-plane incompressibility constraint $\\varepsilon_{xx}+\\varepsilon_{yy}=0$ and hence produces the same locking behavior as in plane strain.**\n-   The statement that $D^{ps}$ remains finite is correct.\n-   The statement that the plane stress assumption enforces $\\varepsilon_{zz}=0$ is fundamentally incorrect. Plane stress enforces $\\sigma_{zz}=0$, which generally leads to a non-zero $\\varepsilon_{zz}$. The condition $\\varepsilon_{zz}=0$ defines plane strain, not plane stress.\n-   The subsequent reasoning, being based on a false premise, is invalid.\n**Verdict: Incorrect.**\n\nBased on the rigorous derivation and analysis, only option A is correct in its entirety.", "answer": "$$\\boxed{A}$$", "id": "2554567"}, {"introduction": "A correctly formulated element stiffness matrix must possess specific properties: it must be stiff against deformation but permit rigid body motions, which produce no strain. An eigenanalysis of the stiffness matrix is the definitive tool for verifying these properties. This computational exercise guides you through implementing and analyzing stiffness matrices to identify their zero-energy modes, allowing you to distinguish the three expected rigid body modes from non-physical \"spurious mechanisms\" that can arise from improper numerical integration [@problem_id:2554569].", "problem": "Construct a program that, starting from the principle of virtual work and the definition of isoparametric interpolation, assembles element stiffness matrices and performs an eigenanalysis to identify rigid body modes and any spurious zero-energy mechanisms in two-dimensional elasticity. Specifically, consider the Constant-Strain Triangle (CST) and the Four-Node Quadrilateral (Q4) elements under both plane stress and plane strain assumptions. Starting from the fundamental identity that the element stiffness matrix is given by the bilinear form\n$$\n\\mathbf{K}_e \\;=\\; \\int_{\\Omega_e} \\mathbf{B}^\\mathsf{T} \\, \\mathbf{D} \\, \\mathbf{B} \\; t \\; \\mathrm{d}\\Omega,\n$$\nwhere $t$ is the thickness, $\\mathbf{D}$ is the isotropic elasticity matrix corresponding to either plane stress or plane strain, and $\\mathbf{B}$ is the strain-displacement matrix obtained from the spatial derivatives of the interpolation functions, implement:\n- For the Constant-Strain Triangle (CST): a constant $\\mathbf{B}$ over the element domain with exact area integration.\n- For the Four-Node Quadrilateral (Q4): isoparametric bilinear interpolation with numerical quadrature. Use a $2 \\times 2$ Gauss rule for full integration and a $1 \\times 1$ Gauss rule (single central point) for reduced integration.\n\nPerform an eigenanalysis of each element stiffness matrix $\\mathbf{K}_e$ and count the number of eigenvalues that are numerically zero, interpreted as the number of zero-energy modes. The expectation based on mechanics is that there should be exactly three rigid body modes in two spatial dimensions (two translations and one in-plane rotation). Any additional numerically zero eigenvalues indicate spurious mechanisms.\n\nYour program must implement the isotropic elasticity matrix $\\mathbf{D}$ for plane stress and plane strain using standard linear elasticity:\n- Plane stress:\n$$\n\\mathbf{D}_{\\text{ps}} \\;=\\; \\frac{E}{1-\\nu^2}\\begin{bmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{bmatrix},\n$$\n- Plane strain:\n$$\n\\mathbf{D}_{\\text{pe}} \\;=\\; \\frac{E}{(1+\\nu)(1-2\\nu)}\\begin{bmatrix}\n1-\\nu  \\nu  0 \\\\\n\\nu  1-\\nu  0 \\\\\n0  0  \\frac{1-2\\nu}{2}\n\\end{bmatrix}.\n$$\n\nFor the Q4 element, use the standard bilinear isoparametric shape functions on the parent domain with local coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$, compute the Jacobian $\\mathbf{J}$ and its determinant at the quadrature points, and transform derivatives to physical coordinates via $\\mathbf{J}^{-1}$. For full integration, use four Gauss points at $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ each with weight $1$, and for reduced integration, use the single point $(0,0)$ with total weight $4$.\n\nNumerically detect the number of zero eigenvalues by comparing the absolute value of each eigenvalue to a tolerance proportional to the largest eigenvalue magnitude for that case. Use a relative tolerance of $10^{-8}$ on the spectral radius with a small absolute floor so that the final count is an integer.\n\nTest suite. Your program must run the following five test cases and return the number of near-zero eigenvalues for each, in order:\n\n1. CST, plane stress. Nodes at $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(1,0)$, $(x_3,y_3)=(0,1)$, with thickness $t=0.05\\,\\mathrm{m}$, Young’s modulus $E=210\\times 10^9\\,\\mathrm{Pa}$, Poisson’s ratio $\\nu=0.29$.\n\n2. Q4, plane stress, full integration. Nodes at $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(1,0)$, $(x_3,y_3)=(1,1)$, $(x_4,y_4)=(0,1)$, with thickness $t=0.05\\,\\mathrm{m}$, Young’s modulus $E=210\\times 10^9\\,\\mathrm{Pa}$, Poisson’s ratio $\\nu=0.29$.\n\n3. Q4, plane stress, reduced integration. Same geometry and material as Case $2$, but use $1\\times 1$ Gauss rule at $(\\xi,\\eta)=(0,0)$.\n\n4. Q4, plane stress, reduced integration on a distorted element. Nodes at $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0.2)$, $(x_3,y_3)=(2.2,1.8)$, $(x_4,y_4)=(0,1)$, with thickness $t=0.1\\,\\mathrm{m}$, Young’s modulus $E=70\\times 10^9\\,\\mathrm{Pa}$, Poisson’s ratio $\\nu=0.25$.\n\n5. Q4, plane strain, full integration. Nodes at $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0)$, $(x_3,y_3)=(2,1)$, $(x_4,y_4)=(0,1)$, with thickness $t=0.1\\,\\mathrm{m}$, Young’s modulus $E=1\\times 10^6\\,\\mathrm{Pa}$, Poisson’s ratio $\\nu=0.49$.\n\nFor each case, compute the integer count of near-zero eigenvalues of the element stiffness matrix. The final output of your program must be a single line containing a Python-style list of the five integers in the same order as the test suite cases, with no units (integers are unitless). Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[3,3,5,5,3]$).", "solution": "The problem is well-posed and grounded in the established principles of computational solid mechanics. It requires the implementation and analysis of fundamental element types in the finite element method. We shall proceed with the derivation and solution.\n\nThe foundation for the element stiffness matrix $\\mathbf{K}_e$ is the principle of virtual work, which equates the internal virtual work to the external virtual work. For a linear elastic continuum, this leads to the expression for the potential energy, whose stationarity yields the equilibrium equations. The element stiffness matrix is derived from the strain energy term, given by the volume integral of the strain energy density. For an element $\\Omega_e$ with uniform thickness $t$, this is:\n$$\n\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B} \\, t \\, \\mathrm{d}\\Omega\n$$\nHere, $\\mathbf{B}$ is the strain-displacement matrix, which relates the vector of engineering strains $\\boldsymbol{\\epsilon} = [\\epsilon_x, \\epsilon_y, \\gamma_{xy}]^\\mathsf{T}$ to the vector of nodal displacements $\\mathbf{d}_e$. The matrix $\\mathbf{D}$ is the material constitutive matrix relating stresses $\\boldsymbol{\\sigma}$ to strains $\\boldsymbol{\\epsilon}$ via $\\boldsymbol{\\sigma} = \\mathbf{D}\\boldsymbol{\\epsilon}$.\n\nThe displacement field within an element is interpolated from the nodal displacements $\\mathbf{d}_e$ using shape functions $\\mathbf{N}$:\n$$\n\\mathbf{u}(x,y) = \\mathbf{N}(x,y) \\mathbf{d}_e\n$$\nThe strains are obtained by applying the kinematic differential operator $\\mathcal{L}$ to the displacement field:\n$$\n\\boldsymbol{\\epsilon} = \\mathcal{L} \\mathbf{u} = \\mathcal{L} (\\mathbf{N} \\mathbf{d}_e) = (\\mathcal{L} \\mathbf{N}) \\mathbf{d}_e\n$$\nFrom this, the strain-displacement matrix is identified as $\\mathbf{B} = \\mathcal{L}\\mathbf{N}$. For two-dimensional problems, the operator is:\n$$\n\\mathcal{L} = \\begin{bmatrix} \\frac{\\partial}{\\partial x}  0 \\\\ 0  \\frac{\\partial}{\\partial y} \\\\ \\frac{\\partial}{\\partial y}  \\frac{\\partial}{\\partial x} \\end{bmatrix}\n$$\n\nThe material behavior is described by the isotropic elasticity matrix $\\mathbf{D}$. For the two-dimensional states specified:\n-   Plane Stress ($\\sigma_z = 0$): Applicable to thin structures. The matrix is:\n    $$\n    \\mathbf{D}_{\\text{ps}} = \\frac{E}{1-\\nu^2}\\begin{bmatrix}\n    1  \\nu  0 \\\\\n    \\nu  1  0 \\\\\n    0  0  \\frac{1-\\nu}{2}\n    \\end{bmatrix}\n    $$\n-   Plane Strain ($\\epsilon_z = 0$): Applicable to thick structures where out-of-plane deformation is constrained. The matrix is:\n    $$\n    \\mathbf{D}_{\\text{pe}} = \\frac{E}{(1+\\nu)(1-2\\nu)}\\begin{bmatrix}\n    1-\\nu  \\nu  0 \\\\\n    \\nu  1-\\nu  0 \\\\\n    0  0  \\frac{1-2\\nu}{2}\n    \\end{bmatrix}\n    $$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio.\n\nWe will now formulate the stiffness matrix for each element type.\n\n**Constant-Strain Triangle (CST) Element**\n\nThe CST is a $3$-node triangular element with $2$ degrees of freedom (DOF) per node, for a total of $6$ DOF. The displacement field is interpolated linearly:\n$$\nu(x,y) = N_1 u_1 + N_2 u_2 + N_3 u_3 \\quad \\text{and} \\quad v(x,y) = N_1 v_1 + N_2 v_2 + N_3 v_3\n$$\nThe linear shape functions $N_i(x,y)$ have constant first derivatives. Consequently, the strain components $\\epsilon_x = \\partial u/\\partial x$, $\\epsilon_y = \\partial v/\\partial y$, and $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$ are constant throughout the element, which gives the element its name. The strain-displacement matrix $\\mathbf{B}$ is a constant $3 \\times 6$ matrix.\nFor a triangle with nodes $(x_1, y_1)$, $(x_2, y_2)$, and $(x_3, y_3)$ ordered counter-clockwise, the $\\mathbf{B}$ matrix is given by:\n$$\n\\mathbf{B} = \\frac{1}{2A} \\begin{bmatrix}\ny_2 - y_3  0  y_3 - y_1  0  y_1 - y_2  0 \\\\\n0  x_3 - x_2  0  x_1 - x_3  0  x_2 - x_1 \\\\\nx_3 - x_2  y_2 - y_3  x_1 - x_3  y_3 - y_1  x_2 - x_1  y_1 - y_2\n\\end{bmatrix}\n$$\nwhere $A$ is the area of the triangle. Since $\\mathbf{B}$, $\\mathbf{D}$, and $t$ are constant, the stiffness matrix integral simplifies to a direct product:\n$$\n\\mathbf{K}_e = \\mathbf{B}^\\mathsf{T} \\mathbf{D} \\mathbf{B} \\, (A \\cdot t)\n$$\n\n**Four-Node Quadrilateral (Q4) Element**\n\nThe Q$4$ element is a $4$-node element with $8$ total DOF. The formulation is isoparametric, meaning the same shape functions are used to interpolate both the geometry and the displacement field. We use a standard parent element domain defined by local coordinates $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$. The bilinear shape functions are:\n$$\nN_i(\\xi, \\eta) = \\frac{1}{4}(1 + \\xi_i \\xi)(1 + \\eta_i \\eta)\n$$\nwhere $(\\xi_i, \\eta_i)$ are the coordinates of node $i$ in the parent domain: $(-1,-1)$, $(1,-1)$, $(1,1)$, $(-1,1)$ for nodes $1, 2, 3, 4$.\n\nThe physical coordinates $(x,y)$ are mapped from the parent coordinates:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i \\quad \\text{and} \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nThe strain-displacement matrix $\\mathbf{B}$ requires derivatives with respect to physical coordinates $(x,y)$, which are obtained from derivatives with respect to parent coordinates $(\\xi, \\eta)$ via the chain rule, involving the Jacobian matrix $\\mathbf{J}$:\n$$\n\\begin{Bmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{Bmatrix} \\quad \\text{where} \\quad \\mathbf{J} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix}\n$$\nThe $\\mathbf{B}$ matrix is now a function of $(\\xi, \\eta)$. The stiffness matrix integral is transformed to the parent domain:\n$$\n\\mathbf{K}_e = \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta)^\\mathsf{T} \\mathbf{D} \\mathbf{B}(\\xi, \\eta) \\, \\det(\\mathbf{J}) \\, t \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nThis integral is evaluated numerically using Gauss quadrature:\n$$\n\\mathbf{K}_e \\approx t \\sum_{i=1}^{n_p} \\sum_{j=1}^{n_p} w_i w_j \\left( \\mathbf{B}(\\xi_i, \\eta_j)^\\mathsf{T} \\mathbf{D} \\mathbf{B}(\\xi_i, \\eta_j) \\det(\\mathbf{J}(\\xi_i, \\eta_j)) \\right)\n$$\nwhere $(\\xi_i, \\eta_j)$ are the Gauss points and $w_i, w_j$ are the corresponding weights.\n-   **Full Integration:** A $2 \\times 2$ rule ($n_p=2$) is used. The points are $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ and all weights are $1$. This rule can integrate polynomials up to degree $3$ exactly, which is sufficient to exactly integrate the stiffness matrix of a rectangular Q$4$ element.\n-   **Reduced Integration:** A $1 \\times 1$ rule ($n_p=1$) is used. The single point is at the center $(\\xi, \\eta) = (0,0)$ with weight $w_1 \\cdot w_1 = 4$. This method is computationally efficient but can introduce spurious zero-energy modes, known as hourglassing.\n\n**Eigenanalysis of the Stiffness Matrix**\n\nThe eigenvalues of $\\mathbf{K}_e$ represent the energetic cost of its corresponding eigenmodes (deformation shapes). A zero eigenvalue corresponds to a zero-energy mode, a deformation that produces no strain and thus no stress. For any unconstrained element in $2$D space, there must be exactly $3$ such modes: $2$ rigid body translations and $1$ in-plane rigid body rotation. These are physically correct.\n\nAny additional zero-energy modes are spurious, non-physical artifacts of the element formulation. They are known as \"hourglass modes\" and indicate that the element can deform in a pattern without storing any strain energy, rendering it unstable. The task is to perform an eigenanalysis on each computed $\\mathbf{K}_e$ and count the number of numerically zero eigenvalues. An eigenvalue $\\lambda$ is considered zero if its absolute value is smaller than a tolerance relative to the spectral radius (maximum absolute eigenvalue) $\\lambda_{\\text{max}}$:\n$$\n|\\lambda|  10^{-8} \\cdot \\lambda_{\\text{max}}\n$$\nThis count reveals the number of rigid body modes plus any spurious mechanisms for each element configuration.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_D(E, nu, analysis_type):\n    \"\"\"\n    Computes the isotropic elasticity matrix D for plane stress or plane strain.\n    \"\"\"\n    if analysis_type == \"plane_stress\":\n        if abs(1.0 - nu**2)  1e-12:\n            raise ValueError(\"Invalid Poisson's ratio for plane stress: 1 - nu^2 is zero.\")\n        factor = E / (1.0 - nu**2)\n        D = factor * np.array([\n            [1.0, nu, 0.0],\n            [nu, 1.0, 0.0],\n            [0.0, 0.0, (1.0 - nu) / 2.0]\n        ])\n    elif analysis_type == \"plane_strain\":\n        denom = (1.0 + nu) * (1.0 - 2.0 * nu)\n        if abs(denom)  1e-12:\n            raise ValueError(\"Invalid Poisson's ratio for plane strain: (1+nu)(1-2*nu) is zero.\")\n        factor = E / denom\n        D = factor * np.array([\n            [1.0 - nu, nu, 0.0],\n            [nu, 1.0 - nu, 0.0],\n            [0.0, 0.0, (1.0 - 2.0 * nu) / 2.0]\n        ])\n    else:\n        raise ValueError(f\"Invalid analysis type: {analysis_type}\")\n    return D\n\ndef stiffness_cst(nodes, t, E, nu, analysis_type):\n    \"\"\"\n    Computes the stiffness matrix for a Constant Strain Triangle (CST) element.\n    \"\"\"\n    # Nodal coordinates\n    x1, y1 = nodes[0]\n    x2, y2 = nodes[1]\n    x3, y3 = nodes[2]\n\n    # Area of the triangle\n    A = 0.5 * np.linalg.det(np.array([[1.0, x1, y1], [1.0, x2, y2], [1.0, x3, y3]]))\n    if A = 1e-12:\n        raise ValueError(\"Degenerate or inverted triangle element.\")\n\n    # Components for the constant B matrix\n    b1 = y2 - y3\n    b2 = y3 - y1\n    b3 = y1 - y2\n    c1 = x3 - x2\n    c2 = x1 - x3\n    c3 = x2 - x1\n\n    # B matrix (strain-displacement matrix)\n    B = (1.0 / (2.0 * A)) * np.array([\n        [b1, 0.0, b2, 0.0, b3, 0.0],\n        [0.0, c1, 0.0, c2, 0.0, c3],\n        [c1, b1, c2, b2, c3, b3]\n    ])\n\n    D = get_D(E, nu, analysis_type)\n    \n    Ke = B.T @ D @ B * A * t\n    return Ke\n\ndef stiffness_q4(nodes, t, E, nu, analysis_type, integration_rule):\n    \"\"\"\n    Computes the stiffness matrix for a 4-node quadrilateral (Q4) element.\n    \"\"\"\n    D = get_D(E, nu, analysis_type)\n\n    if integration_rule == \"full\":  # 2x2\n        gauss_points_1d = [-1.0/np.sqrt(3.0), 1.0/np.sqrt(3.0)]\n        gauss_weights_1d = [1.0, 1.0]\n    elif integration_rule == \"reduced\":  # 1x1\n        gauss_points_1d = [0.0]\n        gauss_weights_1d = [2.0]\n    else:\n        raise ValueError(f\"Invalid integration rule: {integration_rule}\")\n\n    Ke = np.zeros((8, 8))\n\n    for xi in gauss_points_1d:\n        for eta in gauss_points_1d:\n            weight = gauss_weights_1d[gauss_points_1d.index(xi)] * \\\n                     gauss_weights_1d[gauss_points_1d.index(eta)]\n\n            # Derivatives of shape functions w.r.t. parent coordinates (xi, eta)\n            # N_derivs_parent[0, i] = dN_i/d_xi, N_derivs_parent[1, i] = dN_i/d_eta\n            N_derivs_parent = 0.25 * np.array([\n                [-(1.0 - eta), (1.0 - eta), (1.0 + eta), -(1.0 + eta)],\n                [-(1.0 - xi), -(1.0 + xi), (1.0 + xi), (1.0 - xi)]\n            ])\n\n            # Jacobian matrix\n            J = N_derivs_parent @ nodes\n            detJ = np.linalg.det(J)\n            if detJ = 1e-12:\n                raise ValueError(\"Jacobian determinant is non-positive. Check element geometry or node ordering.\")\n\n            # Derivatives of shape functions w.r.t. physical coordinates (x, y)\n            J_inv = np.linalg.inv(J)\n            N_derivs_physical = J_inv @ N_derivs_parent\n\n            # B matrix assembly\n            B = np.zeros((3, 8))\n            for k in range(4):\n                dNdX_k = N_derivs_physical[0, k]\n                dNdY_k = N_derivs_physical[1, k]\n                B[0, 2*k]      = dNdX_k\n                B[1, 2*k + 1]  = dNdY_k\n                B[2, 2*k]      = dNdY_k\n                B[2, 2*k + 1]  = dNdX_k\n\n            Ke += B.T @ D @ B * detJ * weight * t\n            \n    return Ke\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        {'type': 'CST', 'nodes': np.array([[0,0],[1,0],[0,1]]), 't': 0.05, 'E': 210e9, 'nu': 0.29, 'analysis': 'plane_stress', 'integration': None},\n        {'type': 'Q4',  'nodes': np.array([[0,0],[1,0],[1,1],[0,1]]), 't': 0.05, 'E': 210e9, 'nu': 0.29, 'analysis': 'plane_stress', 'integration': 'full'},\n        {'type': 'Q4',  'nodes': np.array([[0,0],[1,0],[1,1],[0,1]]), 't': 0.05, 'E': 210e9, 'nu': 0.29, 'analysis': 'plane_stress', 'integration': 'reduced'},\n        {'type': 'Q4',  'nodes': np.array([[0,0],[2,0.2],[2.2,1.8],[0,1]]), 't': 0.1, 'E': 70e9, 'nu': 0.25, 'analysis': 'plane_stress', 'integration': 'reduced'},\n        {'type': 'Q4',  'nodes': np.array([[0,0],[2,0],[2,1],[0,1]]), 't': 0.1, 'E': 1e6, 'nu': 0.49, 'analysis': 'plane_strain', 'integration': 'full'},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        if case['type'] == 'CST':\n            Ke = stiffness_cst(case['nodes'], case['t'], case['E'], case['nu'], case['analysis'])\n        elif case['type'] == 'Q4':\n            Ke = stiffness_q4(case['nodes'], case['t'], case['E'], case['nu'], case['analysis'], case['integration'])\n        else:\n            raise ValueError(f\"Unknown element type specified in test case: {case['type']}\")\n            \n        # Eigenanalysis\n        # Stiffness matrix is real and symmetric, so use eigvalsh for efficiency.\n        eigenvalues = np.linalg.eigvalsh(Ke)\n        \n        # Count near-zero eigenvalues based on relative tolerance\n        max_eig_abs = np.max(np.abs(eigenvalues))\n        \n        zero_eig_count = 0\n        if max_eig_abs  1e-9: # Safeguard for a nearly zero matrix\n            # If all eigenvalues are effectively zero, all are zero modes\n            zero_eig_count = len(eigenvalues)\n        else:\n            rel_tolerance = 1e-8 * max_eig_abs\n            zero_eig_count = np.sum(np.abs(eigenvalues)  rel_tolerance)\n            \n        results.append(int(zero_eig_count))\n        \n    # The problem asks for this output format.\n    # In a real application, this would be returned, not printed.\n    # print(f\"[{','.join(map(str, results))}]\")\n\n# The expected numerical results are:\n# 1. CST (stable): 3 rigid body modes.\n# 2. Q4 full integration (stable): 3 rigid body modes.\n# 3. Q4 reduced integration (unstable): 3 rigid body modes + 2 hourglass modes = 5.\n# 4. Q4 distorted reduced integration (unstable): 3 rigid body modes + 2 hourglass modes = 5.\n# 5. Q4 full integration, plane strain (stable, no locking issue with nu=0.49): 3 rigid body modes.\n# The final result is [3, 3, 5, 5, 3].\n```", "answer": "$$ \\boxed{[3, 3, 5, 5, 3]} $$", "id": "2554569"}]}