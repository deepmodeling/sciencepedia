{"hands_on_practices": [{"introduction": "Accurately imposing boundary conditions is a cornerstone of the finite element method. This exercise explores the \"lifting\" strategy, an elegant technique for handling non-homogeneous essential (Dirichlet) boundary conditions by decomposing the solution. By working through a concrete 1D example, you will gain hands-on experience in deriving the modification to the system's load vector, a fundamental skill for practical FEM implementation [@problem_id:2543141].", "problem": "Consider the scalar diffusion model problem governed by the Partial Differential Equation (PDE)\n$$-\\,\\frac{d}{dx}\\!\\left(k\\,\\frac{du}{dx}\\right)=f \\quad \\text{in } \\Omega=(0,1),$$\nwith mixed boundary conditions\n$$u=g_{D}\\ \\text{on}\\ \\Gamma_{D}=\\{0\\}, \\qquad k\\,\\frac{du}{dx}=g_{N}\\ \\text{on}\\ \\Gamma_{N}=\\{1\\}.$$\nUse the Galerkin Finite Element Method (FEM) with trial and test space built from continuous, piecewise-linear functions on a single element mesh with nodes at $x=0$ and $x=1$. Let the discrete essential boundary condition be enforced via a lifting strategy: select a discrete lifting $u_{L}$ such that $u_{L}(0)=g_{D}$ and $u_{L}(1)=0$, and write $u_{h}=w_{h}+u_{L}$ with $w_{h}$ vanishing on $\\Gamma_{D}$. Starting from the variational statement obtained from integration by parts and the fundamental definition of the bilinear and linear forms, derive how the presence of $u_{L}$ modifies the right-hand side of the reduced discrete system for $w_{h}$.\n\nThen apply your derivation to the concrete data\n$$k=3,\\qquad f(x)=4,\\qquad g_{N}=5,\\qquad g_{D}=2,$$\non the single-element mesh with the standard nodal basis $\\{N_{1},N_{2}\\}$, where $N_{1}(x)=1-x$ and $N_{2}(x)=x$. Choose the lifting $u_{L}(x)=g_{D}\\,N_{1}(x)$. Using the single free basis function $N_{2}$ as test function, compute the resulting scalar modified right-hand side entry for the reduced one-degree-of-freedom system associated with $w_{h}$.\n\nExpress your final answer as a single real number. No rounding is required.", "solution": "The problem requires the derivation of the modified right-hand side of a Finite Element Method (FEM) system when using a lifting strategy for a non-homogeneous Dirichlet boundary condition, and then to compute this modified term for a specific case.\n\nThe governing Partial Differential Equation (PDE), or strong form of the problem, is:\n$$-\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) = f \\quad \\text{for } x \\in \\Omega = (0,1)$$\nwith the mixed boundary conditions:\n$$u(0) = g_{D} \\quad (\\text{Essential/Dirichlet})$$\n$$k\\,\\frac{du}{dx}(1) = g_{N} \\quad (\\text{Natural/Neumann})$$\nTo derive the variational (or weak) formulation, we multiply the PDE by a test function $v$ from a suitable space of test functions $V$ and integrate over the domain $\\Omega$:\n$$-\\int_{0}^{1} v\\,\\frac{d}{dx}\\left(k\\,\\frac{du}{dx}\\right) dx = \\int_{0}^{1} v f dx$$\nApplying integration by parts to the left-hand side gives:\n$$\\int_{0}^{1} \\frac{dv}{dx} k \\frac{du}{dx} dx - \\left[v k \\frac{du}{dx}\\right]_{0}^{1} = \\int_{0}^{1} v f dx$$\nThe space of test functions $V$ is chosen such that its members vanish at locations where essential boundary conditions are specified. In this case, $v(0)=0$. The boundary term evaluates to:\n$$\\left[v k \\frac{du}{dx}\\right]_{0}^{1} = v(1) k \\frac{du}{dx}(1) - v(0) k \\frac{du}{dx}(0) = v(1) g_{N} - 0 = v(1) g_{N}$$\nSubstituting this back, the variational problem is: Find $u$ such that $u(0)=g_D$ and for all test functions $v$ with $v(0)=0$, the following holds:\n$$\\int_{0}^{1} k \\frac{du}{dx} \\frac{dv}{dx} dx = \\int_{0}^{1} v f dx + v(1) g_{N}$$\nThis is often written in abstract form as $a(u, v) = l(v)$, where $a(u,v)$ is the bilinear form and $l(v)$ is the linear functional.\n\nIn the Galerkin FEM, we seek an approximate solution $u_h$ in a finite-dimensional trial space $S_h$, and we test against functions $v_h$ from a finite-dimensional test space $V_h$. For this problem, both spaces are built from continuous, piecewise-linear functions. The essential boundary condition $u(0)=g_D$ is enforced using a lifting strategy. We decompose the discrete solution $u_h$ as:\n$$u_h = w_h + u_L$$\nHere, $u_L$ is a known lifting function that satisfies the non-homogeneous essential boundary condition, $u_L(0) = g_D$. The function $w_h$ is the unknown part of the solution and belongs to the discrete test space $V_h$, which consists of functions vanishing on the Dirichlet boundary $\\Gamma_D$. Thus, $w_h(0)=0$.\n\nSubstituting the decomposition $u_h = w_h + u_L$ into the variational form, with a discrete test function $v_h \\in V_h$:\n$$\\int_{0}^{1} k \\frac{d(w_h + u_L)}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\nUsing the linearity of the derivative and the integral, we separate the terms on the left-hand side:\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx + \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N}$$\nThe problem for the unknown function $w_h \\in V_h$ is to find it such that for all $v_h \\in V_h$:\n$$\\int_{0}^{1} k \\frac{dw_h}{dx} \\frac{dv_h}{dx} dx = \\int_{0}^{1} v_h f dx + v_h(1) g_{N} - \\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$$\nThis equation is of the form $a(w_h, v_h) = l_{mod}(v_h)$. The bilinear form $a(w_h, v_h)$ constitutes the left-hand side (stiffness matrix), while the modified linear functional $l_{mod}(v_h)$ constitutes the right-hand side (load vector). The presence of the lifting function $u_L$ modifies the original right-hand side by introducing the term $-\\int_{0}^{1} k \\frac{du_L}{dx} \\frac{dv_h}{dx} dx$. This completes the derivation part of the problem.\n\nNow, we apply this to the given data:\n- Constants: $k=3$, $f(x)=4$, $g_{N}=5$, $g_{D}=2$.\n- Mesh: A single element on $\\Omega=(0,1)$ with nodes at $x=0$ and $x=1$.\n- Nodal basis functions: $N_1(x) = 1-x$ and $N_2(x) = x$.\n- Their derivatives are: $\\frac{dN_1}{dx} = -1$ and $\\frac{dN_2}{dx} = 1$.\n- Lifting function: $u_L(x) = g_D N_1(x) = 2(1-x)$.\n- The derivative of the lifting function is: $\\frac{du_L}{dx} = 2 \\frac{dN_1}{dx} = 2(-1) = -2$.\n\nThe unknown function $w_h$ must vanish at $x=0$, so it must be a multiple of $N_2(x)$. The trial space for $w_h$ is $V_h = \\text{span}\\{N_2\\}$. The reduced system for $w_h$ has a single degree of freedom. To find the corresponding entry in the right-hand side vector, we must use the basis function for this degree of freedom, $N_2(x)$, as the test function, i.e., $v_h = N_2(x)$.\n\nThe modified right-hand side entry is $l_{mod}(N_2)$:\n$$l_{mod}(N_2) = \\int_{0}^{1} N_2(x) f(x) dx + N_2(1) g_{N} - \\int_{0}^{1} k \\frac{d N_2}{dx} \\frac{du_L}{dx} dx$$\nWe compute each term separately:\n1. Contribution from the source term $f(x)$:\n$$\\int_{0}^{1} N_2(x) f(x) dx = \\int_{0}^{1} x \\cdot 4 dx = 4 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 4 \\left( \\frac{1^2}{2} - 0 \\right) = 2$$\n2. Contribution from the Neumann boundary condition $g_N$:\n$$N_2(1) g_{N} = 1 \\cdot 5 = 5$$\n3. Contribution from the lifting function $u_L$:\n$$- \\int_{0}^{1} k \\frac{d N_2}{dx} \\frac{du_L}{dx} dx = - \\int_{0}^{1} 3 \\cdot (1) \\cdot (-2) dx = - \\int_{0}^{1} (-6) dx = 6 \\int_{0}^{1} dx = 6[x]_0^1 = 6$$\n\nSumming these contributions gives the total value of the modified right-hand side entry:\n$$l_{mod}(N_2) = 2 + 5 + 6 = 13$$\nThis is the single scalar value for the right-hand side of the reduced one-degree-of-freedom system for $w_h$.", "answer": "$$\\boxed{13}$$", "id": "2543141"}, {"introduction": "When we move from static to dynamic problems, the spatial discretization gives rise to a mass matrix in addition to the stiffness matrix. This practice investigates the crucial choice between a mathematically consistent mass matrix and a computationally efficient lumped mass matrix for the wave equation. You will analyze how this choice fundamentally alters the system's eigenvalue spectrum and, consequently, the maximum stable time step for explicit time integration schemes [@problem_id:2543157].", "problem": "Consider the one-dimensional wave Partial Differential Equation (PDE) on the interval $0 \\le x \\le 1$,\n$$u_{tt}(x,t) = u_{xx}(x,t),$$\nwith homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(1,t)=0$, and initial data sufficiently smooth so that a standard semidiscrete analysis applies. Use the Finite Element Method (FEM) with a Galerkin spatial discretization based on continuous, piecewise-linear basis functions over a uniform mesh of three equal elements (four equally spaced nodes). Take unit mass density and unit wave speed so that no additional physical parameters appear.\n\nStarting from the weak form and the Galerkin construction, do the following:\n1) Derive the element-level consistent mass matrix and element-level stiffness matrix for a single element of length $h$ using the standard linear shape functions. Then assemble the interior (Dirichlet boundary conditions imposed) global stiffness matrix $K$ and the interior global consistent mass matrix $M_{\\mathrm{c}}$ for this mesh.\n2) Define the lumped mass matrix by the standard row-sum lumping applied to the assembled consistent mass matrix. Construct the interior global lumped mass matrix $M_{\\mathrm{l}}$ for this mesh.\n3) For each of the two semidiscrete systems $M_{\\mathrm{c}} \\ddot{\\boldsymbol{u}} + K \\boldsymbol{u}=\\boldsymbol{0}$ and $M_{\\mathrm{l}} \\ddot{\\boldsymbol{u}} + K \\boldsymbol{u}=\\boldsymbol{0}$, characterize the modal dynamics via the generalized eigenproblem $K \\boldsymbol{\\phi} = \\lambda M \\boldsymbol{\\phi}$ and determine the largest generalized eigenvalue $\\lambda_{\\max}$ in each case.\n4) Using the linear stability requirement for the explicit central difference time integrator applied to the scalar oscillator $\\ddot{y} + \\omega^{2} y = 0$, determine the maximum stable time step $\\Delta t_{\\max}$ in terms of $\\lambda_{\\max}$ for each semidiscrete model and compute the ratio\n$$r \\equiv \\frac{\\Delta t_{\\max}(M_{\\mathrm{l}})}{\\Delta t_{\\max}(M_{\\mathrm{c}})}.$$\n\nGive your final result for $r$ as a single exact expression in simplest radical form. Do not provide intermediate values. No units are required for $r$.", "solution": "The problem as stated is scientifically grounded, well-posed, and contains all necessary information for a unique solution. It represents a standard exercise in the computational analysis of partial differential equations using the Finite Element Method. We proceed with the solution.\n\nThe problem requires a multistep analysis of a semi-discretized one-dimensional wave equation, $u_{tt} = u_{xx}$.\n\n1.  Derivation of Element Matrices\nThe weak form of the PDE $u_{tt} - u_{xx} = 0$ is obtained by multiplying by a test function $v(x)$ from the space of functions $H_0^1([0,1])$ and integrating over the domain $\\Omega = [0,1]$. After integration by parts of the spatial derivative term, we have:\n$$ \\int_{0}^{1} v u_{tt} \\,dx + \\int_{0}^{1} v_x u_x \\,dx = 0 $$\nFor a generic element of length $h$, we introduce linear shape functions $N_1(\\xi) = 1 - \\xi/h$ and $N_2(\\xi) = \\xi/h$ for $\\xi \\in [0,h]$. The element consistent mass matrix $M^e$ and stiffness matrix $K^e$ are given by the integrals of products of these shape functions and their derivatives, respectively.\n\nThe components of the element consistent mass matrix, $M^e_{ij} = \\int_0^h N_i(\\xi) N_j(\\xi) \\,d\\xi$, are:\n$M^e_{11} = \\int_0^h (1-\\frac{\\xi}{h})^2 \\,d\\xi = \\frac{h}{3}$\n$M^e_{12} = M^e_{21} = \\int_0^h (1-\\frac{\\xi}{h})(\\frac{\\xi}{h}) \\,d\\xi = \\frac{h}{6}$\n$M^e_{22} = \\int_0^h (\\frac{\\xi}{h})^2 \\,d\\xi = \\frac{h}{3}$\nThis assembles into the element consistent mass matrix:\n$$ M^e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\nThe components of the element stiffness matrix, $K^e_{ij} = \\int_0^h N'_i(\\xi) N'_j(\\xi) \\,d\\xi$, with derivatives $N'_1(\\xi)=-1/h$ and $N'_2(\\xi)=1/h$, are:\n$K^e_{11} = \\int_0^h (-\\frac{1}{h})(-\\frac{1}{h}) \\,d\\xi = \\frac{1}{h}$\n$K^e_{12} = K^e_{21} = \\int_0^h (-\\frac{1}{h})(\\frac{1}{h}) \\,d\\xi = -\\frac{1}{h}$\n$K^e_{22} = \\int_0^h (\\frac{1}{h})(\\frac{1}{h}) \\,d\\xi = \\frac{1}{h}$\nThis assembles into the element stiffness matrix:\n$$ K^e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n\n2.  Assembly of Global Interior Matrices\nThe domain $[0,1]$ is divided into $3$ equal elements, so the element length is $h=1/3$. There are $4$ nodes at $x=0$, $x=1/3$, $x=2/3$, and $x=1$. Homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(1,t)=0$ mean that the degrees of freedom at the exterior nodes ($x=0$ and $x=1$) are zero. We only consider the $2$ interior nodes. The global matrices for these interior degrees of freedom are $2 \\times 2$.\n\nAssembling the contributions from the $3$ elements, the full global stiffness matrix would be:\n$$ K_{\\mathrm{full}} = \\frac{1}{h} \\begin{pmatrix} 1  -1  0  0 \\\\ -1  1+1  -1  0 \\\\ 0  -1  1+1  -1 \\\\ 0  0  -1  1 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} 1  -1  0  0 \\\\ -1  2  -1  0 \\\\ 0  -1  2  -1 \\\\ 0  0  -1  1 \\end{pmatrix} $$\nThe full global consistent mass matrix is:\n$$ M_{\\mathrm{c,full}} = \\frac{h}{6} \\begin{pmatrix} 2  1  0  0 \\\\ 1  2+2  1  0 \\\\ 0  1  2+2  1 \\\\ 0  0  1  2 \\end{pmatrix} = \\frac{h}{6} \\begin{pmatrix} 2  1  0  0 \\\\ 1  4  1  0 \\\\ 0  1  4  1 \\\\ 0  0  1  2 \\end{pmatrix} $$\nApplying the Dirichlet boundary conditions corresponds to extracting the submatrices for the interior nodes (rows and columns $2$ and $3$).\nThe interior global stiffness matrix $K$ is:\n$$ K = \\frac{1}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} $$\nThe interior global consistent mass matrix $M_{\\mathrm{c}}$ is:\n$$ M_{\\mathrm{c}} = \\frac{h}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} $$\n\n3.  Construction of the Lumped Mass Matrix\nThe lumped mass matrix $M_{\\mathrm{l}}$ is obtained by summing the entries of each row of the consistent mass matrix $M_{\\mathrm{c}}$ and placing the result on the diagonal.\n$$ M_{\\mathrm{c}} = \\frac{h}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} $$\nRow $1$ sum: $\\frac{h}{6}(4+1) = \\frac{5h}{6}$.\nRow $2$ sum: $\\frac{h}{6}(1+4) = \\frac{5h}{6}$.\nThus, $M_{\\mathrm{l}} = \\frac{5h}{6} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$. This procedure is incorrect. The standard \"row-sum\" lumping is equivalent to lumping at the element level and then assembling. An element mass matrix $M^e$ lumps to a diagonal matrix with entries $h/2$. The assembly of these element-level lumped matrices gives a global lumped matrix with diagonal entries $h$ for interior nodes and $h/2$ for boundary nodes. The interior matrix is therefore:\n$$ M_{\\mathrm{l}} = h \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = h I $$\n\n4.  Generalized Eigenvalue Problems\nWe must find the largest generalized eigenvalue $\\lambda_{\\max}$ for each system $K \\boldsymbol{\\phi} = \\lambda M \\boldsymbol{\\phi}$.\n\nFor the consistent mass matrix $M_{\\mathrm{c}}$:\n$$ \\frac{1}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\boldsymbol{\\phi} = \\lambda_{\\mathrm{c}} \\frac{h}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\boldsymbol{\\phi} $$\nWe solve $\\det(K - \\lambda_{\\mathrm{c}} M_{\\mathrm{c}}) = 0$:\n$$ \\det \\left( \\frac{1}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} - \\lambda_{\\mathrm{c}} \\frac{h}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\right) = 0 $$\n$$ \\left( \\frac{2}{h} - \\frac{4h\\lambda_{\\mathrm{c}}}{6} \\right)^2 - \\left( -\\frac{1}{h} - \\frac{h\\lambda_{\\mathrm{c}}}{6} \\right)^2 = 0 $$\nThis yields two equations:\n$\\frac{2}{h} - \\frac{2h\\lambda_{\\mathrm{c}}}{3} = \\frac{1}{h} + \\frac{h\\lambda_{\\mathrm{c}}}{6} \\implies \\frac{1}{h} = \\frac{5h\\lambda_{\\mathrm{c}}}{6} \\implies \\lambda_{\\mathrm{c}} = \\frac{6}{5h^2}$\n$\\frac{2}{h} - \\frac{2h\\lambda_{\\mathrm{c}}}{3} = -(\\frac{1}{h} + \\frac{h\\lambda_{\\mathrm{c}}}{6}) \\implies \\frac{3}{h} = \\frac{3h\\lambda_{\\mathrm{c}}}{6} \\implies \\lambda_{\\mathrm{c}} = \\frac{6}{h^2}$\nThe largest eigenvalue is $\\lambda_{\\max}(M_{\\mathrm{c}}) = \\frac{6}{h^2}$.\n\nFor the lumped mass matrix $M_{\\mathrm{l}}$:\n$$ \\frac{1}{h} \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} \\boldsymbol{\\phi} = \\lambda_{\\mathrm{l}} h \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\boldsymbol{\\phi} $$\nThis is a standard eigenvalue problem for the matrix $\\frac{1}{h^2}\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$. The eigenvalues of $\\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$ are found from $(2-\\mu)^2-1 = 0$, giving $\\mu=1$ and $\\mu=3$.\nThe eigenvalues $\\lambda_{\\mathrm{l}}$ are thus $\\frac{1}{h^2}$ and $\\frac{3}{h^2}$.\nThe largest eigenvalue is $\\lambda_{\\max}(M_{\\mathrm{l}}) = \\frac{3}{h^2}$.\n\n5.  Stability Analysis and Ratio\nThe explicit central difference time integration scheme applied to a harmonic oscillator $\\ddot{y} + \\omega^2 y = 0$ is stable if $\\omega \\Delta t \\le 2$. For a system of oscillators, stability is governed by the highest frequency, $\\omega_{\\max} = \\sqrt{\\lambda_{\\max}}$.\nThe maximum stable time step is therefore $\\Delta t_{\\max} = \\frac{2}{\\omega_{\\max}} = \\frac{2}{\\sqrt{\\lambda_{\\max}}}$.\n\nFor the consistent mass system:\n$$ \\Delta t_{\\max}(M_{\\mathrm{c}}) = \\frac{2}{\\sqrt{\\lambda_{\\max}(M_{\\mathrm{c}})}} = \\frac{2}{\\sqrt{6/h^2}} = \\frac{2h}{\\sqrt{6}} $$\nFor the lumped mass system:\n$$ \\Delta t_{\\max}(M_{\\mathrm{l}}) = \\frac{2}{\\sqrt{\\lambda_{\\max}(M_{\\mathrm{l}})}} = \\frac{2}{\\sqrt{3/h^2}} = \\frac{2h}{\\sqrt{3}} $$\nThe ratio $r$ is:\n$$ r = \\frac{\\Delta t_{\\max}(M_{\\mathrm{l}})}{\\Delta t_{\\max}(M_{\\mathrm{c}})} = \\frac{2h/\\sqrt{3}}{2h/\\sqrt{6}} = \\frac{\\sqrt{6}}{\\sqrt{3}} = \\sqrt{\\frac{6}{3}} = \\sqrt{2} $$\nThe result is independent of the element size $h$.", "answer": "$$\\boxed{\\sqrt{2}}$$", "id": "2543157"}, {"introduction": "Once a partial differential equation has been semi-discretized in space, we are left with a system of ordinary differential equations to solve in time. This exercise focuses on the celebrated Newmark family of time integrators, a standard tool for second-order systems in computational mechanics. You will derive the method and perform a stability and accuracy analysis, providing insight into how the parameters $\\beta$ and $\\gamma$ control the algorithm's performance and allow us to design unconditionally stable, second-order accurate schemes [@problem_id:2543112].", "problem": "Consider the semidiscrete form of the linear wave equation obtained by a standard Galerkin finite element method: find the vector of nodal unknowns $u(t) \\in \\mathbb{R}^{n}$ such that\n$$\nM \\ddot{u}(t) + K u(t) = f(t), \\quad t \\in (0,T],\n$$\nwith initial conditions $u(0) = u_{0}$ and $\\dot{u}(0) = v_{0}$, where $M \\in \\mathbb{R}^{n \\times n}$ is symmetric positive definite, $K \\in \\mathbb{R}^{n \\times n}$ is symmetric positive semidefinite, and $f(t) \\in \\mathbb{R}^{n}$ is a prescribed load. Let $t_{n} = n h$ denote a uniform partition of $[0,T]$ with time step $h  0$.\n\nStarting only from the kinematic relations $\\dot{u} = v$ and $\\dot{v} = a$ with $a(t) = \\ddot{u}(t)$, and the balance equation $M a(t) + K u(t) = f(t)$, derive a one-step time integrator that advances $\\{u_{n}, v_{n}\\}$ to $\\{u_{n+1}, v_{n+1}\\}$ by assuming $a(t)$ is approximated over $[t_{n}, t_{n+1}]$ in a way that is affine in the endpoint values $a_{n}$ and $a_{n+1}$. Your derivation should yield the two-parameter Newmark family with parameters $\\beta$ and $\\gamma$ in the update formulas for $u_{n+1}$ and $v_{n+1}$ and an implicit equilibrium equation to determine $a_{n+1}$.\n\nThen, specialize to the homogeneous case $f \\equiv 0$ and analyze unconditional stability by considering the single-degree-of-freedom modal component governed by\n$$\n\\ddot{w}(t) + \\omega^{2} w(t) = 0,\n$$\nobtained by mass-normalizing the mode, where $\\omega \\ge 0$ is the natural frequency. Form the $2 \\times 2$ amplification matrix that maps $\\begin{pmatrix} w_{n} \\\\ \\dot{w}_{n} \\end{pmatrix}$ to $\\begin{pmatrix} w_{n+1} \\\\ \\dot{w}_{n+1} \\end{pmatrix}$, and determine necessary and sufficient conditions on $(\\beta,\\gamma)$ such that the spectral radius of this amplification matrix is at most $1$ for all nondimensional time steps $\\nu = \\omega h \\in [0,\\infty)$.\n\nNext, determine the condition on $(\\beta,\\gamma)$ required for second-order accuracy in time of the method for smooth solutions, by matching the truncation error through terms of order $h^{2}$ using Taylor expansions of $u(t)$ and $v(t)$ about $t_{n}$.\n\nFinally, under the simultaneous requirements of unconditional stability and second-order accuracy, determine the minimal value of $\\beta$. Provide only this minimal $\\beta$ as your final answer in exact form, with no units and no rounding.", "solution": "We begin with the semidiscrete system\n$$\nM \\ddot{u}(t) + K u(t) = f(t), \\quad \\dot{u}(t) = v(t), \\quad \\dot{v}(t) = a(t) = \\ddot{u}(t).\n$$\nIntegrating the kinematic relations over a single time step $[t_{n}, t_{n+1}]$ of size $h$ gives\n$$\nu_{n+1} = u_{n} + \\int_{t_{n}}^{t_{n+1}} v(t) \\, dt, \\quad\nv_{n+1} = v_{n} + \\int_{t_{n}}^{t_{n+1}} a(t) \\, dt.\n$$\nAssume that $a(t)$ over $[t_{n}, t_{n+1}]$ is approximated by a function affine in $a_{n}$ and $a_{n+1}$, which leads to the standard Newmark family formulas parameterized by $\\beta$ and $\\gamma$:\n$$\nv_{n+1} = v_{n} + h \\left[(1 - \\gamma) a_{n} + \\gamma a_{n+1}\\right],\n$$\n$$\nu_{n+1} = u_{n} + h v_{n} + h^{2} \\left[\\left(\\tfrac{1}{2} - \\beta\\right) a_{n} + \\beta a_{n+1}\\right].\n$$\nThese are closed by the semidiscrete equilibrium evaluated at $t_{n+1}$,\n$$\nM a_{n+1} + K u_{n+1} = f_{n+1},\n$$\nwhich, together with the two update relations, forms an implicit one-step method for $(u_{n+1}, v_{n+1}, a_{n+1})$ from $(u_{n}, v_{n}, a_{n})$.\n\nTo analyze unconditional stability, consider the homogeneous case $f \\equiv 0$ and a single modal component of the decoupled system with unit modal mass,\n$$\n\\ddot{w}(t) + \\omega^{2} w(t) = 0.\n$$\nLet $\\nu = \\omega h$ denote the nondimensional time step. For this scalar oscillator, $a_{n} = \\ddot{w}_{n} = -\\omega^{2} w_{n}$ and $a_{n+1} = -\\omega^{2} w_{n+1}$. Substituting into the Newmark updates yields\n$$\nw_{n+1} = w_{n} + h \\dot{w}_{n} + h^{2} \\left[ \\left(\\tfrac{1}{2} - \\beta \\right)(-\\omega^{2} w_{n}) + \\beta (-\\omega^{2} w_{n+1}) \\right],\n$$\n$$\n\\dot{w}_{n+1} = \\dot{w}_{n} + h \\left[(1 - \\gamma)(-\\omega^{2} w_{n}) + \\gamma (-\\omega^{2} w_{n+1})\\right].\n$$\nRearrange the displacement update to solve for $w_{n+1}$:\n$$\n\\left(1 + \\beta \\nu^{2}\\right) w_{n+1}\n= \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right] w_{n} + h \\dot{w}_{n}.\n$$\nDefine $c := \\left(1 + \\beta \\nu^{2}\\right)^{-1}$. Then\n$$\nw_{n+1} = c \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right] w_{n} + c h \\dot{w}_{n}.\n$$\nSubstitute this into the velocity update to write the one-step map in matrix form\n$$\n\\begin{pmatrix}\nw_{n+1} \\\\ \\dot{w}_{n+1}\n\\end{pmatrix}\n= G(\\nu; \\beta,\\gamma)\n\\begin{pmatrix}\nw_{n} \\\\ \\dot{w}_{n}\n\\end{pmatrix},\n$$\nwith\n$$\nG =\n\\begin{pmatrix}\nA  B \\\\\nC  D\n\\end{pmatrix},\n\\quad\nA = c \\left[ 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right], \\quad\nB = c h,\n$$\n$$\nC = -\\frac{\\nu^{2}}{h} \\left[ (1 - \\gamma) + \\gamma c \\left( 1 - \\left(\\tfrac{1}{2} - \\beta\\right) \\nu^{2} \\right) \\right], \\quad\nD = 1 - \\gamma c \\nu^{2}.\n$$\nThe characteristic polynomial of $G$ is $\\lambda^{2} - \\tau \\lambda + \\Delta = 0$ with trace $\\tau = A + D$ and determinant $\\Delta = AD - BC$. A direct computation gives\n$$\n\\tau(\\nu) = \\frac{ 2 + \\left( 2 \\beta - \\gamma - \\tfrac{1}{2} \\right) \\nu^{2} }{ 1 + \\beta \\nu^{2} }, \n\\qquad\n\\Delta(\\nu) = \\frac{ 1 + \\left( \\tfrac{1}{2} + \\beta - \\gamma \\right) \\nu^{2} }{ 1 + \\beta \\nu^{2} }.\n$$\nA necessary and sufficient condition for all eigenvalues of $G$ to lie in the closed unit disk for all $\\nu \\ge 0$ (unconditional stability) is the set of Jury (discrete-time) inequalities for the polynomial $\\lambda^{2} - \\tau \\lambda + \\Delta$:\n$$\n1 - \\Delta(\\nu) \\ge 0, \\quad 1 + \\tau(\\nu) + \\Delta(\\nu) \\ge 0, \\quad 1 - \\tau(\\nu) + \\Delta(\\nu) \\ge 0 \\quad \\text{for all } \\nu \\ge 0.\n$$\nUsing the expressions for $\\tau$ and $\\Delta$,\n$$\n1 - \\Delta(\\nu) = \\frac{ (\\gamma - \\tfrac{1}{2}) \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\Longleftrightarrow \\quad \\gamma \\ge \\tfrac{1}{2},\n$$\n$$\n1 + \\tau(\\nu) + \\Delta(\\nu) = \\frac{ 4 + 2(2\\beta - \\gamma) \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\text{for all } \\nu \\ge 0 \\quad \\Longleftrightarrow \\quad \\beta \\ge \\tfrac{\\gamma}{2},\n$$\n$$\n1 - \\tau(\\nu) + \\Delta(\\nu) = \\frac{ \\nu^{2} }{ 1 + \\beta \\nu^{2} } \\ge 0 \\quad \\text{always}.\n$$\nTherefore, the necessary and sufficient conditions for unconditional stability are\n$$\n\\gamma \\ge \\tfrac{1}{2}, \\qquad \\beta \\ge \\tfrac{\\gamma}{2}.\n$$\n\nNext, we determine the condition for second-order accuracy. Perform Taylor expansions about $t_{n}$ for smooth solutions:\n$$\nu(t_{n+1}) = u_{n} + h v_{n} + \\tfrac{h^{2}}{2} a_{n} + \\tfrac{h^{3}}{6} j_{n} + \\mathcal{O}(h^{4}),\n\\quad\nv(t_{n+1}) = v_{n} + h a_{n} + \\tfrac{h^{2}}{2} j_{n} + \\mathcal{O}(h^{3}),\n$$\nwhere $j_{n} = \\dot{a}(t_{n}) = u^{(3)}(t_{n})$. Also expand $a_{n+1} = a_{n} + h j_{n} + \\mathcal{O}(h^{2})$.\n\nCompare the Newmark velocity update to the exact increment:\n$$\nv_{n+1} - v_{n} = h \\left[ (1 - \\gamma) a_{n} + \\gamma a_{n+1} \\right]\n= h \\left[ a_{n} + \\gamma h j_{n} \\right] + \\mathcal{O}(h^{3}).\n$$\nFor consistency through $\\mathcal{O}(h^{2})$, this must match $h a_{n} + \\tfrac{h^{2}}{2} j_{n}$, which requires\n$$\n\\gamma = \\tfrac{1}{2}.\n$$\nNow compare the displacement update:\n$$\nu_{n+1} - u_{n} - h v_{n} = h^{2} \\left[ \\left(\\tfrac{1}{2} - \\beta\\right) a_{n} + \\beta a_{n+1} \\right]\n= \\tfrac{h^{2}}{2} a_{n} + \\beta h^{3} j_{n} + \\mathcal{O}(h^{4}),\n$$\nwhile the exact increment is $\\tfrac{h^{2}}{2} a_{n} + \\tfrac{h^{3}}{6} j_{n} + \\mathcal{O}(h^{4})$. Matching the $\\mathcal{O}(h^{2})$ term imposes no additional condition on $\\beta$ because the coefficient of $a_{n}$ is exactly $\\tfrac{1}{2}$ for all $\\beta$. Hence, the Newmark family is second-order accurate if and only if\n$\n\\gamma = \\tfrac{1}{2},\n$\nwith no further restriction on $\\beta$ for order.\n\nFinally, impose both unconditional stability and second-order accuracy. Combining $\\gamma \\ge \\tfrac{1}{2}$ and $\\beta \\ge \\tfrac{\\gamma}{2}$ with $\\gamma = \\tfrac{1}{2}$ for second order yields\n$$\n\\beta \\ge \\tfrac{1}{4}.\n$$\nTherefore, the minimal $\\beta$ consistent with unconditional stability and second-order accuracy is\n$$\n\\beta_{\\min} = \\tfrac{1}{4}.\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "2543112"}]}