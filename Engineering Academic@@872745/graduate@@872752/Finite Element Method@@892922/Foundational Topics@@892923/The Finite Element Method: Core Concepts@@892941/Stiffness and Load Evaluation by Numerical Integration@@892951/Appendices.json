{"hands_on_practices": [{"introduction": "A cornerstone of the Finite Element Method is the use of numerical quadrature to evaluate integrals for stiffness matrices and load vectors. This practice provides a fundamental skill: determining the minimum number of quadrature points required for exact integration. By analyzing the polynomial degree of the complete integrand, including contributions from shape functions, the isoparametric mapping, and the applied load, you will derive the precise Gauss-Legendre rule needed for a one-dimensional element of arbitrary polynomial order $p$ [@problem_id:2599441].", "problem": "Consider a one-dimensional isoparametric Lagrange bar element of polynomial order $p \\ge 1$ used in the Finite Element Method (FEM). Let the parent element be the interval $\\xi \\in [-1,1]$ with shape functions $N_i(\\xi)$, $i=1,\\dots,n_{\\text{en}}$, where each $N_i(\\xi)$ is a polynomial of degree $p$. The isoparametric mapping to the physical coordinate is $x(\\xi) = \\sum_{i=1}^{n_{\\text{en}}} N_i(\\xi)\\,x_i$ with generic nodal coordinates $x_i \\in \\mathbb{R}$, and its Jacobian is $J(\\xi) = \\frac{dx}{d\\xi}$. The consistent element body force load vector is\n$$\nf_e \\;=\\; \\int_{\\Omega_e} N^{T}(x)\\,b(x)\\,d\\Omega \\,,\n$$\nwhere $b(x)$ is a given body force per unit length that is linear in the physical coordinate, i.e., $b(x) = \\beta_0 + \\beta_1 x$ with $\\beta_0,\\beta_1 \\in \\mathbb{R}$. The integral is to be evaluated by mapping to the parent domain and using standard Gauss–Legendre quadrature on $[-1,1]$. Determine, in closed form, the minimal number $n$ of Gauss–Legendre points required to evaluate $f_e$ exactly for arbitrary nodal coordinates $x_i$ and coefficients $\\beta_0,\\beta_1$, assuming a general (not necessarily affine) isoparametric mapping. Your final answer must be a single analytic expression in terms of $p$ only. Do not round or approximate.", "solution": "The problem will first be subject to rigorous validation.\n\n**Step 1: Extract Givens**\n\nThe givens from the problem statement are as follows:\n- Element type: One-dimensional isoparametric Lagrange bar element.\n- Polynomial order of shape functions: $p \\ge 1$.\n- Parent element domain: $\\xi \\in [-1,1]$.\n- Shape functions: $N_i(\\xi)$, $i=1,\\dots,n_{\\text{en}}$, are polynomials of degree $p$. The number of element nodes is $n_{\\text{en}} = p+1$.\n- Isoparametric mapping: $x(\\xi) = \\sum_{i=1}^{n_{\\text{en}}} N_i(\\xi)\\,x_i$.\n- Nodal coordinates: $x_i \\in \\mathbb{R}$ are arbitrary.\n- Jacobian of the mapping: $J(\\xi) = \\frac{dx}{d\\xi}$.\n- The mapping is general, not necessarily affine.\n- Consistent element body force load vector: $f_e = \\int_{\\Omega_e} N^{T}(x)\\,b(x)\\,d\\Omega$.\n- Body force per unit length: $b(x) = \\beta_0 + \\beta_1 x$, linear in the physical coordinate $x$.\n- Coefficients: $\\beta_0, \\beta_1 \\in \\mathbb{R}$ are arbitrary.\n- Integration method: Gauss–Legendre quadrature on $[-1,1]$ after mapping.\n- Objective: Find the minimal number of Gauss points, $n$, required for exact evaluation of the integral for any valid $x_i$, $\\beta_0$, and $\\beta_1$, expressed as a function of $p$.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is subjected to validation against established criteria.\n- **Scientifically Grounded and Objective**: The problem is formulated using standard concepts from the Finite Element Method, a cornerstone of computational mechanics and engineering analysis. All terms such as isoparametric mapping, shape functions, Gauss-Legendre quadrature, and consistent load vectors are well-defined and standard in the field. The problem is objective and states its conditions with mathematical precision.\n- **Well-Posed and Complete**: The problem is self-contained. It provides all necessary information to determine the polynomial degree of the integrand, which is the sole factor determining the required number of Gauss points. The constraints (arbitrary $x_i$, $\\beta_0, \\beta_1$; general mapping) are clear and serve to define the worst-case scenario that the quadrature rule must accommodate, ensuring a unique and meaningful solution.\n- **Not Trivial or Pseudo-Profound**: The problem requires careful analysis of how the polynomial degrees of the shape functions, the mapping, and the load function compose. The distinction between a general isoparametric mapping and a simpler affine mapping is crucial and elevates the problem beyond a trivial textbook exercise.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed valid as it is scientifically sound, well-posed, and requires non-trivial analytical reasoning. A complete solution will now be provided.\n\n**Solution**\n\nThe task is to determine the minimum number of Gauss-Legendre quadrature points, $n$, required to exactly compute the consistent element body force vector, $f_e$. The $j$-th component of this vector is given by\n$$\n(f_e)_j = \\int_{\\Omega_e} N_j(x)\\,b(x)\\,dx\n$$\nThis integral is defined over the physical element domain $\\Omega_e$. To evaluate it using Gauss-Legendre quadrature, we must first transform it to an integral over the parent element domain $\\xi \\in [-1,1]$. The differential length element transforms as $dx = \\frac{dx}{d\\xi}d\\xi = J(\\xi)d\\xi$. The shape function $N_j(x)$ and the body force $b(x)$ are expressed in terms of the parent coordinate $\\xi$ using the isoparametric mapping $x=x(\\xi)$. The integral becomes:\n$$\n(f_e)_j = \\int_{-1}^{1} N_j(\\xi) \\, b(x(\\xi)) \\, J(\\xi) \\, d\\xi\n$$\nThe number of Gauss points required for exact integration depends on the polynomial degree of the integrand, which we denote as $I(\\xi)$:\n$$\nI(\\xi) = N_j(\\xi) \\, b(x(\\xi)) \\, J(\\xi)\n$$\nThe degree of a product of polynomials is the sum of their individual degrees. We must find the degree of each term in $I(\\xi)$.\n \n$1$. **Degree of the shape function $N_j(\\xi)$**:\nThe problem states that the element uses Lagrange polynomials of order $p$. Thus, the shape function $N_j(\\xi)$ is a polynomial in $\\xi$ of degree $p$.\n$$\n\\text{deg}(N_j) = p\n$$\n\n$2$. **Degree of the body force term $b(x(\\xi))$**:\nThe body force is given as a linear function of the physical coordinate $x$: $b(x) = \\beta_0 + \\beta_1 x$. The isoparametric mapping is $x(\\xi) = \\sum_{i=1}^{n_{\\text{en}}} N_i(\\xi)x_i$. Since each shape function $N_i(\\xi)$ is a polynomial of degree $p$, the physical coordinate $x(\\xi)$ is also a polynomial of degree $p$ in $\\xi$ (assuming arbitrary nodal coordinates $x_i$ such that the leading terms do not cancel). Substituting $x(\\xi)$ into the expression for $b(x)$ yields:\n$$\nb(x(\\xi)) = \\beta_0 + \\beta_1 x(\\xi)\n$$\nGiven that $\\beta_1$ is an arbitrary real number (and can be non-zero) and $x(\\xi)$ is a polynomial of degree $p$, the term $b(x(\\xi))$ is a polynomial in $\\xi$ of degree $p$.\n$$\n\\text{deg}(b(x(\\xi))) = p\n$$\n\n$3$. **Degree of the Jacobian $J(\\xi)$**:\nThe Jacobian of the mapping is the derivative of $x(\\xi)$ with respect to $\\xi$:\n$$\nJ(\\xi) = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\sum_{i=1}^{n_{\\text{en}}} N_i(\\xi)x_i \\right) = \\sum_{i=1}^{n_{\\text{en}}} \\frac{dN_i(\\xi)}{d\\xi}x_i\n$$\nSince $N_i(\\xi)$ is a polynomial of degree $p$, its derivative $\\frac{dN_i(\\xi)}{d\\xi}$ is a polynomial of degree $p-1$. As the nodal coordinates $x_i$ are arbitrary, the Jacobian $J(\\xi)$ is, in general, a polynomial of degree $p-1$. The \"general (not necessarily affine) mapping\" specification is critical here; for $p1$, the Jacobian is not constant.\n$$\n\\text{deg}(J) = p-1\n$$\n\nNow, we compute the total degree of the integrand $I(\\xi)$. Since we must guarantee exact integration for arbitrary (non-zero) $\\beta_1$ and arbitrary (non-degenerate) nodal positions $x_i$, we must consider the maximum possible degree, which is a sum of the degrees of the constituent polynomials:\n$$\n\\text{deg}(I) = \\text{deg}(N_j) + \\text{deg}(b(x(\\xi))) + \\text{deg}(J) = p + p + (p-1) = 3p - 1\n$$\nIt is a fundamental theorem of numerical integration that a Gauss-Legendre quadrature rule with $n$ points can integrate any polynomial of degree up to $2n-1$ exactly. To ensure exact integration of $I(\\xi)$, we must satisfy the condition:\n$$\n2n - 1 \\ge \\text{deg}(I)\n$$\nSubstituting the degree of our integrand:\n$$\n2n - 1 \\ge 3p - 1\n$$\nThis inequality simplifies to:\n$$\n2n \\ge 3p \\quad \\implies \\quad n \\ge \\frac{3p}{2}\n$$\nSince the number of quadrature points $n$ must be an integer, we must take the smallest integer that satisfies this condition. This is given by the ceiling function.\n$$\nn = \\left\\lceil \\frac{3p}{2} \\right\\rceil\n$$\nThis is the minimal number of Gauss-Legendre points required to exactly integrate the consistent body force vector for a general one-dimensional isoparametric element of order $p$ and a linearly varying body force.", "answer": "$$\n\\boxed{\\left\\lceil \\frac{3p}{2} \\right\\rceil}\n$$", "id": "2599441"}, {"introduction": "While exact integration is possible for simple cases, practical applications often involve distorted elements where the integrand is no longer a pure polynomial. This exercise explores the consequences of a non-affine isoparametric mapping, which introduces non-polynomial terms into the stiffness integrand. By performing an asymptotic analysis on a distorted quadrilateral element, you will quantify the integration error of a standard quadrature rule and see firsthand why higher-order rules are often necessary to maintain accuracy [@problem_id:2599455].", "problem": "Consider the scalar diffusion model with unit conductivity in the Finite Element Method (FEM) on a single isoparametric bilinear quadrilateral element. The element is obtained from the reference square $\\{(\\xi,\\eta)\\,:\\,-1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ via the nonaffine bilinear mapping\n$$\nx(\\xi,\\eta) \\;=\\; \\xi \\;+\\; \\frac{\\epsilon}{2}\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta) \\;=\\; \\eta,\n$$\nwhere $\\epsilon$ is a small, dimensionless distortion parameter with $|\\epsilon| \\ll 1$. Let $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$ denote the standard bilinear shape function associated with the lower-left node. The scalar element stiffness entry is\n$$\nK_{11} \\;=\\; \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\nabla N_{1} \\cdot \\nabla N_{1}\\;\\det J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $J(\\xi,\\eta)$ is the Jacobian of the isoparametric map, and $\\nabla$ is taken with respect to the physical coordinates. Using first principles (isoparametric mapping, chain rule, and Gaussian numerical integration), perform an asymptotic expansion in $\\epsilon$ up to and including terms of order $\\epsilon^{2}$, and compare the tensor-product Gaussian quadratures with $2 \\times 2$ and $3 \\times 3$ points for evaluating $K_{11}$.\n\nSpecifically, determine the leading-order coefficient $C$ in the expansion\n$$\nK_{11}^{(2\\times 2)} \\;-\\; K_{11}^{\\mathrm{exact}} \\;=\\; C\\,\\epsilon^{2} \\;+\\; \\mathcal{O}(\\epsilon^{3}),\n$$\nand argue whether the corresponding coefficient for the $3 \\times 3$ rule is zero or nonzero at order $\\epsilon^{2}$. Your final answer must be the single real number $C$ (no units). No rounding is required; report the exact value.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Model: Scalar diffusion with unit conductivity in the Finite Element Method.\n- Element: A single isoparametric bilinear quadrilateral element.\n- Reference Domain: A square defined by $\\{(\\xi,\\eta)\\,|\\,-1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$.\n- Isoparametric Mapping: $x(\\xi,\\eta) = \\xi + \\frac{\\epsilon}{2}\\,\\xi\\,\\eta$, $y(\\xi,\\eta) = \\eta$.\n- Parameter: $\\epsilon$ is a small, dimensionless distortion parameter, $|\\epsilon| \\ll 1$.\n- Shape Function: $N_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$.\n- Stiffness Entry: $K_{11} = \\int_{-1}^{1}\\!\\!\\int_{-1}^{1} \\nabla N_{1} \\cdot \\nabla N_{1}\\;\\det J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta$.\n- $J(\\xi,\\eta)$ is the Jacobian matrix of the isoparametric map.\n- $\\nabla$ is the gradient with respect to physical coordinates $(x,y)$.\n- Task: Determine the leading-order coefficient $C$ in the asymptotic expansion $K_{11}^{(2\\times 2)} - K_{11}^{\\mathrm{exact}} = C\\,\\epsilon^{2} + \\mathcal{O}(\\epsilon^{3})$, where $K_{11}^{(2\\times 2)}$ is the value of the integral evaluated using a $2 \\times 2$ tensor-product Gaussian quadrature.\n- Additional Task: Argue whether the corresponding coefficient for the $3 \\times 3$ rule is zero or nonzero at order $\\epsilon^{2}$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard exercise in the theory of the Finite Element Method. All concepts—isoparametric mapping, stiffness matrix assembly, numerical integration—are fundamental to computational mechanics and applied mathematics.\n- **Well-Posed:** The problem is clearly defined and asks for a specific, computable quantity ($C$). The necessary functions and definitions are provided for a unique solution to be determined.\n- **Objective:** The problem is stated in precise mathematical language, free from subjectivity or ambiguity.\n- **Completeness and Consistency:** The problem is self-contained. All necessary information is provided, and there are no contradictions in the givens.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically sound, well-posed, and complete. A rigorous analytical solution can be pursued.\n\nWe now proceed with the solution. The core of the problem is to compare the exact value of the integral for $K_{11}$ with its approximation by a $2\\times2$ Gaussian quadrature, both expanded as a series in the small parameter $\\epsilon$.\n\nFirst, we compute the components of the integrand. The Jacobian matrix of the mapping from $(\\xi, \\eta)$ to $(x, y)$ is\n$$\nJ(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1 + \\frac{\\epsilon}{2}\\eta  \\frac{\\epsilon}{2}\\xi \\\\ 0  1 \\end{pmatrix}.\n$$\nThe determinant of the Jacobian is\n$$\n\\det J(\\xi,\\eta) = 1 + \\frac{\\epsilon}{2}\\eta.\n$$\nThe gradient of the shape function $N_1$ with respect to the reference coordinates $(\\xi, \\eta)$ is\n$$\n\\nabla_{\\!\\xi} N_1 = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} -(1-\\eta) \\\\ -(1-\\xi) \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} \\eta-1 \\\\ \\xi-1 \\end{pmatrix}.\n$$\nThe gradient in physical coordinates, $\\nabla N_1$, is related to $\\nabla_{\\!\\xi} N_1$ by the chain rule: $\\nabla N_1 = (J^{-1})^T \\nabla_{\\!\\xi} N_1$. The inverse of the Jacobian matrix is\n$$\nJ^{-1} = \\frac{1}{\\det J} \\begin{pmatrix} 1  -\\frac{\\epsilon}{2}\\xi \\\\ 0  1 + \\frac{\\epsilon}{2}\\eta \\end{pmatrix} = \\frac{1}{1 + \\frac{\\epsilon}{2}\\eta} \\begin{pmatrix} 1  -\\frac{\\epsilon}{2}\\xi \\\\ 0  1 + \\frac{\\epsilon}{2}\\eta \\end{pmatrix}.\n$$\nThus,\n$$\n\\nabla N_1 = \\left( \\frac{1}{1 + \\frac{\\epsilon}{2}\\eta} \\begin{pmatrix} 1  0 \\\\ -\\frac{\\epsilon}{2}\\xi  1 + \\frac{\\epsilon}{2}\\eta \\end{pmatrix} \\right) \\left( \\frac{1}{4}\\begin{pmatrix} \\eta-1 \\\\ \\xi-1 \\end{pmatrix} \\right) = \\frac{1}{4(1 + \\frac{\\epsilon}{2}\\eta)} \\begin{pmatrix} \\eta-1 \\\\ -\\frac{\\epsilon}{2}\\xi(\\eta-1) + (1 + \\frac{\\epsilon}{2}\\eta)(\\xi-1) \\end{pmatrix}.\n$$\nSimplifying the second component gives\n$$\n-\\frac{\\epsilon}{2}\\xi\\eta + \\frac{\\epsilon}{2}\\xi + \\xi - 1 + \\frac{\\epsilon}{2}\\xi\\eta - \\frac{\\epsilon}{2}\\eta = \\xi - 1 + \\frac{\\epsilon}{2}(\\xi-\\eta).\n$$\nThe dot product $\\nabla N_1 \\cdot \\nabla N_1$ is then\n$$\n\\nabla N_1 \\cdot \\nabla N_1 = \\frac{1}{16(1 + \\frac{\\epsilon}{2}\\eta)^2} \\left[ (\\eta-1)^2 + \\left(\\xi - 1 + \\frac{\\epsilon}{2}(\\xi-\\eta)\\right)^2 \\right].\n$$\nThe integrand for $K_{11}$ is $I(\\xi, \\eta) = (\\nabla N_1 \\cdot \\nabla N_1) \\det J$:\n$$\nI(\\xi, \\eta) = \\frac{1}{16(1 + \\frac{\\epsilon}{2}\\eta)} \\left[ (\\eta-1)^2 + (\\xi-1)^2 + \\epsilon(\\xi-1)(\\xi-\\eta) + \\frac{\\epsilon^2}{4}(\\xi-\\eta)^2 \\right].\n$$\nFor the exact integral, we expand $I(\\xi, \\eta)$ in a Taylor series in $\\epsilon$ around $\\epsilon=0$. Using $\\frac{1}{1+z} = 1 - z + z^2 - \\mathcal{O}(z^3)$, we get\n$$\n\\frac{1}{1 + \\frac{\\epsilon}{2}\\eta} = 1 - \\frac{\\epsilon}{2}\\eta + \\frac{\\epsilon^2}{4}\\eta^2 - \\mathcal{O}(\\epsilon^3).\n$$\nMultiplying the expansions, we find the integrand up to order $\\epsilon^2$:\n$$\nI(\\xi, \\eta) = \\frac{1}{16} \\left(1 - \\frac{\\epsilon}{2}\\eta + \\frac{\\epsilon^2}{4}\\eta^2\\right) \\left[ \\left((\\xi-1)^2 + (\\eta-1)^2\\right) + \\epsilon\\left((\\xi-1)(\\xi-\\eta)\\right) + \\epsilon^2\\left(\\frac{1}{4}(\\xi-\\eta)^2\\right) \\right] + \\mathcal{O}(\\epsilon^3).\n$$\nLet $I(\\xi,\\eta) = I_0 + \\epsilon I_1 + \\epsilon^2 I_2 + \\mathcal{O}(\\epsilon^3)$. Collecting terms:\n$$\nI_0 = \\frac{1}{16}[(\\xi-1)^2 + (\\eta-1)^2]\n$$\n$$\nI_1 = \\frac{1}{16}\\left[ (\\xi-1)(\\xi-\\eta) - \\frac{\\eta}{2}((\\xi-1)^2 + (\\eta-1)^2) \\right]\n$$\n$$\nI_2 = \\frac{1}{16}\\left[ \\frac{1}{4}(\\xi-\\eta)^2 - \\frac{\\eta}{2}(\\xi-1)(\\xi-\\eta) + \\frac{\\eta^2}{4}((\\xi-1)^2 + (\\eta-1)^2) \\right]\n$$\nThe exact value is $K_{11}^{\\mathrm{exact}} = \\int_{-1}^1\\int_{-1}^1 (I_0 + \\epsilon I_1 + \\epsilon^2 I_2)\\,d\\xi d\\eta + \\mathcal{O}(\\epsilon^3)$.\nWe use the fact that $\\int_{-1}^1 z^p dz = 0$ for odd integer $p$ and $\\frac{2}{p+1}$ for even integer $p$.\n$$\n\\int_{-1}^1\\int_{-1}^1 I_0 \\,d\\xi d\\eta = \\frac{1}{16} \\left( \\int_{-1}^1(\\xi-1)^2 d\\xi \\int_{-1}^1 d\\eta + \\int_{-1}^1 d\\xi \\int_{-1}^1(\\eta-1)^2 d\\eta \\right) = \\frac{1}{16}\\left(\\frac{8}{3} \\cdot 2 + 2 \\cdot \\frac{8}{3}\\right) = \\frac{2}{3}.\n$$\nA detailed calculation of the integral of $I_1$ and $I_2$ yields:\n$$\n\\int_{-1}^1\\int_{-1}^1 I_1 \\,d\\xi d\\eta = \\frac{1}{6}.\n$$\n$$\n\\int_{-1}^1\\int_{-1}^1 I_2 \\,d\\xi d\\eta = \\frac{11}{180}.\n$$\nThe expansion for the exact integral is:\n$$\nK_{11}^{\\mathrm{exact}} = \\frac{2}{3} + \\frac{1}{6}\\epsilon + \\frac{11}{180}\\epsilon^2 + \\mathcal{O}(\\epsilon^3).\n$$\nNow we compute the integral using $2 \\times 2$ Gaussian quadrature. The points are $(\\xi_i, \\eta_j)$ for $\\xi_i, \\eta_j \\in \\{\\pm a\\}$ with $a=1/\\sqrt{3}$, and all weights are $w_i=w_j=1$. A $2\\times2$ rule is exact for polynomials of degree up to $3$ in each variable. The integrands $I_0$ (degree 2) and $I_1$ (degree 3) are polynomials of degree at most $3$. Therefore, the quadrature is exact for the coefficients of $\\epsilon^0$ and $\\epsilon^1$.\n$$\nK_{11}^{(2\\times 2)} = \\int_{-1}^1\\int_{-1}^1 I_0 \\,d\\xi d\\eta + \\epsilon \\int_{-1}^1\\int_{-1}^1 I_1 \\,d\\xi d\\eta + \\epsilon^2 (\\text{GQ}_{2\\times2}[I_2]) + \\mathcal{O}(\\epsilon^3).\n$$\nThe error arises from the quadrature of $I_2$, which is a polynomial of degree $4$. A detailed calculation of the quadrature sum for $I_2$ yields:\n$$\n\\text{GQ}_{2\\times2}[I_2] = \\frac{1}{18}.\n$$\nThe expansion for the quadrature is:\n$$\nK_{11}^{(2\\times 2)} = \\frac{2}{3} + \\frac{1}{6}\\epsilon + \\frac{1}{18}\\epsilon^2 + \\mathcal{O}(\\epsilon^3).\n$$\nThe error is the difference between the quadrature result and the exact result:\n$$\nK_{11}^{(2\\times 2)} - K_{11}^{\\mathrm{exact}} = \\left(\\frac{1}{18} - \\frac{11}{180}\\right)\\epsilon^2 + \\mathcal{O}(\\epsilon^3) = \\left(\\frac{10}{180} - \\frac{11}{180}\\right)\\epsilon^2 + \\mathcal{O}(\\epsilon^3) = -\\frac{1}{180}\\epsilon^2 + \\mathcal{O}(\\epsilon^3).\n$$\nThe coefficient is $C = -1/180$.\n\nFor the $3 \\times 3$ quadrature rule, we analyze its accuracy. A tensor-product $n \\times n$ Gaussian quadrature rule is exact for all polynomials $\\xi^p\\eta^q$ where $p, q \\le 2n-1$. For $n=3$, the rule is exact for polynomial integrands of degree up to $5$ in each variable.\nThe polynomial coefficients of the expansion of the integrand in $\\epsilon$, $I_k(\\xi, \\eta)$, have degree $k+2$.\n- $I_0$ has degree 2.\n- $I_1$ has degree 3.\n- $I_2$ has degree 4.\n- $I_3$ has degree 5.\nThe $3 \\times 3$ quadrature rule will integrate all these polynomials exactly since their degrees ($2, 3, 4, 5$) are all less than or equal to $5$.\nThe error is:\n$$\nK_{11}^{(3\\times 3)} - K_{11}^{\\mathrm{exact}} = \\sum_{k=0}^{\\infty} \\epsilon^k \\left( \\text{GQ}_{3\\times3}[I_k] - \\int I_k \\,d\\xi d\\eta \\right)\n$$\nSince $\\text{GQ}_{3\\times3}[I_k] = \\int I_k \\,d\\xi d\\eta$ for $k=0, 1, 2, 3$, the error terms for $\\epsilon^0, \\epsilon^1, \\epsilon^2, \\epsilon^3$ are all zero. The leading error term arises from $I_4$, which is a polynomial of degree $6$. The error is of order $\\mathcal{O}(\\epsilon^4)$.\nTherefore, the coefficient of the $\\epsilon^2$ term in the error expansion for the $3 \\times 3$ rule is zero.\nThe coefficient $C$ requested pertains only to the $2 \\times 2$ rule.", "answer": "$$\\boxed{-\\frac{1}{180}}$$", "id": "2599455"}, {"introduction": "Beyond simple inaccuracy, numerical integration can sometimes fail to detect catastrophic flaws in an element's geometry. This exercise presents a critical thought experiment involving an element with an \"inverted\" region, where the Jacobian determinant $\\det J$ is negative. You will geometrically identify this invalid region and, more importantly, demonstrate why a standard low-order Gauss quadrature rule can completely miss this fatal defect, a powerful lesson on the limitations of numerical methods and the necessity of element quality checks [@problem_id:2599488].", "problem": "Consider a trilinear isoparametric hexahedral element used in the Finite Element Method (FEM), defined on the parent domain $\\hat{\\Omega}=[-1,1]^{3}$ with parent coordinates $(\\xi,\\eta,\\zeta)$. Suppose the geometry mapping from $\\hat{\\Omega}$ to the physical element is such that the Jacobian determinant is\n$$\n\\det J(\\xi,\\eta,\\zeta)=1-\\frac{1}{2}\\left(\\xi+\\eta+\\zeta\\right).\n$$\nThis situation models a distorted element with an inverted physical corner near the parent-space corner $(\\xi,\\eta,\\zeta)=(1,1,1)$, where the mapping locally folds. The stiffness matrix and load vector of the element are to be evaluated by Gauss–Legendre tensor-product quadrature.\n\nUsing only the core definitions of isoparametric mapping, the meaning of the Jacobian determinant in change of variables for integration, and the basic properties of Gauss–Legendre quadrature, do the following:\n\n1) Determine the locus in $\\hat{\\Omega}$ where $\\det J(\\xi,\\eta,\\zeta)$ changes sign, and identify geometrically the region where $\\det J(\\xi,\\eta,\\zeta)0$.\n\n2) Compute exactly the fraction of the parent-domain volume $|\\hat{\\Omega}|$ for which $\\det J(\\xi,\\eta,\\zeta)0$. Express your final answer as a reduced fraction.\n\n3) Explain, by evaluating $\\det J$ at the tensor-product Gauss points for the $2\\times 2\\times 2$ rule, why standard quadrature may fail to detect the inversion when assembling stiffness and load integrals.\n\nYour final reported answer must be only the result of Task $2$ as a single reduced fraction (dimensionless). No rounding is required.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Element type: Trilinear isoparametric hexahedral element.\n- Parent domain: $\\hat{\\Omega}=[-1,1]^{3}$.\n- Parent coordinates: $(\\xi,\\eta,\\zeta)$.\n- Jacobian determinant: $\\det J(\\xi,\\eta,\\zeta)=1-\\frac{1}{2}\\left(\\xi+\\eta+\\zeta\\right)$.\n- Task 1: Determine the locus where $\\det J(\\xi,\\eta,\\zeta)$ changes sign and identify the region where $\\det J(\\xi,\\eta,\\zeta)0$.\n- Task 2: Compute the fraction of the parent-domain volume $|\\hat{\\Omega}|$ where $\\det J(\\xi,\\eta,\\zeta)0$.\n- Task 3: Explain why $2\\times 2\\times 2$ Gauss–Legendre quadrature may fail to detect the inversion.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on fundamental concepts of the Finite Element Method (FEM), specifically isoparametric mapping, the role of the Jacobian determinant in integration, element inversion ($\\det J  0$), and numerical quadrature. These are standard topics in computational mechanics and applied mathematics.\n- **Well-Posed:** The problem is clearly stated with all necessary information. The function for the Jacobian determinant is given, the domain is specified, and the tasks are unambiguous mathematical exercises that lead to a unique, stable, and meaningful solution.\n- **Objective:** The language is formal and precise, free of subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a well-posed, scientifically grounded problem in the field of FEM. A solution will be provided.\n\nThe problem investigates the properties of a distorted element characterized by a given Jacobian determinant, $\\det J$, within the parent domain $\\hat{\\Omega} = [-1,1]^{3}$.\n\n**1) Locus of Sign Change and Region of Inversion**\n\nThe sign of the Jacobian determinant, $\\det J(\\xi,\\eta,\\zeta)$, indicates whether the mapping from parent to physical coordinates preserves or reverses local orientation. A negative determinant signifies an \"inverted\" or \"folded\" element, which is physically nonsensical and computationally problematic.\n\nThe locus where $\\det J$ changes sign is the set of points where the determinant is zero. We set the given expression to zero:\n$$\n\\det J(\\xi,\\eta,\\zeta) = 1-\\frac{1}{2}\\left(\\xi+\\eta+\\zeta\\right) = 0\n$$\nSolving for the sum of coordinates gives:\n$$\n\\xi+\\eta+\\zeta = 2\n$$\nThis equation defines a plane in the $(\\xi,\\eta,\\zeta)$ coordinate space. This plane is the locus where the mapping is singular.\n\nThe region where the element is inverted is where $\\det J(\\xi,\\eta,\\zeta)  0$. This corresponds to the inequality:\n$$\n1-\\frac{1}{2}\\left(\\xi+\\eta+\\zeta\\right)  0\n$$\nwhich simplifies to:\n$$\n\\xi+\\eta+\\zeta  2\n$$\nGeometrically, this inequality describes the half-space on the side of the plane $\\xi+\\eta+\\zeta = 2$ that does not contain the origin. We are interested in the portion of this half-space that lies within the parent domain cube $\\hat{\\Omega} = [-1,1]^{3}$. The plane $\\xi+\\eta+\\zeta = 2$ intersects the edges of the cube that meet at the corner $(1,1,1)$. The region of inversion, which we denote $V_{\\text{neg}}$, is a small tetrahedron cut from this corner, bounded by the planes $\\xi=1$, $\\eta=1$, $\\zeta=1$ from the cube boundary, and the plane $\\xi+\\eta+\\zeta = 2$.\n\n**2) Fraction of Inverted Volume**\n\nThe total volume of the parent domain, $|\\hat{\\Omega}|$, is the volume of a cube with side length $1 - (-1) = 2$. Thus:\n$$\n|\\hat{\\Omega}| = 2^{3} = 8\n$$\nTo find the volume of the inverted region, $|V_{\\text{neg}}|$, we must calculate the volume of the tetrahedron identified in part $1$. The vertices of this tetrahedron are the corner of the cube $(1,1,1)$ and the points where the plane $\\xi+\\eta+\\zeta=2$ intersects the cube edges connected to this corner.\n- Intersection with edge $(\\xi,1,1)$: $\\xi+1+1=2 \\implies \\xi=0$. Point: $(0,1,1)$.\n- Intersection with edge $(1,\\eta,1)$: $1+\\eta+1=2 \\implies \\eta=0$. Point: $(1,0,1)$.\n- Intersection with edge $(1,1,\\zeta)$: $1+1+\\zeta=2 \\implies \\zeta=0$. Point: $(1,1,0)$.\nSo, the four vertices of the tetrahedron are $A=(1,1,1)$, $B=(0,1,1)$, $C=(1,0,1)$, and $D=(1,1,0)$.\n\nThe volume of a tetrahedron with vertices $A$, $B$, $C$, $D$ is given by $|V| = \\frac{1}{6} |\\det(\\vec{AB}, \\vec{AC}, \\vec{AD})|$. We compute the vectors originating from vertex $A$:\n$$\n\\vec{AB} = (0-1, 1-1, 1-1) = (-1, 0, 0)\n$$\n$$\n\\vec{AC} = (1-1, 0-1, 1-1) = (0, -1, 0)\n$$\n$$\n\\vec{AD} = (1-1, 1-1, 0-1) = (0, 0, -1)\n$$\nThe volume is:\n$$\n|V_{\\text{neg}}| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  -1 \\end{pmatrix} \\right| = \\frac{1}{6} |(-1)(-1)(-1)| = \\frac{1}{6} |-1| = \\frac{1}{6}\n$$\nThe fraction of the parent-domain volume for which $\\det J(\\xi,\\eta,\\zeta)0$ is:\n$$\n\\frac{|V_{\\text{neg}}|}{|\\hat{\\Omega}|} = \\frac{1/6}{8} = \\frac{1}{48}\n$$\n\n**3) Failure of $2\\times 2\\times 2$ Gauss Quadrature**\n\nThe standard $2\\times 2\\times 2$ Gauss-Legendre quadrature rule for the domain $[-1,1]^{3}$ uses $8$ integration points (Gauss points). These points are the tensor product of the $1D$ $2$-point Gauss rule, whose points are at $\\pm\\frac{1}{\\sqrt{3}}$. Thus, the coordinates of the $8$ points are $(\\xi_i, \\eta_j, \\zeta_k)$ where $\\xi_i, \\eta_j, \\zeta_k \\in \\{-\\frac{1}{\\sqrt{3}}, +\\frac{1}{\\sqrt{3}}\\}$.\n\nNumerical integration methods, such as Gauss quadrature, approximate an integral by a weighted sum of the integrand's values at these discrete points. For element stiffness and load vector assembly, the integrand includes a factor of $\\det J$. The method will fail to detect element inversion if $\\det J$ is positive at all Gauss points, even if it is negative elsewhere in the domain.\n\nLet's evaluate $\\det J$ at these points. This requires evaluating the sum $S = \\xi+\\eta+\\zeta$. The maximum value of this sum occurs when all coordinates are positive:\n$$\nS_{\\text{max}} = \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{3}{\\sqrt{3}} = \\sqrt{3}\n$$\nThe condition for element inversion is $\\xi+\\eta+\\zeta > 2$.\nHowever, the maximum sum at any Gauss point is $\\sqrt{3} \\approx 1.732$. Since $\\sqrt{3}  2$, we have:\n$$\n(\\xi+\\eta+\\zeta)_{\\text{Gauss pt}} \\le \\sqrt{3}  2\n$$\nThis proves that none of the $2\\times 2\\times 2$ Gauss points fall within the region of inversion $V_{\\text{neg}}$. At every Gauss point, the sum $\\xi+\\eta+\\zeta$ is less than $2$, which means the value of $\\det J = 1 - \\frac{1}{2}(\\xi+\\eta+\\zeta)$ will be positive at all sample points.\nSpecifically, the minimum value of $\\det J$ at a Gauss point is at $S_{\\text{max}}=\\sqrt{3}$:\n$$\n\\det J_{\\text{min at a Gauss pt}} = 1 - \\frac{\\sqrt{3}}{2} \\approx 1 - 0.866 = 0.134  0\n$$\nBecause the quadrature scheme only samples the integrand where $\\det J  0$, it fails entirely to detect the existence of the inverted region. The numerical calculation will proceed as if the element geometry were valid everywhere, leading to a physically and mathematically incorrect stiffness matrix and load vector.", "answer": "$$ \\boxed{\\frac{1}{48}} $$", "id": "2599488"}]}