{"hands_on_practices": [{"introduction": "This first practice is a fundamental exercise that walks you through the entire finite element procedure from first principles. By manually deriving the element stiffness matrix and consistent load vector from the principle of virtual work, you will build the global system of equations for a simple axial bar. This hands-on calculation solidifies the core concepts of assembly and boundary condition enforcement, providing a crucial look \"under the hood\" of a finite element solver [@problem_id:2562929].", "problem": "A prismatic bar is aligned along the $x$-axis, occupying the interval $x \\in [0, L]$ with $L = 2\\,\\mathrm{m}$. The bar has constant cross-sectional area $A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$ and Young’s modulus $E = 200\\,\\mathrm{GPa}$. The bar is subjected to a uniform distributed axial load (body force per unit length) $q(x) = q_{0}$ acting in the positive $x$-direction with $q_{0} = 1000\\,\\mathrm{N/m}$, and an additional end traction $t_{L} = 500\\,\\mathrm{N}$ applied at $x=L$ in the positive $x$-direction. The displacement at the left end is fixed, $u(0) = 0$.\n\nUsing the Finite Element Method (FEM) with the principle of virtual work and small-strain linear elasticity as the only starting points, discretize the bar into two equal two-node linear elements. For each element:\n- derive the element stiffness matrix and the consistent element load vector due to the distributed load $q_{0}$,\n- assemble the global stiffness matrix and the global force vector (including the end traction contribution),\n- enforce the essential boundary condition and solve for the nodal displacements.\n\nFinally, compute the displacement at the right end $u(L)$. Round your answer to four significant figures and express it in $\\mathrm{mm}$. Your final answer must be a single real number.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Domain: A prismatic bar along the $x$-axis, $x \\in [0, L]$.\n- Length: $L = 2\\,\\mathrm{m}$.\n- Cross-sectional area: $A = 1.0 \\times 10^{-4}\\,\\mathrm{m}^{2}$.\n- Young’s modulus: $E = 200\\,\\mathrm{GPa} = 200 \\times 10^{9}\\,\\mathrm{N/m^2}$.\n- Distributed axial load: $q(x) = q_{0} = 1000\\,\\mathrm{N/m}$.\n- End traction: $t_{L} = 500\\,\\mathrm{N}$ at $x=L$.\n- Boundary condition: $u(0) = 0$.\n- Discretization: Two equal two-node linear elements.\n- Required method: Principle of virtual work.\n- Required outputs: Element stiffness matrix, consistent element load vector, global assembled system, nodal displacements, and final value for $u(L)$ in $\\mathrm{mm}$ rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is a standard application of one-dimensional linear elasticity and the Finite Element Method, based on the well-established principle of virtual work. All physical quantities and material properties are standard. The problem is scientifically sound.\n- **Well-Posed:** The problem is a well-posed boundary value problem for a second-order ordinary differential equation. The combination of an essential boundary condition ($u(0)=0$) and natural boundary conditions (loads) ensures a unique solution exists.\n- **Objective:** The problem is stated using precise, quantitative, and unambiguous language.\n- **Completeness and Consistency:** All necessary parameters ($L, A, E, q_{0}, t_{L}$) and boundary conditions are provided to find a unique solution. The data is self-consistent and dimensionally correct. No contradictions are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. A solution will be provided.\n\nThe principle of virtual work for a one-dimensional elastic bar is given by:\n$$\n\\int_{0}^{L} \\delta\\epsilon(x) \\sigma(x) A \\, dx = \\int_{0}^{L} \\delta u(x) q(x) \\, dx + \\sum_{i} \\delta u(x_i) F_i\n$$\nwhere $\\delta u$ is the virtual displacement, $\\delta\\epsilon = \\frac{d(\\delta u)}{dx}$ is the virtual strain, and $\\sigma$ is the stress. The point forces $F_i$ here include the end traction $t_L$ at $x=L$. Using the constitutive relation for linear elasticity, $\\sigma(x) = E \\epsilon(x) = E \\frac{du}{dx}$, the weak form is:\n$$\n\\int_{0}^{L} E A \\frac{d(\\delta u)}{dx} \\frac{du}{dx} \\, dx = \\int_{0}^{L} \\delta u(x) q_0 \\, dx + \\delta u(L) t_{L}\n$$\nThe bar is discretized into two equal-length elements. The length of each element is $l_e = L/2 = 2/2 = 1\\,\\mathrm{m}$. There are three nodes: Node $1$ at $x=0$, Node $2$ at $x=1$, and Node $3$ at $x=2$.\n\nFor a generic two-node linear element spanning from local coordinate $\\xi=0$ to $\\xi=l_e$, the displacement field $u^{(e)}(\\xi)$ is interpolated from the nodal displacements $\\mathbf{d}^{(e)} = [u_i, u_j]^T$:\n$$\nu^{(e)}(\\xi) = N_1(\\xi) u_i + N_2(\\xi) u_j = \\mathbf{N}(\\xi) \\mathbf{d}^{(e)}\n$$\nThe linear shape functions are $N_1(\\xi) = 1 - \\frac{\\xi}{l_e}$ and $N_2(\\xi) = \\frac{\\xi}{l_e}$.\nThe strain is $\\epsilon^{(e)}(\\xi) = \\frac{du^{(e)}}{d\\xi} = [-\\frac{1}{l_e}, \\frac{1}{l_e}] \\mathbf{d}^{(e)} = \\mathbf{B} \\mathbf{d}^{(e)}$.\n\nThe element stiffness matrix $\\mathbf{k}^{(e)}$ is derived from the internal virtual work:\n$$\n\\mathbf{k}^{(e)} = \\int_{0}^{l_e} \\mathbf{B}^T (EA) \\mathbf{B} \\, d\\xi\n$$\nSince $\\mathbf{B}$, $E$, and $A$ are constant over the element:\n$$\n\\mathbf{k}^{(e)} = EA l_e \\mathbf{B}^T \\mathbf{B} = E A l_e \\begin{bmatrix} -1/l_e \\\\ 1/l_e \\end{bmatrix} [ -1/l_e, 1/l_e ] = \\frac{EA}{l_e} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\nThe consistent element load vector $\\mathbf{f}_q^{(e)}$ due to the distributed load $q_0$ is derived from the external virtual work:\n$$\n\\mathbf{f}_q^{(e)} = \\int_{0}^{l_e} \\mathbf{N}^T q_0 \\, d\\xi = q_0 \\int_{0}^{l_e} \\begin{bmatrix} 1 - \\xi/l_e \\\\ \\xi/l_e \\end{bmatrix} d\\xi = q_0 \\begin{bmatrix} l_e/2 \\\\ l_e/2 \\end{bmatrix} = \\frac{q_0 l_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\nFor this problem, $E = 200 \\times 10^9\\,\\mathrm{N/m^2}$, $A = 1.0 \\times 10^{-4}\\,\\mathrm{m^2}$, $l_e=1\\,\\mathrm{m}$, and $q_0 = 1000\\,\\mathrm{N/m}$.\nThe axial rigidity is $EA = (200 \\times 10^9) \\times (1.0 \\times 10^{-4}) = 2 \\times 10^7\\,\\mathrm{N}$.\nFor both elements ($e=1, 2$), the stiffness matrix is:\n$$\n\\mathbf{k}^{(1)} = \\mathbf{k}^{(2)} = \\frac{2 \\times 10^7}{1} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} = 2 \\times 10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} \\,\\mathrm{N/m}\n$$\nThe consistent load vector for each element is:\n$$\n\\mathbf{f}_q^{(1)} = \\mathbf{f}_q^{(2)} = \\frac{1000 \\times 1}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\nNow, we assemble the $3 \\times 3$ global stiffness matrix $\\mathbf{K}$ and the $3 \\times 1$ global force vector $\\mathbf{F}$.\nElement $1$ connects nodes $1$ and $2$. Element $2$ connects nodes $2$ and $3$.\n$$\n\\mathbf{K} = \\frac{EA}{l_e} \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} = 2 \\times 10^7 \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} \\,\\mathrm{N/m}\n$$\nThe global force vector $\\mathbf{F}$ is the sum of contributions from the distributed load $\\mathbf{F}_q$ and the point load $\\mathbf{F}_t$.\n$$\n\\mathbf{F}_q = \\begin{bmatrix} (\\mathbf{f}_q^{(1)})_1 \\\\ (\\mathbf{f}_q^{(1)})_2 + (\\mathbf{f}_q^{(2)})_1 \\\\ (\\mathbf{f}_q^{(2)})_2 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500+500 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\nThe end traction $t_L = 500\\,\\mathrm{N}$ is a point load at Node $3$.\n$$\n\\mathbf{F}_t = \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} \\,\\mathrm{N}\n$$\nThe total global force vector is:\n$$\n\\mathbf{F} = \\mathbf{F}_q + \\mathbf{F}_t = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 500 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 1000 \\end{bmatrix} \\,\\mathrm{N}\n$$\nThe global system of equations is $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$, where $\\mathbf{U}=[U_1, U_2, U_3]^T$:\n$$\n2 \\times 10^7 \\begin{bmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{bmatrix} \\begin{bmatrix} U_1 \\\\ U_2 \\\\ U_3 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 1000 \\end{bmatrix}\n$$\nWe apply the essential boundary condition $u(0)=0$, which means $U_1=0$. We partition the matrix by removing the first row and first column corresponding to the fixed degree of freedom. The system for the unknown displacements $U_2$ and $U_3$ becomes:\n$$\n2 \\times 10^7 \\begin{bmatrix} 2 & -1 \\\\ -1 & 1 \\end{bmatrix} \\begin{bmatrix} U_2 \\\\ U_3 \\end{bmatrix} = \\begin{bmatrix} 1000 \\\\ 1000 \\end{bmatrix}\n$$\nThis is equivalent to the system of equations:\n$$\n\\begin{cases}\n2U_2 - U_3 = \\frac{1000}{2 \\times 10^7} = 0.5 \\times 10^{-4} \\\\\n-U_2 + U_3 = \\frac{1000}{2 \\times 10^7} = 0.5 \\times 10^{-4}\n\\end{cases}\n$$\nAdding the two equations yields:\n$$\n(2U_2 - U_3) + (-U_2 + U_3) = 0.5 \\times 10^{-4} + 0.5 \\times 10^{-4}\n$$\n$$\nU_2 = 1.0 \\times 10^{-4}\\,\\mathrm{m}\n$$\nSubstituting $U_2$ into the second equation:\n$$\n-(1.0 \\times 10^{-4}) + U_3 = 0.5 \\times 10^{-4}\n$$\n$$\nU_3 = (1.0 \\times 10^{-4}) + (0.5 \\times 10^{-4}) = 1.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\nThe displacement at the right end is $u(L) = U_3$.\n$$\nu(L) = 1.5 \\times 10^{-4}\\,\\mathrm{m}\n$$\nConverting to millimeters:\n$$\nu(L) = 1.5 \\times 10^{-4} \\times 1000\\,\\mathrm{mm} = 0.15\\,\\mathrm{mm}\n$$\nRounding to four significant figures as required:\n$$\nu(L) = 0.1500\\,\\mathrm{mm}\n$$", "answer": "$$\n\\boxed{0.1500}\n$$", "id": "2562929"}, {"introduction": "Building on the fundamentals, this exercise introduces greater realism by incorporating non-uniform material properties and a linearly varying distributed load. The primary goal is not only to solve for displacements but also to compute the reaction force at the support and perform a global equilibrium check. This practice is essential for developing validation skills, ensuring your finite element solution is physically consistent and trustworthy [@problem_id:2538126].", "problem": "Consider a straight, slender bar aligned with the $x$-axis occupying $x \\in [0,L]$ under small-strain, linear-elastic, quasi-static, one-dimensional axial deformation. The bar has Young’s modulus $E$ constant along its length and a piecewise-constant cross-sectional area $A(x)$. It is subjected to an axial body force per unit volume $b(x)$ and a prescribed axial point force at the free end. The left end at $x=0$ is fixed (an essential Dirichlet boundary condition), and the right end at $x=L$ is traction-loaded (a Neumann boundary condition). Adopt the sign convention that forces in the $+x$ direction are positive, and the displacement $u(x)$ is measured in the $+x$ direction.\n\nDiscretize the bar into two equal two-noded linear bar elements (one-dimensional linear finite elements), and assemble the global system using the Finite Element Method (FEM) starting from the principle of virtual work and the definition of linear shape functions. Do not invoke any pre-packaged “shortcut” formulas; instead, derive element stiffness matrices and consistent element load vectors by evaluating the necessary integrals.\n\nThe bar data are:\n- Length: $L = 2\\,\\mathrm{m}$, with nodes at $x_1 = 0\\,\\mathrm{m}$, $x_2 = 1\\,\\mathrm{m}$, and $x_3 = 2\\,\\mathrm{m}$.\n- Young’s modulus: $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$.\n- Cross-sectional area: $A(x) = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$ for $x \\in [0,1]$ and $A(x) = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$ for $x \\in [1,2]$.\n- Body force per unit volume: $b(x) = b_0 + b_1 x$ with $b_0 = 2.0 \\times 10^{7}\\,\\mathrm{N/m}^3$ and $b_1 = 1.0 \\times 10^{7}\\,\\mathrm{N/m}^4$.\n- Applied axial point force at $x=L$: $\\bar{T} = 1.50 \\times 10^{4}\\,\\mathrm{N}$ in the $+x$ direction.\n- Essential boundary condition: $u(0) = 0$.\n\nTasks:\n1. Starting from the principle of virtual work for one-dimensional axial deformation, derive the element stiffness matrix and the consistent element load vector due to the body force for a generic two-noded linear bar element of length $\\ell$ with constant $E$ and $A$ over the element, and $b(x)$ as given above restricted to the element domain.\n2. Assemble the global stiffness matrix and the global load vector for the two-element mesh described, including the contribution of the right-end point force at $x=L$.\n3. Impose the essential boundary condition at $x=0$ to solve for the unknown nodal displacements.\n4. Using the assembled global operators and the solved displacement vector, compute the reaction force at the constrained node $x=0$ from the discrete equilibrium statement at that node. Then verify the global equilibrium of the entire bar by checking that the algebraic sum of the reaction at $x=0$, the resultant of the body force $\\int_0^L A(x)\\,b(x)\\,dx$, and the applied end force $\\bar{T}$ equals zero under the adopted sign convention.\n\nProvide as your final answer the reaction force at $x=0$ expressed in kiloNewtons (kN), rounded to four significant figures. Report only the number in kN (do not include units in your final boxed answer).", "solution": "The problem statement is subjected to validation before any solution is attempted.\n\nSTEP 1: EXTRACT GIVENS\n- **Domain**: A straight bar of length $L=2\\,\\mathrm{m}$ on the interval $x \\in [0,L]$.\n- **Discretization**: Two equal two-noded linear bar elements. Nodes are at $x_1=0\\,\\mathrm{m}$, $x_2=1\\,\\mathrm{m}$, and $x_3=2\\,\\mathrm{m}$. Element $1$ spans $[0,1]$ and Element $2$ spans $[1,2]$. The length of each element is $\\ell_e = 1\\,\\mathrm{m}$.\n- **Material Property**: Young's modulus is constant, $E = 2.10 \\times 10^{11}\\,\\mathrm{Pa}$.\n- **Geometric Property**: Cross-sectional area is piecewise-constant: $A(x) = A_1 = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$ for $x \\in [0,1]$ and $A(x) = A_2 = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$ for $x \\in [1,2]$.\n- **Loading**:\n    - Axial body force per unit volume: $b(x) = b_0 + b_1 x$, with $b_0 = 2.0 \\times 10^{7}\\,\\mathrm{N/m}^3$ and $b_1 = 1.0 \\times 10^{7}\\,\\mathrm{N/m}^4$.\n    - Axial point force at $x=L$: $\\bar{T} = 1.50 \\times 10^{4}\\,\\mathrm{N}$.\n- **Boundary Conditions**:\n    - Essential (Dirichlet) boundary condition at $x=0$: $u(0) = 0$.\n    - Natural (Neumann) boundary condition at $x=L$: traction load, captured by $\\bar{T}$.\n- **Sign Convention**: Displacement $u(x)$ and forces are positive in the $+x$ direction.\n\nSTEP 2: VALIDATE USING EXTRACTED GIVENS\nThe problem is scientifically grounded, being a standard application of the Finite Element Method to a one-dimensional problem in linear elastostatics. It is well-posed, with sufficient data and a boundary condition that prevents rigid body motion, ensuring a unique solution. The language is objective and precise. The data are dimensionally consistent and physically plausible for a steel bar under significant load. The problem requires detailed derivation and calculation, making it non-trivial. It does not violate any of the invalidity criteria.\n\nSTEP 3: VERDICT AND ACTION\nThe problem is valid. A complete solution will be provided.\n\nThe Finite Element Method formulation starts from the Principle of Virtual Work (PVW) for a one-dimensional elastic body:\n$$ \\int_{0}^{L} \\delta\\epsilon \\sigma A \\,dx = \\int_{0}^{L} \\delta u \\, b A \\,dx + \\sum_i \\delta u_i P_i $$\nwhere $\\sigma$ is the axial stress, $\\epsilon$ is the axial strain, $u$ is the axial displacement, $b$ is the body force per unit volume, $A$ is the cross-sectional area, and $P_i$ are point loads. For linear elasticity, $\\sigma = E\\epsilon$. The strain is $\\epsilon = du/dx$.\n\nA two-noded linear element is defined over a local domain $x' \\in [0, \\ell_e]$. The displacement field $u(x')$ within the element is interpolated from nodal displacements $d_1^e, d_2^e$ using linear shape functions $N_1(x')$ and $N_2(x')$:\n$$ u(x') = N_1(x')d_1^e + N_2(x')d_2^e = \\mathbf{N}(x')\\mathbf{d}^e $$\nwhere $N_1(x') = 1 - x'/\\ell_e$ and $N_2(x') = x'/\\ell_e$. The strain is given by:\n$$ \\epsilon(x') = \\frac{du}{dx'} = \\frac{d\\mathbf{N}}{dx'}\\mathbf{d}^e = \\mathbf{B}\\mathbf{d}^e = \\begin{bmatrix} -\\frac{1}{\\ell_e} & \\frac{1}{\\ell_e} \\end{bmatrix} \\mathbf{d}^e $$\nThe virtual quantities are $\\delta u = \\mathbf{N}\\delta\\mathbf{d}^e$ and $\\delta\\epsilon = \\mathbf{B}\\delta\\mathbf{d}^e$.\n\n**Task 1: Derive Element Stiffness and Load Vectors**\n\nThe element stiffness matrix $\\mathbf{k}^e$ is derived from the internal virtual work term:\n$$ \\delta\\mathbf{d}^{eT} \\mathbf{k}^e \\mathbf{d}^e = \\int_{0}^{\\ell_e} \\delta\\epsilon^T E \\epsilon A \\,dx' = \\int_{0}^{\\ell_e} (\\delta\\mathbf{d}^{eT}\\mathbf{B}^T) E (\\mathbf{B}\\mathbf{d}^e) A \\,dx' $$\nAs $\\delta\\mathbf{d}^e$ is arbitrary, we have:\n$$ \\mathbf{k}^e = \\int_{0}^{\\ell_e} \\mathbf{B}^T E A \\mathbf{B} \\,dx' $$\nFor an element with constant $E$ and $A$:\n$$ \\mathbf{k}^e = EA \\int_{0}^{\\ell_e} \\begin{bmatrix} -1/\\ell_e \\\\ 1/\\ell_e \\end{bmatrix} \\begin{bmatrix} -1/\\ell_e & 1/\\ell_e \\end{bmatrix} \\,dx' = EA \\int_{0}^{\\ell_e} \\frac{1}{\\ell_e^2}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\,dx' = \\frac{EA}{\\ell_e}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nThe consistent element load vector from body force, $\\mathbf{f}_b^e$, is derived from the external virtual work of the body force:\n$$ \\delta\\mathbf{d}^{eT} \\mathbf{f}_b^e = \\int_{0}^{\\ell_e} \\delta u \\, b A \\,dx' = \\int_{0}^{\\ell_e} (\\delta\\mathbf{d}^{eT}\\mathbf{N}^T) b(x') A \\,dx' $$\n$$ \\mathbf{f}_b^e = \\int_{0}^{\\ell_e} A \\mathbf{N}^T b(x') \\,dx' $$\nThe body force $b(x)$ is defined in global coordinates. Let an element start at global coordinate $x_{start}$. The global coordinate is $x = x_{start} + x'$. So, $b(x') = b_0 + b_1(x_{start} + x')$.\n$$ \\mathbf{f}_b^e = A \\int_0^{\\ell_e} \\begin{pmatrix} 1 - x'/\\ell_e \\\\ x'/\\ell_e \\end{pmatrix} (b_0 + b_1 x_{start} + b_1 x') \\,dx' $$\nEvaluating the integral for the first component:\n$$ f_{b,1}^e = A \\int_0^{\\ell_e} \\left( b_0+b_1 x_{start} + b_1 x' - \\frac{x'}{\\ell_e}(b_0+b_1 x_{start}) - \\frac{b_1 (x')^2}{\\ell_e} \\right) dx' \\\\ = A \\left[ (b_0+b_1 x_{start})x' + \\frac{b_1 (x')^2}{2} - \\frac{(x')^2}{2\\ell_e}(b_0+b_1 x_{start}) - \\frac{b_1 (x')^3}{3\\ell_e} \\right]_0^{\\ell_e} \\\\ = A\\ell_e \\left[ (b_0+b_1 x_{start}) + \\frac{b_1\\ell_e}{2} - \\frac{1}{2}(b_0+b_1 x_{start}) - \\frac{b_1\\ell_e}{3} \\right] \\\\ = A\\ell_e \\left[ \\frac{1}{2}(b_0+b_1 x_{start}) + \\frac{1}{6}b_1\\ell_e \\right] $$\nEvaluating the second component:\n$$ f_{b,2}^e = A \\int_0^{\\ell_e} \\left( \\frac{x'}{\\ell_e}(b_0+b_1 x_{start}) + \\frac{b_1 (x')^2}{\\ell_e} \\right) dx' \\\\ = A \\left[ \\frac{(x')^2}{2\\ell_e}(b_0+b_1 x_{start}) + \\frac{b_1 (x')^3}{3\\ell_e} \\right]_0^{\\ell_e} \\\\ = A\\ell_e \\left[ \\frac{1}{2}(b_0+b_1 x_{start}) + \\frac{1}{3}b_1\\ell_e \\right] $$\n\n**Task 2: Assemble Global System**\n\nThe bar has $2$ elements and $3$ nodes. Let's calculate the matrices for each element. The element length is $\\ell_e = 1\\,\\mathrm{m}$ for both.\n\n*Element 1 (Nodes 1-2):* $x \\in [0,1]$, so $x_{start}^{(1)}=0$. $A_1 = 2.0 \\times 10^{-4}\\,\\mathrm{m}^2$.\n$$ \\frac{EA_1}{\\ell_1} = \\frac{(2.10 \\times 10^{11}\\,\\mathrm{Pa})(2.0 \\times 10^{-4}\\,\\mathrm{m}^2)}{1\\,\\mathrm{m}} = 4.2 \\times 10^7\\,\\mathrm{N/m} $$\n$$ \\mathbf{k}^{(1)} = 4.2 \\times 10^7 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nFor the load vector, with $b_0=2\\times 10^7, b_1=1\\times 10^7$:\n$$ f_{b,1}^{(1)} = (2.0 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7) + \\frac{1}{6}(1\\times 10^7)(1) \\right] = 2\\times 10^{-4} \\left[ \\frac{7}{6}\\times 10^7 \\right] = \\frac{7000}{3}\\,\\mathrm{N} $$\n$$ f_{b,2}^{(1)} = (2.0 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7) + \\frac{1}{3}(1\\times 10^7)(1) \\right] = 2\\times 10^{-4} \\left[ \\frac{4}{3}\\times 10^7 \\right] = \\frac{8000}{3}\\,\\mathrm{N} $$\n\n*Element 2 (Nodes 2-3):* $x \\in [1,2]$, so $x_{start}^{(2)}=1$. $A_2 = 1.2 \\times 10^{-4}\\,\\mathrm{m}^2$.\n$$ \\frac{EA_2}{\\ell_2} = \\frac{(2.10 \\times 10^{11}\\,\\mathrm{Pa})(1.2 \\times 10^{-4}\\,\\mathrm{m}^2)}{1\\,\\mathrm{m}} = 2.52 \\times 10^7\\,\\mathrm{N/m} $$\n$$ \\mathbf{k}^{(2)} = 2.52 \\times 10^7 \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\nFor the load vector:\n$$ f_{b,1}^{(2)} = (1.2 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7 + 1\\times 10^7(1)) + \\frac{1}{6}(1\\times 10^7)(1) \\right] \\\\ = 1.2 \\times 10^{-4} \\left[ \\frac{3}{2}\\times 10^7 + \\frac{1}{6}\\times 10^7 \\right] = 1.2 \\times 10^{-4} \\left[ \\frac{10}{6}\\times 10^7 \\right] = 2000\\,\\mathrm{N} $$\n$$ f_{b,2}^{(2)} = (1.2 \\times 10^{-4})(1) \\left[ \\frac{1}{2}(2\\times 10^7 + 1\\times 10^7(1)) + \\frac{1}{3}(1\\times 10^7)(1) \\right] \\\\ = 1.2 \\times 10^{-4} \\left[ \\frac{3}{2}\\times 10^7 + \\frac{1}{3}\\times 10^7 \\right] = 1.2 \\times 10^{-4} \\left[ \\frac{11}{6}\\times 10^7 \\right] = 2200\\,\\mathrm{N} $$\nThe global stiffness matrix $\\mathbf{K}$ is assembled as:\n$$ \\mathbf{K} = \\begin{pmatrix} k_{11}^{(1)} & k_{12}^{(1)} & 0 \\\\ k_{21}^{(1)} & k_{22}^{(1)} + k_{11}^{(2)} & k_{12}^{(2)} \\\\ 0 & k_{21}^{(2)} & k_{22}^{(2)} \\end{pmatrix} = 10^7 \\begin{pmatrix} 4.2 & -4.2 & 0 \\\\ -4.2 & 4.2 + 2.52 & -2.52 \\\\ 0 & -2.52 & 2.52 \\end{pmatrix} \\\\ = 10^7 \\begin{pmatrix} 4.2 & -4.2 & 0 \\\\ -4.2 & 6.72 & -2.52 \\\\ 0 & -2.52 & 2.52 \\end{pmatrix} $$\nThe global load vector $\\mathbf{F}$ is the sum of the assembled body force vector $\\mathbf{F}_b$ and the point load vector $\\mathbf{F}_p$.\n$$ \\mathbf{F}_b = \\begin{pmatrix} f_{b,1}^{(1)} \\\\ f_{b,2}^{(1)} + f_{b,1}^{(2)} \\\\ f_{b,2}^{(2)} \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 8000/3 + 2000 \\\\ 2200 \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 2200 \\end{pmatrix}\\,\\mathrm{N} $$\n$$ \\mathbf{F}_p = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\bar{T} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 15000 \\end{pmatrix}\\,\\mathrm{N} $$\n$$ \\mathbf{F} = \\mathbf{F}_b + \\mathbf{F}_p = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 2200 + 15000 \\end{pmatrix} = \\begin{pmatrix} 7000/3 \\\\ 14000/3 \\\\ 17200 \\end{pmatrix}\\,\\mathrm{N} $$\n\n**Task 3: Solve for Nodal Displacements**\n\nThe global system of equations is $\\mathbf{K}\\mathbf{U} = \\mathbf{F}$. The essential boundary condition is $u_1 = 0$. We partition the system to solve for the unknown displacements $u_2$ and $u_3$.\n$$ 10^7 \\begin{pmatrix} 6.72 & -2.52 \\\\ -2.52 & 2.52 \\end{pmatrix} \\begin{pmatrix} u_2 \\\\ u_3 \\end{pmatrix} = \\begin{pmatrix} 14000/3 \\\\ 17200 \\end{pmatrix} $$\nAdding the two equations yields a simple equation for $u_2$:\n$$ 10^7 (6.72 - 2.52) u_2 = \\frac{14000}{3} + 17200 \\\\ 4.2 \\times 10^7 u_2 = \\frac{14000 + 51600}{3} = \\frac{65600}{3} \\\\ u_2 = \\frac{65600}{3 \\times 4.2 \\times 10^7} = \\frac{65600}{12.6 \\times 10^7} \\approx 5.206349 \\times 10^{-4}\\,\\mathrm{m} $$\nFrom the second equation of the reduced system, we find $u_3$:\n$$ 10^7 (-2.52 u_2 + 2.52 u_3) = 17200 \\implies u_3 - u_2 = \\frac{17200}{2.52 \\times 10^7} \\approx 6.825397 \\times 10^{-4}\\,\\mathrm{m} \\\\ u_3 = u_2 + 6.825397 \\times 10^{-4} \\approx 5.206349 \\times 10^{-4} + 6.825397 \\times 10^{-4} \\approx 1.203175 \\times 10^{-3}\\,\\mathrm{m} $$\nThe displacement vector is $\\mathbf{U} \\approx \\begin{pmatrix} 0 & 5.206 \\times 10^{-4} & 1.203 \\times 10^{-3} \\end{pmatrix}^T\\,\\mathrm{m}$.\n\n**Task 4: Compute Reaction Force and Verify Equilibrium**\n\nThe reaction force $R_1$ at the fixed node $1$ is found from the first row of the global equation system $\\mathbf{R} = \\mathbf{K}\\mathbf{U} - \\mathbf{F}$.\n$$ R_1 = K_{11}u_1 + K_{12}u_2 + K_{13}u_3 - F_1 $$\nWith $u_1=0$ and $K_{13}=0$:\n$$ R_1 = K_{12}u_2 - F_1 = (-4.2 \\times 10^7)u_2 - \\frac{7000}{3} $$\nSubstituting the expression for $u_2$:\n$$ R_1 = (-4.2 \\times 10^7) \\left( \\frac{65600}{3 \\times 4.2 \\times 10^7} \\right) - \\frac{7000}{3} = -\\frac{65600}{3} - \\frac{7000}{3} = -\\frac{72600}{3} = -24200\\,\\mathrm{N} $$\nThe negative sign indicates the force acts in the $-x$ direction.\n\nTo verify global equilibrium, we sum all external forces acting on the bar. The total force from the distributed body load is:\n$$ F_{body} = \\int_0^L A(x)b(x)\\,dx = \\int_0^1 A_1(b_0+b_1x)\\,dx + \\int_1^2 A_2(b_0+b_1x)\\,dx $$\n$$ \\int_0^1 (2\\times 10^{-4})(2\\times 10^7+1\\times 10^7 x)\\,dx = (2\\times 10^{-4})[2\\times 10^7 x + 0.5\\times 10^7 x^2]_0^1 = 5000\\,\\mathrm{N} $$\n$$ \\int_1^2 (1.2\\times 10^{-4})(2\\times 10^7+1\\times 10^7 x)\\,dx = (1.2\\times 10^{-4})[2\\times 10^7 x + 0.5\\times 10^7 x^2]_1^2 = 4200\\,\\mathrm{N} $$\nTotal body force $F_{body} = 5000 + 4200 = 9200\\,\\mathrm{N}$.\nThe sum of all external forces is:\n$$ \\sum F_{ext} = R_1 + F_{body} + \\bar{T} = -24200\\,\\mathrm{N} + 9200\\,\\mathrm{N} + 15000\\,\\mathrm{N} = 0 $$\nThe global equilibrium is satisfied, which validates the calculation.\n\nThe reaction force at $x=0$ is $-24200\\,\\mathrm{N}$. In kiloNewtons, this is $-24.2\\,\\mathrm{kN}$. Rounded to four significant figures, the value is $-24.20\\,\\mathrm{kN}$.", "answer": "$$\\boxed{-24.20}$$", "id": "2538126"}, {"introduction": "This practice bridges the gap between manual calculation and computational implementation. You will translate the theoretical assembly process, often called a \"scatter-add\" operation, into a working computer program for a series of test cases. Formalizing the procedure with connectivity maps and assembly operators will deepen your understanding of how large-scale finite element software is architected and prepare you to tackle more complex problems [@problem_id:2562916].", "problem": "Consider a one-dimensional axial bar discretized by linear, two-node finite elements. The governing equation in strong form is the equilibrium of axial forces under a distributed load. Starting from the fundamental statement of virtual work, one can derive the finite element equations for the bar. The global assembly must be expressed using connectivity and element-wise assembly operators. Your task is to implement, for the provided test suite, the full global assembly of the stiffness matrix and the consistent global load vector using the assembly-operator formulation, enforce essential (Dirichlet) boundary conditions by elimination, solve for nodal displacements, and compute the summed reaction force at all constrained nodes. The final program must output a single line containing the requested values as specified below.\n\nThe fundamental base to be used is the Principle of Virtual Work, which for an axial bar states that the internal virtual work equals the external virtual work for all admissible virtual displacements. Let the bar occupy the domain $x \\in [0,L]$, have axial rigidity $E A(x)$, and be subjected to an axial distributed load $q(x)$ and to possible nodal point loads. For a linear two-node element with nodes $i$ and $j$, the element displacement field approximation is $u^{e}(x) = N_{1}(x)\\,u_{i} + N_{2}(x)\\,u_{j}$ with linear shape functions $N_{1}$ and $N_{2}$ defined over the element. The consistent element load vector is obtained by integrating the distributed load weighted by the shape functions. The element stiffness matrix is obtained from the integral of $E A$ times the derivative of shape functions. For global assembly, use boolean assembly operators $A^{e}$ built from the connectivity such that $u^{e} = A^{e} u$, where $u$ is the global displacement vector. Then form the global stiffness and force as $K = \\sum_{e} (A^{e})^{T} k^{e} A^{e}$ and $f = \\sum_{e} (A^{e})^{T} f^{e} + f^{p}$, where $k^{e}$ is the element stiffness, $f^{e}$ is the consistent element load due to distributed loads, and $f^{p}$ is the global vector of point loads. Apply essential boundary conditions by partitioning, solve for the unknown displacements, and compute reactions at constrained degrees of freedom from $r = K u - f$ restricted to constrained indices. Adopt the sign convention that positive loads and displacements are along the positive bar axis.\n\nGeometry and mesh for all test cases:\n- Nodal coordinates are $x = [\\,0,\\,1,\\,2\\,]\\,\\mathrm{m}$, giving two elements with connectivity $[0,1]$ and $[1,2]$ in zero-based indexing.\n- Each element $e$ has length $L_{e} = 1\\,\\mathrm{m}$.\n\nElement-level formulas to be derived from the Principle of Virtual Work and used in your implementation:\n- For a two-node linear element with constant axial rigidity over the element, the stiffness is given by the integral $k^{e} = \\int_{0}^{L_{e}} B^{T} E A \\, B \\,\\mathrm{d}x$, where $B$ is the derivative of the shape functions with respect to $x$.\n- For a uniformly distributed axial load $q_{e}$ on element $e$, the consistent element load is $f^{e} = \\int_{0}^{L_{e}} N^{T} q_{e} \\,\\mathrm{d}x$.\n- The assembly operator $A^{e}$ is a boolean matrix with exactly one unit entry per local degree of freedom mapping to its global counterpart, so that $u^{e} = A^{e} u$.\n\nUnits and required outputs:\n- All distances must be in $\\mathrm{m}$, forces in $\\mathrm{N}$, and axial rigidities $E A$ in $\\mathrm{N}$.\n- For each test case, return two numbers: the displacement at the interior node at $x=1\\,\\mathrm{m}$ in $\\mathrm{m}$, rounded to $6$ decimal places, and the total reaction force (sum of reactions over all constrained nodes) in $\\mathrm{N}$, rounded to $3$ decimal places.\n- Your program must produce a single line of output containing a comma-separated list of the $6$ results in the order specified below, enclosed in square brackets.\n\nTest suite:\n- Case $1$ (happy path): Element axial rigidities $E A = [\\,3.0\\times 10^{7},\\,6.0\\times 10^{7}\\,]\\,\\mathrm{N}$, element distributed loads $q = [\\,1000.0,\\,0.0\\,]\\,\\mathrm{N/m}$, point loads $f^{p}$ applied at nodes as $[\\,0.0,\\,0.0,\\,500.0\\,]\\,\\mathrm{N}$, with essential boundary condition $u(0)=0\\,\\mathrm{m}$.\n- Case $2$ (boundary conditioning coverage): Element axial rigidities $E A = [\\,5.0\\times 10^{7},\\,5.0\\times 10^{7}\\,]\\,\\mathrm{N}$, element distributed loads $q = [\\,500.0,\\,500.0\\,]\\,\\mathrm{N/m}$, no point loads $[\\,0.0,\\,0.0,\\,0.0\\,]\\,\\mathrm{N}$, with essential boundary conditions $u(0)=0\\,\\mathrm{m}$ and $u(2)=0\\,\\mathrm{m}$.\n- Case $3$ (edge case with zero distributed load and interior point load): Element axial rigidities $E A = [\\,4.0\\times 10^{7},\\,2.0\\times 10^{7}\\,]\\,\\mathrm{N}$, element distributed loads $q = [\\,0.0,\\,0.0\\,]\\,\\mathrm{N/m}$, point loads $[\\,0.0,\\,-100.0,\\,0.0\\,]\\,\\mathrm{N}$, with essential boundary condition $u(0)=0\\,\\mathrm{m}$.\n\nFinal output format:\n- The program must output a single line of the form $[r_{1},r_{2},r_{3},r_{4},r_{5},r_{6}]$ where, in order, the pairs are for cases $1$, $2$, and $3$, respectively, with each pair consisting of the interior-node displacement at $x=1\\,\\mathrm{m}$ (in $\\mathrm{m}$, rounded to $6$ decimals) followed by the total reaction force (in $\\mathrm{N}$, rounded to $3$ decimals).", "solution": "The problem presented is a standard, well-posed problem in computational solid mechanics, specifically the application of the one-dimensional Finite Element Method (FEM) to an axial bar. It is scientifically sound, logically consistent, and provides all necessary data for a unique solution. We shall proceed with the derivation and solution.\n\nThe foundation of the finite element formulation for static solid mechanics problems is the Principle of Virtual Work. For a one-dimensional bar in static equilibrium under a distributed axial load $q(x)$ and point loads $P_i$, this principle states that the internal virtual work (${\\delta}W_{int}$) equals the external virtual work (${\\delta}W_{ext}$) for any arbitrary, kinematically admissible virtual displacement field ${\\delta}u(x)$.\n$${\\delta}W_{int} = {\\delta}W_{ext}$$\n$$ \\int_{L} {\\delta}\\epsilon(x) E A(x) \\epsilon(x) \\,dx = \\int_{L} {\\delta}u(x) q(x) \\,dx + \\sum_{i} {\\delta}u_{i} P_{i} $$\nwhere $\\epsilon(x) = \\frac{du}{dx}$ is the axial strain, $E A(x)$ is the axial rigidity, and ${\\delta}\\epsilon = \\frac{d({\\delta}u)}{dx}$ is the virtual strain.\n\nThe domain is discretized into finite elements. Within each element $e$, the displacement field $u^e(x)$ is approximated by interpolating nodal displacements $u^e$ using shape functions $N(x)$:\n$$ u^e(x) = N(x) u^e = [N_1(x) \\quad N_2(x)] \\begin{bmatrix} u_i \\\\ u_j \\end{bmatrix} $$\nFor a linear two-node element of length $L_e$, the shape functions are $N_1(x) = 1 - x/L_e$ and $N_2(x) = x/L_e$, where $x$ is the local coordinate within the element ($x \\in [0, L_e]$).\n\nThe strain $\\epsilon^e(x)$ is then approximated as:\n$$ \\epsilon^e(x) = \\frac{du^e}{dx} = \\frac{dN}{dx} u^e = B u^e $$\nwhere $B = [\\frac{dN_1}{dx} \\quad \\frac{dN_2}{dx}] = [-\\frac{1}{L_e} \\quad \\frac{1}{L_e}]$ is the strain-displacement matrix. The virtual displacement and strain are approximated analogously: ${\\delta}u^e(x) = N(x) {\\delta}u^e$ and ${\\delta}\\epsilon^e(x) = B {\\delta}u^e$.\n\nSubstituting these approximations into the Principle of Virtual Work for a single element yields:\n$$ \\int_{L_e} ({\\delta}u^e)^T B^T E A B u^e \\,dx = \\int_{L_e} ({\\delta}u^e)^T N^T q_e \\,dx $$\nSince the virtual nodal displacements $({\\delta}u^e)^T$ are arbitrary, we obtain the element-level matrix equation $k^e u^e = f^e$:\n$$ \\left( \\int_{L_e} B^T E A B \\,dx \\right) u^e = \\int_{L_e} N^T q_e \\,dx $$\n\nThis gives the formulas for the element stiffness matrix $k^e$ and the consistent element load vector $f^e$:\nFor a constant $EA$ and $L_e=1$:\n$$ k^e = \\int_{0}^{1} \\begin{bmatrix} -1 \\\\ 1 \\end{bmatrix} EA \\begin{bmatrix} -1 & 1 \\end{bmatrix} \\,dx = EA \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} $$\nFor a constant distributed load $q_e$ and $L_e=1$:\n$$ f^e_{dist} = \\int_{0}^{1} \\begin{bmatrix} 1-x \\\\ x \\end{bmatrix} q_e \\,dx = q_e \\begin{bmatrix} [x-x^2/2]_0^1 \\\\ [x^2/2]_0^1 \\end{bmatrix} = \\frac{q_e}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} $$\n\nTo form the global system of equations $K u = f$ for the entire bar with $N_{dof}$ total degrees of freedom (DoFs), we sum the contributions from all elements. This process is formally described by assembly operators $A^e$, which are Boolean matrices mapping an element's local DoFs to the global DoF vector. For an element $e$ with local displacement vector $u^e$, we have $u^e = A^e u$. The global matrices are formed by summation:\n$$ K = \\sum_{e} (A^e)^T k^e A^e \\quad \\text{and} \\quad f = \\sum_{e} (A^e)^T f^e_{dist} + f^p $$\nwhere $f^p$ is the vector of nodal point loads. In practice, this operation is implemented by iterating through elements and adding their matrix and vector entries into the corresponding global positions according to the element's connectivity map.\n\nThe geometry consists of $3$ nodes at $x=[0, 1, 2]$, creating two elements of length $L_e=1$. The global system will be $3 \\times 3$.\n- Element $1$: connects nodes $0$ and $1$. Connectivity `[0, 1]`.\n- Element $2$: connects nodes $1$ and $2$. Connectivity `[1, 2]`.\n\nAfter assembling the global matrix $K$ and vector $f$, essential boundary conditions (e.g., $u_i = \\bar{u_i}$) are enforced. We partition the system into free (subscript $f$) and constrained (subscript $c$) DoFs:\n$$ \\begin{bmatrix} K_{ff} & K_{fc} \\\\ K_{cf} & K_{cc} \\end{bmatrix} \\begin{bmatrix} u_f \\\\ u_c \\end{bmatrix} = \\begin{bmatrix} f_f \\\\ f_c \\end{bmatrix} $$\nThe unknown displacements $u_f$ are found by solving the reduced system:\n$$ K_{ff} u_f = f_f - K_{fc} u_c $$\nIn this problem, all prescribed displacements are zero ($u_c = 0$), so the system simplifies to $K_{ff} u_f = f_f$.\n\nOnce the full displacement vector $u$ is known (by combining the solved $u_f$ and prescribed $u_c$), the reaction forces $r$ at the constrained nodes are calculated. The reaction force is the external force required to maintain the constraint. It is given by the difference between the internal forces $Ku$ and the applied external forces $f$ at the constrained DoFs:\n$$ r_c = (K u)_c - f_c $$\nThe total reaction is the sum of all components of $r_c$.\n\nLet us apply this procedure to Case 1:\n- Givens: $EA = [3\\times10^7, 6\\times10^7]$, $q = [1000, 0]$, $f^p=[0, 0, 500]$, BC: $u_0=0$.\n- Element matrices ($L_e=1$):\n  $k^1 = 3\\times10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$, $f^1 = \\frac{1000}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$\n  $k^2 = 6\\times10^7 \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}$, $f^2 = \\frac{0}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n- Global Assembly ($N_{dof}=3$):\n  $K = \\begin{bmatrix} 3\\times10^7 & -3\\times10^7 & 0 \\\\ -3\\times10^7 & 3\\times10^7+6\\times10^7 & -6\\times10^7 \\\\ 0 & -6\\times10^7 & 6\\times10^7 \\end{bmatrix} = 10^7 \\begin{bmatrix} 3 & -3 & 0 \\\\ -3 & 9 & -6 \\\\ 0 & -6 & 6 \\end{bmatrix}$\n  $f_{dist} = \\begin{bmatrix} 500 \\\\ 500 \\\\ 0 \\end{bmatrix}$. Total force $f = f_{dist} + f^p = \\begin{bmatrix} 500 \\\\ 500 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ 0 \\\\ 500 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\\\ 500 \\end{bmatrix}$.\n- Apply BCs: Constrained DoF is $c=\\{0\\}$ and free DoFs are $f=\\{1, 2\\}$. $u_0=0$.\n  $K_{ff} = 10^7 \\begin{bmatrix} 9 & -6 \\\\ -6 & 6 \\end{bmatrix}$, $u_f = \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix}$, $f_f = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$.\n- Solve $K_{ff} u_f = f_f$:\n  $10^7 \\begin{bmatrix} 9 & -6 \\\\ -6 & 6 \\end{bmatrix} \\begin{bmatrix} u_1 \\\\ u_2 \\end{bmatrix} = \\begin{bmatrix} 500 \\\\ 500 \\end{bmatrix}$\n  Solving this system yields $u_1 = \\frac{1}{3} \\times 10^{-4}\\,\\mathrm{m} \\approx 0.000033\\,\\mathrm{m}$ and $u_2 = \\frac{5}{12} \\times 10^{-4}\\,\\mathrm{m} \\approx 0.000042\\,\\mathrm{m}$.\n- Reaction Force: Full displacement vector is $u = [0, \\frac{1}{3}\\times10^{-4}, \\frac{5}{12}\\times10^{-4}]^T$.\n  $r_0 = (Ku)_0 - f_0 = K_{00}u_0 + K_{01}u_1 + K_{02}u_2 - f_0$.\n  $r_0 = (0) + (-3\\times10^7)(\\frac{1}{3}\\times10^{-4}) + (0) - 500 = -1000 - 500 = -1500\\,\\mathrm{N}$.\nThe total reaction force is $-1500\\,\\mathrm{N}$.\nThe values for the other test cases are found by applying the same systematic procedure.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D axial bar finite element problem for three test cases.\n    The implementation follows the principles of virtual work to derive element\n    matrices, assembles a global system, applies boundary conditions by\n    elimination, solves for displacements, and calculates reaction forces.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"EA\": [3.0e7, 6.0e7],       # N\n            \"q\": [1000.0, 0.0],          # N/m\n            \"fp\": [0.0, 0.0, 500.0],    # N\n            \"bc\": {0: 0.0}               # node_idx: displacement (m)\n        },\n        # Case 2\n        {\n            \"EA\": [5.0e7, 5.0e7],\n            \"q\": [500.0, 500.0],\n            \"fp\": [0.0, 0.0, 0.0],\n            \"bc\": {0: 0.0, 2: 0.0}\n        },\n        # Case 3\n        {\n            \"EA\": [4.0e7, 2.0e7],\n            \"q\": [0.0, 0.0],\n            \"fp\": [0.0, -100.0, 0.0],\n            \"bc\": {0: 0.0}\n        }\n    ]\n\n    results = []\n    \n    # Mesh definition is common for all cases\n    nodes = np.array([0.0, 1.0, 2.0])\n    connectivity = [[0, 1], [1, 2]]\n    num_nodes = len(nodes)\n    num_elements = len(connectivity)\n    \n    for case in test_cases:\n        K_global = np.zeros((num_nodes, num_nodes))\n        F_global = np.zeros(num_nodes)\n        \n        # Assemble global stiffness matrix and consistent load vector\n        for i in range(num_elements):\n            EA_elem = case[\"EA\"][i]\n            q_elem = case[\"q\"][i]\n            \n            node_i, node_j = connectivity[i]\n            L_elem = nodes[node_j] - nodes[node_i]\n            \n            # Element stiffness matrix\n            k_elem = (EA_elem / L_elem) * np.array([[1, -1], [-1, 1]])\n            \n            # Consistent element load vector for uniform distributed load\n            f_elem_dist = (q_elem * L_elem / 2.0) * np.array([1, 1])\n            \n            # Assemble (scatter-add) into global matrices\n            # This is the practical implementation of K = sum( A.T @ k @ A )\n            # and F = sum( A.T @ f )\n            indices = np.ix_([node_i, node_j], [node_i, node_j])\n            K_global[indices] += k_elem\n            F_global[[node_i, node_j]] += f_elem_dist\n\n        # Add point loads\n        F_global += np.array(case[\"fp\"])\n        \n        # Apply boundary conditions by partitioning\n        all_dofs = list(range(num_nodes))\n        constrained_dofs = sorted(list(case[\"bc\"].keys()))\n        free_dofs = sorted(list(set(all_dofs) - set(constrained_dofs)))\n\n        K_ff = K_global[np.ix_(free_dofs, free_dofs)]\n        F_f = F_global[free_dofs]\n        \n        # In this problem, all prescribed displacements are 0, so the term\n        # -K_fc @ u_c is zero and omitted from the right hand side.\n        \n        # Solve for unknown displacements\n        u_f = np.linalg.solve(K_ff, F_f)\n        \n        # Reconstruct the full displacement vector\n        u_global = np.zeros(num_nodes)\n        u_global[free_dofs] = u_f\n        # u_global[constrained_dofs] is already 0 as per the problem.\n\n        # Calculate reaction forces using the formula r = K*u - f\n        # This is evaluated only for the constrained DoFs.\n        reactions = (K_global @ u_global - F_global)[constrained_dofs]\n        total_reaction = np.sum(reactions)\n        \n        # Extract displacement at the interior node (node 1)\n        u1 = u_global[1]\n        \n        # Format results as specified\n        u1_rounded = f\"{u1:.6f}\"\n        reaction_rounded = f\"{total_reaction:.3f}\"\n        \n        results.extend([u1_rounded, reaction_rounded])\n        \n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2562916"}]}