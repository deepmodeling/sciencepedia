## Applications and Interdisciplinary Connections

Having established the fundamental principles of [numerical quadrature](@entry_id:136578) and its role in evaluating integrals of polynomial functions, this chapter explores the far-reaching implications of these principles within the finite element method. The accurate and efficient implementation of the finite element method across diverse fields of science and engineering hinges on the correct application of [numerical integration](@entry_id:142553). Here, we move beyond the theoretical foundations to demonstrate how to determine the necessary [quadrature rules](@entry_id:753909) for a variety of practical scenarios. We will see that this process involves a systematic analysis of the integrands that arise in different physical and mathematical contexts.

Furthermore, this chapter will delve into the profound consequences of the chosen integration scheme. We will examine how the choice of quadrature order impacts not only the computational cost but also the fundamental properties of the numerical solution, including its consistency, accuracy, and stability. This exploration will reveal that numerical integration is not merely a computational necessity but a sophisticated tool in the design of robust and high-performance finite element formulations.

### Exact Integration of Standard Element Formulations

The starting point for applying quadrature theory is the evaluation of the fundamental matrices and vectors that constitute the discrete algebraic system: the mass matrix, the [stiffness matrix](@entry_id:178659), and the [load vector](@entry_id:635284). The required quadrature order is dictated by the polynomial degree of the integrand, which in turn depends on the choice of basis functions and the nature of the integral term. For the common case of [isoparametric elements](@entry_id:173863) with affine mappings, the analysis is particularly straightforward, as the affine map preserves the polynomial degree of the basis functions when transforming from the reference to the physical element.

Consider the element mass matrix, whose entries involve integrals of the product of two basis functions, $\varphi_i$ and $\varphi_j$. For standard Lagrange elements of degree $p$ (denoted $P_p$ on simplices and $Q_p$ on tensor-product elements), both $\varphi_i$ and $\varphi_j$ are polynomials of degree at most $p$. Their product, $\varphi_i \varphi_j$, is therefore a polynomial of degree at most $2p$. To integrate this product exactly, the quadrature rule must be exact for polynomials of this degree. For one-dimensional and tensor-product elements integrated using Gauss-Legendre quadrature with $n$ points per direction, this requires that the rule be exact for univariate polynomials of degree up to $2p$. The condition is $2n - 1 \ge 2p$, which yields a minimal requirement of $n = p+1$ points [@problem_id:2591937] [@problem_id:2591931]. For simplicial elements such as triangles, a quadrature rule with an algebraic [degree of exactness](@entry_id:175703) of at least $2p$ is required [@problem_id:2591941].

A similar analysis applies to the [element stiffness matrix](@entry_id:139369), which arises from diffusion or elasticity problems and involves integrals of the dot product of the gradients of basis functions, $\nabla\varphi_i \cdot \nabla\varphi_j$. Since differentiation reduces the degree of a polynomial by one, the gradient of a degree-$p$ basis function, $\nabla\varphi_i$, is a polynomial of degree $p-1$. Consequently, the integrand $\nabla\varphi_i \cdot \nabla\varphi_j$ is a polynomial of degree at most $(p-1) + (p-1) = 2p-2$. To ensure exact integration, the [quadrature rule](@entry_id:175061) must be precise for polynomials of this degree. For 1D Gauss-Legendre quadrature, this leads to the condition $2n - 1 \ge 2p-2$, which implies a minimal choice of $n = p$ points [@problem_id:2591995]. For [triangular elements](@entry_id:167871), a rule with a [degree of exactness](@entry_id:175703) of $2p-2$ is required [@problem_id:2591974].

The element [load vector](@entry_id:635284) involves integrals of the form $\int_K f \varphi_i dx$, where $f$ is a source term. If the source term $f$ can be well-approximated by a polynomial of degree $r$, the integrand $f \varphi_i$ will be a polynomial of degree at most $p+r$. This dictates that the quadrature rule must be exact for this combined degree, demonstrating how the properties of the physical data (the source term) also influence the choice of integration scheme [@problem_id:2591984].

### Application to Diverse Physical and Mathematical Models

The systematic approach of analyzing the integrand's degree extends readily to a wide variety of partial differential equations and numerical formulations beyond the standard Poisson equation.

**Variable Coefficients and Convection Terms:** In many physical problems, material properties or transport velocities are not constant. For a diffusion problem with a spatially varying conductivity, $k(\boldsymbol{x})$, the stiffness integrand becomes $k(\boldsymbol{x}) \nabla\varphi_i \cdot \nabla\varphi_j$. If $k(\boldsymbol{x})$ is a polynomial of degree $q$, the total degree of the integrand increases to $q + 2p - 2$, necessitating a higher-order [quadrature rule](@entry_id:175061) for exact integration [@problem_id:2591959] [@problem_id:2599192]. Similarly, for [convection-diffusion](@entry_id:148742) problems, terms of the form $\int_K (\boldsymbol{\beta} \cdot \nabla \varphi_j) \varphi_i dx$ appear, where $\boldsymbol{\beta}$ is the velocity field. If $\boldsymbol{\beta}$ is a polynomial of degree $q$, the integrand degree becomes $q + (p-1) + p = 2p+q-1$, again requiring a correspondingly accurate [quadrature rule](@entry_id:175061) [@problem_id:2591972].

**Nonlinear Problems:** In [nonlinear finite element analysis](@entry_id:167596), the integrand's degree may depend on the solution itself. For instance, a nonlinear reaction term in a [weak form](@entry_id:137295) might produce an integral like $\int_K (u_h)^3 \varphi_i dx$. If the discrete solution $u_h$ is represented by polynomials of degree $p$, then $(u_h)^3$ is a polynomial of degree $3p$. The full integrand thus has a degree of $4p$. This demonstrates that nonlinear problems often demand significantly higher quadrature orders than their linear counterparts to maintain integration accuracy [@problem_id:2591943].

**Alternative Formulations:** The principle is not limited to standard Galerkin methods. In [mixed finite element methods](@entry_id:165231), used for problems like Stokes flow or Darcy flow, coupling terms appear that link different physical variables. A typical term is $\int_K p_h (\nabla \cdot \boldsymbol{v}_h) dx$, where the pressure $p_h$ is a polynomial of degree $m$ and the velocity component derivatives $\nabla \cdot \boldsymbol{v}_h$ are polynomials of degree $p-1$. The integrand is thus a polynomial of degree $m+p-1$, and the [quadrature rule](@entry_id:175061) must be chosen accordingly [@problem_id:2591950]. Likewise, in Discontinuous Galerkin (DG) methods, integrals are evaluated not only over element interiors but also over element faces. A face integral term might involve the product of the jump of a function, $[v_h]$, and the average of a gradient, $\{\nabla u_h\}$. For degree-$p$ elements, the jump term has degree $p$ on the face, while the average gradient has degree $p-1$. The resulting integrand has degree $2p-1$, dictating the required quadrature on the face [@problem_id:2591944].

### Consequences of Quadrature Choice: Accuracy, Stability, and Consistency

While achieving exact integration is often desirable, it is not always necessary or even possible. The choice of a quadrature rule, particularly the decision to "under-integrate" (i.e., use a rule of insufficient order for exactness), has profound consequences that are central to the design of modern [finite element methods](@entry_id:749389).

**Consistency and the Patch Test:** A fundamental sanity check for any finite element is the patch test, which verifies that the element can exactly reproduce a constant strain state. For linear elements ($p=1$) under [affine mapping](@entry_id:746332), the [stiffness matrix](@entry_id:178659) integrand is a constant. Exact integration, which can be achieved with a single quadrature point, is a prerequisite for passing the constant-strain patch test. Failure to integrate this constant term exactly introduces spurious forces and violates the basic consistency of the method [@problem_id:2591932].

**Convergence and Variational Crimes:** The use of inexact quadrature is a form of "[variational crime](@entry_id:178318)" because the discrete problem no longer corresponds to the exact Galerkin projection of the continuous weak form. The effect of this error is formally captured by Strang's First Lemma, which shows that the total error in the finite element solution is bounded by the sum of the best [approximation error](@entry_id:138265) and a [consistency error](@entry_id:747725) term arising from the quadrature. If the [stiffness matrix](@entry_id:178659) is under-integrated by one polynomial degree (e.g., using a rule exact for degree $2p-3$ instead of $2p-2$), a [consistency error](@entry_id:747725) is introduced that typically degrades the optimal convergence rate. For instance, the [energy norm error](@entry_id:170379) may degrade from $\mathcal{O}(h^p)$ to $\mathcal{O}(h^{p-1})$, and the $L^2$-norm error from $\mathcal{O}(h^{p+1})$ to $\mathcal{O}(h^p)$ [@problem_id:2591990] [@problem_id:2599192].

**Stability and Spurious Modes:** Perhaps the most dramatic consequence of under-integration is the potential loss of numerical stability. While using fewer quadrature points reduces computational cost, it also means the stiffness of the element is sampled at fewer locations. If the [quadrature rule](@entry_id:175061) is too weak, it may fail to "see" certain element deformation modes. For example, using a single quadrature point at the center of a bilinear quadrilateral ($Q_1$) element to compute its stiffness matrix results in a [rank-deficient matrix](@entry_id:754060). There exist non-rigid-body deformation modes, known as spurious or "hourglass" modes, whose gradients are zero at the element center. These modes produce zero strain energy under 1-point quadrature, rendering the element unstable. This loss of [coercivity](@entry_id:159399) means the [global stiffness matrix](@entry_id:138630) can become singular, leading to catastrophic failure of the simulation unless stabilization techniques are employed [@problem_id:2705813] [@problem_id:2599192]. An approximate bilinear form with positive [quadrature weights](@entry_id:753910) will always be symmetric and [positive semi-definite](@entry_id:262808), but stability requires the stronger condition of [positive definiteness](@entry_id:178536), which under-integration can jeopardize [@problem_id:2599192].

**Purposeful Under-Integration and Element Technology:** Counterintuitively, under-integration is not always detrimental. It can be a powerful tool to remedy other numerical pathologies. A celebrated example is in the simulation of [nearly incompressible materials](@entry_id:752388) (e.g., rubber) using [linear elasticity](@entry_id:166983). Standard, fully integrated low-order elements exhibit "volumetric locking," an artificial stiffening that prevents them from deforming correctly under the [incompressibility constraint](@entry_id:750592). The technique of [selective reduced integration](@entry_id:168281) (SRI) provides an elegant solution. The element stiffness is split into its deviatoric (shear) and volumetric (bulk) parts. The deviatoric part is fully integrated to maintain stability and prevent [hourglassing](@entry_id:164538). The volumetric part, which is responsible for locking, is deliberately under-integrated. For a $Q_1$ element, this means using a $2 \times 2$ rule for the deviatoric term but only a $1 \times 1$ rule for the volumetric term. This relaxes the incompressibility constraint from being enforced at four points to only being enforced on average over the element, which is sufficient to cure locking while retaining stability. This demonstrates that a sophisticated choice of quadrature is a cornerstone of advanced element technology [@problem_id:2562012].

### Advanced Topics: Integrating Non-Polynomial Functions

The entire framework presented thus far rests on the assumption that the integrand is a single polynomial function over the integration domain. In advanced formulations designed to model complex, localized phenomena, this assumption breaks down.

A prominent example arises in the Partition of Unity Method (PUM) or eXtended Finite Element Method (XFEM), which are used to model objects like cracks or [material interfaces](@entry_id:751731) without conforming the mesh to the discontinuity. In these methods, the standard polynomial basis is enriched with functions that capture the non-smooth nature of the solution, such as a Heaviside [step function](@entry_id:158924) across a crack. When an element is cut by a discontinuity, the integrand for the [stiffness matrix](@entry_id:178659) may take the form $g(\boldsymbol{x}) H(\phi(\boldsymbol{x}))$, where $g(\boldsymbol{x})$ is a polynomial and $H(\phi(\boldsymbol{x}))$ is the Heaviside function.

This integrand is not a single polynomial; it is a [piecewise polynomial](@entry_id:144637) with a [jump discontinuity](@entry_id:139886). Standard Gaussian quadrature is not designed for such functions and will fail to produce an accurate result, regardless of the number of points used. Applying a standard rule can lead to biased, inconsistent results as the fixed quadrature points may lie arbitrarily with respect to the discontinuity. The correct and consistent approach is to partition the cut element into sub-elements based on the location of the discontinuity. Within each sub-element, the Heaviside function is constant (either 0 or 1), and the integrand reduces to a pure polynomial. Standard Gaussian quadrature can then be applied accurately on each sub-element, and the results summed to obtain the correct integral for the entire element. This illustrates that when the fundamental nature of the integrand changes, the integration strategy must adapt accordingly [@problem_id:2586316].

In conclusion, the theory of numerical quadrature is not an isolated mathematical topic but an integral and powerful component of the [finite element method](@entry_id:136884). A careful analysis of the integrand's mathematical structure is paramount for selecting an appropriate integration rule. This choice has first-order effects on the consistency, accuracy, stability, and efficiency of the resulting simulation, and it stands as a key consideration in the development of both fundamental and highly advanced finite element technologies.