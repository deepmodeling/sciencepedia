{"hands_on_practices": [{"introduction": "Gaussian quadrature rules are central to the finite element method, yet their nodes and weights can often seem arbitrary. This first practice demystifies the process by guiding you through the construction of the classic two-point Gauss-Legendre rule from first principles [@problem_id:2591926]. By setting up and solving a system of nonlinear equations based on the requirement of exactness for low-degree polynomials, you will derive the precise locations and weights that grant this rule its remarkable efficiency.", "problem": "In the finite element method, integrals on the reference interval are often evaluated by Gaussian quadrature. Consider the reference interval $[-1,1]$ with unit weight function $w(x)=1$. Seek a quadrature rule with $n=2$ nodes of the form\n$$\n\\int_{-1}^{1} f(x)\\,dx \\approx w_1 f(x_1) + w_2 f(x_2),\n$$\nwhere $x_1,x_2 \\in (-1,1)$ and $w_1,w_2>0$. Using only the requirement that this quadrature be exact for all polynomials $f(x)$ of degree at most $3$, construct the system of moment-matching equations associated with $f(x)=x^k$ for $k\\in\\{0,1,2,3\\}$ and solve it to determine $x_1,x_2,w_1,w_2$. Your derivation must not invoke special function tables or properties beyond the defining requirement of exactness on monomials and basic calculus on polynomial integrals.\n\nThen verify your result by directly substituting $f(x)=x^k$ for $k\\in\\{0,1,2,3\\}$ and confirming equality between the exact integral and the quadrature sum in each case.\n\nProvide your final answer as a single row matrix $\\big(x_1,\\;x_2,\\;w_1,\\;w_2\\big)$ with the ordering constraint $x_1<0<x_2$. No rounding is required, and no units are involved.", "solution": "The goal is to construct a quadrature rule on $[-1,1]$ with $n=2$ nodes that is exact for all polynomials of degree at most $3$. By definition, exactness for degree at most $3$ means that for $f(x)=x^k$ with $k\\in\\{0,1,2,3\\}$,\n$$\n\\int_{-1}^{1} x^k\\,dx \\;=\\; w_1 x_1^k + w_2 x_2^k.\n$$\nWe use only the integrals of monomials and set up the corresponding equations. The needed exact integrals are computed by elementary calculus:\n- For $k=0$, $\\displaystyle \\int_{-1}^{1} x^0\\,dx = \\int_{-1}^{1} 1\\,dx = 2$.\n- For $k=1$, $\\displaystyle \\int_{-1}^{1} x\\,dx = 0$ by symmetry.\n- For $k=2$, $\\displaystyle \\int_{-1}^{1} x^2\\,dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3}-\\left(-\\frac{1}{3}\\right)=\\frac{2}{3}$.\n- For $k=3$, $\\displaystyle \\int_{-1}^{1} x^3\\,dx = 0$ by symmetry.\n\nThus the moment-matching system is\n\n$$\n\\begin{aligned}\n&k=0:\\quad && w_1 + w_2 = 2, \\\\\n&k=1:\\quad && w_1 x_1 + w_2 x_2 = 0, \\\\\n&k=2:\\quad && w_1 x_1^2 + w_2 x_2^2 = \\frac{2}{3}, \\\\\n&k=3:\\quad && w_1 x_1^3 + w_2 x_2^3 = 0.\n\\end{aligned}\n$$\n\n\nWe now exploit only these equations to determine the parameters. Consider the two equations for the odd moments:\n\n$$\nw_1 x_1 + w_2 x_2 = 0,\\qquad w_1 x_1^3 + w_2 x_2^3 = 0.\n$$\n\nIntroduce the variables $y_1 := w_1 x_1$ and $y_2 := w_2 x_2$. The system becomes\n\n$$\n\\begin{pmatrix}\n1 & 1 \\\\\nx_1^2 & x_2^2\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\ y_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0\n\\end{pmatrix}.\n$$\n\nFor a nontrivial solution $(y_1,y_2)$ to exist (which is necessary unless $x_1=x_2=0$, which is not allowed because distinct nodes are required for a two-point rule of nonzero degree of exactness), the determinant must vanish:\n\n$$\nx_2^2 - x_1^2 = 0 \\quad \\Rightarrow \\quad x_2^2 = x_1^2.\n$$\n\nHence $|x_1|=|x_2|$. Since the nodes must be distinct and in $(-1,1)$, we conclude\n\n$$\nx_2 = -x_1.\n$$\n\nReturning to $y_1 + y_2 = 0$ and substituting $x_2=-x_1$ yields\n\n$$\nw_1 x_1 + w_2 (-x_1) = 0 \\;\\Rightarrow\\; (w_1 - w_2) x_1 = 0.\n$$\n\nBecause $x_1 \\neq 0$, it follows that\n\n$$\nw_1 = w_2.\n$$\n\nDenote the common weight by $w$ and the positive node by $a>0$, so that $x_1=-a$, $x_2=+a$, and $w_1=w_2=w$. The remaining two equations become\n\n$$\nw + w = 2 \\;\\Rightarrow\\; 2w = 2 \\;\\Rightarrow\\; w = 1,\n$$\n\nand\n\n$$\nw x_1^2 + w x_2^2 = \\frac{2}{3} \\;\\Rightarrow\\; 1\\cdot a^2 + 1\\cdot a^2 = \\frac{2}{3} \\;\\Rightarrow\\; 2a^2 = \\frac{2}{3} \\;\\Rightarrow\\; a^2 = \\frac{1}{3}.\n$$\n\nTaking $a>0$ gives $a = \\frac{1}{\\sqrt{3}}$. Enforcing the ordering constraint $x_1<0<x_2$ yields\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1.\n$$\n\n\nVerification for $k\\in\\{0,1,2,3\\}$:\n- $k=0$: $w_1+w_2 = 1+1 = 2 = \\int_{-1}^{1} 1\\,dx$.\n- $k=1$: $w_1 x_1 + w_2 x_2 = 1\\cdot\\left(-\\frac{1}{\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x\\,dx$.\n- $k=2$: $w_1 x_1^2 + w_2 x_2^2 = 1\\cdot\\frac{1}{3} + 1\\cdot\\frac{1}{3} = \\frac{2}{3} = \\int_{-1}^{1} x^2\\,dx$.\n- $k=3$: $w_1 x_1^3 + w_2 x_2^3 = 1\\cdot\\left(-\\frac{1}{3\\sqrt{3}}\\right) + 1\\cdot\\left(\\frac{1}{3\\sqrt{3}}\\right) = 0 = \\int_{-1}^{1} x^3\\,dx$.\n\nTherefore, the constructed $n=2$ Gauss–Legendre rule on $[-1,1]$ has nodes and weights\n\n$$\nx_1 = -\\frac{1}{\\sqrt{3}},\\quad x_2 = \\frac{1}{\\sqrt{3}},\\quad w_1 = 1,\\quad w_2 = 1,\n$$\n\nwhich satisfy exactness for all polynomials up to degree $3$ as required.", "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{\\sqrt{3}} & \\frac{1}{\\sqrt{3}} & 1 & 1\\end{pmatrix}}$$", "id": "2591926"}, {"introduction": "Real-world FEM applications require integration over two- and three-dimensional domains, such as triangles and tetrahedra. This exercise extends the fundamental concept of moment-matching to a 2D reference triangle, a building block for many finite element meshes [@problem_id:2591977]. You will determine the parameters for a symmetric three-point rule that achieves exactness for quadratic polynomials, gaining hands-on experience with barycentric coordinates and the construction of multi-dimensional quadrature schemes.", "problem": "In the Finite Element Method (FEM), element integrals over a simplex are often approximated by quadrature rules constructed to be exact for all polynomials up to a prescribed total degree. Consider the reference triangle $\\widehat{T} = \\{(x,y) \\in \\mathbb{R}^{2} : x \\ge 0,\\ y \\ge 0,\\ x + y \\le 1\\}$ with area $|\\widehat{T}| = \\frac{1}{2}$. A fully symmetric quadrature rule with a single orbit of points has $3$ nodes given by the permutations of the barycentric triple $(a,a,1-2a)$ and a common weight $w$ for each node, so that for any integrand $f$,\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy = \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i),\n$$\nwhere $(x_i,y_i)$ are the Cartesian coordinates corresponding to the $3$ permutations of $(a,a,1-2a)$ with respect to the vertices $(0,0)$, $(1,0)$, $(0,1)$. Using only fundamental definitions and direct evaluation of moments, determine the parameters $w$ and $a$ such that the rule is exact for all polynomials on $\\widehat{T}$ of total degree at most $2$. Impose the interior-point condition that all barycentric coordinates are strictly positive, i.e., $a \\in (0,\\tfrac{1}{2})$. Then verify the exactness by explicitly checking the rule against the test set $\\{1, x, y, x^2, xy, y^2\\}$ via direct integration over $\\widehat{T}$ and comparison with the quadrature evaluation.\n\nProvide your final answer as the pair $(w,a)$ in a single row matrix. No rounding is required.", "solution": "The objective is to find the weight $w$ and the barycentric coordinate parameter $a$ for a $3$-point symmetric quadrature rule on the reference triangle $\\widehat{T}$ that is exact for all polynomials of total degree up to $2$. The space of polynomials of total degree at most $2$, denoted $\\mathcal{P}_2(\\widehat{T})$, has a basis $\\{1, x, y, x^2, xy, y^2\\}$. The quadrature rule must exactly integrate each of these basis functions.\n\nThe quadrature rule is given by\n$$\n\\int_{\\widehat{T}} f(x,y)\\,dx\\,dy \\approx \\lvert \\widehat{T} \\rvert \\sum_{i=1}^{3} w\\, f(x_i,y_i) = \\frac{1}{2} w \\sum_{i=1}^{3} f(x_i,y_i)\n$$\nThe quadrature points $(x_i, y_i)$ are the Cartesian coordinates corresponding to the permutations of the barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ given by the triple $(a, a, 1-2a)$. The vertices of the reference triangle $\\widehat{T}$ are $V_1=(0,0)$, $V_2=(1,0)$, and $V_3=(0,1)$. A point with barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ has Cartesian coordinates $(x,y) = \\lambda_1 V_1 + \\lambda_2 V_2 + \\lambda_3 V_3 = (\\lambda_2, \\lambda_3)$. The three permutations of $(a, a, 1-2a)$ lead to the following quadrature points:\n\\begin{itemize}\n    \\item $P_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (1-2a, a, a) \\implies (x_1, y_1) = (a, a)$\n    \\item $P_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (a, 1-2a, a) \\implies (x_2, y_2) = (1-2a, a)$\n    \\item $P_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (a, a, 1-2a) \\implies (x_3, y_3) = (a, 1-2a)$\n\\end{itemize}\nThe condition $a \\in (0, \\frac{1}{2})$ ensures that $a > 0$ and $1-2a > 0$, so all barycentric coordinates are strictly positive, placing the points in the interior of the triangle.\n\nWe first compute the exact integrals (moments) of the basis polynomials over $\\widehat{T}$ using the formula $\\int_{\\widehat{T}} x^m y^n \\,dx\\,dy = \\frac{m! n!}{(m+n+2)!}$:\n\\begin{align*}\n    I(1) &= \\int_{\\widehat{T}} 1 \\,dx\\,dy = \\frac{0!0!}{2!} = \\frac{1}{2} \\\\\n    I(x) &= \\int_{\\widehat{T}} x \\,dx\\,dy = \\frac{1!0!}{3!} = \\frac{1}{6} \\\\\n    I(y) &= \\int_{\\widehat{T}} y \\,dx\\,dy = \\frac{0!1!}{3!} = \\frac{1}{6} \\\\\n    I(x^2) &= \\int_{\\widehat{T}} x^2 \\,dx\\,dy = \\frac{2!0!}{4!} = \\frac{2}{24} = \\frac{1}{12} \\\\\n    I(xy) &= \\int_{\\widehat{T}} xy \\,dx\\,dy = \\frac{1!1!}{4!} = \\frac{1}{24} \\\\\n    I(y^2) &= \\int_{\\widehat{T}} y^2 \\,dx\\,dy = \\frac{0!2!}{4!} = \\frac{2}{24} = \\frac{1}{12}\n\\end{align*}\n\nNext, we evaluate the quadrature rule, denoted $Q(f)$, for each basis function:\n\\begin{align*}\n    Q(1) &= \\frac{1}{2} w (1 + 1 + 1) = \\frac{3w}{2} \\\\\n    Q(x) &= \\frac{1}{2} w (a + (1-2a) + a) = \\frac{w}{2} \\\\\n    Q(y) &= \\frac{1}{2} w (a + a + (1-2a)) = \\frac{w}{2} \\\\\n    Q(x^2) &= \\frac{1}{2} w (a^2 + (1-2a)^2 + a^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1) \\\\\n    Q(xy) &= \\frac{1}{2} w (a \\cdot a + (1-2a)a + a(1-2a)) = \\frac{1}{2} w (a^2 + 2a - 4a^2) = \\frac{w}{2} (2a - 3a^2) \\\\\n    Q(y^2) &= \\frac{1}{2} w (a^2 + a^2 + (1-2a)^2) = \\frac{1}{2} w (2a^2 + 1 - 4a + 4a^2) = \\frac{w}{2} (6a^2 - 4a + 1)\n\\end{align*}\n\nWe equate the exact integrals with the quadrature approximations, $I(f) = Q(f)$, to form a system of equations for $w$ and $a$.\n\nFor degree $0$:\n$I(1) = Q(1) \\implies \\frac{1}{2} = \\frac{3w}{2} \\implies w = \\frac{1}{3}$.\n\nFor degree $1$:\n$I(x) = Q(x) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$.\n$I(y) = Q(y) \\implies \\frac{1}{6} = \\frac{w}{2} \\implies w = \\frac{1}{3}$.\nThese are consistent with the degree $0$ result. The symmetric structure of the rule ensures that if $I(x)=Q(x)$, then $I(y)=Q(y)$ as well.\n\nFor degree $2$, we substitute $w = \\frac{1}{3}$:\n$I(x^2) = Q(x^2) \\implies \\frac{1}{12} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (6a^2 - 4a + 1) \\implies \\frac{1}{12} = \\frac{1}{6} (6a^2 - 4a + 1)$.\nMultiplying by $12$ gives $1 = 2(6a^2 - 4a + 1)$, which simplifies to the quadratic equation $12a^2 - 8a + 1 = 0$.\nThe equation from $I(y^2) = Q(y^2)$ is identical by symmetry.\n\n$I(xy) = Q(xy) \\implies \\frac{1}{24} = \\frac{1}{2} \\left(\\frac{1}{3}\\right) (2a - 3a^2) \\implies \\frac{1}{24} = \\frac{1}{6} (2a - 3a^2)$.\nMultiplying by $24$ gives $1 = 4(2a - 3a^2)$, which simplifies to $1 = 8a - 12a^2$, or $12a^2 - 8a + 1 = 0$.\nAll second-degree polynomials yield the same condition on $a$.\n\nWe solve the quadratic equation $12a^2 - 8a + 1 = 0$ using the quadratic formula:\n$$ a = \\frac{-(-8) \\pm \\sqrt{(-8)^2 - 4(12)(1)}}{2(12)} = \\frac{8 \\pm \\sqrt{64 - 48}}{24} = \\frac{8 \\pm \\sqrt{16}}{24} = \\frac{8 \\pm 4}{24} $$\nThe two solutions are $a_1 = \\frac{8+4}{24} = \\frac{12}{24} = \\frac{1}{2}$ and $a_2 = \\frac{8-4}{24} = \\frac{4}{24} = \\frac{1}{6}$.\nThe problem imposes the strict interior-point condition $a \\in (0, \\frac{1}{2})$. The solution $a_1 = \\frac{1}{2}$ lies on the boundary of this interval and is therefore rejected. The solution $a_2 = \\frac{1}{6}$ is within the interval.\nThus, the required parameters are $w = \\frac{1}{3}$ and $a = \\frac{1}{6}$.\n\nFinally, we verify the exactness for the derived parameters, as requested.\nWith $w=\\frac{1}{3}$ and $a=\\frac{1}{6}$, the quadrature rule is $Q(f) = \\frac{1}{6} \\sum_{i=1}^{3} f(x_i, y_i)$.\nThe point parameter is $1-2a = 1-2(\\frac{1}{6}) = 1-\\frac{1}{3} = \\frac{2}{3}$.\nThe Cartesian points are $P_1 = (\\frac{1}{6}, \\frac{1}{6})$, $P_2 = (\\frac{2}{3}, \\frac{1}{6})$, and $P_3 = (\\frac{1}{6}, \\frac{2}{3})$.\nApplying the rule to the basis functions:\n\\begin{align*}\n    Q(1) &= \\frac{1}{6}(1+1+1) = \\frac{3}{6} = \\frac{1}{2} = I(1) \\\\\n    Q(x) &= \\frac{1}{6}(\\frac{1}{6} + \\frac{2}{3} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{4}{6} + \\frac{1}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(x) \\\\\n    Q(y) &= \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{2}{3}) = \\frac{1}{6}(\\frac{1}{6} + \\frac{1}{6} + \\frac{4}{6}) = \\frac{1}{6}(\\frac{6}{6}) = \\frac{1}{6} = I(y) \\\\\n    Q(x^2) &= \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{2}{3})^2 + (\\frac{1}{6})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(x^2) \\\\\n    Q(xy) &= \\frac{1}{6}\\left(\\frac{1}{6}\\cdot\\frac{1}{6} + \\frac{2}{3}\\cdot\\frac{1}{6} + \\frac{1}{6}\\cdot\\frac{2}{3}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{2}{18} + \\frac{2}{18}\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36}\\right) = \\frac{1}{6}\\left(\\frac{9}{36}\\right) = \\frac{1}{6 \\cdot 4} = \\frac{1}{24} = I(xy) \\\\\n    Q(y^2) &= \\frac{1}{6}\\left((\\frac{1}{6})^2 + (\\frac{1}{6})^2 + (\\frac{2}{3})^2\\right) = \\frac{1}{6}\\left(\\frac{1}{36} + \\frac{1}{36} + \\frac{16}{36}\\right) = \\frac{1}{6}\\left(\\frac{18}{36}\\right) = \\frac{1}{6 \\cdot 2} = \\frac{1}{12} = I(y^2)\n\\end{align*}\nThe verification confirms that the rule with parameters $w=\\frac{1}{3}$ and $a=\\frac{1}{6}$ is exact for all basis polynomials of degree up to $2$. The solution is therefore correct.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{3} & \\frac{1}{6} \\end{pmatrix}}\n$$", "id": "2591977"}, {"introduction": "The family of Gaussian quadrature rules includes several variants, such as Gauss-Lobatto and Gauss-Radau, which pre-assign one or both endpoints as nodes. While this is convenient for certain boundary conditions, it comes at the cost of a reduced degree of exactness. This advanced practice explores this trade-off by analyzing an integrand specifically designed to be integrated exactly by one rule but not another [@problem_id:2591954]. By working through this example, you will develop a deeper understanding of why the degree of the integrand dictates the choice of quadrature rule for ensuring accuracy in a simulation.", "problem": "Consider numerical quadrature on the interval $[-1,1]$ with unit weight for integrands arising in the Finite Element Method (FEM). Let $P_{k}(x)$ denote the Legendre polynomial of degree $k$, normalized so that $P_{k}(1)=1$. Define the polynomial\n$$\nq_{n}(x) \\;=\\; \\bigl(1-x^{2}\\bigr)\\,\\bigl(P_{n-1}'(x)\\bigr)^{2},\n$$\nwhich has degree $2n-2$ for any integer $n\\ge 2$.\n\nYou will compare the $n$-point Gauss–Radau quadrature (including the endpoint $x=1$) and the $n$-point Gauss–Lobatto quadrature (including both endpoints $x=\\pm 1$) on this integrand.\n\nTasks:\n- Establish, from first principles based on degree-of-exactness and parameter-counting using moment conditions, the maximal algebraic degree of exactness achievable by an $n$-point quadrature on $[-1,1]$ when (i) no endpoints are preassigned, (ii) exactly one endpoint is preassigned, and (iii) both endpoints are preassigned. Explain why the Gauss–Radau and Gauss–Lobatto constructions attain the respective maxima.\n- Prove that $q_{n}(x)$ vanishes at all Gauss–Lobatto nodes for the $n$-point rule, and conclude what numerical value the Gauss–Lobatto rule returns on $\\int_{-1}^{1} q_{n}(x)\\,dx$.\n- Use properties of Legendre polynomials to evaluate the exact integral $\\int_{-1}^{1} q_{n}(x)\\,dx$ in closed form as a function of $n$.\n- Explain why the $n$-point Gauss–Radau rule returns the exact value for $\\int_{-1}^{1} q_{n}(x)\\,dx$ while the $n$-point Gauss–Lobatto rule does not.\n\nYour final answer must be a single closed-form expression in $n$ for the exact value of $\\int_{-1}^{1} q_{n}(x)\\,dx$. No rounding is required.", "solution": "The tasks given require a systematic analysis of Gaussian quadrature rules. We will address each point in sequence.\n\nFirst, we establish the maximal degree of exactness for an $n$-point quadrature rule on the interval $[-1,1]$ with a unit weight function, $w(x)=1$. An $n$-point quadrature rule is of the form:\n$$\n\\int_{-1}^{1} f(x) \\,dx \\approx \\sum_{i=1}^{n} w_i f(x_i)\n$$\nwhere $\\{x_i\\}_{i=1}^{n}$ are the nodes and $\\{w_i\\}_{i=1}^{n}$ are the weights. The rule is said to have a degree of exactness $d$ if it is exact for all polynomials of degree less than or equal to $d$, but not for some polynomial of degree $d+1$. To be exact for all polynomials up to degree $d$, the rule must satisfy the $d+1$ moment equations:\n$$\n\\int_{-1}^{1} x^k \\,dx = \\sum_{i=1}^{n} w_i x_i^k, \\quad \\text{for } k=0, 1, \\dots, d\n$$\n\n(i) When no nodes are preassigned (Gauss-Legendre quadrature), there are $2n$ free parameters: $n$ nodes $x_i$ and $n$ weights $w_i$. These $2n$ parameters can be chosen to satisfy $2n$ equations. This corresponds to setting $d+1 = 2n$, which implies a maximal possible degree of exactness of $d = 2n-1$. This maximum is indeed achieved by the Gauss-Legendre quadrature, whose nodes are the roots of the degree-$n$ Legendre polynomial $P_n(x)$.\n\n(ii) When exactly one endpoint is preassigned, for instance $x_n = 1$ (Gauss-Radau quadrature), one degree of freedom is lost. We have $n-1$ free nodes and $n$ free weights, for a total of $2n-1$ free parameters. These can be chosen to satisfy $2n-1$ moment equations. This corresponds to $d+1=2n-1$, yielding a maximal degree of exactness of $d = 2n-2$. This is achieved by the Gauss-Radau rule, whose unassigned nodes are the roots of a specific combination of Legendre polynomials (e.g., $P_n(x) - P_{n-1}(x)$).\n\n(iii) When both endpoints are preassigned, for instance $x_1 = -1$ and $x_n = 1$ (Gauss-Lobatto quadrature), two degrees of freedom are lost. We have $n-2$ free nodes and $n$ free weights, giving $2n-2$ free parameters. These can satisfy at most $2n-2$ moment equations. This corresponds to $d+1=2n-2$, which gives a maximal degree of exactness of $d=2n-3$. This maximum is achieved by the Gauss-Lobatto quadrature, whose interior nodes are the roots of $P_{n-1}'(x)$, the first derivative of the Legendre polynomial of degree $n-1$.\n\nSecond, we analyze the action of the $n$-point Gauss-Lobatto rule on the integrand $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. As established, the nodes $\\{x_i\\}_{i=1}^{n}$ for this rule consist of the endpoints $x_1 = -1$ and $x_n = 1$, and the $n-2$ roots of $P_{n-1}'(x)$. Let us evaluate $q_n(x)$ at these nodes:\n- For the endpoints $x = \\pm 1$, the factor $(1-x^2)$ is equal to $1 - (\\pm 1)^2 = 0$. Therefore, $q_n(1) = 0$ and $q_n(-1) = 0$.\n- For the interior nodes $x_i$ ($i=2, \\dots, n-1$), these are by definition the roots of $P_{n-1}'(x)$. Therefore, $P_{n-1}'(x_i) = 0$, which implies $(P_{n-1}'(x_i))^2 = 0$. Consequently, $q_n(x_i) = 0$ for all interior nodes.\n\nSince $q_n(x)$ is zero at every node $x_i$ of the $n$-point Gauss-Lobatto quadrature, the quadrature sum is\n$$\n\\sum_{i=1}^{n} w_i q_n(x_i) = \\sum_{i=1}^{n} w_i \\cdot 0 = 0\n$$\nThus, the numerical value returned by the Gauss-Lobatto rule for the integral of $q_n(x)$ is exactly $0$.\n\nThird, we evaluate the exact value of the integral $I = \\int_{-1}^{1} q_n(x) \\,dx$. The integrand is $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. A direct integration is not straightforward. We shall use integration by parts combined with the properties of Legendre polynomials. The Legendre differential equation is given by\n$$\n(1-x^2)y'' - 2xy' + k(k+1)y = 0\n$$\nwhere $y=P_k(x)$. For $k=n-1$, we have:\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) + (n-1)n P_{n-1}(x) = 0\n$$\nThis can be rearranged to give the relation:\n$$\n(1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) = -n(n-1)P_{n-1}(x)\n$$\nThe expression on the left is the derivative of $(1-x^2)P_{n-1}'(x)$.\nNow, let us evaluate the integral $I = \\int_{-1}^{1} (1-x^2)(P_{n-1}'(x))^2 \\, dx$. We apply integration by parts with $u = (1-x^2)P_{n-1}'(x)$ and $dv = P_{n-1}'(x)dx$. Then $du = \\frac{d}{dx}[(1-x^2)P_{n-1}'(x)]dx$ and $v = P_{n-1}(x)$.\n$$\nI = \\left[ (1-x^2)P_{n-1}'(x)P_{n-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{n-1}(x) \\frac{d}{dx}\\left[(1-x^2)P_{n-1}'(x)\\right] \\,dx\n$$\nThe boundary term vanishes because the factor $(1-x^2)$ is zero at $x=\\pm 1$. The integral becomes:\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ (1-x^2)P_{n-1}''(x) - 2xP_{n-1}'(x) \\right] \\,dx\n$$\nUsing the identity derived from the Legendre differential equation, we substitute the term in the brackets:\n$$\nI = - \\int_{-1}^{1} P_{n-1}(x) \\left[ -n(n-1)P_{n-1}(x) \\right] \\,dx = n(n-1) \\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx\n$$\nThe orthogonality property of Legendre polynomials (with standard normalization $P_k(1)=1$) is $\\int_{-1}^{1} [P_k(x)]^2 \\, dx = \\frac{2}{2k+1}$. For $k=n-1$, this gives:\n$$\n\\int_{-1}^{1} [P_{n-1}(x)]^2 \\,dx = \\frac{2}{2(n-1)+1} = \\frac{2}{2n-1}\n$$\nSubstituting this result back into the expression for $I$, we obtain the exact value of the integral:\n$$\nI = n(n-1) \\left(\\frac{2}{2n-1}\\right) = \\frac{2n(n-1)}{2n-1}\n$$\n\nFourth, we explain why the Gauss-Radau rule is exact for this integral while the Gauss-Lobatto rule is not.\nThe integrand is $q_n(x) = (1-x^2)(P_{n-1}'(x))^2$. The polynomial $P_{n-1}(x)$ has degree $n-1$, so its derivative $P_{n-1}'(x)$ has degree $n-2$. The square, $(P_{n-1}'(x))^2$, has degree $2(n-2) = 2n-4$. Multiplying by $(1-x^2)$, which has degree $2$, we find that the total degree of the polynomial $q_n(x)$ is $(2n-4) + 2 = 2n-2$.\n\n- The $n$-point Gauss-Radau rule has a degree of exactness of $2n-2$. Since the degree of the integrand $q_n(x)$ is exactly $2n-2$, the Gauss-Radau rule integrates this polynomial without error.\n\n- The $n$-point Gauss-Lobatto rule has a degree of exactness of $2n-3$. The degree of the integrand $q_n(x)$ is $2n-2$, which is one greater than the degree of exactness of the rule ($2n-2 > 2n-3$). Therefore, this rule is not guaranteed to be exact for $q_n(x)$. We have already shown that the Gauss-Lobatto approximation yields $0$, while the exact integral is $\\frac{2n(n-1)}{2n-1}$. For any integer $n \\ge 2$, this exact value is non-zero. For example, for $n=2$, the value is $\\frac{2(2)(1)}{3} = \\frac{4}{3}$. Thus, the Gauss-Lobatto rule is demonstrably not exact. The fact that the integrand vanishes at all quadrature nodes is a specific property for this particular polynomial which leads to a zero result, but this is a coincidence of structure, not a general condition for exactness. The error term for Gauss-Lobatto quadrature is proportional to the $(2n-2)$-th derivative of the integrand, which for the polynomial $q_n(x)$ is a non-zero constant, confirming that an error is expected and incurred.", "answer": "$$\\boxed{\\frac{2n(n-1)}{2n-1}}$$", "id": "2591954"}]}