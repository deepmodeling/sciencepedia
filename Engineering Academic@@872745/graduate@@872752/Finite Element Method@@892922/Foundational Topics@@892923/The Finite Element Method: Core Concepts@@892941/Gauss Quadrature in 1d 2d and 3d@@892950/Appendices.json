{"hands_on_practices": [{"introduction": "Before applying Gauss quadrature in complex finite element models, it is crucial to understand how the rules are constructed from fundamental principles. This foundational exercise guides you through the explicit derivation of the nodes and weights for the classic 2-point and 3-point Gauss-Legendre rules. By working from the properties of Legendre polynomials, you will gain a deeper appreciation for the mathematical underpinnings of this powerful numerical tool. [@problem_id:2562003]", "problem": "In the context of numerical integration on the reference interval $[-1,1]$ for the finite element method (FEM, Finite Element Method), consider Gauss–Legendre quadrature rules with respect to the unit weight. Let $(x_{i},w_{i})$ denote the nodes and weights of an $m$-point Gauss–Legendre rule on $[-1,1]$, so that the quadrature approximates $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x$ by $\\sum_{i=1}^{m} w_{i} f(x_{i})$. Use only the following foundational facts: (i) the Legendre polynomials $\\{P_{n}\\}_{n\\ge 0}$ are orthogonal on $[-1,1]$ with respect to the unit weight, specifically $\\int_{-1}^{1} P_{n}(x) P_{m}(x)\\,\\mathrm{d}x = \\frac{2}{2n+1}\\delta_{nm}$, (ii) Rodrigues’ formula $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$, and (iii) the Gauss–Legendre nodes are the roots of $P_{m}(x)$ and the weights are determined by enforcing exactness for polynomials up to degree $2m-1$. Derive explicitly the nodes and weights for the two-point rule ($m=2$) and the three-point rule ($m=3$) on $[-1,1]$ by:\n- forming and solving $P_{2}(x)=0$ and $P_{3}(x)=0$ to obtain the nodes,\n- enforcing the exactness of the quadrature for monomials $x^{k}$ with $k$ up to $2m-1$ to solve for the weights, using symmetry as appropriate and the exact monomial integrals $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x$.\n\nReport your final result as a single row matrix that concatenates, in the following order, the nodes and weights of the two-point rule (nodes in strictly increasing order, followed by the corresponding weights) and then the nodes and weights of the three-point rule (again nodes in strictly increasing order, followed by the corresponding weights). Concretely, the row must be\n$$\n\\bigl(x_{1}^{(2)},\\,x_{2}^{(2)},\\,w_{1}^{(2)},\\,w_{2}^{(2)},\\,x_{1}^{(3)},\\,x_{2}^{(3)},\\,x_{3}^{(3)},\\,w_{1}^{(3)},\\,w_{2}^{(3)},\\,w_{3}^{(3)}\\bigr),\n$$\nwhere the superscript indicates the rule size $m$. Do not approximate; provide exact radicals and rational numbers. The final answer must be given exactly as a single row matrix with the entries in the specified order and no units.", "solution": "The problem statement is a well-defined exercise in numerical analysis, specifically the derivation of Gauss-Legendre quadrature rules. It is scientifically grounded, self-contained, and objective. All provided information, including the foundational properties of Legendre polynomials and the definition of the quadrature method, is standard and correct. The problem is therefore valid, and I will proceed with the derivation as instructed.\n\nThe objective is to derive the nodes $x_i$ and weights $w_i$ for the $m=2$-point and $m=3$-point Gauss-Legendre quadrature rules on the interval $[-1, 1]$. The quadrature approximation is given by $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{i=1}^{m} w_{i} f(x_{i})$.\n\nThe procedure is as follows:\n$1$. For each rule of size $m$, find the Legendre polynomial $P_m(x)$ using Rodrigues’ formula: $P_{n}(x)=\\frac{1}{2^{n} n!}\\frac{\\mathrm{d}^{n}}{\\mathrm{d}x^{n}}\\bigl[(x^{2}-1)^{n}\\bigr]$.\n$2$. Determine the quadrature nodes, which are the roots of the equation $P_m(x)=0$.\n$3$. Determine the quadrature weights by constructing a system of linear equations that enforces the exactness of the quadrature rule for monomials $x^k$ for $k=0, 1, \\dots, 2m-1$. The exact integral of a monomial is $\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x = \\frac{1-(-1)^{k+1}}{k+1}$, which is $\\frac{2}{k+1}$ for even $k$ and $0$ for odd $k$.\n\n**Part 1: Two-Point Gauss-Legendre Quadrature ($m=2$)**\n\nFirst, we find the Legendre polynomial $P_2(x)$. Using Rodrigues' formula for $n=2$:\n$$\nP_{2}(x) = \\frac{1}{2^{2} 2!} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}\\bigl[(x^{2}-1)^{2}\\bigr] = \\frac{1}{8} \\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1)\n$$\nTaking the derivatives:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{4} - 2x^{2} + 1) = 4x^{3} - 4x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{4} - 2x^{2} + 1) = \\frac{\\mathrm{d}}{\\mathrm{d}x}(4x^{3} - 4x) = 12x^{2} - 4\n$$\nSubstituting this back into the formula for $P_2(x)$:\n$$\nP_{2}(x) = \\frac{1}{8}(12x^{2} - 4) = \\frac{1}{2}(3x^{2} - 1)\n$$\nThe quadrature nodes $x_{1}^{(2)}, x_{2}^{(2)}$ are the roots of $P_2(x)=0$:\n$$\n\\frac{1}{2}(3x^{2} - 1) = 0 \\implies 3x^{2} = 1 \\implies x^{2} = \\frac{1}{3}\n$$\nThe nodes, in increasing order, are:\n$$\nx_{1}^{(2)} = -\\frac{1}{\\sqrt{3}} = -\\frac{\\sqrt{3}}{3} \\quad \\text{and} \\quad x_{2}^{(2)} = \\frac{1}{\\sqrt{3}} = \\frac{\\sqrt{3}}{3}\n$$\nNext, we find the weights $w_{1}^{(2)}, w_{2}^{(2)}$. The $2$-point rule is exact for all polynomials of degree up to $2m-1 = 2(2)-1 = 3$. We enforce this condition using a basis of monomials.\nFor $f(x)=x^0=1$:\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(2)}f(x_{1}^{(2)}) + w_{2}^{(2)}f(x_{2}^{(2)}) = w_{1}^{(2)}(1) + w_{2}^{(2)}(1) = w_{1}^{(2)} + w_{2}^{(2)} = 2\n$$\nFor $f(x)=x^1=x$:\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(2)}x_{1}^{(2)} + w_{2}^{(2)}x_{2}^{(2)} = w_{1}^{(2)}\\left(-\\frac{\\sqrt{3}}{3}\\right) + w_{2}^{(2)}\\left(\\frac{\\sqrt{3}}{3}\\right) = 0\n$$\nFrom the second equation, we get $\\frac{\\sqrt{3}}{3}(-w_{1}^{(2)} + w_{2}^{(2)}) = 0$, which implies $w_{1}^{(2)} = w_{2}^{(2)}$. This is expected due to the symmetry of the nodes about $x=0$.\nSubstituting $w_{1}^{(2)} = w_{2}^{(2)}$ into the first equation:\n$$\nw_{1}^{(2)} + w_{1}^{(2)} = 2w_{1}^{(2)} = 2 \\implies w_{1}^{(2)} = 1\n$$\nThus, the weights are $w_{1}^{(2)} = 1$ and $w_{2}^{(2)} = 1$.\n\n**Part 2: Three-Point Gauss-Legendre Quadrature ($m=3$)**\n\nFirst, we find the Legendre polynomial $P_3(x)$. Using Rodrigues' formula for $n=3$:\n$$\nP_{3}(x) = \\frac{1}{2^{3} 3!} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}\\bigl[(x^{2}-1)^{3}\\bigr] = \\frac{1}{48} \\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1)\n$$\nTaking the derivatives:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}(x^{6} - 3x^{4} + 3x^{2} - 1) = 6x^{5} - 12x^{3} + 6x\n$$\n$$\n\\frac{\\mathrm{d}^{2}}{\\mathrm{d}x^{2}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 30x^{4} - 36x^{2} + 6\n$$\n$$\n\\frac{\\mathrm{d}^{3}}{\\mathrm{d}x^{3}}(x^{6} - 3x^{4} + 3x^{2} - 1) = 120x^{3} - 72x\n$$\nSubstituting this back into the formula for $P_3(x)$:\n$$\nP_{3}(x) = \\frac{1}{48}(120x^{3} - 72x) = \\frac{24}{48}(5x^{3} - 3x) = \\frac{1}{2}(5x^{3} - 3x)\n$$\nThe quadrature nodes $x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}$ are the roots of $P_3(x)=0$:\n$$\n\\frac{1}{2}(5x^{3} - 3x) = 0 \\implies x(5x^{2} - 3) = 0\n$$\nThe roots are $x=0$ and $5x^2 = 3 \\implies x^2 = \\frac{3}{5}$. The nodes, in increasing order, are:\n$$\nx_{1}^{(3)} = -\\sqrt{\\frac{3}{5}} = -\\frac{\\sqrt{15}}{5}, \\quad x_{2}^{(3)} = 0, \\quad x_{3}^{(3)} = \\sqrt{\\frac{3}{5}} = \\frac{\\sqrt{15}}{5}\n$$\nNext, we find the weights $w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)}$. The $3$-point rule is exact for all polynomials of degree up to $2m-1 = 2(3)-1 = 5$.\nFor $f(x)=x^0=1$:\n$$\n\\int_{-1}^{1} 1\\,\\mathrm{d}x = 2 \\quad \\Rightarrow \\quad w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2\n$$\nFor $f(x)=x^1=x$:\n$$\n\\int_{-1}^{1} x\\,\\mathrm{d}x = 0 \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right) + w_{2}^{(3)}(0) + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right) = 0\n$$\nFrom the second equation, $\\sqrt{\\frac{3}{5}}(-w_{1}^{(3)} + w_{3}^{(3)}) = 0$, which implies $w_{1}^{(3)} = w_{3}^{(3)}$, as expected from symmetry.\nFor $f(x)=x^2$:\n$$\n\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\frac{2}{3} \\quad \\Rightarrow \\quad w_{1}^{(3)}\\left(-\\sqrt{\\frac{3}{5}}\\right)^{2} + w_{2}^{(3)}(0)^{2} + w_{3}^{(3)}\\left(\\sqrt{\\frac{3}{5}}\\right)^{2} = w_{1}^{(3)}\\left(\\frac{3}{5}\\right) + w_{3}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3}\n$$\nUsing $w_{1}^{(3)} = w_{3}^{(3)}$ in the third equation:\n$$\n2w_{1}^{(3)}\\left(\\frac{3}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)}\\left(\\frac{6}{5}\\right) = \\frac{2}{3} \\implies w_{1}^{(3)} = \\frac{2}{3} \\cdot \\frac{5}{6} = \\frac{10}{18} = \\frac{5}{9}\n$$\nSo, $w_{1}^{(3)} = w_{3}^{(3)} = \\frac{5}{9}$.\nFinally, using the first equation, $w_{1}^{(3)} + w_{2}^{(3)} + w_{3}^{(3)} = 2w_{1}^{(3)} + w_{2}^{(3)} = 2$:\n$$\n2\\left(\\frac{5}{9}\\right) + w_{2}^{(3)} = 2 \\implies \\frac{10}{9} + w_{2}^{(3)} = 2 \\implies w_{2}^{(3)} = 2 - \\frac{10}{9} = \\frac{18-10}{9} = \\frac{8}{9}\n$$\nThus, the weights are $w_{1}^{(3)} = \\frac{5}{9}$, $w_{2}^{(3)} = \\frac{8}{9}$, and $w_{3}^{(3)} = \\frac{5}{9}$.\n\nWe assemble the results into the required row matrix:\n$$\n(x_{1}^{(2)}, x_{2}^{(2)}, w_{1}^{(2)}, w_{2}^{(2)}, x_{1}^{(3)}, x_{2}^{(3)}, x_{3}^{(3)}, w_{1}^{(3)}, w_{2}^{(3)}, w_{3}^{(3)})\n$$\nSubstituting the derived values with rationalized denominators:\n$$\n\\left(-\\frac{\\sqrt{3}}{3}, \\frac{\\sqrt{3}}{3}, 1, 1, -\\frac{\\sqrt{15}}{5}, 0, \\frac{\\sqrt{15}}{5}, \\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\right)\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\sqrt{3}}{3} & \\frac{\\sqrt{3}}{3} & 1 & 1 & -\\frac{\\sqrt{15}}{5} & 0 & \\frac{\\sqrt{15}}{5} & \\frac{5}{9} & \\frac{8}{9} & \\frac{5}{9}\n\\end{pmatrix}\n}\n$$", "id": "2562003"}, {"introduction": "Moving from theory to a core application, this practice examines the practical implications of Gauss quadrature within the finite element method. We will analyze the conditions under which a standard $2 \\times 2$ rule can exactly integrate the consistent mass matrix for a bilinear quadrilateral element, a critical consideration for accuracy and efficiency. This exercise highlights how the element's geometric mapping, captured by the Jacobian determinant $J$, dictates the required quadrature order. [@problem_id:2561927]", "problem": "Consider a bilinear quadrilateral finite element defined on the reference square $\\hat{K}=[-1,1]\\times[-1,1]$ with standard bilinear shape functions $N_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_{2}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_{3}(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, and $N_{4}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$. The consistent mass matrix entry is\n$$\nM_{ij}=\\int_{\\hat{K}} N_{i}(\\xi,\\eta)\\,N_{j}(\\xi,\\eta)\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\nwhere $J(\\xi,\\eta)$ is the determinant of the Jacobian of the isoparametric mapping. The integral is to be evaluated by the tensor-product Gauss–Legendre quadrature with $2\\times 2$ points on $\\hat{K}$.\n\nStarting only from the basic property that the $2$-point Gauss–Legendre rule in one dimension is exact for univariate polynomials of degree at most $3$, analyze the polynomial degree structure of the integrand $N_{i}N_{j}J$ and determine whether the $2\\times 2$ rule is exact for all entries $M_{ij}$. State the necessary and sufficient condition on $J(\\xi,\\eta)$ for exactness and justify your conclusion by degree tracking.\n\nThen, as a concrete quantitative check of your conclusion, suppose that\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2},\n$$\nwith $\\alpha,\\beta,\\gamma,\\delta,\\varepsilon\\in\\mathbb{R}$ and where $\\varepsilon$ is a small parameter representing a quadratic perturbation in the $\\xi$-direction. For the $(1,1)$ mass entry $M_{11}$, compute the quadrature error\n$$\nE(\\varepsilon)=\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,J(\\xi,\\eta)\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,J(\\xi_{i},\\eta_{j}),\n$$\nwhere $(\\xi_{i},w_{i})$ and $(\\eta_{j},w_{j})$ are the standard $2$-point Gauss–Legendre nodes and weights on $[-1,1]$ in each coordinate. Express your final answer as a closed-form analytic expression in terms of $\\varepsilon$ only. No rounding is required, and no physical units are involved. Provide only this final expression as your answer.", "solution": "We begin with the standard bilinear shape functions on the reference square $\\hat{K}=[-1,1]^{2}$. Each $N_{i}(\\xi,\\eta)$ is a product of linear factors in $\\xi$ and $\\eta$, hence is a bivariate polynomial that is of degree at most $1$ in $\\xi$ and at most $1$ in $\\eta$. Therefore, for any indices $i,j\\in\\{1,2,3,4\\}$, the product $N_{i}N_{j}$ is a bivariate polynomial that is of degree at most $2$ in $\\xi$ and at most $2$ in $\\eta$.\n\nThe $2$-point Gauss–Legendre rule on $[-1,1]$ is exact for univariate polynomials of degree at most $3$. The tensor-product $2\\times 2$ rule on $\\hat{K}$ results from applying the one-dimensional rule in each coordinate and is exact for any bivariate polynomial that is a finite linear combination of separable monomials $\\xi^{p}\\eta^{q}$ with $p\\leq 3$ and $q\\leq 3$. Thus, the $2\\times 2$ rule exactly integrates any integrand whose degree in each variable does not exceed $3$.\n\nThe mass-matrix integrand is $N_{i}N_{j}J$. If $J(\\xi,\\eta)$ is a polynomial that is at most degree $1$ in $\\xi$ and at most degree $1$ in $\\eta$ (that is, $J$ is bilinear: $J(\\xi,\\eta)=a_{0}+a_{1}\\xi+a_{2}\\eta+a_{3}\\xi\\eta$), then $N_{i}N_{j}J$ is at most degree $3$ in each variable, because multiplying a degree-$\\leq 2$ bivariate polynomial by a degree-$\\leq 1$ bivariate polynomial yields a degree-$\\leq 3$ bivariate polynomial in each variable separately. Hence, under the condition that $J$ is bilinear (which includes the special affine case where $J$ is constant), the $2\\times 2$ Gauss rule is exact for all entries $M_{ij}$.\n\nConversely, if $J$ contains any terms of degree $\\geq 2$ in either variable, then $N_{i}N_{j}J$ can contain monomials with degree $\\geq 4$ in that variable, and the $2\\times 2$ Gauss rule need not be exact. Therefore, a necessary and sufficient condition for exactness of the $2\\times 2$ rule for all entries $M_{ij}$ is that $J(\\xi,\\eta)$ be bilinear, i.e., of degree at most $1$ in each variable.\n\nWe now compute a quantitative error for a specific perturbation. Let\n$$\nJ(\\xi,\\eta)=\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta+\\delta\\,\\xi\\eta+\\varepsilon\\,\\xi^{2}.\n$$\nFor the $(1,1)$ entry, the integrand is $N_{1}^{2}J$. The $2\\times 2$ rule is exact on the bilinear part $\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta$, so the quadrature error arises solely from the quadratic perturbation $\\varepsilon\\,\\xi^{2}$. Thus\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\iint_{\\hat{K}} N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}\\,d\\xi\\,d\\eta\\;-\\;\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,N_{1}(\\xi_{i},\\eta_{j})^{2}\\,\\xi_{i}^{2}\\right).\n$$\nWe compute both the exact integral and the $2\\times 2$ quadrature of $f(\\xi,\\eta)=N_{1}(\\xi,\\eta)^{2}\\,\\xi^{2}$.\n\nFirst, write\n$$\nN_{1}(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)=\\frac{1}{4}\\left(1-\\xi-\\eta+\\xi\\eta\\right),\n$$\nso\n$$\nN_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}.\n$$\nExpanding the square gives\n$$\n\\left(1-\\xi-\\eta+\\xi\\eta\\right)^{2}=1+\\xi^{2}+\\eta^{2}+\\xi^{2}\\eta^{2}-2\\xi-2\\eta+4\\xi\\eta-2\\xi^{2}\\eta-2\\xi\\eta^{2}.\n$$\nTherefore,\n$$\nf(\\xi,\\eta)=\\xi^{2}N_{1}(\\xi,\\eta)^{2}=\\frac{1}{16}\\Big(\\xi^{2}+\\xi^{4}+\\xi^{2}\\eta^{2}+\\xi^{4}\\eta^{2}-2\\xi^{3}-2\\xi^{2}\\eta+4\\xi^{3}\\eta-2\\xi^{4}\\eta-2\\xi^{3}\\eta^{2}\\Big).\n$$\n\nExact integral. Because $\\hat{K}$ is a product domain and the integrand is a sum of separable monomials, we use $\\int_{-1}^{1}\\xi^{n}\\,d\\xi=0$ for odd $n$ and $\\int_{-1}^{1}\\xi^{0}\\,d\\xi=2$, $\\int_{-1}^{1}\\xi^{2}\\,d\\xi=\\frac{2}{3}$, $\\int_{-1}^{1}\\xi^{4}\\,d\\xi=\\frac{2}{5}$. All monomials with an odd power in either variable integrate to zero. The surviving terms are\n$$\n\\iint_{\\hat{K}} f(\\xi,\\eta)\\,d\\xi\\,d\\eta=\\frac{1}{16}\\left(\\frac{4}{3}+\\frac{4}{5}+\\frac{4}{9}+\\frac{4}{15}\\right)=\\frac{1}{4}\\left(\\frac{1}{3}+\\frac{1}{5}+\\frac{1}{9}+\\frac{1}{15}\\right)=\\frac{8}{45}.\n$$\n\n$2\\times 2$ Gauss–Legendre quadrature. The one-dimensional $2$-point Gauss–Legendre rule on $[-1,1]$ has nodes $\\pm a$ with $a=\\frac{1}{\\sqrt{3}}$ and weights $1$. The tensor-product rule on $\\hat{K}$ uses the four nodes $(\\pm a,\\pm a)$ with weights $1$. Because $f$ factors as\n$$\nf(\\xi,\\eta)=\\frac{1}{16}\\big[\\xi^{2}(1-\\xi)^{2}\\big]\\big[(1-\\eta)^{2}\\big],\n$$\nthe quadrature sum factorizes:\n$$\n\\sum_{i=1}^{2}\\sum_{j=1}^{2} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\left(\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}\\right)\\left(\\sum_{\\eta=\\pm a}(1-\\eta)^{2}\\right).\n$$\nCompute\n$$\n\\sum_{\\xi=\\pm a}\\xi^{2}(1-\\xi)^{2}=a^{2}\\big[(1-a)^{2}+(1+a)^{2}\\big]=2a^{2}(1+a^{2}),\n$$\n$$\n\\sum_{\\eta=\\pm a}(1-\\eta)^{2}=(1-a)^{2}+(1+a)^{2}=2(1+a^{2}),\n$$\nso\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{16}\\cdot 2a^{2}(1+a^{2})\\cdot 2(1+a^{2})=\\frac{1}{4}a^{2}(1+a^{2})^{2}.\n$$\nWith $a^{2}=\\frac{1}{3}$, we get\n$$\n\\sum_{i,j} w_{i}w_{j}\\,f(\\xi_{i},\\eta_{j})=\\frac{1}{4}\\cdot\\frac{1}{3}\\cdot\\left(1+\\frac{1}{3}\\right)^{2}=\\frac{1}{12}\\cdot\\frac{16}{9}=\\frac{4}{27}.\n$$\n\nTherefore, the quadrature error is\n$$\nE(\\varepsilon)=\\varepsilon\\left(\\frac{8}{45}-\\frac{4}{27}\\right)=\\varepsilon\\left(\\frac{24}{135}-\\frac{20}{135}\\right)=\\varepsilon\\cdot\\frac{4}{135}.\n$$\nThis expression depends only on $\\varepsilon$, as required. The sign is positive, indicating that the exact integral exceeds the $2\\times 2$ Gauss approximation for this perturbation.\n\nIn summary: the tensor-product $2\\times 2$ Gauss rule exactly integrates $M_{ij}$ if and only if $J(\\xi,\\eta)$ is bilinear (degree at most $1$ in each variable). For the specific perturbation $J(\\xi,\\eta)=\\alpha+\\beta\\xi+\\gamma\\eta+\\delta\\xi\\eta+\\varepsilon\\xi^{2}$, the quadrature error for $M_{11}$ is $E(\\varepsilon)=\\frac{4}{135}\\varepsilon$.", "answer": "$$\\boxed{\\frac{4}{135}\\,\\varepsilon}$$", "id": "2561927"}, {"introduction": "This advanced practice explores the deliberate use of 'reduced integration', a powerful technique in FEM for avoiding locking phenomena and improving element performance, particularly in elasticity problems. We will investigate the rank deficiency and resulting 'hourglass' instabilities that arise from using a single-point quadrature on a bilinear element. You will then derive a stabilization scheme to restore the element stiffness matrix's rank, illustrating the sophisticated trade-offs managed by computational engineers. [@problem_id:2561940]", "problem": "Consider a single, isoparametric, four-node bilinear quadrilateral finite element that maps the reference square $\\{(\\xi,\\eta)\\in[-1,1]^2\\}$ to the unit square in physical coordinates $\\{(x,y)\\in[0,1]^2\\}$ via the affine map $x=(\\xi+1)/2$, $y=(\\eta+1)/2$. Assume plane strain linear elasticity with Lamé parameters $\\lambda>0$ and $\\mu>0$, and unit thickness. Let the degrees of freedom (DOF) vector be ordered as $[u_1,v_1,u_2,v_2,u_3,v_3,u_4,v_4]^{\\top}$, where $(u_i,v_i)$ are the nodal displacement components.\n\nYou will approximate the element stiffness by one-point reduced Gauss quadrature at the element center $(\\xi,\\eta)=(0,0)$ and then augment it with a rank-two stabilization that targets the hourglass modes. Use only the following foundational facts:\n\n- The bilinear shape functions on $[-1,1]^2$ are $N_1(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta)=\\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta)=\\frac{1}{4}(1-\\xi)(1+\\eta)$, and their physical derivatives satisfy $\\partial/\\partial x = 2\\,\\partial/\\partial \\xi$ and $\\partial/\\partial y = 2\\,\\partial/\\partial \\eta$ for this affine mapping.\n- The strain-displacement matrix at a point, denoted $B(\\xi,\\eta)$, for plane strain is assembled from the shape function derivatives via blocks $B_i=\\begin{bmatrix}N_{i,x} & 0\\\\ 0 & N_{i,y}\\\\ N_{i,y}&N_{i,x}\\end{bmatrix}$, $i=1,\\dots,4$.\n- The plane strain constitutive tensor is $D=\\begin{bmatrix}\\lambda+2\\mu & \\lambda & 0\\\\ \\lambda & \\lambda+2\\mu & 0\\\\ 0 & 0 & \\mu\\end{bmatrix}$, positive definite for $\\lambda>0$, $\\mu>0$.\n- One-point product Gauss rule on $[-1,1]^2$ has the single point $(0,0)$ and weight $4$, and for the affine mapping above the Jacobian determinant is constant and equal to $1/4$.\n\nDefine the reduced-integration element stiffness as $K_{\\mathrm{RI}}=B_c^{\\top} D B_c$, where $B_c:=B(0,0)$. Define the rank-two stabilization using the canonical hourglass vectors\n$$\nh_1=\\begin{bmatrix}1\\\\0\\\\-1\\\\0\\\\1\\\\0\\\\-1\\\\0\\end{bmatrix},\\qquad\nh_2=\\begin{bmatrix}0\\\\1\\\\0\\\\-1\\\\0\\\\1\\\\0\\\\-1\\end{bmatrix},\n$$\nand the stabilization matrix $K_{\\mathrm{stab}}=\\alpha\\,(h_1 h_1^{\\top}+h_2 h_2^{\\top})$ with scalar coefficient $\\alpha\\ge 0$. The total stabilized stiffness is $K_{\\mathrm{tot}}=K_{\\mathrm{RI}}+K_{\\mathrm{stab}}$.\n\nTasks:\n1. Using first principles, construct $B_c$ by differentiating the shape functions at the center, and show that $K_{\\mathrm{RI}}=B_c^{\\top} D B_c$ has rank three. Identify from this construction the three strictly positive eigenvalues of $K_{\\mathrm{RI}}$ in terms of $\\lambda$ and $\\mu$.\n2. Explain how adding $K_{\\mathrm{stab}}$ affects the rank of $K_{\\mathrm{tot}}$, and determine the two eigenvalues introduced by the stabilization along the hourglass directions.\n3. Impose the stability equalization condition that the smallest positive eigenvalue of $K_{\\mathrm{tot}}$ coincides with the smallest positive eigenvalue of $K_{\\mathrm{RI}}$. Under this condition, determine the value of $\\alpha$ in closed form in terms of $\\mu$.\n\nExpress your final answer as a single analytic expression for $\\alpha$ in terms of $\\mu$. No numerical evaluation is required, and no units are to be reported.", "solution": "The problem posed is a standard exercise in the finite element method concerning hourglass stabilization for underintegrated elements. It is scientifically grounded, mathematically well-posed, and contains all necessary information for its resolution. The problem is therefore deemed valid. We proceed with the solution by following the tasks outlined.\n\nThe core of the problem is to construct the element stiffness matrix for a four-node quadrilateral element under plane strain conditions, analyze its spectral properties when using one-point Gauss quadrature, and then determine the parameter for a stabilization scheme designed to correct the rank deficiency introduced by this reduced integration.\n\nFirst, we must construct the strain-displacement matrix $B$ evaluated at the element center, denoted $B_c$. The matrix $B$ relates the strain vector $\\varepsilon = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\top}$ to the nodal displacement vector $d = [u_1, v_1, \\dots, u_4, v_4]^{\\top}$. For a bilinear element, the displacement field $(u,v)$ is interpolated from nodal values using shape functions $N_i(\\xi, \\eta)$:\n$$\nu(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_i, \\qquad v(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) v_i\n$$\nThe strains are given by $\\varepsilon_{xx} = \\partial u / \\partial x$, $\\varepsilon_{yy} = \\partial v / \\partial y$, and $\\gamma_{xy} = \\partial u / \\partial y + \\partial v / \\partial x$. This leads to the matrix relation $\\varepsilon = B d$. The matrix $B$ is composed of block matrices $B_i$:\n$B(\\xi, \\eta) = [B_1(\\xi, \\eta), B_2(\\xi, \\eta), B_3(\\xi, \\eta), B_4(\\xi, \\eta)]$, where $B_i = \\begin{bmatrix}N_{i,x} & 0\\\\ 0 & N_{i,y}\\\\ N_{i,y}&N_{i,x}\\end{bmatrix}$.\n\nThe problem provides the affine mapping $x=(\\xi+1)/2$ and $y=(\\eta+1)/2$, for which the relation between physical and reference derivatives is $\\partial/\\partial x = 2\\,\\partial/\\partial\\xi$ and $\\partial/\\partial y = 2\\,\\partial/\\partial\\eta$. We compute the derivatives of the shape functions $N_i$ with respect to $\\xi$ and $\\eta$ and evaluate them at the center point $(\\xi,\\eta)=(0,0)$:\n$N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta) \\implies N_{1,\\xi}|_{(0,0)}=-\\frac{1}{4}, N_{1,\\eta}|_{(0,0)}=-\\frac{1}{4}$\n$N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta) \\implies N_{2,\\xi}|_{(0,0)}=\\frac{1}{4}, N_{2,\\eta}|_{(0,0)}=-\\frac{1}{4}$\n$N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta) \\implies N_{3,\\xi}|_{(0,0)}=\\frac{1}{4}, N_{3,\\eta}|_{(0,0)}=\\frac{1}{4}$\n$N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta) \\implies N_{4,\\xi}|_{(0,0)}=-\\frac{1}{4}, N_{4,\\eta}|_{(0,0)}=\\frac{1}{4}$\n\nThe physical derivatives at the center, denoted with a subscript $c$, are:\n$N_{i,x,c} = 2 N_{i,\\xi}|_{(0,0)}$ and $N_{i,y,c} = 2 N_{i,\\eta}|_{(0,0)}$.\nThis gives the vectors of derivatives:\n$[N_{1,x,c}, \\dots, N_{4,x,c}] = \\frac{1}{2}[-1, 1, 1, -1]$\n$[N_{1,y,c}, \\dots, N_{4,y,c}] = \\frac{1}{2}[-1, -1, 1, 1]$\n\nThe matrix $B_c = B(0,0)$ is a $3 \\times 8$ matrix constructed as:\n$$\nB_c = \\begin{bmatrix}\nN_{1,x,c} & 0 & N_{2,x,c} & 0 & N_{3,x,c} & 0 & N_{4,x,c} & 0 \\\\\n0 & N_{1,y,c} & 0 & N_{2,y,c} & 0 & N_{3,y,c} & 0 & N_{4,y,c} \\\\\nN_{1,y,c} & N_{1,x,c} & N_{2,y,c} & N_{2,x,c} & N_{3,y,c} & N_{3,x,c} & N_{4,y,c} & N_{4,x,c}\n\\end{bmatrix}\n$$\nSubstituting the computed values:\n$$\nB_c = \\frac{1}{2} \\begin{bmatrix}\n-1 & 0 & 1 & 0 & 1 & 0 & -1 & 0 \\\\\n0 & -1 & 0 & -1 & 0 & 1 & 0 & 1 \\\\\n-1 & -1 & -1 & 1 & 1 & 1 & 1 & -1\n\\end{bmatrix}\n$$\nTo determine the rank of $B_c$, we test for linear independence of its three rows, $b_1^{\\top}, b_2^{\\top}, b_3^{\\top}$. Assume a linear combination equals the zero vector: $c_1 b_1 + c_2 b_2 + c_3 b_3 = 0$. Examining the first component gives $-c_1 - c_3 = 0$, so $c_1=-c_3$. Examining the third component gives $c_1 - c_3 = 0$, so $c_1=c_3$. These two conditions together imply $c_1=c_3=0$. From the second component, $-c_2 - c_3 = 0$, which now gives $c_2=0$. Thus, the rows are linearly independent. The rank of $B_c$ is $3$.\nThe reduced-integration stiffness matrix is $K_{\\mathrm{RI}} = B_c^{\\top} D B_c$. Since $D$ is a $3 \\times 3$ positive definite matrix (and thus has rank $3$), the rank of $K_{\\mathrm{RI}}$ is equal to the rank of $B_c$, which is $3$. This demonstrates that the $8 \\times 8$ matrix $K_{\\mathrm{RI}}$ is rank-deficient, possessing a null space of dimension $8-3=5$. Three of these null modes are the physical rigid body motions, and the remaining two are non-physical zero-energy modes, known as hourglass modes.\n\nTo find the non-zero eigenvalues of $K_{\\mathrm{RI}}$, we can analyze the $3 \\times 3$ matrix $B_c B_c^{\\top}$ and then $D (B_c B_c^{\\top})$. The eigenvalues of $B_c^{\\top} D B_c$ are the eigenvalues of $(B_c B_c^{\\top}) D$ or $D(B_c B_c^{\\top})$. Let us compute $G = B_c B_c^{\\top}$. The entries $G_{ij}$ are the dot products of the rows of $B_c$:\n$G_{11} = b_1 \\cdot b_1 = (\\frac{1}{2})^2 ((-1)^2 + 1^2 + 1^2 + (-1)^2) = 1$.\n$G_{22} = b_2 \\cdot b_2 = (\\frac{1}{2})^2 ((-1)^2 + (-1)^2 + 1^2 + 1^2) = 1$.\n$G_{33} = b_3 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)^2 + (-1)^2 + (-1)^2 + 1^2 + 1^2 + 1^2 + 1^2 + (-1)^2) = 2$.\n$G_{12} = b_1 \\cdot b_2 = (\\frac{1}{2})^2 (0) = 0$.\n$G_{13} = b_1 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)(-1) + 1(-1) + 1(1) + (-1)(1)) = 0$.\n$G_{23} = b_2 \\cdot b_3 = (\\frac{1}{2})^2 ((-1)(-1) + (-1)(1) + 1(1) + 1(-1)) = 0$.\nThus, the matrix $G$ is diagonal:\n$$\nG = B_c B_c^{\\top} = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 2 \\end{bmatrix}\n$$\nThe non-zero eigenvalues of $K_{\\mathrm{RI}}$ are the eigenvalues of the matrix $H = D G$:\n$$\nH = \\begin{bmatrix}\\lambda+2\\mu & \\lambda & 0\\\\ \\lambda & \\lambda+2\\mu & 0\\\\ 0 & 0 & \\mu\\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 2 \\end{bmatrix} = \\begin{bmatrix}\\lambda+2\\mu & \\lambda & 0\\\\ \\lambda & \\lambda+2\\mu & 0\\\\ 0 & 0 & 2\\mu\\end{bmatrix}\n$$\nThe eigenvalues of $H$ are $2\\mu$ and the eigenvalues of the upper-left $2 \\times 2$ block, which are $(\\lambda+2\\mu) \\pm \\lambda$. This gives eigenvalues $2\\mu+2\\lambda$ and $2\\mu$. The three strictly positive eigenvalues of $K_{\\mathrm{RI}}$ are therefore $\\{2\\mu, 2\\mu, 2\\lambda+2\\mu\\}$.\n\nNext, we analyze the total stiffness $K_{\\mathrm{tot}} = K_{\\mathrm{RI}} + K_{\\mathrm{stab}}$. The stabilization matrix $K_{\\mathrm{stab}} = \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top})$ is constructed from the hourglass vectors $h_1$ and $h_2$. These vectors are shown to be in the null space of $B_c$ (and thus $K_{\\mathrm{RI}}$). For example, $b_1 \\cdot h_1 = \\frac{1}{2}(-1(1) + 1(-1) + 1(1) -1(-1))=0$, and similarly for all other products $b_i \\cdot h_j$. This means $K_{\\mathrm{RI}} h_1 = 0$ and $K_{\\mathrm{RI}} h_2 = 0$. The vectors $h_1$ and $h_2$ are orthogonal, as $h_1^{\\top} h_2 = 0$. Their squared norms are $h_1^{\\top} h_1 = 4$ and $h_2^{\\top} h_2 = 4$.\nThe vectors spanning the range of $K_{\\mathrm{RI}}$ are orthogonal to its null space, so they are orthogonal to $h_1$ and $h_2$. Consequently, the eigenspaces of $K_{\\mathrm{RI}}$ and $K_{\\mathrm{stab}}$ are orthogonal.\nThe eigenvectors of $K_{\\mathrm{tot}}$ are either the eigenvectors of $K_{\\mathrm{RI}}$ or the eigenvectors of $K_{\\mathrm{stab}}$.\nThe three eigenvectors of $K_{\\mathrm{RI}}$ corresponding to its positive eigenvalues remain eigenvectors of $K_{\\mathrm{tot}}$ with the same eigenvalues.\nThe vectors $h_1$ and $h_2$ are eigenvectors of $K_{\\mathrm{tot}}$:\n$K_{\\mathrm{tot}} h_1 = K_{\\mathrm{RI}} h_1 + \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top}) h_1 = 0 + \\alpha(h_1 (h_1^{\\top} h_1)) = 4\\alpha h_1$.\n$K_{\\mathrm{tot}} h_2 = K_{\\mathrm{RI}} h_2 + \\alpha(h_1 h_1^{\\top} + h_2 h_2^{\\top}) h_2 = 0 + \\alpha(h_2 (h_2^{\\top} h_2)) = 4\\alpha h_2$.\nSo, the stabilization introduces two eigenvalues, both equal to $4\\alpha$.\nThe rank of $K_{\\mathrm{tot}}$ is the sum of the ranks of $K_{\\mathrm{RI}}$ and $K_{\\mathrm{stab}}$, so $\\mathrm{rank}(K_{\\mathrm{tot}}) = 3+2=5$. The null space of $K_{\\mathrm{tot}}$ has dimension $3$ and is spanned by the three rigid body modes, which are in the null space of both $K_{\\mathrm{RI}}$ and $K_{\\mathrm{stab}}$.\n\nFinally, we must determine $\\alpha$. The list of positive eigenvalues of $K_{\\mathrm{tot}}$ is $\\{2\\mu, 2\\mu, 2\\lambda+2\\mu, 4\\alpha, 4\\alpha\\}$. The smallest positive eigenvalue of $K_{\\mathrm{RI}}$ is $2\\mu$ (since $\\lambda>0, \\mu>0$). The problem states a \"stability equalization condition\" where the smallest positive eigenvalue of $K_{\\mathrm{tot}}$ coincides with this value. The smallest positive eigenvalue of $K_{\\mathrm{tot}}$ is $\\min(2\\mu, 4\\alpha)$. The condition $\\min(2\\mu, 4\\alpha) = 2\\mu$ is satisfied for any $4\\alpha \\ge 2\\mu$. However, the term \"equalization condition\" in this context has a standard, precise meaning: the stabilization parameter is chosen to make the stiffness of the spurious modes equal to the stiffness of the softest physical mode of the element. This removes the ambiguity and provides a unique value for $\\alpha$. We therefore set the eigenvalue corresponding to the hourglass modes equal to the smallest physical eigenvalue:\n$$\n4\\alpha = 2\\mu\n$$\nSolving for $\\alpha$ gives the required value:\n$$\n\\alpha = \\frac{2\\mu}{4} = \\frac{\\mu}{2}\n$$\nThis choice ensures that the spurious modes are penalized with a stiffness that is on the same order as the element's softest deformation mode, which is a desirable property for a stable and accurate numerical scheme.", "answer": "$$\n\\boxed{\\frac{\\mu}{2}}\n$$", "id": "2561940"}]}