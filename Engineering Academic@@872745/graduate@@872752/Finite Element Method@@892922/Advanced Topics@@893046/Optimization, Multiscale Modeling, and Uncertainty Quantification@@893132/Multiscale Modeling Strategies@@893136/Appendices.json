{"hands_on_practices": [{"introduction": "Understanding multiscale modeling begins with the core concept of homogenization, where the complex behavior of a heterogeneous material is captured by simpler, effective properties at the macroscopic scale. This first exercise provides a concrete, analytical entry point into this idea. By deriving the homogenized conductivity for a simple one-dimensional layered material, you will practice applying the principles of periodic homogenization and see firsthand how the effective property—in this case, the harmonic mean of the layer conductivities—emerges from the underlying microstructural arrangement [@problem_id:2581861].", "problem": "Consider the one-dimensional stationary diffusion problem for a heterogeneous medium with rapidly oscillating conductivity,\n$$-\\,\\frac{d}{dx}\\Big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\frac{du^{\\varepsilon}}{dx}(x)\\Big) \\;=\\; 0 \\quad \\text{in } (0,L),$$\nwith Dirichlet boundary conditions $u^{\\varepsilon}(0)=0$ and $u^{\\varepsilon}(L)=U$, where $\\varepsilon>0$ denotes the microscale and $A(y)$ is a positive, $Y$-periodic function with $Y=(0,1)$. Assume that $A(y)$ is piecewise constant over $m$ layers within one period: there exist conductivities $\\{k_i\\}_{i=1}^{m}$ and layer thickness fractions $\\{f_i\\}_{i=1}^{m}$ with $f_i>0$ and $\\sum_{i=1}^{m} f_i = 1$, such that $A(y)=k_i$ for $y$ in the $i$th layer interval of length $f_i$ within $Y$.\n\nUsing the periodic homogenization framework consistent with the Finite Element Heterogeneous Multiscale Method (FE-HMM) or the Multiscale Finite Element Method (MsFEM), the homogenized limit $u^{0}$ solves\n$$-\\,\\frac{d}{dx}\\!\\left(A^{\\text{hom}}\\frac{du^{0}}{dx}(x)\\right) \\;=\\; 0 \\quad \\text{in } (0,L),$$\nfor some effective conductivity $A^{\\text{hom}}>0$. Starting from the standard one-dimensional periodic cell problem on $Y$ associated with an imposed unit macroscopic gradient, derive a closed-form expression for $A^{\\text{hom}}$ in terms of $\\{k_i\\}_{i=1}^{m}$ and $\\{f_i\\}_{i=1}^{m}$. Your derivation must begin from the weak formulation and the cell problem definition and proceed by enforcing periodicity and flux continuity across layers. Provide your final result as a single analytical expression in terms of $\\{k_i\\}_{i=1}^{m}$ and $\\{f_i\\}_{i=1}^{m}$. No numerical substitution is required and no rounding is needed. Express your final answer without units.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard task in the theory of homogenization for periodic media, which is a core topic in multiscale modeling. All necessary data and conditions for the derivation of the effective conductivity are provided. The problem is valid. We will proceed with the derivation.\n\nThe objective is to determine the homogenized conductivity $A^{\\text{hom}}$ for the given one-dimensional stationary diffusion problem:\n$$-\\,\\frac{d}{dx}\\Big(A\\big(\\tfrac{x}{\\varepsilon}\\big)\\,\\frac{du^{\\varepsilon}}{dx}(x)\\Big) \\;=\\; 0 \\quad \\text{for } x \\in (0,L)$$\nwhere $A(y)$ is a $Y$-periodic function on the unit cell $Y=(0,1)$. The homogenized equation is given by:\n$$-\\,\\frac{d}{dx}\\!\\left(A^{\\text{hom}}\\frac{du^{0}}{dx}(x)\\right) \\;=\\; 0$$\n\nThe foundation of periodic homogenization is the two-scale asymptotic expansion of the solution $u^{\\varepsilon}(x)$. For the one-dimensional case, we seek an approximation of the form:\n$$ u^{\\varepsilon}(x) \\approx u^{0}(x) + \\varepsilon \\chi\\left(\\frac{x}{\\varepsilon}\\right) \\frac{du^0}{dx}(x) $$\nwhere $u^0(x)$ is the slowly-varying macroscopic solution, and $\\chi(y)$ is a $Y$-periodic function known as the periodic corrector, with $y=x/\\varepsilon$ being the fast (microscopic) variable. The corrector $\\chi(y)$ captures the microscopic oscillations of the solution within each periodic cell.\n\nThe problem requests a derivation starting from the cell problem for an imposed unit macroscopic gradient. A unit macroscopic gradient corresponds to setting $\\frac{du^0}{dx}(x) = 1$. The cell problem for the corrector $\\chi(y)$ is derived by substituting the two-scale expansion into the original differential equation and identifying terms at the order $\\varepsilon^{-1}$. In strong form, this yields the cell problem on $Y=(0,1)$:\n$$ -\\frac{d}{dy}\\left( A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) \\right) = 0 $$\nsubject to periodic boundary conditions on $\\chi(y)$, i.e., $\\chi(0) = \\chi(1)$. The term $1$ inside the parenthesis arises from the imposed unit macroscopic gradient.\n\nThis equation states that the microscopic flux, $j(y) = -A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right)$, is constant with respect to the microscopic variable $y$. Let us denote this constant flux as $j(y) = J$.\nThe homogenized coefficient $A^{\\text{hom}}$ is defined as the coefficient that relates the average flux to the average gradient. For a unit macroscopic gradient, the homogenized flux is $-A^{\\text{hom}}(1) = -A^{\\text{hom}}$. This must be equal to the average of the microscopic flux over the cell:\n$$ -A^{\\text{hom}} = \\langle j(y) \\rangle_Y = \\int_0^1 J \\, dy = J $$\nTherefore, the effective conductivity $A^{\\text{hom}}$ is precisely the negative of this constant microscopic flux, $A^{\\text{hom}} = -J$.\n\nFrom the definition of the microscopic flux, we have:\n$$ -A^{\\text{hom}} = -A(y) \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) $$\nwhich can be rearranged to express the gradient of the corrector:\n$$ 1 + \\frac{d\\chi}{dy}(y) = \\frac{A^{\\text{hom}}}{A(y)} $$\nTo find $A^{\\text{hom}}$, we integrate this expression over the unit cell $Y=(0,1)$:\n$$ \\int_0^1 \\left( 1 + \\frac{d\\chi}{dy}(y) \\right) dy = \\int_0^1 \\frac{A^{\\text{hom}}}{A(y)} dy $$\nThe integral on the left side is:\n$$ \\int_0^1 1 \\, dy + \\int_0^1 \\frac{d\\chi}{dy}(y) dy = 1 + \\big[\\chi(y)\\big]_0^1 = 1 + \\chi(1) - \\chi(0) $$\nDue to the periodicity of the corrector, $\\chi(1) = \\chi(0)$, this term simplifies to $1$.\nThe integral on the right side is:\n$$ \\int_0^1 \\frac{A^{\\text{hom}}}{A(y)} dy = A^{\\text{hom}} \\int_0^1 \\frac{1}{A(y)} dy $$\nEquating the two sides gives:\n$$ 1 = A^{\\text{hom}} \\int_0^1 \\frac{1}{A(y)} dy $$\nSolving for $A^{\\text{hom}}$, we obtain the general formula for the effective conductivity in one dimension, which is the harmonic average of the local conductivity:\n$$ A^{\\text{hom}} = \\left( \\int_0^1 \\frac{1}{A(y)} dy \\right)^{-1} $$\nThis result is physically expected for transport through layers in series, where the effective resistance is the sum of individual resistances.\n\nNow, we apply this formula to the specific case given, where the medium is composed of $m$ layers with conductivities $\\{k_i\\}_{i=1}^{m}$ and thickness fractions $\\{f_i\\}_{i=1}^{m}$ within the unit cell, such that $\\sum_{i=1}^{m} f_i = 1$. The integral over the cell becomes a sum over the layers:\n$$ \\int_0^1 \\frac{1}{A(y)} dy = \\sum_{i=1}^{m} \\int_{\\text{layer } i} \\frac{1}{k_i} dy $$\nThe integral of $\\frac{1}{k_i}$ over the $i$-th layer is simply $\\frac{1}{k_i}$ multiplied by the length of the interval for that layer, which is its thickness fraction $f_i$. Thus,\n$$ \\int_0^1 \\frac{1}{A(y)} dy = \\sum_{i=1}^{m} \\frac{f_i}{k_i} $$\nSubstituting this result back into the expression for $A^{\\text{hom}}$ yields the final closed-form expression:\n$$ A^{\\text{hom}} = \\left( \\sum_{i=1}^{m} \\frac{f_i}{k_i} \\right)^{-1} $$\nThis is the harmonic mean of the layer conductivities, weighted by their respective thickness fractions.", "answer": "$$\\boxed{\\left(\\sum_{i=1}^{m} \\frac{f_i}{k_i}\\right)^{-1}}$$", "id": "2581861"}, {"introduction": "While analytical homogenization is insightful, practical problems demand numerical methods capable of handling complex microstructures. The Multiscale Finite Element Method (MsFEM) is a powerful technique that achieves this by embedding microstructural information directly into the finite element basis functions. This exercise challenges you to construct these specialized basis functions for a 1D diffusion problem, providing a hands-on understanding of how MsFEM captures small-scale effects within a coarse-scale computational framework [@problem_id:2581803].", "problem": "Consider the one-dimensional steady diffusion problem on the domain $\\Omega = [0,1]$ with a rapidly oscillatory heterogeneous conductivity given by $a(x/\\epsilon)$, governed by the strong form $-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du}{dx}\\right)=0$ for $x\\in (0,1)$, subject to the Dirichlet boundary conditions $u(0)=1$ and $u(1)=0$. Assume nondimensionalization so that all quantities are dimensionless. The coefficient $a(y)$ is $1$-periodic in $y$ and is piecewise constant on each period: $a(y)=10$ for $y\\in[0,0.3)$ and $a(y)=1$ for $y\\in[0.3,1)$, extended periodically. Let the small scale be $\\epsilon=0.1$, so that the domain contains exactly $10$ micro-periods.\n\nUsing the Multiscale Finite Element Method (MsFEM), construct the element-level multiscale basis functions on the single coarse element $K=[0,1]$ by solving the homogeneous local problem on $K$ with appropriate nodal boundary conditions at $x=0$ and $x=1$. Your derivation must start from the governing differential equation and the requirement that the basis functions solve the corresponding homogeneous equation on $K$ with nodal boundary conditions. Then use these basis functions to define the MsFEM approximation $u_H(x)$ on $K$, with nodal values equal to the imposed Dirichlet boundary data.\n\nFinally, compute the corresponding MsFEM coarse-scale flux $q_H(x)=-a(x/\\epsilon)\\,u_H'(x)$ inside $K$ and report its constant value across the coarse element. Your final answer must be a single numerical value rounded to four significant figures, and because of the nondimensionalization, it must be expressed without units.", "solution": "The problem as stated will be validated before a solution is attempted.\n\nFirst, I extract the given information verbatim.\n- Governing Equation: $-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du}{dx}\\right)=0$ for $x\\in (0,1)$.\n- Domain: $\\Omega = [0,1]$.\n- Boundary Conditions: $u(0)=1$, $u(1)=0$.\n- Scale parameter: $\\epsilon=0.1$.\n- Heterogeneous conductivity coefficient: $a(y)$ is a $1$-periodic function where $y=x/\\epsilon$.\n- Definition of $a(y)$: $a(y)=10$ for $y\\in[0,0.3)$ and $a(y)=1$ for $y\\in[0.3,1)$, extended periodically.\n- Method: Multiscale Finite Element Method (MsFEM).\n- Coarse mesh: A single coarse element $K=[0,1]$.\n- Task: Construct element-level multiscale basis functions on $K$, construct the MsFEM approximation $u_H(x)$, and compute the constant coarse-scale flux $q_H(x)=-a(x/\\epsilon)\\,u_H'(x)$ on $K$.\n- Final answer format: A single numerical value rounded to four significant figures.\n\nNext, I validate the problem.\nThe problem is a standard, well-posed one-dimensional boundary value problem from the field of homogenization and multiscale numerical methods. The governing equation is a conservation law describing steady-state diffusion. The conductivity coefficient $a(x/\\epsilon)$ is strictly positive, ensuring physical and mathematical validity. The Multiscale Finite Element Method is a standard technique for such problems. The problem has sufficient data, is internally consistent, and is scientifically grounded. All terms are clearly defined. Therefore, the problem is valid and a solution will be provided.\n\nThe core principle of the Multiscale Finite Element Method (MsFEM) is to incorporate the small-scale information from the differential operator into the basis functions. For a given coarse element $K$, the multiscale basis functions $\\phi_i(x)$ are computed by solving the homogeneous version of the original differential equation on $K$, subject to boundary conditions that mimic standard finite element basis functions.\n\nIn this problem, we have a single coarse element $K=[0,1]$ with nodes at $x_1=0$ and $x_2=1$. The corresponding standard linear basis functions would be $N_1(x)=1-x$ and $N_2(x)=x$. The MsFEM basis functions, $\\phi_1(x)$ and $\\phi_2(x)$, must satisfy the local problem on $K$ with boundary conditions inherited from $N_1(x)$ and $N_2(x)$, respectively.\n\nLet us construct the first basis function, $\\phi_1(x)$. It is the solution to:\n$$-\\dfrac{d}{dx}\\!\\left(a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{d\\phi_1}{dx}\\right)=0 \\quad \\text{for } x \\in (0,1)$$\nwith boundary conditions $\\phi_1(0)=1$ and $\\phi_1(1)=0$.\n\nIntegrating the differential equation once yields:\n$$-a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{d\\phi_1}{dx} = C_1$$\nwhere $C_1$ is a constant of integration. This expression represents the flux associated with the basis function $\\phi_1(x)$. We can rearrange this to find the derivative:\n$$\\dfrac{d\\phi_1}{dx} = -\\dfrac{C_1}{a(x/\\epsilon)}$$\n\nIntegrating a second time with respect to $x$ from $0$ to $x'$ gives:\n$$\\int_0^{x'} \\dfrac{d\\phi_1}{dx} dx = \\phi_1(x') - \\phi_1(0) = -C_1 \\int_0^{x'} \\dfrac{1}{a(s/\\epsilon)} ds$$\nUsing the boundary condition $\\phi_1(0)=1$, we obtain the expression for $\\phi_1(x)$:\n$$\\phi_1(x) = 1 - C_1 \\int_0^x \\dfrac{1}{a(s/\\epsilon)} ds$$\n\nTo find the constant $C_1$, we apply the second boundary condition, $\\phi_1(1)=0$:\n$$0 = 1 - C_1 \\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds$$\nThus, $C_1$ is given by the inverse of the integral:\n$$C_1 = \\left( \\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds \\right)^{-1}$$\nThe integral is the average of the inverse conductivity, $a^{-1}$, over the domain $[0,1]$. Since the coefficient $a(x/\\epsilon)$ has a period of $\\epsilon=0.1$ and the domain length is $1$, the domain contains exactly $10$ periods. Therefore, we can compute the integral over one period and multiply by $10$.\n$$\\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds = 10 \\int_0^{0.1} \\dfrac{1}{a(s/0.1)} ds$$\nLet's perform a change of variables $y = s/\\epsilon = s/0.1$, so $ds = 0.1 dy$. The integration limits for one period in $s$ from $0$ to $0.1$ become limits in $y$ from $0$ to $1$.\n$$\\int_0^1 \\dfrac{1}{a(s/\\epsilon)} ds = 10 \\int_0^1 \\dfrac{1}{a(y)} (0.1 dy) = \\int_0^1 \\dfrac{1}{a(y)} dy$$\nThis integral is the harmonic average of the conductivity over a unit cell. We compute it using the piecewise definition of $a(y)$:\n$$\\int_0^1 \\dfrac{1}{a(y)} dy = \\int_0^{0.3} \\dfrac{1}{10} dy + \\int_{0.3}^1 \\dfrac{1}{1} dy$$\n$$= \\dfrac{1}{10}[y]_0^{0.3} + [y]_{0.3}^1 = \\dfrac{1}{10}(0.3 - 0) + (1 - 0.3) = 0.03 + 0.7 = 0.73$$\nSo, the constant $C_1$ is:\n$$C_1 = \\dfrac{1}{0.73}$$\nThe basis function is fully defined as $\\phi_1(x) = 1 - \\frac{1}{0.73} \\int_0^x \\frac{1}{a(s/\\epsilon)} ds$. We do not need to construct $\\phi_2(x)$ explicitly for this problem, but it can be shown that $\\phi_2(x) = 1 - \\phi_1(x)$.\n\nThe MsFEM approximation $u_H(x)$ is constructed as a linear combination of the basis functions, with the coefficients being the nodal values of the solution. The nodal values are given by the Dirichlet boundary conditions $u(0)=1$ and $u(1)=0$.\n$$u_H(x) = u(0) \\phi_1(x) + u(1) \\phi_2(x)$$\n$$u_H(x) = (1) \\phi_1(x) + (0) \\phi_2(x) = \\phi_1(x)$$\nTherefore, the MsFEM solution on this single-element mesh is identical to the first basis function, $u_H(x) = \\phi_1(x)$.\n\nThe final step is to compute the coarse-scale flux, $q_H(x)$:\n$$q_H(x) = -a\\!\\left(\\dfrac{x}{\\epsilon}\\right)\\dfrac{du_H}{dx}$$\nSince $u_H(x) = \\phi_1(x)$, we have $\\frac{du_H}{dx} = \\frac{d\\phi_1}{dx}$. From our earlier derivation:\n$$\\dfrac{d\\phi_1}{dx} = -\\dfrac{C_1}{a(x/\\epsilon)}$$\nSubstituting this into the expression for the flux:\n$$q_H(x) = -a\\!\\left(\\dfrac{x}{\\epsilon}\\right) \\left( -\\dfrac{C_1}{a(x/\\epsilon)} \\right) = C_1$$\nThe flux $q_H(x)$ is constant throughout the element $K$, as expected from the governing equation. Its value is simply $C_1$.\n$$q_H = C_1 = \\dfrac{1}{0.73}$$\nThis result is also known as the effective flux, corresponding to the homogenized problem with an effective conductivity $a_{\\text{eff}} = (\\langle a^{-1} \\rangle)^{-1} = 1/0.73$.\nThe numerical value is:\n$$q_H = \\dfrac{1}{0.73} \\approx 1.36986301369...$$\nRounding to four significant figures, we get $1.370$.", "answer": "$$\\boxed{1.370}$$", "id": "2581803"}, {"introduction": "The Finite Element squared (FE²) method is one of the most versatile multiscale strategies, but its computational cost demands careful implementation, especially for nonlinear problems. A critical component for an efficient macroscopic solver is the homogenized tangent stiffness matrix, which can be computed either numerically or analytically. This practice problem asks you to compare these two approaches, analyzing the trade-offs in accuracy, computational cost, and convergence rate, which is a crucial consideration for developing robust and efficient FE² codes [@problem_id:2581876].", "problem": "Consider a two-scale Finite Element squared (FE²) formulation for a small-strain, rate-independent heterogeneous solid. At each macroscopic Gauss point, a Representative Volume Element (RVE) with periodic boundary conditions is solved to microscopic equilibrium driven by the prescribed macroscopic average strain $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$. Denote the homogenized Cauchy stress by $\\,\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}})\\,$, defined by energetic consistency via the Hill–Mandel condition. In a Newton–Raphson solution of the macroscopic boundary value problem, the consistent algorithmic tangent is the fourth-order tensor $\\,\\mathbb{C}^H = \\dfrac{\\partial \\boldsymbol{\\sigma}^H}{\\partial \\bar{\\boldsymbol{\\varepsilon}}}\\,$ evaluated under the constraint that the microscopic fields satisfy their equilibrium equations and evolution laws at each $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$.\n\nTwo strategies to obtain $\\,\\mathbb{C}^H\\,$ are considered:\n(i) numerical differentiation of $\\,\\boldsymbol{\\sigma}^H\\,$ by finite differences with respect to components of $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$, requiring re-equilibration of the RVE for perturbed loadings; and (ii) analytical linearization of the constrained microproblem followed by condensation (micro condensation) to eliminate microscopic degrees of freedom, yielding an exact derivative at the discrete micro level.\n\nUsing only the fundamentals of virtual work at the micro and macro scales, the definition of $\\,\\boldsymbol{\\sigma}^H\\,$ as the energy-conjugate to $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$, and standard properties of Newton–Raphson methods, decide which of the following statements about accuracy and computational cost are correct for a $\\,d$-dimensional setting with $\\,n_s = d(d+1)/2\\,$ independent components of $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$. Assume the microproblem at each Gauss point is solved by Newton–Raphson with a consistent microscopic tangent and a convergence tolerance $\\,\\eta\\,$ on the microscopic residual, and that the mapping $\\,\\bar{\\boldsymbol{\\varepsilon}} \\mapsto \\boldsymbol{\\sigma}^H\\,$ is sufficiently smooth away from non-differentiable events (e.g., yield surface corners).\n\nSelect all correct statements.\n\nA. If the analytical tangent from micro condensation is used and each RVE is converged consistently at the current $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$, the macroscopic Newton–Raphson method retains quadratic convergence locally; using a finite-difference tangent generally degrades the convergence rate due to truncation and re-equilibration errors unless the perturbation size tends to zero in a manner coupled to the residual.\n\nB. In $\\,3$D ($\\,d = 3\\,$), a forward-difference approximation of $\\,\\mathbb{C}^H\\,$ requires approximately $\\,n_s = 6\\,$ additional RVE solves per macroscopic Newton iteration per Gauss point (one per independent component of $\\,\\bar{\\boldsymbol{\\varepsilon}}\\,$), while a central-difference approximation requires approximately $\\,2 n_s = 12\\,$ additional RVE solves; in contrast, micro condensation typically requires one factorization of the microscopic tangent matrix per Gauss point and $\\,n_s\\,$ inexpensive back-solves reusing that factorization.\n\nC. Central finite differences always produce a symmetric homogenized tangent $\\,\\mathbb{C}^H\\,$, regardless of the microscopic material model and numerical tolerances, provided the step size is small.\n\nD. In finite-difference tangents, choosing the perturbation amplitude $\\,\\Delta \\bar{\\boldsymbol{\\varepsilon}}\\,$ too small amplifies round-off and microscopic iteration noise, while choosing it too large increases truncation error; a practical guideline is to balance these errors with a step size on the order of $\\,\\sqrt{\\eta}\\,$ in nondimensionalized strain units. Analytical micro condensation avoids step-size tuning entirely.\n\nE. Finite-difference tangents are universally cheaper than analytical micro condensation because they avoid assembling and solving microscopic linear systems.\n\nProvide your choice(s) and justify based on the stated fundamentals and assumptions, without invoking any unintroduced formulas beyond those implied by virtual work, energy conjugacy, and Newton–Raphson linearization.", "solution": "The problem statement is critically reviewed before a solution is attempted.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n- The context is a two-scale Finite Element squared (FE$^2$) formulation for a small-strain, rate-independent heterogeneous solid.\n- A Representative Volume Element (RVE) with periodic boundary conditions is solved at each macroscopic Gauss point.\n- The RVE is driven by the prescribed macroscopic average strain, $\\bar{\\boldsymbol{\\varepsilon}}$.\n- The homogenized Cauchy stress, $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}})$, is defined by energetic consistency via the Hill–Mandel condition.\n- The consistent algorithmic tangent is the fourth-order tensor $\\mathbb{C}^H = \\dfrac{\\partial \\boldsymbol{\\sigma}^H}{\\partial \\bar{\\boldsymbol{\\varepsilon}}}$.\n- Strategy (i) for computing $\\mathbb{C}^H$: numerical differentiation by finite differences, requiring re-equilibration of the RVE for perturbed loadings.\n- Strategy (ii) for computing $\\mathbb{C}^H$: analytical linearization of the constrained microproblem followed by micro condensation.\n- The question is to evaluate statements about accuracy and computational cost.\n- The dimensionality is $d$, with $n_s = d(d+1)/2$ independent components of $\\bar{\\boldsymbol{\\varepsilon}}$.\n- The microproblem is solved using a Newton–Raphson method with a consistent microscopic tangent and a convergence tolerance $\\eta$ on the residual.\n- The mapping $\\bar{\\boldsymbol{\\varepsilon}} \\mapsto \\boldsymbol{\\sigma}^H$ is assumed to be sufficiently smooth.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is well-grounded in the established field of computational mechanics and multiscale modeling. The FE$^2$ method, Hill-Mandel condition, consistent tangent, Newton-Raphson method, and the comparison between numerical and analytical tangents are all standard, core concepts.\n- **Well-Posed**: The problem asks for an evaluation of specific, well-defined statements based on a given set of principles. A definite conclusion about the correctness of each statement can be reached.\n- **Objective**: The language is technical, precise, and free of subjective claims. All terms are standard within the discipline.\n- **Completeness and Consistency**: The problem provides a self-contained description of the numerical experiment and the two methods being compared, including necessary assumptions like smoothness and the use of Newton-Raphson solvers at both scales. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a standard and well-formulated question in computational continuum mechanics. A solution will be derived.\n\n**Solution Derivation**\n\nThe derivation proceeds by analyzing each statement based on the provided principles of computational mechanics, numerical analysis, and the Newton-Raphson method.\n\n**Analysis of Statement A**\nThis statement addresses the convergence rate of the macroscopic Newton–Raphson solver. The fundamental principle of the Newton–Raphson method is that it achieves local quadratic convergence if and only if the tangent matrix used in the iterative updates is the exact derivative of the residual function with respect to the solution variables. In the context of a macroscopic boundary value problem, the tangent stiffness matrix is derived from the consistent material tangent, which is $\\mathbb{C}^H = \\dfrac{\\partial \\boldsymbol{\\sigma}^H}{\\partial \\bar{\\boldsymbol{\\varepsilon}}}$.\nStrategy (ii), analytical linearization followed by micro condensation, is designed to compute this derivative exactly at the discrete level. Therefore, using the resulting $\\mathbb{C}^H$ provides the true consistent tangent for the macroscopic problem, and local quadratic convergence should be expected.\nStrategy (i), using a finite-difference approximation, introduces an error. The computed tangent, $\\mathbb{C}^H_{FD}$, is only an approximation to the true tangent $\\mathbb{C}^H$. The error, known as truncation error, depends on the perturbation size. Using an inexact tangent in a Newton–Raphson scheme generally degrades the convergence rate from quadratic to linear. The statement correctly notes that the quadratic rate can be recovered in such inexact Newton methods if the perturbation size (and thus the tangent error) is reduced in a specific way as the macroscopic residual decreases. This is a known result in numerical analysis. The statement is a correct application of Newton-Raphson theory to the FE$^2$ context.\n\nVerdict: **Correct**.\n\n**Analysis of Statement B**\nThis statement analyzes the computational cost for a $3$D problem. In $3$D, the number of independent components of the symmetric strain tensor $\\bar{\\boldsymbol{\\varepsilon}}$ is $n_s = d(d+1)/2 = 3(3+1)/2 = 6$.\nTo compute $\\mathbb{C}^H$ via forward finite differences, one must perturb each of the $n_s$ components of $\\bar{\\boldsymbol{\\varepsilon}}$. The formula is $\\mathbb{C}^H_{ijkl} \\approx (\\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}} + \\Delta\\varepsilon_{kl} \\mathbf{E}_{kl}) - \\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}})) / \\Delta\\varepsilon_{kl}$. The stress at the unperturbed state, $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}})$, is already known from the state evaluation. Thus, one additional non-linear RVE solve is needed for each of the $n_s=6$ components, totaling $6$ additional solves.\nFor a central-difference approximation, $\\mathbb{C}^H_{ijkl} \\approx (\\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}} + \\Delta\\varepsilon_{kl} \\mathbf{E}_{kl}) - \\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}} - \\Delta\\varepsilon_{kl} \\mathbf{E}_{kl})) / (2\\Delta\\varepsilon_{kl})$. This requires two RVE solves for each component (one positive perturbation, one negative), totaling $2n_s = 12$ additional solves.\nIn contrast, the analytical micro condensation method works by first solving the non-linear RVE problem for the unperturbed strain $\\bar{\\boldsymbol{\\varepsilon}}$. Then, at the converged microscopic state, the microscopic tangent stiffness matrix $\\mathbf{K}_T$ is assembled. The analytical expression for $\\mathbb{C}^H$ involves the sensitivity of the microscopic fields to the macroscopic strain. Computing these sensitivities requires solving linear systems of the form $\\mathbf{K}_T \\mathbf{x} = \\mathbf{b}$ for $n_s$ different right-hand sides $\\mathbf{b}$. The efficient way to do this is to compute the LU factorization of $\\mathbf{K}_T$ once, which is the most expensive step, and then use this factorization to solve for the $n_s$ different right-hand sides via inexpensive forward and backward substitutions (back-solves).\nThe statement accurately describes both the number of RVE solves required for finite differences and the standard, efficient procedure for analytical condensation.\n\nVerdict: **Correct**.\n\n**Analysis of Statement C**\nThis statement claims that central finite differences *always* yield a symmetric homogenized tangent $\\mathbb{C}^H$. A tangent tensor is symmetric if it possesses the major symmetries, i.e., $\\mathbb{C}^H_{ijkl} = \\mathbb{C}^H_{klij}$. This symmetry is guaranteed for the *exact* tangent if the homogenized response can be derived from a strain energy potential, $W^H(\\bar{\\boldsymbol{\\varepsilon}})$, such that $\\boldsymbol{\\sigma}^H = \\partial W^H / \\partial \\bar{\\boldsymbol{\\varepsilon}}$ and $\\mathbb{C}^H = \\partial^2 W^H / \\partial \\bar{\\boldsymbol{\\varepsilon}}^2$.\nThe central-difference approximation for the component $(\\mathbb{C}^H_{CD})_{ijkl}$ is $\\frac{\\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}} + h \\mathbf{E}_{kl}) - \\sigma^H_{ij}(\\bar{\\boldsymbol{\\varepsilon}} - h \\mathbf{E}_{kl})}{2h}$. The symmetric component $(\\mathbb{C}^H_{CD})_{klij}$ is $\\frac{\\sigma^H_{kl}(\\bar{\\boldsymbol{\\varepsilon}} + h \\mathbf{E}_{ij}) - \\sigma^H_{kl}(\\bar{\\boldsymbol{\\varepsilon}} - h \\mathbf{E}_{ij})}{2h}$. While for an exact analytical function $\\boldsymbol{\\sigma}^H$ derived from a potential these two expressions would be equal, the problem specifies a numerical context where $\\boldsymbol{\\sigma}^H$ is the result of a non-linear RVE solve converged to a finite tolerance $\\eta$. The computed stresses $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}} \\pm h \\mathbf{E}_{kl})$ and $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}} \\pm h \\mathbf{E}_{ij})$ are obtained from four independent non-linear solves. Each solve introduces numerical errors (e.g., from iterative convergence not reaching zero residual, and from finite-precision arithmetic) that are uncorrelated. These small, random-like numerical errors will break the perfect mathematical symmetry. The statement's claim \"always\" and \"regardless of... numerical tolerances\" is too strong and factually incorrect in a practical computational setting.\n\nVerdict: **Incorrect**.\n\n**Analysis of Statement D**\nThis statement discusses the choice of the perturbation amplitude, $\\Delta \\bar{\\boldsymbol{\\varepsilon}}$, for finite-difference methods. It correctly identifies the fundamental trade-off in numerical differentiation.\n1.  **Truncation Error**: The finite-difference formula is a truncated Taylor series expansion. This introduces a truncation error that scales with the perturbation size $h = |\\Delta \\bar{\\boldsymbol{\\varepsilon}}|$. For a forward difference, the error is $O(h)$; for a central difference, it is $O(h^2)$. A large $h$ leads to a large truncation error.\n2.  **Conditioning/Noise Error**: The formula involves the subtraction of two nearly equal values of stress, $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}}+\\Delta\\bar{\\boldsymbol{\\varepsilon}})$ and $\\boldsymbol{\\sigma}^H(\\bar{\\boldsymbol{\\varepsilon}})$. The stress values themselves are not exact; they are computed up to a tolerance $\\eta$, so they contain \"noise\" of order $\\eta$ (in appropriate units) and round-off error from floating-point arithmetic. When subtracting two close numbers, the absolute error is preserved while the relative error is magnified. Dividing this result by a small number $h$ further amplifies the error. This error contribution is proportional to $\\epsilon/h$, where $\\epsilon$ is the effective error in the stress evaluation (related to $\\eta$ and machine precision).\nTherefore, an optimal $h$ exists that balances these two competing error sources. The optimal step size for a first-order scheme like forward differences indeed scales as $h_{opt} \\propto \\sqrt{\\epsilon}$. Given the micro-solver tolerance $\\eta$, it is a sound practical guideline to choose the perturbation on the order of $\\sqrt{\\eta}$.\nFinally, the analytical micro condensation method is a direct mathematical derivation. It does not involve any perturbation parameter $h$, and thus completely bypasses the problem of step-size selection. The statement is a correct and practical summary of the issues.\n\nVerdict: **Correct**.\n\n**Analysis of Statement E**\nThis statement claims finite-difference tangents are \"universally cheaper\" because they \"avoid assembling and solving microscopic linear systems.\" This premise is fundamentally false. A finite-difference approach requires multiple *full non-linear RVE solves*. Each non-linear solve, using the specified Newton–Raphson method, involves a loop of iterations. In each iteration, one must assemble the microscopic tangent stiffness matrix $\\mathbf{K}_T$ and solve a linear system of equations $\\mathbf{K}_T \\Delta \\mathbf{u} = \\mathbf{r}$. Therefore, the finite-difference method does not avoid solving linear systems; it does so repeatedly within each of the $n_s$ (or $2n_s$) non-linear RVE solves.\nThe analytical method requires one non-linear RVE solve (which itself involves assembling and solving linear systems), followed by one extra assembly and factorization of $\\mathbf{K}_T$ at the converged state, and $n_s$ inexpensive back-substitutions.\nA coarse cost comparison for a 3D problem ($n_s=6$) using forward differences:\n- Cost(FD) $\\approx 6 \\times (\\text{Cost of one non-linear RVE solve})$.\n- Cost(Analytical) $\\approx 1 \\times (\\text{Cost of one non-linear RVE solve}) + (\\text{Cost of one factorization of } \\mathbf{K}_T) + 6 \\times (\\text{Cost of back-solve})$.\nSince a non-linear solve typically takes several Newton iterations (e.g., $3-5$), its cost is several times that of a single factorization. It is clear that the cost of the analytical method is significantly lower than that of the finite-difference method. The statement is based on a false premise and its conclusion is the opposite of the truth.\n\nVerdict: **Incorrect**.", "answer": "$$\n\\boxed{ABD}\n$$", "id": "2581876"}]}