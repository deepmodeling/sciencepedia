{"hands_on_practices": [{"introduction": "The journey from the continuous weak form of the Navier-Stokes equations to a computable semi-discrete system begins with assembling the system matrices. This first exercise focuses on the mass matrix, $\\mathbb{M}$, which discretizes the time-derivative term $\\rho(\\partial_t \\boldsymbol{u}, \\boldsymbol{w})$. By working through the assembly process for simple $\\mathbb{P}_1$ elements, you will gain hands-on practice in translating a bilinear form into local element matrices and then combining them into a global system matrix, a fundamental skill in finite element programming [@problem_id:2582614].", "problem": "Consider the incompressible Navier–Stokes equations for a Newtonian fluid with constant density $\\rho$ on a bounded polygonal domain $\\Omega \\subset \\mathbb{R}^{2}$ with homogeneous Dirichlet boundary conditions for the velocity:\n$$\n\\rho\\,\\partial_{t}\\boldsymbol{u} + \\rho\\,(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} - \\mu\\,\\Delta \\boldsymbol{u} + \\nabla p = \\boldsymbol{f}, \\quad \\nabla\\cdot \\boldsymbol{u} = 0 \\quad \\text{in } \\Omega.\n$$\nUse the Galerkin finite element method with continuous piecewise-affine (i.e., $\\mathbb{P}_{1}$) vector shape functions for the velocity and let the semi-discrete (in space) velocity field be\n$$\n\\boldsymbol{u}_{h}(t,\\boldsymbol{x}) = \\sum_{a=1}^{N} U_{a}^{x}(t)\\,\\boldsymbol{e}_{x}\\,\\varphi_{a}(\\boldsymbol{x}) + \\sum_{a=1}^{N} U_{a}^{y}(t)\\,\\boldsymbol{e}_{y}\\,\\varphi_{a}(\\boldsymbol{x}),\n$$\nwhere $\\{\\varphi_{a}\\}_{a=1}^{N}$ are the scalar nodal hat functions associated with the mesh vertices, and $\\{\\boldsymbol{e}_{x},\\boldsymbol{e}_{y}\\}$ are the Cartesian basis vectors. The semi-discrete Galerkin formulation for the momentum equation contains a mass term of the form\n$$\n\\rho\\int_{\\Omega} \\boldsymbol{w}_{h}\\cdot \\partial_{t}\\boldsymbol{u}_{h}\\,dx,\n$$\nwhere $\\boldsymbol{w}_{h}$ ranges over the same vector space as $\\boldsymbol{u}_{h}$. This term induces the global mass matrix $\\boldsymbol{M}$.\n\nStarting from the weak formulation and the definition of the $\\mathbb{P}_{1}$ nodal basis, do the following.\n\n$1.$ Derive the element-wise expression of the local mass matrix on any element $K$,\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\big(\\boldsymbol{e}_{\\alpha}\\,\\varphi_{i}\\big)\\cdot \\big(\\boldsymbol{e}_{\\beta}\\,\\varphi_{j}\\big)\\,dx,\n$$\nfor node indices $i,j$ local to $K$ and component indices $\\alpha,\\beta\\in\\{x,y\\}$. Reduce this to integrals of the scalar basis functions $\\varphi_{i},\\varphi_{j}$ and identify which entries vanish by orthogonality of components.\n\n$2.$ Specialize to the mesh $\\mathcal{T}_{h}$ of the unit square $\\Omega = (0,1)\\times(0,1)$ subdivided into $2$ triangles by the diagonal from $(0,0)$ to $(1,1)$:\n$$\nK_{1} = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}, \\qquad K_{2} = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}.\n$$\nLet the global vertices be labeled as $N_{1}=(0,0)$, $N_{2}=(1,0)$, $N_{3}=(1,1)$, $N_{4}=(0,1)$, with associated scalar hat functions $\\{\\varphi_{1},\\varphi_{2},\\varphi_{3},\\varphi_{4}\\}$. Using only fundamental properties of barycentric coordinates on a triangle and integral identities that follow from $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}\\equiv 1$ on any triangle, compute the local scalar integrals $\\int_{K}\\varphi_{i}\\varphi_{j}\\,dx$ needed for $K=K_{1}$ and $K=K_{2}$.\n\n$3.$ Briefly state the assembly rule that maps each local element matrix $\\boldsymbol{M}^{(K)}$ into the global mass matrix $\\boldsymbol{M}$, in terms of the global degree-of-freedom (DoF) indices corresponding to $(i,\\alpha)$ and $(j,\\beta)$.\n\nFinally, using the above, compute the single global entry of the consistent mass matrix corresponding to the $x$-component at node $N_{3}$ tested against itself, i.e.,\n$$\nM_{(N_{3},x),(N_{3},x)}.\n$$\nExpress your final answer as a simplified exact expression in terms of $\\rho$ with no units. The final answer must be a single closed-form analytic expression.", "solution": "The problem statement is valid. It is a standard, well-posed exercise in the finite element method (FEM) applied to fluid dynamics, free of any scientific or logical flaws. We proceed to the solution.\n\nThe problem asks for a step-by-step derivation culminating in a specific entry of the global consistent mass matrix for the semi-discretized Navier-Stokes equations.\n\nFirst, we derive the general expression for the local mass matrix $\\boldsymbol{M}^{(K)}$ on a triangular element $K$. The velocity field is discretized using continuous piecewise-affine ($\\mathbb{P}_{1}$) vector basis functions. A vector basis function associated with a local node $i$ and Cartesian component $\\alpha \\in \\{x,y\\}$ is $\\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x}) = \\boldsymbol{e}_{\\alpha}\\varphi_{i}(\\boldsymbol{x})$, where $\\varphi_{i}$ is the scalar nodal basis function (the \"hat function\"). The semi-discrete velocity is $\\boldsymbol{u}_{h}(t,\\boldsymbol{x}) = \\sum_{j,\\beta} U_{j,\\beta}(t) \\boldsymbol{\\psi}_{j,\\beta}(\\boldsymbol{x})$. The test functions $\\boldsymbol{w}_{h}$ are chosen from the same space. A generic test function is $\\boldsymbol{w}_{h}(\\boldsymbol{x}) = \\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x})$.\n\nThe mass term contribution from element $K$ is $\\rho\\int_{K} \\boldsymbol{w}_{h}\\cdot \\partial_{t}\\boldsymbol{u}_{h}\\,dx$. Substituting the basis functions, we obtain the local mass matrix entries:\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\boldsymbol{\\psi}_{i,\\alpha}(\\boldsymbol{x}) \\cdot \\boldsymbol{\\psi}_{j,\\beta}(\\boldsymbol{x}) \\,dx\n$$\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\int_{K} \\big(\\boldsymbol{e}_{\\alpha}\\,\\varphi_{i}(\\boldsymbol{x})\\big) \\cdot \\big(\\boldsymbol{e}_{\\beta}\\,\\varphi_{j}(\\boldsymbol{x})\\big) \\,dx\n$$\nSince the scalar basis functions $\\varphi_{i}$ and $\\varphi_{j}$ are independent of the component indices, and the Cartesian basis vectors $\\{\\boldsymbol{e}_{x}, \\boldsymbol{e}_{y}\\}$ are constant, we can write:\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\, (\\boldsymbol{e}_{\\alpha}\\cdot \\boldsymbol{e}_{\\beta}) \\int_{K} \\varphi_{i}(\\boldsymbol{x})\\varphi_{j}(\\boldsymbol{x})\\,dx\n$$\nThe Cartesian basis vectors are orthonormal, i.e., $\\boldsymbol{e}_{\\alpha}\\cdot \\boldsymbol{e}_{\\beta} = \\delta_{\\alpha\\beta}$, where $\\delta_{\\alpha\\beta}$ is the Kronecker delta. Thus, the expression simplifies to:\n$$\n\\boldsymbol{M}^{(K)}_{(i,\\alpha),(j,\\beta)} = \\rho \\, \\delta_{\\alpha\\beta} \\int_{K} \\varphi_{i}(\\boldsymbol{x})\\varphi_{j}(\\boldsymbol{x})\\,dx\n$$\nThis result shows that the entries are non-zero only if $\\alpha=\\beta$. The coupling between the $x$ and $y$ velocity components is zero within the mass matrix, meaning it is block-diagonal. The two diagonal blocks, for $x-x$ and $y-y$ components, are identical and equal to $\\rho$ times the scalar mass matrix $M^{\\text{scalar}}_{ij} = \\int_{K} \\varphi_{i}\\varphi_{j}\\,dx$.\n\nSecond, we compute the scalar integrals $\\int_{K}\\varphi_{i}\\varphi_{j}\\,dx$ for the specific mesh provided. The domain $\\Omega = (0,1)\\times(0,1)$ is divided into two triangles, $K_{1}$ and $K_{2}$, with areas $|K_1| = |K_2| = 1/2$. For a $\\mathbb{P}_{1}$ element, the scalar basis function $\\varphi_{i}$ associated with a vertex is identical to the barycentric coordinate $\\lambda_{i}$ corresponding to that vertex. We use the standard integral formula for barycentric coordinates on a triangle $K$ with area $|K|$:\n$$\n\\int_{K} \\lambda_{1}^{a}\\lambda_{2}^{b}\\lambda_{3}^{c} \\, dx = \\frac{a!\\,b!\\,c!}{(a+b+c+2)!} \\, 2|K|\n$$\nFor the diagonal entries of the scalar mass matrix ($i=j$), we need to compute $\\int_{K} \\varphi_{i}^{2}\\,dx = \\int_{K} \\lambda_{i}^{2}\\,dx$. Using the formula with exponents $(a,b,c)=(2,0,0)$, we get:\n$$\n\\int_{K} \\varphi_{i}^{2}\\,dx = \\frac{2!\\,0!\\,0!}{(2+0+0+2)!} \\, 2|K| = \\frac{2}{4!} \\, 2|K| = \\frac{4|K|}{24} = \\frac{|K|}{6}\n$$\nFor the off-diagonal entries ($i\\neq j$), we compute $\\int_{K} \\varphi_{i}\\varphi_{j}\\,dx = \\int_{K} \\lambda_{i}\\lambda_{j}\\,dx$. Using the formula with exponents $(a,b,c)=(1,1,0)$, we get:\n$$\n\\int_{K} \\varphi_{i}\\varphi_{j}\\,dx = \\frac{1!\\,1!\\,0!}{(1+1+0+2)!} \\, 2|K| = \\frac{1}{4!} \\, 2|K| = \\frac{2|K|}{24} = \\frac{|K|}{12}\n$$\nFor both triangles $K_1$ and $K_2$ in the given mesh, the area is $|K| = 1/2$. Therefore, for any triangle $K$ in this mesh and any local indices $i,j$:\n$$\n\\int_{K} \\varphi_{i}^{2}\\,dx = \\frac{1/2}{6} = \\frac{1}{12}\n$$\n$$\n\\int_{K} \\varphi_{i}\\varphi_{j}\\,dx = \\frac{1/2}{12} = \\frac{1}{24} \\quad (i\\neq j)\n$$\n\nThird, the assembly rule for constructing the global mass matrix $\\boldsymbol{M}$ from the local element matrices $\\boldsymbol{M}^{(K)}$ is a summation process. Each entry of the global matrix $\\boldsymbol{M}_{I,J}$ is the sum of contributions from all element matrices $\\boldsymbol{M}^{(K)}$ that have local degrees of freedom corresponding to the global degrees of freedom $I$ and $J$. Let $\\text{map}(K, i)$ be the global index of the $i$-th local node of element $K$, and let the global DoF $I$ correspond to the pair $(\\text{global node}, \\text{component})$. Then, the global entry for $(\\text{node } n, \\text{component } \\alpha)$ tested against $(\\text{node } m, \\text{component } \\beta)$ is:\n$$\nM_{(n,\\alpha),(m,\\beta)} = \\sum_{K \\in \\mathcal{T}_{h}} \\boldsymbol{M}^{(K)}_{(i_n,\\alpha),(j_m,\\beta)},\n$$\nwhere the sum is over all elements $K$ containing both global nodes $n$ and $m$, and $i_n$, $j_m$ are the corresponding local indices within $K$. If an element does not contain one of the nodes, its contribution is zero.\n\nFinally, we compute the specific global mass matrix entry $M_{(N_{3},x),(N_{3},x)}$. This is the diagonal entry corresponding to the $x$-component of velocity at global node $N_{3}=(1,1)$. According to the assembly rule, this value is the sum of the corresponding local diagonal entries from all elements that share node $N_3$. The node $N_3$ is a vertex of both triangles $K_{1}$ and $K_{2}$.\n$$\nM_{(N_{3},x),(N_{3},x)} = \\boldsymbol{M}^{(K_1)}_{(i_3,x),(i_3,x)} + \\boldsymbol{M}^{(K_2)}_{(j_3,x),(j_3,x)}\n$$\nwhere $i_3$ and $j_3$ are the local indices corresponding to global node $N_3$ in triangles $K_1$ and $K_2$, respectively.\nFrom our first result, the local matrix entry is:\n$$\n\\boldsymbol{M}^{(K)}_{(i,x),(i,x)} = \\rho \\int_{K} \\varphi_{i}^{2}(\\boldsymbol{x})\\,dx\n$$\nUsing the value of the integral we computed, for $K_1$:\n$$\n\\boldsymbol{M}^{(K_1)}_{(i_3,x),(i_3,x)} = \\rho \\int_{K_1} \\varphi_{i_3}^{2}\\,dx = \\rho \\frac{|K_1|}{6} = \\rho \\frac{1/2}{6} = \\frac{\\rho}{12}\n$$\nFor $K_2$:\n$$\n\\boldsymbol{M}^{(K_2)}_{(j_3,x),(j_3,x)} = \\rho \\int_{K_2} \\varphi_{j_3}^{2}\\,dx = \\rho \\frac{|K_2|}{6} = \\rho \\frac{1/2}{6} = \\frac{\\rho}{12}\n$$\nSumming these two contributions gives the final value for the global matrix entry:\n$$\nM_{(N_{3},x),(N_{3},x)} = \\frac{\\rho}{12} + \\frac{\\rho}{12} = \\frac{2\\rho}{12} = \\frac{\\rho}{6}\n$$", "answer": "$$\n\\boxed{\\frac{\\rho}{6}}\n$$", "id": "2582614"}, {"introduction": "Moving beyond the mass matrix, this practice tackles the assembly of the main system matrix, which incorporates the spatial operators for diffusion and convection. To make the problem tractable and stable, we consider a linearized Oseen system and apply pressure stabilization, a common technique for equal-order $\\mathbb{P}_1/\\mathbb{P}_1$ elements [@problem_id:2582638]. This exercise will give you a practical understanding of how different physical and numerical terms populate the block structure of the complete semi-discrete system.", "problem": "Consider the incompressible Navier–Stokes equations in two space dimensions in the Oseen linearized form at a given convecting velocity field $\\boldsymbol{U}$, discretized in space by the Finite Element Method (FEM) with equal-order continuous piecewise linear elements ($P_1/P_1$) for both velocity and pressure and stabilized for pressure. The computational domain is the unit square with vertices at $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$, triangulated into two elements by the diagonal from $(0,0)$ to $(1,1)$. Denote the nodes by $1:(0,0)$, $2:(1,0)$, $3:(1,1)$, and $4:(0,1)$. The two triangles are $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$ and $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$. Let the kinematic viscosity be $\\nu > 0$ and the density be $\\rho=1$. Let the linearization (convecting) velocity be uniform $\\boldsymbol{U}=(2,1)$.\n\nLet $\\boldsymbol{u}$ denote the velocity field and $p$ the pressure. The semi-discrete (in space) stabilized weak form seeks $\\boldsymbol{u}_h(t)$ and $p_h(t)$ in the $P_1/P_1$ spaces such that, for all test functions $\\boldsymbol{w}_h$ and $q_h$ in the same spaces,\n- the momentum balance reads\n$\\displaystyle (\\boldsymbol{w}_h,\\dot{\\boldsymbol{u}}_h) + \\nu \\sum_{K} (\\nabla \\boldsymbol{u}_h,\\nabla \\boldsymbol{w}_h)_K + \\sum_{K} ((\\boldsymbol{U}\\cdot \\nabla)\\boldsymbol{u}_h,\\boldsymbol{w}_h)_K - (p_h,\\nabla\\cdot \\boldsymbol{w}_h) = (\\boldsymbol{f},\\boldsymbol{w}_h)$,\n- the incompressibility and stabilization read\n$\\displaystyle (q_h,\\nabla\\cdot \\boldsymbol{u}_h) + \\sum_{K} \\tau_{p,K} (\\nabla p_h,\\nabla q_h)_K = 0$,\nwhere $(\\cdot,\\cdot)_K$ is the $L^2$ inner product over element $K$, and $\\tau_{p,K}$ is a pressure stabilization parameter chosen as $\\tau_{p,K}=\\alpha h_K^2$ with a constant $\\alpha > 0$ and element size $h_K$ (you may assume $h_{K_1}=h_{K_2}=1$ for this mesh). No other stabilization is employed.\n\nAdopt the nodal $P_1$ scalar shape functions $\\{N_i\\}_{i=1}^4$, and the standard vector-valued velocity basis $\\{\\boldsymbol{\\phi}_{i}^{x},\\boldsymbol{\\phi}_{i}^{y}\\}_{i=1}^4$ defined by $\\boldsymbol{\\phi}_{i}^{x} = N_i \\boldsymbol{e}_x$ and $\\boldsymbol{\\phi}_{i}^{y} = N_i \\boldsymbol{e}_y$, where $\\boldsymbol{e}_x$ and $\\boldsymbol{e}_y$ are the Cartesian unit vectors. Let the global vector of unknowns be ordered as $\\big(u_1^x,u_2^x,u_3^x,u_4^x,u_1^y,u_2^y,u_3^y,u_4^y,p_1,p_2,p_3,p_4\\big)^\\top$.\n\n1. Starting from the weak form above and the definitions of the $P_1$ basis functions on each triangle, assemble the linearized semi-discrete block system matrix $\\mathbb{A}(\\boldsymbol{U})$ such that the semi-discrete system reads\n$\\displaystyle \\mathbb{M}\\,\\dot{\\mathbf{z}}(t) + \\mathbb{A}(\\boldsymbol{U})\\,\\mathbf{z}(t) = \\mathbf{F}(t),$\nwith $\\mathbf{z}(t)$ collecting the nodal values of velocity and pressure in the given order, and identify each block in $\\mathbb{M}$ and $\\mathbb{A}(\\boldsymbol{U})$ by its mathematical meaning (diffusion, linearized convection, divergence/gradient coupling, and pressure stabilization). Your assembly must be consistent with the two-element mesh described and the chosen bases.\n\n2. Using only the fundamental definitions of the element-level bilinear forms and the $P_1$ shape functions, compute explicitly the global diagonal entry in the velocity–velocity convection–diffusion block corresponding to the $x$-component at node $1$, that is, the sum over $K_1$ and $K_2$ of the element contributions to\n$\\displaystyle a^{xx}_{11}(\\boldsymbol{U}) \\equiv \\nu \\sum_{K} \\int_K \\nabla N_1 \\cdot \\nabla N_1 \\,dx + \\sum_{K} \\int_K (\\boldsymbol{U}\\cdot \\nabla N_1)\\,N_1 \\,dx.$\nExpress your final answer as a single closed-form analytic expression in terms of $\\nu$ only. No boundary conditions are enforced for this assembly. Provide no numerical rounding; give an exact expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It represents a standard exercise in the finite element analysis of the incompressible Navier-Stokes equations using a stabilized formulation for equal-order interpolation spaces. All provided information is consistent and sufficient to proceed with the solution.\n\nThe semi-discrete system is of the form $\\mathbb{M}\\,\\dot{\\mathbf{z}}(t) + \\mathbb{A}(\\boldsymbol{U})\\,\\mathbf{z}(t) = \\mathbf{F}(t)$, where the vector of unknowns $\\mathbf{z}(t)$ is partitioned into velocity and pressure components. Given the specified ordering, we have $\\mathbf{z} = [\\mathbf{u}^x, \\mathbf{u}^y, \\mathbf{p}]^\\top$, where $\\mathbf{u}^x, \\mathbf{u}^y, \\mathbf{p}$ are vectors of nodal values of size $4 \\times 1$. The system matrices $\\mathbb{M}$ and $\\mathbb{A}$ will be $12 \\times 12$ block matrices.\n\nThe velocity and pressure fields are expanded in the finite element basis:\n$$ \\boldsymbol{u}_h(t) = \\sum_{j=1}^4 u_j^x(t) (N_j \\boldsymbol{e}_x) + \\sum_{j=1}^4 u_j^y(t) (N_j \\boldsymbol{e}_y) $$\n$$ p_h(t) = \\sum_{j=1}^4 p_j(t) N_j $$\nThe test functions are chosen from the same basis: $\\boldsymbol{w}_h$ is one of $\\{N_i \\boldsymbol{e}_x\\}_{i=1}^4$ or $\\{N_i \\boldsymbol{e}_y\\}_{i=1}^4$, and $q_h$ is one of $\\{N_i\\}_{i=1}^4$.\n\n**Part 1: Block Structure of the System Matrices**\n\nWe derive the block structure of $\\mathbb{M}$ and $\\mathbb{A}$ by substituting the expansions into the weak form and testing with each basis function.\n\nThe mass matrix $\\mathbb{M}$ arises from the time derivative term $(\\boldsymbol{w}_h, \\dot{\\boldsymbol{u}}_h)$. Since the pressure equation has no time derivative, the last block row and column of $\\mathbb{M}$ are zero. The velocity-velocity blocks are identical.\nFor a test function $\\boldsymbol{w}_h = N_i \\boldsymbol{e}_x$, the term becomes $\\sum_j (\\int_\\Omega N_i N_j dx) \\dot{u}_j^x$.\nThe resulting block structure for $\\mathbb{M}$ is:\n$$ \\mathbb{M} = \\begin{pmatrix} \\mathbf{M}_s & \\mathbf{0} & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{M}_s & \\mathbf{0} \\\\ \\mathbf{0} & \\mathbf{0} & \\mathbf{0} \\end{pmatrix} $$\nwhere $\\mathbf{M}_s$ is the $4 \\times 4$ scalar mass matrix, whose entries are $(\\mathbf{M}_s)_{ij} = \\int_\\Omega N_i N_j dx$.\n\nThe system matrix $\\mathbb{A}(\\boldsymbol{U})$ comprises contributions from diffusion, convection, gradient, divergence, and stabilization terms. We identify each block by its mathematical role.\n$$ \\mathbb{A}(\\boldsymbol{U}) = \\begin{pmatrix} \\mathbf{A}_{uu}(\\boldsymbol{U}) & \\mathbf{0} & \\mathbf{G}_x \\\\ \\mathbf{0} & \\mathbf{A}_{uu}(\\boldsymbol{U}) & \\mathbf{G}_y \\\\ \\mathbf{D}_x & \\mathbf{D}_y & \\mathbf{L}_p \\end{pmatrix} $$\nEach block is a $4 \\times 4$ matrix defined as follows:\n\n1.  **Velocity-Velocity Block $\\mathbf{A}_{uu}(\\boldsymbol{U})$**: This block combines diffusion and linearized convection effects on the velocity field. It is identical for both $x$- and $y$-momentum equations because of the scalar nature of the operators.\n    $$ \\mathbf{A}_{uu}(\\boldsymbol{U}) = \\nu \\mathbf{K}_s + \\mathbf{C}(\\boldsymbol{U}) $$\n    -   $\\mathbf{K}_s$ is the **scalar diffusion matrix** (or stiffness matrix), from the term $\\nu \\sum_K (\\nabla \\boldsymbol{u}_h, \\nabla \\boldsymbol{w}_h)_K$. Its entries are $(\\mathbf{K}_s)_{ij} = \\sum_K \\int_K \\nabla N_i \\cdot \\nabla N_j dx$.\n    -   $\\mathbf{C}(\\boldsymbol{U})$ is the **scalar convection matrix**, from the term $\\sum_K ((\\boldsymbol{U} \\cdot \\nabla)\\boldsymbol{u}_h, \\boldsymbol{w}_h)_K$. Its entries are $(\\mathbf{C}(\\boldsymbol{U}))_{ij} = \\sum_K \\int_K N_i (\\boldsymbol{U} \\cdot \\nabla N_j) dx$. The off-diagonal velocity blocks are zero because the test functions are aligned with the Cartesian axes.\n\n2.  **Velocity-Pressure Coupling Blocks ($\\mathbf{G}_x$, $\\mathbf{G}_y$)**: These blocks represent the discrete **gradient operator**. They couple the pressure field to the momentum equations.\n    -   From the term $-(p_h, \\nabla \\cdot \\boldsymbol{w}_h)$ with $\\boldsymbol{w}_h = N_i\\boldsymbol{e}_x$, we get the block $\\mathbf{G}_x$ coupling pressure to $x$-momentum. Its entries are $(\\mathbf{G}_x)_{ij} = -\\int_{\\Omega} N_j \\frac{\\partial N_i}{\\partial x} dx$.\n    -   Similarly, with $\\boldsymbol{w}_h = N_i\\boldsymbol{e}_y$, we get the block $\\mathbf{G}_y$ coupling pressure to $y$-momentum. Its entries are $(\\mathbf{G}_y)_{ij} = -\\int_{\\Omega} N_j \\frac{\\partial N_i}{\\partial y} dx$.\n\n3.  **Pressure-Velocity Coupling Blocks ($\\mathbf{D}_x$, $\\mathbf{D}_y$)**: These blocks represent the discrete **divergence operator**. They couple the velocity field to the continuity equation.\n    -   From the term $(q_h, \\nabla \\cdot \\boldsymbol{u}_h)$ with $q_h = N_i$, the coupling to the $x$-velocity component $\\boldsymbol{u}^x$ gives block $\\mathbf{D}_x$. Its entries are $(\\mathbf{D}_x)_{ij} = \\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial x} dx$.\n    -   The coupling to the $y$-velocity component $\\boldsymbol{u}^y$ gives block $\\mathbf{D}_y$. Its entries are $(\\mathbf{D}_y)_{ij} = \\int_{\\Omega} N_i \\frac{\\partial N_j}{\\partial y} dx$.\n    Note that without boundary terms from integration by parts, $\\mathbf{D}_x = -\\mathbf{G}_x^T$ and $\\mathbf{D}_y = -\\mathbf{G}_y^T$.\n\n4.  **Pressure-Pressure Block ($\\mathbf{L}_p$)**: This block arises from the pressure stabilization term $\\sum_K \\tau_{p,K} (\\nabla p_h, \\nabla q_h)_K$.\n    -   With $\\tau_{p,K} = \\alpha h_K^2$ and the given assumption $h_K=1$, the stabilization term becomes $\\alpha \\sum_K (\\nabla p_h, \\nabla q_h)_K$. This block is a **pressure Laplacian matrix** $\\mathbf{L}_p = \\alpha \\mathbf{K}_s$, where $\\mathbf{K}_s$ is the same scalar diffusion matrix defined previously.\n\n**Part 2: Explicit Computation of the Matrix Entry $a^{xx}_{11}(\\boldsymbol{U})$**\n\nWe are asked to compute the diagonal entry corresponding to the $x$-velocity at node $1$, which is located at $(0,0)$. This is the $(1,1)$ entry of the block $\\mathbf{A}_{uu}(\\boldsymbol{U})$.\n$$ a^{xx}_{11}(\\boldsymbol{U}) = \\nu \\left( \\sum_{K} \\int_K \\nabla N_1 \\cdot \\nabla N_1 \\,dx \\right) + \\left( \\sum_{K} \\int_K (\\boldsymbol{U}\\cdot \\nabla N_1)\\,N_1 \\,dx \\right) $$\nNode $1$ is a vertex of both triangles, $K_1 = \\operatorname{conv}\\{(0,0),(1,0),(1,1)\\}$ and $K_2 = \\operatorname{conv}\\{(0,0),(1,1),(0,1)\\}$. We must compute the contributions from both elements.\n\nFirst, we determine the shape function $N_1(x,y)$ and its gradient on each element.\n-   On element $K_1$ with nodes $(0,0), (1,0), (1,1)$, the shape function for node $1$ at $(0,0)$ is $N_1^{K_1}(x,y) = 1-x$. Its gradient is constant: $\\nabla N_1^{K_1} = (-1, 0)$.\n-   On element $K_2$ with nodes $(0,0), (1,1), (0,1)$, the shape function for node $1$ at $(0,0)$ is $N_1^{K_2}(x,y) = 1-y$. Its gradient is constant: $\\nabla N_1^{K_2} = (0, -1)$.\n\nNow, we compute the two parts of $a^{xx}_{11}(\\boldsymbol{U})$.\n\n**Diffusion Component:**\nThe contribution from $K_1$ is $\\int_{K_1} |\\nabla N_1^{K_1}|^2 \\,dx = \\int_{K_1} |(-1,0)|^2 \\,dx = \\int_{K_1} 1 \\,dx = \\text{Area}(K_1) = \\frac{1}{2}$.\nThe contribution from $K_2$ is $\\int_{K_2} |\\nabla N_1^{K_2}|^2 \\,dx = \\int_{K_2} |(0,-1)|^2 \\,dx = \\int_{K_2} 1 \\,dx = \\text{Area}(K_2) = \\frac{1}{2}$.\nThe total diffusion term is $\\nu (\\frac{1}{2} + \\frac{1}{2}) = \\nu$.\n\n**Convection Component:**\nThe convecting velocity is $\\boldsymbol{U}=(2,1)$.\n-   On $K_1$: $\\boldsymbol{U}\\cdot \\nabla N_1^{K_1} = (2,1) \\cdot (-1,0) = -2$. The integrand is $(-2) N_1^{K_1}(x,y) = -2(1-x)$. This is linear, so we can use a quadrature rule exact for linear functions: $\\int_K f dK = \\frac{\\text{Area}(K)}{3}\\sum_{i=1}^3 f(\\text{vertex}_i)$.\n    The vertices of $K_1$ are $(0,0), (1,0), (1,1)$. The values of the integrand $-2(1-x)$ at these vertices are $-2$, $0$, and $0$.\n    The integral is $\\frac{1/2}{3} (-2+0+0) = \\frac{1}{6}(-2) = -\\frac{1}{3}$.\n-   On $K_2$: $\\boldsymbol{U}\\cdot \\nabla N_1^{K_2} = (2,1) \\cdot (0,-1) = -1$. The integrand is $(-1) N_1^{K_2}(x,y) = -1(1-y)$.\n    The vertices of $K_2$ are $(0,0), (1,1), (0,1)$. The values of the integrand $-1(1-y)$ at these vertices are $-1$, $0$, and $0$.\n    The integral is $\\frac{1/2}{3} (-1+0+0) = \\frac{1}{6}(-1) = -\\frac{1}{6}$.\nThe total convection term is $(-\\frac{1}{3}) + (-\\frac{1}{6}) = -\\frac{2}{6} - \\frac{1}{6} = -\\frac{3}{6} = -\\frac{1}{2}$.\n\n**Total Value:**\nCombining the diffusion and convection components, we obtain the final value for the matrix entry:\n$$ a^{xx}_{11}(\\boldsymbol{U}) = \\nu - \\frac{1}{2} $$\nThis expression is in the required form, depending only on the parameter $\\nu$.", "answer": "$$\n\\boxed{\\nu - \\frac{1}{2}}\n$$", "id": "2582638"}, {"introduction": "A robust numerical scheme must not only be accurate but also stable, often by discretely mimicking the conservation laws of the continuous equations. This final practice shifts from matrix assembly to an analysis of the scheme's properties, specifically investigating how the common technique of mass lumping affects kinetic energy conservation [@problem_id:2582653]. By examining the interplay between the mass matrix and the skew-symmetric convection operator, you will explore the subtle but critical details that ensure the long-term stability of a time-dependent simulation.", "problem": "Consider the incompressible Navier–Stokes equations on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$, homogeneous Dirichlet boundary conditions for the velocity, and body force $\\mathbf{f}(\\mathbf{x},t)$. Let $\\mathbf{V}_h \\subset \\mathbf{H}_0^1(\\Omega)^d$ and $Q_h \\subset \\mathrm{L}_0^2(\\Omega)$ be an inf–sup stable pair of conforming finite element spaces. Denote the standard $\\mathrm{L}^2(\\Omega)$ inner product by $(\\cdot,\\cdot)$, and let $\\nu > 0$ be the kinematic viscosity. The semi-discrete (space-discrete, time-continuous) Galerkin formulation seeks $(\\mathbf{u}_h(t),p_h(t)) \\in \\mathbf{V}_h \\times Q_h$ such that for all $(\\mathbf{v}_h,q_h) \\in \\mathbf{V}_h \\times Q_h$,\n$$\n(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h) + \\nu (\\nabla \\mathbf{u}_h,\\nabla \\mathbf{v}_h) + c_s(\\mathbf{u}_h;\\mathbf{u}_h,\\mathbf{v}_h) - (p_h,\\nabla\\cdot \\mathbf{v}_h) + (q_h,\\nabla\\cdot \\mathbf{u}_h) = (\\mathbf{f},\\mathbf{v}_h),\n$$\nwhere the convection is written in the skew-symmetric form\n$$\nc_s(\\mathbf{w};\\mathbf{v},\\mathbf{z}) := \\tfrac{1}{2}\\,\\Big( ((\\mathbf{w}\\cdot \\nabla)\\mathbf{v},\\mathbf{z}) - ((\\mathbf{w}\\cdot \\nabla)\\mathbf{z},\\mathbf{v}) \\Big),\n$$\nassembled using a quadrature that is exact for the polynomials spanned by the basis functions and their convective derivatives. It is known that $c_s(\\mathbf{w};\\mathbf{v},\\mathbf{v})=0$ for any sufficiently smooth $\\mathbf{w}$ and $\\mathbf{v}$.\n\nA common modification for explicit time integration is mass lumping: introduce the lumped inner product $(\\cdot,\\cdot)_L := \\sum_{K \\in \\mathcal{T}_h} \\sum_{a \\in \\mathcal{N}(K)} \\omega_{K,a}\\, (\\cdot\\, \\cdot)\\big|_{\\text{node }a}$ that produces a diagonal mass matrix and satisfies $(\\varphi_i,\\varphi_j)_L = 0$ for $i \\neq j$ in the nodal basis $\\{\\varphi_i\\}$. Consider the mass-lumped semi-discrete variant obtained by replacing $(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h)$ and $(\\mathbf{f},\\mathbf{v}_h)$ by $(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h)_L$ and $(\\mathbf{f},\\mathbf{v}_h)_L$, respectively, while keeping viscosity, pressure-velocity coupling, and $c_s(\\cdot;\\cdot,\\cdot)$ assembled as above.\n\nAnalyze the impact of this mass lumping on the conservation and dissipation properties of the semi-discrete scheme, particularly on the discrete kinetic energy balance when the convection is represented in the skew-symmetric form $c_s$. Select all statements that are correct.\n\nA. In the inviscid and unforced case (i.e., $\\nu = 0$ and $\\mathbf{f}=\\mathbf{0}$) with homogeneous Dirichlet boundary conditions, the mass-lumped semi-discrete scheme with skew-symmetric convection preserves the discrete kinetic energy measured in the lumped inner product, in the sense that the time derivative of $\\tfrac{1}{2}\\,(\\mathbf{u}_h,\\mathbf{u}_h)_L$ equals $0$.\n\nB. When mass lumping is used as described, the skew-symmetry of the discrete convection operator is lost unless the discrete velocity is exactly divergence-free, and therefore $\\mathbf{u}_h^\\top N(\\mathbf{u}_h)\\mathbf{u}_h$ need not vanish.\n\nC. If the convection operator is kept in skew-symmetric form assembled by exact integration but only the mass matrix is lumped, then in the inviscid and unforced case the discrete kinetic energy measured in the consistent $\\mathrm{L}^2(\\Omega)$ inner product, i.e., $\\tfrac{1}{2}\\,(\\mathbf{u}_h,\\mathbf{u}_h)$, is exactly preserved.\n\nD. If one uses the same inexact quadrature that produces the lumped mass also to assemble both occurrences of the skew-symmetric trilinear form $c_s(\\cdot;\\cdot,\\cdot)$, then the algebraic identity $c_s(\\mathbf{u}_h;\\mathbf{v}_h,\\mathbf{v}_h)=0$ holds exactly for all $\\mathbf{v}_h \\in \\mathbf{V}_h$, so that in the inviscid and unforced case the mass-lumped scheme preserves the discrete kinetic energy measured in the lumped inner product.\n\nE. Mass lumping always introduces artificial dissipation into the inviscid and unforced semi-discrete scheme, irrespective of how the convection operator is assembled, so that the discrete kinetic energy strictly decreases in time unless $\\mathbf{u}_h\\equiv \\mathbf{0}$.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n-   **Governing Equations**: Incompressible Navier-Stokes equations on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ with $d \\in \\{2,3\\}$.\n-   **Boundary Conditions**: Homogeneous Dirichlet boundary conditions for velocity.\n-   **Forcing Term**: Body force $\\mathbf{f}(\\mathbf{x},t)$.\n-   **Finite Element Spaces**: Conforming and inf-sup stable pair $\\mathbf{V}_h \\subset \\mathbf{H}_0^1(\\Omega)^d$ and $Q_h \\subset \\mathrm{L}_0^2(\\Omega)$.\n-   **Notation**: $\\mathrm{L}^2(\\Omega)$ inner product is $(\\cdot,\\cdot)$, kinematic viscosity is $\\nu > 0$.\n-   **Baseline Semi-Discrete Formulation**: Find $(\\mathbf{u}_h(t),p_h(t)) \\in \\mathbf{V}_h \\times Q_h$ such that for all $(\\mathbf{v}_h,q_h) \\in \\mathbf{V}_h \\times Q_h$:\n    $$(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h) + \\nu (\\nabla \\mathbf{u}_h,\\nabla \\mathbf{v}_h) + c_s(\\mathbf{u}_h;\\mathbf{u}_h,\\mathbf{v}_h) - (p_h,\\nabla\\cdot \\mathbf{v}_h) + (q_h,\\nabla\\cdot \\mathbf{u}_h) = (\\mathbf{f},\\mathbf{v}_h)$$\n-   **Skew-Symmetric Convection Form**: $c_s(\\mathbf{w};\\mathbf{v},\\mathbf{z}) := \\tfrac{1}{2}\\,\\Big( ((\\mathbf{w}\\cdot \\nabla)\\mathbf{v},\\mathbf{z}) - ((\\mathbf{w}\\cdot \\nabla)\\mathbf{z},\\mathbf{v}) \\Big)$, which is known to satisfy $c_s(\\mathbf{w};\\mathbf{v},\\mathbf{v})=0$. The problem states it is assembled using exact quadrature.\n-   **Mass Lumping Modification**:\n    -   A lumped inner product $(\\cdot,\\cdot)_L$ is introduced, which diagonalizes the mass matrix.\n    -   The semi-discrete formulation is modified by replacing $(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h)$ with $(\\partial_t \\mathbf{u}_h,\\mathbf{v}_h)_L$ and $(\\mathbf{f},\\mathbf{v}_h)$ with $(\\mathbf{f},\\mathbf{v}_h)_L$.\n    -   All other terms (viscosity, convection, pressure-velocity coupling) are assembled with the original, exact quadrature.\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is well-established in the field of numerical methods for computational fluid dynamics. All concepts, including the Navier-Stokes equations, finite element method, inf-sup stability, skew-symmetric convection, and mass lumping, are standard.\n-   **Well-Posed**: The problem asks for an analysis of the properties of a well-defined numerical scheme. A unique and meaningful analysis is possible.\n-   **Objective**: The language is technical, precise, and free from subjective elements.\n\n**Step 3: Verdict and Action**\nThe problem statement is scientifically sound, self-contained, and well-posed. It is **valid**. Proceeding to the solution.\n\nThe mass-lumped semi-discrete formulation is given by seeking $(\\mathbf{u}_h(t), p_h(t)) \\in \\mathbf{V}_h \\times Q_h$ such that for all test functions $(\\mathbf{v}_h, q_h) \\in \\mathbf{V}_h \\times Q_h$:\n$$\n(\\partial_t \\mathbf{u}_h, \\mathbf{v}_h)_L + \\nu (\\nabla \\mathbf{u}_h, \\nabla \\mathbf{v}_h) + c_s(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{v}_h) - (p_h, \\nabla \\cdot \\mathbf{v}_h) = (\\mathbf{f}, \\mathbf{v}_h)_L\n$$\n$$\n(q_h, \\nabla \\cdot \\mathbf{u}_h) = 0\n$$\nTo analyze the kinetic energy balance, we set the test velocity $\\mathbf{v}_h = \\mathbf{u}_h$. The momentum equation becomes:\n$$\n(\\partial_t \\mathbf{u}_h, \\mathbf{u}_h)_L + \\nu (\\nabla \\mathbf{u}_h, \\nabla \\mathbf{u}_h) + c_s(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{u}_h) - (p_h, \\nabla \\cdot \\mathbf{u}_h) = (\\mathbf{f}, \\mathbf{u}_h)_L\n$$\nWe analyze each term:\n1.  **Mass term**: The lumped inner product $(\\cdot, \\cdot)_L$ is a symmetric bilinear form. The kinetic energy associated with this inner product is $E_L(t) = \\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L$. Its time derivative is $\\frac{dE_L}{dt} = (\\partial_t \\mathbf{u}_h, \\mathbf{u}_h)_L$, which matches the first term.\n2.  **Viscosity term**: $\\nu (\\nabla \\mathbf{u}_h, \\nabla \\mathbf{u}_h) = \\nu \\|\\nabla \\mathbf{u}_h\\|_{\\mathrm{L}^2}^2 \\ge 0$. This term represents energy dissipation due to viscosity.\n3.  **Convection term**: The problem specifies the use of the skew-symmetric form $c_s(\\mathbf{w}; \\mathbf{v}, \\mathbf{z})$, which is assembled exactly. The property $c_s(\\mathbf{w}; \\mathbf{v}, \\mathbf{v}) = 0$ holds for any functions $\\mathbf{w}, \\mathbf{v}$ for which the integrals are defined. This is a purely algebraic identity resulting from its definition. Therefore, for $\\mathbf{w}=\\mathbf{v}=\\mathbf{u}_h$, we have $c_s(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{u}_h) = 0$.\n4.  **Pressure term**: The discrete continuity equation is $(q_h, \\nabla \\cdot \\mathbf{u}_h) = 0$ for all $q_h \\in Q_h$. Since the pressure solution $p_h(t)$ belongs to $Q_h$, we can choose $q_h = p_h$, which gives $(p_h, \\nabla \\cdot \\mathbf{u}_h) = 0$. This term vanishes.\n5.  **Force term**: $(\\mathbf{f}, \\mathbf{u}_h)_L$ represents the power supplied by the external force, measured with the lumped quadrature.\n\nSubstituting these results into the equation yields the energy balance for the lumped kinetic energy $E_L$:\n$$\n\\frac{d}{dt}\\left(\\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L\\right) + \\nu \\|\\nabla \\mathbf{u}_h\\|_{\\mathrm{L}^2}^2 = (\\mathbf{f}, \\mathbf{u}_h)_L\n$$\nThis equation forms the basis for evaluating the options.\n\n**Option-by-Option Analysis**\n\n**A. In the inviscid and unforced case (i.e., $\\nu = 0$ and $\\mathbf{f}=\\mathbf{0}$) with homogeneous Dirichlet boundary conditions, the mass-lumped semi-discrete scheme with skew-symmetric convection preserves the discrete kinetic energy measured in the lumped inner product, in the sense that the time derivative of $\\tfrac{1}{2}\\,(\\mathbf{u}_h,\\mathbf{u}_h)_L$ equals $0$.**\nTo check this statement, we set $\\nu = 0$ and $\\mathbf{f} = \\mathbf{0}$ in the derived energy balance equation:\n$$\n\\frac{d}{dt}\\left(\\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L\\right) + 0 \\cdot \\|\\nabla \\mathbf{u}_h\\|_{\\mathrm{L}^2}^2 = (\\mathbf{0}, \\mathbf{u}_h)_L\n$$\nThis simplifies to:\n$$\n\\frac{d}{dt}\\left(\\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L\\right) = 0\n$$\nThis confirms that the discrete kinetic energy measured in the lumped inner product, $E_L = \\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L$, is exactly conserved.\n**Verdict: Correct.**\n\n**B. When mass lumping is used as described, the skew-symmetry of the discrete convection operator is lost unless the discrete velocity is exactly divergence-free, and therefore $\\mathbf{u}_h^\\top N(\\mathbf{u}_h)\\mathbf{u}_h$ need not vanish.**\nThis statement is flawed. The entire purpose of using the skew-symmetric form $c_s(\\mathbf{w}; \\mathbf{v}, \\mathbf{z})$ is to guarantee that the resulting convection operator is non-dissipative without requiring the velocity field $\\mathbf{w}$ to be divergence-free. The property $c_s(\\mathbf{w}; \\mathbf{v}, \\mathbf{v}) = 0$ is an algebraic identity that holds for any sufficiently regular functions, including discrete functions $\\mathbf{u}_h, \\mathbf{v}_h \\in \\mathbf{V}_h$, regardless of whether $\\nabla \\cdot \\mathbf{u}_h = 0$. In matrix-vector notation, if $C_s(\\mathbf{U})$ is the matrix for the operator $c_s(\\mathbf{u}_h; \\cdot, \\cdot)$, then $C_s(\\mathbf{U})$ is skew-symmetric by construction, and thus $\\mathbf{V}^T C_s(\\mathbf{U}) \\mathbf{V} = 0$ for any vector $\\mathbf{V}$. The term $\\mathbf{u}_h^\\top N(\\mathbf{u}_h)\\mathbf{u}_h$ is a notation for $c_s(\\mathbf{u}_h;\\mathbf{u}_h,\\mathbf{u}_h)$, which is identically zero. The statement incorrectly attributes properties of the standard convective form $((\\mathbf{u}_h \\cdot \\nabla)\\mathbf{u}_h, \\mathbf{v}_h)$ to the skew-symmetric form.\n**Verdict: Incorrect.**\n\n**C. If the convection operator is kept in skew-symmetric form assembled by exact integration but only the mass matrix is lumped, then in the inviscid and unforced case the discrete kinetic energy measured in the consistent $\\mathrm{L}^2(\\Omega)$ inner product, i.e., $\\tfrac{1}{2}\\,(\\mathbf{u}_h,\\mathbf{u}_h)$, is exactly preserved.**\nThis statement considers the evolution of the standard (consistent) kinetic energy $E(t) = \\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)$. Its time derivative is $\\frac{dE}{dt} = (\\partial_t \\mathbf{u}_h, \\mathbf{u}_h)$.\nThe governing equation (with $\\nu=0, \\mathbf{f}=\\mathbf{0}$) is $(\\partial_t \\mathbf{u}_h, \\mathbf{v}_h)_L = -c_s(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{v}_h) + (p_h, \\nabla \\cdot \\mathbf{v}_h)$.\nThe inner product on the left, $(\\cdot, \\cdot)_L$, is different from the one in the term we wish to evaluate, $(\\partial_t \\mathbf{u}_h, \\mathbf{u}_h)$. Let $M$ be the consistent mass matrix associated with $(\\cdot,\\cdot)$, and $M_L$ be the lumped (diagonal) mass matrix for $(\\cdot,\\cdot)_L$. Let $\\mathbf{U}$ be the vector of degrees of freedom for $\\mathbf{u}_h$. The semi-discrete system is $M_L \\frac{d\\mathbf{U}}{dt} = -C_s(\\mathbf{U})\\mathbf{U} - G^T \\mathbf{P}$. The rate of change of consistent energy is $\\frac{dE}{dt} = (\\frac{d\\mathbf{U}}{dt})^T M \\mathbf{U}$. Substituting for $\\frac{d\\mathbf{U}}{dt}$:\n$$ \\frac{dE}{dt} = (-M_L^{-1} (C_s(\\mathbf{U})\\mathbf{U} + G^T \\mathbf{P}))^T M \\mathbf{U} = -(C_s(\\mathbf{U})\\mathbf{U} + G^T \\mathbf{P})^T (M_L^{-1})^T M \\mathbf{U} $$\nSince $C_s(\\mathbf{U})$ is skew-symmetric and the continuity equation $G\\mathbf{U}=\\mathbf{0}$ holds, this simplifies to evaluating the term $\\mathbf{U}^T C_s(\\mathbf{U}) M_L^{-1} M \\mathbf{U}$. In general, the matrix product $M_L^{-1}M$ is not the identity matrix $I$, and it does not commute with $C_s(\\mathbf{U})$. Thus, the expression $\\mathbf{U}^T C_s(\\mathbf{U}) (M_L^{-1} M) \\mathbf{U}$ is not guaranteed to be zero. Therefore, the consistent kinetic energy is not conserved.\n**Verdict: Incorrect.**\n\n**D. If one uses the same inexact quadrature that produces the lumped mass also to assemble both occurrences of the skew-symmetric trilinear form $c_s(\\cdot;\\cdot,\\cdot)$, then the algebraic identity $c_s(\\mathbf{u}_h;\\mathbf{v}_h,\\mathbf{v}_h)=0$ holds exactly for all $\\mathbf{v}_h \\in \\mathbf{V}_h$, so that in the inviscid and unforced case the mass-lumped scheme preserves the discrete kinetic energy measured in the lumped inner product.**\nThis option proposes a modified scheme where the convection term is also assembled using the lumping quadrature rule. Let's denote this by $(\\cdot, \\cdot)_L$. The modified convection term is $c_{s,L}(\\mathbf{w};\\mathbf{v},\\mathbf{z}) := \\tfrac{1}{2}\\,\\Big( ((\\mathbf{w}\\cdot \\nabla)\\mathbf{v},\\mathbf{z})_L - ((\\mathbf{w}\\cdot \\nabla)\\mathbf{z},\\mathbf{v})_L \\Big)$.\nThe statement first claims that $c_{s,L}(\\mathbf{u}_h;\\mathbf{v}_h,\\mathbf{v}_h)=0$. Let's check:\n$$ c_{s,L}(\\mathbf{u}_h;\\mathbf{v}_h,\\mathbf{v}_h) = \\tfrac{1}{2}\\,\\Big( ((\\mathbf{u}_h\\cdot \\nabla)\\mathbf{v}_h,\\mathbf{v}_h)_L - ((\\mathbf{u}_h\\cdot \\nabla)\\mathbf{v}_h,\\mathbf{v}_h)_L \\Big) = 0 $$\nThis is an algebraic identity, so the first part of the statement is correct.\nThe second part claims this leads to conservation of the lumped kinetic energy for this modified scheme. The energy balance for this new scheme with $\\nu=0, \\mathbf{f}=\\mathbf{0}$ is obtained by setting $\\mathbf{v}_h=\\mathbf{u}_h$ in its weak form:\n$$ (\\partial_t \\mathbf{u}_h, \\mathbf{u}_h)_L + c_{s,L}(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{u}_h) - (p_h, \\nabla \\cdot \\mathbf{u}_h) = 0 $$\nWe have $\\frac{d}{dt} \\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L$ for the first term. The second term $c_{s,L}(\\mathbf{u}_h; \\mathbf{u}_h, \\mathbf{u}_h)=0$. The third term $(p_h, \\nabla \\cdot \\mathbf{u}_h)=0$ from the discrete continuity equation (assuming it is assembled exactly). Thus, we get $\\frac{d}{dt} \\frac{1}{2}(\\mathbf{u}_h, \\mathbf{u}_h)_L = 0$. The statement is logically sound.\n**Verdict: Correct.**\n\n**E. Mass lumping always introduces artificial dissipation into the inviscid and unforced semi-discrete scheme, irrespective of how the convection operator is assembled, so that the discrete kinetic energy strictly decreases in time unless $\\mathbf{u}_h\\equiv \\mathbf{0}$.**\nThis is a strong generalization that is false. Option A provides a direct counterexample for the scheme described in the problem statement: the lumped kinetic energy is exactly conserved, not dissipated. Option D provides another counterexample for a modified scheme, where the lumped kinetic energy is also exactly conserved. The word \"always\" and the phrase \"irrespective of how the convection operator is assembled\" make the statement incorrect.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{AD}$$", "id": "2582653"}]}