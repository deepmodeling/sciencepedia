{"hands_on_practices": [{"introduction": "To truly understand the serendipity family, it's essential to build its basis from the ground up. This first exercise guides you through the explicit construction of the eight-node quadratic serendipity ($S_2$) shape functions on the reference element. By deriving these functions from the Lagrange interpolation principle and edge-restriction requirements, you will gain a concrete understanding of how these elements eliminate the interior \"bubble\" mode of the corresponding Lagrangian ($Q_2$) element while preserving quadratic accuracy along the element boundaries [@problem_id:2594808].", "problem": "Let $\\hat K = [-1, 1] \\times [-1, 1]$ be the reference square with coordinates $(\\xi,\\eta)$. Consider the tensor-product quadratic Lagrangian family $Q_2(\\hat K)$ with nodes at the four vertices $(\\pm 1,\\pm 1)$, the four edge midpoints $(0,\\pm 1)$ and $(\\pm 1,0)$, and the interior node $(0,0)$. The serendipity quadratic family $S_2(\\hat K)$ uses the same eight boundary nodes but omits the interior node, and its polynomial space is the set of all polynomials in $\\xi$ and $\\eta$ whose superlinear degree is at most two.\n\nUsing only the finite element triple definition $(\\hat K, \\mathcal{P}, \\mathcal{N})$ (domain, polynomial space, and nodal functionals) and the Lagrange interpolation principle, derive explicit formulas in terms of $\\xi$ and $\\eta$ for the eight nodal shape functions $\\{N_i\\}_{i=1}^{8} \\subset S_2(\\hat K)$ that satisfy the Kronecker property $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$ at the ordered node set\n- $N_1$ at $(-1,-1)$, $N_2$ at $(1,-1)$, $N_3$ at $(1,1)$, $N_4$ at $(-1,1)$,\n- $N_5$ at $(0,-1)$, $N_6$ at $(1,0)$, $N_7$ at $(0,1)$, $N_8$ at $(-1,0)$.\n\nThen, starting from the one-dimensional quadratic Lagrange basis on $\\{-1,0,1\\}$ and the requirement that restrictions to edges reproduce this basis, verify that:\n- On each edge $\\eta=\\pm 1$ or $\\xi=\\pm 1$, the restrictions of the three shape functions associated with that edge form the univariate quadratic Lagrange basis on $\\{-1,0,1\\}$ (i.e., edge quadratics are retained).\n- The interior bubble of $Q_2(\\hat K)$, namely $\\beta(\\xi,\\eta) = (1-\\xi^2)(1-\\eta^2)$, is eliminated in $S_2(\\hat K)$ in the sense that $\\beta \\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$.\n\nExpress your final answer as the ordered octuple $(N_1,\\dots,N_8)$ corresponding to the node order listed above. No numerical rounding is required, and no physical units apply.", "solution": "We begin from the finite element definition: a Lagrange finite element on $\\hat K$ is determined by a polynomial space $\\mathcal{P}$ and nodal functionals $\\mathcal{N}=\\{\\delta_{(\\xi_i,\\eta_i)}\\}$, with shape functions $\\{N_i\\}$ defined by $N_i \\in \\mathcal{P}$ and $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$. For $Q_2(\\hat K)$, the univariate quadratic Lagrange basis on the nodes $\\{-1,0,1\\}$ is given by\n$$\n\\ell_{-1}(t)=\\tfrac{1}{2}t(t-1),\\qquad \\ell_0(t)=1-t^2,\\qquad \\ell_{1}(t)=\\tfrac{1}{2}t(t+1).\n$$\nOn an edge, the two-dimensional shape functions must restrict to these one-dimensional polynomials in the appropriate edge variable. The serendipity space $S_2(\\hat K)$ of order two in two variables is the span of monomials with superlinear degree at most two, namely\n$$\n\\mathcal{P}_{\\mathrm{ser},2}=\\operatorname{span}\\{1, \\xi, \\eta, \\xi\\eta, \\xi^2, \\eta^2, \\xi^2\\eta, \\xi\\eta^2\\},\n$$\nwhich has dimension eight and is unisolvent for the eight boundary nodes.\n\nWe construct edge-midpoint shape functions first, because their factorization is direct from the edge restriction requirement. For the midpoint on the bottom edge at $(0,-1)$, we want the restriction on $\\eta=-1$ to equal $\\ell_0(\\xi)=1-\\xi^2$ and to vanish on the other three edges. The factor $(1-\\eta)$ vanishes on $\\eta=1$ and is nonzero on $\\eta=-1$, and the factor $(1-\\xi^2)$ vanishes at $\\xi=\\pm 1$. Thus\n$$\nN_5(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1-\\eta),\n$$\nsince $N_5(0,-1)=\\tfrac{1}{2}\\cdot 1\\cdot 2=1$ enforces the Kronecker condition at the node. By symmetry, the other edge-midpoint functions are\n$$\nN_6(\\xi,\\eta)=\\tfrac{1}{2}(1+\\xi)(1-\\eta^2),\\quad\nN_7(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi^2)(1+\\eta),\\quad\nN_8(\\xi,\\eta)=\\tfrac{1}{2}(1-\\xi)(1-\\eta^2).\n$$\nEach satisfies its own nodal conditions and vanishes at the other seven nodes. Moreover, on their corresponding edges they reduce to $\\ell_0$ in the edge variable: for example, $N_6(1,\\eta)=\\tfrac{1}{2}\\cdot 2\\cdot (1-\\eta^2)=1-\\eta^2=\\ell_0(\\eta)$, and on the other three edges at $\\xi=-1$ or $\\eta=\\pm 1$ they vanish.\n\nFor a vertex, say the bottom-left corner $(-1,-1)$, we require that on the bottom edge $\\eta=-1$, the restriction equals $\\ell_{-1}(\\xi)=\\tfrac{1}{2}\\xi(\\xi-1)$, and on the left edge $\\xi=-1$, the restriction equals $\\ell_{-1}(\\eta)=\\tfrac{1}{2}\\eta(\\eta-1)$. We seek $N_1$ in the form\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(\\alpha+\\beta\\,\\xi+\\gamma\\,\\eta\\big),\n$$\nwhich lies in $S_2(\\hat K)$ because the product generates only monomials in $\\mathcal{P}_{\\mathrm{ser},2}$: expanding yields terms among $\\{1,\\xi,\\eta,\\xi\\eta,\\xi^2,\\eta^2,\\xi^2\\eta,\\xi\\eta^2\\}$, and never $\\xi^2\\eta^2$. Impose the edge restrictions:\n- On $\\eta=-1$,\n$$\nN_1(\\xi,-1)=\\tfrac{1}{4}(1-\\xi)\\cdot 2\\cdot (\\alpha+\\beta\\,\\xi-\\gamma)=\\tfrac{1}{2}(1-\\xi)\\big((\\alpha-\\gamma)+\\beta\\,\\xi\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\xi(\\xi-1)=-\\tfrac{1}{2}(1-\\xi)\\xi,\n$$\nso $(\\alpha-\\gamma)+\\beta\\,\\xi=-\\xi$, which gives $\\beta=-1$ and $\\alpha-\\gamma=0$.\n- On $\\xi=-1$,\n$$\nN_1(-1,\\eta)=\\tfrac{1}{4}\\cdot 2\\cdot (1-\\eta)\\cdot (\\alpha-\\beta+\\gamma\\,\\eta)=\\tfrac{1}{2}(1-\\eta)\\big((\\alpha-\\beta)+\\gamma\\,\\eta\\big)\\stackrel{!}{=}\\tfrac{1}{2}\\eta(\\eta-1)=-\\tfrac{1}{2}(1-\\eta)\\eta,\n$$\nso $(\\alpha-\\beta)+\\gamma\\,\\eta=-\\eta$, which gives $\\gamma=-1$ and $\\alpha-\\beta=0$.\n\nCombining, $\\beta=-1$, $\\gamma=-1$, and $\\alpha=-1$. Therefore,\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)\\big(-1-\\xi-\\eta\\big)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1).\n$$\nBy symmetry, the remaining vertex functions that satisfy the corresponding edge restrictions are\n\\begin{align*}\nN_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1),\\\\\nN_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1),\\\\\nN_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1).\n\\end{align*}\nIt is immediate to check the Kronecker property: for instance, $N_1(-1,-1)=\\tfrac{1}{4}\\cdot 2\\cdot 2\\cdot (1+1-1)=1$, and $N_1$ vanishes at the other seven nodes because at least one linear factor $(1\\pm \\xi)$ or $(1\\pm \\eta)$ or the parenthesis enforces zero at each.\n\nEdge-quadratic retention. On an edge, the three shape functions tied to that edge reduce to the univariate Lagrange basis on $\\{-1,0,1\\}$. Consider the bottom edge $\\eta=-1$. We have\n\\begin{align*}\nN_1(\\xi,-1)=\\tfrac{1}{2}\\xi(\\xi-1)=\\ell_{-1}(\\xi),\\\\\nN_5(\\xi,-1)=(1-\\xi^2)=\\ell_0(\\xi),\\\\\nN_2(\\xi,-1)=\\tfrac{1}{2}\\xi(\\xi+1)=\\ell_{1}(\\xi),\n\\end{align*}\nand the other five shape functions vanish there. Analogous statements hold for the other three edges by symmetry. Hence the edge restrictions reproduce the quadratic Lagrange family along each edge.\n\nElimination of the $Q_2$ interior bubble. The $Q_2$ interior bubble is $\\beta(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$, which vanishes at all eight serendipity nodes but is nonzero in the interior (for example, $\\beta(0,0)=1$). Suppose, to the contrary, that $\\beta$ lies in $\\operatorname{span}\\{N_1,\\dots,N_8\\}$. Then\n$$\n\\beta=\\sum_{i=1}^{8} c_i N_i\n$$\nfor some coefficients $c_i$. Evaluating at each node $(\\xi_j,\\eta_j)$ gives $\\beta(\\xi_j,\\eta_j)=0$ for all eight nodes, but $N_i(\\xi_j,\\eta_j)=\\delta_{ij}$ by construction, so $0=\\beta(\\xi_j,\\eta_j)=c_j$ for each $j$. Therefore all $c_j=0$, implying $\\beta\\equiv 0$, a contradiction. Hence $\\beta\\notin \\operatorname{span}\\{N_1,\\dots,N_8\\}$, so the interior bubble of $Q_2(\\hat K)$ is eliminated in $S_2(\\hat K)$.\n\nCollecting the eight shape functions in the requested order gives the explicit formulas below.", "answer": "$$\\boxed{\\begin{pmatrix}\n\\tfrac{1}{4}(1-\\xi)(1-\\eta)(-\\xi-\\eta-1)  \\tfrac{1}{4}(1+\\xi)(1-\\eta)(\\xi-\\eta-1)  \\tfrac{1}{4}(1+\\xi)(1+\\eta)(\\xi+\\eta-1)  \\tfrac{1}{4}(1-\\xi)(1+\\eta)(-\\xi+\\eta-1)  \\tfrac{1}{2}(1-\\xi^2)(1-\\eta)  \\tfrac{1}{2}(1+\\xi)(1-\\eta^2)  \\tfrac{1}{2}(1-\\xi^2)(1+\\eta)  \\tfrac{1}{2}(1-\\xi)(1-\\eta^2)\n\\end{pmatrix}}$$", "id": "2594808"}, {"introduction": "Beyond constructing shape functions, it is crucial to analyze the underlying polynomial spaces that distinguish Serendipity from Lagrangian elements. This practice delves into the precise relationship between the biquadratic space $\\mathcal{Q}_2$ and its serendipity subspace $\\mathcal{S}_2$ by examining the highest-order monomial, $\\xi^2\\eta^2$. By decomposing this term into a serendipity component and a bubble function component, you will verify from first principles that the serendipity space is specifically constructed to exclude the interior bubble mode, providing a more formal perspective on the element's definition [@problem_id:2594813].", "problem": "Let $\\hat K = [-1, 1]^{2}$ with coordinates $(\\xi,\\eta)$ denote the reference quadrilateral. Let $\\mathcal{Q}_{2}(\\hat K)$ be the space of polynomials of separate degree at most $2$ in each variable, and let the quadratic serendipity space $\\mathcal{S}_{2}(\\hat K)$ be defined by the superlinear-degree characterization: a monomial $\\xi^{a}\\eta^{b}$ belongs to $\\mathcal{S}_{r}(\\hat K)$ if and only if the sum of exponents that are at least $2$ is at most $r$. Equivalently, $\\mathcal{S}_{2}(\\hat K)$ is the $8$-dimensional subspace of $\\mathcal{Q}_{2}(\\hat K)$ whose traces on $\\partial\\hat K$ coincide with those of $\\mathcal{Q}_{2}(\\hat K)$, and which omits the interior bubble mode.\n\nDefine the quadratic bubble $b(\\xi,\\eta)=(1-\\xi^{2})(1-\\eta^{2})$. It is known that any $p\\in \\mathcal{Q}_{2}(\\hat K)$ admits a unique decomposition $p=\\alpha\\,b+s$, with $\\alpha\\in\\mathbb{R}$ and $s\\in \\mathcal{S}_{2}(\\hat K)$.\n\nUsing only the foundational definitions above and reasoning from first principles, determine the unique scalar $\\alpha\\in\\mathbb{R}$ in the decomposition\n$$\np(\\xi,\\eta)=\\xi^{2}\\eta^{2}=\\alpha\\,b(\\xi,\\eta)+s(\\xi,\\eta),\\quad s\\in \\mathcal{S}_{2}(\\hat K).\n$$\nYour derivation must justify whether $\\xi^{2}\\eta^{2}$ lies in $\\mathcal{S}_{2}(\\hat K)$ by explicitly constructing $s$ or by exhibiting a constraint functional that annihilates $\\mathcal{S}_{2}(\\hat K)$ but not $\\xi^{2}\\eta^{2}$. Provide the value of $\\alpha$ as your final answer. No rounding is required.", "solution": "The problem is to determine the unique scalar $\\alpha \\in \\mathbb{R}$ in the decomposition of the polynomial $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ into a component proportional to the quadratic bubble function $b(\\xi, \\eta)$ and a component $s(\\xi, \\eta)$ from the quadratic serendipity space $\\mathcal{S}_{2}(\\hat K)$. The given decomposition is\n$$\np(\\xi, \\eta) = \\alpha \\, b(\\xi, \\eta) + s(\\xi, \\eta)\n$$\nwhere $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$, $b(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2})$, and $s(\\xi, \\eta) \\in \\mathcal{S}_{2}(\\hat K)$.\n\nFirst, we must precisely characterize the space $\\mathcal{S}_{2}(\\hat K)$. The problem provides a definitive characterization based on its monomial basis. A monomial $\\xi^{a}\\eta^{b}$ is a basis element of $\\mathcal{S}_{r}(\\hat K)$ if the sum of its exponents that are at least $2$ is at most $r$. For our case, $r=2$. The space of biquadratic polynomials $\\mathcal{Q}_{2}(\\hat K)$ on the reference square $\\hat K = [-1, 1]^{2}$ is spanned by the $9$ monomials $\\{ \\xi^{a}\\eta^{b} \\mid a, b \\in \\{0, 1, 2\\} \\}$. We test each monomial for inclusion in the basis of $\\mathcal{S}_{2}(\\hat K)$. Let $\\delta(k) = k$ if $k \\ge 2$ and $\\delta(k)=0$ if $k  2$. The condition for inclusion of $\\xi^{a}\\eta^{b}$ is $\\delta(a) + \\delta(b) \\le 2$.\n\n- For $\\{1, \\xi, \\eta, \\xi\\eta\\}$, both exponents are less than $2$, so $\\delta(a)+\\delta(b) = 0 \\le 2$. These are in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}$, we have $a=2, b=0$. $\\delta(2) + \\delta(0) = 2+0=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\eta^{2}$, we have $a=0, b=2$. $\\delta(0) + \\delta(2) = 0+2=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}\\eta$, we have $a=2, b=1$. $\\delta(2) + \\delta(1) = 2+0=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi\\eta^{2}$, we have $a=1, b=2$. $\\delta(1) + \\delta(2) = 0+2=2 \\le 2$. This is in $\\mathcal{S}_{2}(\\hat K)$.\n- For $\\xi^{2}\\eta^{2}$, we have $a=2, b=2$. $\\delta(2) + \\delta(2) = 2+2=4 > 2$. This monomial is not in $\\mathcal{S}_{2}(\\hat K)$.\n\nThis analysis explicitly demonstrates that the polynomial $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ does not belong to the space $\\mathcal{S}_{2}(\\hat K)$, as required by the problem prompt. The space $\\mathcal{S}_{2}(\\hat K)$ is the $8$-dimensional space spanned by the monomial basis $\\{1, \\xi, \\eta, \\xi\\eta, \\xi^{2}, \\eta^{2}, \\xi^{2}\\eta, \\xi\\eta^{2}\\}$. Consequently, any polynomial $s \\in \\mathcal{S}_{2}(\\hat K)$, when written in the monomial basis of $\\mathcal{Q}_{2}(\\hat K)$, must have a zero coefficient for the $\\xi^{2}\\eta^{2}$ term.\n\nNow we proceed to find $\\alpha$. The bubble function is expanded as\n$$\nb(\\xi, \\eta) = (1 - \\xi^{2})(1 - \\eta^{2}) = 1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}.\n$$\nSubstitute this and $p(\\xi, \\eta) = \\xi^{2}\\eta^{2}$ into the decomposition equation:\n$$\n\\xi^{2}\\eta^{2} = \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2}) + s(\\xi, \\eta).\n$$\nTo determine the properties of $s(\\xi, \\eta)$, we isolate it:\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha (1 - \\xi^{2} - \\eta^{2} + \\xi^{2}\\eta^{2})\n$$\n$$\ns(\\xi, \\eta) = \\xi^{2}\\eta^{2} - \\alpha + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha\\xi^{2}\\eta^{2}.\n$$\nCollecting terms by monomial, we obtain the expression for $s(\\xi, \\eta)$ in the standard monomial basis:\n$$\ns(\\xi, \\eta) = (1 - \\alpha)\\xi^{2}\\eta^{2} + \\alpha\\xi^{2} + \\alpha\\eta^{2} - \\alpha.\n$$\nFor $s(\\xi, \\eta)$ to be an element of $\\mathcal{S}_{2}(\\hat K)$, the coefficient of the $\\xi^{2}\\eta^{2}$ term must be zero. This provides a necessary and sufficient condition on $\\alpha$:\n$$\n1 - \\alpha = 0.\n$$\nSolving for $\\alpha$ yields the unique value:\n$$\n\\alpha = 1.\n$$\nWith $\\alpha=1$, we can explicitly construct the serendipity component $s(\\xi, \\eta)$ as required:\n$$\ns(\\xi, \\eta) = (1 - 1)\\xi^{2}\\eta^{2} + (1)\\xi^{2} + (1)\\eta^{2} - 1 = \\xi^{2} + \\eta^{2} - 1.\n$$\nThis polynomial $s(\\xi, \\eta) = \\xi^{2} + \\eta^{2} - 1$ is a linear combination of the basis elements $\\{1, \\xi^{2}, \\eta^{2}\\}$, all of which belong to $\\mathcal{S}_{2}(\\hat K)$. Therefore, $s(\\xi, \\eta)$ is indeed in $\\mathcal{S}_{2}(\\hat K)$. The unique decomposition is thus:\n$$\n\\xi^{2}\\eta^{2} = 1 \\cdot (1 - \\xi^{2})(1 - \\eta^{2}) + (\\xi^{2} + \\eta^{2} - 1).\n$$\nThe value of the scalar $\\alpha$ is unequivocally determined to be $1$.", "answer": "$$\n\\boxed{1}\n$$", "id": "2594813"}, {"introduction": "The choice between element families has significant practical implications for computational cost. This exercise shifts focus to the numerical integration required to form the element stiffness matrix, a core operation in any finite element analysis. By determining the minimal Gauss quadrature rule needed to exactly integrate the stiffness matrix for the tensor-product Lagrangian ($Q_k$) family, you will quantify one of its primary drawbacks compared to the more efficient serendipity family, highlighting the fundamental trade-off between polynomial completeness and computational expense [@problem_id:2594823].", "problem": "Let $K \\subset \\mathbb{R}^2$ be a single affine quadrilateral finite element obtained from the reference square $\\hat{K} = [-1, 1]^2$ via an affine map $F : \\hat{K} \\to K$ with constant Jacobian matrix $J$ and constant determinant $\\det J \\neq 0$. Consider the Lagrangian tensor-product quadrilateral family $Q_k$ on $\\hat{K}$, i.e., the space of polynomials that are of degree at most $k$ in each variable separately. Let $\\{\\hat{\\phi}_i\\}$ denote the nodal basis of $Q_k$ on $\\hat{K}$, and let $\\phi_i = \\hat{\\phi}_i \\circ F^{-1}$ denote the corresponding basis on $K$. The local stiffness matrix entries for the Poisson bilinear form are\n$$\nA_{ij} \\;=\\; \\int_{K} \\nabla \\phi_i(x) \\cdot \\nabla \\phi_j(x) \\, dx.\n$$\nAssume a tensor-product Gauss–Legendre quadrature with $n$ points per coordinate direction on $\\hat{K}$ is used to evaluate these integrals exactly by pulling back the integral to $\\hat{K}$. Using only fundamental properties of affine mappings, polynomial degree under differentiation, and exactness of Gauss–Legendre quadrature in one dimension, determine the minimal number $n$ of Gauss points per coordinate direction (as a function of $k$) required so that the quadrature is exact for all entries $A_{ij}$ for any affine quadrilateral $K$. Provide a mathematical justification for your choice of $n$. Express your final answer as a closed-form expression in $k$.", "solution": "The problem as stated is well-posed and scientifically grounded. We proceed with a formal derivation.\n\nThe local stiffness matrix entries are given by the integral over the physical element $K$:\n$$\nA_{ij} = \\int_{K} \\nabla_x \\phi_i(x) \\cdot \\nabla_x \\phi_j(x) \\, dx\n$$\nHere, $\\phi_i$ are the basis functions on the physical element $K$, and $\\nabla_x$ denotes the gradient with respect to the physical coordinates $x \\in \\mathbb{R}^2$. To evaluate this integral using a quadrature rule defined on the reference element $\\hat{K} = [-1, 1]^2$, we must perform a change of variables using the affine map $x = F(\\hat{x})$, where $\\hat{x} = (\\xi, \\eta) \\in \\hat{K}$.\n\nThe transformation of the gradient vector is given by the chain rule:\n$$\n\\nabla_{\\hat{x}} (\\psi \\circ F)(\\hat{x}) = J^T \\nabla_x \\psi(F(\\hat{x}))\n$$\nwhere $J$ is the Jacobian matrix of the map $F$. Since $F$ is an affine map, its Jacobian $J$ is a constant matrix. From the transformation rule, we express the physical gradient in terms of the reference gradient:\n$$\n\\nabla_x \\psi(x) = J^{-T} \\nabla_{\\hat{x}} (\\psi \\circ F)(\\hat{x})\n$$\nThe basis functions are defined as $\\phi_i = \\hat{\\phi}_i \\circ F^{-1}$, which implies $\\phi_i(x) = \\hat{\\phi}_i(\\hat{x})$. Applying the gradient transformation, we get:\n$$\n\\nabla_x \\phi_i(x) = J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_i(\\hat{x})\n$$\nThe dot product in the integrand becomes:\n$$\n\\nabla_x \\phi_i(x) \\cdot \\nabla_x \\phi_j(x) = \\left( J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_i(\\hat{x}) \\right) \\cdot \\left( J^{-T} \\nabla_{\\hat{x}} \\hat{\\phi}_j(\\hat{x}) \\right) = \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_i \\right)^T (J^{-1} J^{-T}) \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_j \\right)\n$$\nThe differential area element transforms as $dx = |\\det J| \\, d\\hat{x}$. Substituting these into the integral for $A_{ij}$, we obtain the integral over the reference element:\n$$\nA_{ij} = \\int_{\\hat{K}} \\left[ \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_i \\right)^T (J^{-1} J^{-T}) \\left( \\nabla_{\\hat{x}} \\hat{\\phi}_j \\right) \\right] |\\det J| \\, d\\hat{x}\n$$\nLet the constant matrix $C = |\\det J| (J^{-1} J^{-T})$ have entries $C_{ab}$. The integrand can be expanded in terms of the reference coordinates $(\\xi, \\eta)$:\n$$\nI(\\xi, \\eta) = C_{11} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi} + C_{12} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta} + C_{21} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi} + C_{22} \\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\n$$\nThe basis functions $\\hat{\\phi}_i$ and $\\hat{\\phi}_j$ belong to the space $Q_k$, which consists of polynomials of degree at most $k$ in each variable $\\xi$ and $\\eta$ separately.\nLet $\\text{deg}_{\\xi}(p)$ and $\\text{deg}_{\\eta}(p)$ denote the polynomial degree of $p$ in variables $\\xi$ and $\\eta$, respectively. For any $\\hat{\\phi} \\in Q_k$, we have $\\text{deg}_{\\xi}(\\hat{\\phi}) \\le k$ and $\\text{deg}_{\\eta}(\\hat{\\phi}) \\le k$.\n\nUpon differentiation, the degrees change as follows:\n$$\n\\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\xi}\\right) \\le k-1, \\quad \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\xi}\\right) \\le k\n$$\n$$\n\\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\eta}\\right) \\le k, \\quad \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}}{\\partial \\eta}\\right) \\le k-1\n$$\nNow we analyze the degree of each term in the integrand $I(\\xi, \\eta)$:\n1. For the term $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}$:\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}\\right) \\le (k-1) + (k-1) = 2k-2 $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\xi}\\right) \\le k + k = 2k $$\n2. For the term $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}$ (and its symmetric counterpart):\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le (k-1) + k = 2k-1 $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\xi} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le k + (k-1) = 2k-1 $$\n3. For the term $\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}$:\n   $$ \\text{deg}_{\\xi}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le k + k = 2k $$\n   $$ \\text{deg}_{\\eta}\\left(\\frac{\\partial \\hat{\\phi}_i}{\\partial \\eta} \\frac{\\partial \\hat{\\phi}_j}{\\partial \\eta}\\right) \\le (k-1) + (k-1) = 2k-2 $$\n\nThe integrand $I(\\xi, \\eta)$ is a sum of these terms multiplied by constants. The maximum degree of $I(\\xi, \\eta)$ in $\\xi$ is the maximum of the degrees of the individual terms in $\\xi$, which is $\\max(2k-2, 2k-1, 2k) = 2k$. Similarly, the maximum degree of $I(\\xi, \\eta)$ in $\\eta$ is $\\max(2k, 2k-1, 2k-2) = 2k$.\n\nThe integral is evaluated using a tensor-product Gauss-Legendre quadrature rule with $n$ points in each coordinate direction:\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} I(\\xi, \\eta) \\, d\\xi \\, d\\eta \\approx \\sum_{p=1}^{n} \\sum_{q=1}^{n} w_p w_q I(\\xi_p, \\eta_q)\n$$\nFor this quadrature to be exact, the one-dimensional quadrature in each variable must be exact. A one-dimensional Gauss-Legendre quadrature with $n$ points is exact for any polynomial of degree up to $2n-1$.\nTo exactly integrate $I(\\xi, \\eta)$ with respect to $\\xi$, we require the quadrature to be exact for polynomials of degree up to $\\text{deg}_{\\xi}(I) = 2k$. This imposes the condition:\n$$\n2n - 1 \\ge 2k\n$$\nTo exactly integrate with respect to $\\eta$, we similarly require exactness for polynomials of degree up to $\\text{deg}_{\\eta}(I) = 2k$. This gives the same condition:\n$$\n2n - 1 \\ge 2k\n$$\nSolving this inequality for $n$:\n$$\n2n \\ge 2k + 1 \\implies n \\ge k + \\frac{1}{2}\n$$\nSince the number of quadrature points $n$ must be an integer, the minimal value for $n$ that satisfies this condition is the smallest integer greater than or equal to $k + \\frac{1}{2}$, which is $k+1$. This choice of $n$ guarantees exact integration for all entries $A_{ij}$ of the stiffness matrix for any affine quadrilateral element $K$.", "answer": "$$\n\\boxed{k+1}\n$$", "id": "2594823"}]}