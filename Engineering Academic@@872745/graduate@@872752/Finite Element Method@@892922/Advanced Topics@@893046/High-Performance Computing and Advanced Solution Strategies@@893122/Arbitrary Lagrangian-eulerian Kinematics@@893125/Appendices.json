{"hands_on_practices": [{"introduction": "To effectively use the Arbitrary Lagrangian-Eulerian (ALE) framework, we must first understand how a standard conservation law transforms when viewed from a moving reference frame. This foundational exercise guides you through the derivation of the one-dimensional advection equation in the ALE frame. By applying the multivariable chain rule, you will directly see how the mesh velocity, $w$, modifies the transport operator, leading to the crucial concept of an effective advection speed relative to the moving mesh. [@problem_id:2541251]", "problem": "Consider the one-dimensional linear advection of a scalar field $u(x,t)$ in a physical (spatial) frame on the interval $x \\in (0,L(t))$, governed in the spatial frame by the conservation law $\\frac{\\partial u}{\\partial t} + a \\,\\frac{\\partial u}{\\partial x} = 0$, where $a$ is a spatially uniform constant advection speed relative to the spatial frame. The computational mesh is allowed to move according to an Arbitrary Lagrangian-Eulerian (ALE) mapping $x = \\chi(X,t)$ from a fixed referential coordinate $X \\in (0,L_{0})$ to the physical coordinate $x$, with mesh velocity defined kinematically as $w(x,t) = \\left.\\frac{\\partial \\chi}{\\partial t}\\right|_{X}$ evaluated at the current spatial position $x = \\chi(X,t)$. \n\nStarting strictly from fundamental kinematics and calculus (in particular, the chain rule for multivariable functions and the definition of the mesh velocity as the time rate of change of the ALE mapping at fixed referential coordinate), and without assuming any ALE-form transport identity, derive the strong form of the advection equation expressed in the ALE frame, namely as an equation involving the time derivative of $u$ at fixed referential coordinate $X$ and spatial gradients with respect to $x$. In your derivation, clearly identify the function that multiplies $\\frac{\\partial u}{\\partial x}$ in the ALE strong form as an effective advection speed.\n\nYour final answer must be the analytical expression for this effective advection speed $v_{\\mathrm{eff}}(x,t)$ in terms of $a$ and $w(x,t)$. Provide only this expression as your final answer. No numerical evaluation is required.", "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It presents a standard derivation in the field of continuum mechanics and computational methods, specifically concerning Arbitrary Lagrangian-Eulerian (ALE) kinematics. There are no logical contradictions, missing information, or violations of fundamental principles. The problem is valid and a solution will be derived.\n\nThe objective is to derive the strong form of the one-dimensional linear advection equation in the ALE reference frame, starting from the given equation in the spatial (Eulerian) frame.\n\nThe governing equation in the spatial frame is:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nHere, the scalar field $u$ is considered a function of the spatial coordinate $x$ and time $t$, so $u = u(x,t)$. The partial derivative $\\frac{\\partial u}{\\partial t}$ is therefore taken at a fixed spatial position $x$. This is the Eulerian time derivative.\n\nThe ALE formulation introduces a referential coordinate $X$, which is fixed for a given mesh point. The physical position $x$ of this mesh point is given by the mapping $x = \\chi(X,t)$. The scalar field $u$ can now be considered a function of the referential coordinate $X$ and time $t$, which we may denote as $\\hat{u}(X,t) = u(\\chi(X,t), t)$.\n\nThe problem asks for an equation involving the time derivative of $u$ at a fixed referential coordinate $X$. This is the ALE time derivative, $\\left.\\frac{\\partial u}{\\partial t}\\right|_{X}$, which corresponds to the time derivative of $\\hat{u}$ with respect to $t$ holding $X$ constant:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} \\equiv \\frac{\\partial \\hat{u}}{\\partial t}(X,t) = \\frac{\\partial}{\\partial t} \\left[ u(\\chi(X,t), t) \\right]\n$$\nWe apply the chain rule for multivariable functions to the right-hand side. The function $u$ depends on time $t$ through its first argument, $\\chi(X,t)$, and its second argument, $t$.\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} = \\frac{\\partial u}{\\partial x} \\frac{\\partial \\chi}{\\partial t} + \\frac{\\partial u}{\\partial t} \\frac{dt}{dt}\n$$\nIn this expression, $\\frac{\\partial u}{\\partial x}$ and $\\frac{\\partial u}{\\partial t}$ are the partial derivatives of $u(x,t)$ with respect to its arguments, evaluated at $(x,t) = (\\chi(X,t), t)$. The derivative $\\frac{\\partial \\chi}{\\partial t}$ is taken holding $X$ fixed. The problem defines this quantity as the mesh velocity, $w(x,t)$:\n$$\nw(x,t) = \\left.\\frac{\\partial \\chi}{\\partial t}\\right|_{X}\n$$\nThe derivative $\\frac{\\partial u}{\\partial t}$ on the right-hand side of the chain rule expansion is the rate of change of $u$ at a fixed spatial position $x$, which is the Eulerian time derivative. Substituting the definition of the mesh velocity, we obtain the fundamental kinematic relationship between the ALE (or material) time derivative and the Eulerian (or spatial) time derivative:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} = \\left.\\frac{\\partial u}{\\partial t}\\right|_{x} + w(x,t) \\frac{\\partial u}{\\partial x}\n$$\nTo find the governing equation in the ALE frame, we must substitute the Eulerian time derivative from the original conservation law. First, we rearrange the kinematic relationship to solve for the Eulerian time derivative:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{x} = \\left.\\frac{\\partial u}{\\partial t}\\right|_{X} - w(x,t) \\frac{\\partial u}{\\partial x}\n$$\nNow, substitute this expression into the given spatial conservation law, $\\left.\\frac{\\partial u}{\\partial t}\\right|_{x} + a \\frac{\\partial u}{\\partial x} = 0$:\n$$\n\\left( \\left.\\frac{\\partial u}{\\partial t}\\right|_{X} - w(x,t) \\frac{\\partial u}{\\partial x} \\right) + a \\frac{\\partial u}{\\partial x} = 0\n$$\nFinally, we group the terms containing the spatial gradient $\\frac{\\partial u}{\\partial x}$ to obtain the strong form of the advection equation in the ALE frame:\n$$\n\\left.\\frac{\\partial u}{\\partial t}\\right|_{X} + (a - w(x,t)) \\frac{\\partial u}{\\partial x} = 0\n$$\nThis equation describes the evolution of the scalar field $u$ as observed from the moving computational mesh. The term multiplying the spatial gradient $\\frac{\\partial u}{\\partial x}$ represents the velocity of the advected quantity relative to the moving mesh. This is the effective advection speed, $v_{\\mathrm{eff}}(x,t)$.\n\nBy inspection, the effective advection speed is:\n$$\nv_{\\mathrm{eff}}(x,t) = a - w(x,t)\n$$\nThis result is physically intuitive: $a$ is the velocity of the fluid in the stationary frame, and $w(x,t)$ is the velocity of the mesh a point is convected with, and the rate of transport observed in the mesh frame is driven by the relative velocity between the fluid and the mesh, which is $a - w(x,t)$.", "answer": "$$\\boxed{a - w(x,t)}$$", "id": "2541251"}, {"introduction": "The shift to a moving reference frame has profound consequences that extend beyond the form of the governing equations; it can redefine the nature of the domain boundaries for the solver. This problem confronts a critical issue in practical ALE simulations: the classification of inflow versus outflow boundaries. You will analyze a scenario where the mesh moves faster than the fluid, causing a physical outflow boundary to behave as an inflow boundary in the ALE frame, a situation determined by the sign of the relative velocity normal to the boundary, $(v-w) \\cdot n$. [@problem_id:2541226] Understanding this dynamic is essential for ensuring the well-posedness and stability of numerical solutions.", "problem": "Consider a conserved scalar field $u$ transported by a fluid with physical velocity $v$ in a time-dependent spatial domain $\\Omega(t)$ that is discretized with an Arbitrary Lagrangian-Eulerian (ALE) mesh moving with prescribed mesh velocity $w$. Let $\\Gamma(t)=\\partial\\Omega(t)$ denote the boundary with outward unit normal $n$. The relative convective velocity is defined by $v^{\\mathrm{rel}}:=v-w$. Assume negligible diffusion on a portion of the boundary and consider an open boundary subset $\\Gamma_{o}(t)\\subset\\Gamma(t)$ that is initially intended to be an outflow boundary according to the physical velocity, in the sense that $v\\cdot n0$ on $\\Gamma_{o}(t)$. However, due to the prescribed mesh motion, there exists a time interval and a nontrivial subset $\\Gamma_{o}^{-}(t)\\subset\\Gamma_{o}(t)$ where $w\\cdot nv\\cdot n$, so that $v^{\\mathrm{rel}}\\cdot n0$ holds on $\\Gamma_{o}^{-}(t)$. Starting from the Reynolds transport theorem and the definition of relative convective flux in ALE kinematics, reason about the well-posedness of the transport problem and the stability of standard finite element semidiscretizations that use upwinding based on the sign of a convective normal flux. Then decide which of the following statements correctly describe the consequences and appropriate remedies when $v^{\\mathrm{rel}}\\cdot n$ changes sign due to $w$ locally exceeding $v$ on a boundary that was originally designated as an outflow.\n\nA. For the purposes of boundary classification in the ALE transport operator, $\\Gamma_{o}^{-}(t)$ must be treated as an inflow boundary because $v^{\\mathrm{rel}}\\cdot n0$, and suitable inflow data (e.g., Dirichlet or characteristic) for $u$ must be prescribed there; otherwise, the initial outflow-type condition is incompatible and can lead to loss of well-posedness and energy growth.\n\nB. It is sufficient to keep the original outflow classification on $\\Gamma_{o}(t)$ based on the sign of $v\\cdot n$, because the physical flow is still outward; the mismatch $v^{\\mathrm{rel}}\\cdot n0$ does not affect stability or weak formulations that are posed on the moving mesh.\n\nC. In a consistent upwind finite element or finite volume discretization of the ALE formulation, the numerical flux at the boundary depends on the sign of $v^{\\mathrm{rel}}\\cdot n$, so when $v^{\\mathrm{rel}}\\cdot n0$ on $\\Gamma_{o}^{-}(t)$ the boundary must supply exterior data for $u$; using the interior state alone would be inconsistent with the direction of characteristics relative to the moving mesh.\n\nD. Enforcing the Geometric Conservation Law (GCL) exactly is sufficient to prevent the sign change of $v^{\\mathrm{rel}}\\cdot n$ produced by the mesh motion; thus, with GCL, the outflow classification based on $v\\cdot n$ remains valid for the ALE formulation.\n\nE. A robust remedy is to constrain the normal component of the mesh velocity at intended outflow boundaries, for example by enforcing $w\\cdot n=v\\cdot n$ (or $w\\cdot n\\le v\\cdot n$), so that $v^{\\mathrm{rel}}\\cdot n\\ge 0$ and the boundary remains outflow in the ALE sense; alternatively, one may adopt characteristic open-boundary conditions that dynamically switch type with the sign of $v^{\\mathrm{rel}}\\cdot n$.\n\nSelect all correct statements.", "solution": "We begin from first principles. The Reynolds transport theorem applied to a scalar field $u$ over a time-dependent control volume $\\Omega(t)$ with boundary velocity $w$ gives that the time rate of change of the integral of $u$ over $\\Omega(t)$ equals the integral over $\\Omega(t)$ of the local time derivative plus the net flux through the boundary accounting for the motion. In differential form for a purely advective process with physical velocity $v$, the Arbitrary Lagrangian-Eulerian (ALE) formulation writes the conservation law as\n$$\n\\partial_{t} u\\big|_{X} + \\nabla\\cdot\\big(u\\, v^{\\mathrm{rel}}\\big) \\;=\\; 0,\n$$\nwhere $v^{\\mathrm{rel}} := v - w$ is the relative convective velocity and $\\partial_{t}\\big|_{X}$ denotes the time derivative at fixed referential coordinate. In integral form over $\\Omega(t)$, with outward unit normal $n$ on $\\partial\\Omega(t)$, this reads\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{\\Omega(t)} u \\,\\mathrm{d}x \\;+\\; \\int_{\\partial\\Omega(t)} u\\, (v^{\\mathrm{rel}}\\cdot n)\\, \\mathrm{d}s \\;=\\; 0.\n$$\nThus, the normal convective flux through the boundary is governed by $v^{\\mathrm{rel}}\\cdot n$, not by $v\\cdot n$ alone. The sign of $v^{\\mathrm{rel}}\\cdot n$ determines whether characteristics are entering or leaving the moving domain relative to the ALE frame.\n\nTo analyze stability, consider the $L^{2}$-energy method for the scalar advection equation in the ALE frame with negligible diffusion. Multiply the differential equation by $u$ and integrate over $\\Omega(t)$. Accounting for domain motion via Reynolds transport and integration by parts of the divergence term yields\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2}\\int_{\\Omega(t)} u^{2}\\,\\mathrm{d}x\\right) \\;+\\; \\frac{1}{2}\\int_{\\partial\\Omega(t)} u^{2}\\, (v^{\\mathrm{rel}}\\cdot n)\\, \\mathrm{d}s \\;=\\; 0,\n$$\nunder the assumption that the mesh motion satisfies the Geometric Conservation Law so that constant solutions are preserved. The boundary contribution involves $v^{\\mathrm{rel}}\\cdot n$. For stability without externally supplied boundary control, one requires that the net boundary term be nonnegative outflow, i.e., $v^{\\mathrm{rel}}\\cdot n\\ge 0$ on parts where no Dirichlet inflow data is prescribed. If $v^{\\mathrm{rel}}\\cdot n0$ on a portion of the boundary, then energy enters through that portion unless the entering state is prescribed or otherwise controlled.\n\nIn a finite element or finite volume discretization with upwind numerical fluxes consistent with characteristics, the boundary numerical flux is built using the sign of $v^{\\mathrm{rel}}\\cdot n$. If $v^{\\mathrm{rel}}\\cdot n0$, the incoming state must be provided by boundary data; otherwise, using the interior state would contradict the direction of information propagation, yielding inconsistency and potential instability.\n\nWith this foundation, we assess each statement:\n\nA. This statement asserts that when $v^{\\mathrm{rel}}\\cdot n0$ on $\\Gamma_{o}^{-}(t)$, the boundary must be treated as inflow for the ALE transport operator, and appropriate inflow data should be imposed. This follows directly from the integral and energy identities above: the boundary flux is $u (v^{\\mathrm{rel}}\\cdot n)$ and the energy boundary term is $\\frac{1}{2}u^{2}(v^{\\mathrm{rel}}\\cdot n)$. A negative sign corresponds to incoming characteristics relative to the moving mesh, and failing to prescribe the entering state leads to ill-posedness and energy growth. Therefore, A is Correct.\n\nB. This statement claims that maintaining the outflow classification based on $v\\cdot n$ is sufficient and that $v^{\\mathrm{rel}}\\cdot n0$ does not affect stability. This contradicts the ALE conservation law: the flux and characteristics that matter for the transport through the moving boundary are governed by $v^{\\mathrm{rel}}$, not $v$. If $v^{\\mathrm{rel}}\\cdot n0$, then characteristics enter the domain in the ALE frame, and keeping an outflow-type (do-nothing) condition is incompatible and can destabilize the scheme. Therefore, B is Incorrect.\n\nC. This statement describes the dependence of upwind numerical fluxes on the sign of $v^{\\mathrm{rel}}\\cdot n$ and the consequent need for exterior boundary data if the sign is negative. This is consistent with characteristic-based discretizations: at a boundary face, the upwind state is taken from the exterior when the normal convective speed $v^{\\mathrm{rel}}\\cdot n$ is negative. Hence, when $v^{\\mathrm{rel}}\\cdot n0$ on $\\Gamma_{o}^{-}(t)$, boundary data must be provided. Therefore, C is Correct.\n\nD. This statement attributes to the Geometric Conservation Law the prevention of sign changes in $v^{\\mathrm{rel}}\\cdot n$. The Geometric Conservation Law ensures that constant solutions are preserved under mesh motion and that metric terms are handled consistently; it does not constrain $w$ relative to $v$ nor does it prevent $w\\cdot nv\\cdot n$. Thus, GCL does not preclude $v^{\\mathrm{rel}}\\cdot n$ from changing sign. Therefore, D is Incorrect.\n\nE. This statement proposes remedies: constraining the mesh normal velocity so that $w\\cdot n=v\\cdot n$ (or $w\\cdot n\\le v\\cdot n$) at intended outflow boundaries, which implies $v^{\\mathrm{rel}}\\cdot n\\ge 0$, preserving outflow classification in the ALE sense; alternatively, using characteristic open boundary conditions that switch type with the sign of $v^{\\mathrm{rel}}\\cdot n$. These are established practices. Enforcing $w\\cdot n=v\\cdot n$ at outflow makes the relative normal speed zero, eliminating convective exchange across the moving boundary. Allowing $w\\cdot n\\le v\\cdot n$ ensures nonnegative relative outflow. Dynamic characteristic conditions are also consistent with the energy analysis. Therefore, E is Correct.\n\nIn summary, the correct statements are A, C, and E.", "answer": "$$\\boxed{ACE}$$", "id": "2541226"}, {"introduction": "Developing reliable numerical solvers requires rigorous verification, and the Method of Manufactured Solutions (MMS) is a cornerstone of this process. This exercise applies the MMS technique to the ALE framework for an advection-diffusion problem on a dynamically oscillating mesh. You will begin with a chosen analytical solution, derive the corresponding source term required to satisfy the governing ALE equation, and use theoretical error estimates to predict the numerical scheme's convergence rate. This comprehensive practice [@problem_id:2541241] demonstrates a complete workflow from analytical derivation to the design of a computational verification test.", "problem": "Consider the one-dimensional Arbitrary Lagrangian-Eulerian (ALE) formulation for a scalar advection-diffusion problem on a moving mesh. Let the reference coordinate be $X \\in [0,1]$, the physical coordinate be $x \\in [0,1]$, and time be $t \\in [0,T]$. The ALE mapping is defined by the smooth diffeomorphism $x = \\chi(X,t)$, and the mesh (grid) velocity is $w(x,t) = \\partial_t \\chi(X,t)$ composed with the inverse mapping $X = \\chi^{-1}(x,t)$. The Eulerian advection velocity is a given constant $c_0 \\in \\mathbb{R}$, and the diffusion coefficient is a positive constant $\\nu \\in \\mathbb{R}_{0}$. The scalar unknown $u(x,t)$ satisfies the strong form in the ALE frame,\n$$\n\\partial_t u(x,t) + \\big(c_0 - w(x,t)\\big)\\,\\partial_x u(x,t) - \\nu\\, \\partial_{xx} u(x,t) = f(x,t),\n$$\nwith homogeneous Dirichlet boundary conditions $u(0,t)=0$ and $u(1,t)=0$ for all $t \\in [0,T]$, and an initial condition $u(x,0)=u_0(x)$ consistent with the manufactured solution below.\n\nYou must work from first principles, namely the chain rule for time differentiation under a moving coordinate change, the strong Eulerian advection-diffusion equation, and basic finite element approximation theory. Do not use shortcut formulas or pre-derived ALE identities in the problem statement; instead, rely on accepted definitions and the chain rule leading to ALE kinematics.\n\nYour tasks are:\n\n- Construct an analytic manufactured solution for a family of oscillating meshes. Consider the ALE mapping\n$$\n\\chi(X,t) = X + a \\,\\sin(\\pi X)\\, \\sin(\\omega t),\n$$\nwhere $a \\in \\mathbb{R}$ is an amplitude and $\\omega \\in \\mathbb{R}$ is an angular frequency in radians per unit time. Assume the diffeomorphism condition holds, that is,\n$$\n\\inf_{(X,t)\\in [0,1]\\times[0,T]} \\partial_X \\chi(X,t)  0,\n$$\nwhich is guaranteed for $|a| \\pi  1$. Define the manufactured solution\n$$\nu(x,t) = e^{-\\lambda t}\\, \\sin(\\pi x),\n$$\nfor a fixed $\\lambda \\in \\mathbb{R}_{0}$. Using the chain rule and the ALE kinematics, derive the exact source term $f(x,t)$ that makes $u(x,t)$ satisfy the ALE strong form above. Express $f(x,t)$ in closed form using composition with the inverse mapping as needed.\n\n- Based on standard a priori error estimates for continuous Galerkin finite elements of polynomial degree $k \\in \\mathbb{N}$ in space and backward Euler in time on smooth moving meshes, justify that the $L^2$-in-space error at a fixed final time $T$ satisfies an estimate of the form\n$$\n\\|u(\\cdot,T) - u_h(\\cdot,T)\\|_{L^2(0,1)} \\le C_{\\text{mesh}} \\, h^{k+1} + C_{\\text{time}} \\, \\Delta t,\n$$\nwhere $h$ is the maximum element size in the physical domain at each time, $\\Delta t$ is the time step, $C_{\\text{mesh}}$ depends only on smooth bounds of the mapping and its inverse (but not on $h,\\Delta t$), and $C_{\\text{time}}$ depends on smooth norms of the exact solution. For the oscillatory ALE mapping above, show that $C_{\\text{mesh}}$ can be bounded in terms of the extremal Jacobians\n$$\nJ_{\\min} = \\inf_{(X,t)} \\partial_X \\chi(X,t) = 1 - |a| \\pi,\\qquad J_{\\max} = \\sup_{(X,t)} \\partial_X \\chi(X,t) = 1 + |a| \\pi,\n$$\nand hence a norm-equivalence factor\n$$\nS(a) = \\sqrt{\\frac{J_{\\max}}{J_{\\min}}} = \\sqrt{\\frac{1 + |a| \\pi}{1 - |a| \\pi}},\n$$\nso that one may use a simplified model $C_{\\text{mesh}} \\approx S(a)$ for smooth solutions on this family of meshes.\n\n- Predict the asymptotic convergence rate under mesh refinement when the time step is coupled to the mesh size by $\\Delta t = \\theta \\, h^{k+1}$ with a fixed $\\theta \\in \\mathbb{R}_{0}$. In this regime, the dominant asymptotics of the error are $E(h) \\approx \\big(S(a) + \\theta\\big) \\, h^{k+1}$, so the experimental order of convergence (EOC) should approach $k+1$.\n\n- Implement a program that, for the test suite below, computes the predicted experimental order of convergence from the manufactured asymptotics $E(h) = \\big(S(a) + \\theta\\big) \\, h^{k+1}$. For each test case, use a refinement sequence $\\{h_i\\}$ derived from a list of spatial resolutions $\\{N_i\\}$ via $h_i = 1/N_i$ on the interval $[0,1]$, set $\\Delta t_i = \\theta \\, h_i^{k+1}$, and then compute the sequence of errors $E_i = \\big(S(a) + \\theta\\big) \\, h_i^{k+1}$. From $\\{(h_i, E_i)\\}$, compute the predicted experimental order of convergence as the slope of the least-squares linear fit of $\\log(E_i)$ versus $\\log(h_i)$. The least-squares slope must be computed over all refinement levels in each case.\n\nTest suite (all real numbers are dimensionless and angles are in radians):\n- Case A (happy path, moving mesh):\n  - Polynomial degree $k = 1$.\n  - Diffusivity $\\nu = 0.05$.\n  - Advection speed $c_0 = 0.4$.\n  - Mesh amplitude $a = 0.2$.\n  - Mesh angular frequency $\\omega = 3.0$.\n  - Final time $T = 0.5$.\n  - Decay rate $\\lambda = 1.0$.\n  - Time-step coupling $\\theta = 0.8$.\n  - Refinements $N \\in \\{10, 20, 40, 80\\}$.\n\n- Case B (higher order, more distorted mesh but admissible):\n  - Polynomial degree $k = 2$.\n  - Diffusivity $\\nu = 0.02$.\n  - Advection speed $c_0 = 0.1$.\n  - Mesh amplitude $a = 0.25$.\n  - Mesh angular frequency $\\omega = 2.0$.\n  - Final time $T = 1.0$.\n  - Decay rate $\\lambda = 0.5$.\n  - Time-step coupling $\\theta = 0.6$.\n  - Refinements $N \\in \\{12, 24, 48, 96\\}$.\n\n- Case C (boundary case with no mesh motion, Eulerian limit):\n  - Polynomial degree $k = 1$.\n  - Diffusivity $\\nu = 0.1$.\n  - Advection speed $c_0 = 0.3$.\n  - Mesh amplitude $a = 0.0$.\n  - Mesh angular frequency $\\omega = 1.0$.\n  - Final time $T = 0.7$.\n  - Decay rate $\\lambda = 1.2$.\n  - Time-step coupling $\\theta = 1.0$.\n  - Refinements $N \\in \\{8, 16, 32, 64\\}$.\n\nYour program must:\n- Define the above test cases internally.\n- For each test case, compute $S(a)$, generate $h_i$ and $\\Delta t_i$, form $E_i = \\big(S(a) + \\theta\\big)\\, h_i^{k+1}$, and compute the least-squares slope of $\\log(E_i)$ against $\\log(h_i)$ as the predicted experimental order of convergence.\n- Produce a single line of output containing the predicted orders as a comma-separated list enclosed in square brackets, in the order of Cases A, B, C, for example $[r_A,r_B,r_C]$.\n\nThe final outputs must be real numbers (floats). No physical units are required in the outputs. Angles are in radians. Percentages, if any, must be represented as decimals and not with a percentage sign. The output must be a single Python list literal on one line, with no additional text.", "solution": "The problem presented is a valid exercise in the numerical analysis of partial differential equations using the Arbitrary Lagrangian-Eulerian (ALE) method. It is scientifically grounded, well-posed, and objective. We shall proceed with the derivation and analysis as requested.\n\nFirst, we derive the source term $f(x,t)$ required for the manufactured solution to satisfy the given ALE advection-diffusion equation. The strong form of the equation is\n$$\n\\partial_t u(x,t) + \\big(c_0 - w(x,t)\\big)\\,\\partial_x u(x,t) - \\nu\\, \\partial_{xx} u(x,t) = f(x,t)\n$$\nThe source term $f(x,t)$ is therefore defined by the left-hand side of this equation when the manufactured solution $u(x,t)$ and its derivatives are substituted. The manufactured solution is given as $u(x,t) = e^{-\\lambda t}\\, \\sin(\\pi x)$, where $\\lambda$ is a positive constant. We compute its partial derivatives with respect to time $t$ and space $x$:\n$$\n\\partial_t u(x,t) = -\\lambda e^{-\\lambda t} \\sin(\\pi x)\n$$\n$$\n\\partial_x u(x,t) = \\pi e^{-\\lambda t} \\cos(\\pi x)\n$$\n$$\n\\partial_{xx} u(x,t) = -\\pi^2 e^{-\\lambda t} \\sin(\\pi x)\n$$\nThe mesh velocity $w(x,t)$ is defined as the time derivative of the ALE mapping $\\chi(X,t)$ evaluated at the reference coordinate $X$ corresponding to the physical coordinate $x$. That is, $w(x,t) = \\partial_t \\chi(X,t)|_{X=\\chi^{-1}(x,t)}$. The given mapping is $\\chi(X,t) = X + a \\sin(\\pi X) \\sin(\\omega t)$. Its time derivative is:\n$$\n\\partial_t \\chi(X,t) = a \\omega \\sin(\\pi X) \\cos(\\omega t)\n$$\nThus, the mesh velocity is expressed in terms of the inverse mapping $\\chi^{-1}(x,t)$ as:\n$$\nw(x,t) = a \\omega \\cos(\\omega t) \\sin(\\pi \\chi^{-1}(x,t))\n$$\nSubstituting these expressions into the definition of $f(x,t)$, we obtain:\n$$\nf(x,t) = \\left(-\\lambda e^{-\\lambda t} \\sin(\\pi x)\\right) + \\left(c_0 - a \\omega \\cos(\\omega t) \\sin(\\pi \\chi^{-1}(x,t))\\right)\\left(\\pi e^{-\\lambda t} \\cos(\\pi x)\\right) - \\nu \\left(-\\pi^2 e^{-\\lambda t} \\sin(\\pi x)\\right)\n$$\nFactoring out the term $e^{-\\lambda t}$, we arrive at the closed-form expression for the source term:\n$$\nf(x,t) = e^{-\\lambda t} \\left[ (\\nu \\pi^2 - \\lambda) \\sin(\\pi x) + \\pi c_0 \\cos(\\pi x) - \\pi a \\omega \\cos(\\omega t) \\cos(\\pi x) \\sin(\\pi \\chi^{-1}(x,t)) \\right]\n$$\nThis expression is exact and depends on the inverse mapping, as is typical for manufactured solutions on moving domains.\n\nNext, we justify the structure of the a priori error estimate. For a parabolic partial differential equation solved with a continuous Galerkin finite element method of spatial polynomial degree $k$ and the first-order backward Euler method for time integration, the standard theory yields an error bound at the final time $T$. The total error is composed of a spatial discretization error and a temporal discretization error. The spatial error is governed by the approximation properties of the finite element space and is proportional to $h^{k+1}$, where $h$ is the mesh size. The temporal error from backward Euler is proportional to the time step $\\Delta t$. This leads to an estimate of the form:\n$$\n\\|u(\\cdot,T) - u_h(\\cdot,T)\\|_{L^2(\\Omega)} \\le C_{\\text{space}} h^{k+1} + C_{\\text{time}} \\Delta t\n$$\nIn the ALE formulation, the analysis is performed by mapping the time-dependent physical domain $\\Omega(t)$ to a fixed reference domain $\\hat{\\Omega}$. This transformation introduces the Jacobian of the mapping, $J(X,t) = \\partial_X \\chi(X,t)$, into the weak formulation. The constants in the error estimate, particularly the spatial constant $C_{\\text{space}}$ (denoted $C_{\\text{mesh}}$ in the problem), depend on the properties of this mapping. Specifically, they depend on bounds on $J$ and its derivatives. The relationship between norms on the physical and reference domains is $\\|v\\|_{L^2(\\Omega)}^2 = \\int_{\\hat{\\Omega}} \\hat{v}^2 J dX$. This implies a norm equivalence $\\|\\cdot\\|_{L^2(\\Omega)} \\sim \\|\\cdot\\|_{L^2(\\hat{\\Omega})}$ where the equivalence constant depends on $\\sqrt{J_{\\min}}$ and $\\sqrt{J_{\\max}}$. Critically, the geometric distortion of the mesh, quantified by the ratio of maximum to minimum element size or Jacobian, influences the constants in interpolation estimates and stability bounds. The factor $S(a) = \\sqrt{J_{\\max}/J_{\\min}}$ captures this distortion effect on norms, where $J_{\\min} = 1 - |a| \\pi$ and $J_{\\max} = 1 + |a| \\pi$ for the given oscillatory mapping. It is therefore a sound modeling simplification to propose that the dominant geometric dependency of the spatial error constant $C_{\\text{mesh}}$ is captured by this factor, leading to the approximation $C_{\\text{mesh}} \\approx S(a)$, assuming the solution $u$ is sufficiently smooth such that its high-order derivative norms are of order one.\n\nFinally, we predict the asymptotic convergence rate under the specified refinement strategy. The problem states that the time step is coupled to the mesh size via $\\Delta t = \\theta h^{k+1}$ for some constant $\\theta > 0$. Substituting this into the simplified error estimate:\n$$\nE(h) = \\|u(\\cdot,T) - u_h(\\cdot,T)\\|_{L^2(\\Omega)} \\approx S(a) h^{k+1} + C_{\\text{time}} (\\theta h^{k+1})\n$$\nThis can be rewritten as:\n$$\nE(h) \\approx (S(a) + C_{\\text{time}}\\theta) h^{k+1}\n$$\nThe problem further simplifies by assuming $C_{\\text{time}}$ is absorbed into $\\theta$, leading to the final error model $E(h) \\approx (S(a) + \\theta) h^{k+1}$. To find the experimental order of convergence (EOC), one typically examines the slope of the error curve on a log-log plot. Let $K = S(a) + \\theta$, which is constant for a given test case. Taking the logarithm of the error model gives:\n$$\n\\log(E(h)) \\approx \\log(K \\cdot h^{k+1}) = \\log(K) + (k+1) \\log(h)\n$$\nThis equation has the form of a line, $y = b + mx$, where $y = \\log(E)$, $x = \\log(h)$, the intercept is $b = \\log(K)$, and the slope is $m = k+1$. Therefore, a least-squares fit to the data points $(\\log(h_i), \\log(E_i))$ generated from this model will yield a slope that is precisely $k+1$. The predicted asymptotic convergence rate is thus $k+1$. The following program computes this slope for the given test cases, numerically confirming this theoretical result.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the predicted experimental order of convergence (EOC) for an ALE\n    advection-diffusion problem based on a provided asymptotic error model.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {\n            \"name\": \"A\",\n            \"k\": 1,\n            \"a\": 0.2,\n            \"theta\": 0.8,\n            \"N_list\": [10, 20, 40, 80],\n        },\n        # Case B\n        {\n            \"name\": \"B\",\n            \"k\": 2,\n            \"a\": 0.25,\n            \"theta\": 0.6,\n            \"N_list\": [12, 24, 48, 96],\n        },\n        # Case C\n        {\n            \"name\": \"C\",\n            \"k\": 1,\n            \"a\": 0.0,\n            \"theta\": 1.0,\n            \"N_list\": [8, 16, 32, 64],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        k = case[\"k\"]\n        a = case[\"a\"]\n        theta = case[\"theta\"]\n        N_list = np.array(case[\"N_list\"], dtype=float)\n\n        # The problem statement guarantees that |a| * pi  1, so the\n        # denominator is always positive.\n        if np.abs(a) * np.pi >= 1:\n            raise ValueError(f\"Diffeomorphism condition |a|*pi  1 is violated for a = {a}\")\n\n        # Compute the norm-equivalence factor S(a).\n        # For a = 0, S(a) correctly evaluates to 1.\n        S_a = np.sqrt((1 + np.abs(a) * np.pi) / (1 - np.abs(a) * np.pi))\n        \n        # The constant K in the error model E = K * h^(k+1).\n        K = S_a + theta\n        \n        # Spatial refinement sequence h_i = 1/N_i.\n        h = 1.0 / N_list\n        \n        # Predicted theoretical error based on the model.\n        # The convergence rate is p = k + 1.\n        p = k + 1\n        E = K * (h ** p)\n\n        # Compute the EOC as the slope of the least-squares fit\n        # of log(E) vs log(h).\n        # We use np.polyfit for a robust linear regression.\n        # For data that perfectly fits a line y = mx + c, np.polyfit(x, y, 1)\n        # will return [m, c] with high precision.\n        log_h = np.log(h)\n        log_E = np.log(E)\n        \n        # The slope is the first element of the returned polynomial coefficients array.\n        slope = np.polyfit(log_h, log_E, 1)[0]\n        \n        results.append(slope)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) is used to format numbers as plain floats.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2541241"}]}