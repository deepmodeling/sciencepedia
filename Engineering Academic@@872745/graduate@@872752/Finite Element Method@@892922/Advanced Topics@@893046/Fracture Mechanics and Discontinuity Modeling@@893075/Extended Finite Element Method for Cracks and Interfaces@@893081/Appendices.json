{"hands_on_practices": [{"introduction": "The first step in any XFEM analysis is to identify which parts of the standard finite element model need to be \"enriched\" to capture the behavior around a discontinuity. This involves applying a set of rules to determine which nodes will receive additional degrees of freedom (DOFs) corresponding to the enrichment functions. This exercise provides practice in applying the topological rules for selecting nodes for Heaviside (displacement jump) and near-tip (stress singularity) enrichments, a crucial bookkeeping step that defines the size and structure of the global system of equations.", "problem": "Consider two-dimensional plane strain linear elasticity discretized with bilinear quadrilateral finite elements over the rectangular domain $\\Omega = [0,3] \\times [0,2]$. The mesh has $3 \\times 2$ elements with nodes at integer grid points. Number the nodes row-wise from the bottom-left corner so that the nodal coordinates are\n$(x,y)$ at\nnode $1:(0,0)$, node $2:(1,0)$, node $3:(2,0)$, node $4:(3,0)$,\nnode $5:(0,1)$, node $6:(1,1)$, node $7:(2,1)$, node $8:(3,1)$,\nnode $9:(0,2)$, node $10:(1,2)$, node $11:(2,2)$, node $12:(3,2)$.\nLet the six elements have the following node connectivities (counterclockwise): $e_1=[1,2,6,5]$, $e_2=[2,3,7,6]$, $e_3=[3,4,8,7]$, $e_4=[5,6,10,9]$, $e_5=[6,7,11,10]$, $e_6=[7,8,12,11]$.\n\nA straight crack $\\Gamma_c$ of zero thickness is embedded in the domain. The crack is modeled with the extended finite element method (XFEM) using the Heaviside enrichment to represent the displacement jump across the crack faces and the near-tip asymptotic branch enrichments to capture the singular fields near the crack tip. The crack is defined as the line segment from $\\mathbf{x}_A=(0.2,0.9)$ to the tip $\\mathbf{x}_T=(2.4,0.9)$ (coordinates in the same units as the mesh), and it does not pass through any node or coincide with any element edge.\n\nAssume the following enrichment selection rules:\n\n(1) Heaviside enrichment: A node is Heaviside-enriched if at least one element attached to it is intersected by the interior of $\\Gamma_c$ and the node does not belong to the near-tip enriched set.\n\n(2) Near-tip enrichment: Let $e_t$ be the unique element containing the crack tip $\\mathbf{x}_T$. The near-tip enriched set consists of all nodes belonging to the union of $e_t$ and all elements that share an edge with $e_t$.\n\nAssume the standard displacement approximation has $2$ translational degrees of freedom per node. In the XFEM enrichment:\n- Each Heaviside-enriched node carries one vector-valued enriched coefficient associated with the scalar Heaviside function (that is, $2$ additional degrees of freedom per Heaviside-enriched node).\n- Each near-tip-enriched node carries four vector-valued enriched coefficients associated with the four standard two-dimensional near-tip branch functions (that is, $8$ additional degrees of freedom per near-tip-enriched node).\n\nStarting from these definitions and the standard notion of a nodal support in the finite element method, determine the total number of additional degrees of freedom introduced by the enrichment relative to the standard finite element model for this mesh and crack configuration. Justify which nodes are Heaviside-enriched and which nodes are near-tip-enriched based on the stated rules. Express your final answer as an integer with no units.", "solution": "We begin from the foundational finite element concepts: a bilinear quadrilateral element associates each node with a scalar shape function whose support is the union of elements that contain the node. In two-dimensional linear elasticity, the displacement field has two components, so each node possesses $2$ standard degrees of freedom. In the extended finite element method (XFEM), the partition of unity provided by the standard shape functions is multiplied by enrichment functions to represent features such as displacement jumps and crack-tip singularities. Each scalar enrichment function at a node introduces a vector-valued enriched coefficient with $2$ additional degrees of freedom.\n\nWe apply the provided enrichment selection rules:\n\nStep $1$: Identify the elements intersected by the interior of $\\Gamma_c$ and the element containing the crack tip.\n\nThe crack $\\Gamma_c$ is the segment from $\\mathbf{x}_A=(0.2,0.9)$ to $\\mathbf{x}_T=(2.4,0.9)$, i.e., a horizontal line at $y=0.9$ from $x=0.2$ to $x=2.4$. The element extents are:\n- $e_1=[1,2,6,5]$ spans $x \\in [0,1]$, $y \\in [0,1]$,\n- $e_2=[2,3,7,6]$ spans $x \\in [1,2]$, $y \\in [0,1]$,\n- $e_3=[3,4,8,7]$ spans $x \\in [2,3]$, $y \\in [0,1]$,\n- $e_4=[5,6,10,9]$ spans $x \\in [0,1]$, $y \\in [1,2]$,\n- $e_5=[6,7,11,10]$ spans $x \\in [1,2]$, $y \\in [1,2]$,\n- $e_6=[7,8,12,11]$ spans $x \\in [2,3]$, $y \\in [1,2]$.\n\nBecause $y=0.9 \\in (0,1)$, the crack lies within the bottom row of elements ($e_1$, $e_2$, $e_3$). The $x$-interval of the crack is $[0.2,2.4]$, which intersects:\n- $e_1$ for $x \\in [0.2,1]$ (interior intersection),\n- $e_2$ for $x \\in [1,2]$ (interior intersection),\n- $e_3$ for $x \\in [2,2.4]$ (interior intersection up to the tip).\n\nThe crack tip point $\\mathbf{x}_T=(2.4,0.9)$ satisfies $22.43$ and $00.91$, hence the tip element is $e_t=e_3$.\n\nStep $2$: Construct the near-tip enriched node set according to rule $(2)$.\n\nBy rule $(2)$, the near-tip enriched set consists of the nodes of $e_t$ and of all elements sharing an edge with $e_t$. The edge-adjacent neighbors of $e_3$ are:\n- Left neighbor $e_2$ (shared vertical edge along $x=2$),\n- Top neighbor $e_6$ (shared horizontal edge along $y=1$),\nand there is no right neighbor (domain boundary at $x=3$) nor bottom neighbor (domain boundary at $y=0$).\n\nThus, the near-tip patch is the union of elements $\\{e_2,e_3,e_6\\}$ with node sets:\n- $e_2$ has nodes $\\{2,3,7,6\\}$,\n- $e_3$ has nodes $\\{3,4,8,7\\}$,\n- $e_6$ has nodes $\\{7,8,12,11\\}$.\n\nTaking the union, the near-tip enriched node set is\n$\\mathcal{N}_{\\text{tip}}=\\{2,3,4,6,7,8,11,12\\}$.\n\nBy the stated approximation, each near-tip-enriched node introduces $4$ scalar branch functions, each with a $2$-component vector coefficient, for $8$ additional degrees of freedom per node.\n\nStep $3$: Construct the Heaviside enriched node set according to rule $(1)$.\n\nFirst list elements intersected by the interior of $\\Gamma_c$ excluding the tip element: these are $e_1$ and $e_2$. Their node sets are:\n- $\\mathcal{N}(e_1)=\\{1,2,6,5\\}$,\n- $\\mathcal{N}(e_2)=\\{2,3,7,6\\}$.\n\nThe union of nodes belonging to elements cut by the crack interior and not including the tip element is\n$\\{1,2,3,5,6,7\\}$.\n\nPer rule $(1)$, remove nodes that are in the near-tip enriched set $\\mathcal{N}_{\\text{tip}}$ to avoid double enrichment. Since $\\mathcal{N}_{\\text{tip}}=\\{2,3,4,6,7,8,11,12\\}$, the remaining Heaviside-enriched nodes are\n$\\mathcal{N}_{H}=\\{1,5\\}$.\n\nEach Heaviside-enriched node introduces a single scalar Heaviside function with a $2$-component vector coefficient, for $2$ additional degrees of freedom per node.\n\nStep $4$: Count the additional degrees of freedom.\n\n- Heaviside contribution: $|\\mathcal{N}_{H}| \\times 2 = 2 \\times 2 = 4$ additional degrees of freedom.\n- Near-tip contribution: $|\\mathcal{N}_{\\text{tip}}| \\times 8 = 8 \\times 8 = 64$ additional degrees of freedom.\n\nTotal additional degrees of freedom introduced by the enrichment relative to the standard finite element model is\n$4 + 64 = 68$.\n\nStep $5$: Justification of the selection.\n\nThe Heaviside enrichment is assigned to nodes whose nodal supports are intersected by the interior of the crack segment, ensuring the partition of unity can represent a displacement jump across the crack faces in elements cut by the crack away from the tip. Excluding nodes in the near-tip patch from Heaviside enrichment avoids overlapping discontinuous and singular enrichments on the same nodes, which can cause ill-conditioning and linear dependence.\n\nThe near-tip enrichment is assigned to the tip element and its edge-adjacent neighbors to capture the square-root singularity and angular variation of the stress and displacement fields near the crack tip using the four standard two-dimensional branch functions. Extending the tip enrichment to the one-ring of edge-adjacent elements provides sufficient support to represent the asymptotic fields while maintaining a compact enriched region. This division of enriched sets is consistent with the extended finite element method’s partition of unity framework and leverages the local nature of the crack-tip singular fields while separately handling the displacement jump away from the tip.\n\nTherefore, the total number of additional degrees of freedom is $68$.", "answer": "$$\\boxed{68}$$", "id": "2557355"}, {"introduction": "Once the enriched approximation space is defined, we must assemble the system matrices, which requires integrating functions over elements cut by the crack. Standard numerical quadrature rules are formulated for smooth integrands and can produce significant errors when applied to elements where the underlying function or its derivatives are discontinuous. This practice focuses on the essential technique of sub-cell integration, where a cut element is partitioned into non-overlapping sub-domains over which standard quadrature can be accurately applied.", "problem": "In the extended finite element method (XFEM), cut cells are integrated by decomposing the parent element into subdomains separated by the discontinuity and then applying exact area-based quadrature on each subdomain. Consider the triangular finite element with vertices $A=(0,0)$, $B=(3,0)$, and $C=(0,2)$. A straight crack intersects the element along the vertical line $x=1$, from the point $D=(1,0)$ on edge $\\overline{AB}$ to the point $E=\\left(1,\\frac{4}{3}\\right)$ on edge $\\overline{BC}$. This crack splits the element into two polygonal subdomains: the left subdomain with $x1$ and the right subdomain with $x\\ge 1$.\n\nDefine the piecewise linear integrand $g:\\mathbb{R}^{2}\\to\\mathbb{R}$ by\n- on the left subdomain $\\{(x,y)\\,:\\,x1\\}$, $g(x,y)=1+x+y$,\n- on the right subdomain $\\{(x,y)\\,:\\,x\\ge 1\\}$, $g(x,y)=2-x+3y$.\n\nUsing exact area decomposition suitable for XFEM subcell integration:\n- partition the two polygons induced by the crack into non-overlapping triangles with vertices among $\\{A,B,C,D,E\\}$ so that their union equals the original element,\n- for each triangle, construct a single quadrature point at its centroid with a weight equal to its area, and\n- use these quadrature points and weights to evaluate the integral\n$$\nI \\;=\\; \\iint_{T} g(x,y)\\,\\mathrm{d}A,\n$$\nwhere $T=\\mathrm{conv}\\{A,B,C\\}$ is the original triangle.\n\nState the final value of $I$ as a single exact rational number (no rounding). Do not include units in your final answer. If you need to choose a value on the crack itself (where $x=1$), justify that your choice does not affect the integral.", "solution": "The integral $I$ over the triangle $T$ can be decomposed into the sum of integrals over the two subdomains created by the crack at $x=1$. Let $T_{left}$ be the part of $T$ where $x1$ and $T_{right}$ be the part where $x1$. The integral over the line $x=1$ itself is zero, as a line segment is a set of measure zero in $\\mathbb{R}^2$. Thus, the choice of using the definition for $x\\ge 1$ on the crack line does not affect the final value of the integral.\n$$\nI = \\iint_{T} g(x,y)\\,\\mathrm{d}A = \\iint_{T_{left}} (1+x+y)\\,\\mathrm{d}A + \\iint_{T_{right}} (2-x+3y)\\,\\mathrm{d}A\n$$\nThe subdomain $T_{left}$ is the quadrilateral with vertices $A(0,0)$, $D(1,0)$, $E\\left(1, \\frac{4}{3}\\right)$, and $C(0,2)$. The subdomain $T_{right}$ is the triangle with vertices $D(1,0)$, $B(3,0)$, and $E\\left(1, \\frac{4}{3}\\right)$.\n\nFollowing the problem's instructions, we partition the quadrilateral $T_{left}$ into two triangles. We choose the diagonal $\\overline{AE}$, which decomposes $T_{left}$ into $\\triangle ADE$ and $\\triangle ACE$. Thus, the original triangle $T$ is decomposed into three sub-triangles:\n1.  $T_1 = \\triangle ADE$\n2.  $T_2 = \\triangle ACE$\n3.  $T_3 = \\triangle DBE$ (this is the same as $T_{right}$)\n\nThe specified numerical integration scheme evaluates the integral over a sub-triangle by multiplying its area by the value of the integrand at its centroid. For a linear integrand $f(x,y)$ over a triangle $\\Delta$, this method is exact: $\\iint_{\\Delta} f(x,y)\\,\\mathrm{d}A = \\text{Area}(\\Delta) \\cdot f(x_c, y_c)$, where $(x_c, y_c)$ is the centroid of $\\Delta$. Since our integrand $g(x,y)$ is piecewise linear, and each sub-triangle lies entirely within a region where $g$ is linear, this procedure will yield the exact value of the integral.\n\nWe now calculate the contribution from each sub-triangle.\n\n**1. Sub-triangle $T_1 = \\triangle ADE$**\n-   Vertices: $A(0,0)$, $D(1,0)$, $E\\left(1, \\frac{4}{3}\\right)$.\n-   This triangle is in the $x1$ region (except for the edge $\\overline{DE}$). We use $g(x,y) = 1+x+y$.\n-   Area: $A_1 = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times (1-0) \\times \\frac{4}{3} = \\frac{2}{3}$.\n-   Centroid: $C_1 = \\left(\\frac{0+1+1}{3}, \\frac{0+0+\\frac{4}{3}}{3}\\right) = \\left(\\frac{2}{3}, \\frac{4}{9}\\right)$.\n-   Integrand value at centroid: $g(C_1) = 1 + \\frac{2}{3} + \\frac{4}{9} = \\frac{9}{9} + \\frac{6}{9} + \\frac{4}{9} = \\frac{19}{9}$.\n-   Integral contribution: $I_1 = A_1 \\cdot g(C_1) = \\frac{2}{3} \\cdot \\frac{19}{9} = \\frac{38}{27}$.\n\n**2. Sub-triangle $T_2 = \\triangle ACE$**\n-   Vertices: $A(0,0)$, $C(0,2)$, $E\\left(1, \\frac{4}{3}\\right)$.\n-   This triangle is in the $x1$ region (except for vertex $E$). We use $g(x,y) = 1+x+y$.\n-   Area (using the shoelace formula): $A_2 = \\frac{1}{2} |(0 \\cdot 2 + 0 \\cdot \\frac{4}{3} + 1 \\cdot 0) - (0 \\cdot 0 + 2 \\cdot 1 + \\frac{4}{3} \\cdot 0)| = \\frac{1}{2} |0 - 2| = 1$.\n-   Centroid: $C_2 = \\left(\\frac{0+0+1}{3}, \\frac{0+2+\\frac{4}{3}}{3}\\right) = \\left(\\frac{1}{3}, \\frac{\\frac{10}{3}}{3}\\right) = \\left(\\frac{1}{3}, \\frac{10}{9}\\right)$.\n-   Integrand value at centroid: $g(C_2) = 1 + \\frac{1}{3} + \\frac{10}{9} = \\frac{9}{9} + \\frac{3}{9} + \\frac{10}{9} = \\frac{22}{9}$.\n-   Integral contribution: $I_2 = A_2 \\cdot g(C_2) = 1 \\cdot \\frac{22}{9} = \\frac{22}{9}$.\n\n**3. Sub-triangle $T_3 = \\triangle DBE$**\n-   Vertices: $D(1,0)$, $B(3,0)$, $E\\left(1, \\frac{4}{3}\\right)$.\n-   This triangle is in the $x \\ge 1$ region. We use $g(x,y) = 2-x+3y$.\n-   Area: $A_3 = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times (3-1) \\times \\frac{4}{3} = \\frac{1}{2} \\cdot 2 \\cdot \\frac{4}{3} = \\frac{4}{3}$.\n-   Centroid: $C_3 = \\left(\\frac{1+3+1}{3}, \\frac{0+0+\\frac{4}{3}}{3}\\right) = \\left(\\frac{5}{3}, \\frac{4}{9}\\right)$.\n-   Integrand value at centroid: $g(C_3) = 2 - \\frac{5}{3} + 3\\left(\\frac{4}{9}\\right) = 2 - \\frac{5}{3} + \\frac{4}{3} = 2 - \\frac{1}{3} = \\frac{5}{3}$.\n-   Integral contribution: $I_3 = A_3 \\cdot g(C_3) = \\frac{4}{3} \\cdot \\frac{5}{3} = \\frac{20}{9}$.\n\n**Total Integral**\nThe total integral $I$ is the sum of the contributions from the three sub-triangles:\n$$\nI = I_1 + I_2 + I_3 = \\frac{38}{27} + \\frac{22}{9} + \\frac{20}{9}\n$$\nTo sum these fractions, we find a common denominator, which is $27$.\n$$\nI = \\frac{38}{27} + \\frac{22 \\cdot 3}{27} + \\frac{20 \\cdot 3}{27} = \\frac{38 + 66 + 60}{27}\n$$\n$$\nI = \\frac{104 + 60}{27} = \\frac{164}{27}\n$$\nAs a check, the sum of areas is $A_1+A_2+A_3 = \\frac{2}{3} + 1 + \\frac{4}{3} = \\frac{6}{3}+1 = 2+1=3$. The area of the original triangle $T$ with vertices $(0,0)$, $(3,0)$, $(0,2)$ is $\\frac{1}{2} \\times 3 \\times 2 = 3$. The area decomposition is correct. The final result is the exact value of the integral.", "answer": "$$\n\\boxed{\\frac{164}{27}}\n$$", "id": "2557298"}, {"introduction": "A primary motivation for developing XFEM is to model crack growth in a way that is not biased by the orientation of the underlying mesh, a property known as mesh objectivity. This allows the predicted crack path to be governed by the physics of fracture rather than the artifacts of discretization. This final exercise explores this key advantage by contrasting the theoretical crack propagation direction from Linear Elastic Fracture Mechanics (LEFM) with a direction selected from a discrete, mesh-dependent set of angles, demonstrating how XFEM can lead to more robust fracture simulations.", "problem": "Consider a two-dimensional, homogeneous, isotropic, linearly elastic body containing a straight crack with its initial tangent aligned with the global $x$-axis. Adopt the asymptotic Linear Elastic Fracture Mechanics (LEFM) description of the near-tip field and the maximum circumferential stress criterion to define the continuous crack growth direction. The crack growth problem is to be treated in the spirit of the Extended Finite Element Method (XFEM), where enrichment yields a mesh-independent representation of the near-tip singularity, but the numerical selection of the growth direction may, in practice, be constrained by mesh-induced angular sampling.\n\nYour task is to demonstrate mesh objectivity of crack path prediction with respect to mesh rotation and refinement by comparing the discrete propagation direction selected over mesh-induced angular grids against the continuous LEFM-based direction. Work in pure mathematical terms as follows.\n\nFundamental base and modeling assumptions:\n- The material is linear elastic with Young’s modulus $E$ and Poisson’s ratio $\\nu$ (the final growth direction under the maximum circumferential stress criterion is independent of $E$ and $\\nu$).\n- The near-tip stress field is characterized by the mode-$\\mathrm{I}$ and mode-$\\mathrm{II}$ stress intensity factors $K_{\\mathrm{I}}$ and $K_{\\mathrm{II}}$ at the current crack tip.\n- The continuous crack growth direction angle $\\theta^\\star \\in [-\\pi/2,\\pi/2]$ is defined as the angle (measured in radians from the current crack tangent) that maximizes the circumferential (hoop) stress in the LEFM asymptotic field.\n\nDiscrete mesh-induced angular sampling:\n- A background mesh induces a discrete set of candidate growth directions through an angular grid characterized by a resolution (angular spacing) $h \\in (0,\\pi)$ and a rotation (phase) $\\phi \\in [0,h)$. The candidate set is\n$$\n\\mathcal{S}(h,\\phi) \\;=\\; \\left\\{\\, \\theta_k \\;=\\; \\phi + k h \\;:\\; \\theta_k \\in [-\\tfrac{\\pi}{2}, \\tfrac{\\pi}{2}],\\; k \\in \\mathbb{Z} \\,\\right\\}.\n$$\n- A numerical algorithm that is consistent with the maximum circumferential stress criterion but restricted to $\\mathcal{S}(h,\\phi)$ is assumed to select the discrete direction\n$$\n\\hat{\\theta}(h,\\phi) \\;=\\; \\underset{\\theta \\in \\mathcal{S}(h,\\phi)}{\\arg\\min}\\; \\left|\\theta - \\theta^\\star\\right|.\n$$\nPropagation model:\n- Propagate the crack for $N$ steps of equal arc length $a0$ by holding the growth direction fixed at the initially selected direction (this is a small-advance assumption that isolates the mesh-objectivity aspect of the initial direction selection under a fixed pair $(K_{\\mathrm{I}},K_{\\mathrm{II}})$). The continuous path has direction $\\theta^\\star$, and a discrete path has direction $\\hat{\\theta}(h,\\phi)$; both paths are straight lines in this model.\n\nQuantity of interest and output:\n- For each test case, evaluate the worst-case absolute angular deviation (in radians) between discrete and continuous directions across a set of meshes comprising two resolutions and two rotations each:\n$$\n\\Delta \\theta_{\\max} \\;=\\; \\max\\bigl\\{\\, \\left|\\hat{\\theta}(h_1,\\phi)\\!-\\!\\theta^\\star\\right|,\\; \\left|\\hat{\\theta}(h_2,\\phi)\\!-\\!\\theta^\\star\\right| \\;:\\; \\phi \\in \\{0,\\tfrac{h}{2}\\},\\; h \\in \\{h_1,h_2\\} \\,\\bigr\\}.\n$$\n- Angles must be handled and reported in radians. Your program must output, for all test cases, a single line containing a comma-separated list enclosed in square brackets with each entry equal to $\\Delta \\theta_{\\max}$ rounded to $6$ decimal places.\n\nComputation of the continuous direction:\n- Starting from the LEFM definition of the maximum circumferential stress criterion, derive and implement a robust computation of $\\theta^\\star$ in terms of $K_{\\mathrm{I}}$ and $K_{\\mathrm{II}}$ that does not depend on any mesh parameters. You must report angles in radians.\n\nTest suite:\nFor each test case below, use $N=25$ and $a=10^{-2}$ (these values define the propagation step count and length but do not enter the angular deviation metric). For all cases, use the same pair of mesh resolutions $h_1=\\pi/12$ and $h_2=\\pi/48$, with rotations $\\phi \\in \\{0,\\tfrac{h}{2}\\}$ for each $h$ as specified above. The three test cases are:\n- Case $1$: $(K_{\\mathrm{I}},K_{\\mathrm{II}})=(1.0,\\,0.0)$.\n- Case $2$: $(K_{\\mathrm{I}},K_{\\mathrm{II}})=(1.0,\\,0.3)$.\n- Case $3$: $(K_{\\mathrm{I}},K_{\\mathrm{II}})=(10^{-6},\\,1.0)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,x_3]$, where each $x_i$ corresponds to $\\Delta \\theta_{\\max}$ for the $i$-th test case, rounded to $6$ decimal places.", "solution": "The problem posed is a well-defined mathematical exercise in the field of computational fracture mechanics. It is scientifically grounded in Linear Elastic Fracture Mechanics (LEFM), internally consistent, and contains all necessary information for a unique solution. The inquiry into mesh objectivity is a standard and important topic in the numerical analysis of fracture. Therefore, the problem is valid, and we shall proceed with a complete solution.\n\nThe solution is structured as follows: First, we derive the expression for the continuous crack propagation angle $\\theta^\\star$ based on the maximum circumferential stress criterion. Second, we formalize the procedure for determining the discrete propagation angle $\\hat{\\theta}(h, \\phi)$ from the mesh-induced set of candidate directions. Finally, we apply these procedures to compute the worst-case absolute angular deviation $\\Delta\\theta_{\\max}$ for each specified test case.\n\n**1. Continuous Crack Propagation Direction $\\theta^\\star$**\n\nThe near-tip stress field in a two-dimensional, homogeneous, isotropic, linearly elastic material under mixed-mode (I and II) loading is given in polar coordinates $(r, \\theta)$ centered at the crack tip. The coordinate $\\theta$ is measured from the crack tangent. The circumferential stress, or hoop stress, $\\sigma_{\\theta\\theta}$, is given by:\n$$\n\\sigma_{\\theta\\theta}(r, \\theta) = \\frac{1}{\\sqrt{2\\pi r}} \\cos\\frac{\\theta}{2} \\left[ K_{\\mathrm{I}} \\cos^2\\frac{\\theta}{2} - \\frac{3}{2} K_{\\mathrm{II}} \\sin\\theta \\right]\n$$\nwhere $K_{\\mathrm{I}}$ and $K_{\\mathrm{II}}$ are the Mode I and Mode II stress intensity factors, respectively.\n\nThe maximum circumferential stress criterion posits that the crack will propagate from the tip in the direction $\\theta^\\star$ that maximizes $\\sigma_{\\theta\\theta}$. This is found by solving $\\frac{\\partial \\sigma_{\\theta\\theta}}{\\partial \\theta} = 0$ for $\\theta=\\theta^\\star$. The term $\\frac{1}{\\sqrt{2\\pi r}}$ is a positive function of $r$ and does not affect the location of the maximum with respect to $\\theta$. We must find the maximum of the angular function. It can be shown that the condition $\\frac{\\partial \\sigma_{\\theta\\theta}}{\\partial \\theta} = 0$ is equivalent to the condition that the shear stress on the prospective crack plane is zero, $\\sigma_{r\\theta}(\\theta^\\star) = 0$. The expression for the shear stress is:\n$$\n\\sigma_{r\\theta}(r, \\theta) = \\frac{1}{\\sqrt{2\\pi r}} \\frac{1}{2} \\cos\\frac{\\theta}{2} \\left[ K_{\\mathrm{I}} \\sin\\theta + K_{\\mathrm{II}} (3\\cos\\theta - 1) \\right]\n$$\nSetting the term in the square brackets to zero (as $\\cos(\\theta/2) \\neq 0$ for any relevant angle) gives the governing equation for $\\theta^\\star$:\n$$\nK_{\\mathrm{I}} \\sin\\theta^\\star + K_{\\mathrm{II}}(3\\cos\\theta^\\star - 1) = 0\n$$\nThis is a transcendental equation for $\\theta^\\star \\in [-\\pi/2, \\pi/2]$. To solve this robustly, we employ the Weierstrass substitution (tangent half-angle substitution). Let $t = \\tan(\\theta^\\star/2)$. We use the identities $\\sin\\theta^\\star = \\frac{2t}{1+t^2}$ and $\\cos\\theta^\\star = \\frac{1-t^2}{1+t^2}$. Substituting these into the governing equation yields:\n$$\nK_{\\mathrm{I}} \\frac{2t}{1+t^2} + K_{\\mathrm{II}}\\left(3\\frac{1-t^2}{1+t^2} - 1\\right) = 0\n$$\nMultiplying by $(1+t^2)$ and simplifying gives a quadratic equation for $t$:\n$$\n2K_{\\mathrm{I}}t + K_{\\mathrm{II}}(3(1-t^2) - (1+t^2)) = 0\n$$\n$$\n2K_{\\mathrm{I}}t + K_{\\mathrm{II}}(2 - 4t^2) = 0\n$$\n$$\n2K_{\\mathrm{II}}t^2 - K_{\\mathrm{I}}t - K_{\\mathrm{II}} = 0\n$$\nThis quadratic equation has two solutions for $t$:\n$$\nt = \\frac{K_{\\mathrm{I}} \\pm \\sqrt{K_{\\mathrm{I}}^2 + 8K_{\\mathrm{II}}^2}}{4K_{\\mathrm{II}}}\n$$\nOne must select the root that corresponds to a maximum of $\\sigma_{\\theta\\theta}$, not a minimum. A physical argument or a second-derivative test shows that the correct root is consistently given by choosing the minus sign. This choice ensures that for $K_{\\mathrm{I}}  0$ and $K_{\\mathrm{II}}  0$, the angle $\\theta^\\star$ is negative, which is physically correct. Thus, we have:\n$$\nt = \\frac{K_{\\mathrm{I}} - \\sqrt{K_{\\mathrm{I}}^2 + 8K_{\\mathrm{II}}^2}}{4K_{\\mathrm{II}}}\n$$\nThe continuous propagation angle is then found by $\\theta^\\star = 2 \\arctan(t)$.\nFor the special case of pure Mode I loading ($K_{\\mathrm{II}} = 0$), the governing equation simplifies to $K_{\\mathrm{I}}\\sin\\theta^\\star=0$, which gives $\\theta^\\star=0$ as expected. The quadratic formula for $t$ is ill-defined for $K_{\\mathrm{II}}=0$ and must be handled as a separate case.\n\n**2. Discrete Crack Propagation Direction $\\hat{\\theta}$**\n\nThe discrete direction $\\hat{\\theta}(h,\\phi)$ is selected from a set of mesh-induced candidate directions $\\mathcal{S}(h,\\phi)$. The problem defines the selection rule as choosing the candidate angle closest to the continuous direction $\\theta^\\star$:\n$$\n\\hat{\\theta}(h,\\phi) = \\underset{\\theta \\in \\mathcal{S}(h,\\phi)}{\\arg\\min}\\; |\\theta - \\theta^\\star|\n$$\nThe set of candidate angles is an arithmetic progression $\\theta_k = \\phi + k h$ constrained to the interval $[-\\pi/2, \\pi/2]$.\nTo find $\\hat{\\theta}$, we can first find the closest angle in the infinite grid $\\phi + kh$ for $k \\in \\mathbb{Z}$. This angle is given by $\\theta_{\\text{unconstrained}} = \\phi + h \\cdot \\text{round}\\left(\\frac{\\theta^\\star - \\phi}{h}\\right)$.\nNext, we must respect the constraint $\\theta_k \\in [-\\pi/2, \\pi/2]$. The set $\\mathcal{S}(h,\\phi)$ is defined by integer indices $k$ such that $k_{\\min} \\le k \\le k_{\\max}$, where:\n$$\nk_{\\min} = \\left\\lceil \\frac{-\\pi/2 - \\phi}{h} \\right\\rceil, \\quad k_{\\max} = \\left\\lfloor \\frac{\\pi/2 - \\phi}{h} \\right\\rfloor\n$$\nThe corresponding minimum and maximum angles in the set are $\\theta_{\\min} = \\phi + k_{\\min}h$ and $\\theta_{\\max} = \\phi + k_{\\max}h$. The correct discrete angle $\\hat{\\theta}$ is found by clamping $\\theta_{\\text{unconstrained}}$ to the range $[\\theta_{\\min}, \\theta_{\\max}]$:\n$$\n\\hat{\\theta}(h, \\phi) = \\max(\\theta_{\\min}, \\min(\\theta_{\\text{unconstrained}}, \\theta_{\\max}))\n$$\nThis procedure guarantees that we find the angle within the valid discrete set $\\mathcal{S}(h,\\phi)$ that is closest to $\\theta^\\star$.\n\n**3. Computation of $\\Delta\\theta_{\\max}$ for Test Cases**\n\nFor each test case, we compute $\\theta^\\star$ and then evaluate the error $|\\hat{\\theta}(h,\\phi) - \\theta^\\star|$ for four mesh configurations: $(h_1, 0)$, $(h_1, h_1/2)$, $(h_2, 0)$, and $(h_2, h_2/2)$, where $h_1 = \\pi/12$ and $h_2 = \\pi/48$. The quantity of interest, $\\Delta\\theta_{\\max}$, is the maximum of these four error values.\n\n**Case 1: $(K_{\\mathrm{I}}, K_{\\mathrm{II}}) = (1.0, 0.0)$**\nThis is a pure Mode I case.\n$\\theta^\\star = 0$ radians.\nThe maximum error occurs for the coarser mesh ($h_1 = \\pi/12$) with the phase shift ($\\phi = h_1/2 = \\pi/24$) that places $\\theta^\\star=0$ exactly between two grid points ($-\\pi/24$ and $\\pi/24$).\nThe error is $|\\pm \\pi/24 - 0| = \\pi/24$.\n$\\Delta\\theta_{\\max} = \\max\\{0, \\pi/24, 0, \\pi/96\\} = \\pi/24 \\approx 0.13089969$.\n\n**Case 2: $(K_{\\mathrm{I}}, K_{\\mathrm{II}}) = (1.0, 0.3)$**\nUsing the derived formula:\n$t = \\frac{1.0 - \\sqrt{1.0^2 + 8(0.3)^2}}{4(0.3)} = \\frac{1 - \\sqrt{1.72}}{1.2}$.\n$\\theta^\\star = 2 \\arctan(t) \\approx -0.50792036$ radians.\nWe then compute the four errors:\n- For $(h, \\phi) = (\\pi/12, 0)$: error $\\approx 0.01567841$.\n- For $(h, \\phi) = (\\pi/12, \\pi/24)$: error $\\approx 0.11522143$.\n- For $(h, \\phi) = (\\pi/48, 0)$: error $\\approx 0.01567841$.\n- For $(h, \\phi) = (\\pi/48, \\pi/96)$: error $\\approx 0.01704702$.\nThe maximum deviation is $\\Delta\\theta_{\\max} \\approx 0.11522143$.\n\n**Case 3: $(K_{\\mathrm{I}}, K_{\\mathrm{II}}) = (10^{-6}, 1.0)$**\nThis is a nearly pure Mode II case.\nUsing the derived formula:\n$t = \\frac{10^{-6} - \\sqrt{(10^{-6})^2 + 8(1.0)^2}}{4(1.0)} = \\frac{10^{-6} - \\sqrt{10^{-12} + 8}}{4}$.\n$\\theta^\\star = 2 \\arctan(t) \\approx -1.23095908$ radians. This is very close to the pure Mode II angle, $-\\arccos(1/3) \\approx -1.23095942$.\nWe compute the four errors:\n- For $(h, \\phi) = (\\pi/12, 0)$: error $\\approx 0.07803783$.\n- For $(h, \\phi) = (\\pi/12, \\pi/24)$: error $\\approx 0.05286186$.\n- For $(h, \\phi) = (\\pi/48, 0)$: error $\\approx 0.01257523$.\n- For $(h, \\phi) = (\\pi/48, \\pi/96)$: error $\\approx 0.02015019$.\nThe maximum deviation is $\\Delta\\theta_{\\max} \\approx 0.07803783$.\n\nThe final results are obtained by rounding these maximum deviations to six decimal places.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the crack propagation direction problem for the given test cases.\n    \"\"\"\n\n    def get_theta_star(KI, KII):\n        \"\"\"\n        Computes the continuous crack growth angle theta_star in radians.\n        \n        Args:\n            KI (float): Mode-I Stress Intensity Factor.\n            KII (float): Mode-II Stress Intensity Factor.\n            \n        Returns:\n            float: The continuous propagation angle theta_star in radians.\n        \"\"\"\n        if np.isclose(KII, 0.0):\n            return 0.0\n        \n        # Use the quadratic formula derived from the half-angle substitution.\n        # t = tan(theta*/2)\n        # The root with the minus sign is chosen to provide the physically correct angle\n        # that maximizes the circumferential stress.\n        discriminant = KI**2 + 8 * KII**2\n        t = (KI - np.sqrt(discriminant)) / (4 * KII)\n        \n        theta_star = 2 * np.arctan(t)\n        return theta_star\n\n    def get_theta_hat(theta_star, h, phi):\n        \"\"\"\n        Computes the discrete crack growth angle theta_hat in radians.\n        \n        Args:\n            theta_star (float): The continuous propagation angle.\n            h (float): The angular spacing of the discrete grid.\n            phi (float): The phase/rotation of the discrete grid.\n            \n        Returns:\n            float: The discrete propagation angle theta_hat in radians.\n        \"\"\"\n        # Find the closest angle in the unconstrained infinite grid\n        k_unconstrained = np.round((theta_star - phi) / h)\n        theta_unconstrained = phi + k_unconstrained * h\n\n        # Determine the valid range of k indices for angles in [-pi/2, pi/2]\n        k_min = np.ceil((-np.pi/2 - phi) / h)\n        k_max = np.floor((np.pi/2 - phi) / h)\n\n        theta_min_valid = phi + k_min * h\n        theta_max_valid = phi + k_max * h\n        \n        # Clamp the unconstrained angle to the valid range\n        theta_hat = np.clip(theta_unconstrained, theta_min_valid, theta_max_valid)\n\n        return theta_hat\n\n    def calculate_delta_theta_max(KI, KII, h1, h2):\n        \"\"\"\n        Calculates the worst-case absolute angular deviation for a given (KI, KII).\n        \"\"\"\n        theta_star = get_theta_star(KI, KII)\n        \n        mesh_configs = [\n            (h1, 0.0),\n            (h1, h1 / 2.0),\n            (h2, 0.0),\n            (h2, h2 / 2.0)\n        ]\n        \n        max_deviation = 0.0\n        \n        for h, phi in mesh_configs:\n            # The range of theta_star is [-pi/2, pi/2], as is the search space for theta_hat.\n            # The get_theta_hat function correctly finds the closest grid point within [-pi/2, pi/2].\n            theta_hat = get_theta_hat(theta_star, h, phi)\n            deviation = np.abs(theta_hat - theta_star)\n            if deviation > max_deviation:\n                max_deviation = deviation\n                \n        return max_deviation\n\n    # Define test suite from the problem statement\n    test_cases = [\n        (1.0, 0.0),      # Case 1\n        (1.0, 0.3),      # Case 2\n        (1e-6, 1.0)      # Case 3\n    ]\n\n    h1 = np.pi / 12.0\n    h2 = np.pi / 48.0\n    \n    results = []\n    for KI, KII in test_cases:\n        delta_theta_max = calculate_delta_theta_max(KI, KII, h1, h2)\n        results.append(round(delta_theta_max, 6))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2557306"}]}