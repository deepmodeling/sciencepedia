{"hands_on_practices": [{"introduction": "Before delving into complex calculations, it is essential to ground our understanding in fundamental principles. This first practice centers on dimensional analysis, a powerful method for verifying the physical consistency of an equation. By confirming that the core heat exchanger relation, $Q = U A \\Delta T_{lm}$, is dimensionally sound, you will solidify your grasp of each term and its proper SI units, paying special attention to the dimensional nature of the logarithmic mean temperature difference itself [@problem_id:2501366].", "problem": "A single-pass heat exchanger operating at steady state exchanges energy between two fluid streams that do not mix. From a differential energy balance on one stream and the definition of an overall heat transfer coefficient, the total heat transfer rate can be modeled as the product of an overall heat transfer coefficient, an appropriate exchange area, and a characteristic mean temperature difference between the two streams. In the log mean temperature difference (LMTD) method, this characteristic mean is the logarithmic mean temperature difference. Using only fundamental dimensional definitions for energy, power, area, temperature, and heat flux, verify that the relation is dimensionally consistent, and identify the correct International System of Units (SI) for each quantity. Which option correctly states the SI units for the heat transfer rate, the overall heat transfer coefficient, the heat transfer area, and the logarithmic mean temperature difference, and correctly characterizes the dimensional status of the logarithmic mean temperature difference with respect to the presence of a logarithm?\n\nA. Heat transfer rate $Q$ in $\\mathrm{J}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, area $A$ in $\\mathrm{m}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ dimensionless because a logarithm appears in its definition.\n\nB. Heat transfer rate $Q$ in $\\mathrm{W}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, area $A$ in $\\mathrm{m^{2}}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ in $\\mathrm{K}$; the logarithm in its definition operates on a dimensionless ratio so $\\Delta T_{lm}$ retains temperature units, and the units of $U$ are invariant to the choice of inside or outside area basis.\n\nC. Heat transfer rate $Q$ in $\\mathrm{J\\cdot s^{-1}}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, area $A$ in $\\mathrm{m}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ in $\\mathrm{K}$; moreover, the units of $U$ depend on whether the inside or outside area basis is used.\n\nD. Heat transfer rate $Q$ in $\\mathrm{W}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, area $A$ in $\\mathrm{m^{2}}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ dimensionless because it is a mean of a ratio of temperature differences.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\n**Step 1: Extract Givens**\n- The system is a single-pass heat exchanger at steady state.\n- The total heat transfer rate, $Q$, is modeled as the product of an overall heat transfer coefficient, $U$, an exchange area, $A$, and a characteristic mean temperature difference.\n- The characteristic mean temperature difference is the logarithmic mean temperature difference, $\\Delta T_{lm}$.\n- The governing relation is thus $Q = U A \\Delta T_{lm}$.\n- The task is to:\n    1. Verify the dimensional consistency of the relation.\n    2. Identify the correct International System of Units (SI) for $Q$, $U$, $A$, and $\\Delta T_{lm}$.\n    3. Characterize the dimensional status of $\\Delta T_{lm}$ with respect to the logarithm in its definition.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is scientifically grounded, well-posed, and objective. It is based on the fundamental principles of heat transfer, specifically the Log Mean Temperature Difference (LMTD) method, which is a standard topic in engineering thermodynamics and heat and mass transfer. The problem description is clear, self-contained, and does not violate any physical laws or mathematical principles. It asks for a standard dimensional analysis, which is a solvable and meaningful task. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full derivation and analysis will be performed.\n\n**Derivation of Units and Dimensional Analysis**\n\nThe relationship governing the heat transfer is given as:\n$$Q = U A \\Delta T_{lm}$$\n\nWe will determine the SI units for each term based on fundamental definitions.\n\n1.  **Heat Transfer Rate ($Q$)**: The term \"rate\" implies that this quantity is energy per unit time.\n    - In the SI system, energy is measured in Joules ($J$).\n    - Time is measured in seconds ($s$).\n    - Therefore, the heat transfer rate has units of Joules per second ($J \\cdot s^{-1}$).\n    - The unit $J \\cdot s^{-1}$ is defined as the Watt ($W$).\n    - So, the SI unit for $Q$ is the Watt ($W$). The dimension is Power, $[P] = [M][L]^2[T]^{-3}$.\n\n2.  **Heat Transfer Area ($A$)**: This is the surface area across which heat is exchanged.\n    - In the SI system, area is a measure of a two-dimensional surface.\n    - The unit for length is the meter ($m$).\n    - Therefore, the SI unit for area is square meters ($m^2$). The dimension is $[L]^2$.\n\n3.  **Logarithmic Mean Temperature Difference ($\\Delta T_{lm}$)**: This quantity is defined as:\n    $$\\Delta T_{lm} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln\\left(\\frac{\\Delta T_1}{\\Delta T_2}\\right)}$$\n    where $\\Delta T_1$ and $\\Delta T_2$ are the temperature differences between the hot and cold fluid streams at the two ends of the heat exchanger.\n    - The terms $\\Delta T_1$ and $\\Delta T_2$ are temperature differences. The SI unit for thermodynamic temperature is the Kelvin ($K$). A temperature difference also has units of Kelvin.\n    - The numerator, $\\Delta T_1 - \\Delta T_2$, therefore has units of Kelvin ($K$).\n    - The argument of the natural logarithm function, $\\ln(\\dots)$, must be a dimensionless quantity. Here, the argument is the ratio $\\frac{\\Delta T_1}{\\Delta T_2}$. Since both $\\Delta T_1$ and $\\Delta T_2$ have units of Kelvin, their ratio is dimensionless: $\\frac{[K]}{[K]} = 1$.\n    - The result of the function $\\ln(x)$ where $x$ is dimensionless is also a dimensionless number.\n    - Therefore, the units of $\\Delta T_{lm}$ are the units of the numerator divided by the units of the denominator: $\\frac{[K]}{[\\text{dimensionless}]} = [K]$.\n    - The SI unit for $\\Delta T_{lm}$ is Kelvin ($K$). The presence of a logarithm does not render the quantity dimensionless; rather, the logarithm function must operate on a dimensionless argument, and its output is also dimensionless, leaving the units of the numerator intact.\n\n4.  **Overall Heat Transfer Coefficient ($U$)**: The units for $U$ can be derived by rearranging the governing equation:\n    $$U = \\frac{Q}{A \\Delta T_{lm}}$$\n    Substituting the SI units for the other quantities:\n    - Units of $Q$: $W$\n    - Units of $A$: $m^2$\n    - Units of $\\Delta T_{lm}$: $K$\n    - Therefore, the SI units for $U$ are $\\frac{W}{m^2 \\cdot K}$, which is written as $W \\cdot m^{-2} \\cdot K^{-1}$.\n    - The dimensional consistency of the original equation $Q = U A \\Delta T_{lm}$ is verified:\n      $$[W] = \\left[\\frac{W}{m^2 \\cdot K}\\right] \\cdot [m^2] \\cdot [K]$$\n      $$[W] = [W]$$\n      The relation is dimensionally consistent.\n\n**Option-by-Option Analysis**\n\nA. Heat transfer rate $Q$ in $\\mathrm{J}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, area $A$ in $\\mathrm{m}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ dimensionless because a logarithm appears in its definition.\n- $Q$ in $J$: Incorrect. $Q$ is a rate (power), not energy. The unit should be $W$.\n- $U$ in $W \\cdot m^{-1} \\cdot K^{-1}$: Incorrect. The unit for area is $m^2$, not $m$, so the unit for $U$ is $W \\cdot m^{-2} \\cdot K^{-1}$.\n- $A$ in $m$: Incorrect. Area is in $m^2$.\n- $\\Delta T_{lm}$ dimensionless: Incorrect. As derived, it has units of temperature ($K$).\n**Verdict: Incorrect.**\n\nB. Heat transfer rate $Q$ in $\\mathrm{W}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, area $A$ in $\\mathrm{m^{2}}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ in $\\mathrm{K}$; the logarithm in its definition operates on a dimensionless ratio so $\\Delta T_{lm}$ retains temperature units, and the units of $U$ are invariant to the choice of inside or outside area basis.\n- $Q$ in $W$: Correct.\n- $U$ in $W \\cdot m^{-2} \\cdot K^{-1}$: Correct.\n- $A$ in $m^2$: Correct.\n- $\\Delta T_{lm}$ in $K$: Correct. The reasoning provided is also precisely correct; the logarithm operates on a dimensionless ratio.\n- \"the units of $U$ are invariant to the choice of inside or outside area basis\": Correct. The overall heat transfer coefficient is often specified based on either the inside surface area ($A_i$) or the outside surface area ($A_o$) of the tubes in the exchanger. The product $U \\cdot A$ must be constant, so $U_i A_i = U_o A_o$. If $A_i \\neq A_o$, the numerical *value* of $U$ will change depending on the reference area ($U_i \\neq U_o$). However, the *units* of $U$ remain $W \\cdot m^{-2} \\cdot K^{-1}$ regardless of the basis. The statement is about units, not value.\n**Verdict: Correct.**\n\nC. Heat transfer rate $Q$ in $\\mathrm{J\\,s^{-1}}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-1}\\,K^{-1}}$, area $A$ in $\\mathrm{m}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ in $\\mathrm{K}$; moreover, the units of $U$ depend on whether the inside or outside area basis is used.\n- $Q$ in $J \\cdot s^{-1}$: Correct, as this is the definition of a Watt ($W$).\n- $U$ in $W \\cdot m^{-1} \\cdot K^{-1}$: Incorrect. This implies area has units of length, which is false.\n- $A$ in $m$: Incorrect. Area is in $m^2$.\n- \"the units of $U$ depend on whether the inside or outside area basis is used\": Incorrect. As explained for option B, the units are invariant; only the numerical value depends on the basis.\n**Verdict: Incorrect.**\n\nD. Heat transfer rate $Q$ in $\\mathrm{W}$, overall heat transfer coefficient $U$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, area $A$ in $\\mathrm{m^{2}}$, and logarithmic mean temperature difference $\\Delta T_{lm}$ dimensionless because it is a mean of a ratio of temperature differences.\n- $Q$ in $W$: Correct.\n- $U$ in $W \\cdot m^{-2} \\cdot K^{-1}$: Correct.\n- $A$ in $m^2$: Correct.\n- $\\Delta T_{lm}$ dimensionless: Incorrect. It has units of temperature ($K$). The reasoning given is also incorrect and nonsensical. It is a ratio involving a logarithm, not a mean of a ratio.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "2501366"}, {"introduction": "With the fundamentals in place, we now apply the LMTD method to a practical design challenge: assessing feasibility. A critical step in thermal engineering is to determine not just the performance of a proposed heat exchanger, but whether it is physically possible in the first place. This exercise guides you through using the First and Second Laws of Thermodynamics to check for a \"temperature cross\"—a condition that violates physical laws—and to see how switching from a parallel-flow to a counter-flow arrangement can resolve such an issue [@problem_id:2501368].", "problem": "A single-pass tubular heat exchanger is to cool a hot oil stream using liquid water, with negligible axial conduction, constant properties, and no heat losses to the surroundings. The hot oil enters at temperature $T_{h,\\mathrm{in}} = 140\\,^\\circ\\text{C}$ with heat capacity rate $C_{h} = 4\\,\\mathrm{kW/K}$, and the water enters at temperature $T_{c,\\mathrm{in}} = 20\\,^\\circ\\text{C}$ with heat capacity rate $C_{c} = 6\\,\\mathrm{kW/K}$. The process requirement is a hot oil outlet temperature $T_{h,\\mathrm{out}} = 50\\,^\\circ\\text{C}$. The design team proposes a parallel-flow arrangement.\n\nUsing only first principles—namely, the steady-state energy balance, the definition of end temperature differences for a given flow arrangement, and the requirement from the Second Law of Thermodynamics that the local temperature driving force must not change sign for a sensible heat exchanger—determine whether the proposed parallel-flow design is feasible in the sense that the Log Mean Temperature Difference (LMTD) remains non-negative and real. If the proposed arrangement is infeasible, identify a feasible alternative arrangement (if any) that can achieve the stated target and determine the corresponding minimum overall conductance $U A$ needed to meet the duty at steady state.\n\nAssume that the overall heat transfer coefficient $U$ and the heat transfer area $A$ are uniform and that the total heat transfer rate is related to the Log Mean Temperature Difference by the standard LMTD method.\n\nSelect all statements that are correct:\n\n- A. The parallel-flow design is feasible; the Log Mean Temperature Difference is positive, and the required $U A$ equals $8.31\\,\\mathrm{kW/K}$.\n- B. The parallel-flow design is infeasible because the outlet-end temperature difference would be negative, rendering the Log Mean Temperature Difference non-real (violating the Second Law).\n- C. Both parallel-flow and counter-flow arrangements are feasible with the same required $U A$ for the stated targets.\n- D. The counter-flow arrangement is feasible; the required $U A$ is approximately $8.31\\,\\mathrm{kW/K}$.", "solution": "The problem statement will first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n- Hot fluid inlet temperature: $T_{h,\\mathrm{in}} = 140\\,^\\circ\\text{C}$\n- Hot fluid heat capacity rate: $C_{h} = 4\\,\\mathrm{kW/K}$\n- Cold fluid inlet temperature: $T_{c,\\mathrm{in}} = 20\\,^\\circ\\text{C}$\n- Cold fluid heat capacity rate: $C_{c} = 6\\,\\mathrm{kW/K}$\n- Required hot fluid outlet temperature: $T_{h,\\mathrm{out}} = 50\\,^\\circ\\text{C}$\n- Proposed arrangement: Parallel-flow.\n- Assumptions: Single-pass tubular heat exchanger, negligible axial conduction, constant properties, no heat losses to the surroundings, uniform overall heat transfer coefficient $U$ and area $A$.\n- Required Analysis: Determine feasibility of the parallel-flow design using first principles, including the Second Law constraint. If infeasible, evaluate a feasible alternative and its required overall conductance $UA$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it concerns a standard thermal engineering analysis based on the First and Second Laws of Thermodynamics. It is well-posed, providing sufficient data to perform the requested feasibility analysis and calculations. The language is objective and precise. The physical values are realistic. There are no contradictions or ambiguities.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will proceed.\n\n### Derivation\n\nThe analysis begins with the steady-state energy balance, which is an application of the First Law of Thermodynamics. The heat transferred from the hot fluid must equal the heat absorbed by the cold fluid, as heat losses are negligible.\n\nThe total heat transfer rate, $\\dot{Q}$, is determined from the specified conditions for the hot fluid:\n$$ \\dot{Q} = C_{h} (T_{h,\\mathrm{in}} - T_{h,\\mathrm{out}}) $$\nSubstituting the given values:\n$$ \\dot{Q} = (4\\,\\mathrm{kW/K}) \\times (140\\,^\\circ\\text{C} - 50\\,^\\circ\\text{C}) = 4 \\times 90 \\,\\mathrm{kW} = 360\\,\\mathrm{kW} $$\n\nUsing this heat rate, we can determine the outlet temperature of the cold fluid, $T_{c,\\mathrm{out}}$, from the energy balance for the cold stream:\n$$ \\dot{Q} = C_{c} (T_{c,\\mathrm{out}} - T_{c,\\mathrm{in}}) $$\n$$ 360\\,\\mathrm{kW} = (6\\,\\mathrm{kW/K}) \\times (T_{c,\\mathrm{out}} - 20\\,^\\circ\\text{C}) $$\nSolving for $T_{c,\\mathrm{out}}$:\n$$ T_{c,\\mathrm{out}} - 20\\,^\\circ\\text{C} = \\frac{360\\,\\mathrm{kW}}{6\\,\\mathrm{kW/K}} = 60\\,\\mathrm{K} = 60\\,^\\circ\\text{C} $$\n$$ T_{c,\\mathrm{out}} = 20\\,^\\circ\\text{C} + 60\\,^\\circ\\text{C} = 80\\,^\\circ\\text{C} $$\n\n**Feasibility of the Parallel-Flow Arrangement**\n\nNow we assess the feasibility of the proposed parallel-flow arrangement. In a parallel-flow heat exchanger, both fluids enter at the same end (let us call this end '1') and exit at the other end (end '2'). For heat transfer to occur from the hot fluid to the cold fluid at every point along the exchanger, the Second Law of Thermodynamics requires that $T_h(x) \\ge T_c(x)$ for all positions $x$. This must hold at the boundaries as well.\n\nAt the inlet (end 1):\n$T_{h,1} = T_{h,\\mathrm{in}} = 140\\,^\\circ\\text{C}$\n$T_{c,1} = T_{c,\\mathrm{in}} = 20\\,^\\circ\\text{C}$\nThe temperature difference is $\\Delta T_1 = T_{h,1} - T_{c,1} = 140 - 20 = 120\\,^\\circ\\text{C}$. Here, $T_h > T_c$, which is valid.\n\nAt the outlet (end 2):\n$T_{h,2} = T_{h,\\mathrm{out}} = 50\\,^\\circ\\text{C}$\n$T_{c,2} = T_{c,\\mathrm{out}} = 80\\,^\\circ\\text{C}$\nThe temperature difference is $\\Delta T_2 = T_{h,2} - T_{c,2} = 50 - 80 = -30\\,^\\circ\\text{C}$.\n\nThe outlet temperature of the hot fluid ($50\\,^\\circ\\text{C}$) is lower than the outlet temperature of the cold fluid ($80\\,^\\circ\\text{C}$). This condition is physically impossible in a parallel-flow arrangement, as it would necessitate heat transfer from the colder fluid to the hotter fluid near the outlet, a direct violation of the Second Law of Thermodynamics. Such a scenario is referred to as a \"temperature cross\" and renders the design infeasible. Consequently, the Log Mean Temperature Difference (LMTD) for this configuration, given by $\\Delta T_{\\mathrm{lm}} = (\\Delta T_1 - \\Delta T_2) / \\ln(\\Delta T_1 / \\Delta T_2)$, would involve the logarithm of a negative number ($\\ln(120/(-30))$), which is not a real number. The parallel-flow design is therefore infeasible.\n\n**Feasibility of the Counter-Flow Arrangement**\n\nWe now investigate the alternative counter-flow arrangement. In this configuration, fluids enter at opposite ends. Let end '1' be the hot fluid inlet and cold fluid outlet, and end '2' be the hot fluid outlet and cold fluid inlet.\n\nAt end '1':\n$T_{h,1} = T_{h,\\mathrm{in}} = 140\\,^\\circ\\text{C}$\n$T_{c,1} = T_{c,\\mathrm{out}} = 80\\,^\\circ\\text{C}$\nThe temperature difference is $\\Delta T_1 = T_{h,1} - T_{c,1} = 140 - 80 = 60\\,^\\circ\\text{C}$.\n\nAt end '2':\n$T_{h,2} = T_{h,\\mathrm{out}} = 50\\,^\\circ\\text{C}$\n$T_{c,2} = T_{c,\\mathrm{in}} = 20\\,^\\circ\\text{C}$\nThe temperature difference is $\\Delta T_2 = T_{h,2} - T_{c,2} = 50 - 20 = 30\\,^\\circ\\text{C}$.\n\nBoth end-point temperature differences are positive. For a counter-flow exchanger with constant properties, if both $\\Delta T_1 > 0$ and $\\Delta T_2 > 0$, then the local temperature difference $T_h(x) - T_c(x)$ will be positive throughout the entire exchanger. Thus, the counter-flow arrangement is thermodynamically feasible.\n\nNow, we calculate the LMTD for the counter-flow case:\n$$ \\Delta T_{\\mathrm{lm, counter}} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln(\\Delta T_1 / \\Delta T_2)} = \\frac{60\\,\\mathrm{K} - 30\\,\\mathrm{K}}{\\ln(60/30)} = \\frac{30\\,\\mathrm{K}}{\\ln(2)} $$\nUsing $\\ln(2) \\approx 0.693147$:\n$$ \\Delta T_{\\mathrm{lm, counter}} \\approx \\frac{30}{0.693147} \\,\\mathrm{K} \\approx 43.28\\,\\mathrm{K} $$\n\nWith the LMTD determined, the required overall conductance $UA$ can be calculated from the fundamental heat exchanger equation $\\dot{Q} = (UA) \\Delta T_{\\mathrm{lm}}$:\n$$ UA = \\frac{\\dot{Q}}{\\Delta T_{\\mathrm{lm, counter}}} = \\frac{360\\,\\mathrm{kW}}{30/\\ln(2)\\,\\mathrm{K}} = \\frac{360}{30} \\ln(2) \\,\\mathrm{kW/K} = 12 \\ln(2) \\,\\mathrm{kW/K} $$\n$$ UA \\approx 12 \\times 0.693147 \\,\\mathrm{kW/K} \\approx 8.31776\\,\\mathrm{kW/K} $$\nThis value is approximately $8.31\\,\\mathrm{kW/K}$.\n\n### Option-by-Option Analysis\n\n- **A. The parallel-flow design is feasible; the Log Mean Temperature Difference is positive, and the required $UA$ equals $8.31\\,\\mathrm{kW/K}$.**\nThe parallel-flow design is demonstrated to be thermodynamically infeasible due to a temperature cross, which violates the Second Law. Therefore, this statement is **Incorrect**.\n\n- **B. The parallel-flow design is infeasible because the outlet-end temperature difference would be negative, rendering the Log Mean Temperature Difference non-real (violating the Second Law).**\nOur analysis shows that for the parallel-flow arrangement, the outlet temperature difference is $T_{h,\\mathrm{out}} - T_{c,\\mathrm{out}} = 50\\,^\\circ\\text{C} - 80\\,^\\circ\\text{C} = -30\\,^\\circ\\text{C}$. A negative temperature difference implies a violation of the Second Law of Thermodynamics for a sensible heat exchanger. The LMTD calculation would involve the logarithm of a negative number, which is a non-real (complex) value. This statement is rigorously correct. The conclusion is **Correct**.\n\n- **C. Both parallel-flow and counter-flow arrangements are feasible with the same required $UA$ for the stated targets.**\nThe parallel-flow arrangement is infeasible. This immediately falsifies the statement. Furthermore, even if both were feasible, the LMTD for counter-flow is always greater than or equal to that for parallel-flow, meaning the required $UA$ would be smaller for the counter-flow case, not the same. This statement is **Incorrect**.\n\n- **D. The counter-flow arrangement is feasible; the required $UA$ is approximately $8.31\\,\\mathrm{kW/K}$.**\nOur analysis confirmed that the counter-flow arrangement is thermodynamically feasible. The calculation for the required overall conductance yielded $UA = 12 \\ln(2)\\,\\mathrm{kW/K}$, which is approximately $8.318\\,\\mathrm{kW/K}$. The value stated, $8.31\\,\\mathrm{kW/K}$, is a correct approximation. This statement is entirely consistent with the derivation from first principles. The conclusion is **Correct**.", "answer": "$$\\boxed{\\text{B, D}}$$", "id": "2501368"}, {"introduction": "Our final practice moves from analytical problems to computational implementation, a crucial skill for a modern engineer. Here, you will tackle the \"rating\" problem—predicting outlet temperatures for a given heat exchanger—by building a numerical solver from scratch. This challenge requires you to implement Newton's method to solve the coupled, nonlinear governing equations, gaining hands-on experience with the numerical subtleties of the LMTD formula and the construction of a robust computational tool for heat exchanger analysis [@problem_id:2501348].", "problem": "You will develop a program that computes the two unknown outlet temperatures in a two-stream heat exchanger, one for the hot stream and one for the cold stream, for both parallel-flow and counter-flow arrangements. The calculation must be performed by solving a coupled nonlinear system using Newton’s method. The nonlinear coupling arises from simultaneously enforcing energy conservation on each stream and the definition of the heat transfer rate in terms of the log-mean temperature difference. Your program must use the following physically based model, which is derived from fundamental energy balances and the definition of the log-mean temperature difference, and must not use shortcut correlations or pre-tabulated effectiveness formulas.\n\nThe unknowns are the hot-stream outlet temperature $T_{h,o}$ and the cold-stream outlet temperature $T_{c,o}$, given hot-stream inlet temperature $T_{h,i}$, cold-stream inlet temperature $T_{c,i}$, overall heat transfer coefficient $U$, heat transfer area $A$, and the heat capacity rates $C_{h}$ and $C_{c}$ for the hot and cold streams, respectively. Use the fundamental energy balances and the definition of the log-mean temperature difference, with the heat transfer rate defined by $Q = U A \\Delta T_{lm}$, and with $Q = C_{h} (T_{h,i} - T_{h,o}) = C_{c} (T_{c,o} - T_{c,i})$. For a single-pass exchanger with constant $U$ and $A$, the log-mean temperature difference uses the end temperature differences. For a parallel-flow arrangement:\n- $\\Delta T_{1} = T_{h,i} - T_{c,i}$,\n- $\\Delta T_{2} = T_{h,o} - T_{c,o}$.\nFor a counter-flow arrangement:\n- $\\Delta T_{1} = T_{h,i} - T_{c,o}$,\n- $\\Delta T_{2} = T_{h,o} - T_{c,i}$.\nThe log-mean temperature difference is defined for strictly positive end differences $\\Delta T_{1}  0$ and $\\Delta T_{2}  0$ as\n$$\n\\Delta T_{lm} = \\frac{\\Delta T_{1} - \\Delta T_{2}}{\\ln\\left(\\frac{\\Delta T_{1}}{\\Delta T_{2}}\\right)}.\n$$\nWhen $\\Delta T_{1}$ and $\\Delta T_{2}$ are nearly equal, your implementation must use the limiting value that is well defined by continuity, namely $\\Delta T_{lm} \\to \\Delta T_{1}$ as $\\Delta T_{2} \\to \\Delta T_{1}$, and must use consistent limiting derivatives, to maintain numerical stability.\n\nYour Newton iteration must solve the coupled system for the unknowns $T_{h,o}$ and $T_{c,o}$ by enforcing both streamwise energy balances with a single consistent heat transfer rate $Q$ computed from $U A \\Delta T_{lm}$. You must compute the Jacobian analytically, including the partial derivatives of $\\Delta T_{lm}$ with respect to the unknown outlet temperatures, and use a globalization strategy (for example, backtracking line search) to enforce the physical constraints that ensure the end temperature differences remain strictly positive. The iteration should terminate when a norm of the residual vector is sufficiently small and the Newton step is sufficiently small; clearly state and implement your convergence tolerances.\n\nAll calculations must use the following units:\n- $U$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$,\n- $A$ in $\\mathrm{m^{2}}$,\n- $C_h$ and $C_c$ in $\\mathrm{W\\,K^{-1}}$,\n- temperatures in $^\\circ\\text{C}$,\n- the heat transfer rate $Q$ in $\\mathrm{W}$.\nReport $T_{h,o}$ and $T_{c,o}$ in $^\\circ\\text{C}$ rounded to six digits after the decimal point.\n\nTest suite and required output:\n- Implement your solver and evaluate it on the five cases below. Each case is given as a tuple $(\\text{arrangement}, U, A, C_h, C_c, T_{h,i}, T_{c,i})$, where $\\text{arrangement}$ is either the string \"parallel\" or \"counter\".\n    1. $(\\text{\"parallel\"},\\, 400.0,\\, 20.0,\\, 5000.0,\\, 8000.0,\\, 120.0,\\, 20.0)$\n    2. $(\\text{\"counter\"},\\, 300.0,\\, 30.0,\\, 6000.0,\\, 6000.0,\\, 150.0,\\, 50.0)$\n    3. $(\\text{\"parallel\"},\\, 50.0,\\, 0.5,\\, 4000.0,\\, 6000.0,\\, 90.0,\\, 30.0)$\n    4. $(\\text{\"counter\"},\\, 1000.0,\\, 100.0,\\, 2000.0,\\, 6000.0,\\, 200.0,\\, 40.0)$\n    5. $(\\text{\"parallel\"},\\, 150.0,\\, 10.0,\\, 5000.0,\\, 5000.0,\\, 170.0,\\, 70.0)$\n- Your program must produce a single line of output containing the list of outlet temperatures for each case, formatted as a comma-separated list of pairs, each pair being the two temperatures $[T_{h,o}, T_{c,o}]$ rounded to six decimals. The exact required format is:\n\"[ [Th1,Tc1],[Th2,Tc2],[Th3,Tc3],[Th4,Tc4],[Th5,Tc5] ]\"\nwhere each $T$ is a decimal number with six digits after the decimal point (no units and no extra spaces).", "solution": "We derive and implement a robust Newton method for computing $T_{h,o}$ and $T_{c,o}$ by starting from first principles. The fundamental base consists of streamwise energy balances and the definition of the log-mean temperature difference.\n\n1. Fundamental governing relations. For a single-pass heat exchanger with constant overall heat transfer coefficient $U$ and area $A$, assuming negligible axial conduction and no phase change, the rate of heat transfer $Q$ satisfies energy conservation on each stream:\n$$\nQ = C_h \\left(T_{h,i} - T_{h,o}\\right) = C_c \\left(T_{c,o} - T_{c,i}\\right).\n$$\nBy definition of the log-mean temperature difference for strictly positive end differences at the terminal points,\n$$\nQ = U A \\Delta T_{lm}, \\quad \\Delta T_{lm} = \\frac{\\Delta T_1 - \\Delta T_2}{\\ln\\left(\\frac{\\Delta T_1}{\\Delta T_2}\\right)}.\n$$\nFor parallel flow,\n$$\n\\Delta T_1 = T_{h,i} - T_{c,i}, \\quad \\Delta T_2 = T_{h,o} - T_{c,o},\n$$\nand for counter flow,\n$$\n\\Delta T_1 = T_{h,i} - T_{c,o}, \\quad \\Delta T_2 = T_{h,o} - T_{c,i}.\n$$\nThese relations couple the two unknown outlet temperatures to the end temperature differences that define the log-mean temperature difference.\n\n2. Nonlinear system formulation. The unknown vector is\n$$\n\\mathbf{x} =\n\\begin{bmatrix}\nT_{h,o} \\\\ T_{c,o}\n\\end{bmatrix}.\n$$\nDefine the log-mean temperature difference as a function $L(\\Delta T_1, \\Delta T_2)$, and define $Q(\\mathbf{x}) = U A \\, L(\\Delta T_1(\\mathbf{x}), \\Delta T_2(\\mathbf{x}))$. The two residual equations enforce energy conservation on each stream using the same $Q$:\n$$\nF_1(\\mathbf{x}) = C_h \\left(T_{h,i} - T_{h,o}\\right) - Q(\\mathbf{x}) = 0,\n$$\n$$\nF_2(\\mathbf{x}) = C_c \\left(T_{c,o} - T_{c,i}\\right) - Q(\\mathbf{x}) = 0.\n$$\nSolving $\\mathbf{F}(\\mathbf{x}) = \\mathbf{0}$ yields physically admissible outlet temperatures if we enforce the positivity of the end temperature differences: for parallel flow, $\\Delta T_2 = T_{h,o} - T_{c,o}  0$ in addition to $\\Delta T_10$; for counter flow, we require $\\Delta T_1 = T_{h,i} - T_{c,o}  0$ and $\\Delta T_2 = T_{h,o} - T_{c,i}  0$. Additionally, physical bounds require $T_{h,i} \\ge T_{h,o} \\ge T_{c,i}$ and $T_{h,i} \\ge T_{c,o} \\ge T_{c,i}$ for sensible heat exchange without internal heat generation.\n\n3. Log-mean temperature difference and its derivatives. Let $f(a,b) = \\dfrac{a-b}{\\ln\\left(a/b\\right)}$ for $a0$, $b0$, $a\\neq b$. Its partial derivatives are obtained by quotient rule using $\\partial \\ln(a/b)/\\partial a = 1/a$ and $\\partial \\ln(a/b)/\\partial b = -1/b$:\n$$\n\\frac{\\partial f}{\\partial a} = \\frac{\\ln\\left(\\frac{a}{b}\\right) - \\frac{a-b}{a}}{\\left[\\ln\\left(\\frac{a}{b}\\right)\\right]^2}, \\qquad\n\\frac{\\partial f}{\\partial b} = \\frac{-\\ln\\left(\\frac{a}{b}\\right) + \\frac{a-b}{b}}{\\left[\\ln\\left(\\frac{a}{b}\\right)\\right]^2}.\n$$\nWhen $a \\to b$, we use the limiting values. A second-order expansion shows\n$$\n\\lim_{a\\to b} f(a,b) = a, \\qquad \\lim_{a\\to b} \\frac{\\partial f}{\\partial a} = \\frac{1}{2}, \\qquad \\lim_{a\\to b} \\frac{\\partial f}{\\partial b} = \\frac{1}{2}.\n$$\nThese limits must be used in implementation to avoid numerical loss of significance when $|a-b|$ is small relative to $\\max(a,b)$.\n\nFor parallel flow,\n$$\na = \\Delta T_1 = T_{h,i} - T_{c,i}, \\quad b = \\Delta T_2 = T_{h,o} - T_{c,o},\n$$\nso that\n$$\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b}\\cdot \\frac{\\partial b}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b} \\cdot 1, \\qquad\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial b}\\cdot \\frac{\\partial b}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial b} \\cdot (-1).\n$$\nFor counter flow,\n$$\na = \\Delta T_1 = T_{h,i} - T_{c,o}, \\quad b = \\Delta T_2 = T_{h,o} - T_{c,i},\n$$\nso that\n$$\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}} = \\frac{\\partial f}{\\partial b}\\cdot 1, \\qquad\n\\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial a}\\cdot \\frac{\\partial a}{\\partial T_{c,o}} = \\frac{\\partial f}{\\partial a} \\cdot (-1).\n$$\n\n4. Newton iteration. Let $\\mathbf{F}(\\mathbf{x})$ be as above. The Jacobian is\n$$\nJ(\\mathbf{x}) =\n\\begin{bmatrix}\n\\frac{\\partial F_1}{\\partial T_{h,o}}  \\frac{\\partial F_1}{\\partial T_{c,o}}\\\\\n\\frac{\\partial F_2}{\\partial T_{h,o}}  \\frac{\\partial F_2}{\\partial T_{c,o}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n- C_h - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}}  - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}}\\\\\n- U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{h,o}}  \\phantom{-} C_c - U A \\frac{\\partial \\Delta T_{lm}}{\\partial T_{c,o}}\n\\end{bmatrix}.\n$$\nNewton’s method updates\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\alpha_k \\Delta \\mathbf{x}_k, \\quad \\text{where} \\quad J(\\mathbf{x}_k)\\,\\Delta \\mathbf{x}_k = -\\mathbf{F}(\\mathbf{x}_k),\n$$\nwith a globalization factor $0  \\alpha_k \\le 1$ chosen by a backtracking line search to ensure that the new iterate satisfies physical feasibility (strict positivity of the end temperature differences) and reduces the residual norm, for example the Euclidean norm $\\|\\mathbf{F}\\|_2$.\n\n5. Convergence criteria. Terminate when both of the following are satisfied:\n- $\\|\\mathbf{F}(\\mathbf{x}_k)\\|_2 \\le \\varepsilon_{res}$,\n- $\\|\\Delta \\mathbf{x}_k\\|_2 \\le \\varepsilon_{step}$.\nA robust choice is $\\varepsilon_{res} = 10^{-9}$ in $\\mathrm{W}$ and $\\varepsilon_{step} = 10^{-10}$ in $\\mathrm{K}$. Set a maximum iteration count (for example, $50$) and declare failure if not converged within that limit. Backtracking reduces $\\alpha_k$ geometrically (for example, multiply by $1/2$ repeatedly) until feasibility and a sufficient decrease condition are met. If backtracking reduces $\\alpha_k$ below a minimal threshold (for example, $10^{-10}$), terminate with failure; however, the provided test suite is chosen to avoid such failures.\n\n6. Initialization. A physically admissible initial guess ensures feasibility: choose a conservative initial heat transfer rate\n$$\nQ_0 = \\frac{1}{2}\\,\\min\\left( U A \\, (T_{h,i} - T_{c,i}),\\, \\min(C_h,C_c)\\,(T_{h,i} - T_{c,i}) \\right),\n$$\nand set\n$$\nT_{h,o}^{(0)} = T_{h,i} - \\frac{Q_0}{C_h}, \\quad T_{c,o}^{(0)} = T_{c,i} + \\frac{Q_0}{C_c}.\n$$\nThis respects $T_{h,i} \\ge T_{h,o}^{(0)}  T_{c,i}$ and $T_{c,o}^{(0)}  T_{c,i}$ by construction, and is generally a good starting point for both arrangements.\n\n7. Output specification. For each test case, compute the converged $(T_{h,o}, T_{c,o})$ and output the list of five pairs of outlet temperatures as a single line in the exact format:\n\"[ [Th1,Tc1],[Th2,Tc2],[Th3,Tc3],[Th4,Tc4],[Th5,Tc5] ]\"\nAll temperatures must be rounded to six digits after the decimal point and printed without units and without any extra spaces.\n\nThe algorithm described integrates the underlying principles (energy conservation and the log-mean definition) into a stable Newton iteration by deriving and using the analytic Jacobian, enforcing feasibility through line search, and applying rigorous convergence criteria.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef log_mean_and_partials(a: float, b: float):\n    \"\"\"\n    Compute the log-mean temperature difference L(a,b) and its partial derivatives\n    with respect to a and b, using stable limits when a ~ b.\n\n    Parameters:\n        a, b: positive end temperature differences (must be  0)\n\n    Returns:\n        L, dL_da, dL_db\n    \"\"\"\n    if a = 0.0 or b = 0.0:\n        raise ValueError(\"End temperature differences must be positive.\")\n    # Relative closeness threshold\n    # Use a symmetric measure to detect near-equality\n    maxab = max(abs(a), abs(b))\n    if maxab == 0.0:\n        # both zero not allowed; but handle defensively\n        return 0.0, 0.5, 0.5\n    rel = abs(a - b) / maxab\n    # Threshold for switching to series limit\n    if rel  1e-10:\n        # L - a (or b), partial derivatives - 1/2, 1/2\n        return a, 0.5, 0.5\n    # General case\n    d = np.log(a / b)\n    n = (a - b)\n    L = n / d\n    dL_da = (d - n / a) / (d * d)\n    dL_db = (-d + n / b) / (d * d)\n    return L, dL_da, dL_db\n\ndef residual_and_jacobian(arrangement: str, U: float, A: float, Ch: float, Cc: float,\n                          Thi: float, Tci: float, Tho: float, Tco: float):\n    \"\"\"\n    Compute residual vector F and Jacobian J for the two-equation system.\n\n    F1 = Ch*(Thi - Tho) - U*A*LMTD\n    F2 = Cc*(Tco - Tci) - U*A*LMTD\n\n    The LMTD depends on the arrangement via the end differences:\n        Parallel:   a = Thi - Tci,             b = Tho - Tco\n        Counter:    a = Thi - Tco,             b = Tho - Tci\n    \"\"\"\n    if arrangement == \"parallel\":\n        a = Thi - Tci\n        b = Tho - Tco\n        L, dL_da, dL_db = log_mean_and_partials(a, b)\n        # Chain rule for partials w.r.t Tho, Tco\n        dL_dTho = dL_db * 1.0\n        dL_dTco = dL_db * (-1.0)\n    elif arrangement == \"counter\":\n        a = Thi - Tco\n        b = Tho - Tci\n        L, dL_da, dL_db = log_mean_and_partials(a, b)\n        dL_dTho = dL_db * 1.0\n        dL_dTco = dL_da * (-1.0)\n    else:\n        raise ValueError(\"Unknown arrangement\")\n    Q = U * A * L\n    F1 = Ch * (Thi - Tho) - Q\n    F2 = Cc * (Tco - Tci) - Q\n    # Jacobian entries\n    UA = U * A\n    J11 = -Ch - UA * dL_dTho\n    J12 = -UA * dL_dTco\n    J21 = -UA * dL_dTho\n    J22 = Cc - UA * dL_dTco\n    J = np.array([[J11, J12],\n                  [J21, J22]], dtype=float)\n    F = np.array([F1, F2], dtype=float)\n    return F, J, a, b, L, Q\n\ndef feasible(arrangement: str, Thi: float, Tci: float, Tho: float, Tco: float, eps: float = 1e-12):\n    \"\"\"\n    Check physical feasibility: positivity of end differences and sensible bounds.\n    \"\"\"\n    if arrangement == \"parallel\":\n        a = Thi - Tci\n        b = Tho - Tco\n        if a = eps or b = eps:\n            return False\n        # Bounds: Tho = Thi, Tco = Tci, and Tho = Tci, Tco = Thi\n        if not (Tci - 1e-9 = Tho = Thi + 1e-9):\n            return False\n        if not (Tci - 1e-9 = Tco = Thi + 1e-9):\n            return False\n        return True\n    elif arrangement == \"counter\":\n        a = Thi - Tco\n        b = Tho - Tci\n        if a = eps or b = eps:\n            return False\n        # Bounds: Tho = Thi, Tco = Tci\n        if not (Tci - 1e-9 = Tho = Thi + 1e-9):\n            return False\n        if not (Tci - 1e-9 = Tco = Thi + 1e-9):\n            return False\n        return True\n    return False\n\ndef newton_solve(arrangement: str, U: float, A: float, Ch: float, Cc: float,\n                 Thi: float, Tci: float,\n                 tol_res: float = 1e-9, tol_step: float = 1e-10, max_iter: int = 50):\n    \"\"\"\n    Solve for Tho and Tco using Newton's method with backtracking line search.\n    \"\"\"\n    # Conservative initial guess via energy capacity and UA caps\n    dT_in = Thi - Tci\n    Q_cap = min(U * A * max(dT_in, 0.0), min(Ch, Cc) * max(dT_in, 0.0))\n    Q0 = 0.5 * Q_cap\n    Tho = Thi - (Q0 / Ch if Ch  0 else 0.0)\n    Tco = Tci + (Q0 / Cc if Cc  0 else 0.0)\n\n    # Ensure initial feasibility by slight damping if needed\n    alpha_try = 1.0\n    for _ in range(20):\n        if feasible(arrangement, Thi, Tci, Tho, Tco):\n            break\n        alpha_try *= 0.5\n        Tho = Thi - alpha_try * (Q0 / Ch if Ch  0 else 0.0)\n        Tco = Tci + alpha_try * (Q0 / Cc if Cc  0 else 0.0)\n\n    # Newton iterations\n    for _iter in range(max_iter):\n        F, J, a, b, L, Q = residual_and_jacobian(arrangement, U, A, Ch, Cc, Thi, Tci, Tho, Tco)\n        normF = np.linalg.norm(F, ord=2)\n        if normF = tol_res:\n            return Tho, Tco\n        # Solve linear system for Newton step\n        try:\n            step = np.linalg.solve(J, -F)\n        except np.linalg.LinAlgError:\n            # Regularize by adding small diagonal if singular\n            J_reg = J + 1e-12 * np.eye(2)\n            step = np.linalg.solve(J_reg, -F)\n        step_norm = np.linalg.norm(step, ord=2)\n        if step_norm = tol_step:\n            return Tho, Tco\n        # Backtracking line search with feasibility enforcement\n        alpha = 1.0\n        Tho_new = Tho + alpha * step[0]\n        Tco_new = Tco + alpha * step[1]\n        # Enforce bounds by shrinking alpha until feasible and residual decreases\n        # Sufficient decrease parameter\n        c1 = 1e-4\n        # Current merit function\n        phi = 0.5 * normF * normF\n        success = False\n        for _ls in range(60):\n            if feasible(arrangement, Thi, Tci, Tho_new, Tco_new):\n                F_new, _, _, _, _, _ = residual_and_jacobian(arrangement, U, A, Ch, Cc, Thi, Tci, Tho_new, Tco_new)\n                phi_new = 0.5 * np.dot(F_new, F_new)\n                if phi_new = phi - c1 * alpha * np.dot(step, step):\n                    success = True\n                    break\n            alpha *= 0.5\n            Tho_new = Tho + alpha * step[0]\n            Tco_new = Tco + alpha * step[1]\n            if alpha  1e-12:\n                break\n        if not success:\n            # As a fallback, accept the best feasible found if any, else break\n            if feasible(arrangement, Thi, Tci, Tho_new, Tco_new):\n                Tho, Tco = Tho_new, Tco_new\n                continue\n            else:\n                break\n        Tho, Tco = Tho_new, Tco_new\n    # If did not converge, return current iterate (should not occur for provided tests)\n    return Tho, Tco\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (arrangement, U, A, Ch, Cc, Thi, Tci)\n    test_cases = [\n        (\"parallel\", 400.0, 20.0, 5000.0, 8000.0, 120.0, 20.0),\n        (\"counter\", 300.0, 30.0, 6000.0, 6000.0, 150.0, 50.0),\n        (\"parallel\", 50.0, 0.5, 4000.0, 6000.0, 90.0, 30.0),\n        (\"counter\", 1000.0, 100.0, 2000.0, 6000.0, 200.0, 40.0),\n        (\"parallel\", 150.0, 10.0, 5000.0, 5000.0, 170.0, 70.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        arrangement, U, A, Ch, Cc, Thi, Tci = case\n        Tho, Tco = newton_solve(arrangement, U, A, Ch, Cc, Thi, Tci)\n        # Round to six decimals\n        Tho_r = f\"{Tho:.6f}\"\n        Tco_r = f\"{Tco:.6f}\"\n        results.append(f\"[{Tho_r},{Tco_r}]\")\n\n    # Final print statement in the exact required format (no extra spaces).\n    print(f\"[[{results[0][1:-1]}],[{results[1][1:-1]}],[{results[2][1:-1]}],[{results[3][1:-1]}],[{results[4][1:-1]}]]\")\n\nsolve()\n```", "id": "2501348"}]}