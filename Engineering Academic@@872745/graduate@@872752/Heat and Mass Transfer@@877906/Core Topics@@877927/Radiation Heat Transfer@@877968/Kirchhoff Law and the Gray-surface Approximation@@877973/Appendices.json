{"hands_on_practices": [{"introduction": "The classic scenario of two parallel plates forms a cornerstone of radiation analysis, providing a clear context for applying the radiosity-irradiation method. This exercise involves deriving the net heat flux for this gray-diffuse enclosure from first principles and then linearizing the result for small temperature differences to find an effective radiative conductance. This practice solidifies the fundamental network analogy and introduces the concept of a radiation heat transfer coefficient, a powerful tool for simplifying thermal models.", "problem": "Two very large, parallel, opaque, diffuse-gray plates of equal area are separated by a vacuum gap and view only each other. Plate 1 has emissivity $\\epsilon_{1}$ and temperature $T_{1}=T_{0}+\\Delta T$, while Plate 2 has emissivity $\\epsilon_{2}$ and temperature $T_{2}=T_{0}-\\Delta T$, with $|\\Delta T| \\ll T_{0}$. Conduction and convection are absent; heat transfer occurs only by thermal radiation. Use Kirchhoff’s law of thermal radiation (emissivity equals absorptivity for opaque surfaces) and the gray-surface approximation (spectrally independent emissivity) together with the Stefan–Boltzmann law and the radiosity–irradiation formulation to:\n- derive from first principles the exact net radiative heat flux per unit area $q''$ between the plates, and\n- perform a first-order linearization about $T_{0}$ to write $q'' \\approx g_{\\mathrm{rad}}(T_{1}-T_{2})$.\n\nCompute the closed-form expression for the effective radiative conductance per unit area $g_{\\mathrm{rad}}$ in terms of $\\sigma$, $T_{0}$, $\\epsilon_{1}$, and $\\epsilon_{2}$, where $\\sigma$ is the Stefan–Boltzmann constant. Express $g_{\\mathrm{rad}}$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$. The final answer should be a single symbolic expression (no numerical substitution is required).", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. It is a standard problem in the field of heat and mass transfer, specifically concerning radiation heat exchange between two surfaces. We shall proceed with the derivation.\n\nThe analysis begins with the radiosity-irradiation formulation for opaque, diffuse-gray surfaces. The radiosity, $J$, of a surface is the total radiative flux per unit area leaving the surface, which is the sum of its emitted and reflected flux. For a surface $i$, this is expressed as:\n$$J_{i} = E_{i} + \\rho_{i} G_{i}$$\nwhere $E_{i}$ is the emissive power, $\\rho_{i}$ is the reflectivity, and $G_{i}$ is the irradiation (incident flux per unit area).\n\nAccording to the Stefan–Boltzmann law, the emissive power of a gray surface is $E_{i} = \\epsilon_{i} \\sigma T_{i}^{4}$, where $\\epsilon_{i}$ is the emissivity, $\\sigma$ is the Stefan–Boltzmann constant, and $T_{i}$ is the absolute temperature.\n\nFor an opaque surface, the sum of absorptivity ($\\alpha_{i}$) and reflectivity ($\\rho_{i}$) is unity: $\\alpha_{i} + \\rho_{i} = 1$. By Kirchhoff's law of thermal radiation, for a surface in thermal equilibrium with its surroundings (which is extendable to non-equilibrium cases for the gray-surface approximation), the absorptivity is equal to the emissivity: $\\alpha_{i} = \\epsilon_{i}$. Therefore, the reflectivity is $\\rho_{i} = 1 - \\epsilon_{i}$.\n\nSubstituting these relations into the radiosity equation, we obtain:\n$$J_{i} = \\epsilon_{i} \\sigma T_{i}^{4} + (1 - \\epsilon_{i}) G_{i}$$\n\nWe can now write the radiosity equations for the two plates, designated as plate $1$ and plate $2$:\n$$J_{1} = \\epsilon_{1} \\sigma T_{1}^{4} + (1 - \\epsilon_{1}) G_{1} \\quad (1)$$\n$$J_{2} = \\epsilon_{2} \\sigma T_{2}^{4} + (1 - \\epsilon_{2}) G_{2} \\quad (2)$$\n\nThe problem states that the plates are \"very large\" and \"parallel,\" and \"view only each other.\" This is an idealization that implies the view factor from plate $1$ to plate $2$ is $F_{12} = 1$, and similarly, $F_{21} = 1$. Consequently, all radiation leaving plate $2$ is intercepted by plate $1$, and vice versa. This means the irradiation on plate $1$ is equal to the radiosity of plate $2$, and the irradiation on plate $2$ is equal to the radiosity of plate $1$:\n$$G_{1} = J_{2}$$\n$$G_{2} = J_{1}$$\n\nSubstituting these relations into equations (1) and (2) yields a system of two linear algebraic equations for the unknown radiosities $J_{1}$ and $J_{2}$:\n$$J_{1} = \\epsilon_{1} \\sigma T_{1}^{4} + (1 - \\epsilon_{1}) J_{2} \\quad (3)$$\n$$J_{2} = \\epsilon_{2} \\sigma T_{2}^{4} + (1 - \\epsilon_{2}) J_{1} \\quad (4)$$\n\nTo solve this system, we can substitute equation (4) into equation (3):\n$$J_{1} = \\epsilon_{1} \\sigma T_{1}^{4} + (1 - \\epsilon_{1}) [\\epsilon_{2} \\sigma T_{2}^{4} + (1 - \\epsilon_{2}) J_{1}]$$\n$$J_{1} = \\epsilon_{1} \\sigma T_{1}^{4} + (1 - \\epsilon_{1})\\epsilon_{2} \\sigma T_{2}^{4} + (1 - \\epsilon_{1})(1 - \\epsilon_{2}) J_{1}$$\n$$J_{1} [1 - (1 - \\epsilon_{1})(1 - \\epsilon_{2})] = \\epsilon_{1} \\sigma T_{1}^{4} + \\epsilon_{2}(1 - \\epsilon_{1}) \\sigma T_{2}^{4}$$\nThe term in the square brackets simplifies as:\n$$1 - (1 - \\epsilon_{1} - \\epsilon_{2} + \\epsilon_{1}\\epsilon_{2}) = \\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}$$\nSo, we can solve for $J_{1}$:\n$$J_{1} = \\frac{\\epsilon_{1} \\sigma T_{1}^{4} + \\epsilon_{2}(1 - \\epsilon_{1}) \\sigma T_{2}^{4}}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}}$$\nBy symmetry, we can find $J_{2}$ by swapping indices $1$ and $2$:\n$$J_{2} = \\frac{\\epsilon_{2} \\sigma T_{2}^{4} + \\epsilon_{1}(1 - \\epsilon_{2}) \\sigma T_{1}^{4}}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}}$$\n\nThe net radiative heat flux per unit area, $q''$, from plate $1$ to plate $2$ is the difference between the radiation leaving plate $1$ (its radiosity $J_{1}$) and the radiation incident upon it (its irradiation $G_{1}$).\n$$q'' = J_{1} - G_{1} = J_{1} - J_{2}$$\nSubstituting the expressions for $J_{1}$ and $J_{2}$:\n$$q'' = \\frac{1}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}} \\left[ (\\epsilon_{1} \\sigma T_{1}^{4} + \\epsilon_{2}(1 - \\epsilon_{1}) \\sigma T_{2}^{4}) - (\\epsilon_{2} \\sigma T_{2}^{4} + \\epsilon_{1}(1 - \\epsilon_{2}) \\sigma T_{1}^{4}) \\right]$$\nExpanding and collecting terms:\n$$q'' = \\frac{\\sigma}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}} [ \\epsilon_{1} T_{1}^{4} + \\epsilon_{2} T_{2}^{4} - \\epsilon_{1}\\epsilon_{2}T_{2}^{4} - \\epsilon_{2} T_{2}^{4} - \\epsilon_{1} T_{1}^{4} + \\epsilon_{1}\\epsilon_{2}T_{1}^{4} ]$$\n$$q'' = \\frac{\\sigma}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}} [ \\epsilon_{1}\\epsilon_{2}T_{1}^{4} - \\epsilon_{1}\\epsilon_{2}T_{2}^{4} ]$$\n$$q'' = \\frac{\\epsilon_{1}\\epsilon_{2} \\sigma (T_{1}^{4} - T_{2}^{4})}{\\epsilon_{1} + \\epsilon_{2} - \\epsilon_{1}\\epsilon_{2}}$$\nDividing the numerator and denominator by $\\epsilon_{1}\\epsilon_{2}$ yields the familiar form based on the thermal resistance analogy:\n$$q'' = \\frac{\\sigma (T_{1}^{4} - T_{2}^{4})}{\\frac{1}{\\epsilon_{1}} + \\frac{1}{\\epsilon_{2}} - 1}$$\nThis is the exact expression for the net radiative heat flux per unit area between the two plates.\n\nThe next step is to linearize this expression for a small temperature difference. We are given $T_{1} = T_{0} + \\Delta T$ and $T_{2} = T_{0} - \\Delta T$, with the condition $|\\Delta T| \\ll T_{0}$. We need to approximate the term $T_{1}^{4} - T_{2}^{4}$. Let us consider the function $f(T) = T^{4}$. A first-order Taylor series expansion about $T_{0}$ is $f(T) \\approx f(T_{0}) + f'(T_{0})(T - T_{0})$. The derivative is $f'(T) = 4T^{3}$.\nThus,\n$$T_{1}^{4} \\approx T_{0}^{4} + 4T_{0}^{3}(T_{1} - T_{0}) = T_{0}^{4} + 4T_{0}^{3}\\Delta T$$\n$$T_{2}^{4} \\approx T_{0}^{4} + 4T_{0}^{3}(T_{2} - T_{0}) = T_{0}^{4} - 4T_{0}^{3}\\Delta T$$\nThe difference is then:\n$$T_{1}^{4} - T_{2}^{4} \\approx (T_{0}^{4} + 4T_{0}^{3}\\Delta T) - (T_{0}^{4} - 4T_{0}^{3}\\Delta T) = 8T_{0}^{3}\\Delta T$$\nThe temperature difference between the plates is $T_{1} - T_{2} = (T_{0} + \\Delta T) - (T_{0} - \\Delta T) = 2\\Delta T$.\nTherefore, we can express the linearized term as:\n$$T_{1}^{4} - T_{2}^{4} \\approx 4T_{0}^{3} (2\\Delta T) = 4T_{0}^{3}(T_{1} - T_{2})$$\nSubstituting this linear approximation into the exact expression for $q''$:\n$$q'' \\approx \\frac{\\sigma \\left[ 4T_{0}^{3}(T_{1} - T_{2}) \\right]}{\\frac{1}{\\epsilon_{1}} + \\frac{1}{\\epsilon_{2}} - 1}$$\nThe problem requires this to be of the form $q'' \\approx g_{\\mathrm{rad}}(T_{1} - T_{2})$. By comparing the two forms, we can identify the effective radiative conductance per unit area, $g_{\\mathrm{rad}}$:\n$$g_{\\mathrm{rad}} = \\frac{4\\sigma T_{0}^{3}}{\\frac{1}{\\epsilon_{1}} + \\frac{1}{\\epsilon_{2}} - 1}$$\nThis is the required closed-form expression for $g_{\\mathrm{rad}}$. It has the correct units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ since $\\sigma$ is in $\\mathrm{W\\,m^{-2}\\,K^{-4}}$ and $T_{0}^{3}$ is in $\\mathrm{K^{3}}$.\nThe expression is in terms of the specified constants $\\sigma$, $T_{0}$, $\\epsilon_{1}$, and $\\epsilon_{2}$.", "answer": "$$\\boxed{\\frac{4\\sigma T_{0}^{3}}{\\frac{1}{\\epsilon_{1}} + \\frac{1}{\\epsilon_{2}} - 1}}$$", "id": "2498932"}, {"introduction": "While the gray-surface approximation is a convenient tool, its limitations are critical to understand, as real material properties often vary significantly with wavelength. This problem demonstrates the potential pitfalls of naively applying this assumption, especially across large temperature differences, by tasking you to compute the true radiative heat loss for a non-gray surface. This exercise [@problem_id:2498839] is crucial for developing engineering judgment and quantifying the significant errors that can arise from oversimplification.", "problem": "A refractory metal tube with oxidizing surface finish is used as a radiant heater inside a large, isothermal, black enclosure. The tube is isothermal at a hot temperature $T_{h} = 1200\\,\\mathrm{K}$ while the enclosure is at $T_{c} = 300\\,\\mathrm{K}$. At room temperature, the tube’s hemispherical emissivity was measured as $\\epsilon_{\\mathrm{RT}} = 0.10$ and a designer treats the surface as gray with $\\epsilon = \\epsilon_{\\mathrm{RT}}$ for all temperatures. In reality, at $T_{h}$ the surface has the following spectral emissivity (due to temperature-induced oxidation): \n$$ \\epsilon_{\\lambda}(T_{h}) = \\begin{cases} 0.25 & \\text{for } \\lambda  1.5\\ \\mu\\mathrm{m} \\\\ 0.80  \\text{for } \\lambda \\ge 1.5\\ \\mu\\mathrm{m} \\end{cases} $$\nStarting from Planck’s law for the blackbody spectral hemispherical emissive power and Kirchhoff’s law of thermal radiation, formulate the exact expression for the net radiative heat loss per unit area from the tube to the enclosure without assuming grayness. Then, using the definition of hemispherical emissivity as a Planck-weighted average, reduce the expression to a form that makes clear how the gray-surface approximation enters. You are provided the following physically precomputed blackbody band-fraction datum at $T_{h}$: the fraction of a blackbody’s total hemispherical emissive power emitted at wavelengths $\\lambda \\ge 1.5\\ \\mu\\mathrm{m}$ is $f_{h} = 0.80$. \n\nAssume the surface is opaque and diffuse, and the enclosure is large, black, and isothermal. For the purpose of computing the design error, you may neglect the enclosure back-radiation term if you justify the approximation quantitatively. Define the ratio\n$$\nR \\equiv \\frac{q_{\\mathrm{pred}}}{q_{\\mathrm{true}}},\n$$\nwhere $q_{\\mathrm{pred}}$ is the net radiative heat loss per unit area predicted by the gray-surface design using $\\epsilon_{\\mathrm{RT}}$ and $q_{\\mathrm{true}}$ is the correct net radiative heat loss per unit area accounting for the given spectral emissivity at $T_{h}$. Compute $R$ as a pure number.\n\nRound your answer to three significant figures. Report $R$ as a dimensionless decimal (no units).", "solution": "The problem statement must first be validated for scientific soundness, completeness, and clarity.\n\nStep 1: Extract Givens\n-   Hot temperature of the tube: $T_{h} = 1200\\,\\mathrm{K}$.\n-   Cold temperature of the enclosure: $T_{c} = 300\\,\\mathrm{K}$.\n-   Hemispherical emissivity of the tube at room temperature: $\\epsilon_{\\mathrm{RT}} = 0.10$.\n-   Designer's assumption: gray surface with $\\epsilon = \\epsilon_{\\mathrm{RT}} = 0.10$.\n-   Spectral hemispherical emissivity of the tube at $T_{h}$:\n    $$ \\epsilon_{\\lambda}(T_{h}) = \\begin{cases} 0.25  \\text{for } \\lambda  1.5\\ \\mu\\mathrm{m} \\\\ 0.80  \\text{for } \\lambda \\ge 1.5\\ \\mu\\mathrm{m} \\end{cases} $$\n-   Blackbody band-fraction datum: The fraction of a blackbody's total hemispherical emissive power emitted at wavelengths $\\lambda \\ge 1.5\\ \\mu\\mathrm{m}$ at temperature $T_h$ is $f_{h} = 0.80$.\n-   Assumptions: The surface is opaque and diffuse. The enclosure is large, black, and isothermal.\n-   Definition of ratio to be computed: $R \\equiv q_{\\mathrm{pred}}/q_{\\mathrm{true}}$. $q_{\\mathrm{pred}}$ is the net radiative heat loss per unit area from the gray-surface model, and $q_{\\mathrm{true}}$ is the correct net radiative heat loss per unit area.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, rooted in the principles of radiative heat transfer, including Planck's law and Kirchhoff's law. The physical situation described—a hot object in a large, cold enclosure—is a standard configuration in heat transfer analysis. The provided data, such as temperatures and emissivity values, are physically realistic for a refractory metal with an oxidized surface. The spectral emissivity is given as a step function, which is a common and valid simplification for modeling real, non-gray surfaces in engineering calculations. The problem is well-posed, providing all necessary information to calculate the requested ratio, $R$. The language is objective and precise. The problem is not trivial, as it requires a correct application of the definitions of total and spectral properties, distinguishing between emissivity and absorptivity for a non-gray surface not in thermal equilibrium with its surroundings.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A complete, reasoned solution will be provided.\n\nThe net radiative heat loss per unit area, $q$, from the tube surface is the difference between the emitted radiation (radiosity, $J$) and the incident radiation (irradiation, $G$). For an opaque, diffuse surface, this is given by $q = E - \\alpha G$.\n\nThe tube surface is at a temperature $T_{h}$, so its total hemispherical emissive power is $E = \\epsilon_{h} \\sigma T_{h}^{4}$, where $\\epsilon_{h}$ is the total hemispherical emissivity of the surface at temperature $T_{h}$, and $\\sigma$ is the Stefan-Boltzmann constant.\n\nThe tube is inside a large, black enclosure at temperature $T_{c}$. The irradiation, $G$, on the tube surface is equal to the blackbody emissive power of the enclosure, $G = E_{b,c} = \\sigma T_{c}^{4}$.\n\nThe radiation absorbed by the tube surface is $\\alpha_{h} G = \\alpha_{h} \\sigma T_{c}^{4}$, where $\\alpha_{h}$ is the total hemispherical absorptivity of the surface. This absorptivity is for radiation originating from a source at temperature $T_{c}$ and being absorbed by the surface at temperature $T_{h}$.\n\nTherefore, the true net radiative heat loss per unit area is:\n$$ q_{\\mathrm{true}} = \\epsilon_{h}(T_{h}) \\sigma T_{h}^{4} - \\alpha_{h}(T_{h}, T_{c}) \\sigma T_{c}^{4} $$\n\nThe total hemispherical properties are obtained by integrating the spectral properties over the appropriate blackbody spectrum. The total hemispherical emissivity $\\epsilon_{h}(T_{h})$ is defined by weighting the spectral emissivity $\\epsilon_{\\lambda}(T_{h})$ with the blackbody spectral emissive power, $E_{b,\\lambda}(T_{h})$, at the surface temperature $T_{h}$:\n$$ \\epsilon_{h}(T_{h}) = \\frac{\\int_{0}^{\\infty} \\epsilon_{\\lambda}(T_{h}) E_{b,\\lambda}(T_{h}) d\\lambda}{\\int_{0}^{\\infty} E_{b,\\lambda}(T_{h}) d\\lambda} = \\frac{\\int_{0}^{\\infty} \\epsilon_{\\lambda}(T_{h}) E_{b,\\lambda}(T_{h}) d\\lambda}{\\sigma T_{h}^{4}} $$\nThe total hemispherical absorptivity $\\alpha_{h}(T_{h}, T_{c})$ is defined by weighting the spectral absorptivity $\\alpha_{\\lambda}(T_{h})$ with the spectral emissive power of the incident radiation, which is from a blackbody at $T_{c}$, namely $E_{b,\\lambda}(T_{c})$. Using Kirchhoff's law for a diffuse surface, $\\alpha_{\\lambda}(T_{h}) = \\epsilon_{\\lambda}(T_{h})$, we have:\n$$ \\alpha_{h}(T_{h}, T_{c}) = \\frac{\\int_{0}^{\\infty} \\alpha_{\\lambda}(T_{h}) E_{b,\\lambda}(T_{c}) d\\lambda}{\\int_{0}^{\\infty} E_{b,\\lambda}(T_{c}) d\\lambda} = \\frac{\\int_{0}^{\\infty} \\epsilon_{\\lambda}(T_{h}) E_{b,\\lambda}(T_{c}) d\\lambda}{\\sigma T_{c}^{4}} $$\nCombining these gives the formally exact expression for the net heat loss:\n$$ q_{\\mathrm{true}} = \\int_{0}^{\\infty} \\epsilon_{\\lambda}(T_h) E_{b,\\lambda}(T_h) d\\lambda - \\int_{0}^{\\infty} \\epsilon_{\\lambda}(T_h) E_{b,\\lambda}(T_c) d\\lambda $$\nThe gray-surface approximation assumes $\\epsilon_{\\lambda}$ is constant with wavelength, $\\epsilon_{\\lambda} = \\epsilon$. Under this assumption, $\\epsilon_{h} = \\epsilon$ and $\\alpha_{h} = \\epsilon$. The designer uses $\\epsilon = \\epsilon_{\\mathrm{RT}}$. The predicted heat loss is thus:\n$$ q_{\\mathrm{pred}} = \\epsilon_{\\mathrm{RT}} \\sigma (T_{h}^{4} - T_{c}^{4}) $$\nThis shows how the assumption simplifies the formulation.\n\nNow we compute the terms for $q_{\\mathrm{true}}$.\nThe total hemispherical emissivity at $T_{h} = 1200\\,\\mathrm{K}$ is calculated using the given piecewise $\\epsilon_{\\lambda}(T_h)$ and the blackbody band fraction. Let the cutoff wavelength be $\\lambda_{co} = 1.5\\ \\mu\\mathrm{m}$.\n$$ \\epsilon_{h}(T_{h}) = \\epsilon_{\\lambda,1} \\int_{0}^{\\lambda_{co}} \\frac{E_{b,\\lambda}(T_{h})}{\\sigma T_{h}^{4}} d\\lambda + \\epsilon_{\\lambda,2} \\int_{\\lambda_{co}}^{\\infty} \\frac{E_{b,\\lambda}(T_{h})}{\\sigma T_{h}^{4}} d\\lambda $$\nwhere $\\epsilon_{\\lambda,1}=0.25$ and $\\epsilon_{\\lambda,2}=0.80$. The second integral corresponds to the given fraction $f_{h} = 0.80$. The first integral is thus $1 - f_{h} = 1 - 0.80 = 0.20$.\n$$ \\epsilon_{h}(T_{h}) = (0.25)(1 - f_{h}) + (0.80)(f_{h}) = (0.25)(0.20) + (0.80)(0.80) = 0.05 + 0.64 = 0.69 $$\nThe total hemispherical absorptivity for radiation from $T_{c}=300\\,\\mathrm{K}$ is:\n$$ \\alpha_{h}(T_{h}, T_{c}) = (0.25) F_{0-\\lambda_{co}}(T_{c}) + (0.80) [1 - F_{0-\\lambda_{co}}(T_{c})] $$\nwhere $F_{0-\\lambda_{co}}(T_{c})$ is the fraction of blackbody radiation at $T_c$ emitted in the band $0 \\le \\lambda \\le \\lambda_{co}$. We evaluate the product $\\lambda_{co}T_{c} = (1.5\\ \\mu\\mathrm{m})(300\\ \\mathrm{K}) = 450\\ \\mu\\mathrm{m}\\cdot\\mathrm{K}$. For such a small value of $\\lambda T$, the fraction of emitted energy is negligible. Wien's displacement law, $\\lambda_{\\max}T \\approx 2898\\ \\mu\\mathrm{m}\\cdot\\mathrm{K}$, indicates that the peak of emission for a $300\\ \\mathrm{K}$ blackbody is at $\\lambda_{\\max} \\approx 9.7\\ \\mu\\mathrm{m}$. Almost all energy is emitted at wavelengths much larger than $1.5\\ \\mu\\mathrm{m}$. Thus, we can approximate $F_{0-1.5\\mu\\mathrm{m}}(300\\ \\mathrm{K}) \\approx 0$.\n$$ \\alpha_{h}(T_{h}, T_{c}) \\approx (0.25)(0) + (0.80)(1 - 0) = 0.80 $$\nThe true net heat loss is:\n$$ q_{\\mathrm{true}} = (0.69) \\sigma T_{h}^{4} - (0.80) \\sigma T_{c}^{4} $$\n\nThe contribution of absorbed radiation to the net flux, relative to the emitted radiation, is $\\frac{\\alpha_h T_c^4}{\\epsilon_h T_h^4} = \\frac{0.80}{0.69} (\\frac{300}{1200})^4 \\approx 0.0045$, or about $0.45\\%$. While this term is small, we retain it for maximum accuracy as is befitting a rigorous analysis.\n\nThe predicted net heat loss using the gray-surface model with $\\epsilon=\\epsilon_{\\mathrm{RT}}=0.10$ is:\n$$ q_{\\mathrm{pred}} = (0.10) \\sigma (T_{h}^{4} - T_{c}^{4}) $$\n\nThe ratio $R$ is therefore:\n$$ R = \\frac{q_{\\mathrm{pred}}}{q_{\\mathrm{true}}} = \\frac{0.10 \\sigma (T_{h}^{4} - T_{c}^{4})}{0.69 \\sigma T_{h}^{4} - 0.80 \\sigma T_{c}^{4}} = \\frac{0.10 (T_{h}^{4} - T_{c}^{4})}{0.69 T_{h}^{4} - 0.80 T_{c}^{4}} $$\nSubstituting $T_{h} = 1200\\,\\mathrm{K}$ and $T_{c} = 300\\,\\mathrm{K}$, we note that $T_{h} = 4T_{c}$, so $T_{h}^{4} = (4T_{c})^{4} = 256 T_{c}^{4}$.\n$$ R = \\frac{0.10 (256 T_{c}^{4} - T_{c}^{4})}{0.69 (256 T_{c}^{4}) - 0.80 T_{c}^{4}} $$\nThe term $T_{c}^{4}$ cancels out:\n$$ R = \\frac{0.10 (256 - 1)}{0.69(256) - 0.80} = \\frac{0.10(255)}{176.64 - 0.80} = \\frac{25.5}{175.84} $$\n$$ R \\approx 0.145018198... $$\nRounding to three significant figures, the result is $0.145$. This result demonstrates the significant error introduced by the naive gray-surface approximation, where the predicted heat loss is only about $14.5\\%$ of the true value.", "answer": "$$\\boxed{0.145}$$", "id": "2498839"}, {"introduction": "Moving from idealized models to real-world applications requires handling experimental data, which typically provides spectral emissivity at discrete wavelengths. This practice challenges you to translate the theoretical definition of total hemispherical emissivity into a robust numerical algorithm, integrating tabulated spectral data against the Planck distribution. This computational exercise [@problem_id:2498846] bridges theory and practice, equipping you with the skills to accurately predict the radiative behavior of real, non-gray surfaces.", "problem": "A surface has a measured spectral emissivity, denoted by $\\epsilon_{\\lambda}$, at discrete wavelengths. The goal is to compute the temperature-dependent total hemispherical emissivity $\\epsilon(T)$ using a quadrature scheme that respects Kirchhoff's law and the gray-surface approximation. You must derive, design, and implement a numerically stable and accurate quadrature that is valid over a physically relevant temperature range.\n\nGiven:\n- Kirchhoff's law at thermal equilibrium states that for an opaque surface, the spectral emissivity $\\epsilon_{\\lambda}$ equals the spectral absorptivity $\\alpha_{\\lambda}$.\n- The hemispherical spectral blackbody emissive power per unit wavelength is given by Planck's law,\n  $$E_{b,\\lambda}(T) = \\frac{C_1}{\\lambda^5}\\frac{1}{\\exp\\!\\left(\\frac{C_2}{\\lambda T}\\right)-1},$$\n  where $C_1 = 2\\pi h c^2$ and $C_2 = \\frac{h c}{k_B}$, with $h$ the Planck constant, $c$ the speed of light in vacuum, and $k_B$ the Boltzmann constant.\n- The total hemispherical emissive power of a blackbody is $E_b(T)=\\sigma T^4$, where $\\sigma$ is the Stefan–Boltzmann constant.\n\nDefinitions:\n- The total hemispherical emissivity at temperature $T$, denoted $\\epsilon(T)$, is defined by\n  $$\\epsilon(T)=\\frac{\\int_0^\\infty \\epsilon_{\\lambda}(\\lambda)\\,E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_0^\\infty E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda}.$$\n\nTasks:\n1. Starting from the fundamental laws and definitions stated above, derive a dimensionless integral representation of $\\epsilon(T)$ by introducing a non-dimensional substitution that removes the explicit dependence on $\\lambda$ in the blackbody spectrum and isolates a universal weighting function. Do not assume any shortcut expressions for the resulting integral; derive the result explicitly and identify the temperature dependence clearly.\n2. Justify a quadrature scheme (choice of variable of integration, truncation of the infinite integration domain, and per-interval integration rule) that achieves high accuracy over a broad temperature range. Your justification must include:\n   - A mathematically sound truncation criterion of the semi-infinite domain based on an upper bound for the neglected tail integral expressed as a function of the truncation parameter. Provide this bound as an explicit inequality involving the truncation parameter and a tolerance.\n   - An error-controlled composite Gaussian quadrature on the truncated finite interval, including a refinement criterion that guarantees a specified relative accuracy.\n   - A stable and physically consistent interpolation and extrapolation rule for $\\epsilon_{\\lambda}$ between and beyond the tabulated wavelengths. The extrapolation must be clearly specified and justified.\n3. Implement your quadrature scheme in a program that reads no input and uses the tabulated $\\epsilon_{\\lambda}$ data provided below to compute $\\epsilon(T)$ for each test case. Use the speed of light in vacuum $c$ in $\\mathrm{m/s}$, the Planck constant $h$ in $\\mathrm{J\\cdot s}$, and the Boltzmann constant $k_B$ in $\\mathrm{J/K}$. Wavelengths in the tabulations are given in micrometers and must be converted to meters in computations. Results must be expressed as dimensionless emissivities.\n4. Use piecewise-linear interpolation in wavelength for $\\epsilon_{\\lambda}$ between tabulated points. For $\\lambda$ values outside the tabulated range, use zeroth-order extrapolation (hold the nearest tabulated value constant). This rule must be applied consistently across all test cases.\n5. Test Suite. Use the following three surfaces and temperatures:\n   - Surface $\\mathrm{S1}$ (nominal gray): tabulated pairs $(\\lambda\\, [\\mu\\mathrm{m}], \\epsilon_{\\lambda})$:\n     $$\n     \\{(0.2,0.65),(0.5,0.65),(1,0.65),(2,0.65),(5,0.65),(10,0.65),(15,0.65),(25,0.65)\\}.\n     $$\n   - Surface $\\mathrm{S2}$ (narrow phonon band near $10\\,\\mu\\mathrm{m}$): tabulated pairs $(\\lambda\\, [\\mu\\mathrm{m}], \\epsilon_{\\lambda})$:\n     $$\n     \\{(0.5,0.05),(2,0.05),(8,0.05),(9,0.2),(10,0.9),(11,0.2),(12,0.05),(20,0.05)\\}.\n     $$\n   - Surface $\\mathrm{S3}$ (shortwave-selective coating): tabulated pairs $(\\lambda\\, [\\mu\\mathrm{m}], \\epsilon_{\\lambda})$:\n     $$\n     \\{(0.3,0.9),(0.5,0.9),(1,0.9),(2,0.6),(5,0.2),(10,0.1),(20,0.1)\\}.\n     $$\n   Temperatures $T$ (in Kelvin) to evaluate:\n   $$\n   \\mathrm{S1}:\\ T=300,\\ 3000;\\quad \\mathrm{S2}:\\ T=300,\\ 1000;\\quad \\mathrm{S3}:\\ T=300,\\ 3000.\n   $$\n6. Output specification. Your program must produce a single line containing a list of the computed emissivities in the following order:\n   $$\n   [\\epsilon_{\\mathrm{S1}}(300),\\ \\epsilon_{\\mathrm{S1}}(3000),\\ \\epsilon_{\\mathrm{S2}}(300),\\ \\epsilon_{\\mathrm{S2}}(1000),\\ \\epsilon_{\\mathrm{S3}}(300),\\ \\epsilon_{\\mathrm{S3}}(3000)].\n   $$\n   Each value must be rounded to exactly six decimal places. The output must be a single line with a comma-separated Python-style list, for example $[\\dots]$.\n7. Units. Emissivity is dimensionless. Temperatures are in Kelvin. Wavelengths in the tabulated data are in micrometers but must be converted to meters internally. If any angles are used, they must be in radians; however, no angular integrals are required in this task.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5,r_6]$).", "solution": "The supplied problem is subjected to rigorous validation.\n\n### Step 1: Extract Givens\n\n- **Fundamental Law**: Kirchhoff's law of thermal radiation: $\\epsilon_{\\lambda} = \\alpha_{\\lambda}$ for an opaque surface at thermal equilibrium.\n- **Blackbody Spectral Emissive Power**: Planck's law: $E_{b,\\lambda}(T) = \\frac{C_1}{\\lambda^5}\\frac{1}{\\exp\\!\\left(\\frac{C_2}{\\lambda T}\\right)-1}$, with $C_1 = 2\\pi h c^2$ and $C_2 = \\frac{h c}{k_B}$.\n- **Blackbody Total Emissive Power**: Stefan-Boltzmann law: $E_b(T) = \\int_0^\\infty E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda = \\sigma T^4$.\n- **Definition of Total Hemispherical Emissivity**: $\\epsilon(T)=\\frac{\\int_0^\\infty \\epsilon_{\\lambda}(\\lambda)\\,E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_0^\\infty E_{b,\\lambda}(T)\\,\\mathrm{d}\\lambda}$.\n- **Numerical Rules**: Use piecewise-linear interpolation for $\\epsilon_{\\lambda}$ between tabulated data points and zeroth-order extrapolation (constant value) outside the tabulated range.\n- **Data for Surface S1** ($\\lambda$ in $\\mu\\mathrm{m}$): $\\{(0.2,0.65),(0.5,0.65),(1,0.65),(2,0.65),(5,0.65),(10,0.65),(15,0.65),(25,0.65)\\}$.\n- **Data for Surface S2** ($\\lambda$ in $\\mu\\mathrm{m}$): $\\{(0.5,0.05),(2,0.05),(8,0.05),(9,0.2),(10,0.9),(11,0.2),(12,0.05),(20,0.05)\\}$.\n- **Data for Surface S3** ($\\lambda$ in $\\mu\\mathrm{m}$): $\\{(0.3,0.9),(0.5,0.9),(1,0.9),(2,0.6),(5,0.2),(10,0.1),(20,0.1)\\}$.\n- **Temperatures for Evaluation**: S1 at $T=300, 3000$ K; S2 at $T=300, 1000$ K; S3 at $T=300, 3000$ K.\n- **Constants**: Use standard values for $h$, $c$, $k_B$.\n- **Output**: A single line with a list of six emissivity values, rounded to six decimal places.\n\n### Step 2: Validate Using Extracted Givens\n\nThe problem is analyzed against the validation criteria.\n\n- **Scientifically Grounded**: The problem is based on the fundamental principles of radiative heat transfer, namely Planck's law and the definition of total emissivity. The provided data for spectral emissivity $\\epsilon_{\\lambda}$ is physically realistic, with values between $0$ and $1$. The problem is firmly rooted in established physics.\n- **Well-Posed**: All necessary information is provided. The governing equations, boundary conditions (in the form of tabulated data), numerical constraints (interpolation/extrapolation rules), and parameters (temperatures) are specified. This structure permits the existence of a unique and meaningful solution.\n- **Objective**: The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n\nThe problem does not exhibit any of the enumerated invalidity flaws. It is a standard, well-defined computational physics problem that requires both theoretical derivation and numerical implementation.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution\n\nThe objective is to compute the temperature-dependent total hemispherical emissivity $\\epsilon(T)$ from tabulated spectral emissivity data $\\epsilon_{\\lambda}(\\lambda)$. This requires a multi-step process involving theoretical derivation, numerical scheme design, and implementation.\n\n**1. Derivation of a Dimensionless Integral Representation**\n\nThe total hemispherical emissivity is defined as the ratio of the total emissive power of the surface, $E(T)$, to that of a blackbody at the same temperature, $E_b(T)$:\n$$\n\\epsilon(T) = \\frac{E(T)}{E_b(T)} = \\frac{\\int_0^\\infty \\epsilon_{\\lambda}(\\lambda) E_{b,\\lambda}(T) \\mathrm{d}\\lambda}{\\int_0^\\infty E_{b,\\lambda}(T) \\mathrm{d}\\lambda}\n$$\nThe numerator is evaluated by substituting Planck's law for $E_{b,\\lambda}(T) = \\frac{C_1}{\\lambda^5 (\\exp(C_2/\\lambda T) - 1)}$:\n$$\nE(T) = \\int_0^\\infty \\epsilon_{\\lambda}(\\lambda) \\frac{C_1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{C_2}{\\lambda T}\\right) - 1} \\mathrm{d}\\lambda\n$$\nTo create a dimensionless representation and a universal weighting function, we introduce the dimensionless variable $x = \\frac{C_2}{\\lambda T}$. From this substitution, we derive expressions for $\\lambda$ and $\\mathrm{d}\\lambda$:\n$$\n\\lambda = \\frac{C_2}{xT} \\implies \\mathrm{d}\\lambda = -\\frac{C_2}{x^2 T} \\mathrm{d}x\n$$\nThe limits of integration transform as follows: as $\\lambda \\to 0^+$, $x \\to \\infty$; as $\\lambda \\to \\infty$, $x \\to 0^+$. Substituting these into the integral for $E(T)$:\n$$\nE(T) = \\int_\\infty^0 \\epsilon_{\\lambda}\\left(\\frac{C_2}{xT}\\right) \\frac{C_1}{\\left(\\frac{C_2}{xT}\\right)^5} \\frac{1}{\\exp(x) - 1} \\left(-\\frac{C_2}{x^2 T} \\mathrm{d}x\\right)\n$$\nThe negative sign in the differential element reverses the integration limits. Simplifying the expression:\n$$\nE(T) = C_1 \\int_0^\\infty \\epsilon_{\\lambda}\\left(\\frac{C_2}{xT}\\right) \\frac{(xT)^5}{C_2^5} \\frac{1}{\\exp(x) - 1} \\frac{C_2}{x^2 T} \\mathrm{d}x\n$$\n$$\nE(T) = \\frac{C_1 T^4}{C_2^4} \\int_0^\\infty \\epsilon_{\\lambda}\\left(\\frac{C_2}{xT}\\right) \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x\n$$\nTo find $\\epsilon(T)$, we divide by the total blackbody emissive power, $E_b(T) = \\sigma T^4$:\n$$\n\\epsilon(T) = \\frac{E(T)}{\\sigma T^4} = \\frac{C_1}{\\sigma C_2^4} \\int_0^\\infty \\epsilon_{\\lambda}\\left(\\frac{C_2}{xT}\\right) \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x\n$$\nThe pre-factor $\\frac{C_1}{\\sigma C_2^4}$ is a combination of fundamental constants. Its value can be determined from the condition that for a blackbody, $\\epsilon_{\\lambda}=1$ and thus $\\epsilon(T)=1$. This implies that a universal normalization constant must exist. Using the definitions $C_1 = 2\\pi h c^2$, $C_2 = hc/k_B$, and $\\sigma = \\frac{2\\pi^5 k_B^4}{15 c^2 h^3}$:\n$$\n\\frac{C_1}{\\sigma C_2^4} = \\frac{2\\pi h c^2}{\\left(\\frac{2\\pi^5 k_B^4}{15 c^2 h^3}\\right) \\left(\\frac{h c}{k_B}\\right)^4} = \\frac{2\\pi h c^2 \\cdot 15 c^2 h^3}{2\\pi^5 k_B^4 \\cdot h^4 c^4 / k_B^4} = \\frac{15}{\\pi^4}\n$$\nThe value of the definite integral for a blackbody is $\\int_0^\\infty \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x = \\frac{\\pi^4}{15}$. Thus, $(\\frac{15}{\\pi^4}) (\\frac{\\pi^4}{15}) = 1$, confirming consistency.\nThe final dimensionless integral representation for the total hemispherical emissivity is:\n$$\n\\epsilon(T) = \\frac{15}{\\pi^4} \\int_0^\\infty \\epsilon_{\\lambda}\\left(\\lambda = \\frac{C_2}{xT}\\right) \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x\n$$\nHere, $\\frac{x^3}{\\exp(x) - 1}$ is a universal weighting function, and the temperature dependence is isolated within the argument of the spectral emissivity function $\\epsilon_{\\lambda}$.\n\n**2. Justification of Quadrature Scheme**\n\nA robust numerical quadrature scheme must be designed to evaluate the derived integral.\n\n- **Variable of Integration**: The change of variables to $x = C_2/(\\lambda T)$ is numerically advantageous. It transforms the problem into an integration over a fixed, universal weighting function that peaks near $x \\approx 2.82$ and decays exponentially. This simplifies error control compared to integrating over $\\lambda$, where the peak of Planck's function shifts with temperature.\n\n- **Truncation of Integration Domain**: The integral is over the semi-infinite domain $[0, \\infty)$. The integrand is zero at $x=0$ (since $\\lim_{x\\to 0} x^3/(e^x-1) = x^2 = 0$) and decays exponentially as $x\\to\\infty$. We must truncate the domain to a finite interval $[0, x_{max}]$. The truncation error arises from neglecting the tail integral. As $\\epsilon_{\\lambda} \\le 1$, the relative error is bounded by:\n$$\n\\text{Error}_{\\text{rel}} \\le \\frac{\\frac{15}{\\pi^4} \\int_{x_{max}}^\\infty \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x}{\\frac{15}{\\pi^4} \\int_0^\\infty \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x} = \\frac{\\int_{x_{max}}^\\infty \\frac{x^3}{\\exp(x) - 1} \\mathrm{d}x}{\\pi^4/15}\n$$\nFor large $x$, $\\exp(x) - 1 \\approx \\exp(x)$. The tail integral can be approximated by $\\int_{x_{max}}^\\infty x^3 e^{-x} \\mathrm{d}x$. This integral is related to the incomplete gamma function and evaluates to $(x_{max}^3 + 3x_{max}^2 + 6x_{max} + 6)e^{-x_{max}}$. To ensure this error is negligible (e.g., less than a tolerance $\\delta = 10^{-10}$), we select a sufficiently large $x_{max}$. For $x_{max}=30$, the relative error is on the order of $10^{-11}$. A choice of $x_{max}=40$ provides an even larger safety margin, with a relative error below $10^{-14}$, which is more than adequate for achieving six decimal places of precision in the final result.\n\n- **Per-Interval Integration Rule**: The function $\\epsilon_{\\lambda}(\\lambda)$ is specified as piecewise-linear in $\\lambda$. This means its derivative is discontinuous at the tabulated wavelengths $\\lambda_k$. When transformed to the $x$ domain, these points become $x_k(T) = C_2/(\\lambda_k T)$. To maintain accuracy, the integration domain $[0, x_{max}]$ must be partitioned at these breakpoints. A composite quadrature rule is required. A high-quality adaptive quadrature routine, such as the Gauss-Kronrod algorithm implemented in `scipy.integrate.quad`, is an excellent choice. By providing the breakpoints explicitly, the algorithm can treat each subinterval independently, applying its adaptive strategy to achieve a user-specified relative and absolute error tolerance. A relative tolerance of $10^{-9}$ will ensure the numerical integration error itself is insignificant.\n\n- **Interpolation and Extrapolation**: As specified, piecewise-linear interpolation will be used for $\\epsilon_{\\lambda}$ between tabulated wavelengths. This method is implemented efficiently using `numpy.interp`. For wavelengths outside the tabulated range $[\\lambda_{min}, \\lambda_{max}]$, zeroth-order extrapolation is required, meaning $\\epsilon_{\\lambda}(\\lambda) = \\epsilon_{\\lambda}(\\lambda_{min})$ for $\\lambda  \\lambda_{min}$ and $\\epsilon_{\\lambda}(\\lambda) = \\epsilon_{\\lambda}(\\lambda_{max})$ for $\\lambda  \\lambda_{max}$. The `numpy.interp` function naturally implements this behavior. This rule, while simple, is physically justified as a first-order approximation when the integration is dominated by wavelengths within the tabulated range.\n\n**3. Implementation and Final Calculation**\n\nThe derived formula and justified numerical scheme are implemented in Python. The program computes $\\epsilon(T)$ for each of the six specified test cases. The surface `S1` represents a gray body, for which the total emissivity $\\epsilon(T)$ must be constant and equal to $0.65$. This provides a validation case for the numerical implementation. For surfaces `S2` and `S3`, the spectral variations will lead to a temperature-dependent total emissivity, which the code must accurately capture. The final results are collected and formatted as specified.", "answer": "```python\n# The complete and runnable Python 3 code.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the total hemispherical emissivity for given surfaces and temperatures.\n    \"\"\"\n\n    # --- Physical Constants (CODATA 2018) ---\n    H = 6.62607015e-34    # Planck constant (J.s)\n    C = 299792458         # Speed of light in vacuum (m/s)\n    K_B = 1.380649e-23      # Boltzmann constant (J/K)\n\n    # --- Derived Constants ---\n    # C2 from Planck's law\n    C2 = H * C / K_B  # (m.K)\n    # Prefactor for the dimensionless integral\n    PREFACTOR = 15 / (np.pi**4)\n\n    # --- Test Case Data ---\n    s1_data_um = [\n        (0.2, 0.65), (0.5, 0.65), (1, 0.65), (2, 0.65), (5, 0.65), \n        (10, 0.65), (15, 0.65), (25, 0.65)\n    ]\n    s2_data_um = [\n        (0.5, 0.05), (2, 0.05), (8, 0.05), (9, 0.2), (10, 0.9), \n        (11, 0.2), (12, 0.05), (20, 0.05)\n    ]\n    s3_data_um = [\n        (0.3, 0.9), (0.5, 0.9), (1, 0.9), (2, 0.6), (5, 0.2), \n        (10, 0.1), (20, 0.1)\n    ]\n\n    test_cases = [\n        {'surface_name': 'S1', 'data_um': s1_data_um, 'temp': 300},\n        {'surface_name': 'S1', 'data_um': s1_data_um, 'temp': 3000},\n        {'surface_name': 'S2', 'data_um': s2_data_um, 'temp': 300},\n        {'surface_name': 'S2', 'data_um': s2_data_um, 'temp': 1000},\n        {'surface_name': 'S3', 'data_um': s3_data_um, 'temp': 300},\n        {'surface_name': 'S3', 'data_um': s3_data_um, 'temp': 3000},\n    ]\n\n    # --- Core Functions ---\n\n    def get_epsilon_interpolator(surface_data_um):\n        \"\"\"\n        Creates an interpolator function for spectral emissivity.\n        Uses piecewise-linear interpolation and zeroth-order extrapolation.\n        \"\"\"\n        lmbda_um, eps_vals = zip(*surface_data_um)\n        # Convert wavelengths to meters for internal calculations\n        lmbda_m = np.array(lmbda_um) * 1e-6\n        eps_vals_arr = np.array(eps_vals)\n        \n        def epsilon_lambda_func(lmbda):\n            # np.interp handles piecewise-linear interpolation and\n            # zeroth-order extrapolation by default.\n            return np.interp(lmbda, lmbda_m, eps_vals_arr)\n        \n        return epsilon_lambda_func, lmbda_m\n\n    def integrand(x, T, epsilon_lambda_func):\n        \"\"\"\n        The dimensionless integrand for total emissivity calculation.\n        \"\"\"\n        # x = C2 / (lambda * T)\n        # Handle the case x=0, where the integrand is 0.\n        if x == 0:\n            return 0.0\n        \n        # Calculate wavelength lambda from x and T\n        lmbda = C2 / (x * T)\n        \n        # Get spectral emissivity at this wavelength\n        eps_val = epsilon_lambda_func(lmbda)\n        \n        # Universal weighting function part.\n        # np.expm1(x) = exp(x) - 1, which is more accurate for small x.\n        weight_func = x**3 / np.expm1(x) if x > 1e-8 else x**2\n        \n        return eps_val * weight_func\n\n    # --- Main Calculation Loop ---\n    results = []\n    for case in test_cases:\n        T = case['temp']\n        surface_data_um = case['data_um']\n        \n        # Create the specific interpolator and get break points in meters\n        epsilon_interpolator, lmbda_m_points = get_epsilon_interpolator(surface_data_um)\n        \n        # Determine breakpoints in the dimensionless x-domain\n        # These are points where the derivative of the integrand is discontinuous\n        breakpoints = C2 / (lmbda_m_points * T)\n\n        # Truncation limit for the semi-infinite integral\n        x_max = 40.0\n\n        # Perform the numerical integration using adaptive quadrature\n        integral_val, _ = quad(\n            integrand,\n            0,\n            x_max,\n            args=(T, epsilon_interpolator),\n            points=sorted(breakpoints),  # Pass breakpoints to the integrator\n            epsrel=1e-9                  # Set a high relative accuracy\n        )\n\n        # Calculate the total hemispherical emissivity\n        total_emissivity = PREFACTOR * integral_val\n        results.append(round(total_emissivity, 6))\n\n    # --- Format and Print Output ---\n    # Format the final output string exactly as specified.\n    output_str = \"[\" + \",\".join([f'{val:.6f}' for val in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2498846"}]}