{"hands_on_practices": [{"introduction": "Understanding numerical stability begins with analyzing the simplest schemes. This practice guides you through a von Neumann stability analysis for the Forward-Time Central-Space (FTCS) scheme applied to the heat equation. By examining how individual Fourier modes of the numerical error evolve, you will derive the famous conditional stability criterion from first principles and calculate a practical upper limit for the time step [@problem_id:2524603].", "problem": "A one-dimensional, homogeneous solid with constant thermal diffusivity $\\alpha$ undergoes transient heat conduction. By conservation of energy and Fourier’s law of heat conduction, the temperature field $T(x,t)$ satisfies the diffusion equation $\\frac{\\partial T}{\\partial t}=\\alpha \\frac{\\partial^2 T}{\\partial x^2}$. Consider a uniform spatial grid with spacing $\\Delta x$ and approximate the equation using the Forward-Time Central-Space (FTCS) finite difference scheme. Using a linear Fourier (von Neumann) stability analysis applied to the fully discrete update, derive from first principles the stability requirement that must hold between $\\Delta t$, $\\Delta x$, and $\\alpha$ for all spatial Fourier modes to be non-amplifying. Then, for $\\alpha=1.4\\times 10^{-7}\\,\\text{m}^2/\\text{s}$ and $\\Delta x=0.5\\,\\text{mm}$, compute the maximum stable time step. Express your final numerical answer in seconds and round to three significant figures.", "solution": "The problem is valid. It is a standard, well-posed problem in numerical analysis for partial differential equations, specifically in the context of heat transfer. All necessary information is provided, and the problem is scientifically sound.\n\nThe governing partial differential equation for one-dimensional transient heat conduction is the diffusion equation:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\nwhere $T(x,t)$ is the temperature, $t$ is time, $x$ is the spatial coordinate, and $\\alpha$ is the constant thermal diffusivity.\n\nWe are asked to analyze the Forward-Time Central-Space (FTCS) finite difference scheme. We discretize the continuous domain into a grid with spatial step size $\\Delta x$ and time step size $\\Delta t$. Let $T_j^n$ denote the numerical approximation of the temperature at spatial node $j$ and time level $n$, i.e., $T_j^n \\approx T(j\\Delta x, n\\Delta t)$.\n\nThe time derivative $\\frac{\\partial T}{\\partial t}$ is approximated using a first-order forward difference:\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{j,n} \\approx \\frac{T_j^{n+1} - T_j^n}{\\Delta t}\n$$\nThe spatial second derivative $\\frac{\\partial^2 T}{\\partial x^2}$ is approximated using a second-order central difference:\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these approximations into the governing equation yields the FTCS scheme:\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} = \\alpha \\frac{T_{j+1}^n - 2T_j^n + T_{j-1}^n}{(\\Delta x)^2}\n$$\nRearranging to solve for the temperature at the next time step, $T_j^{n+1}$, we obtain the explicit update rule:\n$$\nT_j^{n+1} = T_j^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\nLet us define the non-dimensional mesh Fourier number, $r$, as:\n$$\nr = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\nThe update equation simplifies to:\n$$\nT_j^{n+1} = T_j^n + r(T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n\nTo analyze the stability of this linear scheme, we use the von Neumann (or Fourier) stability analysis. We consider the evolution of a single Fourier mode of the numerical solution. The solution at any time level $n$ is represented as a Fourier series. We examine a generic term of this series at a spatial node $j$:\n$$\nT_j^n = A^{(n)}(k) e^{i k x_j} = A^{(n)}(k) e^{i k j \\Delta x}\n$$\nwhere $i = \\sqrt{-1}$, $k$ is the wavenumber of the Fourier mode, and $A^{(n)}(k)$ is the amplitude of that mode at time level $n$. For the scheme to be stable, the amplitude of any Fourier mode must not grow in time. This means the amplification factor, $G(k) = \\frac{A^{(n+1)}(k)}{A^{(n)}(k)}$, must satisfy the condition $|G(k)| \\le 1$ for all possible wavenumbers $k$.\n\nSubstituting the Fourier mode expression into the FTCS update equation:\n$$\nA^{(n+1)} e^{i k j \\Delta x} = A^{(n)} e^{i k j \\Delta x} + r \\left( A^{(n)} e^{i k (j+1) \\Delta x} - 2A^{(n)} e^{i k j \\Delta x} + A^{(n)} e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing the entire equation by $A^{(n)} e^{i k j \\Delta x}$ (which is non-zero) gives the expression for the amplification factor $G = \\frac{A^{(n+1)}}{A^{(n)}}$:\n$$\nG = 1 + r \\left( e^{i k \\Delta x} - 2 + e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we can simplify the expression in the parenthesis:\n$$\ne^{i k \\Delta x} + e^{-i k \\Delta x} - 2 = 2\\cos(k \\Delta x) - 2\n$$\nSo, the amplification factor becomes:\n$$\nG = 1 + 2r(\\cos(k \\Delta x) - 1)\n$$\nWe can use the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$:\n$$\nG = 1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThe von Neumann stability criterion is $|G| \\leq 1$, which is equivalent to $-1 \\leq G \\leq 1$.\n\nSince $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ is positive and $\\sin^2(\\frac{k \\Delta x}{2})$ is always non-negative, the term $4r\\sin^2(\\frac{k \\Delta x}{2})$ is always non-negative. Therefore, $G = 1 - (\\text{a non-negative quantity})$, which implies $G \\le 1$. This part of the condition is always satisfied.\n\nThe crucial part of the stability condition is $G \\ge -1$:\n$$\n1 - 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge r\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThis inequality must hold for all possible wavenumbers $k$. The most restrictive condition (the \"worst case\") occurs when $\\sin^2(\\frac{k \\Delta x}{2})$ reaches its maximum value. The maximum value of the sine squared function is $1$. This occurs for the highest frequency modes the grid can resolve, where $k \\Delta x = \\pi$.\nThus, the stability criterion simplifies to:\n$$\nr \\le \\frac{1}{2}\n$$\nSubstituting back the definition of $r$:\n$$\n\\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}\n$$\nThis is the stability requirement for the FTCS scheme applied to the one-dimensional heat equation.\n\nNow, we compute the maximum stable time step, $\\Delta t_{max}$. From the derived criterion, we have:\n$$\n\\Delta t \\le \\frac{(\\Delta x)^2}{2\\alpha}\n$$\nThe maximum stable time step is the equality limit:\n$$\n\\Delta t_{max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\nThe problem provides the following values:\n$\\alpha = 1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s}$\n$\\Delta x = 0.5\\,\\text{mm}$\n\nFirst, we must ensure consistent units. We convert $\\Delta x$ from millimeters to meters:\n$\\Delta x = 0.5\\,\\text{mm} = 0.5 \\times 10^{-3}\\,\\text{m} = 5 \\times 10^{-4}\\,\\text{m}$.\n\nNow, we substitute the numerical values into the expression for $\\Delta t_{max}$:\n$$\n\\Delta t_{max} = \\frac{(5 \\times 10^{-4}\\,\\text{m})^2}{2 \\times (1.4 \\times 10^{-7}\\,\\text{m}^2/\\text{s})} = \\frac{25 \\times 10^{-8}\\,\\text{m}^2}{2.8 \\times 10^{-7}\\,\\text{m}^2/\\text{s}}\n$$\n$$\n\\Delta t_{max} = \\frac{25}{2.8} \\times 10^{-1}\\,\\text{s} = \\frac{2.5}{2.8}\\,\\text{s} \\approx 0.892857... \\,\\text{s}\n$$\nThe problem requires the answer to be rounded to three significant figures.\n$$\n\\Delta t_{max} \\approx 0.893\\,\\text{s}\n$$\nThis is the maximum time step for which the FTCS scheme is numerically stable for the given parameters.", "answer": "$$\\boxed{0.893}$$", "id": "2524603"}, {"introduction": "While explicit schemes are simple, their conditional stability is restrictive, especially for stiff problems where different physical processes occur on vastly different timescales. This exercise explores implicit methods, which offer unconditional stability, by comparing the Crank-Nicolson and Backward Euler schemes [@problem_id:2524615]. Through analyzing their amplification factors, you will uncover the subtle but critical difference between A-stability and L-stability, and understand why one method is superior for damping high-frequency errors in stiff systems.", "problem": "In transient heat conduction or diffusion, spatial discretization of a linear diffusion operator with homogeneous boundary conditions leads to a decoupled set of modal Ordinary Differential Equations (ODEs) of the form $u_t=-k\\,u$ with $k\\ge 0$, where $k$ is a modal decay rate determined by the spatial eigenvalues. Consider advancing this ODE in time with either the Crank–Nicolson (CN) method or the Backward Euler (BE) method, using a uniform time step $\\Delta t$.\n\nStarting only from the definitions of the time-stepping schemes and the ODE $u_t=-k\\,u$, derive the one-step update in the form $u^{n+1}=G(\\theta)\\,u^n$ where $\\theta=k\\,\\Delta t$ is the dimensionless stiffness parameter, and identify how $G(\\theta)$ behaves as $\\theta$ increases. Use this analysis to reason about whether sign changes (oscillations) can occur and whether highly stiff components are damped. In your reasoning, interpret the magnitude and sign (or phase) of $G(\\theta)$ in relation to numerical damping and oscillations. Also recall the notion of Absolute stability (A-stability), and the property commonly termed L-stability which requires $|G(\\theta)|\\to 0$ as $\\theta\\to\\infty$ for real $\\theta>0$ corresponding to $u_t=-k\\,u$.\n\nWhich option below most accurately captures the outcome of this analysis?\n\nA. For Crank–Nicolson, the amplification factor $G_{\\mathrm{CN}}(\\theta)$ has $|G_{\\mathrm{CN}}(\\theta)|<1$ for all $\\theta>0$ but satisfies $G_{\\mathrm{CN}}(\\theta)\\to -1$ as $\\theta\\to\\infty$, implying step-to-step sign alternation with essentially no damping in the stiff limit (nearly undamped oscillations when $\\theta$ is large). For Backward Euler, $G_{\\mathrm{BE}}(\\theta)=\\dfrac{1}{1+\\theta}$ so $G_{\\mathrm{BE}}(\\theta)\\to 0$ as $\\theta\\to\\infty$, providing strong damping of stiff components; thus Backward Euler is L-stable and avoids these oscillations.\n\nB. Crank–Nicolson is L-stable, so for large $\\theta$ it produces monotone decay without oscillations, whereas Backward Euler is only conditionally stable and may blow up unless $\\theta$ is sufficiently small.\n\nC. Crank–Nicolson produces sign-oscillations only when $\\theta<2$, while for $\\theta>2$ it is monotone and overdamped; thus large $\\theta$ removes oscillations.\n\nD. Both Crank–Nicolson and Backward Euler have $|G(\\theta)|<1$ and $G(\\theta)\\in\\mathbb{R}$ for all $\\theta>0$, but Crank–Nicolson’s $G(\\theta)$ becomes complex for large $\\theta$ which causes oscillations, while Backward Euler’s $G(\\theta)$ remains real and positive; therefore only Crank–Nicolson oscillates because its amplification factor becomes complex at large $\\theta$.", "solution": "The problem statement is to be validated before any solution is attempted.\n\n### Step 1: Extract Givens\n- The governing Ordinary Differential Equation (ODE) is $u_t = -k u$, where $k \\ge 0$.\n- $k$ is a modal decay rate from spatial discretization of a linear diffusion operator.\n- The time-stepping schemes to be analyzed are the Crank–Nicolson (CN) and Backward Euler (BE) methods.\n- The time step is uniform, denoted by $\\Delta t$.\n- The required form for the one-step update is $u^{n+1} = G(\\theta) u^n$, where $\\theta = k \\Delta t$.\n- The task requires analysis of $G(\\theta)$ as $\\theta$ increases, focusing on sign changes (oscillations) and damping of stiff components (large $\\theta$).\n- The magnitude and sign of $G(\\theta)$ must be interpreted in relation to numerical damping and oscillations.\n- The concepts of Absolute stability (A-stability) and L-stability are to be recalled, with L-stability defined for this context by the property $|G(\\theta)| \\to 0$ as $\\theta \\to \\infty$ for real $\\theta > 0$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem utilizes the standard Dahlquist test equation, $u_t = \\lambda u$, with $\\lambda = -k$ where $k \\ge 0$. This is the fundamental model for analyzing the stability of numerical time-integration schemes for parabolic partial differential equations like the heat equation. The Crank–Nicolson and Backward Euler methods are standard, well-defined numerical schemes. The concepts of A-stability and L-stability are cornerstone principles in the analysis of stiff ODEs.\n2.  **Well-Posedness**: The problem asks for a derivation and analysis based on provided definitions. This is a standard analytical exercise in numerical analysis with a unique, verifiable outcome.\n3.  **Completeness**: All necessary information is provided. The definitions of the schemes are standard, and the problem explicitly states to start from these definitions. The parameters $k$, $\\Delta t$, and $\\theta$ are clearly defined.\n4.  **No other flaws detected**: The problem is not unrealistic, ill-posed, trivial, or unverifiable. It is a classic and fundamentally important problem in computational science.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. A solution will be derived.\n\n### Derivation and Analysis\n\nThe model ODE is given by:\n$$\n\\frac{du}{dt} = -k u\n$$\nLet $u^n$ denote the numerical approximation of $u(t_n)$ where $t_n = n \\Delta t$. The numerical schemes approximate the derivative over the interval $[t_n, t_{n+1}]$. The one-step update is of the form $u^{n+1} = G(\\theta) u^n$, where $G(\\theta)$ is the amplification factor and $\\theta = k \\Delta t$.\n\n**1. Crank–Nicolson (CN) Method**\n\nThe CN method is a second-order implicit method that discretizes the ODE by averaging the right-hand side at time levels $n$ and $n+1$:\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = \\frac{1}{2} (-k u^n - k u^{n+1})\n$$\nWe rearrange this equation to solve for $u^{n+1}$ in terms of $u^n$:\n$$\nu^{n+1} - u^n = -\\frac{k \\Delta t}{2} (u^n + u^{n+1})\n$$\n$$\nu^{n+1} + \\frac{k \\Delta t}{2} u^{n+1} = u^n - \\frac{k \\Delta t}{2} u^n\n$$\n$$\nu^{n+1} \\left(1 + \\frac{k \\Delta t}{2}\\right) = u^n \\left(1 - \\frac{k \\Delta t}{2}\\right)\n$$\nSubstituting $\\theta = k \\Delta t$, we find the update rule:\n$$\nu^{n+1} = \\frac{1 - \\theta/2}{1 + \\theta/2} u^n\n$$\nThus, the amplification factor for the Crank–Nicolson method is:\n$$\nG_{\\mathrm{CN}}(\\theta) = \\frac{1 - \\theta/2}{1 + \\theta/2}\n$$\n**Analysis of $G_{\\mathrm{CN}}(\\theta)$:**\n- **Magnitude (Stability):** For any $\\theta > 0$, the denominator is $1 + \\theta/2 > 1$. The magnitude of the numerator is $|1 - \\theta/2|$.\n  - If $0 \\le \\theta \\le 2$, $|1 - \\theta/2| = 1 - \\theta/2$.\n  - If $\\theta > 2$, $|1 - \\theta/2| = \\theta/2 - 1$.\n  In both cases, $|1 - \\theta/2| < 1 + \\theta/2$. Therefore, $|G_{\\mathrm{CN}}(\\theta)| < 1$ for all $\\theta > 0$. This implies the method is A-stable (unconditionally stable), as the magnitude of the amplification factor is always less than one for any positive decay rate $k$ and time step $\\Delta t$.\n- **Sign (Oscillations):** The sign of $G_{\\mathrm{CN}}(\\theta)$ determines whether the solution decays monotonically or with oscillations.\n  - If $0 < \\theta < 2$, $G_{\\mathrm{CN}}(\\theta)$ is positive, so $u^{n+1}$ has the same sign as $u^n$. The decay is monotonic.\n  - If $\\theta > 2$, the numerator $1 - \\theta/2$ is negative, so $G_{\\mathrm{CN}}(\\theta)$ is negative. This means $u^{n+1}$ has the opposite sign of $u^n$, leading to step-to-step sign oscillations.\n- **Stiff Limit (L-stability):** We examine the behavior as $\\theta \\to \\infty$, which corresponds to highly stiff components (large $k$).\n  $$\n  \\lim_{\\theta \\to \\infty} G_{\\mathrm{CN}}(\\theta) = \\lim_{\\theta \\to \\infty} \\frac{1 - \\theta/2}{1 + \\theta/2} = \\lim_{\\theta \\to \\infty} \\frac{1/\\theta - 1/2}{1/\\theta + 1/2} = \\frac{-1/2}{1/2} = -1\n  $$\n  Since $\\lim_{\\theta \\to \\infty} |G_{\\mathrm{CN}}(\\theta)| = |-1| = 1 \\ne 0$, the Crank–Nicolson method is **not** L-stable. In the stiff limit, components are not damped ($|G| \\to 1$) and oscillate with maximum frequency ($G \\to -1$). This is a significant deficiency when solving stiff problems.\n\n**2. Backward Euler (BE) Method**\n\nThe BE method is a first-order fully implicit method that discretizes the ODE using the value at the new time level $n+1$:\n$$\n\\frac{u^{n+1} - u^n}{\\Delta t} = -k u^{n+1}\n$$\nRearranging to solve for $u^{n+1}$:\n$$\nu^{n+1} + k \\Delta t u^{n+1} = u^n\n$$\n$$\nu^{n+1} (1 + k \\Delta t) = u^n\n$$\nUsing $\\theta = k \\Delta t$, the update rule becomes:\n$$\nu^{n+1} = \\frac{1}{1 + \\theta} u^n\n$$\nThe amplification factor for the Backward Euler method is:\n$$\nG_{\\mathrm{BE}}(\\theta) = \\frac{1}{1 + \\theta}\n$$\n**Analysis of $G_{\\mathrm{BE}}(\\theta)$:**\n- **Magnitude (Stability):** Since $k \\ge 0$ and $\\Delta t > 0$, we have $\\theta \\ge 0$. For all $\\theta > 0$, the denominator $1 + \\theta > 1$, which implies $0 < G_{\\mathrm{BE}}(\\theta) < 1$. Therefore, $|G_{\\mathrm{BE}}(\\theta)| < 1$ for all $\\theta > 0$. The method is A-stable.\n- **Sign (Oscillations):** For all $\\theta \\ge 0$, $G_{\\mathrm{BE}}(\\theta)$ is positive. Thus, $u^{n+1}$ always has the same sign as $u^n$. The decay is always monotonic, and there are never numerical oscillations.\n- **Stiff Limit (L-stability):** We examine the behavior as $\\theta \\to \\infty$:\n  $$\n  \\lim_{\\theta \\to \\infty} G_{\\mathrm{BE}}(\\theta) = \\lim_{\\theta \\to \\infty} \\frac{1}{1 + \\theta} = 0\n  $$\n  Since $\\lim_{\\theta \\to \\infty} |G_{\\mathrm{BE}}(\\theta)| = 0$, the Backward Euler method **is** L-stable. Stiff components are strongly damped, which is highly desirable.\n\n### Evaluation of Options\n\n**A. For Crank–Nicolson, the amplification factor $G_{\\mathrm{CN}}(\\theta)$ has $|G_{\\mathrm{CN}}(\\theta)|<1$ for all $\\theta>0$ but satisfies $G_{\\mathrm{CN}}(\\theta)\\to -1$ as $\\theta\\to\\infty$, implying step-to-step sign alternation with essentially no damping in the stiff limit (nearly undamped oscillations when $\\theta$ is large). For Backward Euler, $G_{\\mathrm{BE}}(\\theta)=\\dfrac{1}{1+\\theta}$ so $G_{\\mathrm{BE}}(\\theta)\\to 0$ as $\\theta\\to\\infty$, providing strong damping of stiff components; thus Backward Euler is L-stable and avoids these oscillations.**\n- This statement accurately summarizes the derived results. It correctly identifies that $|G_{\\mathrm{CN}}(\\theta)| < 1$ and $G_{\\mathrm{CN}}(\\theta) \\to -1$ as $\\theta \\to \\infty$, correctly interpreting this as undamped oscillations for stiff components. It correctly gives the formula for $G_{\\mathrm{BE}}(\\theta)$ and its limit as $\\theta \\to \\infty$, correctly identifying this as L-stability and strong damping without oscillations.\n- **Verdict: Correct.**\n\n**B. Crank–Nicolson is L-stable, so for large $\\theta$ it produces monotone decay without oscillations, whereas Backward Euler is only conditionally stable and may blow up unless $\\theta$ is sufficiently small.**\n- This statement is incorrect on multiple counts. Crank–Nicolson is not L-stable, as shown by $\\lim_{\\theta \\to \\infty} G_{\\mathrm{CN}}(\\theta) = -1$. It produces oscillations, not monotone decay, for large $\\theta$ (specifically $\\theta>2$). Backward Euler is not conditionally stable; it is A-stable and L-stable (unconditionally stable for this problem).\n- **Verdict: Incorrect.**\n\n**C. Crank–Nicolson produces sign-oscillations only when $\\theta<2$, while for $\\theta>2$ it is monotone and overdamped; thus large $\\theta$ removes oscillations.**\n- This statement reverses the condition for oscillations. My derivation shows that for $0 < \\theta < 2$, $G_{\\mathrm{CN}}(\\theta)$ is positive, leading to monotonic decay. For $\\theta > 2$, $G_{\\mathrm{CN}}(\\theta)$ is negative, causing oscillations.\n- **Verdict: Incorrect.**\n\n**D. Both Crank–Nicolson and Backward Euler have $|G(\\theta)|<1$ and $G(\\theta)\\in\\mathbb{R}$ for all $\\theta>0$, but Crank–Nicolson’s $G(\\theta)$ becomes complex for large $\\theta$ which causes oscillations, while Backward Euler’s $G(\\theta)$ remains real and positive; therefore only Crank–Nicolson oscillates because its amplification factor becomes complex at large $\\theta$.**\n- This statement contains a critical error. For the given problem where $k$ is real, both $G_{\\mathrm{CN}}(\\theta)$ and $G_{\\mathrm{BE}}(\\theta)$ are always real for any real $\\theta$. The oscillations in the Crank–Nicolson method are caused by $G_{\\mathrm{CN}}(\\theta)$ becoming *negative*, not by it becoming a non-real complex number. While a negative real number can be written in polar form as $re^{i\\pi}$, the claim that it \"becomes complex\" is imprecise and misleading in this context, as it implies it has a non-zero imaginary part, which is false.\n- **Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "2524615"}, {"introduction": "Real-world transport phenomena often involve both advection and diffusion, presenting a greater challenge for numerical modeling. This practice requires you to design and justify a finite difference scheme for the advection-diffusion equation, balancing the competing demands of stability, accuracy, and physical realism (monotonicity) [@problem_id:2524648]. By evaluating different combinations of spatial and temporal discretizations, you will learn to identify robust schemes that prevent non-physical oscillations and understand the accuracy trade-offs inherent in those choices.", "problem": "A one-dimensional advection–diffusion model for temperature (or concentration) in a long slender duct is governed by the conservation balance\n$$\n\\frac{\\partial u}{\\partial t} + v\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\alpha\\,\\frac{\\partial^2 u}{\\partial x^2},\n$$\nwhere $u(x,t)$ is the transported scalar, $v>0$ is a constant advection speed, and $\\alpha>0$ is a constant diffusivity. Consider a uniform grid with spacing $\\Delta x>0$ and a time step $\\Delta t>0$. You are asked to choose a time-integration and spatial-discretization design that, for the given $v$, $\\alpha$, and $\\Delta x$, guarantees both linear stability and monotonicity (no creation of new local extrema for nonnegative initial data), and to correctly justify the corresponding accuracy trade-off.\n\nSelect all options that satisfy both of the following:\n- They provide a choice of $\\Delta t$ and a spatial discretization that guarantee stability and monotonicity for the stated scheme and for all interior nodes, assuming appropriate upwinding with the sign of $v$ and Dirichlet boundary data.\n- They correctly identify the leading-order accuracy trade-off implied by that design.\n\nHere, monotonicity is to be understood in the sense of a discrete maximum principle, and stability in the sense of the Courant–Friedrichs–Lewy (CFL) condition or unconditional stability as appropriate.\n\nOptions:\n- A. Use forward Euler in time, first-order upwind for the advective flux, and second-order central differencing for the diffusive flux. Choose\n$$\n\\Delta t \\;\\le\\; \\frac{1}{\\,\\dfrac{v}{\\Delta x} \\;+\\; \\dfrac{2\\alpha}{\\Delta x^2}\\,}.\n$$\nThis design is linearly stable and monotone. The accuracy is first-order in time, first-order in space for advection (due to upwinding), and second-order in space for diffusion.\n- B. Use forward Euler in time, second-order central differencing for both advection and diffusion. Choose\n$$\n\\Delta t \\;\\le\\; \\frac{1}{\\,\\dfrac{2\\alpha}{\\Delta x^2}\\,}.\n$$\nThis design is linearly stable and monotone for any $v$. The accuracy is second-order in space and first-order in time.\n- C. Use backward Euler in time, first-order upwind for the advective flux, and second-order central differencing for the diffusive flux. Take any $\\Delta t>0$. This design is unconditionally stable and monotone due to the $M$-matrix structure of the linear system. The accuracy is first-order in time, first-order in space for advection, and second-order in space for diffusion.\n- D. Use Crank–Nicolson in time and second-order central differencing for both advection and diffusion. Take any $\\Delta t>0$. This design is unconditionally stable and monotone. The accuracy is second-order in time and space.\n- E. Use forward Euler in time, first-order upwind for the advective flux, and second-order central differencing for the diffusive flux. Choose\n$$\n\\Delta t \\;\\le\\; \\min\\!\\Big\\{\\,\\frac{\\Delta x}{v},\\,\\frac{\\Delta x^2}{2\\alpha}\\,\\Big\\}.\n$$\nThis design is linearly stable and monotone. The accuracy is first-order in time, first-order in space for advection, and second-order in space for diffusion.\n\nSelect all that apply.", "solution": "The problem statement requires critical validation before any attempt at a solution is made.\n\n### Step 1: Extract Givens\n- **Governing Equation:** The one-dimensional linear advection–diffusion equation is given as\n$$\n\\frac{\\partial u}{\\partial t} + v\\,\\frac{\\partial u}{\\partial x} \\;=\\; \\alpha\\,\\frac{\\partial^2 u}{\\partial x^2}\n$$\n- **Parameters:** $v>0$ is a constant advection speed. $\\alpha>0$ is a constant diffusivity.\n- **Discretization:** The grid is uniform with spacing $\\Delta x > 0$ and time step $\\Delta t > 0$.\n- **Conditions for a valid scheme:** The scheme must guarantee both linear stability (in the sense of the CFL condition or unconditional stability) and monotonicity (in the sense of the discrete maximum principle, i.e., no new extrema are created). This guarantee must hold for given constants $v, \\alpha, \\Delta x$.\n- **Requirement for options:** Each selected option must provide a correct combination of a numerical scheme, a valid condition on $\\Delta t$ to ensure stability and monotonicity, and a correct statement of the leading-order accuracy.\n\n### Step 2: Validate Using Extracted Givens\nThe problem presented is a standard, fundamental problem in the field of numerical methods for partial differential equations, specifically in computational heat transfer and fluid dynamics.\n1.  **Scientific Grounding:** The governing equation is a cornerstone of transport phenomena. The concepts of stability, monotonicity, Courant–Friedrichs–Lewy (CFL) condition, and order of accuracy are all rigorously defined mathematical properties of numerical schemes. The problem is firmly grounded in established scientific and mathematical principles.\n2.  **Well-Posedness and Objectivity:** The problem is clearly stated, with all terms defined. It asks for an analysis of several standard finite difference schemes against objective criteria (stability, monotonicity, accuracy). It is well-posed and allows for a unique, verifiable analysis of each option.\n3.  **Completeness:** The problem provides all necessary information to analyze the schemes. The definition of parameters as positive constants ($v>0, \\alpha>0$) is physically meaningful and mathematically convenient. The mention of \"appropriate upwinding\" and Dirichlet data provides necessary context.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a standard exercise in the analysis of finite difference methods. I will now proceed with the derivation of the solution by analyzing each option.\n\nLet $u_j^n$ denote the numerical approximation of $u(j\\Delta x, n\\Delta t)$. We define the Courant number $C = \\frac{v\\Delta t}{\\Delta x}$ and the diffusion number $d = \\frac{\\alpha\\Delta t}{\\Delta x^2}$. The analysis of monotonicity for an explicit scheme of the form $u_j^{n+1} = \\sum_k c_k u_{j-k}^n$ requires that all coefficients $c_k$ be non-negative. For an implicit scheme $A\\mathbf{u}^{n+1} = B\\mathbf{u}^n$, monotonicity is typically ensured if the matrix $A^{-1}B$ is positive (has all non-negative entries).\n\n**Analysis of Option A**\nThe scheme uses forward Euler (FTCS) in time, first-order upwind for advection ($v>0$ implies backward difference), and second-order central for diffusion. The discretized equation is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\nRearranging for $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n - \\frac{v\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) + \\frac{\\alpha\\Delta t}{\\Delta x^2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nIn terms of $C$ and $d$:\n$$\nu_j^{n+1} = (1 - C - 2d)u_j^n + (C+d)u_{j-1}^n + d u_{j+1}^n\n$$\nFor monotonicity, the coefficients of the terms on the right-hand side must be non-negative.\n1.  $d = \\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge 0$. This is true since $\\alpha, \\Delta t, \\Delta x$ are positive.\n2.  $C+d = \\frac{v\\Delta t}{\\Delta x} + \\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge 0$. This is true since $v, \\alpha, \\Delta t, \\Delta x$ are positive.\n3.  $1 - C - 2d \\ge 0 \\implies C + 2d \\le 1$.\nSubstituting the definitions of $C$ and $d$:\n$$\n\\frac{v\\Delta t}{\\Delta x} + \\frac{2\\alpha\\Delta t}{\\Delta x^2} \\le 1 \\implies \\Delta t \\left( \\frac{v}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2} \\right) \\le 1\n$$\n$$\n\\Delta t \\le \\frac{1}{\\frac{v}{\\Delta x} + \\frac{2\\alpha}{\\Delta x^2}}\n$$\nThis condition matches the one given in the option. This condition is also sufficient for stability (von Neumann analysis confirms that $|G| \\le 1$ under this condition).\nThe accuracy is determined by the truncation error. Forward Euler is $O(\\Delta t)$, first-order upwinding is $O(\\Delta x)$, and second-order central differencing is $O(\\Delta x^2)$. The lowest order terms dominate, so the scheme is overall first-order in time and space. The description of accuracy is correct.\nVerdict on Option A: **Correct**.\n\n**Analysis of Option B**\nThe scheme uses forward Euler in time and second-order central differencing for both advection and diffusion.\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} \\right)\n$$\nRearranging for $u_j^{n+1}$:\n$$\nu_j^{n+1} = (1 - 2d)u_j^n + (d - C/2)u_{j+1}^n + (d + C/2)u_{j-1}^n\n$$\nFor monotonicity, the coefficients must be non-negative.\n1.  $d+C/2 \\ge 0$. True since $C,d > 0$.\n2.  $1-2d \\ge 0 \\implies 2d \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x^2}{2\\alpha}$. This matches the proposed condition.\n3.  $d - C/2 \\ge 0 \\implies 2d \\ge C \\implies 2\\frac{\\alpha\\Delta t}{\\Delta x^2} \\ge \\frac{v\\Delta t}{\\Delta x} \\implies \\frac{2\\alpha}{v\\Delta x} \\ge 1$.\nThis last condition is equivalent to the grid Péclet number $Pe_\\Delta = \\frac{v\\Delta x}{\\alpha}$ being less than or equal to $2$. The scheme is only monotone if $Pe_\\Delta \\le 2$. The option claims it is monotone \"for any $v$,\" which is false. This scheme is well-known to produce non-physical oscillations when advection dominates (i.e., for $Pe_\\Delta > 2$). The claim of guaranteed monotonicity is false. Furthermore, the stability condition for this scheme is $\\Delta t \\le \\min(\\frac{2\\alpha}{v^2}, \\frac{\\Delta x^2}{2\\alpha})$. The condition given in the option, $\\Delta t \\le \\frac{\\Delta x^2}{2\\alpha}$, is incomplete and does not guarantee stability for any $v$.\nVerdict on Option B: **Incorrect**.\n\n**Analysis of Option C**\nThe scheme uses backward Euler in time, first-order upwind for advection, and second-order central for diffusion.\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -v \\left( \\frac{u_j^{n+1} - u_{j-1}^{n+1}}{\\Delta x} \\right) + \\alpha \\left( \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{\\Delta x^2} \\right)\n$$\nRearranging terms to form a linear system $A\\mathbf{u}^{n+1} = \\mathbf{u}^n$:\n$$\n(-d)u_{j+1}^{n+1} + (1 + C + 2d)u_j^{n+1} + (-C - d)u_{j-1}^{n+1} = u_j^n\n$$\nThe matrix $A$ is tridiagonal. For any interior row $j$, the non-zero entries are $A_{j,j+1}=-d$, $A_{j,j}=1+C+2d$, and $A_{j,j-1}=-(C+d)$.\nFor monotonicity, we check if $A$ is an M-matrix.\n1.  Diagonal entries: $A_{j,j} = 1+C+2d > 0$ for any $\\Delta t > 0$.\n2.  Off-diagonal entries: $A_{j,j+1} = -d < 0$ and $A_{j,j-1} = -(C+d) < 0$. So $A$ is a Z-matrix.\n3.  Diagonal Dominance: $|A_{j,j}| = 1+C+2d$. The sum of magnitudes of off-diagonal elements in a row is $|A_{j,j-1}|+|A_{j,j+1}| = C+d+d = C+2d$. The condition $|A_{j,j}| \\ge \\sum_{k\\ne j}|A_{j,k}|$ becomes $1+C+2d \\ge C+2d$, which is true. The matrix is diagonally dominant (and irreducibly so when boundary conditions are included).\nA diagonally dominant Z-matrix with positive diagonals is an M-matrix. The inverse of an M-matrix has non-negative entries ($A^{-1} \\ge 0$). Thus, if $\\mathbf{u}^n \\ge 0$, then $\\mathbf{u}^{n+1} = A^{-1}\\mathbf{u}^n \\ge 0$. The scheme is unconditionally monotone for any $\\Delta t > 0$. Unconditional monotonicity implies unconditional stability.\nThe accuracy is first-order in time ($O(\\Delta t)$) from backward Euler and first-order in space ($O(\\Delta x)$) from upwinding. The accuracy statement is correct.\nVerdict on Option C: **Correct**.\n\n**Analysis of Option D**\nThe scheme is Crank-Nicolson in time with second-order central differences for both advection and diffusion. This scheme is known to be unconditionally stable for the linear advection-diffusion equation because the amplification factor $G$ has modulus $|G|=|\\frac{1 + \\hat{L}_h\\Delta t/2}{1 - \\hat{L}_h\\Delta t/2}|=1$ where $\\hat{L}_h$ is the symbol of the spatial operator, which has a non-positive real part. Thus, the unconditional stability claim is correct.\nHowever, for monotonicity, this scheme suffers from the same problem as the explicit central-difference scheme (Option B). It is only monotone if the grid Péclet number $Pe_\\Delta = \\frac{v\\Delta x}{\\alpha} \\le 2$. For advection-dominated flows ($Pe_\\Delta > 2$), the scheme produces spurious oscillations and is thus not monotone. The claim of unconditional monotonicity is false.\nThe accuracy is indeed second-order in both time and space, $O(\\Delta t^2, \\Delta x^2)$. But since the unconditional monotonicity requirement is not met, the option is invalid.\nVerdict on Option D: **Incorrect**.\n\n**Analysis of Option E**\nThis option presents the same scheme as Option A but proposes a different condition on the time step:\n$$\n\\Delta t \\;\\le\\; \\min\\!\\Big\\{\\,\\frac{\\Delta x}{v},\\,\\frac{\\Delta x^2}{2\\alpha}\\,\\Big\\}\n$$\nThis condition is equivalent to requiring $C = \\frac{v\\Delta t}{\\Delta x} \\le 1$ and $d = \\frac{\\alpha\\Delta t}{\\Delta x^2} \\le \\frac{1}{2}$ (or $2d \\le 1$) simultaneously. These are the stability limits for pure advection with upwinding and pure diffusion with FTCS, respectively. However, for the combined advection-diffusion equation, the correct condition for monotonicity and stability is $C+2d \\le 1$, as derived for Option A.\nThe conditions $C \\le 1$ and $2d \\le 1$ do *not* imply $C+2d \\le 1$. For example, if $C=0.7$ and $2d=0.7$, both conditions of Option E are met, but $C+2d = 1.4 > 1$, which violates the monotonicity condition. Therefore, the time step condition proposed in Option E does not guarantee stability or monotonicity. The accuracy statement is correct, but the stability/monotonicity condition is not.\nVerdict on Option E: **Incorrect**.\n\nIn conclusion, only options A and C provide a combination of scheme, stability/monotonicity condition, and accuracy statement that is entirely correct.", "answer": "$$\\boxed{AC}$$", "id": "2524648"}]}