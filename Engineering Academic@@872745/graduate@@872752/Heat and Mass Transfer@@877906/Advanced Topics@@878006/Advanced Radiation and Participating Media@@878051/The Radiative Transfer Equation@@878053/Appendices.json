{"hands_on_practices": [{"introduction": "Solving the Radiative Transfer Equation (RTE) for an idealized scenario is a rite of passage in mastering the subject. This first practice tackles a foundational case: a one-dimensional, isothermal slab that absorbs and emits radiation but does not scatter it.\n\nBy deriving the exact analytical solution for the angular intensity and the emergent radiative flux from first principles [@problem_id:2529717], you will build the core mathematical skill of integrating the RTE along its characteristics and connect the microscopic intensity field to a macroscopic, measurable energy flux.", "problem": "A plane-parallel, homogeneous, non-scattering, participating slab of thickness $L$ occupies $0 \\le x \\le L$. The slab is in vacuum on both sides. The refractive index is unity and refraction at the interfaces can be neglected. The medium exhibits pure absorption and thermal emission under local thermodynamic equilibrium (LTE) at a uniform temperature $T_0$. Let the spectral absorption coefficient be constant, $\\kappa_{\\nu}$, and the spectral source function under LTE be given by Kirchhoff’s law as $S_{\\nu} = B_{\\nu}(T_0)$, where $B_{\\nu}$ is the Planck function at frequency $\\nu$. Consider the spectral specific intensity $I_{\\nu}(x,\\mu)$, where $\\mu = \\cos\\theta \\in (-1,1)$ and $\\theta$ is the polar angle measured from the $+x$-axis (in radians). There is no external irradiation: $I_{\\nu}(0,\\mu) = 0$ for $\\mu \\in (0,1]$ and $I_{\\nu}(L,\\mu) = 0$ for $\\mu \\in [-1,0)$. Starting from conservation of radiant energy along a ray in a participating medium and the definitions of absorption and emission under LTE, derive the exact closed-form expressions for:\n- the internal angular intensity $I_{\\nu}(x,\\mu)$ for $\\mu \\in (0,1]$ and for $\\mu \\in [-1,0)$, and\n- the outward hemispherical spectral fluxes emitted from both boundaries,\n$$F_{\\nu,\\text{out}}(0) = 2\\pi \\int_{-1}^{0} \\big(-\\mu\\big)\\, I_{\\nu}(0,\\mu)\\, d\\mu,\\qquad F_{\\nu,\\text{out}}(L) = 2\\pi \\int_{0}^{1} \\mu\\, I_{\\nu}(L,\\mu)\\, d\\mu.$$\nExpress your final flux results in terms of the exponential integral $E_3(\\tau)$, with the optical thickness $\\tau = \\kappa_{\\nu} L$. Your derivation must begin from conservation of radiant energy along a characteristic, without invoking any pre-tabulated radiative transfer solutions. Provide your final expressions in terms of $B_{\\nu}(T_0)$, $\\kappa_{\\nu}$, $L$, and $\\mu$. The final answers must be closed-form analytic expressions. Express the fluxes in units of $\\mathrm{W\\, m^{-2}\\, Hz^{-1}}$. Do not perform any numerical evaluation or rounding.", "solution": "The fundamental principle governing the transport of radiant energy is the conservation of energy along a ray. The change in spectral specific intensity, $dI_{\\nu}$, over a differential path length $ds$ in a participating medium is the sum of gains from emission and losses from absorption. This is expressed as:\n$$ \\frac{dI_{\\nu}}{ds} = -\\alpha_{\\nu}I_{\\nu} + j_{\\nu} $$\nwhere $\\alpha_{\\nu}$ is the absorption coefficient and $j_{\\nu}$ is the emission coefficient. The problem states that the medium is non-scattering, so scattering terms are absent. Under the condition of local thermodynamic equilibrium (LTE), Kirchhoff's law relates the emission and absorption coefficients via the Planck function $B_{\\nu}(T)$. For a medium with refractive index of unity, this relation is $j_{\\nu} = \\alpha_{\\nu} B_{\\nu}(T)$. The problem gives the spectral absorption coefficient as $\\kappa_{\\nu}$, which is a synonym for $\\alpha_{\\nu}$. Thus, $j_{\\nu} = \\kappa_{\\nu} B_{\\nu}(T_0)$, where the temperature $T_0$ is uniform throughout the slab.\n\nThe equation of transfer becomes:\n$$ \\frac{dI_{\\nu}}{ds} = -\\kappa_{\\nu}I_{\\nu} + \\kappa_{\\nu}B_{\\nu}(T_0) $$\nFor a plane-parallel geometry, the path length $ds$ along a ray is related to the coordinate $x$ normal to the slab by $ds = \\frac{dx}{\\mu}$, where $\\mu = \\cos\\theta$ and $\\theta$ is the polar angle with respect to the $+x$-axis. Substituting this into the equation gives the one-dimensional radiative transfer equation (RTE) for this problem:\n$$ \\mu \\frac{dI_{\\nu}(x, \\mu)}{dx} = -\\kappa_{\\nu}I_{\\nu}(x, \\mu) + \\kappa_{\\nu}B_{\\nu}(T_0) $$\nThis is a first-order linear ordinary differential equation for $I_{\\nu}$ with respect to $x$, which we will solve subject to the given boundary conditions. The equation can be rearranged as:\n$$ \\frac{dI_{\\nu}}{dx} + \\frac{\\kappa_{\\nu}}{\\mu} I_{\\nu} = \\frac{\\kappa_{\\nu}}{\\mu} B_{\\nu}(T_0) $$\nWe use the integrating factor method. The integrating factor is $\\exp\\left(\\int \\frac{\\kappa_{\\nu}}{\\mu} dx\\right) = \\exp\\left(\\frac{\\kappa_{\\nu}x}{\\mu}\\right)$, since $\\kappa_{\\nu}$ and $\\mu$ are constant with respect to $x$. Multiplying the RTE by the integrating factor yields:\n$$ \\frac{d}{dx}\\left[I_{\\nu}(x,\\mu)\\exp\\left(\\frac{\\kappa_{\\nu}x}{\\mu}\\right)\\right] = \\frac{\\kappa_{\\nu}}{\\mu} B_{\\nu}(T_0) \\exp\\left(\\frac{\\kappa_{\\nu}x}{\\mu}\\right) $$\nIntegrating with respect to $x$ from a reference position $x_0$ to $x$:\n$$ I_{\\nu}(x,\\mu)\\exp\\left(\\frac{\\kappa_{\\nu}x}{\\mu}\\right) - I_{\\nu}(x_0,\\mu)\\exp\\left(\\frac{\\kappa_{\\nu}x_0}{\\mu}\\right) = \\int_{x_0}^{x} \\frac{\\kappa_{\\nu}}{\\mu} B_{\\nu}(T_0) \\exp\\left(\\frac{\\kappa_{\\nu}x'}{\\mu}\\right) dx' $$\nSince $B_{\\nu}(T_0)$ is constant, the integral is straightforward:\n$$ \\int_{x_0}^{x} \\frac{\\kappa_{\\nu}}{\\mu} B_{\\nu}(T_0) \\exp\\left(\\frac{\\kappa_{\\nu}x'}{\\mu}\\right) dx' = B_{\\nu}(T_0) \\left[\\exp\\left(\\frac{\\kappa_{\\nu}x'}{\\mu}\\right)\\right]_{x_0}^{x} = B_{\\nu}(T_0)\\left[\\exp\\left(\\frac{\\kappa_{\\nu}x}{\\mu}\\right) - \\exp\\left(\\frac{\\kappa_{\\nu}x_0}{\\mu}\\right)\\right] $$\nThus, the formal solution is:\n$$ I_{\\nu}(x,\\mu) = I_{\\nu}(x_0,\\mu)\\exp\\left(-\\frac{\\kappa_{\\nu}(x-x_0)}{\\mu}\\right) + B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(x-x_0)}{\\mu}\\right)\\right] $$\nWe now apply the specific boundary conditions for the two separate cases of direction of propagation.\n\n**Part 1: Internal Angular Intensity $I_{\\nu}(x,\\mu)$**\n\nCase 1: Radiation propagating in the forward direction, $\\mu \\in (0,1]$.\nThe radiation originates from the boundary at $x=0$. We set the reference position $x_0 = 0$. The boundary condition is $I_{\\nu}(0,\\mu)=0$.\nSubstituting this into the formal solution:\n$$ I_{\\nu}(x,\\mu) = 0 \\cdot \\exp\\left(-\\frac{\\kappa_{\\nu}x}{\\mu}\\right) + B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}x}{\\mu}\\right)\\right] $$\n$$ I_{\\nu}(x,\\mu) = B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}x}{\\mu}\\right)\\right] \\quad \\text{for } \\mu \\in (0,1] $$\n\nCase 2: Radiation propagating in the backward direction, $\\mu \\in [-1,0)$.\nThe radiation originates from the boundary at $x=L$. We set the reference position $x_0 = L$. The boundary condition is $I_{\\nu}(L,\\mu)=0$.\nSubstituting this into the formal solution:\n$$ I_{\\nu}(x,\\mu) = I_{\\nu}(L,\\mu)\\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right) + B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right)\\right] $$\n$$ I_{\\nu}(x,\\mu) = 0 \\cdot \\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right) + B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right)\\right] $$\n$$ I_{\\nu}(x,\\mu) = B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right)\\right] \\quad \\text{for } \\mu \\in [-1,0) $$\nNote that for $\\mu  0$, the argument of the exponential $(x-L)/\\mu$ is positive since $x  L$, ensuring the intensity increases from zero at $x=L$ as it propagates into the medium.\n\n**Part 2: Outward Hemispherical Spectral Fluxes**\n\nFlux at boundary $x=L$:\nThe outward flux at $x=L$ is due to radiation propagating in directions $\\mu \\in (0,1]$. The expression provided is:\n$$ F_{\\nu,\\text{out}}(L) = 2\\pi \\int_0^1 \\mu I_{\\nu}(L,\\mu) d\\mu $$\nWe use the expression for $I_{\\nu}(x,\\mu)$ for $\\mu  0$ and evaluate it at $x=L$:\n$$ I_{\\nu}(L,\\mu) = B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}L}{\\mu}\\right)\\right] $$\nSubstituting this into the flux integral:\n$$ F_{\\nu,\\text{out}}(L) = 2\\pi B_{\\nu}(T_0) \\int_0^1 \\mu \\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}L}{\\mu}\\right)\\right] d\\mu $$\n$$ F_{\\nu,\\text{out}}(L) = 2\\pi B_{\\nu}(T_0) \\left[ \\int_0^1 \\mu d\\mu - \\int_0^1 \\mu \\exp\\left(-\\frac{\\kappa_{\\nu}L}{\\mu}\\right) d\\mu \\right] $$\nThe first integral is elementary: $\\int_0^1 \\mu d\\mu = \\left[\\frac{\\mu^2}{2}\\right]_0^1 = \\frac{1}{2}$.\nThe second integral is related to the exponential integral function, $E_n(z)$. One standard definition is $E_n(z) = \\int_0^1 u^{n-2} \\exp(-z/u) du$.\nLet optical thickness be $\\tau = \\kappa_{\\nu}L$. The integral is $\\int_0^1 \\mu \\exp(-\\tau/\\mu) d\\mu$.\nComparing with the definition, we set $u=\\mu$, $z=\\tau$, and $n-2=1$, which implies $n=3$.\nTherefore, $\\int_0^1 \\mu \\exp(-\\tau/\\mu) d\\mu = E_3(\\tau) = E_3(\\kappa_{\\nu}L)$.\nSubstituting back, the flux is:\n$$ F_{\\nu,\\text{out}}(L) = 2\\pi B_{\\nu}(T_0) \\left[ \\frac{1}{2} - E_3(\\kappa_{\\nu}L) \\right] = \\pi B_{\\nu}(T_0) \\left[ 1 - 2E_3(\\kappa_{\\nu}L) \\right] $$\n\nFlux at boundary $x=0$:\nThe outward flux at $x=0$ is due to radiation propagating in directions $\\mu \\in [-1,0)$. The expression is:\n$$ F_{\\nu,\\text{out}}(0) = 2\\pi \\int_{-1}^0 (-\\mu) I_{\\nu}(0,\\mu) d\\mu $$\nWe use the expression for $I_{\\nu}(x,\\mu)$ for $\\mu  0$ and evaluate it at $x=0$:\n$$ I_{\\nu}(0,\\mu) = B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(0-L)}{\\mu}\\right)\\right] = B_{\\nu}(T_0)\\left[1 - \\exp\\left(\\frac{\\kappa_{\\nu}L}{\\mu}\\right)\\right] $$\nTo evaluate the integral, we perform a change of variable. Let $\\mu' = -\\mu$. Then $d\\mu = -d\\mu'$. The limits of integration change from $[-1,0)$ to $(1,0]$.\n$$ F_{\\nu,\\text{out}}(0) = 2\\pi \\int_1^0 \\mu' I_{\\nu}(0,-\\mu') (-d\\mu') = 2\\pi \\int_0^1 \\mu' I_{\\nu}(0,-\\mu') d\\mu' $$\nThe intensity in terms of $\\mu'$ is:\n$$ I_{\\nu}(0,-\\mu') = B_{\\nu}(T_0)\\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}L}{\\mu'}\\right)\\right] $$\nSubstituting this into the integral for $F_{\\nu,\\text{out}}(0)$:\n$$ F_{\\nu,\\text{out}}(0) = 2\\pi B_{\\nu}(T_0) \\int_0^1 \\mu' \\left[1 - \\exp\\left(-\\frac{\\kappa_{\\nu}L}{\\mu'}\\right)\\right] d\\mu' $$\nThis integral is identical in form to the one for $F_{\\nu,\\text{out}}(L)$, with the dummy integration variable being $\\mu'$ instead of $\\mu$. The evaluation is therefore identical.\n$$ F_{\\nu,\\text{out}}(0) = \\pi B_{\\nu}(T_0) \\left[ 1 - 2E_3(\\kappa_{\\nu}L) \\right] $$\nThe equality of the outward fluxes, $F_{\\nu,\\text{out}}(0) = F_{\\nu,\\text{out}}(L)$, is expected from the physical symmetry of the problem: a homogeneous, isothermal slab with symmetric boundary conditions must radiate equally from both sides. The units of the spectral flux are indeed $\\mathrm{W \\cdot m^{-2} \\cdot Hz^{-1}}$, as the units of $B_{\\nu}(T_0)$ are $\\mathrm{W \\cdot m^{-2} \\cdot sr^{-1} \\cdot Hz^{-1}}$ and the integration over the solid angle with the factor $\\mu$ removes the steradian dependence.", "answer": "$$ \\boxed{\\begin{pmatrix} B_{\\nu}(T_0)\\left(1 - \\exp\\left(-\\frac{\\kappa_{\\nu} x}{\\mu}\\right)\\right)  B_{\\nu}(T_0)\\left(1 - \\exp\\left(-\\frac{\\kappa_{\\nu}(x-L)}{\\mu}\\right)\\right)  \\pi B_{\\nu}(T_0) \\left( 1 - 2E_3(\\kappa_{\\nu} L) \\right)  \\pi B_{\\nu}(T_0) \\left( 1 - 2E_3(\\kappa_{\\nu} L) \\right) \\end{pmatrix}} $$", "id": "2529717"}, {"introduction": "Our first exercise provided a solution for a purely absorbing and emitting medium. Real-world participating media, from clouds to combusting gases, almost always involve scattering, which complicates the RTE by coupling different angular directions.\n\nThis practice drills down into the scattering term's core component: the phase function. By analytically examining the ubiquitous Henyey-Greenstein phase function [@problem_id:2529742], you will verify its physical consistency through normalization and explore its directional properties by calculating its Legendre moments, gaining a deeper appreciation for how we mathematically model the redistribution of scattered energy.", "problem": "In three-dimensional radiative transfer, the scattering source term involves the phase function that redistributes intensity over directions. Consider the Henyey–Greenstein phase function with asymmetry parameter $g$ (with $|g|1$), defined for the cosine of the scattering angle $\\mu=\\cos\\theta\\in[-1,1]$ by\n$$\n\\Phi_{g}(\\mu)\\;=\\;\\frac{1-g^{2}}{4\\pi\\left(1+g^{2}-2g\\mu\\right)^{3/2}}.\n$$\nThis phase function depends only on the scattering angle and is azimuthally symmetric about the incident direction. Using the definitions of solid-angle integration and Legendre polynomials $P_{\\ell}(\\mu)$, do the following from first principles:\n\n1) Starting from the requirement that any physically valid phase function must conserve radiative energy under scattering, demonstrate that $\\Phi_{g}(\\mu)$ is properly normalized over solid angle, i.e., show that\n$$\n\\int_{4\\pi} \\Phi_{g}(\\mu)\\,\\mathrm{d}\\Omega \\;=\\; 1.\n$$\n\n2) Define the $\\ell$-th Legendre moment of the phase function by\n$$\na_{\\ell}\\;=\\;2\\pi\\int_{-1}^{1}\\Phi_{g}(\\mu)\\,P_{\\ell}(\\mu)\\,\\mathrm{d}\\mu,\n$$\nwhere $P_{0}(\\mu)=1$ and $P_{1}(\\mu)=\\mu$. Compute the zeroth and first Legendre moments, $a_{0}$ and $a_{1}$, in closed form as functions of $g$.\n\nAnswer format: Express your final answer as a single row matrix containing $a_{0}$ and $a_{1}$ in that order. No numerical rounding is required. The answer is dimensionless.", "solution": "**Part 1: Normalization of the Phase Function**\n\nThe normalization condition requires that the integral of the phase function over all solid angles equals unity. This expresses the conservation of energy in a single scattering event. The integral is\n$$\nI = \\int_{4\\pi} \\Phi_{g}(\\mu)\\,\\mathrm{d}\\Omega\n$$\nIn spherical coordinates, the differential solid angle is $\\mathrm{d}\\Omega = \\sin\\theta\\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$, where $\\theta \\in [0, \\pi]$ is the polar angle and $\\phi \\in [0, 2\\pi]$ is the azimuthal angle. Since the phase function $\\Phi_{g}(\\mu)$ depends only on $\\mu = \\cos\\theta$, it is independent of the azimuthal angle $\\phi$. The integration over $\\phi$ can be performed directly:\n$$\nI = \\int_{0}^{2\\pi}\\mathrm{d}\\phi \\int_{0}^{\\pi} \\Phi_{g}(\\cos\\theta) \\sin\\theta\\,\\mathrm{d}\\theta = 2\\pi \\int_{0}^{\\pi} \\Phi_{g}(\\cos\\theta) \\sin\\theta\\,\\mathrm{d}\\theta\n$$\nWe change the variable of integration from $\\theta$ to $\\mu = \\cos\\theta$. The differential is $\\mathrm{d}\\mu = -\\sin\\theta\\,\\mathrm{d}\\theta$. The limits of integration for $\\theta$ from $0$ to $\\pi$ correspond to $\\mu$ from $1$ to $-1$.\n$$\nI = 2\\pi \\int_{1}^{-1} \\Phi_{g}(\\mu) (-\\mathrm{d}\\mu) = 2\\pi \\int_{-1}^{1} \\Phi_{g}(\\mu)\\,\\mathrm{d}\\mu\n$$\nSubstituting the expression for $\\Phi_{g}(\\mu)$:\n$$\nI = 2\\pi \\int_{-1}^{1} \\frac{1-g^{2}}{4\\pi\\left(1+g^{2}-2g\\mu\\right)^{3/2}}\\,\\mathrm{d}\\mu = \\frac{1-g^{2}}{2} \\int_{-1}^{1} (1+g^2-2g\\mu)^{-3/2}\\,\\mathrm{d}\\mu\n$$\nTo evaluate this integral, we use the substitution $u = 1+g^2-2g\\mu$. The differential is $\\mathrm{d}u = -2g\\,\\mathrm{d}\\mu$, so $\\mathrm{d}\\mu = -\\frac{\\mathrm{d}u}{2g}$. The new limits of integration are:\n- When $\\mu = -1$, $u = 1+g^2-2g(-1) = 1+2g+g^2 = (1+g)^2$.\n- When $\\mu = 1$, $u = 1+g^2-2g(1) = 1-2g+g^2 = (1-g)^2$.\nThe integral becomes:\n$$\nI = \\frac{1-g^{2}}{2} \\int_{(1+g)^2}^{(1-g)^2} u^{-3/2} \\left(-\\frac{\\mathrm{d}u}{2g}\\right) = -\\frac{1-g^2}{4g} \\int_{(1+g)^2}^{(1-g)^2} u^{-3/2}\\,\\mathrm{d}u\n$$\nThe antiderivative of $u^{-3/2}$ is $\\frac{u^{-1/2}}{-1/2} = -2u^{-1/2}$. Evaluating the definite integral:\n$$\nI = -\\frac{1-g^2}{4g} \\left[-2u^{-1/2}\\right]_{(1+g)^2}^{(1-g)^2} = \\frac{1-g^2}{2g} \\left[u^{-1/2}\\right]_{(1+g)^2}^{(1-g)^2}\n$$\n$$\nI = \\frac{1-g^2}{2g} \\left( \\frac{1}{\\sqrt{(1-g)^2}} - \\frac{1}{\\sqrt{(1+g)^2}} \\right)\n$$\nSince $|g|1$, both $1-g$ and $1+g$ are positive. Thus, $\\sqrt{(1-g)^2} = 1-g$ and $\\sqrt{(1+g)^2} = 1+g$.\n$$\nI = \\frac{1-g^2}{2g} \\left( \\frac{1}{1-g} - \\frac{1}{1+g} \\right) = \\frac{1-g^2}{2g} \\left( \\frac{(1+g) - (1-g)}{(1-g)(1+g)} \\right)\n$$\n$$\nI = \\frac{1-g^2}{2g} \\left( \\frac{2g}{1-g^2} \\right) = 1\n$$\nThis demonstrates that the Henyey-Greenstein phase function is properly normalized.\n\n**Part 2: Legendre Moments $a_0$ and $a_1$**\n\nThe $\\ell$-th Legendre moment of the phase function is defined as $a_{\\ell} = 2\\pi\\int_{-1}^{1}\\Phi_{g}(\\mu)\\,P_{\\ell}(\\mu)\\,\\mathrm{d}\\mu$.\n\nFirst, we compute the zeroth moment, $a_0$, using $P_0(\\mu) = 1$:\n$$\na_0 = 2\\pi\\int_{-1}^{1}\\Phi_{g}(\\mu)\\,P_{0}(\\mu)\\,\\mathrm{d}\\mu = 2\\pi\\int_{-1}^{1}\\Phi_{g}(\\mu)\\,\\mathrm{d}\\mu\n$$\nThis is precisely the integral evaluated in Part 1 for the normalization. Therefore,\n$$\na_0 = 1\n$$\nThis result holds for any properly normalized phase function.\n\nNext, we compute the first moment, $a_1$, using $P_1(\\mu) = \\mu$:\n$$\na_1 = 2\\pi\\int_{-1}^{1}\\Phi_{g}(\\mu)\\,P_{1}(\\mu)\\,\\mathrm{d}\\mu = 2\\pi\\int_{-1}^{1}\\mu\\,\\Phi_{g}(\\mu)\\,\\mathrm{d}\\mu\n$$\nSubstituting the expression for $\\Phi_{g}(\\mu)$:\n$$\na_1 = 2\\pi\\int_{-1}^{1} \\mu \\frac{1-g^{2}}{4\\pi\\left(1+g^{2}-2g\\mu\\right)^{3/2}} \\,\\mathrm{d}\\mu = \\frac{1-g^2}{2} \\int_{-1}^{1} \\frac{\\mu}{(1+g^2-2g\\mu)^{3/2}}\\,\\mathrm{d}\\mu\n$$\nWe evaluate the integral using integration by parts, $\\int U\\,\\mathrm{d}V = UV - \\int V\\,\\mathrm{d}U$.\nLet $U = \\mu$ and $\\mathrm{d}V = (1+g^2-2g\\mu)^{-3/2}\\,\\mathrm{d}\\mu$.\nThen $\\mathrm{d}U = \\mathrm{d}\\mu$. To find $V$, we integrate $\\mathrm{d}V$:\n$$\nV = \\int (1+g^2-2g\\mu)^{-3/2}\\,\\mathrm{d}\\mu = \\frac{1}{-2g}\\int (1+g^2-2g\\mu)^{-3/2}(-2g\\,\\mathrm{d}\\mu) = \\frac{1}{-2g}\\frac{(1+g^2-2g\\mu)^{-1/2}}{-1/2} = \\frac{(1+g^2-2g\\mu)^{-1/2}}{g}\n$$\nThe integral becomes:\n$$\n\\int_{-1}^{1} \\frac{\\mu\\,\\mathrm{d}\\mu}{(1+g^2-2g\\mu)^{3/2}} = \\left[\\frac{\\mu(1+g^2-2g\\mu)^{-1/2}}{g}\\right]_{-1}^{1} - \\frac{1}{g} \\int_{-1}^{1} (1+g^2-2g\\mu)^{-1/2}\\,\\mathrm{d}\\mu\n$$\nThe boundary term is:\n$$\n\\left(\\frac{1(1-g)^{-1}}{g}\\right) - \\left(\\frac{-1(1+g)^{-1}}{g}\\right) = \\frac{1}{g(1-g)} + \\frac{1}{g(1+g)} = \\frac{1}{g}\\left(\\frac{1+g+1-g}{1-g^2}\\right) = \\frac{2}{g(1-g^2)}\n$$\nThe remaining integral is:\n$$\n-\\frac{1}{g} \\int_{-1}^{1} (1+g^2-2g\\mu)^{-1/2}\\,\\mathrm{d}\\mu = -\\frac{1}{g}\\left[\\frac{(1+g^2-2g\\mu)^{1/2}}{-2g(1/2)}\\right]_{-1}^{1} = \\frac{1}{g^2}\\left[(1+g^2-2g\\mu)^{1/2}\\right]_{-1}^{1}\n$$\n$$\n= \\frac{1}{g^2}\\left( (1-g) - (1+g) \\right) = \\frac{1}{g^2}(-2g) = -\\frac{2}{g}\n$$\nCombining the parts of the integration by parts result:\n$$\n\\int_{-1}^{1} \\frac{\\mu}{(1+g^2-2g\\mu)^{3/2}}\\,\\mathrm{d}\\mu = \\frac{2}{g(1-g^2)} - \\frac{2}{g} = \\frac{2-2(1-g^2)}{g(1-g^2)} = \\frac{2g^2}{g(1-g^2)} = \\frac{2g}{1-g^2}\n$$\nFinally, we compute $a_1$:\n$$\na_1 = \\frac{1-g^2}{2} \\left( \\frac{2g}{1-g^2} \\right) = g\n$$\nThe first Legendre moment $a_1$ is equal to the asymmetry parameter $g$, which is consistent with the physical interpretation of $g$ as the mean cosine of the scattering angle.\n\nThe required values are $a_0 = 1$ and $a_1 = g$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  g \\end{pmatrix}}\n$$", "id": "2529742"}, {"introduction": "While analytical solutions are invaluable for building intuition, most practical radiative transfer problems are too complex to be solved with pen and paper. We must turn to numerical methods.\n\nThis practice introduces the Monte Carlo method, a powerful and physically intuitive approach that simulates the probabilistic life histories of individual energy packets, or 'photons.' You will not only implement a complete simulation but also formally prove that the analog Monte Carlo method inherently conserves energy, a fundamental principle that you will then use to verify the correctness of your code [@problem_id:2529752].", "problem": "Consider the steady, monochromatic Radiative Transfer Equation (RTE) in a homogeneous slab domain with thickness $L$ along the $z$-axis, extinction coefficient $\\sigma_t = \\sigma_a + \\sigma_s$ that is spatially uniform, absorption coefficient $\\sigma_a$, scattering coefficient $\\sigma_s$, and isotropic scattering phase function. The slab has planar boundaries at $z=0$ and $z=L$, each with a specular reflectance $\\rho \\in [0,1]$ and transmittance $1-\\rho$ into an external vacuum. A collimated, normally incident, unit-power source injects radiation at $z=0$ in the $+z$ direction. Assume particles (“photon packets”) travel in straight lines between collisions, with free-path lengths distributed according to the exponential distribution implied by a homogeneous Poisson process of rate $\\sigma_t$, and that collisions result in either absorption or scattering sampled according to the local branching probabilities. Angles are to be treated in radians.\n\nYour task is to derive, from first principles, that an unbiased Monte Carlo (MC) transport simulation must treat absorption, scattering, and boundary interactions as unbiased Bernoulli branchings that conserve expected packet weight, and to design a global-balance tally that can verify energy conservation numerically. Begin from the following fundamental bases and core definitions only:\n- The steady-state RTE and its integral balance: for any control volume $V$ with boundary $\\partial V$, the net outward radiative flux equals absorption in $V$ plus net sources in $V$.\n- Homogeneous Poisson flight statistics for collision distances in a uniform medium: a free-path length $s$ is distributed with density $\\sigma_t \\exp(-\\sigma_t s)$.\n- At a collision, the event type is determined by the branching probabilities $\\mathbb{P}(\\text{absorption}) = \\sigma_a/\\sigma_t$ and $\\mathbb{P}(\\text{scattering}) = \\sigma_s/\\sigma_t$. At a boundary with reflectance $\\rho$, the event is a specular reflection with probability $\\rho$ and transmission (escape) with probability $1-\\rho$.\n- Isotropic scattering draws a new direction with $\\mu=\\cos\\theta$ uniform in $[-1,1]$ and $\\varphi$ uniform in $[0,2\\pi)$, both angles in radians.\n\nDerive the unbiasedness requirements and show that, under unbiased Bernoulli treatment of absorption, scattering, and boundary interactions with weight conserved on non-absorbing events, the expected sum of absorbed energy in the medium plus escaped energy across the two boundaries equals the injected source power, that is, the expected global-balance residual\n$$\n\\widehat{R} \\equiv 1 - \\left(\\widehat{A} + \\widehat{E}_{0} + \\widehat{E}_{L}\\right)\n$$\nsatisfies $\\mathbb{E}[\\widehat{R}]=0$, where $\\widehat{A}$ is the Monte Carlo estimate of the absorbed fraction in the medium, and $\\widehat{E}_{0}$ and $\\widehat{E}_{L}$ are the estimates of the escaped fractions through $z=0$ and $z=L$, respectively. Then devise a computable tally that realizes $\\widehat{A}$, $\\widehat{E}_{0}$, and $\\widehat{E}_{L}$ using unit-weight photon packets and report the absolute residual $|\\widehat{R}|$.\n\nImplement a complete program that:\n- Launches $N$ independent unit-weight photon packets at $z=0$ pointing in the $+z$ direction (immediately inside the slab to avoid ambiguity on entry) and transports each packet until it is either absorbed in the medium or transmitted out of the slab at $z=0$ or $z=L$.\n- Samples free paths $s$ from the exponential distribution with rate $\\sigma_t$, and advances each packet by $\\min(s, s_b)$, where $s_b$ is the distance to the next boundary along its current direction. If $s_bs$, process a boundary interaction with specular reflection probability $\\rho$ (which flips the $z$-component of direction) and transmission probability $1-\\rho$ (which tallies an escape and terminates the packet). If $s \\le s_b$, process a collision by absorbing the packet with probability $\\sigma_a/\\sigma_t$ (tally into $\\widehat{A}$ and terminate) or isotropically scattering it with probability $\\sigma_s/\\sigma_t$ (draw a new direction and continue).\n- Uses unitless normalization so that the injected source power is $1$, and reports the single-number absolute global-balance residual $|\\widehat{R}|$ for each test.\n\nPhysical units, when specified, must be as follows: $L$ must be given in meters ($\\mathrm{m}$), $\\sigma_a$ and $\\sigma_s$ must be given in inverse meters ($\\mathrm{m}^{-1}$), and angles must be in radians. Your program should be deterministic given the same inputs by setting a fixed pseudo-random seed.\n\nTest suite. Your program must run exactly the following four tests and aggregate their results:\n- Test $1$ (happy path, pure absorption with vacuum boundaries): $L=1\\,\\mathrm{m}$, $\\sigma_a=1\\,\\mathrm{m}^{-1}$, $\\sigma_s=0\\,\\mathrm{m}^{-1}$, $\\rho=0$, $N=20000$.\n- Test $2$ (pure scattering with vacuum boundaries): $L=1\\,\\mathrm{m}$, $\\sigma_a=0\\,\\mathrm{m}^{-1}$, $\\sigma_s=2\\,\\mathrm{m}^{-1}$, $\\rho=0$, $N=20000$.\n- Test $3$ (mixed medium with highly reflective boundaries): $L=1\\,\\mathrm{m}$, $\\sigma_a=0.5\\,\\mathrm{m}^{-1}$, $\\sigma_s=1.5\\,\\mathrm{m}^{-1}$, $\\rho=0.8$, $N=20000$.\n- Test $4$ (optically thin slab, vacuum boundaries): $L=0.01\\,\\mathrm{m}$, $\\sigma_a=0.01\\,\\mathrm{m}^{-1}$, $\\sigma_s=0\\,\\mathrm{m}^{-1}$, $\\rho=0$, $N=20000$.\n\nFinal output format. Your program should produce a single line of output containing the $4$ absolute residuals as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where each $r_i$ is a floating-point number corresponding to the absolute global-balance residual $|\\widehat{R}|$ of Test $i$.", "solution": "The fundamental principle governing the problem is the conservation of energy, which in the context of steady-state radiative transfer, is expressed by the integral balance form of the Radiative Transfer Equation (RTE). For any control volume $V$ with boundary $\\partial V$, the total power injected by sources within the volume must equal the power absorbed within the volume plus the net power escaping across its boundary. Mathematically, this is:\n$$\n\\int_{V} \\int_{4\\pi} S(\\mathbf{r}, \\mathbf{\\Omega}) \\, d\\Omega \\, dV = \\int_{V} \\int_{4\\pi} \\sigma_a(\\mathbf{r}) I(\\mathbf{r}, \\mathbf{\\Omega}) \\, d\\Omega \\, dV + \\oint_{\\partial V} \\int_{4\\pi} (\\mathbf{\\Omega} \\cdot \\mathbf{n}) I(\\mathbf{r}, \\mathbf{\\Omega}) \\, d\\Omega \\, dA\n$$\nwhere $S$ is the source emissivity, $I$ is the radiance, $\\sigma_a$ is the absorption coefficient, and $\\mathbf{n}$ is the outward normal to the boundary surface element $dA$. The problem defines a unit-power source ($ \\int S \\, d\\Omega \\, dV = 1 $), so the left side is $1$. The first term on the right is the total absorbed power $A$, and the second is the total escaped power $E$. Thus, the physical system rigorously satisfies $A+E=1$.\n\nA Monte Carlo simulation models this continuous process by tracking discrete histories of energy packets (\"photons\"). An estimator for a physical quantity is deemed \"unbiased\" if its expected value over all possible random histories equals the true physical quantity. We are asked to show that the proposed analog Monte Carlo scheme leads to an expected global energy balance, i.e., $\\mathbb{E}[\\widehat{A} + \\widehat{E}_0 + \\widehat{E}_L] = 1$, where hatted quantities are the Monte Carlo estimators.\n\nWe will trace the expected weight of a single packet, launched with initial weight $W_0=1$. A packet's history is a sequence of stochastic events: free flights followed by collisions or boundary interactions. The core of the proof lies in demonstrating that the total expected weight is conserved at each event.\n\nConsider a packet of weight $W$ arriving at a stochastic event. The event comprises a set of mutually exclusive outcomes $\\{o_i\\}$ with probabilities $p_i$, where $\\sum_i p_i = 1$. The analog simulation method handles this by selecting one outcome $o_j$ based on a random number draw. If the outcome is terminal (e.g., absorption, escape), the packet's full weight $W$ is scored to the corresponding tally and the history ends. If the outcome is non-terminal (e.g., scattering, reflection), the packet's state is updated and it continues its history with its weight unchanged.\n\nLet's analyze the two event types in this problem:\n\n1.  **Collision Event**: A packet traverses a free path and arrives at a collision site within the medium. The two possible outcomes are absorption and scattering.\n    -   The probability of absorption is $p_a = \\sigma_a / \\sigma_t$. In the analog scheme, this event is terminal. The weight scored to the absorption tally $\\widehat{A}$ is $W$.\n    -   The probability of scattering is $p_s = \\sigma_s / \\sigma_t$. This event is non-terminal. The packet's weight remains $W$ post-scattering.\n    -   The total expected weight is partitioned into a deposited component (absorbed) and a surviving component (scattered).\n        -   Expected deposited weight: $\\mathbb{E}[W_{dep}] = W \\cdot p_a + 0 \\cdot p_s = W p_a$.\n        -   Expected surviving weight: $\\mathbb{E}[W_{surv}] = 0 \\cdot p_a + W \\cdot p_s = W p_s$.\n    -   The sum of expected weights is $\\mathbb{E}[W_{dep}] + \\mathbb{E}[W_{surv}] = W p_a + W p_s = W(p_a + p_s) = W(\\frac{\\sigma_a}{\\sigma_t} + \\frac{\\sigma_s}{\\sigma_t}) = W$.\n    -   Thus, the total expected weight is conserved across a collision event.\n\n2.  **Boundary Interaction Event**: A packet travels to a boundary at $z=0$ or $z=L$. The two possible outcomes are transmission (escape) and reflection.\n    -   The probability of escape is $p_t = 1-\\rho$. This is a terminal event. The weight $W$ is scored to the appropriate escape tally, $\\widehat{E}_0$ or $\\widehat{E}_L$.\n    -   The probability of specular reflection is $p_r = \\rho$. This is non-terminal. The packet's weight remains $W$.\n    -   The partition of expected weight is:\n        -   Expected deposited weight (escaped): $\\mathbb{E}[W_{dep}] = W \\cdot p_t + 0 \\cdot p_r = W(1-\\rho)$.\n        -   Expected surviving weight (reflected): $\\mathbb{E}[W_{surv}] = 0 \\cdot p_t + W \\cdot p_r = W\\rho$.\n    -   The sum of expected weights is $\\mathbb{E}[W_{dep}] + \\mathbb{E}[W_{surv}] = W(1-\\rho) + W\\rho = W$.\n    -   Total expected weight is conserved across a boundary event as well.\n\nThis demonstrates that the proposed simulation rules constitute unbiased Bernoulli branchings that conserve expected weight at every step.\n\nNow, we extend this to a full packet history. Let $W_k$ be the packet's weight entering its $k$-th event, and $D_k$ be the random variable for the weight deposited at this event (which is non-zero only if the event is terminal). From the analysis above, $\\mathbb{E}[W_k] = \\mathbb{E}[W_{k-1}] - \\mathbb{E}[D_k]$. Starting with $W_0=1$, we can write this recursively:\n$$ \\mathbb{E}[W_k] = \\mathbb{E}[W_{k-1}] - \\mathbb{E}[D_k] = W_0 - \\sum_{i=1}^k \\mathbb{E}[D_i] = 1 - \\sum_{i=1}^k \\mathbb{E}[D_i] $$\nFor any physically realistic scenario in a finite domain (as in all test cases), a packet cannot undergo an infinite number of events. There is always a non-zero probability of termination (absorption or escape). Therefore, as the number of events $k \\to \\infty$, the probability of the packet surviving tends to zero, which means $\\lim_{k\\to\\infty} \\mathbb{E}[W_k] = 0$. This forces the conclusion that the sum of all expected depositions over the entire history must be unity:\n$$ \\sum_{k=1}^\\infty \\mathbb{E}[D_k] = 1 $$\nThe total absorbed fraction for a single history is $A_{hist} = \\sum_{k} D_{k,abs}$, and the total escaped fractions are $E_{0,hist} = \\sum_{k} D_{k,esc,0}$ and $E_{L,hist} = \\sum_{k} D_{k,esc,L}$. In an analog simulation, only one of these will be $1$ and the others $0$.\nThe total deposited weight for one history is $D_{total} = A_{hist} + E_{0,hist} + E_{L,hist}$. Its expectation is $\\mathbb{E}[D_{total}] = \\sum_k \\mathbb{E}[D_k] = 1$.\nThe Monte Carlo estimators are the averages over $N$ independent histories: $\\widehat{A} = \\frac{1}{N}\\sum_{j=1}^N A_{hist,j}$, and similarly for $\\widehat{E}_0$ and $\\widehat{E}_L$.\nBy linearity of expectation:\n$$ \\mathbb{E}[\\widehat{A} + \\widehat{E}_0 + \\widehat{E}_L] = \\mathbb{E}[A_{hist} + E_{0,hist} + E_{L,hist}] = \\mathbb{E}[D_{total}] = 1 $$\nFinally, the expectation of the global-balance residual $\\widehat{R}$ is:\n$$ \\mathbb{E}[\\widehat{R}] = \\mathbb{E}[1 - (\\widehat{A} + \\widehat{E}_0 + \\widehat{E}_L)] = 1 - \\mathbb{E}[\\widehat{A} + \\widehat{E}_0 + \\widehat{E}_L] = 1 - 1 = 0 $$\nThis completes the derivation.\n\nFor the implementation, a computable tally is designed based on this analog (\"unit-weight\") transport scheme. For each of the $N$ simulated packets, we track its path until it is terminated by either absorption or escape. We maintain three counters: $N_{abs}$, $N_{esc,0}$, and $N_{esc,L}$. When a packet's history ends, the corresponding counter is incremented. Since every packet history must end in one of these three states, we must have $N_{abs} + N_{esc,0} + N_{esc,L} = N$.\nThe estimators are then computed as $\\widehat{A} = N_{abs}/N$, $\\widehat{E}_0 = N_{esc,0}/N$, and $\\widehat{E}_L = N_{esc,L}/N$. The absolute residual is calculated as $|\\widehat{R}| = |1.0 - (\\widehat{A} + \\widehat{E}_0 + \\widehat{E}_L)|$. While mathematically this sum should be precisely $1$, the use of finite-precision floating-point arithmetic means that the fractions like $N_{abs}/N$ may not be exactly representable. The sum of these inexact numbers may deviate slightly from $1.0$, resulting in a computed residual on the order of machine epsilon ($ \\sim 10^{-16} $). This residual serves as a stringent check on the correctness of the simulation logic; any value significantly larger than machine epsilon would indicate a flaw, such as \"lost\" packets.\n\nThe simulation algorithm for a single packet is as follows:\n1.  Initialize the packet at position $z=0$ with direction $\\mu=1$.\n2.  In a loop, perform the following steps until the packet is terminated:\n    a.  Calculate the total interaction coefficient $\\sigma_t = \\sigma_a + \\sigma_s$.\n    b.  Sample a random free-path length $s$ from the exponential distribution $p(s) = \\sigma_t e^{-\\sigma_t s}$ using inverse transform sampling: $s = -\\ln(\\xi) / \\sigma_t$, where $\\xi$ is a uniform random number in $(0, 1)$. Handle the case $\\sigma_t=0$, where $s$ becomes infinite.\n    c.  Calculate the distance to the nearest boundary, $s_b$. If $\\mu0$, $s_b = (L-z)/\\mu$. If $\\mu0$, $s_b = -z/\\mu$. If $\\mu=0$, $s_b$ is infinite.\n    d.  If $s  s_b$, the next event is a collision. Advance the packet to $z \\leftarrow z + s\\mu$. With probability $\\sigma_a/\\sigma_t$, terminate the packet and tally as absorbed. Otherwise, with probability $\\sigma_s/\\sigma_t$, scatter the packet by sampling a new isotropic direction $\\mu$ uniformly from $[-1, 1]$ and continue the loop.\n    e.  If $s \\ge s_b$, the next event is a boundary interaction. Advance the packet to the boundary ($z=L$ if $\\mu0$, $z=0$ if $\\mu0$). With probability $\\rho$, the packet reflects specularly ($\\mu \\leftarrow -\\mu$) and continues. Otherwise, with probability $1-\\rho$, the packet escapes; terminate and tally the escape at the appropriate boundary.", "answer": "```python\nimport numpy as np\n\ndef simulate_packet(L, sigma_a, sigma_s, rho):\n    \"\"\"\n    Simulates the history of a single unit-weight photon packet.\n\n    Args:\n        L (float): Thickness of the slab.\n        sigma_a (float): Absorption coefficient.\n        sigma_s (float): Scattering coefficient.\n        rho (float): Specular reflectance of the boundaries.\n\n    Returns:\n        str: The outcome of the packet history, one of\n             'absorbed', 'escaped_z0', 'escaped_zL'.\n    \"\"\"\n    # Packet state: z-position and direction cosine mu.\n    z = 0.0\n    mu = 1.0\n    \n    sigma_t = sigma_a + sigma_s\n\n    while True:\n        # Sample free path length 's'\n        if sigma_t  0:\n            # Using 1 - rand() to avoid log(0)\n            s = -np.log(1.0 - np.random.rand()) / sigma_t\n        else:\n            s = np.inf\n\n        # Calculate distance to nearest boundary 's_b'\n        if mu  1e-9:  # Traveling in +z direction\n            s_b = (L - z) / mu\n        elif mu  -1e-9:  # Traveling in -z direction\n            s_b = -z / mu\n        else:  # Traveling parallel to boundaries\n            s_b = np.inf\n\n        # Determine next event\n        if s  s_b:\n            # Collision event\n            z += s * mu\n\n            # Decide between absorption and scattering\n            absorption_prob = sigma_a / sigma_t if sigma_t  0 else 0.0\n            if np.random.rand()  absorption_prob:\n                return 'absorbed'  # Packet is absorbed\n            else:\n                # Isotropic scattering: sample new direction\n                mu = 2.0 * np.random.rand() - 1.0\n        else:\n            # Boundary interaction event\n            # Move packet to the boundary\n            if mu  0:\n                z = L\n            else:\n                z = 0.0\n\n            # Decide between reflection and transmission (escape)\n            if np.random.rand()  rho:\n                # Specular reflection\n                mu = -mu\n            else:\n                # Transmission (escape)\n                if z == L:\n                    return 'escaped_zL'\n                else: # z == 0\n                    return 'escaped_z0'\n\ndef run_simulation(L, sigma_a, sigma_s, rho, N):\n    \"\"\"\n    Runs a full Monte Carlo simulation for a given set of parameters.\n\n    Args:\n        L (float): Slab thickness.\n        sigma_a (float): Absorption coefficient.\n        sigma_s (float): Scattering coefficient.\n        rho (float): Boundary reflectance.\n        N (int): Number of photon packets to simulate.\n    \n    Returns:\n        float: The absolute global-balance residual |R_hat|.\n    \"\"\"\n    tallies = {\n        'absorbed': 0,\n        'escaped_z0': 0,\n        'escaped_zL': 0\n    }\n\n    for _ in range(N):\n        outcome = simulate_packet(L, sigma_a, sigma_s, rho)\n        tallies[outcome] += 1\n    \n    # Verify that all packets were terminated and tallied.\n    # This sum must equal N for a correct analog simulation.\n    total_tallied = sum(tallies.values())\n    if total_tallied != N:\n        raise RuntimeError(f\"Energy conservation violation in tally counts: \"\n                         f\"sum of tallies {total_tallied} != N {N}\")\n\n    # Calculate fractions based on tallies\n    A_hat = tallies['absorbed'] / N\n    E0_hat = tallies['escaped_z0'] / N\n    EL_hat = tallies['escaped_zL'] / N\n    \n    # Calculate the global-balance residual. The sum A+E0+EL might not be\n    # exactly 1.0 due to floating-point representation errors.\n    residual = 1.0 - (A_hat + E0_hat + EL_hat)\n    \n    return abs(residual)\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Set a fixed seed for the pseudo-random number generator\n    # for deterministic and reproducible results.\n    np.random.seed(42)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, sigma_a, sigma_s, rho, N)\n        (1.0, 1.0, 0.0, 0.0, 20000),  # Test 1\n        (1.0, 0.0, 2.0, 0.0, 20000),  # Test 2\n        (1.0, 0.5, 1.5, 0.8, 20000),  # Test 3\n        (0.01, 0.01, 0.0, 0.0, 20000), # Test 4\n    ]\n\n    results = []\n    for case in test_cases:\n        L, sigma_a, sigma_s, rho, N = case\n        residual = run_simulation(L, sigma_a, sigma_s, rho, N)\n        results.append(residual)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2529752"}]}