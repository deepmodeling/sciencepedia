{"hands_on_practices": [{"introduction": "The one-dimensional Euler equations form a system of nonlinear partial differential equations that are often challenging to solve analytically. For specific types of flows, the method of characteristics provides a powerful tool to simplify these equations by transforming them along special curves. This exercise [@problem_id:482964] guides you through the application of Riemann invariants, which are constant along these characteristics, to establish a direct algebraic relationship between velocity and sound speed in a simple expansion wave, a foundational concept in gas dynamics.", "problem": "Consider the one-dimensional, isentropic, compressible flow of a perfect gas with a constant ratio of specific heats, $\\gamma$. The flow is governed by the 1D Euler equations for conservation of mass and momentum. For such a flow, the method of characteristics reveals that the system of partial differential equations can be transformed into a system of ordinary differential equations along characteristic curves. This analysis leads to the formulation of Riemann invariants, which are quantities that remain constant along these curves. The Riemann invariants are given by:\n$$J_{\\pm} = u \\pm \\frac{2c}{\\gamma-1}$$\nThese quantities are constant along the characteristic curves defined by $\\frac{dx}{dt} = u \\pm c$, respectively. Here, $u$ is the fluid velocity and $c$ is the local speed of sound.\n\nA particular type of flow, known as a simple wave, arises when one of the Riemann invariants is constant not just along its corresponding characteristic, but throughout an entire region of the flow. Consider a one-dimensional expansion wave propagating into a quiescent gas. The gas ahead of the wave is at rest, so its initial state is defined by a velocity $u_0 = 0$ and a uniform sound speed $c_0$. As the expansion wave develops, it propagates into this still gas. For such a configuration, the Riemann invariant $J_-$ associated with the characteristics moving away from the source of the disturbance (i.e., those with speed $u-c$) is constant throughout the entire expansion wave region.\n\nStarting from the given definition of the Riemann invariants, derive the specific relationship between the fluid velocity $u$ and the local speed of sound $c$ that holds everywhere within this simple expansion wave. Your final answer should be an expression for $u$ in terms of $c$, the initial sound speed $c_0$, and the ratio of specific heats $\\gamma$.", "solution": "We have the Riemann invariant for a 1D isentropic flow,\n$$J_- \\;=\\; u \\;-\\;\\frac{2c}{\\gamma-1}\\,. $$\nIn a simple expansion wave propagating into quiescent gas, $J_-$ is constant throughout the wave.  Ahead of the wave the gas is at rest ($u_0=0$) with sound speed $c_0$, so\n$$J_- \\;=\\;u_0 \\;-\\;\\frac{2c_0}{\\gamma-1}\n\\;=\\;-\\;\\frac{2c_0}{\\gamma-1}\\,. $$\nEquating this to the invariant in the wave region gives\n$$u \\;-\\;\\frac{2c}{\\gamma-1}\n\\;=\\;-\\;\\frac{2c_0}{\\gamma-1}\\,. $$\nSolving for $u$,\n$$u\n=\\;\\frac{2c}{\\gamma-1}\\;-\\;\\frac{2c_0}{\\gamma-1}\n=\\;\\frac{2\\bigl(c - c_0\\bigr)}{\\gamma-1}\\,. $$", "answer": "$$\\boxed{\\frac{2\\bigl(c - c_0\\bigr)}{\\gamma - 1}}$$", "id": "482964"}, {"introduction": "In geophysical fluid dynamics, the Boussinesq approximation is a key simplification for studying buoyancy-driven flows in stratified environments like oceans and atmospheres. A powerful method for modeling wave phenomena in these systems is to derive their dispersion relation, which connects a wave's frequency to its wavenumber. In this practice [@problem_id:482979], you will analyze the linearized Boussinesq equations for a stratified fluid to derive this fundamental relationship for internal gravity waves.", "problem": "Consider an inviscid, non-rotating, incompressible fluid that is continuously and stably stratified in the vertical ($z$) direction. In the Boussinesq approximation, the fluid motion is described by a set of linearized equations governing the evolution of small perturbations from a hydrostatic rest state. The perturbation velocity is $\\mathbf{u}' = (u', 0, w')$, the perturbation pressure is $p'$, and the perturbation density is $\\rho'$.\n\nThe governing equations are:\n1.  **Incompressibility:**\n    $$ \\frac{\\partial u'}{\\partial x} + \\frac{\\partial w'}{\\partial z} = 0 $$\n2.  **Horizontal (x) momentum:**\n    $$ \\rho_0 \\frac{\\partial u'}{\\partial t} = -\\frac{\\partial p'}{\\partial x} $$\n3.  **Vertical (z) momentum:**\n    $$ \\rho_0 \\frac{\\partial w'}{\\partial t} = -\\frac{\\partial p'}{\\partial z} - \\rho' g $$\n4.  **Density conservation:**\n    $$ \\frac{\\partial \\rho'}{\\partial t} + w' \\frac{d\\bar{\\rho}}{dz} = 0 $$\n\nHere, $\\rho_0$ is a constant reference density, $g$ is the acceleration due to gravity, and $\\bar{\\rho}(z)$ is the background density profile of the fluid at rest.\n\nThe stability of the stratification is characterized by the Brunt-Väisälä frequency, $N$, defined by the relation:\n$$ N^2 = -\\frac{g}{\\rho_0} \\frac{d\\bar{\\rho}}{dz} $$\nFor the purpose of this problem, assume that $N$ is a positive constant.\n\nWe seek two-dimensional plane wave solutions for the perturbation fields, of the form:\n$$ f'(x, z, t) = \\hat{f} e^{i(k_x x + k_z z - \\omega t)} $$\nwhere $f'$ represents any of $u'$, $w'$, $p'$, or $\\rho'$, and $\\hat{f}$ is the corresponding constant complex amplitude. The parameters $k_x$ and $k_z$ are the horizontal and vertical components of the wavevector $\\mathbf{k}$, and $\\omega$ is the angular frequency of the wave.\n\nDerive the dispersion relation for these internal gravity waves. Your final answer should be an expression for the frequency $\\omega$ as a function of the Brunt-Väisälä frequency $N$ and the wavevector components $k_x$ and $k_z$. Assume that the frequency $\\omega$ is positive.", "solution": "We seek plane-wave solutions $f'(x,z,t)=\\hat{f} e^{i(k_x x+k_z z-\\omega t)}$.  Substitution into each governing equation gives algebraic relations among the amplitudes $\\hat{u}, \\hat{w}, \\hat{p}, \\hat{\\rho}$.\n\n1. Incompressibility $∂_x u'+∂_z w'=0$ ⇒  \n   $$i k_x\\hat{u} + i k_z\\hat{w}=0 \\quad\\Longrightarrow\\quad \\hat{u}=-\\frac{k_z}{k_x}\\,\\hat{w}.$$\n\n2. Horizontal momentum $\\rho_0∂_tu'=-∂_xp'$ ⇒  \n   $$-i\\omega\\rho_0\\hat{u}=-i k_x\\hat{p}\\quad\\Longrightarrow\\quad \\hat{p}=\\frac{\\omega\\rho_0}{k_x}\\,\\hat{u}.$$\n\n3. Density conservation $∂_t\\rho'+w'(d\\bar{\\rho}/dz)=0$ with $d\\bar{\\rho}/dz=-ρ_0N^2/g$ ⇒  \n   $$-i\\omega\\hat{\\rho} + \\hat{w}\\,\\bigl(-\\tfrac{\\rho_0N^2}{g}\\bigr)=0 \n     \\quad\\Longrightarrow\\quad \\hat{\\rho}=-\\frac{\\rho_0N^2}{g\\,i\\omega}\\,\\hat{w}.$$\n\n4. Vertical momentum $\\rho_0∂_tw'=-∂_zp'-ρ'g$ ⇒  \n   $$-i\\omega\\rho_0\\hat{w}=-i k_z\\hat{p} - g\\hat{\\rho}\n     =-i k_z\\hat{p} +\\frac{\\rho_0N^2}{i\\omega}\\,\\hat{w}.$$\n   Multiply by $iω$:  \n   $$ω^2\\rho_0\\hat{w} =ωk_z\\hat{p} +\\rho_0N^2\\hat{w}\n     \\;\\Longrightarrow\\; \\hat{p}=\\frac{\\rho_0\\hat{w}\\,(ω^2-N^2)}{ωk_z}.$$\n\n5. Equate the two expressions for $\\hat{p}$ from (2) and (4):  \n   $$\\frac{\\omega\\rho_0}{k_x}\\,\\hat{u}\n     =\\frac{\\rho_0}{ωk_z}\\,(ω^2-N^2)\\,\\hat{w}.$$\n   Substitute $\\hat{u}=-(k_z/k_x)\\hat{w}$:  \n   $$\\frac{\\omega\\rho_0}{k_x}\\Bigl(-\\frac{k_z}{k_x}\\hat{w}\\Bigr)\n     =\\frac{\\rho_0}{ωk_z}(ω^2-N^2)\\hat{w}.$$\n   Cancel $\\rho_0\\hat{w}$ and rearrange:  \n   $$-\\frac{\\omega k_z}{k_x^2}=\\frac{ω^2-N^2}{ωk_z}\n     \\;\\Longrightarrow\\;\n     -ω^2k_z^2 = (ω^2-N^2)k_x^2$$\n   $$\\Longrightarrow\\; ω^2(k_x^2+k_z^2)=N^2k_x^2.$$\n\n6. Thus the dispersion relation is  \n   $$ω^2=\\frac{N^2k_x^2}{k_x^2+k_z^2}\n     \\quad\\Longrightarrow\\quad\n     ω=\\frac{N\\,|k_x|}{\\sqrt{k_x^2+k_z^2}},$$\n   taking the positive root.", "answer": "$$\\boxed{\\frac{N\\lvert k_x\\rvert}{\\sqrt{k_x^2+k_z^2}}}$$", "id": "482979"}, {"introduction": "Beyond describing stable fluid motions, derived models are crucial for predicting when a flow might become unstable and transition to turbulence. This practice [@problem_id:483008] delves into the stability of large-scale atmospheric and oceanic shear flows using the barotropic vorticity equation on a beta-plane. By analyzing the growth of small perturbations, you will derive the celebrated Rayleigh-Kuo criterion, a necessary condition for the onset of barotropic instability.", "problem": "Consider an inviscid, incompressible, barotropic fluid on a beta-plane. The motion is governed by the conservation of potential vorticity. We investigate the stability of a purely zonal basic state shear flow, $U(y)$, which is a function of the meridional coordinate $y$ only. The flow is confined between two rigid, impenetrable walls at $y=y_1$ and $y=y_2$.\n\nThe evolution of a small perturbation streamfunction, $\\psi'(x,y,t)$, superimposed on this basic state is described by the linearized barotropic vorticity equation:\n$$\n\\left(\\frac{\\partial}{\\partial t} + U(y) \\frac{\\partial}{\\partial x}\\right) \\nabla^2 \\psi' + \\left(\\beta - \\frac{d^2U}{dy^2}\\right) \\frac{\\partial \\psi'}{\\partial x} = 0\n$$\nHere, $\\beta$ is the constant meridional gradient of the Coriolis parameter.\n\nWe seek wavelike (normal mode) solutions of the form:\n$$\n\\psi'(x,y,t) = \\text{Re}\\{\\phi(y) e^{ik(x-ct)}\\}\n$$\nwhere $k$ is the real zonal wavenumber, $\\phi(y)$ is the complex amplitude of the meridional structure, and $c = c_r + ic_i$ is the complex wave phase speed. An unstable mode is characterized by an exponential growth in time, which corresponds to $c_i > 0$. The boundary conditions at the walls require the meridional velocity to be zero, which for this wavelike solution implies $\\phi(y_1) = 0$ and $\\phi(y_2) = 0$.\n\nBy postulating the existence of an unstable mode ($c_i > 0$), derive the necessary condition for this instability. This condition, known as the Rayleigh-Kuo criterion, states that a certain physical quantity related to the basic state must change its sign within the domain $(y_1, y_2)$.\n\nYour task is to derive the analytical expression for this quantity, which represents the meridional gradient of the basic state absolute vorticity.", "solution": "The derivation begins with the linearized barotropic vorticity equation for a perturbation streamfunction $\\psi'$ about a basic state zonal flow $U(y)$:\n$$\n\\left(\\frac{\\partial}{\\partial t} + U(y) \\frac{\\partial}{\\partial x}\\right) \\nabla^2 \\psi' + \\left(\\beta - \\frac{d^2U}{dy^2}\\right) \\frac{\\partial \\psi'}{\\partial x} = 0\n$$\nWe substitute the normal mode solution $\\psi'(x,y,t) = \\text{Re}\\{\\phi(y) e^{ik(x-ct)}\\}$ into this equation. The partial derivatives are:\n$\\frac{\\partial}{\\partial t} \\rightarrow -ikc$, $\\frac{\\partial}{\\partial x} \\rightarrow ik$, and $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} \\rightarrow -k^2 + \\frac{d^2}{dy^2}$.\n\nSubstituting these into the governing equation yields:\n$$\n(-ikc + ikU) \\left(\\frac{d^2\\phi}{dy^2} - k^2\\phi\\right) + \\left(\\beta - \\frac{d^2U}{dy^2}\\right) (ik\\phi) = 0\n$$\nFactoring out the common term $ik$ and rearranging gives the Rayleigh-Kuo equation, an ordinary differential equation for the meridional structure function $\\phi(y)$:\n$$\n(U-c) \\left(\\frac{d^2\\phi}{dy^2} - k^2\\phi\\right) + \\left(\\beta - \\frac{d^2U}{dy^2}\\right)\\phi = 0\n$$\nThis equation is subject to the boundary conditions $\\phi(y_1) = 0$ and $\\phi(y_2) = 0$.\n\nTo proceed, we divide by the term $(U-c)$, which is permissible as long as $U \\neq c$ anywhere in the domain. We will address this possibility later.\n$$\n\\frac{d^2\\phi}{dy^2} - k^2\\phi + \\frac{\\beta - \\frac{d^2U}{dy^2}}{U-c}\\phi = 0\n$$\nNow, we multiply the entire equation by the complex conjugate of the amplitude, $\\phi^*(y)$, and integrate over the meridional domain from $y_1$ to $y_2$:\n$$\n\\int_{y_1}^{y_2} \\left( \\phi^* \\frac{d^2\\phi}{dy^2} - k^2|\\phi|^2 + \\frac{\\beta - \\frac{d^2U}{dy^2}}{U-c}|\\phi|^2 \\right) dy = 0\n$$\nWe apply integration by parts to the first term, $\\int \\phi^* \\frac{d^2\\phi}{dy^2} dy$:\n$$\n\\int_{y_1}^{y_2} \\phi^* \\frac{d^2\\phi}{dy^2} dy = \\left[\\phi^* \\frac{d\\phi}{dy}\\right]_{y_1}^{y_2} - \\int_{y_1}^{y_2} \\frac{d\\phi^*}{dy} \\frac{d\\phi}{dy} dy\n$$\nThe boundary term $\\left[\\phi^* \\frac{d\\phi}{dy}\\right]_{y_1}^{y_2}$ vanishes because $\\phi(y_1) = \\phi(y_2) = 0$ (and thus $\\phi^*(y_1) = \\phi^*(y_2) = 0$). The remaining integral is $-\\int_{y_1}^{y_2} \\left|\\frac{d\\phi}{dy}\\right|^2 dy$.\n\nSubstituting this back into the integrated equation gives:\n$$\n\\int_{y_1}^{y_2} \\left( -\\left|\\frac{d\\phi}{dy}\\right|^2 - k^2|\\phi|^2 \\right) dy + \\int_{y_1}^{y_2} \\frac{\\beta - \\frac{d^2U}{dy^2}}{U-c}|\\phi|^2 dy = 0\n$$\nLet's analyze the complex components of this equation. The first integral is purely real and strictly negative for any non-trivial solution (since $|\\phi|^2 \\ge 0$ and $|\\frac{d\\phi}{dy}|^2 \\ge 0$ and they cannot both be zero everywhere).\n$$\n-\\int_{y_1}^{y_2} \\left( \\left|\\frac{d\\phi}{dy}\\right|^2 + k^2|\\phi|^2 \\right) dy  0\n$$\nFor the overall equation to be satisfied, the second integral must have a real part that is positive and an imaginary part that is zero. We assume an unstable mode exists, so the imaginary part of the phase speed, $c_i$, is positive ($c_i > 0$). Let's expand the complex term $\\frac{1}{U-c}$:\n$$\n\\frac{1}{U-c} = \\frac{1}{(U-c_r) - ic_i} = \\frac{(U-c_r) + ic_i}{(U-c_r)^2 + c_i^2} = \\frac{(U-c_r) + ic_i}{|U-c|^2}\n$$\nThe imaginary part of the full integrated equation is:\n$$\n\\text{Im} \\left[ \\int_{y_1}^{y_2} \\frac{\\beta - \\frac{d^2U}{dy^2}}{U-c}|\\phi|^2 dy \\right] = 0\n$$\nSubstituting the expansion for $\\frac{1}{U-c}$:\n$$\n\\text{Im} \\left[ \\int_{y_1}^{y_2} \\left(\\beta - \\frac{d^2U}{dy^2}\\right) \\frac{(U-c_r) + ic_i}{|U-c|^2} |\\phi|^2 dy \\right] = 0\n$$\nExtracting the imaginary component yields:\n$$\n\\int_{y_1}^{y_2} \\left(\\beta - \\frac{d^2U}{dy^2}\\right) \\frac{c_i}{|U-c|^2} |\\phi|^2 dy = 0\n$$\nFor an unstable mode, we have assumed $c_i > 0$. Also, $|\\phi|^2 \\ge 0$ and is not identically zero, and $|U-c|^2 = (U-c_r)^2 + c_i^2 > 0$. Therefore, the term $\\frac{c_i}{|U-c|^2} |\\phi|^2$ is a non-negative, real quantity.\nFor the integral to equal zero, the remaining factor in the integrand, $\\left(\\beta - \\frac{d^2U}{dy^2}\\right)$, must change sign at least once within the integration domain $(y_1, y_2)$. If this quantity were everywhere positive or everywhere negative, the integral would be strictly positive or strictly negative, respectively, leading to a contradiction with the requirement that it must be zero.\n\nThis quantity is the meridional gradient of the basic state absolute vorticity. The absolute vorticity is $\\zeta_{abs} = \\zeta_{rel} + f$, where $\\zeta_{rel} = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ is the relative vorticity and $f=f_0+\\beta y$ is the Coriolis parameter. For the basic state flow $(U(y), 0)$, the relative vorticity is $\\zeta_{rel} = -\\frac{dU}{dy}$. Thus, the absolute vorticity of the basic state is $\\zeta_{abs}^{(0)} = -\\frac{dU}{dy} + f_0 + \\beta y$.\nThe meridional gradient of this quantity is:\n$$\n\\frac{d}{dy}\\zeta_{abs}^{(0)} = \\frac{d}{dy}\\left(-\\frac{dU}{dy} + f_0 + \\beta y\\right) = -\\frac{d^2U}{dy^2} + \\beta\n$$\nThis is precisely the term that must change sign.\n\nTherefore, the necessary condition for barotropic instability is that the meridional gradient of the basic state absolute vorticity, $\\beta - \\frac{d^2U}{dy^2}$, must change sign somewhere in the fluid. The expression for this quantity is the required answer.", "answer": "$$\n\\boxed{\\beta - \\frac{d^2U}{dy^2}}\n$$", "id": "483008"}]}