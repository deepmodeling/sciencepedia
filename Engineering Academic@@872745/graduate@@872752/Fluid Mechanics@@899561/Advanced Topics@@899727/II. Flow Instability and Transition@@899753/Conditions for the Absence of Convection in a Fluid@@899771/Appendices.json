{"hands_on_practices": [{"introduction": "Understanding the onset of convection is fundamental, but real-world systems are rarely as simple as the classic Rayleigh-Bénard setup. This first practice introduces the crucial influence of rotation, a dominant factor in geophysical and astrophysical fluid dynamics. By solving for the critical Rayleigh number in a rotating fluid layer, you will directly quantify the stabilizing effect of the Coriolis force and see how it modifies the conditions for instability [@problem_id:471603].", "problem": "Consider a horizontal layer of a Boussinesq fluid of thickness $d$ confined between two plates. The layer is heated from below, maintaining a temperature difference $\\Delta T$ across it. The entire system rotates about a vertical axis with a constant angular velocity $\\Omega$. We are interested in the onset of stationary convection (Rayleigh-Bénard instability) under these conditions.\n\nThe state of the system is characterized by two non-dimensional parameters: the Rayleigh number $Ra = \\frac{g \\alpha \\Delta T d^3}{\\nu \\kappa}$ and the Taylor number $Ta = \\left(\\frac{2 \\Omega d^2}{\\nu}\\right)^2$. Here, $g$ is the acceleration due to gravity, $\\alpha$ is the coefficient of thermal expansion, $\\nu$ is the kinematic viscosity, and $\\kappa$ is the thermal diffusivity of the fluid.\n\nFor the marginal state of stationary convection, the vertical component of the perturbation velocity, $W$, for a normal mode with a horizontal wavenumber $k$, is governed by the following ordinary differential equation in the non-dimensional vertical coordinate $z \\in [0, 1]$:\n$$\n\\left(\\frac{d^2}{dz^2} - k^2\\right)^2 W(z) + Ta \\frac{d^2}{dz^2} W(z) = Ra \\, k^2 W(z)\n$$\nThe boundaries at $z=0$ and $z=1$ are assumed to be \"free-slip\" and perfectly conducting. For the vertical velocity amplitude $W$, these boundary conditions translate to:\n$$\nW(z) = 0 \\quad \\text{and} \\quad \\frac{d^2W}{dz^2}(z) = 0 \\quad \\text{at} \\quad z=0, 1\n$$\nThe onset of convection corresponds to the minimum Rayleigh number, $Ra_c$, for which a non-trivial solution $W(z)$ exists. This minimum is found by varying the wavenumber $k$.\n\nDerive the exact value of the critical Rayleigh number, $Ra_c$, for the onset of stationary convection when the Taylor number is fixed at $Ta = \\frac{\\pi^2}{2}$.", "solution": "The problem asks for the critical Rayleigh number $Ra_c$ for the onset of stationary convection in a rotating fluid layer with free-slip boundaries, given a specific Taylor number $Ta = \\pi^2/2$.\n\nThe governing equation for the vertical velocity perturbation amplitude $W(z)$ is:\n$$\n\\left(\\frac{d^2}{dz^2} - k^2\\right)^2 W(z) + Ta \\frac{d^2}{dz^2} W(z) = Ra \\, k^2 W(z)\n$$\nThe boundary conditions are:\n$$\nW(0) = 0, \\quad W(1) = 0\n$$\n$$\n\\frac{d^2W}{dz^2}(0) = 0, \\quad \\frac{d^2W}{dz^2}(1) = 0\n$$\nWe seek the lowest value of $Ra$ that allows for a non-trivial solution.\n\nThe boundary conditions suggest a solution in the form of a sine series. A single term of this series, $W(z) = A_n \\sin(n\\pi z)$ for an integer $n \\ge 1$, satisfies all four boundary conditions:\n- $W(0) = A_n \\sin(0) = 0$ and $W(1) = A_n \\sin(n\\pi) = 0$.\n- $\\frac{d^2W}{dz^2} = -A_n(n\\pi)^2 \\sin(n\\pi z)$. Thus $\\frac{d^2W}{dz^2}(0) = 0$ and $\\frac{d^2W}{dz^2}(1) = 0$.\n\nWe substitute $W(z) = \\sin(n\\pi z)$ (with an arbitrary amplitude that will cancel out) into the governing differential equation.\nThe derivatives are:\n$\\frac{d^2W}{dz^2} = -(n\\pi)^2 \\sin(n\\pi z)$\n$\\left(\\frac{d^2}{dz^2} - k^2\\right) W = (-(n\\pi)^2 - k^2) \\sin(n\\pi z) = -((n\\pi)^2 + k^2) \\sin(n\\pi z)$\n$\\left(\\frac{d^2}{dz^2} - k^2\\right)^2 W = (-((n\\pi)^2 + k^2))^2 \\sin(n\\pi z) = ((n\\pi)^2 + k^2)^2 \\sin(n\\pi z)$\n\nSubstituting these expressions into the governing equation:\n$$\n((n\\pi)^2 + k^2)^2 \\sin(n\\pi z) + Ta (-(n\\pi)^2 \\sin(n\\pi z)) = Ra \\, k^2 \\sin(n\\pi z)\n$$\nFor a non-trivial solution, the term $\\sin(n\\pi z)$ cancels out, yielding an algebraic relation for the Rayleigh number for each mode $n$:\n$$\n((n\\pi)^2 + k^2)^2 - Ta(n\\pi)^2 = Ra \\, k^2\n$$\nThus, the Rayleigh number is a function of the mode number $n$ and the wavenumber $k$:\n$$\nRa(k, n) = \\frac{((n\\pi)^2 + k^2)^2 - Ta(n\\pi)^2}{k^2}\n$$\nThe onset of convection occurs at the lowest possible Rayleigh number. We first find the minimum with respect to $n$. For a fixed $k$ and $Ta$, $Ra$ increases with $n$. Therefore, the most unstable mode (the one that becomes unstable at the lowest $Ra$) is the fundamental mode, $n=1$.\nSetting $n=1$:\n$$\nRa(k) = \\frac{(\\pi^2 + k^2)^2 - Ta \\, \\pi^2}{k^2}\n$$\nNow, we substitute the given value $Ta = \\frac{\\pi^2}{2}$:\n$$\nRa(k) = \\frac{(\\pi^2 + k^2)^2 - (\\frac{\\pi^2}{2})\\pi^2}{k^2} = \\frac{\\pi^4 + 2\\pi^2 k^2 + k^4 - \\frac{\\pi^4}{2}}{k^2}\n$$\n$$\nRa(k) = \\frac{\\frac{\\pi^4}{2} + 2\\pi^2 k^2 + k^4}{k^2} = \\frac{\\pi^4}{2k^2} + 2\\pi^2 + k^2\n$$\nTo find the critical Rayleigh number $Ra_c$, we must minimize $Ra(k)$ with respect to the wavenumber $k$. It is more convenient to minimize with respect to $x = k^2$.\n$$\nRa(x) = \\frac{\\pi^4}{2x} + 2\\pi^2 + x\n$$\nWe find the minimum by setting the derivative with respect to $x$ to zero:\n$$\n\\frac{d(Ra)}{dx} = -\\frac{\\pi^4}{2x^2} + 1 = 0\n$$\nSolving this for $x$ gives $x^2 = \\frac{\\pi^4}{2}$. The critical value for $x=k^2$ is thus:\n$$\nx_c = \\sqrt{\\frac{\\pi^4}{2}} = \\frac{\\pi^2}{\\sqrt{2}}\n$$\nSo, the critical wavenumber squared is $k_c^2 = \\frac{\\pi^2}{\\sqrt{2}}$.\n\nFinally, we substitute this critical value $x_c$ back into the expression for $Ra(x)$ to find the critical Rayleigh number $Ra_c$:\n$$\nRa_c = Ra(x_c) = \\frac{\\pi^4}{2x_c} + 2\\pi^2 + x_c = \\frac{\\pi^4}{2(\\frac{\\pi^2}{\\sqrt{2}})} + 2\\pi^2 + \\frac{\\pi^2}{\\sqrt{2}}\n$$\n$$\nRa_c = \\frac{\\pi^2 \\sqrt{2}}{2} + 2\\pi^2 + \\frac{\\pi^2}{\\sqrt{2}}\n$$\nCombining the terms with $\\sqrt{2}$:\n$$\nRa_c = \\left(\\frac{\\sqrt{2}}{2} + \\frac{1}{\\sqrt{2}}\\right)\\pi^2 + 2\\pi^2 = \\left(\\frac{\\sqrt{2}}{2} + \\frac{\\sqrt{2}}{2}\\right)\\pi^2 + 2\\pi^2\n$$\n$$\nRa_c = \\sqrt{2}\\pi^2 + 2\\pi^2 = (2+\\sqrt{2})\\pi^2\n$$", "answer": "$$\n\\boxed{(2+\\sqrt{2})\\pi^2}\n$$", "id": "471603"}, {"introduction": "Building on exact solutions, we now turn to scenarios where system parameters are not uniform, a common feature in natural environments. This exercise introduces perturbation theory, a powerful mathematical tool used to analyze the effects of small deviations from an idealized model. You will determine how a linear variation in the gravitational field alters the critical Rayleigh number for convection, thereby gaining hands-on experience with a technique essential for tackling a wide range of complex physics problems [@problem_id:471578].", "problem": "A fluid layer of depth $d$, described by the Boussinesq approximation, is confined between two horizontal, free-slip, and perfectly conducting plates located at $z=0$ (bottom) and $z=d$ (top). The bottom plate is maintained at a constant temperature $T_b$ and the top plate at $T_t$, with a destabilizing temperature gradient ($T_b  T_t$).\n\nUnlike the standard Rayleigh-Bénard problem, the system is subject to a vertical gravitational field that is not uniform but varies linearly with height. The gravitational acceleration is given by $\\mathbf{g}(z) = -g_0(1+\\gamma z/d)\\hat{\\mathbf{z}}$, where $g_0  0$ is the magnitude of the gravitational acceleration at the bottom plate ($z=0$) and $\\gamma$ is a small, dimensionless parameter that characterizes the linear variation.\n\nThe state of the fluid can be described by the velocity perturbation $\\mathbf{u}'$, the pressure perturbation $p'$, and the temperature perturbation $\\theta'$ from the static conduction state. The marginal stability of the system is governed by a set of linearized, non-dimensional equations. Seeking solutions in the form of normal modes, e.g., $w(x,y,z,t) = W(z)e^{i(k_x x + k_y y)}$, where $w$ is the vertical velocity component and $k^2 = k_x^2+k_y^2$ is the horizontal wavenumber squared, leads to a system of ordinary differential equations for the amplitude functions $W(z)$ and $\\Theta(z)$ (for the temperature perturbation).\n\nThe onset of stationary convection is determined by the minimum value of the Rayleigh number, $Ra$, over all possible wavenumbers $k$. This critical Rayleigh number, $Ra_c$, depends on the parameter $\\gamma$. For a small gravitational variation (i.e., for small $|\\gamma|$), the critical Rayleigh number can be expanded as a power series in $\\gamma$:\n$$Ra_c(\\gamma) = Ra_c(0) + \\gamma Ra_1 + O(\\gamma^2)$$\n\nFor the unperturbed problem ($\\gamma=0$), the critical Rayleigh number for the onset of convection is $Ra_c(0) = \\frac{27\\pi^4}{4}$, and this minimum occurs at a critical wavenumber squared of $k_c^2 = \\pi^2/2$.\n\nDerive the analytical expression for the first-order correction coefficient, $Ra_1$. The relevant physical constants are the thermal expansion coefficient $\\alpha$, the kinematic viscosity $\\nu$, and the thermal diffusivity $\\kappa$.", "solution": "We consider the linearized eigenvalue problem for stationary convection with gravity variation $\\mathbf{g}(z)=-g_0(1+\\gamma z/d)\\hat{\\mathbf{z}}$. Nondimensionalizing $z$ by $d$, letting $W(z)$ be the vertical velocity amplitude, and eliminating the temperature mode gives the generalized eigenvalue problem\n$$(D^2 - k^2)^3W = -Ra\\,k^2(1+\\gamma z)\\,W,\\quad W(0)=W(1)=D^2W(0)=D^2W(1)=0,$$\nwhere $D = d/dz$. We write this in operator form \n$$L(\\gamma)W = Ra(\\gamma)\\,M(\\gamma)W$$\nwith $L(\\gamma) = L_0 + \\gamma L_1$ and $M(\\gamma)=M_0+\\gamma M_1$, where\n$$L_0=(D^2-k^2)^3, \\quad L_1 = 0, \\quad M_0=k^2,\\quad M_1=k^2\\,z.$$\nFor $\\gamma=0$, we have the unperturbed eigenpair\n$$L_0W_0 = Ra_0\\,M_0W_0,\\quad \\text{with } Ra_0=\\frac{27\\pi^4}{4},\\quad k_c^2=\\frac{\\pi^2}{2},\\quad W_0(z)=\\sin(\\pi z).$$\nUsing standard perturbation theory for a generalized eigenvalue problem, the first-order correction is\n$$Ra_1=\\frac{\\langle W_0,L_1W_0\\rangle - Ra_0\\,\\langle W_0,M_1W_0\\rangle}\n{\\langle W_0,M_0W_0\\rangle}\\,.$$\nHere $L_1=0$, and hence\n$$Ra_1= -Ra_0\\,\\frac{\\langle W_0,M_1W_0\\rangle}{\\langle W_0,M_0W_0\\rangle} = -Ra_0\\,\\frac{\\int_0^1 W_0(z)\\,(k^2 z W_0(z))\\,dz}{\\int_0^1 W_0(z)\\,(k^2 W_0(z))\\,dz}\n= -Ra_0\\frac{\\int_0^1 z\\sin^2(\\pi z)\\,dz}{\\int_0^1\\sin^2(\\pi z)\\,dz}.$$\nWe compute the integrals:\n$$\\int_0^1\\sin^2(\\pi z)\\,dz=\\frac{1}{2}\\int_0^1(1-\\cos(2\\pi z))\\,dz = \\frac{1}{2}$$\n$$\\int_0^1 z\\sin^2(\\pi z)\\,dz = \\int_0^1 z\\frac{1-\\cos(2\\pi z)}{2}\\,dz = \\frac{1}{2}\\left[\\frac{z^2}{2}\\right]_0^1 - \\frac{1}{2}\\int_0^1 z\\cos(2\\pi z)\\,dz = \\frac{1}{4} - 0 = \\frac{1}{4}.$$\nHence, the first-order correction is\n$$Ra_1=-Ra_0\\,\\frac{1/4}{1/2}=-\\frac{Ra_0}{2}\n=-\\frac{1}{2}\\,\\frac{27\\pi^4}{4}=-\\frac{27\\pi^4}{8}\\,. $$", "answer": "$$\\boxed{-\\frac{27\\pi^4}{8}}$$", "id": "471578"}, {"introduction": "Many important phenomena in engineering and geophysics involve interfaces between different fluids. This practice explores convection in a two-layer system, where an exact analytical solution is often intractable. Here, you will employ the Galerkin method, a robust approximate technique, to estimate the criterion for instability, providing you with a valuable skill for analyzing complex, multi-domain problems where exact methods fall short [@problem_id:471641].", "problem": "A system consists of two superposed, immiscible, viscous fluid layers of equal thickness $d/2$ confined between two infinite horizontal plates separated by a distance $d$. The lower plate at $z=0$ is maintained at a temperature $T_{bot}$ and the upper plate at $z=d$ is at $T_{top}$, with $\\Delta T = T_{bot} - T_{top}  0$. The interface is located at $z=d/2$. Both plates are assumed to provide free-slip and perfectly conducting boundary conditions. The system is under a uniform gravitational field $\\mathbf{g} = -g\\hat{\\mathbf{z}}$.\n\nThe lower fluid (layer 1: $0  z  d/2$) has dynamic viscosity $\\mu_1$ and thermal conductivity $k_1$. The upper fluid (layer 2: $d/2  z  d$) has dynamic viscosity $\\mu_2$ and thermal conductivity $k_2$. Both fluids share the same constant reference density $\\rho_0$, thermal expansion coefficient $\\alpha$, and specific heat capacity $c_p$. The kinematic viscosity is $\\nu_i = \\mu_i/\\rho_0$ and thermal diffusivity is $\\kappa_i=k_i/(\\rho_0 c_p)$ for layer $i=1,2$.\n\nIn the quiescent base state, the temperature profile consists of two linear segments, with gradients $\\beta_1 = -dT_{B1}/dz$ and $\\beta_2 = -dT_{B2}/dz$. These are given by:\n$$\n\\beta_1 = \\frac{2\\gamma_k \\Delta T}{d(\\gamma_k+1)}, \\quad \\beta_2 = \\frac{2 \\Delta T}{d(\\gamma_k+1)}\n$$\nwhere $\\gamma_k = k_2/k_1$ is the thermal conductivity ratio.\n\nFor stationary convection ($\\sigma=0$), small perturbations from the base state are sought in the form of normal modes, e.g., $w'(x,y,z,t) = W(z) e^{i(k_x x + k_y y)}$. The governing equations for the vertical velocity amplitude $W_i(z)$ in each layer $i$ can be combined into a single equation:\n$$\n\\left(\\frac{d^2}{dz^2} - k^2\\right)^3 W_i(z) = - \\frac{g \\alpha \\beta_i k^2}{\\nu_i \\kappa_i} W_i(z)\n$$\nwhere $k^2 = k_x^2 + k_y^2$.\n\nTo find an approximate criterion for the onset of convection, we use the Galerkin method. This involves choosing a trial function $\\Psi(z)$ that satisfies the boundary conditions, and then solving the integrated equation:\n$$\n\\sum_{i=1}^{2} \\int_{\\text{layer } i} \\Psi(z) \\left[ \\left(\\frac{d^2}{dz^2} - k^2\\right)^3 \\Psi(z) + \\frac{g \\alpha \\beta_i k^2}{\\nu_i \\kappa_i} \\Psi(z) \\right] dz = 0\n$$\n\n**Problem:**\nUsing a single trial function for the vertical velocity perturbation that spans both layers, $\\Psi(z) = W_0 \\sin(\\pi z/d)$, derive the approximate critical Rayleigh number $Ra_c$ for the onset of stationary convection. The critical Rayleigh number is defined as the minimum value of the neutral stability curve $Ra(a)$ over all positive dimensionless horizontal wavenumbers $a=kd$. The Rayleigh number for the system is defined as $Ra = \\frac{g \\alpha \\Delta T d^3}{\\nu_1 \\kappa_1}$. Express your answer in terms of $\\pi$ and the property ratios $\\gamma_\\mu = \\mu_2/\\mu_1$ and $\\gamma_k = k_2/k_1$.", "solution": "We seek the neutral‐stability condition from the Galerkin integral equation:\n$$\\sum_{i=1}^2\\int_{\\text{layer }i}\\Psi\\left[\\left(\\frac{d^2}{dz^2}-k^2\\right)^3\\Psi+\\frac{g\\alpha\\beta_i k^2}{\\nu_i\\kappa_i}\\Psi\\right]dz=0,\\quad \\text{with } \\Psi(z)=\\sin\\left(\\frac{\\pi z}{d}\\right).$$\n1.  First, evaluate the action of the differential operator on the trial function $\\Psi$:\n$$ \\left(\\frac{d^2}{dz^2}-k^2\\right)\\Psi = -\\left(\\frac{\\pi^2}{d^2}+k^2\\right)\\Psi, $$\nso\n$$ \\left(\\frac{d^2}{dz^2}-k^2\\right)^3\\Psi = -\\left(\\frac{\\pi^2}{d^2}+k^2\\right)^3\\Psi. $$\n2.  Substitute this back into the integral equation. The equation becomes:\n$$ \\int_0^d -\\left(\\frac{\\pi^2}{d^2}+k^2\\right)^3\\Psi^2 dz + \\int_0^{d/2} \\frac{g\\alpha\\beta_1 k^2}{\\nu_1\\kappa_1}\\Psi^2 dz + \\int_{d/2}^d \\frac{g\\alpha\\beta_2 k^2}{\\nu_2\\kappa_2}\\Psi^2 dz = 0. $$\n3.  Evaluate the integrals of $\\Psi^2 = \\sin^2(\\pi z/d)$. The total integral is $\\int_0^d \\Psi^2 dz = d/2$. The integral over each layer is $\\int_0^{d/2} \\Psi^2 dz = \\int_{d/2}^d \\Psi^2 dz = d/4$.\n4.  The equation simplifies to:\n$$ -\\left(\\frac{\\pi^2}{d^2}+k^2\\right)^3 \\frac{d}{2} + \\frac{g\\alpha\\beta_1 k^2}{\\nu_1\\kappa_1} \\frac{d}{4} + \\frac{g\\alpha\\beta_2 k^2}{\\nu_2\\kappa_2} \\frac{d}{4} = 0. $$\nMultiplying by $4/d$ yields:\n$$ -2\\left(\\frac{\\pi^2}{d^2}+k^2\\right)^3 + g\\alpha k^2\\left[\\frac{\\beta_1}{\\nu_1\\kappa_1}+\\frac{\\beta_2}{\\nu_2\\kappa_2}\\right] = 0. $$\n5.  Introduce the dimensionless wavenumber $a=kd$ and the Rayleigh number $Ra=\\frac{g\\alpha\\Delta Td^3}{\\nu_1\\kappa_1}$. We also use the given relations for $\\beta_i$ and the property ratios $\\gamma_\\mu = \\mu_2/\\mu_1 = \\nu_2/\\nu_1$ and $\\gamma_k=k_2/k_1=\\kappa_2/\\kappa_1$. The term in the brackets becomes:\n$$ \\frac{\\beta_1}{\\nu_1\\kappa_1}+\\frac{\\beta_2}{\\nu_2\\kappa_2} = \\frac{1}{\\nu_1\\kappa_1} \\left( \\beta_1 + \\beta_2 \\frac{\\nu_1\\kappa_1}{\\nu_2\\kappa_2} \\right) = \\frac{2\\Delta T}{d(\\gamma_k+1)\\nu_1\\kappa_1}\\left(\\gamma_k + \\frac{1}{\\gamma_\\mu\\gamma_k}\\right) = \\frac{2\\Delta T}{d(\\gamma_k+1)\\nu_1\\kappa_1}\\frac{1+\\gamma_\\mu\\gamma_k^2}{\\gamma_\\mu\\gamma_k}.$$\nSubstituting this into the stability equation gives:\n$$ 2\\left(\\frac{\\pi^2+a^2}{d^2}\\right)^3 = \\frac{g\\alpha a^2}{d^2} \\frac{2\\Delta T}{d(\\gamma_k+1)\\nu_1\\kappa_1}\\frac{1+\\gamma_\\mu\\gamma_k^2}{\\gamma_\\mu\\gamma_k}. $$\nRearranging to solve for $Ra$:\n$$ Ra(a) = \\frac{g\\alpha\\Delta Td^3}{\\nu_1\\kappa_1} = \\frac{(\\pi^2+a^2)^3}{a^2} \\frac{\\gamma_\\mu\\gamma_k(\\gamma_k+1)}{1+\\gamma_\\mu\\gamma_k^2}. $$\n6.  To find the critical Rayleigh number $Ra_c$, we minimize $Ra(a)$ with respect to $a$. The minimum of the function $f(a) = (\\pi^2+a^2)^3/a^2$ occurs at $a_c^2=\\pi^2/2$.\n7.  At this critical wavenumber, the value of this function is $f(a_c) = (\\pi^2+\\pi^2/2)^3 / (\\pi^2/2) = (3\\pi^2/2)^3 / (\\pi^2/2) = \\frac{27\\pi^6/8}{\\pi^2/2} = \\frac{27\\pi^4}{4}$.\n8.  Therefore, the critical Rayleigh number is:\n$$ Ra_c = \\frac{27\\pi^4}{4}\\,\\frac{\\gamma_\\mu\\gamma_k(\\gamma_k+1)}{1+\\gamma_\\mu\\gamma_k^2}. $$", "answer": "$$\\boxed{\\frac{27\\pi^4}{4}\\,\\frac{\\gamma_\\mu\\gamma_k(\\gamma_k+1)}{1+\\gamma_\\mu\\gamma_k^2}}$$", "id": "471641"}]}