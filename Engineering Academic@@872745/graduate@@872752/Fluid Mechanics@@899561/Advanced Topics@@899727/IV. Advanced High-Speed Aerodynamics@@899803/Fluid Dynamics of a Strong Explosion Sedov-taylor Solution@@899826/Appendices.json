{"hands_on_practices": [{"introduction": "The cornerstone of the Sedov-Taylor solution is its self-similar nature, which can be powerfully explored using dimensional analysis. This practice challenges you to derive the fundamental scaling laws that govern a blast wave's expansion not just in a uniform medium, but in a more general environment with a power-law density profile. By mastering this technique, you will gain a deeper intuition for how the physics of the surrounding medium directly shapes the dynamics of the shock.", "problem": "Consider a strong point-like explosion that releases a finite amount of energy $E$ at time $t=0$ and position $r=0$. This explosion occurs in a non-uniform, cold gas that is initially at rest. The ambient density of this gas, $\\rho_0(r)$, is not constant but varies with the radial distance $r$ from the explosion center according to a power-law:\n$$\n\\rho_0(r) = C r^{-\\omega}\n$$\nwhere $C$ and $\\omega$ are positive constants.\n\nThe explosion drives a strong spherical shock wave outwards. The pressure behind the shock is assumed to be immensely greater than the ambient pressure, so the ambient pressure and the initial internal energy of the gas can be neglected. Under these conditions, the flow is self-similar. The radius of the shock front, $R(t)$, can be found through dimensional analysis. It is given that the shock trajectory also follows a power law in time:\n$$\nR(t) \\propto t^\\alpha\n$$\nwhere $\\alpha$ is a constant exponent.\n\nAssuming that the shock radius $R$ at time $t$ depends only on the explosion energy $E$, the time $t$ since the explosion, and the ambient density parameter $C$, derive the required power-law exponent $\\omega$ of the ambient density profile as a function of the temporal exponent $\\alpha$ of the shock front trajectory.", "solution": "1. By dimensional analysis, let the shock radius scale as\n$$\nR\\propto E^a\\,C^b\\,t^c.\n$$\nDimensions: $[E]=M\\,L^2\\,T^{-2}$, $[C]=M\\,L^{-3+\\omega}$, $[t]=T$, $[R]=L$.  \nHence\n$$\nL:\\;1=2a+(-3+\\omega)b,\n\\quad\nM:\\;0=a+b,\n\\quad\nT:\\;0=-2a+c.\n$$\n\n2. From $a+b=0$ we get $b=-a$.  From $-2a+c=0$ we get $c=2a$.\n\n3. Substituting into $2a+(-3+\\omega)(-a)=1$ gives\n$$\n2a+a(3-\\omega)=1\n\\;\\Longrightarrow\\;\na\\,(5-\\omega)=1\n\\;\\Longrightarrow\\;\na=\\frac1{5-\\omega},\n\\quad\nc=2a=\\frac{2}{5-\\omega}.\n$$\n\n4. The temporal exponent $\\alpha$ is $c$, so\n$$\n\\alpha=\\frac{2}{5-\\omega}\n\\;\\Longrightarrow\\;\n5-\\omega=\\frac{2}{\\alpha}\n\\;\\Longrightarrow\\;\n\\omega=5-\\frac{2}{\\alpha}.\n$$", "answer": "$$\\boxed{5 - \\frac{2}{\\alpha}}$$", "id": "516889"}, {"introduction": "While the total energy of a Sedov-Taylor blast wave is constant, it is dynamically partitioned between the kinetic energy of the expanding gas and its internal thermal energy. This exercise focuses on a fundamental property of the self-similar solution: the constant ratio between these two energy forms. By using a given integral relation derived from the governing equations, you will determine how this energy partition depends solely on the adiabatic index $\\gamma$ of the gas, providing insight into the explosion's thermodynamic structure.", "problem": "The Sedov-Taylor blast wave describes the evolution of a strong explosion in a uniform, cold medium. In this model, a fixed amount of energy $E_0$ is released instantaneously at a point in a medium of uniform initial density $\\rho_0$. Due to the conservation of energy and the self-similar nature of the flow, the total energy within the blast wave, $E_0$, is partitioned between the total kinetic energy, $E_K$, and the total internal energy, $E_I$, in a constant ratio that depends only on the adiabatic index $\\gamma$ of the gas.\n\nThe evolution of the system is governed by the Euler equations for a compressible, ideal gas. In spherical coordinates $(r, t)$, the flow variables velocity $u(r,t)$, density $\\rho(r,t)$, and pressure $p(r,t)$ can be expressed using dimensionless functions $V(\\xi), G(\\xi), P(\\xi)$ of the self-similar variable $\\xi = r/R(t)$, where $R(t)$ is the shock front radius:\n$$ u(r,t) = \\dot{R}(t) V(\\xi) $$\n$$ \\rho(r,t) = \\rho_0 G(\\xi) $$\n$$ p(r,t) = \\rho_0 \\dot{R}(t)^2 P(\\xi) $$\nHere, $\\dot{R}(t) = dR/dt$ is the shock velocity. The shock propagates according to $R(t) \\propto t^{2/5}$.\n\nThe dimensionless functions obey a system of ordinary differential equations. By manipulating these equations, one can derive the following integral relation which holds for the exact solution:\n$$ 5 E_K - 2 E_I = (3\\gamma-4) E_I $$\nThis relation connects the total kinetic and internal energies of the gas within the blast wave. You are to take this relation as given.\n\nYour task is to derive an expression for the ratio of the total internal energy to the total kinetic energy, $E_I/E_K$, for the gas inside the blast wave as a function of the adiabatic index $\\gamma$.", "solution": "The problem requires us to find the ratio $E_I/E_K$ for a Sedov-Taylor blast wave, given an integral relation connecting these two quantities.\n\n1.  **State the given information:**\n    The total energy of the blast wave is the sum of its kinetic and internal energy components:\n    $$ E_0 = E_K + E_I $$\n    The problem provides the following integral relation derived from the fluid dynamics equations governing the self-similar flow:\n    $$ 5 E_K - 2 E_I = (3\\gamma-4) E_I $$\n\n2.  **Simplify the given relation:**\n    The provided relation can be simplified by grouping the terms involving $E_I$:\n    $$ 5 E_K = (3\\gamma-4) E_I + 2 E_I $$\n    $$ 5 E_K = (3\\gamma - 4 + 2) E_I $$\n    $$ 5 E_K = (3\\gamma - 2) E_I $$\n\n3.  **Solve for the desired ratio:**\n    The goal is to find the ratio $E_I/E_K$. We can rearrange the simplified equation to solve for this ratio directly.\n    $$ \\frac{E_I}{E_K} = \\frac{5}{3\\gamma - 2} $$\n\nThis expression gives the ratio of the total internal energy to the total kinetic energy solely in terms of the adiabatic index $\\gamma$.\n\n*Self-consistency check:*\nWe can also derive the partition of energy with respect to the total energy $E_0$.\nFrom the derived ratio, we have $E_I = \\frac{5}{3\\gamma - 2} E_K$.\nSubstitute this into the total energy equation $E_0 = E_K + E_I$:\n$$ E_0 = E_K + \\frac{5}{3\\gamma - 2} E_K $$\n$$ E_0 = E_K \\left(1 + \\frac{5}{3\\gamma - 2}\\right) $$\n$$ E_0 = E_K \\left(\\frac{3\\gamma - 2 + 5}{3\\gamma - 2}\\right) $$\n$$ E_0 = E_K \\left(\\frac{3\\gamma + 3}{3\\gamma - 2}\\right) = E_K \\frac{3(\\gamma+1)}{3\\gamma-2} $$\nThis gives the kinetic energy as a fraction of total energy:\n$$ \\frac{E_K}{E_0} = \\frac{3\\gamma - 2}{3(\\gamma+1)} $$\nAnd for the internal energy:\n$$ \\frac{E_I}{E_0} = \\frac{E_K}{E_0} \\frac{E_I}{E_K} = \\frac{3\\gamma - 2}{3(\\gamma+1)} \\frac{5}{3\\gamma - 2} = \\frac{5}{3(\\gamma+1)} $$\nThe sum of these fractions should be 1:\n$$ \\frac{E_K}{E_0} + \\frac{E_I}{E_0} = \\frac{3\\gamma - 2}{3(\\gamma+1)} + \\frac{5}{3(\\gamma+1)} = \\frac{3\\gamma - 2 + 5}{3(\\gamma+1)} = \\frac{3\\gamma + 3}{3(\\gamma+1)} = \\frac{3(\\gamma+1)}{3(\\gamma+1)} = 1 $$\nThe results are consistent. The final answer required is the ratio $E_I/E_K$.", "answer": "$$ \\boxed{\\frac{5}{3\\gamma - 2}} $$", "id": "516864"}, {"introduction": "Beyond analytical theory, numerical simulation is an indispensable tool in modern fluid dynamics. This comprehensive practice guides you through the process of developing a one-dimensional hydrodynamics code to model a spherical blast wave from first principles. You will implement a finite-volume, shock-capturing scheme and use your simulation to numerically verify the celebrated $R(t) \\propto t^{2/5}$ scaling law, providing a powerful link between the Euler equations and the Sedov-Taylor solution.", "problem": "You must write a complete, runnable program that simulates a one-dimensional spherically symmetric blast wave driven by an instantaneous energy deposition at the origin and verifies the self-similar scaling of the shock radius. Start from the conservation laws for the compressible Euler equations, the Ideal Gas Law, and geometric relations in spherical coordinates. The conserved state per unit volume is $U = (\\rho, \\rho u, E)$, where $\\rho$ is the mass density, $u$ is the radial velocity, and $E$ is the total energy density, with the relation $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$ for ideal gas pressure $p$ and heat capacity ratio $\\gamma$. In spherical symmetry, the finite-volume integral form over a spherical shell with inner radius $r_{i-1/2}$ and outer radius $r_{i+1/2}$, shell volume $V_{i} = \\tfrac{4\\pi}{3}\\left(r_{i+1/2}^{3} - r_{i-1/2}^{3}\\right)$, and interface areas $A_{i\\pm 1/2} = 4\\pi r_{i\\pm 1/2}^{2}$, is\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(U_{i}V_{i}\\right) = - \\left(F_{i+1/2}A_{i+1/2} - F_{i-1/2}A_{i-1/2}\\right),\n$$\nwhere the physical flux in the radial direction is $F(U) = \\left(\\rho u,\\ \\rho u^{2} + p,\\ u(E + p)\\right)$. This geometrically faithful integral form automatically accounts for spherical geometric effects. Implement a first-order, shock-capturing finite-volume method using the Local Lax-Friedrichs (LLF), also known as the Rusanov, numerical flux at each interface,\n$$\nF^{\\ast} = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2} a_{\\max}\\left(U_{R} - U_{L}\\right),\n$$\nwith $a_{\\max} = \\max\\left(\\lvert u_{L}\\rvert + c_{L}, \\lvert u_{R}\\rvert + c_{R}\\right)$ and $c = \\sqrt{\\gamma p/\\rho}$ the sound speed. Use a Courant-Friedrichs-Lewy (CFL) time step condition $ \\Delta t = \\mathrm{CFL}\\,\\Delta r / \\max_{i}(\\lvert u_{i}\\rvert + c_{i})$, where $\\Delta r$ is the uniform radial grid spacing. Impose a reflecting boundary at $r = 0$ and an outflow (zero-gradient) boundary at the outer radius.\n\nInitialize a uniform ambient state of density $\\rho_{0}$ and pressure $p_{0}$ with zero velocity, and deposit a finite explosion energy $E_{0}$ (in Joules) as additional internal energy uniformly within a small sphere of radius $R_{\\mathrm{dep}} = 3\\Delta r$ around the origin at $t = 0$. The ideal gas constant is specified by the ratio $\\gamma$ and you must use the Ideal Gas Law to convert between energy and pressure. Use the International System of Units (SI): meters for length, kilograms per cubic meter for density, Pascals for pressure, and seconds for time.\n\nLet $R(t)$ denote the shock radius inferred numerically as the outermost cell center radius where the pressure exceeds a specified threshold above the ambient value (for definiteness: $p > 1.2\\,p_{0}$). Record $R(t)$ at evenly spaced times between a start time $t_{\\mathrm{start}}$ and a final time $t_{\\mathrm{end}}$ and then estimate the scaling exponent $n$ from a linear regression of $\\log R$ versus $\\log t$. The classic Sedov-Taylor similarity solution for a point explosion in three dimensions predicts $R \\propto t^{2/5}$ in the strong shock limit. Your program must compute the absolute error $\\lvert n - 2/5\\rvert$ for each test case.\n\nPhysical units: All inputs and internal calculations must be interpreted in SI units. The final reported errors are dimensionless numbers.\n\nAlgorithmic requirements:\n- Discretize the spherical domain $[0, R_{\\max}]$ into $N$ uniform radial cells with edges at $r_{j+1/2} = j\\,\\Delta r$ for $j = 0,1,\\dots,N$ and $\\Delta r = R_{\\max}/N$.\n- Use a first-order finite-volume update with the Rusanov flux and a time step constrained by the CFL condition.\n- Use $\\gamma = 1.4$, $\\rho_{0} = 1.0$ (in $\\mathrm{kg/m^{3}}$), $p_{0} = 100.0$ (in $\\mathrm{Pa}$), and a pressure floor to ensure positivity.\n- Detect $R(t)$ as the outermost cell center radius satisfying $p > 1.2\\,p_{0}$ at the sampling times.\n\nTest suite:\nFor each parameter tuple $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max})$, use $t_{\\mathrm{start}} = 0.2\\,t_{\\mathrm{end}}$ and sample $R(t)$ at $20$ evenly spaced times between $t_{\\mathrm{start}}$ and $t_{\\mathrm{end}}$ (inclusive). Use the following four test cases:\n- Case $1$: $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (160, 0.5, 1.0, 0.05, 1.0)$.\n- Case $2$: $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (100, 0.5, 1.0, 0.05, 1.0)$.\n- Case $3$: $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (160, 0.4, 0.5, 0.05, 1.0)$.\n- Case $4$: $(N, \\mathrm{CFL}, E_{0}, t_{\\mathrm{end}}, R_{\\max}) = (200, 0.6, 2.0, 0.08, 1.2)$.\n\nRequired final output format:\nYour program should produce a single line of output containing the absolute exponent errors for the four cases as a comma-separated list enclosed in square brackets (for example, $\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]$), where each result is a decimal rounded to three decimal places.", "solution": "The problem as stated is a standard, well-posed problem in computational fluid dynamics. It requires the numerical simulation of a spherically symmetric blast wave, a phenomenon described by the Sedov-Taylor self-similar solution in the strong shock limit. The problem is scientifically grounded, using the compressible Euler equations and the ideal gas law. All necessary parameters, initial conditions, boundary conditions, and the numerical method are specified, allowing for a unique and meaningful solution. The minor ambiguity in the grid definition can be resolved by interpreting it as a standard cell-based grid structure. Therefore, the problem is deemed valid and a rigorous solution is provided.\n\nThe simulation models the evolution of the fluid state governed by the Euler equations in one-dimensional spherical coordinates. The conserved state vector per unit volume is $U = (\\rho, \\rho u, E)$, representing mass density, radial momentum density, and total energy density, respectively. The system is closed by the ideal gas equation of state, $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$, where $p$ is the pressure and $\\gamma$ is the heat capacity ratio.\n\nWe employ a finite-volume method on a uniform radial grid. The domain $[0, R_{\\max}]$ is discretized into $N$ cells. Cell $i$, for $i=0, \\dots, N-1$, occupies the spherical shell between radii $r_i = i\\Delta r$ and $r_{i+1} = (i+1)\\Delta r$, where $\\Delta r = R_{\\max}/N$. The cell volume is $V_i = \\frac{4\\pi}{3}(r_{i+1}^3 - r_i^3)$, and the interface areas are $A_k = 4\\pi r_k^2$. The discrete state $U_i$ represents the cell-averaged value of the conserved quantities in cell $i$.\n\nThe time evolution of the state in each cell is governed by the integral form of the conservation laws, which ensures that geometric source terms are handled correctly. Using a first-order forward Euler time-stepping scheme, the update for cell $i$ is:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{V_i} \\left( F^*_{i+1} A_{i+1} - F^*_{i} A_{i} \\right)\n$$\nHere, $U_i^n$ is the state at time $t_n$, $\\Delta t$ is the time step, and $F^*_{k}$ is the numerical flux at the interface with radius $r_k$.\n\nThe numerical flux $F^*$ is calculated using the Local Lax-Friedrichs (Rusanov) scheme, which is robust for problems involving shocks. At an interface between a left state $U_L$ and a right state $U_R$, the flux is:\n$$\nF^{\\ast}(U_L, U_R) = \\frac{1}{2}\\left(F(U_{L}) + F(U_{R})\\right) - \\frac{1}{2} a_{\\max}\\left(U_{R} - U_{L}\\right)\n$$\nwhere $F(U) = (\\rho u, \\rho u^2+p, u(E+p))^T$ is the physical flux. The dissipation term is controlled by $a_{\\max} = \\max(\\lvert u_L \\rvert + c_L, \\lvert u_R \\rvert + c_R)$, with $c = \\sqrt{\\gamma p / \\rho}$ being the sound speed.\n\nThe time step $\\Delta t$ is dynamically adjusted to satisfy the Courant-Friedrichs-Lewy (CFL) stability condition:\n$$\n\\Delta t = \\mathrm{CFL} \\frac{\\Delta r}{\\max_i(\\lvert u_i \\rvert + c_i)}\n$$\nwhere $\\mathrm{CFL}  1$ is the Courant number.\n\nThe initial state is a uniform, quiescent medium with density $\\rho_0$ and pressure $p_0$. An explosion is initiated by depositing a total energy $E_0$ uniformly into a small sphere of radius $R_{\\mathrm{dep}} = 3\\Delta r$ at the origin. This is modeled by increasing the total energy density $E$ in the affected cells by a constant amount $\\Delta E = E_0 / V_{\\mathrm{dep}}$, where $V_{\\mathrm{dep}} = \\frac{4\\pi}{3} R_{\\mathrm{dep}}^3$.\n\nBoundary conditions are handled using ghost cells. A reflecting boundary at the origin ($r=0$) is enforced by setting the ghost cell state to $(\\rho_0, -\\rho_0 u_0, E_0)$, where $(\\rho_0, u_0, E_0)$ are from the first physical cell. An outflow (zero-gradient) boundary at $r=R_{\\max}$ is enforced by copying the state from the last physical cell to its adjacent ghost cell.\n\nFor verification, the shock front radius $R(t)$ is tracked over time. This is defined as the center of the outermost cell where the pressure exceeds a threshold, $p > 1.2 p_0$. Samples of $(t, R(t))$ are taken within a specified time interval $[t_{\\mathrm{start}}, t_{\\mathrm{end}}]$. The Sedov-Taylor similarity solution predicts a power-law scaling, $R(t) \\propto t^n$, with an exponent of $n = 2/5$ for a three-dimensional blast wave. A linear regression is performed on $\\log(R)$ versus $\\log(t)$ to numerically estimate the exponent $n$. The absolute error $|n - 2/5|$ is then calculated to quantify the agreement between the simulation and theory.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef conserved_to_prim(U, gamma):\n    \"\"\"Converts a conserved state vector U to primitive variables (rho, u, p).\"\"\"\n    rho = U[..., 0]\n    mom = U[..., 1]\n    E_total = U[..., 2]\n    \n    # Add a floor for density to avoid division by zero\n    rho = np.maximum(rho, 1e-12)\n    \n    u = mom / rho\n    E_int = E_total - 0.5 * rho * u**2\n    p = (gamma - 1.0) * E_int\n    return rho, u, p\n\ndef prim_to_conserved(rho, u, p, gamma):\n    \"\"\"Converts primitive variables (rho, u, p) to a conserved state vector U.\"\"\"\n    mom = rho * u\n    E_total = p / (gamma - 1.0) + 0.5 * rho * u**2\n    return np.array([rho, mom, E_total])\n\ndef get_physical_flux(U, gamma):\n    \"\"\"Computes the physical flux F(U) for a given conserved state U.\"\"\"\n    rho, u, p = conserved_to_prim(U, gamma)\n    E_total = U[2]\n    return np.array([rho * u, rho * u**2 + p, u * (E_total + p)])\n\ndef rusanov_flux(UL, UR, gamma):\n    \"\"\"Computes the Rusanov (Local Lax-Friedrichs) numerical flux.\"\"\"\n    rho_L, u_L, p_L = conserved_to_prim(UL, gamma)\n    rho_R, u_R, p_R = conserved_to_prim(UR, gamma)\n    \n    # Ensure pressure and density are positive for sound speed calculation\n    p_L, p_R = max(p_L, 1e-9), max(p_R, 1e-9)\n    rho_L, rho_R = max(rho_L, 1e-12), max(rho_R, 1e-12)\n    \n    cs_L = np.sqrt(gamma * p_L / rho_L)\n    cs_R = np.sqrt(gamma * p_R / rho_R)\n    \n    a_max = max(abs(u_L) + cs_L, abs(u_R) + cs_R)\n    \n    F_L = get_physical_flux(UL, gamma)\n    F_R = get_physical_flux(UR, gamma)\n    \n    return 0.5 * (F_L + F_R) - 0.5 * a_max * (UR - UL)\n\ndef run_simulation(params):\n    \"\"\"Runs a single blast wave simulation for a given set of parameters.\"\"\"\n    N, CFL, E_blast, t_end, R_max = params\n    gamma = 1.4\n    rho0 = 1.0\n    p0 = 100.0\n\n    # Grid setup\n    dr = R_max / float(N)\n    r_interfaces = np.linspace(0.0, R_max, N + 1)\n    r_centers = r_interfaces[:-1] + dr / 2.0\n    V_cells = (4.0 / 3.0) * np.pi * (r_interfaces[1:]**3 - r_interfaces[:-1]**3)\n    V_cells = np.maximum(V_cells, 1e-12)\n    A_interfaces = 4.0 * np.pi * r_interfaces**2\n\n    # Initial conditions\n    U = np.zeros((N, 3))\n    E_internal_ambient = p0 / (gamma - 1.0)\n    U[:, 0] = rho0\n    U[:, 2] = E_internal_ambient\n    \n    R_dep = 3.0 * dr\n    V_dep_sphere = (4.0/3.0) * np.pi * R_dep**3\n    \n    if V_dep_sphere > 0:\n        dE = E_blast / V_dep_sphere\n        dep_indices = np.where(r_centers  R_dep)[0]\n        U[dep_indices, 2] += dE\n    \n    # Simulation loop\n    t = 0.0\n    t_start = 0.2 * t_end\n    t_samples = np.linspace(t_start, t_end, 20)\n    sample_idx = 0\n    recorded_t = []\n    recorded_R = []\n\n    while t  t_end:\n        rho, vel, p = conserved_to_prim(U, gamma)\n        p = np.maximum(p, 1e-6 * p0) # Pressure floor\n        U[:, 2] = p / (gamma - 1.0) + 0.5 * rho * vel**2\n\n        cs = np.sqrt(gamma * p / rho)\n        max_speed = np.max(np.abs(vel) + cs)\n        dt = CFL * dr / max_speed if max_speed > 0 else 1e-6\n\n        t_old = t\n        t_new = t + dt\n\n        if sample_idx  len(t_samples) and t_samples[sample_idx] = t_new and t_samples[sample_idx] > t_old:\n            dt = t_samples[sample_idx] - t_old\n            t = t_samples[sample_idx]\n        else:\n            t = t_new\n\n        # Boundary conditions\n        U_ext = np.zeros((N + 2, 3))\n        U_ext[1:-1, :] = U\n        \n        rho_L_bnd, u_L_bnd, p_L_bnd = conserved_to_prim(U[0, :], gamma)\n        U_ext[0, :] = prim_to_conserved(rho_L_bnd, -u_L_bnd, p_L_bnd, gamma)\n        U_ext[-1, :] = U[-1, :]\n        \n        # Calculate fluxes at interfaces\n        F_star = np.zeros((N + 1, 3))\n        for i in range(N + 1):\n            F_star[i, :] = rusanov_flux(U_ext[i, :], U_ext[i + 1, :], gamma)\n            \n        # Update solution (vectorized)\n        flux_balance = F_star[1:, :] * A_interfaces[1:, np.newaxis] - F_star[:-1, :] * A_interfaces[:-1, np.newaxis]\n        U -= dt / V_cells[:, np.newaxis] * flux_balance\n        \n        # Record data\n        if sample_idx  len(t_samples) and abs(t - t_samples[sample_idx])  1e-9:\n            rho, _, p = conserved_to_prim(U, gamma)\n            shock_indices = np.where(p > 1.2 * p0)[0]\n            if len(shock_indices) > 0:\n                shock_idx = shock_indices[-1]\n                R_shock = r_centers[shock_idx]\n                recorded_t.append(t)\n                recorded_R.append(R_shock)\n\n            sample_idx += 1\n    \n    # Final analysis\n    if len(recorded_t)  2:\n        return 999.0\n\n    log_t = np.log(np.array(recorded_t))\n    log_R = np.log(np.array(recorded_R))\n    \n    valid_indices = np.isfinite(log_t)  np.isfinite(log_R)\n    if np.sum(valid_indices)  2:\n        return 999.0\n        \n    slope, _, _, _, _ = linregress(log_t[valid_indices], log_R[valid_indices])\n    \n    error = abs(slope - 2.0/5.0)\n    return error\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (160, 0.5, 1.0, 0.05, 1.0),\n        (100, 0.5, 1.0, 0.05, 1.0),\n        (160, 0.4, 0.5, 0.05, 1.0),\n        (200, 0.6, 2.0, 0.08, 1.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        error = run_simulation(case)\n        results.append(f\"{error:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2437110"}]}