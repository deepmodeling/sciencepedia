{"hands_on_practices": [{"introduction": "The atmospheric boundary layer is where the atmosphere \"feels\" the surface through friction, profoundly influencing weather and climate. This exercise explores how this friction interacts with a baroclinic atmosphere, where horizontal temperature gradients create a vertical shear in the geostrophic wind (the thermal wind). By deriving the surface wind shear in a classic Ekman layer model, you will gain physical insight into how surface drag modifies the large-scale flow, a critical process for forecasting winds, temperature, and turbulence near the ground [@problem_id:516461].", "problem": "Consider a steady-state flow in the atmospheric boundary layer on an f-plane, where $f$ is the constant Coriolis parameter. The flow is governed by a balance between the Coriolis force, the pressure gradient force, and turbulent friction. The horizontal momentum equation is given by:\n$$f \\mathbf{k} \\times \\mathbf{u} = -\\frac{1}{\\rho} \\nabla_h p + \\nu \\frac{\\partial^2 \\mathbf{u}}{\\partial z^2}$$\nwhere $\\mathbf{u}(z)$ is the horizontal velocity vector, $\\mathbf{k}$ is the upward unit vector, $\\rho$ is the constant air density, $p$ is the pressure, and $\\nu$ is the constant eddy viscosity.\n\nThe geostrophic wind, $\\mathbf{u}_g(z)$, is defined by the balance between the Coriolis and pressure gradient forces: $f \\mathbf{k} \\times \\mathbf{u}_g = -\\frac{1}{\\rho} \\nabla_h p$. The atmosphere is baroclinic, meaning there is a horizontal temperature gradient, which causes the geostrophic wind to vary with height. We model this variation as linear over the depth of the boundary layer:\n$$\\mathbf{u}_g(z) = \\mathbf{u}_{g0} + \\mathbf{S}_g z$$\nwhere $\\mathbf{u}_{g0}$ is the geostrophic wind at the surface ($z=0$), and $\\mathbf{S}_g = \\frac{d\\mathbf{u}_g}{dz}$ is the constant geostrophic wind shear vector (the thermal wind).\n\nThe flow is subject to the following boundary conditions:\n1. A no-slip condition at the surface: $\\mathbf{u}(0) = 0$.\n2. The wind approaches the geostrophic wind far above the surface: $\\mathbf{u}(z) \\to \\mathbf{u}_g(z)$ as $z \\to \\infty$.\n\nDerive an expression for the total horizontal wind shear vector, $\\frac{d\\mathbf{u}}{dz}$, at the surface $z=0$. Express the result in vector form in terms of $\\mathbf{u}_{g0}$, $\\mathbf{S}_g$, $f$, $\\nu$, and the unit vector $\\mathbf{k}$.", "solution": "We start from the steady‐state horizontal momentum equation  \n$$f\\,\\mathbf{k}\\times \\mathbf{u} \\;=\\; -\\frac{1}{\\rho}\\nabla_h p \\;+\\;\\nu\\,\\frac{\\partial^2\\mathbf{u}}{\\partial z^2}.$$  \nDefine the geostrophic wind by  \n$$f\\,\\mathbf{k}\\times \\mathbf{u}_g \\;=\\; -\\frac{1}{\\rho}\\nabla_h p,$$  \nso subtraction gives the ageostrophic balance  \n$$f\\,\\mathbf{k}\\times(\\mathbf{u}-\\mathbf{u}_g) \\;=\\;\\nu\\,\\frac{\\partial^2\\mathbf{u}}{\\partial z^2}.$$  \nBecause $\\mathbf{u}_g$ is linear in $z$, its second derivative is zero, so $\\frac{\\partial^2\\mathbf{u}}{\\partial z^2} = \\frac{\\partial^2(\\mathbf{u}-\\mathbf{u}_g)}{\\partial z^2}$. Let $\\mathbf{w}=\\mathbf{u}-\\mathbf{u}_g$, then  \n$$f\\,\\mathbf{k}\\times\\mathbf{w}=\\nu\\,\\mathbf{w}''(z).$$  \nIn complex form $W=w_x+i\\,w_y$ this is  \n$$f\\,i\\,W=\\nu\\,W''\\quad\\Rightarrow\\quad W''-i\\frac{f}{\\nu}W=0.$$  \nThe characteristic roots are  \n$$m=\\pm\\Big(\\frac{i\\,f}{\\nu}\\Big)^{1/2}=\\pm\\frac{1+i}{\\delta_E},\\qquad \\delta_E=\\sqrt{\\frac{2\\nu}{f}}.$$  \nThe boundary conditions on $\\mathbf{w}$ are $\\mathbf{w}(0) = \\mathbf{u}(0) - \\mathbf{u}_g(0) = -\\mathbf{u}_{g0}$ and $\\mathbf{w}(\\infty) \\to 0$. The decaying solution is  \n$$W(z)=-U_{g0}\\,\\exp\\!\\Big(-(1+i)\\frac{z}{\\delta_E}\\Big),\\quad U_{g0}=u_{g0x}+i\\,u_{g0y}.$$  \nDifferentiation gives  \n$$W'(z)=\\frac{1+i}{\\delta_E}U_{g0}\\,\\exp\\!\\Big(-(1+i)\\frac{z}{\\delta_E}\\Big)\\;\\Rightarrow\\;W'(0)=\\frac{1+i}{\\delta_E}U_{g0}.$$  \nNoting that multiplication by $i$ corresponds to $\\mathbf{k}\\times$ in vector form,  \n$$\\frac{d\\mathbf{w}}{dz}\\Big|_{0}=\\frac{1}{\\delta_E}\\big(\\mathbf{u}_{g0}+\\mathbf{k}\\times\\mathbf{u}_{g0}\\big).$$  \nFinally, since $\\frac{d\\mathbf{u}}{dz}=\\frac{d\\mathbf{w}}{dz}+\\frac{d\\mathbf{u}_g}{dz}$ and $\\frac{d\\mathbf{u}_g}{dz}=\\mathbf{S}_g$, we obtain  \n$$\\frac{d\\mathbf{u}}{dz}\\Big|_{0}=\\mathbf{S}_g+\\sqrt{\\frac{f}{2\\nu}}\\bigl(\\mathbf{u}_{g0}+\\mathbf{k}\\times\\mathbf{u}_{g0}\\bigr).$$", "answer": "$$\\boxed{\\mathbf{S}_g+\\sqrt{\\frac{f}{2\\nu}}\\bigl(\\mathbf{u}_{g0}+\\mathbf{k}\\times\\mathbf{u}_{g0}\\bigr)}$$", "id": "516461"}, {"introduction": "Modern weather forecasting begins with data assimilation, the process of creating the most accurate possible initial state of the atmosphere by blending observations with a model forecast. This process relies on statistical models of forecast errors that must respect the governing physical laws to be effective. This problem demonstrates a core principle by asking you to derive the statistical relationship (the cross-covariance) between wind and pressure fields, assuming their errors are linked by the geostrophic balance, a cornerstone technique in operational data assimilation systems [@problem_id:516520].", "problem": "In meteorological data assimilation, statistical models are used to describe the spatial structure of forecast errors. The relationship between the errors of different physical variables is constrained by the governing equations of atmospheric motion. For large-scale, slowly-evolving weather systems in the mid-latitudes, the geostrophic balance provides a fundamental link between the mass field, represented by geopotential height $Z$, and the wind field.\n\nConsider a two-dimensional horizontal domain $(x, y)$ where the atmospheric flow is in geostrophic balance. The geostrophic zonal wind (east-west component), $u_g$, is related to the geopotential height, $Z$, by the equation:\n$$\nu_g = -\\frac{g}{f_0} \\frac{\\partial Z}{\\partial y}\n$$\nwhere $g$ is the acceleration due to gravity, $f_0$ is the Coriolis parameter (assumed constant), and $y$ is the northward coordinate.\n\nThe forecast errors, or anomalies, in geopotential height, denoted by $Z'$, are assumed to be statistically homogeneous and isotropic. Their auto-covariance function, which describes the correlation of $Z'$ between two points $\\mathbf{r}_1 = (x_1, y_1)$ and $\\mathbf{r}_2 = (x_2, y_2)$, is given by a Gaussian model:\n$$\nC_{ZZ}(\\mathbf{r}_1, \\mathbf{r}_2) = \\langle Z'(\\mathbf{r}_1) Z'(\\mathbf{r}_2) \\rangle = \\sigma_Z^2 \\exp\\left(-\\frac{(\\Delta x)^2 + (\\Delta y)^2}{2L^2}\\right)\n$$\nwhere $\\Delta x = x_2 - x_1$ and $\\Delta y = y_2 - y_1$. Here, $\\sigma_Z^2$ is the variance of the geopotential height error, $L$ is the correlation length scale, and $\\langle \\cdot \\rangle$ denotes the statistical expectation operator.\n\nAssuming that the anomalies themselves, $u_g'$ and $Z'$, are related by the geostrophic approximation, derive the cross-covariance function between the geopotential height anomaly at point $\\mathbf{r}_1$ and the geostrophic zonal wind anomaly at point $\\mathbf{r}_2$, defined as $C_{Zu_g}(\\mathbf{r}_1, \\mathbf{r}_2) = \\langle Z'(\\mathbf{r}_1) u_g'(\\mathbf{r}_2) \\rangle$. Express your result as a function of the separation coordinates $\\Delta x$ and $\\Delta y$, and the parameters $g, f_0, \\sigma_Z$, and $L$.", "solution": "1. Geostrophic relation for anomalies:  \n$$u_g'(\\mathbf r_2)=-\\frac{g}{f_0}\\,\\frac{\\partial Z'(\\mathbf r_2)}{\\partial y_2}.$$  \n2. Definition of cross‐covariance:  \n$$C_{Zu_g}(\\mathbf r_1,\\mathbf r_2)=\\langle Z'(\\mathbf r_1)\\,u_g'(\\mathbf r_2)\\rangle.$$\nSubstitute $u_g'$:\n$$C_{Zu_g}(\\mathbf r_1,\\mathbf r_2)\n=-\\frac{g}{f_0}\\,\\Bigl\\langle Z'(\\mathbf r_1)\\,\\frac{\\partial Z'(\\mathbf r_2)}{\\partial y_2}\\Bigr\\rangle.$$\n3. Use homogeneity/isotropy: $C_{ZZ}(\\mathbf r_1,\\mathbf r_2)=C_{ZZ}(\\Delta x,\\Delta y)$ with\n$$C_{ZZ}(\\Delta x,\\Delta y)=\\sigma_Z^2\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$\nThen\n$$\\langle Z'(\\mathbf r_1)\\,\\partial_{y_2}Z'(\\mathbf r_2)\\rangle\n=\\frac{\\partial}{\\partial y_2}C_{ZZ}(\\Delta x,\\Delta y)\n=\\frac{\\partial}{\\partial(\\Delta y)}C_{ZZ}(\\Delta x,\\Delta y).$$  \n4. Differentiate:\n$$\\frac{\\partial}{\\partial(\\Delta y)}\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr)\n=-\\frac{\\Delta y}{L^2}\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$  \n5. Combine factors:\n$$C_{Zu_g}(\\Delta x,\\Delta y)\n=-\\frac{g}{f_0}\\,\\sigma_Z^2\\Bigl(-\\frac{\\Delta y}{L^2}\\Bigr)\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr)\n=\\frac{g\\,\\sigma_Z^2\\,\\Delta y}{f_0\\,L^2}\n\\exp\\Bigl(-\\frac{\\Delta x^2+\\Delta y^2}{2L^2}\\Bigr).$$", "answer": "$$\\boxed{\\frac{g\\,\\sigma_Z^2\\,\\Delta y}{f_0\\,L^2}\\exp\\Bigl(-\\frac{(\\Delta x)^2+(\\Delta y)^2}{2L^2}\\Bigr)}$$", "id": "516520"}, {"introduction": "Once a numerical weather prediction model is initialized, its core task is to solve the governing equations forward in time using discrete numerical methods. A poor choice of method can lead to unphysical solutions where errors grow exponentially, rendering the forecast useless. This exercise introduces the fundamental von Neumann stability analysis to determine the conditions under which a widely used advection scheme remains stable, providing an essential skill for developing and diagnosing the behavior of numerical models [@problem_id:516477].", "problem": "In numerical weather prediction, the advection of quantities like potential temperature or humidity is a fundamental process. A simple model for this is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the advected quantity and $c$ is a constant positive advection speed ($c  0$).\n\nTo solve this equation numerically, we discretize it on a grid with uniform spacing $\\Delta x$ in space and $\\Delta t$ in time. Let $U_j^n$ represent the numerical approximation of $u(j\\Delta x, n\\Delta t)$. A common explicit scheme is the first-order upwind, forward-in-time method. For $c  0$, \"upwind\" means the spatial derivative is approximated using values from the \"up-wind\" direction (i.e., the direction from which the flow originates), which is to the left. The scheme is given by:\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n\nThe stability of such a scheme can be analyzed using the von Neumann method. This involves examining the amplification of individual Fourier modes of the form $U_j^n = \\hat{U}(k)^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $\\hat{U}(k)^n$ is the amplitude at time step $n$. The amplitude evolves according to $\\hat{U}(k)^{n+1} = G(k) \\hat{U}(k)^n$, where $G(k)$ is the complex amplification factor per time step. For the scheme to be stable, the magnitude of the amplification factor must satisfy $|G(k)| \\le 1$ for all a priori possible wavenumbers $k$.\n\nThe shortest wavelength that can be represented on the grid is $\\lambda_{min} = 2 \\Delta x$, which corresponds to a \"zig-zag\" pattern between adjacent grid points.\n\nDerive the expression for the complex amplification factor, $G$, for the Fourier mode corresponding to this shortest resolvable wavelength, $\\lambda_{min} = 2 \\Delta x$. Express your answer in terms of the Courant number, $\\sigma = \\frac{c \\Delta t}{\\Delta x}$.", "solution": "The derivation begins with the provided finite difference equation for the first-order upwind, forward-in-time scheme:\n$$\n\\frac{U_j^{n+1} - U_j^n}{\\Delta t} + c \\frac{U_j^n - U_{j-1}^n}{\\Delta x} = 0\n$$\n\nFirst, we solve for the value at the next time step, $U_j^{n+1}$:\n$$\nU_j^{n+1} = U_j^n - \\frac{c \\Delta t}{\\Delta x} (U_j^n - U_{j-1}^n)\n$$\n\nWe introduce the Courant number, $\\sigma = \\frac{c \\Delta t}{\\Delta x}$. The equation becomes:\n$$\nU_j^{n+1} = U_j^n - \\sigma (U_j^n - U_{j-1}^n)\n$$\n$$\nU_j^{n+1} = (1 - \\sigma) U_j^n + \\sigma U_{j-1}^n\n$$\n\nNext, we apply the von Neumann stability analysis. We substitute a single Fourier mode solution of the form $U_j^n = G^n e^{i k j \\Delta x}$ into the discretized equation. Note that we can use $G^n$ as the time-dependent amplitude part, as it's the amplification factor we seek.\n$$\nG^{n+1} e^{i k j \\Delta x} = (1 - \\sigma) G^n e^{i k j \\Delta x} + \\sigma G^n e^{i k (j-1) \\Delta x}\n$$\n\nTo find the amplification factor $G$, we can divide the entire equation by $G^n e^{i k j \\Delta x}$ (assuming it is non-zero):\n$$\nG = (1 - \\sigma) + \\sigma \\frac{e^{i k j \\Delta x} e^{-i k \\Delta x}}{e^{i k j \\Delta x}}\n$$\n$$\nG = 1 - \\sigma + \\sigma e^{-i k \\Delta x}\n$$\nThis is the general expression for the amplification factor $G$ as a function of the wavenumber $k$.\n\nThe problem asks for the specific value of $G$ for the shortest resolvable wavelength on the grid, $\\lambda_{min} = 2 \\Delta x$. The wavenumber $k$ corresponding to this wavelength is:\n$$\nk = \\frac{2\\pi}{\\lambda_{min}} = \\frac{2\\pi}{2 \\Delta x} = \\frac{\\pi}{\\Delta x}\n$$\n\nNow, we evaluate the term $k \\Delta x$ which appears in the phase of the complex exponential in the expression for $G$:\n$$\nk \\Delta x = \\left(\\frac{\\pi}{\\Delta x}\\right) \\Delta x = \\pi\n$$\n\nSubstitute this value into the expression for $G$:\n$$\nG = 1 - \\sigma + \\sigma e^{-i \\pi}\n$$\n\nUsing Euler's identity, $e^{-i\\pi} = \\cos(-\\pi) + i\\sin(-\\pi) = \\cos(\\pi) - i\\sin(\\pi) = -1$.\n$$\nG = 1 - \\sigma + \\sigma(-1)\n$$\n$$\nG = 1 - \\sigma - \\sigma\n$$\n$$\nG = 1 - 2\\sigma\n$$\n\nThus, the amplification factor for the Fourier mode with the shortest resolvable wavelength is $1 - 2\\sigma$.", "answer": "$$\n\\boxed{1 - 2\\sigma}\n$$", "id": "516477"}]}