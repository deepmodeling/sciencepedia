{"hands_on_practices": [{"introduction": "This first exercise grounds our understanding of Bode analysis in the fundamental principles of stability. We will analyze a double integrator, a core building block in many control systems, deriving its frequency response characteristics directly from definitions. This practice is crucial for developing intuition about how open-loop Bode plots inform closed-loop stability, particularly through the careful calculation of gain and phase margins [@problem_id:2856172].", "problem": "Consider a single-input single-output Linear Time-Invariant (LTI) plant with transfer function $G(s)=\\dfrac{k}{s^{2}}$, where $k0$ is a real constant. The plant is placed in a unity negative-feedback configuration so that the loop transfer function is $L(s)=G(s)$. Starting only from the definitions of frequency response and Bode plots, perform the following.\n\n(a) Using the definition $G(\\mathrm{j}\\omega)$ of the sinusoidal steady-state frequency response, derive explicit analytic expressions for the Bode magnitude $|G(\\mathrm{j}\\omega)|$ and phase $\\angle G(\\mathrm{j}\\omega)$ as functions of $\\omega0$ and $k0$. Write the magnitude both as a linear gain $|G(\\mathrm{j}\\omega)|$ and as an amplitude in decibels $20\\log_{10}|G(\\mathrm{j}\\omega)|$. Express the phase in radians.\n\n(b) Determine the gain crossover frequency $\\omega_{\\mathrm{gc}}$ at which $|L(\\mathrm{j}\\omega_{\\mathrm{gc}})|=1$, and determine any phase crossover frequency $\\omega_{\\mathrm{pc}}$ at which $\\angle L(\\mathrm{j}\\omega_{\\mathrm{pc}})=-\\pi$ radians. State clearly whether $\\omega_{\\mathrm{pc}}$ is unique or not.\n\n(c) Using the standard loop-shaping definitions for unity feedback, compute the phase margin $\\mathrm{PM}$ and gain margin $\\mathrm{GM}$ implied by the Bode characteristics you derived. The phase margin is defined as $\\mathrm{PM}=\\pi+\\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}})$, to be reported in degrees, and the gain margin is defined as $\\mathrm{GM}=\\dfrac{1}{|L(\\mathrm{j}\\omega_{\\mathrm{pc}})|}$, to be reported as a dimensionless factor. If the definition involves a non-unique $\\omega_{\\mathrm{pc}}$, reason carefully from first principles to obtain the correct margin implied by the Nyquist interpretation of the Bode data for this loop.\n\nProvide, as your final deliverable, the phase margin in degrees and the gain margin as a dimensionless factor, in that order, as a row vector. No rounding is required. Angles must be in degrees, and the gain margin must be dimensionless.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of linear control theory and presents a complete, consistent set of data and definitions. The problem is valid.\n\nThe loop transfer function is given by $L(s) = G(s) = \\dfrac{k}{s^{2}}$, with $k0$.\n\n(a) Derivation of Bode Magnitude and Phase\n\nTo find the frequency response, we substitute $s = \\mathrm{j}\\omega$, where $\\mathrm{j} = \\sqrt{-1}$ and $\\omega$ is the angular frequency in radians per second.\n$$\nL(\\mathrm{j}\\omega) = G(\\mathrm{j}\\omega) = \\frac{k}{(\\mathrm{j}\\omega)^2} = \\frac{k}{\\mathrm{j}^2 \\omega^2} = \\frac{k}{(-1)\\omega^2} = -\\frac{k}{\\omega^2}\n$$\nThis expression for the frequency response is a purely real and negative number for all frequencies $\\omega  0$.\n\nThe Bode magnitude, or linear gain, is the absolute value of the frequency response:\n$$\n|G(\\mathrm{j}\\omega)| = \\left| -\\frac{k}{\\omega^2} \\right|\n$$\nSince $k  0$ and $\\omega^2  0$, the magnitude is:\n$$\n|G(\\mathrm{j}\\omega)| = \\frac{k}{\\omega^2}\n$$\nThe magnitude in decibels (dB) is defined as $20\\log_{10}|G(\\mathrm{j}\\omega)|$:\n$$\nM_{\\text{dB}}(\\omega) = 20\\log_{10}\\left(\\frac{k}{\\omega^2}\\right) = 20\\log_{10}(k) - 20\\log_{10}(\\omega^2) = 20\\log_{10}(k) - 40\\log_{10}(\\omega)\n$$\n\nThe Bode phase is the argument (angle) of the complex number $G(\\mathrm{j}\\omega)$. Since $G(\\mathrm{j}\\omega) = -k/\\omega^2$ is a negative real number for all $\\omega  0$, its phase is constant. A negative real number $z = -x$, with $x0$, can be written in polar form as $x \\exp(\\mathrm{j}(-\\pi + 2n\\pi))$ for any integer $n$. The principal value of the argument is $-\\pi$ radians. In the context of transfer functions, a double pole at the origin contributes a phase shift of $2 \\times (-\\frac{\\pi}{2}) = -\\pi$ radians.\n$$\n\\angle G(\\mathrm{j}\\omega) = \\angle\\left(-\\frac{k}{\\omega^2}\\right) = -\\pi \\text{ radians}\n$$\nThis phase is constant for all $\\omega  0$.\n\n(b) Determination of Crossover Frequencies\n\nThe gain crossover frequency, $\\omega_{\\mathrm{gc}}$, is the frequency at which the magnitude of the loop transfer function is unity, i.e., $|L(\\mathrm{j}\\omega_{\\mathrm{gc}})| = 1$.\nUsing the magnitude expression from part (a):\n$$\n\\frac{k}{\\omega_{\\mathrm{gc}}^2} = 1 \\implies \\omega_{\\mathrm{gc}}^2 = k\n$$\nSince frequency must be positive, we take the positive square root:\n$$\n\\omega_{\\mathrm{gc}} = \\sqrt{k}\n$$\nThe phase crossover frequency, $\\omega_{\\mathrm{pc}}$, is the frequency at which the phase of the loop transfer function is $-\\pi$ radians, i.e., $\\angle L(\\mathrm{j}\\omega_{\\mathrm{pc}}) = -\\pi$.\nFrom part (a), we found that $\\angle L(\\mathrm{j}\\omega) = -\\pi$ for all $\\omega  0$. Therefore, the condition for the phase crossover is met for every positive frequency. The phase crossover frequency is not unique; any $\\omega  0$ is a phase crossover frequency.\n\n(c) Computation of Stability Margins\n\nThe phase margin ($\\mathrm{PM}$) is defined as $\\mathrm{PM} = \\pi + \\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}})$.\nFirst, we evaluate the phase at the gain crossover frequency $\\omega_{\\mathrm{gc}} = \\sqrt{k}$.\n$$\n\\angle L(\\mathrm{j}\\omega_{\\mathrm{gc}}) = \\angle L(\\mathrm{j}\\sqrt{k}) = -\\pi \\text{ radians}\n$$\nSubstituting this into the definition of phase margin:\n$$\n\\mathrm{PM} = \\pi + (-\\pi) = 0 \\text{ radians}\n$$\nThe problem requires the phase margin in degrees. Converting from radians to degrees:\n$$\n\\mathrm{PM} = 0 \\text{ rad} \\times \\frac{180^\\circ}{\\pi \\text{ rad}} = 0^\\circ\n$$\nThe gain margin ($\\mathrm{GM}$) is defined as $\\mathrm{GM} = \\dfrac{1}{|L(\\mathrm{j}\\omega_{\\mathrm{pc}})|}$.\nAs established, $\\omega_{\\mathrm{pc}}$ is not unique. The concept of gain margin is to quantify the system's robustness to gain variations. It measures how far the system is from the instability point on the negative real axis, which is the point $(-1, \\mathrm{j}0)$. Instability occurs if the Nyquist plot of $L(s)$ encircles this point. The critical condition for marginal stability is when the plot passes through the $-1$ point, which means $|L(\\mathrm{j}\\omega)| = 1$ and $\\angle L(\\mathrm{j}\\omega) = -\\pi$ simultaneously.\nIn this specific problem, the phase is always $-\\pi$. Therefore, the critical frequency for stability is the one at which the magnitude is $1$. This is precisely the gain crossover frequency, $\\omega_{\\mathrm{gc}} = \\sqrt{k}$.\nThe most logical interpretation in this case, consistent with the Nyquist stability criterion, is to evaluate the gain margin at this critical frequency where both conditions for marginal stability are met. We thus select $\\omega_{\\mathrm{pc}} = \\omega_{\\mathrm{gc}} = \\sqrt{k}$.\nNow we compute the magnitude at this frequency:\n$$\n|L(\\mathrm{j}\\omega_{\\mathrm{pc}})| = |L(\\mathrm{j}\\sqrt{k})| = \\frac{k}{(\\sqrt{k})^2} = \\frac{k}{k} = 1\n$$\nSubstituting this into the definition of gain margin:\n$$\n\\mathrm{GM} = \\frac{1}{1} = 1\n$$\nA phase margin of $0^\\circ$ and a gain margin of $1$ (or $0$ dB) both indicate a system that is marginally stable. This is confirmed by analyzing the closed-loop transfer function $T(s) = \\frac{L(s)}{1+L(s)} = \\frac{k/s^2}{1+k/s^2} = \\frac{k}{s^2+k}$. The closed-loop poles are at $s = \\pm\\mathrm{j}\\sqrt{k}$, which lie on the imaginary axis, confirming that the system is indeed marginally stable.\nThe required deliverables are the phase margin in degrees and the dimensionless gain margin.\n\nPhase Margin: $\\mathrm{PM} = 0^\\circ$.\nGain Margin: $\\mathrm{GM} = 1$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1\n\\end{pmatrix}\n}\n$$", "id": "2856172"}, {"introduction": "While exact calculations are essential, engineers often rely on straight-line approximations to quickly sketch Bode plots. This practice explores the validity of these asymptotes by quantifying the error for a standard second-order system. By calculating the maximum deviation for various damping ratios, you will gain a deeper appreciation for the concept of resonance and how the parameter $\\zeta$ governs the accuracy of the approximation near the natural frequency [@problem_id:2856164].", "problem": "Consider the standard second-order low-pass factor with unit static gain,\n$$\nH(s) \\;=\\; \\frac{\\omega_{n}^{2}}{s^{2} \\,+\\, 2\\,\\zeta\\,\\omega_{n}\\,s \\,+\\, \\omega_{n}^{2}}\\,,\n$$\nwhere $\\omega_{n} \\!\\! 0$ is the natural frequency and $\\zeta \\!\\! 0$ is the damping ratio. The Bode magnitude plot in decibels (decibel (dB)) uses the definition\n$$\nM_{\\mathrm{dB}}(\\omega) \\;=\\; 20\\,\\log_{10}\\!\\bigl(|H(j\\omega)|\\bigr)\\,.\n$$\nAdopt the conventional straight-line Bode magnitude asymptote for this second-order denominator: a constant line at $0$ decibels for $\\omega \\le \\omega_{n}$ and a line of slope $-40$ decibels per decade for $\\omega \\ge \\omega_{n}$, with break at $\\omega=\\omega_{n}$. For each damping ratio $\\zeta \\in \\bigl\\{\\,1,\\; 1/\\sqrt{2},\\; 0.2\\,\\bigr\\}$, define the decibel magnitude error over the one-decade band around $\\omega_{n}$ as\n$$\nE_{\\mathrm{dB}}(\\omega;\\zeta) \\;=\\; 20\\,\\log_{10}\\!\\bigl(|H(j\\omega)|\\bigr) \\;-\\; L_{\\mathrm{dB}}(\\omega)\\,,\n$$\nwhere $L_{\\mathrm{dB}}(\\omega)$ denotes the adopted straight-line approximation. Using only fundamental frequency-response definitions and the stated asymptote construction, determine, for each listed $\\zeta$, the maximum of $|E_{\\mathrm{dB}}(\\omega;\\zeta)|$ over $\\omega \\in \\bigl[\\,0.1\\,\\omega_{n},\\,10\\,\\omega_{n}\\,\\bigr]$. Then take the largest of these three maxima (the single worst-case decibel error across the three damping ratios over the stated band).\n\nReport that single worst-case maximum decibel error as a real number in decibels. Round your answer to four significant figures. Express the final answer in decibels (dB).", "solution": "The problem requires the determination of the maximum approximation error for the Bode magnitude plot of a standard second-order system, considering a specific set of damping ratios. The error is defined as the difference between the true magnitude in decibels, $M_{\\mathrm{dB}}(\\omega)$, and its straight-line asymptotic approximation, $L_{\\mathrm{dB}}(\\omega)$.\n\nThe transfer function is given as\n$$H(s) = \\frac{\\omega_{n}^{2}}{s^{2} + 2\\zeta\\omega_{n}s + \\omega_{n}^{2}}$$\nTo find the frequency response, we substitute $s = j\\omega$, where $j = \\sqrt{-1}$:\n$$H(j\\omega) = \\frac{\\omega_{n}^{2}}{(j\\omega)^{2} + 2\\zeta\\omega_{n}(j\\omega) + \\omega_{n}^{2}} = \\frac{\\omega_{n}^{2}}{(\\omega_{n}^{2} - \\omega^{2}) + j(2\\zeta\\omega_{n}\\omega)}$$\nThe magnitude of the frequency response is\n$$|H(j\\omega)| = \\frac{\\omega_{n}^{2}}{\\sqrt{(\\omega_{n}^{2} - \\omega^{2})^{2} + (2\\zeta\\omega_{n}\\omega)^{2}}}$$\nIt is convenient to work with a normalized frequency $u = \\frac{\\omega}{\\omega_{n}}$. Substituting $\\omega = u\\omega_{n}$ into the expression for the magnitude gives:\n$$|H(j\\omega)| = \\frac{\\omega_{n}^{2}}{\\sqrt{(\\omega_{n}^{2} - u^{2}\\omega_{n}^{2})^{2} + (2\\zeta\\omega_{n}u\\omega_{n})^{2}}} = \\frac{\\omega_{n}^{2}}{\\omega_{n}^{2}\\sqrt{(1 - u^{2})^{2} + (2\\zeta u)^{2}}} = \\frac{1}{\\sqrt{(1 - u^{2})^{2} + (2\\zeta u)^{2}}}$$\nThe true magnitude in decibels, $M_{\\mathrm{dB}}$, is defined as $M_{\\mathrm{dB}}(u) = 20\\log_{10}(|H(j\\omega)|)$.\n$$M_{\\mathrm{dB}}(u) = 20\\log_{10}\\left(\\left((1 - u^{2})^{2} + (2\\zeta u)^{2}\\right)^{-1/2}\\right) = -10\\log_{10}\\left((1 - u^{2})^{2} + (2\\zeta u)^{2}\\right)$$\nThe straight-line asymptotic approximation, $L_{\\mathrm{dB}}$, is given with a break frequency at $\\omega = \\omega_{n}$ (or $u=1$):\n- For $\\omega \\le \\omega_{n}$ ($u \\le 1$): $L_{\\mathrm{dB}}(u) = 0$ dB.\n- For $\\omega \\ge \\omega_{n}$ ($u \\ge 1$): The slope is $-40$ dB/decade. This corresponds to the form $L_{\\mathrm{dB}}(\\omega) = -40\\log_{10}(\\omega) + C$. Since $L_{\\mathrm{dB}}(\\omega_{n})=0$, we have $0 = -40\\log_{10}(\\omega_{n}) + C$, which gives $C = 40\\log_{10}(\\omega_{n})$. Thus, $L_{\\mathrm{dB}}(\\omega) = -40\\log_{10}(\\omega/\\omega_{n})$. In terms of $u$, this is $L_{\\mathrm{dB}}(u) = -40\\log_{10}(u)$.\n\nThe decibel magnitude error is $E_{\\mathrm{dB}}(\\omega;\\zeta) = M_{\\mathrm{dB}}(\\omega) - L_{\\mathrm{dB}}(\\omega)$. In terms of $u$:\n- For $u \\le 1$:\n$$E_{\\mathrm{dB}}(u;\\zeta) = -10\\log_{10}\\left((1 - u^{2})^{2} + 4\\zeta^{2}u^{2}\\right) - 0 = -10\\log_{10}\\left((1 - u^{2})^{2} + 4\\zeta^{2}u^{2}\\right)$$\n- For $u \\ge 1$:\n$$E_{\\mathrm{dB}}(u;\\zeta) = -10\\log_{10}\\left((1 - u^{2})^{2} + (2\\zeta u)^{2}\\right) - (-40\\log_{10}(u))$$\n$$E_{\\mathrm{dB}}(u;\\zeta) = 10\\log_{10}\\left(u^{4}\\right) - 10\\log_{10}\\left((u^{2}-1)^{2} + 4\\zeta^{2}u^{2}\\right) = 10\\log_{10}\\left(\\frac{u^{4}}{(u^{2}-1)^{2} + 4\\zeta^{2}u^{2}}\\right)$$\nWe must find the maximum of $|E_{\\mathrm{dB}}(u;\\zeta)|$ over the normalized frequency band $u \\in [0.1, 10]$ for each of the three specified values of $\\zeta$.\n\nCase 1: $\\zeta = 1$ (Critically damped)\n- For $u \\in [0.1, 1]$: $E_{\\mathrm{dB}}(u;1) = -10\\log_{10}\\left((1-u^{2})^{2} + 4u^{2}\\right) = -10\\log_{10}\\left(1-2u^{2}+u^{4}+4u^{2}\\right) = -10\\log_{10}\\left(u^{4}+2u^{2}+1\\right) = -10\\log_{10}\\left((u^{2}+1)^{2}\\right) = -20\\log_{10}(u^{2}+1)$. This function is monotonic over $[0.1, 1]$. The extreme values of the error are at the endpoints. At $u=0.1$, $E_{\\mathrm{dB}}(0.1;1) = -20\\log_{10}(1.01) \\approx -0.087$ dB. At $u=1$, $E_{\\mathrm{dB}}(1;1) = -20\\log_{10}(2) \\approx -6.021$ dB.\n- For $u \\in [1, 10]$: $E_{\\mathrm{dB}}(u;1) = 10\\log_{10}\\left(\\frac{u^{4}}{(u^{2}-1)^{2} + 4u^{2}}\\right) = 10\\log_{10}\\left(\\frac{u^{4}}{(u^{2}+1)^{2}}\\right)$. This function is monotonic over $[1, 10]$. At $u=10$, $E_{\\mathrm{dB}}(10;1) = 10\\log_{10}\\left(\\frac{10^{4}}{101^{2}}\\right) \\approx -0.086$ dB.\nThe error function $E_{\\mathrm{dB}}(u;1)$ is always negative. Its absolute value is maximized at $u=1$.\nMaximum error for $\\zeta=1$: $|E_{\\mathrm{dB}}(1;1)| = |-20\\log_{10}(2)| \\approx 6.021$ dB.\n\nCase 2: $\\zeta = 1/\\sqrt{2}$ (Butterworth response)\n- For $u \\in [0.1, 1]$: $E_{\\mathrm{dB}}(u;1/\\sqrt{2}) = -10\\log_{10}\\left((1-u^{2})^{2} + 4(1/\\sqrt{2})^{2}u^{2}\\right) = -10\\log_{10}\\left((1-u^{2})^{2} + 2u^{2}\\right) = -10\\log_{10}(1-2u^{2}+u^{4}+2u^{2}) = -10\\log_{10}(1+u^{4})$. This function is monotonic. The error at $u=1$ is $E_{\\mathrm{dB}}(1;1/\\sqrt{2}) = -10\\log_{10}(2) \\approx -3.010$ dB.\n- For $u \\in [1, 10]$: $E_{\\mathrm{dB}}(u;1/\\sqrt{2}) = 10\\log_{10}\\left(\\frac{u^{4}}{(u^{2}-1)^{2} + 2u^{2}}\\right) = 10\\log_{10}\\left(\\frac{u^{4}}{u^{4}+1}\\right)$. This function is also monotonic.\nThe error function $E_{\\mathrm{dB}}(u;1/\\sqrt{2})$ is always negative, and its absolute value is maximized at $u=1$.\nMaximum error for $\\zeta=1/\\sqrt{2}$: $|E_{\\mathrm{dB}}(1;1/\\sqrt{2})| = |-10\\log_{10}(2)| \\approx 3.010$ dB.\n\nCase 3: $\\zeta = 0.2$ (Underdamped)\n- For $u \\in [0.1, 1]$: $E_{\\mathrm{dB}}(u;0.2) = -10\\log_{10}\\left((1-u^{2})^{2} + 4(0.2)^{2}u^{2}\\right) = -10\\log_{10}\\left(u^{4} - 1.84u^{2} + 1\\right)$. An extremum of $E_{\\mathrm{dB}}$ occurs when its argument, $f(u) = u^{4} - 1.84u^{2} + 1$, is at an extremum. $f'(u) = 4u^{3} - 3.68u = 4u(u^{2} - 0.92)$. For $u \\in (0,1)$, an extremum exists at $u_p = \\sqrt{0.92} \\approx 0.959$. This corresponds to a minimum for $f(u)$, thus a maximum for $E_{\\mathrm{dB}}(u;0.2)$. This is the resonant peak.\nAt this peak frequency $u_p$, the error is:\n$E_{\\mathrm{dB}}(u_p;0.2) = -10\\log_{10}((0.92) - 1.84(\\sqrt{0.92})^{2} + 1) = -10\\log_{10}(0.92^{2} - 1.84(0.92) + 1) = -10\\log_{10}(0.8464 - 1.6928 + 1) = -10\\log_{10}(0.1536)$.\n$E_{\\mathrm{dB}}(u_p;0.2) \\approx -10(-0.8136) = 8.136$ dB.\nThis positive value represents the magnitude of the resonant peak above the $0$ dB asymptote.\nLet us examine the error at the boundaries of the interval $[0.1, 1]$.\n$E_{\\mathrm{dB}}(0.1;0.2) = -10\\log_{10}(0.1^{4} - 1.84(0.1)^{2} + 1) = -10\\log_{10}(0.9817) \\approx 0.080$ dB.\n$E_{\\mathrm{dB}}(1;0.2) = -10\\log_{10}(1 - 1.84 + 1) = -10\\log_{10}(0.16) \\approx 7.959$ dB.\nThe maximum error in this range is the peak value.\n- For $u \\in [1, 10]$: $E_{\\mathrm{dB}}(u;0.2) = 10\\log_{10}\\left(\\frac{u^{4}}{u^{4}-1.84u^{2}+1}\\right)$. The derivative of the argument with respect to $u$ can be shown to be negative for $u  1$. Thus, the function is decreasing. Its maximum value on $[1, 10]$ is at $u=1$, which is $E_{\\mathrm{dB}}(1;0.2) \\approx 7.959$ dB. The minimum value is at $u=10$.\nThe maximum absolute error for $\\zeta=0.2$ over the entire band $[0.1, 10]$ is the value at the resonant peak.\nMaximum error for $\\zeta=0.2$: $E_{\\mathrm{dB}}(\\sqrt{0.92};0.2) = -10\\log_{10}(0.1536) \\approx 8.136$ dB.\n\nComparison of Maximum Errors:\n- For $\\zeta=1$: $\\max|E_{\\mathrm{dB}}| \\approx 6.021$ dB.\n- For $\\zeta=1/\\sqrt{2}$: $\\max|E_{\\mathrm{dB}}| \\approx 3.010$ dB.\n- For $\\zeta=0.2$: $\\max|E_{\\mathrm{dB}}| \\approx 8.136$ dB.\n\nThe largest of these three maxima is for $\\zeta=0.2$. The single worst-case maximum decibel error is $-10\\log_{10}(0.1536) \\approx 8.136217$ dB. Rounding to four significant figures gives $8.136$.", "answer": "$$\\boxed{8.136}$$", "id": "2856164"}, {"introduction": "Beyond shaping magnitude, Bode analysis is also about controlling phase, a critical task in areas like communications and feedback control. This exercise introduces the all-pass filter, a special system designed to modify phase while leaving magnitude unchanged. Through this analysis, you will not only dissect the relationship between pole-zero placement and phase response but also derive and interpret group delay, $\\tau_g(\\omega)$, a vital metric for quantifying time-domain distortion [@problem_id:2856163].", "problem": "Consider the first-order continuous-time all-pass factor defined by $A(s) = \\dfrac{s - a}{s + a}$ with $a  0$, where $s$ is the complex Laplace variable and $j = \\sqrt{-1}$. The frequency response is obtained by evaluating $A(j \\omega)$ for real angular frequency $\\omega \\ge 0$. Starting from the definitions that the Bode magnitude is $|A(j \\omega)|$ and the Bode phase is the argument $\\angle A(j \\omega)$ (in radians), and that the group delay is defined as $\\tau_{g}(\\omega) = - \\dfrac{d}{d \\omega} \\angle A(j \\omega)$, perform the following:\n\n- Prove from first principles that the Bode magnitude $|A(j \\omega)|$ is unity for all real $\\omega$.\n- Derive a continuous (unwrapped) expression for the Bode phase $\\angle A(j \\omega)$ in radians that is consistent with the behavior at low and high frequencies, and then compute the corresponding group delay $\\tau_{g}(\\omega)$.\n- Interpret qualitatively how the frequency dependence of $\\tau_{g}(\\omega)$ follows from the pole-zero geometry of $A(s)$ on the complex plane.\n\nAnswer specification:\n- Provide the final answer as a single closed-form analytic expression for the group delay $\\tau_{g}(\\omega)$.\n- Express all angles in radians and the group delay in seconds (assuming $a$ is specified in radians per second).\n- No numerical approximation or rounding is required; provide the exact symbolic expression only.", "solution": "The problem statement is analyzed and found to be valid. It is scientifically grounded in the principles of linear systems theory, well-posed with all necessary information provided, and stated objectively. The tasks are standard derivations in the field of signal processing. We shall proceed with the solution.\n\nThe transfer function of the first-order all-pass factor is given by\n$$A(s) = \\frac{s - a}{s + a}$$\nwith the condition that $a  0$. The frequency response is found by substituting $s = j\\omega$, where $j = \\sqrt{-1}$ and $\\omega$ is the real angular frequency, with $\\omega \\ge 0$.\n$$A(j\\omega) = \\frac{j\\omega - a}{j\\omega + a}$$\n\nFirst, we prove that the Bode magnitude, $|A(j\\omega)|$, is unity for all real $\\omega$. The magnitude of a ratio of complex numbers is the ratio of their magnitudes.\n$$|A(j\\omega)| = \\left| \\frac{j\\omega - a}{j\\omega + a} \\right| = \\frac{|-a + j\\omega|}{|a + j\\omega|}$$\nThe magnitude of a complex number $x + jy$ is $\\sqrt{x^2 + y^2}$. Applying this to the numerator and denominator:\nThe magnitude of the numerator is $|-a + j\\omega| = \\sqrt{(-a)^2 + \\omega^2} = \\sqrt{a^2 + \\omega^2}$.\nThe magnitude of the denominator is $|a + j\\omega| = \\sqrt{a^2 + \\omega^2}$.\nTherefore, the Bode magnitude is the ratio of these two identical quantities:\n$$|A(j\\omega)| = \\frac{\\sqrt{a^2 + \\omega^2}}{\\sqrt{a^2 + \\omega^2}} = 1$$\nThis holds for any real value of $\\omega$. Q.E.D. Because the magnitude is constant and equal to $1$ for all frequencies, this type of filter is called an all-pass filter.\n\nNext, we derive the expression for the Bode phase, $\\phi(\\omega) = \\angle A(j\\omega)$. The phase of a ratio of complex numbers is the phase of the numerator minus the phase of the denominator.\n$$\\phi(\\omega) = \\angle(j\\omega - a) - \\angle(j\\omega + a) = \\angle(-a + j\\omega) - \\angle(a + j\\omega)$$\nThe numerator, $-a + j\\omega$, is a complex number with a negative real part (since $a0$) and a non-negative imaginary part (since $\\omega \\ge 0$). It lies in the second quadrant of the complex plane. Its phase is given by $\\arctan(\\frac{\\omega}{-a}) + \\pi = \\pi - \\arctan(\\frac{\\omega}{a})$.\nThe denominator, $a + j\\omega$, is a complex number with a positive real part and a non-negative imaginary part. It lies in the first quadrant. Its phase is given by $\\arctan(\\frac{\\omega}{a})$.\nCombining these, the total phase is:\n$$\\phi(\\omega) = \\left( \\pi - \\arctan\\left(\\frac{\\omega}{a}\\right) \\right) - \\arctan\\left(\\frac{\\omega}{a}\\right) = \\pi - 2\\arctan\\left(\\frac{\\omega}{a}\\right)$$\nThis expression for $\\phi(\\omega)$ is continuous for all $\\omega \\ge 0$. At $\\omega = 0$, $\\phi(0) = \\pi - 2\\arctan(0) = \\pi$, which corresponds to $A(j0) = -a/a = -1$. As $\\omega \\to \\infty$, $\\phi(\\infty) \\to \\pi - 2(\\pi/2) = 0$, which corresponds to $A(j\\omega) \\to (j\\omega)/(j\\omega) = 1$. The expression is consistent with the behavior at low and high frequencies.\n\nNow, we compute the group delay, $\\tau_g(\\omega)$, which is defined as the negative derivative of the phase with respect to angular frequency.\n$$\\tau_g(\\omega) = - \\frac{d}{d\\omega} \\phi(\\omega) = - \\frac{d}{d\\omega} \\left( \\pi - 2\\arctan\\left(\\frac{\\omega}{a}\\right) \\right)$$\nThe derivative of the constant $\\pi$ is $0$. The derivative of $\\arctan(u)$ with respect to $\\omega$ is $\\frac{1}{1+u^2} \\frac{du}{d\\omega}$. In our case, $u = \\frac{\\omega}{a}$, so $\\frac{du}{d\\omega} = \\frac{1}{a}$.\n$$\\tau_g(\\omega) = - \\left( 0 - 2 \\cdot \\frac{1}{1 + \\left(\\frac{\\omega}{a}\\right)^2} \\cdot \\frac{1}{a} \\right)$$\n$$\\tau_g(\\omega) = \\frac{2}{a} \\cdot \\frac{1}{1 + \\frac{\\omega^2}{a^2}} = \\frac{2}{a} \\cdot \\frac{a^2}{a^2 + \\omega^2}$$\nSimplifying this expression gives the final form for the group delay:\n$$\\tau_g(\\omega) = \\frac{2a}{a^2 + \\omega^2}$$\n\nFinally, we interpret the frequency dependence of $\\tau_g(\\omega)$ based on the pole-zero geometry. The transfer function $A(s)$ has a zero at $s = a$ and a pole at $s = -a$. The zero is in the right half-plane (RHP) and the pole is in the left half-plane (LHP), positioned symmetrically with respect to the imaginary axis. The frequency response is evaluated along the imaginary axis, $s = j\\omega$.\nThe magnitude $|A(j\\omega)|$ is the ratio of the distance from the point $j\\omega$ to the zero at $s=a$ and the distance from $j\\omega$ to the pole at $s=-a$. Due to the symmetry, these distances are always equal, so their ratio is always $1$.\nThe phase $\\phi(\\omega)$ is the phase of the vector from the zero to $j\\omega$ minus the phase of the vector from the pole to $j\\omega$. As $\\omega$ increases from $0$ to $\\infty$, the phase from the RHP zero decreases from $\\pi$ to $\\pi/2$, while the phase from the LHP pole increases from $0$ to $\\pi/2$. The total phase, $\\phi(\\omega)$, therefore decreases monotonically from $\\pi$ to $0$.\nThe group delay, $\\tau_g(\\omega) = -d\\phi/d\\omega$, is the negative of the slope of the phase plot. Since the phase is a strictly decreasing function of $\\omega$, the group delay is always positive. The phase changes most rapidly for frequencies near the pole and zero. Since the pole and zero are on the real axis, the strongest influence is felt at frequencies near $\\omega = 0$. This is confirmed by our derived expression for $\\tau_g(\\omega) = \\frac{2a}{a^2 + \\omega^2}$, which has its maximum value of $\\frac{2}{a}$ at $\\omega = 0$ and decreases as $\\omega$ increases. The parameter $a$ determines how far the pole and zero are from the imaginary axis; a larger $a$ results in a smaller peak delay that is spread over a wider range of frequencies.", "answer": "$$\\boxed{\\frac{2a}{a^{2} + \\omega^{2}}}$$", "id": "2856163"}]}