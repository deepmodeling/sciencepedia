{"hands_on_practices": [{"introduction": "This first exercise tackles the core task of \"realization\": creating a state-space model from a given transfer function. You will learn to construct a minimal-order model from first principles and then verify its equivalence and structural properties. This practice [@problem_id:2907648] establishes a foundational skill for translating input-output system descriptions into the powerful state-space framework.", "problem": "Consider a linear time-invariant single-input single-output (SISO) system with transfer function $G(s)=3+\\dfrac{2s+1}{s^{2}+2s+2}$. You are told that the direct feedthrough term must be $D=3$. Using only core definitions of state, input, output, and the Laplace-domain relationship between a state-space model and its transfer function, do the following:\n\n1) Decompose $G(s)$ into a direct feedthrough part and a strictly proper part, and construct a minimal-dimension state-space realization $(A,B,C)$ for the strictly proper part such that, when combined with the specified $D=3$, the overall input-output map equals $G(s)$. Do not assume any particular canonical form a priori; build your realization by enforcing the defining relationships so that the resulting input-output behavior matches the strictly proper transfer function.\n\n2) Verify input-output equivalence by deriving, from first principles, the Laplace-domain ratio $Y(s)/U(s)$ implied by your $(A,B,C,D)$ and showing it equals $G(s)$.\n\n3) Justify minimality by checking both controllability and observability of your realization through appropriate rank conditions on the controllability and observability matrices.\n\nAs your final answer, report the characteristic polynomial of your realized state matrix $A$ as a polynomial in $s$. No numerical rounding is required, and no physical units are involved. The final answer must be a single closed-form expression in $s$.", "solution": "The problem statement is submitted for validation.\n\n**Step 1: Extract Givens**\n- The system is a linear time-invariant single-input single-output (SISO) system.\n- The transfer function is $G(s)=3+\\dfrac{2s+1}{s^{2}+2s+2}$.\n- The direct feedthrough term is specified as $D=3$.\n- Task 1: Decompose $G(s)$ into a direct feedthrough part and a strictly proper part. Construct a minimal-dimension state-space realization $(A,B,C)$ for the strictly proper part.\n- Task 2: Verify the input-output equivalence by deriving $Y(s)/U(s)$ from the constructed state-space model $(A,B,C,D)$.\n- Task 3: Justify the minimality of the realization by checking controllability and observability.\n- Final Answer Requirement: Report the characteristic polynomial of the state matrix $A$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard exercise in linear systems theory, specifically concerning the relationship between transfer functions and state-space representations. It is well-posed, providing all necessary information to construct and analyze the required model. The transfer function is well-defined, with poles at $s=-1 \\pm i$, indicating a stable system. The language is objective and precise. The problem is self-contained, consistent, and does not violate any fundamental principles of mathematics or control theory.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be provided.\n\nThe solution proceeds in three parts as requested.\n\n**1) Decomposition and State-Space Realization**\nThe given transfer function is $G(s) = 3 + \\dfrac{2s+1}{s^{2}+2s+2}$.\nA general transfer function $G(s)$ can be decomposed into a strictly proper part, $G_{sp}(s)$, and a direct feedthrough constant, $D$.\n$G(s) = G_{sp}(s) + D$.\nBy inspection, we identify the direct feedthrough term as $D=3$ and the strictly proper part as $G_{sp}(s) = \\dfrac{2s+1}{s^{2}+2s+2}$.\n\nWe seek a state-space realization $(A,B,C)$ for $G_{sp}(s)$. The input-output relationship for this part is $Y_{sp}(s) = G_{sp}(s)U(s)$, where $U(s)$ is the Laplace transform of the input $u(t)$ and $Y_{sp}(s)$ is the Laplace transform of the output component due to the states.\nTo derive a realization from first principles, we introduce an auxiliary variable $Z(s)$ such that:\n$$Z(s) = \\frac{1}{s^{2}+2s+2} U(s)$$\n$$Y_{sp}(s) = (2s+1)Z(s) = 2sZ(s) + Z(s)$$\nThe first equation corresponds to the time-domain ordinary differential equation:\n$$\\ddot{z}(t) + 2\\dot{z}(t) + 2z(t) = u(t)$$\nThis is a second-order system, which requires a minimum of two state variables for its representation. A natural choice of state variables is $x_1(t) = z(t)$ and $x_2(t) = \\dot{z}(t)$. The state equations are derived as follows:\n$$\\dot{x}_1(t) = \\dot{z}(t) = x_2(t)$$\n$$\\dot{x}_2(t) = \\ddot{z}(t) = -2z(t) - 2\\dot{z}(t) + u(t) = -2x_1(t) - 2x_2(t) + u(t)$$\nThese two equations can be written in matrix form $\\dot{\\mathbf{x}}(t) = A\\mathbf{x}(t) + Bu(t)$:\n$$\n\\begin{pmatrix} \\dot{x}_1(t) \\\\ \\dot{x}_2(t) \\end{pmatrix} =\n\\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix}\n\\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} +\n\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} u(t)\n$$\nThus, we have the state matrix $A$ and the input matrix $B$:\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\nThe output equation is derived from $Y_{sp}(s) = 2sZ(s) + Z(s)$. In the time domain, this is $y_{sp}(t) = 2\\dot{z}(t) + z(t)$. Substituting the state variables, we get:\n$$y_{sp}(t) = 2x_2(t) + x_1(t)$$\nThis can be written in matrix form $y_{sp}(t) = C\\mathbf{x}(t)$:\n$$y_{sp}(t) = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}$$\nThus, the output matrix is $C = \\begin{pmatrix} 1 & 2 \\end{pmatrix}$.\nThe constructed realization for the strictly proper part is $(A, B, C)$. The overall system, including the direct feedthrough, is given by:\n$$\\dot{\\mathbf{x}} = A\\mathbf{x} + Bu$$\n$$y = C\\mathbf{x} + Du$$\nwith $D=3$.\n\n**2) Verification of Input-Output Equivalence**\nThe transfer function of a state-space system $(A,B,C,D)$ is given by the formula $G(s) = C(sI-A)^{-1}B + D$. We must compute this expression and show that it equals the original $G(s)$.\nFirst, we compute the matrix $(sI-A)^{-1}$:\n$$sI-A = s\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix} = \\begin{pmatrix} s & -1 \\\\ 2 & s+2 \\end{pmatrix}$$\nThe determinant of this matrix is $\\det(sI-A) = s(s+2) - (-1)(2) = s^{2}+2s+2$.\nThe inverse is:\n$$(sI-A)^{-1} = \\frac{1}{\\det(sI-A)} \\text{adj}(sI-A) = \\frac{1}{s^{2}+2s+2} \\begin{pmatrix} s+2 & 1 \\\\ -2 & s \\end{pmatrix}$$\nNow, we compute $C(sI-A)^{-1}B$:\n$$\n\\begin{align*}\nC(sI-A)^{-1}B &= \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\left( \\frac{1}{s^{2}+2s+2} \\begin{pmatrix} s+2 & 1 \\\\ -2 & s \\end{pmatrix} \\right) \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\\\\n&= \\frac{1}{s^{2}+2s+2} \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} s+2 & 1 \\\\ -2 & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\\\\n&= \\frac{1}{s^{2}+2s+2} \\begin{pmatrix} 1(s+2)+2(-2) & 1(1)+2(s) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\\\\n&= \\frac{1}{s^{2}+2s+2} \\begin{pmatrix} s-2 & 2s+1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\\\\n&= \\frac{1}{s^{2}+2s+2} \\left( (s-2)(0) + (2s+1)(1) \\right) \\\\\n&= \\frac{2s+1}{s^{2}+2s+2}\n\\end{align*}\n$$\nThis is precisely $G_{sp}(s)$. The full transfer function is then:\n$$G(s) = C(sI-A)^{-1}B + D = \\frac{2s+1}{s^{2}+2s+2} + 3$$\nThis matches the given expression, which verifies the correctness of the state-space realization.\n\n**3) Justification of Minimality**\nA realization is minimal if and only if it is both controllable and observable. The state dimension is $n=2$.\n\n**Controllability:** The system is controllable if the controllability matrix $\\mathcal{C}$ has rank $n=2$.\n$$\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}$$\nWe compute the product $AB$:\n$$AB = \\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$$\nThe controllability matrix is:\n$$\\mathcal{C} = \\begin{pmatrix} 0 & 1 \\\\ 1 & -2 \\end{pmatrix}$$\nThe determinant is $\\det(\\mathcal{C}) = (0)(-2) - (1)(1) = -1$. Since $\\det(\\mathcal{C}) \\neq 0$, the matrix has full rank, $\\text{rank}(\\mathcal{C}) = 2$. The realization is controllable.\n\n**Observability:** The system is observable if the observability matrix $\\mathcal{O}$ has rank $n=2$.\n$$\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$$\nWe compute the product $CA$:\n$$CA = \\begin{pmatrix} 1 & 2 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ -2 & -2 \\end{pmatrix} = \\begin{pmatrix} 1(0)+2(-2) & 1(1)+2(-2) \\end{pmatrix} = \\begin{pmatrix} -4 & -3 \\end{pmatrix}$$\nThe observability matrix is:\n$$\\mathcal{O} = \\begin{pmatrix} 1 & 2 \\\\ -4 & -3 \\end{pmatrix}$$\nThe determinant is $\\det(\\mathcal{O}) = (1)(-3) - (2)(-4) = -3 + 8 = 5$. Since $\\det(\\mathcal{O}) \\neq 0$, the matrix has full rank, $\\text{rank}(\\mathcal{O}) = 2$. The realization is observable.\n\nSince the realization is both controllable and observable, it is a minimal realization. The dimension $n=2$ corresponds to the order of the denominator of the irreducible transfer function $G_{sp}(s)$, as expected for a minimal realization.\n\n**Final Answer Calculation**\nThe final answer is the characteristic polynomial of the state matrix $A$, denoted $p(s)$. It is defined as $p(s) = \\det(sI-A)$.\nAs calculated in part 2):\n$$p(s) = \\det(sI-A) = \\det \\begin{pmatrix} s & -1 \\\\ 2 & s+2 \\end{pmatrix} = s(s+2) - (-1)(2) = s^{2} + 2s + 2$$\nThis polynomial is the denominator of the transfer function, and its roots are the eigenvalues of the matrix $A$, which are the poles of the system.", "answer": "$$\\boxed{s^{2}+2s+2}$$", "id": "2907648"}, {"introduction": "While a state-space model might correctly reproduce a system's transfer function, this does not guarantee its internal behavior is sound. This practice [@problem_id:2749016] demonstrates the critical concept of internal stability by having you construct a non-minimal realization where hidden, unstable dynamics are masked by pole-zero cancellations. Understanding this distinction is crucial for designing reliable and safe control systems.", "problem": "Consider the single-input single-output linear time-invariant system with transfer function\n$$G(s) = \\frac{s + 4}{s^{2} + 5 s + 6}.$$\nThis transfer function is strictly proper and stable. Starting only from the state-space definition of a transfer function, namely that for a realization $(A,B,C,D)$ the input-output map under zero initial conditions is\n$$G(s) = C\\,(s I - A)^{-1} B + D,$$\ncarry out the following.\n\n1) Construct a minimal-order stable realization $(A_{\\mathrm{min}},B_{\\mathrm{min}},C_{\\mathrm{min}},D_{\\mathrm{min}})$ for $G(s)$ and justify that it matches $G(s)$ by direct evaluation from the definition above.\n\n2) Augment your minimal realization to a nonminimal realization $(A,B,C,D)$ that is internally unstable but still realizes the same $G(s)$ due to pole-zero cancellations arising from lack of controllability and/or observability. Specifically, embed an additional unreachable and unobservable two-dimensional subsystem whose dynamics matrix has distinct real unstable eigenvalues at $s=2$ and $s=5$. Clearly specify your block-structured $(A,B,C,D)$.\n\n3) Prove directly from $G(s) = C\\,(s I - A)^{-1} B + D$ that your augmented nonminimal realization has the same transfer function $G(s)$ as the original, and explain why the unstable internal poles do not appear as poles of $G(s)$.\n\n4) Identify the hidden unstable modes of your constructed realization.\n\nAnswer format: Report only the hidden unstable eigenvalues from part 4 as a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment. No rounding is required and no units are involved.", "solution": "The problem as stated is subjected to validation.\n\n**Givens Extraction:**\n1.  The system is a single-input single-output (SISO) linear time-invariant (LTI) system.\n2.  The transfer function is $G(s) = \\frac{s + 4}{s^{2} + 5 s + 6}$.\n3.  The transfer function is claimed to be strictly proper and stable.\n4.  The state-space definition of the transfer function is given as $G(s) = C\\,(s I - A)^{-1} B + D$ for a realization $(A,B,C,D)$.\n5.  Task 1: Construct a minimal-order stable realization $(A_{\\mathrm{min}},B_{\\mathrm{min}},C_{\\mathrm{min}},D_{\\mathrm{min}})$ and verify it matches $G(s)$.\n6.  Task 2: Augment this to a nonminimal, internally unstable realization $(A,B,C,D)$ containing an additional unreachable and unobservable two-dimensional subsystem with unstable eigenvalues at $s=2$ and $s=5$.\n7.  Task 3: Prove the augmented realization yields $G(s)$ and explain the pole-zero cancellation mechanism.\n8.  Task 4: Identify the hidden unstable modes of the constructed realization.\n\n**Validation:**\nThe problem is well-posed, scientifically sound, and internally consistent. The given transfer function $G(s)$ has a denominator polynomial $s^2 + 5s + 6 = (s+2)(s+3)$ with roots at $s=-2$ and $s=-3$. Both roots lie in the open left-half of the complex plane, confirming the system's stability. The degree of the numerator ($1$) is less than the degree of the denominator ($2$), confirming the transfer function is strictly proper. The numerator polynomial $s+4$ and the denominator polynomial share no common roots, so the transfer function is irreducible, and its minimal realization will be of order $n=2$. The tasks described are standard procedures in linear systems theory concerning state-space realizations, minimality, and internal stability. The problem is therefore valid.\n\nWe proceed to the solution.\n\n**1) Minimal-Order Stable Realization**\n\nThe given transfer function is $G(s) = \\frac{s + 4}{s^{2} + 5 s + 6}$.\nA minimal realization has an order equal to the degree of the denominator of the irreducible transfer function, which is $n=2$. We construct a realization in controllable canonical form. For a general second-order transfer function $G(s) = \\frac{b_1 s + b_0}{s^2 + a_1 s + a_0}$, the controllable canonical form is given by:\n$$A = \\begin{pmatrix} 0 & 1 \\\\ -a_0 & -a_1 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C = \\begin{pmatrix} b_0 & b_1 \\end{pmatrix}, \\quad D = [0]$$\nFrom $G(s)$, we identify the coefficients: $a_1=5$, $a_0=6$, $b_1=1$, and $b_0=4$. Since the transfer function is strictly proper, $D_{\\mathrm{min}}=0$.\nThus, a minimal realization is:\n$$A_{\\mathrm{min}} = \\begin{pmatrix} 0 & 1 \\\\ -6 & -5 \\end{pmatrix}, \\quad B_{\\mathrm{min}} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}, \\quad C_{\\mathrm{min}} = \\begin{pmatrix} 4 & 1 \\end{pmatrix}, \\quad D_{\\mathrm{min}} = 0$$\nThe eigenvalues of $A_{\\mathrm{min}}$ are the roots of the characteristic equation $\\det(sI - A_{\\mathrm{min}}) = s(s+5) - (1)(-6) = s^2+5s+6 = 0$, which are $s=-2$ and $s=-3$. Both are in the left-half plane, so this realization is stable.\n\nTo verify this realization, we compute the transfer function $G_{\\mathrm{min}}(s) = C_{\\mathrm{min}}(sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} + D_{\\mathrm{min}}$.\n$$sI - A_{\\mathrm{min}} = \\begin{pmatrix} s & -1 \\\\ 6 & s+5 \\end{pmatrix}$$\nThe inverse is:\n$$(sI - A_{\\mathrm{min}})^{-1} = \\frac{1}{\\det(sI-A_{\\mathrm{min}})} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix} = \\frac{1}{s^2+5s+6} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix}$$\nNow, we compute the product:\n$$G_{\\mathrm{min}}(s) = \\begin{pmatrix} 4 & 1 \\end{pmatrix} \\frac{1}{s^2+5s+6} \\begin{pmatrix} s+5 & 1 \\\\ -6 & s \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n$$G_{\\mathrm{min}}(s) = \\frac{1}{s^2+5s+6} \\begin{pmatrix} 4 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ s \\end{pmatrix} = \\frac{4(1) + 1(s)}{s^2+5s+6} = \\frac{s+4}{s^2+5s+6}$$\nThis matches the given $G(s)$, so the realization is correct.\n\n**2) Augmented Nonminimal Unstable Realization**\n\nWe must augment the minimal realization with a two-dimensional subsystem that is both unreachable (uncontrollable) and unobservable, and has unstable eigenvalues at $s=2$ and $s=5$.\nLet the state of the minimal system be $x_{\\mathrm{min}} \\in \\mathbb{R}^2$ and the state of the hidden subsystem be $x_{\\mathrm{hid}} \\in \\mathbb{R}^2$. The augmented state vector is $x = \\begin{pmatrix} x_{\\mathrm{min}} \\\\ x_{\\mathrm{hid}} \\end{pmatrix}$.\nTo ensure the added subsystem is unreachable and unobservable, we can place it in a block-diagonal structure, decoupling it from the minimal realization.\nThe dynamics of the hidden subsystem are governed by a matrix $A_{\\mathrm{hid}}$ whose eigenvalues are $2$ and $5$. A simple choice is the diagonal matrix $A_{\\mathrm{hid}} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 5 \\end{pmatrix}$.\nThe augmented state-space matrices $(A,B,C,D)$ are constructed as follows:\n$$A = \\begin{pmatrix} A_{\\mathrm{min}} & 0 \\\\ 0 & A_{\\mathrm{hid}} \\end{pmatrix}, \\quad B = \\begin{pmatrix} B_{\\mathrm{min}} \\\\ 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} C_{\\mathrm{min}} & 0 \\end{pmatrix}, \\quad D = D_{\\mathrm{min}}$$\nSubstituting the specific matrices:\n$$A = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ -6 & -5 & 0 & 0 \\\\ 0 & 0 & 2 & 0 \\\\ 0 & 0 & 0 & 5 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 4 & 1 & 0 & 0 \\end{pmatrix}, \\quad D = 0$$\nThe eigenvalues of $A$ are the union of the eigenvalues of the diagonal blocks: $\\{-2, -3, 2, 5\\}$. The presence of eigenvalues $2$ and $5$ makes this realization internally unstable. The structure of $B$ and $C$ ensures the subsystem with states $x_3, x_4$ is unreachable and unobservable.\n\n**3) Verification of the Augmented Realization**\n\nWe prove that this nonminimal realization yields the same transfer function $G(s)$. We compute $G_{\\mathrm{aug}}(s) = C(sI - A)^{-1} B + D$.\nThe matrix $sI-A$ has a block-diagonal structure:\n$$sI - A = \\begin{pmatrix} sI - A_{\\mathrm{min}} & 0 \\\\ 0 & sI - A_{\\mathrm{hid}} \\end{pmatrix}$$\nIts inverse is the block-diagonal matrix of the inverses:\n$$(sI - A)^{-1} = \\begin{pmatrix} (sI - A_{\\mathrm{min}})^{-1} & 0 \\\\ 0 & (sI - A_{\\mathrm{hid}})^{-1} \\end{pmatrix}$$\nThe transfer function is then:\n$$G_{\\mathrm{aug}}(s) = \\begin{pmatrix} C_{\\mathrm{min}} & 0 \\end{pmatrix} \\begin{pmatrix} (sI - A_{\\mathrm{min}})^{-1} & 0 \\\\ 0 & (sI-A_{\\mathrm{hid}})^{-1} \\end{pmatrix} \\begin{pmatrix} B_{\\mathrm{min}} \\\\ 0 \\end{pmatrix} + 0$$\nPerforming the block matrix multiplication:\n$$G_{\\mathrm{aug}}(s) = C_{\\mathrm{min}} (sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} + 0 \\cdot (sI-A_{\\mathrm{hid}})^{-1} \\cdot 0$$\n$$G_{\\mathrm{aug}}(s) = C_{\\mathrm{min}} (sI - A_{\\mathrm{min}})^{-1} B_{\\mathrm{min}} = G(s)$$\nThis proves that the augmented realization has the same transfer function as the original minimal system.\n\nThe unstable poles of the realization, which are the eigenvalues $s=2$ and $s=5$ of the matrix $A$, do not appear as poles of the transfer function $G(s)$. The transfer function only reflects the dynamics of the controllable and observable part of the system. In the expression for $G_{\\mathrm{aug}}(s)$, the term $(sI-A_{\\mathrm{hid}})^{-1}$ contains the factors $(s-2)$ and $(s-5)$ in its denominator. However, this block is pre-multiplied by a zero block in $C$ and post-multiplied by a zero block in $B$. This algebraic nullification is the mathematical manifestation of pole-zero cancellation. The unstable dynamics are \"hidden\" from the input-output map because they are neither excited by the input (uncontrollable) nor visible in the output (unobservable).\n\n**4) Identification of Hidden Unstable Modes**\n\nThe modes of the system are the eigenvalues of the state matrix $A$. The eigenvalues of the augmented matrix $A$ are $\\{-2, -3, 2, 5\\}$.\nThe poles of the transfer function $G(s)$ are $\\{-2, -3\\}$. These correspond to the controllable and observable modes of the system.\nThe hidden modes are the eigenvalues of $A$ that are not poles of $G(s)$. These are the modes associated with the uncontrollable and/or unobservable part of the system.\nBy comparison, the hidden modes are $\\{2, 5\\}$.\nA mode is unstable if its corresponding eigenvalue has a non-negative real part. Both $2$ and $5$ are positive real numbers.\nTherefore, the hidden unstable modes are precisely the eigenvalues of the augmented subsystem, $s=2$ and $s=5$.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 5 \\end{pmatrix}}$$", "id": "2749016"}, {"introduction": "Having seen the potential dangers of non-minimal models, it is essential to have a systematic method for simplification. This final exercise [@problem_id:2907653] guides you through the process of model reduction using a coordinate transformation that isolates the controllable and observable dynamics of a system. Mastering this technique allows you to derive a minimal realization from any given model, ensuring your representation is both efficient and accurate.", "problem": "Consider a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) system with state-space realization given by\n$$\n\\dot{x}(t) = A x(t) + B u(t), \\quad y(t) = C x(t) + D u(t),\n$$\nwhere $x(t) \\in \\mathbb{R}^{n}$, $u(t) \\in \\mathbb{R}$, and $y(t) \\in \\mathbb{R}$. Starting from the fundamental definitions that the controllable subspace is the range of the controllability matrix and that the unobservable subspace is the null space of the observability matrix, devise a systematic procedure to reduce any nonminimal realization to a minimal one by eliminating uncontrollable and unobservable dynamics through similarity transformations. Your procedure must specify how to:\n- identify the controllable and unobservable subspaces from $A$, $B$, and $C$,\n- construct a similarity transformation that isolates these subspaces (i.e., achieves a Kalman-type decomposition),\n- remove the dynamics associated with uncontrollable and unobservable components to obtain a minimal realization that is both controllable and observable.\n\nApply your procedure to the following $3 \\times 3$ realization:\n$$\nA = \\begin{bmatrix}\n0 & 1 & 4 \\\\\n-2 & -3 & 10 \\\\\n0 & 0 & 5\n\\end{bmatrix},\\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{bmatrix},\\quad\nC = \\begin{bmatrix}\n1 & 0 & -1\n\\end{bmatrix},\\quad\nD = 0.\n$$\nExplicitly compute:\n- the controllable subspace and its dimension,\n- the unobservable subspace and its dimension,\n- a similarity transformation that reveals the decomposition into controllable/uncontrollable and observable/unobservable parts,\n- the transfer function of the resulting minimal realization.\n\nReport as your final answer only the reduced transfer function $G_{\\min}(s)$ in simplified rational form as a single analytic expression in the complex frequency variable $s$. No numerical rounding is required and no units are involved. Express angles, if any, in radians. The final answer must be a single expression, not an inequality or an equation.", "solution": "The problem posed is a standard exercise in linear systems theory concerning controllability, observability, and minimal realizations. It is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. The problem is therefore deemed valid and a full solution will be provided.\n\nA systematic procedure for reducing a nonminimal state-space realization to a minimal one is based on the Kalman decomposition theorem. The state space $\\mathbb{R}^{n}$ can be decomposed into a direct sum of four subspaces: the subspace of states that are controllable and observable ($\\mathcal{X}_{co}$), controllable but unobservable ($\\mathcal{X}_{c\\bar{o}}$), uncontrollable but observable ($\\mathcal{X}_{\\bar{c}o}$), and uncontrollable and unobservable ($\\mathcal{X}_{\\bar{c}\\bar{o}}$). The minimal realization corresponds to the dynamics restricted to the controllable and observable subspace, $\\mathcal{X}_{co}$. The transfer function, which describes the input-output behavior, is invariant under similarity transformations and is completely determined by this minimal realization.\n\nThe procedure is as follows:\n$1$. Identify the controllable subspace, $\\mathcal{X}_c$, and the unobservable subspace, $\\mathcal{X}_{\\bar{o}}$.\nThe controllable subspace is the range of the controllability matrix $\\mathcal{C}$:\n$$ \\mathcal{C} = \\begin{bmatrix} B & AB & A^2B & \\cdots & A^{n-1}B \\end{bmatrix} $$\n$$ \\mathcal{X}_c = \\mathcal{R}(\\mathcal{C}) $$\nThe unobservable subspace is the null space of the observability matrix $\\mathcal{O}$:\n$$ \\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{bmatrix} $$\n$$ \\mathcal{X}_{\\bar{o}} = \\mathcal{N}(\\mathcal{O}) $$\n\n$2$. Construct a similarity transformation matrix, $P$, whose inverse, $T = P^{-1}$, is formed by basis vectors that decompose the state space according to its controllability and observability properties. A basis for $T$ can be constructed by selecting basis vectors for the four Kalman subspaces. This transforms the system coordinates via $z(t) = Px(t)$, resulting in a new realization $(\\bar{A}, \\bar{B}, \\bar{C}, \\bar{D}) = (PAP^{-1}, PB, CP^{-1}, D)$ that has a block structure revealing the decomposition.\n\n$3$. Extract the minimal realization. The sub-system $(A_{co}, B_{co}, C_{co}, D)$ corresponding to the controllable and observable dynamics is the minimal realization. Its transfer function is $G_{\\min}(s) = C_{co}(sI - A_{co})^{-1}B_{co} + D$.\n\nWe now apply this procedure to the given system:\n$$\nA = \\begin{bmatrix}\n0 & 1 & 4 \\\\\n-2 & -3 & 10 \\\\\n0 & 0 & 5\n\\end{bmatrix},\\quad\nB = \\begin{bmatrix}\n0 \\\\ 1 \\\\ 0\n\\end{bmatrix},\\quad\nC = \\begin{bmatrix}\n1 & 0 & -1\n\\end{bmatrix},\\quad\nD = 0.\n$$\nThe state-space dimension is $n=3$.\n\nFirst, we analyze controllability. We compute the columns of the controllability matrix $\\mathcal{C} = \\begin{bmatrix} B & AB & A^2B \\end{bmatrix}$.\n$$ AB = \\begin{bmatrix} 0 & 1 & 4 \\\\ -2 & -3 & 10 \\\\ 0 & 0 & 5 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -3 \\\\ 0 \\end{bmatrix} $$\n$$ A^2B = A(AB) = \\begin{bmatrix} 0 & 1 & 4 \\\\ -2 & -3 & 10 \\\\ 0 & 0 & 5 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -3 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} -3 \\\\ 7 \\\\ 0 \\end{bmatrix} $$\nThe controllability matrix is thus:\n$$ \\mathcal{C} = \\begin{bmatrix} 0 & 1 & -3 \\\\ 1 & -3 & 7 \\\\ 0 & 0 & 0 \\end{bmatrix} $$\nThe third row consists of zeros, so the matrix is singular. The first two columns are linearly independent. Therefore, the rank of $\\mathcal{C}$ is $2$.\nThe dimension of the controllable subspace is $\\dim(\\mathcal{X}_c) = \\text{rank}(\\mathcal{C}) = 2$. Since $2 < 3$, the system is not controllable.\nThe controllable subspace $\\mathcal{X}_c$ is spanned by the columns of $\\mathcal{C}$. A basis can be chosen as the first two standard basis vectors, as all vectors in $\\mathcal{R}(\\mathcal{C})$ have a zero in the third component.\n$$ \\mathcal{X}_c = \\text{span}\\left\\{\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\\right\\} $$\n\nNext, we analyze observability. We compute the rows of the observability matrix $\\mathcal{O} = \\begin{bmatrix} C \\\\ CA \\\\ CA^2 \\end{bmatrix}$.\n$$ CA = \\begin{bmatrix} 1 & 0 & -1 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 4 \\\\ -2 & -3 & 10 \\\\ 0 & 0 & 5 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & -1 \\end{bmatrix} $$\n$$ CA^2 = (CA)A = \\begin{bmatrix} 0 & 1 & -1 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 4 \\\\ -2 & -3 & 10 \\\\ 0 & 0 & 5 \\end{bmatrix} = \\begin{bmatrix} -2 & -3 & 5 \\end{bmatrix} $$\nThe observability matrix is:\n$$ \\mathcal{O} = \\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ -2 & -3 & 5 \\end{bmatrix} $$\nTo find the rank, we compute the determinant: $\\det(\\mathcal{O}) = 1(5-3) - 0 - 1(0 - (-2)) = 2 - 2 = 0$. The rank is less than $3$. The first two rows are linearly independent, so the rank of $\\mathcal{O}$ is $2$.\nThe dimension of the observable subspace is $\\dim(\\mathcal{X}_o) = \\text{rank}(\\mathcal{O}) = 2$. Since $2 < 3$, the system is not observable.\nThe unobservable subspace $\\mathcal{X}_{\\bar{o}}$ is the null space of $\\mathcal{O}$. We solve $\\mathcal{O}x = 0$:\n$$ \\begin{cases} x_1 - x_3 = 0 \\\\ x_2 - x_3 = 0 \\\\ -2x_1 - 3x_2 + 5x_3 = 0 \\end{cases} \\implies \\begin{cases} x_1 = x_3 \\\\ x_2 = x_3 \\end{cases} $$\nSubstituting into the third equation gives $-2x_3 - 3x_3 + 5x_3 = 0$, which is satisfied for any $x_3$. The solutions are of the form $k(1, 1, 1)^T$.\nThe unobservable subspace is spanned by the vector $(1, 1, 1)^T$ and its dimension is $1$.\n$$ \\mathcal{X}_{\\bar{o}} = \\text{span}\\left\\{\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\\right\\} $$\n\nNow, we construct a suitable similarity transformation. We must find a basis that separates the controllable/uncontrollable and observable/unobservable parts. The vector $(1, 1, 1)^T$ is an eigenvector of $A$ corresponding to the eigenvalue $\\lambda=5$, as $A(1,1,1)^T=(5,5,5)^T=5(1,1,1)^T$. This mode is unobservable, as the eigenvector spans $\\mathcal{X}_{\\bar{o}}$. It is also uncontrollable, as the vector is not in $\\mathcal{X}_c$ (its third component is non-zero). Thus, this mode is both uncontrollable and unobservable ($\\mathcal{X}_{\\bar{c}\\bar{o}}$). The other two modes must form the controllable and observable part.\n\nWe construct a transformation matrix $T = P^{-1}$ using a basis that isolates the unobservable subspace. Let the last basis vector be the one spanning $\\mathcal{X}_{\\bar{o}}$, and we complete the basis with two other linearly independent vectors, for instance, the first two standard basis vectors.\n$$ T = \\begin{bmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\nThe similarity transformation matrix is $P = T^{-1}$:\n$$ P = \\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\nLet us compute the transformed system matrices $(\\bar{A}, \\bar{B}, \\bar{C}) = (PAP^{-1}, PB, CP^{-1})$. It is equivalent and often simpler to compute $(\\bar{A}, \\bar{B}, \\bar{C})=(P A T, P B, C T)$.\n$$ \\bar{A} = P(AT) = \\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ 0 & 0 & 1 \\end{bmatrix} \\left( \\begin{bmatrix} 0 & 1 & 4 \\\\ -2 & -3 & 10 \\\\ 0 & 0 & 5 \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix} \\right) = \\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 & 1 & 5 \\\\ -2 & -3 & 5 \\\\ 0 & 0 & 5 \\end{bmatrix} = \\begin{bmatrix} 0 & 1 & 0 \\\\ -2 & -3 & 0 \\\\ 0 & 0 & 5 \\end{bmatrix} $$\n$$ \\bar{B} = PB = \\begin{bmatrix} 1 & 0 & -1 \\\\ 0 & 1 & -1 \\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} $$\n$$ \\bar{C} = CT = \\begin{bmatrix} 1 & 0 & -1 \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\\\ 0 & 0 & 1 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\end{bmatrix} $$\nThe transformed system is block-diagonal, revealing a complete decoupling between the controllable-observable part and the uncontrollable-unobservable part.\n$$ \\bar{A} = \\begin{bmatrix} A_{co} & 0 \\\\ 0 & A_{\\bar{c}\\bar{o}} \\end{bmatrix}, \\quad \\bar{B} = \\begin{bmatrix} B_{co} \\\\ 0 \\end{bmatrix}, \\quad \\bar{C} = \\begin{bmatrix} C_{co} & 0 \\end{bmatrix} $$\nThe minimal realization is given by the $(co)$ block:\n$$ A_{co} = \\begin{bmatrix} 0 & 1 \\\\ -2 & -3 \\end{bmatrix}, \\quad B_{co} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C_{co} = \\begin{bmatrix} 1 & 0 \\end{bmatrix}, \\quad D = 0 $$\nThe transfer function of this minimal realization is:\n$$ G_{\\min}(s) = C_{co} (sI - A_{co})^{-1} B_{co} $$\nWe compute the inverse of $(sI - A_{co})$:\n$$ (sI - A_{co})^{-1} = \\begin{bmatrix} s & -1 \\\\ 2 & s+3 \\end{bmatrix}^{-1} = \\frac{1}{s(s+3) - (-1)(2)} \\begin{bmatrix} s+3 & 1 \\\\ -2 & s \\end{bmatrix} = \\frac{1}{s^2 + 3s + 2} \\begin{bmatrix} s+3 & 1 \\\\ -2 & s \\end{bmatrix} $$\nNow we compute the transfer function:\n$$ G_{\\min}(s) = \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\frac{1}{s^2 + 3s + 2} \\begin{bmatrix} s+3 & 1 \\\\ -2 & s \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{s^2 + 3s + 2} \\begin{bmatrix} 1 & 0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ s \\end{bmatrix} = \\frac{1}{s^2 + 3s + 2} $$\nThis rational function represents the input-output behavior of the minimal system, where the uncontrollable and unobservable mode corresponding to $\\lambda=5$ has been eliminated.\nThe poles of the minimal system are at $s=-1$ and $s=-2$, which are the eigenvalues of $A_{co}$.\nFinal answer is the transfer function.", "answer": "$$\n\\boxed{\\frac{1}{s^2+3s+2}}\n$$", "id": "2907653"}]}