{"hands_on_practices": [{"introduction": "This exercise provides a foundational, hands-on introduction to beamforming by implementing the conventional Bartlett beamformer. By constructing the weight vector from first principles and calculating key performance metrics like the Signal-to-Interference-plus-Noise Ratio (SINR) and interference attenuation, you will gain a concrete understanding of how spatial filtering works to enhance a desired signal while suppressing others [@problem_id:2853623]. This practice is essential for mastering the core mechanics of array signal processing.", "problem": "Consider a narrowband plane-wave signal model impinging on a Uniform Linear Array (ULA) of $M$ sensors with inter-element spacing $d$ and propagation speed $c$ at temporal frequency $f_0$. Let the wavenumber be $k = \\frac{2\\pi}{\\lambda}$ where $\\lambda = \\frac{c}{f_0}$, and define the array steering vector for an azimuth look angle $\\theta$ (measured from broadside, in degrees) as\n$$\n\\mathbf{a}(\\theta) = \\begin{bmatrix}\n1 & e^{-j k d \\sin(\\theta\\,\\pi/180)} & \\cdots & e^{-j k d (M-1) \\sin(\\theta\\,\\pi/180)}\n\\end{bmatrix}^{\\mathsf{T}} \\in \\mathbb{C}^{M}.\n$$\nAssume a narrowband array data model\n$$\n\\mathbf{x} = \\mathbf{a}(\\theta_0)\\, s + \\mathbf{a}(\\theta_i)\\, u + \\mathbf{n},\n$$\nwhere $s$ and $u$ are zero-mean, circularly symmetric, complex Gaussian random variables with powers $\\sigma_s^2$ and $\\sigma_u^2$, respectively, and $\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$ is spatially and temporally white noise with power $\\sigma_n^2$. Angles are in degrees, and trigonometric functions use radians internally.\n\nYou are to implement the Bartlett (conventional delay-and-sum) beamformer for a desired look direction $\\theta_0$ by constructing a weight vector $\\mathbf{w}$ that enforces a distortionless response toward $\\theta_0$, i.e., $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$. Start from the narrowband plane-wave model and the distortionless constraint, and use only these foundational principles to construct $\\mathbf{w}$.\n\nDefine the output Signal-to-Interference-plus-Noise Ratio (SINR) of the beamformer as\n$$\n\\mathrm{SINR}_{\\text{out}} = \\frac{\\text{output signal power}}{\\text{output interference power} + \\text{output noise power}},\n$$\ncomputed directly from second-order moments of $s, u, \\mathbf{n}$ and the linear form $y = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}$. Also define the interference attenuation in decibels (dB) as the negative of the beamformer power gain in the interferer direction,\n$$\nA_i \\text{ (dB)} = -10 \\log_{10}\\!\\left(\\left|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)\\right|^2\\right).\n$$\nReport $\\mathrm{SINR}_{\\text{out}}$ in decibels (dB) and $A_i$ in decibels (dB). Angles are in degrees. All logarithms are base $10$. Round all reported numbers to exactly four decimal places.\n\nImplement a program that, for each test case below, computes and outputs in order the pair $\\left[\\mathrm{SINR}_{\\text{out}}\\ \\text{(dB)},\\ A_i\\ \\text{(dB)}\\right]$. Aggregate all results from all cases into a single flat list printed on one line as specified in the final output format.\n\nUse half-wavelength inter-element spacing $d = \\lambda/2$ for every test case.\n\nTest suite (angles in degrees; $c$ in meters per second; $f_0$ in hertz; powers in linear units):\n- Case $1$: $M=8$, $f_0=1500$, $c=1500$, $\\theta_0=20$, $\\theta_i=-30$, $\\sigma_s^2=1.0$, $\\sigma_u^2=10.0$, $\\sigma_n^2=1.0$.\n- Case $2$: $M=8$, $f_0=1500$, $c=1500$, $\\theta_0=10$, $\\theta_i=10$, $\\sigma_s^2=1.0$, $\\sigma_u^2=1.0$, $\\sigma_n^2=1.0$.\n- Case $3$: $M=1$, $f_0=1500$, $c=1500$, $\\theta_0=0$, $\\theta_i=30$, $\\sigma_s^2=2.0$, $\\sigma_u^2=3.0$, $\\sigma_n^2=4.0$.\n- Case $4$: $M=16$, $f_0=3000$, $c=1500$, $\\theta_0=0$, $\\theta_i=60$, $\\sigma_s^2=1.0$, $\\sigma_u^2=100.0$, $\\sigma_n^2=1.0$.\n\nFinal output format: Your program should produce a single line of output containing a comma-separated list of numbers enclosed in square brackets, flattening the per-case pairs in the given order. That is, the output must be of the form\n$[\\mathrm{SINR}_{1},A_{i,1},\\mathrm{SINR}_{2},A_{i,2},\\mathrm{SINR}_{3},A_{i,3},\\mathrm{SINR}_{4},A_{i,4}]$,\nwith each number rounded to exactly four decimal places and expressed in decibels (dB).", "solution": "The problem requires the derivation and implementation of a Bartlett beamformer for a Uniform Linear Array (ULA) and the calculation of its performance, specifically the output Signal-to-Interference-plus-Noise Ratio ($\\mathrm{SINR}_{\\text{out}}$) and interference attenuation ($A_i$). The analysis will be based on the provided narrowband plane-wave signal model.\n\nFirst, we derive the weight vector $\\mathbf{w} \\in \\mathbb{C}^{M}$ for the Bartlett beamformer. A Bartlett beamformer is designed to have a maximal response in the desired look direction $\\theta_0$, subject to certain constraints. The problem specifies a distortionless response constraint in this direction, which is formulated as $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$. The conventional, or Bartlett, beamformer can be derived by maximizing the signal-to-noise ratio (SNR) at the output for a signal from the desired direction $\\theta_0$ in the presence of spatially white noise.\n\nThe signal component of the array data from direction $\\theta_0$ is $\\mathbf{x}_s = \\mathbf{a}(\\theta_0)s$. The beamformer output due to this signal is $y_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{x}_s = \\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)s$. The output signal power is $P_s^{\\text{out}} = E[|y_s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 E[|s|^2] = |\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2$. The noise component is $\\mathbf{n} \\sim \\mathcal{CN}(\\mathbf{0}, \\sigma_n^2 \\mathbf{I}_M)$, and the corresponding output noise is $y_n = \\mathbf{w}^{\\mathsf{H}} \\mathbf{n}$. The output noise power is $P_n^{\\text{out}} = E[|y_n|^2] = E[\\mathbf{w}^{\\mathsf{H}} \\mathbf{n} \\mathbf{n}^{\\mathsf{H}} \\mathbf{w}] = \\mathbf{w}^{\\mathsf{H}} E[\\mathbf{n} \\mathbf{n}^{\\mathsf{H}}] \\mathbf{w} = \\mathbf{w}^{\\mathsf{H}} (\\sigma_n^2 \\mathbf{I}_M) \\mathbf{w} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$.\n\nThe output SNR is thus $\\mathrm{SNR} = \\frac{P_s^{\\text{out}}}{P_n^{\\text{out}}} = \\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|^2 \\sigma_s^2}{\\sigma_n^2 \\|\\mathbf{w}\\|_2^2}$. To maximize this SNR, we must maximize the term $\\frac{|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)|}{\\|\\mathbf{w}\\|_2}$. By the Cauchy-Schwarz inequality, $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0)| \\leq \\|\\mathbf{w}\\|_2 \\|\\mathbf{a}(\\theta_0)\\|_2$. The maximum is achieved when $\\mathbf{w}$ is collinear with $\\mathbf{a}(\\theta_0)$, i.e., $\\mathbf{w} = \\alpha \\mathbf{a}(\\theta_0)$ for some scalar $\\alpha$.\n\nWe apply the distortionless response constraint $\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = 1$ to determine $\\alpha$.\n$$ (\\alpha \\mathbf{a}(\\theta_0))^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\mathbf{a}(\\theta_0)^{\\mathsf{H}} \\mathbf{a}(\\theta_0) = \\bar{\\alpha} \\|\\mathbf{a}(\\theta_0)\\|_2^2 = 1 $$\nThe steering vector elements are $a_m(\\theta_0) = e^{-j k d (m-1) \\sin(\\theta_0\\pi/180)}$, which have unit magnitude. Thus, $\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\sum_{m=0}^{M-1} |a_m(\\theta_0)|^2 = \\sum_{m=0}^{M-1} 1 = M$.\nThis gives $\\bar{\\alpha} M = 1$, so $\\alpha = 1/M$. The Bartlett weight vector is therefore:\n$$ \\mathbf{w} = \\frac{1}{M} \\mathbf{a}(\\theta_0) $$\n\nNext, we compute the output SINR. The beamformer output is $y = \\mathbf{w}^{\\mathsf{H}}\\mathbf{x}$. Given the data model $\\mathbf{x} = \\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}$, the output is:\n$$ y = \\mathbf{w}^{\\mathsf{H}}(\\mathbf{a}(\\theta_0)s + \\mathbf{a}(\\theta_i)u + \\mathbf{n}) = (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0))s + (\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i))u + \\mathbf{w}^{\\mathsf{H}}\\mathbf{n} $$\nSince $s$, $u$, and $\\mathbf{n}$ are zero-mean and uncorrelated, the total output power is the sum of the powers of the signal, interference, and noise components.\nThe output signal power, using the distortionless constraint, is $P_s^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_0)|^2 \\sigma_s^2 = 1^2 \\cdot \\sigma_s^2 = \\sigma_s^2$.\nThe output interference power is $P_u^{\\text{out}} = |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2$.\nThe output noise power is $P_n^{\\text{out}} = \\sigma_n^2 \\|\\mathbf{w}\\|_2^2$. Substituting $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$, we get $P_n^{\\text{out}} = \\sigma_n^2 \\|\\frac{1}{M}\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}\\|\\mathbf{a}(\\theta_0)\\|_2^2 = \\frac{\\sigma_n^2}{M^2}M = \\frac{\\sigma_n^2}{M}$.\n\nThe output SINR is defined as $\\mathrm{SINR}_{\\text{out}} = \\frac{P_s^{\\text{out}}}{P_u^{\\text{out}} + P_n^{\\text{out}}}$. Substituting the derived terms:\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{|\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 \\sigma_u^2 + \\frac{\\sigma_n^2}{M}} $$\nSubstituting $\\mathbf{w} = \\frac{1}{M}\\mathbf{a}(\\theta_0)$:\n$$ |\\mathbf{w}^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 = \\left|\\left(\\frac{1}{M}\\mathbf{a}(\\theta_0)\\right)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)\\right|^2 = \\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 $$\nSo, the SINR expression becomes:\n$$ \\mathrm{SINR}_{\\text{out}} = \\frac{\\sigma_s^2}{\\frac{\\sigma_u^2}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + \\frac{\\sigma_n^2}{M}} = \\frac{M^2 \\sigma_s^2}{\\sigma_u^2 |\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2 + M \\sigma_n^2} $$\nThe value is converted to decibels (dB) via $\\mathrm{SINR}_{\\text{out}} \\text{ (dB)} = 10 \\log_{10}(\\mathrm{SINR}_{\\text{out}})$.\n\nThe interference attenuation $A_i$ is defined as $A_i \\text{ (dB)} = -10 \\log_{10}(|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2)$. Substituting the expression for the gain term $|\\mathbf{w}^{\\mathsf{H}} \\mathbf{a}(\\theta_i)|^2$:\n$$ A_i \\text{ (dB)} = -10 \\log_{10}\\left(\\frac{1}{M^2}|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2\\right) $$\n\nFor all test cases, the inter-element spacing is $d = \\lambda/2$. The wavenumber is $k = 2\\pi/\\lambda$. Thus, the product $kd = (2\\pi/\\lambda)(\\lambda/2) = \\pi$. The $m$-th element (0-indexed) of the steering vector $\\mathbf{a}(\\theta)$ is $e^{-j \\pi m \\sin(\\theta\\pi/180)}$. The term $|\\mathbf{a}(\\theta_0)^{\\mathsf{H}}\\mathbf{a}(\\theta_i)|^2$ is computed by first constructing the vectors $\\mathbf{a}(\\theta_0)$ and $\\mathbf{a}(\\theta_i)$ and then calculating the squared magnitude of their vector inner product. The final results are obtained by substituting the parameters from each test case into these derived formulas.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the output SINR and interference attenuation for a Bartlett beamformer\n    for a set of test cases.\n    \"\"\"\n    # Test cases defined as tuples:\n    # (M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2)\n    test_cases = [\n        (8, 1500, 1500, 20, -30, 1.0, 10.0, 1.0),\n        (8, 1500, 1500, 10, 10, 1.0, 1.0, 1.0),\n        (1, 1500, 1500, 0, 30, 2.0, 3.0, 4.0),\n        (16, 3000, 1500, 0, 60, 1.0, 100.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, f0, c, theta0_deg, thetai_deg, sigma_s2, sigma_u2, sigma_n2 = case\n        \n        # The problem specifies half-wavelength spacing d = lambda/2.\n        # Wavelength lambda = c / f0.\n        # Wavenumber k = 2*pi/lambda.\n        # The term kd in the steering vector exponent becomes:\n        # kd = (2*pi/lambda) * (lambda/2) = pi.\n        # This holds true for all cases where M > 1.\n        kd = np.pi\n        \n        # Steering vector is a(theta) = [1, exp(-j*kd*sin(theta)), ..., exp(-j*kd*(M-1)*sin(theta))]\n        # We compute the inner product term |a(theta0)^H a(theta_i)|^2\n        m_indices = np.arange(M)\n        \n        # Angles need to be in radians for numpy's trigonometric functions.\n        theta0_rad = np.deg2rad(theta0_deg)\n        thetai_rad = np.deg2rad(thetai_deg)\n        \n        # Construct steering vectors\n        a_theta0 = np.exp(-1j * kd * m_indices * np.sin(theta0_rad))\n        a_thetai = np.exp(-1j * kd * m_indices * np.sin(thetai_rad))\n        \n        # Calculate a(theta0)^H * a(thetai) using numpy's vdot for hermitian dot product.\n        inner_product = np.vdot(a_theta0, a_thetai)\n        inner_product_sq = np.abs(inner_product)**2\n        \n        # Calculate output SINR in linear scale\n        # SINR_out = (M^2 * sigma_s^2) / (sigma_u^2 * |a_h^H a_i|^2 + M * sigma_n^2)\n        numerator_sinr = (M**2) * sigma_s2\n        denominator_sinr = sigma_u2 * inner_product_sq + M * sigma_n2\n        sinr_linear = numerator_sinr / denominator_sinr\n        \n        # Convert SINR to dB\n        sinr_db = 10 * np.log10(sinr_linear)\n        \n        # Calculate Interference Attenuation in dB\n        # A_i = -10 * log10(|w^H a_i|^2)\n        # |w^H a_i|^2 = |(1/M * a_0^H) a_i|^2 = (1/M^2) * |a_0^H a_i|^2\n        interferer_gain_sq = inner_product_sq / (M**2)\n        Ai_db = -10 * np.log10(interferer_gain_sq)\n\n        # Append rounded results to the list\n        results.append(sinr_db)\n        results.append(Ai_db)\n\n    # Format the final output string as per requirements\n    # Each number must be represented with exactly four decimal places.\n    output_str = \"[\" + \",\".join(f\"{x:.4f}\" for x in results) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2853623"}, {"introduction": "Building upon the narrowband model, this practice addresses the challenges of wideband beamforming, where a simple phase shift is no longer sufficient across a band of frequencies. You will design a true time-delay beamformer using fractional delay Finite Impulse Response (FIR) filters, learning how to translate system-level requirements like bandwidth and distortion tolerance into concrete filter design parameters [@problem_id:2853637]. This task bridges the gap between the theoretical concept of time delay and its practical implementation in a discrete-time system.", "problem": "Consider a Uniform Linear Array (ULA) of $K$ isotropic sensors with inter-element spacing $d$, immersed in an acoustic medium with propagation speed $c$. A far-field, plane-wave, wideband source impinges from elevation angle $\\theta_0$ (measured from broadside). The received signal is sampled at rate $f_s$. You are asked to realize a true time-delay beamformer in the look direction $\\theta_0$ over the signal band $[f_1,f_2]$ by implementing the sensor-dependent propagation delays $\\{\\tau_m\\}_{m=0}^{K-1}$ with per-sensor, discrete-time fractional delay filters. The objective is to maintain a distortionless (unit-magnitude) response in the look direction across the entire band $[f_1,f_2]$ up to a prescribed passband ripple tolerance.\n\nStarting from first principles, use the following base:\n- The beampattern in the look direction of a true time-delay beamformer equals the coherent sum of the sensor outputs, and if the desired per-sensor continuous-time delay is implemented by a discrete-time filter with frequency response $H_m(\\omega)$, then, in the look direction, the overall magnitude response equals the common per-sensor magnitude $|H_m(\\omega)|$ when identical fractional delay filters are used at all sensors.\n- An ideal discrete-time fractional delay of $D$ samples has frequency response $H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$, which is all-pass in magnitude.\n- A standard, well-tested approach to approximate $H_{\\text{ideal}}(\\omega)$ over a prescribed passband is to window-truncate the ideal impulse response by a Kaiser window, yielding a real-coefficient, linear-phase, finite impulse response (FIR) approximation whose passband ripple and transition width are controlled by the window parameters. For a Kaiser-windowed FIR design with equal passband and stopband ripples $\\delta$ and transition width $\\Delta\\Omega$ (in radians per sample), the commonly used length estimate that guarantees the specified ripple is\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad A \\triangleq -20\\log_{10}(\\delta).\n$$\n\nUse this framework to argue how a per-sensor fractional delay FIR filter ensures a distortionless look-direction response for the beamformer when its passband ripple is bounded by $\\delta$, and then determine the minimum integer filter order $N_{\\min}$ required to guarantee that the look-direction beampattern magnitude deviates from unity by no more than $\\delta$ across $[f_1,f_2]$.\n\nNumerical specification for evaluation:\n- Number of sensors $K=16$.\n- Propagation speed $c=343\\,\\text{m/s}$.\n- Look direction $\\theta_0=30^\\circ$.\n- Sampling frequency $f_s=48{,}000\\,\\text{Hz}$.\n- Signal band $[f_1,f_2]=[3{,}000,\\,7{,}000]\\,\\text{Hz}$.\n- At both band edges, enforce equal transition width $\\Delta f=1{,}000\\,\\text{Hz}$ to the adjacent stopbands.\n- Passband ripple tolerance $\\delta=0.005$ (that is, an allowable magnitude deviation of at most $0.005$).\n\nAssume identical per-sensor fractional delay filters are used, each designed (via Kaiser windowing of the ideal fractional delay impulse response) to meet the above ripple and transition-width specifications over the band $[f_1,f_2]$. Compute the minimum integer filter order $N_{\\min}$ that guarantees the distortionless look-direction constraint. The final answer must be the single integer $N_{\\min}$. No units are required. If you need to round any intermediate non-integer length, take the smallest integer that still guarantees the specification (i.e., round up to the next integer).", "solution": "First, we must rigorously inspect the problem statement for its validity. We proceed by formalizing the given information and constraints.\n\nThe givens are:\n- Array configuration: Uniform Linear Array (ULA) with $K=16$ isotropic sensors and inter-element spacing $d$.\n- Acoustic medium propagation speed: $c=343\\,\\text{m/s}$.\n- Source direction of interest (look direction): $\\theta_0=30^\\circ$.\n- System sampling rate: $f_s=48{,}000\\,\\text{Hz}$.\n- Desired operational frequency band: $[f_1, f_2] = [3{,}000, 7{,}000]\\,\\text{Hz}$.\n- Beamformer implementation: True time-delay via per-sensor fractional delay Finite Impulse Response (FIR) filters.\n- Filter design passband ripple tolerance: $\\delta=0.005$.\n- Filter design transition width: $\\Delta f=1{,}000\\,\\text{Hz}$.\n- Foundational Premise 1: The look-direction magnitude response of the beamformer is equal to the common magnitude response $|H_m(\\omega)|$ of the identical per-sensor filters.\n- Foundational Premise 2: The ideal discrete-time fractional delay filter has a frequency response $H_{\\text{ideal}}(\\omega)=\\exp(-j\\omega D)$, which has unit magnitude.\n- Foundational Premise 3: The FIR filters are designed by windowing the ideal impulse response with a Kaiser window. The required filter length $L$ is estimated by the formula:\n$$\nL \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1,\\quad \\text{where } A = -20\\log_{10}(\\delta).\n$$\n\nA critical examination of these premises reveals a scientifically sound, internally consistent, and well-posed problem. The scenario is a standard application in array signal processing. The filter design methodology using the Kaiser window and the associated empirical formula for filter length are canonical in digital signal processing. All necessary numerical values are provided to compute the required filter order. The problem is unambiguous and objective. Therefore, the problem is deemed valid, and we shall proceed to construct the solution.\n\nThe first objective is to argue that the filter design constraints ensure a nearly distortionless look-direction response.\nA distortionless response in the look direction implies that the magnitude of the beamformer's frequency response is unity for all frequencies within the signal band. The problem states that the overall look-direction magnitude response is equal to the magnitude response $|H_m(\\omega)|$ of a single FIR filter. The ideal filter we are trying to approximate is a fractional delay filter, which has a constant unit magnitude response. The passband ripple tolerance, $\\delta$, quantifies the maximum allowable deviation of our practical filter's magnitude response from the ideal unit gain. Specifically, for any frequency $f$ within the passband $[f_1, f_2]$, the filter's magnitude response $|H_m(\\omega)|$ where $\\omega = 2\\pi f$, is constrained to lie in the range $[1-\\delta, 1+\\delta]$. As the beamformer's look-direction response is identical to this, it directly follows that the beampattern magnitude in the look direction will deviate from unity by no more than $\\delta$. This is the direct meaning of achieving a response that is \"distortionless up to a prescribed passband ripple tolerance.\"\n\nThe second objective is to compute the minimum integer filter order, $N_{\\min}$, required to satisfy the specified constraints. The order $N$ of an FIR filter is related to its length $L$ by $N = L-1$. We must first find the minimum required length, $L_{\\min}$, using the given formula.\n\nStep 1: Calculate the attenuation parameter $A$.\nThe parameter $A$ is determined by the passband ripple $\\delta = 0.005$.\n$$A = -20\\log_{10}(\\delta) = -20\\log_{10}(0.005)$$\n$$A = -20\\log_{10}(5 \\times 10^{-3}) = -20(\\log_{10}(5) - 3)$$\nUsing the value $\\log_{10}(5) \\approx 0.698970$:\n$$A \\approx -20(0.698970 - 3) = -20(-2.301030) \\approx 46.0206$$\n\nStep 2: Calculate the normalized transition width $\\Delta\\Omega$.\nThe transition width is given in Hertz as $\\Delta f = 1{,}000\\,\\text{Hz}$. The sampling frequency is $f_s = 48{,}000\\,\\text{Hz}$. The transition width in normalized angular frequency (radians per sample) is:\n$$\\Delta\\Omega = 2\\pi \\frac{\\Delta f}{f_s} = 2\\pi \\frac{1{,}000}{48{,}000} = \\frac{2\\pi}{48} = \\frac{\\pi}{24}$$\n\nStep 3: Calculate the minimum filter length $L_{\\min}$.\nWe substitute the values of $A$ and $\\Delta\\Omega$ into the provided inequality for the filter length $L$.\n$$L \\ge \\frac{A-8}{2.285\\,\\Delta\\Omega} + 1$$\n$$L \\ge \\frac{46.0206 - 8}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1 = \\frac{38.0206}{2.285 \\left(\\frac{\\pi}{24}\\right)} + 1$$\nEvaluating the denominator: $2.285 \\times \\frac{\\pi}{24} \\approx 0.2990833$.\n$$L \\ge \\frac{38.0206}{0.2990833} + 1 \\approx 127.1258 + 1 = 128.1258$$\nSince the filter length $L$ must be an integer, we must choose the smallest integer value that satisfies this condition. This is obtained by taking the ceiling of the calculated lower bound.\n$$L_{\\min} = \\lceil 128.1258 \\rceil = 129$$\n\nStep 4: Calculate the minimum filter order $N_{\\min}$.\nThe filter order $N$ is one less than its length $L$.\n$$N_{\\min} = L_{\\min} - 1 = 129 - 1 = 128$$\n\nIt is noteworthy that the parameters $K$, $c$, and $\\theta_0$ are contextual to the physical problem of beamforming but are not required for the specific calculation of the filter order. The filter complexity is determined by its frequency-domain specifications ($\\delta$ and $\\Delta\\Omega$), not by the specific fractional delay value it implements. The problem assumes these specifications are chosen to accommodate the range of delays needed across the array.", "answer": "$$\\boxed{128}$$", "id": "2853637"}, {"introduction": "Real-world systems are constrained by computational resources and latency requirements, making implementation efficiency a critical concern. This exercise moves from algorithm design to system-level optimization, requiring you to analyze the trade-offs between two common beamforming implementations: direct time-domain filtering and efficient frequency-domain block processing [@problem_id:2853656]. By deriving computational load expressions and finding an optimal configuration under a hardware budget, you will develop crucial skills for designing practical and responsive signal processing systems.", "problem": "A uniform linear array with $M$ sensors performs delay-and-sum beamforming to produce $B$ simultaneous beams on a complex baseband signal sampled at rate $F_{s}$ samples per second. Each beam steers to a distinct look direction and requires fractional-sample delays for each sensor. Consider two implementations:\n\n1. Time-domain fractional-delay filtering: For each beam and sensor, a length-$L$ complex finite impulse response (FIR) filter approximates the fractional delay, and beamforming is the coherent sum of the $M$ filtered sensor signals.\n\n2. Frequency-domain overlap-save using the Fast Fourier Transform (FFT): Blocks of length $N$ are processed with hop size $H = N - L + 1$. Each block applies $M$ forward FFTs of length $N$, performs frequency-domain complex weighted sums across sensors for each beam and frequency bin, and applies $B$ inverse FFTs of length $N$ to synthesize the time-domain beam outputs.\n\nAssume the following operation model, counting real floating-point operations (one real multiplication or one real addition equals one floating-point operation, abbreviated as FLOP):\n\n- A length-$N$ complex radix-$2$ FFT (or inverse FFT) costs $5 N \\log_{2} N$ FLOPs.\n- One complex multiplication costs $4$ real multiplications and $2$ real additions (total $6$ FLOPs).\n- One complex addition costs $2$ real additions (total $2$ FLOPs).\n\nTasks:\n\n(a) Starting from the definitions above and first principles of convolution and block processing, derive a symbolic expression for the time-domain implementation’s computational load in FLOPs per second, $F_{\\mathrm{time}}$, in terms of $M$, $B$, $L$, and $F_{s}$.\n\n(b) Derive a symbolic expression for the frequency-domain implementation’s computational load in FLOPs per second, $F_{\\mathrm{freq}}(N)$, in terms of $M$, $B$, $L$, $F_{s}$, and $N$.\n\n(c) For a system with $M = 64$, $B = 8$, $F_{s} = 1.6 \\times 10^{6}$, $L = 32$, and a hardware budget of $C_{\\max} = 1.5 \\times 10^{10}$ FLOPs per second, choose $N$ as a power of two to minimize end-to-end block latency $\\tau = N / F_{s}$ while satisfying $F_{\\mathrm{freq}}(N) \\leq C_{\\max}$. Compute the minimal achievable latency $\\tau$ in seconds. Round your final numerical answer to four significant figures and express it in seconds.", "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded problem in digital signal processing. It requires the derivation of computational complexity for two standard beamforming implementations and a constrained optimization calculation.\n\n(a) Derivation of the time-domain computational load, $F_{\\mathrm{time}}$.\n\nThe time-domain implementation forms $B$ beams from $M$ sensor signals. For each beam, the process is as follows:\n$1$. For each of the $M$ sensors, a complex-valued Finite Impulse Response (FIR) filter of length $L$ is applied to the incoming data stream, which is sampled at a rate of $F_s$.\n$2$. The $M$ filtered signals are then coherently summed to produce the beam output.\n\nLet us analyze the computational cost per output sample for a single beam.\nThe application of one length-$L$ complex FIR filter requires $L$ complex multiplications and $L-1$ complex additions for each output sample.\nUsing the provided cost model:\n- Cost of $L$ complex multiplications: $L \\times (4 \\text{ real mult} + 2 \\text{ real add}) = L \\times 6$ FLOPs.\n- Cost of $L-1$ complex additions: $(L-1) \\times (2 \\text{ real add}) = (L-1) \\times 2$ FLOPs.\nThe total cost to filter one sensor signal per output sample is $C_{\\mathrm{filt}} = 6L + 2(L-1) = 8L - 2$ FLOPs.\n\nFor a single beam, this filtering operation is performed for each of the $M$ sensor signals. The problem states \"For each beam and sensor, a length-$L$ complex finite impulse response (FIR) filter approximates the fractional delay\". This implies that a distinct filter is used for each sensor-beam pair. Therefore, for one beam, the total filtering cost per output sample is $M \\times C_{\\mathrm{filt}} = M(8L - 2)$ FLOPs.\n\nAfter filtering, the $M$ resulting complex signals are summed. Summing $M$ complex numbers requires $M-1$ complex additions.\nThe cost of this summation per output sample is $C_{\\mathrm{sum}} = (M-1) \\times 2$ FLOPs.\n\nThe total computational cost per output sample for a single beam is the sum of the filtering and summation costs:\n$C_{\\mathrm{beam}} = M(8L - 2) + 2(M-1) = 8ML - 2M + 2M - 2 = 8ML - 2$ FLOPs.\n\nSince there are $B$ simultaneous beams and each is formed independently, the total computational cost per output sample for all $B$ beams is $C_{\\mathrm{total}} = B \\times C_{\\mathrm{beam}} = B(8ML - 2)$ FLOPs.\n\nThe system produces output samples at a rate of $F_s$. Therefore, the total computational load in FLOPs per second is:\n$F_{\\mathrm{time}} = F_s \\times C_{\\mathrm{total}} = F_s B (8ML - 2)$.\n\n(b) Derivation of the frequency-domain computational load, $F_{\\mathrm{freq}}(N)$.\n\nThe frequency-domain implementation uses the overlap-save method. It processes blocks of $N$ input samples with a hop size of $H = N - L + 1$, meaning $H$ new output samples are generated per block. The number of blocks processed per second to maintain real-time throughput is $F_s / H = F_s / (N-L+1)$.\n\nLet us analyze the computational cost for processing one block of data.\n$1$. **Forward FFTs**: For each of the $M$ sensors, a length-$N$ complex FFT is performed on a block of input data.\nThe cost of one FFT is given as $5N \\log_2 N$ FLOPs.\nThe total cost for the $M$ forward FFTs is $C_{\\mathrm{FFT}} = M \\times (5N \\log_2 N)$ FLOPs.\n\n$2$. **Frequency-Domain Weighting**: For each of the $N$ frequency bins and for each of the $B$ beams, a complex weighted sum is performed across the $M$ sensors. This operation is equivalent to a complex vector dot product of length $M$. For a single frequency bin and a single beam, this involves $M$ complex multiplications and $M-1$ complex additions.\nThe cost for one bin and one beam is: $M \\times 6 + (M-1) \\times 2 = 8M - 2$ FLOPs.\nThis operation is performed for all $N$ frequency bins and all $B$ beams.\nThe total cost for weighting is $C_{\\mathrm{weight}} = N \\times B \\times (8M - 2)$ FLOPs.\n\n$3$. **Inverse FFTs**: After a frequency-domain output signal is synthesized for each of the $B$ beams, an inverse FFT of length $N$ is required for each beam to return to the time domain.\nThe cost of one inverse FFT is the same as the forward FFT: $5N \\log_2 N$ FLOPs.\nThe total cost for the $B$ inverse FFTs is $C_{\\mathrm{IFFT}} = B \\times (5N \\log_2 N)$ FLOPs.\n\nThe total computational cost per block is the sum of these three components:\n$C_{\\mathrm{block}} = C_{\\mathrm{FFT}} + C_{\\mathrm{weight}} + C_{\\mathrm{IFFT}}$\n$C_{\\mathrm{block}} = M(5N \\log_2 N) + NB(8M - 2) + B(5N \\log_2 N)$\n$C_{\\mathrm{block}} = 5N \\log_2(N) (M+B) + NB(8M-2)$\n\nTo find the FLOPs per second, we multiply the cost per block by the number of blocks per second:\n$F_{\\mathrm{freq}}(N) = C_{\\mathrm{block}} \\times \\frac{F_s}{N-L+1}$\n$F_{\\mathrm{freq}}(N) = \\frac{F_s}{N-L+1} [5N \\log_2(N) (M+B) + NB(8M-2)]$\nThis can be written as:\n$F_{\\mathrm{freq}}(N) = \\frac{N F_s}{N-L+1} [5(M+B)\\log_2(N) + B(8M-2)]$.\n\n(c) Minimizing latency $\\tau = N / F_s$ under a computational budget.\n\nWe are given the parameters: $M=64$, $B=8$, $F_s = 1.6 \\times 10^6$, $L=32$, and $C_{\\max} = 1.5 \\times 10^{10}$ FLOPs/sec. We must find the smallest power of two $N$ such that $F_{\\mathrm{freq}}(N) \\le C_{\\max}$ and $N \\ge L$. Minimizing $N$ is equivalent to minimizing the latency $\\tau$.\n\nLet's substitute the given values into the expression for $F_{\\mathrm{freq}}(N)$:\n$M+B = 64+8 = 72$\n$8M-2 = 8(64)-2 = 512-2 = 510$\n$L-1 = 32-1 = 31$\n$F_{\\mathrm{freq}}(N) = \\frac{N \\times 1.6 \\times 10^6}{N-31} [5(72)\\log_2(N) + 8(510)]$\n$F_{\\mathrm{freq}}(N) = \\frac{1.6 \\times 10^6 N}{N-31} [360\\log_2(N) + 4080]$\n\nThe condition is $F_{\\mathrm{freq}}(N) \\le 1.5 \\times 10^{10}$.\nWe must test values of $N$ that are powers of two, starting from the smallest valid value, which is $N=32$ since $N \\ge L=32$.\n\nFor $N=32$:\n$F_{\\mathrm{freq}}(32) = \\frac{1.6 \\times 10^6 \\times 32}{32-31} [360\\log_2(32) + 4080] = 5.12 \\times 10^7 [360(5) + 4080] = 5.12 \\times 10^7 [1800 + 4080] = 5.12 \\times 10^7 [5880] \\approx 3.01 \\times 10^{11}$ FLOPs/sec.\nThis value is greater than $C_{\\max}$.\n\nFor $N=64$:\n$F_{\\mathrm{freq}}(64) = \\frac{1.6 \\times 10^6 \\times 64}{64-31} [360\\log_2(64) + 4080] = \\frac{1.024 \\times 10^8}{33} [360(6) + 4080] \\approx 3.103 \\times 10^6 [2160 + 4080] = 3.103 \\times 10^6 [6240] \\approx 1.94 \\times 10^{10}$ FLOPs/sec.\nThis value is also greater than $C_{\\max}$.\n\nFor $N=128$:\n$F_{\\mathrm{freq}}(128) = \\frac{1.6 \\times 10^6 \\times 128}{128-31} [360\\log_2(128) + 4080] = \\frac{2.048 \\times 10^8}{97} [360(7) + 4080] \\approx 2.111 \\times 10^6 [2520 + 4080] = 2.111 \\times 10^6 [6600] \\approx 1.39 \\times 10^{10}$ FLOPs/sec.\nThis value is less than $C_{\\max} = 1.5 \\times 10^{10}$.\n\nSince the computational load for $N=64$ exceeded the budget and the load for $N=128$ is within the budget, the minimum power of two for the FFT length $N$ that satisfies the constraint is $N=128$.\n\nThe minimal achievable latency $\\tau$ is then:\n$\\tau = \\frac{N}{F_s} = \\frac{128}{1.6 \\times 10^6} = \\frac{128}{1.6} \\times 10^{-6} = 80 \\times 10^{-6}$ seconds.\nExpressed in the required format to four significant figures, this is $8.000 \\times 10^{-5}$ seconds.", "answer": "$$\\boxed{8.000 \\times 10^{-5}}$$", "id": "2853656"}]}