{"hands_on_practices": [{"introduction": "Our journey into the practical application of state feedback begins with a foundational exercise. Here, we will design a complete control system that not only stabilizes the plant and shapes its dynamic response by placing the closed-loop poles at desired locations but also ensures the output accurately tracks a reference signal in the steady state. This practice [@problem_id:2907353] combines the two essential goals of control design: transient performance and steady-state accuracy, providing a solid foundation for more advanced topics.", "problem": "Consider the continuous-time linear time-invariant (LTI) single-input single-output state-space model with state vector $\\mathbf{x}(t) \\in \\mathbb{R}^{2}$, input $u(t) \\in \\mathbb{R}$, and output $y(t) \\in \\mathbb{R}$:\n$$\n\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B u(t), \\quad y(t) = C \\mathbf{x}(t),\n$$\nwhere\n$$\nA = \\begin{bmatrix} 0  1 \\\\ -1  -1 \\end{bmatrix}, \\quad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}, \\quad C = \\begin{bmatrix} 1  0 \\end{bmatrix}.\n$$\nLet the control law be of the form\n$$\nu(t) = -K \\mathbf{x}(t) + N r(t),\n$$\nwhere $K \\in \\mathbb{R}^{1 \\times 2}$ is a state-feedback gain and $N \\in \\mathbb{R}$ is a scalar prefilter, and $r(t)$ is an external reference signal. The closed-loop state matrix is $A_{c} = A - B K$.\n\nStarting from first principles for linear systems, use the definition of the characteristic polynomial of a matrix and the steady-state balance of a linear time-invariant system under a constant input to:\n- Design $K = \\begin{bmatrix} k_{1}  k_{2} \\end{bmatrix}$ so that the closed-loop eigenvalues of $A_{c}$ are placed at the complex conjugate pair $\\{ -2 + j, -2 - j \\}$.\n- Determine the prefilter $N$ that achieves exact unit steady-state tracking for a unit step reference $r(t) = 1$ under the given control law.\n\nExpress your final answer as a single row matrix $\\begin{pmatrix} k_{1}  k_{2}  N \\end{pmatrix}$ with exact values (no rounding). Do not include any units.", "solution": "The problem as stated is scientifically sound, well-posed, and complete. It presents a standard exercise in linear control systems theory, specifically state-feedback controller design for pole placement and reference tracking. The system is described by a state-space model with given matrices $A$, $B$, and $C$. The system's controllability is a necessary condition for arbitrary pole placement. The controllability matrix is $\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix}$.\nGiven $A = \\begin{bmatrix} 0  1 \\\\ -1  -1 \\end{bmatrix}$ and $B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$, we compute $AB = \\begin{bmatrix} 0  1 \\\\ -1  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$.\nThe controllability matrix is $\\mathcal{C} = \\begin{bmatrix} 0  1 \\\\ 1  -1 \\end{bmatrix}$. The determinant is $\\det(\\mathcal{C}) = (0)(-1) - (1)(1) = -1 \\neq 0$. The system is controllable, thus the closed-loop poles can be placed arbitrarily. The problem is valid and a solution can be derived.\n\nThe solution proceeds in two parts as requested: first, the design of the state-feedback gain $K$ for pole placement, and second, the determination of the prefilter $N$ for steady-state tracking.\n\nPart 1: Design of State-Feedback Gain $K = \\begin{bmatrix} k_{1}  k_{2} \\end{bmatrix}$\nThe control law is $u(t) = -K \\mathbf{x}(t) + N r(t)$. The closed-loop state dynamics are given by $\\dot{\\mathbf{x}}(t) = A \\mathbf{x}(t) + B(-K \\mathbf{x}(t) + N r(t)) = (A-BK)\\mathbf{x}(t) + BNr(t)$.\nThe closed-loop state matrix is $A_c = A - BK$. We compute this matrix symbolically:\n$$\nBK = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1  k_2 \\end{bmatrix} = \\begin{bmatrix} 0  0 \\\\ k_1  k_2 \\end{bmatrix}\n$$\n$$\nA_c = A - BK = \\begin{bmatrix} 0  1 \\\\ -1  -1 \\end{bmatrix} - \\begin{bmatrix} 0  0 \\\\ k_1  k_2 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -1-k_1  -1-k_2 \\end{bmatrix}\n$$\nThe eigenvalues of the closed-loop system are the roots of the characteristic polynomial $p_{A_c}(\\lambda) = \\det(\\lambda I - A_c)$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\lambda I - A_c = \\lambda \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\begin{bmatrix} 0  1 \\\\ -1-k_1  -1-k_2 \\end{bmatrix} = \\begin{bmatrix} \\lambda  -1 \\\\ 1+k_1  \\lambda+1+k_2 \\end{bmatrix}\n$$\nThe characteristic polynomial is:\n$$\np_{A_c}(\\lambda) = \\det(\\lambda I - A_c) = \\lambda(\\lambda+1+k_2) - (-1)(1+k_1) = \\lambda^2 + (1+k_2)\\lambda + (1+k_1)\n$$\nThe desired closed-loop eigenvalues are specified as $\\{ -2 + j, -2 - j \\}$. The desired characteristic polynomial, $p_{des}(\\lambda)$, is formed from these roots:\n$$\np_{des}(\\lambda) = (\\lambda - (-2+j))(\\lambda - (-2-j)) = ((\\lambda+2)-j)((\\lambda+2)+j)\n$$\n$$\np_{des}(\\lambda) = (\\lambda+2)^2 - j^2 = (\\lambda+2)^2 + 1 = \\lambda^2 + 4\\lambda + 4 + 1 = \\lambda^2 + 4\\lambda + 5\n$$\nTo place the poles at the desired locations, the actual characteristic polynomial must be identical to the desired one: $p_{A_c}(\\lambda) = p_{des}(\\lambda)$. We equate the coefficients of like powers of $\\lambda$:\n$$\n\\lambda^2 + (1+k_2)\\lambda + (1+k_1) = \\lambda^2 + 4\\lambda + 5\n$$\nComparing the coefficient of $\\lambda^1$:\n$$\n1 + k_2 = 4 \\implies k_2 = 3\n$$\nComparing the coefficient of $\\lambda^0$ (the constant term):\n$$\n1 + k_1 = 5 \\implies k_1 = 4\n$$\nThus, the required state-feedback gain is $K = \\begin{bmatrix} 4  3 \\end{bmatrix}$.\n\nPart 2: Determination of Prefilter $N$\nThe goal is to achieve unit steady-state tracking for a unit step reference, which means the output $y(t)$ must approach $1$ as $t \\to \\infty$ when the input is $r(t) = 1$ for $t \\geq 0$. This steady-state value is denoted $y_{ss}=1$.\nThe closed-loop system dynamics are $\\dot{\\mathbf{x}}(t) = A_c \\mathbf{x}(t) + BNr(t)$, with the output $y(t) = C\\mathbf{x}(t)$.\nThe closed-loop eigenvalues have negative real parts ($-2$), so the closed-loop system is stable. For a constant reference input $r(t) = 1$, the state vector $\\mathbf{x}(t)$ will converge to a constant steady-state value $\\mathbf{x}_{ss}$, at which point its derivative is zero: $\\dot{\\mathbf{x}}_{ss} = \\mathbf{0}$.\nThe steady-state balance equation is:\n$$\n\\mathbf{0} = A_c \\mathbf{x}_{ss} + BN(1)\n$$\nThis gives $A_c \\mathbf{x}_{ss} = -BN$. Since the eigenvalues of $A_c$ are non-zero, $A_c$ is invertible. We can solve for $\\mathbf{x}_{ss}$:\n$$\n\\mathbf{x}_{ss} = -A_c^{-1}BN\n$$\nThe steady-state output $y_{ss}$ is then given by:\n$$\ny_{ss} = C \\mathbf{x}_{ss} = C (-A_c^{-1}BN) = -C A_c^{-1} B N\n$$\nWe require $y_{ss} = 1$. Therefore, we must solve for $N$ from the equation:\n$$\n1 = -C A_c^{-1} B N\n$$\nFirst, we substitute the values of $k_1=4$ and $k_2=3$ into $A_c$:\n$$\nA_c = \\begin{bmatrix} 0  1 \\\\ -1-4  -1-3 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -5  -4 \\end{bmatrix}\n$$\nThe inverse of $A_c$ is $A_c^{-1} = \\frac{1}{\\det(A_c)}\\text{adj}(A_c)$. The determinant is $\\det(A_c) = (0)(-4) - (1)(-5) = 5$.\n$$\nA_c^{-1} = \\frac{1}{5} \\begin{bmatrix} -4  -1 \\\\ 5  0 \\end{bmatrix}\n$$\nNow we compute the scalar quantity $C A_c^{-1} B$:\n$$\nC A_c^{-1} B = \\begin{bmatrix} 1  0 \\end{bmatrix} \\left( \\frac{1}{5} \\begin{bmatrix} -4  -1 \\\\ 5  0 \\end{bmatrix} \\right) \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\n$$\n$$\nC A_c^{-1} B = \\frac{1}{5} \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} -4  -1 \\\\ 5  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5} \\begin{bmatrix} -4  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\frac{1}{5}((-4)(0) + (-1)(1)) = -\\frac{1}{5}\n$$\nSubstituting this result into the tracking condition:\n$$\n1 = - \\left( -\\frac{1}{5} \\right) N = \\frac{1}{5}N\n$$\nSolving for $N$ yields:\n$$\nN = 5\n$$\nThe required gain and prefilter values are $k_1 = 4$, $k_2 = 3$, and $N = 5$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  3  5\n\\end{pmatrix}\n}\n$$", "id": "2907353"}, {"introduction": "A successful controller must perform well not only for the nominal plant model but also in the face of real-world uncertainties. This next exercise [@problem_id:2907421] delves into the crucial topic of robustness by examining the sensitivity of our closed-loop pole locations. By introducing a small, realistic perturbation to the system model, we can quantify how much our carefully placed poles shift, giving us a first, tangible measure of the fragility or resilience of our design.", "problem": "Consider the continuous-time Linear Time-Invariant (LTI) state-space model with state vector $x \\in \\mathbb{R}^{2}$, input $u \\in \\mathbb{R}$, system matrix $A \\in \\mathbb{R}^{2 \\times 2}$, and input matrix $B \\in \\mathbb{R}^{2 \\times 1}$ given by\n$$\nA=\\begin{bmatrix}0  1 \\\\ -10  -1\\end{bmatrix}, \\quad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}.\n$$\nYou design a full state feedback of the form $u=-Kx$, where $K \\in \\mathbb{R}^{1\\times 2}$, to place the closed-loop poles at $s=-2 \\pm 3\\mathrm{i}$.\n\n1. Using only fundamental definitions of closed-loop pole placement for state feedback and standard controllability reasoning, compute the feedback gain $K$ that achieves the specified closed-loop poles.\n2. Model an entry-wise parametric error in the plant by perturbing only the $(2,1)$-entry of $A$ by a multiplicative factor of $1+0.01$, i.e., replace $A_{21}=-10$ by $A_{21}=-10(1+0.01)$. Hold the feedback gain $K$ fixed at the nominal value computed in part 1; do not redesign $K$ after the perturbation.\n3. Define the scalar sensitivity measure $S$ as the maximum absolute shift in closed-loop pole locations between the nominal and perturbed closed-loop matrices, with complex conjugate poles paired by the sign of their imaginary parts. That is, if $\\{\\lambda_{1},\\lambda_{2}\\}$ are the nominal poles and $\\{\\tilde{\\lambda}_{1},\\tilde{\\lambda}_{2}\\}$ are the perturbed poles, ordered so that $\\operatorname{Im}(\\lambda_{i})$ and $\\operatorname{Im}(\\tilde{\\lambda}_{i})$ have the same sign for $i\\in\\{1,2\\}$, then\n$$\nS \\triangleq \\max\\big(|\\tilde{\\lambda}_{1}-\\lambda_{1}|,\\,|\\tilde{\\lambda}_{2}-\\lambda_{2}|\\big).\n$$\n\nWhat is the value of $S$? Round your answer to four significant figures. Express the final result as a pure number (no units). Percentages, if any, must be expressed as decimals or fractions, not with a percentage sign.", "solution": "The problem presented is a standard exercise in linear state-space control theory, specifically concerning pole placement via state feedback and a subsequent sensitivity analysis. The problem is scientifically grounded, well-posed, and objective. It contains all necessary information for a unique solution. Therefore, we proceed with the solution.\n\nFirst, we must verify that the system is controllable. The ability to place the closed-loop poles arbitrarily is guaranteed if and only if the state-space system is completely state controllable. The controllability matrix is given by $\\mathcal{C} = \\begin{bmatrix} B  AB  \\dots  A^{n-1}B \\end{bmatrix}$. For this system, the state dimension is $n=2$. The system matrices are:\n$$\nA=\\begin{bmatrix}0  1 \\\\ -10  -1\\end{bmatrix}, \\quad B=\\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\n$$\nWe compute the product $AB$:\n$$\nAB = \\begin{bmatrix}0  1 \\\\ -10  -1\\end{bmatrix} \\begin{bmatrix}0 \\\\ 1\\end{bmatrix} = \\begin{bmatrix}1 \\\\ -1\\end{bmatrix}\n$$\nThe controllability matrix $\\mathcal{C}$ is:\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ 1  -1\\end{bmatrix}\n$$\nThe system is controllable if and only if $\\mathcal{C}$ has full rank. For a square matrix, this is equivalent to having a non-zero determinant.\n$$\n\\det(\\mathcal{C}) = (0)(-1) - (1)(1) = -1 \\neq 0\n$$\nSince the determinant is non-zero, the system is controllable, and pole placement is possible.\n\nWe now proceed to compute the state feedback gain $K = \\begin{bmatrix} k_1  k_2 \\end{bmatrix}$ such that the closed-loop system $\\dot{x} = (A-BK)x$ has poles at $s = -2 \\pm 3\\mathrm{i}$. The closed-loop system matrix $A_{cl}$ is:\n$$\nA_{cl} = A - BK = \\begin{bmatrix}0  1 \\\\ -10  -1\\end{bmatrix} - \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\\begin{bmatrix}k_1  k_2\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -10  -1\\end{bmatrix} - \\begin{bmatrix}0  0 \\\\ k_1  k_2\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -10-k_1  -1-k_2\\end{bmatrix}\n$$\nThe poles of the closed-loop system are the eigenvalues of $A_{cl}$, which are the roots of the characteristic polynomial $p(s) = \\det(sI - A_{cl})$.\n$$\np(s) = \\det \\begin{bmatrix}s  -1 \\\\ 10+k_1  s+1+k_2\\end{bmatrix} = s(s+1+k_2) - (-1)(10+k_1) = s^2 + (1+k_2)s + (10+k_1)\n$$\nThe desired closed-loop poles are $\\lambda_1 = -2+3\\mathrm{i}$ and $\\lambda_2 = -2-3\\mathrm{i}$. The desired characteristic polynomial $p_{des}(s)$ is:\n$$\np_{des}(s) = (s - \\lambda_1)(s - \\lambda_2) = (s - (-2+3\\mathrm{i}))(s - (-2-3\\mathrm{i})) = ((s+2) - 3\\mathrm{i})((s+2) + 3\\mathrm{i})\n$$\n$$\np_{des}(s) = (s+2)^2 - (3\\mathrm{i})^2 = s^2 + 4s + 4 - 9\\mathrm{i}^2 = s^2 + 4s + 13\n$$\nBy equating the coefficients of $p(s)$ and $p_{des}(s)$, we find the values of $k_1$ and $k_2$:\n$$\ns^2 + (1+k_2)s + (10+k_1) = s^2 + 4s + 13\n$$\nComparing the coefficients of the $s^1$ term:\n$$\n1+k_2 = 4 \\implies k_2 = 3\n$$\nComparing the constant terms (the $s^0$ term):\n$$\n10+k_1 = 13 \\implies k_1 = 3\n$$\nThus, the nominal feedback gain is $K = \\begin{bmatrix} 3  3 \\end{bmatrix}$.\n\nNext, we introduce the specified parametric error. The entry $A_{21}$ of the system matrix is perturbed from $-10$ to $-10(1+0.01) = -10.1$. The perturbed system matrix $A_{pert}$ is:\n$$\nA_{pert} = \\begin{bmatrix}0  1 \\\\ -10.1  -1\\end{bmatrix}\n$$\nThe feedback gain $K$ remains fixed at its nominal value. The perturbed closed-loop system matrix, denoted $A'_{cl}$, is:\n$$\nA'_{cl} = A_{pert} - BK = \\begin{bmatrix}0  1 \\\\ -10.1  -1\\end{bmatrix} - \\begin{bmatrix}0 \\\\ 1\\end{bmatrix}\\begin{bmatrix}3  3\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -10.1  -1\\end{bmatrix} - \\begin{bmatrix}0  0 \\\\ 3  3\\end{bmatrix} = \\begin{bmatrix}0  1 \\\\ -13.1  -4\\end{bmatrix}\n$$\nWe find the eigenvalues of $A'_{cl}$, which are the perturbed closed-loop poles $\\{\\tilde{\\lambda}_{1}, \\tilde{\\lambda}_{2}\\}$. The characteristic polynomial of the perturbed system is $p'(s) = \\det(sI - A'_{cl})$:\n$$\np'(s) = \\det \\begin{bmatrix}s  -1 \\\\ 13.1  s+4\\end{bmatrix} = s(s+4) - (-1)(13.1) = s^2 + 4s + 13.1\n$$\nWe find the roots of $p'(s)=0$ using the quadratic formula $s = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\n\\tilde{\\lambda} = \\frac{-4 \\pm \\sqrt{4^2 - 4(1)(13.1)}}{2(1)} = \\frac{-4 \\pm \\sqrt{16 - 52.4}}{2} = \\frac{-4 \\pm \\sqrt{-36.4}}{2} = -2 \\pm \\frac{\\mathrm{i}\\sqrt{36.4}}{2}\n$$\n$$\n\\tilde{\\lambda} = -2 \\pm \\mathrm{i}\\sqrt{\\frac{36.4}{4}} = -2 \\pm \\mathrm{i}\\sqrt{9.1}\n$$\nSo, the perturbed poles are $\\tilde{\\lambda}_{1,2} = -2 \\pm \\mathrm{i}\\sqrt{9.1}$.\n\nFinally, we calculate the sensitivity measure $S$. The nominal poles are $\\lambda_{1,2} = -2 \\pm 3\\mathrm{i}$. Note that $3 = \\sqrt{9}$. The perturbed poles are $\\tilde{\\lambda}_{1,2} = -2 \\pm \\mathrm{i}\\sqrt{9.1}$.\nWe pair the poles according to the sign of their imaginary parts:\n$$\n\\lambda_1 = -2 + 3\\mathrm{i} \\quad \\text{and} \\quad \\tilde{\\lambda}_1 = -2 + \\mathrm{i}\\sqrt{9.1}\n$$\n$$\n\\lambda_2 = -2 - 3\\mathrm{i} \\quad \\text{and} \\quad \\tilde{\\lambda}_2 = -2 - \\mathrm{i}\\sqrt{9.1}\n$$\nThe sensitivity $S$ is defined as $S = \\max\\big(|\\tilde{\\lambda}_{1}-\\lambda_{1}|,\\,|\\tilde{\\lambda}_{2}-\\lambda_{2}|\\big)$. We compute the individual pole shifts:\n$$\n|\\tilde{\\lambda}_1 - \\lambda_1| = |(-2 + \\mathrm{i}\\sqrt{9.1}) - (-2 + 3\\mathrm{i})| = |\\mathrm{i}(\\sqrt{9.1} - 3)| = |\\sqrt{9.1} - 3|\n$$\n$$\n|\\tilde{\\lambda}_2 - \\lambda_2| = |(-2 - \\mathrm{i}\\sqrt{9.1}) - (-2 - 3\\mathrm{i})| = |-\\mathrm{i}(\\sqrt{9.1} - 3)| = |\\sqrt{9.1} - 3|\n$$\nSince $\\sqrt{9.1} > \\sqrt{9} = 3$, the absolute value is simply $\\sqrt{9.1} - 3$. The two shifts are identical, as expected for a complex conjugate pair under a real parameter perturbation.\n$$\nS = \\sqrt{9.1} - 3\n$$\nTo obtain the numerical value, we compute:\n$$\n\\sqrt{9.1} \\approx 3.0166206256\n$$\n$$\nS \\approx 3.0166206256 - 3 = 0.0166206256\n$$\nRounding to four significant figures, we get $S \\approx 0.01662$.", "answer": "$$\\boxed{0.01662}$$", "id": "2907421"}, {"introduction": "To move from a single-point sensitivity test to a comprehensive robustness assessment, we now turn to more advanced computational tools. Pseudospectral analysis allows us to visualize the effects of all possible perturbations of a given size, revealing regions in the complex plane where our system's poles might migrate. In this final practice [@problem_id:2907358], you will implement a numerical algorithm to compute key pseudospectral metrics, gaining hands-on experience with a powerful technique for quantifying the true stability margins of a feedback system.", "problem": "Design a complete, runnable program that computes and evaluates state feedback for a continuous-time, finite-dimensional, linear time-invariant system using pseudospectral robustness metrics. The plant is given by the state-space pair $A \\in \\mathbb{R}^{2 \\times 2}$ and $B \\in \\mathbb{R}^{2 \\times 1}$ with\n$$\nA = \\begin{bmatrix} 0  1 \\\\ -100  -1 \\end{bmatrix}, \\qquad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\nConsider static state feedback $u = -K x$ with $K \\in \\mathbb{R}^{1 \\times 2}$ so that the closed-loop matrix is $A_{\\text{cl}} = A - B K$.\n\nThe program must, for each test case, perform the following steps grounded in first principles of linear systems and pseudospectral analysis:\n\n1. State feedback design via pole placement: Given a list of desired real closed-loop poles $p_1, p_2 \\in \\mathbb{R}$, compute a feedback gain $K$ such that the eigenvalues of $A_{\\text{cl}}$ are $\\{p_1, p_2\\}$.\n\n2. Robustness assessment via pseudospectra:\n   - For a given matrix $M \\in \\mathbb{C}^{n \\times n}$ and $\\varepsilon \\ge 0$, the $\\varepsilon$-pseudospectrum is defined by\n     $$\n     \\Lambda_{\\varepsilon}(M) = \\{ z \\in \\mathbb{C} : \\sigma_{\\min}(z I - M) \\le \\varepsilon \\},\n     $$\n     where $\\sigma_{\\min}(\\cdot)$ denotes the smallest singular value and $I$ is the identity matrix of appropriate size. The distance to instability of a stable continuous-time matrix $M$ is\n     $$\n     \\delta(M) = \\inf_{\\omega \\in \\mathbb{R}} \\sigma_{\\min}(j \\omega I - M).\n     $$\n     The pseudospectral abscissa at level $\\varepsilon$ is\n     $$\n     \\alpha_{\\varepsilon}(M) = \\sup\\{ \\operatorname{Re}(z) : z \\in \\Lambda_{\\varepsilon}(M) \\}.\n     $$\n   - Numerically approximate $\\delta(A_{\\text{cl}})$ by sampling $\\omega$ on a uniform grid over a symmetric real interval and computing $\\min_{\\omega} \\sigma_{\\min}(j \\omega I - A_{\\text{cl}})$.\n   - Numerically approximate $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ by scanning a rectangular region in the complex plane on a uniform grid and taking the maximum real part among points $z$ where $\\sigma_{\\min}(z I - A_{\\text{cl}}) \\le \\varepsilon$.\n\nUse the following global numerical specifications to ensure universal applicability and reproducibility:\n- Sampling of the imaginary axis for the distance to instability: evaluate $\\sigma_{\\min}(j \\omega I - A_{\\text{cl}})$ for $\\omega \\in [-200, 200]$ sampled at $N_{\\omega} = 20001$ uniformly spaced points.\n- Sampling region and resolution for the pseudospectral abscissa:\n  - Let $\\{\\lambda_i\\}$ denote the eigenvalues of $A_{\\text{cl}}$.\n  - Set $x_{\\min} = \\min_i \\operatorname{Re}(\\lambda_i) - 40$, $x_{\\max} = 10$, and $\\Omega = 200$.\n  - Construct a grid on the rectangle $\\{ x + j \\omega : x \\in [x_{\\min}, x_{\\max}], \\; \\omega \\in [-\\Omega, \\Omega] \\}$ with $N_x = 281$ uniformly spaced points in $x$ and $N_{\\omega}^{\\text{rect}} = 361$ uniformly spaced points in $\\omega$.\n  - On this grid, approximate $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ by the maximum $x$ value among grid points where $\\sigma_{\\min}((x + j \\omega) I - A_{\\text{cl}}) \\le \\varepsilon$. If no grid point satisfies the inequality, report the maximum as $-\\infty$ numerically.\n\nTest Suite:\n- Each test case specifies a desired real pole set and a pair of pseudospectral levels:\n  - Case $1$: desired poles $[-5, -6]$, $\\varepsilon$ levels $[0.05, 0.10]$.\n  - Case $2$: desired poles $[-20, -30]$, $\\varepsilon$ levels $[0.05, 0.20]$.\n  - Case $3$: desired poles $[-0.2, -0.5]$, $\\varepsilon$ levels $[0.01, 0.05]$.\n\nFor each case, the program must:\n- Compute a feedback gain $K$ that places the closed-loop poles as specified.\n- Compute the numerical approximation of $\\delta(A_{\\text{cl}})$ using the imaginary-axis sampling described above.\n- Compute the numerical approximations of $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ for both $\\varepsilon$ levels using the rectangular-grid method described above.\n\nFinal Output Format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case contributes a sublist of three floating-point numbers in the order $[\\delta(A_{\\text{cl}}), \\alpha_{\\varepsilon_1}(A_{\\text{cl}}), \\alpha_{\\varepsilon_2}(A_{\\text{cl}})]$.\n- Concretely, the output must have the form\n  $$\n  \\big[ [d_1, a_{1,1}, a_{1,2}], [d_2, a_{2,1}, a_{2,2}], [d_3, a_{3,1}, a_{3,2}] \\big],\n  $$\n  where $d_i$ are floats for the distances to instability and $a_{i,j}$ are floats for the pseudospectral abscissae at the specified $\\varepsilon$ levels in the same order as listed above.\n- No physical units are involved. Angles, when present as $\\omega$, are in radians per second by convention in continuous-time Fourier analysis but do not need to be printed. All numeric answers must be printed as raw decimal numbers without symbols.", "solution": "The problem is valid as it is scientifically grounded in established principles of linear control theory and numerical analysis, is well-posed, and all parameters are specified unequivocally. We shall proceed with the solution.\n\nThe task is to design a state feedback controller for a linear time-invariant (LTI) system and subsequently evaluate its robustness using pseudospectral metrics. The procedure involves two principal stages: controller synthesis via pole placement and robustness analysis.\n\nFirst, we design the state feedback gain $K$. The given plant is described by the state-space model $\\dot{x} = Ax + Bu$, with matrices\n$$\nA = \\begin{bmatrix} 0  1 \\\\ -100  -1 \\end{bmatrix}, \\qquad B = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\nThe system is of order $n=2$ with a single input, $m=1$. The control law is a static state feedback $u = -Kx$, where $K \\in \\mathbb{R}^{1 \\times 2}$. The closed-loop system dynamics are given by $\\dot{x} = (A - BK)x = A_{\\text{cl}}x$.\n\nFor arbitrary pole placement to be possible, the pair $(A, B)$ must be controllable. The controllability matrix for this system is\n$$\n\\mathcal{C} = \\begin{bmatrix} B  AB \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ 1  -1 \\end{bmatrix}.\n$$\nThe determinant is $\\det(\\mathcal{C}) = -1 \\ne 0$, so the matrix has full rank ($2$). The system is therefore controllable, and we can place the closed-loop eigenvalues at any desired locations $\\{p_1, p_2\\}$ in the complex plane (provided they form a conjugate pair if complex). The problem specifies real poles.\n\nLet the feedback gain be $K = \\begin{bmatrix} k_1  k_2 \\end{bmatrix}$. The closed-loop matrix $A_{\\text{cl}}$ is\n$$\nA_{\\text{cl}} = A - BK = \\begin{bmatrix} 0  1 \\\\ -100  -1 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} \\begin{bmatrix} k_1  k_2 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\\\ -100 - k_1  -1 - k_2 \\end{bmatrix}.\n$$\nThe characteristic polynomial of $A_{\\text{cl}}$ is $\\chi_{A_{\\text{cl}}}(\\lambda) = \\det(\\lambda I - A_{\\text{cl}})$, which evaluates to:\n$$\n\\chi_{A_{\\text{cl}}}(\\lambda) = \\lambda^2 + (1 + k_2)\\lambda + (100 + k_1).\n$$\nThe desired characteristic polynomial for poles $p_1$ and $p_2$ is\n$$\n\\chi_{\\text{des}}(\\lambda) = (\\lambda - p_1)(\\lambda - p_2) = \\lambda^2 - (p_1 + p_2)\\lambda + p_1p_2.\n$$\nBy equating the coefficients of $\\chi_{A_{\\text{cl}}}(\\lambda)$ and $\\chi_{\\text{des}}(\\lambda)$, we obtain the gains $k_1$ and $k_2$:\n$$\n1 + k_2 = -(p_1 + p_2) \\implies k_2 = -1 - p_1 - p_2\n$$\n$$\n100 + k_1 = p_1 p_2 \\implies k_1 = p_1 p_2 - 100\n$$\nThus, the feedback gain is uniquely determined by the desired poles: $K = \\begin{bmatrix} p_1 p_2 - 100  -1 - p_1 - p_2 \\end{bmatrix}$.\n\nSecond, we assess the robustness of the resulting closed-loop system. While the eigenvalues of $A_{\\text{cl}}$ dictate stability, they can be highly sensitive to perturbations, especially if $A_{\\text{cl}}$ is non-normal (i.e., $A_{\\text{cl}}A_{\\text{cl}}^T \\neq A_{\\text{cl}}^T A_{\\text{cl}}$). Pseudospectra provide a more robust picture of system behavior under uncertainty.\n\nThe $\\varepsilon$-pseudospectrum, $\\Lambda_{\\varepsilon}(M)$, is the set of complex numbers $z$ that are eigenvalues of a perturbed matrix $M+E$ where the norm of the perturbation $\\|E\\|_2 \\le \\varepsilon$. An equivalent and computationally practical definition is provided:\n$$\n\\Lambda_{\\varepsilon}(M) = \\{ z \\in \\mathbb{C} : \\sigma_{\\min}(z I - M) \\le \\varepsilon \\},\n$$\nwhere $\\sigma_{\\min}(\\cdot)$ is the smallest singular value. This definition connects the pseudospectrum to the resolvent norm, $\\|(z I - M)^{-1}\\|_2 = 1/\\sigma_{\\min}(z I - M)$.\n\nWe compute two key robustness metrics derived from the pseudospectrum:\n$1$. The distance to instability, $\\delta(A_{\\text{cl}})$, is the smallest perturbation (in the $2$-norm sense) that can move an eigenvalue onto the imaginary axis, thus destabilizing the system. For a stable continuous-time system, it is defined as:\n$$\n\\delta(A_{\\text{cl}}) = \\inf_{\\omega \\in \\mathbb{R}} \\sigma_{\\min}(j \\omega I - A_{\\text{cl}}).\n$$\nWe approximate this value by performing a grid search over a specified interval of frequencies $\\omega \\in [-200, 200]$ with $N_{\\omega} = 20001$ points. The minimum $\\sigma_{\\min}$ value found on this grid serves as the numerical estimate for $\\delta(A_{\\text{cl}})$.\n\n$2$. The pseudospectral abscissa, $\\alpha_{\\varepsilon}(A_{\\text{cl}})$, is the maximum real part of any point in the $\\varepsilon$-pseudospectrum:\n$$\n\\alpha_{\\varepsilon}(A_{\\text{cl}}) = \\sup\\{ \\operatorname{Re}(z) : z \\in \\Lambda_{\\varepsilon}(A_{\\text{cl}}) \\}.\n$$\nThis metric quantifies the largest possible transient growth rate or the most rightward eigenvalue of a perturbed system. A positive $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ for a stable matrix $A_{\\text{cl}}$ implies that a perturbation of size $\\varepsilon$ can destabilize the system. We approximate $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ by discretizing a rectangular region in the complex plane. The region is defined by $x \\in [\\min_i \\operatorname{Re}(\\lambda_i) - 40, 10]$ and $\\omega \\in [-200, 200]$, with grid sizes $N_x = 281$ and $N_{\\omega}^{\\text{rect}} = 361$. For each grid point $z = x + j\\omega$, we compute $\\sigma_{\\min}(z I - A_{\\text{cl}})$. The approximation of $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ is the largest real part $x$ among all grid points for which $\\sigma_{\\min}(z I - A_{\\text{cl}}) \\le \\varepsilon$. If no such point is found, the value is taken to be $-\\infty$.\n\nThe program implements these steps for each test case provided. It first calculates the gain $K$, then forms $A_{\\text{cl}}$, and proceeds to compute the numerical approximations for $\\delta(A_{\\text{cl}})$ and $\\alpha_{\\varepsilon}(A_{\\text{cl}})$ for the given $\\varepsilon$ levels. All computations are performed using floating-point arithmetic as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import svdvals\n\ndef solve():\n    \"\"\"\n    Computes state feedback gains and evaluates pseudospectral robustness metrics\n    for a given LTI system and a set of test cases.\n    \"\"\"\n    # Define the system matrices as specified in the problem statement.\n    A = np.array([[0.0, 1.0], [-100.0, -1.0]])\n    B = np.array([[0.0], [1.0]])\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'poles': [-5.0, -6.0], 'epsilons': [0.05, 0.10]},\n        {'poles': [-20.0, -30.0], 'epsilons': [0.05, 0.20]},\n        {'poles': [-0.2, -0.5], 'epsilons': [0.01, 0.05]},\n    ]\n    \n    # Global numerical specifications\n    # For distance to instability\n    omega_range_dist = [-200.0, 200.0]\n    N_omega_dist = 20001\n    \n    # For pseudospectral abscissa\n    x_max = 10.0\n    x_min_offset = -40.0\n    omega_range_rect = [-200.0, 200.0]\n    Nx_rect = 281\n    N_omega_rect = 361\n\n    # List to store formatted results for each case.\n    results = []\n    \n    identity = np.eye(2)\n\n    for case in test_cases:\n        poles = case['poles']\n        epsilons = case['epsilons']\n        \n        # 1. State feedback design via pole placement\n        p1, p2 = poles\n        k1 = p1 * p2 - 100.0\n        k2 = -1.0 - (p1 + p2)\n        K = np.array([[k1, k2]])\n        \n        A_cl = A - B @ K\n        \n        # 2. Robustness assessment\n        \n        # 2a. Approximate the distance to instability\n        omega_grid_dist = np.linspace(omega_range_dist[0], omega_range_dist[1], N_omega_dist)\n        \n        min_sv = np.inf\n        for omega in omega_grid_dist:\n            M = (1j * omega) * identity - A_cl\n            # svdvals returns singular values in descending order; smallest is last.\n            s_min = svdvals(M)[-1]\n            if s_min  min_sv:\n                min_sv = s_min\n        \n        dist_instability = min_sv\n        \n        # 2b. Approximate the pseudospectral abscissa for each epsilon\n        alpha_results = []\n        \n        # Since poles are real, Re(lambda) is just the pole value itself.\n        x_min = min(poles) + x_min_offset\n        \n        x_grid = np.linspace(x_min, x_max, Nx_rect)\n        omega_grid_rect = np.linspace(omega_range_rect[0], omega_range_rect[1], N_omega_rect)\n        \n        for eps in epsilons:\n            max_x = -np.inf\n            found_solution = False\n            # Iterate x from largest to smallest for efficiency.\n            # The first x for which a solution exists is the maximum.\n            for x in reversed(x_grid):\n                for omega in omega_grid_rect:\n                    z = x + 1j * omega\n                    M = z * identity - A_cl\n                    s_min = svdvals(M)[-1]\n                    \n                    if s_min = eps:\n                        max_x = x\n                        found_solution = True\n                        break  # Found omega for this x, break inner loop.\n                if found_solution:\n                    break # Found the largest x, break outer loop.\n\n            alpha_results.append(max_x)\n\n        case_results = [dist_instability] + alpha_results\n        \n        # Format the sublist of results for this case as a string without spaces\n        results.append(f\"[{','.join(map(str, case_results))}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2907358"}]}