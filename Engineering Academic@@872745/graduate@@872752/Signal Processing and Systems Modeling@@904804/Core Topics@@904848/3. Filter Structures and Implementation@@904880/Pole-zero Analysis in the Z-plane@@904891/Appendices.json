{"hands_on_practices": [{"introduction": "The location of poles and the Region of Convergence (ROC) uniquely determine a system's time-domain behavior. This first practice provides a foundational exercise in deriving the impulse response for a stable, causal system from its transfer function. By working from first principles, you will solidify the connection between a pole's location inside the unit circle and the decaying exponential form of a right-sided sequence [@problem_id:2891667].", "problem": "Consider a linear time-invariant discrete-time system with transfer function in the complex $z$-plane given by\n$$\nH(z)=\\frac{1}{\\bigl(1-0.8\\,z^{-1}\\bigr)\\bigl(1-0.5\\,z^{-1}\\bigr)},\n$$\nand region of convergence (ROC) specified as $\\lvert z\\rvert0.8$. Starting only from the definition of the $z$-transform, $X(z)=\\sum_{n=-\\infty}^{\\infty} x[n]\\,z^{-n}$, and the concept of a region of convergence for a power series, derive the impulse response $h[n]=\\mathcal{Z}^{-1}\\{H(z)\\}$ explicitly. Your derivation must proceed by algebraic decomposition justified via the core properties of the $z$-transform (such as linearity) and convergence of geometric series, not by invoking any transform table beyond facts derivable from these bases. Then, use the given ROC and your expression to confirm that the resulting $h[n]$ is right-sided. Express your final answer in closed form using the unit step sequence $u[n]$. No numerical rounding is required.", "solution": "The problem presented is a standard exercise in the analysis of linear time-invariant (LTI) discrete-time systems. We must first validate its premises before proceeding to a solution.\n\nStep 1: Extract Givens\nThe problem provides the following:\n1.  The system is a linear time-invariant (LTI) discrete-time system.\n2.  The transfer function in the $z$-domain is $H(z)=\\frac{1}{\\bigl(1-0.8\\,z^{-1}\\bigr)\\bigl(1-0.5\\,z^{-1}\\bigr)}$.\n3.  The region of convergence (ROC) is specified as $\\lvert z\\rvert0.8$.\n4.  The derivation must be based on the definition of the $z$-transform, $X(z)=\\sum_{n=-\\infty}^{\\infty} x[n]\\,z^{-n}$, and fundamental properties such as linearity and the convergence of geometric series.\n5.  Standard transform tables are not to be used, except for results directly derivable from these first principles.\n6.  The final answer for the impulse response $h[n]$ must be expressed in closed form using the unit step sequence $u[n]$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, being a canonical problem in digital signal processing. It is well-posed because the transfer function $H(z)$ combined with a specified region of convergence (ROC) uniquely determines the impulse response $h[n]$. The problem is objective and uses precise mathematical language. There are no contradictions, missing information, or violations of physical or mathematical principles. The constraint to derive the solution from first principles is a pedagogical requirement, not a flaw; it ensures that a fundamental understanding is demonstrated, rather than rote application of a formula.\n\nStep 3: Verdict and Action\nThe problem is valid. I will now proceed with a rigorous derivation.\n\nThe task is to find the impulse response $h[n]$ corresponding to the given transfer function $H(z)$ and its ROC. The impulse response is the inverse $z$-transform of the transfer function, $h[n] = \\mathcal{Z}^{-1}\\{H(z)\\}$.\n\nThe transfer function $H(z)$ is a rational function of $z^{-1}$. A direct inversion from its current form is not straightforward. We must first decompose $H(z)$ into a sum of simpler terms using partial fraction expansion. Let us write $H(z)$ as:\n$$ H(z) = \\frac{A}{1-0.8\\,z^{-1}} + \\frac{B}{1-0.5\\,z^{-1}} $$\nTo find the coefficient $A$, we can use the cover-up method. Multiply both sides by $(1-0.8\\,z^{-1})$ and evaluate at the value of $z^{-1}$ that makes this term zero, which is $z^{-1} = 1/0.8$.\n$$ A = \\left. \\frac{1}{1-0.5\\,z^{-1}} \\right|_{z^{-1}=1/0.8} = \\frac{1}{1-0.5 \\cdot \\frac{1}{0.8}} = \\frac{1}{1 - \\frac{1/2}{4/5}} = \\frac{1}{1 - \\frac{5}{8}} = \\frac{1}{3/8} = \\frac{8}{3} $$\nSimilarly, to find the coefficient $B$, we multiply by $(1-0.5\\,z^{-1})$ and evaluate at $z^{-1} = 1/0.5 = 2$.\n$$ B = \\left. \\frac{1}{1-0.8\\,z^{-1}} \\right|_{z^{-1}=2} = \\frac{1}{1-0.8 \\cdot 2} = \\frac{1}{1-1.6} = \\frac{1}{-0.6} = \\frac{1}{-3/5} = -\\frac{5}{3} $$\nThus, the partial fraction expansion of $H(z)$ is:\n$$ H(z) = \\frac{8/3}{1-0.8\\,z^{-1}} - \\frac{5/3}{1-0.5\\,z^{-1}} $$\nBy the linearity of the $z$-transform, the inverse transform of the sum is the sum of the inverse transforms:\n$$ h[n] = \\mathcal{Z}^{-1}\\{H(z)\\} = \\frac{8}{3}\\mathcal{Z}^{-1}\\left\\{\\frac{1}{1-0.8\\,z^{-1}}\\right\\} - \\frac{5}{3}\\mathcal{Z}^{-1}\\left\\{\\frac{1}{1-0.5\\,z^{-1}}\\right\\} $$\nWe must now find the inverse transform of each term based on first principles. Consider a generic term of the form $\\frac{1}{1-a z^{-1}}$. We rely on the formula for the sum of a geometric series: $\\sum_{k=0}^{\\infty} r^k = \\frac{1}{1-r}$, which converges for $|r|1$.\n\nLet us analyze the transform pair for a right-sided exponential sequence $x[n] = a^n u[n]$. The unit step function $u[n]$ is defined as $1$ for $n \\ge 0$ and $0$ for $n  0$. The $z$-transform is:\n$$ \\mathcal{Z}\\{a^n u[n]\\} = \\sum_{n=-\\infty}^{\\infty} (a^n u[n]) z^{-n} = \\sum_{n=0}^{\\infty} a^n z^{-n} = \\sum_{n=0}^{\\infty} (a z^{-1})^n $$\nThis is a geometric series with ratio $r = a z^{-1}$. The series converges if and only if $|a z^{-1}|  1$, which is equivalent to $|z|  |a|$. When it converges, its sum is $\\frac{1}{1 - a z^{-1}}$. Therefore, we have the fundamental transform pair for a right-sided sequence:\n$$ \\mathcal{Z}\\{a^n u[n]\\} = \\frac{1}{1 - a z^{-1}}, \\quad \\text{ROC: } |z|  |a| $$\nThe problem specifies the overall ROC as $|z|0.8$. This region is exterior to a circle of radius $0.8$.\nFor the first term, $\\frac{1}{1-0.8\\,z^{-1}}$, the pole is at $z=0.8$. The given ROC, $|z|0.8$, corresponds to the region outside this pole. This matches the condition for a right-sided sequence with $a=0.8$. Consequently,\n$$ \\mathcal{Z}^{-1}\\left\\{\\frac{1}{1-0.8\\,z^{-1}}\\right\\} = (0.8)^n u[n] $$\nFor the second term, $\\frac{1}{1-0.5\\,z^{-1}}$, the pole is at $z=0.5$. The overall ROC $|z|0.8$ inherently satisfies the condition $|z|0.5$. This also corresponds to a right-sided sequence, with $a=0.5$. Thus,\n$$ \\mathcal{Z}^{-1}\\left\\{\\frac{1}{1-0.5\\,z^{-1}}\\right\\} = (0.5)^n u[n] $$\nCombining these results using linearity, we obtain the impulse response $h[n]$:\n$$ h[n] = \\frac{8}{3}(0.8)^n u[n] - \\frac{5}{3}(0.5)^n u[n] $$\nThis can be written more compactly as:\n$$ h[n] = \\left( \\frac{8}{3}(0.8)^n - \\frac{5}{3}(0.5)^n \\right) u[n] $$\nFinally, we must confirm that the resulting $h[n]$ is a right-sided sequence. A sequence $x[n]$ is defined as right-sided if there exists an integer $N_1$ such that $x[n]=0$ for all $nN_1$. In our derived expression for $h[n]$, the presence of the unit step function $u[n]$ ensures that $h[n]=0$ for all $n0$. This satisfies the definition of a right-sided sequence (specifically, a causal sequence, which is a subset of right-sided sequences). This result is consistent with the general principle that a rational transfer function with an ROC of the form $|z|  r_{\\text{max}}$, where $r_{\\text{max}}$ is the magnitude of the outermost pole, corresponds to a causal impulse response. Here, the outermost pole is at $z=0.8$, and the ROC is correctly given as $|z|0.8$. The derivation confirms this principle from fundamental definitions.", "answer": "$$\n\\boxed{\\left( \\frac{8}{3}(0.8)^n - \\frac{5}{3}(0.5)^n \\right) u[n]}\n$$", "id": "2891667"}, {"introduction": "Building on the previous example, we now explore systems that are not strictly causal. An annular ROC, bounded by two poles, corresponds to a two-sided sequence that is non-zero for both positive and negative time. This exercise challenges you to apply different inversion rules to the same rational form based on whether the ROC is inside or outside the corresponding pole, reinforcing the crucial role of the ROC in defining the signal [@problem_id:2891662].", "problem": "Consider the two-sided Z-transform $X(z)$ of a discrete-time signal $x[n]$, defined by the series $X(z)=\\sum_{n=-\\infty}^{\\infty} x[n] z^{-n}$ on its Region of Convergence (ROC). Let\n$$\nX(z)=\\frac{z}{z-2}+\\frac{z}{z-\\frac{1}{3}}\n$$\nwith ROC specified as $\\frac{1}{3}|z|2$. Starting from the definition of the Z-transform and the convergence properties of geometric series, determine the time-domain sequence $x[n]$ consistent with the given ROC. Express your result using the unit step function $u[n]$ and integer powers of real numbers, and explicitly identify the left-sided and right-sided components that make the overall sequence two-sided. Provide your final answer as a single closed-form expression for $x[n]$ in terms of $n$. No rounding is required, and no units are involved.", "solution": "The problem of determining the time-domain sequence $x[n]$ from its Z-transform $X(z)$ and the associated Region of Convergence (ROC) is a fundamental procedure in the analysis of linear time-invariant systems. The uniqueness of the inverse Z-transform is guaranteed only when the ROC is specified.\n\nThe given Z-transform is:\n$$\nX(z) = \\frac{z}{z-2} + \\frac{z}{z-\\frac{1}{3}}\n$$\nThe specified ROC is an annulus defined by $\\frac{1}{3}  |z|  2$.\n\nBy the linearity property of the Z-transform, we can analyze each term separately. Let $X(z) = X_1(z) + X_2(z)$, where:\n$$\nX_1(z) = \\frac{z}{z-2} \\quad \\text{and} \\quad X_2(z) = \\frac{z}{z-\\frac{1}{3}}\n$$\nThe poles of $X(z)$ are the poles of its constituent parts, which are located at $p_1 = 2$ and $p_2 = \\frac{1}{3}$. The given ROC, $\\frac{1}{3}  |z|  2$, is an annulus bounded by these two poles. This indicates that the overall sequence $x[n]$ is two-sided. The ROC is the intersection of the ROCs of the individual components, $x_1[n]$ and $x_2[n]$. Specifically, the ROC for $X_1(z)$ must be $|z|2$, which is inside the pole $p_1=2$, corresponding to a left-sided sequence. The ROC for $X_2(z)$ must be $|z|\\frac{1}{3}$, which is outside the pole $p_2=\\frac{1}{3}$, corresponding to a right-sided sequence.\n\nFirst, we determine the right-sided component, $x_2[n]$, corresponding to $X_2(z)$ with ROC $|z|  \\frac{1}{3}$. A standard Z-transform pair for a right-sided sequence is $a^n u[n] \\leftrightarrow \\frac{z}{z-a}$ with ROC $|z|  |a|$. By direct application of this pair with $a = \\frac{1}{3}$, we have:\n$$\nx_2[n] = \\left(\\frac{1}{3}\\right)^n u[n]\n$$\nThis is the right-sided component of $x[n]$. We can verify this from first principles. For the ROC $|z|  \\frac{1}{3}$, we can expand $X_2(z)$ as a power series in $z^{-1}$:\n$$\nX_2(z) = \\frac{z}{z-\\frac{1}{3}} = \\frac{1}{1-\\frac{1}{3}z^{-1}}\n$$\nThe condition for convergence of the geometric series $\\sum_{k=0}^{\\infty} r^k = \\frac{1}{1-r}$ is $|r|1$. Here, $r = \\frac{1}{3}z^{-1}$, so convergence is guaranteed for $|\\frac{1}{3}z^{-1}|1$, which simplifies to $|z|\\frac{1}{3}$. This matches the required ROC. The expansion is:\n$$\nX_2(z) = \\sum_{n=0}^{\\infty} \\left(\\frac{1}{3}z^{-1}\\right)^n = \\sum_{n=0}^{\\infty} \\left(\\frac{1}{3}\\right)^n z^{-n}\n$$\nBy comparing this to the definition of the Z-transform, $X(z) = \\sum_{n=-\\infty}^{\\infty} x[n]z^{-n}$, we see that $x_2[n] = (\\frac{1}{3})^n$ for $n \\ge 0$ and $x_2[n]=0$ for $n0$. This is precisely $(\\frac{1}{3})^n u[n]$.\n\nNext, we determine the left-sided component, $x_1[n]$, corresponding to $X_1(z)$ with ROC $|z|2$. A standard Z-transform pair for a left-sided sequence is $-a^n u[-n-1] \\leftrightarrow \\frac{z}{z-a}$ with ROC $|z|  |a|$. Applying this pair with $a=2$, we get:\n$$\nx_1[n] = -2^n u[-n-1]\n$$\nThis is the left-sided component of $x[n]$. We can also verify this from first principles. For the ROC $|z|2$, we must expand $X_1(z)$ as a power series in $z$:\n$$\nX_1(z) = \\frac{z}{z-2} = -\\frac{z}{2-z} = -\\frac{z}{2} \\left(\\frac{1}{1-\\frac{z}{2}}\\right)\n$$\nThe geometric series converges for $|\\frac{z}{2}|1$, which is $|z|2$, matching the ROC. The expansion is:\n$$\nX_1(z) = -\\frac{z}{2} \\sum_{k=0}^{\\infty} \\left(\\frac{z}{2}\\right)^k = -\\sum_{k=0}^{\\infty} \\left(\\frac{1}{2}\\right)^{k+1} z^{k+1}\n$$\nTo match the Z-transform definition with powers of $z^{-n}$, we perform a change of index. Let $n = -(k+1)$. As $k$ runs from $0, 1, 2, \\dots$, $n$ runs from $-1, -2, -3, \\dots$. So, $k=-n-1$ and $k+1 = -n$. The sum becomes:\n$$\nX_1(z) = -\\sum_{n=-\\infty}^{-1} \\left(\\frac{1}{2}\\right)^{-n} z^{-n} = \\sum_{n=-\\infty}^{-1} (-2^n) z^{-n}\n$$\nBy comparing this to the Z-transform definition, we identify $x_1[n] = -2^n$ for $n \\le -1$ and $x_1[n]=0$ for $n \\ge 0$. This is precisely $-2^n u[-n-1]$.\n\nThe total sequence $x[n]$ is the sum of its left-sided and right-sided components:\n$$\nx[n] = x_1[n] + x_2[n] = -2^n u[-n-1] + \\left(\\frac{1}{3}\\right)^n u[n]\n$$\nThis expression is the complete description of the two-sided sequence $x[n]$ corresponding to the given Z-transform $X(z)$ and its specified ROC.", "answer": "$$\n\\boxed{\\left(\\frac{1}{3}\\right)^n u[n] - 2^n u[-n-1]}\n$$", "id": "2891662"}, {"introduction": "While pole-zero analysis of the transfer function $H(z)$ is powerful, it only describes the input-output relationship and can sometimes mask critical internal behaviors. This advanced problem delves into the distinction between input-output (BIBO) stability and internal stability using a state-space representation. You will construct a system where an unstable pole is canceled by a zero in the transfer function, leading to a stable-looking $H(z)$ that hides a divergent internal state, a crucial concept in robust system design [@problem_id:2891641].", "problem": "A Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) discrete-time system can be described either by a transfer function $H(z)$ or by a state-space realization $(A,B,C,D)$. Bounded-Input Bounded-Output (BIBO) stability is an input-output notion tied to the map $u \\mapsto y$, whereas internal stability concerns the asymptotic behavior of the state $x$ governed by the homogeneous recursion $x[k+1]=A x[k]$. It is sometimes claimed that exact pole-zero cancellation in $H(z)$ ensures that any realization that implements the same input-output map is internally stable. Consider the following propositional options, each combining an explanation and a concrete candidate realization intended to demonstrate or refute this claim. Assume zero initial conditions $x[0]=0$ and a bounded input $u[k]$ defined by the unit impulse $u[k]=\\delta[k]$, where $\\delta[k]$ equals $1$ at $k=0$ and $0$ otherwise.\n\nSelect all options that are correct in both parts: (i) the explanation accurately states why exact pole-zero cancellation in $H(z)$ can mask internal instability in certain realizations, and (ii) the provided state-space $(A,B,C,D)$ with a specified real parameter $p$ and $|p|1$ yields an input-output map whose frequency response $H(e^{j\\omega})$ exists and is bounded for all real $\\omega$, while the internal state diverges under the given bounded input.\n\nA. Exact pole-zero cancellation can hide unstable internal dynamics in non-minimal realizations because the canceled pole corresponds to an unobservable or uncontrollable mode with respect to the input-output map. BIBO stability depends only on $H(z)$, not on modes that have been canceled from the input-output perspective. A concrete realization exhibiting this is\n$\nA=\\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix},\\quad\nB=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\nC=\\begin{bmatrix} 1  -p \\end{bmatrix},\\quad\nD=0,\n$\nwith $|p|1$. For $u[k]=\\delta[k]$, $x[k]$ diverges even though $H(e^{j\\omega})$ exists and is bounded for all real $\\omega$.\n\nB. If $H(z)$ simplifies by exact pole-zero cancellation to a transfer function without poles outside the unit circle, then every realization that implements it must be internally stable; internal instability cannot occur when $H(e^{j\\omega})$ is bounded. Therefore, no counterexample exists.\n\nC. Exact pole-zero cancellation can hide unstable internal dynamics, but only if the unstable mode is directly driven by the input. Consider\n$\nA=\\begin{bmatrix} p  0 \\\\ 0  0 \\end{bmatrix},\\quad\nB=\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\quad\nC=\\begin{bmatrix} 1  0 \\end{bmatrix},\\quad\nD=0,\n$\nwith $|p|1$. This realization has $H(e^{j\\omega})=0$ and hence bounded, and its internal state $x[k]$ diverges under the given input.\n\nD. Exact pole-zero cancellation does not affect internal stability, but the following realization nevertheless shows that $H(e^{j\\omega})$ can be bounded even if the state diverges:\n$\nA=\\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix},\\quad\nB=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\quad\nC=\\begin{bmatrix} 1  0 \\end{bmatrix},\\quad\nD=0,\n$\nwith $|p|1$. Here the state diverges for $u[k]=\\delta[k]$, yet $H(e^{j\\omega})$ is bounded for all real $\\omega$.", "solution": "The problem statement will first be validated for scientific soundness, self-consistency, and clarity before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- System is a Single-Input Single-Output (SISO) Linear Time-Invariant (LTI) discrete-time system.\n- Descriptions: Transfer function $H(z)$ or state-space realization $(A,B,C,D)$.\n- State-space equations: $x[k+1] = Ax[k] + Bu[k]$, $y[k] = Cx[k] + Du[k]$.\n- BIBO Stability: An input-output property of the map $u \\mapsto y$.\n- Internal Stability: Relates to the asymptotic behavior of the state $x$ in the homogeneous system $x[k+1] = Ax[k]$.\n- Claim to evaluate: \"exact pole-zero cancellation in $H(z)$ ensures that any realization that implements the same input-output map is internally stable.\"\n- Task: Evaluate options based on two criteria:\n    1. The correctness of the explanation regarding how pole-zero cancellation can mask internal instability.\n    2. The correctness of a concrete state-space realization $(A,B,C,D)$ with a real parameter $p$ where $|p|1$, which must exhibit two behaviors:\n        a. The frequency response $H(e^{j\\omega})$ exists and is bounded for all real $\\omega$.\n        b. The internal state $x[k]$ diverges for a bounded input.\n- Initial conditions: $x[0]=0$.\n- Input: Bounded unit impulse, $u[k] = \\delta[k]$, where $\\delta[k] = 1$ for $k=0$ and $\\delta[k] = 0$ for $k \\ne 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem statement is based on fundamental and well-established principles of linear systems theory, specifically the distinction between BIBO (input-output) stability and internal (asymptotic) stability, and the role of pole-zero cancellations in non-minimal state-space realizations. All concepts are standard in control theory and signal processing.\n- **Well-Posed:** The problem is clearly structured. It presents a general claim and asks for an evaluation of specific propositional options, each consisting of a theoretical explanation and a concrete mathematical example. The criteria for a correct option are explicitly defined.\n- **Objective:** The language is formal, precise, and free of subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is scientifically sound, self-contained, and well-posed. A rigorous solution can be derived from first principles.\n\n### Solution Derivation\n\nThe analysis rests on the following principles for a discrete-time LTI system described by $(A,B,C,D)$:\n\n1.  **Transfer Function:** The transfer function from the input $u$ to the output $y$ is given by the Z-transform of the impulse response, which for a state-space model is $H(z) = C(zI - A)^{-1}B + D$.\n2.  **Internal Stability:** The system is internally (asymptotically) stable if and only if all eigenvalues of the state matrix $A$ lie strictly inside the unit circle in the complex plane (i.e., $|\\lambda_i|  1$ for all eigenvalues $\\lambda_i$ of $A$). If any eigenvalue has a magnitude greater than $1$, the system is internally unstable.\n3.  **Input-Output Stability:** A common definition of Bounded-Input Bounded-Output (BIBO) stability requires all poles of the transfer function $H(z)$ to lie strictly inside the unit circle. The problem specifies a related but weaker condition: the frequency response $H(e^{j\\omega})$ must exist and be bounded for all $\\omega \\in \\mathbb{R}$. This implies that $H(z)$ has no poles on the unit circle $|z|=1$.\n4.  **Pole-Zero Cancellation:** The poles of $H(z)$ are a subset of the eigenvalues of $A$. An eigenvalue of $A$ fails to be a pole of $H(z)$ if it is \"cancelled.\" This cancellation occurs if the mode associated with that eigenvalue is either uncontrollable or unobservable. A realization is called \"minimal\" if all its modes are both controllable and observable. In non-minimal realizations, pole-zero cancellations can occur.\n5.  **State Response:** For zero initial conditions ($x[0]=0$) and an impulse input ($u[k]=\\delta[k]$), the state vector evolves as $x[k] = A^{k-1}B$ for $k \\ge 1$. The state diverges if $\\|x[k]\\| \\to \\infty$ as $k \\to \\infty$. This occurs if an unstable mode (an eigenvalue $\\lambda$ with $|\\lambda|1$) is excited by the input.\n\nThe central issue is that an internally unstable system (having an eigenvalue $|\\lambda|  1$) can appear stable from an input-output perspective if the unstable mode is unobservable or uncontrollable, leading to a pole-zero cancellation in $H(z)$.\n\nWe now evaluate each option.\n\n**Option A**\n\n- **(i) Explanation:** \"Exact pole-zero cancellation can hide unstable internal dynamics in non-minimal realizations because the canceled pole corresponds to an unobservable or uncontrollable mode with respect to the input-output map. BIBO stability depends only on $H(z)$, not on modes that have been canceled from the input-output perspective.\" This explanation is a correct and precise statement of fact in linear systems theory. A non-minimal realization contains modes that do not affect the input-output relationship, and if such a mode is unstable, internal instability is \"hidden\" from the transfer function.\n- **(ii) Realization:**\n    $A=\\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix},\\ B=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\ C=\\begin{bmatrix} 1  -p \\end{bmatrix},\\ D=0,$ with $|p|1$.\n    - **Internal Stability:** The characteristic polynomial is $\\det(zI-A) = \\det\\begin{pmatrix} z-p  0 \\\\ -1  z \\end{pmatrix} = z(z-p) = 0$. The eigenvalues are $\\lambda_1 = p$ and $\\lambda_2 = 0$. Since $|p|1$, the system is internally unstable.\n    - **Transfer Function:**\n    $$ H(z) = C(zI-A)^{-1}B = \\begin{bmatrix} 1  -p \\end{bmatrix} \\frac{1}{z(z-p)} \\begin{bmatrix} z  0 \\\\ 1  z-p \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} $$\n    $$ H(z) = \\frac{1}{z(z-p)} \\begin{bmatrix} 1  -p \\end{bmatrix} \\begin{bmatrix} z \\\\ 1 \\end{bmatrix} = \\frac{z-p}{z(z-p)} = \\frac{1}{z} $$\n    A pole-zero cancellation at $z=p$ has occurred. The resulting $H(z) = 1/z$ has its only pole at $z=0$, which is inside the unit circle. The frequency response is $H(e^{j\\omega}) = e^{-j\\omega}$, which has a constant magnitude of $1$ and is therefore bounded for all $\\omega$.\n    - **State Divergence:** For $u[k]=\\delta[k]$ and $x[0]=0$, the state is $x[k] = A^{k-1}B$ for $k \\ge 1$.\n    $x[1] = B = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$.\n    $x[2] = AB = \\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} p \\\\ 1 \\end{bmatrix}$.\n    $x[3] = A^2B = \\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix} \\begin{bmatrix} p \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} p^2 \\\\ p \\end{bmatrix}$.\n    By induction, for $k \\ge 2$, $x[k] = \\begin{bmatrix} p^{k-1} \\\\ p^{k-2} \\end{bmatrix}$. Since $|p|1$, $\\|x[k]\\|$ grows without bound as $k \\to \\infty$. The state diverges.\n- **Verdict for A:** The explanation is correct, and the provided realization satisfies all conditions: it is internally unstable, its frequency response is bounded, and its state diverges for the given impulse input, perfectly demonstrating how pole-zero cancellation masks internal instability. **Correct**.\n\n**Option B**\n\n- **(i) Explanation:** \"If $H(z)$ simplifies by exact pole-zero cancellation to a transfer function without poles outside the unit circle, then every realization that implements it must be internally stable; internal instability cannot occur when $H(e^{j\\omega})$ is bounded.\" This statement is fundamentally incorrect. It claims that input-output stability implies internal stability, which is false. The existence of a single counterexample is sufficient to disprove this general statement.\n- **(ii) Realization:** The option claims that \"no counterexample exists.\" Option A provides precisely such a counterexample.\n- **Verdict for B:** The explanation is false. **Incorrect**.\n\n**Option C**\n\n- **(i) Explanation:** \"Exact pole-zero cancellation can hide unstable internal dynamics, but only if the unstable mode is directly driven by the input.\" The phrasing \"directly driven by the input\" corresponds to the concept of controllability. For the state to diverge from $x[0]=0$, the unstable mode must indeed be controllable (excited by the input). However, the example provided contradicts this.\n- **(ii) Realization:**\n    $A=\\begin{bmatrix} p  0 \\\\ 0  0 \\end{bmatrix},\\ B=\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix},\\ C=\\begin{bmatrix} 1  0 \\end{bmatrix},\\ D=0,$ with $|p|1$.\n    - **Internal Stability:** The eigenvalues of the diagonal matrix $A$ are $\\lambda_1 = p$ and $\\lambda_2 = 0$. Since $|p|1$, the system is internally unstable.\n    - **Transfer Function:**\n    $$ H(z) = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} (z-p)^{-1}  0 \\\\ 0  z^{-1} \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ z^{-1} \\end{bmatrix} = 0 $$\n    The frequency response is $H(e^{j\\omega}) = 0$, which is bounded.\n    - **State Divergence:** For $u[k]=\\delta[k]$ and $x[0]=0$, the state evolves as $x_1[k+1] = px_1[k]$ and $x_2[k+1] = u[k]$.\n    $x[0] = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$.\n    $x_1[0]=0$, so $x_1[k]=0$ for all $k \\ge 0$. The unstable mode is not excited.\n    $x_2$ evolves as: $x_2[1] = u[0]=1$, $x_2[k]=0$ for $k \\ge 2$.\n    The state sequence is $x[0]=\\begin{bmatrix}0\\\\0\\end{bmatrix}, x[1]=\\begin{bmatrix}0\\\\1\\end{bmatrix}, x[k]=\\begin{bmatrix}0\\\\0\\end{bmatrix}$ for $k \\ge 2$.\n    The state does not diverge; it is bounded. The unstable mode associated with $p$ is uncontrollable.\n- **Verdict for C:** The realization fails to meet the criterion of a diverging state. **Incorrect**.\n\n**Option D**\n\n- **(i) Explanation:** \"Exact pole-zero cancellation does not affect internal stability...\" This part is trivially true, as internal stability depends only on matrix $A$. However, the explanation then fails to correctly link pole-zero cancellation to the phenomenon of a stable transfer function from an unstable system. It treats them as separate issues, which is misleading. Pole-zero cancellation is the very mechanism that \"masks\" the instability in the transfer function.\n- **(ii) Realization:**\n    $A=\\begin{bmatrix} p  0 \\\\ 1  0 \\end{bmatrix},\\ B=\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix},\\ C=\\begin{bmatrix} 1  0 \\end{bmatrix},\\ D=0,$ with $|p|1$.\n    - **Internal Stability:** Same $A$ as in Option A. Eigenvalues are $p$ and $0$. The system is internally unstable.\n    - **Transfer Function:**\n    $$ H(z) = C(zI-A)^{-1}B = \\begin{bmatrix} 1  0 \\end{bmatrix} \\frac{1}{z(z-p)} \\begin{bmatrix} z  0 \\\\ 1  z-p \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} $$\n    $$ H(z) = \\frac{1}{z(z-p)} \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} z \\\\ 1 \\end{bmatrix} = \\frac{z}{z(z-p)} = \\frac{1}{z-p} $$\n    There is no cancellation of the unstable pole at $z=p$. The pole associated with the unstable eigenvalue $p$ is present in the transfer function. The system is BIBO unstable.\n    - **Frequency Response:** $H(e^{j\\omega})=\\frac{1}{e^{j\\omega}-p}$. Since $|e^{j\\omega}|=1$ and $|p|1$, the denominator is never zero. The magnitude is $|H(e^{j\\omega})|=\\frac{1}{|e^{j\\omega}-p|} \\le \\frac{1}{|p|-1}$, so it is bounded.\n    - **State Divergence:** The matrices $A$ and $B$ are identical to those in Option A. As shown previously, the state $x[k]$ diverges.\n    - **Analysis:** Although this realization is internally unstable, has a bounded frequency response, and a diverging state, it does **not** demonstrate the principle of *masking* instability via pole-zero cancellation. The unstable mode at $z=p$ is fully visible as a pole in $H(z)$. Therefore, the example is irrelevant to the central claim about pole-zero cancellation hiding instability.\n- **Verdict for D:** The explanation is poor, and the provided realization does not exhibit the phenomenon of pole-zero cancellation masking an unstable mode, which is the core concept under discussion. **Incorrect**.\n\nBased on the analysis, only Option A provides both a correct theoretical explanation and a valid, illustrative example.", "answer": "$$\\boxed{A}$$", "id": "2891641"}]}