{"hands_on_practices": [{"introduction": "The bilinear transform is a cornerstone of IIR filter design, but it is often presented as a simple algebraic substitution. This exercise demystifies the method by showing how it arises directly from first principles: applying the trapezoidal rule for numerical integration to a continuous-time state-space model [@problem_id:2877756]. By working through this derivation, you will gain a deeper intuition for the transform's properties and then apply it to a practical design scenario involving frequency prewarping, a critical technique for accurately placing a filter's cutoff frequency.", "problem": "Consider a single-input, single-output, continuous-time, linear time-invariant system given in state-space form by $\\,\\dot{x}(t)=A\\,x(t)+B\\,u(t)\\,$ and $\\,y(t)=C\\,x(t)+D\\,u(t)\\,$, where $\\,x(t)\\in\\mathbb{R}^{n}\\,$, $\\,u(t)\\in\\mathbb{R}\\,$, and $\\,y(t)\\in\\mathbb{R}\\,$. Let the sampling period be $\\,T0\\,$, and denote $\\,x[k]\\triangleq x(kT)\\,$, $\\,u[k]\\triangleq u(kT)\\,$, and $\\,y[k]\\triangleq y(kT)\\,$. \n\nTask 1. Starting only from the fundamental relations of calculus for linear systems, namely that $\\,x(t_k)=x(t_{k-1})+\\int_{t_{k-1}}^{t_k}\\dot{x}(\\tau)\\,d\\tau\\,$ with $\\,\\dot{x}(\\tau)=A\\,x(\\tau)+B\\,u(\\tau)\\,$, derive a discrete-time state-update of the form $\\,\\text{(matrix)}\\cdot x[k]=\\text{(matrix)}\\cdot x[k-1]+\\text{(matrix)}\\cdot u[k]+\\text{(matrix)}\\cdot u[k-1]\\,$ by approximating the integral with the trapezoidal rule over $[t_{k-1},t_k]$. Then give the corresponding sampled-output equation $\\,y[k]\\,$ consistent with this discretization. Do not assume any specific structure for $A$, $B$, $C$, or $D$, and do not use any pre-derived discretization formulas.\n\nTask 2. Connect this discretization to the bilinear transform (Tustin method) by deducing, from your state-update derivation, the mapping between the Laplace variable $\\,s\\,$ and the $\\,z$-transform variable $\\,z\\,$ that is implicit in the trapezoidal rule applied to a first-order integrator. State this mapping explicitly as an algebraic relation between $\\,s\\,$ and $\\,z\\,$.\n\nTask 3. Use frequency prewarping to design a discrete-time infinite impulse response low-pass filter from the first-order analog prototype $\\,H_{a}(s)=\\dfrac{\\Omega_{c}}{s+\\Omega_{c}}\\,$ so that the digital $-3\\,\\text{dB}$ cutoff occurs at the desired discrete-time angular frequency $\\,\\omega_{p}\\,$. Let the sampling frequency be $\\,F_{s}=48{,}000\\,\\text{Hz}\\,$ and the desired passband edge be $\\,f_{p}=3{,}000\\,\\text{Hz}\\,$. Employ prewarping by setting $\\,\\Omega_{c}=\\dfrac{2}{T}\\tan\\!\\big(\\omega_{p}/2\\big)\\,$ with $\\,\\omega_{p}=2\\pi f_{p}/F_{s}\\,$ and $\\,T=1/F_{s}\\,$, and then apply your bilinear mapping to locate the unique discrete-time pole $\\,z_{p}\\,$ of the resulting digital filter. \n\nProvide your final answer as the numerical value of $\\,z_{p}\\,$ rounded to six significant figures. Express the final answer as a pure number without units.", "solution": "The problem presented is a standard, well-posed exercise in the field of digital signal processing and systems theory. It is scientifically sound, internally consistent, and contains all necessary information for a complete derivation and solution. We shall proceed by addressing each of the three tasks in sequence.\n\nThe first task requires the derivation of a discrete-time state-space representation from a continuous-time model using the trapezoidal rule for numerical integration. We begin with the fundamental theorem of calculus applied to the state vector $\\,x(t)\\,$ over the interval $\\,[t_{k-1}, t_k]\\,$, where $\\,t_k \\triangleq kT\\,$ for a sampling period $\\,T\\,$.\n$$x(t_k) = x(t_{k-1}) + \\int_{t_{k-1}}^{t_k} \\dot{x}(\\tau) \\,d\\tau$$\nUsing the discrete-time notation $\\,x[k] \\triangleq x(kT)\\,$, this becomes:\n$$x[k] = x[k-1] + \\int_{(k-1)T}^{kT} \\dot{x}(\\tau) \\,d\\tau$$\nThe trapezoidal rule for approximating a definite integral states that $\\,\\int_a^b f(\\tau) \\,d\\tau \\approx \\frac{b-a}{2} \\left[f(a) + f(b)\\right]\\,$. Applying this to our state integral, with $\\,a=(k-1)T\\,$ and $\\,b=kT\\,$, we get:\n$$\\int_{(k-1)T}^{kT} \\dot{x}(\\tau) \\,d\\tau \\approx \\frac{T}{2} \\left[ \\dot{x}((k-1)T) + \\dot{x}(kT) \\right]$$\nWe are given the state dynamics $\\,\\dot{x}(t) = A\\,x(t) + B\\,u(t)\\,$. Substituting this into the approximation at times $\\,(k-1)T\\,$ and $\\,kT\\,$:\n$$\\dot{x}((k-1)T) = A\\,x((k-1)T) + B\\,u((k-1)T) = A\\,x[k-1] + B\\,u[k-1]$$\n$$\\dot{x}(kT) = A\\,x(kT) + B\\,u(kT) = A\\,x[k] + B\\,u[k]$$\nSubstituting these expressions back into the discrete state update equation yields:\n$$x[k] = x[k-1] + \\frac{T}{2} \\left( (A\\,x[k-1] + B\\,u[k-1]) + (A\\,x[k] + B\\,u[k]) \\right)$$\nTo obtain the required form $\\,\\text{(matrix)}\\cdot x[k]=\\text{(matrix)}\\cdot x[k-1]+\\text{(matrix)}\\cdot u[k]+\\text{(matrix)}\\cdot u[k-1]\\,$, we must gather terms involving $\\,x[k]\\,$ on the left side and all other terms on the right side.\n$$x[k] - \\frac{T}{2}A\\,x[k] = x[k-1] + \\frac{T}{2}A\\,x[k-1] + \\frac{T}{2}B\\,u[k-1] + \\frac{T}{2}B\\,u[k]$$\nFactoring out the state and input vectors, where $\\,I\\,$ is the $\\,n \\times n\\,$ identity matrix:\n$$\\left(I - \\frac{T}{2}A\\right)x[k] = \\left(I + \\frac{T}{2}A\\right)x[k-1] + \\left(\\frac{T}{2}B\\right)u[k-1] + \\left(\\frac{T}{2}B\\right)u[k]$$\nThis is the discrete-time state-update equation in the specified implicit form. The corresponding sampled-output equation is obtained by direct sampling of the continuous-time output equation $\\,y(t)=C\\,x(t)+D\\,u(t)\\,$ at time $\\,t=kT\\,$. This yields:\n$$y[k] = C\\,x[k] + D\\,u[k]$$\nThis is the simplest and most direct approach, consistent with the fact that the output equation is an algebraic constraint, not a differential one to which an integration rule would apply.\n\nThe second task is to deduce the relationship between the Laplace variable $\\,s\\,$ and the $\\,z\\,$-transform variable $\\,z\\,$ that is implicit in this discretization method. We analyze a first-order integrator, whose input-output relationship is $\\,\\dot{x}(t) = u(t)\\,$. In state-space form, this corresponds to a scalar system with $\\,A=0\\,$ and $\\,B=1\\,$. Let's assume for this analysis that the state $\\,x(t)\\,$ is the output, so $\\,y(t)=x(t)\\,$. The transfer function of this continuous-time integrator is $\\,H_a(s) = \\frac{X(s)}{U(s)} = \\frac{1}{s}\\,$.\nWe apply our derived discrete-time state-update equation with $\\,A=0\\,$ and $\\,B=1\\,$:\n$$\\left(1 - \\frac{T}{2}\\cdot 0\\right)x[k] = \\left(1 + \\frac{T}{2}\\cdot 0\\right)x[k-1] + \\left(\\frac{T}{2}\\cdot 1\\right)u[k-1] + \\left(\\frac{T}{2}\\cdot 1\\right)u[k]$$\n$$x[k] = x[k-1] + \\frac{T}{2}(u[k-1] + u[k])$$\nTaking the $\\,z\\,$-transform of this equation, we get:\n$$X(z) = z^{-1}X(z) + \\frac{T}{2}(z^{-1}U(z) + U(z))$$\n$$X(z)(1 - z^{-1}) = \\frac{T}{2}U(z)(1 + z^{-1})$$\nThe discrete-time transfer function $\\,H_d(z) = \\frac{X(z)}{U(z)}\\,$ is therefore:\n$$H_d(z) = \\frac{T}{2} \\frac{1+z^{-1}}{1-z^{-1}} = \\frac{T}{2} \\frac{z+1}{z-1}$$\nThe discretization process has transformed the analog transfer function $\\,H_a(s)=\\frac{1}{s}\\,$ into the digital transfer function $\\,H_d(z)\\,$. The mapping is found by setting $\\,H_d(z) = H_a(s)\\,$ and solving for $\\,s\\,$.\n$$\\frac{T}{2} \\frac{z+1}{z-1} = \\frac{1}{s}$$\nSolving for $\\,s\\,$ gives the mapping implicit in the trapezoidal rule, which is the bilinear transform (also known as Tustin's method):\n$$s = \\frac{2}{T}\\frac{z-1}{z+1}$$\n\nThe third task is a practical filter design problem. We must design a first-order low-pass digital filter from the analog prototype $\\,H_{a}(s)=\\dfrac{\\Omega_{c}}{s+\\Omega_{c}}\\,$ using the bilinear transform with frequency prewarping. The specifications are a sampling frequency $\\,F_{s}=48{,}000\\,\\text{Hz}\\,$ and a desired passband edge frequency $\\,f_{p}=3{,}000\\,\\text{Hz}\\,$, which corresponds to the $\\,-3\\,\\text{dB}\\,$ cutoff. The pole of the analog filter is at $\\,s_p = -\\Omega_c\\,$. The pole of the resulting digital filter, $\\,z_p\\,$, is found by applying the bilinear transform mapping to the analog pole:\n$$s_p = \\frac{2}{T}\\frac{z_p-1}{z_p+1} \\implies -\\Omega_c = \\frac{2}{T}\\frac{z_p-1}{z_p+1}$$\nFrequency prewarping ensures that the analog cutoff frequency $\\,\\Omega_c\\,$ is chosen such that the digital cutoff frequency lands exactly at the desired value $\\,\\omega_p\\,$ after transformation. The prewarping formula provided is $\\,\\Omega_{c}=\\dfrac{2}{T}\\tan(\\frac{\\omega_{p}}{2})\\,$. We substitute this into our pole mapping equation:\n$$-\\frac{2}{T}\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = \\frac{2}{T}\\frac{z_p-1}{z_p+1}$$\nThe term $\\,\\frac{2}{T}\\,$ cancels from both sides, yielding a direct relationship between the pole $\\,z_p\\,$ and the desired digital cutoff frequency $\\,\\omega_p\\,$:\n$$-\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = \\frac{z_p-1}{z_p+1}$$\nWe solve for $\\,z_p\\,$:\n$$-(z_p+1)\\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p-1$$\n$$-z_p\\tan\\left(\\frac{\\omega_{p}}{2}\\right) - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p-1$$\n$$1 - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p + z_p\\tan\\left(\\frac{\\omega_{p}}{2}\\right)$$\n$$1 - \\tan\\left(\\frac{\\omega_{p}}{2}\\right) = z_p\\left(1 + \\tan\\left(\\frac{\\omega_{p}}{2}\\right)\\right)$$\n$$z_p = \\frac{1 - \\tan(\\omega_{p}/2)}{1 + \\tan(\\omega_{p}/2)}$$\nNow, we compute the numerical values. The sampling period is $\\,T = 1/F_s = 1/48000\\,\\text{s}\\,$. The desired discrete-time angular frequency is:\n$$\\omega_{p} = \\frac{2\\pi f_{p}}{F_{s}} = \\frac{2\\pi (3000)}{48000} = \\frac{6000\\pi}{48000} = \\frac{\\pi}{8}\\,\\text{rad/sample}$$\nWe require the value of $\\,\\tan(\\omega_p/2) = \\tan(\\pi/16)\\,$.\n$$\\tan\\left(\\frac{\\pi}{16}\\right) \\approx 0.198912367$$\nSubstituting this value into the expression for $\\,z_p\\,$:\n$$z_p = \\frac{1 - 0.198912367...}{1 + 0.198912367...} = \\frac{0.801087632...}{1.198912367...} \\approx 0.668178637...$$\nRounding to six significant figures, the numerical value of the discrete-time pole is $\\,0.668179\\,$.", "answer": "$$\\boxed{0.668179}$$", "id": "2877756"}, {"introduction": "With a solid understanding of the bilinear transform, it is essential to contrast it with the other primary design technique: impulse invariance. This practice [@problem_id:2877784] guides you through a direct comparison of how these two methods map an analog prototype's cutoff frequency to the digital domain. You will discover the fundamental difference between the non-linear frequency warping of the bilinear transform and the simple linear scaling associated with impulse invariance, illuminating a core trade-off between frequency accuracy and aliasing distortion.", "problem": "You are designing a discrete-time Infinite Impulse Response (IIR) lowpass filter using two classical analog-to-digital mapping methods applied to the same continuous-time analog prototype. The analog prototype is a second-order Butterworth lowpass filter with transfer function\n$$\nH_{a}(s) \\;=\\; \\frac{\\Omega_{c}^{2}}{s^{2} \\;+\\; \\sqrt{2}\\,\\Omega_{c}\\,s \\;+\\; \\Omega_{c}^{2}} \\, ,\n$$\nwhere the cutoff angular frequency is defined by\n$$\n\\Omega_{c} \\;=\\; 2\\pi f_{c} \\, ,\n$$\nand $f_{c}$ is the analog cutoff frequency at the minus $3\\,\\text{dB}$ point. Let the sampling frequency be $f_{s}$ and the sampling period be $T$, with\n$$\nf_{c} \\;=\\; 500\\,\\text{Hz} \\, , \\qquad f_{s} \\;=\\; 8000\\,\\text{Hz} \\, , \\qquad T \\;=\\; \\frac{1}{f_{s}} \\, .\n$$\nYou will implement two digital designs from the same analog prototype:\n- Design A: Impulse invariance, defined by sampling the continuous-time impulse response $h_{a}(t)$ as $h_{d}[n] \\,=\\, T\\,h_{a}(nT)$.\n- Design B: The bilinear transform (without prewarping), defined via the trapezoidal-rule based mapping from the $s$-plane to the $z$-plane.\n\nStarting only from the core definitions of the Continuous-Time Fourier Transform (CTFT), the Discrete-Time Fourier Transform (DTFT), and the mapping constructions that define impulse invariance and the bilinear transform, do the following:\n1) Prove that the minus $3\\,\\text{dB}$ point for the analog prototype occurs at $\\Omega \\,=\\, \\Omega_{c}$.\n2) Derive, from first principles, the frequency mapping relation that connects the digital radian frequency $\\omega$ (in radians/sample) to the analog radian frequency $\\Omega$ (in radians/second) for each design. Then identify the digital minus $3\\,\\text{dB}$ frequencies $\\omega_{\\mathrm{ii}}$ and $\\omega_{\\mathrm{bl}}$ for the two designs.\n3) Using the given $f_{c}$ and $f_{s}$, compute the ratio\n$$\nR \\;=\\; \\frac{\\omega_{\\mathrm{ii}}}{\\omega_{\\mathrm{bl}}} \\, .\n$$\nAssume that aliasing of the analog spectrum replicas introduced by impulse invariance is negligible at baseband for the given $f_{c}/f_{s}$. Round your final numerical answer for $R$ to four significant figures. Report a unitless number (no units). Angle quantities, where needed, are in radians or radians/sample as appropriate.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of digital signal processing, specifically IIR filter design. It is well-posed, providing all necessary data and definitions for a unique solution. The language is objective and unambiguous. We proceed with the solution.\n\nThe problem requires a three-part analysis of a second-order Butterworth lowpass filter and its digital implementations.\n\nPart 1: Validation of the analog prototype's minus $3\\,\\text{dB}$ frequency.\n\nThe transfer function of the analog prototype filter is given as:\n$$\nH_{a}(s) = \\frac{\\Omega_{c}^{2}}{s^{2} + \\sqrt{2}\\Omega_{c}s + \\Omega_{c}^{2}}\n$$\nTo find the frequency response, we evaluate $H_{a}(s)$ on the imaginary axis by setting $s = j\\Omega$, where $\\Omega$ is the analog radian frequency.\n$$\nH_{a}(j\\Omega) = \\frac{\\Omega_{c}^{2}}{(j\\Omega)^{2} + \\sqrt{2}\\Omega_{c}(j\\Omega) + \\Omega_{c}^{2}} = \\frac{\\Omega_{c}^{2}}{-\\Omega^{2} + j\\sqrt{2}\\Omega_{c}\\Omega + \\Omega_{c}^{2}} = \\frac{\\Omega_{c}^{2}}{(\\Omega_{c}^{2} - \\Omega^{2}) + j(\\sqrt{2}\\Omega_{c}\\Omega)}\n$$\nThe squared magnitude of the frequency response is $|H_{a}(j\\Omega)|^{2}$.\n$$\n|H_{a}(j\\Omega)|^{2} = \\frac{|\\Omega_{c}^{2}|^{2}}{|(\\Omega_{c}^{2} - \\Omega^{2}) + j(\\sqrt{2}\\Omega_{c}\\Omega)|^{2}} = \\frac{\\Omega_{c}^{4}}{(\\Omega_{c}^{2} - \\Omega^{2})^{2} + (\\sqrt{2}\\Omega_{c}\\Omega)^{2}}\n$$\nExpanding the denominator:\n$$\n(\\Omega_{c}^{4} - 2\\Omega_{c}^{2}\\Omega^{2} + \\Omega^{4}) + 2\\Omega_{c}^{2}\\Omega^{2} = \\Omega_{c}^{4} + \\Omega^{4}\n$$\nThus, the squared magnitude response is:\n$$\n|H_{a}(j\\Omega)|^{2} = \\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + \\Omega^{4}}\n$$\nThe minus $3\\,\\text{dB}$ point is the frequency at which the magnitude $|H_{a}(j\\Omega)|$ is reduced to $1/\\sqrt{2}$ of its maximum value. The maximum value occurs at DC ($\\Omega = 0$), where $|H_{a}(j0)|^{2} = \\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + 0} = 1$, so $|H_{a}(j0)| = 1$. The minus $3\\,\\text{dB}$ condition is therefore $|H_{a}(j\\Omega)| = 1/\\sqrt{2}$, or equivalently, $|H_{a}(j\\Omega)|^{2} = 1/2$.\nSetting the squared magnitude response to $1/2$:\n$$\n\\frac{\\Omega_{c}^{4}}{\\Omega_{c}^{4} + \\Omega^{4}} = \\frac{1}{2}\n$$\n$$\n2\\Omega_{c}^{4} = \\Omega_{c}^{4} + \\Omega^{4}\n$$\n$$\n\\Omega^{4} = \\Omega_{c}^{4}\n$$\nSince frequency $\\Omega$ must be non-negative, we take the real, positive root:\n$$\n\\Omega = \\Omega_{c}\n$$\nThis proves that the minus $3\\,\\text{dB}$ cutoff frequency of the analog prototype is indeed $\\Omega_{c}$.\n\nPart 2: Derivation of frequency mappings and digital cutoff frequencies.\n\nCase A: Impulse Invariance\nThe impulse invariance method defines the discrete-time impulse response $h_{d}[n]$ by sampling the continuous-time impulse response $h_{a}(t)$ such that $h_{d}[n] = T h_{a}(nT)$, where $T$ is the sampling period. The frequency response of the digital filter, $H_{d}(e^{j\\omega})$, is the Discrete-Time Fourier Transform (DTFT) of $h_{d}[n]$. The relationship between the DTFT of the sampled sequence and the Continuous-Time Fourier Transform (CTFT) of the original signal is given by the aliasing formula:\n$$\nH_{d}(e^{j\\omega}) = \\sum_{k=-\\infty}^{\\infty} H_{a}\\left(j\\left(\\frac{\\omega}{T} - \\frac{2\\pi k}{T}\\right)\\right)\n$$\nThe problem states to assume that aliasing is negligible. This implies that for the frequency range of interest (the baseband, where $k=0$), the contributions from the spectral replicas (terms with $k \\neq 0$) are insignificant. Under this assumption, the relationship simplifies to:\n$$\nH_{d}(e^{j\\omega}) \\approx H_{a}\\left(j\\frac{\\omega}{T}\\right)\n$$\nThis gives a direct, linear mapping between the analog frequency $\\Omega$ and the digital frequency $\\omega$:\n$$\n\\Omega = \\frac{\\omega}{T}\n$$\nThe digital minus $3\\,\\text{dB}$ frequency, $\\omega_{\\mathrm{ii}}$, is the frequency at which $|H_{d}(e^{j\\omega_{\\mathrm{ii}}})|$ is at its minus $3\\,\\text{dB}$ point. Due to the direct correspondence $H_{d}(e^{j\\omega}) \\approx H_{a}(j\\Omega)$, this occurs when the mapped analog frequency $\\Omega$ is equal to the analog cutoff frequency $\\Omega_{c}$.\n$$\n\\Omega_{c} = \\frac{\\omega_{\\mathrm{ii}}}{T} \\implies \\omega_{\\mathrm{ii}} = \\Omega_{c} T\n$$\n\nCase B: Bilinear Transform\nThe bilinear transform is defined by the substitution:\n$$\ns = \\frac{2}{T} \\frac{1 - z^{-1}}{1 + z^{-1}}\n$$\nTo find the relationship between analog and digital frequencies, we set $s = j\\Omega$ and $z = e^{j\\omega}$.\n$$\nj\\Omega = \\frac{2}{T} \\frac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}}\n$$\nWe simplify the rational expression in $e^{-j\\omega}$:\n$$\n\\frac{1 - e^{-j\\omega}}{1 + e^{-j\\omega}} = \\frac{e^{j\\omega/2}(e^{j\\omega/2} - e^{-j\\omega/2})}{e^{j\\omega/2}(e^{j\\omega/2} + e^{-j\\omega/2})} = \\frac{2j\\sin(\\omega/2)}{2\\cos(\\omega/2)} = j\\tan\\left(\\frac{\\omega}{2}\\right)\n$$\nSubstituting this back gives:\n$$\nj\\Omega = \\frac{2}{T} j\\tan\\left(\\frac{\\omega}{2}\\right) \\implies \\Omega = \\frac{2}{T} \\tan\\left(\\frac{\\omega}{2}\\right)\n$$\nThis non-linear relationship is known as frequency warping. The digital filter's frequency response is $H_{d}(e^{j\\omega}) = H_{a}(j\\frac{2}{T} \\tan(\\frac{\\omega}{2}))$. The digital minus $3\\,\\text{dB}$ frequency, $\\omega_{\\mathrm{bl}}$, occurs when the effective analog frequency equals $\\Omega_{c}$.\n$$\n\\Omega_{c} = \\frac{2}{T} \\tan\\left(\\frac{\\omega_{\\mathrm{bl}}}{2}\\right)\n$$\nSolving for $\\omega_{\\mathrm{bl}}$:\n$$\n\\tan\\left(\\frac{\\omega_{\\mathrm{bl}}}{2}\\right) = \\frac{\\Omega_{c} T}{2} \\implies \\omega_{\\mathrm{bl}} = 2\\arctan\\left(\\frac{\\Omega_{c} T}{2}\\right)\n$$\n\nPart 3: Calculation of the ratio $R$.\n\nWe are asked to compute the ratio $R = \\omega_{\\mathrm{ii}} / \\omega_{\\mathrm{bl}}$. Using the expressions derived in Part 2:\n$$\nR = \\frac{\\omega_{\\mathrm{ii}}}{\\omega_{\\mathrm{bl}}} = \\frac{\\Omega_{c} T}{2\\arctan\\left(\\frac{\\Omega_{c} T}{2}\\right)}\n$$\nFirst, we compute the value of the term $\\Omega_{c} T$.\nThe given analog cutoff frequency is $f_{c} = 500\\,\\text{Hz}$. So, $\\Omega_{c} = 2\\pi f_{c} = 2\\pi(500) = 1000\\pi\\,\\text{rad/s}$.\nThe sampling frequency is $f_{s} = 8000\\,\\text{Hz}$, so the sampling period is $T = 1/f_{s} = 1/8000\\,\\text{s}$.\nThe product $\\Omega_{c} T$ is:\n$$\n\\Omega_{c} T = (1000\\pi) \\left(\\frac{1}{8000}\\right) = \\frac{1000\\pi}{8000} = \\frac{\\pi}{8}\n$$\nThis value gives the digital cutoff frequency for the impulse invariance design: $\\omega_{\\mathrm{ii}} = \\pi/8\\,\\text{rad/sample}$.\nNow substitute this value into the expression for $R$:\n$$\nR = \\frac{\\pi/8}{2\\arctan\\left(\\frac{\\pi/8}{2}\\right)} = \\frac{\\pi/8}{2\\arctan\\left(\\frac{\\pi}{16}\\right)}\n$$\nWe compute the numerical value.\nThe argument of the arctangent is $\\pi/16 \\approx 3.14159265 / 16 \\approx 0.19634954$.\nThe arctangent is $\\arctan(\\pi/16) \\approx 0.19383638\\,\\text{rad}$.\n$$\nR \\approx \\frac{0.39269908}{2 \\times 0.19383638} = \\frac{0.39269908}{0.38767276} \\approx 1.0129653\n$$\nRounding to four significant figures, we get $R = 1.013$.", "answer": "$$\\boxed{1.013}$$", "id": "2877784"}, {"introduction": "A key difference observed between the bilinear transform and impulse invariance is their behavior at high frequencies, particularly the perfect null at the Nyquist frequency ($z=-1$) created by the former. This advanced practice [@problem_id:2877761] explores the structural reason for this difference by investigating how each method handles the zeros of the analog prototype, including its implicit zeros at $s=\\infty$. By analyzing the resulting zero-pole structure of the digital filter, you will develop a sophisticated understanding of the deep connection between the mapping's properties and the filter's frequency response characteristics.", "problem": "Consider a strictly proper, stable, causal, continuous-time, all-pole analog prototype of order $N$ with transfer function $H_{a}(s)$, whose poles $\\{p_{k}\\}_{k=1}^{N}$ lie in the open left-half complex plane. Two standard discrete-time Infinite Impulse Response (IIR) designs are formed from $H_{a}(s)$ using, respectively, the bilinear transform and impulse invariance. Without invoking any specialized shortcut identities beyond fundamental transform definitions and stability considerations, reason about the zeros of the resulting discrete-time transfer functions and their consequences for the gain at the discrete-time frequency $\\Omega=\\pi$.\n\nWhich of the following statements are correct?\n\nA. For the bilinear-transform-based design of an all-pole $H_{a}(s)$ of order $N$, the discrete-time transfer function has exactly $N$ zeros at $z=-1$, independent of the sampling period $T$, which enforces $|H(e^{j\\pi})|=0$.\n\nB. For the impulse-invariance-based design of an all-pole $H_{a}(s)$, the discrete-time transfer function generically has exactly one zero at $z=0$ and no zeros at $z=-1$; consequently $|H(e^{j\\pi})|$ is generally nonzero and depends on the analog residues and the sampling period $T$.\n\nC. For the impulse-invariance-based design of an all-pole $H_{a}(s)$ of order $N$, there are generically $N$ zeros at $z=0$ because each mapped pole contributes a factor $z$ to the numerator.\n\nD. For the bilinear-transform-based design, the analog zeros at $s=\\infty$ map to $z=+1$, so $|H(e^{j\\pi})|$ is generally nonzero.\n\nE. If the analog prototype is minimum phase and stable, then impulse invariance always yields $|H(e^{j\\pi})|=0$ because all mapped poles lie strictly inside the unit circle.", "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Analog prototype filter transfer function: $H_{a}(s)$.\n- Properties of the analog prototype: strictly proper, stable, causal, continuous-time, all-pole of order $N$.\n- Poles of the analog prototype: $\\{p_{k}\\}_{k=1}^{N}$ are in the open left-half complex plane.\n- Design methods for discrete-time IIR filters: bilinear transform and impulse invariance.\n- Task: Analyze the zeros of the resulting discrete-time transfer functions, $H(z)$, and the consequence for the gain at the discrete-time frequency $\\Omega=\\pi$.\n- Constraint: The reasoning must be based on fundamental transform definitions and stability considerations, avoiding specialized shortcut identities.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It is based on fundamental and standard principles of digital signal processing, specifically the design of IIR filters from analog prototypes. The givens are self-contained and consistent. An all-pole, strictly proper, stable, causal filter of order $N$ is a well-defined entity, its transfer function having the form $H_a(s) = K / D(s)$, where $D(s)$ is a polynomial of degree $N$ with all roots in the open left-half plane, and $K$ is a constant. The two design methods mentioned are canonical procedures. The question is precise and allows for a definitive, verifiable answer derived from first principles. No flaws from the checklist are present.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be derived.\n\nThe analysis proceeds by examining each design method separately, starting from fundamental definitions. The analog prototype is an all-pole filter of order $N$, so its transfer function is of the form:\n$$H_a(s) = \\frac{K}{\\prod_{k=1}^{N} (s - p_k)}$$\nwhere $K$ is a real constant, and the poles $p_k$ satisfy $\\text{Re}(p_k)  0$ for all $k \\in \\{1,...,N\\}$, which ensures stability and causality. Being strictly proper implies that the degree of the numerator ($0$) is strictly less than the degree of the denominator ($N$). This means the filter has $N$ zeros at $s = \\infty$.\n\n**Analysis of the Bilinear Transform**\nThe bilinear transform is defined by the substitution:\n$$s = c \\frac{1 - z^{-1}}{1 + z^{-1}} = c \\frac{z - 1}{z + 1}$$\nwhere $c$ is a real, positive constant, typically $c = 2/T$ with $T$ being the sampling period. Applying this substitution to $H_a(s)$ yields the discrete-time transfer function $H(z)$:\n$$H(z) = H_a\\left(c \\frac{z - 1}{z + 1}\\right) = \\frac{K}{\\prod_{k=1}^{N} \\left(c \\frac{z - 1}{z + 1} - p_k\\right)}$$\nTo identify the zeros of $H(z)$, we must simplify this expression into a rational function of $z$. Consider a single term in the denominator product:\n$$c \\frac{z - 1}{z + 1} - p_k = \\frac{c(z - 1) - p_k(z + 1)}{z + 1} = \\frac{(c - p_k)z - (c + p_k)}{z + 1}$$\nSubstituting this back into the expression for $H(z)$:\n$$H(z) = \\frac{K}{\\prod_{k=1}^{N} \\frac{(c - p_k)z - (c + p_k)}{z + 1}} = \\frac{K \\prod_{k=1}^{N} (z + 1)}{\\prod_{k=1}^{N} ((c - p_k)z - (c + p_k))} = \\frac{K (z + 1)^N}{\\prod_{k=1}^{N} ((c - p_k)z - (c + p_k))}$$\nThe numerator of $H(z)$ is $K(z+1)^N$. This shows that $H(z)$ has exactly $N$ zeros, and all of them are located at $z = -1$. This result is structural and does not depend on the specific pole locations $\\{p_k\\}$ or the value of $c$ (and hence $T$), as long as the prototype is all-pole of order $N$.\n\nThe discrete-time frequency $\\Omega = \\pi$ corresponds to $z = e^{j\\pi} = -1$. Since $H(z)$ has $N \\geq 1$ zeros at $z=-1$, the value of the transfer function at this point is $H(-1) = 0$. Consequently, the magnitude of the frequency response at $\\Omega = \\pi$ is $|H(e^{j\\pi})| = |H(-1)| = 0$.\n\n**Analysis of Impulse Invariance**\nThe impulse invariance method dictates that the discrete-time impulse response, $h[n]$, is a sampled version of the continuous-time impulse response, $h_a(t)$. Let us define $h[n] = h_a(nT)$. (A scaling by $T$ is common but does not affect the location of zeros).\n\nFirst, we find $h_a(t)$ by taking the inverse Laplace transform of $H_a(s)$. Assuming for simplicity that the poles $\\{p_k\\}$ are distinct, we can perform a partial fraction expansion:\n$$H_a(s) = \\sum_{k=1}^{N} \\frac{R_k}{s - p_k}$$\nwhere $R_k$ are the residues. The corresponding impulse response is:\n$$h_a(t) = \\left( \\sum_{k=1}^{N} R_k e^{p_k t} \\right) u(t)$$\nwhere $u(t)$ is the Heaviside step function. Sampling at intervals of $T$ gives:\n$$h[n] = h_a(nT) = \\left( \\sum_{k=1}^{N} R_k e^{p_k nT} \\right) u[n]$$\nThe discrete-time transfer function $H(z)$ is the Z-transform of $h[n]$:\n$$H(z) = \\mathcal{Z}\\{h[n]\\} = \\sum_{k=1}^{N} R_k \\mathcal{Z}\\{ (e^{p_k T})^n u[n] \\} = \\sum_{k=1}^{N} R_k \\frac{1}{1 - e^{p_k T} z^{-1}} = \\sum_{k=1}^{N} \\frac{R_k z}{z - e^{p_k T}}$$\nTo find the zeros of $H(z)$, we combine the terms into a single rational function. Let us factor out the common term $z$:\n$$H(z) = z \\left( \\sum_{k=1}^{N} \\frac{R_k}{z - e^{p_k T}} \\right)$$\nThe summation term, when placed over a common denominator $\\prod_{j=1}^{N} (z - e^{p_j T})$, results in a numerator that is a polynomial in $z$ of degree $N-1$. Let this polynomial be $P_{N-1}(z)$. The full transfer function is:\n$$H(z) = \\frac{z \\cdot P_{N-1}(z)}{\\prod_{k=1}^{N} (z - e^{p_k T})}$$\nThe zeros of $H(z)$ are thus composed of one zero at $z=0$ and the $N-1$ roots of the polynomial $P_{N-1}(z)$. The coefficients of $P_{N-1}(z)$ depend on the residues $R_k$ and poles $p_k$ of the analog filter, as well as the sampling period $T$. In a generic case (i.e., for an arbitrary selection of poles $\\{p_k\\}$), these $N-1$ zeros are not located at $z=0$ or $z=-1$. Thus, there is generically a single zero at $z=0$.\n\nThe gain at $\\Omega=\\pi$ is given by $H(z)$ evaluated at $z=-1$:\n$$H(-1) = \\sum_{k=1}^{N} \\frac{R_k (-1)}{-1 - e^{p_k T}} = \\sum_{k=1}^{N} \\frac{R_k}{1 + e^{p_k T}}$$\nSince $\\text{Re}(p_k)  0$, we have $|e^{p_k T}| = e^{\\text{Re}(p_k) T}  1$. Thus, $e^{p_k T}$ is never equal to $-1$, and the denominators $1 + e^{p_k T}$ are always non-zero. The sum is a complex-weighted sum of terms that will only equal zero under very specific, non-generic conditions on the residues $R_k$ and poles $p_k$. Therefore, in general, $|H(e^{j\\pi})| = |H(-1)| \\neq 0$. This gain clearly depends on the analog residues $R_k$ and the sampling period $T$.\n\nNow we evaluate each option.\n\nA. For the bilinear-transform-based design of an all-pole $H_{a}(s)$ of order $N$, the discrete-time transfer function has exactly $N$ zeros at $z=-1$, independent of the sampling period $T$, which enforces $|H(e^{j\\pi})|=0$.\nThis statement is a direct consequence of our derivation for the bilinear transform. The numerator is exactly $K(z+1)^N$, establishing $N$ zeros at $z=-1$. This enforces $H(-1)=0$, so the gain at $\\Omega=\\pi$ is zero. **Correct**.\n\nB. For the impulse-invariance-based design of an all-pole $H_{a}(s)$, the discrete-time transfer function generically has exactly one zero at $z=0$ and no zeros at $z=-1$; consequently $|H(e^{j\\pi})|$ is generally nonzero and depends on the analog residues and the sampling period $T$.\nThis statement is fully supported by our analysis of the impulse invariance method. The transfer function has the form $z \\cdot P_{N-1}(z) / D_N(z)$, indicating one fixed zero at $z=0$ and $N-1$ other zeros whose locations are parameter-dependent and generically not at $z=0$ or $z=-1$. The gain at $z=-1$ is a sum that is generally non-zero and depends on residues and sampling period. **Correct**.\n\nC. For the impulse-invariance-based design of an all-pole $H_{a}(s)$ of order $N$, there are generically $N$ zeros at $z=0$ because each mapped pole contributes a factor $z$ to the numerator.\nThis reasoning is fallacious. While each term in the partial fraction sum $\\sum \\frac{R_k z}{z - e^{p_k T}}$ has a factor of $z$, when these terms are added together, only a single common factor of $z$ can be taken out from the resulting numerator polynomial. The analysis showed one zero at $z=0$ and $N-1$ other zeros, not $N$ zeros at $z=0$. **Incorrect**.\n\nD. For the bilinear-transform-based design, the analog zeros at $s=\\infty$ map to $z=+1$, so $|H(e^{j\\pi})|$ is generally nonzero.\nThe mapping is $s = c \\frac{z-1}{z+1}$. The point $s=\\infty$ corresponds to the value of $z$ that makes the denominator zero, which is $z+1=0$, or $z=-1$. The point $z=+1$ corresponds to $s=c\\frac{1-1}{1+1}=0$. The premise of the statement is factually wrong. Consequently, the conclusion is also wrong, as established in the analysis for option A. **Incorrect**.\n\nE. If the analog prototype is minimum phase and stable, then impulse invariance always yields $|H(e^{j\\pi})|=0$ because all mapped poles lie strictly inside the unit circle.\nAn all-pole filter has no finite zeros, so the minimum phase condition is trivially satisfied. Stability is given. As shown in the main analysis, the mapped poles $z_k = e^{p_k T}$ indeed lie inside the unit circle, which guarantees the stability of the digital filter. However, this is a non-sequitur for the conclusion that $|H(e^{j\\pi})|=0$. Our formula for $H(-1)$ shows it is generically non-zero. The reasoning is flawed and the conclusion is false. **Incorrect**.", "answer": "$$\\boxed{AB}$$", "id": "2877761"}]}