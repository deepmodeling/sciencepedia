{"hands_on_practices": [{"introduction": "为了建立对互感概念的扎实理解，我们从一个基础的计算开始。我们将运用互感的基本定义 $M = \\Phi_{21}/I_1$，并通过一个简化的物理近似来求解。这个练习 [@problem_id:1594773] 演示了如何运用物理近似（在此例中，假设在一个小面积上磁场是均匀的）来简化复杂问题，并清晰地揭示了互感对几何构型（例如线圈间的夹角）的依赖性。", "problem": "一个半径为 $R$ 的大圆形线圈和一个半径为 $r$ 的很小的圆形线圈（满足条件 $r \\ll R$）同心放置。小线圈的平面发生倾斜，与大线圈的平面形成一个角度 $\\theta$。你的目标是确定这对线圈之间的互感 $M$。推导一个用给定参数 $R$、$r$、$\\theta$ 以及真空磁导率 $\\mu_0$ 表示的 $M$ 的表达式。", "solution": "互感的定义为 $M=\\frac{\\Phi_{21}}{I_1}$，其中 $\\Phi_{21}$ 是由线圈1（大线圈）中的电流 $I_1$ 产生的穿过线圈2（小线圈）的磁通量。\n\n根据毕奥-萨伐尔定律的结果，一个半径为 $R$、载有电流 $I_1$ 的圆形线圈在其中心产生的磁场为：\n$$\nB=\\frac{\\mu_{0} I_1}{2R}.\n$$\n对于 $r \\ll R$ 的情况，小线圈对大线圈磁场的采样区域内，磁场可以近似认为是均匀的，且其大小等于两个线圈共同中心处的磁场大小。穿过小线圈的磁通量为：\n$$\n\\Phi_{21}=\\int \\mathbf{B}\\cdot d\\mathbf{a}=B\\,A_{2}\\cos\\theta,\n$$\n其中 $A_{2}=\\pi r^{2}$ 是小线圈的面积，$\\theta$ 是小线圈的法线方向与磁场 $\\mathbf{B}$ 方向（即大线圈的法线方向）之间的夹角。代入 $B$ 和 $A_{2}$，\n$$\n\\Phi_{21}=\\left(\\frac{\\mu_{0} I_1}{2R}\\right)\\left(\\pi r^{2}\\right)\\cos\\theta.\n$$\n因此，互感为：\n$$\nM=\\frac{\\Phi_{21}}{I_1}=\\frac{\\mu_{0}\\pi r^{2}}{2R}\\cos\\theta.\n$$\n这个结果在 $r \\ll R$ 的近似下是领头阶准确的。", "answer": "$$\\boxed{\\frac{\\mu_{0}\\pi r^{2}}{2R}\\cos\\theta}$$", "id": "1594773"}, {"introduction": "在掌握了均匀场近似之后，我们来处理一个磁场在回路中不均匀分布的情形，这就要求我们通过建立并求解一个积分来计算总磁通量。这个练习 [@problem_id:1594743] 中独特的“饼状”扇形几何结构，将考验你如何选择合适的坐标系并执行积分，这是解决更复杂电磁学问题的关键技能。", "problem": "一根无限长的直导线承载着稳恒电流 $I$。一个刚性的闭合导电回路，形状为扇形（“饼块”），与导线位于同一平面内。扇形的顶点位于直导线上。扇形的两条直的径向边中的一条，长度为 $R$，其方向与导线垂直。另一条径向边的长度也为 $R$，两条径向边之间的夹角为 $\\alpha$，其中 $0  \\alpha  \\pi/2$ 弧度。扇形的整个区域位于垂直径向边的一侧。求导线与回路之间的互感 $M$。请用 $R$、$\\alpha$ 和自由空间磁导率 $\\mu_0$ 表示你的答案。", "solution": "设无限长直导线沿 $x$ 轴承载电流 $I$，刚性导电回路位于 $x$-$y$ 平面内，其顶点位于导线上的原点。在该平面内选择极坐标 $(r,\\theta)$，角度 $\\theta$ 从 $+y$ 轴朝 $+x$ 轴方向测量，这样扇形的两条径向边就位于 $\\theta=0$ 和 $\\theta=\\alpha$ 处，且 $0  \\alpha  \\frac{\\pi}{2}$。扇形占据的区域为 $0\\leq r\\leq R$ 和 $0\\leq \\theta\\leq \\alpha$。\n\n根据安培定律（或毕奥-萨伐尔定律），无限长直导线在垂直距离 $\\rho$ 处产生的磁场大小为\n$$\nB(\\rho)=\\frac{\\mu_{0} I}{2\\pi \\rho}.\n$$\n对于导线沿 $x$ 轴的平面上的一个点 $(x,y,0)$，其到导线的垂直距离为 $\\rho=|y|$。在上述坐标系中，$y=r\\cos\\theta$，并且由于 $0\\leq\\theta\\leq\\alpha  \\frac{\\pi}{2}$，我们有 $\\cos\\theta>0$，所以 $\\rho=r\\cos\\theta$。在 $z=0$ 处的磁场垂直于回路（沿 $\\pm\\hat{z}$ 方向），因此穿过回路的磁场法向分量大小为\n$$\nB_{n}(r,\\theta)=\\frac{\\mu_{0} I}{2\\pi r\\cos\\theta}.\n$$\n\n穿过扇形的磁通量为\n$$\n\\Phi=\\int_{0}^{\\alpha}\\int_{0}^{R} B_{n}(r,\\theta)\\,r\\,dr\\,d\\theta\n=\\int_{0}^{\\alpha}\\int_{0}^{R}\\frac{\\mu_{0} I}{2\\pi r\\cos\\theta}\\,r\\,dr\\,d\\theta\n=\\frac{\\mu_{0} I}{2\\pi}\\int_{0}^{\\alpha}\\frac{1}{\\cos\\theta}\\left(\\int_{0}^{R}dr\\right)d\\theta.\n$$\n计算内部积分得到\n$$\n\\Phi=\\frac{\\mu_{0} I R}{2\\pi}\\int_{0}^{\\alpha}\\sec\\theta\\,d\\theta.\n$$\n使用 $\\int \\sec\\theta\\,d\\theta=\\ln|\\sec\\theta+\\tan\\theta|$，并注意到 $\\sec 0+\\tan 0=1$，我们得到\n$$\n\\Phi=\\frac{\\mu_{0} I R}{2\\pi}\\ln\\!\\bigl(\\sec\\alpha+\\tan\\alpha\\bigr).\n$$\n\n互感 $M$ 定义为 $M=\\Phi/I$，因此\n$$\nM=\\frac{\\mu_{0} R}{2\\pi}\\ln\\!\\bigl(\\sec\\alpha+\\tan\\alpha\\bigr).\n$$\n对于 $0  \\alpha  \\frac{\\pi}{2}$，此表达式是有限的，符合要求。", "answer": "$$\\boxed{\\frac{\\mu_{0} R}{2\\pi}\\ln\\!\\bigl(\\sec\\alpha+\\tan\\alpha\\bigr)}$$", "id": "1594743"}, {"introduction": "虽然磁通量法很直观，但诺伊曼公式提供了一种更普适、更强大的方法，尤其适用于复杂几何构型。这道最后的练习题 [@problem_id:2419641] 如同一座桥梁，将理论与真实的计算物理和工程应用连接起来。由于诺伊曼积分在实际应用中很少有解析解，本练习将指导你实现一个数值解法，从而展示该公式在处理任意电路构型时的巨大实用价值。", "problem": "给定自由空间中的两个闭合薄圆形线圈，在三维欧几里得空间中被建模为曲线 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$。每个线圈 $i \\in \\{1,2\\}$ 由其半径 $R_i$（单位：米）、中心位置矢量 $\\mathbf{c}_i$（单位：米）以及指示其平面方向的单位法向量 $\\mathbf{n}_i$ 来表征。在国际单位制（SI）中，磁常数 $\\mu_0$ 等于 $4\\pi \\times 10^{-7}$ 亨利/米。两个线圈之间的互感 $M$（单位：亨利）由第一性原理出发，通过诺伊曼公式定义：\n$$\nM \\;=\\; \\frac{\\mu_0}{4\\pi}\\;\\oint_{\\mathcal{C}_1}\\;\\oint_{\\mathcal{C}_2}\\;\\frac{\\mathrm{d}\\boldsymbol{\\ell}_1 \\cdot \\mathrm{d}\\boldsymbol{\\ell}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|}\\,,\n$$\n其中 $\\mathbf{r}_1 \\in \\mathcal{C}_1$，$\\mathbf{r}_2 \\in \\mathcal{C}_2$，而 $\\mathrm{d}\\boldsymbol{\\ell}_1$、$\\mathrm{d}\\boldsymbol{\\ell}_2$ 是沿着线圈的微分线元。将每个线圈建模为理想的圆形细丝。所使用的任何角参数都必须以弧度为单位进行解释。\n\n编写一个程序，对以下每个测试用例进行数值计算 $M$。所有输入数据中，几何量的单位均为米，并且必须按照给定的数值精确处理。您必须假设各处均为自由空间，且不存在磁性材料。最终答案必须以亨利为单位，表示为浮点数。\n\n测试套件（按给定顺序处理）：\n\n- 情况 $1$（一般非共轴、非共面，中等间距）：\n  - $R_1 = 0.10$, $\\mathbf{c}_1 = (0.00,\\,0.00,\\,0.00)$, $\\mathbf{n}_1 = (0,\\,0,\\,1)$。\n  - $R_2 = 0.08$, $\\mathbf{c}_2 = (0.05,\\,0.02,\\,0.03)$, $\\mathbf{n}_2 = \\frac{1}{\\sqrt{3}}(1,\\,1,\\,1)$。\n\n- 情况 $2$（大间距，弱耦合）：\n  - $R_1 = 0.20$, $\\mathbf{c}_1 = (0.20,\\,-0.10,\\,0.00)$, $\\mathbf{n}_1 = (0,\\,1,\\,0)$。\n  - $R_2 = 0.15$, $\\mathbf{c}_2 = (1.00,\\,-0.50,\\,0.80)$, $\\mathbf{n}_2 = (0,\\,0,\\,1)$。\n\n- 情况 $3$（近乎相交的方位，微小偏移以避免相交）：\n  - $R_1 = 0.10$, $\\mathbf{c}_1 = (0.00,\\,0.00,\\,0.00)$, $\\mathbf{n}_1 = (0,\\,0,\\,1)$。\n  - $R_2 = 0.10$, $\\mathbf{c}_2 = (0.005,\\,0.00,\\,0.00)$, $\\mathbf{n}_2 = (0,\\,1,\\,0)$。\n\n- 情况 $4$（任意斜向方位和偏移）：\n  - $R_1 = 0.12$, $\\mathbf{c}_1 = (-0.03,\\,0.04,\\,0.02)$, $\\mathbf{n}_1 = \\frac{1}{\\sqrt{(0.2)^2+(0.9)^2+(0.4)^2}}(0.2,\\,0.9,\\,0.4)$。\n  - $R_2 = 0.07$, $\\mathbf{c}_2 = (0.06,\\,-0.02,\\,0.05)$, $\\mathbf{n}_2 = \\frac{1}{\\sqrt{(-0.3)^2+(0.1)^2+(0.95)^2}}(-0.3,\\,0.1,\\,0.95)$。\n\n要求：\n\n- 将每个线圈视为一个完美的圆形，位于与 $\\mathbf{n}_i$ 正交的平面上，以 $\\mathbf{c}_i$ 为中心，半径为 $R_i$。\n- 您必须在 $[0,\\,2\\pi]$ 区间上对遍历每个圆周一次的角参数（以弧度为单位）计算 $M$ 的定义双重线积分。\n- 输出单位：亨利。每个结果必须是浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的四个数值结果列表，按情况 1 到 4 的顺序排列，例如 $[m_1,m_2,m_3,m_4]$。每个 $m_i$ 必须以科学记数法格式化，并至少有 10 位有效数字（例如，$1.234567890\\times 10^{-6}$ 应打印为 $1.234567890e-06$）。输出行中不允许有多余的文本或空格。", "solution": "所述问题在科学上是合理的、自洽的且提法得当。这是计算电磁学中的一个标准问题，植根于静磁学的基本原理。所有必要数据均已提供，问题是客观的且没有歧义。因此，将提供一个解决方案。\n\n两个闭合电流回路 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 之间的互感 $M$ 由诺伊曼公式定义：\n$$\nM \\;=\\; \\frac{\\mu_0}{4\\pi}\\;\\oint_{\\mathcal{C}_1}\\;\\oint_{\\mathcal{C}_2}\\;\\frac{\\mathrm{d}\\boldsymbol{\\ell}_1 \\cdot \\mathrm{d}\\boldsymbol{\\ell}_2}{\\|\\mathbf{r}_1 - \\mathbf{r}_2\\|}\\\n$$\n此处，$\\mu_0 = 4\\pi \\times 10^{-7}$ 亨利/米是磁常数，这使得前置因子在国际单位制中简化为 $\\frac{\\mu_0}{4\\pi} = 10^{-7}$。矢量 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 分别是指向线圈 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 上点的位矢，而 $\\mathrm{d}\\boldsymbol{\\ell}_1$、$\\mathrm{d}\\boldsymbol{\\ell}_2$ 是沿着这些线圈的微分矢量线元。\n\n为了计算这个双重线积分，我们必须首先对圆形线圈进行参数化。三维空间中的一个圆 $\\mathcal{C}_i$ 由其中心 $\\mathbf{c}_i$、半径 $R_i$ 以及其平面的单位法向量 $\\mathbf{n}_i$ 所指定。为了描述圆上的点，建立一个局部右手标准正交基 $(\\mathbf{u}_i, \\mathbf{v}_i, \\mathbf{n}_i)$ 会很方便，其中向量 $\\mathbf{u}_i$ 和 $\\mathbf{v}_i$ 张成包含该圆的平面。\n\n为给定 $\\mathbf{n}_i$ 构建这些基向量的一个稳健步骤如下：\n$1$. 选择一个不与 $\\mathbf{n}_i$ 共线的辅助向量 $\\mathbf{t}$。一个标准的选择是 $\\mathbf{t} = (0, 0, 1)$。如果 $\\mathbf{n}_i$ 平行于 $z$ 轴（即 $\\mathbf{n}_i = (0, 0, \\pm 1)$），则必须使用另一个向量，例如 $\\mathbf{t} = (1, 0, 0)$，以确保叉积不为零。\n$2$. 第一个平面基向量 $\\mathbf{u}_i$ 通过计算 $\\mathbf{n}_i$ 和 $\\mathbf{t}$ 的叉积并将结果归一化得到：\n$$\n\\mathbf{u}_i = \\frac{\\mathbf{n}_i \\times \\mathbf{t}}{\\|\\mathbf{n}_i \\times \\mathbf{t}\\|}\n$$\n$3$. 第二个平面基向量 $\\mathbf{v}_i$ 接着通过 $\\mathbf{n}_i$ 和 $\\mathbf{u}_i$ 的叉积找到，从而完成该标准正交集：\n$$\n\\mathbf{v}_i = \\mathbf{n}_i \\times \\mathbf{u}_i\n$$\n有了这个基，圆 $\\mathcal{C}_i$ 上的任意点 $\\mathbf{r}_i$ 都可以通过一个角变量 $\\theta_i \\in [0, 2\\pi]$ 进行参数化：\n$$\n\\mathbf{r}_i(\\theta_i) = \\mathbf{c}_i + R_i (\\cos(\\theta_i) \\mathbf{u}_i + \\sin(\\theta_i) \\mathbf{v}_i)\n$$\n微分线元 $\\mathrm{d}\\boldsymbol{\\ell}_i$ 通过将 $\\mathbf{r}_i(\\theta_i)$ 对其参数 $\\theta_i$ 求导得到：\n$$\n\\mathrm{d}\\boldsymbol{\\ell}_i = \\frac{\\mathrm{d}\\mathbf{r}_i}{\\mathrm{d}\\theta_i} \\mathrm{d}\\theta_i = R_i (-\\sin(\\theta_i) \\mathbf{u}_i + \\cos(\\theta_i) \\mathbf{v}_i) \\mathrm{d}\\theta_i\n$$\n将这两个线圈（下标为 1 和 2）的表达式代入诺伊曼公式，双重线积分就转换为了关于参数 $\\theta_1$ 和 $\\theta_2$ 的双重定积分：\n$$\nM = \\frac{\\mu_0}{4\\pi} \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\frac{\\left(\\frac{\\mathrm{d}\\mathbf{r}_1(\\theta_1)}{\\mathrm{d}\\theta_1}\\right) \\cdot \\left(\\frac{\\mathrm{d}\\mathbf{r}_2(\\theta_2)}{\\mathrm{d}\\theta_2}\\right)}{\\|\\mathbf{r}_1(\\theta_1) - \\mathbf{r}_2(\\theta_2)\\|} \\mathrm{d}\\theta_1 \\mathrm{d}\\theta_2\n$$\n被积函数的分子是两个切向量的点积：\n$$\n\\left(\\frac{\\mathrm{d}\\mathbf{r}_1}{\\mathrm{d}\\theta_1}\\right) \\cdot \\left(\\frac{\\mathrm{d}\\mathbf{r}_2}{\\mathrm{d}\\theta_2}\\right) = R_1 R_2 \\left( -\\sin(\\theta_1)\\mathbf{u}_1 + \\cos(\\theta_1)\\mathbf{v}_1 \\right) \\cdot \\left(-\\sin(\\theta_2)\\mathbf{u}_2 + \\cos(\\theta_2)\\mathbf{v}_2 \\right)\n$$\n分母是分隔两个线圈上点的向量的模长：\n$$\n\\|\\mathbf{r}_1(\\theta_1) - \\mathbf{r}_2(\\theta_2)\\| = \\|(\\mathbf{c}_1 - \\mathbf{c}_2) + R_1(\\cos(\\theta_1)\\mathbf{u}_1 + \\sin(\\theta_1)\\mathbf{v}_1) - R_2(\\cos(\\theta_2)\\mathbf{u}_2 + \\sin(\\theta_2)\\mathbf{v}_2)\\|\n$$\n该积分通常没有闭式解，必须进行数值计算。程序将使用一个标准的数值积分库来实现此计算。对于每个测试用例，算法按以下步骤进行：\n$1$. 定义线圈参数 ($R_i, \\mathbf{c}_i, \\mathbf{n}_i$)。对提供的任何法向量进行归一化，以确保它们是单位向量。\n$2$. 预先计算每个线圈的标准正交基向量 $(\\mathbf{u}_i, \\mathbf{v}_i)$。\n$3$. 定义一个被积函数，它接受积分变量 $(\\theta_2, \\theta_1)$ 并返回核函数的值。这个参数顺序与 `scipy` 中数值积分程序的要求一致，该程序首先计算内层积分。\n$4$. 使用 `scipy.integrate.dblquad` 计算在定义域 $[0, 2\\pi] \\times [0, 2\\pi]$ 上的双重积分。设置高精度容差以确保准确性，特别是在线圈彼此非常接近的情况下。\n$5$. 将积分结果乘以常数因子 $\\frac{\\mu_0}{4\\pi} = 10^{-7}$，得到最终的互感 $M$，单位为亨利。\n\n此过程被系统地应用于所有提供的测试用例，并且结果按规定格式化。", "answer": "```python\n# 完整且可运行的 Python 3 代码如下。\n# 导入必须符合指定的执行环境。\nimport numpy as np\nfrom scipy.integrate import dblquad\n\ndef solve():\n    \"\"\"\n    为多个测试用例计算两个圆形回路之间的互感。\n    \"\"\"\n    \n    # 磁常数 mu_0 / (4*pi)，单位：亨利/米\n    MU0_OVER_4PI = 1e-7\n\n    # 定义问题描述中的测试用例。\n    test_cases = [\n        # 情况 1：一般非共轴、非共面，中等间距\n        {\n            \"R1\": 0.10, \"c1\": (0.00, 0.00, 0.00), \"n1\": (0.0, 0.0, 1.0),\n            \"R2\": 0.08, \"c2\": (0.05, 0.02, 0.03), \"n2\": (1.0, 1.0, 1.0),\n        },\n        # 情况 2：大间距，弱耦合\n        {\n            \"R1\": 0.20, \"c1\": (0.20, -0.10, 0.00), \"n1\": (0.0, 1.0, 0.0),\n            \"R2\": 0.15, \"c2\": (1.00, -0.50, 0.80), \"n2\": (0.0, 0.0, 1.0),\n        },\n        # 情况 3：近乎相交的方位\n        {\n            \"R1\": 0.10, \"c1\": (0.00, 0.00, 0.00), \"n1\": (0.0, 0.0, 1.0),\n            \"R2\": 0.10, \"c2\": (0.005, 0.00, 0.00), \"n2\": (0.0, 1.0, 0.0),\n        },\n        # 情况 4：任意斜向方位和偏移\n        {\n            \"R1\": 0.12, \"c1\": (-0.03, 0.04, 0.02), \"n1\": (0.2, 0.9, 0.4),\n            \"R2\": 0.07, \"c2\": (0.06, -0.02, 0.05), \"n2\": (-0.3, 0.1, 0.95),\n        },\n    ]\n\n    results = []\n\n    def setup_loop_basis(n_vec):\n        \"\"\"\n        给定一个法向量 n，创建一个标准正交基 (u, v, n)。\n        \"\"\"\n        n = np.array(n_vec, dtype=float)\n        n /= np.linalg.norm(n)\n        \n        # 选择一个不与 n 平行的辅助向量 t\n        if np.abs(np.dot(n, [0.0, 0.0, 1.0])) > 1.0 - 1e-9:\n            # n 平行于 z 轴，因此选择 t 沿 x 轴\n            t = np.array([1.0, 0.0, 0.0])\n        else:\n            # n 不平行于 z 轴，因此选择 t 沿 z 轴\n            t = np.array([0.0, 0.0, 1.0])\n            \n        u = np.cross(n, t)\n        u /= np.linalg.norm(u)\n        \n        v = np.cross(n, u)\n        return u, v\n\n    for case in test_cases:\n        # 解包参数\n        R1, c1, n1 = case[\"R1\"], np.array(case[\"c1\"]), np.array(case[\"n1\"])\n        R2, c2, n2 = case[\"R2\"], np.array(case[\"c2\"]), np.array(case[\"n2\"])\n        \n        # 归一化法向量\n        n1 /= np.linalg.norm(n1)\n        n2 /= np.linalg.norm(n2)\n        \n        # 为线圈设置局部坐标系\n        u1, v1 = setup_loop_basis(n1)\n        u2, v2 = setup_loop_basis(n2)\n        \n        # 为 dblquad 定义被积函数\n        def integrand(theta2, theta1):\n            # 每个线圈上的位置矢量\n            r1 = c1 + R1 * (np.cos(theta1) * u1 + np.sin(theta1) * v1)\n            r2 = c2 + R2 * (np.cos(theta2) * u2 + np.sin(theta2) * v2)\n            \n            # 微分线元（按 R 缩放的切向量）\n            dl1_dth1 = R1 * (-np.sin(theta1) * u1 + np.cos(theta1) * v1)\n            dl2_dth2 = R2 * (-np.sin(theta2) * u2 + np.cos(theta2) * v2)\n            \n            # 诺伊曼公式核函数的分子\n            numerator = np.dot(dl1_dth1, dl2_dth2)\n            \n            # 诺伊曼公式核函数的分母\n            distance = np.linalg.norm(r1 - r2)\n            \n            # 问题设置确保了距离永远不为零\n            return numerator / distance\n\n        # 在 theta1 从 0 到 2*pi 和 theta2 从 0 到 2*pi 的范围内执行数值积分\n        integral_val, _ = dblquad(\n            integrand,\n            0, 2 * np.pi,  # 外层积分限 (theta1)\n            0, 2 * np.pi,  # 内层积分限 (theta2)\n            epsabs=1e-12, epsrel=1e-12 # 严格的容差以确保高精度\n        )\n        \n        mutual_inductance = MU0_OVER_4PI * integral_val\n        results.append(mutual_inductance)\n\n    # 按要求格式化最终输出字符串\n    output_str = f\"[{','.join(f'{r:.15e}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2419641"}]}