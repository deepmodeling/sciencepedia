## 引言
在[光学设计](@entry_id:163416)领域，精确预测光线在多元件系统中的行为是一项核心挑战。传统的几何作图法或逐个界面的光线追迹虽然直观，但在面对复杂系统时往往变得繁琐且容易出错。为了解决这一问题，物理学家和工程师们发展出一种更为高效和系统化的分析工具——[近轴光学](@entry_id:269651)中的矩阵方法。这种方法将光学系统的复杂性归结为优雅的线性代数运算，为理解和设计光学仪器提供了强大的理论框架。

本文将引导读者全面掌握这一核心技术。在“原理与机制”一章中，我们将从第一性原理出发，介绍如何用光线状态矢量描述一条光线，并为自由空间传播、透镜折射等基本光学过程构建其对应的2x2[光线传输矩阵](@entry_id:164892)（[ABCD矩阵](@entry_id:189406)）。接着，在“应用与跨学科联系”一章中，我们将展示如何将这些[基本矩阵](@entry_id:275638)组合起来，用以分析和设计如望远镜、变焦镜头等实际光学系统，并探讨该方法在[激光物理学](@entry_id:148513)、[梯度折射率光学](@entry_id:171455)乃至广义相对论等前沿领域的惊人应用。最后，通过“动手实践”部分，你将有机会通过解决具体问题来巩固所学知识，将理论真正转化为实践能力。

## 原理与机制

在[近轴近似](@entry_id:177930)的框架内，光线追迹可以通过一种强大而优雅的数学工具——[光线传输矩阵](@entry_id:164892)（Ray Transfer Matrix, RTM）——来精确描述。这种方法，也称为[ABCD矩阵法](@entry_id:192201)，将复杂光学系统对光线的作用简化为一系列简单的矩阵乘法。本章将系统地阐述[光线传输矩阵法](@entry_id:197720)的基本原理，构建核心的光学元件矩阵，并探讨如何运用此方法分析成像、系统特性以及[光学谐振腔](@entry_id:191817)的稳定性。

### 光线状态矢量：[近轴光学](@entry_id:269651)的状态描述

为了用数学语言描述一条光线，我们需要在光路中的特定位置捕捉其状态。在[近轴光学](@entry_id:269651)中，我们假设所有光线与系统[光轴](@entry_id:175875)的夹角都非常小（以弧度计，$\alpha \approx \sin\alpha \approx \tan\alpha$），并且它们距离[光轴](@entry_id:175875)的高度也远小于光学元件的[曲率半径](@entry_id:274690)。在这些条件下，我们可以通过一个二维列矢量来唯一确定一条光线在某个垂直于[光轴](@entry_id:175875)的参考平面上的状态：

$$
\mathbf{v} = \begin{pmatrix} y \\ \alpha \end{pmatrix}
$$

其中，$y$ 是光线在该平面上与[光轴](@entry_id:175875)的垂直距离（高度），$\alpha$ 是光[线与](@entry_id:177118)[光轴](@entry_id:175875)的夹角。我们通常采用如下符号约定：光轴上方的高度为正，下方为负；光线向上倾斜（与光轴夹角为锐角）时角度为正，向下倾斜时为负。这个矢量 $\mathbf{v}$ 被称为**光线状态矢量**。

光学系统的作用，就是将光线从一个输入参考平面上的初始状态 $\mathbf{v}_{\text{in}} = \begin{pmatrix} y_{\text{in}} \\ \alpha_{\text{in}} \end{pmatrix}$ 变换到输出参考平面上的最终状态 $\mathbf{v}_{\text{out}} = \begin{pmatrix} y_{\text{out}} \\ \alpha_{\text{out}} \end{pmatrix}$。在[近轴近似](@entry_id:177930)下，这种变换是线性的，因此可以由一个 $2 \times 2$ 的矩阵 $M$ 来描述：

$$
\begin{pmatrix} y_{\text{out}} \\ \alpha_{\text{out}} \end{pmatrix} = \begin{pmatrix} A  B \\ C  D \end{pmatrix} \begin{pmatrix} y_{\text{in}} \\ \alpha_{\text{in}} \end{pmatrix}
$$

这个矩阵 $M = \begin{pmatrix} A  B \\ C  D \end{pmatrix}$ 就是该光学系统的**[光线传输矩阵](@entry_id:164892)**。我们的任务就是为基本的光学过程确定其对应的矩阵，然后通过[矩阵乘法](@entry_id:156035)来分析由这些基本过程组合而成的复杂系统。

### 基本[光线传输矩阵](@entry_id:164892)

任何复杂的光学系统都可以分解为光线在均匀介质中的传播（平移）和在介质交界面上的[折射](@entry_id:163428)/反射。

#### 平移矩阵

考虑一条光线在[折射率](@entry_id:168910)为 $n$ 的均匀介质中沿光轴方向传播距离 $d$。设初始状态为 $(y_1, \alpha_1)$，终止状态为 $(y_2, \alpha_2)$。在[近轴近似](@entry_id:177930)下，光线传播路径可视为直线。因此，最终高度 $y_2$ 是初始高度 $y_1$ 加上因倾斜传播而产生的高度变化量 $d \tan\alpha_1 \approx d\alpha_1$。在均匀介质中，光线的传播方向不变，因此 $\alpha_2 = \alpha_1$。于是我们有：

$$
y_2 = y_1 + d \alpha_1
$$
$$
\alpha_2 = 0 \cdot y_1 + 1 \cdot \alpha_1
$$

写成矩阵形式，即为**平移矩阵** $P(d)$:

$$
P(d) = \begin{pmatrix} 1  d \\ 0  1 \end{pmatrix}
$$

这个矩阵描述了在任何均匀介质中自由传播距离 $d$ 的过程。

#### 折射矩阵

接下来，我们考虑光线在两种不同介质交界面上的折射。假设一个曲率半径为 $R$ 的球面将[折射率](@entry_id:168910)为 $n_1$ 的介质和[折射率](@entry_id:168910)为 $n_2$ 的介质分开（按惯例，从左到右看，凸面曲率半径为正）。光线从介质1入射到介质2。

在界面上，光线的高度是瞬时不变的，即 $y_2 = y_1$。然而，光线的角度会根据斯涅尔定律发生改变。对于近轴光线，斯涅尔定律 $n_1 \sin i = n_2 \sin r$ 可简化为 $n_1 i = n_2 r$，其中 $i$ 和 $r$ 分别是相对于界面法线的入射角和折射角。通过[几何分析](@entry_id:157700)可以推导出，[出射角](@entry_id:264341) $\alpha_2$ 与入射角 $\alpha_1$ 和入射高度 $y_1$ 之间的关系为 [@problem_id:2239895]：

$$
\alpha_2 = \frac{n_1 - n_2}{n_2 R} y_1 + \frac{n_1}{n_2} \alpha_1
$$

综合高度和角度的关系，我们得到**[单球面折射](@entry_id:167680)矩阵** $R_{\text{interface}}$：

$$
R_{\text{interface}} = \begin{pmatrix} 1  0 \\ \frac{n_1 - n_2}{n_2 R}  \frac{n_1}{n_2} \end{pmatrix}
$$

值得注意的是，在某些教材中会使用另一种光线状态矢量 $\begin{pmatrix} y \\ n\alpha \end{pmatrix}$，其中 $n\alpha$ 被称为光学[方向余弦](@entry_id:170591)。使用这种表示可以使某些矩阵形式更简洁，例如[单球面折射](@entry_id:167680)矩阵变为 $\begin{pmatrix} 1  0 \\ -\frac{n_2-n_1}{R}  1 \end{pmatrix}$ [@problem_id:2239889]。在本章中，我们将主要使用更直观的 $\begin{pmatrix} y \\ \alpha \end{pmatrix}$ 表示法。

#### 薄透镜矩阵

薄透镜是光学系统中最常见的元件之一。我们可以将其视为两个紧密贴合的球面。一个薄透镜的传输矩阵可以通过将两个[单球面折射](@entry_id:167680)矩阵相乘得到。对于一个焦距为 $f$、置于空气（或任何均匀介质）中的薄透镜，其矩阵可以简化为一个非常简洁和重要的形式。

当光线穿过薄透镜时，其高度可以认为没有变化，$y_2 = y_1$。其角度的变化遵循[透镜方程](@entry_id:161034)：对于从轴上发出的光线，会聚到[焦点](@entry_id:174388)；对于平行于轴入射的光线，会聚到焦平面。这可以总结为以下关系：

$$
\alpha_2 = \alpha_1 - \frac{y_1}{f}
$$

这里的 $f$ 是透镜的焦距，对于会聚透镜 $f>0$，对于[发散透镜](@entry_id:168382) $f<0$。因此，**薄透镜矩阵** $L(f)$ 为：

$$
L(f) = \begin{pmatrix} 1  0 \\ -\frac{1}{f}  1 \end{pmatrix}
$$

举一个简单的例子，考虑一条平行于[光轴](@entry_id:175875)（$\alpha_1=0$）以高度 $h_0$ 入射到焦距为 $-f$（$f>0$）的[发散透镜](@entry_id:168382)上的光线。通过透镜后的状态为 [@problem_id:2239899]：

$$
\begin{pmatrix} y_2 \\ \alpha_2 \end{pmatrix} = \begin{pmatrix} 1  0 \\ -\frac{1}{-f}  1 \end{pmatrix} \begin{pmatrix} h_0 \\ 0 \end{pmatrix} = \begin{pmatrix} 1  0 \\ \frac{1}{f}  1 \end{pmatrix} \begin{pmatrix} h_0 \\ 0 \end{pmatrix} = \begin{pmatrix} h_0 \\ \frac{h_0}{f} \end{pmatrix}
$$

光线的高度不变，但其角度变为 $\alpha_2 = h_0/f$。这是一个正值，意味着光线被向上偏折，远离[光轴](@entry_id:175875)，这正符合我们对[发散透镜](@entry_id:168382)的物理直觉。

### 分析光学系统

[光线传输矩阵法](@entry_id:197720)的真正威力在于它能够通过简单的矩阵乘法来分析由多个元件组成的复杂系统。

#### 级联矩阵

当光线依次穿过多个光学元件（$M_1, M_2, \ldots, M_N$）时，整个系统的总传输矩阵 $M_{\text{sys}}$ 是各个元件矩阵**逆序**相乘的结果：

$$
M_{\text{sys}} = M_N \cdots M_2 M_1
$$

逆序的原因在于，每个矩阵都是一个作用于其输入矢量的算符。$M_1$ 首先作用于初始光线矢量，其输出成为 $M_2$ 的输入，以此类推。

例如，一个由[焦距](@entry_id:164489)为 $f_1$ 的透镜和[焦距](@entry_id:164489)为 $f_2$ 的透镜组成，两者相距为 $d$ 的系统，其总矩阵是从第一个透镜前表面到第二个透镜后表面的变换 [@problem_id:2239883]。该系统可分解为：穿过透镜1 ($L_1$)，平移距离 $d$ ($P(d)$)，再穿过透镜2 ($L_2$)。因此，总矩阵为：

$$
M_{\text{sys}} = L(f_2) P(d) L(f_1) = \begin{pmatrix} 1  0 \\ -\frac{1}{f_2}  1 \end{pmatrix} \begin{pmatrix} 1  d \\ 0  1 \end{pmatrix} \begin{pmatrix} 1  0 \\ -\frac{1}{f_1}  1 \end{pmatrix}
$$

$$
M_{\text{sys}} = \begin{pmatrix} 1 - \frac{d}{f_1}  d \\ -(\frac{1}{f_1} + \frac{1}{f_2} - \frac{d}{f_1 f_2})  1 - \frac{d}{f_2} \end{pmatrix} = \begin{pmatrix} A  B \\ C  D \end{pmatrix}
$$

#### [等效焦距](@entry_id:168828)

对于一个复杂的复合透镜系统，我们常常希望用一个等效的单薄透镜来描述其整体的光焦度。这个等效透镜的[焦距](@entry_id:164489)被称为**[等效焦距](@entry_id:168828)** $f_{\text{eff}}$。对于一个置于空气中的任意光学系统，其[等效焦距](@entry_id:168828)与其总传输矩阵的 $C$ 元素直接相关：

$$
f_{\text{eff}} = -\frac{1}{C}
$$

这个定义的直观理解是，$C$ 元素描述了输出角 $\alpha_{\text{out}}$ 对输入高度 $y_{\text{in}}$ 的依赖关系（$\alpha_{\text{out}} = C y_{\text{in}} + D \alpha_{\text{in}}$）。对于平行入射光（$\alpha_{\text{in}}=0$），$\alpha_{\text{out}} = C y_{\text{in}}$。这与单薄透镜的行为 $\alpha_{\text{out}} = -y_{\text{in}}/f$ 完全对应，因此我们得到 $C = -1/f_{\text{eff}}$。

让我们用这个公式计算上述[双透镜](@entry_id:160834)系统的[等效焦距](@entry_id:168828)。假设 $f_1 = 30.0$ cm，$f_2 = 20.0$ cm，间距 $d = 15.0$ cm [@problem_id:2239920]。系统的 $C$ 元素为：

$$
C = -\left(\frac{1}{f_1} + \frac{1}{f_2} - \frac{d}{f_1 f_2}\right) = -\left(\frac{1}{30} + \frac{1}{20} - \frac{15}{30 \times 20}\right) = -\frac{7}{120} \text{ cm}^{-1}
$$

因此，[等效焦距](@entry_id:168828)为：

$$
f_{\text{eff}} = -\frac{1}{C} = \frac{120}{7} \approx 17.1 \text{ cm}
$$

#### [无焦系统](@entry_id:174581)

一类特殊且重要的光学系统是**[无焦系统](@entry_id:174581)**（Afocal System），其定义是任何平行入射光束（所有光线具有相同的入射角 $\alpha_{\text{in}}$，但高度 $y_{\text{in}}$ 不同）经过系统后，出射光束仍然是平行的（所有光线具有相同的[出射角](@entry_id:264341) $\alpha_{\text{out}}$）。望远镜就是[无焦系统](@entry_id:174581)的典型例子。

从总传输矩阵的方程 $\alpha_{\text{out}} = C y_{\text{in}} + D \alpha_{\text{in}}$ 可以看出，要使 $\alpha_{\text{out}}$ 对于任意变化的 $y_{\text{in}}$ 保持恒定，唯一的条件就是 $y_{\text{in}}$ 的系数必须为零 [@problem_id:2239926]。因此，一个光学系统是[无焦系统](@entry_id:174581)的充要条件是其总传输矩阵的 **$C$ 元素为零**：

$$
C = 0
$$

对于[无焦系统](@entry_id:174581)，[出射角](@entry_id:264341)和入射角的关系简化为 $\alpha_{\text{out}} = D \alpha_{\text{in}}$。这里的 $D$ 元素就是系统的[角放大率](@entry_id:169653)。

### 使用[光线传输矩阵](@entry_id:164892)进行成像分析

矩阵方法最强大的应用之一是其能够简洁地描述和[计算成像](@entry_id:170703)关系。

#### 通用[成像条件](@entry_id:750526)

成像的基本概念是：从物平面上某一点发出的所有光线（无论初始角度如何），都将汇聚到像平面上的同一点。这意味着，在像平面上，一条光线的最终高度 $y_i$ 只应依赖于它在物平面上的初始高度 $y_o$，而与其初始角度 $\alpha_o$ 无关。

我们可以通过构建一个从物平面到像平面的“总”传输矩阵来推导这个条件。这个过程包括：(1) 从物平面自由传播距离 $s_o$ 到达光学系统的前端；(2) 穿过由矩阵 $M_{\text{sys}}$ 描述的系统；(3) 从系统后端自由传播距离 $s_i$ 到达像平面。总矩阵 $M_{\text{total}}$ 为 [@problem_id:2239900]：

$$
M_{\text{total}} = P(s_i) M_{\text{sys}} P(s_o) = \begin{pmatrix} 1  s_i \\ 0  1 \end{pmatrix} \begin{pmatrix} A  B \\ C  D \end{pmatrix} \begin{pmatrix} 1  s_o \\ 0  1 \end{pmatrix} = \begin{pmatrix} A'  B' \\ C'  D' \end{pmatrix}
$$

最终的光线状态为 $\begin{pmatrix} y_i \\ \alpha_i \end{pmatrix} = M_{\text{total}} \begin{pmatrix} y_o \\ \alpha_o \end{pmatrix}$，即 $y_i = A' y_o + B' \alpha_o$。要使 $y_i$ 与 $\alpha_o$ 无关，矩阵的 $B'$ 元素必须为零。通过计算矩阵乘积，我们发现：

$$
B' = s_i (C s_o + D) + (A s_o + B)
$$

令 $B'=0$，我们就可以解出像距 $s_i$ 与物距 $s_o$ 以及[系统矩阵](@entry_id:172230)元素之间的**通用成像公式**：

$$
s_i = -\frac{A s_o + B}{C s_o + D}
$$

这个公式是高斯透镜公式的推广，适用于任何由[ABCD矩阵](@entry_id:189406)描述的复杂光学系统。例如，对于一个单薄透镜，$A=1, B=0, C=-1/f, D=1$，代入上式得到 $s_i = -\frac{s_o}{-s_o/f + 1}$，整理后即为我们熟悉的 $\frac{1}{s_o} + \frac{1}{s_i} = \frac{1}{f}$。

我们可以利用这个框架解决更复杂的问题，例如为一个由会聚透镜和[发散透镜](@entry_id:168382)组成的系统确定透镜间距 $d$，以实现特定的物距和像距 [@problem_id:2239883]。虽然直接求解包含 $d$ 的 $B'=0$ 方程在代数上较为繁琐，但它提供了一个系统化的方法。一个更直观且等效的方法是分步应用透镜公式：第一个透镜的像成为第二个透镜的物。这两种方法最终会得到相同的结果，但矩阵法为处理任意“黑箱”系统提供了更通用的工具。

### RTM 的性质与高级应用

[光线传输矩阵](@entry_id:164892)不仅是计算工具，其自身的数学性质也蕴含着深刻的物理意义。

#### RTM 的[行列式](@entry_id:142978)

一个 RTM 的[行列式](@entry_id:142978) $\det(M) = AD - BC$ 是一个重要的[不变量](@entry_id:148850)。对于最基本的折射过程，在两种介质 $n_1$ 和 $n_2$ 之间的界面，其[矩阵行列式](@entry_id:194066)为 $\det(R_{\text{interface}}) = n_1/n_2$。由于[行列式的乘法性质](@entry_id:148055) $\det(M_2 M_1) = \det(M_2) \det(M_1)$，对于一个从初始介质 $n_{\text{in}}$ 经过一系列变换到达最终介质 $n_{\text{out}}$ 的光学系统，其总[矩阵的行列式](@entry_id:148198)为 [@problem_id:2239887]：

$$
\det(M_{\text{sys}}) = \frac{n_{\text{in}}}{n_{\text{out}}}
$$

一个特别重要的情况是，当光学系统的输入和输出介质相同时（例如，空气中的透镜组），$n_{\text{in}} = n_{\text{out}}$，此时**系统矩阵的[行列式](@entry_id:142978)恒为 1**。这个性质与光学中的[拉格朗日不变量](@entry_id:164328)有关，本质上是相空间[体积守恒](@entry_id:276587)（刘维尔定理）在[近轴光学](@entry_id:269651)中的体现。

#### 逆矩阵与光路[可逆性](@entry_id:143146)

如果一个 RTM 的[行列式](@entry_id:142978)不为零，那么它的逆矩阵 $M^{-1}$ 就存在。[逆矩阵](@entry_id:140380)的物理意义是什么？让我们从[前向传播](@entry_id:193086)方程出发：$\mathbf{v}_{\text{out}} = M \mathbf{v}_{\text{in}}$。用 $M^{-1}$ 左乘两边，得到 $\mathbf{v}_{\text{in}} = M^{-1} \mathbf{v}_{\text{out}}$。

这个方程告诉我们，$M^{-1}$ 将输出平面的光线状态变换回输入平面的状态。因此，**[逆矩阵](@entry_id:140380) $M^{-1}$ 描述了光线沿原始路径[反向传播](@entry_id:199535)的过程**，即从原来的输出平面传播到原来的输入平面 [@problem_id:2239876]。这完美地体现了[费马原理](@entry_id:175608)所暗示的光路可逆性。

#### [光学谐振腔](@entry_id:191817)的稳定性

矩阵方法在[激光](@entry_id:194225)技术领域中至关重要，特别是在分析[光学谐振腔](@entry_id:191817)的稳定性方面。一个[光学谐振腔](@entry_id:191817)（或称[光学腔](@entry_id:158144)）由两面或多面反射镜构成，光线在其中来回反射。只有当光线能够在腔内稳定传播，即经过多次反射后仍被约束在光轴附近而不会发散逃逸时，才能形成稳定的[激光](@entry_id:194225)[振荡](@entry_id:267781)。

为了分析稳定性，我们选取腔内一个参考平面，计算光线从该平面出发，在腔内往返一周后回到该平面的**单周传输矩阵** $M_{\text{rt}}$。一条光线在腔内经过 $N$ 次往返后的状态由 $(M_{\text{rt}})^N$ 决定。通过对矩阵进行[本征值](@entry_id:154894)分析，可以证明，光线被稳定约束的条件是：

$$
-1 \le \frac{A+D}{2} \le 1
$$

其中 $A$ 和 $D$ 是单周矩阵 $M_{\text{rt}}$ 的对角元素，$\frac{A+D}{2}$ 是矩阵迹的一半。这个不等式就是**[谐振腔](@entry_id:274488)的[稳定性判据](@entry_id:755304)**。

例如，考虑一个由两面相同[凹面镜](@entry_id:169298)（曲率半径 $R$）组成的对称谐振腔，间距为 $L=R$，并在中心插入一个[焦距](@entry_id:164489)为 $f$ 的薄透镜 [@problem_id:2239917]。我们可以构建其单周传输矩阵 $M_{\text{rt}}$，这是一个包含多次平移、两次透镜折射和两次反射的复杂过程。计算出 $M_{\text{rt}}$ 的元素 $A$ 和 $D$ 后，代入[稳定性判据](@entry_id:755304)，可以解出使该[谐振腔](@entry_id:274488)稳定的条件。对于这个特定例子，计算结果表明，为了维持稳定，中心透镜的[焦距](@entry_id:164489)必须满足 $f > R/4$。这个结果对于[激光](@entry_id:194225)器的设计至关重要，它展示了 ABCD 矩阵法在解决实际、高级[光学工程](@entry_id:272219)问题中的强大能力。