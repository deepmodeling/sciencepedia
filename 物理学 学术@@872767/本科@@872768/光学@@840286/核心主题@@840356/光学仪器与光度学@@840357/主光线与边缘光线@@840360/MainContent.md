## 引言
在光学世界中，理解光如何通过一系列透镜和[光圈](@entry_id:172936)形成图像，是光学工程与设计的基础。然而，超越理想化的薄透镜公式，真实世界的光学系统充满了物理限制——透镜的有限直径和精心布置的光阑，它们共同决定了图像的亮度、清晰度和可见范围。仅仅知道像在哪里形成是不够的，我们还必须回答：像有多亮？视场有多大？[图像质量](@entry_id:176544)如何？要系统地回答这些问题，[光学设计](@entry_id:163416)引入了两个强大的分析工具：**[主光线](@entry_id:165818)** (chief ray) 和**[边缘光线](@entry_id:174766)** (marginal ray)。

本文旨在深入剖析这两个核心概念，揭示它们如何成为连接几何光学理论与实际系统性能的桥梁。我们将超越它们的几何定义，探讨它们在量化和优化光学系统中的关键作用。

在接下来的内容中，你将首先通过 **“原理与机制”** 章节，学习光阑、光瞳以及[主光线](@entry_id:165818)和[边缘光线](@entry_id:174766)的严格定义和基本相互作用。随后，在 **“应用与跨学科联系”** 章节中，我们将探索这些概念如何被用于分析系统性能、诊断像差，并指导从显微镜到天文望远镜等复杂仪器的设计。最后，通过 **“动手实践”** 部分，你将有机会将所学知识应用于具体问题，巩固你的理解。让我们从这些基本光线的定义和机制开始，踏上掌握光学[系统分析](@entry_id:263805)的旅程。

## 原理与机制

在光学系统的分析与设计中，仅仅依靠理想[薄透镜成像](@entry_id:175764)公式来预测像的位置和大小是远远不够的。一个真实的光学系统由具有有限尺寸的透镜、光圈和其它元件构成。这些有限的[孔径](@entry_id:172936)限制了光线的传播，不仅决定了图像的亮度，也决定了系统能够成像的[视场](@entry_id:175690)范围，并最终影响图像的质量。为了系统地理解和量化这些效应，[光学设计](@entry_id:163416)引入了光阑、光瞳以及两种关键的分析光线——**[主光线](@entry_id:165818)** (chief ray) 和**[边缘光线](@entry_id:174766)** (marginal ray) 的概念。本章将深入探讨这些基本原理及其相互作用的机制。

### 光阑：限制光线的孔径

在任何光学系统中，光[线束](@entry_id:167936)的尺寸和范围都受到物理元件的边界限制。这些起到限制作用的[孔径](@entry_id:172936)通称为**光阑 (stop)**。光阑可以是透镜自身的边框，也可以是特意放入光路中用于控制光线的独立光圈或膜片。根据其功能的不同，光阑主要分为两种：[孔径光阑](@entry_id:173170)和[视场光阑](@entry_id:174952)。

#### [孔径光阑](@entry_id:173170)与光瞳

**[孔径光阑](@entry_id:173170) (Aperture Stop, AS)** 是一个至关重要的概念，它指的是在所有光阑中，最有效地限制来自轴上物点的光锥[孔径](@entry_id:172936)角的那个物理孔径。换言之，对于一个位于光轴上的点光源，[孔径光阑](@entry_id:173170)决定了有多少光能够通过整个系统参与成像。

如何在一个多元件系统中确定哪个元件是[孔径光阑](@entry_id:173170)呢？方法是站在轴上物点的位置，“观察”系统中每一个可能成为光阑的元件。然而，我们看到的并非元件本身，而是它们经过其前方所有光学元件所成的像。这个像被称为该元件的**入瞳 (Entrance Pupil, EnP)**。所有元件的入瞳中，对物点张角最小的那一个，所对应的物理元件就是系统的[孔径光阑](@entry_id:173170)。

让我们通过一个具体的例子来理解这个过程。考虑一个由两枚薄透镜 L1 和 L2 组成的系统。L1 是焦距为 $f_1 = 100$ mm、直径为 $D_1 = 60$ mm 的会聚透镜，位于 $z_1 = 0$。L2 是[焦距](@entry_id:164489)为 $f_2 = -150$ mm、直径为 $D_2 = 12$ mm 的[发散透镜](@entry_id:168382)，位于 $z_2 = 50$ mm。一个轴上物点位于 $z_{obj} = -200$ mm 处。要确定[孔径光阑](@entry_id:173170)，我们需要比较 L1 和 L2 的入瞳大小。

1.  **L1 的入瞳**：由于 L1 前方没有其它光学元件，它的入瞳就是它自身。其入瞳直径为 $D_{e1} = D_1 = 60$ mm。

2.  **L2 的入瞳**：我们需要计算 L2 的[孔径](@entry_id:172936)（直径 $D_2 = 12$ mm，位于 $z=50$ mm）经过它前方的 L1 所成的像。根据[薄透镜成像](@entry_id:175764)公式 $\frac{1}{s} + \frac{1}{s'} = \frac{1}{f}$，L2 相对于 L1 的物距为 $s = 50$ mm。因此，其像距 $s'$ 满足 $\frac{1}{50} + \frac{1}{s'} = \frac{1}{100}$，解得 $s' = -100$ mm。像的放大率 $m = -s'/s = -(-100)/50 = 2$。因此，L2 的入瞳直径为 $D_{e2} = |m|D_2 = 2 \times 12 \text{ mm} = 24$ mm。这个入瞳是一个位于 L1 左侧 $100$ mm 处的[虚像](@entry_id:175248)。

现在，我们从物点位置 ($z=-200$ mm) 比较两个入瞳的张角。入瞳 $D_{e1}$ 的位置在 $z=0$，距离物点 $200$ mm；入瞳 $D_{e2}$ 的位置在 $z=-100$ mm，距离物点 $100$ mm。它们对物点张开的半角分别为 $\theta_1 \approx \frac{D_{e1}/2}{200} = \frac{30}{200} = 0.15$ 和 $\theta_2 \approx \frac{D_{e2}/2}{100} = \frac{12}{100} = 0.12$。由于 $\theta_2 \lt \theta_1$，L2 的入瞳对光锥的限制更强，因此 **L2 是该系统的[孔径光阑](@entry_id:173170)** [@problem_id:2259430]。

与入瞳相对应，**出瞳 (Exit Pupil, ExP)** 是[孔径光阑](@entry_id:173170)经过其后方所有光学元件所成的像。出瞳定义了从系统后方射出、汇聚成最终像点的光锥。对于一个设计良好的目视光学仪器（如望远镜或显微镜），观察者的眼睛瞳孔应与系统的出瞳重合，以确保能看到最亮且最完整的[视场](@entry_id:175690)。

入瞳和出瞳的位置取决于[孔径光阑](@entry_id:173170)的位置和前后光学元件的特性。
- 如果[孔径光阑](@entry_id:173170)是系统中的第一个光学元件（如在 [@problem_id:2259475] 的一个例子中），那么入瞳就与该元件重合。
- 如果[孔径光阑](@entry_id:173170)在系统末端，则出瞳与该元件重合。
- 如果[孔径光阑](@entry_id:173170)位于系统内部，则入瞳和出瞳都是其[虚像](@entry_id:175248)或实像。例如，若一个[光圈](@entry_id:172936)位于焦距为 $f$ 的薄透镜前方 $f/3$ 处并作为[孔径光阑](@entry_id:173170)，我们可以计算其出瞳位置。光阑作为透镜的“物”，物距 $s=f/3$。根据透镜公式 $\frac{1}{s'} = \frac{1}{f} - \frac{1}{s} = \frac{1}{f} - \frac{3}{f} = -\frac{2}{f}$，像距 $s' = -f/2$。负号表示出瞳是[虚像](@entry_id:175248)，位于透镜前方（物方空间）$f/2$ 处 [@problem_id:2259442]。

### [主光线](@entry_id:165818)和[边缘光线](@entry_id:174766)：关键的分析工具

一旦确定了系统的光瞳，我们就可以定义两种对于光学分析至关重要的光线。

#### [边缘光线](@entry_id:174766) (Marginal Ray)

**[边缘光线](@entry_id:174766)**是源自**轴上**物点，并恰好通过**入瞳边缘**的光线。经过系统后，它将通过[孔径光阑](@entry_id:173170)的边缘和出瞳的边缘，最终到达轴上像点。

[边缘光线](@entry_id:174766)的核心作用是定义了轴上点成像的[光锥](@entry_id:158105)。这个光锥的尺寸直接关系到几个关键的图像特性：

1.  **[图像亮度](@entry_id:175275)**：在忽略其它损失的情况下，轴上像点的辐[照度](@entry_id:166905)（亮度）正比于成像光锥的[立体角](@entry_id:154756)。这个立体角由出瞳的大小和位置决定，而出瞳本身是由[边缘光线](@entry_id:174766)界定的。因此，[边缘光线](@entry_id:174766)决定了系统从轴上物点收集光线的能力。在一个光学系统中，为了避免遮挡任何有用的光线，内部的机械结构（如隔板或遮光罩）必须位于[边缘光线](@entry_id:174766)构成的[光锥](@entry_id:158105)之内 [@problem_id:2259465]。例如，若一个轴上点光源距透镜 $s_o=500$ mm，透镜半径 $R_L=25.0$ mm，在透镜前 $350$ mm 处放置一个挡板，为不遮挡光线，其最大半径 $r_{b,max}$ 可由相似三角形确定：$\frac{r_{b,max}}{500 - 350} = \frac{R_L}{s_o}$，计算可得 $r_{b,max} = \frac{150 \times 25.0}{500} = 7.50$ mm。

2.  **分辨率与像差**：成像光锥的孔径角（由[边缘光线](@entry_id:174766)定义）是决定系统衍射极限分辨率的关键参数（通过[数值孔径](@entry_id:138876) $NA$ 体现）。同时，球差、彗差等多种像差的大小也与[边缘光线](@entry_id:174766)的传播路径和高度密切相关。

3.  **焦散斑 (Blur Circle)**：当像面并非精确地位于理想[焦点](@entry_id:174388)处时，成像[光锥](@entry_id:158105)会在像面上形成一个弥散的光斑，称为焦散斑。这个光斑的直径完全由[边缘光线](@entry_id:174766)的几何路径决定。一个最简单的例子是[针孔相机](@entry_id:172894)。一个点光源通过一个直径为 $d$ 的[针孔](@entry_id:176419)，在距离为 $L$ 的像屏上会形成一个光斑。通过简单的几何光学分析可以得出，这个光斑的直径为 $H_{spot} = d(1 + L/s_o)$，其中 $s_o$ 是光源到针孔的距离。这个尺寸仅由[针孔](@entry_id:176419)直径（[孔径光阑](@entry_id:173170)）和几何距离决定，而与光源的离轴高度无关 [@problem_id:2259461]。

    对于一个由透镜构成的系统，情况类似。假设一个焦距为 $f$、直径为 $D$ 的透镜，其理想物距为 $s_{o,nom}$，像面固定在对应的理想像距 $s_{i,nom}$ 处。如果物距发生微小变化 $\delta s_o$，实际物距变为 $s_o = s_{o,nom} + \delta s_o$，那么实际像距也会改变。由于像面位置固定，[边缘光线](@entry_id:174766)将在像面上形成一个焦散斑。通过几何推导可以得到，该焦散斑的直径为 [@problem_id:2259440]：
    $$
    d_{blur} = \frac{D |f \delta s_o|}{(s_{o,nom}-f)(s_{o,nom}+\delta s_o)}
    $$
    这个公式清晰地表明，焦散斑大小与[孔径光阑](@entry_id:173170)的直径 $D$ 成正比，并与离焦量 $\delta s_o$ 相关。在 defocus 情况下，[边缘光线](@entry_id:174766)定义了图像模糊的程度 [@problem_id:2259408]。

#### [主光线](@entry_id:165818) (Chief Ray)

**[主光线](@entry_id:165818)**是源自**轴外**物点，并穿过**入瞳中心**的光线。相应地，它也将穿过[孔径光阑](@entry_id:173170)的中心和出瞳的中心。

[主光线](@entry_id:165818)的作用与[边缘光线](@entry_id:174766)截然不同，它主要与[视场](@entry_id:175690)和图像的几何形状有关：

1.  **确定像高**：[主光线](@entry_id:165818)从离轴物点出发，其在像面上落点的位置定义了该物点的像的位置。因此，[主光线](@entry_id:165818)的高度决定了系统的[横向放大率](@entry_id:167633)。

2.  **定义[视场](@entry_id:175690)**：一个光学系统能够清晰成像的物体范围称为**[视场](@entry_id:175690) (Field of View, FOV)**。视场的大小通常由某个光阑限制，使得来自[视场](@entry_id:175690)边缘的[主光线](@entry_id:165818)恰好能通过该光阑。这个限制视场的光阑被称为**[视场光阑](@entry_id:174952) (Field Stop)**。

### 视场与渐晕

#### [视场光阑](@entry_id:174952)与视窗

**[视场光阑](@entry_id:174952) (Field Stop, FS)** 是限制通过系统的[主光线](@entry_id:165818)传播范围的物理孔径。在实际系统中，为了获得一个边界清晰的圆形视场，[视场光阑](@entry_id:174952)通常被放置在某个中间像面上。

与[孔径光阑](@entry_id:173170)对应入瞳和出瞳一样，[视场光阑](@entry_id:174952)也有其对应的“窗口”：
- **入窗 (Entrance Window, EnW)**：[视场光阑](@entry_id:174952)经过其**前方**所有光学元件所成的像。从物空间看，入窗定义了系统的[视场](@entry_id:175690)范围。
- **出窗 (Exit Window, ExW)**：[视场光阑](@entry_id:174952)经过其**后方**所有光学元件所成的像。在像空间中，所有可观察到的图像都位于出窗的范围之内。

例如，在一个[双透镜](@entry_id:160834)系统中，L1 焦距为 $20.0$ cm，L2 焦距为 $15.0$ cm，间距为 $70.0$ cm。一个物体位于 L1 左侧 $30.0$ cm 处。L1 成的中间像位于其右侧 $60.0$ cm 处，也就是 L2 左侧 $10.0$ cm 处。如果我们将[视场光阑](@entry_id:174952)放置在这个中间像面上，那么出窗就是这个[视场光阑](@entry_id:174952)经过 L2 所成的像。以[视场光阑](@entry_id:174952)为物，物距 $s_2 = 10.0$ cm，经过[焦距](@entry_id:164489) $f_2 = 15.0$ cm 的 L2 成像，像距 $s_2' = \frac{f_2 s_2}{s_2 - f_2} = \frac{15.0 \times 10.0}{10.0 - 15.0} = -30.0$ cm。这意味着出窗是一个位于 L2 左侧 $30.0$ cm 处的[虚像](@entry_id:175248) [@problem_id:2259453]。

#### 渐晕 (Vignetting)

在理想情况下，我们希望离轴像点的亮度和轴上像点一样。然而，在许多实际系统中，离轴像点会比轴上像点暗，并且[视场](@entry_id:175690)边缘的[图像亮度](@entry_id:175275)会显著下降。这种现象称为**渐晕 (vignetting)**。

渐晕的根本原因是，对于离轴物点，其发出的完整[光锥](@entry_id:158105)（由[孔径光阑](@entry_id:173170)界定）在通过系统时，部分光线被[孔径光阑](@entry_id:173170)之外的其它光学元件（如透镜边框）所遮挡。换言之，对于离轴[视场](@entry_id:175690)，系统的[有效孔径](@entry_id:262333)变小了。

我们可以通过光线追迹来量化渐晕。考虑一个[双透镜](@entry_id:160834)系统，[孔径光阑](@entry_id:173170)为第一枚透镜 L1。来自无穷远的一个离轴物点的平行光束以角度 $\alpha$ 入射。我们可以追迹通过 L1 上下边缘的两条[边缘光线](@entry_id:174766)。这两条光线之间的区域定义了该离轴物点的成像光束。当光束传播到第二枚透镜 L2 时，如果其[截面](@entry_id:154995)尺寸超出了 L2 的[孔径](@entry_id:172936)，就会发生光线遮挡，即渐晕。通过精确计算[边缘光线](@entry_id:174766)在 L2 平面的高度，并与 L2 的半径比较，我们就可以精确计算出被遮挡的光束高度，从而量化渐晕的程度 [@problem_id:2259441]。

### 综合与深入：[拉格朗日不变量](@entry_id:164328)

[主光线](@entry_id:165818)和[边缘光线](@entry_id:174766)不仅是定性分析的工具，它们之间还存在着深刻的定量关系，这一关系由**[拉格朗日不变量](@entry_id:164328) (Lagrange Invariant)** 或[亥姆霍兹-拉格朗日不变量](@entry_id:202694)来描述。对于一个共轴的[近轴光学](@entry_id:269651)系统，对于任意选定的两条光线（通常选为[边缘光线](@entry_id:174766)和[主光线](@entry_id:165818)），[不变量](@entry_id:148850) $H$ 在光路中每两个连续面之间传递时都保持不变。其表达式为：
$$
H = n\bar{u}y - nu\bar{y}
$$
其中，$n$ 是介质的[折射率](@entry_id:168910)，$y$ 和 $u$ 分别是[边缘光线](@entry_id:174766)在某参考平面上的高度和与光轴的夹角，而 $\bar{y}$ 和 $\bar{u}$ 则是[主光线](@entry_id:165818)的高度和夹角。

这个[不变量](@entry_id:148850)揭示了光学系统性能参数之间的内在联系。例如，它将系统的[光通量](@entry_id:167624)（或称 étendue、AΩ 积）与入瞳直径和[视场](@entry_id:175690)角联系起来。考虑一个为无穷远物体成像的系统，其物方为真空 ($n=1$)。我们在系统的入瞳处计算[不变量](@entry_id:148850)。对于[边缘光线](@entry_id:174766)，$y = D_{EP}/2$（入瞳半径）；对于来自最大视场角 $\theta_{max}$ 的[主光线](@entry_id:165818)，它穿过入瞳中心，所以 $\bar{y}=0$，其角度为 $\bar{u}=\theta_{max}$。此时，[不变量](@entry_id:148850)为 $H = 1 \cdot \theta_{max} \cdot (D_{EP}/2) - 1 \cdot u \cdot 0 = \frac{1}{2} D_{EP} \theta_{max}$ (这里 $u$ 是轴上平行光束的角度，为0，但为了通用性保留了该项)。

现在，我们在像方计算[不变量](@entry_id:148850)。像方介质[折射率](@entry_id:168910)为 $n'$，[边缘光线](@entry_id:174766)以角度 $u'$ 汇聚到轴上像点 ($y=0$)，[主光线](@entry_id:165818)以角度 $\bar{u}'$ 到达最大像高 $y'_{max}$ ($\bar{y}'=y'_{max}$)。此时[不变量](@entry_id:148850)为 $H = n' \bar{u}' y - n' u' \bar{y} = n' \bar{u}'(0) - n' u'(y'_{max}) = -n' u' y'_{max}$。

联立物方和像方的[不变量](@entry_id:148850)表达式，我们得到 $\frac{1}{2} D_{EP} \theta_{max} = -n' u' y'_{max}$。这个关系式将入瞳直径（决定亮度）、视场角（决定范围）、像高和像方孔径角联系在一起。

更有趣的是，我们可以将它与系统的物理[光学分辨率](@entry_id:172575)联系起来。假设系统在像面上的分辨率由[瑞利判据](@entry_id:269526)给出，最小可分辨距离为 $\Delta L = 0.61 \frac{\lambda'}{NA'}$，其中 $\lambda' = \lambda/n'$ 是像方波长，$NA' \approx n'|u'|$ 是像方数值孔径。如果系统要求在[视场](@entry_id:175690)直径上能够分辨 $N$ 个点，则最大像高为 $y'_{max} = N/2 \cdot \Delta L$。将这些关系代入[不变量](@entry_id:148850)方程并整理，可以得到一个惊人的结果 [@problem_id:2259433]：
$$
D_{EP} \cdot (2\theta_{max}) = \frac{1.22 N \lambda}{n'}
$$
这个公式被称为系统的“空间-带宽积”或“通量”，它表明，一个光学系统的入瞳直径（光能收集能力）和全[视场](@entry_id:175690)角（空间覆盖范围）的乘积，并非可以无限增大，而是受到一个[基本常数](@entry_id:148774)的限制。这个常数由系统需要传递的[信息量](@entry_id:272315)（$N$个分辨点）、光的本性（波长 $\lambda$）以及像方介质所决定。这一深刻的结论完美地统一了起来自[几何光学](@entry_id:175509)的核心概念（光瞳、光线）和[物理光学](@entry_id:178058)的基本限制（衍射、分辨率）。