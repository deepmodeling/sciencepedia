{"hands_on_practices": [{"introduction": "在校正波前之前，我们必须有一种方法来衡量光学系统的成像质量。斯特列尔比 (Strehl ratio) 是一个关键指标，它将被观测图像的峰值亮度与理论上完美的图像进行比较。本练习 [@problem_id:2217569] 将指导你使用马雷夏尔近似 (Maréchal approximation)，从已知的波前误差计算斯特列尔比，这是光学工程师必备的一项基本技能。", "problem": "一个工程师团队正在为一台大型地基天文望远镜测试一套新的自适应光学（AO）系统。该AO系统的目的是校正由大气湍流引起的波前畸变。在一次测试运行中，该系统在波长 $\\lambda$ 处观测一颗稳定的导星，其性能得到了评估。波前中残余的未校正误差被测量为望远镜孔径上的均方根（RMS）光程差，其值为 $\\sigma_{L} = \\frac{\\lambda}{14}$。\n\n所得恒星图像的质量由斯特列尔比（Strehl ratio）$S$ 来量化，其定义为观测图像中的峰值强度与一个完美无像差光学系统可实现的理论峰值强度之比。对于具有微小残余像差的系统，斯特列尔比可以使用马雷夏尔近似（Maréchal approximation）进行精确估算，其公式为：\n$$S \\approx \\exp(-\\sigma_{\\phi}^2)$$\n其中 $\\sigma_{\\phi}$ 是以弧度为单位的波前均方根相位误差。\n\n请利用所提供的信息，计算此次测试中望远镜AO系统的斯特列尔比。将您的答案表示为保留三位有效数字的小数。", "solution": "我们的目标是使用马雷夏尔近似 $S \\approx \\exp(-\\sigma_{\\phi}^2)$ 来计算斯特列尔比 $S$。我们已知均方根（RMS）光程差 $\\sigma_{L}$，需要求出均方根相位误差 $\\sigma_{\\phi}$。\n\n首先，我们必须建立光程差 $L$ 和相位差 $\\phi$ 之间的关系。等于一个完整波长 $\\lambda$ 的光程差对应于 $2\\pi$ 弧度的相移。这个关系可以表示为：\n$$\\phi = \\frac{2\\pi}{\\lambda} L$$\n\n此方程表明相位差与光程差之间存在线性关系。因此，这些量的统计度量（如均方根误差）也通过相同的线性因子相关联。所以，均方根相位误差 $\\sigma_{\\phi}$ 可以通过均方根光程差 $\\sigma_{L}$ 计算得出，如下所示：\n$$\\sigma_{\\phi} = \\frac{2\\pi}{\\lambda} \\sigma_{L}$$\n\n问题陈述中给出的测量均方根光程差为 $\\sigma_{L} = \\frac{\\lambda}{14}$。我们可以将这个值代入 $\\sigma_{\\phi}$ 的方程中：\n$$\\sigma_{\\phi} = \\frac{2\\pi}{\\lambda} \\left(\\frac{\\lambda}{14}\\right)$$\n\n波长 $\\lambda$ 被消掉了：\n$$\\sigma_{\\phi} = \\frac{2\\pi}{14} = \\frac{\\pi}{7} \\text{ radians}$$\n\n现在我们得到了均方根相位误差。马雷夏尔近似需要相位误差的方差，也就是均方根相位误差的平方，即 $\\sigma_{\\phi}^2$：\n$$\\sigma_{\\phi}^2 = \\left(\\frac{\\pi}{7}\\right)^2 = \\frac{\\pi^2}{49}$$\n\n最后，我们将此方差代入马雷夏尔近似中，求出斯特列尔比 $S$：\n$$S \\approx \\exp(-\\sigma_{\\phi}^2) = \\exp\\left(-\\frac{\\pi^2}{49}\\right)$$\n\n为了得到数值答案，我们使用 $\\pi \\approx 3.14159265$ 的值：\n$$\\pi^2 \\approx (3.14159265)^2 \\approx 9.8696044$$\n$$\\sigma_{\\phi}^2 = \\frac{9.8696044}{49} \\approx 0.2014205$$\n\n现在，我们计算斯特列尔比：\n$$S \\approx \\exp(-0.2014205) \\approx 0.817579$$\n\n问题要求答案保留三位有效数字。\n$$S \\approx 0.818$$\n这个结果与马雷夏尔判据（Maréchal criterion）一致，该判据指出，如果一个系统的斯特列尔比 $S \\ge 0.8$，则该系统被认为是“衍射极限”的，这一条件在均方根波前误差约为 $\\lambda/14$ 时满足。", "answer": "$$\\boxed{0.818}$$", "id": "2217569"}, {"introduction": "既然我们能够量化系统性能，接下来让我们探究校正的核心机制：可变形反射镜 (Deformable Mirror, DM)。本练习 [@problem_id:2217607] 将揭示由大气湍流引起的相位误差与抵消该误差所需反射镜表面物理位移之间的直接联系。这种计算是自适应光学系统主动恢复清晰图像的核心。", "problem": "一个地基望远镜配备了自适应光学系统，以校正由大气湍流引起的图像模糊。该系统使用一个反射式可变形镜（DM）来调整入射光的路径。考虑一束真空波长为 $\\lambda_0 = 600$ nm 的星光。在到达望远镜之前，这束光穿过一个长度为 $L = 50.0$ m 的湍流气团，其折射率均匀为 $n = 1.0003180$。周围的非湍流大气的折射率为 $n_{air} = 1.0002930$。为了消除这个湍流气团引入的相位畸变，可变形镜必须在其光线入射点处的表面产生位移。\n\n计算沿镜面法线方向所需的表面位移 $d$ 的大小。最终答案以纳米（nm）为单位，并四舍五入到三位有效数字。", "solution": "一束真空波长为 $\\lambda_{0}$ 的单色波在折射率为 $n$ 的介质中传播几何路径长度 $L$ 后所累积的相位为\n$$\n\\phi = k_{0} \\, n \\, L, \\quad \\text{其中} \\quad k_{0} = \\frac{2\\pi}{\\lambda_{0}}。\n$$\n相对于折射率为 $n_{air}$ 的周围非湍流空气，湍流气团引入的附加相位为\n$$\n\\Delta \\phi_{\\text{turb}} = k_{0}\\,(n - n_{air})\\,L。\n$$\n一个反射式可变形镜沿其表面法线方向位移距离 $d$，会使光在周围介质（折射率为 $n_{air}$）中的往返光程改变\n$$\n\\Delta \\text{OPL}_{\\text{DM}} = 2\\,n_{air}\\,d,\n$$\n对应的相位变化为\n$$\n\\Delta \\phi_{\\text{DM}} = k_{0}\\,\\Delta \\text{OPL}_{\\text{DM}} = k_{0}\\,(2\\,n_{air}\\,d)。\n$$\n为了消除畸变，我们需要 $|\\Delta \\phi_{\\text{DM}}| = |\\Delta \\phi_{\\text{turb}}|$，因此\n$$\nk_{0}\\,(2\\,n_{air}\\,d) = k_{0}\\,(n - n_{air})\\,L \\;\\;\\Rightarrow\\;\\; d = \\frac{(n - n_{air})\\,L}{2\\,n_{air}}。\n$$\n代入给定值 $n = 1.0003180$，$n_{air} = 1.0002930$ 和 $L = 50.0\\,\\text{m}$，\n$$\nd = \\frac{(1.0003180 - 1.0002930)\\times 50.0}{2 \\times 1.0002930}\\,\\text{m}\n= \\frac{2.50 \\times 10^{-5} \\times 50.0}{2.000586}\\,\\text{m}\n\\approx 6.248 \\times 10^{-4}\\,\\text{m}。\n$$\n使用 $1\\,\\text{m} = 1 \\times 10^{9}\\,\\text{nm}$ 转换为纳米，得到\n$$\nd \\approx 6.248 \\times 10^{5}\\,\\text{nm}。\n$$\n四舍五入到三位有效数字，所需的表面位移大小为 $6.25 \\times 10^{5}\\,\\text{nm}$。", "answer": "$$\\boxed{6.25 \\times 10^{5}}$$", "id": "2217607"}, {"introduction": "实际的可变形反射镜包含多个驱动器，每个驱动器产生一个特定的形状，即“影响函数” (influence function)，总的校正形状是这些影响函数的加权和。这个更进一步的练习 [@problem_id:2217555] 引入了强大的模式控制概念，即寻找每个驱动器的最优指令以最佳拟合给定的像差，从而最小化残余误差。该技术是现代自适应光学系统中复杂控制算法的基础。", "problem": "一位工程师正在设计一个波前校正系统，该系统使用一个长度为 $L$ 的一维可变形反射镜。该反射镜旨在校正光学系统中的一种静态、缓慢变化的像差。这种像差代表了与完美波前的偏差，可用函数 $W_{\\text{ab}}(x) = Kx(L-x)$ 来建模，其中 $x \\in [0, L]$，$K$ 是一个常数，其单位为长度的倒数。\n\n该可变形反射镜有两个可以产生校正形状的致动器。每个致动器在单位指令下产生的形状，称为影响函数，由以下公式给出：\n$I_1(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{\\pi x}{L}\\right)$\n$I_2(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{3\\pi x}{L}\\right)$\n\n反射镜施加的总校正形状是这些影响函数的线性组合：$W_{\\text{corr}}(x) = c_1 I_1(x) + c_2 I_2(x)$，其中 $c_1$ 和 $c_2$ 是发送给致动器的无量纲指令信号。\n\n为了达到最佳校正效果，工程师必须找到最佳指令 $c_1$ 和 $c_2$，以最小化积分平方残差，其定义为 $E^2 = \\int_0^L [W_{\\text{ab}}(x) - W_{\\text{corr}}(x)]^2 dx$。\n\n你可以利用以下事实：这些影响函数在区间 $x \\in [0, L]$ 上是标准正交的，这意味着 $\\int_0^L I_m(x) I_n(x) dx = \\delta_{mn}$，其中 $\\delta_{mn}$ 是克罗内克 delta（如果 $m=n$ 则 $\\delta_{mn}=1$，否则为 $0$）。\n\n确定最佳致动器指令 $c_1$ 和 $c_2$ 的解析表达式，用参数 $K$ 和 $L$ 表示。", "solution": "我们在标准正交影响函数 $I_{1}$ 和 $I_{2}$ 的二维张成空间上最小化积分平方残差 $E^{2}=\\int_{0}^{L}\\left[W_{\\text{ab}}(x)-W_{\\text{corr}}(x)\\right]^{2}\\,dx$。对于一个标准正交集 $\\{I_{n}\\}$，最小化器是 $W_{\\text{ab}}$ 在它们张成空间上的正交投影，从而得到正规方程\n$$\n\\frac{\\partial E^{2}}{\\partial c_{k}}=-2\\int_{0}^{L}\\left[W_{\\text{ab}}(x)-\\sum_{n}c_{n}I_{n}(x)\\right]I_{k}(x)\\,dx=0\n\\quad\\Rightarrow\\quad\nc_{k}=\\int_{0}^{L}W_{\\text{ab}}(x)\\,I_{k}(x)\\,dx\n$$,\n因为 $\\int_{0}^{L}I_{m}(x)I_{n}(x)\\,dx=\\delta_{mn}$。\n\n当 $W_{\\text{ab}}(x)=Kx(L-x)$ 且 $I_{m}(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\left(\\frac{m\\pi x}{L}\\right)$（对于 $m\\in\\{1,3\\}$）时，我们有\n$$\nc_{m}=K\\sqrt{\\frac{2}{L}}\\int_{0}^{L}x(L-x)\\sin\\!\\left(\\frac{m\\pi x}{L}\\right)\\,dx\n$$。\n定义 $a=\\frac{m\\pi}{L}$ 并计算\n$$\nJ_{m}:=\\int_{0}^{L}x(L-x)\\sin(ax)\\,dx=\\int_{0}^{L}(Lx-x^{2})\\sin(ax)\\,dx.\n$$\n使用标准原函数\n$$\n\\int x\\sin(ax)\\,dx=-\\frac{x\\cos(ax)}{a}+\\frac{\\sin(ax)}{a^{2}},\\qquad\n\\int x^{2}\\sin(ax)\\,dx=-\\frac{x^{2}\\cos(ax)}{a}+\\frac{2x\\sin(ax)}{a^{2}}+\\frac{2\\cos(ax)}{a^{3}},\n$$\n我们得到\n$$\n\\int_{0}^{L}x\\sin(ax)\\,dx=-\\frac{L\\cos(aL)}{a}+\\frac{\\sin(aL)}{a^{2}},\n$$\n$$\n\\int_{0}^{L}x^{2}\\sin(ax)\\,dx=-\\frac{L^{2}\\cos(aL)}{a}+\\frac{2L\\sin(aL)}{a^{2}}+\\frac{2\\cos(aL)}{a^{3}}-\\frac{2}{a^{3}}.\n$$\n因此\n$$\nJ_{m}=L\\int_{0}^{L}x\\sin(ax)\\,dx-\\int_{0}^{L}x^{2}\\sin(ax)\\,dx\n=-\\frac{L\\sin(aL)}{a^{2}}-\\frac{2\\cos(aL)}{a^{3}}+\\frac{2}{a^{3}}.\n$$\n当 $aL=m\\pi$ 时，我们有 $\\sin(aL)=0$ 和 $\\cos(aL)=(-1)^{m}$，因此\n$$\nJ_{m}=\\frac{2}{a^{3}}\\left(1-\\cos(m\\pi)\\right).\n$$\n对于奇数 $m$（这里 $m=1$ 和 $m=3$），$\\cos(m\\pi)=-1$，所以\n$$\nJ_{m}=\\frac{4}{a^{3}}=\\frac{4}{\\left(\\frac{m\\pi}{L}\\right)^{3}}=\\frac{4L^{3}}{m^{3}\\pi^{3}}.\n$$\n从而\n$$\nc_{m}=K\\sqrt{\\frac{2}{L}}\\,J_{m}=K\\sqrt{\\frac{2}{L}}\\cdot\\frac{4L^{3}}{m^{3}\\pi^{3}}=\\frac{4\\sqrt{2}\\,K\\,L^{5/2}}{m^{3}\\pi^{3}}.\n$$\n将 $m=1$ 和 $m=3$ 代入可得\n$$\nc_{1}=\\frac{4\\sqrt{2}\\,K\\,L^{5/2}}{\\pi^{3}},\\qquad\nc_{2}=\\frac{4\\sqrt{2}\\,K\\,L^{5/2}}{27\\,\\pi^{3}}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{4\\sqrt{2}\\,K\\,L^{5/2}}{\\pi^{3}}  \\frac{4\\sqrt{2}\\,K\\,L^{5/2}}{27\\,\\pi^{3}}\\end{pmatrix}}$$", "id": "2217555"}]}