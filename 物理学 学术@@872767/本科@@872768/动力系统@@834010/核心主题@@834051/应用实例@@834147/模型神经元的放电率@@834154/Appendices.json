{"hands_on_practices": [{"introduction": "漏放电（LIF）模型是计算神经科学的基石。第一个练习 [@problem_id:1675499] 提供了计算神经元对简单输入的响应的基本实践。通过求解膜电位达到放电阈值所需的时间，你将推导出脉冲间间隔，这是确定神经元放电频率的基础。", "problem": "计算神经科学中的一个基础模型是漏积分-发放 (Leaky Integrate-and-Fire, LIF) 神经元模型。其膜电位 $V(t)$ 的动力学由以下一阶常微分方程决定：\n$$C \\frac{dV}{dt} = -\\frac{V(t) - V_{rest}}{R} + I(t)$$\n其中 $C$ 是膜电容，$R$ 是膜电阻，$V_{rest}$ 是神经元的静息电位，$I(t)$ 是外部输入电流。\n\n“积分-发放”行为如下：神经元的电位 $V(t)$ 对输入电流随时间进行积分。如果 $V(t)$ 达到一个阈值电位 $V_{th}$，则称该神经元“发放”一个脉冲。在发放脉冲后，其电位立即被重置为一个值 $V_{reset}$。为了使模型具有物理意义，我们假设 $V_{reset}  V_{th}$。\n\n考虑一个LIF神经元，其初始状态处于其重置电位，即 $V(0) = V_{reset}$。在时间 $t=0$ 时，一个恒定的、超阈值的电流 $I(t) = I_0$ 被注入神经元并保持不变。“超阈值”电流是指其足够大，最终能使膜电位达到阈值，这在数学上对应于条件 $R I_0  V_{th} - V_{rest}$。\n\n确定神经元发放其第一个脉冲的时间 $T_{spike}$ 的解析表达式。你的答案应使用参数 $R、C、V_{rest}、V_{reset}、V_{th}$ 和 $I_0$ 来表示。", "solution": "我们从具有恒定输入的线性一阶常微分方程开始：\n$$C \\frac{dV}{dt} = -\\frac{V - V_{rest}}{R} + I_{0}.$$\n方程两边同除以 $C$，写成标准线性形式：\n$$\\frac{dV}{dt} + \\frac{1}{RC}V = \\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}.$$\n这是一个常系数线性常微分方程。其积分因子为\n$$\\mu(t) = \\exp\\!\\left(\\int \\frac{1}{RC}\\,dt\\right) = \\exp\\!\\left(\\frac{t}{RC}\\right).$$\n两边乘以 $\\mu(t)$ 得\n$$\\exp\\!\\left(\\frac{t}{RC}\\right)\\frac{dV}{dt} + \\frac{1}{RC}\\exp\\!\\left(\\frac{t}{RC}\\right)V = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\n方程左边是乘积 $\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)$ 的导数，所以\n$$\\frac{d}{dt}\\!\\left[\\exp\\!\\left(\\frac{t}{RC}\\right)V(t)\\right] = \\left(\\frac{V_{rest}}{RC} + \\frac{I_{0}}{C}\\right)\\exp\\!\\left(\\frac{t}{RC}\\right).$$\n对时间进行积分，并将积分常数吸收到 $V(t)$ 中，可以得到标准弛豫形式的通解。为方便起见，我们首先在原常微分方程中令 $\\frac{dV}{dt}=0$ 来确定恒定输入下的稳态（平衡）电位：\n$$0 = -\\frac{V_{\\infty} - V_{rest}}{R} + I_{0} \\quad \\Rightarrow \\quad V_{\\infty} = V_{rest} + R I_{0}.$$\n使用积分因子法求解，并应用初始条件 $V(0)=V_{reset}$，我们得到\n$$V(t) = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{t}{RC}\\right).$$\n第一个脉冲发生在时间 $T_{spike}$，此时 $V(T_{spike})=V_{th}$。施加这个阈值条件可得\n$$V_{th} = V_{\\infty} + \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right).$$\n重新整理以分离出指数项：\n$$V_{th} - V_{\\infty} = \\big(V_{reset} - V_{\\infty}\\big)\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right),$$\n$$\\exp\\!\\left(-\\frac{T_{spike}}{RC}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}.$$\n取自然对数并求解 $T_{spike}$ 得\n$$-\\frac{T_{spike}}{RC} = \\ln\\!\\left(\\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}}\\right), \\quad \\text{所以} \\quad T_{spike} = RC \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).$$\n将 $V_{\\infty} = V_{rest} + R I_{0}$ 代入，即可得到用模型参数表示所求的表达式。在超阈值条件 $R I_{0}  V_{th} - V_{rest}$ 下，我们有 $V_{\\infty}  V_{th}$，并且由于 $V_{reset}  V_{th}$，对数的参数大于一，这保证了 $T_{spike}  0$。", "answer": "$$\\boxed{RC\\,\\ln\\!\\left(\\frac{V_{rest}+R I_{0}-V_{reset}}{V_{rest}+R I_{0}-V_{th}}\\right)}$$", "id": "1675499"}, {"introduction": "当输入电流接近引发脉冲所需的最小水平，即基电流（rheobase current）时，神经元的行为会发生巨大变化。这个问题 [@problem_id:1675495] 深入探讨了这个临界状态，揭示了脉冲间间隔在此阈值附近的行为。理解这种关系可以让你深入洞察从静息状态到活动状态的转变，这一概念源于分岔的数学理论。", "problem": "漏泄整合发放（LIF）模型是理解神经动力学的一个基本工具。它描述了神经元的膜电位 $V$ 如何随时间响应输入电流 $I$ 而演变。其动力学由以下微分方程决定：\n$$ \\tau_m \\frac{d V}{d t} = -(V - V_{rest}) + R_m I $$\n此处，$\\tau_m$ 是膜时间常数，$V_{rest}$ 是静息电位，$R_m$ 是膜电阻。所有这些都是正常数。\n\n每当神经元的膜电位 $V(t)$ 达到阈值 $V_{th}$ 时，它就会产生一个动作电位，即“发放”。发放后，电位立即被重置为一个值 $V_{reset}$。对于此模型，我们假设 $V_{rest}  V_{reset}  V_{th}$。连续两次发放之間的時間稱為峰间期，$T_{ISI}$。\n\n从时间 $t=0$ 开始，一个恒定的电流 $I$ 被施加到神经元上，此时神经元的电位处于重置值，$V(0) = V_{reset}$。基电流 $I_{rh}$ 定义为足以使神经元发放的最小恒定输入电流。\n\n考虑输入电流 $I$ 略大于基电流的情况。设 $\\Delta I = I - I_{rh}$，其中 $\\Delta I$ 是一个小的正量。求出在 $\\Delta I \\to 0$ 时有效的峰间期 $T_{ISI}$ 的近似解析表达式。你的表达式应能捕捉 $T_{ISI}$ 作为 $\\Delta I$ 和模型参数 $\\tau_m$、$V_{th}$、$V_{reset}$ 及 $R_m$ 的函数的主导阶行为。", "solution": "我们从具有恒定输入电流 $I$ 的漏泄整合发放动力学开始：\n$$\n\\tau_{m} \\frac{dV}{dt} = -(V - V_{rest}) + R_{m} I.\n$$\n对于恒定的 $I$，定义渐近（不动点）电位 $V_{\\infty} = V_{rest} + R_{m} I$。方程变为\n$$\n\\frac{dV}{dt} = -\\frac{1}{\\tau_{m}}(V - V_{\\infty}),\n$$\n其在初始条件 $V(0) = V_{reset}$ 下的解为\n$$\nV(t) = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{t}{\\tau_{m}}\\right).\n$$\n峰间期 $T_{ISI}$ 是使得 $V(T) = V_{th}$ 的第一个时间 $T$，这给出\n$$\nV_{th} = V_{\\infty} + \\bigl(V_{reset} - V_{\\infty}\\bigr)\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right).\n$$\n整理得，\n$$\n\\exp\\!\\left(-\\frac{T_{ISI}}{\\tau_{m}}\\right) = \\frac{V_{th} - V_{\\infty}}{V_{reset} - V_{\\infty}} = \\frac{V_{\\infty} - V_{th}}{V_{\\infty} - V_{reset}},\n$$\n所以\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{\\infty} - V_{reset}}{V_{\\infty} - V_{th}}\\right).\n$$\n\n基电流 $I_{rh}$ 由不动点达到阈值的条件定义：\n$$\nV_{rest} + R_{m} I_{rh} = V_{th} \\quad \\Rightarrow \\quad I_{rh} = \\frac{V_{th} - V_{rest}}{R_{m}}.\n$$\n对于 $I = I_{rh} + \\Delta I$ 且 $\\Delta I  0$ 很小的情况，不动点变为\n$$\nV_{\\infty} = V_{rest} + R_{m}(I_{rh} + \\Delta I) = V_{th} + R_{m}\\Delta I.\n$$\n代入 $T_{ISI}$ 的精确公式：\n$$\nT_{ISI} = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} + R_{m}\\Delta I - V_{reset}}{V_{th} + R_{m}\\Delta I - V_{th}}\\right) = \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset} + R_{m}\\Delta I}{R_{m}\\Delta I}\\right).\n$$\n对于 $\\Delta I \\to 0^{+}$，展开对数：\n$$\nT_{ISI} = \\tau_{m} \\left[ \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right) + \\ln\\!\\left(1 + \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}}\\right) \\right].\n$$\n由于 $\\ln(1+x) = x + O(x^{2})$ 且 $x = \\frac{R_{m}\\Delta I}{V_{th} - V_{reset}} \\to 0$，第二项是 $o\\!\\left(\\ln\\!\\left(\\frac{1}{\\Delta I}\\right)\\right)$，因此主导阶行为是\n$$\nT_{ISI} \\sim \\tau_{m} \\ln\\!\\left(\\frac{V_{th} - V_{reset}}{R_{m}\\Delta I}\\right), \\quad \\text{as } \\Delta I \\to 0^{+}.\n$$\n这捕捉了在基电流附近峰间期的对数发散，并用 $\\tau_{m}$、$V_{th}$、$V_{reset}$、$R_{m}$ 和 $\\Delta I$ 来表示。", "answer": "$$\\boxed{\\tau_{m}\\,\\ln\\!\\left(\\frac{V_{th}-V_{reset}}{R_{m}\\,\\Delta I}\\right)}$$", "id": "1675495"}, {"introduction": "为什么大多数神经元模型都包含一个“泄漏”项？这个实践问题 [@problem_id:1675540] 通过将漏放电（LIF）模型与一个更简单的、缺少泄漏项的“完美积分器”进行直接比较来回答这个问题。通过计算每个模型达到相同放电频率所需的电流，你将揭示泄漏电流在塑造神经元输入-输出特性方面的基本计算作用。", "problem": "通常使用两种简化模型来描述神经元对恒定输入电流的响应：完美积分器 (Perfect Integrator, PI) 模型和漏电积分放电 (Leaky Integrate-and-Fire, LIF) 模型。在这两种模型中，神经元的膜电位 $V(t)$ 随时间演化。每当 $V(t)$ 达到阈值电压 $V_{th}$ 时，就会产生一个尖峰脉冲，此时电位会瞬时重置为一个值 $V_{reset}$，其中 $V_{reset}  V_{th}$。放电速率 $f$ 是单位时间内产生的尖峰脉冲数量，即脉冲间期的倒数。\n\n1.  **完美积分器 (PI) 模型：** 膜电位的动力学由以下方程描述：\n    $$C \\frac{dV}{dt} = I_{in}$$\n    其中 $C$ 是膜电容，$I_{in}$ 是一个恒定的输入电流。为使该模型放电，$I_{in}$ 必须为正。\n\n2.  **漏电积分放电 (LIF) 模型：** 该模型在动力学中增加了一个漏电项：\n    $$\\tau_m \\frac{dV}{dt} = -(V - E_L) + R I_{in}$$\n    其中 $\\tau_m = RC$ 是膜时间常数，$R$ 是膜电阻，$E_L$ 是漏电反转电位。为使该模型放电，输入电流必须足够大，以使稳态电位超过阈值，即 $E_L + R I_{in}  V_{th}$。\n\n在本题中，假设对于两种模型，电位都重置为相同的值 $V_{reset}$。此外，对于 LIF 模型，将漏电反转电位设置为等于重置电位，即 $E_L = V_{reset}$。\n\n假设我们希望两种模型以完全相同的非零放电速率 $f$ 放电。设 $I_{PI}$ 是在 PI 模型中达到此速率所需的电流，$I_{LIF}$ 是 LIF 模型所需的电流。\n\n请找出一个关于比值 $\\frac{I_{LIF}}{I_{PI}}$ 的符号表达式，用放电速率 $f$ 和膜时间常数 $\\tau_m$ 来表示。", "solution": "该问题要求计算漏电积分放电 (LIF) 模型和完美积分器 (PI) 模型以相同放电速率 $f$ 放电时，所需输入电流的比值 $\\frac{I_{LIF}}{I_{PI}}$。为了求得此比值，我们必须首先推导每种模型中输入电流与放电速率之间的关系。放电速率 $f$ 是脉冲间期 $T$ 的倒数，即 $f = 1/T$。脉冲间期是膜电位 $V(t)$ 从 $V_{reset}$ 上升到 $V_{th}$ 所需的时间。\n\n首先，我们来分析完美积分器 (PI) 模型。其控制方程为：\n$C \\frac{dV}{dt} = I_{PI}$\n为了求解放电所需时间 $T$，我们分离变量并在一个脉冲间期内积分。在时间 $t=0$ 时，电位为 $V(0) = V_{reset}$，在时间 $t=T$ 时，电位达到阈值 $V(T) = V_{th}$。\n$$C \\int_{V_{reset}}^{V_{th}} dV = \\int_{0}^{T} I_{PI} dt$$\n$$C [V]_{V_{reset}}^{V_{th}} = I_{PI} [t]_{0}^{T}$$\n$$C (V_{th} - V_{reset}) = I_{PI} T$$\n放电速率为 $f = 1/T$。代入 $T=1/f$ 得：\n$$C (V_{th} - V_{reset}) = \\frac{I_{PI}}{f}$$\n求解输入电流 $I_{PI}$ 作为放电速率 $f$ 的函数：\n$$I_{PI} = f C (V_{th} - V_{reset})$$\n\n接下来，我们分析漏电积分放电 (LIF) 模型。其控制方程为：\n$$\\tau_m \\frac{dV}{dt} = -(V - E_L) + R I_{LIF}$$\n题目规定 $E_L = V_{reset}$，因此我们将其代入方程：\n$$\\tau_m \\frac{dV}{dt} = -(V - V_{reset}) + R I_{LIF}$$\n这是一个一阶线性常微分方程。我们可以通过分离变量法求解。让我们重新整理方程，将含 $V$ 的项组合在一起：\n$$\\tau_m \\frac{dV}{dt} = (V_{reset} + R I_{LIF}) - V$$\n$$\\frac{dV}{(V_{reset} + R I_{LIF}) - V} = \\frac{dt}{\\tau_m}$$\n现在，我们对两边进行积分。当时间 $t$ 从 $0$ 变为 $T$ 时，电位 $V$ 从 $V_{reset}$ 变为 $V_{th}$。\n$$\\int_{V_{reset}}^{V_{th}} \\frac{dV}{(V_{reset} + R I_{LIF}) - V} = \\int_{0}^{T} \\frac{dt}{\\tau_m}$$\n左边的积分形式为 $\\int \\frac{dx}{a-x} = -\\ln|a-x|$。\n$$[-\\ln((V_{reset} + R I_{LIF}) - V)]_{V_{reset}}^{V_{th}} = \\frac{T}{\\tau_m}$$\n$$-\\ln((V_{reset} + R I_{LIF}) - V_{th}) + \\ln((V_{reset} + R I_{LIF}) - V_{reset}) = \\frac{T}{\\tau_m}$$\n$$\\ln\\left(\\frac{(V_{reset} + R I_{LIF}) - V_{reset}}{(V_{reset} + R I_{LIF}) - V_{th}}\\right) = \\frac{T}{\\tau_m}$$\n$$\\ln\\left(\\frac{R I_{LIF}}{R I_{LIF} - (V_{th} - V_{reset})}\\right) = \\frac{T}{\\tau_m}$$\n因为 $f = 1/T$，所以 $T = 1/f$。\n$$\\frac{1}{f \\tau_m} = \\ln\\left(\\frac{R I_{LIF}}{R I_{LIF} - (V_{th} - V_{reset})}\\right)$$\n现在我们必须求解 $I_{LIF}$。对两边取指数得：\n$$\\exp\\left(\\frac{1}{f \\tau_m}\\right) = \\frac{R I_{LIF}}{R I_{LIF} - (V_{th} - V_{reset})}$$\n为简化起见，令 $\\Delta V = V_{th} - V_{reset}$。\n$$\\exp\\left(\\frac{1}{f \\tau_m}\\right) (R I_{LIF} - \\Delta V) = R I_{LIF}$$\n$$R I_{LIF} \\exp\\left(\\frac{1}{f \\tau_m}\\right) - \\Delta V \\exp\\left(\\frac{1}{f \\tau_m}\\right) = R I_{LIF}$$\n$$R I_{LIF} \\left(\\exp\\left(\\frac{1}{f \\tau_m}\\right) - 1\\right) = \\Delta V \\exp\\left(\\frac{1}{f \\tau_m}\\right)$$\n$$I_{LIF} = \\frac{\\Delta V \\exp\\left(\\frac{1}{f \\tau_m}\\right)}{R \\left(\\exp\\left(\\frac{1}{f \\tau_m}\\right) - 1\\right)}$$\n我们可以通过分子和分母同乘以 $\\exp\\left(-\\frac{1}{f \\tau_m}\\right)$ 来简化此式：\n$$I_{LIF} = \\frac{\\Delta V}{R \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)} = \\frac{V_{th} - V_{reset}}{R \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)}$$\n\n最后，我们计算比值 $\\frac{I_{LIF}}{I_{PI}}$。\n$$\\frac{I_{LIF}}{I_{PI}} = \\frac{\\frac{V_{th} - V_{reset}}{R \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)}}{f C (V_{th} - V_{reset})}$$\n项 $(V_{th} - V_{reset})$ 被消去。\n$$\\frac{I_{LIF}}{I_{PI}} = \\frac{1}{f C R \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)}$$\n回顾膜时间常数的定义 $\\tau_m = RC$，我们将其代入分母。\n$$\\frac{I_{LIF}}{I_{PI}} = \\frac{1}{f \\tau_m \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)}$$\n这就是用 $f$ 和 $\\tau_m$ 表示该比值的最终表达式。", "answer": "$$\\boxed{\\frac{1}{f \\tau_m \\left(1 - \\exp\\left(-\\frac{1}{f \\tau_m}\\right)\\right)}}$$", "id": "1675540"}]}