{"hands_on_practices": [{"introduction": "单摆的相图清晰地划分了两种截然不同的运动类型：有界的振荡（摆动）和连续的旋转（转动）。划分这些行为的关键边界被称为分界线（separatrix）。这项练习 [@problem_id:1698758] 要求你应用能量守恒原理，确定使摆恰好沿这条关键轨迹运动所需的精确初始条件，从而让你亲手理解定义系统动力学的能量景观。", "problem": "一个单摆由一个质量为 $m$ 的质点和一个长度为 $L$ 的无质量刚性杆组成。该单摆在场强为 $g$ 的匀强重力场作用下，可在竖直平面内自由摆动。设摆相对于其稳定平衡位置（竖直向下悬挂）的角位移用 $\\theta$ 表示。\n\n单摆的运动可分为两种类型：往返摆动（围绕 $\\theta=0$ 的振动）和旋转（单向连续运动）。在由坐标 $(\\theta, \\dot{\\theta})$ 定义的系统相空间中，这两种运动被一条称为分界线（separatrix）的特殊轨道分隔。该分界线对应的运动是，摆恰好有足够的能量到达不稳定平衡点（竖直向上）并瞬间静止。\n\n确定在摆的最低点（$\\theta=0$）必须施加给它的正初始角速度 $\\dot{\\theta}_{c}$，以使其恰好处于这条分界线上。请用 $L$ 和 $g$ 的符号表达式表示你的答案。", "solution": "问题要求解将摆置于分界线上的临界初始角速度 $\\dot{\\theta}_c$。这可以通过应用机械能守恒原理来解决。摆的总机械能 $E$ 是其动能 $K$ 和势能 $U$ 的和，并且该总能量在整个运动过程中保持不变。\n\n首先，我们定义动能和势能的表达式。我们将摆动最低点（$\\theta=0$）处的重力势能设为零。在任意角度 $\\theta$ 处，质量为 $m$ 的质点相对于此参考点的高度为 $h = L - L\\cos(\\theta) = L(1 - \\cos(\\theta))$。\n因此，势能为：\n$$U = mgh = mgL(1 - \\cos(\\theta))$$\n\n质点的切向速度为 $v = L\\dot{\\theta}$，其中 $\\dot{\\theta}$ 是角速度。动能为：\n$$K = \\frac{1}{2}mv^2 = \\frac{1}{2}m(L\\dot{\\theta})^2 = \\frac{1}{2}mL^2\\dot{\\theta}^2$$\n\n总机械能 $E$ 由下式给出：\n$$E = K + U = \\frac{1}{2}mL^2\\dot{\\theta}^2 + mgL(1 - \\cos(\\theta))$$\n\n接下来，我们计算问题中描述的两种特定状态下的能量。\n\n初始状态（状态1）是摆在其最低点，$\\theta_1 = 0$，此时它被赋予临界初始角速度 $\\dot{\\theta}_1 = \\dot{\\theta}_c$。此状态下的能量为：\n$$E_1 = \\frac{1}{2}mL^2\\dot{\\theta}_c^2 + mgL(1 - \\cos(0))$$\n由于 $\\cos(0) = 1$，势能项为零：\n$$E_1 = \\frac{1}{2}mL^2\\dot{\\theta}_c^2$$\n\n分界线轨道被定义为摆恰好到达不稳定平衡点（竖直向上）并瞬间停止的轨道。这个最终状态（状态2）的特征是角度 $\\theta_2 = \\pi$，角速度 $\\dot{\\theta}_2 = 0$。此状态下的能量为：\n$$E_2 = \\frac{1}{2}mL^2(0)^2 + mgL(1 - \\cos(\\pi))$$\n由于 $\\cos(\\pi) = -1$，能量为：\n$$E_2 = mgL(1 - (-1)) = 2mgL$$\n\n根据能量守恒原理，初始状态的能量必须等于最终状态的能量，因此 $E_1 = E_2$。\n$$\\frac{1}{2}mL^2\\dot{\\theta}_c^2 = 2mgL$$\n\n现在，我们求解临界角速度 $\\dot{\\theta}_c$。质量 $m$ 从等式两边消去：\n$$\\frac{1}{2}L^2\\dot{\\theta}_c^2 = 2gL$$\n我们可以将等式两边同时除以 $L$（因为 $L \\neq 0$）：\n$$\\frac{1}{2}L\\dot{\\theta}_c^2 = 2g$$\n重新整理以求解 $\\dot{\\theta}_c^2$：\n$$\\dot{\\theta}_c^2 = \\frac{4g}{L}$$\n对等式两边取平方根，得到临界角速度的大小。因为问题要求的是正的初始角速度，我们取正根：\n$$\\dot{\\theta}_c = \\sqrt{\\frac{4g}{L}} = 2\\sqrt{\\frac{g}{L}}$$\n这就是将摆置于分界线上所需的初始角速度。", "answer": "$$\\boxed{2\\sqrt{\\frac{g}{L}}}$$", "id": "1698758"}, {"introduction": "对物理模型的真正理解，往往来自于探索其在假设改变时的行为。这个思想实验 [@problem_id:1698764] 邀请你思考一个存在排斥引力的假想宇宙，这实际上是将单摆的势能景观彻底颠倒。通过分析这个新场景中平衡点的稳定性，你将更深刻地洞察系统势能与其相图定性结构之间的根本联系。", "problem": "考虑一个假设的单摆，其长度为 $L$，质量为 $m$。在一个奇特的宇宙中，引力在摆动的最低点处是排斥性的。该单摆的动力学由以下二阶常微分方程描述：\n$$ \\frac{d^2\\theta}{dt^2} = \\omega_0^2 \\sin\\theta $$\n其中 $\\theta$ 是摆锤与垂直向下的夹角，而 $\\omega_0 = \\sqrt{g/L}$ 是一个与排斥加速度 $g$ 的大小相关的正常数。我们可以在相平面中用坐标 $(x, y) = (\\theta, \\frac{d\\theta}{dt})$ 来模拟这个系统。\n\n系统的平衡点是相平面中系统的状态不随时间改变的点。对于此系统，在区间 $-\\pi  \\theta \\le \\pi$ 内的两个这样的点是 $(\\theta, \\frac{d\\theta}{dt}) = (0, 0)$ 和 $(\\theta, \\frac{d\\theta}{dt}) = (\\pi, 0)$。\n\n判断这两个平衡点的性质。\n\nA. 点 $(0, 0)$ 是一个鞍点，点 $(\\pi, 0)$ 是一个中心点。\n\nB. 点 $(0, 0)$ 是一个中心点，点 $(\\pi, 0)$ 是一个鞍点。\n\nC. 点 $(0, 0)$ 和 $(\\pi, 0)$ 都是鞍点。\n\nD. 点 $(0, 0)$ 和 $(\\pi, 0)$ 都是中心点。\n\nE. 点 $(0, 0)$ 是一个不稳定螺线点，点 $(\\pi, 0)$ 是一个稳定螺线点。", "solution": "我们将二阶方程写成一阶平面系统，令 $x=\\theta$ 和 $y=\\dot{\\theta}$：\n$$\n\\dot{x}=y,\\qquad \\dot{y}=\\omega_{0}^{2}\\sin x.\n$$\n平衡点满足 $y=0$ 和 $\\sin x=0$，即 $x=k\\pi$。在 $-\\pi  \\theta\\leq \\pi$ 内，列出的两个平衡点是 $(0,0)$ 和 $(\\pi,0)$。\n\n为了确定它们的性质，通过雅可比矩阵进行线性化\n$$\nJ(x,y)=\\begin{pmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y} \\\\\n\\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  1 \\\\\n\\omega_{0}^{2}\\cos x  0\n\\end{pmatrix}.\n$$\n在 $(0,0)$ 处，$\\cos 0=1$，所以\n$$\nJ(0,0)=\\begin{pmatrix}0  1\\\\ \\omega_{0}^{2}  0\\end{pmatrix},\\quad \\text{其特征方程为 } \\lambda^{2}-\\omega_{0}^{2}=0,\n$$\n得到特征值 $\\lambda=\\pm \\omega_{0}$（异号实数）。因此 $(0,0)$ 是一个鞍点。\n\n在 $(\\pi,0)$ 处，$\\cos \\pi=-1$，所以\n$$\nJ(\\pi,0)=\\begin{pmatrix}0  1\\\\ -\\omega_{0}^{2}  0\\end{pmatrix},\\quad \\text{其特征方程为 } \\lambda^{2}+\\omega_{0}^{2}=0,\n$$\n得到特征值 $\\lambda=\\pm i\\omega_{0}$（纯虚数）。为了在非线性系统中区分中心点和螺线点，我们使用能量守恒（哈密顿）结构。定义\n$$\nH(x,y)=\\frac{1}{2}y^{2}+\\omega_{0}^{2}\\cos x.\n$$\n则\n$$\n\\frac{dH}{dt}=y\\,\\dot{y}+\\omega_{0}^{2}(-\\sin x)\\,\\dot{x}\n=y\\left(\\omega_{0}^{2}\\sin x\\right)+\\omega_{0}^{2}(-\\sin x)y=0,\n$$\n所以 $H$ 是守恒的，轨迹不能是螺旋线。势能部分为 $U(x)=\\omega_{0}^{2}\\cos x$，有\n$$\nU''(x)=-\\omega_{0}^{2}\\cos x.\n$$\n在 $x=0$ 处，$U''(0) = -\\omega_0^2  0$（一个局部极大值），意味着一个鞍点。在 $x=\\pi$ 处，$U''(\\pi) = \\omega_0^2 > 0$（一个局部极小值），意味着一个中心点，其周围是闭合轨道。因此，$(0,0)$ 是一个鞍点，$(\\pi,0)$ 是一个中心点。", "answer": "$$\\boxed{A}$$", "id": "1698764"}, {"introduction": "小角度近似是物理学的一块基石，但了解其局限性与应用同样重要。这个计算练习 [@problem_id:2444848] 超越了纸笔分析，让你能够定量地衡量真实非线性摆与其线性化模型之间的差异。通过计算它们在不同条件下的相空间轨迹差异，你将对这个至关重要的近似何时成立、何时失效，建立起一种实用且直观的感觉。", "problem": "刚性单摆的无量纲运动方程为 $ \\ddot{\\theta} + \\sin(\\theta) = 0 $，可以将其与其小角度线性近似 $ \\ddot{\\theta} + \\theta = 0 $ 进行比较。每个二阶常微分方程 (ODE) 都必须通过引入角速度 $ \\omega = \\dot{\\theta} $ 来重新表述为一个耦合的一阶 ODE 系统。对于非线性摆，这得到 $ \\dot{\\theta} = \\omega $ 和 $ \\dot{\\omega} = -\\sin(\\theta) $；对于线性模型，这得到 $ \\dot{\\theta} = \\omega $ 和 $ \\dot{\\omega} = -\\theta $。角度以弧度为单位，时间以方程中使用的相同无量纲单位表示。\n\n将一个系统的相图定义为状态空间 $ (\\theta,\\omega) $ 中轨迹的集合。为了量化在给定初始条件 $ (\\theta(0), \\omega(0)) = (\\theta_0, \\omega_0) $ 下两个相图之间的差异，定义在有限时间范围 $ [0, T] $ 内相应轨迹之间的时间平均距离为\n$$\nD(\\theta_0,\\omega_0;T) = \\frac{1}{T} \\int_0^T \\sqrt{ \\Delta\\theta(t)^2 + \\Delta\\omega(t)^2 } \\, dt,\n$$\n其中 $ \\Delta\\theta(t) $ 是圆上的主值角差，\n$$\n\\Delta\\theta(t) = \\mathrm{wrap}_{[-\\pi,\\pi)}\\!\\left(\\theta_{\\text{nl}}(t) - \\theta_{\\text{lin}}(t)\\right),\n$$\n且 $ \\Delta\\omega(t) = \\omega_{\\text{nl}}(t) - \\omega_{\\text{lin}}(t) $，其中下标“nl”和“lin”分别表示非线性系统和线性系统。包裹算子 $ \\mathrm{wrap}_{[-\\pi,\\pi)}(\\cdot) $ 返回区间 $ [-\\pi,\\pi) $ 内与其参数模 $ 2\\pi $ 同余的唯一代表值。本问题中所有量均为无量纲；角度必须以弧度为单位。\n\n使用上述定义，为以下每个测试用例计算 $ D(\\theta_0,\\omega_0;T) $，所有用例的共同时间范围均为 $ T = 20 $：\n- 情况 $ 1 $ (边界平衡点)：$ \\theta_0 = 0 $，$ \\omega_0 = 0 $。\n- 情况 $ 2 $ (小角度振荡)：$ \\theta_0 = 0.1 $，$ \\omega_0 = 0 $。\n- 情况 $ 3 $ (中等角度振荡)：$ \\theta_0 = 1.0 $，$ \\omega_0 = 0 $。\n- 情况 $ 4 $ (非线性摆的旋转状态)：$ \\theta_0 = 0.0 $，$ \\omega_0 = 2.5 $。\n- 情况 $ 5 $ (接近分界线)：$ \\theta_0 = \\pi - 10^{-3} $，$ \\omega_0 = 0 $。\n\n你的程序必须：\n- 按上文规定，将两个模型都重新表述为耦合的一阶 ODE 系统。\n- 对于每个测试用例，使用相同的初始条件 $ (\\theta_0,\\omega_0) $ 将两个系统从 $ t = 0 $ 演化到 $ t = T $，并严格按照定义计算 $ D(\\theta_0,\\omega_0;T) $。\n- 角度必须以弧度处理，并且 $ \\Delta\\theta(t) $ 必须使用上文定义的在圆 $ [-\\pi,\\pi) $ 上的主值包裹。\n\n最终输出格式：\n- 生成单行输出，包含五个结果 $ [D_1,D_2,D_3,D_4,D_5] $，形式为方括号内以逗号分隔的列表，其中 $ D_k $ 对应于情况 $ k $。\n- 每个 $ D_k $ 必须四舍五入到恰好 $ 6 $ 位小数。", "solution": "所述问题在科学上是合理的、无歧义且适定的。它提出了一个计算物理学中的标准练习：比较一个非线性动力系统与其线性近似。此类近似的有效性是物理学和工程学的基石，而量化误差则是一项实践上的必要工作。我们将继续进行求解。\n\n任务是计算一个度量 $D(\\theta_0, \\omega_0; T)$，它量化了非线性摆及其线性近似的轨迹在相空间中的时间平均距离。这需要三个不同的步骤：首先，将运动方程表述为一阶常微分方程 (ODE) 组；其次，对这些系统进行数值积分，以找到给定初始条件下的轨迹；第三，通过数值求积计算定义的距离度量。\n\n任一系统在时间 $t$ 的状态由状态向量 $y(t) = [\\theta(t), \\omega(t)]^T$ 描述，其中 $\\theta$ 是角位置，$\\omega = \\dot{\\theta}$ 是角速度。\n\n非线性单摆由二阶 ODE $\\ddot{\\theta} + \\sin(\\theta) = 0$ 控制。通过设置 $y_1 = \\theta$ 和 $y_2 = \\omega = \\dot{\\theta}$，我们得到以下一阶 ODE 系统：\n$$\n\\frac{d}{dt} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ -\\sin(y_1) \\end{pmatrix}\n$$\n\n线性（或小角度）近似由 $\\ddot{\\theta} + \\theta = 0$ 控制。这得到了相应的线性系统：\n$$\n\\frac{d}{dt} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ -y_1 \\end{pmatrix}\n$$\n\n对于每个测试用例，两个系统都必须在时间区间 $[0, T]$ (其中 $T=20$) 上针对相同的初始条件 $y(0) = y_0 = [\\theta_0, \\omega_0]^T$ 进行求解。虽然线性系统存在简单的解析解，但为了控制和匹配误差源，对两者采用一致的数值方法是更可取的。我们采用一个高保真度的数值积分器，具体是 `scipy.integrate.solve_ivp` 函数中实现的自适应 Runge-Kutta 方法。为确保精度，我们将相对和绝对误差容限分别设置为较小的值 $10^{-9}$ 和 $10^{-12}$。解，记为 $(\\theta_{\\text{nl}}(t), \\omega_{\\text{nl}}(t))$ 和 $(\\theta_{\\text{lin}}(t), \\omega_{\\text{lin}}(t))$，会在跨越 $[0, 20]$ 的一个密集时间点网格上进行评估，以便于最后的积分步骤。\n\n问题的核心是距离度量的计算：\n$$\nD(\\theta_0,\\omega_0;T) = \\frac{1}{T} \\int_0^T \\sqrt{ \\Delta\\theta(t)^2 + \\Delta\\omega(t)^2 } \\, dt\n$$\n此处，$\\Delta\\omega(t) = \\omega_{\\text{nl}}(t) - \\omega_{\\text{lin}}(t)$ 是角速度的标准差。角差 $\\Delta\\theta(t)$ 需要特别注意。由于角度 $\\theta$ 是圆 $S^1$ 上的一个坐标，其差值必须是该圆上的最短路径。这通过包裹操作 $\\Delta\\theta(t) = \\mathrm{wrap}_{[-\\pi,\\pi)}(\\theta_{\\text{nl}}(t) - \\theta_{\\text{lin}}(t))$ 来实现。该函数将任意角度映射到区间 $[-\\pi, \\pi)$ 内其唯一的同余值。这对于一个或两个摆可能完成整周旋转的情况（如情况 4）至关重要。\n\n有了 $\\theta_{\\text{nl}}(t_i)$、$\\omega_{\\text{nl}}(t_i)$、$\\theta_{\\text{lin}}(t_i)$ 和 $\\omega_{\\text{lin}}(t_i)$ 的离散时间序列，我们首先计算网格中每个时间点 $t_i$ 的被积函数 $d(t_i) = \\sqrt{\\Delta\\theta(t_i)^2 + \\Delta\\omega(t_i)^2}$。然后使用梯形法则来近似积分 $\\int_0^T d(t) dt$，鉴于评估网格的密度，该方法足够精确。将该积分除以时间范围 $T=20$，即可得到 $D$ 的最终结果。\n\n此过程应用于 5 个指定的测试用例中的每一个：\n- 情况 1：$(\\theta_0, \\omega_0) = (0, 0)$。这是两个系统的稳定平衡点。状态不发生演化，因此轨迹完全相同（一个单点）。解析上，$D=0$。\n- 情况 2：$(\\theta_0, \\omega_0) = (0.1, 0)$。对于这个小振幅，线性近似非常好。轨迹将非常接近，从而得到一个虽小但非零的 $D$ 值。\n- 情况 3：$(\\theta_0, \\omega_0) = (1.0, 0)$。在这个中等振幅下，近似 $\\sin(\\theta) \\approx \\theta$ 变得不那么准确，主要表现为周期差异。非线性摆的周期更长，导致轨迹发生相位差，从而产生一个较大的 $D$。\n- 情况 4：$(\\theta_0, \\omega_0) = (0, 2.5)$。初始速度足够大 ($\\omega_0 > 2$)，足以使非线性摆进入旋转状态，而线性模型始终振荡。这种运动上的质的差异导致轨迹之间产生显著且持续的距离，从而得到一个大的 $D$。\n- 情况 5：$(\\theta_0, \\omega_0) = (\\pi - 10^{-3}, 0)$。非线性摆从其不稳定平衡点附近开始，并会在摆动前表现出特有的长时间停顿。而没有这种不稳定点的线性模型将立即开始大幅度振荡。所产生的运动截然不同，从而得到一个大的 $D$。\n\n提供的 Python 脚本实现了从 ODE 积分到最终格式化输出的整套逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, trapezoid\n\n# The final answer must be a single, complete, standalone program.\n# This program computes the time-averaged phase-space distance between\n# a nonlinear pendulum and its linear approximation for several initial conditions.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the result.\n    \"\"\"\n\n    def nonlinear_pendulum(t, y):\n        \"\"\"ODE system for the nonlinear pendulum.\"\"\"\n        theta, omega = y\n        return [omega, -np.sin(theta)]\n\n    def linear_pendulum(t, y):\n        \"\"\"ODE system for the linear pendulum.\"\"\"\n        theta, omega = y\n        return [omega, -theta]\n\n    def wrap_angle(angle_diff):\n        \"\"\"Wraps the angle difference to the interval [-pi, pi).\"\"\"\n        return (angle_diff + np.pi) % (2 * np.pi) - np.pi\n\n    # Define problem parameters and test cases\n    T = 20.0\n    test_cases = [\n        (0.0, 0.0),                  # Case 1: boundary equilibrium\n        (0.1, 0.0),                  # Case 2: small-angle oscillation\n        (1.0, 0.0),                  # Case 3: moderate-angle oscillation\n        (0.0, 2.5),                  # Case 4: rotational regime\n        (np.pi - 1e-3, 0.0)          # Case 5: near separatrix\n    ]\n\n    results = []\n\n    # Time points for ODE solution evaluation and subsequent integration\n    t_span = (0, T)\n    # A dense grid is used for accurate numerical quadrature of the distance function.\n    num_points = 5000\n    t_eval = np.linspace(t_span[0], t_span[1], num_points)\n\n    for y0_tuple in test_cases:\n        y0 = np.array(y0_tuple)\n\n        # Handle the trivial equilibrium case analytically.\n        if np.all(y0 == 0):\n            results.append(0.0)\n            continue\n\n        # Set stringent tolerances for the ODE solver for high accuracy.\n        rtol = 1e-9\n        atol = 1e-12\n\n        # Solve for the nonlinear pendulum's trajectory\n        sol_nl = solve_ivp(\n            nonlinear_pendulum, t_span, y0, t_eval=t_eval, rtol=rtol, atol=atol\n        )\n        theta_nl, omega_nl = sol_nl.y\n\n        # Solve for the linear pendulum's trajectory\n        sol_lin = solve_ivp(\n            linear_pendulum, t_span, y0, t_eval=t_eval, rtol=rtol, atol=atol\n        )\n        theta_lin, omega_lin = sol_lin.y\n\n        # Calculate the differences between trajectories\n        # Angular difference must be wrapped to the circle.\n        delta_theta = wrap_angle(theta_nl - theta_lin)\n        delta_omega = omega_nl - omega_lin\n\n        # The integrand is the Euclidean distance in the phase plane at each time step.\n        integrand = np.sqrt(delta_theta**2 + delta_omega**2)\n\n        # Numerically integrate the distance over the time horizon using the trapezoidal rule.\n        integral_val = trapezoid(integrand, t_eval)\n\n        # Compute the time-averaged distance D.\n        D = integral_val / T\n        results.append(D)\n\n    # Format the results to 6 decimal places and print in the specified format.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2444848"}]}