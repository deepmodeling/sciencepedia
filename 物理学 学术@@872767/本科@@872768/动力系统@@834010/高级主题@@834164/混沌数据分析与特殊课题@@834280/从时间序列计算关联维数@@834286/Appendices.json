{"hands_on_practices": [{"introduction": "计算相关维度的第一步是理解其基础——相关和 $C(r)$。这个练习将抽象的公式具体化，通过一个小型、明确的数据集，引导您手动计算相关和。通过亲自实践“数对”的过程，您将对 Grassberger-Procaccia 算法的核心机制建立起坚实的直观理解 [@problem_id:1665706]。", "problem": "在混沌系统的分析中，关联维数是奇异吸引子分形维数的一种度量。其计算中的一个关键步骤是计算给定半径 $r$ 下的关联和 $C(r)$。关联和定义为状态空间向量对中，其距离小于或等于 $r$ 的向量对所占的比例。\n\n考虑一个由 $N=5$ 个二维重构状态空间向量组成的集合 $\\{\\vec{x}_i\\}_{i=1}^5$：\n$\\vec{x}_1 = (1.0, 2.0)$\n$\\vec{x}_2 = (3.0, 3.0)$\n$\\vec{x}_3 = (5.0, 1.0)$\n$\\vec{x}_4 = (1.5, 4.0)$\n$\\vec{x}_5 = (4.0, 1.5)$\n\n关联和由以下公式给出：\n$$C(r) = \\frac{1}{\\binom{N}{2}} \\sum_{1 \\le i  j \\le N} \\Theta(r - d(\\vec{x}_i, \\vec{x}_j))$$\n其中 $\\binom{N}{2}$ 是不同向量对的总数，而 $\\Theta(u)$ 是赫维赛德阶跃函数，定义为：当 $u \\ge 0$ 时 $\\Theta(u) = 1$，当 $u  0$ 时 $\\Theta(u) = 0$。两个向量 $\\vec{x}_i = (x_{i1}, x_{i2})$ 和 $\\vec{x}_j = (x_{j1}, x_{j2})$ 之间的距离 $d(\\vec{x}_i, \\vec{x}_j)$ 使用最大范数（或切比雪夫距离）计算：\n$$d(\\vec{x}_i, \\vec{x}_j) = \\max(|x_{i1} - x_{j1}|, |x_{i2} - x_{j2}|)$$\n\n计算当半径 $r=2.1$ 时关联和 $C(r)$ 的值。将你的答案表示为最简精确分数。", "solution": "半径为 $r$ 的关联和定义为\n$$\nC(r)=\\frac{1}{\\binom{N}{2}}\\sum_{1\\leq i  j\\leq N}\\Theta\\!\\big(r-d(\\vec{x}_{i},\\vec{x}_{j})\\big),\n$$\n其中 $d(\\vec{x}_{i},\\vec{x}_{j})=\\max\\!\\big(|x_{i1}-x_{j1}|,\\;|x_{i2}-x_{j2}|\\big)$ 且当 $u\\geq 0$ 时 $\\Theta(u)=1$，否则为 $0$。当 $N=5$ 时，我们有 $\\binom{5}{2}=10$。对于 $r=2.1$，计算这 $10$ 个不同向量对中的每一个：\n\n1. 对 $(1,2)$: $d=\\max(|1-3|,|2-3|)=\\max(2,1)=2\\leq 2.1\\Rightarrow \\Theta=1$。\n2. 对 $(1,3)$: $d=\\max(|1-5|,|2-1|)=\\max(4,1)=42.1\\Rightarrow \\Theta=0$。\n3. 对 $(1,4)$: $d=\\max(|1-1.5|,|2-4|)=\\max(0.5,2)=2\\leq 2.1\\Rightarrow \\Theta=1$。\n4. 对 $(1,5)$: $d=\\max(|1-4|,|2-1.5|)=\\max(3,0.5)=32.1\\Rightarrow \\Theta=0$。\n5. 对 $(2,3)$: $d=\\max(|3-5|,|3-1|)=\\max(2,2)=2\\leq 2.1\\Rightarrow \\Theta=1$。\n6. 对 $(2,4)$: $d=\\max(|3-1.5|,|3-4|)=\\max(1.5,1)=1.5\\leq 2.1\\Rightarrow \\Theta=1$。\n7. 对 $(2,5)$: $d=\\max(|3-4|,|3-1.5|)=\\max(1,1.5)=1.5\\leq 2.1\\Rightarrow \\Theta=1$。\n8. 对 $(3,4)$: $d=\\max(|5-1.5|,|1-4|)=\\max(3.5,3)=3.52.1\\Rightarrow \\Theta=0$。\n9. 对 $(3,5)$: $d=\\max(|5-4|,|1-1.5|)=\\max(1,0.5)=1\\leq 2.1\\Rightarrow \\Theta=1$。\n10. 对 $(4,5)$: $d=\\max(|1.5-4|,|4-1.5|)=\\max(2.5,2.5)=2.52.1\\Rightarrow \\Theta=0$。\n\n共有 $6$ 对向量的距离 $d\\leq r$。因此，\n$$\nC(2.1)=\\frac{6}{10}=\\frac{3}{5}.\n$$", "answer": "$$\\boxed{\\frac{3}{5}}$$", "id": "1665706"}, {"introduction": "在根据相关和 $C(r)$ 计算相关维度时，我们通常依赖于 $\\log(C(r))$ 与 $\\log(r)$ 的对数-对数图。然而，真实世界的实验数据并非完美，理解测量工具的局限性至关重要。这个练习探讨了一个常见问题：数据量化（即有限的仪器分辨率）如何在小尺度上影响该图，帮助您区分真实的标度行为和测量伪影 [@problem_id:1665729]。", "problem": "一名本科生正在分析一个实验时间序列 $\\{x_n\\}$，该序列据信源于一个混沌系统。数据是使用具有有限分辨率的数字仪器记录的。这种量化意味着任何测量值 $x_n$ 都是基本分辨率步长 $\\delta  0$ 的整数倍。\n\n为了表征系统的动力学特性，该学生采用时间延迟嵌入法在 $m$ 维相空间（其中 $m  1$）中重构吸引子。重构的状态向量形式为 $\\vec{V}_i = (x_i, x_{i+\\tau}, \\dots, x_{i+(m-1)\\tau})$，其中 $\\tau$ 是选定的时间延迟。\n\n接下来，该学生使用 Grassberger-Procaccia 算法计算相关积分 $C(r)$。$C(r)$ 定义为重构向量对 $(\\vec{V}_i, \\vec{V}_j)$（其中 $i \\neq j$）中欧几里得距离小于给定半径 $r$ 的对数所占的比例：\n$$\nC(r) = \\frac{2}{N(N-1)} \\sum_{i=1}^{N-1} \\sum_{j=i+1}^{N} \\Theta(r - \\|\\vec{V}_i - \\vec{V}_j\\|)\n$$\n其中 $N$ 是向量总数，$\\Theta$ 是赫维赛德阶跃函数。然后，通过 $C(r)$ 对 $r$ 的对数-对数图中的线性标度区的斜率来估计相关维数 $D_2$。\n\n在生成 $\\log(C(r))$ 对 $\\log(r)$ 的图时，该学生注意到在非常小的半径范围内，特别是在 $r \\ll \\delta$ 的范围内，存在一种独特的行为。以下哪个陈述最能描述该学生在这种小半径区域应该预期看到的图形特征？\n\nA. 该图将是一条斜率等于嵌入维数 $m$ 的直线。\n\nB. 该图将是一条斜率等于真实相关维数 $D_2$ 的直线。\n\nC. 该图将呈现一个斜率约等于零的平台区。\n\nD. 该图将是一条斜率约为 1 的直线，与系统的动力学无关。\n\nE. 该图将显示一个趋向于负无穷大的斜率。", "solution": "问题要求我们确定当时间序列数据以分辨率 $\\delta$ 进行量化时，相关积分 $C(r)$ 在小半径 $r$ 下的行为。\n\n步骤 1：分析重构向量的结构。\n时间序列数据 $\\{x_n\\}$ 包含的值是分辨率 $\\delta$ 的整数倍。也就是说，对于每个 $n$，存在某个整数 $k_n$，使得 $x_n = k_n \\delta$。$m$ 维嵌入空间中的一个重构向量由 $\\vec{V}_i = (x_i, x_{i+\\tau}, \\dots, x_{i+(m-1)\\tau})$ 给出。代入数据的量化形式，我们得到：\n$$\n\\vec{V}_i = (k_i \\delta, k_{i+\\tau} \\delta, \\dots, k_{i+(m-1)\\tau} \\delta) = \\delta (k_i, k_{i+\\tau}, \\dots, k_{i+(m-1)\\tau})\n$$\n该表达式表明，所有重构的状态向量 $\\vec{V}_i$ 并不位于连续的分形流形上，而是被限制在 $m$ 维空间中一个超立方晶格的顶点上。该晶格的基本间距为 $\\delta$。\n\n步骤 2：计算不同重构向量之间的最小距离。\n我们需要计算两个不同向量 $\\vec{V}_i$ 和 $\\vec{V}_j$（其中 $i \\neq j$）之间的距离。欧几里得距离的平方为：\n$$\n\\|\\vec{V}_i - \\vec{V}_j\\|^2 = \\sum_{k=0}^{m-1} (x_{i+k\\tau} - x_{j+k\\tau})^2\n$$\n由于每个 $x_n$ 都是 $\\delta$ 的整数倍，因此差值 $(x_{i+k\\tau} - x_{j+k\\tau})$也必须是 $\\delta$ 的整数倍。设这个差值为 $n_k \\delta$，其中 $n_k$ 为某个整数。\n$$\n\\|\\vec{V}_i - \\vec{V}_j\\|^2 = \\sum_{k=0}^{m-1} (n_k \\delta)^2 = \\delta^2 \\sum_{k=0}^{m-1} n_k^2\n$$\n由于向量 $\\vec{V}_i$ 和 $\\vec{V}_j$ 是不同的，至少有一个分量差不为零，这意味着至少有一个整数 $n_k$ 不为零。整数平方和 $\\sum n_k^2$ 的最小可能非零值为 1（这发生在一个 $n_k = \\pm 1$ 而所有其他 $n_l=0$ 的情况下，其中 $l\\neq k$）。\n因此，任意两不同点之间的最小可能距离平方为 $\\delta^2 \\cdot 1 = \\delta^2$。于是，最小可能距离为 $\\sqrt{\\delta^2} = \\delta$。\n\n步骤 3：分析 $r  \\delta$ 时的相关积分 $C(r)$。\n相关积分 $C(r)$ 与距离小于 $r$ 的不同向量对 $(\\vec{V}_i, \\vec{V}_j)$ 的数量成正比。从步骤 2 我们知道，任意两不同点之间的最小距离是 $\\delta$。\n如果我们考虑一个半径 $r  \\delta$，则不存在任何*不同*的向量对 $(\\vec{V}_i, \\vec{V}_j)$ 能够满足条件 $\\|\\vec{V}_i - \\vec{V}_j\\|  r$。因此，这样的向量对数量为零。\n根据所给定义，$C(r)$ 统计的是不同向量的对数。所以，对于范围 $0  r  \\delta$ 内的任何 $r$，$C(r) = 0$。\n\n步骤 4：分析对数-对数图 $\\log(C(r))$ 对 $\\log(r)$。\n如果对于 $r  \\delta$ 有 $C(r)=0$，那么 $\\log(C(r))$ 将是 $-\\infty$。在实践中，数值算法通常处理有限数量的点，并且可能存在某些重构向量是相同的，即对于 $i \\neq j$ 有 $\\vec{V}_i = \\vec{V}_j$。如果定义被修改为包含 $i=j$ 的情况，或者如果存在相同的向量，这些向量对的距离将为 0。在这种稍微修改过的或更实际的观点中，对于任何小的 $r  0$，这些零距离的向量对都会被计算在内。设这类向量对的数量为 $N_0$。那么对于 $0  r  \\delta$，相关和是常数，等于 $N_0$（归一化后为一个小常数），因为在 $r$ 达到 $\\delta$ 之前不会增加新的向量对。\n因此，对于 $0  r  \\delta$，$C(r)$ 是一个常数（零或一个小的正常数）。\n相关维数由 $y = \\log(C(r))$ 对 $x = \\log(r)$ 的图像斜率给出。\n$$\nD_2 \\approx \\frac{d(\\log C(r))}{d(\\log r)}\n$$\n如果对于 $r  \\delta$，$C(r)$ 是一个常数，比如 $C_0$，那么 $\\log(C(r)) = \\log(C_0)$，这也是一个常数。y 轴上的常数值对 x 轴上的变化值作图，得到的是一条水平线。水平线的斜率为零。\n因此，在 $r  \\delta$ 的区域，$\\log(C(r))$ 对 $\\log(r)$ 的图将是平坦的，呈现出一个斜率约等于零的平台区。这是一个由仪器的有限分辨率引起的数值假象，并不反映吸引子的真实几何形状。可以用来估计 $D_2$ 的实际标度区仅在 $r  \\delta$ 时才开始。\n\n步骤 5：评估选项。\nA. 不正确。斜率为 $m$ 意味着点充满了 $m$ 维嵌入空间，但由于晶格点之间存在空隙，在这些尺度上这是不成立的。\nB. 不正确。真实维数 $D_2$ 仅在大于分辨率 $\\delta$ 但小于吸引子整体尺寸的尺度上才能显现出来。\nC. 正确。如上所述，对于 $r  \\delta$，$C(r)$ 是常数，导致在对数-对数图上斜率为零，表现为一个平台区。\nD. 不正确。通常不期望斜率为 1。\nE. 不正确。斜率趋于负无穷大不是标准行为。$C(r)$ 为零或一个小的常数值会导致 $\\log(C(r))$ 是一个很大的负数，但对于维数而言，重要的是图的斜率，而这个斜率为零。", "answer": "$$\\boxed{C}$$", "id": "1665729"}, {"introduction": "对数据的批判性评估是科学分析的关键环节。在掌握了相关维度的基本计算和图表解读之后，我们必须考虑数据质量问题，例如异常值的存在。此练习通过一个思想实验，精确地展示了仅仅几个远离主吸引子的异常数据点，就可能显著扭曲相关维度的估算值，这强调了数据预处理和结果审慎解读的重要性 [@problem_id:1665704]。", "problem": "一位研究人员分析了一组由混沌系统的时间序列生成的相空间矢量。原始的干净数据集包含 $N_A = 10000$ 个矢量，对于这个集合，在某个“标度区域”内，距离小于或等于 $r$ 的矢量对数量由幂律 $P_A(r) = K r^{D_T}$ 描述。该系统的真实关联维度为 $D_T = 2.4$。\n\n不幸的是，该数据集因加入了 $N_B = 3$ 个相同的离群矢量而受到污染。这三个矢量位于相空间中完全相同的点上，该位置远离所有原始的 $N_A$ 个矢量。因此，受污染的数据集中的矢量总数为 $N = N_A + N_B = 10003$。\n\n整个受污染数据集的关联积分（记为 $C(r)$）定义为：间距小于或等于 $r$ 的不同矢量对的总数，除以数据集中所有可能的不同矢量对的总数。由此，可以使用公式 $D_{app}(r) = \\frac{d(\\ln C(r))}{d(\\ln r)}$ 计算表观关联维度。\n\n在一个位于标度区域内的特定小半径 $r_0$ 处，确定出来自原始干净数据集且间距小于或等于 $r_0$ 的矢量对数量恰好为 $P_A(r_0) = 30$。假设该半径 $r_0$ 足够小，以至于任何原始矢量与任何离群矢量之间的距离都远大于 $r_0$。\n\n计算在该半径下，受污染数据集的表观关联维度 $D_{app}(r_0)$ 的值。将最终答案四舍五入到四位有效数字。", "solution": "干净数据集有 $N_{A}$ 个矢量，在标度区域内，半径 $r$ 内的矢量对数量为\n$$\nP_{A}(r)=K r^{D_{T}},\n$$\n其中 $D_{T}=2.4$。受污染的数据集在同一位置增加了 $N_{B}=3$ 个相同的离群点，它们都远离原始的 $N_A$ 个矢量。对于任何足够小以至于离群点远离每一个原始矢量的 $r0$，我们有：\n- 在半径 $r$ 内，原始矢量与离群矢量之间没有交叉对：$P_{AB}(r)=0$。\n- 所有离群点-离群点对都在半径 $r$ 内，因为它们之间的相互距离为零。当 $N_{B}=3$ 时，不同的离群点对的数量为\n$$\nP_{B}(r)=\\binom{3}{2}=3 \\quad \\text{for all } r0.\n$$\n\n令 $N=N_{A}+N_{B}$，并令 $M=\\binom{N}{2}$ 为受污染数据集中不同矢量对的总数。关联积分为\n$$\nC(r)=\\frac{P_{A}(r)+P_{B}(r)+P_{AB}(r)}{M}=\\frac{K r^{D_{T}}+3}{M}.\n$$\n表观关联维度为\n$$\nD_{\\text{app}}(r)=\\frac{d(\\ln C(r))}{d(\\ln r)}=\\frac{r}{C(r)}\\frac{dC(r)}{dr}.\n$$\n对 $C(r)$ 求导可得\n$$\n\\frac{dC(r)}{dr}=\\frac{K D_{T} r^{D_{T}-1}}{M}.\n$$\n因此，\n$$\nD_{\\text{app}}(r)=\\frac{r}{\\frac{K r^{D_{T}}+3}{M}}\\cdot \\frac{K D_{T} r^{D_{T}-1}}{M}\n= D_{T}\\,\\frac{K r^{D_{T}}}{K r^{D_{T}}+3}.\n$$\n\n在 $r=r_{0}$ 处，已知 $P_{A}(r_{0})=K r_{0}^{D_{T}}=30$。因此\n$$\nD_{\\text{app}}(r_{0})=D_{T}\\,\\frac{30}{30+3}=D_{T}\\,\\frac{10}{11}.\n$$\n已知 $D_{T}=2.4$，\n$$\nD_{\\text{app}}(r_{0})=2.4 \\times \\frac{10}{11}=\\frac{24}{11}=2.181818\\ldots\n$$\n四舍五入到四位有效数字，结果为 $2.182$。", "answer": "$$\\boxed{2.182}$$", "id": "1665704"}]}