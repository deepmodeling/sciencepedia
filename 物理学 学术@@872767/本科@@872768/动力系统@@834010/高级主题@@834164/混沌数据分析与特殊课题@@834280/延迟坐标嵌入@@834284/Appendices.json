{"hands_on_practices": [{"introduction": "理论转化为实践的第一步是亲手构造延迟坐标向量。这个练习提供了一个具体的时间序列，让你根据给定的嵌入维度 $m$ 和时间延迟 $\\tau$ 来构建向量，这是掌握延迟嵌入技术的基础。通过这个计算，你将熟悉从原始数据中提取多维状态向量的基本流程。 [@problem_id:1671692]", "problem": "在非线性动力系统的分析中，一种常用技术是使用延迟坐标嵌入从单个时间序列重构相空间。考虑一个由单个可观测量组成的时间序列，表示为测量序列 $s_1, s_2, s_3, \\dots, s_N$。重构相空间中的一个延迟向量 $\\mathbf{v}_k$ 是通过从时间序列中取出 $m$ 个值形成的，这些值之间由一个时间延迟 $\\tau$ 分隔。从测量值 $s_k$ 开始的第 $k$ 个向量定义为：\n$$\n\\mathbf{v}_k = (s_k, s_{k+\\tau}, s_{k+2\\tau}, \\dots, s_{k+(m-1)\\tau})\n$$\n一位环境科学家记录了一年来每月的平均大气CO2浓度。时间序列数据，用 $c_k$ 表示第 $k$ 个月的数据，以百万分之几（ppm）为单位给出：\n$C = \\{410.5, 411.2, 412.1, 413.0, 412.8, 411.7, 410.1, 408.9, 409.5, 410.8, 412.3, 413.5\\}$\n\n使用嵌入维度 $m=4$ 和时间延迟 $\\tau=2$ 个月，可以构造的前三个有效延迟向量是 $\\mathbf{v}_1$、$\\mathbf{v}_2$ 和 $\\mathbf{v}_3$。\n\n计算向量和 $\\mathbf{V} = \\mathbf{v}_1 + \\mathbf{v}_2 + \\mathbf{v}_3$ 的模（欧几里得范数）。将您的最终答案以 ppm 为单位表示，并四舍五入到五位有效数字。", "solution": "我们已知月度时间序列 $C=\\{c_{1},c_{2},\\dots,c_{12}\\}$，其中 $c_{1}=410.5$, $c_{2}=411.2$, $c_{3}=412.1$, $c_{4}=413.0$, $c_{5}=412.8$, $c_{6}=411.7$, $c_{7}=410.1$, $c_{8}=408.9$, $c_{9}=409.5$, $c_{10}=410.8$, $c_{11}=412.3$, $c_{12}=413.5$。对于嵌入维度 $m=4$ 和延迟 $\\tau=2$，延迟向量定义为\n$$\n\\mathbf{v}_{k}=(c_{k},c_{k+2},c_{k+4},c_{k+6}).\n$$\n前三个有效向量（对于 $k=1,2,3$）是\n$$\n\\mathbf{v}_{1}=(c_{1},c_{3},c_{5},c_{7})=(410.5,\\,412.1,\\,412.8,\\,410.1),\n$$\n$$\n\\mathbf{v}_{2}=(c_{2},c_{4},c_{6},c_{8})=(411.2,\\,413.0,\\,411.7,\\,408.9),\n$$\n$$\n\\mathbf{v}_{3}=(c_{3},c_{5},c_{7},c_{9})=(412.1,\\,412.8,\\,410.1,\\,409.5).\n$$\n它们的和按分量计算：\n$$\n\\mathbf{V}=\\mathbf{v}_{1}+\\mathbf{v}_{2}+\\mathbf{v}_{3}=(410.5+411.2+412.1,\\,412.1+413.0+412.8,\\,412.8+411.7+410.1,\\,410.1+408.9+409.5),\n$$\n$$\n\\mathbf{V}=(1233.8,\\,1237.9,\\,1234.6,\\,1228.5).\n$$\n欧几里得范数是\n$$\n\\|\\mathbf{V}\\|=\\sqrt{(1233.8)^{2}+(1237.9)^{2}+(1234.6)^{2}+(1228.5)^{2}}.\n$$\n计算每个分量的平方：\n$$\n(1233.8)^{2}=1{,}522{,}262.44,\\quad (1237.9)^{2}=1{,}532{,}396.41,\\quad (1234.6)^{2}=1{,}524{,}237.16,\\quad (1228.5)^{2}=1{,}509{,}212.25.\n$$\n和为：\n$$\n1{,}522{,}262.44+1{,}532{,}396.41+1{,}524{,}237.16+1{,}509{,}212.25=6{,}088{,}108.26.\n$$\n因此\n$$\n\\|\\mathbf{V}\\|=\\sqrt{6{,}088{,}108.26}\\approx 2467.409\\ldots\n$$\n四舍五入到五位有效数字，结果是 $2467.4$ (ppm)。", "answer": "$$\\boxed{2467.4}$$", "id": "1671692"}, {"introduction": "延迟坐标嵌入的成功与否在很大程度上取决于时间延迟 $\\tau$ 的选择。这个练习通过一个理想化的周期信号，探讨了 $\\tau$ 与信号周期 $T$ 之间的关系如何决定重构相空间的几何形态，从而帮助你直观地理解 $\\tau$ 的重要性。理解这一点对于避免在重构时产生扭曲或退化的吸引子至关重要。 [@problem_id:1671698]", "problem": "在动力系统的研究中，延迟坐标嵌入是一种用于从单个时间序列测量重建多维相空间的技术。\n\n考虑一个一维零均值的周期信号 $x(t)$，其基频周期为 $T  0$。从此信号构造一个二维延迟坐标嵌入，定义为向量 $\\vec{v}(t) = (x(t), x(t-\\tau))$，其中 $\\tau$ 是一个恒定的时间延迟。\n\n观察到，对于某些 $\\tau$ 的选择，当时间 $t$ 变化时，向量 $\\vec{v}(t)$ 在二维相空间中描绘的轨迹是一个以原点为中心的标准圆。假设周期信号 $x(t)$ 可以很好地用其基波正弦分量来近似，以下哪个选项描述了导致这种圆形轨迹的时间延迟 $\\tau$ 和周期 $T$ 之间的所有可能关系？\n\nA. $\\tau = \\frac{nT}{2}$，对于任意整数 $n \\ge 1$。\n\nB. $\\tau = \\frac{nT}{4}$，对于任意整数 $n \\ge 1$。\n\nC. $\\tau = \\frac{(2n+1)T}{4}$，对于任意整数 $n \\ge 0$。\n\nD. $\\tau = \\frac{(2n+1)T}{2}$，对于任意整数 $n \\ge 0$。\n\nE. $\\tau = \\frac{T}{\\pi}$，对于任意整数 $n \\ge 0$。", "solution": "假设该零均值周期信号可以很好地用其基波正弦分量来近似，因此写作\n$$\nx(t)=A\\cos(\\omega t+\\phi),\n$$\n其中 $A$ 是振幅，$\\omega=\\frac{2\\pi}{T}$ 是角频率，$\\phi$ 是相位。定义\n$$\n\\theta=\\omega t+\\phi,\\qquad \\Delta=\\omega \\tau=\\frac{2\\pi}{T}\\,\\tau,\n$$\n所以延迟嵌入向量是\n$$\n(x,y)=\\bigl(x(t),x(t-\\tau)\\bigr)=\\bigl(A\\cos\\theta,\\;A\\cos(\\theta-\\Delta)\\bigr).\n$$\n为了找到在 $(x,y)$ 平面上的轨迹，消去 $\\theta$。使用 $\\cos(\\theta-\\Delta)=\\cos\\theta\\cos\\Delta+\\sin\\theta\\sin\\Delta$，我们有\n$$\n\\frac{y}{A}=\\frac{x}{A}\\cos\\Delta+\\sin\\theta\\,\\sin\\Delta,\n$$\n所以\n$$\n\\sin\\theta=\\frac{\\frac{y}{A}-\\frac{x}{A}\\cos\\Delta}{\\sin\\Delta},\\qquad \\cos\\theta=\\frac{x}{A}.\n$$\n利用 $\\cos^{2}\\theta+\\sin^{2}\\theta=1$：\n$$\n\\left(\\frac{x}{A}\\right)^{2}+\\left(\\frac{\\frac{y}{A}-\\frac{x}{A}\\cos\\Delta}{\\sin\\Delta}\\right)^{2}=1.\n$$\n两边乘以 $A^{2}\\sin^{2}\\Delta$ 并展开：\n$$\nx^{2}\\sin^{2}\\Delta+(y-x\\cos\\Delta)^{2}=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}\\sin^{2}\\Delta+y^{2}-2xy\\cos\\Delta+x^{2}\\cos^{2}\\Delta=A^{2}\\sin^{2}\\Delta,\n$$\n$$\nx^{2}-2xy\\cos\\Delta+y^{2}=A^{2}\\sin^{2}\\Delta.\n$$\n这是一个以原点为中心的二次曲线方程。当交叉项消失时，即当 $\\cos\\Delta=0$ 时，它就精确地成为一个以原点为中心的圆。此时 $\\sin^{2}\\Delta=1$，方程简化为\n$$\nx^{2}+y^{2}=A^{2},\n$$\n一个半径为 $A$ 的圆。条件 $\\cos\\Delta=0$ 给出\n$$\n\\Delta=\\frac{\\pi}{2}+k\\pi=\\frac{(2k+1)\\pi}{2},\\qquad k\\in\\mathbb{Z}.\n$$\n因为 $\\Delta=\\omega\\tau=\\frac{2\\pi}{T}\\tau$，求解 $\\tau$：\n$$\n\\frac{2\\pi}{T}\\,\\tau=\\frac{(2k+1)\\pi}{2}\\quad\\Longrightarrow\\quad \\tau=\\frac{(2k+1)T}{4}.\n$$\n因此，能产生标准圆的时间延迟是 $T$ 的奇数个四分之一周期。在这些选项中，这恰好由 $\\tau=\\frac{(2n+1)T}{4}$（对于整数 $n\\ge 0$）描述，即选项C。其他列出的选项族包含不满足 $\\cos\\Delta=0$ 的值（例如，半周期延迟给出直线，而不是圆），所以它们没有专门描述所需的集合。", "answer": "$$\\boxed{C}$$", "id": "1671698"}, {"introduction": "延迟坐标嵌入不仅适用于平滑的动力学过程，也能揭示不连续或突变行为的特征。通过对比平滑的正弦波和不连续的方波的嵌入结果，本练习将展示该技术如何灵敏地捕捉时间序列的内在特性，并将其转化为独特的几何结构。这个对比有助于加深你对嵌入如何反映原始信号动态特征的理解。 [@problem_id:1671719]", "problem": "在动力系统的研究中，一种从单个时间序列测量重建相空间图的常用技术是延迟坐标嵌入法。对于给定的标量时间序列 $x(t)$ 和选定的时间延迟 $\\tau$，通过创建点 $(x(t), x(t-\\tau))$ 来构建二维（2D）嵌入。\n\n考虑两个不同的周期信号，它们的振幅均为 $A$，角频率均为 $\\omega$。\n信号1，$S_1(t)$，是一个由 $S_1(t) = A \\sin(\\omega t)$ 给出的平滑正弦波。\n信号2，$S_2(t)$，是一个不连续的对称方波，其周期与 $S_1(t) = A \\sin(\\omega t)$ 相同，并在 $+A$ 和 $-A$ 之间交替。具体来说，当 $0 \\le t  \\frac{\\pi}{\\omega}$ 时，$S_2(t) = +A$；当 $\\frac{\\pi}{\\omega} \\le t  \\frac{2\\pi}{\\omega}$ 时，$S_2(t) = -A$，并且此模式重复。\n\n对于这两个信号，使用一个满足条件 $0  \\omega \\tau \\ll 1$ 的小的非零时间延迟 $\\tau$ 来构建二维延迟坐标嵌入。\n\n下列哪个描述最能刻画两个生成的嵌入在 $(x(t), x(t-\\tau))$ 平面上的形状？\n\nA. 信号1形成一个完美的圆；信号2形成一个由顶点 $(A, A)$、$(A, -A)$、$(-A, -A)$ 和 $(-A, A)$ 定义的正方形。\n\nB. 信号1形成一个倾斜的椭圆；信号2形成一个由四个离散点组成的集合。\n\nC. 信号1形成沿对角线 $y=x$ 的一条线段；信号2形成一个位于 $(A, A)$ 和 $(-A, -A)$ 的两个离散点组成的集合。\n\nD. 信号1形成一个收敛到原点的螺旋线；信号2形成一个“8”字形。\n\nE. 两个信号都形成利萨如图形，但波瓣数不同。", "solution": "我们通过使用一个小的非零延迟 $\\tau$（满足 $0  \\omega \\tau \\ll 1$）来形成点 $(x(t), x(t-\\tau))$，从而为每个信号构建二维延迟嵌入。将 $x(t)$ 表示为时间 $t$ 的信号值，并将 $x(t-\\tau)$ 写为延迟后的值。令 $\\delta=\\omega \\tau$，因此 $0  \\delta \\ll 1$。\n\n对于信号1，$S_{1}(t)=A\\sin(\\omega t)$，定义\n$$\nx(t)=A\\sin(\\omega t), \\quad y(t)=x(t-\\tau)=A\\sin(\\omega t-\\omega \\tau)=A\\sin(\\omega t-\\delta).\n$$\n引入归一化变量 $X=\\frac{x}{A}$ 和 $Y=\\frac{y}{A}$。使用三角恒等式，\n$$\nY=\\sin(\\omega t-\\delta)=\\sin(\\omega t)\\cos\\delta-\\cos(\\omega t)\\sin\\delta,\n$$\n我们设 $s=\\sin(\\omega t)$ 和 $c=\\cos(\\omega t)$ 来得到\n$$\nX=s, \\quad Y=s\\cos\\delta-c\\sin\\delta.\n$$\n使用 $s^{2}+c^{2}=1$ 消去参数。从 $X=s$ 我们得到 $s=X$，从第二个方程得到 $c=\\frac{X\\cos\\delta-Y}{\\sin\\delta}$。代入 $s^{2}+c^{2}=1$ 得到\n$$\nX^{2}+\\left(\\frac{X\\cos\\delta-Y}{\\sin\\delta}\\right)^{2}=1.\n$$\n展开并化简，得到隐式笛卡尔方程\n$$\nX^{2}+Y^{2}-2XY\\cos\\delta=\\sin^{2}\\delta.\n$$\n对于任何满足 $0  \\delta  \\pi$ 和 $\\delta\\neq \\frac{\\pi}{2}$ 的 $\\delta$，这是一个相对于坐标轴倾斜的椭圆。在 $\\delta=\\frac{\\pi}{2}$ 的特殊情况下，我们得到 $X^{2}+Y^{2}=1$，一个圆。由于 $0  \\delta \\ll 1$ 但 $\\delta\\neq 0$，正弦波的嵌入是一个靠近对角线 $Y=X$ 的、细长的、倾斜的椭圆，而不是一个圆，也不是一条直线。\n\n对于信号2，$S_{2}(t)$ 是一个周期为 $T=\\frac{2\\pi}{\\omega}$ 的对称方波，其值仅为 $\\pm A$。切换时间为 $t_{k}=\\frac{k\\pi}{\\omega}$，其中 $k$ 是整数。对于任何与切换时间的距离大于 $\\tau$ 的时间 $t$，$t$ 和 $t-\\tau$ 都位于同一个平稳段内，因此\n$$\nx(t)=\\pm A,\\quad x(t-\\tau)=\\pm A \\quad \\Rightarrow \\quad (x(t),x(t-\\tau))\\in\\{(A,A),(-A,-A)\\}.\n$$\n对于在切换时间 $t_{k}$ 之后的宽度为 $\\tau$ 的时间窗口内的 $t$，$x(t)$ 具有新的符号，而 $x(t-\\tau)$ 仍然保持旧的符号，得到\n$$\n(x(t),x(t-\\tau))\\in\\{(A,-A),(-A,A)\\}.\n$$\n由于方波只取 $\\pm A$ 两个值，没有中间值，因此嵌入仅由以下四个离散点组成\n$$\n(A,A),\\quad (A,-A),\\quad (-A,A),\\quad (-A,-A).\n$$\n因为 $0  \\delta \\ll 1$，对于大多数时间 $t$ 都会出现对角点，但作为一个集合，所有四个离散点都存在。\n\n因此，信号1形成一个倾斜的椭圆，信号2形成一个由四个离散点组成的集合。", "answer": "$$\\boxed{B}$$", "id": "1671719"}]}