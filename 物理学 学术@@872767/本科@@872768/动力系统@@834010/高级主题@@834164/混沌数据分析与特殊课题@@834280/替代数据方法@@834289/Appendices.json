{"hands_on_practices": [{"introduction": "在进行假设检验时，首要任务是明确零假设所描述的系统行为。本练习将通过计算一个检验统计量在所有可能重排的代理数据上的理论期望值，帮助你建立对零假设的深刻理解。这个理论值是一个理想化的基准，它代表了在完全随机的情况下我们期望看到的结果，为我们后续的检验提供了参照 [@problem_id:1712308]。", "problem": "在时间序列数据分析中，常使用代理数据方法来检验非随机结构。其核心思想是生成大量“代理”数据集，这些数据集与原始数据共享某些统计特性（如均值或数值分布），但在其他方面是随机的。通过将从原始数据计算出的检验统计量与从代理数据集中得到的同一统计量的分布进行比较，可以评估任何观测到的模式的统计显著性。\n\n考虑一个简单的二元时间序列 $S$，它表示十次连续试验的结果（其中1可以代表“成功”，0代表“失败”）：\n$$ S = \\{1, 0, 0, 1, 1, 0, 1, 0, 0, 0\\} $$\n为了检验时间有序性，我们定义一个检验统计量 $T$，其值为序列中一个元素与其紧邻的后一个元素不同的总次数。对于一个序列 $\\{s_1, s_2, \\dots, s_N\\}$，这就是相邻元素之间“转换”（从0到1或从1到0）的次数。\n\n你的任务是在不存在时间顺序的原假设下，确定该检验统计量的理论期望值 $\\langle T_{surr} \\rangle$。该期望值等同于对序列 $S$ 的所有可能唯一排列构成的总体计算出的 $T$ 的平均值。\n\n计算给定序列 $S$ 的 $\\langle T_{surr} \\rangle$ 值。将你的最终答案保留两位有效数字。", "solution": "设序列长度为 $N$，1的个数为 $n_{1}$，0的个数为 $n_{0}$，且有 $N=n_{1}+n_{0}$。定义检验统计量为\n$$\nT=\\sum_{i=1}^{N-1} I_{i},\n$$\n其中 $I_{i}$ 是 $s_{i}\\neq s_{i+1}$ 的指示变量。根据期望的线性性质，\n$$\n\\langle T_{surr} \\rangle=\\sum_{i=1}^{N-1} \\Pr(s_{i}\\neq s_{i+1})=(N-1)\\,p,\n$$\n其中 $p=\\Pr(s_{i}\\neq s_{i+1})$ 是在包含 $n_{1}$ 个1和 $n_{0}$ 个0的多重集的均匀随机排列中，两个相邻元素不相同的概率。\n\n根据可交换性，一个有序相邻对的分布与从总体中进行两次不放回抽样的分布相同，因此\n$$\np=\\Pr(1\\text{ then }0)+\\Pr(0\\text{ then }1)=\\frac{n_{1}}{N}\\cdot\\frac{n_{0}}{N-1}+\\frac{n_{0}}{N}\\cdot\\frac{n_{1}}{N-1}=\\frac{2 n_{1} n_{0}}{N(N-1)}.\n$$\n因此，\n$$\n\\langle T_{surr} \\rangle=(N-1)\\cdot \\frac{2 n_{1} n_{0}}{N(N-1)}=\\frac{2 n_{1} n_{0}}{N}.\n$$\n\n对于给定的序列 $S$，我们有 $N=10$，$n_{1}=4$ 和 $n_{0}=6$，所以\n$$\n\\langle T_{surr} \\rangle=\\frac{2\\cdot 4\\cdot 6}{10}=\\frac{48}{10}=4.8,\n$$\n保留两位有效数字后为 $4.8$。", "answer": "$$\\boxed{4.8}$$", "id": "1712308"}, {"introduction": "掌握了理论基础后，我们来动手完成一次完整的代理数据检验。本练习模拟了一个真实的研究场景，要求你对一组实验数据进行分析。你将为原始时间序列及其代理数据计算一个关键的检验统计量——滞后1阶自相关系数，并最终得出p值来判断数据中是否存在显著的时间结构 [@problem_id:1712276]。", "problem": "一位物理学家正在研究一个系统，其中一个小而高弹性的小球在一个温度被主动但非完美控制的特殊表面上反弹。其假设是，峰值反弹高度序列是一个独立同分布 (IID) 过程，这意味着连续的反弹之间没有“记忆”或相关性。为了检验这个原假设，采用了一种代理数据方法。\n\n记录的连续五次峰值反弹高度的时间序列（单位为米）由下式给出：\n$$ H_{data} = \\{0.80, 0.60, 0.65, 0.45, 0.50\\} $$\n\n为了在原假设下创建一个参考分布，通过打乱原始数据生成了四个代理时间序列：\n- $S_1 = \\{0.45, 0.50, 0.60, 0.65, 0.80\\}$\n- $S_2 = \\{0.60, 0.80, 0.45, 0.50, 0.65\\}$\n- $S_3 = \\{0.80, 0.45, 0.65, 0.50, 0.60\\}$\n- $S_4 = \\{0.50, 0.80, 0.60, 0.45, 0.65\\}$\n\n用于量化时间相关性的检验统计量是滞后-1自相关系数 $r_1$。对于一个均值为 $\\bar{x}$ 的时间序列 $x = \\{x_1, x_2, \\dots, x_N\\}$，滞后-1自相关定义为：\n$$ r_1 = \\frac{\\sum_{i=1}^{N-1} (x_i - \\bar{x})(x_{i+1} - \\bar{x})}{\\sum_{i=1}^{N} (x_i - \\bar{x})^2} $$\n\n您的任务是进行显著性检验。计算 p 值，其定义为所提供的代理数据集中，其滞后-1自相关大于或等于原始数据 $H_{data}$ 的滞后-1自相关的代理数据集所占的比例。将您的答案表示为保留两位有效数字的小数。", "solution": "我们使用滞后-1自相关的定义\n$$\nr_{1}=\\frac{\\sum_{i=1}^{N-1}(x_{i}-\\bar{x})(x_{i+1}-\\bar{x})}{\\sum_{i=1}^{N}(x_{i}-\\bar{x})^{2}},\n$$\n对于每个序列，$N=5$。由于所有代理序列都是相同数值的排列，因此每个序列的均值和分母都与原始序列相同。\n\n对于 $H_{data}=\\{0.80,0.60,0.65,0.45,0.50\\}$，均值为\n$$\n\\bar{x}=\\frac{0.80+0.60+0.65+0.45+0.50}{5}=\\frac{3.00}{5}=0.60.\n$$\n偏差为 $d=\\{0.20,0.00,0.05,-0.15,-0.10\\}$。分母为\n$$\n\\sum_{i=1}^{5}d_{i}^{2}=0.20^{2}+0.00^{2}+0.05^{2}+(-0.15)^{2}+(-0.10)^{2}=0.0750.\n$$\n分子为\n$$\n\\sum_{i=1}^{4}d_{i}d_{i+1}=(0.20)(0.00)+(0.00)(0.05)+(0.05)(-0.15)+(-0.15)(-0.10)=0.0075,\n$$\n所以\n$$\nr_{1}(H_{data})=\\frac{0.0075}{0.0750}=0.10.\n$$\n\n对于每个代理序列，$\\bar{x}=0.60$ 且分母为 $0.0750$。计算分子和 $r_{1}$：\n\n- $S_{1}=\\{0.45,0.50,0.60,0.65,0.80\\}$ 的偏差为 $\\{-0.15,-0.10,0.00,0.05,0.20\\}$，分子为 $0.015+0+0+0.010=0.025$，所以\n$$\nr_{1}(S_{1})=\\frac{0.025}{0.075}=\\frac{1}{3}\\approx 0.333\\ldots\n$$\n- $S_{2}=\\{0.60,0.80,0.45,0.50,0.65\\}$ 的偏差为 $\\{0.00,0.20,-0.15,-0.10,0.05\\}$，分子为 $0-0.030+0.015-0.005=-0.020$，所以\n$$\nr_{1}(S_{2})=\\frac{-0.020}{0.075}=-0.266\\ldots\n$$\n- $S_{3}=\\{0.80,0.45,0.65,0.50,0.60\\}$ 的偏差为 $\\{0.20,-0.15,0.05,-0.10,0.00\\}$，分子为 $-0.030-0.0075-0.005+0=-0.0425$，所以\n$$\nr_{1}(S_{3})=\\frac{-0.0425}{0.075}=-0.566\\ldots\n$$\n- $S_{4}=\\{0.50,0.80,0.60,0.45,0.65\\}$ 的偏差为 $\\{-0.10,0.20,0.00,-0.15,0.05\\}$，分子为 $-0.020+0+0-0.0075=-0.0275$，所以\n$$\nr_{1}(S_{4})=\\frac{-0.0275}{0.075}=-0.366\\ldots\n$$\n\n我们与 $r_{1}(H_{data})=0.10$ 进行比较。在这些代理序列中，只有 $S_{1}$ 满足 $r_{1}\\geq 0.10$，即 4 个中有 1 个。因此，p 值为\n$$\np=\\frac{1}{4}=0.25,\n$$\n保留两位有效数字为 $0.25$。", "answer": "$$\\boxed{0.25}$$", "id": "1712276"}, {"introduction": "一个统计检验方法只有在我们了解其性能和局限时才真正有用。本练习将引导你探索“统计功效”这一高级但至关重要的概念，它衡量了检验方法成功检测出真实非线性信号的能力。通过分析一组数值实验的结果，你将学习如何量化检验的功效与时间序列长度之间的关系，这对于设计和评估实验至关重要 [@problem_id:1712266]。", "problem": "一位非线性动力学研究人员正在研究一种区分混沌信号和随机噪声的方法。所提出的“代理数据检验”旨在通过检验时间序列中的非线性来达到此目的。该研究人员希望量化此检验的一个关键性能指标：其统计功效。\n\n混沌信号的来源是逻辑斯谛映射，由方程 $x_{n+1} = 4 x_n (1-x_n)$ 描述，初始值为 $x_0 = 0.2$。从此映射生成一个非常长的时间序列，作为“真实”的混沌信号。\n\n该方法的核心是一个假设检验。零假设 $H_0$ 假定给定的时间序列段是由一个平稳、线性、高斯随机过程生成的，该过程具有与该序列段相同的功率谱（因此也具有相同的自相关函数）。为检验 $H_0$，使用相位随机化傅里叶变换（PRFT）方法从原始时间序列创建代理数据集。根据构造，此算法产生的新时间序列与零假设一致。\n\n对原始序列（$S_{orig}$）和每个代理序列（$S_{surr}$）计算一个非线性判别统计量，即三次时间反演不对称性统计量 $S$。该统计量定义为 $S = \\frac{1}{N-1} \\sum_{i=1}^{N-1} (x_{i+1}-x_i)^3$，其中 $N$ 是时间序列的长度。通过生成 $M=99$ 个代理数据来执行此检验。如果 $S_{orig}$ 大于所有 99 个 $S_{surr, j}$ 的值，则拒绝零假设。这构成了一个显著性水平为 $\\alpha = 1/(M+1) = 0.01$ 的单侧检验。\n\n为了确定该检验的统计功效（即正确识别混沌序列的概率），研究人员进行了一项数值实验。对于几个不同的时间序列长度 $L$，此检验在逻辑斯谛映射数据的独立片段上重复了 1000 次。对于给定的长度 $L$，统计功效 $P$ 被估计为这 1000 次试验中正确拒绝零假设的试验所占的比例。此实验的结果总结在下表中：\n\n| 长度 ($L$) | 功效 ($P$) |\n|--------------|-------------|\n| 100          | 0.05        |\n| 200          | 0.27        |\n| 300          | 0.73        |\n| 400          | 0.95        |\n| 500          | 0.99        |\n\n研究人员希望使用以下逻辑斯谛函数来建模统计功效 $P$ 和时间序列长度 $L$ 之间的关系：\n$$ P(L) = \\frac{1}{1 + \\exp\\left(-\\frac{L - L_{50}}{k}\\right)} $$\n其中 $L_{50}$ 是检验达到 50% 功效时的特征长度，而 $k$ 是一个与功效曲线陡峭程度相关的参数。\n\n通过将此模型线性化并对所提供的实验数据进行最小二乘线性回归，确定特征长度 $L_{50}$ 的值。将您的答案报告为一个数值，四舍五入到三位有效数字。", "solution": "我们从逻辑斯谛功效模型开始\n$$\nP(L)=\\frac{1}{1+\\exp\\!\\left(-\\frac{L-L_{50}}{k}\\right)}.\n$$\n进行 logit 变换得到一个关于 $L$ 的线性关系：\n$$\n\\ln\\!\\left(\\frac{P}{1-P}\\right)=\\frac{L-L_{50}}{k}.\n$$\n定义 $y=\\ln\\!\\left(\\frac{P}{1-P}\\right)$，因此\n$$\ny=a+bL,\\quad b=\\frac{1}{k},\\quad a=-\\frac{L_{50}}{k},\n$$\n这意味着\n$$\nL_{50}=-\\frac{a}{b}.\n$$\n\n使用所提供的数据，计算 $y_{i}=\\ln\\!\\left(\\frac{P_{i}}{1-P_{i}}\\right)$：\n- 对于 $L=100$, $P=0.05$：$y_{1}=\\ln\\!\\left(\\frac{0.05}{0.95}\\right)=-\\ln(19)=-2.944438979$。\n- 对于 $L=200$, $P=0.27$：$y_{2}=\\ln\\!\\left(\\frac{0.27}{0.73}\\right)=\\ln\\!\\left(\\frac{27}{73}\\right)=-0.994622575$。\n- 对于 $L=300$, $P=0.73$：$y_{3}=\\ln\\!\\left(\\frac{0.73}{0.27}\\right)=\\ln\\!\\left(\\frac{73}{27}\\right)=+0.994622575$。\n- 对于 $L=400$, $P=0.95$：$y_{4}=\\ln\\!\\left(\\frac{0.95}{0.05}\\right)=\\ln(19)=+2.944438979$。\n- 对于 $L=500$, $P=0.99$：$y_{5}=\\ln\\!\\left(\\frac{0.99}{0.01}\\right)=\\ln(99)=+4.595119850$。\n\n对五个点 $(L_{i},y_{i})$ 进行最小二乘回归 $y=a+bL$。令\n$$\n\\bar{L}=\\frac{1}{5}\\sum_{i=1}^{5}L_{i}=300,\\qquad \\bar{y}=\\frac{1}{5}\\sum_{i=1}^{5}y_{i}=0.91902397.\n$$\n计算\n$$\nS_{xx}=\\sum_{i=1}^{5}(L_{i}-\\bar{L})^{2}=100000,\n$$\n$$\nS_{xy}=\\sum_{i=1}^{5}(L_{i}-\\bar{L})(y_{i}-\\bar{y})=1901.817921.\n$$\n因此\n$$\nb=\\frac{S_{xy}}{S_{xx}}=0.0190181792,\\qquad a=\\bar{y}-b\\,\\bar{L}=0.91902397-0.0190181792\\times 300=-4.786429794.\n$$\n最后，\n$$\nL_{50}=-\\frac{a}{b}=\\frac{4.786429794}{0.0190181792}\\approx 2.51677\\times 10^{2}.\n$$\n四舍五入到三位有效数字，\n$$\nL_{50}\\approx 252.\n$$", "answer": "$$\\boxed{252}$$", "id": "1712266"}]}