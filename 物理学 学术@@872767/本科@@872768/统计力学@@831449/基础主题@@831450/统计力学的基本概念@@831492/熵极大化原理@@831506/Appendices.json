{"hands_on_practices": [{"introduction": "第一个练习旨在让你初步领会熵最大化原理的核心思想。它将向你展示，在信息有限的情况下，该原理如何引导我们选择最“公平”或最均匀的概率分布，这与我们关于无偏见的直观理解不谋而合。通过解决这个问题 [@problem_id:1963903]，你将看到，当某些结果无法区分时，将它们一视同仁地赋予相同概率是熵最大化的直接推论。", "problem": "一个模型系统由粒子组成，每个粒子可以占据四个可能的离散状态之一，分别标记为 1、2、3 和 4。令 $p_i$ 表示随机选取的粒子处于状态 $i$ 的概率。在一个实验中，发现粒子处于状态 1 或状态 2 的总概率恰好为 $1/3$。关于系统状态分布的其他信息均未知。\n\n根据最大熵原理，最无偏的概率分布 $\\{p_1, p_2, p_3, p_4\\}$ 是在所有已知约束条件下，使吉布斯熵 $S = -k \\sum_{i=1}^{4} p_i \\ln(p_i)$（其中 $k$ 为任意正常数）最大化的分布。\n\n确定四个概率 $p_1, p_2, p_3, \\text{和 } p_4$ 的值。将有序元组 $(p_1, p_2, p_3, p_4)$ 的最终答案表示为行矩阵。", "solution": "我们要解决的问题是在约束条件 $p_{1}+p_{2}+p_{3}+p_{4}=1$ 和 $p_{1}+p_{2}=\\frac{1}{3}$，以及 $p_{i}\\geq 0$ 下，使吉布斯熵 $S=-k\\sum_{i=1}^{4}p_{i}\\ln(p_{i})$ 最大化。由于 $S$ 是关于 $\\{p_{i}\\}$ 的严格凹函数，且约束条件是线性的，因此在这些约束下的任何驻点都是唯一的全局最大值点。\n\n为约束条件引入拉格朗日乘子 $\\lambda$ 和 $\\mu$，并定义\n$$\n\\mathcal{L}=-k\\sum_{i=1}^{4}p_{i}\\ln(p_{i})+\\lambda\\left(\\sum_{i=1}^{4}p_{i}-1\\right)+\\mu\\left(p_{1}+p_{2}-\\frac{1}{3}\\right).\n$$\n驻点条件 $\\frac{\\partial\\mathcal{L}}{\\partial p_{i}}=0$（对 $i=1,2,3,4$）给出：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial p_{1}}=-k(\\ln p_{1}+1)+\\lambda+\\mu=0,\\quad\n\\frac{\\partial\\mathcal{L}}{\\partial p_{2}}=-k(\\ln p_{2}+1)+\\lambda+\\mu=0,\n$$\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial p_{3}}=-k(\\ln p_{3}+1)+\\lambda=0,\\quad\n\\frac{\\partial\\mathcal{L}}{\\partial p_{4}}=-k(\\ln p_{4}+1)+\\lambda=0.\n$$\n从第一组方程可得 $\\ln p_{1}=\\ln p_{2}$，因此 $p_{1}=p_{2}$。从第二组方程可得 $\\ln p_{3}=\\ln p_{4}$，因此 $p_{3}=p_{4}$。使用约束条件，\n$$\np_{1}+p_{2}=\\frac{1}{3}\\implies 2p_{1}=\\frac{1}{3}\\implies p_{1}=p_{2}=\\frac{1}{6},\n$$\n并且\n$$\np_{3}+p_{4}=1-(p_{1}+p_{2})=\\frac{2}{3}\\implies 2p_{3}=\\frac{2}{3}\\implies p_{3}=p_{4}=\\frac{1}{3}.\n$$\n该分布满足所有约束条件，并且根据 $S$ 的凹性，它使得熵最大化。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{6}  \\frac{1}{6}  \\frac{1}{3}  \\frac{1}{3}\\end{pmatrix}}$$", "id": "1963903"}, {"introduction": "在上一个练习的基础上，本题引入了一个更具物理意义的约束：系统的平均能量。这是将抽象原理与物理化学等实际应用联系起来的关键一步。通过求解这个问题 [@problem_id:1963872]，你将看到一个关于平均值的简单约束如何打破概率的均匀性，并自然地推导出指数形式的分布，这正是统计力学中玻尔兹曼分布的雏形。", "problem": "一个生物系统中资源竞争的简化模型考虑了一个微生物菌落，其分布在三个不同的生态位中，用索引 $x \\in \\{1, 2, 3\\}$ 标记。占据索引为 $x$ 的生态位会给微生物带来特定的代谢能量成本，该成本由函数 $E(x) = \\epsilon_0 x$ 给出，其中 $\\epsilon_0$ 是一个代表基本能量单位的正常数。\n\n系统已达到稳态，实验测量表明，整个菌落中每个微生物的平均代谢能量成本恰好为 $\\langle E \\rangle = 1.5 \\epsilon_0$。\n\n假设菌落采取最概然的宏观状态，根据统计力学原理，这对应于在给定约束条件下使系统香non熵 $S = -C \\sum_{x=1}^{3} p(x) \\ln(p(x))$ 最大化的概率分布 $\\{p(x)\\}$。此处，$p(x)$ 是在生态位 $x$ 中找到一个随机选取的微生物的概率，$C$ 是一个正常数。\n\n遵循此最大熵原理，确定在生态位 1 中找到一个微生物的概率 $p(1)$。将您的最终答案四舍五入到四位有效数字。", "solution": "我们在归一化和平均能量固定的约束条件下最大化香农熵。熵为 $S=-C\\sum_{x=1}^{3}p(x)\\ln p(x)$，约束条件为 $\\sum_{x=1}^{3}p(x)=1$ 和 $\\sum_{x=1}^{3}p(x)E(x)=\\langle E\\rangle=1.5\\,\\epsilon_{0}$，其中 $E(x)=\\epsilon_{0}x$。引入拉格朗日乘子 $\\alpha$ 和 $\\beta$ 并定义拉格朗日函数\n$$\n\\mathcal{L}=-C\\sum_{x=1}^{3}p(x)\\ln p(x)-\\alpha\\left(\\sum_{x=1}^{3}p(x)-1\\right)-\\beta\\left(\\sum_{x=1}^{3}p(x)E(x)-1.5\\,\\epsilon_{0}\\right).\n$$\n关于 $p(x)$ 的平稳性条件给出\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial p(x)}=-C\\left(\\ln p(x)+1\\right)-\\alpha-\\beta E(x)=0,\n$$\n所以\n$$\n\\ln p(x)=-1-\\frac{\\alpha}{C}-\\frac{\\beta}{C}E(x)\\quad\\Longrightarrow\\quad p(x)=A\\,\\exp\\!\\left(-\\lambda E(x)\\right),\n$$\n其中 $A=\\exp\\!\\left(-1-\\frac{\\alpha}{C}\\right)$ 且 $\\lambda=\\frac{\\beta}{C}$。归一化得到吉布斯形式\n$$\np(x)=\\frac{\\exp\\!\\left(-\\lambda E(x)\\right)}{Z(\\lambda)},\\qquad Z(\\lambda)=\\sum_{y=1}^{3}\\exp\\!\\left(-\\lambda E(y)\\right).\n$$\n当 $E(x)=\\epsilon_{0}x$ 时，定义 $a\\equiv \\exp\\!\\left(-\\lambda\\epsilon_{0}\\right)0$，所以\n$$\np(x)=\\frac{a^{x}}{\\sum_{y=1}^{3}a^{y}}=\\frac{a^{x}}{a+a^{2}+a^{3}}.\n$$\n能量约束 $\\langle E\\rangle=\\epsilon_{0}\\langle x\\rangle=1.5\\,\\epsilon_{0}$ 给出 $\\langle x\\rangle=1.5$，即\n$$\n\\frac{a+2a^{2}+3a^{3}}{a+a^{2}+a^{3}}=1.5.\n$$\n去分母并化简，\n$$\na+2a^{2}+3a^{3}=1.5(a+a^{2}+a^{3})\\;\\Longrightarrow\\;-a+a^{2}+3a^{3}=0\\;\\Longrightarrow\\;a\\left(3a^{2}+a-1\\right)=0.\n$$\n因为 $a0$，解方程 $3a^{2}+a-1=0$ 得到\n$$\na=\\frac{-1+\\sqrt{13}}{6}.\n$$\n那么\n$$\np(1)=\\frac{a}{a+a^{2}+a^{3}}=\\frac{1}{1+a+a^{2}}.\n$$\n使用 $3a^{2}+a-1=0\\Rightarrow a^{2}=\\frac{1-a}{3}$，\n$$\n1+a+a^{2}=1+a+\\frac{1-a}{3}=\\frac{4}{3}+\\frac{2}{3}a=\\frac{2}{3}(2+a),\n$$\n所以\n$$\np(1)=\\frac{1}{\\frac{2}{3}(2+a)}=\\frac{3}{2(2+a)}.\n$$\n代入 $a=\\frac{\\sqrt{13}-1}{6}$：\n$$\n2+a=\\frac{11+\\sqrt{13}}{6}\\quad\\Longrightarrow\\quad p(1)=\\frac{3}{2}\\cdot\\frac{6}{11+\\sqrt{13}}=\\frac{9}{11+\\sqrt{13}}=\\frac{11-\\sqrt{13}}{12}.\n$$\n数值上，$\\sqrt{13}\\approx 3.605551275$，因此 $p(1)\\approx \\frac{11-3.605551275}{12}\\approx 0.616204060$，四舍五入到四位有效数字为 $0.6162$。", "answer": "$$\\boxed{0.6162}$$", "id": "1963872"}, {"introduction": "最后的这个练习将引导你推导统计科学的基石——高斯（正态）分布。你将通过对一个具有已知均值和方差的连续变量应用熵最大化原理，来揭示为何这种分布在自然界和数据分析中无处不在。这个问题 [@problem_id:1963846] 旨在巩固一个核心观点：当你只知道一个分布的前两个矩（均值和方差）时，高斯分布便是最无偏见的统计模型。", "problem": "在统计力学中，最大熵原理指出，在满足已知约束条件的情况下，对一个系统进行建模最合适的概率分布是使信息熵最大化的那个分布。这确保了模型尽可能无偏，只包含由约束条件给出的信息。\n\n考虑一个定义在整个实数轴（从 $-\\infty$ 到 $\\infty$）上的连续随机变量 $x$。其概率密度函数 $p(x)$ 的信息内容由微分熵量化，该微分熵由以下泛函给出：\n$$S[p] = -\\int_{-\\infty}^{\\infty} p(x) \\ln(p(x)) \\, dx$$\n\n我们寻求能够最大化此熵 $S[p]$，同时满足以下三个约束条件的特定概率分布 $p(x)$：\n1.  归一化：在整个定义域上的总概率必须为一。\n    $$\\int_{-\\infty}^{\\infty} p(x) \\, dx = 1$$\n2.  固定均值：该分布必须具有指定的均值 $\\mu$。\n    $$\\int_{-\\infty}^{\\infty} x p(x) \\, dx = \\mu$$\n3.  固定方差：该分布必须具有指定的非零方差 $\\sigma^2$。\n    $$\\int_{-\\infty}^{\\infty} (x-\\mu)^2 p(x) \\, dx = \\sigma^2$$\n\n确定这个最大随机性概率分布 $p(x)$ 的函数形式。你的最终答案应该是 $p(x)$ 关于变量 $x$、均值 $\\mu$ 和标准差 $\\sigma$ 的一个闭式解析表达式。", "solution": "我们使用泛函的拉格朗日乘子法来应用带约束的最大熵原理。分别为归一化、均值和方差引入乘子 $\\lambda_{0}$、$\\lambda_{1}$ 和 $\\lambda_{2}$，并定义增广泛函\n$$\n\\mathcal{J}[p] = -\\int_{-\\infty}^{\\infty} p(x)\\ln p(x)\\,dx - \\lambda_{0}\\left(\\int_{-\\infty}^{\\infty} p(x)\\,dx - 1\\right) - \\lambda_{1}\\left(\\int_{-\\infty}^{\\infty} x\\,p(x)\\,dx - \\mu\\right) - \\lambda_{2}\\left(\\int_{-\\infty}^{\\infty} (x-\\mu)^{2} p(x)\\,dx - \\sigma^{2}\\right).\n$$\n在变分 $\\delta p(x)$ 下且满足 $p(x)\\ge 0$ 的驻定性条件，从为零的泛函导数中得到欧拉-拉格朗日条件：\n$$\n\\frac{\\delta \\mathcal{J}}{\\delta p(x)} = -\\left(\\ln p(x) + 1\\right) - \\lambda_{0} - \\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2} = 0.\n$$\n解出 $p(x)$ 得\n$$\n\\ln p(x) = -1 - \\lambda_{0} - \\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2},\n\\quad\\text{所以}\\quad\np(x) = A\\,\\exp\\left(-\\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2}\\right),\n$$\n其中 $A = \\exp(-1-\\lambda_{0})$ 吸收了常数。为了使 $p(x)$ 在 $(-\\infty,\\infty)$ 上可归一化，我们必须有 $\\lambda_{2}  0$；否则积分将发散。\n\n对指数部分进行配方以确定其隐含的均值。写出\n$$\n-\\lambda_{1} x - \\lambda_{2} (x-\\mu)^{2} = -\\lambda_{2}\\left[x^{2} - 2\\mu x + \\mu^{2}\\right] - \\lambda_{1} x\n= -\\lambda_{2}\\left(x - m\\right)^{2} - \\lambda_{2}\\mu^{2} + \\lambda_{2} m^{2},\n$$\n其中选择 $m$ 以使得 $2\\lambda_{2} m = 2\\lambda_{2}\\mu - \\lambda_{1}$，即\n$$\nm = \\mu - \\frac{\\lambda_{1}}{2\\lambda_{2}}.\n$$\n因此，\n$$\np(x) \\propto \\exp\\left(-\\lambda_{2} (x - m)^{2}\\right),\n$$\n这是一个均值为 $m$ 的高斯分布。施加均值约束 $\\int x\\,p(x)\\,dx = \\mu$ 意味着 $m = \\mu$，因此\n$$\n\\lambda_{1} = 0.\n$$\n当 $\\lambda_{1}=0$ 时，密度函数变为\n$$\np(x) = A\\,\\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right).\n$$\n归一化条件决定了 $A$：\n$$\n1 = \\int_{-\\infty}^{\\infty} p(x)\\,dx = A \\int_{-\\infty}^{\\infty} \\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right)\\,dx = A\\,\\sqrt{\\frac{\\pi}{\\lambda_{2}}},\n\\quad\\Rightarrow\\quad\nA = \\sqrt{\\frac{\\lambda_{2}}{\\pi}}.\n$$\n方差约束固定了 $\\lambda_{2}$。计算\n$$\n\\sigma^{2} = \\int_{-\\infty}^{\\infty} (x-\\mu)^{2} p(x)\\,dx\n= A \\int_{-\\infty}^{\\infty} (x-\\mu)^{2} \\exp\\left(-\\lambda_{2} (x-\\mu)^{2}\\right)\\,dx\n= \\sqrt{\\frac{\\lambda_{2}}{\\pi}} \\cdot \\frac{\\sqrt{\\pi}}{2 \\lambda_{2}^{3/2}} = \\frac{1}{2\\lambda_{2}}.\n$$\n因此，\n$$\n\\lambda_{2} = \\frac{1}{2\\sigma^{2}},\n\\quad\\text{且}\\quad\nA = \\sqrt{\\frac{1}{2\\sigma^{2}\\pi}} = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}.\n$$\n将这些代入 $p(x)$ 得\n$$\np(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right).\n$$\n由于微分熵泛函对于 $p$ 是严格凹的，且约束是线性的，因此这个驻定解是唯一的全局最大值点。故在给定约束条件下，最大随机性分布是均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯分布。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right)}$$", "id": "1963846"}]}