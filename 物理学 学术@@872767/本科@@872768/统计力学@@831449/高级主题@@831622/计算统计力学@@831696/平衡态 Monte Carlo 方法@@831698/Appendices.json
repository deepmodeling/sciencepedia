{"hands_on_practices": [{"introduction": "在我们模拟一个系统如何演化之前，我们必须首先能够描述它的状态。在许多物理模型中，例如伊辛模型，状态由其总能量定义。第一个练习 [@problem_id:1964969] 提供了一个具体的、动手的计算，用于计算特定自旋构型的能量，从而巩固哈密顿量、最近邻相互作用和周期性边界条件等概念。", "problem": "考虑一个 3x3 方形晶格上的二维伊辛模型。每个晶格位置 $i$ 上都有一个自旋 $s_i$，其值可以为 +1 (自旋向上) 或 -1 (自旋向下)。一个自旋构型的总能量 $E$ 由哈密顿量 $E = -J \\sum_{\\langle i,j \\rangle} s_i s_j$ 给出，其中 $J$ 是一个正的铁磁耦合常数，求和是对所有唯一的最近邻自旋对进行的。\n\n该系统采用周期性边界条件。这意味着晶格呈环形面状卷绕：最右边的自旋列被视为最左边列的最近邻，最下方的自旋行被视为最上方行的最近邻。\n\n一个特定的自旋构型如下所示，从上到下逐行描述，每行内的自旋从左到右列出：\n- 第1行：+1, -1, +1\n- 第2行：+1, +1, -1\n- 第3行：-1, +1, -1\n\n计算这个特定构型的总能量 $E$。你的答案应表示为以耦合常数 $J$ 为单位的单个数值。", "solution": "哈密顿量为 $E=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$，其中求和遍历所有唯一的最近邻键。在一个具有周期性边界条件的 $3\\times 3$ 方形晶格上，有 $2L^{2}=18$ 个唯一的键：$9$ 个水平键和 $9$ 个垂直键。\n\n用 $s_{r,c}$ 标记自旋，其中 $r,c\\in\\{1,2,3\\}$，并使用给定的构型：\n$s_{1,1}=+1$, $s_{1,2}=-1$, $s_{1,3}=+1$;\n$s_{2,1}=+1$, $s_{2,2}=+1$, $s_{2,3}=-1$;\n$s_{3,1}=-1$, $s_{3,2}=+1$, $s_{3,3}=-1$.\n\n逐行计算水平键的总和，利用每行内的周期性：\n$H_{1}=s_{1,1}s_{1,2}+s_{1,2}s_{1,3}+s_{1,3}s_{1,1}=(+1)(-1)+(-1)(+1)+(+1)(+1)=-1$,\n$H_{2}=s_{2,1}s_{2,2}+s_{2,2}s_{2,3}+s_{2,3}s_{2,1}=(+1)(+1)+(+1)(-1)+(-1)(+1)=-1$,\n$H_{3}=s_{3,1}s_{3,2}+s_{3,2}s_{3,3}+s_{3,3}s_{3,1}=(-1)(+1)+(+1)(-1)+(-1)(-1)=-1$.\n因此 $\\sum_{\\text{水平}}s_{i}s_{j}=H_{1}+H_{2}+H_{3}=-3$。\n\n逐列计算垂直键的总和，利用每列内的周期性：\n$V_{1}=s_{1,1}s_{2,1}+s_{2,1}s_{3,1}+s_{3,1}s_{1,1}=(+1)(+1)+(+1)(-1)+(-1)(+1)=-1$,\n$V_{2}=s_{1,2}s_{2,2}+s_{2,2}s_{3,2}+s_{3,2}s_{1,2}=(-1)(+1)+(+1)(+1)+(+1)(-1)=-1$,\n$V_{3}=s_{1,3}s_{2,3}+s_{2,3}s_{3,3}+s_{3,3}s_{1,3}=(+1)(-1)+(-1)(-1)+(-1)(+1)=-1$.\n因此 $\\sum_{\\text{垂直}}s_{i}s_{j}=V_{1}+V_{2}+V_{3}=-3$。\n\n所以，最近邻总和为\n$$\n\\sum_{\\langle i,j\\rangle}s_{i}s_{j}=(-3)+(-3)=-6,\n$$\n能量为\n$$\nE=-J\\left(-6\\right)=6J.\n$$\n以 $J$ 为单位表示，这得到 $E/J=6$。", "answer": "$$\\boxed{6}$$", "id": "1964969"}, {"introduction": "在学会计算总能量之后，蒙特卡罗模拟的下一步是提出对系统的微小改变——一次“试探性移动”。Metropolis 算法的效率取决于局部计算能量的*变化*（$ΔE$），而无需重新计算整个系统的能量。这个实践问题 [@problem_id:1964946] 侧重于这个关键步骤，演示了如何计算单次自旋翻转的 $ΔE$，这是模拟伊辛模型的核心操作。", "problem": "考虑一个一维 (1D) 经典伊辛模型，该模型由一条包含 $N=8$ 个自旋的链组成，标记为 $s_1, s_2, \\dots, s_8$。每个自旋 $s_i$ 的取值可以是 $+1$ (上) 或 $-1$ (下)。该系统服从周期性边界条件，这意味着自旋 $s_8$ 被视为自旋 $s_1$ 的最近邻。系统的总能量，即哈密顿量，由下式给出：\n$$H = -J \\sum_{\\langle i,j \\rangle} s_i s_j$$\n其中 $J$ 是一个正的常数，代表铁磁相互作用强度，求和遍及所有唯一的最近邻对。\n\n假设系统初始处于由以下序列描述的特定微观构型：\n$$s = (+1, -1, +1, -1, +1, -1, +1, -1)$$\n其中序列中的第 $i$ 个元素对应于自旋 $s_i$ 的状态。现提出一次单自旋翻转，其中只有自旋 $s_1$ 从其初始状态翻转到相反状态，而所有其他自旋（$s_2$ 到 $s_8$）保持不变。\n\n由于这次单自旋翻转，系统的总能量变化 $\\Delta E = E_{\\text{final}} - E_{\\text{initial}}$ 是多少？\n\nA. $4J$\n\nB. $2J$\n\nC. $0$\n\nD. $-2J$\n\nE. $-4J$", "solution": "哈密顿量为 $H=-J\\sum_{\\langle i,j\\rangle}s_{i}s_{j}$，且具有周期性边界条件，因此在翻转 $s_{1}$ 时，只有涉及 $s_{1}$ 的两个键，即 $(8,1)$ 和 $(1,2)$，会发生变化。所有其他键的贡献在能量差中相互抵消。\n\n这两个键的初始局域能量为\n$$\nE_{\\text{initial, local}}=-J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\n将 $s_{1}\\to -s_{1}$ 翻转后，最终的局域能量为\n$$\nE_{\\text{final, local}}=-J\\left(s_{8}(-s_{1})+(-s_{1})s_{2}\\right)=J\\left(s_{8}s_{1}+s_{1}s_{2}\\right).\n$$\n因此，总能量的变化为\n$$\n\\Delta E=E_{\\text{final}}-E_{\\text{initial}}=E_{\\text{final, local}}-E_{\\text{initial, local}}=2J\\left(s_{8}s_{1}+s_{1}s_{2}\\right)=2J\\,s_{1}\\left(s_{8}+s_{2}\\right).\n$$\n对于给定的构型，有 $s_{1}=+1$，$s_{2}=-1$ 和 $s_{8}=-1$，所以\n$$\n\\Delta E=2J\\cdot(+1)\\cdot\\left((-1)+(-1)\\right)=-4J.\n$$\n这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "1964946"}, {"introduction": "一旦知道了能量变化 $ΔE$，我们必须根据 Metropolis 准则决定是否接受这次试探性移动。虽然该规则看似有两部分（一部分用于能量降低的移动，另一部分用于能量增加的移动），但它可以通过一行简洁的代码来实现。最后一个练习 [@problem_id:1964945] 探讨了这种实现背后的逻辑，确保您理解为什么它能正确处理所有情况并满足细致平衡原理。", "problem": "一名学生Alex正在为一个简单的二维格点气体模型编写一个Metropolis蒙特卡罗模拟。在这个模型中，粒子占据网格上的格点，系统的总能量 $E$ 是根据相邻粒子间的相互作用计算的。模拟的目标是在给定温度 $T$ 下从正则系综中抽样构型。\n\nAlex的模拟是分步进行的。在每一步中，会提出一个试探性移动（例如，将单个粒子移动到随机的相邻空格点）。设当前构型的能量为 $E_{old}$，提议的新构型的能量为 $E_{new}$。能量变化为 $\\Delta E = E_{new} - E_{old}$。\n\nAlex用下面这行伪代码实现了核心的接受/拒绝逻辑，其中 `rand()` 是一个返回区间 $[0, 1)$ 内均匀分布的随机浮点数的函数。如果条件为真，则接受该移动。\n\n`if rand()  exp(-ΔE / (k_B * T))`\n\n这里，$k_B$ 是玻尔兹曼常数。Alex运行模拟后发现系统似乎正在达到一个合理的平衡态。然而，他们担心的是，他们的代码没有包含一个显式的 `if/else` 结构来区分增加能量的移动（$\\Delta E  0$）和减少能量的移动（$\\Delta E \\le 0$），而这正是他们教科书中介绍该算法的方式。\n\n下列哪个陈述对Alex的实现给出了最准确的分析？\n\nA. 代码存在根本性缺陷，因为它永远不会接受降低系统能量的移动（$\\Delta E \\le 0$）。\n\nB. 代码存在根本性缺陷，因为它会接受所有提议的移动，无论能量如何变化，从而阻止系统达到热平衡。\n\nC. 代码能正常工作，因为对于任何降低能量的移动（$\\Delta E \\le 0$），项 $\\exp(-\\Delta E / (k_B T))$ 的计算结果将大于或等于1，从而确保接受条件总是被满足。\n\nD. 代码仅在高温极限下（$k_B T \\gg |\\Delta E|$）是正确的，此时指数项可以近似为1，但在低温下会失效。\n\nE. 代码存在根本性缺陷，因为它没有以1的接受概率显式处理 $\\Delta E \\le 0$ 的情况，从而违反了细致平衡原理。", "solution": "令 $\\beta$ 表示逆温度，$\\beta = \\frac{1}{k_{B}T}$。在具有对称提议分布的Metropolis算法中，确保从正则系综中抽样并满足细致平衡的接受概率是\n$$\nA(\\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\nAlex的代码在均匀随机变量 $r \\sim \\text{Uniform}[0,1)$ 满足以下条件时接受该移动\n$$\nr  \\exp(-\\beta \\Delta E).\n$$\n此规则实现的接受概率是事件 $\\{r  \\exp(-\\beta \\Delta E)\\}$ 发生的关于 $r$ 的概率。由于 $r$ 在 $[0,1)$ 上是均匀分布的，\n$$\nP(\\text{accept}) = \\int_{0}^{1} \\mathbf{1}\\{r  \\exp(-\\beta \\Delta E)\\} \\, dr.\n$$\n这个积分根据 $\\exp(-\\beta \\Delta E)$ 相对于 $1$ 的值分段计算：\n\n1) 如果 $\\Delta E \\le 0$，那么 $-\\beta \\Delta E \\ge 0$，因此\n$$\n\\exp(-\\beta \\Delta E) \\ge 1.\n$$\n因为 $r \\in [0,1)$ 并且 $\\exp(-\\beta \\Delta E) \\ge 1$，不等式 $r  \\exp(-\\beta \\Delta E)$ 对所有在 $[0,1)$ 内的 $r$ 都成立。因此，\n$$\nP(\\text{accept}) = 1 = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\n特别地，当 $\\Delta E = 0$ 时，$\\exp(0) = 1$，并且由于对于 $r \\in [0,1)$ 来说 $r  1$ 几乎必然成立，所以接受以概率 $1$ 发生，这符合要求。\n\n2) 如果 $\\Delta E  0$，那么 $-\\beta \\Delta E  0$，因此\n$$\n\\exp(-\\beta \\Delta E)  1,\n$$\n并且事件 $\\{r  \\exp(-\\beta \\Delta E)\\}$ 发生的概率恰好是 $\\exp(-\\beta \\Delta E)$，因为区间 $\\{r \\in [0,1) : r  \\exp(-\\beta \\Delta E)\\}$ 的长度是 $\\exp(-\\beta \\Delta E)$。因此，\n$$\nP(\\text{accept}) = \\exp(-\\beta \\Delta E) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right).\n$$\n\n综合这两种情况，\n$$\nP(\\text{accept}) = \\min\\!\\left(1,\\exp(-\\beta \\Delta E)\\right),\n$$\n这恰好是为对称提议强制执行细致平衡的Metropolis接受准则。因此，Alex的单行条件隐式地实现了 $\\min$ 操作，因为 $r$ 被限制在 $[0,1)$ 区间内。它以概率 $1$ 接受所有降低能量或能量不变的移动，并以概率 $\\exp(-\\beta \\Delta E)$ 接受增加能量的移动。因此：\n- 降低能量的移动不会被拒绝（排除A）。\n- 它不接受所有的移动（排除B）。\n- 它不局限于高温区（排除D）。\n- 它不违反细致平衡；正确的接受概率得以实现（排除E）。\n\n因此，最准确的陈述是，代码在所有温度下都能正常工作，因为当 $\\Delta E \\le 0$ 时，$\\exp(-\\Delta E/(k_{B}T)) \\ge 1$ 确保了接受，而当 $\\Delta E  0$ 时，它产生了正确的概率性接受。", "answer": "$$\\boxed{C}$$", "id": "1964945"}]}