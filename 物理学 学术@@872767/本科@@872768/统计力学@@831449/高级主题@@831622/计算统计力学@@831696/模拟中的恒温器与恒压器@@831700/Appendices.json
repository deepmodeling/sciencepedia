{"hands_on_practices": [{"introduction": "在分子动力学模拟中，控制温度是一项基本任务，以确保系统能够模拟恒温（NVT）或恒温恒压（NPT）系综。Berendsen恒温器是一种直观且广泛使用的方法，它通过将系统与一个具有目标温度 $T_0$ 的外部热浴弱耦合来实现这一点。这个练习将让您亲手计算温度校正的幅度，从而具体地理解耦合时间常数 $\\tau_T$ 是如何影响系统温度向目标值弛豫的速率的。[@problem_id:2013279]", "problem": "在分子动力学 (MD) 模拟中，恒温器是用于控制模拟体系温度的一种算法。一种常见的方法是 Berendsen 恒温器，它将体系与一个具有固定目标温度 $T_0$ 的外部热浴弱耦合。这是通过在每个时间步长 $\\Delta t$ 内，用一个公共因子 $\\lambda$ 来重新标定所有粒子的速度来实现的。\n\n体系的温度与其总动能成正比。因此，将速度重新标定 $\\lambda$ 会使动能改变 $\\lambda^2$，从而温度也相应地被标定了 $\\lambda^2$。标度因子通过以下公式计算：\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T} - 1 \\right) $$\n其中，$T$ 是时间步长开始时体系的瞬时温度，而 $\\tau_T$ 是时间耦合常数，它决定了体系温度向目标温度弛豫的速度。较小的 $\\tau_T$ 意味着与热浴的耦合更强，温度弛豫更快。\n\n一位研究人员正在模拟一个氩原子体系。在模拟的某个特定时刻，测得体系的温度为 $T = 360.0 \\text{ K}$。目标温度设置为 $T_0 = 300.0 \\text{ K}$，模拟时间步长为 $\\Delta t = 2.0 \\text{ fs}$。作为参考，1 皮秒 (ps) = 1000 飞秒 (fs)。\n\n该研究人员想了解耦合常数的选择如何影响温度的演化。他们考虑了两种情形：“强”耦合，$\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$；以及“弱”耦合，$\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$。计算在强耦合和弱耦合两种情形下，经过一个时间步长后体系的预期温度 $T(t+\\Delta t)$。\n\n以下哪个选项正确给出了温度对 $(T_{\\text{strong}}(t+\\Delta t), T_{\\text{weak}}(t+\\Delta t))$？所有温度都以开尔文 (K) 为单位。\n\nA. (359.7 K, 359.97 K)\n\nB. (360.3 K, 360.03 K)\n\nC. (300.0 K, 300.0 K)\n\nD. (363.0 K, 360.3 K)\n\nE. (357.0 K, 359.7 K)", "solution": "问题要求计算在两种不同的恒温器耦合常数 $\\tau_T^{\\text{strong}}$ 和 $\\tau_T^{\\text{weak}}$ 下，体系在单个时间步长后的温度 $T(t+\\Delta t)$。\n\n新时间步长的温度 $T(t+\\Delta t)$ 是通过将当前温度 $T(t)$ 乘以 Berendsen 标度因子 $\\lambda^2$ 得到的。\n$$ T(t+\\Delta t) = \\lambda^2 T(t) $$\n标度因子的公式如下：\n$$ \\lambda^2 = 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\n将 $\\lambda^2$ 的表达式代入温度更新方程，我们得到：\n$$ T(t+\\Delta t) = T(t) \\left[ 1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) \\right] $$\n这个表达式可以通过展开 $T(t)$ 来简化：\n$$ T(t+\\Delta t) = T(t) + T(t) \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} \\left( T(t) \\frac{T_0}{T(t)} - T(t) \\right) $$\n$$ T(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T} (T_0 - T(t)) $$\n这个简化后的公式可以直接从温差计算出新的温度。我们现在将使用这个公式和给定的参数进行计算。\n\n给定的参数如下：\n当前温度, $T(t) = 360.0 \\text{ K}$\n目标温度, $T_0 = 300.0 \\text{ K}$\n时间步长, $\\Delta t = 2.0 \\text{ fs}$\n\n我们需要确保时间单位的一致性。给定的 $\\tau_T$ 单位是皮秒 (ps)，$\\Delta t$ 的单位是飞秒 (fs)。我们使用转换关系 1 ps = 1000 fs。\n因此，$\\Delta t = 2.0 \\text{ fs} = 0.0020 \\text{ ps}$。\n\n**情形 1：强耦合**\n对于强耦合情形，$\\tau_T^{\\text{strong}} = 0.4 \\text{ ps}$。\n首先，我们计算无量纲比率 $\\frac{\\Delta t}{\\tau_T^{\\text{strong}}}$：\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} = \\frac{0.0020 \\text{ ps}}{0.4 \\text{ ps}} = 0.005 $$\n现在，我们计算下一步的温度 $T_{\\text{strong}}(t+\\Delta t)$：\n$$ T_{\\text{strong}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{strong}}} (T_0 - T(t)) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} + 0.005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 360.0 \\text{ K} - 0.3 \\text{ K} $$\n$$ T_{\\text{strong}}(t+\\Delta t) = 359.7 \\text{ K} $$\n\n**情形 2：弱耦合**\n对于弱耦合情形，$\\tau_T^{\\text{weak}} = 4.0 \\text{ ps}$。\n首先，我们计算无量纲比率 $\\frac{\\Delta t}{\\tau_T^{\\text{weak}}}$：\n$$ \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} = \\frac{0.0020 \\text{ ps}}{4.0 \\text{ ps}} = 0.0005 $$\n现在，我们计算下一步的温度 $T_{\\text{weak}}(t+\\Delta t)$：\n$$ T_{\\text{weak}}(t+\\Delta t) = T(t) + \\frac{\\Delta t}{\\tau_T^{\\text{weak}}} (T_0 - T(t)) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (300.0 \\text{ K} - 360.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} + 0.0005 \\times (-60.0 \\text{ K}) $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 360.0 \\text{ K} - 0.03 \\text{ K} $$\n$$ T_{\\text{weak}}(t+\\Delta t) = 359.97 \\text{ K} $$\n\n计算出的温度对是 $(359.7 \\text{ K}, 359.97 \\text{ K})$。这对应于选项 A。正如预期的那样，更强的耦合（较小的 $\\tau_T$）在单步内导致了更大的温度变化，使体系的温度更快地向目标温度移动。", "answer": "$$\\boxed{A}$$", "id": "2013279"}, {"introduction": "学习了如何使用算法控制温度后，理解其潜在的陷阱也同样重要。著名的“飞行冰块”效应是一个经典的警示案例，它揭示了当一个恒温器虽然能够保持总动能恒定，但却无法保证能量在所有自由度之间正确分配时会发生什么。这个思想实验将帮助您理解能量均分原理的重要性，以及为何需要比简单地保持总动能恒定更复杂的恒温算法。[@problem_id:2013248]", "problem": "对一个由$N$个质量均为$m$的全同无相互作用粒子组成的系统进行分子动力学模拟。该模拟采用一个原始恒温器，严格强制系统的总动能保持恒定。初始时（$t=0$），粒子分布对应于温度为$T_0$的热平衡状态，且整个系统的质心是静止的。由于恒温器算法固有的数值误差，系统演化到一个被称为“飞行的冰块”的非物理状态。在这个最终的极端状态下，所有粒子间的相对运动都已停止，它们作为一个单一的刚体一起运动。系统的总动能与其初始值相同。确定系统质心的最终速率。用$m$、$T_0$和玻尔兹曼常数$k_B$表示你的答案。", "solution": "设粒子速度为$\\{\\mathbf{v}_{i}\\}_{i=1}^{N}$，每个粒子的质量为$m$。总动能为\n$$\nK=\\sum_{i=1}^{N}\\frac{1}{2}m|\\mathbf{v}_{i}|^{2}.\n$$\n对于在三维空间中处于温度$T_{0}$热平衡状态的$N$个无相互作用的点粒子，根据能量均分定理可得\n$$\nK=\\frac{3}{2}N k_{B}T_{0}.\n$$\n原始恒温器强制$K$保持其初始值不变，因此在之后的所有时刻，总动能也为$K=\\frac{3}{2}N k_{B}T_{0}$。\n\n在最终的“飞行的冰块”状态下，所有相对运动都已停止，所有粒子以相同的速度$\\mathbf{V}_{\\mathrm{cm}}$一起运动。系统表现为一个总质量为$M=Nm$的刚体，因此其动能纯粹是质心平动能：\n$$\nK=\\frac{1}{2}M|\\mathbf{V}_{\\mathrm{cm}}|^{2}=\\frac{1}{2}(Nm)V_{\\mathrm{cm}}^{2}.\n$$\n将此与守恒的动能相等，\n$$\n\\frac{1}{2}(Nm)V_{\\mathrm{cm}}^{2}=\\frac{3}{2}N k_{B}T_{0},\n$$\n解出$V_{\\mathrm{cm}}$可得\n$$\nm V_{\\mathrm{cm}}^{2}=3 k_{B}T_{0}\\quad\\Rightarrow\\quad V_{\\mathrm{cm}}=\\sqrt{\\frac{3 k_{B}T_{0}}{m}}.\n$$\n这个结果与$N$无关。", "answer": "$$\\boxed{\\sqrt{\\frac{3 k_{B} T_{0}}{m}}}$$", "id": "2013248"}, {"introduction": "除了温度，压力是另一个在模拟中需要精确控制的关键热力学变量，尤其是在模拟相变或在恒定大气压下进行的实验时。Parrinello-Rahman压力控制器通过将模拟盒的体积（或晶格矢量）视为一个动态变量来响应内外部压力的失衡。通过这个练习，您将推导模拟盒体积振荡的频率，从而探索控制参数“活塞质量” $W$ 与系统物理响应之间的关系。[@problem_id:2013246]", "problem": "在许多分子动力学模拟中，系统使用恒压器维持在恒定压力下，恒压器会动态地调节模拟盒子的体积。其中一种受 Parrinello-Rahman 方法启发的方法，将盒子体积 $V$ 建模为一个具有相关“活塞质量”$W$ 的动力学变量。对于一个处于各向同性NPT（粒子数、压力和温度恒定）系综中的系统，围绕平衡体积 $V_0$ 的体积微小涨落 $\\delta V(t) = V(t) - V_0$ 的有效运动方程可以写为：\n$$W \\frac{d^2(\\delta V)}{dt^2} = P_{int}(V) - P_{ext}$$\n其中 $P_{ext}$ 是目标外部压力，$P_{int}(V)$ 是系统的瞬时内部压力。对于平衡点附近的微小偏离，内部压力可以近似地在其平衡值附近进行线性展开：\n$$P_{int}(V) \\approx P_{int}(V_0) - \\frac{1}{V_0 \\kappa_T} (V - V_0)$$\n在平衡状态下，平均内部压力等于外部压力，即 $P_{int}(V_0) = P_{ext}$。参数 $\\kappa_T$ 是被模拟物质的等温压缩率。\n\n假设体积涨落的行为像一个简谐振子，推导这些涨落的特征角频率 $\\omega$ 的表达式。用活塞质量 $W$、平衡体积 $V_0$ 和等温压缩率 $\\kappa_T$ 来表示你的答案。", "solution": "我们从给定的关于小体积涨落 $\\delta V(t)=V(t)-V_{0}$ 的恒压器运动方程开始：\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} = P_{int}(V) - P_{ext}.\n$$\n对于围绕 $V_{0}$ 的微小偏离，内部压力可线性近似为\n$$\nP_{int}(V) \\approx P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}(V - V_{0}) = P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}\\delta V.\n$$\n在平衡时有 $P_{int}(V_{0}) = P_{ext}$，因此代入运动方程得到\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} = \\left[P_{int}(V_{0}) - \\frac{1}{V_{0}\\kappa_{T}}\\delta V\\right] - P_{ext} = - \\frac{1}{V_{0}\\kappa_{T}}\\delta V.\n$$\n整理后，我们得到简谐振子形式\n$$\nW \\frac{d^{2}(\\delta V)}{dt^{2}} + \\frac{1}{V_{0}\\kappa_{T}}\\,\\delta V = 0,\n$$\n该方程与 $m \\ddot{x} + k x = 0$ 的形式相符，其中等效质量 $m = W$，弹性系数 $k = \\frac{1}{V_{0}\\kappa_{T}}$。因此，特征角频率为\n$$\n\\omega = \\sqrt{\\frac{k}{m}} = \\sqrt{\\frac{1}{W V_{0} \\kappa_{T}}}.\n$$", "answer": "$$\\boxed{\\sqrt{\\frac{1}{W V_{0} \\kappa_{T}}}}$$", "id": "2013246"}]}