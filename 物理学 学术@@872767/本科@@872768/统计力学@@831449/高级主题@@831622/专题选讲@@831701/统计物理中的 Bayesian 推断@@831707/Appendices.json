{"hands_on_practices": [{"introduction": "第一个练习是贝叶斯推理的一个典型例子。我们从关于系统温度的先验信念开始，利用单次测量——一个发射光子的频率——来更新该信念。这个问题 [@problem_id:1949232] 直接阐明了贝叶斯定理如何根据新证据，定量地调整我们对相互竞争的假设的信心。", "problem": "一位研究人员正在研究一个完美近似于黑体辐射体的热腔。他们不确定其真实平衡温度 $T$。在进行任何测量之前，该研究人员考虑了关于该温度的两种竞争性假设，$T_A$ 和 $T_B$。他们对这些假设的初始评估由其概率之比 $P(T_A)/P(T_B) = R$ 来量化。\n\n为了获取更多信息，该研究人员使用高灵敏度光谱仪来探测从腔上的一个孔径中发出的单个光子。该光子的频率被精确测量为 $\\nu_0$。从温度为 $T$ 的黑体中探测到频率为 $\\nu$ 的光子的单位时间概率，与腔内光子的谱数密度 $n(\\nu, T)$ 成正比。$n(\\nu, T)$ 的形式由普朗克分布确定。\n\n基于这次单光子测量提供的证据，两种温度的新的、更新后的概率比 $P(T_A | \\text{data}) / P(T_B | \\text{data})$ 是多少？其中数据指的是观测到频率为 $\\nu_0$ 的光子。请用 $R$、$T_A$、$T_B$、$\\nu_0$、普朗克常数 $h$ 和玻尔兹曼常数 $k_B$ 来表示你的答案的符号表达式。", "solution": "给定两个温度假设 $T_{A}$ 和 $T_{B}$，其先验优势比为 $P(T_{A})/P(T_{B})=R$。从腔中观测到一个频率为 $\\nu_{0}$ 的光子后，根据优势比形式的贝叶斯定理可得\n$$\n\\frac{P(T_{A}\\,|\\,\\text{data})}{P(T_{B}\\,|\\,\\text{data})}\n= \\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}\\,\\frac{P(T_{A})}{P(T_{B})}\n= R \\,\\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}.\n$$\n问题指出，探测到频率为 $\\nu$ 的光子的单位时间概率与腔内光子的谱数密度 $n(\\nu,T)$ 成正比。对于黑体，谱数密度由普朗克分布给出\n$$\nn(\\nu,T)=\\frac{8\\pi \\nu^{2}}{c^{3}}\\frac{1}{\\exp\\!\\left(\\frac{h\\nu}{k_{B}T}\\right)-1}.\n$$\n将在某个固定的（仪器的）带宽和时间窗口内测量到频率为 $\\nu_{0}$ 的光子这一事件进行解释，温度 $T$ 的似然与 $n(\\nu_{0},T)$ 乘以不依赖于 $T$ 的常数成正比，这些常数在求比值时会被消去。因此，\n$$\n\\frac{P(\\text{data}\\,|\\,T_{A})}{P(\\text{data}\\,|\\,T_{B})}\n=\\frac{n(\\nu_{0},T_{A})}{n(\\nu_{0},T_{B})}\n=\\frac{\\dfrac{8\\pi \\nu_{0}^{2}}{c^{3}}\\dfrac{1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}}\n{\\dfrac{8\\pi \\nu_{0}^{2}}{c^{3}}\\dfrac{1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}}\n=\\frac{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}.\n$$\n将此结果代入优势比更新公式，得到\n$$\n\\frac{P(T_{A}\\,|\\,\\text{data})}{P(T_{B}\\,|\\,\\text{data})}\n= R \\,\\frac{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h\\nu_{0}}{k_{B}T_{A}}\\right)-1}.\n$$\n这就将后验优势比完全用 $R$、$T_{A}$、$T_{B}$、$\\nu_{0}$、$h$ 和 $k_{B}$ 表示了出来，符合题目要求。", "answer": "$$\\boxed{R\\,\\frac{\\exp\\!\\left(\\frac{h \\nu_{0}}{k_{B} T_{B}}\\right)-1}{\\exp\\!\\left(\\frac{h \\nu_{0}}{k_{B} T_{A}}\\right)-1}}$$", "id": "1949232"}, {"introduction": "在之前例子的基础上，这个练习从一个简单的双假设检验转向一个模型比较问题。我们有几个关于系统内部结构（其能级简并度）的竞争模型，我们必须决定哪个模型最受实验数据支持。这个实践 [@problem_id:1949277] 演示了如何使用贝叶斯推断，不仅可以更新关于参数的信念，还可以在一组候选者中选择最合理的物理模型。", "problem": "一位材料科学家正在研究一种新合成的绝缘晶体。该晶体中原子的量子力学行为可以建模为一个由 $N=10$ 个独立、可区分的实体组成的系统。每个实体可以处于两个能级之一：能量为 $E_0=0$、简并度为 $g_0=1$ 的基态，或者能量为 $E_1=\\epsilon$、简并度为未知整数 $g$ 的激发态。\n\n基于理论考虑，该科学家提出了关于激发态简并度的三个竞争性假设：$H_1: g=1$，$H_2: g=2$ 和 $H_3: g=3$。在进行任何测量之前，她假设这三个假设是等概率的。\n\n该晶体与恒温 $T$ 的热浴达到热平衡。温度 $T$ 使得无量纲项 $\\frac{\\epsilon}{k_B T}$ 恰好等于 $\\ln(2)$，其中 $k_B$ 是玻尔兹曼常数。然后，一种先进的成像技术使得科学家能够同时确定 $N=10$ 个实体中每一个的能态。该测量显示，恰好有 $k=4$ 个实体处于激发态。\n\n给定这个实验结果，进行贝叶斯分析来更新这三个假设的概率。令 $P(g=1|D)$、$P(g=2|D)$ 和 $P(g=3|D)$ 表示在给定数据 $D$（即观察到 $k=4$ 个实体被激发）的情况下，这些假设的后验概率。下列哪项正确描述了这些后验概率之间的关系？\n\nA. $P(g=1|D) > P(g=2|D) > P(g=3|D)$\n\nB. $P(g=2|D) > P(g=1|D) > P(g=3|D)$\n\nC. $P(g=3|D) > P(g=2|D) > P(g=1|D)$\n\nD. $P(g=1|D) = P(g=2|D)  P(g=3|D)$\n\nE. $P(g=2|D) > P(g=3|D) > P(g=1|D)", "solution": "对于在温度 $T$ 下处于热平衡的单个实体，定义 $\\beta \\equiv \\frac{1}{k_{B}T}$。单个实体的配分函数是\n$$\nZ_{1}=g_{0}\\exp(-\\beta E_{0})+g\\exp(-\\beta E_{1})=1+g\\exp(-\\beta\\epsilon).\n$$\n因此，单个实体的激发概率是\n$$\np(g)=\\frac{g\\exp(-\\beta\\epsilon)}{1+g\\exp(-\\beta\\epsilon)}.\n$$\n给定 $\\frac{\\epsilon}{k_{B}T}=\\ln(2)$，我们有 $\\beta\\epsilon=\\ln(2)$，因此 $\\exp(-\\beta\\epsilon)=\\exp(-\\ln 2)=\\frac{1}{2}$。所以\n$$\np(g)=\\frac{g\\left(\\frac{1}{2}\\right)}{1+g\\left(\\frac{1}{2}\\right)}=\\frac{g}{g+2},\\quad 1-p(g)=\\frac{2}{g+2}.\n$$\n\n对于 $N=10$ 个独立、可区分的实体，观察到恰好有 $k=4$ 个被激发的概率（即似然函数）服从二项分布：\n$$\nP(D\\mid g)=\\binom{10}{4}\\left[p(g)\\right]^{4}\\left[1-p(g)\\right]^{6}=\\binom{10}{4}\\left(\\frac{g}{g+2}\\right)^{4}\\left(\\frac{2}{g+2}\\right)^{6}.\n$$\n\n三个假设 $H_{1}:g=1$、$H_{2}:g=2$、$H_{3}:g=3$ 具有相等的先验概率 $P(H_{i})=\\frac{1}{3}$。根据贝叶斯定理，后验概率 $P(g\\mid D)\\propto P(D\\mid g)P(g)$。由于先验概率相等，后验概率的排序与似然 $P(D|g)$ 的排序一致。我们只需比较三个假设下的似然值，忽略公共因子 $\\binom{10}{4}$：\n\n-   对于 $g=1$：似然函数正比于 $L_1 = (\\frac{1}{3})^4 (\\frac{2}{3})^6 = \\frac{2^6}{3^{10}} = \\frac{64}{59049}$。\n-   对于 $g=2$：似然函数正比于 $L_2 = (\\frac{2}{4})^4 (\\frac{2}{4})^6 = (\\frac{1}{2})^{10} = \\frac{1}{1024}$。\n-   对于 $g=3$：似然函数正比于 $L_3 = (\\frac{3}{5})^4 (\\frac{2}{5})^6 = \\frac{3^4 \\cdot 2^6}{5^{10}} = \\frac{5184}{9765625}$。\n\n现在比较这些似然值的大小。\n-   比较 $L_1$ 与 $L_2$：$\\frac{L_2}{L_1} = \\frac{1/1024}{64/59049} = \\frac{59049}{64 \\times 1024} = \\frac{59049}{65536}  1$，因此 $L_1 > L_2$。\n-   比较 $L_2$ 与 $L_3$：$\\frac{L_3}{L_2} = \\frac{5184/9765625}{1/1024} = \\frac{5184 \\times 1024}{9765625} \\approx 0.54  1$，因此 $L_2 > L_3$。\n\n综上所述，我们有 $L_1 > L_2 > L_3$。由于先验概率相等，后验概率的排序与此一致，即 $P(g=1|D) > P(g=2|D) > P(g=3|D)$。", "answer": "$$\\boxed{A}$$", "id": "1949277"}, {"introduction": "我们的最终实践将从离散假设转向连续参数的估计，这是实验物理学中的一项常见任务。通过观察一个小型量子系统的精确微观状态，我们可以推断出它所连接的大型粒子库的一个性质——化学势。这个问题 [@problem_id:1949268] 介绍了最大后验（MAP）估计这一强大技术，它使我们能够在给定数据的情况下，找到参数最可能的值。", "problem": "一个纳米级的量子点被设计用作量子计算电路中的一个组件。该量子点可以被建模为一个系统，其中电子可以占据两个不同的单粒子能级：能量为 $\\epsilon_0$ 的基态和能量为 $\\epsilon_1$ 的激发态。由于强的库仑排斥和泡利不相容原理，该量子点最多可以容纳两个电子，每个能级一个。\n\n该量子点与一个大的电子库相连，电子库使其保持在恒定的温度 $T$ 和化学势 $\\mu$。玻尔兹曼常数用 $k_B$ 表示。\n\n对该量子点进行了一次实验测量，发现其中恰好含有一个电子，该电子占据基态能级 $\\epsilon_0$。在这次测量之前，对于在一个非常宽的物理上合理的取值范围内的化学势 $\\mu$ 没有偏好的值。这种先验知识最好用均匀概率分布来描述。\n\n根据这次单一的实验观察，确定化学势 $\\mu$ 的最可能值。该值被称为最大后验 (MAP) 估计。请用 $\\epsilon_0$ 和 $\\epsilon_1$ 的符号表达式表示您的答案。", "solution": "该量子点与温度为 $T$、化学势为 $\\mu$ 的粒子库交换粒子，因此每个构型 $(n_{0},n_{1})$（其中 $n_{i}\\in\\{0,1\\}$）的巨正则权重与 $\\exp\\!\\left(-\\beta(E-\\mu N)\\right)$ 成正比，这里 $\\beta=\\frac{1}{k_{B}T}$，$E=n_{0}\\epsilon_{0}+n_{1}\\epsilon_{1}$，$N=n_{0}+n_{1}$。允许的构型及其权重如下：\n- $(0,0)$: $E=0$, $N=0$, 权重 $w_{00}=1$。\n- $(1,0)$: $E=\\epsilon_{0}$, $N=1$, 权重 $w_{10}=\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)$。\n- $(0,1)$: $E=\\epsilon_{1}$, $N=1$, 权重 $w_{01}=\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)$。\n- $(1,1)$: $E=\\epsilon_{0}+\\epsilon_{1}$, $N=2$, 权重 $w_{11}=\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right)$。\n\n配分函数为\n$$\nZ= w_{00}+w_{10}+w_{01}+w_{11}\n=1+\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right).\n$$\n观测到构型（一个电子处于基态，即 $(1,0)$）的概率为\n$$\nP_{10}(\\mu)=\\frac{w_{10}}{Z}=\\frac{\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)}{1+\\exp\\!\\left(-\\beta(\\epsilon_{0}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{1}-\\mu)\\right)+\\exp\\!\\left(-\\beta(\\epsilon_{0}+\\epsilon_{1}-2\\mu)\\right)}.\n$$\n由于 $\\mu$ 在一个非常宽的范围内服从均匀先验分布，其后验概率正比于似然函数 $P_{10}(\\mu)$，因此 MAP 估计即使得 $P_{10}(\\mu)$ 最大化。引入\n$$\nx=\\exp(\\beta\\mu),\\quad a_{0}=\\exp(-\\beta\\epsilon_{0}),\\quad a_{1}=\\exp(-\\beta\\epsilon_{1}),\n$$\n于是\n$$\nP_{10}(x)=\\frac{a_{0}x}{1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}}.\n$$\n对 $x$ 求导：\n$$\n\\frac{dP_{10}}{dx}=\\frac{a_{0}\\left[1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}-x\\left((a_{0}+a_{1})+2a_{0}a_{1}x\\right)\\right]}{\\left(1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}\\right)^{2}}\n=\\frac{a_{0}\\left(1-a_{0}a_{1}x^{2}\\right)}{\\left(1+(a_{0}+a_{1})x+a_{0}a_{1}x^{2}\\right)^{2}}.\n$$\n令 $\\frac{dP_{10}}{dx}=0$ 可得 $1-a_{0}a_{1}x^{2}=0$，即\n$$\nx^{2}=\\frac{1}{a_{0}a_{1}}=\\exp\\!\\left(\\beta(\\epsilon_{0}+\\epsilon_{1})\\right).\n$$\n由于 $x0$，我们取 $x=\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)$，这意味着\n$$\n\\exp(\\beta\\mu)=\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)\\quad\\Rightarrow\\quad \\mu=\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}.\n$$\n导数的符号表明，当 $x\\exp\\!\\left(\\frac{\\beta}{2}(\\epsilon_{0}+\\epsilon_{1})\\right)$ 时 $P_{10}$ 增加，当 $x$ 更大时 $P_{10}$ 减少，因此该临界点是唯一的全局最大值点。因此，MAP 估计为\n$$\n\\mu_{\\text{MAP}}=\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}.\n$$", "answer": "$$\\boxed{\\frac{\\epsilon_{0}+\\epsilon_{1}}{2}}$$", "id": "1949268"}]}