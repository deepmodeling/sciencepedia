## 引言
在量子力学的世界里，精确求解薛定谔方程是理解系统行为的关键，但这只对少数理想化模型可行。对于原子、分子等绝大多数真实物理系统，复杂的相互作用使得精确求解成为不可能的任务。正是在这种背景下，[变分原理](@entry_id:198028) (The Variational Principle) 应运而生，它提供了一种强大而系统的近似方法，用以估算这些复杂系统的[基态能量](@entry_id:263704)，成为理论物理和[量子化学](@entry_id:140193)中不可或缺的工具。

本文旨在全面解析变分原理的理论精髓与实际应用。我们将从第一章“原理与机制”开始，深入探讨其核心数学论断和实施方法。接着，在第二章“应用与交叉学科联系”中，我们将通过一系列从原子物理到现代计算化学的实例，见证该原理如何将抽象理论转化为深刻的物理洞见。最后，在第三章“动手实践”部分，你将有机会通过具体计算来巩固和应用所学知识。

## 原理与机制

[变分原理](@entry_id:198028)是量子力学中一个极其强大的工具，它为那些因过于复杂而无法精确求解薛定谔方程的系统提供了一种估算其[基态能量](@entry_id:263704)的系统性方法。本章将深入探讨[变分法](@entry_id:163656)的核心原理、实际应用机制及其向[激发态](@entry_id:261453)的推广。

### 核心原理：基态能量的上限

变分原理的核心论断是：对于一个由[哈密顿算符](@entry_id:144286) $\hat{H}$ 描述的系统，其基态能量为 $E_0$。对于任意一个归一化的“[试探波函数](@entry_id:142892)” $|\psi\rangle$，其[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208) $\langle E \rangle$ 永远不会低于真实的[基态能量](@entry_id:263704) $E_0$。这一关系可以简洁地表示为：

$$ \langle E \rangle = \langle \psi | \hat{H} | \psi \rangle \geq E_0 $$

这个不等式之所以成立，其根源在于量子力学的一个基本假设：[哈密顿算符](@entry_id:144286)的本征态构成了一个完备的正交归一基。这意味着任何一个行为良好 (well-behaved) 的试探波函数 $|\psi\rangle$ 都可以被唯一地展开为这些[本征态](@entry_id:149904) $|\phi_n\rangle$（其对应的本征能量为 $E_n$）的线性叠加：

$$ |\psi\rangle = \sum_n c_n |\phi_n\rangle $$

其中 $c_n = \langle \phi_n | \psi \rangle$ 是展开系数。由于 $|\psi\rangle$ 是归一化的，我们有 $\langle \psi | \psi \rangle = \sum_n |c_n|^2 = 1$。现在，我们来计算能量的[期望值](@entry_id:153208)：

$$ \langle E \rangle = \langle \psi | \hat{H} | \psi \rangle = \left\langle \sum_m c_m \phi_m \middle| \hat{H} \middle| \sum_n c_n \phi_n \right\rangle = \sum_{m,n} c_m^* c_n \langle \phi_m | \hat{H} | \phi_n \rangle $$

利用 $\hat{H}|\phi_n\rangle = E_n|\phi_n\rangle$ 以及本征态的正交性 $\langle \phi_m | \phi_n \rangle = \delta_{mn}$，上式简化为：

$$ \langle E \rangle = \sum_{m,n} c_m^* c_n E_n \delta_{mn} = \sum_n |c_n|^2 E_n $$

这个表达式的物理意义非常清晰：对于一个任意态 $|\psi\rangle$，其[能量期望值](@entry_id:174035)是系统所有可能[能量本征值](@entry_id:144381) $E_n$ 的加权平均，权重为系统处于相应[本征态](@entry_id:149904) $|\phi_n\rangle$ 的概率 $|c_n|^2$。由于 $E_0$ 是所有[能量本征值](@entry_id:144381)中的最小值（即 $E_n \ge E_0$ 对所有 $n$ 成立），我们可以得到：

$$ \langle E \rangle = \sum_n |c_n|^2 E_n \geq \sum_n |c_n|^2 E_0 = E_0 \left( \sum_n |c_n|^2 \right) = E_0 $$

这便完成了[变分原理](@entry_id:198028)的证明。这个证明过程明确地揭示了，[变分原理](@entry_id:198028)的基石是[哈密顿量](@entry_id:172864)[本征态](@entry_id:149904)的完备性，它保证了任何[试探函数](@entry_id:756165)都能被表示为这些本征态的线性叠加。[@problem_id:2144180]

那么，等号在什么条件下成立呢？从上述推导中可以看出，要使 $\langle E \rangle = E_0$，必须满足 $\sum_n |c_n|^2 (E_n - E_0) = 0$。由于每一项 $|c_n|^2 (E_n - E_0)$ 都是非负的，因此这个和为零的唯一可能是，所有使得 $E_n > E_0$ 的项其系数 $c_n$ 都必须为零。这意味着试探波函数 $|\psi\rangle$ 的展开式中，只能包含那些能量为 $E_0$ 的[本征态](@entry_id:149904)。换言之，**等号成立的充分必要条件是，[试探波函数](@entry_id:142892) $|\psi\rangle$ 本身就是系统的一个[基态](@entry_id:150928)本征函数，或者完全落在由[基态](@entry_id:150928)本征函数张成的[子空间](@entry_id:150286)内**。

如果系统的[基态](@entry_id:150928)是非简并的，那么[基态](@entry_id:150928)本征函数 $\psi_0$ 是唯一的（在相差一个相位因子的意义上）。此时，$\langle E \rangle = E_0$ 当且仅当[试探函数](@entry_id:756165) $\psi_{\text{trial}}$ 就是 $\psi_0$。[@problem_id:2144200] 然而，如果系统[基态](@entry_id:150928)是简并的，即存在多个线性无关的本征函数（例如 $\psi_{0a}, \psi_{0b}, \dots$）对应同一个基态能量 $E_0$，那么任何处于这个简并[子空间](@entry_id:150286)内的归一化[波函数](@entry_id:147440)（例如 $\psi_{\text{trial}} = c_a \psi_{0a} + c_b \psi_{0b}$）都会使得其[能量期望值](@entry_id:174035)精确地等于 $E_0$。因此，如果在计算中发现一个明显不同于已知[基态](@entry_id:150928)[波函数](@entry_id:147440)的[试探函数](@entry_id:756165)，其变分能却恰好等于 $E_0$，这强烈地暗示了系统[基态](@entry_id:150928)存在简并。[@problem_id:2144184]

### 实际应用方法：通过试探[函数最小化](@entry_id:138381)能量

变分原理的价值在于其提供了一个实用的计算框架。我们通常不知道真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)，但我们可以构造一个或多个我们认为合理的[试探波函数](@entry_id:142892)，通过计算它们的[能量期望值](@entry_id:174035)来获得对真实[基态能量](@entry_id:263704)的估计。一个好的估计来自于一个“好”的[试探函数](@entry_id:756165)。

#### 可接受的[试探函数](@entry_id:756165)

首先，一个[试探函数](@entry_id:756165)必须是“物理上可接受的”，或者更严格地说，它必须属于[哈密顿算符](@entry_id:144286)的定义域。这意味着对[试探函数](@entry_id:756165)进行哈密顿操作后，结果必须是行为良好的，并且[能量期望值](@entry_id:174035)积分必须是有限的。一个典型的例子是无限深势阱问题，其势能在边界处为无穷大。这意味着粒子出现在边界上的概率为零，因此任何物理上合理的[波函数](@entry_id:147440)在边界处都必须为零。如果在应用变分法时选择了一个在边界上不为零的[试探函数](@entry_id:756165)，[哈密顿量](@entry_id:172864)中的动能项（包含[二阶导数](@entry_id:144508)）会在边界处产生奇异行为，导致计算出的[能量期望值](@entry_id:174035)为无穷大，这样的结果没有任何意义。因此，为特定问题选择[试探函数](@entry_id:756165)时，必须使其满足由系统物理性质决定的基本边界条件。[@problem_id:1416081]

#### 瑞利商 (Rayleigh Quotient)

在实践中，我们通常不需要在计算前就将[试探函数](@entry_id:756165) $\phi$ 归一化。我们可以使用所谓的**[瑞利商](@entry_id:137794)**来计算变分能：

$$ E[\phi] = \frac{\langle \phi | \hat{H} | \phi \rangle}{\langle \phi | \phi \rangle} $$

这种形式的优点在于它与[试探函数](@entry_id:756165)的归一化无关。假设我们有一个未归一化的[试探函数](@entry_id:756165) $\phi$，并考虑另一个函数 $\phi' = c\phi$，其中 $c$ 是任意非零常数。计算 $\phi'$ 的[瑞利商](@entry_id:137794)会得到：

$$ E[\phi'] = \frac{\langle c\phi | \hat{H} | c\phi \rangle}{\langle c\phi | c\phi \rangle} = \frac{|c|^2 \langle \phi | \hat{H} | \phi \rangle}{|c|^2 \langle \phi | \phi \rangle} = \frac{\langle \phi | \hat{H} | \phi \rangle}{\langle \phi | \phi \rangle} = E[\phi] $$

计算结果与常数 $c$ 无关。这极大地简化了计算，因为我们可以选择最方便的函数形式进行积分，而无需担心其归一化系数。例如，对于一维势箱中的粒子，使用[试探函数](@entry_id:756165) $\phi_1(x) = x(L-x)$ 和 $\phi_2(x) = 3.5 \cdot x(L-x)$ 计算出的变分能是完全相同的，因为后者仅是前者乘以一个常数。[@problem_id:1416059]

#### [参数化](@entry_id:272587)与优化

为了系统地改进[试探函数](@entry_id:756165)，我们通常会引入一个或多个可调的**变分参数** $\alpha, \beta, \dots$。这样，[试探函数](@entry_id:756165)就变成了一个函数族，例如 $\phi(\alpha)$。变分能也相应地成为这些参数的函数 $E(\alpha)$。[变分法](@entry_id:163656)的核心任务就转化为一个[优化问题](@entry_id:266749)：寻找一组最优参数 $(\alpha_{\text{opt}}, \beta_{\text{opt}}, \dots)$，使得 $E(\alpha, \beta, \dots)$ 达到其最小值。这个最小值就是该函数族所能给出的对基态能量的最佳估计。

从数学上讲，这意味着求解一组方程：

$$ \frac{\partial E}{\partial \alpha} = 0, \quad \frac{\partial E}{\partial \beta} = 0, \quad \dots $$

例如，若一个模型的变分能被计算为 $E(\alpha) = A \alpha^2 + B/\alpha$，其中 $A$ 和 $B$ 是与动能和[势能](@entry_id:748988)相关的正常数。为了找到最优参数 $\alpha_{\text{opt}}$，我们计算导数并令其为零：

$$ \frac{dE}{d\alpha} = 2A\alpha - \frac{B}{\alpha^2} = 0 \quad \implies \quad \alpha_{\text{opt}} = \left(\frac{B}{2A}\right)^{1/3} $$

将 $\alpha_{\text{opt}}$ 代回 $E(\alpha)$ 得到的能量 $E(\alpha_{\text{opt}})$ 就是该[试探函数](@entry_id:756165)形式所能提供的[基态能量](@entry_id:263704)的最佳上限。[@problem_id:1416091]

[变分原理](@entry_id:198028)还为我们提供了一个比较不同[试探函数](@entry_id:756165)优劣的标准：**给出的能量上限越低，说明[试探函数](@entry_id:756165)越接近真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)**。例如，如果我们用[高斯函数](@entry_id:261394)和[洛伦兹函数](@entry_id:199503)作为同一系统的[试探函数](@entry_id:756165)，分别进行优化后得到能量 $E_G$ 和 $E_L$。如果计算发现 $E_L  E_G$，那么我们可以得出结论，在这个具体问题中，[洛伦兹函数](@entry_id:199503)形式比[高斯函数](@entry_id:261394)形式能更好地描述系统的[基态](@entry_id:150928)。[@problem_id:2144152]

### [线性变分法](@entry_id:150058)：系统性的改进途径

虽然通过“化学直觉”或物理洞察力可以构造出不错的[参数化](@entry_id:272587)[试探函数](@entry_id:756165)，但更系统和强大的方法是**[线性变分法](@entry_id:150058)**。该方法将[试探函数](@entry_id:756165)构建为一组预先选定的**[基函数](@entry_id:170178)** $\{\phi_i\}$ 的线性组合：

$$ \psi = \sum_{i=1}^{N} c_i \phi_i $$

这里的变分参数不再是函数形式中的[非线性](@entry_id:637147)参数（如高斯函数的宽度），而是线性的组合系数 $\{c_i\}$。我们的目标是通过调整这些系数来最小化[瑞利商](@entry_id:137794) $E = \langle \psi | \hat{H} | \psi \rangle / \langle \psi | \psi \rangle$。

将 $\psi$ 的表达式代入并最小化能量，最终会导出一组称为**[久期方程组](@entry_id:200202) (secular equations)** 的线性方程组。为了使这组方程有非零解，其系数[行列式](@entry_id:142978)必须为零，这便是**[久期行列式](@entry_id:274608) (secular determinant)**：

$$ \det(\mathbf{H} - E\mathbf{S}) = 0 $$

其中，$\mathbf{H}$ 是[哈密顿矩阵](@entry_id:136233)，其矩阵元为 $H_{ij} = \langle \phi_i | \hat{H} | \phi_j \rangle$；$\mathbf{S}$ 是[重叠矩阵](@entry_id:268881)，其[矩阵元](@entry_id:186505)为 $S_{ij} = \langle \phi_i | \phi_j \rangle$。这是一个广义[本征值问题](@entry_id:142153)。

如果所选的[基函数](@entry_id:170178) $\{\phi_i\}$ 恰好是正交归一的，那么[重叠矩阵](@entry_id:268881)就简化为单位矩阵，即 $S_{ij} = \delta_{ij}$ 或 $\mathbf{S} = \mathbf{I}$。在这种特殊但重要的情况下，[久期方程](@entry_id:200202)简化为我们更熟悉的标准本征值问题：

$$ \det(\mathbf{H} - E\mathbf{I}) = 0 $$

解此方程会得到 $N$ 个能量值 $E_k$。根据[变分原理](@entry_id:198028)，这些能量值中的最低者就是对系统基态能量 $E_0$ 的一个上限。[@problem_id:1416086]

[线性变分法](@entry_id:150058)的巨大优势在于其系统可改进性。假设我们用 $N$ 个[基函数](@entry_id:170178)进行计算，得到了一个能量估计 $E_N$。如果我们增加[基函数](@entry_id:170178)的数量，使用一个包含所有旧[基函数](@entry_id:170178)并外加新函数的 $M$ 个[基函数](@entry_id:170178)的新[基组](@entry_id:160309)（$MN$），然后重新进行计算得到能量 $E_M$，那么必然有：

$$ E_M \le E_N $$

这是因为包含 $M$ 个[基函数](@entry_id:170178)的线性组合所能构成的[函数空间](@entry_id:143478) $V_M$，必然包含由 $N$ 个[基函数](@entry_id:170178)构成的[函数空间](@entry_id:143478) $V_N$ 作为其[子空间](@entry_id:150286)。在更大的空间中寻找最小值，其结果必然不会比在较小空间中得到的最小值更差（即更高）。这种单调收敛的特性是现代[量子化学](@entry_id:140193)计算的基石，它保证了通过不断扩大[基组](@entry_id:160309)，我们可以系统地、单调地逼近真实的基态能量。[@problem_id:1416117]

### 推广至[激发态](@entry_id:261453)

[变分原理](@entry_id:198028)的威力不仅限于[基态](@entry_id:150928)，它还可以被推广用于估计[激发态](@entry_id:261453)的能量。其核心定理是：**如果一个归一化的[试探函数](@entry_id:756165) $\psi_{\text{trial}}$ 与系统的所有低能级（从[基态](@entry_id:150928)到第 $k-1$ [激发态](@entry_id:261453)）的真实[本征函数](@entry_id:154705)都正交，那么它的[能量期望值](@entry_id:174035)将是第 $k$ [激发态](@entry_id:261453)能量 $E_k$ 的一个上限。**

对于第一[激发态](@entry_id:261453)（$k=1$），这意味着如果我们的[试探函数](@entry_id:756165) $\phi_2$ 与真实的[基态](@entry_id:150928)本征函数 $\psi_1$ 正交（即 $\langle \phi_2 | \psi_1 \rangle = 0$），那么 $\langle \phi_2 | \hat{H} | \phi_2 \rangle \ge E_2$（这里用 $E_2$ 表示第一[激发态](@entry_id:261453)能量）。

在实际操作中，我们通常不知道真实的 $\psi_1$。一个可行的策略是，先用[变分法](@entry_id:163656)找到一个对[基态](@entry_id:150928)[波函数](@entry_id:147440)很好的近似 $\phi_1$，然后构造一个与这个近似的 $\phi_1$ 正交的[试探函数](@entry_id:756165) $\phi_2$。尽管这种正交性不是严格的，但它通常足以给出一个不错的对 $E_2$ 的估计。例如，在处理一维势箱问题时，我们可以用一个简单的函数 $\phi_1(x) = x(L-x)$ 来近似[基态](@entry_id:150928)，然后构造一个与之正交的[试探函数](@entry_id:756165) $\phi_2(x)$ 来估计第一[激发态](@entry_id:261453)的能量。[@problem_id:1416104]

一个更巧妙且常用的方法是利用对称性。如果系统的[哈密顿量](@entry_id:172864)具有某种对称性（例如，对于中心对称的势 $V(x) = V(-x)$），那么它的本征函数必然具有确定的宇称（偶宇称或[奇宇称](@entry_id:147965)）。对于一维[谐振子](@entry_id:155622)或[对称势](@entry_id:148561)阱，其[基态](@entry_id:150928)[波函数](@entry_id:147440)通常是偶函数。由于不同宇称的函数之间是自动正交的（即 $\int_{-\infty}^{\infty} f_{\text{odd}}(x) g_{\text{even}}(x) dx = 0$），我们可以简单地选择一个具有奇宇称的[试探函数](@entry_id:756165)来估计第一[激发态](@entry_id:261453)（通常是[奇宇称](@entry_id:147965)）的能量。这个选择自动满足了与[基态](@entry_id:150928)正交的条件，因此其变分能必然是第一[激发态](@entry_id:261453)能量 $E_1$ 的一个上限。

例如，对于一维谐振子，其[基态](@entry_id:150928)是偶函数。如果我们选择一个奇函数形式的[试探函数](@entry_id:756165) $\psi_t(x) = C x \exp(-ax^2)$，我们无需执行任何额外的[正交化](@entry_id:149208)步骤，就可以保证其变分能是第一[激发态](@entry_id:261453)能量的上限。有趣的是，通过优化参数 $a$，我们发现这个特定的[试探函数](@entry_id:756165)形式可以得到精确的第一[激发态](@entry_id:261453)能量 $\frac{3}{2}\hbar\omega$。这说明，在这种情况下，我们幸运地（或者说，通过对称性的指导）猜中了确切的[本征函数](@entry_id:154705)形式。[@problem_id:2144162]

综上所述，变分原理不仅为我们提供了一个估算量子系统基态能量的上限的严格框架，还通过参数化、线性组合以及对称性利用等方法，发展出了一套强大而灵活的计算工具，其应用范围可以从简单的模型估算延伸到现代[计算化学](@entry_id:143039)的核心算法，并能被巧妙地推广至[激发态](@entry_id:261453)的研究。