{"hands_on_practices": [{"introduction": "当我们从同一个带有不确定性的测量值计算出多个不同的物理量时，这些导出量的误差通常不再是独立的。这个基础练习[@problem_id:1892970]提供了一个典型的物理学情景：从单次测量的速度计算动量和动能。通过这个练习，你将亲手推导出这种由共享测量变量（速度）引起的相关性，并量化动量和动能误差之间的协方差。", "problem": "在一个物理实验室实验中，一名学生测量了一个质量为 $m$ 的小颗粒的速度。质量 $m$ 是精确已知的，其不确定度可以忽略不计。单次速度测量得到的值为 $v_0$，其相关的标准不确定度为 $\\sigma_v$。根据这次测量，该学生计算了两个导出量：颗粒的动量 $p = mv$ 和其动能 $K = \\frac{1}{2}mv^2$。因为 $p$ 和 $K$ 都是由同一次对 $v$ 的测量计算得出的，所以它们的不确定度是相关的。\n\n求动能和动量之间的协方差，记为 $\\text{Cov}(K, p)$。请用给定的参数 $m$、$v_0$ 和 $\\sigma_v$ 表示你的答案的解析表达式。", "solution": "设 $v$ 为一个随机变量，表示测量的速度，其均值为 $E[v]=v_{0}$，方差为 $\\text{Var}(v)=\\sigma_{v}^{2}$。导出量为 $p(v)=m v$ 和 $K(v)=\\frac{1}{2} m v^{2}$。\n\n对单变量函数使用一阶不确定度传播（德尔塔方法），$f(v)$ 和 $g(v)$ 之间的协方差近似为\n$$\n\\text{Cov}(f(v),g(v)) \\approx f'(v_{0})\\,g'(v_{0})\\,\\text{Var}(v).\n$$\n此处，$f(v)=K(v)$ 且 $g(v)=p(v)$，因此\n$$\n\\frac{dK}{dv}=m v \\quad \\Rightarrow \\quad \\left.\\frac{dK}{dv}\\right|_{v_{0}}=m v_{0}, \\qquad \\frac{dp}{dv}=m.\n$$\n所以，\n$$\n\\text{Cov}(K,p) \\approx (m v_{0})(m)\\,\\sigma_{v}^{2}=m^{2} v_{0} \\sigma_{v}^{2}.\n$$\n\n此外，如果 $v$ 服从正态分布（这是测量不确定度的一个标准假设），则此结果是精确的。使用定义 $\\text{Cov}(K,p)=E[K p]-E[K]E[p]$，\n$$\n\\text{Cov}(K,p)=\\frac{m^{2}}{2}\\left(E[v^{3}]-E[v^{2}]\\,E[v]\\right).\n$$\n对于均值为 $v_{0}$、方差为 $\\sigma_{v}^{2}$ 的正态变量 $v$，$E[v^{2}]=v_{0}^{2}+\\sigma_{v}^{2}$ 且 $E[v^{3}]=v_{0}^{3}+3 v_{0}\\sigma_{v}^{2}$，可得\n$$\n\\text{Cov}(K,p)=\\frac{m^{2}}{2}\\left(v_{0}^{3}+3 v_{0}\\sigma_{v}^{2}-v_{0}(v_{0}^{2}+\\sigma_{v}^{2})\\right)=\\frac{m^{2}}{2}\\left(2 v_{0}\\sigma_{v}^{2}\\right)=m^{2} v_{0} \\sigma_{v}^{2}.\n$$\n因此，协方差为 $m^{2} v_{0} \\sigma_{v}^{2}$。", "answer": "$$\\boxed{m^{2} v_{0} \\sigma_{v}^{2}}$$", "id": "1892970"}, {"introduction": "误差相关性不仅出现在简单的公式计算中，它在数据拟合等统计分析过程中也扮演着至关重要的角色。一个非常普遍的例子是在对实验数据进行线性拟合时，得到的斜率和截距的估计值往往是相关的。这个练习[@problem_id:1892979]将引导你通过定性分析，从几何直观上理解为什么当数据点远离坐标轴时，拟合出的斜率和截距的误差会呈现出强烈的反相关性。", "problem": "一位天文学家正在追踪一颗新发现的小行星。在一个短暂的观测窗口内，该小行星划过天空的轨迹可以很好地用一条直线来近似。天文学家记录了一系列数据点 $(x_i, y_i)$，其中 $x$ 代表观测时间，$y$ 代表小行星的角位置。所有的观测都是在最初发现（时间 $x=0$）之后很久的几个夜晚内进行的。因此，所有记录的 $x_i$ 值都很大，并且聚集在远离 $y$ 轴（时间原点）的地方。\n\n天文学家使用最小二乘法将形式为 $y(x) = mx + c$ 的线性模型拟合到数据点上，以估计斜率 $m$ 和 y 轴截距 $c$。斜率 $m$ 代表小行星的角速度，截距 $c$ 代表其在时间 $x=0$ 时的外推角位置。由于测量不确定性，估计出的 $m$ 和 $c$ 值存在统计误差。观测发现这些误差是强反相关的；也就是说，导致斜率 $m$ 被高估的随机误差，极有可能伴随着对截距 $c$ 的低估，反之亦然。\n\n下列哪个陈述为 $m$ 和 $c$ 误差之间的这种强反相关性提供了最佳的定性解释？\n\nA. 最佳拟合线必须穿过数据云的中心。由于数据云远离 $y$ 轴，一个小的向上倾斜（斜率增加）会使直线围绕这个远点旋转，导致其 $y$ 轴截距大幅下移。\n\nB. 参数 $m$ 和 $c$ 的误差与数据点 $(x_i, y_i)$ 的误差无关，并且最小二乘法原理要求参数误差的乘积为负。\n\nC. 因为数据远离 $y$ 轴，截距 $c$ 的值是通过长距离外推确定的。这种长距离外推放大了不确定性，根据定义，这会与斜率产生反相关。\n\nD. 任何增加斜率 $m$ 的随机误差都会使拟合线变得更陡。为了对远离原点的数据点保持最佳拟合，直线必须向上平移，这对应于截距 $c$ 的增加。\n\nE. $m$ 和 $c$ 的标准误差公式都取决于残差平方和。为了使这个和保持最小，一个参数误差的增加必须由另一个参数误差的减少来抵消。", "solution": "设数据遵循线性模型 $y_{i}=m x_{i}+c+\\epsilon_{i}$，其中 $\\epsilon_{i}$ 是独立的，均值为零，方差为 $\\sigma^{2}$。普通最小二乘（OLS）估计量满足\n$$\n\\hat{m}=\\frac{\\sum_{i=1}^{n}(x_{i}-\\bar{x})(y_{i}-\\bar{y})}{\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}},\\quad \\hat{c}=\\bar{y}-\\hat{m}\\,\\bar{x},\n$$\n其中 $\\bar{x}$ 和 $\\bar{y}$ 是样本均值，而 $S_{xx}=\\sum_{i=1}^{n}(x_{i}-\\bar{x})^{2}$。\n\n标准的 OLS 方差和协方差公式（对于固定的回归量）给出\n$$\n\\operatorname{Var}(\\hat{m})=\\frac{\\sigma^{2}}{S_{xx}},\\quad \\operatorname{Var}(\\hat{c})=\\sigma^{2}\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{S_{xx}}\\right),\\quad \\operatorname{Cov}(\\hat{m},\\hat{c})=-\\frac{\\sigma^{2}\\bar{x}}{S_{xx}}.\n$$\n等价地，使用 $\\hat{c}=\\bar{y}-\\hat{m}\\bar{x}$，微小扰动满足 $\\delta \\hat{c}=-\\bar{x}\\,\\delta \\hat{m}+\\delta \\bar{y}$。由于 $\\operatorname{Var}(\\bar{y})=\\sigma^{2}/n$ 而 $\\operatorname{Var}(\\hat{m})=\\sigma^{2}/S_{xx}$，当 $|\\bar{x}|$ 相对于尺度 $\\sqrt{S_{xx}/n}$ 较大时，项 $-\\bar{x}\\,\\delta \\hat{m}$ 占主导地位，导致 $\\hat{m}$ 和 $\\hat{c}$ 的误差之间存在强烈的负耦合。相关系数为\n$$\n\\operatorname{Corr}(\\hat{m},\\hat{c})=\\frac{-\\sigma^{2}\\bar{x}/S_{xx}}{\\sqrt{(\\sigma^{2}/S_{xx})\\cdot \\sigma^{2}\\left(\\frac{1}{n}+\\frac{\\bar{x}^{2}}{S_{xx}}\\right)}}=-\\frac{\\bar{x}}{\\sqrt{\\frac{S_{xx}}{n}+\\bar{x}^{2}}},\n$$\n当 $|\\bar{x}|^{2}\\gg S_{xx}/n$ 时，该值趋近于 $-1$。这正是所描述的情况：所有 $x_{i}$ 都很大且聚集在远离 $y$ 轴的地方，因此直线实际上是围绕着 $(\\bar{x},\\bar{y})$ 附近的数据云旋转。在这个远处的枢轴点周围，斜率的微小增加会迫使截距减小，以使拟合线保持在同一数据云附近，从而产生强烈的反相关。\n\n从定性上看，这与陈述 A 相符：最佳拟合线穿过数据云的中心附近，当该中心远离 $y$ 轴时，斜率的微小倾斜会导致在 $x=0$ 处的截距发生大的反向变化。陈述 B、C、E 描述了不正确的原理，而陈述 D 则断言了错误的截距变化方向。", "answer": "$$\\boxed{A}$$", "id": "1892979"}, {"introduction": "相关误差的来源可能更加微妙和间接，例如，当一个不精确已知的模型参数被用于分析多个独立的数据集时。这个来自凝聚态物理学前沿的练习[@problem_id:1892935]便展示了这样一个深刻的例子。你将探索在临界现象研究中，临界温度 $T_c$ 的不确定性如何导致从不同实验（比热和磁化率测量）中提取出的两个关键物理指数 $\\alpha$ 和 $\\gamma$ 的估计值之间产生协方差。", "problem": "在临界现象的研究中，物理量在连续相变点附近的行为由以临界指数为特征的幂律来描述。考虑一个临界温度为 $T_c$ 的铁磁材料。在此温度附近，比热容 $C_s$ 和磁化率 $\\chi$ 预计会按如下方式发散：\n\n$$C_s(T) = A_s |T - T_c|^{-\\alpha}$$\n$$\\chi(T) = A_\\chi |T - T_c|^{-\\gamma}$$\n\n其中 $\\alpha$ 和 $\\gamma$ 分别是比热容和磁化率的临界指数，而 $A_s$ 和 $A_\\chi$ 是与材料相关的振幅。\n\n一位实验者进行了两个独立的实验来确定这些指数。\n1.  在第一个实验中，在两个不同的温度 $T_1$ 和 $T_2$ 下测量比热容，得到值 $C_{s,1}$ 和 $C_{s,2}$。\n2.  在第二个实验中，在相同的两个温度 $T_1$ 和 $T_2$ 下测量磁化率，得到值 $\\chi_1$ 和 $\\chi_2$。\n\n对于本分析，假设温度范围始终在相变的一侧，因此有 $T_1 > T_2 > T_c$。然后根据这两对测量值计算指数 $\\alpha$ 和 $\\gamma$。\n\n虽然 $T_1$、$T_2$、$C_s$ 和 $\\chi$ 的测量被认为是完全精确的，但临界温度 $T_c$ 仅通过一个独立的估计过程得知。临界温度的最佳估计值为 $T_{c,0}$，并且该估计值存在一个小的、已知的、由标准差 $\\sigma_{T_c}$ 表征的不确定性。所有误差源都是统计独立的。\n\n设 $\\alpha_0$ 和 $\\gamma_0$ 是使用最佳估计值 $T_{c,0}$ 计算出的指数值。推导 $\\alpha$ 和 $\\gamma$ 的估计量之间的协方差（记为 $\\text{Cov}(\\alpha, \\gamma)$）的解析表达式，该协方差仅由 $T_c$ 的不确定性引起。你的最终答案应以 $\\alpha_0$、$\\gamma_0$、$T_1$、$T_2$、$T_{c,0}$ 和 $\\sigma_{T_c}$ 表示。", "solution": "因为 $T_{1}>T_{2}>T_{c}$，所以绝对值可以去掉，得到\n$$\\frac{C_{s,1}}{C_{s,2}}=\\left(\\frac{T_{1}-T_{c}}{T_{2}-T_{c}}\\right)^{-\\alpha},\\qquad \\frac{\\chi_{1}}{\\chi_{2}}=\\left(\\frac{T_{1}-T_{c}}{T_{2}-T_{c}}\\right)^{-\\gamma}.$$\n取自然对数可得\n$$\\ln\\!\\left(\\frac{C_{s,1}}{C_{s,2}}\\right)=-\\alpha\\,\\ln\\!\\left(\\frac{T_{1}-T_{c}}{T_{2}-T_{c}}\\right),\\qquad\n\\ln\\!\\left(\\frac{\\chi_{1}}{\\chi_{2}}\\right)=-\\gamma\\,\\ln\\!\\left(\\frac{T_{1}-T_{c}}{T_{2}-T_{c}}\\right).$$\n定义 $L(T_{c})=\\ln\\!\\left(\\frac{T_{1}-T_{c}}{T_{2}-T_{c}}\\right)$ 以及由数据决定的常数\n$$a\\equiv -\\ln\\!\\left(\\frac{C_{s,1}}{C_{s,2}}\\right),\\qquad b\\equiv -\\ln\\!\\left(\\frac{\\chi_{1}}{\\chi_{2}}\\right).$$\n则\n$$\\alpha(T_{c})=\\frac{a}{L(T_{c})},\\qquad \\gamma(T_{c})=\\frac{b}{L(T_{c})}.$$\n设 $T_{c,0}$ 是最佳估计值，$T_c$ 的方差为 $\\sigma_{T_{c}}^{2}$。定义 $L_{0}=L(T_{c,0})$。在 $T_{c,0}$ 处计算的指数为\n$$\\alpha_{0}=\\frac{a}{L_{0}},\\qquad \\gamma_{0}=\\frac{b}{L_{0}},\\qquad\\text{所以}\\quad a=\\alpha_{0}L_{0},\\; b=\\gamma_{0}L_{0}.$$\n对 $L(T_{c})$ 求导：\n$$\\frac{dL}{dT_{c}}=\\frac{d}{dT_{c}}\\big[\\ln(T_{1}-T_{c})-\\ln(T_{2}-T_{c})\\big]=-\\frac{1}{T_{1}-T_{c}}+\\frac{1}{T_{2}-T_{c}}=\\frac{T_{1}-T_{2}}{(T_{1}-T_{c})(T_{2}-T_{c})}.$$\n对 $\\alpha$ 和 $\\gamma$ 关于 $T_c$ 求导：\n$$\\frac{d\\alpha}{dT_{c}}=-\\frac{a}{L^{2}}\\frac{dL}{dT_{c}},\\qquad \\frac{d\\gamma}{dT_{c}}=-\\frac{b}{L^{2}}\\frac{dL}{dT_{c}}.$$\n在 $T_{c,0}$ 处取值，并使用 $a=\\alpha_{0}L_{0}$，$b=\\gamma_{0}L_{0}$：\n$$\\left.\\frac{d\\alpha}{dT_{c}}\\right|_{0}=-\\alpha_{0}\\frac{1}{L_{0}}\\left.\\frac{dL}{dT_{c}}\\right|_{0},\\qquad\n\\left.\\frac{d\\gamma}{dT_{c}}\\right|_{0}=-\\gamma_{0}\\frac{1}{L_{0}}\\left.\\frac{dL}{dT_{c}}\\right|_{0},$$\n其中\n$$\\left.\\frac{dL}{dT_{c}}\\right|_{0}=\\frac{T_{1}-T_{2}}{(T_{1}-T_{c,0})(T_{2}-T_{c,0})},\\qquad L_{0}=\\ln\\!\\left(\\frac{T_{1}-T_{c,0}}{T_{2}-T_{c,0}}\\right).$$\n由于唯一的不确定性来自 $T_c$ (其方差为 $\\sigma_{T_{c}}^{2}$)，且所有误差都是独立的，根据单个标量不确定性的一阶（delta方法）误差传播公式可得\n$$\\text{Cov}(\\alpha,\\gamma)\\approx \\left.\\frac{d\\alpha}{dT_{c}}\\right|_{0}\\left.\\frac{d\\gamma}{dT_{c}}\\right|_{0}\\sigma_{T_{c}}^{2}.$$\n代入导数可得\n$$\\text{Cov}(\\alpha,\\gamma)=\\alpha_{0}\\gamma_{0}\\,\\frac{\\left(\\left.\\frac{dL}{dT_{c}}\\right|_{0}\\right)^{2}}{L_{0}^{2}}\\,\\sigma_{T_{c}}^{2}\n=\\alpha_{0}\\gamma_{0}\\,\\frac{(T_{1}-T_{2})^{2}}{(T_{1}-T_{c,0})^{2}(T_{2}-T_{c,0})^{2}\\left[\\ln\\!\\left(\\frac{T_{1}-T_{c,0}}{T_{2}-T_{c,0}}\\right)\\right]^{2}}\\,\\sigma_{T_{c}}^{2}.$$\n该表达式仅依赖于 $\\alpha_{0}$、$\\gamma_{0}$、$T_{1}$、$T_{2}$、$T_{c,0}$ 和 $\\sigma_{T_{c}}$，符合要求，并且它捕捉到了仅由 $T_c$ 的不确定性引起的协方差（到 $\\sigma_{T_c}$ 的主导阶）。", "answer": "$$\\boxed{\\alpha_{0}\\gamma_{0}\\,\\sigma_{T_{c}}^{2}\\,\\frac{(T_{1}-T_{2})^{2}}{(T_{1}-T_{c,0})^{2}(T_{2}-T_{c,0})^{2}\\left[\\ln\\!\\left(\\frac{T_{1}-T_{c,0}}{T_{2}-T_{c,0}}\\right)\\right]^{2}}}$$", "id": "1892935"}]}