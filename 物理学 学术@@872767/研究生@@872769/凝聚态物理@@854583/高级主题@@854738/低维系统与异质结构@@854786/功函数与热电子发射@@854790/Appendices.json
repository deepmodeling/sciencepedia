{"hands_on_practices": [{"introduction": "金属的热电子发射电流对其功函数势垒高度非常敏感。施加外部电场可以降低此势垒，这种现象被称为肖特基效应，为控制发射提供了一种直接手段。本练习 [@problem_id:263446] 提供了一个具体的实践，通过计算达到期望电流增强所需的特定电场 $E$，来量化这种关系。", "problem": "从绝对温度为 $T$ 的受热金属表面发射的电子的饱和电流密度 $J_0$ 由Richardson-Dushman方程描述，$J_0 = A_G T^2 \\exp(-W/(k_B T))$，其中 $W$ 是金属的功函数，$k_B$ 是玻尔兹曼常数，$A_G$ 是Richardson常数。\n\n当一个强的外电场 $E$ 垂直施加于表面时，会增强发射电流，这种现象称为肖特基效应。电场降低了电子逃离金属所必须克服的势垒。这种势垒的降低量 $\\Delta W$ 是由外电场的电势与电子在导体内的自身镜像电荷产生的电势叠加引起的。功函数降低的量值由下式给出：\n$$ \\Delta W = e\\sqrt{\\frac{eE}{4\\pi\\epsilon_0}} $$\n其中 $e$ 是元电荷，$\\epsilon_0$ 是真空介电常数。\n\n因此，新的饱和电流密度 $J_S$ 由下式给出：\n$$ J_S = J_0 \\exp\\left(\\frac{\\Delta W}{k_B T}\\right) $$\n\n考虑一个保持在恒定温度 $T$ 的金属灯丝。确定必须施加在表面上使其热电子发射电流密度加倍的外电场 $E$ 的大小。请用 $T$、$k_B$、$e$、$\\epsilon_0$ 及相关数学常数表示你的答案。", "solution": "无电场时的饱和电流密度由Richardson-Dushman方程给出：\n\n$$ J_0 = A_G T^2 \\exp\\left(-\\frac{W}{k_B T}\\right) $$\n\n\n在外电场 $E$ 作用下，饱和电流密度变为：\n\n$$ J_S = J_0 \\exp\\left(\\frac{\\Delta W}{k_B T}\\right) $$\n\n其中功函数的降低量为：\n\n$$ \\Delta W = e \\sqrt{\\frac{e E}{4 \\pi \\epsilon_0}} $$\n\n\n题目要求电流密度加倍，所以：\n\n$$ J_S = 2 J_0 $$\n\n\n代入 $J_S$ 的表达式：\n\n$$ J_0 \\exp\\left(\\frac{\\Delta W}{k_B T}\\right) = 2 J_0 $$\n\n\n两边同时除以 $J_0$（假设 $J_0 \\neq 0$）：\n\n$$ \\exp\\left(\\frac{\\Delta W}{k_B T}\\right) = 2 $$\n\n\n对两边取自然对数：\n\n$$ \\frac{\\Delta W}{k_B T} = \\ln 2 $$\n\n\n解出 $\\Delta W$：\n\n$$ \\Delta W = k_B T \\ln 2 $$\n\n\n代入 $\\Delta W$ 的表达式：\n\n$$ e \\sqrt{\\frac{e E}{4 \\pi \\epsilon_0}} = k_B T \\ln 2 $$\n\n\n分离平方根项：\n\n$$ \\sqrt{\\frac{e E}{4 \\pi \\epsilon_0}} = \\frac{k_B T \\ln 2}{e} $$\n\n\n两边平方以消去平方根：\n\n$$ \\frac{e E}{4 \\pi \\epsilon_0} = \\left( \\frac{k_B T \\ln 2}{e} \\right)^2 $$\n\n\n解出 $E$：\n\n$$ e E = 4 \\pi \\epsilon_0 \\cdot \\left( \\frac{k_B T \\ln 2}{e} \\right)^2 $$\n\n\n$$ E = \\frac{4 \\pi \\epsilon_0}{e} \\cdot \\frac{(k_B T \\ln 2)^2}{e^2} $$\n\n\n$$ E = \\frac{4 \\pi \\epsilon_0 (k_B T \\ln 2)^2}{e^3} $$\n\n\n因此，使热电子发射电流密度加倍所需的外电场 $E$ 为：\n\n$$ E = \\frac{4 \\pi \\epsilon_0 (k_B T)^2 (\\ln 2)^2}{e^3} $$", "answer": "$$ \\boxed{E = \\frac{4 \\pi \\epsilon_0 (k_B T)^2 (\\ln 2)^2}{e^3}} $$", "id": "263446"}, {"introduction": "在实际应用中，材料通常是多晶的，呈现出由具有不同功函数 $\\phi$ 的晶面组成的“马赛克”表面。本练习 [@problem_id:263532] 超越了理想的均匀表面模型，旨在探究这种不均匀性如何影响热电子发射的测量。通过对复合表面进行建模，您将学会推导一个与温度相关的“有效功函数”，这是正确解读来自真实材料的实验数据的关键概念。", "problem": "对于温度为 $T$ 的均匀金属表面，其热电子发射电流密度 $J$ 由理查森-杜什曼方程描述，$J = A_R T^2 \\exp(-\\phi / (k_B T))$，其中 $\\phi$ 是功函数，$k_B$ 是玻尔兹曼常数，$A_R$ 是理查森常数。功函数可以通过绘制理查森图来实验确定，该图是 $\\ln(J/T^2)$ 关于 $1/T$ 的关系图。对于均匀表面，此图是一条直线，其斜率等于 $-\\phi/k_B$。\n\n现考虑一个不均匀的多晶金属表面。它由两种不同类型的晶面组成。\n- 1 型晶面的功函数为 $\\phi_1$，覆盖总表面积的比例为 $f$。\n- 2 型晶面的功函数为 $\\phi_2$，覆盖剩余的比例为 $(1-f)$ 的表面积。\n\n假设两种晶面的理查森常数 $A_R$ 相同。总发射电流是所有晶面电流的总和。因此，总电流密度 $J_{total}$ 是每种晶面电流密度的面积加权平均值。\n\n对于这种复合表面，$\\ln(J_{total}/T^2)$ 关于 $1/T$ 的理查森图不是一条直线。该图的局部斜率随温度变化。我们可以通过以下关系，从该局部斜率定义一个依赖于温度的有效功函数 $\\phi_{eff}(T)$：\n$$ \\text{Slope} = \\frac{d}{d(1/T)} \\ln\\left(\\frac{J_{total}}{T^2}\\right) = -\\frac{\\phi_{eff}(T)}{k_B} $$\n\n推导在特定温度 $T_0$ 下，有效功函数 $\\phi_{eff}$ 的闭合形式表达式，用 $\\phi_1$、$\\phi_2$、$f$、$k_B$ 和 $T_0$ 表示。", "solution": "总电流密度 $J_{\\text{total}}$ 是每种晶面电流密度的面积加权平均值：\n\n$$\nJ_{\\text{total}} = f J_1 + (1 - f) J_2\n$$\n\n其中 $J_1 = A_R T^2 \\exp(-\\phi_1 / (k_B T))$ 且 $J_2 = A_R T^2 \\exp(-\\phi_2 / (k_B T))$。代入这些表达式可得：\n\n$$\nJ_{\\text{total}} = A_R T^2 \\left[ f \\exp\\left(-\\frac{\\phi_1}{k_B T}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2}{k_B T}\\right) \\right]\n$$\n\n理查森图绘制的是 $\\ln(J_{\\text{total}} / T^2)$ 关于 $1/T$ 的关系。定义：\n\n$$\ny = \\ln\\left(\\frac{J_{\\text{total}}}{T^2}\\right) = \\ln\\left( A_R \\left[ f \\exp\\left(-\\frac{\\phi_1}{k_B T}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2}{k_B T}\\right) \\right] \\right)\n$$\n\n由于 $A_R$ 是常数，其对 $1/T$ 的导数取决于对数的参数。令 $u = 1/T$，则：\n\n$$\ny = \\ln\\left( A_R \\left[ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) \\right] \\right)\n$$\n\n$y$ 对 $u$ 的导数为：\n\n$$\n\\frac{dy}{du} = \\frac{1}{f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right)} \\cdot \\frac{d}{du}\\left[ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) \\right]\n$$\n\n计算内部的导数：\n\n$$\n\\frac{d}{du}\\left[ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) \\right] = f \\left(-\\frac{\\phi_1}{k_B}\\right) \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right)\n$$\n\n\n$$\n\\frac{d}{du}\\left[ (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) \\right] = (1 - f) \\left(-\\frac{\\phi_2}{k_B}\\right) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right)\n$$\n\n所以：\n\n$$\n\\frac{dy}{du} = \\frac{ f \\left(-\\frac{\\phi_1}{k_B}\\right) \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\left(-\\frac{\\phi_2}{k_B}\\right) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }{ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }\n$$\n\n在分子中提出因子 $-1/k_B$：\n\n$$\n\\frac{dy}{du} = -\\frac{1}{k_B} \\cdot \\frac{ f \\phi_1 \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }{ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }\n$$\n\n理查森图的斜率为 $\\frac{dy}{d(1/T)} = \\frac{dy}{du}$，根据定义：\n\n$$\n\\text{Slope} = -\\frac{\\phi_{\\text{eff}}(T)}{k_B}\n$$\n\n令两个斜率表达式相等：\n\n$$\n-\\frac{\\phi_{\\text{eff}}(T)}{k_B} = -\\frac{1}{k_B} \\cdot \\frac{ f \\phi_1 \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }{ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }\n$$\n\n解出 $\\phi_{\\text{eff}}(T)$：\n\n$$\n\\phi_{\\text{eff}}(T) = \\frac{ f \\phi_1 \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }{ f \\exp\\left(-\\frac{\\phi_1 u}{k_B}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2 u}{k_B}\\right) }\n$$\n\n将 $u = 1/T$ 代回：\n\n$$\n\\phi_{\\text{eff}}(T) = \\frac{ f \\phi_1 \\exp\\left(-\\frac{\\phi_1}{k_B T}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\frac{\\phi_2}{k_B T}\\right) }{ f \\exp\\left(-\\frac{\\phi_1}{k_B T}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2}{k_B T}\\right) }\n$$\n\n在 $T = T_0$ 处求值：\n\n$$\n\\phi_{\\text{eff}}(T_0) = \\frac{ f \\phi_1 \\exp\\left(-\\frac{\\phi_1}{k_B T_0}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\frac{\\phi_2}{k_B T_0}\\right) }{ f \\exp\\left(-\\frac{\\phi_1}{k_B T_0}\\right) + (1 - f) \\exp\\left(-\\frac{\\phi_2}{k_B T_0}\\right) }\n$$\n\n这就是在温度 $T_0$ 时有效功函数的闭合形式表达式。", "answer": "$$\n\\boxed{\\phi_{\\text{eff}}(T_0) = \\dfrac{ f \\phi_1 \\exp\\left(-\\dfrac{\\phi_1}{k_B T_0}\\right) + (1 - f) \\phi_2 \\exp\\left(-\\dfrac{\\phi_2}{k_B T_0}\\right) }{ f \\exp\\left(-\\dfrac{\\phi_1}{k_B T_0}\\right) + (1 - f) \\exp\\left(-\\dfrac{\\phi_2}{k_B T_0}\\right) }}\n$$", "id": "263532"}, {"introduction": "现实世界中的电子发射是表面物理与真空电动力学复杂相互作用的结果。这项高级实践 [@problem_id:2985290] 要求您构建一个自洽模型，将肖特基效应与空间电荷限制这一关键概念统一起来。通过判断发射体在源限制区间还是输运限制区间工作，您将更深刻地理解制约真空电子器件的基本物理原理，并学会如何通过计算方法解决多物理场问题。", "problem": "要求您构建一个自洽的一维平面发射模型，用以确定当以下物理效应同时存在时，电子离开金属表面进入真空的有效发射势垒：(i) 经典镜像电荷相互作用，(ii) 垂直于表面的均匀外加电场，以及 (iii) 有限间隙内由发射电子形成的空间电荷。您的模型必须从第一性原理推导得出，并且必须实现为一个可运行的程序，用于计算指定测试套件的有效势垒。\n\n仅从以下基本原理出发：\n- 经典静电学（Coulomb 定律和镜像法）。\n- 用于稳态电荷流的一维 Poisson 方程，以及用于电子运动的 Newton 第二定律。\n- 平衡态 Fermi-Dirac 分布及其适用于高能电子的 Maxwell-Boltzmann 尾部，这导致了热电子发射。\n- 逸出功的定义：在没有电场的情况下，金属的真空能级与 Fermi 能级之间的能量差，记为 $\\,\\Phi_0\\,$。\n- 各个常数：元电荷 $\\,e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}\\,$，真空介电常数 $\\,\\epsilon_0 = 8.8541878128\\times 10^{-12}\\,\\mathrm{F/m}\\,$，电子质量 $\\,m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}\\,$，Boltzmann 常数 $\\,k_B = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}\\,$，以及 Planck 常数 $\\,h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\,s}\\,$。\n\n您的任务：\n1) 使用经典静电学和镜像法，写出在存在表面法向电场 $\\,E_s\\,$ 的情况下，真空中距离平面金属-真空界面 $\\,x>0\\,$ 处的电子势能，表示为由电场引起的线性项和吸引性镜像电荷项之和。通过微积分，确定势垒最大值相对于 $\\,\\Phi_0\\,$ 的降低量，作为 $\\,E_s\\,$ 的函数。将此降低量记为 $\\,\\Delta \\Phi_{\\mathrm{im}}(E_s)\\,$。有效发射势垒则为 $\\,\\Phi_{\\mathrm{eff}} = \\max\\{0,\\,\\Phi_0 - \\Delta \\Phi_{\\mathrm{im}}(E_s)\\}\\,$。\n2) 从 Fermi-Dirac 分布的 Maxwell-Boltzmann 尾部和自由电子运动学出发，推导形式为 $\\,J_{\\mathrm{em}}(T,\\Phi_{\\mathrm{eff}})\\,$ 的热电子发射电流密度，并用 $\\,e\\,$, $\\,m_e\\,$, $\\,k_B\\,$ 和 $\\,h\\,$ 确定 Richardson 常数 $\\,A_R\\,$。\n3) 使用稳态 Poisson 方程和发射电子初始速度可忽略时的能量守恒，为间隙为 $\\,d\\,$、阳极-阴极电势为 $\\,V\\,$ 的平板二极管中的一维空间电荷建模。推导空间电荷限制电流密度 $\\,J_{\\mathrm{CL}}(V,d)\\,$，其定义为与阴极处非负电场相符的最大可持续电流密度。使用关系式 $\\,V = E_{\\mathrm{ext}}\\,d\\,$ 将外加电场 $\\,E_{\\mathrm{ext}}\\,$ 与二极管参数联系起来。\n4) 通过以下逻辑在阴极处使模型自洽闭合，该逻辑强制施加空间电荷对表面电场的影响：\n   - 如果 $\\,J_{\\mathrm{em}}(T,\\Phi_{\\mathrm{eff}})\\le J_{\\mathrm{CL}}(V,d)\\,$，则空间电荷不抑制阴极电场，您可以取 $\\,E_s = E_{\\mathrm{ext}}\\,$。\n   - 如果 $\\,J_{\\mathrm{em}}(T,\\Phi_{\\mathrm{eff}}) > J_{\\mathrm{CL}}(V,d)\\,$, 则电流受空间电荷限制，阴极电场坍缩为 $\\,E_s = 0\\,$，这意味着 $\\,\\Phi_{\\mathrm{eff}} = \\Phi_0\\,$。\n\n数值和单位要求：\n- 所有能量均以电子伏特处理。明确以电子伏特报告 $\\,\\Phi_{\\mathrm{eff}}\\,$。\n- 温度单位为开尔文，距离单位为米，电场单位为伏特/米，电势单位为伏特，电流密度单位为安培/平方米。\n- 将每个测试用例的最终答案表示为以电子伏特为单位、四舍五入到六位小数的浮点数。\n\n测试套件：\n使用以下五个测试用例，每个用例指定为一个元组 $\\,(\\Phi_0\\,\\mathrm{[eV]},\\,T\\,\\mathrm{[K]},\\,E_{\\mathrm{ext}}\\,\\mathrm{[V/m]},\\,d\\,\\mathrm{[m]})$。\n- 用例 1（供应限制，中等场强）：$\\,(\\,4.50,\\,2200,\\,2.0\\times 10^{6},\\,1.0\\times 10^{-5}\\,)\\,$。\n- 用例 2（从下方接近空间电荷限制阈值）：$\\,(\\,4.50,\\,2900,\\,2.0\\times 10^{6},\\,1.0\\times 10^{-3}\\,)\\,$。\n- 用例 3（空间电荷限制）：$\\,(\\,4.50,\\,3300,\\,2.0\\times 10^{6},\\,1.0\\times 10^{-3}\\,)\\,$。\n- 用例 4（零外加电场）：$\\,(\\,4.50,\\,2500,\\,0.0,\\,1.0\\times 10^{-4}\\,)\\,$。\n- 用例 5（强场，小间隙）：$\\,(\\,4.50,\\,2000,\\,5.0\\times 10^{7},\\,1.0\\times 10^{-5}\\,)\\,$。\n\n算法规范：\n- 对每个用例，计算 $\\,V = E_{\\mathrm{ext}}\\,d\\,$。\n- 在 $\\,E_s = E_{\\mathrm{ext}}\\,$ 处计算 $\\,\\Delta \\Phi_{\\mathrm{im}}(E_s)\\,$，并形成一个临时的 $\\,\\Phi_{\\mathrm{eff}}\\,$。\n- 计算 $\\,J_{\\mathrm{em}}(T,\\Phi_{\\mathrm{eff}})\\,$.\n- 计算 $\\,J_{\\mathrm{CL}}(V,d)\\,$.\n- 如果 $\\,J_{\\mathrm{em}} > J_{\\mathrm{CL}}\\,$，设置 $\\,E_s=0\\,$，重新计算 $\\,\\Phi_{\\mathrm{eff}} = \\Phi_0\\,$。\n- 将 $\\,\\Phi_{\\mathrm{eff}}\\,$ 限制在 $\\ge 0$。\n- 以电子伏特为单位报告 $\\,\\Phi_{\\mathrm{eff}}\\,$，保留六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果与测试套件的顺序相同。例如，输出必须采用 $\\,\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]\\,$ 的形式，其中每个 $\\,\\text{result}_i\\,$ 是一个以电子伏特为单位、四舍五入到六位小数的浮点数，并且打印的字符串中不包含单位。不应打印任何其他文本。", "solution": "问题陈述已经过验证，被认为是合理的。它在科学上基于经典静电学和统计力学的原理，问题适定，具有清晰和确定性的算法路径，并且其表述是客观的。我们接下来进行推导和求解。\n\n该模型旨在寻找电子离开金属表面的有效发射势垒 $\\,\\Phi_{\\mathrm{eff}}\\,$。该势垒由材料的内在逸出功、外加电场以及发射电子本身形成的空间电荷之间的相互作用决定。解决方案是通过从第一性原理推导这些效应的表达式，然后将它们自洽地结合起来构建的。\n\n### 1. 有效势垒和 Schottky 降低效应\n\n在一个一维模型中，一个电荷为 $\\,-e\\,$ 的电子在距离 $\\,x=0\\,$ 处平面金属表面 $\\,x>0\\,$ 的位置，会受到两种力：来自其在导体内部的镜像电荷的吸引力，以及来自表面外加电场 $\\,E_s\\,$ 的作用力。我们定义 $\\,E_s>0\\,$ 为将电子加速推离表面的电场。\n\n大小为 $\\,+e\\,$ 的镜像电荷位于 $\\,-x\\,$ 处。根据 Coulomb 定律，该镜像电荷对电子施加的力为：\n$$\nF_{\\mathrm{im}}(x) = -\\frac{1}{4\\pi\\epsilon_0} \\frac{e^2}{(2x)^2} = -\\frac{e^2}{16\\pi\\epsilon_0 x^2}\n$$\n负号表示这是一个吸引力（朝向 $\\,x=0\\,$ 处的表面）。与此力相关的势能，设定参考点 $\\,U_{\\mathrm{im}}(\\infty)=0\\,$，为：\n$$\nU_{\\mathrm{im}}(x) = -\\int_\\infty^x F_{\\mathrm{im}}(x') dx' = \\int_x^\\infty F_{\\mathrm{im}}(x') dx' = \\int_x^\\infty \\left(-\\frac{e^2}{16\\pi\\epsilon_0 (x')^2}\\right) dx' = -\\frac{e^2}{16\\pi\\epsilon_0 x}\n$$\n外加电场 $\\,E_s\\,$ 施加的力为 $\\,F_{\\mathrm{ext}} = -e E_s\\,$。与该场相关的势能，相对于 $\\,x=0\\,$ 处的表面，为：\n$$\nU_{\\mathrm{ext}}(x) = -F_{\\mathrm{ext}} \\cdot x = e E_s x\n$$\n问题陈述将势能定义为相对于 Fermi 能级的能量，在没有电场时，Fermi 能级比真空能级低 $\\,\\Phi_0\\,$。对于距离为 $\\,x\\,$ 的电子，总势垒 $\\,W(x)\\,$ 是逸出功与这两个势能贡献的总和：\n$$\nW(x) = \\Phi_0 + U_{\\mathrm{im}}(x) - U_{\\mathrm{ext}}(x) = \\Phi_0 - \\frac{e^2}{16\\pi\\epsilon_0 x} - e E_s x\n$$\n注意，对于一个逃逸的电子，由电场 $\\,E_s\\,$ 引起的势能项（这里为 $\\,-e E_s x\\,$）是负的，因此它降低了势垒。电子的势能是 $\\,U(x)=-e\\phi(x)\\,$，电场是 $\\,E = -\\nabla \\phi\\,$。相对于金属电势的总电势为 $\\,\\phi(x) = \\frac{e}{16\\pi\\epsilon_0 x} + E_s x\\,$。这给出了如上所述的电子势能 $\\,W(x)\\,$（不包括常数 $\\,\\Phi_0\\,$）。\n\n为了找到有效势垒高度，我们求出当 $\\,x>0\\,$ 时（假设 $\\,E_s>0\\,$）该势能函数的最大值。\n$$\n\\frac{dW}{dx} = \\frac{d}{dx} \\left( \\Phi_0 - \\frac{e^2}{16\\pi\\epsilon_0 x} - e E_s x \\right) = \\frac{e^2}{16\\pi\\epsilon_0 x^2} - e E_s\n$$\n将导数设为零，得到势垒最大值的位置 $\\,x_{\\max}\\,$：\n$$\n\\frac{e^2}{16\\pi\\epsilon_0 x_{\\max}^2} = e E_s \\implies x_{\\max} = \\sqrt{\\frac{e}{16\\pi\\epsilon_0 E_s}}\n$$\n将 $\\,x_{\\max}\\,$ 代回 $\\,W(x)\\,$ 的表达式中，得到势垒的最大高度 $\\,W_{\\max}\\,$：\n$$\nW_{\\max} = W(x_{\\max}) = \\Phi_0 - \\frac{e^2}{16\\pi\\epsilon_0 x_{\\max}} - e E_s x_{\\max}\n$$\n根据 $\\,x_{\\max}\\,$ 的条件，我们有 $\\,e E_s x_{\\max} = \\frac{e^2}{16\\pi\\epsilon_0 x_{\\max}}\\,$。因此：\n$$\nW_{\\max} = \\Phi_0 - 2 \\left( \\frac{e^2}{16\\pi\\epsilon_0 x_{\\max}} \\right) = \\Phi_0 - \\frac{e^2}{8\\pi\\epsilon_0} \\sqrt{\\frac{16\\pi\\epsilon_0 E_s}{e}} = \\Phi_0 - \\sqrt{\\frac{e^3 E_s}{4\\pi\\epsilon_0}}\n$$\n这种现象被称为 Schottky 效应。势垒降低的量为 $\\,\\Delta \\Phi_{\\mathrm{im}}(E_s)\\,$：\n$$\n\\Delta \\Phi_{\\mathrm{im}}(E_s) = \\sqrt{\\frac{e^3 E_s}{4\\pi\\epsilon_0}}\n$$\n这种降低只在加速电场 $\\,E_s > 0\\,$ 时发生。如果 $\\,E_s \\le 0\\,$，势垒仅随 $\\,x\\,$ 增加而增加，因此没有降低效应，$\\,\\Delta \\Phi_{\\mathrm{im}}(E_s)=0\\,$。以焦耳为单位的有效逸出功为 $\\,\\Phi_{\\mathrm{eff}, J} = \\Phi_{0, J} - \\Delta \\Phi_{\\mathrm{im}}(E_s)\\,$。为了将其表示为电子伏特 (eV)，我们除以元电荷 $\\,e\\,$：\n$$\n\\Phi_{\\mathrm{eff}}[\\mathrm{eV}] = \\Phi_0[\\mathrm{eV}] - \\frac{1}{e}\\sqrt{\\frac{e^3 E_s}{4\\pi\\epsilon_0}} = \\Phi_0[\\mathrm{eV}] - \\sqrt{\\frac{e E_s}{4\\pi\\epsilon_0}}\n$$\n最终势垒被限制在零或以上，所以 $\\,\\Phi_{\\mathrm{eff}} = \\max\\{0, \\Phi_0 - \\Delta \\Phi_{\\mathrm{im}}(E_s)\\}\\,$。\n\n### 2. 热电子发射电流密度\n\n热电子发射是电子因热能而从灼热表面流出的现象。我们使用自由电子模型和 Maxwell-Boltzmann 统计（适用于发射的高能 Fermi-Dirac 分布尾部）来推导电流密度。单位体积内动量在微分体积 $\\,d^3p = dp_x dp_y dp_z\\,$ 内的电子数为 $\\,dn = \\frac{2}{h^3} f(E) d^3p\\,$，其中 $\\,f(E) \\approx e^{-(E-E_F)/(k_B T)}\\,$。\n\n电流密度是对所有能够克服势垒的电子的电荷乘以垂直于表面的速度分量 $\\,v_x=p_x/m_e\\,$ 进行积分。如果电子垂直于表面运动的动能 $\\,p_x^2/(2m_e)\\,$ 大于有效逸出功 $\\,\\Phi_{\\mathrm{eff}}\\,$，它就能逃逸。我们以 Fermi 能级为能量参考点，所以要求 $\\,p_x^2/(2m_e) > \\Phi_{\\mathrm{eff}}\\,$。\n\n电流密度 $\\,J_{\\mathrm{em}}\\,$ 为：\n$$\nJ_{\\mathrm{em}} = \\int e v_x dn = \\frac{2e}{h^3} \\int_{p_{x,\\min}}^\\infty dp_x \\int_{-\\infty}^\\infty dp_y \\int_{-\\infty}^\\infty dp_z \\left(\\frac{p_x}{m_e}\\right) e^{-( (p_x^2+p_y^2+p_z^2)/(2m_e) ) / (k_B T)}\n$$\n这里，为简单起见，我们已设 $\\,E_F=0\\,$。$\\,p_x\\,$ 的积分下限为 $\\,p_{x,\\min} = \\sqrt{2m_e \\Phi_{\\mathrm{eff}}}\\,$。对 $\\,p_y\\,$ 和 $\\,p_z\\,$ 的积分是标准的高斯积分：$\\int_{-\\infty}^\\infty e^{-ap^2}dp = \\sqrt{\\pi/a}\\,$。此处 $\\,a=1/(2m_e k_B T)\\,$，因此每个积分的计算结果为 $\\,\\sqrt{2\\pi m_e k_B T}\\,$。\n$$\nJ_{\\mathrm{em}} = \\frac{2e}{h^3} (2\\pi m_e k_B T) \\int_{\\sqrt{2m_e \\Phi_{\\mathrm{eff}}}}^\\infty \\frac{p_x}{m_e} e^{-p_x^2/(2m_e k_B T)} dp_x\n$$\n为求解对 $\\,p_x\\,$ 的积分，令 $\\,u = p_x^2/(2m_e k_B T)\\,$。则 $\\,du = (p_x / (m_e k_B T)) dp_x\\,$。积分变为：\n$$\n\\int_{\\Phi_{\\mathrm{eff}}/(k_B T)}^\\infty (k_B T) e^{-u} du = k_B T [-e^{-u}]_{\\Phi_{\\mathrm{eff}}/(k_B T)}^\\infty = k_B T e^{-\\Phi_{\\mathrm{eff}}/(k_B T)}\n$$\n将此结果代回，我们得到：\n$$\nJ_{\\mathrm{em}} = \\frac{2e}{h^3} (2\\pi m_e k_B T) (k_B T e^{-\\Phi_{\\mathrm{eff}}/(k_B T)}) = \\left(\\frac{4\\pi m_e e k_B^2}{h^3}\\right) T^2 e^{-\\Phi_{\\mathrm{eff}}/(k_B T)}\n$$\n这就是 Richardson-Dushman 方程，$\\,J_{\\mathrm{em}} = A_R T^2 e^{-\\Phi_{\\mathrm{eff}}/(k_B T)}\\,$，其中 Richardson 常数 $\\,A_R\\,$ 被确定为：\n$$\nA_R = \\frac{4\\pi m_e e k_B^2}{h^3} \\approx 1.2017 \\times 10^6 \\, \\mathrm{A\\,m^{-2}\\,K^{-2}}\n$$\n在此公式中，逸出功 $\\,\\Phi_{\\mathrm{eff}}\\,$ 必须以焦耳为单位。\n\n### 3. 空间电荷限制电流密度\n\n当发射很强时，阴极（$\\,x=0\\,$）和阳极（$\\,x=d\\,$）之间间隙中发射的电子所带的电荷会变得显著。这种“空间电荷”会产生其自身的电场，从而阻碍进一步的发射。由间隙两端的电势差 $\\,V\\,$ 所能维持的最大电流被称为空间电荷限制电流，由 Child-Langmuir 定律给出。\n\n我们从一维 Poisson 方程和能量守恒出发推导它，假设电子发射时的初始速度为零。\nPoisson 方程：$\\,\\frac{d^2\\phi}{dx^2} = -\\frac{\\rho(x)}{\\epsilon_0}\\,$。\n能量守恒：$\\,\\frac{1}{2}m_e v(x)^2 = e \\phi(x)\\,$，得出 $\\,v(x) = \\sqrt{2e\\phi(x)/m_e}\\,$。\n电流连续性：$\\,J = |\\rho(x)| v(x)\\,$，所以 $\\,|\\rho(x)| = J/v(x) = J \\sqrt{m_e/(2e\\phi(x))}\\,$。\n代入 Poisson 方程（$\\rho = -|\\rho|$）：\n$$\n\\frac{d^2\\phi}{dx^2} = \\frac{J}{\\epsilon_0} \\sqrt{\\frac{m_e}{2e}} \\phi^{-1/2}\n$$\n我们用边界条件 $\\,\\phi(0)=0\\,$ 和 $\\,\\phi(d)=V\\,$ 求解此常微分方程。空间电荷限制条件意味着由于电荷云的存在，阴极处的电场消失：$\\,E(0) = -(d\\phi/dx)|_{x=0} = 0\\,$。对常微分方程积分一次得到 $\\,(d\\phi/dx)^2 = 4(J/\\epsilon_0)\\sqrt{m_e/(2e)} \\phi^{1/2}\\,$。第二次积分得到 $\\,\\frac{4}{3}\\phi^{3/4} = 2\\sqrt{J/\\epsilon_0} (m_e/(2e))^{1/4} x\\,$。应用阳极边界条件 $\\,\\phi(d)=V\\,$ 并求解电流密度 $\\,J_{CL}\\,$，得到：\n$$\nJ_{\\mathrm{CL}} = \\frac{4\\epsilon_0}{9} \\sqrt{\\frac{2e}{m_e}} \\frac{V^{3/2}}{d^2}\n$$\n使用关系式 $\\,V = E_{\\mathrm{ext}}d\\,$，我们可以用外加电场表示 $\\,J_{\\mathrm{CL}}\\,$：\n$$\nJ_{\\mathrm{CL}}(E_{\\mathrm{ext}}, d) = \\frac{4\\epsilon_0}{9} \\sqrt{\\frac{2e}{m_e}} E_{\\mathrm{ext}}^{3/2} d^{-1/2}\n$$\n此表达式在 $\\,E_{\\mathrm{ext}} > 0\\,$（因此 $\\,V>0\\,$）时有效。如果 $\\,E_{\\mathrm{ext}} \\le 0\\,$，没有电流可以被引出，所以 $\\,J_{\\mathrm{CL}}=0\\,$。\n\n### 4. 自洽模型\n\n最后一步是结合这些效应。阴极*能够*发射的电流 $\\,J_{\\mathrm{em}}\\,$ 通过 Schottky 效应依赖于表面电场 $\\,E_s\\,$。间隙*能够*维持的电流 $\\,J_{\\mathrm{CL}}\\,$ 依赖于外加电场 $\\,E_{\\mathrm{ext}}\\,$ 和间隙距离 $\\,d\\,$。模型的核心是强制保持一致性。\n\n其流程如下：\n1.  假设电流是*供应限制*的。这意味着空间电荷可以忽略不计，表面电场就是外加电场，即 $\\,E_s = E_{\\mathrm{ext}}\\,$。\n2.  使用这个表面电场 $\\,E_s=E_{\\mathrm{ext}}\\,$，通过 Schottky 公式计算一个临时的有效逸出功 $\\,\\Phi_{\\mathrm{eff, prov}}\\,$。\n3.  计算相应的热电子发射电流 $\\,J_{\\mathrm{em}}(T, \\Phi_{\\mathrm{eff, prov}})\\,$。\n4.  计算最大可持续电流密度 $\\,J_{\\mathrm{CL}}(V, d)\\,$，其中 $\\,V=E_{\\mathrm{ext}}d\\,$。\n5.  比较 $\\,J_{\\mathrm{em}}\\,$ 和 $\\,J_{\\mathrm{CL}}\\,$：\n    -   如果 $\\,J_{\\mathrm{em}} \\le J_{\\mathrm{CL}}\\,$：假设是正确的。阴极是瓶颈，有效势垒确实被外加电场降低了。最终的有效逸出功是 $\\,\\Phi_{\\mathrm{eff}} = \\Phi_{\\mathrm{eff, prov}}\\,$.\n    -   如果 $\\,J_{\\mathrm{em}} > J_{\\mathrm{CL}}\\,$：假设是错误的。阴极*试图*发射的电流超过了间隙能够传输的电流。空间电荷会累积并抑制阴极处的电场。在这种*空间电荷限制*区域，模型近似认为表面电场被完全抑制，即 $\\,E_s = 0\\,$。当表面电场为零时，没有 Schottky 降低效应，因此有效势垒就是裸逸出功，$\\,\\Phi_{\\mathrm{eff}} = \\Phi_0\\,$。\n\n这个逻辑为每个参数集提供了一种确定性的方法来寻找自洽的有效发射势垒。所有能量在计算中都以焦耳处理，最终输出时转换为电子伏特。最终值被限制在零或以上。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the effective emission barrier for electrons from a metallic surface\n    by self-consistently solving for thermionic emission and space-charge limits.\n    \"\"\"\n    # Physical Constants (CODATA 2018)\n    e = 1.602176634e-19  # Elementary charge [C]\n    eps0 = 8.8541878128e-12 # Vacuum permittivity [F/m]\n    me = 9.1093837015e-31  # Electron mass [kg]\n    kB = 1.380649e-23      # Boltzmann constant [J/K]\n    h = 6.62607015e-34    # Planck constant [J s]\n\n    # Derived constants for the model\n    # Richardson constant A_R = (4 * pi * me * e * kB^2) / h^3\n    AR = (4 * np.pi * me * e * kB**2) / h**3\n\n    # Schottky effect pre-factor (in Joules per (V/m)^0.5)\n    # Delta_Phi_J = k_S * sqrt(E_s)\n    k_S = np.sqrt(e**3 / (4 * np.pi * eps0))\n\n    # Child-Langmuir law pre-factor (in A * m^2 / V^1.5)\n    # J_CL = k_CL * V^1.5 / d^2\n    k_CL = (4 * eps0 / 9) * np.sqrt(2 * e / me)\n\n    # Test suite: (Phi_0 [eV], T [K], E_ext [V/m], d [m])\n    test_cases = [\n        (4.50, 2200, 2.0e6, 1.0e-5),   # Case 1\n        (4.50, 2900, 2.0e6, 1.0e-3),   # Case 2\n        (4.50, 3300, 2.0e6, 1.0e-3),   # Case 3\n        (4.50, 2500, 0.0, 1.0e-4),    # Case 4\n        (4.50, 2000, 5.0e7, 1.0e-5),   # Case 5\n    ]\n    \n    results = []\n\n    for case in test_cases:\n        Phi0_eV, T, E_ext, d = case\n        Phi0_J = Phi0_eV * e\n\n        # Step 1: Provisional calculation assuming supply-limited regime (E_s = E_ext)\n        E_s = E_ext\n        \n        # Calculate Schottky barrier lowering\n        # Delta_Phi is 0 if E_s is not a positive, accelerating field\n        if E_s > 0:\n            delta_Phi_J = k_S * np.sqrt(E_s)\n        else:\n            delta_Phi_J = 0.0\n        \n        Phi_eff_prov_J = Phi0_J - delta_Phi_J\n\n        # Calculate thermionic emission current density for the provisional barrier\n        # Ensure the argument to exp is not excessively large\n        if Phi_eff_prov_J / (kB * T) > 700: # Avoid overflow for np.exp\n            J_em = 0.0\n        else:\n            J_em = AR * T**2 * np.exp(-Phi_eff_prov_J / (kB * T))\n            \n        # Step 2: Calculate space-charge-limited current density\n        V = E_ext * d\n        \n        # Child-Langmuir law is valid for V > 0. If V = 0, no current can be drawn.\n        if V > 0:\n            J_CL = k_CL * (V**1.5) / (d**2)\n        else:\n            J_CL = 0.0\n\n        # Step 3: Compare and determine the operating regime\n        # N.B. V > 0 is implied by J_CL > 0. If J_em > J_CL, the flow is space-charge limited.\n        if J_em > J_CL and J_CL > 0: # J_CL > 0 check handles V=0 case properly\n            # Space-charge-limited: surface field collapses, no Schottky lowering\n            Phi_eff_final_J = Phi0_J\n        else:\n            # Supply-limited: provisional calculation is correct\n            Phi_eff_final_J = Phi_eff_prov_J\n            \n        # Step 4: Convert final effective barrier to eV and clamp at zero\n        Phi_eff_final_eV = Phi_eff_final_J / e\n        Phi_eff_final_eV = max(0.0, Phi_eff_final_eV)\n        \n        results.append(f\"{Phi_eff_final_eV:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2985290"}]}