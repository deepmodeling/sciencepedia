{"hands_on_practices": [{"introduction": "扫描隧道显微镜 (STM) 的一个核心能力是扫描隧道谱 (STS)，它通过测量微分电导 ($dI/dV$) 来探测样品表面的局域电子态密度 (LDOS)。这个练习将指导你推导在一个有能隙的二维材料中，测得的隧道谱与材料理论电子态密度之间的直接关系，这是理解凝聚态物质电子性质的一个基本实践。通过这个计算 [@problem_id:47828]，你可以亲身体会理论模型如何与实验可观测量联系起来。", "problem": "一台扫描隧道显微镜（STM）用于在零温（$T=0$ K）下探测一种二维材料。该材料中的准粒子激发被描述为有质量的狄拉克费米子，其相对于费米能级的能量色散关系由 $E(\\mathbf{k}) = \\pm \\sqrt{(\\hbar v_F k)^2 + \\Delta^2}$ 给出。在此，$\\mathbf{k}$ 是二维波矢，$v_F$ 是费米速度，而 $\\Delta > 0$ 是一个与费米子质量相关的常数，它打开了一个大小为 $E_g = 2\\Delta$ 的全能隙。\n\n根据该色散关系，样品的单位面积电子态密度（DOS）$\\rho_s(E)$ 被确定为：\n$$\n\\rho_s(E) = \\begin{cases} \n      C_0 |E|  |E| \\ge \\Delta \\\\\n      0  |E|  \\Delta \n   \\end{cases}\n$$\n其中 $C_0$ 是一个取决于材料性质的正常数。\n\n隧道电流 $I$ 作为施加在针尖和样品之间的偏置电压 $V$ 的函数，在低温下由标准表达式建模：\n$$\nI(V) = K \\int_{-\\infty}^{\\infty} \\rho_s(E) [f(E) - f(E-eV)] dE\n$$\n在该模型中，$K$ 是一个包含隧道矩阵元和针尖态密度（两者均假定在相关能量范围内为常数）的正常数，$e$ 是元电荷，$f(E)$ 是费米-狄拉克分布函数。样品的费米能级设定在 $E=0$。在 $T=0$ K 时，$f(E)$ 是一个阶跃函数：当 $E0$ 时 $f(E)=1$，当 $E>0$ 时 $f(E)=0$。\n\n推导归一化微分隧道电导的闭式解析表达式，其定义为 $\\mathcal{G}(V) = \\frac{dI/dV}{I/V}$。该表达式在偏置电压 $|V|$ 满足隧道能量 $|eV|$ 大于能隙参数 $\\Delta$（即 $|eV| > \\Delta$）时有效。你的最终答案应该用偏置电压 $V$、能隙参数 $\\Delta$ 和元电荷 $e$ 来表示。", "solution": "为了推导归一化微分隧道电导 $\\mathcal{G}(V) = \\frac{dI/dV}{I/V}$，我们首先使用给定的表达式分析在 $T = 0$ K 时的隧道电流 $I(V)$：\n\n$$\nI(V) = K \\int_{-\\infty}^{\\infty} \\rho_s(E) [f(E) - f(E - eV)] \\, dE\n$$\n\n在零温下，费米-狄拉克分布 $f(E)$ 是一个阶跃函数：\n$$\nf(E) = \n\\begin{cases}\n1  E  0 \\\\\n0  E > 0\n\\end{cases}\n$$\n\n因此，$f(E) - f(E - eV)$ 变为：\n$$\nf(E) - f(E - eV) = \n\\begin{cases}\n-1  0 \\leq E  eV \\quad \\text{(for } V > 0\\text{)} \\\\\n+1  eV \\leq E  0 \\quad \\text{(for } V  0\\text{)}\n\\end{cases}\n$$\n\n态密度 $\\rho_s(E)$ 仅在 $|E| \\geq \\Delta$ 时非零，并在该区域由 $\\rho_s(E) = C_0 |E|$ 给出。对于 $|eV| > \\Delta$，积分简化为 $\\rho_s(E) \\neq 0$ 区间的贡献。\n\n---\n\n### 步骤 1：计算 $I(V)$\n\n对于 $V > 0$，被积函数仅在 $E \\in [\\Delta, eV]$ 时非零，且 $\\rho_s(E) = C_0 E$。电流变为：\n\n$$\nI(V) = K \\int_{\\Delta}^{eV} C_0 E (-1) \\, dE = -K C_0 \\int_{\\Delta}^{eV} E \\, dE\n$$\n\n计算该积分：\n\n$$\n\\int_{\\Delta}^{eV} E \\, dE = \\frac{(eV)^2 - \\Delta^2}{2}\n$$\n\n所以，\n\n$$\nI(V) = -K C_0 \\cdot \\frac{(eV)^2 - \\Delta^2}{2} = \\frac{K C_0}{2} (\\Delta^2 - (eV)^2)\n$$\n\n---\n\n### 步骤 2：计算 $\\frac{dI}{dV}$\n\n对 $I(V)$ 关于 $V$ 求导：\n\n$$\n\\frac{dI}{dV} = \\frac{K C_0}{2} \\cdot \\left( -2 e^2 V \\right) = -K C_0 e^2 V\n$$\n\n---\n\n### 步骤 3：计算 $\\frac{I}{V}$\n\n$$\n\\frac{I}{V} = \\frac{K C_0}{2} \\cdot \\frac{\\Delta^2 - (eV)^2}{V}\n$$\n\n---\n\n### 步骤 4：计算 $\\mathcal{G}(V) = \\frac{dI/dV}{I/V}$\n\n$$\n\\mathcal{G}(V) = \\frac{-K C_0 e^2 V}{\\frac{K C_0}{2} \\cdot \\frac{\\Delta^2 - (eV)^2}{V}} = \\frac{-2 e^2 V^2}{\\Delta^2 - (eV)^2}\n$$\n\n简化分母：\n\n$$\n\\Delta^2 - (eV)^2 = -(eV)^2 + \\Delta^2 = -[(eV)^2 - \\Delta^2]\n$$\n\n所以，\n\n$$\n\\mathcal{G}(V) = \\frac{-2 e^2 V^2}{-(eV)^2 + \\Delta^2} = \\frac{2 e^2 V^2}{(eV)^2 - \\Delta^2}\n$$\n\n此表达式在 $|eV| > \\Delta$ 时有效，符合要求。\n\n---\n\n### 最终简化\n\n$$\n\\mathcal{G}(V) = \\frac{2 e^2 V^2}{e^2 V^2 - \\Delta^2}\n$$", "answer": "$$\\boxed{\\dfrac{2 e^{2} V^{2}}{e^{2} V^{2} - \\Delta^{2}}}$$", "id": "47828"}, {"introduction": "扫描探针显微镜 (SPM) 图像并非样品表面的真实写照，而是样品形貌与探针针尖形状的卷积结果。这个练习探讨了这一被称为“针尖卷积”的根本性限制，并分别阐述了其在原子力显微镜 (AFM)（几何效应）和 STM（电子效应）中的表现。准确理解针尖卷积对于正确解读 SPM 图像至关重要 [@problem_id:2519933]。", "problem": "在接触模式下，原子力显微镜 (AFM) 的探针在其针尖附近可以理想化为一个安装在刚性圆锥形针杆上的半径为 $R$ 的球体。考虑对一个包含矩形沟槽的样品进行成像：其顶面是平面的，沟槽有垂直的侧壁，侧壁间距为 $w$（在顶面测量），底部平坦，位于顶面下方深度 $d$ 处。在横向位置 $x$ 处测得的 AFM 形貌，是指球形针尖刚好与样品接触而不发生穿透的最低针尖位置的高度 $z(x)$。假设接触是纯粹排斥、无粘附的，并且在球形针尖接触样品之前，圆锥形针杆不会产生干涉。另外，在小偏压下的扫描隧道显微镜 (STM) 中，根据 Wentzel–Kramers–Brillouin 近似，隧道电流 $I$ 遵循 $I \\propto \\exp(-2 \\kappa z)$，其中 $\\kappa = \\sqrt{2 m \\phi}/\\hbar$，$m$ 是电子质量，$\\phi$ 是有效势垒高度，$\\hbar$ 是约化普朗克常数；在恒流模式下，当针尖扫描时，反馈系统会调节 $z(x)$ 来维持设定的电流值。\n\n仅使用上述 AFM 的第一性原理几何非穿透模型和 STM 的指数距离依赖关系，分析有限的针尖半径如何展宽表观特征尺寸并改变窄沟槽的测量深度。在你的分析中，将 AFM 针尖视为半径为 $R$ 的球体，将 STM 针尖视为局部尖锐但具有有限隧穿衰减长度 $1/(2 \\kappa)$。对于一个具体的数值案例，考虑 $R = 10\\,\\mathrm{nm}$，$w = 8\\,\\mathrm{nm}$ 和 $d = 5\\,\\mathrm{nm}$。\n\n选择所有正确的选项。\n\nA. 在接触模式 AFM 扫描矩形沟槽时，沟槽中心的最大表观深度（相对于顶面）为 $d_{\\mathrm{AFM}}^{\\max}(w,R,d) = \\min\\!\\left(d,\\, R - \\sqrt{R^{2} - (w/2)^{2}}\\right)$，该结果由球形针尖在无法进一步下降而不接触侧壁时，同时接触两个沟槽边缘的条件得出。\n\nB. 在 AFM 的 $w \\ll R$ 极限下，对于深度大于针尖限制下降距离的沟槽，中心的表观深度满足 $d_{\\mathrm{AFM}}^{\\max} \\approx w^{2}/(8 R)$，与 $d$ 无关。\n\nC. AFM 球形针尖能够到达并扫描沟槽底部的充要条件是 $w \\ge 2 \\sqrt{2 R d - d^{2}}$（对于 $d \\le 2 R$）；等价地，如果不满足此条件，则针尖永远无法到达底部，测得的深度受针尖限制。\n\nD. 在 STM 恒流成像中，如果针尖是原子级尖锐的，即 $R \\to 0$，那么表观沟槽深度等于真实深度 $d$，因为隧道电流仅产生于针尖正下方的最近点，没有横向扩展。\n\nE. 在 STM 恒流成像中，即使针尖非常尖锐，有限的衰减长度 $1/(2 \\kappa)$ 也会导致从沟槽侧壁横向收集隧道电流；因此，对于足够窄的沟槽，反馈系统会将表观沟槽深度减小到 $d$ 以下，这构成了一种不同于纯粹几何展宽的有效针尖卷积效应。\n\nF. 在 AFM 敲击模式下，间歇性接触消除了针尖卷积效应，因此表观沟槽宽度和深度等于 $w$ 和 $d$，与 $R$ 无关。\n\nG. 对于 $R = 10\\,\\mathrm{nm}$，$w = 8\\,\\mathrm{nm}$ 和 $d = 5\\,\\mathrm{nm}$，AFM 在中心的表观最大深度约为 $0.84\\,\\mathrm{nm}$，并且针尖没有到达沟槽底部。", "solution": "接触模式下的 AFM 成像过程可以形式化为一个非穿透问题：测得的高度轮廓是不与样品相交的针尖位置的下包络线。将针尖建模为半径为 $R$ 的球体，该包络线的构建等同于用针尖形状对样品进行形态学膨胀。对于具有垂直壁和水平底部的矩形沟槽，球形针尖在沟槽中心的极限下降发生在球体同时接触两个上边缘时；超过该点，任何进一步的下降都会穿透侧壁。\n\n为了推导沟槽中心处受针尖限制的最大下降距离，我们将顶面置于 $z = 0$，沟槽中心置于 $x = 0$。垂直壁位于 $x = \\pm w/2$，从 $z = 0$ 向下延伸。设球心位于 $(x,z) = (0, z_{c})$，其针尖（最低点）位于 $z_{\\mathrm{apex}} = z_{c} - R$。球体刚好接触位于 $(x,z) = (\\pm w/2, 0)$ 的两个顶边，意味着这些边缘点位于球面上。因此，同时接触的条件是\n$$(w/2)^{2} + (0 - z_{c})^{2} = R^{2},$$\n使得\n$$z_{c} = \\sqrt{R^{2} - (w/2)^{2}}.$$\n相应的针尖相对于顶面的高度是\n$$z_{\\mathrm{apex}} = z_{c} - R = -\\left(R - \\sqrt{R^{2} - (w/2)^{2}}\\right).$$\n因此，针尖在顶面下方不发生穿透的最大下降距离为\n$$\\Delta z_{\\max}(w,R) = R - \\sqrt{R^{2} - (w/2)^{2}},$$\n前提是 $w \\le 2 R$ 以保证平方根为实数。沟槽中心的表观深度是这个受针尖限制的下降距离与真实深度 $d$ 中较小的一个，\n$$d_{\\mathrm{AFM}}^{\\max}(w,R,d) = \\min\\!\\left(d,\\, R - \\sqrt{R^{2} - (w/2)^{2}}\\right).$$\n如果 $w > 2 R$，侧壁不再约束球体，针尖原则上可以到达底部；在这种情况下，测得的深度为 $d$（不考虑针杆的干涉，根据假设我们忽略这一点）。\n\n对于 $w \\ll R$ 的情况，使用 $\\sqrt{1 - x} \\approx 1 - x/2$（对于小的 $x$）展开平方根，其中 $x = (w/2R)^{2}$。可以得到\n$$R - \\sqrt{R^{2} - (w/2)^{2}} = R \\left[1 - \\sqrt{1 - \\left(\\frac{w}{2R}\\right)^{2}}\\right] \\approx R \\left[1 - \\left(1 - \\tfrac{1}{2}\\left(\\tfrac{w}{2R}\\right)^{2}\\right)\\right] = \\frac{w^{2}}{8 R}.$$\n因此，当 $d \\gg w^{2}/(8 R)$ 时，表观深度为 $d_{\\mathrm{AFM}}^{\\max} \\approx w^{2}/(8 R)$，与 $d$ 无关。\n\n针尖到达沟槽底部的条件是，当针尖位于底部时（即 $z_{\\mathrm{apex}} = -d$，也就是 $z_{c} = R - d$），球体不与顶边处的侧壁相交。在 $(\\pm w/2, 0)$ 处不相交要求这些边缘点位于球体外部或球面上：\n$$(w/2)^{2} + (0 - z_{c})^{2} \\ge R^{2}.$$\n代入 $z_{c} = R - d$ 得出\n$$(w/2)^{2} + (R - d)^{2} \\ge R^{2} \\;\\;\\Rightarrow\\;\\; (w/2)^{2} \\ge 2 R d - d^{2}.$$\n因此，针尖到达底部的充要条件是\n$$w \\ge 2 \\sqrt{2 R d - d^{2}}, \\quad \\text{for } d \\le 2 R.$$\n如果这个不等式不成立，针尖就无法到达底部；测得的深度会受到上述几何约束的限制。\n\n转向扫描隧道显微镜 (STM)，恒流形貌 $z(x)$ 由针尖与样品之间的积分隧道电流等于设定值的条件隐式定义。在最简单的局域近似中，任何与针尖相隔间隙 $z$ 的局域点的隧道电流遵循 $I \\propto \\exp(-2 \\kappa z)$，其中 $\\kappa = \\sqrt{2 m \\phi}/\\hbar$。关键是，这种依赖关系在横向范围上并非严格局域的：如果邻近区域到针尖的真空间隙没有大很多，那么这些区域在相似 $z$ 处的贡献是相当的。在一个有垂直侧壁的沟槽上方，即使是位于沟槽中心的原子级尖锐针尖 ($R \\to 0$) 也会从侧壁接收到显著的电流，因为侧壁到针尖的最短距离仅比垂直间隙稍大；随着针尖下降，由于指数定律，侧壁的贡献迅速增加，导致反馈系统收回针尖以维持设定值。因此，对于足够窄的 $w$，表观沟槽深度会减小到真实深度 $d$ 以下。这种展宽机制本质上是电子效应（由 $\\kappa$ 决定），即使在 $R \\to 0$ 时也存在，这使其与纯粹的几何展宽区别开来。\n\n我们现在评估每个选项：\n\nA. 这正是上面推导出的几何非穿透结果。中心的最大表观深度受限于与两个边缘同时接触，给出 $d_{\\mathrm{AFM}}^{\\max}(w,R,d) = \\min\\!\\left(d,\\, R - \\sqrt{R^{2} - (w/2)^{2}}\\right)$，前提是 $w \\le 2 R$，当 $w > 2 R$ 时则简化为 $d$。结论：正确。\n\nB. 使用 $w \\ll R$ 的小宗量展开，我们发现 $d_{\\mathrm{AFM}}^{\\max} \\approx w^{2}/(8 R)$，前提是真实深度 $d$ 超过此针尖限制值。在该范围内，此结果与 $d$ 无关。结论：正确。\n\nC. 我们推导出了到达底部的判据 $w \\ge 2 \\sqrt{2 R d - d^{2}}$（对于 $d \\le 2 R$）。此不等式不成立意味着针尖无法到达底部，测得的深度受到针尖几何形状的限制。结论：正确。\n\nD. 该陈述假设隧穿具有完美的局域性，这与导致有限横向电流收集的指数距离依赖性相矛盾。即使对于 $R \\to 0$，附近的侧壁也有贡献，因为它们与针尖的距离仅比垂直间隙稍大，所以表观深度不保证等于 $d$。结论：不正确。\n\nE. 该选项正确地指出，有限的衰减长度 $1/(2 \\kappa)$ 导致隧道电流的横向平均，即使对于原子级尖锐的针尖，在窄沟槽中也会减小表观深度。这是一种不同于纯粹几何展宽的电子卷积效应。结论：正确。\n\nF. 敲击（振幅调制）AFM 减少了剪切力和粘附力，但并未消除由有限针尖半径设定的几何约束；间歇性接触不能使针尖变得更窄。针尖卷积效应依然存在，因此表观宽度和深度依赖于 $R$。结论：不正确。\n\nG. 使用 $R = 10\\,\\mathrm{nm}$，$w = 8\\,\\mathrm{nm}$ 和 $d = 5\\,\\mathrm{nm}$，计算\n$$R - \\sqrt{R^{2} - (w/2)^{2}} = 10\\,\\mathrm{nm} - \\sqrt{(10\\,\\mathrm{nm})^{2} - (4\\,\\mathrm{nm})^{2}} = 10\\,\\mathrm{nm} - \\sqrt{100 - 16}\\,\\mathrm{nm} = 10\\,\\mathrm{nm} - \\sqrt{84}\\,\\mathrm{nm}.$$\n由于 $\\sqrt{84} \\approx 9.165$，针尖限制的下降距离约为 $0.835\\,\\mathrm{nm}$。因为 $d = 5\\,\\mathrm{nm}$ 超过这个值，所以表观深度约为 $0.84\\,\\mathrm{nm}$。检查到达底部的判据：\n$$2 \\sqrt{2 R d - d^{2}} = 2 \\sqrt{2 \\cdot 10 \\cdot 5 - 25}\\,\\mathrm{nm} = 2 \\sqrt{100 - 25}\\,\\mathrm{nm} = 2 \\sqrt{75}\\,\\mathrm{nm} \\approx 17.32\\,\\mathrm{nm}.$$\n给定的 $w = 8\\,\\mathrm{nm}$ 小于此阈值，所以针尖无法到达底部。结论：正确。", "answer": "$$\\boxed{ABCEG}$$", "id": "2519933"}, {"introduction": "任何扫描探针显微镜的精度都依赖于其压电扫描器的精确和可重复运动。然而，压电陶瓷固有的磁滞和非线性效应是必须面对的挑战。这个实践性的编程练习模拟了从测量数据中表征扫描器磁滞和非线性的真实任务，这对于仪器校准和高级数据处理是必不可少的技能 [@problem_id:2662481]。", "problem": "您的任务是量化用于扫描探针显微镜（SPM）的压电扫描器的磁滞和非线性，特别是在扫描隧道显微镜（STM）和原子力显微镜（AFM）的应用背景下。在典型实验中，驱动扫描器的压电致动器由于铁电畴物理和材料蠕变，其位移与电压的关系表现出路径依赖性，从而产生不同的前向和后向曲线。在物理化学和材料表征领域，一种常用且经过充分检验的建模方法是，用一个关于电压的低阶多项式来近似每次扫描，然后计算在指定范围内总结磁滞和静态非线性的度量指标。\n\n从以下基本依据出发：\n\n- 扫描器位移与施加电压的关系在一个有限范围内，可以通过一个关于施加电压的截断多项式很好地近似。这源于在工作点附近的 Taylor 展开，并被广泛用于捕捉压电致动器的低阶非线性和磁滞。\n- 对每个扫描方向，使用普通最小二乘法通过最小化模型预测与观测数据之间的残差平方和来估计模型参数。\n\n您的程序必须为每个测试用例实现以下内容：\n\n1. 数据生成：\n   - 使用一个从 $V_{\\min} = -50\\,\\mathrm{V}$ 到 $V_{\\max} = +50\\,\\mathrm{V}$、包含 $N = 201$ 个点的均匀电压网格。\n   - 按如下方式生成前向和后向的合成位移数据集。定义基础位移为 $x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，并定义一个反对称磁滞贡献 $h(V) = h_{1} V + h_{3} V^{3}$。然后：\n     - 前向扫描位移（无噪声）：$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$。\n     - 后向扫描位移（无噪声）：$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$。\n   - 为每个位移样本添加均值为零、标准差为 $\\sigma$ 的独立同分布高斯噪声。为保证可复现性，对每个测试用例，前向扫描使用给定整数种子 $s$ 的伪随机数生成器，后向扫描使用种子 $s+1$。\n   - 位移单位必须是 $\\mathrm{nm}$，电压单位必须是 $\\mathrm{V}$。\n\n2. 多项式拟合：\n   - 通过普通最小二乘法（最小化残差平方和），将前向数据集和后向数据集分别拟合到关于 $V$ 的 $d=3$ 次多项式。\n\n3. 磁滞幅度：\n   - 在一个从 $-50\\,\\mathrm{V}$ 到 $+50\\,\\mathrm{V}$、包含 $M = 1001$ 个电压点的密集均匀评估网格上，计算拟合的前向曲线 $x_{\\mathrm{f,fit}}(V)$ 和拟合的后向曲线 $x_{\\mathrm{b,fit}}(V)$。\n   - 将磁滞幅度 $H$ 定义为这两条拟合曲线在该范围内的最大绝对差：\n     $$H = \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|.$$\n   - 报告 $H$ 的值，单位为 $\\mathrm{nm}$，四舍五入到 $3$ 位小数。\n\n4. 静态非线性：\n   - 在相同的密集网格上，定义平均拟合曲线 $m(V) = \\dfrac{x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V)}{2}$。\n   - 在密集网格上通过普通最小二乘法将一个理想线性参考 $L(V)$ 拟合到 $m(V)$（即一个关于 $V$ 的 $1$ 次多项式）。\n   - 定义全量程范围 $\\mathrm{FSR} = L(+50\\,\\mathrm{V}) - L(-50\\,\\mathrm{V})$。\n   - 将静态非线性定义为与线性参考的最大绝对偏差，并用全量程范围进行归一化：\n     $$\\mathrm{NL} = \\frac{ \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }.$$\n   - 报告 $\\mathrm{NL}$ 的值，形式为无单位小数（而非百分比），四舍五入到 $6$ 位小数。\n\n5. 输出格式：\n   - 对每个测试用例，输出一个包含两个条目 $[H, \\mathrm{NL}]$ 的列表。\n   - 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，具体来说是一个列表的列表：$\\big[ [H_{1}, \\mathrm{NL}_{1}], [H_{2}, \\mathrm{NL}_{2}], \\dots \\big]$。\n\n测试套件（请严格按照指定参数使用；所有系数的单位均为 $\\mathrm{nm}$ 每 $\\mathrm{V}$ 的相应次方）：\n\n- 案例 1 (轻度磁滞，弱非线性)：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 5.0\\times 10^{-6}$,\n  - $h_{1} = 0.20$, $h_{3} = 1.0\\times 10^{-5}$,\n  - $\\sigma = 0.02$, $s = 42$。\n- 案例 2 (强磁滞，中等非线性)：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 1.0\\times 10^{-5}$,\n  - $h_{1} = 1.00$, $h_{3} = 3.0\\times 10^{-5}$,\n  - $\\sigma = 0.01$, $s = 7$。\n- 案例 3 (纯线性，无磁滞，无噪声)：\n  - $a_{1} = 1.50$, $a_{2} = 0.0$, $a_{3} = 0.0$,\n  - $h_{1} = 0.0$, $h_{3} = 0.0$,\n  - $\\sigma = 0.0$, $s = 0$。\n- 案例 4 (轻度非线性伴有小磁滞)：\n  - $a_{1} = 1.80$, $a_{2} = 1.5\\times 10^{-3}$, $a_{3} = -4.0\\times 10^{-6}$,\n  - $h_{1} = 0.10$, $h_{3} = 0.0$,\n  - $\\sigma = 0.015$, $s = 123$。\n\n角度单位不适用。请确保 $H$ 以 $\\mathrm{nm}$ 为单位表示，并四舍五入到 $3$ 位小数，$\\mathrm{NL}$ 以小数形式表示，并四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含所有结果，格式为方括号括起来的逗号分隔列表，例如：$[[H_{1},\\mathrm{NL}_{1}],[H_{2},\\mathrm{NL}_{2}],[H_{3},\\mathrm{NL}_{3}],[H_{4},\\mathrm{NL}_{4}]]$.", "solution": "问题陈述已经过严格验证。它具有科学依据、提法明确且客观。它正确地阐述了实验物理化学中用于表征扫描探针显微镜中使用的压电致动器的标准流程。所提供的模型、定义和参数是一致的、物理上现实的，并且足以得出一个唯一且有意义的解。因此，该问题被认为是有效的。\n\n解决方案要求实现一个计算协议，用以量化压电扫描器的两个关键性能指标：磁滞和静态非线性。该方法遵循一系列逻辑步骤，从合成真实的测量数据开始，到计算指定的度量指标结束。\n\n首先，我们必须生成能够模拟物理扫描器行为的合成数据。压电元件的位移 $x$ 作为施加电压 $V$ 的函数，本质上是非线性的并表现出磁滞。截断多项式模型是在有限工作范围内对此行为的一种成熟的近似方法。我们定义一个基础位移曲线 $x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，它捕捉了基本的非线性响应。在此基础上，我们添加一个磁滞贡献 $h(V) = h_{1} V + h_{3} V^{3}$，该贡献在前向扫描中被加上，在后向扫描中被减去，从而形成一个特征磁滞回线。因此，真实的无噪声位移函数为：\n$$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$$\n$$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$$\n实验测量不可避免地会受到噪声的干扰。我们通过为每个数据点添加标准差为 $\\sigma$ 的独立同分布高斯噪声来模拟这一点。这一过程在一个从 $V_{\\min}=-50\\,\\mathrm{V}$ 到 $V_{\\max}=+50\\,\\mathrm{V}$ 的包含 $N=201$ 个电压点 $V_i$ 的离散网格上执行。前向和后向扫描分别使用独立的伪随机数生成器种子 $s$ 和 $s+1$，以正确模拟两次测量运行的统计独立性。\n\n其次，我们必须从这些带噪声的合成数据中估计出底层的扫描器响应。在真实实验中，真实的函数 $x_{\\mathrm{f,true}}(V)$ 和 $x_{\\mathrm{b,true}}(V)$ 是未知的。我们通过将前向和后向数据集独立地拟合到一个 $d=3$ 次的多项式来近似它们。这是一个使用普通最小二乘法（OLS）解决的模型辨识问题。OLS 确定一组多项式系数 $\\{c_k\\}$，以最小化残差平方和 $\\sum_i (x_{\\mathrm{data}}(V_i) - \\sum_{k=0}^{d} c_k V_i^k)^2$。此过程产生两条估计的响应曲线 $x_{\\mathrm{f,fit}}(V)$ 和 $x_{\\mathrm{b,fit}}(V)$。\n\n第三，我们量化磁滞幅度 $H$。磁滞是扫描器位移的路径依赖性。它被量化为在整个电压范围内，拟合的前向和后向曲线之间的最大分离距离。为了准确确定这个最大值，我们在一个包含 $M=1001$ 个点的密集网格上评估拟合的多项式。磁滞幅度则为：\n$$H = \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|$$\n\n第四，我们量化静态非线性 $\\mathrm{NL}$。该指标描述了扫描器的平均响应偏离理想线性行为的程度。我们首先计算平均路径 $m(V) = \\frac{1}{2}(x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V))$，它代表了扫描器响应的静态、非磁滞分量。然后，通过在密集评估网格上对 $m(V)$ 进行一阶多项式的 OLS 拟合，来确定一个理想的线性参考 $L(V)$。静态非线性是平均路径与此线性参考之间的最大绝对偏差，并用线性拟合的全量程范围（FSR）进行归一化，其中 $\\mathrm{FSR} = L(V_{\\max}) - L(V_{\\min})$。这种归一化产生一个无量纲量，适用于比较不同的扫描器。其公式为：\n$$\\mathrm{NL} = \\frac{ \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }$$\n如果 $\\mathrm{FSR}$ 为零，会出现一个特殊情况；然而，对于任何非平凡的扫描器响应（$a_1 \\neq 0$），这种情况不会发生。\n\n最终的程序将对四个指定的测试用例中的每一个执行这整个序列，并按要求将所得的 $[H, \\mathrm{NL}]$ 对整理成一个单一的输出结构。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the SPM scanner characterization problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: mild hysteresis, weak nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 5.0e-6),  # a1, a2, a3\n            \"h_coeffs\": (0.20, 1.0e-5),       # h1, h3\n            \"sigma\": 0.02,\n            \"seed\": 42\n        },\n        # Case 2: strong hysteresis, moderate nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 1.0e-5),\n            \"h_coeffs\": (1.00, 3.0e-5),\n            \"sigma\": 0.01,\n            \"seed\": 7\n        },\n        # Case 3: purely linear, no hysteresis, noiseless\n        {\n            \"a_coeffs\": (1.50, 0.0, 0.0),\n            \"h_coeffs\": (0.0, 0.0),\n            \"sigma\": 0.0,\n            \"seed\": 0\n        },\n        # Case 4: mild nonlinearity with small hysteresis\n        {\n            \"a_coeffs\": (1.80, 1.5e-3, -4.0e-6),\n            \"h_coeffs\": (0.10, 0.0),\n            \"sigma\": 0.015,\n            \"seed\": 123\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        a1, a2, a3 = case[\"a_coeffs\"]\n        h1, h3 = case[\"h_coeffs\"]\n        sigma = case[\"sigma\"]\n        s = case[\"seed\"]\n\n        # Define constants\n        N = 201\n        M = 1001\n        V_min, V_max = -50.0, 50.0\n        fit_degree = 3\n\n        # 1. Data generation\n        V_data = np.linspace(V_min, V_max, N)\n\n        def x_base(V):\n            return a1 * V + a2 * V**2 + a3 * V**3\n\n        def h(V):\n            return h1 * V + h3 * V**3\n\n        x_f_true = x_base(V_data) + h(V_data)\n        x_b_true = x_base(V_data) - h(V_data)\n\n        # Generate noise\n        rng_f = np.random.default_rng(seed=s)\n        noise_f = rng_f.normal(0, sigma, N)\n        rng_b = np.random.default_rng(seed=s + 1)\n        noise_b = rng_b.normal(0, sigma, N)\n\n        x_f_data = x_f_true + noise_f\n        x_b_data = x_b_true + noise_b\n        \n        # 2. Polynomial fitting\n        coeffs_f = np.polyfit(V_data, x_f_data, fit_degree)\n        coeffs_b = np.polyfit(V_data, x_b_data, fit_degree)\n\n        poly_f = np.poly1d(coeffs_f)\n        poly_b = np.poly1d(coeffs_b)\n\n        # 3. Hysteresis magnitude (H)\n        V_eval = np.linspace(V_min, V_max, M)\n        x_f_fit = poly_f(V_eval)\n        x_b_fit = poly_b(V_eval)\n\n        H = np.max(np.abs(x_f_fit - x_b_fit))\n\n        # 4. Static nonlinearity (NL)\n        m_V = (x_f_fit + x_b_fit) / 2.0\n        \n        # Fit linear reference L(V) to m(V)\n        coeffs_L = np.polyfit(V_eval, m_V, 1)\n        poly_L = np.poly1d(coeffs_L)\n        \n        # Calculate full-scale range (FSR)\n        FSR = poly_L(V_max) - poly_L(V_min)\n        \n        # Calculate nonlinearity\n        L_V = poly_L(V_eval)\n        max_deviation = np.max(np.abs(m_V - L_V))\n\n        # Handle FSR=0 case to avoid division by zero, although unlikely with given inputs\n        if np.isclose(FSR, 0):\n             NL = 0.0\n        else:\n             NL = max_deviation / FSR\n             \n        # Format results for the current case\n        result = [round(H, 3), round(NL, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list in Python is the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2662481"}]}