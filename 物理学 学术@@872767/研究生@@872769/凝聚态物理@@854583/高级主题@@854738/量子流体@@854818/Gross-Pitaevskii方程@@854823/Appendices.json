{"hands_on_practices": [{"introduction": "玻色-爱因斯坦凝聚体最引人注目的特性之一是其超流性，即无摩擦的流动。这一非凡现象的根源在于其独特的元激发谱。本练习将指导您通过线性化格罗斯-皮塔耶夫斯基方程来推导这些元激发的色散关系，并应用著名的朗道判据来确定超流性破裂的临界速度 [@problem_id:229621]。这是一个基础性的理论实践，它揭示了量子流体中耗散如何被抑制的微观机制。", "problem": "一个均匀的一维玻色-爱因斯坦凝聚体（BEC）由宏观波函数 $\\Psi(x, t)$ 描述。其动力学由含时的格罗斯-皮塔耶夫斯基方程（GPE）决定：\n$$\ni\\hbar \\frac{\\partial \\Psi}{\\partial t} = \\left(-\\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} + V_{ext}(x) + g_{1D} |\\Psi|^2 \\right) \\Psi\n$$\n其中，$m$ 是单个原子的质量，$g_{1D}$ 是一维有效相互作用强度，对于排斥相互作用，该值为正。该凝聚体的背景密度是均匀的，为 $n_0$。\n\n想象该凝聚体以恒定速度 $v$ 流过一个弱的、静止的、局域的势垒 $V_{ext}(x) = U_0 \\delta(x)$。在低速下，流动是超流且无耗散的。然而，如果速度超过某个临界值 $v_c$，凝聚体与势垒相互作用时，会通过产生元激发（准粒子）而开始损失能量和动量。这标志着超流性的破坏。\n\n根据朗道超流判据，该临界速度由元激发的最小相速度给出：\n$$\nv_c = \\min_{k \\neq 0} \\frac{\\epsilon(k)}{\\hbar k}\n$$\n其中 $\\epsilon(k)$ 是元激发的能量，作为其动量 $\\hbar k$ 的函数。\n\n你的任务是确定这个一维BEC的临界速度 $v_c$。为此，首先通过在稳态基态附近对GPE进行线性化，推导出均匀凝聚体（即 $V_{ext}(x)=0$）的元激发的色散关系 $\\epsilon(k)$。然后，应用朗道判据求出 $v_c$。用 $m$，$g_{1D}$ 和 $n_0$ 表示你的最终答案。", "solution": "1. 稳态基态：令 $\\Psi_0(x,t)=\\sqrt{n_0}\\,e^{-i\\mu t/\\hbar}$。根据 $V_{ext}=0$ 的不含时GPE，\n$$\n\\mu\\,\\Psi_0 = \\Big(-\\frac{\\hbar^2}{2m}\\partial_x^2 + g_{1D}|\\Psi_0|^2\\Big)\\Psi_0\n\\quad\\Longrightarrow\\quad\n\\mu = g_{1D}n_0.\n$$\n\n2. 线性化GPE：设\n$$\n\\Psi(x,t)=\\Big[\\sqrt{n_0}+u\\,e^{i(kx-\\omega t)}+v^*\\,e^{-i(kx-\\omega t)}\\Big]e^{-i\\mu t/\\hbar},\n$$\n其中 $|u|,|v|\\ll\\sqrt{n_0}$。将其代入GPE并保留关于 $u,v$ 的线性项，得到博戈留波夫-德热纳方程，其自洽条件给出了色散关系。\n\n3. 博戈留波夫色散关系：\n$$\n\\epsilon(k)=\\hbar\\omega(k)\n=\\sqrt{\\frac{\\hbar^2k^2}{2m}\\Big(\\frac{\\hbar^2k^2}{2m}+2g_{1D}n_0\\Big)}.\n$$\n\n4. 朗道判据：\n$$\nv_c=\\min_{k\\neq0}\\frac{\\epsilon(k)}{\\hbar k}\n=\\min_{k}\\sqrt{\\frac{\\frac{\\hbar^2k^2}{2m}+2g_{1D}n_0}{2m}}\n\\ge\\sqrt{\\frac{2g_{1D}n_0}{2m}}\n=\\sqrt{\\frac{g_{1D}n_0}{m}}\\,,\n$$\n当 $k\\to0$ 时达到最小值。", "answer": "$$\\boxed{\\sqrt{\\frac{g_{1D}n_0}{m}}}$$", "id": "229621"}, {"introduction": "格罗斯-皮塔耶夫斯基方程中的非线性项不仅描述了原子间的相互作用，也带来了丰富的物理现象，其中之一就是在吸引相互作用下凝聚体可能发生的塌缩。直接求解完整的非线性方程通常很困难，因此物理学家常常借助变分法等近似工具。本练习将让您应用高斯变分拟设来估算导致凝聚体不稳定的临界相互作用强度 [@problem_id:229702]，这不仅能让您亲身体验如何处理复杂的非线性问题，也加深了对凝聚体稳定性的理解。", "problem": "一个由 $N$ 个原子组成的玻色-爱因斯坦凝聚体 (BEC)，每个原子的质量为 $m$，被限制在一个三维各向同性谐振子势 $V(\\mathbf{r}) = \\frac{1}{2}m\\omega^2 r^2$ 中。原子间的相互作用由接触势描述，这导致能量泛函中出现一个非线性项。由宏观波函数 $\\Psi(\\mathbf{r})$ 描述的凝聚体的总能量由 Gross-Pitaevskii 能量泛函给出：\n$$E[\\Psi] = \\int \\left( \\frac{\\hbar^2}{2m} |\\nabla\\Psi|^2 + V(\\mathbf{r})|\\Psi|^2 + \\frac{g}{2}|\\Psi|^4 \\right) d^3r$$\n其中 $g$ 是相互作用耦合常数。波函数归一化到总原子数，$\\int |\\Psi|^2 d^3r = N$。\n\n对于吸引相互作用（$g0$），如果吸引力足够强，凝聚体可能会变得不稳定并发生塌缩。我们可以使用带有试探波函数的变分方法来研究这种不稳定性。假设凝聚体波函数可以很好地由一个球对称高斯函数近似：\n$$\\Psi(\\mathbf{r}) = \\left(\\frac{N}{\\pi^{3/2}\\sigma^3}\\right)^{1/2} \\exp\\left(-\\frac{r^2}{2\\sigma^2}\\right)$$\n其中 $\\sigma$ 是一个表示凝聚体云宽度的变分参数。\n\n凝聚体的稳定性取决于能量泛函 $E(\\sigma)$ 的形状。对于弱吸引，$E(\\sigma)$ 具有一个对应于亚稳态的局域最小值。随着吸引强度 $|g|$ 的增加，这个局域最小值消失，导致凝聚体不可避免地塌缩（$\\sigma \\to 0$）。\n\n确定该亚稳态不复存在时的相互作用强度的临界值 $g_c$。用 $N, m, \\omega, \\hbar$ 和数值常数表示你的答案。", "solution": "我们从变分能量出发\n$$E[\\Psi]=\\int\\!d^3r\\;\\Bigl[\\frac{\\hbar^2}{2m}|\\nabla\\Psi|^2+\\frac12m\\omega^2r^2|\\Psi|^2+\\frac g2|\\Psi|^4\\Bigr]$$\n使用高斯试探波函数\n$$\\Psi(r)=\\Bigl(\\frac{N}{\\pi^{3/2}\\sigma^3}\\Bigr)^{1/2}\\exp\\!\\Bigl(-\\frac{r^2}{2\\sigma^2}\\Bigr)\\,,\\qquad\n\\int|\\Psi|^2\\,d^3r=N\\,. $$\n\n1. 动能项\n   $$E_{\\rm kin}\n   =\\int\\frac{\\hbar^2}{2m}|\\nabla\\Psi|^2d^3r\n   =\\frac{3N\\hbar^2}{4m\\sigma^2}\\,. $$\n\n2. 势能项\n   $$E_{\\rm pot}\n   =\\int\\frac12m\\omega^2r^2|\\Psi|^2d^3r\n   =\\frac34m\\omega^2N\\sigma^2\\,, $$\n   使用 $\\langle r^2\\rangle=3\\sigma^2/2$。\n\n3. 相互作用项\n   $$E_{\\rm int}\n   =\\frac g2\\int|\\Psi|^4d^3r\n   =\\frac{gN^2}{2\\,(2\\pi)^{3/2}\\,\\sigma^3}\\,, $$\n   因为 $\\int e^{-2r^2/\\sigma^2}d^3r=\\pi^{3/2}(\\sigma^3/2^{3/2})$。\n\n因此总能量为\n$$E(\\sigma)\n=\\frac{3N\\hbar^2}{4m\\sigma^2}+\\frac34m\\omega^2N\\sigma^2\n+\\frac{gN^2}{2(2\\pi)^{3/2}\\sigma^3}\\,. $$\n\n当极值同时满足以下两个条件时，稳定性丧失\n$$\\frac{dE}{d\\sigma}=0,\\qquad \\frac{d^2E}{d\\sigma^2}=0\\,. $$\n\n计算\n$$\\frac{dE}{d\\sigma}\n=-\\frac{3N\\hbar^2}{2m\\sigma^3}+\\frac{3}{2}m\\omega^2N\\sigma\n-\\frac{3gN^2}{2(2\\pi)^{3/2}\\sigma^4}=0, $$\n$$\\frac{d^2E}{d\\sigma^2}\n=\\frac{9N\\hbar^2}{2m\\sigma^4}+\\frac{3}{2}m\\omega^2N\n+\\frac{6gN^2}{(2\\pi)^{3/2}\\sigma^5}=0\\,. $$\n\n从第一个方程得到\n$$\\frac{gN}{(2\\pi)^{3/2}}=m\\omega^2\\sigma^5-\\frac{\\hbar^2}{m}\\sigma\\,. $$\n代入第二个方程并消去 $g$ 得到\n$$-\\frac{3\\hbar^2}{2m\\sigma^4}+\\frac{15}{2}m\\omega^2=0\n\\;\\Longrightarrow\\;\\sigma^4=\\frac{\\hbar^2}{5m^2\\omega^2}\\,. $$\n\n因此在临界点\n$$m\\omega^2\\sigma^5-\\frac{\\hbar^2}{m}\\sigma\n=-\\frac{4}{5^{5/4}}\\;\\frac{\\hbar^{5/2}}{m^{3/2}\\omega^{1/2}}\\,, $$\n于是\n$$g_c\n=\\frac{(2\\pi)^{3/2}}{N}\\Bigl[m\\omega^2\\sigma^5-\\frac{\\hbar^2}{m}\\sigma\\Bigr]\n=-\\frac{4(2\\pi)^{3/2}}{5^{5/4}}\\;\\frac{\\hbar^{5/2}}{m^{3/2}\\omega^{1/2}\\,N}\n=-\\frac{2^{7/2}\\pi^{3/2}\\hbar^{5/2}}{5^{5/4}m^{3/2}\\omega^{1/2}N}\\,. $$", "answer": "$$\\boxed{g_c=-\\frac{2^{7/2}\\pi^{3/2}\\hbar^{5/2}}{5^{5/4}m^{3/2}\\omega^{1/2}N}}$$", "id": "229702"}, {"introduction": "尽管解析解能提供深刻的物理洞察，但在凝聚态物理和冷原子物理的实际研究中，大多数格罗斯-皮塔耶夫斯基方程的求解都依赖于数值计算。这项综合性练习将理论与实践联系起来，指导您从离散化方程开始，一步步构建一个数值求解器来计算谐振子势阱中凝聚体的基态。完成这项任务 [@problem_id:2396656] 将为您提供一项在现代物理研究中至关重要的计算技能，即将抽象的微分方程转化为可执行的算法。", "problem": "您的任务是设计并实现一个高斯-赛德尔迭代方法，通过求解无量纲谐振子单位下的不含时 Gross–Pitaevskii 方程 (GPE)，计算一维谐振子势阱中玻色-爱因斯坦凝聚 (BEC) 的基态。从以下基本方程出发：一维实数值基态波函数 $\\,\\psi(x)\\,$ 所满足的不含时 Gross–Pitaevskii 方程 (GPE) 为\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + \\frac{1}{2}x^2 + g\\,\\psi(x)^2\\right]\\psi(x) = \\mu\\,\\psi(x),\n$$\n其归一化条件为\n$$\n\\int_{-\\infty}^{\\infty}\\psi(x)^2\\,dx = 1,\n$$\n对于基态，有 $\\psi(x)\\ge 0$。此处，$\\,\\mu\\,$ 是化学势（本征值），$\\,g\\,$ 是无量纲相互作用强度，$\\,\\frac{1}{2}x^2\\,$ 是谐振子囚禁势。所有物理量均为无量纲。为了进行数值计算，我们考虑一个有限区间 $\\,x\\in[-L,L]\\,$，采用齐次狄利克雷边界条件 $\\,\\psi(-L)=\\psi(L)=0\\,$，并使用一个包含 $\\,N\\,$ 个点的均匀网格，格点间距为 $\\,\\Delta x = \\frac{2L}{N-1}\\,$。\n\n您的任务是：\n1) 对有限网格上的内部格点，推导微分算子的二阶中心差分离散格式，并写出节点值向量 $\\,\\psi_i\\,$ 必须满足的相应离散非线性方程组。确保边界点 $\\,i=0\\,$ 和 $\\,i=N-1\\,$ 处的值固定为零。\n2) 从线性系统的高斯-赛德尔迭代定义出发，构建一个适用于这些离散方程的非线性高斯-赛德尔不动点迭代格式。具体方法是：将非线性系数 $\\,g\\,\\psi_i^2\\,$ 冻结在上一迭代步的值，同时使用最新的可用邻近格点值顺序更新每个内部节点。不得引入任何非从离散化和高斯-赛德尔原理本身推导出的公式。解释您将如何在每次扫描后保证基态的归一化和非负性。\n3) 在网格上定义化学势 $\\,\\mu\\,$ 的离散瑞利商表达式，该表达式需与连续表达式\n$$\n\\mu = \\frac{\\int \\psi(x)\\left[-\\frac{1}{2}\\frac{d^2}{dx^2}\\psi(x) + \\frac{1}{2}x^2\\psi(x) + g\\,\\psi(x)^3\\right]\\,dx}{\\int \\psi(x)^2\\,dx},\n$$\n保持一致，其中二阶导数由您的有限差分近似替代。使用这个离散量来监控收敛。\n4) 指定一个停止准则，该准则基于同时满足两个条件：连续两次扫描之间 $\\,\\mu\\,$ 的绝对变化量小于容差 $\\,\\varepsilon_\\mu\\,$，且整个网格上 $\\,\\psi_i\\,$ 的最大绝对变化量小于容差 $\\,\\varepsilon_\\psi\\,$。两个容差均为无量纲。同时，指定一个最大扫描次数以防止无限循环。\n5) 将该算法以一个完整的、可运行的程序形式用代码实现。您的实现必须：\n   - 构建网格和势场，\n   - 在 $[-L,L]$ 上使用一个合理的、归一化的猜测值来初始化 $\\,\\psi\\,$，\n   - 执行非线性高斯-赛德尔扫描，其中非线性项使用上一步的迭代值，\n   - 每次扫描后强制执行 $\\,\\psi\\ge 0\\,$ 和归一化，\n   - 计算离散的 $\\,\\mu\\,$ 并检查收敛性。\n\n未使用角度。由于公式是无量纲的，因此不需要物理单位。所有浮点数输出应四舍五入到六位小数。\n\n测试组：\n使用以下参数集 $\\, (N,L,g)\\,$，容差为 $\\,\\varepsilon_\\mu = 10^{-12}\\,$ 和 $\\,\\varepsilon_\\psi = 10^{-10}\\,$，最大扫描次数为 $\\,20000\\,$：\n- 情况 A (理想路径): $\\,N=201\\,,\\,L=8\\,,\\,g=0.5.$\n- 情况 B (线性极限): $\\,N=201\\,,\\,L=8\\,,\\,g=0.$\n- 情况 C (更强相互作用): $\\,N=201\\,,\\,L=8\\,,\\,g=5.$\n- 情况 D (更粗糙的网格，边界敏感): $\\,N=41\\,,\\,L=8\\,,\\,g=0.$\n\n对于每种情况，返回最终收敛的化学势 $\\,\\mu\\,$，以浮点数形式表示并四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，顺序为 [情况 A, 情况 B, 情况 C, 情况 D]，例如\n[0.782100,0.500000,3.300000,0.500500]\n其中每个条目都四舍五入到六位小数。实际数值必须由您的代码计算得出。", "solution": "所提出的问题是计算物理学中的一个标准练习。它具有科学依据、是适定的、客观且完整的。所有必需的物理方程、数值参数和算法约束都已提供。该问题是有效的，我们将继续推导和实现所需的数值解。\n\n### 1. Gross–Pitaevskii 方程的离散化\n\n连续一维 Gross–Pitaevskii 方程由下式给出：\n$$\n\\left[-\\frac{1}{2}\\frac{d^2}{dx^2} + V(x) + g\\,\\psi(x)^2\\right]\\psi(x) = \\mu\\,\\psi(x)\n$$\n其中势函数为 $V(x) = \\frac{1}{2}x^2$。我们将空间域 $x \\in [-L, L]$ 离散化为一个包含 $N$ 个点的均匀网格，记为 $x_i = -L + i\\Delta x$，其中 $i = 0, 1, \\dots, N-1$。格点间距为 $\\Delta x = \\frac{2L}{N-1}$。波函数 $\\psi(x)$ 由其节点值 $\\psi_i = \\psi(x_i)$ 表示。\n\n在内部格点 $x_i$ 处（对于 $i=1, \\dots, N-2$），二阶导数 $\\frac{d^2\\psi}{dx^2}$ 使用二阶中心差分公式近似：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_{i+1}) - 2\\psi(x_i) + \\psi(x_{i-1})}{(\\Delta x)^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{(\\Delta x)^2}\n$$\n将此代入 GPE，得到一个关于内部格点的包含 $N-2$ 个耦合非线性代数方程的方程组：\n$$\n-\\frac{1}{2(\\Delta x)^2}(\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}) + \\left(\\frac{1}{2}x_i^2 + g\\psi_i^2\\right)\\psi_i = \\mu\\psi_i, \\quad i = 1, \\dots, N-2\n$$\n边界条件为 $\\psi_0 = 0$ 和 $\\psi_{N-1} = 0$。我们可以通过收集包含 $\\psi_i$ 的项来重新整理每个内部节点 $i$ 的方程：\n$$\n\\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{2}x_i^2 + g\\psi_i^2\\right)\\psi_i - \\frac{1}{2(\\Delta x)^2}(\\psi_{i-1} + \\psi_{i+1}) = \\mu\\psi_i\n$$\n必须求解该方程组以得到节点值向量 $\\vec{\\psi} = (\\psi_1, \\dots, \\psi_{N-2})^T$ 和本征值 $\\mu$。\n\n### 2. 非线性高斯-赛德尔不动点迭代\n\n问题指定了非线性高斯-赛德尔迭代。此方法将问题视为一个待迭代求解的不动点方程组。在迭代步 $k+1$ 更新 $\\psi_i$ 时，我们使用其邻近格点最新计算出的值。关键在于，非线性项 $g\\psi_i^2$ 和化学势 $\\mu$ 被“冻结”在它们前一次完整扫描的值上，用上标 $(k)$ 表示。\n\n节点 $i$ 处的离散方程被视为一个关于新值 $\\psi_i^{(k+1)}$ 的方程：\n$$\n-\\frac{1}{2(\\Delta x)^2}(\\psi_{i-1}^{(k+1)} - 2\\psi_i^{(k+1)} + \\psi_{i+1}^{(k)}) + \\left(\\frac{1}{2}x_i^2 + g(\\psi_i^{(k)})^2\\right)\\psi_i^{(k+1)} = \\mu^{(k)}\\psi_i^{(k+1)}\n$$\n注意，在高斯-赛德尔格式中，我们按 $i$ 从 $1$到 $N-2$ 的顺序进行迭代。因此，当我们计算 $\\psi_i^{(k+1)}$ 时，值 $\\psi_{i-1}^{(k+1)}$ 在当前扫描中已经可用，而 $\\psi_{i+1}^{(k)}$ 仍是上一次扫描的值。\n\n求解 $\\psi_i^{(k+1)}$ 得到更新公式：\n$$\n\\psi_i^{(k+1)} \\left[\\frac{1}{(\\Delta x)^2} + \\frac{1}{2}x_i^2 + g(\\psi_i^{(k)})^2 - \\mu^{(k)}\\right] = \\frac{1}{2(\\Delta x)^2}(\\psi_{i-1}^{(k+1)} + \\psi_{i+1}^{(k)})\n$$\n$$\n\\psi_i^{(k+1)} = \\frac{\\frac{1}{2(\\Delta x)^2} \\left(\\psi_{i-1}^{(k+1)} + \\psi_{i+1}^{(k)}\\right)}{\\frac{1}{(\\Delta x)^2} + \\frac{1}{2}x_i^2 + g(\\psi_i^{(k)})^2 - \\mu^{(k)}} = \\frac{\\psi_{i-1}^{(k+1)} + \\psi_{i+1}^{(k)}}{2 + 2(\\Delta x)^2 \\left(\\frac{1}{2}x_i^2 + g(\\psi_i^{(k)})^2 - \\mu^{(k)}\\right)}\n$$\n在完成一次更新所有内部节点（从 $i=1$ 到 $N-2$）的完整扫描后，我们执行两个额外步骤：\n1.  **强制非负性：** 基态波函数是无节点的，可以选择为非负。我们通过对所有 $i$ 设置 $\\psi_i = \\max(0, \\psi_i)$ 来强制实现这一点。\n2.  **强制归一化：** 连续归一化条件 $\\int \\psi(x)^2 dx = 1$ 使用梯形法则进行离散化。由于 $\\psi_0=\\psi_{N-1}=0$，积分为 $I = \\sum_{i=1}^{N-2} \\psi_i^2 \\Delta x \\approx \\Delta x \\sum_{i=0}^{N-1} \\psi_i^2$。归一化常数为 $C = 1/\\sqrt{I}$。然后通过 $\\psi_i \\to \\psi_i / C$ 对波函数进行重新归一化。\n\n### 3. 化学势的离散瑞利商\n\n化学势 $\\mu$ 是 GPE 哈密顿量 $H = -\\frac{1}{2}\\frac{d^2}{dx^2} + \\frac{1}{2}x^2 + g\\psi^2$ 的期望值。对于一个归一化的波函数，它由下式给出：\n$$\n\\mu = \\int_{-\\infty}^{\\infty} \\psi(x) H\\psi(x) \\,dx\n$$\n我们使用梯形法则和我们对 $H$ 的有限差分近似来离散化这个积分。在每次对 $\\psi$ 进行扫描和重新归一化之后，计算出一个新的 $\\mu$ 值：\n$$\n\\mu^{(k+1)} = \\Delta x \\sum_{i=1}^{N-2} \\psi_i^{(k+1)} \\left( H\\psi^{(k+1)} \\right)_i\n$$\n其中 $(H\\psi)_i$ 是离散算子的作用：\n$$\n(H\\psi)_i = -\\frac{1}{2(\\Delta x)^2}(\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}) + \\frac{1}{2}x_i^2\\psi_i + g\\psi_i^3\n$$\n将此代入求和式，得到更新后化学势的表达式：\n$$\n\\mu^{(k+1)} = \\Delta x \\sum_{i=1}^{N-2} \\psi_i^{(k+1)} \\left[ -\\frac{\\psi_{i+1}^{(k+1)} - 2\\psi_i^{(k+1)} + \\psi_{i-1}^{(k+1)}}{2(\\Delta x)^2} + \\frac{1}{2}x_i^2 \\psi_i^{(k+1)} + g(\\psi_i^{(k+1)})^3 \\right]\n$$\n\n### 4. 停止准则\n\n当解收敛时，迭代过程终止。收敛定义为同时满足两个条件：\n1.  连续两次扫描之间化学势的绝对变化量小于容差 $\\varepsilon_\\mu$：$|\\mu^{(k+1)} - \\mu^{(k)}|  \\varepsilon_\\mu$。\n2.  整个网格上波函数最大绝对变化量小于容差 $\\varepsilon_\\psi$：$\\max_{i} |\\psi_i^{(k+1)} - \\psi_i^{(k)}|  \\varepsilon_\\psi$。\n\n为了防止不收敛时出现无限循环，设置了扫描次数的上限。\n\n### 5. 算法流程\n\n完整的算法如下：\n1.  **初始化：**\n    - 定义网格 $x_i$ 和势场 $V_i = \\frac{1}{2}x_i^2$。\n    - 为波函数 $\\vec{\\psi}^{(0)}$ 构建一个合理的初始猜测，例如一个以 $x=0$ 为中心并归一化的高斯函数。\n    - 使用 $\\vec{\\psi}^{(0)}$ 和离散瑞利商计算初始化学势 $\\mu^{(0)}$。\n2.  **迭代求解器：**\n    - 开始一个循环，直到收敛或达到最大扫描次数为止。\n    - 存储当前状态以用于收敛检查：$\\vec{\\psi}_{old} \\leftarrow \\vec{\\psi}^{(k)}$ 和 $\\mu_{old} \\leftarrow \\mu^{(k)}$。\n    - 执行一次非线性高斯-赛德尔扫描：对于 $i = 1, \\dots, N-2$，使用推导的公式、冻结值 $\\vec{\\psi}_{old}$、$\\mu_{old}$ 以及最新的可用邻近值 $\\psi_{i-1}^{(k+1)}$ 来更新 $\\psi_i^{(k+1)}$。\n    - 强制非负性：$\\psi_i^{(k+1)} \\leftarrow \\max(0, \\psi_i^{(k+1)})$。\n    - 重新归一化新的波函数向量 $\\vec{\\psi}^{(k+1)}$。\n    - 使用更新后的 $\\vec{\\psi}^{(k+1)}$ 在离散瑞利商中计算新的化学势 $\\mu^{(k+1)}$。\n    - 通过将 $\\mu^{(k+1)}$ 与 $\\mu_{old}$ 以及 $\\vec{\\psi}^{(k+1)}$ 与 $\\vec{\\psi}_{old}$ 和指定的容差进行比较来检查收敛性。\n3.  **终止：**\n    - 收敛后，$\\mu$ 的最终值即为所求结果。\n\n此流程构成了一个完整且稳健的方法，用于求解 Gross-Pitaevskii 方程的基态解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_gpe_ground_state(N, L, g, eps_mu, eps_psi, max_sweeps):\n    \"\"\"\n    Solves the 1D time-independent Gross-Pitaevskii equation using\n    a nonlinear Gauss-Seidel iteration.\n\n    Args:\n        N (int): Number of grid points.\n        L (float): Half-width of the spatial domain [-L, L].\n        g (float): Dimensionless interaction strength.\n        eps_mu (float): Convergence tolerance for the chemical potential.\n        eps_psi (float): Convergence tolerance for the wavefunction.\n        max_sweeps (int): Maximum number of iteration sweeps.\n\n    Returns:\n        float: The converged chemical potential, mu.\n    \"\"\"\n    # 1. Initialization\n    # Construct grid and potential\n    x = np.linspace(-L, L, N)\n    dx = x[1] - x[0]\n    V = 0.5 * x**2\n\n    # Initial guess for the wavefunction (normalized Gaussian)\n    psi = np.exp(-x**2 / 2.0)\n    norm_sq = np.sum(psi**2) * dx\n    psi = psi / np.sqrt(norm_sq)\n\n    # Function to compute chemical potential (mu) via Rayleigh quotient\n    def calculate_mu(p, v_pot, g_int, delta_x):\n        # Calculate mu only for interior points where psi is non-zero\n        psi_interior = p[1:-1]\n        \n        # Second derivative (kinetic energy term)\n        d2_psi = (p[2:] - 2*p[1:-1] + p[:-2]) / delta_x**2\n        \n        # Hamiltonian applied to psi\n        H_psi = -0.5 * d2_psi + v_pot[1:-1] * psi_interior + g_int * psi_interior**3\n        \n        # Discrete integral (trapezoidal rule)\n        mu_val = np.sum(psi_interior * H_psi) * delta_x\n        return mu_val\n\n    # Initial chemical potential\n    mu = calculate_mu(psi, V, g, dx)\n\n    # 2. Iterative Solver\n    for sweep in range(max_sweeps):\n        psi_old = psi.copy()\n        mu_old = mu\n\n        # Nonlinear Gauss-Seidel sweep for interior points\n        for i in range(1, N - 1):\n            # Using psi[i-1] (new) and psi_old[i+1] (old)\n            numerator = psi[i-1] + psi_old[i+1]\n            denominator = 2.0 + 2.0 * dx**2 * (V[i] + g * psi_old[i]**2 - mu_old)\n            if abs(denominator)  1e-14: # Avoid division by zero\n                # This case should not be hit with stable parameters\n                psi[i] = 0.0\n            else:\n                psi[i] = numerator / denominator\n\n        # Post-sweep processing\n        # Enforce non-negativity for the ground state\n        psi[psi  0] = 0.0\n\n        # Renormalize the wavefunction\n        norm_sq = np.sum(psi**2) * dx\n        if norm_sq > 1e-14:\n            psi = psi / np.sqrt(norm_sq)\n        else:\n            # If psi collapses, reset to avoid NaN and break\n            psi.fill(0.0) \n            mu = 0.0\n            break\n\n        # Update mu using the new wavefunction\n        mu = calculate_mu(psi, V, g, dx)\n\n        # Check for convergence\n        d_psi = np.max(np.abs(psi - psi_old))\n        d_mu = abs(mu - mu_old)\n        \n        if d_mu  eps_mu and d_psi  eps_psi:\n            break\n            \n    return mu\n\n\ndef solve():\n    \"\"\"\n    Main driver function to run test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    eps_mu = 1e-12\n    eps_psi = 1e-10\n    max_sweeps = 20000\n    \n    test_cases = [\n        # (N, L, g)\n        (201, 8.0, 0.5), # Case A\n        (201, 8.0, 0.0), # Case B\n        (201, 8.0, 5.0), # Case C\n        (41, 8.0, 0.0),  # Case D\n    ]\n\n    results = []\n    for N, L, g in test_cases:\n        mu_final = compute_gpe_ground_state(N, L, g, eps_mu, eps_psi, max_sweeps)\n        results.append(f\"{mu_final:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2396656"}]}