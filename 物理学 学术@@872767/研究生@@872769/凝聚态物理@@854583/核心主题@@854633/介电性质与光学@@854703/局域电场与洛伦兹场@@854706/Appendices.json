{"hands_on_practices": [{"introduction": "掌握局域场概念的第一步是理解其理论来源。这项基础练习将引导你从第一性原理出发，完成洛伦兹关系的经典推导。通过运用洛伦兹球的巧妙构造，你将学会如何将介电质中的电场分解为远场和近场贡献，并最终揭示宏观电场与原子尺度上的真实电场之间的联系，这一过程也凸显了晶格对称性的关键作用。[@problem_id:2836905]", "problem": "一个绝缘晶体在真空中被建模为一个由数密度为 $n$ 的相同、可极化点偶极子组成的无限、简单立方布拉维格子。该晶体受到一个静态的、空间缓变的外部激励，使得宏观麦克斯韦电场 $\\mathbf{E}_{\\mathrm{mac}}$ 和宏观极化强度 $\\mathbf{P}$ 在介观尺度上可以被视为均匀的。极化强度为 $\\mathbf{P}=n\\,\\langle \\mathbf{p}\\rangle$，其中 $\\langle \\mathbf{p}\\rangle$ 是每个格点的系综平均偶极矩。在某个选定的格点处的局域电场 $\\mathbf{E}_{\\mathrm{loc}}$ 被定义为在该格点处由系统中所有电荷和偶极子产生的实际微观电场，但不包括该格点自身偶极子产生的场。\n\n仅使用基本电磁定律和核心定义（介质中的麦克斯韦方程组、极化强度和束缚电荷密度的定义，以及静电边界条件），在选定的格点处构建一个半径为 $a$ 的洛伦兹球形腔，并从第一性原理推导 $\\mathbf{E}_{\\mathrm{loc}}$ 分解为明确定义的各贡献项。特别地，将这些贡献项分离为：\n- 腔外源产生的场，\n- 由极化强度 $\\mathbf{P}$ 穿过腔边界时的不连续性而在球形腔上产生的束缚面电荷所产生的场，\n- 以及腔内除中心偶极子外的其他离散偶极子产生的场。\n\n在适当之处仅利用简单立方格子的对称性，并且选取的球形腔要么 (i) 足够小，以至于除中心格点外不包含其他格点，要么 (ii) 足够大，以包含整数个完整的立方壳层，但在任何一种情况下，都需通过立方对称性论证腔内离散近邻的贡献为零。然后，不使用任何预先给出的简化公式，通过求解球面上的相应边值问题，来计算由腔的束缚面电荷在腔中心产生的场。\n\n将矢量局域电场 $\\mathbf{E}_{\\mathrm{loc}}$ 的最终结果用 $\\mathbf{E}_{\\mathrm{mac}}$、$\\mathbf{P}$ 和真空介电常数 $\\varepsilon_{0}$ 表示。为 $\\mathbf{E}_{\\mathrm{loc}}$ 提供一个单一的、闭合形式的解析表达式。以国际单位制中的伏特/米 (V/m) 为单位陈述您的答案。", "solution": "所提出的问题是连续介质电动力学和固态物理学中的一个标准的、适定的问题。它要求从第一性原理出发，推导具有简单立方格子结构的绝缘晶体中的洛伦兹局域场。其前提在科学上是合理的，术语是精确的，并且所要求的步骤构成了一条通向唯一、明确解的逻辑路径。该问题是有效的。我们将进行推导。\n\n目标是确定极化电介质材料内特定格点处的局域电场 $\\mathbf{E}_{\\mathrm{loc}}$。根据定义，$\\mathbf{E}_{\\mathrm{loc}}$ 是在所选格点（我们将其设为原点 $\\mathbf{r}=0$）处由所有电荷源产生的微观电场，*除了* 位于该格点本身的偶极子。\n\n我们首先分解电场的源。我们将采用一种标准方法，即在感兴趣的格点处设想一个半径为 $a$ 的虚构球形腔，即洛伦兹球。局域电场 $\\mathbf{E}_{\\mathrm{loc}}$ 就可以表示为三个不同贡献项的和：\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{1} + \\mathbf{E}_{2} + \\mathbf{E}_{3}\n$$\n在此，$\\mathbf{E}_{1}$ 是由洛伦兹球外的所有电荷和偶极子产生的电场。$\\mathbf{E}_{2}$ 是因极化强度矢量 $\\mathbf{P}$ 的不连续性而出现在腔边界上的束缚面电荷所产生的场。$\\mathbf{E}_{3}$ 是球内任何其他离散偶极子产生的场。\n\n来自球外源的贡献 $\\mathbf{E}_{1}$ 可以与宏观电场 $\\mathbf{E}_{\\mathrm{mac}}$ 相关联。如果洛伦兹球的半径 $a$ 选取得远大于晶格间距，则球外的离散偶极子格子可以被视为具有均匀极化强度 $\\mathbf{P}$ 的连续介质。在均匀极化介质内的球形腔中心，由腔外极化物质产生的场，正是我们所称的 $\\mathbf{E}_{1}$。然而，通过考虑以下情况可以更方便地计算此场：由晶体外部的所有源、晶体外表面上的所有极化电荷，以及球外连续介质的体极化电荷和面极化电荷所产生的总场，恰好就是当材料是没有腔的连续体时原点处存在的宏观场 $\\mathbf{E}_{\\mathrm{mac}}$。因此，我们可以将来自腔外所有源的场贡献等同于宏观场 $\\mathbf{E}_{\\mathrm{mac}}$。这导致了以下分解：\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\mathbf{E}_{2} + \\mathbf{E}_{3}\n$$\n在此，$\\mathbf{E}_{\\mathrm{mac}}$ 计入了来自外部源和远距离偶极子（被视为连续介质）的场，$\\mathbf{E}_{2}$ 计入了我们引入的腔的特定几何形状所带来的场，而 $\\mathbf{E}_{3}$ 则计入了原点附近偶极子的离散性。\n\n首先，我们分析贡献项 $\\mathbf{E}_{3}$，它是球内除原点偶极子外的离散偶极子场的总和。位于位置 $\\mathbf{r}_{j}$ 的点偶极子 $\\mathbf{p}_{j}$ 在原点产生的电场由下式给出：\n$$\n\\mathbf{E}_{j} = \\frac{1}{4\\pi\\varepsilon_{0}} \\left[ \\frac{3(\\mathbf{p}_{j} \\cdot \\mathbf{r}_{j})\\mathbf{r}_{j}}{r_{j}^{5}} - \\frac{\\mathbf{p}_{j}}{r_{j}^{3}} \\right]\n$$\n总场为 $\\mathbf{E}_{3} = \\sum_{j \\neq 0, \\text{inside sphere}} \\mathbf{E}_{j}$。对于处于均匀场中的晶体，所有感生偶极矩平均而言是相同的：$\\langle \\mathbf{p}_{j} \\rangle = \\langle \\mathbf{p} \\rangle$。因此，我们可以用一个常矢量 $\\mathbf{p}$ 来代替 $\\mathbf{p}_{j}$。问题指定了简单立方格子。对于这样的格子，任何位于 $\\mathbf{r}_{j} = (x_j, y_j, z_j)$ 的格点，在其坐标的各种排列和符号变换所对应的位置上，都有相应的格点。我们将极化方向 $\\mathbf{p}$ 与 $z$ 轴对齐，即 $\\mathbf{p} = p\\hat{\\mathbf{z}}$。$\\mathbf{E}_{3}$ 的 $z$ 分量为：\n$$\nE_{3,z} = \\frac{p}{4\\pi\\varepsilon_{0}} \\sum_{j \\neq 0} \\frac{3z_{j}^{2} - r_{j}^{2}}{r_{j}^{5}} = \\frac{p}{4\\pi\\varepsilon_{0}} \\sum_{j \\neq 0} \\frac{2z_{j}^{2} - x_{j}^{2} - y_{j}^{2}}{r_{j}^{5}}\n$$\n由于格子的立方对称性，对一个或多个完整立方壳层内的所有格点求和满足 $\\sum_{j} f(x_{j}) = \\sum_{j} f(y_{j}) = \\sum_{j} f(z_{j})$。因此，$\\sum_{j} \\frac{x_{j}^{2}}{r_{j}^{5}} = \\sum_{j} \\frac{y_{j}^{2}}{r_{j}^{5}} = \\sum_{j} \\frac{z_{j}^{2}}{r_{j}^{5}}$。于是 $E_{3,z}$ 的求和项正比于 $2\\sum \\frac{z_{j}^{2}}{r_{j}^{5}} - \\sum \\frac{x_{j}^{2}}{r_{j}^{5}} - \\sum \\frac{y_{j}^{2}}{r_{j}^{5}} = 0$。类似地，$\\mathbf{E}_{3}$ 的 $x$ 和 $y$ 分量也为零。这个结论成立的条件是：球足够大，包含许多格点，使得求和是在近似于球体的完整壳层上进行的；或者球足够小，不包含其他格点，此时求和为空。在任何一种情况下，根据题意，我们得出结论：对于简单立方格子，来自近邻的贡献为零：\n$$\n\\mathbf{E}_{3} = 0\n$$\n\n接下来，我们计算 $\\mathbf{E}_{2}$，即由腔表面的束缚电荷在腔中心产生的场。当我们制造这个腔时，我们移除了极化物质，在球形边界 $r=a$ 上留下了一个面电荷密度 $\\sigma_{b}$。它由 $\\sigma_{b} = \\mathbf{P} \\cdot \\hat{\\mathbf{n}}$ 给出，其中 $\\hat{\\mathbf{n}}$ 是指离极化介质的法向矢量，即指向腔内部。因此，$\\hat{\\mathbf{n}} = -\\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是球坐标径向单位矢量。\n$$\n\\sigma_{b} = \\mathbf{P} \\cdot (-\\hat{\\mathbf{r}})\n$$\n我们将 $z$ 轴与均匀极化矢量 $\\mathbf{P}$ 对齐，因此 $\\mathbf{P} = P\\hat{\\mathbf{z}}$。在球坐标系中，$\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$。\n$$\n\\sigma_{b}(\\theta) = -P\\cos\\theta\n$$\n我们现在通过直接对表面电荷的贡献进行积分来计算其在腔中心产生的电场。位于半径为 $a$、极角为 $\\theta$ 的一个无限薄环带上的电荷为 $dq = \\sigma_b(\\theta) \\cdot (2\\pi a \\sin\\theta) \\cdot (a d\\theta)$。根据对称性，在中心的合电场将沿着 $z$ 轴。该环带在原点处产生的电场 $z$ 分量为：\n$$\ndE_z = \\frac{dq \\cos\\theta}{4\\pi\\varepsilon_0 a^2} = \\frac{(-P\\cos\\theta)(2\\pi a^2 \\sin\\theta d\\theta)}{4\\pi\\varepsilon_0 a^2} \\cos\\theta = -\\frac{P}{2\\varepsilon_0} \\cos^2\\theta \\sin\\theta d\\theta\n$$\n对整个球面（$\\theta$ 从 0 到 $\\pi$）进行积分：\n$$\nE_{2,z} = \\int_0^\\pi dE_z = -\\frac{P}{2\\varepsilon_0} \\int_0^\\pi \\cos^2\\theta \\sin\\theta d\\theta\n$$\n使用换元法，令 $u = \\cos\\theta$，则 $du = -\\sin\\theta d\\theta$。积分限从 $u(0)=1$ 变为 $u(\\pi)=-1$。\n$$\nE_{2,z} = -\\frac{P}{2\\varepsilon_0} \\int_1^{-1} u^2 (-du) = \\frac{P}{2\\varepsilon_0} \\int_{-1}^1 u^2 du = \\frac{P}{2\\varepsilon_0} \\left[ \\frac{u^3}{3} \\right]_{-1}^1 = \\frac{P}{2\\varepsilon_0} \\left( \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) \\right) = \\frac{P}{3\\varepsilon_0}\n$$\n因此，由球形腔表面的束缚电荷产生的场为 $\\mathbf{E}_2 = \\frac{\\mathbf{P}}{3\\varepsilon_0}$。\n\n将所有贡献项相加，我们得到局域电场的最终表达式：\n$$\n\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\mathbf{E}_{2} + \\mathbf{E}_{3} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3\\varepsilon_0} + 0\n$$\n该结果以伏特/米 (V/m) 为单位。", "answer": "$$\n\\boxed{\\mathbf{E}_{\\mathrm{loc}} = \\mathbf{E}_{\\mathrm{mac}} + \\frac{\\mathbf{P}}{3 \\varepsilon_{0}}}\n$$", "id": "2836905"}, {"introduction": "理论的价值在于其解释和预测能力。在推导出局域场的表达式后，下一步是将其应用于真实材料，以连接微观物理量与宏观可测量。这个问题将指导你使用克劳修斯-莫索提关系——一个直接源于洛伦兹场理论的重要公式——从固态氩的宏观介电常数和晶格参数中计算出单个氩原子的微观极化率。[@problem_id:1818331]", "problem": "固态氩在低温下会形成晶体结构。实验表明，它采用面心立方 (FCC) 晶格结构，晶格参数为 $a = 0.531$ nm。当置于静电场中时，该材料表现出的相对静态介电常数为 $\\epsilon_r = 1.66$。假设该固体可以被建模为由非极性原子组成的经典电介质材料，请计算单个氩原子的电子极化率 $\\alpha$。\n\n使用自由空间介电常数的值 $\\epsilon_0 = 8.854 \\times 10^{-12}$ F/m。\n\n请以 C·m²/V 为单位表示您的答案，并将最终答案四舍五入至三位有效数字。", "solution": "对于由原子组成的非极性电介质，克劳修斯-莫索提关系 (Clausius–Mossotti relation) 将相对介电常数与微观极化率联系起来：\n$$\n\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}=\\frac{N\\alpha}{3\\epsilon_{0}},\n$$\n其中 $N$ 是原子数密度，$\\alpha$ 是每个原子的电子极化率。\n\n对于单原子固体的 FCC 晶格，常规立方晶胞包含 $4$ 个原子，因此原子数密度为\n$$\nN=\\frac{4}{a^{3}}.\n$$\n从克劳修斯-莫索提关系求解 $\\alpha$ 可得\n$$\n\\alpha=\\frac{3\\epsilon_{0}}{N}\\,\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\n=3\\epsilon_{0}\\left(\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\\right)\\frac{a^{3}}{4}.\n$$\n\n代入给定值。将晶格参数转换为米：\n$$\na=0.531\\times 10^{-9}\\ \\text{m},\\quad a^{3}=(0.531\\times 10^{-9})^{3}=1.49721291\\times 10^{-28}\\ \\text{m}^{3}.\n$$\n则\n$$\n\\frac{a^{3}}{4}=3.743032275\\times 10^{-29}\\ \\text{m}^{3},\\quad \\frac{3a^{3}}{4}=1.1229096825\\times 10^{-28}\\ \\text{m}^{3}.\n$$\n当 $\\epsilon_{r}=1.66$ 且 $\\epsilon_{0}=8.854\\times 10^{-12}$ 时，\n$$\n\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}=\\frac{0.66}{3.66}=\\frac{11}{61}\\approx 0.1803278689,\n$$\n因此\n$$\n\\alpha=\\epsilon_{0}\\left(\\frac{3a^{3}}{4}\\right)\\left(\\frac{\\epsilon_{r}-1}{\\epsilon_{r}+2}\\right)\n=(8.854\\times 10^{-12})(1.1229096825\\times 10^{-28})(0.1803278689).\n$$\n进行乘法运算，\n$$\n\\alpha\\approx 1.792863\\times 10^{-40}.\n$$\n表示为三位有效数字，\n$$\n\\alpha \\approx 1.79 \\times 10^{-40}\\ \\text{C·m²/V}.\n$$", "answer": "$$\\boxed{1.79 \\times 10^{-40}}$$", "id": "1818331"}, {"introduction": "任何物理模型都有其适用范围和近似条件，洛伦兹场理论也不例外。这项高级计算练习旨在挑战标准推导中将洛伦兹球外的偶极子视为连续介质的近似。通过编写程序直接对离散晶格的偶极子电场进行求和，你将能够量化这种连续谱近似带来的误差，从而深入理解固体理论中离散与连续模型之间的差异。[@problem_id:2836909]", "problem": "您的任务是通过显式地对在晶格点周围挖出的球形空腔外的离散偶极子场进行求和，计算晶体电介质中洛伦兹局域场的有限腔修正。从以下基本依据开始：\n\n- 极化强度的定义：对于均匀极化强度 $\\mathbf{P} = P \\,\\hat{\\mathbf{z}}$，每个格点的偶极矩为 $\\boldsymbol{\\mu} = \\mu \\,\\hat{\\mathbf{z}}$，其中 $\\mu = P \\, V_{\\text{site}}$，$V_{\\text{site}}$ 是每个晶格点的体积。\n- 点偶极子的静电场：由位于原点的点偶极子 $\\boldsymbol{\\mu}$ 在位置 $\\mathbf{r}$ 处产生的电场为\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[\\frac{3(\\boldsymbol{\\mu}\\cdot \\hat{\\mathbf{r}})\\,\\hat{\\mathbf{r}} - \\boldsymbol{\\mu}}{r^3}\\right],\n$$\n其中 $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ 且 $r=\\|\\mathbf{r}\\|$。\n- 对于嵌入在均匀极化连续介质中的球形空腔，由空腔外部的极化物质在中心产生的场沿 $\\hat{\\mathbf{z}}$ 方向等于 $E_{z}^{\\text{cont}} = P/(3\\varepsilon_0)$。在 $1/(4\\pi\\varepsilon_0)=1$ 的单位制中，该参考值等于 $E_{z}^{\\text{cont}} = 4\\pi P/3$。\n\n您将对三种立方晶格进行建模：简单立方（SC）、体心立方（BCC）和面心立方（FCC）。取晶格常数为 $a$ 的常规立方晶胞，其基矢如下：\n- SC：单个格点位于分数坐标 $(0,0,0)$，因此 $n_{\\text{site}}=1$，\n- BCC：格点位于 $(0,0,0)$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$，因此 $n_{\\text{site}}=2$，\n- FCC：格点位于 $(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$ 和 $(\\tfrac{1}{2},\\tfrac{1}{2},0)$，因此 $n_{\\text{site}}=4$。\n\n设 $\\mathbf{P}=P\\,\\hat{\\mathbf{z}}$，$P$ 为常数。对于每种晶格类型，构建一个由整数索引 $(i,j,k)$（范围为 $-N \\le i,j,k \\le N$）构成的常规晶胞的有限立方阵列，从而得到一个边长为 $(2N+1)a$ 的超胞。对于所选晶格中的每个基矢 $(\\xi,\\eta,\\zeta)$，在位置 $\\mathbf{r} = a\\,(i+\\xi, j+\\eta, k+\\zeta)$ 处放置偶极子。通过排除所有 $r  R_c$ 的格点，移除中心位于原点、半径为 $R_c$ 的球形空腔内的偶极子。如果原点处存在中心格点，也应将其排除。为每个格点分配偶极矩 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$，其中 $\\mu = P a^3 / n_{\\text{site}}$，这与均匀极化强度一致。\n\n计算由所有包含在内的偶极子在原点处产生的场的 $z$ 分量的离散估计值，\n$$\nE_{z}^{\\text{disc}}(R_c,N;\\text{lattice}) = \\sum_{\\mathbf{r}} \\left[\\frac{1}{4\\pi \\varepsilon_0}\\left(\\frac{3(\\boldsymbol{\\mu}\\cdot\\mathbf{r})\\,z}{r^5} - \\frac{\\mu}{r^3}\\right)\\right],\n$$\n其中 $z$ 是 $\\mathbf{r}$ 的 $z$ 坐标，求和遍及有限阵列中所有包含在内的偶极子。\n\n采用无量纲单位，其中 $1/(4\\pi \\varepsilon_0)=1$ 且 $P=1$，因此 $E_{z}^{\\text{cont}}=4\\pi/3$ 且 $\\mu = a^3/n_{\\text{site}}$。\n\n将无量纲有限腔修正定义为\n$$\n\\delta(R_c,N;\\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c,N;\\text{lattice})}{E_{z}^{\\text{cont}}} - 1.\n$$\n\n您的任务是实现一个程序，该程序能够：\n- 构建指定的晶格和基矢。\n- 对半径为 $R_c$ 的球形空腔之外、由 $N$ 设定的立方截断之内的离散偶极子贡献进行求和。\n- 为每个测试用例计算 $\\delta(R_c,N;\\text{lattice})$。\n\n所有输出必须是无量纲实数（浮点数）。如果内部出现角度，必须以弧度处理。由于选择了单位归一化，输出中不出现国际单位制（SI）的量纲。\n\n用于评估覆盖范围的测试套件：\n- 用例 1：晶格 $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（一般收敛情况）。\n- 用例 2：晶格 $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=0.51$，$N=10$（小空腔半径，接近最近邻格点排除距离）。\n- 用例 3：晶格 $\\in\\{\\text{SC}\\}$，$a=1.0$，$R_c=1.2$，$N=3$（小截断，用于探测不完整壳层的收敛性）。\n- 用例 4：晶格 $\\in\\{\\text{BCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（不同的基矢密度）。\n- 用例 5：晶格 $\\in\\{\\text{FCC}\\}$，$a=1.0$，$R_c=1.2$，$N=10$（密堆积基矢）。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”）。列表元素按顺序对应于上述用例，并且必须是为每个用例定义的 $\\delta$ 的数值。所有中间选择都必须遵循上述定义，并且不允许任何外部输入。", "solution": "所提出的问题陈述是计算物理学中一个定义明确的练习。它要求通过对离散偶极子晶格的电场进行直接求和来计算局域场修正，这是电介质研究中的一个基本概念。该问题具有科学依据、内部一致，并且所有参数都已指定。因此，它被认为是有效的，可以构建一个严谨的解。\n\n任务是计算洛伦兹局域场的有限腔修正。在给定晶格点上的局域场 $\\mathbf{E}_{\\text{local}}$ 是来自所有源（*除了*该点上的偶极子）的总电场。P. A. M. Lorentz 提出了一种计算方法，即在概念上围绕该点挖出一个小的球形空腔。然后将场分解为空腔内偶极子的贡献（“近场”）和空腔外极化介质的贡献（“远场”）。\n\n在标准的洛伦兹模型中，球体外的均匀极化连续介质产生的远场在空腔中心的贡献为 $\\mathbf{E}_{\\text{cont}} = \\mathbf{P}/(3\\varepsilon_0)$。然后对空腔内的离散偶极子进行近场求和。对于具有高对称性（例如，立方）的晶格，这个近场和为零，从而导出了著名的洛伦兹关系式。\n\n这个问题重新审视了远场贡献。我们不将其视为连续介质，而是通过对半径为 $R_c$ 的空腔之外、尺寸为 $(2N+1)a$ 的较大有限立方体之内的格点上的偶极子场进行直接的离散求和来计算它。这个离散和与连续介质值之间的偏差即为有限腔修正 $\\delta$。\n\n由位于位置 $\\mathbf{r}$ 的点偶极子 $\\boldsymbol{\\mu}$ 在原点产生的电场由下式给出：\n$$\n\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_0} \\left[ \\frac{3(\\boldsymbol{\\mu} \\cdot \\mathbf{r})\\mathbf{r}}{r^5} - \\frac{\\boldsymbol{\\mu}}{r^3} \\right]\n$$\n问题指定了均匀极化强度 $\\mathbf{P} = P \\hat{\\mathbf{z}}$，因此每个偶极矩为 $\\boldsymbol{\\mu} = \\mu \\hat{\\mathbf{z}}$。对于位置矢量 $\\mathbf{r} = (x, y, z)$，点积为 $\\boldsymbol{\\mu} \\cdot \\mathbf{r} = \\mu z$。来自这个单一偶极子的电场的 $z$ 分量是：\n$$\nE_z = \\frac{\\mu}{4\\pi \\varepsilon_0} \\left( \\frac{3z^2}{r^5} - \\frac{1}{r^3} \\right)\n$$\n我们采用无量纲单位制，使得 $1/(4\\pi\\varepsilon_0) = 1$ 且极化强度大小 $P=1$。每个格点的偶极矩为 $\\mu = P V_{\\text{site}}$。对于一个边长为 $a$、包含 $n_{\\text{site}}$ 个基元原子的常规立方晶胞，每个格点的体积为 $V_{\\text{site}} = a^3/n_{\\text{site}}$。因此，在这些单位中，偶极矩为 $\\mu = a^3/n_{\\text{site}}$。\n\n场的 $z$ 分量的离散和 $E_z^{\\text{disc}}$ 是对所有满足两个条件的晶格点 $\\mathbf{r}_{i,j,k,\\beta}$ 进行的：\n1. 它们位于由整数索引 $-N \\le i, j, k \\le N$ 定义的计算超胞内。\n2. 它们位于半径为 $R_c$ 的球形空腔外，即 $\\|\\mathbf{r}_{i,j,k,\\beta}\\| \\ge R_c$。\n一个格点的位置由 $\\mathbf{r}_{i,j,k,\\beta} = a((i, j, k) + (\\xi, \\eta, \\zeta)_{\\beta})$ 给出，其中 $(i,j,k)$ 是晶胞索引，$(\\xi, \\eta, \\zeta)_{\\beta}$ 是基点 $\\beta$ 的分数坐标。位于原点 $(\\mathbf{r} = \\mathbf{0})$ 的格点被显式排除。\n\n总的离散场是以下求和：\n$$\nE_{z}^{\\text{disc}}(R_c, N; \\text{lattice}) = \\sum_{i,j,k,\\beta \\text{ s.t. } r \\ge R_c, r \\ne 0} \\mu \\left( \\frac{3z_{i,j,k,\\beta}^2}{r_{i,j,k,\\beta}^5} - \\frac{1}{r_{i,j,k,\\beta}^3} \\right)\n$$\n在我们选择的单位制中，参考连续场为 $E_z^{\\text{cont}} = 4\\pi P/3$。当 $P=1$ 时，此值为 $E_z^{\\text{cont}} = 4\\pi/3$。\n\n然后无量纲有限腔修正 $\\delta$ 按如下方式计算：\n$$\n\\delta(R_c, N; \\text{lattice}) = \\frac{E_{z}^{\\text{disc}}(R_c, N; \\text{lattice})}{E_{z}^{\\text{cont}}} - 1\n$$\n这个量衡量了用均匀连续介质替代空腔外的离散晶格所引入的相对误差。这种误差源于晶格的颗粒性以及求和体积的有限立方形状。对于无限的、球形求和的晶格，此修正将消失为零。\n\n要实现的算法如下：\n1. 对于每个测试用例，根据指定的晶格类型（SC、BCC 或 FCC）、晶格常数 $a$、空腔半径 $R_c$ 和超胞尺寸参数 $N$，我们将总离散场 $E_{z}^{\\text{disc}}$ 初始化为 $0$。\n2. 我们为所选晶格定义基矢 $(\\xi, \\eta, \\zeta)$ 和格点数 $n_{\\text{site}}$。我们计算偶极矩 $\\mu = a^3/n_{\\text{site}}$。\n3. 我们遍历所有从 $-N$ 到 $N$ 的晶胞索引 $(i, j, k)$。\n4. 在每个晶胞内，我们遍历所有基矢。对于每个格点，我们计算其位置矢量 $\\mathbf{r} = (x, y, z)$。\n5. 我们检查该格点是否在原点 ($r=0$)。如果是，则跳过它。\n6. 我们检查该格点是否在球形空腔内 ($r  R_c$)。如果是，则跳过它。\n7. 如果该格点被包含在内，我们计算它对场的贡献 $\\Delta E_z = \\mu (3z^2/r^5 - 1/r^3)$，并将其加到 $E_{z}^{\\text{disc}}$ 上。\n8. 在对所有包含的格点求和后，我们计算参考场 $E_z^{\\text{cont}} = 4\\pi/3$。\n9. 最后，我们计算修正值 $\\delta = E_{z}^{\\text{disc}}/E_z^{\\text{cont}} - 1$ 并报告结果。\n\n此过程构成了对所述问题的直接数值评估。", "answer": "```python\nimport numpy as np\n\ndef calculate_delta(lattice_type: str, a: float, Rc: float, N: int) - float:\n    \"\"\"\n    Computes the finite-cavity correction to the Lorentz local field.\n\n    Args:\n        lattice_type: The type of cubic lattice ('SC', 'BCC', 'FCC').\n        a: The lattice constant.\n        Rc: The radius of the spherical exclusion cavity.\n        N: The half-size of the cubic supercell in units of conventional cells.\n\n    Returns:\n        The dimensionless finite-cavity correction delta.\n    \"\"\"\n    # Define lattice basis vectors in fractional coordinates and number of sites per conventional cell.\n    bases = {\n        'SC': np.array([[0.0, 0.0, 0.0]]),\n        'BCC': np.array([[0.0, 0.0, 0.0], [0.5, 0.5, 0.5]]),\n        'FCC': np.array([[0.0, 0.0, 0.0], [0.0, 0.5, 0.5], [0.5, 0.0, 0.5], [0.5, 0.5, 0.0]]),\n    }\n    nsites = {\n        'SC': 1,\n        'BCC': 2,\n        'FCC': 4,\n    }\n\n    n_site = nsites[lattice_type]\n    basis_vectors = bases[lattice_type]\n    \n    # In dimensionless units, P=1, so mu = V_site = a^3 / n_site.\n    mu = a**3 / n_site\n    \n    E_z_disc = 0.0\n    \n    # Loop over conventional cells indexed by (i, j, k) from -N to N.\n    cell_indices = np.arange(-N, N + 1)\n    for i in cell_indices:\n        for j in cell_indices:\n            for k in cell_indices:\n                # Loop over basis sites within the cell.\n                for basis_vec in basis_vectors:\n                    pos_vec = a * (np.array([i, j, k]) + basis_vec)\n                    \n                    r_sq = np.sum(pos_vec**2)\n                    \n                    # Exclude the site at the origin where the field is calculated.\n                    # A small tolerance is used for floating-point comparison to zero.\n                    if r_sq  1e-12:\n                        continue\n                    \n                    r = np.sqrt(r_sq)\n                    \n                    # Include only dipoles outside the cavity radius Rc.\n                    if r = Rc:\n                        z = pos_vec[2]\n                        # The z-component of the field from a single dipole, with 1/(4*pi*eps_0) = 1.\n                        # E_z = mu * (3*z^2/r^5 - 1/r^3)\n                        r_cubed = r**3\n                        r_fifth = r_cubed * r**2 # Computationally cheaper than r**5\n                        E_z_single = mu * (3 * z**2 / r_fifth - 1 / r_cubed)\n                        E_z_disc += E_z_single\n\n    # The continuum field at the center of a spherical cavity, with P=1 and 1/(4*pi*eps_0)=1.\n    E_z_cont = 4 * np.pi / 3.0\n    \n    # Calculate the dimensionless finite-cavity correction.\n    delta = E_z_disc / E_z_cont - 1.0\n    \n    return delta\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 0.51, 'N': 10},\n        {'lattice': 'SC', 'a': 1.0, 'R_c': 1.2, 'N': 3},\n        {'lattice': 'BCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n        {'lattice': 'FCC', 'a': 1.0, 'R_c': 1.2, 'N': 10},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta = calculate_delta(case['lattice'], case['a'], case['R_c'], case['N'])\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2836909"}]}