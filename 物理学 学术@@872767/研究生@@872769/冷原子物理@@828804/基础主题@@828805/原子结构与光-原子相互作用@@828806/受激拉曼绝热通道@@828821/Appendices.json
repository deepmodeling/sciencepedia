{"hands_on_practices": [{"introduction": "本练习探讨了STIRAP过程的一个特殊情况，即泵浦光和斯托克斯光脉冲以完全相同的形状同时施加。虽然标准的STIRAP依赖于“反直觉”的脉冲序列，但分析这种对称场景能让我们深刻理解缀饰态（dressed-state）基矢，并揭示为何脉冲时序对于实现完美布居数转移至关重要。通过解析求解此问题，您将亲身体验缀饰态的数学形式及其演化过程 [@problem_id:1269145]。", "problem": "一个三能级原子，其能态 $|1\\rangle$、$|2\\rangle$ 和 $|3\\rangle$ 排列成 $\\Lambda$ 型结构，用于通过受激拉曼绝热通道 (Stimulated Raman Adiabatic Passage, STIRAP) 实现从能态 $|1\\rangle$ 到能态 $|3\\rangle$ 的布居数转移。跃迁 $|1\\rangle \\leftrightarrow |2\\rangle$ 由具有时变拉比频率 $\\Omega_P(t)$ 的泵浦激光驱动，而跃迁 $|2\\rangle \\leftrightarrow |3\\rangle$ 由具有拉比频率 $\\Omega_S(t)$ 的斯托克斯激光驱动。\n\n在旋转波近似 (RWA) 下，该系统的哈密顿量由下式给出：\n$$\nH(t) = \\frac{\\hbar}{2}\n\\begin{pmatrix}\n0  \\Omega_P(t)  0 \\\\\n\\Omega_P(t)  -2\\Delta  \\Omega_S(t) \\\\\n0  \\Omega_S(t)  0\n\\end{pmatrix}\n$$\n其中 $\\Delta$ 是相对于激发态 $|2\\rangle$ 的单光子失谐。我们假设系统处于双光子共振状态。\n\n考虑一个非标准的 STIRAP 场景，其中单光子失谐为零 ($\\Delta=0$)，并且泵浦激光脉冲和斯托克斯激光脉冲以相同的、随时间变化的形状同时施加。即，在所有时间 $t$ 上，$\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$。脉冲 $\\Omega(t)$ 仅在有限时间间隔内非零，且其形状使得总脉冲面积为 $A = \\int_{-\\infty}^{\\infty} \\Omega(t') dt'$。\n\n在 $t \\to -\\infty$ 时，原子初始处于基态 $|1\\rangle$，即 $|\\psi(-\\infty)\\rangle = |1\\rangle$。\n\n计算到能态 $|3\\rangle$ 的最终布居数转移效率，定义为 $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$。将您的答案表示为总脉冲面积 $A$ 的函数。", "solution": "该问题要求在特定脉冲条件下，三能级系统中能态 $|3\\rangle$ 的最终布居数。\n\n1.  **简化哈密顿量：**\n    根据条件 $\\Delta=0$ 和 $\\Omega_P(t) = \\Omega_S(t) = \\Omega(t)$，哈密顿量变为：\n    $$\n    H(t) = \\frac{\\hbar \\Omega(t)}{2}\n    \\begin{pmatrix}\n    0  1  0 \\\\\n    1  0  1 \\\\\n    0  1  0\n    \\end{pmatrix}\n    $$\n    这个哈密顿量可以写成 $H(t) = \\Omega(t) H_0$ 的形式，其中 $H_0 = \\frac{\\hbar}{2} \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}$ 是一个不随时间变化的矩阵。\n\n2.  **求解本征态和本征值：**\n    由于哈密顿量 $H_0$ 的空间部分不随时间变化，其本征矢量（即“缀饰态”）也是不随时间变化的。本征值将与 $\\Omega(t)$ 成正比。我们通过求解特征方程 $\\det(H_0 - \\frac{E}{\\Omega(t)} I) = 0$ 来找到本征值 $E$。令 $\\lambda = E / (\\hbar \\Omega(t))$。\n    $$\n    \\det \\begin{pmatrix}\n    -\\frac{\\lambda\\hbar}{2}  \\hbar/2  0 \\\\\n    \\hbar/2  -\\frac{\\lambda\\hbar}{2}  \\hbar/2 \\\\\n    0  \\hbar/2  -\\frac{\\lambda\\hbar}{2}\n    \\end{pmatrix} = \\left(\\frac{\\hbar}{2}\\right)^3 \\det \\begin{pmatrix}\n    -\\lambda  1  0 \\\\\n    1  -\\lambda  1 \\\\\n    0  1  -\\lambda\n    \\end{pmatrix} = 0\n    $$\n    $-\\lambda(\\lambda^2 - 1) - 1(-\\lambda) = 0$\n    $-\\lambda^3 + \\lambda + \\lambda = 0 \\implies \\lambda^3 - 2\\lambda = 0$\n    $\\lambda(\\lambda^2 - 2) = 0$。\n    解为 $\\lambda_0 = 0$、$\\lambda_+ = \\sqrt{2}$ 和 $\\lambda_- = -\\sqrt{2}$。\n    相应的时变本征值为：\n    $E_0(t) = 0$\n    $E_+(t) = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n    $E_-(t) = -\\frac{\\hbar\\Omega(t)}{\\sqrt{2}}$\n\n    现在，我们求解相应的归一化本征矢量 $|\\psi_0\\rangle$、$|\\psi_+\\rangle$ 和 $|\\psi_-\\rangle$。\n    对于 $E_0=0$（暗态）：\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = 0 \\implies c_2=0, c_1+c_3=0$。\n    归一化后，得到 $|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}}(|1\\rangle - |3\\rangle)$。\n\n    对于 $E_+ = \\hbar\\Omega(t)/\\sqrt{2}$：\n    $H_0 \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar\\Omega(t)}{\\sqrt{2}} \\frac{1}{\\Omega(t)} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix} = \\frac{\\hbar}{\\sqrt{2}} \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix}$。\n    $\\frac{\\hbar}{2} c_2 = \\frac{\\hbar}{\\sqrt{2}} c_1 \\implies c_2 = \\sqrt{2}c_1$。\n    $\\frac{\\hbar}{2} (c_1+c_3) = \\frac{\\hbar}{\\sqrt{2}} c_2 = \\hbar c_1 \\implies c_1+c_3 = 2c_1 \\implies c_3=c_1$。\n    本征矢量与 $(1, \\sqrt{2}, 1)^T$ 成正比。归一化后：$|\\psi_+\\rangle = \\frac{1}{2}(|1\\rangle + \\sqrt{2}|2\\rangle + |3\\rangle)$。\n\n    对于 $E_- = -\\hbar\\Omega(t)/\\sqrt{2}$：\n    类似的计算得出 $c_2 = -\\sqrt{2}c_1$ 和 $c_3=c_1$。\n    本征矢量与 $(1, -\\sqrt{2}, 1)^T$ 成正比。归一化后：$|\\psi_-\\rangle = \\frac{1}{2}(|1\\rangle - \\sqrt{2}|2\\rangle + |3\\rangle)$。\n\n3.  **分解初始态：**\n    系统初始处于 $|\\psi(-\\infty)\\rangle = |1\\rangle$。我们将其投影到不随时间变化的本征基上：\n    $|1\\rangle = \\alpha_0|\\psi_0\\rangle + \\alpha_+|\\psi_+\\rangle + \\alpha_-|\\psi_-\\rangle$。\n    $\\alpha_0 = \\langle\\psi_0|1\\rangle = \\frac{1}{\\sqrt{2}}$。\n    $\\alpha_+ = \\langle\\psi_+|1\\rangle = \\frac{1}{2}$。\n    $\\alpha_- = \\langle\\psi_-|1\\rangle = \\frac{1}{2}$。\n    因此，初始态为 $|\\psi(-\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2}|\\psi_+\\rangle + \\frac{1}{2}|\\psi_-\\rangle$。\n\n4.  **时间演化：**\n    由于缀饰态不随时间变化，薛定谔方程 $i\\hbar \\frac{d}{dt}|\\psi(t)\\rangle = H(t)|\\psi(t)\\rangle$ 的解是演化中的本征态的直接叠加。一个本征态 $|\\psi_k\\rangle$ 的演化遵循 $|\\psi_k(t)\\rangle = \\exp\\left(-\\frac{i}{\\hbar}\\int_{-\\infty}^t E_k(t') dt'\\right)|\\psi_k\\rangle$。\n    在 $t \\to +\\infty$ 时的状态为：\n    $$\n    |\\psi(+\\infty)\\rangle = \\alpha_0 e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_0 dt'}|\\psi_0\\rangle + \\alpha_+ e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_+(t') dt'}|\\psi_+\\rangle + \\alpha_- e^{-\\frac{i}{\\hbar}\\int_{-\\infty}^\\infty E_-(t') dt'}|\\psi_-\\rangle\n    $$\n    相位积分为：\n    $\\int_{-\\infty}^\\infty E_0(t') dt' = 0$。\n    $\\int_{-\\infty}^\\infty E_\\pm(t') dt' = \\pm \\frac{\\hbar}{\\sqrt{2}}\\int_{-\\infty}^\\infty \\Omega(t') dt' = \\pm \\frac{\\hbar A}{\\sqrt{2}}$。\n    将这些代入 $|\\psi(+\\infty)\\rangle$ 的表达式中：\n    $$\n    |\\psi(+\\infty)\\rangle = \\frac{1}{\\sqrt{2}}|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} |\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} |\\psi_-\\rangle\n    $$\n\n5.  **计算能态 |3> 的最终布居数：**\n    我们需要计算 $P_3 = |\\langle 3|\\psi(+\\infty) \\rangle|^2$。首先，我们求出振幅 $\\langle 3|\\psi(+\\infty) \\rangle$。\n    $\\langle 3|\\psi_0\\rangle = -1/\\sqrt{2}$\n    $\\langle 3|\\psi_+\\rangle = 1/2$\n    $\\langle 3|\\psi_-\\rangle = 1/2$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\langle 3|\\psi_0\\rangle + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\langle 3|\\psi_+\\rangle + \\frac{1}{2} e^{i A/\\sqrt{2}} \\langle 3|\\psi_-\\rangle\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = \\frac{1}{\\sqrt{2}}\\left(-\\frac{1}{\\sqrt{2}}\\right) + \\frac{1}{2} e^{-i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right) + \\frac{1}{2} e^{i A/\\sqrt{2}} \\left(\\frac{1}{2}\\right)\n    $$\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{4}\\left(e^{-i A/\\sqrt{2}} + e^{i A/\\sqrt{2}}\\right)\n    $$\n    使用欧拉公式 $\\cos(x) = (e^{ix}+e^{-ix})/2$：\n    $$\n    \\langle 3|\\psi(+\\infty) \\rangle = -\\frac{1}{2} + \\frac{1}{2}\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) = \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right)\n    $$\n    现在我们计算概率 $P_3$：\n    $$\n    P_3 = \\left| \\frac{1}{2}\\left(\\cos\\left(\\frac{A}{\\sqrt{2}}\\right) - 1\\right) \\right|^2 = \\frac{1}{4}\\left(1 - \\cos\\left(\\frac{A}{\\sqrt{2}}\\right)\\right)^2\n    $$\n    使用半角恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$：\n    $$\n    P_3 = \\frac{1}{4}\\left(2\\sin^2\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)^2 = \\frac{1}{4} \\left(4\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\\right)\n    $$\n    $$\n    P_3 = \\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)\n    $$\n    这就是最终的布居数转移效率。", "answer": "$$\n\\boxed{\\sin^4\\left(\\frac{A}{2\\sqrt{2}}\\right)}\n$$", "id": "1269145"}, {"introduction": "真实世界中的STIRAP方案通常在较大的单光子失谐下运行，这会引入微小的非绝热效应。本问题将引导您通过连接两个强大的理论工具——绝热消除（adiabatic elimination）和Landau-Zener公式——来为此类情景建模 [@problem_id:451307]。通过将三能级系统简化为等效的两能级模型，您将计算由非绝热跃迁引起的转移效率损失，从而对绝热近似的局限性获得一个切实的理解。", "problem": "一个处于 $\\Lambda$ 型构型的三能级原子与两个激光场相互作用，一个泵浦场和一个斯托克斯场。原子态分别表示为 $|1\\rangle$ (初态)，$|2\\rangle$ (激发态)和 $|3\\rangle$ (目标态)。泵浦激光耦合能态 $|1\\rangle$ 和 $|2\\rangle$，而斯托克斯激光耦合能态 $|2\\rangle$ 和 $|3\\rangle$。\n\n在旋转坐标系中并采用旋转波近似，系统的哈密顿量由下式给出：\n$$ H(t) = \\frac{\\hbar}{2} \\begin{pmatrix} 0  \\Omega_P(t)  0 \\\\ \\Omega_P(t)  -2\\Delta  \\Omega_S(t) \\\\ 0  \\Omega_S(t)  -2\\delta \\end{pmatrix} $$\n此处，$\\Omega_P(t)$ 和 $\\Omega_S(t)$ 分别是泵浦脉冲和斯托克斯脉冲随时间变化的拉比频率。$\\Delta$ 是相对于中间态 $|2\\rangle$ 的单光子失谐，而 $\\delta$ 是能态 $|1\\rangle$ 和 $|3\\rangle$ 之间的双光子失谐。\n\n激光脉冲被建模为具有相同峰值拉比频率 $\\Omega_0$ 和脉冲宽度 $\\sigma$ 的高斯脉冲。脉冲包络被设置为用于受激拉曼绝热通道 (STIRAP) 过程，其中斯托克斯脉冲以一个正的时间延迟 $\\tau$ 先于泵浦脉冲：\n$$ \\Omega_S(t) = \\Omega_0 \\exp\\left(-\\frac{(t+\\tau/2)^2}{2\\sigma^2}\\right) $$\n$$ \\Omega_P(t) = \\Omega_0 \\exp\\left(-\\frac{(t-\\tau/2)^2}{2\\sigma^2}\\right) $$\n假设系统在 $t \\to -\\infty$ 时初始处于能态 $|1\\rangle$。\n\n考虑系统运行在一个单光子失谐较大 ($|\\Delta| \\gg \\Omega_0$) 的区域，这允许对激发态 $|2\\rangle$ 进行绝热消除。此外，假设双光子失谐 $\\delta$ 很小且非零，并且脉冲参数使得有效二能级系统的动力学可以由 Landau-Zener 模型精确描述。为了计算方便，可以近似认为非绝热能级交叉发生在时间 $t_c \\approx 0$。\n\n计算布居数转移效率 $\\eta = P_3(t\\to\\infty)$，即在能态 $|3\\rangle$ 中的最终布居数。", "solution": "1. 绝热消除 ($|\\Delta|\\gg\\Omega_0$) 得到一个有效的二能级哈密顿量，其耦合项为\n   $$\\Omega_\\text{eff}(t)=-\\frac{\\Omega_P(t)\\,\\Omega_S(t)}{2\\Delta}.$$  \n   在交叉点 $t_c\\approx 0$ 处，\n   $$\\Omega_P(0)=\\Omega_S(0)=\\Omega_0e^{-\\tau^2/(8\\sigma^2)},$$  \n   因此\n   $$g\\equiv\\bigl|\\Omega_\\text{eff}(0)\\bigr|=\\frac{\\Omega_0^2e^{-\\tau^2/(4\\sigma^2)}}{2|\\Delta|}.$$\n\n2. 包含斯塔克位移的双光子失谐为\n   $$\\delta_\\text{eff}(t)=\\delta+\\frac{\\Omega_P^2(t)-\\Omega_S^2(t)}{4\\Delta}.$$  \n   其在 $t=0$ 处的导数为\n   $$\\alpha=\\frac{d\\delta_\\text{eff}}{dt}\\Big|_{t=0}\n   =\\frac{1}{4\\Delta}\\Bigl[2\\Omega_P(0)\\dot\\Omega_P(0)-2\\Omega_S(0)\\dot\\Omega_S(0)\\Bigr]$$  \n   其中高斯脉冲的导数为\n   $$\\dot\\Omega_{P,S}(0)=\\mp\\frac{\\tau}{2\\sigma^2}\\,\\Omega_0e^{-\\tau^2/(8\\sigma^2)}.$$  \n   因此\n   $$\\alpha=\\frac{\\Omega_0^2\\tau\\,e^{-\\tau^2/(4\\sigma^2)}}{2\\Delta\\sigma^2}.$$\n\n3. Landau-Zener 跃迁概率\n   $$P_\\text{LZ}=\\exp\\Bigl(-\\frac{\\pi g^2}{2|\\alpha|}\\Bigr).$$  \n   计算指数部分：\n   \\begin{align*}\n     \\frac{\\pi g^2}{2|\\alpha|}\n     &=\\frac{\\pi}{2}\\frac{\\bigl(\\frac{\\Omega_0^2e^{-\\tau^2/(4\\sigma^2)}}{2\\Delta}\\bigr)^2}\n       {\\frac{\\Omega_0^2\\tau\\,e^{-\\tau^2/(4\\sigma^2)}}{2|\\Delta|\\sigma^2}}\\\\\n     &=\\frac{\\pi\\Omega_0^2\\sigma^2\\,e^{-\\tau^2/(4\\sigma^2)}}{4|\\Delta|\\tau}.\n   \\end{align*}\n\n4. 转移效率\n   $$\\eta=1-P_\\text{LZ}\n     =1-\\exp\\Bigl(-\\frac{\\pi\\Omega_0^2\\sigma^2\\,e^{-\\tau^2/(4\\sigma^2)}}{4|\\Delta|\\tau}\\Bigr).$$", "answer": "$$\\boxed{1-\\exp\\Bigl(-\\frac{\\pi\\Omega_0^2\\sigma^2\\,e^{-\\tau^2/(4\\sigma^2)}}{4|\\Delta|\\tau}\\Bigr)}$$", "id": "451307"}, {"introduction": "为了完全捕捉STIRAP丰富的动力学过程并在广泛的参数范围内探索其行为，数值模拟是不可或缺的工具。本练习要求您通过数值求解含时薛定谔方程，从零开始构建一个计算模型 [@problem_id:2421268]。通过模拟标准的“反直觉”序列、低效的“直觉”序列以及存在非理想失谐等情况，您将为STIRAP作为一种高保真度量子控制技术的工作原理，建立起稳固且定量的直觉。", "problem": "您需要编写一个完整、可运行的程序，对经历受激拉曼绝热通道 (Stimulated Raman Adiabatic Passage, STIRAP) 的三能级量子系统，进行含时薛定谔方程的数值求解。目标是为几组参数集计算转移到目标态的最终布居数。您必须使用基于原理的含时哈密顿量描述和保范数的时间步进方案。\n\n从基本定律开始，态矢量根据含时薛定谔方程演化\n$$\ni\\hbar \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\n在单位制中，令约化普朗克常数等于 1，即设置 $\\hbar = 1$，因此控制方程为\n$$\ni \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle .\n$$\n考虑一个具有基态 $|1\\rangle$、$|2\\rangle$ 和 $|3\\rangle$ 的 lambda (Λ) 型三能级系统。在旋转波近似 (Rotating Wave Approximation, RWA) 下，以及在一个去除了快速振荡项的参考系中，哈密顿量取为\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0  \\Omega_{\\mathrm{p}}(t)/2  0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2  \\Delta  \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0  \\Omega_{\\mathrm{s}}(t)/2  \\delta\n\\end{pmatrix},\n$$\n其中 $\\Omega_{\\mathrm{p}}(t)$ 是耦合 $|1\\rangle \\leftrightarrow |2\\rangle$ 的泵浦拉比频率，$\\Omega_{\\mathrm{s}}(t)$ 是耦合 $|3\\rangle \\leftrightarrow |2\\rangle$ 的斯托克斯拉比频率，$\\Delta$ 是中间态 $|2\\rangle$ 的单光子失谐，$\\delta$ 是 $|1\\rangle$ 和 $|3\\rangle$ 之间的双光子失谐。拉比频率是含时高斯脉冲，\n$$\n\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right), \\quad\n\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right),\n$$\n具有共同的峰值振幅 $\\Omega_{0}$、时间宽度 $\\sigma$ 以及脉冲中心 $t_{\\mathrm{p}}$ 和 $t_{\\mathrm{s}}$。在反直觉 STIRAP 序列中，斯托克斯脉冲先于泵浦脉冲，即 $t_{\\mathrm{s}} < t_{\\mathrm{p}}$。\n\n您必须：\n- 使用一个基于哈密顿量在每个时间步中点处取值的矩阵指数的幺正、保范数的时间步进方案，通过数值积分含时薛定谔方程来显式地传播态矢量。也就是说，在一个从 $t$ 到 $t+\\Delta t$ 的小时间步长 $\\Delta t$ 内，使用\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle .\n$$\n- 在 $t=t_{0}$ 时将状态初始化为 $|1\\rangle$，即 $|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$。\n- 对 $\\Omega_{0}$、$\\Delta$ 和 $\\delta$ 使用角频率单位“弧度/秒”，对与时间相关的量使用“秒”。所有计算必须一致地使用这些单位。\n- 选择一个足够宽的总模拟区间 $[t_{0},t_{\\mathrm{f}}]$，以使两个脉冲在端点处均可忽略不计。一个稳健的选择是 $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ 和 $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$，其中 $\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$ 是脉冲间隔。使用一个足够小的固定时间步长 $\\Delta t$，以解析脉冲包络和最快的相干动力学。\n\n您的程序必须实现以下参数集的测试套件。在每种情况下，报告 $|3\\rangle$ 中的最终布居数，由 $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$ 给出，形式为一个浮点数。使用指定的单位和定义。\n\n所有测试的通用定义：\n- 设高斯宽度为 $\\sigma$，按各案例指定。\n- 设脉冲间隔为 $\\tau = 2\\sigma$。\n- 对于反直觉顺序，设置 $t_{\\mathrm{s}} = -\\tau/2$ 和 $t_{\\mathrm{p}} = +\\tau/2$。\n- 对于直觉顺序，设置 $t_{\\mathrm{p}} = -\\tau/2$ 和 $t_{\\mathrm{s}} = +\\tau/2$。\n- 使用满足 $\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$ 的固定步长 $\\Delta t$。\n\n需实现的测试案例：\n- 案例 1 (行为良好的 STIRAP)：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 0$。\n- 案例 2 (直觉顺序，转移效果差)：与案例 1 相同，但为直觉顺序。\n- 案例 3 (由于脉冲过短导致的非绝热)：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 5\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 0$。\n- 案例 4 (单光子失谐的鲁棒性)：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 2\\pi \\times 50\\times 10^{6}\\ \\mathrm{rad/s}$，$\\delta = 0$。\n- 案例 5 (双光子失谐的敏感性)：$\\Omega_{0} = 2\\pi \\times 15\\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25\\times 10^{-9}\\ \\mathrm{s}$，反直觉顺序，$\\Delta = 0$，$\\delta = 2\\pi \\times 5\\times 10^{6}\\ \\mathrm{rad/s}$。\n\n角度单位（如果考虑任何相位）必须是弧度。所有物理量都应以指定单位处理。\n\n要求输出：\n- 您的程序应生成单行输出，其中包含案例 1 到 5 的最终布居数 $P_{3}(t_{\\mathrm{f}})$，按顺序排列，每个值四舍五入到恰好六位小数，形式为用方括号括起来的逗号分隔列表。例如，输出如 $[0.999500,0.010000,0.450000,0.980000,0.600000]$。\n\n您的解决方案必须是单一、完整的程序。它不能要求任何用户输入或外部文件。它必须使用基于上述原理的严谨数值方法。最终答案是单位区间 $\\left[0,1\\right]$ 内的无量纲布居数，以四舍五入到六位小数的小数形式表示。", "solution": "问题陈述已经过严格的验证过程。\n\n**第一步：提取已知条件**\n- **控制方程**：$i \\frac{d}{dt}\\,|\\psi(t)\\rangle = \\hat{H}(t)\\,|\\psi(t)\\rangle$，其中 $\\hbar = 1$。\n- **哈密顿量**：\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n0  \\Omega_{\\mathrm{p}}(t)/2  0 \\\\\n\\Omega_{\\mathrm{p}}(t)/2  \\Delta  \\Omega_{\\mathrm{s}}(t)/2 \\\\\n0  \\Omega_{\\mathrm{s}}(t)/2  \\delta\n\\end{pmatrix}\n$$\n- **拉比频率**：$\\Omega_{\\mathrm{p}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{p}})^2}{2\\sigma^2}\\right)$，$\\Omega_{\\mathrm{s}}(t) = \\Omega_{0}\\,\\exp\\!\\left(-\\frac{(t - t_{\\mathrm{s}})^2}{2\\sigma^2}\\right)$。\n- **初始条件**：$|\\psi(t_{0})\\rangle = (1,0,0)^{\\mathsf{T}}$。\n- **数值方法**：$|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\!\\left(-i\\, \\hat{H}\\!\\left(t+\\frac{\\Delta t}{2}\\right)\\,\\Delta t\\right)\\,|\\psi(t)\\rangle$。\n- **模拟时间区间**：$[t_{0}, t_{\\mathrm{f}}]$，其中 $t_{0} = -6\\sigma - \\frac{\\tau}{2}$ 和 $t_{\\mathrm{f}} = +6\\sigma + \\frac{\\tau}{2}$，$\\tau = |t_{\\mathrm{p}} - t_{\\mathrm{s}}|$。\n- **时间步长**：$\\Delta t \\le \\min\\!\\left(\\frac{\\sigma}{200}, \\frac{1}{20\\,\\Omega_{0}}\\right)$。\n- **脉冲时序**：$\\tau = 2\\sigma$。反直觉：$t_{\\mathrm{s}} = -\\tau/2$，$t_{\\mathrm{p}} = +\\tau/2$。直觉：$t_{\\mathrm{p}} = -\\tau/2$，$t_{\\mathrm{s}} = +\\tau/2$。\n- **测试案例**：\n    1. 案例 1：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 0$。\n    2. 案例 2：与案例 1 相同，但为直觉顺序。\n    3. 案例 3：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 5 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 0$。\n    4. 案例 4：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 2\\pi \\times 50 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\delta = 0$。\n    5. 案例 5：$\\Omega_{0} = 2\\pi \\times 15 \\times 10^{6}\\ \\mathrm{rad/s}$，$\\sigma = 25 \\times 10^{-9}\\ \\mathrm{s}$，反直觉，$\\Delta = 0$，$\\delta = 2\\pi \\times 5 \\times 10^{6}\\ \\mathrm{rad/s}$。\n- **要求输出**：每个案例的最终布居数 $P_{3}(t_{\\mathrm{f}}) = |\\langle 3|\\psi(t_{\\mathrm{f}})\\rangle|^{2}$，四舍五入到六位小数，以指定的列表格式输出。\n\n**第二步：验证结论**\n该问题具有科学依据，论述严谨，客观且自洽。它描述了计算量子物理学中的一个标准问题，所有必要的参数和方法都已明确指定。不存在逻辑矛盾、事实错误或含糊不清之处。参数值对于原子系统是物理上现实的。\n\n**结论：该问题有效。**\n\n我们继续进行求解。任务是积分含时薛定谔方程，这是一个关于态矢量 $|\\psi(t)\\rangle$ 的一阶线性常微分方程：\n$$\n\\frac{d}{dt}|\\psi(t)\\rangle = -i \\hat{H}(t)|\\psi(t)\\rangle\n$$\n在一个从 $t$ 到 $t+\\Delta t$ 的时间区间上的形式解由 $|\\psi(t+\\Delta t)\\rangle = \\hat{U}(t+\\Delta t, t)|\\psi(t)\\rangle$ 给出，其中 $\\hat{U}(t+\\Delta t, t)$ 是时间演化算符。对于含时哈密顿量，该算符由时间排序指数给出：$\\hat{U}(t+\\Delta t, t) = \\mathcal{T} \\exp(-i \\int_t^{t+\\Delta t} \\hat{H}(t') dt')$。\n\n问题指定了传播算符的一个特定近似，该近似等效于二阶 Magnus 展开，或在积分内对哈密顿量应用中点法则：\n$$\n\\int_t^{t+\\Delta t} \\hat{H}(t') dt' \\approx \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\n$$\n这得到了时间步进公式：\n$$\n|\\psi(t+\\Delta t)\\rangle \\approx \\exp\\left(-i \\hat{H}\\left(t+\\frac{\\Delta t}{2}\\right) \\Delta t\\right) |\\psi(t)\\rangle\n$$\n该传播算符是幺正的，这保证了态矢量的范数 $||\\psi(t)||^2$ 在整个模拟过程中是守恒的。这是一个关键的物理要求，因为总概率必须保持为 1。\n\n该算法实现如下：\n1.  **初始化**：定义给定测试案例的系统参数（$\\Omega_0$, $\\sigma$, $\\Delta$, $\\delta$ 和脉冲顺序）。根据这些参数，通过指定的公式计算脉冲时序 $t_{\\mathrm{p}}$ 和 $t_{\\mathrm{s}}$、模拟区间 $[t_0, t_f]$ 以及时间步长 $\\Delta t$。态矢量被初始化在状态 $|1\\rangle$，表示为列向量 $|\\psi(t_0)\\rangle = [1, 0, 0]^{\\mathsf{T}}$。\n\n2.  **离散化**：时间区间 $[t_0, t_f]$ 被离散化为一系列点 $t_k = t_0 + k \\Delta t$，其中 $k = 0, 1, 2, \\dots, N-1$，且 $N \\Delta t \\approx t_f - t_0$。\n\n3.  **时间演化**：态矢量被迭代演化。对于从时间 $t_k$ 到 $t_{k+1} = t_k + \\Delta t$ 的每一步：\n    a. 计算中点时间 $t_{k+1/2} = t_k + \\Delta t/2$。\n    b. 计算含时拉比频率 $\\Omega_{\\mathrm{p}}(t_{k+1/2})$ 和 $\\Omega_{\\mathrm{s}}(t_{k+1/2})$。\n    c. 使用这些频率和给定的失谐 $\\Delta$ 和 $\\delta$ 构建哈密顿量矩阵 $\\hat{H}(t_{k+1/2})$。\n    d. 使用矩阵指数函数计算该步的幺正演化算符 $\\hat{U}_k = \\exp(-i \\hat{H}(t_{k+1/2}) \\Delta t)$。这是该步骤中计算量最大的部分。\n    e. 更新态矢量：$|\\psi(t_{k+1})\\rangle = \\hat{U}_k |\\psi(t_k)\\rangle$。\n\n4.  **最终测量**：在最后一个时间步之后，模拟得到最终时刻的态矢量 $|\\psi(t_f)\\rangle = [c_1(t_f), c_2(t_f), c_3(t_f)]^{\\mathsf{T}}$。然后计算所需的输出，即状态 $|3\\rangle$ 中的布居数，其值为其振幅的模平方：$P_3(t_f) = |c_3(t_f)|^2$。\n\n对所有五个测试案例重复此过程。所得的最终布居数按规定格式化。该实现使用能够高效处理复数矩阵代数和矩阵求幂的数值库。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to solve the STIRAP problem for all test cases.\n    \"\"\"\n\n    def run_simulation(omega0, sigma, pulse_order, delta_one_photon, delta_two_photon):\n        \"\"\"\n        Numerically solves the TDSE for a single STIRAP parameter set.\n\n        Args:\n            omega0 (float): Peak Rabi frequency in rad/s.\n            sigma (float): Temporal width of Gaussian pulses in s.\n            pulse_order (str): 'counter-intuitive' or 'intuitive'.\n            delta_one_photon (float): One-photon detuning Delta in rad/s.\n            delta_two_photon (float): Two-photon detuning delta in rad/s.\n\n        Returns:\n            float: Final population in state |3>.\n        \"\"\"\n        # Define pulse separation and centers\n        tau = 2.0 * sigma\n        if pulse_order == 'counter-intuitive':\n            t_s = -tau / 2.0\n            t_p = tau / 2.0\n        elif pulse_order == 'intuitive':\n            t_p = -tau / 2.0\n            t_s = tau / 2.0\n        else:\n            raise ValueError(\"Invalid pulse_order specified.\")\n\n        # Set up simulation time grid\n        t0 = -6.0 * sigma - tau / 2.0\n        tf = 6.0 * sigma + tau / 2.0\n        dt = min(sigma / 200.0, 1.0 / (20.0 * omega0))\n        time_points = np.arange(t0, tf, dt)\n\n        # Initialize state vector |psi(t0)> = |1> = [1, 0, 0]^T\n        psi = np.array([1.0, 0.0, 0.0], dtype=np.complex128)\n\n        # Define Gaussian pulse shapes for pump and Stokes lasers\n        def omega_p(t):\n            return omega0 * np.exp(-(t - t_p)**2 / (2.0 * sigma**2))\n\n        def omega_s(t):\n            return omega0 * np.exp(-(t - t_s)**2 / (2.0 * sigma**2))\n\n        # Main time-stepping loop\n        for t in time_points:\n            t_mid = t + dt / 2.0\n\n            # Evaluate Rabi frequencies at the midpoint of the time step\n            omega_p_mid = omega_p(t_mid)\n            omega_s_mid = omega_s(t_mid)\n\n            # Construct the Hamiltonian matrix at the midpoint\n            h_mid = np.array([\n                [0.0, omega_p_mid / 2.0, 0.0],\n                [omega_p_mid / 2.0, delta_one_photon, omega_s_mid / 2.0],\n                [0.0, omega_s_mid / 2.0, delta_two_photon]\n            ], dtype=np.complex128)\n\n            # Compute the unitary time-evolution operator using matrix exponential\n            U = expm(-1j * h_mid * dt)\n\n            # Update the state vector\n            psi = U @ psi\n\n        # Calculate the final population in state |3>\n        p3_final = np.abs(psi[2])**2\n        return p3_final\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (well-behaved STIRAP): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=0, delta=0\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 2 (intuitive ordering, poor transfer): same as Case 1 but intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 3 (non-adiabatic due to short pulses): Omega0=2pi*15MHz, sigma=5ns, counter-intuitive\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 5e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 0.0},\n        # Case 4 (one-photon detuning robustness): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, Delta=2pi*50MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 2.0 * np.pi * 50e6, 'delta_two_photon': 0.0},\n        # Case 5 (two-photon detuning sensitivity): Omega0=2pi*15MHz, sigma=25ns, counter-intuitive, delta=2pi*5MHz\n        {'omega0': 2.0 * np.pi * 15e6, 'sigma': 25e-9, 'pulse_order': 'counter-intuitive', 'delta_one_photon': 0.0, 'delta_two_photon': 2.0 * np.pi * 5e6},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "2421268"}]}