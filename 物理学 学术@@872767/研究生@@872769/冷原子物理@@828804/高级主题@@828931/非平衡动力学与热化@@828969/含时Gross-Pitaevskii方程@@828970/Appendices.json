{"hands_on_practices": [{"introduction": "直接求解含时格罗斯-皮塔耶夫斯基方程（TDGPE）通常是不可行的。变分原理提供了一种强大的近似方法，通过假设一个具有时变参数的简单波函数形式（拟设），将复杂的偏微分方程简化为一组关于这些参数的常微分方程。本练习将引导你使用高斯函数作为拟设，研究囚禁在谐振子势阱中并具有吸引相互作用的玻色气体的“呼吸模”——一种基本的集体振荡模式。通过此练习 [@problem_id:1276565]，你将掌握一种从拉格朗日量力学推导凝聚体动力学方程的核心技巧。", "problem": "一个由 $N$ 个原子组成的玻色-爱因斯坦凝聚体，每个原子的质量为 $m$，被限制在一维谐振子势 $V(x) = \\frac{1}{2}m\\omega_0^2 x^2$ 中。原子间存在吸引相互作用，由强度为 $g_{1D}  0$ 的接触势描述。凝聚体的平均场波函数 $\\psi(x,t)$ 的动力学由含时 Gross-Pitaevskii 方程 (TDGPE) 控制，其归一化条件为 $\\int_{-\\infty}^{\\infty} |\\psi(x,t)|^2 dx = N$：\n$$ i\\hbar \\frac{\\partial \\psi}{\\partial t} = \\left( -\\frac{\\hbar^2}{2m} \\frac{\\partial^2}{\\partial x^2} + \\frac{1}{2}m\\omega_0^2 x^2 + g_{1D} |\\psi|^2 \\right) \\psi $$\n\n为研究集体动力学，我们采用含时变分方法，对波函数使用高斯拟设：\n$$ \\psi(x, t) = A(t) \\exp\\left(-\\frac{x^2}{2\\sigma(t)^2} + i \\alpha(t) x^2\\right) $$\n其中 $\\sigma(t)$ 是含时宽度，$\\alpha(t)$ 是含时相位曲率，而 $A(t)$ 是由归一化条件决定的含时振幅。变分参数的动力学由最小作用量原理 $\\delta S = 0$ 导出，其中作用量定义为 $S = \\int dt \\, L_{eff}$。有效拉格朗日量 $L_{eff}$ 通过对拉格朗日密度 $\\mathcal{L}$ 进行全空间积分得到：\n$$ L_{eff} = \\int_{-\\infty}^{\\infty} dx \\left[ \\frac{i\\hbar}{2}\\left(\\psi^* \\frac{\\partial\\psi}{\\partial t} - \\psi \\frac{\\partial\\psi^*}{\\partial t}\\right) - \\frac{\\hbar^2}{2m}\\left|\\frac{\\partial\\psi}{\\partial x}\\right|^2 - V(x)|\\psi|^2 - \\frac{g_{1D}}{2}|\\psi|^4 \\right] $$\n\n假设凝聚体有一个稳态解，该解可由具有恒定宽度 $\\sigma = \\sigma_0$ 的拟设描述。如果宽度受到轻微扰动，它将围绕该平衡值以所谓的“呼吸模式”振荡。\n\n确定这些小振荡的角频率 $\\omega_B$。用阱频率 $\\omega_0$、粒子质量 $m$、约化普朗克常数 $\\hbar$ 和平衡宽度 $\\sigma_0$ 来表示你的答案。", "solution": "采用高斯拟设，其宽度参数 $\\sigma(t)$ 的动力学服从一个有效的运动方程，该方程可通过变分原理或流体动力学方程的矩方法导出：\n$$\\ddot\\sigma = \\frac{\\hbar^2}{m^2\\sigma^3} - \\omega_0^2\\,\\sigma - \\frac{g_{1D}N}{\\sqrt{2\\pi}\\,m\\,\\sigma^2}$$\n在稳态平衡时，宽度是恒定的，$\\sigma = \\sigma_0$，且 $\\ddot\\sigma = 0$。这给出了平衡条件：\n$$\\frac{\\hbar^2}{m^2\\sigma_0^3} - \\omega_0^2\\sigma_0 - \\frac{g_{1D}N}{\\sqrt{2\\pi}\\,m\\,\\sigma_0^2} = 0$$\n现在，我们考虑平衡点附近的小扰动 $\\sigma(t) = \\sigma_0 + \\epsilon(t)$，其中 $\\epsilon(t)$ 是一个小量。我们将运动方程在 $\\sigma_0$ 处对 $\\epsilon$ 进行线性化。令方程右侧为 $f(\\sigma)$，则 $\\ddot\\epsilon \\approx f(\\sigma_0) + f'(\\sigma_0)\\epsilon$。由于 $f(\\sigma_0)=0$，我们得到 $\\ddot\\epsilon = f'(\\sigma_0)\\epsilon$。计算导数：\n$$f'(\\sigma_0) = \\left. \\frac{d}{d\\sigma}\\left(\\frac{\\hbar^2}{m^2\\sigma^3} - \\omega_0^2\\sigma - \\frac{g_{1D}N}{\\sqrt{2\\pi}\\,m\\,\\sigma^2}\\right)\\right|_{\\sigma=\\sigma_0} = -3\\frac{\\hbar^2}{m^2\\sigma_0^4} - \\omega_0^2 + 2\\frac{g_{1D}N}{\\sqrt{2\\pi}\\,m\\,\\sigma_0^3}$$\n利用平衡条件来替换 $g_{1D}$ 项：从平衡条件我们有 $\\frac{g_{1D}N}{\\sqrt{2\\pi}\\,m\\,\\sigma_0^2} = \\frac{\\hbar^2}{m^2\\sigma_0^3} - \\omega_0^2\\sigma_0$。将其乘以 $2/\\sigma_0$ 并代入 $f'(\\sigma_0)$ 的表达式中：\n$$f'(\\sigma_0) = -3\\frac{\\hbar^2}{m^2\\sigma_0^4} - \\omega_0^2 + \\frac{2}{\\sigma_0}\\left(\\frac{\\hbar^2}{m^2\\sigma_0^3} - \\omega_0^2\\sigma_0\\right) = -\\frac{\\hbar^2}{m^2\\sigma_0^4} - 3\\omega_0^2$$\n因此，$\\epsilon(t)$ 的运动方程为简谐振动方程：\n$$\\ddot\\epsilon = -\\left(3\\omega_0^2 + \\frac{\\hbar^2}{m^2\\sigma_0^4}\\right)\\epsilon$$\n其角频率 $\\omega_B$ 的平方为：\n$$\\omega_B^2=3\\omega_0^2+\\frac{\\hbar^2}{m^2\\sigma_0^4}$$", "answer": "$$\\boxed{\\omega_B=\\sqrt{3\\omega_0^2+\\frac{\\hbar^2}{m^2\\sigma_0^4}}}$$", "id": "1276565"}, {"introduction": "在简化动力学的思路上更进一步，本练习将探讨玻色-爱因斯坦凝聚体（BEC）从各向异性陷阱中释放后的自由膨胀过程。在强相互作用的托马斯-费米（Thomas-Fermi）近似下，凝聚体的动力学可以通过对其初始密度分布的一个“标度变换”来精确描述。这个练习 [@problem_id:1276650] 演示了如何运用这种标度拟设（scaling ansatz）来预测凝聚体形状的演化，这是一个可以在实验中直接观测到的标志性现象。", "problem": "一个包含大量原子的雪茄状玻色-爱因斯坦凝聚 (BEC) 最初在各向异性谐振子势阱中处于热平衡状态。势阱势由 $V_{ext}(\\mathbf{r}) = \\frac{1}{2}m(\\omega_\\rho^2(x^2+y^2) + \\omega_z^2 z^2)$ 给出，其中 $m$ 是单个原子的质量，势阱频率满足 $\\omega_z \\ll \\omega_\\rho$。\n\n在大量原子（托马斯-费米机制）的极限下，基态密度分布呈抛物线形状。在时间 $t=0$ 时，谐振子势阱被突然关闭，凝聚体开始自由膨胀。\n\n凝聚体形状的演化可以通过标度拟设精确描述，其中径向（$\\rho$）和轴向（$z$）的托马斯-费米半径 $R_\\rho(t)$ 和 $R_z(t)$ 演化为 $R_\\rho(t) = R_\\rho(0)\\lambda_\\rho(t)$ 和 $R_z(t)=R_z(0)\\lambda_z(t)$。无量纲标度参数 $\\lambda_i(t)$ 服从以下耦合微分方程：\n$$ \\ddot{\\lambda}_\\rho = \\frac{\\omega_\\rho^2}{\\lambda_\\rho^3 \\lambda_z} $$\n$$ \\ddot{\\lambda}_z = \\frac{\\omega_z^2}{\\lambda_\\rho^2 \\lambda_z^2} $$\n对应于从静态基态释放的初始条件为 $\\lambda_\\rho(0) = 1$，$\\lambda_z(0) = 1$，$\\dot{\\lambda}_\\rho(0) = 0$ 和 $\\dot{\\lambda}_z(0) = 0$。\n\n凝聚体的纵横比定义为 $A(t) = R_z(t)/R_\\rho(t)$。在托马斯-费米机制下，初始半径与势阱频率的关系为 $R_i(0) \\propto 1/\\omega_i$。\n\n计算在势阱关闭后瞬间，纵横比的初始加速度 $\\ddot{A}(0)$。请用势阱频率 $\\omega_\\rho$ 和 $\\omega_z$ 表示你的答案。", "solution": "1. 纵横比为\n$$A(t)=\\frac{R_z(t)}{R_\\rho(t)}\n=\\frac{R_z(0)\\,\\lambda_z(t)}{R_\\rho(0)\\,\\lambda_\\rho(t)}\n=\\frac{R_z(0)}{R_\\rho(0)}\\frac{\\lambda_z}{\\lambda_\\rho}\\,. $$\n在托马斯-费米机制下，$R_i(0)\\propto1/\\omega_i$，所以\n$$\\frac{R_z(0)}{R_\\rho(0)}=\\frac{\\omega_\\rho}{\\omega_z}\\,. $$\n\n2. 因此\n$$A(t)=\\frac{\\omega_\\rho}{\\omega_z}\\,\\frac{\\lambda_z}{\\lambda_\\rho}\\,. $$\n\n3. 计算在 $t=0$ 时的二阶导数。设\n$$A=\\beta\\frac{\\lambda_z}{\\lambda_\\rho},\\quad\\beta=\\frac{\\omega_\\rho}{\\omega_z},$$ \n我们有\n$$\\dot A=\\beta\\frac{\\dot\\lambda_z\\,\\lambda_\\rho-\\lambda_z\\,\\dot\\lambda_\\rho}\n{\\lambda_\\rho^2},$$\n并且因为 $\\lambda_i(0)=1,\\;\\dot\\lambda_i(0)=0$，可得 $\\dot A(0)=0$。那么\n$$\\ddot A(0)\n=\\beta\\Big[\\ddot\\lambda_z(0)-\\ddot\\lambda_\\rho(0)\\Big]\\,. $$\n\n4. 根据标度方程，\n$$\\ddot\\lambda_\\rho=\\frac{\\omega_\\rho^2}{\\lambda_\\rho^3\\lambda_z},\\quad\n\\ddot\\lambda_z=\\frac{\\omega_z^2}{\\lambda_\\rho^2\\lambda_z^2},$$\n所以在 $t=0$ 时（$\\lambda_\\rho=\\lambda_z=1$），\n$$\\ddot\\lambda_\\rho(0)=\\omega_\\rho^2,\\quad\n\\ddot\\lambda_z(0)=\\omega_z^2.$$\n\n5. 因此，\n$$\\ddot A(0)\n=\\frac{\\omega_\\rho}{\\omega_z}\\bigl(\\omega_z^2-\\omega_\\rho^2\\bigr)\\,. $$", "answer": "$$\\boxed{\\frac{\\omega_\\rho}{\\omega_z}\\bigl(\\omega_z^2-\\omega_\\rho^2\\bigr)}$$", "id": "1276650"}, {"introduction": "在许多情况下，变分法或标度拟设等解析近似方法可能不足以描述系统的复杂行为，此时数值方法便成为不可或缺的终极工具。分裂算符法（split-operator method）是求解 TDGPE 的一种标准且稳健的算法。本练习 [@problem_id:2441319] 将指导你通过实现该算法的一个变体——虚时演化法，来亲手计算玻色-爱因斯坦凝聚体的基态和化学势。这不仅是研究动力学的起点，更是连接理论与计算实践的关键一步。", "problem": "你需要实现一个完整的、可运行的程序，将分裂算符（时间分裂谱）方法应用于一维非线性 Gross-Pitaevskii 方程，其中有效势取决于演化中的波函数。你的任务是，通过归一化虚时演化，计算一小组测试案例所得到的稳态的化学势，并以指定格式在单行中输出结果。\n\n从一维含时 Gross-Pitaevskii 方程开始，采用无量纲单位，其中约化普朗克常数和粒子质量均为1，即 $\\hbar = 1$ 和 $m = 1$：\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x,t)|^2 \\right] \\psi(x,t).\n$$\n通过将 $t$ 替换为 $-\\,\\mathrm{i}\\,\\tau$ 在虚时中演化以获得稳态基态，并在每个时间步后强制对波函数进行归一化，以使 $\\int |\\psi(x,\\tau)|^2\\,\\mathrm{d}x = 1$。使用一个二阶精度的对称分裂算符格式，该格式在傅里叶空间中的动能算符和实空间中外部势与非线性势的组合之间交替进行。使用与有限域上离散傅里叶变换一致的周期性边界条件。\n\n对于给定的最终归一化态 $\\psi(x)$，利用稳态 Gross-Pitaevskii 方程所隐含的定义来计算稳态解的化学势 $\\mu$：\n$$\n\\mu\\,\\psi(x) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x)|^2 \\right]\\psi(x),\n$$\n并将 $\\mu$ 表示为根据 $\\psi(x)$ 及其梯度计算的标量。所有积分必须通过数值网格上的适当黎曼和来近似，而动能贡献所需的空间导数必须以与所选网格上的傅里叶表示一致的方式计算。\n\n所有量均为无量纲单位，因此你的程序必须以无量纲能量单位输出化学势。\n\n为以下参数集的测试套件实现你的程序，所有测试均在一维空间中进行：\n- 案例 A（线性谐振子，基准检验）：\n  - 外部势 $V_{\\mathrm{ext}}(x) = \\tfrac{1}{2}\\,\\omega^2 x^2$，其中 $\\omega = 1.0$。\n  - 相互作用强度 $g = 0.0$。\n  - 域长度 $L = 20.0$，采用周期性边界条件和 $N = 512$ 个网格点，因此 $\\Delta x = L/N$。\n  - 虚时间步长 $\\Delta \\tau = 0.001$，步数 $N_{\\mathrm{steps}} = 2500$。\n  - 初始波函数：归一化高斯函数 $\\psi(x,0) \\propto \\exp\\!\\big(-x^2/(2\\sigma^2)\\big)$，其中 $\\sigma = 1.0$，归一化至 $\\int |\\psi(x,0)|^2\\,\\mathrm{d}x = 1$。\n- 案例 B（排斥性非线性谐振子）：\n  - 外部势 $V_{\\mathrm{ext}}(x) = \\tfrac{1}{2}\\,\\omega^2 x^2$，其中 $\\omega = 1.0$。\n  - 相互作用强度 $g = 1.0$。\n  - 域长度 $L = 20.0$，采用周期性边界条件和 $N = 512$ 个网格点。\n  - 虚时间步长 $\\Delta \\tau = 0.001$，步数 $N_{\\mathrm{steps}} = 2500$。\n  - 初始波函数：归一化高斯函数，$\\sigma = 1.0$，归一化至1。\n- 案例 C（周期性盒子，均匀稳态）：\n  - 外部势 $V_{\\mathrm{ext}}(x) = 0$。\n  - 相互作用强度 $g = 2.0$。\n  - 域长度 $L = 10.0$，采用周期性边界条件和 $N = 512$ 个网格点。\n  - 虚时间步长 $\\Delta \\tau = 0.001$，步数 $N_{\\mathrm{steps}} = 10$。\n  - 初始波函数：均匀函数 $\\psi(x,0) = 1/\\sqrt{L}$，使其精确归一化。\n\n你的程序必须：\n- 对每个案例使用虚时间步长为二阶的对称分裂算符格式演化至最终时间，并在每个时间步后进行归一化以维持 $\\int |\\psi|^2\\,\\mathrm{d}x = 1$。\n- 根据最终的归一化态计算每个案例的化学势 $\\mu$。\n- 生成单行输出，包含三个结果，形式为用方括号括起来的逗号分隔列表，例如 $\\texttt{[0.500000,1.234567,0.200000]}$，每个值四舍五入到 $6$ 位小数。\n\n约束和实现细节：\n- 空间网格：$x_j = x_{\\min} + j\\,\\Delta x$，其中 $x_{\\min} = -L/2$，$j = 0,1,\\dots,N-1$，且 $\\Delta x = L/N$。\n- 波数：动能步和谱导数的计算必须使用与离散傅里叶变换和周期性边界条件一致的 $k$ 网格。\n- 算法必须完全自包含，不得读取任何输入。\n- 你的程序必须计算并按要求的输出格式返回上述三个案例的化学势。\n\n你最终的程序必须是一个完整的、可运行的脚本，只打印一行：一个格式为 $\\texttt{[}\\mu_A,\\mu_B,\\mu_C\\texttt{]}$ 的列表，其中每个条目四舍五入到 $6$ 位小数。", "solution": "该问题要求实现一个数值算法，以找到一维 Gross-Pitaevskii 方程（GPE）的稳态基态，并计算其相关的化学势 $\\mu$。指定的方法是使用二阶对称分裂算符格式的虚时演化。\n\n含时 GPE 如下所示：\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\hat{H}\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V_{\\mathrm{ext}}(x) \\;+\\; g\\,|\\psi(x,t)|^2 \\right] \\psi(x,t)\n$$\n其中质量 $m$ 和约化普朗克常数 $\\hbar$ 均设为1。哈密顿算符 $\\hat{H}$ 由一个动能算符 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 和一个势能算符 $\\hat{V}(x, \\psi) = V_{\\mathrm{ext}}(x) + g\\,|\\psi(x,t)|^2$ 组成，后者包含一个依赖于波函数密度本身的项。\n\n为了找到基态，我们采用虚时演化方法。这是通过替换 $t \\to -i\\tau$ 实现的，将薛定谔方程转换为一个在虚时变量 $\\tau$ 中的扩散型方程：\n$$\n\\frac{\\partial \\psi(x,\\tau)}{\\partial \\tau} \\;=\\; -\\hat{H}\\psi(x,\\tau)\n$$\n该方程在一个小时间步 $\\Delta\\tau$ 上的形式解为 $\\psi(x, \\tau+\\Delta\\tau) = e^{-\\hat{H}\\Delta\\tau}\\psi(x,\\tau)$。当一个任意的初始态按此规则演化时，对应于较高能量本征态的分量会比基态分量衰减得更快。通过重复应用演化算符并在每一步重新归一化波函数，状态将收敛到基态，即 $\\hat{H}$ 的最低本征值对应的本征态。\n\n演化算符 $e^{-\\hat{H}\\Delta\\tau} = e^{-(\\hat{T} + \\hat{V})\\Delta\\tau}$ 难以直接计算，因为动能算符 $\\hat{T}$ 和势能算符 $\\hat{V}$ 不对易（$\\left[\\hat{T}, \\hat{V}\\right] \\neq 0$）。分裂算符方法通过将动能和势能的演化分开来近似该演化过程。这里采用一种二阶精度的对称分裂，也称为 Strang 分裂：\n$$\ne^{-(\\hat{T} + \\hat{V})\\Delta\\tau} \\approx e^{-\\hat{V}\\Delta\\tau/2} \\, e^{-\\hat{T}\\Delta\\tau} \\, e^{-\\hat{V}\\Delta\\tau/2} + O(\\Delta\\tau^3)\n$$\n这个格式在算法上实现为从 $\\tau$ 到 $\\tau + \\Delta\\tau$ 的单个时间步：\n\n1.  **势能半步：** 波函数首先在势能算符下演化半步 $\\Delta\\tau/2$。此操作在位置空间中是局域的，相当于一次简单的乘法。对于非线性 GPE，势能必须使用当前状态 $\\psi(x,\\tau)$ 计算：\n    $$\n    \\psi'(x) = e^{-(V_{\\mathrm{ext}}(x) + g|\\psi(x,\\tau)|^2)\\Delta\\tau/2} \\psi(x,\\tau)\n    $$\n2.  **动能全步：** 动能算符 $\\hat{T}$ 在动量（或 $k$）空间中是局域的。使用快速傅里叶变换（FFT）可以最有效地执行演化。状态 $\\psi'(x)$ 被变换到傅里叶空间，$\\tilde{\\psi}'(k) = \\mathcal{F}\\{\\psi'(x)\\}$。在此基底下，动能算符是对角的，$\\hat{T}_k = k^2/2$，因此演化是一次乘法：\n    $$\n    \\tilde{\\psi}''(k) = e^{-k^2\\Delta\\tau/2} \\tilde{\\psi}'(k)\n    $$\n    然后将结果变换回位置空间：$\\psi''(x) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''(k)\\}$。波矢网格 $k_j$ 必须与空间网格 $x_j$ 一致，这可以通过 `fftfreq` 函数实现，其中 $k_j = 2\\pi f_j$，$f_j$ 是离散频率。对于长度为 $L$、有 $N$ 个点且网格间距为 $\\Delta x = L/N$ 的空间域，波矢为 $k = 2\\pi \\cdot \\texttt{fftfreq}(N, d=\\Delta x)$。\n\n3.  **势能半步（第二次）：** 最后在势能算符下再演化半步 $\\Delta\\tau/2$ 以完成对称步。为确保对称性和稳定性，使用更新后的波函数 $\\psi''(x)$ 重新计算势能：\n    $$\n    \\psi(x, \\tau+\\Delta\\tau)_{\\text{un-norm}} = e^{-(V_{\\mathrm{ext}}(x) + g|\\psi''(x)|^2)\\Delta\\tau/2} \\psi''(x)\n    $$\n4.  **归一化：** 由于虚时演化不保持范数，因此必须在每个完整步骤后对波函数进行重新归一化，以维持物理约束 $\\int |\\psi|^2 dx = 1$。积分由黎曼和近似：$I = \\sum_j |\\psi_j|^2 \\Delta x$。然后波函数更新为 $\\psi_j \\to \\psi_j / \\sqrt{I}$。\n\n经过足够多的步数 $N_{\\mathrm{steps}}$ 后，波函数 $\\psi(x)$ 收敛到稳态基态。化学势 $\\mu$ 是对应于此状态的本征值，由稳态 GPE 定义：$\\hat{H}\\psi(x) = \\mu\\psi(x)$。$\\mu$ 的值计算为哈密顿算符关于最终归一化态的期望值：\n$$\n\\mu = \\langle \\psi | \\hat{H} | \\psi \\rangle = \\int \\psi^*(x) \\hat{H} \\psi(x) \\, dx\n$$\n这个期望值是三个能量贡献的总和：\n- **动能：** $E_{kin} = \\int \\psi^*(x) \\left(-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}\\right) \\psi(x) \\, dx$。这可以在傅里叶空间中高效计算：$E_{kin} = \\int \\tilde{\\psi}^*(k) \\left(\\frac{k^2}{2}\\right) \\tilde{\\psi}(k) \\, dk$。在数值上，这等于 $\\sum_j |\\tilde{\\psi}_j|^2 \\frac{k_j^2}{2}$（有适当的 FFT 归一化），或者更直接地，通过将动能算符应用于 $\\psi$ 并计算内积：$E_{kin} \\approx \\Delta x \\sum_j \\psi_j^* \\mathcal{F}^{-1}\\{ (k^2/2) \\mathcal{F}\\{\\psi_j\\} \\}$。\n- **外势能：** $E_{pot, ext} = \\int V_{\\mathrm{ext}}(x) |\\psi(x)|^2 \\, dx$。这通过求和 $\\Delta x \\sum_j V_{\\mathrm{ext}}(x_j) |\\psi_j|^2$ 来近似。\n- **相互作用能：** $E_{int} = \\int g |\\psi(x)|^4 \\, dx$。这通过求和 $\\Delta x \\sum_j g |\\psi_j|^4$ 来近似。\n\n化学势是总和 $\\mu = E_{kin} + E_{pot, ext} + E_{int}$。该算法应用于指定的三个测试案例，得出它们各自的化学势。", "answer": "```python\nimport numpy as np\nfrom scipy.fft import fft, ifft, fftfreq\n\ndef compute_mu(params):\n    \"\"\"\n    Computes the chemical potential for a given Gross-Pitaevskii equation setup\n    using imaginary-time propagation with a split-operator method.\n\n    Args:\n        params (dict): A dictionary containing all simulation parameters.\n\n    Returns:\n        float: The computed chemical potential, mu.\n    \"\"\"\n    # Unpack parameters\n    L = params[\"L\"]\n    N = params[\"N\"]\n    g = params[\"g\"]\n    V_ext_func = params[\"V_ext_func\"]\n    dt = params[\"dt\"]\n    N_steps = params[\"N_steps\"]\n    psi0_func = params[\"psi0_func\"]\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = np.linspace(-L / 2, L / 2, num=N, endpoint=False)\n    k = 2 * np.pi * fftfreq(N, d=dx)\n\n    # 2. Setup kinetic operator and external potential\n    T_k = 0.5 * k**2\n    kinetic_propagator = np.exp(-T_k * dt)\n    V_ext = V_ext_func(x)\n\n    # 3. Setup initial wavefunction and normalize it\n    psi = psi0_func(x).astype(np.complex128)\n    norm_sq = np.sum(np.abs(psi)**2) * dx\n    psi /= np.sqrt(norm_sq)\n\n    # 4. Imaginary time evolution loop\n    for _ in range(N_steps):\n        # Symmetric split-operator step: V/2, T, V/2\n        V_eff = V_ext + g * np.abs(psi)**2\n        psi *= np.exp(-V_eff * dt / 2.0)\n\n        psi_k = fft(psi)\n        psi_k *= kinetic_propagator\n        psi = ifft(psi_k)\n        \n        V_eff = V_ext + g * np.abs(psi)**2\n        psi *= np.exp(-V_eff * dt / 2.0)\n\n        norm_sq = np.sum(np.abs(psi)**2) * dx\n        psi /= np.sqrt(norm_sq)\n\n    # 5. Calculate the chemical potential mu\n    psi_k = fft(psi)\n    H_psi = ifft(T_k * psi_k) + (V_ext + g * np.abs(psi)**2) * psi\n    mu = np.real(np.sum(np.conj(psi) * H_psi) * dx)\n    \n    return mu\n\ndef solve_and_print():\n    \"\"\"\n    Runs all test cases and prints the results in the required format.\n    \"\"\"\n    # Case A\n    params_A = {\n        \"L\": 20.0, \"N\": 512, \"g\": 0.0,\n        \"V_ext_func\": lambda x: 0.5 * 1.0**2 * x**2,\n        \"dt\": 0.001, \"N_steps\": 2500,\n        \"psi0_func\": lambda x: np.exp(-x**2 / (2 * 1.0**2))\n    }\n    mu_A = compute_mu(params_A)\n\n    # Case B\n    params_B = {\n        \"L\": 20.0, \"N\": 512, \"g\": 1.0,\n        \"V_ext_func\": lambda x: 0.5 * 1.0**2 * x**2,\n        \"dt\": 0.001, \"N_steps\": 2500,\n        \"psi0_func\": lambda x: np.exp(-x**2 / (2 * 1.0**2))\n    }\n    mu_B = compute_mu(params_B)\n\n    # Case C\n    params_C = {\n        \"L\": 10.0, \"N\": 512, \"g\": 2.0,\n        \"V_ext_func\": lambda x: np.zeros_like(x),\n        \"dt\": 0.001, \"N_steps\": 10,\n        \"psi0_func\": lambda x: np.ones_like(x) / np.sqrt(10.0)\n    }\n    mu_C = compute_mu(params_C)\n\n    print(f\"[{mu_A:.6f},{mu_B:.6f},{mu_C:.6f}]\")\n\nsolve_and_print()\n```", "id": "2441319"}]}