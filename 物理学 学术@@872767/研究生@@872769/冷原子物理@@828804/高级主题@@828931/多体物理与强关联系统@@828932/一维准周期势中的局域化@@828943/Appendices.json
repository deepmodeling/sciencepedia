{"hands_on_practices": [{"introduction": "在探索由准周期势引起的显著局域化效应之前，理解当势场较弱（即在所谓的金属相中）时系统的行为是很有启发性的。此练习 [@problem_id:1251893] 应用标准的微扰理论来计算对 Aubry-André 模型总能带宽度的修正。这项实践不仅能巩固基本的量子力学技术，还能为我们理解准周期性在 $V \\ll J$ 极限下如何初步影响系统提供定量的认识。", "problem": "Aubry-André 模型描述了一个具有准周期在位势的一维紧束缚链。它是研究低维系统中局域化相变的经典模型。其哈密顿量由以下公式给出：\n$$\nH = -J \\sum_{n=-\\infty}^{\\infty} (|n\\rangle\\langle n+1| + |n+1\\rangle\\langle n|) + V \\sum_{n=-\\infty}^{\\infty} \\cos(2\\pi\\alpha n + \\phi) |n\\rangle\\langle n|\n$$\n这里， $|n\\rangle$ 表示位于无限长链上格点 $n$ 的局域电子态，$J$ 是最近邻跃迁振幅 ($J0$)，$V$ 是在位势的振幅。参数 $\\alpha$ 是一个无理数，代表势的准周期性，而 $\\phi$ 是一个恒定的相位偏移。\n\n总能带宽度 $W$ 定义为系统最大和最小能量本征值之差，$W = E_{max} - E_{min}$。当 $V=0$ 时，该系统是一个简单的紧束缚链，其能带宽度为 $W_0=4J$。\n\n在弱势极限下，$V \\ll J$，准周期势的影响可以用微扰理论来处理。求总能带宽度的最低阶非零修正量 $\\Delta W$。最终结果应用 $J$、$V$ 和 $\\alpha$ 表示。你可以假设结果与相位 $\\phi$ 无关。", "solution": "1.  **未扰动系统与能带**: 当势 $V=0$ 时，系统是标准的紧束缚链，其能量色散关系为 $E^{(0)}(k) = -2J\\cos(k)$，其中 $k$ 是晶格动量。能带的最小值和最大值分别在 $k=0$ 和 $k=\\pi$ 处取得，为 $E_{\\min}^{(0)} = -2J$ 和 $E_{\\max}^{(0)} = 2J$。因此，未扰动的能带宽度为 $W_0 = E_{\\max}^{(0)} - E_{\\min}^{(0)} = 4J$。\n2.  **微扰哈密顿量**: 准周期势 $H' = V \\sum_n \\cos(2\\pi\\alpha n + \\phi) |n\\rangle\\langle n|$ 作为微扰项。在动量表象中，它主要将态 $|k\\rangle$ 与态 $|k \\pm 2\\pi\\alpha\\rangle$ 耦合，矩阵元为 $V/2$（忽略相位 $\\phi$）。\n3.  **带边能量的二阶修正**: 根据二阶微扰理论，能量的修正是 $\\Delta E_k = \\sum_{k' \\neq k} \\frac{|\\langle k|H'|k'\\rangle|^2}{E_k^{(0)} - E_{k'}^{(0)}}$。我们计算能带两端（$k=0$ 和 $k=\\pi$）的能量修正。\n4.  **下边缘修正 ($k=0$)**: $E_0^{(0)} = -2J$。主要耦合到 $k'=\\pm 2\\pi\\alpha$。能量分母为 $E_0^{(0)} - E_{\\pm 2\\pi\\alpha}^{(0)} = -2J - (-2J\\cos(\\pm 2\\pi\\alpha)) = -2J(1-\\cos(2\\pi\\alpha)) = -4J\\sin^2(\\pi\\alpha)$。因此，最低能量的修正是 $\\Delta E_{\\min} = 2 \\times \\frac{(V/2)^2}{-4J\\sin^2(\\pi\\alpha)} = -\\frac{V^2}{8J\\sin^2(\\pi\\alpha)}$。\n5.  **上边缘修正 ($k=\\pi$)**: $E_\\pi^{(0)} = 2J$。主要耦合到 $k'=\\pi \\pm 2\\pi\\alpha$。能量分母为 $E_\\pi^{(0)} - E_{\\pi \\pm 2\\pi\\alpha}^{(0)} = 2J - (-2J\\cos(\\pi \\pm 2\\pi\\alpha)) = 2J(1+\\cos(\\pi \\pm 2\\pi\\alpha)) = 2J(1-\\cos(2\\pi\\alpha)) = 4J\\sin^2(\\pi\\alpha)$。因此，最高能量的修正是 $\\Delta E_{\\max} = 2 \\times \\frac{(V/2)^2}{4J\\sin^2(\\pi\\alpha)} = \\frac{V^2}{8J\\sin^2(\\pi\\alpha)}$。\n6.  **总能带宽度修正**: 新的能带宽度为 $W = (E_{\\max}^{(0)} + \\Delta E_{\\max}) - (E_{\\min}^{(0)} + \\Delta E_{\\min}) = W_0 + \\Delta E_{\\max} - \\Delta E_{\\min}$。带宽度的修正量为 $\\Delta W = \\Delta E_{\\max} - \\Delta E_{\\min} = \\frac{V^2}{8J\\sin^2(\\pi\\alpha)} - (-\\frac{V^2}{8J\\sin^2(\\pi\\alpha)}) = 2 \\times \\frac{V^2}{8J\\sin^2(\\pi\\alpha)} = \\frac{V^2}{4J\\sin^2(\\pi\\alpha)}$。", "answer": "$$\\boxed{\\frac{V^2}{4J\\sin^2(\\pi\\alpha)}}$$", "id": "1251893"}, {"introduction": "绝缘相的标志是所有本征态的指数局域化，其特征是存在一个有限的局域化长度。这个问题 [@problem_id:1239777] 将引导你利用 Aubry-André 模型中一个强大而优美的概念——自对偶性，来推导系统刚进入局域化相（$V > 2J$）时的局域化长度表达式。这个计算为了解金属-绝缘相变的本质以及局域态的涌现提供了深刻的物理洞察。", "problem": "一束超冷原子气体被囚禁在产生周期性势的一维光晶格中。第二束与第一束共向传播但频率不通约的激光束，会产生一个额外的准周期势。在紧束缚近似下，该系统可以用 Aubry-André 哈密顿量来描述：\n$$H = \\sum_n \\left( -J (|n+1\\rangle\\langle n| + |n\\rangle\\langle n+1|) + V_n |n\\rangle\\langle n| \\right)$$\n其中 $|n\\rangle$ 是局域在格点 $n$ 处的 Wannier 态，$J > 0$ 是相邻格点之间的常数跃迁振幅，$V_n = V_0 \\cos(2\\pi \\alpha n)$ 是在位势，其振幅为 $V_0$，$\\alpha$ 是一个无理数。晶格常数用 $a$ 表示。\n\n该模型在临界势强度下会发生金属-绝缘体相变。当 $V_0  2J$ 时，所有本征态都是扩展的；而当 $V_0 > 2J$ 时，所有本征态都是指数局域的。一个以格点 $n_0$ 为中心、能量为 $E$ 的局域本征态，其包络线按 $|\\psi_n(E)| \\sim \\exp(-|n-n_0|/\\xi)$ 的形式衰减，其中 $\\xi$ 是局域长度。局域长度 $\\xi$ 通过 $\\xi = a/\\gamma$ 与 Lyapunov 指数 $\\gamma$ 相关联。\n\n为了帮助您计算，我们给出了无量纲薛定谔方程 $\\varepsilon\\phi_n = \\phi_{n+1}+\\phi_{n-1} + 2\\lambda\\cos(2\\pi\\alpha n)\\phi_n$ 的以下理论结果：\n1.  当 $|\\lambda| > 1$ 时，Lyapunov 指数 $\\gamma(\\varepsilon, \\lambda)$ 满足对偶关系：$\\gamma(\\varepsilon, \\lambda) = \\gamma(\\varepsilon/\\lambda, 1/\\lambda) + \\ln|\\lambda|$。\n2.  当 $|\\lambda|  1$ 时，系统处于金属相，具有纯粹的绝对连续能谱。在此相中，对于谱内的任何能量 $\\varepsilon$，Lyapunov 指数 $\\gamma(\\varepsilon, \\lambda)$ 均为零。\n\n您的任务是计算当势强度 $V_0$ 略大于临界值 $2J$ 时，局域长度 $\\xi$ 的领头阶表达式。请用 $J$、$V_0$ 和晶格常数 $a$ 来表示您的答案。", "solution": "我们将 Aubry–André 哈密顿量映射到无量纲的紧束缚方程：\n$$\\varepsilon\\phi_n = \\phi_{n+1}+\\phi_{n-1}+2\\lambda\\cos(2\\pi\\alpha n)\\,\\phi_n$$\n其中 $\\lambda = V_0 / (2J)$。局域长度为 $\\xi = a/\\gamma$，其中 $\\gamma$ 是 Lyapunov 指数。\n\n1.  当 $|\\lambda| > 1$ 时（对应于 $V_0 > 2J$），对偶性关系给出：\n    $$\\gamma(\\varepsilon, \\lambda) = \\gamma(\\varepsilon/\\lambda, 1/\\lambda) + \\ln|\\lambda|$$\n2.  因为当 $|\\lambda| > 1$ 时，我们有 $|1/\\lambda|  1$。这意味着参数为 $1/\\lambda$ 的对偶系统处于金属相。因此，其 Lyapunov 指数为零，即 $\\gamma(\\varepsilon/\\lambda, 1/\\lambda) = 0$。\n3.  将此代入对偶关系，我们得到 Lyapunov 指数的精确表达式：\n    $$\\gamma = \\ln|\\lambda| = \\ln\\left(\\frac{V_0}{2J}\\right)$$\n4.  因此，精确的局域长度是：\n    $$\\xi = \\frac{a}{\\gamma} = \\frac{a}{\\ln\\left(\\frac{V_0}{2J}\\right)}$$\n5.  对于 $V_0$ 略大于 $2J$ 的情况，设 $V_0 = 2J + \\delta$，其中 $\\delta \\ll 2J$。利用对数近似 $\\ln(1+x) \\approx x$ for small $x$：\n    $$\\ln\\left(\\frac{V_0}{2J}\\right) = \\ln\\left(\\frac{2J+\\delta}{2J}\\right) = \\ln\\left(1+\\frac{\\delta}{2J}\\right) \\approx \\frac{\\delta}{2J} = \\frac{V_0-2J}{2J}$$\n6.  因此，局域长度的领头阶表达式为：\n    $$\\xi \\approx \\frac{a}{\\frac{V_0-2J}{2J}} = \\frac{2aJ}{V_0-2J}$$", "answer": "$$\\boxed{\\frac{2aJ}{V_0-2J}}$$", "id": "1239777"}, {"introduction": "解析方法在特定极限下能提供精确的结果，而数值模拟则为探索系统的完整行为提供了一种强有力的方式。在此练习 [@problem_id:2387593] 中，你将通过编写程序来计算反参与率（IPR），这是一个用以量化本征态空间延展性的关键指标。通过计算并分析不同势场强度下的 IPR，你将能从数值上清晰地描绘并“看”到从扩展态到局域态的整个金属-绝缘相变过程。", "problem": "考虑一个具有准周期在位势的一维紧束缚薛定谔算符，称为 Aubry-André (AA) 模型。在一个长度为 $N$、具有开放边界的有限链上，并使用能量单位使得最近邻跃迁振幅为 $t=1$，在由 $n \\in \\{0,1,\\dots,N-1\\}$ 索引的格点上的稳态薛定谔方程为\n$$\n\\psi_{n-1} + \\psi_{n+1} + 2\\lambda \\cos\\!\\big(2\\pi \\beta n + \\phi\\big)\\,\\psi_n \\;=\\; E\\,\\psi_n,\n$$\n约定 $\\psi_{-1}=\\psi_{N}=0$ 以施加开放边界条件。此处，$E$ 表示能量本征值，$\\lambda$ 是势强度，$\\beta$ 是一个设定准周期性的无理频率，$\\phi$ 是一个相位（单位为弧度）。这定义了一个实对称 $N\\times N$ 矩阵（哈密顿量），其矩阵元为\n$$\nH_{n,n} \\;=\\; 2\\lambda \\cos\\!\\big(2\\pi \\beta n + \\phi\\big),\\quad\nH_{n,n+1} \\;=\\; H_{n+1,n} \\;=\\; 1,\\quad\nH_{i,j}\\;=\\;0\\ \\text{其它情况}.\n$$\n对于每个参数集，完整谱是求解 $H\\,\\psi^{(k)}=E_k\\,\\psi^{(k)}$ 的 $N$ 个实数本征值 $E_k$ 和相应的归一化本征矢量 $\\psi^{(k)}$ 的集合。为量化本征态的局域化程度，使用逆参与率 (IPR)，对于一个归一化的本征矢量 $\\psi^{(k)}$，其定义为\n$$\n\\mathrm{IPR}_k \\;=\\; \\sum_{n=0}^{N-1} \\big|\\psi^{(k)}_n\\big|^4,\n$$\n并定义整个谱上的平均 IPR 为\n$$\n\\overline{\\mathrm{IPR}} \\;=\\; \\frac{1}{N}\\sum_{k=1}^{N} \\mathrm{IPR}_k.\n$$\n延展态的 $\\mathrm{IPR}$ 值随 $N$ 增加按 $1/N$ 标度变化，而局域态的 $\\mathrm{IPR}$ 值随 $N$ 增加保持有限。在此模型中，金属-绝缘体相变发生在一个临界势强度处，该强度将主要为延展的本征态与主要为局域的本征态分开。\n\n任务：对于以下参数值的测试套件，为每种情况构建哈密顿量 $H$，计算所有本征值和相应的归一化本征矢量，计算每种情况的 $\\overline{\\mathrm{IPR}}$，并报告结果。使用 $\\beta = (\\sqrt{5}-1)/2$ 以及以弧度为单位指定的角度 $\\phi$。如上所述，跃迁振幅固定为 $t=1$。\n\n测试套件：\n- 情况 1：$N=144$, $\\lambda=0.0$, $\\beta = (\\sqrt{5}-1)/2$, $\\phi=0.0$。\n- 情况 2：$N=144$, $\\lambda=0.5$, $\\beta = (\\sqrt{5}-1)/2$, $\\phi=0.0$。\n- 情况 3：$N=144$, $\\lambda=1.0$, $\\beta = (\\sqrt{5}-1)/2$, $\\phi=0.0$。\n- 情况 4：$N=144$, $\\lambda=2.5$, $\\beta = (\\sqrt{5}-1)/2$, $\\phi=0.0$。\n\n您的程序必须输出单行，其中包含按上述顺序列出的各种情况的 $\\overline{\\mathrm{IPR}}$ 值列表，四舍五入到六位小数，并精确格式化为方括号括起来的逗号分隔列表，例如：$[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是一个小数点后有六位数字的小数，无额外文本。答案中无需物理单位，因为在所选单位中能量是无量纲的，角度以弧度为单位指定。", "solution": "问题陈述经审查有效。这是一个在计算物理学中适定且有科学依据的问题，没有矛盾或歧义。任务是计算 Aubry-André 模型的平均逆参与率（$\\overline{\\mathrm{IPR}}$），这是一个用于研究准周期系统和局域化现象的典范模型。\n\n物理系统是一个具有开放边界条件的 $N$ 个格点组成的一维链。量子粒子在该链上的稳态由离散不含时薛定谔方程描述：\n$$\n\\psi_{n-1} + \\psi_{n+1} + V_n \\psi_n = E \\psi_n\n$$\n其中 $\\psi_n$ 是在格点 $n$ 处的波函数振幅，$E$ 是能量本征值，跃迁振幅 $t$ 设为 $1$。在位势 $V_n$ 由准周期函数 $V_n = 2\\lambda \\cos(2\\pi \\beta n + \\phi)$ 给出，其中 $\\lambda$ 是势强度，$\\beta$ 是一个无理数，$\\phi$ 是一个相移。通过设置 $\\psi_{-1} = \\psi_{N} = 0$ 来施加开放边界条件。\n\n这个方程可以被表述为一个矩阵本征值问题，$H\\psi = E\\psi$。哈密顿量 $H$ 是一个实对称 $N \\times N$ 矩阵。其矩阵元定义如下：\n- 对角元，对应在位势：对于 $n \\in \\{0, 1, \\dots, N-1\\}$，$H_{n,n} = 2\\lambda \\cos(2\\pi \\beta n + \\phi)$。\n- 非对角元，对应最近邻跃迁：对于 $n \\in \\{0, 1, \\dots, N-2\\}$，$H_{n,n+1} = H_{n+1,n} = 1$。\n- 所有其他矩阵元为零，$H_{i,j}=0$。\n这种结构使得 $H$ 成为一个三对角矩阵。\n\n由于 $H$ 是一个实对称矩阵，它保证有 $N$ 个实数本征值 $E_k$ 和一个由 $N$ 个标准正交本征矢量 $\\psi^{(k)}$ 组成的完备集，其中 $k \\in \\{0, 1, \\dots, N-1\\}$。标准正交条件是 $\\sum_{n=0}^{N-1} \\psi_n^{(k)*} \\psi_n^{(j)} = \\delta_{kj}$，其中 $\\delta_{kj}$ 是克罗内克 δ 函数。由于本征矢量是实数，这简化为 $\\sum_{n=0}^{N-1} \\psi_n^{(k)} \\psi_n^{(j)} = \\delta_{kj}$。\n\n为了量化本征态的局域化程度，我们使用逆参与率 (IPR)。对于一个归一化的本征矢量 $\\psi^{(k)}$，IPR 定义为：\n$$\n\\mathrm{IPR}_k = \\sum_{n=0}^{N-1} \\big|\\psi^{(k)}_n\\big|^4\n$$\n一个完全局域在单个格点 $j$ 上的本征态将有 $\\psi_n^{(k)} = \\delta_{nj}$，得出 $\\mathrm{IPR}_k = 1$。一个在所有 $N$ 个格点上完全离域的态将有 $|\\psi_n^{(k)}| = 1/\\sqrt{N}$，得出 $\\mathrm{IPR}_k = N \\times (1/\\sqrt{N})^4 = 1/N$。因此，IPR 提供了一种度量，衡量一个本征态显著占据了多少个格点。\n\n问题要求计算平均 IPR，$\\overline{\\mathrm{IPR}}$，即谱上所有本征态的 IPR 值的算术平均值：\n$$\n\\overline{\\mathrm{IPR}} = \\frac{1}{N} \\sum_{k=0}^{N-1} \\mathrm{IPR}_k\n$$\n每个测试用例的计算步骤如下：\n$1$. 给定参数 $N$、$\\lambda$、$\\beta$ 和 $\\phi$，按上述方法构建 $N \\times N$ 哈密顿矩阵 $H$。\n$2$. 使用数值本征求解器，例如 `numpy.linalg.eigh`，计算所有 $N$ 个本征值及其对应的归一化本征矢量。此函数适用于实对称矩阵。\n$3$. 对于得到的 $N$ 个本征矢量 $\\psi^{(k)}$ 中的每一个，根据定义计算其 IPR。\n$4$. 计算 $N$ 个 IPR 值的平均值，得到 $\\overline{\\mathrm{IPR}}$。\n\n此过程将应用于测试套件中提供的四个参数集中的每一个。参数 $\\beta$ 固定为黄金分割比的倒数，$\\beta = (\\sqrt{5}-1)/2$。结果将以单一格式化列表的形式报告。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# language: Python\n# version: 3.12\n# libraries:\n#     name: numpy, version: 1.23.5\n\ndef calculate_mean_ipr(N, lam, beta, phi):\n    \"\"\"\n    Constructs the Aubry-André Hamiltonian and computes the mean IPR.\n\n    Args:\n        N (int): The size of the lattice chain.\n        lam (float): The potential strength lambda.\n        beta (float): The irrational frequency.\n        phi (float): The phase shift in radians.\n\n    Returns:\n        float: The mean Inverse Participation Ratio (IPR) over all eigenstates.\n    \"\"\"\n    # 1. Construct the Hamiltonian matrix H\n    \n    # Onsite potential for the diagonal elements\n    n_indices = np.arange(N)\n    diagonal_elements = 2 * lam * np.cos(2 * np.pi * beta * n_indices + phi)\n    \n    # Nearest-neighbor hopping for the off-diagonal elements\n    off_diagonal_elements = np.ones(N - 1)\n    \n    # Assemble the N x N Hamiltonian matrix H\n    # H is a real, symmetric, tridiagonal matrix\n    H = np.diag(diagonal_elements) + np.diag(off_diagonal_elements, k=1) + np.diag(off_diagonal_elements, k=-1)\n    \n    # 2. Solve the eigenvalue problem H*psi = E*psi\n    # np.linalg.eigh is used for Hermitian (or real symmetric) matrices.\n    # It returns eigenvalues in ascending order and corresponding\n    # normalized eigenvectors as columns in the 'eigenvectors' matrix.\n    eigenvalues, eigenvectors = np.linalg.eigh(H)\n    \n    # 3. Calculate the IPR for each eigenvector\n    # For a normalized eigenvector psi_k, IPR_k = sum_n |psi_k(n)|^4.\n    # The eigenvectors are real, so np.abs() is not strictly necessary but is good practice.\n    psi_4 = np.power(np.abs(eigenvectors), 4)\n    \n    # Sum over the lattice sites n (axis 0) to get the IPR for each state k.\n    ipr_per_state = np.sum(psi_4, axis=0)\n    \n    # 4. Compute the mean IPR over all N states\n    mean_ipr = np.mean(ipr_per_state)\n    \n    return mean_ipr\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    # Define the irrational frequency, beta (inverse golden ratio)\n    beta = (np.sqrt(5) - 1) / 2\n    \n    # Define the test cases from the problem statement\n    # Each case is a tuple: (N, lambda, phi)\n    test_cases = [\n        (144, 0.0, 0.0),  # Case 1: lambda=0.0 (delocalized)\n        (144, 0.5, 0.0),  # Case 2: lambda=0.5 (delocalized)\n        (144, 1.0, 0.0),  # Case 3: lambda=1.0 (critical point)\n        (144, 2.5, 0.0),  # Case 4: lambda=2.5 (localized)\n    ]\n\n    results = []\n    for N, lam, phi in test_cases:\n        # Calculate the mean IPR for the current set of parameters\n        result = calculate_mean_ipr(N, lam, beta, phi)\n        results.append(result)\n\n    # Format the results to six decimal places as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2387593"}]}