## 引言
在晶体物理学中，[布洛赫定理](@entry_id:137461)告诉我们，电子[波函数](@entry_id:147440)以扩展的[布洛赫波](@entry_id:144558)形式存在，这种[动量空间](@entry_id:148936)的图像在解释[能带结构](@entry_id:139379)和[电导](@entry_id:177131)性质方面取得了巨大成功。然而，对于许多物理现象，如化学键的形成、电极化以及局域电子关联效应，一种实空间的、局域化的描述方式往往更加直观且有效。如何将在整个晶体中离域的[布洛赫态](@entry_id:147552)，与化学家和材料学家所熟悉的[原子轨道](@entry_id:140819)或成键轨道图像联系起来，便成了一个关键的理论问题。[瓦尼尔函数](@entry_id:145994)正是为解决这一知识鸿沟而提出的核心概念。

本文系统地介绍了瓦尼尔函数及其最重要的变体——最大局域化[瓦尼尔函数](@entry_id:145994)（MLWF）。我们将探讨从[布洛赫波](@entry_id:144558)出发构造瓦尼尔函数时所固有的规范自由度问题，以及如何通过一个优美的[最优化原理](@entry_id:147533)来获得一组最局域、物理意义最清晰的实空间[轨道](@entry_id:137151)。

为全面掌握这一强大工具，本文将分为三个部分展开：在“原理与机制”一章中，我们将深入其数学定义，揭示规范自由度如何影响其局域性，并详细阐述最小化展宽的机制，包括[贝里联络](@entry_id:136662)所扮演的关键角色。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示MLWF如何作为连接[第一性原理计算](@entry_id:198754)与[紧束缚模型](@entry_id:143446)、[电极化现代理论](@entry_id:147035)以及拓扑[物态](@entry_id:139436)表征的桥梁，在凝聚态物理、[材料科学](@entry_id:152226)和[量子化学](@entry_id:140193)等领域大放异彩。最后，通过一系列精心设计的“动手实践”，读者将有机会巩固核心概念，为在研究中实际应用这些方法打下坚实基础。

## 原理与机制

在上一章中，我们介绍了[晶格](@entry_id:196752)中粒子的[量子态](@entry_id:146142)可以用扩展的[布洛赫波](@entry_id:144558)来描述。然而，对于许多物理性质，特别是那些与局域化学键和电极化相关的性质，一种[实空间](@entry_id:754128)的、局域化的图像更为直观和有效。[瓦尼尔函数](@entry_id:145994)（Wannier functions）正是为此而生，它提供了一套与[布洛赫态](@entry_id:147552)等价的局域化正交基。本章将深入探讨瓦尼尔函数的构建原理、最大局域化方法以及其中的关键机制。

### 瓦尼尔函数的定义与性质

从给定的一个能带的[布洛赫函数](@entry_id:189422) $|\psi_{n\mathbf{k}}\rangle$ 出发，我们可以通过[傅里叶变换](@entry_id:142120)构建一组局域在各个原胞的瓦尼尔函数。对于一维[晶格](@entry_id:196752)，其晶格常数为 $a$，第 $n$ 个能带对应的、局域在格点 $R_m = ma$ 的[瓦尼尔函数](@entry_id:145994) $W_m(x)$ 定义为：

$$ W_m(x) = \frac{a}{2\pi} \int_{-\pi/a}^{\pi/a} dk \, e^{-ikR_m} \psi_k(x) $$

其中积分范围覆盖了整个[第一布里渊区](@entry_id:269110)。注意到[布洛赫函数](@entry_id:189422)的形式为 $\psi_k(x) = e^{ikx} u_k(x)$，其中 $u_k(x)$ 是具有[晶格](@entry_id:196752)周期性的函数，即 $u_k(x+a) = u_k(x)$。通过简单的变量代换可以证明，不同格点的瓦尼尔函数仅仅是中心在原点的[瓦尼尔函数](@entry_id:145994) $W_0(x)$ 的平移：

$$ W_m(x) = W_0(x-R_m) $$

因此，我们通常只关注中心在原点的瓦尼尔函数 $W(x) \equiv W_0(x)$：

$$ W(x) = \frac{a}{2\pi} \int_{-\pi/a}^{\pi/a} dk \, \psi_k(x) = \frac{a}{2\pi} \int_{-\pi/a}^{\pi/a} dk \, e^{ikx} u_k(x) $$

这个定义表明，[瓦尼尔函数](@entry_id:145994)的形状完全由[布洛赫函数](@entry_id:189422)周期部分 $u_k(x)$ 在整个布里渊区内的行为所决定。

为了具体理解这一点，我们可以考虑一个一维单能带模型，其中 $u_k(x)$ 具有一个特定的形式：$u_k(x) = C ( 1 + \beta \cos(ka) \cos(\frac{2\pi x}{a}) )$，这里 $C$ 是归一化常数，$\beta$ 是一个实数参数 [@problem_id:1279714]。通过直接进行傅里叶积分，我们可以得到[瓦尼尔函数](@entry_id:145994)的解析表达式。积分可以分解为两部分，第一部分对应于 $u_k(x)$ 中的常数项“1”，其[傅里叶变换](@entry_id:142120)产生一个 $\mathrm{sinc}$ 函数，即 $\frac{\sin(\pi x/a)}{\pi x/a}$，它在 $x=0$ 处取得峰值，并在远离中心时衰减。第二部分来自于 $\cos(ka)$ 项，它在[傅里叶变换](@entry_id:142120)后，产生两个分别位于 $x=-a$ 和 $x=a$ 的 $\mathrm{sinc}$ 函数的叠加。最终，$W(x)$ 的形式是一个中心在原点的 $\mathrm{sinc}$ 函数与两个[旁瓣](@entry_id:270334)（side-lobes）在 $x=\pm a$ 的 $\mathrm{sinc}$ 函数的线性组合。这个例子清晰地展示了 $u_k(x)$ 中 $k$ 的依赖性如何转化为 $W(x)$ 在[实空间](@entry_id:754128)中的具体形态。

此外，瓦尼尔函数的一个重要性质是它们构成了一套正交归一的[基矢](@entry_id:199546)。源自不同格点的[瓦尼尔函数](@entry_id:145994)是正交的：

$$ \langle W_m | W_p \rangle = \int dx \, W_m^*(x) W_p(x) = \delta_{mp} $$

这一性质可以直接从它们的定义和布洛赫[函数的正交性](@entry_id:160337)推导出来，确保了瓦尼尔函数可以作为描述该能带电子态的[完备基](@entry_id:143908)矢。

### 规范自由度与局域化问题

在定义[瓦尼尔函数](@entry_id:145994)时，我们有一个未被固定的自由度。对于一个（或一组）能带，我们可以对[布洛赫函数](@entry_id:189422)进行一个任意的、依赖于 $k$ 的幺正变换（gauge transformation），而不改变其物理可观测量，如能带结构。对于单个孤立能带，这个变换就是一个相位因子 $e^{i\theta(k)}$：

$$ |\psi_k\rangle \to |\tilde{\psi}_k\rangle = e^{i\theta(k)} |\psi_k\rangle $$

这个变换被称为**规范自由度**。然而，这个相位选择会深刻地影响[瓦尼尔函数](@entry_id:145994)的形状和局域性。新的瓦尼尔函数将变为：

$$ \tilde{W}(x) = \frac{a}{2\pi} \int_{-\pi/a}^{\pi/a} dk \, e^{ikx} e^{i\theta(k)} u_k(x) $$

不同的 $\theta(k)$ 会导致截然不同的 $\tilde{W}(x)$。一个简单的例子可以说明这一点 [@problem_id:260394]。考虑两种规范选择：1. 恒定相位规范 $\theta_1(k)=0$；2. 线性相位规范 $\theta_2(k) = \beta k$，其中 $\beta$ 是一个具有长度量纲的实参数。对于第一种情况，我们得到标准的瓦尼尔函数。对于第二种情况，新的[瓦尼尔函数](@entry_id:145994) $\tilde{W}(x)$ 会变为原函数的一个平移 $W(x-\beta)$。这意味着，一个线性的[规范变换](@entry_id:176521)仅仅是把[瓦尼尔函数](@entry_id:145994)的中心从原点移动到了 $x=\beta$。这虽然改变了函数的位置，但没有改变它的形状和局域性。

然而，更复杂的规范选择会改变函数的形状。为了定量地描述[瓦尼尔函数](@entry_id:145994)的局域性，我们引入其**二次展宽**（quadratic spread）或[方差](@entry_id:200758) $\Omega$：

$$ \Omega = \langle W_0 | (\hat{x} - \bar{x})^2 | W_0 \rangle = \langle \hat{x}^2 \rangle - \bar{x}^2 $$

其中 $\bar{x} = \langle W_0 | \hat{x} | W_0 \rangle$ 是[瓦尼尔函数](@entry_id:145994)的中心。可以证明，不同的规范选择 $\theta(k)$ 会导致不同的展宽 $\Omega$。例如，在一个[紧束缚模型](@entry_id:143446)中，如果我们选择一个[非线性](@entry_id:637147)的规范 $\theta(k) = \beta \sin(ka)$ [@problem_id:1279686]，通过计算可以发现，其展宽为 $\Omega = \frac{\beta^2 a^2}{2}$。这表明，展宽直接依赖于规范参数 $\beta$。当 $\beta=0$ 时，展宽为零（在这个特定的[紧束缚](@entry_id:142573)[基矢](@entry_id:199546)中），函数是理想局域的。随着 $\beta$ 增大，[瓦尼尔函数](@entry_id:145994)变得越来越弥散。

这个问题引出了一个核心目标：既然规范选择会影响局域性，我们能否找到一个“最佳”的规范，使得[瓦尼尔函数](@entry_id:145994)的展宽 $\Omega$ 达到最小值？由此产生的[瓦尼尔函数](@entry_id:145994)就被称为**最大局域化[瓦尼尔函数](@entry_id:145994)**（Maximally Localized Wannier Functions, MLWFs）。

### 最大局域化[瓦尼尔函数](@entry_id:145994)：原理

对于由 $J$ 个孤立能带构成的能带复合体，[规范自由度](@entry_id:160491)从 $U(1)$ 相位因子扩展为一个 $J \times J$ 的幺[正矩阵](@entry_id:149490) $U^{(k)}$，它在每个 $k$ 点混合这 $J$ 个[布洛赫态](@entry_id:147552)：

$$ |\tilde{u}_{n,k}\rangle = \sum_{m=1}^{J} |u_{m,k}\rangle U_{mn}^{(k)} $$

总展宽是所有 $J$ 个[瓦尼尔函数](@entry_id:145994)展宽的总和 $\Omega = \sum_{n=1}^J \Omega_n$。Marzari 和 Vanderbilt 的开创性工作表明，这个总展宽可以被分解为两部分：

$$ \Omega = \Omega_I + \tilde{\Omega} $$

其中 $\tilde{\Omega}$ 是依赖于规范选择 $U^{(k)}$ 的部分，而 $\Omega_I$ 是**规范不变**的部分。$\tilde{\Omega}$ 可以通过选择最优的规范 $U^{(k)}$ 来使其最小化（理论上可以使其为零）。而 $\Omega_I$ 则只依赖于布洛赫[本征态](@entry_id:149904)本身的性质，它为这组能带所能达到的最小总展宽设定了一个下限。

这个规范不变的展宽 $\Omega_I$ 具有深刻的物理意义。它量化了能带之间的“混合”程度。其表达式为：

$$ \Omega_I = \frac{1}{(2\pi)^d} \int_{\text{BZ}} d^d\mathbf{k} \sum_{n \neq m} |\mathbf{A}_{mn}^{(0)}(\mathbf{k})|^2 $$

其中 $\mathbf{A}_{mn}^{(0)}(\mathbf{k}) = i \langle u_{m,\mathbf{k}}^{(0)} | \nabla_{\mathbf{k}} u_{n,\mathbf{k}}^{(0)} \rangle$ 是非对角的**[贝里联络](@entry_id:136662)**（Berry connection）[矩阵元](@entry_id:186505)。这表明，一个能带复合体的最小可能展宽，是由其[布洛赫函数](@entry_id:189422)在[动量空间](@entry_id:148936)中的几何性质（即[贝里联络](@entry_id:136662)）决定的。如果不同能带的[布洛赫函数](@entry_id:189422)随 $k$ 变化时“相互缠绕”，那么 $\Omega_I$ 就会较大，这意味着即使经过最优化，瓦尼尔函数仍然会具有一定的内在展宽。

我们可以通过一个简化的两能带 Su-Schrieffer-Heeger (SSH) 模型来具体计算 $\Omega_I$ [@problem_id:1169819]。对于[哈密顿量](@entry_id:172864) $H(k) = w(\cos(ka)\sigma_x + \sin(ka)\sigma_y)$，我们可以求出其两个能带的本征态 $|u_{+,k}\rangle$ 和 $|u_{-,k}\rangle$，然后计算它们之间的[贝里联络](@entry_id:136662) $\mathbf{A}_{+-}^{(0)}(k)$。计算结果显示，对于这个模型，$|\mathbf{A}_{+-}^{(0)}(k)|^2$ 是一个不依赖于 $k$ 的常数 $(a/2)^2$。将其代入积分，我们得到 $\Omega_I = a^2/2$。这个非零的结果说明，即使我们找到了最优规范，这组瓦尼尔函数的总展宽也至少是 $a^2/2$。

### 寻找最优规范的机制

找到了最小化展宽的原理后，下一个问题是：如何具体地找到这些最优的幺正变换矩阵 $U^{(k)}$？目前主要有两种等价的机制。

#### 投影位置[算符对角化](@entry_id:156380)

一种强大的方法是将最小化展宽的问题转化为一个[矩阵对角化](@entry_id:138930)问题。可以证明，最小化规范依赖的展宽 $\tilde{\Omega}$ 等价于对每个 $k$ 点的**投影位置算符矩阵** $X^{(k)}$ 进行[对角化](@entry_id:147016)。该矩阵的元素正是我们之前遇到的[贝里联络](@entry_id:136662)：

$$ X_{mn}^{(k)} = i \langle u_{m,k} | \frac{\partial}{\partial k} u_{n,k} \rangle $$

这个矩阵 $X^{(k)}$ 的[本征值](@entry_id:154894) $\lambda_{n,k}$ 对应于第 $n$ 个[瓦尼尔函数](@entry_id:145994)中心在动量空间中的位置，而其本征矢量则构成了最优规范变换矩阵 $U^{(k)}$ 的列。也就是说，如果我们找到使所有 $k$ 点的 $X^{(k)}$ 矩阵都对角化的幺正变换，那么我们就找到了最大局域化的瓦尼尔函数基。

让我们通过一个具体的例子来理解这个过程 [@problem_id:1279745]。考虑一个二维[哈密顿量](@entry_id:172864) $H(k) = \cos(k) \sigma_z + \sin(k) \sigma_x$。首先，我们求解其本征态 $|u_{1,k}\rangle$ 和 $|u_{2,k}\rangle$。然后，利用这些[本征态](@entry_id:149904)计算 $2 \times 2$ 的[贝里联络](@entry_id:136662)矩阵 $X^{(k)}$。对于这个特定的模型，我们发现 $X^{(k)} = \frac{1}{2}\sigma_y$。这是一个与 $k$ 无关的常数矩阵。接着，我们对 $X^{(k)}$ 进行对角化，找到它的[本征值](@entry_id:154894)（$\pm 1/2$）和对应的本征矢量。这些本征矢量经过适当的相位调整后，就构成了我们所寻求的幺[正矩阵](@entry_id:149490) $U$。这个 $U$ 矩阵就是能将原始布洛赫[基矢](@entry_id:199546)变换为最大局域化[基矢](@entry_id:199546)的最佳规范。

#### 迭代最小化算法

在实际的数值计算中，布里渊区被离散化为一系列 $k$ 点网格。在这种情况下，[微分](@entry_id:158718)算符 $\partial_k$ 被差分算符取代，[贝里联络](@entry_id:136662) $X_{mn}^{(k)}$ 变为描述相邻 $k$ 点[布洛赫函数](@entry_id:189422)交叠的矩阵 $M_{mn}^{(j, j+1)} = \langle u_{m,k_j} | u_{n,k_{j+1}} \rangle$。展宽泛函也相应地被改写。

寻找最优规范 $U^{(k_j)}$ 的过程就变成了一个多变量的数值最小化问题。一个常用的方法是**最陡下降法**（steepest descent method）。从一个初始的规范猜测（例如，所有 $k$ 点的 $U$ 都取[单位矩阵](@entry_id:156724)）开始，我们计算展宽泛函 $\Omega$ 对于规范矩阵 $U^{(k_j)}$ 的微小变化（一个微小的幺正转动）的梯度。然后，我们沿着梯度的反方向更新规范矩阵，从而逐步减小展宽。这个过程不断迭代，直到展宽收敛到其最小值。

这个算法的核心是计算梯度矩阵。我们可以推导出梯度矩阵 $H_p$ 的解析表达式，它依赖于 $k_p$ 点及其近邻点的交叠矩阵 [@problem_id:1279797]。通过计算这个梯度矩阵，我们就可以有效地进行迭代优化，最终得到一组能够产生最大局域化[瓦尼尔函数](@entry_id:145994)的规范矩阵。

### 高等专题：能带纠缠与拓扑

到目前为止，我们都假设我们感兴趣的 $J$ 个能带是“孤立的”，即它们在能量上与所有其他能带（如更高能量的导带）都有一个有限的[带隙](@entry_id:191975)。然而，在许多真实材料中，情况并非如此。我们想要描述的能带（例如[价带](@entry_id:158227)）可能在[布里渊区](@entry_id:142395)的某些区域与其他能带发生交叉或混合，这种现象被称为**能带纠缠**（band entanglement）。

#### 能带纠缠与解纠缠

当能带纠缠发生时，我们无法在整个[布里渊区](@entry_id:142395)内用一组连续的能带指标 $n=1, \dots, J$ 来唯一地标识我们感兴趣的能带。如果强行按能量排序来选择能带，那么在[能带交叉](@entry_id:161733)点，所选的[布洛赫态](@entry_id:147552)[子空间](@entry_id:150286)将不是 $k$ 的光滑函数，这会导致最终得到的瓦尼尔函数局域性很差（通常是[幂律衰减](@entry_id:262227)而非指数衰减）[@problem_id:2972774]。

为了解决这个问题，我们需要一个**解纠缠**（disentanglement）的程序。其核心思想是从一个包含纠缠能带的、更大的 $M$ 维希尔伯特空间中，为每个 $k$ 点“雕刻”出一个光滑变化的 $J$ 维[子空间](@entry_id:150286) $\mathcal{S}_{\mathbf{k}}$。一种标准做法是，首先定义一个能量窗口，包含所有相关的 $M$ 个能带。然后，我们定义一组具有期望物理特性（如特定原子[轨道对称性](@entry_id:142623)）的局域化试探[轨道](@entry_id:137151)。在每个 $k$ 点，我们从 $M$ 维空间中选出与这些试探[轨道](@entry_id:137151)投影交叠最大的 $J$ 个态，从而构成我们想要的[子空间](@entry_id:150286) $\mathcal{S}_{\mathbf{k}}$。通过优化，可以确保这个[子空间](@entry_id:150286)随 $k$ 平滑变化。

这个过程的质量可以通过**[溢出](@entry_id:172355)泛函**（spillage functional）$\Omega_{\text{spill}}$ 来量化 [@problem_id:1279663]。它测量的是真实的低能[布洛赫态](@entry_id:147552)有多少成分“溢出”到了我们所选的 $J$ 维[子空间](@entry_id:150286)之外。例如，在一个三能带模型中，如果我们试图构建一个二维[子空间](@entry_id:150286)来近似描述最低的两个能带，我们可以计算这两个真实低能本征态在目标[子空间](@entry_id:150286)之外的分量。这个[溢出](@entry_id:172355)值越小，说明我们的解纠缠程序越成功。

#### [拓扑阻碍](@entry_id:634492)

然而，即使我们成功地构建了一个光滑的[子空间](@entry_id:150286) $\mathcal{S}_{\mathbf{k}}$，也并不保证我们一定能从中构造出指数局域化的[瓦尼尔函数](@entry_id:145994)。这里存在一个更深层次的限制——**[拓扑阻碍](@entry_id:634492)**（topological obstruction）。一个基本定理指出，一个能带复合体（或一个光滑的[子空间](@entry_id:150286)）能够拥有指数局域化的瓦尼尔函数基的充要条件是，这个能带复合体在拓扑上是“平庸的”。在二维系统中，这通常意味着该[子空间](@entry_id:150286)的陈数（Chern number）必须为零 [@problem_id:2972774]。如果陈数非零，例如在[量子霍尔效应](@entry_id:136283)的拓扑能带中，那么构造一组完备、正交且指数局域的[瓦尼尔函数](@entry_id:145994)是不可能的。

这种[拓扑阻碍](@entry_id:634492)也体现在最大局域化算法的稳定性上。可以证明，展宽泛函 $\Omega$ 在其最小值附近的曲率（即其 Hessian 矩阵）与系统的拓扑性质密切相关。对于一个二维两带系统，Hessian 的最小[本征值](@entry_id:154894) $\lambda_{\text{min}}$ 可以通过一个等效的[磁场](@entry_id:153296)[拉普拉斯算符](@entry_id:146319)来计算 [@problem_id:260281]。这个最小[本征值](@entry_id:154894) $\lambda_{\text{min}}$ 起到了稳定性的作用：$\lambda_{\text{min}} > 0$ 意味着局域化解是稳定的。当系统接近[拓扑相变](@entry_id:137214)时，$\lambda_{\text{min}}$ 会趋近于零。在一个模型计算中可以发现，$\lambda_{\text{min}}$ 正比于一个描述能带几何的参数 $C$ 的平方，而这个参数 $C$ 又与布里渊区内的总贝里曲率通量（即陈数）相关。因此，当系统变得拓扑非平庸时，局域化过程变得不稳定，[瓦尼尔函数](@entry_id:145994)也随之变得弥散，这正是[拓扑阻碍](@entry_id:634492)的具体体现。