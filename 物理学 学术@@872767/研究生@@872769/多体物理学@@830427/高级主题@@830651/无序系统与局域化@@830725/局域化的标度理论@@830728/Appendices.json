{"hands_on_practices": [{"introduction": "本练习将带你从基本物理原理出发，推导标度理论中的一个核心概念——索利斯电导 $g_T$。通过将扩散过程、量子力学中的能量-时间关系以及有限体积中的能级间距联系起来，你将亲手揭示电导对系统尺寸 $L$ 的依赖关系。这个推导清晰地展示了著名的 $g_T \\propto L^{d-2}$ 标度律 [@problem_id:3014241]，这是整个局域化标度理论的基石。", "problem": "考虑一个边长为 $L$ 的 $d$ 维超立方体样品，其中包含无相互作用的电子。这些电子受到弱淬火无序的影响，使其动力学处于扩散区。弹性平均自由程 $\\ell$ 满足 $\\ell \\ll L$，并且在 $L$ 的尺度上，非弹性退相干可以忽略不计。设 $D$ 表示扩散常数，$\\nu$ 表示费米能级处单位体积的单粒子态密度。在局域化的标度理论中，Thouless电导（也称为Thouless数）$g_T$ 定义为与电子扩散穿过样品相关的特征能量标度与有限系统平均单粒子能级间距之比。\n\n仅从以下基本定义出发：(i) 长度标度的扩散穿越与特征时间的关系，(ii) 能量标度与特征时间之间的联系，以及 (iii) 有限体积中态密度与平均能级间距的关系，推导出一个用 $L$、$D$、$\\nu$ 和 $d$ 表示的 $g_T$ 的显式表达式。然后，提取其随 $L$ 的标度关系，并验证在 $d$ 维空间中预期的 $L$ 的幂律行为。将最终答案表示为 $g_T(L,D,\\nu,d)$ 的单个闭式解析表达式，无需进行数值计算。", "solution": "该问题要求基于 Thouless 电导 $g_T$ 的定义和一系列基本物理关系，推导其在 $d$ 维无序系统中的表达式。\n\n首先，我们陈述问题描述中给出的 Thouless 电导 $g_T$ 的定义。它是 Thouless 能量 $E_c$ 与平均单粒子能级间距 $\\Delta E$ 的比值：\n$$\ng_T = \\frac{E_c}{\\Delta E}\n$$\n我们分别推导分子 $E_c$ 和分母 $\\Delta E$ 的表达式。\n\nThouless 能量 $E_c$ 是与电子扩散穿过整个样品相关的特征能量标度。这个过程由一个特征时间，即 Thouless 时间 $\\tau_D$ 所决定。\n(i) 第一个基本原理将长度标度的扩散穿越与特征时间联系起来。对于一个由扩散常数 $D$ 表征的扩散过程，经过时间 $t$ 后的均方位移 $\\langle r^2 \\rangle$ 由 $\\langle r^2 \\rangle \\propto D t$ 形式的关系给出。因此，电子扩散穿过边长为 $L$ 的超立方体样品的特征时间可以通过将特征位移设为 $L$ 来获得。这给出了 Thouless 时间 $\\tau_D$ 为：\n$$\n\\tau_D = \\frac{L^2}{D}\n$$\n这个关系捕捉了扩散时间随系统尺寸的标度行为，并且是研究无序介质中输运的基础。\n\n(ii) 第二个基本原理将此特征时间与一个能量标度联系起来。粒子在样品体积内停留的有限时间 $\\tau_D$ 会导致其能级的展宽。这个能量展宽就是 Thouless 能量 $E_c$。特征时间标度与其相关能量标度之间的关系由量子力学原理给出，类似于能量-时间不确定性原理。精确的关系是：\n$$\nE_c = \\frac{\\hbar}{\\tau_D}\n$$\n其中 $\\hbar$ 是约化普朗克常数。无论从物理上还是从量纲上看，包含 $\\hbar$ 都是必不可少的。将我们得到的 $\\tau_D$ 的表达式代入此方程，我们得到 Thouless 能量：\n$$\nE_c = \\frac{\\hbar D}{L^2}\n$$\n\n接下来，我们推导平均单粒子能级间距 $\\Delta E$ 的表达式。\n(iii) 第三个基本原理将态密度与有限体积中的平均能级间距联系起来。问题中给出 $\\nu$ 作为费米能级处单位体积的单粒子态密度。对于一个有限体积为 $V$ 的样品，总态密度（表示为 $N(E_F)$）是 $\\nu$ 和 $V$ 的乘积。该样品是一个边长为 $L$ 的 $d$ 维超立方体，所以其体积为：\n$$\nV = L^d\n$$\n因此，费米能级处的总态密度为：\n$$\nN(E_F) = \\nu V = \\nu L^d\n$$\n这个量的单位是“态数/单位能量”。相邻能级之间的平均间距 $\\Delta E$ 是总态密度的倒数：\n$$\n\\Delta E = \\frac{1}{N(E_F)} = \\frac{1}{\\nu L^d}\n$$\n\n有了 $E_c$ 和 $\\Delta E$ 的表达式，我们现在可以组合出 Thouless 电导 $g_T$ 的表达式：\n$$\ng_T = \\frac{E_c}{\\Delta E} = \\frac{\\frac{\\hbar D}{L^2}}{\\frac{1}{\\nu L^d}}\n$$\n通过简化这个分数，我们得到 $g_T$ 的最终表达式：\n$$\ng_T = \\hbar D \\nu L^{d-2}\n$$\n\n问题还要求验证幂律标度行为。我们推导出的表达式表明，对于固定的材料参数（$D$、$\\nu$）和维度（$d$），Thouless 电导随系统尺寸 $L$ 的标度关系为：\n$$\ng_T \\propto L^{d-2}\n$$\n这种幂律依赖性是局域化标度理论的一个核心结果。它意味着材料的电导率以一种由其维度决定的方式依赖于其尺寸。对于维度 $d>2$，$g_T$ 随 $L$ 增加，表现出金属性行为。对于维度 $d2$，$g_T$ 随 $L$ 减小，表现出绝缘性行为，此时波函数是局域的。$d=2$ 的情况是一个临界情况，这种简单的标度关系表明 $g_T$ 是常数，尽管更高级的理论预测存在一个缓慢的对数下降，导致弱局域化。推导出的结果成功地捕捉了基本的幂律行为。", "answer": "$$\\boxed{\\hbar D \\nu L^{d-2}}$$", "id": "3014241"}, {"introduction": "在掌握了基本的标度关系之后，下一个挑战是将这些抽象的理论应用于具体的数值模拟中。本练习模拟了研究安德森相变的真实过程，要求你运用有限尺寸标度假设来分析数值数据 [@problem_id:3014276]。通过分析不同系统尺寸下归一化局域化长度曲线的交点和斜率，你将能够提取出局域化长度的临界指数 $\\nu$，这架起了理论与计算物理之间的一座重要桥梁。", "problem": "考虑一个三维空间中的无序紧束缚模型，其具有准一维几何构型，横向宽度为 $M$，纵向长度为 $L \\gg M$。设在位无序强度为 $W$，在临界无序 $W_c$ 处发生连续的金属-绝缘体相变。准一维局域化长度 $\\lambda_M(W)$ 由宽度为 $M$ 的条带的传输矩阵的最大李雅普诺夫指数定义。定义无量纲归一化局域化长度 $\\Lambda_M(W) = \\lambda_M(W)/M$。\n\n从局域化标度理论（Abrahams-Anderson-Licciardello-Ramakrishnan (AALR)）的单参数标度假设出发，并利用相变点存在一个发散的关联长度 $\\xi(W)$ 且遵循 $\\xi(W) \\sim |W - W_c|^{-\\nu}$ 这一事实，仅使用由 $M$ 和 $\\xi(W)$ 构造的无量纲组合，推导 $\\Lambda_M(W)$ 在临界点附近的有限尺寸标度形式。证明为何在 $W = W_c$ 时，不同 $M$ 的 $\\Lambda_M(W)$ 曲线会相交于一个共同的值，并确定交点处的斜率 $\\partial \\Lambda_M/\\partial W$ 如何随 $M$ 标度。\n\n在一个与可忽略的标度修正相符的数值实验中，宽度为 $M_1 = 16$ 和 $M_2 = 64$ 的 $\\Lambda_M(W)$ 曲线的交点出现在相同的 $W$ 值处（将此交点记为 $W^{\\times}$），并且在交点处测得的 $\\Lambda_M(W)$ 对 $W$ 的导数分别为 $s_{16} = \\partial \\Lambda_{16}/\\partial W \\big|_{W^{\\times}} = 0.200$ 和 $s_{64} = \\partial \\Lambda_{64}/\\partial W \\big|_{W^{\\times}} = 0.400$。在上述单参数标度假设下，计算关联长度临界指数 $\\nu$。请给出精确的最终答案，无需四舍五入。答案无需物理单位。", "solution": "基于凝聚态物理中已确立的局域化标度理论原理，该问题被验证为具有科学依据、良定且客观。它展示了从有限尺寸标度数据中提取临界指数的标准流程。所有必需信息均已提供，且问题内部逻辑一致。因此，我们可以开始求解。\n\n该问题要求我们首先推导金属-绝缘体相变附近的无量纲归一化局域化长度 $\\Lambda_M(W) = \\lambda_M(W)/M$ 的有限尺寸标度形式，然后利用此形式根据所提供的数值数据计算关联长度临界指数 $\\nu$。\n\n该理论的基石是单参数标度假设。该假设认为，对于一个特征尺寸为 $M$ 的系统，其在临界点附近的输运性质并非由微观细节（如无序强度 $W$ 和系统尺寸 $M$）独立决定，而是由一个单一的无量纲参数决定。在临界点 $W_c$ 附近，唯一发散的相关长度标度是关联长度 $\\xi(W)$。标度假设进而指出，任何无量纲物理量都必须是系统尺寸 $M$ 与此关联长度 $\\xi(W)$ 之比的普适函数。\n\n无量纲归一化局域化长度 $\\Lambda_M(W)$ 正是这样一个量。因此，其标度形式由下式给出：\n$$\n\\Lambda_M(W) = F\\left(\\frac{M}{\\xi(W)}\\right)\n$$\n其中 $F(x)$ 是一个普适标度函数，与微观细节无关。\n\n接下来，我们证明为何不同系统宽度 $M$ 的 $\\Lambda_M(W)$ 曲线会相交于一个共同的值。在临界无序强度 $W = W_c$ 处，关联长度发散，即 $\\xi(W_c) \\to \\infty$。因此，无论系统尺寸 $M$ 为何，标度函数 $F$ 的自变量都趋于零：\n$$\n\\lim_{W \\to W_c} \\frac{M}{\\xi(W)} = 0\n$$\n因此，在临界点，归一化局域化长度取一个与 $M$ 无关的值：\n$$\n\\Lambda_M(W_c) = F(0)\n$$\n$F(0)$ 是一个普适常数。这意味着，如果我们将 $\\Lambda_M(W)$ 作为 $W$ 的函数为不同 $M$ 值作图，所有曲线必定相交于唯一点 $(W_c, \\Lambda_c)$，其中 $\\Lambda_c = F(0)$。在数值模拟中，交点 $W^{\\times}$ 为临界无序 $W_c$ 提供了一个精确的估计。\n\n现在，我们来确定交点处的斜率 $s_M = \\partial \\Lambda_M / \\partial W$ 如何随 $M$ 标度。问题中指出关联长度的发散行为为 $\\xi(W) \\sim |W - W_c|^{-\\nu}$。我们可以将其写为 $\\xi(W) = \\xi_0 |W - W_c|^{-\\nu}$，其中 $\\xi_0$ 是某个非普适常数。\n\n为了找到斜率的标度关系，重写标度函数的自变量会很方便。我们定义一个新变量 $y = (W - W_c)M^{1/\\nu}$。如果我们为无序参数 $W$ 假设了合适的单位，这个变量就是无量纲的。原始标度函数 $F$ 的自变量可以用 $y$ 来表示：\n$$\n\\frac{M}{\\xi(W)} = \\frac{M}{\\xi_0 |W - W_c|^{-\\nu}} = \\frac{M}{\\xi_0} |W - W_c|^{\\nu} = \\frac{1}{\\xi_0} \\left( |W - W_c| M^{1/\\nu} \\right)^{\\nu} = \\frac{1}{\\xi_0} |y|^{\\nu}\n$$\n由于 $\\Lambda_M(W)$ 是 $M/\\xi$ 的普适函数，它也必然是 $y$ 的普适函数。我们可以定义一个新的普适标度函数 $\\mathcal{G}$，使得：\n$$\n\\Lambda_M(W) = \\mathcal{G}(y) = \\mathcal{G}\\left( (W - W_c)M^{1/\\nu} \\right)\n$$\n在临界点附近，即 $W \\approx W_c$ 时，自变量 $y$ 很小，我们可以用 $\\mathcal{G}(y)$ 在 $y=0$ 附近的一阶泰勒展开来近似它：\n$$\n\\mathcal{G}(y) \\approx \\mathcal{G}(0) + \\mathcal{G}'(0) y\n$$\n将此代回，我们得到 $\\Lambda_M(W)$ 的线性化标度形式：\n$$\n\\Lambda_M(W) \\approx \\mathcal{G}(0) + \\mathcal{G}'(0)(W - W_c)M^{1/\\nu}\n$$\n现在我们可以通过对 $W$ 求导并在临界点 $W_c$ 处取值来计算斜率 $s_M$：\n$$\ns_M = \\left. \\frac{\\partial \\Lambda_M}{\\partial W} \\right|_{W=W_c} = \\frac{\\partial}{\\partial W} \\left[ \\mathcal{G}(0) + \\mathcal{G}'(0)(W - W_c)M^{1/\\nu} \\right]_{W=W_c} = \\mathcal{G}'(0)M^{1/\\nu}\n$$\n这个推导表明，$\\Lambda_M(W)$ 在临界点处的斜率随系统尺寸 $M$ 的标度关系为：\n$$\ns_M \\propto M^{1/\\nu}\n$$\n题目为两个系统尺寸 $M_1 = 16$ 和 $M_2 = 64$ 及其在交点 $W^{\\times}$ 处的对应斜率 $s_{16} = 0.200$ 和 $s_{64} = 0.400$ 提供了数值数据。我们可以使用这些数据来求出 $\\nu$。\n设 $s_M = C \\cdot M^{1/\\nu}$，其中 $C = \\mathcal{G}'(0)$ 是一个常数。我们可以为我们的两个数据点写出这个关系：\n$$\ns_{16} = C \\cdot (16)^{1/\\nu}\n$$\n$$\ns_{64} = C \\cdot (64)^{1/\\nu}\n$$\n为消去未知常数 $C$，我们将这两个方程相除：\n$$\n\\frac{s_{64}}{s_{16}} = \\frac{C \\cdot (64)^{1/\\nu}}{C \\cdot (16)^{1/\\nu}} = \\left(\\frac{64}{16}\\right)^{1/\\nu}\n$$\n代入给定的数值：\n$$\n\\frac{0.400}{0.200} = \\left(\\frac{64}{16}\\right)^{1/\\nu}\n$$\n$$\n2 = 4^{1/\\nu}\n$$\n为了求解 $\\nu$，我们可以将方程两边表示为相同的底数，即 2：\n$$\n2^1 = (2^2)^{1/\\nu}\n$$\n$$\n2^1 = 2^{2/\\nu}\n$$\n令指数相等可得：\n$$\n1 = \\frac{2}{\\nu}\n$$\n解出 $\\nu$，我们得到：\n$$\n\\nu = 2\n$$", "answer": "$$\\boxed{2}$$", "id": "3014276"}, {"introduction": "作为本章的最终实践，我们将从模拟相变研究转向模拟真实的实验数据分析。本练习要求你编写程序，分析合成的磁电导数据，这与实验物理学家在实验室中研究弱局域化效应的过程非常相似 [@problem_id:3014285]。通过将实验数据与理论模型进行拟合，你将能够提取出关键的物理量，如相位相干长度 $L_{\\phi}(T)$ 及其与温度的依赖关系，从而将标度理论的威力应用于解释和预测实验现象。", "problem": "考虑一个二维无序导体，其电导率表现出弱局域化修正，处于量子干涉被有限的退相干长度 $L_{\\phi}(T)$ 和垂直磁场 $B$ 截止的区域。局域化的标度理论通过一个 beta 函数描述了无量纲电导 $g$ 的重整化，在二维情况下，对电导率的主要量子修正是相位相干长度的对数函数。垂直磁场通过引入一个与 $L_{\\phi}(T)$ 竞争的磁退相干尺度来抑制量子修正。一个从 Hikami-Larkin-Nagaoka (HLN) 理论推导出的、经过充分检验的磁导表达式，适用于自旋轨道散射可忽略不计的二维弱局域化区域，其形式如下：\n$$\n\\Delta \\sigma(B;B_{\\phi},\\alpha) = -\\frac{\\alpha e^{2}}{2\\pi^{2}\\hbar} \\left[ \\psi\\!\\left(\\tfrac{1}{2}+\\frac{B_{\\phi}}{B}\\right) - \\ln\\!\\left(\\frac{B_{\\phi}}{B}\\right) \\right],\n$$\n其中 $e$ 是元电荷，$\\hbar$ 是约化普朗克常数，$\\psi$ 是双伽玛函数，$\\alpha$ 是一个量级为 1 的无量纲前置因子，表示相干通道的数量，$B_{\\phi}$ 是特征退相干场，它通过以下公式与相位相干长度相关：\n$$\nB_{\\phi}(T) = \\frac{\\hbar}{4 e L_{\\phi}(T)^{2}}.\n$$\n退相干长度 $L_{\\phi}(T)$ 通常用温度 $T$ 的幂律来参数化，该幂律由微观散射机制通过退相干时间 $\\tau_{\\phi}(T)\\propto T^{-p_{\\mathrm{true}}}$ 决定，因此 $L_{\\phi}(T) = \\sqrt{D \\tau_{\\phi}(T)} \\propto T^{-p_{\\mathrm{true}}/2}$，其中 $D$ 是扩散常数，在所考虑的温度范围内假定其近似不随温度变化。由选定机制（例如，二维中的电子-电子奈奎斯特散射或电子-声子散射）得出的退相干指数的理论预测值记为 $p_{\\mathrm{th}}$。\n\n您的任务是实现对合成磁导数据 $\\Delta \\sigma(B,T)$ 的标度分析，以提取 $L_{\\phi}(T)$，并针对几组参数集检验提取出的退相干指数与 $p_{\\mathrm{th}}$ 的一致性。该分析必须基于以下基本且经过充分检验的事实：\n- 二维电导的量子修正是由 $L_{\\phi}(T)$ 和 $B$ 截止的，这导致了上述的 HLN 磁导表达式。\n- 特征场 $B_{\\phi}(T)$ 和相位相干长度 $L_{\\phi}(T)$ 通过 $B_{\\phi}(T)=\\hbar/(4 e L_{\\phi}(T)^{2})$ 相关联。\n- 在适当条件下（$\\alpha$ 恒定且自旋轨道散射可忽略），当将不同温度下的磁导曲线绘制为 $\\Delta \\sigma$ 相对于标度变量 $x=B/B_{\\phi}(T)$ 的函数时，这些曲线会坍缩到一条通用函数上。\n\n程序必须对每个参数集执行以下步骤：\n1. 使用 HLN 公式在多个温度 $\\{T_{i}\\}$ 下生成合成磁导数据，其中包含已知的真实退相干指数 $p_{\\mathrm{true}}$ 和固定的前置因子 $\\alpha_{\\mathrm{true}}$。相位相干长度为 $L_{\\phi}(T_{i}) = L_{0} \\left( \\frac{T_{i}}{T_{0}} \\right)^{-p_{\\mathrm{true}}/2}$，其中 $L_{0}$ 和 $T_{0}$ 为每个测试用例指定。将 $L_{\\phi}(T_{i})$ 转换为 $B_{\\phi}(T_{i})$ 并为磁场网格 $\\{B_{j}\\}$ 计算 $\\Delta \\sigma(B,T_{i})$，然后添加指定噪声幅度的零均值高斯噪声。所有物理量必须使用国际单位制（SI）计算：$B$ 的单位为特斯拉（T），$L_{\\phi}$ 的单位为米（m），$\\Delta \\sigma$ 的单位为西门子（S）。\n2. 通过将 HLN 函数拟合到合成的 $\\Delta \\sigma(B,T_{i})$ 数据，来估算每个温度下的 $B_{\\phi}(T_{i})$，要求 $B_{\\phi}(T_{i})0$ 且 $\\alpha$ 在物理合理的范围内变化。使用 $L_{\\phi}(T_{i})=\\sqrt{\\hbar/(4 e B_{\\phi}(T_{i}))}$ 将拟合得到的 $B_{\\phi}(T_{i})$ 转换为 $L_{\\phi}(T_{i})$。\n3. 对 $L_{\\phi}(T_{i})$ 与 $T_{i}$ 进行对数-对数线性回归以提取斜率 $s$，并计算估算的退相干指数 $p_{\\mathrm{est}}=-2 s$。\n4. 通过在下文指定的容差 $\\tau$ 下比较 $p_{\\mathrm{est}}$ 与 $p_{\\mathrm{th}}$ 来检验一致性，并输出一个布尔值，指示该参数集是否满足 $\\left| p_{\\mathrm{est}} - p_{\\mathrm{th}} \\right| \\le \\tau$。\n\n除估算过程外，还需实现一个标度坍缩检查。通过构造标度变量 $x_{j,i}=B_{j}/B_{\\phi}(T_{i})$ 并将每条曲线重新缩放为 $\\Delta \\sigma$ 对 $x$ 的函数，然后在插值到共享的 $x$ 网格后，计算定义为在共同 $x$ 值上跨温度的均方偏差的坍缩质量度量。虽然此度量不是最终输出的一部分，但必须在内部计算它以验证标度过程的逻辑。\n\n所有计算使用以下常量：$e=1.602176634\\times 10^{-19}\\,\\mathrm{C}$ 和 $\\hbar=1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$。使用一个磁场网格 $\\{B_{j}\\}$，包含 $N_{B}=300$ 个从 $B_{\\min}=10^{-4}\\,\\mathrm{T}$到 $B_{\\max}=2\\times 10^{-1}\\,\\mathrm{T}$ 线性间隔的点。前置因子 $\\alpha_{\\mathrm{true}}$ 在每个测试用例中是固定的，并适用于该用例中的所有温度。\n\n测试套件参数集：\n- 情况 A（通用，宽温度范围，低噪声）：$\\{T_{i}\\}=\\{0.5,1.0,2.0,4.0,8.0\\}\\,\\mathrm{K}$，$p_{\\mathrm{true}}=1.0$，$p_{\\mathrm{th}}=1.0$，$\\alpha_{\\mathrm{true}}=1.0$，$L_{0}=150\\times 10^{-9}\\,\\mathrm{m}$，$T_{0}=1.0\\,\\mathrm{K}$，噪声幅度分数 $\\nu=0.02$，相对于 HLN 前置因子标度 $\\alpha e^{2}/(2\\pi^{2}\\hbar)$。\n- 情况 B（类电子-声子，中等噪声）：$\\{T_{i}\\}=\\{1.0,2.0,5.0,10.0\\}\\,\\mathrm{K}$，$p_{\\mathrm{true}}=2.0$，$p_{\\mathrm{th}}=2.0$，$\\alpha_{\\mathrm{true}}=1.0$，$L_{0}=120\\times 10^{-9}\\,\\mathrm{m}$，$T_{0}=1.0\\,\\mathrm{K}$，噪声幅度分数 $\\nu=0.03$。\n- 情况 C（理论不匹配的边缘情况，中等噪声）：$\\{T_{i}\\}=\\{0.8,1.0,1.5,2.0\\}\\,\\mathrm{K}$，$p_{\\mathrm{true}}=0.6$，$p_{\\mathrm{th}}=1.0$，$\\alpha_{\\mathrm{true}}=1.0$，$L_{0}=180\\times 10^{-9}\\,\\mathrm{m}$，$T_{0}=1.0\\,\\mathrm{K}$，噪声幅度分数 $\\nu=0.04$。\n\n对于所有情况，使用容差 $\\tau=0.2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序对应于情况 A、B 和 C：$[\\mathrm{bool}_{A},\\mathrm{bool}_{B},\\mathrm{bool}_{C}]$，其中每个条目是一个布尔值，指示该情况的一致性测试 $\\left| p_{\\mathrm{est}} - p_{\\mathrm{th}} \\right| \\le \\tau$ 是否通过。此问题不涉及角度。不得使用百分比；任何分数量都应作为小数处理。", "solution": "所给的问题是计算凝聚态物理学中一个有效且定义明确的任务。它要求为弱局域化磁导数据实现一个标准的数据分析流程。解决方案将按照问题陈述中概述的步骤顺序构建。\n\n此分析的物理基础是局域化的标度理论，该理论预测在二维中，电导率的量子干涉修正对一个特征长度尺度呈对数依赖关系。这个长度尺度是相位相干长度 $L_{\\phi}(T)$ 和磁长度 $L_{B} = \\sqrt{\\hbar/(eB)}$ 中较小的一个。这些尺度之间的相互作用产生了一个特征性的负磁导。在弱局域化区域，对于一个自旋轨道散射可忽略的系统，这种行为由 Hikami-Larkin-Nagaoka (HLN) 公式定量描述电导率的变化 $\\Delta \\sigma$：\n$$\n\\Delta \\sigma(B;B_{\\phi},\\alpha) = -\\frac{\\alpha e^{2}}{2\\pi^{2}\\hbar} \\left[ \\psi\\!\\left(\\tfrac{1}{2}+\\frac{B_{\\phi}}{B}\\right) - \\ln\\!\\left(\\frac{B_{\\phi}}{B}\\right) \\right]\n$$\n这里，$\\alpha$ 是一个量级为 1 的前置因子，与相干输运通道的数量有关，$\\psi$ 是双伽玛函数。参数 $B_{\\phi}$ 是特征退相干场，它与相位相干长度 $L_{\\phi}(T)$ 的平方成反比：\n$$\nB_{\\phi}(T) = \\frac{\\hbar}{4 e L_{\\phi}(T)^{2}}\n$$\n$L_{\\phi}(T)$ 的温度依赖性通常由一个幂律 $L_{\\phi}(T) \\propto T^{-p/2}$ 决定，其中指数 $p$ 取决于主导的退相干机制。\n\n分析的核心是测试实验确定的指数 $p_{\\mathrm{est}}$ 是否与理论预测的指数 $p_{\\mathrm{th}}$ 一致。过程如下：\n\n**1. 合成数据生成**\n\n对于每个参数集，我们生成合成的磁导数据。这包括针对指定集合中每个温度 $T_i$ 的几个子步骤：\n- 首先，使用给定的幂律关系计算“真实”的相位相干长度 $L_{\\phi, \\mathrm{true}}(T_i)$：\n  $$\n  L_{\\phi, \\mathrm{true}}(T_{i}) = L_{0} \\left( \\frac{T_{i}}{T_{0}} \\right)^{-p_{\\mathrm{true}}/2}\n  $$\n- 然后将此长度转换为“真实”的退相干场 $B_{\\phi, \\mathrm{true}}(T_i)$：\n  $$\n  B_{\\phi, \\mathrm{true}}(T_{i}) = \\frac{\\hbar}{4 e L_{\\phi, \\mathrm{true}}(T_{i})^{2}}\n  $$\n- 使用已知的参数 $\\alpha_{\\mathrm{true}}$ 和 $B_{\\phi, \\mathrm{true}}(T_i)$，在预定义的磁场网格 $\\{B_j\\}$ 上，通过 HLN 公式计算理想化的磁导曲线 $\\Delta\\sigma_{\\mathrm{clean}}(B, T_i)$。\n- 最后，为了模拟实验条件，添加了零均值高斯噪声。噪声的标准差被设置为特征电导标度 $\\sigma_{\\mathrm{scale}} = \\alpha_{\\mathrm{true}} e^2 / (2 \\pi^2 \\hbar)$ 的一个分数 $\\nu$。带噪数据则为 $\\Delta\\sigma_{\\mathrm{noisy}}(B_j, T_i) = \\Delta\\sigma_{\\mathrm{clean}}(B_j, T_i) + \\mathcal{N}(0, (\\nu \\sigma_{\\mathrm{scale}})^2)$。\n\n**2. 通过拟合进行参数估计**\n\n对于每个温度 $T_i$，我们将合成数据 $\\Delta\\sigma_{\\mathrm{noisy}}(B_j, T_i)$ 视作实验数据。我们将 HLN 公式拟合到此数据以提取最佳拟合参数 $\\alpha_{\\mathrm{est}}$ 和 $B_{\\phi, \\mathrm{est}}(T_i)$。这是一个非线性最小二乘拟合问题，我们使用 `scipy.optimize.curve_fit` 来解决。拟合被约束为 $B_{\\phi, \\mathrm{est}}  0$。从拟合值 $B_{\\phi, \\mathrm{est}}(T_i)$，我们计算估算的相位相干长度 $L_{\\phi, \\mathrm{est}}(T_i)$：\n$$\nL_{\\phi, \\mathrm{est}}(T_i) = \\sqrt{\\frac{\\hbar}{4 e B_{\\phi, \\mathrm{est}}(T_i)}}\n$$\n\n**3. 标度坍缩验证**\n\n作为一个内部验证步骤，我们验证标度假设。HLN 理论意味着 $\\Delta \\sigma$ 是标度变量 $x = B/B_{\\phi}$ 的一个通用函数。因此，如果我们将我们的带噪数据 $\\Delta\\sigma_{\\mathrm{noisy}}(B, T_i)$ 绘制为标度变量 $x = B/B_{\\phi, \\mathrm{est}}(T_i)$ 的函数，来自所有不同温度的曲线应该坍缩到一条主曲线上。为了量化这一点，我们将所有曲线插值到一个公共的 $x$ 网格上，并计算曲线之间的均方偏差。一个小的偏差证实了拟合过程的有效性。\n\n**4. 退相干指数提取**\n\n估算出的数据对集合 $(T_i, L_{\\phi, \\mathrm{est}}(T_i))$ 被用来确定退相干指数。理论模型是 $L_{\\phi} = C T^{-p/2}$，其中 $C$ 是一个常数。对两边取自然对数可以使方程线性化：\n$$\n\\ln(L_{\\phi}) = \\ln(C) - \\frac{p}{2} \\ln(T)\n$$\n这显示了 $\\ln(L_{\\phi})$ 和 $\\ln(T)$ 之间存在线性关系，斜率为 $s = -p/2$。我们对 $(\\ln(T_i), \\ln(L_{\\phi, \\mathrm{est}}(T_i)))$ 数据点进行线性回归以求得斜率 $s$。然后估算的指数计算如下：\n$$\np_{\\mathrm{est}} = -2s\n$$\n\n**5. 一致性检验**\n\n最后一步是比较估算出的指数 $p_{\\mathrm{est}}$ 与给定情况的理论预测指数 $p_{\\mathrm{th}}$。如果绝对差在指定的容差 $\\tau$ 范围内，则一致性检验通过：\n$$\n|p_{\\mathrm{est}} - p_{\\mathrm{th}}| \\leq \\tau\n$$\n为每个参数集计算此测试的布尔结果。\n\n整个过程被封装在一个 Python 脚本中，该脚本处理每种情况并以所需格式输出最终的布尔结果。所有物理常数和参数都以国际单位制（SI）处理。", "answer": "```python\nimport numpy as np\nfrom scipy.special import psi\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the weak localization scaling analysis problem for three test cases.\n    \"\"\"\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    HBAR = 1.054571817e-34      # Reduced Planck constant in J*s\n\n    # Define the HLN function for magnetoconductivity\n    def hln_conductivity(B, alpha, B_phi):\n        \"\"\"\n        Calculates the HLN magnetoconductivity correction.\n        Args:\n            B (np.ndarray): Magnetic field in Tesla.\n            alpha (float): Prefactor.\n            B_phi (float): Dephasing field in Tesla.\n        Returns:\n            np.ndarray: Change in conductivity in Siemens.\n        \"\"\"\n        # The HLN function has a singularity at B=0 and B_phi=0.\n        # The B grid starts from a small positive value, avoiding B=0.\n        # The fit is bounded to have B_phi  0.\n        # A small epsilon is added to B_phi/B to avoid log(0) if B_phi is near zero and B is large.\n        x = B_phi / B\n        epsilon = 1e-12\n        term = psi(0.5 + x) - np.log(x + epsilon)\n        prefactor = alpha * E_CHARGE**2 / (2 * np.pi**2 * HBAR)\n        return -prefactor * term\n\n    # Problem parameters\n    B_grid = np.linspace(1e-4, 2e-1, 300)  # Magnetic field grid (T)\n    tau = 0.2  # Tolerance for consistency check\n\n    test_cases = [\n        # Case A\n        {'Ts': [0.5, 1.0, 2.0, 4.0, 8.0], 'p_true': 1.0, 'p_th': 1.0, 'alpha_true': 1.0, 'L0': 150e-9, 'T0': 1.0, 'nu': 0.02},\n        # Case B\n        {'Ts': [1.0, 2.0, 5.0, 10.0], 'p_true': 2.0, 'p_th': 2.0, 'alpha_true': 1.0, 'L0': 120e-9, 'T0': 1.0, 'nu': 0.03},\n        # Case C\n        {'Ts': [0.8, 1.0, 1.5, 2.0], 'p_true': 0.6, 'p_th': 1.0, 'alpha_true': 1.0, 'L0': 180e-9, 'T0': 1.0, 'nu': 0.04},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Ts = np.array(case['Ts'])\n        p_true = case['p_true']\n        p_th = case['p_th']\n        alpha_true = case['alpha_true']\n        L0 = case['L0']\n        T0 = case['T0']\n        nu = case['nu']\n\n        fitted_b_phis = []\n        successful_Ts = []\n        all_noisy_data = []\n\n        # 1. Generate data and 2. Fit for each temperature\n        for T_i in Ts:\n            # Generate \"true\" parameters\n            L_phi_true = L0 * (T_i / T0)**(-p_true / 2.0)\n            B_phi_true = HBAR / (4 * E_CHARGE * L_phi_true**2)\n\n            # Generate clean data\n            delta_sigma_clean = hln_conductivity(B_grid, alpha_true, B_phi_true)\n\n            # Add noise\n            conductance_scale = alpha_true * E_CHARGE**2 / (2 * np.pi**2 * HBAR)\n            noise_std = nu * conductance_scale\n            noise = np.random.normal(loc=0.0, scale=noise_std, size=B_grid.shape)\n            delta_sigma_noisy = delta_sigma_clean + noise\n            all_noisy_data.append(delta_sigma_noisy)\n\n            # Fit the HLN function to noisy data\n            try:\n                # Initial guess and bounds for [alpha, B_phi]\n                p0 = [1.0, 0.01]\n                bounds = ([0, 1e-9], [5, np.inf]) # B_phi must be  0.\n                \n                popt, _ = curve_fit(hln_conductivity, B_grid, delta_sigma_noisy, p0=p0, bounds=bounds)\n                _, B_phi_fit = popt\n                \n                fitted_b_phis.append(B_phi_fit)\n                successful_Ts.append(T_i)\n            except RuntimeError:\n                # Fit failed for this temperature, point is skipped.\n                pass\n\n        # Internal scaling collapse check\n        if len(successful_Ts) > 1:\n            x_shared = np.logspace(-1, 3, 100)\n            interpolated_curves = []\n            for i, T_val in enumerate(successful_Ts):\n                noisy_curve_idx = np.where(Ts == T_val)[0][0]\n                noisy_curve = all_noisy_data[noisy_curve_idx]\n                x_native = B_grid / fitted_b_phis[i]\n                \n                # Sort before interpolation\n                sort_indices = np.argsort(x_native)\n                x_sorted = x_native[sort_indices]\n                sigma_sorted = noisy_curve[sort_indices]\n\n                interp_curve = np.interp(x_shared, x_sorted, sigma_sorted)\n                interpolated_curves.append(interp_curve)\n            \n            all_curves_matrix = np.vstack(interpolated_curves)\n            mean_std_dev = np.mean(np.std(all_curves_matrix, axis=0))\n            # 'mean_std_dev' is the collapse quality metric, computed but not used in final output.\n\n        # 3. Extract dephasing exponent\n        if len(successful_Ts)  2:\n            results.append(False)  # Not enough points for regression\n            continue\n\n        fitted_L_phis = np.sqrt(HBAR / (4 * E_CHARGE * np.array(fitted_b_phis)))\n        \n        log_T = np.log(successful_Ts)\n        log_L_phi = np.log(fitted_L_phis)\n        \n        slope, _, _, _, _ = linregress(log_T, log_L_phi)\n        \n        p_est = -2.0 * slope\n\n        # 4. Test consistency\n        is_consistent = np.abs(p_est - p_th) = tau\n        results.append(is_consistent)\n\n    # Final output as a list of booleans\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n\nsolve()\n```", "id": "3014285"}]}