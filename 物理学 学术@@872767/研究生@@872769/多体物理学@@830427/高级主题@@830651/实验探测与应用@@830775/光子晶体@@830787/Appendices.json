{"hands_on_practices": [{"introduction": "平面波展开法 (Plane Wave Expansion, PWE) 是计算光子晶体能带结构的核心数值方法。该方法的第一步是将周期性介电函数展开为傅里叶级数。本练习旨在计算介电常数倒数的傅里叶系数，这是任何PWE计算的关键输入，它将结构的几何信息转化为能带计算所需的数学形式。[@problem_id:1179064]", "problem": "一个二维光子晶体由蚀刻在电介质平板中的圆形空气孔构成的方形晶格组成。该晶格由原胞晶格矢量 $\\mathbf{a}_1 = a(1, 0)$ 和 $\\mathbf{a}_2 = a(0, 1)$ 定义，其中 $a$ 是晶格常数。圆形孔的半径为 $R$，介电常数为 $\\epsilon_a$，而周围背景材料的介电常数为 $\\epsilon_b$。对于本问题，假设其中一个孔的中心位于坐标系的原点。\n\n介电常数的空间分布由 $\\epsilon(\\mathbf{r})$ 给出，逆介电函数为 $\\kappa(\\mathbf{r}) = 1/\\epsilon(\\mathbf{r})$。在用平面波展开法求解此类周期性结构中的麦克斯韦方程组时，需要计算逆介电函数的傅里叶级数系数 $\\kappa(\\mathbf{G})$，其中 $\\mathbf{G}$ 是一个倒易晶格矢量。\n\n傅里叶系数由以下公式给出：\n$$ \\kappa(\\mathbf{G}) = \\frac{1}{A_{cell}} \\int_{\\text{cell}} \\kappa(\\mathbf{r}) e^{-i\\mathbf{G}\\cdot\\mathbf{r}} d^2r $$\n其中 $A_{cell}$ 是原胞的面积。\n\n计算一个一般的非零倒易晶格矢量 $\\mathbf{G}$ 的傅里叶系数 $\\kappa(\\mathbf{G})$。你的最终表达式应以参数 $a, R, \\epsilon_a, \\epsilon_b$ 和倒易晶格矢量的模 $G = |\\mathbf{G}|$ 来表示。\n\n你可能会发现以下贝塞尔函数的积分表示和性质很有用：\n1.  $J_n(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{i(x\\sin\\theta - n\\theta)} d\\theta$。对于 $n=0$ 且将 $\\theta$ 替换为 $\\theta-\\pi/2$，这给出 $J_0(x) = \\frac{1}{2\\pi} \\int_0^{2\\pi} e^{-ix\\cos\\theta} d\\theta$。\n2.  $\\frac{d}{dx} [x J_1(x)] = x J_0(x)$。", "solution": "1. 对于非零的 $\\mathbf G$，傅里叶系数为\n$$\n\\kappa(\\mathbf G)=\\frac1{A_{\\rm cell}}\\int_{\\rm cell}\\kappa(\\mathbf r)e^{-i\\mathbf G\\cdot\\mathbf r}d^2r\n=\\frac1{a^2}\\Bigl(\\frac1{\\epsilon_a}-\\frac1{\\epsilon_b}\\Bigr)\\int_{|r|\\le R}e^{-i\\mathbf G\\cdot\\mathbf r}d^2r.\n$$\n2. 在极坐标 $\\mathbf r=(r,\\theta)$ 中，且 $|\\mathbf G|=G$，我们有\n$$\n\\int_{|r|\\le R}e^{-i\\mathbf G\\cdot\\mathbf r}d^2r\n=\\int_0^R r\\,dr\\int_0^{2\\pi}e^{-iGr\\cos\\theta}d\\theta\n=2\\pi\\int_0^R rJ_0(Gr)\\,dr.\n$$\n3. 使用 $\\frac d{dx}[xJ_1(x)]=xJ_0(x)$ 得到\n$$\n\\int_0^R rJ_0(Gr)\\,dr\n=\\frac1{G^2}\\int_0^{GR}xJ_0(x)\\,dx\n=\\frac1{G^2}\\bigl[xJ_1(x)\\bigr]_0^{GR}\n=\\frac{R\\,J_1(GR)}{G}.\n$$\n4. 因此\n$$\n\\kappa(\\mathbf G)\n=\\frac1{a^2}\\Bigl(\\frac1{\\epsilon_a}-\\frac1{\\epsilon_b}\\Bigr)\\,2\\pi\\frac{RJ_1(GR)}{G}\n=\\frac{2\\pi R}{a^2G}\\Bigl(\\frac1{\\epsilon_a}-\\frac1{\\epsilon_b}\\Bigr)J_1(GR).\n$$", "answer": "$$\\boxed{\\frac{2\\pi R}{a^2G}\\Bigl(\\frac{1}{\\epsilon_a}-\\frac{1}{\\epsilon_b}\\Bigr)J_1(GR)}$$", "id": "1179064"}, {"introduction": "对于一维光子晶体，传输矩阵法 (Transfer Matrix Method) 提供了一种精确的解析方法来理解其能带结构。通过该方法，我们可以推导出决定色散关系的超越方程，从而清晰地揭示光子带隙的形成机理。掌握此推导过程是理解周期性结构如何调控波传播的基础。[@problem_id:999271]", "problem": "考虑一个一维光子晶体，它由两种不同的无磁、无损耗介电层沿 $z$ 轴无限周期性排列而成。第一种材料的折射率为 $n_1$，厚度为 $d_1$，第二种材料的折射率为 $n_2$，厚度为 $d_2$。这种二元结构的晶格常数为 $a=d_1+d_2$。\n\n一列角频率为 $\\omega$ 的横电（TE）波在该结构中的 $xz$ 平面内传播。电场沿 $y$ 方向极化，$\\mathbf{E} = (0, E_y(z), 0)e^{i(k_x x - \\omega t)}$。该波具有平行于层界面的恒定波矢分量 $k_x$。\n\n在每个均匀层 $j \\in \\{1, 2\\}$ 内，电场对 $z$ 的依赖关系 $E_y(z)$ 由一维亥姆霍兹方程 $\\frac{d^2 E_y}{dz^2} + k_{zj}^2 E_y = 0$ 决定，其中垂直于各层的波矢分量为 $k_{zj} = \\sqrt{(\\omega/c)^2 n_j^2 - k_x^2}$。我们假设 $k_{zj}$ 为实数。\n\n根据布洛赫定理，对于周期性介质中的波，某一点的场与一个晶格常数之外的场通过一个相位因子相关联：$E_y(z+a) = e^{iKa}E_y(z)$，其中 $K$ 是布洛赫波矢。\n\n你的任务是推导出该光子晶体中 TE 模式的色散关系所对应的超越方程。该方程将布洛赫波矢 $K$ 与频率 $\\omega$ 联系起来。你必须使用传输矩阵法，该方法将晶胞起点的场振幅与终点的场振幅联系起来。", "solution": "1. 在每层 $j\\in\\{1,2\\}$ 中，TE 通解为\n   $$E_y(z)=A_j e^{i k_{zj}z}+B_j e^{-i k_{zj}z},\\qquad\n     k_{zj}=\\sqrt{\\Bigl(\\frac{\\omega}{c}\\Bigr)^2n_j^2-k_x^2}\\,. $$\n2. 穿过厚度为 $d_j$ 的层 $j$ 的传播由下式给出\n   $$\\begin{pmatrix}A_j(z+d_j)\\\\B_j(z+d_j)\\end{pmatrix}\n     =P_j\\begin{pmatrix}A_j(z)\\\\B_j(z)\\end{pmatrix},\\quad\n     P_j=\\begin{pmatrix}e^{i k_{zj}d_j}  0 \\\\ 0  e^{-i k_{zj}d_j}\\end{pmatrix}\\,. $$\n3. 在界面 $1\\to2$ 处，$E_y$ 和 $H_x\\propto dE_y/dz$ 的连续性条件给出\n   $$I_{12}=\\tfrac12\\begin{pmatrix}\n     1+\\eta1-\\eta\\\\1-\\eta1+\\eta\n   \\end{pmatrix},\\quad \\eta=\\frac{k_{z1}}{k_{z2}}\\,. $$\n4. 单周期传输矩阵为\n   $$M=P_2\\,I_{12}\\,P_1\\,,\\quad \\det M=1\\,. $$\n5. 布洛赫定理 $M\\binom{A_1}{B_1}=e^{iKa}\\binom{A_1}{B_1}$ 意味着\n   $$\\mathrm{Tr}(M)=2\\cos(K a)\\,. $$\n6. 直接计算得出\n   $$\\mathrm{Tr}(M)\n     =2\\cos(k_{z1}d_1)\\cos(k_{z2}d_2)\n       -\\Bigl(\\frac{k_{z1}}{k_{z2}}+\\frac{k_{z2}}{k_{z1}}\\Bigr)\n        \\sin(k_{z1}d_1)\\sin(k_{z2}d_2)\\,. $$\n7. 因此，色散关系为\n   $$\\cos(K a)\n     =\\cos(k_{z1}d_1)\\cos(k_{z2}d_2)\n      -\\frac12\\Bigl(\\frac{k_{z1}}{k_{z2}}+\\frac{k_{z2}}{k_{z1}}\\Bigr)\n       \\sin(k_{z1}d_1)\\sin(k_{z2}d_2)\\,. $$", "answer": "$$\\boxed{\\cos(k_{z1} d_1)\\cos(k_{z2} d_2)-\\frac{1}{2}\\bigl(\\frac{k_{z1}}{k_{z2}}+\\frac{k_{z2}}{k_{z1}}\\bigr)\\sin(k_{z1} d_1)\\sin(k_{z2} d_2)}$$", "id": "999271"}, {"introduction": "理想光子晶体的主要应用在于通过引入缺陷来制造谐振腔和波导等功能器件。本练习运用一阶微扰理论来分析移除一个介质柱所形成的单点缺陷，这种方法为估算带隙中局域缺陷态的频率提供了一个强大而直观的工具。通过这个练习，您可以理解高品质因子（Q值）谐振腔的设计原理。[@problem_id:1179026]", "problem": "一个二维光子晶体由置于背景介质中的介质柱构成一个正方晶格。该晶格的晶格常数为 $a$，介质柱具有方形横截面，边长为 $S$（其中 $S  a$）。介质柱的介电常数为 $\\epsilon_a$，背景介质的介电常数为 $\\epsilon_b$。对于整数 $m, n$，格点位于 $(ma, na)$ 位置。\n\n我们关心的是TM模式，对于这种模式，电场沿着介质柱的轴向（$z$ 轴）极化。对于完美晶体，考虑第一布里渊区中 M 点（$\\mathbf{k}_M = (\\pi/a, \\pi/a)$）处的一个特定模式。该模式的频率为 $\\omega_0$，其电场可以很好地用以下驻波形式近似：\n$$\n\\mathbf{E}_0(x, y) = E_m \\cos\\left(\\frac{\\pi x}{a}\\right) \\cos\\left(\\frac{\\pi y}{a}\\right) \\hat{\\mathbf{z}}\n$$\n其中 $E_m$ 是一个常数振幅。\n\n通过移除位于原点 $(0,0)$ 的单个介质柱来引入一个点缺陷。这等效于将其介电常数从 $\\epsilon_a$ 变为 $\\epsilon_b$。此微扰产生了一个新的局域缺陷模式，其频率为 $\\omega$。\n\n使用一阶微扰理论，计算该缺陷模式的相对频率漂移 $\\frac{\\omega - \\omega_0}{\\omega_0}$。请用给定的参数 $a, S, \\epsilon_a$ 和 $\\epsilon_b$ 表示你的答案，形式为一个闭式解析表达式。", "solution": "我们对介质中的麦克斯韦方程组使用一阶微扰理论。相对频率漂移为\n$$\n\\frac{\\omega-\\omega_0}{\\omega_0}\n \\;=\\;\n -\\frac12\\,\\frac{\\displaystyle\\int\\!dA\\;\\delta\\epsilon(\\mathbf r)\\,\\bigl|E_0(\\mathbf r)\\bigr|^2}\n      {\\displaystyle\\int\\!dA\\;\\epsilon(\\mathbf r)\\,\\bigl|E_0(\\mathbf r)\\bigr|^2}\\,.\n$$\n此处，在缺陷柱（位于原点，边长为 $S$ 的正方形）内部 $\\delta\\epsilon=\\epsilon_b-\\epsilon_a$，在其他地方为零。驻波场为\n$$\nE_0(x,y)=E_m\\cos\\frac{\\pi x}{a}\\cos\\frac{\\pi y}{a}\\,,\n$$\n因此所有积分均可因式分解。定义\n$$\nA(S)=\\int_{-S/2}^{S/2}\\cos^2\\!\\frac{\\pi x}{a}\\,dx\n       \\;=\\;\\frac{S}{2}+\\frac{a}{2\\pi}\\sin\\!\\frac{\\pi S}{a}\\,.\n$$\n那么分子中的积分为\n$$\n\\int_{\\rm rod}\\bigl|E_0\\bigr|^2dA\n =E_m^2\\,[A(S)]^2,\n$$\n而在一个晶胞内，\n$$\n\\int_{\\rm cell}\\epsilon(\\mathbf r)\\bigl|E_0\\bigr|^2dA\n =E_m^2\\Bigl[\\epsilon_a\\,[A(S)]^2+\\epsilon_b\\Bigl(\\frac{a^2}{4}-[A(S)]^2\\Bigr)\\Bigr]\n =E_m^2\\Bigl[\\frac{\\epsilon_b\\,a^2}{4}+(\\epsilon_a-\\epsilon_b)[A(S)]^2\\Bigr].\n$$\n因此\n$$\n\\frac{\\omega-\\omega_0}{\\omega_0}\n =-\\frac12\\frac{(\\epsilon_b-\\epsilon_a)[A(S)]^2}\n                  {\\frac{\\epsilon_b\\,a^2}{4}+(\\epsilon_a-\\epsilon_b)[A(S)]^2}\n =\\frac{(\\epsilon_a-\\epsilon_b)[A(S)]^2}\n       {2\\bigl[\\frac{\\epsilon_b\\,a^2}{4}+(\\epsilon_a-\\epsilon_b)[A(S)]^2\\bigr]}\\,,\n$$\n其中 $A(S)=\\frac{S}{2}+\\frac{a}{2\\pi}\\sin\\!\\frac{\\pi S}{a}\\,$。", "answer": "$$\n\\boxed{\n\\frac{(\\epsilon_a-\\epsilon_b)\\!\\bigl(\\tfrac{S}{2}+\\tfrac{a}{2\\pi}\\sin\\!\\tfrac{\\pi S}{a}\\bigr)^2}\n     {\\tfrac{\\epsilon_b\\,a^2}{2}+2(\\epsilon_a-\\epsilon_b)\\!\\bigl(\\tfrac{S}{2}+\\tfrac{a}{2\\pi}\\sin\\!\\tfrac{\\pi S}{a}\\bigr)^2}\n}.\n$$", "id": "1179026"}]}