## 引言
在量子多体物理中，理解系统在非零温度下的行为是解释从超导材料到早期宇宙等众多物理现象的关键。然而，直接在实时间框架下处理有限温度系统的[量子演化](@entry_id:198246)与热涨落耦合的复杂性，构成了一个巨大的理论挑战。松原表象（Matsubara Representation）正是在此背景下应运而生的一种强大形式主义，它通过巧妙地引入“虚时间”，将复杂的动力学问题转化为一个更易于处理的[统计力](@entry_id:194984)学问题，为我们运用场论工具计算有限温度下的物理量开辟了道路。

本文将带领读者系统性地掌握这一核心工具。在第一章“原理与机制”中，我们将奠定理论基础，从虚时间格林函数和[松原频率](@entry_id:197724)出发，构建起[戴森方程](@entry_id:146246)和自能等关键概念。随后的“应用与跨学科联系”章节将展示该理论的强大威力，通过实例探讨其如何被应用于解释超导、磁响应、乃至[量子化学](@entry_id:140193)中的复杂现象。最后，在“动手实践”部分，我们将通过具体的计算问题，将抽象的理论转化为可操作的技能，巩固读者对松原表象的理解和应用能力。通过这三个层次的深入学习，读者将能够全面理解松原表象的精髓，并具备将其应用于前沿研究的能力。

## 原理与机制

本章旨在系统性地阐述松原表象的理论基础与核心机制。我们将从虚时间[格林函数](@entry_id:147802)的定义出发，揭示其与有限温度[统计力](@entry_id:194984)学之间的深刻联系。随后，我们将引入离散的[松原频率](@entry_id:197724)，并展示如何在频率空间中进行计算。通过对非相互作用和相互作用体系的分析，我们将建立起[戴森方程](@entry_id:146246)和自能等关键概念。最后，我们将探讨如何从虚频轴上的计算结果通过[解析延拓](@entry_id:147225)获得与实验直接相关的实频物理量，并明确该理论框架的适用范围。

### [虚时间](@entry_id:138627)格林函数

在[量子多体理论](@entry_id:161885)中，我们常常关心系统的[基态](@entry_id:150928)和低能激发性质，这通常通过计算实时间的[格林函数](@entry_id:147802)（或称关联函数）来实现。然而，当系统处于有限温度 $T$ 的热平衡态时，直接处理实时间演化变得异常复杂。一个更有效的方法是转向虚时间形式，这便是松原形式主义的出发点。

这一方法的灵感来源于量子力学与[统计力](@entry_id:194984)学之间的形式类比。一个[量子态](@entry_id:146142)的时间演化由[演化算符](@entry_id:182628) $U(t) = \exp(-iHt/\hbar)$ 描述，而一个处于温度 $T$（对应[逆温](@entry_id:140086) $\beta = 1/(k_B T)$）的系统的[热力学性质](@entry_id:146047)则由[密度矩阵](@entry_id:139892) $\rho = \exp(-\beta H) / Z$ 决定，其中 $Z = \text{Tr}[\exp(-\beta H)]$ 是[配分函数](@entry_id:193625)。通过将实时间 $t$ 替换为[虚时间](@entry_id:138627) $\tau = it/\hbar$，[演化算符](@entry_id:182628)的形式变为 $\exp(-H\tau)$，与统计算符 $\exp(-\beta H)$ 极其相似。这个简单的替换揭示了[时间演化](@entry_id:153943)与热涨落之间的深刻联系，并允许我们运用强大的场论工具来计算有限温度下的[热力学平均](@entry_id:755909)值。

在此框架下，我们定义**[虚时间](@entry_id:138627)[单粒子格林函数](@entry_id:140400)**（或称**[松原格林函数](@entry_id:199218)**）。对于[费米子](@entry_id:146235)体系，其定义为：
$$
\mathcal{G}(\mathbf{x}, \tau; \mathbf{x}', \tau') = -\langle T_\tau \psi(\mathbf{x}, \tau) \psi^\dagger(\mathbf{x}', \tau') \rangle
$$
其中 $\psi(\mathbf{x}, \tau)$ 和 $\psi^\dagger(\mathbf{x}', \tau')$ 是[海森堡绘景](@entry_id:141162)下的湮灭和[产生算符](@entry_id:191512)，其[虚时间](@entry_id:138627)依赖性为 $O(\tau) = e^{\tau H} O e^{-\tau H}$。尖括号 $\langle \dots \rangle$ 表示在[巨正则系综](@entry_id:141562)下的[热力学平均](@entry_id:755909) $\text{Tr}[e^{-\beta(H-\mu N)} \dots]/Z$。

这里的关键是**虚[时间排序算符](@entry_id:148044)** $T_\tau$。它将算符按照[虚时间](@entry_id:138627) $\tau$ 的大小进行排序。对于[费米子](@entry_id:146235)，由于其[反对称性](@entry_id:261893)，交换两个算符的位置会引入一个负号：
$$
T_\tau A(\tau_1) B(\tau_2) =
\begin{cases}
A(\tau_1) B(\tau_2)  \text{if } \tau_1 > \tau_2 \\
-B(\tau_2) A(\tau_1)  \text{if } \tau_2 > \tau_1
\end{cases}
$$
对于[玻色子](@entry_id:138266)，[交换算符](@entry_id:156554)不引入负号。

为了直观理解[格林函数](@entry_id:147802)的计算，我们考虑一个最简单的模型：一个能量为 $\epsilon$ 的单[费米子](@entry_id:146235)能级，其[哈密顿量](@entry_id:172864)为 $H = (\epsilon - \mu) c^\dagger c = \xi c^\dagger c$ [@problem_id:1169787] [@problem_id:3004456]。我们希望计算 $\mathcal{G}(\tau) = -\langle T_\tau c(\tau) c^\dagger(0) \rangle$。首先，我们需要算符的[虚时间演化](@entry_id:164452)。通过求解[海森堡运动方程](@entry_id:140445) $\frac{d c(\tau)}{d\tau} = [H, c(\tau)]$，或使用算符恒等式，可以得到 $c(\tau) = c e^{-\xi\tau}$。

对于 $\tau > 0$，[时间排序算符](@entry_id:148044)将 $c(\tau)$ 置于左侧，因此：
$$
\mathcal{G}(\tau) = -\langle c(\tau) c^\dagger(0) \rangle = -\langle c e^{-\xi\tau} c^\dagger \rangle = -e^{-\xi\tau} \langle c c^\dagger \rangle
$$
利用[费米子](@entry_id:146235)[反对易关系](@entry_id:153815) $\{c, c^\dagger\}=1$，我们有 $\langle c c^\dagger \rangle = \langle 1 - c^\dagger c \rangle = 1 - \langle n \rangle$。其中 $\langle n \rangle = \langle c^\dagger c \rangle$ 是该能级的平均占据数，即[费米-狄拉克分布](@entry_id:138909) $n_F(\xi) = 1/(e^{\beta\xi}+1)$。因此，对于 $0 < \tau < \beta$，我们得到：
$$
\mathcal{G}(\tau) = -e^{-\xi\tau} (1 - n_F(\xi))
$$
这个表达式是后续所有计算的基石，它包含了粒子传播（由指数项 $e^{-\xi\tau}$ 体现）和[泡利不相容原理](@entry_id:141850)（由占据因子 $1-n_F(\xi)$ 体现）的信息。

### 松原表象：从时间到频率

[虚时间](@entry_id:138627)格林函数 $\mathcal{G}(\tau)$ 有一个非常重要的性质：它在区间 $[0, \beta]$ 上满足（反）周期性边界条件。对于[费米子](@entry_id:146235)，可以证明 $\mathcal{G}(\tau) = -\mathcal{G}(\tau+\beta)$，即反周期性。对于[玻色子](@entry_id:138266)，则满足周期性 $\mathcal{G}(\tau) = \mathcal{G}(\tau+\beta)$。

这个周期性结构意味着我们可以将 $\mathcal{G}(\tau)$ 展开为傅里叶级数。为了满足反周期性边界条件，傅里叶展开中必须使用一组特定的离散频率。这些频率被称为**[费米子](@entry_id:146235)[松原频率](@entry_id:197724)**：
$$
\omega_n = \frac{(2n+1)\pi}{\beta}, \quad n \in \mathbb{Z}
$$
相应地，对于[玻色子](@entry_id:138266)，[周期性边界条件](@entry_id:147809)要求使用**[玻色子](@entry_id:138266)[松原频率](@entry_id:197724)**：
$$
\nu_m = \frac{2m\pi}{\beta}, \quad m \in \mathbb{Z}
$$
将[虚时间](@entry_id:138627)[格林函数](@entry_id:147802) $\mathcal{G}(\tau)$ 进行[傅里叶变换](@entry_id:142120)，我们就得到了**频率空间中的[松原格林函数](@entry_id:199218)** $\mathcal{G}(i\omega_n)$：
$$
\mathcal{G}(i\omega_n) = \int_0^\beta d\tau \, e^{i\omega_n \tau} \mathcal{G}(\tau)
$$
这个变换将微[积分方程](@entry_id:138643)（如运动方程）转化为[代数方程](@entry_id:272665)，极大地简化了计算。

让我们回到单能级的例子 [@problem_id:1169787] [@problem_id:3004456]。对之前得到的 $\mathcal{G}(\tau)$ 进行[傅里叶变换](@entry_id:142120)：
$$
\mathcal{G}(i\omega_n) = \int_0^\beta d\tau \, e^{i\omega_n \tau} [-e^{-\xi\tau}(1-n_F(\xi))] = -(1-n_F(\xi)) \int_0^\beta d\tau \, e^{(i\omega_n - \xi)\tau}
$$
计算这个积分，并利用[费米子](@entry_id:146235)[松原频率](@entry_id:197724)的关键性质 $e^{i\omega_n\beta} = e^{i(2n+1)\pi} = -1$，经过一番代数化简，我们会得到一个极为简洁和深刻的结果：
$$
\mathcal{G}(i\omega_n) = \frac{1}{i\omega_n - \xi}
$$
这是非[相互作用费米子](@entry_id:160994)的[松原格林函数](@entry_id:199218)的基本形式。它的结构非常直观：分母是虚频率 $i\omega_n$ 与粒子能量 $\xi$ 的差。当 $i\omega_n \approx \xi$ 时，格林函数发散，这正对应着一个能量为 $\xi$ 的稳定粒子激发。

对于具有更复杂能带结构的真实材料，例如[晶格](@entry_id:196752)上的电子，[哈密顿量](@entry_id:172864)和[格林函数](@entry_id:147802)通常是动量 $\mathbf{k}$ 的函数，并且可能具有矩阵结构。例如，如果一个晶胞内有多个原子（或子[晶格](@entry_id:196752)），[哈密顿量](@entry_id:172864)在[动量空间](@entry_id:148936)中就是一个矩阵 $H(\mathbf{k})$。此时，[格林函数](@entry_id:147802)也相应地成为一个矩阵，其通用形式为：
$$
\mathcal{G}(\mathbf{k}, i\omega_n) = [i\omega_n \mathbf{I} - H(\mathbf{k})]^{-1}
$$
其中 $\mathbf{I}$ 是单位矩阵。这个表达式是求解非相互作用体系格林函数的普适公式。例如，在描述拓扑绝缘体的SSH模型中 [@problem_id:1169784]，[哈密顿量](@entry_id:172864)是一个 $2 \times 2$ 矩阵，通过对 $[i\omega_n \mathbf{I} - H(k)]$ 求逆，就可以得到包含对角和非对角元（分别描述子[晶格](@entry_id:196752)内部和之间的传播）的格林函数矩阵。同样，对于具有交错势的二维方格模型，也可以用此方法计算出[格林函数](@entry_id:147802)的各个分量 [@problem_id:1169756]。

### 应用：[松原求和](@entry_id:147118)与物理观测量

[松原格林函数](@entry_id:199218)的威力在于它提供了一种系统的方法来计算物理观测量。在[微扰理论](@entry_id:138766)中，许多物理量，如系统的总能量、粒子数、以及各种[响应函数](@entry_id:142629)（如[磁化率](@entry_id:138219)、[极化率](@entry_id:143513)），都可以表示为一系列[格林函数](@entry_id:147802)乘积对所有[松原频率](@entry_id:197724)的求和。

一个典型的**[松原求和](@entry_id:147118)**形式为 $S = \frac{1}{\beta} \sum_n f(i\omega_n)$。直接对这个[无穷级数求和](@entry_id:161691)通常很困难。一个强大的技巧是利用[复分析中的留数](@entry_id:165494)定理，将离散求和转化为复平面上的[围道积分](@entry_id:169446)。其基本思想是引入一个辅助函数，该函数在所有[松原频率](@entry_id:197724)点上都有一阶极点，且留数为 $1/\beta$。对于[费米子](@entry_id:146235)和[玻色子](@entry_id:138266)，这个角色分别由[费米-狄拉克分布](@entry_id:138909)函数 $n_F(z) = 1/(e^{\beta z}+1)$ 和[玻色-爱因斯坦分布](@entry_id:145257)函数 $n_B(z) = 1/(e^{\beta z}-1)$ 扮演。

例如，一个[费米子](@entry_id:146235)求和可以写为：
$$
\frac{1}{\beta} \sum_n f(i\omega_n) = -\sum_{z_j} \text{Res}[f(z)n_F(z), z_j]
$$
其中 $z_j$ 是函数 $f(z)$ 的所有极点。这样，一个[无穷级数求和](@entry_id:161691)问题就转化为了计算有限个留数的代数问题。例如，在计算某些三角[费曼图](@entry_id:144373)时，可能会遇到对三个[格林函数](@entry_id:147802)乘积的求和，通过留数定理可以得到其解析表达式 [@problem_id:1169732]。类似地，对于[玻色子](@entry_id:138266)求和，例如涉及[玻色子](@entry_id:138266)和[费米子](@entry_id:146235)格林函数乘积的求和，也可以用同样的方法处理，只需将 $n_F(z)$ 替换为 $n_B(z)$ 即可 [@problem_id:1169781]。

松原形式主义的一个重要应用是建立微观格林函数与宏观[热力学](@entry_id:141121)量之间的联系。例如，系统的总粒子数 $N$ 可以通过对格林函数进行[松原求和](@entry_id:147118)得到：
$$
N = \frac{1}{\beta} \sum_{n, \mathbf{k}} \mathcal{G}(\mathbf{k}, i\omega_n) e^{i\omega_n \eta} \quad (\eta \to 0^+)
$$
这个关系式非常强大。例如，在研究[玻色-爱因斯坦凝聚](@entry_id:144849)（BEC）时，我们可以利用这个公式来确定在[临界温度](@entry_id:146683) $T_c$ 以上，化学势 $\mu$ 如何随温度 $T$ 变化。通过将求和转化为积分，并利用已知的函数[渐近展开](@entry_id:173196)，可以推导出在 $T \to T_c^+$ 极限下 $\mu \propto -(T-T_c)^2$ 的行为，并精确计算出其系数 [@problem_id:1169773]。这清晰地展示了松原方法在[相变](@entry_id:147324)理论中的应用。

此外，该 formalism 同样适用于计算两粒子关联函数，如描述粒子-空穴对传播的极化函数 $\Pi(\mathbf{q}, i\nu_m)$。它是计算系统[介电响应](@entry_id:140146)、筛选效应以及[集体激发](@entry_id:145026)（如[等离激元](@entry_id:146184)）的关键 [@problem_id:1169743]。

### 相互作用、[自能](@entry_id:145608)与[戴森方程](@entry_id:146246)

目前为止，我们的讨论主要局限于非相互作用体系。然而，真实材料中的电子是相互作用的。相互作用的存在使得问题变得极其复杂。在[格林函数](@entry_id:147802)语言中，相互作用的全部效应被打包进一个叫做**[自能](@entry_id:145608)**（**self-energy**）的量中，用 $\Sigma$ 表示。

对于非相互作用体系，我们有[格林函数](@entry_id:147802) $G_0$。在相互作用体系中，粒子在传播过程中会不断地与其他粒子散射。[自能](@entry_id:145608) $\Sigma$ 就等效地描述了由这些复杂散射过程产生的平均效应。完整的（或“穿好衣服的”）[格林函数](@entry_id:147802) $G$ 与非相互作用的（或“裸”）[格林函数](@entry_id:147802) $G_0$ 以及自能 $\Sigma$ 之间通过**[戴森方程](@entry_id:146246)**（Dyson's equation）联系起来：
$$
G = G_0 + G_0 \Sigma G
$$
这个方程可以更方便地写成逆格林函数的形式：
$$
G^{-1} = G_0^{-1} - \Sigma
$$
既然 $G_0^{-1}(i\omega_n, \mathbf{k}) = i\omega_n - \xi_\mathbf{k}$，那么 $G(i\omega_n, \mathbf{k}) = \frac{1}{i\omega_n - \xi_\mathbf{k} - \Sigma(i\omega_n, \mathbf{k})}$。

[自能](@entry_id:145608) $\Sigma$ 通常是频率和动量的复函数。它的实部 $\text{Re}[\Sigma]$ 描述了粒子能量的移动（重整化），而它的虚部 $\text{Im}[\Sigma]$ 则与粒子的[散射率](@entry_id:143589)或寿命直接相关。一个非零的虚部意味着[准粒子](@entry_id:136584)不再是稳定的激发，而是会衰变，具有有限的寿命 $\tau_L \propto 1/|\text{Im}[\Sigma]|$。

计算[自能](@entry_id:145608)是[多体理论](@entry_id:169452)的核心任务。在微扰理论中，$\Sigma$ 由一系列被称为“单粒子不可约”的[费曼图](@entry_id:144373)给出。一个更系统的方法是利用**Luttinger-Ward 泛函** $\Phi[G]$ [@problem_id:2785460]。$\Phi[G]$ 是所有由完整格林函数 $G$ 构成的“骨架”真[空图](@entry_id:275064)之和。[自能](@entry_id:145608)可以通过对该泛函求泛函导数得到：
$$
\Sigma = \frac{\delta \Phi[G]}{\delta G}
$$
这种方法的一个巨大优势是，任何通过这种方式构造的自能都将自动满足系统的宏观守恒律（如[电荷](@entry_id:275494)、动量守恒），这被称为**[守恒近似](@entry_id:139611)**。例如，对于Hubbard模型，其最简单的非平庸 $\Phi[G]$ 近似（即[Hartree近似](@entry_id:140404)）给出的[自能](@entry_id:145608)是一个与动量和频率无关的常数 $\Sigma = U n/2$，其中 $U$ 是相互作用强度，$n$ 是粒子密度 [@problem_id:2989946]。这清晰地展示了相互作用如何导致粒子能量的平均移动。

一个更实际的例子是处理材料中的无序或杂质。例如，在含有非磁性杂质的金属中，电子会与杂质发生散射。在自洽的T[矩阵近似](@entry_id:149640)（或[相干势近似](@entry_id:140539)，CPA）中，可以建立一个关于[自能](@entry_id:145608) $\Sigma$ 的[自洽方程](@entry_id:155949)。求解这个方程可以得到自能，其虚部就反映了由[杂质散射](@entry_id:267814)引起的电子寿命的降低 [@problem_id:1169767]。

### 超出简[单体](@entry_id:136559)系：超导与近似

松原形式主义的强大之处在于其广泛的适用性。例如，它可以被推广用来描述超导态。在超导态中，电子两两配对形成[库珀对](@entry_id:143370)。为了描述这种配对，我们需要引入一个**[反常格林函数](@entry_id:141518)** $F(\mathbf{k}, i\omega_n) = -\int_0^\beta d\tau e^{i\omega_n\tau} \langle T_\tau c_{\mathbf{k}\uparrow}(\tau) c_{-\mathbf{k}\downarrow}(0) \rangle$。这个函数描述了一个电子对的产生或湮没，它的非零值是超导序的直接标志。

这个[反常格林函数](@entry_id:141518)具有特定的对称性。例如，对于传统的s波自旋单态[超导体](@entry_id:191025)，泡利原理和[配对对称性](@entry_id:139531)要求 $F$ 必须是自旋指标反对称的（即 $F_{\uparrow\downarrow} = -F_{\downarrow\uparrow}$，且 $F_{\uparrow\uparrow}=F_{\downarrow\downarrow}=0$），并且是动量 $\mathbf{k}$ 和[松原频率](@entry_id:197724) $i\omega_n$ 的偶函数 [@problem_id:3004452]。将正常格林函数 $G$ 和[反常格林函数](@entry_id:141518) $F$ 组合在一个矩阵中（即Nambu-Gor'kov形式主义），[戴森方程](@entry_id:146246)可以被推广为矩阵形式，从而完整地描述[超导体](@entry_id:191025)的激发谱。

在处理复杂的相互作用问题时，近似是不可避免的。一个核心问题是，在计算[自能](@entry_id:145608)时，我们是否需要考虑所谓的**[顶点修正](@entry_id:146982)**（vertex corrections）。**米格达尔定理**（Migdal's theorem）为在[电子-声子相互作用](@entry_id:140708)问题中忽略[顶点修正](@entry_id:146982)提供了坚实的理论依据 [@problem_id:3004449]。该定理指出，[顶点修正](@entry_id:146982)的贡献大小与[声子](@entry_id:140728)[能量尺度](@entry_id:196201)（如[德拜频率](@entry_id:153821) $\omega_D$）和电子能量尺度（如[费米能](@entry_id:143977) $E_F$）之比成正比。在大多数常规金属中，[声子](@entry_id:140728)远比电子“慢”且“软”，即 $\omega_D \ll E_F$，这使得[顶点修正](@entry_id:146982)项可以被安全地忽略。这是[Eliashberg理论](@entry_id:144676)等强耦合超导理论能够成功的基础。然而，当这个条件不满足时，例如在窄带体系或低密度载流子体系中，米格达尔定理失效，[顶点修正](@entry_id:146982)变得至关重要。

### 通往实频的桥梁：[解析延拓](@entry_id:147225)

松原形式主义的所有计算都是在离散的[虚频](@entry_id:165180)轴上进行的。然而，实验测量（如[角分辨光电子能谱](@entry_id:139661)[ARPES](@entry_id:139661)或光学[电导](@entry_id:177131)）是在实频轴上进行的。那么，如何将理论计算与实验结果联系起来呢？答案是**[解析延拓](@entry_id:147225)**（analytic continuation）。

其核心思想是，[虚频](@entry_id:165180)[格林函数](@entry_id:147802) $\mathcal{G}(i\omega_n)$ 和我们感兴趣的实频物理[格林函数](@entry_id:147802)（如[推迟格林函数](@entry_id:139183) $\mathcal{G}^R(\omega)$）实际上是同一个定义在复频率平面 $z$ 上的解析函数 $\mathcal{G}(z)$ 在不同路径上的取值 [@problem_id:2825379]。

由于因果律，[推迟格林函数](@entry_id:139183) $\mathcal{G}^R(t-t')$ 在 $t-t'<0$ 时为零。这一性质决定了其[傅里叶变换](@entry_id:142120) $\mathcal{G}^R(z)$ 在复平面的上半平面（Im$z > 0$）是解析的，即没有任何极点或[奇点](@entry_id:137764) [@problem_id:2983461]。该函数的所有非解析行为（如[极点和支割线](@entry_id:198858)）都位于实轴上，它们对应着系统中真实的物理激发。

[松原格林函数](@entry_id:199218) $\mathcal{G}(i\omega_n)$ 就是这个[解析函数](@entry_id:139584) $\mathcal{G}(z)$ 在[虚轴](@entry_id:262618)上一系列离散点 $z=i\omega_n$ 的取值。而[推迟格林函数](@entry_id:139183) $\mathcal{G}^R(\omega)$ 则是该函数从上半平面趋近于实轴的边界值：
$$
\mathcal{G}^R(\omega) = \lim_{\eta \to 0^+} \mathcal{G}(\omega + i\eta)
$$
原则上，如果我们知道了函数在[虚轴](@entry_id:262618)上无穷多个点的值，我们就可以唯一地确定这个[解析函数](@entry_id:139584)，并从而得到它在实轴上的值。这个过程就是解析延拓。我们可以通过[谱函数](@entry_id:147628)表示来形式化地描述这一联系。

在某些简单情况下，[解析延拓](@entry_id:147225)可以直接进行。例如，如果可以通过围道积分等方法直接求出 $\Sigma(z)$ 的解析表达式，那么只需将 $z$ 替换为 $\omega + i0^+$ 即可得到推迟自能 $\Sigma^R(\omega)$ [@problem_id:2989922]。然而，在大多数数值计算中，我们只能得到 $\mathcal{G}(i\omega_n)$ 在有限个频率点上的带有数值误差的值。从这些离散、有噪声的数据中恢复实频函数是一个数学上的**[不适定问题](@entry_id:182873)**（ill-posed problem）。微小的噪声就可能导致实频结果出现剧烈的、非物理的[振荡](@entry_id:267781) [@problem_id:2825379]。因此，实际操作中需要使用[最大熵](@entry_id:156648)方法或[Padé近似](@entry_id:268838)等特殊的数值技术来执行[解析延拓](@entry_id:147225)。

最后，必须强调松原形式主义的适用范围。它是一个为**热平衡**[系统设计](@entry_id:755777)的理论。对于一个[哈密顿量](@entry_id:172864)随时间演变的非[平衡问题](@entry_id:636409)，例如[量子淬火](@entry_id:145899)后系统的瞬态动力学，[时间平移不变性](@entry_id:270209)被打破，[格林函数](@entry_id:147802)将依赖于两个独立的时间变量 $G(t, t')$。在这种情况下，仅依赖于单一频率变量的松原 formalism 会失效。描述这类非平衡过程需要更通用的**Keldysh[非平衡格林函数](@entry_id:201883)形式主义** [@problem_id:2997968]。Keldysh形式主义在实时间等时线上进行计算，能够完整地描述系统的瞬态演化，并在系统弛豫到平衡或[稳态](@entry_id:182458)时，自然地回归到与松原方法等价的结果。