## 引言
在处理由大量相互作用粒子构成的[量子多体系统](@entry_id:141221)中，直接求解薛定谔方程几乎是不可能的。[费曼图](@entry_id:144373)展开为解决这一难题提供了一套强大而直观的系统性方法，它将复杂的[量子场论](@entry_id:138177)计算转化为一种拓扑语言，极大地促进了理论物理学的发展。本文旨在全面介绍[费曼图](@entry_id:144373)方法，从其基本原理到前沿应用，帮助读者建立坚实的理论基础并掌握其计算技巧。本文解决了如何系统地计算相互作用效应对系统物理性质影响的知识鸿沟。

在接下来的章节中，我们将分步深入这一课题。第一章“原理与机制”将阐述费曼图的理论基石，包括[威克定理](@entry_id:137086)、联通簇定理以及将图转化为代数表达式的精确规则，并介绍[戴森方程](@entry_id:146246)这一核心[重整化](@entry_id:143501)工具。第二章“应用与[交叉](@entry_id:147634)学科联系”将展示[费曼图](@entry_id:144373)思想的普适性，探讨其在凝聚态物理（如超导与输运）、介观物理、[量子光学](@entry_id:140582)等不同领域中的具体应用和深刻联系。最后，在“动手实践”部分，读者将通过解决具体的物理问题，如推导[BCS能隙方程](@entry_id:184182)，来巩固和应用所学知识，将理论真正转化为实践能力。

## 原理与机制

在[多体物理学](@entry_id:144526)中，费曼图提供了一种强大而直观的语言，用于理解和计算相互作用系统中粒子的行为。这些图不仅仅是启发性的草图；它们是微扰理论中复杂代数表达式的严格拓扑表示。本章旨在阐述费曼图方法背后的基本原理和核心机制，从其在[微扰展开](@entry_id:159275)中的起源开始，到[戴森方程](@entry_id:146246)的[重整化](@entry_id:143501)能力，再到在不同物理场景（平衡态、非[平衡态](@entry_id:168134)）下的具体应用规则。

### 从[微扰展开](@entry_id:159275)到[费曼图](@entry_id:144373)：[威克定理](@entry_id:137086)与[正规序](@entry_id:145434)

[多体系统](@entry_id:144006)中的相互作用效应通常通过对[相互作用哈密顿量](@entry_id:181720) $H_{\mathrm{int}}$ 的[微扰展开](@entry_id:159275)来处理。在[相互作用绘景](@entry_id:198213)中，一个系统的[演化算符](@entry_id:182628)由时间排序的指数形式 $U_I = T \exp(-\mathrm{i}\int dt\, H_I(t))$ 给出。关联函数，例如[单粒子格林函数](@entry_id:140400) $G(x, x') = -\mathrm{i}\langle T \psi(x) \psi^\dagger(x') \rangle$，其[微扰展开](@entry_id:159275)涉及到对包含多个 $H_I$ 和[场算符](@entry_id:140269)乘积的时间排序乘积的真空（或[热力学](@entry_id:141121)）平均值的计算。

将这些复杂算符乘积转化为可计算表达式的核心工具是**[威克定理](@entry_id:137086) (Wick's theorem)**。该定理指出，任意一组[场算符](@entry_id:140269)的时间排序乘积，可以展开为它们所有可能的[正规序](@entry_id:145434)乘积与完全收缩项之和。一个**收缩 (contraction)** 被定义为两个[场算符](@entry_id:140269)的时间排序乘积的[真空期望值](@entry_id:146340)，$\overbrace{\psi(x) \psi^\dagger(x')} \equiv \langle 0|T \psi(x) \psi^\dagger(x')|0\rangle$。在没有相互作用的情况下，这个收缩就是非相互作用的[格林函数](@entry_id:147802)或**裸[传播子](@entry_id:139558) (bare propagator)** $G_0(x, x')$，它描述了粒子从 $x'$ 到 $x$ 的传播。在[费曼图](@entry_id:144373)中，传播子由一条线表示。

与收缩相辅相成的概念是**[正规序](@entry_id:145434) (normal ordering)**，记作 $:\mathcal{O}:$。对于一个给定的算符乘积 $\mathcal{O}$，其[正规序](@entry_id:145434)形式是通过重新[排列](@entry_id:136432)其组成算符，将所有[产生算符](@entry_id:191512)（如 $\psi^\dagger$）移动到所有湮灭算符（如 $\psi$）的左侧而得到的。对于[费米子](@entry_id:146235)，每次[交换算符](@entry_id:156554)位置都会引入一个 $(-1)$ 的符号因子。[正规序](@entry_id:145434)的物理意义在于消除真空的贡献。根据其定义，任何包含至少一个[湮灭算符](@entry_id:165390)且没有常数（c-数）部分的[正规序](@entry_id:145434)算符，其[真空期望值](@entry_id:146340)为零：$\langle 0|:\mathcal{O}:|0\rangle=0$ [@problem_id:2989925]。这是因为最右侧的[湮灭算符](@entry_id:165390)作用在真空态 $|0\rangle$ 上会得到零。

这个性质至关重要。例如，考虑一个非相对论[费米子](@entry_id:146235)系统的[相互作用哈密顿量](@entry_id:181720) $V = \frac{1}{2}\int d\mathbf{x}\, d\mathbf{y}\, \psi^{\dagger}(\mathbf{x})\psi^{\dagger}(\mathbf{y})\, v(\mathbf{x}-\mathbf{y})\, \psi(\mathbf{y})\psi(\mathbf{x})$。由于所有[产生算符](@entry_id:191512)已经位于湮灭算符的左侧，该[哈密顿量](@entry_id:172864)本身已经是[正规序](@entry_id:145434)的，即 $V = :V:$。这意味着其[真空期望值](@entry_id:146340) $\langle 0|V|0 \rangle$ 为零。在图的语言中，这对应于不存在一阶真空过程。更具体地说，当我们将[威克定理](@entry_id:137086)应用于包含诸如 $:V:$ 这样的[正规序](@entry_id:145434)算符乘积时，一个重要的简化规则是，我们只考虑来自*不同*[正规序](@entry_id:145434)块的算符之间的收缩。在单个 $:V:$ 内部的算符之间不允许收缩。这意味着形如图形的线（传播子）从一个相互作用顶点出发并立即返回同一顶点的“蝌蚪图”(tadpole) 或单顶点环路，在理论中被系统地消除了 [@problem_id:2989925]。这极大地简化了[微扰展开](@entry_id:159275)。

### 联通图、真空泡与联通簇定理

[威克定理](@entry_id:137086)将一个复杂的时间排序乘积分解为一系列项，每一项对应一个特定的**费曼图 (Feynman diagram)**。一个图由代表传播子的线和代表相互作用的顶点组成。然而，这些图可以分为两大类：**联通图 (connected diagrams)** 和**非联通图 (disconnected diagrams)**。一个联通图是所有顶点和外部线都通过[传播子](@entry_id:139558)线连接成一个单一分量的图。非联通图则由多个这样的分量组成。

一类特殊的非联通图是**真空泡 (vacuum bubbles)**，它们是没有任何外部线（即不连接到关联函数中指定的时空点）的联通分量。虽然[正规序](@entry_id:145434)可以消除单顶点真空泡，但涉及多个顶点的真空泡（例如，两个顶点通过[费米子](@entry_id:146235)环路连接）在[微扰展开](@entry_id:159275)中仍然存在 [@problem_id:2989925]。

这些非联通图的存在似乎使计算变得异常复杂，但一个深刻的结论，即**联通簇定理 (Linked-Cluster Theorem)**，极大地简化了这一问题。该定理指出，任何n点[格林函数](@entry_id:147802)的贡献完全由*所有联通的* n点图之和给出。所有非联通的真空泡部分都以一种系统的方式被抵消了。

理解这一点的最优雅的方式是通过**[生成泛函](@entry_id:152688) (generating functional)** 的形式。我们可以引入一个外部经典源 $J(x)$，它与[场算符](@entry_id:140269)线性耦合，并定义[配分函数](@entry_id:193625)泛函 $Z[J]$。完整的n点格林函数（或称矩）可以通过对 $Z[J]$ 进行n次泛函[微分](@entry_id:158718)来获得。联通簇定理的数学表述是 $Z[J] = \exp(W[J])$，其中 $W[J]$ 是所有*联通*图（包括连接到源 $J$ 的图）之和的[生成泛函](@entry_id:152688)。

因此，如果我们转而使用 $W[J] = \ln Z[J]$ 作为[生成泛函](@entry_id:152688)，它的泛函导数将直接生成**联通[格林函数](@entry_id:147802) (connected Green's functions)**，也称为**累积量 (cumulants)** [@problem_id:2989931, @problem_id:2989948]。由于[物理可观测量](@entry_id:154692)，如[输运系数](@entry_id:136790)和磁化率，总是与系统的联通响应相关，这使我们能够将注意力完全集中在计算联通图上。例如，对于一个非相互作用的高斯系统，其作用量是[场算符](@entry_id:140269)的双线性形式，所有阶数 $n>2$ 的联通[累积量](@entry_id:152982)都为零，这反映了[威克定理](@entry_id:137086)将所有高阶关联[函数分解](@entry_id:197881)为两点函[数乘](@entry_id:155971)积的事实 [@problem_id:2989948]。

联通簇定理还有一个重要的[热力学](@entry_id:141121)推论。系统的宏观性质，如自由能或[巨势](@entry_id:136286) $\Omega$，必须是广延的，即与系统体积 $V$ 成正比。[巨势](@entry_id:136286)与[配分函数](@entry_id:193625)的对数有关，$\Omega \propto -\ln Z[0]$。联通簇定理表明 $\ln Z[0]$ 等于所有联通真[空图](@entry_id:275064)之和 $W[0]$。由于任何单个联通真[空图](@entry_id:275064)的贡献都与时空体积 $V\beta$ 成正比，因此它们的总和也与体积成正比。这保证了 $\Omega$ 的[广延性](@entry_id:144932)。相反，如果 $\Omega$ 与 $Z[0]$ 而非 $\ln Z[0]$ 相关，它将包含诸如 $(W[0])^2 \propto V^2$ 的项，这将违反[热力学](@entry_id:141121) [@problem_id:2989931, @problem_id:2989948]。

### [费曼图](@entry_id:144373)的规则：代数表达式的拓扑语言

费曼图的威力在于它为每个图提供了一套明确的规则，可将其直接翻译成一个代数表达式。这些规则包括[传播子](@entry_id:139558)、顶点因子、动量和[能量守恒](@entry_id:140514)，以及一些源于量子统计的微妙之处。

#### [费米子](@entry_id:146235)图的符号规则

对于[费米子](@entry_id:146235)系统，由于[泡利不相容原理](@entry_id:141850)，其[场算符](@entry_id:140269)遵循[反对易关系](@entry_id:153815)，这导致在计算费曼图时必须非常小心符号。符号的来源主要有两个：算符的[置换](@entry_id:136432)和[费米子](@entry_id:146235)环路。

1.  **[置换符号](@entry_id:153173)**: [威克定理](@entry_id:137086)的应用涉及到将一长串[费米子算符](@entry_id:149120)重新[排列](@entry_id:136432)成可收缩的配对。每次交换两个[费米子算符](@entry_id:149120)的位置，都会产生一个 $(-1)$ 的因子。因此，一个给定的图（对应一种特定的收缩方式）的符号是 $(-1)^P$，其中 $P$ 是将算符[排列](@entry_id:136432)成收缩对所需的交换次数 [@problem_id:2989929]。这构成了符号规则的代[数基](@entry_id:634389)础。

2.  **[费米子](@entry_id:146235)环路**: 上述代数规则的一个极其重要的拓扑推论是：图中的**每一个闭合的[费米子](@entry_id:146235)环路 (closed fermion loop) 都会贡献一个 $(-1)$ 的因子** [@problem_id:2989929]。这个规则至关重要，不可或缺。

3.  **外部线交换**: [费米子](@entry_id:146235)的[反对称性](@entry_id:261893)也体现在[格林函数](@entry_id:147802)本身的对称性上。交换任意两个外部的[费米子](@entry_id:146235)腿（例如，交换两个出射粒子的坐标）会使整个格林函数（即所有贡献图的总和）变号。这是泡利原理在多体振幅中的直接体现 [@problem_id:2989929]。

因此，一个[费米子](@entry_id:146235)图的完整符号由 $(-1)^{L+P}$ 给出，其中 $L$ 是闭合[费米子](@entry_id:146235)环路数，$P$ 是外部线和收缩线[交叉](@entry_id:147634)所贡献的[置换符号](@entry_id:153173)。

#### 组合[对称因子](@entry_id:274828)

除了符号，每个图还有一个数值前因子，称为**[对称因子](@entry_id:274828) (symmetry factor)** $S$。它的出现是因为[微扰展开](@entry_id:159275)中的 $1/n!$ 因子和拉格朗日量中[相互作用项](@entry_id:637283) $\lambda/m! \phi^m$ 的 $1/m!$ 因子，与通过威克收缩生成一个特定拓扑图的方式数相互作用的结果。一个图的最终贡献需要除以其[对称因子](@entry_id:274828) $S$。

计算[对称因子](@entry_id:274828) $S$ 的最可靠方法是确定该图的**[自同构群](@entry_id:139672) (automorphism group) 的阶**。[自同构](@entry_id:155390)是指在保持外部线固定的情况下，对图的内部线和顶点进行[置换](@entry_id:136432)，而使图的拓扑结构保持不变的操作。$S$ 就是这种操作的总数。

让我们通过一个具体的例子来说明。考虑一个具有 $\frac{\lambda}{4!}\phi^4$ 相互作用的实[标量场](@entry_id:151443)理论。对[配分函数](@entry_id:193625)的最低阶（$\lambda$ 的一阶）修正来自于对 $\langle \phi^4 \rangle_0$ 的计算。根据[威克定理](@entry_id:137086)，四个在同时同一点的[场算符](@entry_id:140269)有 3 种不同的配对方式（例如，(12)(34), (13)(24), (14)(23)）。每种配对都产生两个传播子，它们都从该顶点开始并结束，形成一个“8”字形的双环真[空图](@entry_id:275064)。这 3 种威克收缩方式都对应于同一个拓扑图。[微扰展开](@entry_id:159275)中来自 $\exp(-S_{\mathrm{int}})$ 的因子是 $1/1!$，而相互作用项本身包含一个 $1/4!$ 的因子。因此，该图的权重是 $\frac{1}{1!} \times \frac{\lambda}{4!} \times 3 \times (\text{积分})$。通常我们将顶点定义为 $-\lambda$，那么这个图的数值前因子就是 $\frac{3}{4!} = \frac{3}{24} = \frac{1}{8}$。这个 $1/8$ 就是[对称因子](@entry_id:274828) $S$ 的倒数，即 $S=8$ [@problem_id:2989967]。

我们也可以通过计算[自同构群](@entry_id:139672)的阶来得到 $S=8$：
*   交换两个完全相同的环路：2 种方式。
*   对于每个环路，由于标量[传播子](@entry_id:139558)是无向的，可以翻转其两个“半部分”：2 种方式。
*   由于有两个环路，这贡献了 $2 \times 2 = 4$ 种方式。
总的[对称操作](@entry_id:143398)数是 $S = 2 \times 4 = 8$。

另一个常见的例子是 $\phi^4$ 理论中对两点函数的两圈“落日图”(setting-sun diagram)。它由两个顶点和连接它们的三条内部[传播子](@entry_id:139558)线组成。
*   交换两个等价的顶点：$2! = 2$ 种方式。
*   交换连接相同两个顶点的三条等价的内部线：$3! = 6$ 种方式。
总的[对称因子](@entry_id:274828)是 $S = 2! \times 3! = 12$ [@problem_id:1137481]。
对于更复杂的图，例如 $\phi^3$ 理论中的一个两圈[顶点修正](@entry_id:146982)图，其中两个内部顶点通过两条平行的[传播子](@entry_id:139558)连接，其对称性来自于交换这两条[平行线](@entry_id:169007)，因此 $S=2$ [@problem_id:1137500]。而一个由三个顶点构成的四圈真[空图](@entry_id:275064)，其中每对顶点都由两条[传播子](@entry_id:139558)连接，其[对称因子](@entry_id:274828)则为 $S=48$ [@problem_id:1137503]。

### [戴森方程](@entry_id:146246)：[重整化](@entry_id:143501)[微扰级数](@entry_id:266790)

虽然原则上我们可以计算任意阶的费曼图，但直接的[微扰展开](@entry_id:159275)在许多情况下（例如在[相变](@entry_id:147324)点附近或存在强关联时）会失效。一种更强大的方法是**重整化 (resumming)** [微扰级数](@entry_id:266790)，即将无穷多个图按其拓扑结构分类并求和。**[戴森方程](@entry_id:146246) (Dyson equation)** 正是实现这一目标的核心工具。

这个想法的关键在于对贡献给完整传播子 $G$ 的联通图进行分类。一个图如果可以通过切断**一条**内部[传播子](@entry_id:139558)线而被分成两个不相连的部分（分别连接到入线和出线），则称该图是**单粒子可约的 (one-particle reducible, 1PR)**。如果不存在这样的线，则该图是**单粒子不可约的 (one-particle irreducible, 1PI)** [@problem_id:2989974]。

现在，我们定义一个核心量，**[自能](@entry_id:145608) (self-energy)** $\Sigma$，作为所有 1PI 两点图（并切除外部[传播子](@entry_id:139558)腿）的总和 [@problem_id:2989974, @problem_id:2785475]。自能 $\Sigma$ 可以看作是粒子在传播过程中受到的所有不可简化为“在一个传播子中插入更简单过程”的相互作用的总和。

有了这个定义，任何对完整传播子 $G$ 有贡献的联通图，要么是裸[传播子](@entry_id:139558) $G_0$ 本身，要么可以唯一地看作是一系列 1PI 块（即 $\Sigma$）串在裸传播子 $G_0$ 链上。因此，完整[传播子](@entry_id:139558) $G$ 可以写成一个[几何级数](@entry_id:158490)：
$$ G = G_0 + G_0 \Sigma G_0 + G_0 \Sigma G_0 \Sigma G_0 + \dots $$
这个级数可以被精确地求和，得到[戴森方程](@entry_id:146246)的积分形式：
$$ G(1,2) = G_0(1,2) + \int d3 \int d4 \, G_0(1,3) \Sigma(3,4) G(4,2) $$
在动量-频率空间中，卷积变成乘积，方程简化为代数形式：
$$ G(k) = G_0(k) + G_0(k) \Sigma(k) G(k) $$
或更紧凑的逆形式：
$$ G(k)^{-1} = G_0(k)^{-1} - \Sigma(k) $$
[戴森方程](@entry_id:146246)是一个精确的关系。它将计算整个[无穷级数](@entry_id:143366)的问题，转化为了计算（通常更少且更简单的）1PI 图以得到自能 $\Sigma$ 的问题。例如，最低阶的[自能](@entry_id:145608)是**[Hartree-Fock近似](@entry_id:146529)**。对于一个相互作用的电子气，它包含一个直接（哈特里）项和一个交换（福克）项。福克[自能](@entry_id:145608)的图是一个单圈图，其计算结果给出了对[单粒子能量](@entry_id:160812)的修正，该修正依赖于动量 [@problem_id:1137495]。定义 $\Sigma$ 时只包含 1PI 图是至关重要的，因为任何 1PR 图都会在[戴森方程](@entry_id:146246)的迭代中被自动生成。如果将 1PR 图包含在 $\Sigma$ 的定义中，将会导致**重复计算 (double counting)** [@problem_id:2785475]。

### 自洽方法与[守恒近似](@entry_id:139611)

[戴森方程](@entry_id:146246)为**自洽 (self-consistent)** 计算打开了大门。在最简单的微扰理论中，我们用裸[传播子](@entry_id:139558) $G_0$ 来计算[自能](@entry_id:145608)图，得到 $\Sigma[G_0]$。但一个更精确的方法是将[自能](@entry_id:145608)看作是**完整**[传播子](@entry_id:139558) $G$ 的一个泛函，即 $\Sigma[G]$，然后与[戴森方程](@entry_id:146246)联立求解：
$$ G^{-1} = G_0^{-1} - \Sigma[G] $$
这意味着传播子 $G$ 既决定了自能，又被[自能](@entry_id:145608)所决定，必须通过迭代求解直至收敛。

在构建自能泛函 $\Sigma[G]$ 时，我们必须只使用**[骨架图](@entry_id:147556) (skeleton diagrams)**，即那些内部线都是完整[传播子](@entry_id:139558) $G$ 且本身不包含任何自能插入的 1PI 图。这样做是为了避免重复计算，因为[戴森方程](@entry_id:146246)的自洽过程会自动为[骨架图](@entry_id:147556)的内部线“穿上”所有可能的[自能修正](@entry_id:754667) [@problem_id:2981227]。一个自洽的二阶骨架自能 $\Sigma^{(2)}[G]$，如果我们用 $G$ 的[微扰展开](@entry_id:159275) $G = G_0 + G_0\Sigma^{(1)}G_0 + \dots$ 代入，它会生成对应于更高阶非[骨架图](@entry_id:147556)的项。因此，如果我们在自洽计算之外再显式地加入这些非[骨架图](@entry_id:147556)，就会导致重复计算 [@problem_id:2981227]。

自洽方法的一个重要优点是它可以构建**[守恒近似](@entry_id:139611) (conserving approximations)**，即满足宏观守恒律（如粒子数、动量和[能量守恒](@entry_id:140514)）的[近似方案](@entry_id:267451)。Baym和Kadanoff证明，如果一个近似中的[自能](@entry_id:145608)可以从一个称为**[Luttinger-Ward泛函](@entry_id:138202)** $\Phi[G]$ 的标量泛函通过泛函求导 $\Sigma[G] = \delta\Phi[G]/\delta G$ 得到，那么这个近似就是守恒的。通过选择 $\Phi[G]$ 的[骨架图](@entry_id:147556)展开的不同截断，可以系统地生成一系列[守恒近似](@entry_id:139611) [@problem_id:2981227]。

一个著名的例子是**随机相近似 (Random Phase Approximation, RPA)**。它通过对粒子-空穴“气泡”图构成的[无穷级数求和](@entry_id:161691)，来计算系统的动力学[响应函数](@entry_id:142629)或有效相互作用。例如，在电子气中，RPA给出了动力学屏蔽的[库仑相互作用](@entry_id:747947) $W(\mathbf{q}, \omega) = V(\mathbf{q}) / (1 - V(\mathbf{q}) \Pi_0(\mathbf{q}, \omega))$，其中 $\Pi_0$ 是裸极化气泡。这个[屏蔽相互作用](@entry_id:136395)的极点揭示了系统的[集体激发](@entry_id:145026)——**[等离激元](@entry_id:146184) (plasmon)** [@problem_id:1137492]。类似地，对粒子-空穴“阶梯”图求和，可以得到相互作用系统的[自旋磁化率](@entry_id:141223) $\chi(\mathbf{q}, \omega)$。在静态均匀极限下，它给出了著名的**斯托纳增强 (Stoner enhancement)** 因子 $S = \chi(0,0)/\chi_0(0,0) = 1/(1 - U N(E_F))$，它描述了相互作用如何增强系统的铁磁倾向 [@problem_id:1137458]。

### 不同理论框架下的[费曼规则](@entry_id:156797)

费曼图的规则会根据所研究的物理情境（零温、有限温或非[平衡态](@entry_id:168134)）而有所调整，主要体现在频率/能量变量的处理上。

#### 有限温下的松原形式 (Matsubara Formalism)

在有限温度 $T$ 的[平衡态](@entry_id:168134)下，我们使用**虚时形式 (imaginary-time formalism)**。时间变量 $\tau$ 在 $[0, \beta)$ 区间内取值，其中 $\beta=1/(k_B T)$。
*   **边界条件**: 由于迹的循环不变性，[费米子](@entry_id:146235)（[玻色子](@entry_id:138266)）[格林函数](@entry_id:147802)在虚时中满足反周期（周期）边界条件：$G(\tau) = -G(\tau+\beta)$。
*   **[松原频率](@entry_id:197724)**: 这一边界条件导致频率变量是离散的，称为**[松原频率](@entry_id:197724) (Matsubara frequencies)**。[费米子](@entry_id:146235)的[松原频率](@entry_id:197724)为 $\omega_n = (2n+1)\pi/\beta$，[玻色子](@entry_id:138266)的为 $\nu_m = 2m\pi/\beta$，其中 $n,m$ 为整数。
*   **规则总结**:
    1.  [传播子](@entry_id:139558)线对应于 $G_0(\mathbf{k}, i\omega_n) = 1/(i\omega_n - \xi_\mathbf{k})$。
    2.  每个顶点贡献一个因子（例如，对于 $U n_\uparrow n_\downarrow$ 相互作用，因子是 $-U$），并且动量和[松原频率](@entry_id:197724)在顶点处守恒。
    3.  对所有独立的内部动量和内部[松原频率求和](@entry_id:194908)，形式为 $\frac{1}{V}\sum_\mathbf{k}$ 和 $\frac{1}{\beta}\sum_{i\omega_n}$。
    4.  每个闭合的[费米子](@entry_id:146235)环路贡献一个 $(-1)$ 因子 [@problem_id:2989977]。

#### 非平衡态下的Keldysh形式 (Keldysh Formalism)

当系统不在[平衡态](@entry_id:168134)或受时间依赖的场驱动时，需要使用**实时的[非平衡格林函数](@entry_id:201883)方法**，其中最常用的是**Keldysh形式**。
*   **Keldysh路径**: [时间演化](@entry_id:153943)在一个从 $t_0 \to \infty$（前向分支 $+$）再返回到 $t_0$（后向分支 $-$）的**Keldysh路径** $\mathcal{C}$上进行。
*   **矩阵结构**: [场算符](@entry_id:140269)和顶点现在都带有一个分支指标（$+$ 或 $-$）。[格林函数](@entry_id:147802)因此变成一个 $2 \times 2$ 矩阵，其分量 $G^{\alpha\beta}$（其中 $\alpha, \beta \in \{+,-\}$）取决于[场算符](@entry_id:140269)所在的分支。例如，$G^{+-}(t,t')=G^<(t,t')$（[小格林函数](@entry_id:141540)）和 $G^{-+}(t,t')=G^>(t,t')$（[大格林函数](@entry_id:142137)）。
*   **物理分量**: 物理上有意义的[格林函数](@entry_id:147802)是**推迟 (Retarded, R)**、**超前 (Advanced, A)** 和 **Keldysh (K)** 分量，它们是矩阵分量的[线性组合](@entry_id:154743)。例如，对于[费米子](@entry_id:146235)，$G^R(t,t') = -\mathrm{i}\theta(t-t')\langle [\psi(t), \psi^\dagger(t')]_+ \rangle$ 和 $G^K(t,t') = -\mathrm{i}\langle [\psi(t), \psi^\dagger(t')]_-\rangle$ [@problem_id:2981251]。
*   **图规则**: 顶点规则取决于其所在的分支：在前向分支上的顶点贡献因子 $-\mathrm{i} H_{\mathrm{int}}$，而在后向分支上的顶点贡献 $+\mathrm{i} H_{\mathrm{int}}$。计算时必须对所有顶点在两个分支上的所有可能[排列](@entry_id:136432)求和 [@problem_id:2981251]。
*   **因果结构**: 在所谓的“RA”基底下，[格林函数](@entry_id:147802)和自能矩阵都具有上三角结构，即 $\begin{pmatrix} G^R & G^K \\ 0 & G^A \end{pmatrix}$。这个因果结构极大地简化了非[平衡问题](@entry_id:636409)的计算 [@problem_id:2981251]。

通过掌握这些基本原理和机制，我们不仅能够理解[费曼图](@entry_id:144373)的含义，更能够运用它们作为强大的计算工具，来探索多体世界中丰富而复杂的物理现象。