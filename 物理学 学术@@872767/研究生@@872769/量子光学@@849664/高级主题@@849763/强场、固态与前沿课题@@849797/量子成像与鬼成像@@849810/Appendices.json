{"hands_on_practices": [{"introduction": "为了打下坚实的基础，我们从一个使用热光源的经典鬼成像场景开始。这个练习 [@problem_id:718454] 将引导你推导鬼成像的分辨率，从数学上展示图像是如何从两条光路之间的关联中浮现出来的。你将看到，最终的图像分辨率不仅取决于物体的特征，还取决于光源本身的空间相干性。", "problem": "考虑一个无透镜鬼成像装置。一个部分相干光源，建模为混沌热光源，位于平面 $z=0$ 处。源场 $E_s(\\mathbf{r})$ 的互相干函数由一个稳态高斯分布给出：\n$$ \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle = I_0 \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right) $$\n其中 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 是 $z=0$ 处的横向位置矢量，$I_0$ 是平均强度，$\\sigma_c$ 表示横向相干长度。位于 $z=0$ 处的一个 50/50 分束器将光束分成两条路径。\n\n1.  **测试光路：** 光束在自由空间中传播距离 $d$ 到达物平面。物体是一个薄高斯光阑，其光强透射函数为 $T(\\mathbf{r}_o) = \\exp(-|\\mathbf{r}_o|^2/\\sigma_a^2)$，其中 $\\mathbf{r}_o$ 是物平面中的横向坐标，$\\sigma_a$ 是光阑的特征半径。总透射光强由一个桶探测器（一个对所有横向空间坐标进行积分的探测器）测量。\n2.  **参考光路：** 光束在自由空间中传播距离 $d$（与测试光路中的距离相同）到达一个高分辨率探测器，例如CCD相机。该探测器测量强度分布 $I_R(\\mathbf{r}_r)$，其中 $\\mathbf{r}_r$ 是参考探测器平面中的横向坐标。\n\n鬼像通过计算两个探测器之间强度涨落的关联来重建。图像轮廓由 $G(\\mathbf{r}_r) = \\langle \\Delta I_T \\Delta I_R(\\mathbf{r}_r) \\rangle$ 给出，其中 $I_T$ 是桶探测器信号，$\\Delta I = I - \\langle I \\rangle$ 表示强度涨落。对于热光源，该关联与场互相关的模平方成正比，并在物体的光阑上积分：\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, \\left| \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle \\right|^2 $$\n其中 $E_T(\\mathbf{r}_o)$ 是物平面处（物体之前）的场，$E_R(\\mathbf{r}_r)$ 是参考探测器平面处的场。\n\n得到的鬼像轮廓 $G(\\mathbf{r}_r)$ 是关于 $\\mathbf{r}_r$ 的高斯函数：$G(\\mathbf{r}_r) \\propto \\exp(-|\\mathbf{r}_r|^2/\\sigma_g^2)$。推导这个重建鬼像的平方宽度 $\\sigma_g^2$。\n\n使用自由空间传播的傍轴近似（菲涅尔衍射积分）。距离源平面 $z$ 处，场 $E(\\mathbf{r}, z)$ 由源场 $E_s(\\mathbf{r}')$ 给出：\n$$ E(\\mathbf{r}, z) = \\frac{-ik}{2\\pi z} e^{ikz} \\int d^2\\mathbf{r}' E_s(\\mathbf{r}') \\exp\\left(\\frac{ik}{2z} |\\mathbf{r} - \\mathbf{r}'|^2\\right) $$\n其中 $k$ 是波数。", "solution": "鬼像的轮廓由物体的透射函数 $T(\\mathbf{r}_o)$ 与两臂场互相关函数 $C(\\mathbf{r}_o, \\mathbf{r}_r) = \\langle E_T^*(\\mathbf{r}_o) E_R(\\mathbf{r}_r) \\rangle$ 的模平方的卷积给出：\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\, T(\\mathbf{r}_o) \\, |C(\\mathbf{r}_o, \\mathbf{r}_r)|^2 $$\n\n**1. 计算互相关函数 $C(\\mathbf{r}_o, \\mathbf{r}_r)$**\n\n首先，我们利用菲涅尔衍射积分表示物平面处的场 $E_T(\\mathbf{r}_o)$ 和参考探测器平面处的场 $E_R(\\mathbf{r}_r)$：\n$$ E_T(\\mathbf{r}_o) = \\int d^2\\mathbf{r}_1 P(\\mathbf{r}_o, \\mathbf{r}_1; d) E_s(\\mathbf{r}_1) $$\n$$ E_R(\\mathbf{r}_r) = \\int d^2\\mathbf{r}_2 P(\\mathbf{r}_r, \\mathbf{r}_2; d) E_s(\\mathbf{r}_2) $$\n其中 $P(\\mathbf{r}, \\mathbf{r}'; d) = \\frac{-ik}{2\\pi d} e^{ikd} \\exp\\left(\\frac{ik}{2d}|\\mathbf{r}-\\mathbf{r}'|^2\\right)$ 是傍轴传播算子。\n\n将它们代入互相关函数的定义中：\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) = \\iint d^2\\mathbf{r}_1 d^2\\mathbf{r}_2 P^*(\\mathbf{r}_o, \\mathbf{r}_1; d) P(\\mathbf{r}_r, \\mathbf{r}_2; d) \\langle E_s^*(\\mathbf{r}_1) E_s(\\mathbf{r}_2) \\rangle $$\n代入给定的光源互相干函数和传播算子表达式（忽略常数比例因子）：\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) \\propto \\iint d^2\\mathbf{r}_1 d^2\\mathbf{r}_2 \\exp\\left(-\\frac{ik}{2d}|\\mathbf{r}_o - \\mathbf{r}_1|^2\\right) \\exp\\left(\\frac{ik}{2d}|\\mathbf{r}_r - \\mathbf{r}_2|^2\\right) \\exp\\left(-\\frac{|\\mathbf{r}_1 - \\mathbf{r}_2|^2}{2\\sigma_c^2}\\right) $$\n进行变量替换，令 $\\mathbf{u} = \\mathbf{r}_1 - \\mathbf{r}_2$ 和 $\\mathbf{U} = (\\mathbf{r}_1 + \\mathbf{r}_2)/2$。积分中与 $\\mathbf{U}$ 相关的项为 $\\exp\\left(\\frac{ik}{d}(\\mathbf{r}_o - \\mathbf{r}_r - \\mathbf{u})\\cdot\\mathbf{U}\\right)$。对 $\\mathbf{U}$ 积分会得到一个狄拉克 $\\delta$ 函数：$\\delta(\\mathbf{r}_o - \\mathbf{r}_r - \\mathbf{u})$，它将 $\\mathbf{u}$ 固定为 $\\mathbf{u} = \\mathbf{r}_o - \\mathbf{r}_r$。\n\n将此结果代入，并化简余下的相位项，我们发现所有相位因子都相互抵消，最终得到：\n$$ C(\\mathbf{r}_o, \\mathbf{r}_r) \\propto \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{2\\sigma_c^2}\\right) $$\n因此，互相关函数的模平方为：\n$$ |C(\\mathbf{r}_o, \\mathbf{r}_r)|^2 \\propto \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\n\n**2. 计算鬼像轮廓 $G(\\mathbf{r}_r)$**\n\n现在我们将 $|C(\\mathbf{r}_o, \\mathbf{r}_r)|^2$ 的结果代入 $G(\\mathbf{r}_r)$ 的表达式中：\n$$ G(\\mathbf{r}_r) \\propto \\int d^2\\mathbf{r}_o \\exp\\left(-\\frac{|\\mathbf{r}_o|^2}{\\sigma_a^2}\\right) \\exp\\left(-\\frac{|\\mathbf{r}_o - \\mathbf{r}_r|^2}{\\sigma_c^2}\\right) $$\n这个积分是两个高斯函数的卷积。一个高斯函数是物体的透射函数 $T(\\mathbf{r}_o)$，其平方宽度为 $\\sigma_a^2$。另一个是作为 $(\\mathbf{r}_o-\\mathbf{r}_r)$ 的函数的 $|C|^2$，其平方宽度为 $\\sigma_c^2$。\n\n两个形式为 $\\exp(-|\\mathbf{r}|^2/W^2)$ 且平方宽度分别为 $W_1^2$ 和 $W_2^2$ 的高斯函数的卷积，结果是另一个高斯函数，其平方宽度为 $W_1^2+W_2^2$。\n在本例中，$W_1^2 = \\sigma_a^2$ 且 $W_2^2 = \\sigma_c^2$。因此，鬼像轮廓 $G(\\mathbf{r}_r)$ 是一个关于 $\\mathbf{r}_r$ 的高斯函数，其平方宽度为：\n$$ \\sigma_g^2 = \\sigma_a^2 + \\sigma_c^2 $$\n这就是重建鬼像的平方宽度。", "answer": "$$ \\boxed{\\sigma_a^2 + \\sigma_c^2} $$", "id": "718454"}, {"introduction": "从经典领域进入量子世界，这个练习深入探讨了使用纠缠光子进行鬼成像的实际问题。我们将分析信噪比（$SNR$），这是衡量任何成像系统性能的关键指标 [@problem_id:718391]。通过这个计算，你将揭示探测器效率、暗计数和偶然符合计数率等实验参数如何共同决定量子鬼成像的质量和可行性。", "problem": "考虑一个纠缠光子鬼成像系统。一个光源以总速率 $R_p$ 产生空间纠缠的光子对（信号光子和闲置光子）。生成的双光子态表现出完美空间相关性，这意味着如果在横向位置 $\\vec{\\rho}$ 探测到闲置光子，则信号光子保证也处于相同的横向位置 $\\vec{\\rho}$。\n\n闲置光子直接传播到高分辨率探测器 $D_i$ 上，该探测器由相同像素的阵列组成。闲置光束均匀地照射在该探测器上一个面积为 $A_{beam}$ 的区域。每个像素的面积为 $A_{pix}$，暗计数率为 $D_i$。闲置光子探测器的量子效率为 $\\eta_i$。\n\n信号光子传播到一个物体，然后到达一个没有空间分辨率的桶探测器 $D_s$。信号光束也均匀地照射在物平面上一个面积为 $A_{beam}$ 的区域。物体是一个简单的二元掩模：一个覆盖整个光束区域的不透明屏幕，其中有一个面积为 $A_{obj}$ 的透射孔径位于光束内。桶探测器 $D_s$ 的量子效率为 $\\eta_s$，暗计数率为 $D_s$。\n\n如果来自 $D_s$ 和 $D_i$ 上特定像素的信号在符合时间窗 $\\tau_c$ 内到达，符合逻辑单元就记录一个事件。通过在总测量时间 $T_{meas}$ 内绘制 $D_i$ 每个像素的符合计数值来重建图像。\n\n假设任何过程的计数值都遵循泊松统计。用于对孔径成像的信号 ($S$) 定义为，其在物体上的对应位置是透射的像素的平均符合计数值 ($N_{on}$) 与其对应位置是不透明的像素的平均符合计数值 ($N_{off}$) 之间的差值。噪声 ($N$) 定义为此差值的标准差，$N = \\sqrt{\\mathrm{Var}(N_{on} - N_{off})}$，并假设对应透射位置（“on”）和不透射位置（“off”）的测量在统计上是独立的。\n\n推导对孔径成像的信噪比 $SNR = S/N$ 的表达式。你的最终答案应该用给定的参数表示：$R_p, \\eta_s, \\eta_i, D_s, D_i, A_{beam}, A_{obj}, A_{pix}, \\tau_c$ 和 $T_{meas}$。", "solution": "我们按照以下步骤推导信噪比 (SNR) 的表达式：\n\n1.  **计算单路计数率**：\n    闲置臂单个像素的总计数率 $R_i$ 是到达该像素的光子被探测到的速率与暗计数率之和：\n    $$ R_{i} = R_{p}\\frac{A_{\\text{pix}}}{A_{\\text{beam}}}\\eta_{i}+D_{i} $$\n    当物体孔径完全位于光束内时，信号臂桶探测器的总计数率 $R_s$ 为：\n    $$ R_{s} = R_{p}\\frac{A_{\\text{obj}}}{A_{\\text{beam}}}\\eta_{s}+D_{s} $$\n\n2.  **计算符合计数率**：\n    对于一个对应物体透射区域的“on”像素，其总符合计数率是真符合率 $R_t$ 与偶然符合率 $R_{acc}$ 之和。\n    真符合率 $R_t$ 是光子对中两个光子分别被两路探测器成功探测的速率：\n    $$ R_{t} = R_{p}\\frac{A_{\\text{pix}}}{A_{\\text{beam}}}\\eta_{i}\\eta_{s} $$\n    偶然符合率 $R_{acc}$ 由两路探测器的独立事件在符合时间窗 $\\tau_c$ 内随机重合引起：\n    $$ R_{acc}=R_{i}R_{s}\\tau_{c} $$\n\n3.  **计算总符合数和信号**：\n    在总测量时间 $T_{\\text{meas}}$ 内，“on”像素记录的总符合数 $N_{on}$ 和“off”像素记录的总符合数 $N_{off}$ 分别为：\n    $$ N_{on}=(R_{t}+R_{acc})T_{\\text{meas}} $$\n    $$ N_{off}=R_{acc}T_{\\text{meas}} $$\n    信号 $S$ 定义为两者的差值：\n    $$ S = N_{on} - N_{off} = R_{t}T_{\\text{meas}} $$\n\n4.  **计算噪声**：\n    噪声 $N$ 是信号 $S$ 的标准差。由于“on”和“off”的测量是独立的泊松过程，$\\text{Var}(N_{on}-N_{off}) = \\text{Var}(N_{on}) + \\text{Var}(N_{off})$。对于泊松统计，$\\text{Var}(N_{count}) = \\langle N_{count} \\rangle$。因此：\n    $$ N^2 = \\text{Var}(S) = \\langle N_{on} \\rangle + \\langle N_{off} \\rangle = (R_t + R_{acc})T_{\\text{meas}} + R_{acc}T_{\\text{meas}} = (R_t + 2R_{acc})T_{\\text{meas}} $$\n    所以噪声为 $N = \\sqrt{(R_{t}+2R_{acc})T_{\\text{meas}}}$。\n\n5.  **计算信噪比 (SNR)**：\n    $$ \\mathrm{SNR}=\\frac{S}{N} = \\frac{R_{t}T_{\\text{meas}}}{\\sqrt{(R_{t}+2R_{acc})T_{\\text{meas}}}} = \\frac{R_{t}\\sqrt{T_{\\text{meas}}}}{\\sqrt{R_{t}+2R_{acc}}} $$\n    将 $R_t$ 和 $R_{acc}$ 的表达式代入，得到最终结果。", "answer": "$$\\boxed{\n\\frac{R_{p}\\frac{A_{\\text{pix}}}{A_{\\text{beam}}}\\eta_{i}\\eta_{s}\\sqrt{T_{\\text{meas}}}}\n{\\sqrt{\nR_{p}\\frac{A_{\\text{pix}}}{A_{\\text{beam}}}\\eta_{i}\\eta_{s}\n+2\\bigl(R_{p}\\frac{A_{\\text{pix}}}{A_{\\text{beam}}}\\eta_{i}+D_{i}\\bigr)\n\\bigl(R_{p}\\frac{A_{\\text{obj}}}{A_{\\text{beam}}}\\eta_{s}+D_{s}\\bigr)\\tau_{c}\n}}\n}$$", "id": "718391"}, {"introduction": "最后，我们转向计算鬼成像（CGI），这是一种功能强大且灵活的现代技术。这个问题 [@problem_id:718477] 探讨了真实实验装置中的不完美之处如何给重建图像带来伪影。通过分析探测器噪声对标准重建算法的影响，你将发现背景偏压的来源，并对硬件限制与数据处理之间的相互作用有更深刻的理解。", "problem": "在一个计算鬼成像 (CGI) 实验中，通过将一系列已知的随机强度图案与来自单像素“桶”探测器的相应总强度测量值进行关联，来对物体进行成像。\n\n考虑一个具有以下特征的 CGI 设置：\n1.  图案显示在一个总共有 $M$ 个像素的空间光调制器 (SLM) 上。\n2.  使用一个包含 $N$ 个随机二进制图案的序列 $\\{P_n(\\vec{\\rho}_k)\\}_{n=1}^N$，其中 $\\vec{\\rho}_k$ 是第 $k$ 个像素的位置 ($k=1, \\dots, M$)。\n3.  对于任意给定的图案 $n$ 和像素 $k$，其值 $P_{n,k} \\equiv P_n(\\vec{\\rho}_k)$ 为 $1$ (光开) 或 $0$ (光关)。这些图案在像素之间以及每次实现之间都是统计独立的。任何像素为“开”的概率是 $P(P_{n,k}=1) = p$。\n4.  物体由一个透射函数 $T_k \\equiv T(\\vec{\\rho}_k)$ 描述。穿过物体的光被桶探测器收集。\n5.  桶探测器对第 $n$ 个图案测得的信号 $I_n$ 由两部分组成：与总透射光成正比的信号和噪声信号。\n    -   光致信号为 $I_{s,n} = \\eta \\sum_{k=1}^M P_{n,k} T_k$，其中 $\\eta$ 是探测效率。\n    -   总噪声信号有两个分量：一个来自探测器固有的恒定暗计数水平 $D_0$，另一个是附加的图案相关噪声分量。这种相关噪声源于电子串扰，并与图案中“开”像素的总数成正比，由 $\\beta \\sum_{k=1}^M P_{n,k}$ 给出，其中 $\\beta$ 是一个耦合系数。\n    -   因此，总信号为 $I_n = \\eta \\sum_{k=1}^M P_{n,k} T_k + D_0 + \\beta \\sum_{k=1}^M P_{n,k}$。\n6.  图像 $G_k$ 使用标准的差分关联公式重建：\n    $$ G_k = \\langle I_n P_{n,k} \\rangle_n - \\langle I_n \\rangle_n \\langle P_{n,k} \\rangle_n $$\n    其中 $\\langle \\cdot \\rangle_n$ 表示对所有 $N$ 个图案的平均。\n\n假设图案数量 $N$ 足够大，可以用统计期望值代替样本平均值，请推导重建图像中背景偏置 $B$ 的表达式。背景偏置是重建信号 $G_k$ 中空间均匀且与物体透射函数 $T_k$ 无关的部分。", "solution": "我们的目标是计算重建图像 $G_k$ 中与物体 $T_k$ 无关的背景偏置项。\n$$G_k=\\langle I_nP_{n,k}\\rangle - \\langle I_n\\rangle\\langle P_{n,k}\\rangle$$\n桶探测器信号为：\n$$I_n=\\eta\\sum_{j=1}^M P_{n,j}T_j+D_0+\\beta\\sum_{j=1}^M P_{n,j} $$\n由于图案是统计独立的，我们有 $\\langle P_{n,k} \\rangle = p$ 和 $\\langle P_{n,j}P_{n,k}\\rangle = \\begin{cases} p  j=k \\\\ p^2  j \\neq k \\end{cases}$。\n\n**1. 计算第一项 $\\langle I_n P_{n,k} \\rangle$**\n$$\n\\langle I_n P_{n,k} \\rangle = \\left\\langle \\left( \\eta\\sum_{j} P_{n,j}T_j + D_0 + \\beta\\sum_{j} P_{n,j} \\right) P_{n,k} \\right\\rangle\n$$\n$$\n= \\eta \\sum_{j} T_j \\langle P_{n,j}P_{n,k} \\rangle + D_0 \\langle P_{n,k} \\rangle + \\beta \\sum_{j} \\langle P_{n,j}P_{n,k} \\rangle\n$$\n我们将对 $j$ 的求和分为 $j=k$ 和 $j \\neq k$ 两部分：\n$$\n= \\eta \\left( T_k \\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k} T_j \\langle P_{n,j}P_{n,k} \\rangle \\right) + D_0 p + \\beta \\left( \\langle P_{n,k}^2 \\rangle + \\sum_{j \\neq k} \\langle P_{n,j}P_{n,k} \\rangle \\right)\n$$\n$$\n= \\eta \\left( pT_k + p^2 \\sum_{j \\neq k} T_j \\right) + D_0 p + \\beta \\left( p + (M-1)p^2 \\right)\n$$\n\n**2. 计算第二项 $\\langle I_n \\rangle \\langle P_{n,k} \\rangle$**\n首先计算 $\\langle I_n \\rangle$：\n$$\n\\langle I_n \\rangle = \\left\\langle \\eta\\sum_{j} P_{n,j}T_j+D_0+\\beta\\sum_{j} P_{n,j} \\right\\rangle = \\eta \\sum_{j} \\langle P_{n,j} \\rangle T_j + D_0 + \\beta \\sum_{j} \\langle P_{n,j} \\rangle\n$$\n$$\n= \\eta p \\sum_j T_j + D_0 + \\beta M p\n$$\n然后乘以 $\\langle P_{n,k} \\rangle = p$：\n$$\n\\langle I_n \\rangle \\langle P_{n,k} \\rangle = p \\left( \\eta p \\sum_j T_j + D_0 + \\beta M p \\right) = \\eta p^2 \\sum_j T_j + p D_0 + \\beta M p^2\n$$\n\n**3. 计算 $G_k$ 并提取背景偏置**\n将上述两项结果相减：\n$$\nG_k = \\left[ \\eta \\left( pT_k + p^2 \\sum_{j \\neq k} T_j \\right) + D_0 p + \\beta \\left( p + (M-1)p^2 \\right) \\right] - \\left[ \\eta p^2 \\sum_j T_j + p D_0 + \\beta M p^2 \\right]\n$$\n我们分别处理与 $\\eta$, $D_0$, $\\beta$ 相关的项：\n-   $\\eta$ 项: $\\eta(pT_k + p^2\\sum_{j \\neq k} T_j - p^2\\sum_j T_j) = \\eta(pT_k - p^2 T_k) = \\eta p(1-p)T_k$。\n-   $D_0$ 项: $D_0 p - D_0 p = 0$。\n-   $\\beta$ 项: $\\beta(p + Mp^2 - p^2) - \\beta M p^2 = \\beta p(1-p)$。\n\n合并所有项得到：\n$$ G_k=\\eta p(1-p)T_k+\\beta p(1-p) $$\n重建的图像 $G_k$ 由两部分组成：与物体透射函数 $T_k$ 成正比的信号项，和一个与 $T_k$ 无关的空间均匀背景项。\n因此，背景偏置 $B$ 为：\n$$ B = \\beta p(1-p) $$", "answer": "$$\\boxed{\\beta p(1-p)}$$", "id": "718477"}]}