{"hands_on_practices": [{"introduction": "量子密钥分发的核心优势在于其可证明的安全性，即任何窃听行为都必然会干扰量子信道，从而被合法用户发现。这个练习将通过分析最典型的一种窃听策略——“拦截-重发”攻击，来具体地阐明这一基本原理。通过计算在这种攻击下产生的量子比特错误率（QBER），您将亲手验证为何窃听者Eve无法在不留下痕迹的情况下获取密钥信息，并理解为何由此产生的25%的错误率是BB84协议安全性的一个标志性体现。", "problem": "在用于量子密钥分发的BB84协议中，Alice向Bob发送单光子（量子比特）。她使用两个随机选择的基中的一个来编码她的比特“0”和“1”：\n1.  矩形基（Z基）：$\\{|0\\rangle, |1\\rangle\\}$\n2.  对角基（X基）：$\\{|+\\rangle, |-\\rangle\\}$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$ 且 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$。\n\n一个窃听者Eve进行拦截重发攻击。她拦截来自Alice的每一个量子比特，用她自己选择的基进行测量，然后制备一个处于她测量得到的状态的新量子比特发送给Bob。Eve不知道Alice为每个量子比特选择的基。她的策略是概率性地选择她的测量基：她以概率$p$选择Z基，以概率$1-p$选择X基。\n\n传输完成后，Alice和Bob执行筛选：他们通过一个公共信道通信，以比较他们选择的基，并丢弃任何他们使用了不同基的比特。剩余的比特序列就是筛选后的密钥。量子比特误码率（QBER）是这个筛选后的密钥中Bob接收错误的比特所占的比例。\n\n假设Alice对于每次传输都以均匀概率选择她的基（Z或X）和她的比特值（“0”或“1”）。给定Eve选择基的概率为$p = 1/3$，推导Alice和Bob将在他们筛选后的密钥中观察到的期望QBER。", "solution": "量子比特误码率（QBER）是针对筛选后的密钥计算的，该密钥只包含Alice和Bob使用相同测量基的比特。由于Alice是均匀随机地选择她的基，筛选后的比特中将有一半对应于双方都使用Z基的情况，另一半对应于双方都使用X基的情况。我们需要计算每种情况下的错误率，然后将它们平均。\n\n设 $Q_Z$ 为Alice和Bob都使用Z基时的错误率。\n设 $Q_X$ 为Alice和Bob都使用X基时的错误率。\n\n**1. 计算 $Q_Z$ (Alice和Bob使用Z基)**\n\n不失一般性，假设Alice发送状态 $|0\\rangle$。\nEve拦截这个量子比特。\n- 以概率 $p$，Eve选择Z基。她测量 $|0\\rangle$ 并以概率1正确地将其识别为状态 $|0\\rangle$。然后她将 $|0\\rangle$ 发送给Bob。Bob使用Z基测量，得到 $|0\\rangle$。在这种情况下，没有错误发生。对错误率的贡献是 $p \\times 0 = 0$。\n- 以概率 $1-p$，Eve选择X基。她在 $\\{|+\\rangle, |-\\rangle\\}$ 基中测量状态 $|0\\rangle$。该状态可以写成 $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$。\n    - Eve以概率 $|\\langle+|0\\rangle|^2 = 1/2$ 测量到 $|+\\rangle$。然后她将 $|+\\rangle$ 发送给Bob。\n    - Eve以概率 $|\\langle-|0\\rangle|^2 = 1/2$ 测量到 $|-\\rangle$。然后她将 $|-\\rangle$ 发送给Bob。\n\n现在，Bob在Z基中测量他从Eve那里收到的状态。\n- 如果Bob收到 $|+\\rangle$，他进行测量。状态为 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。Bob以概率 $1/2$ 测量到 $|0\\rangle$（正确），以概率 $1/2$ 测量到 $|1\\rangle$（错误）。\n- 如果Bob收到 $|-\\rangle$，他进行测量。状态为 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。Bob以概率 $1/2$ 测量到 $|0\\rangle$（正确），以概率 $1/2$ 测量到 $|1\\rangle$（错误）。\n\n当Eve使用X基时，发生错误的概率是 $1/2$。\n总错误率 $Q_Z$ 是所有导致错误的路径的概率之和：\n$$Q_Z = p \\cdot (0) + (1-p) \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures +}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures -}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right]$$\n$$Q_Z = (1-p) \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{1-p}{2}$$\n\n**2. 计算 $Q_X$ (Alice和Bob使用X基)**\n\n不失一般性，假设Alice发送状态 $|+\\rangle$。\nEve拦截这个量子比特。\n- 以概率 $p$，Eve选择Z基。她测量 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。\n    - Eve以概率 $1/2$ 测量到 $|0\\rangle$ 并发送 $|0\\rangle$。\n    - Eve以概率 $1/2$ 测量到 $|1\\rangle$ 并发送 $|1\\rangle$。\nBob接收到这个状态并在X基中测量。\n- 如果Bob收到 $|0\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle + |-\\rangle)$，他以概率 $1/2$ 测量到 $|+\\rangle$（正确），以概率 $1/2$ 测量到 $|-\\rangle$（错误）。\n- 如果Bob收到 $|1\\rangle = \\frac{1}{\\sqrt{2}}(|+\\rangle - |-\\rangle)$，他以概率 $1/2$ 测量到 $|+\\rangle$（正确），以概率 $1/2$ 测量到 $|-\\rangle$（错误）。\n如果Eve使用Z基，发生错误的概率是 $1/2$。\n- 以概率 $1-p$，Eve选择X基。她正确地测量到 $|+\\rangle$，将 $|+\\rangle$ 发送给Bob，Bob也测量到 $|+\\rangle$。没有错误发生。对错误率的贡献是 $(1-p) \\times 0 = 0$。\n\n总错误率 $Q_X$ 是：\n$$Q_X = p \\cdot \\left[ \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 0}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} + \\left(\\frac{1}{2}\\right)_{\\text{Eve measures 1}} \\cdot \\left(\\frac{1}{2}\\right)_{\\text{Bob gets error}} \\right] + (1-p) \\cdot (0)$$\n$$Q_X = p \\left( \\frac{1}{4} + \\frac{1}{4} \\right) = \\frac{p}{2}$$\n\n**3. 计算总QBER**\n\n由于Alice均匀选择她的基，最终筛选后的密钥平均会包含等量的来自Z基和X基协议的比特。总QBER是 $Q_Z$ 和 $Q_X$ 的平均值。\n$$QBER = \\frac{1}{2} Q_Z + \\frac{1}{2} Q_X$$\n$$QBER = \\frac{1}{2} \\left( \\frac{1-p}{2} \\right) + \\frac{1}{2} \\left( \\frac{p}{2} \\right) = \\frac{1-p+p}{4} = \\frac{1}{4}$$\n\n有趣的是，QBER与Eve选择基的概率$p$无关。题目指定$p = 1/3$。将这个值（或任何其他值）代入最终表达式不会改变结果。\n$$QBER = \\frac{1}{4}$$", "answer": "$$ \\boxed{\\frac{1}{4}} $$", "id": "715084"}, {"introduction": "在真实世界中，量子信道的噪声是不可避免的，其效应与主动窃听行为在观测上可能无法区分。因此，仅仅探测到错误是不够的，我们还需要量化这些错误对最终密钥安全性的影响。此练习将引导您分析一个特定的噪声模型（泡利-Y错误），并计算由此产生的比特错误率（$e_{bit}$）和相位错误率（$e_{phase}$）。更重要的是，您将学习如何使用 Devetak-Winter 公式，将这些可测量的错误率与最终的安全密钥率联系起来，这是从物理信道特性推导到信息论安全性的关键一步 [@problem_id:714902]。", "problem": "在量子密钥分发（QKD）的背景下，BB84协议是两方（传统上称为Alice和Bob）之间建立共享密钥的一种基石方法。Alice以四个状态之一制备量子比特，这四个状态分属于两个互不相干的基：Z基，$\\{|0\\rangle, |1\\rangle\\}$，或X基，$\\{|+\\rangle, |-\\rangle\\}$。Bob随机选择在Z基或X基中测量每个传入的量子比特。\n\n连接Alice和Bob的量子信道中的噪声会损害安全密钥的生成过程。考虑一个特定的噪声信道，它以概率$p$对传输的量子比特施加一个Pauli-Y错误（$\\sigma_Y$），并以概率$1-p$使量子比特保持不变（施加单位算符$I$）。\n\n该协议的性能和安全性由两个关键参数量化：\n1.  量子比特错误率（$e_{\\text{bit}}$），即Alice和Bob的筛选密钥中不一致比特所占的比例。该错误率是通过在双方丢弃所有使用不同基的测量事例后，比较一部分比特来确定的。由于协议的对称性，我们可以通过考虑Alice和Bob都使用Z基时的错误概率来计算$e_{\\text{bit}}$。\n2.  相位错误率（$e_{\\text{phase}}$），即在共轭基中本应观察到的错误率。对于在Z基中建立的密钥，$e_{\\text{phase}}$是如果双方都使用X基进行测量时会得到的错误率。\n\n在渐近极限（密钥无限长）下，安全密钥率$r$（每个传输的量子比特所能产生的安全密钥比特的比例）的下限由Devetak-Winter公式给出。对于BB84协议，该公式简化为：\n$$r = 1 - H_2(e_{\\text{bit}}) - H_2(e_{\\text{phase}})$$\n其中$H_2(x) = -x \\log_2(x) - (1-x) \\log_2(1-x)$是二元香农熵函数。只有当错误率不是太高时，才可能获得正的安全密钥率（$r  0$）。\n\n量子态和算符定义如下：\n$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$\n$\\sigma_Y = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}$\n\n你的任务是推导此特定噪声信道的安全密钥率$r$。请用错误概率$p$和二元熵函数$H_2(x)$表示你的最终答案。", "solution": "1.  **量子比特错误率**：当双方都使用Z基时，一个Pauli-Y错误会翻转$|0\\rangle \\leftrightarrow |1\\rangle$（忽略全局相位），所以比特错误率就是Pauli-Y错误发生的概率。\n    $$e_{\\text{bit}} = p.$$\n2.  **相位错误率**：当双方都使用X基时，我们需要看Pauli-Y错误对X基态的影响。\n    $$\\sigma_Y|+\\rangle = -i|-\\rangle, \\quad \\sigma_Y|-\\rangle = i|+\\rangle$$\n    同样，一个Y错误会翻转$|+\\rangle \\leftrightarrow |-\\rangle$（忽略全局相位）。因此，相位错误率也是$p$。\n    $$e_{\\text{phase}} = p.$$\n3.  **代入Devetak–Winter公式**：\n    将$e_{\\text{bit}}$和$e_{\\text{phase}}$代入安全密钥率公式：\n    $$\n    \\begin{align*}\n    r = 1 - H_2(e_{\\text{bit}}) - H_2(e_{\\text{phase}}) \\\\\n    = 1 - H_2(p) - H_2(p) \\\\\n    = 1 - 2\\,H_2(p).\n    \\end{align*}\n    $$", "answer": "$$\\boxed{1 - 2H_2(p)}$$", "id": "714902"}, {"introduction": "窃听者的攻击手段并不仅限于简单的“拦截-重发”。更高级的窃听者可以执行“相干攻击”，即让自己的探测器（通常是一个辅助量子比特，或称“ancilla”）与信道中传输的信号量子比特发生纠缠，从而在不完全破坏信号的情况下提取信息。本练习将以受控非门（CNOT）攻击为例，让您探索这种更复杂的攻击模式 [@problem_id:714929]。通过分析这种攻击导致的量子比特错误率，您将理解窃听者如何在信息获取和引入扰动之间进行权衡，并洞察量子安全协议必须抵御的更广泛的威胁。", "problem": "在BB84量子密钥分发协议的背景下，窃听者Eve试图获取有关秘密密钥的信息。她通过拦截Alice发送给Bob的量子比特来实施一种广义的CNOT攻击。Eve使用一个CNOT门，其中信号量子比特作为控制量子比特，她自己的辅助量子比特作为目标量子比特。\n\nBB84协议中使用的四个状态来自两个相互无偏的基：\n1.  直角（Z）基：$\\{|0\\rangle, |1\\rangle\\}$\n2.  对角（X）基：$\\{|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\\}$\n\nAlice随机选择一个基以及该基中的一个状态发送给Bob。Bob也随机选择一个基进行测量。之后他们通过经典信道通信，丢弃在不匹配的基上进行的测量，从而形成“筛选密钥”。\n\nEve的CNOT攻击由作用在信号量子比特（A）和她的辅助量子比特（E）的组合系统上的幺正变换$U_{CNOT}$描述：$U_{CNOT}|c\\rangle_A |t\\rangle_E = |c\\rangle_A |t \\oplus c\\rangle_E$。对于她的攻击，Eve将她的辅助量子比特制备在一般的纯态$|\\psi\\rangle_E = \\cos\\theta |0\\rangle_E + \\sin\\theta |1\\rangle_E$上，其中$\\theta$是Eve控制的一个实数参数。\n\n假设Alice和Bob以相等的概率（Z基为$1/2$，X基为$1/2$）选择他们的基，推导这种攻击在筛选密钥中引起的平均量子比特错误率（QBER），记为$e_{\\text{bit}}$。QBER定义为筛选密钥中Bob接收错误的比特所占的比例。用参数$\\theta$表示你的答案。", "solution": "1.  **相关方程**\n    -   CNOT作用：\n        $$U_{CNOT}|c\\rangle_A|t\\rangle_E=|c\\rangle_A|t\\oplus c\\rangle_E.$$\n    -   Eve的辅助量子比特：\n        $$|\\psi\\rangle_E=\\cos\\theta\\,|0\\rangle_E+\\sin\\theta\\,|1\\rangle_E.$$\n    -   QBER $e_{\\text{bit}}$ 是在筛选密钥上，Bob的比特与Alice的比特不同的平均概率。\n\n2.  **Z基情况**\n    Alice发送$|0\\rangle_A$或$|1\\rangle_A$。经过CNOT门后：\n    $$\n    |0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)\\to|0\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E),\n    $$\n    $$\n    |1\\rangle_A(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E)\\to|1\\rangle_A(\\cos\\theta|1\\rangle_E+\\sin\\theta|0\\rangle_E).\n    $$\n    信号量子比特在Z基中保持不变，因此当Alice和Bob都使用Z基时，没有错误发生：\n    $$e_Z=0.$$\n\n3.  **X基情况**\n    Alice发送$|\\pm\\rangle_A=\\tfrac{1}{\\sqrt{2}}(|0\\rangle\\pm|1\\rangle)$。联合输入态为：\n    $$\n    |\\Psi_{\\pm}\\rangle\n    =\\tfrac{1}{\\sqrt{2}}(|0\\rangle_A\\pm|1\\rangle_A)(\\cos\\theta|0\\rangle_E+\\sin\\theta|1\\rangle_E).\n    $$\n    经过CNOT门后，对于“+”输入：\n    $$\n    |\\Psi\\rangle\n    =\\tfrac{1}{\\sqrt{2}}\\bigl[\\cos\\theta(|0,0\\rangle+|1,1\\rangle)\n    +\\sin\\theta(|0,1\\rangle+|1,0\\rangle)\\bigr].\n    $$\n    计算信号量子比特A上的约化密度矩阵：\n    $$\n    \\rho_A\n    =\\mathrm{Tr}_E|\\Psi\\rangle\\langle\\Psi|\n    =\\tfrac{1}{2}\\begin{pmatrix}1  \\sin2\\theta\\\\\\sin2\\theta  1\\end{pmatrix}\n    =\\tfrac{1}{2}\\bigl(I+\\sin2\\theta\\,X\\bigr).\n    $$\n    Bob在X基中测量。当Alice发送$|+\\rangle$时，Bob测量得到$|-\\rangle$的错误概率是：\n    $$\n    P(-)\n    =\\langle -|\\rho_A|-\\rangle\n    =\\tfrac{1}{2}\\bigl(1-\\sin2\\theta\\bigr).\n    $$\n    根据对称性，当Alice发送$|-\\rangle$时，错误概率相同。因此，当双方都使用X基时的错误率为：\n    $$e_X=\\frac{1-\\sin2\\theta}{2}.$$\n\n4.  **平均QBER**\n    Alice和Bob以$1/2$的概率使用每个基；筛选密钥只保留基匹配的事件。因此，总的QBER是Z基和X基错误率的平均值：\n    $$\n    e_{\\text{bit}}\n    =\\tfrac{1}{2}\\,e_Z+\\tfrac{1}{2}\\,e_X\n    =\\tfrac{1}{2}\\cdot0+\\tfrac{1}{2}\\cdot\\tfrac{1-\\sin2\\theta}{2}\n    =\\frac{1-\\sin2\\theta}{4}.\n    $$", "answer": "$$\\boxed{\\frac{1-\\sin(2\\theta)}{4}}$$", "id": "714929"}]}