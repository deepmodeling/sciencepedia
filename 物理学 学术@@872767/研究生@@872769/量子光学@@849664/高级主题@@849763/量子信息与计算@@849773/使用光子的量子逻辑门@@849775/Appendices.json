{"hands_on_practices": [{"introduction": "与经典电路类似，量子电路也是通过将基本门组合成更复杂的操作来构建的。本练习展示了量子电路合成的一个基本原理：仅使用三个受控非 (CNOT) 门的序列来构建一个交换两个量子比特状态的 SWAP 门。通过这个练习 [@problem_id:719442]，您将获得代表门序列的矩阵乘法的实践经验，并发现基本构建块如何实现强大的功能。", "problem": "在量子计算中，复杂的操作通常由一系列更基本的量子门构成。一个双量子比特系统的状态由一个四维复希尔伯特空间中的向量描述。该空间的计算基由 $|q_1 q_2\\rangle$ 表示，其中 $q_1 \\in \\{0, 1\\}$ 是第一个量子比特的状态，$q_2 \\in \\{0, 1\\}$ 是第二个量子比特的状态。基向量的顺序如下：\n$$\n|00\\rangle \\leftrightarrow \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad |01\\rangle \\leftrightarrow \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad |10\\rangle \\leftrightarrow \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad |11\\rangle \\leftrightarrow \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n\n一个基本的双量子比特门是受控非门（Controlled-NOT, CNOT）。$\\text{CNOT}_{ij}$ 门作用于两个量子比特，其中 $i$ 是“控制”量子比特，$j$ 是“目标”量子比特。当且仅当控制量子比特处于 $|1\\rangle$ 态时，该门对目标量子比特施加一个泡利-X（Pauli-X, NOT）操作。否则，它不进行任何操作。\n\n当量子比特1为控制位、量子比特2为目标位时，$\\text{CNOT}_{12}$ 的矩阵表示为：\n$$\nU_{\\text{CNOT}_{12}} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix}\n$$\n该矩阵将基态变换如下：$|00\\rangle \\to |00\\rangle$、$|01\\rangle \\to |01\\rangle$、$|10\\rangle \\to |11\\rangle$ 以及 $|11\\rangle \\to |10\\rangle$。\n\n按时间顺序施加的一系列门 $U_1, U_2, \\dots, U_k$ 对应于总的矩阵乘积 $U_{total} = U_k \\cdots U_2 U_1$。\n\n考虑一个特定的三门序列：一个 $\\text{CNOT}_{12}$ 门，接着一个 $\\text{CNOT}_{21}$ 门，再接着一个 $\\text{CNOT}_{12}$ 门。首先，您需要确定 $U_{\\text{CNOT}_{21}}$ 的矩阵表示，其中量子比特2是控制位，量子比特1是目标位。然后，使用这个矩阵，推导出代表完整复合操作 $U = U_{\\text{CNOT}_{12}} U_{\\text{CNOT}_{21}} U_{\\text{CNOT}_{12}}$ 的单一 $4 \\times 4$ 酉矩阵。", "solution": "1. 定义标准基和门矩阵。\n$$A\\equiv U_{\\text{CNOT}_{12}}\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 1 & 0\n\\end{pmatrix},\\quad\nB\\equiv U_{\\text{CNOT}_{21}}\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 1 & 0\\\\\n0 & 1 & 0 & 0\n\\end{pmatrix}.$$\n\n2. 计算中间乘积 $C=B\\,A$。\n$$C=B\\,A\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 1 & 0\\\\\n0 & 1 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 1 & 0 & 0\n\\end{pmatrix}.$$\n\n3. 构成总的酉矩阵 $U=A\\,C$。\n$$U=A\\,C\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\\\\\n0 & 1 & 0 & 0\n\\end{pmatrix}\n=\\begin{pmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}.$$\n这就是 SWAP 门。", "answer": "$$\\boxed{\\begin{pmatrix}1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 1\\end{pmatrix}}$$", "id": "719442"}, {"introduction": "从抽象理论到物理实现是量子工程中的关键一步。本练习探索了一种使用单个光子实现 CNOT 门的精妙方法，其中一个量子比特编码在其空间路径中，另一个编码在其偏振中。这个练习 [@problem_id:719480] 要求您通过计算由此产生的门保真度来分析一个真实的实验缺陷——波片的轻微失准——所带来的影响，门保真度是量化任何量子设备性能的关键指标。", "problem": "一个双量子比特的受控非门（CNOT）由单个光子构成。控制量子比特编码在光子的空间路径中，其中路径0对应于状态$|0\\rangle_c$，路径1对应于$|1\\rangle_c$。目标量子比特编码在光子的偏振中，水平偏振$|H\\rangle$代表$|0\\rangle_t$，垂直偏振$|V\\rangle$代表$|1\\rangle_t$。\n\n当且仅当控制（路径）量子比特处于状态$|1\\rangle_c$时，该门应对目标（偏振）量子比特执行非（NOT）操作。对于偏振而言，一个理想的非门可以通过一个半波片（HWP）实现，其快轴相对于水平轴成$45^\\circ$角。在CNOT门的物理实现中，一个半波片被放置在路径1中，而路径0则留空。\n\n然而，路径1中的半波片未被完美对准。其快轴相对于水平方向的角度为$(45^\\circ + \\epsilon)$，其中$\\epsilon$是一个小的、恒定的旋转误差。在$\\{|H\\rangle, |V\\rangle\\}$基下，快轴与水平方向成$\\theta$角的半波片的幺正算符由下式给出：\n$$\nU_{HWP}(\\theta) = \\begin{pmatrix} \\cos(2\\theta) & \\sin(2\\theta) \\\\ \\sin(2\\theta) & -\\cos(2\\theta) \\end{pmatrix}\n$$\n量子门的质量通常用其门保真度来量化，门保真度比较了实际实现的门与预期的理想门。在$d$维希尔伯特空间上，幺正操作$U_{imp}$和理想幺正操作$U_{ideal}$之间的门保真度$F_g$定义为：\n$$\nF_g(U_{imp}, U_{ideal}) = \\frac{1}{d^2} \\left| \\text{Tr}(U_{ideal}^{\\dagger} U_{imp}) \\right|^2\n$$\n推导所述的路径受控CNOT门的门保真度$F_g$作为旋转误差$\\epsilon$的函数。", "solution": "我们将路径量子比特的投影算符标记为 $P_0=|0\\rangle\\langle0|_c$ 和 $P_1=|1\\rangle\\langle1|_c$。实现的门是\n$$\nU_{imp}=P_0\\otimes I+P_1\\otimes U_{HWP}\\Bigl(\\tfrac\\pi4+\\epsilon\\Bigr),\n$$\n而理想的CNOT门是\n$$\nU_{ideal}=P_0\\otimes I+P_1\\otimes\\sigma_x.\n$$\n$d=4$ 时的门保真度为\n$$\nF_g=\\frac1{16}\\bigl|\\Tr(U_{ideal}^\\dagger U_{imp})\\bigr|^2.\n$$\n由于 $U_{ideal}^\\dagger=U_{ideal}$ 且 $P_iP_j=\\delta_{ij}P_i$，我们有\n$$\nU_{ideal}^\\dagger U_{imp}\n=P_0\\otimes I+P_1\\otimes(\\sigma_x\\,U_{HWP}).\n$$\n因此\n$$\n\\Tr(U_{ideal}^\\dagger U_{imp})\n=\\Tr(P_0)\\Tr(I)+\\Tr(P_1)\\Tr(\\sigma_x\\,U_{HWP})\n=2+\\Tr(\\sigma_x\\,U_{HWP}).\n$$\n在 $\\{|H\\rangle,|V\\rangle\\}$ 基下\n$$\nU_{HWP}(\\theta)\n=\\begin{pmatrix}\\cos2\\theta & \\sin2\\theta\\\\\\sin2\\theta & -\\cos2\\theta\\end{pmatrix},\\quad\n\\sigma_x=\\begin{pmatrix}0 & 1\\\\1 & 0\\end{pmatrix},\n$$\n所以\n$$\n\\sigma_x\\,U_{HWP}(\\theta)\n=\\begin{pmatrix}\\sin2\\theta & -\\cos2\\theta\\\\\\cos2\\theta & \\sin2\\theta\\end{pmatrix},\n$$\n且\n$$\n\\Tr(\\sigma_x\\,U_{HWP}(\\theta))=2\\sin2\\theta.\n$$\n令 $\\theta=\\frac\\pi4+\\epsilon$ 得\n$$\n\\sin2\\Bigl(\\tfrac\\pi4+\\epsilon\\Bigr)=\\sin\\Bigl(\\tfrac\\pi2+2\\epsilon\\Bigr)=\\cos2\\epsilon,\n$$\n所以\n$$\n\\Tr(U_{ideal}^\\dagger U_{imp})=2+2\\cos2\\epsilon=2(1+\\cos2\\epsilon).\n$$\n因此\n$$\nF_g=\\frac1{16}\\bigl[2(1+\\cos2\\epsilon)\\bigr]^2\n=\\frac{(1+\\cos2\\epsilon)^2}{4}\n=\\cos^4\\!\\epsilon.\n$$", "answer": "$$\\boxed{\\cos^4(\\epsilon)}$$", "id": "719480"}, {"introduction": "量子算法的性能不仅取决于单个门的质量，还取决于整个电路中误差的累积效应。本练习将我们的分析从单个组件提升到旨在生成贝尔态的完整（尽管很小）的量子电路。在这个练习 [@problem_id:719328] 中，您将计算当 CNOT 门受到相干旋转误差影响时该电路的平均门保真度，从而为电路的可靠性提供更全面的度量。", "problem": "一个用于产生纠缠的基本量子电路是贝尔态制备电路，它对一个控制量子比特应用一个Hadamard门，然后对第二个量子比特应用一个CNOT门。假设两个量子比特的初始态均为$|0\\rangle$，因此输入态为$|\\psi_{in}\\rangle = |00\\rangle$。理想电路可用幺正算符 $U_{ideal} = U_{CNOT} (H \\otimes I)$ 描述。\n\n在真实的物理实现中，CNOT门是不完美的。我们将这种不完美建模为一种与理想CNOT操作同时发生的相干旋转误差。因此，含噪声的CNOT门由 $U_{noisy\\_CNOT} = U_{err} U_{CNOT}$ 描述，其中误差算符为 $U_{err} = \\exp(-i\\epsilon \\sigma_z \\otimes \\sigma_x)$，$\\epsilon$ 是一个小的无量纲误差参数。假设Hadamard门是完美的。那么，变换输入态的整个含噪声电路由 $U_{noisy} = U_{err} U_{CNOT} (H \\otimes I)$ 给出。\n\n标准的泡利矩阵由下式给出：\n$$ \\sigma_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad \\sigma_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} $$\n在计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 中，Hadamard门和CNOT门（以第一个量子比特为控制位）表示为：\n$$ H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \\quad U_{CNOT} = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\\\ 0 & 0 & 1 & 0 \\end{pmatrix} $$\n\n含噪声电路的性能由平均门保真度 $F_{avg}$ 来量化，它衡量了含噪声幺正算符 $U_{noisy}$ 在所有可能的输入纯态 $|\\psi\\rangle$ 上平均近似理想幺正算符 $U_{ideal}$ 的程度。对于一个 $d$ 维希尔伯特空间，它由以下公式给出：\n$$ F_{avg} = \\frac{d + |\\text{Tr}(U_{ideal}^{\\dagger} U_{noisy})|^2}{d(d+1)} $$\n\n推导这个含噪声的贝尔态制备电路的平均保真度 $F_{avg}$，作为误差参数 $\\epsilon$ 的函数。", "solution": "我们希望计算平均保真度\n$$F_{avg}=\\frac{d+|\\Tr(U_{ideal}^\\dagger U_{noisy})|^2}{d(d+1)},\\quad d=4.$$\n由于 $U_{noisy}=U_{err}U_{ideal}$，我们有\n$$\\Tr(U_{ideal}^\\dagger U_{noisy})=\\Tr(U_{ideal}^\\dagger U_{err}U_{ideal})=\\Tr(U_{err}),$$\n根据迹的循环性。误差算符为\n$$U_{err}=\\exp(-i\\epsilon\\,\\sigma_z\\otimes\\sigma_x).$$\n注意到 $(\\sigma_z\\otimes\\sigma_x)^2=I\\otimes I$，$\\sigma_z\\otimes\\sigma_x$ 的特征值为 $\\pm1$ (均为二重简并)。因此\n$$\n\\Tr(U_{err})\n=2e^{-i\\epsilon}+2e^{+i\\epsilon}\n=4\\cos\\epsilon,\n$$\n且\n$$|\\Tr(U_{err})|^2=16\\cos^2\\epsilon.$$\n代入保真度公式可得\n$$\nF_{avg}\n=\\frac{4+16\\cos^2\\epsilon}{4\\cdot5}\n=\\frac{1+4\\cos^2\\epsilon}{5}.\n$$", "answer": "$$\\boxed{\\frac{1+4\\cos^2\\epsilon}{5}}$$", "id": "719328"}]}