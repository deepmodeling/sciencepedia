{"hands_on_practices": [{"introduction": "相干态是量子谐振子最接近经典行为的量子态。为了具体理解这一点，我们的第一个实践是计算处于相干态 $|\\alpha\\rangle$ 的谐振子的位置期望值。通过这个练习 [@problem_id:1367393]，你将亲手证明其位置期望值的演化与经典谐振子的运动轨迹完全一致，从而为连接抽象的量子态与可观测的经典运动建立起坚实的桥梁。", "problem": "一个一维量子谐振子，作为双原子分子振动的简化模型，其约化质量为 $m$，经典角频率为 $\\omega$。该系统被制备在一个称为相干态的特殊量子态上，记为 $|\\alpha\\rangle$。相干态是湮灭算符 $\\hat{a}$ 的归一化本征矢量，满足 $\\hat{a}|\\alpha\\rangle = \\alpha|\\alpha\\rangle$，其中 $\\alpha$ 是一个复本征值，其极坐标形式为 $\\alpha = |\\alpha| \\exp(i\\phi)$。\n\n该系统的位置算符 $\\hat{x}$ 可以用湮灭算符 $\\hat{a}$ 和产生算符 $\\hat{a}^\\dagger$ 表示为：\n$$\n\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\hat{a} + \\hat{a}^\\dagger)\n$$\n其中 $\\hbar$ 是约化普朗克常数。\n\n确定处于相干态 $|\\alpha\\rangle$ 的谐振子的位置期望值 $\\langle x \\rangle$。将你的最终答案表示为以 $m$、$\\omega$、$\\hbar$、 $|\\alpha|$ 和 $\\phi$ 表示的单个闭式解析表达式。", "solution": "我们要求相干态下位置的期望值 $\\langle x \\rangle = \\langle \\alpha | \\hat{x} | \\alpha \\rangle$。使用 $\\hat{x} = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\hat{a} + \\hat{a}^{\\dagger})$，我们得到\n$$\n\\langle x \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(\\langle \\alpha | \\hat{a} | \\alpha \\rangle + \\langle \\alpha | \\hat{a}^{\\dagger} | \\alpha \\rangle\\right).\n$$\n因为 $|\\alpha\\rangle$ 是一个归一化的相干态，所以 $\\hat{a}|\\alpha\\rangle = \\alpha|\\alpha\\rangle$ 且 $\\langle \\alpha | \\alpha \\rangle = 1$。因此，\n$$\n\\langle \\alpha | \\hat{a} | \\alpha \\rangle = \\alpha, \\quad \\text{和} \\quad \\langle \\alpha | \\hat{a}^{\\dagger} | \\alpha \\rangle = \\alpha^{*},\n$$\n其中第二个关系式由取厄米共轭得到：$(\\hat{a}|\\alpha\\rangle)^{\\dagger} = \\langle \\alpha | \\hat{a}^{\\dagger} = \\alpha^{*} \\langle \\alpha |$。于是，\n$$\n\\langle x \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}}(\\alpha + \\alpha^{*}) = \\sqrt{\\frac{\\hbar}{2m\\omega}}\\left(|\\alpha|\\exp(i\\phi) + |\\alpha|\\exp(-i\\phi)\\right).\n$$\n使用 $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos\\phi$，我们得到\n$$\n\\langle x \\rangle = \\sqrt{\\frac{\\hbar}{2m\\omega}} \\cdot 2|\\alpha|\\cos\\phi = \\sqrt{\\frac{2\\hbar}{m\\omega}}\\,|\\alpha|\\cos\\phi.\n$$\n这是用 $m$、$\\omega$、$\\hbar$、 $|\\alpha|$ 和 $\\phi$ 表示的单个闭式表达式。", "answer": "$$\\boxed{\\sqrt{\\frac{2\\hbar}{m\\omega}}\\,|\\alpha|\\cos\\phi}$$", "id": "1367393"}, {"introduction": "虽然相干态的平均行为呈现经典特性，但它本质上仍是一个纯粹的量子态，具有内禀的量子涨落。这个练习 [@problem_id:2110844] 将引导我们深入探索相干态的量子统计性质。通过计算光子数算符的标准差，你将发现相干态的光子数是不确定的，其涨落遵循泊松分布，这正是它与光子数确定的福克态 (Fock state) 的根本区别。", "problem": "在光的量子理论中，理想化的受激辐射光放大（LASER）光束的单模状态可以用一个相干态来描述。相干态 $|\\alpha\\rangle$ 是数态 $|n\\rangle$ 的一种特定量子叠加，其中 $|n\\rangle$ 表示一个恰好有 $n$ 个光子的状态。\n\n我们考虑电磁场的单个模式。其基态是数态（或福克态）$|n\\rangle$，其中 $n = 0, 1, 2, \\dots$。这些态是光子数算符 $\\hat{n}$ 的本征态。该系统可以用光子湮灭算符 $\\hat{a}$ 和产生算符 $\\hat{a}^\\dagger$ 来描述，它们对数态的作用如下：\n$$ \\hat{a} |n\\rangle = \\sqrt{n} |n-1\\rangle \\quad (\\text{对于 } n \\ge 1), \\quad \\hat{a} |0\\rangle = 0 $$\n$$ \\hat{a}^\\dagger |n\\rangle = \\sqrt{n+1} |n+1\\rangle $$\n数算符定义为 $\\hat{n} = \\hat{a}^\\dagger \\hat{a}$。湮灭算符和产生算符满足正则对易关系 $[\\hat{a}, \\hat{a}^\\dagger] = 1$。\n\n相干态 $|\\alpha\\rangle$ 由一个复数 $\\alpha$ 参数化，定义为以下叠加形式：\n$$ |\\alpha\\rangle = \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}} |n\\rangle $$\n这个态是归一化的，使得 $\\langle \\alpha | \\alpha \\rangle = 1$。\n\n光子数的涨落由标准差 $\\Delta n$ 来量化。对于处于 $|\\alpha\\rangle$ 态的系统，标准差由 $\\Delta n = \\sqrt{\\langle \\hat{n}^2 \\rangle - \\langle \\hat{n} \\rangle^2}$ 给出，其中 $\\langle \\hat{O} \\rangle$ 表示算符 $\\hat{O}$ 在态 $|\\alpha\\rangle$ 中的期望值。\n\n请计算一个处于相干态 $|\\alpha\\rangle$ 的系统的光子数标准差 $\\Delta n$。请用参数 $\\alpha$ 的闭合解析表达式来表示你的答案。", "solution": "目标是计算数算符 $\\hat{n}$ 在相干态 $|\\alpha\\rangle$ 中的标准差，其表达式为 $\\Delta n = \\sqrt{\\langle \\hat{n}^2 \\rangle - \\langle \\hat{n} \\rangle^2}$。这需要计算期望值 $\\langle \\hat{n} \\rangle$ 和 $\\langle \\hat{n}^2 \\rangle$。\n\n相干态的一个关键性质是它们是湮灭算符 $\\hat{a}$ 的本征态。我们首先来证明这一点。将 $\\hat{a}$ 作用于 $|\\alpha\\rangle$：\n$$ \\hat{a} |\\alpha\\rangle = \\hat{a} \\left( \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}} |n\\rangle \\right) $$\n$$ \\hat{a} |\\alpha\\rangle = \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}} (\\hat{a} |n\\rangle) $$\n由于 $\\hat{a}|0\\rangle = 0$，求和从 $n=1$ 开始：\n$$ \\hat{a} |\\alpha\\rangle = \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{n=1}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}} \\sqrt{n} |n-1\\rangle $$\n我们可以简化 $\\frac{\\sqrt{n}}{\\sqrt{n!}} = \\frac{1}{\\sqrt{(n-1)!}}$。\n$$ \\hat{a} |\\alpha\\rangle = \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{n=1}^{\\infty} \\frac{\\alpha^n}{\\sqrt{(n-1)!}} |n-1\\rangle $$\n我们进行指标变换，令 $m = n-1$。当 $n=1$ 时，$m=0$。\n$$ \\hat{a} |\\alpha\\rangle = \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{m=0}^{\\infty} \\frac{\\alpha^{m+1}}{\\sqrt{m!}} |m\\rangle $$\n提出因子 $\\alpha$：\n$$ \\hat{a} |\\alpha\\rangle = \\alpha \\left( \\exp\\left(-\\frac{|\\alpha|^2}{2}\\right) \\sum_{m=0}^{\\infty} \\frac{\\alpha^m}{\\sqrt{m!}} |m\\rangle \\right) $$\n括号中的表达式正是相干态 $|\\alpha\\rangle$ 的定义。因此，我们得到这个重要性质：\n$$ \\hat{a} |\\alpha\\rangle = \\alpha |\\alpha\\rangle $$\n对该方程取厄米共轭，得到产生算符对右矢态 $\\langle \\alpha |$ 的作用：\n$$ (\\hat{a} |\\alpha\\rangle)^\\dagger = (\\alpha |\\alpha\\rangle)^\\dagger \\implies \\langle \\alpha | \\hat{a}^\\dagger = \\alpha^* \\langle \\alpha | $$\n\n现在我们可以计算 $\\langle \\hat{n} \\rangle$。\n$$ \\langle \\hat{n} \\rangle = \\langle \\alpha | \\hat{n} | \\alpha \\rangle = \\langle \\alpha | \\hat{a}^\\dagger \\hat{a} | \\alpha \\rangle $$\n使用 $\\hat{a} |\\alpha\\rangle = \\alpha |\\alpha\\rangle$：\n$$ \\langle \\hat{n} \\rangle = \\langle \\alpha | \\hat{a}^\\dagger (\\alpha |\\alpha\\rangle) = \\alpha \\langle \\alpha | \\hat{a}^\\dagger | \\alpha \\rangle $$\n使用 $\\langle \\alpha | \\hat{a}^\\dagger = \\alpha^* \\langle \\alpha |$：\n$$ \\langle \\hat{n} \\rangle = \\alpha (\\alpha^* \\langle \\alpha | \\alpha \\rangle) = \\alpha^* \\alpha \\langle \\alpha | \\alpha \\rangle $$\n由于态是归一化的，$\\langle \\alpha | \\alpha \\rangle = 1$。\n$$ \\langle \\hat{n} \\rangle = |\\alpha|^2 $$\n这就是相干态中的平均光子数。\n\n接下来，我们计算 $\\langle \\hat{n}^2 \\rangle$。\n$$ \\langle \\hat{n}^2 \\rangle = \\langle \\alpha | \\hat{n}^2 | \\alpha \\rangle = \\langle \\alpha | (\\hat{a}^\\dagger \\hat{a})^2 | \\alpha \\rangle = \\langle \\alpha | \\hat{a}^\\dagger \\hat{a} \\hat{a}^\\dagger \\hat{a} | \\alpha \\rangle $$\n为了简化这个表达式，我们使用对易关系 $[\\hat{a}, \\hat{a}^\\dagger] = 1$，可以改写为 $\\hat{a} \\hat{a}^\\dagger = \\hat{a}^\\dagger \\hat{a} + 1 = \\hat{n} + 1$。\n$$ \\langle \\hat{n}^2 \\rangle = \\langle \\alpha | \\hat{a}^\\dagger (\\hat{a} \\hat{a}^\\dagger) \\hat{a} | \\alpha \\rangle = \\langle \\alpha | \\hat{a}^\\dagger (\\hat{n}+1) \\hat{a} | \\alpha \\rangle $$\n$$ \\langle \\hat{n}^2 \\rangle = \\langle \\alpha | (\\hat{a}^\\dagger \\hat{n} \\hat{a} + \\hat{a}^\\dagger \\hat{a}) | \\alpha \\rangle = \\langle \\alpha | \\hat{a}^\\dagger \\hat{n} \\hat{a} | \\alpha \\rangle + \\langle \\alpha | \\hat{n} | \\alpha \\rangle $$\n我们已经知道 $\\langle \\hat{n} \\rangle = |\\alpha|^2$。我们现在计算第一项。\n$$ \\langle \\alpha | \\hat{a}^\\dagger \\hat{n} \\hat{a} | \\alpha \\rangle = \\langle \\alpha | \\hat{a}^\\dagger (\\hat{a}^\\dagger \\hat{a}) \\hat{a} | \\alpha \\rangle = \\langle \\alpha | (\\hat{a}^\\dagger)^2 \\hat{a}^2 | \\alpha \\rangle $$\n我们可以通过将算符作用于态来计算此项。\n$$ \\hat{a}^2 |\\alpha\\rangle = \\hat{a} (\\hat{a} |\\alpha\\rangle) = \\hat{a} (\\alpha |\\alpha\\rangle) = \\alpha (\\hat{a} |\\alpha\\rangle) = \\alpha (\\alpha |\\alpha\\rangle) = \\alpha^2 |\\alpha\\rangle $$\n其厄米共轭是 $\\langle \\alpha | (\\hat{a}^\\dagger)^2 = (\\alpha^2)^* \\langle \\alpha | = (\\alpha^*)^2 \\langle \\alpha |$。\n所以，该项变为：\n$$ \\langle \\alpha | (\\hat{a}^\\dagger)^2 \\hat{a}^2 | \\alpha \\rangle = \\langle \\alpha | (\\hat{a}^\\dagger)^2 (\\alpha^2 |\\alpha\\rangle) = \\alpha^2 \\langle \\alpha | (\\hat{a}^\\dagger)^2 | \\alpha \\rangle $$\n$$ = \\alpha^2 ((\\alpha^*)^2 \\langle \\alpha | \\alpha \\rangle) = \\alpha^2 (\\alpha^*)^2 = (\\alpha \\alpha^*)^2 = (|\\alpha|^2)^2 = |\\alpha|^4 $$\n因此，\n$$ \\langle \\hat{n}^2 \\rangle = |\\alpha|^4 + \\langle \\hat{n} \\rangle = |\\alpha|^4 + |\\alpha|^2 $$\n\n最后，我们计算方差 $(\\Delta n)^2$：\n$$ (\\Delta n)^2 = \\langle \\hat{n}^2 \\rangle - \\langle \\hat{n} \\rangle^2 = (|\\alpha|^4 + |\\alpha|^2) - (|\\alpha|^2)^2 = |\\alpha|^4 + |\\alpha|^2 - |\\alpha|^4 = |\\alpha|^2 $$\n标准差 $\\Delta n$ 是方差的平方根。\n$$ \\Delta n = \\sqrt{|\\alpha|^2} = |\\alpha| $$\n由于标准差必须是一个非负实数，因此取绝对值是合适的。", "answer": "$$\\boxed{|\\alpha|}$$", "id": "2110844"}, {"introduction": "在理解了相干态的平均行为和量子涨落之后，是时候从一个更全局的视角来审视它了。维格纳函数 (Wigner function) 是一个强大的数学工具，它提供了量子态在相空间中的准概率分布表示。这个计算实践 [@problem_id:2426880] 将指导你构建并可视化一个相干态的维格纳函数，让你能够“看见”一个在相空间中旋转的、局域化的高斯波包，其中心轨迹的经典运动与波包的扩展所体现的量子不确定性一目了然。", "problem": "你需要通过计算一维量子谐振子相干态的维格纳函数并追踪其时间演化，来构建一个相空间图。在一个无量纲单位制中进行计算，其中约化普朗克常数 $\\hbar$ 设为 $1$，质量 $m$ 设为 $1$，角频率 $\\omega$ 设为 $1$。角度必须以弧度为单位。所有要求的输出均为无量纲。\n\n从基本定律和核心定义出发：\n- 哈密顿量为 $H = \\frac{p^{2}}{2} + \\frac{q^{2}}{2}$。\n- 经典运动方程源于哈密顿方程：$\\dot{q} = \\frac{\\partial H}{\\partial p}$ 和 $\\dot{p} = -\\frac{\\partial H}{\\partial q}$。\n- 相干态是一种最小不确定度态，其运动遵循谐振子的经典轨道。\n- 维格纳函数 $W(q,p)$ 由密度算符的韦尔-维格纳变换定义，或等效地，由其涉及位形空间波函数的相空间积分定义。\n\n任务：\n1) 使用给定哈密顿量的哈密顿方程，推导在任意初始条件 $(q_{0}, p_{0})$ 下相空间中的经典轨道 $(q_{\\mathrm{cl}}(t), p_{\\mathrm{cl}}(t))$。解释相空间中运动的旋转结构。\n\n2) 利用相干态的定义性质（最小不确定度和经典中心）以及维格纳函数的定义，推导在时刻 $t$、复振幅为 $\\alpha = \\alpha_{r} + i \\alpha_{i}$ 的相干态在相空间中的维格纳函数的闭合形式表达式。用 $(\\alpha_{r}, \\alpha_{i})$ 和 $t$ 表示轨道中心 $(q_{c}(t), p_{c}(t))$。\n\n3) 设计一个计算算法，用于在给定的 $(\\alpha_{r}, \\alpha_{i})$、 $t$ 和评估点 $(q^{\\ast}, p^{\\ast})$ 下，评估维格纳函数 $W(q^{\\ast}, p^{\\ast}; t)$。此外，设计一个在有限矩形网格上的数值积分方法，以近似计算归一化积分 $\\iint_{-\\infty}^{\\infty} W(q,p;t)\\,dq\\,dp$，并报告其与 $1$ 之间的绝对误差。\n\n4) 将该算法实现在一个单一程序中，为下方的测试套件生成所需的输出。在需要时，使用具有指定边界和间距的均匀矩形网格。\n\n测试套件及所需输出：\n- 情况 $1$ (正常路径)：$(\\alpha_{r}, \\alpha_{i}) = (1, 0)$，$t = 0$，在 $(q^{\\ast}, p^{\\ast}) = (\\sqrt{2}, 0)$ 处求值。以浮点数形式输出标量值 $W(q^{\\ast}, p^{\\ast}; t)$。\n- 情况 $2$ (旋转检验)：$(\\alpha_{r}, \\alpha_{i}) = (1, 0)$，$t = \\frac{\\pi}{2}$，在 $(q^{\\ast}, p^{\\ast}) = (0, -\\sqrt{2})$ 处求值。以浮点数形式输出标量值 $W(q^{\\ast}, p^{\\ast}; t)$。\n- 情况 $3$ (边界条件，基态)：$(\\alpha_{r}, \\alpha_{i}) = (0, 0)$，$t = \\frac{\\pi}{3}$，在 $(q^{\\ast}, p^{\\ast}) = (0, 0)$ 处求值。以浮点数形式输出标量值 $W(q^{\\ast}, p^{\\ast}; t)$。\n- 情况 $4$ (偏离中心评估)：$(\\alpha_{r}, \\alpha_{i}) = (1, 0)$，$t = 0$，在 $(q^{\\ast}, p^{\\ast}) = (0, 0)$ 处求值。以浮点数形式输出标量值 $W(q^{\\ast}, p^{\\ast}; t)$。\n- 情况 $5$ (通过数值积分进行归一化)：$(\\alpha_{r}, \\alpha_{i}) = (0.7, -0.4)$，$t = 1$。使用均匀网格（$q \\in [-5,5]$，$p \\in [-5,5]$，间距 $\\Delta q = 0.05$，$\\Delta p = 0.05$）近似计算 $I = \\iint W(q,p;t)\\,dq\\,dp$。以浮点数形式输出绝对误差 $|I - 1|$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”）。这五个条目按顺序分别对应情况 $1$ 到情况 $5$。角度必须以弧度为单位，所有输出均为无量纲浮点数。", "solution": "该问题要求对一维量子谐振子中相干态的维格纳函数进行推导和计算实现。该问题具有科学依据，提法恰当，并包含了获得唯一解所需的所有信息。我们在 $\\hbar=1$、$m=1$ 和 $\\omega=1$ 的无量纲体系中进行推导。\n\n**1. 相空间中的经典轨道**\n\n系统的哈密顿量为 $H = \\frac{p^2}{2} + \\frac{q^2}{2}$。经典运动由哈密顿方程决定：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{\\partial}{\\partial p} \\left( \\frac{p^2}{2} + \\frac{q^2}{2} \\right) = p $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -\\frac{\\partial}{\\partial q} \\left( \\frac{p^2}{2} + \\frac{q^2}{2} \\right) = -q $$\n这构成了一个包含两个一阶线性常微分方程的方程组。通过对第一个方程关于时间 $t$ 求导，我们得到 $\\ddot{q} = \\dot{p}$。代入第二个方程，得到角频率 $\\omega=1$ 的简谐振子运动方程：\n$$ \\ddot{q} + q = 0 $$\n位置 $q(t)$ 的通解是 $q(t) = A \\cos(t) + B \\sin(t)$。相应地，动量 $p(t)$ 可通过对 $q(t)$ 求导得到：$p(t) = \\dot{q}(t) = -A \\sin(t) + B \\cos(t)$。\n\n我们应用初始条件 $(q(0), p(0)) = (q_0, p_0)$ 来确定常数 $A$ 和 $B$：\n$q(0) = A\\cos(0) + B\\sin(0) = A \\implies A = q_0$\n$p(0) = -A\\sin(0) + B\\cos(0) = B \\implies B = p_0$\n\n将这些常数代回，我们得到经典轨道 $(q_{\\mathrm{cl}}(t), p_{\\mathrm{cl}}(t))$：\n$$ q_{\\mathrm{cl}}(t) = q_0 \\cos(t) + p_0 \\sin(t) $$\n$$ p_{\\mathrm{cl}}(t) = p_0 \\cos(t) - q_0 \\sin(t) $$\n这个结果可以用矩阵形式表示，从而揭示其旋转结构：\n$$ \\begin{pmatrix} q_{\\mathrm{cl}}(t) \\\\ p_{\\mathrm{cl}}(t) \\end{pmatrix} = \\begin{pmatrix} \\cos(t)  \\sin(t) \\\\ -\\sin(t)  \\cos(t) \\end{pmatrix} \\begin{pmatrix} q_0 \\\\ p_0 \\end{pmatrix} $$\n该矩阵是一个旋转矩阵，对应于顺时针旋转角度 $t$（因为我们的角频率 $\\omega=1$）。因此，相空间中的任何点都只是以恒定的角速度 $\\omega=1$ 绕原点顺时针旋转。轨道是一个半径为 $R = \\sqrt{q_0^2 + p_0^2}$ 的圆，这与能量守恒 $E = H = \\frac{1}{2}(q^2+p^2) = \\frac{1}{2}R^2$ 一致。\n\n**2. 随时间演化的相干态的维格纳函数**\n\n维格纳函数 $W(q,p)$ 是相空间中的一种准概率分布。其通过位形空间波函数 $\\psi(q)$ 的定义至关重要。为了使归一化性质 $\\iint W(q,p) \\, dq \\, dp = 1$ 成立，在 $\\hbar=1$ 的情况下，定义必须是：\n$$ W(q,p) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\psi^*(q + y/2) \\psi(q - y/2) e^{-ipy} \\, dy $$\n相干态 $|\\alpha\\rangle$ 是一个最小不确定度态，其中心遵循经典轨道。对于一个相干态 $|\\alpha(t)\\rangle$，其维格纳函数是相空间中的一个高斯分布，中心位于 $(q_c(t), p_c(t)) = (\\langle\\hat{q}\\rangle_t, \\langle\\hat{p}\\rangle_t)$。这个高斯分布的形状与基态（$\\alpha=0$）的形状相同。\n\n首先，我们求基态 $|0\\rangle$ 的维格纳函数。在我们的单位制中，基态波函数为 $\\psi_0(q) = (\\frac{1}{\\pi})^{1/4} e^{-q^2/2}$。代入定义中：\n$$ W_0(q,p) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left(\\frac{1}{\\pi}\\right)^{1/2} e^{-(q+y/2)^2/2} e^{-(q-y/2)^2/2} e^{-ipy} \\, dy $$\n包含 $q$ 和 $y$ 的指数项的乘积简化为 $e^{-q^2 - y^2/4}$。积分变为：\n$$ W_0(q,p) = \\frac{e^{-q^2}}{2\\pi^{3/2}} \\int_{-\\infty}^{\\infty} e^{-y^2/4} e^{-ipy} \\, dy $$\n这是一个标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} e^{-ay^2 - by} dy = \\sqrt{\\pi/a} e^{b^2/4a}$。这里，$a=1/4$ 且 $b=ip$。积分的计算结果为 $2\\sqrt{\\pi} e^{-p^2}$。\n$$ W_0(q,p) = \\frac{e^{-q^2}}{2\\pi^{3/2}} (2\\sqrt{\\pi} e^{-p^2}) = \\frac{1}{\\pi} e^{-(q^2+p^2)} $$\n对于一般的相干态 $|\\alpha\\rangle$，其维格纳函数是基态维格纳函数在相空间中的一个位移：\n$$ W(q, p; t) = W_0(q - q_c(t), p - p_c(t)) = \\frac{1}{\\pi} \\exp\\left( - \\left( (q-q_c(t))^2 + (p-p_c(t))^2 \\right) \\right) $$\n波包的中心 $(q_c(t), p_c(t))$ 由位置算符 $\\hat{q}$ 和动量算符 $\\hat{p}$ 的期望值确定。对于复振幅为 $\\alpha = \\alpha_r + i\\alpha_i$ 的相干态，这些值是 $q_c(0) = \\sqrt{2}\\alpha_r$ 和 $p_c(0) = \\sqrt{2}\\alpha_i$。这些中心的时间演化遵循先前推导的经典轨道，其中 $(q_0, p_0) = (\\sqrt{2}\\alpha_r, \\sqrt{2}\\alpha_i)$：\n$$ q_c(t) = \\sqrt{2}\\alpha_r \\cos(t) + \\sqrt{2}\\alpha_i \\sin(t) = \\sqrt{2}(\\alpha_r \\cos(t) + \\alpha_i \\sin(t)) $$\n$$ p_c(t) = \\sqrt{2}\\alpha_i \\cos(t) - \\sqrt{2}\\alpha_r \\sin(t) = \\sqrt{2}(-\\alpha_r \\sin(t) + \\alpha_i \\cos(t)) $$\n这就完成了所需闭合形式表达式的推导。\n\n**3. 计算算法设计**\n\n**评估 $W(q^*, p^*; t)$ 的算法：**\n给定输入 $(\\alpha_r, \\alpha_i)$、时间 $t$ 和评估点 $(q^*, p^*)$：\n1.  使用上面推导的表达式计算相干态波包随时间演化的中心 $(q_c(t), p_c(t))$。\n2.  计算评估点与中心之间在相空间中的欧几里得距离的平方：$d^2 = (q^* - q_c(t))^2 + (p^* - p_c(t))^2$。\n3.  将维格纳函数评估为 $W = \\frac{1}{\\pi}e^{-d^2}$。\n\n**归一化积分的数值积分算法：**\n给定输入 $(\\alpha_r, \\alpha_i)$、时间 $t$ 和网格规格（$q \\in [q_{\\min}, q_{\\max}]$，$p \\in [p_{\\min}, p_{\\max}]$，间距为 $\\Delta q, \\Delta p$）：\n1.  计算中心 $(q_c(t), p_c(t))$。\n2.  在指定域上生成一个均匀的矩形点网格 $(q_i, p_j)$。\n3.  积分 $I = \\iint W(q,p;t) \\, dq \\, dp$ 使用黎曼和进行近似：\n    $$ I \\approx \\sum_{i,j} W(q_i, p_j; t) \\Delta q \\Delta p $$\n    其中求和遍及网格上的所有点。\n4.  计算与积分真值 $1$ 相关的绝对误差：$|I - 1|$。该方法通过对数值数组使用向量化操作来高效实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by performing the calculations for all five test cases.\n    \"\"\"\n\n    def calculate_wigner(alpha_r, alpha_i, t, q_star, p_star):\n        \"\"\"\n        Calculates the Wigner function for a coherent state at a specific point in phase space.\n        \n        Args:\n            alpha_r (float): Real part of the coherent state amplitude.\n            alpha_i (float): Imaginary part of the coherent state amplitude.\n            t (float): Time.\n            q_star (float): Position coordinate for evaluation.\n            p_star (float): Momentum coordinate for evaluation.\n        \n        Returns:\n            float: The value of the Wigner function W(q*, p*; t).\n        \"\"\"\n        # System parameters (dimensionless)\n        sqrt2 = np.sqrt(2.0)\n        \n        # Calculate the center of the coherent state wave packet at time t\n        cos_t = np.cos(t)\n        sin_t = np.sin(t)\n        \n        q_c = sqrt2 * (alpha_r * cos_t + alpha_i * sin_t)\n        p_c = sqrt2 * (-alpha_r * sin_t + alpha_i * cos_t)\n        \n        # Calculate the squared distance from the evaluation point to the center\n        d_sq = (q_star - q_c)**2 + (p_star - p_c)**2\n        \n        # Calculate the Wigner function value\n        wigner_value = (1.0 / np.pi) * np.exp(-d_sq)\n        \n        return wigner_value\n\n    def calculate_norm_error(alpha_r, alpha_i, t, q_range, p_range, dq, dp):\n        \"\"\"\n        Calculates the absolute error of the numerically integrated Wigner function from 1.\n        \n        Args:\n            alpha_r (float): Real part of the coherent state amplitude.\n            alpha_i (float): Imaginary part of the coherent state amplitude.\n            t (float): Time.\n            q_range (tuple): (q_min, q_max) for the integration grid.\n            p_range (tuple): (p_min, p_max) for the integration grid.\n            dq (float): Spacing in the q-dimension.\n            dp (float): Spacing in the p-dimension.\n        \n        Returns:\n            float: The absolute error |I - 1|.\n        \"\"\"\n        # System parameters\n        sqrt2 = np.sqrt(2.0)\n        \n        # Calculate the center of the packet\n        cos_t = np.cos(t)\n        sin_t = np.sin(t)\n        q_c = sqrt2 * (alpha_r * cos_t + alpha_i * sin_t)\n        p_c = sqrt2 * (-alpha_r * sin_t + alpha_i * cos_t)\n        \n        # Create the integration grid\n        q_min, q_max = q_range\n        p_min, p_max = p_range\n        \n        num_q = int(round((q_max - q_min) / dq)) + 1\n        num_p = int(round((p_max - p_min) / dp)) + 1\n        \n        q_vals = np.linspace(q_min, q_max, num_q)\n        p_vals = np.linspace(p_min, p_max, num_p)\n        \n        Q, P = np.meshgrid(q_vals, p_vals)\n        \n        # Calculate Wigner function on the grid\n        W_grid = (1.0 / np.pi) * np.exp(-((Q - q_c)**2 + (P - p_c)**2))\n        \n        # Approximate the integral using a Riemann sum\n        integral_approx = np.sum(W_grid) * dq * dp\n        \n        # Calculate the absolute error from the expected normalization of 1\n        error = np.abs(integral_approx - 1.0)\n        \n        return error\n\n    results = []\n\n    # Case 1: (alpha_r, alpha_i) = (1, 0), t = 0, (q*, p*) = (sqrt(2), 0)\n    result1 = calculate_wigner(1.0, 0.0, 0.0, np.sqrt(2.0), 0.0)\n    results.append(result1)\n\n    # Case 2: (alpha_r, alpha_i) = (1, 0), t = pi/2, (q*, p*) = (0, -sqrt(2))\n    result2 = calculate_wigner(1.0, 0.0, np.pi / 2.0, 0.0, -np.sqrt(2.0))\n    results.append(result2)\n\n    # Case 3: (alpha_r, alpha_i) = (0, 0), t = pi/3, (q*, p*) = (0, 0)\n    result3 = calculate_wigner(0.0, 0.0, np.pi / 3.0, 0.0, 0.0)\n    results.append(result3)\n\n    # Case 4: (alpha_r, alpha_i) = (1, 0), t = 0, (q*, p*) = (0, 0)\n    result4 = calculate_wigner(1.0, 0.0, 0.0, 0.0, 0.0)\n    results.append(result4)\n\n    # Case 5: Normalization error calculation\n    result5 = calculate_norm_error(0.7, -0.4, 1.0, (-5.0, 5.0), (-5.0, 5.0), 0.05, 0.05)\n    results.append(result5)\n\n    # Print the final output in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2426880"}]}