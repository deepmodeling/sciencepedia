{"hands_on_practices": [{"introduction": "在深入探索量子计算的复杂性之前，掌握其基本构件——量子门——如何作用于量子态至关重要。本练习旨在通过一个直接的计算来巩固这一基础。你将追踪一个三量子比特系统在受控非门（CNOT）和托福利门（Toffoli）作用下的演化，并计算一个可观测量（由两个交换门构成）的期望值。这个实践将加强你对多量子比特门操作规则的理解，这是分析更复杂量子算法的必备技能。[@problem_id:103416]", "problem": "考虑一个由三个量子比特组成的系统，标记为 1、2 和 3。该系统的状态由希尔伯特空间 $\\mathcal{H} = \\mathcal{H}_1 \\otimes \\mathcal{H}_2 \\otimes \\mathcal{H}_3$ 中的一个向量描述，其中每个 $\\mathcal{H}_i$ 是由计算基态 $|0\\rangle_i$ 和 $|1\\rangle_i$ 张成的二维复向量空间。三量子比特系统的状态表示为 $|q_1 q_2 q_3\\rangle \\equiv |q_1\\rangle_1 \\otimes |q_2\\rangle_2 \\otimes |q_3\\rangle_3$。\n\n我们定义以下多量子比特门：\n1.  **CNOT$_{ij}$ 门**：受控非门，其中量子比特 $i$ 是控制位，量子比特 $j$ 是目标位。它对基态的作用是 $|c, t\\rangle \\to |c, t \\oplus c\\rangle$，其中 $\\oplus$ 表示模2加法。对于一个三量子比特系统，该门对未参与操作的第三个量子比特的作用是单位操作。\n2.  **Toffoli$_{ijk}$ 门（或 CCNOT）**：受控-受控非门，其中量子比特 $i$ 和 $j$ 是控制位，量子比特 $k$ 是目标位。其作用为 $|c_1, c_2, t\\rangle \\to |c_1, c_2, t \\oplus (c_1 \\cdot c_2)\\rangle$。\n3.  **SWAP$_{ij}$ 门**：该门交换量子比特 $i$ 和量子比特 $j$ 的量子态。它对基态 $|q_1 \\dots q_i \\dots q_j \\dots q_N\\rangle$ 的作用结果是 $|q_1 \\dots q_j \\dots q_i \\dots q_N\\rangle$。\n\n系统初始处于状态 $|\\psi_0\\rangle = |101\\rangle$。一系列门作用于该状态。首先，施加一个 CNOT$_{12}$ 门，然后施加一个 Toffoli$_{123}$ 门。设系统的最终状态为 $|\\psi_f\\rangle$。\n\n计算算符 $O = \\text{SWAP}_{12}\\text{SWAP}_{23}$ 的期望值 $\\langle O \\rangle = \\langle \\psi_f | O | \\psi_f \\rangle$。", "solution": "题目要求计算算符 $O = \\text{SWAP}_{12}\\text{SWAP}_{23}$ 在末态 $|\\psi_f\\rangle$ 下的期望值，该末态是通过对初态 $|\\psi_0\\rangle$ 施加一系列量子门得到的。我们将分步确定末态 $|\\psi_f\\rangle$，然后计算期望值。\n\n**第 1 步：定义初始状态**\n三量子比特系统的初始状态给定为：\n$$\n|\\psi_0\\rangle = |101\\rangle\n$$\n这是张量积态 $|1\\rangle_1 \\otimes |0\\rangle_2 \\otimes |1\\rangle_3$ 的简写。\n\n**第 2 步：施加 CNOT$_{12}$ 门**\n第一个操作是施加 CNOT$_{12}$ 门。在此门中，量子比特 1 是控制位，量子比特 2 是目标位。如果控制量子比特 $q_1$ 处于 $|1\\rangle$ 态，则目标量子比特 $q_2$ 的状态会翻转。\n此操作后的状态，我们称之为 $|\\psi_1\\rangle$，是：\n$$\n|\\psi_1\\rangle = \\text{CNOT}_{12} |\\psi_0\\rangle = \\text{CNOT}_{12} |101\\rangle\n$$\n因为控制量子比特 $q_1$ 是 1，我们将目标量子比特 $q_2$ 从 0 翻转到 1。第三个量子比特不受影响。\n$$\n|\\psi_1\\rangle = |1, 0 \\oplus 1, 1\\rangle = |111\\rangle\n$$\n\n**第 3 步：施加 Toffoli$_{123}$ 门**\n第二个操作是对状态 $|\\psi_1\\rangle$ 施加 Toffoli$_{123}$ 门。在此门中，量子比特 1 和 2 是控制位，量子比特 3 是目标位。当且仅当两个控制量子比特 $q_1$ 和 $q_2$ 都处于 $|1\\rangle$ 态时，目标量子比特 $q_3$ 才会翻转。\n末态 $|\\psi_f\\rangle$ 是：\n$$\n|\\psi_f\\rangle = \\text{Toffoli}_{123} |\\psi_1\\rangle = \\text{Toffoli}_{123} |111\\rangle\n$$\n因为两个控制量子比特 $q_1$ 和 $q_2$ 都是 1，我们将目标量子比特 $q_3$ 从 1 翻转到 0。\n$$\n|\\psi_f\\rangle = |1, 1, 1 \\oplus (1 \\cdot 1)\\rangle = |1, 1, 1 \\oplus 1\\rangle = |1, 1, 0\\rangle = |110\\rangle\n$$\n\n**第 4 步：确定算符 $O$ 对末态 $|\\psi_f\\rangle$ 的作用**\n算符为 $O = \\text{SWAP}_{12}\\text{SWAP}_{23}$。我们需要计算状态 $O|\\psi_f\\rangle$。我们从右到左施加门。\n首先，对 $|\\psi_f\\rangle$ 施加 SWAP$_{23}$：\n$$\n\\text{SWAP}_{23} |\\psi_f\\rangle = \\text{SWAP}_{23} |110\\rangle = |1\\rangle_1 \\otimes |0\\rangle_2 \\otimes |1\\rangle_3 = |101\\rangle\n$$\n接下来，对得到的状态施加 SWAP$_{12}$：\n$$\n\\text{SWAP}_{12} (|101\\rangle) = |0\\rangle_1 \\otimes |1\\rangle_2 \\otimes |1\\rangle_3 = |011\\rangle\n$$\n所以，完整算符对末态的作用是：\n$$\nO|\\psi_f\\rangle = \\text{SWAP}_{12}\\text{SWAP}_{23} |110\\rangle = |011\\rangle\n$$\n注意，算符 $O = \\text{SWAP}_{12}\\text{SWAP}_{23}$ 对量子比特执行右循环置换：$|q_1 q_2 q_3\\rangle \\to |q_3 q_1 q_2\\rangle$。将此规则直接应用于 $|110\\rangle$ 会得到 $|011\\rangle$，这证实了我们的结果。\n\n**第 5 步：计算期望值**\n$O$ 的期望值由内积 $\\langle \\psi_f | O | \\psi_f \\rangle$ 给出。使用前面步骤的结果：\n$$\n\\langle O \\rangle = \\langle 110 | \\left( O |110\\rangle \\right) = \\langle 110 | 011 \\rangle\n$$\n状态 $|110\\rangle$ 和 $|011\\rangle$ 是计算基的基向量。这些基向量是标准正交的。因此，它们的内积为零。\n具体来说：\n$$\n\\langle 110 | 011 \\rangle = (\\langle 1|_1 \\otimes \\langle 1|_2 \\otimes \\langle 0|_3) \\cdot (|0\\rangle_1 \\otimes |1\\rangle_2 \\otimes |1\\rangle_3)\n$$\n$$\n= \\langle 1|0 \\rangle_1 \\cdot \\langle 1|1 \\rangle_2 \\cdot \\langle 0|1 \\rangle_3\n$$\n因为 $\\langle 1|0 \\rangle = 0$ 且 $\\langle 0|1 \\rangle = 0$，而 $\\langle 1|1 \\rangle = 1$：\n$$\n\\langle O \\rangle = 0 \\cdot 1 \\cdot 0 = 0\n$$\n算符 $O$ 的期望值为 0。", "answer": "$$\n\\boxed{0}\n$$", "id": "103416"}, {"introduction": "量子门不仅可以处理经典信息，还能创造和操控量子世界独有的特性，例如纠缠。这个练习将带你探究门操作对高度纠缠态的影响。你将从一个三量子比特的格林伯格-霍恩-塞林格（GHZ）态开始，施加一个由三个CNOT门组成的循环序列，并计算最终态与初始态之间的保真度。通过这个过程，你将亲身体会到量子电路如何改变纠缠特性，这是理解量子信息处理和量子纠错码的关键一步。[@problem_id:103319]", "problem": "一个三量子比特系统被制备于 Greenberger-Horne-Zeilinger (GHZ) 态，这是一个最大纠缠态，定义为：\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\n这里，该状态在计算基 $|q_1 q_2 q_3\\rangle$ 中表示，其中 $q_i \\in \\{0, 1\\}$ 是第 $i$ 个量子比特的状态。\n\n一个量子电路对此初始状态施加一个由三个受控非门 (CNOT) 组成的序列。总的幺正操作由 $U = U_3 U_2 U_1$ 给出，其中这些门从右到左依次施加：\n1.  $U_1 = \\text{CNOT}_{12}$ (量子比特1为控制位，量子比特2为目标位)\n2.  $U_2 = \\text{CNOT}_{23}$ (量子比特2为控制位，量子比特3为目标位)\n3.  $U_3 = \\text{CNOT}_{31}$ (量子比特3为控制位，量子比特1为目标位)\n\n$\\text{CNOT}_{ij}$ 门作用于计算基态 $|c\\rangle_i|t\\rangle_j$ 的行为是：如果控制量子比特 $c$ 处于 $|1\\rangle$ 态，则翻转目标量子比特 $t$。这可以写为 $|c\\rangle_i|t\\rangle_j \\mapsto |c\\rangle_i|t \\oplus c\\rangle_j$，其中 $\\oplus$ 表示模2加法。该门对所有其他未涉及的量子比特的作用等同于单位算符。\n\n设在施加完整门序列后系统的最终状态为 $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$。计算初始GHZ态与最终态之间的保真度 $F$。保真度定义为两个状态内积的模的平方：$F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$。", "solution": "问题要求计算初始三量子比特GHZ态 $|\\psi_{GHZ}\\rangle$ 与施加一个特定量子电路后得到的最终态 $|\\psi_{final}\\rangle$ 之间的保真度。\n\n初始状态由下式给出：\n$$\n|\\psi_{GHZ}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)\n$$\n\n电路的幺正算符为 $U = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}$。我们需要计算最终状态 $|\\psi_{final}\\rangle = U |\\psi_{GHZ}\\rangle$。根据量子力学的线性性质，我们可以将算符分别作用于叠加态中的每一项：\n$$\n|\\psi_{final}\\rangle = U \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle) = \\frac{1}{\\sqrt{2}} (U|000\\rangle + U|111\\rangle)\n$$\n\n我们首先计算 $U$ 对基态 $|000\\rangle$ 的作用：\n1.  施加 $\\text{CNOT}_{12}$：控制量子比特（量子比特1）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特2）不发生翻转。\n    $$\n    \\text{CNOT}_{12}|000\\rangle = |000\\rangle\n    $$\n2.  施加 $\\text{CNOT}_{23}$：控制量子比特（量子比特2）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特3）不发生翻转。\n    $$\n    \\text{CNOT}_{23}|000\\rangle = |000\\rangle\n    $$\n3.  施加 $\\text{CNOT}_{31}$：控制量子比特（量子比特3）处于 $|0\\rangle$ 态，因此目标量子比特（量子比特1）不发生翻转。\n    $$\n    \\text{CNOT}_{31}|000\\rangle = |000\\rangle\n    $$\n综合这些步骤，我们发现状态 $|000\\rangle$ 是变换 $U$ 的一个不动点：\n$$\nU|000\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|000\\rangle = |000\\rangle\n$$\n\n接下来，我们计算 $U$ 对基态 $|111\\rangle$ 的作用：\n1.  施加 $\\text{CNOT}_{12}$：控制量子比特（量子比特1）是 $|1\\rangle$，所以我们翻转目标量子比特（量子比特2）。\n    $$\n    \\text{CNOT}_{12}|111\\rangle = |1, 1\\oplus1, 1\\rangle = |101\\rangle\n    $$\n2.  将 $\\text{CNOT}_{23}$ 作用于结果 $|101\\rangle$：控制量子比特（量子比特2）是 $|0\\rangle$，所以目标量子比特（量子比特3）不发生翻转。\n    $$\n    \\text{CNOT}_{23}|101\\rangle = |1,0,1\\oplus0\\rangle = |101\\rangle\n    $$\n3.  将 $\\text{CNOT}_{31}$ 作用于结果 $|101\\rangle$：控制量子比特（量子比特3）是 $|1\\rangle$，所以我们翻转目标量子比特（量子比特1）。\n    $$\n    \\text{CNOT}_{31}|101\\rangle = |1\\oplus1, 0, 1\\rangle = |001\\rangle\n    $$\n所以，$U$ 对 $|111\\rangle$ 的作用是：\n$$\nU|111\\rangle = \\text{CNOT}_{31}\\text{CNOT}_{23}\\text{CNOT}_{12}|111\\rangle = |001\\rangle\n$$\n\n现在我们可以写出最终状态 $|\\psi_{final}\\rangle$：\n$$\n|\\psi_{final}\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle)\n$$\n这个最终态是 $|000\\rangle$ 和 $|001\\rangle$ 的叠加态。它也可以写成一个乘积态：$|\\psi_{final}\\rangle = |00\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) = |00\\rangle|+\\rangle_3$。\n\n最后一步是计算保真度 $F = |\\langle\\psi_{GHZ}|\\psi_{final}\\rangle|^2$。我们首先计算内积 $\\langle\\psi_{GHZ}|\\psi_{final}\\rangle$：\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\left( \\frac{1}{\\sqrt{2}}(\\langle 000| + \\langle 111|) \\right) \\left( \\frac{1}{\\sqrt{2}}(|000\\rangle + |001\\rangle) \\right)\n$$\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (\\langle 000|000\\rangle + \\langle 000|001\\rangle + \\langle 111|000\\rangle + \\langle 111|001\\rangle)\n$$\n利用计算基态的正交性 $\\langle ijk|lmn\\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$，我们得到：\n$$\n\\langle 000|000\\rangle = 1\n$$\n$$\n\\langle 000|001\\rangle = 0\n$$\n$$\n\\langle 111|000\\rangle = 0\n$$\n$$\n\\langle 111|001\\rangle = 0\n$$\n将这些值代回内积表达式中：\n$$\n\\langle\\psi_{GHZ}|\\psi_{final}\\rangle = \\frac{1}{2} (1 + 0 + 0 + 0) = \\frac{1}{2}\n$$\n最后，保真度是该内积的模的平方：\n$$\nF = \\left|\\frac{1}{2}\\right|^2 = \\frac{1}{4}\n$$", "answer": "$$\n\\boxed{\\frac{1}{4}}\n$$", "id": "103319"}, {"introduction": "理想的量子计算机模型假设门操作和量子比特状态都是完美的，但现实世界中的设备总会受到噪声和误差的干扰。这个实践将让你直面这一现实，通过分析一个小的相干误差对计算结果的影响。你将处理一个在初始状态制备时带有微小误差的三量子比特系统，并计算在经过托福利门后，其实际输出与理想输出之间的保真度。这个练习揭示了误差如何在量子电路中传播，并强调了发展容错量子计算技术的重要性。[@problem_id:103383]", "problem": "Toffoli 门，也称为 CCNOT 门，是一种普适可逆三量子比特门。它对计算基态 $|c_1 c_2 t\\rangle$（其中 $c_1, c_2$ 是控制量子比特，$t$ 是目标量子比特）的作用定义为 $U_{T}|c_1 c_2 t\\rangle = |c_1 c_2, t \\oplus (c_1 \\cdot c_2)\\rangle$，其中 $\\oplus$ 表示模2加法。\n\n考虑一个量子计算，其中一个三量子比特寄存器的预期初始状态为 $|\\psi_{\\text{ideal, in}}\\rangle = |1\\rangle_1 |1\\rangle_2 |0\\rangle_3 \\equiv |110\\rangle$。理想操作包括将一个 Toffoli 门 $U_{T}$ 应用于此状态，从而得到理想输出态 $|\\psi_{\\text{ideal, out}}\\rangle = U_{T} |\\psi_{\\text{ideal, in}}\\rangle$。\n\n然而，由于状态制备过程中的一个缺陷，第一个控制量子比特上被引入了一个小的相干误差。实际制备的状态由下式给出：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\n其中 $\\epsilon$ 是一个代表误差幅度的小实数参数。接着，将同样的 Toffoli 门 $U_T$ 应用于这个实际状态，产生实际输出态 $|\\psi_{\\text{actual, out}}\\rangle = U_{T} |\\psi_{\\text{actual, in}}\\rangle$。\n\n两个纯量子态 $|\\phi\\rangle$ 和 $|\\psi\\rangle$ 之间的保真度 $F$ 由 $F = |\\langle\\phi|\\psi\\rangle|^2$ 给出。\n\n计算理想输出态和实际输出态之间的保真度 $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$。请用 $\\epsilon$ 表示你的答案。", "solution": "解题过程包括三个主要步骤：\n1.  确定理想输出态 $|\\psi_{\\text{ideal, out}}\\rangle$。\n2.  确定实际输出态 $|\\psi_{\\text{actual, out}}\\rangle$。\n3.  使用定义计算保真度 $F$。\n\n**步骤 1：确定理想输出态**\n\n理想初始态为 $|\\psi_{\\text{ideal, in}}\\rangle = |110\\rangle$。我们将 Toffoli 门 $U_T$ 应用于此状态。Toffoli 门的作用是当且仅当两个控制量子比特都处于 $|1\\rangle$ 态时，翻转目标量子比特。\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = U_T |\\psi_{\\text{ideal, in}}\\rangle = U_T |110\\rangle$$\n\n在这里，控制量子比特（前两个）是 $|1\\rangle$ 和 $|1\\rangle$。因此，目标量子比特（第三个）被翻转（$0 \\rightarrow 1$）。\n\n$$|\\psi_{\\text{ideal, out}}\\rangle = |111\\rangle$$\n\n**步骤 2：确定实际输出态**\n\n实际初始态由下式给出：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\left(\\sqrt{1-\\epsilon^2}|1\\rangle_1 + \\epsilon|0\\rangle_1\\right) \\otimes |1\\rangle_2 \\otimes |0\\rangle_3$$\n\n我们可以将其展开到计算基上：\n$$|\\psi_{\\text{actual, in}}\\rangle = \\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle$$\n\n现在，我们将 Toffoli 门 $U_T$ 应用于此状态。根据量子力学的线性性质，我们可以将门分别应用于叠加态中的每一项：\n$$|\\psi_{\\text{actual, out}}\\rangle = U_T \\left(\\sqrt{1-\\epsilon^2}|110\\rangle + \\epsilon|010\\rangle\\right) = \\sqrt{1-\\epsilon^2} U_T|110\\rangle + \\epsilon U_T|010\\rangle$$\n\n我们计算 $U_T$ 在每个基态上的作用：\n-   对于 $|110\\rangle$，两个控制位都是 $|1\\rangle$，所以目标位翻转：$U_T|110\\rangle = |111\\rangle$。\n-   对于 $|010\\rangle$，两个控制位不都是 $|1\\rangle$（第一个控制位是 $|0\\rangle$），所以目标位不翻转：$U_T|010\\rangle = |010\\rangle$。\n\n将这些代回到实际输出态的表达式中：\n$$|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle$$\n\n**步骤 3：计算保真度**\n\n保真度为 $F = |\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle|^2$。首先，我们计算内积 $\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle$。\n\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\langle 111 | \\left(\\sqrt{1-\\epsilon^2}|111\\rangle + \\epsilon|010\\rangle\\right)$$\n\n使用内积的分配律：\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}\\langle 111 | 111 \\rangle + \\epsilon\\langle 111 | 010 \\rangle$$\n\n计算基态是规范正交的，即 $\\langle ijk|lmn \\rangle = \\delta_{il}\\delta_{jm}\\delta_{kn}$。因此：\n-   $\\langle 111 | 111 \\rangle = 1$\n-   $\\langle 111 | 010 \\rangle = 0$\n\n代入这些值：\n$$\\langle\\psi_{\\text{ideal, out}}|\\psi_{\\text{actual, out}}\\rangle = \\sqrt{1-\\epsilon^2}(1) + \\epsilon(0) = \\sqrt{1-\\epsilon^2}$$\n\n最后，我们通过对内积的模进行平方来计算保真度。由于 $\\epsilon$ 是一个小的实数参数，我们假设 $\\epsilon^2 \\le 1$，所以 $\\sqrt{1-\\epsilon^2}$ 是实数。\n$$F = |\\sqrt{1-\\epsilon^2}|^2 = 1-\\epsilon^2$$", "answer": "$$\n\\boxed{1 - \\epsilon^2}\n$$", "id": "103383"}]}