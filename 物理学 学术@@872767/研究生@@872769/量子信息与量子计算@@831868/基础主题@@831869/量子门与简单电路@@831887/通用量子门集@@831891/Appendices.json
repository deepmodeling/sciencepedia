{"hands_on_practices": [{"introduction": "量子隐形传态是展示量子纠缠和信息传输能力的经典协议，其标准电路依赖于一个受控非门（CNOT）。CNOT门和受控Z门（CZ）都是通用量子门集中的基本构建单元，它们之间通过局部酉操作（具体来说是哈德玛门）紧密相连。本练习 [@problem_id:176867] 将引导你在一个实际的算法背景下探索这种关系。通过将标准隐形传态电路中的CNOT门替换为CZ门，你将亲手分析这一基础门的变化如何影响整个协议的最终结果，从而加深对量子算法结构以及门之间局域等价性的理解。", "problem": "标准的量子隐形传态协议允许使用预先共享的纠缠量子比特对和经典通信信道，将一个未知的量子态从一个位置传输到另一个位置。\n\n考虑一个包含三个量子比特（标记为 A、B 和 C）的标准设置。量子比特 A 被制备在待隐形传态的量子态 $|\\psi\\rangle$ 上。量子比特 B 和 C 被制备在最大纠缠贝尔态 $|\\Phi^+\\rangle_{BC} = \\frac{1}{\\sqrt{2}}(|00\\rangle_{BC} + |11\\rangle_{BC})$ 上。\n\n标准的隐形传态电路按以下步骤进行：\n1.  对量子比特 A 和 B 应用一个受控非门 (CNOT)，其中 A 是控制位，B 是目标位。\n2.  对量子比特 A 应用一个阿达马门 (H)。\n3.  在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下对量子比特 A 和 B 进行测量。设测量结果分别为 $m_A \\in \\{0, 1\\}$ 和 $m_B \\in \\{0, 1\\}$。\n4.  将经典比特 $(m_A, m_B)$ 发送到量子比特 C 所在的位置。\n5.  对量子比特 C 应用一个恢复操作，如果 $m_B=1$ 则应用泡利-X 门，如果 $m_A=1$ 则应用泡利-Z 门。这个操作可以写成 $X^{m_B} Z^{m_A}$。\n\n在本问题中，我们考虑该协议的一个修改版本。步骤 1 中的 CNOT 门被替换为一个受控-Z 门 (CZ)，其中 $CZ|ij\\rangle = (-1)^{i \\cdot j}|ij\\rangle$。协议的所有其他步骤，包括恢复操作 $X^{m_B} Z^{m_A}$，都保持不变。\n\n待隐形传态的量子比特 A 的初始态是 $|+\\rangle$ 态，定义为 $|\\psi\\rangle_A = |+\\rangle_A = \\frac{1}{\\sqrt{2}}(|0\\rangle_A + |1\\rangle_A)$。\n\n计算修改后的协议完成后，量子比特 C 的最终态与理想的隐形传态态 $|+\\rangle_C$ 之间的保真度。密度矩阵 $\\rho$ 和纯态 $|\\phi\\rangle$ 之间的保真度 $F$ 由 $F = \\langle\\phi|\\rho|\\phi\\rangle$ 给出。", "solution": "1. 三个量子比特 A、B、C 的初始态为\n$$\n|\\Psi_0\\rangle\n=|+\\rangle_A\\otimes|\\Phi^+\\rangle_{BC}\n=\\frac{1}{\\sqrt2}(|0\\rangle_A+|1\\rangle_A)\n\\otimes\\frac{1}{\\sqrt2}(|00\\rangle_{BC}+|11\\rangle_{BC})\\,,\n$$\n因此\n$$\n|\\Psi_0\\rangle\n=\\frac{1}{2}\\bigl(|000\\rangle+|011\\rangle+|100\\rangle+|111\\rangle\\bigr)\\,.\n$$\n\n2. 对 A、B 应用受控-Z 门：\n$$\nCZ_{AB}\\,|\\Psi_0\\rangle\n=\\frac{1}{2}\\bigl(|000\\rangle+|011\\rangle+|100\\rangle-\\,|111\\rangle\\bigr)\\,.\n$$\n\n3. 对 A 应用阿达马门：对于每一项 $|i\\,j\\,k\\rangle$，将 $|i\\rangle_A$ 映射为 $\\frac{|0\\rangle+(-1)^i|1\\rangle}{\\sqrt2}$。简化后可得\n$$\n(H_A \\otimes I \\otimes I)(CZ_{AB} \\otimes I)|\\Psi_0\\rangle\n=\\frac{1}{2\\sqrt{2}}\\bigl(2|000\\rangle+2|111\\rangle\\bigr)\n=\\frac{1}{\\sqrt{2}}\\bigl(|000\\rangle+|111\\rangle\\bigr)\\,,\n$$\n即 GHZ 态。\n\n4. 在计算基下测量 A、B。GHZ 态只会产生 $(m_A,m_B)=(0,0)$ 或 $(1,1)$ 这两种结果，每种结果的概率均为 1/2，使得量子比特 C 分别处于 $|0\\rangle_C$ 或 $|1\\rangle_C$ 态。\n\n5. 应用恢复操作 $X^{m_B}Z^{m_A}$。对于 $(0,0)$，该操作为单位算符，使 $|0\\rangle_C$ 保持不变。对于 $(1,1)$，该操作为 $X Z$（等效于先作用 $Z$ 再作用 $X$）作用于 $|1\\rangle_C$ 上，得到 $-|0\\rangle_C$（不计全局相位，最终态为 $|0\\rangle_C$）。因此，C 的最终态总是 $|0\\rangle_C$。\n\n6. 与理想目标态 $|+\\rangle_C$ 的保真度为\n$$\nF=\\langle +|\\;|0\\rangle\\langle0|\\;|+\\rangle\n=|\\langle +|0\\rangle|^2\n=\\Bigl|\\tfrac1{\\sqrt2}\\Bigr|^2\n=\\tfrac12\\,.\n$$", "answer": "$$\\boxed{\\tfrac12}$$", "id": "176867"}, {"introduction": "量子计算的一个核心任务是利用特定硬件平台上可实现的物理相互作用来构建所需的逻辑门（例如CNOT门）。不同的纠缠门在构建通用计算能力方面并非生而平等。局域不变量理论（特别是Cartan分解）提供了一个强大的数学框架，用于对双量子比特门进行分类，并判断一个门是否能仅通过局域单比特操作变换为另一个。本练习 [@problem_id:176810] 将带你从简单的门操作提升到门合成的核心问题。通过计算构建一个CNOT门所需的最少物理相互作用次数，你将亲身体验如何运用这一强大的理论工具来评估给定门集的能力并设计高效的量子线路。", "problem": "在量子计算领域，通用量子门集是一组门操作的集合，任何量子计算都可以通过它来以任意精度近似。实现通用性的一种常见方法是将一个非平凡的双量子比特纠缠门与一组任意的单量子比特酉操作相结合。\n\n考虑一个量子处理器，它可以实现一个特定的双量子比特相互作用，该相互作用由酉算子 $U_{XY}(\\theta) = \\exp(-i\\theta(X \\otimes X + Y \\otimes Y))$ 描述，其中 $X$ 和 $Y$ 是标准的泡利矩阵，$\\theta$ 是一个可控的实数参数。除了这个纠缠门之外，任意的单量子比特酉操作 $U_1 \\otimes I$ 和 $I \\otimes U_2$ 可以在电路的任何位置应用于单个量子比特。\n\n受控非门（CNOT）是一个基本的双量子比特门，其在计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 下的矩阵表示为：\n$$ \\text{CNOT} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  0  1 \\\\ 0  0  1  0 \\end{pmatrix} $$\n\n你的任务是确定，对于每次应用时参数 $\\theta$ 的任意选择，要精确构建一个 CNOT 门所需的最少 $U_{XY}(\\theta)$ 门应用次数。", "solution": "1. 规范分解。任何双量子比特酉算子 $U$ 都可以通过局部酉变换写成\n$$\nU \\sim \\exp\\bigl[-i(c_1\\,X\\otimes X+c_2\\,Y\\otimes Y+c_3\\,Z\\otimes Z)\\bigr],\n$$\n其中规范坐标 $(c_1, c_2, c_3)$ 位于外尔腔内，满足 $\\frac{\\pi}{2} \\ge c_1\\ge c_2\\ge |c_3|$。\n\n2. 分解 $U_{XY}(\\theta)$。通过观察\n$$\nU_{XY}(\\theta)=\\exp\\bigl[-i\\theta\\,(X\\otimes X+Y\\otimes Y)\\bigr]\n$$\n它的规范坐标向量（未排序）是 $(\\theta,\\theta,0)$。假设 $\\theta \\in [0, \\pi/2]$，这已经在外尔腔内。\n\n3. 分解 CNOT。CNOT 门的规范坐标是\n$$\n(c'_1,c'_2,c'_3)=\\bigl(\\tfrac\\pi4,0,0\\bigr).\n$$\n\n4. 至少需要两次使用的必要性。单次使用 $U_{XY}(\\theta)$ 只能产生 $(\\theta,\\theta,0)$ 形式的点。由于 $\\theta=\\theta$ 且 CNOT 的坐标中 $c'_1 \\ne c'_2$，单次使用永远无法匹配 CNOT 的规范坐标（除非是平凡的单位门）。因此一次使用无法生成 CNOT。\n\n5. 两次使用的充分性。通过局域旋转，我们可以组合两个门 $U_{XY}(\\theta_1)$ 和 $U_{XY}(\\theta_2)$ 的作用。一个关键结果是，通过在两个门之间插入适当的局域操作，我们可以有效地将它们的规范坐标相加或相减。从 $(\\theta_1,\\theta_1,0)$ 和 $(\\theta_2,\\theta_2,0)$ 我们可以达到\n$$\n(\\theta_1+\\theta_2,\\;|\\theta_1-\\theta_2|,\\;0).\n$$\n我们希望这个结果与 CNOT 的坐标 $(\\pi/4, 0, 0)$ 相匹配。设置 $\\theta_1+\\theta_2=\\pi/4$ 和 $|\\theta_1-\\theta_2|=0$。\n这组方程的解是 $\\theta_1=\\theta_2=\\pi/8$。\n这表明，两次使用 $U_{XY}(\\theta)$（每次选择 $\\theta=\\pi/8$），并辅以适当的局域酉变换，就足以精确合成一个 CNOT 门。\n因此，最少应用次数是 2。", "answer": "$$\\boxed{2}$$", "id": "176810"}, {"introduction": "理想的量子门是一种数学上的抽象，而现实世界中的门操作总是会受到噪声的影响。量子计算机的实际性能受限于门操作过程中发生的错误。我们可以用量子通道来为这些错误建模，并使用诸如平均门保真度等指标来量化其影响，该指标衡量了含噪声的操作与理想操作的接近程度。这个练习 [@problem_id:176751] 将理论与实践联系起来，让你直面量子计算中的一个基本挑战：噪声。通过为一个由带噪声的基础门构成的合成CNOT门计算平均门保真度，你将学会如何量化错误在量子线路中的累积效应，这对于理解和评估真实量子器件的性能至关重要。", "problem": "一个作用于双量子比特系统上的 CNOT 门是由一个受控 Z (CZ) 门和两个阿达马 (H) 门序列合成的。该合成对应的幺正算符由 $U_{CNOT} = (I \\otimes H) U_{CZ} (I \\otimes H)$ 给出，其中 $I$ 是单量子比特单位算符， $U_{CZ}$ 和 $H$ 分别是 CZ 门和阿达马门的标准幺正矩阵。\n\n该合成包含三个顺序操作。这三个基本幺正操作 $U_i$（其中 $U_1 = I\\otimes H$, $U_2 = U_{CZ}$ 以及 $U_3 = I\\otimes H$）中，每一个的物理实现都是不完美的。在每一步 $i$ 中，双量子比特态 $\\rho$ 的演化并非由理想的幺正通道 $\\mathcal{U}_i(\\rho)=U_i\\rho U_i^\\dagger$ 描述，而是由一个双量子比特去极化通道 $\\mathcal{E}_i$ 描述，其形式为：\n$$\n\\mathcal{E}_i(\\rho) = (1-p)U_i\\rho U_i^\\dagger + p \\frac{I_4}{4}\n$$\n此处，$p$ 是每一步的错误概率，$I_4$ 是双量子比特希尔伯特空间上的单位算符。总的量子操作是这三个含噪声通道的复合，即 $\\mathcal{E}_{total} = \\mathcal{E}_3 \\circ \\mathcal{E}_2 \\circ \\mathcal{E}_1$。\n\n计算最终得到的通道 $\\mathcal{E}_{total}$ 与理想 CNOT 门 $U_{CNOT}$ 之间的平均门保真度 $F_{avg}$。一个通道 $\\mathcal{E}$ 与一个目标幺正算符 $U$ 之间的平均门保真度定义为：\n$$\nF_{avg}(\\mathcal{E}, U) = \\int d\\psi \\langle\\psi| U^\\dagger \\mathcal{E}(|\\psi\\rangle\\langle\\psi|) U |\\psi\\rangle\n$$\n其中积分是在归一化纯双量子比特态 $|\\psi\\rangle$ 的空间上对均匀（哈尔）测度进行的。", "solution": "1. 每个含噪声的步骤是一个双量子比特去极化通道\n   $$\\mathcal{E}_i(\\rho)=(1-p)\\,U_i\\,\\rho\\,U_i^\\dagger + p\\,\\frac{I_4}{4}\\,. $$\n2. 它们的复合 $\\mathcal{E}_{total} = \\mathcal{E}_3 \\circ \\mathcal{E}_2 \\circ \\mathcal{E}_1$ 给出\n   $$\n   \\mathcal{E}_{total}(\\rho) = (1-p)^3\\,U_3 U_2 U_1 \\rho U_1^\\dagger U_2^\\dagger U_3^\\dagger + \\left[1-(1-p)^3\\right]\\,\\frac{I_4}{4}\n   $$\n   推导过程如下：每当一个去极化项 $p I_4/4$ 出现时，后续的幺正通道 $\\mathcal{U}_j$ 和去极化通道 $\\mathcal{E}_j$ 都不会改变它，因为 $U_j (I_4/4) U_j^\\dagger = I_4/4$。因此，错误项会累积。\n3. 最终通道是一个具有总幺正部分 $U_{CNOT} = U_3 U_2 U_1$ 和总成功概率 $f=(1-p)^3$ 的去极化通道：\n   $$\\mathcal{E}_{total}(\\rho)\n     =f\\,U_{CNOT}\\rho U_{CNOT}^\\dagger + (1-f)\\,\\frac{I_4}{4}\\,. $$\n4. 与 $U_{CNOT}$ 的平均门保真度为\n   $$F_{avg}\n     =\\int d\\psi\\,\\langle\\psi|\\,U_{CNOT}^\\dagger\\,\\mathcal{E}_{total}(|\\psi\\rangle\\langle\\psi|)\\,U_{CNOT}\\,|\\psi\\rangle$$\n   将 $\\mathcal{E}_{total}$ 的表达式代入，并利用 $U_{CNOT}^\\dagger U_{CNOT} = I$：\n   $$\n   F_{avg} = \\int d\\psi\\,\\langle\\psi|\\, \\left( f|\\psi\\rangle\\langle\\psi| + (1-f)\\frac{U_{CNOT}^\\dagger I_4 U_{CNOT}}{4} \\right) \\,|\\psi\\rangle\n   $$\n   $$\n   F_{avg} = \\int d\\psi \\left( f \\langle\\psi|\\psi\\rangle\\langle\\psi|\\psi\\rangle + \\frac{1-f}{4} \\langle\\psi|I_4|\\psi\\rangle \\right)\n   = \\int d\\psi \\left( f \\cdot 1 + \\frac{1-f}{4} \\cdot 1 \\right)\n   $$\n   由于被积函数是常数，积分结果就是这个常数：\n   $$F_{avg} = f + \\frac{1-f}{4}\\,. $$\n5. 将 $f=(1-p)^3$ 代入，得到\n   $$F_{avg} = (1-p)^3 + \\frac{1 - (1-p)^3}{4} = \\frac{4(1-p)^3 + 1 - (1-p)^3}{4} = \\frac{3(1-p)^3+1}{4}\\,. $$", "answer": "$$\\boxed{\\frac{3(1-p)^3+1}{4}}$$", "id": "176751"}]}