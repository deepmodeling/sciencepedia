{"hands_on_practices": [{"introduction": "要掌握熵，第一步是根据给定的概率分布直接进行计算。这个练习 [@problem_id:1991819] 提供了一个简单明了的场景——一个有偏的骰子——来练习计算香农熵。它突显了熵如何量化结果的不可预测性，以及当结果不是等可能时，熵值会如何变化。", "problem": "一家制造商正在为一种机会游戏开发一种特殊的六面骰子。由于故意的配重不平衡，该骰子的构造使得其掷出'6'的概率恰好是掷出其他五个面中任意一个面的概率的三倍。掷出'1'到'5'面的概率彼此相等。\n\n计算这个有偏骰子单次投掷结果的无量纲香农熵。计算时请使用自然对数（底为 $e$）。\n\n请提供一个实数答案，并四舍五入到四位有效数字。", "solution": "设掷出面 $1$ 到 $5$ 的概率各为 $p$，掷出面 $6$ 的概率为 $3p$。根据归一化条件，有 $5p+3p=1$，因此 $p=\\frac{1}{8}$，概率分布为 $\\left(\\frac{1}{8},\\frac{1}{8},\\frac{1}{8},\\frac{1}{8},\\frac{1}{8},\\frac{3}{8}\\right)$。\n\n香农熵（单位为奈特）的定义为\n$$\nH=-\\sum_{i=1}^{6} p_{i}\\ln p_{i}.\n$$\n代入概率值，\n$$\nH=-\\left[5\\cdot \\frac{1}{8}\\ln\\!\\left(\\frac{1}{8}\\right)+\\frac{3}{8}\\ln\\!\\left(\\frac{3}{8}\\right)\\right].\n$$\n使用 $\\ln\\!\\left(\\frac{1}{8}\\right)=-\\ln 8$ 和 $\\ln\\!\\left(\\frac{3}{8}\\right)=\\ln 3-\\ln 8$，\n$$\nH=\\frac{5}{8}\\ln 8-\\frac{3}{8}\\left(\\ln 3-\\ln 8\\right)=\\ln 8-\\frac{3}{8}\\ln 3.\n$$\n\n使用自然对数计算数值，\n$$\n\\ln 8=3\\ln 2 \\approx 2.0794415416798357,\\quad \\ln 3 \\approx 1.0986122886681098,\n$$\n所以\n$$\nH \\approx 2.0794415416798357-\\frac{3}{8}\\cdot 1.0986122886681098 \\approx 1.6674619334292945.\n$$\n四舍五入到四位有效数字，得到 $H\\approx 1.667$。", "answer": "$$\\boxed{1.667}$$", "id": "1991819"}, {"introduction": "在掌握了基本计算之后，我们现在通过互信息来探索熵如何衡量变量之间的关系。这个问题 [@problem_id:132054] 将此概念置于密码学的实用背景下，其中明文和密文之间的互信息代表“信息泄露”。解决这个问题需要应用诸如 $I(X;Y) = H(Y) - H(Y|X)$ 等基本恒等式，从而以一种具体的方式将熵、条件熵和互信息联系起来。", "problem": "考虑一个简单的密码系统，其中明文消息 $X$ 使用密钥 $S$ 加密以生成密文 $Y$。变量 $X$、$S$ 和 $Y$ 是随机变量，表示来自集合 $\\mathcal{Z}_N = \\{0, 1, 2, \\dots, N-1\\}$ 的离散值，其中 $N=8$。加密操作是模 $N$ 加法：\n$$Y = (X + S) \\pmod 8$$\n\n明文 $X$ 和密钥 $S$ 是统计独立的。\n\n明文 $X$ 的概率质量函数 (PMF) 服从截断几何分布，由下式给出：\n$$P(X=k) = p_X(k) = \\frac{128}{255} \\left(\\frac{1}{2}\\right)^k \\quad \\text{for } k \\in \\mathcal{Z}_8$$\n\n密钥 $S$ 是从一个更小的可能性集合中选择的。其 PMF 为：\n$$p_S(s) = \\begin{cases} 1/2  \\text{if } s=0 \\\\ 1/2  \\text{if } s=4 \\\\ 0  \\text{otherwise} \\end{cases}$$\n\n该密码系统的信息泄露定义为明文 $X$ 和密文 $Y$ 之间的互信息 $I(X;Y)$。一个具有 PMF $p_Z(z)$ 的离散随机变量 $Z$ 的香农熵由 $H(Z) = -\\sum_z p_Z(z) \\log_2(p_Z(z))$ 给出，而互信息为 $I(X;Y) = H(Y) - H(Y|X)$。\n\n计算该系统的信息泄露 $I(X;Y)$ 的精确值。", "solution": "1. 相关公式\n   $$Y=(X+S)\\bmod 8,\\quad I(X;Y)=H(Y)-H(Y|X),$$  \n   $$H(Z)=-\\sum_z p_Z(z)\\log_2p_Z(z),\\quad H(Y|X)=H(S)\\ (\\text{since }Y\\mid X\\leftrightarrow S\\text{).}$$  \n\n2. 密钥的熵\n   $$p_S(0)=p_S(4)=\\tfrac12\\;\\Longrightarrow\\;H(S)=-2\\cdot\\tfrac12\\log_2\\tfrac12=1\\,. $$  \n\n3. $Y$ 的 PMF\n   $$p_Y(y)=\\sum_{s}p_S(s)\\,p_X(y-s)\n     =\\tfrac12\\,\\frac{128}{255}\\Bigl(2^{-y}+2^{-(y-4\\!\\!\\!\\mod8)}\\Bigr).$$  \n   对于 $y=0,\\dots,7$，可以找到以下值\n   $$p_Y(0)=p_Y(4)=\\frac{4}{15},\\;\n     p_Y(1)=p_Y(5)=\\frac{2}{15},\\;\n     p_Y(2)=p_Y(6)=\\frac{1}{15},\\;\n     p_Y(3)=p_Y(7)=\\frac{1}{30}\\,. $$\n\n4. 计算 $H(Y)$\n   \\begin{align*}\n   H(Y)\n   = -\\sum_{y=0}^7 p_Y(y)\\log_2p_Y(y)\n   = -2\\Bigl[\\tfrac{4}{15}\\log_2\\tfrac{4}{15}+\\tfrac{2}{15}\\log_2\\tfrac{2}{15}\n            +\\tfrac{1}{15}\\log_2\\tfrac{1}{15}+\\tfrac{1}{30}\\log_2\\tfrac{1}{30}\\Bigr]\\\\\n   =\\log_2(15)-\\tfrac{19}{15}\\,.\n   \\end{align*}\n\n5. 互信息\n   $$I(X;Y)=H(Y)-H(Y|X)=H(Y)-1\n             =\\log_2(15)-\\tfrac{19}{15}-1\n             =\\log_2(15)-\\tfrac{34}{15}\\,. $$", "answer": "$$\\boxed{\\log_2(15)-\\frac{34}{15}}$$", "id": "132054"}, {"introduction": "最后，我们来看一个在现代数据科学中至关重要的更高级应用：使用信息论度量进行模型拟合。这个练习 [@problem_id:132035] 引入了 Kullback-Leibler (KL) 散度，用它来为一组给定的经验数据找到最佳拟合的几何分布。这展示了最小化 KL 散度如何成为统计推断和参数估计的一个强大原则。", "problem": "设 $p_\\theta$ 是定义在正整数集合 $k \\in \\{1, 2, 3, \\dots\\}$ 上的几何分布，其概率质量函数（PMF）为：\n$$p_k(\\theta) = P(K=k) = (1-\\theta)^{k-1}\\theta$$\n其中 $\\theta \\in (0, 1)$ 是成功概率。\n\n设 $q$ 是一个定义在有限结果集 $\\{1, 2, 3\\}$ 上的经验概率分布，其概率如下：\n$$ q_1 = \\frac{1}{2}, \\quad q_2 = \\frac{1}{3}, \\quad q_3 = \\frac{1}{6} $$\n且对于 $k  3$，有 $q_k = 0$。\n\n从经验分布 $q$ 到模型分布 $p_\\theta$ 的库尔贝克-莱布勒（KL）散度由下式给出\n$$ D_{KL}(q || p_\\theta) = \\sum_{k=1}^{\\infty} q_k \\ln\\left(\\frac{q_k}{p_k(\\theta)}\\right) $$\n其中 $\\ln$ 表示自然对数。由于当 $k3$ 时 $q_k=0$，所以求和实际上只在 $k \\in \\{1, 2, 3\\}$ 上进行。\n\n求使 $D_{KL}(q || p_\\theta)$ 最小化的参数 $\\theta$ 的值。", "solution": "库尔贝克-莱布勒散度由下式给出：\n\n$$\nD_{KL}(q || p_\\theta) = \\sum_{k=1}^{\\infty} q_k \\ln\\left(\\frac{q_k}{p_k(\\theta)}\\right)\n$$\n\n由于当 $k  3$ 时 $q_k = 0$，求和简化为：\n\n$$\nD_{KL}(q || p_\\theta) = q_1 \\ln\\left(\\frac{q_1}{p_1(\\theta)}\\right) + q_2 \\ln\\left(\\frac{q_2}{p_2(\\theta)}\\right) + q_3 \\ln\\left(\\frac{q_3}{p_3(\\theta)}\\right)\n$$\n\n代入经验概率：\n\n$$\nq_1 = \\frac{1}{2}, \\quad q_2 = \\frac{1}{3}, \\quad q_3 = \\frac{1}{6}\n$$\n\n以及几何分布的概率质量函数（PMF）：\n\n$$\np_1(\\theta) = \\theta, \\quad p_2(\\theta) = (1-\\theta)\\theta, \\quad p_3(\\theta) = (1-\\theta)^2\\theta\n$$\n\n因此：\n\n$$\nD_{KL} = \\frac{1}{2} \\ln\\left(\\frac{\\frac{1}{2}}{\\theta}\\right) + \\frac{1}{3} \\ln\\left(\\frac{\\frac{1}{3}}{(1-\\theta)\\theta}\\right) + \\frac{1}{6} \\ln\\left(\\frac{\\frac{1}{6}}{(1-\\theta)^2\\theta}\\right)\n$$\n\n简化对数项：\n\n$$\nD_{KL} = \\frac{1}{2} \\left[ \\ln\\left(\\frac{1}{2}\\right) - \\ln(\\theta) \\right] + \\frac{1}{3} \\left[ \\ln\\left(\\frac{1}{3}\\right) - \\ln((1-\\theta)\\theta) \\right] + \\frac{1}{6} \\left[ \\ln\\left(\\frac{1}{6}\\right) - \\ln((1-\\theta)^2\\theta) \\right]\n$$\n\n展开：\n\n$$\nD_{KL} = \\frac{1}{2} \\ln\\left(\\frac{1}{2}\\right) - \\frac{1}{2} \\ln(\\theta) + \\frac{1}{3} \\ln\\left(\\frac{1}{3}\\right) - \\frac{1}{3} \\left[ \\ln(1-\\theta) + \\ln(\\theta) \\right] + \\frac{1}{6} \\ln\\left(\\frac{1}{6}\\right) - \\frac{1}{6} \\left[ 2\\ln(1-\\theta) + \\ln(\\theta) \\right]\n$$\n\n将含有 $\\theta$ 的项分组：\n\n$$\nD_{KL} = \\text{常数} - \\left( \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{6} \\right) \\ln(\\theta) - \\left( \\frac{1}{3} + \\frac{2}{6} \\right) \\ln(1-\\theta)\n$$\n\n简化系数：\n\n$$\n\\frac{1}{2} + \\frac{1}{3} + \\frac{1}{6} = \\frac{3}{6} + \\frac{2}{6} + \\frac{1}{6} = \\frac{6}{6} = 1\n$$\n\n\n$$\n\\frac{1}{3} + \\frac{2}{6} = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}\n$$\n\n因此：\n\n$$\nD_{KL} = \\text{常数} - \\ln(\\theta) - \\frac{2}{3} \\ln(1-\\theta)\n$$\n\n最小化 $D_{KL}$ 等价于最大化：\n\n$$\nM(\\theta) = \\ln(\\theta) + \\frac{2}{3} \\ln(1-\\theta)\n$$\n\n对 $\\theta$ 求导：\n\n$$\n\\frac{dM}{d\\theta} = \\frac{1}{\\theta} + \\frac{2}{3} \\cdot \\frac{1}{1-\\theta} \\cdot (-1) = \\frac{1}{\\theta} - \\frac{2}{3(1-\\theta)}\n$$\n\n令导数为零：\n\n$$\n\\frac{1}{\\theta} - \\frac{2}{3(1-\\theta)} = 0\n$$\n\n\n$$\n\\frac{1}{\\theta} = \\frac{2}{3(1-\\theta)}\n$$\n\n交叉相乘：\n\n$$\n3(1-\\theta) = 2\\theta\n$$\n\n\n$$\n3 - 3\\theta = 2\\theta\n$$\n\n\n$$\n3 = 5\\theta\n$$\n\n\n$$\n\\theta = \\frac{3}{5}\n$$\n\n为确认这是一个最小值点，检验二阶导数：\n\n$$\n\\frac{d^2M}{d\\theta^2} = -\\frac{1}{\\theta^2} - \\frac{2}{3} \\cdot \\frac{1}{(1-\\theta)^2} \\cdot (-1) \\cdot (-1) = -\\frac{1}{\\theta^2} - \\frac{2}{3(1-\\theta)^2}\n$$\n\n由于 $\\theta \\in (0,1)$，两项均为负，因此 $\\frac{d^2M}{d\\theta^2}  0$，这证实了 $M(\\theta)$ 取得最大值，从而 $D_{KL}$ 取得最小值。\n\n因此，使 $D_{KL}(q || p_\\theta)$ 最小化的 $\\theta$ 的值为 $\\frac{3}{5}$。", "answer": "$$ \\boxed{\\dfrac{3}{5}} $$", "id": "132035"}]}