{"hands_on_practices": [{"introduction": "掌握量子线路的第一步是能够自信地追踪一个态矢量在一系列理想门作用下的演化。这个练习 [@problem_id:165014] 提供了一个包含哈达玛门、级联 CNOT 门和受控相位门的常见线路结构的实践，旨在磨练分步进行状态传播和计算测量概率的基本技能。", "problem": "一个量子电路作用于一个由四个量子比特（标记为 $q_1, q_2, q_3, q_4$）组成的寄存器。系统的状态用 $|q_4q_3q_2q_1\\rangle$ 表示。初始时，系统处于基态 $|0000\\rangle$。依次应用以下量子门序列：\n\n1.  一个 Hadamard 门 ($H$) 应用于量子比特 $q_1$。\n\n2.  应用一个 CNOT 级联。它由三个连续的受控非门 ($CX$) 组成：\n    a. 一个以 $q_1$ 为控制量子比特、$q_2$ 为目标量子比特的 $CX$ 门 ($CX_{1,2}$)。\n    b. 一个以 $q_2$ 为控制量子比特、$q_3$ 为目标量子比特的 $CX$ 门 ($CX_{2,3}$)。\n    c. 一个以 $q_3$ 为控制量子比特、$q_4$ 为目标量子比特的 $CX$ 门 ($CX_{3,4}$)。\n\n3.  一个受控相位门 $C\\phi(\\alpha)$ 应用于量子比特对 $(q_4, q_1)$。当且仅当两个量子比特都处于 $|1\\rangle$ 态时，该门会施加一个相位因子 $e^{i\\alpha}$。它对这两个量子比特的计算基矢的作用是 $|xy\\rangle \\mapsto e^{i\\alpha \\cdot x \\cdot y} |xy\\rangle$。\n\n4.  应用步骤2中 CNOT 级联的逆操作。这通过以相反的顺序应用 CNOT 门来实现：\n    a. 一个以 $q_3$ 为控制量子比特、$q_4$ 为目标量子比特的 $CX$ 门 ($CX_{3,4}$)。\n    b. 一个以 $q_2$ 为控制量子比特、$q_3$ 为目标量子比特的 $CX$ 门 ($CX_{2,3}$)。\n    c. 一个以 $q_1$ 为控制量子比特、$q_2$ 为目标量子比特的 $CX$ 门 ($CX_{1,2}$)。\n\n在完成这整个操作序列后，对量子比特 $q_1$ 进行测量。计算发现量子比特 $q_1$ 处于 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ 态的概率。你的答案应该是一个用角度 $\\alpha$ 表示的表达式。", "solution": "初始状态为 $|0000\\rangle$。\n\n**步骤 1：对 $q_1$ 应用 Hadamard 门。**  \n作用在 $q_1$ 上的 Hadamard 门将 $|0\\rangle$ 变换为 $\\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，因此状态变为：  \n$$  \n\\frac{1}{\\sqrt{2}} (|0000\\rangle + |0001\\rangle)  \n$$\n\n**步骤 2：应用 CNOT 级联。**  \n- $CX_{1,2}$ (控制 $q_1$，目标 $q_2$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_1=0$，不翻转)  \n  - $|0001\\rangle \\to |0011\\rangle$ (控制位 $q_1=1$，$q_2$ 从 0 翻转到 1)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + |0011\\rangle)$  \n- $CX_{2,3}$ (控制 $q_2$，目标 $q_3$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_2=0$，不翻转)  \n  - $|0011\\rangle \\to |0111\\rangle$ (控制位 $q_2=1$，$q_3$ 从 0 翻转到 1)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + |0111\\rangle)$  \n- $CX_{3,4}$ (控制 $q_3$，目标 $q_4$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_3=0$，不翻转)  \n  - $|0111\\rangle \\to |1111\\rangle$ (控制位 $q_3=1$，$q_4$ 从 0 翻转到 1)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + |1111\\rangle)$  \n\n**步骤 3：对 $(q_4, q_1)$ 应用受控相位门 $C\\phi(\\alpha)$。**  \n如果 $q_4$ 和 $q_1$ 均为 1，则该门施加一个相位 $e^{i\\alpha}$：  \n- $|0000\\rangle$: $q_4=0$, $q_1=0$ $\\to$ 相位 $e^{i\\alpha \\cdot 0 \\cdot 0} = 1$  \n- $|1111\\rangle$: $q_4=1$, $q_1=1$ $\\to$ 相位 $e^{i\\alpha \\cdot 1 \\cdot 1} = e^{i\\alpha}$  \n状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + e^{i\\alpha} |1111\\rangle)$  \n\n**步骤 4：以相反顺序应用逆 CNOT 级联。**  \n- $CX_{3,4}$ (控制 $q_3$，目标 $q_4$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_3=0$，不翻转)  \n  - $|1111\\rangle \\to |0111\\rangle$ (控制位 $q_3=1$，$q_4$ 从 1 翻转到 0)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + e^{i\\alpha} |0111\\rangle)$  \n- $CX_{2,3}$ (控制 $q_2$，目标 $q_3$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_2=0$，不翻转)  \n  - $|0111\\rangle \\to |0011\\rangle$ (控制位 $q_2=1$，$q_3$ 从 1 翻转到 0)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + e^{i\\alpha} |0011\\rangle)$  \n- $CX_{1,2}$ (控制 $q_1$，目标 $q_2$)：  \n  - $|0000\\rangle \\to |0000\\rangle$ (控制位 $q_1=0$，不翻转)  \n  - $|0011\\rangle \\to |0001\\rangle$ (控制位 $q_1=1$，$q_2$ 从 1 翻转到 0)  \n  状态：$\\frac{1}{\\sqrt{2}} (|0000\\rangle + e^{i\\alpha} |0001\\rangle) = |000\\rangle \\otimes \\frac{1}{\\sqrt{2}} (|0\\rangle + e^{i\\alpha} |1\\rangle)$ (对于量子比特 $(q_4, q_3, q_2, q_1)$)  \n\n$q_1$ 的状态是 $\\psi_{q_1} = \\frac{1}{\\sqrt{2}} (|0\\rangle + e^{i\\alpha} |1\\rangle)$。  \n测量在基矢 $|-\\rangle = \\frac{1}{\\sqrt{2}} (|0\\rangle - |1\\rangle)$ 上进行。  \n测量到 $|-\\rangle$ 的概率是 $|\\langle - | \\psi_{q_1} \\rangle|^2$。  \n计算内积：  \n$$  \n\\langle - | \\psi_{q_1} \\rangle = \\left( \\frac{1}{\\sqrt{2}} (\\langle 0| - \\langle 1|) \\right) \\left( \\frac{1}{\\sqrt{2}} (|0\\rangle + e^{i\\alpha} |1\\rangle) \\right) = \\frac{1}{2} (\\langle 0|0\\rangle - e^{i\\alpha} \\langle 1|1\\rangle) = \\frac{1}{2} (1 - e^{i\\alpha})  \n$$  \n因为 $\\langle 0|1\\rangle = \\langle 1|0\\rangle = 0$ 且 $\\langle 0|0\\rangle = \\langle 1|1\\rangle = 1$。  \n现在，计算模的平方：  \n$$  \n|\\langle - | \\psi_{q_1} \\rangle|^2 = \\left| \\frac{1}{2} (1 - e^{i\\alpha}) \\right|^2 = \\frac{1}{4} |1 - e^{i\\alpha}|^2  \n$$  \n计算 $|1 - e^{i\\alpha}|^2$：  \n$$  \n|1 - e^{i\\alpha}|^2 = (1 - e^{i\\alpha})(1 - e^{-i\\alpha}) = 1 - e^{-i\\alpha} - e^{i\\alpha} + e^{i\\alpha} e^{-i\\alpha} = 1 - (e^{i\\alpha} + e^{-i\\alpha}) + 1 = 2 - 2 \\cos \\alpha  \n$$  \n因此，  \n$$  \n|\\langle - | \\psi_{q_1} \\rangle|^2 = \\frac{1}{4} (2 - 2 \\cos \\alpha) = \\frac{1}{4} \\cdot 2 (1 - \\cos \\alpha) = \\frac{1}{2} (1 - \\cos \\alpha)  \n$$  \n使用恒等式 $1 - \\cos \\alpha = 2 \\sin^2(\\alpha/2)$，  \n$$  \n|\\langle - | \\psi_{q_1} \\rangle|^2 = \\frac{1}{2} \\cdot 2 \\sin^2\\left(\\frac{\\alpha}{2}\\right) = \\sin^2\\left(\\frac{\\alpha}{2}\\right)  \n$$  \n概率为 $\\sin^2(\\alpha/2)$。", "answer": "$$ \\boxed{\\sin^{2}\\left(\\dfrac{\\alpha}{2}\\right)} $$", "id": "165014"}, {"introduction": "理想的量子线路是一个有用的抽象，但现实世界中的量子计算机容易受到噪声的干扰。这个实践 [@problem_id:165011] 介绍了退偏振通道这一常见的噪声模型，并使用保真度的概念来量化实际操作与其理想对应操作之间的偏差。理解这一点对于评估量子硬件的性能至关重要。", "problem": "量子计算中的一个基本操作是创建纠缠态。一个生成贝尔态（具体来说是状态 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$）的标准电路作用于初始双量子比特态 $|\\psi_{in}\\rangle = |00\\rangle$。该电路由一个作用于第一个量子比特的 Hadamard 门（$H$）和一个受控非门（CNOT）组成，其中第一个量子比特是控制位，第二个是目标位。\n\n理想门在计算基矢上的作用如下：\n- Hadamard 门：$H|0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$ 和 $H|1\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。\n- CNOT 门：$CNOT|x, y\\rangle = |x, y \\oplus x\\rangle$，其中 $\\oplus$ 表示模2加法。\n\n在真实的量子计算机中，操作会受到噪声的影响。我们通过考虑一个带噪声的贝尔态制备电路来对此进行建模。在这个带噪声的电路中，CNOT 门之后紧跟着一个双量子比特去极化通道 $\\mathcal{E}$。该通道描述了一个过程：状态以概率 $p$ 被最大混合态所取代，并以概率 $1-p$ 保持不变。该通道对任意双量子比特密度矩阵 $\\rho$ 的作用由下式给出：\n$$\n\\mathcal{E}(\\rho) = (1-p)\\rho + p\\frac{I_4}{4}\n$$\n其中 $I_4$ 是双量子比特希尔伯特空间上的 $4 \\times 4$ 单位矩阵。\n\n令 $|\\psi_{ideal}\\rangle$ 为理想电路的最终状态，$\\rho_{noisy}$ 为带噪声电路的最终密度矩阵。纯态 $|\\psi\\rangle$ 和混合态 $\\rho$ 之间的保真度是衡量它们接近程度的度量，定义为 $F(|\\psi\\rangle, \\rho) = \\sqrt{\\langle\\psi|\\rho|\\psi\\rangle}$。\n\n计算保真度 $F(|\\psi_{ideal}\\rangle, \\rho_{noisy})$ 作为误差概率 $p$ 的函数。", "solution": "求解过程包括三个主要步骤：\n1.  推导理想最终状态 $|\\psi_{ideal}\\rangle$。\n2.  确定带噪声的最终状态 $\\rho_{noisy}$。\n3.  计算这两个状态之间的保真度。\n\n**步骤1：理想最终状态**\n\n双量子比特系统的初始状态为 $|\\psi_{in}\\rangle = |00\\rangle = |0\\rangle \\otimes |0\\rangle$。\n\n首先，对第一个量子比特应用 Hadamard 门。系统的状态变为：\n$$\n|\\psi_1\\rangle = (H \\otimes I) |00\\rangle = (H|0\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle) \\otimes |0\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle)\n$$\n\n接着，应用一个 CNOT 门，其中第一个量子比特为控制位，第二个为目标位。CNOT 门线性作用于叠加态上：\n$$\n|\\psi_{ideal}\\rangle = \\text{CNOT} |\\psi_1\\rangle = \\text{CNOT} \\left( \\frac{1}{\\sqrt{2}}(|00\\rangle + |10\\rangle) \\right)\n$$\n$$\n|\\psi_{ideal}\\rangle = \\frac{1}{\\sqrt{2}} (\\text{CNOT}|00\\rangle + \\text{CNOT}|10\\rangle)\n$$\n根据 CNOT 门的定义，$\\text{CNOT}|00\\rangle = |00\\rangle$ 且 $\\text{CNOT}|10\\rangle = |11\\rangle$。将它们代入表达式中：\n$$\n|\\psi_{ideal}\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)\n$$\n这就是著名的贝尔态 $|\\Phi^+\\rangle$。这个理想纯态的密度矩阵是 $\\rho_{ideal} = |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|$。\n\n**步骤2：带噪声的最终状态**\n\n在带噪声的电路中，首先执行理想操作（Hadamard 和 CNOT），得到状态 $\\rho_{ideal}$。然后，这个状态通过双量子比特去极化通道 $\\mathcal{E}$。因此，带噪声电路的最终状态 $\\rho_{noisy}$ 为：\n$$\n\\rho_{noisy} = \\mathcal{E}(\\rho_{ideal})\n$$\n代入通道 $\\mathcal{E}$ 的定义：\n$$\n\\rho_{noisy} = (1-p) \\rho_{ideal} + p \\frac{I_4}{4}\n$$\n其中 $\\rho_{ideal} = |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|$。所以，\n$$\n\\rho_{noisy} = (1-p) |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}| + \\frac{p}{4} I_4\n$$\n\n**步骤3：保真度计算**\n\n理想纯态 $|\\psi_{ideal}\\rangle$ 和带噪声的混合态 $\\rho_{noisy}$ 之间的保真度由以下公式给出：\n$$\nF = F(|\\psi_{ideal}\\rangle, \\rho_{noisy}) = \\sqrt{\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle}\n$$\n我们计算平方根内的项 $\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle$：\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = \\langle\\psi_{ideal}| \\left( (1-p) |\\psi_{ideal}\\rangle\\langle\\psi_{ideal}| + \\frac{p}{4} I_4 \\right) |\\psi_{ideal}\\rangle\n$$\n利用内积的线性性质，我们可以将其分成两项：\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = (1-p) \\langle\\psi_{ideal}|(|\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|)|\\psi_{ideal}\\rangle + \\frac{p}{4} \\langle\\psi_{ideal}|I_4|\\psi_{ideal}\\rangle\n$$\n现在，我们计算每一项。由于 $|\\psi_{ideal}\\rangle$ 是一个归一化的态矢量，我们有 $\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle = 1$。\n第一项变为：\n$$\n\\langle\\psi_{ideal}|(|\\psi_{ideal}\\rangle\\langle\\psi_{ideal}|)|\\psi_{ideal}\\rangle = (\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle)(\\langle\\psi_{ideal}|\\psi_{ideal}\\rangle) = (1)(1) = 1\n$$\n第二项涉及单位算符 $I_4$：\n$$\n\\langle\\psi_{ideal}|I_4|\\psi_{ideal}\\rangle = \\langle\\psi_{ideal}|\\psi_{ideal}\\rangle = 1\n$$\n将这些结果代回内积的表达式中：\n$$\n\\langle\\psi_{ideal}|\\rho_{noisy}|\\psi_{ideal}\\rangle = (1-p)(1) + \\frac{p}{4}(1) = 1 - p + \\frac{p}{4} = 1 - \\frac{3p}{4}\n$$\n最后，保真度是这个结果的平方根：\n$$\nF = \\sqrt{1 - \\frac{3p}{4}}\n$$", "answer": "$$ \\boxed{\\sqrt{1 - \\frac{3p}{4}}} $$", "id": "165011"}, {"introduction": "由于噪声是不可避免的，我们必须设计能够检测到错误何时发生的线路。这个练习 [@problem_id:165134] 探讨了一种“探错”小工具，它使用一个辅助的“标志”量子比特来指示 CNOT 操作期间是否存在错误。分析这个线路展示了容错量子计算的一个基本原理。", "problem": "一个三量子比特的量子电路被设计用于执行一个可检测错误的CNOT操作。该电路由一个控制量子比特（C）、一个目标量子比特（T）和一个标志辅助量子比特（F）组成。从C到T的CNOT操作通过以下门序列实现：$U = U_{CF}^{(3)} U_{CT}^{(2)} U_{CF}^{(1)}$，其中 $U_{AB}^{(i)}$ 是一个CNOT门，A为控制比特，B为目标比特，上标表示施加的顺序。\n\n系统初始化时，控制量子比特处于状态 $|\\psi\\rangle_C = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，目标和标志量子比特处于状态 $|0\\rangle$，即总的初始状态为 $|\\Psi_{init}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle_C + |1\\rangle_C) \\otimes |0\\rangle_T \\otimes |0\\rangle_F$。\n\n该电路受到控制量子比特上的一个错误的影响。具体来说，一个强度为 $p$ 的单量子比特去极化通道 $\\mathcal{E}_p$ 作用于控制量子比特C上，其作用时间在第一个门 $U_{CF}^{(1)}$ *之后*，但在第二个门 $U_{CT}^{(2)}$ *之前*。去极化通道对单量子比特密度矩阵 $\\rho$ 的作用由下式给出：\n$$\n\\mathcal{E}_p(\\rho) = (1-p) \\rho + p \\frac{I}{2}\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n\n标志量子比特的目的是发出错误已发生的信号。计算在整个电路 $U$ 结束时，在计算基下测量标志量子比特F得到结果1的概率。", "solution": "1. 经过第一个CNOT门 $U_{CF}^{(1)}$ 后，纯态为\n\n$$\n|\\Psi_{1}\\rangle\n=\\tfrac{1}{\\sqrt2}\\bigl(|0_C0_T0_F\\rangle+|1_C0_T1_F\\rangle\\bigr)\\,,\n$$\n\n因此\n\n$$\n\\rho_{1}=|\\Psi_{1}\\rangle\\langle\\Psi_{1}|\\,.\n$$\n\n2. 作用在C上的去极化通道产生\n\n$$\n\\rho_{2}\n=(1-p)\\,\\rho_{1}\n+ p\\;\\Bigl(\\tfrac{I_C}{2}\\otimes\\text{Tr}_C[\\rho_{1}]\\Bigr)\\,.\n$$\n\n3. 我们计算对标志比特为1的概率的两个贡献：\n   A. 来自 $(1-p)\\rho_{1}$ 项。由于剩下的门是先在 $C \\to T$ 上实现一个完美CNOT，再在 $C \\to F$ 上实现一个CNOT，可以发现最终的纯态是 $|\\Psi_{\\rm out}\\rangle=\\tfrac1{\\sqrt2}(|000\\rangle+|110\\rangle)$，对此态有 $\\text{Pr}(F=1)=0$。因此\n   \n$$\n   P_A=(1-p)\\times0=0.\n   $$\n\n   B. 来自 $p$ 项。注意\n   $\\text{Tr}_C[\\rho_{1}]=\\tfrac12\\bigl(|00\\rangle\\langle00|+|01\\rangle\\langle01|\\bigr)_{TF}$。\n   因此，去极化后的状态为\n   $\\rho_{\\rm dep}\n   =\\tfrac14\\,I_C\\otimes\\bigl(|00\\rangle\\langle00|+|01\\rangle\\langle01|\\bigr)_{TF}.$\n   将每个基矢 $|c,t,f\\rangle$ 依次通过\n   $U_{CT}^{(2)}$ 和 $U_{CF}^{(3)}$ 进行演化，可以发现四个等权项中有两项会产生 $F=1$。因此\n   \n$$\n   P_B\n   =p\\times\\tfrac12\n   =\\frac p2.\n   $$\n\n4. 求和，\n\n$$\n\\text{Pr}(F=1)=P_A+P_B=0+\\frac p2=\\frac p2.\n$$", "answer": "$$\\boxed{\\frac p2}$$", "id": "165134"}]}