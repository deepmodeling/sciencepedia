{"hands_on_practices": [{"introduction": "编码理论中的一个核心技巧是识别不同表述下的等价结构。一个以某种方式（例如作为BCH码）定义的码，可能与另一个更熟悉的码（例如汉明码）完全相同。识别出这种等价性可以极大地简化对其对偶码性质的分析，因为其对偶码本身也可能是一个著名的码。本练习 [@problem_id:54162] 挑战我们超越码的初始描述，利用其结构特性来确定其对偶码的真实最小距离。", "problem": "一个线性码 $C$ 是 $\\mathbb{F}_q^n$ 的一个向量子空间。其对偶码为 $C^\\perp = \\{v \\in \\mathbb{F}_q^n | v \\cdot c = 0 \\text{ 对所有 } c \\in C\\}$, 其中点积是标准点积。循环码是一种线性码，其性质是任何码字的循环移位也都是一个码字。在 $\\mathbb{F}_q$ 上，长度为 $n$ 且满足 $\\text{gcd}(n,q)=1$ 的循环码可以由环 $\\mathbb{F}_q[x]/(x^n-1)$ 中的理想来表示。每个这样的码都由一个唯一的、能整除 $x^n-1$ 的首一多项式 $g(x)$ 生成。一个码 $C$ 的最小距离 $d(C)$ 是其非零码字的最小汉明重量。一个向量的汉明重量是其非零分量的数量。\n\n一个长度为 $n=2^m-1$、设计距离为 $\\delta$ 的窄义二元 BCH 码是一个在 $\\mathbb{F}_2$ 上的循环码，其生成多项式 $g(x)$ 是 $\\mathbb{F}_2$ 上以 $\\alpha, \\alpha^2, \\dots, \\alpha^{\\delta-1}$ 为根的最低次多项式，其中 $\\alpha$ 是有限域 $\\mathbb{F}_{2^m}$ 的一个本原元。BCH 码的最小距离 $d$ 保证满足 $d \\ge \\delta$。\n\n计算长度为 $n=15$、设计距离为 $\\delta=3$ 的窄义二元 BCH 码 $C$ 的对偶码 $C^\\perp$ 的真实最小距离。", "solution": "问题要求计算一个特定 BCH 码的对偶码的最小距离。我们用 $C$ 表示该码，用 $C^\\perp$ 表示其对偶码。\n\n1.  **确定 BCH 码的参数。**\n    该码是二元码，所以域是 $\\mathbb{F}_2$。\n    长度为 $n=15$。由于 $n=2^m-1$，我们有 $15=2^4-1$，所以 $m=4$。码的构造涉及有限域 $\\mathbb{F}_{2^4} = \\mathbb{F}_{16}$。\n    设计距离为 $\\delta=3$。\n\n2.  **确定码 $C$ 的生成多项式。**\n    该码是窄义 BCH 码，因此其生成多项式 $g(x)$ 是根集 $\\{\\alpha, \\alpha^2, \\dots, \\alpha^{\\delta-1}\\}$ 在 $\\mathbb{F}_2$ 上的最小多项式，其中 $\\alpha$ 是 $\\mathbb{F}_{16}$ 的一个本原元。在这里，这个集合是 $\\{\\alpha, \\alpha^2\\}$。\n\n    一个元素 $\\beta \\in \\mathbb{F}_{2^m}$ 的最小多项式由其模 $n$ 的分圆陪集构造。整数 $i$ 的分圆陪集是 $C_i = \\{i \\cdot 2^j \\pmod{n} | j = 0, 1, 2, \\dots \\}$。\n    对于 $i=1$，模 15 的分圆陪集是 $C_1 = \\{1 \\cdot 2^0, 1 \\cdot 2^1, 1 \\cdot 2^2, 1 \\cdot 2^3\\} \\pmod{15} = \\{1, 2, 4, 8\\}$。\n    由于 $2 \\in C_1$，元素 $\\alpha^1$ 和 $\\alpha^2$ 在 $\\mathbb{F}_2$ 上有相同的最小多项式。设其为 $M_1(x)$。\n    生成多项式 $g(x)$ 是其根的最小多项式的最小公倍式。在这种情况下，$g(x) = M_1(x)$。\n    $g(x)$ 的次数是分圆陪集的大小，即 $|C_1|=4$。\n    $g(x)$ 的根是 $\\{\\alpha, \\alpha^2, \\alpha^4, \\alpha^8\\}$。\n\n3.  **识别码 $C$。**\n    一个由多项式 $c(x)$ 表示的码字属于码 $C$ 当且仅当 $g(x)$ 整除 $c(x)$。这等价于对于 $g(x)$ 的所有根 $\\beta$，都有 $c(\\beta)=0$。由于 $g(x)$ 的所有根都是共轭的，这等价于单个条件 $c(\\alpha)=0$。\n    条件 $c(\\alpha) = \\sum_{i=0}^{14} c_i \\alpha^i = 0$ 是 $\\mathbb{F}_{16}$ 中的一个方程。我们可以将 $\\mathbb{F}_{16}$ 的元素表示为 $\\mathbb{F}_2$ 上的 4 维向量。设 $\\{e_0, e_1, e_2, e_3\\}$ 是 $\\mathbb{F}_{16}$ 在 $\\mathbb{F}_2$ 上的一个基。那么 $\\mathbb{F}_{16}$ 中的单个方程等价于 $\\mathbb{F}_2$ 上的 $m=4$ 个线性方程。\n    这意味着码 $C$ 由一个大小为 $4 \\times 15$ 的校验矩阵 $H$ 定义。\n    一个标准的选择是多项式基 $\\{1, \\alpha, \\alpha^2, \\alpha^3\\}$。我们将 $\\alpha^j$ 在这个基下写成列向量 $\\mathbf{v}_j$，其中 $j=0, \\dots, 14$。条件 $c(\\alpha)=0$ 变为 $\\sum_{i=0}^{14} c_i \\mathbf{v}_i = \\mathbf{0}$。这可以写成 $H \\mathbf{c}^T = \\mathbf{0}^T$，其中 $H$ 的列是向量 $\\mathbf{v}_j$，且 $\\mathbf{c}=(c_0, ..., c_{14})$。\n    $H$ 的列是 $\\{\\alpha^0, \\alpha^1, \\dots, \\alpha^{14}\\}$ 的向量表示。由于 $\\alpha$ 是一个本原元，这些是 $\\mathbb{F}_2^4$ 中所有 15 个不同的非零向量。\n    一个由校验矩阵定义的码，如果其校验矩阵的列是 $\\mathbb{F}_2^m$ 中所有不同的非零向量，这正是二元汉明码 (binary Hamming code) 的定义，记为 $\\text{Ham}(m, 2)$。\n    所以，$C$ 是汉明码 $\\text{Ham}(4, 2)$。\n    该码的参数是 $[n, k, d] = [2^m-1, 2^m-1-m, 3] = [15, 11, 3]$。维数是 $k=n-\\deg(g(x)) = 15-4=11$。最小距离是 $d=3$，等于设计距离 $\\delta$。\n\n4.  **识别对偶码 $C^\\perp$。**\n    汉明码 $\\text{Ham}(m, 2)$ 的对偶码被称为单纯形码 (Simplex code)，记为 $S_m$。\n    $C^\\perp$ 的生成矩阵是 $C$ 的校验矩阵 $H$。因此，$C^\\perp$ 是一个长度为 $n=15$、维数为 $k^\\perp = m = 4$ 的线性码。\n\n5.  **计算对偶码 $C^\\perp$ 的最小距离。**\n    单纯形码 $S_m$ 的码字是 $H$ 的行的所有线性组合。\n    $S_m$ 的非零码字的形式为 $\\mathbf{u}H$，其中 $\\mathbf{u} \\in \\mathbb{F}_2^m$ 是一个非零行向量。\n    这样一个码字的汉明重量由 $H$ 的列向量 $\\mathbf{v}_j$ 中满足点积 $\\mathbf{u} \\cdot \\mathbf{v}_j \\neq 0$ 的数量给出。在 $\\mathbb{F}_2$ 中，这等价于 $\\mathbf{u} \\cdot \\mathbf{v}_j = 1$。\n    对于任何固定的非零向量 $\\mathbf{u} \\in \\mathbb{F}_2^m$，方程 $\\mathbf{u} \\cdot \\mathbf{v} = 1$ 在向量空间 $\\mathbb{F}_2^m$ 中定义了一个仿射超平面。这个超平面恰好包含 $2^{m-1}$ 个向量 $\\mathbf{v}$。\n    由于 $H$ 的列包含了 $\\mathbb{F}_2^m$ 中所有 $2^m-1$ 个非零向量，所以 $S_m$ 中任何非零码字的重量都恰好是 $2^{m-1}$。\n    在我们的例子中，$m=4$，所以 $C^\\perp = S_4$ 中任何非零码字的重量都是 $2^{4-1} = 2^3 = 8$。\n    由于所有非零码字的重量都是 8，所以 $C^\\perp$ 的最小距离是 8。\n\n对偶码 $C^\\perp$ 的真实最小距离是 8。", "answer": "$$ \\boxed{8} $$", "id": "54162"}, {"introduction": "强大的纠错码常常可以从组合结构（如区组设计）中构造出来。这些组合设计的性质可能对码及其对偶码产生意想不到的影响。本练习 [@problem_id:54077] 探讨了码的“核”（hull）$C \\cap C^\\perp$ 的概念，并揭示了设计参数与码在 $\\mathbb{F}_2$ 上的自正交性之间一个优美的联系。", "problem": "一个参数为 $(v, k, \\lambda)$ 的**对称区组设计**是一个序对 $(X, \\mathcal{B})$，其中 $X$ 是一个包含 $v$ 个点的集合，$\\mathcal{B}$ 是 $X$ 的 $v$ 个子集的集合，这些子集称为区组，满足：\n1.  每个区组恰好包含 $k$ 个点。\n2.  每对不同的点恰好包含在 $\\lambda$ 个区组中。\n\n这种设计的**关联矩阵** $M$ 是一个 $v \\times v$ 矩阵，其中如果第 $i$ 个点在第 $j$ 个区组中，则 $M_{ij} = 1$，否则 $M_{ij} = 0$。由于该设计是对称的，我们也可以将 $M$ 的行视为区组的关联向量。\n\n一个码长为 $n$ 的**二元线性码** $C$ 是 $\\mathbb{F}_2^n$ 的一个线性子空间。码 $C$ 可以由一个**生成矩阵** $G$ 指定，其行向量张成 $C$。**对偶码**，记作 $C^\\perp$，定义为 $C^\\perp = \\{y \\in \\mathbb{F}_2^n \\mid x \\cdot y = 0 \\text{ for all } x \\in C\\}$，其中点积是在模2下计算的。一个码 $C$ 的**壳** (hull) 是该码与其对偶码的交，即 $C \\cap C^\\perp$。\n\n考虑一个码长为 $n=v$ 的二元线性码 $C$，其生成矩阵是一个参数为 $(v, k, \\lambda) = (11, 5, 2)$ 的对称设计的关联矩阵 $M$。\n\n求此码的壳的维数，即 $\\dim(C \\cap C^\\perp)$。", "solution": "给定一个对称 $(v,k,\\lambda)=(11,5,2)$–设计，其关联矩阵为 $M\\in\\{0,1\\}^{11\\times 11}$。码 $C$ 是由 $M$ 的行向量在 $\\mathbb{F}_2$ 上张成的子空间。我们检验行向量的格拉姆矩阵 $MM^T$。\n\n1.  在整数域中，对称设计有一个标准恒等式：\n   $$\n   M M^T = (k-\\lambda)I_v + \\lambda J_v\n   $$\n   其中 $I_v$ 是 $v\\times v$ 单位矩阵，$J_v$ 是全1矩阵。\n\n2.  代入 $(v, k, \\lambda)=(11, 5, 2)$，\n   $$\n   M M^T = (5-2)I_{11} + 2 J_{11} = 3 I_{11} + 2 J_{11}.\n   $$\n\n3.  在模2下运算（即在 $\\mathbb{F}_2$ 中运算）得到\n   $$\n   M M^T \\equiv 3 I_{11} + 2 J_{11} \\equiv I_{11} \\pmod{2}.\n   $$\n\n4.  由于在 $\\mathbb{F}_2$ 上 $M M^T = I_{11}$，$M$ 在 $\\mathbb{F}_2^{11\\times11}$ 中是可逆的。因此 $\\text{rank}(M)=11$，且码\n   $$\n   C=\\text{RowSpace}_{\\mathbb{F}_2}(M)\n   $$\n   的维数为 $\\dim(C)=11$。这意味着 $C = \\mathbb{F}_2^{11}$。\n\n5.  根据维度关系，其在 $\\mathbb{F}_2^{11}$ 中的对偶码 $C^\\perp$ 的维数为\n   $$\n   \\dim(C^\\perp)=11-\\dim(C)=11-11=0,\n   $$\n   所以 $C^\\perp=\\{\\mathbf{0}\\}$。\n\n6.  码的壳是 $C \\cap C^\\perp = \\mathbb{F}_2^{11} \\cap \\{\\mathbf{0}\\} = \\{\\mathbf{0}\\}$。\n   因此，其维数为 $0$。", "answer": "$$\\boxed{0}$$", "id": "54077"}, {"introduction": "要了解一个码的对偶码的性质，我们并非总需要显式地构造出它。MacWilliams恒等式（Pless幂矩是其一个特例）在码及其对偶码的重量分布之间建立了一座深刻的桥梁。最后一个练习 [@problem_id:54042] 演示了如何运用这些强大的关系式，仅利用原始码的重量分布信息，来计算其对偶码的一个关键统计量——平均重量。", "problem": "在经典线性码理论中，Pless 幂矩在长度为 $n$、维度为 $k$ 的二元线性码 $C$ 的重量分布 $\\{A_i\\}_{i=0}^n$ 与其对偶码 $C^\\perp$ 的重量分布 $\\{B_i\\}_{i=0}^n$ 之间建立了基本联系。这些恒等式用 Krawtchouk 多项式 $K_r(x)$ 表示。对于一个码 $C$，这些恒等式由下式给出\n$$ \\sum_{i=0}^n K_r(i) A_i = 2^k B_r \\quad \\text{其中 } r = 0, 1, \\ldots, n. $$\n长度为 $n$ 的码的前三个 Krawtchouk 多项式是：\n$K_0(x) = 1$\n$K_1(x) = n-2x$\n$K_2(x) = \\binom{n}{2} - 2nx + 2x^2$\n\n完美的二元 Golay 码，记作 $G_{23}$，是一个著名的 $[n,k,d] = [23,12,7]$ 线性码。其重量分布 $\\{A_i\\}$ 如下，所有未列出的 $i > 0$ 的 $A_i$ 均为零：\n*   $A_0 = 1$\n*   $A_7 = 253$\n*   $A_8 = 506$\n*   $A_{11} = 1288$\n*   $A_{12} = 1288$\n*   $A_{15} = 506$\n*   $A_{16} = 253$\n*   $A_{23} = 1$\n\n您的任务是计算对偶码 $G_{23}^\\perp$ 中码字的精确平均汉明重量。您应该利用 Pless 幂矩关系。", "solution": "为了求对偶码 $G_{23}^\\perp$ 中码字的平均汉明重量，我们将对偶码的重量分布表示为 $\\{B_i\\}_{i=0}^{23}$。平均重量由下式给出：\n\n$$\n\\text{平均重量} = \\frac{\\sum_{i=0}^{23} i B_i}{\\sum_{i=0}^{23} B_i}.\n$$\n\n对偶码 $G_{23}^\\perp$ 的参数为 $[23, 23-12, d^\\perp] = [23, 11, d^\\perp]$，所以其维度为 $11$。因此，码字总数为：\n\n$$\n\\sum_{i=0}^{23} B_i = 2^{11} = 2048.\n$$\n\n平均重量变为：\n\n$$\n\\text{平均重量} = \\frac{1}{2048} \\sum_{i=0}^{23} i B_i.\n$$\n\nPless 幂矩恒等式建立了 $G_{23}$ 的重量分布 $\\{A_i\\}$ 和其对偶码 $G_{23}^\\perp$ 的重量分布 $\\{B_i\\}$ 之间的关系：\n\n$$\n\\sum_{j=0}^{23} K_r(j) A_j = 2^{\\dim(G_{23})} B_r = 2^{12} B_r,\n$$\n\n为了计算 $\\sum_{j} j B_j$，我们希望找到一个包含 $B_j$ 的线性组合。我们可以使用另一个版本的Pless幂矩，即对 $G_{23}^\\perp$ 应用恒等式，它的对偶是 $G_{23}$：\n\n$$\n\\sum_{j=0}^{23} K_r(j) B_j = 2^{\\dim(G_{23}^\\perp)} A_r = 2^{11} A_r = 2048 A_r,\n$$\n\n为了计算 $\\sum_{j} j B_j$，我们使用 $r=1$ 时的恒等式。当 $r=1$ 时，Krawtchouk 多项式为 $K_1(j) = n - 2j = 23 - 2j$：\n\n$$\n\\sum_{j=0}^{23} (23 - 2j) B_j = 2048 A_1.\n$$\n\n根据 $G_{23}$ 的重量分布，$A_1 = 0$（因为最小距离是 $7$，没有码字的重量为 $1$）。因此：\n\n$$\n\\sum_{j=0}^{23} (23 - 2j) B_j = 2048 \\cdot 0 = 0.\n$$\n\n展开求和式：\n\n$$\n23 \\sum_{j=0}^{23} B_j - 2 \\sum_{j=0}^{23} j B_j = 0.\n$$\n\n代入 $\\sum_{j} B_j = 2048$：\n\n$$\n23 \\cdot 2048 - 2 \\sum_{j} j B_j = 0.\n$$\n\n解出 $\\sum_{j} j B_j$：\n\n$$\n2 \\sum_{j} j B_j = 23 \\cdot 2048,\n$$\n\n\n$$\n\\sum_{j} j B_j = \\frac{23 \\cdot 2048}{2} = 23 \\cdot 1024.\n$$\n\n现在，我们可以计算平均重量：\n\n$$\n\\text{平均重量} = \\frac{\\sum_{j} j B_j}{\\sum_{j} B_j} = \\frac{23 \\cdot 1024}{2048}.\n$$\n\n化简分数：\n\n$$\n\\frac{23 \\cdot 1024}{2048} = 23 \\cdot \\frac{1024}{2048} = 23 \\cdot \\frac{1}{2} = \\frac{23}{2}.\n$$\n\n因此，精确的平均汉明重量是 $\\frac{23}{2}$。", "answer": "$$ \\boxed{\\dfrac{23}{2}} $$", "id": "54042"}]}