{"hands_on_practices": [{"introduction": "Grover 算法的几何诠释将其核心动力学过程描绘为在二维平面内的一次旋转。本练习 [@problem_id:88187] 旨在加深对这一图像的理解，通过计算神谕算符 $U_\\omega$ 在算法演化过程中的期望值，将抽象的几何旋转与一个可观测量直接联系起来，从而清晰地追踪算法的每一步进展。", "problem": "Grover 搜索算法为无结构搜索问题提供了二次加速。该算法的核心是一个迭代过程，它在一个更大的态空间中放大了标记量子态的振幅。\n\n考虑一个具有 $N$ 维希尔伯特空间的量子系统，该空间由一组标准正交计算基 $\\{|x\\rangle\\}_{x=0}^{N-1}$ 张成。任务是从这个基中找到一个单一的标记态，记作 $|\\omega\\rangle$。算法从所有基态的均匀叠加态开始，即 $|s\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{x=0}^{N-1} |x\\rangle$。\n\n算法的每次迭代都包括将 Grover 算子 $G$ 应用于系统的状态。Grover 算子是两个酉算子 $U_s$ 和 $U_\\omega$ 的乘积，即 $G = U_s U_\\omega$，其中：\n1.  神谕算子 $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$，它反转标记态 $|\\omega\\rangle$ 的相位。这里，$I$ 是单位算子。\n2.  扩散算子 $U_s = 2|s\\rangle\\langle s| - I$，它将态关于初始态 $|s\\rangle$ 进行反射。\n\n经过 $k$ 次迭代后，系统处于状态 $|\\psi_k\\rangle = G^k |s\\rangle$。\n\n您的任务是计算神谕算子 $U_\\omega$ 关于状态 $|\\psi_k\\rangle$ 的期望值。这个量，$\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$，揭示了随着算法的进行，状态如何与神谕算子的本征空间对齐。\n\n请用项目数 $N$ 和迭代次数 $k$ 的函数来表示您的答案。", "solution": "为了计算期望值 $\\langle U_\\omega \\rangle_k = \\langle \\psi_k | U_\\omega | \\psi_k \\rangle$，其中 $|\\psi_k\\rangle = G^k |s\\rangle$，我们利用由标记态 $|\\omega\\rangle$ 和未标记态的均匀叠加态所张成的二维子空间。定义 $|\\alpha\\rangle$ 为与 $|\\omega\\rangle$ 正交的归一化态：\n\n\n$$\n|\\alpha\\rangle = \\frac{1}{\\sqrt{N-1}} \\sum_{x \\neq \\omega} |x\\rangle.\n$$\n\n\n初始态 $|s\\rangle$ 是：\n\n\n$$\n|s\\rangle = \\sqrt{\\frac{1}{N}} |\\omega\\rangle + \\sqrt{\\frac{N-1}{N}} |\\alpha\\rangle = \\sin\\theta \\, |\\omega\\rangle + \\cos\\theta \\, |\\alpha\\rangle,\n$$\n\n\n其中 $\\theta = \\arcsin(1/\\sqrt{N})$，所以 $\\sin\\theta = 1/\\sqrt{N}$ 且 $\\cos\\theta = \\sqrt{(N-1)/N}$。\n\nGrover 算子 $G$ 在 $\\{|\\alpha\\rangle, |\\omega\\rangle\\}$ 平面内将状态旋转一个角度 $2\\theta$。经过 $k$ 次迭代后，状态为：\n\n\n$$\n|\\psi_k\\rangle = \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\n神谕算子是 $U_\\omega = I - 2|\\omega\\rangle\\langle\\omega|$。将其应用于 $|\\psi_k\\rangle$：\n\n\n$$\nU_\\omega |\\psi_k\\rangle = (I - 2|\\omega\\rangle\\langle\\omega|) \\left[ \\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right] = -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle.\n$$\n\n\n现在计算期望值：\n\n\n$$\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle = \\left[ \\sin((2k+1)\\theta) \\, \\langle\\omega| + \\cos((2k+1)\\theta) \\, \\langle\\alpha| \\right] \\left[ -\\sin((2k+1)\\theta) \\, |\\omega\\rangle + \\cos((2k+1)\\theta) \\, |\\alpha\\rangle \\right].\n$$\n\n\n展开乘积并利用标准正交性（$\\langle\\omega|\\alpha\\rangle = 0$，$\\langle\\alpha|\\omega\\rangle = 0$，$\\langle\\omega|\\omega\\rangle = 1$，$\\langle\\alpha|\\alpha\\rangle = 1$）：\n\n\n$$\n\\begin{aligned}\n\\langle \\psi_k | U_\\omega | \\psi_k \\rangle = \\sin((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\omega|\\omega\\rangle + \\sin((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\omega|\\alpha\\rangle \\\\\n\\quad + \\cos((2k+1)\\theta) \\cdot (-\\sin((2k+1)\\theta)) \\langle\\alpha|\\omega\\rangle + \\cos((2k+1)\\theta) \\cdot \\cos((2k+1)\\theta) \\langle\\alpha|\\alpha\\rangle \\\\\n= -\\sin^2((2k+1)\\theta) + \\cos^2((2k+1)\\theta) \\\\\n= \\cos(2(2k+1)\\theta),\n\\end{aligned}\n$$\n\n\n使用倍角公式 $\\cos(2\\phi) = \\cos^2\\phi - \\sin^2\\phi$，其中 $\\phi = (2k+1)\\theta$。代入 $\\theta = \\arcsin(1/\\sqrt{N})$：\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left(2(2k+1) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$\n\n\n简化参数：\n\n\n$$\n2(2k+1) = 4k+2,\n$$\n\n\n因此表达式为：\n\n\n$$\n\\langle U_\\omega \\rangle_k = \\cos\\left((4k+2) \\arcsin\\left(\\frac{1}{\\sqrt{N}}\\right)\\right).\n$$", "answer": "$$\n\\boxed{ \\cos\\left( (4k+2) \\arcsin\\left( \\frac{1}{\\sqrt{N}} \\right) \\right) }\n$$", "id": "88187"}, {"introduction": "在实际的量子计算中，完美的初态制备几乎是不可能的。本练习 [@problem_id:88215] 探讨了当初始量子态的一部分“泄漏”到标准 Grover 二维子空间之外时，算法性能会受到何种影响。通过分析这种常见的态制备错误，我们可以洞察 Grover 算法对特定类型噪声的内在稳健性，这对于评估其在真实硬件上的可行性至关重要。", "problem": "考虑在包含 $N$ 个项目的数据库中搜索单个标记项 $|w\\rangle$ 的Grover搜索算法。该算法在一个 $N$ 维希尔伯特空间 $\\mathcal{H}$ 中运行。标准算法在由目标态 $|w\\rangle$ 和均匀叠加态 $|\\psi_{\\text{unif}}\\rangle = \\frac{1}{\\sqrt{N}}\\sum_{i=0}^{N-1}|i\\rangle$ 所张成的二维子空间 $\\mathcal{H}_G$ 内演化状态。\n\n假设由于状态制备的不完美，初始状态 $|\\psi_0\\rangle$ 不是完美的均匀叠加态。相反，它是一个纯态，相对于 $|\\psi_{\\text{unif}}\\rangle$ 的保真度为 $F=|\\langle \\psi_{\\text{unif}} | \\psi_0 \\rangle|^2 = 1-\\epsilon^2$，其中 $0  < \\epsilon  < 1$ 是一个小参数。这种不完美被建模为振幅泄漏到一个状态 $|\\psi_{\\text{leak}}\\rangle$ 中，该状态是归一化的，并且位于 $\\mathcal{H}_G$ 的正交补空间 $\\mathcal{H}_G^\\perp$ 中。具体来说，初始状态由下式给出：\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\n其中我们假设 $\\epsilon$ 是实数且为正。\n\n搜索是通过应用标准Grover算子 $G = U_{\\psi_{\\text{unif}}} U_w$ 来执行的，其中 $U_w = I-2|w\\rangle\\langle w|$ 是神谕算子（oracle），而 $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$ 是扩散算子。\n\n假设数据库的大小 $N$ 使得对于一个理想的搜索（从 $|\\psi_{\\text{unif}}\\rangle$ 开始），存在一个最优的整数迭代次数，记为 $k_{\\text{opt}}$，它能以概率1找到被标记的状态 $|w\\rangle$。\n\n如果我们对不完美的初始状态 $|\\psi_0\\rangle$ 运行该算法，并采用相同的最优迭代次数 $k_{\\text{opt}}$，计算找到状态 $|w\\rangle$ 的成功概率。", "solution": "初始状态由下式给出：\n\n$$\n|\\psi_0\\rangle = \\sqrt{1-\\epsilon^2} |\\psi_{\\text{unif}}\\rangle + \\epsilon |\\psi_{\\text{leak}}\\rangle\n$$\n\n其中 $|\\psi_{\\text{leak}}\\rangle$ 是归一化的，并且位于由 $|w\\rangle$ 和 $|\\psi_{\\text{unif}}\\rangle$ 张成的二维子空间 $\\mathcal{H}_G$ 的正交补空间 $\\mathcal{H}_G^\\perp$ 中。因此，$\\langle w | \\psi_{\\text{leak}} \\rangle = 0$ 且 $\\langle \\psi_{\\text{unif}} | \\psi_{\\text{leak}} \\rangle = 0$。\n\nGrover算子为 $G = U_{\\psi_{\\text{unif}}} U_w$，其中 $U_w = I - 2|w\\rangle\\langle w|$ 且 $U_{\\psi_{\\text{unif}}} = 2|\\psi_{\\text{unif}}\\rangle\\langle \\psi_{\\text{unif}}| - I$。对于任何状态 $|v\\rangle \\in \\mathcal{H}_G^\\perp$，$G$ 的作用如下：\n\n$$\nG |v\\rangle = U_{\\psi_{\\text{unif}}}} U_w |v\\rangle = U_{\\psi_{\\text{unif}}}} |v\\rangle = -|v\\rangle\n$$\n\n因为 $U_w |v\\rangle = |v\\rangle$（由于 $\\langle w | v \\rangle = 0$）且 $U_{\\psi_{\\text{unif}}}} |v\\rangle = -|v\\rangle$（由于 $\\langle \\psi_{\\text{unif}} | v \\rangle = 0$）。因此，经过 $k$ 次迭代后：\n\n$$\nG^k |v\\rangle = (-1)^k |v\\rangle.\n$$\n\n\n经过 $k_{\\text{opt}}$ 次迭代后，状态演化为：\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = G^{k_{\\text{opt}}} |\\psi_0\\rangle = \\sqrt{1-\\epsilon^2}  G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle + \\epsilon  G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\n根据假设，对于理想的初始状态 $|\\psi_{\\text{unif}}\\rangle$，$G^{k_{\\text{opt}}} |\\psi_{\\text{unif}}\\rangle = |w\\rangle$。同时，$G^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle = (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle$。代入这些结果：\n\n$$\n|\\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle.\n$$\n\n\n成功概率为 $|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2$。计算内积：\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\langle w | \\left( \\sqrt{1-\\epsilon^2} |w\\rangle + \\epsilon (-1)^{k_{\\text{opt}}} |\\psi_{\\text{leak}}\\rangle \\right) = \\sqrt{1-\\epsilon^2} \\langle w | w \\rangle + \\epsilon (-1)^{k_{\\text{opt}}} \\langle w | \\psi_{\\text{leak}} \\rangle.\n$$\n\n由于 $|\\psi_{\\text{leak}}\\rangle \\in \\mathcal{H}_G^\\perp$ 且 $|w\\rangle \\in \\mathcal{H}_G$，所以 $\\langle w | \\psi_{\\text{leak}} \\rangle = 0$。因此：\n\n$$\n\\langle w | \\psi_{k_{\\text{opt}}}\\rangle = \\sqrt{1-\\epsilon^2}.\n$$\n\n\n成功概率为：\n\n$$\n|\\langle w | \\psi_{k_{\\text{opt}}}\\rangle|^2 = \\left( \\sqrt{1-\\epsilon^2} \\right)^2 = 1 - \\epsilon^2.\n$$", "answer": "$$ \\boxed{1 - \\epsilon^2} $$", "id": "88215"}, {"introduction": "在静态制备错误的基础上，我们进一步考虑更复杂的动态误差，即构成算法的量子门操作本身存在系统性偏差。本练习 [@problem_id:88163] 模拟了一种相干控制错误，其中扩散算符的反射轴在每次迭代中都会发生微小的角度漂移。通过分析这种累积效应，本练习挑战我们理解微小迭代误差如何传播并最终影响算法的成功概率，从而深化对量子算法错误分析的认识。", "problem": "在大小为$N$的数据库中搜索单个标记项$|w\\rangle$的标准Grover搜索算法中，状态向量在由初始均匀叠加态$|s\\rangle$和标记态$|w\\rangle$张成的二维平面上演化。为该平面使用一个由$|w\\rangle$和一个与$|w\\rangle$正交且位于该平面内的态$|s'\\rangle$构成的标准正交基是方便的。初始状态可以写为 $|\\psi_0\\rangle = |s\\rangle = \\cos\\theta |s'\\rangle + \\sin\\theta |w\\rangle$，其中 $\\theta = \\arcsin(1/\\sqrt{N})$。\n\n一次标准的Grover迭代包括两个反射：一个神谕查询 $U_w = I - 2|w\\rangle\\langle w|$（关于$|s'\\rangle$轴的反射）和一个扩散算子 $U_s = 2|s\\rangle\\langle s| - I$（关于$|s\\rangle$轴的反射）。这两个反射的复合操作使状态向量朝向目标态$|w\\rangle$旋转一个角度$2\\theta$。\n\n考虑Grover算法的一个修改版本，其中扩散算子不是恒定的，而是随每次迭代而改变。具体来说，第$j$步的扩散算子由 $U_{s_j} = 2|s_j\\rangle\\langle s_j| - I$ 给出。反射轴$|s_j\\rangle$是同一搜索平面内的一个状态，但它相对于$|s'\\rangle$轴的角度（我们称之为$\\phi_j$）会系统性地进动。对于第一次迭代（$j=1$），反射轴是标准的，即$|s_1\\rangle = |s\\rangle$，因此其角度为 $\\phi_1 = \\theta$。对于之后的每一次迭代 $j > 1$，轴的角度都会增加一个恒定的小角度 $\\delta$，使得 $\\phi_j = \\phi_{j-1} + \\delta$。\n\n假设对于给定的数据库大小$N$，*标准*、未经修改的Grover算法的最优迭代次数是一个精确的整数，我们将其记为$k_0$。这意味着经过$k_0$次标准的Grover迭代后，初始状态$|s\\rangle$会以单位概率演化到标记态$|w\\rangle$。\n\n如果这个*修改后*的Grover算法运行相同的迭代次数$k_0$，测量到状态$|w\\rangle$的最终成功概率$P_{\\text{succ}}$是多少？请用$k_0$和$\\delta$将你的答案表示为一个闭式表达式。", "solution": "我们在由$|s'\\rangle$和$|w\\rangle$张成的二维平面上进行计算。将$j-1$次迭代后的状态写为\n\n$$\n|\\psi_{j-1}\\rangle = \\cos\\alpha_{j-1}\\,|s'\\rangle + \\sin\\alpha_{j-1}\\,|w\\rangle.\n$$\n\n每次迭代应用$U_w$（关于$|s'\\rangle$的反射），接着应用$U_{s_j}$（关于与$|s'\\rangle$成$\\phi_j$角的轴的反射），它们共同将状态旋转，使得新角度为\n\n$$\n\\alpha_j = \\alpha_{j-1} + 2\\phi_j.\n$$\n\n初始角度为$\\alpha_0=\\theta$，且根据假设\n\n$$\n\\phi_j = \\theta + (j-1)\\,\\delta.\n$$\n\n因此，经过$k_0$次迭代后\n\n$$\n\\alpha_{k_0}\n= \\theta \\;+\\; 2\\sum_{j=1}^{k_0}\\bigl[\\theta+(j-1)\\delta\\bigr]\n= \\theta + 2k_0\\theta + 2\\delta\\frac{k_0(k_0-1)}{2}\n= (2k_0+1)\\theta + \\delta\\,k_0(k_0-1).\n$$\n\n对于*标准*Grover算法，选择$k_0$使得$(2k_0+1)\\theta=\\pi/2$，因此\n\n$$\n\\alpha_{k_0} = \\frac\\pi2 + \\delta\\,k_0(k_0-1).\n$$\n\n测量到$|w\\rangle$的概率为\n\n$$\nP_{\\rm succ}\n=\\sin^2\\!\\bigl(\\alpha_{k_0}\\bigr)\n=\\sin^2\\!\\Bigl(\\frac\\pi2 + \\delta\\,k_0(k_0-1)\\Bigr)\n=\\cos^2\\!\\bigl(\\delta\\,k_0(k_0-1)\\bigr).\n$$", "answer": "$$\\boxed{\\cos^2\\bigl(\\delta\\,k_0(k_0-1)\\bigr)}$$", "id": "88163"}]}