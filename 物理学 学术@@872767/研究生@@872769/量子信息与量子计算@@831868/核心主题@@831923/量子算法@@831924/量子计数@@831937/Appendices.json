{"hands_on_practices": [{"introduction": "量子计数算法的标准形式假设我们对整个计算基上的状态进行搜索。然而，在许多实际应用中，我们可能预先知道所有感兴趣的目标项都局限于某个已知的子空间内。这个练习将挑战您调整量子计数的核心原理，以适应这种更受约束的搜索场景，它揭示了搜索的有效“宇宙”维度如何决定最终测量的相位，从而加深您对算法几何本质的理解 [@problem_id:115905]。", "problem": "量子计数算法（QCA）旨在确定一个大小为 $N$ 的搜索空间中标记项的数量 $M$。它通过对 Grover 搜索算子 $G$ 执行量子相位估计算法（QPE）来实现这一目标。标准的 QCA 假设搜索是在一个维度为 $N$ 的希尔伯特空间 $\\mathcal{H}$ 的整个计算基上进行的，并从所有基态的均匀叠加态开始。\n\n考虑一个修改后的场景。给定一个总维度为 $N$ 的希尔伯特空间 $\\mathcal{H}$。在此空间内，存在一个维度为 $D$ 的特定子空间 $\\mathcal{S} \\subset \\mathcal{H}$，它由一个已知的标准正交基 $\\{|s_j\\rangle\\}_{j=1}^D$ 张成。我们已知所有 $M$ 个标记态（我们用集合 $W$ 表示）完全包含在该子空间内，即 $W \\subset \\{|s_j\\rangle\\}_{j=1}^D$。\n\n为此场景调整了量子搜索算法。初始态被制备为已知子空间 $\\mathcal{S}$ 的基态的均匀叠加态：\n$$\n|\\psi_{\\mathcal{S}}\\rangle = \\frac{1}{\\sqrt{D}} \\sum_{j=1}^{D} |s_j\\rangle\n$$\nGrover 算子 $G$ 是使用这个特定的初始态构建的。神谕算子 $U_w$ 的作用与通常一样，它会翻转任何标记态的符号：如果 $|x\\rangle \\in W$，则 $U_w|x\\rangle = -|x\\rangle$，否则 $U_w|x\\rangle = |x\\rangle$。扩散算子 $U_{\\psi_{\\mathcal{S}}}$ 将量子态关于初始态 $|\\psi_{\\mathcal{S}}\\rangle$ 作反射：$U_{\\psi_{\\mathcal{S}}} = 2|\\psi_{\\mathcal{S}}\\rangle\\langle\\psi_{\\mathcal{S}}| - I$。完整的 Grover 算子则是 $G = U_{\\psi_{\\mathcal{S}}} U_w$。\n\nQCA 使用 $|\\psi_{\\mathcal{S}}\\rangle$ 作为输入态，对酉算子 $G$ 应用 QPE。该算法为 $G$ 的一个本征相位提供估计值。$G$ 的作用局限于由 $\\mathcal{S}$ 内的标记态和未标记态决定的二维子空间中。找出该算法试图估计的 Grover 算子 $G$ 的正本征相位 $\\phi$ 的精确值。请用子空间维度 $D$ 和标记态数量 $M$ 的闭式表达式来表示你的答案。", "solution": "1. 定义 $\\mathcal{S}$ 内标记态和未标记态的叠加态：\n$$\n|\\omega\\rangle = \\frac{1}{\\sqrt{M}}\\sum_{|s_j\\rangle\\in W}|s_j\\rangle,\n\\qquad\n|s'\\rangle = \\frac{1}{\\sqrt{D-M}}\\sum_{|s_j\\rangle\\notin W}|s_j\\rangle.\n$$\n2. 重写初始态：\n$$\n|\\psi_{\\mathcal{S}}\\rangle\n=\\frac{1}{\\sqrt{D}}\\sum_{j=1}^D|s_j\\rangle\n=\\sqrt{\\frac{D-M}{D}}\\,|s'\\rangle+\\sqrt{\\frac{M}{D}}\\,|\\omega\\rangle.\n$$\n设\n$$\n\\cos\\theta=\\sqrt{\\frac{D-M}{D}}, \n\\quad\n\\sin\\theta=\\sqrt{\\frac{M}{D}}, \n\\quad\n\\theta=\\arcsin\\!\\left(\\sqrt{\\frac{M}{D}}\\right).\n$$\n3. 神谕反射算子和扩散算子在 $\\{|s'\\rangle,|\\omega\\rangle\\}$ 子空间中作为反射算子作用：\n$$\nU_w:\\;|\\omega\\rangle\\to-|\\omega\\rangle,\\;|s'\\rangle\\to|s'\\rangle,\n\\quad\nU_{\\psi_{\\mathcal{S}}}:\\;|\\psi_{\\mathcal{S}}\\rangle\\to-|\\psi_{\\mathcal{S}}\\rangle.\n$$\n4. Grover 迭代算子\n$$\nG=U_{\\psi_{\\mathcal{S}}}U_w\n$$\n在 $\\{|s'\\rangle,|\\omega\\rangle\\}$ 平面内被限制为一个角度为 $2\\theta$ 的旋转。其本征值为 $e^{\\pm i2\\theta}$，因此正本征相位为\n$$\n\\phi=2\\theta=2\\arcsin\\!\\left(\\sqrt{\\frac{M}{D}}\\right).\n$$", "answer": "$$\\boxed{2\\arcsin\\!\\left(\\sqrt{\\frac{M}{D}}\\right)}$$", "id": "115905"}, {"introduction": "量子计数算法不仅仅是为了“计数”，它的一项关键应用是为Grover搜索算法校准其最佳迭代次数。要高效地找到一个标记项，Grover算法需要运行精确的步数，而这依赖于标记项总数 $M$ 的大小。本练习将理论与实践相结合，让您亲身体验如何利用量子计数得到的估计相位来确定Grover算法的迭代次数，并计算最终搜索的成功率 [@problem_id:116019]。", "problem": "在量子搜索问题中，我们有一个大小为 $N$ 的搜索空间，其中包含 $M$ 个标记项。Grover 算法能够以高概率找到一个标记项。该算法基于对一个量子算符 $G$ 的迭代。$G$ 的作用等效于在一个特定的二维希尔伯特子空间中的旋转。\n\n设 Grover 旋转角为 $\\theta = \\arcsin(\\sqrt{M/N})$。搜索的初始状态是 $|\\psi_0\\rangle$。在应用 Grover 算符 $k$ 次之后，状态变为 $|\\psi_k\\rangle = G^k |\\psi_0\\rangle$。测量状态 $|\\psi_k\\rangle$ 时找到一个标记项的概率由下式给出：\n$$ P_{succ}(k, \\theta) = \\sin^2((2k+1)\\theta) $$\n最优迭代次数 $k_{opt}$ 取决于真实角度 $\\theta$，而该角度通常是未知的。\n\n为了解决这个问题，可以先使用量子计数算法来获得真实角度 $\\theta$ 的一个估计值 $\\tilde{\\theta}$。基于这个估计值，可以计算出运行 Grover 算法的估计迭代次数。一个常用的估计迭代次数的公式是 $k_{est} = \\lfloor \\frac{\\pi}{4\\tilde{\\theta}} \\rfloor$，该公式在 $\\tilde{\\theta} \\in (0, \\pi/2]$ 时有效。\n\n假设对于一个给定的搜索问题，真实角度是 $\\theta_{true} = \\frac{\\pi}{20}$。在一台小型量子计算机上运行量子计数算法，得到一个估计角度 $\\tilde{\\theta} = \\frac{\\pi}{32}$。\n\n然后，使用由估计值 $\\tilde{\\theta}$ 决定的迭代次数 $k$ (即 $k = \\lfloor \\frac{\\pi}{4\\tilde{\\theta}} \\rfloor$) 来执行 Grover 搜索。计算这次 Grover 搜索的成功概率。", "solution": "真实角度是 $\\theta_{true} = \\frac{\\pi}{20}$，估计角度是 $\\tilde{\\theta} = \\frac{\\pi}{32}$。Grover 迭代的次数 $k$ 由以下公式确定：\n\n$$\nk = \\left\\lfloor \\frac{\\pi}{4\\tilde{\\theta}} \\right\\rfloor\n$$\n\n代入 $\\tilde{\\theta} = \\frac{\\pi}{32}$：\n\n$$\nk = \\left\\lfloor \\frac{\\pi}{4 \\cdot \\frac{\\pi}{32}} \\right\\rfloor = \\left\\lfloor \\frac{\\pi}{\\frac{\\pi}{8}} \\right\\rfloor = \\lfloor 8 \\rfloor = 8\n$$\n\n经过 $k$ 次迭代后的成功概率由下式给出：\n\n$$\nP_{succ}(k, \\theta_{true}) = \\sin^2\\left((2k + 1) \\theta_{true}\\right)\n$$\n\n代入 $k = 8$ 和 $\\theta_{true} = \\frac{\\pi}{20}$：\n\n$$\nP_{succ} = \\sin^2\\left( (2 \\cdot 8 + 1) \\cdot \\frac{\\pi}{20} \\right) = \\sin^2\\left( 17 \\cdot \\frac{\\pi}{20} \\right) = \\sin^2\\left( \\frac{17\\pi}{20} \\right)\n$$\n\n使用恒等式 $\\sin(\\theta) = \\sin(\\pi - \\theta)$：\n\n$$\n\\sin\\left( \\frac{17\\pi}{20} \\right) = \\sin\\left( \\pi - \\frac{3\\pi}{20} \\right) = \\sin\\left( \\frac{3\\pi}{20} \\right)\n$$\n\n因此：\n\n$$\nP_{succ} = \\sin^2\\left( \\frac{3\\pi}{20} \\right)\n$$\n\n使用半角公式 $\\sin^2(x) = \\frac{1 - \\cos(2x)}{2}$：\n\n$$\n\\sin^2\\left( \\frac{3\\pi}{20} \\right) = \\frac{1 - \\cos\\left( \\frac{3\\pi}{10} \\right)}{2}\n$$\n\n$\\cos\\left( \\frac{3\\pi}{10} \\right) = \\cos(54^\\circ) = \\sin(36^\\circ) = \\sqrt{\\frac{10 - 2\\sqrt{5}}{16}} = \\frac{\\sqrt{10 - 2\\sqrt{5}}}{4}$ 是一个标准值。代入：\n\n$$\nP_{succ} = \\frac{1 - \\frac{\\sqrt{10 - 2\\sqrt{5}}}{4}}{2} = \\frac{4 - \\sqrt{10 - 2\\sqrt{5}}}{8}\n$$\n\n因此，成功概率为 $\\frac{4 - \\sqrt{10 - 2\\sqrt{5}}}{8}$。", "answer": "$$ \\boxed{\\frac{4 - \\sqrt{10 - 2\\sqrt{5}}}{8}} $$", "id": "116019"}, {"introduction": "理想的算法在现实的量子硬件上运行时，必须考虑噪声的影响。提高量子计数精度的直接方法是增加计数比特的数量 $t$，但这也会显著增加电路的深度，使其更容易受到退相干效应的影响。本练习模拟了这种权衡关系，它提出了一个由离散化误差和退相干误差组成的综合误差模型。您的任务是找到一个最佳的计数比特数 $t$，以最小化总的估计误差，这反映了在设计实用量子算法时必须面对的真实挑战 [@problem_id:115894]。", "problem": "量子计数算法是量子计算的基石之一，旨在估算一个大小为 $N=2^n$ 的搜索空间中解的数量 $M$。该算法通过将量子相位估计算法（QPE）应用于 Grover 算符 $G$ 来实现这一目标。$G$ 的相关本征值为 $e^{\\pm i 2\\theta}$，其中相位角 $\\theta$ 与解的数量之间的关系为 $M/N = \\sin^2(\\theta)$。QPE 使用 $t$ 个辅助“计数”量子比特来产生 $2\\theta$ 的一个估计值。\n\n在任何现实的实现中，估计相位 $\\widehat{2\\theta}$ 的准确性受到两种相互竞争的误差来源的限制，这两种误差都取决于 $t$ 的选择：\n\n1.  **离散化误差：** QPE 算法从根本上将连续的相位谱离散化。这种离散化的精度由最大有效演化时间决定，由于使用了高达 $G^{2^{t-1}}$ 的受控算符，该时间与 $2^t$ 成正比。根据量子度量学的原理，这种“海森堡极限”离散化导致的相位估计量的方差与演化时间的平方成反比。这部分方差由下式给出：\n    $$ \\text{Var}_{\\text{disc}}(\\widehat{2\\theta}) = \\frac{\\alpha}{4^t} $$\n    其中 $\\alpha$ 是一个由 QPE 线路的具体细节和真实相位 $\\theta$ 决定的正常数。\n\n2.  **退相干误差：** 用于计数的量子线路会受到噪声的影响。我们用一个每门振幅阻尼通道来对此进行建模。线路的总深度主要由最高次幂的 Grover 算符决定，因此与 $2^t$ 成正比。在整个计算过程中，阻尼通道的累积效应是相位信息的扩散，这引入了一个额外的、独立的方差来源。一个合理的关于这种退相干引起的方差的模型是，它随线路深度线性增长。这部分贡献由下式给出：\n    $$ \\text{Var}_{\\text{deco}}(\\widehat{2\\theta}) = \\beta \\cdot 2^t $$\n    其中 $\\beta$ 是一个代表退相干过程强度的正常数。\n\n假设在一个贝叶斯估计框架中，相位 $2\\theta$ 的先验为无信息先验，那么 $2\\theta$ 的后验分布可以很好地用高斯分布来近似。其方差是这两个独立误差来源的方差之和，即 $\\text{Var}_{\\text{total}} = \\text{Var}_{\\text{disc}} + \\text{Var}_{\\text{deco}}$。\n\n你的任务是找到最优的计数量子比特数 $t_{\\text{opt}}$，以最小化这个总后验方差。为了优化的目的，将 $t$ 视为一个连续的正实数变量。请用常数 $\\alpha$ 和 $\\beta$ 推导出 $t_{\\text{opt}}$ 的表达式。", "solution": "我们希望最小化关于连续变量 $t>0$ 的\n$$\n\\mathrm{Var}_{\\rm total}(t)=\\alpha\\,4^{-t}+\\beta\\,2^{t}\n$$\n\n1. 计算导数：\n$$\n\\frac{d}{dt}\\mathrm{Var}_{\\rm total}\n=\\alpha\\frac{d}{dt}2^{-2t}+\\beta\\frac{d}{dt}2^{t}\n=\\alpha(-2\\ln2)\\,2^{-2t}+\\beta(\\ln2)\\,2^{t}\\,.\n$$\n\n2. 为求极值，将导数设为零：\n$$\n-2\\alpha\\ln2\\,2^{-2t}+\\beta\\ln2\\,2^{t}=0\n\\quad\\Longrightarrow\\quad\n\\beta\\,2^{t}=2\\alpha\\,2^{-2t}\\,.\n$$\n\n3. 解出 $t$：\n$$\n\\beta\\,2^{3t}=2\\alpha\n\\quad\\Longrightarrow\\quad\n2^{3t}=\\frac{2\\alpha}{\\beta}\n\\quad\\Longrightarrow\\quad\n3t\\ln2=\\ln\\!\\left(\\frac{2\\alpha}{\\beta}\\right)\n\\quad\\Longrightarrow\\quad\nt=\\frac{1}{3}\\,\\frac{\\ln\\!\\left(2\\alpha/\\beta\\right)}{\\ln2}\n=\\frac{1}{3}\\log_{2}\\!\\left(\\frac{2\\alpha}{\\beta}\\right)\\,.\n$$\n\n检验可知，二阶导数在此点为正，确认了这是一个最小值点。", "answer": "$$\\boxed{\\frac{1}{3}\\log_{2}\\!\\left(\\frac{2\\alpha}{\\beta}\\right)}$$", "id": "115894"}]}