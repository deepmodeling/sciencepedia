{"hands_on_practices": [{"introduction": "阶查找算法的核心是模幂运算算符 $U_{\\text{exp}}$，它构成了算法的量子部分的主体。这个练习将这个复杂的算符分解为一系列更简单的基本门，这有助于我们理解算法的线路复杂度和资源需求 [@problem_id:160662]。通过这种方式，我们可以具体地看到如何从基本构建块逐步构造出功能强大的量子操作。", "problem": "在Shor的求阶算法中，一个关键组成部分是模幂运算阶段。该阶段由一个幺正算符$U_{\\text{exp}}$实现，它作用于一个$n$量子比特的控制寄存器和一个目标寄存器。该运算定义如下：\n$$ U_{\\text{exp}} = \\sum_{j=0}^{2^n-1} |j\\rangle\\langle j| \\otimes U_x^j $$\n其中，$|j\\rangle$是控制寄存器的计算基态，$U_x$是作用于目标寄存器的幺正算符，使得对于某些整数$x$和$N$，有$U_x|y\\rangle = |xy \\pmod N\\rangle$。\n\n$U_{\\text{exp}}$的标准实现是基于$j$的二进制表示$j = \\sum_{k=0}^{n-1} j_k 2^k$来分解该算符。这会得到一个应用一系列受控幺正运算的量子线路。具体来说，对于每个控制量子比特$k$（从$0$到$n-1$），一个受控-$(U_x^{2^k})$门会作用于目标寄存器，其条件是第$k$个控制量子比特的状态为$|1\\rangle$。\n\n假设您的任务是为一个包含$n=5$个量子比特的控制寄存器构建这个线路。您可用的“基本”受控门集仅限于两种类型：\n1.  一个受控-$U_x$门。\n2.  一个受控-$(U_x^2)$门。\n\n任何其他所需的受控运算，例如受控-$(U_x^4)$，都必须由这个基本门集构建。构建规则是，一个受控-$(V^2)$门可以通过连续两次应用一个受控-$V$门来实现。例如，受控-$(U_x^4)$门是通过应用两次受控-$(U_x^2)$门来构建的。\n\n确定为$n=5$个量子比特实现完整的模幂运算阶段所需的总基本门数。", "solution": "对于一个$n$量子比特的控制寄存器，模幂运算阶段需要对从$0$到$n-1$范围内的每个量子比特$k$进行一次受控-$U_x^{2^k}$运算。可用的基本门是受控-$U_x$和受控-$U_x^2$。构建规则指出，一个受控-$(V^2)$门是通过连续两次应用一个受控-$V$门来实现的。\n\n设$A_k$表示实现受控-$U_x^{2^k}$所需的基本门数量。\n\n- 对于$k=0$：$2^0 = 1$。受控-$U_x^1$就是基本门受控-$U_x$，所以$A_0 = 1$。\n- 对于$k=1$：$2^1 = 2$。受控-$U_x^2$是一个基本门，所以$A_1 = 1$。\n- 对于$k \\geq 2$：$2^k = (2^{k-1})^2$。根据构建规则，受控-$U_x^{2^k} = \\text{controlled-}((U_x^{2^{k-1}})^2)$需要两次应用受控-$U_x^{2^{k-1}}$。因此，$A_k = 2 \\cdot A_{k-1}$。\n\n给定$n=5$，计算$k=0$到$4$的$A_k$值：\n- $A_0 = 1$\n- $A_1 = 1$\n- $A_2 = 2 \\cdot A_1 = 2 \\cdot 1 = 2$\n- $A_3 = 2 \\cdot A_2 = 2 \\cdot 2 = 4$\n- $A_4 = 2 \\cdot A_3 = 2 \\cdot 4 = 8$\n\n基本门的总数是所有$k$值的总和：\n\n$$\n\\sum_{k=0}^{4} A_k = A_0 + A_1 + A_2 + A_3 + A_4 = 1 + 1 + 2 + 4 + 8 = 16\n$$\n\n\n这包括了为$n=5$个量子比特的模幂运算阶段所需的所有受控运算。", "answer": "$$ \\boxed{16} $$", "id": "160662"}, {"introduction": "在理想情况下，单次运行阶查找算法就能成功。然而在实践中，算法的单次运行并不总能得到真实的阶 $r$，有时它只会给出一个 $r$ 的因子。这个练习模拟了这种情况，并演示了一种关键的经典后处理技术：如何结合多次运行的结果来重构真实的阶 [@problem_id:160640]。这突显了量子计算与经典推理之间的协同作用，对于实际应用至关重要。", "problem": "量子求阶算法是 Shor 整数分解算法的一个关键组成部分。其目标是找到一个整数 $a$ 模 $M$ 的阶 $r$，这个阶是满足 $a^r \\equiv 1 \\pmod{M}$ 的最小正整数。\n\n该算法利用量子计算机来制备一个特定的状态，对控制寄存器进行测量会得到一个整数结果 $k$。这个结果被用于一个经典的后处理步骤。在很高的概率下，比值 $k/N$（其中 $N$ 是控制寄存器希尔伯特空间的大小）是某个有理数 $j/r$ 的一个良好近似，其中 $j$ 是 0 到 $r-1$ 之间的一个整数。然后使用连分数算法从估计值 $k/N$ 中高效地提取出分数 $j/s$。\n\n如果整数 $j$（由量子态随机决定）与真实的阶 $r$ 互质（即 $\\gcd(j, r) = 1$），那么连分数算法找到的分母 $s$ 将是真实的阶 $r$。然而，如果 $\\gcd(j, r) = d  1$，则分数 $j/r$ 不是最简分数。连分数算法将会找到约简后的分数 $j'/s'$，其中 $j/r = j'/s'$。得到的分母 $s'$ 将是真实阶的一个因子，具体为 $s' = r/d$。\n\n一位实验者正试图找到一个元素 $a$ 模 $M$ 的阶 $r$。他们进行了两次独立的量子求阶算法运行。\n1. 第一次运行产生了一个候选阶 $s_1$。通过经典计算检验，他们发现 $a^{s_1} \\not\\equiv 1 \\pmod{M}$。\n2. 第二次运行产生了另一个不同的候选阶 $s_2$。他们同样发现 $a^{s_2} \\not\\equiv 1 \\pmod{M}$。\n\n实验者得出结论，两次运行都对应于上述的失败模式，这意味着 $s_1$ 和 $s_2$ 都是真实阶 $r$ 的真因子。给定观测到的两个子阶 $s_1 = 90$ 和 $s_2 = 105$，请确定真实阶 $r$ 的最可能值。假设 $r$ 是与两次测量结果都一致的最小整数。", "solution": "我们已知两个观测到的子阶 $s_1=90$ 和 $s_2=105$，它们都是真实阶 $r$ 的真因子。与这些观测结果一致的最小的 $r$ 必须满足\n\n$$\ns_1\\mid r,\\quad s_2\\mid r,\n$$\n\n并且是最小的。因此\n\n$$\nr=\\mathrm{lcm}(s_1,s_2).\n$$\n\n计算其质因数分解：\n\n$$\n90 = 2\\cdot 3^2\\cdot 5,\\qquad\n105 = 3\\cdot 5\\cdot 7.\n$$\n\n最小公倍数取每个质因数的最高次幂：\n\n$$\n\\mathrm{lcm}(90,105)\n=2^1\\cdot3^2\\cdot5^1\\cdot7^1\n=2\\cdot9\\cdot5\\cdot7\n=630.\n$$\n\n因此，最小的可能的真实阶是 $r=630$。", "answer": "$$\\boxed{630}$$", "id": "160640"}, {"introduction": "理想的量子门是理论上的构想，而真实的硬件不可避免地存在系统误差。这个问题模拟了一种常见的误差类型——一个微小且不希望有的系统性相位旋转——并要求计算其对最终测量结果的影响 [@problem_id:160728]。这个练习让我们深入了解算法对物理噪声的敏感性，并为理解更复杂的量子纠错码和容错计算提供了基础。", "problem": "量子求阶算法是Shor因数分解算法的一个关键组成部分，它可以被理解为量子相位估计（QPE）算法的一个应用。为了找到整数 $x$ 模 $N$ 的阶 $r$，我们使用QPE来估计与酉算符 $U_x$ 的一个特征值相关联的相位 $\\phi$，该算符定义为 $U_x|y\\rangle = |xy \\pmod{N}\\rangle$。$U_x$ 的特征值形式为 $e^{2\\pi i s/r}$，其中 $s \\in \\{0, 1, \\dots, r-1\\}$。QPE算法估计其中一个相位 $\\phi_s = s/r$。\n\n标准的QPE电路使用一个包含 $n$ 个量子比特的第一个寄存器（设 $Q=2^n$）和一个用于存储 $U_x$ 的一个特征向量的第二个寄存器。在应用一系列受控-$U_x^{2^j}$ 门（其中 $j=0, \\dots, n-1$）和一个逆量子傅里叶变换后，对第一个寄存器进行测量会得到一个整数 $k$。在理想情况下，$k$ 的概率分布在最接近 $Q\\phi_s$ 的整数值处出现尖峰。\n\n考虑一个场景，其中受控酉门的实现是不完美的。具体来说，假设发生了一个系统性旋转误差，该误差可以通过将理想的酉算符 $U_x$ 替换为一个有缺陷的算符 $U'_x = e^{i\\delta} U_x$ 来建模，其中 $\\delta$ 是一个小的恒定相位。\n\n给定以下参数：\n- 该算法正在分析与标签 $s=1$ 对应的相位。\n- 元素 $x$ 的阶为 $r=32$。\n- 第一个量子寄存器（“计数”寄存器）使用的量子比特数使其总状态数为 $Q=1024$。\n- 系统性相位误差由 $\\delta = \\pi/256$ 给出。\n\n确定由该系统性误差引起的主傅里叶峰的整数偏移量 $\\Delta k = k_{err} - k_{ideal}$。此处，$k_{ideal}$ 是理想（无误差）情况下概率最高的测量结果，而 $k_{err}$ 是存在误差时对应的峰值位置。", "solution": "待估计的理想相位为 $\\phi_s = s/r = 1/32$。\n系统性误差将酉算符修改为 $U'_x = e^{i\\delta} U_x$，其中 $\\delta = \\pi/256$。\n对于相同的特征向量，$U'_x$ 的特征值变为 $e^{i\\delta} e^{2\\pi i s/r} = e^{i(2\\pi s/r + \\delta)}$。\n因此，错误的相角为 $\\theta_{\\text{err}} = 2\\pi s/r + \\delta$。\n相位 $\\phi_{\\text{err}}$ 由 $\\phi_{\\text{err}} = \\theta_{\\text{err}} / (2\\pi) = (2\\pi s/r + \\delta) / (2\\pi) = s/r + \\delta/(2\\pi)$ 给出。\n\n代入 $s=1$, $r=32$ 和 $\\delta = \\pi/256$：\n$\\phi_{\\text{err}} = 1/32 + (\\pi/256) / (2\\pi) = 1/32 + 1/(256 \\cdot 2) = 1/32 + 1/512$。\n\n第一个寄存器中的状态数为 $Q=1024$。\n理想的测量结果 $k_{\\text{ideal}}$ 对应于 $Q \\phi_s = 1024 \\cdot (1/32) = 32$。\n由于 $32$ 是一个整数，所以 $k_{\\text{ideal}} = 32$。\n\n错误的测量结果 $k_{\\text{err}}$ 对应于 $Q \\phi_{\\text{err}} = 1024 \\cdot (1/32 + 1/512)$。\n计算：\n$1024 \\cdot (1/32) = 32$，\n$1024 \\cdot (1/512) = 1024 / 512 = 2$。\n因此，$Q \\phi_{\\text{err}} = 32 + 2 = 34$。\n由于 $34$ 是一个整数，所以 $k_{\\text{err}} = 34$。\n\n偏移量为 $\\Delta k = k_{\\text{err}} - k_{\\text{ideal}} = 34 - 32 = 2$。", "answer": "$$ \\boxed{2} $$", "id": "160728"}]}