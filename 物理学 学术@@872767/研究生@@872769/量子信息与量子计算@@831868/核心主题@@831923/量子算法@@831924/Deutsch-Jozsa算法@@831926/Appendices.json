{"hands_on_practices": [{"introduction": "量子算法并非孤立的理论构造，它们之间常常存在深刻的内在联系。本练习将揭示 Deutsch-Jozsa 算法与另一个著名的 Grover 搜索算法之间的奇妙关联。通过在标准 Deutsch-Jozsa 流程中引入 Grover 算法的核心组件——扩散算符（diffusion operator），我们将探索由平衡函数（balanced function）生成的量子态在希尔伯特空间中所具有的独特几何特性。这个练习不仅能加深你对 Deutsch-Jozsa 算法输出态结构的理解，还能让你体会到不同量子算法之间概念上的互通性。[@problem_id:151378]", "problem": "考虑一个用于分析函数 $f: \\{0, 1\\}^n \\to \\{0, 1\\}$ 的 Deutsch-Jozsa 算法的修改版本。该量子电路作用于一个 $n$ 量子比特的输入寄存器和一个单量子比特的输出寄存器。\n\n该算法按以下步骤进行：\n1. 输入寄存器被初始化为 $|0\\rangle^{\\otimes n}$，输出寄存器被初始化为 $|1\\rangle$。\n2. 对每个量子比特施加一个 Hadamard 门，制备出状态 $\\left(\\frac{1}{\\sqrt{2^n}}\\sum_{x \\in \\{0,1\\}^n} |x\\rangle\\right) \\otimes \\left(\\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}\\right)$。\n3. 施加一个量子预言机 $U_f$，它将状态 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f(x)\\rangle$。此操作后，输出寄存器处于状态 $\\frac{|0\\rangle - |1\\rangle}{\\sqrt{2}}$ (至多相差一个全局相位)，可以被忽略。输入寄存器的状态变为：\n$$|\\psi_f\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} (-1)^{f(x)} |x\\rangle$$\n\n函数 $f$ 保证是**平衡的**，意味着对于恰好一半的可能输入，其值为 $1$，而对于另一半，其值为 $0$。\n\n4. 与标准算法不同的是，将单个 Grover 扩散算子 $D = 2|+\\rangle\\langle+|^{\\otimes n} - I$ 施加到输入寄存器上。这里，$I$ 是 $n$ 量子比特上的单位算子，且 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$。\n\n将算子 $D$ 施加到状态 $|\\psi_f\\rangle$ 后，在计算基下对输入寄存器进行测量。计算测量到除全零状态 $|0\\rangle^{\\otimes n}$ 之外任何状态的总概率。你的答案应该是一个关于 $n$ 的表达式。", "solution": "函数 $f: \\{0, 1\\}^n \\to \\{0, 1\\}$ 是平衡的，因此恰好一半的输入求值为 0，另一半求值为 1。施加预言机后的状态是：\n\n$$\n|\\psi_f\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} (-1)^{f(x)} |x\\rangle.\n$$\n\nGrover 扩散算子被定义为 $D = 2 |s\\rangle\\langle s| - I$，其中 $|s\\rangle = \\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} |x\\rangle$，$I$ 是单位算子。将 $D$ 施加到 $|\\psi_f\\rangle$：\n\n$$\nD |\\psi_f\\rangle = (2 |s\\rangle\\langle s| - I) |\\psi_f\\rangle = 2 |s\\rangle \\langle s | \\psi_f \\rangle - |\\psi_f\\rangle.\n$$\n\n内积 $\\langle s | \\psi_f \\rangle$ 是：\n\n$$\n\\langle s | \\psi_f \\rangle = \\left( \\frac{1}{\\sqrt{2^n}} \\sum_{y} \\langle y| \\right) \\left( \\frac{1}{\\sqrt{2^n}} \\sum_{x} (-1)^{f(x)} |x\\rangle \\right) = \\frac{1}{2^n} \\sum_{x} (-1)^{f(x)}.\n$$\n\n由于 $f$ 是平衡的，$\\sum_{x} (-1)^{f(x)} = 0$ (因为有 $2^{n-1}$ 个 $+1$ 项和 $2^{n-1}$ 个 $-1$ 项)。因此：\n\n$$\n\\langle s | \\psi_f \\rangle = 0.\n$$\n\n代入此结果：\n\n$$\nD |\\psi_f\\rangle = 2 |s\\rangle \\cdot 0 - |\\psi_f\\rangle = -|\\psi_f\\rangle.\n$$\n\n施加 $D$ 后的状态是 $-|\\psi_f\\rangle$，由于全局相位，它与 $|\\psi_f\\rangle$ 具有相同的概率分布。测量到特定状态 $|z\\rangle$ 的概率是 $|\\langle z | \\psi_f \\rangle|^2$。对于全零状态 $|0\\rangle^{\\otimes n}$：\n\n$$\n\\langle 0^{\\otimes n} | \\psi_f \\rangle = \\frac{1}{\\sqrt{2^n}} (-1)^{f(0^n)},\n$$\n\n所以概率是：\n\n$$\n\\left| \\frac{1}{\\sqrt{2^n}} (-1)^{f(0^n)} \\right|^2 = \\frac{1}{2^n}.\n$$\n\n测量到除 $|0\\rangle^{\\otimes n}$ 之外任何状态的概率是：\n\n$$\n1 - \\frac{1}{2^n}.\n$$", "answer": "$$ \\boxed{1 - \\frac{1}{2^{n}}} $$", "id": "151378"}, {"introduction": "理想的量子算法在现实世界中会受到各种噪声的挑战，其中初始量子态制备的不完美是一个常见来源。本练习将引导我们从理想化的模型走向更贴近实际的场景。我们将不再假设辅助量子比特被完美地制备在 $|1\\rangle$ 态，而是使用密度矩阵来描述一个处于混合态的辅助比特。通过分析这个带有噪声的系统，你将学会如何量化状态制备错误对算法性能的影响，并计算出算法在这种实际条件下的成功概率。[@problem_id:151531]", "problem": "Deutsch-Jozsa 算法提供了一种确定函数 $f: \\{0,1\\}^n \\to \\{0,1\\}$ 某个性质的方法。该函数保证是*常数*函数（对所有输入，输出都相同）或*平衡*函数（对恰好一半的输入，输出为 0，对另一半的输入，输出为 1）。\n\n标准算法使用一个量子线路，该线路包含 $n$ 个输入量子比特和一个目标（或辅助）量子比特。初始态为 $|0\\rangle^{\\otimes n}|1\\rangle$。该线路应用一系列门操作：\n1. 对全部 $n+1$ 个量子比特各应用一个 Hadamard 门。\n2. 函数谕示 $U_f$，它执行变换 $|x\\rangle|y\\rangle \\mapsto |x\\rangle|y \\oplus f(x)\\rangle$。\n3. 对前 $n$ 个输入量子比特各应用一个 Hadamard 门。\n\n最后，在前 $n$ 个量子比特上进行计算基测量。如果测量结果是全零态 $|0\\rangle^{\\otimes n}$，则函数被判定为常数函数。如果得到任何其他结果，则函数被判定为平衡函数。在理想情况下，该算法是确定性的，并且总是给出正确的答案。\n\n考虑对该过程进行修改，其中目标量子比特的状态制备是不完美的。$n$ 个输入量子比特被正确地制备在状态 $|0\\rangle^{\\otimes n}$。然而，目标量子比特被制备在由以下密度算符描述的混合态：\n$$\n\\rho_{\\text{target}} = (1-p) |1\\rangle\\langle 1| + p |0\\rangle\\langle 0|\n$$\n其中 $p \\in [0, 1]$ 是一个表征制备误差的参数。\n\n算法的其余部分（步骤 1-3 和最终的测量规则）按上述方式进行。假设函数 $f$ 已知为平衡函数。计算该算法正确地将其识别为平衡函数的概率。", "solution": "如果对前 $n$ 个量子比特的测量结果不是全零态 $|0\\rangle^{\\otimes n}$，则该算法正确地将函数识别为平衡函数。$n$ 个输入量子比特的初始态为 $|0\\rangle^{\\otimes n}$，目标量子比特处于混合态：\n\n$$\n\\rho_{\\text{target}} = (1-p) |1\\rangle\\langle 1| + p |0\\rangle\\langle 0|.\n$$\n\n这个混合态对应于两种情况：\n- 情况 A：目标量子比特是 $|1\\rangle$，概率为 $1-p$。\n- 情况 B：目标量子比特是 $|0\\rangle$，概率为 $p$。\n\n在情况 A 中（目标初始为 $|1\\rangle$），线路是理想的。在应用 Hadamard 门、谕示 $U_f$ 和另一组 Hadamard 门之后，对于一个平衡函数 $f$，前 $n$ 个量子比特的状态在 $|0\\rangle^{\\otimes n}$ 上的幅为零。因此，测量得到 $|0\\rangle^{\\otimes n}$ 的概率为 0。\n\n在情况 B 中（目标初始为 $|0\\rangle$），在第一组 Hadamard 门之后，目标态变为 $|+\\rangle = \\frac{|0\\rangle + |1\\rangle}{\\sqrt{2}}$。谕示 $U_f$ 的作用是 $|x\\rangle|y\\rangle \\mapsto |x\\rangle|y \\oplus f(x)\\rangle$。由于：\n\n$$\nU_f |x\\rangle|+\\rangle = |x\\rangle \\frac{|f(x)\\rangle + |1 \\oplus f(x)\\rangle}{\\sqrt{2}} = |x\\rangle|+\\rangle,\n$$\n\n状态在 $U_f$ 作用下保持不变。在对前 $n$ 个量子比特施加最后一组 Hadamard 门之后，状态变为 $|0\\rangle^{\\otimes n} \\otimes |+\\rangle$。因此，对前 $n$ 个量子比特的测量总是以概率 1 得到 $|0\\rangle^{\\otimes n}$。\n\n测量得到 $|0\\rangle^{\\otimes n}$ 的总概率是加权平均值：\n\n$$\nP(\\text{测量 } |0\\rangle^{\\otimes n}) = (1-p) \\cdot 0 + p \\cdot 1 = p.\n$$\n\n如果测量到 $|0\\rangle^{\\otimes n}$，算法会错误地将函数判定为常数函数。由于该函数是平衡的，正确识别（判定为平衡）的概率是：\n\n$$\nP(\\text{正确}) = 1 - P(\\text{测量 } |0\\rangle^{\\otimes n}) = 1 - p.\n$$", "answer": "$$ \\boxed{1 - p} $$", "id": "151531"}, {"introduction": "除了状态制备和测量中的非相干噪声，相干误差（coherent error）是构建大规模量子计算机的另一个关键障碍，其中量子比特之间的串扰（crosstalk）尤为突出。本练习模拟了一种在许多量子计算平台中普遍存在的寄生 $Z Z$ 相互作用。你将分析在神谕（oracle）操作期间，这种非预期的相干演化如何影响算法的最终结果。这个实践将挑战你运用算符变换和相干动力学分析的能力，从而定量地理解串扰如何导致算法失效。[@problem_id:151393]", "problem": "Deutsch-Jozsa 算法用于判断一个函数 $f: \\{0, 1\\}^n \\to \\{0, 1\\}$ 是常函数还是平衡函数，并保证该函数必为两者之一。该算法使用一个 $n$ 量子比特的输入寄存器和一个单量子比特的辅助寄存器。\n\n标准算法的步骤如下：\n1.  将状态初始化为 $|0\\rangle^{\\otimes n} |1\\rangle$。\n2.  对每个量子比特应用阿达马门 $H$，制备出状态 $\\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} |x\\rangle \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$。\n3.  应用神谕查询 $U_f$，它将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus f(x)\\rangle$。其在所制备状态上的作用会引发相位回踢，将输入寄存器的状态变换为 $\\frac{1}{\\sqrt{2^n}} \\sum_{x \\in \\{0,1\\}^n} (-1)^{f(x)} |x\\rangle$。辅助量子比特保持在 $\\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$ 状态，此后可以忽略。\n4.  对输入寄存器的每个量子比特应用阿达马门 $H$。\n5.  在计算基下测量输入寄存器。如果结果是 $|0\\rangle^{\\otimes n}$，则断定该函数为常函数。否则，断定其为平衡函数。对于一个理想的神谕，这个判断总是正确的。\n\n考虑一个实际实现，其中输入寄存器的 $n$ 个量子比特排列成一维链状。在应用神谕的步骤中，相邻量子比特之间会发生寄生的 ZZ 串扰相互作用。这种相干误差可以用一个幺正算符 $U_{err}$ 来建模，它在理想神谕 $U_f$ 之后立即作用于输入寄存器。因此，在神谕步骤中的总变换为 $U_{err} U_f$。\n\n误差算符由下式给出：\n$$\nU_{err} = \\exp\\left(-i \\theta \\sum_{j=1}^{n-1} Z_j Z_{j+1}\\right)\n$$\n其中 $Z_j$ 是作用在第 $j$ 个量子比特上的泡利-Z 算符，$\\theta$ 是一个表征寄生相互作用强度的实数、无量纲参数。\n\n假设函数 $f$ 是常函数，计算算法正确地将其识别为常函数的概率 $P_{success}$（即输入寄存器的最终测量得到 $|0\\rangle^{\\otimes n}$ 状态）。", "solution": "1. 在理想神谕之后，对于常函数 $f(x)=0$，输入寄存器处于积态\n$$|\\psi_1\\rangle = \\frac{1}{\\sqrt{2^n}}\\sum_{x\\in\\{0,1\\}^n}|x\\rangle = |+\\rangle^{\\otimes n}.$$\n2. 相干误差幺正算符为\n$$U_{err} = \\exp\\left(-i\\theta\\sum_{j=1}^{n-1}Z_jZ_{j+1}\\right).$$\n3. 最后一层阿达马门加上测量得到 $|0\\rangle^{\\otimes n}$ 的振幅为\n$$A = \\langle 0|^{\\otimes n} H^{\\otimes n} U_{err} |+\\rangle^{\\otimes n}.$$\n4. 使用 $H^{\\otimes n}Z_jZ_{j+1}H^{\\otimes n}=X_jX_{j+1}$ 和 $H|+\\rangle=|0\\rangle$ 来重写\n$$A = \\langle 0|^{\\otimes n}\\exp\\left(-i\\theta\\sum_j Z_j Z_{j+1}\\right)|+\\rangle^{\\otimes n} = \\langle 0|^{\\otimes n}\\exp\\left(-i\\theta\\sum_j X_j X_{j+1}\\right)|0\\rangle^{\\otimes n}.$$\n5. 由于对易的两体门可以因子化，\n$$\\exp\\left(-i\\theta\\sum_{j=1}^{n-1}X_jX_{j+1}\\right) = \\prod_{j=1}^{n-1}(\\cos\\theta I - i\\sin\\theta X_jX_{j+1}),$$\n作用于 $|0\\rangle^{\\otimes n}$。每一项 $X_jX_{j+1}$ 会翻转量子比特 $j$ 和 $j+1$，而回到 $|0\\rangle^{\\otimes n}$ 状态的唯一方法是从每个因子中都选取单位算符。因此\n$$A=(\\cos\\theta)^{n-1},$$\n且成功概率为\n$$P_{success}=|A|^2=\\cos^{2(n-1)}\\theta.$$", "answer": "$$\\boxed{\\cos^{2(n-1)}\\theta}$$", "id": "151393"}]}