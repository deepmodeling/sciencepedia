{"hands_on_practices": [{"introduction": "量子相位估计算法 (QPE) 通常在介绍时假设目标寄存器被精确地制备在某个酉算符的本征态上。然而，一个更普遍且具有启发性的场景是当输入态是多个本征态的叠加时。这个练习将探讨 QPE 线路如何处理这种情况，揭示测量结果如何反映输入态的构成以及算法的线性性质。[@problem_id:125935]", "problem": "量子相位估计算法（Quantum Phase Estimation, QPE）是一种基本的量子算法，用于确定幺正算符 $U$ 的特征值。给定一个 $U$ 的特征态 $|\\psi\\rangle$ 满足 $U|\\psi\\rangle = e^{i\\theta}|\\psi\\rangle$，该算法用于估计相位 $\\theta$。相位的一个常见表示是 $\\theta = 2\\pi\\phi$，其中 $\\phi \\in [0, 1)$ 是相位分数。标准的QPE电路使用一个 $t$ 量子比特的控制寄存器和一个持有特征态 $|\\psi\\rangle$ 的目标寄存器。该算法包括三个主要阶段：\n1.  初始化：将控制寄存器初始化为 $|0\\rangle^{\\otimes t}$，然后对每个控制量子比特应用阿达马变换。目标寄存器被制备在态 $|\\psi\\rangle$。\n2.  受控幺正运算：对每个控制量子比特 $k$（从 $0$ 到 $t-1$），对目标寄存器施加一个受控-$U^{2^k}$ 门。\n3.  逆量子傅里叶变换（IQFT）：对控制寄存器应用IQFT。\n4.  测量：在计算基下测量控制寄存器。测量结果给出了相位 $\\phi$ 的一个估计值。\n\n考虑一个简化的QPE电路，它有一个单量子比特的控制寄存器（$t=1$）和一个单量子比特的目标寄存器。幺正算符是泡利-$Z$ 门, $U=Z$。$Z$ 门的特征态是 $|0\\rangle$ 和 $|1\\rangle$，其特征值分别为 $+1$ 和 $-1$，对应的相位分数为 $\\phi=0$ 和 $\\phi=1/2$。\n\n我们将目标寄存器制备在态 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，而不是 $Z$ 的特征态。控制寄存器初始化为 $|0\\rangle$。\n\n此设置的QPE电路如下：\n1.  将系统初始化为 $|0\\rangle_c |+\\rangle_t$。\n2.  对控制量子比特应用阿达马门 $H$。\n3.  应用一个受控-$Z$ 门，控制位是控制量子比特，目标位是目标量子比特。\n4.  对控制量子比特应用逆QFT。对于单个量子比特，IQFT就是阿达马门 $H$。\n\n计算在施加完整电路后，在控制寄存器中测量到态 $|0\\rangle$ 的概率。\n\n门定义：\n- 阿达马门：$H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$\n- 泡利-Z门：$Z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$\n- 受控-Z (CZ) 门：$CZ|c,t\\rangle = (-1)^{ct}|c,t\\rangle$ 对于控制位 $c \\in \\{0,1\\}$ 和目标位 $t \\in \\{0,1\\}$。", "solution": "我们将控制量子比特标记为“c”，目标量子比特标记为“t”。  \n1. 初始态：  \n$$|\\Psi_0\\rangle \\;=\\; |0\\rangle_c\\otimes|+\\rangle_t \\;=\\; |0\\rangle_c\\otimes\\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t)\\,. $$  \n2. 对控制量子比特应用阿达马门后：  \n$$H_c|0\\rangle_c = \\frac{1}{\\sqrt{2}}(|0\\rangle_c+|1\\rangle_c)\\,, $$  \n所以  \n$$|\\Psi_1\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}(|0\\rangle_c+|1\\rangle_c)\\otimes\\frac{1}{\\sqrt{2}}(|0\\rangle_t+|1\\rangle_t)\n=\\frac{1}{2}\\sum_{c,t\\in\\{0,1\\}}|c,t\\rangle\\,. $$  \n3. 应用受控-$Z$ 门，其作用为 $CZ|c,t\\rangle =(-1)^{c\\,t}|c,t\\rangle$。因此  \n$$|\\Psi_2\\rangle \n=\\frac{1}{2}\\bigl(|0,0\\rangle+|0,1\\rangle+|1,0\\rangle -|1,1\\rangle\\bigr)\\,. $$  \n4. 再次对控制量子比特应用阿达马门（这是单量子比特的IQFT）：  \n对于每个基矢 $|c,t\\rangle$，  \n$$H_c|c\\rangle = \\frac{1}{\\sqrt{2}}\\bigl(|0\\rangle +(-1)^c|1\\rangle\\bigr)\\,. $$  \n因此联合振幅变为  \n\n$$\n|\\Psi_3\\rangle\n=\\sum_{t}\\Bigl[\\frac{a_{0t}+a_{1t}}{\\sqrt{2}}\\,|0,t\\rangle\n           +\\frac{a_{0t}-a_{1t}}{\\sqrt{2}}\\,|1,t\\rangle\\Bigr]\n$$\n\n其中 $a_{00}=a_{01}=a_{10}=+\\tfrac12$, $a_{11}=-\\tfrac12$。可以明确地求得  \n\n$$\n|\\Psi_3\\rangle\n=\\frac{1}{\\sqrt{2}}\\,|0,0\\rangle\n+\\frac{1}{\\sqrt{2}}\\,|1,1\\rangle\\,.\n$$\n  \n5. 测量到控制量子比特处于 $|0\\rangle$ 态的概率是控制位=0的振幅模平方和：  \n$$P(0_c)=\\Bigl|\\tfrac{1}{\\sqrt{2}}\\Bigr|^2 = \\tfrac12\\,. $$", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "125935"}, {"introduction": "在掌握了 QPE 的基本原理后，我们将注意力转向其最重要的应用之一：求解量子系统的能谱。这个问题演示了如何利用 QPE 来计算一个哈密顿量的基态能量，这是量子化学和凝聚态物理中的一个基本任务。通过这个练习，你将理解 QPE 输出的概率分布与初始猜测态和哈密顿量真实本征态之间的重叠有何关联。[@problem_id:125794]", "problem": "量子相位估计算法 (QPE) 是量子计算的基石，主要用于确定酉算符 $U$ 的本征值。当制备一个输入态 $|\\psi_{in}\\rangle$，它可以表示为 $U$ 的本征态 $|\\phi_j\\rangle$ 的线性组合（即 $|\\psi_{in}\\rangle = \\sum_j c_j |\\phi_j\\rangle$）时，QPE 算法将以 $|c_j|^2$ 的概率测量出相应本征值 $e^{i\\theta_j}$ 的相位 $\\theta_j$。\n\n考虑一个 QPE 过程，旨在找到由下式给出的双量子比特哈密顿量的能量本征值：\n$$\nH = Z_1 + g X_1 X_2\n$$\n在此，$Z_1 = Z \\otimes I$ 和 $X_1 X_2 = X \\otimes X$ 是作用于双量子比特希尔伯特空间上的算符，其中 $Z$ 和 $X$ 是标准的泡利矩阵。参数 $g$ 是一个实的正耦合常数。QPE 过程使用酉算符 $U = e^{-iHt}$ 进行某个演化时间 $t$，并有效地探测 $H$ 的能谱。\n\n系统被制备在初态 $|\\psi_{in}\\rangle = |10\\rangle$。注意，这个态是孤立哈密顿项 $H_0 = Z_1$ 的两个简并基态之一。\n\n一次“成功”的测量被定义为得到完整哈密顿量 $H$ 的基态能量 $E_g$ 的测量。假设 QPE 电路有足够数量的辅助量子比特来分辨出 $H$ 的不同能量本征值，且没有任何近似误差，请计算成功概率 $P_{succ}$，作为耦合参数 $g$ 的函数。", "solution": "哈密顿量由 $ H = Z_1 + g X_1 X_2 $ 给出，其中 $ Z_1 = Z \\otimes I $ 且 $ X_1 X_2 = X \\otimes X $。初态为 $ |\\psi_{\\text{in}}\\rangle = |10\\rangle $。目标是使用量子相位估计算法找到测量到 $H$ 的基态能量 $E_g$ 的概率，这取决于将 $|\\psi_{\\text{in}}\\rangle$ 在 $H$ 的本征基中展开，并提取基态的系数。\n\n$H$ 在计算基 $ \\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\} $ 中的矩阵表示为：\n$$\nH = \\begin{pmatrix}\n1  0  0  g \\\\\n0  1  g  0 \\\\\n0  g  -1  0 \\\\\ng  0  0  -1\n\\end{pmatrix}.\n$$\n该矩阵是块对角的，有两个不变子空间：$ \\{|00\\rangle, |11\\rangle\\} $ 和 $ \\{|01\\rangle, |10\\rangle\\} $。$ \\{|01\\rangle, |10\\rangle\\} $ 的块为：\n$$\nH_{\\{01,10\\}} = \\begin{pmatrix}\n1  g \\\\\ng  -1\n\\end{pmatrix}.\n$$\n初态 $ |10\\rangle $ 完全位于此子空间中。该块的本征值通过解特征方程得到：\n$$\n\\det \\begin{pmatrix}\n1 - \\lambda  g \\\\\ng  -1 - \\lambda\n\\end{pmatrix} = 0 \\implies (1 - \\lambda)(-1 - \\lambda) - g^2 = 0 \\implies \\lambda^2 - 1 - g^2 = 0.\n$$\n解为 $ \\lambda = \\pm \\sqrt{1 + g^2} $。基态能量 $ E_g $ 对应于较小的本征值 $ \\lambda_{-} = -\\sqrt{1 + g^2} $。\n\n在子空间 $ \\{|01\\rangle, |10\\rangle\\} $ 中，对应于 $ \\lambda_{-} $ 的本征向量 $ |v_{-}\\rangle $ 满足：\n$$\n\\begin{pmatrix}\n1  g \\\\\ng  -1\n\\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = -\\sqrt{1 + g^2} \\begin{pmatrix} A \\\\ B \\end{pmatrix},\n$$\n得到方程：\n$$\n(1 + \\sqrt{1 + g^2})A + gB = 0 \\implies B = -\\frac{1 + \\sqrt{1 + g^2}}{g} A.\n$$\n选择一个未归一化的形式 $ |v_{-}\\rangle = g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle $，其模方为：\n$$\n\\| |v_{-}\\rangle \\|^2 = g^2 + (1 + \\sqrt{1 + g^2})^2 = g^2 + 1 + 2\\sqrt{1 + g^2} + 1 + g^2 = 2(1 + g^2 + \\sqrt{1 + g^2}).\n$$\n因此，归一化的本征向量为：\n$$\n|v_{-}\\rangle = \\frac{g |01\\rangle - (1 + \\sqrt{1 + g^2}) |10\\rangle}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\n与初态 $ |10\\rangle $ 的交叠为：\n$$\n\\langle v_{-} | 10 \\rangle = -\\frac{1 + \\sqrt{1 + g^2}}{\\sqrt{2(1 + g^2 + \\sqrt{1 + g^2})}}.\n$$\n测量到基态能量的概率是该交叠的模方：\n$$\nP_{\\text{succ}} = \\left| \\langle v_{-} | 10 \\rangle \\right|^2 = \\frac{(1 + \\sqrt{1 + g^2})^2}{2(1 + g^2 + \\sqrt{1 + g^2})}.\n$$\n化简，令 $ s = \\sqrt{1 + g^2} $，则：\n$$\nP_{\\text{succ}} = \\frac{(1 + s)^2}{2(s^2 + s)} = \\frac{(1 + s)^2}{2s(s + 1)} = \\frac{1 + s}{2s} = \\frac{1}{2} \\left( 1 + \\frac{1}{s} \\right) = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$\n初态 $ |10\\rangle $ 在另一个子空间 $ \\{|00\\rangle, |11\\rangle\\} $ 中没有分量，因此概率完全来自于 $ |v_{-}\\rangle $。\n\n因此，成功的概率为：\n$$\nP_{\\text{succ}} = \\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{1 + g^2}} \\right).\n$$", "answer": "$$ \\boxed{\\dfrac{1}{2}\\left(1 + \\dfrac{1}{\\sqrt{1 + g^{2}}}\\right)} $$", "id": "125794"}, {"introduction": "在实际的量子模拟中，精确地模拟哈密顿量的演化通常是不可行的，因此我们常常采用像 Trotter-Suzuki 分解这样的近似方法，但这会引入系统误差。本练习旨在介绍一种先进且实用的误差缓解技术——理查森外推法。通过结合多次不同精度的模拟结果，该方法能够系统性地消除低阶误差项，从而获得更高精度的结果，这对于在近期量子计算机上实现有价值的模拟至关重要。[@problem_id:125854]", "problem": "在对哈密顿量 $H = \\sum_j H_j$ 进行总时间为 $t$ 的量子模拟中，演化酉算符 $U = e^{-iHt}$ 通常被近似。一种常见的方法是一阶 Trotter-Suzuki 分解。当在量子相位估计算法 (QPE) 中使用时，这种近似会在估算的相位中引入系统误差。\n\n假设对于固定的总演化时间，使用步长为 $\\delta$ 的一阶 Trotter 近似，通过 QPE 估算的相位 $\\hat{\\theta}(\\delta)$ 的误差可以展开为幂级数：\n$$\n\\hat{\\theta}(\\delta) = \\theta_{true} + C_1 \\delta + C_2 \\delta^2 + C_3 \\delta^3 + \\mathcal{O}(\\delta^4)\n$$\n此处，$\\theta_{true}$ 是对应于 $U$ 的一个本征值的精确相位，$C_1, C_2, C_3$ 是由哈密顿量和相关本征态决定的未知常数。\n\n为了减小这种误差，进行了三次独立的 QPE 实验，分别使用 $\\epsilon$、$\\epsilon/2$ 和 $\\epsilon/4$ 的 Trotter 步长。所得的相位估算值分别表示为 $\\hat{\\theta}(\\epsilon)$、$\\hat{\\theta}(\\epsilon/2)$ 和 $\\hat{\\theta}(\\epsilon/4)$。\n\n使用这三次测量结果，推导 $\\theta_{true}$ 的 Richardson 外推估计值，该估计值精确到 $\\mathcal{O}(\\epsilon^3)$。将此改进后的估计值表示为三个测量相位 $\\hat{\\theta}(\\epsilon)$、$\\hat{\\theta}(\\epsilon/2)$ 和 $\\hat{\\theta}(\\epsilon/4)$ 的单个线性组合。", "solution": "我们有在不同步长下测量相位的展开式：\n$$\n\\hat\\theta(\\epsilon)=\\theta_{true}+C_1\\epsilon+C_2\\epsilon^2+C_3\\epsilon^3+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon2+C_2\\tfrac{\\epsilon^2}{4}+C_3\\tfrac{\\epsilon^3}{8}+\\mathcal{O}(\\epsilon^4),\n$$\n$$\n\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\theta_{true}+C_1\\tfrac\\epsilon4+C_2\\tfrac{\\epsilon^2}{16}+C_3\\tfrac{\\epsilon^3}{64}+\\mathcal{O}(\\epsilon^4).\n$$\n我们寻求一个线性组合 \n$$L=a\\,\\hat\\theta(\\epsilon)+b\\,\\hat\\theta(\\tfrac\\epsilon2)+c\\,\\hat\\theta(\\tfrac\\epsilon4)$$\n使得 $L=\\theta_{true}+\\mathcal{O}(\\epsilon^3)$。匹配系数可得方程组\n$$\na+b+c=1,\\quad\na+\\tfrac b2+\\tfrac c4=0,\\quad\na+\\tfrac b4+\\tfrac c{16}=0.\n$$\n将第三式减去第二式，可得 $4b+3c=0\\implies b=-\\tfrac{3c}4$。然后从第三式，\n$$\na=-\\frac b4-\\frac c{16}=\\frac{c}{8}.\n$$\n代入 $a+b+c=1$ 可得\n$$\n\\frac{c}{8}-\\frac{3c}{4}+c=1\n\\;\\Longrightarrow\\;3c=8\n\\;\\Longrightarrow\\;c=\\frac{8}{3},\\quad b=-2,\\quad a=\\frac{1}{3}.\n$$\n因此，Richardson 外推估计值为\n$$\nL=\\frac{1}{3}\\,\\hat\\theta(\\epsilon)-2\\,\\hat\\theta\\bigl(\\tfrac\\epsilon2\\bigr)\n+\\frac{8}{3}\\,\\hat\\theta\\bigl(\\tfrac\\epsilon4\\bigr)\n=\\frac{\\hat\\theta(\\epsilon)-6\\,\\hat\\theta(\\tfrac\\epsilon2)+8\\,\\hat\\theta(\\tfrac\\epsilon4)}{3}\n+\\mathcal{O}(\\epsilon^3).\n$$", "answer": "$$\\boxed{\\frac{\\hat{\\theta}(\\epsilon)-6\\,\\hat{\\theta}(\\epsilon/2)+8\\,\\hat{\\theta}(\\epsilon/4)}{3}}$$", "id": "125854"}]}