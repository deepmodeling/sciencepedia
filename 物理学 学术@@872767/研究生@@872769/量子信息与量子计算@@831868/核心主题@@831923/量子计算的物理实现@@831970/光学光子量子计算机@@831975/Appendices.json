{"hands_on_practices": [{"introduction": "要理解线性光学量子计算，核心在于掌握多光子干涉的原理。这个练习提供了一个具体的实例，要求我们计算在一个级联干涉仪中发生特定量子过程的概率。通过这个练习，你将实践如何利用幺正变换矩阵和矩阵的积和式（permanent）这一关键数学工具，来预测多光子系统在通过线性光学网络后的演化结果，这是分析玻色子采样和光子门操作的基础。[@problem_id:107063]", "problem": "考虑一个为线性光学量子计算设计的三端口级联干涉仪。该干涉仪由三个空间模式组成。这些模式由一系列光学元件进行调控。首先，一个50:50分束器 $BS_1$ 耦合模式1和2。然后，一个移相器对模式2施加一个$\\theta$的相移。最后，第二个50:50分束器 $BS_2$ 耦合模式2和3。\n\n一个50:50分束器作用于具有产生算符 $(a_j^\\dagger, a_k^\\dagger)$ 的两个输入模式，将其变换为具有产生算符 $(b_j^\\dagger, b_k^\\dagger)$ 的两个输出模式，该变换由以下幺正矩阵描述：\n$$\nU_{BS} = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n1  i \\\\\ni  1\n\\end{pmatrix}\n$$\n使得 $\\begin{pmatrix} b_j^\\dagger \\\\ b_k^\\dagger \\end{pmatrix} = U_{BS} \\begin{pmatrix} a_j^\\dagger \\\\ a_k^\\dagger \\end{pmatrix}$。作用于模式 $k$ 的移相器将其产生算符变换为 $a_k^\\dagger \\to e^{i\\theta} a_k^\\dagger$。\n\n一个输入态由模式1中的两个光子和模式2中的一个光子组成，而模式3处于真空态，该输入态被送入干涉仪。该状态在福克基中可以写为 $|2, 1, 0\\rangle$。\n\n你的任务是计算在三个输出模式中各探测到一个光子的概率，即发现系统处于输出态 $|1, 1, 1\\rangle$ 的概率。", "solution": "问题要求计算从输入福克态 $|n_1, n_2, n_3\\rangle = |2, 1, 0\\rangle$ 经过一个三端口线性光学干涉仪后，跃迁到输出福克态 $|n'_1, n'_2, n'_3\\rangle = |1, 1, 1\\rangle$ 的概率。\n\n**步骤1：确定干涉仪的幺正变换矩阵**\n\n干涉仪包含三个作用于三个模式的阶段。我们可以用一个作用于产生算符列向量 $(a_1^\\dagger, a_2^\\dagger, a_3^\\dagger)^T$ 的 $3 \\times 3$ 幺正矩阵来表示每个阶段。\n\n1.  第一个分束器 $BS_1$ 作用于模式1和2。其矩阵表示为：\n    $$\n    U_1 = \\begin{pmatrix}\n    1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\n    i/\\sqrt{2}  1/\\sqrt{2}  0 \\\\\n    0  0  1\n    \\end{pmatrix}\n    $$\n2.  移相器对模式2施加一个相位 $e^{i\\theta}$。其矩阵为：\n    $$\n    U_\\theta = \\begin{pmatrix}\n    1  0  0 \\\\\n    0  e^{i\\theta}  0 \\\\\n    0  0  1\n    \\end{pmatrix}\n    $$\n3.  第二个分束器 $BS_2$ 作用于模式2和3。其矩阵为：\n    $$\n    U_2 = \\begin{pmatrix}\n    1  0  0 \\\\\n    0  1/\\sqrt{2}  i/\\sqrt{2} \\\\\n    0  i/\\sqrt{2}  1/\\sqrt{2}\n    \\end{pmatrix}\n    $$\n\n干涉仪的总变换矩阵 $U$ 是这些矩阵按其作用相反顺序的乘积：$U = U_2 U_\\theta U_1$。\n首先，我们计算 $U_\\theta U_1$：\n$$\nU_\\theta U_1 = \\begin{pmatrix}\n1  0  0 \\\\\n0  e^{i\\theta}  0 \\\\\n0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\ni/\\sqrt{2}  1/\\sqrt{2}  0 \\\\\n0  0  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\ni e^{i\\theta}/\\sqrt{2}  e^{i\\theta}/\\sqrt{2}  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n接下来，我们乘以 $U_2$：\n$$\nU = U_2 (U_\\theta U_1) =\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1/\\sqrt{2}  i/\\sqrt{2} \\\\\n0  i/\\sqrt{2}  1/\\sqrt{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\ni e^{i\\theta}/\\sqrt{2}  e^{i\\theta}/\\sqrt{2}  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n$$\nU = \\begin{pmatrix}\n1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\n(1/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2})  (1/\\sqrt{2})(e^{i\\theta}/\\sqrt{2})  (i/\\sqrt{2})(1) \\\\\n(i/\\sqrt{2})(i e^{i\\theta}/\\sqrt{2})  (i/\\sqrt{2})(e^{i\\theta}/\\sqrt{2})  (1/\\sqrt{2})(1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2}  i/\\sqrt{2}  0 \\\\\ni e^{i\\theta}/2  e^{i\\theta}/2  i/\\sqrt{2} \\\\\n-e^{i\\theta}/2  i e^{i\\theta}/2  1/\\sqrt{2}\n\\end{pmatrix}\n$$\n\n**步骤2：使用跃迁振幅公式**\n\n对于一个多光子过程，从输入态 $|\\mathbf{n}\\rangle = |n_1, ..., n_m\\rangle$ 通过一个由幺正矩阵 $U$ 描述的线性光学网络，到输出态 $|\\mathbf{n'}\\rangle = |n'_1, ..., n'_m\\rangle$ 的跃迁振幅由以下公式给出：\n$$\n\\langle \\mathbf{n'} | \\mathcal{U} | \\mathbf{n} \\rangle = \\frac{\\text{perm}(U_S)}{\\sqrt{n_1! \\dots n_m! \\cdot n'_1! \\dots n'_m!}}\n$$\n其中 $U_S$ 是 $U$ 的一个子矩阵，它是根据输入和输出的光子数构造的。对于一个在模式 $k$ 有 $n_k$ 个光子的输入态，和在模式 $j$ 有 $n'_j$ 个光子的输出态，矩阵 $U_S$ 是通过取 $U$ 的第 $k$ 列 $n_k$ 次，并取 $U$ 的第 $j$ 行 $n'_j$ 次来形成的。\n\n在我们的例子中，输入态是 $|2,1,0\\rangle$ 而输出态是 $|1,1,1\\rangle$。总光子数为 $N=3$。矩阵 $U_S$ 是一个 $3 \\times 3$ 矩阵。它的列由输入态确定：两份 $U$ 的第一列和一份 $U$ 的第二列。它的行由输出态确定：$U$ 的三行各取一份。\n所以，$U_S$ 是：\n$$\nU_S = \\begin{pmatrix}\nU_{11}  U_{11}  U_{12} \\\\\nU_{21}  U_{21}  U_{22} \\\\\nU_{31}  U_{31}  U_{32}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1/\\sqrt{2}  1/\\sqrt{2}  i/\\sqrt{2} \\\\\ni e^{i\\theta}/2  i e^{i\\theta}/2  e^{i\\theta}/2 \\\\\n-e^{i\\theta}/2  -e^{i\\theta}/2  i e^{i\\theta}/2\n\\end{pmatrix}\n$$\n\n**步骤3：计算 $U_S$ 的积和式**\n\n一个 $3 \\times 3$ 矩阵 $A = (a_{ij})$ 的积和式由 $\\text{perm}(A) = \\sum_{\\sigma \\in S_3} \\prod_{i=1}^3 a_{i, \\sigma(i)}$ 给出。\n对于形式为 $A = \\begin{pmatrix} a  a  b \\\\ c  c  d \\\\ e  e  f \\end{pmatrix}$ 的矩阵，其积和式为 $\\text{perm}(A) = 2(acf + ade + bce)$。\n让我们确定这些元素：\n$a = U_{11} = 1/\\sqrt{2}$\n$b = U_{12} = i/\\sqrt{2}$\n$c = U_{21} = i e^{i\\theta}/2$\n$d = U_{22} = e^{i\\theta}/2$\n$e = U_{31} = -e^{i\\theta}/2$\n$f = U_{32} = i e^{i\\theta}/2$\n\n现在我们计算各项：\n$acf = (1/\\sqrt{2})(i e^{i\\theta}/2)(i e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$ade = (1/\\sqrt{2})(e^{i\\theta}/2)(-e^{i\\theta}/2) = -e^{2i\\theta}/(4\\sqrt{2})$\n$bce = (i/\\sqrt{2})(i e^{i\\theta}/2)(-e^{i\\theta}/2) = e^{2i\\theta}/(4\\sqrt{2})$\n\n将它们相加：\n$acf + ade + bce = -e^{2i\\theta}/(4\\sqrt{2}) - e^{2i\\theta}/(4\\sqrt{2}) + e^{2i\\theta}/(4\\sqrt{2}) = -e^{2i\\theta}/(4\\sqrt{2})$\n所以，积和式为：\n$\\text{perm}(U_S) = 2 \\times (-e^{2i\\theta}/(4\\sqrt{2})) = -e^{2i\\theta}/(2\\sqrt{2})$。\n\n**步骤4：计算概率**\n\n归一化因子是 $\\sqrt{n_1! n_2! n_3! \\cdot n'_1! n'_2! n'_3!} = \\sqrt{2! \\cdot 1! \\cdot 0! \\cdot 1! \\cdot 1! \\cdot 1!} = \\sqrt{2}$。\n振幅 $A$ 为：\n$$\nA = \\frac{\\text{perm}(U_S)}{\\sqrt{2}} = \\frac{-e^{2i\\theta}/(2\\sqrt{2})}{\\sqrt{2}} = -\\frac{e^{2i\\theta}}{4}\n$$\n概率 $P$ 是振幅的模的平方：\n$$\nP = |A|^2 = \\left|-\\frac{e^{2i\\theta}}{4}\\right|^2 = \\left(\\frac{1}{4}\\right)^2 |-e^{2i\\theta}|^2 = \\frac{1}{16} \\cdot 1 = \\frac{1}{16}\n$$\n该概率与相移 $\\theta$ 无关。", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "107063"}, {"introduction": "在基于测量的量子计算模型中，簇态等大规模纠缠态是至关重要的计算资源。光学方法是制备这些资源态的有前途的途径之一，但其关键的纠缠操作通常是概率性的。本练习探讨了在这种概率性条件下，循序构建一个四量子比特簇态所需的平均资源代价，这一场景深刻地揭示了在现实的光学量子计算方案中，由于门操作的非确定性而带来的巨大资源开销，并训练了我们对这类随机过程进行期望值分析的能力。[@problem_id:107002]", "problem": "在基于测量的量子计算（MBQC）中，首先制备被称为簇态的大型纠缠资源态，然后通过一系列单量子比特测量来消耗它们。MBQC光学实现中的一个主要挑战是纠缠操作的概率性。\n\n考虑构建一个四量子比特方形簇态的任务。该状态可以看作是位于一个正方形顶点的四个量子比特，其纠缠链对应于正方形的边。构建过程始于四个处于乘积态 $|+\\rangle^{\\otimes 4}$ 的量子比特，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。形成方形拓扑结构所需的四个纠缠链（CZ门）是依次创建的。\n\n任意两个量子比特之间纠缠链的创建是通过一个概率过程来尝试的，在本问题中，该过程可以建模为一个“融合门”。每次创建链的尝试都会消耗一个预报的贝尔对，并以概率 $p$ 成功。\n\n四量子比特方形簇态的构建计划为一个顺序过程：\n1.  在量子比特1和2之间创建一条边，形成一个2量子比特线性簇。\n2.  在量子比特2和3之间创建一条边，形成一个3量子比特线性簇。\n3.  在量子比特3和4之间创建一条边，形成一个4量子比特线性簇。\n4.  最后，在量子比特4和1之间创建一条边以闭合环路，完成方形簇。\n\n这个制备过程的一个关键方面是其对失败的敏感性。在构建的任何阶段，如果尝试添加下一个所需边的操作失败，会导致整个现有的纠缠结构退相干。发生这种情况时，必须从最开始（即从初始的四量子比特乘积态）重新开始构建。请注意，在第一次尝试（构建2量子比特簇）时失败不会破坏任何已存在的纠缠，因为此时还没有纠缠。\n\n你的任务是计算成功构建四量子比特方形簇态所需的预报贝尔对的总平均数。请用成功概率 $p$ 的闭式解析表达式来表示你的答案。", "solution": "设 $C$ 为所需的预报贝尔对的总平均数。构建过程是顺序的，涉及创建四个纠缠链。我们用所包含的边数来表示中间结构：\n-   $S_0$：四个未纠缠量子比特的初始状态。\n-   $S_1$：具有一条边的2量子比特线性簇。\n-   $S_2$：具有两条边的3量子比特线性簇。\n-   $S_3$：具有三条边的4量子比特线性簇。\n-   $S_4$：最终的具有四条边的4量子比特方形簇。\n\n设 $C_k$ 为从 $S_0$ 开始成功构建结构 $S_k$ 所需的贝尔对的期望总数。我们的目标是求出 $C_4$。\n\n**步骤1：计算创建 $S_1$ 的成本**\n\n为了从 $S_0$ 得到 $S_1$，我们尝试创建第一条边。每次尝试都是一次成功概率为 $p$ 的伯努利试验，并消耗一个贝尔对。由于没有预先存在的纠缠，失败不会导致更大结构的重启。尝试次数 $N_1$ 服从参数为 $p$ 的几何分布。\n概率质量函数为 $P(N_1=n) = (1-p)^{n-1}p$，其中 $n=1, 2, \\dots$。\n期望的尝试次数（也就是贝尔对的数量）是：\n$$C_1 = E[N_1] = \\frac{1}{p}$$\n\n**步骤2：为 $C_k$ 建立递推关系**\n\n对于 $k \\ge 2$，要构建结构 $S_k$，我们必须首先成功构建了 $S_{k-1}$。然后，我们尝试添加第 $k$ 条边。此阶段的失败会破坏整个 $S_{k-1}$ 结构，迫使从 $S_0$ 完全重新开始。\n\n设 $C_k$ 为从零开始构建 $S_k$ 的总期望成本。我们可以通过考虑获得 $S_k$ 的最后一步来建立一个递推关系。要获得 $S_k$，我们必须首先拥有 $S_{k-1}$（期望成本为 $C_{k-1}$），然后成功地添加第 $k$ 条边（成本为1个贝尔对）。这个添加过程以概率 $p$ 成功，以概率 $1-p$ 失败。\n如果尝试失败，我们损失了这1个贝尔对，并且整个结构被销毁，我们必须从头开始重新构建 $S_k$，这需要额外的期望成本 $C_k$。\n\n因此，总期望成本 $C_k$ 可以表示为成功路径的成本加上所有可能失败路径的成本。一个更直接的方法是建立如下方程：\n$$C_k = (\\text{构建 } S_{k-1} \\text{ 的成本}) + (\\text{从 } S_{k-1} \\text{ 到 } S_k \\text{ 的成本})$$\n设从 $S_{k-1}$ 到 $S_k$ 的期望成本为 $\\Delta C_k$。一次尝试的成本是1个贝尔对。如果成功（概率 $p$），过程结束。如果失败（概率 $1-p$），我们损失了1个贝尔对，并且必须从头开始整个过程，期望成本为 $C_k$。\n因此，$\\Delta C_k = 1 + (1-p) C_k$。\n这意味着 $C_k = C_{k-1} + \\Delta C_k = C_{k-1} + 1 + (1-p)C_k$。\n整理这个关于 $C_k$ 的方程：\n$C_k - (1-p)C_k = C_{k-1} + 1$\n$p C_k = C_{k-1} + 1$\n$$C_k = \\frac{C_{k-1}+1}{p}$$\n这个递推关系适用于 $k=2, 3, 4$。\n\n**步骤3：求解递推关系**\n\n我们有 $C_1 = 1/p$。现在我们可以迭代地求出 $C_2, C_3$ 和 $C_4$。\n\n-   对于 $k=2$：\n    $$C_2 = \\frac{C_1+1}{p} = \\frac{\\frac{1}{p}+1}{p} = \\frac{1+p}{p^2}$$\n\n-   对于 $k=3$：\n    $$C_3 = \\frac{C_2+1}{p} = \\frac{\\frac{1+p}{p^2}+1}{p} = \\frac{\\frac{1+p+p^2}{p^2}}{p} = \\frac{1+p+p^2}{p^3}$$\n\n-   对于 $k=4$：\n    $$C_4 = \\frac{C_3+1}{p} = \\frac{\\frac{1+p+p^2}{p^3}+1}{p} = \\frac{\\frac{1+p+p^2+p^3}{p^3}}{p} = \\frac{1+p+p^2+p^3}{p^4}$$\n\n这就是所需的贝尔对的平均数量。\n\n**步骤4：以闭式形式表示答案**\n\n分子是一个有限几何级数：$\\sum_{i=0}^{3} p^i = \\frac{1-p^4}{1-p}$。\n将此代入 $C_4$ 的表达式中：\n$$C_4 = \\frac{\\frac{1-p^4}{1-p}}{p^4} = \\frac{1-p^4}{p^4(1-p)}$$\n这就是所需贝尔对总平均数的最终闭式表达式。\n\n另外，我们也可以将 $C_4$ 表示为：\n$$C_4 = \\frac{1}{p^4} + \\frac{p}{p^4} + \\frac{p^2}{p^4} + \\frac{p^3}{p^4} = \\frac{1}{p} + \\frac{1}{p^2} + \\frac{1}{p^3} + \\frac{1}{p^4}$$\n这种形式清楚地显示了在构建的每个阶段潜在失败所带来的复合成本。", "answer": "$$ \\boxed{\\frac{1-p^4}{p^4(1-p)}} $$", "id": "107002"}, {"introduction": "理想的量子干涉要求参与过程的光子是完全不可区分的，但真实实验中的光子总会存在某种程度的差异。本练习在前一个理想干涉问题 [@problem_id:107063] 的基础上，引入了一种常见的光子不完美性——时间延迟，这导致了光子之间的部分可区分性。通过解决这个问题，你将学会如何量化这种不完美性对玻色子采样输出概率的影响，从而更深入地理解从理想量子模型向量子技术现实过渡时必须考虑的关键因素。[@problem_id:107142]", "problem": "在一个玻色子采样实验中，三个光子被注入一个对称三端口干涉仪，每个输入端口注入一个光子。该干涉仪被称为 tritter，由 3x3 幺正矩阵 $U$ 描述，该矩阵是离散傅里叶变换矩阵：\n$$ U = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  1  1 \\\\ 1  \\omega  \\omega^2 \\\\ 1  \\omega^2  \\omega \\end{pmatrix} $$\n其中 $\\omega = e^{i2\\pi/3}$。\n\n输入态被制备为三个输入模式中各有一个光子。进入输入模式 1 和 2 的光子在所有方面都是全同的。进入输入模式 3 的光子除了其时间分布外，在所有其他属性上都与另外两个光子相同。它被制备成相对于另外两个光子有 $\\tau$ 的时间延迟。\n\n光子的时间波包被建模为特征时间宽度为 $\\sigma_t$ 的归一化高斯函数。光子 1 和 2 的时间波包是 $\\psi_0(t)$，光子 3 的时间波包是 $\\psi_0(t-\\tau)$。延迟波包和未延迟波包之间的交叠由一个实数参数 $g = \\langle\\psi_0|\\psi_0(\\cdot-\\tau)\\rangle = \\exp(-\\frac{\\tau^2}{4\\sigma_t^2})$ 给出。\n\n计算在三个输出端口处各探测到一个光子的概率 $P(1,1,1)$。将你的答案表示为归一化时间交叠 $g$ 的函数。", "solution": "**步骤1：写出部分可区分光子的跃迁概率公式**\n当通过线性网络散射的光子部分可区分时，其跃迁概率的计算需要考虑它们波函数之间的交叠。在本题中，输入光子1和2全同（波函数为 $\\psi_0$），光子3因时间延迟而部分可区分（波函数为 $\\psi_0(t-\\tau)$）。它们之间的交叠为：$\\langle\\psi_i|\\psi_j\\rangle = 1$ 如果 $i,j \\in \\{1,2\\}$ 或 $i=j=3$；$\\langle\\psi_i|\\psi_j\\rangle = g$ 如果一个是3而另一个不是。\n\n对于三个部分可区分的光子散射到三个不同输出端口的事件，其概率 $P(1,1,1)$ 可以通过对所有可能的输入-输出路径振幅排列进行求和来计算。这个过程可以通过一个涉及振幅 $A_\\sigma = \\prod_{i=1}^3 U_{i, \\sigma(i)}$ 的通用公式来分析。\n\n**步骤2：根据对称性将求和分组**\n我们可以根据排列 $\\sigma$ 和 $\\pi$ 如何处理可区分的光子（光子3）来将复杂的双重求和拆分为更易于管理的部分。\n\n*   **情况 (i): 经典贡献**\n    这部分对应于光子之间没有发生量子干涉的项。在我们的模型中，这可以被视为可区分光子（光子3）的行为独立于另外两个不可区分光子（光子1和2）的干涉。这部分贡献的概率总和为 $S_1$。利用干涉仪矩阵 $U$ 的对称性，可以计算出这部分贡献为：\n    $$\n    S_1 = \\frac{1}{9}\n    $$\n    这可以被理解为一种“经典”的贡献，其值等于当光子3完全可区分时（$g=0$）的总概率。\n\n*   **情况 (ii): 量子干涉贡献**\n    这部分对应于三个光子之间发生真正量子干涉的项。这些项的大小直接受到光子之间可区分性的影响。当光子部分可区分时，这些干涉项会被压制。这部分的贡献总和为 $S_2$。我们可以通过从全同光子（$g=1$）的总概率中减去经典贡献来计算 $S_2$。对于三个全同光子，总概率为 $P_{total}(g=1) = |\\text{perm}(U)|^2$。对于3x3 DFT矩阵，$|\\text{perm}(U)|^2 = 1/3$。因此，纯量子干涉的贡献为：\n    $$\n    S_2 = P_{total}(g=1) - S_1 = \\frac{1}{3} - \\frac{1}{9} = \\frac{2}{9}\n    $$\n\n**步骤3：组合各项得到最终概率**\n总概率是上述两部分的加权和。经典部分 $S_1$ 不受可区分性影响（权重为1），而量子干涉部分 $S_2$ 则被因子 $g^2$ 压制。这个 $g^2$ 因子源于在干涉项中，可区分光子与不可区分光子之间发生了两次“交换”。\n$$\nP(1,1,1) = 1 \\cdot S_1 + g^2 \\cdot S_2\n$$\n代入我们计算出的值：\n$$\nP(1,1,1) = \\frac{1}{9} + g^2 \\cdot \\frac{2}{9} = \\frac{1+2g^2}{9}\n$$\n这个结果清晰地展示了可区分性如何破坏量子干涉。当光子完全不可区分时 ($g=1$, $\\tau=0$)，$P(1,1,1) = (1+2)/9 = 1/3$，这是三光子反聚束（anti-bunching）的结果。当光子3完全可区分时 ($g=0$, $\\tau \\to \\infty$)，$P(1,1,1) = 1/9$，概率退化为经典可区分粒子的结果。", "answer": "$$\\boxed{\\frac{1+2g^2}{9}}$$", "id": "107142"}]}