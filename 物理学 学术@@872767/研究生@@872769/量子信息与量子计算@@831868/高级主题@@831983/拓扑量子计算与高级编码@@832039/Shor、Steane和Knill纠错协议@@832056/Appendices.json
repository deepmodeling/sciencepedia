{"hands_on_practices": [{"introduction": "稳定器测量是量子纠错的核心环节，但它并非一个原子操作，而是由一系列门电路构成的。这个过程本身也可能出现故障。本练习旨在揭示在稳定器测量过程中，一个看似微小的门级故障是如何传播并最终在数据量子比特上引入一个等效的泡利错误的。通过分析一个具体的、贴近实际的故障场景——在测量Steane码的一个稳定器时，一个CNOT门的控制和目标比特被意外交换——我们将推导出作用在数据量子比特上的等效误差算符 [@problem_id:133331]。这项练习有助于学生建立对容错电路设计的直观理解，并掌握分析误差传播路径的关键技能。", "problem": "斯蒂恩码（Steane code）是一种 [[7,1,3]] 量子纠错码，它将一个逻辑量子比特编码到七个物理量子比特中。该码由一组六个稳定子生成元（stabilizer generators）定义，这些生成元是泡利算符（Pauli operators）的乘积。对于斯蒂恩码的标准定义，其稳定子生成元由下式给出：\n$$\ng_1^X = X_1 X_2 X_3 X_4, \\quad g_2^X = X_1 X_2 X_5 X_6, \\quad g_3^X = X_1 X_3 X_5 X_7 \\\\\ng_1^Z = Z_1 Z_2 Z_3 Z_4, \\quad g_2^Z = Z_1 Z_2 Z_5 Z_6, \\quad g_3^Z = Z_1 Z_3 Z_5 Z_7\n$$\n作用于编码后量子比特的逻辑泡利算符，可以表示为与所有稳定子对易（commute）但本身不是稳定子的算符。例如，$\\bar{X} = \\prod_{i=1}^7 X_i$ 和 $\\bar{Z} = \\prod_{i=1}^7 Z_i$。\n\n稳定子测量是量子纠错的关键组成部分。为了测量一个多量子比特的泡利Z型稳定子，例如 $S = \\bigotimes_{j \\in \\mathcal{I}} Z_j$，通常使用一个辅助量子比特（ancilla qubit）。标准的测量线路如下：\n1. 将一个辅助量子比特制备在态 $|+\\rangle_a = \\frac{1}{\\sqrt{2}}(|0\\rangle_a + |1\\rangle_a)$ 上。\n2. 对每个数据量子比特 $j \\in \\mathcal{I}$，施加一个以量子比特 $j$ 为控制、辅助比特为目标（CNOT$_{j,a}$）的CNOT门。\n3. 对辅助比特施加一个Hadamard门。\n4. 在计算基下测量辅助比特。\n\n考虑在斯蒂恩码的逻辑态 $|\\psi\\rangle_L$ 上测量稳定子 $g_1^Z = Z_1 Z_2 Z_3 Z_4$。假设在该测量线路的执行过程中发生了一个故障：第一个CNOT门（本应是CNOT$_{1,a}$）被错误地实现为CNOT$_{a,1}$，其中控制量子比特和目标量子比特的角色被互换了。后续的CNOT门（CNOT$_{2,a}$、CNOT$_{3,a}$、CNOT$_{4,a}$）被正确地施加。\n\n在对辅助比特施加最后的Hadamard门之前，数据和辅助量子比特的整体状态从 $|\\psi\\rangle_L \\otimes |+\\rangle_a$ 演化为 $\\frac{1}{\\sqrt{2}}(|\\psi\\rangle_L \\otimes |0\\rangle_a + (E |\\psi\\rangle_L) \\otimes |1\\rangle_a)$ 形式的状态。确定因此故障而作用于数据量子比特上的等效泡利算符 $E$。", "solution": "1. 设数据量子比特标记为 $1,2,3,4,\\dots$，辅助比特为 $a$。我们从以下状态开始\n$$|\\Psi_{\\rm in}\\rangle\n=(|\\psi\\rangle_L)\\otimes|+\\rangle_a\n=\\frac1{\\sqrt2}\\sum_{x}c_x\\bigl|x_1,x_2,x_3,x_4,\\dots\\bigr\\rangle\\otimes\\bigl(|0\\rangle_a+|1\\rangle_a\\bigr)\\,. $$\n\n2. 错误的第一个门是 CNOT$_{a,1}$，其作用方式为\n$$|x_1\\rangle_1|y\\rangle_a\\;\\mapsto\\;|x_1\\oplus y\\rangle_1\\,|y\\rangle_a.$$\n作用于每个分支，\n$$\\frac1{\\sqrt2}\\sum_xc_x\\bigl(|x\\rangle|0\\rangle_a+|\\,x\\oplus e_1\\rangle|1\\rangle_a\\bigr)\\,,\\quad e_1=(1,0,0,0,\\dots).$$\n\n3. 接下来的三个门是 $j=2,3,4$ 的 CNOT$_{j,a}$，当且仅当第 $j$ 个数据比特为1时，每个门都会翻转辅助比特。因此，在所有四个CNOT门之后，\n$$\\frac1{\\sqrt2}\\sum_xc_x\\Bigl(\n|x\\rangle\\otimes|p(x)\\rangle_a\n\\;+\\;\n|x\\oplus e_1\\rangle\\otimes|1\\oplus p(x)\\rangle_a\n\\Bigr),\\quad p(x)=x_2+x_3+x_4\\pmod2.$$\n\n4. 对于一个码态 $|\\psi\\rangle_L$，我们有 $Z_1Z_2Z_3Z_4|\\psi\\rangle_L=+|\\psi\\rangle_L$，所以 $x_1=x_2+x_3+x_4\\pmod2$。因此，在 $a=0$ 分支中，数据恰好是 $|\\psi\\rangle_L$，而在 $a=1$ 分支中\n$$|x\\oplus e_1\\rangle\n=\\;X_1\\,|x\\rangle,\n\\qquad\n(-1)^{x_2+x_3+x_4}\n=\\;Z_2Z_3Z_4\\;\\text{on}\\;|x\\rangle.$$\n因此，联合状态为\n$$\\frac1{\\sqrt2}\\Bigl(\n|\\psi\\rangle_L\\otimes|0\\rangle_a\n\\;+\\;\nX_1\\,Z_2Z_3Z_4\\;|\\psi\\rangle_L\\otimes|1\\rangle_a\n\\Bigr).$$\n我们可以读出等效的数据算符\n$$E \\;=\\; X_1\\,Z_2\\,Z_3\\,Z_4\\,. $$", "answer": "$$\\boxed{X_1Z_2Z_3Z_4}$$", "id": "133331"}, {"introduction": "真实的量子系统往往会同时受到多种误差来源的影响。本练习模拟了一个既包含数据量子比特上的物理误差，又包含纠错电路中测量误差的复杂情景。该练习要求学生完整地追踪Steane码的纠错流程，它将展示由测量故障导致的错误综合征（syndrome）如何引发错误的恢复操作，并最终导致一个逻辑错误的发生 [@problem_id:133333]。这项练习训练了学生分析从物理误差到逻辑结果全过程的关键能力，并让他们学会如何计算这类复合故障下的逻辑失效率。", "problem": "Steane码是一种7量子比特的量子纠错码，记为 [[7,1,3]]，它将一个逻辑量子比特编码到七个物理量子比特中。它是一种CSS码，其纠错特性可以通过研究其稳定器生成元来理解。比特翻转（$X$）错误由一组$Z$型稳定器生成元检测，而相位翻转（$Z$）错误由一组$X$型稳定器生成元检测。\n\n在本问题中，我们只关心比特翻转错误及其纠正。相关的稳定器生成元为：\n$g_1 = Z_1 Z_2 Z_3 Z_4$\n$g_2 = Z_1 Z_2 Z_5 Z_6$\n$g_3 = Z_1 Z_3 Z_5 Z_7$\n其中$Z_i$是作用在第$i$个量子比特上的泡利-Z算符。\n\n比特翻转的纠错过程包括测量这三个稳定器中的每一个。如果状态是$g_i$的本征值为$+1$的本征矢量，则$g_i$的测量结果为$+1$（校正子比特$s_i=0$）；如果本征值为$-1$，则测量结果为$-1$（校正子比特$s_i=1$）。这些测量结果的集合构成一个3比特的校正子向量$(s_1, s_2, s_3)$。纠错策略假设单量子比特错误是最可能发生的。因此，该过程会应用与测得的校正子相关联的单量子比特泡利-X算符$X_j$。如果校正子为$(0,0,0)$，则不应用任何纠正。\n\n考虑一个使用Steane码编码的逻辑量子比特。发生了一个双量子比特物理错误，由算符$E = X_1 X_2$给出。随后，进行校正子测量。然而，用于稳定器$g_3$的测量设备存在故障：它以概率$q$报告错误的结果。$g_1$和$g_2$的测量是完美的。\n\n如果初始物理错误与随后的（可能存在缺陷的）纠错过程相结合，产生了一个对于该码来说非平凡的逻辑算符的残留错误算符，则发生逻辑错误。计算在这种情况下发生逻辑错误的总概率。", "solution": "问题要求计算在一个Steane码编码的量子比特上，发生特定的物理错误和特定的故障测量过程后，出现逻辑错误的概率。\n\n**步骤1：确定Z-校正子查找表**\n作用于量子比特$j$的物理泡利-X错误$X_j$，如果Z-稳定器$g_i$的支撑集包含量子比特$j$，则$X_j$与$g_i$反对易。反对易会导致校正子比特为1。\nZ-稳定器为：\n$g_1 = Z_1 Z_2 Z_3 Z_4$\n$g_2 = Z_1 Z_2 Z_5 Z_6$\n$g_3 = Z_1 Z_3 Z_5 Z_7$\n\n我们可以构建从单量子比特错误$X_j$到其校正子$(s_1, s_2, s_3)$的映射：\n- $X_1$：与$g_1, g_2, g_3$反对易。校正子：$(1,1,1)$。\n- $X_2$：与$g_1, g_2$反对易。校正子：$(1,1,0)$。\n- $X_3$：与$g_1, g_3$反对易。校正子：$(1,0,1)$。\n- $X_4$：与$g_1$反对易。校正子：$(1,0,0)$。\n- $X_5$：与$g_2, g_3$反对易。校正子：$(0,1,1)$。\n- $X_6$：与$g_2$反对易。校正子：$(0,1,0)$。\n- $X_7$：与$g_3$反对易。校正子：$(0,0,1)$。\n- 无错误（$I$）：校正子为$(0,0,0)$。\n\n纠错过程反向使用此表：测得的校正子$(s_1, s_2, s_3)$会触发应用相应的单量子比特纠错算符$X_j$（对于$(0,0,0)$则为$I$）。\n\n**步骤2：计算物理错误$E = X_1 X_2$的理想校正子**\n校正子在模2加法下是可加的。双量子比特错误$E=X_1 X_2$的校正子是$X_1$和$X_2$校正子之和。\n$$S_{ideal} = S(X_1) \\oplus S(X_2) = (1,1,1) \\oplus (1,1,0) = (0,0,1)$$\n因此，如果所有测量都是完美的，测得的校正子将是$(0,0,1)$。\n\n**步骤3：分析故障测量的影响**\n$g_1$和$g_2$的测量是完美的，因此测得的校正子的前两位将是$s_1=0$和$s_2=0$。\n$g_3$的测量以概率$q$发生故障。$s_3$的理想结果是1。\n\n有两种可能的情况：\n- **情况A：$g_3$的测量是正确的。** 这发生的概率为$1-q$。\n测得的校正子比特$s_3$是1。完整的测量校正子为$S_{meas,A} = (0,0,1)$。\n- **情况B：$g_3$的测量是不正确的。** 这发生的概率为$q$。\n测得的校正子比特$s_3$从1翻转为0。完整的测量校正子为$S_{meas,B} = (0,0,0)$。\n\n**步骤4：确定每种情况下的纠正和残留错误**\n- **在情况A中（概率：$1-q$）：**\n测得的校正子为$(0,0,1)$。根据查找表，该校正子对应于一个$X_7$错误。应用的纠正为$C_A = X_7$。\n初始错误为$E = X_1 X_2$。残留错误为：\n$$E_{res,A} = C_A \\cdot E = X_7 X_1 X_2 = X_1 X_2 X_7$$\n\n- **在情况B中（概率：$q$）：**\n测得的校正子为$(0,0,0)$。该校正子对应于“无错误”。应用的纠正为$C_B = I$。\n残留错误为：\n$$E_{res,B} = C_B \\cdot E = I \\cdot (X_1 X_2) = X_1 X_2$$\n\n**步骤5：确定残留错误是否为逻辑错误**\n如果一个残留错误算符$E_{res}$与该码的所有稳定器（$g_1, \\dots, g_6$）对易，但其本身不是一个稳定器，那么它就构成一个逻辑错误。对于Steane码，一个仅由泡利-X项组成且与所有Z-稳定器对易的算符，也将与所有X-稳定器对易。因此，我们只需要检查残留错误的Z-校正子。\n\n- **检查$E_{res,A} = X_1 X_2 X_7$：**\n该算符的校正子为$S(X_1 X_2 X_7) = S(X_1) \\oplus S(X_2) \\oplus S(X_7)$。\n$$S(E_{res,A}) = (1,1,1) \\oplus (1,1,0) \\oplus (0,0,1) = (0,0,0)$$\n由于校正子为$(0,0,0)$，$E_{res,A}$与所有Z-稳定器对易。\n现在，我们必须检查它是否是一个稳定器。Steane码的X-稳定器是$g_4 = X_1 X_2 X_3 X_4$，$g_5 = X_1 X_2 X_5 X_6$和$g_6 = X_1 X_3 X_5 X_7$。所有X-稳定器及其乘积都具有偶数权重（例如，$w(g_4)=4, w(g_5)=4, w(g_6)=4, w(g_4 g_5)=4$等）。残留错误$E_{res,A} = X_1 X_2 X_7$的权重为3。作为一个奇数权重的算符，它不可能是X-稳定器。\n因此，$E_{res,A}$是一个非平凡的逻辑算符。情况A导致了逻辑错误。\n\n- **检查$E_{res,B} = X_1 X_2$：**\n该算符的校正子为$S(X_1 X_2) = (0,0,1)$。\n由于校正子不是$(0,0,0)$，$E_{res,B}$不与所有稳定器对易（具体来说，它与$g_3$反对易）。因此，它是一个可检测的错误，而不是一个逻辑错误。情况B不会导致逻辑错误。\n\n**步骤6：计算总逻辑错误概率**\n逻辑错误仅在情况A中发生，其概率为$1-q$。\n逻辑错误的概率是：\n$$P_L = P(\\text{情况 A}) \\cdot P(\\text{逻辑错误 | 情况 A}) + P(\\text{情况 B}) \\cdot P(\\text{逻辑错误 | 情况 B})$$\n$$P_L = (1-q) \\cdot 1 + q \\cdot 0 = 1-q$$", "answer": "$$ \\boxed{1-q} $$", "id": "133333"}, {"introduction": "单层的量子纠错码通常不足以将错误率抑制到足够低的水平。级联（Concatenation）是一种理论上可以实现任意高保真度的强大技术。本练习探讨了两级级联Steane码的性能，通过将内层编码的逻辑错误率 $p_{\\text{log}}^{(1)}$ 视为外层编码的“物理”错误率 $p_{\\text{eff}}$，该问题揭示了级联结构对错误的指数级抑制效应 [@problem_id:133434]。这项练习让学生对量子计算阈值定理的核心思想有了定量的认识，并展示了作为容错量子计算基石的级联编码的巨大威力。", "problem": "一个双层级联量子纠错码是使用 Steane [[7,1,3]] 码作为内外两层编码构建的。Steane 码将一个逻辑量子比特编码为七个物理量子比特，并且可以纠正任意单量子比特泡利错误。这种级联方案得到了一个 [[49,1]] 码，其中一个逻辑量子比特被编码在 $7 \\times 7 = 49$ 个物理量子比特中。\n\n这 49 个物理量子比特受到一个独立的退极化信道的影响，每个量子比特以一个很小的概率 $p$ 发生错误。错误恢复过程是递归执行的。首先，对七个内层的 7 量子比特块中的每一个应用纠错程序。如果纠错失败，则在第一层级发生逻辑错误，这种情况发生在块中有两个或更多物理量子比特发生错误时。这七个内层块的逻辑量子比特随后作为外层码的七个有效量子比特。然后，在此外层应用第二个纠错程序。如果此外层纠错失败，则发生最终的、总的逻辑错误。\n\n对于单层 Steane 码，逻辑错误概率 $p_{log}^{(1)}$ 主要由块中两个物理量子比特受到错误影响的事件决定。对于本问题，您应使用以下该概率的简化领头阶表达式：\n$$p_{log}^{(1)} = \\binom{7}{2} p^2$$\n此表达式假设一个 7 量子比特块内的任何双量子比特错误都会导致该块发生逻辑错误。\n\n基于此模型，计算双层级联 Steane 码的总逻辑错误概率 $p_{log}^{(2)}$。您的答案应该是物理错误概率 $p$ 的领头阶项。", "solution": "该问题要求计算在内外两层均使用 Steane [[7,1,3]] 码的双层级联码的领头阶逻辑错误率 $p_{log}^{(2)}$。纠错是递归执行的。\n\n**第一步：分析第一层纠错。**\n\n第一层编码由七个独立的块组成，每个块都是一个 Steane [[7,1,3]] 码。物理量子比特受到错误概率为 $p$ 的退极化信道的影响。\n\n题目给出了单个 Steane 码块的逻辑错误概率的简化公式，我们将其表示为 $p_{log}^{(1)}$。这是 7 量子比特块的纠错程序失败的概率。\n$$p_{log}^{(1)} = \\binom{7}{2} p^2$$\n\n我们来计算二项式系数：\n$$\\binom{7}{2} = \\frac{7!}{2!(7-2)!} = \\frac{7 \\times 6}{2 \\times 1} = 21$$\n\n因此，第一层的逻辑错误率为：\n$$p_{log}^{(1)} = 21 p^2$$\n这个表达式在 $p$ 的领头阶上是有效的，因为对于很小的 $p$ 来说，$p^3$、$p^4$ 等高阶项要小得多。\n\n**第二步：分析第二层纠错。**\n\n第二层编码将来自第一层的七个逻辑量子比特视为其物理量子比特。这一层的纠错程序旨在纠正这七个“量子比特”上的错误。\n\n第二层编码的七个输入中每一个的有效错误率是第一层的逻辑错误率 $p_{log}^{(1)}$。我们将这个有效错误概率定义为 $p_{eff}$。\n$$p_{eff} = p_{log}^{(1)} = 21 p^2$$\n\n第二层编码也是一个 Steane [[7,1,3]] 码。它可以纠正其七个输入量子比特上的一个错误。如果第二层纠错失败，就会发生总逻辑错误 $p_{log}^{(2)}$。当它的两个或更多输入量子比特（来自第一层的逻辑量子比特）出错时，就会发生这种情况。\n\n我们可以使用与第一层相同的公式来计算第二层的失败概率，但我们必须用有效错误率 $p_{eff}$ 替换物理错误率 $p$。\n$$p_{log}^{(2)} \\approx \\binom{7}{2} (p_{eff})^2$$\n\n**第三步：结合结果得到最终表达式。**\n\n现在我们将 $p_{eff}$ 的表达式代入 $p_{log}^{(2)}$ 的方程中。\n$$p_{log}^{(2)} \\approx 21 \\left( p_{eff} \\right)^2$$\n$$p_{log}^{(2)} \\approx 21 \\left( 21 p^2 \\right)^2$$\n\n现在，我们简化表达式：\n$$p_{log}^{(2)} \\approx 21 \\times (21^2) \\times (p^2)^2$$\n$$p_{log}^{(2)} \\approx 21^3 p^4$$\n\n最后，我们计算数值系数：\n$$21^3 = (20+1)^3 = 20^3 + 3 \\cdot 20^2 \\cdot 1 + 3 \\cdot 20 \\cdot 1^2 + 1^3 = 8000 + 3 \\cdot 400 + 60 + 1 = 8000 + 1200 + 60 + 1 = 9261$$\n或者，$21^2 = 441$，并且 $441 \\times 21 = 441 \\times (20+1) = 8820 + 441 = 9261$。\n\n因此，总逻辑错误概率的领头阶表达式为：\n$$p_{log}^{(2)} = 9261 p^4$$\n这表明级联显著地抑制了错误。如果 $p$ 很小，$p^4$ 远小于与 $p^2$ 成正比的第一层错误率。", "answer": "$$ \\boxed{9261 p^4} $$", "id": "133434"}]}