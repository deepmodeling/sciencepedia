{"hands_on_practices": [{"introduction": "要理解纠缠蒸馏的核心机制，最好的方法莫过于亲手计算一个具体协议的完整流程。这个练习将带你逐步分析经典的BBPSSW协议如何处理一种常见的噪声模型——比特翻转错误。通过追踪初始量子态在双边CNOT门和后选择测量下的演化，你将亲眼见证该协议是如何筛选掉某些错误组合，从而在成功的情况下保留一个保真度更高的纠缠对([@problem_id:76649])。", "problem": "考虑一个基于 BBPSSW 协议的纠缠蒸馏方案。两方，Alice 和 Bob，共享两对量子比特，记为 (A1, B1) 和 (A2, B2)。每一对量子比特都由一个相同的源独立制备。源的目标是产生贝尔态 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$，但存在噪声。噪声的影响是在其中一个量子比特上施加一个比特翻转操作，将 $|\\Phi^+\\rangle$ 变换为 $|\\Psi^+\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle + |10\\rangle)$。这个错误以概率 $p$ 发生。因此，每一对的状态由以下密度矩阵描述：\n$$\n\\rho_{\\text{pair}} = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+| + p|\\Psi^+\\rangle\\langle\\Psi^+|\n$$\n\n然后将 BBPSSW 蒸馏协议应用于这两对量子比特：\n1. Alice 对她的量子比特施加一个 CNOT 门，其中 A1 是控制量子比特，A2 是目标量子比特 ($C_{A1,A2}$)。\n2. Bob 对他的量子比特施加一个 CNOT 门，其中 B1 是控制量子比特，B2 是目标量子比特 ($C_{B1,B2}$)。\n3. Alice 和 Bob 都在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下测量他们的第二个量子比特（分别为 A2 和 B2）。\n4. 如果他们的测量结果相同（即，都测量到 0，或者都测量到 1），则协议被宣布为成功。如果成功，他们保留第一对量子比特 (A1, B1)。否则，该量子比特对被丢弃。\n\n你的任务是计算在协议成功的条件下，量子比特对 (A1, B1) 的最终状态相对于理想态 $|\\Phi^+\\rangle$ 的保真度。将你的答案表示为错误概率 $p$ 的函数。", "solution": "将两对量子比特标记为 1 和 2。整个四量子比特系统 (A1, A2, B1, B2) 的初始状态由各对状态的张量积给出：\n$$\n\\rho_{in} = \\rho_{\\text{pair}}^{(1)} \\otimes \\rho_{\\text{pair}}^{(2)}\n$$\n其中 $\\rho_{\\text{pair}}^{(i)} = (1-p)|\\Phi^+_i\\rangle\\langle\\Phi^+_i| + p|\\Psi^+_i\\rangle\\langle\\Psi^+_i|$。展开此表达式得到四个项：\n$$\n\\begin{align*}\n\\rho_{in} = (1-p)^2 |\\Phi^+_1\\rangle\\langle\\Phi^+_1| \\otimes |\\Phi^+_2\\rangle\\langle\\Phi^+_2| \\\\\n+ p(1-p) |\\Phi^+_1\\rangle\\langle\\Phi^+_1| \\otimes |\\Psi^+_2\\rangle\\langle\\Psi^+_2| \\\\\n+ p(1-p) |\\Psi^+_1\\rangle\\langle\\Psi^+_1| \\otimes |\\Phi^+_2\\rangle\\langle\\Phi^+_2| \\\\\n+ p^2 |\\Psi^+_1\\rangle\\langle\\Psi^+_1| \\otimes |\\Psi^+_2\\rangle\\langle\\Psi^+_2|\n\\end{align*}\n$$\n\nBBPSSW 协议将酉算符 $U = C_{A1,A2} \\otimes C_{B1,B2}$ 应用于状态 $\\rho_{in}$。我们需要计算 $U$ 对展开式中四个纯态的作用。我们来分析一个泛型乘积态 $|ij\\rangle_{A1B1} \\otimes |kl\\rangle_{A2B2}$ 的变换。为了应用 CNOT 门，我们将量子比特重新排序为 $(A1, A2, B1, B2)$: $|ikjl\\rangle_{A1A2B1B2}$。该操作将其变换为 $|i, k\\oplus i\\rangle_{A1A2} |j, l\\oplus j\\rangle_{B1B2}$。\n\n让我们计算 $\\rho_{in}$ 的四个分量中每一个的变换。\n\n**情况 1：初始态 $|\\Phi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle$**\n经过CNOT操作后，状态变为 $|\\Phi^+\\rangle_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2}$。\n\n**情况 2：初始态 $|\\Phi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle$**\n经过CNOT操作后，状态变为 $|\\Phi^+\\rangle_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}$。\n\n**情况 3：初始态 $|\\Psi^+_1\\rangle \\otimes |\\Phi^+_2\\rangle$**\n经过CNOT操作后，状态变为 $|\\Psi^+\\rangle_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}$。\n\n**情况 4：初始态 $|\\Psi^+_1\\rangle \\otimes |\\Psi^+_2\\rangle$**\n经过CNOT操作后，状态变为 $|\\Psi^+\\rangle_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2}$。\n\n经过 CNOT 操作后的状态 $\\rho_{mid} = U\\rho_{in}U^\\dagger$ 为：\n$$\n\\begin{align*}\n\\rho_{mid} = (1-p)^2 |\\Phi^+\\rangle_{A1B1}\\langle\\Phi^+|_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2}\\langle\\Phi^+|_{A2B2} \\\\\n+ p(1-p) |\\Phi^+\\rangle_{A1B1}\\langle\\Phi^+|_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}\\langle\\Psi^+|_{A2B2} \\\\\n+ p(1-p) |\\Psi^+\\rangle_{A1B1}\\langle\\Psi^+|_{A1B1} \\otimes |\\Psi^+\\rangle_{A2B2}\\langle\\Psi^+|_{A2B2} \\\\\n+ p^2 |\\Psi^+\\rangle_{A1B1}\\langle\\Psi^+|_{A1B1} \\otimes |\\Phi^+\\rangle_{A2B2}\\langle\\Phi^+|_{A2B2}\n\\end{align*}\n$$\n\n接下来，测量量子比特 A2 和 B2。如果测量结果相同，即结果为 00 或 11，则协议成功。成功的测量投影算符是 $M_{succ} = |00\\rangle\\langle00|_{A2B2} + |11\\rangle\\langle11|_{A2B2}$。\n对于状态 $|\\psi\\rangle_{A1B1} \\otimes |\\phi\\rangle_{A2B2}$，其成功概率为 $\\mathrm{Tr}(M_{succ}|\\phi\\rangle\\langle\\phi|) = \\langle\\phi|M_{succ}|\\phi\\rangle$。\n对于 $|\\phi\\rangle = |\\Phi^+\\rangle_{A2B2} = \\frac{1}{\\sqrt{2}}(|00\\rangle+|11\\rangle)$，成功概率为 $|\\langle00|\\Phi^+\\rangle|^2 + |\\langle11|\\Phi^+\\rangle|^2 = (1/\\sqrt{2})^2 + (1/\\sqrt{2})^2 = 1$。\n对于 $|\\phi\\rangle = |\\Psi^+\\rangle_{A2B2} = \\frac{1}{\\sqrt{2}}(|01\\rangle+|10\\rangle)$，成功概率为 $|\\langle00|\\Psi^+\\rangle|^2 + |\\langle11|\\Psi^+\\rangle|^2 = 0+0=0$。\n\n所以，只有当量子比特对 (A2,B2) 的状态是 $|\\Phi^+\\rangle$ 时，协议才会成功。这种情况发生在情况 1 和情况 4。\n- 来自情况 1 的成功：概率为 $(1-p)^2 \\times 1 = (1-p)^2$。在 (A1,B1) 上剩余的状态是 $|\\Phi^+\\rangle_{A1B1}$。\n- 来自情况 4 的成功：概率为 $p^2 \\times 1 = p^2$。在 (A1,B1) 上剩余的状态是 $|\\Psi^+\\rangle_{A1B1}$。\n情况 2 和情况 3 以概率 1 失败。\n\n总成功概率为 $P_{succ} = (1-p)^2 + p^2$。\n在成功条件下，量子比特对 (A1,B1) 的未归一化最终状态是成功结果按其概率加权的和：\n$$\n\\rho'_{final} = (1-p)^2 |\\Phi^+\\rangle\\langle\\Phi^+| + p^2 |\\Psi^+\\rangle\\langle\\Psi^+|\n$$\n归一化的最终状态为 $\\rho_{final} = \\frac{1}{P_{succ}}\\rho'_{final}$：\n$$\n\\rho_{final} = \\frac{(1-p)^2 |\\Phi^+\\rangle\\langle\\Phi^+| + p^2 |\\Psi^+\\rangle\\langle\\Psi^+|}{(1-p)^2 + p^2}\n$$\n此状态相对于 $|\\Phi^+\\rangle$ 的保真度为 $F = \\langle\\Phi^+|\\rho_{final}|\\Phi^+\\rangle$。\n$$\nF = \\frac{(1-p)^2 \\langle\\Phi^+|\\Phi^+\\rangle\\langle\\Phi^+|\\Phi^+\\rangle + p^2 \\langle\\Phi^+|\\Psi^+\\rangle\\langle\\Psi^+|\\Phi^+\\rangle}{(1-p)^2 + p^2}\n$$\n由于 $\\langle\\Phi^+|\\Phi^+\\rangle = 1$ 且 $\\langle\\Phi^+|\\Psi^+\\rangle = 0$（因为这两个态是正交的），上式可简化为：\n$$\nF = \\frac{(1-p)^2}{(1-p)^2 + p^2} = \\frac{1-2p+p^2}{1-2p+p^2+p^2} = \\frac{1-2p+p^2}{1-2p+2p^2}\n$$", "answer": "$$ \\boxed{\\frac{(1-p)^2}{(1-p)^2 + p^2}} $$", "id": "76649"}, {"introduction": "纠缠蒸馏协议并非总能提升纠缠度，其性能依赖于初始态的质量。本练习将探讨这一关键点，你将通过分析著名的BBPSSW协议对沃纳态（Werner states）的作用，推导出一个保真度阈值。这个计算揭示了纠缠蒸馏的适用范围，并帮助你理解为何只有“足够纠缠”的量子态才能被进一步提纯([@problem_id:76725])。", "problem": "量子通信中的一项基本任务是纠缠蒸馏，即把若干个具有低纠缠保真度的共享量子态转换为数量更少但保真度更高的量子态。BBPSSW 协议是实现此任务最早、最著名的协议之一。\n\n考虑由 Alice 和 Bob 共享的两个相同的双量子比特 Werner 态 $\\rho_W(F)$ 的副本。该态定义为\n$$\n\\rho_W(F) = F |\\psi^-\\rangle\\langle \\psi^-| + \\frac{1-F}{3} (I - |\\psi^-\\rangle\\langle \\psi^-|)\n$$\n其中 $|\\psi^-\\rangle = \\frac{1}{\\sqrt{2}}(|01\\rangle - |10\\rangle)$ 是一个最大纠缠贝尔态，$I$ 是 $4 \\times 4$ 单位矩阵，$F$ 是该态相对于 $|\\psi^-\\rangle$ 的保真度，即 $F = \\langle\\psi^-|\\rho_W(F)|\\psi^-\\rangle$。参数 $F$ 的取值范围为 $0$ 到 $1$。\n\nBBPSSW 协议的步骤如下：\n1.  Alice 和 Bob 拥有两对量子比特，AB 和 CD，初始处于态 $\\rho_{in} = \\rho_W(F)_{AB} \\otimes \\rho_W(F)_{CD}$。\n2.  Alice 对她的第一个量子比特 (A) 作为控制位、第二个量子比特 (C) 作为目标位应用一个 CNOT 门。同时，Bob 对他的第一个量子比特 (B) 作为控制位、第二个量子比特 (D) 作为目标位应用一个 CNOT 门。\n3.  Alice 和 Bob 各自在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 中测量他们的第二个量子比特（分别为 C 和 D）。\n4.  他们交流各自的测量结果。如果结果相同（都为 0 或都为 1），他们保留第一对量子比特 (AB)。否则，他们丢弃它。\n\n成功保留下来的量子比特对的状态是一个新态 $\\rho'$，其新保真度为 $F' = \\langle\\psi^-|\\rho'|\\psi^-\\rangle$。如果协议没有提高保真度，即 $F' \\le F$，则认为协议失败。可以证明，对于一个连续的初始保真度范围 $F \\in [F_1, F_2]$，该协议会失败。\n\n您的任务是确定这个失败区域的下界 $F_1$。", "solution": "1. 对于两个保真度为 $F$ 的相同 Werner 态，BBPSSW 更新产生的新保真度为\n$$\nF' = \\frac{F^2 + \\frac{1}{9}(1-F)^2}{F^2 + \\frac{2}{3}F(1-F) + \\frac{5}{9}(1-F)^2}\n$$\n\n2. 不动点满足 $F'=F$，即\n$$\n\\frac{F^2 + \\frac{1}{9}(1-F)^2}{F^2 + \\frac{2}{3}F(1-F) + \\frac{5}{9}(1-F)^2} = F\n$$\n\n3. 两边同乘以分母：\n$$\nF^2 + \\frac{1}{9}(1-F)^2 = F\\left[F^2 + \\frac{2}{3}F(1-F) + \\frac{5}{9}(1-F)^2\\right]\n$$\n\n4. 展开并化简：\n左边：\n$$\nF^2 + \\frac{1}{9}(1-2F+F^2) = \\frac{10}{9}F^2 - \\frac{2}{9}F + \\frac{1}{9}\n$$\n右边：\n$$\n\\begin{aligned}\n F^3 + \\frac{2}{3}F^2(1-F) + \\frac{5}{9}F(1-2F+F^2) \\\\\n= F^3 - \\frac{2}{3}F^3 + \\frac{2}{3}F^2 + \\frac{5}{9}F - \\frac{10}{9}F^2 + \\frac{5}{9}F^3 \\\\\n= \\frac{8}{9}F^3 - \\frac{4}{9}F^2 + \\frac{5}{9}F\n\\end{aligned}\n$$\n\n5. 令等式两边相等，并同乘以 $9$：\n$$\n10F^2 -2F +1 = 8F^3 -4F^2 +5F \\implies 8F^3 -14F^2 +7F -1=0\n$$\n\n6. 提出因子 $(F-1)$：\n$$\n8F^3 -14F^2 +7F -1 = (F-1)(8F^2 -6F +1) = 0\n$$\n二次方程的根为\n$$\nF=\\frac{6\\pm\\sqrt{36-32}}{16}=\\frac{6\\pm2}{16} \\implies F=\\frac{1}{4},\\;\\frac{1}{2},\\;1\n$$\n\n7. 失败区域（其中 $F'\\le F$）的下界是最小的非平凡不动点，\n$$\nF_1=\\frac{1}{4}\n$$", "answer": "$$\\boxed{\\frac{1}{4}}$$", "id": "76725"}, {"introduction": "除了基于CNOT门和奇偶校验的协议，纠缠蒸馏还可以借鉴量子纠错码的思想。本练习介绍了一种基于三比特码的提纯方案，用于对抗相位翻转噪声。你将看到，通过在多个副本上测量稳定子（stabilizer）并比较测量结果（即错误诊断子），我们不仅能检测错误，还能识别出特定的无错误配置，从而实现提纯。这个练习将为你揭示纠缠提纯与量子纠错之间深刻的内在联系([@problem_id:76666])。", "problem": "两方（Alice和Bob）共享三个以相同方式制备的、含噪声的纠缠量子比特对。每个量子比特对的理想状态是贝尔态 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。然而，每个量子比特对都独立地受到一个作用于Bob的量子比特上的相位翻转信道的影响。该信道由映射 $\\mathcal{E}(\\rho) = (1-p)\\rho + p(\\sigma_z \\rho \\sigma_z)$ 描述，其中 $\\sigma_z$ 是泡利Z算符，$p$ 是发生相位翻转的概率。每个量子比特对的最终状态记为 $\\rho_{in}$。\n\n为了提高纠缠质量，Alice和Bob同意执行一轮基于三量子比特相位翻转码的纠缠纯化协议。设这三个量子比特对分别标记为1、2和3。Alice持有量子比特 $A_1, A_2, A_3$，Bob持有量子比特 $B_1, B_2, B_3$。协议如下：\n\n1.  Alice在她的三个量子比特上本地测量三量子比特相位翻转码的两个稳定子算符：$S_1^A = X_{A1} \\otimes X_{A2}$ 和 $S_2^A = X_{A2} \\otimes X_{A3}$，其中 $X$ 是泡利X算符。她记录下自己的测量结果 $(s_1^A, s_2^A) \\in \\{(+1, +1), (+1, -1), (-1, +1), (-1, -1)\\}$。\n2.  同时，Bob在他的三个量子比特上本地测量相应的算符：$S_1^B = X_{B1} \\otimes X_{B2}$ 和 $S_2^B = X_{B2} \\otimes X_{B3}$。他记录下自己的测量结果 $(s_1^B, s_2^B)$。\n3.  Alice和Bob通过一个经典信道交换他们的测量结果。如果他们的综合征匹配，即 $(s_1^A, s_2^A) = (s_1^B, s_2^B)$，则协议被视为成功。\n4.  如果协议成功，他们保留第一个量子比特对 $(A_1, B_1)$ 并丢弃第2和第3对。这个保留下来的量子比特对的状态即为纯化后的状态 $\\rho_{out}$。\n5.  如果协议失败（综合征不匹配），他们丢弃所有三个量子比特对。\n\n假设协议成功，计算第一个量子比特对的最终状态相对于理想贝尔态 $|\\Phi^+\\rangle$ 的保真度 $F_{out} = \\langle\\Phi^+| \\rho_{out} | \\Phi^+\\rangle$。将你的答案表示为相位翻转概率 $p$ 的函数。", "solution": "**1. 初始状态分析**\n\n理想状态是 $|\\Phi^+\\rangle = \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle)$。概率为 $p$ 的相位翻转信道作用于第二个量子比特（Bob一方）。\n经过信道后的状态是 $\\rho_{in} = \\mathcal{E}(|\\Phi^+\\rangle\\langle\\Phi^+|) = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+| + p (I \\otimes \\sigma_z) |\\Phi^+\\rangle\\langle\\Phi^+| (I \\otimes \\sigma_z)^\\dagger$。\n我们来计算误差算符对理想状态的作用：\n$(I \\otimes \\sigma_z) |\\Phi^+\\rangle = (I \\otimes \\sigma_z) \\frac{1}{\\sqrt{2}}(|00\\rangle + |11\\rangle) = \\frac{1}{\\sqrt{2}}(|00\\rangle - |11\\rangle) = |\\Phi^-\\rangle$。\n因此，三个量子比特对中每一个的初始状态都是一个混合态：\n$\\rho_{in} = (1-p)|\\Phi^+\\rangle\\langle\\Phi^+| + p|\\Phi^-\\rangle\\langle\\Phi^-\\|$.\n我们将初始保真度记为 $F_{in} = \\langle \\Phi^+ | \\rho_{in} | \\Phi^+ \\rangle = 1-p$。\n这三个量子比特对的总状态是 $\\rho_{tot} = \\rho_{in} \\otimes \\rho_{in} \\otimes \\rho_{in}$。这可以看作是 $2^3 = 8$ 个形式为 $|\\Phi_{i_1}\\rangle \\otimes |\\Phi_{i_2}\\rangle \\otimes |\\Phi_{i_3}\\rangle$ 的纯态的经典混合，其中 $i_k \\in \\{0, 1\\}$，且 $|\\Phi_0\\rangle = |\\Phi^+\\rangle$，$|\\Phi_1\\rangle = |\\Phi^-\\rangle$。一个包含 $k$ 个 $|\\Phi^-\\rangle$ 实例（即 $k$ 个相位误差）的状态的概率为 $p^k (1-p)^{3-k}$。\n\n**2. 协议分析**\n\n协议的成功条件是Alice和Bob的测量结果匹配，即 $(s_1^A, s_2^A) = (s_1^B, s_2^B)$。为了分析这一点，我们考虑一个特定的初始纯态，它由 $k$ 个 $|\\Phi^-\\rangle$ 和 $3-k$ 个 $|\\Phi^+\\rangle$ 组成，记为 $|\\Psi_{config}\\rangle$。\n\nAlice测量 $S_1^A = X_{A1} \\otimes X_{A2}$，Bob测量 $S_1^B = X_{B1} \\otimes X_{B2}$。尽管对单个纯态 $|\\Psi_{config}\\rangle$ 来说，Alice和Bob各自的测量结果 $s_1^A$ 和 $s_1^B$ 可能是随机的，但它们的乘积 $s_1^A s_1^B$ 是确定的。这是因为整个系统 $|\\Psi_{config}\\rangle$ 是联合算符 $(S_1^A \\otimes S_1^B)$ 的本征态。\n\n让我们利用以下关键关系：\n$$ (X_A \\otimes X_B) |\\Phi^+\\rangle = |\\Phi^+\\rangle $$\n$$ (X_A \\otimes X_B) |\\Phi^-\\rangle = -|\\Phi^-\\rangle $$\n这意味着 $|\\Phi^+\\rangle$ 是联合算符 $X_A \\otimes X_B$ 的+1本征态，而 $|\\Phi^-\\rangle$ 是其-1本征态。\n\n考虑联合算符 $S_1^A \\otimes S_1^B = (X_{A1} \\otimes X_{A2}) \\otimes (X_{B1} \\otimes X_{B2}) = (X_{A1} \\otimes X_{B1}) \\otimes (X_{A2} \\otimes X_{B2})$。\n当该算符作用于状态 $|\\Phi_{i_1}\\rangle_1 \\otimes |\\Phi_{i_2}\\rangle_2$ 时（其中 $i_k=0$ 代表 $|\\Phi^+\\rangle$，$i_k=1$ 代表 $|\\Phi^-\\rangle$），其本征值为 $(-1)^{i_1} \\times (-1)^{i_2} = (-1)^{i_1+i_2}$。\n由于系统的测量结果的乘积必须等于该本征值，我们有 $s_1^A s_1^B = (-1)^{i_1+i_2}$。\n同理，对于稳定子 $S_2$，我们有 $s_2^A s_2^B = (-1)^{i_2+i_3}$。\n\n协议的成功条件 $s_1^A = s_1^B$ 和 $s_2^A = s_2^B$ 等价于 $s_1^A s_1^B = +1$ 和 $s_2^A s_2^B = +1$。\n这给我们带来了以下成功条件：\n1. $(-1)^{i_1+i_2} = +1 \\implies i_1+i_2$ 必须是偶数。\n2. $(-1)^{i_2+i_3} = +1 \\implies i_2+i_3$ 必须是偶数。\n\n这些条件意味着 $i_1, i_2, i_3$ 必须具有相同的奇偶性。只有两种可能性：\n*   **无误差：** $(i_1, i_2, i_3) = (0,0,0)$。此配置发生的概率为 $(1-p)^3$。它满足条件，协议成功。保留的第一对处于状态 $|\\Phi^+\\rangle$。\n*   **三误差：** $(i_1, i_2, i_3) = (1,1,1)$。此配置发生的概率为 $p^3$。它满足条件，协议成功。保留的第一对处于状态 $|\\Phi^-\\rangle$。\n\n任何包含一个或两个误差的配置（例如 $(1,0,0)$ 或 $(1,1,0)$）都会导致 $i_k$ 具有不同的奇偶性，从而违反成功条件并被协议丢弃。\n\n因此，该协议有效地筛选出了无误差和三误差的事件。\n\n**3. 最终保真度计算**\n\n成功的运行会得到一个最终状态，该状态是成功情况下的结果的混合，并按各自的概率加权。\n设 $P_0$ 为无误差情况的概率，$P_0 = (1-p)^3$。第1对的所得状态为 $|\\Phi^+\\rangle$。\n设 $P_3$ 为三误差情况的概率，$P_3 = p^3$。第1对的所得状态为 $|\\Phi^-\\rangle$。\n总的成功概率是 $P_{succ} = P_0 + P_3 = (1-p)^3 + p^3$。\n\n后选择状态 $\\rho_{out}$ 是成功结果的归一化混合：\n$$ \\rho_{out} = \\frac{1}{P_{succ}} \\left( P_0 |\\Phi^+\\rangle\\langle\\Phi^+| + P_3 |\\Phi^-\\rangle\\langle\\Phi^-| \\right) $$\n$$ \\rho_{out} = \\frac{(1-p)^3}{(1-p)^3 + p^3} |\\Phi^+\\rangle\\langle\\Phi^+| + \\frac{p^3}{(1-p)^3 + p^3} |\\Phi^-\\rangle\\langle\\Phi^-| $$\n\n最终保真度 $F_{out}$ 是 $\\rho_{out}$ 与理想状态 $|\\Phi^+\\rangle$ 的重叠：\n$$ F_{out} = \\langle\\Phi^+| \\rho_{out} | \\Phi^+\\rangle $$\n因为 $\\langle\\Phi^+|\\Phi^+\\rangle = 1$ 且 $\\langle\\Phi^+|\\Phi^-\\rangle = 0$，我们有：\n$$ F_{out} = \\frac{(1-p)^3}{(1-p)^3 + p^3} \\langle\\Phi^+|\\Phi^+\\rangle\\langle\\Phi^+|\\Phi^+\\rangle + \\frac{p^3}{(1-p)^3 + p^3} \\langle\\Phi^+|\\Phi^-\\rangle\\langle\\Phi^-|\\Phi^+\\rangle $$\n$$ F_{out} = \\frac{(1-p)^3}{(1-p)^3 + p^3} $$\n\n可以展开此式进行简化，但非必要。分母：$(1-p)^3+p^3 = (1-3p+3p^2-p^3) + p^3 = 1-3p+3p^2$。\n所以，$F_{out} = \\frac{(1-p)^3}{1-3p+3p^2}$。", "answer": "$$ \\boxed{\\frac{(1-p)^3}{(1-p)^3 + p^3}} $$", "id": "76666"}]}