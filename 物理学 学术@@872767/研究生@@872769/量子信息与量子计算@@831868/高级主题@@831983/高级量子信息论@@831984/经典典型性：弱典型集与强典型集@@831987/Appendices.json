{"hands_on_practices": [{"introduction": "典型性的概念是信息论的基石，尤其是在数据压缩和信道编码的推导中。这个练习将带我们从最基本的定义——弱典型集——开始。通过为一个具体的有偏二元信源计算弱典型集的大小，我们可以将渐近均分割特性 (AEP) 的抽象概念与一个可计算的实例联系起来，从而为理解更复杂的思想打下坚实的基础。[@problem_id:56674]", "problem": "一个独立同分布 (i.i.d.) 的离散无记忆信源由一个定义在有限字母表 $\\mathcal{X}$ 上的随机变量 $X$ 来表征，其概率质量函数为 $p(x) = \\text{Pr}(X=x)$。该信源发出的一个长度为 $n$ 的符号序列记为 $x^n = (x_1, x_2, \\ldots, x_n)$，其概率由 $p(x^n) = \\prod_{i=1}^n p(x_i)$ 给出。\n\n该信源的香农熵（使用以 2 为底的对数）定义为：\n$$ H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x) $$\n\n对于给定的序列长度 $n$ 和容差参数 $\\epsilon > 0$，*弱典型集* $A_\\epsilon^{(n)}$ 是所有其样本熵接近信源真实熵的序列 $x^n$ 的集合。形式上，它定义为：\n$$ A_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\} $$\n\n考虑一个二进制无记忆信源，其字母表为 $\\mathcal{X} = \\{0, 1\\}$，概率为 $p(1) = p$ 和 $p(0) = 1-p$。\n对于该信源的一个具体实例，其中概率 $p=1/3$，序列长度 $n=9$，容差 $\\epsilon=1/6$，计算弱典型集中的序列总数，即求集合 $|A_\\epsilon^{(n)}|$ 的大小。", "solution": "弱典型集 $A_\\epsilon^{(n)}$ 定义为：\n$$ A_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\} $$\n对于一个二进制信源，其中 $p(1) = p = \\frac{1}{3}$ 且 $p(0) = 1 - p = \\frac{2}{3}$，一个包含 $k$ 个 1 和 $n - k$ 个 0 的序列 $x^n$ 的概率为：\n$$ p(x^n) = p^k (1 - p)^{n - k} = \\left(\\frac{1}{3}\\right)^k \\left(\\frac{2}{3}\\right)^{n - k} $$\n因此，其对数概率为：\n$$ \\log_2 p(x^n) = k \\log_2 \\left(\\frac{1}{3}\\right) + (n - k) \\log_2 \\left(\\frac{2}{3}\\right) = -k \\log_2 3 + (n - k) (1 - \\log_2 3) $$\n化简得：\n$$ \\log_2 p(x^n) = -k \\log_2 3 + n - n \\log_2 3 - k + k \\log_2 3 = n(1 - \\log_2 3) - k $$\n所以，样本熵为：\n$$ -\\frac{1}{n} \\log_2 p(x^n) = -\\frac{1}{n} [n(1 - \\log_2 3) - k] = \\log_2 3 - 1 + \\frac{k}{n} $$\n信源的熵 $H(X)$ 为：\n$$ H(X) = -p \\log_2 p - (1 - p) \\log_2 (1 - p) = -\\frac{1}{3} \\log_2 \\frac{1}{3} - \\frac{2}{3} \\log_2 \\frac{2}{3} = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} \\log_2 \\frac{3}{2} $$\n$$ H(X) = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} (\\log_2 3 - \\log_2 2) = \\frac{1}{3} \\log_2 3 + \\frac{2}{3} \\log_2 3 - \\frac{2}{3} = \\log_2 3 - \\frac{2}{3} $$\n典型性条件变为：\n$$ \\left| \\left( \\log_2 3 - 1 + \\frac{k}{n} \\right) - \\left( \\log_2 3 - \\frac{2}{3} \\right) \\right| \\le \\epsilon $$\n化简绝对值内的表达式：\n$$ \\log_2 3 - 1 + \\frac{k}{n} - \\log_2 3 + \\frac{2}{3} = \\frac{k}{n} - \\frac{1}{3} $$\n因此：\n$$ \\left| \\frac{k}{n} - \\frac{1}{3} \\right| \\le \\epsilon $$\n当 $n = 9$ 且 $\\epsilon = \\frac{1}{6}$ 时：\n$$ \\left| \\frac{k}{9} - \\frac{1}{3} \\right| \\le \\frac{1}{6} $$\n求解 $k$：\n$$ -\\frac{1}{6} \\le \\frac{k}{9} - \\frac{1}{3} \\le \\frac{1}{6} $$\n$$ \\frac{1}{3} - \\frac{1}{6} \\le \\frac{k}{9} \\le \\frac{1}{3} + \\frac{1}{6} $$\n$$ \\frac{1}{6} \\le \\frac{k}{9} \\le \\frac{1}{2} $$\n$$ \\frac{9}{6} \\le k \\le \\frac{9}{2} \\implies 1.5 \\le k \\le 4.5 $$\n因为 $k$ 必须是整数，所以 $k \\in \\{2, 3, 4\\}$。\n\n$A_\\epsilon^{(n)}$ 的大小是包含 $k$ 个 1 的序列的数量，即二项式系数的和：\n$$ |A_\\epsilon^{(n)}| = \\sum_{k=2}^{4} \\binom{9}{k} $$\n计算：\n$$ \\binom{9}{2} = \\frac{9 \\times 8}{2} = 36 $$\n$$ \\binom{9}{3} = \\frac{9 \\times 8 \\times 7}{3 \\times 2 \\times 1} = 84 $$\n$$ \\binom{9}{4} = \\frac{9 \\times 8 \\times 7 \\times 6}{4 \\times 3 \\times 2 \\times 1} = 126 $$\n$$ |A_\\epsilon^{(n)}| = 36 + 84 + 126 = 246 $$", "answer": "$$ \\boxed{246} $$", "id": "56674"}, {"introduction": "在掌握了弱典型集之后，区分它与强典型集的概念至关重要，因为后者在许多证明中提供了更强的约束。弱典型性仅关注序列的整体概率，而强典型性则对序列中每个符号的经验频率都施加了限制。通过这个练习，我们将直接识别出那些满足弱典型条件但不满足强典型条件的序列，这种对比分析能够极大地加深我们对这两种典型性定义之间细微而重要差异的理解。[@problem_id:56805]", "problem": "考虑一个信息源，它产生一个符号序列 $x_1, x_2, \\ldots, x_n$，这些符号是根据有限字母表 $\\mathcal{X}$ 上的概率质量函数 $p(x)$ 进行独立同分布 (i.i.d.) 的。\n\n**弱典型集** $A_\\epsilon^{(n)}$（相对于容差 $\\epsilon > 0$）是所有样本熵接近信源香农熵 $H(X)$ 的序列 $x^n = (x_1, \\ldots, x_n)$ 的集合：\n$$A_\\epsilon^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| -\\frac{1}{n} \\log_2 p(x^n) - H(X) \\right| \\le \\epsilon \\right\\}$$\n其中 $p(x^n) = \\prod_{i=1}^n p(x_i)$ 且 $H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x)$。\n\n**强典型集** $T_\\delta^{(n)}$（相对于容差 $\\delta > 0$）是所有序列 $x^n$ 的集合，其中每个符号的经验频率都接近其真实概率。令 $N(x|x^n)$ 为符号 $x$ 在序列 $x^n$ 中出现的次数。那么：\n$$T_\\delta^{(n)} = \\left\\{ x^n \\in \\mathcal{X}^n : \\left| \\frac{N(x|x^n)}{n} - p(x) \\right| \\le \\delta \\text{ for all } x \\in \\mathcal{X}, \\text{ and } N(x|x^n)=0 \\text{ if } p(x)=0 \\right\\}$$\n\n现在，考虑一个特定的三元信源，其字母表为 $\\mathcal{X} = \\{0, 1, 2\\}$，概率为 $p(0) = p_0$，$p(1) = p_1$ 和 $p(2) = p_2$。对于 $p_0=1/2$, $p_1=1/4$, $p_2=1/4$ 的特定情况，以及序列长度 $n=4$，容差 $\\epsilon = 3/10$ 和 $\\delta = 3/10$，计算所有弱典型但非强典型的序列的总概率。即，计算 $P(A_\\epsilon^{(n)} \\setminus T_\\delta^{(n)})$。", "solution": "问题涉及一个三元信源，其字母表为 $\\mathcal{X} = \\{0, 1, 2\\}$，概率为 $p(0) = \\frac{1}{2}$, $p(1) = \\frac{1}{4}$, $p(2) = \\frac{1}{4}$。序列长度为 $n = 4$，容差为 $\\epsilon = \\frac{3}{10}$ 和 $\\delta = \\frac{3}{10}$。目标是计算 $P(A_\\epsilon^{(4)} \\setminus T_\\delta^{(4)})$，即弱典型但非强典型的序列的概率。\n\n首先，计算香农熵 $H(X)$：\n$$ H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log_2 p(x) = -\\left[ \\frac{1}{2} \\log_2 \\frac{1}{2} + \\frac{1}{4} \\log_2 \\frac{1}{4} + \\frac{1}{4} \\log_2 \\frac{1}{4} \\right] $$\n$$ H(X) = -\\left[ \\frac{1}{2} (-1) + \\frac{1}{4} (-2) + \\frac{1}{4} (-2) \\right] = -\\left[ -\\frac{1}{2} - \\frac{1}{2} - \\frac{1}{2} \\right] = \\frac{3}{2} $$\n对于一个序列 $x^4 = (x_1, x_2, x_3, x_4)$，令 $n_0, n_1, n_2$ 分别是符号 $0, 1, 2$ 的计数，且 $n_0 + n_1 + n_2 = 4$。其概率为：\n$$ p(x^4) = \\left( \\frac{1}{2} \\right)^{n_0} \\left( \\frac{1}{4} \\right)^{n_1} \\left( \\frac{1}{4} \\right)^{n_2} $$\n样本熵为：\n$$ -\\frac{1}{4} \\log_2 p(x^4) = -\\frac{1}{4} \\left[ n_0 (-1) + (n_1 + n_2) (-2) \\right] = \\frac{1}{4} (n_0 + 2n_1 + 2n_2) $$\n代入 $n_1 + n_2 = 4 - n_0$：\n$$ -\\frac{1}{4} \\log_2 p(x^4) = \\frac{1}{4} (n_0 + 2(4 - n_0)) = \\frac{1}{4} (8 - n_0) = 2 - \\frac{n_0}{4} $$\n弱典型集的条件是：\n$$ \\left| \\left(2 - \\frac{n_0}{4}\\right) - \\frac{3}{2} \\right| \\leq \\frac{3}{10} \\implies \\left| \\frac{1}{2} - \\frac{n_0}{4} \\right| \\leq \\frac{3}{10} $$\n这可以简化为：\n$$ -\\frac{3}{10} \\leq \\frac{1}{2} - \\frac{n_0}{4} \\leq \\frac{3}{10} $$\n解不等式：\n$$ -\\frac{8}{10} \\leq -\\frac{n_0}{4} \\leq -\\frac{2}{10} \\implies \\frac{2}{10} \\leq \\frac{n_0}{4} \\leq \\frac{8}{10} $$\n两边乘以 4：\n$$ 0.8 \\leq n_0 \\leq 3.2 $$\n由于 $n_0$ 是一个整数，所以 $n_0 \\in \\{1, 2, 3\\}$。因此，弱典型序列的 $n_0$ 值为 $1, 2,$ 或 $3$。\n\n对于强典型集，经验频率必须对每个 $x$ 满足 $|\\frac{N(x|x^4)}{4} - p(x)| \\leq \\frac{3}{10}$：\n- 对于 $x=0$: $\\left| \\frac{n_0}{4} - \\frac{1}{2} \\right| \\leq \\frac{3}{10}$，得到 $0.8 \\leq n_0 \\leq 3.2$，所以 $n_0 \\in \\{1, 2, 3\\}$。\n- 对于 $x=1$: $\\left| \\frac{n_1}{4} - \\frac{1}{4} \\right| \\leq \\frac{3}{10} \\implies |n_1 - 1| \\leq 1.2 \\implies -0.2 \\leq n_1 \\leq 2.2$。由于 $n_1$ 是非负整数，所以 $n_1 \\in \\{0, 1, 2\\}$。\n- 对于 $x=2$: 类似地，$\\left| \\frac{n_2}{4} - \\frac{1}{4} \\right| \\leq \\frac{3}{10} \\implies n_2 \\in \\{0, 1, 2\\}$。\n\n此外， $n_0 + n_1 + n_2 = 4$。如果 $n_1 \\notin \\{0, 1, 2\\}$ 或 $n_2 \\notin \\{0, 1, 2\\}$，则序列不是强典型的。由于 $n_1, n_2 \\ge 0$，唯一的违规情况是 $n_1 > 2$ 或 $n_2 > 2$。根据这些约束：\n- 如果 $n_0 = 1$，那么 $n_1 + n_2 = 3$。可能的数组 $(n_1, n_2)$ 为：$(0,3), (1,2), (2,1), (3,0)$。违反强典型性条件的数组是 $(0,3)$ (因为 $n_2=3 > 2$) 和 $(3,0)$ (因为 $n_1=3 > 2$) 。\n- 如果 $n_0 = 2$，那么 $n_1 + n_2 = 2$。可能的数组为：$(0,2), (1,1), (2,0)$。所有数组都满足 $n_1 \\leq 2, n_2 \\leq 2$。\n- 如果 $n_0 = 3$，那么 $n_1 + n_2 = 1$。可能的数组为：$(0,1), (1,0)$。所有数组都满足 $n_1 \\leq 2, n_2 \\leq 2$。\n\n因此，只有 $n_0=1$ 且 $(n_1, n_2) = (0,3)$ 或 $(3,0)$ 的序列是弱典型但非强典型的。\n具有计数 $(n_0, n_1, n_2)$ 的序列的概率为 $p(x^4) = \\left( \\frac{1}{2} \\right)^{n_0} \\left( \\frac{1}{4} \\right)^{n_1} \\left( \\frac{1}{4} \\right)^{n_2}$。这类序列的数量是多项式系数 $\\binom{4}{n_0, n_1, n_2} = \\frac{4!}{n_0! n_1! n_2!}$。\n\n对于 $(n_0, n_1, n_2) = (1, 0, 3)$：\n$$ \\text{序列数} = \\frac{4!}{1! 0! 3!} = 4 $$\n$$ \\text{每个序列的概率} = \\left( \\frac{1}{2} \\right)^1 \\left( \\frac{1}{4} \\right)^0 \\left( \\frac{1}{4} \\right)^3 = \\frac{1}{2} \\cdot \\frac{1}{64} = \\frac{1}{128} $$\n$$ \\text{总概率} = 4 \\times \\frac{1}{128} = \\frac{4}{128} = \\frac{1}{32} $$\n对于 $(n_0, n_1, n_2) = (1, 3, 0)$：\n$$ \\text{序列数} = \\frac{4!}{1! 3! 0!} = 4 $$\n$$ \\text{每个序列的概率} = \\left( \\frac{1}{2} \\right)^1 \\left( \\frac{1}{4} \\right)^3 \\left( \\frac{1}{4} \\right)^0 = \\frac{1}{2} \\cdot \\frac{1}{64} = \\frac{1}{128} $$\n$$ \\text{总概率} = 4 \\times \\frac{1}{128} = \\frac{4}{128} = \\frac{1}{32} $$\n弱典型但非强典型的序列的总概率是它们的和：\n$$ \\frac{1}{32} + \\frac{1}{32} = \\frac{2}{32} = \\frac{1}{16} $$", "answer": "$$ \\boxed{\\dfrac{1}{16}} $$", "id": "56805"}, {"introduction": "典型集的概念不仅在理论上意义重大，在实际应用中也展现出强大的威力，例如在编码理论中。这个练习将典型性的统计约束与编码理论的代数结构（奇偶校验码）相结合。通过计算同时满足两种约束的序列集的渐近大小，我们将揭示一个深刻的结论：在长序列的极限下，一个简单的线性约束（如奇偶校验）虽然会将序列集的规模减半，但并不会改变其指数增长率，即熵。[@problem_id:56679]", "problem": "在经典信息论中，典型集的概念是基础。一种常见的典型集是**强典型集**。对于给定的参数 $p \\in (0,1)$ 和一个容差 $\\delta > 0$，长度为 $n$ 的强 $\\delta$-典型二进制序列集合，记作 $A_{n,p,\\delta}$，包含所有满足 '1' 的经验频率接近 $p$ 的序列 $x^n \\in \\{0,1\\}^n$。具体来说，如果 $w(x^n)$ 是序列 $x^n$ 的汉明权重（'1' 的数量），那么：\n$$A_{n,p,\\delta} = \\left\\{ x^n \\in \\{0,1\\}^n \\;\\middle|\\; \\left| \\frac{w(x^n)}{n} - p \\right| \\le \\delta \\right\\}$$\n另一个来自编码理论的重要概念是纠错码。最简单的这类码是**单奇偶校验（SPC）码**，记作 $C_n$。一个长度为 $n$ 的二进制序列如果在 $C_n$ 中是一个码字，则它包含偶数个 '1'。\n$$C_n = \\left\\{ x^n \\in \\{0,1\\}^n \\;\\middle|\\; w(x^n) \\text{ is even} \\right\\}$$\n一个序列集合族 $\\{S_n\\}_{n=1}^{\\infty}$ 的“熵”可以定义为集合大小对数的渐进速率：\n$$ H(S) = \\lim_{n\\to\\infty} \\frac{1}{n} \\log_2 |S_n| $$\n你的任务是确定同时满足强典型和单奇偶校验约束的序列集的熵。具体来说，你需要计算以下量，我们称之为 $H_{p, \\text{even}}$：\n$$ H_{p, \\text{even}} = \\lim_{\\delta \\to 0^+} \\left( \\lim_{n\\to\\infty} \\frac{1}{n} \\log_2 |A_{n,p,\\delta} \\cap C_n| \\right) $$\n请以参数 $p$ 的闭式解析表达式形式给出最终结果。", "solution": "1.  首先，根据定义，强典型集 $A_{n,p,\\delta}$ 的大小是汉明权重 $k$ 满足 $|\\frac{k}{n}-p| \\le \\delta$ 的序列的总数：\n    $$ |A_{n,p,\\delta}| = \\sum_{k=\\lceil n(p-\\delta) \\rceil}^{\\lfloor n(p+\\delta) \\rfloor} \\binom{n}{k} $$\n    根据类型方法和斯特林近似，对于固定的 $\\delta > 0$ 和足够大的 $n$，这个和主要由中心项 $k \\approx np$ 贡献。集合大小的渐近对数增长率是信源的熵 $H(p)$：\n    $$ \\frac{1}{n} \\log_2 |A_{n,p,\\delta}| \\xrightarrow{n\\to\\infty} H(p) $$\n    其中 $H(p) = -p\\log_2p - (1-p)\\log_2(1-p)$。这等价于 $|A_{n,p,\\delta}| \\doteq 2^{nH(p)}$，其中 $\\doteq$ 表示对数尺度上相等。\n\n2.  接下来，我们考虑单奇偶校验码 $C_n$ 的约束，它只选择汉明权重 $k$ 为偶数的序列。在强典型集的权重范围 $[n(p-\\delta), n(p+\\delta)]$ 内，对于足够大的 $n$，偶数和奇数权重的数量大致相等。因此，同时满足两个条件的序列数大约是强典型集大小的一半：\n    $$ |A_{n,p,\\delta} \\cap C_n| \\approx \\frac{1}{2} |A_{n,p,\\delta}| \\doteq \\frac{1}{2} 2^{nH(p)} $$\n\n3.  最后，我们计算这个交集的熵。对大小取对数并进行归一化：\n    $$ \\frac{1}{n} \\log_2 |A_{n,p,\\delta} \\cap C_n| \\approx \\frac{1}{n} \\log_2 \\left(\\frac{1}{2} 2^{nH(p)}\\right) = \\frac{1}{n} (nH(p) - 1) = H(p) - \\frac{1}{n} $$\n    在取 $n \\to \\infty$ 的极限时，$-\\frac{1}{n}$ 项消失：\n    $$ \\lim_{n\\to\\infty} \\frac{1}{n} \\log_2 |A_{n,p,\\delta} \\cap C_n| = H(p) $$\n    这个结果对于任何固定的 $\\delta > 0$ 都成立。因此，再取 $\\delta \\to 0^+$ 的极限不会改变结果。所以，\n    $$ H_{p, \\text{even}} = H(p) = -p\\log_2p - (1-p)\\log_2(1-p) $$", "answer": "$$\\boxed{-p\\log_2 p - (1-p)\\log_2(1-p)}$$", "id": "56679"}]}