{"hands_on_practices": [{"introduction": "理论与实践的第一次接触始于一个理想化的场景。本练习将通过一个由有理数参数定义的简单量子线路，直接揭示量子计算的跃迁振幅与经典复杂性类 GapP 中的函数之间的具体联系，从而为理解 BQP 与 PP 的关系奠定基础。[@problem_id:130916]", "problem": "**背景：** 复杂度类 GapP 由函数 $f(x)$ 构成，这些函数计算的是一台非确定性多项式时间图灵机上接受路径和拒绝路径数量之间的差值。由具有有理数值矩阵元素的门构成的量子电路，其跃迁振幅本身也是有理数。对于一个跃迁振幅 $A = p/q$，对于一个固定的分母 $q$，其整数分子 $p$ 可以由一个 GapP 函数计算得出。这个整数 $p$ 被称为该振幅在指定分母 $q$ 下的 GapP 值。\n\n**问题：** 考虑一个处于初态 $|\\psi_{in}\\rangle = |00\\rangle$ 的双量子比特系统。系统上施加一个量子电路 $U$，其定义为三个操作的序列：$U = U_3 U_2 U_1$。这些操作如下：\n1.  $U_1 = H \\otimes I$：一个 Hadamard 门 $H$ 作用于第一个量子比特，而第二个量子比特保持不变。\n2.  $U_2 = C-R$：一个受控门，其中第一个量子比特为控制比特，第二个量子比特为目标比特。单量子比特酉操作 $R$ 由以下实值矩阵描述：\n    $$\n    R = \\begin{pmatrix} c  -s \\\\ s  c \\end{pmatrix}\n    $$\n    其中 $s = a/d$ 和 $c = b/d$ 是有理数参数，而 $a, b, d$ 是整数。\n3.  $U_3 = H \\otimes I$：另一个 Hadamard 门作用于第一个量子比特。\n\n你的任务是计算跃迁振幅 $A = \\langle 11 | U | 00 \\rangle$ 的 GapP 值。该振幅的分母固定为 $2d$。请用参数 $a$ 表示你的答案。", "solution": "1. 初态和第一个 Hadamard 门：\n$|\\psi_0\\rangle = |0\\rangle\\otimes|0\\rangle$, $U_1=H\\otimes I$, $H|0\\rangle=\\frac{|0\\rangle+|1\\rangle}{\\sqrt2}.$\n因此\n$$|\\psi_1\\rangle\n=U_1|\\psi_0\\rangle\n=\\frac{1}{\\sqrt2}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle\n=\\frac{|00\\rangle+|10\\rangle}{\\sqrt2}.$$\n\n2. 受控-$R$ 门，其中\n$$R=\\begin{pmatrix}c  -s \\\\ s  c\\end{pmatrix},\\quad\nc=\\frac{b}{d},\\;s=\\frac{a}{d}.$$\n在 $|00\\rangle$（控制比特=0）上，它的作用是平凡的；在 $|10\\rangle$（控制比特=1）上：\n$|10\\rangle\\mapsto|1\\rangle\\otimes R|0\\rangle =|1\\rangle\\otimes\\bigl(c|0\\rangle+s|1\\rangle\\bigr) =c|10\\rangle+s|11\\rangle.$\n因此\n$$|\\psi_2\\rangle\n=\\frac{1}{\\sqrt2}\\bigl(|00\\rangle+c|10\\rangle+s|11\\rangle\\bigr).$$\n\n3. 第二个 Hadamard 门作用于第一个量子比特：\n$U_3=H\\otimes I,\\quad H|0\\rangle=\\tfrac{|0\\rangle+|1\\rangle}{\\sqrt2},\\; H|1\\rangle=\\tfrac{|0\\rangle-|1\\rangle}{\\sqrt2}.$\n应用于 $|\\psi_2\\rangle$ 中的每一项：\n$$\n\\begin{aligned}\n|00\\rangle \\mapsto \\tfrac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)\\otimes|0\\rangle, \\\\\nc|10\\rangle \\mapsto \\tfrac{c}{\\sqrt{2}}(|0\\rangle-|1\\rangle)\\otimes|0\\rangle, \\\\\ns|11\\rangle \\mapsto \\tfrac{s}{\\sqrt{2}}(|0\\rangle-|1\\rangle)\\otimes|1\\rangle.\n\\end{aligned}\n$$\n\n求和并包含前因子 $1/\\sqrt2$ 可得\n$$|\\psi_3\\rangle\n=\\frac1{2}\\Bigl[(1+c)|00\\rangle+(1-c)|10\\rangle\n+s\\,|01\\rangle -s\\,|11\\rangle\\Bigr].$$\n\n4. 提取振幅 $A=\\langle11|\\psi_3\\rangle$：\n$$A=-\\frac{s}{2}=-\\frac{a/d}{2}=-\\frac{a}{2d}.$$\n\n5. 对于分母 $2d$，整数分子（GapP 值）为\n$$p=-a.$$", "answer": "$$\\boxed{-a}$$", "id": "130916"}, {"introduction": "真实的量子门通常包含无理数振幅，这为经典模拟带来了挑战。本练习将深入探讨证明 BQP $\\subseteq$ PP 的核心技术：使用二进有理数近似。通过亲手计算一个近似路径的权重，您将体验到如何将一个量子过程转化为可在概率图灵机上执行的、基于路径计数的经典计算。[@problem_id:130813]", "problem": "在计算复杂性理论的研究中，量子复杂性类别 BQP（有界错误量子多项式时间）与经典复杂性类别（如 P 和 NP）之间的关系是一个具有根本重要性的课题。研究表明，BQP 包含于 PP（概率多项式时间）中，PP是一类可由概率图灵机以指数级小的概率间隙解决的问题。这个包含关系 BQP $\\subseteq$ PP 的证明，依赖于通过一种路径积分形式来模拟量子计算，这让人联想到 Feynman 在量子力学中的路径积分。\n\n一个量子计算由一系列酉门 $U = U_m U_{m-1} \\dots U_1$ 描述。从初态 $|x\\rangle$ 跃迁到末态 $|y\\rangle$ 的振幅由所有可能计算路径的和给出：\n$$\n\\langle y | U | x \\rangle = \\sum_{z_1, \\dots, z_{m-1}} \\langle y | U_m | z_{m-1} \\rangle \\dots \\langle z_1 | U_1 | x \\rangle\n$$\n和中的每一项对应于单条路径的振幅。为了在经典概率机器上模拟这个过程，门振幅（可以是无理复数）被近似为二进有理数（分母为2的幂次方的分数）。对于给定的精度参数 $p$，每个实值门矩阵元 $g_{uv} = \\langle u | G | v \\rangle$ 被近似为 $\\tilde{g}_{uv} = k_{uv}/2^p$，其中 $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$ 是一个整数。对于复数振幅，实部和虚部分别进行近似。\n\n总的近似振幅是这些二进有理数乘积的和，可以写成 $S / 2^{mp}$ 的形式。整数 $S = \\sum_{\\text{paths}} \\prod_{\\text{gates}} k_{uv}$ 是一个 GapP 函数，意味着它可以表示为一台非确定性图灵机的接受路径数（$N_{acc}$）和拒绝路径数（$N_{rej}$）之间的差。具体来说，我们定义一条路径的权重为其整数分子的乘积 $W(\\text{path}) = \\prod k_{uv}$。那么，$N_{acc} = \\sum_{W0} W(\\text{path})$ 且 $N_{rej} = \\sum_{W0} |W(\\text{path})|$。$N_{acc}$ 和 $N_{rej}$ 的值在 #P 中是可计算的。\n\n你的任务是为一个特定的2量子比特电路执行这样的计算。\n\n**问题描述：**\n\n考虑一个由酉算符 $U = U_3 U_2 U_1$ 描述的2量子比特电路，其中：\n1.  $U_1 = -H \\otimes I$，其中 $H$ 是 Hadamard 门，$I$ 是单位门。\n2.  $U_2$ 是一个受控 $R_Y(\\theta)$ 门，第一个量子比特为控制位，第二个为目标位，旋转角 $\\theta = \\pi/3$。$R_Y(\\theta)$ 门定义为 $R_Y(\\theta) = \\begin{pmatrix} \\cos(\\theta/2)  -\\sin(\\theta/2) \\\\ \\sin(\\theta/2)  \\cos(\\theta/2) \\end{pmatrix}$。\n3.  $U_3 = H \\otimes I$。\n\n门矩阵作用于标准计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$。所有门矩阵元都是实数。门矩阵元 $g_{uv}$ 的二进近似是 $\\tilde{g}_{uv} = k_{uv} / 2^p$，整数分子为 $k_{uv} = \\text{round}(2^p \\cdot g_{uv})$，精度为 $p=5$。`round()` 函数将实数四舍五入到最接近的整数（半整数向上取整）。\n\n计算从初态 $|x\\rangle = |00\\rangle$ 到末态 $|y\\rangle = |11\\rangle$ 的跃迁振幅所对应的 $N_{acc}$ 值。该值是所有总权重为正的计算路径的权重之和。", "solution": "1. 从 $|00\\rangle$ 到 $|11\\rangle$ 的跃迁振幅是\n$$\n\\langle11|U_3U_2U_1|00\\rangle\n=\\sum_{z_1,z_2}\\langle11|U_3|z_2\\rangle\\langle z_2|U_2|z_1\\rangle\\langle z_1|U_1|00\\rangle.\n$$\n\n2. 矩阵元振幅（精确值）：\n- $U_1=-H\\otimes I$ 给出\n  $$\\langle z_1|U_1|00\\rangle=\n  \\begin{cases}\n  -\\tfrac1{\\sqrt2},  z_1 \\in \\{|00\\rangle, |10\\rangle\\}, \\\\\n  0,  \\text{其它情况。}\n  \\end{cases}$$\n- $U_2=\\mathrm{C}\\!R_Y(\\pi/3)$ 在第一个比特为0时作为单位算符，而在第一个比特为1时作为\n  $$R_Y(\\tfrac\\pi3)=\\begin{pmatrix}\\cos\\tfrac\\pi6  -\\sin\\tfrac\\pi6\\\\\\sin\\tfrac\\pi6  \\cos\\tfrac\\pi6\\end{pmatrix}\n  $$\n  作用。因此，对于从 $|10\\rangle$ 跃迁，非零项是\n  $$\\langle11|U_2|10\\rangle=\\sin\\tfrac\\pi6=\\tfrac12.$$\n- $U_3=H\\otimes I$ 给出\n  $$\\langle11|U_3|z_2\\rangle \\neq 0 \\iff z_2 \\in \\{|01\\rangle, |11\\rangle\\},$$\n  其中，对我们的路径重要的是\n  $$\\langle11|U_3|11\\rangle=-\\tfrac1{\\sqrt2}.$$\n\n3. 唯一的非零路径是 $|00\\rangle\\to z_1=|10\\rangle\\to z_2=|11\\rangle\\to|11\\rangle$，其精确振幅为\n$$\n(-\\tfrac1{\\sqrt2})\\times(\\tfrac12)\\times(-\\tfrac1{\\sqrt2})\n=\\;\\frac1{4}.\n$$\n\n4. 使用 $p=5$ 进行二进近似：将每个精确项 $g$ 乘以 $2^5=32$ 并四舍五入。\n   - 对于 $U_1$ 中 $\\langle 10 | U_1 | 00 \\rangle$：$g=-\\tfrac1{\\sqrt2} \\;\\Longrightarrow\\;k_1=\\text{round}(32\\cdot(-\\tfrac{\\sqrt2}{2}))=\\text{round}(-16\\sqrt{2})=-23$。\n   - 对于 $U_2$ 中 $\\langle 11 | U_2 | 10 \\rangle$：$g=\\tfrac12\\;\\Longrightarrow\\;k_2=\\text{round}(32\\cdot\\tfrac12)=16$。\n   - 对于 $U_3$ 中 $\\langle 11 | U_3 | 11 \\rangle$：$g=-\\tfrac1{\\sqrt2}\\;\\Longrightarrow\\;k_3=-23$。\n\n5. 该唯一路径的整数权重是\n$$\nW = k_1\\,k_2\\,k_3 = (-23)\\times16\\times(-23)=23^2\\cdot16=84640.\n$$\n因此，$N_{acc}$，即正权重的和，为 $8464$。", "answer": "$$\\boxed{8464}$$", "id": "130813"}, {"introduction": "任何实际的量子计算都不可避免地会受到噪声的干扰。这个高级练习将探讨如何将 BQP $\\subseteq$ PP 的模拟框架扩展到包含退相干效应的场景。通过分析一个经历相位阻尼的单量子比特系统，您将推导出描述该噪声过程的等效 PP 机器的 GapP 函数，从而将物理现实与计算复杂性理论联系起来。[@problem_id:130839]", "problem": "**背景：**\n\n在量子复杂性理论中，BQP（有界错误量子多项式时间）是指可以由量子计算机在多项式时间内以不超过1/3的错误概率解决的判定问题所构成的复杂性类。BQP与P和NP等经典复杂性类之间的关系是一个核心研究领域。已知BQP包含在经典复杂性类PP（概率多项式时间）中。\n\n如果存在一个概率图灵机，它接受一个语言中的字符串的概率大于1/2，而拒绝不属于该语言的字符串的概率小于1/2，那么该语言就属于PP。这个与1/2的差距可以是指数级小的。PP机器的行为可以用GapP类中的一个函数来刻画，GapP是#P（计数问题）在减法运算下的闭包。具体来说，如果一个函数 $g(x)$ 可以表示为 $N_{acc}(x) - N_{rej}(x)$，其中 $N_{acc}$ 和 $N_{rej}$ 是一个非确定性图灵机的接受路径和拒绝路径的数量，那么该函数 $g(x)$ 就属于GapP。如果一个语言的成员资格可以由相应的GapP函数的符号来决定，那么该语言就属于PP。\n\n证明 BQP $\\subseteq$ PP 的过程涉及构造一个模拟该量子计算的PP机器。对于一个无噪声的量子电路 $U$，接受概率与拒绝概率之差 $p_{acc} - p_{rej}$ 可以被证明与一个可由GapP函数计算的值成正比。对于一个从态 $|0^n\\rangle$ 开始，且接受条件定义为测量第一个量子比特为'0'的电路，这个值是 $\\langle 0^n | U^\\dagger Z_1 U | 0^n \\rangle$，其中 $Z_1$ 是作用在第一个量子比特上的Pauli-Z算符。\n\n本问题探讨在存在退相干的情况下，这种联系会如何改变。\n\n**问题描述：**\n\n考虑一个单量子比特系统，其初始制备在态 $|\\psi_0\\rangle = |0\\rangle$。一个由单个Hadamard门 $U=H$ 构成的量子电路作用于该量子比特。在门作用之后，该量子比特经历一个由信道 $\\mathcal{E}$ 描述的相位阻尼噪声演化。该信道的Kraus算符为：\n$$\nK_0 = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{1-\\gamma} \\end{pmatrix}, \\quad K_1 = \\begin{pmatrix} 0  0 \\\\ 0  \\sqrt{\\gamma} \\end{pmatrix}\n$$\n其中 $\\gamma \\in [0, 1]$ 是阻尼参数。该信道对密度矩阵 $\\rho$ 的作用是 $\\mathcal{E}(\\rho) = K_0 \\rho K_0^\\dagger + K_1 \\rho K_1^\\dagger$。\n\n系统的末态为 $\\rho_f = \\mathcal{E}(H |\\psi_0\\rangle \\langle\\psi_0| H^\\dagger)$。\n\n然后，在Pauli-X算符的基下进行测量。接受概率 $p_{\\text{acc}}$ 是获得结果 $+1$（对应于态 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle+|1\\rangle)$）的概率。拒绝概率 $p_{\\text{rej}}$ 是获得结果 $-1$（对应于态 $|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle-|1\\rangle)$）的概率。\n\n量 $P = p_{\\text{acc}} - p_{\\text{rej}}$ 是末态在X基下的有效极化。这个量是PP机器为了模拟此带噪量子过程所需要估计的。请推导该极化 $P$ 作为阻尼参数 $\\gamma$ 的函数其精确表达式。", "solution": "我们有初始态 $|\\psi_0\\rangle=|0\\rangle$ 并应用 $H$，所以\n$$\n\\rho_1=H\\,|0\\rangle\\langle0|\\,H^\\dagger\n=\\frac12\\begin{pmatrix}11\\\\11\\end{pmatrix}.\n$$\n相位阻尼信道给出\n$$\n\\rho_f=K_0\\,\\rho_1\\,K_0^\\dagger+K_1\\,\\rho_1\\,K_1^\\dagger,\n\\quad\nK_0=\\begin{pmatrix}10\\\\0\\sqrt{1-\\gamma}\\end{pmatrix},\n\\;\nK_1=\\begin{pmatrix}00\\\\0\\sqrt{\\gamma}\\end{pmatrix}.\n$$\n计算每一项：\n$$\nK_0\\,\\rho_1\n=\\frac12\\begin{pmatrix}11\\\\\\sqrt{1-\\gamma}\\sqrt{1-\\gamma}\\end{pmatrix},\n\\quad\nK_0\\,\\rho_1\\,K_0^\\dagger\n=\\frac12\\begin{pmatrix}1\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}1-\\gamma\\end{pmatrix}.\n$$\n$$\nK_1\\,\\rho_1\n=\\frac12\\begin{pmatrix}00\\\\\\sqrt{\\gamma}\\sqrt{\\gamma}\\end{pmatrix},\n\\quad\nK_1\\,\\rho_1\\,K_1^\\dagger\n=\\frac12\\begin{pmatrix}00\\\\0\\gamma\\end{pmatrix}.\n$$\n求和，\n$$\n\\rho_f\n=\\frac12\\begin{pmatrix}1\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}1-\\gamma\\end{pmatrix}\n+\\frac12\\begin{pmatrix}00\\\\0\\gamma\\end{pmatrix}\n=\\frac12\\begin{pmatrix}1\\sqrt{1-\\gamma}\\\\\\sqrt{1-\\gamma}1\\end{pmatrix}.\n$$\n在 $X$ 基下的极化是\n$$\nP=p_{acc}-p_{rej}\n=\\Tr\\bigl(X\\,\\rho_f\\bigr)\n=\\rho_{f,01}+\\rho_{f,10}\n=\\sqrt{1-\\gamma}.\n$$", "answer": "$$\\boxed{\\sqrt{1-\\gamma}}$$", "id": "130839"}]}