{"hands_on_practices": [{"introduction": "在线性代数中，寻找一个线性变换的核是一个基本问题。在量子计算领域，这个问题（特别是在有限域 $\\mathbb{F}_2$ 上）是BQP复杂性类中一个典型例子，它展示了相较于经典算法的量子加速。通过本练习 [@problem_id:148972]，您将为一个具体实例计算量子算法的成功概率，从而深入理解如何利用量子叠加来并行处理信息并提取全局属性。", "problem": "考虑一个用于寻找线性变换 $A: (\\mathbb{F}_2)^n \\to (\\mathbb{F}_2)^m$ 的核的量子算法。该算法首先将一个 n-量子比特寄存器和一个 m-量子比特寄存器制备在状态 $|0\\rangle^{\\otimes n}|0\\rangle^{\\otimes m}$ 上。对第一个寄存器应用哈达玛门后，再应用一个用于变换 $A$ 的量子预言机，它将 $|x\\rangle|y\\rangle$ 映射到 $|x\\rangle|y \\oplus Ax\\rangle$，其中 $x \\in (\\mathbb{F}_2)^n$，$y \\in (\\mathbb{F}_2)^m$，且 $\\oplus$ 表示模2按位加法。\n\n调用预言机后，组合系统的状态为 $|\\Psi\\rangle = \\frac{1}{\\sqrt{2^n}}\\sum_{x \\in (\\mathbb{F}_2)^n} |x\\rangle |Ax\\rangle$。然后丢弃第二个（输出）寄存器，使第一个（输入）寄存器处于一个混合态，该混合态由约化密度矩阵 $\\rho_1 = \\text{Tr}_2(|\\Psi\\rangle\\langle\\Psi|)$ 描述。\n\n设 $n=4$ 且 $m=3$。具体的线性变换由矩阵\n$$\nA = \\begin{pmatrix}\n1  &  0  &  1  &  1 \\\\\n0  &  1  &  1  &  0 \\\\\n1  &  1  &  0  &  1\n\\end{pmatrix}.\n$$\n给出。在输入寄存器上进行一次投影测量。该测量将状态投影到由状态 $|\\psi_S\\rangle$ 张成的一维子空间上，其中 $|\\psi_S\\rangle$ 是子空间 $S \\subset (\\mathbb{F}_2)^4$ 中所有向量的均匀叠加态。子空间 $S$ 由基向量 $s_1 = (1,1,1,0)$ 和 $s_2 = (0,0,1,1)$ 定义。因此，投影算子为 $P_S = |\\psi_S\\rangle\\langle\\psi_S|$，其中 $|\\psi_S\\rangle = \\frac{1}{\\sqrt{|S|}}\\sum_{s \\in S} |s\\rangle$。\n\n推导本次测量成功的概率。", "solution": "1.  **计算测量概率的一般公式**\n    测量成功的概率 $P$ 由投影算子 $P_S$ 和输入寄存器的约化密度矩阵 $\\rho_1$ 给出：\n    $$ P = \\text{Tr}(\\rho_1 P_S) $$\n    其中 $P_S = |\\psi_S\\rangle\\langle\\psi_S|$。这可以重写为：\n    $$ P = \\langle\\psi_S|\\rho_1|\\psi_S\\rangle $$\n    约化密度矩阵 $\\rho_1$ 是通过追踪（trace out） $|\\Psi\\rangle\\langle\\Psi|$ 的第二个寄存器得到的：\n    $$ \\rho_1 = \\text{Tr}_2(|\\Psi\\rangle\\langle\\Psi|) = \\text{Tr}_2 \\left( \\frac{1}{2^n} \\sum_{x, x' \\in (\\mathbb{F}_2)^n} |x\\rangle\\langle x'| \\otimes |Ax\\rangle\\langle Ax'| \\right) = \\frac{1}{2^n} \\sum_{x, x' \\in (\\mathbb{F}_2)^n} |x\\rangle\\langle x'| \\langle Ax'|Ax\\rangle $$\n    由于 $\\langle Ax'|Ax\\rangle = \\delta_{Ax, Ax'}$，我们得到：\n    $$ \\rho_1 = \\frac{1}{2^n} \\sum_{\\substack{x, x' \\in (\\mathbb{F}_2)^n \\\\ Ax = Ax'}} |x\\rangle\\langle x'| $$\n    代入概率公式：\n    $$ P = \\left\\langle\\psi_S\\left| \\left( \\frac{1}{2^n} \\sum_{\\substack{x, x' \\\\ Ax = Ax'}} |x\\rangle\\langle x'| \\right) \\right|\\psi_S\\right\\rangle = \\frac{1}{2^n} \\sum_{\\substack{x, x' \\\\ Ax = Ax'}} \\langle\\psi_S|x\\rangle\\langle x'|\\psi_S\\rangle $$\n    因为 $|\\psi_S\\rangle = \\frac{1}{\\sqrt{|S|}}\\sum_{s \\in S} |s\\rangle$，所以 $\\langle\\psi_S|x\\rangle$ 仅当 $x \\in S$ 时非零，此时其值为 $1/\\sqrt{|S|}$。因此，求和仅限于 $x, x' \\in S$：\n    $$ P = \\frac{1}{2^n} \\sum_{\\substack{x, x' \\in S \\\\ Ax = Ax'}} \\frac{1}{\\sqrt{|S|}} \\frac{1}{\\sqrt{|S|}} = \\frac{1}{2^n|S|} \\sum_{\\substack{x, x' \\in S \\\\ Ax = Ax'}} 1 $$\n\n2.  **为具体实例计算**\n    *   子空间 $S$ 由基向量 $s_1 = (1,1,1,0)$ 和 $s_2 = (0,0,1,1)$ 张成。其元素为：\n        *   $0 \\cdot s_1 \\oplus 0 \\cdot s_2 = (0,0,0,0)$\n        *   $1 \\cdot s_1 \\oplus 0 \\cdot s_2 = (1,1,1,0)$\n        *   $0 \\cdot s_1 \\oplus 1 \\cdot s_2 = (0,0,1,1)$\n        *   $1 \\cdot s_1 \\oplus 1 \\cdot s_2 = (1,1,0,1)$\n        因此，$S = \\{(0,0,0,0), (1,1,1,0), (0,0,1,1), (1,1,0,1)\\}$，且 $|S|=4$。\n    *   接下来，我们计算 $S$ 中每个向量在矩阵 $A$ 下的像：\n        $$\n        A = \\begin{pmatrix} 1 & 0 & 1 & 1 \\\\ 0 & 1 & 1 & 0 \\\\ 1 & 1 & 0 & 1 \\end{pmatrix}\n        $$\n        *   $A(0,0,0,0)^T = (0,0,0)^T$\n        *   $A(1,1,1,0)^T = (1+1, 1+1, 1+1)^T = (0,0,0)^T$\n        *   $A(0,0,1,1)^T = (1+1, 1, 1)^T = (0,1,1)^T$\n        *   $A(1,1,0,1)^T = (1+1, 1, 1+1)^T = (0,1,1)^T$\n    *   我们看到，$S$ 中的向量被映射到两个不同的值：$(0,0,0)^T$ 和 $(0,1,1)^T$。\n        *   映射到 $(0,0,0)^T$ 的向量有 2 个。\n        *   映射到 $(0,1,1)^T$ 的向量有 2 个。\n    *   求和项 $\\sum_{x, x' \\in S, Ax=Ax'} 1$ 计算的是从 $S$ 中选出两个向量 $x, x'$，它们具有相同像的配对数。对于像 $(0,0,0)^T$，有 $2 \\times 2 = 4$ 对。对于像 $(0,1,1)^T$，有 $2 \\times 2 = 4$ 对。总对数为 $4+4=8$。\n\n3.  **最终概率**\n    将 $n=4$, $|S|=4$ 和求和结果 8 代入公式：\n    $$ P = \\frac{8}{2^4 \\cdot 4} = \\frac{8}{16 \\cdot 4} = \\frac{8}{64} = \\frac{1}{8} $$", "answer": "$$\\boxed{\\frac{1}{8}}$$", "id": "148972"}, {"introduction": "理解一个问题是否属于BQP，不仅在于设计出量子算法，还在于分析其效率。量子多项式方法是分析量子算法查询复杂度的强大理论工具。这个练习 [@problem_id:148866] 将著名的Grover搜索算法的接受概率与一个多变量多项式的次数联系起来，这个次数为解决该问题所需的预言机查询次数设定了下限。", "problem": "量子多项式方法建立了量子算法的查询复杂度与其接受概率的多项式表示的次数之间的联系。考虑一个为解决 $N=4$ 比特串 $x=(x_0, x_1, x_2, x_3)$ 上的“或”问题而设计的量子算法。该算法是 Grover 搜索算法的一个实例。\n\n该算法作用于一个 2 量子比特的希尔伯特空间，其计算基矢 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 分别被索引为 $|0\\rangle, |1\\rangle, |2\\rangle, |3\\rangle$。该算法的组成部分定义如下：\n\n1.  **初始态**：算法从所有基矢的均匀叠加态开始：\n    $$\n    |\\psi_0\\rangle = \\frac{1}{2} \\sum_{j=0}^{3} |j\\rangle\n    $$\n\n2.  **预言机**：对于输入串 $x$，预言机 $O_x$ 是一个相位预言机，它标记那些对应输入比特 $x_j=1$ 的基矢 $|j\\rangle$。其作用为：\n    $$\n    O_x|j\\rangle = (-1)^{x_j}|j\\rangle\n    $$\n    注意，对于 $x_j \\in \\{0, 1\\}$，有 $(-1)^{x_j} = 1 - 2x_j$。\n\n3.  **扩散算子**：扩散算子（或称关于初始态的反射）由下式给出：\n    $$\n    U_s = 2|\\psi_0\\rangle\\langle\\psi_0| - I\n    $$\n    其中 $I$ 是单位算子。\n\n4.  **算法执行**：该算法执行 $T=2$ 次完整的 Grover 迭代。单次迭代包括应用预言机，然后应用扩散算子。系统的最终状态是：\n    $$\n    |\\psi_f(x)\\rangle = (U_s O_x)^2 |\\psi_0\\rangle\n    $$\n\n5.  **接受条件**：如果对最终状态 $|\\psi_f(x)\\rangle$ 的测量得到初始状态 $|\\psi_0\\rangle$，则认为算法“接受”了输入。因此，接受概率为：\n    $$\n    P(x) = |\\langle \\psi_0 | \\psi_f(x) \\rangle|^2\n    $$\n\n可以证明，这个接受概率 $P(x)$ 是一个关于变量 $x_0, x_1, x_2, x_3$ 的多元多项式。由于这些变量是布尔值（$x_j^2 = x_j$），该多项式有一个唯一的多线性多项式表示。\n\n你的任务是确定这个多线性多项式 $P(x_0, x_1, x_2, x_3)$ 的次数。", "solution": "1. 该算法作用于由“标记的”等量叠加态\n   $$|\\alpha\\rangle=\\frac{1}{\\sqrt{k}}\\sum_{j:x_j=1}|j\\rangle,\\quad k=\\sum_j x_j$$ \n   和“未标记的”叠加态\n   $$|\\beta\\rangle=\\frac{1}{\\sqrt{N-k}}\\sum_{j:x_j=0}|j\\rangle,\\quad N=4$$\n   所张成的二维子空间中。\n2. 初始态为\n   $$|\\psi_0\\rangle=\\sqrt{\\tfrac{k}{N}}\\,|\\alpha\\rangle+\\sqrt{\\tfrac{N-k}{N}}\\,|\\beta\\rangle\n   =\\sin\\theta\\,|\\alpha\\rangle+\\cos\\theta\\,|\\beta\\rangle,$$ \n   其中 $\\sin\\theta=\\sqrt{k/N}$。\n3. 一次 Grover 迭代 $G=U_sO_x$ 是在该子空间中的一次 $2\\theta$ 旋转，因此经过 $T=2$ 次迭代后\n   $$|\\psi_f\\rangle=G^2|\\psi_0\\rangle\\quad\\Longrightarrow\\quad\n     \\langle\\psi_0|\\psi_f\\rangle=\\cos(2\\cdot2\\theta)=\\cos(4\\theta)。$$\n4. 因此接受概率为\n   $$P(x)=\\bigl|\\langle\\psi_0|\\psi_f\\rangle\\bigr|^2=\\cos^2(4\\theta)。$$\n5. 使用 $\\cos^2(4\\theta)=[\\cos(4\\theta)]^2$ 以及\n   $$\\cos(4\\theta)=8\\cos^4\\theta-8\\cos^2\\theta+1,\\quad\n     \\cos^2\\theta=1-\\sin^2\\theta=1-\\frac{k}{4},$$ \n   可以得到\n   $$P(x)=\\Bigl(\\tfrac12k^2-2k+1\\Bigr)^2,$$ \n   其中 $k=x_0+x_1+x_2+x_3$。将其展开为多线性布尔项式会产生最高到 $k^4$ 的项，即次数为 4。", "answer": "$$\\boxed{4}$$", "id": "148866"}, {"introduction": "从抽象的算法到物理现实的实现，是量子计算面临的核心挑战之一。BQP中的算法由量子门序列构成，但容错量子计算机通常只能执行一个有限的通用门集（如Clifford+T门）。本练习 [@problem_id:148970] 将带您直面一个实际问题：如何使用T门集来近似一个必要的旋转门，并计算相关的“T门数”——这是衡量量子算法资源成本的关键指标。", "problem": "在量子计算中，单量子比特旋转是基本的构建模块。任意旋转通常通过使用来自通用容错门集（例如 Clifford+T 门）的一系列门来近似合成。T 门的数量（T-count）是许多量子算法总资源成本的主要因素。\n\n本问题涉及一种合成任意 Z 轴旋转 $R_z(\\theta) = \\begin{pmatrix} e^{-i\\theta/2} & 0 \\\\ 0 & e^{i\\theta/2} \\end{pmatrix}$ 的标准方法。该方法依赖于用一个所谓的二进角度 $\\phi$ 来高精度地近似目标旋转角 $\\theta$，而这个二进角度可以被精确地合成。这个任务是丢番图近似的一个具体实例。\n\n如果一个角度 $\\phi$ 的形式为 $\\phi = m\\pi/2^k$（其中 m 和 k 为整数），则称其为二进角度。旋转 $R_z(\\phi)$ 随后可以用一个由 Clifford 门和 T 门组成的电路来合成。对于给定的 $\\phi = m\\pi/2^k$，我们首先通过约去公因数 2 来简化分数 $m/2^k$，得到一个表示形式 $m'\\pi/2^{k'}$，其中 $m'$ 是奇数。合成此旋转的 T-count 由以下成本函数给出：\n$$ C(k', m') = 3(k'-1) + \\text{HW}_2(m') $$\n其中 $k' \\ge 1$ 并且 $\\text{HW}_2(m')$ 是整数 $m'$ 的汉明权重（即其二进制表示中 1 的数量）。\n\n你的任务是找到以 $\\epsilon = 10^{-4}$ 的精度合成旋转 $R_z(2\\pi/5)$ 所需的最小 T-count。精度由目标幺正算符 $U_{target} = R_z(2\\pi/5)$ 与近似算符 $U_{approx} = R_z(\\phi)$ 之差的算子范数来衡量，使得 $\\|U_{target} - U_{approx}\\| \\le \\epsilon$。\n\n在你的计算中，你可以使用小角度近似 $\\|R_z(\\theta) - R_z(\\phi)\\| \\approx |\\theta - \\phi|/2$。请找出最小 T-count 的精确整数值。", "solution": "我们寻求一个二进角度\n$$\\phi=\\frac{m\\pi}{2^k}$$ \n其中 m, k 为整数，使得\n$$\\|R_z(2\\pi/5)-R_z(\\phi)\\|\\le\\epsilon=10^{-4}.$$ \n使用小角度近似\n$$\\|R_z(\\theta)-R_z(\\phi)\\|\\approx\\frac{|\\theta-\\phi|}{2},$$ \n精度要求变为\n$$|\\theta-\\phi|\\le 2\\epsilon\n\\quad\\Longrightarrow\\quad\n\\Bigl|\\frac{2\\pi}{5}-\\frac{m\\pi}{2^k}\\Bigr|\\le2\\epsilon\n\\;\\Longleftrightarrow\\;\n\\Bigl|\\frac{2}{5}-\\frac{m}{2^k}\\Bigr|\\le\\frac{2\\epsilon}{\\pi}.$$\n设\n$$\\delta=\\frac{2\\epsilon}{\\pi}=\\frac{2\\cdot10^{-4}}{\\pi}.$$\n对于固定的 k，最佳的 m 是\n$$m=\\text{round}\\!\\Bigl(0.4\\cdot2^k\\Bigr),$$ \n并且近似误差为\n$$\\Bigl|\\frac{m}{2^k}-0.4\\Bigr|\n=\\Bigl|\\text{round}(0.4\\cdot2^k)/2^k-0.4\\Bigr|.$$\n我们对递增的 k 制表计算误差，直到误差小于 $\\delta\\approx6.3662\\times10^{-5}$：\nk=11: 误差≈9.77×10⁻⁵ > δ  \nk=12: 误差≈9.77×10⁻⁵ > δ  \nk=13: 误差≈2.441×10⁻⁵ ≤ δ  \n\n因此最小的 k 是 k=13，此时\n$$m=\\text{round}(0.4\\cdot2^{13})=\\text{round}(3276.8)=3277.$$\n因为 3277 是奇数，所以简化形式为\n$$\\phi=\\frac{3277\\pi}{2^{13}},\\quad k'=13,\\;m'=3277.$$\nT-count 成本是\n$$C(k',m')=3(k'-1)+\\mathrm{HW}_2(m')\n=3\\cdot12+\\mathrm{HW}_2(3277).$$\n将 $3277_{10}=110011001101_2$ 表明 $\\mathrm{HW}_2(3277)=7$。因此\n$$C=36+7=43.$$", "answer": "$$\\boxed{43}$$", "id": "148970"}]}