{"hands_on_practices": [{"introduction": "在多比特系统中，控制场中的噪声和串扰是导致门操作保真度下降的主要原因。本练习旨在建立一个从物理噪声源到量子门性能指标的量化模型。通过分析一个受协变随机漂移影响的双比特门，你将学习如何计算平均过程不忠实度，从而将微波驱动幅度的微小波动与最终的门错误联系起来 ([@problem_id:65589])。这个实践将帮助你掌握在存在随机误差时，评估和预测量子处理器基本构建模块性能的关键分析技术。", "problem": "一个双量子比特门，理想情况下由酉算符 $U_{target} = \\sigma_x^{(1)} \\otimes \\sigma_x^{(2)}$ 描述，是通过在固定时长 $\\tau_g$ 内施加一个恒定的哈密顿量 $H$ 来实现的。理想哈密顿量为 $H_0 = \\frac{\\hbar\\pi}{2\\tau_g} (\\sigma_x^{(1)} \\otimes \\sigma_x^{(2)})$。这会产生操作 $U_0 = \\exp(-i H_0 \\tau_g/\\hbar) = -i(\\sigma_x^{(1)} \\otimes \\sigma_x^{(2)})$，该操作与 $U_{target}$ 等效，仅相差一个全局相位。\n\n在实际中，控制场中缓慢的随机漂移会导致一个形式如下的微扰哈密顿量：\n$$ H = \\frac{\\hbar}{2\\tau_g} \\left[ (\\pi + \\delta_g)(\\sigma_x^{(1)} \\otimes \\sigma_x^{(2)}) + \\delta_1 (\\sigma_x^{(1)} \\otimes I) + \\delta_2 (I \\otimes \\sigma_x^{(2)}) \\right] $$\n与 $\\delta_g$ 成正比的项代表过旋转/欠旋转误差，而含有 $\\delta_1$ 和 $\\delta_2$ 的项是由串扰引起的不希望出现的单量子比特旋转。$I$ 是单个量子比特上的单位算符，而 $\\sigma_x^{(k)}$ 是量子比特 $k$ 的泡利-X算符。\n\n误差参数 $\\delta_g, \\delta_1, \\delta_2$ 并非基本噪声源，而是源于用于产生相互作用的两个微波驱动的幅度中归一化的无量纲涨落 $\\epsilon_1$ 和 $\\epsilon_2$。它们的关系由下式给出：\n$$ \\delta_g = \\frac{\\pi}{2}(\\epsilon_1 + \\epsilon_2), \\quad \\delta_1 = c_1 \\epsilon_2, \\quad \\delta_2 = c_2 \\epsilon_1 $$\n其中 $c_1$ 和 $c_2$ 是无量纲串扰系数。\n\n涨落 $\\epsilon_1$ 和 $\\epsilon_2$ 是准静态的，这意味着它们在任何单次门执行期间是恒定的，但在每次执行之间会发生变化。它们由一个零均值的二元正态分布描述，两个变量具有相同的标准差 $\\sigma \\ll 1$ 和一个相关系数 $\\rho$。其概率密度函数为：\n$$ P(\\epsilon_1, \\epsilon_2) = \\frac{1}{2\\pi \\sigma^2 \\sqrt{1-\\rho^2}} \\exp\\left(-\\frac{\\epsilon_1^2 - 2\\rho \\epsilon_1 \\epsilon_2 + \\epsilon_2^2}{2\\sigma^2(1-\\rho^2)}\\right) $$\n\n计算实际量子过程与理想过程之间的平均过程非保真度 $\\langle \\mathcal{I}_p \\rangle$，该平均值是在噪声分布上计算的。给出结果到 $\\sigma^2$ 的领头非零阶。对于 $d$ 维空间上的酉操作 $U_{ideal}$ 和 $U_{actual}$，过程保真度为 $F_p = \\frac{1}{d^2} |\\text{Tr}(U_{ideal}^\\dagger U_{actual})|^2$。", "solution": "问题要求计算含噪声的双量子比特门的平均过程非保真度。非保真度为 $\\mathcal{I}_p = 1 - F_p$，其中 $F_p$ 是过程保真度。对于两个量子比特，希尔伯特空间的维度是 $d=4$。\n\n理想门是 $U_{ideal} = -i \\sigma_x^{(1)} \\otimes \\sigma_x^{(2)}$。为简洁起见，我们记 $X_1 = \\sigma_x^{(1)}$，$X_2 = \\sigma_x^{(2)}$，以及 $X_1X_2 = \\sigma_x^{(1)} \\otimes \\sigma_x^{(2)}$。因此，$U_{ideal} = -i X_1X_2$。其伴随算符为 $U_{ideal}^\\dagger = i X_1X_2$。\n\n实际实现的酉算符为 $U_{actual} = \\exp(-i H \\tau_g / \\hbar)$。哈密顿量由下式给出：\n$$ H = \\frac{\\hbar}{2\\tau_g} \\left[ (\\pi + \\delta_g)X_1X_2 + \\delta_1 (X_1 \\otimes I) + \\delta_2 (I \\otimes X_2) \\right] $$\n哈密顿量中的各项，$X_1X_2$、$X_1 \\otimes I$ 和 $I \\otimes X_2$，都相互对易。例如，$[X_1, X_2] = 0$ 和 $[X_1X_2, X_1] = (X_1 \\otimes X_2)(X_1 \\otimes I) - (X_1 \\otimes I)(X_1 \\otimes X_2) = (X_1^2 \\otimes X_2) - (X_1^2 \\otimes X_2) = (I \\otimes X_2) - (I \\otimes X_2) = 0$。由于所有项都对易，指数可以分离：\n$$ U_{actual} = \\exp\\left(-i\\frac{\\theta_0}{2} X_1X_2\\right) \\exp\\left(-i\\frac{\\theta_1}{2} X_1\\right) \\exp\\left(-i\\frac{\\theta_2}{2} X_2\\right) $$\n其中我们定义了 $\\theta_0 = \\pi + \\delta_g$，$\\theta_1 = \\delta_1$ 和 $\\theta_2 = \\delta_2$。\n使用泡利算符的欧拉公式，$e^{-i\\phi P} = \\cos(\\phi)I - i\\sin(\\phi)P$，该公式对任何满足 $P^2=I$ 的算符 $P$ 成立：\n$$ U_{actual} = \\left(\\cos\\frac{\\theta_0}{2} - i\\sin\\frac{\\theta_0}{2} X_1X_2\\right) \\left(\\cos\\frac{\\theta_1}{2} - i\\sin\\frac{\\theta_1}{2} X_1\\right) \\left(\\cos\\frac{\\theta_2}{2} - i\\sin\\frac{\\theta_2}{2} X_2\\right) $$\n\n过程保真度为 $F_p = \\frac{1}{16} |\\text{Tr}(U_{ideal}^\\dagger U_{actual})|^2$。我们来计算迹 $M = \\text{Tr}(U_{ideal}^\\dagger U_{actual}) = \\text{Tr}(i X_1X_2 U_{actual})$。\n$$ M = \\text{Tr}\\left[ i X_1X_2 \\left(\\cos\\frac{\\theta_0}{2} - i\\sin\\frac{\\theta_0}{2} X_1X_2\\right) \\left(\\cos\\frac{\\theta_1}{2} - i\\sin\\frac{\\theta_1}{2} X_1\\right) \\left(\\cos\\frac{\\theta_2}{2} - i\\sin\\frac{\\theta_2}{2} X_2\\right) \\right] $$\n$$ M = \\text{Tr}\\left[ \\left(i\\cos\\frac{\\theta_0}{2} X_1X_2 + \\sin\\frac{\\theta_0}{2} I\\right) \\left(\\cos\\frac{\\theta_1}{2}\\cos\\frac{\\theta_2}{2}I - i\\cos\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} X_2 - i\\sin\\frac{\\theta_1}{2}\\cos\\frac{\\theta_2}{2} X_1 - \\sin\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} X_1X_2\\right) \\right] $$\n任何泡利串的迹都为零，单位算符除外，其迹为 $\\text{Tr}(I) = d = 4$。所以我们只需要在乘积中找到与单位算符成正比的项。\n单位算符项来自于两个乘积：\n1. $( \\sin\\frac{\\theta_0}{2} I ) \\cdot ( \\cos\\frac{\\theta_1}{2}\\cos\\frac{\\theta_2}{2} I ) = \\sin\\frac{\\theta_0}{2}\\cos\\frac{\\theta_1}{2}\\cos\\frac{\\theta_2}{2} I$\n2. $( i\\cos\\frac{\\theta_0}{2} X_1X_2 ) \\cdot ( -\\sin\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} X_1X_2 ) = -i\\cos\\frac{\\theta_0}{2}\\sin\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} (X_1X_2)^2 = -i\\cos\\frac{\\theta_0}{2}\\sin\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} I$\n$I$ 的系数是这两项的和。\n$$ \\text{Tr}(...) / 4 = \\sin\\frac{\\theta_0}{2}\\cos\\frac{\\theta_1}{2}\\cos\\frac{\\theta_2}{2} - i\\cos\\frac{\\theta_0}{2}\\sin\\frac{\\theta_1}{2}\\sin\\frac{\\theta_2}{2} $$\n参数 $\\delta_g, \\delta_1, \\delta_2$ 很小。我们将三角函数对这些参数展开到二阶。\n$\\theta_0 = \\pi + \\delta_g \\implies \\frac{\\theta_0}{2} = \\frac{\\pi}{2} + \\frac{\\delta_g}{2}$。\n$\\sin(\\frac{\\theta_0}{2}) = \\sin(\\frac{\\pi}{2} + \\frac{\\delta_g}{2}) = \\cos(\\frac{\\delta_g}{2}) \\approx 1 - \\frac{1}{2}(\\frac{\\delta_g}{2})^2 = 1 - \\frac{\\delta_g^2}{8}$。\n$\\cos(\\frac{\\theta_0}{2}) = \\cos(\\frac{\\pi}{2} + \\frac{\\delta_g}{2}) = -\\sin(\\frac{\\delta_g}{2}) \\approx -\\frac{\\delta_g}{2}$。\n$\\theta_1 = \\delta_1 \\implies \\cos(\\frac{\\theta_1}{2}) \\approx 1 - \\frac{\\delta_1^2}{8}, \\quad \\sin(\\frac{\\theta_1}{2}) \\approx \\frac{\\delta_1}{2}$。\n$\\theta_2 = \\delta_2 \\implies \\cos(\\frac{\\theta_2}{2}) \\approx 1 - \\frac{\\delta_2^2}{8}, \\quad \\sin(\\frac{\\theta_2}{2}) \\approx \\frac{\\delta_2}{2}$。\n\n将这些展开式代入 $M/4$ 的表达式中：\n$$ M/4 \\approx \\left(1 - \\frac{\\delta_g^2}{8}\\right)\\left(1 - \\frac{\\delta_1^2}{8}\\right)\\left(1 - \\frac{\\delta_2^2}{8}\\right) - i\\left(-\\frac{\\delta_g}{2}\\right)\\left(\\frac{\\delta_1}{2}\\right)\\left(\\frac{\\delta_2}{2}\\right) $$\n保留到 $\\delta_i$ 的二阶项：\n$$ M/4 \\approx 1 - \\frac{1}{8}(\\delta_g^2 + \\delta_1^2 + \\delta_2^2) + O(\\delta^3) $$\n过程保真度为 $F_p = |M/4|^2$。\n$$ F_p \\approx \\left|1 - \\frac{1}{8}(\\delta_g^2 + \\delta_1^2 + \\delta_2^2)\\right|^2 \\approx 1 - \\frac{1}{4}(\\delta_g^2 + \\delta_1^2 + \\delta_2^2) $$\n对于噪声的某一次特定实现，过程非保真度为：\n$$ \\mathcal{I}_p = 1 - F_p \\approx \\frac{1}{4}(\\delta_g^2 + \\delta_1^2 + \\delta_2^2) $$\n现在，我们必须在 $\\epsilon_1$ 和 $\\epsilon_2$ 的噪声分布上对这个非保真度进行平均。\n$$ \\langle\\mathcal{I}_p\\rangle = \\frac{1}{4} \\langle \\delta_g^2 + \\delta_1^2 + \\delta_2^2 \\rangle = \\frac{1}{4} (\\langle \\delta_g^2 \\rangle + \\langle \\delta_1^2 \\rangle + \\langle \\delta_2^2 \\rangle) $$\n关系式为 $\\delta_g = \\frac{\\pi}{2}(\\epsilon_1 + \\epsilon_2)$，$\\delta_1 = c_1 \\epsilon_2$，$\\delta_2 = c_2 \\epsilon_1$。\n二元正态分布的矩为 $\\langle \\epsilon_1 \\rangle = \\langle \\epsilon_2 \\rangle = 0$，$\\langle \\epsilon_1^2 \\rangle = \\sigma^2$，$\\langle \\epsilon_2^2 \\rangle = \\sigma^2$ 和 $\\langle \\epsilon_1 \\epsilon_2 \\rangle = \\rho\\sigma^2$。\n我们来计算每个误差平方项的平均值：\n$$ \\langle \\delta_g^2 \\rangle = \\left\\langle \\left( \\frac{\\pi}{2}(\\epsilon_1 + \\epsilon_2) \\right)^2 \\right\\rangle = \\frac{\\pi^2}{4} \\langle \\epsilon_1^2 + 2\\epsilon_1\\epsilon_2 + \\epsilon_2^2 \\rangle = \\frac{\\pi^2}{4} (\\sigma^2 + 2\\rho\\sigma^2 + \\sigma^2) = \\frac{\\pi^2\\sigma^2}{2}(1+\\rho) $$\n$$ \\langle \\delta_1^2 \\rangle = \\langle (c_1 \\epsilon_2)^2 \\rangle = c_1^2 \\langle \\epsilon_2^2 \\rangle = c_1^2 \\sigma^2 $$\n$$ \\langle \\delta_2^2 \\rangle = \\langle (c_2 \\epsilon_1)^2 \\rangle = c_2^2 \\langle \\epsilon_1^2 \\rangle = c_2^2 \\sigma^2 $$\n将这些结果代入平均非保真度的表达式中：\n$$ \\langle\\mathcal{I}_p\\rangle = \\frac{1}{4} \\left( \\frac{\\pi^2\\sigma^2}{2}(1+\\rho) + c_1^2 \\sigma^2 + c_2^2 \\sigma^2 \\right) $$\n提出公因子，我们得到最终结果：\n$$ \\langle\\mathcal{I}_p\\rangle = \\frac{\\sigma^2}{4} \\left( \\frac{\\pi^2}{2}(1+\\rho) + c_1^2 + c_2^2 \\right) $$", "answer": "$$ \\boxed{\\frac{\\sigma^2}{4} \\left( \\frac{\\pi^2}{2}(1+\\rho) + c_1^2 + c_2^2 \\right)} $$", "id": "65589"}, {"introduction": "量子比特之间的串扰通常是“状态依赖”的，这意味着一个量子比特上的操作效果会受到其邻近比特状态的影响。本练习模拟了一个用于表征静态 $ZZ$ 串扰的真实实验场景：Ramsey 干涉测量。你将分析当一个“旁观”量子比特被周期性驱动时，一个“传感器”量子比特所感受到的表观频率漂移，并揭示该漂移是如何由驱动脉冲中微小的系统性定时误差引起的 ([@problem_id:65718])。这项练习将让你深入理解如何通过精心设计的实验来揭示和量化多比特系统中相干误差的来源。", "problem": "两个量子比特，标记为 Q1 和 Q2，排列在一个量子处理器中。它们受到静态纵向（`ZZ`）耦合的影响，其相互作用哈密顿量为 $H_{int} = \\frac{\\hbar J_{ZZ}}{4} \\sigma_z^{(1)} \\sigma_z^{(2)}$，其中 $\\sigma_z^{(j)}$ 是量子比特 $j$ 的泡利 Z 算符，$J_{ZZ}$ 是以角频率为单位的耦合强度。\n\n为了表征这种耦合效应，我们在对 Q2 进行主动驱动的同时，对 Q1 进行拉姆齐实验（Ramsey experiment）。实验过程如下：\n1.  两个量子比特都初始化到基态 $|0\\rangle$。因此系统的初始态是 $|0\\rangle_1 |0\\rangle_2$。\n2.  通过一个理想的 $\\pi/2$ 脉冲，将 Q1 置于叠加态 $|+\\rangle_1 = \\frac{1}{\\sqrt{2}}(|0\\rangle_1 + |1\\rangle_1)$。\n3.  同时，在总持续时间 $\\tau$ 内，对 Q2 施加一个绕其 x 轴的周期性理想瞬时 $\\pi$ 脉冲序列（$U_{\\pi}^{(2)} = \\sigma_x^{(2)}$）。该序列旨在将 Q1 与 Q2 动态解耦。\n4.  Q2 上的脉冲序列是周期性的，周期为 $T$，总实验时间是该周期的整数倍，即 $\\tau = M T$，其中 $M$ 是一个大整数。\n5.  理想情况下，每个周期内，在相对于周期开始的 $T/2$ 时刻施加一个脉冲。然而，由于系统性的校准误差，每个脉冲都会延迟一小段时间 $\\delta t$，因此脉冲发生在 $t_k = (k-1)T + T/2 + \\delta t$ 时刻，其中 $k=1, 2, \\dots, M$。假设 $|\\delta t| \\ll T/2$。\n6.  在此序列运行时，Q1 在 Q2 的影响下进行自由演化。\n\n在时间 $\\tau$ 内，该过程对 Q1 的净效应可以用一个形式为 $H_{eff}^{(1)} = -\\frac{\\hbar \\Omega_{app}}{2} \\sigma_z^{(1)}$ 的有效静态哈密顿量来建模。这对应于 Q1 经历一个表观的静态 z 场，从而导致频率偏移。\n\n计算 Q1 的表观角频率偏移 $\\Omega_{app}$。你的答案应以 $J_{ZZ}$、$T$ 和 $\\delta t$ 表示。", "solution": "1.  **相关哈密顿量和定义**\n    *   相互作用哈密顿量：\n        $$H_{int} = \\frac{\\hbar J_{ZZ}}{4}\\,\\sigma_z^{(1)}\\sigma_z^{(2)}$$\n    *   Q2 被绕 x 轴的瞬时 $\\pi$ 脉冲翻转，因此在 Q2 的翻转参考系（toggling frame）中，$\\sigma_z^{(2)}$ 的符号交替变化。\n\n2.  **Q1 上的翻转参考系哈密顿量**\n    在 Q2 上 $\\pi$ 脉冲的翻转参考系中，定义一个符号函数 $s(t)=\\pm 1$，它在每个脉冲处翻转。于是，\n    $$H_{1}(t)=\\frac{\\hbar J_{ZZ}}{4}\\,s(t)\\,\\sigma_z^{(1)}$$\n\n3.  **脉冲时间和分段长度**\n    *   脉冲发生在 $t_k=(k-1)T+T/2+\\delta t$。\n    *   在每个周期 $T$ 内，Q2 经历：\n        *   时间 $T/2+\\delta t$，其中 $s=+1$，\n        *   时间 $T/2-\\delta t$，其中 $s=-1$。\n\n4.  **时间平均哈密顿量**\n    在 $\\tau=M T$ 内，平均符号为：\n    $$\\langle s\\rangle = \\frac{M\\bigl[(T/2+\\delta t) - (T/2-\\delta t)\\bigr]}{M\\,T} = \\frac{2\\,\\delta t}{T}$$\n    因此，\n    $$H_{eff}^{(1)} = \\frac{\\hbar J_{ZZ}}{4}\\,\\langle s\\rangle\\,\\sigma_z^{(1)} = \\frac{\\hbar J_{ZZ}}{4}\\,\\frac{2\\,\\delta t}{T}\\,\\sigma_z^{(1)} = \\frac{\\hbar J_{ZZ}\\,\\delta t}{2T}\\,\\sigma_z^{(1)}$$\n\n5.  **确定表观频率偏移**\n    根据定义，\n    $$H_{eff}^{(1)}=-\\frac{\\hbar\\Omega_{app}}{2}\\,\\sigma_z^{(1)}$$\n    因此，令系数相等可得：\n    $$-\\frac{\\hbar\\Omega_{app}}{2} = \\frac{\\hbar J_{ZZ}\\,\\delta t}{2T} \\quad\\Longrightarrow\\quad \\Omega_{app}=-\\frac{J_{ZZ}\\,\\delta t}{T}$$", "answer": "$$\\boxed{-\\frac{J_{ZZ}\\,\\delta t}{T}}$$", "id": "65718"}, {"introduction": "串扰和校准误差的最终影响体现在它们对量子算法和纠错码性能的破坏上。本练习将探讨一个关键问题：物理层面的串扰如何转化为算法层面的关联错误。你将分析在表面码的稳定子测量过程中，两个辅助量子比特之间的 $ZZ$ 串扰如何导致它们的测量结果（纠错码的“疵群”位）产生非零的协方差 ([@problem_id:65602])。通过这个实践，你将深刻体会到为何抑制串扰对于实现容错量子计算至关重要，因为它直接关系到量子纠错码能否有效处理产生的错误。", "problem": "考虑一个表面码布局的一小部分，其中有两个相邻的Z型辅助量子比特 $A_1$ 和 $A_2$。这些辅助量子比特用于同时测量一组数据量子比特的对易稳定子 $S_1$ 和 $S_2$。稳定子 $S_1$ 是作用在与 $A_1$ 相邻的四个数据量子比特上的泡利-Z算符的乘积，而 $S_2$ 是作用在与 $A_2$ 相邻的数据量子比特上的类似乘积。\n\n每个辅助量子比特的测量方案基于一个使用受控-Z（CZ）门的标准电路。对于一个辅助量子比特 $A_i$ 及其稳定子 $S_i = \\bigotimes_{k \\in \\mathcal{N}(i)} Z_k$（其中 $\\mathcal{N}(i)$ 是相邻数据量子比特的集合），测量电路包括以下步骤：\n1. 将辅助量子比特 $A_i$ 初始化到 $|0\\rangle_i$ 态。\n2. 施加一个哈达玛门 $H_i$。\n3. 在辅助量子比特 $A_i$（控制）和其每个相邻的数据量子比特 $k \\in \\mathcal{N}(i)$ 之间施加一系列CZ门 $CZ_{i,k}$。\n4. 施加一个最终的哈达玛门 $H_i$。\n5. 在计算基 $\\{|0\\rangle_i, |1\\rangle_i\\}$ 下测量辅助量子比特 $A_i$。测量结果 $m_i \\in \\{0, 1\\}$ 揭示了稳定子 $S_i$ 的本征值 $\\lambda_i = (-1)^{m_i}$。\n\n在本问题中，我们分析一个特定的串扰误差的影响。两个辅助量子比特的测量电路同时运行。系统的初始态为 $|\\Psi_{init}\\rangle = |0\\rangle_1 |0\\rangle_2 |\\psi_D\\rangle$，其中 $|\\psi_D\\rangle$ 是一个表示单个错误的数据量子比特的状态。具体来说， $|\\psi_D\\rangle$ 是稳定子 $S_1$ 和 $S_2$ 的共同本征态，其本征值分别为 $\\lambda_1 = -1$ 和 $\\lambda_2 = +1$。即 $S_1|\\psi_D\\rangle = -|\\psi_D\\rangle$ 且 $S_2|\\psi_D\\rangle = +|\\psi_D\\rangle$。\n\n在门操作期间，两个辅助量子比特之间产生了一种寄生的ZZ耦合。这种相干串扰误差可以用一个酉算符 $U_{ZZ}(\\alpha) = \\exp(-i \\frac{\\alpha}{2} Z_1 \\otimes Z_2)$ 来建模，该算符作用于两个辅助量子比特的状态，其中 $\\alpha$ 是一个量化误差强度的小的无量纲参数。为解决本问题，你可以假设此串扰误差作用于辅助量子比特的状态的时机是：在两个稳定子的所有CZ门都施加*之后*，但在对辅助量子比特施加最终的哈达玛门*之前*。\n\n你的任务是计算两个辅助量子比特的测量结果之间的协方差 $\\text{Cov}(m_1, m_2)$，作为误差参数 $\\alpha$ 的函数。协方差定义为 $\\text{Cov}(m_1, m_2) = \\mathbb{E}[m_1 m_2] - \\mathbb{E}[m_1]\\mathbb{E}[m_2]$。", "solution": "问题要求计算在存在ZZ串扰误差的情况下，两个辅助量子比特 $A_1$ 和 $A_2$ 的测量结果之间的协方差 $\\text{Cov}(m_1, m_2)$。\n\n**1. 状态演化——理想情况（作为背景）**\n\n我们首先追踪系统状态在指定电路中的演化。\n初始态为 $|\\Psi_{init}\\rangle = |0\\rangle_1 |0\\rangle_2 |\\psi_D\\rangle$，其中 $S_1|\\psi_D\\rangle = -|\\psi_D\\rangle$ 且 $S_2|\\psi_D\\rangle = +|\\psi_D\\rangle$。\n\n*   **步骤 1：初始哈达玛门**\n    对辅助量子比特施加哈达玛门 $H_1$ 和 $H_2$：\n    $$|\\Psi_1\\rangle = (H_1 \\otimes H_2 \\otimes I_D) |0\\rangle_1 |0\\rangle_2 |\\psi_D\\rangle = \\frac{1}{2}(|0\\rangle_1+|1\\rangle_1) \\otimes (|0\\rangle_2+|1\\rangle_2) \\otimes |\\psi_D\\rangle = |+\\rangle_1 |+\\rangle_2 |\\psi_D\\rangle$$\n    我们可以将其写成叠加态：\n    $$|\\Psi_1\\rangle = \\frac{1}{2} \\sum_{a,b \\in \\{0,1\\}} |a\\rangle_1 |b\\rangle_2 |\\psi_D\\rangle$$\n\n*   **步骤 2：CZ门**\n    作用于 $A_1$ 的一组CZ门构成了一个受控-$S_1$ 操作 $U_{CZ,1}$，其作用为 $|a\\rangle_1 |\\psi_D\\rangle \\to |a\\rangle_1 (S_1)^a |\\psi_D\\rangle$。类似地，作用于 $A_2$ 的CZ门构成了一个受控-$S_2$ 操作 $U_{CZ,2}$。由于这些操作作用于不同的辅助量子比特，它们是对易的。来自CZ门的理想总操作是 $U_{ideal-CZ} = U_{CZ,1} U_{CZ,2}$。\n    $$U_{ideal-CZ} |\\Psi_1\\rangle = \\frac{1}{2} \\sum_{a,b \\in \\{0,1\\}} |a\\rangle_1 |b\\rangle_2 (S_1)^a (S_2)^b |\\psi_D\\rangle$$\n    使用 $|\\psi_D\\rangle$ 的给定性质：\n    $$|\\Psi_{pre-H, ideal}\\rangle = \\frac{1}{2} \\left( |00\\rangle S_1^0 S_2^0 |\\psi_D\\rangle + |01\\rangle S_1^0 S_2^1 |\\psi_D\\rangle + |10\\rangle S_1^1 S_2^0 |\\psi_D\\rangle + |11\\rangle S_1^1 S_2^1 |\\psi_D\\rangle \\right)$$\n    $$|\\Psi_{pre-H, ideal}\\rangle = \\frac{1}{2} \\left( |00\\rangle (1)(1)|\\psi_D\\rangle + |01\\rangle (1)(1)|\\psi_D\\rangle + |10\\rangle (-1)(1)|\\psi_D\\rangle + |11\\rangle (-1)(1)|\\psi_D\\rangle \\right)$$\n    $$|\\Psi_{pre-H, ideal}\\rangle = \\frac{1}{2} \\left( |00\\rangle + |01\\rangle - |10\\rangle - |11\\rangle \\right) |\\psi_D\\rangle$$\n    这个状态可以因式分解为：\n    $$|\\Psi_{pre-H, ideal}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle_1 - |1\\rangle_1) \\otimes \\frac{1}{\\sqrt{2}}(|0\\rangle_2 + |1\\rangle_2) |\\psi_D\\rangle = |-\\rangle_1 |+\\rangle_2 |\\psi_D\\rangle$$\n\n**2. 包含串扰误差的状态演化**\n\n问题指出串扰误差 $U_{ZZ}(\\alpha) = \\exp(-i \\frac{\\alpha}{2} Z_1 Z_2)$ 在CZ门之后作用。因此，施加最终哈达玛门之前的状态是：\n$$|\\Psi_{pre-H, err}\\rangle = U_{ZZ}(\\alpha) |\\Psi_{pre-H, ideal}\\rangle$$\n我们来计算 $U_{ZZ}(\\alpha)$ 对辅助量子比特态 $|-\\rangle_1 |+\\rangle_2 = \\frac{1}{2}(|00\\rangle + |01\\rangle - |10\\rangle - |11\\rangle)$ 的作用。算符 $Z_1 Z_2$ 对态 $|00\\rangle, |11\\rangle$ 的本征值为 $+1$，对态 $|01\\rangle, |10\\rangle$ 的本征值为 $-1$。\n$$U_{ZZ}(\\alpha) |00\\rangle = e^{-i\\alpha/2} |00\\rangle$$\n$$U_{ZZ}(\\alpha) |01\\rangle = e^{i\\alpha/2} |01\\rangle$$\n$$U_{ZZ}(\\alpha) |10\\rangle = e^{i\\alpha/2} |10\\rangle$$\n$$U_{ZZ}(\\alpha) |11\\rangle = e^{-i\\alpha/2} |11\\rangle$$\n将此作用于该状态：\n$$|\\Psi_{pre-H, err}\\rangle = \\frac{1}{2} \\left( e^{-i\\alpha/2}|00\\rangle + e^{i\\alpha/2}|01\\rangle - e^{i\\alpha/2}|10\\rangle - e^{-i\\alpha/2}|11\\rangle \\right) |\\psi_D\\rangle$$\n\n*   **步骤 3：最终哈达玛门**\n    我们现在对辅助量子比特的状态 $|\\Psi_{pre-H, err}\\rangle$ 施加 $H_1 \\otimes H_2$ 来找到测量前的最终状态。经过计算，辅助量子比特的最终状态变为：\n    $$|\\Psi_{final}\\rangle = \\left( \\cos(\\alpha/2)|10\\rangle - i\\sin(\\alpha/2)|01\\rangle \\right) |\\psi_D\\rangle$$\n    这个状态已经归一化，因为 $\\cos^2(\\alpha/2) + \\sin^2(\\alpha/2) = 1$。\n\n**3. 计算协方差**\n\n从最终状态，我们可以求出联合概率 $P(m_1, m_2) = |\\langle m_1 m_2 | \\psi_{anc, final} \\rangle|^2$。\n$$P(0,0) = 0$$\n$$P(0,1) = |-i\\sin(\\alpha/2)|^2 = \\sin^2(\\alpha/2)$$\n$$P(1,0) = |\\cos(\\alpha/2)|^2 = \\cos^2(\\alpha/2)$$\n$$P(1,1) = 0$$\n\n现在我们计算所需的期望值。\n单个结果 $m_i$ 的期望值是其为1的概率。\n$$\\mathbb{E}[m_1] = P(m_1=1) = P(1,0) + P(1,1) = \\cos^2(\\alpha/2) + 0 = \\cos^2(\\alpha/2)$$\n$$\\mathbb{E}[m_2] = P(m_2=1) = P(0,1) + P(1,1) = \\sin^2(\\alpha/2) + 0 = \\sin^2(\\alpha/2)$$\n乘积 $m_1 m_2$ 的期望值是：\n$$\\mathbb{E}[m_1 m_2] = (1 \\cdot 1) \\cdot P(1,1) + (1 \\cdot 0) \\cdot P(1,0) + (0 \\cdot 1) \\cdot P(0,1) + (0 \\cdot 0) \\cdot P(0,0) = P(1,1) = 0$$\n\n最后，我们计算协方差：\n$$\\text{Cov}(m_1, m_2) = \\mathbb{E}[m_1 m_2] - \\mathbb{E}[m_1]\\mathbb{E}[m_2]$$\n$$\\text{Cov}(m_1, m_2) = 0 - (\\cos^2(\\alpha/2))(\\sin^2(\\alpha/2))$$\n$$\\text{Cov}(m_1, m_2) = -\\cos^2(\\alpha/2)\\sin^2(\\alpha/2)$$\n使用倍角公式 $\\sin(\\alpha) = 2\\sin(\\alpha/2)\\cos(\\alpha/2)$，我们可以简化表达式：\n$$\\text{Cov}(m_1, m_2) = -\\frac{1}{4} (2\\sin(\\alpha/2)\\cos(\\alpha/2))^2 = -\\frac{1}{4}\\sin^2(\\alpha)$$", "answer": "$$\n\\boxed{-\\frac{1}{4}\\sin^2(\\alpha)}\n$$", "id": "65602"}]}