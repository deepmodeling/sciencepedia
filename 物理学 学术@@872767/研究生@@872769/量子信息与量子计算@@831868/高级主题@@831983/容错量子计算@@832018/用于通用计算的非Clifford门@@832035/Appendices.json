{"hands_on_practices": [{"introduction": "在容错量子计算中，并非所有门的操作成本都相同。克利福德门（Clifford gates）相对容易实现，而非克利福德门（如 $T$ 门）则资源消耗巨大。因此，“T-count”（即电路中 $T$ 门及其厄米共轭 $T^\\dagger$ 的总数）成为衡量量子算法资源成本的关键指标。本练习旨在通过对一个给定的量子电路进行 T-count 计算，帮助你掌握这一基本而重要的资源估算技能 [@problem_id:105385]。", "problem": "在容错量子计算的背景下，量子线路通常被编译成一个通用门集，该门集由 Clifford 门和一个单一的非 Clifford 门组成，最常用的是 T 门。Clifford 群门（包括 Hadamard 门、相位门 S 和 CNOT 门）可以用相对较低的开销实现，而非 Clifford 门则是资源密集型的。因此，衡量量子算法成本的一个关键指标是其 **T-数**，定义为实现该算法所需的 T 门及其逆门 $T^\\dagger$ 的总数。\n\nT 门是一个单量子比特门，由以下矩阵定义：\n$$\nT = \\begin{pmatrix} 1  0 \\\\ 0  e^{i\\pi/4} \\end{pmatrix}\n$$\n其逆门是 $T^\\dagger = \\begin{pmatrix} 1  0 \\\\ 0  e^{-i\\pi/4} \\end{pmatrix}$。注意，相位门 $S=T^2$ 和 Pauli-Z 门 $Z=S^2$ 被认为是 Clifford 门，因此其 T-数为零。\n\n考虑以下作用于三个量子比特（标记为 $q_1, q_2, q_3$）的量子线路：\n1. 一个 CNOT 门，以 $q_2$ 为控制比特，$q_3$ 为目标比特。\n2. 在量子比特 $q_3$ 上作用一个 $T^\\dagger$ 门。\n3. 一个 CNOT 门，以 $q_1$ 为控制比特，$q_3$ 为目标比特。\n4. 在量子比特 $q_3$ 上作用一个 $T$ 门。\n5. 一个 CNOT 门，以 $q_2$ 为控制比特，$q_3$ 为目标比特。\n6. 在量子比特 $q_3$ 上作用一个 $T^\\dagger$ 门。\n7. 一个 CNOT 门，以 $q_1$ 为控制比特，$q_3$ 为目标比特。\n8. 在量子比特 $q_2$ 上作用一个 $T$ 门。\n9. 在量子比特 $q_3$ 上作用一个 $T$ 门。\n\n计算该量子线路的总 T-数。", "solution": "1. T-数定义为线路中 $T$ 门和 $T^\\dagger$ 门的总数。\n\n2. 列出线路步骤并识别非 Clifford 门：\n   1. $\\mathrm{CNOT}(q_2,q_3)$ → Clifford 门，成本 $0$\n   2. 在 $q_3$ 上的 $T^\\dagger$ 门 → 成本 $1$\n   3. $\\mathrm{CNOT}(q_1,q_3)$ → Clifford 门，成本 $0$\n   4. 在 $q_3$ 上的 $T$ 门 → 成本 $1$\n   5. $\\mathrm{CNOT}(q_2,q_3)$ → Clifford 门，成本 $0$\n   6. 在 $q_3$ 上的 $T^\\dagger$ 门 → 成本 $1$\n   7. $\\mathrm{CNOT}(q_1,q_3)$ → Clifford 门，成本 $0$\n   8. 在 $q_2$ 上的 $T$ 门 → 成本 $1$\n   9. 在 $q_3$ 上的 $T$ 门 → 成本 $1$\n\n3. 将各项成本相加：\n$$\n\\text{T-数} = 1 + 1 + 1 + 1 + 1 = 5.\n$$", "answer": "$$\\boxed{5}$$", "id": "105385"}, {"introduction": "除了作为成本度量，非克利福德门在计算能力上扮演着不可或缺的角色。仅由克利福德门组成的电路，其计算能力受限，无法实现普适量子计算。一个关键的区别在于，非克利福德门是创造“魔术态”和量子纠缠的必要资源。本练习将通过计算一个受控-$R_z(\\pi/4)$门（一种非克利福德操作）作用于乘积态后所产生纠缠的大小（并发度），直观地展示非克利福德门在增强量子计算能力方面的独特作用 [@problem_id:105377]。", "problem": "在量子计算中，一个通用的量子门集合是指能够以任意精度近似任何酉操作的集合。Clifford门虽然重要，但其本身并非通用的，并且可以在经典计算机上被高效地模拟。要实现通用量子计算，至少需要一个非Clifford门。一个常见的选择是$T$门或相关的相位门。\n\n一个双量子比特系统。每个量子比特的状态可以在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 中描述。泡利算符用 $X, Y, Z$ 表示。一个绕z轴的通用单量子比特旋转门由 $R_z(\\phi) = \\exp(-i\\phi Z/2)$ 给出，其中 $\\phi$ 是旋转角。对于 $\\phi = \\pi/4$，此门与非Clifford $T$ 门相关。\n\n一个受控-$R_z(\\phi)$门，记作 $C-R_z(\\phi)$，是一个双量子比特门，其中第一个量子比特作为控制比特，第二个作为目标比特。该门当且仅当控制量子比特处于状态 $|1\\rangle$ 时，才将 $R_z(\\phi)$ 应用于目标量子比特。\n\n一个纯双量子比特态 $|\\psi\\rangle$ 中的纠缠量可以通过其并发度（concurrence）$C(\\psi)$ 来量化。其定义为 $C(\\psi) = |\\langle\\psi|\\tilde{\\psi}\\rangle|$，其中 $|\\tilde{\\psi}\\rangle = (\\sigma_y \\otimes \\sigma_y)|\\psi^*\\rangle$。这里，$\\sigma_y$ 是泡利-Y矩阵，而 $|\\psi^*\\rangle$ 是通过对 $|\\psi\\rangle$ 在计算基 $\\{|00\\rangle, |01\\rangle, |10\\rangle, |11\\rangle\\}$ 中的系数进行复共轭而得到的状态。\n\n一个双量子比特系统被制备在初始的可分离态 $|\\psi_{in}\\rangle = |+\\rangle \\otimes |+\\rangle$ 上，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。然后将 $C-R_z(\\phi)$ 门应用于该系统。\n\n计算在特定旋转角 $\\phi = \\pi/4$ 下最终态的并发度。", "solution": "初始态为 $|\\psi_{\\text{in}}\\rangle = |+\\rangle \\otimes |+\\rangle$，其中 $|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$。因此，\n\n$$\n|\\psi_{\\text{in}}\\rangle = \\left( \\frac{1}{\\sqrt{2}} \\right)^2 (|0\\rangle + |1\\rangle) \\otimes (|0\\rangle + |1\\rangle) = \\frac{1}{2} (|00\\rangle + |01\\rangle + |10\\rangle + |11\\rangle).\n$$\n\n\n应用 $\\phi = \\pi/4$ 的受控-$R_z(\\phi)$ 门。$R_z(\\phi)$ 门定义为 $R_z(\\phi) = \\exp(-i\\phi Z/2)$。对于目标量子比特，\n\n$$\nR_z(\\pi/4)|0\\rangle = e^{-i\\pi/8}|0\\rangle, \\quad R_z(\\pi/4)|1\\rangle = e^{i\\pi/8}|1\\rangle.\n$$\n\n受控-$R_z(\\pi/4)$ 门的作用如下：\n- 当控制量子比特（第一个量子比特）为 $|0\\rangle$ 时，目标量子比特（第二个量子比特）不变。\n- 当控制量子比特为 $|1\\rangle$ 时，将 $R_z(\\pi/4)$ 应用于目标量子比特。\n\n将该门应用于每一项：\n\n$$\n\\begin{aligned}\n|00\\rangle &\\to |00\\rangle, \\\\\n|01\\rangle &\\to |01\\rangle, \\\\\n|10\\rangle &\\to |1\\rangle \\otimes R_z(\\pi/4)|0\\rangle = e^{-i\\pi/8}|10\\rangle, \\\\\n|11\\rangle &\\to |1\\rangle \\otimes R_z(\\pi/4)|1\\rangle = e^{i\\pi/8}|11\\rangle.\n\\end{aligned}\n$$\n\n因此，最终态为\n\n$$\n|\\psi_f\\rangle = \\frac{1}{2} \\left( |00\\rangle + |01\\rangle + e^{-i\\pi/8}|10\\rangle + e^{i\\pi/8}|11\\rangle \\right).\n$$\n\n\n并发度定义为 $C(\\psi) = |\\langle \\psi | \\tilde{\\psi} \\rangle|$，其中 $|\\tilde{\\psi}\\rangle = (\\sigma_y \\otimes \\sigma_y) |\\psi^*\\rangle$。首先，通过对计算基中的系数取复共轭来计算 $|\\psi_f^*\\rangle$：\n\n$$\n|\\psi_f^*\\rangle = \\frac{1}{2} \\left( |00\\rangle + |01\\rangle + e^{i\\pi/8}|10\\rangle + e^{-i\\pi/8}|11\\rangle \\right).\n$$\n\n\n泡利-Y 矩阵为 $\\sigma_y = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}$。因此，$\\sigma_y \\otimes \\sigma_y$ 的作用如下：\n\n$$\n(\\sigma_y \\otimes \\sigma_y) |00\\rangle = -|11\\rangle, \\quad (\\sigma_y \\otimes \\sigma_y) |01\\rangle = |10\\rangle, \\quad (\\sigma_y \\otimes \\sigma_y) |10\\rangle = |01\\rangle, \\quad (\\sigma_y \\otimes \\sigma_y) |11\\rangle = -|00\\rangle.\n$$\n\n将此应用于 $|\\psi_f^*\\rangle$：\n\n$$\n\\begin{aligned}\n(\\sigma_y \\otimes \\sigma_y) |\\psi_f^*\\rangle = \\frac{1}{2} \\left[ (\\sigma_y \\otimes \\sigma_y)|00\\rangle + (\\sigma_y \\otimes \\sigma_y)|01\\rangle + e^{i\\pi/8} (\\sigma_y \\otimes \\sigma_y)|10\\rangle + e^{-i\\pi/8} (\\sigma_y \\otimes \\sigma_y)|11\\rangle \\right] \\\\\n= \\frac{1}{2} \\left[ -|11\\rangle + |10\\rangle + e^{i\\pi/8} |01\\rangle + e^{-i\\pi/8} (-|00\\rangle) \\right] \\\\\n= \\frac{1}{2} \\left( -e^{-i\\pi/8} |00\\rangle + e^{i\\pi/8} |01\\rangle + |10\\rangle - |11\\rangle \\right).\n\\end{aligned}\n$$\n\n所以，\n\n$$\n|\\tilde{\\psi}\\rangle = \\frac{1}{2} \\left( -e^{-i\\pi/8} |00\\rangle + e^{i\\pi/8} |01\\rangle + |10\\rangle - |11\\rangle \\right).\n$$\n\n\n计算内积 $\\langle \\psi_f | \\tilde{\\psi} \\rangle$：\n\n$$\n\\langle \\psi_f | = \\frac{1}{2} \\left( \\langle 00| + \\langle 01| + e^{i\\pi/8} \\langle 10| + e^{-i\\pi/8} \\langle 11| \\right),\n$$\n\n\n$$\n\\begin{aligned}\n\\langle \\psi_f | \\tilde{\\psi} \\rangle = \\left( \\frac{1}{2} \\right) \\left( \\frac{1}{2} \\right) \\left[ \\langle 00| (-e^{-i\\pi/8} |00\\rangle) + \\langle 01| (e^{i\\pi/8} |01\\rangle) + e^{i\\pi/8} \\langle 10| (|10\\rangle) + e^{-i\\pi/8} \\langle 11| (-|11\\rangle) \\right] \\\\\n= \\frac{1}{4} \\left[ -e^{-i\\pi/8} \\langle 00|00\\rangle + e^{i\\pi/8} \\langle 01|01\\rangle + e^{i\\pi/8} \\langle 10|10\\rangle - e^{-i\\pi/8} \\langle 11|11\\rangle \\right] \\\\\n= \\frac{1}{4} \\left[ -e^{-i\\pi/8} (1) + e^{i\\pi/8} (1) + e^{i\\pi/8} (1) - e^{-i\\pi/8} (1) \\right] \\\\\n= \\frac{1}{4} \\left[ -e^{-i\\pi/8} + e^{i\\pi/8} + e^{i\\pi/8} - e^{-i\\pi/8} \\right] \\\\\n= \\frac{1}{4} \\left[ 2e^{i\\pi/8} - 2e^{-i\\pi/8} \\right] \\\\\n= \\frac{1}{2} \\left( e^{i\\pi/8} - e^{-i\\pi/8} \\right).\n\\end{aligned}\n$$\n\n使用 $e^{i\\theta} - e^{-i\\theta} = 2i \\sin \\theta$，\n\n$$\n\\langle \\psi_f | \\tilde{\\psi} \\rangle = \\frac{1}{2} (2i \\sin(\\pi/8)) = i \\sin(\\pi/8).\n$$\n\n绝对值为\n\n$$\nC(\\psi_f) = |i \\sin(\\pi/8)| = |i| \\cdot |\\sin(\\pi/8)| = 1 \\cdot \\sin(\\pi/8),\n$$\n\n因为 $\\sin(\\pi/8) > 0$。因此，\n\n$$\nC(\\psi_f) = \\sin(\\pi/8).\n$$\n\n将 $\\sin(\\pi/8)$ 用根式表示：\n\n$$\n\\sin(\\pi/8) = \\sin(22.5^\\circ) = \\sqrt{\\frac{1 - \\cos(45^\\circ)}{2}} = \\sqrt{\\frac{1 - \\frac{\\sqrt{2}}{2}}{2}} = \\sqrt{\\frac{2 - \\sqrt{2}}{4}} = \\frac{\\sqrt{2 - \\sqrt{2}}}{2}.\n$$\n\n因此，并发度为 $\\frac{\\sqrt{2 - \\sqrt{2}}}{2}$。", "answer": "$$\\boxed{\\dfrac{\\sqrt{2 - \\sqrt{2}}}{2}}$$", "id": "105377"}, {"introduction": "普适量子计算的核心要求是能够实现任意的幺正变换，但这通常是通过近似合成来完成的，而非精确实现。实际的量子编译器会将任意旋转分解为一系列克利福德门和 $T$ 门的组合。这个过程的效率，即所需的 $T$ 门数量，直接影响算法的可行性。本练习将引导你应用一种基于规范有符号数字（CSD）表示的实用算法，来计算近似一个特定 $Z$ 旋转所需的 T-count。通过这个实践，你将了解到如何将一个抽象的旋转角度转化为具体的、可量化的量子门资源成本 [@problem_id:105345]。", "problem": "在容错量子计算领域，任意的单量子比特旋转是通过一个通用容错门集中的门序列来合成的，该门集通常由Clifford门和非Clifford T门组成。T门的数量，即T门数（T-count），是衡量合成线路成本的主要指标。\n\n一个任意的 Z 旋转 $R_z(\\theta) = \\exp(-i\\theta Z/2)$ 通常无法被精确合成。取而代之的是，它被一个可精确合成的旋转 $R_z(\\theta_{approx})$ 来近似。一种常见的方法是用一个二进角度 $\\theta_{approx} = 2\\pi \\frac{m}{2^N}$ 来近似 $\\theta$，其中 $N$ 是一个给定的整数精度参数。整数 $m$ 的选择方式是将目标角度的分数部分四舍五入到最近的二进分数：$m = \\text{round}\\left(2^N \\frac{\\theta}{2\\pi}\\right)$。\n\n对于这样一个角度，旋转 $R_z(\\theta_{approx})$ 可以通过一个由Clifford门和T门组成的线路来合成（在相差一个全局相位的情况下）。一种著名的合成算法产生的T门数由以下公式给出：\n$$ T_{count} = 2 \\cdot |m|_{CSD} - 2 $$\n其中 $|m|_{CSD}$ 是整数 $m$ 的规范有符号数位（CSD）表示法中的汉明权重（非零数字的数量）。整数的CSD表示法是一种基数为2的表示法，其数字来自集合 $\\{-1, 0, 1\\}$，并且没有两个连续的非零数字。例如，3 的 CSD 表示法是 $10\\bar{1}$，其中 $\\bar{1}$ 表示 $-1$，其 CSD 权重为 2。\n\n**问题：**\n计算合成一个 Z 旋转门 $R_z(\\theta)$ 所需的 T 门数，其中角度 $\\theta \\in [0, \\pi]$ 由 $\\cos(\\theta) = 3/5$ 定义。该合成是针对精度参数 $N=10$ 的近似值进行的。假设 T 门数由上述公式给出。", "solution": "问题要求计算合成一个特定 Z 旋转 $R_z(\\theta)$ 的近似所需的 T 门数，其中 $\\cos(\\theta) = 3/5$。T 门数取决于定义近似角度 $\\theta_{approx} = 2\\pi \\frac{m}{2^N}$ 的整数 $m$。\n\n**步骤 1：确定角度 $\\theta$。**\n给定 $\\cos(\\theta) = 3/5$ 且 $\\theta \\in [0, \\pi]$。我们需要找到 $\\theta$ 的值来计算分数 $\\frac{\\theta}{2\\pi}$。\n角度 $\\theta$ 明确为 $\\theta = \\arccos(3/5)$。\n\n**步骤 2：计算整数 $m$。**\n参数 $m$ 由 $m = \\text{round}\\left(2^N \\frac{\\theta}{2\\pi}\\right)$ 确定。给定 $N=10$，所以 $2^N = 1024$。\n$$ m = \\text{round}\\left(1024 \\cdot \\frac{\\arccos(3/5)}{2\\pi}\\right) $$\n首先，我们计算参数的数值：\n$\\theta = \\arccos(3/5) \\approx 0.927295218$ 弧度。\n$$ \\frac{\\theta}{2\\pi} \\approx \\frac{0.927295218}{2 \\pi} \\approx 0.147583617 $$\n现在，我们可以求出 $m$：\n$$ m = \\text{round}(1024 \\cdot 0.147583617) = \\text{round}(151.12501) = 151 $$\n\n**步骤 3：求 $m=151$ 的规范有符号数位（CSD）表示法。**\nCSD 表示法使用数字 $\\{0, 1, \\bar{1}\\}$，其中 $\\bar{1}=-1$，其性质是任意两个连续的数字都不会同时非零。我们可以通过算法找到 $m=151$ 的 CSD 表示法。设 $m_0=151$。\n\n-   $m_0 = 151$。这是奇数。$151 \\pmod 4 = 3$。最后一位是 $\\bar{1}$。$m_1 = (151 - \\bar{1})/2 = (151+1)/2 = 76$。当前的 CSD：$\\bar{1}$。\n-   $m_1 = 76$。这是偶数。下一位是 $0$。$m_2 = 76/2 = 38$。当前的 CSD：$0\\bar{1}$。\n-   $m_2 = 38$。这是偶数。下一位是 $0$。$m_3 = 38/2 = 19$。当前的 CSD：$00\\bar{1}$。\n-   $m_3 = 19$。这是奇数。$19 \\pmod 4 = 3$。下一位是 $\\bar{1}$。$m_4 = (19 - \\bar{1})/2 = (19+1)/2 = 10$。当前的 CSD：$\\bar{1}00\\bar{1}$。\n-   $m_4 = 10$。这是偶数。下一位是 $0$。$m_5 = 10/2 = 5$。当前的 CSD：$0\\bar{1}00\\bar{1}$。\n-   $m_5 = 5$。这是奇数。$5 \\pmod 4 = 1$。下一位是 $1$。$m_6 = (5 - 1)/2 = 2$。当前的 CSD：$10\\bar{1}00\\bar{1}$。\n-   $m_6 = 2$。这是偶数。下一位是 $0$。$m_7 = 2/2 = 1$。当前的 CSD：$010\\bar{1}00\\bar{1}$。\n-   $m_7 = 1$。这是奇数。$1 \\pmod 4 = 1$。下一位是 $1$。$m_8 = (1 - 1)/2 = 0$。当前的 CSD：$1010\\bar{1}00\\bar{1}$。\n\n151 的 CSD 表示法是 $1010\\bar{1}00\\bar{1}$。\n让我们验证一下：$1 \\cdot 2^7 + 0 \\cdot 2^6 + 1 \\cdot 2^5 + 0 \\cdot 2^4 - 1 \\cdot 2^3 + 0 \\cdot 2^2 + 0 \\cdot 2^1 - 1 \\cdot 2^0 = 128 + 32 - 8 - 1 = 160 - 9 = 151$。该表示法是正确的。\n\n**步骤 4：计算 CSD 汉明权重 $|m|_{CSD}$。**\n汉明权重是 CSD 表示法中非零数字的数量。\n对于 $m=151$，CSD 表示为 $1010\\bar{1}00\\bar{1}$。非零数字为 $1, 1, \\bar{1}, \\bar{1}$。\n所以， $|m|_{CSD} = 4$。\n\n**步骤 5：计算最终的 T 门数。**\n使用给定公式 $T_{count} = 2 \\cdot |m|_{CSD} - 2$。\n$$ T_{count} = 2 \\cdot 4 - 2 = 8 - 2 = 6 $$\n合成近似旋转所需的 T 门数为 6。", "answer": "$$ \\boxed{6} $$", "id": "105345"}]}