{"hands_on_practices": [{"introduction": "要真正掌握魔法态蒸馏的威力，我们必须从其核心的数学原理入手。这个练习将带你分析经典的 15-to-1 Bravyi-Kitaev 协议，这是理解容错量子计算中资源优化的基石。通过这个计算，你将亲手验证魔法态蒸馏是如何将多个低质量的输入态提纯为一个高质量的输出态，并揭示其输出错误率与输入错误率之间关键的三次方抑制关系 [@problem_id:105364]。", "problem": "在容错量子计算中，诸如 $T$ 门之类的非 Clifford 门对于实现通用性至关重要。由于这些门难以高保真度地实现，因此采用了“魔法态蒸馏”协议。这些协议将多个含噪声的“魔法态”副本作为输入，并生成一个保真度高得多的单个副本。然后，提纯后的魔法态可用于通过基于隐形传态的电路来实现所需的非 Clifford 门。\n\n$T$ 门 $T = \\begin{pmatrix} 1  0 \\\\ 0  e^{i\\pi/4} \\end{pmatrix}$ 的一个关键魔法态是 $|A\\rangle = T|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$。\n考虑一堆含噪声的魔法态，其中每个态由密度矩阵描述\n$$ \\rho_{in} = (1-\\epsilon) |A\\rangle\\langle A| + \\epsilon |A^{\\perp}\\rangle\\langle A^{\\perp}| $$\n在这里， $|A^{\\perp}\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$ 是与 $|A\\rangle$ 正交的态，而 $\\epsilon$ 是初始错误概率。这些态的初始保真度为 $F_{in} = \\langle A|\\rho_{in}|A\\rangle = 1-\\epsilon$。可以证明，该错误模型等效于一个以概率 $\\epsilon$ 对理想态 $|A\\rangle$ 施加泡利 $Z$ 错误的量子信道。\n\n由 Bravyi 和 Kitaev 首次提出的 15-to-1 魔法态蒸馏协议接收15个 $\\rho_{in}$ 副本，并试图生成一个更高保真度的态 $\\rho_{out}$。该协议基于 [[15, 1, 3]] 量子 Reed-Muller 码。其工作原理是将逻辑态编码到15个物理量子比特中，然后测量该码的稳定子生成元。如果测量纠错子是平凡的（所有结果均为 $+1$），则输出态被接受。否则，它将被丢弃。\n\n为了进行计算，您将需要该协议中使用的 [[15, 1, 3]] 码的以下基本性质，它是一个派生自经典 [15, 11, 3] 汉明码的 CSS 码：\n1.  该码的码距为 $d=3$。这意味着所有影响一个或两个量子比特的错误模式都会被稳定子测量检测到。\n2.  错误模型对应于泡利 $Z$ 错误。一个由一组量子比特 $S$ 上的 $Z$ 算符的乘积组成的错误算符，记作 $Z_S$，如果它与所有稳定子对易，则无法被检测到。对于这个特定的码，当 $S$ 是经典 [15, 11, 3] 汉明码中的一个码字时，就会发生这种情况。\n3.  如果发生未被检测到的错误，它会破坏输出态，导致逻辑错误。这类错误算符的最低权重为3。在 [15, 11, 3] 汉明码中，权重为3的经典码字的数量恰好是35个。\n\n假设初始错误概率 $\\epsilon$ 很小，请计算从 15-to-1 蒸馏协议中得到的输出态 $\\rho_{out}$ 的保真度 $F_{out}$。您的答案应该是一个以 $\\epsilon$ 表示的表达式，精确到 $\\epsilon$ 的最低非零阶。", "solution": "输出态的保真度 $F_{\\text{out}}$ 是在输出态被接受的条件下，该态是正确的概率。当错误模式对应于经典 [15, 11, 3] 汉明码中的一个码字时，协议接受该状态。错误模型以概率 $\\epsilon$ 对每个量子比特独立地施加泡利 $Z$ 错误。\n\n错误模式是零码字的概率是：\n$$\n\\mathrm{Pr}(\\text{no error}) = (1 - \\epsilon)^{15}\n$$\n\n错误模式是权重为 $w$ 的特定非零码字的概率是：\n$$\n\\mathrm{Pr}(\\text{specific codeword of weight } w) = \\epsilon^w (1 - \\epsilon)^{15 - w}\n$$\n\n总接受概率是所有码字的和：\n$$\nP_{\\text{accept}} = \\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}\n$$\n其中 $\\mathcal{C}$ 是汉明码的所有2048个码字的集合。\n\n只有当错误模式为零码字时，输出态才是正确的。因此，保真度为：\n$$\nF_{\\text{out}} = \\frac{\\mathrm{Pr}(\\text{no error})}{P_{\\text{accept}}} = \\frac{(1 - \\epsilon)^{15}}{\\sum_{c \\in \\mathcal{C}} \\epsilon^{w(c)} (1 - \\epsilon)^{15 - w(c)}}\n$$\n\n对于小的 $\\epsilon$，展开到最低非零阶。分子是：\n$$\n(1 - \\epsilon)^{15} = 1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)\n$$\n\n分母包括：\n- 零码字： $(1 - \\epsilon)^{15}$\n- 35个权重为3的码字： $35 \\epsilon^3 (1 - \\epsilon)^{12}$\n- 更高权重的码字，其贡献为 $O(\\epsilon^4)$\n\n因此：\n$$\nP_{\\text{accept}} = (1 - \\epsilon)^{15} + 35 \\epsilon^3 (1 - \\epsilon)^{12} + O(\\epsilon^4)\n$$\n\n展开 $(1 - \\epsilon)^{12}$：\n$$\n(1 - \\epsilon)^{12} = 1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3 + O(\\epsilon^4)\n$$\n\n所以：\n$$\n35 \\epsilon^3 (1 - \\epsilon)^{12} = 35 \\epsilon^3 (1 - 12\\epsilon + 66\\epsilon^2 - 220\\epsilon^3) + O(\\epsilon^4) = 35\\epsilon^3 - 420\\epsilon^4 + O(\\epsilon^4)\n$$\n由于 $\\epsilon^4$ 项被吸收到 $O(\\epsilon^4)$ 中，对于 $\\epsilon^3$ 阶，我们只保留 $35\\epsilon^3$。\n\n然后：\n$$\nP_{\\text{accept}} = [1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3] + 35\\epsilon^3 + O(\\epsilon^4) = 1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n保真度比率为：\n$$\nF_{\\text{out}} = \\frac{1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3 + O(\\epsilon^4)}{1 - 15\\epsilon + 105\\epsilon^2 - 420\\epsilon^3 + O(\\epsilon^4)}\n$$\n\n设 $y = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4)$，所以分母是 $1 - y$。然后：\n$$\n(1 - y)^{-1} = 1 + y + y^2 + y^3 + O(\\epsilon^4)\n$$\n\n计算：\n$$\ny = 15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3 + O(\\epsilon^4)\n$$\n\n$$\ny^2 = (15\\epsilon)^2 + 2(15\\epsilon)(-105\\epsilon^2) + O(\\epsilon^4) = 225\\epsilon^2 - 3150\\epsilon^3 + O(\\epsilon^4)\n$$\n\n$$\ny^3 = (15\\epsilon)^3 + O(\\epsilon^4) = 3375\\epsilon^3 + O(\\epsilon^4)\n$$\n\n所以：\n$$\n(1 - y)^{-1} = 1 + (15\\epsilon - 105\\epsilon^2 + 420\\epsilon^3) + (225\\epsilon^2 - 3150\\epsilon^3) + 3375\\epsilon^3 + O(\\epsilon^4) = 1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3 + O(\\epsilon^4)\n$$\n\n现在乘以分子：\n$$\nF_{\\text{out}} = (1 - 15\\epsilon + 105\\epsilon^2 - 455\\epsilon^3)(1 + 15\\epsilon + 120\\epsilon^2 + 645\\epsilon^3) + O(\\epsilon^4)\n$$\n\n进行乘法运算：\n- $1 \\cdot 1 = 1$\n- $1 \\cdot 15\\epsilon = 15\\epsilon$\n- $1 \\cdot 120\\epsilon^2 = 120\\epsilon^2$\n- $1 \\cdot 645\\epsilon^3 = 645\\epsilon^3$\n- $-15\\epsilon \\cdot 1 = -15\\epsilon$\n- $-15\\epsilon \\cdot 15\\epsilon = -225\\epsilon^2$\n- $-15\\epsilon \\cdot 120\\epsilon^2 = -1800\\epsilon^3$\n- $105\\epsilon^2 \\cdot 1 = 105\\epsilon^2$\n- $105\\epsilon^2 \\cdot 15\\epsilon = 1575\\epsilon^3$\n- $-455\\epsilon^3 \\cdot 1 = -455\\epsilon^3$\n\n对系数求和：\n- 常数项：1\n- $\\epsilon$：$15 - 15 = 0$\n- $\\epsilon^2$：$120 - 225 + 105 = 0$\n- $\\epsilon^3$：$645 - 1800 + 1575 - 455 = -35$\n\n因此：\n$$\nF_{\\text{out}} = 1 - 35\\epsilon^3 + O(\\epsilon^4)\n$$\n\n最低非零阶的修正是 $-35\\epsilon^3$，所以此阶的保真度是 $1 - 35\\epsilon^3$。", "answer": "$$ \\boxed{1 - 35\\epsilon^{3}} $$", "id": "105364"}, {"introduction": "理论模型中的错误通常被简化为理想化的泡利错误，但这与真实世界的物理噪声有所不同。这个练习旨在搭建一座连接物理现实与抽象理论的桥梁。你将面对一个更真实的噪声模型——相位阻尼信道，并需要计算它在一个具体协议中等效的逻辑错误率，最终评估蒸馏的性能 [@problem_id:98576]。这个过程对于培养将复杂物理噪声映射到量子纠错码框架下进行分析的能力至关重要。", "problem": "在量子计算中，非 Clifford 门的容错实现是一项至关重要且资源密集型任务。其中一种主要方法是魔法态蒸馏。本问题涉及 15-to-1 T 态蒸馏协议。\n\n理想的 T 态是一个魔法态，由 $|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$ 给出。假设我们只能制备带噪声的 T 态。噪声是由作用于每个理想 T 态的独立相位阻尼信道引入的。强度为 $\\gamma$ 的相位阻尼信道对单量子比特密度矩阵 $\\rho$ 的作用由 Kraus 算符 $K_0 = \\begin{pmatrix} 1  0 \\\\ 0  \\sqrt{1-\\gamma} \\end{pmatrix}$ 和 $K_1 = \\begin{pmatrix} 0  0 \\\\ 0  \\sqrt{\\gamma} \\end{pmatrix}$ 描述，使得含噪状态为 $\\rho_{in} = K_0 \\rho K_0^\\dagger + K_1 \\rho K_1^\\dagger$。\n\n15-to-1 蒸馏协议以 15 个这样的含噪态 $\\rho_{in}$ 为输入，成功完成后输出一个保真度更高的状态 $\\rho_{out}$。一个状态 $\\rho$ 相对于理想态 $|T\\rangle$ 的保真度为 $F = \\langle T | \\rho | T \\rangle$。\n\n输入 T 态上的噪声可以建模为 T 基 $\\{|T\\rangle, |-T\\rangle\\}$ 中的一个比特翻转信道，其中 $|-T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - e^{i\\pi/4}|1\\rangle)$。也就是说，$\\rho_{in}$ 可以写成 $\\rho_{in} = (1-p)\\rho_T + p\\rho_{-T}$，其中 $\\rho_T=|T\\rangle\\langle T|$，$\\rho_{-T}=|-T\\rangle\\langle -T|$，而 $p$ 是输入错误概率。\n\n如果 15 个输入态上的错误模式未被一组稳定子测量检测到，则蒸馏协议成功。如果错误模式不是底层量子码的逻辑错误，则输出状态是正确的。对于本问题，假设协议成功并得到正确逻辑结果的概率 $P_I(p)$ 由无错误项主导，而成功但得到不正确逻辑结果的概率 $P_Z(p)$ 由权重为 3 的逻辑错误项主导，其重数为 35。这导致了以下关系：\n- $P_I(p) = (1-p)^{15}$\n- $P_Z(p) = 35 p^3 (1-p)^{12}$\n\n输出错误概率由 $p_{out} = \\frac{P_Z(p)}{P_I(p) + P_Z(p)}$ 给出，输出状态为 $\\rho_{out} = (1-p_{out})\\rho_T + p_{out}\\rho_{-T}$。\n\n你的任务是计算输出状态 $\\rho_{out}$ 的保真度 $F_{out}$，作为相位阻尼信道强度 $\\gamma$ 的函数。", "solution": "1.  T 基中的输入错误概率为\n$$p=\\langle -T|\\rho_{in}|-T\\rangle\n=\\sum_{k=0}^1|\\langle -T|K_k|T\\rangle|^2.$$\n利用 $|T\\rangle=\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ e^{i\\pi/4} \\end{pmatrix}$ 和\n$|-T\\rangle=\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -e^{i\\pi/4} \\end{pmatrix}$，可以得到\n$$\\langle -T|K_0|T\\rangle\n=\\frac1{2}\\bigl(1-\\sqrt{1-\\gamma}\\bigr),\\qquad\n\\langle -T|K_1|T\\rangle\n=-\\frac{\\sqrt\\gamma}{2}.$$\n因此\n$$p\n=\\frac1{4}\\bigl(1-\\sqrt{1-\\gamma}\\bigr)^2+\\frac\\gamma4\n=\\frac{1-\\sqrt{1-\\gamma}}2.$$\n\n2.  15-to-1 协议给出\n$$P_I=(1-p)^{15},\\qquad \nP_Z=35\\,p^3(1-p)^{12},\\qquad\np_{\\rm out}=\\frac{P_Z}{P_I+P_Z}.$$\n输出保真度为\n$$F_{out}=1-p_{\\rm out}\n=\\frac{(1-p)^{15}}{(1-p)^{15}+35\\,p^3(1-p)^{12}}\n=\\frac{(1-p)^3}{(1-p)^3+35\\,p^3}.$$\n\n3.  代入 $p=\\frac{1-\\sqrt{1-\\gamma}}2$：\n$$(1-p)=\\frac{1+\\sqrt{1-\\gamma}}2,\\qquad\np=\\frac{1-\\sqrt{1-\\gamma}}2.$$\n因此\n$$F_{out}\n=\\frac{\\bigl(\\frac{1+\\sqrt{1-\\gamma}}2\\bigr)^3}\n{\\bigl(\\frac{1+\\sqrt{1-\\gamma}}2\\bigr)^3\n+35\\bigl(\\frac{1-\\sqrt{1-\\gamma}}2\\bigr)^3}\n=\\frac{(1+\\sqrt{1-\\gamma})^3}{(1+\\sqrt{1-\\gamma})^3\n+35\\,(1-\\sqrt{1-\\gamma})^3}.$$", "answer": "$$\\boxed{\\frac{(1+\\sqrt{1-\\gamma})^3}{(1+\\sqrt{1-\\gamma})^3+35\\,(1-\\sqrt{1-\\gamma})^3}}$$", "id": "98576"}, {"introduction": "一个完整的容错系统不仅要能处理数据量子比特上的错误，还必须考虑到纠错过程本身也可能出错。这个练习将你置于一个现实且具有挑战性的场景：一个错误被成功检测，但由于硬件故障，执行了错误的纠正操作。通过分析这个故障链，你将学会如何追踪物理层面的连续错误，并确定它们最终在逻辑层面造成的复合效应 [@problem_id:98634]。这项技能是评估和设计真正稳健的容错量子计算机所不可或缺的。", "problem": "一个容错量子计算方案使用五量子比特[[5, 1, 3]]纠错码来制备高保真度的T态。该五量子比特码由以下稳定子生成元定义：\n$$ g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I $$\n$$ g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X $$\n$$ g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z $$\n$$ g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z $$\n相应的逻辑泡利算符为：\n$$ \\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X $$\n$$ \\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z $$\n$$ \\bar{Y} = i\\bar{X}\\bar{Z} $$\n\n该协议旨在产生一个逻辑T态，记作$|T\\rangle_L$，它在逻辑基$\\{|0\\rangle_L, |1\\rangle_L\\}$中对应于理想的单量子比特T态$|T\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + e^{i\\pi/4}|1\\rangle)$。\n\n假设在协议的一次运行中，第一个物理量子比特上发生了一个单量子比特泡利Z错误，该错误由算符$E = Z \\otimes I \\otimes I \\otimes I \\otimes I$描述。通过测量稳定子生成元检测到该错误。然而，由于硬件故障，施加了一个不正确的恢复操作。没有进行正确的纠正，而是在第一个物理量子比特上施加了一个泡利X算符，$C = X \\otimes I \\otimes I \\otimes I \\otimes I$。\n\n假设协议如同纠正成功一样继续进行，这意味着该状态随后被后续的逻辑操作处理。初始错误和错误纠正的净效应是一个残留错误算符$E_{res} = C \\cdot E$，作用于编码的逻辑态$|T\\rangle_L$上。物理错误算符在编码空间上的作用等效于相应逻辑泡利算符的作用。该逻辑算符由物理错误算符与逻辑算符$\\bar{X}$和$\\bar{Z}$的对易关系确定。\n\n计算理想逻辑T态$|T\\rangle_L$与逻辑量子比特的末态$|\\psi_{out}\\rangle_L$之间的保真度，$F = |\\langle T|_L |\\psi_{out}\\rangle_L|^2$。", "solution": "残留错误算符为$E_{\\text{res}} = C \\cdot E = (X \\otimes I \\otimes I \\otimes I \\otimes I) \\cdot (Z \\otimes I \\otimes I \\otimes I \\otimes I) = (XZ) \\otimes I \\otimes I \\otimes I \\otimes I$。由于$XZ = -iY$，该残留错误等效于一个作用于第一个量子比特的$Y$算符（忽略全局相位）。该算符与两个逻辑算符$\\bar{X} = X \\otimes X \\otimes X \\otimes X \\otimes X$和$\\bar{Z} = Z \\otimes Z \\otimes Z \\otimes Z \\otimes Z$都反对易，这由它们的对易关系确定。唯一与$\\bar{X}$和$\\bar{Z}$都反对易的逻辑泡利算符是$\\bar{Y} = i \\bar{X} \\bar{Z}$。因此，$E_{\\text{res}}$在逻辑态上的作用等效于$\\bar{Y}$（相差一个不影响保真度的全局相位）。\n\n理想的逻辑T态为$|T\\rangle_L = \\frac{1}{\\sqrt{2}} (|0\\rangle_L + e^{i\\pi/4} |1\\rangle_L)$。经过错误和错误纠正后的状态是$\\bar{Y} |T\\rangle_L$。应用$\\bar{Y}$：\n$$\n\\bar{Y} |0\\rangle_L = i |1\\rangle_L, \\quad \\bar{Y} |1\\rangle_L = -i |0\\rangle_L.\n$$\n\n$$\n\\bar{Y} |T\\rangle_L = \\frac{1}{\\sqrt{2}} \\left( \\bar{Y} |0\\rangle_L + e^{i\\pi/4} \\bar{Y} |1\\rangle_L \\right) = \\frac{1}{\\sqrt{2}} \\left( i |1\\rangle_L - i e^{i\\pi/4} |0\\rangle_L \\right) = \\frac{i}{\\sqrt{2}} \\left( |1\\rangle_L - e^{i\\pi/4} |0\\rangle_L \\right).\n$$\n\n保真度为$F = \\left| \\langle T|_L | \\bar{Y} |T\\rangle_L \\right|^2$。计算内积：\n$$\n\\langle T|_L | \\bar{Y} |T\\rangle_L = \\left( \\frac{\\langle 0|_L + e^{-i\\pi/4} \\langle 1|_L}{\\sqrt{2}} \\right) \\left( \\frac{i}{\\sqrt{2}} \\left( |1\\rangle_L - e^{i\\pi/4} |0\\rangle_L \\right) \\right) = \\frac{i}{2} \\left[ \\langle 0|_L |1\\rangle_L - e^{i\\pi/4} \\langle 0|_L |0\\rangle_L + e^{-i\\pi/4} \\langle 1|_L |1\\rangle_L - e^{-i\\pi/4} e^{i\\pi/4} \\langle 1|_L |0\\rangle_L \\right].\n$$\n使用正交归一性$\\langle a|_L |b\\rangle_L = \\delta_{a,b}$：\n$$\n\\langle T|_L | \\bar{Y} |T\\rangle_L = \\frac{i}{2} \\left[ 0 - e^{i\\pi/4} (1) + e^{-i\\pi/4} (1) - (1) \\cdot 0 \\right] = \\frac{i}{2} \\left( e^{-i\\pi/4} - e^{i\\pi/4} \\right).\n$$\n简化表达式：\n$$\ne^{-i\\pi/4} - e^{i\\pi/4} = -2i \\sin(\\pi/4), \\quad \\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}.\n$$\n\n$$\n\\langle T|_L | \\bar{Y} |T\\rangle_L = \\frac{i}{2} \\left( -2i \\cdot \\frac{\\sqrt{2}}{2} \\right) = \\frac{i}{2} \\left( -i \\sqrt{2} \\right) = \\frac{i \\cdot (-i) \\sqrt{2}}{2} = \\frac{-i^2 \\sqrt{2}}{2} = \\frac{-(-1) \\sqrt{2}}{2} = \\frac{\\sqrt{2}}{2}.\n$$\n模方为：\n$$\nF = \\left| \\frac{\\sqrt{2}}{2} \\right|^2 = \\left( \\frac{\\sqrt{2}}{2} \\right)^2 = \\frac{2}{4} = \\frac{1}{2}.\n$$", "answer": "$$ \\boxed{\\dfrac{1}{2}} $$", "id": "98634"}]}