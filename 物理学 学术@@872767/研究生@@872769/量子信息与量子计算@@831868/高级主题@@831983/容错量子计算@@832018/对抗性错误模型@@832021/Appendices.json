{"hands_on_practices": [{"introduction": "要理解对抗性误差的威力，一个很好的起点是分析它如何影响一个基本的量子操作：纠缠态的制备。这个练习探讨了一个对手如何通过策略性地在量子线路中的不同位置和时间点插入一个相位噪声信道，来最大化地破坏最终产生的GHZ态[@problem_id:44176]。通过这个练习，你将亲身体会到，即使是同一个误差，在不同的时机出现，其破坏效果也可能天差地别。", "problem": "一个用于从初态 $|\\psi_0\\rangle = |000\\rangle$ 制备三量子比特 Greenberger-Horne-Zeilinger (GHZ) 态 $|\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}}(|000\\rangle + |111\\rangle)$ 的标准线路包含一个由三个门组成的序列：\n1.  $G_1$：作用于量子比特1的Hadamard门 ($H_1$)。\n2.  $G_2$：一个受控非门，以量子比特1为控制位，量子比特2为目标位 ($CNOT_{12}$)。\n3.  $G_3$：一个受控非门，以量子比特1为控制位，量子比特3为目标位 ($CNOT_{13}$)。\n\n理想的最终态为 $|\\psi_f\\rangle = G_3 G_2 G_1 |\\psi_0\\rangle = |\\text{GHZ}_3\\rangle$。\n\n考虑一个场景，其中一个对手可以引入一个错误。该错误模型是一个单量子比特退相干通道，由 Kraus 算符 $E_0 = \\sqrt{1-\\gamma}I$ 和 $E_1 = \\sqrt{\\gamma}Z$ 描述，其中 $Z$ 是 Pauli-Z 算符。该通道对密度矩阵 $\\rho$ 的作用是 $\\mathcal{E}_\\gamma(\\rho) = E_0 \\rho E_0^\\dagger + E_1 \\rho E_1^\\dagger = (1-\\gamma)\\rho + \\gamma Z\\rho Z$。\n\n对手的目标是最小化最终态与理想态 $|\\text{GHZ}_3\\rangle$ 的保真度。他们可以在任意一个门 $G_k$（其中 $k \\in \\{1, 2, 3\\}$）之后，立即在任意单个量子比特 $j \\in \\{1, 2, 3\\}$ 上，插入一次退相干通道 $\\mathcal{E}_\\gamma$。\n\n纯态 $|\\psi\\rangle$ 和混合态 $\\sigma$ 之间的保真度由 $F(|\\psi\\rangle, \\sigma) = \\langle\\psi|\\sigma|\\psi\\rangle$ 给出。\n\n计算最坏情况下的保真度 $F_{worst}$，即对手可以实现的最小可能保真度。您的答案应该是一个用退相干强度 $\\gamma$ 表示的表达式。", "solution": "理想态 $ |\\text{GHZ}_3\\rangle $ 与最终态 $ \\sigma $ 之间的保真度由下式给出：\n\n$$\nF(|\\text{GHZ}_3\\rangle, \\sigma) = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle.\n$$\n\n具有 Kraus 算符 $ E_0 = \\sqrt{1-\\gamma} I $ 和 $ E_1 = \\sqrt{\\gamma} Z $ 的退相干通道 $ \\mathcal{E}_\\gamma $ 在门 $ G_k $ 之后，于量子比特 $ j $ 上插入一次。门 $ G_k $ 之后的状态是纯态，记为 $ |\\psi_k\\rangle $。经过该通道后，状态变为：\n\n$$\n\\rho_k = \\mathcal{E}_\\gamma(|\\psi_k\\rangle\\langle\\psi_k|) = (1-\\gamma) |\\psi_k\\rangle\\langle\\psi_k| + \\gamma Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j.\n$$\n\n余下的门 $ U_{\\text{rem}} $ (从 $ G_{k+1} $ 到 $ G_3 $) 被作用，因此最终态为：\n\n$$\n\\sigma = U_{\\text{rem}} \\rho_k U_{\\text{rem}}^\\dagger = (1-\\gamma) U_{\\text{rem}} |\\psi_k\\rangle\\langle\\psi_k| U_{\\text{rem}}^\\dagger + \\gamma U_{\\text{rem}} (Z_j |\\psi_k\\rangle\\langle\\psi_k| Z_j) U_{\\text{rem}}^\\dagger.\n$$\n\n定义：\n- $ |\\phi\\rangle = U_{\\text{rem}} |\\psi_k\\rangle = |\\text{GHZ}_3\\rangle $ (无错误时的理想末态)，\n- $ |\\phi_j\\rangle = U_{\\text{rem}} (Z_j |\\psi_k\\rangle) $ (引入错误并作用余下门之后的态)。\n\n那么：\n\n$$\n\\sigma = (1-\\gamma) |\\phi\\rangle\\langle\\phi| + \\gamma |\\phi_j\\rangle\\langle\\phi_j|.\n$$\n\n保真度为：\n\n$$\nF = \\langle \\text{GHZ}_3 | \\sigma | \\text{GHZ}_3 \\rangle = (1-\\gamma) \\langle \\text{GHZ}_3 | \\phi \\rangle \\langle \\phi | \\text{GHZ}_3 \\rangle + \\gamma \\langle \\text{GHZ}_3 | \\phi_j \\rangle \\langle \\phi_j | \\text{GHZ}_3 \\rangle.\n$$\n\n由于 $ |\\phi\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ \\langle \\text{GHZ}_3 | \\phi \\rangle = 1 $，且：\n\n$$\nF = (1-\\gamma) \\cdot 1 + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 - \\gamma + \\gamma |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2.\n$$\n\n\n现在，我们为每个插入点和量子比特计算 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 $。\n\n- **在 $ G_1 $ (作用于量子比特1的Hadamard门) 之后：**  \n  初态：$ |\\psi_0\\rangle = |000\\rangle $。  \n  经过 $ G_1 $后：$ |\\psi_1\\rangle = H_1 |000\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |100\\rangle) $。  \n  作用 $ Z_j $：  \n  - $ j=1 $：$ Z_1 |\\psi_1\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |100\\rangle) $。  \n    作用 $ G_2 $ (CNOT$_{12}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $。  \n    作用 $ G_3 $ (CNOT$_{13}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。  \n    所以 $ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\frac{1}{2} (\\langle 000|000\\rangle - \\langle 000|111\\rangle + \\langle 111|000\\rangle - \\langle 111|111\\rangle) = \\frac{1}{2}(1 - 0 + 0 - 1) = 0 $。  \n    因此，$ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。  \n  - $ j=2 $：$ Z_2 |\\psi_1\\rangle = |\\psi_1\\rangle $ (无变化，因为第二个量子比特是 $ |0\\rangle $)。  \n    经过 $ G_2 $ 和 $ G_3 $ 后：$ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。  \n  - $ j=3 $：与 $ j=2 $ 类似，$ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。  \n  保真度：$ j=1 $ 时：$ F = 1 - \\gamma $，$ j=2,3 $ 时：$ F = 1 $。\n\n- **在 $ G_2 $ (CNOT$_{12}$) 之后：**  \n  经过 $ G_2 $ 后：$ |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |110\\rangle) $。  \n  作用 $ Z_j $：  \n  - $ j=1 $：$ Z_1 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $。  \n    作用 $ G_3 $ (CNOT$_{13}$): $ \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = 0 $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。  \n  - $ j=2 $：$ Z_2 |\\psi_2\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |110\\rangle) $ (与 $ j=1 $ 的情况相同)。  \n    经过 $ G_3 $ 后：$ |\\phi_j\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。  \n  - $ j=3 $：$ Z_3 |\\psi_2\\rangle = |\\psi_2\\rangle $ (无变化)。  \n    经过 $ G_3 $ 后：$ |\\phi_j\\rangle = |\\text{GHZ}_3\\rangle $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 1 $。  \n  保真度：$ j=1,2 $ 时：$ F = 1 - \\gamma $，$ j=3 $ 时：$ F = 1 $。\n\n- **在 $ G_3 $ (CNOT$_{13}$) 之后：**  \n  经过 $ G_3 $ 后：$ |\\psi_3\\rangle = |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle + |111\\rangle) $。  \n  作用 $ Z_j $ (没有余下的门)：  \n  - $ j=1 $：$ Z_1 |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $。  \n    $ \\langle \\text{GHZ}_3 | \\phi_j \\rangle = \\langle \\text{GHZ}_3 | Z_1 | \\text{GHZ}_3 \\rangle = 0 $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。  \n  - $ j=2,3 $：类似地，$ Z_j |\\text{GHZ}_3\\rangle = \\frac{1}{\\sqrt{2}} (|000\\rangle - |111\\rangle) $，所以 $ |\\langle \\text{GHZ}_3 | \\phi_j \\rangle|^2 = 0 $。  \n  保真度：所有 $ j $：$ F = 1 - \\gamma $。\n\n所有情况下的最小保真度为 $ 1 - \\gamma $，在以下情况达到：\n- 在 $ G_1 $ 之后作用于量子比特1，\n- 在 $ G_2 $ 之后作用于量子比特1或2，\n- 在 $ G_3 $ 之后作用于任意量子比特。\n因此，$ F_{\\text{worst}} = 1 - \\gamma $。", "answer": "$$ \\boxed{1 - \\gamma} $$", "id": "44176"}, {"introduction": "对抗性攻击的目标往往与具体算法的目标函数直接相关。本练习将场景切换到变分量子本征求解器（VQE），其目标是找到哈密顿量的基态能量。在这里，对手的目标不再是简单地降低态保真度，而是通过施加一个相干旋转误差来尽可能地抬高体系的能量期望值，从而直接破坏VQE算法的核心目的[@problem_id:44218]。", "problem": "一个单量子比特系统由哈密顿量 $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$ 描述，其中 $X$ 和 $Z$ 是泡利矩阵，$\\alpha$ 是一个实数参数。为了找到该系统的基态能量，我们采用了一种变分量子本征求解器 (VQE)。该 VQE 使用一个参数化的试验态 $|\\psi(\\theta)\\rangle = U(\\theta)|0\\rangle$，其中 $|0\\rangle$ 是计算基态，酉拟设是绕 y 轴的旋转，$U(\\theta) = R_y(\\theta) = \\exp(-i\\frac{\\theta}{2} Y)$。这里，$Y$ 是泡利-Y 矩阵，$\\theta$ 是变分参数。\n\n假设 VQE 优化已在无噪声环境中成功执行，得到了使能量期望值 $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$ 最小化的最优参数 $\\theta^*$。因此，所得到的状态是哈密顿量的真实基态，即 $|\\psi_{opt}\\rangle = |\\psi(\\theta^*)\\rangle$。\n\n现在，考虑一个对抗性场景，其中一个恶意代理在计算中引入了一个相干误差。这个误差通过在态制备后立即施加一个额外的单量子门 $U_{err}$ 来建模。系统的状态变为 $|\\tilde{\\psi}\\rangle = U_{err}|\\psi_{opt}\\rangle$。该误差门是绕任意轴 $\\vec{n}$（$\\mathbb{R}^3$ 中的单位向量）旋转角度 $\\epsilon$ 的操作，由 $U_{err} = R_{\\vec{n}}(\\epsilon) = \\exp(-i\\frac{\\epsilon}{2} \\vec{n}\\cdot\\vec{\\sigma})$ 给出，其中 $\\vec{\\sigma} = (X, Y, Z)$ 是泡利矩阵的向量。\n\n对手的目标是最大化最终态的能量。他们可以自由选择旋转轴 $\\vec{n}$。你的任务是确定最坏情况下的能量误差 $\\Delta E$，它被定义为对手可实现的最大可能能量期望值与真实基态能量 $E_g$ 之间的差值。\n\n找出这个最坏情况下的能量误差 $\\Delta E = \\left(\\max_{\\vec{n}} \\langle\\tilde{\\psi}|H|\\tilde{\\psi}\\rangle\\right) - E_g$ 作为误差角 $\\epsilon$ 的函数的表达式。", "solution": "哈密顿量为 $H = \\cos(\\alpha) Z + \\sin(\\alpha) X$。其本征值可以通过特征方程求得：\n$$\n\\det(H - \\lambda I) = \\lambda^2 - (\\cos^2 \\alpha + \\sin^2 \\alpha) = \\lambda^2 - 1 = 0,\n$$\n所以本征值为 $\\pm 1$。基态能量为 $E_g = -1$。\n\n基态 $|\\psi_{\\text{opt}}\\rangle$ 的布洛赫向量 $\\vec{v}$ 与哈密顿量向量 $\\vec{h} = (\\sin \\alpha, 0, \\cos \\alpha)$ 反平行，因此 $\\vec{v} = -\\vec{h} = (-\\sin \\alpha, 0, -\\cos \\alpha)$。向量模长 $|\\vec{h}| = \\sqrt{\\sin^2 \\alpha + \\cos^2 \\alpha} = 1$，所以 $\\vec{v} \\cdot \\vec{h} = -1$。\n\n误差门 $U_{\\text{err}} = R_{\\vec{n}}(\\epsilon)$ 将 $|\\psi_{\\text{opt}}\\rangle$ 的布洛赫向量绕轴 $\\vec{n}$ 旋转角度 $\\epsilon$。旋转后的能量期望值为：\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = \\vec{h} \\cdot \\vec{v}',\n$$\n其中 $\\vec{v}' = R_{\\vec{n}}(\\epsilon) \\vec{v}$。\n\n代入 $\\vec{v} = -\\vec{h}$：\n$$\n\\vec{v}' = R_{\\vec{n}}(\\epsilon) (-\\vec{h}).\n$$\n点积变为：\n$$\n\\vec{h} \\cdot \\vec{v}' = \\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) (-\\vec{h})] = -\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}].\n$$\n使用向量 $\\vec{u}$ 绕 $\\vec{n}$ 旋转的公式：\n$$\nR_{\\vec{n}}(\\epsilon) \\vec{u} = \\cos \\epsilon \\, \\vec{u} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{u}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{u}).\n$$\n因此：\n$$\n\\vec{h} \\cdot [R_{\\vec{n}}(\\epsilon) \\vec{h}] = \\vec{h} \\cdot \\left[ \\cos \\epsilon \\, \\vec{h} + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) \\vec{n} + \\sin \\epsilon \\, (\\vec{n} \\times \\vec{h}) \\right].\n$$\n展开点积：\n$$\n= \\cos \\epsilon \\, (\\vec{h} \\cdot \\vec{h}) + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h}) (\\vec{h} \\cdot \\vec{n}) + \\sin \\epsilon \\, \\vec{h} \\cdot (\\vec{n} \\times \\vec{h}).\n$$\n由于 $\\vec{h} \\cdot \\vec{h} = 1$，$\\vec{h} \\cdot (\\vec{n} \\times \\vec{h}) = \\vec{n} \\cdot (\\vec{h} \\times \\vec{h}) = 0$，且 $(\\vec{h} \\cdot \\vec{n})^2 = (\\vec{n} \\cdot \\vec{h})^2$：\n$$\n= \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\n所以：\n$$\n\\vec{h} \\cdot \\vec{v}' = - \\left[ \\cos \\epsilon + (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2 \\right].\n$$\n能量期望值为：\n$$\n\\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon - (1 - \\cos \\epsilon) (\\vec{n} \\cdot \\vec{h})^2.\n$$\n对 $\\vec{n}$ 进行最大化需要最小化 $(\\vec{n} \\cdot \\vec{h})^2$，因为 $1 - \\cos \\epsilon \\geq 0$。最小值为 $0$，当 $\\vec{n}$垂直于 $\\vec{h}$ 时取得。因此：\n$$\n\\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle = -\\cos \\epsilon.\n$$\n最坏情况下的能量误差为：\n$$\n\\Delta E = \\left( \\max_{\\vec{n}} \\langle \\tilde{\\psi} | H | \\tilde{\\psi} \\rangle \\right) - E_g = (-\\cos \\epsilon) - (-1) = 1 - \\cos \\epsilon.\n$$", "answer": "$$\\boxed{1 - \\cos \\epsilon}$$", "id": "44218"}, {"introduction": "最危险的对手是那些深刻理解并利用了我们防御机制规则的对手。这个练习将我们带到量子纠错（QEC）的核心，展示了一个看似能够被纠正的错误如何导致灾难性的逻辑失败。当一个相干的幺正误差（而非简单的比特翻转）发生时，标准的纠错流程可能会被“欺骗”，做出错误的诊断并实施一个使情况恶化的“修正”操作[@problem_id:44216]，最终导致逻辑量子比特的保真度降为零。", "problem": "5 量子比特量子纠错码是能够保护单个逻辑量子比特免受任意单量子比特错误影响的最小码。它是一种稳定子码，由作用于五个物理量子比特上的一组四个对易的稳定子生成元定义：\n$g_1 = X \\otimes Z \\otimes Z \\otimes X \\otimes I$\n$g_2 = I \\otimes X \\otimes Z \\otimes Z \\otimes X$\n$g_3 = X \\otimes I \\otimes X \\otimes Z \\otimes Z$\n$g_4 = Z \\otimes X \\otimes I \\otimes X \\otimes Z$\n\n码空间是完整的 5-量子比特希尔伯特空间的一个二维子空间，其中所有态 $|\\bar{\\psi}\\rangle$ 都是所有四个稳定子生成元的同时+1本征态，即对于 $i=1, 2, 3, 4$，有 $g_i |\\bar{\\psi}\\rangle = |\\bar{\\psi}\\rangle$。\n\n考虑一个在码空间内制备的处于任意态 $|\\bar{\\psi}\\rangle$ 的逻辑量子比特。该量子比特在第一个物理量子比特（标记为索引 1）上受到一个相干错误，该错误由幺正算符 $U_E(\\epsilon) = \\exp(i\\epsilon Y_1)$ 描述，其中 $Y_1$ 是作用于第一个量子比特的泡利-Y 算符，$\\epsilon$ 是一个实数参数。\n\n此错误发生后，系统尝试进行一次恢复操作。然而，由于控制逻辑的故障，所施加的操作是 $C = X_1$，即作用于第一个量子比特的泡利-X 算符。对于 $Y_1$ 错误，这不是正确的恢复操作。\n\n系统的最终状态是 $|\\bar{\\psi}_{final}\\rangle = C U_E(\\epsilon) |\\bar{\\psi}\\rangle$。\n\n计算逻辑保真度 $F$，其定义为最终状态与初始状态的交叠的平方：\n$$F = \\left| \\langle\\bar{\\psi}|\\bar{\\psi}_{final}\\rangle \\right|^2$$\n您的任务是找到 $F$ 关于参数 $\\epsilon$ 的最终表达式。逻辑保真度的一个已知属性是，结果应与码空间中的特定初始态 $|\\bar{\\psi}\\rangle$ 无关。", "solution": "1. 量子比特 1 上的错误幺正算符为\n$$U_E(\\epsilon)=\\exp\\bigl(i\\epsilon Y_1\\bigr)=\\cos\\epsilon\\,I_1+i\\sin\\epsilon\\,Y_1\\,. $$\n2. 错误的恢复操作是 $C=X_1$，因此最终状态为\n$$|\\bar\\psi_{\\rm final}\\rangle\n=X_1\\,U_E(\\epsilon)\\,|\\bar\\psi\\rangle\n=X_1\\bigl(\\cos\\epsilon\\,I_1+i\\sin\\epsilon\\,Y_1\\bigr)|\\bar\\psi\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n+i\\sin\\epsilon\\,X_1Y_1|\\bar\\psi\\rangle\\,. $$\n3. 使用泡利乘法 $X_1Y_1=iZ_1$，上式变为\n$$|\\bar\\psi_{\\rm final}\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n+i\\sin\\epsilon\\,(iZ_1)|\\bar\\psi\\rangle\n=\\cos\\epsilon\\,X_1|\\bar\\psi\\rangle\n-\\sin\\epsilon\\,Z_1|\\bar\\psi\\rangle\\,. $$\n4. 逻辑保真度为\n$$F\n=\\bigl|\\langle\\bar\\psi|\\bar\\psi_{\\rm final}\\rangle\\bigr|^2\n=\\bigl|\\cos\\epsilon\\,\\langle\\bar\\psi|X_1|\\bar\\psi\\rangle\n-\\sin\\epsilon\\,\\langle\\bar\\psi|Z_1|\\bar\\psi\\rangle\\bigr|^2\\,. $$\n5. 在任何稳定子码中，单量子比特泡利算符（$X_1$ 或 $Z_1$）将码空间映射到正交子空间，因此\n$$\\langle\\bar\\psi|X_1|\\bar\\psi\\rangle\n=\\langle\\bar\\psi|Z_1|\\bar\\psi\\rangle=0\\,. $$\n因此\n$$F=0\\,. $$", "answer": "$$\\boxed{0}$$", "id": "44216"}]}