{"hands_on_practices": [{"introduction": "要理解量子密钥分发 (QKD) 的安全性，最好的起点是分析一个具体的攻击策略。此练习将探讨“拦截-重发”攻击，这是窃听者 Eve 可能采用的最直观的策略。通过计算此攻击在 BB84 协议中引入的量子比特错误率 (QBER)，我们将亲手验证量子力学的一个核心原则：信息增益必然伴随着扰动。这个计算将清晰地展示 Eve 的窃听行为如何不可避免地在 Alice 和 Bob 的密钥中留下可被检测的痕迹。[@problem_id:171243]", "problem": "在用于量子密钥分发 (QKD) 的 BB84 协议中，Alice 向 Bob 发送一个单量子比特序列。对于每个量子比特，她随机并独立地选择在两个基中的一个来编码一个比特：直角基 (Z基)，其本征态为 $\\{|0\\rangle, |1\\rangle\\}$，或对角基 (X基)，其本征态为 $\\{|+\\rangle, |-\\rangle\\}$。这些状态定义如下：\n$$\n|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n$$\n|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle), \\quad |-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)\n$$\n对于每个传入的量子比特，Bob 也随机并独立地选择在 Z基或 X基中进行测量。传输结束后，Alice 和 Bob 通过一个公共信道通信，比较他们用于每个量子比特的基。他们只保留那些基选择匹配的比特，形成“筛选密钥”。量子比特错误率 (QBER) 是指在该筛选密钥中，Alice 和 Bob 之间不同的比特所占的比例。\n\n一个窃听者 Eve 执行一种对称的拦截-重发攻击。对于 Alice 发送的每个量子比特，Eve 将其拦截，以相等的概率在Z基或X基中进行测量，然后将一个根据她测量到的状态制备的新量子比特发送给 Bob。假设 Eve 对每个量子比特的基选择是随机且独立的。\n\n计算 Eve 的攻击所引起的预期 QBER。", "solution": "在带有 Eve 对称拦截-重发攻击的 BB84 协议中，预期的量子比特错误率 (QBER) 是指，对于筛选密钥中的一个量子比特（其中 Alice 和 Bob 使用了相同的基），Bob 的测量结果与 Alice 发送的比特不同的概率。筛选密钥的条件是 Alice 和 Bob 选择了相同的基。\n\n考虑单个量子比特的传输。由于对称性，不失一般性地假设 Alice 使用直角基（Z基）。Alice 以 $\\frac{1}{2}$ 的等概率发送 $|0\\rangle$ 或 $|1\\rangle$。将比特固定为 $|0\\rangle$（根据对称性，对于 $|1\\rangle$，错误概率是相同的）。Eve 拦截并随机选择一个基：以 $\\frac{1}{2}$ 的概率选择 Z基，或以 $\\frac{1}{2}$ 的概率选择 X基。\n\n- **情况1：Eve 选择 Z基（概率为 $\\frac{1}{2}$）**  \n  Eve 在 Z基中测量 $|0\\rangle$，得到 $|0\\rangle$ 并将 $|0\\rangle$ 发送给 Bob。  \n  Bob 在 Z基中测量（以筛选密钥为条件），必然得到 $0$。错误概率为 $0$。\n\n- **情况2：Eve 选择 X基（概率为 $\\frac{1}{2}$）**  \n  Eve 在 X基中测量 $|0\\rangle$：  \n  - 以 $\\frac{1}{2}$ 的概率得到 $|+\\rangle$，并将 $|+\\rangle$ 发送给 Bob。  \n  - 以 $\\frac{1}{2}$ 的概率得到 $|-\\rangle$，并将 $|-\\rangle$ 发送给 Bob。  \n  Bob 在 Z基中测量：  \n  - 对于 $|+\\rangle$，Bob 得到 $0$ 或 $1$ 的概率各为 $\\frac{1}{2}$。如果得到 $1$ 则发生错误（概率为 $\\frac{1}{2}$）。  \n  - 对于 $|-\\rangle$，Bob 得到 $0$ 或 $1$ 的概率各为 $\\frac{1}{2}$。如果得到 $1$ 则发生错误（概率为 $\\frac{1}{2}$）。  \n  因此，在 Eve 选择 X基的条件下，错误概率为：  \n  $$\n  \\frac{1}{2} \\cdot \\frac{1}{2} + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n  $$\n\n总的错误概率，在给定 Alice 发送 $|0\\rangle$ 且 Bob 在 Z基中测量的情况下，为：  \n$$\nP(\\text{error} \\mid \\text{Alice Z, Bob Z}) = P(\\text{Case 1}) \\cdot 0 + P(\\text{Case 2}) \\cdot \\frac{1}{2} = \\frac{1}{2} \\cdot 0 + \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}.\n$$\n\n根据对称性，如果 Alice 使用对角基（X基），发送 $|+\\rangle$ 或 $|-\\rangle$，那么在 Bob 也使用 X基的条件下，错误概率也为 $\\frac{1}{4}$。由于筛选密钥只包含相同基的量子比特，并且对于两种基的选择，条件错误概率均为 $\\frac{1}{4}$，因此预期的 QBER 为 $\\frac{1}{4}$。", "answer": "$$\\boxed{\\dfrac{1}{4}}$$", "id": "171243"}, {"introduction": "在实践中，Alice 和 Bob 无法检查他们所有的量子比特来发现错误，因为这会消耗掉全部密钥。因此，他们必须随机牺牲一小部分“测试密钥”来估算整个信道的 QBER。本练习将统计学工具与 QKD 安全性直接联系起来，我们将运用霍夫丁不等式 (Hoeffding's inequality) 来确定需要多大的测试密钥，才能以给定的置信度将真实 QBER 控制在可接受的精度范围内。这是从理论转向实用 QKD 系统安全评估的关键一步。[@problem_id:171195]", "problem": "在BB84量子密钥分发（QKD）协议中，Alice向Bob发送量子态，Bob对其进行测量。随后，他们通过公开通信来宣布各自用于制备和测量的基，并丢弃所有基不匹配的实例，这个过程称为“筛选”过程。由此产生“筛选密钥”。\n\n为确保协议的安全性，Alice和Bob必须估计量子比特错误率（QBER），记为$Q$。QBER是筛选密钥中，双方比特值不一致的部分所占的比例。窃听者的干预将不可避免地增加该错误率。为了估计$Q$，他们牺牲筛选密钥中一个随机选择的大小为$m$的子集，称为“测试密钥”。他们公开比较该测试密钥中的比特值，以计算经验QBER，$\\hat{Q}$。这个$\\hat{Q}$作为整个信道上真实QBER，$Q$，的估计值。\n\n该估计的准确性是一个概率性陈述。Alice和Bob要求他们的估计值$\\hat{Q}$与真实值$Q$接近，具体来说是$|\\hat{Q} - Q| \\leq \\delta$，其中$\\delta$是期望的精度。他们希望这个条件能以高概率成立，即出现更大误差的概率$P(|\\hat{Q} - Q| > \\delta)$不应超过一个小的“参数估计”安全参数$\\epsilon_{PE}$。因此，置信水平为$1 - \\epsilon_{PE}$。\n\n这个问题可以使用霍夫丁不等式来解决，该不等式为一组独立随机变量的样本均值与其期望值偏离的概率设定了上界。对于$m$个在区间$[a, b]$内有界的独立同分布（i.i.d.）随机变量$X_1, \\dots, X_m$及其样本均值$\\bar{X} = \\frac{1}{m}\\sum_{i=1}^m X_i$，霍夫丁不等式表述为：\n$$P(|\\bar{X} - E[\\bar{X}]| \\geq \\delta) \\leq 2 \\exp\\left( - \\frac{2m\\delta^2}{(b-a)^2} \\right)$$\n其中$E[\\bar{X}]$是其背后分布的真实均值。\n\n使用此不等式，确定在精度为$\\delta$、置信水平至少为$1-\\epsilon_{PE}$的条件下，估计QBER $Q$所需的测试密钥的最小大小$m$。将你的答案表示为$\\delta$和$\\epsilon_{PE}$的函数。", "solution": "为了估计BB84协议中测试密钥的最小大小$m$，我们使用霍夫丁不等式。经验量子比特错误率（QBER）$\\hat{Q}$是$m$个独立伯努利随机变量$X_i$的样本均值，其中每个$X_i$代表测试密钥中的一个错误：\n\n$$\nX_i = \n\\begin{cases} \n1  \\text{概率为 } Q, \\\\\n0  \\text{概率为 } 1 - Q.\n\\end{cases}\n$$\n\n因此，$\\hat{Q} = \\frac{1}{m} \\sum_{i=1}^m X_i$，且$E[\\hat{Q}] = Q$。随机变量$X_i$有界于$[0, 1]$，所以$a = 0$且$b = 1$。\n\n霍夫丁不等式表述为：\n\n$$\nP(|\\hat{Q} - Q| \\geq \\delta) \\leq 2 \\exp\\left( - \\frac{2m\\delta^2}{(b-a)^2} \\right).\n$$\n\n代入$b - a = 1$：\n\n$$\nP(|\\hat{Q} - Q| \\geq \\delta) \\leq 2 \\exp(-2m\\delta^2).\n$$\n\nAlice和Bob要求这个概率至多为$\\epsilon_{PE}$：\n\n$$\n2 \\exp(-2m\\delta^2) \\leq \\epsilon_{PE}.\n$$\n\n解出$m$：\n\n$$\n\\exp(-2m\\delta^2) \\leq \\frac{\\epsilon_{PE}}{2},\n$$\n\n\n$$\n-2m\\delta^2 \\leq \\ln\\left( \\frac{\\epsilon_{PE}}{2} \\right),\n$$\n\n\n$$\n2m\\delta^2 \\geq -\\ln\\left( \\frac{\\epsilon_{PE}}{2} \\right) = \\ln\\left( \\frac{2}{\\epsilon_{PE}} \\right),\n$$\n\n\n$$\nm \\geq \\frac{\\ln\\left( \\frac{2}{\\epsilon_{PE}} \\right)}{2\\delta^2}.\n$$\n\n满足此边界的最小$m$由上述表达式给出。", "answer": "$$ \\boxed{ \\dfrac{ \\ln \\left( \\dfrac{2}{\\epsilon_{PE}} \\right) }{ 2 \\delta^{2} } } $$", "id": "171195"}, {"introduction": "我们实践的最后一步是将可观测的信道参数（即 QBER）与最终密钥的安全性联系起来。熵不确定性原理为“扰动”与“信息”之间的权衡提供了严格的数学描述。本练习利用 Maassen-Uffink 熵不确定性关系，根据在共轭基下测得的 QBER，推导出 Eve 所能获得信息量的下界，即条件最小熵 $H_{min}(A|E)$。这个量直接决定了隐私放大的强度，是确保最终密钥安全性的核心依据。[@problem_id:143203]", "problem": "在BB84量子密钥分发（QKD）协议的背景下，最终密钥的安全性从根本上受限于窃听者Eve（E）能从Alice（A）传输给Bob（B）的原始密钥中获取的信息。这种信息泄露可以使用熵不确定性关系进行量化和限定。\n\n考虑一个BB84协议的实现，其中Alice制备并向Bob发送单量子比特态。她的原始密钥比特被编码在计算基或Z基（$\\{|0\\rangle, |1\\rangle\\}$）中。为探测窃听，Alice和Bob公开比较他们在一个随机子集上的比特，这些比特是在共轭基或X基（$\\{|+\\rangle, |-\\rangle\\}$，其中$|\\pm\\rangle = (|0\\rangle \\pm |1\\rangle)/\\sqrt{2}$）上制备和测量的。通过这个比较，他们确定了X基上的量子比特错误率（QBER），记为$Q_X$。\n\n安全性的一个关键量是给定Eve的量子旁路信息下，Alice比特的条件最小熵$H_{min}(A|E)$。这个量化了从Eve的角度来看Alice比特的不可预测性。安全密钥率与该量的一个下界成正比。\n\n用于此分析的一个强大工具是带有量子旁路信息的熵不确定性关系。对于任何三体纯态$|\\Psi\\rangle_{ABE}$，Alice在Z基和X基上测量结果的条件冯·诺依曼熵的界限如下：\n$$S(Z_A|E) + S(X_A|B) \\ge 1$$\n此处，$S(M_A|S)$ 是给定系统$S$（其中$S \\in \\{B, E\\}$）时，Alice在测量$M$（其中$M \\in \\{X, Z\\}$）上的结果的条件冯·诺依曼熵。所有熵都使用以2为底的对数计算。\n\n**问题：**\n假设 (i) Alice和Bob之间在X基上的有效量子信道表现为一个交叉（错误）概率为$Q_X$的二进制对称信道，以及 (ii) 为了推导安全性界限，条件冯·诺依曼熵$S(A|E)$可作为条件最小熵$H_{min}(A|E)$的一个紧下界，请确定$H_{min}(A|E)$的下界，该下界是观测到的QBER $Q_X$的函数。请用$Q_X$和以2为底的对数来表示你的答案。", "solution": "我们已知关于条件冯·诺依曼熵的熵不确定性关系：\n$$ S(Z_A|E) + S(X_A|B) \\geq 1 $$\n其中$S(M_A|S)$是给定系统$S$时，Alice在测量$M$上的结果的条件冯·诺依曼熵，且熵以2为底。\n\n目标是找到条件最小熵$H_{\\min}(A|E)$的一个下界，根据题设，它的下界是$S(Z_A|E)$。因此，我们专注于求$S(Z_A|E)$的界。\n\n根据不确定性关系：\n$$ S(Z_A|E) \\geq 1 - S(X_A|B) $$\n\n现在我们将$S(X_A|B)$用量子比特错误率$Q_X$来表示。题目指出，在X基上的有效量子信道是一个交叉概率为$Q_X$的二进制对称信道。这意味着：\n- Alice在X基上均匀地制备一个比特$a \\in \\{0,1\\}$，因此$P(X_A = a) = \\frac{1}{2}$。\n- Bob的测量结果$b \\in \\{0,1\\}$满足$P(X_B = b \\mid X_A = a) = \\begin{cases} 1 - Q_X  \\text{如果 } b = a \\\\ Q_X  \\text{如果 } b \\neq a \\end{cases}$。\n\n联合概率分布为：\n$$ P(X_A = 0, X_B = 0) = \\frac{1}{2}(1 - Q_X), \\quad P(X_A = 0, X_B = 1) = \\frac{1}{2}Q_X $$\n$$ P(X_A = 1, X_B = 0) = \\frac{1}{2}Q_X, \\quad P(X_A = 1, X_B = 1) = \\frac{1}{2}(1 - Q_X) $$\n\n对于这个经典-量子态（其中$X_A$是经典的，$B$是量子的，但态在X基上是对角的），条件冯·诺依曼熵$S(X_A|B)$等于经典条件熵$H(X_A | X_B)$，因为Bob在X基上的测量产生了捕获相关信息的经典结果。\n\n$X_B$的边际分布为：\n$$ P(X_B = 0) = P(X_A=0, X_B=0) + P(X_A=1, X_B=0) = \\frac{1}{2}(1 - Q_X) + \\frac{1}{2}Q_X = \\frac{1}{2} $$\n$$ P(X_B = 1) = \\frac{1}{2} $$\n\n条件熵$H(X_A | X_B = b)$为：\n- 对于$X_B = 0$：\n  $$ P(X_A = 0 | X_B = 0) = \\frac{P(X_A=0, X_B=0)}{P(X_B=0)} = 1 - Q_X $$\n  $$ P(X_A = 1 | X_B = 0) = Q_X $$\n  其熵为$h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X)$（二元熵函数）。\n- 对于$X_B = 1$：\n  $$ P(X_A = 0 | X_B = 1) = Q_X $$\n  $$ P(X_A = 1 | X_B = 1) = 1 - Q_X $$\n  其熵也为$h_2(Q_X)$。\n\n因此：\n$$ H(X_A | X_B) = P(X_B=0) h_2(Q_X) + P(X_B=1) h_2(Q_X) = \\frac{1}{2} h_2(Q_X) + \\frac{1}{2} h_2(Q_X) = h_2(Q_X) $$\n所以：\n$$ S(X_A|B) = h_2(Q_X) = -Q_X \\log_2 Q_X - (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n代入不确定性关系中：\n$$ S(Z_A|E) \\geq 1 - h_2(Q_X) = 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n因为$H_{\\min}(A|E) \\geq S(Z_A|E)$（根据题设，这是一个紧下界），我们有：\n$$ H_{\\min}(A|E) \\geq 1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X) $$\n\n这就是用$Q_X$和以2为底的对数表示的下界。", "answer": "$$ \\boxed{1 + Q_X \\log_2 Q_X + (1 - Q_X) \\log_2 (1 - Q_X)} $$", "id": "143203"}]}