{"hands_on_practices": [{"introduction": "该练习是应用马西森法则的基础入门。通过在德鲁德模型中结合与温度无关的杂质散射和与温度相关的电子-声子散射，您将推导出金属总电阻率的经典表达式 [@problem_id:153348]。这项练习巩固了电阻率相加性的概念，并为理解不同散射机制如何影响输运性质建立了一个基准模型。", "problem": "考虑一个单价金属，其电导可以用德鲁德模型来描述。载流子是电子，其有效质量为 $m$，电荷为 $-e$。导电电子的数密度为 $n$，其特征速度为费米速度 $v_F$。\n\n金属的总电阻率来自两种主要的散射机制：静态杂质散射和晶格热振动（声子）散射。根据马西森法则，总散射率是各散射率之和。\n\n这些散射机制的有效性可以通过它们各自的平均自由程来表征：\n1.  电子-杂质散射的平均自由程 $\\lambda_i$ 是一个与温度无关的常数。\n2.  电子-声子散射的平均自由程 $\\lambda_{ph}$ 与温度有关。在高温区，它可以很好地用关系式 $\\lambda_{ph}(T) = A/T$ 来近似，其中 $A$ 是一个与材料相关的常数，单位为长度-温度，而 $T$ 是绝对温度。\n\n假设德鲁德模型和马西森法则有效，推导金属的总电阻率 $\\rho(T)$ 作为温度 $T$ 的函数的表达式。用给定的参数 $m$、$n$、$e$、$v_F$、$\\lambda_i$ 和 $A$ 来表示你的答案。", "solution": "在德鲁德模型中，电阻率由下式给出：\n\n$$\n\\rho = \\frac{m}{n e^2 \\tau}\n$$\n\n其中 $\\tau$ 是总弛豫时间。马西森法则指出，总散射率是各散射率之和：\n\n$$\n\\frac{1}{\\tau} = \\frac{1}{\\tau_i} + \\frac{1}{\\tau_{ph}}\n$$\n\n每种机制的弛豫时间与平均自由程的关系如下：\n\n$$\n\\tau_i = \\frac{\\lambda_i}{v_F}, \\quad \\tau_{ph} = \\frac{\\lambda_{ph}}{v_F}\n$$\n\n因此，散射率为：\n\n$$\n\\frac{1}{\\tau_i} = \\frac{v_F}{\\lambda_i}, \\quad \\frac{1}{\\tau_{ph}} = \\frac{v_F}{\\lambda_{ph}}\n$$\n\n代入马西森法则：\n\n$$\n\\frac{1}{\\tau} = \\frac{v_F}{\\lambda_i} + \\frac{v_F}{\\lambda_{ph}} = v_F \\left( \\frac{1}{\\lambda_i} + \\frac{1}{\\lambda_{ph}} \\right)\n$$\n\n已知 $\\lambda_i$ 是常数且 $\\lambda_{ph}(T) = \\frac{A}{T}$：\n\n$$\n\\frac{1}{\\lambda_{ph}} = \\frac{T}{A}\n$$\n\n所以：\n\n$$\n\\frac{1}{\\tau} = v_F \\left( \\frac{1}{\\lambda_i} + \\frac{T}{A} \\right)\n$$\n\n电阻率为：\n\n$$\n\\rho(T) = \\frac{m}{n e^2} \\cdot \\frac{1}{\\tau} = \\frac{m}{n e^2} \\cdot v_F \\left( \\frac{1}{\\lambda_i} + \\frac{T}{A} \\right)\n$$\n\n整理得：\n\n$$\n\\rho(T) = \\frac{m v_F}{n e^2} \\left( \\frac{1}{\\lambda_i} + \\frac{T}{A} \\right)\n$$", "answer": "$$ \\boxed{\\dfrac{m v_F}{n e^{2}} \\left( \\dfrac{1}{\\lambda_i} + \\dfrac{T}{A} \\right)} $$", "id": "153348"}, {"introduction": "该练习超越了简单的德鲁德模型，深入探讨了由费米液体理论描述的金属的低温特性。您将分析一个包含与 $T^2$ 成正比项的电阻率，该项源于电子-电子散射 [@problem_id:2982995]。这个问题要求您将宏观测量与微观散射速率联系起来，并思考电子-电子相互作用对电阻率产生贡献的理论条件。", "problem": "一个纯净、单能带、各向同性的金属在远低于由费米能设定的特征尺度的温度 $T$ 下，其测得的电阻率具有 $\\rho(T)=\\rho_{0}+A T^{2}$ 的形式。假设导电电子可用一个有效质量为 $m$、载流子密度为 $n$、电荷为 $-e$ 的单一抛物线能带描述。在弛豫时间近似内，假设总动量弛豫散射率是一个与温度无关的电子-杂质贡献和一个与温度相关的、与 $T^{2}$ 成正比的电子-电子贡献之和。\n\n仅从电场中载流子的牛顿第二定律、电流密度的定义以及散射率的加和性（马西森法则）出发，推导电子-电子散射率与电子-杂质散射率之比 $\\Gamma_{\\mathrm{ee}}(T)/\\Gamma_{\\mathrm{imp}}$ 的一个显式解析表达式，该表达式仅用 $\\rho_{0}$、$A$ 和 $T$ 表示。清晰地陈述将测得的 $\\rho(T)$ 与微观散射率联系起来所需的任何假设。\n\n在你的推理中，评估在低温下观测到的 $T^{2}$ 贡献是否与德鲁德类型描述的假设一致，并说明在何种微观条件下，电子-电子散射可以对金属的电阻率产生贡献。最终报告的结果必须是 $\\Gamma_{\\mathrm{ee}}(T)/\\Gamma_{\\mathrm{imp}}$ 作为 $\\rho_{0}$、$A$ 和 $T$ 的函数的单一闭合形式表达式。最终表达式不需要单位，也不需要进行数值计算。", "solution": "我们从牛顿第二定律应用于稳态下的平均载流子开始。电场 $\\mathbf{E}$ 施加的力 $-e\\mathbf{E}$ 与代表散射的阻尼力 $\\mathbf{p}/\\tau$ 相平衡，其中 $\\mathbf{p}=m\\mathbf{v}$ 是平均动量，$\\tau$ 是动量弛豫时间：\n$$\n\\frac{d\\mathbf{p}}{dt} = 0 = -e\\mathbf{E} - \\frac{\\mathbf{p}}{\\tau} \\implies \\mathbf{p} = -e\\tau\\mathbf{E}\n$$\n载流子的平均漂移速度为 $\\mathbf{v} = \\mathbf{p}/m = -(e\\tau/m)\\mathbf{E}$。\n\n电流密度 $\\mathbf{j}$ 由下式给出：\n$$\n\\mathbf{j} = n(-e)\\mathbf{v} = n(-e)\\left(-\\frac{e\\tau}{m}\\mathbf{E}\\right) = \\frac{ne^2\\tau}{m}\\mathbf{E}\n$$\n这符合欧姆定律 $\\mathbf{j} = \\sigma\\mathbf{E}$，因此电导率 $\\sigma = \\frac{ne^2\\tau}{m}$。电阻率是电导率的倒数，$\\rho = 1/\\sigma$：\n$$\n\\rho = \\frac{m}{ne^2\\tau}\n$$\n一个关键的假设是，这个源自经典图像的德鲁德公式可以推广到量子系统，其中 $\\tau$ 是总动量弛豫时间。我们将总散射率定义为 $\\Gamma_{\\mathrm{tot}} = 1/\\tau$。因此，电阻率与总散射率成正比：\n$$\n\\rho(T) = \\frac{m}{ne^2}\\Gamma_{\\mathrm{tot}}(T)\n$$\n根据马西森法则，总散射率是各个独立散射机制贡献的总和。在此问题中：\n$$\n\\Gamma_{\\mathrm{tot}}(T) = \\Gamma_{\\mathrm{imp}} + \\Gamma_{\\mathrm{ee}}(T)\n$$\n其中 $\\Gamma_{\\mathrm{imp}}$ 是与温度无关的杂质散射率，$\\Gamma_{\\mathrm{ee}}(T)$ 是电子-电子散射率。将此代入电阻率表达式：\n$$\n\\rho(T) = \\frac{m}{ne^2}(\\Gamma_{\\mathrm{imp}} + \\Gamma_{\\mathrm{ee}}(T)) = \\frac{m}{ne^2}\\Gamma_{\\mathrm{imp}} + \\frac{m}{ne^2}\\Gamma_{\\mathrm{ee}}(T)\n$$\n我们将此理论表达式与实验测得的形式 $\\rho(T) = \\rho_{0} + A T^{2}$ 进行比较。通过匹配各项，我们得到：\n- 与温度无关的项：$\\rho_{0} = \\frac{m}{ne^2}\\Gamma_{\\mathrm{imp}}$\n- 与温度相关的项：$A T^{2} = \\frac{m}{ne^2}\\Gamma_{\\mathrm{ee}}(T)$\n\n现在我们可以求解散射率：\n$$\n\\Gamma_{\\mathrm{imp}} = \\frac{ne^2}{m}\\rho_{0}\n$$\n$$\n\\Gamma_{\\mathrm{ee}}(T) = \\frac{ne^2}{m}A T^{2}\n$$\n最后，我们计算所要求的比率，常数因子 $\\frac{ne^2}{m}$ 会消去：\n$$\n\\frac{\\Gamma_{\\mathrm{ee}}(T)}{\\Gamma_{\\mathrm{imp}}} = \\frac{\\frac{ne^2}{m}A T^{2}}{\\frac{ne^2}{m}\\rho_{0}} = \\frac{A T^{2}}{\\rho_{0}}\n$$\n\n**关于 $T^2$ 贡献的讨论:**\n经典的德鲁德模型本身并不预测电阻率的 $T^2$ 依赖性，因为它通常不考虑电子-电子相互作用，理由是这些相互作用在伽利略不变系统中保持了电子气的总动量。然而，实验上观测到的 $\\rho \\propto T^2$ 现象是**费米液体理论**的一个标志性结果。在此量子理论中，$T^2$ 依赖性源于泡利不相容原理对相空间的限制。\n\n为了使电子-电子散射对电阻率产生贡献（即弛豫总电流），动量必须从电子系统转移到晶格。这在单能带金属中主要通过**乌姆克拉普散射**（Umklapp Scattering）实现。在这种散射过程中，相互作用的电子的总晶格动量改变一个倒格子矢量 $\\vec{G}$，从而将动量转移给晶格。因此，观测到 $T^2$ 项的存在，意味着系统满足乌姆克拉普散射的条件，并且该散射过程成为低温下动量弛豫的一个有效通道。使用德鲁德公式分析这种效应是一种唯象的扩展，它提供了一个有用的框架，但其微观起源必须由更深入的量子理论来解释。", "answer": "$$\\boxed{\\frac{A T^{2}}{\\rho_{0}}}$$", "id": "2982995"}, {"introduction": "这项综合性练习集理论、建模和数据分析于一体，旨在让您全面理解马西森法则。您将从玻尔兹曼输运方程出发论证该法则，然后构建一个电阻率模型并将其与合成数据进行拟合，其中还包括一个违反该法则的案例 [@problem_id:3004568]。这个动手计算练习突出了加和性原则在实验凝聚态物理中的实际应用及其局限性。", "problem": "考虑一个晶体金属中的三维电子气，其处于一个均匀的静电场中。从弛豫时间近似下的半经典玻尔兹曼输运方程出发，其中碰撞积分在主导阶上由分布函数非平衡部分的单参数化衰减来表示。工作在所有散射事件均为独立、无记忆且具有时间平稳统计特性的区域内，并假设电荷中性成立，且电子速度分布保持在平衡态附近，从而线性响应适用。仅使用基本且经过充分检验的关系式来构建所需表达式，并且不要在一开始就假定任何特定的目标公式。\n\n任务 1 (推导与条件)：从玻尔兹曼输运方程出发，论证对于稀疏且不相关的散射源，独立散射率的可加性。然后，解释在 Drude 电导模型的框架下，如何将得到的电阻率表示为与不同散射通道相关的特征弛豫时间的函数。清晰地陈述可加性成立所需的所有假设，包括散射事件的统计独立性、线性响应区域以及不存在强能量依赖的顶点修正。您的推导必须从以下基本基础开始：\n- 弛豫时间近似下的半经典玻尔兹曼输运方程。\n- Drude 电导关系式。\n- 关于不同散射源为独立泊松过程的假设。\n\n任务 2 (模型构建与拟合)：构建一个与以下针对不同微观散射机制的物理标度律一致的最小化温度依赖电阻率模型：\n- 杂质散射与温度无关。\n- 在趋近于 Bloch-Grüneisen 函数高温极限的中间温度范围内，电子-声子散射大致与温度成线性关系。\n- 在费米液体区域内，电子-电子散射给出二次方的温度依赖性。\n\n使用该模型拟合为多个温度值生成的合成测量数据。明确使用温度数组 $\\{0,5,10,20,50,100,150,200,250,300\\}$（单位为开尔文），并生成以欧姆-米（记为 $\\Omega\\cdot\\mathrm{m}$）为单位的电阻率值。每个案例的合成电阻率数据应通过将一个杂质项、一个温度线性项和一个温度二次项相加生成，并附加一个小的确定性扰动以模拟可复现的实验缺陷。具体来说，对于每个温度 $T$，将测量值定义为\n$$\n\\rho_{\\mathrm{meas}}(T) = \\rho_{0}^{\\star} + A^{\\star} T + B^{\\star} T^2 + \\delta\\rho(T),\n$$\n其中 $\\delta\\rho(T) = s \\sin(T)$，s 是一个单位为 $\\Omega\\cdot\\mathrm{m}$ 的小振幅，且正弦函数的自变量是无量纲的。在其中一个测试案例中，通过添加一个杂质散射和非弹性散射之间的弱干涉项，来引入一个受控的可加性违背，该干涉项无法在最小多项式模型中表示。在该特定案例中，测量的电阻率为\n$$\n\\rho_{\\mathrm{meas}}(T) = \\rho_{0}^{\\star} + A^{\\star} T + B^{\\star} T^2 + c \\, \\rho_{0}^{\\star} \\left(\\frac{T}{T_0}\\right) \\ln\\left(1 + \\frac{T}{T_0}\\right) + \\delta\\rho(T),\n$$\n其中 $c$ 是无量纲的， $T_0$ 的单位是开尔文。\n\n任务 3 (单位与输出规范)：通过最小二乘法将模型参数 $(\\rho_{0}, A, B)$ 拟合到每个合成数据集。将 $\\rho_{0}$ 以 $\\Omega\\cdot\\mathrm{m}$ 表示， $A$ 以 $\\Omega\\cdot\\mathrm{m}/\\mathrm{K}$ 表示， $B$ 以 $\\Omega\\cdot\\mathrm{m}/\\mathrm{K}^2$ 表示。通过归一化均方根误差来量化拟合优度\n$$\n\\mathrm{NRMSE} = \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(\\rho_{\\mathrm{meas}}(T_i) - \\rho_{\\mathrm{fit}}(T_i)\\right)^2}}{\\frac{1}{N}\\sum_{i=1}^{N} \\rho_{\\mathrm{meas}}(T_i)},\n$$\n其中 $N$ 是温度点的数量。对于每个案例，使用以下标准来评估最小模型内散射可加性的有效性：如果 $\\mathrm{NRMSE}  10^{-4}$，则认为模型与可加性一致，否则不一致。有效性指标必须以整数形式输出，1 代表一致，0 代表不一致。\n\n测试套件：使用温度集 $\\{0,5,10,20,50,100,150,200,250,300\\}$（单位为开尔文）和确定性扰动振幅 $s = 1.00\\times 10^{-12}$（单位为 $\\Omega\\cdot\\mathrm{m}$）。对于以下每个案例，生成合成电阻率数据并执行拟合：\n\n- 案例 1 (基线可加性)：$\\rho_{0}^{\\star} = 1.00\\times 10^{-8}$ ($\\Omega\\cdot\\mathrm{m}$)，$A^{\\star} = 3.50\\times 10^{-11}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}$)，$B^{\\star} = 2.00\\times 10^{-14}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}^2$)。\n\n- 案例 2 (高温线性主导)：$\\rho_{0}^{\\star} = 2.00\\times 10^{-9}$ ($\\Omega\\cdot\\mathrm{m}$)，$A^{\\star} = 1.00\\times 10^{-10}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}$)，$B^{\\star} = 1.00\\times 10^{-14}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}^2$)。\n\n- 案例 3 (受控违背)：$\\rho_{0}^{\\star} = 1.50\\times 10^{-8}$ ($\\Omega\\cdot\\mathrm{m}$)，$A^{\\star} = 2.50\\times 10^{-11}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}$)，$B^{\\star} = 2.50\\times 10^{-14}$ ($\\Omega\\cdot\\mathrm{m}/\\mathrm{K}^2$)，干涉参数 $c = 5.00\\times 10^{-2}$ (无量纲)，$T_0 = 5.00\\times 10^{1}$ (开尔文)。\n\n您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔的结果列表。对于每个案例，输出拟合的参数三元组，后跟有效性指标。因此，最终输出必须是按以下顺序排列的包含 12 个条目的列表：\n$$\n[\\rho_{0}^{(1)}, A^{(1)}, B^{(1)}, \\mathrm{valid}^{(1)}, \\rho_{0}^{(2)}, A^{(2)}, B^{(2)}, \\mathrm{valid}^{(2)}, \\rho_{0}^{(3)}, A^{(3)}, B^{(3)}, \\mathrm{valid}^{(3)}].\n$$\n输出中的所有数值必须以上述指定单位表示；不出现角度；不使用百分比；并且每个案例的最后一个条目必须是整数 0 或 1，用以表示根据所述标准的可加性有效性。", "solution": "**任务 1：马西森法则的理论论证**\n\n我们从稳态、均匀条件下的半经典玻尔兹曼输运方程（BTE）出发。在外加电场 $\\mathbf{E}$ 的作用下，BTE 简化为：\n$$\n-\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f = \\left( \\frac{\\partial f}{\\partial t} \\right)_{\\text{coll}}\n$$\n其中 $f$ 是电子分布函数，左侧是驱动项，右侧是碰撞积分。\n\n在弛豫时间近似（RTA）下，假设分布函数 $f$ 从非平衡态向平衡态 $f_0$ 的恢复过程可以用一个特征时间 $\\tau$ 来描述：\n$$\n\\left( \\frac{\\partial f}{\\partial t} \\right)_{\\text{coll}} = -\\frac{f - f_0}{\\tau}\n$$\n如果存在多种**统计独立**的散射机制（例如，与杂质的散射和与声子的散射），那么总的碰撞概率是各个独立过程概率之和。这意味着总散射率（弛豫时间倒数）是各个分散射率之和：\n$$\n\\frac{1}{\\tau_{\\text{eff}}} = \\sum_{i} \\frac{1}{\\tau_i}\n$$\n其中 $\\tau_{\\text{eff}}$ 是有效的总弛豫时间，$\\tau_i$ 是第 $i$ 种散射机制对应的弛豫时间。\n\n在线性响应区（弱电场），非平衡分布 $f$ 可写为 $f = f_0 + g$，其中 $g$ 是一个小量。BTE 变为：\n$$\n-\\frac{e\\mathbf{E}}{\\hbar} \\cdot \\nabla_{\\mathbf{k}} f_0 = -\\frac{g}{\\tau_{\\text{eff}}}\n$$\n由此解出 $g = \\tau_{\\text{eff}} e (\\mathbf{E} \\cdot \\mathbf{v}_{\\mathbf{k}}) \\frac{\\partial f_0}{\\partial \\epsilon_{\\mathbf{k}}}$。\n\n在德鲁德电导模型中，电阻率 $\\rho$ 与总弛豫时间成反比：\n$$\n\\rho = \\frac{m^*}{n e^2 \\tau}\n$$\n将有效弛豫时间 $\\tau_{\\text{eff}}$ 代入，我们得到总电阻率：\n$$\n\\rho_{\\text{total}} = \\frac{m^*}{n e^2 \\tau_{\\text{eff}}} = \\frac{m^*}{n e^2} \\left( \\sum_{i} \\frac{1}{\\tau_i} \\right) = \\sum_i \\left( \\frac{m^*}{n e^2 \\tau_i} \\right)\n$$\n我们将每一项 $\\rho_i = \\frac{m^*}{n e^2 \\tau_i}$ 定义为仅由第 $i$ 种散射机制引起的电阻率分量。这样，我们就得到了马西森法则：\n$$\n\\rho_{\\text{total}} = \\sum_i \\rho_i\n$$\n此法则的成立依赖于一系列关键假设：(1) 各散射通道统计独立；(2) 弛豫时间近似有效；(3) 弛豫时间与能量无关，或所有通道的弛豫时间具有完全相同的能量依赖性，这样才能在对能量积分后保持简单的加和性。\n\n**任务 2 与 3：模型构建、拟合与验证**\n\n**1. 模型构建**: 根据物理标度律和马西森法则，我们构建一个描述总电阻率随温度变化的最小多项式模型：\n$$\n\\rho_{\\text{fit}}(T) = \\rho_0 + A T + B T^2\n$$\n- $\\rho_0$：与温度无关的杂质散射项。\n- $A T$：中高温区的电子-声子散射项（线性近似）。\n- $B T^2$：低温区的电子-电子散射项。\n待拟合的参数为 $(\\rho_0, A, B)$。\n\n**2. 数据生成与拟合**:\n对于问题中给定的每个案例，我们首先根据指定的公式生成“测量”数据 $\\rho_{\\text{meas}}(T_i)$。\n- **案例 1 和 2**: 数据由基本的多项式模型 $\\rho_{0}^{\\star} + A^{\\star} T + B^{\\star} T^2$ 加上一个小的确定性扰动 $\\delta\\rho(T) = s \\sin(T)$ 构成。这代表了马西森法则成立的理想情况。\n- **案例 3**: 除了上述项外，数据中还加入了一个非多项式的干涉项 $c \\, \\rho_{0}^{\\star} (T/T_0) \\ln(1 + T/T_0)$，该项模拟了对马西森法则的偏离。\n\n然后，我们使用线性最小二乘法，将我们的模型 $\\rho_{\\text{fit}}(T)$ 拟合到生成的 $\\rho_{\\text{meas}}(T)$ 数据。该方法通过求解正规方程来找到使残差平方和最小的参数 $(\\rho_0, A, B)$。\n\n**3. 拟合优度与验证**:\n我们使用归一化均方根误差 (NRMSE) 来评估拟合质量：\n$$\n\\mathrm{NRMSE} = \\frac{\\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}\\left(\\rho_{\\mathrm{meas}}(T_i) - \\rho_{\\mathrm{fit}}(T_i)\\right)^2}}{\\frac{1}{N}\\sum_{i=1}^{N} \\rho_{\\mathrm{meas}}(T_i)}\n$$\n根据问题设定的标准，如果 $\\mathrm{NRMSE}  10^{-4}$，我们认为简单的加和模型是有效的（`valid`=1），表明数据与马西森法则一致。如果 $\\mathrm{NRMSE} \\ge 10^{-4}$，模型拟合不佳，表明存在对简单加和性的显著偏离（`valid`=0）。\n\n对于案例 1 和 2，由于基础数据结构是多项式的，我们预期 NRMSE 会很小，`valid`=1。对于案例 3，由于存在无法被多项式模型描述的干涉项，我们预期 NRMSE 会较大，导致 `valid`=0。最终的数值结果由提供的 Python 代码计算得出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of fitting a resistivity model to synthetic data\n    and validating the additivity principle (Matthiessen's rule).\n    \"\"\"\n\n    # Define the test cases as specified in the problem statement.\n    test_cases = [\n        {\n            \"name\": \"case 1 (baseline additivity)\",\n            \"rho0_star\": 1.00e-8,\n            \"A_star\": 3.50e-11,\n            \"B_star\": 2.00e-14,\n            \"c\": 0.0,\n            \"T0\": 1.0  # Not used in this case, placeholder\n        },\n        {\n            \"name\": \"case 2 (high-temperature linear dominance)\",\n            \"rho0_star\": 2.00e-9,\n            \"A_star\": 1.00e-10,\n            \"B_star\": 1.00e-14,\n            \"c\": 0.0,\n            \"T0\": 1.0  # Not used in this case, placeholder\n        },\n        {\n            \"name\": \"case 3 (controlled violation)\",\n            \"rho0_star\": 1.50e-8,\n            \"A_star\": 2.50e-11,\n            \"B_star\": 2.50e-14,\n            \"c\": 5.00e-2,\n            \"T0\": 50.0\n        }\n    ]\n\n    # Common parameters for all cases\n    T = np.array([0, 5, 10, 20, 50, 100, 150, 200, 250, 300], dtype=float)\n    s = 1.00e-12  # Perturbation amplitude in Ohm-meter\n    N = len(T) # Number of data points\n\n    final_results = []\n    \n    for case in test_cases:\n        # Step 1: Generate synthetic resistivity data\n        rho0_star = case[\"rho0_star\"]\n        A_star = case[\"A_star\"]\n        B_star = case[\"B_star\"]\n        c = case[\"c\"]\n        T0 = case[\"T0\"]\n\n        # Base polynomial part\n        rho_base = rho0_star + A_star * T + B_star * T**2\n        \n        # Deterministic perturbation\n        delta_rho = s * np.sin(T)\n\n        # Violation term (only non-zero for Case 3)\n        # Using np.divide and np.log to handle T=0 safely, which results in 0.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            T_ratio = T / T0\n            log_term = np.log(1 + T_ratio)\n        log_term[np.isnan(log_term)] = 0 # Handle T=0 where T/T0 gives NaN if T0=0, or ln(1)=0. For T/T0=0, term is 0.\n        violation_term = c * rho0_star * T_ratio * log_term\n        \n        rho_meas = rho_base + delta_rho + violation_term\n\n        # Step 2: Perform least-squares fit\n        # The model is rho_fit = rho0 * 1 + A * T + B * T^2\n        # We set up the design matrix X for the linear least squares problem X*p = rho_meas\n        X = np.vstack([T**0, T**1, T**2]).T\n        \n        # Solve for the parameters (p = [rho0, A, B])\n        p, residuals, rank, s_values = np.linalg.lstsq(X, rho_meas, rcond=None)\n        rho0_fit, A_fit, B_fit = p[0], p[1], p[2]\n\n        # Step 3: Calculate fitted values and NRMSE\n        rho_fit = X @ p # Equivalent to rho0_fit + A_fit * T + B_fit * T**2\n        \n        # Calculate NRMSE as per the formula\n        rmse = np.sqrt(np.mean((rho_meas - rho_fit)**2))\n        mean_rho_meas = np.mean(rho_meas)\n        nrmse = rmse / mean_rho_meas\n        \n        # Step 4: Apply validity criterion\n        # Model is consistent if NRMSE  1e-4\n        validity = 1 if nrmse  1e-4 else 0\n        \n        # Append results for this case\n        final_results.extend([rho0_fit, A_fit, B_fit, validity])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3004568"}]}