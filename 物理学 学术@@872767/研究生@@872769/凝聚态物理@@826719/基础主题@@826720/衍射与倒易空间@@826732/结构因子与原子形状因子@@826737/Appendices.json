{"hands_on_practices": [{"introduction": "衍射实验的核心是探测物质中的电子分布。描述单个原子如何散射X射线的物理量是原子形状因子 $f(\\mathbf{q})$。本练习将指导您从第一性原理出发，为一个给定的电子密度模型——球对称高斯分布——推导其原子形状因子，从而深入理解原子的空间电子分布与其在倒易空间中散射行为之间的傅里叶变换关系。[@problem_id:217999]", "problem": "在X射线散射实验中，来自孤立原子的散射由原子形状因子 $f(\\mathbf{q})$ 描述。这个量是原子电子密度分布 $\\rho(\\mathbf{r})$ 的傅里叶变换，由下式给出：\n$$ f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{i \\mathbf{q} \\cdot \\mathbf{r}} d^3r $$\n其中 $\\mathbf{q}$ 是散射矢量，表示散射X射线的波矢量的变化。\n\n考虑一个包含 $Z$ 个电子的中性原子模型。假设电子电荷在原子核周围是连续且球对称分布的。电子密度由径向距离 $r = |\\mathbf{r}|$ 的高斯函数描述：\n$$ \\rho(r) = A e^{-\\alpha r^2} $$\n其中 $A$ 和 $\\alpha$ 是正常数。常数 $A$ 由归一化条件确定，即电子密度在整个空间上的积分必须等于电子总数 $Z$：\n$$ \\int \\rho(\\mathbf{r}) d^3r = Z $$\n\n基于此模型，推导原子形状因子 $f(q)$ 作为散射矢量大小 $q = |\\mathbf{q}|$ 的函数。用 $Z$、$\\alpha$ 和 $q$ 表示你的最终答案。", "solution": "解答过程包括两个主要步骤：首先，确定归一化常数 $A$；其次，计算电子密度的傅里叶变换。\n\n**步骤 1：确定归一化常数 $A$**\n\n我们使用归一化条件 $\\int \\rho(\\mathbf{r}) d^3r = Z$。由于密度 $\\rho(r)$ 是球对称的，我们可以在球坐标中计算该积分，其中 $d^3r = r^2 \\sin\\theta dr d\\theta d\\phi$。\n\n$$ Z = \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty \\rho(r) r^2 dr $$\n代入 $\\rho(r) = A e^{-\\alpha r^2}$：\n$$ Z = A \\left( \\int_0^{2\\pi} d\\phi \\right) \\left( \\int_0^\\pi \\sin\\theta d\\theta \\right) \\left( \\int_0^\\infty e^{-\\alpha r^2} r^2 dr \\right) $$\n角向积分很简单：\n$$ \\int_0^{2\\pi} d\\phi = 2\\pi $$\n$$ \\int_0^\\pi \\sin\\theta d\\theta = [-\\cos\\theta]_0^\\pi = -(-1 - 1) = 2 $$\n所以积分变为：\n$$ Z = A (4\\pi) \\int_0^\\infty r^2 e^{-\\alpha r^2} dr $$\n剩下的径向积分是标准的高斯积分，形式为 $\\int_0^\\infty x^{2n} e^{-ax^2} dx = \\frac{(2n-1)!!}{2^{n+1}}\\sqrt{\\frac{\\pi}{a^{2n+1}}}$。在我们的情况中，$n=1$ 且 $a=\\alpha$，所以：\n$$ \\int_0^\\infty r^2 e^{-\\alpha r^2} dr = \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} $$\n将此结果代回：\n$$ Z = 4\\pi A \\left( \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} \\right) = A \\pi^{3/2} \\alpha^{-3/2} = A \\left( \\frac{\\pi}{\\alpha} \\right)^{3/2} $$\n解出 $A$，我们得到：\n$$ A = Z \\left( \\frac{\\alpha}{\\pi} \\right)^{3/2} $$\n\n**步骤 2：计算原子形状因子 $f(q)$**\n\n原子形状因子由 $f(\\mathbf{q}) = \\int \\rho(\\mathbf{r}) e^{i \\mathbf{q} \\cdot \\mathbf{r}} d^3r$ 给出。我们将再次使用球坐标。对于球对称函数，傅里叶变换的结果将只依赖于大小 $q=|\\mathbf{q}|$。我们可以通过将坐标系的z轴与散射矢量 $\\mathbf{q}$ 对齐来简化计算。因此，$\\mathbf{q} \\cdot \\mathbf{r} = q r \\cos\\theta$。\n\n$$ f(q) = \\int_0^{2\\pi} d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\, (A e^{-\\alpha r^2}) e^{iqr\\cos\\theta} r^2 \\sin\\theta $$\n被积函数与 $\\phi$ 无关，所以对 $\\phi$ 的积分得到 $2\\pi$：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} dr \\int_0^\\pi e^{iqr\\cos\\theta} \\sin\\theta d\\theta $$\n现在我们计算对 $\\theta$ 的积分。令 $u = \\cos\\theta$，则 $du = -\\sin\\theta d\\theta$。积分限从 $[0, \\pi]$ 变为 $[1, -1]$。\n$$ \\int_0^\\pi e^{iqr\\cos\\theta} \\sin\\theta d\\theta = \\int_1^{-1} e^{iqru} (-du) = \\int_{-1}^1 e^{iqru} du $$\n$$ = \\left[ \\frac{e^{iqru}}{iqr} \\right]_{-1}^1 = \\frac{e^{iqr} - e^{-iqr}}{iqr} = \\frac{2i \\sin(qr)}{iqr} = \\frac{2\\sin(qr)}{qr} $$\n将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = 2\\pi A \\int_0^\\infty r^2 e^{-\\alpha r^2} \\left( \\frac{2\\sin(qr)}{qr} \\right) dr $$\n$$ f(q) = \\frac{4\\pi A}{q} \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr $$\n积分 $I = \\int_0^\\infty r e^{-\\alpha r^2} \\sin(qr) dr$ 可以通过将其与高斯函数的傅里叶余弦变换联系起来求解，$F_c(k) = \\int_0^\\infty e^{-ax^2}\\cos(kx)dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}} e^{-k^2/4a}$。注意到我们的积分 $I$ 就是 $-\\frac{d}{dq} \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr$。\n使用公式，其中 $a=\\alpha$ 且 $k=q$：\n$$ \\int_0^\\infty e^{-\\alpha r^2} \\cos(qr) dr = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n对 $q$ 求导：\n$$ \\frac{d}{dq} \\left( \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{1}{2}\\sqrt{\\frac{\\pi}{\\alpha}} \\left(-\\frac{2q}{4\\alpha}\\right) e^{-q^2/4\\alpha} = -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} $$\n所以，积分 $I$ 为：\n$$ I = -\\left( -\\frac{q}{4\\alpha} \\sqrt{\\frac{\\pi}{\\alpha}} e^{-q^2/4\\alpha} \\right) = \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} $$\n现在将此结果代回 $f(q)$ 的表达式中：\n$$ f(q) = \\frac{4\\pi A}{q} \\left( \\frac{q\\sqrt{\\pi}}{4\\alpha^{3/2}} e^{-q^2/4\\alpha} \\right) = \\frac{A \\pi^{3/2}}{\\alpha^{3/2}} e^{-q^2/4\\alpha} = A \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n最后，代入归一化常数 $A = Z (\\alpha/\\pi)^{3/2}$ 的表达式：\n$$ f(q) = \\left[ Z \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\right] \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{-q^2/4\\alpha} $$\n$$ f(q) = Z e^{-q^2/4\\alpha} $$\n这个结果表明，高斯函数的傅里叶变换是另一个高斯函数。作为检验，对于 $q=0$（前向散射），$f(0) = Z e^0 = Z$，这正是电子总数，与预期相符。", "answer": "$$ \\boxed{Z \\exp\\left(-\\frac{q^2}{4\\alpha}\\right)} $$", "id": "217999"}, {"introduction": "在理解了单个原子的散射后，我们将视野扩展到晶体中的原子集合。几何结构因子 $S_{\\mathbf{G}}$ 描述了晶胞内所有原子散射波的相干叠加效应，其数值直接决定了衍射峰的强度。本练习 [@problem_id:217997] 旨在探讨结构因子如何揭示晶体结构的精细细节，特别是体心立方 (BCC) 晶格中微小的原子位移如何影响衍射图样，并导致在理想结构中本应禁戒的衍射峰出现。", "problem": "在晶体的X射线衍射中，散射振幅由结构因子 $S_{\\mathbf{G}}$ 决定，该因子取决于晶胞内原子的排列以及原子自身的散射特性。对于一个原子基元，其结构因子由下式给出：\n$$ S_{\\mathbf{G}} = \\sum_{j=1}^{N} f_j(\\mathbf{G}) e^{i \\mathbf{G} \\cdot \\mathbf{r}_j} $$\n其中，$N$ 是基元中的原子数，$\\mathbf{r}_j$ 是第 $j$ 个原子的位置矢量，$f_j(\\mathbf{G})$ 是其原子形状因子，而 $\\mathbf{G}$ 是一个倒易点阵矢量。\n\n考虑一个具有体心立方（BCC）结构的单原子晶体，其由一个边长为 $a$ 的常规立方晶胞描述。对应于衍射峰的倒易点阵矢量由 $\\mathbf{G} = \\frac{2\\pi}{a}(h\\hat{x} + k\\hat{y} + l\\hat{z})$ 给出，其中 $h, k, l$ 是被称为米勒指数的整数。\n\n该晶体表现出微小的结构畸变。常规晶胞的基元由两个相同的原子组成。第一个原子位于原点，$\\mathbf{r}_1 = (0,0,0)$。第二个原子理想情况下位于体心，但沿z轴有轻微位移。其位置由 $\\mathbf{r}_2 = \\frac{a}{2}(\\hat{x} + \\hat{y} + \\hat{z}) + \\delta \\hat{z}$ 给出，其中 $\\delta$ 是一个恒定位移量。晶体中所有原子都是同一种类型，因此它们的原子形状因子 $f(\\mathbf{G})$ 是相同的。\n\n计算对于米勒指数为 $(h,k,l) = (0,0,1)$ 的特定反射，结构因子模的平方 $|S_{\\mathbf{G}}|^2$。设 $f_{001}$ 表示在此反射的特定倒易点阵矢量 $\\mathbf{G}$ 处计算的原子形状因子。用 $f_{001}$、$a$ 和 $\\delta$ 表示你的答案。对于此问题，你可以假设 $f_{001}$ 是一个实数。", "solution": "每个晶胞中有两个原子，其位置为\n\n$$\n\\mathbf{r}_1 = (0,0,0), \n\\quad \n\\mathbf{r}_2 = \\Bigl(\\tfrac{a}{2},\\tfrac{a}{2},\\tfrac{a}{2}+\\delta\\Bigr)\\,,\n$$\n  \n对于 $(0,0,1)$ 反射，它们具有相同的原子形状因子 $f_{001}$。倒易点阵矢量为\n\n$$\n\\mathbf{G} = \\frac{2\\pi}{a}(0,0,1)\\,.\n$$\n  \n1. 结构因子：\n\n$$\nS_{\\mathbf{G}}\n= \\sum_{j=1}^2 f_{001}\\,e^{i\\mathbf{G}\\cdot\\mathbf{r}_j}\n= f_{001}\\Bigl[1 + e^{i\\mathbf{G}\\cdot\\mathbf{r}_2}\\Bigr].\n$$\n  \n2. 计算第二个原子的相位：\n\n$$\n\\mathbf{G}\\cdot\\mathbf{r}_2\n= \\frac{2\\pi}{a}\\,(a/2+\\delta)\n= \\pi + \\frac{2\\pi\\,\\delta}{a}.\n$$\n  \n因此\n\n$$\nS_{\\mathbf{G}}\n= f_{001}\\Bigl[1 + e^{i(\\pi + 2\\pi\\delta/a)}\\Bigr]\n= f_{001}\\bigl[1 - e^{i2\\pi\\delta/a}\\bigr].\n$$\n  \n3. 模的平方：\n\n$$\n|S_{\\mathbf{G}}|^2\n= f_{001}^2\\,\\bigl|1 - e^{i2\\pi\\delta/a}\\bigr|^2\n= f_{001}^2\\bigl[2 - 2\\cos(2\\pi\\delta/a)\\bigr]\n= 4\\,f_{001}^2\\,\\sin^2\\!\\Bigl(\\frac{\\pi\\delta}{a}\\Bigr).\n$$", "answer": "$$\\boxed{4\\,f_{001}^2\\,\\sin^2\\!\\bigl(\\tfrac{\\pi\\delta}{a}\\bigr)}$$", "id": "217997"}, {"introduction": "将理论计算与真实实验结果联系起来，是凝聚态物理研究的关键一步。在粉末 X 射线衍射实验中，测量到的衍射峰积分强度不仅取决于结构因子的模平方 $|S_{hkl}|^2$，还受到多重度因子 $p_{hkl}$ 等几何因素的影响。本练习 [@problem_id:218123] 作为一个综合性应用，要求您为一种重要且结构复杂的钙钛矿材料计算衍射强度比，从而将原子形状因子、结构因子和多重度因子的知识融会贯通，以预测可观测量。", "problem": "一类重要的材料以理想的钙钛矿结构结晶，其化学式为ABO$_3$。该结构可以由一个晶格常数为$a$的简单立方布拉维晶格和一个五原子基元来描述。晶胞内原子的位置，以笛卡尔坐标表示并以$a$为单位，如下：\n- A原子：位于$(0, 0, 0)$\n- B原子：位于$(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n- 三个O原子：位于$(\\frac{1}{2}, \\frac{1}{2}, 0)$、$(\\frac{1}{2}, 0, \\frac{1}{2})$和$(0, \\frac{1}{2}, \\frac{1}{2})$\n\n在粉末X射线衍射实验中，与晶面族$\\{hkl\\}$对应的衍射峰的积分强度$I_{hkl}$与$p_{hkl} |S_{hkl}|^2$成正比，其中$p_{hkl}$是$\\{hkl\\}$晶面族的多重性因子，$S_{hkl}$是$(hkl)$反射的结构因子。\n\nA、B和O原子的原子形状因子取决于散射矢量。对于特定的反射$(hkl)$，我们分别将它们表示为$f_{A, hkl}$、$f_{B, hkl}$和$f_{O, hkl}$。假设这些形状因子是实值的。\n\n计算$\\{110\\}$衍射峰与$\\{100\\}$衍射峰的积分强度之比$I_{110}/I_{100}$。您的答案应以相关的原子形状因子表示。", "solution": "对于晶面族$\\{hkl\\}$，衍射峰的积分强度$I_{hkl}$与多重性因子$p_{hkl}$和结构因子模的平方$|S_{hkl}|^2$的乘积成正比。\n$$ I_{hkl} \\propto p_{hkl} |S_{hkl}|^2 $$\n因此，两个强度的比值为：\n$$ \\frac{I_{110}}{I_{100}} = \\frac{p_{110} |S_{110}|^2}{p_{100} |S_{100}|^2} $$\n\n首先，我们需要计算结构因子$S_{hkl}$。结构因子的通用公式是基元中所有原子$j$的求和：\n$$ S_{hkl} = \\sum_j f_j e^{i \\mathbf{G}_{hkl} \\cdot \\mathbf{r}_j} $$\n其中$\\mathbf{r}_j$是基元中第$j$个原子的位置，$f_j$是其原子形状因子，$\\mathbf{G}_{hkl}$是$(hkl)$反射的倒易点阵矢量。对于晶格常数为$a$的简单立方晶格，$\\mathbf{G}_{hkl} = \\frac{2\\pi}{a}(h, k, l)$。指数中的点积变为：\n$$ \\mathbf{G}_{hkl} \\cdot \\mathbf{r}_j = \\frac{2\\pi}{a}(h, k, l) \\cdot a(x_j, y_j, z_j) = 2\\pi(hx_j + ky_j + lz_j) $$\n其中$(x_j, y_j, z_j)$是原子$j$的分数坐标。\n\n钙钛矿结构的基元为：\n- A位于 $\\mathbf{r}_A = a(0, 0, 0)$\n- B位于 $\\mathbf{r}_B = a(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$\n- O$_1$位于 $\\mathbf{r}_{O1} = a(\\frac{1}{2}, \\frac{1}{2}, 0)$\n- O$_2$位于 $\\mathbf{r}_{O2} = a(\\frac{1}{2}, 0, \\frac{1}{2})$\n- O$_3$位于 $\\mathbf{r}_{O3} = a(0, \\frac{1}{2}, \\frac{1}{2})$\n\n结构因子是所有五个原子贡献的总和。由于三个氧原子是同一种类型，我们对它们都使用$f_{O,hkl}$。\n$$ S_{hkl} = f_{A, hkl} e^{i 2\\pi(0)} + f_{B, hkl} e^{i 2\\pi(\\frac{h}{2}+\\frac{k}{2}+\\frac{l}{2})} + f_{O, hkl} \\left( e^{i 2\\pi(\\frac{h}{2}+\\frac{k}{2})} + e^{i 2\\pi(\\frac{h}{2}+\\frac{l}{2})} + e^{i 2\\pi(\\frac{k}{2}+\\frac{l}{2})} \\right) $$\n对于整数$x$，使用$e^{i\\pi x} = (-1)^x$，我们可以简化表达式：\n$$ S_{hkl} = f_{A, hkl} + f_{B, hkl} e^{i\\pi(h+k+l)} + f_{O, hkl} \\left( e^{i\\pi(h+k)} + e^{i\\pi(h+l)} + e^{i\\pi(k+l)} \\right) $$\n\n现在，我们针对特定的反射$(100)$和$(110)$计算$S_{hkl}$。\n\n对于$(100)$反射，$(h,k,l) = (1,0,0)$：\n$$ S_{100} = f_{A, 100} + f_{B, 100} e^{i\\pi(1)} + f_{O, 100} \\left( e^{i\\pi(1)} + e^{i\\pi(1)} + e^{i\\pi(0)} \\right) $$\n$$ S_{100} = f_{A, 100} + f_{B, 100}(-1) + f_{O, 100} \\left( -1 - 1 + 1 \\right) $$\n$$ S_{100} = f_{A, 100} - f_{B, 100} - f_{O, 100} $$\n\n对于$(110)$反射，$(h,k,l) = (1,1,0)$：\n$$ S_{110} = f_{A, 110} + f_{B, 110} e^{i\\pi(1+1)} + f_{O, 110} \\left( e^{i\\pi(1+1)} + e^{i\\pi(1)} + e^{i\\pi(1)} \\right) $$\n$$ S_{110} = f_{A, 110} + f_{B, 110} e^{i2\\pi} + f_{O, 110} \\left( e^{i2\\pi} + e^{i\\pi} + e^{i\\pi} \\right) $$\n$$ S_{110} = f_{A, 110} + f_{B, 110}(1) + f_{O, 110} \\left( 1 - 1 - 1 \\right) $$\n$$ S_{110} = f_{A, 110} + f_{B, 110} - f_{O, 110} $$\n\n由于原子形状因子是实值的，结构因子模的平方为：\n$$ |S_{100}|^2 = (f_{A, 100} - f_{B, 100} - f_{O, 100})^2 $$\n$$ |S_{110}|^2 = (f_{A, 110} + f_{B, 110} - f_{O, 110})^2 $$\n\n接下来，我们确定立方晶系的多重性因子$p_{100}$和$p_{110}$。\n晶面族$\\{100\\}$由$(1,0,0)$的排列和符号变换组成。它们是$(100)$、$(\\bar{1}00)$、$(010)$、$(0\\bar{1}0)$、$(001)$和$(00\\bar{1})$。因此，多重性因子为$p_{100} = 6$。\n晶面族$\\{110\\}$由$(1,1,0)$的排列和符号变换组成。它们是$(110)$、$(1\\bar{1}0)$、$(\\bar{1}10)$、$(\\bar{1}\\bar{1}0)$、$(101)$、$(10\\bar{1})$、$(\\bar{1}01)$、$(\\bar{1}0\\bar{1})$、$(011)$、$(01\\bar{1})$、$(0\\bar{1}1)$和$(0\\bar{1}\\bar{1})$。因此，多重性因子为$p_{110} = 12$。\n\n现在我们可以计算强度比：\n$$ \\frac{I_{110}}{I_{100}} = \\frac{p_{110} |S_{110}|^2}{p_{100} |S_{100}|^2} = \\frac{12 \\cdot (f_{A, 110} + f_{B, 110} - f_{O, 110})^2}{6 \\cdot (f_{A, 100} - f_{B, 100} - f_{O, 100})^2} $$\n$$ \\frac{I_{110}}{I_{100}} = 2 \\frac{(f_{A, 110} + f_{B, 110} - f_{O, 110})^2}{(f_{A, 100} - f_{B, 100} - f_{O, 100})^2} $$\n这可以写成：\n$$ \\frac{I_{110}}{I_{100}} = 2 \\left( \\frac{f_{A, 110} + f_{B, 110} - f_{O, 110}}{f_{A, 100} - f_{B, 100} - f_{O, 100}} \\right)^2 $$", "answer": "$$ \\boxed{2 \\left( \\frac{f_{A, 110} + f_{B, 110} - f_{O, 110}}{f_{A, 100} - f_{B, 100} - f_{O, 100}} \\right)^2} $$", "id": "218123"}]}