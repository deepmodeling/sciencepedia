## 引言
在[晶态](@entry_id:193348)物质的世界里，原子的有序[排列](@entry_id:136432)构成了千姿百态的[晶体结构](@entry_id:140373)。然而，仅仅知道原子如何堆积是不够的；为了预测和操控材料的性能，我们必须能够精确地描述和指代晶体内部的特定方向和平面。无论是预测金属的滑移行为、解读[X射线衍射](@entry_id:147790)图谱，还是设计具有特定催化活性的[晶体表面](@entry_id:195760)，我们都需要一个统一、无[歧义](@entry_id:276744)的“[坐标系统](@entry_id:156346)”。[密勒指数](@entry_id:138901)（Miller Indices）正是为满足这一需求而生的强大数学工具，它提供了一套简洁的记号，将晶体的微观几何结构与宏观物理性质紧密联系起来。

本文将系统地引导读者深入掌握[密勒指数](@entry_id:138901)。在“原理与机制”一章中，我们将从其直观的几何定义出发，逐步过渡到更为普适的倒易空间表述，并揭示其与[晶体对称性](@entry_id:198772)的深刻联系。接下来，在“应用与[交叉](@entry_id:147634)学科联系”一章，我们将探讨[密勒指数](@entry_id:138901)如何在[材料力学](@entry_id:201885)、[表面科学](@entry_id:155397)和[晶体衍射](@entry_id:139605)等领域发挥核心作用。最后，“动手实践”部分将通过具体计算问题，巩固所学知识。通读本文，您将能够自信地运用[密勒指数](@entry_id:138901)来分析和解决凝聚态物理与[材料科学](@entry_id:152226)中的实际问题。

## 原理与机制

在上一章介绍[晶体结构](@entry_id:140373)的周期性之后，我们现在需要一套精确的语言来描述和分析晶体内部的特定取向。无论是在描述[位错滑移](@entry_id:275474)发生的[晶面](@entry_id:166481)，还是在标定[X射线衍射](@entry_id:147790)实验中的衍射峰，亦或是在设计特定表面性质的纳米器件时，我们都需要一个明确的、无[歧义](@entry_id:276744)的系统来指代晶体中的方向和平面。[密勒指数](@entry_id:138901)（Miller Indices）正是为此目的而设计的强大表示法。本章将深入探讨[密勒指数](@entry_id:138901)的定义、原理及其在不同[晶格](@entry_id:196752)体系和物理情境下的应用。我们将从直观的截距定义出发，逐步过渡到更普适、更强大的倒易空间表述，并揭示其与晶体对称性和物理性质之间的深刻联系。

### 基本定义：晶体几何的语言

为了描述[晶格](@entry_id:196752)中原子的有序[排列](@entry_id:136432)，我们首先需要一种方法来唯一地标识[晶格](@entry_id:196752)中的方向和平面。[密勒指数](@entry_id:138901)提供了一套简洁而通用的记号体系。

#### [晶面](@entry_id:166481)的[密勒指数](@entry_id:138901)

描述晶体中一个特定平面的最直观方法是观察它如何与晶体的参考坐标轴相交。**晶面（crystal plane）**的[密勒指数](@entry_id:138901)，记为 $(hkl)$，正是基于这一思想构建的。其确定步骤如下：

1.  **确定截距**：以[晶格](@entry_id:196752)[基矢](@entry_id:199546) $\mathbf{a}$、$\mathbf{b}$、$\mathbf{c}$ 的方向为坐标轴，确定该[晶面](@entry_id:166481)在三个轴上的截距。这些截距必须以各自[基矢](@entry_id:199546)的长度为单位来表示。例如，如果一个平面与 $\mathbf{a}$ 轴相交于点 $p\mathbf{a}$，与 $\mathbf{b}$ 轴相交于点 $q\mathbf{b}$，与 $\mathbf{c}$ 轴相交于点 $r\mathbf{c}$，那么截距系数就是 $p$、$q$ 和 $r$。如果平面与某一坐标轴平行，则认为它在该轴上的截距为无穷大（$\infty$）。如果截距在坐标轴的负方向，则其系数为负值。

2.  **取倒数**：将三个截距系数分别取倒数，得到 $(\frac{1}{p}, \frac{1}{q}, \frac{1}{r})$。

3.  **化为最简整数**：将这组倒[数乘](@entry_id:155971)以一个公因子，使其化为三个[互质](@entry_id:143119)的最小整数，记为 $(h, k, l)$。这三个整数就是该晶面的[密勒指数](@entry_id:138901)。按照惯例，负指数通过在该数字上方加一横杠来表示，例如 $\bar{h}$ 代表 $-h$。

作为一个具体的例子，考虑一个晶面，它与 $\mathbf{a}$ 轴的截距为 $-1\mathbf{a}$（即 $p=-1$），与 $\mathbf{b}$ 轴的截距为 $2\mathbf{b}$（即 $q=2$），并且与 $\mathbf{c}$ 轴平行（即 $r=\infty$）。按照上述步骤：截距系数为 $(-1, 2, \infty)$；取倒数得到 $(\frac{1}{-1}, \frac{1}{2}, \frac{1}{\infty}) = (-1, \frac{1}{2}, 0)$；为了将分数化为整数，我们将这组[数乘](@entry_id:155971)以2，得到 $(-2, 1, 0)$。因此，该晶面的[密勒指数](@entry_id:138901)为 $(\bar{2}10)$。

从这个定义中，我们可以立即理解[密勒指数](@entry_id:138901)中零的含义。如果一个指数为零，例如 $l=0$，这意味着其对应的截距系数 $r$ 必须为无穷大。一个在某轴上截距为无穷的平面，根据定义，必然与该轴平行。因此，一个 $(hk0)$ [晶面](@entry_id:166481)是与 $\mathbf{c}$ 轴平行的平面。

值得强调的是，[密勒指数](@entry_id:138901) $(hkl)$ 标识的是一个**晶面族（family of parallel planes）**。例如，平面 $(hkl)$ 和 $(\bar{h}\bar{k}\bar{l})$ 是两个不同的平面，它们分别截取坐标轴于 $(a/h, b/k, c/l)$ 和 $(-a/h, -b/k, -c/l)$。然而，这两个平面是相互平行的，具有相同的几何取向。因此，它们属于同一个晶面族。在讨论晶体性质时，如滑移面，我们通常关心的是[晶面](@entry_id:166481)的取向，而不是它在晶体中的具体位置。例如，在[立方晶体](@entry_id:198932)中，$(\bar{1}10)$ 和 $(1\bar{1}0)$ 这两个平面分别截取坐标轴于 $(-a, a, \infty)$ 和 $(a, -a, \infty)$，它们是两个不同的、通过平移可以相互重合的[平行平面](@entry_id:165919)，因此代表了相同的几何取向。

#### [晶向](@entry_id:137393)的[密勒指数](@entry_id:138901)

与晶面相对应，我们也需要标识晶体中的特定方向。**[晶向](@entry_id:137393)（crystal direction）**的指数，记为 $[uvw]$，其定义更为直接。一个[晶向](@entry_id:137393)由一个从[晶格](@entry_id:196752)原点指向另一个[晶格](@entry_id:196752)点 $\mathbf{T} = u\mathbf{a} + v\mathbf{b} + w\mathbf{c}$ 的矢量来定义，其中 $u, v, w$ 是整数。通过将这三个整数化为[互质](@entry_id:143119)的最小整数集，并置于方括号中，我们便得到了[晶向](@entry_id:137393)指数 $[uvw]$。

与[晶面](@entry_id:166481)指数不同，[晶向](@entry_id:137393)指数 $[uvw]$ 和 $[\bar{u}\bar{v}\bar{w}]$ 代表的是两个方向相反的、截然不同的[晶向](@entry_id:137393)。它们是反平行的矢量。这一点与 $(hkl)$ 和 $(\bar{h}\bar{k}\bar{l})$ 代表相同取向的平面形成鲜明对比。

### 倒易点阵：一个更强大的框架

尽管截距法在几何上很直观，但它在处理非正交晶系时会变得复杂且容易出错。一个更根本、更强大的方法是通过**倒易点阵（reciprocal lattice）**来定义[密勒指数](@entry_id:138901)。这个框架不仅在概念上更为普适，而且直接与[晶体衍射](@entry_id:139605)等实验现象相关联。

#### 倒易点阵矢量及其约定

对于一个由[基矢](@entry_id:199546) $\{\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3\}$ 定义的[实空间](@entry_id:754128)（或称正空间）布拉菲点阵，我们可以定义一组倒易[基矢](@entry_id:199546) $\{\mathbf{b}_1, \mathbf{b}_2, \mathbf{b}_3\}$。在[凝聚态物理学](@entry_id:140205)中，它们通常由以下**对偶关系（duality condition）**定义：
$$ \mathbf{a}_i \cdot \mathbf{b}_j = 2\pi \delta_{ij} $$
其中 $\delta_{ij}$ 是克罗内克符号。由这些倒易[基矢](@entry_id:199546)的整数组合构成的矢量集合 $\mathbf{G}_{hkl} = h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3$（其中 $h,k,l$ 为整数）构成了倒易点阵。

需要注意的是，在晶体学文献中，有时会使用另一种不含 $2\pi$ 的归一化约定：$\mathbf{a}^i \cdot \mathbf{a}_j = \delta^i_j$。这两种约定下的倒易[基矢](@entry_id:199546)关系为 $\mathbf{b}_i = 2\pi \mathbf{a}^i$。在本章中，我们将主要采用包含 $2\pi$ 的物理学约定，但在讨论具体应用如[晶面间距](@entry_id:138338)时，我们会阐明两种约定下的区别。

#### [倒易空间](@entry_id:754151)中的晶面与[晶向](@entry_id:137393)

在倒易空间的框架下，[晶面](@entry_id:166481) $(hkl)$ 的定义变得异常简洁和深刻：**一个 $(hkl)$ [晶面](@entry_id:166481)族是垂直于倒易点阵矢量 $\mathbf{G}_{hkl} = h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3$ 的一系列等间距[平行平面](@entry_id:165919)**。

这个定义具有根本性的意义。它表明[密勒指数](@entry_id:138901) $(h,k,l)$ 本质上是倒易点阵矢量在倒易[基矢](@entry_id:199546)下的坐标。这个定义不依赖于晶轴是否正交，因此对所有14种布拉菲点阵都普遍适用。

更进一步，$(hkl)$ 晶面族可以被看作是平面波函数 $\exp(i\mathbf{G}_{hkl}\cdot\mathbf{r})$ 的等相位面。包含所有[晶格](@entry_id:196752)点的平面由方程 $\mathbf{G}_{hkl}\cdot\mathbf{r} = 2\pi n$（其中 $n$ 为整数）给出，每个整数 $n$ 对应族中的一个平面。

#### 宗带定律：晶面与[晶向](@entry_id:137393)的关系

倒易空间的引入使得分析[晶面](@entry_id:166481)与[晶向](@entry_id:137393)之间的几何关系变得极为方便。一个重要的关系是判断一个[晶向](@entry_id:137393) $[uvw]$ 是否位于一个晶面 $(hkl)$ 之内。

几何上，如果一个方向位于一个平面内，那么代表该方向的矢量必定与该平面的法向矢量垂直。在我们的框架中，[晶向](@entry_id:137393) $[uvw]$ 由[实空间](@entry_id:754128)矢量 $\mathbf{T}_{uvw} = u\mathbf{a}_1 + v\mathbf{a}_2 + w\mathbf{a}_3$ 表示，而[晶面](@entry_id:166481) $(hkl)$ 的法向由[倒易空间](@entry_id:754151)矢量 $\mathbf{G}_{hkl} = h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3$ 表示。

因此，垂直条件可以写作它们的[点积](@entry_id:149019)为零：
$$ \mathbf{G}_{hkl} \cdot \mathbf{T}_{uvw} = 0 $$
将矢量的表达式代入并利用对偶关系 $\mathbf{a}_i \cdot \mathbf{b}_j = 2\pi\delta_{ij}$，我们可以展开这个[点积](@entry_id:149019)：
$$ (h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3) \cdot (u\mathbf{a}_1 + v\mathbf{a}_2 + w\mathbf{a}_3) = 2\pi(hu + kv + lw) $$
要使[点积](@entry_id:149019)为零，必须满足：
$$ hu + kv + lw = 0 $$
这个极其简洁而强大的方程被称为**魏斯宗带定律（Weiss zone law）**或**宗带条件（zone axis condition）**。它适用于任何布拉菲点阵，因为其推导过程完全不依赖于[晶格](@entry_id:196752)的度规（即轴长和轴角），而仅仅依赖于实空间与倒易空间的对偶性。

在几何上，所有与同一个[晶向](@entry_id:137393)（称为**宗带轴 zone axis**）平行的[晶面](@entry_id:166481)构成一个**晶带（zone）**。宗带定律的几何意义是：一个晶面 $(hkl)$ 属于以 $[uvw]$ 为宗带轴的晶带，当且仅当其法向矢量 $\mathbf{G}_{hkl}$ 与宗带轴矢量 $\mathbf{T}_{uvw}$ 相垂直。

一个常见的误区是认为[实空间](@entry_id:754128)方向 $[hkl]$ 总是与 $(hkl)$ [晶面](@entry_id:166481)的法向平行。这仅在具有高度对称性的[晶格](@entry_id:196752)（如立方、四方、正交晶系）中成立，因为在这些体系中 $\mathbf{a}_i$ 与 $\mathbf{b}_i$ 是平行的。对于一般的非正交[晶系](@entry_id:137271)（如单斜、三斜），$\mathbf{T}_{hkl} = h\mathbf{a}_1 + k\mathbf{a}_2 + l\mathbf{a}_3$ 通常不与 $\mathbf{G}_{hkl} = h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3$ 平行。

#### 非正交[晶格](@entry_id:196752)的稳健算法

倒易空间的框架为在非正交[晶格](@entry_id:196752)中确定[密勒指数](@entry_id:138901)提供了一种无[歧义](@entry_id:276744)的、稳健的算法，从而避免了截距法可能带来的混淆。当一个平面由三个非共线的[晶格](@entry_id:196752)点 $\mathbf{p}_1, \mathbf{p}_2, \mathbf{p}_3$ 定义时，我们可以按以下步骤确定其[密勒指数](@entry_id:138901) $(h,k,l)$：

1.  **计算几何法向量**：通过这三个点构造两个位于平面内的非平行矢量，例如 $\mathbf{v}_1 = \mathbf{p}_2 - \mathbf{p}_1$ 和 $\mathbf{v}_2 = \mathbf{p}_3 - \mathbf{p}_1$。然后计算它们的叉乘，得到该平面的几何[法向量](@entry_id:264185) $\mathbf{n} = \mathbf{v}_1 \times \mathbf{v}_2$。

2.  **计算倒易[基矢](@entry_id:199546)**：根据[实空间](@entry_id:754128)[基矢](@entry_id:199546) $\{\mathbf{a}_i\}$ 和对偶关系，计算出倒易[基矢](@entry_id:199546) $\{\mathbf{b}_i\}$。

3.  **求解线性方程组**：根据定义，待求的倒易点阵矢量 $\mathbf{G}_{hkl} = h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3$ 必须与几何[法向量](@entry_id:264185) $\mathbf{n}$ 平行。即存在一个标量 $\alpha$，使得 $\mathbf{G}_{hkl} = \alpha \mathbf{n}$。将[基矢](@entry_id:199546)的笛卡尔坐标代入，该矢量方程会分解为三个关于 $h,k,l$ 和 $\alpha$ 的线性代数方程。

4.  **确定指数**：求解这个[方程组](@entry_id:193238)，找到满足条件的最小整数解 $(h,k,l)$。

例如，在一个[基矢](@entry_id:199546)为 $\mathbf{a}_1=(1,0,0)$, $\mathbf{a}_2=(\frac{1}{2},1,0)$, $\mathbf{a}_3=(0,0,1)$ 的非正交[晶格](@entry_id:196752)中，一个通过点 $\mathbf{p}_1=\mathbf{a}_1$, $\mathbf{p}_2=\mathbf{a}_2$, $\mathbf{p}_3=\mathbf{a}_3$ 的平面，其几何法向量可以算出为 $\mathbf{n}=(1, \frac{1}{2}, 1)$。通过计算倒易[基矢](@entry_id:199546)并求解线性方程组 $h\mathbf{b}_1 + k\mathbf{b}_2 + l\mathbf{b}_3 = \alpha \mathbf{n}$，可以唯一地确定该平面的[密勒指数](@entry_id:138901)为 $(111)$。这个例子清晰地展示了[倒易空间](@entry_id:754151)方法在处理一般[晶格](@entry_id:196752)问题时的普适性和精确性。

### 对称性与[晶面](@entry_id:166481)/[晶向](@entry_id:137393)族

在晶体中，许多物理性质（如弹性模量、[电导率](@entry_id:137481)）都表现出各向异性，即沿着不同方向测量时数值不同。然而，由于晶体具有对称性，某些在几何上不等价的方向或平面却可能具有完全相同的物理性质。晶体的**[点群对称性](@entry_id:141230)（point group symmetry）**决定了哪些方向和平面是“等效”的。

#### [点群对称性](@entry_id:141230)的作用

我们将所有通过[晶体点群](@entry_id:183880)操作可以相互转换的晶面集合称为一个**晶面族（family of planes）**，并用花括号 $\{hkl\}$ 表示。类似地，所有等效的[晶向](@entry_id:137393)集合构成一个**[晶向](@entry_id:137393)族（family of directions）**，用尖括号 $\langle uvw \rangle$ 表示。

一个方向 $[u'v'w']$ 与 $[uvw]$ 等效，意味着存在一个属于该[晶体点群](@entry_id:183880)的[对称操作](@entry_id:143398)（如旋转、反映），能将矢量 $u\mathbf{a}+v\mathbf{b}+w\mathbf{c}$ 变换为 $u'\mathbf{a}+v'\mathbf{b}+w'\mathbf{c}$。需要注意的是，平移操作不产生新的方向，因此[点群对称性](@entry_id:141230)是决定等效性的关键。

等效性与[晶格](@entry_id:196752)的对称度密切相关。例如，在对称性最高的立方[晶系](@entry_id:137271)中，晶轴 $\mathbf{a}, \mathbf{b}, \mathbf{c}$ 是等效的，点群操作可以实现它们的任意[置换](@entry_id:136432)。因此，$(100)$, $(010)$ 和 $(001)$ 都是等效的，同属于 $\{100\}$ 族。类似地，通过绕 $\langle 111 \rangle$ 轴的旋转操作，可以证明立方晶系中的 $[110]$, $[011]$ 和 $[101]$ 方向是等效的，它们都属于 $\langle 110 \rangle$ 族。

然而，在对称性较低的晶系中，情况则不同。例如，在四方[晶系](@entry_id:137271)中，$a=b \neq c$，$\mathbf{a}$ 轴和 $\mathbf{b}$ 轴是等效的，但 $\mathbf{c}$ 轴是独特的。因此，$(100)$ 和 $(010)$ 属于 $\{100\}$ 族，但 $(001)$ 属于一个不同的 $\{001\}$ 族。这是因为不存在任何点群操作可以将长度不等的倒易矢量 $\mathbf{a}^*$ 和 $\mathbf{c}^*$ 相互转换。

#### 反演对称性与中心/[非中心对称晶体](@entry_id:162159)

**反演操作（inversion）**是一个特殊的点群操作，它将空间中的每一点 $\mathbf{r}$ 映射到 $-\mathbf{r}$。如果一个晶体的点群包含反演操作，我们称之为**中心对称（centrosymmetric）**晶体；否则称为**[非中心对称](@entry_id:157488)（non-centrosymmetric）**晶体。

这个区别对[晶向](@entry_id:137393)族的构成有重要影响。在[中心对称](@entry_id:144242)晶体中，由于反演是[对称操作](@entry_id:143398)，方向 $[uvw]$ 和其反方向 $[\bar{u}\bar{v}\bar{w}]$ 总是等效的，因此它们属于同一个[晶向](@entry_id:137393)族 $\langle uvw \rangle$。然而，在[非中心对称晶体](@entry_id:162159)中，不存在反演对称性，$[uvw]$ 和 $[\bar{u}\bar{v}\bar{w}]$ 通常是不等效的，它们可能表现出不同的物理性质。这种方向被称为**极性方向（polar direction）**，是压电、[热释电](@entry_id:142387)等效应存在的[晶体学](@entry_id:140656)基础。

### 应用与特例

[密勒指数](@entry_id:138901)不仅是几何标记，更是连接理论模型与实验测量的桥梁。下面我们将探讨几个重要的应用和特殊晶系中的表示法。

#### [晶面间距](@entry_id:138338) (d-spacing)

[晶面间距](@entry_id:138338) $d_{hkl}$ 是[晶面](@entry_id:166481)族 $(hkl)$ 中相邻两个平面之间的[垂直距离](@entry_id:176279)，它是[X射线衍射](@entry_id:147790)实验中的一个核心可观测量。从倒易空间的定义出发，可以严格推导出 $d_{hkl}$ 与相应倒易矢量模长的关系。

如前所述，$(hkl)$ [晶面](@entry_id:166481)族由方程 $\mathbf{G}_{hkl}\cdot\mathbf{r} = 2\pi n$ 定义。相邻两个平面（例如 $n$ 和 $n+1$）之间的垂直距离正是 $d_{hkl}$。这个距离可以导出为：
$$ d_{hkl} = \frac{2\pi}{|\mathbf{G}_{hkl}|} $$
这个关系式在使用含 $2\pi$ 归一化的倒易[基矢](@entry_id:199546)时成立。如果采用不含 $2\pi$ 的晶体学约定，即法向矢量为 $\mathbf{g}_{hkl}=h\mathbf{a}^1+k\mathbf{a}^2+l\mathbf{a}^3$，则相应的关系变为 $d_{hkl} = 1/|\mathbf{g}_{hkl}|$。这两种表达方式描述的是同一个物理量，其数值完全相同，只是倒易矢量本身的定义（模长）不同。

对于一个普遍的三斜[晶格](@entry_id:196752)，我们可以用**[度规张量](@entry_id:160222)（metric tensor）**来表示 $d_{hkl}$。倒易度规张量 $\mathbf{G}^*$ 的分量为 $G^{*}_{ij} = \mathbf{a}^i \cdot \mathbf{a}^j$。法向矢量 $\mathbf{g}_{hkl}$ 的模平方可以写成二次型 $\mathbf{h}^T \mathbf{G}^* \mathbf{h}$，其中 $\mathbf{h}=(h,k,l)^T$。因此，[晶面间距](@entry_id:138338)的普适公式为：
$$ d_{hkl} = \frac{1}{\sqrt{\mathbf{h}^T \mathbf{G}^* \mathbf{h}}} $$
对于正交[晶系](@entry_id:137271)（立方、四方、正交），[基矢](@entry_id:199546)相互垂直，度规张量为对角阵。上述普适公式可以简化为我们所熟知的形式：
$$ \frac{1}{d_{hkl}^2} = \frac{h^2}{a^2} + \frac{k^2}{b^2} + \frac{l^2}{c^2} $$

#### 衍射中的[密勒指数](@entry_id:138901)：[晶格与基元](@entry_id:156406)

[密勒指数](@entry_id:138901)最直接的应用之一是在[晶体衍射](@entry_id:139605)（如[X射线](@entry_id:187649)、中子或[电子衍射](@entry_id:141284)）中标记[布拉格衍射](@entry_id:148063)峰。

晶体可以看作是一个布拉菲点阵与一个**基元（basis）**的卷积。布拉菲点阵是一个纯粹的几何结构，而基元则指位于每个格点上的一个或多个原子。这个区分至关重要：
-   **[晶格](@entry_id:196752)（Lattice）**决定了衍射峰在倒易空间中的**位置**。根据[布拉格定律](@entry_id:140129)，只有当[散射矢量](@entry_id:262662) $\mathbf{q}$ 等于某个倒易点阵矢量 $\mathbf{G}_{hkl}$ 时，才会发生相长干涉，形成衍射峰。因此，衍射峰的位置由[晶格](@entry_id:196752)的几何形状和尺寸唯一确定，每个峰可以用一组[密勒指数](@entry_id:138901) $(hkl)$ 来标记。[晶面间距](@entry_id:138338) $d_{hkl}$ 只依赖于[晶格参数](@entry_id:191810)，与基元中的原子排布无关。

-   **基元（Basis）**决定了每个衍射峰的**强度**。在 $\mathbf{q}=\mathbf{G}_{hkl}$ 的位置，衍射强度正比于**[结构因子](@entry_id:158623)（structure factor）** $S_{hkl}$ 的模平方。结构因子是对基元中所有原子[散射振幅](@entry_id:155369)的相干求和：$S_{hkl} = \sum_j f_j e^{-i\mathbf{G}_{hkl}\cdot\boldsymbol{\tau}_j}$，其中 $f_j$ 是第 $j$ 个原子的[原子散射因子](@entry_id:197944)，$\boldsymbol{\tau}_j$ 是其在[原胞](@entry_id:159354)中的位置。

如果由于基元中原子的特殊排布，导致在某个 $\mathbf{G}_{hkl}$ 位置的 $S_{hkl}$ 恰好为零，那么对应的衍射峰就会消失。这被称为**系统性消光（systematic extinction）**。

一个典型的例子是[面心立方](@entry_id:156319)（FCC）[晶格](@entry_id:196752)。它可以被看作是一个[简单立方晶格](@entry_id:160687)，其每个[原胞](@entry_id:159354)包含4个原子的基元。通过计算其结构因子可以发现，只有当 $(hkl)$ 指数具有相同奇偶性（即全为奇数或全为偶数）时，衍射峰才存在；而对于混合奇偶性的指数，衍射峰则会因相消干涉而消失。

此外，即使对于存在的衍射峰，其强度也并非相同。例如，在FCC晶体中，虽然 $(111)$ 和 $(200)$ 都是允许的衍射，但它们的强度通常不同。这不仅是因为[原子散射因子](@entry_id:197944) $f_j$ 本身会随散射角（即 $|\mathbf{G}_{hkl}|$ 的大小）增大而减小，还因为存在其他与衍射几何相关的因子（如多重度因子、洛伦兹-偏振因子）。

#### 六方[晶系](@entry_id:137271)：[密勒-布拉菲指数](@entry_id:161411)

对于六方晶系，使用三指数的密勒记号 $(hkl)$ 和 $[uvw]$ 会掩盖其特有的六重或三重对称性。为了更直观地体现这种对称性，晶体学中引入了四指数的**密勒-布拉菲（Miller-Bravais）**记号。

对于[晶面](@entry_id:166481)，记为 $(hkil)$，其中引入了一个冗余的指数 $i$，它与 $h$ 和 $k$ 满足约束条件 $h+k+i=0$。这四个指数分别对应于六方[晶格](@entry_id:196752)的三个位于基面内、互成 $120^\circ$ 的 $\mathbf{a}_1, \mathbf{a}_2, \mathbf{a}_3$ 轴和垂直于基面的 $\mathbf{c}$ 轴上的截距倒数。

对于[晶向](@entry_id:137393)，也使用四指数记号 $[uvtw]$，同样满足基面指数的约束条件 $u+v+t=0$。一个基于三轴[基矢](@entry_id:199546) $\{\mathbf{a}_1, \mathbf{a}_2, \mathbf{c}\}$ 的三指数[晶向](@entry_id:137393) $[UVW]_3$ 可以通过一个线性变换转换为四指数[晶向](@entry_id:137393) $[uvtw]_4$。通过等同这两个[坐标系](@entry_id:156346)下表示的同一个物理矢量，并利用[基矢](@entry_id:199546)关系 $\mathbf{a}_3 = -(\mathbf{a}_1+\mathbf{a}_2)$ 和约束条件，可以推导出它们之间的变换关系：
$$ \begin{pmatrix} u \\ v \\ t \\ w \end{pmatrix} = \begin{pmatrix} \frac{2}{3}  -\frac{1}{3}  0 \\ -\frac{1}{3}  \frac{2}{3}  0 \\ -\frac{1}{3}  -\frac{1}{3}  0 \\ 0  0  1 \end{pmatrix} \begin{pmatrix} U \\ V \\ W \end{pmatrix} $$
得到的 $(u,v,t,w)$ 组分再乘以一个公共因子以化为最小整数，即得到最终的四指数[晶向](@entry_id:137393)。例如，[基矢](@entry_id:199546)方向 $[100]_3$ 对应于 $[2\bar{1}\bar{1}0]_4$。通过这种表示法，六方晶系中对称等效的方向（如 $[2\bar{1}\bar{1}0]$, $[\bar{1}2\bar{1}0]$, $[\bar{1}\bar{1}20]$）可以通过简单地轮换前三个指数得到，其对称性一目了然。