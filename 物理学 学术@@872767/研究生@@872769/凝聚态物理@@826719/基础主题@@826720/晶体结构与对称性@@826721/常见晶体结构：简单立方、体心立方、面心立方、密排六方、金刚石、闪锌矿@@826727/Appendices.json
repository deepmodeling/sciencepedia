{"hands_on_practices": [{"introduction": "掌握晶体结构分析的第一步是从最基本的定义出发，通过几何推理来理解原子的空间排布。本练习将引导你从第一性原理出发，对最简单的晶体结构——简单立方（sc）晶格——进行分析。通过直接应用布拉维晶格的定义和欧几里得距离，你将亲手推导出配位数和近邻距离等基本参数，为理解更复杂的结构打下坚实的几何基础。[@problem_id:2976225]", "problem": "一个单原子晶体形成了简单立方 (sc) 布拉维晶格，其常规立方晶格常数为 $a$。仅使用布拉维晶格的定义、实空间中原子间距的欧几里得度量，以及配位数作为第一近邻壳层中原子数量的定义，从第一性原理推导简单立方结构中的配位数和最近邻距离，并将它们表示为 $a$ 的函数。此外，请列举第二和第三近邻壳层，给出它们的多重性（每个壳层中有多少个近邻原子）以及它们到参考原子的相应距离，同样表示为 $a$ 的函数。\n\n您的推导必须从晶格矢量和晶格平移矢量集开始，然后通过将不同壳层识别为与原点等距的格点集合（不包括原点本身）来进行。\n\n将您的最终结果以单行矩阵的形式报告，按顺序包含 $z_{1}$、$r_{1}$、$z_{2}$、$r_{2}$、$z_{3}$、$r_{3}$，其中 $z_{n}$ 是第 $n$ 个近邻壳层的多重性，$r_{n}$ 是其距离，所有量都用 $a$ 表示。\n\n最终答案中不要包含单位。无需进行数值四舍五入；请提供精确的符号表达式。", "solution": "该问题提法清晰且科学上合理，基于晶体学和固态物理学的基础概念。我们将从第一性原理出发进行严格推导。\n\n布拉维晶格是由位置矢量 $\\vec{R}$ 定义的无限点阵，其形式为：\n$$\n\\vec{R} = n_1 \\vec{a}_1 + n_2 \\vec{a}_2 + n_3 \\vec{a}_3\n$$\n其中 $\\vec{a}_1, \\vec{a}_2, \\vec{a}_3$ 是原胞晶格矢量，而 $n_1, n_2, n_3$ 是任意整数。对于一个常规立方晶格常数为 $a$ 的简单立方 (sc) 晶格，原胞晶格矢量的最简单选择是使其与笛卡尔坐标系对齐：\n$$\n\\vec{a}_1 = a \\hat{x}, \\quad \\vec{a}_2 = a \\hat{y}, \\quad \\vec{a}_3 = a \\hat{z}\n$$\n因此，任何格点都可以用对应于整数三元组 $(n_x, n_y, n_z)$ 的矢量 $\\vec{R}$ 来表示：\n$$\n\\vec{R}(n_x, n_y, n_z) = a(n_x \\hat{x} + n_y \\hat{y} + n_z \\hat{z})\n$$\n我们在原点处建立一个参考原子，对应于三元组 $(0, 0, 0)$。从此参考原子到位于位置 $\\vec{R}$ 的任何其他原子的距离 $d$ 由矢量 $\\vec{R}$ 的欧几里得范数给出：\n$$\nd = |\\vec{R}| = \\sqrt{\\vec{R} \\cdot \\vec{R}} = \\sqrt{(a n_x)^2 + (a n_y)^2 + (a n_z)^2} = a \\sqrt{n_x^2 + n_y^2 + n_z^2}\n$$\n近邻壳层被定义为与参考原子等距的原子集合。为了识别这些壳层，我们必须考虑所有非零整数三元组 $(n_x, n_y, n_z)$，并系统地计算平方和 $S = n_x^2 + n_y^2 + n_z^2$，从而找到 $d$ 的不同值。壳层的距离则为 $r = a\\sqrt{S}$，其多重性（壳层中的原子数）是产生相同 $S$ 值的不同整数三元组 $(n_x, n_y, n_z)$ 的数量。\n\n**第一近邻壳层 ($n=1$):**\n我们寻找 $S = n_x^2 + n_y^2 + n_z^2$ 的最小非零值。由于 $n_x, n_y, n_z$ 是整数， $n_i^2$ 的最小可能非零值为 $1, 4, 9, \\dots$。当其中一个整数为 $\\pm 1$ 而另外两个为 $0$ 时，可以得到最小和 $S_1$。\n$$\nS_1 = (\\pm 1)^2 + 0^2 + 0^2 = 1\n$$\n到这个第一壳层的距离，即最近邻距离 $r_1$ 是：\n$$\nr_1 = a \\sqrt{S_1} = a \\sqrt{1} = a\n$$\n该壳层的多重性 $z_1$，也就是配位数，是所有导致 $S_1=1$ 的整数三元组的数量。这些是 $(\\pm 1, 0, 0)$ 的排列：\n- $(\\pm 1, 0, 0)$: $2$ 个原子 (沿正负 $x$ 轴)\n- $(0, \\pm 1, 0)$: $2$ 个原子 (沿正负 $y$ 轴)\n- $(0, 0, \\pm 1)$: $2$ 个原子 (沿正负 $z$ 轴)\n总多重性为 $z_1 = 2 + 2 + 2 = 6$。\n\n**第二近邻壳层 ($n=2$):**\n平方和的下一个最小值 $S_2$ 是通过将两个整数设为 $\\pm 1$、一个设为 $0$ 得到的。\n$$\nS_2 = (\\pm 1)^2 + (\\pm 1)^2 + 0^2 = 1 + 1 + 0 = 2\n$$\n到第二近邻壳层的距离 $r_2$ 是：\n$$\nr_2 = a \\sqrt{S_2} = a \\sqrt{2}\n$$\n多重性 $z_2$ 是所有导致 $S_2=2$ 的整数三元组的数量。这些是 $(\\pm 1, \\pm 1, 0)$ 的排列：\n- $(\\pm 1, \\pm 1, 0)$: $4$ 个原子 (在 $xy$ 平面，位于 $(\\pm a, \\pm a, 0)$)\n- $(\\pm 1, 0, \\pm 1)$: $4$ 个原子 (在 $xz$ 平面，位于 $(\\pm a, 0, \\pm a)$)\n- $(0, \\pm 1, \\pm 1)$: $4$ 个原子 (在 $yz$ 平面，位于 $(0, \\pm a, \\pm a)$)\n总多重性为 $z_2 = 4 + 4 + 4 = 12$。这些近邻原子位于以原点为中心、边长为 $2a$ 的立方体的面心上。\n\n**第三近邻壳层 ($n=3$):**\n平方和的下一个不同值 $S_3$ 是通过将所有三个整数都设为 $\\pm 1$ 得到的。\n$$\nS_3 = (\\pm 1)^2 + (\\pm 1)^2 + (\\pm 1)^2 = 1 + 1 + 1 = 3\n$$\n注意，和 $S=4$ (例如，来自 $2^2+0^2+0^2$) 大于 $S=3$。到第三近邻壳层的距离 $r_3$ 是：\n$$\nr_3 = a \\sqrt{S_3} = a \\sqrt{3}\n$$\n多重性 $z_3$ 是所有导致 $S_3=3$ 的整数三元组的数量。这些是所有分量均为 $\\pm 1$ 的三元组：\n- $(\\pm 1, \\pm 1, \\pm 1)$: 共有 $2 \\times 2 \\times 2 = 8$ 种可能的符号组合。\n总多重性为 $z_3 = 8$。这些近邻原子位于以原点为中心、边长为 $2a$ 的立方体的顶点上。\n\n总而言之，我们推导出了简单立方晶格前三个近邻壳层的以下量：\n- 第1壳层: $z_1 = 6$, $r_1 = a$\n- 第2壳层: $z_2 = 12$, $r_2 = a\\sqrt{2}$\n- 第3壳层: $z_3 = 8$, $r_3 = a\\sqrt{3}$\n\n现在将这些结果汇编成所要求的矩阵格式。", "answer": "$$\n\\boxed{\\begin{pmatrix} 6  a  12  a\\sqrt{2}  8  a\\sqrt{3} \\end{pmatrix}}\n$$", "id": "2976225"}, {"introduction": "在掌握了分析简单晶格的基本方法后，我们将转向更为常见且重要的面心立方（FCC）结构，许多金属元素（如铜、银、金）都采用这种结构。本练习要求你基于“硬球模型”计算FCC结构中的原子半径与晶格常数的关系，并推导出其原子堆积因子。这个过程不仅能加深你对密堆积结构几何特征的理解，还能让你体会到晶体结构如何决定材料的致密程度等宏观物理性质。[@problem_id:2976229]", "problem": "一个单原子晶体由面心立方（FCC）晶格描述，其中相同的原子可以被建模为位于晶格点上的半径为 $r$ 的不可穿透的硬球。考虑一个边长为 $a$ 的常规立方晶胞。在此结构中，已知最近邻原子通过立方体的面对角线几何关系相关联。\n\n从面心立方（FCC）晶格的几何定义和硬球最近邻接触的概念出发，推导硬球半径 $r$ 与常规晶格参数 $a$ 之间的精确关系。然后，通过计算与常规 FCC 晶胞相关的原子数，并使用球体体积的标准公式，推导精确的堆积率 $\\eta_{\\mathrm{fcc}}$，其定义为常规晶胞内所含硬球总体积与常规晶胞体积之比。以精确的符号形式提供 $r$ 和 $\\eta_{\\mathrm{fcc}}$ 的最终结果（按此顺序）。不需要四舍五入，最终表达式中不应包含任何物理单位。", "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确、客观，并包含足够的信息以得出唯一解。这是固体物理导论中的一个标准问题。\n\n第一步是为面心立方（FCC）晶格建立硬球半径 $r$ 和常规立方晶胞的晶格参数 $a$ 之间的几何关系。常规 FCC 晶胞是一个边长为 $a$ 的立方体，其 $8$ 个顶点各有一个原子， $6$ 个面的中心各有一个原子。问题陈述，原子被建模为不可穿透的硬球，并且最近邻原子相互接触。\n\n在 FCC 结构中，原子之间的最短距离出现在立方体的面对角线上。让我们考虑立方体的一个面。该面的四个顶点各有一个原子，面中心有一个原子。面中心的原子是该面四个顶角原子的最近邻。硬球模型要求这些原子沿着连接其中心的线（即面对角线）接触。\n\n连接边长为 $a$ 的正方形面的两个相对顶点的面对角线的全长，可以使用勾股定理计算得出：$d_{\\mathrm{face}} = \\sqrt{a^2 + a^2} = \\sqrt{2a^2} = a\\sqrt{2}$。\n\n这条对角线穿过一个顶角原子（贡献其半径长度 $r$），一个面心原子的完整直径（贡献长度 $2r$），以及对角的另一个顶角原子（贡献其半径长度 $r$）。因此，以原子半径表示的面对角线总长度是这些长度的总和：$d_{\\mathrm{face}} = r + 2r + r = 4r$。\n\n通过将面对角线长度的两个表达式相等，我们得到 $r$ 和 $a$ 之间的关系：\n$$4r = a\\sqrt{2}$$\n解出半径 $r$ 得：\n$$r = \\frac{a\\sqrt{2}}{4}$$\n这个表达式也可以写成 $r = \\frac{a}{2\\sqrt{2}}$，但我们将使用分母有理化的形式。这是第一个要求的结果。\n\n第二步是计算原子堆积率 $\\eta_{\\mathrm{fcc}}$。它被定义为常规晶胞内原子所占的总体积与晶胞本身体积之比。\n$$\\eta_{\\mathrm{fcc}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}}$$\n常规立方晶胞的体积很简单：\n$$V_{\\mathrm{cell}} = a^3$$\n为了求出原子的总体积 $V_{\\mathrm{atoms}}$，我们必须首先确定一个常规晶胞内包含的原子数 $N_{\\mathrm{cell}}$。\n立方体 $8$ 个顶角的原子每个都被 $8$ 个相邻的晶胞所共享。因此，顶角原子的贡献是 $8 \\times \\frac{1}{8} = 1$ 个原子。\n$6$ 个面中心的原子每个都被 $2$ 个相邻的晶胞所共享。因此，面心原子的贡献是 $6 \\times \\frac{1}{2} = 3$ 个原子。\n每个常规晶胞的总原子数是这些贡献的总和：\n$$N_{\\mathrm{cell}} = 1 + 3 = 4$$\n半径为 $r$ 的单个球形原子的体积由标准公式给出：\n$$V_{\\mathrm{sphere}} = \\frac{4}{3}\\pi r^3$$\n因此，常规晶胞内原子的总体积为：\n$$V_{\\mathrm{atoms}} = N_{\\mathrm{cell}} \\times V_{\\mathrm{sphere}} = 4 \\times \\frac{4}{3}\\pi r^3 = \\frac{16}{3}\\pi r^3$$\n现在，我们将 $r$ 关于 $a$ 的表达式（$r = \\frac{a\\sqrt{2}}{4}$）代入 $V_{\\mathrm{atoms}}$ 的方程中：\n$$V_{\\mathrm{atoms}} = \\frac{16}{3}\\pi \\left(\\frac{a\\sqrt{2}}{4}\\right)^3 = \\frac{16}{3}\\pi \\left(\\frac{a^3 (\\sqrt{2})^3}{4^3}\\right) = \\frac{16}{3}\\pi \\left(\\frac{a^3 \\cdot 2\\sqrt{2}}{64}\\right)$$\n简化这个表达式：\n$$V_{\\mathrm{atoms}} = \\frac{32\\pi\\sqrt{2}a^3}{192} = \\frac{\\pi\\sqrt{2}a^3}{6}$$\n最后，我们可以通过计算 $V_{\\mathrm{atoms}}$ 与 $V_{\\mathrm{cell}}$ 的比值来计算堆积率 $\\eta_{\\mathrm{fcc}}$：\n$$\\eta_{\\mathrm{fcc}} = \\frac{V_{\\mathrm{atoms}}}{V_{\\mathrm{cell}}} = \\frac{\\frac{\\pi\\sqrt{2}a^3}{6}}{a^3}$$\n$a^3$ 项被消去，得到 FCC 晶格的精确堆积率：\n$$\\eta_{\\mathrm{fcc}} = \\frac{\\pi\\sqrt{2}}{6}$$\n这是第二个要求的结果。它是一个无量纲常数，近似值为 $0.74$，代表等大球体的最大可能堆积密度。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{a\\sqrt{2}}{4}  \\frac{\\pi\\sqrt{2}}{6} \\end{pmatrix}}$$", "id": "2976229"}, {"introduction": "理论学习的最终目的是为了解释和预测实验现象。本练习将理论与实践相结合，要求你编写程序来模拟面心立方（FCC）晶体的劳厄X射线衍射图样。通过这个计算实践，你不仅能巩固对倒易晶格、系统性消光和晶体对称性等概念的理解，还能直观地看到晶体的微观结构如何决定其在真实实验中的宏观衍射信号。[@problem_id:2976233]", "problem": "考虑一个面心立方 (FCC) 晶体，其取向使得晶体学方向 $[001]$ 与入射的多色 X 射线束对齐。您将根据以下假设模拟背反射劳厄图样，并推导出一个程序来识别对称等效的反射和系统性消光。\n\n使用以下原理和定义作为基本基础：\n-   参数为 $a$ 的立方晶格的倒易晶格具有原胞基矢 $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$、$\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$ 和 $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$。对于密勒指数 $(h,k,l)$，倒易晶格矢量为 $\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3$。\n-   在 X 射线弹性散射中，劳厄条件规定 $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$，且 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda$ 是波长。设 $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$，施加 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$ 的条件可得出标量约束 $|\\mathbf{G}|^2 + 2 k_0 G_z = 0$，由此可解出 $k_0$ 为 $k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$。一个具有物理意义的正值 $k_0$ 要求 $G_z  0$（对于入射束沿 $+\\hat{\\mathbf{z}}$ 方向的背反射）。\n-   对于基底位置在 $(0,0,0)$、$(0,\\frac{1}{2},\\frac{1}{2})$、$(\\frac{1}{2},0,\\frac{1}{2})$、$(\\frac{1}{2},\\frac{1}{2},0)$ 的相同原子组成的面心立方晶格，其结构因子为 $F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$，其中 $f$ 是原子散射因子。这意味着选择定则 $F(h,k,l) \\neq 0$ 当且仅当 $h$、$k$ 和 $l$ 全为偶数或全为奇数（否则为系统性消光）。\n-   在入射侧 $z = -D$（其中 $D  0$）处放置一个垂直于入射束的平面探测器，以记录背反射。对于每个衍射方向为 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{|\\mathbf{k}_{\\text{out}}|}$ 且 $\\hat{\\mathbf{u}}\\cdot\\hat{\\mathbf{z}}  0$ 的衍射束，其与探测器平面的交点发生在沿射线 $\\mathbf{r}(t) = t \\hat{\\mathbf{u}}$ 的参数 $t = -\\frac{D}{\\hat{\\mathbf{u}}_z}$ 处，给出屏幕坐标 $(x,y) = (t \\hat{\\mathbf{u}}_x, t \\hat{\\mathbf{u}}_y)$。屏幕半径为 $R = \\sqrt{x^2 + y^2}$。\n\n您的任务：\n1.  生成所有密勒指数 $(h,k,l)$，其中 $-N \\le h,k,l \\le N$，排除 $(0,0,0)$ 并限制 $l  0$ 以确保背反射候选的 $G_z  0$。对每个候选，计算 $\\mathbf{G}$、$k_0 = -\\frac{|\\mathbf{G}|^2}{2 G_z}$ 和波长 $\\lambda = \\frac{2\\pi}{k_0}$。\n2.  应用 FCC 选择定则来识别系统性消光（即 $h, k, l$ 不全为偶数或不全为奇数的那些）。从进一步的几何考虑中丢弃这些。\n3.  通过仅接受 $\\lambda_{\\min} \\le \\lambda \\le \\lambda_{\\max}$ 的反射来施加一个符合物理现实的连续谱辐射带；丢弃波长带之外的反射，视为未记录。\n4.  计算衍射方向 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{in}} + \\mathbf{G}}{|\\mathbf{k}_{\\text{in}} + \\mathbf{G}|}$，其中 $\\mathbf{k}_{\\text{in}} = k_0 \\hat{\\mathbf{z}}$，并且仅接受 $\\hat{\\mathbf{u}}_z  0$ 的背反射。对于每个接受的反射，计算屏幕半径 $R$ 并以毫米表示。\n5.  识别在围绕 $[001]$ 的四重旋转对称性与面内镜面对称性（围绕 $[001]$ 的点群 $4/mmm$）下的对称等效反射。如果 $l' = l$ 并且 $(h',k')$ 可以通过在 $x$-$y$ 平面内进行任意组合的 90 度旋转和符号翻转从 $(h,k)$ 得到，则两个反射 $(h,k,l)$ 和 $(h',k',l')$ 被认为是等效的。为实现目的，使用规范键 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$ 对等效性进行分类。\n6.  对于每个测试用例，产生以下输出：\n    -   一个整数：所考虑的 $l0$ 的候选指数总数（不包括 $(0,0,0)$）。\n    -   一个整数：这些候选指数中的系统性消光数量（FCC 选择定则不满足）。\n    -   一个整数：经过所有物理筛选（波长带和背反射方向）后记录的反射数量。\n    -   一个整数：记录的反射中基于上述关键字的对称等效类数量。\n    -   一个浮点数：记录的反射的平均屏幕半径，单位为毫米，四舍五入到小数点后六位。如果没有记录到反射，则返回 $0.0$。\n\n使用以下测试套件，所有长度参数以米表示，波长以米表示：\n-   测试用例 1（正常路径）：$a = 4.05\\times 10^{-10}$，$D = 0.10$，$N = 4$，$\\lambda_{\\min} = 0.5\\times 10^{-10}$，$\\lambda_{\\max} = 2.0\\times 10^{-10}$。\n-   测试用例 2（扩展覆盖范围）：$a = 3.52\\times 10^{-10}$，$D = 0.15$，$N = 5$，$\\lambda_{\\min} = 0.4\\times 10^{-10}$，$\\lambda_{\\max} = 2.5\\times 10^{-10}$。\n-   测试用例 3（窄带边缘情况）：$a = 4.05\\times 10^{-10}$，$D = 0.10$，$N = 2$，$\\lambda_{\\min} = 1.5\\times 10^{-10}$，$\\lambda_{\\max} = 1.6\\times 10^{-10}$。\n\n您的程序应将所有测试用例的结果汇总到一行输出中，形式为用方括号括起来的逗号分隔列表。每个测试用例的结果必须是按上述顺序排列的列表，因此最终输出必须是以下形式\n$[ [r_{1,1}, r_{1,2}, r_{1,3}, r_{1,4}, r_{1,5}], [r_{2,1}, r_{2,2}, r_{2,3}, r_{2,4}, r_{2,5}], [r_{3,1}, r_{3,2}, r_{3,3}, r_{3,4}, r_{3,5}] ]$，\n其中 $r_{j,i}$ 是按定义的整数或浮点数。每个内部列表中的最后一项必须是以毫米为单位表示的平均半径，四舍五入到小数点后六位。", "solution": "用户希望模拟面心立方 (FCC) 晶体的背反射劳厄 X 射线衍射图样并分析结果。该问题在科学上是合理的、定义明确的，并且所有参数和步骤都清晰界定。我将逐步推导解决方案，这将构成最终程序的基础。\n\n### 1. 理论框架\n\n该问题基于 X 射线衍射运动学，由劳厄条件和倒易晶格的几何形状描述。\n\n**倒易晶格与入射束：**\n该晶体是面心立方 (FCC) 晶格，其倒易晶格为体心立方 (BCC)。然而，对于边长为 $a$ 的立方常规晶胞，使用基于简单立方基底的倒易晶格矢量更为简单：\n_$\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$, $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$._\n倒易晶格矢量 $\\mathbf{G}$ 由密勒指数 $(h,k,l)$ 给出：\n_$\\mathbf{G} = h\\mathbf{b}_1 + k\\mathbf{b}_2 + l\\mathbf{b}_3 = \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$._\n入射 X 射线束的波矢 $\\mathbf{k}_{\\text{in}}$ 与 $[001]$ 方向（$\\hat{\\mathbf{z}}$ 轴）对齐。其大小为 $k_0 = |\\mathbf{k}_{\\text{in}}| = \\frac{2\\pi}{\\lambda}$，其中 $\\lambda$ 是波长。\n_$\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$._\n\n**劳厄条件与波长选择：**\n弹性散射的条件是 $\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G}$ 且 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}|$。对第一个方程平方得到：\n_$$|\\mathbf{k}_{\\text{out}}|^2 = |\\mathbf{k}_{\\text{in}}|^2 + |\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G}$$_\n代入 $|\\mathbf{k}_{\\text{out}}| = |\\mathbf{k}_{\\text{in}}| = k_0$ 将其简化为厄瓦尔德球构图的基本方程：\n_$$|\\mathbf{G}|^2 + 2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 0$$_\n当 $\\mathbf{k}_{\\text{in}} = k_0\\hat{\\mathbf{z}}$ 且 $\\mathbf{G} = \\frac{2\\pi}{a}(h, k, l)$ 时，点积变为 $2\\mathbf{k}_{\\text{in}}\\cdot\\mathbf{G} = 2k_0 G_z = 2k_0 \\frac{2\\pi l}{a}$。模的平方是 $|\\mathbf{G}|^2 = (\\frac{2\\pi}{a})^2(h^2+k^2+l^2)$。代入这些值得到：\n_$$(\\frac{2\\pi}{a})^2(h^2+k^2+l^2) + 2k_0 (\\frac{2\\pi l}{a}) = 0$$_\n解出 $k_0$ 得：\n_$$k_0 = -\\frac{(\\frac{2\\pi}{a})^2(h^2+k^2+l^2)}{2 (\\frac{2\\pi l}{a})} = -\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}$$_\n由于 $k_0$ 必须为正，且 $h^2+k^2+l^2  0$，我们必须有 $l  0$。这证实了问题对候选反射的约束。相应的波长 $\\lambda = \\frac{2\\pi}{k_0}$ 是：\n_$$\\lambda = \\frac{2\\pi}{-\\frac{\\pi}{a}\\frac{h^2+k^2+l^2}{l}} = -2a \\frac{l}{h^2+k^2+l^2}$$_\n这个简单的公式将用于检查反射是否由给定的波长带 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 激发。\n\n**FCC 选择定则：**\n对于基底原子位于 $(0,0,0), (0,\\frac{1}{2},\\frac{1}{2}), (\\frac{1}{2},0,\\frac{1}{2}), (\\frac{1}{2},\\frac{1}{2},0)$ 的单原子 FCC 晶格，其结构因子为：\n_$$F(h,k,l) = f\\left[1 + e^{i\\pi(k+l)} + e^{i\\pi(h+l)} + e^{i\\pi(h+k)}\\right]$$_\n其中 $f$ 是原子散射因子。这个和仅在密勒指数 $h, k, l$ 全为偶数或全为奇数时非零。具有混合宇称指数的反射是“系统性消光”的。\n\n**背反射几何与探测器坐标：**\n在背反射装置中，衍射束必须向后传播才能被记录。衍射束的方向是 $\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0}$。其 $z$ 分量必须为负，即 $\\hat{u}_z  0$。\n_$$\\mathbf{k}_{\\text{out}} = \\mathbf{k}_{\\text{in}} + \\mathbf{G} = k_0\\hat{\\mathbf{z}} + \\frac{2\\pi}{a}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$_\n_$$\\hat{\\mathbf{u}} = \\frac{\\mathbf{k}_{\\text{out}}}{k_0} = \\hat{\\mathbf{z}} + \\frac{2\\pi}{ak_0}(h\\hat{\\mathbf{x}} + k\\hat{\\mathbf{y}} + l\\hat{\\mathbf{z}})$$__\n代入 $k_0$ 的表达式：\n_$$\\hat{u}_z = 1 + \\frac{2\\pi l}{ak_0} = 1 + \\frac{2\\pi l}{a} \\left( -\\frac{a}{\\pi}\\frac{l}{h^2+k^2+l^2} \\right) = 1 - \\frac{2l^2}{h^2+k^2+l^2} = \\frac{h^2+k^2-l^2}{h^2+k^2+l^2}$$__\n因此，条件 $\\hat{u}_z  0$ 简化为 $h^2+k^2-l^2  0$，或 $h^2+k^2  l^2$。\n\n探测器是一个位于 $z=-D$ 的平面。沿 $\\hat{\\mathbf{u}}$ 从原点发出的衍射光线到达探测器上的 $(x,y,-D)$。位置矢量为 $t\\hat{\\mathbf{u}}$，所以 $t\\hat{u}_z = -D$，这意味着 $t = -D/\\hat{u}_z$。光斑半径 $R$ 为：\n_$$R = \\sqrt{(t\\hat{u}_x)^2 + (t\\hat{u}_y)^2} = |t|\\sqrt{\\hat{u}_x^2 + \\hat{u}_y^2} = t\\sqrt{1-\\hat{u}_z^2} = -\\frac{D}{\\hat{u}_z}\\sqrt{1-\\hat{u}_z^2}$$__\n这等价于 $R = D\\tan\\theta$，其中 $\\theta$ 是偏离垂直于胶片的中心轴的角度。我们可以推导出用密勒指数表示的直接表达式：\n_$$R = D \\frac{2|l|\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\n由于 $l0$，这也可以写成：\n_$$R = D \\frac{-2l\\sqrt{h^2+k^2}}{l^2 - (h^2+k^2)}$$_\n\n**对称等效性：**\n问题根据 $[001]$ 轴的四重旋转对称性和镜面（点群 $4/mmm$）来定义对称等效性。对于固定的 $l$，如果对 $(|h'|,|k'|)$ 是对 $(|h|,|k|)$ 的一个排列，则任意两个反射 $(h,k,l)$ 和 $(h',k',l')$ 是等效的。表示每个等效类的规范键是 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$。\n\n### 2. 算法设计\n\n该解决方案将通过迭代候选密勒指数并应用一系列过滤器来实现。\n\n1.  **生成候选**：迭代所有整数 $h, k, l$，使得 $-N \\le h,k \\le N$ 且 $-N \\le l  0$。计数这些以获得 `total_candidates`。\n2.  **过滤器 1 (系统性消光)**：对于每个 $(h,k,l)$，检查指数是否全为偶数或全为奇数。如果它们的宇称混合，则增加 `systematic_absences` 并丢弃。\n3.  **过滤器 2 (波长)**：计算 $\\lambda = -2a \\frac{l}{h^2+k^2+l^2}$。如果 $\\lambda$ 不在 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 范围内，则丢弃该反射。\n4.  **过滤器 3 (背反射几何)**：检查是否 $h^2+k^2  l^2$。如果不是，则衍射束不向后传播，因此被丢弃。\n5.  **处理记录的反射**：如果一个反射 $(h,k,l)$ 通过了所有过滤器：\n    *   增加 `recorded_reflections`。\n    *   使用上面推导的公式计算其屏幕半径 $R$。通过乘以 1000 将其转换为毫米。存储此值。\n    *   生成对称键 $(l, \\min(|h|,|k|), \\max(|h|,|k|))$ 并将其添加到一个集合中以跟踪唯一的类。\n6.  **最终计算**：\n    *   `symmetry_classes` 的数量是键集合的最终大小。\n    *   计算所有存储半径的平均值。如果没有记录反射，则平均值为 $0.0$。\n    *   将平均半径四舍五入到小数点后六位。\n7.  **输出**：将当前测试用例的五个计算值（`total_candidates`、`systematic_absences`、`recorded_reflections`、`symmetry_classes`、`mean_radius_mm`）组装成一个列表。对所有测试用例重复此过程，并按规定格式化最终输出。\n\n这种结构化方法确保了问题陈述中的所有条件都得到精确满足。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    def _solve_case(a, D, N, lambda_min, lambda_max):\n        \"\"\"\n        Solves one test case for the Laue pattern simulation.\n\n        Args:\n            a (float): Lattice parameter in meters.\n            D (float): Sample-to-detector distance in meters.\n            N (int): Maximum absolute value for Miller indices h, k, l.\n            lambda_min (float): Minimum wavelength in the X-ray beam in meters.\n            lambda_max (float): Maximum wavelength in the X-ray beam in meters.\n        \n        Returns:\n            list: A list containing the five required output values for the test case.\n        \"\"\"\n        total_candidates = 0\n        systematic_absences = 0\n        recorded_reflections_count = 0\n        \n        recorded_radii_m = []\n        recorded_keys = set()\n\n        # Task 1: Generate all Miller indices (h, k, l) with -N = h,k,l = N,\n        # excluding (0,0,0) and restricted to l  0.\n        for h in range(-N, N + 1):\n            for k in range(-N, N + 1):\n                for l in range(-N, 0):  # This ensures l  0.\n                    \n                    # (0,0,0) is automatically excluded since l cannot be 0.\n                    total_candidates += 1\n\n                    # Task 2: Apply FCC selection rule.\n                    # Indices must be all even or all odd.\n                    # We check if the parities of |h|, |k|, |l| are the same.\n                    parities = {abs(h) % 2, abs(k) % 2, abs(l) % 2}\n                    if len(parities)  1: # Mixed parities\n                        systematic_absences += 1\n                        continue\n                    \n                    # Task 1 (cont.): Compute wavelength for the reflection.\n                    hkl_sq_sum = h**2 + k**2 + l**2\n                    \n                    # This check is for safety, though hkl_sq_sum  0 since l  0.\n                    if hkl_sq_sum == 0:\n                        continue\n\n                    lambda_val = -2 * a * l / hkl_sq_sum\n                    \n                    # Task 3: Impose wavelength band filter.\n                    if not (lambda_min = lambda_val = lambda_max):\n                        continue\n\n                    # Task 4: Impose geometric back-reflection condition.\n                    # The condition for back-reflection is h^2 + k^2  l^2.\n                    if not (h**2 + k**2  l**2):\n                        continue\n\n                    # If we reach here, the reflection is recorded.\n                    recorded_reflections_count += 1\n\n                    # Task 4 (cont.): Compute the screen radius R.\n                    # Formula: R = D * (-2*l*sqrt(h^2+k^2)) / (l^2 - (h^2+k^2))\n                    # The sign works out because l  0 and l^2  h^2+k^2.\n                    radius_m = D * (-2 * l * np.sqrt(h**2 + k**2)) / (l**2 - (h**2 + k**2))\n                    recorded_radii_m.append(radius_m)\n\n                    # Task 5: Identify symmetry-equivalence class.\n                    # The key is (l, min(|h|,|k|), max(|h|,|k|)).\n                    key = (l, min(abs(h), abs(k)), max(abs(h), abs(k)))\n                    recorded_keys.add(key)\n\n        # Task 6: Produce final outputs for the test case.\n        num_symmetry_classes = len(recorded_keys)\n        \n        if recorded_reflections_count  0:\n            # Calculate mean radius and convert from meters to millimeters.\n            mean_radius_mm = np.mean(recorded_radii_m) * 1000.0\n        else:\n            mean_radius_mm = 0.0\n\n        # Round the mean radius to six decimal places as required.\n        mean_radius_mm = round(mean_radius_mm, 6)\n\n        return [\n            total_candidates,\n            systematic_absences,\n            recorded_reflections_count,\n            num_symmetry_classes,\n            mean_radius_mm\n        ]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, D, N, lambda_min, lambda_max)\n        (4.05e-10, 0.10, 4, 0.5e-10, 2.0e-10),\n        (3.52e-10, 0.15, 5, 0.4e-10, 2.5e-10),\n        (4.05e-10, 0.10, 2, 1.5e-10, 1.6e-10),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_case(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str() on a list creates a string like '[1, 2, 3]', then we join them.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2976233"}]}