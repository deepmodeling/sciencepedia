{"hands_on_practices": [{"introduction": "这第一个实践是半导体物理学的基石，它将指导你推导各向异性有效质量薛定谔方程。这个强大的工具让我们能够通过抽象掉复杂的周期性晶格势，来模拟电子在缓变外势中的行为。通过求解各向异性谐振子势下的该方程，你将直接看到代表能带曲率的有效质量张量如何决定受限电子的量子能级 [@problem_id:2984374]。", "problem": "晶体固体中的一个电子由具有周期性晶格势 $U_{\\text{lat}}(\\mathbf{r})$ 和缓变外势 $V_{\\text{ext}}(\\mathbf{r})$ 的不含时薛定谔方程所描述。在晶体动量为 $\\mathbf{k}_{0}$ 的导带底附近，布洛赫定理意味着本征态可以写成一个布洛赫函数与一个缓变包络函数的乘积，这一框架被称为包络函数形式论 (EFF)。导带色散是各向异性的，其曲率定义了一个对称正定的有效质量张量 $M$，其定义为\n$$\n\\left[M^{-1}\\right]_{ij} \\equiv \\frac{1}{\\hbar^{2}}\\left.\\frac{\\partial^{2} E_{c}(\\mathbf{k})}{\\partial k_{i}\\partial k_{j}}\\right|_{\\mathbf{k}_{0}} ,\n$$\n其中 $E_{c}(\\mathbf{k})$ 是导带能量，$\\hbar$ 是约化普朗克常数。\n\n从周期势中的薛定谔方程出发，利用布洛赫定理以及 $V_{\\text{ext}}(\\mathbf{r})$ 在晶格尺度上缓变的假设，使用包络函数近似推导出在晶体动量偏离 $\\mathbf{k}_{0}$ 的二阶以内有效的各向异性有效质量包络函数方程。假设单个导带主导了动力学过程，并忽略带间耦合。然后，对于一个具有常数有效质量张量 $M$ 和谐振子禁闭\n$$\nV_{\\text{ext}}(\\mathbf{r})=\\frac{1}{2}\\,\\mathbf{r}^{\\mathsf{T}}K\\,\\mathbf{r} ,\n$$\n的三维 (3D) 电子，其中 $K$ 是一个对称正定的刚度矩阵，求出相对于导带边 $E_{c}(\\mathbf{k}_{0})$ 测量的基态能量的闭合形式解析表达式。你的最终表达式必须用 $\\hbar$ 和矩阵 $M^{-1/2} K M^{-1/2}$ 的本征值来表示，并且必须是一个单一的解析表达式。不需要进行数值近似。", "solution": "此问题分为两部分。第一部分是推导各向异性有效质量包络函数方程。第二部分是求解该方程以找到特定谐振子势下的基态能量。\n\n第一部分：有效质量包络函数方程的推导\n\n我们从晶体中电子的不含时薛定谔方程开始，该电子同时受到周期性晶格势 $U_{\\text{lat}}(\\mathbf{r})$ 和外势 $V_{\\text{ext}}(\\mathbf{r})$ 的作用：\n$$\n\\left[ -\\frac{\\hbar^2}{2m_0} \\nabla^2 + U_{\\text{lat}}(\\mathbf{r}) + V_{\\text{ext}}(\\mathbf{r}) \\right] \\Psi(\\mathbf{r}) = E \\Psi(\\mathbf{r})\n$$\n其中 $m_0$ 是自由电子质量，$\\Psi(\\mathbf{r})$ 是总波函数。\n\n在没有外势 ($V_{\\text{ext}}(\\mathbf{r})=0$) 的情况下，问题的解是布洛赫函数 $\\psi_{n,\\mathbf{k}}(\\mathbf{r})$，它们是周期性哈密顿量的本征函数：\n$$\n\\left[ -\\frac{\\hbar^2}{2m_0} \\nabla^2 + U_{\\text{lat}}(\\mathbf{r}) \\right] \\psi_{n,\\mathbf{k}}(\\mathbf{r}) = E_n(\\mathbf{k}) \\psi_{n,\\mathbf{k}}(\\mathbf{r})\n$$\n布洛赫函数构成一个完备的正交归一基。我们可以用这个基展开总波函数 $\\Psi(\\mathbf{r})$。由于我们关心的是由单个导带（标记为 $c$）在其极小值 $\\mathbf{k}_0$ 附近主导的动力学，我们可以将 $\\Psi(\\mathbf{r})$ 写成该能带中、在 $\\mathbf{k}_0$ 附近集中的布洛赫态的波包：\n$$\n\\Psi(\\mathbf{r}) = \\int d^3k \\, C(\\mathbf{k}) \\psi_{c,\\mathbf{k}}(\\mathbf{r})\n$$\n其中积分遍及第一布里渊区，系数函数 $C(\\mathbf{k})$ 在 $\\mathbf{k} = \\mathbf{k}_0$ 附近急剧地集中。将此代入完整的薛定谔方程得到：\n$$\n\\int d^3k \\, C(\\mathbf{k}) \\left[ E_c(\\mathbf{k}) + V_{\\text{ext}}(\\mathbf{r}) \\right] \\psi_{c,\\mathbf{k}}(\\mathbf{r}) = E \\int d^3k \\, C(\\mathbf{k}) \\psi_{c,\\mathbf{k}}(\\mathbf{r})\n$$\n$V_{\\text{ext}}(\\mathbf{r})$ 缓变的假设意味着其傅里叶变换 $\\tilde{V}_{\\text{ext}}(\\mathbf{q})$ 仅在小的 $\\mathbf{q}$ 处显著。这一性质简化了 $V_{\\text{ext}}$ 在布洛赫态之间的矩阵元，极大地促使带内跃迁 ($\\mathbf{k} \\approx \\mathbf{k}'$) 并抑制带间跃迁。在单带近似中，这导出了一个在 $\\mathbf{k}$ 空间中的方程：\n$$\n(E_c(\\mathbf{k}) - E) C(\\mathbf{k}) + \\int d^3k' \\, \\tilde{V}_{\\text{ext}}(\\mathbf{k}-\\mathbf{k}') C(\\mathbf{k}') = 0\n$$\n其中卷积积分表示势在 $\\mathbf{k}$ 空间中的作用。\n\n我们关心的是导带底 $E_c(\\mathbf{k}_0)$ 附近的能量。我们将色散关系 $E_c(\\mathbf{k})$ 在 $\\mathbf{k}_0$ 附近展开至二阶泰勒级数。令 $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}_0$。\n$$\nE_c(\\mathbf{k}) = E_c(\\mathbf{k}_0) + \\left.\\nabla_{\\mathbf{k}}E_c\\right|_{\\mathbf{k}_0} \\cdot \\mathbf{q} + \\frac{1}{2} \\sum_{ij} \\left.\\frac{\\partial^2 E_c}{\\partial k_i \\partial k_j}\\right|_{\\mathbf{k}_0} q_i q_j + \\dots\n$$\n由于 $\\mathbf{k}_0$ 是能带极小值，梯度项为零。使用逆有效质量张量的定义 $[M^{-1}]_{ij} = \\frac{1}{\\hbar^2}\\left.\\frac{\\partial^{2} E_{c}(\\mathbf{k})}{\\partial k_{i}\\partial k_{j}}\\right|_{\\mathbf{k}_{0}}$，展开式变为：\n$$\nE_c(\\mathbf{k}) \\approx E_c(\\mathbf{k}_0) + \\frac{\\hbar^2}{2} \\sum_{ij} q_i [M^{-1}]_{ij} q_j = E_c(\\mathbf{k}_0) + \\frac{\\hbar^2}{2}\\mathbf{q}^{\\mathsf{T}} M^{-1} \\mathbf{q}\n$$\n包络函数 $F(\\mathbf{r})$ 定义为系数 $C(\\mathbf{k})$ 平移至以 $\\mathbf{q}=0$ 为中心后的傅里叶变换：\n$$\nF(\\mathbf{r}) = \\int d^3q \\, C(\\mathbf{k}_0+\\mathbf{q}) e^{i\\mathbf{q}\\cdot\\mathbf{r}}\n$$\n现在我们对 $\\mathbf{k}$ 空间的薛定谔方程进行傅里叶变换，以获得 $F(\\mathbf{r})$ 的微分方程。各项变换如下：\n1. 能量项 $E_c(\\mathbf{k}_0) C(\\mathbf{k}_0+\\mathbf{q})$ 变换为 $E_c(\\mathbf{k}_0) F(\\mathbf{r})$。\n2. 动能项 $\\frac{\\hbar^2}{2} (\\mathbf{q}^{\\mathsf{T}} M^{-1} \\mathbf{q}) C(\\mathbf{k}_0+\\mathbf{q})$ 的变换利用了傅里叶空间中乘以 $q_i$ 等价于实空间中算符 $i\\frac{\\partial}{\\partial x_i}$ 的性质。然而，由于傅里叶变换定义为 $F(\\mathbf{r}) = \\int C(\\mathbf{k_0+q}) e^{i\\mathbf{q}\\cdot\\mathbf{r}} d^3q$，所以 $q_i$ 对应于 $-i\\frac{\\partial}{\\partial x_i}$。因此，此项变换为：\n   $$\n   \\frac{\\hbar^2}{2} \\sum_{ij} [M^{-1}]_{ij} \\left(-i\\frac{\\partial}{\\partial x_i}\\right) \\left(-i\\frac{\\partial}{\\partial x_j}\\right) F(\\mathbf{r}) = -\\frac{\\hbar^2}{2} \\sum_{ij} [M^{-1}]_{ij} \\frac{\\partial^2 F(\\mathbf{r})}{\\partial x_i \\partial x_j} = -\\frac{\\hbar^2}{2} \\nabla^{\\mathsf{T}} M^{-1} \\nabla F(\\mathbf{r})\n   $$\n3. 势能项在 $\\mathbf{k}$ 空间中是卷积，根据卷积定理，它变换为实空间中的乘积：$\\int \\tilde{V}_{\\text{ext}}(\\mathbf{q}-\\mathbf{q}') C(\\mathbf{k}_0+\\mathbf{q}') d^3q'$ 变换为 $V_{\\text{ext}}(\\mathbf{r})F(\\mathbf{r})$。\n4. 总能量项 $E C(\\mathbf{k}_0+\\mathbf{q})$ 变换为 $E F(\\mathbf{r})$。\n\n结合这些变换后的项，我们得到了实空间中的有效质量包络函数方程：\n$$\n\\left[ E_c(\\mathbf{k}_0) - \\frac{\\hbar^2}{2} \\nabla^{\\mathsf{T}} M^{-1} \\nabla + V_{\\text{ext}}(\\mathbf{r}) \\right] F(\\mathbf{r}) = E F(\\mathbf{r})\n$$\n整理并定义相对于带边的能量为 $\\mathcal{E} = E - E_c(\\mathbf{k}_0)$，我们得到最终形式：\n$$\n\\left[ -\\frac{\\hbar^2}{2} \\nabla^{\\mathsf{T}} M^{-1} \\nabla + V_{\\text{ext}}(\\mathbf{r}) \\right] F(\\mathbf{r}) = \\mathcal{E} F(\\mathbf{r})\n$$\n这就是各向异性有效质量方程，从而完成了问题的第一部分。\n\n第二部分：谐振子势下的基态能量\n\n现在我们对特定的外势 $V_{\\text{ext}}(\\mathbf{r}) = \\frac{1}{2}\\mathbf{r}^{\\mathsf{T}}K\\,\\mathbf{r}$ 求解此方程，其中 $K$ 是一个对称正定的刚度矩阵。方程变为：\n$$\n\\left[ -\\frac{\\hbar^2}{2} \\nabla^{\\mathsf{T}} M^{-1} \\nabla + \\frac{1}{2}\\mathbf{r}^{\\mathsf{T}}K\\,\\mathbf{r} \\right] F(\\mathbf{r}) = \\mathcal{E} F(\\mathbf{r})\n$$\n这是三维各向异性谐振子的薛定谔方程。问题由于动能算符（来自 $M^{-1}$）和势能算符（来自 $K$）中的非对角项而耦合。为了求解它，我们必须找到一个坐标系，将哈密顿量解耦为独立的多个一维谐振子之和。\n\n让我们进行坐标变换来简化动能项。令 $\\mathbf{r}' = M^{1/2}\\mathbf{r}$，其中 $M^{1/2}$ 是 $M$ 唯一的对称正定平方根。则 $\\mathbf{r} = M^{-1/2} \\mathbf{r}'$。梯度算符变换为 $\\nabla = M^{1/2}\\nabla'$。动能项变为：\n$$\n-\\frac{\\hbar^2}{2} (M^{1/2}\\nabla')^{\\mathsf{T}} M^{-1} (M^{1/2}\\nabla') = -\\frac{\\hbar^2}{2} (\\nabla')^{\\mathsf{T}} M^{1/2} M^{-1} M^{1/2} \\nabla' = -\\frac{\\hbar^2}{2} (\\nabla')^{\\mathsf{T}} \\nabla' = -\\frac{\\hbar^2}{2} \\nabla'^2\n$$\n势能项变换为：\n$$\n\\frac{1}{2}(M^{-1/2}\\mathbf{r}')^{\\mathsf{T}} K (M^{-1/2}\\mathbf{r}') = \\frac{1}{2} (\\mathbf{r}')^{\\mathsf{T}} (M^{-1/2} K M^{-1/2}) \\mathbf{r}'\n$$\n我们定义矩阵 $A = M^{-1/2} K M^{-1/2}$。由于 $M$ 和 $K$ 是对称正定的，所以 $A$ 也是对称正定的。在 $\\mathbf{r}'$ 坐标系中的哈密顿量是：\n$$\n\\hat{H} = -\\frac{\\hbar^2}{2} \\nabla'^2 + \\frac{1}{2} (\\mathbf{r}')^{\\mathsf{T}} A \\mathbf{r}'\n$$\n动能现在是各向同性的，但势能仍然是耦合的。我们可以通过旋转到二次型 $(\\mathbf{r}')^{\\mathsf{T}} A \\mathbf{r}'$ 的主轴来解耦势能。设 $R$ 是一个正交矩阵（$R^{\\mathsf{T}}R=I$），其列是 $A$ 的归一化本征矢量。那么 $R^{\\mathsf{T}}AR = \\Lambda$，其中 $\\Lambda$ 是 $A$ 的本征值的对角矩阵。设这些本征值为 $\\lambda_1, \\lambda_2, \\lambda_3$。\n我们进行第二次坐标变换（一次旋转），$\\mathbf{r}'' = R^{\\mathsf{T}}\\mathbf{r}'$ 或 $\\mathbf{r}'=R\\mathbf{r}''$。拉普拉斯算子在旋转下不变，所以 $\\nabla'^2 = \\nabla''^2$。势能项变为：\n$$\n\\frac{1}{2} (\\mathbf{r}')^{\\mathsf{T}} A \\mathbf{r}' = \\frac{1}{2} (R\\mathbf{r}'')^{\\mathsf{T}} A (R\\mathbf{r}'') = \\frac{1}{2} (\\mathbf{r}'')^{\\mathsf{T}} (R^{\\mathsf{T}}AR) \\mathbf{r}'' = \\frac{1}{2} (\\mathbf{r}'')^{\\mathsf{T}} \\Lambda \\mathbf{r}'' = \\frac{1}{2} \\sum_{i=1}^3 \\lambda_i (x''_i)^2\n$$\n在 $\\mathbf{r}''$ 坐标系中，完整的哈密顿量现在完全解耦：\n$$\n\\hat{H} = \\sum_{i=1}^3 \\left( -\\frac{\\hbar^2}{2} \\frac{\\partial^2}{\\partial (x''_i)^2} + \\frac{1}{2} \\lambda_i (x''_i)^2 \\right)\n$$\n这是三个独立的一维量子谐振子之和。第 $i$ 个谐振子的有效质量为 $m_i=1$，弹簧常数为 $k_i=\\lambda_i$，对应的角频率为 $\\omega_i = \\sqrt{k_i/m_i} = \\sqrt{\\lambda_i}$。\n\n一个频率为 $\\omega_i$ 的一维量子谐振子的能量本征值为 $E_i(n_i) = \\hbar\\omega_i(n_i + \\frac{1}{2})$，其中 $n_i = 0, 1, 2, \\dots$。总能量 $\\mathcal{E}$ 是三个独立谐振子能量之和：\n$$\n\\mathcal{E}_{n_1,n_2,n_3} = \\sum_{i=1}^3 \\hbar\\omega_i\\left(n_i + \\frac{1}{2}\\right) = \\sum_{i=1}^3 \\hbar\\sqrt{\\lambda_i}\\left(n_i + \\frac{1}{2}\\right)\n$$\n问题要求的是基态能量，这对应于所有谐振子都处于其最低能量状态，即 $n_1=n_2=n_3=0$。\n$$\n\\mathcal{E}_{\\text{gs}} = \\sum_{i=1}^3 \\hbar\\sqrt{\\lambda_i}\\left(0 + \\frac{1}{2}\\right) = \\frac{\\hbar}{2} \\sum_{i=1}^3 \\sqrt{\\lambda_i}\n$$\n$\\lambda_i$ 的值是矩阵 $A = M^{-1/2} K M^{-1/2}$ 的本征值。因此，相对于导带边测量的基态能量的最终表达式，按要求用 $\\hbar$ 和指定矩阵的本征值表示。", "answer": "$$\n\\boxed{\\frac{\\hbar}{2} \\sum_{i=1}^{3} \\sqrt{\\lambda_i}}\n$$", "id": "2984374"}, {"introduction": "在恒定有效质量张量的基础上，本练习深入探讨了非抛物线形能带这一更贴近现实的场景。在许多材料中，尤其是窄带隙材料，能量-动量关系偏离了简单的二次形式，导致有效质量随电子能量而变化。这个问题将挑战你为一个Kane型色散关系推导能量依赖的有效质量张量，这是一个广泛用于描述这种非抛物线性的模型 [@problem_id:2984376]。", "problem": "考虑一个块体半导体，其导带底附近的能带是各向异性和非抛物线形的。在等能椭球面的主轴基中，其色散关系由以下Kane型关系式隐式描述：\n$$\\alpha E^{2} + E = \\frac{\\hbar^{2}}{2}\\,\\boldsymbol{k}^{\\mathsf{T}}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k},$$\n其中，$E$ 是从导带底算起的电子能量，$\\alpha$ 是非抛物线性参数，$\\hbar$ 是约化普朗克常数，$\\boldsymbol{k}$ 是晶格波矢，而 $\\mathbf{M}_{0} = \\mathrm{diag}(m_{x},m_{y},m_{z})$ 是主轴坐标系中的对称正定抛物线形有效质量张量。群速度定义为 $ \\boldsymbol{v} = \\frac{1}{\\hbar}\\nabla_{\\boldsymbol{k}} E(\\boldsymbol{k})$。将依赖于能量的有效质量张量 $\\mathbf{M}(E)$ 定义为通过以下关系式将 $\\boldsymbol{v}$ 与 $\\boldsymbol{k}$ 线性关联的唯一对称张量：\n$$\\boldsymbol{v} = \\hbar\\,\\mathbf{M}(E)^{-1}\\,\\boldsymbol{k}。$$\n从基本定义出发，推导 $\\mathbf{M}(E)$ 关于 $E$、$\\alpha$ 和 $\\mathbf{M}_{0}$ 的闭式解析表达式。将最终答案表示为单个解析表达式。无需进行数值计算或舍入。", "solution": "问题陈述已经过严格审查，并被确定为有效。这是一个适定的、有科学依据的凝聚态物理问题，内容自洽且无矛盾。所用术语和物理模型均为该领域的标准。因此，我们可以进行形式推导。\n\n目标是基于所给定义，推导依赖于能量的有效质量张量 $\\mathbf{M}(E)$ 的表达式。导带中电子的色散关系隐式地由下式给出：\n$$\n\\alpha E^{2} + E = \\frac{\\hbar^{2}}{2}\\,\\boldsymbol{k}^{\\mathsf{T}}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n其中，$E$ 是能量，$\\alpha$ 是非抛物线性参数，$\\boldsymbol{k}$ 是波矢，$\\hbar$ 是约化普朗克常数，$\\mathbf{M}_{0}$ 是在能带边 ($E=0$) 处的抛物线形有效质量张量。\n\n电子的群速度 $\\boldsymbol{v}$ 定义为：\n$$\n\\boldsymbol{v} = \\frac{1}{\\hbar}\\nabla_{\\boldsymbol{k}} E(\\boldsymbol{k})\n$$\n依赖于能量的有效质量张量 $\\mathbf{M}(E)$ 通过以下关系定义：\n$$\n\\boldsymbol{v} = \\hbar\\,\\mathbf{M}(E)^{-1}\\,\\boldsymbol{k}\n$$\n我们的策略是，首先通过隐式色散关系计算能量的梯度 $\\nabla_{\\boldsymbol{k}} E(\\boldsymbol{k})$，从而求出群速度 $\\boldsymbol{v}$。然后，我们将此结果与包含 $\\mathbf{M}(E)^{-1}$ 的 $\\boldsymbol{v}$ 的定义表达式相等，以确定并随后求解 $\\mathbf{M}(E)$。\n\n为了求 $\\nabla_{\\boldsymbol{k}} E$，我们将梯度算符 $\\nabla_{\\boldsymbol{k}}$ 应用于色散关系的两边，并将 $E$ 视为 $\\boldsymbol{k}$ 的函数。\n$$\n\\nabla_{\\boldsymbol{k}} \\left( \\alpha E^{2} + E \\right) = \\nabla_{\\boldsymbol{k}} \\left( \\frac{\\hbar^{2}}{2}\\,\\boldsymbol{k}^{\\mathsf{T}}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k} \\right)\n$$\n对左侧使用链式法则，我们得到：\n$$\n(2\\alpha E + 1) \\nabla_{\\boldsymbol{k}} E = \\nabla_{\\boldsymbol{k}} \\left( \\frac{\\hbar^{2}}{2}\\,\\boldsymbol{k}^{\\mathsf{T}}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k} \\right)\n$$\n右侧涉及二次型的梯度。对于对称矩阵 $\\mathbf{A}$，$\\boldsymbol{x}^{\\mathsf{T}}\\mathbf{A}\\boldsymbol{x}$ 关于 $\\boldsymbol{x}$ 的梯度是 $2\\mathbf{A}\\boldsymbol{x}$。对称矩阵的逆矩阵也是对称的，因此 $\\mathbf{M}_{0}^{-1}$ 是对称的。应用此规则，我们有：\n$$\n\\nabla_{\\boldsymbol{k}} \\left( \\frac{\\hbar^{2}}{2}\\,\\boldsymbol{k}^{\\mathsf{T}}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k} \\right) = \\frac{\\hbar^{2}}{2} \\left( 2\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k} \\right) = \\hbar^{2}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n将此结果代回 $E$ 的梯度方程，得到：\n$$\n(2\\alpha E + 1) \\nabla_{\\boldsymbol{k}} E = \\hbar^{2}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n现在我们可以解出 $\\nabla_{\\boldsymbol{k}} E$，假设 $2\\alpha E + 1 \\neq 0$。对于典型的半导体，其中 $\\alpha > 0$ 且 $E \\ge 0$，这个条件总是满足的。\n$$\n\\nabla_{\\boldsymbol{k}} E = \\frac{\\hbar^{2}}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n接下来，我们将这个梯度表达式代入群速度 $\\boldsymbol{v}$ 的定义中：\n$$\n\\boldsymbol{v} = \\frac{1}{\\hbar}\\nabla_{\\boldsymbol{k}} E = \\frac{1}{\\hbar} \\left( \\frac{\\hbar^{2}}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k} \\right) = \\frac{\\hbar}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n现在我们得到了 $\\boldsymbol{v}$ 的一个推导表达式。我们将其与依赖于能量的有效质量张量的定义 $\\boldsymbol{v} = \\hbar\\,\\mathbf{M}(E)^{-1}\\,\\boldsymbol{k}$ 相等：\n$$\n\\hbar\\,\\mathbf{M}(E)^{-1}\\,\\boldsymbol{k} = \\frac{\\hbar}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1}\\,\\boldsymbol{k}\n$$\n消去公因子 $\\hbar$ 和 $\\boldsymbol{k}$（因为此关系对任何非零 $\\boldsymbol{k}$ 都必须成立），我们可以确定逆有效质量张量 $\\mathbf{M}(E)^{-1}$：\n$$\n\\mathbf{M}(E)^{-1} = \\frac{1}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1}\n$$\n为了求有效质量张量 $\\mathbf{M}(E)$，我们对该方程两边取逆。利用性质 $(\\lambda \\mathbf{A})^{-1} = \\lambda^{-1} \\mathbf{A}^{-1}$（其中 $\\lambda$ 是标量，$\\mathbf{A}$ 是可逆矩阵），我们得到：\n$$\n\\mathbf{M}(E) = \\left( \\frac{1}{2\\alpha E + 1}\\,\\mathbf{M}_{0}^{-1} \\right)^{-1} = (2\\alpha E + 1) (\\mathbf{M}_{0}^{-1})^{-1}\n$$\n因为一个矩阵的逆的逆是它本身，所以 $(\\mathbf{M}_{0}^{-1})^{-1} = \\mathbf{M}_{0}$。这就得出了依赖于能量的有效质量张量的最终表达式：\n$$\n\\mathbf{M}(E) = (2\\alpha E + 1)\\mathbf{M}_{0}\n$$\n这个结果表明，对于Kane型非抛物线能带，有效质量张量保持了与抛物线形张量 $\\mathbf{M}_{0}$ 相同的各向异性，但其分量被一个依赖于能量的因子 $(2\\alpha E + 1)$ 缩放，该因子捕捉了非抛物线性的效应。在能带边 ($E=0$) 处，$\\mathbf{M}(0) = \\mathbf{M}_{0}$，如预期那样恢复到抛物线极限。", "answer": "$$\\boxed{(1 + 2\\alpha E)\\mathbf{M}_{0}}$$", "id": "2984376"}, {"introduction": "这最后一个实践连接了理论与计算方法，这是现代凝聚态物理学中至关重要的一环。虽然理论推导至关重要，但从实验或第一性原理能带结构计算中确定有效质量张量是一项常见的科研任务。本练习 [@problem_id:2984378] 将指导你编写一个程序来模拟这一过程：你将从一个已知的有效质量张量生成合成能带结构数据，然后使用数值最小二乘法拟合来反向提取该张量，从而验证能带曲率和有效质量之间的基本关系。", "problem": "考虑一个晶体固体，其具有单一的、非简并的电子能带，在波矢 $\\mathbf{k}_0$ 处有一个局域极值点。在 $\\mathbf{k}_0$ 附近，能带能量 $E(\\mathbf{k})$ 是波矢 $\\mathbf{k}$ 的一个光滑函数，并且可以用其二阶泰勒展开很好地近似。约化普朗克常数 $\\hbar$ 在归一化单位制中被处理为 $\\hbar = 1$，所有物理量都是相对于自由电子质量和选定能量尺度的无量纲比值。周期性势场中电子的半经典描述被作为基本依据：群速度为 $ \\mathbf{v}(\\mathbf{k}) = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k})$，并且在匀强外力 $\\mathbf{F}$ 的作用下，晶体动量遵循 $ \\hbar \\frac{d\\mathbf{k}}{dt} = \\mathbf{F}$。目标是从 $E(\\mathbf{k})$ 在 $\\mathbf{k}_0$ 周围的曲率中提取编码惯性响应的张量（即有效质量张量），而不预先假设该张量与 $E(\\mathbf{k})$ 之间的特定解析表达式。\n\n您的任务是编写一个完整的、可运行的程序，对一组综合测试用例执行以下步骤，并生成单行的聚合输出：\n\n- 对于每个测试用例，使用主值对角张量 $\\mathbf{D} = \\mathrm{diag}(d_x, d_y, d_z)$ 和一个指定的正交旋转 $\\mathbf{R}$，通过 $\\mathbf{M}_{\\text{true}} = \\mathbf{R}\\, \\mathbf{D}\\, \\mathbf{R}^\\top$ 在实验室基中构建一个目标对称正定有效质量张量 $\\mathbf{M}_{\\text{true}}$。用于 $\\mathbf{R}$ 的角度必须以弧度为单位进行解释。\n\n- 仅使用 $E(\\mathbf{k})$ 在 $\\mathbf{k}_0$ 附近的二阶泰勒展开，在一个均匀立方网格上对 $E(\\mathbf{k})$ 进行综合“测量”采样。该网格由偏移量 $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}_0$ 构成，网格间距为 $s$，每个轴上的点数为 $N$。综合数据必须由一个关于 $\\mathbf{q}$ 的二次型生成，其曲率与能带在 $\\mathbf{k}_0$ 处的逆惯性响应一致，并且可以包含一个附加的标量偏移量 $E_0$，该偏移量是先验未知的。可以选择性地包含一个小的附加噪声幅度 $\\eta$ 来模拟数值采样不确定性。\n\n- 根据采样的 $E(\\mathbf{k}_0 + \\mathbf{q})$ 数据，对关于偏移量 $(q_x, q_y, q_z)$ 的、带有一个未知标量偏移的最通用对称二阶泰勒多项式进行最小二乘拟合。这将确定 $E$ 在 $\\mathbf{k}_0$ 处的二阶导数的海森矩阵 $\\mathbf{H}$。\n\n- 从拟合的曲率中，推导出与半经典基础一致的实验室基有效质量张量 $\\mathbf{M}_{\\text{extr}}$。除基本依据外，不要假设任何简便公式。\n\n- 对于每个测试用例，计算相对弗罗贝尼乌斯范数误差 $e = \\|\\mathbf{M}_{\\text{extr}} - \\mathbf{M}_{\\text{true}}\\|_F / \\|\\mathbf{M}_{\\text{true}}\\|_F$，结果为浮点数。\n\n您的程序应生成一行输出，其中包含所有测试用例的误差，格式为方括号括起来的逗号分隔列表（例如，“[$e_1, e_2, e_3, e_4$]”），每个 $e_i$ 按规定计算。不得打印任何其他文本。\n\n使用以下测试套件，它涵盖了“理想路径”情况、各向同性、旋转和强各向异性。在所有情况下，归一化单位制中使用 $\\mathbf{k}_0 = \\mathbf{0}$，$E_0 = 0$ 和 $\\hbar = 1$。角度以弧度为单位。\n\n- 测试用例 1（各向异性，轴对齐，无噪声）：\n  - 主质量：$\\mathbf{D} = \\mathrm{diag}(0.2, 0.3, 0.5)$。\n  - 旋转：$\\mathbf{R} = \\mathbf{I}$。\n  - 网格：间距 $s = 0.02$，每轴点数 $N = 7$。\n  - 噪声幅度：$\\eta = 0$。\n\n- 测试用例 2（各向同性，轴对齐，无噪声）：\n  - 主质量：$\\mathbf{D} = \\mathrm{diag}(1.0, 1.0, 1.0)$。\n  - 旋转：$\\mathbf{R} = \\mathbf{I}$。\n  - 网格：间距 $s = 0.03$，每轴点数 $N = 5$。\n  - 噪声幅度：$\\eta = 0$。\n\n- 测试用例 3（各向异性，绕 $z$ 轴旋转，有小噪声）：\n  - 主质量：$\\mathbf{D} = \\mathrm{diag}(0.1, 0.5, 0.9)$。\n  - 旋转：$\\mathbf{R} = \\mathbf{R}_z(\\theta)$，其中 $\\theta = \\pi/6$。\n  - 网格：间距 $s = 0.02$，每轴点数 $N = 7$。\n  - 噪声幅度：$\\eta = 10^{-8}$。\n\n- 测试用例 4（强各向异性，复合旋转，无噪声）：\n  - 主质量：$\\mathbf{D} = \\mathrm{diag}(0.05, 5.0, 50.0)$。\n  - 旋转：$\\mathbf{R} = \\mathbf{R}_z(\\pi/4)\\,\\mathbf{R}_x(\\pi/3)$。\n  - 网格：间距 $s = 0.005$，每轴点数 $N = 9$。\n  - 噪声幅度：$\\eta = 0$。\n\n对于每个测试用例，您的程序必须构建 $\\mathbf{M}_{\\text{true}}$，生成带有可选噪声的综合二次型能带数据，拟合海森矩阵 $\\mathbf{H}$，根据曲率和半经典基础推断 $\\mathbf{M}_{\\text{extr}}$，并按规定报告相对弗罗贝尼乌斯误差。最终输出必须是形如“[$e_1, e_2, e_3, e_4$]”的单行文本。", "solution": "该问题被评估为有效。这是一个在计算凝聚态物理领域中定义明确、有科学依据的问题，没有矛盾或含糊之处。它要求推导并数值实现能带曲率与有效质量张量之间的关系。\n\n问题的核心在于将载流子的惯性特性（由有效质量张量 $\\mathbf{M}$ 概括）与其能带 $E(\\mathbf{k})$ 的局域几何形状联系起来。所提供的“半经典基础”为该推导提供了必要的第一性原理。\n\n基本原理如下：\n$1$. 电子波包的群速度 $\\mathbf{v}$ 由能量色散关系的梯度给出：\n$$ \\mathbf{v}(\\mathbf{k}) = \\frac{1}{\\hbar} \\nabla_{\\mathbf{k}} E(\\mathbf{k}) $$\n$2$. 在外力 $\\mathbf{F}$ 的作用下，电子的晶体动量 $\\mathbf{k}$ 遵循以下演化规律：\n$$ \\hbar \\frac{d\\mathbf{k}}{dt} = \\mathbf{F} $$\n$3$. 有效质量张量 $\\mathbf{M}$ 是通过类比牛顿第二定律来定义的，它将力与产生的加速度 $\\mathbf{a} = d\\mathbf{v}/dt$ 联系起来：\n$$ \\mathbf{F} = \\mathbf{M}\\mathbf{a} $$\n我们的目标是利用这些原理推导出 $\\mathbf{M}$ 关于 $E(\\mathbf{k})$ 导数的表达式。\n\n首先，我们通过对群速度求时间导数来计算加速度 $\\mathbf{a}$。由于 $\\mathbf{v}$ 是 $\\mathbf{k}$ 的函数，而 $\\mathbf{k}$ 是时间 $t$ 的函数，我们必须应用链式法则。加速度的第 $i$ 个分量 $a_i$ 是：\n$$ a_i = \\frac{dv_i}{dt} = \\frac{d}{dt} \\left( \\frac{1}{\\hbar} \\frac{\\partial E}{\\partial k_i} \\right) = \\frac{1}{\\hbar} \\sum_{j=1}^{3} \\frac{\\partial}{\\partial k_j} \\left( \\frac{\\partial E}{\\partial k_i} \\right) \\frac{dk_j}{dt} $$\n项 $\\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$ 代表函数 $E(\\mathbf{k})$ 的海森矩阵 $\\mathbf{H}$ 的分量。令 $H_{ij} = \\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$。加速度的表达式变为：\n$$ a_i = \\frac{1}{\\hbar} \\sum_{j=1}^{3} H_{ij} \\frac{dk_j}{dt} $$\n接下来，我们代入晶体动量运动方程，得到 $\\frac{dk_j}{dt} = \\frac{F_j}{\\hbar}$：\n$$ a_i = \\frac{1}{\\hbar} \\sum_{j=1}^{3} H_{ij} \\left( \\frac{F_j}{\\hbar} \\right) = \\frac{1}{\\hbar^2} \\sum_{j=1}^{3} H_{ij} F_j $$\n用矩阵-向量表示法，这个方程组可以写成：\n$$ \\mathbf{a} = \\frac{1}{\\hbar^2} \\mathbf{H} \\mathbf{F} $$\n为了从其定义 $\\mathbf{F} = \\mathbf{M}\\mathbf{a}$ 中求出有效质量张量，我们必须将 $\\mathbf{F}$ 表示为 $\\mathbf{a}$ 的函数。我们可以通过对刚刚推导出的关系求逆来实现。假设海森矩阵 $\\mathbf{H}$ 是可逆的（在非简并能带极值点处确实如此），我们有：\n$$ \\mathbf{F} = \\hbar^2 \\mathbf{H}^{-1} \\mathbf{a} $$\n通过将其与定义 $\\mathbf{F} = \\mathbf{M}\\mathbf{a}$ 直接比较，我们可以确定有效质量张量：\n$$ \\mathbf{M} = \\hbar^2 \\mathbf{H}^{-1} $$\n考虑到问题使用 $\\hbar = 1$ 的归一化单位制，该关系简化为我们算法中使用的最终表达式：\n$$ \\mathbf{M} = \\mathbf{H}^{-1} $$\n这个结果表明，有效质量张量是能量色散关系 $E(\\mathbf{k})$ 的海森矩阵的逆矩阵。\n\n解决该问题的算法流程如下：\n\n对于每个测试用例：\n$1$. **构建目标张量**：使用一个目标主质量对角张量 $\\mathbf{D} = \\mathrm{diag}(d_x, d_y, d_z)$ 和一个旋转矩阵 $\\mathbf{R}$，构建实验室坐标系中的真实有效质量张量 $\\mathbf{M}_{\\text{true}} = \\mathbf{R} \\mathbf{D} \\mathbf{R}^\\top$。\n\n$2$. **生成综合数据**：根据推导出的关系，真实的海森矩阵为 $\\mathbf{H}_{\\text{true}} = \\mathbf{M}_{\\text{true}}^{-1}$。能带极值点 $\\mathbf{k}_0 = \\mathbf{0}$ 附近的能量由其二阶泰勒展开近似。由于 $\\mathbf{k}_0$ 是一个极值点，梯度项为零，相对于能带边能量 $E_0$ 的能量是关于波矢偏移量 $\\mathbf{q} = \\mathbf{k} - \\mathbf{k}_0$ 的二次型：\n$$ E(\\mathbf{q}) - E_0 = \\frac{1}{2} \\mathbf{q}^\\top \\mathbf{H}_{\\text{true}} \\mathbf{q} $$\n通过在间距为 $s$、每轴点数为 $N$ 的均匀立方 $\\mathbf{q}$ 向量网格上计算此表达式，生成综合能量值。为模拟测量不确定性，添加一个幅度为 $\\eta$ 的小噪声。\n\n$3$. **通过最小二乘拟合提取曲率**：为了从综合数据中提取海森矩阵，我们将数据拟合到关于 $\\mathbf{q}$ 分量 $(q_x, q_y, q_z)$ 的最通用对称二阶多项式：\n$$ E_{\\text{fit}}(q_x, q_y, q_z) = c_0 + c_x q_x + c_y q_y + c_z q_z + c_{xx} q_x^2 + c_{yy} q_y^2 + c_{zz} q_z^2 + c_{xy} q_x q_y + c_{xz} q_x q_z + c_{yz} q_y q_z $$\n这是一个线性最小二乘问题，可以表示为 $\\mathbf{A}\\mathbf{c} = \\mathbf{E}_{\\text{data}}$，其中 $\\mathbf{c}$ 是包含 $10$ 个未知系数的向量，$\\mathbf{E}_{\\text{data}}$ 是综合能量值的向量，$\\mathbf{A}$ 是设计矩阵，其列是在每个网格点上求值的多项式基函数（$1, q_x, q_y, q_z, q_x^2, \\dots$）。系数 $\\mathbf{c}$ 可通过 `numpy.linalg.lstsq` 求得。\n\n$4$. **重建张量**：通过将拟合的多项式与泰勒展开式 $E(\\mathbf{q}) \\approx E_0 + \\nabla E \\cdot \\mathbf{q} + \\frac{1}{2}\\mathbf{q}^\\top \\mathbf{H} \\mathbf{q}$ 进行比较，我们可以从二次项系数中构建出提取的海森矩阵 $\\mathbf{H}_{\\text{extr}}$：\n$$ \\mathbf{H}_{\\text{extr}} = \\begin{pmatrix} 2c_{xx} & c_{xy} & c_{xz} \\\\ c_{xy} & 2c_{yy} & c_{yz} \\\\ c_{xz} & c_{yz} & 2c_{zz} \\end{pmatrix} $$\n然后通过对此海森矩阵求逆得到提取的有效质量张量：$\\mathbf{M}_{\\text{extr}} = \\mathbf{H}_{\\text{extr}}^{-1}$。\n\n$5$. **计算误差**：该过程的准确性通过提取的质量张量与真实质量张量之间的相对弗罗贝尼乌斯范数误差来量化：\n$$ e = \\frac{\\|\\mathbf{M}_{\\text{extr}} - \\mathbf{M}_{\\text{true}}\\|_F}{\\|\\mathbf{M}_{\\text{true}}\\|_F} $$\n对所有测试用例重复此过程，并报告所得误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the effective mass tensor from synthetic band structure data\n    and computes the relative error for a suite of test cases.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # Format: (principal_masses, rotation_definition, grid_spacing, grid_points_per_axis, noise_amplitude)\n    # Rotation definition can be 'I' for identity, ('z', angle) for R_z, or a list of tuples for composite rotations.\n    test_cases = [\n        # Test case 1\n        ([0.2, 0.3, 0.5], 'I', 0.02, 7, 0.0),\n        # Test case 2\n        ([1.0, 1.0, 1.0], 'I', 0.03, 5, 0.0),\n        # Test case 3\n        ([0.1, 0.5, 0.9], ('z', np.pi / 6), 0.02, 7, 1e-8),\n        # Test case 4\n        ([0.05, 5.0, 50.0], [('z', np.pi / 4), ('x', np.pi / 3)], 0.005, 9, 0.0)\n    ]\n\n    results = []\n\n    for d_vals, rot_def, s, N, eta in test_cases:\n        # 1. Construct the true effective mass tensor M_true\n        D_true = np.diag(d_vals)\n\n        if rot_def == 'I':\n            R = np.identity(3)\n        else:\n            if isinstance(rot_def, tuple):\n                rotations = [rot_def]\n            else: # list of tuples for composite rotation\n                rotations = rot_def\n            \n            R = np.identity(3)\n            for axis, angle in rotations:\n                c, s_val = np.cos(angle), np.sin(angle)\n                if axis == 'z':\n                    R_mat = np.array([[c, -s_val, 0], [s_val, c, 0], [0, 0, 1]])\n                elif axis == 'x':\n                    R_mat = np.array([[1, 0, 0], [0, c, -s_val], [0, s_val, c]])\n                else: # Should not happen with given test cases\n                    R_mat = np.identity(3)\n                R = R_mat @ R # Note: problem implies Rz(pi/4)Rx(pi/3), so Rx applied first\n\n        M_true = R @ D_true @ R.T\n\n        # 2. Generate synthetic energy data\n        # M = H^-1 -> H = M^-1 (with hbar=1)\n        H_true = np.linalg.inv(M_true)\n\n        # Create a uniform cubic grid of q = k - k0 vectors (with k0=0)\n        grid_coords_1d = np.linspace(-(N - 1) / 2, (N - 1) / 2, N) * s\n        qx, qy, qz = np.meshgrid(grid_coords_1d, grid_coords_1d, grid_coords_1d, indexing='ij')\n        \n        q_vectors = np.stack([qx.ravel(), qy.ravel(), qz.ravel()], axis=1)\n\n        # Calculate energies: E(q) = 1/2 * q^T * H * q\n        # This can be vectorized as 0.5 * sum((q @ H) * q, axis=1)\n        energies = 0.5 * np.sum((q_vectors @ H_true.T) * q_vectors, axis=1)\n\n        # Add optional noise\n        if eta > 0:\n            noise = np.random.uniform(-eta, eta, size=energies.shape)\n            energies += noise\n\n        # 3. Perform a least-squares fit to find the Hessian\n        # Model: E = c0 + c1*qx + c2*qy + ... + c_xx*qx^2 + ... + c_xy*qx*qy + ...\n        # Basis functions: 1, qx, qy, qz, qx^2, qy^2, qz^2, qx*qy, qx*qz, qy*qz\n        q_x, q_y, q_z = q_vectors[:, 0], q_vectors[:, 1], q_vectors[:, 2]\n        A = np.stack([\n            np.ones_like(q_x),\n            q_x, q_y, q_z,\n            q_x**2, q_y**2, q_z**2,\n            q_x*q_y, q_x*q_z, q_y*q_z\n        ], axis=1)\n\n        # Solve the linear system Ac = E for coefficients c\n        coeffs, _, _, _ = np.linalg.lstsq(A, energies, rcond=None)\n        \n        # Extract quadratic coefficients\n        c_xx, c_yy, c_zz = coeffs[4], coeffs[5], coeffs[6]\n        c_xy, c_xz, c_yz = coeffs[7], coeffs[8], coeffs[9]\n\n        # 4. From fitted coefficients, deduce the Hessian and then M_extr\n        # H_ij = d^2E / dqi dqi. From fit, c_xx = 0.5*H_11, c_xy = H_12, etc.\n        H_extr = np.array([\n            [2 * c_xx, c_xy,     c_xz],\n            [c_xy,     2 * c_yy, c_yz],\n            [c_xz,     c_yz,     2 * c_zz]\n        ])\n        \n        M_extr = np.linalg.inv(H_extr)\n\n        # 5. Compute the relative Frobenius-norm error\n        error_num = np.linalg.norm(M_extr - M_true, 'fro')\n        error_den = np.linalg.norm(M_true, 'fro')\n        \n        # Avoid division by zero, though not expected for this problem\n        relative_error = error_num / error_den if error_den > 0 else 0.0\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12g}' for r in results)}]\")\n\nsolve()\n```", "id": "2984378"}]}