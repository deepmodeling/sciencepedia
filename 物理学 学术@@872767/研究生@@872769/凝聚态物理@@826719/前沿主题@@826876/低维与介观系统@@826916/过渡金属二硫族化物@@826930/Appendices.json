{"hands_on_practices": [{"introduction": "对任何材料的研究，第一步都是理解其晶体结构。过渡金属硫族化合物（TMDs）等层状材料具有独特的结构各向异性，这是其许多奇异物理性质的根源。本练习将引导你仅使用基本的原子参数，通过几何分析来估算一种典型TMD（2H-MoS$_2$）的基本晶格常数，从而让你对TMD晶体的尺度和层状特性建立起直观的物理图像。", "problem": "六方多型体2H-二硫化钼 (2H-MoS$_2$) 的单层由一个硫-钼-硫 (S–Mo–S) 三层结构组成，其中钼原子与六个硫近邻形成三角棱柱配位。将每层视为由钼原子构成的等边三角网格，其面内晶格常数为 $a$，硫原子位于钼原子构成的三角形中心的上方和下方。假设以下与文献一致的典型值来估算该结构：\n- 钼-硫键长 $d_{\\mathrm{MoS}} = 2.42\\,\\text{Å}$，\n- 硫的范德华半径 $r_{\\mathrm{vdW}}(\\mathrm{S}) = 1.80\\,\\text{Å}$，\n- 层内 S–Mo–S 三层结构厚度 $t = 3.10\\,\\text{Å}$ (单个三层结构内两个硫原子平面之间的距离)。\n\n仅使用理想的三角棱柱几何结构和六方对称性，推导 2H 晶胞的面内晶格常数 $a$ 和面外晶格常数 $c$ 的表达式。设 Mo-S 键的横向投影为钼原子六方网格中三角形顶点到其质心的距离，并将相邻三层结构之间的层间硫-硫间距模拟为范德华接触距离 $g = 2\\,r_{\\mathrm{vdW}}(\\mathrm{S})$。2H 多型体每个晶胞包含两个沿 $c$ 轴堆叠的 S–Mo–S 三层结构。\n\n计算：\n- 面内晶格常数 $a$，\n- 面外晶格常数 $c$，\n- 各向异性比 $c/a$。\n\n将 $a$ 和 $c$ 以 Å 为单位表示。将所有要求的数值结果四舍五入到三位有效数字。将 $c/a$ 以无量纲、无弧度的形式给出。", "solution": "问题陈述已经过评估并被确定为有效。它具有科学依据、内容自洽且定义明确，为估算 2H-MoS$_2$ 的晶格常数提供了一套一致的几何和物理参数。该模型基于理想的三角棱柱几何结构，通过直接应用几何原理可以得到唯一解。\n\n解题过程是根据给定参数计算面内晶格常数 $a$、面外晶格常数 $c$ 以及各向异性比 $c/a$。\n\n**1. 面内晶格常数 ($a$) 的计算**\n\n问题描述了单个 S–Mo–S 三层结构。钼原子形成一个三角晶格，而硫原子位于钼原子构成的三角形中心的上方和下方。在此结构中，长度为 $d_{\\mathrm{MoS}}$ 的 Mo-S 键可以看作一个直角三角形的斜边。\n\n该直角三角形的两条直角边是：\ni. 一个垂直分量，即从钼原子平面到任一硫原子平面的垂直距离。鉴于 S–Mo–S 三层结构的总厚度为 $t$，此距离为 $t/2$。\nii. 一个水平分量，即 Mo-S 键在钼原子平面上的横向投影。我们将此投影记为 $p$。\n\n根据勾股定理，这些量之间的关系为：\n$$d_{\\mathrm{MoS}}^2 = p^2 + \\left(\\frac{t}{2}\\right)^2$$\n我们可以解出横向投影 $p$：\n$$p = \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n问题陈述指出，这个横向投影 $p$ 等于一个边长为面内晶格常数 $a$ 的等边三角形的顶点（一个钼原子）到其质心的距离。对于边长为 $a$ 的等边三角形，该距离由以下几何关系给出：\n$$p = \\frac{a}{\\sqrt{3}}$$\n通过令两个关于 $p$ 的表达式相等，我们可以推导出 $a$ 的公式：\n$$\\frac{a}{\\sqrt{3}} = \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n$$a = \\sqrt{3} \\sqrt{d_{\\mathrm{MoS}}^2 - \\left(\\frac{t}{2}\\right)^2}$$\n代入给定值 $d_{\\mathrm{MoS}} = 2.42\\,\\text{Å}$ 和 $t = 3.10\\,\\text{Å}$：\n$$a = \\sqrt{3} \\sqrt{(2.42)^2 - \\left(\\frac{3.10}{2}\\right)^2} = \\sqrt{3} \\sqrt{5.8564 - (1.55)^2}$$\n$$a = \\sqrt{3} \\sqrt{5.8564 - 2.4025} = \\sqrt{3} \\sqrt{3.4539} \\approx 3.2190\\,\\text{Å}$$\n四舍五入到三位有效数字，面内晶格常数为 $a \\approx 3.22\\,\\text{Å}$。\n\n**2. 面外晶格常数 ($c$) 的计算**\n\nMoS$_2$ 的 2H 多型体有一个晶胞，其中包含两个沿 $c$ 轴堆叠的 S–Mo–S 三层结构。面外晶格常数 $c$ 是这个双三层结构晶胞的总高度。\n\n晶胞的高度是相邻三层结构中心之间距离（即钼原子平面到钼原子平面的距离）的两倍。设此距离为 $h_{\\mathrm{Mo-Mo}}$。\n$$c = 2 h_{\\mathrm{Mo-Mo}}$$\n距离 $h_{\\mathrm{Mo-Mo}}$ 由三层结构内部的间距和三层结构之间的间距组成。具体来说，从一层中的钼原子平面到下一层中的钼原子平面，必须穿过第一个三层结构厚度的一半到达其硫原子平面边界，穿过层间范德华间隙，然后再穿过第二个三层结构厚度的一半到达其钼原子平面。\n更正式地，层间间隙 $g$ 是一个三层结构的硫原子平面与相邻三层结构最近的硫原子平面之间的距离。因此，钼原子平面之间的距离为 $h_{\\mathrm{Mo-Mo}} = \\frac{t}{2} + g + \\frac{t}{2} = t + g$。\n这里有一个常见的误解：`c`是晶胞的高度，对于包含两层的2H结构，`c`是跨越两层后的重复距离，即`c = 2 * h_Mo-Mo`。因此，面外晶格常数由下式给出：\n$$c = 2(t + g)$$\n问题将层间硫-硫间距（范德华间隙）定义为 $g = 2\\,r_{\\mathrm{vdW}}(\\mathrm{S})$。\n$$c = 2(t + 2\\,r_{\\mathrm{vdW}}(\\mathrm{S}))$$\n代入给定值 $t = 3.10\\,\\text{Å}$ 和 $r_{\\mathrm{vdW}}(\\mathrm{S}) = 1.80\\,\\text{Å}$：\n$$c = 2(3.10 + 2 \\times 1.80) = 2(3.10 + 3.60) = 2(6.70) = 13.4\\,\\text{Å}$$\n该结果具有三位有效数字，与输入参数一致。面外晶格常数为 $c = 13.4\\,\\text{Å}$。\n\n**3. 各向异性比 ($c/a$) 的计算**\n\n各向异性比是面外晶格常数与面内晶格常数的无量纲比值。使用未经四舍五入的值以避免传播舍入误差：\n$$a \\approx 3.2190\\,\\text{Å}$$\n$$c = 13.4\\,\\text{Å}$$\n该比值为：\n$$\\frac{c}{a} = \\frac{13.4}{3.2190} \\approx 4.16278$$\n四舍五入到三位有效数字，各向异性比为 $c/a \\approx 4.16$。\n\n所求的量为：\n- 面内晶格常数 $a \\approx 3.22\\,\\text{Å}$。\n- 面外晶格常数 $c = 13.4\\,\\text{Å}$。\n- 各向异性比 $c/a \\approx 4.16$。", "answer": "$$\\boxed{\\begin{pmatrix} 3.22 & 13.4 & 4.16 \\end{pmatrix}}$$", "id": "3022462"}, {"introduction": "单层TMDs独特的电子学性质，尤其是在自旋电子学和谷电子学领域的应用潜力，源于其非中心对称环境下强大的自旋轨道耦合（SOC）效应。本练习将指导你运用对称性原理，推导TMDs价带顶一个标志性的物理现象——巨大的能谷自旋劈裂。通过亲手计算MoS$_2$和WS$_2$的劈裂大小，你将对原子组成如何决定这些关键电子特性获得定量的理解。", "problem": "考虑一个化学式为 $\\mathrm{MX}_{2}$ 的单层过渡金属二硫族化物 (TMD)，其中 $\\mathrm{M}$ 是第六族过渡金属，$\\mathrm{X}$ 是硫族元素。在布里渊区角点 $K$ 附近，顶价带主要源于带有非零面外轨道角动量的金属 $d$ 轨道，并与硫族元素的 $p$ 轨道发生弱混合。在单层材料中，$\\mathrm{X}$–$\\mathrm{M}$–$\\mathrm{X}$ 的堆叠结构破坏了全局反演对称性，但时间反演对称性得以保持。主要的相对论性相互作用是原子自旋轨道耦合 (SOC)，其微观形式由作用于每种原子内的单粒子算符 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ 给出，其中 $\\lambda$ 是 SOC 常数，$\\mathbf{L}$ 是轨道角动量，$\\mathbf{S}$ 是自旋角动量。\n\n从 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$、时间反演对称性以及适用于单层 TMD 在 $K$ 点的点群约束出发，在双带 $\\mathbf{k}\\cdot\\mathbf{p}$ 描述中，推导在 $K$ 点的价带子空间中允许存在的领头阶有效 SOC 项。利用此结果，以单个有效 SOC 参数 $\\lambda_{v}$ 的形式，得到在固定谷 $K$ 的价带边自旋劈裂 $\\Delta_{v}(K)$ 的解析表达式。该参数 $\\lambda_{v}$ 是将 $H_{\\mathrm{SO}}$ 投影到低能价带子空间中得到的结果。简要解释为什么破缺的反演对称性允许非零的 $\\Delta_{v}(K)$，而时间反演对称性则要求谷对比的自旋构型。\n\n然后，使用以下包含了原子 SOC 和杂化效应的有效价带 SOC 参数，计算 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 的 $\\Delta_{v}(K)$：\n- $\\lambda_{v}^{\\mathrm{MoS}_{2}}=75\\ \\mathrm{meV}$，\n- $\\lambda_{v}^{\\mathrm{WS}_{2}}=215\\ \\mathrm{meV}$。\n\n以 $\\mathrm{meV}$ 为单位表示最终能量，并将答案四舍五入到四位有效数字。将您的两个最终 $\\Delta_{v}(K)$ 数值以单行矩阵的形式给出。另外，根据您推导的表达式，陈述在 $\\Delta_{v}(K)$ 方面区分 $\\mathrm{MoX}_{2}$ 和 $\\mathrm{WX}_{2}$ 的定性趋势。", "solution": "本题要求推导单层过渡金属二硫族化物 (TMD) 在布里渊区 $K$ 点的价带自旋劈裂，然后对 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 进行数值计算。\n\n### 步骤1：有效自旋轨道耦合 (SOC) 哈密顿量的推导\n\n我们从微观原子自旋轨道耦合 (SOC) 哈密顿量 $H_{\\mathrm{SO}}=\\lambda\\,\\mathbf{L}\\cdot\\mathbf{S}$ 开始，其中 $\\lambda$ 是 SOC 常数，$\\mathbf{L}$ 和 $\\mathbf{S}$ 分别是轨道和自旋角动量算符。我们需要找到该哈密顿量在投影到 $K$ 点价带边的二重自旋简并子空间上时的有效形式。\n\n设该子空间的基为 $\\{|v, K, \\uparrow\\rangle, |v, K, \\downarrow\\rangle\\}$，其中 $|v, K\\rangle$ 表示布洛赫态的轨道部分，而 $|\\uparrow\\rangle, |\\downarrow\\rangle$ 是沿面外 $z$ 轴量子化的自旋向上和自旋向下态。有效哈密顿量将是该自旋基下的一个 $2 \\times 2$ 矩阵。\n\n一个 $2 \\times 2$ 哈密顿量的一般形式为 $H^{\\text{eff}} = c_0 I + \\mathbf{c} \\cdot \\boldsymbol{\\sigma}$，其中 $I$ 是 $2 \\times 2$ 单位矩阵，$\\boldsymbol{\\sigma}=(\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵，系数由将 $H_{\\mathrm{SO}}$ 投影到该基上确定。\n\n题目指出，$K$ 点的价带源于带有非零面外轨道角动量的金属 $d$ 轨道。这意味着轨道角动量 $z$ 分量的期望值 $\\langle v, K|L_z|v, K\\rangle$ 非零。$K$ 点的点群对称性是 $D_{3h}$。在该群绕 $z$ 轴的 $C_3$ 旋转对称性下，面内分量 $(L_x, L_y)$ 按矢量变换且不具有不变性，而 $L_z$ 是一个标量且具有不变性。因此，它们在非简并（轨道）态 $|v, K\\rangle$ 内的期望值必须为零：$\\langle v, K|L_x|v, K\\rangle = 0$ 和 $\\langle v, K|L_y|v, K\\rangle = 0$。\n\n因此，$H_{\\mathrm{SO}}$ 的投影大大简化：\n$$\nH_{\\mathrm{SO}, v, K}^{\\text{eff}} = \\text{proj}_{v,K} (\\lambda (L_x S_x + L_y S_y + L_z S_z)) \\text{proj}_{v,K}\n$$\n$L_x S_x$ 和 $L_y S_y$ 项涉及翻转自旋的算符。例如，$\\langle \\uparrow | L_x S_x | \\downarrow \\rangle \\propto \\langle v,K|L_x|v,K \\rangle$。由于一阶期望值 $\\langle L_x \\rangle$ 和 $\\langle L_y \\rangle$ 为零，这些项在领头阶没有贡献。唯一保留下来的是包含 $L_z S_z$ 的项。\n$$\nH_{\\mathrm{SO}, v, K}^{\\text{eff}} \\approx \\lambda \\langle v, K|L_z|v, K\\rangle S_z\n$$\n这个有效哈密顿量在自旋-z 基中是对角的。我们将 $S_z$ 用矩阵形式表示为 $S_z \\rightarrow \\frac{\\hbar}{2}\\sigma_z$。为了无量纲化，我们可以使用 $S_z \\rightarrow \\frac{1}{2}\\sigma_z$。量 $\\lambda \\langle v, K|L_z|v, K\\rangle$ 是微观参数的乘积，其结果是一个能量。\n\n现在，我们必须考虑基本对称性施加的约束：破缺的反演对称性 ($\\mathcal{P}$) 和保持的时间反演对称性 ($\\mathcal{T}$)。谷指数 $\\tau$ 区分 $K$ ($\\tau=+1$) 和 $K'$ ($\\tau=-1$) 谷。$K'$ 谷的状态是 $K$ 谷状态的时间反演伙伴。算符 $\\mathbf{L}$ 在时间反演下是奇的，所以 $\\langle L_z \\rangle_{K'} = \\langle v, K'|L_z|v, K'\\rangle = - \\langle v, K|L_z|v, K\\rangle = -\\langle L_z \\rangle_K$。这意味着有效轨道磁矩在两个谷中是相反的。\n\n我们可以将一般谷 $\\tau$ 的有效哈密顿量写为：\n$$\nH_{\\mathrm{SO}, v, \\tau}^{\\text{eff}} \\propto \\tau S_z\n$$\n让我们根据题目中给定的单个参数 $\\lambda_v$ 来定义有效哈密顿量。在一个二能级自旋系统中，有效 SOC 哈密顿量的常见形式是 $H = C \\sigma_z$。其本征值为 $\\pm C$，导致 $2C$ 的劈裂。鉴于所提供的数值中，参数 $\\lambda_v$ 大约是已知实验劈裂值的一半，因此将有效哈密顿量定义为以下形式是合理的：\n$$\nH_{\\mathrm{SO}, v, \\tau}^{\\text{eff}} = \\lambda_v \\tau \\sigma_z\n$$\n这就是推导出的由对称性所允许的领头阶有效 SOC 项。这种形式与时间反演对称性一致，因为它连接了两个谷：$\\mathcal{T} H_{\\text{eff}}(K) \\mathcal{T}^{-1} = \\mathcal{T} (\\lambda_v \\sigma_z) \\mathcal{T}^{-1} = \\lambda_v (-\\sigma_z) = H_{\\text{eff}}(K')$。\n\n### 步骤2：自旋劈裂 $\\Delta_v(K)$ 的解析表达式\n\n使用推导出的 $K$ 谷（$\\tau=+1$）的有效哈密顿量 $H_{\\mathrm{SO}, v, K}^{\\text{eff}} = \\lambda_v \\sigma_z$，我们求其本征值。$\\sigma_z$ 的本征值为 $+1$（对于自旋向上， $|\\uparrow\\rangle$）和 $-1$（对于自旋向下， $|\\downarrow\\rangle$）。相应的能量本征值为：\n$$\nE_{\\uparrow} = +\\lambda_v\n$$\n$$\nE_{\\downarrow} = -\\lambda_v\n$$\n自旋劈裂 $\\Delta_v(K)$ 是这些能级之间的绝对差：\n$$\n\\Delta_v(K) = |E_{\\uparrow} - E_{\\downarrow}| = |\\lambda_v - (-\\lambda_v)| = |2\\lambda_v|\n$$\n由于像 $\\lambda_v$ 这样的 SOC 参数代表能量尺度且被取为正值，所以自旋劈裂的解析表达式为：\n$$\n\\Delta_v(K) = 2\\lambda_v\n$$\n\n### 步骤3：对称性的作用\n\n- **破缺的反演对称性**：对于一个体系，要在波矢 $\\mathbf{k}$ 处表现出自旋劈裂 $\\mathbf{\\Delta E} \\propto \\boldsymbol{\\Omega}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma}$，有效 SOC 场 $\\boldsymbol{\\Omega}(\\mathbf{k})$ 必须非零。时间反演对称性要求 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = -\\boldsymbol{\\Omega}(\\mathbf{k})$。如果同时存在反演对称性，则会要求 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = \\boldsymbol{\\Omega}(\\mathbf{k})$。唯一同时为奇函数和偶函数的只有零函数，即 $\\boldsymbol{\\Omega}(\\mathbf{k}) = 0$。因此，在中心对称晶体中，自旋劈裂是被禁止的（克拉默斯简并在每个 $\\mathbf{k}$ 点都成立）。在单层 TMD 中，反演对称性被破坏，因此 $\\boldsymbol{\\Omega}(-\\mathbf{k}) = \\boldsymbol{\\Omega}(\\mathbf{k})$ 的约束被解除，从而允许 $\\boldsymbol{\\Omega}(\\mathbf{k}) \\neq 0$，进而产生非零的自旋劈裂 $\\Delta_v(K)$。\n\n- **时间反演对称性与谷对比自旋**：如推导所示，时间反演对称性通过 $H_{\\text{eff}}(K') = \\mathcal{T} H_{\\text{eff}}(K) \\mathcal{T}^{-1}$ 连接了 $K$ 和 $K'$ 谷的哈密顿量。当 $H_{\\text{eff}}(K) = \\lambda_v \\sigma_z$ 时，这导致 $H_{\\text{eff}}(K') = -\\lambda_v \\sigma_z$。这意味着自旋劈裂的符号在两个谷中是相反的。在 $K$ 谷，自旋向上态的能量为 $+\\lambda_v$，自旋向下态的能量为 $-\\lambda_v$。在 $K'$ 谷，自旋向上态的能量为 $-\\lambda_v$，自旋向下态的能量为 $+\\lambda_v$。自旋态的顺序是相反的，这是谷对比自旋构型的标志。劈裂的大小 $2\\lambda_v$ 在两个谷中保持不变。\n\n### 步骤4：对 $\\mathrm{MoS}_{2}$ 和 $\\mathrm{WS}_{2}$ 的数值计算\n\n使用推导出的表达式 $\\Delta_v(K) = 2\\lambda_v$ 和给定的参数：\n\n- 对于 $\\mathrm{MoS}_{2}$：$\\lambda_{v}^{\\mathrm{MoS}_{2}} = 75\\ \\mathrm{meV}$\n$$\n\\Delta_{v}(K)_{\\mathrm{MoS}_{2}} = 2 \\times 75\\ \\mathrm{meV} = 150\\ \\mathrm{meV}\n$$\n四舍五入到四位有效数字得到 $150.0\\ \\mathrm{meV}$。\n\n- 对于 $\\mathrm{WS}_{2}$：$\\lambda_{v}^{\\mathrm{WS}_{2}} = 215\\ \\mathrm{meV}$\n$$\n\\Delta_{v}(K)_{\\mathrm{WS}_{2}} = 2 \\times 215\\ \\mathrm{meV} = 430\\ \\mathrm{meV}\n$$\n四舍五入到四位有效数字得到 $430.0\\ \\mathrm{meV}$。\n\n### 步骤5：定性趋势\n\n原子自旋轨道耦合的强度随原子序数 ($Z$) 急剧增加，对于类氢原子大约与 $Z^4$ 成正比，对于多电子原子则增长稍缓。过渡金属钼 (Mo, $Z=42$) 和钨 (W, $Z=74$) 位于元素周期表的同一族，但 W 处于更高的周期，并且重得多。有效 SOC 参数 $\\lambda_v$ 与微观原子 SOC 强度成正比。因此，在含有较重过渡金属的 TMD 中，自旋劈裂 $\\Delta_v(K)$ 会大得多。定性趋势是，对于给定的硫族元素 $\\mathrm{X}$，$\\mathrm{WX}_{2}$ 中的价带自旋劈裂远大于 $\\mathrm{MoX}_{2}$ 中的价带自旋劈裂。我们的计算证实了这一点：$\\Delta_v(\\mathrm{WS}_2) = 430.0 \\ \\mathrm{meV} > \\Delta_v(\\mathrm{MoS}_2) = 150.0 \\ \\mathrm{meV}$。", "answer": "$$\\boxed{\\begin{pmatrix} 150.0 & 430.0 \\end{pmatrix}}$$", "id": "3022332"}, {"introduction": "尽管第一性原理计算能提供高精度的电子结构，但简化的紧束缚模型对于获得物理洞察和提高计算效率而言是无价的。从第一性原理数据构建此类模型是理论研究者的核心技能之一。本编程练习模拟了Wannier化的过程，让你通过将模型参数拟合到目标能带，来构建一个最小紧束缚模型，从而不仅能实践数值优化，还能学会根据晶体对称性的基本约束来验证你的模型。", "problem": "通过在一个简化的、考虑对称性的设置中模拟基于投影的 Wannierization，构建、拟合和验证一个最小的过渡金属-硫族化物紧束缚模型。您将处理一个二维六方单层，其点群对称性与三角棱柱配位相符。使用一个最小的轨道组分，包含一个以金属为中心的轨道和两个以硫族元素为中心的平面内轨道，以及受三重旋转对称性约束的最近邻金属-硫族元素耦合。所有能量必须以电子伏特 (eV) 为单位处理，所有晶格动量必须以弧度为单位处理，点积也以弧度计算。最终输出中不需要其他物理单位。\n\n从以下基本原理开始：\n- 对于周期性晶格，Bloch 定理意味着单粒子哈密顿量在晶格动量基下可以分解为独立的晶格动量，其哈密顿矩阵 $H(\\mathbf{k})$ 的本征值给出在 $\\mathbf{k}$ 处的能带能量。\n- 在紧束缚表象中，$H(\\mathbf{k})$ 是实空间跃迁振幅的傅里叶变换，晶格的对称性操作约束了在位项和跃迁项。\n- 对于具有三角棱柱配位和平面外镜像对称性的单层过渡金属二硫族化物，两个平面内的硫族元素类 $p$ 轨道作为一个二维不可约表示进行变换，这在高对称性极限下强制了在位简并并禁止了在位混合，而三个最近邻金属-硫族元素跃迁在三重旋转下是等效的。\n\n模型规格：\n- 使用一个包含一个以金属为中心的轨道 $d$ 和两个以硫族元素为中心的轨道 $p_x$ 和 $p_y$ 的基组，记为 $\\{d,p_x,p_y\\}$。在晶格动量 $\\mathbf{k}=(k_x,k_y)$ 处的紧束缚哈密顿量为\n$$\nH(\\mathbf{k})=\\begin{pmatrix}\n\\varepsilon_d & h_x(\\mathbf{k}) & h_y(\\mathbf{k})\\\\\nh_x(\\mathbf{k}) & \\varepsilon_p & u\\\\\nh_y(\\mathbf{k}) & u & \\varepsilon_p\n\\end{pmatrix},\n$$\n其中 $\\varepsilon_d$ 和 $\\varepsilon_p$ 是在位能，$u$ 是 $p_x$ 和 $p_y$ 之间的在位混合项，$h_x(\\mathbf{k}),h_y(\\mathbf{k})$ 源于最近邻金属-硫族元素跃迁。\n- 设三个最近邻金属到硫族元素的键方向为单位向量\n$$\n\\boldsymbol{\\delta}_1=(1,0),\\quad \\boldsymbol{\\delta}_2=\\left(-\\tfrac{1}{2},\\tfrac{\\sqrt{3}}{2}\\right),\\quad \\boldsymbol{\\delta}_3=\\left(-\\tfrac{1}{2},-\\tfrac{\\sqrt{3}}{2}\\right).\n$$\n定义与这些键相关的三个独立的实数跃迁振幅 $t_1,t_2,t_3$。令 $\\hat{\\mathbf{e}}_i=\\boldsymbol{\\delta}_i$ 表示沿键 $i\\in\\{1,2,3\\}$ 的单位向量。对非对角耦合使用时间反演对称、反演偶的约定：\n$$\nh_x(\\mathbf{k})=\\sum_{i=1}^{3} t_i\\,(\\hat{\\mathbf{e}}_i)_x \\cos(\\mathbf{k}\\cdot \\boldsymbol{\\delta}_i),\\quad\nh_y(\\mathbf{k})=\\sum_{i=1}^{3} t_i\\,(\\hat{\\mathbf{e}}_i)_y \\cos(\\mathbf{k}\\cdot \\boldsymbol{\\delta}_i).\n$$\n- 对于给定的参数集 $\\Theta=\\{\\varepsilon_d,\\varepsilon_p,u,t_1,t_2,t_3\\}$，合成的“第一性原理”能带是在一组指定的晶格动量下 $H(\\mathbf{k})$ 的排序后的本征值。\n\n通过拟合实现 Wannierization 的任务：\n- 通过估计最小紧束缚参数 $\\tilde{\\Theta}$ 来模拟基于投影的 Wannierization，这些参数可以在一组 $\\mathbf{k}$ 点上复现目标能带。使用非线性最小二乘法，在每个 $\\mathbf{k}$ 点上最小化模型能带能量与目标能带能量之差的平方和。\n- 拟合后，提取估计的最近邻跃迁振幅 $\\tilde{t}_1,\\tilde{t}_2,\\tilde{t}_3$ 和在位混合项 $\\tilde{u}$。\n\n对称性验证：\n- 对于理想的三角环境，三重旋转对称性强制要求 $t_1=t_2=t_3$，并且在位硫族元素双重态在格点上没有对称性允许的混合，因此 $u=0$。通过检查以下条件，在数值容差 $\\tau=\\;0.01\\;\\text{eV}$ 内验证拟合参数是否符合这些预期：\n$$\n\\max\\big(|\\tilde{t}_1-\\bar{t}|,|\\tilde{t}_2-\\bar{t}|,|\\tilde{t}_3-\\bar{t}|\\big)\\le \\tau,\\quad |\\tilde{u}|\\le \\tau,\n$$\n其中 $\\bar{t}=(\\tilde{t}_1+\\tilde{t}_2+\\tilde{t}_3)/3$。\n\n晶格动量采样：\n- 使用以下九个 $\\mathbf{k}$ 点，所有角度均以弧度为单位：\n$$\n\\begin{aligned}\n\\mathbf{k}_1=(0,0),\\quad \\mathbf{k}_2=\\left(\\tfrac{2\\pi}{3},0\\right),\\quad \\mathbf{k}_3=(\\pi,0),\\\\\n\\mathbf{k}_4=\\left(\\tfrac{\\pi}{2},\\tfrac{\\pi}{2\\sqrt{3}}\\right),\\quad \\mathbf{k}_5=\\left(\\tfrac{2\\pi}{3},\\tfrac{2\\pi}{3\\sqrt{3}}\\right),\\quad \\mathbf{k}_6=\\left(-\\tfrac{2\\pi}{3},\\tfrac{2\\pi}{3\\sqrt{3}}\\right),\\\\\n\\mathbf{k}_7=\\left(0,\\tfrac{2\\pi}{\\sqrt{3}}\\right),\\quad \\mathbf{k}_8=\\left(\\tfrac{\\pi}{3},\\tfrac{\\pi}{\\sqrt{3}}\\right),\\quad \\mathbf{k}_9=\\left(\\pi,\\tfrac{\\pi}{\\sqrt{3}}\\right).\n\\end{aligned}\n$$\n\n测试套件：\n- 对于下面的每种情况，将所列参数视为用于生成合成目标能带的“真实”参数 $\\Theta$。拟合程序应从一个通用的初始猜测开始，并返回一个拟合参数集 $\\tilde{\\Theta}$，然后执行上述对称性验证。为每种情况报告一个布尔值，指示对称性验证是否通过。\n- 情况 A (理想路径，对称): $\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$，$u=0.0\\;\\text{eV}$，$t_1=t_2=t_3=1.2\\;\\text{eV}$。\n- 情况 B (对称性破缺各向异性): $\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$，$u=0.0\\;\\text{eV}$，$t_1=1.2\\;\\text{eV}$，$t_2=0.9\\;\\text{eV}$，$t_3=1.35\\;\\text{eV}$。\n- 情况 C (近似对称，在容差范围内): $\\varepsilon_d=1.5\\;\\text{eV}$，$\\varepsilon_p=-1.0\\;\\text{eV}$，$u=0.0\\;\\text{eV}$，$t_1=1.2\\;\\text{eV}$，$t_2=1.205\\;\\text{eV}$，$t_3=1.195\\;\\text{eV}$。\n- 情况 D (边界情况，在位能近似简并): $\\varepsilon_d=0.0\\;\\text{eV}$，$\\varepsilon_p=0.0\\;\\text{eV}$，$u=0.0\\;\\text{eV}$，$t_1=t_2=t_3=0.8\\;\\text{eV}$。\n\n目标和输出：\n- 对于每种情况，您的程序必须在九个 $\\mathbf{k}$ 点上生成合成目标能带，通过最小化所有 $\\mathbf{k}$ 点和所有三个能带的总能带能量失配平方和来拟合最小紧束缚参数，用 $\\tau=\\;0.01\\;\\text{eV}$ 的容差对照对称性预期验证拟合的参数，并为每种情况返回一个布尔值，指示对称性验证的通过或失败。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如，[$\\text{True}$,$\\text{False}$,$\\text{True}$,$\\text{True}$]。不应打印任何其他文本。", "solution": "该问题要求构建和验证一个用于单层过渡金属二硫族化物的最小紧束缚模型。这涉及生成合成能带结构数据，将模型参数拟合到此数据，然后根据晶体对称性的预期验证拟合的参数。该过程将针对四个不同的测试用例执行。\n\n### 第 1 步：模型哈密顿量公式\n\n该系统是一个二维六方单层，其点群对称性与三角棱柱配位相符。最小紧束缚模型是基于一个包含三个轨道的基组构建的：一个以金属为中心的轨道（表示为 $d$）和两个平面内以硫族元素为中心的轨道（表示为 $p_x$ 和 $p_y$）。基的顺序为 $\\{d, p_x, p_y\\}$。\n\n在晶格动量（$\\mathbf{k}$ 空间）表象中，对于给定的晶格动量 $\\mathbf{k}=(k_x, k_y)$，哈密顿量是一个 $3 \\times 3$ 矩阵：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\n\\varepsilon_d & h_x(\\mathbf{k}) & h_y(\\mathbf{k}) \\\\\nh_x(\\mathbf{k})^* & \\varepsilon_p & u \\\\\nh_y(\\mathbf{k})^* & u & \\varepsilon_p\n\\end{pmatrix}\n$$\n模型的参数包括在位能 $\\varepsilon_d$ 和 $\\varepsilon_p$，$p_x$ 和 $p_y$ 轨道之间的在位混合参数 $u$，以及三个最近邻金属-硫族元素跃迁振幅 $t_1$、$t_2$ 和 $t_3$。这六个参数的集合表示为 $\\Theta = \\{\\varepsilon_d, \\varepsilon_p, u, t_1, t_2, t_3\\}$。由于问题指定了时间反演对称、反演偶的约定，非对角跃迁项是实数，即 $h(\\mathbf{k})^* = h(\\mathbf{k})$。因此，哈密顿矩阵是实对称的。\n\n非对角项 $h_x(\\mathbf{k})$ 和 $h_y(\\mathbf{k})$ 分别表示 $d$ 轨道与 $p_x$ 和 $p_y$ 轨道之间的总跃迁振幅。它们是通过对三个最近邻金属-硫族元素键求和来计算的。键矢量如下：\n$$\n\\boldsymbol{\\delta}_1 = (1, 0), \\quad \\boldsymbol{\\delta}_2 = \\left(-\\frac{1}{2}, \\frac{\\sqrt{3}}{2}\\right), \\quad \\boldsymbol{\\delta}_3 = \\left(-\\frac{1}{2}, -\\frac{\\sqrt{3}}{2}\\right)\n$$\n跃迁项由实空间跃迁积分的傅里叶变换定义，并受对称性约束。问题指定了以下形式：\n$$\nh_x(\\mathbf{k}) = \\sum_{i=1}^{3} t_i \\, (\\hat{\\mathbf{e}}_i)_x \\cos(\\mathbf{k} \\cdot \\boldsymbol{\\delta}_i)\n$$\n$$\nh_y(\\mathbf{k}) = \\sum_{i=1}^{3} t_i \\, (\\hat{\\mathbf{e}}_i)_y \\cos(\\mathbf{k} \\cdot \\boldsymbol{\\delta}_i)\n$$\n其中 $\\hat{\\mathbf{e}}_i = \\boldsymbol{\\delta}_i$ 是沿键方向的单位向量。代入 $\\boldsymbol{\\delta}_i$ 的分量：\n$$\nh_x(\\mathbf{k}) = t_1 \\cos(k_x) - \\frac{1}{2} t_2 \\cos\\left(-\\frac{k_x}{2} + \\frac{\\sqrt{3}k_y}{2}\\right) - \\frac{1}{2} t_3 \\cos\\left(-\\frac{k_x}{2} - \\frac{\\sqrt{3}k_y}{2}\\right)\n$$\n$$\nh_y(\\mathbf{k}) = \\frac{\\sqrt{3}}{2} t_2 \\cos\\left(-\\frac{k_x}{2} + \\frac{\\sqrt{3}k_y}{2}\\right) - \\frac{\\sqrt{3}}{2} t_3 \\cos\\left(-\\frac{k_x}{2} - \\frac{\\sqrt{3}k_y}{2}\\right)\n$$\n\n### 第 2 步：能带结构计算和参数拟合\n\n对于给定的参数集 $\\Theta$，电子能带能量 $E_n(\\mathbf{k})$（其中 $n=1,2,3$）是哈密顿矩阵 $H(\\mathbf{k})$ 的本征值。由于 $H(\\mathbf{k})$ 是一个 $3 \\times 3$ 的实对称矩阵，其本征值总是实数，并且可以使用数值本征求解器高效地找到。我们将实现一个函数，用于计算任何给定 $\\mathbf{k}$ 和 $\\Theta$ 的这些本征值。\n\n核心任务是通过拟合模型参数来模拟基于投影的 Wannierization。这涉及一个非线性最小二乘优化。对于每个测试用例，都提供了一个“真实”的参数集 $\\Theta_{\\text{true}}$。\n\n1.  **生成目标数据**：首先，我们生成“合成的第一性原理”能带结构。这是通过计算问题陈述中提供的一组特定的九个晶格动量 $\\mathbf{k}_j$ 的能带能量 $E_n^{\\text{target}}(\\mathbf{k}_j) = \\text{eigvals}(H(\\mathbf{k}_j; \\Theta_{\\text{true}}))$ 来完成的。对每个 $\\mathbf{k}_j$ 的本征值进行排序，以确保一致的比较。\n\n2.  **定义代价函数**：我们寻找一个新的参数集 $\\tilde{\\Theta}$，它能最好地复现目标能带结构。拟合的质量通过模型能带和目标能带之间残差平方和来衡量：\n    $$\n    S(\\tilde{\\Theta}) = \\sum_{j=1}^{9} \\sum_{n=1}^{3} \\left( E_n^{\\text{model}}(\\mathbf{k}_j; \\tilde{\\Theta}) - E_n^{\\text{target}}(\\mathbf{k}_j) \\right)^2\n    $$\n    最小化此代价函数是一个非线性最小二乘问题。\n\n3.  **数值优化**：我们使用 `scipy.optimize.least_squares` 函数，它非常适合这类问题。它需要一个函数来计算残差向量 $r_{jn} = E_n^{\\text{model}}(\\mathbf{k}_j; \\tilde{\\Theta}) - E_n^{\\text{target}}(\\mathbf{k}_j)$。然后，算法从一个初始猜测开始，迭代地调整 $\\tilde{\\Theta}$ 以最小化 $\\sum r_{jn}^2$。将使用一个通用的初始猜测参数 $\\tilde{\\Theta}$ 来开始拟合过程。\n\n### 第 3 步：对称性验证\n\n在优化收敛到一组拟合参数 $\\tilde{\\Theta} = \\{\\tilde{\\varepsilon}_d, \\tilde{\\varepsilon}_p, \\tilde{u}, \\tilde{t}_1, \\tilde{t}_2, \\tilde{t}_3\\}$ 后，我们必须根据对称性得出的物理预期来验证它们。对于具有理想三角棱柱配位（点群 $D_{3h}$）的结构，三重旋转对称轴意味着三个最近邻跃迁参数必须相等，即 $t_1 = t_2 = t_3$。此外，硫族元素位点上的 $p_x$ 和 $p_y$ 轨道构成一个二维不可约表示（$E'$），这禁止哈密顿量中出现任何在位混合项 $u$；因此，$u=0$。\n\n验证过程检查拟合的参数是否在给定的数值容差 $\\tau = 0.01\\;\\text{eV}$ 内满足这些对称性约束。这两个条件是：\n\n1.  **跃迁各向同性**：各个跃迁参数与其均值的偏差必须很小。设 $\\bar{t} = (\\tilde{t}_1 + \\tilde{t}_2 + \\tilde{t}_3) / 3$。条件是：\n    $$\n    \\max\\left(|\\tilde{t}_1 - \\bar{t}|, |\\tilde{t}_2 - \\bar{t}|, |\\tilde{t}_3 - \\bar{t}|\\right) \\le \\tau\n    $$\n\n2.  **在位混合**：拟合的在位混合参数 $\\tilde{u}$ 必须接近于零：\n    $$\n    |\\tilde{u}| \\le \\tau\n    $$\n\n一个测试用例只有在两个条件都满足时才通过验证。最终输出是针对四个指定测试用例中的每一个的布尔值（`True` 或 `False`），指示此验证的结果。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\ndef solve():\n    \"\"\"\n    Solves the Wannierization-by-fitting problem for four test cases.\n    For each case, it generates target bands, fits the TB model parameters,\n    and validates them against symmetry expectations.\n    \"\"\"\n    \n    # Define physical and problem-specific constants\n    SQRT3 = np.sqrt(3)\n    PI = np.pi\n    TOLERANCE = 0.01\n\n    # Define the nearest-neighbor bond vectors\n    DELTAS = np.array([\n        [1.0, 0.0],\n        [-0.5, SQRT3 / 2.0],\n        [-0.5, -SQRT3 / 2.0]\n    ])\n\n    # Define the set of nine k-points for band structure sampling\n    K_POINTS = np.array([\n        [0.0, 0.0],\n        [2 * PI / 3, 0.0],\n        [PI, 0.0],\n        [PI / 2, PI / (2 * SQRT3)],\n        [2 * PI / 3, 2 * PI / (3 * SQRT3)],\n        [-2 * PI / 3, 2 * PI / (3 * SQRT3)],\n        [0.0, 2 * PI / SQRT3],\n        [PI / 3, PI / SQRT3],\n        [PI, PI / SQRT3]\n    ])\n\n    def calculate_all_bands(params, k_points_array):\n        \"\"\"\n        Calculates band energies for a given set of parameters and k-points.\n        Args:\n            params (list or np.array): The 6 model parameters [eps_d, eps_p, u, t1, t2, t3].\n            k_points_array (np.array): Array of k-points, shape (N_k, 2).\n        Returns:\n            np.array: A flattened array of sorted band energies for all k-points.\n        \"\"\"\n        eps_d, eps_p, u, t1, t2, t3 = params\n        ts = np.array([t1, t2, t3])\n\n        num_k_points = k_points_array.shape[0]\n        num_bands = 3\n        all_bands = np.zeros((num_k_points, num_bands))\n\n        # Vectorized calculation of k dot delta\n        k_dot_deltas = k_points_array @ DELTAS.T  # Shape: (num_k_points, 3)\n        cos_vals = np.cos(k_dot_deltas)\n\n        # Vectorized calculation of h_x and h_y over all k-points\n        h_x_contribs = ts * DELTAS[:, 0]\n        h_y_contribs = ts * DELTAS[:, 1]\n        h_x_all = cos_vals @ h_x_contribs\n        h_y_all = cos_vals @ h_y_contribs\n\n        # Construct and diagonalize Hamiltonian for each k-point\n        for i in range(num_k_points):\n            h_x, h_y = h_x_all[i], h_y_all[i]\n            H_k = np.array([\n                [eps_d,  h_x,   h_y],\n                [h_x,    eps_p, u],\n                [h_y,    u,     eps_p]\n            ])\n            # np.linalg.eigh returns sorted eigenvalues for Hermitian matrices\n            eigenvalues = np.linalg.eigh(H_k)[0]\n            all_bands[i, :] = eigenvalues\n            \n        return all_bands.flatten()\n\n    def residuals(params, target_bands_flat, k_points_array):\n        \"\"\"\n        Calculates the residuals between model and target bands for the optimizer.\n        \"\"\"\n        model_bands_flat = calculate_all_bands(params, k_points_array)\n        return model_bands_flat - target_bands_flat\n\n    def perform_fit(true_params):\n        \"\"\"\n        Generates target data and performs the nonlinear least-squares fit.\n        \"\"\"\n        # 1. Generate target data from \"true\" parameters\n        target_bands = calculate_all_bands(true_params, K_POINTS)\n        \n        # 2. Set up a generic initial guess for the parameters\n        initial_guess = [1.0, -0.5, 0.1, 1.0, 1.0, 1.0]\n\n        # 3. Perform the least-squares optimization\n        result = least_squares(residuals, initial_guess, args=(target_bands, K_POINTS), method='lm')\n        \n        return result.x\n\n    def validate_symmetry(fitted_params):\n        \"\"\"\n        Checks if the fitted parameters satisfy the symmetry conditions.\n        \"\"\"\n        u_tilde = fitted_params[2]\n        t_tilde = np.array(fitted_params[3:])\n\n        # Condition 1: On-site mixing u should be close to zero\n        u_check = np.abs(u_tilde) = TOLERANCE\n        \n        # Condition 2: Hopping parameters t_i should be nearly equal\n        t_bar = np.mean(t_tilde)\n        t_deviations = np.abs(t_tilde - t_bar)\n        t_check = np.max(t_deviations) = TOLERANCE\n        \n        return u_check and t_check\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        # Case A (happy path, symmetric):\n        {'params': [1.5, -1.0, 0.0, 1.2, 1.2, 1.2]},\n        # Case B (symmetry-broken anisotropy):\n        {'params': [1.5, -1.0, 0.0, 1.2, 0.9, 1.35]},\n        # Case C (near-symmetric, within tolerance):\n        {'params': [1.5, -1.0, 0.0, 1.2, 1.205, 1.195]},\n        # Case D (edge case, near-degenerate on-sites):\n        {'params': [0.0, 0.0, 0.0, 0.8, 0.8, 0.8]},\n    ]\n    \n    results = []\n    for case in test_cases:\n        true_parameters = case['params']\n        fitted_parameters = perform_fit(true_parameters)\n        symmetry_valid = validate_symmetry(fitted_parameters)\n        results.append(symmetry_valid)\n        \n    return results\n\n# This part is for generating the final output string, not part of the `solve` function\n# that would be run in a typical environment, but necessary to format the output\n# as required by the problem statement.\nfinal_results = solve()\nformatted_results = ', '.join([str(r) for r in final_results])\n#print(f\"[{formatted_results}]\")\nreturn f\"[{formatted_results}]\"\n\n# The final result is generated by running the code conceptually\n# Case A: Symmetric, should pass. -> True\n# Case B: Anisotropic, max deviation |0.9 - 1.15| = 0.25 > 0.01, should fail. -> False\n# Case C: Near symmetric, max deviation |1.205 - 1.2| = 0.005 = 0.01, should pass. -> True\n# Case D: Symmetric, should pass. -> True\n# Expected output: [True, False, True, True]\n```", "answer": "$$\\boxed{[\\text{True}, \\text{False}, \\text{True}, \\text{True}]}$$", "id": "3022373"}]}