{"hands_on_practices": [{"introduction": "本练习旨在连接电阻的量子描述与经典描述。我们将应用 Landauer-Büttiker 形式论推导弹道收缩结构的量子化接触电阻，并探究它如何与扩散导线的经典欧姆电阻相加，这种情况在真实的介观器件中非常普遍。[@problem_id:3004896]", "problem": "一根介观金属线由一个连接两个大平衡电极的短弹道窄区串联一个长度为 $L$、横截面积为 $A$ 的均匀扩散段组成。电极具有各向同性的球形费米面，其特征是费米波矢 $k_{F}$，并且电子是自旋简并的。温度有效为零，因此输运过程由费米能量处的态主导。弹道窄区足够小，其内部的散射可以忽略不计，但量子导电通道的数量受到横向模式量子化的限制。扩散段遵循欧姆定律，其体电阻率为 $\\rho$。\n\n使用 Landauer-Büttiker 形式理论 (LBF) 和在费米面上的第一性原理模式计数，推导弹道窄区的接触电阻和扩散段的电阻。然后，求出在两个电极之间测量的复合线的两端电阻。最后，根据以下参数计算数值：\n- $k_{F} = 1.75 \\times 10^{10}\\ \\mathrm{m}^{-1}$，\n- $A = 0.80 \\times 10^{-16}\\ \\mathrm{m}^{2}$，\n- $L = 8.0 \\times 10^{-8}\\ \\mathrm{m}$，\n- $\\rho = 2.00 \\times 10^{-8}\\ \\Omega\\ \\mathrm{m}$，\n- $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$，\n- $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$。\n\n将最终的两端电阻以 $\\Omega$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "该问题要求推导和计算复合线的总两端电阻，该复合线由一个弹道窄区和一个扩散段串联在两个电极之间组成。方法是将该系统建模为两个串联的电阻，计算每个组件的电阻，然后将它们相加。这种串联相加是合理的，因为扩散段会引起非弹性散射，破坏相位相干性并有效地使电子热化，这将弹道输运和扩散输运机制解耦。因此，总电阻 $R_{total}$ 是弹道窄区的接触电阻 $R_c$ 和扩散段的电阻 $R_d$ 的和。\n$$\nR_{total} = R_c + R_d\n$$\n\n首先，我们推导弹道窄区的接触电阻 $R_c$。在零温下，多通道导体的电导 $G$ 的 Landauer-Büttiker 公式由下式给出：\n$$\nG = \\frac{2e^2}{h} \\sum_{n=1}^{M} T_n\n$$\n其中 $e$ 是元电荷，$h$ 是普朗克常数，因子 $2$ 考虑了自旋简并，$M$ 是可用的导电通道（横向模式）的总数，$T_n$ 是第 $n$ 个通道的透射概率。对于弹道导体，不存在散射，因此任何开放通道的透射概率为 1 ($T_n=1$)，而对于关闭通道则为零。公式简化为：\n$$\nG_c = \\frac{2e^2}{h} M\n$$\n其中 $M$ 是费米能量处的开放导电通道数。电阻是电导的倒数：\n$$\nR_c = \\frac{1}{G_c} = \\frac{h}{2e^2 M}\n$$\n通道数 $M$ 是通过计算横向动能小于费米能的横向模式数量来确定的。在 k 空间中，这对应于计算满足 $k_x^2 + k_y^2  k_F^2$ 的横向态 $(k_x, k_y)$ 的数量，其中 $k_F$ 是费米波矢。对于大量通道，我们可以使用半经典近似。态的数量是横向 k 空间中的允许面积 $\\pi k_F^2$ 乘以二维 k 空间中的态密度 $A/(2\\pi)^2$，其中 $A$ 是窄区的横截面积。因此，轨道通道的数量是：\n$$\nM = \\frac{A}{(2\\pi)^2} \\times (\\pi k_F^2) = \\frac{A k_F^2}{4\\pi}\n$$\n将 $M$ 的这个表达式代入 $R_c$ 的公式，我们得到 Sharvin 接触电阻：\n$$\nR_c = \\frac{h}{2e^2} \\left( \\frac{4\\pi}{A k_F^2} \\right) = \\frac{2\\pi h}{e^2 A k_F^2}\n$$\n\n接下来，我们确定扩散段的电阻 $R_d$。问题陈述该段遵循欧姆定律，体电阻率为 $\\rho$。对于长度为 $L$、横截面积为 $A$ 的均匀导体，其电阻由经典公式给出：\n$$\nR_d = \\rho \\frac{L}{A}\n$$\n\n总的两端电阻是这两个分量的和：\n$$\nR_{total} = R_c + R_d = \\frac{2\\pi h}{e^2 A k_F^2} + \\rho \\frac{L}{A}\n$$\n\n现在我们准备代入给定的数值来求得最终答案。参数如下：\n- $k_F = 1.75 \\times 10^{10}\\ \\mathrm{m}^{-1}$\n- $A = 0.80 \\times 10^{-16}\\ \\mathrm{m}^{2}$\n- $L = 8.0 \\times 10^{-8}\\ \\mathrm{m}$\n- $\\rho = 2.00 \\times 10^{-8}\\ \\Omega\\ \\mathrm{m}$\n- $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J}\\,\\mathrm{s}$\n- $e = 1.602176634 \\times 10^{-19}\\ \\mathrm{C}$\n\n我们分别计算 $R_c$ 和 $R_d$。\n对于接触电阻 $R_c$：\n$$\nR_c = \\frac{2\\pi (6.62607015 \\times 10^{-34})}{(1.602176634 \\times 10^{-19})^2 (0.80 \\times 10^{-16}) (1.75 \\times 10^{10})^2}\n$$\n我们来计算分母项：\n- $(1.602176634 \\times 10^{-19})^2 \\approx 2.566969 \\times 10^{-38}\\ \\mathrm{C}^2$\n- $(1.75 \\times 10^{10})^2 = 3.0625 \\times 10^{20}\\ \\mathrm{m}^{-2}$\n- 分母 $\\approx (2.566969 \\times 10^{-38}) \\times (0.80 \\times 10^{-16}) \\times (3.0625 \\times 10^{20}) \\approx 6.28907 \\times 10^{-34}\\ \\mathrm{C}^2 \\cdot \\mathrm{m}^{-2} \\cdot \\mathrm{m}^2 = \\mathrm{J} \\cdot \\mathrm{s} / \\Omega$\n分子是 $2\\pi (6.62607015 \\times 10^{-34}) \\approx 4.16320 \\times 10^{-33}\\ \\mathrm{J} \\cdot \\mathrm{s}$。\n$$\nR_c \\approx \\frac{4.16320 \\times 10^{-33}}{6.28907 \\times 10^{-34}} \\approx 6.61978\\ \\Omega\n$$\n\n对于扩散电阻 $R_d$：\n$$\nR_d = (2.00 \\times 10^{-8}\\ \\Omega\\ \\mathrm{m}) \\frac{8.0 \\times 10^{-8}\\ \\mathrm{m}}{0.80 \\times 10^{-16}\\ \\mathrm{m}^2}\n$$\n$$\nR_d = \\frac{2.00 \\times 8.0}{0.80} \\times \\frac{10^{-8} \\times 10^{-8}}{10^{-16}}\\ \\Omega = \\frac{16.0}{0.80} \\times \\frac{10^{-16}}{10^{-16}}\\ \\Omega = 20.0\\ \\Omega\n$$\n\n最后，总电阻是它们的和：\n$$\nR_{total} = R_c + R_d \\approx 6.61978\\ \\Omega + 20.0\\ \\Omega = 26.61978\\ \\Omega\n$$\n\n问题要求将答案四舍五入到四位有效数字。\n$$\nR_{total} \\approx 26.62\\ \\Omega\n$$", "answer": "$$\\boxed{26.62}$$", "id": "3004896"}, {"introduction": "输运现象不仅关乎平均电流，也涉及其涨落。本练习将深入探讨散粒噪声这一基本的量子现象。通过利用扩散导线中透射通道的统计分布，我们将推导出其普适的法诺因子 $F=1/3$，这是相位相干扩散输运的一个标志性特征。[@problem_id:3004943]", "problem": "考虑一根处于扩散机制下的准一维金属线，其长度 $L$ 远大于弹性平均自由程 $l$，并有大量的横向传播模式 $N \\gg 1$。该金属线在与 $L$ 相当的长度上是相位相干的（量子相干输运），并连接到理想的电子库，在零温极限 $T=0$ 下施加一个小的偏置电压 $V$。在介观输运的 Landauer-Büttiker 图像中，电导由散射矩阵的透射本征值集合 $\\{T_n\\}$ 决定。在扩散极限下，透射本征值遵循 Dorokhov 分布\n$$\n\\rho(T) = \\frac{g}{2}\\,\\frac{1}{T\\sqrt{1 - T}}, \\qquad 0  T  1,\n$$\n其中 $g \\equiv G/G_0$ 是无量纲电导，$G$ 是电导，$G_0 \\equiv 2 e^2/h$ 是电导量子。从电流及其零温散粒噪声的基本 Landauer-Büttiker 描述出发，通过将 Fano 因子 $F$ 表示为对 $\\rho(T)$ 的积分并计算这些积分，来推导扩散线的 Fano 因子。然后，根据您的推导，解释为什么所得值在扩散机制中被认为是普适的，并评论相位相干性的作用以及 Dorokhov-Mello-Pereyra-Kumar (DMPK) 框架内 Dorokhov 分布的普适性。\n\n请将最终答案表示为一个精确的无量纲数。无需四舍五入。", "solution": "Fano 因子 $F$ 的推导始于零温 $T=0$ 下电流和散粒噪声的 Landauer-Büttiker 形式体系。\n\n在小偏置电压 $V$ 下，通过多通道导体的电流 $I$ 由 Landauer 公式给出：\n$$\nI = G V = \\frac{2e^2}{h} V \\sum_{n} T_n\n$$\n其中 $e$ 是元电荷，$h$ 是普朗克常数，$\\{T_n\\}$ 是可用输运通道的透射本征值集合。量 $G_0 \\equiv 2e^2/h$ 是电导量子。总电导为 $G = G_0 \\sum_n T_n$。无量纲电导为 $g = G/G_0 = \\sum_n T_n$。\n\n在零温下，电流的时间涨落会产生散粒噪声。单边散粒噪声的零频功率谱密度 $S_I$ 由下式给出：\n$$\nS_I = \\frac{4e^3}{h} |V| \\sum_{n} T_n(1-T_n)\n$$\n该表达式反映了电子波函数在散射体处的分配过程，其中 $T_n(1-T_n)$ 表示透射概率为 $T_n$ 的单个通道的二项分布方差。\n\nFano 因子 $F$ 定义为实际散粒噪声功率与泊松噪声值 $2e|I|$ 的比值，后者是对于不相关的载流子所期望的值。\n$$\nF \\equiv \\frac{S_I}{2e|I|}\n$$\n代入 $I$ 和 $S_I$ 的表达式（为方便起见，假设 $V>0$，因此 $|V|=V$ 和 $|I|=I$）：\n$$\nF = \\frac{\\frac{4e^3V}{h} \\sum_{n} T_n(1-T_n)}{2e \\left( \\frac{2e^2V}{h} \\sum_{n} T_n \\right)}\n$$\n分子和分母中的常数项相互消去：\n$$\nF = \\frac{\\sum_{n} T_n(1-T_n)}{\\sum_{n} T_n}\n$$\n此表达式给出了用离散透射本征值集合表示的 Fano 因子。\n\n问题指出，对于具有大量通道（$N \\gg 1$）的扩散线，离散的本征值可以用一个连续分布来描述，即 Dorokhov 分布 $\\rho(T)$。因此，我们可以用对该分布的积分来替换求和。透射率在区间 $[T, T+dT]$ 内的通道数为 $dN = \\rho(T) dT$。形式为 $\\sum_n f(T_n)$ 的求和变为 $\\int f(T) \\rho(T) dT$。\n\n将此应用于 $F$ 的表达式：\n$$\nF = \\frac{\\int_0^1 T(1-T) \\rho(T) dT}{\\int_0^1 T \\rho(T) dT}\n$$\n问题给出了扩散线的 Dorokhov 分布：\n$$\n\\rho(T) = \\frac{g}{2}\\,\\frac{1}{T\\sqrt{1 - T}}, \\qquad T \\in (0, 1)\n$$\n其中 $g$ 是无量纲电导。\n\n首先，我们计算分母，它代表总无量纲电导 $g = \\sum_n T_n$：\n$$\n\\text{Denominator} = \\int_0^1 T \\rho(T) dT = \\int_0^1 T \\left( \\frac{g}{2} \\frac{1}{T\\sqrt{1-T}} \\right) dT = \\frac{g}{2} \\int_0^1 \\frac{1}{\\sqrt{1-T}} dT\n$$\n令 $u = 1-T$，则 $du = -dT$。积分上下限从 $T=0 \\to u=1$ 和 $T=1 \\to u=0$ 变化。\n$$\n\\frac{g}{2} \\int_1^0 \\frac{1}{\\sqrt{u}}(-du) = \\frac{g}{2} \\int_0^1 u^{-1/2} du = \\frac{g}{2} \\left[ 2u^{1/2} \\right]_0^1 = \\frac{g}{2} (2-0) = g\n$$\n这个结果与 $g$ 的定义是自洽的。\n\n接下来，我们计算分子：\n$$\n\\text{Numerator} = \\int_0^1 T(1-T) \\rho(T) dT = \\int_0^1 T(1-T) \\left( \\frac{g}{2} \\frac{1}{T\\sqrt{1-T}} \\right) dT\n$$\n$$\n\\text{Numerator} = \\frac{g}{2} \\int_0^1 \\frac{1-T}{\\sqrt{1-T}} dT = \\frac{g}{2} \\int_0^1 \\sqrt{1-T} dT\n$$\n使用相同的换元法 $u=1-T$：\n$$\n\\frac{g}{2} \\int_1^0 \\sqrt{u}(-du) = \\frac{g}{2} \\int_0^1 u^{1/2} du = \\frac{g}{2} \\left[ \\frac{2}{3} u^{3/2} \\right]_0^1 = \\frac{g}{2} \\left( \\frac{2}{3} \\right) = \\frac{g}{3}\n$$\n\n最后，我们通过计算分子与分母的比值来得到 Fano 因子 $F$：\n$$\nF = \\frac{\\text{Numerator}}{\\text{Denominator}} = \\frac{g/3}{g} = \\frac{1}{3}\n$$\n\n结果 $F=1/3$ 被认为是相位相干扩散导体的普适值，原因如下：\n1. 本征值分布的普适性：Dorokhov-Mello-Pereyra-Kumar (DMPK) 理论描述了透射本征值分布随系统长度 $L$ 的演化。对于处于扩散极限（$L \\gg l$，其中 $l$ 是弹性平均自由程）的准一维导体，DMPK 方程预测，无论无序的微观细节如何，本征值的分布都会收敛到一个唯一的、标度不变的稳态形式。这个普适分布正是在计算中使用的 Dorokhov 分布，$\\rho(T) \\propto (T\\sqrt{1-T})^{-1}$。\n2. 系统特定参数的消去：推导过程表明，Fano 因子是透射谱平均性质的比值。无量纲电导参数 $g$ 取决于具体的几何形状（$L$，横截面积）和无序强度（$l$），它同时出现在 $F$ 表达式的分子和分母中，并被消去。最终结果仅取决于普适分布 $\\rho(T)$ 的函数形式，而与 $g$ 的具体值无关。\n3. 相位相干性的作用：整个理论框架，包括 Landauer-Büttiker 公式和 DMPK 方程，都建立在相位相干输运的假设之上。相位相干性意味着电子在穿过样品时保持其量子力学相位信息，从而产生干涉效应，这些效应被散射矩阵及其透射本征值所捕捉。如果没有相位相干性（即，如果相位相干长度 $L_\\phi \\ll L$），输运变为经典输运，整个样品的单个散射矩阵的概念不再有效，散粒噪声被抑制，导致 Fano 因子小得多。\n\n总而言之，$F=1/3$ 这一值的普适性源于 DMPK 理论所建立的、在相位相干扩散机制下电子输运的底层统计描述的普适性。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "3004943"}, {"introduction": "为了从微观层面理解一个器件，我们需要能够探测其局域电子结构的工具。本计算练习将介绍强大的非平衡格林函数 (NEGF) 形式论。你将实现一个模型来计算局域态密度 (LDOS)，并直观地观察到与外部电极的耦合如何将一个有限系统的分立能级展宽为共振峰。[@problem_id:3004902]", "problem": "考虑一个一维介观器件，由具有$N$个格点的有限最近邻紧束缚哈密顿量描述，其在位能为$\\epsilon_{\\mathrm{d}}$，最近邻跃迁振幅为$t_{\\mathrm{d}}$。该器件在其两端分别与半无限长的左、右导线耦合，每条导线被建模为一条半无限长紧束缚链，其在位能分别为$\\epsilon_{\\mathrm{L}}$或$\\epsilon_{\\mathrm{R}}$，跃迁振幅分别为$t_{\\mathrm{L}}$或$t_{\\mathrm{R}}$。器件通过跃迁振幅$\\tau_{\\mathrm{L}}$在格点索引$j=0$处与左导线耦合，通过跃迁振幅$\\tau_{\\mathrm{R}}$在格点索引$j=N-1$处与右导线耦合。能量以电子伏特 (eV) 为单位。目标是计算在指定器件格点索引$j$和能量$E$处的局域态密度 (LDOS)，并分析由与导线的耦合引起的能级展宽效应。\n\n从格林函数形式理论和标准紧束缚模型中的基本定义出发：\n- 连接导线的器件的推迟格林函数$G^{r}(E)$是通过对半无限长导线进行积分（积掉）得到的，这会在器件哈密顿量上附加一个自能项$\\Sigma^{r}(E)$。\n- 必须计算半无限长最近邻紧束缚链的表面格林函数，并用它来构建导线的自能。\n- 必须从器件的推迟格林函数中获得局域态密度 (LDOS)。\n- 推迟自能的虚部决定了能级展宽，您必须在计算中包含它，而不引入任何不可控的近似。\n\n您的任务：\n1. 从推迟格林函数的定义和Dyson方程出发，推导通过单个跃迁$\\tau$连接到器件的半无限长导线的自能表达式。用半无限长链的表面格林函数表示导线自能，并确定正确的推迟分支。\n2. 对于给定的能量$E$，计算具有参数$(\\epsilon, t)$的半无限长链的推迟表面格林函数，确保在导线导带内外都选择了物理上正确的分支。\n3. 通过对由器件哈密顿量和导线自能构成的预解矩阵求逆，来构建器件格林函数$G^{r}(E)$。然后计算器件格点索引$j$处的局域态密度 (LDOS)。\n4. 基于您推导出的表达式，讨论导线自能的虚部如何产生能级展宽，以及这种展宽在不同耦合强度和能量下如何在局域态密度 (LDOS) 中体现。\n\n实现要求：\n- 使用具有$N$个格点的有限器件，器件哈密顿量$H_{\\mathrm{d}}$的在位能为$\\epsilon_{\\mathrm{d}}$，最近邻跃迁为$t_{\\mathrm{d}}$。\n- 与导线的耦合仅发生在末端格点$j=0$和$j=N-1$处，通过$\\Sigma_{\\mathrm{L}}^{r}(E)$和$\\Sigma_{\\mathrm{R}}^{r}(E)$实现，这些自能在除这些边界格点外的所有地方都为零。\n- 使用一个小的正无穷小量$0^{+}$，在数值上实现为加在$E$上的一个小的虚部$i \\eta$，选择$\\eta$以确保数值稳定性，而不会人为地展宽能级。\n\n单位：\n- 所有能量必须以电子伏特 ($\\mathrm{eV}$) 为单位。\n- 局域态密度 (LDOS) 必须以逆电子伏特 ($\\mathrm{eV}^{-1}$) 为单位报告。\n- 本问题不涉及角度。\n- 报告数值结果时，将每个LDOS值表示为四舍五入到$6$位小数的小数。\n\n测试套件：\n对于每个测试用例，使用提供的参数计算指定格点索引$j$和能量$E$处的局域态密度 (LDOS)。使用以下六个测试用例，每个用例指定为一个元组$(N, \\epsilon_{\\mathrm{d}}, t_{\\mathrm{d}}, E, \\epsilon_{\\mathrm{L}}, t_{\\mathrm{L}}, \\tau_{\\mathrm{L}}, \\epsilon_{\\mathrm{R}}, t_{\\mathrm{R}}, \\tau_{\\mathrm{R}}, j)$：\n- 用例 1: $(5, 0.0, 0.5, 0.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.4, 2)$\n- 用例 2: $(5, 0.0, 0.5, 2.0, 0.0, 1.0, 0.2, 0.0, 1.0, 0.2, 0)$\n- 用例 3: $(5, 0.0, 0.5, 3.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.4, 2)$\n- 用例 4: $(5, 0.0, 0.5, 0.0, 0.0, 1.0, 1.5, 0.0, 1.0, 1.5, 2)$\n- 用例 5: $(5, 0.0, 0.5, 0.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.0, 4)$\n- 用例 6: $(2, 0.0, 0.5, 0.0, 0.0, 1.0, 0.05, 0.0, 1.0, 0.0, 1)$\n\n答案规格：\n- 您的程序必须按照指定的单位和四舍五入规则计算每个测试用例的局域态密度 (LDOS)。\n- 您的程序应生成单行输出，其中包含按测试用例顺序排列的结果，格式为方括号括起来的逗号分隔列表，例如 $[x_{1},x_{2},x_{3},x_{4},x_{5},x_{6}]$，其中每个$x_{k}$是第$k$个用例的LDOS值，四舍五入到$6$位小数，并以$\\mathrm{eV}^{-1}$为单位表示。", "solution": "该问题要求使用非平衡格林函数 (NEGF) 形式理论，计算与半无限长导线耦合的一维介观器件的局域态密度 (LDOS)。该问题在科学上是合理的、良定的，并为获得唯一解提供了所有必要的参数。我们按照规定进行推导和计算。\n\n系统的整体结构由哈密顿量 $H = H_{\\mathrm{d}} + H_{\\mathrm{L}} + H_{\\mathrm{R}} + V_{\\mathrm{dL}} + V_{\\mathrm{dR}}$ 描述，其中 $H_{\\mathrm{d}}$ 是器件哈密顿量，$H_{\\mathrm{L/R}}$ 是导线哈密顿量，$V_{\\mathrm{dL/dR}}$ 描述耦合。导线对器件的影响可以通过将其积掉来精确处理，这会在器件的格林函数中引入一个自能项 $\\Sigma^{r}(E)$。在存在导线的情况下，器件的推迟格林函数由下式给出：\n$$ G^{r}(E) = \\left[ (E+i\\eta)I - H_{\\mathrm{d}} - \\Sigma_{\\mathrm{L}}^{r}(E) - \\Sigma_{\\mathrm{R}}^{r}(E) \\right]^{-1} $$\n其中$H_{\\mathrm{d}}$是器件的$N \\times N$紧束缚哈密顿量，$\\eta$是一个正无穷小量，$\\Sigma_{\\mathrm{L/R}}^{r}(E)$是由于与左/右导线耦合而产生的自能。\n\n**1. 导线自能的推导**\n\n由导线（例如左导线L）引起的自能由耦合哈密顿量 $V_{\\mathrm{dL}}$ 和孤立导线的格林函数 $g_{\\mathrm{L}}^{r}(E)$ 定义。自能是一个$N \\times N$矩阵，由$\\Sigma_{\\mathrm{L}}^{r}(E) = V_{\\mathrm{dL}} g_{\\mathrm{L}}^{r}(E) V_{\\mathrm{Ld}}$给出，其中$V_{\\mathrm{Ld}} = V_{\\mathrm{dL}}^{\\dagger}$。\n\n在这个问题中，器件通过第一个器件格点（$j=0$）和导线的第一个格点（我们将其标记为$j'=0'$）之间的一个跃迁元$\\tau_{\\mathrm{L}}$与左导线耦合。因此，耦合哈密顿量矩阵$V_{\\mathrm{dL}}$只有一个非零元，连接这两个格点。因此，自能矩阵$\\Sigma_{\\mathrm{L}}^{r}(E)$也是稀疏的，只有一个非零元，位于与导线耦合的器件格点相对应的位置：\n$$ (\\Sigma_{\\mathrm{L}}^{r}(E))_{0,0} = \\tau_{\\mathrm{L}}^2 (g_{\\mathrm{L}}^{r}(E))_{0',0'} $$\n项 $(g_{\\mathrm{L}}^{r}(E))_{0',0'}$ 是导线格林函数在接触点的对角元，根据定义，这就是导线的推迟表面格林函数，记为 $g_{s, \\mathrm{L}}^{r}(E)$。类似地，对于与格点 $j=N-1$ 耦合的右导线：\n$$ (\\Sigma_{\\mathrm{R}}^{r}(E))_{N-1,N-1} = \\tau_{\\mathrm{R}}^2 g_{s, \\mathrm{R}}^{r}(E) $$\n自能矩阵的所有其他元素都为零。\n\n**2. 推迟表面格林函数的计算**\n\n对于一个在位能为$\\epsilon$、最近邻跃迁为$-t$的半无限长紧束缚链，其表面格林函数$g_s^r(E)$可以通过递归求解Dyson方程得到。这会得到一个关于$g_s^r(E)$的二次方程：\n$$ t^2 (g_s^r(E))^2 - (E - \\epsilon) g_s^r(E) + 1 = 0 $$\n求解$g_s^r(E)$可得：\n$$ g_s^r(E) = \\frac{(E - \\epsilon) \\pm \\sqrt{(E - \\epsilon)^2 - 4t^2}}{2t^2} $$\n为了获得正确的推迟格林函数，我们必须在能量$E$上加上一个小的虚部$i\\eta$，并选择满足因果性的解的分支。对推迟格林函数的物理要求是，对于导线导带内的能量，其虚部必须为负。该能带范围从$E = \\epsilon - 2|t|$到$E = \\epsilon + 2|t|$。分子中符号的正确选择取决于能量$E$相对于导线在位能$\\epsilon$的值：\n- 如果$E \\ge \\epsilon$，必须选择减号。\n- 如果$E  \\epsilon$，必须选择加号。\n这个过程确保了$\\mathrm{Im}[g_s^r(E)] \\le 0$。如果$t=0$，导线就是一个单独的格点，公式简化为$g_s^r(E) = (E-\\epsilon+i\\eta)^{-1}$。\n\n**3. 器件格林函数和局域态密度 (LDOS)**\n\n在确定了自能之后，我们可以为器件构建完整的推迟格林函数$G^r(E)$。器件哈密顿量$H_{\\mathrm{d}}$是一个$N \\times N$矩阵，其中$(H_{\\mathrm{d}})_{j,j} = \\epsilon_{\\mathrm{d}}$和$(H_{\\mathrm{d}})_{j,j\\pm 1} = -t_{\\mathrm{d}}$。需要求逆的总预解矩阵是：\n$$ M(E) = (E+i\\eta)I - H_{\\mathrm{d}} - \\Sigma_{\\mathrm{L}}^{r}(E) - \\Sigma_{\\mathrm{R}}^{r}(E) $$\n于是格林函数为$G^r(E) = M(E)^{-1}$。\n\n器件内特定格点$j$处的局域态密度 (LDOS) 直接从推迟格林函数矩阵的对角元获得：\n$$ \\rho_j(E) = -\\frac{1}{\\pi} \\mathrm{Im}[G_{j,j}^{r}(E)] $$\n按照要求，LDOS的单位是逆能量（例如，$\\mathrm{eV}^{-1}$）。\n\n**4. 关于能级展宽的讨论**\n\n孤立器件的分立能级（$H_{\\mathrm{d}}$的本征值）在器件与导线耦合时会展宽成共振峰。这种展宽是导线自能虚部的直接结果。自能$\\Sigma^r(E) = \\mathrm{Re}[\\Sigma^r(E)] + i\\,\\mathrm{Im}[\\Sigma^r(E)]$修正了器件的预解矩阵。其实部$\\mathrm{Re}[\\Sigma^r(E)]$引起能级的移动。其虚部$\\mathrm{Im}[\\Sigma^r(E)]$为器件态中的电子引入了有限寿命，从而导致能量展宽。\n\n能级宽度矩阵定义为$\\Gamma(E) = i[\\Sigma^r(E) - \\Sigma^a(E)] = -2\\,\\mathrm{Im}[\\Sigma^r(E)]$，其中$\\Sigma^a(E) = (\\Sigma^r(E))^\\dagger$。对于我们的系统，展宽矩阵$\\Gamma(E)$的对角元为：\n$$ \\Gamma_{0,0}(E) = -2\\,\\tau_{\\mathrm{L}}^2\\,\\mathrm{Im}[g_{s, \\mathrm{L}}^{r}(E)] $$\n$$ \\Gamma_{N-1,N-1}(E) = -2\\,\\tau_{\\mathrm{R}}^2\\,\\mathrm{Im}[g_{s, \\mathrm{R}}^{r}(E)] $$\n由于$\\mathrm{Im}[g_s^r(E)]$仅在能量$E$位于导线导带内时才非零，所以能级展宽仅发生在与导线连续谱能量简并的器件态上。展宽的幅度与$\\tau^2$成正比，意味着更强的耦合导致更短的态寿命和LDOS中更宽的共振峰。$\\Gamma(E)$的能量依赖性反映了导线的态密度；展宽在导线能带中心（$E=\\epsilon$）附近最大，并在带边（$E=\\epsilon \\pm 2|t|$）处消失。如果器件能级位于两个导线能带之外的能量处，其对应的LDOS峰将保持尖锐（仅受$\\eta$限制），代表一个束缚态。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases by computing\n    the Local Density of States (LDOS) for a 1D mesoscopic device.\n    \"\"\"\n    # A small positive infinitesimal for the retarded Green's function, ensuring numerical stability.\n    eta = 1e-9\n\n    def get_surface_green_function(E, eps_lead, t_lead, eta_val):\n        \"\"\"\n        Calculates the retarded surface Green's function of a semi-infinite lead.\n\n        Args:\n            E (float): The energy.\n            eps_lead (float): On-site energy of the lead.\n            t_lead (float): Hopping amplitude in the lead.\n            eta_val (float): Small imaginary energy part.\n\n        Returns:\n            complex: The value of the retarded surface Green's function.\n        \"\"\"\n        if t_lead == 0:\n            # If hopping is zero, the lead is just an isolated site.\n            return 1 / (E - eps_lead + 1j * eta_val)\n\n        E_complex = E + 1j * eta_val\n        E_prime = E_complex - eps_lead\n        \n        # The retarded surface Green's function is a solution to a quadratic equation.\n        # g_s = [ E' +/- sqrt(E'^2 - 4t^2) ] / (2t^2)\n        # The correct physical branch is chosen to ensure causality, which requires\n        # Im[g_s] = 0. This is achieved by selecting the sign based on the \n        # energy E relative to the lead's on-site energy eps_lead.\n        radicand = E_prime**2 - (2 * t_lead)**2\n        sqrt_radicand = np.sqrt(radicand)\n        \n        if E  eps_lead:\n            # For E  eps_lead, the imaginary part of the principal square root is negative.\n            # Choosing '+' ensures the resulting Im[g_s] is negative.\n            numerator = E_prime + sqrt_radicand\n        else:\n            # For E >= eps_lead, the imaginary part of the principal square root is positive.\n            # Choosing '-' ensures the resulting Im[g_s] is negative.\n            numerator = E_prime - sqrt_radicand\n\n        denominator = 2 * t_lead**2\n        \n        return numerator / denominator\n\n\n    def calculate_ldos(N, eps_d, t_d, E, eps_L, t_L, tau_L, eps_R, t_R, tau_R, j):\n        \"\"\"\n        Calculates the Local Density of States (LDOS) for a single test case.\n        \"\"\"\n        # 1. Calculate lead surface Green's functions\n        g_s_L = get_surface_green_function(E, eps_L, t_L, eta)\n        g_s_R = get_surface_green_function(E, eps_R, t_R, eta)\n\n        # 2. Construct self-energy matrices for left and right leads\n        Sigma_L = np.zeros((N, N), dtype=complex)\n        if tau_L != 0:\n            Sigma_L[0, 0] = tau_L**2 * g_s_L\n\n        Sigma_R = np.zeros((N, N), dtype=complex)\n        if tau_R != 0 and N > 0:\n            Sigma_R[N - 1, N - 1] = tau_R**2 * g_s_R\n            \n        Sigma = Sigma_L + Sigma_R\n\n        # 3. Construct the device Hamiltonian matrix (tridiagonal)\n        H_d = np.zeros((N, N))\n        for i in range(N):\n            H_d[i, i] = eps_d\n        if N > 1:\n            for i in range(N - 1):\n                H_d[i, i + 1] = -t_d\n                H_d[i + 1, i] = -t_d\n\n        # 4. Construct the full resolvent matrix to be inverted\n        E_complex = E + 1j * eta\n        M = E_complex * np.identity(N) - H_d - Sigma\n\n        # 5. Invert the matrix to get the device's retarded Green's function\n        G_r = np.linalg.inv(M)\n\n        # 6. Calculate LDOS from the imaginary part of the diagonal element\n        # LDOS_j(E) = -1/pi * Im(G_r_jj(E))\n        ldos_val = - (1 / np.pi) * np.imag(G_r[j, j])\n        \n        return ldos_val\n\n    # Test suite provided in the problem statement\n    test_cases = [\n        # (N, eps_d, t_d, E, eps_L, t_L, tau_L, eps_R, t_R, tau_R, j)\n        (5, 0.0, 0.5, 0.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.4, 2),\n        (5, 0.0, 0.5, 2.0, 0.0, 1.0, 0.2, 0.0, 1.0, 0.2, 0),\n        (5, 0.0, 0.5, 3.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.4, 2),\n        (5, 0.0, 0.5, 0.0, 0.0, 1.0, 1.5, 0.0, 1.0, 1.5, 2),\n        (5, 0.0, 0.5, 0.0, 0.0, 1.0, 0.4, 0.0, 1.0, 0.0, 4),\n        (2, 0.0, 0.5, 0.0, 0.0, 1.0, 0.05, 0.0, 1.0, 0.0, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        ldos = calculate_ldos(*case)\n        results.append(f\"{ldos:.6f}\")\n\n    # Print the final results in the specified single-line format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3004902"}]}