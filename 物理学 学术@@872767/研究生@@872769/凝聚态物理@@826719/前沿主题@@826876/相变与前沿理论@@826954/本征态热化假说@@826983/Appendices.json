{"hands_on_practices": [{"introduction": "本征态热化假说（ETH）为局域可观测量在能量本征基矢下的矩阵元预设了一种特定的数学结构。在应用这一强大假说之前，理解其各个组分的性质至关重要。本练习将通过施加任何物理可观测量都必须满足的基本性质——厄米性，来探讨它对ETH ansatz结构所施加的约束，从而阐明其中各个项的作用 [@problem_id:2984492]。", "problem": "考虑一个哈密顿量为 $\\hat{H}$ 且能量本征态为 $\\{|n\\rangle\\}$ 的有限、不可积量子多体系统，$\\hat{H}|n\\rangle=E_n|n\\rangle$。令 $\\hat{O}$ 为一个少体厄米可观测量，其在能量本征基中的矩阵元满足 $O_{mn}=O_{nm}^{*}$，其中 $O_{mn}\\equiv\\langle m|\\hat{O}|n\\rangle$。假设本征态热化假说 (Eigenstate Thermalization Hypothesis, ETH) 拟设对 $\\hat{O}$ 成立，即\n$$\nO_{mn}=O(\\bar{E})\\,\\delta_{mn}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},\\omega)\\,R_{mn},\n$$\n并具有以下标准的 ETH 定义和假设：\n- $\\bar{E}\\equiv (E_m+E_n)/2$ 且 $\\omega\\equiv E_m-E_n$。\n- $S(E)$ 是微正则熵，一个关于能量的光滑实函数。\n- $O(E)$ 是一个光滑函数，给出在能量 $E$ 时 $\\hat{O}$ 的微正则平均值。\n- $f_{O}(E,\\omega)$ 是关于其变量的光滑函数。\n- $R_{mn}$ 是零均值、单位方差的随机变量，当 $m\\neq n$ 时相互独立，并且按照惯例有 $R_{mm}=0$。\n\n施加厄米性条件 $O_{mn}=O_{nm}^{*}$，并推导这对随机变量 $R_{mn}$ 和函数 $f_{O}(E,\\omega)$ 所施加的约束。为了将这些约束编码为具体的计算目标，定义以下三个量\n$$\n\\Delta_{O}(\\bar{E})\\equiv O(\\bar{E})-O^{*}(\\bar{E}),\\qquad T_{mn}\\equiv R_{mn}-R_{nm}^{*},\\qquad S_{f}(\\bar{E},\\omega)\\equiv f_{O}(\\bar{E},\\omega)-f_{O}^{*}(\\bar{E},-\\omega).\n$$\n仅使用上述假设和 $\\hat{O}$ 的厄米性，确定 $\\Delta_{O}(\\bar{E})$、$T_{mn}$ 和 $S_{f}(\\bar{E},\\omega)$ 的闭式表达式。以行向量的形式给出你的最终结果，其中按所示顺序包含这三个表达式。无需四舍五入。最终表达式是无量纲的。", "solution": "该问题要求针对厄米可观测量 $\\hat{O}$，从其矩阵元的厄米性条件出发，推导对本征态热化假说 (ETH) 拟设各分量的约束。厄米算符的矩阵元必须满足 $O_{mn} = O_{nm}^{*}$，其中 $O_{mn} \\equiv \\langle m|\\hat{O}|n\\rangle$。\n\n矩阵元 $O_{mn}$ 的 ETH 拟设由下式给出：\n$$\nO_{mn} = O(\\bar{E})\\,\\delta_{mn}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},\\omega)\\,R_{mn}\n$$\n变量定义为 $\\bar{E} = (E_m+E_n)/2$ 和 $\\omega = E_m-E_n$。函数 $S(E)$ 是微正则熵，且为实数。\n\n为了施加厄米性条件 $O_{mn} = O_{nm}^{*}$，我们首先需要写出 $O_{nm}$ 的表达式。这可以通过在拟设中交换下标 $m$ 和 $n$ 来实现。对于下标对 $(n, m)$，平均能量为 $\\bar{E}' = (E_n+E_m)/2 = \\bar{E}$。能量差为 $\\omega' = E_n-E_m = -(E_m-E_n) = -\\omega$。\n因此，矩阵元 $O_{nm}$ 由下式给出：\n$$\nO_{nm} = O(\\bar{E})\\,\\delta_{nm}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},-\\omega)\\,R_{nm}\n$$\n接下来，我们取 $O_{nm}$ 的复共轭。由于 $S(\\bar{E})$ 是一个实函数，项 $\\exp(-S(\\bar{E})/2)$ 是实数。我们得到：\n$$\nO_{nm}^{*} = \\left(O(\\bar{E})\\,\\delta_{nm}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},-\\omega)\\,R_{nm}\\right)^{*}\n$$\n$$\nO_{nm}^{*} = O^{*}(\\bar{E})\\,\\delta_{mn}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}^{*}(\\bar{E},-\\omega)\\,R_{nm}^{*}\n$$\n这里，我们使用了克罗内克 δ 的对称性，即 $\\delta_{nm} = \\delta_{mn}$。\n\n现在我们将 $O_{mn}$ 和 $O_{nm}^{*}$ 的表达式相等：\n$$\nO(\\bar{E})\\,\\delta_{mn}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},\\omega)\\,R_{mn} = O^{*}(\\bar{E})\\,\\delta_{mn}+\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}^{*}(\\bar{E},-\\omega)\\,R_{nm}^{*}\n$$\n这个方程必须对所有下标对 $(m, n)$ 都成立。我们分别分析对角元和非对角元的情况。\n\n情况1：对角元 ($m=n$)\n对于对角元，我们有 $\\delta_{mn} = 1$。能量差为 $\\omega = E_n - E_n = 0$，平均能量为 $\\bar{E} = E_n$。根据惯例，对角元的随机变量 $R_{nn}=0$。方程简化为：\n$$\nO(E_n) = O^{*}(E_n)\n$$\n这意味着函数 $O(E)$（代表可观测量 $\\hat{O}$ 的微正则平均值）在其定义域内的任何能量 $E$ 处都必须是实值的。\n第一个要确定的量是 $\\Delta_{O}(\\bar{E}) \\equiv O(\\bar{E}) - O^{*}(\\bar{E})$。根据我们的发现，可得：\n$$\n\\Delta_{O}(\\bar{E}) = 0\n$$\n\n情况2：非对角元 ($m \\neq n$)\n对于非对角元，$\\delta_{mn} = 0$。方程变为：\n$$\n\\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}(\\bar{E},\\omega)\\,R_{mn} = \\exp\\!\\big(-S(\\bar{E})/2\\big)\\,f_{O}^{*}(\\bar{E},-\\omega)\\,R_{nm}^{*}\n$$\n由于熵 $S(\\bar{E})$ 是有限的，指数前因子非零，我们可以将其约去，得到：\n$$\nf_{O}(\\bar{E},\\omega)\\,R_{mn} = f_{O}^{*}(\\bar{E},-\\omega)\\,R_{nm}^{*}\n$$\n该方程构成了厄米性对拟设非对角部分施加的约束。该拟设的核心物理假设是将一个矩阵元分离为一个光滑的、确定性的部分（此处为 $f_O$）和一个伪随机部分（$R_{mn}$）。为了使这种分离在结构上保持一致且有意义，任何基本对称性（例如厄米性）都应反映在拟设的各个分量中。如果随机变量 $R_{mn}$ 的某个特定属性依赖于光滑函数 $f_O$ 的值，这将意味着光滑部分和随机部分之间存在一种“精细调节的共谋”，从而破坏了它们分离的基本原则。\n\n因此，满足该关系的最自然、最一致的方式是让光滑部分和随机部分独立地满足厄米性约束。这导致方程解耦为两个独立的条件。尽管可以在这两个关系式之间分配一个非平凡的相因子，但不失一般性地，这样的相因子可以被吸收到 $f_O$ 和 $R_{mn}$ 的定义中。保持 $R_{mn}$ 给定统计特性的标准惯例是将此相因子设为零。这导致以下两个约束条件：\n1. $f_{O}(\\bar{E},\\omega) = f_{O}^{*}(\\bar{E},-\\omega)$\n2. $R_{mn} = R_{nm}^{*}$\n\n现在我们可以确定剩下的两个量。\n第二个量是 $S_{f}(\\bar{E},\\omega) \\equiv f_{O}(\\bar{E},\\omega) - f_{O}^{*}(\\bar{E},-\\omega)$。使用上面推导的第一个约束，我们得到：\n$$\nS_{f}(\\bar{E},\\omega) = 0\n$$\n第三个量是 $T_{mn} \\equiv R_{mn} - R_{nm}^{*}$。使用第二个约束，我们得到：\n$$\nT_{mn} = 0\n$$\n\n总之，算符 $\\hat{O}$ 的厄米性约束了 ETH 拟设中的函数和随机变量，使得 $O(E)$ 是实数，$f_{O}(\\bar{E},\\omega) = f_{O}^{*}(\\bar{E},-\\omega)$，并且 $R_{mn} = R_{nm}^{*}$。这导出了所要求的三个量都为零的结论。\n\n最终表达式为：\n$\\Delta_{O}(\\bar{E}) = 0$\n$T_{mn} = 0$\n$S_{f}(\\bar{E},\\omega) = 0$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  0 \\end{pmatrix}}\n$$", "id": "2984492"}, {"introduction": "在牢固掌握ETH ansatz的结构之后，我们现在可以应用它来预测一个物理过程的结果。这个问题模拟了在非可积自旋链中的量子淬火，这是研究热化现象的一个标准场景。你将运用ETH来论证系统会发生热化，并通过首先确定一个有效温度，来计算一个局域可观测量在长时间演化后的期望值，从而将抽象的假说与具体的、可计算的预测联系起来 [@problem_id:2984527]。", "problem": "考虑一个具有周期性边界条件的 $L$ 个自旋-$\\tfrac{1}{2}$ 自由度的一维链。淬火后的哈密顿量为\n$$\nH \\,=\\, J \\sum_{i=0}^{L-1} \\sigma_{i}^{z}\\sigma_{i+1}^{z} \\;+\\; h_{x} \\sum_{i=0}^{L-1} \\sigma_{i}^{x} \\;+\\; h_{z} \\sum_{i=0}^{L-1} \\sigma_{i}^{z},\n$$\n其中 $\\sigma_{i}^{\\alpha}$（$\\alpha \\in \\{x,y,z\\}$）是格点 $i$ 上的泡利矩阵，而 $J$、$h_{x}$、$h_{z}$ 是非零实数参数。由于同时存在纵向场和横向场，该模型是不可积的。通过一个局域微扰来制备初始纯态，该微扰翻转格点 0 处的自旋，而所有其他自旋都沿 $+z$ 方向极化，\n$$\n|\\psi_{0}\\rangle \\,=\\, |\\downarrow_{0}\\rangle \\bigotimes_{i=1}^{L-1} |\\uparrow_{i}\\rangle,\n$$\n并在 $t=0$ 时刻淬火到上述哈密顿量 $H$ 下进行演化。设我们感兴趣的局域可观测量为 $O \\equiv \\sigma_{0}^{z}$。\n\n利用本征态热化假说（ETH），论证在长时间后，可观测量 $O$ 的期望值会趋近于其在正则系综中的热力学值。该正则系综的有效逆温度 $\\beta_{\\mathrm{eff}}$ 由 $|\\psi_{0}\\rangle$ 的淬火后守恒能量密度确定。从正则系综和高温展开的基本定义出发，且不假设 $H$ 的任何特殊可积性，执行以下操作：\n\n1. 精确计算初始能量 $E_{0} = \\langle \\psi_{0} | H | \\psi_{0} \\rangle$，用 $J$、$h_{x}$、$h_{z}$ 和 $L$ 表示。\n\n2. 在正则系综中使用领头阶高温展开，通过将 $H$ 的热平均值与 $E_{0}$ 匹配来确定 $\\beta_{\\mathrm{eff}}$。\n\n3. 在 $\\beta_{\\mathrm{eff}}$ 的相同领头阶下，预测长时间后的值 $\\langle \\sigma_{0}^{z} \\rangle_{\\mathrm{ETH}}$。\n\n将您的最终结果表示为 $\\langle \\sigma_{0}^{z} \\rangle_{\\mathrm{ETH}}$ 关于 $J$、$h_{x}$、$h_{z}$ 和 $L$ 的单个闭式解析表达式。不需要进行数值计算或四舍五入，也无需指定物理单位。", "solution": "本征态热化假说（ETH）假设，对于一个通用的、不可积的量子多体系统，在淬火之后，一个局域可观测量的期望值的长时间平均值会达到平衡，趋于相应的热系综所预测的值。具体的热系综及其参数由系统的守恒量决定。在本例中，唯一的守恒量是总能量。初始态 $|\\psi_0\\rangle$ 不是哈密顿量 $H$ 的本征态，因此它会随时间演化。它可以表示为 $H$ 的能量本征态 $|E_n\\rangle$ 的叠加：$|\\psi_0\\rangle = \\sum_n c_n |E_n\\rangle$。随时间演化的态是 $|\\psi(t)\\rangle = e^{-iHt/\\hbar} |\\psi_0\\rangle = \\sum_n c_n e^{-iE_n t/\\hbar} |E_n\\rangle$。可观测量 $O=\\sigma_0^z$ 的期望值为 $\\langle O(t) \\rangle = \\sum_{m,n} c_m^* c_n e^{i(E_m-E_n)t/\\hbar} \\langle E_m|O|E_n\\rangle$。长时间平均由对角项（$m=n$）主导：$\\overline{\\langle O(t) \\rangle} = \\sum_n |c_n|^2 \\langle E_n|O|E_n\\rangle$。\n\n根据ETH，对角矩阵元 $\\langle E_n|O|E_n\\rangle$ 是能量 $E_n$ 的一个平滑函数，它等价于 $O$ 在该能量下的微正则平均值。如果能量分布 $|c_n|^2$ 在平均能量 $E_0 = \\langle\\psi_0|H|\\psi_0\\rangle$ 附近呈尖锐峰值，那么长时间平均值可以很好地用能量为 $E_0$ 时的微正则平均值来近似。对于大系统，这等价于在有效逆温度 $\\beta_{\\mathrm{eff}}$ 下的正则系综平均值，该温度由正则系综中的平均能量与 $E_0$ 相匹配的条件确定。我们按照问题中概述的三个步骤进行。\n\n第1步：计算初始能量 $E_0$。\n初始能量是哈密顿量 $H$ 在初始态 $|\\psi_0\\rangle$ 中的期望值。\n$$\nE_0 = \\langle \\psi_0 | H | \\psi_0 \\rangle = \\left\\langle \\psi_0 \\left| J \\sum_{i=0}^{L-1} \\sigma_{i}^{z}\\sigma_{i+1}^{z} + h_{x} \\sum_{i=0}^{L-1} \\sigma_{i}^{x} + h_{z} \\sum_{i=0}^{L-1} \\sigma_{i}^{z} \\right| \\psi_0 \\right\\rangle\n$$\n态 $|\\psi_0\\rangle = |\\downarrow_0\\rangle \\bigotimes_{i=1}^{L-1} |\\uparrow_i\\rangle$ 是每个 $\\sigma_i^z$ 算符的本征态：对于 $i \\in \\{1, \\dots, L-1\\}$，有 $\\sigma_0^z |\\psi_0\\rangle = -1 |\\psi_0\\rangle$ 和 $\\sigma_i^z |\\psi_0\\rangle = +1 |\\psi_0\\rangle$。我们计算 $H$ 中每一项的期望值。\n\n对于横向场项：$\\sigma_i^x$ 会翻转格点 $i$ 处的自旋。所得到的态与 $|\\psi_0\\rangle$ 正交。因此，对所有 $i$，$\\langle\\psi_0|\\sigma_i^x|\\psi_0\\rangle=0$。该项的贡献为 $0$。\n\n对于纵向场项：\n$$\n\\left\\langle \\psi_0 \\left| h_z \\sum_{i=0}^{L-1} \\sigma_i^z \\right| \\psi_0 \\right\\rangle = h_z \\left( \\langle\\psi_0|\\sigma_0^z|\\psi_0\\rangle + \\sum_{i=1}^{L-1} \\langle\\psi_0|\\sigma_i^z|\\psi_0\\rangle \\right) = h_z(-1 + (L-1)\\times 1) = h_z(L-2)\n$$\n\n对于相互作用项，我们使用周期性边界条件（$\\sigma_L^z \\equiv \\sigma_0^z$）：\n$$\n\\left\\langle \\psi_0 \\left| J \\sum_{i=0}^{L-1} \\sigma_i^z \\sigma_{i+1}^z \\right| \\psi_0 \\right\\rangle = J \\left( \\langle\\sigma_0^z\\sigma_1^z\\rangle + \\sum_{i=1}^{L-2} \\langle\\sigma_i^z\\sigma_{i+1}^z\\rangle + \\langle\\sigma_{L-1}^z\\sigma_0^z\\rangle \\right)\n$$\n这些乘积的期望值为：\n$\\langle\\sigma_0^z\\sigma_1^z\\rangle = (-1)(+1) = -1$。\n对于 $i \\in \\{1, \\dots, L-2\\}$，$\\langle\\sigma_i^z\\sigma_{i+1}^z\\rangle = (+1)(+1) = 1$。共有 $L-2$ 个这样的项。\n$\\langle\\sigma_{L-1}^z\\sigma_0^z\\rangle = (+1)(-1) = -1$。\n总期望值为 $J(-1 + (L-2) \\times 1 - 1) = J(L-4)$。\n\n将各项合并，初始能量为：\n$$\nE_0 = J(L-4) + h_z(L-2)\n$$\n\n第2步：使用高温展开确定 $\\beta_{\\mathrm{eff}}$。\n能量的热平均值为 $\\langle H \\rangle_\\beta = \\frac{\\mathrm{Tr}(H e^{-\\beta H})}{Z(\\beta)}$，其中 $Z(\\beta) = \\mathrm{Tr}(e^{-\\beta H})$。高温展开对应于小的 $\\beta$。我们将指数展开到 $\\beta$ 的领头阶：$e^{-\\beta H} \\approx \\mathbb{I} - \\beta H$。\n配分函数为 $Z(\\beta) = \\mathrm{Tr}(\\mathbb{I} - \\beta H) = \\mathrm{Tr}(\\mathbb{I}) - \\beta \\mathrm{Tr}(H)$。迹是在 $2^L$ 维的希尔伯特空间上计算的。$\\mathrm{Tr}(\\mathbb{I}) = 2^L$。任何单个泡利矩阵的迹都为零，因此 $\\mathrm{Tr}(\\sigma_i^\\alpha)=0$。哈密顿量是若干项之和，这些项要么是单个泡利矩阵，要么是不同格点上两个泡利矩阵的乘积。所有这些项都是无迹的。因此，$\\mathrm{Tr}(H)=0$。\n在领头阶下，$Z(\\beta) \\approx 2^L$。\n\n分子是 $\\mathrm{Tr}(H e^{-\\beta H}) \\approx \\mathrm{Tr}(H(\\mathbb{I} - \\beta H)) = \\mathrm{Tr}(H) - \\beta \\mathrm{Tr}(H^2) = -\\beta \\mathrm{Tr}(H^2)$。\n因此，领头阶的热平均能量为 $\\langle H \\rangle_\\beta \\approx -\\beta \\frac{\\mathrm{Tr}(H^2)}{2^L}$。\n我们必须计算 $\\mathrm{Tr}(H^2)$：\n$$\nH^2 = \\left( J \\sum_{i} \\sigma_{i}^{z}\\sigma_{i+1}^{z} + h_{x} \\sum_{j} \\sigma_{j}^{x} + h_{z} \\sum_{k} \\sigma_{k}^{z} \\right)^2\n$$\n在取迹时，涉及不同指标或不同泡利分量的算符乘积的交叉项会消失。例如，$\\mathrm{Tr}(\\sigma_i^\\alpha \\sigma_j^\\gamma) = 2^L \\delta_{ij}\\delta_{\\alpha\\gamma}$。此外，$\\mathrm{Tr}(\\sigma_i^z \\sigma_{i+1}^z \\sigma_j^x)=0$。因此，只有 $H$ 中每一项的平方对 $\\mathrm{Tr}(H^2)$ 有贡献。\n$$\n\\mathrm{Tr}(H^2) = \\mathrm{Tr}\\left[ \\left(J \\sum_{i} \\sigma_{i}^{z}\\sigma_{i+1}^{z}\\right)^2 + \\left(h_{x} \\sum_{j} \\sigma_{j}^{x}\\right)^2 + \\left(h_{z} \\sum_{k} \\sigma_{k}^{z}\\right)^2 \\right]\n$$\n$\\mathrm{Tr}((\\sum_j \\sigma_j^x)^2) = \\sum_{j,j'} \\mathrm{Tr}(\\sigma_j^x \\sigma_{j'}^x) = \\sum_j \\mathrm{Tr}((\\sigma_j^x)^2) = \\sum_j \\mathrm{Tr}(\\mathbb{I}) = L 2^L$。\n类似地，$\\mathrm{Tr}((\\sum_k \\sigma_k^z)^2) = L 2^L$。\n对于相互作用项，$\\mathrm{Tr}((\\sum_i \\sigma_i^z\\sigma_{i+1}^z)^2) = \\sum_{i,i'} \\mathrm{Tr}(\\sigma_i^z\\sigma_{i+1}^z\\sigma_{i'}^z\\sigma_{i'+1}^z)$。仅当 $i=i'$ 时迹不为零。所以，$\\sum_i \\mathrm{Tr}((\\sigma_i^z\\sigma_{i+1}^z)^2) = \\sum_i \\mathrm{Tr}(\\mathbb{I}) = L 2^L$。\n结合这些结果：\n$$\n\\mathrm{Tr}(H^2) = J^2(L 2^L) + h_x^2(L 2^L) + h_z^2(L 2^L) = L(J^2 + h_x^2 + h_z^2)2^L\n$$\n热能量为 $\\langle H \\rangle_\\beta \\approx -\\beta L(J^2 + h_x^2 + h_z^2)$。\n我们通过设置 $\\langle H \\rangle_{\\beta_{\\mathrm{eff}}} = E_0$ 来找到 $\\beta_{\\mathrm{eff}}$：\n$$\n-\\beta_{\\mathrm{eff}} L(J^2 + h_x^2 + h_z^2) = J(L-4) + h_z(L-2)\n$$\n$$\n\\beta_{\\mathrm{eff}} = - \\frac{J(L-4) + h_z(L-2)}{L(J^2 + h_x^2 + h_z^2)}\n$$\n\n第3步：预测长时间值 $\\langle \\sigma_0^z \\rangle_{\\mathrm{ETH}}$。\n根据ETH，该值由正则平均值 $\\langle \\sigma_0^z \\rangle_{\\beta_{\\mathrm{eff}}}$ 给出。\n$$\n\\langle \\sigma_0^z \\rangle_\\beta = \\frac{\\mathrm{Tr}(\\sigma_0^z e^{-\\beta H})}{Z(\\beta)} \\approx \\frac{\\mathrm{Tr}(\\sigma_0^z(\\mathbb{I} - \\beta H))}{2^L}\n$$\n分子是 $\\mathrm{Tr}(\\sigma_0^z) - \\beta \\mathrm{Tr}(\\sigma_0^z H) = -\\beta \\mathrm{Tr}(\\sigma_0^z H)$，因为 $\\mathrm{Tr}(\\sigma_0^z)=0$。\n我们计算 $\\mathrm{Tr}(\\sigma_0^z H)$：\n$$\n\\mathrm{Tr}(\\sigma_0^z H) = \\mathrm{Tr}\\left(\\sigma_0^z \\left[ J \\sum_{i} \\sigma_{i}^{z}\\sigma_{i+1}^{z} + h_{x} \\sum_{j} \\sigma_{j}^{x} + h_{z} \\sum_{k} \\sigma_{k}^{z} \\right]\\right)\n$$\n$J$ 项的迹，$\\sum_i \\mathrm{Tr}(\\sigma_0^z \\sigma_i^z \\sigma_{i+1}^z)$，为零，因为三个不同格点上的泡利矩阵乘积的迹为零，而诸如 $\\mathrm{Tr}(\\sigma_0^z\\sigma_0^z\\sigma_1^z) = \\mathrm{Tr}(\\sigma_1^z)$ 这样的项也为零。\n$h_x$ 项的迹，$\\sum_j \\mathrm{Tr}(\\sigma_0^z \\sigma_j^x)$，对所有 $j$ 都为零，因为如果 $\\alpha \\neq \\gamma$，则 $\\mathrm{Tr}(\\sigma^\\alpha \\sigma^\\gamma)=0$。\n$h_z$ 项的迹是 $\\sum_k \\mathrm{Tr}(\\sigma_0^z \\sigma_k^z)$。这仅在 $k=0$ 时非零。\n$$\n\\mathrm{Tr}(\\sigma_0^z h_z \\sigma_0^z) = h_z \\mathrm{Tr}((\\sigma_0^z)^2) = h_z \\mathrm{Tr}(\\mathbb{I}) = h_z 2^L\n$$\n所以，$\\mathrm{Tr}(\\sigma_0^z H) = h_z 2^L$。\n热平均值为 $\\langle \\sigma_0^z \\rangle_\\beta \\approx \\frac{-\\beta (h_z 2^L)}{2^L} = -\\beta h_z$。\n代入 $\\beta = \\beta_{\\mathrm{eff}}$：\n$$\n\\langle \\sigma_0^z \\rangle_{\\mathrm{ETH}} = - \\beta_{\\mathrm{eff}} h_z = - \\left( - \\frac{J(L-4) + h_z(L-2)}{L(J^2 + h_x^2 + h_z^2)} \\right) h_z\n$$\n$$\n\\langle \\sigma_0^z \\rangle_{\\mathrm{ETH}} = \\frac{h_z (J(L-4) + h_z(L-2))}{L(J^2 + h_x^2 + h_z^2)}\n$$\n这是预测的长时间后 $\\sigma_0^z$ 期望值的最终表达式。", "answer": "$$\n\\boxed{\\frac{h_{z} \\left(J(L-4) + h_{z}(L-2)\\right)}{L\\left(J^{2} + h_{x}^{2} + h_{z}^{2}\\right)}}\n$$", "id": "2984527"}, {"introduction": "理论预测，无论多么优雅，都需要实验或数值的验证。这个总结性的练习提供了一个机会，使用精确对角化这一强大工具来数值检验ETH的核心论断。通过模拟一次量子淬火，并明确地比较一个可观测量的时间平均值与其微正则系综预测值，你将在量子波函数的层面上直接“看到”热化过程，为该假说提供一个强有力且直观的确认 [@problem_id:2984456]。", "problem": "考虑一个长度为 $L$ 的有限自旋-$\\tfrac{1}{2}$链，其具有周期性边界条件，Pauli 矩阵 $\\sigma_i^x$、$\\sigma_i^y$ 和 $\\sigma_i^z$ 作用在格点 $i \\in \\{0,1,\\dots,L-1\\}$ 上。设淬火后的哈密顿量为\n$$\nH = \\sum_{i=0}^{L-1} \\left[ J \\left( \\sigma_i^x \\sigma_{i+1}^x + \\sigma_i^y \\sigma_{i+1}^y + \\Delta \\, \\sigma_i^z \\sigma_{i+1}^z \\right) + J_2 \\left( \\sigma_i^x \\sigma_{i+2}^x + \\sigma_i^y \\sigma_{i+2}^y + \\Delta \\, \\sigma_i^z \\sigma_{i+2}^z \\right) \\right] + \\sum_{i=0}^{L-1} h_i \\sigma_i^z + g \\sum_{i=0}^{L-1} \\sigma_i^x,\n$$\n其中周期性边界条件理解为 $\\sigma_{i+L}^\\alpha \\equiv \\sigma_i^\\alpha$，适用于任何 $\\alpha \\in \\{x,y,z\\}$。在位场值 $h_i$ 是从区间 $[-W, W]$ 中均匀抽取的独立同分布随机变量，并为保证可复现性而指定了伪随机种子。对于一般参数，这种耦合和场的选择会产生一个非可积的哈密顿量。\n\n一个初始乘积态 $|\\psi_0\\rangle$ 由一个长度为 $L$、字符集为 $\\{0,1\\}$ 的二进制字符串 $b$ 指定，其中字符 $b_i$ 对应于格点 $i$。映射关系为：$b_i = 0$ 表示本征值为 $+1$ 的局域 $\\sigma^z$ 本征态（自旋向上），$b_i = 1$ 表示本征值为 $-1$ 的局域 $\\sigma^z$ 本征态（自旋向下）。计算基索引的定义方式是，使 $|\\psi_0\\rangle$ 的整数标签等于 $\\sum_{i=0}^{L-1} b_i 2^i$，即格点索引 $i$ 按小端序映射到比特位置 $i$。\n\n设局域可观测量为指定格点 $\\ell$ 上的 $A = \\sigma_\\ell^z$。在由 $H$ 生成的幺正时间演化下，有 $|\\psi(t)\\rangle = e^{-i H t} |\\psi_0\\rangle$，随时间变化的期望值为 $\\langle A \\rangle_t \\equiv \\langle \\psi(t) | A | \\psi(t) \\rangle$。长时间平均定义为\n$$\n\\overline{\\langle A \\rangle} \\equiv \\lim_{T \\to \\infty} \\frac{1}{T} \\int_0^T \\langle \\psi(t) | A | \\psi(t) \\rangle \\, dt.\n$$\n假设谱是非简并的，该值等于在 $H$ 的本征基中的对角系综值，此值可通过谱分解精确计算。在所制备的能量密度下的微正则预测定义如下：令 $E_0 \\equiv \\langle \\psi_0 | H | \\psi_0 \\rangle$ 为初始态相对于 $H$ 的能量期望。$A$ 的微正则平均是在以 $E_0$ 为中心的一个能量窗内，对角矩阵元 $\\langle E_n | A | E_n \\rangle$ 的算术平均。该能量窗包含谱中固定比例 $\\alpha$ 的态，但不少于 $N_{\\min}$ 个态，并通过 $|E_n - E_0|$ 选择最接近 $E_0$ 的本征态。\n\n您的任务是实现一个精确对角化算法，该算法：\n- 根据给定参数构造 $H$。\n- 对角化 $H$ 以获得本征值 $\\{E_n\\}$ 和正交归一的本征矢量 $\\{|E_n\\rangle\\}$。\n- 利用交叠 $c_n \\equiv \\langle E_n | \\psi_0 \\rangle$ 和对角矩阵元 $A_{nn} \\equiv \\langle E_n | A | E_n \\rangle$ 通过对角系综计算长时间平均 $\\overline{\\langle A \\rangle}$。\n- 计算微正则平均 $\\langle A \\rangle_{\\text{micro}}$，即在能量最接近 $E_0$ 的 $N_{\\text{win}} = \\max(N_{\\min}, \\lfloor \\alpha \\cdot 2^L \\rfloor)$ 个本征态上对 $A_{nn}$ 求平均。\n- 通过检查绝对差 $|\\overline{\\langle A \\rangle} - \\langle A \\rangle_{\\text{micro}}|$ 是否受限于一个给定的有限尺寸容差 $\\epsilon(L) = \\kappa / \\sqrt{2^L}$（其中 $\\kappa$ 为给定常数），来验证本征态热化假说 (ETH)。\n\n您的推导和算法应基于以下基本原理：\n- 含时 Schrödinger 方程和由不含时哈密顿量生成的幺正演化。\n- $H$ 的谱分解以及在正交归一基中展开系数的 Parseval 恒等式。\n- 微正则系综的定义，即对局域可观测量在窄能量窗内的平均。\n\n不应使用超出这些原理的快捷公式或提示；其正确性必须源于第一性原理和可靠的数值逻辑。所有量都是无量纲的，不涉及物理单位。如果存在角度，单位为弧度，但此处不需要。\n\n测试套件和答案规范：\n实现您的程序，使其能在以下参数集上运行，每个参数集都描述为一个元组：\n$$\n\\text{情况 } k: \\quad (L, J, \\Delta, J_2, g, W, \\text{seed}, \\alpha, N_{\\min}, \\ell, \\kappa, b)\n$$\n其中\n- 情况 $1$：$(8, 1.0, 1.2, 0.5, 0.7, 0.8, 31415, 0.04, 10, 3, 1.0, \\text{\"10101010\"})$,\n- 情况 $2$：$(10, 1.0, 1.0, 0.3, 0.9, 1.0, 2023, 0.03, 10, 5, 1.0, \\text{\"1001011001\"})$,\n- 情况 $3$：$(6, 1.0, 1.1, 0.4, 0.5, 0.5, 7, 0.08, 10, 2, 1.0, \\text{\"000000\"})$。\n\n对于每种情况，计算布尔结果：\n$$\n\\text{ETH\\_holds} = \\left( \\left| \\overline{\\langle A \\rangle} - \\langle A \\rangle_{\\text{micro}} \\right| \\leq \\frac{\\kappa}{\\sqrt{2^L}} \\right).\n$$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序排列，例如 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$，其中每个 $\\text{result}_k$ 是情况 $k$ 的布尔值。", "solution": "该问题要求对一个特定的非可积量子自旋链模型进行本征态热化假说（ETH）的数值验证。该验证涉及将一个局域可观测量的时间平均值与其微正则期望值进行比较。这需要对系统的哈密顿量进行完全的精确对角化。本解答从第一性原理出发，系统地阐述求解步骤。\n\n### 1. 希尔伯特空间表示\n系统是一条由 $L$ 个自旋-$\\tfrac{1}{2}$粒子组成的链。总希尔伯特空间 $\\mathcal{H}$ 是局域二维希尔伯特空间的张量积，即 $\\mathcal{H} = \\bigotimes_{i=0}^{L-1} \\mathcal{H}_i$。该空间的维度为 $D = 2^L$。我们在计算基中进行计算，该基由局域 $\\sigma^z$ 算符的乘积态构成。一个基矢记为 $|s_0, s_1, \\dots, s_{L-1}\\rangle$，其中 $s_i \\in \\{+1, -1\\}$ 是 $\\sigma_i^z$ 的本征值。\n\n问题指定了这些自旋构型与从 $0$ 到 $D-1$ 的整数索引之间的映射。一个长度为 $L$ 的二进制字符串 $b$ 定义了一个初始态，其中字符 $b_i=0$ 对应自旋向上（$s_i=+1$）态，而 $b_i=1$ 对应自旋向下（$s_i=-1$）态。一个基矢的整数索引 $k$ 由小端序转换给出：$k = \\sum_{i=0}^{L-1} b_i 2^i$，其中 $b_i$ 是格点 $i$ 的比特位。对于索引为 $k$ 的态，其在格点 $i$ 的自旋值为 $s_i = 1 - 2b_i = 1 - 2((k \\gg i) \\land 1)$。\n\n### 2. 哈密顿量构造\n哈密顿量 $H$ 是一个 $D \\times D$ 矩阵，其矩阵元由 $H_{mn} = \\langle m | H | n \\rangle$ 给出，其中 $|m\\rangle$ 和 $|n\\rangle$ 是计算基矢。我们通过计算其矩阵元来构造该矩阵。\n\n**对角元：** 算符 $\\sigma_i^z$ 和 $\\sigma_i^z \\sigma_j^z$ 在计算基中是对角的。对于一个基矢 $|k\\rangle$，有 $\\sigma_i^z |k\\rangle = s_i |k\\rangle$。因此，对角元 $H_{kk} = \\langle k | H | k \\rangle$ 为：\n$$\nH_{kk} = \\sum_{i=0}^{L-1} \\left( h_i s_i + J \\Delta s_i s_{i+1} + J_2 \\Delta s_i s_{i+2} \\right)\n$$\n其中索引在模 $L$ 的意义下取值。\n\n**非对角元：** 非对角元由包含 $\\sigma^x$ 和 $\\sigma^y$ 的项产生。\n- **横向场 ($g \\sum_i \\sigma_i^x$)：** 算符 $\\sigma_i^x$ 会翻转格点 $i$ 处的自旋。当它作用于态 $|k\\rangle$ 时，会产生态 $|k \\oplus 2^i\\rangle$，其中 $\\oplus$ 是按位异或。由项 $g \\sigma_i^x$ 产生的连接这两个态的矩阵元是 $g$。\n- **XY 相互作用 ($J(\\sigma_i^x \\sigma_{i+1}^x + \\sigma_i^y \\sigma_{i+1}^y)$)：** 我们使用恒等式 $\\sigma_i^x \\sigma_j^x + \\sigma_i^y \\sigma_j^y = 2(\\sigma_i^+ \\sigma_j^- + \\sigma_i^- \\sigma_j^+)$，其中 $\\sigma^\\pm$ 是自旋升降算符。该算符会交换 $i, j$ 格点上反平行的自旋，并湮灭平行的自旋态。具体来说，如果态 $|k\\rangle$ 在格点 $i$ 和 $j$ 上具有反平行的自旋（即 $b_i \\neq b_j$），此项会将其与态 $|m\\rangle = |k \\oplus 2^i \\oplus 2^j\\rangle$ 连接起来，矩阵元为 $2$。因此，来自最近邻 XY 项对矩阵元的贡献是 $2J$，而来自次近邻项的贡献是 $2J_2$。\n\n构建 $H$ 的算法涉及遍历每个基矢 $|k\\rangle$，并对于哈密顿量求和中的每一项，将其贡献加到相应的矩阵元上。\n\n### 3. 对角化和初始态\n一旦构造出实对称哈密顿矩阵 $H$，就使用标准的数值线性代数程序对其进行对角化。这将得到一组实数本征值 $\\{E_n\\}$ 和一组相应的正交归一的本征矢量 $\\{|E_n\\rangle\\}$。\n$$\nH |E_n\\rangle = E_n |E_n\\rangle\n$$\n初始态 $|\\psi_0\\rangle$ 是由二进制字符串 $b$ 指定的计算基矢 $|k_0\\rangle$。索引 $k_0$ 计算为 $k_0 = \\sum_{i=0}^{L-1} \\text{int}(b_i) 2^i$。\n\n### 4. 长时间平均（对角系综）\n随时间演化的态为 $|\\psi(t)\\rangle = e^{-iHt} |\\psi_0\\rangle$。在 $H$ 的本征基中展开 $|\\psi_0\\rangle$，$|\\psi_0\\rangle = \\sum_n c_n |E_n\\rangle$，系数为 $c_n = \\langle E_n | \\psi_0 \\rangle$。长时间平均由对角系综给出：\n$$\n\\overline{\\langle A \\rangle} = \\sum_n |c_n|^2 \\langle E_n | A | E_n \\rangle\n$$\n系数 $c_n$ 是本征矢量 $|E_n\\rangle$ 在计算基中的第 $k_0$ 个分量。可观测量 $A = \\sigma_\\ell^z$ 在能量本征基中的对角矩阵元 $A_{nn} = \\langle E_n | A | E_n \\rangle$ 可通过基变换计算。\n\n### 5. 微正则平均\n微正则平均 $\\langle A \\rangle_{\\text{micro}}$ 是在初始态能量 $E_0 = \\langle \\psi_0 | H | \\psi_0 \\rangle$ 附近的一个窄能量窗内，对角矩阵元 $A_{nn}$ 的平均值。该能量窗包含 $N_{\\text{win}} = \\max(N_{\\min}, \\lfloor \\alpha \\cdot 2^L \\rfloor)$ 个能量 $\\{E_n\\}$ 最接近 $E_0$ 的本征态。\n$$\n\\langle A \\rangle_{\\text{micro}} = \\frac{1}{N_{\\text{win}}} \\sum_{n \\in \\text{window}} A_{nn}\n$$\n\n### 6. ETH 验证\nETH 预测局域可观测量的长时间平均值应与相应能量下的微正则预测相匹配。验证过程是直接检查这两个计算量之间的绝对差是否受限于一个依赖于系统尺寸的容差：\n$$\n|\\overline{\\langle A \\rangle} - \\langle A \\rangle_{\\text{micro}}| \\leq \\epsilon(L) = \\frac{\\kappa}{\\sqrt{2^L}}\n$$\n该算法实现这些步骤，以计算每个测试用例的布尔结果。", "answer": "[True, True, True]", "id": "2984456"}]}