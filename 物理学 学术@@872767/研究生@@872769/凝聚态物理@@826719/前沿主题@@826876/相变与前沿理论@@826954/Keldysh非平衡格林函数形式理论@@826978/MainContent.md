## 引言
在现代凝聚态物理中，从纳米电子器件到超快[激光](@entry_id:194225)实验，大量关键现象都发生在远离热平衡的状态下。描述这些非平衡[量子多体系统](@entry_id:141221)的演化，是理论物理面临的一大挑战，因为传统基于平衡态[统计力](@entry_id:194984)学的方法（如松原形式主义）在此失效。Keldysh[非平衡格林函数](@entry_id:201883)（NEGF）形式主义正是为解决这一难题而发展的强大理论武器，它提供了一个能够从第一性原理出发，统一处理含时驱动、相互作用和[量子统计](@entry_id:143815)的严谨框架。

本文将系统地引导读者掌握这一核心工具。我们将首先在“原理与机制”一章中，从构建Keldysh时间路径出发，深入剖析其数学结构和物理内涵。接着，在“应用与跨学科[交叉](@entry_id:147634)”一章中，我们将展示该形式主义如何在[量子输运](@entry_id:138932)、[自旋电子学](@entry_id:141468)、超导物理等多个前沿领域大显身手。最后，通过“动手实践”部分提供的一系列练习，读者将有机会亲手运用所学知识解决具体问题，从而加深理解。

## 原理与机制

继引言部分概述了非平衡系统的挑战与研究动机之后，本章将深入探讨Keldysh[非平衡格林函数](@entry_id:201883)形式主义的核心原理与基本机制。我们将从构建形式主义的基石——Keldysh时间路径（contour）——出发，系统阐明如何将量子系统的动力学演化与初始[统计系综](@entry_id:149738)统一在同一框架下。随后，我们将介绍一种关键的幺正变换，即Keldysh旋转，它极大地简化了理论结构，并清晰地分离了系统的谱信息与布居信息。最终，我们将探讨该形式主义在具体问题中的应用，阐明其与传统[平衡态](@entry_id:168134)理论的联系与区别，并剖析非平衡瞬态动力学和[稳态解](@entry_id:200351)的深层物理机制。

### Keldysh时间路径与路径排序算符

在[量子多体理论](@entry_id:161885)中，一个算符 $A$ 在时刻 $t$ 的[期望值](@entry_id:153208)由下式给出：
$$
\langle A(t) \rangle = \mathrm{Tr}[\rho_0 A_H(t)]
$$
其中，$\rho_0$ 是系统在初始时刻 $t_0$ 的[密度矩阵](@entry_id:139892)，$A_H(t)$ 是在[海森堡绘景](@entry_id:141162)下的算符。其[时间演化](@entry_id:153943)由系统的[哈密顿量](@entry_id:172864) $H(t)$ 决定：
$$
A_H(t) = U^{\dagger}(t, t_0) A U(t, t_0)
$$
而[时间演化算符](@entry_id:196774) $U(t, t_0)$ 是由[含时薛定谔方程](@entry_id:137898)定义的幺正算符，其形式解为 $U(t, t_0) = T \exp(-i \int_{t_0}^t dt' H(t'))$，$T$ 为[编时算符](@entry_id:148044)。将此代入[期望值](@entry_id:153208)表达式，我们得到：
$$
\langle A(t) \rangle = \mathrm{Tr}[\rho_0 U(t_0, t) A U(t, t_0)]
$$
此表达式的结构揭示了一个核心挑战：它同时包含了从 $t_0$ 到 $t$ 的“前向”[演化算符](@entry_id:182628) $U(t, t_0)$ 和从 $t$ 回到 $t_0$ 的“后向”[演化算符](@entry_id:182628) $U(t_0, t)$。Keldysh形式主义的第一个精妙之处在于，它将这两个看似分离的演化过程统一为沿着一条闭合时间路径的单一演化。

这条路径被称为 **Keldysh时间路径** (Keldysh contour)，通常记作 $\mathcal{C}$。最简单的Keldysh路径包含两个实时间分支 [@problem_id:2997996]：
1.  **前向分支** ($\mathcal{C}_+$)：时间从初始时刻 $t_0$ 演化至某个足够大的时刻 $t_{\mathrm{max}}$。
2.  **后向分支** ($\mathcal{C}_-$)：时间从 $t_{\mathrm{max}}$ 演化回初始时刻 $t_0$。

通过这种方式，原本的迹运算可以被重新表述为在 $\mathcal{C}$ 上的路径积分。为了处理这条路径上的算符乘积，我们必须引入 **路径排序算符** (contour-ordering operator) $T_{\mathcal{C}}$。$T_{\mathcal{C}}$ 的作用是将在路径上“较晚”出现的算符置于“较早”出现的算符的左侧。其具体规则如下 [@problem_id:2997996]：

*   **同一分支上的排序**：
    *   若两个算符都位于前向分支 $\mathcal{C}_+$，则 $T_{\mathcal{C}}$ 等同于标准的 **编时排序** ($T$)，即实时间较大的算符在左边。
    *   若两个算符都位于后向分支 $\mathcal{C}_-$，则 $T_{\mathcal{C}}$ 等同于 **反编时排序** ($\tilde{T}$)，即实时间较小的算符在左边。这是因为在后向分支上，路径的“前进方向”与实时间的流逝方向相反。

*   **不同分支间的排序**：
    *   任何位于后向分支 $\mathcal{C}_-$ 上的算符，无论其实时间为何，在路径排序中都总是在任何位于前向分支 $\mathcal{C}_+$ 上的算符的左边。这是因为整个 $\mathcal{C}_+$ 路径是在 $\mathcal{C}_-$ 路径之前被遍历的。

*   **[费米子](@entry_id:146235)符号**：
    *   对于[费米子算符](@entry_id:149120)，每次为了实现路径排序而进行的对易操作，都会引入一个 $(-1)$ 的符号因子。对于[玻色子](@entry_id:138266)算符则无此符号变化。

利用路径排序算符，任何算符[乘积的期望值](@entry_id:201037)都可以形式上写为 $\langle T_{\mathcal{C}}[\dots] \rangle$。这为发展一套类似于平衡态的微扰理论和[戴森方程](@entry_id:146246)奠定了基础。

### 初始关联与[虚时间](@entry_id:138627)分支

仅包含实时间分支的Keldysh路径足以处理系统初始处于纯态的情况。然而，在更普遍的情况下，系统初始处于一个混合态，例如与环境达到热平衡的状态。此时，初始密度矩阵 $\rho_0$ 对于一个正则系综具有形式 $\rho_0 = Z^{-1} \exp(-\beta H_0)$，其中 $\beta = 1/(k_B T)$ 是[逆温](@entry_id:140086)度，$H_0$ 是初始时刻的[哈密顿量](@entry_id:172864)。

为了将这个指数形式的算符 $\exp(-\beta H_0)$ 无缝地整合到路径演化中，Keldysh形式主义引入了第三个分支：**[虚时间](@entry_id:138627)分支** ($\mathcal{C}_v$) [@problem_id:2997978]。这个分支从初始时刻 $t_0$ 沿着虚时间轴延伸到 $t_0 - i\beta$。这是因为算符 $\exp(-\beta H_0)$ 在数学上等价于在虚时间方向上从 $0$ 演化到 $\beta$ 的[演化算符](@entry_id:182628)（即 $t \to -i\tau$）。因此，这条完整的路径，有时被称为 **Keldysh-Larkin-Ovchinnikov (KLO) 路径**，其结构为：
$$
\mathcal{C}: t_0 \xrightarrow{\mathcal{C}_+} t_{\mathrm{max}} \xrightarrow{\mathcal{C}_-} t_0 \xrightarrow{\mathcal{C}_v} t_0 - i\beta
$$
通过在路径中包含虚时间部分，初始时刻的[统计关联](@entry_id:172897)被内在地编码进了路径演化之中。这使得我们能够处理具有 **初始关联** (initial correlations) 的非[平衡问题](@entry_id:636409)。

引入[虚时间](@entry_id:138627)分支的后果是深远的 [@problem_id:2997978] [@problem_id:2997992]。格林函数 $G(z_1, z_2)$ 现在是一个定义在完整KLO路径上的函数，其中 $z_1, z_2$ 可以是实时间或[虚时间](@entry_id:138627)。
*   当两个时间变量都在虚轴上时，格林函数退化为标准的[平衡态](@entry_id:168134) **[松原格林函数](@entry_id:199218)** (Matsubara Green's function)。
*   当一个时间变量在实时间分支上，另一个在[虚时间](@entry_id:138627)分支上时，我们得到所谓的 **[混合时间](@entry_id:262374)格林函数** (mixed-time Green's functions)，通常记为 $G^{\rceil}$ 和 $G^{\lfloor}$。

这些[混合时间](@entry_id:262374)分量并非可有可无的计算副产品，它们恰恰是描述初始热系综与后续实时间动力学之间关联的桥梁。在形式理论中，它们作为一种“记忆”或“源”项，将初始关联的影响注入到系统的整个非平衡演化过程中。

### Keldysh旋转与[矩阵表示](@entry_id:146025)

在路径 $\mathcal{C}$ 上定义了格林函数后，我们可以通过将两个时间变量分别置于前向 ($+$) 或后向 ($-$) 分支来得到一个 $2 \times 2$ 的矩阵表示：
$$
\check{G}_{\text{branch}} =
\begin{pmatrix}
G^{++}  G^{+-} \\
G^{-+}  G^{--}
\end{pmatrix}
=
\begin{pmatrix}
G^{T}  G^{} \\
G^{>}  G^{\tilde{T}}
\end{pmatrix}
$$
其中，$G^T$ 和 $G^{\tilde{T}}$ 分别是编时和反编时[格林函数](@entry_id:147802)，$G^{}$ (lesser) 和 $G^{>}$ (greater) 格林函数则直接与粒子的占据和空穴的关联有关，$G^{}(t,t') = i \langle \psi^{\dagger}(t') \psi(t) \rangle$ 和 $G^{>}(t,t') = -i \langle \psi(t) \psi^{\dagger}(t') \rangle$。虽然这个“分支”基底是形式主义的直接产物，但其物理图像不够清晰，且矩阵结构较为复杂。

为了简化理论并揭示更深刻的物理结构，我们引入一个线性变换，即 **Keldysh旋转** (Keldysh rotation)。这个变换的目的是将[格林函数](@entry_id:147802)从“分支”基底转换到一个新的基底，该基底能将描述系统因果响应的 **谱信息** (spectral information) 与描述[粒子统计](@entry_id:145640)[分布](@entry_id:182848)的 **布居信息** (distributional information) 分离开来 [@problem_id:2997972]。这个新基底的成员是：

*   **[推迟格林函数](@entry_id:139183)** (Retarded Green's function, $G^R$): $G^R(t,t') = \Theta(t-t')(G^{>}(t,t') - G^{}(t,t'))$。它描述了系统对 $t'$ 时刻微扰在未来 $t$ 时刻的因果响应。
*   **超前格林函数** (Advanced Green's function, $G^A$): $G^A(t,t') = \Theta(t'-t)(G^{}(t,t') - G^{>}(t,t'))$。
*   **Keldysh格林函数** ($G^K$): $G^K(t,t') = G^{>}(t,t') + G^{}(t,t')$。

在这个新的“推迟-超前-Keldysh”(RAK) 基底下，格林函数矩阵（以及[自能](@entry_id:145608)矩阵）呈现出优雅的上三角或下三角结构。一个常见的约定是上三角形式 [@problem_id:2997967] [@problem_id:2997972]：
$$
\check{G} \equiv
\begin{pmatrix}
G^{R}  G^{K} \\
0  G^{A}
\end{pmatrix}
$$
这个简洁的三角结构是因果律的直接体现，它极大地简化了[微扰展开](@entry_id:159275)中的图象规则。例如，一个完全由[推迟格林函数](@entry_id:139183) $G^R$ 构成的闭合圈图的贡献恒为零，因为 $G^R(t,t')$ 的因果性（要求 $t > t'$）使得在圈中无法满足时间依次增大的闭合条件 [@problem_id:2997972]。

更重要的是，物理信息的分解变得清晰：
*   对角元 $G^R$ 和 $G^A$ 包含了系统的 **谱信息**。它们的极点对应于[准粒子](@entry_id:136584)的能量，虚部则与[准粒子](@entry_id:136584)的寿命有关。谱函数 $A(\omega) = i(G^R(\omega) - G^A(\omega))$ 描述了在能量 $\omega$ 处可用的单粒子态密度。
*   非对角元 $G^K$ 包含了系统的 **布居信息**。在[热平衡](@entry_id:141693)状态下，$G^K$ 并非独立，它通过 **涨落-耗散定理** (fluctuation-dissipation theorem) 与[谱函数](@entry_id:147628)联系在一起，其形式为 $G^K(\omega) = -i A(\omega) (1 - 2f_{FD}(\omega))$，其中 $f_{FD}(\omega)$ 是[费米-狄拉克分布](@entry_id:138909)函数。而在非平衡状态下，涨落-耗散定理失效，$G^K$ 成为一个独立的量，它直接编码了非平衡的粒子布居情况，必须通过求解动力学方程来确定 [@problem_id:2997972]。

### [戴森方程](@entry_id:146246)与量子动力学方程

在Keldysh形式主义中，[戴森方程](@entry_id:146246)也具有与[格林函数](@entry_id:147802)相同的矩阵结构。在RAK基底下，它写作 $\check{G}^{-1} = \check{G}_{0}^{-1} - \check{\Sigma}$，其中 $\check{G}_0$ 是[无相互作用系统](@entry_id:143064)的格林函数，而 $\check{\Sigma}$ 是自能矩阵。为了求解这个方程，我们首先需要计算 $\check{G}$ 的逆。对于上三角形式的 $\check{G}$，其逆矩阵可以被直接求出 [@problem_id:2997967]：
$$
\check{G}^{-1} =
\begin{pmatrix}
(G^{R})^{-1}  -(G^{R})^{-1} G^{K} (G^{A})^{-1} \\
0  (G^{A})^{-1}
\end{pmatrix}
$$
将这个表达式与[戴森方程](@entry_id:146246) $\check{G}^{-1} = (\check{G}_0)^{-1} - \check{\Sigma}$ 的[矩阵元](@entry_id:186505)对应起来，我们便得到了各个分量的方程：

1.  **对角分量方程**:
    $$
    (G^{R})^{-1} = (G_{0}^{R})^{-1} - \Sigma^{R}
    $$
    $$
    (G^{A})^{-1} = (G_{0}^{A})^{-1} - \Sigma^{A}
    $$
    这些方程只涉及推迟和超前分量，它们相互解耦，描述了相互作用如何修正系统的谱性质（例如，[能级移动](@entry_id:156631)和展宽）。

2.  **非对角分量方程**:
    $$
    -(G^{R})^{-1} G^{K} (G^{A})^{-1} = - (G_{0}^{R})^{-1} G_{0}^{K} (G_{0}^{A})^{-1} - \Sigma^{K}
    $$
    整理后可得：
    $$
    G^{K} = G^{R} \left[ (G_0^R)^{-1} G_0^K (G_0^A)^{-1} + \Sigma^{K} \right] G^{A}
    $$
    这个方程被称为 **[量子动力学](@entry_id:138183)方程** (quantum kinetic equation)。它描述了Keldysh分量 $G^K$（即粒子布居）的演化。方程右边的第一项代表了从初始态演化而来的布居，而自能项 $\Sigma^K$ 通常被称为“[碰撞积分](@entry_id:152100)”，它包含了所有导致粒子布居发生变化的散射过程。这个方程是整个非平衡形式主义的核心成果之一，它为从第一性原理出发研究输运和弛豫过程提供了理论工具。例如，可以通过引入一个广义的[分布函数](@entry_id:145626)算符 $F$，其定义为 $G^K = G^R F - F G^A$，将上述方程转化为一个关于 $F$ 的动力学方程，从而在更接近[玻尔兹曼方程](@entry_id:141554)的框架下理解非平衡布居的演化 [@problem_id:2997967]。

### 应用与诠释

#### Keldysh与Matsubara形式主义的对比

学习非平衡理论时，一个常见的问题是：何时必须使用Keldysh形式主义，何时更为简单的[平衡态](@entry_id:168134)松原（Matsubara）形式主义就足够了？[@problem_id:2997968]

**松原形式主义** 构建于虚时间轴 $\tau \in [0, \beta]$ 上，其内在结构与热平衡统计算符 $\exp(-\beta H)$ 紧密相连。它天然适用于描述[时间平移](@entry_id:261541)不变的 **热平衡态**。通过[傅里叶变换](@entry_id:142120)到[松原频率](@entry_id:197724) $i\omega_n$，格林函数成为单变量函数 $\mathcal{G}(i\omega_n)$。通过解析延拓 $i\omega_n \to \omega + i0^+$ 可以得到实频率的[推迟格林函数](@entry_id:139183) $G^R(\omega)$。

**Keldysh形式主义** 则构建于实时间路径上，能够处理任意[含时哈密顿量](@entry_id:136684)和[远离平衡](@entry_id:185355)的初始态。它产生的是双时间[格林函数](@entry_id:147802) $G(t, t')$，其[傅里叶变换](@entry_id:142120)是双变量函数 $G(\omega, \omega')$（或在时间平移不变情况下依赖于中心时间和相对时间的函数）。

两者的关键区别在于对 **瞬态动力学** (transient dynamics) 的描述能力。考虑一个在 $t=0$ 时刻发生[量子淬火](@entry_id:145899)（例如，突然施加偏压）的系统 [@problem_id:2997968]。
*   对于 $t>0$ 的瞬态过程，系统不再处于[定态](@entry_id:137260)，[时间平移不变性](@entry_id:270209)被打破。关联函数 $G(t, t')$ 依赖于两个时间变量，而不仅仅是它们的时间差。松原形式主义的[解析延拓](@entry_id:147225)只能得到依赖于时间差的 $G^R(t-t')$，无法捕捉到完整的双时间依赖性。
*   更重要的是，像电流、粒子[数密度](@entry_id:268986)这样的[物理可观测量](@entry_id:154692)，其表达式直接依赖于 $G^{}(t,t')$。在非平衡瞬态过程中，$G^{}(t,t')$ 不再能通过简单的涨落-耗散定理由 $G^R(t,t')$ 决定。必须使用Keldysh形式主义，通过求解[量子动力学](@entry_id:138183)方程来直接计算 $G^{}(t,t')$ 的演化 [@problem_id:2997968]。

总结来说，松原形式主义是计算平衡态性质和[线性响应](@entry_id:146180)的有力工具。而对于任何涉及显式时间依赖、[量子淬火](@entry_id:145899)后的瞬态弛豫、或强[非线性](@entry_id:637147)驱动下的[非平衡现象](@entry_id:198484)，Keldysh形式主义是必不可少的。

#### 初始态的设定：Partitioned vs. Partition-Free方案

在具体的非平衡输运问题计算中，如何设定初始态是一个关键的实践问题。主要有两种方案 [@problem_id:2997989]：

*   **Partitioned 方案 (Caroli-type)**：此方案假设在初始时刻 $t_0$ 之前，系统的中心区域与电极（leads）是相互[解耦](@entry_id:637294)的。整个系统的初始密度矩阵是各子系统（中心区和各电极）自身[热平衡](@entry_id:141693)[密度矩阵](@entry_id:139892)的直积 $\rho_0 = \rho_C \otimes \prod_\alpha \rho_\alpha$。在 $t_0$ 时刻，耦合被突然打开，驱动系统离开初始的“分块”平衡态。在这种方案下，由于子系统间没有初始关联，电极的[热平衡](@entry_id:141693)性质可以被有效地吸收到作用于中心区的[自能](@entry_id:145608)项中（例如，小于[自能](@entry_id:145608)$\Sigma^(\omega)$完全由处于各自[平衡态](@entry_id:168134)的电极所贡献）。