{"hands_on_practices": [{"introduction": "要真正掌握量子自旋液体的概念，最好的起点莫过于研究一个精确可解的模型。环面编码（Toric Code）模型正是这样一个典范，它完美地展示了 $\\mathbb{Z}_2$ 拓扑序的核心特征。通过这个练习 [@problem_id:3012567]，你将从第一性原理出发，仅利用泡利矩阵的代数性质，推导出该模型在环面上的基态简并度，并识别出其分数化的任意子激发（e, m, 和 $\\epsilon$），从而亲手揭开拓扑物态的神秘面纱。", "problem": "考虑方格晶格上的环面码模型，其自由度为位于边上的自旋-1/2，哈密顿量定义为\n$$\nH \\;=\\; -J_{e}\\sum_{s} A_{s} \\;-\\; J_{m}\\sum_{p} B_{p},\n$$\n其中 $A_{s} \\equiv \\prod_{\\ell \\in s} \\sigma_{\\ell}^{x}$ 是作用在与一个顶点（星）$s$ 相邻的边 $\\ell$ 上的泡利矩阵 $\\sigma^{x}$ 的乘积，而 $B_{p} \\equiv \\prod_{\\ell \\in p} \\sigma_{\\ell}^{z}$ 是作用在环绕一个格子 $p$ 的边 $\\ell$ 上的泡利矩阵 $\\sigma^{z}$ 的乘积。假设在两个方向上都采用周期性边界条件（即环面的拓扑结构），并且 $J_{e} > 0$ 和 $J_{m} > 0$。\n\n仅从稳定子 $A_{s}$ 和 $B_{p}$ 以及泡利矩阵的代数性质出发，推导定义环面上基态流形的独立稳定子约束的数量，并由此计算精确的基态简并度。在同一推导过程中，识别由沿路径的 $\\sigma^{z}$ 或 $\\sigma^{x}$ 乘积构成的开弦算符所产生的元激发（任意子），以及它们的束缚态。除泡利矩阵的对易关系和上述给出的定义外，不要假定任何其他结果。\n\n请用一个整数表示环面基态简并度的最终答案，不带单位。", "solution": "该问题要求分析具有周期性边界条件（环面）的方格晶格上的环面码模型。我们需要仅根据泡利矩阵和哈密顿量中定义的稳定子算符的代数性质，推导基态简并度并识别元激发。\n\n哈密顿量由 $H = -J_{e}\\sum_{s} A_{s} - J_{m}\\sum_{p} B_{p}$ 给出，其中 $J_e > 0$ 且 $J_m > 0$。算符 $A_s$ 和 $B_p$ 定义在位于晶格边上的自旋-1/2 自由度上。\n-   星算符 $A_{s} = \\prod_{\\ell \\in s} \\sigma_{\\ell}^{x}$ 是作用在与顶点 $s$ 相交的四条边 $\\ell$ 上的泡利-$\\sigma^x$ 矩阵的乘积。\n-   格子算符 $B_{p} = \\prod_{\\ell \\in p} \\sigma_{\\ell}^{z}$ 是作用在环绕一个格子 $p$ 的四条边 $\\ell$ 上的泡利-$\\sigma^z$ 矩阵的乘积。\n\n推导过程依赖于泡利矩阵的代数性质：\n1.  在同一条边 $\\ell$ 上：对于 $i \\in \\{x, y, z\\}$，有 $(\\sigma_\\ell^i)^2 = \\mathbb{1}$。\n2.  在同一条边 $\\ell$ 上：泡利矩阵反对易，例如 $\\sigma_\\ell^x \\sigma_\\ell^z = -\\sigma_\\ell^z \\sigma_\\ell^x$。\n3.  在不同的边 $\\ell \\neq \\ell'$ 上：泡利矩阵对易，对于任何 $i,j$ 都有 $[\\sigma_\\ell^i, \\sigma_{\\ell'}^j] = 0$。\n\n**步骤1：稳定子的对易关系**\n\n首先，我们证明所有的 $A_s$ 和 $B_p$ 算符相互对易。这意味着哈密顿量中的所有项都对易，因此它们可以被同时对角化。\n\n-   **$[A_s, A_{s'}]=0$**：两个不同的星算符 $A_s$ 和 $A_{s'}$ 分别作用于与顶点 $s$ 和 $s'$ 相交的边集。如果这些边集不相交，则算符显然对易。如果 $s$ 和 $s'$ 相邻，它们恰好共享一条边，记为 $\\ell$。那么 $A_s$ 包含因子 $\\sigma_\\ell^x$，$A_{s'}$ 也包含因子 $\\sigma_\\ell^x$。$A_s$ 和 $A_{s'}$ 中所有其他的泡利矩阵都作用在不同的边上。因为 $\\sigma_\\ell^x$ 与自身对易，且所有其他算符因子作用在不同的自旋上，所以算符 $A_s$ 和 $A_{s'}$ 对易。\n\n-   **$[B_p, B_{p'}]=0$**：类似地，两个不同的格子算符 $B_p$ 和 $B_{p'}$ 分别作用于环绕格子 $p$ 和 $p'$ 的边集。如果它们共享一条边 $\\ell$，则两个算符都包含因子 $\\sigma_\\ell^z$。根据与星算符相同的逻辑，$B_p$ 和 $B_{p'}$ 对易。\n\n-   **$[A_s, B_p]=0$**：一个星算符 $A_s$ 和一个格子算符 $B_p$ 可能共享边。在方格晶格上，如果顶点 $s$ 不是格子 $p$ 的一个角点，则这两个算符作用在不相交的边集上，因而对易。如果 $s$ 是 $p$ 的四个角点之一，那么位于 $s$ 的星算符和格子 $p$ 恰好共享两条边，记为 $\\ell_1$ 和 $\\ell_2$。\n    那么 $A_s$ 包含因子 $\\sigma_{\\ell_1}^x \\sigma_{\\ell_2}^x$，$B_p$ 包含因子 $\\sigma_{\\ell_1}^z \\sigma_{\\ell_2}^z$。\n    我们检查其对易关系：\n    $$A_s B_p = (\\dots \\sigma_{\\ell_1}^x \\sigma_{\\ell_2}^x \\dots)(\\dots \\sigma_{\\ell_1}^z \\sigma_{\\ell_2}^z \\dots)$$\n    $$B_p A_s = (\\dots \\sigma_{\\ell_1}^z \\sigma_{\\ell_2}^z \\dots)(\\dots \\sigma_{\\ell_1}^x \\sigma_{\\ell_2}^x \\dots)$$\n    利用不同位置的泡利矩阵对易这一事实，我们只需对相同位置的矩阵重新排序。\n    $A_s B_p = (\\dots)(\\sigma_{\\ell_1}^x \\sigma_{\\ell_1}^z)(\\sigma_{\\ell_2}^x \\sigma_{\\ell_2}^z)(\\dots)$。\n    $B_p A_s = (\\dots)(\\sigma_{\\ell_1}^z \\sigma_{\\ell_1}^x)(\\sigma_{\\ell_2}^z \\sigma_{\\ell_2}^x)(\\dots)$。\n    由于 $\\sigma^x \\sigma^z = -\\sigma^z \\sigma^x$，我们有 $\\sigma_{\\ell_1}^x \\sigma_{\\ell_1}^z = -\\sigma_{\\ell_1}^z \\sigma_{\\ell_1}^x$ 和 $\\sigma_{\\ell_2}^x \\sigma_{\\ell_2}^z = -\\sigma_{\\ell_2}^z \\sigma_{\\ell_2}^x$。\n    两个符号变化相互抵消：$(-\\mathbb{1}) \\times (-\\mathbb{1}) = +\\mathbb{1}$。因此，$A_s B_p = B_p A_s$，它们相互对易。\n\n由于所有 $\\{A_s\\}$ 和 $\\{B_p\\}$ 算符都对易，它们构成一个对易算符集，被称为稳定子群生成元。另外，注意到 $A_s^2 = \\prod_{\\ell \\in s} (\\sigma_\\ell^x)^2 = \\mathbb{1}$ 且 $B_p^2 = \\prod_{\\ell \\in p} (\\sigma_\\ell^z)^2 = \\mathbb{1}$。这意味着它们的本征值为 $\\pm 1$。\n\n**步骤2：基态与简并度**\n\n哈密顿量 $H$ 的基态必须使能量最小化。由于 $J_e, J_m > 0$ 且各项对易，这可以通过找到所有 $A_s$ 和 $B_p$ 的本征值为 $+1$ 的同时本征态来实现。因此，基态流形由以下稳定子条件定义：\n$$ A_s |\\psi_{GS}\\rangle = +1 |\\psi_{GS}\\rangle \\quad \\forall s $$\n$$ B_p |\\psi_{GS}\\rangle = +1 |\\psi_{GS}\\rangle \\quad \\forall p $$\n\n为了求出该子空间的维度（即基态简并度），我们需要计算自旋的数量和独立的稳定子约束的数量。考虑一个环面上的 $L \\times L$ 晶格。\n-   顶点（星）数：$N_s = L^2$。\n-   格子数：$N_p = L^2$。\n-   边（自旋）数：$N_e = 2L^2$。\n总的希尔伯特空间维度为 $\\dim(\\mathcal{H}) = 2^{N_e} = 2^{2L^2}$。\n\n稳定子生成元的数量为 $N_s + N_p = 2L^2$。然而，由于环面上的两个全局约束，这些生成元并非全部独立：\n1.  所有星算符的乘积：$\\prod_s A_s = \\prod_s (\\prod_{\\ell \\in s} \\sigma_\\ell^x)$。在环面上，每条边 $\\ell$ 都恰好连接两个顶点，所以每个 $\\sigma_\\ell^x$ 算符在乘积中出现两次。由于 $(\\sigma_\\ell^x)^2 = \\mathbb{1}$，整个乘积为单位算符：$\\prod_s A_s = \\mathbb{1}$。\n2.  所有格子算符的乘积：$\\prod_p B_p = \\prod_p (\\prod_{\\ell \\in p} \\sigma_\\ell^z)$。在环面上，每条边 $\\ell$ 都是恰好两个格子的边界。因此，每个 $\\sigma_\\ell^z$ 也出现两次。由于 $(\\sigma_\\ell^z)^2 = \\mathbb{1}$，这个乘积同样是单位算符：$\\prod_p B_p = \\mathbb{1}$。\n\n这两个关系意味着只有 $k = (N_s + N_p) - 2 = 2L^2 - 2$ 个独立的稳定子约束。每个独立的约束都将希尔伯特空间投影到一个维度减半的子空间上。基态子空间的维度，即基态简并度（GSD），为：\n$$ \\text{GSD} = \\frac{\\dim(\\mathcal{H})}{2^k} = \\frac{2^{2L^2}}{2^{2L^2 - 2}} = 2^2 = 4 $$\n基态简并度为 $4$，与环面的大小无关。\n\n**步骤3：元激发（任意子）**\n\n激发是违反一个或多个稳定子条件的状态。一个 $A_s = -1$ 的本征态在顶点 $s$ 处有一个激发，而一个 $B_p = -1$ 的本征态在格子 $p$ 处有一个激发。这些激发由开弦算符成对地产生。\n\n-   **`e`型激发（电荷）：** 考虑一条连接两个顶点 $s_1$ 和 $s_2$ 的边构成的开路径 $\\mathcal{P}$。定义弦算符 $S^z(\\mathcal{P}) = \\prod_{\\ell \\in \\mathcal{P}} \\sigma_\\ell^z$。\n    -   此算符与所有 $B_p$ 对易，因为 $[ \\sigma^z, \\sigma^z ] = 0$。\n    -   对于不在路径 $\\mathcal{P}$ 端点的顶点 $s$，$A_s$ 与 $S^z(\\mathcal{P})$ 对易。如果 $s$ 在路径中间，$A_s$ 与路径共享两条边，导致两次反对易，因此 $[A_s, S^z(\\mathcal{P})]=0$。\n    -   对于路径 $\\mathcal{P}$ 端点处的顶点 $s \\in \\{s_1, s_2\\}$，$A_s$ 与路径恰好共享一条边。这条单独的共享边导致一次反对易：$A_s S^z(\\mathcal{P}) = -S^z(\\mathcal{P}) A_s$。\n    将 $S^z(\\mathcal{P})$ 作用于基态 $|\\psi_{GS}\\rangle$ 会产生一个新态 $|\\psi' \\rangle = S^z(\\mathcal{P}) |\\psi_{GS} \\rangle$。该状态满足 $A_{s_1}|\\psi'\\rangle = -|\\psi'\\rangle$ 和 $A_{s_2}|\\psi'\\rangle = -|\\psi'\\rangle$。因此，$S^z(\\mathcal{P})$ 在端点 $s_1$ 和 $s_2$ 处产生了一对 `e` 型任意子。\n\n-   **`m`型激发（磁通）：** 考虑对偶晶格上的一条开路径 $\\mathcal{P}^*$，它连接两个格子 $p_1$ 和 $p_2$ 的中心。这条路径穿过一系列边。定义弦算符 $S^x(\\mathcal{P}^*) = \\prod_{\\ell \\text{ crossed by } \\mathcal{P}^*} \\sigma_\\ell^x$。\n    -   此算符与所有 $A_s$ 对易。\n    -   对于不在路径 $\\mathcal{P}^*$ 端点的格子 $p$，$B_p$ 与 $S^x(\\mathcal{P}^*)$ 对易。\n    -   对于格子 $p \\in \\{p_1, p_2\\}$，$B_p$ 与弦共享一条边，导致一次反对易：$B_p S^x(\\mathcal{P}^*) = -S^x(\\mathcal{P}^*) B_p$。\n    将 $S^x(\\mathcal{P}^*)$ 作用于基态会产生一对位于格子 $p_1$ 和 $p_2$ 的 `m` 型任意子。\n\n-   **束缚态（`em` 或 $\\psi$ 费米子）：** `e` 型和 `m` 型任意子的束缚态是一种复合粒子，它携带两种类型的荷。它是一种费米子型粒子。一对这样的束缚态可以由一串泡利-$\\sigma^y$ 算符产生。\n    -   考虑沿连接顶点 $s_1$ 和 $s_2$ 的边路径 $\\mathcal{P}$ 的弦算符 $S^y(\\mathcal{P}) = \\prod_{\\ell \\in \\mathcal{P}} \\sigma_\\ell^y$。利用 $\\sigma^y = i \\sigma^x \\sigma^z$，我们可以写出 $S^y(\\mathcal{P}) = (i)^{|\\mathcal{P}|} (\\prod_{\\ell \\in \\mathcal{P}} \\sigma_\\ell^x)(\\prod_{\\ell \\in \\mathcal{P}} \\sigma_\\ell^z)$。\n    -   $\\prod \\sigma^z$ 部分在路径 $\\mathcal{P}$ 两端的顶点 $s_1, s_2$ 处产生 `e` 激发。\n    -   $\\prod \\sigma^x$ 部分在与路径 $\\mathcal{P}$ 的起始边和终止边相邻的格子上产生 `m` 激发。\n    -   因此，算符 $S^y(\\mathcal{P})$ 产生一对复合的 `em` 束缚态，在弦的每一端各有一个。每个端点由顶点上的一个 `e` 荷和相邻格子上的一个 `m` 荷组成。\n\n总而言之，基态简并度为 4。元激发是 `e` 型（顶点）和 `m` 型（格子）任意子，它们分别由 $\\sigma^z$ 和 $\\sigma^x$ 算符构成的弦产生。它们的束缚态是一种费米子，由 $\\sigma^y$ 算符构成的弦产生。", "answer": "$$\n\\boxed{4}\n$$", "id": "3012567"}, {"introduction": "理论的美妙之处在于它能预言可被实验检验的现象。从 $\\mathbb{Z}_2$ 自旋液体模型转向另一类重要的模型——$U(1)$ 库仑相，这个练习 [@problem_id:3012632] 将向你展示理论与实验之间深刻的联系。你将推导在一个有效理论中，如何通过施加一个类似电磁学中高斯定律的“无散度”条件，直接导致了中子散射谱中一种被称为“掐点奇点”（pinch-point singularity）的独特信号，这是库仑自旋液体一个关键的实验指纹。", "problem": "考虑一个处于退禁闭相的三维库仑自旋液体，其在长波长下的行为由一个粗粒化自旋密度场 $\\mathbf{m}(\\mathbf{r})$ 描述，该场满足无散约束 $\\nabla \\cdot \\mathbf{m}(\\mathbf{r}) = 0$。假设 $\\mathbf{m}(\\mathbf{r})$ 的等时涨落由一个高斯、局域的熵自由能泛函控制\n$$\nF[\\mathbf{m}] = \\frac{K}{2} \\int d^{3}r \\, \\mathbf{m}(\\mathbf{r})^{2},\n$$\n其中 $K>0$ 是熵刚度。在一个体积为 $V$、具有周期性边界条件的立方盒子中进行计算，并用单位归一化体积约定定义傅里叶变换为\n$$\nm_{a}(\\mathbf{q}) \\equiv \\frac{1}{\\sqrt{V}} \\int d^{3}r \\, \\exp\\!\\left(- i \\mathbf{q}\\cdot \\mathbf{r}\\right) \\, m_{a}(\\mathbf{r}).\n$$\n令等时自旋结构因子张量为\n$$\nS_{ab}(\\mathbf{q}) \\equiv \\left\\langle m_{a}(\\mathbf{q}) \\, m_{b}(-\\mathbf{q}) \\right\\rangle,\n$$\n其中尖括号表示在温度 $T$ 下，使用玻尔兹曼权重 $\\exp\\!\\left(-F[\\mathbf{m}]/T\\right)$ 进行的热平均，并且严格执行约束 $\\nabla \\cdot \\mathbf{m} = 0$。\n\n仅从这些定义和统计力学的基本原理（能量均分、高斯积分和傅里叶分析）出发，推导在小的非零 $|\\mathbf{q}|$ 下 $S_{ab}(\\mathbf{q})$ 的闭合形式表达式。您的推导应明确说明无散约束如何决定了在倒易空间中产生夹点奇点的角向结构。\n\n将您的最终答案表示为 $S_{ab}(\\mathbf{q})$ 关于 $\\mathbf{q}$、$K$ 和 $T$ 的单个闭合形式解析表达式，该表达式在小的非零 $|\\mathbf{q}|$ 时有效。无需进行数值计算或四舍五入。", "solution": "该问题要求推导三维库仑自旋液体的等时自旋结构因子张量 $S_{ab}(\\mathbf{q})$。推导必须从给定的定义出发，并利用统计力学的基本原理。\n\n系统的状态由一个粗粒化自旋密度场 $\\mathbf{m}(\\mathbf{r})$ 描述。其热力学由熵自由能泛函控制\n$$\nF[\\mathbf{m}] = \\frac{K}{2} \\int d^{3}r \\, |\\mathbf{m}(\\mathbf{r})|^{2},\n$$\n其中 $K > 0$ 是一个熵刚度。系统受到关键的无散约束\n$$\n\\nabla \\cdot \\mathbf{m}(\\mathbf{r}) = 0.\n$$\n待计算的量是自旋结构因子张量，定义为热期望值\n$$\nS_{ab}(\\mathbf{q}) \\equiv \\left\\langle m_{a}(\\mathbf{q}) \\, m_{b}(-\\mathbf{q}) \\right\\rangle,\n$$\n其中热平均是在温度 $T$ 下，由玻尔兹曼因子 $\\exp(-F[\\mathbf{m}]/T)$ 加权的。\n\n首先，我们将自由能泛函用傅里叶模式 $m_a(\\mathbf{q})$ 表示。傅里叶变换定义为 $m_{a}(\\mathbf{q}) = \\frac{1}{\\sqrt{V}} \\int d^{3}r \\, \\exp(- i \\mathbf{q}\\cdot \\mathbf{r}) \\, m_{a}(\\mathbf{r})$。其逆变换为 $m_a(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\sum_{\\mathbf{q}} \\exp(i \\mathbf{q}\\cdot \\mathbf{r}) \\, m_a(\\mathbf{q})$，其中求和遍及体积 $V$ 中周期性边界条件所允许的离散波矢。\n我们对自由能泛函中的积分应用帕塞瓦尔定理：\n$$\n\\int d^{3}r \\, |\\mathbf{m}(\\mathbf{r})|^{2} = \\int d^{3}r \\, m_a(\\mathbf{r}) m_a(\\mathbf{r}) = \\int d^{3}r \\left(\\frac{1}{\\sqrt{V}} \\sum_{\\mathbf{q}} e^{i\\mathbf{q}\\cdot\\mathbf{r}} m_a(\\mathbf{q})\\right) \\left(\\frac{1}{\\sqrt{V}} \\sum_{\\mathbf{q'}} e^{i\\mathbf{q'}\\cdot\\mathbf{r}} m_a(\\mathbf{q'})\\right)\n$$\n$$\n= \\frac{1}{V} \\sum_{\\mathbf{q}, \\mathbf{q'}} m_a(\\mathbf{q}) m_a(\\mathbf{q'}) \\int d^{3}r \\, e^{i(\\mathbf{q}+\\mathbf{q'})\\cdot\\mathbf{r}} = \\sum_{\\mathbf{q}, \\mathbf{q'}} m_a(\\mathbf{q}) m_a(\\mathbf{q'}) \\delta_{\\mathbf{q}+\\mathbf{q'}, \\mathbf{0}} = \\sum_{\\mathbf{q}} m_a(\\mathbf{q}) m_a(-\\mathbf{q}).\n$$\n由于场 $\\mathbf{m}(\\mathbf{r})$ 是实数场，其傅里叶分量必须满足 $m_a(-\\mathbf{q}) = m_a(\\mathbf{q})^*$。因此，该表达式变为 $\\sum_{\\mathbf{q}} |m_a(\\mathbf{q})|^2 = \\sum_{\\mathbf{q}} |\\mathbf{m}(\\mathbf{q})|^2$。于是，傅里叶空间中的自由能为\n$$\nF = \\frac{K}{2} \\sum_{\\mathbf{q}} |\\mathbf{m}(\\mathbf{q})|^{2}.\n$$\n接下来，我们将无散约束转换到傅里叶空间。$\\nabla \\cdot \\mathbf{m}(\\mathbf{r})$ 的傅里叶变换是 $i \\mathbf{q} \\cdot \\mathbf{m}(\\mathbf{q})$。因此，约束 $\\nabla \\cdot \\mathbf{m}(\\mathbf{r}) = 0$ 变为\n$$\n\\mathbf{q} \\cdot \\mathbf{m}(\\mathbf{q}) = 0\n$$\n对所有波矢 $\\mathbf{q}$ 都成立。对于任何非零波矢 $\\mathbf{q}$，该约束意味着向量 $\\mathbf{m}(\\mathbf{q})$ 是严格横向的，即它被限制在垂直于 $\\mathbf{q}$ 的二维平面内。$\\mathbf{m}(\\mathbf{q})$ 的纵向分量被迫为零。\n\n任何物理量 $A$ 的热平均由泛函积分 $\\langle A \\rangle = Z^{-1} \\int \\mathcal{D}[\\mathbf{m}] \\, A \\, \\exp(-F[\\mathbf{m}]/T)$ 给出，其中积分遍及所有满足约束的场构型。由于自由能是二次（高斯）形式，我们可以应用统计力学的能量均分定理。自由能是对应于不同傅里叶模式的独立二次项之和。\n对于一个给定的波矢 $\\mathbf{q} \\neq \\mathbf{0}$ 及其配对波矢 $-\\mathbf{q}$，对自由能的贡献为 $\\frac{K}{2}(|\\mathbf{m}(\\mathbf{q})|^2 + |\\mathbf{m}(-\\mathbf{q})|^2) = K|\\mathbf{m}(\\mathbf{q})|^2$。令 $\\mathbf{m}(\\mathbf{q}) = \\mathbf{u}(\\mathbf{q}) + i \\mathbf{v}(\\mathbf{q})$，其中 $\\mathbf{u}$ 和 $\\mathbf{v}$ 是实向量。实数条件 $\\mathbf{m}(-\\mathbf{q}) = \\mathbf{m}(\\mathbf{q})^*$ 意味着 $\\mathbf{u}(-\\mathbf{q}) = \\mathbf{u}(\\mathbf{q})$ 和 $\\mathbf{v}(-\\mathbf{q}) = -\\mathbf{v}(\\mathbf{q})$。约束 $\\mathbf{q}\\cdot\\mathbf{m}(\\mathbf{q}) = 0$ 意味着 $\\mathbf{q}\\cdot\\mathbf{u}(\\mathbf{q}) = 0$ 和 $\\mathbf{q}\\cdot\\mathbf{v}(\\mathbf{q}) = 0$。来自波矢对 $(\\mathbf{q}, -\\mathbf{q})$ 的自由能贡献是 $K(|\\mathbf{u}(\\mathbf{q})|^2 + |\\mathbf{v}(\\mathbf{q})|^2)$。\n向量 $\\mathbf{u}(\\mathbf{q})$ 和 $\\mathbf{v}(\\mathbf{q})$ 都被限制在垂直于 $\\mathbf{q}$ 的平面内，因此各自有两个独立分量。对于每个独立的实自由度 $x$，能量包含一个 $Kx^2$ 形式的项。根据能量均分定理，该能量的热平均为 $\\langle Kx^2 \\rangle = \\frac{1}{2}T$，这意味着 $\\langle x^2 \\rangle = \\frac{T}{2K}$。\n\n让我们为每个 $\\mathbf{q}$ 选择一个标准正交基：纵向单位向量 $\\hat{\\mathbf{q}} = \\mathbf{q}/|\\mathbf{q}|$ 和两个张成垂直于 $\\mathbf{q}$ 平面的横向单位向量 $\\boldsymbol{\\epsilon}_1(\\mathbf{q})$ 和 $\\boldsymbol{\\epsilon}_2(\\mathbf{q})$。场 $\\mathbf{m}(\\mathbf{q})$ 可以在这个基中展开：\n$$\n\\mathbf{m}(\\mathbf{q}) = m_{T1}(\\mathbf{q}) \\boldsymbol{\\epsilon}_1(\\mathbf{q}) + m_{T2}(\\mathbf{q}) \\boldsymbol{\\epsilon}_2(\\mathbf{q}),\n$$\n其中由于约束，纵向分量为零。系数 $m_{T\\alpha}(\\mathbf{q}) = \\mathbf{m}(\\mathbf{q}) \\cdot \\boldsymbol{\\epsilon}_{\\alpha}(\\mathbf{q})$ 是复标量。\n自由能变为 $F = \\frac{K}{2} \\sum_{\\mathbf{q}} \\left( |m_{T1}(\\mathbf{q})|^2 + |m_{T2}(\\mathbf{q})|^2 \\right)$。\n每个独立横向模式的模平方的热平均为\n$$\n\\langle |m_{T\\alpha}(\\mathbf{q})|^2 \\rangle = \\frac{\\int d m_{T\\alpha} |m_{T\\alpha}|^2 \\exp(-K |m_{T\\alpha}|^2 / T)}{\\int d m_{T\\alpha} \\exp(-K |m_{T\\alpha}|^2 / T)}.\n$$\n积分是在复平面上进行的。计算这些高斯积分得到 $\\langle |m_{T\\alpha}(\\mathbf{q})|^2 \\rangle = T/K$。对应于正交方向 $\\boldsymbol{\\epsilon}_1$ 和 $\\boldsymbol{\\epsilon}_2$ 的模式是独立的，因此 $\\langle m_{T1}(\\mathbf{q}) m_{T2}(-\\mathbf{q}) \\rangle = \\langle m_{T1}(\\mathbf{q}) m_{T2}(\\mathbf{q})^* \\rangle = 0$。\n\n现在我们可以计算结构因子 $S_{ab}(\\mathbf{q})$：\n$$\nS_{ab}(\\mathbf{q}) = \\left\\langle m_a(\\mathbf{q}) m_b(-\\mathbf{q}) \\right\\rangle = \\left\\langle \\left( \\sum_{\\alpha=1}^2 m_{T\\alpha}(\\mathbf{q}) \\epsilon_{\\alpha a}(\\mathbf{q}) \\right) \\left( \\sum_{\\beta=1}^2 m_{T\\beta}(-\\mathbf{q}) \\epsilon_{\\beta b}(-\\mathbf{q}) \\right) \\right\\rangle.\n$$\n选择基矢使得 $\\boldsymbol{\\epsilon}_{\\beta}(-\\mathbf{q}) = \\boldsymbol{\\epsilon}_{\\beta}(\\mathbf{q})$ 并使用 $m_{T\\beta}(-\\mathbf{q}) = m_{T\\beta}(\\mathbf{q})^*$，我们得到\n$$\nS_{ab}(\\mathbf{q}) = \\sum_{\\alpha, \\beta=1}^2 \\epsilon_{\\alpha a}(\\mathbf{q}) \\epsilon_{\\beta b}(\\mathbf{q}) \\langle m_{T\\alpha}(\\mathbf{q}) m_{T\\beta}(\\mathbf{q})^* \\rangle.\n$$\n利用模式的正交性 $\\langle m_{T\\alpha}(\\mathbf{q}) m_{T\\beta}(\\mathbf{q})^* \\rangle = \\delta_{\\alpha\\beta} \\langle |m_{T\\alpha}(\\mathbf{q})|^2 \\rangle = \\delta_{\\alpha\\beta} \\frac{T}{K}$，表达式简化为\n$$\nS_{ab}(\\mathbf{q}) = \\frac{T}{K} \\sum_{\\alpha=1}^2 \\epsilon_{\\alpha a}(\\mathbf{q}) \\epsilon_{\\alpha b}(\\mathbf{q}).\n$$\n求和 $\\sum_{\\alpha=1}^2 \\epsilon_{\\alpha a}(\\mathbf{q}) \\epsilon_{\\alpha b}(\\mathbf{q})$ 是投影到垂直于 $\\mathbf{q}$ 的平面上的投影算符 $P_{ab}^{\\perp}(\\mathbf{q})$。这可以使用标准正交基 $\\{\\hat{\\mathbf{q}}, \\boldsymbol{\\epsilon}_1, \\boldsymbol{\\epsilon}_2\\}$ 的完备性关系以与坐标无关的形式表示：\n$$\n\\delta_{ab} = \\hat{q}_a \\hat{q}_b + \\sum_{\\alpha=1}^2 \\epsilon_{\\alpha a}(\\mathbf{q}) \\epsilon_{\\alpha b}(\\mathbf{q}).\n$$\n因此，该投影算符为 $P_{ab}^{\\perp}(\\mathbf{q}) = \\delta_{ab} - \\hat{q}_a \\hat{q}_b = \\delta_{ab} - \\frac{q_a q_b}{|\\mathbf{q}|^2}$。\n\n这明确地展示了无散约束如何通过消除纵向涨落，导致结构因子成为一个横向投影算符。该投影算符通过项 $\\frac{q_a q_b}{|\\mathbf{q}|^2}$ 对 $\\mathbf{q}$ 方向的依赖性在 $|\\mathbf{q}| \\to 0$ 时是非解析的，这也是在自旋冰和其他库仑相材料的中子散射实验中观察到的“夹点”奇点的数学根源。散射中子的强度与 $\\sum_{ab} (\\delta_{ab}-\\hat{q}_a \\hat{q}_b) S_{ab}(\\mathbf{q})$ 之类的量成正比，这在倒易空间中布拉格峰附近揭示了一个特征性的领结形状，且沿 $\\mathbf{q}$ 方向的强度为零。\n\n代入投影算符的表达式，我们得到结构因子的最终闭合形式表达式：\n$$\nS_{ab}(\\mathbf{q}) = \\frac{T}{K} \\left(\\delta_{ab} - \\frac{q_a q_b}{|\\mathbf{q}|^2}\\right).\n$$", "answer": "$$\n\\boxed{\\frac{T}{K} \\left(\\delta_{ab} - \\frac{q_a q_b}{|\\mathbf{q}|^2}\\right)}\n$$", "id": "3012632"}, {"introduction": "在研究前沿，我们遇到的模型大多不是精确可解的，因此必须依赖数值模拟来识别新奇的量子物态。这个练习 [@problem_id:3012614] 将带你进入计算物理学家的世界，通过分析模拟的数值数据来诊断一个 $\\mathbb{Z}_2$ 量子自旋液体。你将学习如何运用拓扑纠缠熵、基态简并度的标度行为以及系统对穿过圆环的磁通量的响应这三大“铁证”，来从一个普通的绝缘体中明确地识别出一个拓扑有序相，这正是现代凝聚态物理研究的核心实践之一。", "problem": "实现一个完整、可运行的程序，该程序操作化一个受长圆柱几何构型上的密度矩阵重整化群（DMRG）计算启发的协议，用以区分有能隙的 $\\mathbb{Z}_2$ 量子自旋液体和短程有序的平庸有能隙态。该程序使用纠缠熵标度、圆柱体上的拓扑简并以及对磁通穿插的响应。您的程序必须严格依据第一性原理和经过充分检验的事实来执行以下任务。\n\n使用的基本原理：\n- 二分冯·诺依曼纠缠熵定义为 $S = - \\mathrm{Tr}\\, \\rho_A \\ln \\rho_A$，其中 $\\rho_A$ 是子区域 $A$ 的约化密度矩阵。\n- 在有能隙相中，对于大周长 $L_y$，穿过圆柱体上一个切割的纠缠熵遵循面积律 $S(L_y) = \\alpha L_y - \\gamma + o(1)$，其中 $\\alpha$ 是一个非普适常数，$\\gamma$ 是被称为拓扑纠缠熵的次领头常数。对于一个有能隙的 $\\mathbb{Z}_2$ 自旋液体，其总量子维度为 $D=2$，因此 $\\gamma = \\ln D = \\ln 2$。\n- 在一个无限长的圆柱体上，一个有能隙的 $\\mathbb{Z}_2$ 自旋液体表现出拓扑简并，这些简并的扇区之间因穿过圆柱体的不可收缩的 $\\mathbb{Z}_2$ 磁通量（维子）而不同，其能量分裂 $\\Delta E(L_y) \\equiv |E_{\\mathrm{even}}(L_y) - E_{\\mathrm{odd}}(L_y)|$ 会随圆柱周长呈指数衰减，形式为 $\\Delta E(L_y) \\sim e^{-L_y/\\xi}$，其中 $\\xi$ 是某个有限的相关长度。\n- 绝热磁通穿插会改变边界条件。对于圆柱体上的有能隙 $\\mathbb{Z}_2$ 自旋液体，穿插一个角度为 $\\phi = \\pi$（弧度）的磁通量会切换拓扑扇区，交换偶数态和奇数态，其间的误差为指数级小。在磁通穿插下，纠缠熵 $S(L_y)$ 与相同的 $\\gamma$ 保持一致，误差在次领头阶。\n\n程序要求：\n1. 对于每个测试用例，通过最小二乘法将纠缠熵数据 $S(L_y)$ 拟合到线性形式 $S(L_y) \\approx a L_y + b$，并通过 $\\gamma_{\\mathrm{est}} = -b$ 估计 $\\gamma$。此操作必须对 $\\phi = 0$ 和 $\\phi = \\pi$ 分别独立进行。\n2. 对于每个测试用例，计算在 $\\phi = 0$ 时的能量分裂 $\\Delta E(L_y) = |E_{\\mathrm{even}}(L_y) - E_{\\mathrm{odd}}(L_y)|$，并使用对 $\\ln \\Delta E(L_y) = m L_y + c$ 的最小二乘拟合，评估 $\\ln \\Delta E$ 是否随 $L_y$ 线性减小且具有足够负的斜率。\n3. 对于每个测试用例，通过计算定义的平均交换误差来量化磁通穿插扇区切换效应：$$\\varepsilon_{\\mathrm{swap}} = \\frac{1}{N}\\sum_{i=1}^N \\frac{|E_{\\mathrm{even}}^{\\phi=\\pi}(L_{y,i}) - E_{\\mathrm{odd}}^{\\phi=0}(L_{y,i})| + |E_{\\mathrm{odd}}^{\\phi=\\pi}(L_{y,i}) - E_{\\mathrm{even}}^{\\phi=0}(L_{y,i})|}{2},$$ 其中 $N$ 是采样的周长数量。一个有能隙的 $\\mathbb{Z}_2$ 自旋液体的 $\\varepsilon_{\\mathrm{swap}}$ 应该极小。\n4. 分类决策规则：当且仅当以下所有条件同时成立时，将一个测试用例声明为有能隙的 $\\mathbb{Z}_2$ 自旋液体（布尔值 True）：\n   - $|\\gamma_{\\mathrm{est}}^{\\phi=0} - \\ln 2| \\le \\delta_{\\gamma}$ 且 $|\\gamma_{\\mathrm{est}}^{\\phi=\\pi} - \\ln 2| \\le \\delta_{\\gamma}$，容差为 $\\delta_{\\gamma}$，\n   - 拟合 $\\ln \\Delta E(L_y) = m L_y + c$ 中的斜率 $m$ 满足 $m \\le \\kappa$，阈值为足够负的 $\\kappa$，\n   - $\\varepsilon_{\\mathrm{swap}} \\le \\varepsilon_{\\mathrm{tol}}$ 低于一个小容差 $\\varepsilon_{\\mathrm{tol}}$。\n   如果任何条件不满足，则将该情况分类为短程有序（布尔值 False）。\n5. 单位和角度说明：\n   - 能量以 $J$ 为单位提供，在程序中必须作为无量纲数处理。\n   - 周长 $L_y$ 以晶格位点数（无量纲）提供。\n   - 磁通角度 $\\phi$ 以弧度为单位提供。\n6. 输出规格：您的程序应生成单行输出，其中包含所有测试用例的布尔分类结果，形式为一个用方括号括起来的逗号分隔列表（例如，“[True,False,True]”）。\n\n测试套件：\n提供以下四个测试用例，涵盖一个信号干净的有能隙 $\\mathbb{Z}_2$ 自旋液体、一个平庸有能隙短程有序情况、一个小尺寸模糊情况以及一个有有限尺寸修正的 $\\mathbb{Z}_2$ 情况。每个测试用例包括周长 $L_y$ 数组、在 $\\phi=0$ 和 $\\phi=\\pi$ 时的熵 $S(L_y)$，以及在 $\\phi=0$ 和 $\\phi=\\pi$ 时偶数和奇数扇区的能量。\n\n情况1（有能隙的 $\\mathbb{Z}_2$ 自旋液体，干净信号）：\n- $L_y = [6, 8, 10, 12, 14]$\n- $S^{\\phi=0}(L_y) = [1.951853, 2.821853, 3.711853, 4.581853, 5.471853]$\n- $S^{\\phi=\\pi}(L_y) = [1.9531863333, 2.822853, 3.712653, 4.5825196667, 5.4724244]$\n- $E_{\\mathrm{even}}^{\\phi=0}(L_y) = [-1.1995464102335, -1.5997961889801, -1.9999084218056, -2.3999588512648, -2.79998151]$\n- $E_{\\mathrm{odd}}^{\\phi=0}(L_y) = [-1.2004535897665, -1.6002038110199, -2.0000915781944, -2.4000411487352, -2.80001849]$\n- $E_{\\mathrm{even}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{odd}}^{\\phi=0}(L_y)$\n- $E_{\\mathrm{odd}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{even}}^{\\phi=0}(L_y)$\n\n情况2（平庸短程有序有能隙态）：\n- $L_y = [6, 8, 10, 12, 14]$\n- $S^{\\phi=0}(L_y) = [2.72, 3.58, 4.52, 5.38, 6.32]$\n- $S^{\\phi=\\pi}(L_y) = [2.717206, 3.589894, 4.514560, 5.374634, 6.329906]$\n- $E_{\\mathrm{even}}^{\\phi=0}(L_y) = [-1.1975, -1.5975, -1.9975, -2.3975, -2.7975]$\n- $E_{\\mathrm{odd}}^{\\phi=0}(L_y) = [-1.2025, -1.6025, -2.0025, -2.4025, -2.8025]$\n- $E_{\\mathrm{even}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{even}}^{\\phi=0}(L_y)$\n- $E_{\\mathrm{odd}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{odd}}^{\\phi=0}(L_y)$\n\n情况3（小尺寸模糊情况，未通过阈值）：\n- $L_y = [4, 6]$\n- $S^{\\phi=0}(L_y) = [1.2, 2.0333333333]$\n- $S^{\\phi=\\pi}(L_y) = [1.20125, 2.0341666667]$\n- $E_{\\mathrm{even}}^{\\phi=0}(L_y) = [-0.79899452, -1.199176785]$\n- $E_{\\mathrm{odd}}^{\\phi=0}(L_y) = [-0.80100548, -1.200823215]$\n- $E_{\\mathrm{even}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{even}}^{\\phi=0}(L_y)$\n- $E_{\\mathrm{odd}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{odd}}^{\\phi=0}(L_y)$\n\n情况4（有有限尺寸修正的有能隙 $\\mathbb{Z}_2$ 自旋液体）：\n- $L_y = [8, 12, 16, 20]$\n- $S^{\\phi=0}(L_y) = [2.686853, 4.293520, 5.916853, 7.546853]$\n- $S^{\\phi=\\pi}(L_y) = [2.687603, 4.294020, 5.917228, 7.547153]$\n- $E_{\\mathrm{even}}^{\\phi=0}(L_y) = [-1.43930517, -2.159816844, -2.87995156, -3.59998728]$\n- $E_{\\mathrm{odd}}^{\\phi=0}(L_y) = [-1.44069483, -2.160183156, -2.88004844, -3.60001272]$\n- $E_{\\mathrm{even}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{odd}}^{\\phi=0}(L_y)$\n- $E_{\\mathrm{odd}}^{\\phi=\\pi}(L_y) = E_{\\mathrm{even}}^{\\phi=0}(L_y)$\n\n在所有测试用例中统一使用的数值阈值：\n- $\\delta_{\\gamma} = 0.15$\n- $\\kappa = -0.2$\n- $\\varepsilon_{\\mathrm{tol}} = 10^{-6}$\n\n您的程序应生成单行输出，其中包含所有结果，形式为一个用方括号括起来的逗号分隔列表（例如，“[True,False,False,True]”）。", "solution": "问题陈述是有效的。它提出了一个定义明确的计算任务，该任务基于凝聚态物理的既定原理，特别是拓扑物态理论。问题提供了实现一个分类算法所需的所有必要数据、定义和客观标准，以识别有能隙的 $\\mathbb{Z}_2$ 量子自旋液体。所提供的测试用例是完整的，并且与理论框架一致。我们将继续提供一个解决方案。\n\n用于区分有能隙的 $\\mathbb{Z}_2$ 量子自旋液体与平庸的短程有序（SRO）绝缘体的协议，依赖于通过数值模拟（如在长圆柱体上进行的密度矩阵重整化群（DMRG））可获得的三个关键特征。\n\n1.  **拓扑纠缠熵 ($\\gamma$)**: 对于有能隙相中的系统的二分切割，纠缠熵 $S$ 预期遵循“面积律”。对于一个周长为 $L_y$ 的圆柱体被切成两个半无限长的部分，该定律的形式为：\n    $$S(L_y) = \\alpha L_y - \\gamma + o(1)$$\n    这里，$\\alpha$ 是一个非普适、依赖于模型的常数，与边界的“面积”（即周长 $L_y$）成正比，而 $\\gamma$ 是一个普适的次领头常数，称为拓扑纠缠熵。对于一个拓扑有序相，$\\gamma = \\ln D$，其中 $D = \\sqrt{\\sum_a d_a^2}$ 是任意子激发的总量子维度，$d_a$ 是任意子类型 $a$ 的量子维度。对于 $\\mathbb{Z}_2$ 自旋液体，其任意子包括平庸粒子 ($1$)、电荷 ($e$)、磁通量 ($m$) 以及它们的复合费米子 ($\\psi=e \\otimes m$)。所有非平庸任意子的量子维度均为 $d_a=1$。总量子维度是 $D = \\sqrt{1^2 + 1^2 + 1^2 + 1^2} = \\sqrt{4} = 2$。因此，$\\mathbb{Z}_2$ 拓扑相的一个标志是其拓扑纠缠熵为 $\\gamma = \\ln 2$。一个平庸的短程有序（SRO）相没有拓扑序，对应于 $D=1$，因此 $\\gamma=0$。我们可以通过将 $S(L_y)$ 对 $L_y$ 的数值数据拟合到线性函数 $a L_y + b$ 来估计 $\\gamma$。估计的拓扑熵即为 $\\gamma_{\\mathrm{est}} = -b$。这必须成立，无论基态属于哪个拓扑扇区，因此我们对穿过圆柱体的零磁通（$\\phi=0$）和 $\\pi$ 磁通（$\\phi=\\pi$）生成的数据都进行验证。\n\n2.  **拓扑基态简并**: 在一个具有非平庸拓扑的流形上，例如一个无限长的圆柱体，拓扑有序相拥有一个取决于该拓扑的基态简并。对于圆柱体上的 $\\mathbb{Z}_2$ 自旋液体，存在两个简并的基态。这些态可以通过环绕圆柱周长的不可收缩弦算符环路的磁通量来区分。一个态处于“偶数”扇区（无维子磁通），另一个处于“奇数”扇区（有一个 $\\mathbb{Z}_2$ 维子磁通）。对于有限周长 $L_y$，这种简并会被解除，但能量分裂 $\\Delta E(L_y) = |E_{\\mathrm{even}}(L_y) - E_{\\mathrm{odd}}(L_y)|$ 预期会随周长指数衰减：\n    $$\\Delta E(L_y) \\sim e^{-L_y/\\xi}$$\n    其中 $\\xi$ 是系统的相关长度。这意味着能量分裂的自然对数 $\\ln(\\Delta E)$ 应该随 $L_y$ 线性减小：\n    $$\\ln(\\Delta E(L_y)) = m L_y + c$$\n    斜率为负值 $m = -1/\\xi$。一个平庸的短程有序（SRO）态在任何流形上都有唯一的有能隙基态，因此最低“偶数”和“奇数”态之间的任何分裂都不会表现出这种系统的指数衰减，并且通常会大得多或行为不规律。\n\n3.  **磁通穿插与扇区切换**: 通过圆柱体的孔绝热地插入一个磁通量子是一种强大的探测手段。对于 $\\mathbb{Z}_2$ 自旋液体，穿插一个 $\\phi=\\pi$ 的磁通量（半个磁通量子，对应维子激发）的作用相当于一个在拓扑扇区之间切换的算符。这意味着在零磁通下的偶数扇区基态 $E_{\\mathrm{even}}^{\\phi=0}$，在 $\\pi$ 磁通下会变成奇数扇区的基态 $E_{\\mathrm{odd}}^{\\phi=\\pi}$，反之亦然，其间的差异为指数级小的有限尺寸修正。即，$E_{\\mathrm{even}}^{\\phi=0} \\approx E_{\\mathrm{odd}}^{\\phi=\\pi}$ 且 $E_{\\mathrm{odd}}^{\\phi=0} \\approx E_{\\mathrm{even}}^{\\phi=\\pi}$。在一个平庸的短程有序（SRO）相中，磁通插入不会引起这样的扇区交换；基态仍然是基态（$E_{\\mathrm{even}}^{\\phi=0} \\approx E_{\\mathrm{even}}^{\\phi=\\pi}$）。我们通过平均交换误差 $\\varepsilon_{\\mathrm{swap}}$ 来量化这种交换行为，其定义为：\n    $$\\varepsilon_{\\mathrm{swap}} = \\frac{1}{N}\\sum_{i=1}^N \\frac{|E_{\\mathrm{even}}^{\\phi=\\pi}(L_{y,i}) - E_{\\mathrm{odd}}^{\\phi=0}(L_{y,i})| + |E_{\\mathrm{odd}}^{\\phi=\\pi}(L_{y,i}) - E_{\\mathrm{even}}^{\\phi=0}(L_{y,i})|}{2}$$\n    对于 $\\mathbb{Z}_2$ 自旋液体，$\\varepsilon_{\\mathrm{swap}}$ 应该接近于零，而对于平庸相，它将是显著的。\n\n**算法实现与决策规则**\n\n所提供的程序为每个测试用例实现了这三个检查。\n首先，对于要求（1），我们使用线性最小二乘回归来拟合提供的熵数据 $S(L_y)$ 与 $L_y$，模型为 $S(L_y) = a L_y + b$。此操作分别对 $\\phi=0$ 和 $\\phi=\\pi$ 的数据集进行。截距的负值 $-b$ 给出估计值 $\\gamma_{\\mathrm{est}}^{\\phi=0}$ 和 $\\gamma_{\\mathrm{est}}^{\\phi=\\pi}$。\n其次，对于要求（2），我们计算在 $\\phi=0$ 时每个 $L_y$ 的能量分裂 $\\Delta E(L_y)$，然后取其自然对数。接着我们对 $\\ln(\\Delta E(L_y))$ 与 $L_y$ 进行另一次线性最小二乘回归，以求得斜率 $m$。\n第三，对于要求（3），我们通过直接将其定义应用于能量数据来计算平均交换误差 $\\varepsilon_{\\mathrm{swap}}$。\n最后，当且仅当以下所有条件使用提供的阈值 $\\delta_{\\gamma} = 0.15$、$\\kappa = -0.2$ 和 $\\varepsilon_{\\mathrm{tol}} = 10^{-6}$ 同时满足时，一个测试用例被分类为有能隙的 $\\mathbb{Z}_2$ 自旋液体（True）：\n-   $|\\gamma_{\\mathrm{est}}^{\\phi=0} - \\ln 2| \\le \\delta_{\\gamma}$\n-   $|\\gamma_{\\mathrm{est}}^{\\phi=\\pi} - \\ln 2| \\le \\delta_{\\gamma}$\n-   $m \\le \\kappa$\n-   $\\varepsilon_{\\mathrm{swap}} \\le \\varepsilon_{\\mathrm{tol}}$\n如果任何条件不满足，该状态则被分类为平庸的短程有序相（False）。\n该实现使用 `numpy` 库进行数值数组操作、数学运算，并利用其 `polyfit` 函数执行线性回归。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes simulated data from DMRG-like computations to classify\n    quantum states as gapped Z2 spin liquids or trivial short-range ordered phases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        { # Case 1: Gapped Z2 spin liquid, clean\n            \"Ly\": np.array([6, 8, 10, 12, 14]),\n            \"S_phi0\": np.array([1.951853, 2.821853, 3.711853, 4.581853, 5.471853]),\n            \"S_phipi\": np.array([1.9531863333, 2.822853, 3.712653, 4.5825196667, 5.4724244]),\n            \"E_even_phi0\": np.array([-1.1995464102335, -1.5997961889801, -1.9999084218056, -2.3999588512648, -2.79998151]),\n            \"E_odd_phi0\": np.array([-1.2004535897665, -1.6002038110199, -2.0000915781944, -2.4000411487352, -2.80001849]),\n            \"E_even_phipi\": np.array([-1.2004535897665, -1.6002038110199, -2.0000915781944, -2.4000411487352, -2.80001849]),\n            \"E_odd_phipi\": np.array([-1.1995464102335, -1.5997961889801, -1.9999084218056, -2.3999588512648, -2.79998151]),\n        },\n        { # Case 2: Trivial short-range ordered gapped\n            \"Ly\": np.array([6, 8, 10, 12, 14]),\n            \"S_phi0\": np.array([2.72, 3.58, 4.52, 5.38, 6.32]),\n            \"S_phipi\": np.array([2.717206, 3.589894, 4.514560, 5.374634, 6.329906]),\n            \"E_even_phi0\": np.array([-1.1975, -1.5975, -1.9975, -2.3975, -2.7975]),\n            \"E_odd_phi0\": np.array([-1.2025, -1.6025, -2.0025, -2.4025, -2.8025]),\n            \"E_even_phipi\": np.array([-1.1975, -1.5975, -1.9975, -2.3975, -2.7975]),\n            \"E_odd_phipi\": np.array([-1.2025, -1.6025, -2.0025, -2.4025, -2.8025]),\n        },\n        { # Case 3: Ambiguous small-size, fails thresholds\n            \"Ly\": np.array([4, 6]),\n            \"S_phi0\": np.array([1.2, 2.0333333333]),\n            \"S_phipi\": np.array([1.20125, 2.0341666667]),\n            \"E_even_phi0\": np.array([-0.79899452, -1.199176785]),\n            \"E_odd_phi0\": np.array([-0.80100548, -1.200823215]),\n            \"E_even_phipi\": np.array([-0.79899452, -1.199176785]),\n            \"E_odd_phipi\": np.array([-0.80100548, -1.200823215]),\n        },\n        { # Case 4: Gapped Z2 spin liquid with finite-size corrections\n            \"Ly\": np.array([8, 12, 16, 20]),\n            \"S_phi0\": np.array([2.686853, 4.293520, 5.916853, 7.546853]),\n            \"S_phipi\": np.array([2.687603, 4.294020, 5.917228, 7.547153]),\n            \"E_even_phi0\": np.array([-1.43930517, -2.159816844, -2.87995156, -3.59998728]),\n            \"E_odd_phi0\": np.array([-1.44069483, -2.160183156, -2.88004844, -3.60001272]),\n            \"E_even_phipi\": np.array([-1.44069483, -2.160183156, -2.88004844, -3.60001272]),\n            \"E_odd_phipi\": np.array([-1.43930517, -2.159816844, -2.87995156, -3.59998728]),\n        }\n    ]\n    \n    # Numerical thresholds and constants\n    delta_gamma = 0.15\n    kappa = -0.2\n    epsilon_tol = 1e-6\n    ln2 = np.log(2)\n\n    results = []\n    \n    for case in test_cases:\n        Ly = case[\"Ly\"]\n        \n        # 1. Fit entanglement entropy S(Ly) = a*Ly + b and estimate gamma = -b\n        # For phi = 0\n        coeffs_phi0 = np.polyfit(Ly, case[\"S_phi0\"], 1)\n        gamma_est_phi0 = -coeffs_phi0[1]\n        \n        # For phi = pi\n        coeffs_phipi = np.polyfit(Ly, case[\"S_phipi\"], 1)\n        gamma_est_phipi = -coeffs_phipi[1]\n\n        # 2. Compute energy splitting and fit ln(DeltaE) = m*Ly + c\n        delta_E = np.abs(case[\"E_even_phi0\"] - case[\"E_odd_phi0\"])\n        # Ensure delta_E is positive to avoid log(0) or log(negative) issues\n        if np.any(delta_E <= 0):\n             m = 0 # If any splitting is zero or negative, decay condition fails\n        else:\n            log_delta_E = np.log(delta_E)\n            # A linear fit requires at least 2 points\n            if len(Ly) >= 2:\n                coeffs_E = np.polyfit(Ly, log_delta_E, 1)\n                m = coeffs_E[0]\n            else:\n                m = 0 # Slope is undefined for a single point; condition fails\n\n        # 3. Compute mean swap error\n        err_term1 = np.abs(case[\"E_even_phipi\"] - case[\"E_odd_phi0\"])\n        err_term2 = np.abs(case[\"E_odd_phipi\"] - case[\"E_even_phi0\"])\n        epsilon_swap = np.mean((err_term1 + err_term2) / 2)\n        \n        # 4. Decision rule for classification\n        cond1 = np.abs(gamma_est_phi0 - ln2) <= delta_gamma\n        cond2 = np.abs(gamma_est_phipi - ln2) <= delta_gamma\n        cond3 = m <= kappa\n        cond4 = epsilon_swap <= epsilon_tol\n        \n        is_z2_spin_liquid = all([cond1, cond2, cond3, cond4])\n        results.append(is_z2_spin_liquid)\n\n    # Final print statement in the exact required format.\n    # The expected output is [True,False,False,True].\n    formatted_results = [str(r).capitalize() for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3012614"}]}