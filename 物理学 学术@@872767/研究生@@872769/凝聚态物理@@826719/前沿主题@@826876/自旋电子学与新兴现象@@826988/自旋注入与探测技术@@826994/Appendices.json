{"hands_on_practices": [{"introduction": "自旋扩散长度是自旋电子学中的一个核心参数，它决定了自旋信息在非磁性材料中能够传输的典型距离。本练习将通过从基本的自旋连续性方程和菲克定律出发，推导和计算这个关键长度，从而帮助你深入理解自旋在扩散过程中的衰减机制。掌握这一基础模型是分析更复杂自旋输运现象的起点。[@problem_id:3017005]", "problem": "一个准一维扩散通道被用于非局域自旋注入和检测。在 $x=0$ 处产生自旋积累，其特征是自旋向上和自旋向下布居之间的自旋电化学势差 $\\mu_{s}(x)$，并使其在稳态条件下沿 $x>0$ 扩散。假设以下基本出发点：(i) 自旋密度 $n_{s}(x,t)$ 的自旋连续性方程为 $\\partial n_{s}/\\partial t + \\nabla \\cdot \\mathbf{j}_{s} = - n_{s}/\\tau_{s}$，其中 $\\tau_{s}$ 是自旋弛豫时间；(ii) 菲克定律适用于自旋流密度，$\\mathbf{j}_{s} = - D \\nabla n_{s}$，其中 $D$ 是自旋扩散常数。在线性响应区，设 $n_{s}(x)$ 通过一个恒定的自旋可压缩性与 $\\mu_{s}(x)$ 成正比，因此 $\\mu_{s}(x)$ 的空间分布遵循与 $n_{s}(x)$ 相同的微分方程，仅相差一个比例常数。\n\n从此基础出发，推导控制 $x>0$ 时 $\\mu_{s}(x)$ 的稳态一维微分方程，并证明其解是一个指数衰减，其特征长度标度 $l_{s}$ 被称为自旋扩散长度。然后，给定 $D = 0.01\\,\\mathrm{m}^{2}/\\mathrm{s}$ 和 $\\tau_{s} = 100\\,\\mathrm{ps}$，计算：\n- 自旋扩散长度 $l_{s}$，以米为单位表示，以及\n- 在距离 $L = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ 上 $\\mu_{s}(x)$ 的分数衰减因子 $f$，定义为 $f = \\mu_{s}(L)/\\mu_{s}(0)$，以无量纲小数表示。\n\n将 $l_{s}$ 四舍五入到四位有效数字并使用科学记数法表示，将 $f$ 四舍五入到五位有效数字。以包含 $l_{s}$ 和 $f$（按此顺序）的行矩阵形式提供最终答案。", "solution": "在稳态条件下，自旋连续性方程简化为\n$$\n\\nabla \\cdot \\mathbf{j}_{s} = - \\frac{n_{s}}{\\tau_{s}}.\n$$\n使用菲克自旋扩散定律，\n$$\n\\mathbf{j}_{s} = - D \\nabla n_{s},\n$$\n我们得到\n$$\n\\nabla \\cdot \\left( - D \\nabla n_{s} \\right) = - \\frac{n_{s}}{\\tau_{s}} \\quad \\Rightarrow \\quad D \\nabla^{2} n_{s} = \\frac{n_{s}}{\\tau_{s}}.\n$$\n在一维空间中，\n$$\nD \\frac{d^{2} n_{s}}{dx^{2}} = \\frac{n_{s}}{\\tau_{s}}.\n$$\n在扩散输运的线性响应区，自旋密度 $n_{s}(x)$ 通过一个常数因子（自旋可压缩性）与自旋电化学势 $\\mu_{s}(x)$ 成正比，因此 $\\mu_{s}(x)$ 遵循相同的空间微分方程：\n$$\nD \\frac{d^{2} \\mu_{s}}{dx^{2}} = \\frac{\\mu_{s}}{\\tau_{s}}.\n$$\n这是一个齐次二阶线性微分方程。寻求形式为 $\\mu_{s}(x) = \\mu_{0} \\exp(\\kappa x)$ 的解，可得到特征方程\n$$\nD \\kappa^{2} = \\frac{1}{\\tau_{s}} \\quad \\Rightarrow \\quad \\kappa = \\pm \\frac{1}{\\sqrt{D \\tau_{s}}}.\n$$\n对于 $x>0$ 且在 $x=0$ 处有一个局域源，随距离衰减的物理上可接受的解是\n$$\n\\mu_{s}(x) = \\mu_{s}(0) \\exp\\!\\left( - \\frac{x}{l_{s}} \\right),\n$$\n其中自旋扩散长度 $l_{s}$ 定义为\n$$\nl_{s} = \\sqrt{D \\tau_{s}}.\n$$\n\n我们现在为给定参数计算 $l_{s}$ 和分数衰减因子 $f = \\mu_{s}(L)/\\mu_{s}(0)$。在最后一步之前，所有量都保持符号形式。\n\n首先，自旋扩散长度：\n$$\nl_{s} = \\sqrt{D \\tau_{s}}.\n$$\n在距离 $L$ 上的分数衰减因子是：\n$$\nf = \\frac{\\mu_{s}(L)}{\\mu_{s}(0)} = \\exp\\!\\left( - \\frac{L}{l_{s}} \\right) = \\exp\\!\\left( - \\frac{L}{\\sqrt{D \\tau_{s}}} \\right).\n$$\n\n代入给定值。将自旋弛豫时间转换为秒：\n$$\n\\tau_{s} = 100\\,\\mathrm{ps} = 100 \\times 10^{-12}\\,\\mathrm{s} = 1.0 \\times 10^{-10}\\,\\mathrm{s}.\n$$\n扩散常数是\n$$\nD = 0.01\\,\\mathrm{m}^{2}/\\mathrm{s} = 1.0 \\times 10^{-2}\\,\\mathrm{m}^{2}/\\mathrm{s}.\n$$\n因此，\n$$\nl_{s} = \\sqrt{(1.0 \\times 10^{-2}) \\times (1.0 \\times 10^{-10})}\\,\\mathrm{m} = \\sqrt{1.0 \\times 10^{-12}}\\,\\mathrm{m} = 1.0 \\times 10^{-6}\\,\\mathrm{m}.\n$$\n四舍五入到四位有效数字并用科学记数法表示，结果是\n$$\nl_{s} = 1.000 \\times 10^{-6}\\,\\mathrm{m}.\n$$\n\n对于 $L = 1.0 \\times 10^{-6}\\,\\mathrm{m}$ 的衰减因子，\n$$\n\\frac{L}{l_{s}} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-6}} = 1,\n$$\n所以\n$$\nf = \\exp(-1).\n$$\n数值上，四舍五入到五位有效数字，\n$$\nf = 0.36788.\n$$\n\n因此，所要求的输出是 $l_{s}$（单位为米）和无量纲的分数衰减因子 $f$，以行矩阵 $(l_{s}, f)$ 的顺序呈现。", "answer": "$$\\boxed{\\begin{pmatrix}1.000 \\times 10^{-6} & 0.36788\\end{pmatrix}}$$", "id": "3017005"}, {"introduction": "在理解了自旋扩散的基本物理后，一个自然的问题是如何实验性地探测自旋流。本练习聚焦于一种关键的电学探测技术——逆自旋霍尔效应（ISHE），它能将纯自旋流转化为可测量的电压。通过求解真实器件几何结构中的自旋扩散方程并应用ISHE的原理，你将学会如何将理论模型与宏观可测量的实验信号联系起来。[@problem_id:3017027]", "problem": "一个铁磁体/铂双层膜在铁磁共振下被驱动，将自旋流泵浦到铂（Pt）薄膜中。考虑一个铂条带，其厚度为 $t$（沿 $\\hat{z}$ 方向），长度为 $L$（沿 $\\hat{y}$ 方向，即测量逆自旋霍尔电场的方向），宽度为 $W$（沿 $\\hat{x}$ 方向）。该铂的电阻率为 $\\rho$，自旋霍尔角为 $\\theta_{\\mathrm{SH}}$，自旋扩散长度为 $l_s$。自旋流在 $z=0$ 的界面处从铁磁体注入铂中，沿 $+\\hat{z}$ 方向流动，并沿 $\\hat{x}$ 方向极化；位于 $z = t$ 的铂外表面是自旋绝缘的（在 $z=t$ 处没有自旋流流出）。样品沿 $\\hat{y}$ 方向开路，因此没有净电荷流可以沿条带流动；从而沿 $\\hat{y}$ 方向产生稳态逆自旋霍尔电场，并在条带两端之间产生可测量的电压。\n\n从铂中的一维自旋扩散框架和逆自旋霍尔效应的定义出发，推导条带两端（间距为 $L$）之间的开路逆自旋霍尔电压 $V_{\\mathrm{ISHE}}$ 的表达式，该表达式用 $z=0$ 处的界面泵浦自旋流密度大小 $J_s^0$（以角动量单位定义）以及材料和几何参数 $\\{\\theta_{\\mathrm{SH}}, \\rho, t, l_s, L\\}$ 来表示。然后，使用以下参数对电压进行数值计算：\n- $\\theta_{\\mathrm{SH}} = 0.080$\n- $\\rho = 3.5 \\times 10^{-7}\\ \\Omega\\,\\mathrm{m}$\n- $t = 6.0 \\times 10^{-9}\\ \\mathrm{m}$\n- $l_s = 1.5 \\times 10^{-9}\\ \\mathrm{m}$\n- $L = 1.00 \\times 10^{-3}\\ \\mathrm{m}$\n- 转换后的界面自旋流密度 $(2e/\\hbar)\\,J_s^0 = 8.0 \\times 10^{7}\\ \\mathrm{A/m}^2$\n\n假设铂中的电导率是各向同性的，并忽略任何界面自旋记忆损耗。请将 $V_{\\mathrm{ISHE}}$ 的最终数值答案以毫伏表示，并四舍五入到三位有效数字。仅提供最终数值作为您的答案。", "solution": "合适的出发点是正常金属（Pt）中的一维稳态自旋扩散，由自旋积累 $\\mu_s(z)$ 描述，其遵循\n$$\n\\frac{d^2 \\mu_s}{dz^2} = \\frac{\\mu_s}{l_s^2},\n$$\n以及自旋流密度 $J_s(z)$（沿 $\\hat{z}$ 方向流动，沿 $\\hat{x}$ 方向极化）与自旋积累梯度之间的本构关系，\n$$\nJ_s(z) = -\\frac{\\sigma}{2e}\\,\\frac{d \\mu_s}{dz},\n$$\n其中 $\\sigma = 1/\\rho$ 是铂的电导率， $e$ 是元电荷。边界条件是铁磁体/铂界面处的自旋流固定为泵浦值，\n$$\nJ_s(0) = J_s^0,\n$$\n并且 $z=t$ 处的铂自由表面是自旋绝缘的，\n$$\nJ_s(t) = 0.\n$$\n\n求解 $\\mu_s(z)$ 的微分方程得到通解形式 $\\mu_s(z) = A \\sinh(z/l_s) + B \\cosh(z/l_s)$。使用 $J_s(z) = -(\\sigma/2e)\\, d\\mu_s/dz$ 并应用 $J_s(t)=0$ 和 $J_s(0)=J_s^0$ 来确定常数 $A$ 和 $B$，由此可得到铂中自旋流的空间分布，\n$$\nJ_s(z) = J_s^0\\,\\frac{\\sinh\\!\\big((t-z)/l_s\\big)}{\\sinh\\!\\big(t/l_s\\big)}.\n$$\n该分布满足 $J_s(0)=J_s^0$ 和 $J_s(t)=0$，是自旋绝缘外边界条件下标准的一维自旋扩散结果。\n\n逆自旋霍尔效应根据下式将自旋流密度转换为横向电荷流密度\n$$\n\\mathbf{j}_c^{\\mathrm{ISHE}}(z) = \\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,\\mathbf{J}_s(z)\\times \\hat{\\mathbf{s}},\n$$\n其中 $\\hat{\\mathbf{s}}$ 是自旋极化的单位矢量。对于我们的几何结构，$\\mathbf{J}_s \\parallel \\hat{z}$ 且 $\\hat{\\mathbf{s}} \\parallel \\hat{x}$，因此 $\\mathbf{j}_c^{\\mathrm{ISHE}}(z)$ 指向 $\\hat{y}$ 方向，其大小为\n$$\nj_c^{\\mathrm{ISHE}}(z) = \\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s(z).\n$$\n\n在沿 $\\hat{y}$ 方向的开路条件下，没有净电荷流可以流过条带。局部地，根据欧姆定律，传导电流密度为 $j_{\\mathrm{cond}}(z) = \\sigma E_y$，对于均匀的 $\\sigma$，该值与 $z$ 无关。开路条件是穿过厚度的总电流为零：\n$$\n\\int_{0}^{t}\\!\\big[j_{\\mathrm{cond}}(z) + j_c^{\\mathrm{ISHE}}(z)\\big]\\,dz \\;=\\; 0\n\\;\\;\\Rightarrow\\;\\;\n\\sigma t\\,E_y + \\int_{0}^{t}\\! j_c^{\\mathrm{ISHE}}(z)\\,dz \\;=\\; 0.\n$$\n因此，稳态电场为\n$$\nE_y \\;=\\; -\\frac{1}{\\sigma t}\\,\\int_{0}^{t}\\! j_c^{\\mathrm{ISHE}}(z)\\,dz\n\\;=\\; -\\rho\\,\\frac{1}{t}\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,\\int_{0}^{t}\\! J_s(z)\\,dz.\n$$\n使用 $J_s(z)$ 的分布，\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0 \\int_{0}^{t} \\frac{\\sinh\\!\\big((t-z)/l_s\\big)}{\\sinh\\!\\big(t/l_s\\big)}\\,dz.\n$$\n进行换元，$u = (t-z)/l_s$，则 $dz = -l_s\\,du$，$z=0 \\Rightarrow u = t/l_s$，$z=t \\Rightarrow u=0$。那么\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0\\, l_s \\int_{0}^{t/l_s} \\frac{\\sinh u}{\\sinh\\!\\big(t/l_s\\big)}\\,du\n\\;=\\; J_s^0\\, l_s\\,\\frac{\\cosh\\!\\big(t/l_s\\big) - 1}{\\sinh\\!\\big(t/l_s\\big)}.\n$$\n使用恒等式 $(\\cosh T - 1)/\\sinh T = \\tanh(T/2)$，其中 $T = t/l_s$，我们得到\n$$\n\\int_{0}^{t}\\! J_s(z)\\,dz \\;=\\; J_s^0\\, l_s\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big).\n$$\n因此，开路电场的大小为\n$$\n|E_y| \\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s^0\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big).\n$$\n条带两端（间距为 $L$）之间的逆自旋霍尔电压则为\n$$\nV_{\\mathrm{ISHE}} \\;=\\; |E_y|\\,L\n\\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,\\frac{2e}{\\hbar}\\,J_s^0\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\\,L.\n$$\n\n这就是用 $\\{\\theta_{\\mathrm{SH}}, \\rho, t, l_s, L, J_s^0\\}$ 表示的目标表达式。为进行数值计算，使用给定的转换后的界面自旋流密度 $(2e/\\hbar)\\,J_s^0$ 会很方便。记 $J_s^{(\\mathrm{c})} \\equiv (2e/\\hbar)\\,J_s^0$，我们重写为\n$$\nV_{\\mathrm{ISHE}} \\;=\\; \\rho\\,\\theta_{\\mathrm{SH}}\\,J_s^{(\\mathrm{c})}\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\\,L.\n$$\n\n代入数值：\n- $\\theta_{\\mathrm{SH}} = 0.080$,\n- $\\rho = 3.5 \\times 10^{-7}\\ \\Omega\\,\\mathrm{m}$,\n- $t = 6.0 \\times 10^{-9}\\ \\mathrm{m}$,\n- $l_s = 1.5 \\times 10^{-9}\\ \\mathrm{m}$,\n- $L = 1.00 \\times 10^{-3}\\ \\mathrm{m}$,\n- $J_s^{(\\mathrm{c})} = 8.0 \\times 10^{7}\\ \\mathrm{A/m}^2$.\n\n计算无量纲因子\n$$\n\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\n\\;=\\; \\frac{1.5 \\times 10^{-9}}{6.0 \\times 10^{-9}}\\,\\tanh\\!\\Big(\\frac{6.0 \\times 10^{-9}}{2 \\times 1.5 \\times 10^{-9}}\\Big)\n\\;=\\; 0.25 \\times \\tanh(2.0).\n$$\n使用 $\\tanh(2.0) \\approx 0.96402758$，该因子为\n$$\n0.25 \\times 0.96402758 \\approx 0.241006895.\n$$\n现在，穿过厚度的平均逆自旋霍尔电荷流密度是\n$$\n\\langle j_c^{\\mathrm{ISHE}} \\rangle \\;=\\; \\theta_{\\mathrm{SH}}\\,J_s^{(\\mathrm{c})}\\,\\frac{l_s}{t}\\,\\tanh\\!\\Big(\\frac{t}{2l_s}\\Big)\n\\;\\approx\\; 0.080 \\times (8.0 \\times 10^{7}) \\times 0.241006895\n\\;\\approx\\; 1.54244413 \\times 10^{6}\\ \\mathrm{A/m}^2.\n$$\n开路电场为 $E_y = \\rho \\langle j_c^{\\mathrm{ISHE}} \\rangle$，得到\n$$\nE_y \\;\\approx\\; (3.5 \\times 10^{-7}) \\times (1.54244413 \\times 10^{6})\\ \\mathrm{V/m}\n\\;\\approx\\; 0.539855445\\ \\mathrm{V/m}.\n$$\n最后，\n$$\nV_{\\mathrm{ISHE}} \\;=\\; E_y\\,L \\;\\approx\\; 0.539855445 \\times (1.00 \\times 10^{-3})\\ \\mathrm{V}\n\\;\\approx\\; 5.39855445 \\times 10^{-4}\\ \\mathrm{V}.\n$$\n转换为毫伏：$5.39855445 \\times 10^{-4}\\ \\mathrm{V} \\equiv 0.539855445\\ \\mathrm{mV}$。四舍五入到三位有效数字得到 $0.540\\ \\mathrm{mV}$。", "answer": "$$\\boxed{0.540}$$", "id": "3017027"}, {"introduction": "除了电学方法，利用超导体的独特性质也是一种强大的自旋探测手段。本练习将引导你通过编写程序来模拟经典的Meservey-Tedrow实验，其中超导体的塞曼分裂态密度被用作自旋分析器。你不仅需要从第一性原理构建隧道电导的物理模型，还要设计算法从模拟数据中提取铁磁体的自旋极化率，这能极大地锻炼你在现代物理研究中至关重要的计算建模与数据分析能力。[@problem_id:3017039]", "problem": "您需要设计并实现一个完整的、可运行的程序，用于模拟在有限磁场下通过铁磁体-绝缘体-超导体结的自旋极化隧穿电导，并从偏压不对称性中提取铁磁体的自旋极化率。其背景是凝聚态物理中的 Meservey–Tedrow 自旋极化隧穿技术，该技术利用薄超导膜的准粒子态密度的塞曼分裂来实现对隧穿载流子的自旋选择性探测。\n\n从适用于自旋注入和探测技术的有效基本原理出发：\n- 使用费米黄金定则来证明隧穿电流正比于自旋分辨态密度与占据因子乘积的能量积分。微分电导通过对电流求关于电压的导数得到。\n- 使用巴丁-库珀-施里弗（BCS）准粒子态密度作为超导体的能量依赖谱函数。BCS 态密度在能隙附近有尖锐的峰值，是文献中经过充分检验的公式。一个小的 Dynes 展宽可以稳定数值计算。\n- 使用磁场下自旋能级的塞曼分裂：自旋向上和自旋向下的准粒子能量分别移动 $\\pm \\Delta_{Z}/2$，其中 $\\Delta_{Z}$ 是塞曼能量。\n- 使用费米-狄拉克（FD）分布来考虑热致展宽，并利用有限温度下的微分电导可以表示为谱函数与 FD 分布导数的热卷积这一事实。\n\n用纯数学术语定义物理和数学模型：\n- 设超导能隙为 $\\Delta$（单位 $\\mathrm{meV}$）。\n- 设塞曼分裂为 $\\Delta_{Z}$（单位 $\\mathrm{meV}$）。\n- 设温度为 $T$（单位 $\\mathrm{K}$）。\n- 设 Dynes 展宽参数为 $\\Gamma$（单位 $\\mathrm{meV}$），其值为小的正数。\n- 设铁磁体的自旋极化率为 $P$（无量纲），自旋分辨的隧穿权重为 $w_{\\uparrow} = (1+P)/2$ 和 $w_{\\downarrow} = (1-P)/2$。\n\n每个自旋的自旋分辨超导态密度是经过塞曼位移的 BCS 态密度，而进入隧穿电导的总谱函数是自旋向上和自旋向下分量的加权和。有限温度下的微分电导可以表示为谱函数与费米-狄拉克函数导数的卷积，该导数正比于能量偏移量除以 $k_{B}T$ 的 $\\mathrm{sech}^{2}$，其中 $k_{B}$ 是玻尔兹曼常数。您必须使用单位为 $\\mathrm{meV}$ 的 $\\Delta$ 和 $\\Delta_{Z}$，单位为 $\\mathrm{K}$ 的 $T$，并取 $k_{B} \\approx 0.08617333$（单位 $\\mathrm{meV}/\\mathrm{K}$），以确保所有能量都以 $\\mathrm{meV}$ 为单位进行一致处理。偏压必须以 $\\mathrm{mV}$ 为单位处理，并认定以 $\\mathrm{meV}$ 为单位的 $eV$ 在数值上等于以 $\\mathrm{mV}$ 为单位的 $V$。\n\n您的程序必须：\n1. 从第一性原理出发，使用带有小的 Dynes 参数的巴丁-库珀-施里弗态密度，构建经过自旋向上和自旋向下 $\\pm \\Delta_{Z}/2$ 位移的自旋分辨超导谱函数。\n2. 将进入隧穿电导的总谱函数构造为自旋向上和自旋向下分量的加权和，权重由 $P$ 决定。\n3. 通过实现与费米-狄拉克分布导数的卷积，计算有限温度下的微分电导 $G(V)$。该热核必须进行归一化，使其能量积分等于 $1$，以确保在零温极限下电导归一化的物理一致性。\n4. 利用所述模型下 $G(V)$ 对 $P$ 的线性关系，设计一种算法，在给定 $\\Delta_{Z}$ 和 $T$ 的情况下，从模拟的 $G(V)$ 中提取 $P$。具体来说，将 $G(V)$ 写成 $G(V) = G_{A}(V) + P \\, G_{B}(V)$ 的形式，其中 $G_{A}(V)$ 是非极化贡献，$G_{B}(V)$ 是极化基函数，然后使用一个有原则的估计器，通过最小化模拟的 $G(V)$ 与作为 $P$ 的函数的模型表达式之间的均方差来获得 $P$。如果 $\\Delta_{Z}=0$，您的估计器必须返回 $P=0$，因为在没有塞曼分裂的情况下，极化基函数会消失。\n5. 使用数值稳定的积分或快速卷积，在对称的偏压网格 $V \\in [-V_{\\max}, V_{\\max}]$（单位 $\\mathrm{mV}$）上评估 $G(V)$。恰当选择 $V_{\\max}$ 和离散化方式，以确保在所有测试条件下，相干峰及其自旋分裂的对应部分都能被良好分辨，而不会引入人为误差。\n6. 对于下面描述的每个测试用例，使用已知的基准极化率 $P_{\\text{true}}$ 模拟 $G(V)$，然后应用您的估计器从模拟的 $G(V)$ 中恢复 $P$。最终输出必须是测试用例的估计极化率列表，四舍五入到小数点后四位，并以确切指定的格式单行打印。\n\n物理单位：\n- 能量单位必须是 $\\mathrm{meV}$。\n- 温度单位必须是 $\\mathrm{K}$。\n- 偏压单位必须是 $\\mathrm{mV}$，以使单位为 $\\mathrm{meV}$ 的 $eV$ 数值上等于单位为 $\\mathrm{mV}$ 的 $V$。\n- 提取的极化率 $P$ 是无量纲的，必须表示为小数。\n\n测试套件：\n为以下参数集提供结果，以测试对典型、边界和边缘情况的覆盖。在每种情况下，使用给定的 $(\\Delta, \\Delta_{Z}, T, P_{\\text{true}}, \\Gamma)$ 值：\n- 情况 1（理想路径）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 1.5, P_{\\text{true}} = 0.45, \\Gamma = 0.03)$。\n- 情况 2（非极化边界）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 1.5, P_{\\text{true}} = 0.0, \\Gamma = 0.03)$。\n- 情况 3（小塞曼分裂边缘）：$(\\Delta = 1.5, \\Delta_{Z} = 0.05, T = 0.5, P_{\\text{true}} = 0.5, \\Gamma = 0.02)$。\n- 情况 4（无塞曼分裂边界）：$(\\Delta = 1.5, \\Delta_{Z} = 0.0, T = 0.5, P_{\\text{true}} = 0.4, \\Gamma = 0.02)$，此时估计器必须返回 $P=0$，因为不对称性完全消失。\n- 情况 5（高温展宽）：$(\\Delta = 1.5, \\Delta_{Z} = 0.3, T = 5.0, P_{\\text{true}} = 0.45, \\Gamma = 0.05)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按上述顺序列出的各情况的估计极化率，格式为一个用方括号括起来的逗号分隔列表，每个值都四舍五入到小数点后四位；例如，$[0.1234,0.0000,0.5678,0.0000,0.4321]$。", "solution": "该问题要求设计一个程序，模拟铁磁体-绝缘体-超导体（F-I-S）结的微分隧穿电导 $G(V)$，并随后提取铁磁体的自旋极化率 $P$。该物理模型基于 Meservey-Tedrow 技术，该技术依赖于超导体态密度的塞曼分裂。解决方案将按照概述从第一性原理展开。\n\n首先，我们定义超导体的自旋分辨准粒子态密度（DOS）。对于理想超导体，标准的巴丁-库珀-施里弗（BCS）态密度由 $\\rho_{BCS}(E) \\propto |E| / \\sqrt{E^2 - \\Delta^2}$ 给出（对于能量 $|E| > \\Delta$），而在能隙内部（$|E| < \\Delta$）为零，其中 $\\Delta$ 是超导能隙。为了考虑寿命效应并确保数值稳定性，通过用复数能量替换能量 $E$ 的方法引入了 Dynes 展宽参数 $\\Gamma$。一种常见的、粒子-空穴对称的展宽态密度形式是：\n$$ \\rho(E, \\Delta, \\Gamma) = \\mathrm{Re}\\left[ \\frac{|E - i\\Gamma|}{\\sqrt{(E - i\\Gamma)^2 - \\Delta^2}} \\right] $$\n其中与正常态 DOS 相关的比例常数取为 1，因为它将在归一化电导中被消去。在磁场中，塞曼效应解除了自旋简并。自旋向上（$\\uparrow$）和自旋向下（$\\downarrow$）的准粒子能量分别移动 $\\mp \\Delta_Z/2$，其中 $\\Delta_Z$ 是塞曼分裂能量。因此，自旋分辨的态密度由下式给出：\n$$ \\rho_{\\uparrow}(E) = \\rho(E - \\Delta_Z/2, \\Delta, \\Gamma) $$\n$$ \\rho_{\\downarrow}(E) = \\rho(E + \\Delta_Z/2, \\Delta, \\Gamma) $$\n\n根据费米黄金定则，在偏压 $V$ 下的隧穿电流正比于可用于隧穿的谱函数的积分，并由占据概率加权。总谱函数 $N(E, P)$ 是自旋分辨态密度的加权和，权重由铁磁电极的自旋极化率 $P$ 决定：\n$$ N(E, P) = w_{\\uparrow} \\rho_{\\uparrow}(E) + w_{\\downarrow} \\rho_{\\downarrow}(E) = \\frac{1+P}{2} \\rho_{\\uparrow}(E) + \\frac{1-P}{2} \\rho_{\\downarrow}(E) $$\n在有限温度 $T$ 下，微分电导 $G(V) = dI/dV$ 通过将谱函数 $N(E, P)$ 与热展宽核 $K_T(E)$ 进行卷积得到，该核是费米-狄拉克分布 $f_{FD}(E) = (1 + e^{E/k_B T})^{-1}$ 的负导数：\n$$ G(V) \\propto \\int_{-\\infty}^{\\infty} N(E', P) \\left( -\\frac{\\partial f_{FD}(eV - E')}{\\partial(eV)} \\right) dE' $$\n该核为 $K_T(E) = -\\frac{\\partial f_{FD}(E)}{\\partial E} = \\frac{1}{4k_B T} \\mathrm{sech}^2\\left(\\frac{E}{2k_B T}\\right)$。此核经过归一化，使得 $\\int_{-\\infty}^{\\infty} K_T(E) dE = 1$。按照惯例，单位为 meV 的能量 $eV$ 在数值上等于单位为 mV 的偏压 $V$，则电导由卷积给出：\n$$ G(V) = (N(E, P) * K_T(E))|_{E=V} = \\int_{-\\infty}^{\\infty} N(E', P) K_T(V - E') dE' $$\n\n为了提取极化率 $P$，我们利用 $N(E, P)$ 对 $P$ 的线性依赖性。我们可以将谱函数重写为：\n$$ N(E, P) = \\left[ \\frac{\\rho_{\\uparrow}(E) + \\rho_{\\downarrow}(E)}{2} \\right] + P \\left[ \\frac{\\rho_{\\uparrow}(E) - \\rho_{\\downarrow}(E)}{2} \\right] $$\n令 $N_A(E) = \\frac{1}{2}(\\rho_{\\uparrow}(E) + \\rho_{\\downarrow}(E))$ 为不依赖于极化率的部分，令 $N_B(E) = \\frac{1}{2}(\\rho_{\\uparrow}(E) - \\rho_{\\downarrow}(E))$ 为依赖于极化率的基函数。由于卷积的线性特性，电导也可以写成线性形式：\n$$ G(V, P) = G_A(V) + P \\cdot G_B(V) $$\n其中 $G_A(V) = (N_A * K_T)(V)$ 且 $G_B(V) = (N_B * K_T)(V)$。给定一条测量的电导曲线 $G_{meas}(V)$，我们可以通过在离散电压点 $V_i$ 集合上最小化均方误差 $\\chi^2 = \\sum_i [G_{meas}(V_i) - G(V_i, P)]^2$ 来估计 $P$。将导数 $\\partial \\chi^2 / \\partial P$ 设为零，可得到 $P$ 的最小二乘估计量：\n$$ P_{est} = \\frac{\\sum_i (G_{meas}(V_i) - G_A(V_i)) G_B(V_i)}{\\sum_i G_B(V_i)^2} = \\frac{(\\vec{G}_{meas} - \\vec{G}_A) \\cdot \\vec{G}_B}{\\vec{G}_B \\cdot \\vec{G}_B} $$\n其中向量表示在电压网格上求值的函数。如果塞曼分裂 $\\Delta_Z = 0$，则 $\\rho_{\\uparrow}(E) = \\rho_{\\downarrow}(E)$。这导致 $N_B(E)$ 以及随后的 $G_B(V)$ 恒等于零。在这种情况下，极化信息丢失，估计量的分母变为零。物理上正确的结果是 $P=0$，我们的算法必须强制执行这一点。\n\n数值实现过程如下。首先，为能量和电压建立一个足够精细和宽广的数值网格。在该网格上计算自旋分辨的 DOS 和热核。通过使用 `scipy.signal.fftconvolve` 的快速傅里叶变换（FFT），高效地执行卷积以获得 $G_{meas}(V)$（来自 $P_{true}$）、$G_A(V)$ 和 $G_B(V)$。最后，将推导出的估计量公式应用于生成的 $G_{meas}(V)$，为每个提供的测试用例计算 $P_{est}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import fftconvolve\n\ndef solve():\n    \"\"\"\n    Simulates spin-polarized tunneling and extracts ferromagnet spin polarization.\n    \"\"\"\n    # Boltzmann constant in meV/K\n    KB_MEV_K = 0.08617333\n\n    def bcs_dos(E, delta, gamma):\n        \"\"\"\n        Calculates the Dynes-broadened, particle-hole symmetric BCS density of states.\n        \n        Args:\n            E (np.ndarray): Energy grid in meV.\n            delta (float): Superconducting gap in meV.\n            gamma (float): Dynes broadening parameter in meV.\n            \n        Returns:\n            np.ndarray: The normalized density of states.\n        \"\"\"\n        # Complex energy E' = E - i*gamma\n        E_complex = E - 1j * gamma\n        \n        # Term inside the square root: (E')^2 - delta^2\n        sqrt_arg = E_complex**2 - delta**2\n        \n        # DOS is Re[|E'| / sqrt((E')^2 - delta^2)]\n        dos = np.real(np.abs(E_complex) / np.sqrt(sqrt_arg))\n        \n        return dos\n\n    def compute_conductance(V_grid, delta, delta_z, T, P, gamma):\n        \"\"\"\n        Computes the differential conductance G(V) for a F-I-S junction.\n        \n        Args:\n            V_grid (np.ndarray): Bias voltage grid in mV.\n            delta (float): Superconducting gap in meV.\n            delta_z (float): Zeeman splitting in meV.\n            T (float): Temperature in K.\n            P (float): Spin polarization.\n            gamma (float): Dynes broadening in meV.\n            \n        Returns:\n            np.ndarray: The simulated differential conductance G(V).\n        \"\"\"\n        # Energy grid is identical to voltage grid based on problem spec (eV -> V)\n        E_grid = V_grid\n        dE = E_grid[1] - E_grid[0]\n        \n        # 1. Spin-resolved DOS\n        dos_up = bcs_dos(E_grid - delta_z / 2, delta, gamma)\n        dos_down = bcs_dos(E_grid + delta_z / 2, delta, gamma)\n        \n        # 2. Total spectral function N(E, P)\n        w_up = (1 + P) / 2\n        w_down = (1 - P) / 2\n        N_total = w_up * dos_up + w_down * dos_down\n        \n        # 3. Thermal smearing kernel\n        k_BT = KB_MEV_K * T\n        if k_BT == 0: # Avoid division by zero for T=0\n             # For T=0, the kernel is a delta function. Convolution is identity.\n             return N_total\n        \n        thermal_kernel = (1 / (4 * k_BT)) * (1 / np.cosh(E_grid / (2 * k_BT)))**2\n        \n        # Normalize kernel to ensure its discrete integral is 1\n        thermal_kernel /= np.sum(thermal_kernel) * dE\n        \n        # 4. Convolution using FFT for efficiency\n        conductance = fftconvolve(N_total, thermal_kernel, mode='same') * dE\n        \n        return conductance\n\n    def estimate_polarization(V_grid, G_measured, delta, delta_z, T, gamma):\n        \"\"\"\n        Estimates spin polarization P from a given conductance curve G(V).\n        \n        Args:\n            V_grid (np.ndarray): Bias voltage grid in mV.\n            G_measured (np.ndarray): The \"measured\" conductance curve.\n            delta (float): Superconducting gap in meV.\n            delta_z (float): Zeeman splitting in meV.\n            T (float): Temperature in K.\n            gamma (float): Dynes broadening in meV.\n            \n        Returns:\n            float: The estimated spin polarization P.\n        \"\"\"\n        # If there's no Zeeman splitting, P cannot be determined. Return 0.\n        if np.isclose(delta_z, 0.0):\n            return 0.0\n            \n        E_grid = V_grid\n        dE = E_grid[1] - E_grid[0]\n        \n        # Calculate basis functions G_A and G_B\n        dos_up = bcs_dos(E_grid - delta_z / 2, delta, gamma)\n        dos_down = bcs_dos(E_grid + delta_z / 2, delta, gamma)\n        \n        N_A = 0.5 * (dos_up + dos_down)\n        N_B = 0.5 * (dos_up - dos_down)\n        \n        k_BT = KB_MEV_K * T\n        if k_BT == 0: # Handle T=0 case\n            G_A = N_A\n            G_B = N_B\n        else:\n            thermal_kernel = (1 / (4 * k_BT)) * (1 / np.cosh(E_grid / (2 * k_BT)))**2\n            thermal_kernel /= np.sum(thermal_kernel) * dE\n            G_A = fftconvolve(N_A, thermal_kernel, mode='same') * dE\n            G_B = fftconvolve(N_B, thermal_kernel, mode='same') * dE\n        \n        # Apply the least-squares estimator formula\n        numerator = np.dot(G_measured - G_A, G_B)\n        denominator = np.dot(G_B, G_B)\n        \n        # Avoid division by zero if G_B is numerically zero\n        if np.isclose(denominator, 0.0):\n            return 0.0\n            \n        P_est = numerator / denominator\n        return P_est\n\n    # Define numerical grid parameters\n    V_max = 5.0  # mV\n    N_points = 4097  # Use an odd number for symmetry, power of 2 + 1 is efficient\n    V_grid = np.linspace(-V_max, V_max, N_points)\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (delta, delta_z, T, P_true, gamma)\n        (1.5, 0.3, 1.5, 0.45, 0.03),  # Case 1: Happy path\n        (1.5, 0.3, 1.5, 0.0, 0.03),   # Case 2: Unpolarized boundary\n        (1.5, 0.05, 0.5, 0.5, 0.02),  # Case 3: Small Zeeman splitting\n        (1.5, 0.0, 0.5, 0.4, 0.02),   # Case 4: No Zeeman splitting\n        (1.5, 0.3, 5.0, 0.45, 0.05),  # Case 5: High-temperature smearing\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, delta_z, T, P_true, gamma = case\n        \n        # 1. Simulate the \"measured\" conductance using P_true\n        G_measured = compute_conductance(V_grid, delta, delta_z, T, P_true, gamma)\n        \n        # 2. Estimate the polarization from the simulated data\n        P_estimated = estimate_polarization(V_grid, G_measured, delta, delta_z, T, gamma)\n        \n        results.append(P_estimated)\n\n    # Format results to four decimal places for final output\n    formatted_results = [f\"{r:.4f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3017039"}]}