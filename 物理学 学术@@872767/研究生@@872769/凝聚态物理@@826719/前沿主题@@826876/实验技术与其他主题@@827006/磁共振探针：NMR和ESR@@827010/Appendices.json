{"hands_on_practices": [{"introduction": "要理解磁共振，我们首先需要从量子力学的角度探究单个自旋在磁场中的行为。本练习将从基本原理出发，推导由塞曼效应（Zeeman effect）导致的能级结构。掌握这一基础计算是理解为何共振现象仅在特定频率下发生的关键第一步 ([@problem_id:3003350])。", "problem": "一个自旋量子数 $I = \\frac{3}{2}$ 的原子核被置于一个沿 $z$ 轴方向的静态、空间均匀的磁场 $\\mathbf{B}_0$ 中。考虑核磁矩与该磁场相互作用的塞曼相互作用哈密顿量 $H_Z$。从核磁矩算符 $\\boldsymbol{\\mu}$ 的定义、磁相互作用能的基本形式以及 $I_z$ 的角动量本征值性质出发，推导磁量子数 $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$ 对应的能量本征值 $E_m$，并计算相邻 $m$ 能级之间分裂的大小。使用核磁共振选择定则 $\\Delta m = \\pm 1$，列举所有允许的跃迁并确定它们的角频率。\n\n将能量分裂的大小以焦耳为单位、跃迁角频率以弧度/秒为单位表示。将最终答案表示为一个单行矩阵，其第一个元素是相邻能级能量分裂的大小，其余元素是按 $m$ 递增顺序排列的允许跃遷的角频率。无需进行数值取整；用核磁旋比 $\\gamma$、约化普朗克常数 $\\hbar$ 和磁场大小 $B_0$ 来符号化地表示你的结果。", "solution": "该问题被验证为具有科学依据、良定且客观。它是磁共振量子力学中的一个标准问题。所有必要的信息都已提供，且其前提与既定的物理原理相符。\n\n解题过程如下。\n\n核磁矩算符 $\\boldsymbol{\\mu}$ 与核自旋角动量算符 $\\mathbf{I}$ 成正比，比例常数为核磁旋比 $\\gamma$。\n$$\n\\boldsymbol{\\mu} = \\gamma \\mathbf{I}\n$$\n塞曼哈密顿量 $H_Z$ 描述了该磁矩与外部静态磁场 $\\mathbf{B}_0$ 的相互作用能。它由磁矩和磁场的标量积的负值给出。\n$$\nH_Z = - \\boldsymbol{\\mu} \\cdot \\mathbf{B}_0\n$$\n将 $\\boldsymbol{\\mu}$ 的表达式代入，我们得到：\n$$\nH_Z = - (\\gamma \\mathbf{I}) \\cdot \\mathbf{B}_0 = -\\gamma (\\mathbf{I} \\cdot \\mathbf{B}_0)\n$$\n问题指明磁场 $\\mathbf{B}_0$ 是均匀且沿 $z$ 轴的。我们可以将其写为 $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$，其中 $B_0$ 是磁场的大小。自旋角动量算符为 $\\mathbf{I} = I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}$。因此，标量积为：\n$$\n\\mathbf{I} \\cdot \\mathbf{B}_0 = (I_x \\hat{\\mathbf{x}} + I_y \\hat{\\mathbf{y}} + I_z \\hat{\\mathbf{z}}) \\cdot (B_0 \\hat{\\mathbf{z}}) = I_z B_0\n$$\n哈密顿量简化为：\n$$\nH_Z = -\\gamma B_0 I_z\n$$\n该系统的能量本征值 $E_m$ 是哈密顿算符 $H_Z$ 的本征值。系统的本征态是算符 $I^2$ 和 $I_z$ 的共同本征态，记作 $|I, m\\rangle$。$I_z$ 算符作用于这些态上的结果由以下本征值方程给出：\n$$\nI_z |I, m\\rangle = m \\hbar |I, m\\rangle\n$$\n其中 $m$ 是磁量子数，$\\hbar$ 是约化普朗克常数。对于给定的自旋量子数 $I$，$m$可以取从 $-I$ 到 $+I$ 以整数为步长的 $2I+1$ 个值。\n\n将哈密顿量 $H_Z$ 应用于一个本征态 $|I, m\\rangle$：\n$$\nH_Z |I, m\\rangle = (-\\gamma B_0 I_z) |I, m\\rangle = -\\gamma B_0 (I_z |I, m\\rangle) = -\\gamma B_0 (m \\hbar) |I, m\\rangle\n$$\n这是一个 $H_Z$ 的本征值方程，其本征值为 $E_m$：\n$$\nE_m = -m \\gamma \\hbar B_0\n$$\n问题陈述原子核的自旋量子数为 $I = \\frac{3}{2}$。因此，$m$ 的可能取值为 $m \\in \\{-\\frac{3}{2}, -\\frac{1}{2}, \\frac{1}{2}, \\frac{3}{2}\\}$。这产生了四个不同的能级。\n\n接下来，我们计算相邻 $m$ 能级之间的能量分裂大小。考虑对应于量子数 $m$ 和 $m+1$ 的两个相邻能级。能量差为：\n$$\n\\Delta E = E_{m+1} - E_m = (-(m+1)\\gamma\\hbar B_0) - (-m\\gamma\\hbar B_0) = -m\\gamma\\hbar B_0 - \\gamma\\hbar B_0 + m\\gamma\\hbar B_0 = -\\gamma\\hbar B_0\n$$\n这个结果表明能级是等间距的。任意两个相邻能级之间的分裂是恒定的。问题要求计算这个分裂的大小。由于对于不同的原子核，磁旋比 $\\gamma$ 可以是正值也可以是负值，而能量分裂的大小必须是一个非负量，因此我们必须取绝对值：\n$$\n|\\Delta E| = |-\\gamma\\hbar B_0| = |\\gamma|\\hbar B_0\n$$\n这给出了以焦耳为单位的能量分裂。\n\n最后，我们确定允许跃遷的角频率。核磁共振中磁偶极跃迁的选择定则是 $\\Delta m = \\pm 1$。这意味着跃迁只允许在相邻能级之間发生。在这种跃遷中吸收或发射的光子能量 $E_{\\text{photon}}$ 必须等于初态和末态之间能量差的大小：\n$$\nE_{\\text{photon}} = |E_{\\text{final}} - E_{\\text{initial}}| = |\\Delta E| = |\\gamma|\\hbar B_0\n$$\n光子的能量通过 $E_{\\text{photon}} = \\hbar \\omega$ 与其角频率 $\\omega$ 相关。令这两个光子能量的表达式相等：\n$$\n\\hbar \\omega = |\\gamma|\\hbar B_0\n$$\n解出角频率 $\\omega$（单位为弧度/秒）可得：\n$$\n\\omega = |\\gamma|B_0\n$$\n这个频率被称为拉莫尔频率。由于所有相邻能级之间的能量分裂是相同的，所有允许的跃迁都发生在这同一个频率上。\n\n问题要求列举允许的跃迁。对于 $I=3/2$，有三种满足 $\\Delta m = \\pm 1$ 的可能跃迁：\n\\begin{enumerate}\n    \\item $m = -\\frac{3}{2}$ 和 $m = -\\frac{1}{2}$ 之间的跃迁。\n    \\item $m = -\\frac{1}{2}$ 和 $m = \\frac{1}{2}$ 之间的跃迁。\n    \\item $m = \\frac{1}{2}$ 和 $m = \\frac{3}{2}$ 之间的跃迁。\n\\end{enumerate}\n这些跃遷中每一个的角频率都是相同的，即 $\\omega = |\\gamma|B_0$。\n\n最终答案应以单行矩阵形式提供。第一个元素是能量分裂的大小 $|\\gamma|\\hbar B_0$。后续元素是允许跃遷的角频率，按 $m$（跃遷对中较低能态的 $m$ 值）的递增顺序排列。因此，我们列出三次跃遷的频率，即使它们是相同的。\n\n矩阵元素为：\n\\begin{itemize}\n    \\item 能量分裂：$|\\gamma|\\hbar B_0$\n    \\item 跃迁1（$m = -3/2 \\leftrightarrow -1/2$）的频率：$|\\gamma|B_0$\n    \\item 跃迁2（$m = -1/2 \\leftrightarrow 1/2$）的频率：$|\\gamma|B_0$\n    \\item 跃迁3（$m = 1/2 \\leftrightarrow 3/2$）的频率：$|\\gamma|B_0$\n\\end{itemize}", "answer": "$$\n\\boxed{\\begin{pmatrix} |\\gamma|\\hbar B_0 & |\\gamma|B_0 & |\\gamma|B_0 & |\\gamma|B_0 \\end{pmatrix}}\n$$", "id": "3003350"}, {"introduction": "在理解了静态能级之后，下一步是探究自旋系统对射频脉冲的响应以及如何恢复到平衡态的动力学过程。本练习应用核心的布洛赫方程（Bloch equations）来模拟饱和与反转脉冲后的磁化恢复。通过该实践，您可以将理论模型与关键参数——自旋-晶格弛豫时间 ($T_1$) 的实验测量直接联系起来，从而体会理论如何指导实际测量 ([@problem_id:3003371])。", "problem": "一个自旋-$\\tfrac{1}{2}$原子核的均匀系综通过核磁共振（NMR）进行研究。假设纵向弛豫是单指数的，自旋-晶格弛豫时间为$T_1$，并且在恢复延迟期间横向过程不影响纵向分量。系统处于高温强场极限下，因此在固定的温度和静磁场下，平衡纵向磁化强度$M_0$不随时间变化。从纵向Bloch方程出发\n$$\n\\frac{d M_z}{d t} \\;=\\; -\\,\\frac{M_z - M_0}{T_1}\\,,\n$$\n并将射频脉冲视为瞬时旋转，它在每个恢复期开始时设定$M_z$的初始条件。\n\n(a) 在一个使自旋布居数相等的饱和脉冲之后，纵向磁化强度立即变为$M_z(0)=0$。推导当$t>0$时$M_z(t)$的显式时间依赖关系。\n\n(b) 在一个反转-恢复实验中，一个理想的$180^{\\circ}$反转脉冲之后是一个可变延迟$\\tau$和一个理想的$90^{\\circ}$读出脉冲，检测到的信号与$90^{\\circ}$脉冲前瞬间的纵向磁化强度$M_z(\\tau)$成正比。使用相同的Bloch方程框架并假设脉冲是理想的，推导当$t=\\tau$时的$M_z(\\tau)$。\n\n对此样本的一次测量发现，反转-恢复信号在延迟$\\tau_0 = 72.00\\ \\mathrm{ms}$时改变符号，即$M_z(\\tau_0)=0$。使用单指数模型和您的推导，从此过零延迟计算$T_1$。将$T_1$的数值四舍五入到四位有效数字。以$\\mathrm{s}$为单位表示弛豫时间。\n\n提供您的最终答案，形式为一个有序对，其中包含(a)部分的解析表达式和(b)部分中提取的$T_1$数值。", "solution": "该问题要求分析核磁共振（NMR）实验中纵向磁化强度的弛豫过程，该过程由一阶线性常微分方程，即纵向Bloch方程所描述：\n$$\n\\frac{d M_z}{d t} = -\\frac{M_z - M_0}{T_1}\n$$\n此处，$M_z(t)$是时间$t$时的纵向磁化强度，$M_0$是热平衡磁化强度，$T_1$是自旋-晶格或纵向弛豫时间。我们必须针对两种不同的实验场景解此方程。\n\n该微分方程是可分离的，可以重写为：\n$$\n\\frac{d M_z}{M_z - M_0} = -\\frac{1}{T_1} dt\n$$\n我们可以将此方程从初始时间$t=0$（初始磁化强度为$M_z(0)$）积分到稍后时间$t$（磁化强度为$M_z(t)$）：\n$$\n\\int_{M_z(0)}^{M_z(t)} \\frac{dM'_z}{M'_z - M_0} = \\int_0^t -\\frac{1}{T_1} dt'\n$$\n进行积分得到：\n$$\n\\left[ \\ln|M'_z - M_0| \\right]_{M_z(0)}^{M_z(t)} = -\\frac{t}{T_1}\n$$\n$$\n\\ln|M_z(t) - M_0| - \\ln|M_z(0) - M_0| = -\\frac{t}{T_1}\n$$\n$$\n\\ln\\left( \\frac{|M_z(t) - M_0|}{|M_z(0) - M_0|} \\right) = -\\frac{t}{T_1}\n$$\n对于物理弛豫过程，其中$M_z(t)$从初始值$M_z(0)$单调地趋近$M_0$，量$(M_z - M_0)$在弛豫过程中不改变符号。因此我们可以去掉绝对值符号。对两边取指数得到：\n$$\n\\frac{M_z(t) - M_0}{M_z(0) - M_0} = \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n重新整理以解出$M_z(t)$，我们得到纵向磁化恢复的通解：\n$$\nM_z(t) = M_0 + \\left( M_z(0) - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n这个通用表达式将用于解决问题的两个部分。\n\n(a) 饱和-恢复实验的推导。\n在饱和-恢复实验中，施加一个初始脉冲（或一串脉冲）来饱和自旋系统。饱和意味着自旋布居数的均等化，这对应于净纵向磁化强度为零。因此，时间$t=0$时的初始条件是$M_z(0) = 0$。\n将此初始条件代入通解中：\n$$\nM_z(t) = M_0 + \\left( 0 - M_0 \\right) \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n$$\nM_z(t) = M_0 - M_0 \\exp\\left(-\\frac{t}{T_1}\\right)\n$$\n这可以写成饱和-恢复的标准形式：\n$$\nM_z(t) = M_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right)\n$$\n这是饱和脉冲后纵向磁化强度的显式时间依赖性。\n\n(b) 从反转-恢复实验中计算$T_1$。\n在反转-恢复实验中，实验开始时系统处于热平衡状态，$M_z = M_0$。在$t=0$时施加一个理想的$180^{\\circ}$反转脉冲。这样的脉冲会反转纵向磁化强度，因此随后的持续时间为$\\tau$的恢复期的初始条件是$M_z(0) = -M_0$。\n我们再次使用通解，这次代入$t=\\tau$和新的初始条件$M_z(0) = -M_0$：\n$$\nM_z(\\tau) = M_0 + \\left( (-M_0) - M_0 \\right) \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\n$$\nM_z(\\tau) = M_0 - 2M_0 \\exp\\left(-\\frac{\\tau}{T_1}\\right)\n$$\n这给出了测量信号对延迟时间$\\tau$的依赖关系：\n$$\nM_z(\\tau) = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau}{T_1}\\right)\\right)\n$$\n问题指出，在特定延迟$\\tau_0 = 72.00 \\, \\mathrm{ms}$时信号变为零。这是反转-恢复曲线的零点或过零时间。此时，$M_z(\\tau_0) = 0$。\n$$\n0 = M_0 \\left(1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\\right)\n$$\n由于平衡磁化强度$M_0$非零，我们可以将其除掉：\n$$\n0 = 1 - 2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right)\n$$\n现在，我们求解$T_1$：\n$$\n2\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = 1\n$$\n$$\n\\exp\\left(-\\frac{\\tau_0}{T_1}\\right) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-\\frac{\\tau_0}{T_1} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\n\\frac{\\tau_0}{T_1} = \\ln(2)\n$$\n最后，求解$T_1$：\n$$\nT_1 = \\frac{\\tau_0}{\\ln(2)}\n$$\n我们已知$\\tau_0 = 72.00 \\, \\mathrm{ms}$。我们必须以秒为单位表示$T_1$，所以$\\tau_0 = 72.00 \\times 10^{-3} \\, \\mathrm{s}$。\n$$\nT_1 = \\frac{72.00 \\times 10^{-3} \\, \\mathrm{s}}{\\ln(2)}\n$$\n使用$\\ln(2) \\approx 0.69314718$的值：\n$$\nT_1 \\approx \\frac{72.00 \\times 10^{-3}}{0.69314718} \\, \\mathrm{s} \\approx 0.1038732 \\, \\mathrm{s}\n$$\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是$1$、$0$、$3$、$8$，第五位数字是$7$，所以我们向上取整。\n$$\nT_1 \\approx 0.1039 \\, \\mathrm{s}\n$$\n最终答案是一个有序对，由(a)部分的解析表达式和$T_1$的数值组成。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nM_0 \\left(1 - \\exp\\left(-\\frac{t}{T_1}\\right)\\right) & 0.1039\n\\end{pmatrix}\n}\n$$", "id": "3003371"}, {"introduction": "真实世界的样品很少是完美均匀的；它们会表现出不均匀性和扩散等动态过程。这个计算练习将深入探讨这些复杂情况，展示如何对非均匀磁场和分子运动对共振信号的影响进行建模。通过编程实现自由感应衰减 (Free Induction Decay, FID) 和哈恩回波 (Hahn echo) 的模型，您将掌握模拟这些现象如何影响观测信号的实用技能，这是解读高级核磁共振 (NMR) 或电子自旋共振 (ESR) 实验的关键一步 ([@problem_id:3003340])。", "problem": "考虑一个由无相互作用的自旋组成的系综，通过核磁共振 (NMR) 或电子自旋共振 (ESR) 在固体或液体中进行探测，该系综被置于一个静态外部磁场中，该磁场具有一个均匀的主分量 $B_0$ 和一个沿 $x$ 轴叠加的线性空间梯度 $G$，因此 $B(x) = B_0 + G x$。局部拉莫尔角频率为 $\\omega(x) = \\gamma B(x)$，其中 $\\gamma$ 是旋磁比，单位为 $\\mathrm{rad \\, s^{-1} \\, T^{-1}}$。假设横向磁化强度遵循由布洛赫方程控制的进动动力学，并且系综平均的自由感应衰减可以通过对由 $x$ 的空间分布引起的频率偏移进行平均来建模，而一个 $\\pi/2$–$\\pi$ 脉冲序列后在时间 $2\\tau$ 的哈恩回波包络则受到内在横向弛豫和在磁场梯度中随机运动的共同影响。\n\n您必须从第一性原理出发，为一个一维样本推导并实现以下计算任务：\n\n1) 静态非均匀展宽和自由感应衰减 (FID)：假设沿 $x$ 轴的自旋位置的静态分布是均值为 $0$、方差为 $\\sigma_x^2$ 的高斯分布，这意味着瞬时拉莫尔频率也相应地服从高斯分布。利用系综平均的定义和高斯随机变量的性质，计算在时间 $t$ 时仅由静态非均匀展宽引起的归一化横向磁化强度包络 $M_{\\mathrm{FID}}(t)$（即忽略内在横向弛豫），并将其表示为一个无量纲浮点数。\n\n2) 在恒定梯度中因扩散引起的哈恩回波衰减：将沿 $x$ 轴的分子运动建模为一维布朗运动，其扩散系数为 $D$，单位为 $\\mathrm{m^2 \\, s^{-1}}$。在单位为 $\\mathrm{T \\, m^{-1}}$ 的恒定梯度 $G$ 下，随时间变化的拉莫尔频率成为一个随机过程 $\\omega(t) = \\gamma G x(t)$。利用在时间 $\\tau$ 施加 $\\pi$ 脉冲的哈恩回波在翻转坐标系下的累积相位定义以及 $x(t)$ 的高斯特性，计算在时间 $2\\tau$ 的归一化回波包络 $M_{\\mathrm{echo}}(2\\tau)$，该计算需同时包括由 $T_2$（单位为 $\\mathrm{s}$）表征的内在横向弛豫和由梯度中扩散引起的失相。将结果表示为一个无量纲浮点数。\n\n您的程序必须对下面的每个测试用例计算并返回一个数值对 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$。请使用以下科学上合理的测试套件，其参数均以国际单位制 (SI) 给出：\n\n- 测试用例 1 (一般正常路径):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$。\n\n- 测试用例 2 (边界：零梯度):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 0.0$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$。\n\n- 测试用例 3 (边缘：零扩散，仅静态梯度):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 1.0 \\times 10^{-2}$,\n  - $D = 0.0$,\n  - $T_2 = 1.5$,\n  - $\\tau = 4.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-4}$。\n\n- 测试用例 4 (边缘：很长的 $T_2$，扩散主导的回波):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 3.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 1.0 \\times 10^{3}$,\n  - $\\tau = 5.0 \\times 10^{-2}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 1.0 \\times 10^{-5}$。\n\n- 测试用例 5 (边缘：小的 $\\tau$):\n  - $\\gamma = 2.675 \\times 10^8$,\n  - $G = 2.0 \\times 10^{-2}$,\n  - $D = 2.0 \\times 10^{-9}$,\n  - $T_2 = 5.0 \\times 10^{-1}$,\n  - $\\tau = 5.0 \\times 10^{-3}$,\n  - $\\sigma_x = 5.0 \\times 10^{-3}$,\n  - $t = 7.0 \\times 10^{-5}$。\n\n所有量必须按所给定的国际单位制 (SI) 处理。您的程序应生成单行输出，其中包含一个由列表组成的列表，该列表以逗号分隔并用方括号括起。每个内部列表对应一个测试用例，并按顺序包含 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$。例如，输出格式必须类似于 $[[a_1,b_1],[a_2,b_2],\\dots]$，其中每个 $a_i$ 和 $b_i$ 都是浮点数。", "solution": "我们从布洛赫方程 $\\frac{d\\mathbf{M}}{dt} = \\gamma \\mathbf{M} \\times \\mathbf{B}$ 给出的磁场中磁矩的进动动力学开始。当 $\\mathbf{B}(x) = B_0 \\hat{z} + G x \\hat{z}$ 时，该方程意味着沿梯度方向上位置为 $x$ 的自旋具有局部拉莫尔角频率 $\\omega(x) = \\gamma B(x)$。系综横向磁化强度通过对局部频率的分布进行平均得到，对于随时间变化的情况，还需对运动的随机实现进行平均。\n\n静态非均匀展宽和 $M_{\\mathrm{FID}}(t)$：如果位置 $x$ 的空间分布是均值为 $0$、方差为 $\\sigma_x^2$ 的高斯分布，则所导致的局部拉莫尔角频率 $\\omega$ 的分布也是高斯分布，因为 $\\omega(x) = \\gamma (B_0 + G x)$ 且与均值的频偏与 $x$ 成正比。具体来说，如果 $x \\sim \\mathcal{N}(0,\\sigma_x^2)$，那么频偏 $\\Delta \\omega = \\gamma G x$ 是均值为 $0$、方差为 $\\sigma_\\omega^2 = (\\gamma G)^2 \\sigma_x^2$ 的高斯分布。自由感应衰减下的横向磁化强度包络是在时间 $t$ 评估的高斯频率分布的特征函数，且在 $t=0$ 时归一化为 1。设 $p(\\Delta \\omega)$ 为高斯概率密度，则\n$$\nM_{\\mathrm{FID}}(t) = \\left\\langle e^{i \\Delta \\omega \\, t} \\right\\rangle_{\\Delta \\omega} = \\int_{-\\infty}^{\\infty} e^{i \\Delta \\omega \\, t} \\, \\frac{1}{\\sqrt{2\\pi} \\sigma_\\omega} \\exp\\left(-\\frac{\\Delta \\omega^2}{2 \\sigma_\\omega^2}\\right) \\, d(\\Delta \\omega).\n$$\n该积分是零均值高斯分布的特征函数，其结果等于\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 t^2 \\right) = \\exp\\left( - \\frac{1}{2} (\\gamma G)^2 \\sigma_x^2 \\, t^2 \\right).\n$$\n这捕捉了仅由静态空间展宽引起的非均匀失相，并忽略了内在横向弛豫。结果是无量纲的。\n\n在恒定梯度中因扩散引起的哈恩回波衰减：考虑一个哈恩回波序列，在初始的 $\\pi/2$ 脉冲之后，于时间 $\\tau$ 施加一个 $\\pi$ 脉冲。在恒定梯度 $G$ 和一维布朗运动 $x(t)$（扩散系数为 $D$，满足 $\\langle x(t)\\rangle = 0$ 和协方差 $\\langle x(t_1) x(t_2) \\rangle = 2 D \\min(t_1,t_2)$）的存在下，瞬时角频率成为一个随机过程 $\\omega(t) = \\gamma G x(t)$。在翻转坐标系中的累积相位为\n$$\n\\phi = \\int_0^{2\\tau} \\omega(t) f(t) \\, dt = \\gamma G \\int_0^{2\\tau} x(t) f(t) \\, dt,\n$$\n其中翻转函数 $f(t)$ 描述了由 $\\pi$ 脉冲引起的符号反转：对于 $0 \\le t  \\tau$，$f(t) = +1$；对于 $\\tau \\le t \\le 2\\tau$，$f(t) = -1$。由于 $x(t)$ 是一个零均值高斯过程，且 $\\phi$ 是 $x(t)$ 的线性泛函，因此 $\\phi$ 是一个零均值高斯随机变量。由扩散引起的失相所导致的归一化回波振幅是特征函数 $\\langle e^{i \\phi} \\rangle$，对于高斯变量，它等于 $\\exp\\left(- \\frac{1}{2} \\mathrm{Var}(\\phi)\\right)$。方差为\n$$\n\\mathrm{Var}(\\phi) = (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\langle x(t_1) x(t_2) \\rangle \\, dt_1 dt_2\n= 2 D (\\gamma G)^2 \\int_0^{2\\tau} \\int_0^{2\\tau} f(t_1) f(t_2) \\, \\min(t_1,t_2) \\, dt_1 dt_2.\n$$\n使用恒等式\n$$\n\\int_0^{T} \\int_0^{T} \\min(t_1,t_2) \\, a(t_1) a(t_2) \\, dt_1 dt_2 = \\int_0^{T} \\left( \\int_t^{T} a(u) \\, du \\right)^2 dt,\n$$\n其中 $a(t) = f(t)$ 且 $T = 2\\tau$，我们计算内层积分 $S(t) = \\int_t^{2\\tau} f(u) \\, du$。对于 $0 \\le t \\le \\tau$，$S(t) = \\int_t^{\\tau} 1 \\, du + \\int_{\\tau}^{2\\tau} (-1) \\, du = (\\tau - t) - \\tau = -t$。对于 $\\tau \\le t \\le 2\\tau$，$S(t) = \\int_t^{2\\tau} (-1) \\, du = -(2\\tau - t) = t - 2\\tau$。因此，\n$$\n\\mathrm{Var}(\\phi) = 2 D (\\gamma G)^2 \\left[ \\int_0^{\\tau} t^2 \\, dt + \\int_{\\tau}^{2\\tau} (t - 2\\tau)^2 \\, dt \\right] = 2 D (\\gamma G)^2 \\left( \\frac{\\tau^3}{3} + \\frac{\\tau^3}{3} \\right) = \\frac{4}{3} D (\\gamma G)^2 \\tau^3.\n$$\n因此，扩散引起的哈恩回波衰减因子为\n$$\nM_{\\mathrm{diff}}(2\\tau) = \\exp\\left( - \\frac{1}{2} \\mathrm{Var}(\\phi) \\right) = \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\n具有特征时间 $T_2$ 的内在横向弛豫对回波包络贡献了一个乘法衰减因子 $\\exp(-2\\tau / T_2)$。合并后的归一化回波包络是\n$$\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right).\n$$\n这个结果具有预期的极限：如果 $G = 0$ 或 $D = 0$，扩散引起的失相消失，$M_{\\mathrm{echo}}(2\\tau) = \\exp(-2\\tau/T_2)$；对于非常小的 $\\tau$，扩散因子趋近于 $1$，因为指数与 $\\tau^3$ 成比例。\n\n算法设计：对于每个测试用例，从给定参数计算 $\\sigma_\\omega = \\gamma G \\sigma_x$，然后评估\n$$\nM_{\\mathrm{FID}}(t) = \\exp\\left( - \\frac{1}{2} \\sigma_\\omega^2 \\, t^2 \\right),\n\\quad\nM_{\\mathrm{echo}}(2\\tau) = \\exp\\left( - \\frac{2 \\tau}{T_2} \\right) \\exp\\left( - \\frac{2}{3} D (\\gamma G)^2 \\tau^3 \\right),\n$$\n并为该测试用例返回数值对 $[M_{\\mathrm{FID}}(t), M_{\\mathrm{echo}}(2\\tau)]$（作为浮点数）。所有输入参数均使用国际单位制 (SI)，输出为无量纲浮点数。最终程序将所有指定测试用例的结果汇总到一个列表的列表中，并以要求的单行格式打印。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fid_amplitude(gamma, G, sigma_x, t):\n    \"\"\"\n    Compute M_FID(t) due to static Gaussian distribution of positions in a linear B0 gradient.\n    sigma_omega = gamma * G * sigma_x\n    M_FID = exp(-0.5 * (sigma_omega * t)^2)\n    \"\"\"\n    sigma_omega = gamma * G * sigma_x\n    return float(np.exp(-0.5 * (sigma_omega * t) ** 2))\n\ndef echo_amplitude(gamma, G, D, T2, tau):\n    \"\"\"\n    Compute M_echo(2*tau) including intrinsic T2 and diffusion in a constant gradient.\n    M_echo = exp(-2*tau / T2) * exp( - (2/3) * D * (gamma*G)^2 * tau^3 )\n    \"\"\"\n    # Handle extremely large T2 robustly (although not strictly necessary with given values)\n    t2_factor = np.exp(-2.0 * tau / T2) if T2 > 0 else 0.0\n    diff_factor = np.exp(-(2.0 / 3.0) * D * (gamma * G) ** 2 * tau ** 3)\n    return float(t2_factor * diff_factor)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: gamma, G, D, T2, tau, sigma_x, t\n    test_cases = [\n        (2.675e8, 1.0e-2, 2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 1\n        (2.675e8, 0.0,    2.0e-9, 1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 2\n        (2.675e8, 1.0e-2, 0.0,    1.5,    4.0e-2, 5.0e-3, 1.0e-4),  # Case 3\n        (2.675e8, 3.0e-2, 2.0e-9, 1.0e3,  5.0e-2, 5.0e-3, 1.0e-5),  # Case 4\n        (2.675e8, 2.0e-2, 2.0e-9, 5.0e-1, 5.0e-3, 5.0e-3, 7.0e-5),  # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, G, D, T2, tau, sigma_x, t = case\n        fid = fid_amplitude(gamma, G, sigma_x, t)\n        echo = echo_amplitude(gamma, G, D, T2, tau)\n        results.append([fid, echo])\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists with floats\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3003340"}]}