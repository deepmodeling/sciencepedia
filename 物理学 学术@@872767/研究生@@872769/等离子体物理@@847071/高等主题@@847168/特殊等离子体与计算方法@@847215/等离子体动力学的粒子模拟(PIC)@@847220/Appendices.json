{"hands_on_practices": [{"introduction": "蛙跳积分法是驱动大多数PIC模拟中粒子运动的引擎。为了确保模拟具有物理意义，数值方法本身必须是稳定的。本练习通过将蛙跳法应用于简谐振子——等离子体中各种振荡行为的普适模型，对此稳定性进行了基础分析。通过推导其稳定性条件 [@problem_id:296795]，您将对模拟时间步长 $\\Delta t$ 的选择所受到的约束有具体的理解。", "problem": "在粒子网格（PIC）模拟中，单个带电粒子的运动随时间被追踪。对于振荡运动，例如粒子在均匀磁场中回旋或在静电势阱中振荡，其最简单的模型是简谐振子（SHO）。一维简谐振子的运动方程由下式给出：\n$$\n\\frac{d^2x}{dt^2} = -\\omega_0^2 x\n$$\n其中 $x$ 是粒子的位置，$\\omega_0$ 是振荡的自然角频率。\n\n解决此类问题的一个广泛使用的数值积分算法是交错蛙跳（或Verlet）方法。位置和速度的离散更新方程为：\n$$\nv_{n+1/2} = v_{n-1/2} + a_n \\Delta t\n$$\n$$\nx_{n+1} = x_n + v_{n+1/2} \\Delta t\n$$\n此处，$x_n = x(t_n)$ 是在时间 $t_n = n \\Delta t$ 时的位置，$v_{n \\pm 1/2} = v(t_n \\pm \\Delta t/2)$ 是在半整数时间步长上计算的速度，$a_n = -\\omega_0^2 x_n$ 是在时间 $t_n$ 时的加速度，而 $\\Delta t$ 是恒定的时间步长。\n\n该格式的数值稳定性取决于无量纲参数 $\\alpha = \\omega_0 \\Delta t$。如果一个数值格式的放大矩阵的所有特征值的模都小于或等于一 $(|\\lambda| \\le 1)$，并且任何模恰好为一的特征值都必须是特征多项式的单（非重复）根，则该格式被定义为稳定的。模为一的重根特征值会导致长期增长，这是一种数值不稳定性。\n\n通过对应用于简谐振子的蛙跳格式进行矩阵稳定性分析，推导出其稳定性条件。确定使该格式保持稳定的无量纲参数 $\\alpha$ 的最大值。", "solution": "我们可以将两个蛙跳法方程合并，以消除速度项，得到一个关于位置的二阶差分方程：\n$$ x_{n+1} - (2 - \\omega_0^2 \\Delta t^2)x_n + x_{n-1} = 0 $$\n将此方程写成矩阵形式。定义状态向量 $\\mathbf{X}_n = \\begin{pmatrix} x_n \\\\ x_{n-1} \\end{pmatrix}$。则更新规则为 $\\mathbf{X}_{n+1} = \\mathbf{A} \\mathbf{X}_n$，其中放大矩阵 $\\mathbf{A}$ 为：\n$$ \\mathbf{A} = \\begin{pmatrix} 2-\\alpha^2 & -1 \\\\ 1 & 0 \\end{pmatrix} $$\n其中 $\\alpha = \\omega_0 \\Delta t$。$\\mathbf{A}$ 的特征多项式为：\n$$ \\det(\\mathbf{A} - \\lambda\\mathbf{I}) = (2-\\alpha^2-\\lambda)(-\\lambda) - (-1) = \\lambda^2 - (2-\\alpha^2)\\lambda + 1 = 0 $$\n其根满足 $\\lambda=e^{\\pm i\\theta}$，其中 $\\cos\\theta = \\frac{2-\\alpha^2}{2} = 1-\\frac{\\alpha^2}{2}$。\n为使 $\\theta$ 为实数，从而保证解不发散，必须满足 $|\\cos\\theta| \\le 1$。\n$$-1\\le1-\\frac{\\alpha^2}{2}\\le1\\;\\Longrightarrow\\;\\alpha^2\\le4\\;\\Longrightarrow\\;\\alpha\\le2\\,. $$", "answer": "$$\\boxed{2}$$", "id": "296795"}, {"introduction": "“网格-粒子”（PIC）方法依赖于将连续的粒子位置映射到离散的网格上，然而这一基本步骤会引入数值赝像。本练习探讨了其中最重要的一种：即使在使用如云中粒子（CIC）法这样的标准、自洽方案时也会出现的非物理“自作用力”。通过计算该力的均方根（RMS）值 [@problem_id:296780]，我们可以量化数值加热的一个主要来源，并理解PIC代码中能量守恒的内在局限性。", "problem": "在一维静电Particle-in-Cell (PIC)模拟中，当使用线性权重（也称为Cloud-in-Cell或CIC）时，带电粒子与计算网格相互作用，会产生一种非物理的“自作用力”。这种力的产生是由于粒子自身的电荷在沉积到网格上时，会形成一个网格化的电场，该电场在插值后又反过来作用于粒子本身。这种虚假力是空间离散化的直接后果，它会导致数值加热和能量不守恒。\n\n对于一个电荷为 $q$ 的单个粒子，在一个网格间距为 $\\Delta x$、真空介电常数为 $\\epsilon_0$ 的无限长一维系统中，其自身网格化电场的势能 $U_{self}$ 会随其在网格单元内的位置而变化。该势能以网格周期 $\\Delta x$ 为周期，在一个由网格节点 $x_j$ 和 $x_{j+1}$ 定义的给定单元内，其表达式为：\n$$\nU_{self}(x) = \\frac{q^2 \\Delta x}{2\\epsilon_0} u(1-u)\n$$\n其中 $u = \\frac{x - x_j}{\\Delta x}$ 是粒子在单元内的归一化位置，对于 $x \\in [x_j, x_{j+1}]$。该能量在单元边界处（$u=0$ 和 $u=1$）为零，在单元中心处（$u=1/2$）达到最大值。\n\n与该自势能相关的保守力为 $F_{self}(x) = -\\frac{\\partial U_{self}}{\\partial x}$。当粒子穿过单元时，该力会发生变化，其在一个单元上的空间平均值为零。为了量化该力的典型大小，计算其均方根（RMS）值是很有用的。\n\n推导在单个网格单元上均匀分布的粒子的自作用力均方根值 $F_{RMS}$。", "solution": "相关的自势能和归一化位置：  \n$$U_{self}(x)=\\frac{q^2\\Delta x}{2\\epsilon_0}\\,u(1-u),\\qquad u=\\frac{x-x_j}{\\Delta x}.$$  \n自作用力：  \n$$F_{self}(x)=-\\frac{\\partial U_{self}}{\\partial x}\n=-\\frac{1}{\\Delta x}\\frac{\\partial}{\\partial u}\\Bigl(\\frac{q^2\\Delta x}{2\\epsilon_0}u(1-u)\\Bigr)$$  \n$$\\;=\\;-\\,\\frac{q^2}{2\\epsilon_0}(1-2u)\n=\\frac{q^2}{2\\epsilon_0}(2u-1).$$  \n\n平方并在 $u\\in[0,1]$ 上求平均值：  \n$$F_{self}^2=\\frac{q^4}{4\\epsilon_0^2}(2u-1)^2,$$  \n$$\\langle F^2\\rangle=\\int_0^1\\frac{q^4}{4\\epsilon_0^2}(2u-1)^2\\,du\n=\\frac{q^4}{4\\epsilon_0^2}\\int_0^1(4u^2-4u+1)\\,du\n=\\frac{q^4}{4\\epsilon_0^2}\\cdot\\frac{1}{3}.$$\n\n因此，RMS自作用力为  \n$$F_{RMS}=\\sqrt{\\langle F^2\\rangle}\n=\\frac{q^2}{2\\epsilon_0}\\sqrt{\\frac{1}{3}}\n=\\frac{q^2}{2\\sqrt{3}\\,\\epsilon_0}.$$", "answer": "$$\\boxed{\\frac{q^2}{2\\sqrt{3}\\,\\epsilon_0}}$$", "id": "296780"}, {"introduction": "PIC模拟的物理保真度在很大程度上取决于数值方案的审慎选择。具体而言，将电荷分配到网格的方案与将力插值回粒子的方案之间必须相互兼容。本问题探讨了一个使用不匹配方案的假想情景：使用最近格点法（NGP）进行电荷分配，但使用云中粒子法（CIC）进行力插值。通过推导由此产生的粒子间相互作用力 [@problem_id:296781]，您将看到这种选择如何打破作用力与反作用力的对称性，从而导致动量守恒定律的破坏。", "problem": "在质点网格法（PIC）代码的开发中，理解宏观粒子之间的离散力至关重要，因为它们可能与真实的库仑力有显著差异，尤其是在短程情况下。本问题探讨了一种非标准的混合PIC方案中的粒子间作用力。\n\n考虑一个具有无限域和均匀网格（间距为 $\\Delta x$）的一维静电模拟环境。网格点位于 $X_j = j \\Delta x$（其中 $j$ 为整数）的位置。数值方案定义如下：\n\n1.  **电荷分配：** 使用最近网格点（NGP）法将宏观粒子的电荷分配到计算网格上。一个位于位置 $x_p$、电荷为 $q_p$ 的粒子将其全部电荷贡献给唯一的最近网格点。\n2.  **场求解：** 通过求解一维有限差分泊松方程来确定每个网格点上的静电势 $\\phi_j$：\n    $$\n    \\frac{\\phi_{j+1} - 2\\phi_j + \\phi_{j-1}}{(\\Delta x)^2} = -\\frac{\\rho_j}{\\epsilon_0}\n    $$\n    其中 $\\rho_j$ 是网格点 $j$ 处的电荷密度，$\\epsilon_0$ 是真空介电常数。对于无限域中的一个孤立电荷，势在无穷远处取为零。然后使用中心差分公式计算网格上的电场：\n    $$\n    E_j = -\\frac{\\phi_{j+1} - \\phi_{j-1}}{2 \\Delta x}\n    $$\n3.  **力插值：** 粒子上的力是通过从包围该粒子的两个网格点的电场进行线性插值来计算的。这等效于使用云中粒子（CIC）形函数来收集力。具体来说，对于一个位于网格点 $X_J$ 和 $X_{J+1}$ 之间的位置 $x_p$ 的粒子，其受力为 $F_p = q_p E(x_p)$，其中插值电场 $E(x_p)$ 为：\n    $$\n    E(x_p) = E_J \\left(1 - \\frac{x_p - X_J}{\\Delta x}\\right) + E_{J+1} \\left(\\frac{x_p - X_J}{\\Delta x}\\right)\n    $$\n\n**问题：**\n一个电荷为 $Q_1$ 的宏观粒子固定在原点 $x_1 = 0$。第二个电荷为 $Q_2$ 的宏观粒子放置在位置 $x_2=d$ 处，其中 $0  d  \\Delta x$。推导粒子1对粒子2施加的力 $F_{1\\to2}$，并将其表示为粒子间距 $d$ 和网格间距 $\\Delta x$ 的函数。", "solution": "1. 电荷分配：位于 $x_1=0$、电荷为 $Q_1$ 的粒子1将其全部电荷分配给网格点 $j=0$，因此 $\\rho_j = Q_1\\,\\delta_{j,0}/\\Delta x$。\n\n2. 无限一维网格上电势 $\\phi_j$ 的离散泊松方程为，\n$$\n\\frac{\\phi_{j+1}-2\\phi_j+\\phi_{j-1}}{(\\Delta x)^2} \\;=\\; -\\frac{\\rho_j}{\\epsilon_0}\n\\;\\Longrightarrow\\;\n\\phi_{j+1}-2\\phi_j+\\phi_{j-1} \\;=\\;-\\,\\frac{Q_1\\,\\Delta x}{\\epsilon_0}\\,\\delta_{j,0}.\n$$\nAnsatz 对称性意味着\n$$\n\\phi_j = C - \\alpha\\,|j|,\\quad\n\\phi_{j+1}-2\\phi_j+\\phi_{j-1} = -2\\alpha\\,\\delta_{j,0}\n\\;\\;\\Rightarrow\\;\\;\n\\alpha = \\frac{Q_1\\,\\Delta x}{2\\,\\epsilon_0}.\n$$\n\n3. 通过中心差分计算网格上的电场，\n$$\nE_j = -\\frac{\\phi_{j+1}-\\phi_{j-1}}{2\\,\\Delta x}.\n$$\n对于 $j=0$，$\\phi_{1}=\\phi_{-1}$，因此 $E_0=0$。对于 $j=1$，\n$$\\phi_{2}-\\phi_{0}=(C-2\\alpha)-C =-2\\alpha \\;\\Longrightarrow\\; E_1 = -\\frac{-2\\alpha}{2\\Delta x} = \\frac{\\alpha}{\\Delta x} = \\frac{Q_1}{2\\epsilon_0}.$$\n\n4. 对位于 $j=0$ 和 $j=1$ 之间，$x_2=d\\in(0,\\Delta x)$ 的粒子2进行力插值（CIC），\n$$\nE(x_2) = E_0\\Bigl(1-\\frac{d}{\\Delta x}\\Bigr)+E_1\\frac{d}{\\Delta x}\n=0\\cdot\\Bigl(1-\\tfrac{d}{\\Delta x}\\Bigr)+\\frac{Q_1}{2\\epsilon_0}\\frac{d}{\\Delta x}\n=\\frac{Q_1\\,d}{2\\epsilon_0\\,\\Delta x}.\n$$\n因此，粒子2受到的力为\n$$\nF_{1\\to2} \\;=\\; Q_2\\,E(x_2)\n\\;=\\;\\frac{Q_1\\,Q_2\\,d}{2\\,\\epsilon_0\\,\\Delta x}.\n$$", "answer": "$$\\boxed{\\frac{Q_1\\,Q_2\\,d}{2\\,\\epsilon_0\\,\\Delta x}}$$", "id": "296781"}]}