## 引言
在流行病学及其他定量研究领域，失访（loss to follow-up）是一个普遍存在且极具挑战性的问题。当研究对象在随访期间因各种原因脱离研究，并且这种脱离与他们的暴露状态或结局风险有关时，就会产生一种被称为“失访偏倚”的系统性误差，严重威胁研究结论的内部有效性。若不加以妥善处理，研究者可能会得出关于暴露与疾病关系（例如，某项治疗的真实效果）的错误结论，从而误导未来的公共卫生政策或临床实践。本文旨在为读者提供一个关于失访偏倚的全面理论框架和分析指南。

本文的核心问题是：我们如何从根本上理解失访偏倚的产生机制，并在数据分析中对其进行有效的识别与校正？为了回答这个问题，我们将分三个章节展开探讨。在第一章“原理与机制”中，我们将借助因果推断的语言，形式化地定义失访偏倚，阐明其与选择偏倚的关系，并介绍用以区分不同缺失情况的经典分类框架。此外，我们将利用有向无环图（DAGs）这一强大的工具，直观地揭示偏倚产生的复杂路径。第二章“应用与跨学科联系”将理论付诸实践，通过临床试验、[观察性研究](@entry_id:174507)等真实场景，展示如何预防和分析性地校正失访，并讨论了处理时变混杂、竞争风险等复杂问题的先进方法，如逆概率加权（IPW）和边际结构模型。最后，在“动手实践”部分，我们将通过一系列精心设计的练习，引导您亲手计算偏倚、评估其影响，并学习如何通过[敏感性分析](@entry_id:147555)来量化研究结论的不确定性。

通过学习本文，您将不仅能够识别研究中的失访问题，更将掌握一套分析和批判性评估相关证据的系统性方法。现在，让我们从失访偏倚的根本原理开始。

## 原理与机制

我们在引言中简要提及了队列研究中失访（loss to follow-up）的基本概念及其对研究有效性的潜在威胁。本章将深入探讨失访偏倚的根本原理与作用机制。我们将运用潜在结局（potential outcomes）的因果推断框架，精确定义选择偏倚（selection bias），并介绍一个用以分类不同失访机制的理论框架。此外，我们将借助有向无环图（Directed Acyclic Graphs, DAGs）这一可视化工具，剖析偏倚产生的复杂路径，并阐明在何种条件下，失访偏倚可以被有效控制。最后，我们将讨论一些更为复杂的场景，例如时变混杂因素（time-varying confounders）的存在，以及当关键假设不成立时，我们应如何通过敏感性分析（sensitivity analysis）来评估研究结论的稳健性。

### 选择偏倚的形式化定义

要从根本上理解失访偏倚，我们必须首先区分研究旨在估计的目标参数（target parameter）与我们在存在数据缺失的情况下实际能够计算的量。在一个典型的队列研究中，我们感兴趣的目标是比较暴露组与非暴露组之间结局的差异。假设有一个二元暴露 $A$（$1$ 为暴露，$0$ 为未暴露）和一个二元结局 $Y$（$1$ 为发生，$0$ 为未发生）。我们真正的目标是估计**平均因果效应**（Average Causal Effect, ACE），例如平均因果风险差（average causal risk difference, RD）：

$$RD^{\ast} \equiv \mathbb{E}[Y(1)] - \mathbb{E}[Y(0)]$$

这里，$Y(a)$ 表示在（可能与事实相反的）暴露水平 $a$ 下的**潜在结局**。$\mathbb{E}[Y(a)]$ 代表了在整个目标人群中，假如所有人都被分配到暴露水平 $a$ 时，结局的平均风险。

然而，由于失访的存在，结局 $Y$ 并非对所有研究对象都可知。我们可以引入一个选择指示变量 $S$，其中 $S=1$ 表示研究对象被成功随访并观察到结局，而 $S=0$ 表示该对象失访。因此，我们的分析被迫局限于 $S=1$ 的这个子群体，即所谓的**完整病例（complete cases）**。在此子群体中，我们能够计算的是**完整病例风险差**：

$$RD_{\text{cc}} \equiv \mathbb{E}[Y \mid A=1, S=1] - \mathbb{E}[Y \mid A=0, S=1]$$

失访偏倚的根本来源，就在于 $\mathbb{E}[Y \mid A=a, S=1]$（在完整病例中观察到的暴露组特有风险）与 $\mathbb{E}[Y(a)]$（我们真正关心的因果目标）之间的差异。在满足一致性（consistency）假设（即对任意接受了暴露 $A=a$ 的个体，其观察结局 $Y$ 等于其潜在结局 $Y(a)$）的前提下，我们有 $\mathbb{E}[Y \mid A=a] = \mathbb{E}[Y(a) \mid A=a]$。如果暴露分配是随机的（即 $Y(a) \perp A$），那么 $\mathbb{E}[Y(a) \mid A=a] = \mathbb{E}[Y(a)]$。但在[观察性研究](@entry_id:174507)中，通常存在混杂因素，我们需要假设在给定基线协变量 $X$ 的条件下，暴露分配是可交换的（exchangeable），即 $Y(a) \perp A \mid X$。

失访偏倚的产生，本质上是因为选择过程 $S$ 本身与结局 $Y$ 相关。当 $S=1$ 这个子群体的结局分布不同于整个目标人群时，偏倚就产生了。更精确地说，对于某个暴露水平 $a$，偏倚项是 $\mathbb{E}[Y \mid A=a, S=1] - \mathbb{E}[Y \mid A=a]$。这个差值不为零，当且仅当在给定暴露 $A$ 和协变量 $X$ 后，选择变量 $S$ 与结局 $Y$ 依然存在统计学关联，即 $S \not\perp Y \mid A, X$。从因果角度看，这意味着选择过程与潜在结局相关，即 $S \not\perp Y(a) \mid X$  。

### 失访机制的分类

为了系统地讨论失访问题，流行病学家和统计学家将数据缺失机制分为三类。这个分类框架对于理解失访偏倚的来源以及选择合适的分析策略至关重要。设 $L$ 为基线测量的协变量向量。

1.  **[完全随机缺失](@entry_id:170286) (Missing Completely at Random, MCAR)**: MCAR 是最强的假设，它要求失访的概率与研究中的任何变量（包括暴露 $A$、结局 $Y$ 和协变量 $L$）都无关。形式上，这意味着选择指示变量 $S$ 与 $(Y, A, L)$ 完全独立：
    $$S \perp (Y, A, L)$$
    在这种理想情况下，完整病例构成总样本的一个完全随机的子样本。因此，除了样本量减小导致统计精度下降外，对完整病例进行分析不会引入系统性的选择偏倚。

2.  **[随机缺失](@entry_id:168632) (Missing at Random, MAR)**: MAR 是一个较弱且在实践中更为核心的假设。它要求失访的概率可以依赖于**已观测到**的变量（如暴露 $A$ 和协变量 $L$），但在控制了这些已观测变量后，失访概率与**未观测到**的结局 $Y$ 无关。形式上，这意味着在给定 $(A, L)$ 的条件下，$S$ 与 $Y$ 相互独立：
    $$S \perp Y \mid (A, L)$$
    这等价于 $P(S=1 \mid Y, A, L) = P(S=1 \mid A, L)$。例如，如果暴露组（$A=1$）的患者比未暴露组（$A=0$）的患者更容易失访，但这种差异在每个 $(A,L)$ 亚组内部与患者未来的结局 $Y$ 无关，那么数据就满足 MAR。在 MAR 假设下，直接进行完整病例分析通常仍会产生偏倚，但通过对 $(A, L)$ 进行恰当的统计学校正（如分层、[回归建模](@entry_id:170726)或加权），我们可以得到对因果效应的无偏估计。

3.  **[非随机缺失](@entry_id:163489) (Missing Not at Random, MNAR)**: MNAR 是指失访的概率即使在控制了所有已观测变量之后，仍然依赖于未观测到的结局值 $Y$。形式上，这意味着条件独立性不成立：
    $$S \not\perp Y \mid (A, L)$$
    例如，病情更严重的患者（他们更有可能出现不良结局 $Y=1$）无论其暴露或基线特征如何，都更有可能因健康状况不佳而退出研究。在这种情况下，完整病例中的个体系统性地比失访个体更为健康，导致严重的选择偏倚。在 MNAR 机制下，仅利用已观测数据，通常无法得到因果效应的[无偏估计](@entry_id:756289)，除非引入额外的、无法被数据验证的假设或外部信息 。

### 利用[有向无环图](@entry_id:164045)（DAGs）理解偏倚机制

有向无环图（DAGs）为我们提供了强大的可视化工具，帮助我们直观地理解失访偏倚的产生和控制机制。在 DAG 中，节点代表变量，箭头代表直接因果关系。选择[指示变量](@entry_id:266428) $S$ 被视为图中的一个节点，对完整病例进行分析等价于在分析中对 $S=1$ 进行**“控制”**或**“分层”**。

根据 DAG 的 [d-分离](@entry_id:748152)（d-separation）法则，控制一个变量可能会打开或关闭变量间的关联路径。失访偏倚通常通过两种主要机制产生：

**机制一：[对撞偏倚](@entry_id:163186)（Collider Bias）**

当选择变量 $S$ 是两个或多个变量的共同效应（即**对撞节点**，collider）时，控制 $S$ 会打开其父节点之间的非因果关联路径。这是一个极其重要且违反直觉的偏倚来源。

一个典型的例子是，失访可能同时受暴露（或与暴露相关的因素）和结局（或与结局相关的未测量因素）的影响。例如，假设存在一个未测量的变量 $U$（如个体对健康的重视程度），它既影响结局 $Y$，也影响是否坚持随访 $S$。这在 DAG 中表示为 $Y \leftarrow U \rightarrow S$。同时，暴露 $A$ 也可能影响失访，例如，服用某种药物的副作用可能导致患者退出研究（$A \rightarrow S$）。此时，$S$ 是一个对撞节点（在 $A \rightarrow S \leftarrow U$ 路径上）。当我们仅分析 $S=1$ 的人群时，就等于控制了这个对撞节点，从而在 $A$ 和 $U$ 之间打开了一条虚假的关联。这条新打开的路径 $A \text{---} U \rightarrow Y$ 是一条非因果的后门路径，它会扭曲 $A$ 与 $Y$ 之间的真实因果关系，从而产生偏倚。

一个更微妙但同样重要的例子是，即使失访机制本身满足 MAR，不恰当的分析策略也可能通过[对撞偏倚](@entry_id:163186)引入失访偏倚。考虑一个情景，其中失访 $C$ 仅依赖于基线协变量 $L$（$L \rightarrow C$），而结局 $Y$ 受 $L$ 和一个受暴露 $A$ 影响的治疗中期变量 $M$（如生物标志物）共同影响（$A \rightarrow M \leftarrow L$ 和 $M \rightarrow Y$）。在这种情况下，失访最初是“无害的”（在给定 $L$ 的条件下，与潜在结局无关，即 $C \perp Y^a \mid L$）。然而，如果分析师决定在完整病例中控制中期变量 $M$，问题就出现了。$M$ 是一个对撞节点（$A \rightarrow M \leftarrow L$）。控制 $M$ 会在 $A$ 和 $L$ 之间打开一条非因果关联。由于 $L$ 同时是 $C$ 和 $Y$ 的[共同原因](@entry_id:266381)，这种新产生的关[联会](@entry_id:139072)进一步在 $C$ 和 $Y$ 之间构建出一条虚假的、依赖于 $M$ 的统计学联系。计算表明，在 $M=1$ 的亚组中，被审查者($C=1$)和未被审查者($C=0$)的结局风险不再相同，这意味着审查（失访）变得有信息量了。这清晰地说明，即使失访机制本身是 MAR，对受暴露影响的中间变量进行调整也可能诱发选择偏倚。

**机制二：未控制的[共同原因](@entry_id:266381)**

当失访 $S$ 和结局 $Y$ 存在一个未被测量的共同原因 $U$（即 $Y \leftarrow U \rightarrow S$）时，即使控制了所有已测量的协变量 $L$，这条通过 $U$ 的后门路径依然存在，导致 $S$ 和 $Y$ 在给定 $L$ 的情况下仍然相关。这就是典型的 MNAR 情形，仅靠已观测数据无法消除偏倚 。

反之，DAGs 也能帮助我们识别**不**产生偏倚的情形。一个常见的误解是，任何差异性失访（即失访率在暴露组和非暴露组间不同）都会导致偏倚。然而，这并不总是正确的。考虑一个 DAG ，其中暴露 $A$ 既影响结局 $Y$（$A \rightarrow Y$），也影响失访 $S$（$A \rightarrow S$），同时存在一个共同的混杂因素 $L$（$L \rightarrow A, L \rightarrow Y$）。在这种结构下，只要失访 $S$ 不受结局 $Y$ 或任何与 $Y$ 和 $S$ 都有关的未测量因素影响，那么在分析中控制混杂因素 $L$ 就足以得到[无偏估计](@entry_id:756289)。使用 [d-分离](@entry_id:748152)法则可以验证，在给定 $(A, L)$ 的条件下，$S$ 与 $Y$ 是 [d-分离](@entry_id:748152)的，即 $S \perp Y \mid (A, L)$。这满足了 MAR 条件，因此，尽管失访率依赖于暴露 $A$，但基于完整病例并进行恰当的混杂控制的分析依然是有效的。

### 识别与校正策略

当数据满足 MAR 假设时，我们有多种策略可以获得因果效应的[无偏估计](@entry_id:756289)。这些策略的核心都是利用已观测数据 $(A, L)$ 来校正因选择 $(S=1)$ 过程引入的偏倚。这需要满足以下三个核心的**可识别性（identifiability）**条件：

1.  **一致性 (Consistency)**: 对于被观察到的个体（$S=1$），其在实际暴露水平 $A=a$ 下的观察结局 $Y$ 等于其潜在结局 $Y^a$。
2.  **条件可交换性 (Conditional Exchangeability)**: 这包括两个部分：
    *   **对暴露的[交换性](@entry_id:140240)**：给定基线协变量 $L$，潜在结局与实际接受的暴露无关，即 $Y^a \perp A \mid L$。这是控制混杂的标准假设。
    *   **对选择的[交换性](@entry_id:140240)**：给定基线协变量 $L$ 和暴露 $A$，潜在结局与是否被观察到无关，即 $Y^a \perp S \mid (A, L)$。这等价于我们之前讨论的 MAR 假设 ($S \perp Y \mid A,L$)。
3.  **正性 (Positivity)**: 对于所有具有非零概率的协变量组合 $L=\ell$，每个暴露水平和被观察到的概率都必须大于零，即 $\Pr(A=a \mid L=\ell) > 0$ 和 $\Pr(S=1 \mid A=a, L=\ell) > 0$。

在这些条件下，我们可以证明：
$$\mathbb{E}[Y^a] = \mathbb{E}_{L} \left\{ \mathbb{E}[Y \mid A=a, L, S=1] \right\}$$
这个公式被称为**标准化（standardization）**或 **g-公式（g-formula）**。它的直观含义是：我们在完整病例数据中，计算出每个 $(A,L)$ 亚组内的结局风险 $\mathbb{E}[Y \mid A=a, L, S=1]$，然后以整个目标人群（基线队列）的协变量 $L$ 分布为权重，对这些风险进行加权平均。这样得到的便是对因果参数 $\mathbb{E}[Y^a]$ 的无偏估计。

另一种广泛应用的策略是**[逆概率](@entry_id:196307)加权（Inverse Probability Weighting, IPW）**。在存在失访偏倚时，该方法被称为**逆审查概率加权（Inverse Probability of Censoring Weighting, IPCW）**。其核心思想是，为每个被成功随访的个体（$S=1$）赋予一个权重，该权重等于其被随访概率的倒数，即 $w = 1 / P(S=1 \mid A, L)$。通过这种加权，我们可以创建一个“伪人群”，在这个伪人群中，那些与失访者特征相似但被成功随访的个体的权重被放大，从而在统计上重建了完整的基线队列。这种方法在生存分析中尤其重要，用于处理所谓的**依赖性审查（dependent censoring）**。当事件时间 $T$ 与审查时间 $C$ 在给定协变量 $L$ 的条件下独立时（$T \perp C \mid L$），IPCW 就能提供对生存函数的无偏估计。

### 复杂情况与敏感性分析

**时变混杂因素**

在许多纵向研究中，情况会变得更加复杂。协变量 $L_t$ 会随时间 $t$ 变化，并且可能既是过去暴露 $A_{t-1}$ 的一个后果，又是未来暴露 $A_t$ 的一个原因。这类变量被称为**受过去暴露影响的时变混杂因素**。在这种情况下，使用传统的[回归模型](@entry_id:163386)对完整病例进行分析，即使数据满足 MAR，也会导致严重的偏倚。

偏倚的产生有两个原因：第一，如前所述，对失访（一个对撞节点）进行限制，会打开暴露历史与结局之间的非因果路径；第二，在回归模型中直接控制 $L_t$ 会阻断过去暴露 $A_{t-1}$ 通过 $L_t$ 影响结局的因果路径，这是一种对中间变量的过度调整。要正确处理这种情况，需要使用更高级的因果推断方法，如边际结构模型（Marginal Structural Models）结合 IPCW，或 g-公式。

**应对[非随机缺失](@entry_id:163489)（MNAR）**

MAR 假设是美好但无法被数据直接检验的。在实际应用中，我们总要担心数据可能属于 MNAR。当失访机制为 MNAR 时，上述基于 MAR 的校正方法（如标准化、IPW、或标准的[多重插补](@entry_id:177416)）都会失效并产生偏倚。

例如，在使用**[多重插补](@entry_id:177416)（Multiple Imputation, MI）**时，MAR 假设意味着我们可以用来自完整病例的数据分布 $P(Y \mid X, A, R=1)$ 来为缺失病例（$R=0$）插补结局值。但在 MNAR 情况下，由于 $P(Y \mid X, A, R=0) \neq P(Y \mid X, A, R=1)$，这种[插补](@entry_id:270805)将是系统性错误的。

面对这种不可知性，严谨的研究者会进行**敏感性分析**。敏感性分析的目的不是“解决”MNAR 问题，而是量化研究结论对不同程度的 MNAR 偏倚的“敏感”程度。这通常通过引入一个或多个**敏感性参数**来实现，这些参数明确地描述了对 MAR 假设的偏离程度。

一个常见的敏感性分析框架是**[模式混合](@entry_id:197206)模型（pattern-mixture model）**。例如，对于一个二元结局，我们可以假设缺失组的结局对数几率（log-odds）与观察组的结局对数几率之间存在一个固定的差值 $\Delta$：

$$\text{logit}\{P(Y=1 \mid X, A, R=0)\} = \text{logit}\{P(Y=1 \mid X, A, R=1)\} + \Delta$$

这里的 $\Delta$ 就是敏感性参数。当 $\Delta=0$ 时，模型就退化为 MAR 假设。通过让 $\Delta$ 在一个被认为合理（基于领域知识）的范围内变化（例如，从 -1 到 1），研究者可以评估其主要结论（如暴露的因果效应）是否会发生质的改变。如果结论在很大的 $\Delta$ 范围内都保持不变，则称该结论对 MNAR 偏倚是**稳健的（robust）**。反之，如果结论对 $\Delta$ 的微小变动都极其敏感，则我们应对该结论持谨慎态度。

总之，失访偏倚是流行病学研究中的一个核心挑战。通过运用因果推断的原理和工具，我们可以精确地理解其机制，并在特定假设下进行校正。然而，同样重要的是，我们需要认识到这些假设的局限性，并通过敏感性分析等方法，审慎地评估我们研究结论的可靠性。