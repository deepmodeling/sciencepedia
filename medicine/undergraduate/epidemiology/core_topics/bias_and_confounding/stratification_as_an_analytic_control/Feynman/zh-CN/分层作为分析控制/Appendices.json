{
    "hands_on_practices": [
        {
            "introduction": "在流行病学研究中，未经调整的粗略分析有时会得出与事实完全相反的误导性结论。这种现象，即著名的辛普森悖论，凸显了控制混杂因素的重要性。本练习将通过一个案例对照研究的实例，带您亲手揭示这种悖论，并演示如何运用分层分析来校正混杂效应，从而得到一个与粗略分析截然不同、但更为真实的关联度量 。通过计算分层和汇总的比值比，您将深刻理解为何分层是揭示潜在真相的关键分析工具。",
            "id": "4638397",
            "problem": "一项病例对照研究评估了暴露 $A$ 与二元结局 $D$ 之间的关联，而第三个变量 $C$ 表示基线严重程度，并定义了两个分层：$C=0$（轻度）和 $C=1$（重度）。将 $C$ 视为一个潜在的混杂因素，通过分层进行控制。观测到的各分层特定的 $2 \\times 2$ 格子计数如下：\n\n- 分层 $C=0$（轻度）：\n  - 暴露组 ($A=1$)：$D=1$ 病例 $=2$，$D=0$ 非病例 $=48$。\n  - 非暴露组 ($A=0$)：$D=1$ 病例 $=24$，$D=0$ 非病例 $=276$。\n\n- 分层 $C=1$（重度）：\n  - 暴露组 ($A=1$)：$D=1$ 病例 $=270$，$D=0$ 非病例 $=180$。\n  - 非暴露组 ($A=0$)：$D=1$ 病例 $=35$，$D=0$ 非病例 $=15$。\n\n仅使用样本比值、比值比、分层以及经过充分检验的用于合并各分层的 Mantel–Haenszel 方法的基本定义，完成以下任务：\n\n- 计算分层 $C=0$ 和 $C=1$ 的特定比值比。\n- 合并各分层的数据，并计算忽略 $C$ 的粗略比值比。\n- 证明粗略关联与分层特定关联的方向相反。\n- 计算跨两个分层的 Mantel–Haenszel 合并比值比。\n- 根据给定数据计算 $P(C=1 \\mid A=1)$ 和 $P(C=1 \\mid A=0)$，并简要解释当忽略 $C$ 时，它们的差异如何导致了关联方向的反转。\n\n将 Mantel–Haenszel 合并比值比作为一个十进制数报告为你的最终答案。将答案四舍五入到四位有效数字。以小数形式表示最终答案。",
            "solution": "问题陈述经核实具有科学依据、提法得当且客观。这是一个关于混杂和分层的标准流行病学问题，使用了既定的定义和方法。所有必要的数据均已提供，问题明确无歧义。\n\n我们得到来自一项按变量 $C$ 分层的病例对照研究的数据。设 $i$ 为分层指数，其中 $i=0$ 代表 $C=0$（轻度），$i=1$ 代表 $C=1$（重度）。对于每个分层 $i$，数据可以整理成一个 $2 \\times 2$ 表格：\n\n| | 病例 ($D=1$) | 非病例 ($D=0$) |\n|---|---|---|\n| 暴露组 ($A=1$) | $a_i$ | $b_i$ |\n| 非暴露组 ($A=0$) | $c_i$ | $d_i$ |\n\n分层 $i$ 的样本比值比由 $OR_i = \\frac{a_i d_i}{b_i c_i}$ 给出。\n\n**第1步：计算各分层特定的比值比。**\n\n对于分层 $C=0$（轻度）：\n格子计数为 $a_0 = 2$，$b_0 = 48$，$c_0 = 24$ 和 $d_0 = 276$。\n该分层特定的比值比为：\n$$OR_{C=0} = \\frac{a_0 d_0}{b_0 c_0} = \\frac{2 \\times 276}{48 \\times 24} = \\frac{552}{1152} \\approx 0.4792$$\n约 $0.48$ 的比值比表明，在轻度严重组中，暴露 $A$ 与结局 D 的比值降低相关联。\n\n对于分层 $C=1$（重度）：\n格子计数为 $a_1 = 270$，$b_1 = 180$，$c_1 = 35$ 和 $d_1 = 15$。\n该分层特定的比值比为：\n$$OR_{C=1} = \\frac{a_1 d_1}{b_1 c_1} = \\frac{270 \\times 15}{180 \\times 35} = \\frac{4050}{6300} = \\frac{9}{14} \\approx 0.6429$$\n约 $0.64$ 的比值比表明，在重度严重组中，暴露 $A$ 也与结局 D 的比值降低相关联。\n\n**第2步：计算粗略比值比。**\n\n为了计算粗略比值比，我们通过将两个分层的格子计数相加来合并数据。\n$a_{crude} = a_0 + a_1 = 2 + 270 = 272$\n$b_{crude} = b_0 + b_1 = 48 + 180 = 228$\n$c_{crude} = c_0 + c_1 = 24 + 35 = 59$\n$d_{crude} = d_0 + d_1 = 276 + 15 = 291$\n\n粗略的 $2 \\times 2$ 表格如下：\n\n| | 病例 ($D=1$) | 非病例 ($D=0$) |\n|---|---|---|\n| 暴露组 ($A=1$) | $272$ | $228$ |\n| 非暴露组 ($A=0$) | $59$ | $291$ |\n\n粗略比值比为：\n$$OR_{crude} = \\frac{a_{crude} d_{crude}}{b_{crude} c_{crude}} = \\frac{272 \\times 291}{228 \\times 59} = \\frac{79152}{13452} \\approx 5.884$$\n\n**第3步：证明关联反转。**\n\n各分层特定的比值比为 $OR_{C=0} \\approx 0.48$ 和 $OR_{C=1} \\approx 0.64$。两者都小于 $1$，表明在每个分层内，暴露 $A$ 和结局 $D$ 之间存在保护性关联。\n然而，粗略比值比为 $OR_{crude} \\approx 5.88$，远大于 $1$。这表明存在强烈的有害关联。\n当数据被合并且分层变量 $C$ 被忽略时，关联的方向发生了反转。这种现象是辛普森悖论的一个例子，它是由混杂引起的。\n\n**第4步：计算 Mantel–Haenszel 合并比值比。**\n\n用于计算跨分层的公共比值比的 Mantel–Haenszel 估计量由以下公式给出：\n$$OR_{MH} = \\frac{\\sum_{i} \\frac{a_i d_i}{n_i}}{\\sum_{i} \\frac{b_i c_i}{n_i}}$$\n其中 $n_i$ 是分层 $i$ 中的受试者总数 ($n_i = a_i + b_i + c_i + d_i$)。\n\n对于分层 $C=0$：\n$n_0 = 2 + 48 + 24 + 276 = 350$。\n$\\frac{a_0 d_0}{n_0} = \\frac{2 \\times 276}{350} = \\frac{552}{350}$。\n$\\frac{b_0 c_0}{n_0} = \\frac{48 \\times 24}{350} = \\frac{1152}{350}$。\n\n对于分层 $C=1$：\n$n_1 = 270 + 180 + 35 + 15 = 500$。\n$\\frac{a_1 d_1}{n_1} = \\frac{270 \\times 15}{500} = \\frac{4050}{500}$。\n$\\frac{b_1 c_1}{n_1} = \\frac{180 \\times 35}{500} = \\frac{6300}{500}$。\n\n现在，我们计算 $OR_{MH}$：\n$$OR_{MH} = \\frac{\\frac{552}{350} + \\frac{4050}{500}}{\\frac{1152}{350} + \\frac{6300}{500}} = \\frac{\\frac{552 \\times 10 + 4050 \\times 7}{3500}}{\\frac{1152 \\times 10 + 6300 \\times 7}{3500}} = \\frac{5520 + 28350}{11520 + 44100} = \\frac{33870}{55620} = \\frac{3387}{5562}$$\n$$OR_{MH} \\approx 0.60898957...$$\nMantel-Haenszel 合并比值比提供了一个关联的汇总度量，校正了 $C$ 的混杂效应。其值与各分层特定的比值比一致。\n\n四舍五入到四位有效数字，$OR_{MH} \\approx 0.6090$。\n\n**第5步：使用 $C$ 的概率解释反转现象。**\n\n这种反转是由于 $C$ 是一个混杂因素。混杂因素是与暴露（$A$）和结局（$D$）都相关联的变量，在未被控制时会扭曲 $A-D$ 之间的关系。\n1. **$C$ 与 $A$（暴露）之间的关联：** 我们计算在给定暴露状态下，处于重度分层（$C=1$）的概率。\n    - 暴露组受试者总数 ($A=1$)： $(a_0 + b_0) + (a_1 + b_1) = (2+48) + (270+180) = 50 + 450 = 500$。\n    - 在分层 $C=1$ 中的暴露组受试者数量： $a_1 + b_1 = 270 + 180 = 450$。\n    - $P(C=1 \\mid A=1) = \\frac{450}{500} = 0.9$。\n    - 非暴露组受试者总数 ($A=0$)： $(c_0 + d_0) + (c_1 + d_1) = (24+276) + (35+15) = 300 + 50 = 350$。\n    - 在分层 $C=1$ 中的非暴露组受试者数量： $c_1 + d_1 = 35 + 15 = 50$。\n    - $P(C=1 \\mid A=0) = \\frac{50}{350} = \\frac{1}{7} \\approx 0.143$。\n$C$ 和 $A$ 之间存在强关联：暴露个体比非暴露个体更有可能处于重度分层（$90\\%$ vs $14.3\\%$）。\n\n2. **$C$ 与 $D$（结局）之间的关联：** 在每个暴露水平内，分层 $C=1$ 中结局 $D$ 的风险要高得多。\n    - 在暴露组（$A=1$）中：对于 $C=1$，患病比值为 $\\frac{a_1}{b_1} = \\frac{270}{180} = 1.5$，而对于 $C=0$，患病比值为 $\\frac{a_0}{b_0} = \\frac{2}{48} \\approx 0.042$。\n    - 在非暴露组（$A=0$）中：对于 $C=1$，患病比值为 $\\frac{c_1}{d_1} = \\frac{35}{15} \\approx 2.33$，而对于 $C=0$，患病比值为 $\\frac{c_0}{d_0} = \\frac{24}{276} \\approx 0.087$。\n在这两种情况下，重度分层（$C=1$）中的个体成为病例的比值要高得多。\n\n**关于反转的结论：** 粗略分析具有误导性，因为它比较的是一个主要由重度分层构成的暴露组和一个主要由轻度分层构成的非暴露组。粗略分析中暴露组的高患病风险主要是由其中 $90\\%$ 的人处于高风险的‘重度’分层这一事实驱动的，而不是暴露本身具有有害效应。分层控制了这种不平衡，揭示了在每个分层内暴露的真实保护性质。$P(C=1 \\mid A=1)$ 和 $P(C=1 \\mid A=0)$ 之间的巨大差异是这种混杂的量化来源。\n\n要求的最终答案是 Mantel-Haenszel 合并比值比，四舍五入到四位有效数字。\n$OR_{MH} = \\frac{3387}{5562} \\approx 0.6090$。",
            "answer": "$$\n\\boxed{0.6090}\n$$"
        },
        {
            "introduction": "在通过分层控制了混杂之后，我们常会发现暴露与结局之间的关联强度在不同的人群亚组（即“层”）中并不一致，这种现象被称为效应修饰。更有趣的是，效应修饰的存在与否可能取决于我们选择的度量标尺（例如，加性标尺或乘性标尺）。本练习将引导您为不同年龄分层的人群计算风险差（$RD$）和风险比（$RR$），并量化比较效应在这两种标尺上的异质性 。这个实践将帮助您掌握识别和解释效应修饰的技能，这是流行病学数据分析中一项精妙而关键的能力。",
            "id": "4638407",
            "problem": "一项队列研究旨在探究在为期 $5$ 年的随访中，膳食暴露 $E$（高钠饮食）与二元健康结局 $D$（新发高血压）之间的关联。为了使用分层法作为分析控制手段来控制基线年龄（其可能混淆该关联），将人群划分为三个年龄分层：$i=1$ 为 $20$–$39$ 岁，$i=2$ 为 $40$–$59$ 岁，以及 $i=3$ 为 $60$–$79$ 岁。在每个分层 $i$ 中，构建一个包含计数 $(a_i,b_i,c_i,d_i)$ 的 $2\\times 2$ 表格，其中 $a_i$ 是暴露组中出现结局的人数，$b_i$ 是暴露组中未出现结局的人数，$c_i$ 是非暴露组中出现结局的人数，$d_i$ 是非暴露组中未出现结局的人数。观测到的计数如下：\n- 分层 $i=1$：$(a_1,b_1,c_1,d_1) = (48,1200,20,1600)$。\n- 分层 $i=2$：$(a_2,b_2,c_2,d_2) = (90,800,75,1050)$。\n- 分层 $i=3$：$(a_3,b_3,c_3,d_3) = (180,600,210,900)$。\n\n仅使用以下核心定义：(i) 分层 $i$ 内暴露组的风险是暴露组中结局的概率，计算为 $a_i/(a_i+b_i)$，(ii) 分层 $i$ 内非暴露组的风险是非暴露组中结局的概率，计算为 $c_i/(c_i+d_i)$，(iii) 相乘对比是这些风险的比值（分层特异性风险比），以及 (iv) 相加对比是这些风险的差值（分层特异性风险差），计算 $i=1,2,3$ 的分层特异性风险比 $RR_i$ 和风险差 $RD_i$。然后，通过报告分层特异性风险比的自然对数的范围（定义为 $\\max\\{\\ln(RR_i)\\}-\\min\\{\\ln(RR_i)\\}$）和分层特异性风险差的范围（定义为 $\\max\\{RD_i\\}-\\min\\{RD_i\\}$），量化估计效应在乘法尺度与加法尺度上跨分层差异的程度。\n\n将最终答案表示为一个单行矩阵，按顺序包含 $(RR_1, RR_2, RR_3, RD_1, RD_2, RD_3, \\max\\{\\ln(RR_i)\\}-\\min\\{\\ln(RR_i)\\}, \\max\\{RD_i\\}-\\min\\{RD_i\\})$。将所有数值四舍五入至四位有效数字。",
            "solution": "问题陈述已经过验证，被确定为流行病学中一个有效且适定的问题。解答过程如下。\n\n该问题要求计算乘法尺度（风险比，$RR_i$）和加法尺度（风险差，$RD_i$）上的分层特异性效应度量，然后量化这些度量在各分层间的变异性。提供的定义如下：\n- 分层 $i$ 中暴露组的风险：$R_{E_i} = \\frac{a_i}{a_i+b_i}$\n- 分层 $i$ 中非暴露组的风险：$R_{U_i} = \\frac{c_i}{c_i+d_i}$\n- 分层特异性风险比：$RR_i = \\frac{R_{E_i}}{R_{U_i}}$\n- 分层特异性风险差：$RD_i = R_{E_i} - R_{U_i}$\n\n我们将把这些公式应用于三个年龄分层中每一个的数据。\n\n**分层 1 (i=1)：年龄 20–39 岁**\n观测计数为 $(a_1,b_1,c_1,d_1) = (48,1200,20,1600)$。\n暴露组的风险为：\n$$R_{E_1} = \\frac{a_1}{a_1+b_1} = \\frac{48}{48+1200} = \\frac{48}{1248} = \\frac{1}{26} \\approx 0.0384615$$\n非暴露组的风险为：\n$$R_{U_1} = \\frac{c_1}{c_1+d_1} = \\frac{20}{20+1600} = \\frac{20}{1620} = \\frac{1}{81} \\approx 0.0123457$$\n分层特异性风险比为：\n$$RR_1 = \\frac{R_{E_1}}{R_{U_1}} = \\frac{1/26}{1/81} = \\frac{81}{26} \\approx 3.11538$$\n分层特异性风险差为：\n$$RD_1 = R_{E_1} - R_{U_1} = \\frac{1}{26} - \\frac{1}{81} = \\frac{81 - 26}{2106} = \\frac{55}{2106} \\approx 0.0261159$$\n\n**分层 2 (i=2)：年龄 40–59 岁**\n观测计数为 $(a_2,b_2,c_2,d_2) = (90,800,75,1050)$。\n暴露组的风险为：\n$$R_{E_2} = \\frac{a_2}{a_2+b_2} = \\frac{90}{90+800} = \\frac{90}{890} = \\frac{9}{89} \\approx 0.1011236$$\n非暴露组的风险为：\n$$R_{U_2} = \\frac{c_2}{c_2+d_2} = \\frac{75}{75+1050} = \\frac{75}{1125} = \\frac{1}{15} \\approx 0.0666667$$\n分层特异性风险比为：\n$$RR_2 = \\frac{R_{E_2}}{R_{U_2}} = \\frac{9/89}{1/15} = \\frac{135}{89} \\approx 1.51685$$\n分层特异性风险差为：\n$$RD_2 = R_{E_2} - R_{U_2} = \\frac{9}{89} - \\frac{1}{15} = \\frac{135 - 89}{1335} = \\frac{46}{1335} \\approx 0.034457$$\n\n**分层 3 (i=3)：年龄 60–79 岁**\n观测计数为 $(a_3,b_3,c_3,d_3) = (180,600,210,900)$。\n暴露组的风险为：\n$$R_{E_3} = \\frac{a_3}{a_3+b_3} = \\frac{180}{180+600} = \\frac{180}{780} = \\frac{3}{13} \\approx 0.2307692$$\n非暴露组的风险为：\n$$R_{U_3} = \\frac{c_3}{c_3+d_3} = \\frac{210}{210+900} = \\frac{210}{1110} = \\frac{7}{37} \\approx 0.1891892$$\n分层特异性风险比为：\n$$RR_3 = \\frac{R_{E_3}}{R_{U_3}} = \\frac{3/13}{7/37} = \\frac{111}{91} \\approx 1.21978$$\n分层特异性风险差为：\n$$RD_3 = R_{E_3} - R_{U_3} = \\frac{3}{13} - \\frac{7}{37} = \\frac{111 - 91}{481} = \\frac{20}{481} \\approx 0.0415800$$\n\n现在，我们计算范围来量化各分层间效应的异质性。\n\n**风险比自然对数的范围**\n首先，我们使用其未舍入的值计算每个分层特异性风险比的自然对数：\n$$\\ln(RR_1) = \\ln\\left(\\frac{81}{26}\\right) \\approx 1.13642$$\n$$\\ln(RR_2) = \\ln\\left(\\frac{135}{89}\\right) \\approx 0.41659$$\n$$\\ln(RR_3) = \\ln\\left(\\frac{111}{91}\\right) \\approx 0.19869$$\n最大值和最小值为：\n$$\\max\\{\\ln(RR_i)\\} = \\ln(RR_1) \\approx 1.13642$$\n$$\\min\\{\\ln(RR_i)\\} = \\ln(RR_3) \\approx 0.19869$$\n范围是这两个值之间的差：\n$$\\text{Range}_{\\ln(RR)} = \\max\\{\\ln(RR_i)\\} - \\min\\{\\ln(RR_i)\\} \\approx 1.13642 - 0.19869 = 0.93773$$\n\n**风险差的范围**\n分层特异性风险差为：\n$$RD_1 \\approx 0.0261159$$\n$$RD_2 \\approx 0.0344570$$\n$$RD_3 \\approx 0.0415800$$\n最大值和最小值为：\n$$\\max\\{RD_i\\} = RD_3 \\approx 0.0415800$$\n$$\\min\\{RD_i\\} = RD_1 \\approx 0.0261159$$\n范围是这两个值之间的差：\n$$\\text{Range}_{RD} = \\max\\{RD_i\\} - \\min\\{RD_i\\} \\approx 0.0415800 - 0.0261159 = 0.0154641$$\n\n最后，我们将所有需要的数值四舍五入到四位有效数字，以得出最终答案。\n- $RR_1 \\approx 3.11538 \\to 3.115$\n- $RR_2 \\approx 1.51685 \\to 1.517$\n- $RR_3 \\approx 1.21978 \\to 1.220$\n- $RD_1 \\approx 0.0261159 \\to 0.02612$\n- $RD_2 \\approx 0.0344570 \\to 0.03446$\n- $RD_3 \\approx 0.0415800 \\to 0.04158$\n- $\\text{Range}_{\\ln(RR)} \\approx 0.93773 \\to 0.9377$\n- $\\text{Range}_{RD} \\approx 0.0154641 \\to 0.01546$\n\n最终答案是按指定顺序包含这八个值的行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.115  1.517  1.220  0.02612  0.03446  0.04158  0.9377  0.01546\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "何时可以将分层效应“折叠”或合并成一个单一的、有意义的总体效应估计值？这个问题的答案在于“可折叠性”这一概念，它与混杂的存在与否密切相关。本练习通过一个理想化的随机队列研究场景，其中暴露与分层变量之间没有关联，来阐明风险差这一指标的可折叠性 。通过从基本定义出发，您将亲手证明并计算，在这种无混杂的情况下，边际（总体）风险差如何精确地等于分层风险差的加权平均值，从而深刻理解混杂是如何破坏这种可折叠性并导致偏倚的。",
            "id": "4638381",
            "problem": "您正在研究一个在固定随访期内测量的二元结局 $Y$、一个二元暴露 $A \\in \\{0,1\\}$ 以及一个基线二元协变量 $C \\in \\{0,1\\}$。考虑以下随机队列研究，其中暴露 $A$ 在基线时独立于 $C$ 进行随机化。队列规模为 $N$ 个个体，在 $C$ 的各个分层中暴露分配均等，因此在观测数据中 $A$ 和 $C$ 的独立性成立。\n\n数据如下：\n- 在 $C=0$ 和 $A=1$ 的个体中，有 $300$ 人，其中 $30$ 人出现 $Y=1$。\n- 在 $C=0$ 和 $A=0$ 的个体中，有 $300$ 人，其中 $6$ 人出现 $Y=1$。\n- 在 $C=1$ 和 $A=1$ 的个体中，有 $200$ 人，其中 $50$ 人出现 $Y=1$。\n- 在 $C=1$ 和 $A=0$ 的个体中，有 $200$ 人，其中 $26$ 人出现 $Y=1$。\n\n仅使用概率、风险和全概率定律的基本定义，不使用任何快捷公式，完成以下任务：\n\n1. 对效应度量 $M$ 对于基线协变量 $C$ 的可合并性（collapsibility）给出一个精确的定义。用文字说明风险差（Risk Difference, RD）对于 $C$ 可合并意味着什么。\n2. 使用分层作为一种分析控制手段，解释为何在此设定下，当 $A$ 与 $C$ 不相关时，风险差（RD）对于 $C$ 是可合并的。\n3. 计算分层特异性风险 $P(Y=1 \\mid A=a, C=c)$（其中 $a \\in \\{0,1\\}$ 和 $c \\in \\{0,1\\}$），分层特异性风险差 $RD(c) = P(Y=1 \\mid A=1, C=c) - P(Y=1 \\mid A=0, C=c)$，以及边际风险 $P(Y=1 \\mid A=a)$（其中 $a \\in \\{0,1\\}$）。\n4. 使用全概率定律以及 $A$ 和 $C$ 的独立性，证明边际风险差 $RD_{\\text{marg}} = P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0)$ 等于分层特异性风险差的加权平均值，且权重不依赖于 $A$。\n5. 最后，计算整个队列的边际风险差 $RD_{\\text{marg}}$。将最终答案表示为小数（不带百分号）。如果需要四舍五入，请使用有效数字；否则，请提供精确的小数值。",
            "solution": "该问题被认为是有效的，因为它在流行病学原理上具有科学依据，内部一致，并且提供了所有必要信息，是一个良构问题。我们逐步进行解答。\n\n对于暴露 $A$ 和结局 $Y$ 之间的关联，如果边际（粗略）关联度量等于按第三个变量 $C$ 分层的各层特异性关联度量的加权平均值，则称效应度量 $M$ 对于 $C$ 是可合并的。如果层特异性度量在各分层中是恒定的，可合并性要求边际度量等于这个共同的条件度量。对于风险差（$RD$），这意味着边际风险差 $RD_{\\text{marg}}$ 必须是分层特异性风险差 $RD(c)$ 的加权平均值。换句话说，这意味着人群中的总体风险差是对由协变量 $C$ 定义的亚组内观察到的风险差的无偏总结。边际效应不会因为忽略协变量 $C$ 而失真，而对于像比值比（Odds Ratio）这样的不可合并度量，即使当 $C$ 不是混杂因素时，情况也并非如此。\n\n分层是一种分析技术，通过在潜在混杂变量的各水平（分层）内检验暴露-结局关联来控制混杂。在本问题中，暴露 $A$ 是随机化的，因此独立于基线协变量 $C$，可记为 $A \\perp C$。这种独立性是保证风险差具有可合并性的关键条件。为了证明这一点，我们使用全概率定律。在暴露组 $A=a$ 中的边际风险是分层特异性风险的加权平均值：\n$$P(Y=1 \\mid A=a) = \\sum_{c \\in \\{0,1\\}} P(Y=1 \\mid A=a, C=c) P(C=c \\mid A=a)$$\n边际风险差 $RD_{\\text{marg}}$ 定义为暴露组（$A=1$）和非暴露组（$A=0$）边际风险之差：\n$$RD_{\\text{marg}} = P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0)$$\n代入全概率定律的表达式可得：\n$$RD_{\\text{marg}} = \\left( \\sum_{c} P(Y=1 \\mid A=1, C=c) P(C=c \\mid A=1) \\right) - \\left( \\sum_{c} P(Y=1 \\mid A=0, C=c) P(C=c \\mid A=0) \\right)$$\n因为暴露 $A$ 独立于协变量 $C$（$A \\perp C$），所以 $C$ 的分布在两个暴露组中是相同的，即 $P(C=c \\mid A=1) = P(C=c \\mid A=0) = P(C=c)$。让我们将分层 $c$ 的权重表示为 $w_c = P(C=c)$。方程简化为：\n$$RD_{\\text{marg}} = \\left( \\sum_{c} P(Y=1 \\mid A=1, C=c) w_c \\right) - \\left( \\sum_{c} P(Y=1 \\mid A=0, C=c) w_c \\right)$$\n根据求和的线性性质，我们可以合并这些项：\n$$RD_{\\text{marg}} = \\sum_{c} \\left[ P(Y=1 \\mid A=1, C=c) - P(Y=1 \\mid A=0, C=c) \\right] w_c$$\n方括号内的项正是分层特异性风险差 $RD(c)$。因此：\n$$RD_{\\text{marg}} = \\sum_{c} RD(c) P(C=c)$$\n该方程表明，边际风险差是分层特异性风险差的加权平均值，权重为每个分层的比例 $P(C=c)$，并且这些权重不依赖于暴露 $A$。这正式证明了当 $A$ 与 $C$ 不相关时，风险差对于协变量 $C$ 是可合并的。\n\n现在我们使用所提供的数据计算所需的量。\n分层特异性风险，记为 $P(Y=1 \\mid A=a, C=c)$，计算方法为每个分层中的事件数除以个体数。\n对于分层 $C=0$：\n- 暴露组风险：$P(Y=1 \\mid A=1, C=0) = \\frac{30}{300} = 0.1$\n- 非暴露组风险：$P(Y=1 \\mid A=0, C=0) = \\frac{6}{300} = 0.02$\n对于分层 $C=1$：\n- 暴露组风险：$P(Y=1 \\mid A=1, C=1) = \\frac{50}{200} = 0.25$\n- 非暴露组风险：$P(Y=1 \\mid A=0, C=1) = \\frac{26}{200} = 0.13$\n\n分层特异性风险差 $RD(c) = P(Y=1 \\mid A=1, C=c) - P(Y=1 \\mid A=0, C=c)$ 为：\n- 对于分层 $C=0$：$RD(0) = 0.1 - 0.02 = 0.08$\n- 对于分层 $C=1$：$RD(1) = 0.25 - 0.13 = 0.12$\n\n边际风险 $P(Y=1 \\mid A=a)$ 通过合并 $C$ 的各分层数据计算得出。\n- 暴露组（$A=1$）总人数：$300 + 200 = 500$\n- 暴露组总事件数：$30 + 50 = 80$\n- 暴露组边际风险：$P(Y=1 \\mid A=1) = \\frac{80}{500} = 0.16$\n- 非暴露组（$A=0$）总人数：$300 + 200 = 500$\n- 非暴露组总事件数：$6 + 26 = 32$\n- 非暴露组边际风险：$P(Y=1 \\mid A=0) = \\frac{32}{500} = 0.064$\n\n任务4要求的代数证明已在第二段中作为可合并性解释的核心部分提供。它证明了在 $A \\perp C$ 的条件下，$RD_{\\text{marg}} = \\sum_{c} RD(c) P(C=c)$。\n\n最后，我们计算整个队列的边际风险差 $RD_{\\text{marg}}$。\n$$RD_{\\text{marg}} = P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0)$$\n使用计算出的边际风险：\n$$RD_{\\text{marg}} = 0.16 - 0.064 = 0.096$$\n\n作为验证，我们可以使用前面推导的加权平均公式来计算。权重是总人口在 $C$ 的每个分层中所占的比例。\n- 总人口 $N = 300+300+200+200 = 1000$。\n- 分层 $C=0$ 的比例：$P(C=0) = \\frac{300+300}{1000} = \\frac{600}{1000} = 0.6$\n- 分层 $C=1$ 的比例：$P(C=1) = \\frac{200+200}{1000} = \\frac{400}{1000} = 0.4$\n分层特异性RD的加权平均值：\n$$RD_{\\text{marg}} = RD(0)P(C=0) + RD(1)P(C=1) = (0.08)(0.6) + (0.12)(0.4)$$\n$$RD_{\\text{marg}} = 0.048 + 0.048 = 0.096$$\n结果一致。",
            "answer": "$$\\boxed{0.096}$$"
        }
    ]
}