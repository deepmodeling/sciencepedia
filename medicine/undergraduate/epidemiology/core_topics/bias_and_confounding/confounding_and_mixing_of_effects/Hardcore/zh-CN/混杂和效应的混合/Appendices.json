{
    "hands_on_practices": [
        {
            "introduction": "混杂效应是流行病学研究中的一个核心挑战，它可能完全扭曲我们观察到的暴露与结局之间的关联。本练习通过一个经典的辛普森悖论（Simpson's Paradox）案例，直观地展示了混杂的威力。你将通过计算发现，一个在总体人群中看起来有“保护性”的暴露，在按年龄分层后，其真实的“有害”效应才显现出来，这凸显了识别和处理混杂变量的至关重要性。 ",
            "id": "4580916",
            "problem": "一位流行病学家正在研究队列中药物暴露与二元健康结局之间的关联，并担心年龄可能是一个混杂因素。考虑一个构建了两个年龄分层的假设数据集，以说明效应混合和混杂。计数如下。\n\n分层 $1$（较年轻）：暴露组中，300名暴露个体中有3例病例；非暴露组中，400名非暴露个体中有2例病例。\n\n分层 $2$（较年长）：暴露组中，100名暴露个体中有85例病例；非暴露组中，200名非暴露个体中有160例病例。\n\n仅从核心定义出发——风险定义为暴露组内出现结局的概率，风险比定义为暴露组与非暴露组之间的风险之比，以及分层群体的全概率定律——计算：\n\n1. 两个分层合并后的粗风险比。\n2. 分层 $1$ 中的分层特异性风险比。\n3. 分层 $2$ 中的分层特异性风险比。\n\n按顺序报告这三个风险比，以四位有效数字的小数形式表示：粗风险比、分层 $1$ 风险比、分层 $2$ 风险比。最终答案不带单位。",
            "solution": "该问题被认为是有效的，因为它在流行病学原理上具有科学依据，数据充分且问题陈述良好，并且其表述是客观的。我们将按要求进行计算。\n\n令 $E$ 表示暴露于药物的事件，$\\bar{E}$ 表示未暴露的事件。令 $D$ 表示出现健康结局（成为病例）的事件。令 $S_1$ 和 $S_2$ 分别表示处于分层 $1$（较年轻）和分层 $2$（较年长）。\n\n组内风险定义为该组内出现结局的概率。暴露组的风险为 $R_E = P(D|E)$，非暴露组的风险为 $R_{\\bar{E}} = P(D|\\bar{E})$。风险比（$RR$）是这两个风险的比值：$RR = \\frac{R_E}{R_{\\bar{E}}}$。\n\n所提供的数据可总结如下：\n分层 $1$ ($S_1$):\n- 暴露组 ($E$)：3例病例，总人数 $N_{E,1} = 300$。\n- 非暴露组 ($\\bar{E}$)：2例病例，总人数 $N_{\\bar{E},1} = 400$。\n\n分层 $2$ ($S_2$):\n- 暴露组 ($E$)：85例病例，总人数 $N_{E,2} = 100$。\n- 非暴露组 ($\\bar{E}$)：160例病例，总人数 $N_{\\bar{E},2} = 200$。\n\n1. 粗风险比（$RR_{crude}$）的计算\n为计算粗风险比，我们首先汇总两个分层的数据。\n\n两个分层中暴露个体的总数：\n$$ N_E = N_{E,1} + N_{E,2} = 300 + 100 = 400 $$\n暴露组中的总病例数：\n$$ \\text{Cases}_E = \\text{Cases}_{E,1} + \\text{Cases}_{E,2} = 3 + 85 = 88 $$\n暴露组的粗风险为：\n$$ R_{E,crude} = P(D|E) = \\frac{\\text{暴露组总病例数}}{\\text{暴露组总人数}} = \\frac{88}{400} = 0.22 $$\n\n两个分层中非暴露个体的总数：\n$$ N_{\\bar{E}} = N_{\\bar{E},1} + N_{\\bar{E},2} = 400 + 200 = 600 $$\n非暴露组中的总病例数：\n$$ \\text{Cases}_{\\bar{E}} = \\text{Cases}_{\\bar{E},1} + \\text{Cases}_{\\bar{E},2} = 2 + 160 = 162 $$\n非暴露组的粗风险为：\n$$ R_{\\bar{E},crude} = P(D|\\bar{E}) = \\frac{\\text{非暴露组总病例数}}{\\text{非暴露组总人数}} = \\frac{162}{600} = 0.27 $$\n\n粗风险比是这些粗风险的比值：\n$$ RR_{crude} = \\frac{R_{E,crude}}{R_{\\bar{E},crude}} = \\frac{0.22}{0.27} = \\frac{22}{27} \\approx 0.8148148... $$\n四舍五入到四位有效数字，我们得到 $RR_{crude} = 0.8148$。\n\n2. 分层 $1$ 中分层特异性风险比（$RR_1$）的计算\n对于此计算，我们仅使用分层 $1$ 的数据。\n\n分层 $1$ 中暴露组的风险：\n$$ R_{E,1} = P(D|E, S_1) = \\frac{\\text{Cases}_{E,1}}{N_{E,1}} = \\frac{3}{300} = 0.01 $$\n分层 $1$ 中非暴露组的风险：\n$$ R_{\\bar{E},1} = P(D|\\bar{E}, S_1) = \\frac{\\text{Cases}_{\\bar{E},1}}{N_{\\bar{E},1}} = \\frac{2}{400} = 0.005 $$\n分层 $1$ 的分层特异性风险比为：\n$$ RR_1 = \\frac{R_{E,1}}{R_{\\bar{E},1}} = \\frac{0.01}{0.005} = 2.0 $$\n保留四位有效数字，即为 $2.000$。\n\n3. 分层 $2$ 中分层特异性风险比（$RR_2$）的计算\n对于此计算，我们仅使用分层 $2$ 的数据。\n\n分层 $2$ 中暴露组的风险：\n$$ R_{E,2} = P(D|E, S_2) = \\frac{\\text{Cases}_{E,2}}{N_{E,2}} = \\frac{85}{100} = 0.85 $$\n分层 $2$ 中非暴露组的风险：\n$$ R_{\\bar{E},2} = P(D|\\bar{E}, S_2) = \\frac{\\text{Cases}_{\\bar{E},2}}{N_{\\bar{E},2}} = \\frac{160}{200} = 0.80 $$\n分层 $2$ 的分层特异性风险比为：\n$$ RR_2 = \\frac{R_{E,2}}{R_{\\bar{E},2}} = \\frac{0.85}{0.80} = 1.0625 $$\n四舍五入到四位有效数字，我们得到 $RR_2 = 1.063$。\n\n所要求的三个风险比，四舍五入到四位有效数字，分别为：\n- 粗风险比：$0.8148$\n- 分层 $1$ 风险比：$2.000$\n- 分层 $2$ 风险比：$1.063$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.8148 & 2.000 & 1.063 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在识别出混杂变量后，下一步就是如何校正其影响，以获得一个更接近因果关系的效应估计值。本练习将引导你应用“标准化”这一基本方法，通过将特定分层风险应用到一个标准化的目标人群分布上，来计算一个调整后的风险差。这个过程可以帮助我们消除由于各组间混杂因素分布不均所造成的偏倚，从而得到一个可比较的效应度量。 ",
            "id": "4580949",
            "problem": "考虑一项关于二元结局 $Y$（一年内新发疾病）的一年累积发病率的队列研究，该研究比较了一项暴露 $X$（暴露组 $X=1$ 与非暴露组 $X=0$）。令 $Z$ 表示一个具有三个分层（$z_{1}$（较年轻组）、$z_{2}$（中年组）和 $z_{3}$（较年长组））的分类潜在混杂因素。各分层特定的一年期风险无测量误差，具体如下：\n- 对于 $z_{1}$：$E[Y \\mid X=1, Z=z_{1}] = 0.08$ 且 $E[Y \\mid X=0, Z=z_{1}] = 0.04$。\n- 对于 $z_{2}$：$E[Y \\mid X=1, Z=z_{2}] = 0.12$ 且 $E[Y \\mid X=0, Z=z_{2}] = 0.10$。\n- 对于 $z_{3}$：$E[Y \\mid X=1, Z=z_{3}] = 0.20$ 且 $E[Y \\mid X=0, Z=z_{3}] = 0.15$。\n\n假设您希望对一个目标人群进行标准化，该人群中 $Z$ 的分布由 $P^{*}(Z=z_{1}) = 0.50$，$P^{*}(Z=z_{2}) = 0.30$ 和 $P^{*}(Z=z_{3}) = 0.20$ 给出，这是出于对各分层间混杂和效应混合的担忧。将针对该目标人群的标准化风险差（RD）定义为在 $X=1$ 和 $X=0$ 条件下，目标人群标准化风险之间的差异，每个标准化风险都是通过在目标分布 $P^{*}(Z)$ 上对各分层特定风险进行平均而构建的。\n\n计算目标人群标准化风险差。请用小数表示您的最终答案（无百分号）。如果需要取整，请保留四位有效数字。",
            "solution": "本题要求计算目标人群标准化风险差。这是一种标准的流行病学方法，用于校正混杂因素，以确保暴露组和非暴露组之间的比较不会因混杂变量 $Z$ 的分布差异而产生偏差。\n\n设 $Y$ 为二元结局变量，其中 $Y=1$ 表示疾病发生，$Y=0$ 表示未发生。设 $X$ 为二元暴露变量，$X=1$ 代表暴露组，$X=0$ 代表非暴露组。设 $Z$ 为一个具有三个水平或分层的分类潜在混杂因素：$z_1$（较年轻组）、$z_2$（中年组）和 $z_3$（较年长组）。\n\n各分层特定的一年期风险以条件期望 $E[Y \\mid X=x, Z=z_j]$ 的形式给出。对于二元结局 $Y$，这等同于条件概率 $P(Y=1 \\mid X=x, Z=z_j)$。我们将此风险记为 $R_{xj}$。所提供的数据如下：\n- 对于分层 $z_1$：$R_{11} = P(Y=1 \\mid X=1, Z=z_1) = 0.08$ 且 $R_{01} = P(Y=1 \\mid X=0, Z=z_1) = 0.04$。\n- 对于分层 $z_2$：$R_{12} = P(Y=1 \\mid X=1, Z=z_2) = 0.12$ 且 $R_{02} = P(Y=1 \\mid X=0, Z=z_2) = 0.10$。\n- 对于分层 $z_3$：$R_{13} = P(Y=1 \\mid X=1, Z=z_3) = 0.20$ 且 $R_{03} = P(Y=1 \\mid X=0, Z=z_3) = 0.15$。\n\n标准化需要相对于一个目标人群进行，其中 $Z$ 的分布由 $P^*(Z)$ 给出。设 $w_j = P^*(Z=z_j)$ 为每个分层的权重。给定的权重如下：\n- $w_1 = P^*(Z=z_1) = 0.50$\n- $w_2 = P^*(Z=z_2) = 0.30$\n- $w_3 = P^*(Z=z_3) = 0.20$\n这些权重的总和为 $0.50 + 0.30 + 0.20 = 1.00$，这证实了它是一个有效的概率分布。\n\n对于给定的暴露水平 $x$，其标准化风险（我们可记作 $R^*_x$）是通过对目标人群中 $Z$ 的分布，计算各分层特定风险 $R_{xj}$ 的加权平均值得到的。\n$$R^*_x = \\sum_{j=1}^{3} R_{xj} \\cdot w_j$$\n\n首先，我们计算暴露组（$x=1$）的标准化风险，记为 $R^*_1$：\n$$R^*_1 = R_{11} \\cdot w_1 + R_{12} \\cdot w_2 + R_{13} \\cdot w_3$$\n代入给定值：\n$$R^*_1 = (0.08)(0.50) + (0.12)(0.30) + (0.20)(0.20)$$\n$$R^*_1 = 0.040 + 0.036 + 0.040$$\n$$R^*_1 = 0.116$$\n\n接下来，我们计算非暴露组（$x=0$）的标准化风险，记为 $R^*_0$：\n$$R^*_0 = R_{01} \\cdot w_1 + R_{02} \\cdot w_2 + R_{03} \\cdot w_3$$\n代入给定值：\n$$R^*_0 = (0.04)(0.50) + (0.10)(0.30) + (0.15)(0.20)$$\n$$R^*_0 = 0.020 + 0.030 + 0.030$$\n$$R^*_0 = 0.080$$\n\n目标人群标准化风险差 $RD_{\\text{std}}^*$ 是暴露组标准化风险与非暴露组标准化风险之差。\n$$RD_{\\text{std}}^* = R^*_1 - R^*_0$$\n代入已计算的标准化风险：\n$$RD_{\\text{std}}^* = 0.116 - 0.080$$\n$$RD_{\\text{std}}^* = 0.036$$\n结果是一个精确的小数，因此无需进行取整。",
            "answer": "$$\\boxed{0.036}$$"
        },
        {
            "introduction": "虽然为混杂因素进行调整至关重要，但并非所有变量都适合被纳入统计模型中进行校正。本练习揭示了一个重要的陷阱：对“对撞因子”（collider）进行调整，这不仅无助于消除偏倚，反而可能引入新的偏倚。通过一个基于结构方程的数值模拟，你将亲手计算出，在模型中错误地加入一个对撞因子后，暴露的真实效应是如何被严重歪曲甚至反转的，这为我们正确选择协变量敲响了警钟。 ",
            "id": "4580964",
            "problem": "一位研究者正在研究某个人群中，一项暴露对一个连续健康结局的因果效应。设暴露为 $X$，结局为 $Y$，一个未测量的因素为 $U$，以及一个同时受 $X$ 和 $U$ 影响的下游变量（一个对撞因子）为 $C$。假设在群体水平上存在以下线性高斯数据生成过程：\n1. $X \\sim \\mathcal{N}(0,1)$ 且 $U \\sim \\mathcal{N}(0,1)$，并且 $X \\perp U$。\n2. $e_{c} \\sim \\mathcal{N}(0,\\sigma_{c}^{2})$ 且 $e_{y} \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$，并且 $e_{c} \\perp e_{y}$，两者均独立于 $(X,U)$。\n3. $C = a X + b U + e_{c}$。\n4. $Y = \\beta X + d U + e_{y}$。\n\n这些结构关系表明，$C$ 是在非因果路径 $X \\to C \\leftarrow U \\to Y$ 上的一个对撞因子。一位研究者将 $Y$ 对 $X$ 和 $C$ 进行普通最小二乘回归，并报告 $X$ 的群体系数（即，在线性模型下使群体均方预测误差最小化的系数）。使用参数值 $a = 1$，$b = 1$，$\\beta = 0.2$，$d = 0.8$，$\\sigma_{c}^{2} = 0.01$ 和 $\\sigma_{y}^{2} = 1$。\n\n计算在$Y$对$(X,C)$的多元回归中，$X$的群体普通最小二乘系数。报告你的最终数值答案，四舍五入到$4$位有效数字。不需要单位。",
            "solution": "目标是计算在结局$Y$对预测变量$(X, C)$的多元线性回归中，暴露$X$的群体普通最小二乘（OLS）系数。设预测变量向量为 $\\mathbf{V} = \\begin{pmatrix} X \\\\ C \\end{pmatrix}$。我们要求的是群体模型 $Y = \\gamma_0 + \\gamma_X X + \\gamma_C C + \\epsilon$ 中的系数 $\\gamma_X$。\n\n$Y$对$\\mathbf{V}$（不包括截距项）回归的群体OLS系数向量 $\\boldsymbol{\\gamma} = \\begin{pmatrix} \\gamma_X \\\\ \\gamma_C \\end{pmatrix}$ 由以下公式给出：\n$$ \\boldsymbol{\\gamma} = (\\mathbb{E}[\\mathbf{V}\\mathbf{V}^T])^{-1} \\mathbb{E}[\\mathbf{V}Y] $$\n此公式适用于中心化变量（即均值为零的变量）。我们首先验证所涉及变量的这一条件。\n给定 $X \\sim \\mathcal{N}(0,1)$ 和 $U \\sim \\mathcal{N}(0,1)$，它们的期望为 $\\mathbb{E}[X]=0$ 和 $\\mathbb{E}[U]=0$。噪声项 $e_c \\sim \\mathcal{N}(0,\\sigma_{c}^{2})$ 和 $e_y \\sim \\mathcal{N}(0,\\sigma_{y}^{2})$ 的期望也为零。\n对撞因子 $C$ 的期望为：\n$$ \\mathbb{E}[C] = \\mathbb{E}[a X + b U + e_{c}] = a\\mathbb{E}[X] + b\\mathbb{E}[U] + \\mathbb{E}[e_{c}] = a(0) + b(0) + 0 = 0 $$\n结局 $Y$ 的期望为：\n$$ \\mathbb{E}[Y] = \\mathbb{E}[\\beta X + d U + e_{y}] = \\beta\\mathbb{E}[X] + d\\mathbb{E}[U] + \\mathbb{E}[e_{y}] = \\beta(0) + d(0) + 0 = 0 $$\n由于所有变量$X, C, Y$都是中心化的，该公式成立，且截距项 $\\gamma_0$ 为零。公式中的矩阵分别是预测变量的协方差矩阵，以及预测变量与结局之间的协方差向量。\n$$ \\mathbb{E}[\\mathbf{V}\\mathbf{V}^T] = \\Sigma_{\\mathbf{VV}} = \\begin{pmatrix} \\text{Var}(X) & \\text{Cov}(X,C) \\\\ \\text{Cov}(C,X) & \\text{Var}(C) \\end{pmatrix} $$\n$$ \\mathbb{E}[\\mathbf{V}Y] = \\Sigma_{\\mathbf{V}Y} = \\begin{pmatrix} \\text{Cov}(X,Y) \\\\ \\text{Cov}(C,Y) \\end{pmatrix} $$\n我们现在使用给定的数据生成过程和独立性假设（$X \\perp U$，$e_c \\perp e_y$ 且 $(e_c, e_y) \\perp (X,U)$）来计算这些矩阵的每个分量。\n\n1.  $\\text{Var}(X)$: 给定 $X \\sim \\mathcal{N}(0,1)$，则 $\\text{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = 1 - 0^2 = 1$。\n\n2.  $\\text{Cov}(X,C)$:\n    $$ \\text{Cov}(X,C) = \\mathbb{E}[XC] = \\mathbb{E}[X(aX + bU + e_c)] = a\\mathbb{E}[X^2] + b\\mathbb{E}[XU] + \\mathbb{E}[Xe_c] $$\n    由于独立性，$\\mathbb{E}[XU] = \\mathbb{E}[X]\\mathbb{E}[U] = 0$ 且 $\\mathbb{E}[Xe_c] = \\mathbb{E}[X]\\mathbb{E}[e_c] = 0$。\n    $$ \\text{Cov}(X,C) = a\\mathbb{E}[X^2] = a(1) = a $$\n\n3.  $\\text{Var}(C)$:\n    $$ \\text{Var}(C) = \\text{Var}(aX + bU + e_c) $$\n    因为 $X, U, e_c$ 相互独立，所以和的方差是方差的和：\n    $$ \\text{Var}(C) = a^2\\text{Var}(X) + b^2\\text{Var}(U) + \\text{Var}(e_c) = a^2(1) + b^2(1) + \\sigma_c^2 = a^2 + b^2 + \\sigma_c^2 $$\n\n4.  $\\text{Cov}(X,Y)$:\n    $$ \\text{Cov}(X,Y) = \\mathbb{E}[XY] = \\mathbb{E}[X(\\beta X + dU + e_y)] = \\beta\\mathbb{E}[X^2] + d\\mathbb{E}[XU] + \\mathbb{E}[Xe_y] $$\n    由于独立性，$\\mathbb{E}[XU]=0$ 且 $\\mathbb{E}[Xe_y]=0$。\n    $$ \\text{Cov}(X,Y) = \\beta\\mathbb{E}[X^2] = \\beta(1) = \\beta $$\n\n5.  $\\text{Cov}(C,Y)$:\n    $$ \\text{Cov}(C,Y) = \\mathbb{E}[CY] = \\mathbb{E}[(aX + bU + e_c)(\\beta X + dU + e_y)] $$\n    展开乘积并取期望，只有包含非独立变量或变量平方的项才非零。非零的期望项是 $\\mathbb{E}[X^2]$ 和 $\\mathbb{E}[U^2]$：\n    $$ \\text{Cov}(C,Y) = a\\beta\\mathbb{E}[X^2] + bd\\mathbb{E}[U^2] = a\\beta(1) + bd(1) = a\\beta + bd $$\n\n现在，我们组合这些矩阵：\n$$ \\Sigma_{\\mathbf{VV}} = \\begin{pmatrix} 1 & a \\\\ a & a^2+b^2+\\sigma_c^2 \\end{pmatrix} $$\n$$ \\Sigma_{\\mathbf{V}Y} = \\begin{pmatrix} \\beta \\\\ a\\beta+bd \\end{pmatrix} $$\n\n接下来，我们求 $\\Sigma_{\\mathbf{VV}}$ 的逆矩阵。行列式为 $\\det(\\Sigma_{\\mathbf{VV}}) = (1)(a^2+b^2+\\sigma_c^2) - (a)(a) = b^2+\\sigma_c^2$。\n逆矩阵是：\n$$ \\Sigma_{\\mathbf{VV}}^{-1} = \\frac{1}{b^2+\\sigma_c^2} \\begin{pmatrix} a^2+b^2+\\sigma_c^2 & -a \\\\ -a & 1 \\end{pmatrix} $$\n\n我们现在可以计算系数向量 $\\boldsymbol{\\gamma}$：\n$$ \\begin{pmatrix} \\gamma_X \\\\ \\gamma_C \\end{pmatrix} = \\frac{1}{b^2+\\sigma_c^2} \\begin{pmatrix} a^2+b^2+\\sigma_c^2 & -a \\\\ -a & 1 \\end{pmatrix} \\begin{pmatrix} \\beta \\\\ a\\beta+bd \\end{pmatrix} $$\n我们只需要计算结果向量的第一个元素，它对应于 $\\gamma_X$：\n$$ \\gamma_X = \\frac{1}{b^2+\\sigma_c^2} \\left[ (a^2+b^2+\\sigma_c^2)\\beta - a(a\\beta+bd) \\right] $$\n$$ \\gamma_X = \\frac{1}{b^2+\\sigma_c^2} \\left[ a^2\\beta + b^2\\beta + \\sigma_c^2\\beta - a^2\\beta - abd \\right] $$\n$a^2\\beta$ 项相互抵消：\n$$ \\gamma_X = \\frac{ b^2\\beta + \\sigma_c^2\\beta - abd }{b^2+\\sigma_c^2} $$\n$$ \\gamma_X = \\frac{ (b^2+\\sigma_c^2)\\beta - abd }{b^2+\\sigma_c^2} = \\beta - \\frac{abd}{b^2+\\sigma_c^2} $$\n这个表达式表明，OLS系数 $\\gamma_X$ 等于真实的因果效应 $\\beta$ 加上一个偏倚项 $-\\frac{abd}{b^2+\\sigma_c^2}$。这种偏倚是由于对对撞因子 $C$ 进行条件控制而产生的，这打开了一条通过 $U$ 连接 $X$ 和 $Y$ 的非因果路径。\n\n最后，我们将给定的参数值代入导出的表达式中：\n$a = 1$，$b = 1$，$\\beta = 0.2$，$d = 0.8$，以及 $\\sigma_{c}^{2} = 0.01$。\n$$ \\gamma_X = 0.2 - \\frac{(1)(1)(0.8)}{1^2 + 0.01} $$\n$$ \\gamma_X = 0.2 - \\frac{0.8}{1 + 0.01} $$\n$$ \\gamma_X = 0.2 - \\frac{0.8}{1.01} $$\n$$ \\gamma_X = 0.2 - 0.79207920... $$\n$$ \\gamma_X = -0.59207920... $$\n题目要求答案四舍五入到$4$位有效数字。第五位有效数字是$7$，所以我们将第四位向上取整。\n$$ \\gamma_X \\approx -0.5921 $$",
            "answer": "$$\\boxed{-0.5921}$$"
        }
    ]
}