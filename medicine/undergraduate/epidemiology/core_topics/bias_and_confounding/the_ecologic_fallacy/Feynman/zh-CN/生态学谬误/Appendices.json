{
    "hands_on_practices": [
        {
            "introduction": "生态谬误的根源在于，群体层面的数据无法唯一确定个体层面的关联。本练习将通过动手实践，直接展示这一核心原则。你将根据同一组生态学上的汇总数据，构建两种完全不同的个体层面情景，从而亲眼见证为何我们无法仅从汇总信息中复原出个体层面的比值比（odds ratio）。",
            "id": "4643831",
            "problem": "流行病学中的一个核心观点是，群体水平的关联通常无法确定个体水平的关联，这种现象被称为生态谬误。考虑两个邻里，索引为 $i \\in \\{1,2\\}$，每个邻里都有二元暴露和二元结局。生态数据仅提供邻里 $i$ 的以下边际值：总人口 $N_{i}$，总暴露人数 $E_{i}$，以及总患病人数 $D_{i}$。假设边际值如下\n$$\nN_{1} = 100,\\quad E_{1} = 55,\\quad D_{1} = 25;\\qquad N_{2} = 120,\\quad E_{2} = 70,\\quad D_{2} = 35.\n$$\n在每个邻里内部，设 $2\\times 2$ 列联表的计数分别为 $a_{i}$ (暴露且患病)、$b_{i}$ (暴露但不患病)、$c_{i}$ (未暴露但患病) 和 $d_{i}$ (未暴露且不患病)，因此有 $E_{i} = a_{i} + b_{i}$，$D_{i} = a_{i} + c_{i}$，以及 $N_{i} = a_{i} + b_{i} + c_{i} + d_{i}$。仅使用上述边际值，构建两组不同的、与边际值一致的可行邻里内部列联表：\n\n- 表 $X$：取 $a_{1} = 20$ 和 $a_{2} = 30$。\n- 表 $Y$：取 $a_{1} = 5$ 和 $a_{2} = 10$。\n\n对于每个表，使用边际值补全邻里内部的计数，然后跨邻里汇总，形成合并的个体水平 $2\\times 2$ 表，其格子计数为 $a = a_{1} + a_{2}$，$b = b_{1} + b_{2}$，$c = c_{1} + c_{2}$，$d = d_{1} + d_{2}$。计算每个合并表的个体水平比值比 (odds ratio, OR)，其定义为\n$$\n\\mathrm{OR} = \\frac{a\\,d}{b\\,c}.\n$$\n最后，计算两个个体水平比值比的比率 $\\mathrm{OR}_{X}/\\mathrm{OR}_{Y}$。将最终比率四舍五入至四位有效数字。无需单位。",
            "solution": "该问题要求我们分析两种关于个体水平数据的假设情景（表 $X$ 和表 $Y$），这两种情景都与给定的相同生态（群体水平）数据一致。这个练习展示了生态谬误的核心原则：群体水平的关联并不能唯一确定个体水平的关联。\n\n给定的两个邻里 ($i \\in \\{1,2\\}$) 的生态边际值是：\n- 邻里 $1$：总人口 $N_{1} = 100$，总暴露人数 $E_{1} = 55$，总患病人数 $D_{1} = 25$。\n- 邻里 $2$：总人口 $N_{2} = 120$，总暴露人数 $E_{2} = 70$，总患病人数 $D_{2} = 35$。\n\n每个邻里内的个体水平数据由一个 $2 \\times 2$ 列联表描述，其计数为 $a_i$ (暴露，患病)、$b_i$ (暴露，未患病)、$c_i$ (未暴露，患病) 和 $d_i$ (未暴露，未患病)。这些计数通过以下方程与边际值相关联：\n$E_{i} = a_{i} + b_{i}$\n$D_{i} = a_{i} + c_{i}$\n$N_{i} = a_{i} + b_{i} + c_{i} + d_{i}$\n\n根据这些关系，我们可以用已知计数 $a_i$ 和给定的边际值来表示未知计数 $b_i$、$c_i$ 和 $d_i$：\n$b_{i} = E_{i} - a_{i}$\n$c_{i} = D_{i} - a_{i}$\n$d_{i} = N_{i} - (a_{i} + b_{i} + c_{i}) = N_{i} - a_{i} - (E_{i} - a_{i}) - (D_{i} - a_{i}) = N_{i} - E_{i} - D_{i} + a_{i}$\n\n我们现在将系统地为情景 $X$ 和情景 $Y$ 构建表格。\n\n**情景 X：构建与比值比计算**\n\n对于此情景，我们给定 $a_{1} = 20$ 和 $a_{2} = 30$。\n\n**邻里 $1$ (表 $X$)：**\n- $a_{1,X} = 20$\n- $b_{1,X} = E_{1} - a_{1,X} = 55 - 20 = 35$\n- $c_{1,X} = D_{1} - a_{1,X} = 25 - 20 = 5$\n- $d_{1,X} = N_{1} - E_{1} - D_{1} + a_{1,X} = 100 - 55 - 25 + 20 = 40$\n\n**邻里 $2$ (表 $X$)：**\n- $a_{2,X} = 30$\n- $b_{2,X} = E_{2} - a_{2,X} = 70 - 30 = 40$\n- $c_{2,X} = D_{2} - a_{2,X} = 35 - 30 = 5$\n- $d_{2,X} = N_{2} - E_{2} - D_{2} + a_{2,X} = 120 - 70 - 35 + 30 = 45$\n\n接下来，我们汇总计数以形成情景 $X$ 的合并个体水平表：\n- $a_{X} = a_{1,X} + a_{2,X} = 20 + 30 = 50$\n- $b_{X} = b_{1,X} + b_{2,X} = 35 + 40 = 75$\n- $c_{X} = c_{1,X} + c_{2,X} = 5 + 5 = 10$\n- $d_{X} = d_{1,X} + d_{2,X} = 40 + 45 = 85$\n\n合并后的表 $X$ 的个体水平比值比 ($\\mathrm{OR}_{X}$) 为：\n$$\n\\mathrm{OR}_{X} = \\frac{a_{X}d_{X}}{b_{X}c_{X}} = \\frac{50 \\times 85}{75 \\times 10} = \\frac{4250}{750} = \\frac{425}{75} = \\frac{17 \\times 25}{3 \\times 25} = \\frac{17}{3}\n$$\n\n**情景 Y：构建与比值比计算**\n\n对于此情景，我们给定 $a_{1} = 5$ 和 $a_{2} = 10$。\n\n**邻里 $1$ (表 $Y$)：**\n- $a_{1,Y} = 5$\n- $b_{1,Y} = E_{1} - a_{1,Y} = 55 - 5 = 50$\n- $c_{1,Y} = D_{1} - a_{1,Y} = 25 - 5 = 20$\n- $d_{1,Y} = N_{1} - E_{1} - D_{1} + a_{1,Y} = 100 - 55 - 25 + 5 = 25$\n\n**邻里 $2$ (表 $Y$)：**\n- $a_{2,Y} = 10$\n- $b_{2,Y} = E_{2} - a_{2,Y} = 70 - 10 = 60$\n- $c_{2,Y} = D_{2} - a_{2,Y} = 35 - 10 = 25$\n- $d_{2,Y} = N_{2} - E_{2} - D_{2} + a_{2,Y} = 120 - 70 - 35 + 10 = 25$\n\n接下来，我们汇总计数以形成情景 $Y$ 的合并个体水平表：\n- $a_{Y} = a_{1,Y} + a_{2,Y} = 5 + 10 = 15$\n- $b_{Y} = b_{1,Y} + b_{2,Y} = 50 + 60 = 110$\n- $c_{Y} = c_{1,Y} + c_{2,Y} = 20 + 25 = 45$\n- $d_{Y} = d_{1,Y} + d_{2,Y} = 25 + 25 = 50$\n\n合并后的表 $Y$ 的个体水平比值比 ($\\mathrm{OR}_{Y}$) 为：\n$$\n\\mathrm{OR}_{Y} = \\frac{a_{Y}d_{Y}}{b_{Y}c_{Y}} = \\frac{15 \\times 50}{110 \\times 45} = \\frac{750}{4950} = \\frac{75}{495} = \\frac{15}{99} = \\frac{5}{33}\n$$\n\n**最终比率计算**\n\n最后，我们计算两个比值比的比率 $\\mathrm{OR}_{X}/\\mathrm{OR}_{Y}$：\n$$\n\\frac{\\mathrm{OR}_{X}}{\\mathrm{OR}_{Y}} = \\frac{\\frac{17}{3}}{\\frac{5}{33}} = \\frac{17}{3} \\times \\frac{33}{5} = \\frac{17 \\times 11}{5} = \\frac{187}{5} = 37.4\n$$\n问题要求将最终比率四舍五入至四位有效数字。因此，$37.4$ 写为 $37.40$。",
            "answer": "$$\n\\boxed{37.40}\n$$"
        },
        {
            "introduction": "生态谬误可能导致结论不仅不准确，甚至与事实完全相反，这种现象被称为辛普森悖论（Simpson's Paradox）。本练习将引导你剖析一个典型的悖论案例。通过分析一个在每个亚组中都显示有害、但总体上却表现为保护性的暴露情景，你将运用代数分解来揭示导致这种关联逆转的混杂机制。",
            "id": "4643874",
            "problem": "考虑一个二元暴露 $X \\in \\{0,1\\}$ 和一个二元结局 $Y \\in \\{0,1\\}$。令 $S$ 表示一个具有 $3$ 个分层的分类协变量，$S \\in \\{1,2,3\\}$。将分层特异性风险差 (RD) 定义为 $\\operatorname{RD}_{s} = P(Y=1 \\mid X=1, S=s) - P(Y=1 \\mid X=0, S=s)$。边际（汇总）风险差定义为 $\\operatorname{RD}_{\\text{marg}} = P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0)$，其中 $P(Y=1 \\mid X=x)$ 是对所有分层进行平均，而不以 $S$ 为条件。\n\n您将构建并分析一个数值场景，以展示生态谬误（在此情境下也称为辛普森悖论）：即所有分层中的分层特异性风险差均为正，但汇总关联为负。\n\n为一个假设的队列研究使用以下科学上合理的数值：\n- 无暴露（$X=0$）情况下的分层内风险：$P(Y=1 \\mid X=0, S=1) = 0.01$，$P(Y=1 \\mid X=0, S=2) = 0.05$，$P(Y=1 \\mid X=0, S=3) = 0.20$。\n- 暴露（$X=1$）情况下的分层内风险：$P(Y=1 \\mid X=1, S=1) = 0.03$，$P(Y=1 \\mid X=1, S=2) = 0.07$，$P(Y=1 \\mid X=1, S=3) = 0.22$。\n- 暴露人群中的分层分布：$P(S=1 \\mid X=1) = 0.80$，$P(S=2 \\mid X=1) = 0.15$，$P(S=3 \\mid X=1) = 0.05$。\n- 非暴露人群中的分层分布：$P(S=1 \\mid X=0) = 0.10$，$P(S=2 \\mid X=0) = 0.20$，$P(S=3 \\mid X=0) = 0.70$。\n\n任务：\n1. 仅使用给定的数值输入和风险差的定义，验证对于每个分层 $s \\in \\{1,2,3\\}$ 都有 $\\operatorname{RD}_{s} > 0$。\n2. 从全概率定律和条件概率的定义出发，推导此场景下的 $P(Y=1 \\mid X=1)$ 和 $P(Y=1 \\mid X=0)$，然后计算边际（汇总）风险差 $\\operatorname{RD}_{\\text{marg}}$。\n3. 仅使用基础概率恒等式（无快捷公式），推导 $\\operatorname{RD}_{\\text{marg}}$ 的一个代数分解，该分解能分离出分层特异性风险差的贡献以及 $X=1$ 和 $X=0$ 之间分层分布差异的贡献。使用此分解给出一个逆转（即尽管分层特异性关联为正，但汇总关联为负）发生的一般符号条件。\n4. 将此分解应用于给定的数值，以明确展示并解释此场景中的逆转机制（生态谬误）。\n\n以小数形式表示您的最终数值答案，即 $\\operatorname{RD}_{\\text{marg}}$ 的值，四舍五入到四位有效数字。不允许使用百分号；请报告一个纯小数比例。",
            "solution": "### 解答\n\n**任务1：验证分层特异性风险差**\n\n分层特异性风险差 $\\operatorname{RD}_{s}$ 定义为 $\\operatorname{RD}_{s} = P(Y=1 \\mid X=1, S=s) - P(Y=1 \\mid X=0, S=s)$。我们对每个分层 $s \\in \\{1,2,3\\}$ 计算这个值。\n\n对于分层 $S=1$：\n$$ \\operatorname{RD}_{1} = P(Y=1 \\mid X=1, S=1) - P(Y=1 \\mid X=0, S=1) = 0.03 - 0.01 = 0.02 $$\n对于分层 $S=2$：\n$$ \\operatorname{RD}_{2} = P(Y=1 \\mid X=1, S=2) - P(Y=1 \\mid X=0, S=2) = 0.07 - 0.05 = 0.02 $$\n对于分层 $S=3$：\n$$ \\operatorname{RD}_{3} = P(Y=1 \\mid X=1, S=3) - P(Y=1 \\mid X=0, S=3) = 0.22 - 0.20 = 0.02 $$\n在所有三个分层中，风险差均为正值（$\\operatorname{RD}_{s} = 0.02 > 0$）。这表明，在每个分层内，与无暴露 $X=0$ 相比，暴露 $X=1$ 与结局 $Y=1$ 的更高风险相关联。\n\n**任务2：计算边际风险差**\n\n边际风险差 $\\operatorname{RD}_{\\text{marg}}$ 定义为 $P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0)$。我们必须首先通过对分层 $S$ 进行平均来计算边际概率 $P(Y=1 \\mid X=1)$ 和 $P(Y=1 \\mid X=0)$。\n\n根据全概率定律，对于任何事件 $A$ 和一个划分 $\\{B_i\\}$，$P(A) = \\sum_i P(A \\cap B_i)$。将此应用于条件概率，我们有 $P(A \\mid C) = \\sum_i P(A \\cap B_i \\mid C)$。使用条件概率的定义 $P(A \\cap B \\mid C) = P(A \\mid B, C)P(B \\mid C)$，我们可以写出：\n$$ P(Y=1 \\mid X=x) = \\sum_{s=1}^{3} P(Y=1 \\mid X=x, S=s) P(S=s \\mid X=x) $$\n对于暴露组（$X=1$）：\n$$ P(Y=1 \\mid X=1) = P(Y=1 \\mid X=1, S=1)P(S=1 \\mid X=1) + P(Y=1 \\mid X=1, S=2)P(S=2 \\mid X=1) + P(Y=1 \\mid X=1, S=3)P(S=3 \\mid X=1) $$\n$$ P(Y=1 \\mid X=1) = (0.03)(0.80) + (0.07)(0.15) + (0.22)(0.05) $$\n$$ P(Y=1 \\mid X=1) = 0.0240 + 0.0105 + 0.0110 = 0.0455 $$\n对于非暴露组（$X=0$）：\n$$ P(Y=1 \\mid X=0) = P(Y=1 \\mid X=0, S=1)P(S=1 \\mid X=0) + P(Y=1 \\mid X=0, S=2)P(S=2 \\mid X=0) + P(Y=1 \\mid X=0, S=3)P(S=3 \\mid X=0) $$\n$$ P(Y=1 \\mid X=0) = (0.01)(0.10) + (0.05)(0.20) + (0.20)(0.70) $$\n$$ P(Y=1 \\mid X=0) = 0.0010 + 0.0100 + 0.1400 = 0.1510 $$\n现在，我们计算边际风险差：\n$$ \\operatorname{RD}_{\\text{marg}} = P(Y=1 \\mid X=1) - P(Y=1 \\mid X=0) = 0.0455 - 0.1510 = -0.1055 $$\n尽管每个分层中的风险差都是正的，但边际风险差却是负的。这就是生态谬误，或称辛普森悖论。\n\n**任务3：代数分解与一般符号条件**\n\n我们从全概率定律推导出的边际风险差表达式开始：\n$$ \\operatorname{RD}_{\\text{marg}} = \\sum_{s} P(Y=1 \\mid X=1, S=s) P(S=s \\mid X=1) - \\sum_{s} P(Y=1 \\mid X=0, S=s) P(S=s \\mid X=0) $$\n为了分离出分层特异性风险差 $\\operatorname{RD}_{s} = P(Y=1 \\mid X=1, S=s) - P(Y=1 \\mid X=0, S=s)$，我们加上并减去一个桥接项。一个合适的项是 $\\sum_{s} P(Y=1 \\mid X=0, S=s) P(S=s \\mid X=1)$。\n$$ \\operatorname{RD}_{\\text{marg}} = \\left[ \\sum_{s} P(Y=1 \\mid X=1, S=s) P(S=s \\mid X=1) - \\sum_{s} P(Y=1 \\mid X=0, S=s) P(S=s \\mid X=1) \\right] + \\left[ \\sum_{s} P(Y=1 \\mid X=0, S=s) P(S=s \\mid X=1) - \\sum_{s} P(Y=1 \\mid X=0, S=s) P(S=s \\mid X=0) \\right] $$\n我们现在可以对每个括号中的项进行因式分解：\n$$ \\operatorname{RD}_{\\text{marg}} = \\sum_{s} \\left[ P(Y=1 \\mid X=1, S=s) - P(Y=1 \\mid X=0, S=s) \\right] P(S=s \\mid X=1) + \\sum_{s} P(Y=1 \\mid X=0, S=s) \\left[ P(S=s \\mid X=1) - P(S=s \\mid X=0) \\right] $$\n这就得到了分解式：\n$$ \\operatorname{RD}_{\\text{marg}} = \\sum_{s} \\operatorname{RD}_{s} P(S=s \\mid X=1) + \\sum_{s} P(Y=1 \\mid X=0, S=s) \\left[ P(S=s \\mid X=1) - P(S=s \\mid X=0) \\right] $$\n第一项是分层特异性风险差的加权平均值，代表暴露的直接效应。第二项量化了混杂效应，该效应源于暴露组和非暴露组之间分层变量 $S$ 的分布不同。\n\n当第二项（混杂效应）为负且其绝对值大于第一项（直接效应）时，就会出现关联逆转（生态谬误），即对于所有 $s$ 都有 $\\operatorname{RD}_{s} > 0$，但 $\\operatorname{RD}_{\\text{marg}}  0$。这种逆转的一般符号条件是：\n$$ \\sum_{s} \\operatorname{RD}_{s} P(S=s \\mid X=1)  - \\sum_{s} P(Y=1 \\mid X=0, S=s) \\left[ P(S=s \\mid X=1) - P(S=s \\mid X=0) \\right] $$\n\n**任务4：应用分解并解释逆转现象**\n\n我们将该分解应用于给定的数值。\n第一项（直接效应）：\n$$ \\sum_{s=1}^{3} \\operatorname{RD}_{s} P(S=s \\mid X=1) = (0.02)(0.80) + (0.02)(0.15) + (0.02)(0.05) $$\n$$ = 0.02 \\times (0.80 + 0.15 + 0.05) = 0.02 \\times 1 = 0.02 $$\n该项代表了可归因于暴露效应的关联部分，这是一个一致的、小的正向效应。\n\n第二项（混杂效应）：\n$$ \\sum_{s} P(Y=1 \\mid X=0, S=s) \\left[ P(S=s \\mid X=1) - P(S=s \\mid X=0) \\right] $$\n$$ = (0.01)[0.80 - 0.10] + (0.05)[0.15 - 0.20] + (0.20)[0.05 - 0.70] $$\n$$ = (0.01)(0.70) + (0.05)(-0.05) + (0.20)(-0.65) $$\n$$ = 0.0070 - 0.0025 - 0.1300 = -0.1255 $$\n该项是一个大的负值。\n\n边际风险差是这两个分量的和：\n$$ \\operatorname{RD}_{\\text{marg}} = 0.02 + (-0.1255) = -0.1055 $$\n这与任务2的结果相匹配，从而证实了该分解的正确性。\n\n逆转机制现在很清楚了。暴露 $X$ 在每个分层内都有一个小的、一致的正向（有害）效应，对总风险差的贡献为 $+0.02$。然而，协变量 $S$ 是一个强混杂因素。结局的基线风险随分层指数急剧增加（$S=1$ 时为 $0.01$，$S=2$ 时为 $0.05$，$S=3$ 时为 $0.20$）。暴露和非暴露个体在这些分层中的分布严重不平衡：\n- 暴露组（$X=1$）主要分布在最低风险的分层中（$80\\%$ 在 $S=1$ 中）。\n- 非暴露组（$X=0$）主要分布在最高风险的分层中（$70\\%$ 在 $S=3$ 中）。\n因此，边际比较是在一个本身是低风险的组（暴露组）和一个本身是高风险的组（非暴露组）之间进行的。这种结构性差异，被大的负混杂项（$-0.1255$）所捕捉，完全压倒了暴露的小的正向直接效应（$+0.02$），导致了矛盾的负边际风险差 $-0.1055$。汇总分析错误地表明暴露是保护性的，而分层分析则正确地显示它是有害的。",
            "answer": "$$ \\boxed{-0.1055} $$"
        },
        {
            "introduction": "生态谬误的影响远不止于简单的计数和比例，它同样严重影响着流行病学中常用的回归分析。本练习将从分类数据转向连续变量，以在回归分析的背景下探讨生态偏倚。你将基于群体层面的均值数据计算回归斜率，并将其与真实的个体层面斜率进行比较，从而量化这种差异，并思考造成此类偏倚的现实因素。",
            "id": "4643851",
            "problem": "考虑一项在五个地理分组层面上进行的、关于暴露 $X$ 与结局 $Y$ 之间关系的研究，其中只有分组层面的摘要数据可用。对于每个分组 $g \\in \\{1,2,3,4,5\\}$，给定其样本量 $n_g$、分组层面的均值 $\\bar{X}_g$ 和 $\\bar{Y}_g$，以及组内方差 $\\sigma^{2}_{X,g}$ 和 $\\sigma^{2}_{Y,g}$：\n- 第 1 组：$n_{1}=120$，$\\bar{X}_{1}=0.20$，$\\bar{Y}_{1}=0.18$，$\\sigma^{2}_{X,1}=0.25$，$\\sigma^{2}_{Y,1}=0.21$。\n- 第 2 组：$n_{2}=80$，$\\bar{X}_{2}=0.35$，$\\bar{Y}_{2}=0.40$，$\\sigma^{2}_{X,2}=0.30$，$\\sigma^{2}_{Y,2}=0.28$。\n- 第 3 组：$n_{3}=200$，$\\bar{X}_{3}=0.50$，$\\bar{Y}_{3}=0.62$，$\\sigma^{2}_{X,3}=0.20$，$\\sigma^{2}_{Y,3}=0.24$。\n- 第 4 组：$n_{4}=60$，$\\bar{X}_{4}=0.70$，$\\bar{Y}_{4}=0.85$，$\\sigma^{2}_{X,4}=0.18$，$\\sigma^{2}_{Y,4}=0.20$。\n- 第 5 组：$n_{5}=150$，$\\bar{X}_{5}=0.55$，$\\bar{Y}_{5}=0.68$，$\\sigma^{2}_{X,5}=0.22$，$\\sigma^{2}_{Y,5}=0.26$。\n\n假设使用加权最小二乘法 (WLS) 拟合一个生态学回归模型，其中权重等于分组大小 $w_g = n_g$，通过将分组层面的结局均值 $\\bar{Y}_g$ 对分组层面的暴露均值 $\\bar{X}_g$ 进行回归。已知，根据相同总体的个体层面数据估计出的、基于个体的金标准普通最小二乘法 (OLS) 斜率为 $\\beta_{\\text{individual}} = 1.10$。\n\n仅使用以上提供的信息，计算所述 WLS 拟合的生态学回归斜率 $\\hat{\\beta}_{\\text{ecologic}}$。然后，从可能产生差异的流行病学机制方面，对 $\\hat{\\beta}_{\\text{ecologic}}$ 和 $\\beta_{\\text{individual}}$ 进行概念性比较（除了计算 WLS 斜率外，不进行任何额外的统计建模）。将斜率表示为一个无单位的实数，并将答案四舍五入到四位有效数字。",
            "solution": "### 解答\n\n主要任务是通过对分组层面的结局均值 $\\bar{Y}_g$ 和分组层面的暴露均值 $\\bar{X}_g$ 进行加权最小二乘 (WLS) 回归来计算生态学回归斜率 $\\hat{\\beta}_{\\text{ecologic}}$，权重为 $w_g = n_g$。\n\nWLS 回归中斜率系数的公式为：\n$$ \\hat{\\beta}_{\\text{ecologic}} = \\frac{ \\left( \\sum_{g=1}^{5} w_g \\bar{X}_g \\bar{Y}_g \\right) - \\frac{\\left( \\sum_{g=1}^{5} w_g \\bar{X}_g \\right) \\left( \\sum_{g=1}^{5} w_g \\bar{Y}_g \\right)}{\\sum_{g=1}^{5} w_g} }{ \\left( \\sum_{g=1}^{5} w_g \\bar{X}_g^2 \\right) - \\frac{\\left( \\sum_{g=1}^{5} w_g \\bar{X}_g \\right)^2}{\\sum_{g=1}^{5} w_g} } $$\n在这个问题中，权重是分组样本量，所以 $w_g = n_g$。我们首先计算必要的总和。\n\n总样本量为 $N = \\sum_{g=1}^{5} n_g$：\n$$ N = 120 + 80 + 200 + 60 + 150 = 610 $$\n\n接下来，我们计算变量的加权和：\n$$ \\sum n_g \\bar{X}_g = (120)(0.20) + (80)(0.35) + (200)(0.50) + (60)(0.70) + (150)(0.55) = 276.5 $$\n$$ \\sum n_g \\bar{Y}_g = (120)(0.18) + (80)(0.40) + (200)(0.62) + (60)(0.85) + (150)(0.68) = 330.6 $$\n\n接着，计算加权的平方和与交叉乘积和：\n$$ \\sum n_g \\bar{X}_g^2 = (120)(0.20)^2 + (80)(0.35)^2 + (200)(0.50)^2 + (60)(0.70)^2 + (150)(0.55)^2 $$\n$$ \\sum n_g \\bar{X}_g^2 = (120)(0.04) + (80)(0.1225) + (200)(0.25) + (60)(0.49) + (150)(0.3025) = 139.375 $$\n$$ \\sum n_g \\bar{X}_g \\bar{Y}_g = (120)(0.20)(0.18) + (80)(0.35)(0.40) + (200)(0.50)(0.62) + (60)(0.70)(0.85) + (150)(0.55)(0.68) = 169.32 $$\n\n现在，我们可以计算斜率公式的分子和分母。\n\n分子：\n$$ \\sum n_g \\bar{X}_g \\bar{Y}_g - \\frac{(\\sum n_g \\bar{X}_g)(\\sum n_g \\bar{Y}_g)}{N} = 169.32 - \\frac{(276.5)(330.6)}{610} $$\n$$ = 169.32 - \\frac{91410.9}{610} = 169.32 - 149.853934... = 19.466065... $$\n\n分母：\n$$ \\sum n_g \\bar{X}_g^2 - \\frac{(\\sum n_g \\bar{X}_g)^2}{N} = 139.375 - \\frac{(276.5)^2}{610} $$\n$$ = 139.375 - \\frac{76452.25}{610} = 139.375 - 125.331557... = 14.043442... $$\n\n最后，我们计算生态学斜率：\n$$ \\hat{\\beta}_{\\text{ecologic}} = \\frac{19.466065...}{14.043442...} = 1.3861386... $$\n四舍五入到四位有效数字，我们得到 $\\hat{\\beta}_{\\text{ecologic}} \\approx 1.386$。\n\n### 概念性比较\n\n计算出的生态学斜率为 $\\hat{\\beta}_{\\text{ecologic}} \\approx 1.386$，而给定的个体层面斜率为 $\\beta_{\\text{individual}} = 1.10$。生态学斜率高于个体层面斜率。这种差异是**生态学谬误**的一种表现，生态学谬误是指错误地假设在分组层面观察到的变量间关联同样适用于这些组内的个体。\n\n生态学分析的本质是对分组层面的均值（$\\bar{Y}_g$ 对 $\\bar{X}_g$）进行回归。这种方法只捕捉了**组间**变异，而完全忽略了 $X$ 和 $Y$ 在个体间的**组内**变异。所提供的组内方差（$\\sigma^{2}_{X,g}$ 和 $\\sigma^{2}_{Y,g}$）代表了生态学模型所丢弃的这种个体层面的变异性。而由 $\\beta_{\\text{individual}}$ 代表的个体层面分析则正确地使用这种组内变异来估计关联。\n\n$\\hat{\\beta}_{\\text{ecologic}}$ 和 $\\beta_{\\text{individual}}$ 之间的差异被称为**生态学偏倚**或聚合偏倚。产生这种偏倚的主要流行病学机制是：\n1.  **混杂：** 生态学偏倚最常见的原因是混杂。可能存在一个或多个未测量的变量，这些变量在分组层面上与暴露和结局均相关。例如，如果平均暴露水平 $\\bar{X}_g$ 较高的分组，其风险因素 $Z$ 的流行率也较高，且 $Z$ 也与结局 $\\bar{Y}_g$ 相关，那么生态学回归会错误地将 $Z$ 的部分效应归因于 $X$。这会相对于真实的个体层面斜率，夸大（或缩小）生态学斜率。混杂可能来自于*背景*变量（仅存在于分组层面）或个体层面混杂因素的聚合。\n2.  **效应修饰（交互作用）：** $X$ 和 $Y$ 之间真实的个体层面关联可能在所有分组中并非恒定。如果关联强度（即个体层面斜率）因组而异，并且这种变化与分组层面的平均暴露水平 $\\bar{X}_g$ 相关，就会产生生态学偏倚。在本例中，由于 $\\hat{\\beta}_{\\text{ecologic}} > \\beta_{\\text{individual}}$，可能的情况是，平均暴露水平较高的分组，其 $X$ 和 $Y$ 之间的个体层面关系也更强。生态学模型错误地将这种交互作用纳入了主效应斜率中。\n\n总之，生态学斜率 $\\hat{\\beta}_{\\text{ecologic}}$ 反映的是分组层面特征之间的关联，它是平均个体层面效应以及由分组层面的混杂和效应修饰引起的偏倚的复合体。它不能作为个体层面斜率 $\\beta_{\\text{individual}}$ 的有效替代。",
            "answer": "$$\n\\boxed{1.386}\n$$"
        }
    ]
}