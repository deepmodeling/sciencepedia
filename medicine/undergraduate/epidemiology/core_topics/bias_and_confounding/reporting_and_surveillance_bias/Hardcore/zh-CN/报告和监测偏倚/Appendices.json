{
    "hands_on_practices": [
        {
            "introduction": "在流行病监测中，一个首要挑战是估计受影响人群的真实规模，因为监测系统几乎总会漏掉一部分病例。捕获-再捕获法（Capture-Recapture）是一种源于生态学，现已广泛应用于公共卫生领域的经典方法，用于估计“看不见”的总人口。这个练习  引导你不仅推导出一个用于估计总病例数的精确公式，更重要的是，它促使你批判性地思考该方法的核心假设——独立性，并分析当监测偏差导致此假设被违反时，估计结果会如何受到影响。",
            "id": "4630142",
            "problem": "一个大小为 $N$ 的封闭种群在短时间内经历了一次可报告传染病的暴发，在此期间可以认为种群规模是恒定的。两个独立的监测系统（名单）同时运作：一个是基于实验室的，另一个是基于医院的。每个真实病例有两个二元捕获指标，$L_{1} \\in \\{0,1\\}$ 代表实验室名单，$L_{2} \\in \\{0,1\\}$ 代表医院名单。在流行病学监测的标准双名单捕获-再捕获框架下，假设如下：\n- 名单是独立的，即 $\\Pr(L_{2}=1 \\mid L_{1}=1) = \\Pr(L_{2}=1)$ 且 $\\Pr(L_{1}=1 \\mid L_{2}=1) = \\Pr(L_{1}=1)$。\n- 捕获概率在人群中的个体间是同质的，因此 $\\Pr(L_{1}=1) = p_{1}$ 和 $\\Pr(L_{2}=1) = p_{2}$ 是常数（不依赖于个体）。\n\n设 $n_{1}$ 为实验室名单记录的病例数，$n_{2}$ 为医院名单记录的病例数，$m$ 为同时出现在两个名单上的病例数。仅使用这些计数和独立性假设，从基本原理出发，推导总人口规模 $N$ 的一个估计量 $\\hat{N}$，该估计量消除了基于重叠计数的朴素比率估计量的小样本偏差。您的推导应从重叠数 $m$ 的超几何抽样模型的基本定义开始，并应说明为什么在所述假设下，所得估计量是无偏的。\n\n然后，定性解释违反独立性假设（由报告和监测偏差引起的源依赖性）如何影响估计量的偏差方向：具体来说，描述在正相关（被一个名单捕获的病例更有可能被另一个名单捕获）和负相关（被一个名单捕获的病例更不可能被另一个名单捕获）情况下会发生什么。\n\n将估计量 $\\hat{N}$ 的最终答案表示为关于 $n_{1}$、$n_{2}$ 和 $m$ 的单个闭式解析表达式。无需进行数值计算。",
            "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 种群：一个大小为 $N$ 的封闭种群。\n- 监测系统：两个独立的名单，一个基于实验室的名单 ($L_1$) 和一个基于医院的名单 ($L_2$)。\n- 捕获指标：每个真实病例有 $L_{1} \\in \\{0,1\\}$ 和 $L_{2} \\in \\{0,1\\}$。\n- 独立性假设：$\\Pr(L_{2}=1 \\mid L_{1}=1) = \\Pr(L_{2}=1)$ 且 $\\Pr(L_{1}=1 \\mid L_{2}=1) = \\Pr(L_{1}=1)$。\n- 同质性假设：对于所有个体，$\\Pr(L_{1}=1) = p_{1}$ 和 $\\Pr(L_{2}=1) = p_{2}$ 是常数。\n- 计数：\n    - $n_{1}$：实验室名单上的病例数。\n    - $n_{2}$：医院名单上的病例数。\n    - $m$：两个名单上都有的病例数。\n- 目标 1：推导总人口规模 $N$ 的一个估计量 $\\hat{N}$，该估计量消除了朴素比率估计量的小样本偏差。推导必须从 $m$ 的超几何抽样模型开始，并证明所得估计量的无偏性。\n- 目标 2：定性解释违反独立性假设在正相关和负相关情况下如何影响估计量的偏差。\n- 最终答案格式：$\\hat{N}$ 关于 $n_{1}$、$n_{2}$ 和 $m$ 的单个闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n评估问题的有效性。\n- **科学依据**：该问题描述了捕获-再捕获分析的核心组成部分，这是流行病学和生态学中的一项标准基础技术。名单独立性和捕获概率同质性的假设是经典 Lincoln-Petersen 和 Chapman 估计量的基础。使用超几何分布是对从有限总体中进行不放回抽样的正确统计模型。这个问题牢固地植根于既定的统计学和流行病学原理。\n- **问题定义良好**：该问题定义良好。它清晰地定义了参数（$N, n_1, n_2, m$）、基本假设（独立性、同质性）和目标（推导特定类型的估计量并分析其性质）。所提供的信息足以推导所要求的估计量并进行定性分析。\n- **客观性**：语言精确、技术性强，且没有主观性或偏见。\n\n该问题没有表现出验证标准中列出的任何缺陷。它不是科学上不合理、不可形式化、不完整、不切实际、定义不当或微不足道的。\n\n### 步骤 3：结论与行动\n该问题被认为是**有效的**。将提供完整的解答。\n\n### 无偏估计量的推导\n\n该问题要求使用来自两个独立名单的计数来推导病例总数 $N$ 的估计量。这些计数是 $n_1$（名单1上的病例）、$n_2$（名单2上的病例）和 $m$（两个名单上都有的病例）。\n\n标准的朴素估计量，称为 Lincoln-Petersen 估计量，是通过将名单1中同时也在名单2上的病例比例 ($m/n_1$) 与总病例中在名单2上的比例 ($n_2/N$) 相等来推导的。这得到 $\\hat{N}_{LP} = \\frac{n_1 n_2}{m}$。然而，这个估计量是一个最大似然估计量，已知在小样本中存在偏差，并且在 $m=0$ 时无定义。为了纠正这种偏差，我们使用一个修正的估计量，称为 Chapman 估计量。\n\n按照要求，推导从重叠计数 $m$ 的超几何抽样模型开始。给定总病例数 $N$，其中 $n_1$ 个在第一个名单上，我们将第二个名单看作是从这个总体中抽取的样本量为 $n_2$ 的“样本”。此样本中也出现在第一个名单上的病例数 $m$ 服从超几何分布。在给定 $N$、$n_1$ 和 $n_2$ 的条件下，$m$ 的概率质量函数为：\n$$ \\Pr(m \\mid N, n_1, n_2) = \\frac{\\binom{n_1}{m} \\binom{N-n_1}{n_2-m}}{\\binom{N}{n_2}} $$\n$m$ 的可能取值范围是 $\\max(0, n_1+n_2-N) \\le m \\le \\min(n_1, n_2)$。\n\n提出的偏差校正估计量是 Chapman 估计量：\n$$ \\hat{N} = \\frac{(n_1+1)(n_2+1)}{m+1} - 1 $$\n为了证明该估计量是无偏的，我们必须证明其期望值 $E[\\hat{N}]$ 等于 $N$。\n$$ E[\\hat{N}] = E\\left[ \\frac{(n_1+1)(n_2+1)}{m+1} - 1 \\right] = (n_1+1)(n_2+1) E\\left[ \\frac{1}{m+1} \\right] - 1 $$\n期望是关于 $m$ 的分布计算的。我们通过计算 $E\\left[\\frac{1}{m+1}\\right]$ 来进行。\n$$ E\\left[\\frac{1}{m+1}\\right] = \\sum_{m} \\frac{1}{m+1} \\Pr(m \\mid N, n_1, n_2) = \\sum_{m} \\frac{1}{m+1} \\frac{\\binom{n_1}{m} \\binom{N-n_1}{n_2-m}}{\\binom{N}{n_2}} $$\n我们使用组合恒等式 $\\frac{1}{k+1}\\binom{n}{k} = \\frac{1}{n+1}\\binom{n+1}{k+1}$。令 $n=n_1$ 和 $k=m$ 应用此恒等式：\n$$ \\frac{1}{m+1}\\binom{n_1}{m} = \\frac{1}{n_1+1}\\binom{n_1+1}{m+1} $$\n将此代入期望的表达式中：\n$$ E\\left[\\frac{1}{m+1}\\right] = \\frac{1}{\\binom{N}{n_2}} \\sum_m \\frac{1}{n_1+1} \\binom{n_1+1}{m+1} \\binom{N-n_1}{n_2-m} $$\n提出常数项：\n$$ E\\left[\\frac{1}{m+1}\\right] = \\frac{1}{(n_1+1)\\binom{N}{n_2}} \\sum_m \\binom{n_1+1}{m+1} \\binom{N-n_1}{n_2-m} $$\n求和项可以使用范德蒙恒等式（Vandermonde's Identity）进行简化，该恒等式表述为 $\\sum_k \\binom{r}{k}\\binom{s}{n-k} = \\binom{r+s}{n}$。令 $k=m+1$。求和变为：\n$$ \\sum_{k} \\binom{n_1+1}{k} \\binom{N-n_1}{n_2-(k-1)} = \\sum_{k} \\binom{n_1+1}{k} \\binom{N-n_1}{(n_2+1)-k} $$\n这符合范德蒙恒等式的形式，其中 $r=n_1+1$，$s=N-n_1$，要选择的总项数为 $n_2+1$。因此，求和结果为：\n$$ \\binom{(n_1+1)+(N-n_1)}{n_2+1} = \\binom{N+1}{n_2+1} $$\n现在我们将此结果代回 $E\\left[\\frac{1}{m+1}\\right]$ 的表达式中：\n$$ E\\left[\\frac{1}{m+1}\\right] = \\frac{1}{(n_1+1)\\binom{N}{n_2}} \\binom{N+1}{n_2+1} $$\n接下来，我们展开二项式系数的比率：\n$$ \\frac{\\binom{N+1}{n_2+1}}{\\binom{N}{n_2}} = \\frac{(N+1)!}{(n_2+1)!(N-n_2)!} \\cdot \\frac{n_2!(N-n_2)!}{N!} = \\frac{N+1}{n_2+1} $$\n将这个简化的比率代回得到：\n$$ E\\left[\\frac{1}{m+1}\\right] = \\frac{1}{n_1+1} \\cdot \\frac{N+1}{n_2+1} $$\n这是一个关键的中间结果。现在我们回到估计量 $\\hat{N}$ 的期望：\n$$ E[\\hat{N}] = (n_1+1)(n_2+1) E\\left[ \\frac{1}{m+1} \\right] - 1 $$\n$$ E[\\hat{N}] = (n_1+1)(n_2+1) \\left( \\frac{1}{n_1+1} \\cdot \\frac{N+1}{n_2+1} \\right) - 1 $$\n$$ E[\\hat{N}] = (N+1) - 1 = N $$\n这证明了 Chapman 估计量 $\\hat{N} = \\frac{(n_1+1)(n_2+1)}{m+1} - 1$ 是 $N$ 的一个无偏估计量。需要注意的是，这个结果是精确无偏的，前提是 $n_1 + n_2 \\ge N$，这确保了期望的求和覆盖了恒等式所需的全部支撑集。如果不满足此条件，会保留一个小的偏差，但该估计量的偏差仍远小于朴素的 Lincoln-Petersen 估计量，尤其是在小样本量的情况下。\n\n### 违反独立性假设的定性分析\n\n上述推导严重依赖于两个监测名单是独立的假设。估计量的结构 $\\hat{N} \\approx \\frac{n_1 n_2}{m}$ 表明，总人口规模的估计值与观察到的重叠数 $m$ 成反比。违反独立性假设会系统地改变 $m$，导致对 $N$ 的估计出现偏差。\n\n1.  **正相关（报告偏差协同效应）**\n    -   **条件**：正相关意味着一个监测系统捕获的病例比仅凭偶然性预期的更有可能被第二个系统捕获。数学上，$\\Pr(L_2=1 \\mid L_1=1) > \\Pr(L_2=1)$。这种情况经常发生在两个系统都从相似的来源池中抽取样本时，例如，如果住院和实验室检测都是由需要住院的严重病例表现触发的。\n    -   **对重叠数 ($m$) 的影响**：对于给定的名单大小 $n_1$ 和 $n_2$，正相关将导致更多病例出现在两个名单上。因此，观察到的重叠计数 $m$ 将被人为地夸大，高于在独立性假设下预期的计数。\n    -   **对估计量 ($\\hat{N}$) 的影响**：由于估计量 $\\hat{N}$ 与 $m$（或 $m+1$）成反比，表达式 $\\frac{(n_1+1)(n_2+1)}{m+1}$ 中分母里被夸大的 $m$ 值将导致一个较小的估计值。因此，正相关导致对真实人口规模 $N$ 的**低估**。人口规模会显得比实际小，因为两个名单的独立性低于假设。\n\n2.  **负相关（报告偏差拮抗作用）**\n    -   **条件**：负相关意味着一个系统捕获的病例不太可能被另一个系统捕获。数学上，$\\Pr(L_2=1 \\mid L_1=1)  \\Pr(L_2=1)$。这种情况不太常见，但可能出现于两个监测系统针对相互排斥的亚群，例如，如果一个名单从公共卫生诊所捕获病例，而另一个从病人交叉很少的私立专科医院捕获病例。\n    -   **对重叠数 ($m$) 的影响**：对于给定的名单大小 $n_1$ 和 $n_2$，捕获之间的负相关将导致更少的病例出现在两个名单上。观察到的重叠计数 $m$ 将被人为地缩小。\n    -   **对估计量 ($\\hat{N}$) 的影响**：分母中被缩小的 $m$ 值会导致一个更大的总估计值。因此，负相关导致对真实人口规模 $N$ 的**高估**。人口规模会显得比实际大，因为两个名单的重叠远少于偶然情况下应有的重叠。\n\n总之，$\\hat{N}$ 中偏差的方向与重叠计数 $m$ 在独立性假设下偏离其期望值的方向相反。",
            "answer": "$$\\boxed{\\frac{(n_{1} + 1)(n_{2} + 1)}{m + 1} - 1}$$"
        },
        {
            "introduction": "监测系统往往不成比例地捕捉到更严重的病例，因为这些患者更有可能寻求医疗服务并被检测，这会扭曲我们对疾病严重性的理解。这个练习  提供了一个具体的机会，让你亲手量化这种“严重性偏倚”如何导致我们观察到的病死率（Case Fatality Risk, CFR）被高估。通过这个过程，你还将学习一种强大的校正技术——逆概率加权法（Inverse Probability Weighting），它是处理此类选择性偏倚的基础方法。",
            "id": "4630095",
            "problem": "一家公共卫生机构通过国家被动监测系统监测一种呼吸道病原体。检测结果在很大程度上受临床结局严重性的影响，因为病情较重的患者更可能寻求医疗并接受检测。考虑临床确诊病例的三个互斥的严重性分层：轻度、中度和重度。设每个分层中新发病例的人群比例分别为 $\\pi_{\\text{mild}}$、$\\pi_{\\text{moderate}}$ 和 $\\pi_{\\text{severe}}$，且 $\\pi_{\\text{mild}} + \\pi_{\\text{moderate}} + \\pi_{\\text{severe}} = 1$。将真实病死风险 (CFR) 定义为临床确诊病例死亡的概率，$C = \\Pr(\\text{death} \\mid \\text{case})$。设 $f_{s} = \\Pr(\\text{death} \\mid \\text{case in stratum } s)$ 为分层 $s$ 的特异性病死概率，其中 $s \\in \\{\\text{mild}, \\text{moderate}, \\text{severe}\\}$。设 $p_{s} = \\Pr(\\text{detected by surveillance} \\mid \\text{case in stratum } s)$ 为分层特异性检测概率。该监测系统简单地将 CFR 估计为检测到的死亡数与检测到的病例数之比。\n\n从条件概率和全概率定律的基本定义出发，推导基于监测的 CFR 估计量在期望下的表达式，以及偏差 $B$ 的表达式，其中 $B = C^{\\text{obs}} - C$，$C^{\\text{obs}}$ 是期望中基于监测的估计量。然后，提出一种基于逆检测概率的严重性加权调整方法，并证明在 $p_{s}$ 被正确定指的情况下，该方法能在期望上恢复真实的 CFR。\n\n对于一种科学上合理的病原体，假设以下参数值成立：\n- $\\pi_{\\text{mild}} = 0.65$，$\\pi_{\\text{moderate}} = 0.25$，$\\pi_{\\text{severe}} = 0.10$。\n- $f_{\\text{mild}} = 0.002$，$f_{\\text{moderate}} = 0.015$，$f_{\\text{severe}} = 0.20$。\n- $p_{\\text{mild}} = 0.30$，$p_{\\text{moderate}} = 0.70$，$p_{\\text{severe}} = 0.95$。\n\n使用这些值，计算偏差 $B$ 的数值。将您的数值答案表示为不带百分号的小数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导真实和基于监测的病死风险 (CFR)、它们之间的偏差，提出一个调整后的估计量，并对偏差进行数值计算。在尝试任何解答之前，必须对问题陈述进行验证。\n\n### 第 1 步：提取已知条件\n-   严重程度分层 ($s$)：轻度、中度、重度。\n-   病例的人群比例：$\\pi_{\\text{mild}}$、$\\pi_{\\text{moderate}}$、$\\pi_{\\text{severe}}$。\n-   约束条件：$\\pi_{\\text{mild}} + \\pi_{\\text{moderate}} + \\pi_{\\text{severe}} = 1$。\n-   真实 CFR：$C = \\Pr(\\text{death} \\mid \\text{case})$。\n-   分层特异性病死概率：$f_{s} = \\Pr(\\text{death} \\mid \\text{case in stratum } s)$。\n-   分层特异性检测概率：$p_{s} = \\Pr(\\text{detected by surveillance} \\mid \\text{case in stratum } s)$。\n-   基于监测的 CFR 估计量 ($C^{\\text{obs}}$)：检测到的死亡数与检测到的病例数之比的期望值。\n-   偏差：$B = C^{\\text{obs}} - C$。\n-   参数值：\n    -   $\\pi_{\\text{mild}} = 0.65$，$\\pi_{\\text{moderate}} = 0.25$，$\\pi_{\\text{severe}} = 0.10$。\n    -   $f_{\\text{mild}} = 0.002$，$f_{\\text{moderate}} = 0.015$，$f_{\\text{severe}} = 0.20$。\n    -   $p_{\\text{mild}} = 0.30$，$p_{\\text{moderate}} = 0.70$，$p_{\\text{severe}} = 0.95$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题在科学上基于监测、报告偏倚（也称为选择偏倚）和风险估计等基本流行病学原理。病死风险、按严重程度分层以及差异性检测概率等概念在传染病流行病学中是标准概念。该问题提法得当；它提供了清晰的定义、推导所需的所有参数以及用于计算的全套数值。问题是客观的，并使用了精确、无歧义的术语。比例 $\\pi_s$ 的总和为 $0.65 + 0.25 + 0.10 = 1$，证实了其内部一致性。对于一种呼吸道病原体而言，这些参数值是合理的，因为严重程度会同时增加死亡概率和检测概率。该问题不违反任何无效性标准。\n\n### 第 3 步：结论与行动\n问题有效。将提供解答。\n\n### 真实 CFR ($C$) 的推导\n真实病死风险 $C$ 是指在给定病例的情况下死亡的边际概率。根据全概率定律，我们可以通过对互斥的严重程度分层 $s \\in \\{\\text{mild}, \\text{moderate}, \\text{severe}\\}$ 求和来表示 $C$：\n$$C = \\Pr(\\text{death} \\mid \\text{case}) = \\sum_{s} \\Pr(\\text{death} \\mid \\text{case in stratum } s) \\Pr(\\text{case in stratum } s \\mid \\text{case})$$\n根据题目的定义，$\\Pr(\\text{death} \\mid \\text{case in stratum } s) = f_s$ 且分层 $s$ 中的病例比例 $\\Pr(\\text{case in stratum } s \\mid \\text{case})$ 为 $\\pi_s$。因此，真实 CFR 是各分层特异性病死概率的加权平均值，权重为各分层中病例的真实比例：\n$$C = \\sum_{s} f_{s} \\pi_{s}$$\n\n### 基于监测的 CFR ($C^{\\text{obs}}$) 的推导\n期望中基于监测的 CFR 估计量 $C^{\\text{obs}}$ 是在被检测到的情况下死亡的条件概率：\n$$C^{\\text{obs}} = \\Pr(\\text{death} \\mid \\text{detected})$$\n使用条件概率的定义，这可以写成：\n$$C^{\\text{obs}} = \\frac{\\Pr(\\text{death} \\cap \\text{detected})}{\\Pr(\\text{detected})}$$\n我们使用全概率定律展开分子和分母，对严重程度分层进行求和。病例被检测到的总概率是：\n$$\\Pr(\\text{detected}) = \\sum_{s} \\Pr(\\text{detected} \\mid \\text{case in stratum } s) \\Pr(\\text{case in stratum } s) = \\sum_{s} p_{s} \\pi_{s}$$\n病例被检测到并导致死亡的概率是：\n$$\\Pr(\\text{death} \\cap \\text{detected}) = \\sum_{s} \\Pr(\\text{death} \\cap \\text{detected} \\mid \\text{case in stratum } s) \\Pr(\\text{case in stratum } s)$$\n一个关键的标准假设是，在给定的严重程度分层 $s$ 内，结局（死亡）和检测过程是条件独立的。即，$\\Pr(\\text{death} \\cap \\text{detected} \\mid \\text{case in stratum } s) = \\Pr(\\text{death} \\mid \\text{case in stratum } s) \\Pr(\\text{detected} \\mid \\text{case in stratum } s) = f_s p_s$。因此，分子变为：\n$$\\Pr(\\text{death} \\cap \\text{detected}) = \\sum_{s} f_{s} p_{s} \\pi_{s}$$\n综合这些结果，期望中基于监测的 CFR 的表达式为：\n$$C^{\\text{obs}} = \\frac{\\sum_{s} f_{s} p_{s} \\pi_{s}}{\\sum_{s} p_{s} \\pi_{s}}$$\n\n### 偏差 ($B$) 的推导\n偏差 $B$ 被定义为观测到的 CFR 与真实 CFR 之间的差异：\n$$B = C^{\\text{obs}} - C = \\frac{\\sum_{s} f_{s} p_{s} \\pi_{s}}{\\sum_{s} p_{s} \\pi_{s}} - \\sum_{s} f_{s} \\pi_{s}$$\n产生这种偏差是因为 $C^{\\text{obs}}$ 是分层特异性病死风险 $f_s$ 的加权平均值，但其权重是 $\\frac{p_s \\pi_s}{\\sum_k p_k \\pi_k}$，这是各分层中被检测出的病例的比例，而不是真实的比例 $\\pi_s$。由于检测概率 $p_s$ 与病死风险 $f_s$ 呈正相关，病死率较高的分层在监测数据中被过度代表，导致对真实 CFR 的高估 ($B0$)。\n\n### 提出的调整后估计量\n为了校正这种偏差，我们可以提出一个基于逆检测概率的严重程度加权估计量。其原理是对来自检测概率较低的分层的观测值赋予更高的权重，以重建真实的人群比例。\n设 $N$ 为新发病例总数。分层 $s$ 中检测到的病例数为 $N_s^{\\text{det}}$，分层 $s$ 中检测到的死亡数为 $D_s^{\\text{det}}$。\n在期望中，$E[N_s^{\\text{det}}] = N \\pi_s p_s$ 且 $E[D_s^{\\text{det}}] = N \\pi_s f_s p_s$。\n提出的调整后估计量 $C^{\\text{adj}}$ 是通过逆概率加权估计的总死亡人数与类似方法估计的总病例数之比：\n$$C^{\\text{adj}} = \\frac{\\sum_{s} (D_s^{\\text{det}} / p_s)}{\\sum_{s} (N_s^{\\text{det}} / p_s)}$$\n为证明该估计量在期望上能恢复真实 CFR，我们考察分子和分母期望值的比率（这是对此类比率估计量的标准方法，意味着渐近无偏性）：\n$$E[C^{\\text{adj}}] \\approx \\frac{E[\\sum_{s} (D_s^{\\text{det}} / p_s)]}{E[\\sum_{s} (N_s^{\\text{det}} / p_s)]} = \\frac{\\sum_{s} (1/p_s) E[D_s^{\\text{det}}]}{\\sum_{s} (1/p_s) E[N_s^{\\text{det}}]}$$\n代入期望值：\n$$E[C^{\\text{adj}}] \\approx \\frac{\\sum_{s} (1/p_s) (N \\pi_s f_s p_s)}{\\sum_{s} (1/p_s) (N \\pi_s p_s)} = \\frac{\\sum_{s} N \\pi_s f_s}{\\sum_{s} N \\pi_s}$$\n提出因子 $N$：\n$$E[C^{\\text{adj}}] \\approx \\frac{N \\sum_{s} f_s \\pi_s}{N \\sum_{s} \\pi_s}$$\n鉴于 $\\sum_{s} \\pi_s = 1$ 且 $\\sum_{s} f_s \\pi_s = C$，上式简化为：\n$$E[C^{\\text{adj}}] \\approx \\frac{N C}{N} = C$$\n因此，在分层特异性检测概率 $p_s$ 被正确定指的情况下，逆概率加权估计量是真实 CFR $C$ 的一个无偏估计量。\n\n### 偏差的数值计算\n使用提供的参数值：\n-   $\\pi_{\\text{mild}} = 0.65$，$\\pi_{\\text{moderate}} = 0.25$，$\\pi_{\\text{severe}} = 0.10$。\n-   $f_{\\text{mild}} = 0.002$，$f_{\\text{moderate}} = 0.015$，$f_{\\text{severe}} = 0.20$。\n-   $p_{\\text{mild}} = 0.30$，$p_{\\text{moderate}} = 0.70$，$p_{\\text{severe}} = 0.95$。\n\n首先，计算真实 CFR, $C$：\n$$C = f_{\\text{mild}}\\pi_{\\text{mild}} + f_{\\text{moderate}}\\pi_{\\text{moderate}} + f_{\\text{severe}}\\pi_{\\text{severe}}$$\n$$C = (0.002)(0.65) + (0.015)(0.25) + (0.20)(0.10)$$\n$$C = 0.0013 + 0.00375 + 0.02 = 0.02505$$\n\n接着，计算期望的观测 CFR, $C^{\\text{obs}}$：\n$$C^{\\text{obs}} = \\frac{\\sum_{s} f_{s} p_{s} \\pi_{s}}{\\sum_{s} p_{s} \\pi_{s}}$$\n分子：\n$$ \\sum_{s} f_{s} p_{s} \\pi_{s} = (0.002)(0.30)(0.65) + (0.015)(0.70)(0.25) + (0.20)(0.95)(0.10) $$\n$$ \\sum_{s} f_{s} p_{s} \\pi_{s} = 0.00039 + 0.002625 + 0.019 = 0.022015 $$\n分母：\n$$ \\sum_{s} p_{s} \\pi_{s} = (0.30)(0.65) + (0.70)(0.25) + (0.95)(0.10) $$\n$$ \\sum_{s} p_{s} \\pi_{s} = 0.195 + 0.175 + 0.095 = 0.465 $$\n所以，\n$$C^{\\text{obs}} = \\frac{0.022015}{0.465} \\approx 0.047344086$$\n\n最后，计算偏差, $B$：\n$$B = C^{\\text{obs}} - C$$\n$$B \\approx 0.047344086 - 0.02505 = 0.022294086$$\n四舍五入到四位有效数字，偏差为 $0.02229$。",
            "answer": "$$\\boxed{0.02229}$$"
        },
        {
            "introduction": "为了校正报告不足的问题，我们首先需要估计其程度。这个练习  演示了一种在现实世界中非常实用的方法：将常规的病例报告数据与来自独立血清学调查的数据相结合，以获得对疫情更完整的认识。你将不仅学习如何估计平均报告概率，还将掌握使用德尔塔方法（Delta Method）来量化该估计值不确定性的技巧，这在任何定量流行病学分析中都是一项至关重要的技能。",
            "id": "4630172",
            "problem": "一个人口规模为 $N = 800{,}000$ 的行政区对一种新型传染病进行了为期 $T = 8$ 周的常规病例监测。报告的每周病例数分别为 $Y_1 = 1200$, $Y_2 = 1500$, $Y_3 = 1800$, $Y_4 = 1600$, $Y_5 = 1700$, $Y_6 = 1400$, $Y_7 = 1300$ 和 $Y_8 = 1500$。独立地，在第 8 周结束时，对同一人群中的 $m = 1200$ 名个体进行了一次简单随机抽样血清学调查，其中有 $x = 72$ 人的血清检测呈阳性。在本练习中，假设血清学检测是完美的，因此血清阳性率直接估计了累积发病率。\n\n使用以下基本事实作为您的出发点：\n- 在此期间的累积报告数是 $C = \\sum_{t=1}^{T} Y_t$。\n- 累积发病率由简单随机样本的样本比例 $\\widehat{\\Pi} = x/m$ 估计，当抽样分数很小时，其近似方差为 $\\mathrm{Var}(\\widehat{\\Pi}) \\approx \\Pi (1 - \\Pi)/m$。\n- 对于条件独立且可以很好地用泊松分布近似的监测计数，$\\mathrm{Var}(Y_t) \\approx \\mathbb{E}[Y_t]$，因此 $\\mathrm{Var}(C) \\approx \\sum_{t=1}^{T} \\mathbb{E}[Y_t]$，这可以由 $\\sum_{t=1}^{T} Y_t$ 估计。\n- 血清学调查和常规监测是独立的数据来源。\n- 该时期的平均报告概率 $\\bar{p}$ 的定义是：期望报告病例数等于 $\\bar{p}$ 乘以该时期的总感染人数，即 $N \\Pi$。\n\n任务：\n1) 使用观测数据和上述定义，推导平均报告概率 $\\bar{p}$ 的一个一致的点估计量 $\\widehat{\\bar{p}}$，并计算其数值。\n2) 使用 delta 方法，将 $\\widehat{\\bar{p}}$ 视为随机量 $C$ 和 $\\widehat{\\Pi}$ 的平滑函数，并利用上述针对 $C$ 和 $\\widehat{\\Pi}$ 的方差近似，推导并计算近似标准误 $\\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}})$。\n\n假设 $C$ 和 $\\widehat{\\Pi}$ 之间相互独立，并将所有概率表示为小数（而非百分比）。按以下格式报告您的答案：按顺序提供数对 $\\left(\\widehat{\\bar{p}}, \\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}})\\right)$。将两个数字都四舍五入到四位有效数字。",
            "solution": "该问题要求基于常规监测病例数和横断面血清学调查，估计平均报告概率 $\\bar{p}$ 及其标准误。该问题具有科学依据，提法恰当，并为得到唯一解提供了所有必要的数据和定义。\n\n首先，我们根据所提供的数据计算初步的量。\n总人口为 $N = 800{,}000$。\n监测期为 $T = 8$ 周。\n累积报告病例数 $C$ 是每周病例数 $Y_t$ 的总和：\n$$C = \\sum_{t=1}^{8} Y_t = 1200 + 1500 + 1800 + 1600 + 1700 + 1400 + 1300 + 1500 = 12{,}000$$\n血清学调查的样本量为 $m = 1200$，其中 $x = 72$ 人血清呈阳性。\n估计的累积发病率 $\\widehat{\\Pi}$ 是样本中血清阳性个体的比例：\n$$\\widehat{\\Pi} = \\frac{x}{m} = \\frac{72}{1200} = 0.06$$\n\n**1) 点估计量 $\\widehat{\\bar{p}}$ 的推导与计算**\n\n平均报告概率 $\\bar{p}$ 由期望报告病例数 $\\mathbb{E}[C]$ 与人群中总感染人数 $N\\Pi$ 之间的关系定义。问题将此关系表述为：\n$$\\mathbb{E}[C] = \\bar{p} N \\Pi$$\n为了推导 $\\bar{p}$ 的点估计量，我们采用矩估计法。我们将总体参数和期望值替换为它们相应的样本估计量。观测到的累积计数 $C$ 是其期望 $\\mathbb{E}[C]$ 的一个自然估计量，而样本比例 $\\widehat{\\Pi}$ 是真实累积发病率 $\\Pi$ 的一个一致估计量。\n将这些估计量代入定义方程，得到关于 $\\bar{p}$ 的一个估计方程：\n$$C \\approx \\widehat{\\bar{p}} N \\widehat{\\Pi}$$\n解出 $\\widehat{\\bar{p}}$，我们得到点估计量：\n$$\\widehat{\\bar{p}} = \\frac{C}{N \\widehat{\\Pi}}$$\n现在，我们代入计算出的数值：\n$$\\widehat{\\bar{p}} = \\frac{12{,}000}{800{,}000 \\times 0.06} = \\frac{12{,}000}{48{,}000} = 0.25$$\n\n**2) 标准误 $\\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}})$ 的推导与计算**\n\n为了求出 $\\widehat{\\bar{p}}$ 的标准误，我们首先使用 delta 方法求其近似方差。我们的估计量 $\\widehat{\\bar{p}}$ 是两个独立随机变量 $C$ 和 $\\widehat{\\Pi}$ 的函数：\n$$\\widehat{\\bar{p}} = g(C, \\widehat{\\Pi}) = \\frac{C}{N\\widehat{\\Pi}}$$\ndelta 方法指出，对于两个独立随机变量的函数，其方差可以近似为：\n$$\\mathrm{Var}(\\widehat{\\bar{p}}) \\approx \\left( \\frac{\\partial g}{\\partial C} \\right)^2 \\mathrm{Var}(C) + \\left( \\frac{\\partial g}{\\partial \\widehat{\\Pi}} \\right)^2 \\mathrm{Var}(\\widehat{\\Pi})$$\n偏导数必须在 $C$ 和 $\\widehat{\\Pi}$ 的均值处求值。在实践中，我们在估计值处对它们进行求值。\n\n首先，我们计算 $g(C, \\widehat{\\Pi})$ 的偏导数：\n$$\\frac{\\partial g}{\\partial C} = \\frac{1}{N\\widehat{\\Pi}}$$\n$$\\frac{\\partial g}{\\partial \\widehat{\\Pi}} = -\\frac{C}{N\\widehat{\\Pi}^2}$$\n接下来，我们使用问题陈述中提供的方差近似。基于泊松模型的假设，累积计数 $C$ 的方差由 $C$ 本身来估计：\n$$\\widehat{\\mathrm{Var}}(C) = C = 12{,}000$$\n累积发病率估计 $\\widehat{\\Pi}$ 的方差由二项比例方差公式给出：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\Pi}) = \\frac{\\widehat{\\Pi}(1 - \\widehat{\\Pi})}{m} = \\frac{0.06 \\times (1 - 0.06)}{1200} = \\frac{0.06 \\times 0.94}{1200} = \\frac{0.0564}{1200} = 0.000047$$\n现在，我们将这些导数和方差估计值代入 delta 方法公式中。我们在 $C$ 和 $\\widehat{\\Pi}$ 的观测值处对偏导数进行求值：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx \\left( \\frac{1}{N\\widehat{\\Pi}} \\right)^2 \\widehat{\\mathrm{Var}}(C) + \\left( -\\frac{C}{N\\widehat{\\Pi}^2} \\right)^2 \\widehat{\\mathrm{Var}}(\\widehat{\\Pi})$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx \\frac{1}{(N\\widehat{\\Pi})^2} C + \\frac{C^2}{N^2\\widehat{\\Pi}^4} \\left( \\frac{\\widehat{\\Pi}(1 - \\widehat{\\Pi})}{m} \\right)$$\n通过代入 $\\widehat{\\bar{p}} = C/(N\\widehat{\\Pi})$，可以得到一个更简洁的表达式：\n$$\\frac{1}{N\\widehat{\\Pi}} = \\frac{\\widehat{\\bar{p}}}{C} \\quad \\text{and} \\quad \\frac{C}{N\\widehat{\\Pi}^2} = \\frac{\\widehat{\\bar{p}}}{\\widehat{\\Pi}}$$\n将这些代入方差公式中：\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx \\left(\\frac{\\widehat{\\bar{p}}}{C}\\right)^2 C + \\left(-\\frac{\\widehat{\\bar{p}}}{\\widehat{\\Pi}}\\right)^2 \\left(\\frac{\\widehat{\\Pi}(1 - \\widehat{\\Pi})}{m}\\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx \\frac{\\widehat{\\bar{p}}^2}{C} + \\frac{\\widehat{\\bar{p}}^2}{\\widehat{\\Pi}^2} \\frac{\\widehat{\\Pi}(1 - \\widehat{\\Pi})}{m} = \\widehat{\\bar{p}}^2 \\left( \\frac{1}{C} + \\frac{1 - \\widehat{\\Pi}}{m\\widehat{\\Pi}} \\right)$$\n这个最终表达式将 $\\widehat{\\bar{p}}$ 的相对方差与 $C$ 和 $\\widehat{\\Pi}$ 的相对方差之和联系起来。我们现在可以计算方差的数值：\n$$\\frac{1}{C} = \\frac{1}{12{,}000}$$\n$$\\frac{1 - \\widehat{\\Pi}}{m\\widehat{\\Pi}} = \\frac{1 - 0.06}{1200 \\times 0.06} = \\frac{0.94}{72}$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx (0.25)^2 \\left( \\frac{1}{12{,}000} + \\frac{0.94}{72} \\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx 0.0625 \\left( 0.00008333\\ldots + 0.01305555\\ldots \\right)$$\n$$\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}}) \\approx 0.0625 \\times (0.01313888\\ldots) \\approx 0.0008211805\\ldots$$\n标准误是方差的平方根：\n$$\\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}}) = \\sqrt{\\widehat{\\mathrm{Var}}(\\widehat{\\bar{p}})} \\approx \\sqrt{0.0008211805\\ldots} \\approx 0.02865623$$\n将估计值四舍五入到四位有效数字，我们得到：\n$$\\widehat{\\bar{p}} = 0.2500$$\n$$\\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}}) \\approx 0.02866$$\n最终结果是数对 $(\\widehat{\\bar{p}}, \\widehat{\\mathrm{SE}}(\\widehat{\\bar{p}}))$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.2500  0.02866\n\\end{pmatrix}\n}\n$$"
        }
    ]
}