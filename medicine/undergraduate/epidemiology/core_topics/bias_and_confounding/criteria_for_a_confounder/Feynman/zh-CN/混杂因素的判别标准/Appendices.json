{
    "hands_on_practices": [
        {
            "introduction": "识别混杂因素后，下一步是调整其影响以获得无偏的效应估计。本练习将通过一个基础而重要的方法——标准化，来指导您完成这一过程。您将使用观察数据，首先验证一个变量是否满足混杂因素的经典标准，然后应用标准化方法计算目标人群中的因果风险差，从而将理论概念付诸实践 。",
            "id": "4582738",
            "problem": "考虑一项关于预防性治疗的观察性队列研究，其中包含二元暴露 $A \\in \\{0,1\\}$、二元结局 $Y \\in \\{0,1\\}$，以及在暴露分配前测量的基线协变量 $L \\in \\{0,1\\}$。该研究旨在估计因果风险差 $E[Y_{1}] - E[Y_{0}]$，其中 $Y_{a}$ 表示在暴露设置为 $a$ 时的潜在结局。\n\n给定来自该队列的以下分层计数：\n- 对于 $L=0$：在暴露组（$A=1$）中，有 $n_{10}=220$ 个个体和 $y_{10}=33$ 个观测结局（$Y=1$）；在非暴露组（$A=0$）中，有 $n_{00}=380$ 个个体和 $y_{00}=38$ 个观测结局。\n- 对于 $L=1$：在暴露组（$A=1$）中，有 $n_{11}=180$ 个个体和 $y_{11}=54$ 个观测结局；在非暴露组（$A=0$）中，有 $n_{01}=220$ 个个体和 $y_{01}=44$ 个观测结局。\n\n假设用于推断的目标人群中 $L$ 的边际分布为 $P(L=0)=0.6$ 和 $P(L=1)=0.4$。\n\n任务：\n1. 根据所提供的信息，运用因果推断的基本原理，验证在此情境下 $L$ 是否满足作为 $A$ 对 $Y$ 效应的混杂因素的标准。\n2. 在一致性、给定 $L$ 的条件可交换性和正值性假设下，根据核心定义和全期望定律推导出一个识别策略，以可观测量的形式表示 $E[Y_{1}] - E[Y_{0}]$。\n3. 使用所提供的数据，计算目标人群的因果风险差的数值。\n\n将最终数值答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它科学地基于因果推断的原理，问题设定良好，数据充分，目标明确，并使用客观、正式的语言进行表述。我们继续进行解答。\n\n解答根据问题陈述的要求分为三个部分。\n\n### 第1部分：验证 $L$ 作为混杂因素\n\n一个基线协变量 $L$ 是暴露 $A$ 对结局 $Y$ 因果效应的混杂因素，如果它满足以下三个标准：\n1.  $L$ 与暴露 $A$ 相关。\n2.  在给定暴露 $A$ 的条件下，$L$ 与结局 $Y$ 相关。（这意味着 $L$ 是 $Y$ 的一个风险因素）。\n3.  $L$ 不在从 $A$ 到 $Y$ 的因果路径上。\n\n问题陈述 $L$ 是“在暴露分配前测量的基线协变量”，这通过时间顺序满足了第三个标准。我们必须使用所提供的数据验证前两个标准。相关性通过样本计数的经验概率进行评估。\n\n**标准1：$L$ 与 $A$ 之间的关联**\n\n我们检验暴露的概率在 $L$ 的不同分层中是否存在差异，即 $P(A=1|L=1) \\neq P(A=1|L=0)$。\n在分层 $L=0$ 中的总个体数为 $n_{10} + n_{00} = 220 + 380 = 600$。\n在分层 $L=1$ 中的总个体数为 $n_{11} + n_{01} = 180 + 220 = 400$。\n\n给定 $L=0$ 时，暴露（$A=1$）的概率估计为：\n$$\nP(A=1|L=0) = \\frac{n_{10}}{n_{10} + n_{00}} = \\frac{220}{600} = \\frac{11}{30} \\approx 0.3667\n$$\n给定 $L=1$ 时，暴露（$A=1$）的概率估计为：\n$$\nP(A=1|L=1) = \\frac{n_{11}}{n_{11} + n_{01}} = \\frac{180}{400} = \\frac{9}{20} = 0.45\n$$\n由于 $P(A=1|L=0) \\neq P(A=1|L=1)$ ($0.3667 \\neq 0.45$)，因此在该研究人群中，$L$ 与暴露 $A$ 相关。\n\n**标准2：在给定 $A$ 的条件下 $L$ 与 $Y$ 之间的关联**\n\n我们检验在暴露 $A$ 的不同水平内，结局的概率在 $L$ 的不同分层中是否存在差异。\n\n首先，在非暴露组（$A=0$）中：\n我们检验是否 $P(Y=1|A=0, L=1) \\neq P(Y=1|A=0, L=0)$。\n在分层 $L=0$ 的非暴露组中，结局的风险为：\n$$\nP(Y=1|A=0, L=0) = \\frac{y_{00}}{n_{00}} = \\frac{38}{380} = 0.10\n$$\n在分层 $L=1$ 的非暴露组中，结局的风险为：\n$$\nP(Y=1|A=0, L=1) = \\frac{y_{01}}{n_{01}} = \\frac{44}{220} = 0.20\n$$\n由于 $P(Y=1|A=0, L=0) \\neq P(Y=1|A=0, L=1)$ ($0.10 \\neq 0.20$)，因此在非暴露组中，$L$ 与结局 $Y$ 相关。\n\n其次，在暴露组（$A=1$）中：\n我们检验是否 $P(Y=1|A=1, L=1) \\neq P(Y=1|A=1, L=0)$。\n在分层 $L=0$ 的暴露组中，结局的风险为：\n$$\nP(Y=1|A=1, L=0) = \\frac{y_{10}}{n_{10}} = \\frac{33}{220} = 0.15\n$$\n在分层 $L=1$ 的暴露组中，结局的风险为：\n$$\nP(Y=1|A=1, L=1) = \\frac{y_{11}}{n_{11}} = \\frac{54}{180} = 0.30\n$$\n由于 $P(Y=1|A=1, L=0) \\neq P(Y=1|A=1, L=1)$ ($0.15 \\neq 0.30$)，因此在暴露组中，$L$ 也与结局 $Y$ 相关。\n\n由于所有三个标准都得到满足，$L$ 是 $A$ 对 $Y$ 效应的一个混杂因素。\n\n### 第2部分：识别策略\n\n目标是以可观测量的形式表示因果风险差 $E[Y_1] - E[Y_0]$。推导过程依赖于一致性、条件可交换性和正值性假设。\n\n设 $E[Y_a]$ 为人群中每个人都被分配到暴露水平 $a \\in \\{0,1\\}$ 时的预期潜在结局。我们可以通过对目标人群中混杂因素 $L$ 的分布进行标准化来识别 $E[Y_a]$。\n\n1.  从全期望定律开始，对 $L$ 进行边缘化：\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} E[Y_a | L=l] P(L=l)\n    $$\n2.  应用*条件可交换性*（或无未测量混杂）的假设，$Y_a \\perp A | L$。该假设表明，在 $L$ 的分层内，潜在结局 $Y_a$ 与实际接受的暴露 $A$ 无关。这意味着：\n    $$\n    E[Y_a | L=l] = E[Y_a | A=a, L=l]\n    $$\n3.  应用*一致性*假设，该假设指出，对于接受了暴露 $A=a$ 的个体，其观测结局 $Y$ 等于其潜在结局 $Y_a$。这使我们能够将潜在结局与可观测结局联系起来：\n    $$\n    E[Y_a | A=a, L=l] = E[Y | A=a, L=l]\n    $$\n4.  结合这些步骤，得到 $E[Y_a]$ 的识别公式：\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} E[Y | A=a, L=l] P(L=l)\n    $$\n    由于 $Y$ 是二元的，$E[Y|A=a, L=l]$ 就是条件概率 $P(Y=1|A=a, L=l)$，这是一个可观测量。公式变为：\n    $$\n    E[Y_a] = \\sum_{l \\in \\{0,1\\}} P(Y=1 | A=a, L=l) P(L=l)\n    $$\n    *正值性*假设，$P(A=a|L=l) > 0$ 对所有 $a, l$ 成立，确保我们可以从数据中估计条件概率 $P(Y=1|A=a, L=l)$，因为在 $L$ 的每个分层中都存在两种暴露水平的个体。所提供的计数（$n_{10}=220, n_{00}=380, n_{11}=180, n_{01}=220$）均非零，满足此条件。\n\n那么，因果风险差 $E[Y_1] - E[Y_0]$ 被识别为：\n$$\nE[Y_1] - E[Y_0] = \\left(\\sum_{l=0}^{1} P(Y=1|A=1,L=l)P(L=l)\\right) - \\left(\\sum_{l=0}^{1} P(Y=1|A=0,L=l)P(L=l)\\right)\n$$\n这可以重写为：\n$$\nE[Y_1] - E[Y_0] = \\sum_{l=0}^{1} \\left( P(Y=1|A=1,L=l) - P(Y=1|A=0,L=l) \\right) P(L=l)\n$$\n这是风险差的标准化公式。\n\n### 第3部分：数值计算\n\n我们使用推导出的公式和所提供的数据来计算目标人群的因果风险差，其中 $P(L=0)=0.6$ 和 $P(L=1)=0.4$。\n\n首先，我们计算特定分层的可观测风险，这些风险在第1部分中也已使用。\n-   $P(Y=1|A=1, L=0) = \\frac{33}{220} = 0.15$\n-   $P(Y=1|A=0, L=0) = \\frac{38}{380} = 0.10$\n-   $P(Y=1|A=1, L=1) = \\frac{54}{180} = 0.30$\n-   $P(Y=1|A=0, L=1) = \\frac{44}{220} = 0.20$\n\n接下来，我们为目标人群计算标准化风险 $E[Y_1]$ 和 $E[Y_0]$。\n对于 $E[Y_1]$（如果每个人都暴露，则为标准化风险）：\n$$\nE[Y_1] = P(Y=1|A=1, L=0)P(L=0) + P(Y=1|A=1, L=1)P(L=1)\n$$\n$$\nE[Y_1] = (0.15)(0.6) + (0.30)(0.4) = 0.09 + 0.12 = 0.21\n$$\n\n对于 $E[Y_0]$（如果每个人都未暴露，则为标准化风险）：\n$$\nE[Y_0] = P(Y=1|A=0, L=0)P(L=0) + P(Y=1|A=0, L=1)P(L=1)\n$$\n$$\nE[Y_0] = (0.10)(0.6) + (0.20)(0.4) = 0.06 + 0.08 = 0.14\n$$\n\n最后，因果风险差是这两个标准化风险之间的差值：\n$$\nE[Y_1] - E[Y_0] = 0.21 - 0.14 = 0.07\n$$\n问题要求答案以小数形式表示，并四舍五入到四位有效数字。\n$$\n0.07000\n$$",
            "answer": "$$\n\\boxed{0.07000}\n$$"
        },
        {
            "introduction": "在流行病学研究中，分层分析是控制混杂的常用策略，而 Mantel-Haenszel (MH) 方法则提供了一种合并分层效应估计值的经典技术。本练习将引导您从原始数据出发，计算粗略效应和分层特异效应，以揭示混杂的存在。随后，您将推导并应用 MH 风险比估计量，深入理解其在假设效应度量在各分层间恒定时，如何提供一个调整后的汇总估计值 。",
            "id": "4582728",
            "problem": "考虑一项队列研究，其中包含一个二元暴露 $A \\in \\{0,1\\}$，一个在随访结束时测量的二元结局 $Y \\in \\{0,1\\}$，以及一个被怀疑是混杂因素的基线二元协变量 $L \\in \\{0,1\\}$。在 $L$ 的每个分层中，您观察到以下计数，其中 $a_{\\ell}$ 表示暴露组病例数，$b_{\\ell}$ 表示暴露组非病例数，$c_{\\ell}$ 表示非暴露组病例数，$d_{\\ell}$ 表示在分层 $L=\\ell$ 中的非暴露组非病例数：\n- 对于 $L=0$：$a_{0}=10$，$b_{0}=90$，$c_{0}=10$，$d_{0}=190$。\n- 对于 $L=1$：$a_{1}=20$，$b_{1}=30$，$c_{1}=10$，$d_{1}=40$。\n\n令 $n_{1\\ell}=a_{\\ell}+b_{\\ell}$ 为分层 $\\ell$ 中的暴露人数，$n_{0\\ell}=c_{\\ell}+d_{\\ell}$ 为分层 $\\ell$ 中的非暴露人数，$n_{\\ell}=n_{1\\ell}+n_{0\\ell}$ 为该分层的总人数。将一个单元格内的风险定义为该单元格中风险人群里出现病例的比例。目标效应度量是因果风险比 $\\text{RR}=P(Y^{1}=1)/P(Y^{0}=1)$，其中 $Y^{a}$ 表示在暴露水平为 $a$ 时的潜在结局。\n\n仅使用风险、关联的基本定义，以及潜在结局框架中的一致性、可交换性和正值性这些识别假设，完成以下任务：\n\n1) 使用上述数据，论证在该设定中 $L$ 是否满足混杂因素的传统标准（在源人群中与 $A$ 关联且与 $Y$ 独立关联，并且不是 $A$ 的后果）。\n\n2) 忽略 $L$ 计算粗风险比，即将样本视为未分层，计算暴露组总体风险与非暴露组总体风险之比。将您的结果表示为最简精确分数。\n\n3) 计算分层特异性风险比 $\\text{RR}_{\\ell}=P(Y=1 \\mid A=1,L=\\ell)/P(Y=1 \\mid A=0,L=\\ell)$，其中 $\\ell \\in \\{0,1\\}$，并说明它们在各分层中是否相等。\n\n4) 从跨分层的公共因果风险比的定义出发，推导队列研究中风险比的 Mantel–Haenszel (MH) 估计量，用分层特异性单元格计数 $\\{a_{\\ell},b_{\\ell},c_{\\ell},d_{\\ell}\\}$ 和总数 $\\{n_{1\\ell},n_{0\\ell},n_{\\ell}\\}$ 表示，并为上述数据计算其值。不要假设任何近似的罕见病条件。\n\n5) 假设对于每个分层 $\\ell$ 都存在一个常数 $\\theta>0$，使得 $P(Y=1 \\mid A=1,L=\\ell)=\\theta\\,P(Y=1 \\mid A=0,L=\\ell)$，并假设因果识别条件成立：一致性、正值性（对于所有 $a \\in \\{0,1\\}$ 和有支持域的分层，均有 $0  P(A=a \\mid L=\\ell)  1$），以及条件可交换性 $\\{Y^{0},Y^{1}\\} \\perp A \\mid L$。在这些条件下，对于大样本，推导您在第4部分中得到的 Mantel–Haenszel 风险比估计量的期望值，并将其表示为单个闭式解析表达式（用 $\\theta$ 表示）。您的最终答案必须是单个表达式。无需四舍五入。",
            "solution": "用户提供了一个关于流行病学中评估混杂和估计风险比的多部分问题。我将首先验证该问题，然后按顺序解答每个部分。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 研究类型：队列研究。\n- 暴露：二元，$A \\in \\{0,1\\}$。\n- 结局：二元，$Y \\in \\{0,1\\}$。\n- 协变量：二元，$L \\in \\{0,1\\}$。\n- 分层 $L=0$ 的数据：暴露组病例数 $a_{0}=10$，暴露组非病例数 $b_{0}=90$，非暴露组病例数 $c_{0}=10$，非暴露组非病例数 $d_{0}=190$。\n- 分层 $L=1$ 的数据：暴露组病例数 $a_{1}=20$，暴露组非病例数 $b_{1}=30$，非暴露组病例数 $c_{1}=10$，非暴露组非病例数 $d_{1}=40$。\n- 定义：$n_{1\\ell}=a_{\\ell}+b_{\\ell}$，$n_{0\\ell}=c_{\\ell}+d_{\\ell}$，$n_{\\ell}=n_{1\\ell}+n_{0\\ell}$。\n- 目标参数：因果风险比 $\\text{RR}=P(Y^{1}=1)/P(Y^{0}=1)$。\n- 用于识别的因果假设：一致性、条件可交换性（$\\{Y^{0},Y^{1}\\} \\perp A \\mid L$）和正值性。\n- 第5部分的假设：公共分层特异性风险比，$P(Y=1 \\mid A=1,L=\\ell)=\\theta\\,P(Y=1 \\mid A=0,L=\\ell)$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在流行病学和因果推断的原理上有坚实的科学基础。它使用了标准的定义和数据结构（来自队列研究的分层 $2 \\times 2$ 表）。混杂、风险比、Mantel-Haenszel 估计量和潜在结局框架等概念是该学科的核心。该问题是良定的，为回答五个部分中的每一个都提供了所有必要的数据和定义。语言客观而精确。该问题没有任何科学不严谨、模糊或矛盾之处。所要求的推导和计算是流行病学方法中标准的、非平凡的练习。\n\n**步骤3：结论与行动**\n问题有效。我将进行完整解答。\n\n### 解答\n\n**第1部分：论证 $L$ 是一个混杂因素**\n\n一个变量 $L$ 成为暴露 $A$ 对结局 $Y$ 效应的混杂因素，需要满足三个传统标准：\n1. 在源人群中，$L$ 与暴露 $A$ 相关联。\n2. $L$ 是结局 $Y$ 的一个独立危险因素（即在非暴露者中与 $Y$ 相关联）。\n3. $L$ 不在从 $A$到 $Y$ 的因果路径上。\n\n问题指出 $L$ 是一个基线协变量，这意味着它在暴露 $A$ 确定之前被测量。因此，标准3由研究设计保证。我们使用所提供的数据评估标准1和2。\n\n为了检查 $L$ 和 $A$ 之间的关联，我们可以比较 $L$ 的每个分层中暴露个体的比例。\n- 分层 $L=0$ 的总受试者数：$n_{0} = a_{0}+b_{0}+c_{0}+d_{0} = 10+90+10+190 = 300$。\n- 分层 $L=0$ 中的暴露人数：$n_{10} = a_{0}+b_{0} = 10+90 = 100$。\n- 分层 $L=0$ 中的暴露比例：$\\hat{P}(A=1 \\mid L=0) = \\frac{n_{10}}{n_{0}} = \\frac{100}{300} = \\frac{1}{3}$。\n- 分层 $L=1$ 的总受试者数：$n_{1} = a_{1}+b_{1}+c_{1}+d_{1} = 20+30+10+40 = 100$。\n- 分层 $L=1$ 中的暴露人数：$n_{11} = a_{1}+b_{1} = 20+30 = 50$。\n- 分层 $L=1$ 中的暴露比例：$\\hat{P}(A=1 \\mid L=1) = \\frac{n_{11}}{n_{1}} = \\frac{50}{100} = \\frac{1}{2}$。\n由于 $\\hat{P}(A=1 \\mid L=0) = \\frac{1}{3} \\neq \\frac{1}{2} = \\hat{P}(A=1 \\mid L=1)$，在样本中 $L$ 和 $A$ 之间存在关联。\n\n为了检查 $L$ 是否是 $Y$ 的一个独立危险因素，我们比较在非暴露者（$A=0$）中，$L$ 的每个分层里结局的风险。\n- 分层 $L=0$ 中的非暴露人数：$n_{00} = c_{0}+d_{0} = 10+190 = 200$。\n- 分层 $L=0$ 中非暴露者的风险：$\\hat{P}(Y=1 \\mid A=0, L=0) = \\frac{c_{0}}{n_{00}} = \\frac{10}{200} = \\frac{1}{20}$。\n- 分层 $L=1$ 中的非暴露人数：$n_{01} = c_{1}+d_{1} = 10+40 = 50$。\n- 分层 $L=1$ 中非暴露者的风险：$\\hat{P}(Y=1 \\mid A=0, L=1) = \\frac{c_{1}}{n_{01}} = \\frac{10}{50} = \\frac{1}{5}$。\n由于 $\\hat{P}(Y=1 \\mid A=0, L=0) = \\frac{1}{20} \\neq \\frac{1}{5} = \\hat{P}(Y=1 \\mid A=0, L=1)$，$L$ 在非暴露者中与结局 $Y$ 相关联。\n\n由于所有三个标准都得到满足，我们断定在该数据集中，$L$ 是 $A$ 和 $Y$ 之间关系的混杂因素。\n\n**第2部分：粗风险比**\n\n粗风险比是通过忽略按 $L$ 的分层，创建一个单一的 $2 \\times 2$ 表来计算的。\n- 总暴露病例数：$a = a_{0}+a_{1} = 10+20=30$。\n- 总暴露受试者数：$N_{1} = (a_{0}+b_{0})+(a_{1}+b_{1}) = 100+50 = 150$。\n- 总非暴露病例数：$c = c_{0}+c_{1} = 10+10=20$。\n- 总非暴露受试者数：$N_{0} = (c_{0}+d_{0})+(c_{1}+d_{1}) = 200+50=250$。\n暴露组的风险是 $R_{1} = \\frac{a}{N_{1}} = \\frac{30}{150} = \\frac{1}{5}$。\n非暴露组的风险是 $R_{0} = \\frac{c}{N_{0}} = \\frac{20}{250} = \\frac{2}{25}$。\n粗风险比是 $\\text{RR}_{\\text{crude}} = \\frac{R_{1}}{R_{0}} = \\frac{1/5}{2/25} = \\frac{1}{5} \\times \\frac{25}{2} = \\frac{25}{10} = \\frac{5}{2}$。\n\n**第3部分：分层特异性风险比**\n\n我们在 $L$ 的每个分层内计算风险比。\n对于分层 $L=0$：\n- 暴露组风险：$\\hat{P}(Y=1 \\mid A=1, L=0) = \\frac{a_{0}}{n_{10}} = \\frac{10}{100} = \\frac{1}{10}$。\n- 非暴露组风险：$\\hat{P}(Y=1 \\mid A=0, L=0) = \\frac{c_{0}}{n_{00}} = \\frac{10}{200} = \\frac{1}{20}$。\n- 分层特异性风险比：$\\text{RR}_{0} = \\frac{1/10}{1/20} = 2$。\n\n对于分层 $L=1$：\n- 暴露组风险：$\\hat{P}(Y=1 \\mid A=1, L=1) = \\frac{a_{1}}{n_{11}} = \\frac{20}{50} = \\frac{2}{5}$。\n- 非暴露组风险：$\\hat{P}(Y=1 \\mid A=0, L=1) = \\frac{c_{1}}{n_{01}} = \\frac{10}{50} = \\frac{1}{5}$。\n- 分层特异性风险比：$\\text{RR}_{1} = \\frac{2/5}{1/5} = 2$。\n\n分层特异性风险比是相等的：$\\text{RR}_{0} = \\text{RR}_{1} = 2$。这表明，在风险比尺度上，$L$ 不是 $A$ 对 $Y$ 效应的修饰因子。粗风险比（$\\frac{5}{2}=2.5$）与公共分层特异性风险比（$2$）之间的差异，是 $L$ 存在混杂效应的证据。\n\n**第4部分：Mantel-Haenszel 风险比估计量**\n\n用于公共风险比 $\\theta$ 的 Mantel-Haenszel (MH) 估计量，是从一个将各分层风险差异的加权和设为零的估计方程中推导出来的。令 $p_{1\\ell} = P(Y=1 \\mid A=1, L=\\ell)$ 和 $p_{0\\ell} = P(Y=1 \\mid A=0, L=\\ell)$。假设存在一个公共风险比 $\\theta$，我们有 $p_{1\\ell} = \\theta p_{0\\ell}$，或 $p_{1\\ell} - \\theta p_{0\\ell} = 0$。MH 方法使用分层特异性权重 $w_{\\ell} = \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}}$ 并将基于样本的差异的加权和设为零：\n$$ \\sum_{\\ell} w_{\\ell} (\\hat{p}_{1\\ell} - \\hat{\\theta}_{\\text{MH}} \\hat{p}_{0\\ell}) = 0 $$\n其中 $\\hat{p}_{1\\ell} = a_{\\ell}/n_{1\\ell}$ 和 $\\hat{p}_{0\\ell} = c_{\\ell}/n_{0\\ell}$。求解 $\\hat{\\theta}_{\\text{MH}}$：\n$$ \\hat{\\theta}_{\\text{MH}} \\sum_{\\ell} w_{\\ell} \\hat{p}_{0\\ell} = \\sum_{\\ell} w_{\\ell} \\hat{p}_{1\\ell} $$\n$$ \\hat{\\theta}_{\\text{MH}} = \\frac{\\sum_{\\ell} w_{\\ell} (a_{\\ell}/n_{1\\ell})}{\\sum_{\\ell} w_{\\ell} (c_{\\ell}/n_{0\\ell})} $$\n代入权重 $w_{\\ell}$ 的表达式：\n$$ \\hat{\\theta}_{\\text{MH}} = \\frac{\\sum_{\\ell} \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}} \\frac{a_{\\ell}}{n_{1\\ell}}}{\\sum_{\\ell} \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}} \\frac{c_{\\ell}}{n_{0\\ell}}} = \\frac{\\sum_{\\ell} a_{\\ell} n_{0\\ell} / n_{\\ell}}{\\sum_{\\ell} c_{\\ell} n_{1\\ell} / n_{\\ell}} $$\n这是 Mantel-Haenszel 风险比估计量 $\\hat{\\text{RR}}_{\\text{MH}}$ 的表达式。\n\n现在，我们使用给定的数据计算它的值。\n各组成部分为：\n- 分子项，$L=0$：$a_{0} n_{00} / n_{0} = 10 \\times 200 / 300 = 20/3$。\n- 分子项，$L=1$：$a_{1} n_{01} / n_{1} = 20 \\times 50 / 100 = 10$。\n- 分母项，$L=0$：$c_{0} n_{10} / n_{0} = 10 \\times 100 / 300 = 10/3$。\n- 分母项，$L=1$：$c_{1} n_{11} / n_{1} = 10 \\times 50 / 100 = 5$。\n\n该估计量为：\n$$ \\hat{\\text{RR}}_{\\text{MH}} = \\frac{ \\frac{20}{3} + 10 }{ \\frac{10}{3} + 5 } = \\frac{ \\frac{20+30}{3} }{ \\frac{10+15}{3} } = \\frac{ 50/3 }{ 25/3 } = \\frac{50}{25} = 2 $$\n\n**第5部分：Mantel-Haenszel 风险比估计量的期望值**\n\n我们被要求在各分层存在一个公共风险比 $\\theta$ 以及满足指定的因果识别假设的条件下，推导 $\\hat{\\text{RR}}_{\\text{MH}}$ 在大样本中的期望值。\n该估计量为 $\\hat{\\text{RR}}_{\\text{MH}} = \\frac{\\sum_{\\ell} (a_{\\ell}/n_{1\\ell}) w_{\\ell}}{\\sum_{\\ell} (c_{\\ell}/n_{0\\ell}) w_{\\ell}}$，其中 $w_{\\ell} = \\frac{n_{1\\ell} n_{0\\ell}}{n_{\\ell}}$。令 $\\hat{p}_{1\\ell} = a_{\\ell}/n_{1\\ell}$ 和 $\\hat{p}_{0\\ell} = c_{\\ell}/n_{0\\ell}$。\n在大样本中，当各分层的样本量 $n_{1\\ell}$ 和 $n_{0\\ell}$ 趋于无穷大时，根据大数定律，样本风险依概率收敛于真实的总体风险：\n$$ \\hat{p}_{1\\ell} \\xrightarrow{p} p_{1\\ell} = P(Y=1 \\mid A=1, L=\\ell) $$\n$$ \\hat{p}_{0\\ell} \\xrightarrow{p} p_{0\\ell} = P(Y=1 \\mid A=0, L=\\ell) $$\n权重 $w_{\\ell}$ 是由分层大小决定的常数。根据连续映射定理，估计量 $\\hat{\\text{RR}}_{\\text{MH}}$ 作为这些样本风险的连续函数，依概率收敛于相同形式的真实风险函数：\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\frac{\\sum_{\\ell} p_{1\\ell} w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} $$\n我们已知假设风险比在各分层中是恒定的，即对所有 $\\ell$ 都有 $p_{1\\ell} = \\theta p_{0\\ell}$。将此代入极限表达式中：\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\frac{\\sum_{\\ell} (\\theta p_{0\\ell}) w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} = \\frac{\\theta \\sum_{\\ell} p_{0\\ell} w_{\\ell}}{\\sum_{\\ell} p_{0\\ell} w_{\\ell}} $$\n在正值性假设下，每个暴露和分层水平都有受试者，确保 $w_{\\ell}  0$。我们还假设并非所有基线风险 $p_{0\\ell}$ 都为零，所以总和 $\\sum_{\\ell} p_{0\\ell} w_{\\ell}$ 非零。因此，我们可以消去这个总和：\n$$ \\hat{\\text{RR}}_{\\text{MH}} \\xrightarrow{p} \\theta $$\n这表明 Mantel-Haenszel 风险比估计量是公共风险比 $\\theta$ 的一个一致估计量。\n“大样本中的期望值”这一说法指的是渐近期望 $\\lim_{N \\to \\infty} E[\\hat{\\text{RR}}_{\\text{MH}}]$。由于该估计量是有界随机变量（风险在 $[0,1]$ 内）的均值之比，因此其本身也是有界的（假设正值性），故可应用控制收敛定理。这允许极限和期望算子的交换：\n$$ \\lim_{N \\to \\infty} E[\\hat{\\text{RR}}_{\\text{MH}}] = E[\\lim_{N \\to \\infty} \\hat{\\text{RR}}_{\\text{MH}}] = E[\\theta] $$\n由于 $\\theta$ 是一个常数参数，其期望就是其自身。因此，该估计量的大样本期望值为 $\\theta$。\n因果假设（一致性、条件可交换性、正值性）确保了这个关联参数 $\\theta$ 等于因果风险比 $\\text{RR}=P(Y^{1}=1)/P(Y^{0}=1)$，因为在这些假设和一个恒定的 RR 下，$\\text{RR} = \\frac{\\sum_{\\ell} p_{1\\ell} P(L=\\ell)}{\\sum_{\\ell} p_{0\\ell} P(L=\\ell)} = \\frac{\\sum_{\\ell} \\theta p_{0\\ell} P(L=\\ell)}{\\sum_{\\ell} p_{0\\ell} P(L=\\ell)} = \\theta$。\n因此，Mantel-Haenszel 估计量的大样本期望值是 $\\theta$。",
            "answer": "$$ \\boxed{\\theta} $$"
        },
        {
            "introduction": "理解何时“不”应该进行调整与知道何时应该调整同样重要，这是严谨因果推断的关键。本练习将通过一个精心设计的思想实验，揭示一个常见的陷阱：对撞偏倚。您将看到，即使一个变量与暴露和结局均相关，但如果它是一个对撞体（即暴露和结局的共同效应），对其进行调整（或分层）不仅不能消除偏倚，反而会凭空制造出虚假的关联 。",
            "id": "4582718",
            "problem": "考虑一个二元暴露 $A \\in \\{0,1\\}$，一个二元结局 $Y \\in \\{0,1\\}$，以及一个同时受 $A$ 和 $Y$ 影响的二元变量 $C \\in \\{0,1\\}$。假设目标因果估计量是边际风险差，定义为 $P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0)$。给定以下科学上合理的数据生成机制：\n- 按暴露划分的基线结局风险：$P(Y=1 \\mid A=1) = 0.30$ 和 $P(Y=1 \\mid A=0) = 0.20$。\n- $C$ 的选择机制（$A$ 和 $Y$ 的一个共同效应）：\n  - $P(C=1 \\mid A=1, Y=1) = 0.05$，\n  - $P(C=1 \\mid A=1, Y=0) = 0.95$，\n  - $P(C=1 \\mid A=0, Y=1) = 0.95$，\n  - $P(C=1 \\mid A=0, Y=0) = 0.05$。\n\n从概率的基本定义、全概率定律以及风险差的定义出发，计算在层 $C=1$ 内的条件风险差，即\n$$\\text{RD}_{C=1} \\equiv P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1).$$\n将您的最终答案表示为小数，并四舍五入到四位有效数字。不允许使用百分号。",
            "solution": "该问题是有效的，因为它科学地基于概率论和流行病学的原理，问题陈述清晰且提供了唯一解所需的所有信息，并以客观、正式的语言表述。其中没有矛盾、歧义或事实错误。该问题描述了对撞因子分层偏倚的一个经典场景，这是因果推断中的一个核心概念。\n\n目标是计算变量 $C$ 等于 $1$ 的层内的条件风险差，记为 $\\text{RD}_{C=1}$。其定义为：\n$$ \\text{RD}_{C=1} = P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1) $$\n我们将利用所提供的数据和概率论的基本原理，分别计算右侧的两个条件概率。\n\n给定的概率是：\n- $P(Y=1 \\mid A=1) = 0.30$\n- $P(Y=1 \\mid A=0) = 0.20$\n- $P(C=1 \\mid A=1, Y=1) = 0.05$\n- $P(C=1 \\mid A=1, Y=0) = 0.95$\n- $P(C=1 \\mid A=0, Y=1) = 0.95$\n- $P(C=1 \\mid A=0, Y=0) = 0.05$\n\n根据给定的结局 $Y$ 的概率，我们可以推导出其互补概率：\n- $P(Y=0 \\mid A=1) = 1 - P(Y=1 \\mid A=1) = 1 - 0.30 = 0.70$\n- $P(Y=0 \\mid A=0) = 1 - P(Y=1 \\mid A=0) = 1 - 0.20 = 0.80$\n\n首先，我们计算项 $P(Y=1 \\mid A=1, C=1)$。我们应用条件事件的贝叶斯定理：\n$$ P(Y=1 \\mid A=1, C=1) = \\frac{P(C=1 \\mid A=1, Y=1) P(Y=1 \\mid A=1)}{P(C=1 \\mid A=1)} $$\n通过代入给定值计算分子：\n$$ \\text{Numerator}_1 = P(C=1 \\mid A=1, Y=1) P(Y=1 \\mid A=1) = (0.05)(0.30) = 0.015 $$\n分母 $P(C=1 \\mid A=1)$ 可以通过对变量 $Y$ 进行边际化，使用全概率定律求得：\n$$ P(C=1 \\mid A=1) = P(C=1 \\mid A=1, Y=1)P(Y=1 \\mid A=1) + P(C=1 \\mid A=1, Y=0)P(Y=0 \\mid A=1) $$\n代入已知和推导出的值：\n$$ P(C=1 \\mid A=1) = (0.05)(0.30) + (0.95)(0.70) = 0.015 + 0.665 = 0.680 $$\n现在，我们可以计算风险差的第一项：\n$$ P(Y=1 \\mid A=1, C=1) = \\frac{0.015}{0.680} = \\frac{15}{680} = \\frac{3}{136} $$\n\n接下来，我们计算第二项 $P(Y=1 \\mid A=0, C=1)$。我们再次应用贝叶斯定理：\n$$ P(Y=1 \\mid A=0, C=1) = \\frac{P(C=1 \\mid A=0, Y=1) P(Y=1 \\mid A=0)}{P(C=1 \\mid A=0)} $$\n分子是：\n$$ \\text{Numerator}_2 = P(C=1 \\mid A=0, Y=1) P(Y=1 \\mid A=0) = (0.95)(0.20) = 0.190 $$\n分母 $P(C=1 \\mid A=0)$ 使用全概率定律求得：\n$$ P(C=1 \\mid A=0) = P(C=1 \\mid A=0, Y=1)P(Y=1 \\mid A=0) + P(C=1 \\mid A=0, Y=0)P(Y=0 \\mid A=0) $$\n代入已知和推导出的值：\n$$ P(C=1 \\mid A=0) = (0.95)(0.20) + (0.05)(0.80) = 0.190 + 0.040 = 0.230 $$\n现在，我们可以计算风险差的第二项：\n$$ P(Y=1 \\mid A=0, C=1) = \\frac{0.190}{0.230} = \\frac{19}{23} $$\n\n最后，我们计算条件风险差 $\\text{RD}_{C=1}$：\n$$ \\text{RD}_{C=1} = P(Y=1 \\mid A=1, C=1) - P(Y=1 \\mid A=0, C=1) = \\frac{3}{136} - \\frac{19}{23} $$\n为了求得数值，我们将分数转换为小数：\n$$ \\frac{3}{136} \\approx 0.0220588... $$\n$$ \\frac{19}{23} \\approx 0.8260869... $$\n$$ \\text{RD}_{C=1} \\approx 0.0220588 - 0.8260869 = -0.8040281 $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $8$、$0$、$4$ 和 $0$。第五位数字是 $2$，所以我们向下舍入。\n$$ \\text{RD}_{C=1} \\approx -0.8040 $$\n这个结果展示了对撞因子偏倚。边际风险差是正的：$P(Y=1 \\mid A=1) - P(Y=1 \\mid A=0) = 0.30 - 0.20 = 0.10$。然而，在对共同效应（对撞因子）$C$ 进行条件化后，$A$ 和 $Y$ 之间的关联不仅被扭曲，而且其方向被逆转，变为强烈的负相关。",
            "answer": "$$\\boxed{-0.8040}$$"
        }
    ]
}