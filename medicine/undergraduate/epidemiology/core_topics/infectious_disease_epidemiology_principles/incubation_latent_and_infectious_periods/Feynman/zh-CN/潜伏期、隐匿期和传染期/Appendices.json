{
    "hands_on_practices": [
        {
            "introduction": "流行病学研究的第一步是精确掌握其核心概念。潜隐期、潜伏期和传染期是描述疾病传播动态的基础。这个练习  提供了一个清晰的假设情景，旨在帮助你巩固对这些关键时间段的理解。通过计算，你将能够确定症状前传播是否发生及其持续时间，这是理解和控制许多传染病传播的关键环节。",
            "id": "4600639",
            "problem": "考虑一个宿主在时间 $0$ 时被病原体感染。潜隐期是指从感染到出现传染性的时间，潜伏期是指从感染到出现症状的时间，传染期是指宿主可以传播病原体的时间段。假设该病原体的潜隐期为 $2$ 天，潜伏期为 $5$ 天。传染期持续 $7$ 天，并在潜隐期结束后开始。仅根据这些定义和所提供的参数，判断是否存在症状前传播，确定其相对于感染发生的时间窗口，并计算症状前传播的总持续时间。请以天为单位给出持续时间的最终数值答案。提供精确值，无需四舍五入。",
            "solution": "设 $t$ 代表以天为单位的时间，其中 $t=0$ 对应于感染的时刻。根据问题陈述，我们有以下定义和参数。\n\n潜隐期是从感染到出现传染性的时间。设其持续时间为 $T_L$。问题说明其持续时间为 $2$ 天，因此 $T_L = 2$。这意味着宿主在时间 $t = T_L = 2$ 时变得具有传染性。\n\n潜伏期是从感染到出现症状的时间。设其持续时间为 $T_{inc}$。问题说明其持续时间为 $5$ 天，因此 $T_{inc} = 5$。这意味着宿主在时间 $t = T_{inc} = 5$ 时开始出现症状。\n\n传染期是宿主可以传播病原体的时间段。设其持续时间为 $D_{inf}$。问题说明 $D_{inf} = 7$ 天。它在潜隐期结束时开始，即在时间 $t_{\\text{inf,start}} = T_L = 2$。传染期在时间 $t_{\\text{inf,end}} = t_{\\text{inf,start}} + D_{inf} = 2 + 7 = 9$ 时结束。因此，宿主具有传染性的时间区间为 $I_{inf} = [2, 9]$。\n\n问题要求我们判断是否发生症状前传播，确定其时间窗口，并计算其总持续时间。\n\n症状前传播被定义为宿主在症状出现前传播病原体。这要求宿主同时具有传染性且处于症状前期。\n\n症状前期是从感染到症状出现的时间段。根据潜伏期的定义，宿主在时间区间 $I_{pre-symp} = [0, t_{\\text{symp,start}}) = [0, T_{inc}) = [0, 5)$ 内处于症状前期。\n\n要确定是否发生症状前传播，我们必须检查传染期是否在症状期开始之前开始。传染性在 $t = T_L = 2$ 时开始。症状在 $t = T_{inc} = 5$ 时出现。由于 $T_L  T_{inc}$，具体来说是 $2  5$，宿主在出现症状之前就变得具有传染性。因此，存在症状前传播的时期。\n\n症状前传播的时间窗口是宿主同时具有传染性且处于症状前期的区间。这是传染区间 $I_{inf}$ 和症状前区间 $I_{pre-symp}$ 的交集。\n$$\n\\text{症状前传播窗口} = I_{inf} \\cap I_{pre-symp} = [2, 9] \\cap [0, 5)\n$$\n这两个集合的交集是区间 $[2, 5)$。这就是相对于 $t=0$ 的感染时刻，发生症状前传播的时间窗口。它从 $t=2$ 天开始，到 $t=5$ 天结束。\n\n症状前传播的总持续时间是这个时间窗口的长度。区间 $[a, b)$ 的长度计算为 $b - a$。\n$$\n\\text{持续时间} = 5 - 2 = 3\n$$\n症状前传播的总持续时间是 $3$ 天。一般而言，只要 $T_L  T_{inc}$，该持续时间就由公式 $T_{inc} - T_L$ 给出。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "在掌握了个体层面的定义后，我们需要将视野提升至群体层面并运用概率性思维，因为现实世界中的流行病学参数并非固定数值。本练习  将引导你推导一个重要指标——平均序列间隔（mean serial interval），并揭示其与症状前传播之间的深刻联系。理解这种关系可以让我们仅通过观察症状发作时间，就能推断出一种疾病是否主要通过症状前传播，这对于早期预警和控制至关重要。",
            "id": "4600665",
            "problem": "考虑一个在均匀混合人群中直接传播的呼吸道病原体。定义潜伏期 $I$ 为从感染到症状出现的时间，潜隐期 $L$ 为从感染到开始具有传染性的时间，代际间隔 $G$ 为从传染者感染到被传染者感染的时间。观察到的序列间隔 $S$ 定义为在一个已识别的传播对中，被传染者症状出现与传染者症状出现之间的时间。对于一个传播对，将传染者的潜伏期记为 $I_{1}$，被传染者的潜伏期记为 $I_{2}$。假设 $I_{1}$、$I_{2}$ 和 $G$ 是随机变量，其期望值有限，分别为 $\\mu_{1} = \\mathbb{E}[I_{1}]$、$\\mu_{2} = \\mathbb{E}[I_{2}]$ 和 $\\mu_{G} = \\mathbb{E}[G]$。你可以假设期望的线性性质成立，并且所有量在流行病学中标准的更新型传播模型的意义下都是良定义的。\n\n从上述核心定义和第一性原理出发，用 $\\mu_{1}$、$\\mu_{2}$ 和 $\\mu_{G}$ 推导出平均观察序列间隔 $\\mathbb{E}[S]$ 的表达式。然后，构建一个单一的解析表达式 $C(\\mu_{1},\\mu_{2},\\mu_{G})$，其符号决定了平均观察序列间隔是否为负，即 $\\mathbb{E}[S]  0$ 当且仅当 $C(\\mu_{1},\\mu_{2},\\mu_{G})  0$。以最简形式给出 $C(\\mu_{1},\\mu_{2},\\mu_{G})$。无需进行数值计算。在你的推理中，从流行病学的角度解释负的平均观察序列间隔对于潜伏期、潜隐期和传染期之间的关系意味着什么，以及为什么这种现象会在现实环境中出现。最终答案必须仅为单一的闭式解析表达式 $C(\\mu_{1},\\mu_{2},\\mu_{G})$，不带单位。",
            "solution": "该问题要求推导平均观察序列间隔 $\\mathbb{E}[S]$，并构建一个解析表达式 $C$ 来判断 $\\mathbb{E}[S]$ 是否为负。所提供的定义在数理流行病学中是标准的，并为形式化推导提供了有效的基础。\n\n首先，我们必须建立序列间隔 $S$、代际间隔 $G$ 以及传染者 ($I_1$) 和被传染者 ($I_2$) 的潜伏期之间的数学关系。让我们根据感染事件定义一个时间轴。设时间 $t=0$ 为传染者被感染的时刻。\n\n根据定义：\n1.  传染者在时间 $t_{s,1} = I_1$ 出现症状。这是从传染者自身被感染到其症状出现所经过的时间。\n2.  传染者在时间 $t_{i,2} = G$ 将病原体传播给被传染者。这就是代际间隔，定义为从传染者感染到被传染者感染的时间。\n3.  被传染者在时间 $t_{i,2}$ 被感染后，经过其潜伏期 $I_2$ 的时长后出现症状。因此，被传染者症状出现的绝对时间是 $t_{s,2} = t_{i,2} + I_2 = G + I_2$。\n\n观察到的序列间隔 $S$ 定义为被传染者症状出现与传染者症状出现之间的时间。在数学上，这是它们各自症状出现时间的差：\n$$S = t_{s,2} - t_{s,1}$$\n代入我们从时间轴推导出的表达式，我们得到：\n$$S = (G + I_2) - I_1$$\n这个方程给出了单个传播对中随机变量 $S$、$G$、$I_1$ 和 $I_2$ 之间的基本关系。\n\n接下来，我们需要求平均观察序列间隔 $\\mathbb{E}[S]$。我们对推导出的 $S$ 的方程求期望。问题陈述明确允许使用期望的线性性质。\n$$\\mathbb{E}[S] = \\mathbb{E}[G + I_2 - I_1]$$\n应用线性性质，即随机变量和的期望等于它们期望的和，我们有：\n$$\\mathbb{E}[S] = \\mathbb{E}[G] + \\mathbb{E}[I_2] - \\mathbb{E}[I_1]$$\n问题将 $I_1$、$I_2$ 和 $G$ 的均值分别定义为 $\\mu_1 = \\mathbb{E}[I_1]$、$\\mu_2 = \\mathbb{E}[I_2]$ 和 $\\mu_G = \\mathbb{E}[G]$。代入这些定义，得到平均序列间隔的表达式：\n$$\\mathbb{E}[S] = \\mu_G + \\mu_2 - \\mu_1$$\n\n负的平均序列间隔（$\\mathbb{E}[S]  0$）具有深刻的流行病学意义。这种情况意味着，平均而言，被传染者比将病原体传染给他们的传染者*更早*出现症状。这种现象是存在显著症状前传播的标志。要发生传播，传染者必须具有传染性。从感染到具有传染性的时期是潜隐期 $L$。如果传播发生在时间 $G$（代际间隔），那么必然有 $G \\ge L$。如果这次传播发生在传染者症状出现（在时间 $I_1$）之前，那么 $G  I_1$。这要求潜隐期短于潜伏期（$L  I_1$），从而存在一个症状前传染的窗口期。如果传播持续发生在这个窗口期内（即平均代际时间 $\\mu_G$ 小于传染者的平均潜伏期 $\\mu_1$），并且如果被传染者的潜伏期 $\\mu_2$ 不是异常地长，那么被传染者的平均症状出现时间 $\\mu_G + \\mu_2$ 就可能小于传染者的平均症状出现时间 $\\mu_1$。因此，在人群中观察到负的平均序列间隔是症状前传播是疫情主要驱动因素的有力证据。\n\n最后，我们的任务是构建一个单一的解析表达式 $C(\\mu_1, \\mu_2, \\mu_G)$，使得 $\\mathbb{E}[S]  0$ 当且仅当 $C(\\mu_1, \\mu_2, \\mu_G) > 0$。\n负平均序列间隔的条件是：\n$$\\mathbb{E}[S]  0$$\n$$\\mu_G + \\mu_2 - \\mu_1  0$$\n为了找到一个在此条件下为正的表达式 $C$，我们可以将该不等式两边乘以-1。这个操作会反转不等号的方向：\n$$-(\\mu_G + \\mu_2 - \\mu_1) > 0$$\n$$-\\mu_G - \\mu_2 + \\mu_1 > 0$$\n整理各项，我们得到：\n$$\\mu_1 - \\mu_2 - \\mu_G > 0$$\n这个不等式成立当且仅当 $\\mathbb{E}[S]  0$。因此，我们可以将函数 $C$ 定义为该不等式的左边部分。\n$$C(\\mu_1, \\mu_2, \\mu_G) = \\mu_1 - \\mu_2 - \\mu_G$$\n这个表达式满足所需条件。它是最简形式，因为它是给定均值的线性组合。",
            "answer": "$$\\boxed{\\mu_{1} - \\mu_{2} - \\mu_{G}}$$"
        },
        {
            "introduction": "本章的最终练习将理论与现实世界的公共卫生决策相结合，这正是流行病学研究的最终目标之一。这个实践练习  模拟了一项核心的流行病学任务：你将对真实的（或模拟的）潜伏期数据拟合不同的统计分布模型。通过使用赤池信息准则（Akaike Information Criterion, $AIC$）进行模型选择，你将能基于数据做出判断，并使用最优模型为制定隔离期政策提供科学建议。",
            "id": "4600638",
            "problem": "给定三个独立的潜伏期数据集，单位为天，假定数据为正连续值。对于每个数据集，您必须拟合两个候选分布：伽马分布和对数正态分布，均采用不含位置参数的双参数设定。然后，您必须使用赤池信息准则 (Akaike Information Criterion, AIC) 比较拟合效果，并使用拟合效果更好的模型来量化与隔离设计相关的尾部行为。\n\n基本定义和假设：\n- 形状参数为 $\\alpha$、尺度参数为 $\\theta$ 的伽马分布，其概率密度函数为 $f(t \\mid \\alpha,\\theta) = \\dfrac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}$，其中 $t  0$，$ \\Gamma(\\cdot)$ 是伽马函数。参数满足 $\\alpha  0$ 和 $\\theta  0$。\n- 对数均值为 $\\mu$、对数标准差为 $\\sigma$ 的对数正态分布，其概率密度函数为 $f(t \\mid \\mu,\\sigma) = \\dfrac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\dfrac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right)$，其中 $t  0$，且 $\\sigma  0$。\n- 使用最大似然估计 (MLE) 来估计每个模型的参数，通过在容许参数空间上最大化对数似然函数 $\\ell(\\boldsymbol{\\theta} \\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$ 来实现。\n- 仅使用双参数形式（即两种分布的位置参数都固定为 $0$）。每个模型的自由参数数量为 $k = 2$。\n- 赤池信息准则 (AIC) 定义为 $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$，其中 $\\ell(\\widehat{\\boldsymbol{\\theta}})$ 是最大化后的对数似然值，$k$ 是自由参数的数量。\n- 生存函数为 $S(q) = \\mathbb{P}(T  q) = 1 - F(q)$，其中 $F$ 是累积分布函数。$(1 - r)$ 分位数满足 $F(q^\\star) = 1 - r$，等价于 $S(q^\\star) = r$。\n\n每个数据集的任务：\n1. 在上述约束下，通过最大似然估计伽马分布和对数正态分布的参数，计算它们的最大化对数似然值，然后计算它们的 AIC 值。\n2. 选择 AIC 值较小的模型作为更优模型。\n3. 使用更优模型，计算在指定隔离期 $Q$（单位：天）下的尾部概率 $S(Q) = \\mathbb{P}(T  Q)$。\n4. 使用更优模型，计算所需的最小隔离期（单位：天），以使尾部概率小于或等于指定的风险容忍度 $r$；即计算 $q^\\star$ 使得 $F(q^\\star) = 1 - r$。所有时间均以天为单位。\n5. 对于每个数据集，按顺序报告以下列表：\n   - 一个整数模型标识符，其中伽马分布编码为 $0$，对数正态分布编码为 $1$。\n   - 伽马分布的 AIC 值，以实数形式表示。\n   - 对数正态分布的 AIC 值，以实数形式表示。\n   - 所选模型下的尾部概率 $S(Q)$，以实数形式表示。\n   - 所选模型下所需的隔离期 $q^\\star$，以实数形式表示。\n所有实数必须四舍五入到恰好 $6$ 位小数。所有时间单位均为天。风险容忍度 $r$ 必须作为小数处理，而不是百分比。\n\n数据集及相关的隔离评估参数（测试套件）：\n- 数据集 $\\mathcal{D}_1$（中等样本，中度右偏）：$\\{\\,2.0,\\,3.5,\\,4.2,\\,5.1,\\,6.3,\\,3.8,\\,4.9,\\,2.7,\\,5.6,\\,4.1,\\,3.2,\\,6.8,\\,5.0,\\,4.4,\\,3.9\\,\\}$，隔离期 $Q_1 = 7.0$，风险容忍度 $r_1 = 0.05$。\n- 数据集 $\\mathcal{D}_2$（较小样本，右尾更重）：$\\{\\,1.2,\\,2.5,\\,3.1,\\,4.7,\\,2.9,\\,5.3,\\,9.5,\\,11.2,\\,14.8,\\,3.6,\\,4.1\\,\\}$，隔离期 $Q_2 = 10.0$，风险容忍度 $r_2 = 0.01$。\n- 数据集 $\\mathcal{D}_3$（极小样本，低方差）：$\\{\\,3.0,\\,3.2,\\,3.4,\\,3.1,\\,3.3\\,\\}$，隔离期 $Q_3 = 5.0$，风险容忍度 $r_3 = 0.10$。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由三个子列表组成的逗号分隔列表，每个子列表按顺序对应一个数据集 $\\mathcal{D}_1,\\mathcal{D}_2,\\mathcal{D}_3$。每个子列表必须格式化为 $[m,a_{\\Gamma},a_{\\mathrm{LN}},s,q^\\star]$，不含任何空格，其中 $m$ 是整数模型标识符，$a_{\\Gamma}$ 是伽马分布的 AIC，$a_{\\mathrm{LN}}$ 是对数正态分布的 AIC，$s$ 是所选模型下的 $S(Q)$，$q^\\star$ 是所选模型下所需的隔离期。例如，一个有效的格式为 $\\big[ [0,12.345000,11.234000,0.012300,8.765000],[\\dots], [\\dots] \\big]$，但完全不含空格。",
            "solution": "我们从统计推断和概率论的基本定义开始。对于一个参数为 $\\boldsymbol{\\theta}$ 的参数模型和独立观测值 $\\{t_i\\}_{i=1}^{n}$，似然函数为 $L(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\prod_{i=1}^{n} f(t_i \\mid \\boldsymbol{\\theta})$，对数似然函数为 $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$。最大似然估计 (MLE) 通过在容许参数空间上最大化 $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\})$ 来选择 $\\widehat{\\boldsymbol{\\theta}}$。使用 Akaike 框架的模型选择基于赤池信息准则 (AIC)，定义为 $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$，其中 $k$ 是自由参数的数量。\n\n我们分析两种用于潜伏期的模型，潜伏期是正值的连续变量：\n\n1. 伽马分布。参数：形状 $\\alpha  0$ 和尺度 $\\theta  0$。密度函数：\n$$\nf(t \\mid \\alpha,\\theta) = \\frac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}},\\quad t0.\n$$\n对于数据集 $\\{t_i\\}_{i=1}^{n}$，对数似然函数为\n$$\n\\ell(\\alpha,\\theta) = \\sum_{i=1}^{n} \\left[ (\\alpha - 1)\\log t_i - \\frac{t_i}{\\theta} - \\log \\Gamma(\\alpha) - \\alpha \\log \\theta \\right].\n$$\n约束条件是 $\\alpha0$ 和 $\\theta0$。\n\n2. 对数正态分布。参数：对数均值 $\\mu \\in \\mathbb{R}$ 和对数标准差 $\\sigma  0$。密度函数：\n$$\nf(t \\mid \\mu,\\sigma) = \\frac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right),\\quad t0.\n$$\n对数似然函数为\n$$\n\\ell(\\mu,\\sigma) = \\sum_{i=1}^{n} \\left[ -\\log t_i - \\log \\sigma - \\frac{1}{2}\\log(2\\pi) - \\frac{(\\ln t_i - \\mu)^2}{2\\sigma^2} \\right],\n$$\n约束条件为 $\\sigma0$。\n\n在两种模型中，我们都通过将位置参数固定为 $0$ 来限制为双参数版本。因此，每个模型的自由参数数量为 $k=2$。通过 MLE 获得伽马模型的 $\\widehat{\\alpha},\\widehat{\\theta}$ 和对数正态模型的 $\\widehat{\\mu},\\widehat{\\sigma}$ 后，我们计算\n$$\n\\mathrm{AIC}_{\\Gamma} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\alpha},\\widehat{\\theta}),\\quad\n\\mathrm{AIC}_{\\mathrm{LN}} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\mu},\\widehat{\\sigma}).\n$$\n我们选择 AIC 值较小的模型作为更优拟合。\n\n为了评估与隔离设计相关的尾部行为，对于一个隔离期 $Q$（单位：天），拟合模型下的尾部概率（生存函数）是\n$$\nS(Q) = \\mathbb{P}(T  Q) = 1 - F(Q),\n$$\n其中 $F$ 是拟合模型的累积分布函数。对于指定的风险容忍度 $r$（一个小数，而非百分比），确保 $\\mathbb{P}(T  q^\\star) \\le r$ 的最小隔离期 $q^\\star$ 满足\n$$\nF(q^\\star) = 1 - r \\quad \\Longleftrightarrow \\quad q^\\star = F^{-1}(1 - r).\n$$\n这是通过计算所选模型在概率 $1-r$ 处的 quantile 函数（分位数函数）得到的。\n\n算法设计：\n- 输入数据是三个潜伏期数据集（单位：天）及其相关的 $(Q,r)$ 对。我们将其表示为 $(\\mathcal{D}_j,Q_j,r_j)$，其中 $j \\in \\{1,2,3\\}$。\n- 对于每个数据集 $\\mathcal{D}_j$，我们在约束（分别为 $\\alpha0,\\theta0$ 和 $\\sigma0$）和位置参数固定为 $0$ 的情况下，计算伽马模型和对数正态模型的 MLE。实际上，我们可以通过对负对数似然函数进行数值优化来实现 MLE，或者使用在指定约束下（将位置参数固定为 $0$）执行 MLE 的稳健的库例程。\n- 我们在 MLE 处评估最大化后的对数似然值 $\\ell_{\\Gamma,j}$ 和 $\\ell_{\\mathrm{LN},j}$，并计算 $\\mathrm{AIC}_{\\Gamma,j} = 4 - 2\\ell_{\\Gamma,j}$ 和 $\\mathrm{AIC}_{\\mathrm{LN},j} = 4 - 2\\ell_{\\mathrm{LN},j}$。\n- 我们选择 AIC 较小的模型：如果 $\\mathrm{AIC}_{\\Gamma,j}  \\mathrm{AIC}_{\\mathrm{LN},j}$，定义 $m_j = 0$，否则 $m_j = 1$（AIC 相等时可选择对数正态分布，但确定性的实现是当 $\\mathrm{AIC}_{\\Gamma,j} \\ge \\mathrm{AIC}_{\\mathrm{LN},j}$ 时选择对数正态分布）。\n- 在所选模型下，我们计算在 $Q_j$ 处的生存函数：$s_j = S(Q_j)$，以及所需的隔离期 $q^\\star_j = F^{-1}(1-r_j)$。\n- 我们将所有实数四舍五入到恰好 $6$ 位小数。\n- 我们输出单行，包含一个由三个子列表 $[m_j,\\mathrm{AIC}_{\\Gamma,j},\\mathrm{AIC}_{\\mathrm{LN},j},s_j,q^\\star_j]$ 组成的列表，按 $j=1,2,3$ 的顺序排列，不含任何空格。\n\n科学意义：\n- 如果 $\\mathrm{AIC}_{\\mathrm{LN}}$ 较小，这表明与伽马拟合相比，数据具有相对更重的右尾，这往往会使较大的 $Q$ 处的 $S(Q)$ 增加，并对于严格的 $r$ 值，会使 $q^\\star$ 膨胀，意味着需要更长的隔离期才能达到相同的剩余风险。\n- 相反，如果 $\\mathrm{AIC}_{\\Gamma}$ 较小，尾部通常更轻，对于相同的 $r$ 值，可能产生更小的 $S(Q)$ 和更短的 $q^\\star$。\n- 小样本数据集测试了稳定性：两种模型的拟合可能非常接近，AIC 值也相似；然而，基于分位数的 $q^\\star$ 计算在所选模型下仍然是良定义的。\n\n所有计算必须以天为单位表示时间，以小数表示尾部概率，并按指定格式输出列表，保留六位小数且不含空格。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef fit_gamma_mle(data):\n    # Fit two-parameter Gamma by fixing loc=0\n    a_hat, loc_hat, scale_hat = stats.gamma.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.gamma.logpdf(data, a=a_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # shape and scale\n    aic = 2 * k - 2 * ll\n    params = {'shape': a_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef fit_lognorm_mle(data):\n    # Fit two-parameter Lognormal by fixing loc=0\n    s_hat, loc_hat, scale_hat = stats.lognorm.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.lognorm.logpdf(data, s=s_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # s (sigma), scale (=exp(mu))\n    aic = 2 * k - 2 * ll\n    # For interpretability, mu_hat = log(scale_hat), sigma_hat = s_hat\n    params = {'sigma': s_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef survival_and_quantile_gamma(params, q, r):\n    # Survival at q and quantile at 1-r for Gamma(shape, scale)\n    shape = params['shape']\n    scale = params['scale']\n    s_val = float(stats.gamma.sf(q, a=shape, loc=0.0, scale=scale))\n    q_star = float(stats.gamma.ppf(1.0 - r, a=shape, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef survival_and_quantile_lognorm(params, q, r):\n    # Survival at q and quantile at 1-r for Lognormal(sigma, scale=exp(mu))\n    sigma = params['sigma']\n    scale = params['scale']\n    s_val = float(stats.lognorm.sf(q, s=sigma, loc=0.0, scale=scale))\n    q_star = float(stats.lognorm.ppf(1.0 - r, s=sigma, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef round6(x):\n    return float(f\"{x:.6f}\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (data list, Q in days, r in decimal)\n    test_cases = [\n        ([2.0, 3.5, 4.2, 5.1, 6.3, 3.8, 4.9, 2.7, 5.6, 4.1, 3.2, 6.8, 5.0, 4.4, 3.9], 7.0, 0.05),\n        ([1.2, 2.5, 3.1, 4.7, 2.9, 5.3, 9.5, 11.2, 14.8, 3.6, 4.1], 10.0, 0.01),\n        ([3.0, 3.2, 3.4, 3.1, 3.3], 5.0, 0.10),\n    ]\n\n    results = []\n    for data, Q, r in test_cases:\n        data = np.asarray(data, dtype=float)\n        # Fit both models\n        g_params, g_ll, g_aic = fit_gamma_mle(data)\n        ln_params, ln_ll, ln_aic = fit_lognorm_mle(data)\n        # Select model: 0 for Gamma, 1 for Lognormal (choose LN on tie)\n        if g_aic  ln_aic:\n            model_id = 0\n            s_Q, q_star = survival_and_quantile_gamma(g_params, Q, r)\n        else:\n            model_id = 1\n            s_Q, q_star = survival_and_quantile_lognorm(ln_params, Q, r)\n        # Round outputs\n        out = [\n            model_id,\n            round6(g_aic),\n            round6(ln_aic),\n            round6(s_Q),\n            round6(q_star),\n        ]\n        results.append(out)\n\n    # Format output: single line, no spaces\n    def format_no_spaces(res):\n        sublists = []\n        for sub in res:\n            items = []\n            for val in sub:\n                if isinstance(val, int):\n                    items.append(str(val))\n                else:\n                    # Ensure exactly 6 decimal places (already rounded)\n                    items.append(f\"{val:.6f}\")\n            sublists.append(\"[\" + \",\".join(items) + \"]\")\n        return \"[\" + \",\".join(sublists) + \"]\"\n\n    print(format_no_spaces(results))\n\nsolve()\n```"
        }
    ]
}