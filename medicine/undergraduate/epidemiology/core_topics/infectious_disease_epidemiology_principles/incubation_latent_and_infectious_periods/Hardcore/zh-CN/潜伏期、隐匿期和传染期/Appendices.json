{
    "hands_on_practices": [
        {
            "introduction": "潜伏期、潜隐期和感染期之间的时间关系决定了疾病传播的关键特征，例如是否存在症状前传播。这项练习提供了一个具体的数值场景，旨在帮助你掌握这些核心定义，并精确计算出症状前传播发生的时间窗口。掌握这项基本技能是量化分析任何传染病传播动态的第一步。",
            "id": "4600639",
            "problem": "考虑一个宿主在时间 $0$ 感染了某种病原体。潜隐期是指从感染到出现传染性的时间，潜伏期是指从感染到出现症状的时间，而传染期是宿主能够传播病原体的时间段。假设该病原体的潜隐期为 $2$ 天，潜伏期为 $5$ 天。传染期持续 $7$ 天，并从潜隐期结束时开始。仅使用这些定义和所提供的参数，判断是否存在症状前传播，确定其相对于感染发生的时间窗口，并计算症状前传播的总持续时间。以天为单位给出持续时间的最终数值答案。提供精确值，无需四舍五入。",
            "solution": "设 $t$ 代表以天为单位的时间，其中 $t=0$ 对应感染时刻。根据问题陈述，我们有以下定义和参数。\n\n潜隐期是从感染到出现传染性的时间。设其持续时间为 $T_L$。题目说明其持续时间为 $2$ 天，所以 $T_L = 2$。这意味着宿主在时间 $t = T_L = 2$ 时变得具有传染性。\n\n潜伏期是从感染到出现症状的时间。设其持续时间为 $T_{inc}$。题目说明其持续时间为 $5$ 天，所以 $T_{inc} = 5$。这意味着宿主在时间 $t = T_{inc} = 5$ 时开始出现症状。\n\n传染期是宿主可以传播病原体的时间段。设其持续时间为 $D_{inf}$。题目说明 $D_{inf} = 7$ 天。它在潜隐期结束时开始，即在时间 $t_{\\text{inf,start}} = T_L = 2$。传染期在时间 $t_{\\text{inf,end}} = t_{\\text{inf,start}} + D_{inf} = 2 + 7 = 9$ 结束。因此，宿主具有传染性的时间区间为 $I_{inf} = [2, 9]$。\n\n题目要求我们判断是否存在症状前传播，确定其时间窗口，并计算其总持续时间。\n\n症状前传播定义为宿主在症状出现之前传播病原体。这要求宿主同时具有传染性且处于症状前阶段。\n\n症状前阶段是从感染到症状出现的时间段。根据潜伏期的定义，宿主在时间区间 $I_{pre-symp} = [0, t_{\\text{symp,start}}) = [0, T_{inc}) = [0, 5)$ 内处于症状前阶段。\n\n为了判断是否存在症状前传播，我们必须检查传染期是否在症状期开始之前开始。传染性开始于 $t = T_L = 2$。症状出现于 $t = T_{inc} = 5$。由于 $T_L  T_{inc}$，具体来说是 $2  5$，宿主在出现症状之前就变得具有传染性。因此，存在一个症状前传播的时期。\n\n症状前传播的时间窗口是宿主同时具有传染性且处于症状前阶段的时间段。这是传染区间 $I_{inf}$ 和症状前区间 $I_{pre-symp}$ 的交集。\n$$\n\\text{症状前传播窗口} = I_{inf} \\cap I_{pre-symp} = [2, 9] \\cap [0, 5)\n$$\n这两个集合的交集是区间 $[2, 5)$。这就是相对于 $t=0$ 的感染时刻，发生症状前传播的时间窗口。它从 $t=2$ 天开始，到 $t=5$ 天结束。\n\n症状前传播的总持续时间是这个时间窗口的长度。一个区间 $[a, b)$ 的长度计算为 $b - a$。\n$$\n\\text{持续时间} = 5 - 2 = 3\n$$\n症状前传播的总持续时间为 $3$ 天。一般而言，只要 $T_L  T_{inc}$，这个持续时间就由公式 $T_{inc} - T_L$ 给出。",
            "answer": "$$\n\\boxed{3}\n$$"
        },
        {
            "introduction": "流行病学研究不仅关注个体病例，更要从群体层面理解传播规律。序列间隔（指传染者和被传染者症状出现的时间差）是流行病学调查中的一个关键可观测指标。这项练习将引导你推导出一个深刻的结论：症状前传播的普遍存在如何导致平均序列间隔呈现负值这一反直觉现象。通过这个过程，你将学会如何从宏观的观测数据中洞察病原体传播的微观生物学机制。",
            "id": "4600665",
            "problem": "考虑一个在均匀混合人群中直接传播的呼吸道病原体。设潜伏期 $I$ 定义为从感染到症状出现的时间，潜隐期 $L$ 定义为从感染到传染性开始的时间，代际间隔 $G$ 定义为从传染者感染到被传染者感染的时间。观测到的序列间隔 $S$ 定义为在一个已识别的传播对中，被传染者症状出现与传染者症状出现之间的时间。对于一个传播对，将传染者的潜伏期记为 $I_{1}$，被传染者的潜伏期记为 $I_{2}$。假设 $I_{1}$、$I_{2}$ 和 $G$ 是随机变量，其期望有限，分别为 $\\mu_{1} = \\mathbb{E}[I_{1}]$、$\\mu_{2} = \\mathbb{E}[I_{2}]$ 和 $\\mu_{G} = \\mathbb{E}[G]$。您可以假设期望的线性性成立，并且所有量在流行病学标准更新型传播模型的意义上都是良定义的。\n\n从上述核心定义和第一性原理出发，推导出以 $\\mu_{1}$、$\\mu_{2}$ 和 $\\mu_{G}$ 表示的平均观测序列间隔 $\\mathbb{E}[S]$ 的形式。然后，构造一个单一的解析表达式 $C(\\mu_{1},\\mu_{2},\\mu_{G})$，其符号决定了平均观测序列间隔是否为负，即当且仅当 $C(\\mu_{1},\\mu_{2},\\mu_{G}) > 0$ 时，$\\mathbb{E}[S]  0$。请以最简形式给出 $C(\\mu_{1},\\mu_{2},\\mu_{G})$。无需进行数值计算。在您的推理中，请从流行病学的角度解释负的平均序列间隔对潜伏期、潜隐期和传染期之间的关系意味着什么，以及为什么这种现象会在现实环境中出现。最终答案必须仅为单一的封闭形式解析表达式 $C(\\mu_{1},\\mu_{2},\\mu_{G})$，不带单位。",
            "solution": "该问题要求推导平均观测序列间隔 $\\mathbb{E}[S]$，并构造一个解析表达式 $C$ 来判断 $\\mathbb{E}[S]$ 是否为负。所提供的定义是数理流行病学中的标准定义，为形式化推导奠定了有效的基础。\n\n首先，我们必须建立序列间隔 $S$、代际间隔 $G$ 以及传染者 ($I_1$) 和被传染者 ($I_2$) 的潜伏期之间的数学关系。让我们根据感染事件定义一个时间轴。设时间 $t=0$ 为传染者被感染的时刻。\n\n根据定义：\n1.  传染者在时间 $t_{s,1} = I_1$ 时出现症状。这是从传染者自身被感染到其症状出现所经过的时间。\n2.  传染者在时间 $t_{i,2} = G$ 时将病原体传播给被传染者。这是代际间隔，定义为从传染者感染到被传染者感染的时间。\n3.  被传染者在时间 $t_{i,2}$ 被感染后，经过与其潜伏期 $I_2$ 相等的一段时间后出现症状。因此，被传染者症状出现的绝对时间是 $t_{s,2} = t_{i,2} + I_2 = G + I_2$。\n\n观测到的序列间隔 $S$ 定义为被传染者症状出现与传染者症状出现之间的时间。在数学上，这是它们各自症状出现时间的差值：\n$$S = t_{s,2} - t_{s,1}$$\n代入我们从时间轴推导出的表达式，我们得到：\n$$S = (G + I_2) - I_1$$\n对于单个传播对，该方程给出了随机变量 $S$、$G$、$I_1$ 和 $I_2$ 之间的基本关系。\n\n接下来，我们需要求出平均观测序列间隔 $\\mathbb{E}[S]$。我们对推导出的 $S$ 方程取期望。问题陈述明确允许使用期望的线性性。\n$$\\mathbb{E}[S] = \\mathbb{E}[G + I_2 - I_1]$$\n应用线性性质，即随机变量之和的期望等于它们期望之和，我们有：\n$$\\mathbb{E}[S] = \\mathbb{E}[G] + \\mathbb{E}[I_2] - \\mathbb{E}[I_1]$$\n问题将 $I_1$、$I_2$ 和 $G$ 的平均值分别定义为 $\\mu_1 = \\mathbb{E}[I_1]$、$\\mu_2 = \\mathbb{E}[I_2]$ 和 $\\mu_G = \\mathbb{E}[G]$。代入这些定义，得到平均序列间隔的表达式：\n$$\\mathbb{E}[S] = \\mu_G + \\mu_2 - \\mu_1$$\n\n负的平均序列间隔 $\\mathbb{E}[S]  0$ 的流行病学意义是深远的。这种情况意味着，平均而言，被传染者出现症状的时间*早于*将其病原体传染给他们的传染者。这种现象是存在大量症状前传播的标志。要发生传播，传染者必须具有传染性。从感染到具有传染性的时期是潜隐期 $L$。如果传播发生在时间 $G$（代际间隔），那么必然有 $G \\ge L$。如果这次传播发生在传染者症状出现之前（在时间 $I_1$），那么 $G  I_1$。这要求潜隐期比潜伏期短（$L  I_1$），从而存在一个症状前传染窗口期。如果传播持续发生在这个窗口期内（即平均代际间隔 $\\mu_G$ 小于传染者的平均潜伏期 $\\mu_1$），并且如果被传染者的潜伏期 $\\mu_2$ 不是特别长，那么被传染者的平均症状出现时间 $\\mu_G + \\mu_2$ 就有可能小于传染者的平均症状出现时间 $\\mu_1$。因此，在人群中观察到负的平均序列间隔是症状前传播是疫情主要驱动因素的有力证据。\n\n最后，我们的任务是构造一个单一的解析表达式 $C(\\mu_1, \\mu_2, \\mu_G)$，使得当且仅当 $C(\\mu_1, \\mu_2, \\mu_G) > 0$ 时，有 $\\mathbb{E}[S]  0$。\n平均序列间隔为负的条件是：\n$$\\mathbb{E}[S]  0$$\n$$\\mu_G + \\mu_2 - \\mu_1  0$$\n为了找到一个在此条件下为正的表达式 $C$，我们可以将该不等式两边乘以 $-1$。这个操作会反转不等号的方向：\n$$-(\\mu_G + \\mu_2 - \\mu_1) > 0$$\n$$-\\mu_G - \\mu_2 + \\mu_1 > 0$$\n整理各项，我们得到：\n$$\\mu_1 - \\mu_2 - \\mu_G > 0$$\n当且仅当 $\\mathbb{E}[S]  0$ 时，此不等式成立。因此，我们可以将函数 $C$ 定义为此不等式的左侧。\n$$C(\\mu_1, \\mu_2, \\mu_G) = \\mu_1 - \\mu_2 - \\mu_G$$\n这个表达式满足所要求的条件。由于它是给定平均值的线性组合，因此已是最简形式。",
            "answer": "$$\\boxed{\\mu_{1} - \\mu_{2} - \\mu_{G}}$$"
        },
        {
            "introduction": "理论概念最终需要应用于解决现实世界的公共卫生问题。真实的潜伏期在不同个体间存在差异，因此必须使用统计分布来描述。这项综合性练习将带你体验流行病学家的核心工作流程：你将为潜伏期数据拟合不同的统计模型，使用赤池信息准则（Akaike Information Criterion, $AIC$）来科学地选择最优模型，并最终运用该模型来制定或评估隔离期等关键干预措施的有效性。这让你能亲手将数据分析转化为有据可依的公共卫生决策。",
            "id": "4600638",
            "problem": "给定三个独立的潜伏期数据集，单位为天，假定其值为正且连续。对于每个数据集，您必须拟合两种候选分布：Gamma 分布和对数正态分布，均采用无位置参数的双参数设定。然后，您必须使用赤池信息准则 (AIC) 比较拟合效果，并使用拟合效果更好的模型来量化与隔离设计相关的尾部行为。\n\n基本定义和假设：\n- 形状参数为 $\\alpha$、尺度参数为 $\\theta$ 的 Gamma 分布，其概率密度函数为 $f(t \\mid \\alpha,\\theta) = \\dfrac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}}$，对于 $t > 0$，其中 $\\Gamma(\\cdot)$ 是 Gamma 函数。参数满足 $\\alpha > 0$ 和 $\\theta > 0$。\n- 对数均值为 $\\mu$、对数标准差为 $\\sigma$ 的对数正态分布，其概率密度函数为 $f(t \\mid \\mu,\\sigma) = \\dfrac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\dfrac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right)$，对于 $t > 0$，其中 $\\sigma > 0$。\n- 应使用最大似然估计 (MLE) 来估计每个模型的参数，通过在容许参数空间上最大化对数似然 $\\ell(\\boldsymbol{\\theta} \\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$ 来实现。\n- 仅使用双参数形式（即，对两种分布都将位置参数固定为 $0$）。每个模型的自由参数数量为 $k = 2$。\n- 赤池信息准则 (AIC) 定义为 $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$，其中 $\\ell(\\widehat{\\boldsymbol{\\theta}})$ 是最大化对数似然值，$k$ 是自由参数的数量。\n- 生存函数为 $S(q) = \\mathbb{P}(T > q) = 1 - F(q)$，其中 $F$ 是累积分布函数。$(1 - r)$ 分位数满足 $F(q^\\star) = 1 - r$，等价于 $S(q^\\star) = r$。\n\n每个数据集的任务：\n1. 在上述约束条件下，通过最大似然估计 Gamma 和对数正态分布的参数，计算它们的最大化对数似然值，然后计算它们的 AIC 值。\n2. 选择 AIC 值较小的模型作为更优模型。\n3. 使用更优模型，计算在指定隔离期 $Q$（单位：天）下的尾部概率 $S(Q) = \\mathbb{P}(T > Q)$。\n4. 使用更优模型，计算所需的最小隔离期（单位：天），以使尾部概率小于或等于指定的风险容忍度 $r$；即，计算 $q^\\star$ 使得 $F(q^\\star) = 1 - r$。所有时间均以天为单位表示。\n5. 对于每个数据集，按顺序报告以下列表：\n   - 一个整数模型标识符，其中 Gamma 编码为 $0$，对数正态分布编码为 $1$。\n   - Gamma 分布的 AIC 值，为实数。\n   - 对数正态分布的 AIC 值，为实数。\n   - 所选模型下的尾部概率 $S(Q)$，为实数。\n   - 所选模型下所需的隔离期 $q^\\star$，为实数。\n所有实数必须四舍五入到小数点后恰好 $6$ 位。所有时间均以天为单位。风险容忍度 $r$ 必须按小数处理，而不是百分比。\n\n数据集及相关的隔离评估参数（测试套件）：\n- 数据集 $\\mathcal{D}_1$（中等样本，中度右偏）：$\\{\\,2.0,\\,3.5,\\,4.2,\\,5.1,\\,6.3,\\,3.8,\\,4.9,\\,2.7,\\,5.6,\\,4.1,\\,3.2,\\,6.8,\\,5.0,\\,4.4,\\,3.9\\,\\}$，隔离期 $Q_1 = 7.0$，风险容忍度 $r_1 = 0.05$。\n- 数据集 $\\mathcal{D}_2$（样本量较小，右尾较重）：$\\{\\,1.2,\\,2.5,\\,3.1,\\,4.7,\\,2.9,\\,5.3,\\,9.5,\\,11.2,\\,14.8,\\,3.6,\\,4.1\\,\\}$，隔离期 $Q_2 = 10.0$，风险容忍度 $r_2 = 0.01$。\n- 数据集 $\\mathcal{D}_3$（极小样本，低方差）：$\\{\\,3.0,\\,3.2,\\,3.4,\\,3.1,\\,3.3\\,\\}$，隔离期 $Q_3 = 5.0$，风险容忍度 $r_3 = 0.10$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由三个子列表组成的逗号分隔列表，每个子列表按顺序 $\\mathcal{D}_1,\\mathcal{D}_2,\\mathcal{D}_3$ 对应一个数据集。每个子列表的格式必须为 $[m,a_{\\Gamma},a_{\\mathrm{LN}},s,q^\\star]$，不含空格，其中 $m$ 是整数模型标识符，$a_{\\Gamma}$ 是 Gamma 分布的 AIC，$a_{\\mathrm{LN}}$ 是对数正态分布的 AIC，$s$ 是所选模型下的 $S(Q)$，$q^\\star$ 是所选模型下所需的隔离期。例如，一个有效的格式为 `[[0,12.345000,11.234000,0.012300,8.765000],[...],[...]]` 但不含任何空格。",
            "solution": "我们从统计推断和概率论的基本定义开始。对于一个参数矢量为 $\\boldsymbol{\\theta}$、独立观测值为 $\\{t_i\\}_{i=1}^{n}$ 的参数模型，其似然函数为 $L(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\prod_{i=1}^{n} f(t_i \\mid \\boldsymbol{\\theta})$，对数似然函数为 $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\}) = \\sum_{i=1}^{n} \\log f(t_i \\mid \\boldsymbol{\\theta})$。最大似然估计 (MLE) 通过在容许参数空间上最大化 $\\ell(\\boldsymbol{\\theta}\\mid \\{t_i\\})$ 来选择 $\\widehat{\\boldsymbol{\\theta}}$。使用 Akaike 框架进行模型选择是基于赤池信息准则 (AIC)，其定义为 $\\mathrm{AIC} = 2k - 2\\ell(\\widehat{\\boldsymbol{\\theta}})$，其中 $k$ 是自由参数的数量。\n\n我们分析两种用于潜伏期（其值为正且连续）的模型：\n\n1. Gamma 分布。参数：形状 $\\alpha  0$ 和尺度 $\\theta  0$。密度函数：\n$$\nf(t \\mid \\alpha,\\theta) = \\frac{t^{\\alpha - 1} e^{-t/\\theta}}{\\Gamma(\\alpha)\\,\\theta^{\\alpha}},\\quad t0.\n$$\n对于一个数据集 $\\{t_i\\}_{i=1}^{n}$，其对数似然函数为\n$$\n\\ell(\\alpha,\\theta) = \\sum_{i=1}^{n} \\left[ (\\alpha - 1)\\log t_i - \\frac{t_i}{\\theta} - \\log \\Gamma(\\alpha) - \\alpha \\log \\theta \\right].\n$$\n约束条件为 $\\alpha0$ 和 $\\theta0$。\n\n2. 对数正态分布。参数：对数均值 $\\mu \\in \\mathbb{R}$ 和对数标准差 $\\sigma  0$。密度函数：\n$$\nf(t \\mid \\mu,\\sigma) = \\frac{1}{t\\,\\sigma\\,\\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln t - \\mu)^2}{2\\sigma^2} \\right),\\quad t0.\n$$\n其对数似然函数为\n$$\n\\ell(\\mu,\\sigma) = \\sum_{i=1}^{n} \\left[ -\\log t_i - \\log \\sigma - \\frac{1}{2}\\log(2\\pi) - \\frac{(\\ln t_i - \\mu)^2}{2\\sigma^2} \\right],\n$$\n其中 $\\sigma0$。\n\n在两个模型中，我们都通过将位置参数固定为 $0$ 来限制为双参数版本。因此，每个模型的自由参数数量为 $k=2$。通过 MLE 获得 Gamma 模型的 $\\widehat{\\alpha},\\widehat{\\theta}$ 和对数正态模型的 $\\widehat{\\mu},\\widehat{\\sigma}$ 后，我们计算\n$$\n\\mathrm{AIC}_{\\Gamma} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\alpha},\\widehat{\\theta}),\\quad\n\\mathrm{AIC}_{\\mathrm{LN}} = 2\\cdot 2 - 2\\,\\ell(\\widehat{\\mu},\\widehat{\\sigma}).\n$$\n我们选择 AIC 值较小的模型作为更优拟合。\n\n为了评估与隔离设计相关的尾部行为，对于一个隔离期 $Q$（单位：天），拟合模型下的尾部概率（生存函数）为\n$$\nS(Q) = \\mathbb{P}(T  Q) = 1 - F(Q),\n$$\n其中 $F$ 是拟合模型的累积分布函数。对于一个指定的风险容忍度 $r$（小数形式，非百分比），确保 $\\mathbb{P}(T  q^\\star) \\le r$ 的最小隔离期 $q^\\star$ 满足\n$$\nF(q^\\star) = 1 - r \\quad \\Longleftrightarrow \\quad q^\\star = F^{-1}(1 - r).\n$$\n这是通过所选模型在概率 $1-r$ 处的分位数函数计算得出的。\n\n算法设计：\n- 输入数据是三个潜伏期数据集（单位：天）及其相关的 $(Q,r)$ 对。我们将其表示为 $(\\mathcal{D}_j,Q_j,r_j)$，其中 $j \\in \\{1,2,3\\}$。\n- 对于每个数据集 $\\mathcal{D}_j$，我们在约束条件（分别为 $\\alpha0,\\theta0$ 和 $\\sigma0$）和位置参数固定为 $0$ 的情况下，计算 Gamma 和对数正态模型的 MLE。在实践中，我们可以通过对负对数似然进行数值优化来实现 MLE，或者使用能够在指定约束下通过将位置参数固定为 $0$ 来执行 MLE 的稳健库例程。\n- 我们在 MLE 处评估最大化对数似然 $\\ell_{\\Gamma,j}$ 和 $\\ell_{\\mathrm{LN},j}$，并计算 $\\mathrm{AIC}_{\\Gamma,j} = 4 - 2\\ell_{\\Gamma,j}$ 和 $\\mathrm{AIC}_{\\mathrm{LN},j} = 4 - 2\\ell_{\\mathrm{LN},j}$。\n- 我们选择 AIC 较小的模型：如果 $\\mathrm{AIC}_{\\Gamma,j}  \\mathrm{AIC}_{\\mathrm{LN},j}$，则定义 $m_j = 0$，否则 $m_j = 1$（若值相等，可选择对数正态模型，但确定性的实现是在 $\\mathrm{AIC}_{\\Gamma,j} \\ge \\mathrm{AIC}_{\\mathrm{LN},j}$ 时选择对数正态模型）。\n- 在所选模型下，我们计算在 $Q_j$ 处的生存函数：$s_j = S(Q_j)$，以及所需的隔离期 $q^\\star_j = F^{-1}(1-r_j)$。\n- 我们将所有实数四舍五入到小数点后恰好 $6$ 位。\n- 我们输出单行结果，其中包含一个由三个子列表 $[m_j,\\mathrm{AIC}_{\\Gamma,j},\\mathrm{AIC}_{\\mathrm{LN},j},s_j,q^\\star_j]$ 组成的列表，按 $j=1,2,3$ 的顺序排列，不含任何空格。\n\n科学启示：\n- 如果 $\\mathrm{AIC}_{\\mathrm{LN}}$ 较小，这表明与 Gamma 拟合相比，其右尾相对更重，这往往会增加较大 $Q$ 处的 $S(Q)$ 值，并对严格的 $r$ 值夸大 $q^\\star$ 的值，意味着需要更长的隔离期才能达到相同的残余风险。\n- 相反，如果 $\\mathrm{AIC}_{\\Gamma}$ 较小，则尾部通常较轻，对于相同的 $r$，可能产生较小的 $S(Q)$ 和较短的 $q^\\star$。\n- 小样本数据集测试了稳定性：两种模型可能拟合得非常接近，AIC 值也相似；尽管如此，基于分位数的 $q^\\star$ 计算在所选模型下仍然是良定义的。\n\n所有计算必须以天为单位表示时间，以小数形式表示尾部概率，并以指定的列表格式输出最终结果，保留六位小数且不含空格。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef fit_gamma_mle(data):\n    # Fit two-parameter Gamma by fixing loc=0\n    a_hat, loc_hat, scale_hat = stats.gamma.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.gamma.logpdf(data, a=a_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # shape and scale\n    aic = 2 * k - 2 * ll\n    params = {'shape': a_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef fit_lognorm_mle(data):\n    # Fit two-parameter Lognormal by fixing loc=0\n    s_hat, loc_hat, scale_hat = stats.lognorm.fit(data, floc=0.0)\n    # Compute log-likelihood at MLE\n    logpdf = stats.lognorm.logpdf(data, s=s_hat, loc=0.0, scale=scale_hat)\n    ll = float(np.sum(logpdf))\n    k = 2  # s (sigma), scale (=exp(mu))\n    aic = 2 * k - 2 * ll\n    # For interpretability, mu_hat = log(scale_hat), sigma_hat = s_hat\n    params = {'sigma': s_hat, 'scale': scale_hat}\n    return params, ll, aic\n\ndef survival_and_quantile_gamma(params, q, r):\n    # Survival at q and quantile at 1-r for Gamma(shape, scale)\n    shape = params['shape']\n    scale = params['scale']\n    s_val = float(stats.gamma.sf(q, a=shape, loc=0.0, scale=scale))\n    q_star = float(stats.gamma.ppf(1.0 - r, a=shape, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef survival_and_quantile_lognorm(params, q, r):\n    # Survival at q and quantile at 1-r for Lognormal(sigma, scale=exp(mu))\n    sigma = params['sigma']\n    scale = params['scale']\n    s_val = float(stats.lognorm.sf(q, s=sigma, loc=0.0, scale=scale))\n    q_star = float(stats.lognorm.ppf(1.0 - r, s=sigma, loc=0.0, scale=scale))\n    return s_val, q_star\n\ndef round6(x):\n    return float(f\"{x:.6f}\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (data list, Q in days, r in decimal)\n    test_cases = [\n        ([2.0, 3.5, 4.2, 5.1, 6.3, 3.8, 4.9, 2.7, 5.6, 4.1, 3.2, 6.8, 5.0, 4.4, 3.9], 7.0, 0.05),\n        ([1.2, 2.5, 3.1, 4.7, 2.9, 5.3, 9.5, 11.2, 14.8, 3.6, 4.1], 10.0, 0.01),\n        ([3.0, 3.2, 3.4, 3.1, 3.3], 5.0, 0.10),\n    ]\n\n    results = []\n    for data, Q, r in test_cases:\n        data = np.asarray(data, dtype=float)\n        # Fit both models\n        g_params, g_ll, g_aic = fit_gamma_mle(data)\n        ln_params, ln_ll, ln_aic = fit_lognorm_mle(data)\n        # Select model: 0 for Gamma, 1 for Lognormal (choose LN on tie)\n        if g_aic  ln_aic:\n            model_id = 0\n            s_Q, q_star = survival_and_quantile_gamma(g_params, Q, r)\n        else:\n            model_id = 1\n            s_Q, q_star = survival_and_quantile_lognorm(ln_params, Q, r)\n        # Round outputs\n        out = [\n            model_id,\n            round6(g_aic),\n            round6(ln_aic),\n            round6(s_Q),\n            round6(q_star),\n        ]\n        results.append(out)\n\n    # Format output: single line, no spaces\n    def format_no_spaces(res):\n        sublists = []\n        for sub in res:\n            items = []\n            for val in sub:\n                if isinstance(val, int):\n                    items.append(str(val))\n                else:\n                    # Ensure exactly 6 decimal places (already rounded)\n                    items.append(f\"{val:.6f}\")\n            sublists.append(\"[\" + \",\".join(items) + \"]\")\n        return \"[\" + \",\".join(sublists) + \"]\"\n\n    print(format_no_spaces(results))\n\nsolve()\n```"
        }
    ]
}