{
    "hands_on_practices": [
        {
            "introduction": "接触者追踪的有效性本质上是一场与病毒传播速度的竞赛。为了阻止疾病蔓延，公共卫生团队必须在接触者具有传染性之前找到并隔离他们。本练习通过一个假设情景，要求你量化这种竞赛的结果：你需要推导出一个公式，计算在给定的隔离延迟下，能够阻止多大比例的二代传播，从而深入理解追踪速度与传染病代际间隔之间的关键关系 。",
            "id": "4581590",
            "problem": "考虑一种病原体，其从一个个体感染到其引起的任一二代病例感染的时间（即代际间隔）由威布尔分布建模。设其概率密度函数为 $g(t)$，形状参数为 $k$，尺度参数为 $\\lambda$，因此当 $t \\ge 0$ 时，其密度为 $g(t) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right)$，而当 $t  0$ 时，$g(t)=0$。假设一个感染者的瞬时传染性曲线与 $g(t)$ 成正比，并且在感染后时间 $t$ 产生的期望二次感染数为 $R_0 g(t)$，其中 $R_0$ 是基本再生数 (R0)。假设一种接触者追踪策略在其感染后固定的延迟时间 $d$ 隔离受感染的接触者，此后其传染性立即并完全降至零。\n\n仅使用这些假设和概率分布的标准性质，从基本原理出发，推导一个表达式，用 $g(t)$ 表示该延迟隔离策略所阻止的后续传播的期望比例，然后针对威布尔代际间隔计算该表达式的值。最后，计算当 $k = 2.3$，$\\lambda = 5.2$ 天，以及 $d = 3.0$ 天时该比例的数值。将您的最终答案表示为一个无单位的小数，并四舍五入到四位有效数字。不要将答案表示为百分比。",
            "solution": "该问题已经过验证，被认为是科学上可靠、定义明确且客观的。这是一个理论流行病学中的标准问题，可以从基本原理出发解决。\n\n根据传染性曲线，一个感染者在自身感染后时间 $t$ 产生的期望二次感染数为 $R_0 g(t)$。其中，$R_0$ 是基本再生数，$g(t)$ 是代际间隔的概率密度函数 (PDF)。\n\n首先，我们确定在没有任何干预措施的情况下，单个病例产生的总期望二次感染数 $N_{total}$。这可以通过对所有时间的传染性曲线进行积分得到：\n$$\nN_{total} = \\int_{-\\infty}^{\\infty} R_0 g(t) \\, dt\n$$\n问题陈述代际间隔的概率密度函数 $g(t)$ 在 $t  0$ 时为零。因此，积分变为：\n$$\nN_{total} = \\int_{0}^{\\infty} R_0 g(t) \\, dt = R_0 \\int_{0}^{\\infty} g(t) \\, dt\n$$\n根据定义，任何概率密度函数在其整个定义域上的积分等于 $1$。因此，$\\int_{0}^{\\infty} g(t) \\, dt = 1$。这证实了总期望二次病例数是 $R_0$，与基本再生数的定义一致。\n$$\nN_{total} = R_0 \\times 1 = R_0\n$$\n接下来，我们考虑接触者追踪策略的效果。该策略在感染者感染后固定的延迟时间 $d$ 将其隔离，此时其传染性立即并完全变为零。这意味着所有本应在任何时间 $t > d$ 发生的传播都被阻止了。\n\n被阻止的期望传播数 $N_{prevented}$ 是传染性曲线在传播被阻断的时间段内（即从 $t=d$ 到无穷大）的积分：\n$$\nN_{prevented} = \\int_{d}^{\\infty} R_0 g(t) \\, dt = R_0 \\int_{d}^{\\infty} g(t) \\, dt\n$$\n问题要求计算被阻止的后续传播的期望比例。这个比例，我们记为 $F_{prevented}$，是被阻止的期望传播数与总期望传播数的比值：\n$$\nF_{prevented} = \\frac{N_{prevented}}{N_{total}} = \\frac{R_0 \\int_{d}^{\\infty} g(t) \\, dt}{R_0}\n$$\n$R_0$ 项相互抵消，得到一个仅依赖于代际间隔分布和隔离延迟时间的、被阻止传播比例的通用表达式：\n$$\nF_{prevented} = \\int_{d}^{\\infty} g(t) \\, dt\n$$\n这个积分代表了传播事件在时间 $d$ 之后发生的概率。它是累积分布函数 (CDF) 在 $d$ 处取值的补集。如果我们定义累积分布函数为 $G(t) = \\int_0^t g(\\tau) \\, d\\tau$，那么被阻止的比例就是 $1 - G(d)$。这也被称为生存函数，$S(d)$。\n\n现在，我们为给定的威布尔分布计算这个表达式。其概率密度函数为：\n$$\ng(t) = \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\quad \\text{for } t \\ge 0\n$$\n为了求得被阻止的比例，我们必须计算 $F_{prevented} = \\int_{d}^{\\infty} g(t) \\, dt$。通常，先求出累积分布函数 $G(d) = \\int_0^d g(t) \\, dt$，然后计算 $1 - G(d)$ 会更简单。\n$$\nG(d) = \\int_0^d \\frac{k}{\\lambda}\\left(\\frac{t}{\\lambda}\\right)^{k-1}\\exp\\!\\left(-\\left(\\frac{t}{\\lambda}\\right)^{k}\\right) \\, dt\n$$\n我们使用换元法，令 $u = (t/\\lambda)^k$。那么微分是 $du = \\frac{k}{\\lambda} \\left(\\frac{t}{\\lambda}\\right)^{k-1} dt$。积分上下限分别从 $t=0$ 和 $t=d$ 变为 $u=(0/\\lambda)^k = 0$ 和 $u=(d/\\lambda)^k$。\n$$\nG(d) = \\int_0^{(d/\\lambda)^k} \\exp(-u) \\, du = \\left[-\\exp(-u)\\right]_0^{(d/\\lambda)^k} = -\\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right) - (-\\exp(0)) = 1 - \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\n$$\n因此，被阻止的传播比例为：\n$$\nF_{prevented} = 1 - G(d) = 1 - \\left(1 - \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\\right) = \\exp\\left(-\\left(\\frac{d}{\\lambda}\\right)^k\\right)\n$$\n这就是被阻止的后续传播比例的解析表达式。\n\n最后，我们使用给定的参数计算数值：形状参数 $k = 2.3$，尺度参数 $\\lambda = 5.2$ 天，隔离延迟 $d = 3.0$ 天。$\\lambda$ 和 $d$ 的单位一致，所以它们的比值是无量纲的。\n$$\nF_{prevented} = \\exp\\left(-\\left(\\frac{3.0}{5.2}\\right)^{2.3}\\right)\n$$\n首先，我们计算指数部分：\n$$\n\\left(\\frac{3.0}{5.2}\\right) \\approx 0.57692307...\n$$\n$$\n\\left(\\frac{3.0}{5.2}\\right)^{2.3} \\approx (0.57692307...)^{2.3} \\approx 0.28225155...\n$$\n现在，我们计算该值负数的指数：\n$$\nF_{prevented} = \\exp(-0.28225155...) \\approx 0.754090...\n$$\n将结果四舍五入到四位有效数字，得到 $0.7541$。这是一个无单位的小数，代表被阻止的传播比例。",
            "answer": "$$\n\\boxed{0.7541}\n$$"
        },
        {
            "introduction": "成功追踪到接触者只是第一步，接下来必须评估其感染风险，而这通常需要借助诊断检测。本练习将带你应用贝叶斯定理来解决一个核心问题：当一位接触者在暴露后某一天的抗原检测结果为阴性时，我们应该如何更新对其感染可能性的判断？通过这个练习，你将学会如何结合暴露风险（先验概率）和时变的检测灵敏度，来计算更为精确的后验感染概率，这是在实践中进行风险分层和决策的关键技能 。",
            "id": "4581601",
            "problem": "一个公共卫生接触者追踪团队在一次发生于时间 $t=0$ 的单一暴露事件后，为每一位追踪到的接触者分配一个暴露强度评分。假设该团队将每分钟的传播风险建模为恒定值，并与一个暴露权重成乘法关系，因此如果接触持续了 $d$ 分钟，暴露权重为 $w$，基线风险为 $\\beta$ (每分钟)，则先验感染概率由泊松过程的无事件概率模型给出：\n$$\nP(\\text{感染}) \\equiv p_{0} = 1 - \\exp\\!\\big(-\\beta\\,w\\,d\\big).\n$$\n在暴露后第 $t$ 天，进行了一次快速抗原检测。设检测的灵敏度（在感染情况下检测结果为阳性的概率）随时间变化，遵循逻辑斯蒂函数\n$$\ns(t) = \\frac{s_{\\max}}{1 + \\exp\\!\\big(-k\\,(t - t_{50})\\big)},\n$$\n并设检测的特异性（在未感染情况下检测结果为阴性的概率）为 $\\sigma$，假设其不随时间 $t$ 变化。假设如果发生感染，感染发生在暴露时间 $t=0$，并且灵敏度 $s(t)$ 已经是第 $t$ 天宿主内变异性的边际值。\n\n仅使用贝叶斯法则以及灵敏度和特异性的定义，推导在第 $t$ 天观察到阴性抗原检测结果后，发生感染的后验概率的解析表达式，该表达式应以 $p_{0}$、$s(t)$ 和 $\\sigma$ 表示。然后，使用以下参数评估该后验概率：\n- 基线风险 $\\beta = 1.5 \\times 10^{-3}$ 每分钟，\n- 暴露权重 $w = 2.5$，\n- 持续时间 $d = 30$ 分钟，\n- 检测日期 $t = 3$ 天（暴露后），\n- 灵敏度参数 $s_{\\max} = 0.85$，$k = 1.2$ 每天，$t_{50} = 4$ 天，\n- 特异性 $\\sigma = 0.995$。\n\n将后验概率以小数形式报告。将您的答案四舍五入到四位有效数字。不要使用百分号。",
            "solution": "该问题要求推导在一次阴性检测后感染的后验概率的解析表达式，并随后使用一组特定参数对其进行评估。这是贝叶斯法则的直接应用。\n\n首先，我们定义相关事件：\n- 令 $I$ 为个体被感染的事件。\n- 令 $I^c$ 为个体未被感染的事件。\n- 令 $T^+$ 为抗原检测结果为阳性的事件。\n- 令 $T^-$ 为抗原检测结果为阴性的事件。\n\n我们需要求解的是在第 $t$ 天检测结果为阴性的条件下，个体感染的后验概率，记为 $P(I | T^-)$。\n\n根据问题陈述，我们已知以下概率：\n- 先验感染概率为 $P(I) = p_0$。\n- 因此，未感染的先验概率为 $P(I^c) = 1 - P(I) = 1 - p_0$。\n- 在第 $t$ 天，检测的灵敏度是给定感染条件下检测为阳性的概率：$P(T^+ | I) = s(t)$。由此，给定感染条件下检测为阴性的概率是 $P(T^- | I) = 1 - P(T^+ | I) = 1 - s(t)$。\n- 检测的特异性是给定未感染条件下检测为阴性的概率：$P(T^- | I^c) = \\sigma$。\n\n根据贝叶斯法则，在检测结果为阴性条件下的感染后验概率为：\n$$\nP(I | T^-) = \\frac{P(T^- | I) P(I)}{P(T^-)}\n$$\n\n分母 $P(T^-)$ 是检测结果为阴性的全概率。可以使用全概率公式将其展开：\n$$\nP(T^-) = P(T^- | I) P(I) + P(T^- | I^c) P(I^c)\n$$\n将已定义的项代入此表达式：\n$$\nP(T^-) = (1 - s(t)) p_0 + \\sigma (1 - p_0)\n$$\n\n现在，我们可以将 $P(T^-)$ 的表达式代回贝叶斯法则：\n$$\nP(I | T^-) = \\frac{P(T^- | I) P(I)}{(1 - s(t)) p_0 + \\sigma (1 - p_0)}\n$$\n将已知项代入分子：\n$$\nP(I | T^-) = \\frac{(1 - s(t)) p_0}{(1 - s(t)) p_0 + \\sigma (1 - p_0)}\n$$\n这就是所要求的用 $p_0$、$s(t)$ 和 $\\sigma$ 表示的感染后验概率的解析表达式。\n\n接下来，我们必须使用给定的参数来评估这个表达式。\n参数如下：\n- 基线风险 $\\beta = 1.5 \\times 10^{-3}$ 每分钟\n- 暴露权重 $w = 2.5$\n- 持续时间 $d = 30$ 分钟\n- 检测日期 $t = 3$ 天\n- 灵敏度参数 $s_{\\max} = 0.85$，$k = 1.2$ 每天，$t_{50} = 4$ 天\n- 特异性 $\\sigma = 0.995$\n\n首先，我们计算先验感染概率 $p_0$：\n$$\np_0 = 1 - \\exp(-\\beta w d)\n$$\n指数的参数是：\n$$\n-\\beta w d = -(1.5 \\times 10^{-3}) \\times 2.5 \\times 30 = -0.0015 \\times 75 = -0.1125\n$$\n所以，先验概率是：\n$$\np_0 = 1 - \\exp(-0.1125)\n$$\n\n接下来，我们计算第 $t=3$ 天的检测灵敏度 $s(3)$：\n$$\ns(t) = \\frac{s_{\\max}}{1 + \\exp(-k(t - t_{50}))}\n$$\n分母中指数的参数是：\n$$\n-k(t - t_{50}) = -1.2 \\times (3 - 4) = -1.2 \\times (-1) = 1.2\n$$\n所以，在 $t=3$ 时的灵敏度是：\n$$\ns(3) = \\frac{0.85}{1 + \\exp(1.2)}\n$$\n\n现在我们将 $p_0$ 和 $s(3)$ 的表达式代入我们推导出的后验概率公式。我们将后验概率表示为 $P_{\\text{post}}$：\n$$\nP_{\\text{post}} = P(I | T^-) = \\frac{(1 - s(3)) p_0}{(1 - s(3)) p_0 + \\sigma (1 - p_0)}\n$$\n让我们代入中间表达式：\n$$\n1 - p_0 = 1 - (1 - \\exp(-0.1125)) = \\exp(-0.1125)\n$$\n$$\n1 - s(3) = 1 - \\frac{0.85}{1 + \\exp(1.2)} = \\frac{1 + \\exp(1.2) - 0.85}{1 + \\exp(1.2)} = \\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\n$$\n$P_{\\text{post}}$ 的分子是：\n$$\n(1 - s(3))p_0 = \\left(\\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\\right) \\times (1 - \\exp(-0.1125))\n$$\n$P_{\\text{post}}$ 的分母是：\n$$\n(1 - s(3))p_0 + \\sigma(1 - p_0) = \\left(\\frac{0.15 + \\exp(1.2)}{1 + \\exp(1.2)}\\right) (1 - \\exp(-0.1125)) + 0.995 \\exp(-0.1125)\n$$\n\n现在我们进行数值计算：\n$$\n\\exp(-0.1125) \\approx 0.8935950\n$$\n$$\np_0 = 1 - 0.8935950 = 0.1064050\n$$\n$$\n\\exp(1.2) \\approx 3.3201169\n$$\n$$\ns(3) = \\frac{0.85}{1 + 3.3201169} = \\frac{0.85}{4.3201169} \\approx 0.1967543\n$$\n$$\n1 - s(3) \\approx 1 - 0.1967543 = 0.8032457\n$$\n\n现在我们可以计算后验概率表达式的分子和分母：\n分子：\n$$\n(1 - s(3)) p_0 \\approx 0.8032457 \\times 0.1064050 \\approx 0.0854701\n$$\n分母：\n$$\n(1 - s(3)) p_0 + \\sigma (1 - p_0) \\approx 0.0854701 + (0.995 \\times 0.8935950)\n$$\n$$\n(1 - s(3)) p_0 + \\sigma (1 - p_0) \\approx 0.0854701 + 0.8891270 = 0.9745971\n$$\n最后，后验概率是：\n$$\nP(I | T^-) = \\frac{0.0854701}{0.9745971} \\approx 0.0877003\n$$\n问题要求答案四舍五入到四位有效数字。第一位有效数字是 $8$。第四位是最后的 $0$。\n$$\nP(I | T^-) \\approx 0.08770\n$$",
            "answer": "$$\n\\boxed{0.08770}\n$$"
        },
        {
            "introduction": "在许多传染病传播中，并非所有感染者的传染力都相同，少数“超级传播者”可能导致了绝大多数的续发病例。这种传播异质性为我们提供了优化追踪策略的机会。本练习将引导你探索“回顾性追踪”（backward tracing）这一高效策略背后的数学原理，即通过一个已发现的病例去寻找其传染源，我们更有可能定位到引发大规模传播的源头。这个练习要求你从第一性原理出发，利用大小偏倚抽样的概念，推导回顾性追踪所能发现的传播簇的期望大小，从而深刻理解为何此策略在应对具有超级传播现象的疾病时尤为关键 。",
            "id": "4581671",
            "problem": "一种新发传染病在人群中传播，其中由单个感染者引起的续发感染数（子代数量）遵循负二项分布模型，其均值为 $R0$，离散参数为 $k0$。在该标准参数化下，方差为 $R + \\frac{R^{2}}{k}$。从所有已发现的病例中随机检测出一个病例，公共卫生从业人员采用向后接触者追踪：他们以概率 1 成功识别出该被检测病例的感染源（源头病例），然后从该源头进行向前追踪，以识别出由同一源头在同一代中引起的所有其余感染。\n\n将观察到的被检测病例视为固定的，并将通过向后追踪发现的传播簇定义为由同一源头病例在同一代中引起的、除最初被检测到的病例外所有其他感染的集合。假设追踪是即时且完美的，代际之间不重叠，并且不存在右删失。\n\n从规模偏倚抽样和负二项分布的标准性质等第一性原理出发，推导这个向后追踪的传播簇中预期病例数的闭式表达式（即，由同一源头引起的、不包括最初被检测到的病例外其他感染的预期数量），并用 $R$ 和 $k$ 表示。以单一解析表达式的形式给出最终结果。无需四舍五入。",
            "solution": "问题要求计算由一个随机检测到的病例的感染源所产生的其他病例（共同被感染者）的预期数量。这个过程涉及规模偏倚抽样。\n\n设随机变量 $X$ 表示由单个感染者引起的续发感染数。这就是子代数量。问题陈述 $X$ 遵循负二项分布。该分布由其均值 $E[X] = R$ 和离散参数 $k$ 来参数化。方差为 $\\text{Var}(X) = R + \\frac{R^2}{k}$。\n\n当从所有感染者群体中随机检测到一个病例时，该病例的感染源并非从所有感染源群体中随机选择的个体。一个产生了较多续发病例（比如 $j$ 个）的感染源，其成为一个随机选择病例的感染源的概率，是只产生一个病例的感染源的 $j$ 倍。这就是规模偏倚抽样的原理。\n\n设 $X^*$ 为随机变量，表示一个随机选择病例的感染源的子代数量。$X^*$ 的分布是 $X$ 的规模偏倚分布。对于 $j \\ge 1$，$X^*$ 的概率质量函数 (PMF) 与 $X$ 的 PMF 通过以下公式相关联：\n$$ P(X^*=j) = \\frac{j \\cdot P(X=j)}{E[X]} $$\n分母 $E[X]$ 是一个归一化常数，因为 $\\sum_{j=0}^{\\infty} j \\cdot P(X=j) = E[X]$。注意 $P(X^*=0) = 0$，因为感染源必须至少引起一次感染（即被检测到的那个病例）。\n\n我们要求的是向后追踪的传播簇中的预期病例数，它被定义为来自同一感染源、但不包括最初被检测到的病例外所有其他感染的集合。如果源头病例的总子代数量是 $X^*$，那么这个传播簇中的病例数就是 $X^* - 1$。我们需要计算 $E[X^* - 1]$。\n\n根据期望的线性性质，我们有：\n$$ E[X^* - 1] = E[X^*] - 1 $$\n为了求得 $E[X^*]$，我们可以使用原始分布 $X$ 的矩。规模偏倚变量 $X^*$ 的期望值由下式给出：\n$$ E[X^*] = \\sum_{j=1}^{\\infty} j \\cdot P(X^*=j) = \\sum_{j=1}^{\\infty} j \\cdot \\frac{j \\cdot P(X=j)}{E[X]} = \\frac{1}{E[X]} \\sum_{j=0}^{\\infty} j^2 \\cdot P(X=j) = \\frac{E[X^2]}{E[X]} $$\n我们已知 $X$ 的一阶矩（均值）：\n$$ E[X] = R $$\n我们可以从方差中求出二阶矩 $E[X^2]$。方差的定义是 $\\text{Var}(X) = E[X^2] - (E[X])^2$。因此：\n$$ E[X^2] = \\text{Var}(X) + (E[X])^2 $$\n问题给出了方差的表达式：\n$$ \\text{Var}(X) = R + \\frac{R^2}{k} $$\n代入给定的均值和方差，我们得到 $X$ 的二阶矩：\n$$ E[X^2] = \\left(R + \\frac{R^2}{k}\\right) + R^2 = R + R^2 \\left(1 + \\frac{1}{k}\\right) = R + R^2 \\frac{k+1}{k} $$\n现在我们可以计算 $E[X^*]$：\n$$ E[X^*] = \\frac{E[X^2]}{E[X]} = \\frac{R + R^2 \\frac{k+1}{k}}{R} $$\n将分子中的每一项除以 $R$ 可得：\n$$ E[X^*] = 1 + R \\frac{k+1}{k} $$\n最后，我们可以求出向后追踪的传播簇的预期规模 $E[X^* - 1]$：\n$$ E[X^* - 1] = E[X^*] - 1 = \\left(1 + R \\frac{k+1}{k}\\right) - 1 = R \\frac{k+1}{k} $$\n该表达式也可以写成 $R\\left(1 + \\frac{1}{k}\\right)$ 或 $R + \\frac{R}{k}$。这一结果表明，在传播异质性高（$k$ 值小）的人群中，向后接触者追踪尤其有效，因为它更有可能追溯到一个有大量被感染者的源头。例如，当 $k \\to \\infty$ 时，负二项分布收敛于泊松分布，预期的传播簇规模变为 $\\lim_{k \\to \\infty} R(1 + \\frac{1}{k}) = R$。相比之下，对于小的 $k$，$\\frac{1}{k}$ 项会变大，从而显著增加接触者追踪的预期收获。",
            "answer": "$$\\boxed{R + \\frac{R}{k}}$$"
        }
    ]
}