{
    "hands_on_practices": [
        {
            "introduction": "有效再生数（$R_e$）是追踪疫情实时传播的关键指标。它并非一个固定不变的数值，而是受到人群免疫水平和公共卫生干预措施的动态影响。本练习将引导你剖析$R_e$的构成要素——基础再生数（$R_0$）、控制措施的效果以及剩余的人群易感性——从而量化评估人群中的免疫保护水平。",
            "id": "4598126",
            "problem": "一种直接传播的传染病在一个庞大且均匀混合的人群中传播。在没有任何免疫或干预措施的情况下，每个感染者平均每单位时间进行 $k$ 次有效接触，每次接触以概率 $\\beta$ 传播感染，平均传染期为 $D$。基本再生数定义为：在没有干预措施的情况下，将一个典型的感染者引入一个完全易感的人群中所引起的继发感染的平均数量。\n\n假设实施了两种不改变易感人群的干预措施：非药物干预措施将平均接触率降低了因子 $0.70$（相当于接触率减少了 $30\\%$），病例隔离将平均传染期降低了因子 $0.75$（相当于传染期减少了 $25\\%$）。在某个特定日期，测得的有效再生数为 $0.91$。假设免疫力（来自疫苗接种和/或既往感染）的作用仅在于降低被接触者被感染的概率，并将人群平均剩余易感比例 $S_{\\text{eff}}$ 定义为随机接触一个个体时，该个体相对于完全易感人群而言是易感的平均概率。\n\n从以上定义以及“每个病例的预期继发感染数与接触率、每次接触的传播概率、传染期以及接触者中易感者的比例成线性关系”这一思想出发，推导一个联系基本再生数 $R_{0}$、干预缩放因子、有效再生数 $R_{\\text{e}}$ 和 $S_{\\text{eff}}$ 的表达式。使用此表达式，计算当 $R_{0} = 3.8$、接触率因子为 $0.70$、传染期因子为 $0.75$ 且 $R_{\\text{e}} = 0.91$ 时 $S_{\\text{eff}}$ 的值。将您的答案四舍五入到 $4$ 位有效数字，并以小数形式表示（不要使用百分号）。",
            "solution": "首先验证问题，以确保其科学性、适定性和客观性。\n\n### 步骤 1：提取已知条件\n- 传染病传播：在庞大且均匀混合的人群中直接传播。\n- 平均有效接触率（基线）：每单位时间 $k$。\n- 每次接触的传播概率：$\\beta$。\n- 平均传染期（基线）：$D$。\n- 基本再生数 ($R_0$)：在没有干预措施的完全易感人群中，单个病例引起的继发感染的平均数量。\n- 干预措施 1（非药物）：接触率降低因子为 $0.70$。\n- 干预措施 2（病例隔离）：传染期降低因子为 $0.75$。\n- 特定日期的有效再生数：$R_{\\text{e}} = 0.91$。\n- 免疫机制：降低被接触者被感染的概率。\n- 人群平均剩余易感比例 ($S_{\\text{eff}}$)：随机接触一个个体时，该个体是易感的平均概率。\n- 核心假设：预期的继发感染数与接触率、每次接触的传播概率、传染期以及接触者中易感者的比例成线性关系。\n- 要求计算：使用 $R_{0} = 3.8$、干预因子 $0.70$ 和 $0.75$ 以及 $R_{\\text{e}} = 0.91$ 计算 $S_{\\text{eff}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题基于流行病学中仓室模型的基本概念，这是一个标准且成熟的科学领域。基本再生数 ($R_0$) 和有效再生数 ($R_{\\text{e}}$) 的定义是常规的。继发感染数呈线性扩展的假设是这些模型的基石。所提供的参数（$R_0$、$R_e$、降低因子）对于传染病是符合实际的。问题是自洽的，为得出唯一解提供了所有必要的数据和定义。术语精确、客观。没有科学缺陷、矛盾或含糊之处。\n\n### 步骤 3：结论与行动\n问题有效。将制定一个合理的解决方案。\n\n### 解题推导\n该问题要求推导基本再生数 ($R_0$)、有效再生数 ($R_{\\text{e}}$)、干预效果和人群易感性之间的关系，然后利用此关系计算人群平均剩余易感比例 $S_{\\text{eff}}$。\n\n首先，我们形式化基本再生数 $R_0$ 的定义。根据问题陈述，$R_0$ 是在没有干预措施的完全易感人群中，继发感染的平均数量。据称，它与接触率、传播概率和传染期成线性关系。对于一个完全易感的人群，易感个体的比例是 $1$。\n\n设基线参数为：\n- 平均接触率：$k$\n- 每次接触的传播概率：$\\beta$\n- 平均传染期：$D$\n\n因此，基本再生数可以表示为这些量的乘积：\n$$R_0 = k \\cdot \\beta \\cdot D$$\n此表达式表示在实施任何控制措施之前，在一个完全易感的人群中，由单个感染者产生的平均新感染数。\n\n接下来，我们构建有效再生数 $R_{\\text{e}}$ 的表达式。$R_{\\text{e}}$ 考虑了干预措施和现有群体免疫水平的影响。\n\n问题描述了两种干预措施：\n$1$. 非药物干预措施将接触率降低了因子 $c_1 = 0.70$。新的接触率为 $c_1 k$。\n$2$. 病例隔离将传染期降低了因子 $c_2 = 0.75$。新的传染期为 $c_2 D$。\n\n问题还定义了人群平均剩余易感比例 $S_{\\text{eff}}$，它代表人群中仍然易受感染的比例。这个因素修正了可能导致新感染的有效接触次数。\n\n使用相同的线性比例原则，有效再生数 $R_{\\text{e}}$ 是修正后参数的乘积：\n$$R_{\\text{e}} = (\\text{新接触率}) \\cdot (\\text{传播概率}) \\cdot (\\text{新传染期}) \\cdot (\\text{易感比例})$$\n代入修正后参数的表达式，我们得到：\n$$R_{\\text{e}} = (c_1 k) \\cdot \\beta \\cdot (c_2 D) \\cdot S_{\\text{eff}}$$\n我们可以重新排列这个方程，将基线参数组合在一起：\n$$R_{\\text{e}} = c_1 c_2 (k \\beta D) S_{\\text{eff}}$$\n认识到项 $(k \\beta D)$ 是 $R_0$ 的定义，我们可以将其代入方程中：\n$$R_{\\text{e}} = c_1 c_2 R_0 S_{\\text{eff}}$$\n这就是联系 $R_{\\text{e}}$、$R_0$、干预缩放因子 $c_1$ 和 $c_2$ 以及有效易感性 $S_{\\text{eff}}$ 的所需表达式。\n\n现在，我们必须求解 $S_{\\text{eff}}$ 并计算其值。重新整理推导出的公式可得：\n$$S_{\\text{eff}} = \\frac{R_{\\text{e}}}{c_1 c_2 R_0}$$\n我们已知以下数值：\n- $R_{\\text{e}} = 0.91$\n- $R_0 = 3.8$\n- $c_1 = 0.70$\n- $c_2 = 0.75$\n\n将这些值代入 $S_{\\text{eff}}$ 的表达式中：\n$$S_{\\text{eff}} = \\frac{0.91}{(0.70)(0.75)(3.8)}$$\n首先，我们计算分母中的乘积：\n$$(0.70) \\cdot (0.75) = 0.525$$\n$$(0.525) \\cdot (3.8) = 1.995$$\n现在，我们进行最后的除法：\n$$S_{\\text{eff}} = \\frac{0.91}{1.995}$$\n$$S_{\\text{eff}} \\approx 0.45614035...$$\n问题要求将答案四舍五入到 $4$ 位有效数字。\n$$S_{\\text{eff}} \\approx 0.4561$$\n这个值意味着，在指定日期，疫苗接种和既往感染的综合效应使得该人群的易感性相当于一个完全未接触过病毒的人群的 $45.61\\%$。",
            "answer": "$$\\boxed{0.4561}$$"
        },
        {
            "introduction": "疫苗是控制传染病的核心工具，但不同疫苗赋予免疫力的方式不尽相同。本练习将深入探讨两种截然不同的疫苗作用模型：“全或无”（sterilizing）疫苗为部分接种者提供完全保护，而“渗漏型”（leaky）疫苗则为所有接种者提供部分保护。通过推导并比较这两种疫苗类型达到群体免疫所需的接种覆盖率阈值（$p^{\\star}$），你将对疫苗的具体作用机制如何影响公共卫生策略形成更深刻的理解。",
            "id": "4598125",
            "problem": "一个混合均匀的宿主群体面临一种直接传播的病原体，其基本再生数为 $R_0 = 3$。现有两种疫苗接种策略，在人群中以随机覆盖率 $p$ 实施：\n\n1) 一种全或无杀菌性疫苗：每个接种者有 $e_{\\text{ster}} = 0.70$ 的概率完全免于感染，否则仍然完全易感，并且如果被感染，则具有完全的传染性。\n\n2) 一种渗漏性疫苗：每个接种者的易感性和传染性都有乘性降低。具体来说，易感性降低一个因子 $(1 - \\epsilon_s)$（其中 $\\epsilon_s = 0.50$），并且在发生突破性感染的情况下，传染性降低一个因子 $(1 - \\epsilon_i)$（其中 $\\epsilon_i = 0.30$）。\n\n从第一性原理出发，使用以下基础：\n\n- 基本再生数 $R_0$ 是在完全易感的未接种人群中，下一代算子的主特征值（谱半径）。\n\n- 在均匀混合人群中进行随机接种的情况下，有效再生数 $R_e$ 等于经过适当修正的下一代算子的主特征值，该算子考虑了每种类型的易感比例和每次感染的传染性。\n\n- 在全或无杀菌性疫苗的情况下，人群中有 $p e_{\\text{ster}}$ 的比例是完全免疫的，而其余部分则具有基线的易感性和传染性。\n\n- 在渗漏性疫苗的情况下，所有接种者的易感性都乘性降低了 $(1 - \\epsilon_s)$，而那些被感染的人的传染性则乘以 $(1 - \\epsilon_i)$。\n\n对于每种疫苗，从这些原理出发，推导出由条件 $R_e(p^{\\star}) = 1$ 隐式定义的群体免疫覆盖阈值 $p^{\\star}$ 的表达式。然后，根据上面给出的参数，计算比率 $p^{\\star}_{\\text{leaky}} / p^{\\star}_{\\text{ster}}$。将您的最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "用户想要找出两种不同疫苗类型的群体免疫阈值 $p^{\\star}$，然后计算这些阈值的比率。群体免疫阈值定义为使有效再生数 $R_e$ 等于 $1$ 时的疫苗覆盖率 $p$。\n\n首先，我们分析**全或无杀菌性疫苗**。\n这种疫苗为一部分比例为 $e_{\\text{ster}}$ 的接种者提供完全保护。在人群疫苗覆盖率为 $p$ 时，总人口中有 $p \\cdot e_{\\text{ster}}$ 的比例变得完全免疫，并从易感人群库中移除。剩下比例为 $1 - p e_{\\text{ster}}$ 的人群仍然完全易感。\n\n基本再生数 $R_0$ 是指在完全易感的人群中，一个感染者引起的平均二次感染数。在部分易感的人群中，有效再生数 $R_e$ 是 $R_0$ 乘以易感人群所占的比例。\n$$R_e(p) = R_0 (1 - p e_{\\text{ster}})$$\n群体免疫阈值 $p^{\\star}_{\\text{ster}}$ 是指使 $R_e(p^{\\star}_{\\text{ster}}) = 1$ 成立的覆盖率。\n$$1 = R_0 (1 - p^{\\star}_{\\text{ster}} e_{\\text{ster}})$$\n求解 $p^{\\star}_{\\text{ster}}$：\n$$\\frac{1}{R_0} = 1 - p^{\\star}_{\\text{ster}} e_{\\text{ster}}$$\n$$p^{\\star}_{\\text{ster}} e_{\\text{ster}} = 1 - \\frac{1}{R_0}$$\n$$p^{\\star}_{\\text{ster}} = \\frac{1 - \\frac{1}{R_0}}{e_{\\text{ster}}}$$\n\n接下来，我们分析**渗漏性疫苗**。\n这种疫苗使易感性降低一个因子 $(1 - \\epsilon_s)$，并且对于突破性感染，传染性降低一个因子 $(1 - \\epsilon_i)$。我们遵循指令，使用下一代算子形式体系。我们将人群分层为两个组：未接种组（U）和接种组（V）。这些组在人群中所占的比例分别为 $(1-p)$ 和 $p$。\n\n设 $K$ 为下一代矩阵，其中 $K_{ij}$ 是由 $j$ 组中的单个感染者在 $i$ 组中产生的预期二次感染数，其中 $i,j \\in \\{U, V\\}$。矩阵元素与 $R_0$、来源类型的传染性、目标类型的易感性以及目标类型在人群中的比例成正比。\n\n相对易感性为 $\\sigma_U = 1$ 和 $\\sigma_V = 1 - \\epsilon_s$。\n相对传染性值为 $\\tau_U = 1$ 和 $\\tau_V = 1 - \\epsilon_i$。\n\n矩阵元素如下：\n$K_{UU}$：来自未接种的来源到未接种的目标的感染。\n$$K_{UU} = R_0 \\cdot \\tau_U \\cdot \\sigma_U \\cdot (1-p) = R_0 (1-p)$$\n$K_{VU}$：来自未接种的来源到接种的目标的感染。\n$$K_{VU} = R_0 \\cdot \\tau_U \\cdot \\sigma_V \\cdot p = R_0 (1 - \\epsilon_s) p$$\n$K_{UV}$：来自接种的来源到未接种的目标的感染。\n$$K_{UV} = R_0 \\cdot \\tau_V \\cdot \\sigma_U \\cdot (1-p) = R_0 (1 - \\epsilon_i) (1-p)$$\n$K_{VV}$：来自接种的来源到接种的目标的感染。\n$$K_{VV} = R_0 \\cdot \\tau_V \\cdot \\sigma_V \\cdot p = R_0 (1 - \\epsilon_i) (1 - \\epsilon_s) p$$\n\n下一代矩阵是：\n$$K = \\begin{pmatrix} K_{UU} & K_{UV} \\\\ K_{VU} & K_{VV} \\end{pmatrix} = R_0 \\begin{pmatrix} 1-p & (1-\\epsilon_i)(1-p) \\\\ p(1-\\epsilon_s) & p(1-\\epsilon_s)(1-\\epsilon_i) \\end{pmatrix}$$\n这是一个秩为1的矩阵，因为第二列是第一列的 $(1-\\epsilon_i)$ 倍。它可以写成两个向量的外积：\n$$K = R_0 \\begin{pmatrix} 1-p \\\\ p(1-\\epsilon_s) \\end{pmatrix} \\begin{pmatrix} 1 & 1-\\epsilon_i \\end{pmatrix}$$\n这样一个矩阵 $\\mathbf{u}\\mathbf{v}^T$ 的主特征值（谱半径）是 $\\mathbf{v}^T\\mathbf{u}$。因此，$R_e(p)$ 是：\n$$R_e(p) = R_0 \\left( \\begin{pmatrix} 1 & 1-\\epsilon_i \\end{pmatrix} \\begin{pmatrix} 1-p \\\\ p(1-\\epsilon_s) \\end{pmatrix} \\right)$$\n$$R_e(p) = R_0 [1 \\cdot (1-p) + (1-\\epsilon_i) \\cdot p(1-\\epsilon_s)]$$\n$$R_e(p) = R_0 [ (1-p) + p(1-\\epsilon_s)(1-\\epsilon_i) ]$$\n为了找到群体免疫阈值 $p^{\\star}_{\\text{leaky}}$，我们设 $R_e(p^{\\star}_{\\text{leaky}}) = 1$：\n$$1 = R_0 [ (1-p^{\\star}_{\\text{leaky}}) + p^{\\star}_{\\text{leaky}}(1-\\epsilon_s)(1-\\epsilon_i) ]$$\n$$\\frac{1}{R_0} = 1 - p^{\\star}_{\\text{leaky}} + p^{\\star}_{\\text{leaky}}(1-\\epsilon_s-\\epsilon_i+\\epsilon_s\\epsilon_i)$$\n$$\\frac{1}{R_0} = 1 - p^{\\star}_{\\text{leaky}}[1 - (1-\\epsilon_s)(1-\\epsilon_i)]$$\n$$p^{\\star}_{\\text{leaky}}[1 - (1-\\epsilon_s)(1-\\epsilon_i)] = 1 - \\frac{1}{R_0}$$\n$$p^{\\star}_{\\text{leaky}} = \\frac{1 - \\frac{1}{R_0}}{1 - (1-\\epsilon_s)(1-\\epsilon_i)}$$\n\n最后，我们计算比率 $p^{\\star}_{\\text{leaky}} / p^{\\star}_{\\text{ster}}$。\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{\\frac{1 - 1/R_0}{1 - (1-\\epsilon_s)(1-\\epsilon_i)}}{\\frac{1 - 1/R_0}{e_{\\text{ster}}}}$$\n项 $(1 - 1/R_0)$ 被消去，得到：\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{e_{\\text{ster}}}{1 - (1-\\epsilon_s)(1-\\epsilon_i)}$$\n现在，我们代入给定的数值：$e_{\\text{ster}} = 0.70$，$\\epsilon_s = 0.50$ 和 $\\epsilon_i = 0.30$。\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{0.70}{1 - (1-0.50)(1-0.30)}$$\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{0.70}{1 - (0.50)(0.70)}$$\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{0.70}{1 - 0.35}$$\n$$\\frac{p^{\\star}_{\\text{leaky}}}{p^{\\star}_{\\text{ster}}} = \\frac{0.70}{0.65} = \\frac{70}{65} = \\frac{14}{13}$$\n作为小数，这是 $14 \\div 13 \\approx 1.076923...$。\n四舍五入到四位有效数字，结果是 $1.077$。",
            "answer": "$$\\boxed{1.077}$$"
        },
        {
            "introduction": "当流行病学模型与可观测数据相结合时，其威力才能最大化。在疫情爆发初期，最关键的数据之一便是疫情的指数增长率。本项计算练习将指导你如何利用增长率和代际间隔（generation interval）分布来估算基础再生数（$R_0$）。然后，你将应用估算出的$R_0$来计算实现群体免疫所需的疫苗接种覆盖率，从而搭建起从理论动态到可执行的公共卫生目标之间的桥梁。",
            "id": "4598127",
            "problem": "一个种群正在经历传染病暴发的早期阶段，其发病率呈指数增长。基本再生数 $R_0$ 定义为一个典型的感染者被引入一个完全易感的种群后，所产生的二代感染的期望数量。设 $g(a)$ 表示代间距概率密度函数，其中 $a$ 是自感染以来的时间。发病率 $I(t)$ 服从更新方程 $I(t) = R_0 \\int_0^\\infty I(t-a) g(a)\\, da$。在早期阶段，假设 $I(t)$ 以马尔萨斯增长率 $r$呈指数增长，因此 $I(t) = I_0 e^{r t}$，其中 $I_0 > 0$。假设 $g(a)$ 是一个伽马分布，其形状参数为 $k > 0$，均值为 $\\bar{g} > 0$（因此尺度参数为 $\\theta = \\bar{g}/k$）。此外，考虑一种疫苗，其效力为 $e \\in (0,1]$，在均匀混合的假设下以覆盖率 $v \\in [0,1]$ 进行接种。效力 $e$ 被解释为“全或无”模式：接种者中有比例为 $e$ 的人获得完全免疫，而其余人则保持完全易感。接种后的有效再生数为 $R_v$。\n\n任务：\n1) 从更新方程和指数增长假设出发，推导 $R_0$ 关于 $r$ 和 $g(a)$ 的表达式。\n2) 将模型特化为伽马代间距模型，并获得 $R_0$ 关于 $r$、$k$ 和 $\\bar{g}$ 的闭式解。\n3) 使用均匀混合和“全或无”疫苗模型，推导确保 $R_v \\le 1$ 所需的最小覆盖率 $v$（记为 $H^\\star$）。如果推导出的值为负，则设 $H^\\star = 0$。如果超过 1，则设 $H^\\star = 1$。如果 $R_0 \\le 1$，则设 $H^\\star = 0$。\n4) 实现一个程序，对下面的每个测试用例，使用您推导出的公式计算数对 $[R_0, H^\\star]$。\n\n单位和数值格式：\n- $r$ 的单位是“每天”，$\\bar{g}$ 的单位是“天”。输出 $R_0$ 和 $H^\\star$ 是无量纲的。\n- 所有输出均表示为小数点后六位的小数。$H^\\star$ 不使用百分号；它必须是一个小数。\n\n重要技术条件：\n- 假设参数满足 $r > -1/\\theta$，以确保所有积分都是有限的。\n\n测试集（每个元组为 $(r, \\bar{g}, k, e)$）：\n- 案例 1：$(0.1, 5, 2, 0.9)$\n- 案例 2：$(0.0, 4, 3, 0.95)$\n- 案例 3：$(-0.05, 5, 2, 0.8)$\n- 案例 4：$(0.2, 5, 1, 0.8)$\n- 案例 5：$(0.1, 5, 10, 0.95)$\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个列表项是对应一个测试用例的双元素列表。例如：$[[R_{0,1},H^\\star_1],[R_{0,2},H^\\star_2],\\dots]$。\n- 打印的行中不得有任何空格。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、良定且客观的。这是一个数学流行病学中的标准问题。\n\n解决方案按问题陈述的要求分为四个部分呈现。\n\n### 1. 推导 $R_0$ 关于 $r$ 和 $g(a)$ 的表达式\n\n出发点是传染病发病率 $I(t)$ 的更新方程：\n$$ I(t) = R_0 \\int_0^\\infty I(t-a) g(a)\\, da $$\n此处，$R_0$ 是基本再生数，$g(a)$ 是代间距的概率密度函数，其中 $a$ 是自感染以来的时间。\n\n在流行病暴发的早期阶段，假设发病率呈指数增长。这由以下拟设表示：\n$$ I(t) = I_0 e^{r t} $$\n其中 $I_0 > 0$ 是 $t=0$ 时的初始发病率，$r$ 是马尔萨斯增长率。\n\n将 $I(t)$ 的指数增长形式代入更新方程，得到：\n$$ I_0 e^{r t} = R_0 \\int_0^\\infty \\left(I_0 e^{r(t-a)}\\right) g(a)\\, da $$\n我们可以将不依赖于积分变量 $a$ 的项提取出来：\n$$ I_0 e^{r t} = R_0 I_0 e^{r t} \\int_0^\\infty e^{-r a} g(a)\\, da $$\n由于 $I_0 > 0$ 且 $e^{rt}$ 恒为正，我们可以将方程两边同除以 $I_0 e^{rt}$：\n$$ 1 = R_0 \\int_0^\\infty e^{-r a} g(a)\\, da $$\n该积分项是随机变量 $A$（表示代间距，其概率密度函数为 $g(a)$）的矩生成函数 (MGF) 在点 $-r$ 处的值。我们将 MGF 记为 $M_A(s) = \\mathbb{E}[e^{sA}]$。方程变为：\n$$ 1 = R_0 M_A(-r) $$\n解出 $R_0$ 即可得到被称为洛特卡-欧拉方程的表达式：\n$$ R_0 = \\frac{1}{M_A(-r)} = \\frac{1}{\\int_0^\\infty e^{-r a} g(a)\\, da} $$\n该表达式将基本再生数 $R_0$ 与流行病增长率 $r$ 和代间距分布 $g(a)$ 联系起来。\n\n### 2. 特化为伽马分布的代间距\n\n给定代间距分布 $g(a)$ 服从伽马分布，其形状参数为 $k > 0$，均值为 $\\bar{g} > 0$。其概率密度函数为：\n$$ g(a; k, \\theta) = \\frac{a^{k-1} e^{-a/\\theta}}{\\Gamma(k) \\theta^k} \\quad \\text{for } a > 0 $$\n其中 $\\Gamma(k)$ 是伽马函数。伽马分布的均值为 $\\bar{g} = k\\theta$，这意味着尺度参数为 $\\theta = \\bar{g}/k$。\n\n服从伽马分布的随机变量 $A$ 的矩生成函数 (MGF) 为：\n$$ M_A(s) = \\mathbb{E}[e^{sA}] = \\int_0^\\infty e^{sa} g(a; k, \\theta) da = \\int_0^\\infty e^{sa} \\frac{a^{k-1} e^{-a/\\theta}}{\\Gamma(k) \\theta^k} da $$\n$$ M_A(s) = \\frac{1}{\\Gamma(k) \\theta^k} \\int_0^\\infty a^{k-1} e^{-(1/\\theta - s)a} da $$\n该积分在 $1/\\theta - s > 0$（即 $s < 1/\\theta$）时收敛。通过进行变量替换 $u = (1/\\theta - s)a$，积分结果为 $\\Gamma(k) / (1/\\theta - s)^k$。因此，MGF 为：\n$$ M_A(s) = \\frac{1}{\\Gamma(k) \\theta^k} \\frac{\\Gamma(k)}{(1/\\theta - s)^k} = \\left(\\frac{1}{\\theta(1/\\theta - s)}\\right)^k = (1 - s\\theta)^{-k} $$\n我们需要计算其在 $s = -r$ 处的值。问题陈述中给出的条件 $r > -1/\\theta$ 等价于 $-r < 1/\\theta$，这确保了 MGF 在该点是良定的。\n$$ M_A(-r) = (1 - (-r)\\theta)^{-k} = (1 + r\\theta)^{-k} $$\n将此结果代入 $R_0$ 的表达式中：\n$$ R_0 = \\frac{1}{(1 + r\\theta)^{-k}} = (1 + r\\theta)^k $$\n最后，将尺度参数 $\\theta$ 替换为 $\\bar{g}/k$：\n$$ R_0 = \\left(1 + r \\frac{\\bar{g}}{k}\\right)^k $$\n这就是伽马分布代间距下 $R_0$ 的闭式表达式。\n\n### 3. 最小疫苗覆盖率 $H^\\star$ 的推导\n\n我们考虑一个具有均匀混合特征的“全或无”疫苗模型。一部分比例为 $v$ 的人群接种了效力为 $e$ 的疫苗。在此模型中，一部分比例为 $e$ 的已接种者得到完全保护，免于感染，而剩下比例为 $1-e$ 的已接种者未受保护，其易感性与未接种者相同。\n\n接种并成功免疫的人群比例为 $v \\cdot e$。因此，仍然易受感染的人群总比例为 $S = 1 - v e$。\n\n在均匀混合的假设下，有效再生数 $R_v$ 是基本再生数与易感人群比例的乘积：\n$$ R_v = R_0 \\cdot S = R_0 (1 - ve) $$\n为实现群体免疫，我们需要 $R_v \\le 1$。最小覆盖率，记为 $H^\\star$，是满足此条件的最小 $v$ 值。我们通过设置 $R_v = 1$ 来找到这个临界覆盖率：\n$$ 1 = R_0 (1 - H^\\star e) $$\n解出 $H^\\star$：\n$$ \\frac{1}{R_0} = 1 - H^\\star e $$\n$$ H^\\star e = 1 - \\frac{1}{R_0} $$\n$$ H^\\star = \\frac{1}{e} \\left(1 - \\frac{1}{R_0}\\right) $$\n这个覆盖率的理论值必须遵守问题陈述中给出的物理和流行病学约束：\n- 如果 $R_0 \\le 1$，即使在完全易感的种群中，疾病也无法维持流行。对于群体层面的控制而言，任何疫苗接种努力都是多余的。在这种情况下，我们的公式会给出一个非正值。问题正确地规定了应设 $H^\\star = 0$。\n- 覆盖率 $v$ 是一个比例，必须位于区间 $[0, 1]$ 内。如果计算出的 $H^\\star$ 值大于 1，这意味着即使 100% 的疫苗覆盖率也不足以实现群体免疫（即将 $R_v$ 降至 1）。在这种情况下，应用最大可能覆盖率，因此我们设 $H^\\star = 1$。\n\n综合这些规则，计算 $H^\\star$ 的算法如下：\n1. 使用第 2 部分的公式计算 $R_0$。\n2. 如果 $R_0 \\le 1$，则设 $H^\\star = 0$。\n3. 如果 $R_0 > 1$，计算临界覆盖率 $v_c = \\frac{1}{e} \\left(1 - \\frac{1}{R_0}\\right)$。\n4. 最终的群体免疫阈值为 $H^\\star = \\min(1, \\max(0, v_c))$。由于当 $R_0 > 1$ 时 $v_c > 0$，这等价于 $H^\\star = \\max(0, \\min(1, v_c))$。\n\n### 4. 计算实现\n\n推导出的公式将用 Python 实现。对于每个测试用例 $(r, \\bar{g}, k, e)$：\n1.  使用浮点运算计算 $R_0 = \\left(1 + r \\frac{\\bar{g}}{k}\\right)^k$。\n2.  基于 $R_0$ 的值计算 $H^\\star$：\n    - 如果 $R_0 \\le 1$，$H^\\star = 0.0$。\n    - 否则，$H^\\star = \\min\\left(1.0, \\frac{1}{e}\\left(1 - \\frac{1}{R_0}\\right)\\right)$。\n3.  存储得到的结果对 $[R_0, H^\\star]$。两个值都四舍五入到小数点后六位作为最终输出。\n4.  处理完所有测试用例后，将结果列表格式化为指定的单个字符串 `[[R0_1,H_1],[R0_2,H_2],...]`，不含空格。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the epidemiology problem for the given test cases.\n\n    This function calculates the basic reproduction number (R0) and the herd\n    immunity threshold (H_star) for a set of disease parameters based on\n    derived epidemiological formulas.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (r, g_bar, k, e).\n    test_cases = [\n        (0.1, 5, 2, 0.9),\n        (0.0, 4, 3, 0.95),\n        (-0.05, 5, 2, 0.8),\n        (0.2, 5, 1, 0.8),\n        (0.1, 5, 10, 0.95),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        r, g_bar, k, e = case\n        \n        # Task 2: Calculate R0 using the derived formula\n        # R0 = (1 + r * g_bar / k) ^ k\n        base = 1 + r * g_bar / k\n        # Ensure base is non-negative, although the problem condition r > -1/theta\n        # already guarantees this. theta = g_bar / k, so r > -k/g_bar, which means\n        # r * g_bar / k > -1, so 1 + r * g_bar / k > 0.\n        r0 = np.power(base, k)\n\n        # Task 3: Calculate H_star based on R0 and vaccine efficacy e\n        h_star = 0.0\n        if r0 > 1:\n            # H_star = (1/e) * (1 - 1/R0)\n            # This is capped at 1, as coverage cannot exceed 100%.\n            h_star_uncapped = (1 / e) * (1 - 1 / r0)\n            h_star = min(1.0, h_star_uncapped)\n\n        # Append the calculated pair [R0, H_star] to the results list\n        results.append([r0, h_star])\n\n    # Final print statement in the exact required format.\n    # Format: [[R0_1,H_1],[R0_2,H_2],...]\n    # Each number is a decimal rounded to six digits. No spaces.\n    case_strings = [f\"[{r0:.6f},{h:.6f}]\" for r0, h in results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}