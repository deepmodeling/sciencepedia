## 引言
[流行曲线](@entry_id:172741)，即按时间顺序绘制的病例分布图，是流行病学家工具箱中最核心、最直观的工具之一。它将看似混乱的病例数据转化为一幅描绘疫情随时间演变的动态画卷，对于理解传播速度、评估干预效果和预测未来趋势至关重要。然而，从原始数据到有意义的洞见，其间充满挑战。一份看似简单的图表背后，隐藏着关于数据选择、统计偏倚和传播动力学的深刻原理。若不经审慎分析，曲线的形态可能误导决策，造成严重后果。本文旨在系统性地拆解[流行曲线](@entry_id:172741)的构建与解读过程，填补从数据到决策的知识鸿沟。

在接下来的内容中，读者将首先通过“原理与机制”章节，深入学习构建曲线的基础——从选择病例定义到理解卷积模型，并掌握识别不同暴发模式和量化增长的核心技巧。随后，“应用与跨学科联系”章节将展示这些原理如何在真实的[暴发调查](@entry_id:138325)和公共卫生监测中发挥作用，如何应对数据不完美带来的挑战，并揭示其与基因组学等前沿领域的交叉。最后，“动手实践”部分将提供具体的计算问题，帮助读者将理论知识转化为可操作的分析技能。通过这一结构化的学习路径，本文将引导您掌握这项流行病学的关键技艺。

## 原理与机制

本章在前一章“引言”的基础上，深入探讨构建和解读[流行曲线](@entry_id:172741)的核心原理与关键机制。[流行曲线](@entry_id:172741)是流行病学调查中一种至关重要的时间[序列图](@entry_id:165947)，它通过将病例数按时间顺序绘制，直观地揭示了疫情的动态变化。精确地构建和科学地解读[流行曲线](@entry_id:172741)，是理解疫情规模、传播模式、评估干预措施效果以及预测未来趋势的基石。本章将从基本概念入手，系统性地阐述如何从原始数据构建曲线，解读其形态所蕴含的流行病学意义，并介绍用于量化分析和校正常见偏倚的高级方法。

### [流行曲线](@entry_id:172741)的基本概念

从根本上说，[流行曲线](@entry_id:172741)是按特定时间单位（如日、周）展示新发病例数的柱状图。构建任何一条有意义的[流行曲线](@entry_id:172741)，首要任务是回答两个基本问题：我们统计的是什么？我们何时统计？这两个问题的答案分别对应着**病例定义（case definition）**和**事件时间（event time）**的选择。

#### 病例定义与事件时间的选择

一个清晰的**病例定义**是[流行曲线](@entry_id:172741)科学性的前提。它规定了哪些个体应被计为病例，通常包含临床标准（如特定症状）、实验室标准（如病原体检测阳性）和流行病学关联（如与已知病例或暴露源的接触史）。一个好的病例定义应兼具高敏感性（尽可能多地识别真实病例）和高特异性（尽可能少地纳入非病例），以确保曲线反映的是目标疫情的真实情况。

在确定了“谁是病例”后，我们必须选择一个**事件时间**来确定每个病例在曲线时间轴上的位置。常见的选项包括症状出现时间（symptom onset）、样本[采集时间](@entry_id:266526)（specimen collection）、实验室报告时间（laboratory report）乃至住院时间（hospitalization date）。这一选择至关重要，因为它直接影响我们对潜在传播动态的推断。

为了理解这一点，我们可以建立一个理论模型。假设疫情的真实发生过程由一个未知的**感染发生率**函数 $I_{\text{infect}}(t)$ 描述，它表示在时间 $t$ 发生的真实新发感染数。我们实际观测到的，是基于某个事件 $E$ 的发生率 $I_{E}(t)$。从感染到事件 $E$ 的发生，存在一个随机的时间延迟，其概率密度函数为 $f_{E}(\tau)$。那么，观测曲[线与](@entry_id:177118)真实感染曲线之间的关系可以通过一个卷积积分来描述 ：
$$
I_{E}(t) = \int_{0}^{\infty} I_{\text{infect}}(t - \tau) f_{E}(\tau) d\tau
$$
这个公式表明，我们观测到的[流行曲线](@entry_id:172741) $I_{E}(t)$ 是真实感染曲线 $I_{\text{infect}}(t)$ 经过延迟分布 $f_{E}(\tau)$ “平滑”和“延迟”后的结果。为了从观测数据中有效推断传播参数（如增长率 $r$ 和有效再生数 $R_t$），我们希望选择一个事件 $E$，使得其延迟分布 $f_{E}(\tau)$ 尽可能短、变异尽可能小，并且最重要的是——**稳定**（不随时间变化）。

在多个备选事件时间中，**症状出现时间**通常是最佳选择。其对应的延迟是从感染到出现症状的时间，即**潜伏期（incubation period）**。潜伏期是一个由病原体和宿主相互作用决定的生物学参数，对于特定疾病而言，其分布相对稳定，不会因医疗系统负荷、公众行为或检测能力的变化而剧烈波动。相比之下，其他事件时间，如样本采集、报告或住院，其延迟包含了许多不稳定因素：从出现症状到决定就医的时间、从就医到获得检测的机会、实验室处理样本的时间以及入院决策流程等。这些延迟受社会行为和卫生系统运行状况的严重影响，在疫情期间会发生显著变化，从而扭曲[流行曲线](@entry_id:172741)的形态，使推断真实感染动态变得异常困难 。

我们可以从一个更严谨的角度来论证为何选择延迟最短、最稳定的事件时间。假设我们希望一个事件时间能最好地“对齐”未知的感染时间，一个合理的标准是最小化两者之间延迟 $D$ 的**均方误差（Mean Squared Error, MSE）**。MSE 定义为 $M = E[D^2]$，根据统计学原理，它可以分解为延迟均值的平方加上延迟的方差：$M = (E[D])^2 + \text{Var}(D) = \mu_D^2 + \sigma_D^2$。这个标准同时惩罚了系统性延迟（$\mu_D$）和不确定性（$\sigma_D^2$）。

考虑从感染到各事件的总延迟：
- 症状出现：延迟为潜伏期 $I$。
- 样本采集：延迟为 $I+T$（其中 $T$ 是从出现症状到检测的延迟）。
- 实验室报告：延迟为 $I+T+P$（其中 $P$ 是从检测到报告的延迟）。

由于潜伏期 $I$ 是所有这些事件延迟的共同且不可避免的组成部分，而后续的延迟（如 $T$ 和 $P$）都是非负的随机变量，它们的加入必然会增加总延迟的均值和方差。因此，任何包含额[外延](@entry_id:161930)迟环节的事件，其MS[E值](@entry_id:177316)必定高于仅有潜伏期的症状出现事件。这为选择症状出现时间作为感染时间的最佳代理（proxy）提供了坚实的理论依据 。

### [流行曲线](@entry_id:172741)的构建

确定了病例定义和事件时间后，下一步就是根据收集到的病例数据实际绘制[流行曲线](@entry_id:172741)。这本质上是一个将连续或离散的病例时间数据进行“分箱”（binning）并可视化的过程。

#### [数据分箱](@entry_id:264748)与时间单位的选择

假设我们有一组病例的症状出现时间戳 $\{t_1, t_2, \dots, t_n\}$。为了构建[流行曲线](@entry_id:172741)，我们需要将时间轴划分为一系列连续且不重叠的区间，即“时间箱”，例如，以天或周为单位。对于任意一个时间箱 $[a, b)$，落入其中的病例数 $C_{[a,b)}$ 可以通过对所有病例进行计数得到。使用[指示函数](@entry_id:186820) $\mathbf{1}\{\cdot\}$（当条件为真时取值为1，否则为0），这个[计数过程](@entry_id:260664)可以被精确地表达为 ：
$$
C_{[a,b)} = \sum_{i=1}^{n} \mathbf{1}\{a \le t_i  b\}
$$
时间箱宽度的选择会影响曲线的视觉外观。较窄的时间箱能揭示更多细节，但也可能因随机波动而产生过多“噪音”；较宽的时间箱能平滑曲线，但也可能掩盖重要的短期变化。

一个特别需要注意的问题是**不等宽时间箱**的使用。在某些情况下，例如为了在疫情初期（病例稀疏）和高峰期（病例密集）都获得稳定的估计，研究者可能会采用不等宽的划分。然而，如果直接用每个箱内的原始病例数作为柱状图的高度，将产生严重的视觉误导。

例如，考虑一个假设的疫情，其病例出现时间戳为 $\{0.2, 0.4, 0.9, 1.1, 1.2, 1.9, \dots\}$。若采用不等宽[分箱](@entry_id:264748)方案：$[0, 1.5)$, $[1.5, 2.5)$, $[2.5, 3.5)$, $[3.5, 5.0)$。计算后得到的原始病例数可能为 $[5, 4, 5, 4]$。如果直接绘制，我们会看到两个同样高度的“高峰”，分别在第一个和第三个时间箱，这似乎暗示疫情有两个强度相似的爆发波次。

然而，这种解读是错误的。第一个“高峰”代表在 $1.5$ 天内出现了 $5$ 个病例，而第三个“高峰”则是在 $1.0$ 天内出现了 $5$ 个病例。显然，第三个时间段内的发病速度更快。为了进行公正的比较，我们必须将原始病例数除以其对应时间箱的宽度，得到**发病密度（incidence density）**，即单位时间内的平均发病数。在这个例子中，发病密度向量近似为 $[3.33, 4.00, 5.00, 2.67]$（单位：病例/天）。以发病密度作为柱状图的高度，我们就能清楚地看到一个位于 $[2.5, 3.5)$ 区间的单一主导高峰。

这揭示了[直方图](@entry_id:178776)的一个基本原则：当分箱不等宽时，柱状图的**面积**（正比于病例数）而非高度（原始病例数）才是传达信息的准确量度。通过将高度设为发病密度，我们确保了每个柱的面积等于其代表的病例数，从而使不同宽度的柱子具有了可比性 。

### [流行曲线](@entry_id:172741)的解读

构建好[流行曲线](@entry_id:172741)后，下一步就是从中提取有价值的流行病学信息。解读可以从宏观的比较和形态的识别，深入到微观的时间参数分析。

#### 计数与率：分母的重要性

[流行曲线](@entry_id:172741)直接展示的病例**计数（counts）**，反映了疫情的绝对规模，对于卫生资源规划（如床位数、药品储备）至关重要。然而，当需要在不同规模的人群间比较疫情的严重程度时，仅比较病例数可能会产生误导。一个人口众多的城市，即使其人均感染风险较低，其病例总数也可能远超一个人口稀少但疫情肆虐的城镇 。

为了克服人口规模的混杂效应，流行病学使用**率（rates）**作为标准化的比较指标。**累积发病率（cumulative incidence）**，也常被称为罹患率（attack rate），其定义为：
$$
CI = \frac{\text{特定时期内的新发病例数}}{\text{该时期开始时的风险人口数}}
$$
通过将病例数除以风险人口[基数](@entry_id:754020)，发病率代表了人群中个体的平均发病风险，从而实现了在不同人群间的公平比较。

此外，疾病风险往往随年龄变化，而不同地区的人口年龄结构可能存在巨大差异。例如，一个老龄化社区的粗发病率（crude rate）可能因为老年人易感而偏高。为了消除[年龄结构](@entry_id:197671)差异带来的混淆，流行病学家采用**年龄标化（age-standardization）**方法。直接标化法通过计算在同一个“标准人口”结构下，各地区预期会发生的病例数，来得到一个可比的标化率。

例如，要计算A城在两周内的年龄标化累积发病率，我们首先计算其各年龄组（如0-19岁，20-64岁，65+岁）的特异性发病率 ($CI_i = \frac{c_i}{N_i}$)。然后，将这些率应用于一个预设的标准[人口结构](@entry_id:148599) ($N_{std,i}$)，计算出在标准人口中各年龄组的预期病例数 ($E_i = CI_i \times N_{std,i}$)。将所有年龄组的预期病例数相加得到总预期病例数 $E_{total}$，再除以标准人口总数 $N_{std,total}$，就得到了年龄标化发病率。这个标化率反映了“如果A城拥有与标准人口相同的[年龄结构](@entry_id:197671)，其发病风险会是多少”，从而可以与其他同样方法标化后的地区进行更公允的比较 。

#### 从曲线形态识别暴发模式

[流行曲线](@entry_id:172741)的整体形态是其最有价值的特征之一，它能有力地揭示疫情的传播源和传播方式。根据曲线的形状，暴发通常可分为以下几类 ：

*   **点源暴发（Point-source outbreak）**：曲线呈现一个单一、陡峭的高峰，随后快速下降。大多数病例的症状出现在一个相对集中的时间范围内。
    *   **机制**：所有病例在极短时间内（如一次聚餐）暴露于同一个污染源。[流行曲线](@entry_id:172741)的形状近似于该疾病**潜伏期分布**的镜像。暴露时间点 $E(t)$ 集中于一点，因此病例出现曲线 $C(t)$ 是潜伏期分布 $f_I(t)$ 的一个平移和缩放版本。

*   **持续共同源暴发（Continuous common-source outbreak）**：曲线迅速上升后，进入一个持续较长时间的“平台期”，在污染源被清除后才逐渐下降。
    *   **机制**：人群在一段较长时期内（如数天或数周）持续暴露于同一污染源（如受污染的市政供水）。只要暴露持续存在，新病例就会不断出现，形成平台。

*   **传播性暴发（Propagated outbreak）**：曲线呈现一系列连续的波峰，且波峰通常越来越高（在疫情初期），每个波峰之间有一定的时间间隔。
    *   **机制**：疾病通过人传人方式进行传播。第一批病例（第一代）感染并传给第二批病例（第二代），如此循环往复，形成连续的传播链。曲线上的每个波峰对应着一代新的病例。

*   **混合型暴发（Mixed outbreak）**：曲线在初期呈现一个典型的[点源](@entry_id:196698)暴发高峰，随后出现类似传播性暴发的次级波峰。
    *   **机制**：疫情由一个共同源暴露事件引发（如某次集会上的受污染食物），导致第一批病例集中出现。随后，这些首发病例通过人际接触，将疾病传播给其他人，开启了人传人模式。

#### 关键时间间隔及其作用

要准确理解，特别是传播性暴发的曲线形态，必须区分几个关键的时间间隔概念 ：

*   **潜伏期（Incubation Period, IP）**：从个体感染病原体到出现临床症状的时间。它决定了从**感染曲线**到我们观测的**症状出现曲线**之间的时间延迟和形态平滑程度，但它本身**不决定**传播性暴发中各波峰之间的间隔。

*   **代际间隔（Generation Interval, GI）**：从感染者被感染到其感染下一代病例的时间。这是描述传播过程内在节奏的根本参数。在传播模型中，新一代感染的发生是由上一代感染经过一个代际间隔分布的延迟后产生的。

*   **[系列间隔](@entry_id:191568)（Serial Interval, SI）**：从一个确诊病例（感染者）出现症状到由其感染的下一个确诊病例（被感染者）出现症状的时间。由于感染时间通常难以观测，而症状出现时间相对容易确定，因此[系列间隔](@entry_id:191568)是代际间隔的一个可观测的替代指标。

在解读传播性暴发的[流行曲线](@entry_id:172741)时，一个核心要点是：**曲线各波峰之间的间隔约等于平均[系列间隔](@entry_id:191568)（或代际间隔），而不是平均潜伏期**  。每一波高峰代表新一代病例的集中出现，其发生时间取决于上一代病例何时将病毒传播出去，这正是由代际/[系列间隔](@entry_id:191568)所描述的。

值得注意的是，在存在显著的**症状前传播**（即患者在出现症状前就已具有传染性）的疾病中，[系列间隔](@entry_id:191568)可能短于潜伏期，甚至在个别传播对中出现负值（被感染者比感染者更早出现症状）。此外，有效的控制措施，如病例确诊后立即隔离，会截断其在症状出现后的传染期，从而缩短实现的代际间隔和[系列间隔](@entry_id:191568)，导致[流行曲线](@entry_id:172741)上的波峰间隔变短。

### 高级分析与常见偏倚

除了直观的形态解读，[流行曲线](@entry_id:172741)也为更深入的量化分析提供了基础。同时，我们也必须认识到数据收集中存在的系统性偏倚，并学会如何校正它们。

#### 量化增长：对数标尺与增长率

在疫情初期，当人群中易感者充足时，病例数通常呈**指数增长**。其数学模型可以表示为 $I(t) = I_0 \exp(rt)$，其中 $I(t)$ 是时间 $t$ 的病例数，$I_0$ 是初始病例数，$r$ 是指数增长率。

在这种情况下，直接绘制的[流行曲线](@entry_id:172741)会非常陡峭，难以辨别其增长趋势的细微变化。一个强大的分析技巧是将纵坐标转换为**对数标尺（logarithmic scale）**。对指数增长方程两边取自然对数，我们得到 ：
$$
\ln(I(t)) = \ln(I_0) + rt
$$
这个方程是关于时间 $t$ 的一条直线，其**斜率等于指数增长率 $r$**。如果使用以10为底的对数，则：
$$
\log_{10}(I(t)) = \log_{10}(I_0) + \frac{r}{\ln(10)}t
$$
此时，[直线的斜率](@entry_id:165209)等于 $\frac{r}{\ln(10)}$。因此，通过在对数标尺上绘制[流行曲线](@entry_id:172741)并拟合一条直线，我们可以直观地判断疫情是否处于指数增长阶段，并从直线斜率中定量估计出增长率 $r$。例如，如果一个以天为单位的 $\log_{10}$ 流行曲线的斜率为 $0.07817$，那么其指数增长率 $r$ 就可以计算为 $0.07817 \times \ln(10) \approx 0.18$ /天。

#### 估计再生数 $R_t$

**时变再生数（effective reproduction number, $R_t$）**定义为在时间 $t$ 一个典型感染者平均能引起的新发感染人数。它是衡量疫情传播速度的核心指标。Wallinga和Teunis提出了一种从症状出现[流行曲线](@entry_id:172741)和[系列间隔](@entry_id:191568)分布来估计 $R_t$ 的方法。

其核心思想是**概率归因**：对于在 $s$ 时刻出现的任何一个新病例，我们可以根据历史病例数和[系列间隔](@entry_id:191568)分布，反推其由 $t$ 时刻 ($t \lt s$) 的病例传染所致的概率。具体来说，一个在 $s$ 时刻的病例，其感染源来自 $t$ 时刻病例群的相对可能性，正比于 $t$ 时刻的病例数 $I_t$ 与[系列间隔](@entry_id:191568)为 $s-t$ 的概率 $w(s-t)$ 的乘积。通过对所有可能的感染源时刻进行归一化，我们可以计算出在 $s$ 时刻出现的 $I_s$ 个病例中，有多少可以归因于 $t$ 时刻的 $I_t$ 个病例。

将 $t$ 时刻病例在所有未来时刻（$s > t$）产生的所有次代病例数相加，再除以 $I_t$，就得到了 $R_t$ 的估计值。其数学表达式为 ：
$$
R_t = \sum_{s=t+1}^{\infty} \frac{I_s w(s-t)}{\sum_{u=-\infty}^{s-1} I_u w(s-u)}
$$
这个公式将[流行曲线](@entry_id:172741)数据 $\{I_t\}$ 和[系列间隔](@entry_id:191568)分布 $\{w(k)\}$ 联系起来，为实时监测疫情传播强度提供了有力工具。

#### 应对数据不完美：报告延迟与审查

在实际工作中，我们往往无法立即获得按症状出现时间绘制的完美曲线。数据上报系统存在延迟，这给实时监测带来了巨大挑战。

我们已经知道，按症状出现日期的病例数 $O_t$ 和按报告日期的病例数 $R_t$ 之间存在一个卷积关系。设报告延迟（从症状出现到报告的天数）的概率分布为 $f_d(\tau)$，那么预期的报告数是过去所有发病数的加权和 ：
$$
\mathbb{E}[R_t] = \sum_{\tau=0}^{\infty} O_{t-\tau} f_d(\tau)
$$
这意味着报告日期的曲线是发病日期曲线的一个滞后且平滑后的版本。

在实时监测中，这个延迟会导致一个严重的偏倚，称为**右侧审查（right censoring）**或**[右删失](@entry_id:164686)**。假设当前日期是 $t_0$，我们只能拥有截至 $t_0$ 上报的数据。对于一个在近期 $t_{onset}$（例如 $t_0-1$ 或 $t_0$）出现症状的病例，如果其报告延迟较长，那么在 $t_0$ 时刻它还未被报告，因此不会出现在我们当前的数据库中。$t_{onset}$ 越接近当前日期 $t_0$，该病例被观察到的时间窗口就越短，其被报告的概率就越低。

这种系统性的信息缺失导致[流行曲线](@entry_id:172741)的末端（即最近几天）的病例数被严重低估，形成一个**虚假的下降趋势** 。决策者如果误将此伪迹解读为疫情得到控制，将可能做出灾难性的错误判断。

应对这种偏倚的方法之一是**“临近预报”（nowcasting）**。其基本思想是，利用已知的报告延迟分布，对近期的不完整数据进行校正。例如，对于当前日期 $t_0$ 出现的病例，我们观察到的数量仅为那些报告延迟为0天的病例。如果我们知道延迟为0的概率是 $P(D=0)$，那么可以通过将观测数除以这个概率来估计当天的总发病数：
$$
\text{估计总发病数}(t_0) = \frac{\text{观测发病数}(t_0)}{P(D=0)}
$$
例如，假设在 $t_0$ 当天，我们观察到 $40$ 个病例。如果根据历史数据我们知道只有 $20\%$ 的病例会在症状出现的当天被报告，那么我们可以估计当天的真实总病例数约为 $40 / 0.2 = 200$。通过对最近几天的数据进行类似调整，我们能得到一条更接近真实的[流行曲线](@entry_id:172741)，从而避免对疫情趋势的误判 。

需要强调的是，无论是估计 $R_t$ 还是进行临近预报，这些高级方法都依赖于关键假设，例如[系列间隔](@entry_id:191568)或报告延迟的分布是已知的且不随时间变化。此外，在实时估计 $R_t$ 时，由于未来的病例数 $I_s$ 未知，公式中的求和项不完整，这同样会导致对近期 $R_t$ 值的系统性低估，这也是一种右侧审查偏倚 。认识并理解这些原理和固有的局限性，是作为一名流行病学家进行严谨、审慎分析的必备素养。