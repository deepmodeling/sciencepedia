{
    "hands_on_practices": [
        {
            "introduction": "在现实世界的试验中，参与者未能完全遵循指定的治疗方案（即不依从性）是一个普遍存在的挑战。本练习将指导您计算两种关键的效应量：意向性治疗（Intention-to-Treat, ITT）效应，它衡量了*分配*治疗方案的平均效果；以及依从者平均因果效应（Complier Average Causal Effect, CACE），它估计了在那些实际*遵守*了治疗方案的个体中的效果。通过这项实践 ，您将能清晰地区分一项干预措施在现实世界中的项目有效性（pragmatic effectiveness）与其在理想依从情况下的生物学效能（efficacy）。",
            "id": "4639879",
            "problem": "一个公共卫生团队进行了一项双臂随机对照试验 (RCT)，以评估一项旨在减少二元不良结局的行为干预，其中分组是随机的，但存在不完全依从性。令 $Z \\in \\{0,1\\}$ 表示随机分配到干预组 ($Z=1$) 或对照组 ($Z=0$)，令 $A \\in \\{0,1\\}$ 表示实际接受干预的情况，令 $Y \\in \\{0,1\\}$ 表示结局指标。假设随机化确保了 $Z$ 与所有潜在结局和处理的独立性，且测量是无偏的。观察到的接受干预概率为 $P(A=1 \\mid Z=1)=0.80$ 和 $P(A=1 \\mid Z=0)=0.10$。按分组观察到的平均结局为 $\\bar{Y}_{Z=1}=0.30$ 和 $\\bar{Y}_{Z=0}=0.40$，其中 $\\bar{Y}_{Z=z}$ 表示在分组为 $Z=z$ 的人群中 $Y$ 的均值。\n\n仅使用意向性治疗 (ITT) 效应和依从者平均因果效应 (CACE) 的核心定义，以及适用于随机试验中鼓励性设计的标准工具变量假设（$Z$ 的独立性、排他性限制、单调性以及非零的第一阶段），计算 ITT 效应和 CACE。然后，从存在不依从性的随机试验的优点和局限性方面解释这两个量。请精确地表达您的数值结果，无需四舍五入。您的最终数值答案必须按顺序包含 ITT 效应和 CACE。",
            "solution": "该问题陈述有效。这是一个在流行病学和因果推断领域中的适定问题，它基于既定的科学原理，并使用清晰、客观的语言。它为获得唯一解提供了所有必要的数据和假设，没有任何内部矛盾或对伪科学的依赖。\n\n该问题要求计算和解释在一个存在不完全依从性的随机对照试验 (RCT) 中的两个关键因果估计量：意向性治疗 (ITT) 效应和依从者平均因果效应 (CACE)。\n\n让我们按照题中给出的定义来定义变量：\n- $Z \\in \\{0,1\\}$：随机分组，其中 $Z=1$ 是分配到干预组，$Z=0$ 是分配到对照组。\n- $A \\in \\{0,1\\}$：实际接受干预的情况，其中 $A=1$ 表示接受，$A=0$ 表示未接受。\n- $Y \\in \\{0,1\\}$：二元结局指标，其中 $Y=1$ 可以表示不良事件的发生，$Y=0$ 表示未发生。\n\n提供的数据如下：\n- 干预组中接受治疗的概率：$P(A=1 \\mid Z=1) = 0.80$。由于 $A$ 是二元的，这等价于期望 $E[A \\mid Z=1] = 0.80$。\n- 对照组中接受治疗的概率：$P(A=1 \\mid Z=0) = 0.10$。这等价于期望 $E[A \\mid Z=0] = 0.10$。\n- 干预组的平均结局：$\\bar{Y}_{Z=1} = E[Y \\mid Z=1] = 0.30$。\n- 对照组的平均结局：$\\bar{Y}_{Z=0} = E[Y \\mid Z=0] = 0.40$。\n\n**1. 意向性治疗 (ITT) 效应的计算**\n\nITT 效应被定义为治疗*分配*对结局的影响，无论实际接受何种治疗。它的计算方法是分配到干预组的人群与分配到对照组的人群之间平均结局的差异。\n\n$$\n\\text{ITT} = E[Y \\mid Z=1] - E[Y \\mid Z=0]\n$$\n\n使用所提供的数据：\n\n$$\n\\text{ITT} = 0.30 - 0.40 = -0.10\n$$\n\n这可以表示为精确分数：$\\text{ITT} = -\\frac{1}{10}$。\n\n**2. 依从者平均因果效应 (CACE) 的计算**\n\nCACE 是在被称为“依从者”的个体子群体中治疗的平均因果效应。在问题陈述中提供的标准工具变量 (IV) 假设（独立性、排他性限制、单调性和非零的第一阶段）下，CACE 可以使用 Wald 估计量进行估计。该估计量是结局 ($Y$) 上的 ITT 效应与接受治疗情况 ($A$) 上的 ITT 效应之比。\n\nCACE 的公式为：\n\n$$\n\\text{CACE} = \\frac{E[Y \\mid Z=1] - E[Y \\mid Z=0]}{E[A \\mid Z=1] - E[A \\mid Z=0]}\n$$\n\n分子是 ITT 效应，我们已经计算出其值为 $-0.10$。分母代表干预组和对照组之间接受治疗的个体比例的差异。这通常被称为“第一阶段”效应，它量化了鼓励措施 ($Z$) 在改变行为 ($A$) 方面的成功程度。\n\n让我们计算分母：\n\n$$\nE[A \\mid Z=1] - E[A \\mid Z=0] = P(A=1 \\mid Z=1) - P(A=1 \\mid Z=0) = 0.80 - 0.10 = 0.70\n$$\n\n“非零第一阶段”的假设得到满足，因为 $0.70 \\neq 0$。\n\n现在，我们可以计算 CACE：\n\n$$\n\\text{CACE} = \\frac{-0.10}{0.70} = \\frac{-1/10}{7/10} = -\\frac{1}{7}\n$$\n\n**3. 结果解释**\n\n该问题还要求在存在不依从性的随机对照试验的优点和局限性背景下解释这些量。\n\n- **ITT 效应解释**：ITT 效应为 $-0.10$。这意味着，作为一项政策，将个体*分配*到干预组，与将其分配到对照组相比，平均可使其发生不良结局的概率降低 $10$ 个百分点。ITT 估计的一个关键**优点**是它不受混杂因素的偏倚影响。因为它基于初始的随机分配来比较各组，所以它保持了两组之间所有已测量和未测量的协变量的基线平衡。这使其成为一个高度稳健且具有重要实用价值的估计，用于评估公共卫生项目或政策在现实世界中的有效性。然而，其**局限性**在于它提供了对治疗真实效力的一种稀释或保守的估计。该效应是在依从者和非依从者（干预组中接受和未接受治疗的人）中平均计算的，因此它不代表实际*接受*治疗的效果。\n\n- **CACE 效应解释**：CACE 为 $-\\frac{1}{7} \\approx -0.143$。这意味着对于“依从者”（如果被分配到干预组就会接受干预，如果被分配到对照组就不会接受干预的个体）这一特定子群体，干预*本身*将不良结局的概率降低了约 $14.3$ 个百分点。CACE 的一个**优点**是它对不依从性进行了调整，以提供治疗本身因果效应的估计，这通常具有更大的生物学或机理学意义。这是一个“去污染”的估计，代表了在依从者子群体中的效应会是怎样。CACE 的**局限性**是双重的。首先，它依赖于一些强有力且无法检验的假设，特别是排他性限制（分配仅通过接受治疗来影响结局）和单调性（不存在“违逆者”）。如果这些假设被违反，估计就会有偏。其次，CACE 不是针对全体人群的效应，而仅仅是针对无法观测的依从者子群体的效应。其对其他群体（例如，“始终接受者”或“从不接受者”）或对全体人群的普适性无法保证，这与 ITT 相比，可能会限制其政策相关性。CACE 的效应值（$-0.143$ vs. $-0.10$）比 ITT 效应更强，这是预料之中的，因为 ITT 效应被 $30\\%$ 的不依从性（治疗组中 $20\\%$ 和对照组中 $10\\%$ 的“交叉”者）所稀释。CACE 本质上是通过人群中依从者的比例来重新调整 ITT 效应，该比例由分母 $E[A|Z=1]-E[A|Z=0]=0.70$ 估计得出。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{10}  -\\frac{1}{7} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在某些研究场景中，将整个群体（如诊所或学校）而非个体进行随机化是更可行或更合适的设计，这便构成了整群随机试验（Cluster Randomized Trial, CRT）。本练习  深入探讨了这种设计的统计学后果，特别是群内个体间的相关性（以组内相关系数 $\\rho$ 量化）如何影响统计功效。您将学习如何计算方差扩大因子（Variance Inflation Factor, VIF），并据此调整研究所需的样本量，这是设计一个稳健的整群随机试验的关键技能。",
            "id": "4639876",
            "problem": "计划进行一项双臂平行整群随机试验（CRT）以评估一项公共卫生干预措施。由于在个体随机试验中预期会出现污染，因此将对整群（例如，诊所或学校）进行随机化。每个整群将恰好提供 $m=20$ 名个体，整群内结果之间的相关性由组内相关系数（ICC）量化，定义为 $\\rho$。在可交换相关结构下，ICC是同一整群内两个不同个体之间协方差与单个结果的边际方差之比。假设在个体反应独立的条件下，一项个体随机试验（IRT）为达到给定效应量的指定I类错误和功效，所需的总样本量为 $N=400$。\n\n从组内相关系数的定义以及在相等整群规模的可交换相关结构下样本均值的方差出发，推导由整群引起的方差膨胀因子，然后用它来：\n\n1. 计算在总共招募 $N=400$ 名个体的CRT中（$m=20$ 且 $\\rho=0.05$），所能获得的经整群调整后的有效样本量。\n2. 假设各臂之间的整群和个体分配相等，且整群规模 $m$ 恒定，计算为达到与IRT相同的有效样本量，每臂所需的整群数量。\n\n将两个答案表示为未经四舍五入的精确实数。按顺序以行向量形式提供这两个结果。不需要单位。",
            "solution": "用户提供了一个来自流行病学和生物统计学领域的问题，涉及整群随机试验（CRT）的设计。\n\n### 问题验证\n\n**第1步：提取给定条件**\n-   研究设计：双臂平行整群随机试验（CRT）。\n-   每整群的个体数（整群规模）：$m=20$。\n-   组内相关系数（ICC）：$\\rho$。\n-   ICC的定义：在可交换相关结构下，$\\rho$ 是同一整群内两个不同个体之间协方差与单个结果的边际方差之比。\n-   等效个体随机试验（IRT）的样本量要求：$N=400$。\n-   用于计算的ICC具体值：$\\rho=0.05$。\n-   任务1：计算在总共招募 $N=400$ 名个体的CRT中（$m=20$ 且 $\\rho=0.05$），所能获得的经整群调整后的有效样本量。\n-   任务2：在 $m=20$，$\\rho=0.05$ 且等量分配的条件下，计算为达到与IRT相同的有效样本量（400）每臂所需的整群数量。\n\n**第2步：使用提取的给定条件进行验证**\n-   **科学依据：** 该问题基于整群随机试验（CRT）设计和分析的既定统计原则。ICC、方差膨胀因子（VIF）和有效样本量的概念是标准的并且定义正确。该问题在科学上是合理的。\n-   **适定性：** 该问题是适定的，提供了所有必要的参数（$N$、$m$、$\\rho$）和明确的目标。可以推导出唯一且有意义的解。\n-   **客观性：** 该问题以精确、客观的语言陈述，没有歧义或主观性陈述。\n\n**第3步：结论与行动**\n该问题是有效的。前提在科学上是合理的，数据是一致的，问题是适定的。可以构建一个严谨的解决方案。\n\n### 解题推导\n\n第一步是推导由整群引起的方差膨胀因子（VIF）。设 $Y_{ij}$ 为第 $i$ 个整群中第 $j$ 个个体（其中 $j=1, 2, \\dots, m$）的结果变量。问题陈述了一个可交换的相关结构。设每个结果的边际方差为 $\\text{Var}(Y_{ij}) = \\sigma^2$。同一整群中两个不同个体之间的协方差为 $\\text{Cov}(Y_{ij}, Y_{ik}) = \\rho \\sigma^2$（当 $j \\neq k$ 时）。\n\n考虑单个整群 $i$ 的样本均值：\n$$ \\bar{Y}_i = \\frac{1}{m} \\sum_{j=1}^{m} Y_{ij} $$\n此样本均值的方差为：\n$$ \\text{Var}(\\bar{Y}_i) = \\text{Var}\\left(\\frac{1}{m} \\sum_{j=1}^{m} Y_{ij}\\right) = \\frac{1}{m^2} \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) $$\n和的方差是整群内 $m$ 个个体协方差矩阵中所有元素的总和。这包括对角线上的 $m$ 个方差项和非对角线上的 $m(m-1)$ 个协方差项。\n$$ \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) = \\sum_{j=1}^{m} \\text{Var}(Y_{ij}) + \\sum_{j \\neq k} \\text{Cov}(Y_{ij}, Y_{ik}) $$\n$$ \\text{Var}\\left(\\sum_{j=1}^{m} Y_{ij}\\right) = m\\sigma^2 + m(m-1)\\rho\\sigma^2 = m\\sigma^2 [1 + (m-1)\\rho] $$\n将此结果代回 $\\text{Var}(\\bar{Y}_i)$ 的表达式中：\n$$ \\text{Var}(\\bar{Y}_i) = \\frac{1}{m^2} \\left( m\\sigma^2 [1 + (m-1)\\rho] \\right) = \\frac{\\sigma^2}{m} [1 + (m-1)\\rho] $$\n对于个体随机试验（IRT），观测值是独立的（$\\rho=0$），$m$ 个个体均值的方差将是 $\\frac{\\sigma^2}{m}$。方差膨胀因子（VIF），也称为设计效应，是整群抽样下变异与独立抽样下变异的比值。\n$$ \\text{VIF} = \\frac{\\text{Var}_{\\text{clustered}}(\\bar{Y}_i)}{\\text{Var}_{\\text{independent}}(\\bar{Y}_i)} = \\frac{\\frac{\\sigma^2}{m}[1 + (m-1)\\rho]}{\\frac{\\sigma^2}{m}} = 1 + (m-1)\\rho $$\n该因子量化了由于组内相关性导致样本方差膨胀的程度。\n\n现在，我们可以使用推导出的VIF来解决问题的两个部分。给定 $m=20$ 和 $\\rho=0.05$。\n首先，我们计算VIF的数值：\n$$ \\text{VIF} = 1 + (20-1)(0.05) = 1 + (19)(0.05) = 1 + 0.95 = 1.95 $$\n\n**1. 计算经整群调整后的有效样本量。**\n有效样本量（$N_{\\text{eff}}$）是指能够提供与总样本量为 $N$ 的CRT相同统计功效的IRT的样本量。它的计算方法是将CRT中的总个体数除以VIF。\n给定CRT中总共招募了 $N=400$ 名个体：\n$$ N_{\\text{eff}} = \\frac{N}{\\text{VIF}} = \\frac{400}{1.95} $$\n为了将其表示为精确分数：\n$$ N_{\\text{eff}} = \\frac{400}{\\frac{195}{100}} = \\frac{400 \\times 100}{195} = \\frac{40000}{195} $$\n$40000$ 和 $195$ 的最大公约数是 $5$。\n$$ N_{\\text{eff}} = \\frac{40000 \\div 5}{195 \\div 5} = \\frac{8000}{39} $$\n\n**2. 计算每臂所需的整群数量。**\n目标是达到与参考IRT相等的有效样本量，即 $N_{\\text{eff}} = 400$。设 $N_{CRT}$ 为此CRT所需的总个体数。由于 $m$ 和 $\\rho$ 不变，VIF 仍为 $1.95$。\n我们使用相同的关系式并求解 $N_{CRT}$：\n$$ N_{\\text{eff}} = \\frac{N_{CRT}}{\\text{VIF}} \\implies 400 = \\frac{N_{CRT}}{1.95} $$\n$$ N_{CRT} = 400 \\times 1.95 = 400 \\times \\left(2 - 0.05\\right) = 800 - 20 = 780 $$\n总共需要 $780$ 名个体。由于每个整群提供 $m=20$ 名个体，所需的总整群数 $K$ 为：\n$$ K = \\frac{N_{CRT}}{m} = \\frac{780}{20} = 39 $$\n问题要求在双臂试验且等量分配的假设下，计算每臂的整群数量。\n$$ \\text{Clusters per arm} = \\frac{K}{2} = \\frac{39}{2} $$\n由于问题要求一个精确的实数，因此 $\\frac{39}{2}$（或 $19.5$）是所要求的答案。\n\n两个结果是 $\\frac{8000}{39}$ 和 $\\frac{39}{2}$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{8000}{39}  \\frac{39}{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "区组随机化是一种常用技术，旨在确保试验在整个招募期间各治疗组的人数保持平衡。虽然保持平衡是一项优势，但这项实践  揭示了一个关键的潜在弱点：即可预测性。通过解决这个问题，您将理解，如果研究人员了解区组设计细节，他们可能能够预测未来的治疗分配，从而在缺乏有效分配隐藏（allocation concealment）的情况下，破坏随机化过程的完整性。",
            "id": "4639930",
            "problem": "一项多中心随机对照试验 (RCT) 采用固定置换区组随机化方法，区组大小和分配比例已知，以在整个招募过程中保持各治疗组间的平衡。在每个区组中，分配是由一个由分配比例决定的固定标签多重集的随机排列。\n\n假设区组大小为 $4$，分配比例为 $1:1$，因此每个区组恰好包含两次分配给治疗组 ($T$) 和两次分配给对照组 ($C$)，并以随机顺序排列。每个研究中心的研究人员都知道区组大小、分配比例以及新一区组的开始时间，但他们无法获取未来的随机化列表。在观察到某一区组内的前三次分配后，一名协调员试图利用该设计下所有可用的信息来猜测第四次分配的结果。\n\n仅使用关于从有限集合中进行不放回抽样的第一性原理以及区组随机化的定义（即每个区组恰好包含规定数量的 $T$ 和 $C$），计算协调员在观察到区组中的三次招募后能够正确猜出下一次分配的概率。请将最终答案表示为小数。",
            "solution": "问题要求计算在一个大小为 $4$ 的置换区组中，协调员在观察到前三次分配后，能够正确猜出第四次分配的概率。区组随机化方案规定了区组大小为 $4$，治疗组 ($T$) 和对照组 ($C$) 之间的分配比例为 $1:1$。\n\n首先，我们来定义单个区组的构成。区组大小为 $4$ 且分配比例为 $1:1$ 意味着每个区组包含一个分配的多重集 $\\mathcal{B} = \\{T, T, C, C\\}$。区组内实际的分配序列是这四个元素的随机排列。这个过程等同于从多重集 $\\mathcal{B}$ 中进行不放回抽样。\n\n$\\mathcal{B}$ 中元素的不同序列（排列）总数由多项式系数给出：\n$$N = \\frac{4!}{2! 2!} = \\frac{24}{4} = 6$$\n对于任何一个区组，这 $6$ 个独特的序列中的每一个都等可能地成为其随机化序列。\n\n设一个区组内的分配序列表示为 $(X_1, X_2, X_3, X_4)$。协调员观察前三次分配 $(X_1, X_2, X_3)$，并试图猜测第四次分配 $X_4$。协调员的猜测基于这样一个知识：完整的区组必须恰好包含两个 $T$ 和两个 $C$。\n\n设 $N_T(k)$ 和 $N_C(k)$ 分别为序列中前 $k$ 个位置中 $T$ 和 $C$ 分配的数量。对于整个区组，我们有以下约束条件：\n$$N_T(4) = 2$$\n$$N_C(4) = 2$$\n\n观察前三次分配后，协调员知道了 $N_T(3)$ 和 $N_C(3)$ 的值。由于我们是从 $\\mathcal{B}$ 中进行不放回抽样，不可能抽出三个相同的类型。因此，观察到的前三次分配的可能构成是：\n1.  两个 $T$ 和一个 $C$：$N_T(3) = 2$ 且 $N_C(3) = 1$。\n2.  一个 $T$ 和两个 $C$：$N_T(3) = 1$ 且 $N_C(3) = 2$。\n\n这两种情况涵盖了前三次分配的所有可能性。没有其他组合是可能的。\n\n让我们分析协调员在每种情况下的推理过程。\n\n情况1：观察到的分配是两个 $T$ 和一个 $C$。\n在这种情况下，$N_T(3) = 2$ 且 $N_C(3) = 1$。协调员知道，到区组结束时，必须总共有两个 $T$。既然已经分配了两个 $T$，那么第四次分配 $X_4$ 就不可能是 $T$。\n形式上，我们知道 $N_T(4) = N_T(3) + I(X_4 = T)$，其中 $I(\\cdot)$ 是指示函数。\n$$2 = 2 + I(X_4 = T)$$\n这意味着 $I(X_4 = T) = 0$，所以 $X_4 \\neq T$。因为唯一的另一种可能性是 $C$，所以第四次分配必须是 $C$。\n协调员使用这种确切的逻辑，会猜测第四次分配是 $C$。由于第四次分配确定性地是 $C$，协调员猜对的概率是 $1$。\n\n情况2：观察到的分配是一个 $T$ 和两个 $C$。\n在这种情况下，$N_T(3) = 1$ 且 $N_C(3) = 2$。协调员知道，完整的区组必须包含两个 $C$。既然两次 $C$ 的分配都已发生，第四次分配 $X_4$ 就不可能是 $C$。\n形式上，我们使用对 $C$ 的约束条件：$N_C(4) = N_C(3) + I(X_4 = C)$。\n$$2 = 2 + I(X_4 = C)$$\n这意味着 $I(X_4 = C) = 0$，所以 $X_4 \\neq C$。因此，第四次分配必须是 $T$。\n协调员的猜测将是 $T$。由于第四次分配确定性地是 $T$，协调员猜对的概率同样是 $1$。\n\n设 $E$ 为协调员猜对的事件。设 $A_1$ 为前三次分配由两个 $T$ 和一个 $C$ 组成的事件。设 $A_2$ 为前三次分配由一个 $T$ 和两个 $C$ 组成的事件。如前所述，这两个事件构成了前三次观测的可能结果空间的一个划分。\n猜对的总概率可以用全概率公式求得：\n$$P(E) = P(E | A_1) P(A_1) + P(E | A_2) P(A_2)$$\n根据我们的分析：\n- 如果事件 $A_1$ 发生，第四次分配确定性地是 $C$，协调员会猜 $C$。因此，在给定 $A_1$ 的条件下猜对的概率是 $P(E | A_1) = 1$。\n- 如果事件 $A_2$ 发生，第四次分配确定性地是 $T$，协调员会猜 $T$。因此，在给定 $A_2$ 的条件下猜对的概率是 $P(E | A_2) = 1$。\n\n将这些值代入方程：\n$$P(E) = (1) \\cdot P(A_1) + (1) \\cdot P(A_2) = P(A_1) + P(A_2)$$\n由于 $A_1$ 和 $A_2$ 代表了前三次分配的所有可能结果，它们的概率之和必须为 $1$：\n$$P(A_1) + P(A_2) = 1$$\n因此，协调员能够正确猜出第四次分配的概率是：\n$$P(E) = 1$$\n这一结论与前三次分配的具体顺序无关。在每一种可能的情况下，协调员都有足够的信息来确定地推断出第四次分配的结果。\n\n题目要求答案以小数形式表示。",
            "answer": "$$\n\\boxed{1.0}\n$$"
        }
    ]
}