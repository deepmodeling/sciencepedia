## 引言
随机对照试验（RCT）被广泛认为是评估干预措施有效性、建立因果关系的黄金标准。无论是在开发新药、制定公共卫生政策，还是在验证新型数字疗法时，RCT都提供了最可靠的证据基础。然而，其强大的推断能力背后，是一套严谨的设计原则和复杂的实施细节。若对这些原则理解不深或执行不当，研究结论的可靠性将大打折扣，甚至得出错误的因果判断。

本文旨在填补理论与实践之间的鸿沟，系统性地阐明RCT的设计、实施与解读。我们将带领读者深入探索这一强大的研究工具，理解其内在逻辑，并学会识别和规避常见的陷阱。

在接下来的章节中，你将学到：在“原理与机制”部分，我们将从伦理基石“临床均势”出发，建立因果推断的语言，并深入剖析随机化、盲法、意向治疗分析等核心机制如何协同作用以控制偏倚。随后，在“应用与跨学科联系”部分，我们将展示RCT在临床医学、公共卫生等领域的广泛应用，介绍[析因设计](@entry_id:166667)、非劣效性试验、整群随机试验等高级设计，并探讨其逻辑如何启发了[孟德尔随机化](@entry_id:147183)等前沿方法。最后，“动手实践”部分将通过具体计算，让你亲手处理试验数据，将理论知识转化为实践技能。

## 原理与机制

本章在前一章介绍性概述的基础上，深入探讨了构成随机对照试验（RCT）的科学和伦理基础的核心原理与机制。我们将从伦理前提开始，建立用于因果推断的概念框架，详细阐述实现可靠推断的核心机制——随机化，并探讨在实践中保护这一机制免受各种偏倚威胁的方法。最后，我们将讨论在面对现实世界复杂情况时，如何通过恰当的分析原则来解读试验结果。

### 伦理基石：临床均势

在科学探究的追求与对个体患者的关怀之间，随机对照试验（RCT）面临着一个固有的伦理张力。一方面，临床医生负有治疗责任，即有义务为当前患者提供其所知的最佳治疗；另一方面，研究者负有科学责任，即为未来患者群体生成可靠的医学知识。随机分配治疗方案的行为，如果导致部分患者被 knowingly（有意地）分配到较差的治疗方案，将直接违背治疗责任。

**临床均势（clinical equipoise）**原则为解决这一伦理困境提供了框架。它并非指单个医生对其偏好的治疗方案感到绝对不确定，这是一种脆弱且不切实际的“个体均势”。相反，临床均势是指在相关的专家临床社群中，对于试验中所比较的治疗方案的相对疗效，存在一种真实的、集体的专业性不确定性或分歧 。

具体来说，当一项新的治疗方案 $A$ 与当前的标准化治疗 $B$ 进行比较时，如果专家社群中一部分人基于现有证据相信 $A$ 可能更优，另一部分人相信 $B$ 可能更优，而大部分人认为现有证据不足以形成明确结论，那么临床均势便存在。在这种状态下，随机分配患者到任一治疗组都不会违背医生的治疗责任，因为从整个专家社群的知识状态来看，没有一个治疗方案被公认为更优。

临床均势的必要性具有双重意义：
1.  **伦理必要性**：它允许随机化在不违背“不伤害”原则和医生关怀义务的前提下进行。如果没有均势（即，已有共识认为一种治疗优于另一种），那么进行随机分配就是 knowingly 将患者置于接受次优治疗的风险之中，这是不道德的。
2.  **认识论必要性（Epistemological Necessity）**：它确保了试验的科学价值。一项研究的 epistemic justification（认识论上的正当性）取决于它是否旨在回答一个真正悬而未决的科学问题。如果临床均势不存在，意味着该科学问题在很大程度上已被解答，再次进行试验将是多余的，不必要地让参与者承担研究风险而无望产生有价值的新知识。

因此，临床均勢构成了RCT的伦理与科学出发点。它确保了试验既是为解决一个真实的科学不确定性而设计的，也尊重了每一位参与者的福祉。

### 因果推断的语言：潜在结局与SUTVA

为了精确地定义和估计治疗的“效果”，流行病学和统计学采用**潜在结局（potential outcomes）**框架。对于任何一个个体 $i$，我们设想其在两种不同处理下的两种潜在状态：

-   $Y_i(1)$：个体 $i$ 如果接受治疗（例如，新药）后的结局。
-   $Y_i(0)$：同一个体 $i$ 如果接受对照（例如，安慰剂）后的结局。

对于个体 $i$ 而言，其**个体因果效应（individual causal effect）**就是这两个潜在结局的差异：$Y_i(1) - Y_i(0)$。然而，我们面临一个根本性的挑战：在任何给定的时刻，我们只能观察到这两个潜在结局中的一个。例如，如果个体 $i$ 接受了治疗，我们观察到其结局为 $Y_i(1)$，而其在同一时间点接受对照的结局 $Y_i(0)$ 则成为一个无法观测到的“反事实”（counterfactual）。这就是**因果推断的根本问题**。

由于我们无法在个体层面同时观测到所有潜在结局，我们的目标转向估计群体层面的平均效应，即**平均治疗效应（Average Treatment Effect, ATE）**。ATE被定义为群体中个体因果效应的[期望值](@entry_id:150961)或平均值：
$$ \text{ATE} = E[Y(1) - Y(0)] = E[Y(1)] - E[Y(0)] $$
这个量代表了如果整个目标人群都接受治疗，相较于整个目标人群都接受对照，平均结局的差异 。

为了使潜在结局的表示法 $Y_i(1)$ 和 $Y_i(0)$ 有意义，我们必须依赖一个关键的假设，即**稳定单位治疗价值假设（Stable Unit Treatment Value Assumption, SUTVA）**。SUTVA包含两个子假设 ：

1.  **无干涉（No Interference）**：任何个体的潜在结局仅取决于其自身接受的治疗，而与其他个体接受何种治疗无关。这意味着我们可以将个体 $i$ 的潜在结局写为 $Y_i(z)$，其中 $z$ 是个体 $i$ 的治疗状态，而不是更复杂的 $Y_i(z_1, z_2, \dots, z_N)$，后者表示其结局可能依赖于试验中所有 $N$ 名参与者的治疗分配。

    例如，在一个针对大学宿舍学生进行[流感疫苗](@entry_id:165908)的个体随机试验中，SUTVA的无干涉假设可能被违反。一名学生接种疫苗（$A_i=1$）可能会通过减少病毒传播而间接保护其未接种疫苗的室友（$A_j=0$），从而影响室友的健康结局。这种情况下，未接种疫苗的室友的结局不仅取决于他自己的治疗状态（未接种），还取决于他人的治疗状态，这就是**干涉（interference）**的一个典型例子 。

2.  **一致性（Consistency）**：对于任何个体，其接受的特定治疗版本不存在隐藏的变异。如果一个个体被分配并接受了治疗 $z$，那么我们观察到的结局 $Y_i$ 就是其潜在结局 $Y_i(z)$。这确保了从治疗状态到结局的映射是唯一的。例如，它排除了“新药”在不同诊所以不同剂量或不同辅导方式给药的可能性，因为这些不同的给药方式可能对应着不同的潜在结局。

在SUTVA成立的前提下，我们可以将观察到的结局 $Y$ 与潜在结局联系起来。令 $A$ 为一个[二元变量](@entry_id:162761)，表示治疗分配（$A=1$ 为治疗组，$A=0$ 为[对照组](@entry_id:188599)），则观察到的结局可以表示为：
$$ Y = A \cdot Y(1) + (1-A) \cdot Y(0) $$

### 核心机制：随机化与可交换性

定义了ATE这一我们希望估计的目标（estimand）后，接下来的问题是如何基于可观察的数据来估计它。直接比较接受治疗者的平均结局和未接受治疗者的平均结局，即关联性差异 $E[Y | A=1] - E[Y | A=0]$，在非实验性研究中通常不等于ATE。这是因为决定是否接受治疗的因素（例如，病情更严重的人更可能寻求新疗法）也可能与结局相关，这种现象称为**混杂（confounding）**。

RCT的核心机制——**随机化（randomization）**——正是为了解决这一问题而设计的。随机化是指将参与者分配到不同治疗组的过程完全基于一个已知的概率机制（如抛硬币），并且该分配独立于参与者的任何基线特征（无论是可观测的还是不可观测的）。

随机化的根本作用是，在期望的意义上，创造出**[可交换性](@entry_id:263314)（exchangeability）**的治疗组。可交换性意味着，在治疗开始之前，治疗组和[对照组](@entry_id:188599)在所有与结局相关的预后因素上都是可比的。如果我们能够交换两个组的标签，它们的平均结局期望是相同的。更正式地说，随机化旨在实现治疗分配 $A$ 与潜在结局对 $(Y(1), Y(0))$ 之间的[统计独立性](@entry_id:150300) ：
$$ A \perp (Y(1), Y(0)) $$
这意味着，无论一个人的潜在结局是好是坏，这都不会影响他被分配到治疗组或[对照组](@entry_id:188599)的概率。因此，治疗组可以被视作[对照组](@entry_id:188599)在接受治疗后的“反事实”代表，反之亦然。

在可交换性（由随机化保证）的条件下，因果推断的桥梁得以建立：
$$ E[Y|A=1] = E[Y(1)|A=1] \quad (\text{根据一致性}) $$
$$ E[Y(1)|A=1] = E[Y(1)] \quad (\text{根据可交换性/独立性}) $$
同样地，
$$ E[Y|A=0] = E[Y(0)] $$
于是，关联性度量现在等同于因果性度量：
$$ E[Y|A=1] - E[Y|A=0] = E[Y(1)] - E[Y(0)] = \text{ATE} $$
因此，在理想的RCT中，我们可以通过计算两组观察结局的样本均值之差，$\hat{\Delta} = \bar{Y}_T - \bar{Y}_C$，来估计ATE。这个简单的**差值均值估计量（difference-in-means estimator）**具有两个优良的统计特性 ：
-   **无偏性（Unbiasedness）**：$E[\hat{\Delta}] = \text{ATE}$。这意味着，如果我们将这个试验重复无数次，估计值的平均值将精确地等于真实的ATE。这并不意味着任何单次试验的结果会完[全等](@entry_id:194418)于ATE，单次试验的结果会受到[随机抽样](@entry_id:175193)误差的影响。
-   **一致性（Consistency）**：随着样本量 $n$ 趋于无穷大，估计量 $\hat{\Delta}$ 会在概率上收敛于真实的ATE。这意味着，只要样本量足够大，我们的估计值就会非常接近真实值。

### 随机化的实施：方法与目标

虽然所有随机化方法的核心都是为了实现可交换性，但不同的实施方式在处理有限样本的特定问题上各有优劣 。

#### 完全随机化
**完全随机化（Complete randomization）**是最简单的形式，相当于为每个参与者抛一次硬币来决定其分组。尽管它在理论上能保证无偏性，但在有限样本中，它可能偶然导致治疗组和[对照组](@entry_id:188599)的**样本量不均衡**，或者重要**预后协变量分布不均衡**。例如，在一个 $n=100$ 的试验中，我们可能偶然得到60名治疗者和40名对照者。这种样本量的不均衡会增大ATE[估计量的方差](@entry_id:167223)，从而降低[统计功效](@entry_id:197129)。

#### 区组随机化
**区组随机化（Permuted block randomization）**通过将参与者划分为小的“区组”（例如，大小为4或6的块）来解决样本量不均衡的问题。在每个区组内部，随机分配保证了治疗组和[对照组](@entry_id:188599)的数量完全相等（例如，在大小为4的区组中，有2个治疗和2个对照）。这确保了在试验的任何阶段，两组的样本量都非常接近，从而有效控制了[估计量的方差](@entry_id:167223)。然而，区组随机化也存在一个潜在风险：如果区组大小很小且**分配隐藏（allocation concealment）**做得不好，研究人员可能在区组的末尾预测出下一个分配，从而引入选择偏倚。

#### [分层随机化](@entry_id:189937)
**[分层随机化](@entry_id:189937)（Stratified randomization）**旨在解决基线重要预后协变量不均衡的问题。在随机化之前，研究者根据一两个关键的预后因素（如疾病严重程度“轻/重”或研究中心）将参与者分层。然后，在每个层（stratum）内部独立进行随机化（通常采用区组随机化）。这确保了在每个关键预后因素的亚组内，治疗组和[对照组](@entry_id:188599)的分配是平衡的。如果分层变量确实与结局密切相关，[分层随机化](@entry_id:189937)可以显著降低ATE[估计量的方差](@entry_id:167223)，提高试验的**[精确度](@entry_id:143382)（precision）**和统计功效。值得注意的是，如果对一个与结局无关的变量进行分层，虽然不会带来统计上的收益，但也不会引入偏倚 。

### 保护随机化：偏倚的来源与对策

随机化过程的成功不仅在于其数学上的设计，更在于其在整个试验过程中的保护。多种偏倚可能会在随机化之后侵蚀试验的**内部效度（internal validity）**。

#### 选择偏倚与分配隐藏

**选择偏倚（Selection bias）**发生在当研究人员对下一个治疗分配的预知影响了他们招募或选择参与者的决策时。这会破坏由随机化建立的基线可交换性。例如，如果研究人员知道下一个分配是安慰剂，他们可能会下意识地将病情较轻的患者纳入研究，或劝退病情较重的患者。

防止选择偏倚的关键机制是**分配隐藏（Allocation concealment）** 。这是一个严格的过程，确保在参与者被正式纳入试验并确定其合格性之后，直到最后一刻，没有人能够预测或知道该参与者将被分配到哪个组。常见的方法包括由中心化的、独立的第三方（如药房或统计中心）进行电话或网络随机化，或使用不透光的、序列编号的密封信封。分配隐藏保护的是随机化**分配发生时**的完整性。一个试验即使没有采用盲法，也可以拥有良好的分配隐藏。例如，在  描述的维生素D试验中，尽管随机序列由独立统计师生成，但使用重量可能存在差异的信封损害了分配隐藏的有效性，为选择偏倚打开了方便之门。

#### 行为偏倚、观察偏倚与盲法

一旦分配完成，新的偏倚风险便会出现。这些偏倚源于参与者、临床医生或研究人员知道所接受的治疗后产生的行为或评估上的系统性差异。

-   **行为偏倚（Performance bias）**：指治疗组和[对照组](@entry_id:188599)在接受除研究干预之外的其他照顾或暴露方面存在系统性差异。例如，得知自己服用的是新药的参与者可能会更有信心地改变生活方式，而服用安慰剂的参与者可能会寻求其他辅助治疗。
-   **观察偏倚（Detection/Ascertainment bias）**：指两组之间在结局的评估、记录或报告方式上存在系统性差异。例如，未被盲化的评估者可能会更仔细地在治疗组中寻找微小的改善，或者知道自己服用安慰剂的患者在报告主观症状时可能更为悲观。

对抗这两类偏倚的主要工具是**盲法（Blinding 或 Masking）**。盲法是指对试验参与方隐藏治疗分配信息的过程，它保护的是随机化**分配发生后**的试验过程。
-   **单盲**：仅参与者不知道分组情况。
-   **双盲**：参与者和临床医生/研究人员都不知道分组情况。
-   **三盲**：参与者、临床医生/研究人员以及结局评估者/数据分析师都不知道分组情况。

在  的例子中，由于参与者和医护人员未被设盲，行为偏倚的风险很高。更微妙的是，尽管结局裁定委员会是设盲的，但观察偏倚仍可能发生，因为需要参与者在出现症状时**主动寻求检测**。知道自己服用维生素D的参与者可能会将轻微症状归因于普通感冒而不去检测，而安慰剂组的参与者则可能更倾向于寻求检测，这会导致对治疗组结局的系统性低估 。

必须明确区分**分配隐藏**和**盲法** ：
-   **分配隐藏**防止的是**选择偏倚**，发生在**随机化分配时**，旨在保护随机分组过程本身。
-   **盲法**防止的是**行为偏倚和观察偏倚**，发生在**随机化分配后**，旨在保护试验数据的收集过程。

#### 失访偏倚与[缺失数据](@entry_id:271026)处理

**失访偏倚（Attrition bias）**发生在当参与者在试验结束前退出或失访，且失访的比例或原因在各组之间存在系统性差异，并且这种差异与结局相关时。例如，在  的[维生素D](@entry_id:149473)试验中，[维生素D](@entry_id:149473)组的失访率为 $0.15$，而安慰剂组为 $0.05$。如果失访的参与者（例如，因药物副作用而退出者）比继续参与者有更差的结局，那么这种差异性失访将导致对[维生素D](@entry_id:149473)效果的偏倚估计。

处理缺失数据需要理解其背后的机制 ：
-   **[完全随机缺失](@entry_id:170286)（Missing Completely At Random, MCAR）**：缺失的发生与任何观察到的或未观察到的数据都无关。在这种理想但罕见的情况下，仅分析数据完整的参与者（**完整病例分析**）不会产生偏倚。
-   **[随机缺失](@entry_id:168632)（Missing At Random, MAR）**：缺失的概率可以完全由观察到的数据（如治疗组、基线协变量）来解释，但与未观察到的结局值本身无关。例如，年龄较大的参与者更容易失访。在这种情况下，完整病例分析通常是有偏的，但可以通过使用**[多重插补](@entry_id:177416)（multiple imputation）**或**[逆概率](@entry_id:196307)加权（inverse probability weighting）**等统计方法进行校正，前提是用于校正的模型是正确的。
-   **[非随机缺失](@entry_id:163489)（Missing Not At Random, MNAR）**：缺失的概率依赖于未观察到的结局值本身。例如，病情恶化的患者因感觉不适而停止参与随访。这是最棘手的情况，因为标准校正方法（如上文所述）通常会失效，需要更复杂且依赖于无法验证的假设的敏感性分析。

### 数据分析：意向治疗原则

在RCT中，非依从性（non-adherence）——即参与者没有完全遵循其被分配的治疗方案——是普遍存在的。这引发了一个关键的分析问题：我们应该如何处理这些偏离了原始分配的参与者？

#### 意向治疗分析 (Intention-to-Treat, ITT)
**意向治疗（Intention-to-Treat, ITT）**原则是一个核心的分析策略，它要求所有被随机化的参与者都必须在他们最初被分配的组中进行分析，无论他们实际上是否遵守了该分配 。

-   **定义与原理**：ITT分析比较的是“意图”治疗组与“意图”[对照组](@entry_id:188599)。例如，在  的营养补充剂试验中，ITT分析比较的是最初被分配到补充剂组的全部500人的贫血率（$45/500$），与最初被分配到安慰剂组的全部500人的贫血率（$70/500$）。
-   **优点**：ITT的主要优点是它**完整地保留了随机化的好处**。由于每个参与者都保留在原始分组中，基线[可交换性](@entry_id:263314)得以维持，从而避免了因依从性等治疗后行为引入的混杂偏倚。因此，ITT分析为**治疗分配策略的效应**提供了一个无偏的估计。它回答了一个务实且重要的政策性问题：“在真实世界中，推荐使用这种疗法（考虑到预期的依从性水平）与推荐使用对照疗法相比，效果如何？” 。
-   **局限性**：由于包含了不依从者，ITT估计的效应值可能被“稀释”，通常会比治疗本身的“真实”生物学效应要小。

#### 其他分析方法及其陷阱

与ITT相比，其他看似更直观的分析方法实际上充满了偏倚的风险。

-   **按方案分析（Per-Protocol, PP）**：这种分析仅限于那些“良好”遵守了其分配方案的参与者。例如，在  的试验中，PP分析将比较375名依从的补充剂服用者（贫血率 $25/375$）与450名依从的安慰剂使用者（贫血率 $65/450$）。这种做法的问题在于，**依从性本身是一个治疗后变量**，可能与结局的预后因素相关。例如，能够坚持服用补充剂的人可能本身就更注重健康、生活习惯更好，因此他们的结局也更佳。通过只选择依从者，我们破坏了随机化所建立的组间可比性，引入了严重的选择偏倚。

-   **依实治疗分析（As-Treated）**：这种分析根据参与者**实际接受**的治疗来重新分组，完全忽略了他们最初的随机分配。例如，将所有实际服用了补充剂的人（无论其原始分组）与所有未服用的人进行比较。这完全打破了随机化，本质上是进行了一项**观察性研究**，其结果极易受到严重混杂的影响，因为选择接受或不接受治疗的决定几乎肯定与患者的健康状况和预后有关 。

综上所述，ITT分析因其能够保持随机化的完整性、提供对治疗策略的无偏估计而被公认为RCT有效性评价的**主要分析**。PP和AT分析虽然可能试图回答关于“纯粹”治疗效果的问题，但它们极易受到偏倚的影响，其结果必须谨慎解释，通常只作为次要的、探索性的分析。