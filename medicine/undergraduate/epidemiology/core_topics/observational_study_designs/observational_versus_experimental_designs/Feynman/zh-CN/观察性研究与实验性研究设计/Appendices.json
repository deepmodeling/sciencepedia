{
    "hands_on_practices": [
        {
            "introduction": "观察性研究与实验研究的核心区别在于处理混杂因素的能力。本练习将引导你通过一个简化的假想情景，亲手量化混杂偏倚的大小。通过从第一性原理出发进行推导，你将深刻理解为何简单比较暴露组和非暴露组会产生误导，并掌握如何通过调整混杂因素来修正估计，从而揭示真实的因果效应。",
            "id": "4616228",
            "problem": "考虑一项观察性队列研究，旨在了解二元暴露 $A \\in \\{0,1\\}$ 对连续结果 $Y$ 的影响，其中暴露前协变量 $X$ 是 $A$ 和 $Y$ 的共同原因。假设数据生成机制满足以下结构关系：\n\n- 协变量服从分布 $X \\sim \\mathrm{Uniform}(-1,1)$。\n- 暴露根据线性概率模型 $A \\mid X=x \\sim \\mathrm{Bernoulli}(p(x))$ 生成，其中 $p(x) = \\alpha_{0} + \\alpha_{1} x$，且 $\\alpha_{0} = 0.5$ 和 $\\alpha_{1} = 0.4$。这确保了正性，因为对于 $x \\in [-1,1]$，$p(x) \\in [0.1,0.9]$。\n- 结果由线性模型 $Y = \\beta_{0} + \\beta_{A} A + \\beta_{X} X + \\varepsilon$ 生成，其中 $\\varepsilon$ 是满足 $\\mathbb{E}[\\varepsilon \\mid A, X] = 0$ 的零均值噪声。设 $\\beta_{0} = 10$，$\\beta_{A} = 2$，$\\beta_{X} = 1.5$。\n\n将平均因果效应 (ACE) 定义为 $\\mathbb{E}\\!\\left[Y^{1} - Y^{0}\\right]$，其中 $Y^{a}$ 表示将 $A$ 干预设置为 $a$ 下的潜在结果。相比之下，朴素观察估计量是观察到的平均结果之差，$\\Delta_{\\mathrm{obs}} = \\mathbb{E}[Y \\mid A=1] - \\mathbb{E}[Y \\mid A=0]$。\n\n仅使用核心定义（潜在结果和条件期望）、全期望定律和代数，完成以下任务：\n\n1. 用 $\\beta_{A}$、$\\beta_{X}$、$\\alpha_{0}$、$\\alpha_{1}$ 和 $X$ 的属性来推导 $\\Delta_{\\mathrm{obs}}$。\n2. 在指定的参数值下，量化偏差 $B = \\Delta_{\\mathrm{obs}} - \\mathbb{E}\\!\\left[Y^{1} - Y^{0}\\right]$。\n3. 计算由标准化恒等式 $\\Delta_{\\mathrm{adj}} = \\int \\left(\\mathbb{E}[Y \\mid A=1, X=x] - \\mathbb{E}[Y \\mid A=0, X=x]\\right) f_{X}(x) \\, dx$ 定义的回归调整估计量，其中 $f_{X}$ 是 $X$ 的密度。\n\n将最终答案表示为 $\\Delta_{\\mathrm{adj}}$ 的单个数值。不要四舍五入。",
            "solution": "该问题将首先被验证，如果有效，则按要求分三部分进行解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   协变量分布：$X \\sim \\mathrm{Uniform}(-1,1)$。\n-   暴露模型：$A \\mid X=x \\sim \\mathrm{Bernoulli}(p(x))$，其中 $p(x) = \\alpha_{0} + \\alpha_{1} x$。\n-   暴露模型参数：$\\alpha_{0} = 0.5$，$\\alpha_{1} = 0.4$。\n-   结果模型：$Y = \\beta_{0} + \\beta_{A} A + \\beta_{X} X + \\varepsilon$。\n-   结果模型参数：$\\beta_{0} = 10$，$\\beta_{A} = 2$，$\\beta_{X} = 1.5$。\n-   噪声属性：$\\mathbb{E}[\\varepsilon \\mid A, X] = 0$。\n-   定义1：平均因果效应 (ACE) 是 $\\mathbb{E}[Y^{1} - Y^{0}]$。\n-   定义2：朴素观察估计量是 $\\Delta_{\\mathrm{obs}} = \\mathbb{E}[Y \\mid A=1] - \\mathbb{E}[Y \\mid A=0]$。\n-   定义3：混杂偏倚是 $B = \\Delta_{\\mathrm{obs}} - \\mathbb{E}[Y^{1} - Y^{0}]$。\n-   定义4：回归调整估计量是 $\\Delta_{\\mathrm{adj}} = \\int (\\mathbb{E}[Y \\mid A=1, X=x] - \\mathbb{E}[Y \\mid A=0, X=x]) f_{X}(x) \\, dx$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于因果推断和统计学原理。它描述了一个标准的混杂场景，这是流行病学中的一个核心概念。数据生成过程由一个线性结构方程模型和一个用于暴露的线性概率模型指定，这些都是常用且有效的建模选择。正性假设，$P(A=a \\mid X=x) > 0$ 对于所有 $a, x$，得到了明确的验证：对于 $x \\in [-1,1]$，$p(x) = 0.5 + 0.4x$ 的范围从 $0.5 - 0.4 = 0.1$到 $0.5 + 0.4 = 0.9$，因此 $p(x) \\in [0.1, 0.9]$，严格介于 $0$ 和 $1$ 之间。该问题是适定的，所有必要的参数和分布都已定义。语言客观、精确。所提问题是该背景下的标准推导。该问题是自洽的，没有矛盾。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整的解答。\n\n### 解答\n\n解答分为问题陈述中概述的三个任务。\n\n**1. $\\Delta_{\\mathrm{obs}}$ 的推导**\n\n朴素观察估计量定义为 $\\Delta_{\\mathrm{obs}} = \\mathbb{E}[Y \\mid A=1] - \\mathbb{E}[Y \\mid A=0]$。我们使用全期望定律，以协变量 $X$ 为条件，分别计算每一项。\n\n对于给定的暴露水平 $a \\in \\{0,1\\}$，结果的条件期望是：\n$$ \\mathbb{E}[Y \\mid A=a] = \\mathbb{E}_{X}[\\mathbb{E}[Y \\mid A=a, X] \\mid A=a] $$\n首先，我们求内部期望 $\\mathbb{E}[Y \\mid A=a, X=x]$。使用给定的 $Y$ 的线性模型和属性 $\\mathbb{E}[\\varepsilon \\mid A, X] = 0$：\n$$ \\mathbb{E}[Y \\mid A=a, X=x] = \\mathbb{E}[\\beta_{0} + \\beta_{A} A + \\beta_{X} X + \\varepsilon \\mid A=a, X=x] $$\n$$ = \\beta_{0} + \\beta_{A} a + \\beta_{X} x + \\mathbb{E}[\\varepsilon \\mid A=a, X=x] = \\beta_{0} + \\beta_{A} a + \\beta_{X} x $$\n现在我们对以 $A=a$ 为条件的 $X$ 的分布求外部期望：\n$$ \\mathbb{E}[Y \\mid A=a] = \\mathbb{E}[\\beta_{0} + \\beta_{A} a + \\beta_{X} X \\mid A=a] = \\beta_{0} + \\beta_{A} a + \\beta_{X} \\mathbb{E}[X \\mid A=a] $$\n将此应用于 $a=1$ 和 $a=0$：\n$$ \\mathbb{E}[Y \\mid A=1] = \\beta_{0} + \\beta_{A}(1) + \\beta_{X} \\mathbb{E}[X \\mid A=1] $$\n$$ \\mathbb{E}[Y \\mid A=0] = \\beta_{0} + \\beta_{A}(0) + \\beta_{X} \\mathbb{E}[X \\mid A=0] $$\n差值为：\n$$ \\Delta_{\\mathrm{obs}} = (\\beta_{0} + \\beta_{A} + \\beta_{X} \\mathbb{E}[X \\mid A=1]) - (\\beta_{0} + \\beta_{X} \\mathbb{E}[X \\mid A=0]) $$\n$$ \\Delta_{\\mathrm{obs}} = \\beta_{A} + \\beta_{X} (\\mathbb{E}[X \\mid A=1] - \\mathbb{E}[X \\mid A=0]) $$\n为了完成推导，我们必须求出 $\\mathbb{E}[X \\mid A=a]$。我们使用条件期望的定义和贝叶斯定理 (Bayes' theorem)：\n$$ f_{X|A}(x|a) = \\frac{P(A=a|X=x)f_X(x)}{P(A=a)} $$\n$X$ 的密度为 $f_X(x) = \\frac{1}{2}$（对于 $x \\in [-1,1]$）。倾向得分是 $p(x) = P(A=1|X=x) = \\alpha_0 + \\alpha_1 x$。$A=1$ 的边际概率是：\n$$ P(A=1) = \\int_{-1}^{1} P(A=1|X=x)f_X(x) dx = \\int_{-1}^{1} (\\alpha_0 + \\alpha_1 x) \\frac{1}{2} dx = \\frac{1}{2} \\left[ \\alpha_0 x + \\frac{\\alpha_1 x^2}{2} \\right]_{-1}^{1} = \\frac{1}{2} [(\\alpha_0 + \\frac{\\alpha_1}{2}) - (-\\alpha_0 + \\frac{\\alpha_1}{2})] = \\alpha_0 $$\n类似地，$P(A=0) = 1 - P(A=1) = 1 - \\alpha_0$。\n\n现在我们计算 $X$ 的条件期望：\n$$ \\mathbb{E}[X \\mid A=1] = \\int_{-1}^{1} x f_{X|A}(x|1) dx = \\int_{-1}^{1} x \\frac{(\\alpha_0 + \\alpha_1 x) (1/2)}{\\alpha_0} dx = \\frac{1}{2\\alpha_0} \\int_{-1}^{1} (\\alpha_0 x + \\alpha_1 x^2) dx $$\n$$ = \\frac{1}{2\\alpha_0} \\left[ \\frac{\\alpha_0 x^2}{2} + \\frac{\\alpha_1 x^3}{3} \\right]_{-1}^{1} = \\frac{1}{2\\alpha_0} \\left[ (\\frac{\\alpha_0}{2} + \\frac{\\alpha_1}{3}) - (\\frac{\\alpha_0}{2} - \\frac{\\alpha_1}{3}) \\right] = \\frac{1}{2\\alpha_0} \\left( \\frac{2\\alpha_1}{3} \\right) = \\frac{\\alpha_1}{3\\alpha_0} $$\n对于 $A=0$：\n$$ \\mathbb{E}[X \\mid A=0] = \\int_{-1}^{1} x \\frac{P(A=0|X=x)f_X(x)}{P(A=0)} dx = \\int_{-1}^{1} x \\frac{(1 - (\\alpha_0 + \\alpha_1 x)) (1/2)}{1-\\alpha_0} dx = \\frac{1}{2(1-\\alpha_0)} \\int_{-1}^{1} ((1-\\alpha_0)x - \\alpha_1 x^2) dx $$\n$$ = \\frac{1}{2(1-\\alpha_0)} \\left[ \\frac{(1-\\alpha_0) x^2}{2} - \\frac{\\alpha_1 x^3}{3} \\right]_{-1}^{1} = \\frac{1}{2(1-\\alpha_0)} \\left[ (\\frac{1-\\alpha_0}{2} - \\frac{\\alpha_1}{3}) - (\\frac{1-\\alpha_0}{2} + \\frac{\\alpha_1}{3}) \\right] = \\frac{1}{2(1-\\alpha_0)} \\left( -\\frac{2\\alpha_1}{3} \\right) = -\\frac{\\alpha_1}{3(1-\\alpha_0)} $$\n差值为：\n$$ \\mathbb{E}[X \\mid A=1] - \\mathbb{E}[X \\mid A=0] = \\frac{\\alpha_1}{3\\alpha_0} - \\left(-\\frac{\\alpha_1}{3(1-\\alpha_0)}\\right) = \\frac{\\alpha_1}{3} \\left( \\frac{1}{\\alpha_0} + \\frac{1}{1-\\alpha_0} \\right) = \\frac{\\alpha_1}{3} \\left( \\frac{1-\\alpha_0+\\alpha_0}{\\alpha_0(1-\\alpha_0)} \\right) = \\frac{\\alpha_1}{3\\alpha_0(1-\\alpha_0)} $$\n将此代回 $\\Delta_{\\mathrm{obs}}$ 的表达式，得到最终的推导形式：\n$$ \\Delta_{\\mathrm{obs}} = \\beta_A + \\beta_X \\left( \\frac{\\alpha_1}{3\\alpha_0(1-\\alpha_0)} \\right) $$\n\n**2. 偏差 $B$ 的量化**\n\n平均因果效应 (ACE) 是 $\\mathbb{E}[Y^1 - Y^0]$。潜在结果 $Y^a$ 是通过对 $Y$ 的结构方程进行干预来定义的：\n$$ Y^a = \\beta_{0} + \\beta_{A} a + \\beta_{X} X + \\varepsilon $$\n其中 $X$ 和 $\\varepsilon$ 服从其原始分布。\n$$ \\mathrm{ACE} = \\mathbb{E}[Y^1 - Y^0] = \\mathbb{E}[(\\beta_0 + \\beta_A(1) + \\beta_X X + \\varepsilon) - (\\beta_0 + \\beta_A(0) + \\beta_X X + \\varepsilon)] $$\n$$ = \\mathbb{E}[\\beta_A] = \\beta_A $$\n偏差 $B$ 是观察估计量与因果效应之间的差值：\n$$ B = \\Delta_{\\mathrm{obs}} - \\mathrm{ACE} = \\left(\\beta_A + \\beta_X \\frac{\\alpha_1}{3\\alpha_0(1-\\alpha_0)}\\right) - \\beta_A = \\beta_X \\frac{\\alpha_1}{3\\alpha_0(1-\\alpha_0)} $$\n该项表示由共同原因 $X$ 引起的混杂偏倚。现在，我们代入给定的数值：$\\beta_{X} = 1.5$，$\\alpha_1 = 0.4$，$\\alpha_0 = 0.5$。\n$$ B = 1.5 \\times \\frac{0.4}{3 \\times 0.5 \\times (1-0.5)} = 1.5 \\times \\frac{0.4}{3 \\times 0.5 \\times 0.5} = 1.5 \\times \\frac{0.4}{0.75} = \\frac{3}{2} \\times \\frac{0.4}{3/4} = \\frac{3}{2} \\times 0.4 \\times \\frac{4}{3} = 2 \\times 0.4 = 0.8 $$\n偏差为 $0.8$。\n\n**3. 回归调整估计量 $\\Delta_{\\mathrm{adj}}$ 的计算**\n\n回归调整估计量由标准化公式定义：\n$$ \\Delta_{\\mathrm{adj}} = \\int \\left(\\mathbb{E}[Y \\mid A=1, X=x] - \\mathbb{E}[Y \\mid A=0, X=x]\\right) f_{X}(x) \\, dx $$\n从第1部分，我们已经确定了条件期望 $\\mathbb{E}[Y \\mid A=a, X=x] = \\beta_0 + \\beta_A a + \\beta_X x$。积分内的差值为：\n$$ \\mathbb{E}[Y \\mid A=1, X=x] - \\mathbb{E}[Y \\mid A=0, X=x] = (\\beta_0 + \\beta_A(1) + \\beta_X x) - (\\beta_0 + \\beta_A(0) + \\beta_X x) = \\beta_A $$\n被积函数简化为一个常数 $\\beta_A$。因此，积分变为：\n$$ \\Delta_{\\mathrm{adj}} = \\int_{-1}^{1} \\beta_A f_{X}(x) \\, dx $$\n由于 $\\beta_A$ 是一个常数，我们可以将其从积分中提出：\n$$ \\Delta_{\\mathrm{adj}} = \\beta_A \\int_{-1}^{1} f_{X}(x) \\, dx $$\n概率密度函数在其整个支撑集上的积分等于 $1$。\n$$ \\int_{-1}^{1} f_{X}(x) \\, dx = 1 $$\n因此，调整后的估计量为：\n$$ \\Delta_{\\mathrm{adj}} = \\beta_A \\times 1 = \\beta_A $$\n这表明对混杂因素 $X$ 进行标准化可以恢复真实的平均因果效应。使用给定的参数值 $\\beta_A = 2$：\n$$ \\Delta_{\\mathrm{adj}} = 2 $$\n这就是所要求的最终数值。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "除了常见的混杂因素，观察性研究中还潜藏着更微妙的结构性偏倚。“永生时间偏倚”（immortal time bias）就是其中一种，它常常导致对处理效应的错误高估。本练习构建了一个处理分配依赖于未来生存信息的典型场景，通过计算，你将亲眼见证一个无效的治疗方法如何被错误地判断为具有显著的保护作用。这个实践旨在让你学会识别此类偏倚，并理解为何必须对齐时间零点，以模拟随机试验的结构来获得有效结论。",
            "id": "4616202",
            "problem": "一项观察性队列研究旨在比较接受新疗法与未接受新疗法的患者，在入组后为期 $T = 120$ 天的固定随访期内的死亡率。所有患者在第 $0$ 天均符合资格。实践中，该疗法仅在第 $t^\\star = 60$ 天时仍然存活的患者中启动；恰好有 $n_T = 274$ 名患者在第 $60$ 天开始治疗，无人更早开始。所有其他患者 ($N - n_T$) 仍未接受治疗。治疗开始后的真实因果效应为空（即时死亡风险不受治疗影响）。假设所有个体的死亡时间均服从指数分布，其恒定风险率 $\\lambda = 0.01$/天，无论他们是否开始治疗。\n\n一种朴素分析将暴露分类为“曾接受治疗”与“从未接受治疗”，其中“曾接受治疗”是从队列入组（第 $0$ 天）起定义的。然后，它计算每组到第 $120$ 天的累积死亡发生率（风险），并形成一个比率。\n\n仅使用累积发生率和条件概率的核心定义，推导当治疗分配基于未来信息（存活至 $t^\\star$）时，这种朴素分类引入的偏倚的预期方向和近似大小，并用“不朽时间”（immortal time）来解释其机制。然后，确定一种时间零点对齐策略，通过使观察性分析在结构上类似于随机对照试验（Randomized Controlled Trial, RCT）（其中资格、治疗分配和随访开始是同步的）来消除这种偏倚。\n\n哪个选项最准确地陈述了带偏倚的朴素风险比和有效的校正策略？\n\nA. 朴素的“从基线开始曾接受治疗”的累积发生率比值约为 $0.65$（伪保护性），因为暴露组的定义是存活过 $t^\\star$，这产生了不朽时间；一种有效的校正方法是将时间零点与治疗分配对齐，以模拟一项随机试验：可以将治疗建模为时变暴露，或使用一种设计，在相同的 $t^\\star$ 为未治疗的对照组分配可比的指数日期（目标试验模拟，Target Trial Emulation, TTE）。\n\nB. 朴素的累积发生率比值约为 $1.00$（无偏倚）；仅调整基线混杂因素就足以校正任何问题，而无需改变时间原点。\n\nC. 朴素的累积发生率比值约为 $2.00$（伪有害性），因为暴露患者累积了更多的人-时；一种有效的校正方法是在治疗开始时对暴露组的随访进行左截断，同时保持未暴露组的随访从队列入组时开始。\n\nD. 朴素的累积发生率比值约为 $0.50$（强保护性），因为排除了暴露组在 $t^\\star$ 之前的事件；一种有效的校正方法是在两组中都排除 $t^\\star$ 之前的死亡，同时将时间零点保持在队列入组时。",
            "solution": "用户需要一个关于流行病学中不朽时间偏倚问题的详细验证和解决方案。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n-   **研究类型**：观察性队列研究。\n-   **随访期**：从第 $0$ 天入组开始，共 $T = 120$ 天。\n-   **治疗时间**：疗法在第 $t^\\star = 60$ 天开始。\n-   **治疗条件**：只有在第 $t^\\star = 60$ 天仍然存活的患者才有资格并接受治疗。\n-   **治疗组规模**：$n_T = 274$ 名患者在第 $60$ 天开始治疗。\n-   **真实因果效应**：空。死亡风险不受治疗影响。\n-   **生存模型**：死亡时间服从指数分布。\n-   **风险率**：所有个体的恒定风险率 $\\lambda = 0.01$/天，无论治疗状态如何。\n-   **朴素分析**：\n    -   暴露在基线（第 $0$ 天）被分类为“曾接受治疗”与“从未接受治疗”。\n    -   该分析计算每组到第 $120$ 天的累积死亡发生率（风险）。\n    -   形成一个风险比。\n-   **需推导的内容**：\n    1.  使用核心定义推导偏倚（方向和大小）。\n    2.  用不朽时间解释其机制。\n    3.  确定一个有效的校正策略（时间零点对齐）。\n\n**步骤2：使用提取的给定信息进行验证**\n-   **科学依据**：该问题在流行病学和生物统计学的基本原理上有坚实的基础。它描述了不朽时间偏倚的经典情景，这是观察性研究中一种有据可查的结构性偏倚。使用具有恒定风险的指数分布是展示此类概念的标准且有效的建模假设。\n-   **良定性**：该问题是良定的。计算所需的所有参数（$\\lambda$、$t^\\star$、$T$）均已提供。“朴素分析”方案的描述足够清晰，可以计算出有偏倚的估计值。可以推导出预期风险比的唯一解。治疗患者的具体数量 $n_T = 274$ 对于计算预期风险不是必需的，但其包含并未造成矛盾。\n-   **客观性**：语言精确客观，使用了该领域的标准术语。\n\n问题陈述没有违反任何无效标准。它是一个科学上合理、良定且标准的问题，旨在测试对流行病学方法中一个关键概念的理解。\n\n**步骤3：结论与行动**\n问题是**有效的**。我将继续进行解答。\n\n### 解答推导\n\n该问题要求计算因朴素分析错误描述随访时间而产生的有偏倚的风险比。疗法的真实因果效应为空，因此风险率 $\\lambda = 0.01$/天 对所有个体在所有时间都是恒定的。正确分析的风险比应为 $1.0$。任何偏离 $1.0$ 的值都是偏倚。\n\n任何个体的生存函数为 $S(t) = P(\\text{死亡时间} > t) = e^{-\\lambda t}$。\n到时间 $t$ 的累积死亡发生率（风险）为 $CI(t) = P(\\text{死亡时间} \\le t) = 1 - S(t) = 1 - e^{-\\lambda t}$。\n\n**1. “曾接受治疗”组的累积发生率（$CI_E$）**\n\n朴素分析将在第 $60$ 天接受治疗的个体从队列开始的第 $0$ 天起就归类为“曾接受治疗”。该组的一个决定性特征是，每个成员*必须*从第 $0$ 天存活到第 $60$ 天才能接受治疗。这个时期，即 $[0, 60)$ 天，对于该组来说是“不朽时间”。根据定义，他们在此期间不可能经历事件（死亡）。\n\n朴素分析计算到第 $T=120$ 天的累积发生率。对于“曾接受治疗”组中的个体，其定义是他们存活到 $t^\\star=60$，那么到第 $120$ 天的死亡风险就是*在给定*他们存活过第 $60$ 天的情况下，到第 $120$ 天死亡的条件概率。\n\n$$ CI_E = P(D \\le 120 \\mid D > 60) $$\n\n根据条件概率的定义 $P(A|B) = P(A \\cap B) / P(B)$：\n事件“$D \\le 120$ 且 $D > 60$”是在区间 $(60, 120]$ 内死亡。\n$$ CI_E = \\frac{P(60  D \\le 120)}{P(D  60)} = \\frac{S(60) - S(120)}{S(60)} = 1 - \\frac{S(120)}{S(60)} $$\n代入生存函数 $S(t) = e^{-\\lambda t}$：\n$$ CI_E = 1 - \\frac{e^{-\\lambda \\times 120}}{e^{-\\lambda \\times 60}} = 1 - e^{-\\lambda(120-60)} = 1 - e^{-60\\lambda} $$\n当 $\\lambda = 0.01$ 天$^{-1}$ 时：\n$$ CI_E = 1 - e^{-60 \\times 0.01} = 1 - e^{-0.6} $$\n使用近似值 $e^{-0.6} \\approx 0.5488$：\n$$ CI_E \\approx 1 - 0.5488 = 0.4512 $$\n\n**2. “从未接受治疗”组的累积发生率（$CI_U$）**\n\n“从未接受治疗”组作为对照组。在这种朴素设计中，该组包括所有其他患者，包括在第 $60$ 天之前死亡的患者。因此，其风险状况代表了整个队列的风险，没有任何生存条件限制。他们从第 $0$ 天起就有死亡风险。该组到第 $120$ 天的累积死亡发生率是无条件概率：\n\n$$ CI_U = P(D \\le 120) = 1 - e^{-120\\lambda} $$\n当 $\\lambda = 0.01$ 天$^{-1}$ 时：\n$$ CI_U = 1 - e^{-120 \\times 0.01} = 1 - e^{-1.2} $$\n使用近似值 $e^{-1.2} \\approx 0.3012$：\n$$ CI_U \\approx 1 - 0.3012 = 0.6988 $$\n\n**3. 朴素风险比（$RR_{naive}$）**\n\n有偏倚的风险比是这两个累积发生率的比值：\n$$ RR_{naive} = \\frac{CI_E}{CI_U} = \\frac{1 - e^{-0.6}}{1 - e^{-1.2}} \\approx \\frac{0.4512}{0.6988} \\approx 0.6456 $$\n朴素风险比约为 $0.65$。由于真实的风险比是 $1.0$，这代表了一种伪保护效应。产生这种偏倚的原因是，治疗组被保证了一段“不朽”的生存期，并在分析中因此受益，而未治疗组在同一时期内却在累积死亡。\n\n**4. 有效的校正策略**\n\n偏倚源于随访起点的错位。在随机对照试验（RCT）中，资格确定、治疗分配（随机化）和随访开始都在同一时刻（时间零点）。为消除不朽时间偏倚，观察性分析必须模拟这种结构。\n\n-   **对齐时间零点**：正确的方法是在治疗开始时（即第 $t^\\star = 60$ 天）为治疗组和未治疗组同时开始随访。分析将只包括在第 $60$ 天仍然存活且符合资格的个体。治疗组将是开始治疗的 $n_T$ 名患者。未治疗的比较组将从同样在第 $60$ 天存活、符合资格但未开始治疗的其他患者中抽取。然后，对于两组，我们将比较后续时期（例如，从第 $60$ 天到第 $120$ 天）的死亡风险。这就是 **目标试验模拟 (Target Trial Emulation, TTE)** 背后的原理，即“为未治疗的对照组分配可比的指数日期”。\n-   **时变协变量模型**：另一种分析方法是在生存模型（如 Cox 比例风险模型）中将暴露状态视为时变协变量。个体从第 $0$ 天到第 $59$ 天为“未暴露”风险集贡献人-时。在第 $60$ 天，如果他们接受治疗，他们就转换到“暴露”风险集。这能正确分配人-时并避免不朽时间偏倚。\n\n### 逐项分析\n\n**A. 朴素的“从基线开始曾接受治疗”的累积发生率比值约为 $0.65$（伪保护性），因为暴露组的定义是存活过 $t^\\star$，这产生了不朽时间；一种有效的校正方法是将时间零点与治疗分配对齐，以模拟一项随机试验：可以将治疗建模为时变暴露，或使用一种设计，在相同的 $t^\\star$ 为未治疗的对照组分配可比的指数日期（目标试验模拟，Target Trial Emulation, TTE）。**\n-   **风险比计算**：计算出的风险比约为 $0.65$。这与选项匹配。方向“伪保护性”是正确的。\n-   **解释**：所提供的理由，“暴露组的定义是存活过 $t^\\star$，这产生了不朽时间”，是完全正确的。\n-   **校正策略**：建议的校正方法，包括将治疗建模为时变暴露和目标试验模拟，是处理此类偏倚的标准、最先进的方法。\n-   **结论**：**正确**。\n\n**B. 朴素的累积发生率比值约为 $1.00$（无偏倚）；仅调整基线混杂因素就足以校正任何问题，而无需改变时间原点。**\n-   **风险比计算**：比值不是 $1.00$。我的计算显示存在显著偏倚，得出的比值约为 $0.65$。\n-   **解释/校正**：该偏倚是结构性的（不朽时间），而非由混杂引起。调整基线混杂因素无法校正它。必须解决时间原点的问题。\n-   **结论**：**不正确**。\n\n**C. 朴素的累积发生率比值约为 $2.00$（伪有害性），因为暴露患者累积了更多的人-时；一种有效的校正方法是在治疗开始时对暴露组的随访进行左截断，同时保持未暴露组的随访从队列入组时开始。**\n-   **风险比计算**：比值约为 $0.65$（保护性），而不是 $2.00$（有害性）。\n-   **解释/校正**：其推理有缺陷。所提出的校正方法——为一个组对齐时间而不为另一组对齐——本身就是一种有偏倚的设计，不能解决问题。\n-   **结论**：**不正确**。\n\n**D. 朴素的累积发生率比值约为 $0.50$（强保护性）由于排除了暴露组在 $t^\\star$ 之前的事件；一种有效的校正方法是在两组中都排除 $t^\\star$ 之前的死亡，同时将时间零点保持在队列入组时。**\n-   **风险比计算**：数值 $0.50$ 不是累积发生率比值。它是累积风险的比值（$H_E/H_U = (\\lambda \\times 60) / (\\lambda \\times 120) = 0.5$）。虽然相关，但风险比是明确要求计算的量，而我的计算得出的是约 $0.65$。\n-   **解释/校正**：对偏倚原因的陈述是正确的。所描述的校正方法是界标分析（landmark analysis），这是一种有效的方法。然而，基于对“累积发生率（风险）比”的严格解释，其定量声明是不准确的。选项 A 在定量上和对校正措施的描述上都更为精确。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然随机对照试验（RCT）是因果推断的黄金标准，但现实世界中的试验远非完美，治疗依从性不佳和方案交叉等问题为结果的解读带来了挑战。本练习探讨了在存在治疗中断和补救性治疗的情况下，“意向性治疗”（ITT）分析的真正含义及其局限性。通过这个案例，你将学会辨析不同因果估计值（estimands）的临床意义和统计要求，并理解为何估计“接受治疗”而非“分配治疗”的效应会引入新的偏倚风险。",
            "id": "4616199",
            "problem": "一个公共卫生团队进行了一项两臂随机对照试验 (RCT)，旨在评估一种血管紧张素受体阻滞剂相对于常规治疗在2级高血压成年患者中的效果。主要结局是12个月内发生主要不良心血管事件。该试验就随机分配而言是双盲的。然而，一项预先设定的补救策略允许常规治疗组的患者在反复血压检查仍高于安全阈值时换用活性药物；实践中，约有30%的常规治疗组患者因此换用了活性药物。在随机分配至活性药物组的患者中，约有20%因咳嗽和头晕而停药。补救性换药和停药都更可能发生在血压轨迹较差和短期心血管风险较高的参与者中。在12个月时，结局的确定几乎是完整的。研究者计划进行意向性治疗 (ITT) 分析，并正在考虑该分析是否可能低估具有临床意义的效应，以及何时备选的目标估计量会更可取。\n\n仅使用流行病学和试验设计中的核心因果定义（例如，由随机分配和实际接受的治疗索引的潜在结局，基线时通过随机化实现的可交换性，以及符合方案集、实际治疗和主分层估计量的定义），选择所有关于ITT可能低估临床相关效应以及何时备选目标估计量更可取的、最恰当的陈述，包括解释陷阱的风险。\n\nA. 在常规治疗组中存在大量随机化后换用活性药物以及活性药物组中存在停药的情况下，ITT目标估计量（分配效应）可能会稀释按预期服用药物的生物学效应。对于依从治疗的效应，符合方案集目标估计量或依从者平均因果效应目标估计量可能更具临床相关性，但有效的估计需要考虑影响依从性和换药的预后因素，否则会引入选择偏倚。\n\nB. 因为补救治疗是由预先设定的规则触发的，所以在补救性换药时对随访进行删失，并比较剩余的活性药物组与常规治疗组患者，凭借基线随机化，可以得到一个无偏的符合方案集效应；无需对随机化后的预后因素进行额外调整。\n\nC. 如果在12个月时有一个次要的患者报告结局，该结局仅在12个月时存活的患者中定义，那么在该结局上的ITT对比可能会低估在无论分配如何都会存活的那些人中的效应。一个更具临床针对性的目标估计量是在无论分配如何都会存活的个体主分层内的生存者平均因果效应，但识别该目标估计量通常需要强的、无法验证的假设，并且容易出现解释陷阱。\n\nD. 因为试验在基线时是双盲的，所以依从性行为在设计上与预后无关；因此，一项不加调整地按实际接受的治疗来比较患者的实际治疗分析，将一致地估计所接受治疗的因果效应。\n\nE. 对于有关在真实世界依从性情况下提供药物的政策决策，ITT目标估计量是合适的。对于估计在被提供药物时会服用的患者（依从者）中的效应，使用随机化作为工具变量的依从者平均因果效应可能更可取，但必须谨慎：由于常规治疗组中血压恶化会触发换药，如果分配通过接受治疗之外的补救途径影响结局，那么诸如排他性限制等假设可能被违反，从而导致解释陷阱。",
            "solution": "问题陈述描述了一个存在随机化后事件的随机对照试验 (RCT)，特别是活性药物组的治疗中断和对照组的治疗转换（交叉）。这些事件并非随机发生；它们与预后因素相关。任务是评估在这种情况下关于意向性治疗 (ITT) 目标估计量和替代目标估计量的几个陈述。\n\n首先，让我们使用潜在结局框架来形式化这个场景。\n设 $Z_i$ 为参与者 $i$ 的随机分配，如果分配到血管紧张素受体阻滞剂 (ARB)，则 $Z_i=1$，如果分配到常规治疗，则 $Z_i=0$。\n设 $D_i$ 为参与者 $i$ 实际接受的治疗。由于停药和换药，$D_i$ 不一定等于 $Z_i$。\n设 $Y_i$ 为参与者 $i$ 的结局，即到12个月时发生主要不良心血管事件 (MACE)。潜在结局表示为 $Y_i(z)$，即参与者 $i$ 在分配 $z$ 下本应观察到的结局。\n\n问题陈述指出：\n-   该试验是一个两臂RCT。随机化确保在基线时，由 $Z$ 定义的两个组在平均上是可交换的：$E[Y(z=1)] = E[Y(z=1)|Z=1] = E[Y(z=1)|Z=0]$ 和 $E[Y(z=0)] = E[Y(z=0)|Z=1] = E[Y(z=0)|Z=0]$。\n-   ITT目标估计量是治疗*分配*的平均因果效应：$E[Y(z=1) - Y(z=0)]$。这通过比较两个随机组的平均结局来估计：$E[Y|Z=1] - E[Y|Z=0]$。因为随机化成立，这是对分配效应的无偏估计。\n-   在常规治疗组 ($Z=0$)，约有30%的患者换用活性药物。\n-   在活性药物组 ($Z=1$)，约有20%的患者停药。\n-   关键在于，“补救性换药和停药都更可能发生在血压轨迹较差和短期心血管风险较高的参与者中。” 这意味着依从性行为是一个随机化后变量，同时也是结局的一个预后因素。\n\n现在，我们将评估每个选项。\n\n**A. 在常规治疗组中存在大量随机化后换用活性药物以及活性药物组中存在停药的情况下，ITT目标估计量（分配效应）可能会稀释按预期服用药物的生物学效应。对于依从治疗的效应，符合方案集目标估计量或依从者平均因果效应目标估计量可能更具临床相关性，但有效的估计需要考虑影响依从性和换药的预后因素，否则会引入选择偏倚。**\n该陈述提出了三个主张：\n1.  ITT目标估计量可能会稀释生物学效应。ITT分析比较的是名义上100%被分配药物（但实际上只有约80%的患者在整个期间服药）的组与名义上0%被分配药物（但约有30%最终接受了药物）的组。真实的暴露对比不是100%对0%，而是接近80%对30%。这自然会导致估计的效应量级比100%依从对0%依从的假设效应更小（被稀释）。这个主张是正确的。\n2.  符合方案集 (PP) 或依从者平均因果效应 (CACE) 目标估计量对于依从治疗的效应可能更具临床相关性。这些目标估计量旨在估计*接受*或*依从*治疗的效应，而不是被*分配*到治疗的效应。对于想知道实际服用药物后果的临床医生和患者来说，这种效应通常非常重要。这个主张是正确的。\n3.  PP或CACE的有效估计需要考虑影响依从性的预后因素，否则会引入选择偏倚。这是核心挑战。如问题所述，依从性和换药与预后相关。一种简单地根据接受的治疗来比较各组的朴素PP或“实际治疗”分析将是有偏的。例如，在实际治疗分析中，接受ARB的组将包括来自$Z=1$组中较健康的患者和来自$Z=0$组中需要补救治疗的病情较重的患者。这打破了随机化并引入了混杂或选择偏倚。要有效估计这些效应，需要先进的统计方法（例如，用于PP的逆概率加权，用于CACE的工具变量分析），这些方法必须恰当地考虑驱动不依从性的因素。这个主张是正确的。\n鉴于该陈述的所有部分都是准确的，整个陈述是正确的。\n**结论：正确。**\n\n**B. 因为补救治疗是由预先设定的规则触发的，所以在补救性换药时对随访进行删失，并比较剩余的活性药物组与常规治疗组患者，凭借基线随机化，可以得到一个无偏的符合方案集效应；无需对随机化后的预后因素进行额外调整。**\n该陈述描述了一种朴素的符合方案集分析，其中参与者在偏离方案时被删失。其主张是，因为规则是“预先设定的”，所以这种做法是无偏的。这是不正确的。换药的原因是高血压，这是结局 (MACE) 的一个强预测因子。通过从常规治疗组中删失病情最重的患者（即那些换药的患者），同时保留活性药物组中病情相当的患者，该分析将比较一个比平均水平更健康的常规治疗组和一个承担全部风险的活性药物组。这会引入严重的选择偏倚，使得治疗看起来效果较差甚至有害。规则是预先设定的这一事实并不能防止偏倚；规则本身通过以一个随机化后的预后因素为条件，使选择偏倚制度化了。基线随机化不能防止随机化后的偏倚。\n**结论：不正确。**\n\n**C. 如果在12个月时有一个次要的患者报告结局，该结局仅在12个月时存活的患者中定义，那么在该结局上的ITT对比可能会低估在无论分配如何都会存活的那些人中的效应。一个更具临床针对性的目标估计量是在无论分配如何都会存活的个体主分层内的生存者平均因果效应，但识别该目标估计量通常需要强的、无法验证的假设，并且容易出现解释陷阱。**\n此选项讨论了当感兴趣的结局仅为存活者定义时存在的竞争风险（死亡）问题。\n1.  仅在存活者中分析结局是在一个随机化后变量上取条件。如果治疗影响生存率，那么即使完整的组在基线时由于随机化是可比较的，两个臂中的存活者组也可能不再具有可比性。例如，如果药物挽救了本会死亡的体弱者（而这些人会报告较差的结局），那么治疗组存活者群体中的平均患者报告结局可能会看起来更差，导致有偏的估计。偏倚的方向不总是“低估”，但总体上，存活者中的ITT对比对于任何明确定义的因果人群的效应都是有偏的，这一点是正确的。\n2.  该陈述提出生存者平均因果效应 (SACE) 作为一个更具针对性的目标估计量。SACE定义在“始终存活者”的主分层上，即那些无论其治疗分配（$Z=0$或$Z=1$）如何，都会存活到12个月的个体。这是正确的、因果定义明确的目标估计量，它避免了在随机化后事件上取条件。\n3.  该陈述正确地指出，识别这个目标估计量是困难的。我们无法从经验上识别出“始终存活者”这一分层。其估计依赖于关于生存与结局之间关系的强的、通常无法检验的假设（例如，治疗对生存效应的单调性）。这使得SACE方法在方法论上具有挑战性，其结果的解释也取决于那些假设的有效性。\n整个陈述是对因果推断中一个关键问题的正确而细致的描述。\n**结论：正确。**\n\n**D. 因为试验在基线时是双盲的，所以依从性行为在设计上与预后无关；因此，一项不加调整地按实际接受的治疗来比较患者的实际治疗分析，将一致地估计所接受治疗的因果效应。**\n这个陈述存在根本性缺陷。双盲防止了对分配的知晓影响行为。然而，它并不能阻止治疗的生理效应（或缺乏效应）影响行为。在这里，停药是由仅在服用活性药物者身上出现的副作用（“咳嗽和头晕”）引起的。换药是由常规治疗组中出现的疗效不佳（“血压检查仍高于安全阈值”）引起的。问题明确指出，这些行为在预后较差的人中更可能发生。因此，依从性*并非*与预后无关。一项按实际接受的治疗对患者进行分组的实际治疗分析，破坏了随机化，比较的是在基线预后上存在系统性差异的组。这种未经调整所有混杂因素（在这里是随机化后的时变因素）的分析将产生严重的偏倚。\n**结论：不正确。**\n\n**E. 对于有关在真实世界依从性情况下提供药物的政策决策，ITT目标估计量是合适的。对于估计在被提供药物时会服用的患者（依从者）中的效应，使用随机化作为工具变量的依从者平均因果效应可能更可取，但必须谨慎：由于常规治疗组中血压恶化会触发换药，如果分配通过接受治疗之外的补救途径影响结局，那么诸如排他性限制等假设可能被违反，从而导致解释陷阱。**\n该陈述评估了ITT和CACE在这一特定背景下的效用。\n1.  “对于政策决策...，ITT目标估计量是合适的。” 这是ITT分析的经典理由。它估计了提供一种药物的*策略*或*政策*的有效性，考虑了在相似人群中预期的不依从性水平。这对于公共卫生和政策制定高度相关。这个主张是正确的。\n2.  “对于估计...依从者中的效应，使用随机化作为工具变量的CACE可能更可取...”。CACE，使用随机分配作为工具变量 (IV) 进行估计，其目标是估计在会遵守任何分配给他们的治疗的个体亚群中的因果效应。这是估计“功效”效应的一种有效方法，它可能比“效果”ITT效应更具科学或临床相关性。这个主张是正确的。\n3.  “...必须谨慎：...诸如排他性限制等假设可能被违反...”。IV的排他性限制假设指出，工具变量（随机分配$Z$）仅通过其对所接受治疗（$D$）的影响来影响结局（$Y$）。在这个试验中，为$Z=0$组触发了“补救策略”。该策略涉及“反复血压检查”。这种加强的监测以及“补救策略”下的整个管理方案，很可能通过仅仅接受活性药物之外的途径影响患者的结局 (MACE)。例如，增加的临床关注可能导致关于饮食/锻炼或其他共同干预措施的建议。如果是这样，就存在一条不经过$D$的路径 $Z \\rightarrow \\text{补救策略} \\rightarrow Y$。这将违反排他性限制，导致CACE估计有偏。该陈述正确地指出了这个重要而微妙的风险。\n整个陈述对情况进行了正确而深入的分析。\n**结论：正确。**\n\n综上所述，陈述A、C和E是对该试验场景中方法学问题和解释陷阱的恰当和正确的描述。",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}