## 引言
在科学探索中，确立暴露与结局之间的因果关系是许多领域的核心目标，尤其是在流行病学和公共卫生领域。然而，如何设计一项研究来可靠地回答“是否有效”或“是否有害”的问题，是研究者面临的首要挑战。研究设计的根本选择——是在现实世界中被动观察，还是主动进行实验干预——深刻地影响着我们结论的有效性。这篇文章旨在系统性地梳理观察性设计与实验性设计之间的根本区别，并阐明它们在因果推断中的各自角色、优势与挑战。

在接下来的章节中，我们将深入这一核心议题。在“**原理与机制**”一章中，我们将解构这两种设计的理论基石，探讨随机化为何能成为“金标准”，以及观察性研究为模拟这一标准所必须克服的混杂等障碍。随后，在“**应用与跨学科联系**”一章，我们将跨越从临床医学到生态学的多个学科，通过丰富的案例展示这些设计原则如何在实践中灵活应用，解决真实的科学难题。最后，“**动手实践**”部分将提供具象化的练习，帮助读者巩固对混杂偏倚等关键挑战的理解，将理论知识转化为分析技能。

## 原理与机制

### 核心二分法：研究者对暴露的控制

在流行病学和许多其他科学领域中，评估一项暴露（如一种药物、一项政策或一种生活方式）与一个结局（如一种疾病的发生）之间是否存在因果关系，是研究的核心目标。研究设计的选择是实现这一目标的基础。所有研究设计都可以根据一个根本性的标准进行划分：**研究者是否控制暴露的分配**。这一标准将研究设计分为两大类：**实验性设计** (experimental designs) 和 **观察性设计** (observational designs)。

在**实验性设计**中，例如备受推崇的**随机对照试验 (Randomized Controlled Trial, RCT)**，研究者主动地、有控制地将研究对象分配到不同的暴露组。例如，在评估一种新型降压药是否能降低中风风险的研究中，研究者会通过一个已知的随机化方案，将参与者分配到服用新药的组或服用安慰剂（或标准疗法）的组 。研究者不仅决定了谁接受干预，还精确地控制了分配过程本身。

相比之下，在**观察性设计**中，研究者扮演着一个被动的观察者角色。暴露的分配不受研究者控制，而是由现实世界中的多种因素决定，例如医生的临床决策、患者的个人选择或环境因素。例如，要研究一种工业溶剂的职业暴露是否增加慢性肾病的风险，研究者不能为了研究目的而刻意让工人接触潜在的有害物质。他们只能观察那些在日常工作中已经接触或未接触该溶剂的工人，并比较其结局 。

为了严谨地探讨这一区别对因果推断的影响，我们引入**潜在结局 (potential outcomes)** 框架。对于每个个体，我们可以设想在不同暴露水平 $a$ 下可能发生的结局，记为 $Y^a$。例如，$Y^1$ 是该个体如果接受暴露（$A=1$）将会出现的结局，而 $Y^0$ 则是该个体如果未接受暴露（$A=0$）将会出现的结局。对于单个个体而言，我们永远无法同时观测到 $Y^1$ 和 $Y^0$，这被称为“因果推断的根本问题”。因此，我们的目标通常是估计群体的**平均因果效应 (Average Causal Effect, ACE)**，其数学定义为一个**估计量 (estimand)**：$E[Y^1] - E[Y^0]$。这个估计量是一个我们希望了解的、关于目标群体的抽象的、真实的目标参数。与此相对的是**估计方法 (estimator)**，它是我们根据样本数据计算出的一个具体数值（如两组样本均值之差），用以推断估计量的值 。

### 金标准：随机化与可交换性

实验性设计，特别是RCT，之所以被誉为因果推断的“金标准”，其威力根植于**随机化 (randomization)** 的过程。随机化的核心作用是在研究设计层面确保了组间的**[可交换性](@entry_id:263314) (exchangeability)**。[可交换性](@entry_id:263314)意味着，在暴露分配之前，不同组别在所有可能影响结局的特征（无论是已知的还是未知的）上平均而言是相似的。用潜在结局的语言来说，这意味着暴露分配 $A$ 与潜在结局集合 $\{Y^0, Y^1\}$ 是统计上独立的，记为 $A \perp \{Y^0, Y^1\}$。

我们可以从第一性原理来理解这一点。一个理想的随机化装置（例如，抛硬币）决定了每个参与者接受何种暴露。这个分配概率，例如 $P(A=1)$，是研究者设定和已知的，并且它完全不依赖于参与者的任何内在特征，包括他们不可见的潜在结局。因此，按定义，对于任何个体，其被分配到某个暴露组的概率与其潜在结局无关：$P(A=a | Y^0, Y^1) = P(A=a)$ 。这种由设计保证的独立性，正是[可交换性](@entry_id:263314)的数学表达。在某些设计中，随机化可能在特定基线协变量 $L$ 的分层内进行（例如，按年龄组分别随机化），此时我们获得的是**条件可交换性**：$A \perp \{Y^0, Y^1\} | L$。

[可交换性](@entry_id:263314)直接解决了因果推断中的核心难题——**混杂 (confounding)**。在观察性研究中，接受暴露的组和未接受暴露的组可能在很多方面都存在系统性差异。例如，在药物研究中，病情更重的患者可能更倾向于接受一种新药。这些差异（即**混杂因素 (confounders)**）既与暴露选择有关，又与结局有关，导致对暴露效应的朴素比较产生偏倚。

让我们来量化这种偏倚。我们通常从数据中计算的关联性度量是观测结局的均值之差：$E[Y | A=1] - E[Y | A=0]$。利用潜在结局和一致性假设（见下文），这个表达式可以分解为 ：
$$ (E[Y^1 | A=1] - E[Y^0 | A=1]) + (E[Y^0 | A=1] - E[Y^0 | A=0]) $$
这个公式的第一项 $E[Y^1 - Y^0 | A=1]$ 是“处理组的平均[处理效应](@entry_id:636010) (ATT)”，它是一个因果量。第二项 $(E[Y^0 | A=1] - E[Y^0 | A=0])$ 则被称为**选择偏倚 (selection bias)**。它代表了即使两组人都没有接受暴露，他们的基线结局风险也存在差异。在观察性研究中，由于混杂的存在，这个偏倚项通常不为零。因此，我们观测到的关联（例如，用一个简单的[两样本t检验](@entry_id:164898)得到的结果）混合了真实的因果效应和选择偏倚，不能直接解释为因果关系。

随机化的魔力就在于，通过确保可交换性，它使得选择偏倚项在期望上为零：
$$ E[Y^0 | A=1] - E[Y^0 | A=0] = E[Y^0] - E[Y^0] = 0 $$
同时，它也保证了 $E[Y^1 | A=1] = E[Y^1]$。因此，在RCT中，观测到的关联直接等于因果效应：
$$ E[Y | A=1] - E[Y | A=0] = E[Y^1] - E[Y^0] = \text{ACE} $$
这就是为什么在理想的RCT中，组间均值差异的简单比较（及其对应的t检验和[置信区间](@entry_id:138194)）就可以提供对平均因果效应的[无偏估计](@entry_id:756289) 。

### 观察性研究的挑战：模拟目标试验

由于伦理或可行性原因，许多重要的科学问题无法通过RCT来回答。在这种情况下，[观察性研究](@entry_id:174507)是唯一的选择。现代流行病学将严谨的[观察性研究](@entry_id:174507)设计视为一次**模拟目标试验 (emulating a target trial)** 的尝试。我们的目标是利用统计方法，在数据分析阶段实现RCT在设计阶段通过随机化所达到的效果——即[可交换性](@entry_id:263314)。

为了从观察性数据中识别因果效应，通常需要三个核心的、不可完全验证的假设  ：

1.  **一致性 (Consistency)**：该假设将我们观测到的数据与潜在结局的理论世界联系起来。它规定，如果一个人的实际暴露水平是 $A=a$，那么我们观测到的他的结局 $Y$ 就等于他的潜在结局 $Y^a$。这个假设看似理所当然，但它隐含了一个重要条件，即暴露的“版本”是唯一的，不存在不同方式接受相同暴露水平 $a$ 却导致不同结局的情况。一致性与**稳定单位治疗价值假设 (SUTVA)** 密切相关，后者还包括“无干扰”的假设，即一个个体的结局不受其他个体暴露状态的影响。

2.  **条件可交换性 (Conditional Exchangeability)** 或称**无未观测混杂 (No Unmeasured Confounding)**：这是[观察性研究](@entry_id:174507)中最关键也最脆弱的假设。由于我们无法实现 $A \perp \{Y^0, Y^1\}$，我们退而求其次，假设在充分控制了一系列测量的、暴露前的[共同原因](@entry_id:266381)（即混杂因素）$L$ 之后，暴露分配在每个协变量层内是“仿佛随机的”。其形式化表达为 $A \perp \{Y^0, Y^1\} | L$。例如，在一个因果图中，如果变量 $X$ 是 $A$ 和 $Y$ 的[共同原因](@entry_id:266381)（即存在路径 $A \leftarrow X \rightarrow Y$），那么 $X$ 就是一个混杂因素。通过在分析中对 $X$ 进行“调整”（如分层、匹配或回归），我们可以阻断这条“后门路径”，从而在 $X$ 的每个水平内恢复可交换性 。这个假设的成败完全取决于我们是否成功测量并调整了所有重要的混杂因素。

3.  **正性 (Positivity)** 或称**重叠性 (Overlap)**：这个假设确保在由协变量 $L$ 定义的每个子群体中，都存在接受各种暴露水平的个体。形式上，对于所有使得 $P(L=l) > 0$ 的协变量组合 $l$，我们必须有 $P(A=a | L=l) > 0$ 对于所有我们关心的暴露水平 $a$ 都成立。正性是一个实践性假设，它保证了我们有数据来进行比较。如果在一个子群体中（例如，所有75岁以上的男性），所有人都接受了治疗（$P(A=1 | L=l_{\text{male}, 75+}) = 1$），那么我们就没有任何关于这个群体“假如没有接受治疗会怎样”的信息。在这种**正性违规**的情况下，我们无法非参数地识别该子群体的因果效应，进而也无法识别总体的平均因果效应 。相比之下，RCT通过将分配概率（例如$0.5$）强制设定为介于0和1之间，从设计上保证了正性的成立。

### 从识别到估计：因果推断的方法

当上述三个识别假设被认为成立时，我们就可以将不可观测的因果估计量 $E[Y^1] - E[Y^0]$ 表示为只包含可观测数据分布的函数。这个过程称为**识别 (identification)**。

一个经典的识别公式是**标准化 (standardization)**，也称为**g-公式 (g-formula)**。其逻辑非常直观：我们首先在每个由混杂因素 $X$ 定义的亚层（stratum）内计算因果效应，然后在这些亚层之间进行加权平均，权重是每个亚层在目标人群中的比例。其数学推导如下 ：
$$ \text{ACE} = \sum_{x \in \mathcal{X}} (E[Y | A=1, X=x] - E[Y | A=0, X=x]) P(X=x) $$
其中，$E[Y | A=a, X=x]$ 是在协变量为 $x$ 的个体中，接受暴露 $a$ 后的平均观测结局，而 $P(X=x)$ 是协变量 $X=x$ 在人群中的分布。这个公式中的每一项都可以从观测数据中估计出来。

除了标准化，还有许多其他估计方法，例如**逆概率治疗加权 (Inverse Probability of Treatment Weighting, IPTW)**。这些不同的统计程序（估计方法），如g-计算和IPTW，虽然计算方式不同，但它们都旨在估计同一个目标参数（因果估计量）。在满足识别条件且各自的[统计模型](@entry_id:755400)（分别为结局模型和暴露模型）设定正确时，它们都能提供对平均因果效应的一致估计 。

### 混杂之外：其他对有效性的威胁

即使是设计精良的RCT，其有效性也可能受到执行过程中问题的挑战。

**分配隐藏 (Allocation Concealment)** 和 **盲法 (Blinding)** 是保护RCT完整性的两个关键程序 。分配隐藏指的是在参与者入组时，研究人员无法预测或知晓即将分配给该参与者的暴露组别。这能有效防止**选择偏倚 (selection bias)**，即研究者可能有意或无意地将某些特征的患者（如病情更轻的）分配到他们偏好的治疗组，从而破坏了随机化建立的基线可比性。

盲法则是指在研究开始后，参与者、研究人员、结局评估者中的一方或多方不知道参与者的分组情况。盲法对于防止**测量偏倚 (measurement bias)** 至关重要，尤其是**探知偏倚 (ascertainment bias)**。例如，在一项评估新抗生素疗效的试验中，如果结局评估医生知道患者正在接受新药，他们可能会更积极地为该患者安排影像学检查。这种不平等的结局探查会导致即使药物无效，新药组的“确诊率”也可能被人为地抬高，从而产生虚假的效应 。

此外，RCT中普遍存在**不依从 (nonadherence)** 问题，即参与者并未完全遵守分配给他们的干预。这使得研究者必须区分两种不同的效应：**意向性治疗分析 (Intent-to-Treat, ITT)** 估计的是“被分配”到某个干预组的效应，它保留了随机化的所有优点，但可能低估了干预本身的生物学效应。而估计“实际接受”干预的效应则更为复杂，因为它再次面临类似[观察性研究](@entry_id:174507)中的“自选择”混杂问题。

### 选择合适的设计：伦理与可行性

最终，研究设计的选择不仅是科学问题，也受到伦理和可行性的严格约束。

**伦理考量**是首要的。**临床均衡 (clinical equipoise)** 原则指出，只有当专家界对于两种或多种干预措施的相对优劣存在真实的不确定性时，将参与者随机分配到这些组别中才是合乎伦理的 。当已有充分证据（例如来自动物实验）表明某项暴露可能有害时，为了研究目的而将人们随机分配去接触该暴露是严重违反**不伤害原则 (non-maleficence)** 的。因此，对于研究吸烟、空气污染或有毒化学品效应等问题，RCT在伦理上是不可接受的，[观察性研究](@entry_id:174507)成为我们唯一的选择。

**可行性**是另一个限制因素。有些暴露根本无法被随机化，例如基因、性别或自然灾害。

面对这些限制，研究者发展出了一系列被称为**准实验 (quasi-experiments)** 的高级观察性设计，它们利用现实世界中的某些特殊情境来创造出近似随机化的条件，从而增强因果推断的强度 。

- **回归断点设计 (Regression Discontinuity Design, RDD)**：当暴露的分配取决于一个连续变量是否超过某个特定阈值时（例如，根据抑郁评分决定是否开具抗抑郁药），我们可以比较刚好在阈值两侧的个体。其核心思想是，这些在阈值附近“擦边而过”的个体在其他所有方面都非常相似，他们的唯一系统性差异就是是否接受了暴露，从而在局部形成了一个“仿佛随机”的比较。

- **[工具变量分析](@entry_id:166043) (Instrumental Variable, IV) Analysis**：该方法利用一个“[工具变量](@entry_id:142324)” $Z$。这个变量 $Z$ 必须满足三个条件：它与暴露 $A$ 相关；它独立于所有影响结局 $Y$ 的混杂因素（仿佛是随机分配的）；它只能通过影响暴露 $A$ 来影响结局 $Y$。一个经典的例子是使用每日风向作为研究空气污染源影响的工具变量。风向影响了社区的污染水平（暴露），但风向本身（在调整了天气等因素后）不应直接导致健康结局。IV分析通常估计的是“依从者平均因果效应 (CACE)”——即那些其暴露行为受工具变量影响的亚群体的因果效应 。

这些精巧的设计，连同对混杂、正性、一致性等基本原则的深刻理解，共同构成了现代流行病学家在面对无法进行随机试验的世界时，进行严谨因果推断的强大工具箱。