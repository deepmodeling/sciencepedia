## 引言
在流行病学研究中，衡量疾病发生的频率是理解其分布和决定因素的核心。然而，在动态变化的人群中，简单地统计新发病例数往往会产生误导，因为它忽略了产生这些病例的人群基础以及他们被观察的总时长。当研究对象的随访时间长短不一时，我们如何才能科学、准确地比较不同人群的疾病发生速率？

本文旨在解决这一核心方法学问题，系统介绍“人时累积”这一基本而强大的概念。通过掌握人时，研究者可以从简单的病例计数转向对风险强度的精确量化。本文将引导您全面理解人时累积的理论与实践。我们将首先在“原理和机制”一章中，深入探讨人时的基本定义、计算方法、与累积发病率的区别，并揭示永生时间偏倚等常见陷阱。接下来，在“应用与跨学科联系”一章中，我们将展示人时在分层分析、[竞争风险](@entry_id:173277)模型、统计建模以及药物流行病学等领域的广泛实际应用。最后，“动手实践”部分将提供具体的计算练习，以巩固您的理解并提升数据分析技能。

## 原理和机制

在流行病学研究中，疾病或其他健康事件的发生频率是核心测量指标之一。然而，仅仅计算新发病例数是不够的，因为这忽略了产生这些病例的人群基础以及他们被观察的总时长。为了以一种标准化且可比较的方式量化疾病发生的速率，我们必须引入一个关键概念：**人时（Person-time）**。本章将深入探讨人时累积的原理、计算机制及其在流行病学研究中的高级应用，同时阐明与其相关的关键方法论问题。

### 基本概念：人时的定义与计算

#### 什么是人时？超越简单的个体计数

在动态变化的队列中，个体因各种原因（如研究开始后加入、失访、死亡或研究结束）被观察的时间长短不一。在这种情况下，我们如何精确测量人群所经历的风险总量？答案是累积所有研究对象处于风险状态并被观察的总时间。这个总量就是**人时**。

人时的核心思想是，它是一个将人群中每个个体贡献的风险时间相加的总和。一个“人-月”（person-month）代表一个人在一个月内处于风险状态。如果10个人在同一个日历月内都处于风险中，他们共同贡献了10人-月的观察时间。风险是由每个个体独立承担的，因此，即使他们的观察期在日历时间上重叠，他们各自贡献的风险时间也应被加总，而不是为了避免“重复计算”而进行删减。

为了更清晰地理解这一点，我们来看一个假设的呼吸道病毒监测项目。在一个为期12个月的研究中，6名医护人员的风险观察时间如下：

-   人员1：从第0月进入，第4月感染（贡献4人-月）。
-   人员2：从第0月进入，至第12月仍未感染（贡献12人-月）。
-   人员3：从第0月进入，第6月失访（贡献6人-月）。
-   人员4：从第0月进入，第0.5月感染（贡献0.5人-月）。
-   人员5：从第5月进入，至第12月仍未感染（贡献7人-月）。
-   人员6：从第0月进入，第9月移居国外（贡献9人-月）。

该队列的总人时是所有个体贡献时间的简单加和：
$PT_{总} = 4 + 12 + 6 + 0.5 + 7 + 9 = 38.5 \text{ 人-月}$

这38.5人-月是该队列在研究期间所经历的风险总量，它将成为计算发病率的分母。相比之下，**个体计数（person-count）**仅指研究中的独立个体数量，在此例中为6人。显然，人时提供了一个比个体计数更具信息量的分母，因为它精确地量化了“风险暴露”的持续时间。

#### 发病率：衡量风险的强度

有了人时作为分母，我们就可以定义流行病学中一个最基本的测量指标：**发病率（Incidence Rate）**，有时也称为**发病密度（Incidence Density）**。其计算公式为：

$IR = \frac{\text{新发病例数}}{\text{总风险人时}}$

发病率的单位是时间的倒数（例如，每人-年或 $年^{-1}$），它衡量的是在人群中事件发生的瞬时潜力或“强度”。这与另一个重要的发病测量指标——**累积发病率（Cumulative Incidence, CI）**或**风险（Risk）**形成对比。累积发病率定义为在一个特定时间段内，初始风险人群中新发病例所占的比例：

$CI = \frac{\text{特定时期内的新发病例数}}{\text{期初风险人群总数}}$

累积发病率是一个无量纲的比例，取值范围在0到1之间，其含义必须与一个确定的随访时间段相关联。

让我们通过一个封闭队列研究的例子来阐明两者的区别。假设一个由50名健康成人组成的队列被随访12个月，期间没有失访。共有8例感染发生，分别在第2、3、4、6、7、8、10、11个月。

首先，计算总人时。8名感染者在感染前贡献的风险[时间总和](@entry_id:148146)为：
$PT_{病例} = 2 + 3 + 4 + 6 + 7 + 8 + 10 + 11 = 51 \text{ 人-月}$

其余的 $50 - 8 = 42$ 人在整个12个月的随访期内均未感染，他们贡献的人时为：
$PT_{非病例} = 42 \text{ 人} \times 12 \text{ 月/人} = 504 \text{ 人-月}$

因此，队列的总人时为 $PT_{总} = 51 + 504 = 555$ 人-月。

该队列的发病率为：
$IR = \frac{8 \text{ 例}}{555 \text{ 人-月}} \approx 0.0144 \text{ 每人-月}$

而12个月的累积发病率为：
$CI = \frac{8 \text{ 例}}{50 \text{ 人}} = 0.16$

请注意，累积发病率 $CI$ 并不等于发病率 $IR$ 乘以随访时长 $T$。在此例中，$IR \times T = \frac{8}{555} \times 12 \approx 0.173$，这与真实的 $CI=0.16$ 不同。$CI \approx IR \times T$ 只是在发病率很低时的一个近似。这个例子清晰地表明，发病率和累积发病率是衡量疾病频率的两个不同维度的指标：前者衡量强度，后者衡量在特定时期内发生的累积概率。

### 实际应用：界定风险期

精确计算人时的前提是准确界定每个个体贡献风险时间的起止点。

#### 观察的边界：进入与退出

个体对人时的贡献始于其进入风险队列的那一刻，并终止于以下几种情况中最早发生的一个：

1.  **发生结局事件**：例如，被诊断出所研究的疾病。
2.  **右删失（Right Censoring）**：当个体在经历结局事件前因某种原因停止被观察时发生。常见的[右删失](@entry_id:164686)类型包括：
    *   失访（Loss to follow-up）。
    *   因竞争性风险退出（如死于其他疾病）。
    *   达到研究设定的行政截止日期（Administrative censoring）。
3.  **左截断（Left Truncation）**：也称为延迟进入（Delayed entry），当个体的观察开始于研究时间轴的零点之后。只有在进入观察时仍未发生事件的个体才能被纳入研究。

让我们通过一个为期3年的开放队列研究来具体说明这些概念。研究时间从 $t=0$ 到 $t=3$。个体可以在 $t>0$ 时加入。

-   $P_1$：在 $t=0$ 进入，在 $t=2.2$ 发生结局。贡献人时：$2.2 - 0 = 2.2$ 年。
-   $P_2$：在 $t=0$ 进入，在 $t=1.4$ 因移居而失访（右删失）。贡献人时：$1.4 - 0 = 1.4$ 年。
-   $P_3$：在 $t=0.8$ 进入（左截断），在 $t=2.9$ 发生结局。贡献人时：$2.9 - 0.8 = 2.1$ 年。其在 $t=0$ 到 $t=0.8$ 之间的时期是未被观察的，不计入人时。
-   $P_4$：在 $t=1.2$ 进入（左截断），在 $t=1.7$ 失访（[右删失](@entry_id:164686)）。贡献人时：$1.7 - 1.2 = 0.5$ 年。
-   $P_5$：在 $t=2.5$ 进入（左截断），随访至研究结束 $t=3$（行政右删失）。贡献人时：$3.0 - 2.5 = 0.5$ 年。
-   $P_6$：本应在 $t=1.0$ 进入，但在 $t=0.5$ 已发生结局，因此不符合入组条件，不进入队列。贡献人时：$0$ 年。
-   $P_7$：在 $t=0$ 进入，在 $t=2.6$ 死于竞争性原因（右删失）。贡献人时：$2.6 - 0 = 2.6$ 年。
-   $P_8$：在 $t=1.8$ 进入（左截断），在 $t=1.9$ 发生结局。贡献人时：$1.9 - 1.8 = 0.1$ 年。

总人时为所有合格参与者贡献时间的总和：$2.2 + 1.4 + 2.1 + 0.5 + 0.5 + 0 + 2.6 + 0.1 = 9.4$ 人-年。这个计算过程精确地体现了左截断和右删失在人时累积中的作用。

#### 队列动态：封[闭式](@entry_id:271343)与开放式队列

根据成员资格的定义，队列可分为**封[闭式](@entry_id:271343)队列**和**开放式队列（或动态队列）**。

-   **封[闭式](@entry_id:271343)队列**：在研究开始时确定所有成员，没有新成员加入。成员因结局事件、删失或研究结束而退出。
-   **开放式队列**：成员可以在研究期间随时加入或退出。

人时计算的原则对两种队列都适用，但开放式队列的计算因其动态性而更为复杂。在一个开放式队列中，每个进入组的成员根据其各自的进入时间点开始累积人时。如果忽略了因失访而退出研究的个体所贡献的人时，总人时将被低估，从而导致发病率被高估，这是一种测量偏倚。

#### 合格性与可比性

在实际研究中，尤其是在利用大型数据库的研究中，准确定义合格性标准至关重要。例如，一项研究可能要求参与者在进入队列前有至少12个月的连续注册记录。在这种情况下，一个个体只有在满足了这个“回看期”要求后才能开始贡献人时。在这之前的时间，即使他们已存在于数据库中，也不应被计入风险人时分母。同样，如果个体在随访期间暂时退出（如从医疗系统中注销）然后又重新加入，那么在他们未被观察的“间隙”期间，不应累积人时。

使用人时计算的发病率有一个显著优势：**可比性**。由于发病率通过将事件数除以总风险时间来标准化，它提供了一个不依赖于随访时间长短的风险强度度量。这使得在具有不同随访时长的队列之间进行直接比较成为可能。

考虑两个职业队列的研究：
-   队列X：600人，发生24个事件，总人时为480人-年。
-   队列Y：300人，发生45个事件，总人时为900人-年。

队列X的平均随访时间为 $480/600 = 0.8$ 年，而队列Y为 $900/300 = 3$ 年。我们计算发病率和累积发病率：

-   **发病率**：
    $IR_X = 24 / 480 = 0.05$ 每人-年
    $IR_Y = 45 / 900 = 0.05$ 每人-年
-   **累积发病率**：
    $CI_X = 24 / 600 = 0.04$
    $CI_Y = 45 / 300 = 0.15$

发病率的计算结果表明，两个队列的潜在风险强度是相同的（均为0.05每人-年）。然而，累积发病率的比较却得出了一个误导性结论，即队列Y的“风险”远高于队列X（$15\%$ vs $4\%$）。这种差异仅仅是由于队列Y的随访时间更长，从而有更多时间累积事件。这个例子有力地证明了，当队列的随访时长不同时，发病率是更合适的比较指标。

### 高级主题与偏倚来源

#### 时依性暴露：对齐原则

当个体的暴露状态随时间变化时（例如，开始服用一种新药），人时累积变得更加复杂。在这种情况下，必须遵循**对齐原则（Principle of Alignment）**：一个事件必须被归因于个体在事件发生时所处的暴露状态，并且人时分母也必须根据暴露状态的变化进行相应划分。

考虑一项评估疫苗效果的研究，其中疫苗接种后有14天的免疫诱导期。这意味着，只有在接种疫苗14天后，个体才被视为“已接种疫苗”状态。

-   个体 $P_1$ 在第30天接种疫苗，在第50天发生肺炎。其“已接种疫苗”状态从第 $30+14=44$ 天开始。由于事件发生在第50天，该事件被计入“已接种疫苗”组的分子。其对“已接种疫苗”人时的贡献为 $50 - 44 = 6$ 天。
-   个体 $P_2$ 在第60天接种疫苗，但在第40天发生肺炎。由于事件发生在接种之前，这是一个“未接种疫苗”事件。该个体对“已接种疫苗”人时和病例数均无贡献。
-   个体 $P_5$ 在第50天接种疫苗，在第55天发生肺炎。由于事件发生在14天诱导期内（“已接种疫苗”状态从第 $50+14=64$ 天开始），该事件仍被视为“未接种疫苗”事件。

这种精细的人时划分对于获得无偏的暴露效应估计至关重要。

#### 永生时间偏倚：错误分类的后果

在人时分析中，一个常见且严重的偏倚来源是**永生时间偏倚（Immortal Time Bias）**。**永生时间（Immortal time）**指的是一段随访期，在此期间，根据研究设计，结局事件不可能发生。如果错误地将这段时间计入风险人时分母，将导致发病率被人为地稀释（低估）。

一个简单的例子是，研究假设在入组后存在一个30天的诱导期，在此期间感染不会发生。一个幼稚的分析错误地将这30天计入了每个人的风险人时。在一个200人的队列中，这会错误地增加 $200 \times 30 = 6000$ 人-天的“永生人时”到分母中。如果真实的风险人时为17,100人-天，那么错误计算出的总人时将是23,100人-天。这会导致发病率被低估约 $26\%$。

永生时间偏倚在评估时依性暴露时尤其[隐蔽](@entry_id:196364)和危险。考虑一项评估出院后启动某预防性药物对死亡率影响的研究。一些患者在出院后一段时间才开始用药。一个错误的分析可能会将所有最终用药者从出院开始就归类为“暴露组”。然而，这些患者从出院到开始用药的这段时间是“永生的”——因为他们必须存活下来才能开始用药。

让我们用数据来说明其后果：
-   **正确分析（时依性分析）**：将用药前的“永生时间”正确划归为“未暴露”人时。计算出的率比（Rate Ratio, $RR$）可能为 $1.32$，表明药物可能有害。
-   **错误分析（永生时间偏倚）**：将用药前的“永生时间”（例如900人-年，期间0死亡）错误地加入“暴露组”的分母。这会使得暴露组的发病率被人为地大大降低。计算出的率比可能变为 $0.44$，得出了一个药物具有强烈保护作用的虚[假结](@entry_id:168307)论。

这个例子揭示了永生时间偏倚的巨大危害：它不仅能量化地扭曲结果，甚至可以完全逆转关联的方向，将有害的暴露错误地判断为有益的。

#### 选择正确的时钟：时间刻度的作用

在队列研究中，“时间”并非单一概念。分析者必须明确选择一个**主时间刻度（primary time scale）**来累积人时。常见的时间刻度包括：

1.  **年龄（Age）**：以个体的年龄作为时间轴。
2.  **日历时间（Calendar Time）**：以日期（年、月、日）作为时间轴。
3.  **入组后时间（Time since Entry）**：以从进入队列开始算起的时间作为时间轴。

选择主时间刻度的指导原则是：**应选择基线风险（baseline hazard）变化最剧烈的时间维度作为主时间刻度**。通过将该维度作为主时间刻度进行精细分层，分析可以最有效地、非参数地控制其强大的混杂效应。

例如，在一项关于髋部骨折风险的研究中，众所周知风险会随着年龄急剧上升。相比之下，日历时间（年代趋势）和入组后时间的影响则小得多。因此，**年龄**是此项研究最合适的**主时间刻度**。分析将按年龄（例如，50.0-50.1岁，50.1-50.2岁…）来构建风险集并累积人时。而日历时间和入组后时间等其他时间维度，则可以通过在[回归模型](@entry_id:163386)中作为协变量进行调整。

正确理解和应用人时的概念，是现代流行病学研究的基石。它不仅为测量疾病频率提供了标准化的工具，也为处理复杂的现实世界数据（如动态队列、时依性暴露和多重时间维度）提供了严谨的分析框架。