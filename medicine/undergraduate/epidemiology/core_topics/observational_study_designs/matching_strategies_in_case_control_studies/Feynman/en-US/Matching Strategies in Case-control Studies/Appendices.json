{
    "hands_on_practices": [
        {
            "introduction": "The elegance of a matched design is most apparent in its simplest form: the $1:1$ matched pair. This exercise explores a nested case-control study using risk-set sampling, a powerful technique that mimics a cohort study's efficiency. By working through this problem, you will see how the analysis boils down to a simple comparison of discordant pairs, providing a direct and intuitive estimate of the hazard ratio from the source population. ",
            "id": "4610283",
            "problem": "A dynamic cohort is followed over calendar time, and disease events occur at distinct times. A nested case-control study uses risk-set sampling with $1:1$ matching on calendar time and age: at each event time $\\tau_j$, one case is identified from the risk set, and one control is sampled from the same risk set independently of the exposure given the matching factors. Let the binary exposure be $X \\in \\{0,1\\}$, which may vary over time. Assume that within each risk set, the instantaneous disease occurrence depends on $X$ only through a constant hazard ratio across time.\n\nAt four event times $\\tau_1,\\tau_2,\\tau_3,\\tau_4$, the observed exposure statuses for the case and its matched control are:\n\n- At time $\\tau_1$: case $X=1$, control $X=0$.\n- At time $\\tau_2$: case $X=0$, control $X=1$.\n- At time $\\tau_3$: case $X=1$, control $X=0$.\n- At time $\\tau_4$: case $X=1$, control $X=1$.\n\nUsing only the principles of risk-set sampling and matched analysis, compute the matched odds ratio for the exposure $X$ from these $4$ matched pairs and state its interpretation in terms of the instantaneous risk (hazard ratio) under the study design assumptions. Provide your numerical answer as a simplified fraction or integer. No rounding is required. Express the final numeric value without any units.",
            "solution": "The problem requires the calculation of a matched odds ratio from a $1:1$ nested case-control study and its interpretation. The analytical approach for this study design is based on conditional logistic regression, which is derived from the partial likelihood of the Cox proportional hazards model.\n\nIn a $1:1$ matched case-control study, each matched set consists of one case and one control, who are matched on certain variables (in this case, calendar time and age). The analysis aims to estimate the association between the exposure, $X \\in \\{0,1\\}$, and the disease outcome. A fundamental principle of this analysis is that only discordant pairs, where the case and the control have different exposure statuses, contribute information to the estimate of the odds ratio. Concordant pairs, where the case and control share the same exposure status, do not contribute to the conditional likelihood function used for estimation and are therefore disregarded in the calculation of the point estimate.\n\nLet's classify the matched pairs based on the binary exposure status of the case and the control. We can define $n_{10}$ as the number of pairs where the case is exposed ($X=1$) and the control is unexposed ($X=0$), and $n_{01}$ as the number of pairs where the case is unexposed ($X=0$) and the control is exposed ($X=1$). These are the two types of discordant pairs.\n\nThe maximum conditional likelihood estimator for the matched odds ratio ($OR$) is given by the ratio of the counts of these two types of discordant pairs:\n$$ OR = \\frac{n_{10}}{n_{01}} $$\nThis estimator arises from maximizing the conditional likelihood function for the hazard ratio, $\\exp(\\beta)$, in the underlying proportional hazards model, which simplifies to this ratio for a $1:1$ matched design.\n\nWe are given the exposure data for $4$ matched pairs at four distinct event times $\\tau_1, \\tau_2, \\tau_3, \\tau_4$:\n- At time $\\tau_1$: The case has exposure $X=1$ and the control has exposure $X=0$. This is a discordant pair of the first type ($n_{10}$).\n- At time $\\tau_2$: The case has exposure $X=0$ and the control has exposure $X=1$. This is a discordant pair of the second type ($n_{01}$).\n- At time $\\tau_3$: The case has exposure $X=1$ and the control has exposure $X=0$. This is another discordant pair of the first type ($n_{10}$).\n- At time $\\tau_4$: The case has exposure $X=1$ and the control has exposure $X=1$. This is a concordant pair. As explained, it does not contribute to the calculation of the odds ratio estimate.\n\nNow, we tally the counts of the discordant pairs from the provided data:\nThe number of pairs where the case is exposed and the control is unexposed is $n_{10} = 2$ (from pairs at $\\tau_1$ and $\\tau_3$).\nThe number of pairs where the case is unexposed and the control is exposed is $n_{01} = 1$ (from the pair at $\\tau_2$).\n\nUsing the formula for the matched odds ratio, we can compute the value:\n$$ OR = \\frac{n_{10}}{n_{01}} = \\frac{2}{1} = 2 $$\n\nThe second part of the question asks for the interpretation of this result. The problem specifies that the study design is a nested case-control study with risk-set sampling and that the hazard ratio ($HR$) for the exposure is constant. A key property of this specific design is that the odds ratio estimated from the matched analysis is a direct and consistent estimator of the hazard ratio in the source cohort. That is, $OR_{matched}$ provides an unbiased estimate of the $HR$.\n\nTherefore, the interpretation of the calculated odds ratio of $2$ is that it is an estimate of the hazard ratio. This implies that an exposed individual ($X=1$) has an instantaneous risk (hazard) of developing the disease that is $2$ times the instantaneous risk of an unexposed individual ($X=0$), holding the matching factors (age and calendar time) constant.",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "While individual matching is powerful, frequency matching is often a more practical approach for ensuring comparability between cases and controls across key strata like age groups. To analyze such data, we can no longer rely on a simple ratio of discordant pairs; instead, we need a method to pool information across strata. This practice introduces the Mantel-Haenszel (MH) estimator, a cornerstone of epidemiology, which calculates a weighted average of the stratum-specific odds ratios to provide a single, summary estimate adjusted for the matching factor. ",
            "id": "4610307",
            "problem": "A population-based case-control study investigates the association between a binary exposure and a binary disease outcome. The study uses frequency matching on age categories to reduce confounding by age, yielding three strata corresponding to age groups. Within each stratum, the $2 \\times 2$ table cell counts are defined as follows: $a_k$ is the number of exposed cases, $b_k$ is the number of unexposed cases, $c_k$ is the number of exposed controls, and $d_k$ is the number of unexposed controls, for stratum index $k \\in \\{1,2,3\\}$. Let $N_k = a_k + b_k + c_k + d_k$ denote the total subjects in stratum $k$.\n\nData were as follows:\n- Stratum $1$: $a_1 = 18$, $b_1 = 22$, $c_1 = 12$, $d_1 = 38$.\n- Stratum $2$: $a_2 = 25$, $b_2 = 15$, $c_2 = 20$, $d_2 = 40$.\n- Stratum $3$: $a_3 = 10$, $b_3 = 30$, $c_3 = 8$, $d_3 = 52$.\n\nStarting from the fundamental definitions of odds and odds ratio in a $2 \\times 2$ table, and using the principle of stratification to control for the matching factor, derive an appropriate pooled estimator for a common odds ratio across strata using the Mantel-Haenszel approach (Mantel-Haenszel (MH)). Then compute the value of this pooled estimator for the given data. Round your numerical answer to four significant figures. No units should be used. Finally, interpret the estimate in the context of a case-control study with frequency matching.",
            "solution": "The objective is to compute the Mantel-Haenszel (MH) pooled odds ratio for stratified case-control data and interpret the result. The study employs frequency matching by age, and the analysis uses stratification to control for age as a potential confounding variable.\n\nFirst, we define the odds ratio (OR) for a single stratum $k$. In a case-control study, we compare the odds of exposure among cases to the odds of exposure among controls. For stratum $k$, with cell counts $a_k$ (exposed cases), $b_k$ (unexposed cases), $c_k$ (exposed controls), and $d_k$ (unexposed controls), the structure of the data is:\n\n| | Exposed | Unexposed |\n|---|---|---|\n| Cases | $a_k$ | $b_k$ |\n| Controls | $c_k$ | $d_k$ |\n\nThe odds of exposure among cases are estimated as the ratio of exposed cases to unexposed cases: $\\frac{a_k}{b_k}$.\nThe odds of exposure among controls are estimated as the ratio of exposed controls to unexposed controls: $\\frac{c_k}{d_k}$.\n\nThe odds ratio for stratum $k$, denoted $OR_k$, is the ratio of these two odds:\n$$OR_k = \\frac{a_k / b_k}{c_k / d_k} = \\frac{a_k d_k}{b_k c_k}$$\n\nThe Mantel-Haenszel method provides a pooled estimate of a common odds ratio, $\\psi_{MH}$, across all strata, under the assumption that the true odds ratio is constant across strata. The MH estimator is a weighted summary that gives more weight to strata with more information.\n\nThe formula for the Mantel-Haenszel pooled odds ratio is:\n$$\\psi_{MH} = \\frac{\\sum_{k=1}^{K} R_k}{\\sum_{k=1}^{K} S_k} = \\frac{\\sum_{k=1}^{K} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{K} \\frac{b_k c_k}{N_k}}$$\nwhere $K$ is the total number of strata, which is $3$ in this problem.\n\nWe now compute the necessary components for each of the three strata using the provided data.\n\n**Stratum 1 ($k=1$):**\nGiven data: $a_1 = 18$, $b_1 = 22$, $c_1 = 12$, $d_1 = 38$.\nTotal subjects in stratum $1$: $N_1 = a_1 + b_1 + c_1 + d_1 = 18 + 22 + 12 + 38 = 90$.\nNumerator component: $R_1 = \\frac{a_1 d_1}{N_1} = \\frac{18 \\times 38}{90} = \\frac{684}{90} = 7.6$.\nDenominator component: $S_1 = \\frac{b_1 c_1}{N_1} = \\frac{22 \\times 12}{90} = \\frac{264}{90} = \\frac{44}{15}$.\n\n**Stratum 2 ($k=2$):**\nGiven data: $a_2 = 25$, $b_2 = 15$, $c_2 = 20$, $d_2 = 40$.\nTotal subjects in stratum $2$: $N_2 = a_2 + b_2 + c_2 + d_2 = 25 + 15 + 20 + 40 = 100$.\nNumerator component: $R_2 = \\frac{a_2 d_2}{N_2} = \\frac{25 \\times 40}{100} = \\frac{1000}{100} = 10$.\nDenominator component: $S_2 = \\frac{b_2 c_2}{N_2} = \\frac{15 \\times 20}{100} = \\frac{300}{100} = 3$.\n\n**Stratum 3 ($k=3$):**\nGiven data: $a_3 = 10$, $b_3 = 30$, $c_3 = 8$, $d_3 = 52$.\nTotal subjects in stratum $3$: $N_3 = a_3 + b_3 + c_3 + d_3 = 10 + 30 + 8 + 52 = 100$.\nNumerator component: $R_3 = \\frac{a_3 d_3}{N_3} = \\frac{10 \\times 52}{100} = \\frac{520}{100} = 5.2$.\nDenominator component: $S_3 = \\frac{b_3 c_3}{N_3} = \\frac{30 \\times 8}{100} = \\frac{240}{100} = 2.4$.\n\nNext, we sum these components across all strata.\nSum of numerator components:\n$$\\sum_{k=1}^{3} R_k = R_1 + R_2 + R_3 = 7.6 + 10 + 5.2 = 22.8$$\nSum of denominator components:\n$$\\sum_{k=1}^{3} S_k = S_1 + S_2 + S_3 = \\frac{44}{15} + 3 + 2.4 = \\frac{44}{15} + \\frac{45}{15} + \\frac{36}{15} = \\frac{44 + 45 + 36}{15} = \\frac{125}{15} = \\frac{25}{3}$$\nNote that $2.4 = \\frac{24}{10} = \\frac{12}{5} = \\frac{36}{15}$.\n\nFinally, we compute the Mantel-Haenszel pooled odds ratio:\n$$\\psi_{MH} = \\frac{\\sum_{k=1}^{3} R_k}{\\sum_{k=1}^{3} S_k} = \\frac{22.8}{\\frac{25}{3}} = \\frac{22.8 \\times 3}{25} = \\frac{68.4}{25} = 2.736$$\nThe result $2.736$ has four significant figures, as requested.\n\n**Interpretation:**\nThe Mantel-Haenszel pooled odds ratio, $\\psi_{MH} = 2.736$, is an estimate of the association between the exposure and the disease, adjusted for the confounding effect of age. In the context of this case-control study, the odds ratio compares the odds of exposure among cases to the odds of exposure among controls. An odds ratio of $1$ would indicate no association, an odds ratio greater than $1$ suggests a positive association (the exposure is a potential risk factor), and an odds ratio less than $1$ suggests a negative association (the exposure is potentially protective).\n\nThe calculated value of $2.736$ indicates a positive association. The interpretation is as follows: After controlling for confounding by age via stratification, the odds of having been exposed are estimated to be $2.736$ times greater for individuals with the disease (cases) than for individuals without the disease (controls) in the studied population. It is important to note that frequency matching is a study design strategy to ensure sufficient data in each stratum for a valid stratified analysis, while the Mantel-Haenszel procedure is the analysis method that actually controls for confounding.",
            "answer": "$$\n\\boxed{2.736}\n$$"
        },
        {
            "introduction": "Understanding the correct analytical method is only half the battle; appreciating the consequences of an incorrect one is just as critical. This exercise presents a hypothetical scenario where frequency-matched data are analyzed improperly using a crude, unadjusted odds ratio. By calculating the expected counts and the resulting biased estimate, you will quantify how matching on a variable associated with exposure can artificially pull the odds ratio toward the null if the analysis fails to account for the stratified design, a phenomenon known as bias from overmatching. ",
            "id": "4610264",
            "problem": "An investigator conducts a frequency-matched case-control study to estimate the effect of a binary exposure $E \\in \\{0,1\\}$ on a binary disease $D \\in \\{0,1\\}$, with frequency-matching on a binary stratum variable $S \\in \\{0,1\\}$ (for example, age group). The design is such that for each stratum $s \\in \\{0,1\\}$, exactly $n_s$ cases and $n_s$ controls are sampled, with $n_0 = 300$ and $n_1 = 100$. In the source population, within each stratum $s$, the exposure $E$ has prevalence $\\pi_s$ among controls, with $\\pi_0 = 0.7$ and $\\pi_1 = 0.2$. The true stratum-specific disease odds ratio (odds ratio (OR)) comparing $E=1$ to $E=0$ is homogeneous across strata and equal to $\\theta = 2$.\n\nStarting only from the core definitions of odds, odds ratio, and the rules of case-control sampling, derive the expected unconditional crude odds ratio for $E$ obtained by ignoring $S$ (that is, pooling all strata and fitting an unconditional model without any stratum indicators). Then, define the multiplicative bias factor as $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$, where $\\mathrm{OR}_{\\text{unadj}}$ is the unconditional crude odds ratio ignoring $S$. Compute $b$ for the given design and parameters.\n\nExpress the final answer for $b$ as a real number, rounded to four significant figures. No units are required.",
            "solution": "The goal is to compute the multiplicative bias factor $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$. To do this, we must first derive the expected unconditional crude odds ratio, $\\mathrm{OR}_{\\text{unadj}}$. This odds ratio is calculated from a $2 \\times 2$ table that pools data across the two strata $S=0$ and $S=1$.\n\nThe pooled table of expected counts is:\n| | Exposed ($E=1$) | Unexposed ($E=0$) |\n|---|---|---|\n| Cases ($D=1$) | $E[A]$ | $E[B]$ |\n| Controls ($D=0$) | $E[C]$ | $E[D]$ |\n\nThe crude odds ratio is given by $\\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]}$.\nThe terms $E[A], E[B], E[C], E[D]$ represent the expected total counts in the pooled study sample. Let $N_{eds}$ be the number of individuals in the study with exposure status $e$, disease status $d$, and in stratum $s$.\nThe pooled counts are:\n$A = N_{110} + N_{111}$ (Exposed Cases)\n$B = N_{010} + N_{011}$ (Unexposed Cases)\n$C = N_{100} + N_{101}$ (Exposed Controls)\n$D = N_{000} + N_{001}$ (Unexposed Controls)\n\nWe need to find the expectation of these counts.\n\n**1. Expected Counts for Controls ($D=0$)**\n\nThe problem provides the prevalence of exposure among controls in the source population for each stratum, $\\pi_s = P(E=1|D=0, S=s)$.\nIn stratum $s=0$, we sample $n_0 = 300$ controls. The prevalence of exposure is $\\pi_0 = 0.7$.\nThe expected number of exposed controls in stratum $0$ is:\n$E[N_{100}] = n_0 \\cdot \\pi_0 = 300 \\cdot 0.7 = 210$.\nThe expected number of unexposed controls in stratum $0$ is:\n$E[N_{000}] = n_0 \\cdot (1 - \\pi_0) = 300 \\cdot (1 - 0.7) = 90$.\n\nIn stratum $s=1$, we sample $n_1 = 100$ controls. The prevalence of exposure is $\\pi_1 = 0.2$.\nThe expected number of exposed controls in stratum $1$ is:\n$E[N_{101}] = n_1 \\cdot \\pi_1 = 100 \\cdot 0.2 = 20$.\nThe expected number of unexposed controls in stratum $1$ is:\n$E[N_{001}] = n_1 \\cdot (1 - \\pi_1) = 100 \\cdot (1 - 0.2) = 80$.\n\nThe total expected counts for controls in the pooled table are:\n$E[C] = E[N_{100}] + E[N_{101}] = 210 + 20 = 230$.\n$E[D] = E[N_{000}] + E[N_{001}] = 90 + 80 = 170$.\n\n**2. Expected Counts for Cases ($D=1$)**\n\nWe need to determine the prevalence of exposure among cases, which we denote as $\\pi_s^* = P(E=1|D=1, S=s)$. This can be derived from the stratum-specific odds ratio, $\\theta$. The odds ratio of disease given exposure is equal to the odds ratio of exposure given disease.\n$$ \\theta = \\frac{\\text{odds}(E=1|D=1, S=s)}{\\text{odds}(E=1|D=0, S=s)} = \\frac{\\pi_s^*/(1-\\pi_s^*)}{\\pi_s/(1-\\pi_s)} $$\nSolving for $\\pi_s^*$, we get the odds of exposure among cases:\n$$ \\frac{\\pi_s^*}{1-\\pi_s^*} = \\theta \\cdot \\frac{\\pi_s}{1-\\pi_s} $$\nThis leads to the expression for the prevalence of exposure among cases:\n$$ \\pi_s^* = \\frac{\\theta \\pi_s}{1-\\pi_s + \\theta\\pi_s} = \\frac{\\theta \\pi_s}{1 + (\\theta-1)\\pi_s} $$\nUsing the given values $\\theta = 2$, $\\pi_0 = 0.7$, and $\\pi_1 = 0.2$:\n\nFor stratum $s=0$:\n$$ \\pi_0^* = \\frac{2 \\cdot 0.7}{1 + (2-1) \\cdot 0.7} = \\frac{1.4}{1.7} = \\frac{14}{17} $$\nFor stratum $s=1$:\n$$ \\pi_1^* = \\frac{2 \\cdot 0.2}{1 + (2-1) \\cdot 0.2} = \\frac{0.4}{1.2} = \\frac{1}{3} $$\nNow we can compute the expected counts for cases.\nIn stratum $s=0$, we sample $n_0 = 300$ cases.\n$E[N_{110}] = n_0 \\cdot \\pi_0^* = 300 \\cdot \\frac{14}{17} = \\frac{4200}{17}$.\n$E[N_{010}] = n_0 \\cdot (1 - \\pi_0^*) = 300 \\cdot \\left(1 - \\frac{14}{17}\\right) = 300 \\cdot \\frac{3}{17} = \\frac{900}{17}$.\n\nIn stratum $s=1$, we sample $n_1 = 100$ cases.\n$E[N_{111}] = n_1 \\cdot \\pi_1^* = 100 \\cdot \\frac{1}{3} = \\frac{100}{3}$.\n$E[N_{011}] = n_1 \\cdot (1 - \\pi_1^*) = 100 \\cdot \\left(1 - \\frac{1}{3}\\right) = 100 \\cdot \\frac{2}{3} = \\frac{200}{3}$.\n\nThe total expected counts for cases in the pooled table are:\n$E[A] = E[N_{110}] + E[N_{111}] = \\frac{4200}{17} + \\frac{100}{3} = \\frac{12600 + 1700}{51} = \\frac{14300}{51}$.\n$E[B] = E[N_{010}] + E[N_{011}] = \\frac{900}{17} + \\frac{200}{3} = \\frac{2700 + 3400}{51} = \\frac{6100}{51}$.\n\n**3. Compute the Unconditional Crude Odds Ratio ($\\mathrm{OR}_{\\text{unadj}}$)**\n\nUsing the expected counts for the pooled table:\n$E[A] = \\frac{14300}{51}$, $E[B] = \\frac{6100}{51}$, $E[C] = 230$, $E[D] = 170$.\n$$ \\mathrm{OR}_{\\text{unadj}} = \\frac{E[A]E[D]}{E[B]E[C]} = \\frac{\\left(\\frac{14300}{51}\\right) \\cdot 170}{\\left(\\frac{6100}{51}\\right) \\cdot 230} $$\nThe denominators of $51$ cancel out:\n$$ \\mathrm{OR}_{\\text{unadj}} = \\frac{14300 \\cdot 170}{6100 \\cdot 230} = \\frac{143 \\cdot 17}{61 \\cdot 23} = \\frac{2431}{1403} $$\n\n**4. Compute the Bias Factor ($b$)**\n\nThe multiplicative bias factor is $b = \\mathrm{OR}_{\\text{unadj}} / \\theta$.\nGiven $\\theta = 2$:\n$$ b = \\frac{\\mathrm{OR}_{\\text{unadj}}}{\\theta} = \\frac{2431/1403}{2} = \\frac{2431}{2 \\cdot 1403} = \\frac{2431}{2806} $$\nNow, we compute the numerical value and round to four significant figures:\n$$ b = \\frac{2431}{2806} \\approx 0.8663578047... $$\nRounding to four significant figures, we get $0.8664$.",
            "answer": "$$\\boxed{0.8664}$$"
        }
    ]
}