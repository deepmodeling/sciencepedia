## 引言
在流行病学研究领域，回顾性队列研究是一种强大且高效的设计方法，尤其在电子健康记录和大型行政数据库日益普及的今天，其重要性愈发凸显。它允许研究者利用现有数据，在较短时间内探究暴露与疾病之间的长期关联，为临床决策和公共卫生政策提供关键证据。然而，这种高效性的背后隐藏着巨大的挑战：如何从不为研究设计的历史数据中获取可靠的结论，并有效应对混杂、信息偏倚和选择偏倚等系统性误差？这正是本篇文章旨在解决的核心问题。

为了系统地掌握这一方法，本文将分为三个核心部分。在“原理与机制”一章中，我们将深入探讨回顾性队列研究的基本逻辑，学习如何从零开始构建一个研究队列，并识别与量化研究中常见的偏倚来源，如错分偏倚和不朽时间偏倚。接着，在“应用与跨学科联系”一章中，我们将通过公共卫生调查、药物安全性监测等真实案例，展示该方法的实际应用，并介绍模拟目标试验、倾向性评分等高级分析策略如何提升研究的因果推断能力。最后，“实践练习”部分将提供具体的计算和分析问题，帮助您将理论知识转化为实践技能。

现在，让我们从回顾性队列研究最根本的原理与机制开始。

## 原理与机制

回顾性队列研究（retrospective cohort study）是流行病学研究中的一种强大的观察性设计方法。与前瞻性队列研究（prospective cohort study）在真实时间中向前追踪受试者不同，回顾性队列研究利用历史数据，在研究开始之时，暴露和结局事件均已发生。研究者“回顾”过去，识别出一个特定历史时间点的队列，然后利用现有记录，在逻辑上“前瞻性”地追踪这个队列，直至某个更近的过去时间点，以确定结局的发生情况。本章将深入探讨回顾性队列研究的核心原理、实施机制及其固有的方法学挑战。

### 回顾性队列研究的逻辑：回顾过去，前瞻分析

回顾性队列研究的根本特征在于其时间框架。研究者在当前时间点（例如 $2024$ 年）开始研究，但队列的建立、暴露状态的分类以及结局的确定，都依赖于过去已经存在的记录（例如 $2010$ 年至 $2019$ 年的记录）。尽管数据收集是“回顾性”的，但研究的内在逻辑方向却是“前瞻性”的：它从一个明确定义的基线时间点的暴露状态开始，向前追踪结局的发生。

这个特性将回顾性队列研究与另外两种主要的研究设计区分开来。与**病例对照研究（case-control study）**不同，后者是根据结局状态（患病或未患病）来选择研究对象，然后回顾性地探寻其过去的暴露史。由于病例对照研究不是从一个完整的风险人群（population at risk）开始，因此无法直接计算发病率或风险。而回顾性队列研究定义了一个完整的队列，并确定了其中暴露和非暴露的人数，因此，它可以计算两个组的**发病率（incidence rate）**和**发病风险（incidence proportion/risk）**。这使得研究者能够计算**风险比（risk ratio, $RR$）**和**率比（rate ratio, $IRR$）**，这是衡量关联强度的直接指标 。

与**前瞻性队列研究**相比，回顾性队列研究的主要区别在于数据收集的时间点。在前瞻性研究中，研究者在研究开始时招募队列，并随着时间的推移实时收集数据。而在回顾性研究中，整个过程都在历史记录中重建。尽管如此，两种队列研究共享同一个核心逻辑：从暴露到结局的前向时间顺序，这对于因果推断至关重要  。

选择回顾性队列研究通常基于效率和伦理的考虑。对于潜伏期长的疾病，前瞻性研究可能需要数十年才能获得结果，而回顾性研究可以在数月内完成。此外，当研究一个潜在有害的暴露时，进行随机对照试验（Randomized Controlled Trial, RCT）在伦理上是不可行的。例如，我们不能随机分配怀孕的患者服用已知的致畸药物（如丙戊酸盐）来研究其对后代神经发育的影响。在这种情况下，利用电子健康记录（EHR）等数据源进行回顾性队列研究，就成为评估这种风险的首选方法 。

### 构建队列：从数据到受试者的实践

利用现有数据（如行政管理理赔数据库或电子健康记录）构建一个回顾性队列，需要一系列严谨的步骤来确保研究的有效性。

#### 定义队列和指标日期

研究的第一步是精确定义研究队列。这通常涉及一系列**入选和排除标准**。关键是确定每个受试者的**指标日期（index date）**，即 $t_0$，它标志着随访的开始。在药物流行病学研究中，一个常见的做法是采用**新使用者设计（new-user design）**。

#### 新使用者设计与回顾期

为了避免将正在使用某药物的“现患使用者”与刚开始使用的“新发使用者”混淆，研究者通常会实施新使用者设计。这要求受试者在指标日期之前有一段足够长的“无暴露”时期，这段时期被称为**回顾期（look-back period）**或“洗脱期”。例如，一项研究可能要求患者在首次开具某种药物处方（指标日期）之前的 $365$ 天内，没有任何该药物的处方记录 。这样做有助于确保所有受试者在进入队列时都处于相似的初始状态，减少因既往用药史不同而带来的偏倚。

#### 应用入选和排除标准

在确定了潜在的指标日期后，研究者会依次应用一系列标准来筛选最终的研究队列。这通常包括：
1.  **年龄限制**：如限定在 $18$ 至 $64$ 岁的成年人。
2.  **连续参保/记录**：要求在指标日期前的回顾期内（如 $365$ 天）具有连续的健康记录，以确保可以完整地评估基线协变量和排除既往暴露。
3.  **排除既往结局**：在基线时排除已经患有所研究结局（如心肌梗死）的个体，以确保研究的是新发事件。
4.  **新使用者标准**：如上所述，排除在回顾期内有过暴露史的个体。

例如，一项研究最初从数据库中筛选出 $4200$ 名有2型糖尿病诊断和SGLT2i抑制剂用药记录的候选者。经过年龄筛选（剩余 $3800$ 人）、$365$ 天连续参保筛选（剩余 $3000$ 人）、排除基线期心肌梗死（剩余 $2800$ 人）以及新使用者筛选（剩余 $2500$ 人）后，最终确定了 $2500$ 人的合格队列。这个严谨的筛选过程对于构建一个清晰、同质的研究人群至关重要 。

### 重建时间与事件：随访和删失

队列构建完成后，下一步是在历史记录中重建每个受试者的随访时间。

#### 计算人时

随访从每个人的指标日期 $t_0$ 开始。每个受试者贡献的**人时（person-time）**是从 $t_0$ 到其随访结束那一刻的持续时间。随访的结束由以下几个事件中最早发生的一个决定：
1.  **发生结局**：例如，发生心肌梗死。
2.  **失访或终止资格**：例如，从医疗保险计划中退出，导致其后续健康信息不可观测。
3.  **死亡**：如果死亡本身不是研究的结局，它将被视为一个删失事件。
4.  **研究管理性截止**：数据库记录的结束日期，例如 $2020$ 年 $12$ 月 $31$ 日。

例如，假设研究的行政管理截止日期为 $1000$ 天。
-   受试者 $S_1$ 在第 $350$ 天发生结局，其人时贡献为 $350$ 天。
-   受试者 $S_2$ 在第 $700$ 天退保失访，其人时贡献为 $700$ 天。
-   受试者 $S_3$ 未发生任何事件，一直被观察到第 $1000$ 天，其人时贡献为 $1000$ 天。
-   受试者 $S_4$ 在第 $650$ 天因其他原因死亡，其人时贡献为 $650$ 天。

总人时是所有队列成员贡献的人时之和，它将作为计算发病率的分母 。

#### 管理性删失

当受试者的随访因为到达了数据可用性的终点而停止时，这被称为**管理性删失（administrative censoring）**。这是一种**右删失（right-censoring）**，因为我们知道该受试者在截止日期前是无事件的，但之后的情况未知。在分析中，只要管理性删失的发生与结局的风险无关（即非信息性删失），它就不会引入偏倚 。

### 测量的挑战：分类与错分

回顾性研究的“阿喀琉斯之踵”是其对现有[数据质量](@entry_id:185007)的依赖。暴露、结局和协变量的测量都可能存在错误，即**错分偏倚（misclassification bias）**。

#### 暴露与结局的分类算法

在EHR或理赔数据中，暴露和结局通常通过算法来定义。例如，一项药物暴露可能定义为“在 $\ge 14$ 天内至少有 $2$ 次药房配药记录” 。一个心肌梗死结局可能定义为“存在急性心肌梗死的ICD诊断编码，或[肌钙蛋白](@entry_id:152123)I峰值 $\ge 0.4$ ng/mL 且伴有同次就诊的胸痛记录” 。

这些算法的准确性通过**敏感性（sensitivity, $Se$）**和**特异性（specificity, $Sp$）**来量化。敏感性是算法正确识别出真正有暴露/结局的个体的概率，而特异性是算法正确识别出真正没有暴露/结局的个体的概率。这些参数通常通过与“金标准”（如人工病历审核）进行比较的验证研究来估计 。

#### 错分偏倚的影响

错分偏倚可以是**非差异性的（non-differential）**或**差异性的（differential）**。

-   **非差异性错分**：当一个变量（如暴露）的测量误差独立于另一个变量（如结局）时，即为非差异性。
    -   **非差异性暴露错分**：这通常会导致关联强度的估计值偏向于无效值（即 $RR$ 或 $IRR$ 趋近于 $1$）。这是因为暴露组和非暴露组之间发生了“混合”，使得两组的结局风险变得更加相似。例如，一项研究的真实 $RR$ 为 $0.67$，但由于敏感度为 $0.88$、特异性为 $0.99$ 的非差异性暴露错分，观察到的 $RR$ 可能被稀释至 $0.69$ 左右 。
    -   **非差异性结局错分**：在大多数情况下，这同样会导致关联估计值偏向无效值。不完美的特异性（即[假阳性](@entry_id:635878)）是主要驱动因素，因为它向暴露组和非暴露组的分子（事件数）中都加入了“噪音”，从而使它们的比率趋于一致。例如，一项研究的真实 $RR$ 为 $0.67$，但一个敏感度为 $0.85$、特异性为 $0.95$ 的结局分类算法可能导致观察到的 $RR$ 被稀释至 $0.89$  。

-   **差异性错分**：当一个变量的测量误差依赖于另一个变量的状态时，即为差异性。
    -   例如，在研究抗高血压药物与中风的关联时，如果未服药组的患者更有可能在系统外的医院就诊，导致他们的中风事件在EHR中被漏记，而服药组的记录则相对完整。这种对结局的**差异性低估（differential under-ascertainment）**是一种**信息偏倚（information bias）**。它可能导致偏倚的方向和大小都不可预测。在上述例子中，由于非暴露组的事件被漏记，其发病率会被低估，从而可能错误地使药物看起来好像会增加（而不是降低）中风风险，将一个保护性关联（如真实 $IRR \approx 0.92$）错误地反转为一个有害关联（如观察 $IRR \approx 1.5$）  。

### 对有效性的威胁：混杂和其他偏倚

除了错分偏倚，回顾性队列研究还面临其他几种关键的偏倚威胁。

#### 混杂偏倚

**混杂（Confounding）**是所有[观察性研究](@entry_id:174507)的核心挑战。当一个变量既与暴露相关，又独立地影响结局时，就会发生混杂。在药物研究中，一个特别重要的类型是**适应症混杂（confounding by indication）**。这是指疾病的严重程度或特定症状（即用药的适应症）本身就是结局的风险因素，同时它也决定了患者是否接受治疗以及接受何种治疗。例如，病情更严重的癫痫患者可能更倾向于使用效果更强但风险也更高的药物，如果不在分析中恰当控制疾病严重程度，药物的风险就可能被高估 。

#### 不朽时间偏倚

**不朽时间偏倚（Immortal time bias）**是一种由于对随访时间处理不当而引起的微妙但严重的偏倚。**不朽时间**是指在暴露定义下，个体必须存活才能进入暴露组的一段随访时间。

这种偏倚的经典场景是，错误地将一个“最终暴露”的患者从队列起始日（$t=0$）到其真正开始暴露（如服药）之间的所有时间，都归类为“暴露组”的人时。因为患者必须活着才能开始服药，所以这段时间内的死亡事件数为零。将这段零风险的“不朽时间”加入到暴露组的人时分母中，会人为地、虚假地降低暴露组的事件发生率，从而使暴露看起来具有保护作用。

例如，在一项研究中，正确分析显示药物的率比 $IRR$ 为 $0.78$（轻度保护作用）。但如果错误地将 $400$ 名未来服药者在服药前的总计 $100$ 人年（期间死亡为 $0$）划归为暴露组，计算出的暴露组发病率将被大大拉低，导致错误的 $IRR$ 为 $0.50$，夸大了药物的保护效应 。正确的处理方法是将这段时间正确地归类为“非暴露”人时，或者采用将暴露作为时依变量的分析模型。

#### 应对混杂：倾向性评分的角色

为了应对可测量的混杂因素，研究者可以采用**倾向性评分（propensity score）**等高级统计方法。倾向性评分 $e(\mathbf{X})$ 定义为在给定一系列基线协变量 $\mathbf{X}$ 的条件下，一个个体接受暴露（$A=1$）的条件概率，即 $e(\mathbf{X}) = P(A=1|\mathbf{X})$。

倾向性评分的一个关键特性是其**平衡属性（balancing property）**：在具有相同倾向性评分值的个体中，无论他们最终是否暴露，其测得的基线协变量 $\mathbf{X}$ 的分布是相似的。这意味着通过对倾向性评分进行调整（如通过匹配、分层或加权），我们可以在[观察性研究](@entry_id:174507)中模拟出随机试验中协变量在组间均衡分布的效果 。

一种常用的方法是**[逆概率](@entry_id:196307)治疗加权（Inverse Probability of Treatment Weighting, IPTW）**。通过为每个受试者赋予一个等于其所处组别概率倒数的权重（暴露组为 $\frac{1}{e(\mathbf{X})}$，非暴露组为 $\frac{1}{1-e(\mathbf{X})}$），可以创建一个伪人群，在这个伪人群中，暴露分配与测得的协变量无关，从而消除了这些协变量的混杂效应 。

然而，必须强调的是，倾向性评分及所有基于它的方法，只能平衡和控制**已测量**的混杂因素。它们无法解决由**未测量**的混杂因素所引起的偏倚。因此，在解释任何回顾性队列研究的结果时，对潜在未测量混杂的审慎考虑都是不可或缺的。