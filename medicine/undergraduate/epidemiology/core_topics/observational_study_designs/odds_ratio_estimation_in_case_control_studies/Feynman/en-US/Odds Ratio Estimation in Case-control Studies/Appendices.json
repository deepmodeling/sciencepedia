{
    "hands_on_practices": [
        {
            "introduction": "This first practice is foundational, designed to build your core analytical toolkit for case-control studies. You will translate theoretical formulas into a working procedure to analyze a standard $2 \\times 2$ table. By calculating the odds ratio ($OR$), its confidence interval, and a test for statistical significance, this exercise solidifies the essential mechanics of converting raw data into a meaningful measure of association and its statistical uncertainty .",
            "id": "4616344",
            "problem": "A case-control study evaluates the association between a binary exposure and a binary disease outcome. Let a $2 \\times 2$ table of counts be formed as follows: the first row corresponds to individuals with the disease (cases) with $a$ exposed and $b$ unexposed, and the second row corresponds to individuals without the disease (controls) with $c$ exposed and $d$ unexposed. The odds of exposure among cases is defined as $a/b$, and the odds of exposure among controls is defined as $c/d$. The odds ratio is defined as the ratio of these two odds. Assume independent sampling within cases and controls.\n\nStarting from these core definitions, derive a procedure to:\n- Estimate the odds ratio, its natural logarithm, and the standard error of the natural logarithm of the estimated odds ratio.\n- Construct a two-sided $(1-\\alpha)$ Confidence Interval (CI) for the true odds ratio using a large-sample normal approximation, where $\\alpha = 0.05$ is the Type I error rate expressed as a decimal.\n- Perform a two-sided Wald hypothesis test of the null hypothesis that the true odds ratio equals $1$.\n- Apply the Haldane–Anscombe correction (add $0.5$ to all four cell counts) when any of $a$, $b$, $c$, or $d$ equals $0$ to avoid undefined quantities.\n\nYour program must implement the above derivation and compute, for each test case, a list containing the following seven elements in order:\n1. The estimated odds ratio $\\widehat{\\mathrm{OR}}$ rounded to six decimal places.\n2. The estimated natural logarithm $\\log(\\widehat{\\mathrm{OR}})$ rounded to six decimal places.\n3. The estimated standard error of $\\log(\\widehat{\\mathrm{OR}})$ rounded to six decimal places.\n4. The lower bound of the $(1-\\alpha)$ CI for the odds ratio, rounded to six decimal places.\n5. The upper bound of the $(1-\\alpha)$ CI for the odds ratio, rounded to six decimal places.\n6. The two-sided Wald test p-value for testing that the true odds ratio equals $1$, rounded to six decimal places.\n7. A boolean indicating whether to reject the null hypothesis at significance level $\\alpha$ (use $True$ to indicate rejection and $False$ otherwise).\n\nTest Suite:\nUse the following six test cases, each specified by $(a,b,c,d)$ in that order:\n- Case 1 (general moderate counts): $(40,60,20,80)$.\n- Case 2 (boundary condition with a zero cell): $(0,50,30,70)$.\n- Case 3 (near-null association): $(30,70,28,72)$.\n- Case 4 (association below one): $(10,90,30,70)$.\n- Case 5 (boundary condition with a zero control exposure cell): $(5,95,0,100)$.\n- Case 6 (large-sample stability): $(1000,1500,1100,1400)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a comma-separated list enclosed in square brackets in the same order as specified above. Do not include any spaces in the output. For example, the output format should look like:\n$[\\,[x_{11},x_{12},\\dots,x_{17}],[x_{21},x_{22},\\dots,x_{27}],\\dots\\,]$,\nwhere $x_{ij}$ are the computed values for case $i$ and element $j$.",
            "solution": "The problem is valid as it presents a well-defined, scientifically grounded, and objective task based on standard principles of biostatistics and epidemiology. It is self-contained, with all necessary data and methods specified. No inconsistencies, ambiguities, or unsound premises are present. We may therefore proceed with the derivation and solution.\n\nThe problem requires the analysis of data from a case-control study presented in a $2 \\times 2$ contingency table with the following cell counts:\n- $a$: Exposed cases (disease present, exposure present)\n- $b$: Unexposed cases (disease present, exposure absent)\n- $c$: Exposed controls (disease absent, exposure present)\n- $d$: Unexposed controls (disease absent, exposure absent)\n\nThe total number of cases is $n_1 = a+b$ and the total number of controls is $n_2 = c+d$. The sampling is performed such that a number of cases and a number of controls are selected, and their exposure history is then ascertained.\n\n**1. Estimation of the Odds Ratio ($\\mathrm{OR}$)**\n\nThe odds of exposure among the cases is estimated as the ratio of exposed to unexposed cases, $\\mathrm{Odds}_{\\text{cases}} = a/b$.\nThe odds of exposure among the controls is estimated as the ratio of exposed to unexposed controls, $\\mathrm{Odds}_{\\text{controls}} = c/d$.\n\nThe sample odds ratio, denoted as $\\widehat{\\mathrm{OR}}$, is the ratio of these two odds. It serves as an estimator for the true population odds ratio, $\\mathrm{OR}$.\n\n$$\n\\widehat{\\mathrm{OR}} = \\frac{a/b}{c/d} = \\frac{ad}{bc}\n$$\n\nThis is the maximum likelihood estimator of the odds ratio. A value of $\\widehat{\\mathrm{OR}} > 1$ suggests a positive association between the exposure and the disease, a value of $\\widehat{\\mathrm{OR}}  1$ suggests a negative (protective) association, and a value near $1$ suggests no association.\n\nA practical issue arises if any of the cell counts $a, b, c, d$ are zero. If $b=0$ or $c=0$, the estimator is undefined. If $a=0$ or $d=0$ (and $b, c \\neq 0$), the estimator becomes $0$ or infinite. To circumvent this, the Haldane–Anscombe correction is applied. As specified, if any cell count is $0$, we add $0.5$ to all four cells. Let the (possibly corrected) counts be $a', b', c', d'$. The corrected estimator is:\n\n$$\n\\widehat{\\mathrm{OR}} = \\frac{a'd'}{b'c'}\n$$\nwhere $a' = a+0.5$, $b' = b+0.5$, $c' = c+0.5$, and $d' = d+0.5$ if any original count is $0$; otherwise $a'=a$, $b'=b$, $c'=c$, $d'=d$.\n\n**2. The Log Odds Ratio and its Standard Error**\n\nFor statistical inference, it is highly advantageous to work with the natural logarithm of the odds ratio, $\\log(\\widehat{\\mathrm{OR}})$. The sampling distribution of $\\log(\\widehat{\\mathrm{OR}})$ is more closely approximated by a normal distribution than that of $\\widehat{\\mathrm{OR}}$, especially in finite samples.\n\nThe estimated log odds ratio is:\n$$\n\\log(\\widehat{\\mathrm{OR}}) = \\log\\left(\\frac{a'd'}{b'c'}\\right) = \\log(a') + \\log(d') - \\log(b') - \\log(c')\n$$\n\nThe variance of the log odds ratio estimator can be approximated using the delta method. The large-sample approximation for the variance of $\\log(\\widehat{\\mathrm{OR}})$ is given by the sum of the reciprocals of the cell counts:\n$$\n\\mathrm{Var}(\\log(\\widehat{\\mathrm{OR}})) \\approx \\frac{1}{a'} + \\frac{1}{b'} + \\frac{1}{c'} + \\frac{1}{d'}\n$$\n\nThe standard error of the log odds ratio, $\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$, is the square root of this estimated variance:\n$$\n\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})] = \\sqrt{\\frac{1}{a'} + \\frac{1}{b'} + \\frac{1}{c'} + \\frac{1}{d'}}\n$$\n\n**3. Confidence Interval for the Odds Ratio**\n\nLeveraging the normal approximation for the log odds ratio, a two-sided $(1-\\alpha)$ confidence interval (CI) for the true log odds ratio, $\\log(\\mathrm{OR})$, is constructed as:\n$$\n\\log(\\widehat{\\mathrm{OR}}) \\pm z_{1-\\alpha/2} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]\n$$\nwhere $z_{1-\\alpha/2}$ is the $(1-\\alpha/2)$-quantile of the standard normal distribution. For a significance level of $\\alpha = 0.05$, we require the $1 - 0.05/2 = 0.975$ quantile, for which $z_{0.975} \\approx 1.95996$.\n\nLet the lower and upper bounds of this CI be $L = \\log(\\widehat{\\mathrm{OR}}) - z_{0.975} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$ and $U = \\log(\\widehat{\\mathrm{OR}}) + z_{0.975} \\cdot \\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$.\n\nTo obtain the confidence interval for the odds ratio $\\mathrm{OR}$ itself, we exponentiate these bounds:\n$$\n\\text{CI for OR} = [\\exp(L), \\exp(U)]\n$$\n\n**4. Wald Hypothesis Test**\n\nWe wish to test the null hypothesis $H_0$ that there is no association between exposure and disease, which corresponds to a true odds ratio of $1$. The alternative hypothesis $H_1$ is that there is an association.\n- $H_0: \\mathrm{OR} = 1$\n- $H_1: \\mathrm{OR} \\neq 1$\n\nOn the log scale, this is equivalent to:\n- $H_0: \\log(\\mathrm{OR}) = 0$\n- $H_1: \\log(\\mathrm{OR}) \\neq 0$\n\nThe Wald test statistic, $Z$, is constructed by dividing the estimated log odds ratio by its standard error. This measures how many standard errors the estimate is away from the null value of $0$.\n$$\nZ = \\frac{\\log(\\widehat{\\mathrm{OR}}) - 0}{\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]} = \\frac{\\log(\\widehat{\\mathrm{OR}})}{\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]}\n$$\nUnder $H_0$, this statistic $Z$ follows approximately a standard normal distribution, $\\mathcal{N}(0, 1)$.\n\nThe two-sided p-value is the probability of observing a test statistic at least as extreme as the one observed, assuming $H_0$ is true. It is calculated as:\n$$\np = P(|Z_{obs}| \\ge |z|) = 2 \\times P(Z_{obs} \\ge |z|) = 2 \\times (1 - \\Phi(|z|))\n$$\nwhere $z$ is the observed value of the test statistic $Z$, and $\\Phi(\\cdot)$ is the cumulative distribution function (CDF) of the standard normal distribution.\n\nThe null hypothesis $H_0$ is rejected at the significance level $\\alpha$ if the calculated p-value is less than or equal to $\\alpha$. For this problem, we reject $H_0$ if $p \\le 0.05$.\n\nThe procedure will be applied to each test case, yielding the seven required outputs:\n1. $\\widehat{\\mathrm{OR}}$\n2. $\\log(\\widehat{\\mathrm{OR}})$\n3. $\\widehat{\\mathrm{SE}}[\\log(\\widehat{\\mathrm{OR}})]$\n4. Lower bound of the $95\\%$ CI for $\\mathrm{OR}$\n5. Upper bound of the $95\\%$ CI for $\\mathrm{OR}$\n6. The two-sided Wald test p-value\n7. A boolean indicating rejection of $H_0$ at $\\alpha=0.05$.\nAll numerical results will be rounded to six decimal places.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n\ndef solve():\n    \"\"\"\n    Main function to process test cases and generate the final output string.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, b, c, d)\n        (40, 60, 20, 80),    # Case 1: general moderate counts\n        (0, 50, 30, 70),     # Case 2: boundary condition with a zero cell\n        (30, 70, 28, 72),    # Case 3: near-null association\n        (10, 90, 30, 70),    # Case 4: association below one\n        (5, 95, 0, 100),     # Case 5: boundary condition with a zero control exposure cell\n        (1000, 1500, 1100, 1400), # Case 6: large-sample stability\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _calculate_or_statistics(*case)\n        results.append(result)\n\n    # Format the final output string as per the problem specification.\n    # e.g., [[val1,val2,...],[val1,val2,...]] with no spaces.\n    # The str() function for a boolean correctly produces 'True' or 'False'.\n    output_str = f\"[{','.join([f'[{\",\".join(map(str, r))}]' for r in results])}]\"\n    print(output_str)\n\ndef _calculate_or_statistics(a, b, c, d):\n    \"\"\"\n    Calculates statistics related to the odds ratio for a 2x2 table.\n\n    Args:\n        a (int): Exposed cases\n        b (int): Unexposed cases\n        c (int): Exposed controls\n        d (int): Unexposed controls\n\n    Returns:\n        list: A list containing 7 elements:\n              1. Estimated odds ratio\n              2. Natural log of the estimated odds ratio\n              3. Standard error of the log odds ratio\n              4. Lower bound of the 95% CI for the odds ratio\n              5. Upper bound of the 95% CI for the odds ratio\n              6. Wald test p-value\n              7. Boolean for rejection of the null hypothesis at alpha=0.05\n    \"\"\"\n    alpha = 0.05\n    a_calc, b_calc, c_calc, d_calc = float(a), float(b), float(c), float(d)\n\n    # Apply Haldane–Anscombe correction if any cell is zero.\n    if a == 0 or b == 0 or c == 0 or d == 0:\n        a_calc += 0.5\n        b_calc += 0.5\n        c_calc += 0.5\n        d_calc += 0.5\n\n    # 1. Estimate the odds ratio (OR_hat)\n    # Check for division by zero in the denominator, even after correction (though unlikely)\n    if b_calc == 0 or c_calc == 0:\n        # This case is highly pathological and shouldn't occur with the correction\n        # in place for non-negative integer inputs. We handle it defensively.\n        return [None] * 7\n        \n    or_hat = (a_calc * d_calc) / (b_calc * c_calc)\n\n    # 2. Estimate the natural logarithm of the odds ratio\n    log_or_hat = np.log(or_hat)\n\n    # 3. Estimate the standard error of the log odds ratio\n    se_log_or_hat = np.sqrt(1/a_calc + 1/b_calc + 1/c_calc + 1/d_calc)\n\n    # 4.  5. Construct a (1-alpha) CI for the true odds ratio\n    z_alpha_2 = norm.ppf(1 - alpha / 2)\n    log_ci_lower = log_or_hat - z_alpha_2 * se_log_or_hat\n    log_ci_upper = log_or_hat + z_alpha_2 * se_log_or_hat\n    \n    ci_or_lower = np.exp(log_ci_lower)\n    ci_or_upper = np.exp(log_ci_upper)\n\n    # 6. Perform a two-sided Wald hypothesis test (H0: OR = 1, i.e., log(OR) = 0)\n    wald_z_stat = log_or_hat / se_log_or_hat\n    p_value = 2 * norm.sf(np.abs(wald_z_stat)) # sf = 1 - cdf, more accurate for tails\n\n    # 7. Determine whether to reject the null hypothesis\n    reject_h0 = p_value = alpha\n\n    # Round numerical results to six decimal places\n    return [\n        round(or_hat, 6),\n        round(log_or_hat, 6),\n        round(se_log_or_hat, 6),\n        round(ci_or_lower, 6),\n        round(ci_or_upper, 6),\n        round(p_value, 6),\n        reject_h0\n    ]\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "Real-world data is rarely as neat as in textbooks, and this exercise tackles a common challenge: sparse data, specifically the presence of a \"zero cell\" in a contingency table. We will investigate what happens to our standard odds ratio calculation in this scenario and why the large-sample methods you learned previously may no longer be reliable. This practice introduces the importance of exact statistical tests, which provide a robust alternative for making valid inferences when data is limited .",
            "id": "4616364",
            "problem": "An unmatched case-control study investigates whether exposure to a rare contaminant is associated with a disease. The data are summarized in a $2\\times 2$ table with cell counts as follows (using the usual notation where $a$ is exposed cases, $b$ is unexposed cases, $c$ is exposed controls, and $d$ is unexposed controls): $a=2$, $b=4$, $c=0$, $d=6$. The total number of cases is $n_{1}=6$, the total number of controls is $n_{0}=6$, and the total number of exposed subjects is $m=2$. Assume the standard case-control sampling where $n_{1}$ and $n_{0}$ are fixed by design.\n\nUsing only core definitions from epidemiology and probability, including the definition of odds and the odds ratio (OR), and the fact that under the null hypothesis of no association the conditional distribution of the number of exposed cases given fixed margins is hypergeometric, determine which of the following statements are correct. Select all that apply.\n\nA. The usual sample odds ratio, computed from the cross-product of the $2\\times 2$ table, is infinite for these data.\n\nB. If one applies the Haldane–Anscombe correction (adding $0.5$ to zero cells only) to handle the zero cell and then computes the odds ratio, the estimate is approximately $8.13$.\n\nC. Using Fisher’s exact test (summing hypergeometric probabilities of tables that are as or more extreme than observed under the null), the two-sided exact $p$-value for testing no association is $0.454$.\n\nD. The equal-tailed exact conditional $95\\%$ confidence interval for the odds ratio has no finite upper bound and includes $1$.\n\nE. A Wald $95\\%$ confidence interval for the log-odds ratio based on asymptotic normality is valid here because $n_{1}$ and $n_{0}$ are fixed by design.",
            "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, and objective. It provides a complete and consistent dataset for a standard epidemiological analysis.\n\nThe data from the unmatched case-control study can be summarized in the following $2 \\times 2$ table:\n\n| | Case (Disease +) | Control (Disease -) | Total |\n| :--- | :--- | :--- | :--- |\n| **Exposed** | $a=2$ | $c=0$ | $m_1=2$ |\n| **Unexposed** | $b=4$ | $d=6$ | $m_0=10$|\n| **Total** | $n_1=6$ | $n_0=6$ | $N=12$ |\n\nThe marginal totals are fixed: Total cases $n_1 = a+b = 6$, total controls $n_0 = c+d = 6$, total exposed $m_1 = a+c = 2$, and total unexposed $m_0 = b+d=10$. The total sample size is $N=12$.\n\nWe will now evaluate each statement.\n\n### Analysis of Option A\n**Statement:** The usual sample odds ratio, computed from the cross-product of the $2\\times 2$ table, is infinite for these data.\n\nThe sample odds ratio ($OR$) is an estimate of the population odds ratio. For a case-control study, it is calculated as the ratio of the odds of exposure among cases to the odds of exposure among controls.\nThe odds of exposure among cases is $\\frac{a}{b}$.\nThe odds of exposure among controls is $\\frac{c}{d}$.\nThe sample odds ratio, $\\widehat{OR}$, is therefore:\n$$ \\widehat{OR} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\nSubstituting the given cell counts:\n$$ \\widehat{OR} = \\frac{(2)(6)}{(4)(0)} = \\frac{12}{0} $$\nDivision by zero is an undefined operation. In the context of odds ratios, a zero cell in the denominator ($b$ or $c$) leads to a point estimate that is either $0$ or infinite. Here, with $c=0$, the estimate for the odds ratio is infinite.\n\n**Verdict on A:** Correct. The calculation results in division by zero, yielding an infinite sample odds ratio.\n\n### Analysis of Option B\n**Statement:** If one applies the Haldane–Anscombe correction (adding $0.5$ to zero cells only) to handle the zero cell and then computes the odds ratio, the estimate is approximately $8.13$.\n\nThe statement describes a specific, albeit non-standard, procedure: \"adding $0.5$ to zero cells only\". Let's apply this procedure.\nThe only zero cell is $c=0$.\nThe modified cell counts would be: $a' = 2$, $b' = 4$, $c' = 0+0.5 = 0.5$, $d' = 6$.\nThe odds ratio computed from these modified counts is:\n$$ \\widehat{OR} = \\frac{a'd'}{b'c'} = \\frac{(2)(6)}{(4)(0.5)} = \\frac{12}{2} = 6 $$\nThis value is not approximately $8.13$.\n\nIt is more common for the \"Haldane-Anscombe correction\" to refer to adding $0.5$ to *all* cells in the table. Let's compute the odds ratio using this standard procedure:\nThe corrected cell counts are: $a''=2.5$, $b''=4.5$, $c''=0.5$, $d''=6.5$.\nThe resulting odds ratio is:\n$$ \\widehat{OR} = \\frac{a''d''}{b''c''} = \\frac{(2.5)(6.5)}{(4.5)(0.5)} = \\frac{16.25}{2.25} \\approx 7.22 $$\nThis value is also not approximately $8.13$. The statement is factually incorrect based on its own described procedure and based on the standard procedure that shares its name.\n\n**Verdict on B:** Incorrect. The calculation based on the described procedure yields an odds ratio of $6$, and the standard Haldane-Anscombe correction yields approximately $7.22$. Neither matches the claimed value of $8.13$.\n\n### Analysis of Option C\n**Statement:** Using Fisher’s exact test (summing hypergeometric probabilities of tables that are as or more extreme than observed under the null), the two-sided exact $p$-value for testing no association is $0.454$.\n\nUnder the null hypothesis of no association, and conditioning on the marginal totals ($n_1=6, n_0=6, m_1=2, m_0=10$), the count of exposed cases, $a$, follows a hypergeometric distribution. The probability of observing a table with $a$ exposed cases is given by:\n$$ P(a) = \\frac{\\binom{m_1}{a} \\binom{m_0}{n_1-a}}{\\binom{N}{n_1}} = \\frac{\\binom{2}{a} \\binom{10}{6-a}}{\\binom{12}{6}} $$\nThe possible values for $a$ are constrained by the margins: $\\max(0, n_1-m_0) \\le a \\le \\min(n_1, m_1)$, which means $\\max(0, 6-10) \\le a \\le \\min(6, 2)$, so $a \\in \\{0, 1, 2\\}$.\n\nLet's calculate the probabilities for all possible values of $a$:\nThe denominator is $\\binom{12}{6} = \\frac{12!}{6!6!} = 924$.\n- For $a=0$: $P(a=0) = \\frac{\\binom{2}{0}\\binom{10}{6}}{924} = \\frac{1 \\cdot 210}{924} = \\frac{210}{924}$.\n- For $a=1$: $P(a=1) = \\frac{\\binom{2}{1}\\binom{10}{5}}{924} = \\frac{2 \\cdot 252}{924} = \\frac{504}{924}$.\n- For $a=2$ (the observed value): $P(a=2) = \\frac{\\binom{2}{2}\\binom{10}{4}}{924} = \\frac{1 \\cdot 210}{924} = \\frac{210}{924}$.\n\nThe two-sided p-value is the sum of probabilities of tables as or more extreme than the one observed. \"More extreme\" is commonly defined as having a probability equal to or less than the probability of the observed table.\nThe probability of our observed table ($a=2$) is $P(a=2) = 210/924$.\nThe tables with probability less than or equal to this value are for $a=2$ and $a=0$.\nThe two-sided p-value is therefore:\n$$ p = P(a=2) + P(a=0) = \\frac{210}{924} + \\frac{210}{924} = \\frac{420}{924} $$\nSimplifying the fraction: $\\frac{420}{924} = \\frac{210}{462} = \\frac{105}{231} = \\frac{35}{77} = \\frac{5}{11}$.\nAs a decimal, $p = 5/11 \\approx 0.454545...$.\nTruncating to three decimal places gives $0.454$, and rounding gives $0.455$. The stated value of $0.454$ is a valid representation of this result.\n\n**Verdict on C:** Correct. The calculation for the two-sided Fisher's exact test p-value is accurate.\n\n### Analysis of Option D\n**Statement:** The equal-tailed exact conditional $95\\%$ confidence interval for the odds ratio has no finite upper bound and includes $1$.\n\nThe exact conditional confidence interval for the odds ratio ($OR$ or $\\psi$) is constructed by inverting the Fisher's exact test. The interval $[\\psi_L, \\psi_U]$ is found by solving:\n1. $P(X \\ge a | \\psi = \\psi_L) = \\alpha/2$ for the lower bound.\n2. $P(X \\le a | \\psi = \\psi_U) = \\alpha/2$ for the upper bound.\nHere, $a=2$ and $\\alpha=0.05$.\n\n**Upper Bound:** We need to solve $P(X \\le 2 | \\psi_U) = 0.025$. The possible values for the cell count $a$ are $\\{0, 1, 2\\}$. The observed value $a=2$ is the maximum possible value. Therefore, the cumulative probability $P(X \\le 2 | \\psi)$ is the sum over all possible outcomes, which is always $1$ for any value of $\\psi > 0$:\n$$ P(X \\le 2 | \\psi) = P(X=0|\\psi) + P(X=1|\\psi) + P(X=2|\\psi) = 1 $$\nThe equation $1 = 0.025$ has no solution for $\\psi_U$. By convention, when the observed value is the maximum (or minimum) possible, the corresponding confidence limit is set to infinity (or zero). Thus, the upper bound is $\\psi_U = \\infty$.\n\n**Inclusion of $1$:** To determine if $OR=1$ is in the confidence interval, we can perform a hypothesis test of $H_0: OR=1$ with a significance level of $\\alpha=0.05$. If we fail to reject the null hypothesis, then $OR=1$ is included in the $95\\%$ CI. The two-sided p-value for testing $H_0: OR=1$ was calculated in Option C as $p=5/11 \\approx 0.455$.\nSince $p \\approx 0.455 > 0.05$, we do not reject the null hypothesis. Therefore, an odds ratio of $1$ is a plausible value and is included in the $95\\%$ confidence interval.\n\n**Verdict on D:** Correct. The interval has no finite upper bound because the observed cell count is the maximum possible. It includes $1$ because the p-value for the null hypothesis $OR=1$ is greater than $0.05$.\n\n### Analysis of Option E\n**Statement:** A Wald $95\\%$ confidence interval for the log-odds ratio based on asymptotic normality is valid here because $n_1$ and $n_0$ are fixed by design.\n\nThe Wald method for constructing a confidence interval relies on the asymptotic normality of the log-odds ratio estimator. The formula for the confidence interval is $\\log(\\widehat{OR}) \\pm z_{\\alpha/2} \\sqrt{\\widehat{Var}(\\log(\\widehat{OR}))}$, where the estimated variance is:\n$$ \\widehat{Var}(\\log(\\widehat{OR})) = \\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d} $$\nWith the given data, $c=0$. This leads to two immediate problems:\n1. The log-odds ratio itself, $\\log(\\frac{ad}{bc})$, is undefined due to division by zero.\n2. The variance estimate includes the term $1/c$, which is $1/0$, and is therefore infinite.\nThe Wald method is not applicable to these data without modification (like the Haldane-Anscombe correction). More fundamentally, the validity of asymptotic methods like the Wald interval depends on large sample sizes, specifically, reasonably large counts in all cells of the table. With small counts like $a=2$, $b=4$, $d=6$ and especially a zero count $c=0$, the assumption of normality is grossly violated. The justification provided, \"because $n_1$ and $n_0$ are fixed by design\", is the condition for using exact conditional methods (like Fisher's test), not a justification for applying an asymptotic method to sparse data.\n\n**Verdict on E:** Incorrect. The Wald interval is invalid for these data due to the zero cell count and small sample size, which violate the asymptotic assumptions. The provided justification is irrelevant to the validity of the Wald method.",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "An observed association between an exposure and a disease can often be distorted by other variables, a phenomenon known as confounding. This final practice demonstrates a powerful and intuitive method to address confounding: stratified analysis. By calculating an adjusted odds ratio using the Mantel-Haenszel method, you will learn how to pool evidence across different subgroups to obtain a more accurate and unbiased estimate of the true exposure-disease relationship .",
            "id": "4808937",
            "problem": "A medical researcher conducts a stratified case-control study to evaluate the association between a binary exposure $E$ and a binary disease outcome $D$, controlling for a potential confounder by stratification across $3$ levels (e.g., age groups or hospital sites). Within each stratum $k \\in \\{1,2,3\\}$, the data form a $2 \\times 2$ table of counts, with $a_k$ exposed cases, $b_k$ exposed controls, $c_k$ unexposed cases, and $d_k$ unexposed controls. The observed counts are as follows:\n\n- Stratum $1$: $a_1 = 72$, $b_1 = 96$, $c_1 = 48$, $d_1 = 144$.\n- Stratum $2$: $a_2 = 48$, $b_2 = 64$, $c_2 = 32$, $d_2 = 96$.\n- Stratum $3$: $a_3 = 36$, $b_3 = 48$, $c_3 = 24$, $d_3 = 72$.\n\nAssume a common stratum-specific odds ratio across strata. Using the Mantel-Haenszel (MH) approach for stratified analysis in case-control studies, compute the common odds ratio estimator $\\hat{\\theta}_{MH}$ from these data. Round your final numerical answer to four significant figures.\n\nThen, based on fundamental principles of case-control sampling and stratified analysis, explain why a Mantel-Haenszel risk ratio estimator $\\hat{R}_{MH}$ computed from the same $2 \\times 2$ tables would not generally be interpretable in this case-control design without additional information or assumptions. Your explanation should rely on first principles of what is and is not identified under case-control sampling, and should not invoke any unproven shortcut formulas. The final answer to be reported is only the computed value of $\\hat{\\theta}_{MH}$ (with the specified rounding).",
            "solution": "The problem requires the calculation of the Mantel-Haenszel (MH) common odds ratio estimator, $\\hat{\\theta}_{MH}$, from a stratified case-control study and an explanation of why the corresponding MH risk ratio estimator is not interpretable in this context.\n\nFirst, we validate the problem statement.\nThe givens are:\n- A stratified case-control study with $3$ strata, indexed by $k \\in \\{1, 2, 3\\}$.\n- For each stratum $k$, the data are given in a $2 \\times 2$ table format: $a_k$ (exposed cases), $b_k$ (exposed controls), $c_k$ (unexposed cases), and $d_k$ (unexposed controls).\n- Data for Stratum $1$: $a_1 = 72$, $b_1 = 96$, $c_1 = 48$, $d_1 = 144$.\n- Data for Stratum $2$: $a_2 = 48$, $b_2 = 64$, $c_2 = 32$, $d_2 = 96$.\n- Data for Stratum $3$: $a_3 = 36$, $b_3 = 48$, $c_3 = 24$, $d_3 = 72$.\n- The assumption of a common odds ratio across strata is provided.\n- The task is to compute $\\hat{\\theta}_{MH}$ and explain the non-interpretability of the MH risk ratio estimator in this experimental design.\n\nThe problem is scientifically grounded, as it concerns a standard and fundamental method in biostatistics and epidemiology. It is well-posed, with all necessary data and definitions provided for a unique solution. The language is objective and precise. The data are internally consistent and realistic for such a study. Therefore, the problem is valid.\n\nWe proceed with the solution.\n\nPart 1: Calculation of the Mantel-Haenszel Common Odds Ratio Estimator $\\hat{\\theta}_{MH}$.\n\nThe Mantel-Haenszel estimator for the common odds ratio, $\\theta$, across $K$ strata is given by the formula:\n$$ \\hat{\\theta}_{MH} = \\frac{\\sum_{k=1}^{K} R_k}{\\sum_{k=1}^{K} S_k} = \\frac{\\sum_{k=1}^{K} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{K} \\frac{b_k c_k}{N_k}} $$\nwhere $N_k = a_k + b_k + c_k + d_k$ is the total number of subjects in stratum $k$.\n\nWe calculate the components for each of the $3$ strata.\n\nFor Stratum $1$ ($k=1$):\n- $a_1 = 72$, $b_1 = 96$, $c_1 = 48$, $d_1 = 144$.\n- The total number of subjects is $N_1 = 72 + 96 + 48 + 144 = 360$.\n- The numerator component is $R_1 = \\frac{a_1 d_1}{N_1} = \\frac{72 \\times 144}{360} = \\frac{10368}{360} = 28.8$.\n- The denominator component is $S_1 = \\frac{b_1 c_1}{N_1} = \\frac{96 \\times 48}{360} = \\frac{4608}{360} = 12.8$.\n\nFor Stratum $2$ ($k=2$):\n- $a_2 = 48$, $b_2 = 64$, $c_2 = 32$, $d_2 = 96$.\n- The total number of subjects is $N_2 = 48 + 64 + 32 + 96 = 240$.\n- The numerator component is $R_2 = \\frac{a_2 d_2}{N_2} = \\frac{48 \\times 96}{240} = \\frac{4608}{240} = 19.2$.\n- The denominator component is $S_2 = \\frac{b_2 c_2}{N_2} = \\frac{64 \\times 32}{240} = \\frac{2048}{240} = \\frac{128}{15}$.\n\nFor Stratum $3$ ($k=3$):\n- $a_3 = 36$, $b_3 = 48$, $c_3 = 24$, $d_3 = 72$.\n- The total number of subjects is $N_3 = 36 + 48 + 24 + 72 = 180$.\n- The numerator component is $R_3 = \\frac{a_3 d_3}{N_3} = \\frac{36 \\times 72}{180} = \\frac{2592}{180} = 14.4$.\n- The denominator component is $S_3 = \\frac{b_3 c_3}{N_3} = \\frac{48 \\times 24}{180} = \\frac{1152}{180} = 6.4$.\n\nNow, we sum the components across all strata:\n$$ \\sum_{k=1}^{3} R_k = R_1 + R_2 + R_3 = 28.8 + 19.2 + 14.4 = 62.4 $$\n$$ \\sum_{k=1}^{3} S_k = S_1 + S_2 + S_3 = 12.8 + \\frac{128}{15} + 6.4 = 19.2 + \\frac{128}{15} = \\frac{19.2 \\times 15 + 128}{15} = \\frac{288 + 128}{15} = \\frac{416}{15} $$\n\nFinally, we compute the Mantel-Haenszel estimator:\n$$ \\hat{\\theta}_{MH} = \\frac{\\sum R_k}{\\sum S_k} = \\frac{62.4}{\\frac{416}{15}} = \\frac{62.4 \\times 15}{416} = \\frac{936}{416} $$\nSimplifying the fraction:\n$$ \\hat{\\theta}_{MH} = \\frac{936 \\div 104}{416 \\div 104} = \\frac{9}{4} = 2.25 $$\nThe problem asks for the answer to be rounded to four significant figures. This gives $2.250$.\n\nA noteworthy feature of this dataset is that the stratum-specific odds ratio is constant:\n$\\hat{OR}_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{72 \\times 144}{96 \\times 48} = 2.25$.\n$\\hat{OR}_2 = \\frac{a_2 d_2}{b_2 c_2} = \\frac{48 \\times 96}{64 \\times 32} = 2.25$.\n$\\hat{OR}_3 = \\frac{a_3 d_3}{b_3 c_3} = \\frac{36 \\times 72}{48 \\times 24} = 2.25$.\nWhen the stratum-specific odds ratios are identical, the MH estimator equals this common value, which our calculation confirms.\n\nPart 2: Non-Interpretability of the Mantel-Haenszel Risk Ratio ($\\hat{R}_{MH}$) in a Case-Control Study.\n\nThe explanation rests on the fundamental principles of study design and what parameters are identifiable from the resulting data.\n\n$1$. **Case-Control Sampling Principle**: A case-control study samples subjects based on their disease outcome status ($D$). A group of individuals with the disease (cases, $D=1$) and a separate group without the disease (controls, $D=0$) are recruited. The researchers then ascertain the prior exposure status ($E$) for subjects in both groups. The number of cases and controls in the study is fixed by the design and does not typically reflect the prevalence of the disease in the source population.\n\n$2$. **Identifiable vs. Non-Identifiable Parameters**:\n   - Because sampling is conditional on $D$, a case-control study allows for the direct estimation of the probability of exposure given disease status, $P(E|D)$. Within stratum $k$, we can estimate $P(E=1|D=1, k)$ from the proportion $\\frac{a_k}{a_k+c_k}$ and $P(E=1|D=0, k)$ from $\\frac{b_k}{b_k+d_k}$.\n   - This allows for the calculation of the *exposure odds ratio*:\n     $$ OR_{\\text{exposure}, k} = \\frac{P(E=1|D=1, k) / P(E=0|D=1, k)}{P(E=1|D=0, k) / P(E=0|D=0, k)} = \\frac{a_k/c_k}{b_k/d_k} = \\frac{a_k d_k}{b_k c_k} $$\n   - A crucial property of the odds ratio is its invariance to the study design. The exposure odds ratio is mathematically identical to the *disease odds ratio* that one would estimate in a cohort study:\n     $$ OR_{\\text{disease}, k} = \\frac{P(D=1|E=1, k) / P(D=0|E=1, k)}{P(D=1|E=0, k) / P(D=0|E=0, k)} $$\n   - Thus, the odds ratio is an identifiable parameter in a case-control study.\n\n$3$. **The Problem with Risk and Risk Ratio**:\n   - The *risk* of disease is the conditional probability $P(D|E)$. Specifically, the risk in the exposed is $P(D=1|E=1)$ and the risk in the unexposed is $P(D=1|E=0)$.\n   - The *risk ratio* ($RR$) is the ratio of these risks: $RR = \\frac{P(D=1|E=1)}{P(D=1|E=0)}$.\n   - To estimate risk, one needs to sample based on exposure status ($E$), as is done in a cohort study. In a cohort study, the proportions $\\frac{a_k}{a_k+b_k}$ and $\\frac{c_k}{c_k+d_k}$ are valid estimates of the risk in the exposed and unexposed groups within stratum $k$, respectively.\n   - However, in a case-control study, the quantities $a_k+b_k$ (total exposed subjects in the sample) and $c_k+d_k$ (total unexposed subjects in the sample) do not represent a random sample of all exposed and unexposed individuals in the source population. The number of cases ($a_k$, $c_k$) and controls ($b_k$, $d_k$) in these totals is an artifact of the sampling ratios chosen by the investigator.\n   - Consequently, the quantities $\\frac{a_k}{a_k+b_k}$ and $\\frac{c_k}{c_k+d_k}$ computed from case-control data do not estimate the true population risks. They are not interpretable as $P(D=1|E=1, k)$ and $P(D=1|E=0, k)$.\n\n$4$. **Invalidity of the $\\hat{R}_{MH}$ Formula**: The Mantel-Haenszel risk ratio estimator is formulated as:\n   $$ \\hat{R}_{MH} = \\frac{\\sum_{k=1}^{K} \\frac{a_k (c_k+d_k)}{N_k}}{\\sum_{k=1}^{K} \\frac{c_k (a_k+b_k)}{N_k}} $$\n   This formula is a weighted average of stratum-specific risk ratios, constructed from terms that estimate risk in cohort studies. Since the component quantities needed to estimate stratum-specific risks are not identifiable from case-control data, applying this formula to such data produces a numerical value that is devoid of the intended epidemiological interpretation. It does not estimate the true common risk ratio. An estimate of the risk ratio can only be obtained from case-control data under additional assumptions (e.g., the rare disease assumption, where $OR \\approx RR$) or with external information (e.g., population disease prevalence), neither of which are provided in the problem statement.",
            "answer": "$$\\boxed{2.250}$$"
        }
    ]
}