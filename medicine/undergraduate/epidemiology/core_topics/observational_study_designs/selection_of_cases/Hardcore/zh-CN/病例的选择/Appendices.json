{
    "hands_on_practices": [
        {
            "introduction": "在流行病学监测中，一个核心挑战是确定我们找到了多少比例的真实病例。由于资源限制或病例症状不明显，任何单一的数据来源（如医院记录或实验室报告）都可能是不完整的。本练习将介绍一种经典的“捕获-再捕获”方法，它通过比较两个独立来源的数据来估计病例总数和监测系统的完整性，这对于评估和改进公共卫生监测至关重要。",
            "id": "4633812",
            "problem": "一个公共卫生监测团队在短期内对一个确定的、封闭的人群进行了一项双源病例发现活动，以估计某种疾病的病例确定完整性。数据源$1$确定了$n_{1}=120$例病例，数据源$2$确定了$n_{2}=150$例病例，经过记录链接后，两个数据源共有$m=60$例匹配病例。假设标准的双源捕获-再捕获框架适用：在此期间内人群是封闭的，数据源是独立的，且每个病例被捕获的概率相等（等可捕获性）。将总体完整性定义为所有真实病例中至少出现在两个数据源之一的病例所占的比例。从独立且无放回的双样本捕获-再捕获抽样的第一性原理出发，推导出一个真实病例总数的估计量，然后推导出相应的总体完整性估计量。在估计真实病例总数时，请使用一个经过充分检验的小样本偏差校正方法。计算完整性的数值（以小数形式表示），并将您的答案四舍五入到四位有效数字。最后，如果项目设定的完整性目标为至少$0.9$，请简要解释是否可能需要额外的数据源。",
            "solution": "该问题被评估为有效，因为它代表了捕获-再捕获方法在流行病学中的一个标准应用，具有科学依据，提法得当且客观。\n\n问题要求推导病例总数和总体完整性的估计量，进行数值计算，并基于结果进行解释。我们将根据所述假设从第一性原理出发进行推导。\n\n设$N$为封闭人群中的真实病例总数。设$n_{1}$为数据源1确定的病例数，设$n_{2}$为数据源2确定的病例数。设$m$为两个数据源共同确定的病例数。给定值为$n_{1}=120$，$n_{2}=150$，$m=60$。\n\n核心假设是：\n1. 病例人群是封闭的（在监测期间没有新病例进入或现有病例离开）。\n2. 两个数据源是独立的。这意味着被数据源1捕获的概率与被数据源2捕获的概率无关。\n3. 每个病例被任一特定数据源捕获的概率相等（等可捕获性）。\n\n从第一性原理出发，一个病例被数据源1捕获的概率估计为 $p_1 = \\frac{n_1}{N}$。\n类似地，一个病例被数据源2捕获的概率估计为 $p_2 = \\frac{n_2}{N}$。\n\n在独立性假设下，一个病例同时被数据源1和数据源2捕获的概率是各自概率的乘积：\n$$p_{12} = p_1 \\times p_2 = \\left(\\frac{n_1}{N}\\right) \\left(\\frac{n_2}{N}\\right) = \\frac{n_1 n_2}{N^2}$$\n被两个数据源都捕获的病例的期望数，$E[m]$，是病例总数$N$乘以这个联合概率：\n$$E[m] = N \\times p_{12} = N \\times \\frac{n_1 n_2}{N^2} = \\frac{n_1 n_2}{N}$$\n根据矩估计法，我们可以通过令观测值$m$等于其期望值来推导出$N$的估计量，记为$\\hat{N}$：\n$$m = \\frac{n_1 n_2}{\\hat{N}}$$\n求解$\\hat{N}$得到Lincoln-Petersen估计量，它在此模型下也是最大似然估计量：\n$$\\hat{N}_{LP} = \\frac{n_1 n_2}{m}$$\n已知该估计量是有偏的，尤其是在小样本中。问题指定使用一个经过充分检验的小样本偏差校正方法。标准的选择是Chapman估计量，它为$N$提供了一个近似无偏的估计。Chapman估计量，$\\hat{N}_C$，推导如下：\n$$\\hat{N}_C = \\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1$$\n这就是我们将要使用的真实病例总数的估计量。\n\n接下来，我们推导总体完整性的估计量。总体完整性，$C$，被定义为所有真实病例中至少出现在两个数据源之一的病例所占的比例。\n由数据源1或数据源2（或两者）发现的独立病例总数由容斥原理给出：\n$$U = n_1 + n_2 - m$$\n完整性$C$是发现的独立病例数与真实病例总数的比率：\n$$C = \\frac{U}{N} = \\frac{n_1 + n_2 - m}{N}$$\n使用我们对$N$的偏差校正估计量，相应的完整性估计量，$\\hat{C}$，是：\n$$\\hat{C} = \\frac{n_1 + n_2 - m}{\\hat{N}_C} = \\frac{n_1 + n_2 - m}{\\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1}$$\n现在，我们使用给定的数据计算该估计量的数值：$n_{1}=120$，$n_{2}=150$，$m=60$。\n\n首先，我们计算确定的独立病例数，$U$：\n$$U = 120 + 150 - 60 = 210$$\n接着，我们计算估计的病例总数，$\\hat{N}_C$：\n$$\\hat{N}_C = \\frac{(120 + 1)(150 + 1)}{60+1} - 1 = \\frac{121 \\times 151}{61} - 1 = \\frac{18271}{61} - 1$$\n$$\\hat{N}_C \\approx 299.52459 - 1 = 298.52459$$\n最后，我们计算估计的完整性，$\\hat{C}$：\n$$\\hat{C} = \\frac{U}{\\hat{N}_C} = \\frac{210}{298.52459} \\approx 0.7034633$$\n四舍五入到四位有效数字，我们得到：\n$$\\hat{C} \\approx 0.7035$$\n\n对于问题的最后一部分，我们解释这个结果。双源监测系统的估计完整性约为$0.7035$，即$70.35\\%$。项目设定的完整性目标是至少$0.9$，即$90\\%$。由于$0.7035  0.9$，当前系统的性能远未达到目标。因此，为了实现项目目标，极有可能需要额外的数据源来进行病例发现，以提高被确定的病例的总体比例。",
            "answer": "$$\\boxed{0.7035}$$"
        },
        {
            "introduction": "病例-对照研究是流行病学中一种高效的研究设计，它通过选择所有病例（或其代表性样本）和一组非病例（对照组）来探究暴露与疾病之间的关联。然而，这种选择方式决定了我们能从中计算出何种关联度量。本练习将通过一个具体场景，揭示病例-对照研究的一个基本原理：它能够准确估计优势比（$OR$），但在没有额外假设的情况下无法直接计算风险比（$RR$）。",
            "id": "4633739",
            "problem": "一个源人群包含 $N = 12{,}000$ 名个体，在一个固定的风险期内进行观察，随访失访可忽略不计。暴露状态在基线时被确定。其中，$E = 2{,}400$ 人为暴露者，$U = 9{,}600$ 人为非暴露者。目标疾病在暴露者中的发病比例（风险）为 $R_{1} = 0.03$，在非暴露者中为 $R_{0} = 0.015$。一项独立的病例-对照研究从同一源人群中进行，通过独立抽样固定比例的病例和固定比例的非病例。其抽样概率仅取决于病例状态，而不取决于暴露状态。具体来说，该研究抽取了所有新发病例中的 $s_{c} = \\frac{2}{3}$ 和所有非病例中的 $s_{n} = \\frac{1}{12}$。\n\n仅使用发病比例、比值、风险比和比值比的核心定义，以及所述的病例-对照选择机制：\n\n1. 构建基础队列中暴露按疾病划分的 $2 \\times 2$ 表，并计算队列风险比 $RR$。\n2. 计算队列比值比 $OR_{\\text{cohort}}$。\n3. 根据给定的抽样分数，构建病例-对照样本中暴露按病例状态划分的期望 $2 \\times 2$ 表，并计算病例-对照研究的比值比 $OR_{\\text{cc}}$。证明在所述的选择机制下，$OR_{\\text{cc}}$ 是否等于 $OR_{\\text{cohort}}$。\n4. 由于总发病率低于 $0.05$，通过计算相对偏差 $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$ 来评估低发病率近似的准确性。\n\n按顺序报告以下三个量，每个都作为无量纲数：$OR_{\\text{cc}}$、$RR$ 和 $\\Delta$。将报告的每个量四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于既定的流行病学原理，内容自洽，并为得出唯一且有意义的解提供了所有必要的数据和定义。该问题提法得当且客观。\n\n分析按顺序处理问题的四个部分。\n\n给定参数如下：\n- 源人群规模：$N = 12,000$\n- 暴露个体数：$E = 2,400$\n- 非暴露个体数：$U = 9,600$\n- 暴露者的发病比例（风险）：$R_{1} = 0.03$\n- 非暴露者的发病比例（风险）：$R_{0} = 0.015$\n- 病例的抽样分数：$s_{c} = \\frac{2}{3}$\n- 非病例的抽样分数：$s_{n} = \\frac{1}{12}$\n\n1. 构建队列 $2 \\times 2$ 表并计算风险比 ($RR$)。\n\n首先，我们确定源人群中暴露组和非暴露组内的病例数和非病例数。\n设 $C_{1}$ 为暴露者中的病例数，$N_{1}$ 为暴露者中的非病例数。\n$C_{1} = E \\times R_{1} = 2,400 \\times 0.03 = 72$\n$N_{1} = E \\times (1 - R_{1}) = 2,400 \\times (1 - 0.03) = 2,400 \\times 0.97 = 2,328$\n\n设 $C_{0}$ 为非暴露者中的病例数，$N_{0}$ 为非暴露者中的非病例数。\n$C_{0} = U \\times R_{0} = 9,600 \\times 0.015 = 144$\n$N_{0} = U \\times (1 - R_{0}) = 9,600 \\times (1 - 0.015) = 9,600 \\times 0.985 = 9,456$\n\n因此，源人群（队列）的 $2 \\times 2$ 表如下：\n\n|        | 病例   | 非病例 | 总计   |\n| :----- | :--- | :----- | :----- |\n| 暴露   | a=72 | b=2,328 | 2,400   |\n| 非暴露 | c=144| d=9,456 | 9,600   |\n| 总计   | 216  | 11,784  | 12,000  |\n\n风险比 $RR$ 是暴露者的风险与非暴露者的风险之比。\n$$RR = \\frac{R_{1}}{R_{0}} = \\frac{0.03}{0.015} = 2$$\n\n2. 计算队列比值比 ($OR_{\\text{cohort}}$)。\n\n暴露组的疾病比值为 $O_{1} = \\frac{R_{1}}{1 - R_{1}}$。\n非暴露组的疾病比值为 $O_{0} = \\frac{R_{0}}{1 - R_{0}}$。\n队列比值比是这些比值的比率：\n$$OR_{\\text{cohort}} = \\frac{O_{1}}{O_{0}} = \\frac{R_{1} / (1 - R_{1})}{R_{0} / (1 - R_{0})} = \\frac{0.03 / (1 - 0.03)}{0.015 / (1 - 0.015)} = \\frac{0.03 / 0.97}{0.015 / 0.985}$$\n$$OR_{\\text{cohort}} = \\frac{0.03}{0.015} \\times \\frac{0.985}{0.97} = 2 \\times \\frac{0.985}{0.97} \\approx 2.0309278$$\n或者，使用来自队列研究表 ($a, b, c, d$) 的交叉乘积比：\n$$OR_{\\text{cohort}} = \\frac{ad}{bc} = \\frac{72 \\times 9,456}{2,328 \\times 144} = \\frac{680,832}{335,232} \\approx 2.0309278$$\n结果相同。\n\n3. 构建病例-对照表并计算病例-对照研究的比值比 ($OR_{\\text{cc}}$)。\n\n病例-对照研究抽取了所有病例的 $s_{c} = \\frac{2}{3}$ 和所有非病例的 $s_{n} = \\frac{1}{12}$。病例-对照研究表中的期望计数（用撇号表示）为：\n- 暴露病例：$a' = a \\times s_{c} = 72 \\times \\frac{2}{3} = 48$\n- 非暴露病例：$c' = c \\times s_{c} = 144 \\times \\frac{2}{3} = 96$\n- 暴露对照（非病例）：$b' = b \\times s_{n} = 2,328 \\times \\frac{1}{12} = 194$\n- 非暴露对照（非病例）：$d' = d \\times s_{n} = 9,456 \\times \\frac{1}{12} = 788$\n\n病例-对照研究的期望 $2 \\times 2$ 表如下：\n\n|        | 病例   | 对照   |\n| :----- | :--- | :----- |\n| 暴露   | a'=48| b'=194 |\n| 非暴露 | c'=96| d'=788 |\n\n病例-对照研究的比值比 $OR_{\\text{cc}}$ 是此表的交叉乘积比：\n$$OR_{\\text{cc}} = \\frac{a'd'}{b'c'} = \\frac{48 \\times 788}{194 \\times 96} = \\frac{37,824}{18,624} \\approx 2.0309278$$\n\n$OR_{\\text{cc}} = OR_{\\text{cohort}}$ 的证明：\n病例-对照研究的比值比计算为 $OR_{\\text{cc}} = \\frac{a'd'}{b'c'}$。代入抽样计数的表达式：\n$$OR_{\\text{cc}} = \\frac{(a \\cdot s_{c})(d \\cdot s_{n})}{(b \\cdot s_{n})(c \\cdot s_{c})} = \\frac{ad \\cdot s_{c}s_{n}}{bc \\cdot s_{c}s_{n}}$$\n由于抽样分数 $s_{c}$ 和 $s_{n}$ 是不依赖于暴露状态的常数，它们在分子和分母中被消去。\n$$OR_{\\text{cc}} = \\frac{ad}{bc} = OR_{\\text{cohort}}$$\n这表明，当病例和对照的选择概率与暴露状态无关时，病例-对照研究的比值比是队列比值比的无偏估计量。我们的数值计算证实了这一相等关系。\n\n4. 评估低发病率近似。\n\n问题要求计算相对偏差 $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$。\n使用计算出的值：\n$OR_{\\text{cc}} \\approx 2.0309278$\n$RR = 2$\n$$\\Delta = \\frac{|2.0309278 - 2|}{2} = \\frac{0.0309278}{2} \\approx 0.0154639$$\n此近似的前提是总疾病发病率较低。在队列中，病例总数为 $C_1 + C_0 = 72+144 = 216$，总人口为 $N=12,000$。总发病率为 $\\frac{216}{12,000} = 0.018$，低于指定的阈值 $0.05$。“罕见病假设”指出，如果疾病是罕见的，则 $OR \\approx RR$。这个计算量化了在这种特定情况下该近似的误差。与1的偏差是由因子 $\\frac{1-R_0}{1-R_1} = \\frac{1-0.015}{1-0.03} = \\frac{0.985}{0.97} \\approx 1.01546$ 驱动的。相对偏差 $\\Delta$ 简单地是这个因子减去1，即 $|\\frac{1-R_0}{1-R_1} - 1| \\approx 0.01546$。\n\n待报告量的总结，四舍五入到四位有效数字：\n- $OR_{\\text{cc}} \\approx 2.0309 \\rightarrow 2.031$\n- $RR = 2 \\rightarrow 2.000$\n- $\\Delta \\approx 0.0154639 \\rightarrow 0.01546$",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.031  2.000  0.01546 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在现实世界的研究中，病例的选择和定义很少是完美无缺的。诊断测试或病例定义标准的局限性会导致结果的错误分类——即一些真正的病例可能被错误地划为对照组，而一些非病例也可能被错误地划为病例组。本练习将带你直面这一挑战，通过一个实际案例，学习如何利用已知的分类错误率（敏感性$Se$和特异性$Sp$）来校正观察到的关联强度，从而揭示暴露与疾病之间未被偏倚扭曲的真实关联。",
            "id": "4633716",
            "problem": "一项病例对照研究旨在调查二元暴露 $E$ 与二元疾病 $D$ 之间的关联。暴露状态的测量无误。然而，病例的选择并非完美：一些真实病例被错分为对照，而一些真实对照被错分为病例。病例选择的不完美性由病例定义的灵敏度（Se）和特异度（Sp）来表征，并假定其对于暴露是无差异的，即在暴露组和非暴露组中应用相同的 $Se$ 和 $Sp$。\n\n病例选择后观察到以下计数：\n- 观察到的选定病例：$n_{1E} = 340$ 名暴露者和 $n_{1\\bar{E}} = 260$ 名非暴露者。\n- 观察到的选定对照：$n_{0E} = 210$ 名暴露者和 $n_{0\\bar{E}} = 690$ 名非暴露者。\n\n病例定义的灵敏度和特异度分别为 $Se = 0.85$ 和 $Sp = 0.98$。请仅使用核心定义和第一性原理，通过从观察到的错分总数中重建 $(D,E)$ 的预期真实 $2 \\times 2$ 表，来推导暴露与疾病关联的校正比值比。设真实格子计数为 $t_{11}$ (真实患病且暴露)，$t_{10}$ (真实患病但未暴露)，$t_{01}$ (真实未患病但暴露) 和 $t_{00}$ (真实未患病且未暴露)。然后计算校正比值比\n$$\nOR_{\\text{corrected}} = \\frac{t_{11} / t_{10}}{t_{01} / t_{00}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}.\n$$\n假设分类错误与暴露无关。将最终数值答案四舍五入至四位有效数字。无需单位。",
            "solution": "该问题要求在病例对照研究中计算因结局错分而校正的比值比。基本原理是利用提供的观察计数以及病例选择过程的灵敏度和特异度，在每个暴露层内重建真实（未观察到）的患病和非患病个体数量。无差异错分的假设——即灵敏度 $Se$ 和特异度 $Sp$ 对暴露和未暴露个体相同——对于此重建至关重要。\n\n设 $t_{11}$、$t_{10}$、$t_{01}$ 和 $t_{00}$ 代表研究人群的真实格子计数，其中第一个下标表示疾病状态（$1$ 表示患病，$0$ 表示非患病），第二个下标表示暴露状态（$1$ 表示暴露，$0$ 表示未暴露）。设观察计数为 $n_{1E}$（观察到的暴露病例）、$n_{1\\bar{E}}$（观察到的未暴露病例）、$n_{0E}$（观察到的暴露对照）和 $n_{0\\bar{E}}$（观察到的未暴露对照）。\n\n给定值为：\n- $n_{1E} = 340$\n- $n_{1\\bar{E}} = 260$\n- $n_{0E} = 210$\n- $n_{0\\bar{E}} = 690$\n- $Se = 0.85$\n- $Sp = 0.98$\n\n我们分别分析暴露组和未暴露组。\n\n首先，考虑暴露组。研究中暴露个体的总数是观察到的暴露病例和对照的总和：\n$$T_E = n_{1E} + n_{0E} = 340 + 210 = 550$$\n这 $550$ 名个体由 $t_{11}$ 个真实病例和 $t_{01}$ 个真实非病例组成。因此，我们有守恒方程：\n$$t_{11} + t_{01} = 550 \\quad (1)$$\n\n一个观察到的病例要么是一个被正确分类的真实病例（真阳性），要么是一个被错误分类为病例的真实非病例（假阳性）。这种关系表示为：\n$$n_{1E} = t_{11} \\cdot Se + t_{01} \\cdot (1 - Sp)$$\n代入给定的数值：\n$$340 = t_{11} \\cdot (0.85) + t_{01} \\cdot (1 - 0.98)$$\n$$340 = 0.85 t_{11} + 0.02 t_{01} \\quad (2)$$\n\n我们求解由方程 $(1)$ 和 $(2)$ 组成的二元一次方程组，以求出两个未知数 $t_{11}$ 和 $t_{01}$。从方程 $(1)$，我们可以将 $t_{01}$ 写为 $t_{01} = 550 - t_{11}$。将此代入方程 $(2)$：\n$$340 = 0.85 t_{11} + 0.02 (550 - t_{11})$$\n$$340 = 0.85 t_{11} + 11 - 0.02 t_{11}$$\n$$340 - 11 = (0.85 - 0.02) t_{11}$$\n$$329 = 0.83 t_{11}$$\n因此，预期的真实暴露病例数是：\n$$t_{11} = \\frac{329}{0.83}$$\n预期的真实暴露非病例数是：\n$$t_{01} = 550 - t_{11} = 550 - \\frac{329}{0.83} = \\frac{550 \\cdot 0.83 - 329}{0.83} = \\frac{456.5 - 329}{0.83} = \\frac{127.5}{0.83}$$\n\n接下来，我们对未暴露组进行同样的分析。未暴露个体的总数是：\n$$T_{\\bar{E}} = n_{1\\bar{E}} + n_{0\\bar{E}} = 260 + 690 = 950$$\n这 $950$ 名个体包括 $t_{10}$ 个真实病例和 $t_{00}$ 个真实非病例：\n$$t_{10} + t_{00} = 950 \\quad (3)$$\n\n观察到的未暴露病例数 $n_{1\\bar{E}}$ 与真实计数的关系如下：\n$$n_{1\\bar{E}} = t_{10} \\cdot Se + t_{00} \\cdot (1 - Sp)$$\n代入数值：\n$$260 = t_{10} \\cdot (0.85) + t_{00} \\cdot (1 - 0.98)$$\n$$260 = 0.85 t_{10} + 0.02 t_{00} \\quad (4)$$\n\n我们求解方程组 $(3)$ 和 $(4)$ 以求出 $t_{10}$ 和 $t_{00}$。从方程 $(3)$，得 $t_{00} = 950 - t_{10}$。代入方程 $(4)$：\n$$260 = 0.85 t_{10} + 0.02 (950 - t_{10})$$\n$$260 = 0.85 t_{10} + 19 - 0.02 t_{10}$$\n$$260 - 19 = (0.85 - 0.02) t_{10}$$\n$$241 = 0.83 t_{10}$$\n因此，预期的真实未暴露病例数是：\n$$t_{10} = \\frac{241}{0.83}$$\n预期的真实未暴露非病例数是：\n$$t_{00} = 950 - t_{10} = 950 - \\frac{241}{0.83} = \\frac{950 \\cdot 0.83 - 241}{0.83} = \\frac{788.5 - 241}{0.83} = \\frac{547.5}{0.83}$$\n\n在确定了预期的真实计数后，我们可以计算校正后的比值比 $OR_{\\text{corrected}}$：\n$$OR_{\\text{corrected}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}$$\n$$OR_{\\text{corrected}} = \\frac{\\left(\\frac{329}{0.83}\\right) \\left(\\frac{547.5}{0.83}\\right)}{\\left(\\frac{241}{0.83}\\right) \\left(\\frac{127.5}{0.83}\\right)}$$\n分子和分母中的 $(1/0.83)^2$ 项相互抵消，得到：\n$$OR_{\\text{corrected}} = \\frac{329 \\times 547.5}{241 \\times 127.5} = \\frac{180127.5}{30727.5}$$\n$$OR_{\\text{corrected}} \\approx 5.862105$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$OR_{\\text{corrected}} \\approx 5.862$$",
            "answer": "$$\\boxed{5.862}$$"
        }
    ]
}