{
    "hands_on_practices": [
        {
            "introduction": "流行病学研究通常需要在效率和严谨性之间找到平衡。当研究整个人群（队列研究）成本高昂时，病例-对照研究提供了一种高效的替代方案。本练习将通过计算，揭示从同一来源人群中抽样得出的病例-对照研究中的比值比（$OR$）与队列研究中的风险比（$RR$）之间的重要数学联系，并阐明为何在病例选择中 $OR$ 是一个关键的关联度量指标。",
            "id": "4633739",
            "problem": "一个源人群包含 $N = 12{,}000$ 个个体，在一个固定的风险期内进行观察，失访可忽略不计。暴露状态在基线时确定。其中，$E = 2{,}400$ 人为暴露组，$U = 9{,}600$ 人为非暴露组。所研究疾病在暴露组中的发病比例（风险）为 $R_{1} = 0.03$，在非暴露组中的发病比例为 $R_{0} = 0.015$。一项独立的病例-对照研究从同一源人群中进行，通过独立抽样一定比例的病例和一定比例的非病例。选择概率仅取决于病例状态，而与暴露状态无关。具体来说，该研究选择了所有新发病例中的 $s_{c} = \\frac{2}{3}$ 和所有非病例中的 $s_{n} = \\frac{1}{12}$。\n\n仅使用发病比例、比值、风险比和比值比的核心定义，以及所述的病例-对照选择机制：\n\n1. 构建基础队列中暴露与疾病的 $2 \\times 2$ 表，并计算队列风险比 $RR$。\n2. 计算队列比值比 $OR_{\\text{cohort}}$。\n3. 根据给定的选择比例，构建病例-对照样本中暴露与病例状态的预期 $2 \\times 2$ 表，并计算病例-对照比值比 $OR_{\\text{cc}}$。在所述选择机制下，论证 $OR_{\\text{cc}}$ 是否等于 $OR_{\\text{cohort}}$。\n4. 由于总发病率低于 $0.05$，通过计算相对偏差 $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$ 来评估低发病率近似的准确性。\n\n按顺序报告以下三个量，每个量均为无量纲数：$OR_{\\text{cc}}$、$RR$ 和 $\\Delta$。将每个报告的量四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估有效。它在科学上基于既定的流行病学原理，内容自洽，并为得出唯一且有意义的解提供了所有必要的数据和定义。该问题提法恰当且客观。\n\n分析按顺序处理问题的四个部分。\n\n给定参数如下：\n- 源人群规模：$N = 12,000$\n- 暴露组人数：$E = 2,400$\n- 非暴露组人数：$U = 9,600$\n- 暴露组发病比例（风险）：$R_{1} = 0.03$\n- 非暴露组发病比例（风险）：$R_{0} = 0.015$\n- 病例抽样比例：$s_{c} = \\frac{2}{3}$\n- 非病例抽样比例：$s_{n} = \\frac{1}{12}$\n\n1. 构建队列 $2 \\times 2$ 表并计算风险比 ($RR$)。\n\n首先，我们确定源人群中暴露组和非暴露组内的病例数和非病例数。\n设 $C_{1}$ 为暴露组中的病例数，$N_{1}$ 为暴露组中的非病例数。\n$C_{1} = E \\times R_{1} = 2,400 \\times 0.03 = 72$\n$N_{1} = E \\times (1 - R_{1}) = 2,400 \\times (1 - 0.03) = 2,400 \\times 0.97 = 2,328$\n\n设 $C_{0}$ 为非暴露组中的病例数，$N_{0}$ 为非暴露组中的非病例数。\n$C_{0} = U \\times R_{0} = 9,600 \\times 0.015 = 144$\n$N_{0} = U \\times (1 - R_{0}) = 9,600 \\times (1 - 0.015) = 9,600 \\times 0.985 = 9,456$\n\n因此，源人群（队列）的 $2 \\times 2$ 表如下：\n\n| 状态 | 病例 | 非病例 | 总计 |\n|:---|:---:|:---:|:---:|\n| 暴露组 | $a=72$ | $b=2,328$ | $2,400$ |\n| 非暴露组 | $c=144$ | $d=9,456$ | $9,600$ |\n| 总计 | $216$ | $11,784$ | $12,000$ |\n\n风险比 $RR$ 是暴露组风险与非暴露组风险之比。\n$$RR = \\frac{R_{1}}{R_{0}} = \\frac{0.03}{0.015} = 2$$\n\n2. 计算队列比值比 ($OR_{\\text{cohort}}$)。\n\n暴露组的发病比值为 $O_{1} = \\frac{R_{1}}{1 - R_{1}}$。\n非暴露组的发病比值为 $O_{0} = \\frac{R_{0}}{1 - R_{0}}$。\n队列比值比是这两个比值的比率：\n$$OR_{\\text{cohort}} = \\frac{O_{1}}{O_{0}} = \\frac{R_{1} / (1 - R_{1})}{R_{0} / (1 - R_{0})} = \\frac{0.03 / (1 - 0.03)}{0.015 / (1 - 0.015)} = \\frac{0.03 / 0.97}{0.015 / 0.985}$$\n$$OR_{\\text{cohort}} = \\frac{0.03}{0.015} \\times \\frac{0.985}{0.97} = 2 \\times \\frac{0.985}{0.97} \\approx 2.0309278$$\n或者，使用队列中（$a, b, c, d$）的交叉乘积比：\n$$OR_{\\text{cohort}} = \\frac{ad}{bc} = \\frac{72 \\times 9,456}{2,328 \\times 144} = \\frac{680,832}{335,232} \\approx 2.0309278$$\n结果相同。\n\n3. 构建病例-对照表并计算病例-对照比值比 ($OR_{\\text{cc}}$)。\n\n病例-对照研究抽取了所有病例中的 $s_{c} = \\frac{2}{3}$ 和所有非病例中的 $s_{n} = \\frac{1}{12}$。病例-对照研究表中（用撇号表示）的期望计数为：\n- 暴露组病例：$a' = a \\times s_{c} = 72 \\times \\frac{2}{3} = 48$\n- 非暴露组病例：$c' = c \\times s_{c} = 144 \\times \\frac{2}{3} = 96$\n- 暴露组对照（非病例）：$b' = b \\times s_{n} = 2,328 \\times \\frac{1}{12} = 194$\n- 非暴露组对照（非病例）：$d' = d \\times s_{n} = 9,456 \\times \\frac{1}{12} = 788$\n\n病例-对照研究的预期 $2 \\times 2$ 表如下：\n\n| 状态 | 病例 | 对照 |\n|:---|:---:|:---:|\n| 暴露组 | $a'=48$ | $b'=194$ |\n| 非暴露组 | $c'=96$ | $d'=788$ |\n\n病例-对照比值比 $OR_{\\text{cc}}$ 是此表的交叉乘积比：\n$$OR_{\\text{cc}} = \\frac{a'd'}{b'c'} = \\frac{48 \\times 788}{194 \\times 96} = \\frac{37,824}{18,624} \\approx 2.0309278$$\n\n$OR_{\\text{cc}} = OR_{\\text{cohort}}$ 的论证：\n病例-对照比值比计算为 $OR_{\\text{cc}} = \\frac{a'd'}{b'c'}$。代入抽样计数的表达式：\n$$OR_{\\text{cc}} = \\frac{(a \\cdot s_{c})(d \\cdot s_{n})}{(b \\cdot s_{n})(c \\cdot s_{c})} = \\frac{ad \\cdot s_{c}s_{n}}{bc \\cdot s_{c}s_{n}}$$\n由于抽样比例 $s_{c}$ 和 $s_{n}$ 是不依赖于暴露状态的常数，它们在分子和分母中被消去。\n$$OR_{\\text{cc}} = \\frac{ad}{bc} = OR_{\\text{cohort}}$$\n这表明，当病例和对照的选择概率与暴露状态无关时，病例-对照比值比是队列比值比的无偏估计量。我们的数值计算证实了这一等式。\n\n4. 评估低发病率近似。\n\n问题要求计算相对偏差 $\\Delta = \\frac{|OR_{\\text{cc}} - RR|}{RR}$。\n使用计算出的值：\n$OR_{\\text{cc}} \\approx 2.0309278$\n$RR = 2$\n$$\\Delta = \\frac{|2.0309278 - 2|}{2} = \\frac{0.0309278}{2} \\approx 0.0154639$$\n该近似的前提是总发病率较低。在队列中，总病例数为 $C_1 + C_0 = 72+144 = 216$，总人口为 $N=12,000$。总发病率为 $\\frac{216}{12,000} = 0.018$，低于指定的阈值 $0.05$。“罕见病假设”指出，如果疾病是罕见的，则 $OR \\approx RR$。本计算量化了在该特定情景下该近似的误差。与1的偏差是由因子 $\\frac{1-R_0}{1-R_1} = \\frac{1-0.015}{1-0.03} = \\frac{0.985}{0.97} \\approx 1.01546$ 驱动的。相对偏差 $\\Delta$ 简单地是这个因子减去1，即 $|\\frac{1-R_0}{1-R_1} - 1| \\approx 0.01546$。\n\n待报告的量总结如下，四舍五入到四位有效数字：\n- $OR_{\\text{cc}} \\approx 2.0309 \\rightarrow 2.031$\n- $RR = 2 \\rightarrow 2.000$\n- $\\Delta \\approx 0.0154639 \\rightarrow 0.01546$",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.031  2.000  0.01546 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在现实世界的研究中，病例的识别和分类很少是完美无缺的。本练习直面结局误分类这一普遍问题，即用于定义“病例”的诊断标准具有已知的灵敏度（$Se$）和特异性（$Sp$）。通过完成此练习，您将学习如何通过代数方法校正因误分类而产生的有偏倚的比值比，从而揭示真实的潜在关联强度，这是批判性评估和解读已发表研究的一项关键技能。",
            "id": "4633716",
            "problem": "一项病例对照研究调查了二元暴露 $E$ 与二元疾病 $D$ 之间的关联。暴露状态的测量没有误差。然而，病例的选择并不完美：一些真实病例被错误地分类为对照，而一些真实对照被错误地分类为病例。病例选择的不完美性由病例定义的灵敏度 (Se) 和特异性 (Sp) 来表征，假设其相对于暴露是无差异的，也就是说，相同的 $Se$ 和 $Sp$ 适用于暴露和非暴露分层。\n\n病例选择后观察到以下计数：\n- 观察到的选定病例：$n_{1E} = 340$ 名暴露者和 $n_{1\\bar{E}} = 260$ 名非暴露者。\n- 观察到的选定对照：$n_{0E} = 210$ 名暴露者和 $n_{0\\bar{E}} = 690$ 名非暴露者。\n\n病例定义的灵敏度和特异性分别为 $Se = 0.85$ 和 $Sp = 0.98$。仅使用核心定义和第一性原理，通过从观察到的错误分类总数中重建 $(D,E)$ 的预期真实 $2 \\times 2$ 表，来推导暴露与疾病关联的校正比值比。设真实单元格计数为 $t_{11}$（真实患病且暴露），$t_{10}$（真实患病且未暴露），$t_{01}$（真实未患病且暴露），和 $t_{00}$（真实未患病且未暴露）。然后计算校正后的比值比\n$$\nOR_{\\text{corrected}} = \\frac{t_{11} / t_{10}}{t_{01} / t_{00}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}.\n$$\n假设分类误差与暴露无关。将您的最终数值答案四舍五入到四位有效数字。无需单位。",
            "solution": "该问题要求在病例对照研究中计算针对结局错误分类校正的比值比。其基本原理是，使用提供的观察计数以及病例选择过程的灵敏度和特异性，在每个暴露分层内重建患病和非患病个体的真实（未观察到的）计数。无差异错误分类的假设——即灵敏度 $Se$ 和特异性 $Sp$ 对于暴露和非暴露个体是相同的——对这种重建至关重要。\n\n设 $t_{11}$、$t_{10}$、$t_{01}$ 和 $t_{00}$ 代表研究人群的真实单元格计数，其中第一个下标表示疾病状态（$1$ 表示患病，$0$ 表示未患病），第二个下标表示暴露状态（$1$ 表示暴露，$0$ 表示未暴露）。设观察计数为 $n_{1E}$（观察到的暴露病例）、$n_{1\\bar{E}}$（观察到的非暴露病例）、$n_{0E}$（观察到的暴露对照）和 $n_{0\\bar{E}}$（观察到的非暴露对照）。\n\n给定值为：\n- $n_{1E} = 340$\n- $n_{1\\bar{E}} = 260$\n- $n_{0E} = 210$\n- $n_{0\\bar{E}} = 690$\n- $Se = 0.85$\n- $Sp = 0.98$\n\n我们分别分析暴露和非暴露分层。\n\n首先，考虑暴露分层。研究中暴露个体的总数是观察到的暴露病例和对照的总和：\n$$T_E = n_{1E} + n_{0E} = 340 + 210 = 550$$\n这 $550$ 个个体由 $t_{11}$ 个真实病例和 $t_{01}$ 个真实非病例组成。因此，我们有守恒方程：\n$$t_{11} + t_{01} = 550 \\quad (1)$$\n\n一个观察到的病例要么是一个被正确分类的真实病例（真阳性），要么是一个被错误分类为病例的真实非病例（假阳性）。这种关系表示为：\n$$n_{1E} = t_{11} \\cdot Se + t_{01} \\cdot (1 - Sp)$$\n代入给定的数值：\n$$340 = t_{11} \\cdot (0.85) + t_{01} \\cdot (1 - 0.98)$$\n$$340 = 0.85 t_{11} + 0.02 t_{01} \\quad (2)$$\n\n我们解由两个线性方程 $(1)$ 和 $(2)$ 组成的方程组，以求解两个未知数 $t_{11}$ 和 $t_{01}$。从方程 $(1)$，我们将 $t_{01}$ 写为 $t_{01} = 550 - t_{11}$。将其代入方程 $(2)$：\n$$340 = 0.85 t_{11} + 0.02 (550 - t_{11})$$\n$$340 = 0.85 t_{11} + 11 - 0.02 t_{11}$$\n$$340 - 11 = (0.85 - 0.02) t_{11}$$\n$$329 = 0.83 t_{11}$$\n因此，暴露病例的预期真实数量为：\n$$t_{11} = \\frac{329}{0.83}$$\n暴露非病例的预期真实数量为：\n$$t_{01} = 550 - t_{11} = 550 - \\frac{329}{0.83} = \\frac{550 \\cdot 0.83 - 329}{0.83} = \\frac{456.5 - 329}{0.83} = \\frac{127.5}{0.83}$$\n\n接下来，我们对非暴露分层进行相同的分析。非暴露个体的总数为：\n$$T_{\\bar{E}} = n_{1\\bar{E}} + n_{0\\bar{E}} = 260 + 690 = 950$$\n这 $950$ 个个体包含 $t_{10}$ 个真实病例和 $t_{00}$ 个真实非病例：\n$$t_{10} + t_{00} = 950 \\quad (3)$$\n\n观察到的非暴露病例数 $n_{1\\bar{E}}$ 通过以下方式与真实计数相关：\n$$n_{1\\bar{E}} = t_{10} \\cdot Se + t_{00} \\cdot (1 - Sp)$$\n代入数值：\n$$260 = t_{10} \\cdot (0.85) + t_{00} \\cdot (1 - 0.98)$$\n$$260 = 0.85 t_{10} + 0.02 t_{00} \\quad (4)$$\n\n我们解方程组 $(3)$ 和 $(4)$ 以求得 $t_{10}$ 和 $t_{00}$。从方程 $(3)$，得到 $t_{00} = 950 - t_{10}$。将其代入方程 $(4)$：\n$$260 = 0.85 t_{10} + 0.02 (950 - t_{10})$$\n$$260 = 0.85 t_{10} + 19 - 0.02 t_{10}$$\n$$260 - 19 = (0.85 - 0.02) t_{10}$$\n$$241 = 0.83 t_{10}$$\n因此，非暴露病例的预期真实数量为：\n$$t_{10} = \\frac{241}{0.83}$$\n非暴露非病例的预期真实数量为：\n$$t_{00} = 950 - t_{10} = 950 - \\frac{241}{0.83} = \\frac{950 \\cdot 0.83 - 241}{0.83} = \\frac{788.5 - 241}{0.83} = \\frac{547.5}{0.83}$$\n\n在确定了预期的真实计数后，我们可以计算校正后的比值比 $OR_{\\text{corrected}}$：\n$$OR_{\\text{corrected}} = \\frac{t_{11} \\, t_{00}}{t_{10} \\, t_{01}}$$\n$$OR_{\\text{corrected}} = \\frac{\\left(\\frac{329}{0.83}\\right) \\left(\\frac{547.5}{0.83}\\right)}{\\left(\\frac{241}{0.83}\\right) \\left(\\frac{127.5}{0.83}\\right)}$$\n分子和分母中的项 $(1/0.83)^2$ 相互抵消，得到：\n$$OR_{\\text{corrected}} = \\frac{329 \\times 547.5}{241 \\times 127.5} = \\frac{180127.5}{30727.5}$$\n$$OR_{\\text{corrected}} \\approx 5.862105$$\n\n问题要求将最终答案四舍五入到四位有效数字。\n$$OR_{\\text{corrected}} \\approx 5.862$$",
            "answer": "$$\\boxed{5.862}$$"
        },
        {
            "introduction": "我们的关注点从单个研究设计转向公共卫生监测。监测系统的一个基本问题是：“我们遗漏了多少病例？”。本练习介绍了一种强大的工具——捕获-再捕获法，该方法通过比较两个独立的病例来源列表来估计人群中的总病例数。这项实践将使您能够量化监测系统的完整性，并为是否需要投入更多资源以寻找更多病例提供数据驱动的决策依据。",
            "id": "4633812",
            "problem": "一个公共卫生监测团队在一个短期内，对一个确定的、封闭的人群进行了一项双源病例发现工作，以估计一种疾病的病例确认完整性。数据源 $1$ 确认了 $n_{1}=120$ 例病例，数据源 $2$ 确认了 $n_{2}=150$ 例病例，经过记录链接后，两个数据源共同匹配到了 $m=60$ 例病例。假设标准的双源捕获-再捕获框架适用：即封闭人群、数据源独立、以及在周期内捕获概率均等。将总体完整性定义为所有真实病例中至少出现在两个数据源之一的比例。从独立性假设下的双样本捕获-再捕获抽样的第一性原理出发，推导真实病例总数的估计量，然后推导相应的总体完整性估计量。在估计真实病例总数时，使用一种经过充分检验的小样本偏差校正方法。计算完整性的数值（以小数形式表示），并将您的答案四舍五入到四位有效数字。最后，如果项目的完整性目标是至少 $0.9$，请简要解释是否可能需要额外的数据源。",
            "solution": "该问题被评估为有效，因为它代表了捕获-再捕获方法在流行病学中的一个标准应用，并且具有科学依据、提法明确且客观。\n\n问题要求推导病例总数和总体完整性的估计量，进行数值计算，并基于结果进行解释。我们将在所述假设下从第一性原理出发进行推导。\n\n设 $N$ 为封闭人群中真实病例的总数。设 $n_{1}$ 为数据源 $1$ 确认的病例数，$n_{2}$ 为数据源 $2$ 确认的病例数。设 $m$ 为两个数据源共同确认的病例数。给定值为 $n_{1}=120$，$n_{2}=150$ 和 $m=60$。\n\n核心假设如下：\n1. 病例人群是封闭的（在监测期间没有进入或退出）。\n2. 两个数据源是独立的。这意味着被数据源 $1$ 捕获的概率与被数据源 $2$ 捕获的概率无关。\n3. 每个病例被任一给定数据源捕获的概率是相等的（等捕获率）。\n\n从第一性原理出发，一个病例被数据源 $1$ 捕获的概率估计为 $p_1 = \\frac{n_1}{N}$。\n类似地，一个病例被数据源 $2$ 捕获的概率估计为 $p_2 = \\frac{n_2}{N}$。\n\n在独立性假设下，一个病例同时被数据源 $1$ 和数据源 $2$ 捕获的概率是各自概率的乘积：\n$$p_{12} = p_1 \\times p_2 = \\left(\\frac{n_1}{N}\\right) \\left(\\frac{n_2}{N}\\right) = \\frac{n_1 n_2}{N^2}$$\n被两个数据源同时捕获的病例的期望数 $E[m]$，是病例总数 $N$ 乘以这个联合概率：\n$$E[m] = N \\times p_{12} = N \\times \\frac{n_1 n_2}{N^2} = \\frac{n_1 n_2}{N}$$\n通过矩估计法，我们可以通过令观测值 $m$ 与其期望相等来推导出 $N$ 的一个估计量，记为 $\\hat{N}$：\n$$m = \\frac{n_1 n_2}{\\hat{N}}$$\n解出 $\\hat{N}$ 即可得到 Lincoln-Petersen 估计量，在此模型下，它也是最大似然估计量：\n$$\\hat{N}_{LP} = \\frac{n_1 n_2}{m}$$\n已知该估计量是有偏的，尤其是在小样本中。问题指定使用一种经过充分检验的小样本偏差校正方法。标准的选择是 Chapman 估计量，它为 $N$ 提供了一个几乎无偏的估计。Chapman 估计量 $\\hat{N}_C$ 推导如下：\n$$\\hat{N}_C = \\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1$$\n这就是我们将用来估计真实病例总数的估计量。\n\n接下来，我们推导总体完整性的估计量。总体完整性 $C$ 被定义为所有真实病例中至少出现在两个数据源之一的比例。\n被数据源 $1$ 或数据源 $2$（或两者）发现的独立病例总数可由容斥原理给出：\n$$U = n_1 + n_2 - m$$\n完整性 $C$ 是发现的独立病例数与真实病例总数的比率：\n$$C = \\frac{U}{N} = \\frac{n_1 + n_2 - m}{N}$$\n使用我们对 $N$ 的偏差校正估计量，对应的完整性估计量 $\\hat{C}$ 为：\n$$\\hat{C} = \\frac{n_1 + n_2 - m}{\\hat{N}_C} = \\frac{n_1 + n_2 - m}{\\frac{(n_1 + 1)(n_2 + 1)}{m+1} - 1}$$\n现在，我们使用给定的数据计算该估计量的数值：$n_{1}=120$，$n_{2}=150$ 和 $m=60$。\n\n首先，我们计算确认的独立病例数 $U$：\n$$U = 120 + 150 - 60 = 210$$\n接下来，我们计算估计的病例总数 $\\hat{N}_C$：\n$$\\hat{N}_C = \\frac{(120 + 1)(150 + 1)}{60+1} - 1 = \\frac{121 \\times 151}{61} - 1 = \\frac{18271}{61} - 1$$\n$$\\hat{N}_C \\approx 299.52459 - 1 = 298.52459$$\n最后，我们计算估计的完整性 $\\hat{C}$：\n$$\\hat{C} = \\frac{U}{\\hat{N}_C} = \\frac{210}{298.52459} \\approx 0.7034633$$\n四舍五入到四位有效数字，我们得到：\n$$\\hat{C} \\approx 0.7035$$\n\n对于问题的最后一部分，我们解释这个结果。该双源监测系统的估计完整性约为 $0.7035$，即 $70.35\\%$。项目的完整性目标是至少 $0.9$，即 $90\\%$。由于 $0.7035  0.9$，当前系统的性能远未达到目标。因此，为了实现项目目标，极有可能需要额外的数据源来进行病例发现，以提高确认病例的总体比例。",
            "answer": "$$\\boxed{0.7035}$$"
        }
    ]
}