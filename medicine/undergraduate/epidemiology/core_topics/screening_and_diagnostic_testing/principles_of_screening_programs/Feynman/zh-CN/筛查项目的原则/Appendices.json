{
    "hands_on_practices": [
        {
            "introduction": "一项筛查测试的灵敏度 ($Se$) 和特异性 ($Sp$) 是其固有特性，但在实际应用中，我们更关心其在特定人群中的表现。阳性预测值 ($PPV$) 和阴性预测值 ($NPV$) 正是衡量这种实际表现的关键指标，它们回答了“如果我的测试结果是阳性，我真正患病的概率是多少？”这样的实际问题。本练习  将指导您使用贝叶斯定理，从基本定义出发推导并计算这些关键指标，并量化筛查带来的一个重要后果——假阳性人数，这有助于我们理解筛查项目的潜在危害和成本。",
            "id": "4623740",
            "problem": "一个公共卫生机构正在考虑对一种慢性病实施人群筛查计划。正在评估的检测方法的灵敏度为 $Se$，特异度为 $Sp$，目标人群的疾病患病率为 $\\pi$。根据筛查项目的原则，我们关注的量是阳性预测值（PPV）和阴性预测值（NPV）。阳性预测值定义为在检测结果为阳性的情况下，个体确实患有该疾病的概率；阴性预测值定义为在检测结果为阴性的情况下，个体确实未患该疾病的概率。从灵敏度 $Se$ 的核心定义 $P(+\\mid D)$、特异度 $Sp$ 的核心定义 $P(-\\mid \\neg D)$ 和患病率 $\\pi$ 的核心定义 $P(D)$ 出发，在人群水平上使用贝叶斯定理，推导出 $PPV$ 和 $NPV$ 的表达式，并针对一个 $Se=0.90$，$Sp=0.95$ 和 $\\pi=0.02$ 的检测进行计算。然后，通过将假阳性概率转换为预期计数，解释每筛查 $10{,}000$ 人中预期假阳性人数的结果。\n\n将 $PPV$ 和 $NPV$ 以四位有效数字的小数形式报告，并将每筛查 $10{,}000$ 人中的预期假阳性人数表示为精确的整数计数。以行矩阵的形式提供您的最终数值答案，顺序为 $\\big(PPV, NPV, \\text{false positives per }10{,}000\\big)$。",
            "solution": "该问题是有效的，因为它在科学上基于流行病学原理，问题提出得当且数据充分，表述客观。我们将进行推导和计算。\n\n令 $D$ 表示个体患有该疾病的事件，$\\neg D$ 表示个体未患该疾病的事件。令 $+$ 表示阳性检测结果，$-$ 表示阴性检测结果。\n\n给定条件如下：\n- 灵敏度, $Se = P(+\\mid D) = 0.90$\n- 特异度, $Sp = P(-\\mid \\neg D) = 0.95$\n- 患病率, $\\pi = P(D) = 0.02$\n\n由此，我们可以推导出其他必要的概率：\n- 未患病的概率为 $P(\\neg D) = 1 - P(D) = 1 - \\pi = 1 - 0.02 = 0.98$。\n- 假阴性结果的概率为 $P(-\\mid D) = 1 - P(+\\mid D) = 1 - Se = 1 - 0.90 = 0.10$。\n- 假阳性结果的概率为 $P(+\\mid \\neg D) = 1 - P(-\\mid \\neg D) = 1 - Sp = 1 - 0.95 = 0.05$。\n\n**1. 阳性预测值（PPV）的推导与计算**\n\n阳性预测值（$PPV$）是指检测结果为阳性的个体确实患有该疾病的概率，定义为 $PPV = P(D \\mid +)$。\n\n使用贝叶斯定理，我们有：\n$$PPV = P(D \\mid +) = \\frac{P(+\\mid D) P(D)}{P(+)}$$\n\n分母 $P(+)$ 是人群中检测结果为阳性的总概率。我们使用全概率公式来计算：\n$$P(+) = P(+\\mid D)P(D) + P(+\\mid \\neg D)P(\\neg D)$$\n\n代入已定义的术语（$Se$、$Sp$、$\\pi$）：\n$$P(+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\n\n将此代回 $PPV$ 的贝叶斯定理表达式中：\n$$PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}$$\n\n现在，我们使用给定数据计算数值：\n$$PPV = \\frac{0.90 \\cdot 0.02}{0.90 \\cdot 0.02 + (1 - 0.95)(1 - 0.02)} = \\frac{0.018}{0.018 + (0.05)(0.98)}$$\n$$PPV = \\frac{0.018}{0.018 + 0.049} = \\frac{0.018}{0.067} \\approx 0.2686567...$$\n\n四舍五入到四位有效数字，我们得到 $PPV \\approx 0.2687$。\n\n**2. 阴性预测值（NPV）的推导与计算**\n\n阴性预测值（$NPV$）是指检测结果为阴性的个体确实未患病的概率，定义为 $NPV = P(\\neg D \\mid -)$。\n\n使用贝叶斯定理：\n$$NPV = P(\\neg D \\mid -) = \\frac{P(-\\mid \\neg D) P(\\neg D)}{P(-)}$$\n\n分母 $P(-)$ 是检测结果为阴性的总概率，即 $1 - P(+)$。或者，使用全概率公式：\n$$P(-) = P(-\\mid D)P(D) + P(-\\mid \\neg D)P(\\neg D)$$\n\n代入已定义的术语：\n$$P(-) = (1 - Se)(\\pi) + (Sp)(1 - \\pi)$$\n\n将此代回 $NPV$ 的贝叶斯定理表达式中：\n$$NPV = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se) \\cdot \\pi}$$\n\n现在，我们计算数值：\n$$NPV = \\frac{0.95 \\cdot (1 - 0.02)}{0.95 \\cdot (1 - 0.02) + (1 - 0.90) \\cdot 0.02} = \\frac{0.95 \\cdot 0.98}{0.95 \\cdot 0.98 + 0.10 \\cdot 0.02}$$\n$$NPV = \\frac{0.931}{0.931 + 0.002} = \\frac{0.931}{0.933} \\approx 0.9978563...$$\n\n四舍五入到四位有效数字，我们得到 $NPV \\approx 0.9979$。\n\n**3. 预期假阳性人数的计算**\n\n当一个个体检测结果为阳性（$+$）但并未患病（$\\neg D$）时，就出现了假阳性。对于一个随机选择的个体，这个联合事件的概率是 $P(+ \\cap \\neg D)$。\n根据条件概率的定义：\n$$P(+ \\cap \\neg D) = P(+\\mid \\neg D) \\cdot P(\\neg D)$$\n\n代入已知值：\n$$P(+ \\cap \\neg D) = (1 - Sp) \\cdot (1 - \\pi) = (0.05) \\cdot (0.98) = 0.049$$\n\n这是假阳性概率。在 $N = 10{,}000$ 人的群体中，预期的假阳性人数是总人数乘以这个概率：\n$$\\text{Expected False Positives} = N \\cdot P(+ \\cap \\neg D)$$\n$$\\text{Expected False Positives} = 10{,}000 \\cdot 0.049 = 490$$\n\n这是一个精确的整数，符合要求。其解释是，每筛查 $10{,}000$ 人，我们预计有 $490$ 人会错误地收到阳性检测结果，导致他们在没有患病的情况下被归类为可能患病。即使特异度相对较高，如此大量的假阳性也是疾病患病率低的直接后果。\n\n最终的数值结果是：\n- $PPV \\approx 0.2687$\n- $NPV \\approx 0.9979$\n- 每筛查 $10{,}000$ 人中的预期假阳性人数 = $490$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2687  0.9979  490 \\end{pmatrix}}$$"
        },
        {
            "introduction": "我们已经知道，筛查测试的预测值不仅取决于测试本身的性能，还受到疾病患病率的深刻影响。但是，这种影响究竟有多大？本练习  旨在通过一个具体的计算任务，让您亲身体会患病率对阳性预测值 ($PPV$) 的决定性作用。您将使用一个具有固定灵敏度 ($Se$) 和特异性 ($Sp$) 的测试，分别计算其在三个不同患病率 ($\\\\pi$) 的人群中的 $PPV$ 值。",
            "id": "4623715",
            "problem": "一个公共卫生团队正在评估一种用于社区环境中无症状疾病的筛查测试。该测试的灵敏度（Se）和特异度（Sp）已通过验证性研究得知。该团队希望了解阳性预测值（PPV）如何随社区患病率变化，因为PPV决定了筛查结果为阳性的人真正患病的概率，从而指导后续的诊断确认和咨询。\n\n从灵敏度、特异度、患病率、条件概率和全概率公式的基本定义出发，推导出一个用$Se$、$Sp$和患病率$\\pi$表示$PPV$的表达式。然后，使用推导出的表达式，在给定$Se = 0.90$和$Sp = 0.95$的情况下，计算三种可能的患病率情景下的$PPV$：$\\pi = 0.01$，$\\pi = 0.05$和$\\pi = 0.20$。简要总结数值结果如何反映在不同患病率背景下进行筛查的权衡取舍。\n\n按$\\pi = 0.01$，$\\pi = 0.05$，$\\pi = 0.20$的顺序报告三个$PPV$数值。将每个值表示为小数（不带百分号），并四舍五入到$4$位有效数字。将最终的三个四舍五入后的值以单行矩阵的形式呈现。",
            "solution": "问题陈述是流行病学原理和条件概率方面的一个有效练习。所有必要的参数都已提供，术语是标准的，目标清晰且有科学依据。我们将继续进行推导和计算。\n\n首先，我们根据问题陈述定义相关事件和概率。\n设$D$为个体患有该疾病的事件，设$\\neg D$为个体未患该疾病的事件。\n设$T^+$为测试结果为阳性的事件，设$T^-$为测试结果为阴性的事件。\n\n问题中给出的参数可以表示为条件概率：\n1.  患病率 ($\\pi$): 患有该疾病的先验概率。\n    $$ \\pi = P(D) $$\n    由此，未患该疾病的概率为：\n    $$ P(\\neg D) = 1 - P(D) = 1 - \\pi $$\n2.  灵敏度 ($Se$): 在个体患有该疾病的条件下，测试结果为阳性的概率。这是真阳性率。\n    $$ Se = P(T^+ | D) $$\n3.  特异度 ($Sp$): 在个体未患该疾病的条件下，测试结果为阴性的概率。这是真阴性率。\n    $$ Sp = P(T^- | \\neg D) $$\n    根据特异度的定义，我们可以推导出假阳性率，即在个体未患该疾病的条件下，测试结果为阳性的概率：\n    $$ P(T^+ | \\neg D) = 1 - P(T^- | \\neg D) = 1 - Sp $$\n\n需要推导的量是阳性预测值 ($PPV$)，即在测试结果为阳性的个体中，真正患有该疾病的概率。使用条件概率的表示法，即为：\n$$ PPV = P(D | T^+) $$\n\n我们可以使用条件概率的定义（贝叶斯定理的一种形式）来推导$PPV$的表达式：\n$$ PPV = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)} $$\n\n分子$P(D \\cap T^+)$是同时患病且测试为阳性的联合概率。这代表了人群中的真阳性。它可以用条件概率的定义来表示：\n$$ P(D \\cap T^+) = P(T^+ | D) \\cdot P(D) = Se \\cdot \\pi $$\n\n分母$P(T^+)$是获得阳性测试结果的总概率。这可以通过两种互斥的方式发生：真阳性 ($D \\cap T^+$) 或假阳性 ($\\neg D \\cap T^+$)。使用全概率公式，我们可以将$P(T^+)$展开如下：\n$$ P(T^+) = P(T^+ | D) \\cdot P(D) + P(T^+ | \\neg D) \\cdot P(\\neg D) $$\n代入患病率、灵敏度和特异度的标准术语，得到：\n$$ P(T^+) = (Se \\cdot \\pi) + ((1 - Sp) \\cdot (1 - \\pi)) $$\n\n现在，将分子和分母的表达式代回$PPV$的方程，我们得到所需的通用公式：\n$$ PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp) \\cdot (1 - \\pi)} $$\n这个$PPV$的表达式仅用灵敏度($Se$)、特异度($Sp$)和患病率($\\pi$)表示，符合要求。\n\n接下来，我们使用这个推导出的表达式来计算三种给定情景下的$PPV$数值。固定的测试特性为$Se = 0.90$和$Sp = 0.95$。因此，假阳性率为$1 - Sp = 1 - 0.95 = 0.05$。\n\n情景1：患病率 $\\pi = 0.01$。\n$$ PPV_1 = \\frac{0.90 \\cdot 0.01}{0.90 \\cdot 0.01 + 0.05 \\cdot (1 - 0.01)} = \\frac{0.009}{0.009 + 0.05 \\cdot 0.99} = \\frac{0.009}{0.009 + 0.0495} = \\frac{0.009}{0.0585} \\approx 0.153846... $$\n四舍五入到$4$位有效数字，$PPV_1 = 0.1538$。\n\n情景2：患病率 $\\pi = 0.05$。\n$$ PPV_2 = \\frac{0.90 \\cdot 0.05}{0.90 \\cdot 0.05 + 0.05 \\cdot (1 - 0.05)} = \\frac{0.045}{0.045 + 0.05 \\cdot 0.95} = \\frac{0.045}{0.045 + 0.0475} = \\frac{0.045}{0.0925} \\approx 0.486486... $$\n四舍五入到$4$位有效数字，$PPV_2 = 0.4865$。\n\n情景3：患病率 $\\pi = 0.20$。\n$$ PPV_3 = \\frac{0.90 \\cdot 0.20}{0.90 \\cdot 0.20 + 0.05 \\cdot (1 - 0.20)} = \\frac{0.18}{0.18 + 0.05 \\cdot 0.80} = \\frac{0.18}{0.18 + 0.04} = \\frac{0.18}{0.22} \\approx 0.818181... $$\n四舍五入到$4$位有效数字，$PPV_3 = 0.8182$。\n\n结果总结与权衡取舍：\n数值结果表明，阳性预测值强烈依赖于被筛查人群中该疾病的患病率。在固定的灵敏度($Se=0.90$)和特异度($Sp=0.95$)下，$PPV$随患病率的增加而显著增加：从$\\pi=0.01$时的$0.1538$增加到$\\pi=0.20$时的$0.8182$。\n\n在低患病率环境（$\\pi = 0.01$）中，一个阳性测试结果只有$15.4\\%$的可能是正确的；其余$84.6\\%$的阳性结果是假阳性。这意味着，对于每一个通过阳性筛查发现的真实病例，大约有$5.5$名未患病者也被筛查为阳性。因此，对一个广泛的、低患病率的人群进行筛查，可能导致不必要的后续检测、患者焦虑和医源性风险等高昂负担。\n\n相比之下，在高患病率环境（$\\pi=0.20$）中，一个阳性测试有$81.8\\%$的可能是正确的。在这种情况下，该测试在识别真实病例方面效率高得多。这突显了筛查项目设计的核心权衡：将测试应用于低风险（低患病率）的普通人群可能效率低下，并因假阳性而产生巨大危害；而将同一测试应用于高风险（高患病率）的亚人群，则会产生更可靠的阳性结果，并提高筛查项目的效益-危害比。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1538  0.4865  0.8182 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在前述练习中，我们将灵敏度和特异性视为固定值。然而，对于许多提供连续测量结果（如血液指标浓度）的测试，我们需要设定一个“临界值”来区分阳性与阴性。这个临界值的选择直接导致了灵敏度与特异性之间的权衡关系。本练习  介绍了约登指数 ($J$)，它是一种用于寻找最佳临界值的常用方法，旨在最大化地平衡“抓到真病人”（灵敏度）和“放过健康人”（特异性）的能力。您将为三个候选临界值计算约登指数，从而确定最佳选择。",
            "id": "4623721",
            "problem": "一个公共卫生实验室正在评估一种用于无症状慢性病的廉价血液筛选检测方法。基于一个试点样本，正在考虑三个候选阳性阈值，每个阈值得出经验估计的一对灵敏度和特异度：阈值A给出$(Se,Sp)=(0.90,0.80)$，阈值B给出$(Se,Sp)=(0.85,0.88)$，阈值C给出$(Se,Sp)=(0.75,0.95)$。约登指数（Youden’s index）定义为受试者工作特征（ROC）曲线与连接$(0,0)$到$(1,1)$的机会对角线之间的最大垂直距离。从真阳性率等于灵敏度、假阳性率等于1减去特异度的基本定义出发，推导在单个固定阈值下约登指数关于$Se$和$Sp$的表达式，使用给定的数据对计算每个候选阈值的约登指数值，并确定哪个阈值使该指数最大化。仅报告约登指数的最大值作为您的最终数值答案。请将您的最终答案表示为精确小数，无需四舍五入。",
            "solution": "问题陈述已经过验证，并被确定为流行病学中一个定义明确、有科学依据的问题。它提供了推导公式和计算唯一数值结果所需的所有定义和数据。\n\n目标是推导在单个阈值下筛选测试的约登指数$J$的表达式，然后用此表达式找出三个候选阈值中$J$的最大值。\n\n受试者工作特征（ROC）曲线是一个图形图，它说明了当二元分类器系统的判别阈值变化时其诊断能力的变化。该曲线是通过在各种阈值设置下绘制真阳性率（$TPR$）对假阳性率（$FPR$）而创建的。根据定义，ROC空间的纵轴是$TPR$，横轴是$FPR$。\n\n问题提供了将这些率与灵敏度（$Se$）和特异度（$Sp$）联系起来的基本定义：\n1.  真阳性率是测试的灵敏度：$TPR = Se$。\n2.  假阳性率是1减去测试的特异度：$FPR = 1 - Sp$。\n\n因此，筛选检测的任何单个阈值都对应于ROC曲线上的一个点，其坐标为 $(x, y) = (FPR, TPR) = (1 - Sp, Se)$。\n\n约登指数定义为ROC曲线与机会对角线之间的最大垂直距离。机会对角线是连接ROC空间中点$(0, 0)$到点$(1, 1)$的线段。这条线的方程是 $y = x$。\n\n对于ROC曲线上的特定点$(x_0, y_0)$，机会对角线上具有相同水平坐标的点是$(x_0, x_0)$。ROC点与机会对角线之间的垂直距离是它们垂直坐标的差，即 $y_0 - x_0$。\n\n特定阈值的约登指数$J$就是这个垂直距离。因此，我们有一般表达式：\n$$J = TPR - FPR$$\n\n将$TPR$和$FPR$关于$Se$和$Sp$的给定定义代入，我们推导出单个固定阈值下约登指数的表达式：\n$$J = Se - (1 - Sp)$$\n$$J = Se + Sp - 1$$\n\n现在，我们使用提供的灵敏度和特异度对，计算三个候选阈值中每一个的约登指数值。\n\n对于阈值A：\n$Se_A = 0.90$\n$Sp_A = 0.80$\n约登指数为：\n$$J_A = Se_A + Sp_A - 1 = 0.90 + 0.80 - 1 = 1.70 - 1 = 0.70$$\n\n对于阈值B：\n$Se_B = 0.85$\n$Sp_B = 0.88$\n约登指数为：\n$$J_B = Se_B + Sp_B - 1 = 0.85 + 0.88 - 1 = 1.73 - 1 = 0.73$$\n\n对于阈值C：\n$Se_C = 0.75$\n$Sp_C = 0.95$\n约登指数为：\n$$J_C = Se_C + Sp_C - 1 = 0.75 + 0.95 - 1 = 1.70 - 1 = 0.70$$\n\n为根据此指标确定最佳阈值，我们比较计算出的约登指数值：\n$J_A = 0.70$\n$J_B = 0.73$\n$J_C = 0.70$\n\n这些值中的最大值是$0.73$，对应于阈值B。问题要求报告这个最大值。",
            "answer": "$$\\boxed{0.73}$$"
        }
    ]
}