{
    "hands_on_practices": [
        {
            "introduction": "在评估筛查项目时，仅知道检测的灵敏度 ($Se$) 和特异性 ($Sp$) 是不够的。这些指标是在已知疾病状态的人群中测得的，而筛查的真正价值体现在它在目标人群中的预测能力。本练习将指导您计算阳性预测值 ($PPV$) 和阴性预测值 ($NPV$)，这两个指标分别回答了“阳性结果真的是阳性吗？”和“阴性结果真的是阴性吗？”这两个关键问题。通过这个计算，您将亲身体会到，即使是性能良好的检测，在应用于低患病率人群时也会面临挑战。",
            "id": "4623740",
            "problem": "一家公共卫生机构正在考虑对一种慢性病实施人群筛查计划。所评估的检测方法的灵敏度为$Se$，特异度为$Sp$，目标人群的疾病患病率为$\\pi$。根据筛查计划的原则，我们关注的量是阳性预测值（PPV）和阴性预测值（NPV）。阳性预测值定义为在检测结果为阳性的情况下，个体确实患有该疾病的概率；阴性预测值定义为在检测结果为阴性的情况下，个体确实未患该疾病的概率。从灵敏度$Se$的核心定义$P(+\\mid D)$、特异度$Sp$的定义$P(-\\mid \\neg D)$以及患病率$\\pi$的定义$P(D)$出发，利用贝叶斯定理在人群水平上推导$PPV$和$NPV$的表达式，并使用$Se=0.90$、$Sp=0.95$和$\\pi=0.02$的参数计算它们的值。然后，通过将假阳性概率转换为预期计数，解释每$10{,}000$名筛查个体中预期假阳性数量的结果。\n\n将$PPV$和$NPV$报告为四位有效数字的小数，并将每$10{,}000$名筛查个体中的预期假阳性数量表示为精确整数。以行矩阵的形式提供您的最终数值答案，顺序为$\\big(PPV, NPV, \\text{每10,000人中的假阳性数}\\big)$。",
            "solution": "该问题是有效的，因为它在科学上基于流行病学原理，问题设定良好且数据充分，表述客观。我们将进行推导和计算。\n\n令$D$表示个体患有疾病的事件，$\\neg D$表示个体未患疾病的事件。令$+$表示阳性检测结果，$-$表示阴性检测结果。\n\n已知条件如下：\n- 灵敏度，$Se = P(+\\mid D) = 0.90$\n- 特异度，$Sp = P(-\\mid \\neg D) = 0.95$\n- 患病率，$\\pi = P(D) = 0.02$\n\n由此，我们可以推导出其他必要的概率：\n- 未患病的概率为 $P(\\neg D) = 1 - P(D) = 1 - \\pi = 1 - 0.02 = 0.98$。\n- 假阴性结果的概率为 $P(-\\mid D) = 1 - P(+\\mid D) = 1 - Se = 1 - 0.90 = 0.10$。\n- 假阳性结果的概率为 $P(+\\mid \\neg D) = 1 - P(-\\mid \\neg D) = 1 - Sp = 1 - 0.95 = 0.05$。\n\n**1. 阳性预测值（PPV）的推导与计算**\n\n阳性预测值（$PPV$）是指在检测结果为阳性的情况下，个体确实患有该疾病的概率，定义为 $PPV = P(D \\mid +)$。\n\n使用贝叶斯定理，我们得到：\n$$PPV = P(D \\mid +) = \\frac{P(+\\mid D) P(D)}{P(+)}$$\n\n分母 $P(+)$ 是人群中出现阳性检测结果的总概率。我们使用全概率公式来计算它：\n$$P(+) = P(+\\mid D)P(D) + P(+\\mid \\neg D)P(\\neg D)$$\n\n代入已定义的术语（$Se$, $Sp$, $\\pi$）：\n$$P(+) = (Se)(\\pi) + (1 - Sp)(1 - \\pi)$$\n\n将此代回$PPV$的贝叶斯定理表达式中：\n$$PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp)(1 - \\pi)}$$\n\n现在，我们使用给定的数据计算数值：\n$$PPV = \\frac{0.90 \\cdot 0.02}{0.90 \\cdot 0.02 + (1 - 0.95)(1 - 0.02)} = \\frac{0.018}{0.018 + (0.05)(0.98)}$$\n$$PPV = \\frac{0.018}{0.018 + 0.049} = \\frac{0.018}{0.067} \\approx 0.2686567...$$\n\n四舍五入到四位有效数字，我们得到 $PPV \\approx 0.2687$。\n\n**2. 阴性预测值（NPV）的推导与计算**\n\n阴性预测值（$NPV$）是指在检测结果为阴性的情况下，个体确实未患病的概率，定义为 $NPV = P(\\neg D \\mid -)$。\n\n使用贝叶斯定理：\n$$NPV = P(\\neg D \\mid -) = \\frac{P(-\\mid \\neg D) P(\\neg D)}{P(-)}$$\n\n分母 $P(-)$ 是出现阴性检测结果的总概率，即 $1 - P(+)$。或者，使用全概率公式：\n$$P(-) = P(-\\mid D)P(D) + P(-\\mid \\neg D)P(\\neg D)$$\n\n代入已定义的术语：\n$$P(-) = (1 - Se)(\\pi) + (Sp)(1 - \\pi)$$\n\n将此代回$NPV$的贝叶斯定理表达式中：\n$$NPV = \\frac{Sp \\cdot (1 - \\pi)}{Sp \\cdot (1 - \\pi) + (1 - Se) \\cdot \\pi}$$\n\n现在，我们计算数值：\n$$NPV = \\frac{0.95 \\cdot (1 - 0.02)}{0.95 \\cdot (1 - 0.02) + (1 - 0.90) \\cdot 0.02} = \\frac{0.95 \\cdot 0.98}{0.95 \\cdot 0.98 + 0.10 \\cdot 0.02}$$\n$$NPV = \\frac{0.931}{0.931 + 0.002} = \\frac{0.931}{0.933} \\approx 0.9978563...$$\n\n四舍五入到四位有效数字，我们得到 $NPV \\approx 0.9979$。\n\n**3. 预期假阳性数量的计算**\n\n假阳性是指个体检测结果为阳性（$+$）但并未患病（$\\neg D$）。对于一个随机选择的个体，这个联合事件的概率是 $P(+ \\cap \\neg D)$。\n使用条件概率的定义：\n$$P(+ \\cap \\neg D) = P(+\\mid \\neg D) \\cdot P(\\neg D)$$\n\n代入已知值：\n$$P(+ \\cap \\neg D) = (1 - Sp) \\cdot (1 - \\pi) = (0.05) \\cdot (0.98) = 0.049$$\n\n这是假阳性概率。在一个$N = 10{,}000$人的群体中，预期的假阳性数量是总人数乘以这个概率：\n$$\\text{预期假阳性数} = N \\cdot P(+ \\cap \\neg D)$$\n$$\\text{预期假阳性数} = 10{,}000 \\cdot 0.049 = 490$$\n\n这是一个精确整数，符合要求。其解释是，每筛查$10{,}000$人，我们预计有$490$人会错误地收到阳性检测结果，从而在他们没有患病的情况下被归类为可能患病。即使特异度相对较高，如此高的假阳性数量也是低疾病患病率的直接后果。\n\n最终的数值结果是：\n- $PPV \\approx 0.2687$\n- $NPV \\approx 0.9979$\n- 每筛查$10{,}000$人中的预期假阳性数 = $490$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2687  0.9979  490 \\end{pmatrix}}$$"
        },
        {
            "introduction": "上一个练习揭示了阳性预测值的重要性。现在，我们将更深入地探讨一个核心原则：阳性预测值 ($PPV$) 并非检测本身的固有属性，而是严重依赖于被筛查人群的疾病患病率 ($\\pi$)。本练习通过计算同一检测在三种不同患病率情景下的 $PPV$，直观地展示了这一依赖关系。理解这一点对于决定筛查项目的目标人群——是进行广泛的普遍筛查还是针对高风险人群——至关重要。",
            "id": "4623715",
            "problem": "一个公共卫生团队正在评估一种用于社区环境中无症状疾病的筛查测试。该测试的敏感性（Se）和特异性（Sp）已通过验证性研究得知。团队希望了解阳性预测值（PPV）如何随社区患病率变化，因为PPV决定了筛查结果为阳性的人真正患病的概率，从而指导后续的诊断确认和咨询。\n\n从敏感性、特异性、患病率、条件概率和全概率定律的基本定义出发，推导出一个用 $Se$、$Sp$ 和患病率 $\\pi$ 表示 $PPV$ 的表达式。然后，使用推导出的表达式，在给定 $Se = 0.90$ 和 $Sp = 0.95$ 的情况下，计算三种可能的患病率情景下的 $PPV$：$\\pi = 0.01$，$\\pi = 0.05$ 和 $\\pi = 0.20$。简要总结数值结果如何反映在不同患病率背景下进行筛查的权衡取舍。\n\n按照 $\\pi = 0.01$, $\\pi = 0.05$, $\\pi = 0.20$ 的顺序报告三个数值 $PPV$ 值。将每个值表示为小数（不带百分号），并四舍五入到 $4$ 位有效数字。将最终的三个四舍五入后的值以单行矩阵的形式呈现。",
            "solution": "问题陈述是流行病学原理和条件概率方面的一个有效练习。所有必要的参数都已提供，术语是标准的，目标清晰且有科学依据。我们将进行推导和计算。\n\n首先，我们根据问题陈述定义相关事件和概率。\n令 $D$ 为个体患有该疾病的事件，令 $D^c$ 为个体未患该疾病的事件。\n令 $T^+$ 为测试结果为阳性的事件，令 $T^-$ 为测试结果为阴性的事件。\n\n问题中给出的参数可以表示为条件概率：\n1.  患病率 ($\\pi$): 患有该疾病的先验概率。\n    $$ \\pi = P(D) $$\n    由此，未患该疾病的概率为：\n    $$ P(D^c) = 1 - P(D) = 1 - \\pi $$\n2.  敏感性 ($Se$): 在个体患有该疾病的条件下，测试结果为阳性的概率。这是真阳性率。\n    $$ Se = P(T^+ | D) $$\n3.  特异性 ($Sp$): 在个体未患该疾病的条件下，测试结果为阴性的概率。这是真阴性率。\n    $$ Sp = P(T^- | D^c) $$\n    根据特异性的定义，我们可以推导出假阳性率，即在个体未患该疾病的条件下，测试结果为阳性的概率：\n    $$ P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - Sp $$\n\n需要推导的量是阳性预测值 ($PPV$)，即测试结果为阳性的个体真正患有该疾病的概率。用条件概率的符号表示为：\n$$ PPV = P(D | T^+) $$\n\n我们可以使用条件概率的定义（贝叶斯定理的一种形式）来推导 $PPV$ 的表达式：\n$$ PPV = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)} $$\n\n分子 $P(D \\cap T^+)$ 是患有该疾病且测试呈阳性的联合概率。这代表了人群中的真阳性。它可以用条件概率的定义来表示：\n$$ P(D \\cap T^+) = P(T^+ | D) \\cdot P(D) = Se \\cdot \\pi $$\n\n分母 $P(T^+)$ 是获得阳性测试结果的总概率。这可以通过两种互斥的方式发生：真阳性 ($D \\cap T^+$) 或假阳性 ($D^c \\cap T^+$)。使用全概率定律，我们可以将 $P(T^+)$ 展开如下：\n$$ P(T^+) = P(T^+ | D) \\cdot P(D) + P(T^+ | D^c) \\cdot P(D^c) $$\n代入患病率、敏感性和特异性的标准术语，得到：\n$$ P(T^+) = (Se \\cdot \\pi) + ((1 - Sp) \\cdot (1 - \\pi)) $$\n\n现在，将分子和分母的表达式代回 $PPV$ 的方程，我们得到所需的通用公式：\n$$ PPV = \\frac{Se \\cdot \\pi}{Se \\cdot \\pi + (1 - Sp) \\cdot (1 - \\pi)} $$\n这个 $PPV$ 的表达式完全由敏感性 ($Se$)、特异性 ($Sp$) 和患病率 ($\\pi$) 表示，符合要求。\n\n接下来，我们使用这个推导出的表达式来计算三种给定情景下 $PPV$ 的数值。固定的测试特性为 $Se = 0.90$ 和 $Sp = 0.95$。因此，假阳性率为 $1 - Sp = 1 - 0.95 = 0.05$。\n\n情景1：患病率 $\\pi = 0.01$。\n$$ PPV_1 = \\frac{0.90 \\cdot 0.01}{0.90 \\cdot 0.01 + 0.05 \\cdot (1 - 0.01)} = \\frac{0.009}{0.009 + 0.05 \\cdot 0.99} = \\frac{0.009}{0.009 + 0.0495} = \\frac{0.009}{0.0585} \\approx 0.153846... $$\n四舍五入到 $4$ 位有效数字，$PPV_1 = 0.1538$。\n\n情景2：患病率 $\\pi = 0.05$。\n$$ PPV_2 = \\frac{0.90 \\cdot 0.05}{0.90 \\cdot 0.05 + 0.05 \\cdot (1 - 0.05)} = \\frac{0.045}{0.045 + 0.05 \\cdot 0.95} = \\frac{0.045}{0.045 + 0.0475} = \\frac{0.045}{0.0925} \\approx 0.486486... $$\n四舍五入到 $4$ 位有效数字，$PPV_2 = 0.4865$。\n\n情景3：患病率 $\\pi = 0.20$。\n$$ PPV_3 = \\frac{0.90 \\cdot 0.20}{0.90 \\cdot 0.20 + 0.05 \\cdot (1 - 0.20)} = \\frac{0.18}{0.18 + 0.05 \\cdot 0.80} = \\frac{0.18}{0.18 + 0.04} = \\frac{0.18}{0.22} \\approx 0.818181... $$\n四舍五入到 $4$ 位有效数字，$PPV_3 = 0.8182$。\n\n结果总结与权衡取舍：\n数值结果表明，阳性预测值强烈依赖于被筛查人群中该疾病的患病率。对于固定的敏感性 ($Se=0.90$) 和特异性 ($Sp=0.95$)，PPV 随患病率的增加而显著增加：从 $\\pi=0.01$ 时的 $0.1538$ 增加到 $\\pi=0.20$ 时的 $0.8182$。\n\n在低患病率环境 ($\\pi = 0.01$) 下，阳性测试结果只有 $15.4\\%$ 的可能性是正确的；其余 $84.6\\%$ 的阳性结果是假阳性。这意味着，对于每一个通过阳性筛查发现的真实病例，大约有 $5.5$ 名未患病者也筛查呈阳性。因此，对广泛的低患病率人群进行筛查可能导致不必要的后续检查、患者焦虑和医源性风险等沉重负担。\n\n相比之下，在高患病率环境 ($\\pi=0.20$) 下，阳性测试结果有 $81.8\\%$ 的可能性是正确的。在这种情况下，该测试在识别真实病例方面效率要高得多。这突显了筛查项目设计中的核心权衡：将测试应用于低风险（低患病率）的普通人群可能效率低下，并因假阳性而产生重大危害；而将同一测试应用于高风险（高患病率）的亚人群，则会产生更可靠的阳性结果，并改善筛查项目的效益-危害比。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1538  0.4865  0.8182 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "筛查检测通常会得出一个连续的测量值（例如血糖浓度），我们需要设定一个“临界值”来将其划分为“阳性”或“阴性”。这个临界值的选择直接影响检测的灵敏度和特异性，是一个关键的权衡。本练习将介绍尤登指数 ($J$)，它是一种通过平衡灵敏度和特异性来帮助选择最佳临界值的常用方法。通过比较不同临界值下的尤登指数，您将学会如何从操作层面优化筛查检测的性能。",
            "id": "4623721",
            "problem": "一个公共卫生实验室正在评估一种用于无症状慢性病的廉价血液筛查检测方法。基于一个试点样本，正在考虑三个候选的阳性阈值，每个阈值都产生一对经验估计的灵敏度（sensitivity, Se）和特异性（specificity, Sp）：阈值 A 给出 $(Se,Sp)=(0.90,0.80)$，阈值 B 给出 $(Se,Sp)=(0.85,0.88)$，阈值 C 给出 $(Se,Sp)=(0.75,0.95)$。Youden指数定义为受试者工作特征（ROC）曲线与连接 $(0,0)$ 到 $(1,1)$ 的机会对角线之间的最大垂直距离。请从真阳性率等于灵敏度、假阳性率等于一减去特异性的基本定义出发，推导出在单个固定阈值下以 $Se$ 和 $Sp$ 表示的 Youden指数的表达式，使用给定的数据对为每个候选阈值计算其值，并确定哪个阈值使该指数最大化。仅报告 Youden指数 的最大值作为您的最终数值答案。您的最终答案应以精确小数表示，无需四舍五入。",
            "solution": "问题陈述已经过验证，被确定为一个在流行病学中定义明确、有科学依据的问题。它提供了所有必要的定义和数据，以推导公式并计算出唯一的数值结果。\n\n目标是为单个阈值的筛查测试推导出 Youden指数 $J$ 的表达式，然后使用此表达式在三个候选阈值中找到 $J$ 的最大值。\n\n受试者工作特征（ROC）曲线是一个图形图，它说明了当二元分类器系统的判别阈值变化时其诊断能力。该曲线是通过在各种阈值设置下绘制真阳性率（$TPR$）对假阳性率（$FPR$）而创建的。根据定义，ROC空间的纵轴是 $TPR$，横轴是 $FPR$。\n\n问题提供了将这些率与灵敏度（$Se$）和特异性（$Sp$）联系起来的基本定义：\n1.  真阳性率是测试的灵敏度：$TPR = Se$。\n2.  假阳性率是一减去测试的特异性：$FPR = 1 - Sp$。\n\n因此，筛查测试的任何单个阈值都对应于ROC曲线上的一个点，其坐标为 $(x, y) = (FPR, TPR) = (1 - Sp, Se)$。\n\nYouden指数定义为ROC曲线与机会对角线之间的最大垂直距离。机会对角线是连接ROC空间中点 $(0, 0)$ 到 $(1, 1)$ 的线段。这条线的方程是 $y = x$。\n\n对于ROC曲线上的特定点 $(x_0, y_0)$，机会对角线上具有相同水平坐标的点是 $(x_0, x_0)$。ROC点与机会对角线之间的垂直距离是它们纵坐标的差，即 $y_0 - x_0$。\n\n特定阈值的 Youden指数 $J$ 就是这个垂直距离。因此，我们有一般表达式：\n$$J = TPR - FPR$$\n\n将 $TPR$ 和 $FPR$ 的给定定义用 $Se$ 和 $Sp$ 代入，我们推导出单个固定阈值下 Youden指数 的表达式：\n$$J = Se - (1 - Sp)$$\n$$J = Se + Sp - 1$$\n\n现在，我们使用提供的灵敏度和特异性对，为三个候选阈值中的每一个计算 Youden指数 的值。\n\n对于阈值 A：\n$Se_A = 0.90$\n$Sp_A = 0.80$\nYouden指数为：\n$$J_A = Se_A + Sp_A - 1 = 0.90 + 0.80 - 1 = 1.70 - 1 = 0.70$$\n\n对于阈值 B：\n$Se_B = 0.85$\n$Sp_B = 0.88$\nYouden指数为：\n$$J_B = Se_B + Sp_B - 1 = 0.85 + 0.88 - 1 = 1.73 - 1 = 0.73$$\n\n对于阈值 C：\n$Se_C = 0.75$\n$Sp_C = 0.95$\nYouden指数为：\n$$J_C = Se_C + Sp_C - 1 = 0.75 + 0.95 - 1 = 1.70 - 1 = 0.70$$\n\n为了根据此度量确定最佳阈值，我们比较计算出的 Youden指数 的值：\n$J_A = 0.70$\n$J_B = 0.73$\n$J_C = 0.70$\n\n这些值中的最大值是 $0.73$，对应于阈值 B。问题要求的就是这个最大值。",
            "answer": "$$\\boxed{0.73}$$"
        }
    ]
}