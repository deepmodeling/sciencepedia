{
    "hands_on_practices": [
        {
            "introduction": "风险比（Risk Ratio, RR）是流行病学中用于比较两个群体（通常是暴露组与非暴露组）在固定时间段内累积发病风险的核心指标。本练习将带你从一个典型的队列研究场景出发，实践风险比的点估计及其置信区间的计算。通过这个过程，你将掌握为改善统计特性而进行对数变换，并应用Wald法构建置信区间的关键技能，这是进行统计推断的基础。",
            "id": "4632550",
            "problem": "一个由生产工人组成的封闭队列被随访一段固定时期，以评估在特定工作区域引入一种溶剂后，新发呼吸系统疾病的发生情况。在基线时，该队列根据暴露情况被分为两组。在随访期间，观察到以下计数：在暴露组中，有 $n_{1}=2{,}400$ 名工人，其中有 $a=96$ 例新发病例；在非暴露组中，有 $n_{0}=3{,}600$ 名工人，其中有 $c=54$ 例新发病例。假设这是一个具有完整随访的封闭队列，并且每个暴露组内进行独立的二项抽样。\n\n从第一性原理出发，使用风险的二项模型和估计量的可微变换性质，推导风险比对数的近似大样本Wald置信区间，然后反向变换以获得原始尺度上的置信区间。具体来说，从各组特定风险的二项分布出发，使用一阶近似来获得在对数尺度上构建Wald置信区间所需的抽样方差，并注意阐明组间独立性的作用。\n\n计算暴露组与非暴露组相比的风险比 $\\widehat{RR}$ 的点估计值，以及通过所述Wald方法获得的双侧 $95\\%$ 置信区间。将报告的三个数字（点估计值、下限、上限）均四舍五入至三位有效数字。最终答案以三个无单位的数字表示。",
            "solution": "该问题被评估为有效。它呈现了一个基于队列研究设计的标准、适定的流行病学问题。所提供的数据是完整和一致的，目标陈述清晰，其基础的统计模型（独立二项抽样）在科学上是合理的，并且适合该情境。该任务要求从第一性原理进行推导和计算，这是生物统计理论中的一个标准练习。\n\n推导和计算过程如下。\n\n**1. 参数和估计量的定义**\n\n设 $R_1$ 为暴露组中呼吸系统疾病的真实风险（累积发病率），$R_0$ 为非暴露组中的真实风险。问题指出该研究遵循封闭队列设计。每组的新发病例数可以用二项分布来建模。\n\n- 在暴露组中，病例数 $a$ 是一个随机变量，服从 $a \\sim \\text{Binomial}(n_1, R_1)$ 分布。\n- 在非暴露组中，病例数 $c$ 是一个随机变量，服从 $c \\sim \\text{Binomial}(n_0, R_0)$ 分布。\n\n风险的最大似然估计量是样本比例：\n- $R_1$ 的估计量：$\\widehat{R}_1 = \\frac{a}{n_1}$\n- $R_0$ 的估计量：$\\widehat{R}_0 = \\frac{c}{n_0}$\n\n我们感兴趣的参数是风险比 $RR = \\frac{R_1}{R_0}$。其点估计量由 $\\widehat{RR} = \\frac{\\widehat{R}_1}{\\widehat{R}_0}$ 给出。\n\n**2. 置信区间的推导**\n\n我们寻求 $RR$ 的置信区间。$\\widehat{RR}$ 的分布是偏态的，但其对数 $\\ln(\\widehat{RR})$ 的分布在大样本情况下更接近正态分布。因此，我们首先为 $\\ln(RR)$ 构建一个置信区间，然后将其反向变换。\n\n估计风险比的对数为：\n$$ \\ln(\\widehat{RR}) = \\ln\\left(\\frac{\\widehat{R}_1}{\\widehat{R}_0}\\right) = \\ln(\\widehat{R}_1) - \\ln(\\widehat{R}_0) $$\n问题明确指出两组中的抽样是独立的。因此，估计量 $\\widehat{R}_1$ 和 $\\widehat{R}_0$ 是独立的，它们的变换 $\\ln(\\widehat{R}_1)$ 和 $\\ln(\\widehat{R}_0)$ 也是独立的。差值的方差是方差之和：\n$$ \\text{Var}(\\ln(\\widehat{RR})) = \\text{Var}(\\ln(\\widehat{R}_1)) + \\text{Var}(\\ln(\\widehat{R}_0)) $$\n为了找到 $i \\in \\{0, 1\\}$ 时 $\\ln(\\widehat{R}_i)$ 的方差，我们使用一阶泰勒级数展开，也称为Delta方法。对于随机变量 $X$ 的函数 $g(X)$，其近似方差为 $\\text{Var}(g(X)) \\approx [g'(E(X))]^2 \\text{Var}(X)$。\n\n在这里，随机变量是估计量 $\\widehat{R}_i$，函数是 $g(x) = \\ln(x)$。其导数为 $g'(x) = \\frac{1}{x}$。估计量的期望值为 $E(\\widehat{R}_i) = R_i$。估计量的方差由二项模型导出：$\\text{Var}(\\widehat{R}_i) = \\text{Var}(\\frac{\\text{cases}_i}{n_i}) = \\frac{1}{n_i^2} \\text{Var}(\\text{cases}_i) = \\frac{1}{n_i^2} [n_i R_i (1-R_i)] = \\frac{R_i(1-R_i)}{n_i}$。\n\n将Delta方法应用于 $\\ln(\\widehat{R}_1)$：\n$$ \\text{Var}(\\ln(\\widehat{R}_1)) \\approx \\left[ \\frac{d}{dR_1} \\ln(R_1) \\right]^2 \\text{Var}(\\widehat{R}_1) = \\left(\\frac{1}{R_1}\\right)^2 \\frac{R_1(1-R_1)}{n_1} = \\frac{1-R_1}{n_1 R_1} $$\n类似地，对于非暴露组：\n$$ \\text{Var}(\\ln(\\widehat{R}_0)) \\approx \\frac{1-R_0}{n_0 R_0} $$\n将这些相加得到对数风险比的方差：\n$$ \\text{Var}(\\ln(\\widehat{RR})) \\approx \\frac{1-R_1}{n_1 R_1} + \\frac{1-R_0}{n_0 R_0} $$\n为了将其用于置信区间，我们需要一个估计方差，该方差通过用估计风险 $\\widehat{R}_1 = a/n_1$ 和 $\\widehat{R}_0 = c/n_0$ 替代真实风险 $R_1$ 和 $R_0$ 来获得：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{1-\\widehat{R}_1}{n_1 \\widehat{R}_1} + \\frac{1-\\widehat{R}_0}{n_0 \\widehat{R}_0} = \\frac{1-a/n_1}{n_1(a/n_1)} + \\frac{1-c/n_0}{n_0(c/n_0)} = \\frac{(n_1-a)/n_1}{a} + \\frac{(n_0-c)/n_0}{c} $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{n_1-a}{n_1 a} + \\frac{n_0-c}{n_0 c} $$\n这可以在代数上简化为：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\left(\\frac{1}{a} - \\frac{1}{n_1}\\right) + \\left(\\frac{1}{c} - \\frac{1}{n_0}\\right) $$\n对数风险比的标准误是这个估计方差的平方根：\n$$ \\widehat{SE}(\\ln(\\widehat{RR})) = \\sqrt{\\frac{1}{a} - \\frac{1}{n_1} + \\frac{1}{c} - \\frac{1}{n_0}} $$\n$\\ln(RR)$ 的大样本 $(1-\\alpha) \\times 100\\%$ Wald置信区间是：\n$$ \\ln(\\widehat{RR}) \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。对于 $95\\%$ 置信区间，$\\alpha=0.05$ 且 $z_{0.975} \\approx 1.96$。\n\n风险比 $RR$ 的置信区间通过对 $\\ln(RR)$ 区间的下限和上限取指数来获得：\n$$ \\text{CI}_{1-\\alpha}(RR) = \\exp \\left[ \\ln(\\widehat{RR}) \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) \\right] $$\n$$ \\text{CI}_{1-\\alpha}(RR) = \\widehat{RR} \\times \\exp \\left[ \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) \\right] $$\n\n**3. 数值计算**\n\n给定的数据是：\n- 暴露组：$n_1 = 2400$，$a = 96$ 例。\n- 非暴露组：$n_0 = 3600$，$c = 54$ 例。\n\n首先，我们计算风险和风险比的点估计值：\n$$ \\widehat{R}_1 = \\frac{a}{n_1} = \\frac{96}{2400} = 0.04 $$\n$$ \\widehat{R}_0 = \\frac{c}{n_0} = \\frac{54}{3600} = 0.015 $$\n$$ \\widehat{RR} = \\frac{\\widehat{R}_1}{\\widehat{R}_0} = \\frac{0.04}{0.015} = \\frac{8}{3} \\approx 2.6667 $$\n风险比的点估计值，四舍五入到三位有效数字，是 $2.67$。\n\n接下来，我们计算置信区间所需的量。估计风险比的对数为：\n$$ \\ln(\\widehat{RR}) = \\ln\\left(\\frac{8}{3}\\right) \\approx 0.98083 $$\n对数风险比的估计方差为：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{1}{a} - \\frac{1}{n_1} + \\frac{1}{c} - \\frac{1}{n_0} = \\frac{1}{96} - \\frac{1}{2400} + \\frac{1}{54} - \\frac{1}{3600} $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = (0.0104166\\ldots - 0.0004166\\ldots) + (0.0185185\\ldots - 0.0002777\\ldots) $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = 0.01 + 0.0182407\\ldots = 0.0282407\\ldots $$\n标准误是：\n$$ \\widehat{SE}(\\ln(\\widehat{RR})) = \\sqrt{0.0282407\\ldots} \\approx 0.16805 $$\n对于 $95\\%$ 置信区间，我们使用 $z_{0.975} \\approx 1.96$。$\\ln(RR)$ 的 $95\\%$ 置信区间是：\n$$ \\ln(RR) \\in 0.98083 \\pm 1.96 \\times 0.16805 $$\n$$ \\ln(RR) \\in 0.98083 \\pm 0.32938 $$\n$$ \\ln(RR) \\in [0.65145, 1.31021] $$\n最后，我们对上下限取指数，以获得风险比 $RR$ 的 $95\\%$ 置信区间：\n- 下限：$L = \\exp(0.65145) \\approx 1.9184$\n- 上限：$U = \\exp(1.31021) \\approx 3.7069$\n\n将结果四舍五入至三位有效数字：\n- 点估计值 $\\widehat{RR}$：$2.67$\n- $95\\%$ 置信下限：$1.92$\n- $95\\%$ 置信上限：$3.71$\n\n最终结果由这三个值组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.67  1.92  3.71 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "当研究数据涉及随访时间不等的个体时，我们使用发病率（incidence rate）和率比（Rate Ratio, IRR）来衡量风险，这与使用累积发病率的风险比有所不同。本练习将你的技能从风险比扩展到率比的计算，处理基于人时（person-time）数据和泊松分布模型的场景。这个实践将帮助你理解在动态队列研究中，如何估计关联强度并量化其统计不确定性。",
            "id": "4632603",
            "problem": "一项前瞻性队列研究旨在评估在诊所候诊室安装紫外线杀菌照射装置是否会影响成年患者中经临床确诊的流感样病例就诊率。暴露组诊所安装了该设备，而未暴露组诊所则没有安装。在监测期内，暴露组诊所累积了 $T_{1} = 1200$ 人年 (PY) 的观察时间，并记录了 $E_{1} = 54$ 例新发流感样病例就诊。未暴露组诊所累积了 $T_{0} = 1500$ 人年 (PY) 的观察时间，并记录了 $E_{0} = 32$ 例新发就诊。假设在监测期内，每个诊所组的就诊事件均由具有恒定风险率的独立泊松过程生成。\n\n从发生率 $r = E/T$ 的定义和事件计数的泊松性质出发，推导一个比较暴露组与未暴露组的发生率比 (IRR) 的估计量，以及其在自然对数尺度上的大样本标准误。然后，在对数尺度上构建 IRR 的双侧 $95\\%$ 置信区间 (CI)，并通过变换返回原始尺度。\n\n使用上述数据计算数值。发生率以每人年事件数表示，但将最终的发生率比及其 $95\\%$ 置信区间的界限报告为无单位的比率。将发生率比和每个置信区间界限四舍五入至三位有效数字。",
            "solution": "该问题陈述清晰，具有科学依据，并包含了获得唯一解所需的所有信息。数据是一致的，其假设——事件计数服从具有恒定风险率的独立泊松过程——在流行病学建模中是标准的。\n\n该问题要求推导发生率比 (IRR) 及其置信区间的估计量，然后进行数值计算。\n\n设 $\\lambda_1$ 为暴露组诊所中流感样病例就诊的真实未知发生率（风险率），$\\lambda_0$ 为未暴露组诊所中的真实未知发生率。这些率的单位是事件数/人年。\n\n问题陈述，每组中的新发事件数服从泊松过程。在暴露组中观察到的事件数 $E_1$，是参数为 $\\lambda_1 T_1$ 的泊松随机变量 $K_1$ 的一个实现，其中 $T_1$ 是总人时观察量。类似地，在未暴露组中观察到的事件数 $E_0$，是参数为 $\\lambda_0 T_0$ 的泊松随机变量 $K_0$ 的一个实现。\n所以，我们有：\n$$ K_1 \\sim \\text{Poisson}(\\lambda_1 T_1) $$\n$$ K_0 \\sim \\text{Poisson}(\\lambda_0 T_0) $$\n假设这两个过程是独立的。\n\n每组的发生率通过事件数除以人时来估计。这些是率 $\\lambda_1$ 和 $\\lambda_0$ 的最大似然估计量 (MLEs)。设估计的率为 $\\hat{r}_1$ 和 $\\hat{r}_0$：\n$$ \\hat{r}_1 = \\frac{E_1}{T_1} $$\n$$ \\hat{r}_0 = \\frac{E_0}{T_0} $$\n\n发生率比 (IRR) 定义为真实发生率之比：\n$$ \\text{IRR} = \\frac{\\lambda_1}{\\lambda_0} $$\nIRR 的点估计量是估计的率之比：\n$$ \\widehat{\\text{IRR}} = \\frac{\\hat{r}_1}{\\hat{r}_0} = \\frac{E_1/T_1}{E_0/T_0} $$\n\n为了构建置信区间，通常的做法是在自然对数尺度上进行，因为估计量的对数的抽样分布比估计量本身更接近正态分布。设 $\\theta = \\ln(\\text{IRR}) = \\ln(\\lambda_1) - \\ln(\\lambda_0)$。$\\theta$ 的估计量是：\n$$ \\hat{\\theta} = \\ln(\\widehat{\\text{IRR}}) = \\ln(\\hat{r}_1) - \\ln(\\hat{r}_0) $$\n\n为了求 $\\hat{\\theta}$ 的方差，我们首先求出每一项的方差。由于两组是独立的，差的方差是方差之和：\n$$ \\text{Var}(\\hat{\\theta}) = \\text{Var}(\\ln(\\hat{r}_1)) + \\text{Var}(\\ln(\\hat{r}_0)) $$\n我们使用 delta 方法来近似 $\\ln(\\hat{r}_i)$ 的方差，其中 $\\hat{r}_i = K_i/T_i$，$K_i$ 是事件计数的随机变量。设 $g(K_i) = \\ln(K_i/T_i) = \\ln(K_i) - \\ln(T_i)$。方差近似为：\n$$ \\text{Var}(g(K_i)) \\approx \\left( \\frac{d g(k)}{dk} \\bigg|_{k=\\mathbb{E}[K_i]} \\right)^2 \\text{Var}(K_i) $$\n对于一个泊松变量 $K_i \\sim \\text{Poisson}(\\lambda_i T_i)$，我们有 $\\mathbb{E}[K_i] = \\lambda_i T_i$ 和 $\\text{Var}(K_i) = \\lambda_i T_i$。导数为 $\\frac{d g(k)}{dk} = \\frac{1}{k}$。\n将这些代入 delta 方法的公式：\n$$ \\text{Var}(\\ln(\\hat{r}_i)) \\approx \\left( \\frac{1}{\\lambda_i T_i} \\right)^2 (\\lambda_i T_i) = \\frac{1}{\\lambda_i T_i} $$\n在实践中，真实率 $\\lambda_i$ 是未知的，并用其估计值 $\\hat{r}_i = E_i/T_i$ 代替。$\\ln(\\hat{r}_i)$ 的估计方差是：\n$$ \\widehat{\\text{Var}}(\\ln(\\hat{r}_i)) \\approx \\frac{1}{\\hat{r}_i T_i} = \\frac{1}{(E_i/T_i)T_i} = \\frac{1}{E_i} $$\n这个结果表明，对数发生率的方差可以简单地通过观察到的事件数的倒数来估计。\n\n现在，我们可以求出 $\\hat{\\theta} = \\ln(\\widehat{\\text{IRR}})$ 的估计方差：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{\\text{IRR}})) = \\widehat{\\text{Var}}(\\ln(\\hat{r}_1)) + \\widehat{\\text{Var}}(\\ln(\\hat{r}_0)) = \\frac{1}{E_1} + \\frac{1}{E_0} $$\n对数尺度上的大样本标准误 (SE) 是该方差的平方根：\n$$ \\text{SE}(\\ln(\\widehat{\\text{IRR}})) = \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} $$\n\n基于正态近似，$\\ln(\\text{IRR})$ 的一个双侧 $(1-\\alpha) \\times 100\\%$ 置信区间构建如下：\n$$ \\ln(\\widehat{\\text{IRR}}) \\pm z_{1-\\alpha/2} \\times \\text{SE}(\\ln(\\widehat{\\text{IRR}})) $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。对于 $95\\%$ 的置信区间，$\\alpha=0.05$，且 $z_{0.975} \\approx 1.96$。\n$\\ln(\\text{IRR})$ 的 $95\\%$ 置信区间为：\n$$ \\left( \\ln(\\widehat{\\text{IRR}}) - 1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}}, \\ln(\\widehat{\\text{IRR}}) + 1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right) $$\n为了获得 IRR 本身的置信区间，我们将 $\\ln(\\text{IRR})$ 区间的下限和上限取指数。IRR 的置信区间为：\n$$ \\left( \\widehat{\\text{IRR}} \\cdot \\exp\\left( -1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right), \\widehat{\\text{IRR}} \\cdot \\exp\\left( +1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right) \\right) $$\n\n现在，我们将这些公式应用于给定的数据：\n暴露组：$E_1 = 54$ 事件，$T_1 = 1200$ 人年 (PY)。\n未暴露组：$E_0 = 32$ 事件，$T_0 = 1500$ 人年 (PY)。\n\n首先，计算发生率：\n$$ \\hat{r}_1 = \\frac{54}{1200} = 0.045 \\text{ 事件/人年} $$\n$$ \\hat{r}_0 = \\frac{32}{1500} \\approx 0.02133 \\text{ 事件/人年} $$\n\n接下来，计算 IRR 的点估计值：\n$$ \\widehat{\\text{IRR}} = \\frac{0.045}{32/1500} = \\frac{54/1200}{32/1500} = \\frac{54 \\times 1500}{1200 \\times 32} = \\frac{81000}{38400} = 2.109375 $$\n\n接下来，计算对数 IRR 的标准误：\n$$ \\text{SE}(\\ln(\\widehat{\\text{IRR}})) = \\sqrt{\\frac{1}{54} + \\frac{1}{32}} = \\sqrt{0.0185185... + 0.03125} = \\sqrt{0.0497685...} \\approx 0.2230976 $$\n\n在对数尺度上计算 $95\\%$ 置信区间。首先，求出 $\\ln(\\widehat{\\text{IRR}})$：\n$$ \\ln(\\widehat{\\text{IRR}}) = \\ln(2.109375) \\approx 0.746308 $$\n误差范围 (ME) 是：\n$$ \\text{ME} = 1.96 \\times \\text{SE}(\\ln(\\widehat{\\text{IRR}})) \\approx 1.96 \\times 0.2230976 \\approx 0.437271 $$\n$\\ln(\\text{IRR})$ 的 $95\\%$ 置信区间是：\n$$ (0.746308 - 0.437271, 0.746308 + 0.437271) = (0.309037, 1.183579) $$\n\n最后，对界限取指数以获得 IRR 的 $95\\%$ 置信区间：\n下限：$\\exp(0.309037) \\approx 1.36214$\n上限：$\\exp(1.183579) \\approx 3.26598$\n\n问题要求将 IRR 和 CI 界限四舍五入到三位有效数字。\nIRR 的点估计值：$\\widehat{\\text{IRR}} \\approx 2.11$\nIRR 的 $95\\%$ 置信区间：$(1.36, 3.27)$\n\n安装了紫外线杀菌照射装置的诊所中流感样疾病的发生率是未安装装置诊所的2.11倍。其 $95\\%$ 置信区间为 $(1.36, 3.27)$，不包含 $1.0$，这表明在 $\\alpha=0.05$ 的水平上，观察到的关联具有统计学意义。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.11  1.36  3.27 \\end{pmatrix}}$$"
        },
        {
            "introduction": "尽管风险比（RR）和率比（IRR）都用于衡量关联强度，但它们在数值上并非总是相等，两者的关系也并非一成不变。本练习是一个更深入的概念性挑战，旨在揭示RR与IRR之间差异的内在机制。通过分析具有不同风险模式的假想情景，你将探索“易感者耗竭”（depletion of susceptibles）现象如何影响人时累积，并最终导致RR和IRR出现不一致甚至方向相反的结论。",
            "id": "4632604",
            "problem": "一项队列研究从 $t=0$ 开始追踪两个独立的组群，暴露组和非暴露组，每组各有 $N$ 个个体，直至 $t=T$ 的行政终止时间。目标事件发生后，个体将从后续风险中被移除。假设除了事件发生和在 $t=T$ 时的行政终止外，没有竞争风险，也没有其他失访。风险函数是分段常数，并根据组别和下述情景而有所不同。在整个研究中，风险比 (RR) 定义为暴露组与非暴露组在 $t=T$ 时的累积发病率之比；发病率比 (IRR) 定义为发病率之比，其中每组的发病率是事件总数除以在 $[0,T]$ 期间累积的总人时数。所有比值都是纯数（无量纲）。\n\n计算每种情景下暴露组对非暴露组的 $RR$ 和 $IRR$，并将每个量四舍五入至四位有效数字。然后，用文字解释在每种情景中，计算出的 $RR$ 和 $IRR$ 的不等关系（$RRIRR$ 或 $RRIRR$）背后的流行病学机制，重点关注风险的时间模式如何通过影响人时累积来改变这两个比值的关系。\n\n#### 情景 A\n- 研究终止于 $T=3$ 年。\n- **非暴露组** 的风险是恒定的：$\\lambda_{U}(t) = 0.05 \\text{ yr}^{-1}$ 对于 $0 \\leq t \\leq 3$。\n- **暴露组** 的风险在早期较高：$\\lambda_{E}(t) = 0.30 \\text{ yr}^{-1}$ 对于 $0 \\leq t  1$，然后降低为 $\\lambda_{E}(t) = 0.02 \\text{ yr}^{-1}$ 对于 $1 \\leq t \\leq 3$。\n\n#### 情景 B\n- 研究终止于 $T=3$ 年。\n- **非暴露组** 的风险在早期较高：$\\lambda_{U}(t) = 0.20 \\text{ yr}^{-1}$ 对于 $0 \\leq t  1$，然后降低为 $\\lambda_{U}(t) = 0.02 \\text{ yr}^{-1}$ 对于 $1 \\leq t \\leq 3$。\n- **暴露组** 的风险在晚期较高：$\\lambda_{E}(t) = 0.04 \\text{ yr}^{-1}$ 对于 $0 \\leq t  2$，然后升高为 $\\lambda_{E}(t) = 0.30 \\text{ yr}^{-1}$ 对于 $2 \\leq t \\leq 3$。\n\n将最终答案表示为一个包含四个数字的行矩阵：$[RR_A, IRR_A, RR_B, IRR_B]$。",
            "solution": "问题验证如下。\n\n### 步骤1：提取已知条件\n- **研究设计**：一项队列研究，有两个独立的组群，暴露组和非暴露组。\n- **队列规模**：每组有 $N$ 个个体。\n- **随访期**：从 $t=0$ 到 $t=T$。\n- **事件**：目标事件将个体从后续风险中移除。\n- **假设**：无竞争风险，除事件或 $t=T$ 时行政性删失外无失访。\n- **风险函数**：分段常数，因组别和情景而异。\n- **定义**：\n    - **风险比 (RR)**：暴露组与非暴露组在 $t=T$ 时的累积发病率之比，$RR = CI_E(T) / CI_U(T)$。\n    - **发病率比 (IRR)**：在 $[0,T]$ 期间的发病率之比，其中发病率是事件总数除以总人时数，$IRR = IR_E / IR_U$。\n- **情景 A**：\n    - $T=3$ 年。\n    - 非暴露组风险：$\\lambda_{U}(t)=0.05$ 每年，对于 $0 \\leq t \\leq 3$。\n    - 暴露组风险：$\\lambda_{E}(t)=0.30$ 每年，对于 $0 \\leq t  1$；以及 $\\lambda_{E}(t)=0.02$ 每年，对于 $1 \\leq t \\leq 3$。\n- **情景 B**：\n    - $T=3$ 年。\n    - 非暴露组风险：$\\lambda_{U}(t)=0.20$ 每年，对于 $0 \\leq t  1$；以及 $\\lambda_{U}(t)=0.02$ 每年，对于 $1 \\leq t \\leq 3$。\n    - 暴露组风险：$\\lambda_{E}(t)=0.04$ 每年，对于 $0 \\leq t  2$；以及 $\\lambda_{E}(t)=0.30$ 每年，对于 $2 \\leq t \\leq 3$。\n- **任务**：计算每种情景下的 $RR$ 和 $IRR$，四舍五入到四位有效数字。解释每种情景中 $RR$ 和 $IRR$ 之间关系差异的机制。最终答案格式：行矩阵 $[RR_A, IRR_A, RR_B, IRR_B]$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题基于标准的流行病学和生存分析原理（风险函数、生存函数、累积发病率、人时、RR、IRR），具有科学依据。所提供的定义清晰且标准。所有必要的数据（风险函数、随访时间）均已提供，使得问题提法恰当且自洽。语言客观而精确。数据在量纲上是一致的。该问题不违反任何科学原理，没有歧义，并且需要进行实质性的计算和概念推理。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供完整解答。\n\n### 原理与公式\n设 $\\lambda(t)$ 为风险函数。生存函数 $S(t)$ 是在时间 $t$ 仍未发生事件的概率。它由下式给出：\n$$S(t) = \\exp\\left(-\\int_0^t \\lambda(u) du\\right) = \\exp(-\\Lambda(t))$$\n其中 $\\Lambda(t)$ 是累积风险函数。\n\n到时间 $T$ 为止的累积发病率，记为 $CI(T)$ 或简称 $CI$，是在时间 $T$ 前经历事件的概率：\n$$CI(T) = 1 - S(T)$$\n\n在一个规模为 $N$ 的队列中，事件总数为 $N \\times CI(T)$。总风险人时由风险个体数量对时间的积分给出，即 $N \\int_0^T S(t) dt$。\n\n发病率 $IR$ 是事件总数与总人时数的比值：\n$$IR = \\frac{N \\times CI(T)}{N \\int_0^T S(t) dt} = \\frac{1 - S(T)}{\\int_0^T S(t) dt}$$\n初始队列规模 $N$ 被消去，因此所有计算都可以以人均（per-capita）为基础进行。\n\n暴露组（E）相对于非暴露组（U）的风险比（$RR$）和发病率比（$IRR$）为：\n$$RR = \\frac{CI_E(T)}{CI_U(T)}$$\n$$IRR = \\frac{IR_E}{IR_U} = \\frac{CI_E(T) / \\int_0^T S_E(t) dt}{CI_U(T) / \\int_0^T S_U(t) dt}$$\n\n### 情景A的计算\n随访时间为 $T=3$。\n\n**非暴露组 (U)：**\n风险是恒定的，$\\lambda_U(t) = 0.05$ 对于 $t \\in [0, 3]$。\n生存函数为 $S_U(t) = \\exp(-0.05t)$。\n累积发病率为 $CI_U = 1 - S_U(3) = 1 - \\exp(-0.05 \\times 3) = 1 - \\exp(-0.15)$。\n人均人时为 $PT_U = \\int_0^3 \\exp(-0.05t) dt = \\left[\\frac{\\exp(-0.05t)}{-0.05}\\right]_0^3 = \\frac{1 - \\exp(-0.15)}{0.05}$。\n发病率为 $IR_U = \\frac{CI_U}{PT_U} = 0.05$。\n\n**暴露组 (E)：**\n风险是分段的：$\\lambda_E(t) = 0.30$ 对于 $t \\in [0, 1)$ 且 $\\lambda_E(t) = 0.02$ 对于 $t \\in [1, 3]$。\n累积风险 $\\Lambda_E(t)$ 为：\n- 对于 $0 \\leq t  1$：$\\Lambda_E(t) = 0.30t$。\n- 对于 $1 \\leq t \\leq 3$：$\\Lambda_E(t) = (0.30 \\times 1) + 0.02(t-1) = 0.28 + 0.02t$。\n生存函数 $S_E(t)$ 为：\n- 对于 $0 \\leq t  1$：$S_E(t) = \\exp(-0.30t)$。\n- 对于 $1 \\leq t \\leq 3$：$S_E(t) = \\exp(-(0.28 + 0.02t))$。\n累积发病率为 $CI_E = 1 - S_E(3) = 1 - \\exp(-(0.28 + 0.02 \\times 3)) = 1 - \\exp(-0.34)$。\n人均人时为 $PT_E = \\int_0^1 \\exp(-0.30t)dt + \\int_1^3 \\exp(-0.28 - 0.02t)dt$。\n$$PT_E = \\left[\\frac{\\exp(-0.30t)}{-0.30}\\right]_0^1 + \\left[\\frac{\\exp(-0.28-0.02t)}{-0.02}\\right]_1^3 = \\frac{1-\\exp(-0.30)}{0.30} + \\frac{\\exp(-0.30)-\\exp(-0.34)}{0.02}$$\n发病率为 $IR_E = CI_E / PT_E$。\n\n**情景A的数值：**\n$CI_U = 1 - \\exp(-0.15) \\approx 0.139292$\n$CI_E = 1 - \\exp(-0.34) \\approx 0.288230$\n$RR_A = \\frac{0.288230}{0.139292} \\approx 2.06924 \\rightarrow 2.069$\n\n$IR_U = 0.05$\n$PT_E \\approx \\frac{1 - 0.740818}{0.30} + \\frac{0.740818 - 0.711770}{0.02} \\approx 0.863939 + 1.45240 \\approx 2.31634$\n$IR_E = \\frac{CI_E}{PT_E} \\approx \\frac{0.288230}{2.31634} \\approx 0.124433$\n$IRR_A = \\frac{IR_E}{IR_U} \\approx \\frac{0.124433}{0.05} \\approx 2.48867 \\rightarrow 2.489$\n\n### 情景B的计算\n随访时间为 $T=3$。\n\n**非暴露组 (U)：**\n风险是分段的：$\\lambda_U(t) = 0.20$ 对于 $t \\in [0, 1)$ 且 $\\lambda_U(t) = 0.02$ 对于 $t \\in [1, 3]$。\n累积发病率为 $CI_U = 1 - \\exp(-((0.20 \\times 1) + 0.02 \\times (3-1))) = 1 - \\exp(-0.24)$。\n人时为 $PT_U = \\int_0^1 \\exp(-0.20t)dt + \\int_1^3 \\exp(-(0.20+0.02(t-1)))dt$。\n$$PT_U = \\frac{1-\\exp(-0.20)}{0.20} + \\frac{\\exp(-0.20)-\\exp(-0.24)}{0.02}$$\n发病率为 $IR_U = CI_U / PT_U$。\n\n**暴露组 (E)：**\n风险是分段的：$\\lambda_E(t) = 0.04$ 对于 $t \\in [0, 2)$ 且 $\\lambda_E(t) = 0.30$ 对于 $t \\in [2, 3]$。\n累积发病率为 $CI_E = 1 - \\exp(-((0.04 \\times 2) + 0.30 \\times (3-2))) = 1 - \\exp(-0.38)$。\n人时为 $PT_E = \\int_0^2 \\exp(-0.04t)dt + \\int_2^3 \\exp(-(0.08+0.30(t-2)))dt$。\n$$PT_E = \\frac{1-\\exp(-0.08)}{0.04} + \\frac{\\exp(-0.08)-\\exp(-0.38)}{0.30}$$\n发病率为 $IR_E = CI_E / PT_E$。\n\n**情景B的数值：**\n$CI_U = 1 - \\exp(-0.24) \\approx 0.213372$\n$CI_E = 1 - \\exp(-0.38) \\approx 0.316139$\n$RR_B = \\frac{0.316139}{0.213372} \\approx 1.48163 \\rightarrow 1.482$\n\n$PT_U \\approx \\frac{1-0.818731}{0.20} + \\frac{0.818731 - 0.786628}{0.02} \\approx 0.906346 + 1.60515 \\approx 2.51150$\n$IR_U = \\frac{CI_U}{PT_U} \\approx \\frac{0.213372}{2.51150} \\approx 0.084958$\n$PT_E \\approx \\frac{1-0.923116}{0.04} + \\frac{0.923116 - 0.683861}{0.30} \\approx 1.92209 + 0.797517 \\approx 2.71961$\n$IR_E = \\frac{CI_E}{PT_E} \\approx \\frac{0.316139}{2.71961} \\approx 0.116244$\n$IRR_B = \\frac{IR_E}{IR_U} \\approx \\frac{0.116244}{0.084958} \\approx 1.36827 \\rightarrow 1.368$\n\n### RR 与 IRR 差异的解释\n\n风险比（$RR$）和发病率比（$IRR$）之间的差异源于随访期内非恒定的风险比率，以及由此对发病率计算中人时分母产生的差异性影响。\n\n在**情景A**中，暴露组在随访早期经历非常高的风险（当 $t1$ 时，$\\lambda_E=0.30$ 对比 $\\lambda_U=0.05$）。这导致暴露组队列中“易感人群”的迅速耗竭，因为许多个体很早就经历了事件。当个体发生事件后，他们就不再为发病率计算的分母贡献人时。这种早期耗竭显著减少了暴露组（$PT_E$）相较于非暴露组累积的总人时。较小的分母会抬高计算出的发病率 $IR_E$。因此，$IRR$ 受到这种早期高风险和减少的人时的严重影响，使其大于 $RR$，$RR$ 只考虑截至 $t=3$ 时发生事件的个体最终比例，而不管事件发生的时间。因此，我们发现 $IRR_A > RR_A$。\n\n在**情景B**中，情况则相反。在第一年，暴露组的风险低于非暴露组（$\\lambda_E=0.04$ 对比 $\\lambda_U=0.20$），而暴露组风险的主要激增（$\\lambda_E=0.30$）发生在研究后期（$t \\in [2,3]$）。由于暴露组的高风险期被延迟，这些个体在更长的时间内保持易感状态并继续累积人时。这导致了一个相对较大的人时分母（$PT_E$）。当事件在晚期激增期间发生时，它们对发病率的分子（事件数）有贡献，但分母（人时）已经大幅增长。这缓和了计算出的发病率 $IR_E$。相比之下，$RR$ 对研究结束时的事件总数很敏感。晚期的高强度风险激增能有效增加最终的累积发病率 $CI_E$。暴露组的较大人时分母导致其 $IR_E$ 不如其 $CI_E$ 那样极端，从而使得 $IRR$ 小于 $RR$。因此，我们发现 $RR_B > IRR_B$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.069  2.489  1.482  1.368\n\\end{pmatrix}\n}\n$$"
        }
    ]
}