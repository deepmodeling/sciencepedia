{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，让我们通过实践来巩固对风险比（Risk Ratio, RR）的理解。这个练习将指导你处理一个经典的封闭队列研究场景，你需要从原始数据中计算风险比的点估计值，并为其构建置信区间。掌握这一基于二项分布模型的推导和计算，对于量化暴露与疾病结局之间的关联强度至关重要。",
            "id": "4632550",
            "problem": "一个由生产工人组成的封闭队列接受了为期固定的随访，以评估在某个特定工作区域引入一种溶剂后新发呼吸系统疾病的发生情况。在基线时，该队列按暴露情况被分为两组。在随访期间，观察到以下计数：在暴露组中，有 $n_{1}=2{,}400$ 名工人，其中有 $a=96$ 例新发病例；在非暴露组中，有 $n_{0}=3{,}600$ 名工人，其中有 $c=54$ 例新发病例。假设这是一个随访完整的封闭队列，并且每个暴露组内部均采用独立的二项式抽样。\n\n从第一性原理出发，使用风险的二项式模型和估计量的可微变换性质，推导风险比对数的近似大样本Wald置信区间，然后反变换以获得原始尺度上的置信区间。具体而言，请从各组特定风险的二项分布出发，并使用一阶近似来获得在对数尺度上构建Wald置信区间所需的抽样方差，同时注意阐明组间独立性的作用。\n\n计算暴露组与非暴露组相比的风险比 $\\widehat{RR}$ 的点估计值，以及通过所述Wald方法获得的双侧 $95\\%$ 置信区间。将报告的三个数字（点估计值、下限、上限）均四舍五入至三位有效数字。最终答案表示为三个无单位的数字。",
            "solution": "该问题经评估是有效的。它提出了一个基于队列研究设计的、标准的、适定的流行病学问题。所提供的数据是完整和一致的，目标陈述清晰，其基础统计模型（独立二项式抽样）在科学上是合理的，并且适合该情境。该任务要求从第一性原理进行推导和计算，这是生物统计理论中的一个标准练习。\n\n推导和计算过程如下。\n\n**1. 参数和估计量的定义**\n\n设 $R_1$ 为暴露组中呼吸系统疾病的真实风险（累积发病率），$R_0$ 为非暴露组中的真实风险。问题陈述该研究遵循封闭队列设计。每组的新发病例数可以用二项分布来建模。\n\n- 在暴露组中，病例数 $a$ 是一个随机变量，服从 $a \\sim \\text{Binomial}(n_1, R_1)$。\n- 在非暴露组中，病例数 $c$ 是一个随机变量，服从 $c \\sim \\text{Binomial}(n_0, R_0)$。\n\n风险的最大似然估计量是样本比例：\n- $R_1$的估计量：$\\widehat{R}_1 = \\frac{a}{n_1}$\n- $R_0$的估计量：$\\widehat{R}_0 = \\frac{c}{n_0}$\n\n我们感兴趣的参数是风险比 $RR = \\frac{R_1}{R_0}$。其点估计由 $\\widehat{RR} = \\frac{\\widehat{R}_1}{\\widehat{R}_0}$ 给出。\n\n**2. 置信区间的推导**\n\n我们寻求 $RR$ 的置信区间。$\\widehat{RR}$ 的分布是偏态的，但其对数 $\\ln(\\widehat{RR})$ 的分布对于大样本而言更接近正态分布。因此，我们首先为 $\\ln(RR)$ 构建一个置信区间，然后对其进行反变换。\n\n估计的风险比的对数为：\n$$ \\ln(\\widehat{RR}) = \\ln\\left(\\frac{\\widehat{R}_1}{\\widehat{R}_0}\\right) = \\ln(\\widehat{R}_1) - \\ln(\\widehat{R}_0) $$\n问题指明两组中的抽样是独立的。因此，估计量 $\\widehat{R}_1$ 和 $\\widehat{R}_0$ 是独立的，它们的变换 $\\ln(\\widehat{R}_1)$ 和 $\\ln(\\widehat{R}_0)$ 也是独立的。差的方差是方差之和：\n$$ \\text{Var}(\\ln(\\widehat{RR})) = \\text{Var}(\\ln(\\widehat{R}_1)) + \\text{Var}(\\ln(\\widehat{R}_0)) $$\n为了求出 $i \\in \\{0, 1\\}$ 时 $\\ln(\\widehat{R}_i)$ 的方差，我们使用一阶泰勒级数展开，也称为Delta方法。对于随机变量 $X$ 的函数 $g(X)$，其近似方差为 $\\text{Var}(g(X)) \\approx [g'(E(X))]^2 \\text{Var}(X)$。\n\n在这里，随机变量是估计量 $\\widehat{R}_i$，函数是 $g(x) = \\ln(x)$。其导数为 $g'(x) = \\frac{1}{x}$。估计量的期望值为 $E(\\widehat{R}_i) = R_i$。估计量的方差由二项式模型导出：$\\text{Var}(\\widehat{R}_i) = \\text{Var}(\\frac{\\text{cases}_i}{n_i}) = \\frac{1}{n_i^2} \\text{Var}(\\text{cases}_i) = \\frac{1}{n_i^2} [n_i R_i (1-R_i)] = \\frac{R_i(1-R_i)}{n_i}$。\n\n将Delta方法应用于 $\\ln(\\widehat{R}_1)$：\n$$ \\text{Var}(\\ln(\\widehat{R}_1)) \\approx \\left[ \\frac{d}{dR_1} \\ln(R_1) \\right]^2 \\text{Var}(\\widehat{R}_1) = \\left(\\frac{1}{R_1}\\right)^2 \\frac{R_1(1-R_1)}{n_1} = \\frac{1-R_1}{n_1 R_1} $$\n同样，对于非暴露组：\n$$ \\text{Var}(\\ln(\\widehat{R}_0)) \\approx \\frac{1-R_0}{n_0 R_0} $$\n将这些相加，得到对数风险比的方差：\n$$ \\text{Var}(\\ln(\\widehat{RR})) \\approx \\frac{1-R_1}{n_1 R_1} + \\frac{1-R_0}{n_0 R_0} $$\n为了将其用于置信区间，我们需要一个估计方差，通过将真实风险 $R_1$ 和 $R_0$ 替换为估计风险 $\\widehat{R}_1 = a/n_1$ 和 $\\widehat{R}_0 = c/n_0$ 来获得：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{1-\\widehat{R}_1}{n_1 \\widehat{R}_1} + \\frac{1-\\widehat{R}_0}{n_0 \\widehat{R}_0} = \\frac{1-a/n_1}{n_1(a/n_1)} + \\frac{1-c/n_0}{n_0(c/n_0)} = \\frac{(n_1-a)/n_1}{a} + \\frac{(n_0-c)/n_0}{c} $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{n_1-a}{n_1 a} + \\frac{n_0-c}{n_0 c} $$\n这可以代数简化为：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\left(\\frac{1}{a} - \\frac{1}{n_1}\\right) + \\left(\\frac{1}{c} - \\frac{1}{n_0}\\right) $$\n对数风险比的标准误是该估计方差的平方根：\n$$ \\widehat{SE}(\\ln(\\widehat{RR})) = \\sqrt{\\frac{1}{a} - \\frac{1}{n_1} + \\frac{1}{c} - \\frac{1}{n_0}} $$\n$\\ln(RR)$ 的大样本 $(1-\\alpha) \\times 100\\%$ Wald置信区间是：\n$$ \\ln(\\widehat{RR}) \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。对于一个95%的置信区间，$\\alpha=0.05$ 且 $z_{0.975} \\approx 1.96$。\n\n风险比 $RR$ 的置信区间是通过对 $\\ln(RR)$ 区间的下限和上限取指数得到的：\n$$ \\text{CI}_{1-\\alpha}(RR) = \\exp \\left[ \\ln(\\widehat{RR}) \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) \\right] $$\n$$ \\text{CI}_{1-\\alpha}(RR) = \\widehat{RR} \\times \\exp \\left[ \\pm z_{1-\\alpha/2} \\times \\widehat{SE}(\\ln(\\widehat{RR})) \\right] $$\n\n**3. 数值计算**\n\n给定的数据是：\n- 暴露组：$n_1 = 2400$，$a = 96$ 例病例。\n- 非暴露组：$n_0 = 3600$，$c = 54$ 例病例。\n\n首先，我们计算风险和风险比的点估计值：\n$$ \\widehat{R}_1 = \\frac{a}{n_1} = \\frac{96}{2400} = 0.04 $$\n$$ \\widehat{R}_0 = \\frac{c}{n_0} = \\frac{54}{3600} = 0.015 $$\n$$ \\widehat{RR} = \\frac{\\widehat{R}_1}{\\widehat{R}_0} = \\frac{0.04}{0.015} = \\frac{8}{3} \\approx 2.6667 $$\n风险比的点估计值，四舍五入到三位有效数字，是 $2.67$。\n\n接下来，我们计算置信区间所需的量。估计的风险比的对数是：\n$$ \\ln(\\widehat{RR}) = \\ln\\left(\\frac{8}{3}\\right) \\approx 0.98083 $$\n对数风险比的估计方差是：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = \\frac{1}{a} - \\frac{1}{n_1} + \\frac{1}{c} - \\frac{1}{n_0} = \\frac{1}{96} - \\frac{1}{2400} + \\frac{1}{54} - \\frac{1}{3600} $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = (0.0104166\\ldots - 0.0004166\\ldots) + (0.0185185\\ldots - 0.0002777\\ldots) $$\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{RR})) = 0.01 + 0.0182407\\ldots = 0.0282407\\ldots $$\n标准误是：\n$$ \\widehat{SE}(\\ln(\\widehat{RR})) = \\sqrt{0.0282407\\ldots} \\approx 0.16805 $$\n对于95%置信区间，我们使用 $z_{0.975} \\approx 1.96$。$\\ln(RR)$的95%置信区间是：\n$$ \\ln(RR) \\in 0.98083 \\pm 1.96 \\times 0.16805 $$\n$$ \\ln(RR) \\in 0.98083 \\pm 0.32938 $$\n$$ \\ln(RR) \\in [0.65145, 1.31021] $$\n最后，我们对上下限取指数，以获得风险比 $RR$ 的95%置信区间：\n- 下限：$L = \\exp(0.65145) \\approx 1.9184$\n- 上限：$U = \\exp(1.31021) \\approx 3.7069$\n\n将结果四舍五入到三位有效数字：\n- 点估计 $\\widehat{RR}$：$2.67$\n- 95%置信下限：$1.92$\n- 95%置信上限：$3.71$\n\n最终结果由这三个值组成。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2.67  1.92  3.71 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "与风险比不同，率比（Incidence Rate Ratio, IRR）适用于动态人群或随访时间不等的队列研究。本练习将带你分析一项涉及人时数据的研究，计算暴露组与非暴露组的发病率比，并为其构建置信区间。通过这个基于泊松过程的练习，你将学会如何处理和解释基于“率”的相对效应度量，这是衡量干预措施效果的常用方法。",
            "id": "4632603",
            "problem": "进行了一项前瞻性队列研究，以评估在诊所候诊室安装紫外线杀菌照射装置是否会影响成年患者中经临床确诊的流感样疾病就诊率。暴露组诊所安装了该设备，而未暴露组诊所则没有安装。在监测期内，暴露组诊所累积了 $T_{1} = 1200$ 人年 (PY) 的观察量，并记录了 $E_{1} = 54$ 例新发流感样疾病就诊。未暴露组诊所累积了 $T_{0} = 1500$ 人年，并记录了 $E_{0} = 32$ 例新发就诊。假设在监测期内，每个诊所组内的就诊事件均由具有恒定风险率的独立泊松过程生成。\n\n从发生率 $r = E/T$ 的定义和事件计数的泊松性质出发，推导一个用于比较暴露组与未暴露组诊所的发生率比（IRR）的估计量，及其在自然对数尺度上的大样本标准误。然后，通过在对数尺度上进行计算再转换回来，为IRR构建一个双侧$95\\%$置信区间（CI）。\n\n使用以上数据计算数值。将发生率以“事件/人年”为单位表示，但将最终的发生率比及其95%置信区间的界限作为无单位的比率报告。将发生率比和每个置信区间界限四舍五入至三位有效数字。",
            "solution": "该问题提法恰当，有科学依据，并包含了得出唯一解所需的所有信息。数据是一致的，其假设——事件计数服从具有恒定风险率的独立泊松过程——在流行病学建模中是标准的。\n\n该问题要求推导发生率比（IRR）的估计量及其置信区间，然后进行数值计算。\n\n设 $\\lambda_1$ 为暴露组诊所中流感样疾病就诊的真实但未知的发生率（风险率），$\\lambda_0$ 为未暴露组诊所中真实的、未知的发生率。这些率的单位是“事件/人年”。\n\n问题陈述，每组中的新发事件数遵循泊松过程。在暴露组中观察到的事件数 $E_1$ 是参数为 $\\lambda_1 T_1$ 的泊松随机变量 $K_1$ 的一个实现，其中 $T_1$ 是总观察人时。类似地，在未暴露组中观察到的事件数 $E_0$ 是参数为 $\\lambda_0 T_0$ 的泊松随机变量 $K_0$ 的一个实现。\n所以，我们有：\n$$ K_1 \\sim \\text{Poisson}(\\lambda_1 T_1) $$\n$$ K_0 \\sim \\text{Poisson}(\\lambda_0 T_0) $$\n假设这两个过程是独立的。\n\n每组的发生率通过事件数除以人时来估计。这些是率 $\\lambda_1$ 和 $\\lambda_0$ 的最大似然估计量（MLEs）。设估计率为 $\\hat{r}_1$ 和 $\\hat{r}_0$：\n$$ \\hat{r}_1 = \\frac{E_1}{T_1} $$\n$$ \\hat{r}_0 = \\frac{E_0}{T_0} $$\n\n发生率比（IRR）定义为真实发生率之比：\n$$ \\text{IRR} = \\frac{\\lambda_1}{\\lambda_0} $$\nIRR的点估计量是估计率之比：\n$$ \\widehat{\\text{IRR}} = \\frac{\\hat{r}_1}{\\hat{r}_0} = \\frac{E_1/T_1}{E_0/T_0} $$\n\n为了构建置信区间，标准做法是在自然对数尺度上进行操作，因为估计量的对数的抽样分布比估计量本身更接近正态分布。设 $\\theta = \\ln(\\text{IRR}) = \\ln(\\lambda_1) - \\ln(\\lambda_0)$。$\\theta$ 的估计量是：\n$$ \\hat{\\theta} = \\ln(\\widehat{\\text{IRR}}) = \\ln(\\hat{r}_1) - \\ln(\\hat{r}_0) $$\n\n为了求 $\\hat{\\theta}$ 的方差，我们首先求出每一项的方差。由于两组是独立的，差的方差是方差的和：\n$$ \\text{Var}(\\hat{\\theta}) = \\text{Var}(\\ln(\\hat{r}_1)) + \\text{Var}(\\ln(\\hat{r}_0)) $$\n我们使用delta方法来近似 $\\ln(\\hat{r}_i)$ 的方差，其中 $\\hat{r}_i = K_i/T_i$ 且 $K_i$ 是事件计数的随机变量。设 $g(K_i) = \\ln(K_i/T_i) = \\ln(K_i) - \\ln(T_i)$。方差近似为：\n$$ \\text{Var}(g(K_i)) \\approx \\left( \\frac{d g(k)}{dk} \\bigg|_{k=\\mathbb{E}[K_i]} \\right)^2 \\text{Var}(K_i) $$\n对于一个泊松变量 $K_i \\sim \\text{Poisson}(\\lambda_i T_i)$，我们有 $\\mathbb{E}[K_i] = \\lambda_i T_i$ 和 $\\text{Var}(K_i) = \\lambda_i T_i$。其导数为 $\\frac{d g(k)}{dk} = \\frac{1}{k}$。\n将这些代入delta方法公式中：\n$$ \\text{Var}(\\ln(\\hat{r}_i)) \\approx \\left( \\frac{1}{\\lambda_i T_i} \\right)^2 (\\lambda_i T_i) = \\frac{1}{\\lambda_i T_i} $$\n在实践中，真实率 $\\lambda_i$ 是未知的，并由其估计值 $\\hat{r}_i = E_i/T_i$ 替代。$\\ln(\\hat{r}_i)$ 的估计方差为：\n$$ \\widehat{\\text{Var}}(\\ln(\\hat{r}_i)) \\approx \\frac{1}{\\hat{r}_i T_i} = \\frac{1}{(E_i/T_i)T_i} = \\frac{1}{E_i} $$\n这个结果表明，对数发生率的方差可以简单地通过观察到的事件数的倒数来估计。\n\n现在，我们可以求出 $\\hat{\\theta} = \\ln(\\widehat{\\text{IRR}})$ 的估计方差：\n$$ \\widehat{\\text{Var}}(\\ln(\\widehat{\\text{IRR}})) = \\widehat{\\text{Var}}(\\ln(\\hat{r}_1)) + \\widehat{\\text{Var}}(\\ln(\\hat{r}_0)) = \\frac{1}{E_1} + \\frac{1}{E_0} $$\n在对数尺度上的大样本标准误（SE）是该方差的平方根：\n$$ \\text{SE}(\\ln(\\widehat{\\text{IRR}})) = \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} $$\n\n基于正态近似，$\\ln(\\text{IRR})$ 的一个双侧 $(1-\\alpha) \\times 100\\%$ 置信区间构建如下：\n$$ \\ln(\\widehat{\\text{IRR}}) \\pm z_{1-\\alpha/2} \\times \\text{SE}(\\ln(\\widehat{\\text{IRR}})) $$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。对于95%的置信区间，$\\alpha=0.05$，且 $z_{0.975} \\approx 1.96$。\n$\\ln(\\text{IRR})$ 的95%置信区间为：\n$$ \\left( \\ln(\\widehat{\\text{IRR}}) - 1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}}, \\ln(\\widehat{\\text{IRR}}) + 1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right) $$\n为了获得IRR本身的置信区间，我们对 $\\ln(\\text{IRR})$ 区间的下界和上界取指数。IRR的置信区间为：\n$$ \\left( \\widehat{\\text{IRR}} \\cdot \\exp\\left( -1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right), \\widehat{\\text{IRR}} \\cdot \\exp\\left( +1.96 \\sqrt{\\frac{1}{E_1} + \\frac{1}{E_0}} \\right) \\right) $$\n\n现在，我们将这些公式应用于给定的数据：\n暴露组：$E_1 = 54$ 事件， $T_1 = 1200$ 人年 (PY)。\n未暴露组：$E_0 = 32$ 事件， $T_0 = 1500$ 人年 (PY)。\n\n首先，计算发生率：\n$$ \\hat{r}_1 = \\frac{54}{1200} = 0.045 \\text{ 事件/人年} $$\n$$ \\hat{r}_0 = \\frac{32}{1500} \\approx 0.02133 \\text{ 事件/人年} $$\n\n接着，计算IRR的点估计值：\n$$ \\widehat{\\text{IRR}} = \\frac{0.045}{32/1500} = \\frac{54/1200}{32/1500} = \\frac{54 \\times 1500}{1200 \\times 32} = \\frac{81000}{38400} = 2.109375 $$\n\n接着，计算对数IRR的标准误：\n$$ \\text{SE}(\\ln(\\widehat{\\text{IRR}})) = \\sqrt{\\frac{1}{54} + \\frac{1}{32}} = \\sqrt{0.0185185... + 0.03125} = \\sqrt{0.0497685...} \\approx 0.2230976 $$\n\n在对数尺度上计算95%置信区间。首先，求 $\\ln(\\widehat{\\text{IRR}})$：\n$$ \\ln(\\widehat{\\text{IRR}}) = \\ln(2.109375) \\approx 0.746308 $$\n误差范围（ME）为：\n$$ \\text{ME} = 1.96 \\times \\text{SE}(\\ln(\\widehat{\\text{IRR}})) \\approx 1.96 \\times 0.2230976 \\approx 0.437271 $$\n$\\ln(\\text{IRR})$ 的95%置信区间为：\n$$ (0.746308 - 0.437271, 0.746308 + 0.437271) = (0.309037, 1.183579) $$\n\n最后，对边界值取指数以获得IRR的95%置信区间：\n下界：$\\exp(0.309037) \\approx 1.36214$\n上界：$\\exp(1.183579) \\approx 3.26598$\n\n问题要求将IRR和置信区间界限四舍五入到三位有效数字。\nIRR的点估计值：$\\widehat{\\text{IRR}} \\approx 2.11$\nIRR的95%置信区间：$(1.36, 3.27)$\n\n安装了紫外线杀菌装置的诊所中流感样疾病的发生率是未安装该装置诊所的2.11倍。其95%置信区间为(1.36, 3.27)，不包含1.0，这表明在α=0.05的水平上，观察到的关联具有统计学显著性。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.11  1.36  3.27 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在流行病学研究中，一个常见的陷阱是混杂偏倚，它可能导致粗略的分析得出完全错误的结论。这个练习通过一个经典的辛普森悖论案例，展示了混杂因素如何扭曲关联的真实方向。你将通过计算粗略、分层和标准化的率比，亲身体验如何识别和控制混杂，从而得出更准确的科学结论。",
            "id": "4632598",
            "problem": "一项队列研究对两个年龄分层进行为期一年的跟踪，以评估一种预防性暴露是否能降低某种结局的发病率。发病率定义为每单位风险人时的事件数。该研究在每个年龄分层内，分别收集暴露组和非暴露组个体的事件数和人时数，其中风险人时以人年为单位衡量。\n\n数据如下：\n- 分层 $1$ (年长组):\n  - 暴露组：事件数 $= 72$，人时 $= 9000$。\n  - 非暴露组：事件数 $= 10$，人时 $= 1000$。\n- 分层 $2$ (年轻组):\n  - 暴露组：事件数 $= 2$，人时 $= 1000$。\n  - 非暴露组：事件数 $= 27$，人时 $= 9000$。\n\n任务：\n1. 仅使用发病率（事件数除以风险人时）的定义和发病率比（IRR）的定义，计算暴露组和非暴露组的分层特异性发病率，然后计算分层特异性发病率比。\n2. 通过合并各分层的事件数和人时数，计算暴露组和非暴露组的粗发病率，然后计算粗发病率比。\n3. 使用直接标准化法，以合并各分层的人时分布作为标准，计算暴露组和非暴露组的标化发病率，然后计算直接标化发病率比。为此，首先计算合并人群中各分层所占的总人时比例，然后将这些比例作为权重，应用于暴露组和非暴露组相应的分层特异性发病率。\n4. 用 $1$ 到 $3$ 句话简要解释，为何此处粗略结果与分层结果之间会发生逆转，重点关注风险时间分布造成的混杂。\n\n最终答案仅报告直接标化发病率比的小数值，四舍五入至四位有效数字。最终答案中不包括单位。",
            "solution": "用户提供了一个流行病学问题，要求计算和解释粗略、分层特异性和标准化的发病率比。在尝试解决问题之前，需要对问题进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n一项为期一年的队列研究所提供的数据如下：\n- 分层 $1$ (年长组):\n  - 暴露组：事件数 $E_1 = 72$，人时 $PT_E_1 = 9000$ 人年。\n  - 非暴露组：事件数 $U_1 = 10$，人时 $PT_U_1 = 1000$ 人年。\n- 分层 $2$ (年轻组):\n  - 暴露组：事件数 $E_2 = 2$，人时 $PT_E_2 = 1000$ 人年。\n  - 非暴露组：事件数 $U_2 = 27$，人时 $PT_U_2 = 9000$ 人年。\n\n提供的定义：\n- 发病率: $IR = \\frac{\\text{事件数}}{\\text{风险人时}}$。\n- 发病率比: $IRR = \\frac{IR_{\\text{暴露组}}}{IR_{\\text{非暴露组}}}$。\n\n任务：\n1. 计算分层特异性发病率和IRR。\n2. 通过合并数据计算粗发病率和粗IRR。\n3. 使用合并的人时分布作为标准，计算直接标化发病率和标化IRR。\n4. 解释粗略结果与分层结果之间可能发生的逆转。\n\n最终答案应为直接标化IRR，四舍五入至四位有效数字。\n\n#### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题使用了标准的、成熟的流行病学概念（发病率、发病率比、分层、标准化、混杂、辛普森悖论）。这些定义和方法是该领域的基础。设置是科学合理的。\n- **问题适定**：该问题提供了进行所需计算的所有必要数据和定义。任务陈述清晰，可以得出待计算量的唯一数值答案。\n- **客观性**：问题以数值数据和形式化定义呈现，没有主观或模糊的语言。\n- **其他缺陷**：该问题没有违反任何其他验证标准。它不是不完整、矛盾、不切实际或不适定的。数据虽然是为了展示特定现象（混杂）而构建的，但并非不合情理。\n\n#### 步骤3：结论与行动\n问题有效。将提供完整的解决方案。\n\n### 解答\n\n解决方案将通过处理问题陈述中概述的四个任务来进行。设 $IR_{E,i}$ 和 $IR_{U,i}$ 分别表示分层 $i$ 中暴露组和非暴露组的发病率，其中 $i \\in \\{1, 2\\}$。设 $E_i$ 和 $U_i$ 为事件数，$PT_{E,i}$ 和 $PT_{U,i}$ 为人时值。\n\n#### 1. 分层特异性计算\n\n分层特异性发病率 ($IR$) 和发病率比 ($IRR$) 计算如下。\n\n对于分层 $1$ (年长组)：\n- 暴露组发病率：$IR_{E,1} = \\frac{E_1}{PT_{E,1}} = \\frac{72}{9000} = 0.008$ 事件/人年。\n- 非暴露组发病率：$IR_{U,1} = \\frac{U_1}{PT_{U,1}} = \\frac{10}{1000} = 0.010$ 事件/人年。\n- 分层特异性发病率比：$IRR_1 = \\frac{IR_{E,1}}{IR_{U,1}} = \\frac{0.008}{0.010} = 0.8$。\n\n对于分层 $2$ (年轻组)：\n- 暴露组发病率：$IR_{E,2} = \\frac{E_2}{PT_{E,2}} = \\frac{2}{1000} = 0.002$ 事件/人年。\n- 非暴露组发病率：$IR_{U,2} = \\frac{U_2}{PT_{U,2}} = \\frac{27}{9000} = 0.003$ 事件/人年。\n- 分层特异性发病率比：$IRR_2 = \\frac{IR_{E,2}}{IR_{U,2}} = \\frac{0.002}{0.003} = \\frac{2}{3} \\approx 0.667$。\n\n在两个分层中，$IRR$ 都小于 $1$，表明暴露具有保护作用。\n\n#### 2. 粗略计算\n\n为了计算粗率，我们合并两个分层的事件数和人时数。\n- 暴露组总事件数：$E_{total} = E_1 + E_2 = 72 + 2 = 74$。\n- 暴露组总人时：$PT_{E,total} = PT_{E,1} + PT_{E,2} = 9000 + 1000 = 10000$ 人年。\n- 非暴露组总事件数：$U_{total} = U_1 + U_2 = 10 + 27 = 37$。\n- 非暴露组总人时：$PT_{U,total} = PT_{U,1} + PT_{U,2} = 1000 + 9000 = 10000$ 人年。\n\n现在我们计算粗发病率和粗IRR。\n- 暴露组的粗发病率：$IR_{E,crude} = \\frac{E_{total}}{PT_{E,total}} = \\frac{74}{10000} = 0.0074$ 事件/人年。\n- 非暴露组的粗发病率：$IR_{U,crude} = \\frac{U_{total}}{PT_{U,total}} = \\frac{37}{10000} = 0.0037$ 事件/人年。\n- 粗发病率比：$IRR_{crude} = \\frac{IR_{E,crude}}{IR_{U,crude}} = \\frac{0.0074}{0.0037} = 2.0$。\n\n粗 $IRR$ 为 $2.0$，这表明暴露是一个风险因素，与分层特异性结果直接矛盾。这种逆转是辛普森悖论的一个实例，由混杂引起。\n\n#### 3. 标化计算（直接标准化法）\n\n直接标准化需要一个标准人口分布。问题指定使用跨分层的合并人时分布作为标准。首先，我们计算每个分层的总人时和总体的总人时，以找到权重。\n- 分层 $1$ 的总人时：$PT_1 = PT_{E,1} + PT_{U,1} = 9000 + 1000 = 10000$ 人年。\n- 分层 $2$ 的总人时：$PT_2 = PT_{E,2} + PT_{U,2} = 1000 + 9000 = 10000$ 人年。\n- 总体总人时：$PT_{overall} = PT_1 + PT_2 = 10000 + 10000 = 20000$ 人年。\n\n每个分层的权重是总人时的比例。\n- 分层 $1$ 的权重：$w_1 = \\frac{PT_1}{PT_{overall}} = \\frac{10000}{20000} = 0.5$。\n- 分层 $2$ 的权重：$w_2 = \\frac{PT_2}{PT_{overall}} = \\frac{10000}{20000} = 0.5$。\n\n接下来，我们通过将这些权重应用于分层特异性发病率，来计算暴露组 ($SIR_E$) 和非暴露组 ($SIR_U$) 的标化发病率。\n- 暴露组的标化发病率：\n$$SIR_E = w_1 \\times IR_{E,1} + w_2 \\times IR_{E,2} = (0.5 \\times 0.008) + (0.5 \\times 0.002) = 0.004 + 0.001 = 0.005$$\n- 非暴露组的标化发病率：\n$$SIR_U = w_1 \\times IR_{U,1} + w_2 \\times IR_{U,2} = (0.5 \\times 0.010) + (0.5 \\times 0.003) = 0.005 + 0.0015 = 0.0065$$\n\n最后，直接标化发病率比 ($sIRR$) 是这些标化率的比值。\n$$sIRR = \\frac{SIR_E}{SIR_U} = \\frac{0.005}{0.0065} = \\frac{50}{65} = \\frac{10}{13} \\approx 0.7692307...$$\n四舍五入到四位有效数字，直接标化IRR为 $0.7692$。该值小于 $1$，这与在分层特异性分析中观察到的保护作用是一致的。\n\n#### 4. 对逆转的解释\n\n粗 $IRR$ 为 $2.0$（有害）与分层 $IRR$ 为 $0.8$ 和 $0.67$（保护性）之间的逆转，源于年龄分层的混杂作用。粗略分析具有误导性，因为暴露组不成比例地由年长个体组成（年长分层中 $90\\%$ 的人时是暴露的），他们有更高的基线结局发生率；而非暴露组主要由年轻个体组成（年轻分层中 $90\\%$ 的人时是非暴露的），他们有较低的基线率。粗略比较错误地将年长组的较高发病率归因于暴露本身，从而产生了一种虚假的阳性关联。分层和标准化控制了年龄因素，揭示了暴露在各年龄组内的真实保护性质。",
            "answer": "$$\\boxed{0.7692}$$"
        }
    ]
}