{
    "hands_on_practices": [
        {
            "introduction": "这项练习构成了我们实践技能的基石。我们将从一个标准的 $2 \\times 2$ 四格表入手，从头到尾完成所有基本计算：计算样本优势比、理解其对数变换，并构建置信区间以量化其不确定性 。掌握这一过程是将流行病学方法应用于真实数据的第一步。",
            "id": "4616573",
            "problem": "一项前瞻性队列研究调查了二元暴露与二元结局之间的关联。$2\\times 2$ 观测计数表的排列方式为：行表示暴露状态，列表示结局状态，单元格计数 $(a,b,c,d)$ 定义为 $a=$ 暴露且有结局，$b=$ 暴露但无结局，$c=$ 未暴露但有结局，$d=$ 未暴露且无结局。观测计数为 $a=40$，$b=60$，$c=30$，$d=70$。\n\n仅使用二项式抽样的定义以及由中心极限定理（CLT）得出的大样本近似法，完成以下任务：\n- 推导并计算样本优势比 $\\hat{OR}$。\n- 使用自然对数推导并计算 $\\log(\\hat{OR})$。\n- 从优势比自然对数的大样本正态近似出发，并且不使用任何预先记忆的快捷公式，推导出 $\\log(\\hat{OR})$ 的近似标准误，表示为 $a$、$b$、$c$ 和 $d$ 的函数。然后，通过在对数尺度上进行计算并转换回来，用此标准误构建优势比的 Wald $95\\%$ 置信区间（CI）。\n- 建立原假设 $H_0:\\ OR = 1$ 和双侧备择假设 $H_1:\\ OR \\neq 1$。使用 $\\log(OR)$ 的大样本 Wald 框架，计算相应的标准正态 $z$ 统计量。\n\n假设在暴露分层内进行独立的二项式抽样，并从第一性原理出发证明您使用的所有近似方法的合理性。仅将最终报告的 $z$ 统计量四舍五入至四位有效数字。不要对中间计算进行四舍五入。最终答案必须是 $z$ 统计量的单个值。不需要单位。",
            "solution": "评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 研究设计：前瞻性队列研究。\n- 暴露与结局：均为二元。\n- 数据：一个 $2\\times 2$ 列联表，单元格计数如下：\n  - $a$（暴露，有结局）$= 40$\n  - $b$（暴露，无结局）$= 60$\n  - $c$（未暴露，有结局）$= 30$\n  - $d$（未暴露，无结局）$= 70$\n- 假设：在暴露分层（暴露组和未暴露组）内进行独立二项式抽样。将使用基于中心极限定理（CLT）的大样本近似法。\n- 要求任务：\n  1.  推导并计算样本优势比 $\\hat{OR}$。\n  2.  推导并计算样本优势比的自然对数 $\\log(\\hat{OR})$。\n  3.  从第一性原理出发，推导 $\\log(\\hat{OR})$ 的大样本标准误。\n  4.  构建优势比 $OR$ 的 $95\\%$ Wald 置信区间。\n  5.  建立假设 $H_0: OR = 1$ 和 $H_1: OR \\neq 1$。\n  6.  计算假设检验的 Wald $z$ 统计量。\n- 四舍五入：仅将最终的 $z$ 统计量四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是生物统计学和流行病学中的一个标准练习，涉及队列研究背景下的基本概念，如优势比、置信区间和假设检验。所要求的方法（对数优势比尺度上的 Wald 检验）是公认的。\n- **问题适定：** 提供了所有必要的数据（$a, b, c, d$）和假设（二项式抽样、大样本理论）。任务定义清晰，能够导出一个唯一且有意义的解。\n- **客观性：** 问题使用统计学和流行病学中常见的精确、正式的语言陈述，没有主观或含糊的术语。\n- **缺陷检查：** 该问题没有违反任何无效标准。它在科学上是合理的，结构上是正式的，内容是完整的，并且提出了一个需要从基本原理进行推导的非平凡问题。\n\n### 步骤 3：结论与行动\n问题是有效的。将按要求推导解答。\n\n### 解答推导\n\n分析过程将按问题陈述中规定的每项任务进行。\n\n**样本优势比（$\\hat{OR}$）**\n\n在队列研究中，我们比较暴露组出现结局的优势与未暴露组出现结局的优势。\n\n设 $p_1$ 为暴露人群中出现结局的概率，$p_0$ 为未暴露人群中出现结局的概率。暴露组出现结局的优势为 $\\text{Odds}_1 = \\frac{p_1}{1-p_1}$。未暴露组出现结局的优势为 $\\text{Odds}_0 = \\frac{p_0}{1-p_0}$。真实的优势比为 $OR = \\frac{\\text{Odds}_1}{\\text{Odds}_0}$。\n\n概率的样本估计值为 $\\hat{p}_1 = \\frac{a}{a+b}$ 和 $\\hat{p}_0 = \\frac{c}{c+d}$。\n暴露组中优势的样本估计值为 $\\hat{\\text{Odds}}_1 = \\frac{\\hat{p}_1}{1-\\hat{p}_1} = \\frac{a/(a+b)}{b/(a+b)} = \\frac{a}{b}$。\n未暴露组中优势的样本估计值为 $\\hat{\\text{Odds}}_0 = \\frac{\\hat{p}_0}{1-\\hat{p}_0} = \\frac{c/(c+d)}{d/(c+d)} = \\frac{c}{d}$。\n\n样本优势比 $\\hat{OR}$ 是这些样本优势的比率：\n$$ \\hat{OR} = \\frac{\\hat{\\text{Odds}}_1}{\\hat{\\text{Odds}}_0} = \\frac{a/b}{c/d} = \\frac{ad}{bc} $$\n代入给定值：\n$$ \\hat{OR} = \\frac{40 \\times 70}{60 \\times 30} = \\frac{2800}{1800} = \\frac{28}{18} = \\frac{14}{9} $$\n\n**对数样本优势比（$\\log(\\hat{OR})$）**\n\n样本优势比的自然对数是：\n$$ \\log(\\hat{OR}) = \\ln\\left(\\frac{14}{9}\\right) $$\n\n**$\\log(\\hat{OR})$ 的标准误推导**\n\n我们按照要求，使用 Delta 方法从第一性原理推导 $\\log(\\hat{OR})$ 的标准误。$\\log(\\hat{OR})$ 的大样本分布近似为正态分布，这使其适用于构建置信区间和进行假设检验。\n\n我们感兴趣的参数是 $\\log(OR) = \\log\\left(\\frac{p_1/(1-p_1)}{p_0/(1-p_0)}\\right) = \\text{logit}(p_1) - \\text{logit}(p_0)$。其估计量是 $\\log(\\hat{OR}) = \\text{logit}(\\hat{p}_1) - \\text{logit}(\\hat{p}_0)$。\n\n问题假设对两个暴露分层进行独立的二项式抽样。设 $n_1 = a+b$ 和 $n_0 = c+d$。有结局的个体计数 $a$ 和 $c$ 是独立二项随机变量 $A \\sim \\text{Bin}(n_1, p_1)$ 和 $C \\sim \\text{Bin}(n_0, p_0)$ 的实现。相应的样本比例为 $\\hat{p}_1 = A/n_1$ 和 $\\hat{p}_0 = C/n_0$。\n\n由于独立性，样本对数优势比的方差是个别样本 logit 的方差之和：\n$$ \\text{Var}(\\log(\\hat{OR})) = \\text{Var}(\\text{logit}(\\hat{p}_1)) + \\text{Var}(\\text{logit}(\\hat{p}_0)) $$\n我们使用 Delta 方法来寻找 $\\text{Var}(\\text{logit}(\\hat{p}))$ 的近似值。设 $g(p) = \\text{logit}(p) = \\ln\\left(p/(1-p)\\right)$。其导数为 $g'(p) = \\frac{1}{p} + \\frac{1}{1-p} = \\frac{1}{p(1-p)}$。\n\n对于大样本量 $n$，$\\hat{p}$ 的方差是 $\\text{Var}(\\hat{p}) = \\frac{p(1-p)}{n}$。Delta 方法指出 $\\text{Var}(g(\\hat{p})) \\approx [g'(\\mathbb{E}[\\hat{p}])]^2 \\text{Var}(\\hat{p})$。因为 $\\mathbb{E}[\\hat{p}] = p$，我们有：\n$$ \\text{Var}(\\text{logit}(\\hat{p})) \\approx \\left(\\frac{1}{p(1-p)}\\right)^2 \\left(\\frac{p(1-p)}{n}\\right) = \\frac{1}{np(1-p)} $$\n将此结果应用于两个暴露组：\n$$ \\text{Var}(\\log(\\hat{OR})) \\approx \\frac{1}{n_1 p_1 (1-p_1)} + \\frac{1}{n_0 p_0 (1-p_0)} $$\n为了找到标准误，我们通过用样本比例替代真实总体比例来估计该方差：$\\hat{p}_1 = a/n_1$，$1-\\hat{p}_1 = b/n_1$，$\\hat{p}_0 = c/n_0$，$1-\\hat{p}_0 = d/n_0$。\n$$ \\widehat{\\text{Var}}(\\log(\\hat{OR})) = \\frac{1}{n_1 \\hat{p}_1 (1-\\hat{p}_1)} + \\frac{1}{n_0 \\hat{p}_0 (1-\\hat{p}_0)} = \\frac{1}{(a+b)\\left(\\frac{a}{a+b}\\right)\\left(\\frac{b}{a+b}\\right)} + \\frac{1}{(c+d)\\left(\\frac{c}{c+d}\\right)\\left(\\frac{d}{c+d}\\right)} $$\n这可以简化为：\n$$ \\widehat{\\text{Var}}(\\log(\\hat{OR})) = \\frac{a+b}{ab} + \\frac{c+d}{cd} = \\left(\\frac{a}{ab} + \\frac{b}{ab}\\right) + \\left(\\frac{c}{cd} + \\frac{d}{cd}\\right) = \\frac{1}{b} + \\frac{1}{a} + \\frac{1}{d} + \\frac{1}{c} $$\n$\\log(\\hat{OR})$ 的近似标准误（SE）是该估计方差的平方根：\n$$ \\text{SE}(\\log(\\hat{OR})) = \\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}} $$\n这就完成了从第一性原理出发的推导。\n\n**Wald $95\\%$ 置信区间与假设检验**\n\n$\\log(OR)$ 的 $95\\%$ Wald CI 由 $\\log(\\hat{OR}) \\pm z_{0.975} \\times \\text{SE}(\\log(\\hat{OR}))$ 给出，其中 $z_{0.975}$ 是标准正态分布的第 $97.5$ 百分位数，约等于 $1.96$。对该区间的端点取指数，即可得到 $OR$ 的置信区间。\n\n假设检验的公式如下：\n- 原假设 $H_0: OR = 1$，等价于 $H_0: \\log(OR) = 0$。\n- 备择假设 $H_1: OR \\neq 1$，等价于 $H_1: \\log(OR) \\neq 0$。\n\nWald $z$ 统计量定义为估计参数减去其假设的原假设值，再除以其标准误：\n$$ z = \\frac{\\log(\\hat{OR}) - \\log(1)}{\\text{SE}(\\log(\\hat{OR}))} = \\frac{\\log(\\hat{OR})}{\\sqrt{\\frac{1}{a} + \\frac{1}{b} + \\frac{1}{c} + \\frac{1}{d}}} $$\n现在，我们使用给定的单元格计数来计算 $z$ 统计量的数值。\n\n分子：\n$$ \\log(\\hat{OR}) = \\ln\\left(\\frac{14}{9}\\right) $$\n分母（标准误）：\n$$ \\text{SE}(\\log(\\hat{OR})) = \\sqrt{\\frac{1}{40} + \\frac{1}{60} + \\frac{1}{30} + \\frac{1}{70}} $$\n我们为平方根内的分数找到一个公分母。$30$、$40$、$60$ 和 $70$ 的最小公倍数是 $840$。\n$$ \\frac{1}{40} + \\frac{1}{60} + \\frac{1}{30} + \\frac{1}{70} = \\frac{21}{840} + \\frac{14}{840} + \\frac{28}{840} + \\frac{12}{840} = \\frac{21+14+28+12}{840} = \\frac{75}{840} = \\frac{5}{56} $$\n所以，标准误为：\n$$ \\text{SE}(\\log(\\hat{OR})) = \\sqrt{\\frac{5}{56}} $$\n$z$ 统计量为：\n$$ z = \\frac{\\ln(14/9)}{\\sqrt{5/56}} $$\n数值计算：\n$$ \\ln(14/9) \\approx 0.441832798 $$\n$$ \\sqrt{5/56} \\approx \\sqrt{0.089285714} \\approx 0.298807155 $$\n$$ z \\approx \\frac{0.441832798}{0.298807155} \\approx 1.478651 $$\n按照要求四舍五入到四位有效数字，我们得到 $z = 1.479$。",
            "answer": "$$\\boxed{1.479}$$"
        },
        {
            "introduction": "优势比是一种有力的关联性度量，但如果将其直接解读为风险比，尤其是在疾病不罕见的情况下，其数值可能会产生误导。本练习将指导您在给定未暴露人群基线风险的条件下，将优势比（$OR$）转换为风险比（$RR$）。此练习强调了审慎解读的关键性，并揭示了优势比在何种情况下以及为何会显著高估风险比。",
            "id": "4616586",
            "problem": "一项关于非罕见结局的病例对照研究报告称，暴露组与非暴露组相比的优势比 (OR) 为 $OR = 3$。在同一人群中进行的一项队列研究估计，非暴露组的基线风险为 $p_0 = 0.2$。请严格地从风险、优势、优势比 (OR) 和风险比 (RR) 的基本定义出发，推导一个用优势比 $OR$ 和基线风险 $p_0$ 表示风险比 $RR$ 的表达式。然后，将 $OR=3$ 和 $p_0=0.2$ 代入该表达式求值，以获得暴露组相对于非暴露组的相应 $RR$。最后，为了量化在天真地将优势比解释为风险比时可能出现的夸大程度，请计算比值 $OR/RR$，并将这个单一标量作为您的最终数值结果报告。如果您选择对任何中间值进行近似，请确保任何四舍五入的中间量至少保留四位有效数字；然而，如果最终报告的比值可以精确表示，则必须是精确值。",
            "solution": "该问题要求从优势比 ($OR$) 和非暴露人群的基线风险 ($p_0$) 推导出风险比 ($RR$)，然后对给定的特定值进行数值计算。\n\n首先，我们确立基本定义。设 $p_1$ 为暴露组的风险（结局的概率），$p_0$ 为非暴露组的风险。\n\n非暴露组的风险给定为 $p_0$。\n非暴露组结局的优势，$odds_0$，是结局发生的概率与不发生的概率之比：\n$$odds_0 = \\frac{p_0}{1 - p_0}$$\n\n类似地，暴露组的风险为 $p_1$，暴露组结局的优势，$odds_1$，为：\n$$odds_1 = \\frac{p_1}{1 - p_1}$$\n\n优势比 ($OR$) 定义为暴露组的优势与非暴露组的优势之比：\n$$OR = \\frac{odds_1}{odds_0} = \\frac{p_1 / (1 - p_1)}{p_0 / (1 - p_0)}$$\n\n风险比 ($RR$) 定义为暴露组的风险与非暴露组的风险之比：\n$$RR = \\frac{p_1}{p_0}$$\n\n目标是推导一个用 $OR$ 和 $p_0$ 表示 $RR$ 的表达式。为此，我们必须首先用 $OR$ 和 $p_0$ 表示 $p_1$。我们从 $OR$ 的定义开始，求解 $p_1$。\n\n重新整理 $OR$ 方程，以分离出包含 $p_1$ 的项：\n$$\\frac{p_1}{1 - p_1} = OR \\cdot \\frac{p_0}{1 - p_0}$$\n\n为了求解 $p_1$，我们将右侧表示为一个常数 $K$：\n$$K = OR \\cdot \\frac{p_0}{1 - p_0}$$\n于是，我们有：\n$$\\frac{p_1}{1 - p_1} = K$$\n$$p_1 = K(1 - p_1)$$\n$$p_1 = K - K \\cdot p_1$$\n$$p_1 + K \\cdot p_1 = K$$\n$$p_1(1 + K) = K$$\n$$p_1 = \\frac{K}{1 + K}$$\n\n现在，我们将 $K$ 的表达式代回 $p_1$ 的方程中：\n$$p_1 = \\frac{OR \\cdot \\frac{p_0}{1 - p_0}}{1 + OR \\cdot \\frac{p_0}{1 - p_0}}$$\n\n为了简化这个繁分数，我们将分子和分母同乘以 $(1 - p_0)$：\n$$p_1 = \\frac{\\left(OR \\cdot \\frac{p_0}{1 - p_0}\\right) \\cdot (1 - p_0)}{\\left(1 + OR \\cdot \\frac{p_0}{1 - p_0}\\right) \\cdot (1 - p_0)}$$\n$$p_1 = \\frac{OR \\cdot p_0}{(1 - p_0) + OR \\cdot p_0}$$\n\n现在我们有了用 $OR$ 和 $p_0$ 表示的 $p_1$ 的表达式，我们可以使用 $RR$ 的定义 $RR = p_1 / p_0$ 来推导 $RR$ 的表达式：\n$$RR = \\frac{\\frac{OR \\cdot p_0}{(1 - p_0) + OR \\cdot p_0}}{p_0}$$\n$$RR = \\frac{OR \\cdot p_0}{p_0 \\left( (1 - p_0) + OR \\cdot p_0 \\right)}$$\n\n假设 $p_0 \\neq 0$（这是有意义的基线风险和定义 $RR$ 所必需的），我们可以消去分子和分母中的 $p_0$：\n$$RR = \\frac{OR}{(1 - p_0) + OR \\cdot p_0}$$\n这就是所要求的用优势比 $OR$ 和基线风险 $p_0$ 表示风险比 $RR$ 的表达式。\n\n接下来，我们用给定的值来计算这个表达式：$OR = 3$ 和 $p_0 = 0.2$。\n$$RR = \\frac{3}{(1 - 0.2) + (3 \\cdot 0.2)}$$\n$$RR = \\frac{3}{0.8 + 0.6}$$\n$$RR = \\frac{3}{1.4}$$\n将其表示为精确分数：\n$$RR = \\frac{3}{\\frac{14}{10}} = \\frac{3}{\\frac{7}{5}} = 3 \\cdot \\frac{5}{7} = \\frac{15}{7}$$\n\n最后，我们计算比值 $OR/RR$，以量化在这种特定情况下，优势比对风险比的高估程度。\n$$ \\frac{OR}{RR} = \\frac{3}{\\frac{15}{7}} $$\n$$ \\frac{OR}{RR} = 3 \\cdot \\frac{7}{15} $$\n$$ \\frac{OR}{RR} = \\frac{21}{15} $$\n通过将分子和分母同除以它们的最大公约数 $3$ 来简化分数：\n$$ \\frac{OR}{RR} = \\frac{7}{5} $$\n作为小数，其值为：\n$$ \\frac{OR}{RR} = 1.4 $$\n这个值就是最终所要求的结果。",
            "answer": "$$\\boxed{1.4}$$"
        },
        {
            "introduction": "在观察性研究中，暴露与结局之间的关联常常被第三个变量（即混杂因素）所扭曲。本练习介绍了分层这一基本技术来处理混杂问题，我们将使用 Mantel-Haenszel 方法计算调整后的优势比 。通过比较粗略优势比与调整后优势比，您将学会如何识别混杂的存在及其方向，这是从流行病学数据中得出有效结论的一项关键技能。",
            "id": "4616565",
            "problem": "一个病例对照研究调查某项暴露是否与一种疾病相关，并根据一个可能作为混杂因素的二元协变量进行分层。在每个分层中，数据被汇总为一个二乘二的计数表格，记为 $(a,b;c,d)$，其中第一行对应疾病病例，第二行对应非病例，第一列对应暴露组，第二列对应非暴露组。观察到两个分层，其计数 $(a,b;c,d)$ 在分层 $1$ 中为 $(20,30;10,40)$，在分层 $2$ 中为 $(25,35;15,25)$。仅使用比数（odds）的基本定义（即事件发生数与未发生数之比）和优势比（odds ratio）的定义（即两个比数之比），完成以下任务：\n\n- 推导并计算分层 $1$ 和分层 $2$ 的层特异性优势比。\n- 假设真实优势比在各分层间是相同的，推导合适的合并估计量，并计算这些数据的 Mantel–Haenszel (MH) 优势比。\n- 合并各分层，形成一个单一的二乘二表格，并计算粗优势比。\n\n然后，解释在该研究背景下，该协变量是否为混杂因素，说明粗估计值和合并估计值以及层特异性估计值之间的关系如何为你的结论提供信息。将所有数值答案四舍五入至四位有效数字。最终数值答案不带单位。",
            "solution": "该问题提供了一个分层病例对照研究的数据，并要求计算层特异性、合并和粗优势比，然后对混杂进行解释。\n\n### 步骤1：问题验证\n\n在继续之前对问题陈述进行验证。\n**已知条件：**\n- 研究设计：病例对照。\n- 分层：按一个二元协变量。\n- 数据记法：$(a, b; c, d)$，其中第1行=病例，第2行=对照（非病例），第1列=暴露组，第2列=非暴露组。\n- 分层1数据：$(a_1, b_1; c_1, d_1) = (20, 30; 10, 40)$。\n- 分层2数据：$(a_2, b_2; c_2, d_2) = (25, 35; 15, 25)$。\n- 任务：计算层特异性优势比（$OR_1, OR_2$）、Mantel-Haenszel 合并优势比（$OR_{MH}$）和粗优势比（$OR_{crude}$），并解释混杂。\n- 假设：在计算 Mantel-Haenszel 优势比时，各分层间的真实优势比是共同的。\n- 精度：将数值答案四舍五入至四位有效数字。\n\n**验证结论：**\n该问题具有科学依据，提法严谨且客观。它呈现了一个标准的流行病学情景，涉及分层数据的分析，这是研究混杂和效应修饰的核心概念。所有必要的数据和定义都已提供，问题没有矛盾、模糊或事实错误。因此，该问题是**有效的**。\n\n### 步骤2：优势比的推导与计算\n\n**基本定义**\n在病例对照研究中，一个事件（暴露）的优势（odds）是发生该事件的个体数与未发生该事件的个体数之比。\n对于给定的分层 $i$，计数如下：\n- $a_i$：暴露组病例\n- $b_i$：非暴露组病例\n- $c_i$：暴露组对照\n- $d_i$：非暴露组对照\n\n病例中的暴露优势为 $Odds_{cases, i} = \\frac{a_i}{b_i}$。\n对照中的暴露优势为 $Odds_{controls, i} = \\frac{c_i}{d_i}$。\n优势比（$OR$）是这两个优势的比率：\n$$ OR_i = \\frac{Odds_{cases, i}}{Odds_{controls, i}} = \\frac{a_i / b_i}{c_i / d_i} = \\frac{a_i d_i}{b_i c_i} $$\n\n**1. 层特异性优势比（$OR_1$ 和 $OR_2$）**\n\n对每个分层使用上述公式：\n\n对于分层1，数据为 $(20, 30; 10, 40)$：\n$a_1 = 20$, $b_1 = 30$, $c_1 = 10$, $d_1 = 40$。\n分层1的优势比是：\n$$ OR_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{20 \\times 40}{30 \\times 10} = \\frac{800}{300} = \\frac{8}{3} \\approx 2.6666... $$\n四舍五入至四位有效数字，$OR_1 = 2.667$。\n\n对于分层2，数据为 $(25, 35; 15, 25)$：\n$a_2 = 25$, $b_2 = 35$, $c_2 = 15$, $d_2 = 25$。\n分层2的优势比是：\n$$ OR_2 = \\frac{a_2 d_2}{b_2 c_2} = \\frac{25 \\times 25}{35 \\times 15} = \\frac{625}{525} = \\frac{25}{21} \\approx 1.19047... $$\n四舍五入至四位有效数字，$OR_2 = 1.190$。\n\n**2. Mantel-Haenszel (MH) 合并优势比（$OR_{MH}$）**\n\n在各分层间真实优势比相同的假设下，Mantel-Haenszel 估计量提供了一个根据分层变量调整后的合并优势比。它是层特异性优势比的加权平均值。MH 优势比的公式是：\n$$ OR_{MH} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{n_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{n_i}} $$\n其中 $k$ 是分层的数量，$n_i = a_i + b_i + c_i + d_i$ 是分层 $i$ 中的总受试者数。\n\n对于分层1：\n$n_1 = 20 + 30 + 10 + 40 = 100$。\n权重分量为 $\\frac{a_1 d_1}{n_1} = \\frac{20 \\times 40}{100} = 8$ 和 $\\frac{b_1 c_1}{n_1} = \\frac{30 \\times 10}{100} = 3$。\n\n对于分层2：\n$n_2 = 25 + 35 + 15 + 25 = 100$。\n权重分量为 $\\frac{a_2 d_2}{n_2} = \\frac{25 \\times 25}{100} = 6.25$ 和 $\\frac{b_2 c_2}{n_2} = \\frac{35 \\times 15}{100} = 5.25$。\n\n现在，我们计算合并估计量：\n$$ OR_{MH} = \\frac{\\frac{a_1 d_1}{n_1} + \\frac{a_2 d_2}{n_2}}{\\frac{b_1 c_1}{n_1} + \\frac{b_2 c_2}{n_2}} = \\frac{8 + 6.25}{3 + 5.25} = \\frac{14.25}{8.25} = \\frac{19}{11} \\approx 1.72727... $$\n四舍五入至四位有效数字，$OR_{MH} = 1.727$。\n\n**3. 粗优势比（$OR_{crude}$）**\n\n为了计算粗优势比，我们通过将每个单元格的计数相加，把两个分层合并成一个单一的 $2 \\times 2$ 表格。\n- 总暴露病例数：$a_{crude} = a_1 + a_2 = 20 + 25 = 45$。\n- 总非暴露病例数：$b_{crude} = b_1 + b_2 = 30 + 35 = 65$。\n- 总暴露对照数：$c_{crude} = c_1 + c_2 = 10 + 15 = 25$。\n- 总非暴露对照数：$d_{crude} = d_1 + d_2 = 40 + 25 = 65$。\n\n合并后的表格为 $(45, 65; 25, 65)$。粗优势比为：\n$$ OR_{crude} = \\frac{a_{crude} d_{crude}}{b_{crude} c_{crude}} = \\frac{45 \\times 65}{65 \\times 25} = \\frac{45}{25} = \\frac{9}{5} = 1.8 $$\n表示为四位有效数字，$OR_{crude} = 1.800$。\n\n### 步骤3：混杂的解释\n\n解释混杂的关键是将粗关联度量与调整后的（合并的）度量进行比较。如果粗优势比和调整后优势比之间存在有意义的差异，则存在混杂。\n\n- 粗优势比：$OR_{crude} = 1.800$。\n- 调整后 (Mantel-Haenszel) 优势比：$OR_{MH} = 1.727$。\n\n由于 $OR_{crude} \\neq OR_{MH}$，该协变量起到了混杂因素的作用。粗优势比 $1.800$ 是暴露与疾病之间关联的一个有偏估计，因为它未能考虑分层协变量。Mantel-Haenszel 优势比 $1.727$ 是一个控制了这种混杂的调整后估计，并且在共同优势比的假设下，它为真实关联提供了一个更有效的总结。在本例中，混杂是正向的，因为粗优势比略大于调整后优势比，这表明粗分析高估了关联的强度。\n\n混杂因素必须与暴露和结局都有关联。数据支持这一点：\n1.  **与暴露的关联：** 在对照组中，分层1的暴露比例为 $c_1/(c_1+d_1) = 10/50 = 0.2$，而分层2的暴露比例为 $c_2/(c_2+d_2) = 15/40 = 0.375$。由于对照组中的暴露分布在不同分层间不一致，该协变量与暴露相关。\n2.  **与结局的关联：** 比较协变量在病例组与对照组中的分布。在病例组中，处于分层1的比例为 $(a_1+b_1)/(a_{crude}+b_{crude}) = 50/110 \\approx 0.455$。在对照组中，处于分层1的比例为 $(c_1+d_1)/(c_{crude}+d_{crude}) = 50/90 \\approx 0.556$。由于协变量在病例和对照中的分布不同，该协变量与疾病状态相关。\n\n同样值得注意的是，层特异性优势比（$OR_1 = 2.667$ 和 $OR_2 = 1.190$）有显著差异。这表明可能存在效应修饰，即暴露与疾病之间关联的强度在协变量的不同分层中有所不同。虽然问题指示在计算 $OR_{MH}$ 时假设一个共同的优势比，但在实际分析中，这一假设需要进行正式检验（例如，使用 Breslow-Day 检验）。如果效应修饰得到证实，报告层特异性优势比会比报告单一的合并估计值更合适。然而，对于识别混杂这一具体问题，粗估计值（$1.800$）和调整后估计值（$1.727$）之间的差异是决定性的证据。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2.667  1.190  1.727  1.800 \\end{pmatrix} } $$"
        }
    ]
}