## 引言
随着全球公共卫生挑战的不断涌现，疫苗作为预防和控制[传染病](@entry_id:182324)最有效的工具之一，其保护效果的科学评估变得至关重要。新闻报道中频繁出现的“疫苗保护率”百分比，如“95%的效力”，往往是公众理解疫苗价值的第一窗口。然而，这些数字背后蕴含着复杂的流行病学原理、统计方法和因果推断逻辑。简单地接受表面数值，而忽略“效力（efficacy）”与“效果（effectiveness）”的根本区别、评估终点的多样性以及真实世界中的诸多挑战，可能会导致对疫苗公共卫生价值的误解与误判。

本文旨在系统性地梳理疫苗保护效果评估的核心知识体系，为读者构建一个从理论到实践的完整认知框架。我们将通过三个章节，层层深入地探讨这一领域。

在**“原理与机制”**一章中，我们将回归本源，在现代因果推断的框架下严格定义[疫苗效力](@entry_id:194367)与效果，探讨不同的衡量指标，并剖析疫苗保护作用的生物学[机制模型](@entry_id:202454)。随后，在**“应用与跨学科交叉”**一章中，我们将这些理论应用于实践，详细解析从随机对照试验到各类观察性研究（如测试阴性设计、回归断点设计）的具体方法，并展示这些评估如何与[传染病](@entry_id:182324)动力学、公共卫生决策等领域交叉融合。最后，在**“动手实践”**部分，读者将有机会通过解决具体问题，亲手运用所学知识进行定量分析，从而巩固和深化对核心概念的理解。

## 原理与机制

在“导论”章节之后，本章将深入探讨疫苗保护效果评估的核心科学原理与关键机制。我们将从疫苗效力（efficacy）和效果（effectiveness）的基本定义出发，使用潜在结果（potential outcomes）的因果推断框架来严格阐述这些概念。随后，我们将探讨衡量保护效果的不同指标与维度，区分疫苗在预防感染、疾病和重症等不同终点上的作用。我们还将研究疫苗保护作用的两种关键生物学[机制模型](@entry_id:202454)——“全或无”与“渗漏”模型——以及它们在流行病学数据中留下的独特印记。最后，本章将讨论在实际研究中解释这些度量时必须考虑的复杂因素，包括临床试验中的依从性问题、人群中的间接保护（[群体免疫](@entry_id:139442)）效应，以及如何将个体层面的保护效果与群体层面的疾病控制目标联系起来。

### 因果推断框架下的核心定义

在流行病学中，对疫苗保护作用的评估本质上是一个因果推断问题。我们旨在比较“接种疫苗”与“未接种疫苗”这两种干预策略下，疾病发生的风险。为精确定义这一比较，我们引入**[潜在结果框架](@entry_id:636884)**。对于任何一个个体，在时间$t$内，我们定义两个潜在结果：$Y^{1}(t)$表示该个体如果接种了疫苗，到时间$t$是否发生感染（$1$为是，$0$为否）；$Y^{0}(t)$则表示同一个体如果未接种疫苗，到时间$t$是否发生感染。

在此框架下，疫苗保护作用的因果度量可以定义为两种策略下潜在感染风险的对比。**因果风险比**（causal Risk Ratio, $RR_{\text{causal}}$）被定义为：

$RR_{\text{causal}}(t) = \frac{\Pr\{Y^{1}(t)=1\}}{\Pr\{Y^{0}(t)=1\}}$

其中，概率是在一个明确定义的目标人群中计算的。相应地，**疫苗保护率**（Vaccine Efficacy/Effectiveness, VE）被定义为风险的相对下降幅度：

$VE(t) = 1 - RR_{\text{causal}}(t) = 1 - \frac{\Pr\{Y^{1}(t)=1\}}{\Pr\{Y^{0}(t)=1\}}$

虽然这个公式形式上统一，但根据研究环境和目标人群的不同，我们严格区分两个核心概念：**[疫苗效力](@entry_id:194367)（Vaccine Efficacy）**和**疫苗效果（Vaccine Effectiveness）**。

- **[疫苗效力](@entry_id:194367)**（Efficacy）通常指在理想化、严格受控的条件下（如随机对照试验，RCT）测得的疫苗保护率。在RCT中，通过随机分配，接种组和[对照组](@entry_id:188599)在所有已知和未知的基线特征上理论上是可比的（即**[可交换性](@entry_id:263314)**，exchangeability），因此可以直接比较两组的疾病发生率来估计因果效应。RCT的结果具有很高的**内部效度**，能准确反映疫苗在理想依从性和标准接种程序下的生物学保护潜力。

- **疫苗效果**（Effectiveness）则指疫苗在“真实世界”的常规使用条件下所展现的保护率。这通常通过观察性研究（如队列研究或病例对照研究）进行评估。在真实世界中，人们是否接种疫苗是自选择的，可能受到年龄、健康状况、职业暴露风险等多种因素的影响，这些因素本身也与疾病风险相关，构成**混杂**（confounding）。因此，为了估计因果效果，研究者必须通过统计方法（如分层、匹配或[回归模型](@entry_id:163386)）控制这些混杂因素。这依赖于一系列关键假设，包括**条件可交换性**（在控制了可测量的混杂因素后，两组是可比的）、**正定性**（positivity，即在任何混杂因素组合下，都有人接种和未接种疫苗）以及**一致性**（consistency，即个体的实际结果与其接受的干预所对应的[潜在结果](@entry_id:753644)一致）。疫苗效果研究的结果具有更高的**外部效度**，更能反映疫苗在广泛人群中由于储存、运输、接种不规范、人群行为差异等多种因素影响下的综合表现。

### 衡量保护作用：不同尺度与指标

对疫苗保护作用的量化有多种指标，理解它们的区别与联系至关重要。

#### 绝对差异与相对差异

假设在一项为期6个月的疫苗临床试验中，5000名未接种者的[对照组](@entry_id:188599)中有300人感染，而5000名接种者的疫苗组中有90人感染。

- 未接种组的累积风险（也称侵袭率）为 $P_u = \frac{300}{5000} = 0.06$。
- 接种组的累积风险为 $P_v = \frac{90}{5000} = 0.018$。

基于这些数据，我们可以计算：

1.  **绝对风险降低**（Absolute Risk Reduction, ARR）：这是两组风险的直接算术差，反映了疫苗带来的绝对收益。
    $ARR = P_u - P_v = 0.06 - 0.018 = 0.042$。这意味着每接种1000人，可预防42例感染。

2.  **相对风险**（Relative Risk, RR），也称**风险比**：
    $RR = \frac{P_v}{P_u} = \frac{0.018}{0.06} = 0.30$。这表示接种者的感染风险是未接种者的0.3倍。

3.  **相对风险降低**（Relative Risk Reduction, RRR）：这是风险降低的幅度相对于基线风险（未接种组风险）的比例。
    $RRR = \frac{ARR}{P_u} = \frac{P_u - P_v}{P_u} = 1 - \frac{P_v}{P_u} = 1 - RR$

从上述定义可以看出，RRR在数值上与我们定义的疫苗效力（VE）是完[全等](@entry_id:194418)同的。在上述例子中，$VE = 1 - 0.30 = 0.70$，或70%。因此，**[疫苗效力](@entry_id:194367)（VE）本身是一个相对指标**，它告诉我们风险降低的比例，但不直接反映风险的绝对大小。

#### 风险、率和风险率（Hazard）

在随访时间不同的研究中，衡量疾病发生频率的尺度也不同，这会影响VE的计算和解释。

- **累积风险**（Cumulative Risk/Incidence）：在固定随访期内发生疾病的个体比例，是一个无单位的概率，范围在0到1之间。基于风险比计算的VE衡量的是整个随访期内的总体保护效果。

- **发病率**（Incidence Rate）：单位人时（person-time）内发生的新病例数。它衡量的是疾病发生的[瞬时速度](@entry_id:167797)。基于发病率比（Incidence Rate Ratio, IRR）计算的VE反映了平均瞬时风险的降低比例。

- **瞬时[风险率](@entry_id:266388)**（Hazard Rate）：在时间点$t$仍然健康的个体，在下一个极小时间间隔内发生疾病的瞬时速率。基于风险率比（Hazard Ratio, HR）计算的VE衡量的是在任何给定时间点，接种疫苗对个体患病瞬时风险的相对影响。

这三者之间的关系可以通过生存分析的公式联系起来。风险$R(t)$与瞬时[风险率](@entry_id:266388)$h(t)$的关系是 $R(t) = 1 - \exp(-\int_0^t h(u)du)$。在一般情况下，基于这三种不同比值（RR, IRR, HR）计算出的VE数值是不同的。然而，在一个重要的特殊情况下，它们会趋于一致：当研究的疾病在整个随访期内非常**罕见**时（即累积风险很低），此时$R(t) \approx \int_0^t h(u)du$。如果瞬时[风险率](@entry_id:266388)也近似恒定或成比例（即**[比例风险](@entry_id:166780)假定**成立），那么风险比、发病率比和[风险率](@entry_id:266388)比三者在数值上将非常接近。

### 保护作用的谱系：多重终点与分段效应

一种疫苗可能对疾病发展的不同阶段产生不同程度的保护，因此评估其保护作用需要一个更精细的视角。

#### 针对不同临床终点的保护率

评估疫苗保护作用时，必须明确定义所研究的**临床终点**。一种疫苗可能对预防感染、预防有症状的疾病、预防重症（如住院）以及预防死亡表现出不同的效力。在因果推断框架下，每种终点都对应一个独立的VE估算值。例如：
- $VE_{\text{感染}}$：预防任何实验室确认的病原体感染。
- $VE_{\text{症状}}$：预防出现临床症状的感染。
- $VE_{\text{重症}}$：预防发展为需要住院或进入ICU的严重疾病。
- $VE_{\text{死亡}}$：预防因该病原体导致的死亡。

在定义这些估算值时，一个至关重要的原则是：**风险人群必须在研究开始（基线）时就确定，并且不能根据随访期间发生的中间事件（如是否感染）来筛选**。例如，在估计$VE_{\text{重症}}$时，我们比较的是“接种组全体成员”和“未接种组全体成员”在随访期内发生重症的风险，而不是只在那些“已经发生感染”的人群中进行比较。后一种比较（即在感染者中比较重症风险）估计的是疫苗预防**疾病进展**的效力，而前者估计的是疫苗对[个体发生](@entry_id:164036)重症的**总体保护效力**，它综合了疫苗预防感染和预防感染后进展为重症的双重作用。

我们可以通过一个简化的多状态模型来精确阐述这一概念。假设个体可以从“易感”（S）状态转变为“感染”（I）状态，再从“感染”状态转变为“住院”（H）状态。设未接种者从S到I的瞬时[风险率](@entry_id:266388)（hazard）为 $\lambda_{U,S\to I}=0.01$/天，接种者为 $\lambda_{V,S\to I}=0.004$/天。在感染后，未接种者从I到H的瞬时[风险率](@entry_id:266388)为 $\lambda_{U,I\to H}=0.02$/天，接种者为 $\lambda_{V,I\to H}=0.015$/天。

- **疫苗预防易感性的效力**（VE against susceptibility）可以基于$S \to I$的转变率计算：
$VE_{S\to I} = 1 - \frac{\lambda_{V,S\to I}}{\lambda_{U,S\to I}} = 1 - \frac{0.004}{0.01} = 0.60$ 或 $60\%$。

- **疫苗预防严重性的效力**（VE against severity），条件是已经感染，可以基于$I \to H$的转变率计算：
$VE_{I\to H} = 1 - \frac{\lambda_{V,I\to H}}{\lambda_{U,I\to H}} = 1 - \frac{0.015}{0.02} = 0.25$ 或 $25\%$。

这个例子清晰地表明，同一种疫苗可能在降低感染风险（60%）和阻止感染后疾病恶化（25%）方面表现出截然不同的效力。

### 疫苗作用的生物学[机制模型](@entry_id:202454)

为了更深入地理解疫苗如何工作，流行病学家提出了两种简化的[机制模型](@entry_id:202454)：“渗漏”（leaky）模型和“全或无”（all-or-nothing, AON）模型。这些模型虽然是理想化的，但有助于我们理解不同保护机制在人群数据中可能产生的信号。

- **“渗漏”模型**：假设疫苗为每一个接种者都提供了一定程度但不完美的保护。具体来说，每个接种者的感染风险（瞬时[风险率](@entry_id:266388)）都被均匀地降低了一个固定的比例。例如，如果未接种者的感染风险率为 $\lambda$，一个“渗漏”型疫苗会使所有接种者的感染风险率变为 $r\lambda$，其中 $r$ 是一个介于0和1之间的常数（$r$ 越小，保护越好）。

- **“全或无”模型**：假设疫苗对一部分接种者（例如，比例为 $p$）提供了完美的、100%的保护（他们的感染风险率为0），而对剩下的一部分接种者（比例为 $1-p$）则完全没有提供任何保护（他们的感染风险率与未接种者相同，仍为 $\lambda$）。

这两种机制在流行病学数据中会留下不同的“指纹”，特别是在分析保护效果随时间的变化时：

1.  **瞬时风险率比（HR）随时间的变化**：
    -   在“渗漏”模型下，接种组相对于未接种组的HR是恒定的，等于 $r$。
    -   在“全或无”模型下，HR会随时间递减。这是因为在接种组中，随着时间推移，那些未受保护的个体（风险率为 $\lambda$）会逐渐被感染和移除，剩下的人群中受完美保护的个体比例越来越高，导致整个接种组的平均[风险率](@entry_id:266388)下降。HR会从初始值 $1-p$ 逐渐趋近于0。

2.  **基于累积风险的VE随时间的变化**：
    -   在“渗漏”模型下，由于高风险的未接种组和低风险的接种组都在不断发生感染，两组累积风险的差距比例会随着时间延长而缩小。因此，计算出的VE值会随随访时间的延长而**下降**。
    -   在“全或无”模型下，VE值在理论上是恒定的，等于受完美保护的个体比例 $p$。

3.  **突破性感染的发生时间**：
    -   在“渗漏”模型下，由于所有接种者的感染风险都降低了，他们的感染过程被“减速”了。因此，突破性感染的发生[时间平均](@entry_id:267915)会比未接种组的感染时间更晚。
    -   在“全或无”模型下，突破性感染只发生在那部分未受保护的个体中，他们的感染风险与未接种者完全相同。因此，突破性感染的发生时间分布应该与未接种组的感染时间分布相同。

这些理论差异表明，仅仅一个时间点的VE估计值不足以区分这两种机制。需要分析保护效果随时间变化的动态数据。

在真实世界中，疫苗保护力并非永恒。**免疫力减弱**（waning immunity）是一个普遍现象。我们可以利用生存分析模型，如**[Cox比例风险模型](@entry_id:174252)**，来量化这种减弱效应。具体方法是将“自接种以来的时间”（time-since-vaccination）作为一个随时间变化的协变量纳入模型。例如，我们可以创建一组随时间变化的指示变量，来分别估计接种后不同时间窗口（如0-90天，90-180天，$\ge 180$天）内的VE。模型形式如下：
$h(t) = h_0(t)\,\exp\big(\beta_1 Z_1(t) + \beta_2 Z_2(t) + \beta_3 Z_3(t) + \dots \big)$
其中，$h_0(t)$是基线[风险函数](@entry_id:166593)，$Z_i(t)$是一个指示变量，当个体处于接种后的第$i$个时间窗口时取值为1，否则为0。那么，第$i$个时间窗口内的VE就可以通过系数$\beta_i$计算得出：$VE_i = 1 - \exp(\beta_i)$。通过比较不同窗口的$\beta_i$值，我们就可以清晰地看到VE是否随时间减弱。

### 解读研究结果：估算目标、中介因素与群体效应

在将研究结果应用于公共卫生实践时，我们还需考虑一些更深层次的问题。

#### 意向性治疗分析 vs. 符合方案分析

在解读RCT结果时，区分两种不同的分析策略或**估算目标（estimand）**至关重要。

- **意向性治疗分析（Intention-to-Treat, ITT）**：该分析遵循“一次分配，终身组员”的原则。无论参与者是否真正接种了疫苗或遵守了方案，他们都会被保留在最初随机分配的组别中进行分析。ITT分析估计的是“分配接种”这一公共卫生策略本身的效果。其优点是保留了随机化带来的组间可比性，避免了选择偏倚。然而，由于存在不依从行为（如疫苗组的人未接种，或安慰剂组的人在研究外接种），ITT分析估计的VE通常会被“稀释”，即低于疫苗的真实生物学效力。其估算目标为 $VE_{\text{ITT}} = 1 - \frac{\mathbb{E}[Y^{Z=1}]}{\mathbb{E}[Y^{Z=0}]}$，其中 $Y^{Z=z}$ 是个体被分配到 $z$ 组的[潜在结果](@entry_id:753644)。

- **符合方案分析（Per-Protocol, PP）**：该分析试图估计在“完美遵守”研究方案的条件下，疫苗的生物学效力。一种天真的做法是仅比较那些实际接种了疫苗和未接种疫苗的人，但这会破坏随机化并引入严重的偏倚。现代因果推断采用**主分层（principal stratification）**的方法，将目标人群定义为**“依从者”**（compliers）——即那些如果被分配到疫苗组就会接种、如果被分配到安慰剂组就不会接种的个体。PP分析的目标是估计在这一“依从者”亚群中的因果效应。其估算目标为 $VE_{\text{PP}} = 1 - \frac{\mathbb{E}[Y(1) \mid A(1)=1, A(0)=0]}{\mathbb{E}[Y(0) \mid A(1)=1, A(0)=0]}$，其中$A(z)$表示在分配$z$下的实际接种行为，$Y(a)$表示在实际接种$a$下的潜在结局。虽然不依从行为不改变PP的定义，但它使得从观测数据中识别和估计这一效应变得非常困难，通常需要额外的、不可检验的假设。

#### [保护相关物](@entry_id:185961)与中介分析

疫苗通过激发免疫反应来提供保护。识别哪些免疫指标能预测保护效果，对[疫苗研发](@entry_id:191769)和使用至关重要。

- **[保护相关物](@entry_id:185961)（Correlate of Protection, CoP）**：指与疫苗保护水平在统计学上相关的免疫学指标（如抗体滴度）。例如，[抗体滴度](@entry_id:181075)越高，感染风险越低。这种关系不一定是因果关系。

- **替代终点（Surrogate Endpoint）**：是一个更为严格的概念，指一个可以替代临床终点（如感染或死亡）的生物标志物。一个有效的替代终点不仅要能预测临床结果，而且疫苗对临床终点的全部或大部分作用都必须通过这个标志物来实现。这意味着，如果能通过其他方式（如单抗注射）改变这个标志物的水平，也应该能相应地改变临床结果。

为了探究一个免疫指标（如[抗体滴度](@entry_id:181075) $A$）是否是疫苗（$Z$）引起保护（$Y$）的**因果中介**，我们可以使用**因果中介分析**框架。这个框架试图将疫苗的总效应分解为通过该免疫指标起作用的**间接效应**（$Z \to A \to Y$）和不通过该免疫指标的其他路径起作用的**直接效应**。这类分析需要非常强的假设，尤其是需要假设在疫苗分配之后，不存在同时影响免疫指标和疾病结局的未测量混杂因素。

#### 从个体保护到群体影响：间接效应与群体免疫

在[传染病](@entry_id:182324)领域，个体的接种决策会影响他人，这种现象称为**干预溢出效应**或**干预（interference）**。一个人的疫苗接种不仅能直接保护自己，还能通过减少其作为传染源的可能性来间接保护社区中的其他人（**间接效应**）。当足够多的人获得免疫后，病原体在人群中传播变得困难，从而保护了那些未接种或因各种原因无法产生有效免疫的脆弱个体，这就是**群体免疫（herd immunity）**。

因此，在评估疫苗的总体公共卫生价值时，仅考虑其在个体层面的直接保护效力（VE）是不够的。我们需要一个能容纳干预溢出效应的扩展因果框架。在这个框架中，个体的潜在感染结果 $Y_i(z, g)$ 不仅取决于其自身的接种状态 $z$，还取决于其所在社区的疫苗覆盖率 $g$。基于此，我们可以定义：
- **直接效应**：在社区覆盖率 $g$ 固定的情况下，个体接种疫苗带来的风险降低。这对应于我们通常所说的个体VE。
- **间接效应**：对于一个特定接种状态的个体（例如未接种者），社区覆盖率从 $g_1$ 上升到 $g_2$ 所带来的风险变化。
- **总[体效应](@entry_id:261475)**：当社区覆盖率从 $g_1$ 上升到 $g_2$ 时，人群平均风险的变化。

通常情况下，一个具有正向直接保护效力的疫苗，加上正向的间接保护效应（[群体免疫](@entry_id:139442)），会使得提高疫苗覆盖率能够有效降低整个人群的疾病负担。然而，也存在“错位”的可能，例如，如果接种疫苗后人们产生了错误的安全感，采取了更多高风险行为（**风险补偿**），这可能抵消甚至超过疫苗带来的益处，导致在某些情况下，尽管个体VE为正，人群总发病率却并未下降，甚至上升。

最后，个体层面的[疫苗效力](@entry_id:194367)与实现群体免疫目标直接相关。**[群体免疫阈值](@entry_id:184932)**（herd immunity threshold, $h$）指的是，为了阻止疫情在人群中持续传播（即让[有效再生数](@entry_id:164900) $R_e \le 1$），所需达到的最低免疫人群比例。对于一个能完美阻断传播的疫苗，这个阈值仅由病原体的**基本再生数**（$R_0$）决定：

$h = 1 - \frac{1}{R_0}$

然而，大多数疫苗并非完美。如果一个疫苗在预防**传播**方面的效力为 $VE_{\text{transmission}}$（这可能不同于预防感染或疾病的VE），那么为了达到[群体免疫](@entry_id:139442)，所需的**接种覆盖率**会更高：

$h_{\text{coverage}} = \frac{1 - \frac{1}{R_0}}{VE_{\text{transmission}}}$

例如，对于一个$R_0 = 3.2$的病原体，和一个传播保护效力为 $75\%$（即$0.75$）的疫苗，所需的最低接种覆盖率将是 $h_{\text{coverage}} = \frac{1 - 1/3.2}{0.75} \approx 0.9167$，即大约 $91.7\%$ 。这个计算突显了一个关键的公共卫生事实：当面对高传染性病原体和不完美的疫苗时，需要极高的疫苗覆盖率才能控制疫情。