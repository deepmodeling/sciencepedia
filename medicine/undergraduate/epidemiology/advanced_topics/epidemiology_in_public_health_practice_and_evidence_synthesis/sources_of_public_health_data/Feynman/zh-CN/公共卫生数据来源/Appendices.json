{
    "hands_on_practices": [
        {
            "introduction": "公共卫生决策常常依赖于筛查和诊断测试的数据。然而，即使是一个来自高精度测试的阳性结果，也并不总是意味着被检测者患有该疾病，尤其是在低患病率的背景下。这项练习  将引导您使用贝叶斯定理来计算阳性预测值 ($PPV$)，从而对如何解读来自电子实验室报告等来源的测试数据，获得一个至关重要且常常与直觉相悖的理解。",
            "id": "4637084",
            "problem": "一个市级卫生部门通过电子实验室报告（ELR）汇总聚合酶链式反应（PCR）的检测结果、来自一项独立多实验室验证研究的检测性能指标，以及来自一项随机家庭哨点调查的患病率估计值。对无症状家庭的哨点调查估计，社区中该感染的点患病率为 $\\pi = 0.003$。根据该验证研究的报告，全市使用的PCR检测方法其检测层面的灵敏度为 $\\mathrm{Se} = 0.93$，特异性为 $\\mathrm{Sp} = 0.995$。\n\n仅使用灵敏度、特异性、患病率、贝叶斯定理和全概率定律的基本定义，从第一性原理推导出一个在检测结果为阳性的情况下受感染的后验概率（即阳性预测值）的解析表达式，然后计算其在此情境下的数值。假设人口数量足够大，可以将哨点调查的估计值用作社区筛查的先验概率。\n\n将最终数值答案四舍五入至四位有效数字，并以小数形式表示。答案中不要使用百分号。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确且客观。这是一个使用现实参数将贝叶斯概率论应用于诊断测试评估的标准应用。\n\n目标是推导阳性预测值（PPV）的表达式并计算其数值。我们根据提供的信息定义相关事件和概率。\n\n设 $D$ 为个体被感染的事件。\n设 $D^c$ 为个体未被感染的事件。\n设 $T^+$ 为检测结果为阳性的事件。\n设 $T^-$ 为检测结果为阴性的事件。\n\n问题提供了以下量：\n感染的患病率 $\\pi$ 是个体被感染的先验概率。\n$$ P(D) = \\pi = 0.003 $$\n未被感染的概率是其补集：\n$$ P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.003 = 0.997 $$\n检测的灵敏度 $\\mathrm{Se}$ 是在个体被感染的条件下，检测结果为阳性的条件概率。\n$$ \\mathrm{Se} = P(T^+|D) = 0.93 $$\n检测的特异性 $\\mathrm{Sp}$ 是在个体未被感染的条件下，检测结果为阴性的条件概率。\n$$ \\mathrm{Sp} = P(T^-|D^c) = 0.995 $$\n根据特异性的定义，我们可以确定假阳性概率，即在个体未被感染的情况下检测结果为阳性的条件概率。这是特异性的补集。\n$$ P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\mathrm{Sp} = 1 - 0.995 = 0.005 $$\n\n需要推导的量是阳性预测值（PPV），即在检测结果为阳性的条件下个体被感染的后验概率，$P(D|T^+)$。\n\n我们从条件概率的定义开始，这是贝叶斯定理的基础：\n$$ P(D|T^+) = \\frac{P(D \\cap T^+)}{P(T^+)} $$\n分子中的项 $P(D \\cap T^+)$ 是被感染且检测呈阳性的联合概率。它可以使用条件概率的定义表示为：\n$$ P(D \\cap T^+) = P(T^+|D) P(D) $$\n将此代入我们的PPV表达式，得到贝叶斯定理的常见形式：\n$$ P(D|T^+) = \\frac{P(T^+|D) P(D)}{P(T^+)} $$\n\n分母 $P(T^+)$ 是获得阳性检测结果的全概率。这可以使用全概率定律计算，该定律指出，一个事件的概率可以通过将其在一个互斥且穷尽的事件集上的条件概率求和得到。在这里，事件 $D$（感染）和 $D^c$（未感染）构成了这样一个划分。\n$$ P(T^+) = P(T^+ \\cap D) + P(T^+ \\cap D^c) $$\n对每一项再次使用条件概率的定义：\n$$ P(T^+) = P(T^+|D) P(D) + P(T^+|D^c) P(D^c) $$\n\n现在，我们将这个展开的分母形式代回 $P(D|T^+)$ 的表达式中：\n$$ P(D|T^+) = \\frac{P(T^+|D) P(D)}{P(T^+|D) P(D) + P(T^+|D^c) P(D^c)} $$\n\n这就是从第一性原理推导出的阳性预测值的解析表达式。我们现在可以用给定的参数 $\\pi$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 来表示它。\n$$ \\mathrm{PPV} = P(D|T^+) = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp}) \\cdot (1 - \\pi)} $$\n\n接下来，我们将给定的量代入此表达式中以计算数值。\n已知：\n$\\pi = 0.003$\n$\\mathrm{Se} = 0.93$\n$\\mathrm{Sp} = 0.995$\n\n首先，计算分子的值：\n$$ \\mathrm{Numerator} = \\mathrm{Se} \\cdot \\pi = 0.93 \\cdot 0.003 = 0.00279 $$\n\n接下来，计算分母的值。第一项与分子相同。第二项是：\n$$ (1 - \\mathrm{Sp}) \\cdot (1 - \\pi) = (1 - 0.995) \\cdot (1 - 0.003) = 0.005 \\cdot 0.997 = 0.004985 $$\n分母是这两项的和：\n$$ \\mathrm{Denominator} = 0.00279 + 0.004985 = 0.007775 $$\n\n最后，我们计算 PPV：\n$$ \\mathrm{PPV} = \\frac{0.00279}{0.007775} \\approx 0.3588424437... $$\n\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $3$、$5$、$8$ 和 $8$。第五位有效数字是 $4$，所以我们向下舍入。\n$$ \\mathrm{PPV} \\approx 0.3588 $$\n这个结果表明，对于从该社区中选出并收到阳性PCR检测结果的个体，他们真正被感染的概率约为 $35.88\\%$。尽管检测具有高准确性（高灵敏度和高特异性），但相对较低的PPV是低患病率环境中的一个典型结果。",
            "answer": "$$\n\\boxed{0.3588}\n$$"
        },
        {
            "introduction": "在现实世界中，没有哪个单一的公共卫生数据源是完美的；每个数据源都有其自身因信息收集方式而产生的偏倚。这个高级练习  模拟了一个常见的现实挑战：使用来自登记系统、调查和保险理赔的数据来估计一个健康指标（如疫苗覆盖率）。通过对每个来源的独特偏倚——例如错分偏倚和选择偏倚——进行建模，您将亲眼看到为什么不同来源会产生不同的估计值，并学会量化这种差异。",
            "id": "4637066",
            "problem": "一个司法管辖区正在评估一项免疫计划，并希望了解三种公共卫生数据来源——全州疫苗登记系统、家庭调查和健康保险理赔——如何对疫苗覆盖率产生不同的估计值。设目标人群的真实疫苗接种覆盖率为 $\\pi$，定义为真实接种疫苗的个体比例。每个数据源都因不完美的确认和错误分类而引入偏见。使用以下情景，并根据敏感性、特异性和选择的基本定义，推导出每个来源的预期观测覆盖率。\n\n假设真实覆盖率为 $\\pi = 0.76$。对于登记系统，将敏感性 $Se_{r}$ 定义为真实接种者在登记系统中显示为已接种的概率，将特异性 $Sp_{r}$ 定义为真实未接种者在登记系统中显示为未接种的概率。假设 $Se_{r} = 0.93$ 且 $Sp_{r} = 0.99$。\n\n对于调查，设已接种者以概率 $q_{v}$ 响应，未接种者以概率 $q_{u}$ 响应。在响应者中，自我报告过程的敏感性为 $Se_{s}$，特异性为 $Sp_{s}$。假设 $q_{v} = 0.60$，$q_{u} = 0.45$，$Se_{s} = 0.90$ 且 $Sp_{s} = 0.95$。使用条件概率推导出响应者中的预期疫苗接种率，然后推导出当响应者中存在自我报告错误分类时，调查所报告的预期观测覆盖率。\n\n对于理赔数据，考虑一个相对于真实疫苗接种状态具有敏感性 $Se_{c}$ 和特异性 $Sp_{c}$ 的分类过程。假设 $Se_{c} = 0.88$ 且 $Sp_{c} = 0.85$。\n\n使用基本定义（不使用快捷公式），计算每个来源的预期观测覆盖率，即该来源将一个个体分类为已接种的概率。然后，将跨来源的差异度量定义为\n$$\nD = \\max\\{\\,|\\hat{\\pi}_{i} - \\hat{\\pi}_{j}| : i \\neq j,\\; i,j \\in \\{r,s,c\\}\\,\\},\n$$\n其中 $\\hat{\\pi}_{r}$、$\\hat{\\pi}_{s}$ 和 $\\hat{\\pi}_{c}$ 分别是来自登记系统、调查和理赔数据的预期观测覆盖率。\n\n使用上述参数值计算 $D$。将最终结果表示为小数比例，并四舍五入到四位有效数字。",
            "solution": "该问题被评估为有效，因为它在科学上基于流行病学原理，问题提出得当、客观且内部一致。\n\n设 $V$ 为一个个体真实接种了疫苗的事件，$V^c$ 为他们未接种疫苗的事件。给定的真实疫苗接种覆盖率为 $P(V) = \\pi = 0.76$。因此，未接种疫苗个体的比例为 $P(V^c) = 1 - \\pi = 1 - 0.76 = 0.24$。\n\n我们将从基本原理出发，为三个数据来源——登记系统、调查和理赔——分别推导预期观测覆盖率。预期观测覆盖率是数据来源将一个随机选择的个体分类为已接种的概率。\n\n**1. 登记系统覆盖率 ($\\hat{\\pi}_{r}$)**\n\n设 $R_V$ 为登记系统将一个个体分类为已接种的事件。登记系统的预期观测覆盖率 $\\hat{\\pi}_{r}$ 即为 $P(R_V)$。我们使用全概率定律，以真实疫苗接种状态为条件：\n$$\n\\hat{\\pi}_{r} = P(R_V) = P(R_V|V)P(V) + P(R_V|V^c)P(V^c)\n$$\n根据定义，登记系统的敏感性为 $Se_{r} = P(R_V|V) = 0.93$。\n特异性为 $Sp_{r} = P(R_V^c|V^c) = 0.99$，其中 $R_V^c$ 是被分类为未接种的事件。假阳性概率为 $P(R_V|V^c) = 1 - P(R_V^c|V^c) = 1 - Sp_{r} = 1 - 0.99 = 0.01$。\n\n将这些值代入公式：\n$$\n\\hat{\\pi}_{r} = (Se_{r} \\times \\pi) + ((1 - Sp_{r}) \\times (1 - \\pi))\n$$\n$$\n\\hat{\\pi}_{r} = (0.93 \\times 0.76) + (0.01 \\times 0.24) = 0.7068 + 0.0024 = 0.7092\n$$\n\n**2. 调查覆盖率 ($\\hat{\\pi}_{s}$)**\n\n调查覆盖率是调查响应者中的观测接种率。设 $Resp$ 为一个个体响应调查的事件。调查的观测覆盖率 $\\hat{\\pi}_{s}$ 是一个响应者通过自我报告被分类为已接种的条件概率，记为 $P(S_V|Resp)$。\n\n首先，我们必须刻画响应者群体的特征。已接种和未接种个体的响应概率不同，这会引入选择偏倚。设 $q_v = P(Resp|V) = 0.60$ 且 $q_u = P(Resp|V^c) = 0.45$。总响应概率可使用全概率定律计算：\n$$\nP(Resp) = P(Resp|V)P(V) + P(Resp|V^c)P(V^c)\n$$\n$$\nP(Resp) = (q_v \\times \\pi) + (q_u \\times (1 - \\pi)) = (0.60 \\times 0.76) + (0.45 \\times 0.24) = 0.456 + 0.108 = 0.564\n$$\n现在，我们使用 Bayes 定理计算*响应者中*的真实疫苗接种率 $P(V|Resp)$：\n$$\nP(V|Resp) = \\frac{P(Resp|V)P(V)}{P(Resp)} = \\frac{q_v \\pi}{P(Resp)} = \\frac{0.456}{0.564}\n$$\n响应者中未接种个体的比例为：\n$$\nP(V^c|Resp) = \\frac{P(Resp|V^c)P(V^c)}{P(Resp)} = \\frac{q_u (1-\\pi)}{P(Resp)} = \\frac{0.108}{0.564}\n$$\n响应者群体内的自我报告过程存在错误分类，其敏感性为 $Se_s = P(S_V|V, Resp) = 0.90$，特异性为 $Sp_s = P(S_V^c|V^c, Resp) = 0.95$。\n调查中的观测覆盖率 $\\hat{\\pi}_{s} = P(S_V|Resp)$，可通过在响应者的条件空间上使用全概率定律计算得出：\n$$\n\\hat{\\pi}_{s} = P(S_V|V, Resp)P(V|Resp) + P(S_V|V^c, Resp)P(V^c|Resp)\n$$\n我们有 $P(S_V|V^c, Resp) = 1 - Sp_s = 1 - 0.95 = 0.05$。\n$$\n\\hat{\\pi}_{s} = (Se_s \\times P(V|Resp)) + ((1 - Sp_s) \\times P(V^c|Resp))\n$$\n$$\n\\hat{\\pi}_{s} = \\left(0.90 \\times \\frac{0.456}{0.564}\\right) + \\left(0.05 \\times \\frac{0.108}{0.564}\\right) = \\frac{0.90 \\times 0.456 + 0.05 \\times 0.108}{0.564}\n$$\n$$\n\\hat{\\pi}_{s} = \\frac{0.4104 + 0.0054}{0.564} = \\frac{0.4158}{0.564} \\approx 0.73723404\n$$\n\n**3. 理赔数据覆盖率 ($\\hat{\\pi}_{c}$)**\n\n设 $C_V$ 为理赔数据将一个个体分类为已接种的事件。理赔数据预期观测覆盖率 $\\hat{\\pi}_{c}$ 的计算与登记系统的计算类似：\n$$\n\\hat{\\pi}_{c} = P(C_V) = P(C_V|V)P(V) + P(C_V|V^c)P(V^c)\n$$\n敏感性为 $Se_{c} = P(C_V|V) = 0.88$，特异性为 $Sp_{c} = P(C_V^c|V^c) = 0.85$。\n假阳性概率为 $1 - Sp_{c} = 1 - 0.85 = 0.15$。\n$$\n\\hat{\\pi}_{c} = (Se_{c} \\times \\pi) + ((1 - Sp_{c}) \\times (1 - \\pi))\n$$\n$$\n\\hat{\\pi}_{c} = (0.88 \\times 0.76) + (0.15 \\times 0.24) = 0.6688 + 0.0360 = 0.7048\n$$\n\n**4. 差异度量 ($D$)**\n\n我们得到了三个预期观测覆盖率：\n*   登记系统：$\\hat{\\pi}_{r} = 0.7092$\n*   调查：$\\hat{\\pi}_{s} \\approx 0.737234$\n*   理赔：$\\hat{\\pi}_{c} = 0.7048$\n\n差异度量 $D$ 是两两绝对差中的最大值：\n$$\nD = \\max\\{\\,|\\hat{\\pi}_{r} - \\hat{\\pi}_{s}|,\\; |\\hat{\\pi}_{r} - \\hat{\\pi}_{c}|,\\; |\\hat{\\pi}_{s} - \\hat{\\pi}_{c}|\\,\\}\n$$\n这些差值为：\n$$\n|\\hat{\\pi}_{r} - \\hat{\\pi}_{s}| = |0.7092 - 0.737234...| = |-0.028034...| \\approx 0.028034\n$$\n$$\n|\\hat{\\pi}_{r} - \\hat{\\pi}_{c}| = |0.7092 - 0.7048| = 0.0044\n$$\n$$\n|\\hat{\\pi}_{s} - \\hat{\\pi}_{c}| = |0.737234... - 0.7048| = 0.032434...\n$$\n这些值中的最大值为 $D \\approx 0.032434...$。\n\n将最终结果四舍五入到四位有效数字，我们得到 $0.03243$。",
            "answer": "$$ \\boxed{0.03243} $$"
        }
    ]
}