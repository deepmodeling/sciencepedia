{
    "hands_on_practices": [
        {
            "introduction": "公共卫生监测系统，特别是综合征监测系统，旨在及早发现潜在的疫情。然而，并非每个警报都代表真实的疫情爆发。本练习将引导你计算一个关键指标——阳性预测值 (PPV)，即在收到警报时，疫情真实发生的概率。通过这个计算，你将亲身体会到，即使一个系统具有很高的灵敏度和特异度，当监测的事件（如疫情）非常罕见时，其警报的可靠性也可能出人意料地低 ()。",
            "id": "4565209",
            "problem": "一个地区卫生部门运营着三个互补的公共卫生监测系统：临床医生的被动报告、现场调查员的主动病例发现，以及一个基于急诊科主诉来标记可能疫情爆发日的症状监测算法。将该症状监测算法视为潜在状态“某天存在疫情爆发”的二元分类器。设流行率 $p$ 表示在随机选择的一天中确实存在疫情爆发的概率 $P(D)$，灵敏度 $\\text{Se}$ 表示 $P(T^{+}\\,|\\,D)$，特异度 $\\text{Sp}$ 表示 $P(T^{-}\\,|\\,\\neg D)$，其中 $T^{+}$ 表示警报，$D$ 表示存在疫情爆发。阳性预测值 (PPV) 定义为 $P(D\\,|\\,T^{+})$。\n\n仅从灵敏度、特异度、流行率、条件概率、全概率定律和贝叶斯定理的核心定义出发，推导出一个用 $p$、$\\text{Se}$ 和 $\\text{Sp}$ 表示 PPV 的表达式。然后，在一个监测季节中，真实的每日疫情爆发流行率为 $p=0.005$，症状监测算法的灵敏度为 $\\text{Se}=0.9$，特异度为 $\\text{Sp}=0.95$，计算 PPV。简要解释基础率 $p$ 如何限制了针对罕见事件的警报的实际效用，以及被动、主动与症状监测设计如何通过改变 $p$、$\\text{Se}$ 或 $\\text{Sp}$ 来减轻或加剧这一限制。\n\n将最终的 PPV 表示为小数，并将答案四舍五入到 $4$ 位有效数字。",
            "solution": "该问题要求推导阳性预测值 (PPV) 的表达式，并针对特定情景进行计算，然后结合公共卫生监测的背景对结果进行解释。\n\n首先，我们验证该问题。\n**步骤 1：提取已知条件**\n- 疫情爆发的流行率：$p = P(D)$\n- 症状监测算法的灵敏度：$\\text{Se} = P(T^{+}\\,|\\,D)$\n- 症状监测算法的特异度：$\\text{Sp} = P(T^{-}\\,|\\,\\neg D)$\n- 阳性预测值 (PPV)：PPV $= P(D\\,|\\,T^{+})$\n- $D$：存在疫情爆发的事件。\n- $T^{+}$：算法标记警报的事件。\n- $T^{-}$：算法未标记警报的事件。\n- $\\neg D$：不存在疫情爆发的事件。\n- 用于计算的数值：$p = 0.005$, $\\text{Se} = 0.9$, $\\text{Sp} = 0.95$。\n- 推导必须从条件概率、全概率定律和贝叶斯定理的核心定义开始。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于流行病学和贝叶斯概率的原理。问题提取得当，为推导和计算提供了唯一解所需的所有必要信息。语言客观，术语标准。所提供的数值对于监测罕见健康事件的症状监测系统是现实的。该问题是概率论在真实世界科学领域的一个标准的、不平凡的应用。\n\n**步骤 3：结论与行动**\n问题有效。我们将继续进行解答。\n\n**第 1 部分：PPV 的推导**\n\n阳性预测值 (PPV) 定义为在监测系统标记警报的情况下，疫情爆发真实存在的概率。使用条件概率的定义，这可以写成：\n$$\n\\text{PPV} = P(D\\,|\\,T^{+}) = \\frac{P(D \\cap T^{+})}{P(T^{+})}\n$$\n这是贝叶斯定理的基本结构。我们现在必须用给定的量来表示分子和分母：流行率 ($p$)、灵敏度 ($\\text{Se}$) 和特异度 ($\\text{Sp}$)。\n\n分子 $P(D \\cap T^{+})$ 是疫情爆发存在且警报被标记的联合概率。我们可以使用灵敏度的条件概率定义重新表达它，$\\text{Se} = P(T^{+}\\,|\\,D) = \\frac{P(D \\cap T^{+})}{P(D)}$。整理后得到：\n$$\nP(D \\cap T^{+}) = P(T^{+}\\,|\\,D) P(D) = \\text{Se} \\cdot p\n$$\n这一项代表真阳性结果的概率。\n\n分母 $P(T^{+})$ 是系统在任意一天标记警报的总概率。为了找到这个概率，我们使用全概率定律，通过疫情爆发存在 ($D$) 或不存在 ($\\neg D$) 来划分样本空间：\n$$\nP(T^{+}) = P(T^{+}\\,|\\,D)P(D) + P(T^{+}\\,|\\,\\neg D)P(\\neg D)\n$$\n我们从分子推导中得到了这个和的第一部分的表达式：$P(T^{+}\\,|\\,D)P(D) = \\text{Se} \\cdot p$。\n\n对于和的第二部分，我们需要找到 $P(T^{+}\\,|\\,\\neg D)$ 和 $P(\\neg D)$。\n不存在疫情爆发的概率 $P(\\neg D)$ 是流行率 $p$ 的补集：\n$$\nP(\\neg D) = 1 - P(D) = 1 - p\n$$\n概率 $P(T^{+}\\,|\\,\\neg D)$ 是在没有疫情爆发的情况下出现警报的概率，也就是假阳性率。我们已知特异度 $\\text{Sp} = P(T^{-}\\,|\\,\\neg D)$，即在没有疫情爆发的情况下不出现警报的概率。由于警报要么被标记 ($T^{+}$) 要么不被标记 ($T^{-}$)，对于条件 $\\neg D$，这两个是互补事件。因此：\n$$\nP(T^{+}\\,|\\,\\neg D) = 1 - P(T^{-}\\,|\\,\\neg D) = 1 - \\text{Sp}\n$$\n将这些代入全概率定律的表达式中，我们得到警报的总概率：\n$$\nP(T^{+}) = (\\text{Se} \\cdot p) + (1 - \\text{Sp})(1 - p)\n$$\n第一项对应真阳性，第二项对应假阳性。\n\n最后，我们将推导出的分子和分母的表达式代回 PPV 公式中：\n$$\n\\text{PPV} = \\frac{P(D \\cap T^{+})}{P(T^{+})} = \\frac{\\text{Se} \\cdot p}{(\\text{Se} \\cdot p) + (1 - \\text{Sp})(1 - p)}\n$$\n这就是我们想要的用 $p$、$\\text{Se}$ 和 $\\text{Sp}$ 表示的 PPV 表达式。\n\n**第 2 部分：PPV 的计算**\n\n我们已知数值 $p = 0.005$、$\\text{Se} = 0.9$ 和 $\\text{Sp} = 0.95$。\n我们将这些值代入推导出的公式中：\n$$\n\\text{PPV} = \\frac{(0.9)(0.005)}{(0.9)(0.005) + (1 - 0.95)(1 - 0.005)}\n$$\n首先，我们计算各个组成部分：\n- 分子（真阳性率）：$(0.9)(0.005) = 0.0045$\n- 假阳性率：$1 - \\text{Sp} = 1 - 0.95 = 0.05$\n- 无疫情爆发的概率：$1 - p = 1 - 0.005 = 0.995$\n- 分母（假阳性率项）：$(0.05)(0.995) = 0.04975$\n\n现在，我们计算完整的​​分数：\n$$\n\\text{PPV} = \\frac{0.0045}{0.0045 + 0.04975} = \\frac{0.0045}{0.05425}\n$$\n$$\n\\text{PPV} \\approx 0.08294930875...\n$$\n四舍五入到 4 位有效数字，我们得到 $0.08295$。\n\n**第 3 部分：解释**\n\n计算出的 PPV 约为 $0.083$，这意味着即使对于一个具有高灵敏度 ($90\\%$) 和高特异度 ($95\\%$) 的系统，也只有大约 $8.3\\%$ 的警报对应于真实的疫情爆发。其余的 $91.7\\%$ 是假警报。这个低 PPV 是事件的低流行率或称基础率 ($p=0.005$) 的直接后果。PPV 公式的分母是真阳性 ($0.0045$) 和假阳性 ($0.04975$) 的总和。在这种情况下，假阳性的数量大约是真阳性数量的 $11$ 倍。这种大量非事件产生的假警报比少量事件产生的真信号还要多的现象，被称为基础率谬误。它严重限制了针对罕见事件的警报的实际效用，因为频繁的假警报可能导致“警报疲劳”，使得公共卫生官员可能开始忽略它们，从而破坏了系统的目的。\n\n不同的监测设计通过以下方式与此限制相互作用：\n- **症状监测**，如此处建模的，极易受到低基础率问题的影响。其优势在于最大化早期检测的及时性和灵敏度 ($\\text{Se}$)，但这通常以不完美的特异度 ($\\text{Sp}$) 为代价。当将 $\\text{Sp}$ 应用于大量的无疫情日（由 $1-p$ 决定）时，会产生绝对数量巨大的假阳性，从而压低了 PPV。\n- **被动监测** 通常灵敏度 ($\\text{Se}$) 很低，因为它依赖于自愿报告，但通常特异度 ($\\text{Sp}$) 很高，因为报告通常基于临床怀疑或诊断。虽然它也会受到基础率限制的影响，但其主要限制往往是完全错过疫情爆发（低 $\\text{Se}$）。\n- **主动监测** 在减轻此限制方面最有效，但也是资源最密集的。它通过主动寻找病例直接提高灵敏度 ($\\text{Se}$)。此外，如果它针对高风险人群，可以有效提高被监测样本中的流行率 ($p$)。提高 $\\text{Se}$ 和提高 $p$ 都能直接改善 PPV，使警报更加可靠。",
            "answer": "$$\\boxed{0.08295}$$"
        },
        {
            "introduction": "监测系统使用的病例定义或筛查算法并非完美，这意味着它们会产生假阳性和假阴性结果。因此，系统报告的“表观患病率”往往与人群中的“真实患病率”存在偏差。本练习将向你展示如何利用已知的灵敏度 ($Se$) 和特异度 ($Sp$)，通过公式来校正这种由错分导致的系统性偏倚，从而更准确地估算真实患病率 ()。",
            "id": "4624743",
            "problem": "一个区域性公共卫生监测系统通过一个电子症状筛查算法来应用标准化的病例定义。设 $p$ 表示被监测人群中的真实疾病患病率，$\\hat{p}$ 表示监测系统观察到的表观患病率（即被算法归类为病例的比例）。在目标人群和时间段内，该病例定义的灵敏度 $Se = 0.70$ 和特异度 $Sp = 0.98$ 保持恒定。在最近的一份周报中，基于一个概率样本，表观患病率为 $\\hat{p} = 0.08$，且错分被假定为非差异性的。\n\n从灵敏度和特异度的基本定义以及全概率定律出发，用 $p$、$Se$ 和 $Sp$ 表示 $\\hat{p}$，然后用 $\\hat{p}$、$Se$ 和 $Sp$ 代数求解 $p$。使用给定的数值，计算真实患病率的偏差校正估计值。将最终答案表示为小数比例，并四舍五入到四位有效数字。",
            "solution": "该问题经过严格的验证过程，被认为是有效的。它在既定的流行病学原理上有科学依据，问题提出得当，具有唯一且有意义的解，并以客观、明确的语言表述。所有必要的数据都已提供，并且没有内部矛盾。\n\n任务是基于表观患病率 $\\hat{p}$ 以及测试的灵敏度 $Se$ 和特异度 $Sp$ 来推导真实患病率 $p$ 的表达式。\n\n设 $D$ 表示个体确实患有该疾病的事件，$\\bar{D}$ 表示他们没有患病的事件。设 $T$ 表示监测算法将个体归类为病例（阳性测试）的事件，$\\bar{T}$ 表示阴性分类的事件。\n\n根据问题陈述，我们有以下概率术语的定义：\n真实患病率是患病的概率：$p = P(D)$。\n表观患病率是测试结果为阳性的概率：$\\hat{p} = P(T)$。\n灵敏度是在患病条件下测试结果为阳性的概率：$Se = P(T|D)$。\n特异度是在未患病条件下测试结果为阴性的概率：$Sp = P(\\bar{T}|\\bar{D})$。\n\n未患病的概率是 $P(\\bar{D}) = 1 - P(D) = 1 - p$。\n假阳性的概率是在未患病条件下测试结果为阳性的概率，即 $P(T|\\bar{D})$。由于对于给定的疾病状态只有两种测试结果（阳性或阴性），我们有 $P(T|\\bar{D}) + P(\\bar{T}|\\bar{D}) = 1$。因此，假阳性率是 $P(T|\\bar{D}) = 1 - Sp$。\n\n第一步是用 $p$、$Se$ 和 $Sp$ 表示表观患病率 $\\hat{p}$。我们可以使用全概率定律，以真实疾病状态（$D$ 或 $\\bar{D}$）为条件：\n$$ \\hat{p} = P(T) = P(T|D)P(D) + P(T|\\bar{D})P(\\bar{D}) $$\n将上述定义的术语代入此方程，我们得到：\n$$ \\hat{p} = (Se)(p) + (1 - Sp)(1 - p) $$\n这个表达式将表观患病率与真实患病率和测试特性联系起来。这完成了问题的第一部分。\n\n第二步是代数求解该方程以得到真实患病率 $p$。\n首先，我们展开方程的右边：\n$$ \\hat{p} = p \\cdot Se + 1 - Sp - p + p \\cdot Sp $$\n接下来，我们合并包含 $p$ 的项：\n$$ \\hat{p} = p(Se - 1 + Sp) + (1 - Sp) $$\n重新整理以分離含有 $p$ 的项：\n$$ \\hat{p} - (1 - Sp) = p(Se + Sp - 1) $$\n$$ \\hat{p} + Sp - 1 = p(Se + Sp - 1) $$\n只要 $Se + Sp - 1 \\neq 0$，我们就可以通过除法来求解 $p$：\n$$ p = \\frac{\\hat{p} + Sp - 1}{Se + Sp - 1} $$\n这个公式提供了真实患病率的偏差校正估计值。\n\n最后一步是使用给定的数据计算 $p$ 的数值：\n表观患病率，$\\hat{p} = 0.08$。\n灵敏度，$Se = 0.70$。\n特异度，$Sp = 0.98$。\n\n将这些值代入推导出的公式中：\n$$ p = \\frac{0.08 + 0.98 - 1}{0.70 + 0.98 - 1} $$\n首先，我们计算分子：\n$$ 0.08 + 0.98 - 1 = 1.06 - 1 = 0.06 $$\n接下来，我们计算分母。必须检查条件 $Se + Sp - 1 \\neq 0$。\n$$ 0.70 + 0.98 - 1 = 1.68 - 1 = 0.68 $$\n由于分母不为零，因此存在唯一解。\n现在，我们计算 $p$ 的值：\n$$ p = \\frac{0.06}{0.68} = \\frac{6}{68} = \\frac{3}{34} $$\n为了将其表示为小数比例，我们进行除法运算：\n$$ p \\approx 0.088235294... $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $8$、$8$、$2$ 和 $3$。第五位有效数字是 $5$，所以我们将第四位数字 ($3$) 向上舍入为 $4$。\n真实患病率的最终偏差校正估计值为 $0.08824$。",
            "answer": "$$\\boxed{0.08824}$$"
        },
        {
            "introduction": "任何单一的公共卫生监测系统都无法捕获所有病例，总会存在漏报。当有多个独立的监测数据源时，我们可以利用它们之间的重叠信息来估算未被任何系统发现的病例数。本练习将介绍“捕获-再捕获”方法，这是一种经典的统计技术，通过分析来自两个不同系统（如被动报告和主动调查）的数据，来估算疾病暴发期间的总病例数 ()。",
            "id": "4565224",
            "problem": "一个都市卫生部门正在整合来自两个不同监测系统的数据，以估计在一个固定观察窗口内一种新型流感样疾病的总发病数。来源 $A$ 是一个被动监测系统（医疗服务提供者报告），来源 $B$ 是一个主动监测系统（实地调查）。在同一时期，来源 $A$ 记录了 $n_{A}=120$ 例病例，来源 $B$ 记录了 $n_{B}=150$ 例病例，通过交叉比对发现有 $n_{AB}=60$ 例病例同时出现在两个来源中。\n\n假设在此区间内种群是封闭的，病例状态在此期间不发生改变，并且两个来源独立地发现病例，且对于所有病例，捕获概率均相等。从发现概率和独立性的核心定义出发，推导出该时期内种群总病例数 $N$ 的双源捕获-再捕获估计量，然后应用一种广泛接受的小样本偏差校正方法以获得最终的点估计值。使用偏差校正后估计量对应的方差表达式，计算估计的总病例数 $N$ 及其方差。\n\n以“病例”为单位表示估计的总病例数，以“病例的平方”为单位表示方差。将点估计值和方差均四舍五入到四位有效数字。提供您的最终数值结果。",
            "solution": "首先对问题进行验证。\n\n### 步骤1：提取已知信息\n问题陈述中提供的数据和条件如下：\n-   来源A记录的病例数：$n_{A}=120$\n-   来源B记录的病例数：$n_{B}=150$\n-   来源A和来源B共同记录的病例数：$n_{AB}=60$\n-   假设1：在观察期内，种群是封闭的（没有进入、退出或病例状态的改变）。\n-   假设2：来源A和B独立地发现病例。\n-   假设3：所有病例被任一给定来源捕获的概率均相等。\n-   任务1：推导总病例数 $N$ 的双源捕获-再捕获估计量。\n-   任务2：对该估计量应用小样本偏差校正。\n-   任务3：计算 $N$ 的数值点估计值以及该估计的方差。\n-   任务4：将点估计值及其方差均四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知信息进行验证\n根据验证标准对问题进行评估。\n-   **科学基础**：该问题描述了捕获-再捕获模型的一个经典应用，特别是 Lincoln-Petersen 方法，这是一种在流行病学和生态学中用于估计种群大小的成熟统计技术。要求使用偏差校正形式（Chapman 估计量）及其相应的方差是标准的统计实践。其基本假设（封闭种群、独立性、等捕获概率）是该模型的标准理想条件。该问题牢固地植根于统计学和流行病学原理。\n-   **适定性**：所有必要的数值数据（$n_A$、$n_B$、$n_{AB}$）均已提供。目标陈述清晰：推导估计量，应用特定的修正（偏差校正），并计算最终的点估计值及其方差。该问题是自洽的，并能得出一个唯一的、稳定的解。\n-   **客观性**：问题使用精确、定量和无偏见的语言进行陈述。没有主观或基于观点的内容。\n\n该问题没有表现出验证清单中列出的任何缺陷。它在科学上是合理的，结构上是正式的，内容是完整的，逻辑上是一致的，并且是可行的。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将提供完整的解答。\n\n### 解答推导与计算\n\n设 $N$ 为种群中真实的总发病数。设 $p_A$ 和 $p_B$ 分别为单个病例被来源A和来源B发现的概率。\n\n基于所有病例捕获概率相等的假设，我们可以根据观测到的计数来估计这些概率：\n$$ \\hat{p}_A = \\frac{n_A}{N} $$\n$$ \\hat{p}_B = \\frac{n_B}{N} $$\n\n问题陈述两个来源是独立的。因此，一个病例被两个来源同时捕获的概率 $p_{AB}$ 是各自概率的乘积：\n$$ p_{AB} = p_A p_B $$\n\n我们也可以直接从数据中估计 $p_{AB}$，即被两个系统都捕获的病例占总病例的比例：\n$$ \\hat{p}_{AB} = \\frac{n_{AB}}{N} $$\n\n通过代入估计的概率 $\\hat{p}_A$ 和 $\\hat{p}_B$，将 $p_{AB}$ 的表达式等同起来：\n$$ \\hat{p}_{AB} \\approx \\hat{p}_A \\hat{p}_B $$\n$$ \\frac{n_{AB}}{N} \\approx \\left(\\frac{n_A}{N}\\right) \\left(\\frac{n_B}{N}\\right) = \\frac{n_A n_B}{N^2} $$\n\n解这个关于 $N$ 的关系式，得到基本的捕获-再捕获估计量，也称为 Lincoln-Petersen 估计量，它是 $N$ 的最大似然估计：\n$$ N \\cdot n_{AB} \\approx n_A n_B $$\n$$ \\hat{N}_{LP} = \\frac{n_A n_B}{n_{AB}} $$\n\n已知该估计量是有偏的，尤其是在小样本情况下。问题要求应用小样本偏差校正。一个被广泛接受的修正是 Chapman 估计量，记为 $\\hat{N}_C$，如果 $(n_A + n_B) \\ge N$，它几乎是无偏的。其公式为：\n$$ \\hat{N}_C = \\frac{(n_A+1)(n_B+1)}{(n_{AB}+1)} - 1 $$\n\n我们现在将给定值 $n_A = 120$，$n_B = 150$ 和 $n_{AB} = 60$ 代入 Chapman 估计量公式，以求出总病例数 $N$ 的点估计值。\n$$ \\hat{N}_C = \\frac{(120+1)(150+1)}{(60+1)} - 1 $$\n$$ \\hat{N}_C = \\frac{(121)(151)}{61} - 1 $$\n$$ \\hat{N}_C = \\frac{18271}{61} - 1 $$\n$$ \\hat{N}_C \\approx 299.52459 - 1 = 298.52459 $$\n\n将此值四舍五入到四位有效数字，我们得到估计的总病例数为 $298.5$ 例。\n\n接下来，我们计算这个偏差校正后估计量的方差。Chapman 估计量的方差 $\\text{Var}(\\hat{N}_C)$ 由 Seber 提出的公式给出：\n$$ \\text{Var}(\\hat{N}_C) \\approx \\frac{(n_A+1)(n_B+1)(n_A-n_{AB})(n_B-n_{AB})}{(n_{AB}+1)^2(n_{AB}+2)} $$\n\n我们将给定值代入此表达式：\n-   $n_A+1 = 121$\n-   $n_B+1 = 151$\n-   $n_A-n_{AB} = 120 - 60 = 60$\n-   $n_B-n_{AB} = 150 - 60 = 90$\n-   $n_{AB}+1 = 61$\n-   $n_{AB}+2 = 62$\n\n$$ \\text{Var}(\\hat{N}_C) \\approx \\frac{(121)(151)(60)(90)}{(61)^2(62)} $$\n$$ \\text{Var}(\\hat{N}_C) \\approx \\frac{(18271)(5400)}{(3721)(62)} $$\n$$ \\text{Var}(\\hat{N}_C) \\approx \\frac{98663400}{230702} $$\n$$ \\text{Var}(\\hat{N}_C) \\approx 427.6655... $$\n\n将此值四舍五入到四位有效数字，我们得到方差为 $427.7$ 病例的平方。\n\n最终结果是估计总数为 298.5 例，方差为 427.7 病例的平方。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n298.5  427.7\n\\end{pmatrix}\n}\n$$"
        }
    ]
}