{
    "hands_on_practices": [
        {
            "introduction": "监测数据通常来自哨点网络等来源，而这些来源往往不能完全代表整个人群。本练习将演示一种基本方法，用于调整原始病例数，以解释不同人群亚组之间监测覆盖率的差异。通过这项动手计算 ，您将学会量化简单计算所引入的偏倚，并得出更准确的疾病发病率估计值。",
            "id": "4592233",
            "problem": "一个区域性的急性呼吸道感染（ARI）哨点医生网络报告了为期 $12$ 周、按年龄分层的新发病例数。由于该网络不具有完全代表性，参与的医疗服务提供者的比例因年龄组而异。假设在每个年龄组内，由参与的医疗服务提供者诊治的患者中ARI的风险与由未参与的提供者诊治的患者中的风险相同，并且发病率定义为该时期内的新发病例数除以风险人群数。\n\n三个年龄组的数据如下：\n- $0$–$17$ 岁：观察到的病例数 $80$ 例，医疗服务提供者参与比例 $0.25$，人口数 $52{,}000$。\n- $18$–$64$ 岁：观察到的病例数 $220$ 例，医疗服务提供者参与比例 $0.10$，人口数 $130{,}000$。\n- $\\geq 65$ 岁：观察到的病例数 $100$ 例，医疗服务提供者参与比例 $0.40$，人口数 $26{,}000$。\n\n使用基本原理：\n1. 通过观察到的病例数和参与比例推断每个年龄组在总人口中的总病例数，并相对于总人口跨年龄组进行汇总，估算这 $12$ 周内每 $100{,}000$ 人中经覆盖率调整的加权发病率。\n2. 通过将观察到的哨点病例数跨年龄组汇总并除以总人口数，计算每 $100{,}000$ 人的朴素粗发病率，忽略参与比例的差异。\n3. 设 $R$ 为朴素粗发病率与经覆盖率调整的加权发病率之比。以无单位小数形式报告 $R$。\n\n所有发病率均以每 $100{,}000$ 人表示。将最终比率 $R$ 四舍五入至四位有效数字。仅提供 $R$ 的值作为最终答案。",
            "solution": "该问题要求根据哨点监测数据计算两种类型的发病率及其比率。首先，经确认该问题在科学上是合理的、良构的且客观的。所提供的数据是充分且一致的。\n\n设三个年龄组由 $i=1, 2, 3$ 索引，分别对应 $0$–$17$ 岁、$18$–$64$ 岁和 $\\geq 65$ 岁。每个组的提供数据如下：\n- 观察到的病例数：$C_{obs,i}$\n- 医疗服务提供者参与比例：$f_i$\n- 人口规模：$N_i$\n\n具体数值为：\n- 对于 $i=1$：$C_{obs,1}=80$, $f_1=0.25$, $N_1=52000$。\n- 对于 $i=2$：$C_{obs,2}=220$, $f_2=0.10$, $N_2=130000$。\n- 对于 $i=3$：$C_{obs,3}=100$, $f_3=0.40$, $N_3=26000$。\n\n问题陈述，发病率定义为在为期 $12$ 周的时期内新发病例数除以风险人群数。还假设在每个年龄组内，急性呼吸道感染（ARI）的风险是均质的，无论患者是由参与的还是未参与的医疗服务提供者诊治。这个假设允许我们通过用参与比例的倒数来缩放观察到的病例数，来估计每个年龄组的总病例数 $C_{total,i}$：\n$$C_{total,i} = \\frac{C_{obs,i}}{f_i}$$\n\n该问题要求按顺序进行三项计算。\n\n1.  **经覆盖率调整的加权发病率 ($I_{adj}$)**\n    该发病率基于整个人口的估计总病例数，并针对哨点网络的不完全覆盖进行了调整。\n    人口中的估计总病例数是各年龄组估计病例数的总和：\n    $$C_{total} = \\sum_{i=1}^{3} C_{total,i} = \\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}$$\n    风险总人口是各年龄组人口的总和：\n    $$N_{total} = \\sum_{i=1}^{3} N_i$$\n    因此，每 $100{,}000$ 人的经覆盖率调整的发病率为：\n    $$I_{adj} = \\left( \\frac{C_{total}}{N_{total}} \\right) \\times 100000 = \\left( \\frac{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000$$\n\n2.  **朴素粗发病率 ($I_{naive}$)**\n    该发病率仅使用观察到的病例数计算，未对覆盖率进行调整。\n    观察到的总病例数是：\n    $$C_{obs,total} = \\sum_{i=1}^{3} C_{obs,i}$$\n    每 $100{,}000$ 人的朴素粗发病率为：\n    $$I_{naive} = \\left( \\frac{C_{obs,total}}{N_{total}} \\right) \\times 100000 = \\left( \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000$$\n\n3.  **比率 $R$**\n    比率 $R$ 定义为朴素粗发病率除以经覆盖率调整的加权发病率。\n    $$R = \\frac{I_{naive}}{I_{adj}} = \\frac{\\left( \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000}{\\left( \\frac{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}}{\\sum_{i=1}^{3} N_i} \\right) \\times 100000}$$\n    总人口项 ($N_{total} = \\sum N_i$) 和缩放因子 $100000$ 被消去，将 $R$ 的表达式简化为观察到的总病例数与估计的总病例数之比：\n    $$R = \\frac{\\sum_{i=1}^{3} C_{obs,i}}{\\sum_{i=1}^{3} \\frac{C_{obs,i}}{f_i}} = \\frac{C_{obs,total}}{C_{total}}$$\n\n现在，我们将数值代入 $R$ 的表达式中。\n首先，计算分子，即观察到的总病例数：\n$$C_{obs,total} = 80 + 220 + 100 = 400$$\n接下来，计算分母，即估计的总病例数：\n$$C_{total} = \\frac{80}{0.25} + \\frac{220}{0.10} + \\frac{100}{0.40}$$\n$$C_{total} = 320 + 2200 + 250 = 2770$$\n现在，我们可以计算比率 $R$：\n$$R = \\frac{400}{2770} = \\frac{40}{277}$$\n作为小数，该值为：\n$$R \\approx 0.14440433213...$$\n问题要求将最终答案四舍五入到四位有效数字。第五位有效数字是 $0$，所以我们向下取整。\n$$R \\approx 0.1444$$\n$R$ 的值远小于 $1$ 表明，忽略监测覆盖率的朴素发病率严重低估了通过覆盖率调整方法估计的真实人群发病率。这主要是由于最大的人口群体（$18$–$64$ 岁）的参与比例非常低（$f_2=0.10$）。",
            "answer": "$$\\boxed{0.1444}$$"
        },
        {
            "introduction": "灵敏度是任何监测系统的关键属性，但通过验证性研究对其进行的测量总是一个带有统计不确定性的估计值。本练习介绍了一种严谨的方法，通过计算比例的精确置信区间来量化这种不确定性。通过解决这个问题 ，您将应用 Clopper-Pearson 方法来理解系统真实灵敏度的合理范围，这是解释评估结果时的一项关键技能。",
            "id": "4592234",
            "problem": "一个公共卫生机构正在评估其公共卫生监测 (PHS) 系统用于检测侵袭性脑膜炎球菌病的灵敏度。在一项验证研究中，使用独立的金标准建立了一个经实验室确认的真实病例队列。假设每个真实病例被 PHS 系统检测到的概率 $p$ 是相同且独立的，这与伯努利过程一致。灵敏度定义为真实病例被检测到的概率，在此模型下等于 $p$。令 $X$ 表示在 $n$ 个金标准真实病例中检测到的病例数，因此 $X \\sim \\mathrm{Binomial}(n,p)$。\n\n在一个辖区，该验证确定了 $n = 60$ 个金标准真实病例，PHS 系统检测到了其中的 $X = 60$ 个。使用通过反转精确二项检验（等尾）得到的二项比例的精确双侧 Clopper–Pearson $95\\%$ 置信区间 (CI)，计算灵敏度 $p$ 的精确双侧 CI，并从第一性原理出发，解释为什么该 CI 在覆盖率方面被认为是保守的。然后，仅报告此精确 Clopper-Pearson $95\\%$ CI for $p$ 的下限，以小数形式表示。将报告的数字四舍五入到四位有效数字。在最终报告的值中不要使用百分号。",
            "solution": "该问题要求在 $n=60$ 次试验中观察到 $X=60$ 次成功的条件下，计算二项比例 $p$ 的精确双侧 $95\\%$ Clopper-Pearson 置信区间的下限。同时，它还要求解释为什么该置信区间被认为是保守的。\n\n首先，我们对问题陈述进行验证。\n已知条件如下：\n- 真实病例数为 $n=60$。\n- 检测到的病例数为 $X=60$。\n- 检测数量的统计模型为 $X \\sim \\mathrm{Binomial}(n,p)$，其中 $p$ 是监测系统的灵敏度。\n- 期望的置信水平为 $1-\\alpha = 0.95$，这意味着 $\\alpha = 0.05$。\n- 使用的方法是精确双侧 Clopper-Pearson 置信区间。\n该问题具有科学依据，使用了流行病学中的标准统计方法。问题提法清晰，为获得唯一解提供了所有必要信息。语言客观而精确。该问题是有效的。\n\n我们现在开始求解。二项比例 $p$ 的 Clopper-Pearson 置信区间 $[p_L, p_U]$ 是通过反转两个单侧、等尾的精确二项检验来构建的。设在 $n$ 次试验中观察到的成功次数为 $x$。置信水平为 $1-\\alpha$。\n\n下限 $p_L$ 定义为使得观察到 $x$ 次或更多次成功的概率等于 $\\alpha/2$ 的 $p$ 值。这是以下方程的解：\n$$ \\mathrm{P}(Y \\ge x | Y \\sim \\mathrm{Binomial}(n, p_L)) = \\sum_{k=x}^{n} \\binom{n}{k} p_L^k (1-p_L)^{n-k} = \\frac{\\alpha}{2} $$\n\n上限 $p_U$ 定义为使得观察到 $x$ 次或更少次成功的概率等于 $\\alpha/2$ 的 $p$ 值。这是以下方程的解：\n$$ \\mathrm{P}(Y \\le x | Y \\sim \\mathrm{Binomial}(n, p_U)) = \\sum_{k=0}^{x} \\binom{n}{k} p_U^k (1-p_U)^{n-k} = \\frac{\\alpha}{2} $$\n\n在此问题中，我们有 $n=60$，$x=60$ 且 $1-\\alpha=0.95$，所以 $\\alpha/2 = 0.025$。\n\n题目要求我们计算置信区间的下限。我们使用 $x=60$ 的 $p_L$ 公式：\n$$ \\sum_{k=60}^{60} \\binom{60}{k} p_L^k (1-p_L)^{60-k} = 0.025 $$\n该求和只有一项，即 $k=60$：\n$$ \\binom{60}{60} p_L^{60} (1-p_L)^{60-60} = 0.025 $$\n因为 $\\binom{60}{60}=1$ 且 $(1-p_L)^0=1$，方程简化为：\n$$ p_L^{60} = 0.025 $$\n求解 $p_L$，我们得到：\n$$ p_L = (0.025)^{\\frac{1}{60}} $$\n我们可以计算这个值：\n$$ p_L = \\exp\\left(\\frac{1}{60} \\ln(0.025)\\right) \\approx \\exp\\left(\\frac{-3.688879}{60}\\right) \\approx \\exp(-0.061481) \\approx 0.940360 $$\n四舍五入到四位有效数字，下限为 $0.9404$。\n\n为完整起见，我们考虑上限 $p_U$。方程为：\n$$ \\sum_{k=0}^{60} \\binom{60}{k} p_U^k (1-p_U)^{60-k} = 0.025 $$\n左边的和是 $\\mathrm{Binomial}(60, p_U)$ 分布所有概率的总和，它总是等于 $1$。方程 $1=0.025$ 对于 $p_U \\in [0,1)$ 没有解。按照惯例，在 $x=n$ 的极端情况下，置信区间的上限设为 $p_U = 1$。因此，完整的 $95\\%$ CI 是 $[(0.025)^{1/60}, 1]$。\n\n接下来，我们解释为什么 Clopper-Pearson 区间被认为是保守的。在这种情况下，“保守”一词意味着区间的实际覆盖概率（即区间包含真实参数 $p$ 的长期频率）对于所有可能的 $p$ 值都保证至少为名义水平 $1-\\alpha$。对于许多 $p$ 值，实际覆盖率严格大于 $1-\\alpha$。\n\n这种保守性是二项分布离散性的直接结果。置信区间的构建是基于反转假设检验。如果一个观测值 $x$ 不在分布的尾部，那么它就被包含在给定 $p_0$ 的检验的接受域中。对于显著性水平为 $\\alpha$ 的双侧检验，我们理想中希望定义尾部，使得 $\\mathrm{P}(X \\le k_{lower} | p_0) = \\alpha/2$ 且 $\\mathrm{P}(X \\ge k_{upper} | p_0) = \\alpha/2$。然而，由于像二项分布这样的离散分布的累积分布函数 (CDF) 是一个阶梯函数（它以离散的跳跃方式增加），通常不可能找到整数 $k_{lower}$ 和 $k_{upper}$ 使这些等式精确成立。\n\n为确保第一类错误率不超过 $\\alpha$，必须定义拒绝域，使得 $\\mathrm{P}(\\text{reject } H_0 | p_0) \\le \\alpha$。对于通过 Clopper-Pearson 方法反转的双侧检验，这意味着下尾概率必须至多为 $\\alpha/2$，上尾概率也必须至多为 $\\alpha/2$。当这些检验被反转以形成置信区间时，保证区间包含真实参数 $p$ 的条件得以满足的概率，对于大多数 $p$ 值来说，是严格大于 $1-\\alpha$ 的。\n\n用形式化的术语来说，真实参数 $p$ 的覆盖概率是 $\\mathrm{P}(p \\in [p_L(X), p_U(X)])$。根据 Clopper-Pearson 区间的构造，这等于 $\\mathrm{P}(\\mathrm{P}(Y \\le X | p) \\ge \\alpha/2 \\text{ 且 } \\mathrm{P}(Y \\ge X | p) \\ge \\alpha/2)$，其中 $Y \\sim \\mathrm{Binomial}(n, p)$。由于离散性，实际概率 $\\mathrm{P}(Y \\le X | p)$ 和 $\\mathrm{P}(Y \\ge X | p)$ 很少能精确地等于 $\\alpha/2$。对所有可能的结果 $x$ 求和，区间覆盖 $p$ 的总概率随 $p$ 的函数而波动，但它从不低于名义水平 $1-\\alpha$。这种覆盖率总是大于或等于名义水平的特性，就是保守区间的定义。\n\n问题要求提供下限的数值，四舍五入到四位有效数字。\n$$ p_L = (0.025)^{1/60} \\approx 0.940360 $$\n四舍五入到四位有效数字得到 $0.9404$。",
            "answer": "$$ \\boxed{0.9404} $$"
        },
        {
            "introduction": "为了加强病例发现，现代监测系统常常整合来自多个独立数据流的数据。本练习探讨了这种设计的系统层面后果，重点关注其中涉及的权衡。通过计算在增加一个新的数据流后，阳性预测值 ($PPV$) 和假警报率的变化 ，您将深入理解在提升发现能力与增加虚假信号风险之间的基本平衡。",
            "id": "4592268",
            "problem": "一个公共卫生部门运行着一个自动化的传染病监测系统，当满足某个决策规则时，该系统会发出警报。现有主数据流在当前决策阈值下，识别感染病例的灵敏度为 $Se_{1}$，识别非感染病例的特异度为 $Sp_{1}$。该系统部署在感染患病率为 $\\pi$ 的人群中。该部门考虑增加一个独立的辅助数据流，其特点是低灵敏度和高特异度，灵敏度为 $Se_{2}$，特异度为 $Sp_{2}$。增加后，决策阈值保持不变，如果两个数据流中至少有一个标记为阳性，组合系统就会发出警报。假设在给定感染状况（感染与未感染）的情况下，这两个数据流是条件独立的。使用以下参数：$Se_{1} = 0.85$，$Sp_{1} = 0.95$，$Se_{2} = 0.30$，$Sp_{2} = 0.99$ 以及 $\\pi = 0.01$。使用基本定义，计算阳性预测值（PPV）的变化量与假警报率变化量之比 $\\rho$，其中假警报率定义为在没有感染的情况下发出警报的概率。具体而言，令 $\\Delta PPV = PPV_{\\text{after}} - PPV_{\\text{before}}$ 和 $\\Delta FAR = FAR_{\\text{after}} - FAR_{\\text{before}}$，并定义 $\\rho = \\frac{\\Delta PPV}{\\Delta FAR}$。请用小数表示你的答案，并将最终答案四舍五入到四位有效数字。",
            "solution": "该问题经评估具有科学依据、问题明确、客观且内部一致。这是评估诊断或监测系统中的一个标准问题。我将提供完整的解题过程。\n\n令 $I$ 表示个体被感染的事件，$I^c$ 表示个体未被感染的事件。感染的患病率给定为 $\\pi = P(I) = 0.01$。因此，$P(I^c) = 1 - \\pi = 1 - 0.01 = 0.99$。\n\n令 $T_1$ 表示主数据流将病例标记为阳性的事件，$T_2$ 表示辅助数据流将病例标记为阳性的事件。假设在给定真实感染状况的情况下，测试结果是条件独立的。\n\n基本定义如下：\n- 灵敏度 ($Se$): $P(\\text{测试阳性} | I)$\n- 特异度 ($Sp$): $P(\\text{测试阴性} | I^c)$\n- 阳性预测值 ($PPV$): $P(I | \\text{测试阳性})$\n- 假警报率 ($FAR$): $P(\\text{测试阳性} | I^c)$。注意，$FAR = 1 - P(\\text{测试阴性} | I^c) = 1 - Sp$。\n\n给定的参数是：\n- 主数据流: $Se_1 = 0.85$, $Sp_1 = 0.95$\n- 辅助数据流: $Se_2 = 0.30$, $Sp_2 = 0.99$\n\n**1. 添加辅助数据流之前的系统分析（仅主数据流）**\n\n“之前”的系统仅包含主数据流。令阳性测试的总概率为 $P(T_1)$。\n之前的假警报率，$FAR_{\\text{before}}$，是在没有感染的情况下，数据流1给出阳性测试的概率：\n$$FAR_{\\text{before}} = P(T_1 | I^c) = 1 - Sp_1$$\n代入给定的 $Sp_1$ 值：\n$$FAR_{\\text{before}} = 1 - 0.95 = 0.05$$\n\n之前的阳性预测值，$PPV_{\\text{before}}$，使用贝叶斯定理计算：\n$$PPV_{\\text{before}} = P(I | T_1) = \\frac{P(T_1 | I) P(I)}{P(T_1)}$$\n分母 $P(T_1)$ 使用全概率定律计算：\n$$P(T_1) = P(T_1 | I) P(I) + P(T_1 | I^c) P(I^c)$$\n$$P(T_1) = Se_1 \\pi + (1 - Sp_1)(1 - \\pi)$$\n代入数值：\n$$P(T_1) = (0.85)(0.01) + (1 - 0.95)(1 - 0.01) = 0.0085 + (0.05)(0.99) = 0.0085 + 0.0495 = 0.058$$\n现在，我们可以计算 $PPV_{\\text{before}}$：\n$$PPV_{\\text{before}} = \\frac{Se_1 \\pi}{P(T_1)} = \\frac{(0.85)(0.01)}{0.058} = \\frac{0.0085}{0.058}$$\n\n**2. 添加辅助数据流之后的系统分析（组合系统）**\n\n如果至少一个数据流为阳性，组合系统就会发出警报。令此事件为 $T_{\\text{comb}} = T_1 \\cup T_2$。我们需要求出这个组合测试的灵敏度（$Se_{\\text{comb}}$）和特异度（$Sp_{\\text{comb}}$）。\n\n组合系统的灵敏度为：\n$$Se_{\\text{comb}} = P(T_1 \\cup T_2 | I) = 1 - P((T_1 \\cup T_2)^c | I) = 1 - P(T_1^c \\cap T_2^c | I)$$\n利用条件独立性，$P(T_1^c \\cap T_2^c | I) = P(T_1^c | I) P(T_2^c | I)$。\n我们知道 $P(T_1^c | I) = 1 - P(T_1 | I) = 1 - Se_1$，类似地，$P(T_2^c | I) = 1 - Se_2$。\n$$Se_{\\text{comb}} = 1 - (1 - Se_1)(1 - Se_2)$$\n代入数值：\n$$Se_{\\text{comb}} = 1 - (1 - 0.85)(1 - 0.30) = 1 - (0.15)(0.70) = 1 - 0.105 = 0.895$$\n\n组合系统的特异度为：\n$$Sp_{\\text{comb}} = P((T_1 \\cup T_2)^c | I^c) = P(T_1^c \\cap T_2^c | I^c)$$\n利用条件独立性，$P(T_1^c \\cap T_2^c | I^c) = P(T_1^c | I^c) P(T_2^c | I^c)$。\n我们知道 $P(T_1^c | I^c) = Sp_1$ 并且 $P(T_2^c | I^c) = Sp_2$。\n$$Sp_{\\text{comb}} = Sp_1 Sp_2$$\n代入数值：\n$$Sp_{\\text{comb}} = (0.95)(0.99) = 0.9405$$\n\n现在，我们计算组合系统的假警报率和阳性预测值。\n之后的假警报率，$FAR_{\\text{after}}$，为：\n$$FAR_{\\text{after}} = P(T_{\\text{comb}} | I^c) = 1 - Sp_{\\text{comb}} = 1 - 0.9405 = 0.0595$$\n\n之后的阳性预测值，$PPV_{\\text{after}}$，为：\n$$PPV_{\\text{after}} = P(I | T_{\\text{comb}}) = \\frac{P(T_{\\text{comb}} | I) P(I)}{P(T_{\\text{comb}})}$$\n分母 $P(T_{\\text{comb}})$ 为：\n$$P(T_{\\text{comb}}) = P(T_{\\text{comb}} | I) P(I) + P(T_{\\text{comb}} | I^c) P(I^c)$$\n$$P(T_{\\text{comb}}) = Se_{\\text{comb}} \\pi + (1 - Sp_{\\text{comb}})(1 - \\pi)$$\n代入数值：\n$$P(T_{\\text{comb}}) = (0.895)(0.01) + (1 - 0.9405)(1 - 0.01) = 0.00895 + (0.0595)(0.99)$$\n$$P(T_{\\text{comb}}) = 0.00895 + 0.058905 = 0.067855$$\n现在，我们可以计算 $PPV_{\\text{after}}$：\n$$PPV_{\\text{after}} = \\frac{Se_{\\text{comb}} \\pi}{P(T_{\\text{comb}})} = \\frac{(0.895)(0.01)}{0.067855} = \\frac{0.00895}{0.067855}$$\n\n**3. 计算比率 $\\rho$**\n\n首先，我们计算假警报率的变化量，$\\Delta FAR$：\n$$\\Delta FAR = FAR_{\\text{after}} - FAR_{\\text{before}} = 0.0595 - 0.05 = 0.0095$$\n\n接下来，我们计算阳性预测值的变化量，$\\Delta PPV$：\n$$\\Delta PPV = PPV_{\\text{after}} - PPV_{\\text{before}} = \\frac{0.00895}{0.067855} - \\frac{0.0085}{0.058}$$\n其数值为：\n$$\\Delta PPV \\approx 0.1318989 - 0.1465517 = -0.0146528$$\n\n最后，我们计算比率 $\\rho = \\frac{\\Delta PPV}{\\Delta FAR}$：\n$$\\rho = \\frac{-0.0146528}{0.0095} \\approx -1.54240$$\n\n将结果四舍五入到四位有效数字，我们得到 $-1.542$。",
            "answer": "$$\\boxed{-1.542}$$"
        }
    ]
}