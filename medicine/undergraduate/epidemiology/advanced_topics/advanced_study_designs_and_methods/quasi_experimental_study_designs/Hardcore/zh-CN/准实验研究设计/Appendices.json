{
    "hands_on_practices": [
        {
            "introduction": "双重差分法（Difference-in-Differences, DiD）是评估政策和干预措施影响的基石。该方法的有效性关键取决于一个核心假设：平行趋势假设。本练习将带您深入理论核心，通过数学推导来揭示违反此假设为何会导致估计偏误，并量化该偏误的大小，从而帮助您从仅仅记忆此假设转变为深刻理解其在因果推断中的关键作用 。",
            "id": "4626142",
            "problem": "考虑一个流行病学中经典的双时期双组别双重差分（DiD）设定，其中政策暴露仅在后期影响处理组。设组别由 $g \\in \\{T, C\\}$ 索引，分别代表处理组和对照组；时间由 $t \\in \\{0,1\\}$ 索引，分别代表前期和后期。设 $Y_{gt}(d)$ 表示组别 $g$ 在时间 $t$ 在暴露状态 $d \\in \\{0,1\\}$ 下的潜在结果。假设稳定单位处理价值假设（SUTVA）成立，且仅在后期，处理组的加性处理反应是恒定的，因此有 $Y_{T1}(1) - Y_{T1}(0) = \\tau$, $Y_{T0}(1) - Y_{T0}(0) = 0$, $Y_{C1}(1) - Y_{C1}(0) = 0$, 和 $Y_{C0}(1) - Y_{C0}(0) = 0$。处理组的平均处理效应（ATT）定义为 $\\tau$。双重差分（DiD）估计量由观测结果 $Y_{gt}$ 构建，即处理组的后期与前期之差，减去对照组的后期与前期之差。\n\n假设平行趋势假设被处理组和对照组之间未处理趋势中的一个恒定差异所违背，该差异由标量 $\\Delta$ 量化，定义为\n$$\\left[E\\!\\left(Y_{T1}(0) - Y_{T0}(0)\\right)\\right] - \\left[E\\!\\left(Y_{C1}(0) - Y_{C0}(0)\\right)\\right] = \\Delta.$$\n从基本的潜在结果框架和DiD估计量的定义出发，推导DiD估计量的期望值，并计算其相对于 $\\tau$ 的偏差。说明偏差的符号和大小如何依赖于 $\\Delta$。请用一个关于 $\\Delta$ 的封闭形式表达式来表达您的最终答案；不要包含任何单位，也不要四舍五入。",
            "solution": "问题要求我们在平行趋势假设被特定违背的情况下，推导双重差分（DiD）估计量的期望值和偏差。我们首先将DiD估计量形式化，然后使用潜在结果框架来推导其性质。\n\n设组别 $g \\in \\{T, C\\}$ 在时间 $t \\in \\{0,1\\}$ 的观测结果由随机变量 $Y_{gt}$ 表示。DiD估计量 $\\hat{\\tau}_{\\text{DiD}}$ 是由这些结果的样本均值构建的。该估计量由下式给出：\n$$\n\\hat{\\tau}_{\\text{DiD}} = (\\bar{Y}_{T1} - \\bar{Y}_{T0}) - (\\bar{Y}_{C1} - \\bar{Y}_{C0})\n$$\n其中 $\\bar{Y}_{gt}$ 是组别 $g$ 在时间 $t$ 的样本均值结果。我们关心的是这个估计量的期望值 $E[\\hat{\\tau}_{\\text{DiD}}]$。根据期望的线性性质以及样本均值的期望等于总体均值（$E[\\bar{Y}_{gt}] = E[Y_{gt}]$）的性质，我们有：\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = (E[Y_{T1}] - E[Y_{T0}]) - (E[Y_{C1}] - E[Y_{C0}])\n$$\n\n接下来，我们将观测结果与潜在结果 $Y_{gt}(d)$ 联系起来，其中 $d \\in \\{0,1\\}$ 表示暴露状态。问题陈述了政策暴露仅在后期（$t=1$）影响处理组（$T$）。这定义了每个组别-时期组合的暴露状态：\n\\begin{itemize}\n    \\item 组别 $T$，时间 $t=1$：暴露，因此观测结果为 $Y_{T1} = Y_{T1}(1)$。\n    \\item 组别 $T$，时间 $t=0$：未暴露，因此观测结果为 $Y_{T0} = Y_{T0}(0)$。\n    \\item 组别 $C$，时间 $t=1$：未暴露，因此观测结果为 $Y_{C1} = Y_{C1}(0)$。\n    \\item 组别 $C$，时间 $t=0$：未暴露，因此观测结果为 $Y_{C0} = Y_{C0}(0)$。\n\\end{itemize}\n稳定单位处理价值假设（SUTVA）确保了这种映射是良定义的。\n\n将潜在结果代入估计量期望值的表达式中，我们得到：\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = (E[Y_{T1}(1)] - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)])\n$$\n\n问题提供了一个关于处理效应的关键假设。对于处理组，在后期它是一个加性常数 $\\tau$：\n$$\nY_{T1}(1) - Y_{T1}(0) = \\tau\n$$\n这意味着 $Y_{T1}(1) = Y_{T1}(0) + \\tau$。对两边取期望，得到：\n$$\nE[Y_{T1}(1)] = E[Y_{T1}(0) + \\tau] = E[Y_{T1}(0)] + \\tau\n$$\n因为 $\\tau$ 是一个常数。我们感兴趣的参数，即处理组的平均处理效应（ATT），被设定为 $\\tau$。\n\n现在我们将 $E[Y_{T1}(1)]$ 的这个表达式代回到我们关于 $E[\\hat{\\tau}_{\\text{DiD}}]$ 的方程中：\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = ( (E[Y_{T1}(0)] + \\tau) - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)])\n$$\n重新整理各项以分离出 $\\tau$，我们得到：\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = \\tau + \\left[ (E[Y_{T1}(0)] - E[Y_{T0}(0)]) - (E[Y_{C1}(0)] - E[Y_{C0}(0)]) \\right]\n$$\n\n方括号中的项代表在未暴露条件（$d=0$）下，处理组的时间趋势与对照组的时间趋势之差。标准的平行趋势假设假定此项为零。然而，问题陈述了该假设被违背，并将此差异定义为标量常数 $\\Delta$：\n$$\n\\left[E\\!\\left(Y_{T1}(0) - Y_{T0}(0)\\right)\\right] - \\left[E\\!\\left(Y_{C1}(0) - Y_{C0}(0)\\right)\\right] = \\Delta\n$$\n将 $\\Delta$ 代入我们估计量期望值的表达式中，得到我们结果的第一部分：\n$$\nE[\\hat{\\tau}_{\\text{DiD}}] = \\tau + \\Delta\n$$\n\n估计量的偏差定义为其期望值与它旨在估计的真实参数之间的差值。在这种情况下，真实参数是 ATT，即 $\\tau$。\n$$\n\\text{Bias}(\\hat{\\tau}_{\\text{DiD}}) = E[\\hat{\\tau}_{\\text{DiD}}] - \\tau\n$$\n代入推导出的 $E[\\hat{\\tau}_{\\text{DiD}}]$ 的表达式：\n$$\n\\text{Bias}(\\hat{\\tau}_{\\text{DiD}}) = (\\tau + \\Delta) - \\tau = \\Delta\n$$\n\n这个结果表明，DiD估计量的偏差恰好等于 $\\Delta$，即平行趋势假设被违背的程度。因此，偏差的符号和大小是 $\\Delta$ 的直接函数：\n\\begin{itemize}\n    \\item 如果 $\\Delta  0$，这意味着即使在没有处理的情况下，处理组的结果也会比对照组的结果有更陡峭的上升趋势。DiD估计量将这种差异趋势误认为是处理效应，导致正偏差。估计量高估了真实效应 $\\tau$。\n    \\item 如果 $\\Delta  0$，在没有处理的情况下，相对于对照组，处理组的结果趋势会是下降的（或上升得不那么陡峭）。这导致了负偏差，估计量低估了真实效应 $\\tau$。\n    \\item 如果 $\\Delta = 0$，则平行趋势假设成立，偏差为零，DiD估计量是ATT（$\\tau$）的无偏估计量。\n\\end{itemize}\n偏差的大小直接由 $|\\Delta|$ 给出。$\\Delta$ 的绝对值越大，DiD估计中的偏差就越大。\n\n所要求的最终答案是关于 $\\Delta$ 的偏差的封闭形式表达式。根据推导，它就是 $\\Delta$。",
            "answer": "$$\n\\boxed{\\Delta}\n$$"
        },
        {
            "introduction": "当研究者拥有许多时间点的数据时，中断时间序列（Interrupted Time Series, ITS）设计是一种功能强大的评估方法。然而，真实世界的数据常含有潜在模式，例如季节性波动，如果处理不当，这些模式可能会被误认为干预效果。本实践问题提供了一个具体案例，演示了如何识别和计算由未建模的季节性因素所引起的偏误，并指导您如何构建更精确的模型以获得无偏的效应估计 。",
            "id": "4626097",
            "problem": "一个公共卫生部门采用流行病学中的中断时间序列框架，评估一项准实验性政策。该政策在一个为期 $36$ 个月的观察期中的第 $19$ 个月开始实施。设月度结果变量 $Y_{t}$ 表示在第 $t$ 个月时，每 $100{,}000$ 人口中的流感样病例诊所就诊次数，其中 $t \\in \\{1,2,\\ldots,36\\}$。真实的数据生成过程为\n$$\nY_{t} \\;=\\; \\alpha \\;+\\; \\beta D_{t} \\;+\\; \\delta S_{t} \\;+\\; \\varepsilon_{t},\n$$\n其中 $D_{t}$ 是一个确定性处理指标，当 $t \\leq 18$ 时等于 $0$，当 $t \\geq 19$ 时等于 $1$；$S_{t}$ 是一个确定性季节性成分，由下式给出\n$$\nS_{t} \\;=\\; \\cos\\!\\left(\\frac{2\\pi t}{12}\\right),\n$$\n$\\delta$ 是季节性波动的幅度，$\\varepsilon_{t}$ 是一个误差项，满足 $\\mathbb{E}[\\varepsilon_{t} \\mid D_{t}, S_{t}] = 0$。假设 $\\delta = 27$。\n\n一位分析师错误地忽略了季节性成分，仅对截距项和 $D_{t}$ 拟合了 $Y_{t}$ 的普通最小二乘回归。从无偏性和普通最小二乘 (OLS) 正规方程的定义出发，推导并计算这个错误设定模型中估计处理效应的期望偏差。将最终偏差表示为一个以“每 $100{,}000$ 人就诊次数”为单位的实数。\n\n然后，指定一个科学上合理的模型，通过包含傅里叶级数项或月度季节性指标（“虚拟”）变量来减轻这种偏差。您必须以符号形式明确写出该模型。\n\n无需四舍五入；提供偏差的精确值。",
            "solution": "该问题要求在一个错误设定的中断时间序列模型中，推导和计算估计处理效应的遗漏变量偏差，并指定一个正确设定的模型。\n\n首先，让我们将模型形式化。真实的数据生成过程 (DGP) 由下式给出：\n$$ Y_{t} = \\alpha + \\beta D_{t} + \\delta S_{t} + \\varepsilon_{t} \\quad (*)$$\n其中 $t \\in \\{1, 2, \\ldots, 36\\}$，$D_{t} = 1$ 当 $t \\geq 19$ 时，否则为 $0$，$S_{t} = \\cos(\\frac{2\\pi t}{12})$，$\\delta = 27$，且 $\\mathbb{E}[\\varepsilon_{t} \\mid D_{t}, S_{t}] = 0$。\n\n分析师拟合了一个忽略了季节性成分 $S_t$ 的错误设定模型：\n$$ Y_{t} = a + b D_{t} + u_{t} \\quad (**) $$\n我们的任务是找出 $b$ 的普通最小二乘 (OLS) 估计量（记为 $\\hat{b}$）相对于真实效应 $\\beta$ 的期望偏差。偏差定义为 $\\text{Bias}(\\hat{b}) = \\mathbb{E}[\\hat{b}] - \\beta$。\n\n模型 $(**)$ 的 OLS 估计量（我们记为 $\\hat{a}$ 和 $\\hat{b}$）由正规方程导出：\n$$ \\sum_{t=1}^{N} (Y_t - \\hat{a} - \\hat{b}D_t) = 0 $$\n$$ \\sum_{t=1}^{N} D_t (Y_t - \\hat{a} - \\hat{b}D_t) = 0 $$\n其中 $N=36$ 是总观测数。求解这个方程组可以得到斜率系数估计量的标准公式：\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})(Y_t - \\bar{Y})}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n其中 $\\bar{D} = \\frac{1}{N}\\sum_{t=1}^{N} D_t$ 且 $\\bar{Y} = \\frac{1}{N}\\sum_{t=1}^{N} Y_t$。利用性质 $\\sum_{t=1}^{N} (D_t - \\bar{D})\\bar{Y} = 0$，上式可简化为：\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})Y_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n为了求出偏差，我们首先计算 $\\hat{b}$ 的期望。我们将方程 $(*)$ 中的真实 $Y_t$ 模型代入 $\\hat{b}$ 的表达式中：\n$$ \\hat{b} = \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})(\\alpha + \\beta D_t + \\delta S_t + \\varepsilon_t)}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n让我们展开分子：\n$$ \\sum_{t=1}^{N} (D_t - \\bar{D})\\alpha + \\sum_{t=1}^{N} (D_t - \\bar{D})\\beta D_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\delta S_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t $$\n各项简化如下：\n1.  根据离差性质，$\\alpha \\sum_{t=1}^{N} (D_t - \\bar{D}) = 0$。\n2.  $\\beta \\sum_{t=1}^{N} (D_t - \\bar{D})D_t = \\beta \\sum_{t=1}^{N} (D_t - \\bar{D})(D_t - \\bar{D}) = \\beta \\sum_{t=1}^{N} (D_t - \\bar{D})^2$。\n3.  $\\delta \\sum_{t=1}^{N} (D_t - \\bar{D})S_t$。\n4.  $\\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t$。\n\n将这些代回 $\\hat{b}$ 的表达式中：\n$$ \\hat{b} = \\frac{\\beta \\sum_{t=1}^{N} (D_t - \\bar{D})^2 + \\delta \\sum_{t=1}^{N} (D_t - \\bar{D})S_t + \\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n$$ \\hat{b} = \\beta + \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} + \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})\\varepsilon_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n现在我们以确定性回归量 $D_t$ 和 $S_t$ 为条件取期望。由于 $\\mathbb{E}[\\varepsilon_t] = 0$，最后一项的期望为零。\n$$ \\mathbb{E}[\\hat{b}] = \\beta + \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n因此，偏差为：\n$$ \\text{Bias}(\\hat{b}) = \\mathbb{E}[\\hat{b}] - \\beta = \\delta \\frac{\\sum_{t=1}^{N} (D_t - \\bar{D})S_t}{\\sum_{t=1}^{N} (D_t - \\bar{D})^2} $$\n为了计算偏差的值，我们必须计算这些和。\n观察期为 $N=36$ 个月。干预从 $t=19$ 开始。干预前有 $18$ 个月（$t=1, \\dots, 18$），干预后有 $18$ 个月（$t=19, \\dots, 36$）。\n处理指标 $D_t$ 的均值为 $\\bar{D} = \\frac{18 \\times 0 + 18 \\times 1}{36} = \\frac{18}{36} = \\frac{1}{2}$。\n\n分母是：\n$$ \\sum_{t=1}^{36} (D_t - \\bar{D})^2 = \\sum_{t=1}^{18} (0 - \\frac{1}{2})^2 + \\sum_{t=19}^{36} (1 - \\frac{1}{2})^2 = 18 \\left(\\frac{1}{4}\\right) + 18 \\left(\\frac{1}{4}\\right) = \\frac{18}{2} = 9 $$\n分子需要计算 $\\sum_{t=1}^{36} (D_t - \\frac{1}{2})S_t$。我们可以展开它：\n$$ \\sum_{t=1}^{36} (D_t - \\frac{1}{2}) S_t = \\sum_{t=1}^{18} (0 - \\frac{1}{2}) \\cos\\left(\\frac{2\\pi t}{12}\\right) + \\sum_{t=19}^{36} (1 - \\frac{1}{2}) \\cos\\left(\\frac{2\\pi t}{12}\\right) $$\n$$ = -\\frac{1}{2} \\sum_{t=1}^{18} \\cos\\left(\\frac{\\pi t}{6}\\right) + \\frac{1}{2} \\sum_{t=19}^{36} \\cos\\left(\\frac{\\pi t}{6}\\right) = \\frac{1}{2} \\left( \\sum_{t=19}^{36} S_t - \\sum_{t=1}^{18} S_t \\right) $$\n函数 $S_t = \\cos(\\frac{\\pi t}{6})$ 的周期是 $12$。对任意 $12$ 个连续整数求和结果为 $0$。\n让我们计算干预前时期（$t=1, \\dots, 18$）的和：\n$$ \\sum_{t=1}^{18} S_t = \\sum_{t=1}^{12} \\cos\\left(\\frac{\\pi t}{6}\\right) + \\sum_{t=13}^{18} \\cos\\left(\\frac{\\pi t}{6}\\right) = 0 + \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi (j+12)}{6}\\right) = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6} + 2\\pi\\right) $$\n$$ = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6}\\right) = \\cos(\\frac{\\pi}{6}) + \\cos(\\frac{\\pi}{3}) + \\cos(\\frac{\\pi}{2}) + \\cos(\\frac{2\\pi}{3}) + \\cos(\\frac{5\\pi}{6}) + \\cos(\\pi) $$\n$$ = \\frac{\\sqrt{3}}{2} + \\frac{1}{2} + 0 - \\frac{1}{2} - \\frac{\\sqrt{3}}{2} - 1 = -1 $$\n现在，我们计算干预后时期（$t=19, \\dots, 36$）的和。这也是一个 $18$ 个月的时期。\n$$ \\sum_{t=19}^{36} S_t = \\sum_{t=19}^{30} S_t + \\sum_{t=31}^{36} S_t = 0 + \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi (j+30)}{6}\\right) = \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6} + 5\\pi\\right) $$\n$$ = \\sum_{j=1}^{6} -\\cos\\left(\\frac{\\pi j}{6}\\right) = - \\left( \\sum_{j=1}^{6} \\cos\\left(\\frac{\\pi j}{6}\\right) \\right) = -(-1) = 1 $$\n将这些结果代回分子的表达式中：\n$$ \\sum_{t=1}^{36} (D_t - \\frac{1}{2})S_t = \\frac{1}{2} (1 - (-1)) = \\frac{1}{2}(2) = 1 $$\n最后，我们使用 $\\delta=27$ 计算偏差：\n$$ \\text{Bias}(\\hat{b}) = (27) \\frac{1}{9} = 3 $$\n估计的处理效应中的期望偏差是每 $100,000$ 人 $3$ 次就诊。\n\n第二个任务是指定一个科学上合理的模型来减轻这种偏差。偏差的产生是因为被忽略的季节性项 $S_t$ 与处理指标 $D_t$ 相关。为了纠正这一点，模型必须包含能够解释 12 个月季节性周期的项。一种标准方法是使用傅里叶级数项（正弦和余弦对）来表示周期的基频。对于一个 12 个月的周期，基频是 $\\omega = \\frac{2\\pi}{12}$。一个包含这些项的模型是：\n$$ Y_t = c_0 + c_1 D_t + c_2 \\cos\\left(\\frac{2\\pi t}{12}\\right) + c_3 \\sin\\left(\\frac{2\\pi t}{12}\\right) + e_t $$\n在这个模型中，系数 $c_2$ 和 $c_3$ 将捕捉季节性模式的振幅和相位。通过将这些项作为回归量包含进来，我们控制了季节性的混杂效应，并且处理效应的 OLS 估计量 $\\hat{c}_1$ 将是真实效应 $\\beta$ 的一个无偏估计量。这是因为被忽略的变量 $S_t$（或其充分的表示）现在被包含在回归中，满足了 OLS 关于没有遗漏混杂变量的假设。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "当存在无法观测的混杂因素时，工具变量法（Instrumental Variables, IV）提供了一种有效的解决方案，这是流行病学研究中一个常见挑战。然而，IV分析的可靠性完全取决于工具变量的质量。本练习将指导您完成一个至关重要的诊断步骤：检验是否存在“弱工具变量”问题，理解其为何会严重影响估计结果，并学习实践中广泛使用的判断标准和应对策略 。",
            "id": "4626140",
            "problem": "一个卫生系统采用观察性队列研究中的工具变量设计，评估启用一种新的降脂疗法对六个月时低密度脂蛋白胆固醇的影响。设暴露为疗法启用，记为 $X_{i}$；设工具变量为治疗医生的前一个月对该疗法的处方偏好，记为 $Z_{i}$，其度量为该医生前一个月患者中启用该疗法的比例。第一阶段线性模型以患者协变量和地点固定效应为条件，因此\n$$\nX_{i}=\\pi_{0}+\\pi_{1}Z_{i}+W_{i}^{\\top}\\pi_{w}+u_{i},\n$$\n其中 $W_{i}$ 包括基线协变量和地点指示变量。在一个包含 $n=2{,}400$ 名患者的样本中，工具变量的估计系数为 $\\widehat{\\pi}_{1}=0.0885$，其相关的稳健标准误为 $\\operatorname{SE}(\\widehat{\\pi}_{1})=0.0300$。\n\n在此单一工具变量的情景下，使用标准的线性模型检验框架来检验第一阶段的工具变量相关性，计算用于检验原假设 $H_{0}: \\pi_{1}=0$ 的第一阶段 $F$ 统计量。你的最终数值答案必须四舍五入到四位有效数字，并以纯数字形式表示。\n\n在你的推理过程中，从准实验中工具变量的核心定义（相关性、独立性、排他性）开始，解释第一阶段 $F$ 统计量作为工具变量强度诊断指标的作用，并论证为何像 $F  10$ 这样的小值意味着两阶段最小二乘法 (2SLS) 相对于普通最小二乘法 (OLS) 存在有限样本偏差。简要列举一种方法论上的补救措施，用以减轻弱工具变量偏差或在弱识别情况下提供有效推断，例如有限信息最大似然法 (LIML) 或弱工具变量稳健的推断程序。最终答案只应报告计算出的 $F$ 统计量。",
            "solution": "该问题表述清晰，并在计量经济学和流行病学领域具有科学依据，特别是关于准实验研究设计。计算所需的所有数据均已提供且内部一致。我们将开始解答。\n\n工具变量 (IV) 分析是一种统计方法，用于在无法进行对照实验且暴露与结果之间的关系被未测量变量混杂时，估计因果关系。要使变量 $Z_{i}$ 成为暴露 $X_{i}$ 对结果 $Y_{i}$ 的因果效应的有效工具变量，在任何协变量 $W_{i}$ 的条件下，它必须满足三个核心假设：\n1.  **相关性 (Relevance):** 工具变量必须与暴露有因果关联。在线性第一阶段模型的背景下，这等同于工具变量的系数不为零。对于给定的模型 $X_{i}=\\pi_{0}+\\pi_{1}Z_{i}+W_{i}^{\\top}\\pi_{w}+u_{i}$，相关性条件要求 $\\pi_{1} \\neq 0$。\n2.  **独立性 (Independence) (或可忽略性 Ignorability):** 工具变量必须独立于任何影响暴露和结果的未测量混杂因素。这意味着相对于潜在结果和混杂源，工具变量的分配是“仿佛随机”的。\n3.  **排他性限制 (Exclusion Restriction):** 工具变量必须仅通过其对暴露的影响来影响结果。不存在从工具变量 $Z_{i}$ 绕过暴露 $X_{i}$ 直接到结果 $Y_{i}$ 的因果路径。\n\n本问题关注第一个条件：工具变量相关性。第一阶段回归将暴露 $X_{i}$ 建模为工具变量 $Z_{i}$ 和其他协变量 $W_{i}$ 的函数。工具变量的强度是任何工具变量分析中的一个关键诊断指标。弱工具变量，即与暴露仅微弱相关的工具变量，可能导致严重的估计问题。\n\n工具变量的强度通过第一阶段 $F$ 统计量进行正式检验。该统计量检验了第一阶段回归中所有工具变量的系数均为零的原假设。在本问题中，只有一个工具变量 $Z_{i}$，因此我们检验原假设 $H_{0}: \\pi_{1}=0$ 相对于备择假设 $H_{1}: \\pi_{1} \\neq 0$。\n\n对于单一工具变量， $F$ 统计量等于该工具变量系数的 $t$ 统计量的平方。估计系数 $\\widehat{\\pi}_{1}$ 的 $t$ 统计量计算为估计值与其标准误之比：\n$$\nt = \\frac{\\widehat{\\pi}_{1} - \\pi_{1, H_0}}{\\operatorname{SE}(\\widehat{\\pi}_{1})}\n$$\n在原假设 $H_{0}: \\pi_{1}=0$ 下，该式简化为：\n$$\nt = \\frac{\\widehat{\\pi}_{1}}{\\operatorname{SE}(\\widehat{\\pi}_{1})}\n$$\n因此，第一阶段 $F$ 统计量由下式给出：\n$$\nF = t^2 = \\left( \\frac{\\widehat{\\pi}_{1}}{\\operatorname{SE}(\\widehat{\\pi}_{1})} \\right)^2\n$$\n问题提供了来自 $n=2,400$ 名患者样本的以下数值：\n- 工具变量的估计系数：$\\widehat{\\pi}_{1} = 0.0885$。\n- 估计值的稳健标准误：$\\operatorname{SE}(\\widehat{\\pi}_{1}) = 0.0300$。\n\n将这些值代入 $F$ 统计量的公式中：\n$$\nF = \\left( \\frac{0.0885}{0.0300} \\right)^2\n$$\n首先，我们计算比值，即 $t$ 统计量：\n$$\nt = \\frac{0.0885}{0.0300} = 2.95\n$$\n接着，我们将此值平方以获得 $F$ 统计量：\n$$\nF = (2.95)^2 = 8.7025\n$$\n问题要求答案四舍五入到四位有效数字。因此，$F \\approx 8.703$。\n\n这个 $F$ 统计量的值小于通常引用的经验法则阈值 $F=10$ (由 Staiger 和 Stock 在 1997 年提出)，表明该工具变量是“弱”的。弱工具变量对标准的两阶段最小二乘法 (2SLS) 估计量构成了一个重大问题。在有限样本中，2SLS 估计量偏向普通最小二乘法 (OLS) 估计量的方向。这种偏差的大小与第一阶段 $F$ 统计量成反比。由于 OLS 估计本身因混杂而存在偏差，弱工具变量意味着 2SLS 估计可能无法充分校正这种混杂，从而损害了因果推断的有效性。\n\n为解决弱工具变量的问题，方法学家们开发了替代的估计量和推断程序。其中一种替代估计量是有限信息最大似然法 (LIML)，与 2SLS 相比，它在弱工具变量情况下的中位数偏差方面更为稳健。另一种方法是使用弱工具变量稳健的推断程序，例如 Anderson-Rubin (AR) 检验，即使在工具变量很弱的情况下，它也能为因果参数提供有效的假设检验和置信区间，尽管其精度可能较低。\n\n所求值的最终计算结果是 $8.7025$，四舍五入后为 $8.703$。",
            "answer": "$$\n\\boxed{8.703}\n$$"
        }
    ]
}