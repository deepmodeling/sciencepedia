## 引言
在流行病学和许多社会科学研究中，从观测数据中区分相关性与因果关系是一个核心挑战。许多干预措施的效果评估常常受到未知或未测量混杂因素的困扰，使得研究结论充满不确定性。[断点回归设计](@entry_id:634606)（Regression Discontinuity Design, RDD）作为一种严谨的[准实验方法](@entry_id:636714)，为这一难题提供了强有力的解决方案。它巧妙地利用了现实世界中普遍存在的、基于特定数值阈值的分配规则——例如，基于年龄的疫苗接种资格或基于风险评分的治疗建议——在阈值附近创造出近似于随机实验的条件，从而可靠地识别出干预措施的真实因果效应。

本文旨在系统性地介绍[断点回归设计](@entry_id:634606)，帮助读者从理论到实践全面掌握这一方法。文章将分为三个核心部分：

*   在第一章“**原理与机制**”中，我们将深入探讨其核心思想、关键假设，以及清晰（Sharp）与模糊（Fuzzy）两种设计的数学框架与识别逻辑。
*   接下来的第二章“**应用与跨学科联系**”将通过公共卫生、临床医学、社会政策乃至环境科学等领域的丰富案例，展示RDD在解决实际问题中的强大功能与广泛适用性。
*   最后，在第三章“**动手实践**”中，我们将通过具体的编程练习，指导读者掌握RDD分析中的可视化检验、效应估计和敏感性分析等关键技术步骤。

通过学习本文，读者将能够理解并运用这一强大的因果推断工具，从复杂的观测数据中挖掘出更可靠的因果结论，提升研究的内部有效性。

## 原理与机制

### 核心思想：利用阈值进行因果推断

在流行病学及公共卫生研究中，我们常常遇到这样一种情况：一项干预措施或政策的实施与否，取决于某个可观测的连续变量是否达到了一个特定的阈值。例如，临床指南可能建议当患者的某项风险评分超过特定值时开始药物治疗；政府项目可能为达到特定年龄的公民提供免费疫苗。[断点回归设计](@entry_id:634606) (Regression Discontinuity Design, RDD) 正是利用这类基于阈值的分配规则来估计干预措施因果效应的一种强大的[准实验方法](@entry_id:636714)。

RDD的核心思想在于，对于那些分配变量（**running variable**）恰好落在阈值（**cutoff**）两侧的个体，我们可以认为他们是高度相似的。想象一下，一个临床指南规定，当患者的低密度脂蛋白（LDL）胆[固醇](@entry_id:173187)水平 $X_i$ 大于或等于 $c=190$ mg/dL 时，应启动[他汀类药物](@entry_id:167025)治疗 。那么，一个LDL水平为 $190.1$ mg/dL 的患者与一个水平为 $189.9$ mg/dL 的患者，在其他所有生理特征、健康行为和未观测到的混杂因素上，平均而言应该是极其相似的。他们之间唯一的系统性差异，就是因为这个微小的LDL水平差异，一个被分配到了处理组（接受治疗），另一个则被分配到了[控制组](@entry_id:188599)（不接受治疗）。

这种在断点附近的相似性，为我们创造了一个“局部随机实验”（local randomized experiment）。我们可以通过一个思维实验来更好地理解这个概念 。假设实验室对血红蛋白A1c的测量存在微小的、患者无法预测的随机误差。对于一个真实A1c水平恰好在临床阈值 $c$ 附近的患者，其最终报告的测量值 $X_i$ 是落在 $c$ 的左侧还是右侧，很大程度上取决于这种随机波动。由于患者无法精确操纵这个微小的随机成分，因此，在断点 $c$ 的一个极小邻域内，处理分配（即测量值是大于还是小于 $c$）就近似于随机的。这种“准随机分配”是RDD因果推断能力的基石。

因此，RDD研究中的三个关键要素是：
1.  **分配变量 (Running Variable)**, $X_i$：一个连续的、决定处理分配的变量。
2.  **断点 (Cutoff)**, $c$：分配变量上的一个阈值，跨越该阈值会改变处理状态。
3.  **处理 (Treatment)**, $D_i$：我们想要评估其效应的干预措施。

### 清晰断点回归 (Sharp RDD) 设计

#### 形式化定义与[潜在结果框架](@entry_id:636884)

最简单直接的RDD形式是清晰[断点回归设计](@entry_id:634606)（**Sharp Regression Discontinuity Design**, SRD）。在SRD中，处理状态 $D_i$ 是由分配变量 $X_i$ 和断点 $c$ 完全决定的。例如，如果干预措施在分配变量达到或超过断点时实施，那么分配规则可以写成：
$$
D_i = \mathbf{1}\{X_i \ge c\}
$$
其中 $\mathbf{1}\{\cdot\}$ 是[指示函数](@entry_id:186820)，当条件成立时取值为1，否则为0 。

为了形式化地定义因果效应，我们使用[潜在结果框架](@entry_id:636884)（Potential Outcomes Framework）。对于每个个体 $i$，我们定义两个潜在结果：$Y_i(1)$ 表示个体 $i$ 接受处理（$D_i=1$）时的结果，而 $Y_i(0)$ 表示其未接受处理（$D_i=0$）时的结果 。个体的因果效应是 $Y_i(1) - Y_i(0)$。然而，我们永远无法同时观测到同一个体的两个潜在结果，这是因果推断的根本难题。在SRD中，我们的目标是估计在断点 $c$ 处的**局部平均[处理效应](@entry_id:636010)**（Local Average Treatment Effect, LATE），即 $E[Y_i(1) - Y_i(0) | X_i = c]$。

#### 识别假设：潜在结果的连续性

RDD的识别能力并非凭空而来，它依赖于一个核心的、至关重要的假设：**[潜在结果](@entry_id:753644)的[条件期望](@entry_id:159140)函数在断点处是连续的** 。这意味着，对于处理和未处理两种状态，[潜在结果](@entry_id:753644)的[期望值](@entry_id:150961) $E[Y_i(d) | X_i = x]$ (其中 $d \in \{0,1\}$) 作为分配变量 $x$ 的函数，在 $x=c$ 点是连续的。

这个假设的直观含义是：如果没有任何处理，个体的平均结果会随着分配变量 $x$ 的变化而平滑地变化，在断点 $c$ 处不会发生任何“跳跃”。断点 $c$ 本身除了改变处理分配外，不应与任何其他能导致结果突然改变的因素相关联。

这个假设是针对我们无法完全观测的潜在结果的，而我们能够观测到的是实际结果 $Y_i$。在SRD中，观测结果 $Y_i$ 的[条件期望](@entry_id:159140) $E[Y_i | X_i = x]$ 与[潜在结果](@entry_id:753644)的关系如下：
$$
E[Y_i | X_i=x] = \begin{cases} E[Y_i(0) | X_i=x] & \text{if } x  c \\ E[Y_i(1) | X_i=x]  \text{if } x \ge c \end{cases}
$$
如果处理效应非零（即 $E[Y_i(1) | X_i=c] \neq E[Y_i(0) | X_i=c]$），并且我们接受了[潜在结果](@entry_id:753644)连续性的假设，那么观测结果的[条件期望](@entry_id:159140)函数 $E[Y_i | X_i=x]$ 必然会在断点 $c$ 处出现一个不连续的“跳跃”。这个跳跃正是我们用来识别因果效应的信号 。因此，一个常见的误解是认为观测结果的连续性是RDD的假设；恰恰相反，我们寻找的正是观测结果的不连续性。

#### SRD的估计量

基于上述逻辑，我们可以推导出SRD的估计量。我们想要估计的量是 $E[Y_i(1) | X_i=c] - E[Y_i(0) | X_i=c]$。

考虑断点右侧的极限：
$$
\lim_{x \downarrow c} E[Y_i | X_i=x] = \lim_{x \downarrow c} E[Y_i(1) | X_i=x]
$$
由于我们假设 $E[Y_i(1) | X_i=x]$ 在 $c$ 处是连续的，所以这个极限等于该函数在 $c$ 点的值：
$$
\lim_{x \downarrow c} E[Y_i(1) | X_i=x] = E[Y_i(1) | X_i=c]
$$
同理，对于断点左侧的极限：
$$
\lim_{x \uparrow c} E[Y_i | X_i=x] = \lim_{x \uparrow c} E[Y_i(0) | X_i=x] = E[Y_i(0) | X_i=c]
$$
因此，观测结果在断点处跳跃的幅度，恰好等于我们想估计的局部平均[处理效应](@entry_id:636010) ：
$$
\tau_{\text{SRD}} = \lim_{x \downarrow c} E[Y_i | X_i=x] - \lim_{x \uparrow c} E[Y_i | X_i=x] = E[Y_i(1) - Y_i(0) | X_i=c]
$$
这个公式是SRD的理论核心。它表明，我们可以通过比较断点两侧观测结果的极限来识别因果效应。值得强调的是，这是一个**局部**效应，即它仅适用于分配变量恰好在断点处的这部分人群。将这个局部效应外推到远离断点的人群，需要非常强的额外假设，例如处理效应在所有人群中都是同质的（即 $E[Y_i(1) - Y_i(0) | X_i=x]$ 是一个常数），而这个假设在现实中通常难以成立 。

### 模糊断点回归 (Fuzzy RDD) 设计

#### 当分配不完美时

在许多现实情景中，跨越断点并不绝对地决定个体是否接受处理，而仅仅是改变了他们接受处理的**概率**。例如，一项[公共卫生政策](@entry_id:185037)为高危人群提供免费的戒烟项目，但部分符合条件的患者可能拒绝参加，而部分不符合条件的患者可能通过临床医生的特批而被纳入项目 。在这种情况下，处理分配是不完美的，或称之为“模糊的”。

在模糊[断点回归设计](@entry_id:634606)（**Fuzzy Regression Discontinuity Design**, FRD）中，我们不再有 $D_i = \mathbf{1}\{X_i \ge c\}$ 的确定性规则，而是观测到处理概率在断点处发生跳跃：
$$
\lim_{x \downarrow c} P(D_i=1|X_i=x) \neq \lim_{x \uparrow c} P(D_i=1|X_i=x)
$$
但这两个极限值通常都不是0或1 。

#### FRD作为局部工具变量方法

FRD的理论基础可以被优雅地理解为一种**局部工具变量 (Instrumental Variable, IV) 方法**。在这里，**资格状态**（eligibility status），即由断点规则决定的 $Z_i = \mathbf{1}\{X_i \ge c\}$，扮演了工具变量的角色。一个有效的[工具变量](@entry_id:142324)必须满足几个关键条件，在FRD的背景下，它们可以被表述为 ：

1.  **相关性 (Relevance)**：[工具变量](@entry_id:142324)（资格状态的改变）必须与处理状态（实际是否接受干预）相关。在FRD中，这对应于处理概率在断点处存在不为零的跳跃。这是FRD的“第一阶段”（first stage）。

2.  **排他性限制 (Exclusion Restriction)**：工具变量只能通过影响处理状态来影响结果，而不能有直接影响结果的独立路径。在FRD中，这个条件由前述的核心假设——[潜在结果](@entry_id:753644)的连续性——来保证。该假设意味着资格状态的改变本身不会导致潜在结果 $Y_i(0)$ 或 $Y_i(1)$ 发生跳跃。

3.  **单调性 (Monotonicity)**：[工具变量](@entry_id:142324)对所有个体的影响方向是相同的。具体来说，从不合格变为合格（即 $Z_i$ 从0变为1）不会使任何个体从愿意接受处理变为不愿意接受处理。这个假设排除了“**逆反者**”（defiers）的存在，即那些只有在不被鼓励时才接受处理，而在被鼓励时反而拒绝处理的个体 。这个假设在清晰断点回归中是不需要的，因为依从是完美的。

#### FRD估计量及其解释

在IV框架下，因果效应可以通过[工具变量](@entry_id:142324)对结果的影响（缩减形式，reduced form）与工具变量对处理状态的影响（第一阶段）之比来识别。在FRD中，这个比率被定义为观测结果在断点处的跳跃幅度与处理概率在断点处的跳跃幅度的比值 ：
$$
\tau_{\text{FRD}} = \frac{\lim_{x \downarrow c} E[Y_i|X_i=x] - \lim_{x \uparrow c} E[Y_i|X_i=x]}{\lim_{x \downarrow c} E[D_i|X_i=x] - \lim_{x \uparrow c} E[D_i|X_i=x]}
$$
这个公式的分母是第一阶段的跳跃，分子是缩减形式的跳跃。那么，$\tau_{\text{FRD}}$ 究竟识别了什么呢？

在满足上述IV假设的条件下，$\tau_{\text{FRD}}$ 识别的是**依从者（compliers）**的局部平均[处理效应](@entry_id:636010)（LATE）。依从者是指那些其处理行为严格遵守[工具变量](@entry_id:142324)指示的个体，即在不合格时（$Z_i=0$）不接受处理，在合格时（$Z_i=1$）则接受处理的群体 。

我们可以将人群分为三类（假设没有逆反者）：
*   **始终接受者 (Always-takers)**：无论是否合格，他们总是接受处理。
*   **从不接受者 (Never-takers)**：无论是否合格，他们从不接受处理。
*   **依从者 (Compliers)**：只有在合格时才接受处理。

在断点两侧，始终接受者和从不接受者的行为和（在连续性假设下）平均潜在结果都是平滑过渡的，他们对结果和处理概率在断点处的“跳跃”没有贡献。唯一导致跳跃的群体是依从者，因为他们的处理状态在跨越断点时从0变成了1。因此，$\tau_{\text{FRD}}$ 精准地捕捉了处理对这部分因政策改变而改变行为的人群的平均因果效应。

### 有效性威胁与诊断性检验

RDD的强大内部有效性建立在一系列严格的假设之上。在实际应用中，我们必须仔细审视这些假设是否成立，并通过诊断性检验来评估其可信度。

#### “不可操纵”假设

RDD的核心逻辑——断点附近的“准随机”分配——依赖于一个关键前提：个体无法精确地操纵分配变量 $X_i$ 以将自己定位在断点的有利一侧 。如果存在这种策略性操纵，RDD的识别假设就会被破坏。

例如，如果患者和医生知道LDL胆[固醇](@entry_id:173187)水平高于 $c$ 就能获得药物治疗，他们可能会通过改变生活方式或检测时机来确保测量值恰好超过 $c$。如果这种操纵行为与某些未观测到的、同时影响健康的因素（如患者的健康意识）相关，那么断点两侧的人群就不再具有可比性。在这种情况下，观测到的结果跳跃不仅包含了处理效应，还混杂了由这些未观测因素引起的“[选择偏误](@entry_id:172119)”，导致估计结果有偏 。

#### 诊断检验：分配变量密度的连续性

如何检测这种策略性操纵呢？一个直观的想法是，如果大量个体试图将自己的 $X_i$ 操纵到恰好超过 $c$ 的位置，那么分配变量 $X_i$ 的分布密度函数 $f_X(x)$ 就会在断点 $c$ 处出现一个不自然的“堆积”，导致密度函数不连续。

**McCrary检验**就是为此设计的标准诊断工具 。该检验通过比较断点两侧局部估计的对[数密度](@entry_id:268986)函数的差异，来判断密度函数在断点处是否存在统计上显著的跳跃。一个显著的跳跃是操纵行为存在的强烈警示信号，严重威胁了RDD研究的有效性。然而，需要注意的是，McCrary检验不显著并不绝对证明没有操纵，这可能是因为检验的统计功效不足，或者操纵以一种不改变密度连续性的更复杂方式发生。

#### 诊断检验：协变量平衡性检验

RDD的连续性假设有一个重要的可检验推论：如果断点两侧的个体在未观测特征上是可比的，那么他们在所有**不受处理影响的基线协变量**（pre-treatment covariates）上也应该是可比的。这意味着任何基线协变量 $Z_i$（如年龄、性别、病史等）的条件期望 $E[Z_i | X_i=x]$ 在断点 $c$ 处也应该是连续的。

因此，我们可以通过对每个基线协变量进行“安慰剂检验”（placebo test）来评估RDD的有效性。具体做法是，将基线协变量 $Z_i$ 当作结果变量，然后运用与主分析完全相同的RDD估计方法（如[局部线性回归](@entry_id:635822)）来检验其在断点处是否存在跳跃 。如果在任何一个基线协变量上发现了统计上显著的跳跃，这将是对RDD核心假设的有力反驳，表明断点两侧的人群在处理之前就已经存在系统性差异，研究的因果结论将不再可信。

### 断点回归与其他方法的区别

最后，有必要将RDD与其他流行的因果推断方法，如**倾向性[得分匹配](@entry_id:635640) (Propensity Score Matching, PSM)** 进行区分。PSM和相关方法试图通过在大量观测到的协变量上进行匹配或加权，来使得处理组和[控制组](@entry_id:188599)达到可比。这些方法依赖于一个核心的“可观测选择”（selection on observables）假设，即一旦控制了所有相关的协变量 $Z_i$，处理分配 $D_i$ 就与潜在结果 $Y_i(d)$ 相互独立。

相比之下，RDD的逻辑截然不同。RDD并不需要在整个样本空间内平衡协变量，而是利用了分配规则中固有的**[不连续性](@entry_id:144108)**。它的识别能力来自于分配变量 $X_i$ 在断点 $c$ 处的局部比较，而这个 $X_i$ 本身完全可以与[潜在结果](@entry_id:753644)相关（例如，风险评分越高，潜在的健康结果可能越差）。只要这种相关性在断点处是平滑变化的（即连续性假设成立），RDD就能提供一个有效的因果估计。正因为RDD不依赖于对所有相关混杂因素的测量和控制，而是依赖于一个更透明、更易于检验的设计特征，它通常被认为比PSM等方法具有更强的**内部有效性**，是[准实验方法](@entry_id:636714)中的“黄金标准”之一 。