{
    "hands_on_practices": [
        {
            "introduction": "哈代-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）是群体遗传学的基石，也是遗传关联研究中一项至关重要的质量控制步骤。在病例-对照研究中，对照组的基因型频率若偏离哈代-温伯格平衡，可能预示着基因分型错误、群体分层或其他可能影响研究结论的系统性偏差。本练习将通过第一性原理，指导你构建并计算HWE的精确检验，这对于处理小样本数据尤为重要，因为在小样本中，卡方近似检验可能不再适用 。",
            "id": "4595384",
            "problem": "一个具有等位基因 $A$ 和 $a$ 的双等位基因单核苷酸多态性在一个病例-对照研究中进行了基因分型。在病例组中，观察到的基因型计数为 $(n_{AA}^{\\mathrm{case}}, n_{Aa}^{\\mathrm{case}}, n_{aa}^{\\mathrm{case}}) = (18, 12, 2)$。在对照组中，观察到的基因型计数为 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}}) = (16, 0, 4)$。仅关注对照组，使用孟德尔分离和随机交配的第一性原理来构建哈迪-温伯格平衡（HWE）的精确检验。按以下步骤进行：\n\n- 从随机交配群体中HWE的定义出发，如果等位基因 $a$ 的群体频率为 $p$，则基因型概率对于 $AA$ 是 $(1-p)^{2}$，对于 $Aa$ 是 $2p(1-p)$，对于 $aa$ 是 $p^{2}$。\n- 在HWE下，将对照组的基因型计数 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}})$ 建模为大小为 $n$ 的多项式样本。证明通过以对照组中观察到的 $a$ 等位基因总数为条件，可以消除讨厌参数 $p$，并获得杂合子计数的条件分布。\n- 使用此条件分布，计算精确的双侧 $p$ 值，其定义为所有与观察到的 $a$ 等位基因总数一致且概率小于或等于观察到的对照组配置概率的对照组基因型配置的概率之和。将最终的 $p$ 值以小数形式表示，并四舍五入到三位有效数字。\n\n最后，根据第一性原理和预期基因型计数，论证对照组中HWE检验的大样本卡方（$\\chi^{2}$）近似在何时有效，并评估其对于给定对照组计数的有效性。你最终报告的答案应仅为精确检验的数值 $p$ 值，并按要求四舍五入。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、问题明确的且客观的。它提出了一个统计遗传学中的标准问题：执行哈迪-温伯格平衡（HWE）的精确检验。所有必要的数据和定义都已提供。\n\n该问题要求对对照组进行HWE的精确检验。对照组的观察基因型计数为 $(n_{AA}^{\\mathrm{ctrl}}, n_{Aa}^{\\mathrm{ctrl}}, n_{aa}^{\\mathrm{ctrl}}) = (16, 0, 4)$。\n\n对照组样本中的个体总数为 $n = n_{AA}^{\\mathrm{ctrl}} + n_{Aa}^{\\mathrm{ctrl}} + n_{aa}^{\\mathrm{ctrl}} = 16 + 0 + 4 = 20$。\n\n在HWE的原假设下，对于一个等位基因 $A$ 和 $a$ 的频率分别为 $p_A$ 和 $p_a$（$p_A + p_a = 1$）的群体，基因型频率由 $P(AA) = p_A^2$、$P(Aa) = 2p_A p_a$ 和 $P(aa) = p_a^2$ 给出。问题将等位基因 $a$ 的频率定义为 $p_a = p$，因此基因型频率为 $P(AA) = (1-p)^2$、$P(Aa) = 2p(1-p)$ 和 $P(aa) = p^2$。\n\n在一个大小为 $n$ 的样本中，基因型计数 $(N_{AA}, N_{Aa}, N_{aa})$ 被建模为来自多项式分布的抽样。观察到一组特定计数 $(n_{AA}, n_{Aa}, n_{aa})$ 的概率是：\n$$ P(N_{AA}=n_{AA}, N_{Aa}=n_{Aa}, N_{aa}=n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} [P(AA)]^{n_{AA}} [P(Aa)]^{n_{Aa}} [P(aa)]^{n_{aa}} $$\n代入HWE概率，我们得到未知参数 $p$ 的似然函数：\n$$ L(p; n_{AA}, n_{Aa}, n_{aa}) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} ((1-p)^2)^{n_{AA}} (2p(1-p))^{n_{Aa}} (p^2)^{n_{aa}} $$\n$$ L(p) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} (1-p)^{2n_{AA}+n_{Aa}} p^{n_{Aa}+2n_{aa}} $$\n令 $N_a$ 为样本中等位基因 $a$ 的总计数，其中 $N_a = n_{Aa} + 2n_{aa}$。样本中的等位基因总数为 $2n$。等位基因 $A$ 的计数为 $N_A = 2n_{AA} + n_{Aa} = 2n - N_a$。似然函数可以重写为：\n$$ L(p) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} (1-p)^{2n-N_a} p^{N_a} $$\n根据 Fisher-Neyman 分解定理，$N_a$ 是讨厌参数 $p$ 的充分统计量。为了创建一个独立于 $p$ 的检验，我们以该充分统计量的观测值为条件。对于给定的对照组数据，等位基因 $a$ 的观察计数为 $N_a^{\\mathrm{obs}} = n_{Aa}^{\\mathrm{ctrl}} + 2n_{aa}^{\\mathrm{ctrl}} = 0 + 2(4) = 8$。\n\n我们需要找到在给定 $n=20$ 和 $N_a=8$ 的条件下基因型计数的条件概率：\n$$ P(N_{AA}=n_{AA}, N_{Aa}=n_{Aa}, N_{aa}=n_{aa} \\mid N_a=8, n=20) $$\n这是观察到特定基因型计数的概率与观察到总等位基因计数 $N_a=8$ 的概率之比。在一个包含 $2n$ 个等位基因的样本中， $a$ 等位基因的总数服从二项分布 $N_a \\sim \\mathrm{Binomial}(2n, p)$。因此，$P(N_a=k) = \\binom{2n}{k} p^k (1-p)^{2n-k}$。\n条件概率是：\n$$ P(\\text{counts} \\mid N_a=8) = \\frac{P(\\text{counts})}{P(N_a=8)} = \\frac{\\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} 2^{n_{Aa}} p^8 (1-p)^{32}}{\\binom{2n}{8} p^8 (1-p)^{32}} = \\frac{n! 2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}! \\binom{2n}{8}} $$\n这个概率与 $p$ 无关。给定 $n=20$ 和 $N_a=8$，基因型计数受到以下约束：\n$n_{AA} + n_{Aa} + n_{aa} = 20$\n$2n_{AA} + n_{Aa} = 2(20) - 8 = 32$\n$n_{Aa} + 2n_{aa} = 8$\n\n从这些约束中，我们可以用 $n_{Aa}$ 来表示 $n_{AA}$ 和 $n_{aa}$：\n$n_{aa} = (8 - n_{Aa})/2$\n$n_{AA} = (32 - n_{Aa})/2$\n为了使 $n_{AA}$ 和 $n_{aa}$ 为整数，$n_{Aa}$ 必须是偶数。此外，所有计数都必须为非负数，所以 $n_{Aa} \\ge 0$，$8 - n_{Aa} \\ge 0 \\implies n_{Aa} \\le 8$。\n因此，杂合子计数 $n_{Aa}$ 的可能值为 $\\{0, 2, 4, 6, 8\\}$。\n\n双侧精确 $p$ 值是所有可能的基因型配置（对于固定的 $N_a=8, n=20$）中，其概率小于或等于观察到的配置 $(16, 0, 4)$ 的概率之和。观察到的配置对应于 $n_{Aa}=0$。\n\n令 $f(k)$ 为概率中与 $n_{Aa}=k$ 配置成正比的项：\n$f(n_{Aa}) = \\frac{2^{n_{Aa}}}{n_{AA}! n_{Aa}! n_{aa}!}$。条件概率为 $P(n_{Aa}=k) = \\frac{n!}{\\binom{2n}{N_a}} f(k)$。\n我们计算当 $k \\in \\{0, 2, 4, 6, 8\\}$ 时 $f(k)$ 的相对值。\n可能的配置 $(n_{AA}, n_{Aa}, n_{aa})$ 是：\n- $n_{Aa} = 0$: $(16, 0, 4)$ (观察值)\n- $n_{Aa} = 2$: $(15, 2, 3)$\n- $n_{Aa} = 4$: $(14, 4, 2)$\n- $n_{Aa} = 6$: $(13, 6, 1)$\n- $n_{Aa} = 8$: $(12, 8, 0)$\n\n让我们计算概率的比率：\n$\\frac{P(n_{Aa}=2)}{P(n_{Aa}=0)} = \\frac{f(2)}{f(0)} = \\frac{2^2/(15!2!3!)}{2^0/(16!0!4!)} = \\frac{4 \\cdot 16! \\cdot 4!}{15! \\cdot 2! \\cdot 3!} = 4 \\cdot 16 \\cdot \\frac{24}{12} = 128$。\n$\\frac{P(n_{Aa}=4)}{P(n_{Aa}=2)} = \\frac{f(4)}{f(2)} = \\frac{2^4/(14!4!2!)}{2^2/(15!2!3!)} = \\frac{4 \\cdot 15! \\cdot 2! \\cdot 3!}{14! \\cdot 4! \\cdot 2!} = 4 \\cdot 15 \\cdot \\frac{6}{24} = 15$。\n$\\frac{P(n_{Aa}=6)}{P(n_{Aa}=4)} = \\frac{f(6)}{f(4)} = \\frac{2^6/(13!6!1!)}{2^4/(14!4!2!)} = \\frac{4 \\cdot 14! \\cdot 4! \\cdot 2!}{13! \\cdot 6!} = 4 \\cdot 14 \\cdot \\frac{48}{720} = \\frac{56}{15}$。\n$\\frac{P(n_{Aa}=8)}{P(n_{Aa}=6)} = \\frac{f(8)}{f(6)} = \\frac{2^8/(12!8!0!)}{2^6/(13!6!1!)} = \\frac{4 \\cdot 13! \\cdot 6!}{12! \\cdot 8!} = 4 \\cdot 13 \\cdot \\frac{1}{8 \\cdot 7} = \\frac{13}{14}$。\n\n这些比率表明 $P(n_{Aa}=0)  P(n_{Aa}=2)  P(n_{Aa}=4)  P(n_{Aa}=6)$，且 $P(n_{Aa}=8)  P(n_{Aa}=6)$。全面比较显示，$P(n_{Aa}=0)$ 是所有可能配置中的最小概率。\n因此，概率小于或等于观察配置的唯一配置是观察配置本身。$p$ 值是观察到 $n_{Aa}=0$ 的条件概率。\n$$p\\text{-value} = P(n_{Aa}=0 \\mid N_a=8) = \\frac{f(0)}{\\sum_{k \\in \\{0,2,4,6,8\\}} f(k)}$$\n令 $f(0)=1$（作为一个参考单位）。其他值为：\n$f(2) = \\frac{P(n_{Aa}=2)}{P(n_{Aa}=0)} f(0) = 128 \\cdot f(0)$。\n$f(4) = \\frac{P(n_{Aa}=4)}{P(n_{Aa}=2)} f(2) = 15 \\cdot 128 \\cdot f(0) = 1920 \\cdot f(0)$。\n$f(6) = \\frac{P(n_{Aa}=6)}{P(n_{Aa}=4)} f(4) = \\frac{56}{15} \\cdot 1920 \\cdot f(0) = 56 \\cdot 128 \\cdot f(0) = 7168 \\cdot f(0)$。\n$f(8) = \\frac{P(n_{Aa}=8)}{P(n_{Aa}=6)} f(6) = \\frac{13}{14} \\cdot 7168 \\cdot f(0) = 13 \\cdot 512 \\cdot f(0) = 6656 \\cdot f(0)$。\n\n相对概率之和是：\n$\\sum f(k) = (1 + 128 + 1920 + 7168 + 6656) \\cdot f(0) = 15873 \\cdot f(0)$。\n$p$ 值为：\n$$ p\\text{-value} = \\frac{f(0)}{15873 \\cdot f(0)} = \\frac{1}{15873} \\approx 0.00006299943... $$\n四舍五入到三位有效数字，$p$ 值为 $0.0000630$。\n\n最后，我们评估大样本卡方（$\\chi^2$）近似的有效性。HWE的 $\\chi^2$ 检验统计量 $\\sum (O-E)^2/E$ 近似服从自由度为1的 $\\chi^2$ 分布。这种近似是基于基因型计数的多项式分布的正态近似。这种近似的有效性根本上要求每个单元（基因型）的期望计数不能太小。一个被广泛接受的准则是，所有期望计数应至少为 $5$。\n\n为了计算对照组的期望计数，我们首先从样本数据中估计等位基因频率 $p$。最大似然估计是样本等位基因频率：\n$$\\hat{p} = \\frac{n_{Aa}^{\\mathrm{ctrl}} + 2n_{aa}^{\\mathrm{ctrl}}}{2n} = \\frac{0 + 2(4)}{2(20)} = \\frac{8}{40} = 0.2$$\nHWE下的期望基因型计数为：\n$E_{AA} = n(1-\\hat{p})^2 = 20(0.8)^2 = 20(0.64) = 12.8$\n$E_{Aa} = n(2\\hat{p}(1-\\hat{p})) = 20(2 \\cdot 0.2 \\cdot 0.8) = 20(0.32) = 6.4$\n$E_{aa} = n(\\hat{p}^2) = 20(0.2)^2 = 20(0.04) = 0.8$\n\n$aa$ 基因型的期望计数是 $E_{aa} = 0.8$，这远小于常规的阈值 $5$。因为其中一个期望计数非常小，所以不满足 $\\chi^2$ 近似的理论条件。因此，大样本 $\\chi^2$ 检验不适用于此数据集，使用精确检验是必要且恰当的。",
            "answer": "$$\\boxed{6.30 \\times 10^{-5}}$$"
        },
        {
            "introduction": "许多复杂疾病表现为离散的诊断结果（如患病/健康），但其背后往往受到一个连续潜在风险（易感性）的影响，这便是易感性阈值模型的核心思想。在该模型下，直接从病例-对照研究数据中估算出的遗传度（观察尺度遗传度）并不能直接解释为遗传因素对潜在疾病风险的贡献，而必须将其转换到更具生物学意义的易感性尺度上。本练习将引导你推导并计算这一关键的转换过程，它要求你综合考虑疾病的人群患病率和研究的抽样设计，这是准确量化复杂疾病遗传贡献的核心技能之一 。",
            "id": "4595340",
            "problem": "在一项复杂疾病的病例-对照研究中，使用线性混合模型 (LMM) 在观察到的二元尺度（病例编码为 $1$，对照编码为 $0$）上估计了单核苷酸多态性 (SNP) 的遗传力。在易感性-阈值框架下，假设一个未观察到的连续易感性 $L$ 服从标准正态分布，当 $L$ 超过一个阈值时，个体即为病例。该疾病的人群患病率为 $K = 0.10$。病例和对照是从源人群中回顾性选择的，病例的抽样分数为 $s_{1} = 0.60$，对照的抽样分数为 $s_{0} = 0.10$，其中每个 $s_{y}$ 表示状态为 $y \\in \\{0,1\\}$ 的个体被纳入研究样本的概率。在抽样样本中，观察尺度上估计的 SNP 遗传力为 $h_{\\mathrm{obs}}^{2} = 0.08$。\n\n从易感性-阈值模型、标准正态分布的累积分布函数 (CDF) $\\Phi(\\cdot)$ 和概率密度函数 (PDF) $\\phi(\\cdot)$ 的定义，以及伯努利随机变量的方差 $p(1-p)$ 出发，推导一个表达式，利用已知的人群患病率和抽样分数，将抽样病例-对照样本中观察尺度上的 SNP 遗传力转换为易感性尺度上的 SNP 遗传力。然后，根据上面给出的参数，计算易感性尺度上 SNP 遗传力的数值。将最终答案表示为小数并四舍五入到四位有效数字。",
            "solution": "用户希望推导一个公式，用于将在抽样病例-对照样本中观察尺度上的 SNP 遗传力转换为易感性尺度上的遗传力，然后使用该公式计算一个数值。\n\n**问题验证**\n\n*   **第 1 步：提取已知条件**\n    *   研究设计：病例-对照。\n    *   表型：观察到的二元尺度，病例编码为 $1$，对照编码为 $0$。\n    *   模型：易感性-阈值框架。\n    *   易感性分布：$L \\sim N(0, 1)$，一个标准正态分布。\n    *   病例定义：如果个体的易感性 $L$ 超过阈值 $T$，即 $L  T$，则该个体为病例。\n    *   疾病的人群患病率：$K = 0.10$。\n    *   病例的抽样分数：$s_1 = 0.60$。\n    *   对照的抽样分数：$s_0 = 0.10$。\n    *   抽样样本中观察尺度上估计的 SNP 遗传力：$h_{\\mathrm{obs}}^{2} = 0.08$。\n    *   标准正态 CDF 为 $\\Phi(\\cdot)$，PDF 为 $\\phi(\\cdot)$。\n    *   参数为 $p$ 的伯努利随机变量的方差为 $p(1-p)$。\n\n*   **第 2 步：使用提取的已知条件进行验证**\n    *   **科学依据：** 该问题牢固地植根于统计遗传学和遗传流行病学。易感性-阈值模型是离散性状遗传分析的经典模型。在不同尺度（特别是观察尺度和易感性尺度）之间转换遗传力估计值，尤其是在病例-对照抽样的情况下，是该领域一个标准且关键的程序。使用线性混合模型（LMM）从 SNP 数据估计遗传力也是一种主流方法（例如，在 GCTA 软件中实现）。所有参数和概念都已得到公认。\n    *   **定义良好：** 这是一个定义良好的问题。它要求基于一套完整的给定参数进行公式推导和数值计算。目标明确，预期会有一个唯一且稳定的解。\n    *   **客观性：** 该问题以精确、客观、技术性的语言陈述，没有任何主观性或偏见。\n    *   **结论：** 该问题满足所有有效性标准。没有科学缺陷、歧义或信息缺失。\n\n*   **第 3 步：判断与行动**\n    *   该问题被判定为**有效**。将提供完整的解答。\n\n**推导与求解**\n\n任务是推导一个公式，将抽样病例-对照样本中在观察二元尺度上估计的遗传力 ($h_{\\mathrm{obs}}^2$) 转换为其潜在的连续易感性尺度上的遗传力 ($h_L^2$)。然后我们将使用这个公式计算 $h_L^2$ 的值。\n\n**第 1 部分：转换公式的推导**\n\n1.  **易感性-阈值模型：** 我们从易感性-阈值模型开始。一个未观察到的复杂疾病的连续易感性变量 $L$ 被假定在人群中服从标准正态分布，$L \\sim N(0, 1)$。如果个体的易感性超过某个阈值 $T$，则该个体患病（病例，$Y=1$），否则为未患病（对照，$Y=0$）。\n\n2.  **关联患病率与阈值：** 疾病的人群患病率 $K$ 是从人群中随机抽取一个个体为病例的概率。\n    $$K = P(Y=1) = P(L  T)$$\n    鉴于 $L \\sim N(0, 1)$，这个概率由 $1 - \\Phi(T)$ 给出，其中 $\\Phi(\\cdot)$ 是标准正态分布的累积分布函数 (CDF)。\n    $$K = 1 - \\Phi(T) \\implies \\Phi(T) = 1 - K$$\n    因此，阈值 $T$ 可以通过标准正态分布的 $(1-K)$ 分位数找到：\n    $$T = \\Phi^{-1}(1 - K)$$\n\n3.  **遗传力定义：** 易感性 $L$ 可以分解为遗传成分 $G$ 和环境成分 $E$，即 $L = G + E$。假设 $G$ 和 $E$ 独立，易感性的方差为 $\\mathrm{Var}(L) = \\mathrm{Var}(G) + \\mathrm{Var}(E)$。由于我们已将 $L$ 标准化使得 $\\mathrm{Var}(L) = 1$，易感性尺度上的遗传力 $h_L^2$ 定义为总易感性方差中由遗传因素引起的比例：\n    $$h_L^2 = \\frac{\\mathrm{Var}(G)}{\\mathrm{Var}(L)} = \\mathrm{Var}(G)$$\n    观察二元尺度上的遗传力 $h_{\\mathrm{obs}}^2$ 是在抽样的病例-对照样本中，观察到的 $0/1$ 表型方差中由遗传解释的比例。\n\n4.  **病例-对照抽样：** 样本不是从人群中随机抽取的，而是根据病例-对照状态进行抽样。设 $P$ 为研究样本中病例的比例。给定人群患病率 $K$以及病例 ($s_1$) 和对照 ($s_0$) 的抽样分数，$P$ 由下式给出：\n    $$P = \\frac{\\text{人群中病例的比例} \\times \\text{病例的抽样分数}}{\\text{总抽样比例}} = \\frac{K s_1}{K s_1 + (1-K)s_0}$$\n    在这个抽样样本中，二元表型的方差为 $\\mathrm{Var}(Y)_{\\text{样本}} = P(1-P)$。这与普通人群中的方差 $K(1-K)$ 不同。\n\n5.  **转换关系：** 问题指出 $h_{\\mathrm{obs}}^2$ 是使用线性混合模型 (LMM) 估计的。将此估计值转换为易感性尺度的挑战已在统计遗传学文献中得到解决。Lee 等人 (2011, Am. J. Hum. Genet. 88, 294-305) 的一项关键结果建立了病例-对照样本中基于 LMM 的遗传力估计的期望值 $\\mathbb{E}[h_{\\mathrm{obs}}^2]$ 与易感性尺度遗传力 $h_L^2$ 之间的近似关系。该关系为：\n    $$ \\mathbb{E}[h_{\\mathrm{obs}}^2] \\approx h_L^2 \\frac{P(1-P) \\phi(T)^2}{(K(1-K))^2} $$\n    此处，$\\phi(\\cdot)$ 是标准正态分布的概率密度函数 (PDF)。这个公式是通过分析在抽样条件下遗传方差如何被 LMM 改变和捕获而得出的。LMM 对病例和对照之间平均遗传差异所引起的遗传方差分量特别敏感。\n\n6.  **最终表达式：** 将观察到的估计值 $h_{\\mathrm{obs}}^2$ 视为其期望值的近似值，我们可以重新排列上述表达式来求解 $h_L^2$。这就得到了所需的转换公式：\n    $$ h_L^2 \\approx h_{\\mathrm{obs}}^2 \\frac{(K(1-K))^2}{P(1-P) \\phi(T)^2} $$\n    这个表达式使我们能够将样本中观察尺度上的遗传力转换为更基本的易感性尺度上的遗传力。\n\n**第 2 部分：数值计算**\n\n我们给定的参数如下：$K = 0.10$，$s_1 = 0.60$，$s_0 = 0.10$，以及 $h_{\\mathrm{obs}}^2 = 0.08$。\n\n1.  **计算阈值 $T$：**\n    $$\\Phi(T) = 1 - K = 1 - 0.10 = 0.90$$\n    $$T = \\Phi^{-1}(0.90) \\approx 1.28155$$\n\n2.  **计算在 $T$ 处的标准正态 PDF, $\\phi(T)$：**\n    $$\\phi(T) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{T^2}{2}\\right)$$\n    $$\\phi(1.28155) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(1.28155)^2}{2}\\right) \\approx 0.17550$$\n\n3.  **计算样本中病例的比例, $P$：**\n    $$P = \\frac{K s_1}{K s_1 + (1-K)s_0} = \\frac{(0.10)(0.60)}{(0.10)(0.60) + (1-0.10)(0.10)}$$\n    $$P = \\frac{0.06}{0.06 + (0.90)(0.10)} = \\frac{0.06}{0.06 + 0.09} = \\frac{0.06}{0.15} = 0.40$$\n\n4.  **计算必要的方差项：**\n    *   人群观察尺度方差分量：$K(1-K) = 0.10(1 - 0.10) = 0.09$。\n    *   样本观察尺度方差：$P(1-P) = 0.40(1 - 0.40) = 0.24$。\n\n5.  **将数值代入转换公式：**\n    $$h_L^2 \\approx h_{\\mathrm{obs}}^2 \\frac{(K(1-K))^2}{P(1-P) \\phi(T)^2}$$\n    $$h_L^2 \\approx 0.08 \\times \\frac{(0.09)^2}{(0.24) \\times (0.17550)^2}$$\n    $$h_L^2 \\approx 0.08 \\times \\frac{0.0081}{0.24 \\times 0.030799}$$\n    $$h_L^2 \\approx 0.08 \\times \\frac{0.0081}{0.00739176}$$\n    $$h_L^2 \\approx 0.08 \\times 1.09581$$\n    $$h_L^2 \\approx 0.087665$$\n\n6.  **最终答案：** 将结果四舍五入到四位有效数字，得到 $0.08767$。\n易感性尺度上估计的 SNP 遗传力约为 $0.08767$。",
            "answer": "$$\\boxed{0.08767}$$"
        },
        {
            "introduction": "在全基因组关联研究（GWAS）中，我们常常观察到检验统计量在全基因组范围内普遍“膨胀”的现象，即其数值系统性地高于零假设下的预期。这种膨胀可能源于真实的、由大量微效基因共同作用形成的多基因效应，也可能来自群体分层等混杂因素造成的系统性偏倚。本练习将介绍连锁不平衡分数回归（LD Score Regression, LDSC）这一前沿的统计方法，该方法巧妙地利用了全基因组的连锁不平衡信息，从而能够有效区分并量化这两种不同的膨胀来源 。通过这个实践，你将掌握从GWAS摘要统计数据中估计遗传度和评估混杂效应的关键技能。",
            "id": "4595371",
            "problem": "在一个同质人群中，对一个复杂性状进行了一项全基因组关联研究（GWAS），该研究在经过标准质量控制后使用了单核苷酸多态性（SNPs），产生了 $M$ 个独立的SNP水平关联检验。样本量为 $N$。SNP $j$ 的关联检验统计量是一个自由度为1的卡方统计量，记为 $\\chi_{j}^{2}$，由标准化的基因型和表型计算得出。分位数-分位数（Q-Q）图显示出与零假设线的偏离，这与检验统计量的膨胀（inflation）相符。为了区分这种膨胀是由真实的多基因性还是由混杂因素（例如，群体分层或隐性亲缘关系）引起的，您需要从多基因模型和连锁不平衡（LD）特性的基本原理出发进行推断，然后使用连锁不平衡分数回归（LDSC）。\n\n使用以下基本依据：\n- 在无关联且无混杂因素的原假设下，自由度为1的卡方统计量的期望值为 $1$。\n- 在一个具有许多微小独立SNP效应和标准化输入的多基因加性模型下，由SNP $j$ 标记的表型预期方差随其LD分数 $l_{j}$ 的增加而增加，其中LD分数定义为SNP $j$ 与该区域其他SNP相关系数平方的总和。这导致 $\\chi_{j}^{2}$ 的非中心性期望值随 $l_{j}$ 的增加而增加。\n- 对所有SNP影响近似一致的混杂因素，会对 $\\chi_{j}^{2}$ 的期望值产生一个不依赖于 $l_{j}$ 的加性膨胀。\n\n从这些基础出发，推导出期望 $\\chi_{j}^{2}$ 的线性分解，该分解包括一个基线、一个由多基因性引起的与 $l_{j}$ 成正比的分量，以及一个由混杂因素引起的与 $l_{j}$ 无关的分量。证明对所有SNPs进行 $\\chi_{j}^{2}$ 关于 $l_{j}$ 的普通最小二乘（OLS）回归，所估计的斜率捕捉了每单位LD分数的多基因贡献，而截距则捕捉了基线加上混杂因素。然后，使用提供的全基因组汇总样本矩，计算LDSC的截距和斜率，并根据SNP遗传力解释斜率，根据归因于混杂因素的观测膨胀分数解释截距：\n\n- SNP数量：$M = 1{,}000{,}000$。\n- 样本量：$N = 200{,}000$。\n- LD分数样本均值：$\\bar{l} = 85$。\n- LD分数样本方差：$\\operatorname{Var}(l) = 65$。\n- LD分数与卡方统计量的样本协方差：$\\operatorname{Cov}(l, \\chi^{2}) = 0.39$。\n- 卡方统计量样本均值：$\\overline{\\chi^{2}} = 1.56$。\n\n按如下方式定义您的估计值：\n- OLS斜率 $\\hat{b}$ 估计了由于多基因性，每单位LD分数导致的期望 $\\chi^{2}$ 增量。\n- OLS截距 $\\hat{a}$ 估计了当 $l_{j} = 0$ 时，期望 $\\chi^{2}$ 的基线加混杂分量。\n- 假设采用标准的LDSC识别方法，将斜率解释为 $\\hat{b} \\approx N h^{2} / M$ 来估计SNP遗传力 $h^{2}$。\n- 将截距解释为 $\\hat{a} \\approx 1 +$ 混杂因素，并计算观测到的膨胀 $\\overline{\\chi^{2}} - 1$ 中归因于混杂因素的比例，即 $(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。\n\n将您的答案四舍五入到四位有效数字。将最终结果表示为一个行矩阵，其条目依次为：LDSC截距 $\\hat{a}$、LDSC斜率 $\\hat{b}$、SNP遗传力估计值 $\\hat{h}^{2}$，以及观测到的膨胀中归因于混杂因素的比例 $(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。无需物理单位。",
            "solution": "用户提供了一个遗传流行病学问题，该问题涉及使用连锁不平衡分数回归（LDSC）解释全基因组关联研究（GWAS）的结果。问题要求推导LDSC背后的基本线性关系，然后将其应用于一组给定的汇总统计数据以估计关键参数。\n\n### 步骤1：问题验证\n\n首先，我将提取给定条件并验证问题陈述。\n\n**给定条件：**\n- 独立SNP数量：$M = 1{,}000{,}000$\n- 样本量：$N = 200{,}000$\n- SNP $j$ 的关联检验统计量：$\\chi_{j}^{2}$，一个自由度为1的卡方统计量。\n- SNP $j$ 的LD分数：$l_{j} = \\sum_{k} r_{jk}^{2}$，其中 $r_{jk}$ 是SNP $j$ 和SNP $k$ 之间的相关性。\n- 基本依据：\n    1. 在无遗传关联且无混杂因素的原假设下，检验统计量的期望值 $E[\\chi_{j}^{2}] = 1$。\n    2. 在多基因加性模型下，$\\chi_{j}^{2}$ 的期望非中心性与LD分数 $l_{j}$ 成比例增加。\n    3. 混杂因素对期望 $\\chi_{j}^{2}$ 产生一个与 $l_{j}$ 无关的加性膨胀。\n- 全基因组汇总样本矩：\n    - LD分数样本均值：$\\bar{l} = 85$\n    - LD分数样本方差：$\\operatorname{Var}(l) = 65$\n    - LD分数与卡方统计量的样本协方差：$\\operatorname{Cov}(l, \\chi^{2}) = 0.39$\n    - 卡方统计量样本均值：$\\overline{\\chi^{2}} = 1.56$\n- 所需的计算和解释：\n    - $\\chi^{2}$ 对 $l$ 进行回归得到的OLS斜率 $\\hat{b}$ 和截距 $\\hat{a}$。\n    - 使用关系式 $\\hat{b} \\approx N h^{2} / M$ 估计SNP遗传力 $\\hat{h}^{2}$。\n    - 归因于混杂因素的观测膨胀分数：$(\\hat{a} - 1) / (\\overline{\\chi^{2}} - 1)$。\n    - 最终答案四舍五入至四位有效数字。\n\n**验证：**\n- **科学依据：** 该问题牢固地基于连锁不平衡（LD）分数回归的既定原则，这是一种遗传流行病学中标准且广泛使用的统计方法。关于多基因性、混杂因素、LD分数及其与GWAS卡方统计量关系的描述是正确的，反映了该方法的基础理论。\n- **适定性：** 该问题是适定的。它要求推导一个线性模型，并使用普通最小二乘法（OLS）估计其参数。它精确地提供了计算OLS斜率和截距所必需的样本矩（$\\operatorname{Cov}(l, \\chi^2)$、$\\operatorname{Var}(l)$、$\\bar{l}$、$\\overline{\\chi^2}$）。后续解释所需的所有常数（$N$、$M$）也已提供。存在唯一解。\n- **客观性：** 该问题以精确、客观、技术性的语言陈述，没有歧义或主观性断言。\n\n**结论：**\n该问题是有效的。它科学上合理、适定、客观，并包含完整解答所需的所有信息。我将继续进行推导和计算。\n\n### 步骤2：推导与求解\n\n**LD分数回归模型的推导**\n\n问题要求推导期望 $\\chi_{j}^{2}$ 统计量的线性分解。我们从提供的基本依据出发。\n\n1.  **基线：** 在没有任何遗传效应或混杂因素的情况下，自由度为1的卡方检验统计量的期望均值为 $1$。这为我们的模型建立了基线：$E[\\chi_{j}^{2}]_{\\text{null}} = 1$。\n\n2.  **多基因性：** 问题指出，在多基因模型下，$\\chi_{j}^{2}$ 的期望非中心性随其LD分数 $l_{j}$ 的增加而增加。让我们将其形式化。对于SNP $j$，通过对标准化基因型 $G_j$ 和表型 $Y$ 进行简单线性回归得到的 $\\chi_{j}^{2}$ 统计量约为 $N \\hat{\\beta}_{j, \\text{marginal}}^{2}$，其中 $\\hat{\\beta}_{j, \\text{marginal}}$ 是估计的边际效应大小。该统计量的期望值约为 $1 + N E[\\hat{\\beta}_{j, \\text{marginal}}^{2}]$。SNP $j$ 的边际效应捕捉了其自身的因果效应 $\\beta_j$，以及所有与其处于连锁不平衡状态的其他SNP（$k$）的效应，并由相关系数 $r_{jk}$ 加权：$\\beta_{j, \\text{marginal}} \\approx \\sum_{k} r_{jk} \\beta_k$。期望的边际效应平方为 $E[\\beta_{j, \\text{marginal}}^{2}] = E[(\\sum_{k} r_{jk} \\beta_k)^2]$。假设因果效应 $\\beta_k$ 相互独立，均值为 $0$，方差为 $h^2/M$（其中 $h^2$ 是分布在 $M$ 个因果SNP上的总SNP遗传力），这可以简化为 $E[\\beta_{j, \\text{marginal}}^{2}] = \\sum_{k} r_{jk}^{2} E[\\beta_k^2] = (\\sum_{k} r_{jk}^{2}) \\frac{h^2}{M} = l_j \\frac{h^2}{M}$。因此，多基因性对期望卡方统计量的贡献是 $N l_j \\frac{h^2}{M}$。\n\n3.  **混杂因素：** 问题指出，混杂因素（例如，群体分层或隐性亲缘关系）会增加一个不依赖于LD分数 $l_j$ 的恒定膨胀项 $C$。该项对所有SNP的影响近似相等。\n\n结合这三个分量，我们得到了SNP $j$ 的卡方统计量期望值的线性模型：\n$$E[\\chi_{j}^{2}] = 1 + N \\frac{h^{2}}{M} l_{j} + C$$\n这个方程是一个形如 $E[Y_j] = a + b X_j$ 的线性模型，其中因变量是 $Y_j = \\chi_j^2$，自变量是 $X_j = l_j$。模型参数为：\n-   **斜率：** $b = \\frac{N h^{2}}{M}$。该项量化了多基因性的贡献。更高的LD分数 $l_j$ 意味着该SNP标记了更多的遗传变异，从而导致更强的预期关联信号。\n-   **截距：** $a = 1 + C$。该项捕捉了基线期望值 $1$ 加上由混杂因素引起的任何膨胀 $C$。\n\n**使用普通最小二乘法（OLS）进行估计**\n\n我们被要求对所有 $M$ 个SNP进行 $\\chi_j^2$ 对 $l_j$ 的回归：\n$$ \\chi_{j}^{2} = a + b l_{j} + \\epsilon_{j} $$\n斜率（$\\hat{b}$）和截距（$\\hat{a}$）的OLS估计量由样本矩计算得出。斜率估计量的公式为：\n$$ \\hat{b} = \\frac{\\operatorname{Cov}(l, \\chi^{2})}{\\operatorname{Var}(l)} $$\n截距估计量的公式为：\n$$ \\hat{a} = \\overline{\\chi^{2}} - \\hat{b} \\bar{l} $$\n这些估计量提供了对真实斜率 $b$ 和截距 $a$ 的估计。\n\n**数值计算**\n\n使用提供的样本矩：\n- $\\operatorname{Cov}(l, \\chi^{2}) = 0.39$\n- $\\operatorname{Var}(l) = 65$\n- $\\overline{\\chi^{2}} = 1.56$\n- $\\bar{l} = 85$\n\n首先，我们计算OLS斜率 $\\hat{b}$：\n$$ \\hat{b} = \\frac{0.39}{65} = 0.006 $$\n\n接下来，我们计算OLS截距 $\\hat{a}$：\n$$ \\hat{a} = 1.56 - (0.006 \\times 85) = 1.56 - 0.51 = 1.05 $$\n\n按要求四舍五入到四位有效数字：\n- $\\hat{b} = 0.006000$\n- $\\hat{a} = 1.050$\n\n**解释与最终计算**\n\n1.  **SNP遗传力（$h^2$）**：\n    我们使用关系式 $\\hat{b} \\approx \\frac{N h^{2}}{M}$ 来估计 $h^2$。\n    $$ \\hat{h}^{2} = \\frac{M \\hat{b}}{N} $$\n    代入 $M$、$N$ 和我们估计的 $\\hat{b}$ 的值：\n    $$ \\hat{h}^{2} = \\frac{1{,}000{,}000 \\times 0.006}{200{,}000} = \\frac{6000}{200000} = \\frac{6}{200} = 0.03 $$\n    四舍五入到四位有效数字，$\\hat{h}^2 = 0.03000$。\n\n2.  **来自混杂因素的膨胀比例**：\n    观测到的平均检验统计量的总膨胀为 $\\overline{\\chi^{2}} - 1 = 1.56 - 1 = 0.56$。\n    截距 $\\hat{a}$ 是 $1 + C$ 的估计值，其中 $C$ 是由混杂因素引起的膨胀。因此，归因于混杂因素的膨胀部分由 $\\hat{a} - 1$ 估计。\n    $$ \\text{混杂膨胀} = \\hat{a} - 1 = 1.050 - 1 = 0.050 $$\n    总观测膨胀中由混杂因素引起的部分所占的比例为：\n    $$ \\frac{\\hat{a} - 1}{\\overline{\\chi^{2}} - 1} = \\frac{0.050}{0.56} \\approx 0.0892857... $$\n    四舍五入到四位有效数字，这个比例是 $0.08929$。\n\n此分析表明，观测到的检验统计量膨胀（$\\overline{\\chi^2}=1.56$）的绝大部分是由真实的多基因信号引起的，而非混杂因素。具体来说，$1.050$ 的截距表明混杂水平适中，而非零的斜率 $0.006000$ 为多基因结构提供了强有力的证据，得出的SNP遗传力估计值为 $3\\%$。\n\n**结果总结：**\n- LDSC截距 $\\hat{a} = 1.050$\n- LDSC斜率 $\\hat{b} = 0.006000$\n- SNP遗传力估计值 $\\hat{h}^2 = 0.03000$\n- 来自混杂因素的膨胀比例 = $0.08929$\n\n这些值将被放入一个行矩阵中作为最终答案。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.050  0.006000  0.03000  0.08929 \\end{pmatrix} } $$"
        }
    ]
}