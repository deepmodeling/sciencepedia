{
    "hands_on_practices": [
        {
            "introduction": "在药物流行病学研究中，准确量化药物暴露是分析的基石。此练习将指导您使用模拟的药物配药数据来计算两种常用的依从性指标：药物拥有率（$MPR$）和覆盖天数比例（$PDC$）。通过这个过程，您将亲身体会到这两种指标在评估患者实际用药情况时的差异，并理解为何选择正确的指标对于避免暴露错分偏倚至关重要。",
            "id": "4620167",
            "problem": "一项药物流行病学的纵向队列研究考察了患者在为期180个连续日历日的固定观察窗口内（从研究第0天（含）到研究第179天（含））对每日一次降压药的依从性。该患者持续在册，并根据药房配药记录领取续配药物。每次配药提供整数天的药量，在配药当天即可获得，并在有药时以每本日历日消耗1天药量的速度服用。如果在上次药量耗尽前续配药物，剩余的药量将被储存起来，以覆盖未来的日期，直到库存耗尽。研究期间无住院日，也无剂量变化。\n\n观察窗口内的配药事件如下：\n- 研究第0天：30天药量。\n- 研究第20天：30天药量。\n- 研究第70天：30天药量。\n- 研究第120天：90天药量。\n- 研究第170天：30天药量。\n\n仅使用药物流行病学中基于续配的依从性指标的基本定义，计算这180天窗口内的药物持有率（MPR）和保障天数比例（PDC）。将两个答案均以无单位的小数形式表示，并将每个答案四舍五入至四位有效数字。然后，基于这些值，描述当使用基于续配的指标将该患者的人-时归类为“治疗中”时，对暴露错分的影响。",
            "solution": "该问题陈述是药物流行病学和药物警戒中标准方法的有效应用。该问题自成体系，有科学依据，且提法明确。我们开始解答。\n\n任务是为一个患者在固定观察窗口内计算两种依从性指标：药物持有率（MPR）和保障天数比例（PDC），并讨论其结果对暴露分类的影响。\n\n首先，我们计算MPR。MPR的定义是在指定时间间隔内配发的某一药物的总天数，除以该时间间隔的总天数。总观察期为 $N = 180$ 天（从研究第0天到研究第179天）。\n\n观察窗口内所有配药事件的总药量是每次配药量的总和：\n$$ \\text{总药量} = 30 + 30 + 30 + 90 + 30 = 210 \\text{ 天} $$\nMPR是此总药量与观察期长度的比率：\n$$ \\text{MPR} = \\frac{\\sum(\\text{天数药量})}{N} = \\frac{210}{180} = \\frac{7}{6} \\approx 1.1666... $$\n按要求，我们将此值四舍五入至四位有效数字，得到MPR为 $1.167$。\n\n接下来，我们计算PDC。PDC的定义是患者有药物覆盖的唯一天数，除以观察间隔的总天数。该指标需要逐日重构患者的药物供应情况，并考虑到提前续配造成的药物储存。观察窗口跨越第0天到第179天。\n\n1.  **第0天配药（30天药量）：** 此药量覆盖患者从第0天到第29天。\n2.  **第20天配药（30天药量）：** 在第20天，患者首次配药的药量还剩 $30 - 20 = 10$ 天。新的30天药量被储存起来。截至第20天初，手头的总药量为 $10 + 30 = 40$ 天。这合并的药量可连续覆盖患者从第20天开始的40天，即直到第 $20 + 40 - 1 = 59$ 天。因此，第一个连续覆盖期是第0天至第59天。\n3.  **第70天配药（30天药量）：** 之前的药量在第59天末耗尽。这导致在第60天至第69天出现一个为期10天的用药中断。新的药量从第70天开始，覆盖患者30天，即从第70天到第 $70 + 30 - 1 = 99$ 天。第二个连续覆盖期是第70天至第99天。\n4.  **第120天配药（90天药量）：** 之前的药量在第99天末耗尽。这导致在第100天至第119天出现第二个为期20天的用药中断。新的药量从第120天开始，覆盖患者90天，即从第120天到第 $120 + 90 - 1 = 209$ 天。这个覆盖期超出了观察窗口的结束日期（第179天）。\n5.  **第170天配药（30天药量）：** 在这次配药时，患者仍被前一次的药量所覆盖（持续到第209天）。这次新配的药量被储存起来，只在观察窗口结束后延长覆盖期。它对180天窗口*内*的覆盖天数没有贡献。\n\n在观察间隔（第0天到第179天）内，唯一的覆盖天数集合是已确定覆盖期的并集：$[0, 59] \\cup [70, 99] \\cup [120, 179]$。唯一覆盖的总天数是这些不相交区间的长度之和：\n$$ \\text{总覆盖天数} = (59 - 0 + 1) + (99 - 70 + 1) + (179 - 120 + 1) = 60 + 30 + 60 = 150 \\text{ 天} $$\nPDC是此天数与观察期长度的比率：\n$$ \\text{PDC} = \\frac{\\text{唯一覆盖天数}}{N} = \\frac{150}{180} = \\frac{5}{6} \\approx 0.8333... $$\n将此值四舍五入至四位有效数字，得到PDC为 $0.8333$。\n\n最后，我们讨论对暴露错分的影响。计算得出的 $MPR = 1.167$（即 $116.7\\%$）大于1，这可能会误导性地表明依从性完美甚至过度。如果研究人员使用MPR来定义暴露，他们可能会将该患者在整个180天期间归类为持续“治疗中”。与此形成鲜明对比的是，$PDC = 0.8333$（即 $83.3\\%$）准确地揭示了患者在180天中只有150天有药可用。它正确地识别出了30天的无药覆盖期。\n\n这种差异说明了MPR在定义暴露区间方面的根本弱点。通过简单地累加药量而不考虑配药时间和药物储存，MPR会高估依从性，并掩盖治疗中的重大中断。这会导致**暴露错分**，即非暴露期（30天的中断期）被错误地归类为暴露期。在检验药物效应的病因学研究中，这种类型的错分通常是相对于结局的非差异性错分。这种对二元暴露的错分通常会使关联度量的估计值（例如，相对风险、风险比）偏向于1.0的无效值。这可能会掩盖真实的因果关系，使得药物的危害性或益处看起来比实际要小。因此，在药物流行病学研究中，PDC是定义药物暴露期的首选且更严谨的指标，因为它提供了一个更保守、更符合临床实际的评估，从而最大限度地减少了因暴露错分而产生的偏倚。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.167 & 0.8333 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在确定了药物暴露后，下一步是估计其对健康结局的影响。本练习将引导您计算队列研究中的一个核心效应量度——发病率比（$IRR$），它用于比较暴露组和非暴露组之间事件发生的速率。更重要的是，您将学习在满足特定因果推断假设（如可交换性）的条件下，如何将这个统计关联值解释为对因果效应的估计。",
            "id": "4620065",
            "problem": "一项使用电子健康记录（EHR）的卫生系统队列研究旨在调查，与使用非选择性非甾体抗炎药（药物Y）相比，开始使用选择性环氧合酶-2抑制剂（药物X）是否会影响因上消化道出血而住院的发生率。对于新用药者，随访从治疗开始时启动，并在结局事件发生、停止治疗、转换治疗方案、失访、死亡或研究的管理性终止日期中最早发生者处结束。假设为独立删失。该研究设计包括了限制和调整，以处理已测量的混杂因素。研究者报告称，药物X组累积了2600人年，期间发生52例首次事件住院；药物Y组累积了4200人年，期间发生38例首次事件住院。两组都贡献了正值的人时，并且在任一治疗下，记录的结局都有明确的定义。从发生率的定义（即一个暴露组内单位人时内的事件计数）出发，推导比较药物X与药物Y的发生率比。在可交换性（在给定研究设计下，治疗与结局的关系不存在未测量的混杂）、正性（在研究人群的协变量水平上，接受任一治疗的概率均不为零）和一致性（每个个体在接受治疗下的观测结局等于其在该治疗下的相应潜在结局）的假设下，将此数值比率解释为因果效应的估计值。报告代表此因果效应估计值的数值。将答案四舍五入至三位有效数字，并以无单位的纯数形式表示。",
            "solution": "用户提供了一个药物流行病学问题，要求计算发生率比，并在特定假设下将其解释为因果效应。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   暴露组1（药物X）：$E_X = 52$ 例首次事件住院；$PT_X = 2600$ 人年随访。\n-   暴露组2（药物Y）：$E_Y = 38$ 例首次事件住院；$PT_Y = 4200$ 人年随访。\n-   结局：因上消化道出血住院的发生率。\n-   效应度量：比较药物X与药物Y的发生率比（IRR）。\n-   用于解释的因果假设：声明可交换性、正性和一致性均成立。\n-   删失假设：独立删失。\n-   最终要求：报告因果效应估计值的数值，四舍五入至三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在流行病学领域具有科学依据。它使用了标准定义和概念，如队列研究、人时、发生率和发生率比。其背景——比较选择性COX-2抑制剂与非选择性NSAID的胃肠道风险——是药物流行病学中的一个经典且有效的主题。\n\n该问题陈述清晰。它提供了计算所求度量（$E_X, PT_X, E_Y, PT_Y$）所需的所有数据。问题没有歧义。问题明确指出了在何种条件下，计算出的关联度量可以被解释为因果效应（可交换性、正性、一致性），这在现代流行病学中是标准做法。数据内部一致，对于一项电子健康记录研究而言是合理的。问题中没有矛盾，不依赖伪科学，措辞客观。\n\n**步骤3：结论与行动**\n该问题有效。将提供完整解答。\n\n### 解题推导\n\n需要计算的基本量是发生率（$IR$），它衡量一个群体在特定时间段内新发事件的发生情况。其定义为新发事件数除以总的风险人时。\n\n开始使用药物X的组的发生率，记为$IR_X$，由下式给出：\n$$\nIR_X = \\frac{\\text{Number of events in group X}}{\\text{Total person-time in group X}} = \\frac{E_X}{PT_X}\n$$\n使用所给数据，我们有 $E_X = 52$ 个事件和 $PT_X = 2600$ 人年。\n$$\nIR_X = \\frac{52}{2600} \\text{ 年}^{-1} = 0.02 \\text{ 年}^{-1}\n$$\n\n同样，开始使用药物Y的组的发生率，记为$IR_Y$，为：\n$$\nIR_Y = \\frac{\\text{Number of events in group Y}}{\\text{Total person-time in group Y}} = \\frac{E_Y}{PT_Y}\n$$\n使用所给数据，我们有 $E_Y = 38$ 个事件和 $PT_Y = 4200$ 人年。\n$$\nIR_Y = \\frac{38}{4200} \\text{ 年}^{-1} = \\frac{19}{2100} \\text{ 年}^{-1}\n$$\n\n问题要求计算比较药物X与药物Y的发生率比（$IRR$）。这是药物X组的发生率与药物Y组的发生率之比。\n$$\nIRR = \\frac{IR_X}{IR_Y}\n$$\n代入$IR_X$和$IR_Y$的表达式：\n$$\nIRR = \\frac{E_X / PT_X}{E_Y / PT_Y} = \\frac{52 / 2600}{38 / 4200}\n$$\n现在，我们可以代入数值来计算该比率：\n$$\nIRR = \\frac{0.02}{38 / 4200} = \\frac{0.02 \\times 4200}{38} = \\frac{84}{38} = \\frac{42}{19}\n$$\n进行除法运算得到：\n$$\nIRR \\approx 2.2105263...\n$$\n问题要求答案四舍五入到三位有效数字。前三位有效数字是$2$、$2$和$1$。第四位有效数字是$0$，小于$5$，因此我们向下舍入。\n$$\nIRR \\approx 2.21\n$$\n\n问题指出，这个数值比率应被解释为因果效应的估计值。这种解释取决于所述的假设：\n1.  **可交换性**：假设在研究设计采用限制和调整后，不存在未测量的混杂。这意味着，在给定已测协变量的条件下，药物Y组的结局风险与药物X组在假如他们接受的是药物Y（反之亦然）的情况下的结局风险相同。\n2.  **正性**：研究人群中的所有个体接受药物X或药物Y的概率都不为零。\n3.  **一致性**：个体在其实际接受的治疗下的观测结局，与其在该相同治疗下的潜在结局相同。\n\n在这三个假设下，关联性发生率比是因果发生率比的有效估计。因此，值$2.21$是估计的因果效应。这表明，开始使用药物X导致的上消化道出血住院发生率，是同一人群如果开始使用药物Y时所观察到的发生率的$2.21$倍。",
            "answer": "$$\n\\boxed{2.21}\n$$"
        },
        {
            "introduction": "观察性研究的一个固有挑战是潜在的未测量混杂，它可能扭曲研究结果。E值作为一种现代的敏感性分析工具，可以帮助我们量化一个未测量混杂因素需要多强才能完全“解释掉”我们观察到的关联。此练习将带您推导并计算E值，从而掌握一种评估研究结果稳健性的实用技能，这对于负责任地解读观察性证据至关重要。",
            "id": "4620103",
            "problem": "在一项评估一种新批准的抗高血压药物（暴露 $A$）与因高钾血症住院（结局 $Y$）风险的全国性上市后主动监测队列研究中，研究人员通过倾向性评分调整分析估计了风险比 $RR$。假设该研究报告的观察风险比 $RR=2.05$，其95%置信区间（CI）为1.31到3.20。为了评估结果对于未包含在调整集中的单个二元混杂因素 $U$ 所造成的未测量混杂的稳健性，流行病学家使用了 E 值。E 值的概念定义是：假设真实因果效应为空时，一个未测量的混杂因素要完全“解释掉”观察到的关联，该混杂因素与暴露和结局（在风险比的尺度上，并以已测量的协变量为条件）所需具有的最小关联强度。\n\n从风险比的标准定义以及一个经过充分检验的、针对单个二元未测量混杂因素在风险比尺度上的混杂偏倚界限出发，在混杂因素-结局和暴露-混杂因素的风险比均等于同一值 $R \\geq 1$ 的简化假设下，推导当观察到的 $RR>1$ 时 E 值的闭式表达式。然后，使用您推导的表达式，计算本研究中与零值最接近的置信区间限值所对应的 E 值。将您的答案四舍五入至三位有效数字。答案中不要包含单位。",
            "solution": "问题要求分两部分回答：首先，推导 E 值的闭式表达式；其次，为给定置信区间的下限计算该值。\n\n### 第一部分：E 值表达式的推导\n\nE 值量化了一个未测量混杂因素要完全“解释掉”观察到的暴露-结局关联所需的关联强度。设 $RR_{obs}$ 为观察到的风险比，在本问题中其值大于 $1$。设 $RR_{true}$ 为真实的因果风险比。在存在单个未测量因素 $U$ 混杂的情况下，观察到的风险比通过一个偏倚因子 $B$ 与真实的因果风险比相关联。完全“解释掉”观察到的关联意味着真实的因果风险比为空（$RR_{true} = 1$），并且整个观察到的效应都归因于混杂。这要求偏倚因子 $B$ 必须等于或大于观察到的风险比，即 $B \\ge RR_{obs}$。\n\n一个已充分建立的、由单个二元未测量混杂因素 $U$ 引起的偏倚因子 $B$ 的精确界限由以下公式给出：\n$$ B \\le \\frac{RR_{AU} \\cdot RR_{UY}}{RR_{AU} + RR_{UY} - 1} $$\n此处，$RR_{AU}$ 是关联暴露 $A$ 与混杂因素 $U$ 的风险比，定义为 $\\frac{P(U=1|A=1)}{P(U=1|A=0)}$（假设该比值 $\\ge 1$）。$RR_{UY}$ 是在暴露 $A$（以及任何其他已测量的协变量）为条件下，关联混杂因素 $U$ 与结局 $Y$ 的风险比。为了让混杂因素“解释掉”该关联，最大可能偏倚必须至少与观察到的风险比一样大：\n$$ RR_{obs} \\le \\frac{RR_{AU} \\cdot RR_{UY}}{RR_{AU} + RR_{UY} - 1} $$\n问题指定了简化假设，即混杂因素-暴露和混杂因素-结局的风险比相等，即 $RR_{AU} = RR_{UY} = R$，对于某个 $R \\ge 1$。将此代入不等式，得到：\n$$ RR_{obs} \\le \\frac{R^2}{2R - 1} $$\nE 值被定义为满足此条件的 $R$ 的*最小*值。为了找到这个最小值，我们求解边界条件的方程：\n$$ RR_{obs} = \\frac{R^2}{2R - 1} $$\n因为我们假设 $R \\ge 1$，分母 $2R - 1$ 是正数。我们可以将两边同乘以 $2R - 1$ 得到：\n$$ RR_{obs} (2R - 1) = R^2 $$\n将其整理成标准二次型 $aR^2+bR+c=0$ 可得：\n$$ R^2 - 2(RR_{obs})R + RR_{obs} = 0 $$\n我们使用二次求根公式 $R = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $R$，其中 $a=1$，$b=-2(RR_{obs})$，$c=RR_{obs}$：\n$$ R = \\frac{-(-2(RR_{obs})) \\pm \\sqrt{(-2(RR_{obs}))^2 - 4(1)(RR_{obs})}}{2(1)} $$\n$$ R = \\frac{2(RR_{obs}) \\pm \\sqrt{4(RR_{obs})^2 - 4(RR_{obs})}}{2} $$\n$$ R = \\frac{2(RR_{obs}) \\pm 2\\sqrt{(RR_{obs})^2 - RR_{obs}}}{2} $$\n$$ R = RR_{obs} \\pm \\sqrt{RR_{obs}^2 - RR_{obs}} $$\n$$ R = RR_{obs} \\pm \\sqrt{RR_{obs}(RR_{obs} - 1)} $$\n这给出了 $R$ 的两个潜在解。设 $f(R) = R^2 - 2(RR_{obs})R + RR_{obs}$。我们需要满足的不等式是 $\\frac{R^2}{2R - 1} \\ge RR_{obs}$，对于 $R \\ge 1$ 这等价于 $f(R) \\ge 0$。由于 $f(R)$ 是一个开口向上的抛物线，该不等式对于大于或等于较大根，或小于或等于较小根的 $R$ 值成立。\n\n问题陈述 $RR_{obs} > 1$，这确保了平方根下的项为正。我们必须选择正确的根。较小的根是 $R_1 = RR_{obs} - \\sqrt{RR_{obs}(RR_{obs} - 1)}$。我们来检查 $R_1 \\ge 1$ 是否成立。如果 $RR_{obs} - 1 \\ge \\sqrt{RR_{obs}(RR_{obs} - 1)}$，则该不等式成立。将两边平方（对于 $RR_{obs} > 1$ 两边均为正）得到 $(RR_{obs} - 1)^2 \\ge RR_{obs}(RR_{obs} - 1)$，简化后为 $RR_{obs} - 1 \\ge RR_{obs}$，即 $-1 \\ge 0$，这是一个矛盾。因此，较小的根总是小于 $1$。\n\n考虑到 $R \\ge 1$ 的约束，我们必须选择较大的根。因此，使不等式成立的最小 $R \\ge 1$ 值就是较大的根本身。这就是 E 值。\n对于观察到的风险比 $RR_{obs} > 1$，推导出的 E 值闭式表达式为：\n$$ \\text{E-value} = RR_{obs} + \\sqrt{RR_{obs}(RR_{obs} - 1)} $$\n\n### 第二部分：E 值的计算\n\n问题提供了一个观察到的风险比 $RR = 2.05$，其 $95\\%$ 置信区间（CI）为 $(1.31, 3.20)$。我们被要求计算与零值 $1$ 最接近的置信区间限值所对应的 E 值。这个限值是置信区间的下限，即 $1.31$。\n\n我们设 $RR_{obs} = 1.31$ 并使用推导出的公式：\n$$ \\text{E-value} = 1.31 + \\sqrt{1.31(1.31 - 1)} $$\n$$ \\text{E-value} = 1.31 + \\sqrt{1.31(0.31)} $$\n$$ \\text{E-value} = 1.31 + \\sqrt{0.4061} $$\n现在，我们计算数值：\n$$ \\sqrt{0.4061} \\approx 0.6372597... $$\n$$ \\text{E-value} \\approx 1.31 + 0.6372597... $$\n$$ \\text{E-value} \\approx 1.9472597... $$\n问题要求将答案四舍五入到三位有效数字。前三位有效数字是 $1$、$9$ 和 $4$。第四位数字是 $7$，大于或等于 $5$，所以我们将第三位数字向上取整。\n$$ \\text{E-value} \\approx 1.95 $$\n这个 $1.95$ 的 E 值意味着，要“解释掉”观察到的关联的置信区间下限，一个未测量的混杂因素需要在已测量协变量的基础上，与暴露和结局均具有至少为 $1.95$ 的风险比关联。",
            "answer": "$$\\boxed{1.95}$$"
        }
    ]
}