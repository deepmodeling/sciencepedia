{
    "hands_on_practices": [
        {
            "introduction": "本练习回归到最根本的层面，以建立坚实的理论基础。通过检视一个仅含截距项的逻辑斯谛回归模型，我们可以清晰地看到广义线性模型框架是如何表示一个简单的比例的。此练习  揭示了模型系数 $\\beta_0$ 与结局对数优势之间的基本联系，为从基础概率论到回归建模之间架起了一座清晰的桥梁。",
            "id": "4595227",
            "problem": "一项横断面研究从一个社区招募了 $n=100$ 名个体，并记录了每个人的二元感染结局，其中 $Y_{i}=1$ 表示个体被感染，否则 $Y_{i}=0$。假设这些结局是独立的，并且服从共同感染概率为 $p$ 的伯努利分布。研究人员使用伯努利分布和 logit 连接函数拟合了一个仅含截距项的广义线性模型 (GLM)，因此线性预测变量为 $\\eta=\\beta_{0}$，均值为 $p=\\Pr(Y_{i}=1)$，且 $g(p)=\\ln\\!\\big(p/(1-p)\\big)$。数据显示，在 $n=100$ 个个体中有 $y=30$ 例感染。\n\n从独立性假设和伯努利似然出发，推导 $p$ 的最大似然估计量，然后使用链接函数求得最大似然估计量 $\\hat{\\beta}_{0}$。用对数优势比 (log-odds) 的形式对 $\\hat{\\beta}_{0}$ 给出流行病学解释。请以使用自然对数的精确解析表达式形式给出 $\\hat{\\beta}_{0}$ 的最终答案。不要进行四舍五入。",
            "solution": "该问题要求我们从一个仅含截距项的逻辑斯谛回归模型中，为截距参数 $\\beta_0$ 推导最大似然估计量 (MLE)。该问题提供了所有必要的信息，并且在统计理论中有坚实的基础。\n\n**第1步：建立似然函数**\n我们有 $n=100$ 个独立的伯努利试验，其中有 $y=30$ 次成功（感染）。每个观测值 $Y_i$ 服从伯努利分布，其概率质量函数为 $\\Pr(Y_i=y_i) = p^{y_i} (1-p)^{1-y_i}$，其中 $y_i \\in \\{0, 1\\}$。\n由于观测值是独立的，整个样本的似然函数 $L(p)$ 是各个观测值概率的乘积：\n$$ L(p) = \\prod_{i=1}^{n} p^{y_i} (1-p)^{1-y_i} = p^{\\sum y_i} (1-p)^{n - \\sum y_i} $$\n令总感染数 $\\sum y_i = y = 30$，样本量 $n=100$，则似然函数为：\n$$ L(p) = p^{30} (1-p)^{70} $$\n\n**第2步：推导参数 $p$ 的最大似然估计量 (MLE)**\n为了找到使似然函数最大化的 $p$ 值，我们通常对对数似然函数 $\\ell(p) = \\ln L(p)$ 进行最大化，这在数学上更为简便。\n$$ \\ell(p) = \\ln(p^{30} (1-p)^{70}) = 30 \\ln(p) + 70 \\ln(1-p) $$\n对 $\\ell(p)$ 求关于 $p$ 的一阶导数，并令其等于零：\n$$ \\frac{d\\ell}{dp} = \\frac{30}{p} - \\frac{70}{1-p} = 0 $$\n求解这个方程：\n$$ \\frac{30}{p} = \\frac{70}{1-p} \\implies 30(1-p) = 70p \\implies 30 - 30p = 70p \\implies 30 = 100p $$\n因此，$p$ 的最大似然估计量 $\\hat{p}$ 为：\n$$ \\hat{p} = \\frac{30}{100} = 0.3 $$\n\n**第3步：使用链接函数计算 $\\hat{\\beta}_0$**\n模型是一个仅含截距项的逻辑斯谛回归模型，其形式为：\n$$ g(p) = \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_0 $$\n其中 $g(p)$ 是 logit 连接函数。为了找到 $\\beta_0$ 的最大似然估计量 $\\hat{\\beta}_0$，我们只需将 $p$ 的最大似然估计量 $\\hat{p}$ 代入链接函数中即可（根据 MLE 的不变性原理）。\n$$ \\hat{\\beta}_0 = \\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right) = \\ln\\left(\\frac{0.3}{1-0.3}\\right) = \\ln\\left(\\frac{0.3}{0.7}\\right) = \\ln\\left(\\frac{3}{7}\\right) $$\n\n**第4步：流行病学解释**\n在流行病学中，$\\frac{p}{1-p}$ 被定义为事件（在此为感染）的“优势”（odds）。因此，$\\ln\\left(\\frac{p}{1-p}\\right)$ 是“对数优势”（log-odds）。$\\hat{\\beta}_0$ 的值 $\\ln(3/7)$ 是根据数据估计出的该社区人群中感染的对数优势。这意味着，在该社区中，一个人被感染的优势（相对于未被感染）的估计值是 $3/7$。\n\n最终答案是以自然对数表示的精确解析表达式：$\\ln(3/7)$。",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{3}{7}\\right)}\n$$"
        },
        {
            "introduction": "在流行病学中，逻辑斯谛回归最常见的应用之一是估计暴露与疾病之间的关联。然而，逻辑斯谛模型中的系数直接给出的是对数优势比，而流行病学家通常更感兴趣的是风险比。本练习  提供了从单个模型中计算这两种关键指标的实践经验，突显了它们之间的重要区别以及从一种转换到另一种所需的计算。",
            "id": "4595204",
            "problem": "一项队列研究旨在探讨一个二元暴露 $X \\in \\{0,1\\}$ 与一个二元结局 $Y \\in \\{0,1\\}$ 之间的关联。该结局采用一个带有 logit 连接函数的广义线性模型 (GLM) 进行建模，因此对于每个 $x \\in \\{0,1\\}$，其风险满足 $\\operatorname{logit}(p(x))=\\beta_{0}+\\beta_{1} x$，其中 $p(x)=\\Pr(Y=1 \\mid X=x)$ 且 $\\operatorname{logit}(p)=\\ln\\!\\big(p/(1-p)\\big)$。假设在未暴露时，基线风险为 $p(0)=p_{0}=0.2$，并且拟合得到的暴露的 logit 系数为 $\\beta_{1}=0.8$。请仅使用优势、优势比和反 logit 变换的定义，计算：\n- 在该模型下，比较 $X=1$ 与 $X=0$ 的暴露优势比，以及\n- 在该模型下，比较 $p(1)$ 与 $p(0)$ 的风险比。\n\n报告这两个数值，保留四位有效数字。将您的最终答案表示为（优势比，风险比）顺序的行矩阵。无需单位。",
            "solution": "该问题要求根据一个给定的、针对二元暴露和二元结局的逻辑斯谛回归模型，计算优势比和风险比。该问题提法恰当，有科学依据，并为求得唯一解提供了所有必要信息。\n\n风险 $p(x)=\\Pr(Y=1 \\mid X=x)$ 的模型由一个带有 logit 连接函数的广义线性模型给出：\n$$ \\operatorname{logit}(p(x)) = \\beta_{0}+\\beta_{1} x $$\n其中 $x \\in \\{0,1\\}$。logit 函数定义为 $\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)$。给定的参数是基线风险 $p(0) = 0.2$ 和暴露的 logit 系数 $\\beta_{1} = 0.8$。\n\n### 第一部分：计算优势比 (OR)\n\n对于给定的风险 $p$，事件的优势 (odds) 定义为事件发生的概率与不发生的概率之比。对于暴露水平 $x$，其优势为：\n$$ O(x) = \\frac{p(x)}{1-p(x)} $$\n优势比 ($OR$) 比较的是暴露组 ($X=1$) 中结局的优势与非暴露组 ($X=0$) 中结局的优势：\n$$ OR = \\frac{O(1)}{O(0)} = \\frac{p(1)/(1-p(1))}{p(0)/(1-p(0))} $$\n从 logit 函数的定义中，我们可以看出 $\\operatorname{logit}(p(x))$ 是优势 $O(x)$ 的自然对数：\n$$ \\operatorname{logit}(p(x)) = \\ln\\left(\\frac{p(x)}{1-p(x)}\\right) = \\ln(O(x)) $$\n因此，给定的逻辑斯谛模型可以写作对数优势 (log-odds) 的形式：\n$$ \\ln(O(x)) = \\beta_{0}+\\beta_{1} x $$\n对于暴露组 ($x=1$)，对数优势为：\n$$ \\ln(O(1)) = \\beta_{0}+\\beta_{1}(1) = \\beta_{0}+\\beta_{1} $$\n对于非暴露组 ($x=0$)，对数优势为：\n$$ \\ln(O(0)) = \\beta_{0}+\\beta_{1}(0) = \\beta_{0} $$\n优势比的自然对数可以通过计算两组对数优势之差来求得：\n$$ \\ln(OR) = \\ln\\left(\\frac{O(1)}{O(0)}\\right) = \\ln(O(1)) - \\ln(O(0)) $$\n代入模型中的表达式：\n$$ \\ln(OR) = (\\beta_{0}+\\beta_{1}) - \\beta_{0} = \\beta_{1} $$\n这证明了逻辑斯谛回归的一个基本性质：对于二元暴露变量，其系数 $\\beta_1$ 就是对数优势比。为了求得优势比本身，我们对系数 $\\beta_1$ 进行指数运算：\n$$ OR = \\exp(\\beta_{1}) $$\n已知 $\\beta_{1} = 0.8$，则优势比为：\n$$ OR = \\exp(0.8) \\approx 2.2255409 $$\n保留四位有效数字，我们得到：\n$$ OR \\approx 2.226 $$\n\n### 第二部分：计算风险比 (RR)\n\n风险比 ($RR$)，也称为相对风险，是暴露组中结局的风险与非暴露组中结局的风险之比：\n$$ RR = \\frac{p(1)}{p(0)} $$\n我们已知基线风险 $p(0) = 0.2$。为了计算风险比，我们必须首先确定暴露组的风险 $p(1)$。\n\n我们可以使用给定的基线风险 $p(0)$ 来求出截距参数 $\\beta_0$ 的值。如前所示，$\\ln(O(0)) = \\beta_0$。\n$$ \\beta_{0} = \\ln(O(0)) = \\ln\\left(\\frac{p(0)}{1-p(0)}\\right) = \\ln\\left(\\frac{0.2}{1-0.2}\\right) = \\ln\\left(\\frac{0.2}{0.8}\\right) = \\ln(0.25) $$\n现在，我们可以求出暴露组的对数优势 $\\ln(O(1))$：\n$$ \\ln(O(1)) = \\beta_{0} + \\beta_{1} = \\ln(0.25) + 0.8 $$\n为了从对数优势 $\\ln(O(1))$ 求出风险 $p(1)$，我们使用题目要求的反 logit 变换。如果 $\\eta = \\operatorname{logit}(p) = \\ln(p/(1-p))$，那么解出 $p$ 可得 $p = \\frac{\\exp(\\eta)}{1+\\exp(\\eta)}$。\n令 $\\eta_1 = \\ln(O(1)) = \\ln(0.25) + 0.8$。风险 $p(1)$ 为：\n$$ p(1) = \\frac{\\exp(\\eta_1)}{1+\\exp(\\eta_1)} = \\frac{\\exp(\\ln(0.25) + 0.8)}{1+\\exp(\\ln(0.25) + 0.8)} $$\n使用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们有：\n$$ p(1) = \\frac{\\exp(\\ln(0.25)) \\cdot \\exp(0.8)}{1 + \\exp(\\ln(0.25)) \\cdot \\exp(0.8)} = \\frac{0.25 \\cdot \\exp(0.8)}{1 + 0.25 \\cdot \\exp(0.8)} $$\n代入数值 $\\exp(0.8) \\approx 2.2255409$：\n$$ p(1) \\approx \\frac{0.25 \\times 2.2255409}{1 + 0.25 \\times 2.2255409} = \\frac{0.5563852}{1.5563852} \\approx 0.3574883 $$\n现在我们可以计算风险比了：\n$$ RR = \\frac{p(1)}{p(0)} \\approx \\frac{0.3574883}{0.2} \\approx 1.7874415 $$\n保留四位有效数字，我们得到：\n$$ RR \\approx 1.787 $$\n所求的两个值是优势比（约 $2.226$）和风险比（约 $1.787$）。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.226  1.787 \\end{pmatrix}}$$"
        },
        {
            "introduction": "真实世界的数据很少能完美地拟合我们的模型；计数数据的一个常见问题是“过度离散”，即观测到的方差大于泊松模型的预测值。本练习  深入探讨了这一实际挑战，展示了如何使用拟似然方法估计过度离散的程度。您将推导出这个离散参数 $\\phi$ 是如何被用来修正估计系数的标准误的，这是进行有效统计推断的关键一步。",
            "id": "4595174",
            "problem": "一项关于 $n$ 个社区诊所每周流感样病例计数的研究，使用广义线性模型 (GLM) 对诊所 $i$ 的病例数 $Y_i$ 进行建模。该模型采用对数连接函数和泊松均值结构，并通过拟似然法来考虑潜在的过度离散。具体来说，模型假设均值 $\\mu_i$ 满足 $\\ln(\\mu_i) = \\beta_0 + \\beta_1 x_i$，其中 $x_i$ 是一个诊所级别的协变量，且方差遵循 $\\operatorname{Var}(Y_i) = \\phi V(\\mu_i)$，其中方差函数为 $V(\\mu) = \\mu$，离散参数为 $\\phi$。拟合后的模型得到的残差偏离度为 $D = 150$，残差自由度为 $\\text{df} = 100$。\n\n请从偏离度（定义为拟合模型与饱和模型之间对数似然比的两倍）的定义出发，并利用拟似然下广义线性模型的大样本性质，推导离散参数 $\\phi$ 的一个估计量。然后，推导 $\\phi \\neq 1$ 的存在如何相对于朴素泊松情况，修正了估计回归系数的方差-协方差矩阵，并进而修正标准误。利用所提供的 $D$ 和 $\\text{df}$ 值，计算由于过度离散而应用于朴素泊松标准误的乘性膨胀因子，并以闭式表达式报告此因子。不要进行数值近似；请提供一个无单位的精确表达式。",
            "solution": "该问题提法严谨，并且在广义线性模型 (GLM) 和拟似然理论中有坚实的科学基础。我们可以进行形式化推导。\n\n问题要求基于一个针对计数数据 $Y_i$ 的广义线性模型进行三项推导，该模型的均值为 $\\mu_i$，方差为 $\\operatorname{Var}(Y_i) = \\phi \\mu_i$。模型结构由 $\\ln(\\mu_i) = \\eta_i = \\mathbf{x}_i^T \\boldsymbol{\\beta}$ 给出，其中 $\\mathbf{x}_i$ 是观测值 $i$ 的协变量向量，$\\boldsymbol{\\beta}$ 是回归系数向量。对于本问题，$\\eta_i = \\beta_0 + \\beta_1 x_i$。\n\n**第1部分：离散参数 $\\phi$ 估计量的推导**\n\n问题指出我们应该从偏离度的定义出发。对于一个广义线性模型，（未缩放的）偏离度定义为 $D(\\mathbf{y}; \\hat{\\boldsymbol{\\mu}}) = 2 \\phi (l(\\mathbf{y}; \\mathbf{y}) - l(\\hat{\\boldsymbol{\\mu}}; \\mathbf{y}))$，其中 $l$ 分别是饱和模型和拟合模型的对数似然函数。在拟似然的背景下，分布形式没有完全指定，只假设了均值-方差关系 $\\operatorname{Var}(Y_i) = \\phi V(\\mu_i)$，离散参数 $\\phi$ 通常被视为一个讨厌参数。\n\nGLM 理论中的一个核心结果是，对于大样本，经缩放的偏离度，定义为 $D^*(\\mathbf{y}; \\hat{\\boldsymbol{\\mu}}) = D(\\mathbf{y}; \\hat{\\boldsymbol{\\mu}}) / \\phi$，近似服从卡方分布，其自由度等于模型的残差自由度。残差自由度，记为 $\\text{df}$，是观测数 $n$ 减去估计的参数个数 $p$。\n$$ \\frac{D}{\\phi} \\sim \\chi^2_{\\text{df}} $$\n自由度为 $\\text{df}$ 的卡方分布的期望值就是 $\\text{df}$。因此，对上式取期望，我们得到：\n$$ E\\left[\\frac{D}{\\phi}\\right] \\approx \\text{df} $$\n由于 $\\phi$ 是一个常数，这意味着：\n$$ E[D] \\approx \\phi \\cdot \\text{df} $$\n这个关系为 $\\phi$ 的矩法估计量提供了基础。通过将偏离度的期望值 $E[D]$ 替换为其观测值 $D$，我们可以求解出 $\\phi$ 的一个估计，记为 $\\hat{\\phi}$。\n$$ \\hat{\\phi} = \\frac{D}{\\text{df}} $$\n这是拟似然模型中离散参数的一个常用估计量。它基于残差偏离度。类似的估计量也可以用皮尔逊卡方统计量推导出来。\n\n**第2部分：方差-协方差矩阵和标准误的修正**\n\n在 GLM 中，回归系数 $\\boldsymbol{\\beta}$ 的估计通常通过迭代重加权最小二乘法 (IRLS) 完成，该方法求解拟得分方程。估计系数的方差-协方差矩阵 $\\operatorname{Cov}(\\hat{\\boldsymbol{\\beta}})$ 由费雪信息矩阵的逆给出，在拟似然框架下为：\n$$ \\operatorname{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n其中 $\\mathbf{X}$ 是模型的设计矩阵，$\\mathbf{W}$ 是一个对角权重矩阵。$\\mathbf{W}$ 的每个对角元素 $W_{ii}$ 由下式给出：\n$$ W_{ii} = \\frac{1}{\\operatorname{Var}(Y_i)} \\left( \\frac{d\\mu_i}{d\\eta_i} \\right)^2 $$\n在本题中，我们给定的方差结构为 $\\operatorname{Var}(Y_i) = \\phi V(\\mu_i) = \\phi \\mu_i$。连接函数是自然对数，$g(\\mu_i) = \\ln(\\mu_i) = \\eta_i$。反连接函数是 $\\mu_i = \\exp(\\eta_i)$。均值相对于线性预测变量的导数是：\n$$ \\frac{d\\mu_i}{d\\eta_i} = \\frac{d}{d\\eta_i} \\exp(\\eta_i) = \\exp(\\eta_i) = \\mu_i $$\n将这些表达式代入权重的公式，我们得到：\n$$ W_{ii} = \\frac{1}{\\phi \\mu_i} (\\mu_i)^2 = \\frac{\\mu_i}{\\phi} $$\n因此，权重矩阵为 $\\mathbf{W} = \\frac{1}{\\phi} \\mathbf{W}_{\\text{naive}}$，其中 $\\mathbf{W}_{\\text{naive}}$ 是一个对角矩阵，其元素为 $(W_{\\text{naive}})_{ii} = \\mu_i$。这个 $\\mathbf{W}_{\\text{naive}}$ 是标准泊松 GLM 中会使用的权重矩阵，它隐含地假设了 $\\phi=1$。\n\n我们的拟泊松模型的方差-协方差矩阵是：\n$$ \\operatorname{Cov}_Q(\\hat{\\boldsymbol{\\beta}}) = \\left(\\mathbf{X}^T \\left(\\frac{1}{\\phi} \\mathbf{W}_{\\text{naive}}\\right) \\mathbf{X}\\right)^{-1} = \\left(\\frac{1}{\\phi} \\mathbf{X}^T \\mathbf{W}_{\\text{naive}} \\mathbf{X}\\right)^{-1} $$\n使用矩阵恒等式 $(cA)^{-1} = c^{-1}A^{-1}$，我们得到：\n$$ \\operatorname{Cov}_Q(\\hat{\\boldsymbol{\\beta}}) = \\phi \\left(\\mathbf{X}^T \\mathbf{W}_{\\text{naive}} \\mathbf{X}\\right)^{-1} $$\n$(\\mathbf{X}^T \\mathbf{W}_{\\text{naive}} \\mathbf{X})^{-1}$ 这一项恰好是朴素泊松模型的方差-协方差矩阵，我们称之为 $\\operatorname{Cov}_P(\\hat{\\boldsymbol{\\beta}})$。\n$$ \\operatorname{Cov}_Q(\\hat{\\boldsymbol{\\beta}}) = \\phi \\cdot \\operatorname{Cov}_P(\\hat{\\boldsymbol{\\beta}}) $$\n这表明估计系数的整个方差-协方差矩阵被一个因子 $\\phi$ 膨胀了。\n\n单个系数估计（比如 $\\hat{\\beta}_j$）的标准误 (SE) 是方差-协方差矩阵对应对角元素的平方根。\n$$ \\text{SE}(\\hat{\\beta}_j) = \\sqrt{[\\operatorname{Cov}(\\hat{\\boldsymbol{\\beta}})]_{jj}} $$\n因此，拟泊松模型的标准误 $\\text{SE}_Q(\\hat{\\beta}_j)$ 与朴素泊松模型的标准误 $\\text{SE}_P(\\hat{\\beta}_j)$ 的关系如下：\n$$ \\text{SE}_Q(\\hat{\\beta}_j) = \\sqrt{[\\phi \\cdot \\operatorname{Cov}_P(\\hat{\\boldsymbol{\\beta}})]_{jj}} = \\sqrt{\\phi} \\sqrt{[\\operatorname{Cov}_P(\\hat{\\boldsymbol{\\beta}})]_{jj}} = \\sqrt{\\phi} \\cdot \\text{SE}_P(\\hat{\\beta}_j) $$\n因此，过度离散 ($\\phi > 1$) 或低度离散 ($\\phi  1$) 的存在，会通过一个乘性因子 $\\sqrt{\\phi}$ 来修正朴素模型的标准误。\n\n**第3部分：乘性膨胀因子的计算**\n\n问题从拟合模型中提供了以下值：\n- 残差偏离度 $D = 150$。\n- 残差自由度 $\\text{df} = 100$。\n\n使用第1部分推导的 $\\phi$ 的估计量，我们可以计算出一个估计值 $\\hat{\\phi}$：\n$$ \\hat{\\phi} = \\frac{D}{\\text{df}} = \\frac{150}{100} = \\frac{3}{2} $$\n应用于朴素泊松标准误的乘性膨胀因子是 $\\sqrt{\\hat{\\phi}}$。我们使用我们的估计值计算这个因子：\n$$ \\text{膨胀因子} = \\sqrt{\\hat{\\phi}} = \\sqrt{\\frac{3}{2}} $$\n这就是为了解释观测到的过度离散而使标准误增加的因子的精确闭式表达式。",
            "answer": "$$\\boxed{\\sqrt{\\frac{3}{2}}}$$"
        }
    ]
}