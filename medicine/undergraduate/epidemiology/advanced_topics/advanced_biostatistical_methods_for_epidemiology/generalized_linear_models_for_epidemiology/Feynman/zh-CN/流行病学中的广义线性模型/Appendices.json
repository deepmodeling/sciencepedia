{
    "hands_on_practices": [
        {
            "introduction": "广义线性模型 (GLM) 是一个强大的框架，它统一并扩展了许多我们熟悉的统计方法。本练习旨在揭示最简单的流行病学度量——比例——如何被视为一个 GLM 。通过为一个仅含截距项的伯努利模型推导最大似然估计，您将理解截距项 $\\beta_0$ 在流行病学上作为成功对数优势（log-odds）的深刻含义。",
            "id": "4595227",
            "problem": "一项横断面研究从一个社区招募了 $n=100$ 名个体，并记录了每个人的二元感染结局，其中 $Y_{i}=1$ 表示个体已感染，$Y_{i}=0$ 表示未感染。假定这些结局是相互独立的，并且服从共同感染概率为 $p$ 的伯努利分布。研究人员使用伯努利分布和 logit 连接函数拟合了一个仅含截距的广义线性模型 (GLM)，因此线性预测变量为 $\\eta=\\beta_{0}$，均值为 $p=\\Pr(Y_{i}=1)$，连接函数为 $g(p)=\\ln\\!\\big(p/(1-p)\\big)$。数据显示，$n=100$ 人中有 $y=30$ 人感染。\n\n从独立性假设和伯努利似然出发，推导出 $p$ 的最大似然估计量，然后使用连接函数得到最大似然估计量 $\\hat{\\beta}_{0}$。请用对数优势比 (log-odds) 来对 $\\hat{\\beta}_{0}$ 给出流行病学解释。请以使用自然对数的精确解析表达式形式给出 $\\hat{\\beta}_{0}$ 的最终答案，不要四舍五入。",
            "solution": "该问题要求我们为仅含截距项的伯努利-逻辑斯蒂广义线性模型 (GLM) 推导截距项 $\\beta_0$ 的最大似然估计 (MLE)。\n\n**1. 建立似然函数**\n\n给定 $n$ 个独立同分布的伯努利试验 $Y_1, \\dots, Y_n$，其中每个 $Y_i \\sim \\text{Bernoulli}(p)$。似然函数是所有观测结果的联合概率：\n$$ L(p; \\mathbf{y}) = \\prod_{i=1}^{n} P(Y_i=y_i) = \\prod_{i=1}^{n} p^{y_i} (1-p)^{1-y_i} $$\n其中 $y_i \\in \\{0, 1\\}$。该式可以简化为：\n$$ L(p; y) = p^{\\sum y_i} (1-p)^{n - \\sum y_i} $$\n令 $y = \\sum y_i$ 为总感染人数。在本问题中，$n=100$，$y=30$。\n\n**2. 推导参数 $p$ 的最大似然估计**\n\n为了简化计算，我们使用对数似然函数 $\\ell(p) = \\ln L(p; y)$：\n$$ \\ell(p) = \\ln\\left( p^y (1-p)^{n-y} \\right) = y \\ln(p) + (n-y) \\ln(1-p) $$\n为了找到使 $\\ell(p)$ 最大化的 $p$ 值，我们对 $p$ 求一阶导数，并令其等于零：\n$$ \\frac{d\\ell}{dp} = \\frac{y}{p} - \\frac{n-y}{1-p} = 0 $$\n求解 $p$：\n$$ \\frac{y}{p} = \\frac{n-y}{1-p} \\implies y(1-p) = p(n-y) \\implies y - yp = np - yp \\implies y = np $$\n因此，$p$ 的最大似然估计为 $\\hat{p} = \\frac{y}{n}$。\n代入数据，$y=30$，$n=100$，我们得到：\n$$ \\hat{p} = \\frac{30}{100} = 0.3 $$\n\n**3. 推导截距项 $\\beta_0$ 的最大似然估计**\n\n模型使用 logit 连接函数，其定义为 $g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$。对于仅含截距的模型，线性预测变量为 $\\eta = \\beta_0$，因此我们有：\n$$ \\beta_0 = g(p) = \\ln\\left(\\frac{p}{1-p}\\right) $$\n根据最大似然估计的不变性原理，参数的函数的最大似然估计等于其估计值的函数。因此，$\\beta_0$ 的最大似然估计 $\\hat{\\beta}_0$ 是通过将 $\\hat{p}$ 代入连接函数得到的：\n$$ \\hat{\\beta}_0 = g(\\hat{p}) = \\ln\\left(\\frac{\\hat{p}}{1-\\hat{p}}\\right) $$\n将 $\\hat{p}=0.3$ 代入：\n$$ \\hat{\\beta}_0 = \\ln\\left(\\frac{0.3}{1-0.3}\\right) = \\ln\\left(\\frac{0.3}{0.7}\\right) = \\ln\\left(\\frac{3}{7}\\right) $$\n\n**4. 流行病学解释**\n\n表达式 $\\frac{p}{1-p}$ 是事件（在此为感染）发生的“优势”(odds)。因此，$\\beta_0$ 是感染的对数优势 (log-odds)。其最大似然估计 $\\hat{\\beta}_0 = \\ln(3/7)$ 代表了在该社区样本中观察到的感染的经验对数优势。这个值本身量化了感染风险的对数尺度。",
            "answer": "$$\n\\boxed{\\ln\\left(\\frac{3}{7}\\right)}\n$$"
        },
        {
            "introduction": "在流行病学中，回归模型的主要价值在于量化暴露与结局之间的关联强度。本练习将聚焦于逻辑回归模型，演示如何从模型系数中直接获得优势比 (Odds Ratio)，并进一步计算风险比 (Risk Ratio) 。通过这个过程，您将掌握解读模型参数的关键技能，并理解这两个重要效应度量之间的区别。",
            "id": "4595204",
            "problem": "一项队列研究调查了二元暴露 $X \\in \\{0,1\\}$ 与二元结局 $Y \\in \\{0,1\\}$ 之间的关联。该结局使用具有 logit 连接的广义线性模型 (GLM) 进行建模，因此对于每个 $x \\in \\{0,1\\}$，其风险满足 $\\operatorname{logit}(p(x))=\\beta_{0}+\\beta_{1} x$，其中 $p(x)=\\Pr(Y=1 \\mid X=x)$ 且 $\\operatorname{logit}(p)=\\ln\\!\\big(p/(1-p)\\big)$。假设未暴露时的基线风险为 $p(0)=p_{0}=0.2$，并且拟合的暴露 logit 系数为 $\\beta_{1}=0.8$。仅使用优势、优势比和逆-logit 变换的定义，计算：\n- 在此模型下，比较 $X=1$ 与 $X=0$ 的暴露优势比，以及\n- 在此模型下，比较 $p(1)$ 与 $p(0)$ 的风险比。\n\n报告两个数值，均四舍五入至四位有效数字。以行矩阵的形式表示您的最终答案，顺序为（优势比，风险比）。无需单位。",
            "solution": "该问题要求根据给定的针对二元暴露和二元结局的逻辑斯蒂回归模型，计算优势比和风险比。该问题陈述清晰，具有科学依据，并为获得唯一解提供了所有必要信息。\n\n风险模型 $p(x)=\\Pr(Y=1 \\mid X=x)$ 由一个具有 logit 连接函数的广义线性模型给出：\n$$ \\operatorname{logit}(p(x)) = \\beta_{0}+\\beta_{1} x $$\n其中 $x \\in \\{0,1\\}$。logit 函数定义为 $\\operatorname{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)$。给定的参数是基线风险 $p(0) = 0.2$ 和暴露的 logit 系数 $\\beta_{1} = 0.8$。\n\n### 第一部分：计算优势比 (OR)\n\n对于给定的风险 $p$，事件的优势定义为事件发生的概率与不发生的概率之比。对于暴露水平 $x$，其优势为：\n$$ O(x) = \\frac{p(x)}{1-p(x)} $$\n优势比 ($OR$) 比较的是暴露组 ($X=1$) 的结局优势与未暴露组 ($X=0$) 的结局优势：\n$$ OR = \\frac{O(1)}{O(0)} = \\frac{p(1)/(1-p(1))}{p(0)/(1-p(0))} $$\n从 logit 函数的定义中，我们可以看出 $\\operatorname{logit}(p(x))$ 是优势 $O(x)$ 的自然对数：\n$$ \\operatorname{logit}(p(x)) = \\ln\\left(\\frac{p(x)}{1-p(x)}\\right) = \\ln(O(x)) $$\n因此，给定的逻辑斯蒂模型可以写成对数优势的形式：\n$$ \\ln(O(x)) = \\beta_{0}+\\beta_{1} x $$\n对于暴露组 ($x=1$)，对数优势为：\n$$ \\ln(O(1)) = \\beta_{0}+\\beta_{1}(1) = \\beta_{0}+\\beta_{1} $$\n对于未暴露组 ($x=0$)，对数优势为：\n$$ \\ln(O(0)) = \\beta_{0}+\\beta_{1}(0) = \\beta_{0} $$\n优势比的自然对数可以通过计算两组对数优势的差值得到：\n$$ \\ln(OR) = \\ln\\left(\\frac{O(1)}{O(0)}\\right) = \\ln(O(1)) - \\ln(O(0)) $$\n代入模型中的表达式：\n$$ \\ln(OR) = (\\beta_{0}+\\beta_{1}) - \\beta_{0} = \\beta_{1} $$\n这证明了逻辑斯蒂回归的一个基本性质：二元暴露变量的系数 $\\beta_1$ 是对数优势比。为了求出优势比本身，我们对系数 $\\beta_1$ 取指数：\n$$ OR = \\exp(\\beta_{1}) $$\n已知 $\\beta_{1} = 0.8$，优势比为：\n$$ OR = \\exp(0.8) \\approx 2.2255409 $$\n四舍五入到四位有效数字，我们得到：\n$$ OR \\approx 2.226 $$\n\n### 第二部分：计算风险比 (RR)\n\n风险比 ($RR$)，也称为相对风险，是暴露组中结局风险与未暴露组中结局风险之比：\n$$ RR = \\frac{p(1)}{p(0)} $$\n我们已知基线风险 $p(0) = 0.2$。为了计算风险比，我们必须首先确定暴露组的风险 $p(1)$。\n\n我们可以使用给定的基线风险 $p(0)$ 来求出截距参数 $\\beta_0$ 的值。如前所示，$\\ln(O(0)) = \\beta_0$。\n$$ \\beta_{0} = \\ln(O(0)) = \\ln\\left(\\frac{p(0)}{1-p(0)}\\right) = \\ln\\left(\\frac{0.2}{1-0.2}\\right) = \\ln\\left(\\frac{0.2}{0.8}\\right) = \\ln(0.25) $$\n现在，我们可以求出暴露组的对数优势 $\\ln(O(1))$：\n$$ \\ln(O(1)) = \\beta_{0} + \\beta_{1} = \\ln(0.25) + 0.8 $$\n为了从对数优势 $\\ln(O(1))$ 中求出风险 $p(1)$，我们使用题目要求的逆-logit 变换。如果 $\\eta = \\operatorname{logit}(p) = \\ln(p/(1-p))$，那么求解 $p$ 可得 $p = \\frac{\\exp(\\eta)}{1+\\exp(\\eta)}$。\n设 $\\eta_1 = \\ln(O(1)) = \\ln(0.25) + 0.8$。风险 $p(1)$ 为：\n$$ p(1) = \\frac{\\exp(\\eta_1)}{1+\\exp(\\eta_1)} = \\frac{\\exp(\\ln(0.25) + 0.8)}{1+\\exp(\\ln(0.25) + 0.8)} $$\n使用属性 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们有：\n$$ p(1) = \\frac{\\exp(\\ln(0.25)) \\cdot \\exp(0.8)}{1 + \\exp(\\ln(0.25)) \\cdot \\exp(0.8)} = \\frac{0.25 \\cdot \\exp(0.8)}{1 + 0.25 \\cdot \\exp(0.8)} $$\n代入数值 $\\exp(0.8) \\approx 2.2255409$：\n$$ p(1) \\approx \\frac{0.25 \\times 2.2255409}{1 + 0.25 \\times 2.2255409} = \\frac{0.5563852}{1.5563852} \\approx 0.3574883 $$\n现在我们可以计算风险比：\n$$ RR = \\frac{p(1)}{p(0)} \\approx \\frac{0.3574883}{0.2} \\approx 1.7874415 $$\n四舍五入到四位有效数字，我们得到：\n$$ RR \\approx 1.787 $$\n所求的两个值分别是优势比（约为 $2.226$）和风险比（约为 $1.787$）。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.226  1.787 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在学习了 GLM 的构成和结果解读后，我们自然会好奇统计软件是如何找到最佳的模型系数的。本练习将带您一窥 GLM 的“引擎”——迭代重加权最小二乘法 (IRLS) 算法的内部工作原理 。通过为一个简单数据集计算初始的“工作响应”和“权重”，您将对模型如何逐步迭代优化其估计值获得具体而深入的理解。",
            "id": "4595198",
            "problem": "一位流行病学家正在使用逻辑均值-方差结构，为一个二元疾病结局拟合广义线性模型。考虑独立的伯努利结果 $Y_i \\in \\{0,1\\}$，其具有单个标准化预测变量 $x_i$ 和典则 logit 链接。该模型设定为无截距项，$g(\\mu_i) = \\eta_i = \\beta x_i$，其中 $g(\\mu) = \\ln\\!\\big(\\mu/(1-\\mu)\\big)$，$\\mu_i = \\mathbb{E}[Y_i \\mid x_i]$，且 $\\beta \\in \\mathbb{R}$ 是待估计的系数。两个观测值分别为 $(x_1 = 1, y_1 = 1)$ 和 $(x_2 = -1, y_2 = 0)$。请使用广义线性模型的核心定义、伯努利似然、典则链接和费雪评分法 (Fisher scoring)，推导迭代加权最小二乘法 (IRLS) 在以 $\\beta^{(0)} = 0$ 为初值进行第一次迭代时所使用的工作响应 $z$ 和对角权重 $w$。然后，计算在 $\\beta^{(0)}$ 时这些数据的对应数值。将最终结果以单行矩阵的形式提供，按顺序包含 $z_1$、$z_2$、$w_1$、$w_2$。无需四舍五入。",
            "solution": "该问题要求为逻辑回归模型计算迭代重加权最小二乘法 (IRLS) 算法第一次迭代中的工作响应和权重。\n\n**1. IRLS 框架概述**\nIRLS 算法通过迭代求解一系列加权最小二乘问题来找到 GLM 的最大似然估计。在每次迭代 $t$ 中，更新系数 $\\boldsymbol{\\beta}$ 的步骤等价于对“工作响应”（或称“调整后的因变量”） $\\mathbf{z}^{(t)}$ 进行加权线性回归，权重由对角矩阵 $\\mathbf{W}^{(t)}$ 给出。\n\n工作响应 $z_i$ 和权重 $w_i$ 的通用定义为：\n$$ z_i = \\eta_i + (y_i - \\mu_i) \\frac{d\\eta_i}{d\\mu_i} $$\n$$ w_i = \\left( \\left(\\frac{d\\eta_i}{d\\mu_i}\\right)^2 \\operatorname{Var}(Y_i) \\right)^{-1} $$\n其中 $\\eta_i$ 是线性预测变量，$\\mu_i$ 是均值响应，$\\operatorname{Var}(Y_i)$ 是方差。\n\n**2. 针对伯努利-Logit 模型的具体化**\n对于本问题中的逻辑回归模型：\n- **随机成分**：$Y_i \\sim \\text{Bernoulli}(\\mu_i)$，因此方差为 $\\operatorname{Var}(Y_i) = \\mu_i(1-\\mu_i)$。\n- **连接函数**：典则 logit 连接 $\\eta_i = g(\\mu_i) = \\ln(\\frac{\\mu_i}{1-\\mu_i})$。\n\n我们需要计算连接函数对其参数的导数 $\\frac{d\\eta_i}{d\\mu_i}$：\n$$ \\frac{d\\eta_i}{d\\mu_i} = \\frac{d}{d\\mu_i} \\left( \\ln(\\mu_i) - \\ln(1-\\mu_i) \\right) = \\frac{1}{\\mu_i} + \\frac{1}{1-\\mu_i} = \\frac{1-\\mu_i + \\mu_i}{\\mu_i(1-\\mu_i)} = \\frac{1}{\\mu_i(1-\\mu_i)} $$\n\n现在将此导数代入工作响应和权重的通用公式中：\n- **工作响应 $z_i$**：\n$$ z_i = \\eta_i + (y_i - \\mu_i) \\left( \\frac{1}{\\mu_i(1-\\mu_i)} \\right) = \\eta_i + \\frac{y_i - \\mu_i}{\\mu_i(1-\\mu_i)} $$\n- **权重 $w_i$**：\n$$ w_i = \\left( \\left(\\frac{1}{\\mu_i(1-\\mu_i)}\\right)^2 \\cdot \\mu_i(1-\\mu_i) \\right)^{-1} = \\left( \\frac{1}{\\mu_i(1-\\mu_i)} \\right)^{-1} = \\mu_i(1-\\mu_i) $$\n这是一个简洁的结果：对于典则 logit 连接，权重恰好是伯努利响应的方差。\n\n**3. 计算第一次迭代的值**\n迭代从初始值 $\\beta^{(0)} = 0$ 开始。\n- **步骤 1：计算线性预测变量 $\\eta_i^{(0)}$**\n  模型为 $\\eta_i = \\beta x_i$。\n  对于观测值 1 ($x_1=1$)：$\\eta_1^{(0)} = \\beta^{(0)} x_1 = 0 \\times 1 = 0$。\n  对于观测值 2 ($x_2=-1$)：$\\eta_2^{(0)} = \\beta^{(0)} x_2 = 0 \\times (-1) = 0$。\n\n- **步骤 2：计算均值响应 $\\mu_i^{(0)}$**\n  均值是线性预测变量的逆连接函数，即逻辑斯谛函数：$\\mu_i = \\frac{1}{1+e^{-\\eta_i}}$。\n  由于 $\\eta_1^{(0)} = \\eta_2^{(0)} = 0$，两个观测值的初始均值响应相同：\n  $$ \\mu_1^{(0)} = \\mu_2^{(0)} = \\frac{1}{1+e^{-0}} = \\frac{1}{1+1} = \\frac{1}{2} $$\n\n- **步骤 3：计算权重 $w_i$**\n  使用公式 $w_i = \\mu_i(1-\\mu_i)$：\n  $$ w_1 = w_2 = \\mu_1^{(0)}(1-\\mu_1^{(0)}) = \\frac{1}{2}\\left(1-\\frac{1}{2}\\right) = \\frac{1}{4} $$\n\n- **步骤 4：计算工作响应 $z_i$**\n  使用公式 $z_i = \\eta_i + \\frac{y_i - \\mu_i}{w_i}$：\n  对于观测值 1 ($y_1=1$)：\n  $$ z_1 = \\eta_1^{(0)} + \\frac{y_1 - \\mu_1^{(0)}}{w_1} = 0 + \\frac{1 - \\frac{1}{2}}{\\frac{1}{4}} = \\frac{\\frac{1}{2}}{\\frac{1}{4}} = 2 $$\n  对于观测值 2 ($y_2=0$)：\n  $$ z_2 = \\eta_2^{(0)} + \\frac{y_2 - \\mu_2^{(0)}}{w_2} = 0 + \\frac{0 - \\frac{1}{2}}{\\frac{1}{4}} = \\frac{-\\frac{1}{2}}{\\frac{1}{4}} = -2 $$\n\n**4. 最终结果**\n在第一次迭代开始时（即在 $\\beta^{(0)}=0$ 处进行评估），工作响应和权重的值为：\n$z_1 = 2$\n$z_2 = -2$\n$w_1 = \\frac{1}{4}$\n$w_2 = \\frac{1}{4}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  -2  \\frac{1}{4}  \\frac{1}{4}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}