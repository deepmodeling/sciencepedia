{
    "hands_on_practices": [
        {
            "introduction": "在评估因果关系时，第一步往往是量化暴露与结局之间关联的强度。本练习旨在通过计算流行病学中三种核心的效应量指标——风险差（$RD$）、风险比（$RR$）和比值比（$OR$），来实践布拉德福德·希尔准则中的“强度”标准。通过这个计算，你将学会如何从原始数据中提炼出这些关键指标，并理解在不同基线风险背景下，如何解读关联强度对因果推断的意义 。",
            "id": "4574269",
            "problem": "一项关于某暴露与二分类结局的队列研究，其数据由一个$2\\times 2$列联表总结，格子计数如下：暴露组病例 $=120$，暴露组非病例 $=480$，非暴露组病例 $=30$，非暴露组非病例 $=570$。从风险是组内发生结局的概率、比值是发生结局的概率与不发生结局的概率之比这两个基本流行病学定义出发，仅使用这些计数来推导和计算风险差（RD）、风险比（RR）和比值比（OR）。然后，在每种度量尺度上解释Bradford Hill准则中的关联“强度”，说明每种关联强度的大小对因果效应的合理性意味着什么，并论证当基线风险在不同亚组中变化时，哪种尺度对诊断因果关系最具价值。\n\n将计算出的每个指标（$RD$、$RR$ 和 $OR$）四舍五入至四位有效数字。将$RD$表示为不带百分号的小数（例如，$0.05$），并将$RR$和$OR$表示为无单位的比率。按$RD$、$RR$、$OR$的顺序，将最终的数值三元组以单行矩阵的形式给出。",
            "solution": "基本量由$2\\times 2$列联表的计数导出。设暴露组总人数为$n_{1} = 120 + 480$，非暴露组总人数为$n_{0} = 30 + 570$。暴露组的风险，记为$p_{1}$，是在暴露人群中成为病例的概率，计算方法是暴露组病例数除以暴露组总人数。同样，非暴露组的风险，记为$p_{0}$，是在非暴露人群中成为病例的概率。各组的比值定义为风险除以（1减去风险）。\n\n计算各组总人数：\n$$\nn_{1} = 120 + 480 = 600, \\quad n_{0} = 30 + 570 = 600.\n$$\n计算风险：\n$$\np_{1} = \\frac{120}{600} = 0.2, \\quad p_{0} = \\frac{30}{600} = 0.05.\n$$\n计算风险差 (RD)：\n$$\nRD = p_{1} - p_{0} = 0.2 - 0.05 = 0.15.\n$$\n计算风险比 (RR)：\n$$\nRR = \\frac{p_{1}}{p_{0}} = \\frac{0.2}{0.05} = 4.\n$$\n计算各组的比值。暴露组的比值$o_{1}$为\n$$\no_{1} = \\frac{p_{1}}{1 - p_{1}} = \\frac{0.2}{0.8} = \\frac{120}{480} = 0.25,\n$$\n非暴露组的比值$o_{0}$为\n$$\no_{0} = \\frac{p_{0}}{1 - p_{0}} = \\frac{0.05}{0.95} = \\frac{30}{570} = \\frac{1}{19} \\approx 0.0526315789.\n$$\n因此，比值比 (OR) 为\n$$\nOR = \\frac{o_{1}}{o_{0}} = \\frac{0.25}{1/19} = 0.25 \\times 19 = \\frac{19}{4} = 4.75.\n$$\n\n将每个指标四舍五入至四位有效数字，得到：\n$$\nRD = 0.1500, \\quad RR = 4.000, \\quad OR = 4.750.\n$$\n\n根据Bradford Hill准则对“强度”的解释，核心在于关联的大小及其对因果推断的意义。一个较大的关联强度不太可能完全由残余混杂或偏倚来解释，尽管它不是因果关系的决定性证据。在绝对尺度上，$RD = 0.15$表示因暴露导致结局发生的概率增加了$0.15$；考虑到基线风险$p_{0} = 0.05$，这一绝对差异在公共卫生方面是显著的。在相对尺度上，$RR = 4$表示暴露组的风险是非暴露组的四倍，这是一种强关联。$OR = 4.75$同样表示强关联，但其数值上大于$RR$，因为该结局并非罕见事件，并且随着患病率的增加，比值比会偏离风险比。\n\n关于在存在基线风险异质性的情况下，哪种尺度对诊断因果关系最有价值，关键是要考虑当基线风险在不同亚组间变化时，每种度量指标的表现如何。风险差对基线风险高度敏感：即使在恒定的乘性因果效应下，$RD$也会随$p_{0}$变化，这使得跨层比较可能产生误导，并且在基线风险不同时，为“强度”提供的证据也不够稳定。比值比是不可合并的，这意味着即使在没有混杂的情况下，它也可能随分层而改变，并且随着结局患病率的上升，它倾向于夸大相对于风险比的大小，这使得在异质性基线上的解释变得复杂。相比之下，风险比是可合并的，并且在流行病学中常见的乘性因果结构下通常更稳定；当基线风险变化时，它提供了一个更易于解释和比较的跨层“强度”度量。因此，在存在基线风险异质性的情况下，风险比通常是评估Bradford Hill框架中“强度”准则最具诊断价值的尺度，同时要认识到因果推断需要与其他准则（如时序性、剂量-反应关系、一致性和特异性）进行三角验证，并排除其他可能的解释。\n\n按$RD$、$RR$、$OR$的顺序，最终的数值三元组为\n$$\n\\begin{pmatrix}\n0.1500  4.000  4.750\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.1500  4.000  4.750\\end{pmatrix}}$$"
        },
        {
            "introduction": "一个强有力的因果关系证据，往往表现为随着暴露剂量的增加，结局风险也呈现出规律性的变化，这就是“剂量-反应关系”准则。本练习将带你超越直观判断，学习如何使用Cochran-Armitage趋势检验这一统计学工具，来量化地评估暴露剂量与疾病风险之间是否存在线性趋势。这个实践将帮助你掌握验证剂量-反应关系的形式化方法，为因果推断提供更坚实的统计学支持 。",
            "id": "4574335",
            "problem": "一项队列研究检验了一个有序分类暴露，该暴露根据剂量递增分为四个四分位数。在每个四分位数中，有 $n_{i} = 500$ 名参与者，观察到的二元不良结局的风险分别为 $0.05$、$0.08$、$0.12$ 和 $0.20$（对应于 $i = 1,2,3,4$）。为了正式评估 Bradford Hill 准则中的剂量-反应梯度，请计算跨有序四分位数的 Cochran–Armitage 趋势检验（CATT）的标准化检验统计量，假设暴露评分为等间距的 $w_{i} = 1, 2, 3, 4$。请以最简根式的形式给出该标准化统计量的精确封闭形式解析表达式。然后，基于假设检验的基本原理和 Bradford Hill 因果推断准则中的剂量-反应考量，解释观察到的梯度是否支持因果关系。\n\n将最终的标准化 Cochran–Armitage 趋势检验统计量表示为精确的解析表达式。不要四舍五入。无需单位。",
            "solution": "Bradford Hill 因果推断准则包括剂量-反应（生物学梯度）的考量：如果风险随着暴露的增加而单调增加，这支持（但不能证明）因果关系。在统计学上，评估二元结局在有序暴露类别中是否存在单调梯度的一个可靠方法是 Cochran–Armitage 趋势检验（CATT），该检验测试的是结局概率在分配给有序类别的评分上不存在线性趋势的原假设。\n\n基本原理：\n- 对于每组 $i$，观察到的病例数 $x_{i}$ 和总人数 $n_{i}$ 定义了经验风险 $p_{i} = x_{i}/n_{i}$。\n- 对于 $k$ 个有序组，合并风险为 $p = \\left(\\sum_{i=1}^{k} x_{i}\\right) / \\left(\\sum_{i=1}^{k} n_{i}\\right)$。\n- 在有序组上给定固定评分 $w_{i}$，CATT 构建了一个线性统计量\n$$\nT = \\sum_{i=1}^{k} w_{i} \\left(x_{i} - n_{i} p\\right),\n$$\n在无线性趋势的原假设下，其方差为\n$$\n\\operatorname{Var}(T) = p(1-p) \\sum_{i=1}^{k} n_{i} \\left(w_{i} - \\bar{w}\\right)^{2}, \\quad \\text{其中} \\quad \\bar{w} = \\frac{\\sum_{i=1}^{k} n_{i} w_{i}}{\\sum_{i=1}^{k} n_{i}}。\n$$\n标准化检验统计量为\n$$\nZ = \\frac{T}{\\sqrt{\\operatorname{Var}(T)}}.\n$$\n\n我们有 $k=4$ 个有序四分位数，各组样本量相等，$n_{1} = n_{2} = n_{3} = n_{4} = 500$，风险分别为 $p_{1} = 0.05$，$p_{2} = 0.08$，$p_{3} = 0.12$，$p_{4} = 0.20$。暴露评分是等间距的：$w_{1} = 1$，$w_{2} = 2$，$w_{3} = 3$，$w_{4} = 4$。\n\n根据风险计算病例数：\n$$\nx_{1} = 500 \\times 0.05 = 25, \\quad x_{2} = 500 \\times 0.08 = 40, \\quad x_{3} = 500 \\times 0.12 = 60, \\quad x_{4} = 500 \\times 0.20 = 100.\n$$\n总病例数和总样本量：\n$$\n\\sum_{i=1}^{4} x_{i} = 25 + 40 + 60 + 100 = 225, \\quad \\sum_{i=1}^{4} n_{i} = 4 \\times 500 = 2000.\n$$\n合并风险：\n$$\np = \\frac{225}{2000} = \\frac{9}{80}.\n$$\n计算评分的加权平均值：\n$$\n\\bar{w} = \\frac{\\sum_{i=1}^{4} n_{i} w_{i}}{\\sum_{i=1}^{4} n_{i}} = \\frac{500(1+2+3+4)}{2000} = \\frac{500 \\times 10}{2000} = \\frac{5}{2}.\n$$\n\n计算 $T$：\n首先，计算每组的 $n_{i} p$：$n_{i} p = 500 \\times \\frac{9}{80} = \\frac{500 \\times 9}{80} = \\frac{4500}{80} = \\frac{225}{4} = 56.25$。\n因此，\n$$\nx_{1} - n_{1} p = 25 - \\frac{225}{4} = -\\frac{125}{4}, \\quad\nx_{2} - n_{2} p = 40 - \\frac{225}{4} = -\\frac{65}{4}, \\quad\nx_{3} - n_{3} p = 60 - \\frac{225}{4} = \\frac{15}{4}, \\quad\nx_{4} - n_{4} p = 100 - \\frac{225}{4} = \\frac{175}{4}.\n$$\n乘以评分并求和：\n$$\nT = 1\\left(-\\frac{125}{4}\\right) + 2\\left(-\\frac{65}{4}\\right) + 3\\left(\\frac{15}{4}\\right) + 4\\left(\\frac{175}{4}\\right)\n= \\frac{-125 - 130 + 45 + 700}{4}\n= \\frac{490}{4}\n= \\frac{245}{2}.\n$$\n\n计算 $\\operatorname{Var}(T)$：\n首先计算评分偏差的平方，\n$$\n(1 - \\tfrac{5}{2})^{2} = \\left(-\\tfrac{3}{2}\\right)^{2} = \\tfrac{9}{4}, \\quad\n(2 - \\tfrac{5}{2})^{2} = \\left(-\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\n(3 - \\tfrac{5}{2})^{2} = \\left(\\tfrac{1}{2}\\right)^{2} = \\tfrac{1}{4}, \\quad\n(4 - \\tfrac{5}{2})^{2} = \\left(\\tfrac{3}{2}\\right)^{2} = \\tfrac{9}{4}.\n$$\n按相等的 $n_{i}$ 加权求和：\n$$\n\\sum_{i=1}^{4} n_{i} \\left(w_{i} - \\bar{w}\\right)^{2} = 500\\left(\\tfrac{9}{4} + \\tfrac{1}{4} + \\tfrac{1}{4} + \\tfrac{9}{4}\\right) = 500 \\times \\tfrac{20}{4} = 500 \\times 5 = 2500.\n$$\n计算 $p(1-p)$：\n$$\np(1-p) = \\frac{9}{80}\\left(1 - \\frac{9}{80}\\right) = \\frac{9}{80} \\cdot \\frac{71}{80} = \\frac{639}{6400}.\n$$\n因此，\n$$\n\\operatorname{Var}(T) = \\frac{639}{6400} \\times 2500 = \\frac{639 \\times 2500}{6400} = \\frac{639 \\times 25}{64} = \\frac{15975}{64}.\n$$\n\n标准化统计量：\n$$\nZ = \\frac{T}{\\sqrt{\\operatorname{Var}(T)}} = \\frac{\\frac{245}{2}}{\\sqrt{\\frac{15975}{64}}} = \\frac{\\frac{245}{2}}{\\frac{\\sqrt{15975}}{8}} = \\frac{245}{2} \\cdot \\frac{8}{\\sqrt{15975}} = \\frac{980}{\\sqrt{15975}}.\n$$\n这就是精确的封闭形式表达式。\n\n相对于 Bradford Hill 剂量-反应准则的解释：\n有序风险 $0.05, 0.08, 0.12, 0.20$ 显示出随着暴露四分位数的增加而明显的单调递增。大的标准化趋势统计量 $Z = \\frac{980}{\\sqrt{15975}}$ 在标准正态近似下对应一个非常小的双侧尾概率，这表明有强有力的统计学证据支持结局风险在不同暴露类别间存在正向线性趋势。这个具有统计学显著性的单调梯度支持 Bradford Hill 准则中的生物学梯度考量，从而加强了暴露与结局之间存在因果关系的论证。然而，与所有 Bradford Hill 准则的考量一样，仅有梯度并不能确定因果关系；必须对混杂、偏倚以及其他替代解释进行评估和排除。",
            "answer": "$$\\boxed{\\frac{980}{\\sqrt{15975}}}$$"
        },
        {
            "introduction": "在观察性研究中，一个强烈的关联也可能完全由未测量的混杂因素造成，因此对结果的稳健性进行评估至关重要。本练习介绍了一个现代流行病学中的重要工具——E值（E-value），它用于量化一个关联在多大程度上能够抵抗潜在的未测量混杂。通过计算点估计和置信区间下限的E值，你将学会如何评估研究结果的可靠性，从而更深刻地理解希尔准则中“强度”标准的实际应用局限与量化评估方法 。",
            "id": "4574397",
            "problem": "一项观察性队列研究报告了某二元暴露与某二元结局之间的关联，调整后的风险比 (RR) 为 $RR=2.4$，其 95% 置信区间 (CI) 为 $1.3$ 到 $4.4$。为评估 Bradford Hill 关联强度准则中关于对未测量混杂稳健性的方面，请使用 E 值的概念。E 值定义为：在已测量协变量的条件下，一个未测量的混杂因素需要同时与暴露和结局都具有的、在风险比尺度上的最小关联强度，该强度足以完全解释掉观察到的关联（点估计 E 值），或足以使置信区间的相应限值移动到包含无效值 1（区间限 E 值）。\n\n从以下基本事实出发：\n- 风险比 $RR$ 定义为风险之比 $RR = \\frac{P(Y=1 \\mid A=1)}{P(Y=1 \\mid A=0)}$。\n- 对于单个未测量的二元混杂因素 $U$，在测量协变量的条件下，且风险比尺度上的关联具有正性和单调性时，给定暴露与混杂因素之间的风险比关联 $RR_{EU}$ 以及混杂因素与结局之间的风险比关联 $RR_{UY}$，风险比尺度上的最大可能偏倚因子 $B$ 的上界为\n$$\nB \\leq \\frac{RR_{EU} \\, RR_{UY}}{RR_{EU} + RR_{UY} - 1},\n$$\n- E 值被定义为满足 $x \\geq 1$ 的最小值 $x$，使得当设定 $RR_{EU} = RR_{UY} = x$ 时，产生的偏倚因子 $B$ 等于观察到的目标值（点估计 $RR$ 或相关的置信限）。\n\n基于这些基础，推导 E 值作为通用风险比 $r>1$ 函数的闭式表达式，然后计算：\n1) 使用 $r=2.4$ 时的点估计 E 值。\n2) 使用 95% 置信下限 $r=1.3$ 时的区间限 E 值。\n\n将两个 E 值都四舍五入到四位有效数字。将你的最终答案以一个无单位的行矩阵形式报告，其中点 E 值在前，区间限 E 值在后。此外，在你的解题过程中，简要解释这些 E 值对于观察到的关联在 Bradford Hill 强度准则意义下对未测量混杂的稳健性意味着什么。",
            "solution": "首先，我们为一个观察到的风险比 $r > 1$ 推导E值的通用公式。根据定义，E值是一个未测量的混杂因素必须同时与暴露和结局关联的最小强度 $x$ ($RR_{EU} = RR_{UY} = x$)，该强度足以将观察到的关联 $r$ 完全解释为偏倚。我们将偏倚因子 $B$ 设为等于目标风险比 $r$：\n$$\nr = B = \\frac{x^2}{2x - 1}\n$$\n重新整理得到一个关于 $x$ 的二次方程：$x^2 - 2rx + r = 0$。\n使用二次公式求解此方程，并选择满足 $x \\geq 1$ 的解，我们得到E值作为风险比 $r>1$ 的函数的闭式表达式：\n$$\nE(r) = r + \\sqrt{r^2 - r}\n$$\n现在，我们计算所要求的两个E值。\n\n1) **点估计E值**：使用观察到的风险比 $r = RR = 2.4$。\n$$\nE_{\\text{point}} = 2.4 + \\sqrt{(2.4)^2 - 2.4} = 2.4 + \\sqrt{3.36} \\approx 4.2330\n$$\n四舍五入到四位有效数字，点估计E值为 $4.233$。\n\n2) **区间限E值**：使用置信区间的下限 $r = 1.3$，来评估将置信区间移动到包含无效值$1.0$所需的混杂强度。\n$$\nE_{\\text{limit}} = 1.3 + \\sqrt{(1.3)^2 - 1.3} = 1.3 + \\sqrt{0.39} \\approx 1.924499...\n$$\n四舍五入到四位有效数字，区间限E值为 $1.924$。\n\n**解释**：这些E值在Bradford Hill“强度”准则的背景下量化了结果的稳健性。\n- 点估计E值为 $4.233$，意味着一个未测量的混杂因素需要与暴露和结局都具有至少为 $4.233$ 的风险比关联，才能完全解释掉观察到的 $2.4$ 的风险比。这是一个相当强的混杂效应，如果认为这样的混杂因素不太可能存在，那么该关联的点估计是相对稳健的。\n- 区间限E值为 $1.924$，意味着一个与暴露和结局都具有至少为 $1.924$ 的风险比关联的混杂因素，就足以将95%置信区间的下限移动到无效值1.0。这是一个中等强度的混杂效应，表明该结果的统计显著性对未测量混杂的稳健性较弱。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.233  1.924 \\end{pmatrix}}\n$$"
        }
    ]
}