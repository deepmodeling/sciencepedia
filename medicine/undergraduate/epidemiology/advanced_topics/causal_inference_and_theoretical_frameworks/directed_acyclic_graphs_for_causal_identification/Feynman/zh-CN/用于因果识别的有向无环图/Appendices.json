{
    "hands_on_practices": [
        {
            "introduction": "正确识别开放路径和阻塞路径是利用有向无环图（DAG）进行因果推断的基石。本练习聚焦于这项基本技能。通过分析一个包含混杂和中介的常见因果结构，你将练习应用d-分离规则，观察对不同类型变量（如混杂因素、中介因素）进行条件化如何改变暴露与结局之间的关联路径。这项练习  有助于你掌握DAG分析的核心机制。",
            "id": "4587645",
            "problem": "考虑一个流行病学情境，其中包含暴露 $E$、中介变量 $M$、结局 $Y$，以及一个暴露前同时影响 $E$ 和 $Y$ 的共同原因 $C$。构建一个有向无环图（DAG），其边为 $E \\to M \\to Y$ 和 $E \\leftarrow C \\to Y$。假设不存在其他变量或边，也没有选择或测量过程。\n\n使用 $d$-分离的形式化概念，判断在以下每个条件集下，$E$ 和 $Y$ 之间的哪些路径是开放的：无变量（空集）、仅 $\\{C\\}$、仅 $\\{M\\}$，以及 $\\{C, M\\}$。对于每个条件集，在您的解题过程中定性地列出所有开放路径，但最终答案只需报告每种条件情景下的开放路径数量。\n\n答案规格：\n- 以四元行向量的形式提供开放路径的数量，顺序为：无变量、$\\{C\\}$、$\\{M\\}$、$\\{C,M\\}$。\n- 最终答案必须是单个整数行向量。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于使用有向无环图（DAG）进行因果推断的原理，问题设定良好，有唯一且可验证的解，并以客观、形式化的语言陈述。\n\n该问题描述了一个包含四个变量的系统：暴露 $E$、中介变量 $M$、结局 $Y$ 和一个共同原因（混杂因素） $C$。这些关系以一组有向边的形式给出：$C \\to E$、$C \\to Y$、$E \\to M$ 和 $M \\to Y$。因此，相应的有向无环图（DAG）由节点 $\\{E, M, Y, C\\}$ 和代表这些因果影响的边构成。\n\n任务是识别暴露 $E$ 和结局 $Y$ 之间的所有路径，并根据 $d$-分离的规则，确定在不同的条件集下，这些路径是开放的还是被阻断的。路径是连接两个变量的一系列边，不考虑箭头的方向。\n\n首先，我们在指定的图中识别 $E$ 和 $Y$ 之间的所有路径。存在两条这样的路径：\n1.  路径 1：$E \\to M \\to Y$。这是一条从 $E$ 到 $Y$ 的有向因果路径，由 $M$ 所中介。\n2.  路径 2：$E \\leftarrow C \\to Y$。这是一条由共同原因 $C$ 产生的从 $E$ 到 $Y$ 的非因果“后门”路径。\n\n接下来，我们应用 $d$-分离规则来确定在每个给定的条件集 $S$ 下，每条路径的状态（开放或被阻断）。如果一条路径包含一个在集合 $S$ 中的非对撞节点，或者包含一个不在 $S$ 中且在 $S$ 中没有后代的对撞节点，那么该路径就被 $S$ 阻断。反之，如果一条路径未被阻断，则它是开放的。\n\n-   路径上的一个节点如果是“链”，则箭头首尾相接（例如，$\\to Z \\to$）。通过对中间节点 $Z$ 进行条件化，可以阻断链。\n-   路径上的一个节点如果是“分叉”，则箭头从该节点发出（例如，$\\leftarrow Z \\to$）。通过对中间节点 $Z$ 进行条件化，可以阻断分叉。\n-   路径上的一个节点如果是“对撞”，则箭头首首相接（例如，$\\to Z \\leftarrow$）。对撞节点默认会阻断路径。对对撞节点本身或其后代进行条件化，会打开该路径。\n\n在我们的图中，路径 1（$E \\to M \\to Y$）是穿过 $M$ 的一条链。路径 2（$E \\leftarrow C \\to Y$）是在 $C$ 处的一个分叉。在 $E$ 和 $Y$ 之间的任何路径上都没有对撞节点。\n\n我们现在为每个指定的条件集分析这些路径：\n\n1.  **条件集 $S = \\emptyset$（无变量）**\n    -   **路径 1（$E \\to M \\to Y$）：**此路径是穿过 $M$ 的一条链。由于中间节点 $M$ 不在条件集 $S = \\emptyset$ 中，该路径是**开放**的。\n    -   **路径 2（$E \\leftarrow C \\to Y$）：**此路径是在 $C$ 处的一个分叉。由于分叉节点 $C$ 不在条件集 $S = \\emptyset$ 中，该路径是**开放**的。\n    -   **总开放路径数：**$2$。开放路径为 $E \\to M \\to Y$ 和 $E \\leftarrow C \\to Y$。\n\n2.  **条件集 $S = \\{C\\}$**\n    -   **路径 1（$E \\to M \\to Y$）：**此路径是穿过 $M$ 的一条链。中间节点 $M$ 不在条件集 $S = \\{C\\}$ 中。因此，该路径保持**开放**。\n    -   **路径 2（$E \\leftarrow C \\to Y$）：**此路径是在 $C$ 处的一个分叉。分叉节点 $C$ 在条件集 $S = \\{C\\}$ 中。因此，该路径被**阻断**。\n    -   **总开放路径数：**$1$。唯一的开放路径是 $E \\to M \\to Y$。\n\n3.  **条件集 $S = \\{M\\}$**\n    -   **路径 1（$E \\to M \\to Y$）：**此路径是穿过 $M$ 的一条链。中间节点 $M$ 在条件集 $S = \\{M\\}$ 中。因此，该路径被**阻断**。\n    -   **路径 2（$E \\leftarrow C \\to Y$）：**此路径是在 $C$ 处的一个分叉。分叉节点 $C$ 不在条件集 $S = \\{M\\}$ 中。因此，该路径保持**开放**。\n    -   **总开放路径数：**$1$。唯一的开放路径是 $E \\leftarrow C \\to Y$。\n\n4.  **条件集 $S = \\{C, M\\}$**\n    -   **路径 1（$E \\to M \\to Y$）：**此路径是穿过 $M$ 的一条链。中间节点 $M$ 在条件集 $S = \\{C, M\\}$ 中。因此，该路径被**阻断**。\n    -   **路径 2（$E \\leftarrow C \\to Y$）：**此路径是在 $C$ 处的一个分叉。分叉节点 $C$ 在条件集 $S = \\{C, M\\}$ 中。因此，该路径被**阻断**。\n    -   **总开放路径数：**$0$。两条路径均被阻断。\n\n综上所述，对于条件集 $\\emptyset$、$\\{C\\}$、$\\{M\\}$ 和 $\\{C,M\\}$，$E$ 和 $Y$ 之间的开放路径数量分别为 $2$、$1$、$1$ 和 $0$。该问题要求以四元行向量的形式提供这些计数。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1  1  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一旦我们使用DAG确定了必要的调整变量，就可以从图形理论转向定量估计。这个实践问题将后门调整公式应用于一个实际的流行病学场景。你将使用提供的观测数据来计算经混杂调整后的因果风险差，从而将抽象的路径阻断概念转化为具体的数值答案 ，体验如何估计干预措施的实际效果。",
            "id": "4587606",
            "problem": "考虑一项关于传染病的研究，其中二元暴露$E$表示是否接受了预防性干预（如果接受则$E=1$，否则$E=0$），二元结局$Y$表示30天内是否新发感染（如果感染则$Y=1$，否则$Y=0$），二元协变量$Z$表示基线时是否存在高合并症负担（高负担则$Z=1$，低负担则$Z=0$）。其因果结构由一个有向无环图（DAG）表示，其中$Z$有指向$E$和$Y$的箭头，$E$有指向$Y$的箭头。假设不存在$E$和$Y$的其他共同原因，所有变量的测量都没有误差，并且满足以下条件：给定$Z$的条件可交换性、一致性和正值性。\n\n研究估计出以下数值：\n- $p(Z=1)=0.4$ 且 $p(Z=0)=0.6$。\n- $p(Y=1\\mid E=1,Z=0)=0.25$ 且 $p(Y=1\\mid E=1,Z=1)=0.60$。\n- $p(Y=1\\mid E=0,Z=0)=0.10$ 且 $p(Y=1\\mid E=0,Z=1)=0.50$。\n\n在所描述的DAG下，使用$Z$作为有效的后门调整集来识别$E$对$Y$的因果效应，计算经后门调整的因果风险差$E[Y\\mid \\mathrm{do}(E=1)]-E[Y\\mid \\mathrm{do}(E=0)]$。请用小数表示您的最终答案（不加百分号）。提供精确值，无需四舍五入。",
            "solution": "该问题要求计算经后门调整的因果风险差，其定义为$E[Y\\mid \\mathrm{do}(E=1)] - E[Y\\mid \\mathrm{do}(E=0)]$。该问题被验证为是合理的、适定的，并包含了所有必要信息。\n\n因果结构由一个有向无环图（DAG）描述，其中协变量$Z$是暴露$E$和结局$Y$的共同原因。具体而言，因果路径为$Z \\rightarrow E$、$Z \\rightarrow Y$和$E \\rightarrow Y$。路径$E \\leftarrow Z \\rightarrow Y$是一条“后门路径”，因为它是$E$和$Y$之间的一条非因果路径，其起始于一个指向$E$的箭头。为了估计$E$对$Y$的因果效应，必须阻断这条后门路径。问题陈述$Z$是一个有效的后门调整集。这与后门准则一致，因为$Z$不是$E$的后代，并且以$Z$为条件可以阻断路径$E \\leftarrow Z \\rightarrow Y$。\n\n条件可交换性、一致性和正值性的假设，以及指定的DAG，使得我们可以从提供的观测数据中识别出因果效应。我们可以使用后门调整公式（也称为标准化或g-公式）来计算潜在结局均值$E[Y \\mid \\mathrm{do}(E=e)]$。对于二元结局$Y$，这等同于干预下结局的概率$p(Y=1 \\mid \\mathrm{do}(E=e))$。\n\n该公式由下式给出：\n$$p(Y=1 \\mid \\mathrm{do}(E=e)) = \\sum_z p(Y=1 \\mid E=e, Z=z) \\cdot p(Z=z)$$\n\n我们需要为$e=1$和$e=0$两种情况计算这个量。\n\n首先，我们计算如果人群中的每个人都接受了预防性干预，其感染风险为$p(Y=1 \\mid \\mathrm{do}(E=1))$。求和是基于混杂因素$Z$的分层，即$Z=0$和$Z=1$。\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = p(Y=1 \\mid E=1, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=1, Z=1) \\cdot p(Z=1)$$\n问题提供了以下值：\n- $p(Y=1\\mid E=1,Z=0) = 0.25$\n- $p(Y=1\\mid E=1,Z=1) = 0.60$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\n将这些值代入公式：\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = (0.25)(0.6) + (0.60)(0.4)$$\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = 0.15 + 0.24$$\n$$p(Y=1 \\mid \\mathrm{do}(E=1)) = 0.39$$\n\n接下来，我们计算如果人群中没有人接受干预，其感染风险为$p(Y=1 \\mid \\mathrm{do}(E=0))$。\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = p(Y=1 \\mid E=0, Z=0) \\cdot p(Z=0) + p(Y=1 \\mid E=0, Z=1) \\cdot p(Z=1)$$\n问题提供了：\n- $p(Y=1\\mid E=0,Z=0) = 0.10$\n- $p(Y=1\\mid E=0,Z=1) = 0.50$\n- $p(Z=0) = 0.6$\n- $p(Z=1) = 0.4$\n\n代入这些值：\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = (0.10)(0.6) + (0.50)(0.4)$$\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = 0.06 + 0.20$$\n$$p(Y=1 \\mid \\mathrm{do}(E=0)) = 0.26$$\n\n最后，因果风险差是这两个量之差。\n$$E[Y\\mid \\mathrm{do}(E=1)] - E[Y\\mid \\mathrm{do}(E=0)] = p(Y=1 \\mid \\mathrm{do}(E=1)) - p(Y=1 \\mid \\mathrm{do}(E=0))$$\n$$= 0.39 - 0.26$$\n$$= 0.13$$\n\n这个结果表示，在校正了合并症负担$Z$的混杂效应后，总人群中由预防性干预引起的感染风险的估计下降值。",
            "answer": "$$\\boxed{0.13}$$"
        },
        {
            "introduction": "最后的这项练习综合了运用DAG进行因果推断的全过程，涵盖从数据观察到识别策略的方方面面。你需要从一组经验性的统计依赖关系出发，推断出潜在的因果图，并识别不同变量的角色（如混杂因素和对撞因子），最终推导出估算因果效应的正确公式。这项练习  模拟了观察性研究中的一个核心挑战：如何形式化我们的假设，并确定能否从现有数据中识别出因果效应。",
            "id": "4587672",
            "problem": "在一项关于呼吸系统健康的观察性流行病学研究中，设 $E$ 为环境细颗粒物暴露的二元变量，$Y$ 为 1 年内的二元呼吸系统结局，$C$ 为在招募时测量的暴露前基线健康状况的二元指标，$S$ 为是否被纳入分析数据集的二元指标（若被纳入，则 $S=1$）。假设源人群的数据生成机制具有以下特性：除了 $E$、$Y$、$C$ 和 $S$ 之外没有其他测量变量，除了 $C$ 之外不存在 $(E,Y)$ 的未测量共同原因，并且其联合分布与一个有向无环图 (DAG) 模型兼容。\n\n假设在源人群中观察到以下经验性的条件独立和依赖关系：\n- $S \\perp\\!\\!\\!\\perp C \\mid E, Y$\n- $S \\not\\!\\perp\\!\\!\\!\\perp E$ 且 $S \\not\\!\\perp\\!\\!\\!\\perp Y$\n- $E \\not\\!\\perp\\!\\!\\!\\perp C$ 且 $Y \\not\\!\\perp\\!\\!\\!\\perp C$\n- $E \\not\\!\\perp\\!\\!\\!\\perp Y$\n\n请仅使用有向无环图 (DAG)、d-分离、后门路径和干预 do-算子的基本定义，完成以下任务：\n1. 根据给定的观测条件独立性，推断 $C$ 和 $S$ 的定性作用（例如，是混杂因子、对撞因子还是后代节点），并识别出当没有对任何变量进行条件化时，在源人群中所有可能开放的从 $E$ 到 $Y$ 的后门路径。\n2. 指明一个最小节点集，对该集合进行条件化可以阻断所有已识别的后门路径，且不会引入新的伪关联。\n3. 最后，将源人群中的干预概率 $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$ 表示为一个仅含观测联合分布 $\\Pr(E, Y, C)$ 的闭式解析表达式。将 $E$、$Y$ 和 $C$ 视为二元变量，并将你的表达式明确写成一个关于 $C$ 的支撑集的有限和。你的最终答案必须是一个单一的解析表达式。不需要进行数值四舍五入，也不涉及单位。",
            "solution": "该问题是因果推断领域中一个定义明确的问题，其基础是由 Judea Pearl 等人发展的有向无环图 (DAG) 的既定理论框架。该问题是自洽的，其前提内部一致，并且拥有一个可以从其给定条件推导出的、唯一且有意义的解。所有术语在流行病学和因果推断领域都是标准术语。因此，该问题是有效的。\n\n根据要求，解题过程分三部分进行：首先，推断因果结构并识别后门路径；其次，确定适当的调整集；第三，推导干预概率的表达式。\n\n### 第一部分：因果结构与后门路径\n\n我们有四个二元变量：暴露 $E$、结局 $Y$、暴露前测量值 $C$ 和选择指标 $S$。假设联合分布与一个 DAG 兼容。\n\n**1. $C$ 的作用（混杂因子）：**\n问题陈述中提到“除了 $C$ 之外不存在 $(E,Y)$ 的未测量共同原因”。这是条件可交换性假设，也称为在给定 $C$ 的情况下无未测量混杂。观察到的依赖关系 $E \\not\\!\\perp\\!\\!\\!\\perp C$ 和 $Y \\not\\!\\perp\\!\\!\\!\\perp C$ 表明 $C$ 与暴露和结局均相关。由于 $C$ 是一个“暴露前”的测量值，它不可能是由 $E$ 引起的。基于这些事实，$C$ 必定是 $E$ 和 $Y$ 的一个共同原因。这由有向边 $C \\rightarrow E$ 和 $C \\rightarrow Y$ 表示。一个同时是暴露和结局共同原因的变量是**混杂因子**。路径 $E \\leftarrow C \\rightarrow Y$ 是一条非因果路径，它对 $E$ 和 $Y$ 之间的观测关联有贡献。\n\n**2. 因果路径：**\n我们需要求解干预概率 $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$，它量化了 $E$ 对 $Y$ 的因果效应。这预设了从 $E$ 到 $Y$ 存在直接或间接的因果路径。最简单的此类路径是一条直接边 $E \\rightarrow Y$。这条边与通过 $C$ 的混杂路径相结合，解释了观察到的关联 $E \\not\\!\\perp\\!\\!\\!\\perp Y$。\n\n**3. $S$ 的作用（对撞因子）：**\n变量 $S$ 代表被纳入分析数据集。这类变量通常是系统中其他变量的结果，这个过程称为选择。给定条件是 $S$ 边际上依赖于 $E$ 和 $Y$（$S \\not\\!\\perp\\!\\!\\!\\perp E$ 且 $S \\not\\!\\perp\\!\\!\\!\\perp Y$）。这最直接地由从 $E$ 和 $Y$ 指向 $S$ 的有向边表示，即 $E \\rightarrow S$ 和 $Y \\rightarrow S$。在这种结构中，$S$ 是 $E$ 和 $Y$ 的一个共同效应。在一条路径上，作为另外两个节点的共同效应的节点是一个**对撞因子**。路径 $E \\rightarrow S \\leftarrow Y$ 是一条两个箭头在 $S$ 处“对撞”的路径。\n\n**4. 验证 DAG 结构：**\n提出的 DAG 结构是：$E \\leftarrow C \\rightarrow Y$，$E \\rightarrow Y$，以及 $E \\rightarrow S \\leftarrow Y$。让我们使用 d-分离的图形判据来验证给定的条件独立性 $S \\perp\\!\\!\\!\\perp C \\mid E, Y$。我们必须检查 $S$ 和 $C$ 之间的所有路径，看它们是否被集合 $\\{E, Y\\}$ 阻断。\n- 路径1：$S \\leftarrow E \\leftarrow C$。这是一条链式路径。对链中的一个节点施加条件会阻断该路径。由于我们以 $E$ 为条件，此路径被阻断。\n- 路径2：$S \\leftarrow Y \\leftarrow C$。这也是一条链式路径。以 $Y$ 为条件会阻断此路径。\n由于 $S$ 和 $C$ 之间的所有路径都被集合 $\\{E, Y\\}$ 阻断，因此条件 $S \\perp\\!\\!\\!\\perp C \\mid \\{E, Y\\}$ 在此 DAG 中成立。因此，提出的结构与所有提供的信息一致。\n\n**5. 识别后门路径：**\n从 $E$ 到 $Y$ 的后门路径是一条以指向 $E$ 的箭头开始的路径。根据我们推断的 DAG，从 $E$ 到 $Y$ 的唯一一条以指向 $E$ 的箭头开始的路径是 **$E \\leftarrow C \\rightarrow Y$**。这是唯一的后门路径。这条路径默认是开放的，因为 $C$ 不是一个对撞因子。\n\n### 第二部分：最小调整集\n\n为了估计 $E$ 对 $Y$ 的因果效应，我们必须阻断所有从 $E$ 到 $Y$ 的开放后门路径，同时不能打开新的路径。这可以通过对满足后门判据的一组变量施加条件来实现。\n\n- 唯一的后门路径是 $E \\leftarrow C \\rightarrow Y$。\n- 要阻断这条路径，我们必须对路径上的一个节点（端点除外）施加条件。唯一这样的节点是 $C$。\n- 因此，集合 $\\{C\\}$ 是一个调整集的候选。\n- 根据后门判据，对所选集合施加条件不能打开任何新的伪路径。对非对撞因子（如 $C$）施加条件不会打开任何路径。集合 $\\{C\\}$ 不包含任何对撞因子或对撞因子的后代节点。\n- 因此，集合 $\\{C\\}$ 是一个有效的调整集。\n- 由于它只包含一个变量，而这个变量是阻断唯一后门路径所必需的，所以 $\\{C\\}$ 是一个**最小调整集**。\n- 注意，我们绝不能以 $S$ 为条件。由于 $S$ 是路径 $E \\rightarrow S \\leftarrow Y$ 上的一个对撞因子，以 $S$ 为条件会打开这条路径，从而在 $E$ 和 $Y$ 之间引入伪关联，这是一种选择偏倚。问题正确地要求计算源人群中的效应，这意味着我们绝不能以 $S$ 为条件。\n\n### 第三部分：干预概率的表达式\n\n识别出有效的调整集 $\\{C\\}$ 后，我们可以使用后门调整公式（也称为 g-公式或标准化）来用观测分布表示干预概率 $\\Pr(Y=y \\mid \\operatorname{do}(E=e))$。\n\n公式为：\n$$ \\Pr(Y=y \\mid \\operatorname{do}(E=e)) = \\sum_c \\Pr(Y=y \\mid E=e, C=c) \\Pr(C=c) $$\n其中求和是对调整集中的变量（在此例中为 $C$）的所有可能值进行的。\n\n题目要求的是具体的干预概率 $\\Pr(Y=1 \\mid \\operatorname{do}(E=1))$。由于 $C$ 是一个二元变量，其支撑集为 $\\{0, 1\\}$。将这些值代入通用公式，我们得到关于 $C$ 的支撑集的有限和表达式：\n$$ \\Pr(Y=1 \\mid \\operatorname{do}(E=1)) = \\sum_{c \\in \\{0, 1\\}} \\Pr(Y=1 \\mid E=1, C=c) \\Pr(C=c) $$\n将此和明确展开得到：\n$$ \\Pr(Y=1 \\mid \\operatorname{do}(E=1)) = \\Pr(Y=1 \\mid E=1, C=0) \\Pr(C=0) + \\Pr(Y=1 \\mid E=1, C=1) \\Pr(C=1) $$\n该表达式表示结局的层特异性概率的加权平均值，其中权重是混杂因子 $C$ 的每个分层在源人群中的占比。表达式中的每一项，如 $\\Pr(Y=1 \\mid E=1, C=0)$ 和 $\\Pr(C=0)$，都可以从观测联合分布 $\\Pr(E, Y, C)$ 中估计出来，因此满足了问题的所有条件。",
            "answer": "$$\\boxed{\\Pr(Y=1 \\mid E=1, C=0) \\Pr(C=0) + \\Pr(Y=1 \\mid E=1, C=1) \\Pr(C=1)}$$"
        }
    ]
}