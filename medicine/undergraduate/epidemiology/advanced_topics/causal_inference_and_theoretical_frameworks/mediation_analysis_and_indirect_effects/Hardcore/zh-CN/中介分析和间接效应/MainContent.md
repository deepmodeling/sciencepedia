## 引言
在流行病学及众多科学领域中，理解因果关系是核心目标。我们不仅想知道某个暴露（如一种生活方式或一项政策干预）是否会导致某个结局（如一种疾病），更渴望揭开其背后的作用机制——即“如何”与“为何”会产生影响。传统分析往往聚焦于估计暴露与结局之间的总体关联，这如同一个“黑箱”，其内部的运作过程是未知的。中介分析（Mediation Analysis）正是打开这个“黑箱”的关键工具，它提供了一套严谨的框架，用于剖析和量化暴露通过一个或多个中间变量（即中介变量）影响结局的间接路径。

本文旨在系统性地介绍中介分析的理论与实践。通过学习本文，您将能够超越简单的关联分析，深入到因果机制的探索中。我们将首先在“原理与机制”一章中，借助[潜在结果框架](@entry_id:636884)奠定理论基石，精确定义和区分直接效应与间接效应，并探讨识别这些效应所需的关键假设。随后，在“应用与跨学科联系”一章中，我们将通过丰富的实例，展示中介分析如何在流行病学、公共卫生评估、临床研究乃至人工智能等不同领域中发挥其强大作用。最后，通过“动手实践”部分的练习，您将有机会亲手应用所学知识，解决具体问题，从而巩固和深化对中介分析的理解。

## 原理与机制

流行病学研究的核心任务不仅在于确定暴露是否导致结局，更在于阐明其作用机制。中介分析（Mediation Analysis）为此提供了一个强大的定量框架，旨在“打开黑箱”，探究暴露通过哪些中间变量（即**中介变量**）影响结局。本章将深入探讨中介分析的基本原理和机制，从[潜在结果框架](@entry_id:636884)出发，定义各种因果效应，并讨论它们的识别、估计以及在实践中遇到的复杂问题。

### 核心概念：在因果中介分析中定义效应

要严谨地剖析因果路径，我们必须借助**[潜在结果](@entry_id:753644) (potential outcomes)** 框架。这个框架要求我们设想一个平行世界，在这个世界里，我们可以干预暴露和中介变量的取值，并观察由此产生的结局。

#### [潜在结果框架](@entry_id:636884)

假设我们研究一个暴露 $A$、一个中介变量 $M$ 和一个结局 $Y$。

- $M_a$ 表示当个体被（可能与事实相反地）分配到暴露水平 $a$ 时，其中介变量的潜在值。
- $Y_{a,m}$ 表示当个体的暴露被设置为 $a$ 且中介变量被设置为 $m$ 时，其结局的潜在值。这是一个嵌套的或双重干预下的[潜在结果](@entry_id:753644)。

这些潜在结果与我们观察到的数据通过**一致性 (consistency)** 假设联系起来。该假设指出，如果一个人的实际暴露是 $A=a$，那么他/她观察到的中介变量值 $M$ 就是其潜在值 $M_a$；如果其实际暴露是 $A=a$ 且中介变量是 $M=m$，那么他/她观察到的结局 $Y$ 就是其潜在值 $Y_{a,m}$ 。

基于此，暴露 $A=a$ 下的总潜在结局 $Y_a$ 可以被理解为暴露设为 $a$ 后，中介变量自然取其对应潜在值 $M_a$ 时的结局，即 $Y_a = Y_{a, M_a}$。

#### 总效应、自然直接效应与自然间接效应

有了这些定义，我们便可以精确地剖析因果效应。为简化讨论，我们主要在风险差（均值差）尺度上进行定义。

- **总效应 (Total Effect, TE)**：这是暴露对结局的总体影响，定义为暴露组与非暴露组之间潜在结局的期望差异：
$$TE = \mathbb{E}[Y_1] - \mathbb{E}[Y_0] = \mathbb{E}[Y_{1, M_1}] - \mathbb{E}[Y_{0, M_0}]$$
这里的下标 $1$ 和 $0$ 分别代表暴露和非暴露状态。

- **自然直接效应 (Natural Direct Effect, NDE)**：这是在阻止中介变量发生变化的情况下，暴露本身对结局的直接影响。具体来说，我们固定中介变量在其“自然”的非暴露水平 ($M_0$)，然后比较暴露与非暴露对结局的影响：
$$NDE = \mathbb{E}[Y_{1, M_0}] - \mathbb{E}[Y_{0, M_0}]$$
NDE 回答了这样一个问题：“如果我们将人群全部暴露，但通过某种方式奇迹般地将每个人的中介变量水平都维持在他/她未暴露时的水平，那么结局会发生多大变化？”

- **自然间接效应 (Natural Indirect Effect, NIE)**：这是通过中介变量传递的效应。我们固定暴露水平（例如，在暴露组中），然后比较当中介变量从非暴露水平 ($M_0$) 变为暴露水平 ($M_1$) 时，结局发生的变化：
$$NIE = \mathbb{E}[Y_{1, M_1}] - \mathbb{E}[Y_{1, M_0}]$$
NIE 回答了这样一个问题：“对于暴露组，如果我们将他们的中介变量水平从‘假如他们未暴露’时的水平变为‘实际暴露’时的水平，结局会发生多大变化？” 。这个定义考察的是在暴露存在的情况下，由中介变化所驱动的效应。

#### 总效应的分解

在可加性尺度上（如风险差），总效应可以被完美地分解为自然直接效应和自然间接效应之和。这可以通过简单的代数变换看出：
$$
\begin{align}
TE  &= \mathbb{E}[Y_{1, M_1}] - \mathbb{E}[Y_{0, M_0}] \\
 &= \mathbb{E}[Y_{1, M_1}] - \mathbb{E}[Y_{1, M_0}] + \mathbb{E}[Y_{1, M_0}] - \mathbb{E}[Y_{0, M_0}] \\
 &= NIE + NDE
\end{align}
$$
这个分解是中介分析的核心，它在概念上将一条因果路径分成了直接和间接两个部分 。

#### 受控直接效应

与“自然”效应相对的是**受控直接效应 (Controlled Direct Effect, CDE)**。它定义为将中介变量控制在某个特定水平 $m$ 时，暴露对结局的影响：
$$CDE(m) = \mathbb{E}[Y_{1,m}] - \mathbb{E}[Y_{0,m}]$$
CDE 回答的问题更具干预性：“如果我们能将人群中每个人的中介变量水平都强制设定为 $m$，那么暴露与否会对结局产生多大影响？”。与 NDE 依赖于难以想象的“跨世界”反事实 ($Y_{1,M_0}$) 不同，CDE 的识别不要求这类假设，在原则上可以通过析因实验进行估计 。

### 效应的识别与估计

定义了这些效应后，下一个关键问题是如何从观测数据中估计它们。这需要一系列的**识别假设 (identification assumptions)**。

#### 识别的挑战与基本假设

[潜在结果](@entry_id:753644)终究是潜在的，我们无法同时观察到同一个体在不同暴露或中介水平下的结局。为了从观测数据推断这些因果量，除了前述的一致性假设，我们还需要另外两个基本假设 ：

1.  **无干预 (No Interference)**：一个个体的潜在结果不受其他个体暴露状态的影响。这意味着没有“溢出效应”。
2.  **正性 (Positivity)**：在任何协变量水平的人群中，都有非零的概率被分配到不同的暴露组，并且在每个暴露组内，都有非零的概率出现各种可能的中介变量值。这保证了我们有数据来进行比较。

一致性、无干预和正性是所有因果推断的基础。

#### 关键的“无混杂”假设

对于中介分析，还需要一组更强的“无混杂”假设，通常用因果[有向无环图 (DAG)](@entry_id:748452) 来表示和理解：

1.  **无未测量的暴露-结局混杂**：不存在同时影响 $A$ 和 $Y$ 的未测量变量。
2.  **无未测量的暴露-中介混杂**：不存在同时影响 $A$ 和 $M$ 的未测量变量。
3.  **无未测量的中介-结局混杂**：不存在同时影响 $M$ 和 $Y$ 的未测量变量（给定 $A$ 和测量的协变量）。
4.  **无受暴露影响的中介-结局混杂**：不存在任何影响 $M$ 和 $Y$ 的变量，而它本身又受到 $A$ 的影响。

这些假设共同确保我们可以通过调整已测量的协变量来控制混杂，从而识别出我们感兴趣的因果效应。

#### 基于线性模型的估计：乘积法

在满足上述假设，并且模型形式正确（例如，线性可加模型）的理想情况下，中介效应的估计变得非常直观。考虑一个简单的[线性系统](@entry_id:163135)，例如，研究居住地靠近主干道 ($X$) 对哮喘发作风险 ($Y$) 的影响，其中空气污染（如 PM2.5 浓度，$M$）是中介变量 。

我们可以建立两个模型：
1.  中介模型：$\mathbb{E}[M \mid X] = \alpha_0 + \alpha_X X$
2.  结局模型：$\mathbb{E}[Y \mid X, M] = \beta_0 + \beta_X X + \beta_M M$

这里，$\alpha_X$ 代表暴露对中介变量的平均效应，而 $\beta_M$ 代表调整暴露后，中介变量对结局的平均效应。

在这种情况下，可以证明**自然间接效应 (NIE)** 等于这两个系数的乘积：
$$NIE = \alpha_X \times \beta_M$$
这个“乘积法”提供了一个非常简便的计算路径。例如，在上述哮喘研究中 ，如果靠近道路 ($X=1$ vs $X=0$) 使 PM2.5 浓度平均增加 $\alpha_X = 6.3 \, \mu\text{g/m}^3$，而 PM2.5 浓度每增加 $1 \, \mu\text{g/m}^3$ 会使哮喘风险增加 $\beta_M = 0.004$，那么通过空气污染这条路径传递的间接效应就是 $NIE = 6.3 \times 0.004 = 0.0252$。这意味着，总风险增加中有 $0.0252$ 的部分可归因于道路邻近性对空气污染的影响。

### 复杂情况与进阶主题

现实世界很少像简单的[线性模型](@entry_id:178302)那样清晰。以下是一些常见且重要的复杂情况。

#### 暴露-中介[交互作用](@entry_id:164533)

当暴露对结局的直接效应大小取决于中介变量的水平时，或者说中介变量的效应大小取决于暴露水平时，就存在**暴露-中介[交互作用](@entry_id:164533) (exposure-mediator interaction)**。

##### [交互作用](@entry_id:164533)下的效应差异

在结局模型中引入交互项可以表示这种情况：
$$Y = \beta_0 + \beta_1 A + \beta_2 M + \beta_3 AM + \varepsilon_Y$$
交互项的存在 ($\beta_3 \neq 0$) 意味着 CDE 将依赖于我们选择控制的中介水平 $m$，即 $CDE(m) = \beta_1 + \beta_3 m$。更重要的是，NDE 将不再等于任何一个 CDE。具体而言，NDE 的表达式为 $\beta_1 + \beta_3 \mathbb{E}[M_0]$。因此，NDE 和 CDE($c$) 之间的差异为 $\beta_3 (\mathbb{E}[M_0] - c)$，这完全由[交互作用](@entry_id:164533)和中介水平的差异驱动 。

##### 四项分解法

当存在[交互作用](@entry_id:164533)时，简单的 $TE = NDE + NIE$ 分解不再完整。一种更精细的**四项分解法 (Four-Way Decomposition)** 将总效应分为四个有意义的部分（在可加性尺度上）：
1.  **受控直接效应 (CDE)**：当中介变量被控制在参考水平（如 $m=0$）时的直接效应。
2.  **纯粹间接效应 (Pure Indirect Effect, PIE)**：在暴露处于参考水平（如 $a=0$）时，由中介变化引起的效应。
3.  **中介[交互作用](@entry_id:164533) (Mediated Interaction, $INT_{\text{med}}$)**：由于暴露引起中介变量改变，从而体现出的[交互作用](@entry_id:164533)部分。
4.  **参考[交互作用](@entry_id:164533) (Reference Interaction, $INT_{\text{ref}}$)**：即使中介变量未因暴露而改变，仅因其基线水平存在而体现出的[交互作用](@entry_id:164533)部分。

这四项之和等于总效应：$TE = CDE + PIE + INT_{\text{med}} + INT_{\text{ref}}$。这个分解提供了一个关于[交互作用](@entry_id:164533)如何在直接和间接路径中发挥作用的更全面的图景。

#### 效应度量的[尺度依赖性](@entry_id:197044)与不可坍缩性

效应的分解和解释还强烈依赖于我们选择的效应度量尺度（如风险差、风险比或优势比）。一个关键的统计学特性是**可坍缩性 (collapsibility)**。如果一个效应度量在调整某个变量前后保持不变（在没有混杂的情况下），则称其为可坍缩的。

- **风险差 (Risk Difference, RD)** 和 **风险比 (Risk Ratio, RR)** 是可坍缩的（在某些条件下，如对于RR，要求分层变量与暴露无关）。
- **优势比 (Odds Ratio, OR)** 是**不可坍缩的 (non-collapsible)**。

这意味着，即使在每个中介变量的分层内，暴露与结局的条件 OR 均为 $1$（即无条件直接效应），边际（总体）OR 也可能不为 $1$。如在某个研究场景中 ，尽管在每个中介水平上，暴露对结局都没有直接影响（条件 $RD=0$），但由于 $X$ 影响 $M$ 且 $M$ 影响 $Y$，我们观察到了一个不为零的总效应 $RD_{total}=0.08$。然而，虽然条件 $OR$ 也是1，但边际 $OR$ 却显著大于1。这凸显了 OR 的数学特性，即边际 OR 不等于条件 OR 的加权平均，即使不存在混杂。这一特性使得在 OR 尺度上分解效应变得异常困难且不直观，通常不推荐 $OR_{TE} = OR_{NDE} \times OR_{NIE}$ 这样的简单分解 。

#### 多重中介模型

暴露的影响通常通过多条路径传递。例如，一项社区干预 ($X$) 可能通过改善饮食质量 ($M_1$) 和提高心肺健康 ($M_2$) 来影响健康指数 ($Y$)。此外，饮食 ($M_1$) 本身也可能影响心肺健康 ($M_2$)，形成**并联 (parallel)** 和**串联 (serial)** 的中介路径 。

在这种情况下，总的间接效应是所有间接路径效应的总和。对于一个[线性系统](@entry_id:163135)，我们可以通过追踪每条路径上的系[数乘](@entry_id:155971)积来计算：
- 路径 1 ($X \to M_1 \to Y$): 效应为 $a_1 b_1$
- 路径 2 ($X \to M_2 \to Y$): 效应为 $a_2 b_2$
- 路径 3 ($X \to M_1 \to M_2 \to Y$): 效应为 $a_1 d b_2$

总间接效应 $NIE_{total} = a_1 b_1 + a_2 b_2 + a_1 d b_2$。这种方法可以自然地扩展到更复杂的因果网络。

### 实践中的挑战与偏倚

即使理论框架清晰，中介分析在实际应用中也面临诸多挑战，可能导致结果产生偏倚。

#### 中介-结局的未测量混杂与[对撞偏倚](@entry_id:163186)

中介分析最薄弱的环节往往是“无未测量的中介-结局混杂”这一假设。在许多流行病学研究中，几乎总有理由怀疑存在同时影响中介和结局的未测量因素（如遗传倾向、社会经济地位的未测量方面等）。

假设存在一个未测量变量 $U$ 同时导致中介 $M$ 和结局 $Y$。在因果图上，$M$ 成为了一个**对撞节点 (collider)**，位于 $A \to M \leftarrow U \to Y$ 这条路径上。为了估计直接效应 $A \to Y$，我们必须在[统计模型](@entry_id:755400)中调整中介 $M$。然而，调整对撞节点会打开原本被阻断的非因果路径，从而在 $A$ 和 $Y$ 之间引入虚假的关联。这种现象被称为**[对撞偏倚](@entry_id:163186) (collider bias)** 。它会使直接效应的估计产生偏倚，进而影响间接效应的计算。

#### 敏感性分析

由于“无未测量M-Y混杂”的假设无法被证实，稳健的中介分析应辅以**[敏感性分析](@entry_id:147555) (sensitivity analysis)**。[敏感性分析](@entry_id:147555)并不试图“解决”未测量混杂问题，而是量化其潜在影响。它回答了这样一个问题：“一个未测量的混杂因素需要多强，才能改变我们的研究结论？”

例如，假设我们观察到的中介-结局关联系数为 $\widehat{\beta}_M$，但怀疑它因未测量混杂因素 $C$ 而产生偏倚。如果我们能假设 $C$ 对 $M$ 的影响 ($\gamma_C$) 和对 $Y$ 的影响 ($\delta_C$) 的大小，我们就可以计算出偏倚的大小，并得到一个校正后的、更真实的 $\beta_M$。其校正公式为 ：
$$\beta_M = \widehat{\beta}_M - \frac{\delta_C \gamma_C}{\operatorname{Var}(M \mid X)}$$
通过为 $\delta_C$ 和 $\gamma_C$ 设定一系列合理的值，我们可以看到我们的间接效应估计值在多大程度上对未测量混杂敏感。

#### 中介变量的测量误差

另一个常见的实践问题是中介变量的测量不完美。假设我们观察到的是一个带误差的中介 $M^*$，而不是真实的 $M$，且满足经典[测量误差模型](@entry_id:751821) $M^* = M + U$，其中 $U$ 是与一切无关的随机误差。

当我们在结局模型中用 $M^*$ 替代 $M$ 进行回归时，即 $Y$ 对 $X$ 和 $M^*$ 回归，得到的 $M^*$ 的系数 $\beta_M^*$ 将会是真实系数 $\beta_M$ 的一个衰减版本。具体来说 ：
$$\beta_M^* = \beta_M \frac{\operatorname{Var}(M \text{ residual})}{\operatorname{Var}(M \text{ residual}) + \operatorname{Var}(U)}$$
其中，$M \text{ residual}$ 是 $M$ 在 $X$ 上的残差方差，$\operatorname{Var}(U)$ 是测量误差的方差。这个衰减因子总是在 $0$ 和 $1$ 之间，因此 $\beta_M^*$ 会低估真实的 $\beta_M$。由此计算出的间接效应 $\alpha_X \beta_M^*$ 也会相应地被低估。因此，对中介变量的非差异性测量误差会导致我们低估间接效应的大小，这是一个需要警惕的重要偏倚来源。

总之，中介分析是一个强大的工具，但它的应用需要对潜在的理论假设和实践挑战有深刻的理解。严谨的分析不仅应报告效应估计值，还应讨论其识别假设、考虑[交互作用](@entry_id:164533)和[尺度依赖性](@entry_id:197044)，并对未测量混杂和测量误差等潜在偏倚来源进行评估。