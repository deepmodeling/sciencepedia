{
    "hands_on_practices": [
        {
            "introduction": "在进行任何中介分析的计算之前，评估其基本假设是否成立是至关重要的一步。本练习旨在帮助您深入理解其中两个核心的可识别性条件：正性（positivity）和中介者支撑（mediator support）。通过分析一个基于假设性队列研究数据的场景，您将学会如何检查这些条件是否在不同协变量分层中得到满足，从而判断自然间接效应在何种情况下是可识别的。",
            "id": "4611440",
            "problem": "流行病学中的一项观察性队列研究调查了二元暴露 $A \\in \\{0,1\\}$ 如何通过二元中介变量 $M \\in \\{0,1\\}$ 部分影响二元结局 $Y \\in \\{0,1\\}$。一个基线分类协变量 $C$ 有三个水平 $c_1$、$c_2$ 和 $c_3$。假设研究者旨在利用潜在结局框架来识别暴露 $A$ 通过中介变量 $M$ 对结局 $Y$ 的自然间接效应（NIE），其中 $Y(a,m)$ 表示在暴露 $A=a$ 和中介变量设置为 $M=m$ 条件下将观察到的结局，而 $M(a)$ 表示在暴露 $A=a$ 条件下将观察到的中介变量。研究者愿意假设一致性以及在协变量 $C$ 条件下关系 $A \\rightarrow M$、$A \\rightarrow Y$ 和 $M \\rightarrow Y$ 的可交换性（无未测量混杂），但他们必须评估正性和支持条件。\n\n暴露的正性要求对于任何满足 $P(C=c)>0$ 的协变量分层 $c$，必须同时满足 $P(A=1 \\mid C=c)>0$ 和 $P(A=0 \\mid C=c)>0$。对于具有自然效应的中介分析，还需要一个额外的跨世界支持条件：对于任何满足 $P(C=c)>0$ 的 $c$ 和任何中介变量水平 $m$，如果对于某个 $a \\in \\{0,1\\}$ 存在 $P(M=m \\mid A=a, C=c)>0$，那么也必须有 $P(M=m \\mid A=1-a, C=c)>0$；也就是说，在 $C$ 的各分层内，$M$ 的支持集必须在不同暴露水平上重叠。\n\n本研究中的经验支持由计数总结。在 $C$ 的每个分层内，观察到以下计数：\n- 对于 $C=c_1$：在 $A=1$ 条件下，有 $40$ 人的 $M=1$，有 $10$ 人的 $M=0$；在 $A=0$ 条件下，有 $0$ 人的 $M=1$，有 $50$ 人的 $M=0$。\n- 对于 $C=c_2$：在 $A=1$ 条件下，有 $25$ 人的 $M=1$，有 $25$ 人的 $M=0$；在 $A=0$ 条件下，有 $20$ 人的 $M=1$，有 $30$ 人的 $M=0$。\n- 对于 $C=c_3$：在 $A=1$ 条件下，有 $0$ 个观测值；在 $A=0$ 条件下，有 $60$ 人的 $M=1$，有 $40$ 人的 $M=0$。\n\n假设对于 $j \\in \\{1,2,3\\}$ 都有 $P(C=c_j)>0$，并且这些经验模式反映了潜在的支持集（即，零计数表示零概率）。基于上述正性和支持集的基本定义，并且不进行参数外推，以下哪个/哪些陈述是正确的？\n\nA. 在所有 $C$ 分层中，$A$ 和 $M$ 的正性都成立，因此对于整个人群，自然间接效应无需模型外推即可识别。\n\nB. $A$ 的正性在 $C=c_3$ 中不成立，破坏了对整个人群的可识别性；即使限制在 $C \\in \\{c_1, c_2\\}$，由于 $C=c_1$ 的原因，中介变量支持条件仍然不成立，因此即使在该限制之后，自然间接效应也无法识别。\n\nC. 尽管暴露的正性在 $C=c_3$ 中不成立，但由于中介变量支持条件在所有地方都成立，自然间未知效应对于整个人群仍然是可识别的。\n\nD. 自然间接效应在 $C=c_2$ 的亚群中是可识别的，因为在该亚群中暴露和中介变量的正性都成立；它在 $C=c_1$ 或 $C=c_3$ 中是不可识别的。",
            "solution": "### 步骤 1：问题验证\n\n我将首先根据指定标准验证问题陈述。\n\n**1.1. 提取给定信息：**\n- **变量**：暴露 $A \\in \\{0,1\\}$，结局 $Y \\in \\{0,1\\}$，中介变量 $M \\in \\{0,1\\}$，协变量 $C \\in \\{c_1, c_2, c_3\\}$。\n- **目标**：识别暴露 $A$ 通过中介变量 $M$ 对结局 $Y$ 的自然间接效应（NIE）。\n- **框架**：潜在结局 $Y(a,m)$ 和 $M(a)$。\n- **假设**：\n    1. 一致性：$Y = Y(A,M)$，$M = M(A)$。\n    2. 可交换性：在给定 $C$ 的条件下，$A \\rightarrow Y$、$A \\rightarrow M$ 和 $M \\rightarrow Y$ 关系没有未测量的混杂因素。\n- **待评估的可识别性条件**：\n    1. **暴露正性**：对于任何满足 $P(C=c)>0$ 的协变量分层 $c$，必须满足 $P(A=1 \\mid C=c)>0$ 和 $P(A=0 \\mid C=c)>0$。\n    2. **中介变量支持**：对于任何满足 $P(C=c)>0$ 的 $c$ 和任何中介变量水平 $m$，如果对于某个 $a \\in \\{0,1\\}$ 有 $P(M=m \\mid A=a, C=c)>0$，那么也必须有 $P(M=m \\mid A=1-a, C=c)>0$。这等同于要求在每个协变量分层内，中介变量分布的支持集在不同暴露水平上是相同的：$\\text{supp}(M \\mid A=1, C=c) = \\text{supp}(M \\mid A=0, C=c)$。\n- **数据（经验计数）**：\n    - 对于 $C=c_1$：\n        - $A=1$：$40$ 名受试者 $M=1$，10 名受试者 $M=0$。\n        - $A=0$：$0$ 名受试者 $M=1$，50 名受试者 $M=0$。\n    - 对于 $C=c_2$：\n        - $A=1$：$25$ 名受试者 $M=1$，25 名受试者 $M=0$。\n        - $A=0$：$20$ 名受试者 $M=1$，30 名受试者 $M=0$。\n    - 对于 $C=c_3$：\n        - $A=1$：$0$ 名受试者。\n        - $A=0$：$60$ 名受试者 $M=1$，40 名受试者 $M=0$。\n- **解释指南**：\n    1. 对于 $j \\in \\{1,2,3\\}$，有 $P(C=c_j)>0$。\n    2. 数据中的零计数意味着在潜在分布中概率为零。\n    3. 不允许进行参数化模型外推。\n\n**1.2. 使用提取的给定信息进行验证：**\n- **科学依据**：该问题设置在因果推断领域，特别是使用潜在结局框架的中介分析。自然间接效应（NIE）、一致性、可交换性、正性和中介变量支持等概念在该领域有严格的标准定义。该问题在科学上是合理的。\n- **良定性**：该问题为需要检查的条件（正性和中介变量支持）以及用于检查它们的数据提供了精确的定义。问题明确了需要确定什么（NIE的可识别性）。它是自包含的，可以推导出唯一的结论。\n- **客观性**：语言正式且数学化，没有模糊或主观的陈述。\n\n**1.3. 结论与行动：**\n问题陈述是有效的。这是一个流行病学/因果推断领域中的良定问题。我将继续进行解答。\n\n### 步骤 2：解题推导\n\n自然间接效应 (NIE) 定义为 $NIE = E[Y(1, M(1))] - E[Y(1, M(0))]$。在所述的一致性和条件可交换性假设下，该量可通过中介公式从可观察数据中识别。为了使 NIE 能够非参数地被识别，必须满足特定的正性和支持条件。我们将对协变量 $C$ 的每个分层检查这些条件。问题陈述指出，零计数意味着零概率。\n\n**对分层 $C=c_1$ 的分析：**\n1.  **暴露正性**：\n    - $A=1$ 的受试者人数为 $40+10=50$。$A=0$ 的受试者人数为 $0+50=50$。\n    - 由于两组都非空，我们可以估计 $P(A=1|C=c_1)>0$ 和 $P(A=0|C=c_1)>0$。\n    - **结论**：暴露正性在 $C=c_1$ 中成立。\n\n2.  **中介变量支持**：\n    - 对于 $A=1$ 且 $C=c_1$ 的受试者，$M=1$（40人）和 $M=0$（10人）都有计数。因此，中介变量的支持集为 $\\text{supp}(M \\mid A=1, C=c_1) = \\{0, 1\\}$。\n    - 对于 $A=0$ 且 $C=c_1$ 的受试者，$M=1$ 有 0 个计数，$M=0$ 有 50 个计数。因此，根据问题的假设，$\\text{supp}(M \\mid A=0, C=c_1) = \\{0\\}$。\n    - 支持集不相等：$\\{0, 1\\} \\neq \\{0\\}$。\n    - 我们来检查一下给出的定义：考虑 $m=1$。我们有 $P(M=1 \\mid A=1, C=c_1) > 0$。该条件要求我们也必须有 $P(M=1 \\mid A=0, C=c_1) > 0$。然而，数据显示这个概率为 0。\n    - **结论**：中介变量支持条件在 $C=c_1$ 中被违反。因此，在 $C=c_1$ 的亚群中，NIE 是不可识别的。\n\n**对分层 $C=c_2$ 的分析：**\n1.  **暴露正性**：\n    - $A=1$ 的受试者人数为 $25+25=50$。$A=0$ 的受试者人数为 $20+30=50$。\n    - 两组都非空，所以 $P(A=1|C=c_2)>0$ 和 $P(A=0|C=c_2)>0$。\n    - **结论**：暴露正性在 $C=c_2$ 中成立。\n\n2.  **中介变量支持**：\n    - 对于 $A=1$ 和 $C=c_2$：$M=1$（25人）和 $M=0$（25人）都有受试者。所以，$\\text{supp}(M \\mid A=1, C=c_2) = \\{0, 1\\}$。\n    - 对于 $A=0$ 和 $C=c_2$：$M=1$（20人）和 $M=0$（30人）都有受试者。所以，$\\text{supp}(M \\mid A=0, C=c_2) = \\{0, 1\\}$。\n    - 支持集相等：$\\{0, 1\\} = \\{0, 1\\}$。\n    - **结论**：中介变量支持条件在 $C=c_2$ 中成立。由于暴露正性和中介变量支持都成立，NIE 在由 $C=c_2$ 定义的亚群中是可识别的。\n\n**对分层 $C=c_3$ 的分析：**\n1.  **暴露正性**：\n    - $A=1$ 的受试者人数为 $0$。$A=0$ 的受试者人数为 $60+40=100$。\n    - 由于该分层中没有 $A=1$ 的受试者，所以 $P(A=1 \\mid C=c_3) = 0$。\n    - **结论**：暴露正性条件在 $C=c_3$ 中被违反。仅此一点就足以使 NIE 在该分层中不可识别，并因此在整个人群中也不可识别。\n\n**各分层可识别性总结**：\n- $C=c_1$：不可识别（中介变量支持条件失败）。\n- $C=c_2$：可识别。\n- $C=c_3$：不可识别（暴露正性失败）。\n\n### 步骤 3：逐项分析选项\n\n基于以上分析，我将评估每个选项。\n\n**A. 在所有 $C$ 分层中，$A$ 和 $M$ 的正性都成立，因此对于整个人群，自然间接效应无需模型外推即可识别。**\n- 该陈述声称正性在所有地方都成立。我的分析表明这是错误的。暴露正性在 $C=c_3$ 中不成立，中介变量支持条件在 $C=c_1$ 中不成立。因此，NIE 对于整个人群是不可识别的。\n- **结论：错误。**\n\n**B. $A$ 的正性在 $C=c_3$ 中不成立，破坏了对整个人群的可识别性；即使限制在 $C \\in \\{c_1,c_2\\}$，由于 $C=c_1$ 的原因，中介变量支持条件仍然不成立，因此即使在该限制之后，自然间接效应也无法识别。**\n- “$A$ 的正性在 $C=c_3$ 中不成立”：这是正确的，因为 $P(A=1|C=c_3)=0$。\n- “...破坏了对整个人群的可识别性”：这是一个正确的推论。要识别群体平均效应，必须在所有（$P(C=c)>0$ 的）分层中都满足可识别性。\n- “...即使限制在 $C \\in \\{c_1,c_2\\}$，由于 $C=c_1$ 的原因，中介变量支持条件仍然不成立”：要在 $C \\in \\{c_1,c_2\\}$ 的亚群中识别 NIE，需要计算层特异性效应的加权平均值。由于在中介变量支持条件被违反的 $C=c_1$ 分层中可识别性不成立，因此对于 $\\{c_1, c_2\\}$ 组合亚群的效应也是不可识别的。这部分陈述是正确的。\n- “...因此即使在该限制之后，自然间接效应也无法识别”：这是基于前面正确前提得出的正确最终结论。这个陈述的每个部分都是正确的。\n- **结论：正确。**\n\n**C. 尽管暴露的正性在 $C=c_3$ 中不成立，但由于中介变量支持条件在所有地方都成立，自然间接效应对于整个人群仍然是可识别的。**\n- “尽管暴露的正性在 $C=c_3$ 中不成立”：这部分是正确的。\n- “...自然间接效应对于整个人群仍然是可识别的...”：这是错误的。$C=c_3$ 中的失败破坏了对整个人群的可识别性。\n- “...因为中介变量支持条件在所有地方都成立。”：这也是错误的。中介变量支持条件在 $C=c_1$ 中不成立。\n- **结论：错误。**\n\n**D. 自然间接效应在 $C=c_2$ 的亚群中是可识别的，因为在该亚群中暴露和中介变量的正性都成立；它在 $C=c_1$ 或 $C=c_3$ 中是不可识别的。**\n- “自然间接效应在 $C=c_2$ 的亚群中是可识别的，因为在该亚群中暴露和中介变量的正性都成立”：我的分析证实，在分层 $C=c_2$ 中，暴露正性和中介变量支持条件都得到满足。因此，NIE 对于这个特定的亚群是可识别的。这个陈述是正确的。\n- “...它在 $C=c_1$ 或 $C=c_3$ 中是不可识别的”：我的分析表明，NIE 在 $C=c_1$ 中不可识别（由于中介变量支持条件失败），在 $C=c_3$ 中也不可识别（由于暴露正性失败）。这个陈述也是正确的。\n- 整个陈述由分析得出的正确结论组成。\n- **结论：正确。**\n\n陈述 B 和 D 都是对情况的正确描述。陈述 B 描述了对更大人群（整个人群和受限人群）的后果，而陈述 D 提供了逐个分层的可识别性状态。两者都是有效的推论。",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "一旦确定了中介效应是可识别的，下一步就是进行量化计算。本练习将引导您从潜在结果框架的基本定义出发，推导并计算自然间接效应（NIE），特别是在模型包含暴露-中介者交互项时。这个假设情景强调了理解效应定义的理论重要性，因为它超越了简单的系数乘积法则，揭示了交互作用如何使间接效应依赖于暴露水平。",
            "id": "4611445",
            "problem": "一项城市队列研究调查了连续暴露变量 $X$（周平均细颗粒物浓度，单位 $\\mu\\text{g/m}^3$）如何通过一个连续生物中介变量 $M$（C反应蛋白的自然对数）影响一个连续结局变量 $Y$（标准化收缩压 $z$-分数）。研究人员对一个测量的混杂因素 $Z$（年龄，以岁为单位）进行了校正。假设以下通过普通最小二乘法估计的线性模型在通常的流行病学因果假设（一致性、无干扰和给定 $Z$ 下的序贯可忽略性）下成立，并且误差在给定协变量的条件下均值为零：\n\n$$M = \\alpha_{0} + \\alpha_{1} X + \\alpha_{2} Z + \\varepsilon_{M},$$\n$$Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} M + \\beta_{3} X M + \\beta_{4} Z + \\varepsilon_{Y}.$$\n\n研究者报告了以下估计系数：$\\alpha_{1} = 0.04$，$\\beta_{2} = 0.60$，以及 $\\beta_{3} = -0.01$。考虑一个与政策相关的 $X$ 的变化，从 $x = 12$ 变为 $x' = 17$。\n\n仅使用潜在结局框架中的中介效应定义和上述指定的线性模型（不使用任何快捷公式），推导并计算将 $X$ 从 $x$ 增加到 $x'$ 在 $Y$ 标度上的自然间接效应。明确说明您使用的任何条件化或平均化，并在最终数值代入前，所有期望值均以符号形式表示。将最终数值答案四舍五入至三位有效数字。最终答案中不要包含单位。",
            "solution": "首先对问题进行验证，以确保其科学上合理、良定且客观。\n\n### 第1步：提取已知条件\n问题陈述中提供的数据、变量和模型如下：\n-   **暴露 ($X$)**: 连续变量，周平均细颗粒物浓度 ($\\mu\\text{g/m}^3$)。\n-   **结局 ($Y$)**: 连续变量，标准化收缩压 $z$-分数。\n-   **中介变量 ($M$)**: 连续变量，C反应蛋白的自然对数。\n-   **混杂因素 ($Z$)**: 连续变量，年龄（以岁为单位）。\n-   **统计模型**:\n    $$M = \\alpha_{0} + \\alpha_{1} X + \\alpha_{2} Z + \\varepsilon_{M}$$\n    $$Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} M + \\beta_{3} X M + \\beta_{4} Z + \\varepsilon_{Y}$$\n-   **假设**:\n    1.  指定的线性模型成立。\n    2.  通常的流行病学因果假设成立：一致性、无干扰和给定 $Z$ 下的序贯可忽略性。\n    3.  误差项 ($\\varepsilon_{M}$, $\\varepsilon_{Y}$) 在各自的协变量条件下均值为零。\n-   **估计系数**:\n    -   $\\alpha_{1} = 0.04$\n    -   $\\beta_{2} = 0.60$\n    -   $\\beta_{3} = -0.01$\n-   **暴露对比**: $X$ 从 $x = 12$ 变化到 $x' = 17$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**: 该问题是因果中介分析中的一个标准练习，因果中介分析是流行病学和生物统计学中一个成熟的学科。潜在结局、线性模型以及自然直接和间接效应等概念是该领域的基础。暴露（空气污染）、中介（炎症标志物）和结局（血压）代表了一个合理且经常被研究的生物学通路。\n-   **良定性**: 该问题提供了所有必要的信息——模型、系数和假设——来推导和计算一个唯一的答案。交互项 ($XM$) 的存在使问题变得非平凡，并正确地凸显了现代中介分析方法。\n-   **客观性**: 问题以精确的、定量的术语陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n该问题是有效的。它在定量流行病学中是一个良定义且科学合理的问题。现在将提供一个完整的、有理有据的解法。\n\n### 解法推导\n目标是推导并计算当暴露 $X$ 从基线水平 $x$ 增加到新水平 $x'$ 时的自然间接效应 (Natural Indirect Effect, NIE)。推导将按要求基于潜在结局框架。\n\n令 $Y_{x,m}$ 为当暴露被设为水平 $x$ 且中介变量被设为水平 $m$ 时 $Y$ 的潜在结局。令 $M_{x}$ 为当暴露被设为水平 $x$ 时中介变量的潜在值。假设一致性、无干扰和序贯可忽略性的因果假设成立。\n\n自然间接效应 (NIE) 定义为：在将暴露 $X$ 本身固定在基线水平 $x$ 的同时，改变中介变量，使其从在基线暴露下自然会达到的水平 $M_x$ 变为在新暴露下会达到的水平 $M_{x'}$ 所产生的效应。其形式化定义是潜在结局之差的期望：\n$$NIE = E[Y_{x, M_{x'}} - Y_{x, M_{x}}]$$\n期望 $E[\\cdot]$ 是对系统中所有其他变量（即混杂因素 $Z$ 和未测量的误差项 $\\varepsilon_M$ 和 $\\varepsilon_Y$）的分布求得的。这代表了在研究人群中的平均效应。\n\n在一致性假设下，我们可以将潜在结局与观测数据模型联系起来。给定的 $Y$ 模型如下：\n$$Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} M + \\beta_{3} X M + \\beta_{4} Z + \\varepsilon_{Y}$$\n因此，潜在结局 $Y_{x,m}$ 可以写成：\n$$Y_{x,m} = \\beta_{0} + \\beta_{1} x + \\beta_{2} m + \\beta_{3} x m + \\beta_{4} Z + \\varepsilon_{Y}$$\n\n使用这个表达式，我们可以写出 NIE 期望内的两项：\n1.  $Y_{x, M_{x'}}$: 此处，暴露固定为 $x$，中介变量处于其在暴露为 $x'$ 下会达到的水平，$M_{x'}$。\n    $$Y_{x, M_{x'}} = \\beta_{0} + \\beta_{1} x + \\beta_{2} M_{x'} + \\beta_{3} x M_{x'} + \\beta_{4} Z + \\varepsilon_{Y}$$\n2.  $Y_{x, M_{x}}$: 此处，暴露和中介变量都处于其对应于基线暴露 $x$ 的水平。\n    $$Y_{x, M_{x}} = \\beta_{0} + \\beta_{1} x + \\beta_{2} M_{x} + \\beta_{3} x M_{x} + \\beta_{4} Z + \\varepsilon_{Y}$$\n\n这两个潜在结局之间的差异是：\n$$Y_{x, M_{x'}} - Y_{x, M_{x}} = (\\beta_{0} + \\beta_{1} x + \\beta_{2} M_{x'} + \\beta_{3} x M_{x'} + \\beta_{4} Z + \\varepsilon_{Y}) - (\\beta_{0} + \\beta_{1} x + \\beta_{2} M_{x} + \\beta_{3} x M_{x} + \\beta_{4} Z + \\varepsilon_{Y})$$\n$$Y_{x, M_{x'}} - Y_{x, M_{x}} = \\beta_{2} M_{x'} + \\beta_{3} x M_{x'} - \\beta_{2} M_{x} - \\beta_{3} x M_{x}$$\n因式分解，我们得到：\n$$Y_{x, M_{x'}} - Y_{x, M_{x}} = (\\beta_{2} + \\beta_{3} x) (M_{x'} - M_{x})$$\n\n接下来，我们必须找到潜在中介值之差 $M_{x'} - M_{x}$ 的表达式。我们使用给定的中介变量 $M$ 的模型：\n$$M = \\alpha_{0} + \\alpha_{1} X + \\alpha_{2} Z + \\varepsilon_{M}$$\n根据一致性假设，潜在中介值 $M_x$ 为：\n$$M_x = \\alpha_{0} + \\alpha_{1} x + \\alpha_{2} Z + \\varepsilon_{M}$$\n类似地，对于 $M_{x'}$:\n$$M_{x'} = \\alpha_{0} + \\alpha_{1} x' + \\alpha_{2} Z + \\varepsilon_{M}$$\n差值为：\n$$M_{x'} - M_{x} = (\\alpha_{0} + \\alpha_{1} x' + \\alpha_{2} Z + \\varepsilon_{M}) - (\\alpha_{0} + \\alpha_{1} x + \\alpha_{2} Z + \\varepsilon_{M})$$\n$$M_{x'} - M_{x} = \\alpha_{1} x' - \\alpha_{1} x = \\alpha_{1} (x' - x)$$\n注意，在这个线性模型设定中，潜在中介值的差异是一个常数，不依赖于混杂因素 $Z$ 或误差项 $\\varepsilon_M$。\n\n现在我们将此结果代回到潜在结局之差的表达式中：\n$$Y_{x, M_{x'}} - Y_{x, M_{x}} = (\\beta_{2} + \\beta_{3} x) [\\alpha_{1} (x' - x)]$$\n为了求得 NIE，我们对这个量取期望。由于右侧的表达式是一个由模型参数和固定暴露水平组成的常数，其期望就是表达式本身。\n$$NIE = E[ (\\beta_{2} + \\beta_{3} x) \\alpha_{1} (x' - x) ] = (\\beta_{2} + \\beta_{3} x) \\alpha_{1} (x' - x)$$\n这是在指定模型下自然间接效应的推导出的解析表达式。由于交互项 $\\beta_3 X M$ 的存在，该效应是在基线暴露水平 $x$ 处评估的。因为 $NIE$ 的表达式不依赖于 $Z$，所以给定任意 $Z$ 值的条件 NIE 与边际（人群平均）NIE 相同。\n\n### 计算\n给定以下数值：\n-   $\\alpha_{1} = 0.04$\n-   $\\beta_{2} = 0.60$\n-   $\\beta_{3} = -0.01$\n-   $x = 12$\n-   $x' = 17$\n\n将这些数值代入推导出的 NIE 公式中：\n$$NIE = (0.60 + (-0.01) \\times 12) \\times 0.04 \\times (17 - 12)$$\n$$NIE = (0.60 - 0.12) \\times 0.04 \\times 5$$\n$$NIE = (0.48) \\times (0.20)$$\n$$NIE = 0.096$$\n问题要求答案四舍五入到三位有效数字。计算值 $0.096$ 可以写成 $0.0960$ 来明确表示三位有效数字。",
            "answer": "$$\\boxed{0.0960}$$"
        },
        {
            "introduction": "在现实世界的研究中，一个常见的挑战是可能存在未测量的混杂因素，特别是中介者和结果之间的共同原因。本练习介绍了一种重要的方法——敏感性分析，用以评估中介分析结果对这类潜在混杂的稳健性。您将学习如何根据给定的假设性敏感性参数，对一个有偏的中介效应估计值进行校正，从而得出一个更可靠的结论。",
            "id": "4611426",
            "problem": "考虑一项队列研究，其中干预暴露 $X$ 在基线时被随机分配，一个连续的中介变量 $M$ 在6个月时被测量，一个连续的结局变量 $Y$ 在12个月时被测量。假设数据生成过程由线性的、可加的结构方程描述，在均值尺度上没有暴露-中介或暴露-结局的交互作用：\n$$\nM = \\alpha_{0} + \\alpha_{X} X + \\gamma_{C} C + \\varepsilon_{M},\n$$\n$$\nY = \\beta_{0} + \\beta_{X} X + \\beta_{M} M + \\delta_{C} C + \\varepsilon_{Y},\n$$\n其中，$C$ 是 $M$ 和 $Y$ 的一个未被测量的暴露前共同原因，$\\varepsilon_{M}$ 和 $\\varepsilon_{Y}$ 是均值为零的误差，并且根据随机化，$X$ 独立于 $C$、$\\varepsilon_{M}$ 和 $\\varepsilon_{Y}$。为简化起见，假设所有变量都经过均值中心化处理，并且 $C$ 是标准化的，其方差为 $\\operatorname{Var}(C)=1$。在这种设定下，均值差尺度上的自然间接效应（NIE）被定义为 $X$ 对 $Y$ 的效应中，通过由 $X$ 引起的 $M$ 的变化所传递的部分。\n\n研究中得到了以下经验和敏感性分析量：\n- $M$ 对 $X$ 的回归得到的斜率为 $\\alpha_{X} = 0.75$。\n- 忽略了 $C$ 的 $Y$ 对 $X$ 和 $M$ 的回归得到的中介变量斜率为 $\\widehat{\\beta}_{M} = 1.44$。\n- 在校正 $X$ 后，$M$ 的残差方差为 $\\operatorname{Var}(M \\mid X) = 2.00$。\n- 量化（未测量的）混杂的敏感性参数被指定为：给定 $X$ 时 $C$ 对 $M$ 的效应 $\\gamma_{C} = 0.80$，以及给定 $X$ 和 $M$ 时 $C$ 对 $Y$ 的效应 $\\delta_{C} = 0.50$。\n\n从线性回归、条件期望以及线性可加模型下均值尺度NIE的核心定义出发，推导并计算经过敏感性校正的NIE，该校正针对由 $C$ 引起的对中介-结局系数的混杂。将你的最终答案表示为一个无单位的十进制数。将答案四舍五入到四位有效数字。",
            "solution": "用户提供了一个流行病学中介分析中定义明确的问题。任务是通过校正未测量的混杂来计算敏感性校正后的自然间接效应（NIE）。该问题是有效的，可以使用线性回归和因果推断的原理来解决。\n\n中介变量 $M$ 和结局变量 $Y$ 的结构方程如下：\n$$\nM = \\alpha_{0} + \\alpha_{X} X + \\gamma_{C} C + \\varepsilon_{M}\n$$\n$$\nY = \\beta_{0} + \\beta_{X} X + \\beta_{M} M + \\delta_{C} C + \\varepsilon_{Y}\n$$\n变量是均值中心化的，因此截距 $\\alpha_0$ 和 $\\beta_0$ 为零。简化后的模型为：\n$$\nM = \\alpha_{X} X + \\gamma_{C} C + \\varepsilon_{M}\n$$\n$$\nY = \\beta_{X} X + \\beta_{M} M + \\delta_{C} C + \\varepsilon_{Y}\n$$\n在这个线性、可加系统中，均值差尺度上的自然间接效应（NIE）是暴露 $X$ 对中介 $M$ 的效应系数（$\\alpha_X$）与在给定暴露 $X$ 的条件下中介 $M$ 对结局 $Y$ 的效应系数（$\\beta_M$）的乘积。\n$$\n\\text{NIE} = \\alpha_X \\beta_M\n$$\n暴露 $X$ 是随机化的，这使得它独立于暴露前混杂因素 $C$ 和误差项 $\\varepsilon_M$ 和 $\\varepsilon_Y$。因此，通过将 $M$ 对 $X$ 进行回归，可以无偏地估计系数 $\\alpha_X$。题目提供了这个值为 $\\alpha_X = 0.75$。\n\n系数 $\\beta_M$ 代表在保持 $X$ 不变的情况下，中介 $M$ 对结局 $Y$ 的效应。然而，共同原因 $C$ 未被测量。一个忽略了 $C$ 的 $Y$ 对 $X$ 和 $M$ 的回归将产生一个有偏的 $\\beta_M$ 估计值。题目提供了这个有偏估计值为 $\\widehat{\\beta}_{M} = 1.44$。我们的目标是从观测到的 $\\widehat{\\beta}_M$ 和给定的敏感性参数中推导出真实值 $\\beta_M$。\n\n我们可以使用遗漏变量偏倚理论来推导 $\\widehat{\\beta}_M$ 和 $\\beta_M$ 之间的关系。在 $Y$ 对 $X$ 和 $M$ 的多元回归中，$M$ 的系数由下式给出：\n$$\n\\widehat{\\beta}_M = \\frac{\\operatorname{Cov}(Y, M_{\\perp X})}{\\operatorname{Var}(M_{\\perp X})}\n$$\n其中 $M_{\\perp X}$ 是 $M$ 对 $X$ 回归的残差。\n\n首先，让我们描述残差 $M_{\\perp X}$ 的特征。基于 $M$ 的结构模型以及 $X$ 与 $C$ 和 $\\varepsilon_M$ 的独立性，$M$ 在 $X$ 上的线性投影是 $L(M|X) = \\alpha_X X$。残差是：\n$$\nM_{\\perp X} = M - L(M|X) = (\\alpha_X X + \\gamma_C C + \\varepsilon_M) - \\alpha_X X = \\gamma_C C + \\varepsilon_M\n$$\n分母 $\\operatorname{Var}(M_{\\perp X})$ 是校正 $X$ 后 $M$ 的残差方差，题目明确给出为 $\\operatorname{Var}(M \\mid X) = 2.00$。让我们从模型结构来验证这一点。假设 $C$ 和 $\\varepsilon_M$ 不相关：\n$$\n\\operatorname{Var}(M_{\\perp X}) = \\operatorname{Var}(\\gamma_C C + \\varepsilon_M) = \\gamma_C^2 \\operatorname{Var}(C) + \\operatorname{Var}(\\varepsilon_M)\n$$\n题目陈述 $\\operatorname{Var}(M \\mid X)=2.00$。\n\n接下来，我们计算分子 $\\operatorname{Cov}(Y, M_{\\perp X})$。我们代入 $Y$ 的结构方程：\n$$\nY = \\beta_X X + \\beta_M M + \\delta_C C + \\varepsilon_Y\n$$\n为了用正交分量表示协方差，我们代入 $M = \\alpha_X X + M_{\\perp X}$：\n$$\nY = \\beta_X X + \\beta_M (\\alpha_X X + M_{\\perp X}) + \\delta_C C + \\varepsilon_Y = (\\beta_X + \\beta_M \\alpha_X) X + \\beta_M M_{\\perp X} + \\delta_C C + \\varepsilon_Y\n$$\n现在我们计算协方差：\n$$\n\\operatorname{Cov}(Y, M_{\\perp X}) = \\operatorname{Cov}((\\beta_X + \\beta_M \\alpha_X) X + \\beta_M M_{\\perp X} + \\delta_C C + \\varepsilon_Y, M_{\\perp X})\n$$\n利用协方差的线性性质以及 $X$ 与 $M_{\\perp X}$ 不相关（根据残差的构造）：\n$$\n\\operatorname{Cov}(Y, M_{\\perp X}) = (\\beta_X + \\beta_M \\alpha_X)\\operatorname{Cov}(X, M_{\\perp X}) + \\beta_M\\operatorname{Var}(M_{\\perp X}) + \\delta_C\\operatorname{Cov}(C, M_{\\perp X}) + \\operatorname{Cov}(\\varepsilon_Y, M_{\\perp X})\n$$\n第一项为零，因为 $\\operatorname{Cov}(X, M_{\\perp X}) = 0$。对于最后一项，$M_{\\perp X} = \\gamma_C C + \\varepsilon_M$。我们假设 $\\varepsilon_Y$ 与 $C$（因为 $C$ 是一个指定的共同原因）和 $\\varepsilon_M$（没有提及其他 M-Y 混杂源）都不相关。因此，$\\operatorname{Cov}(\\varepsilon_Y, M_{\\perp X}) = 0$。表达式简化为：\n$$\n\\operatorname{Cov}(Y, M_{\\perp X}) = \\beta_M\\operatorname{Var}(M_{\\perp X}) + \\delta_C\\operatorname{Cov}(C, M_{\\perp X})\n$$\n我们需要求 $\\operatorname{Cov}(C, M_{\\perp X})$：\n$$\n\\operatorname{Cov}(C, M_{\\perp X}) = \\operatorname{Cov}(C, \\gamma_C C + \\varepsilon_M) = \\gamma_C \\operatorname{Var}(C) + \\operatorname{Cov}(C, \\varepsilon_M)\n$$\n根据结构模型的构造，误差项 $\\varepsilon_M$ 与预测变量不相关，所以 $\\operatorname{Cov}(C, \\varepsilon_M) = 0$。题目给出 $C$ 是标准化的，所以 $\\operatorname{Var}(C)=1$。\n$$\n\\operatorname{Cov}(C, M_{\\perp X}) = \\gamma_C \\operatorname{Var}(C) = \\gamma_C\n$$\n将其代回，我们得到：\n$$\n\\operatorname{Cov}(Y, M_{\\perp X}) = \\beta_M\\operatorname{Var}(M_{\\perp X}) + \\delta_C \\gamma_C\n$$\n现在我们可以写出有偏系数 $\\widehat{\\beta}_M$ 的完整表达式：\n$$\n\\widehat{\\beta}_M = \\frac{\\operatorname{Cov}(Y, M_{\\perp X})}{\\operatorname{Var}(M_{\\perp X})} = \\frac{\\beta_M\\operatorname{Var}(M_{\\perp X}) + \\delta_C \\gamma_C}{\\operatorname{Var}(M_{\\perp X})} = \\beta_M + \\frac{\\delta_C \\gamma_C}{\\operatorname{Var}(M_{\\perp X})}\n$$\n项 $\\frac{\\delta_C \\gamma_C}{\\operatorname{Var}(M_{\\perp X})}$ 是由于忽略混杂因素 $C$ 而导致的 $\\widehat{\\beta}_M$ 中的偏倚。回想一下 $\\operatorname{Var}(M_{\\perp X}) = \\operatorname{Var}(M \\mid X)$，我们可以解出真实的（无偏的）系数 $\\beta_M$：\n$$\n\\beta_M = \\widehat{\\beta}_M - \\frac{\\delta_C \\gamma_C}{\\operatorname{Var}(M \\mid X)}\n$$\n我们已知以下数值：\n- 有偏的中介系数：$\\widehat{\\beta}_M = 1.44$\n- C-M 路径的敏感性参数：$\\gamma_C = 0.80$\n- C-Y 路径的敏感性参数：$\\delta_C = 0.50$\n- 中介变量的残差方差：$\\operatorname{Var}(M \\mid X) = 2.00$\n- 混杂因素的方差：$\\operatorname{Var}(C) = 1$（这个值在推导 $\\operatorname{Cov}(C, M_{\\perp X}) = \\gamma_C \\operatorname{Var}(C) = \\gamma_C$ 时被隐式使用）\n\n将这些值代入 $\\beta_M$ 的方程中：\n$$\n\\beta_M = 1.44 - \\frac{(0.50)(0.80)}{2.00}\n$$\n$$\n\\beta_M = 1.44 - \\frac{0.40}{2.00}\n$$\n$$\n\\beta_M = 1.44 - 0.20 = 1.24\n$$\n这就是经过敏感性校正的中介-结局关系系数。现在我们可以将此系数与给定的暴露-中介路径系数 $\\alpha_X = 0.75$ 结合，计算经过敏感性校正的 NIE。\n$$\n\\text{NIE}_{\\text{adj}} = \\alpha_X \\beta_M = (0.75)(1.24)\n$$\n$$\n\\text{NIE}_{\\text{adj}} = 0.93\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\text{NIE}_{\\text{adj}} = 0.9300\n$$",
            "answer": "$$\\boxed{0.9300}$$"
        }
    ]
}