{
    "hands_on_practices": [
        {
            "introduction": "前瞻性队列研究是流行病学研究的基石，它通过直接测量发病率来评估暴露与疾病之间的关联。这个练习将理论与实践相结合，让你从原始的事件数和人时数据中计算发病率比（$IRR$）。更进一步，它揭示了这个基本关联度量如何与常用的泊松回归模型中的系数直接对应，让你深刻理解统计模型在流行病学分析中的实际意义。",
            "id": "4617375",
            "problem": "一项前瞻性队列研究旨在比较在一个固定的随访期内，暴露组和非暴露组之间某一罕见结局的发病率。记录了每组观察到的事件总数和累积人时。暴露组在 $1{,}250$ 人年内发生了 $37$ 次事件。非暴露组在 $2{,}000$ 人年内发生了 $22$ 次事件。假设如下：\n\n- 任何组的发病率定义为 $I = \\frac{E}{T}$，其中 $E$ 是事件总数， $T$ 是累积人时。\n- 每组的事件计数来自一个泊松过程，其均值等于特定组的发病率与人时的乘积，并且在观察期内各组的发病率是恒定的。\n- 将一个带有对数连接函数的广义线性模型 (GLM) 拟合到计数数据，其中暴露指标为 $X \\in \\{0,1\\}$，偏移量等于人时的对数，因此暴露系数捕捉了发病率的乘性变化。\n\n仅使用这些定义和假设，完成以下操作：\n\n1. 计算每组的发病率，然后计算暴露组与非暴露组之间的发病率比。\n2. 在带有对数连接函数和人时偏移量的泊松GLM下，从第一性原理出发，推导暴露系数与发病率比之间的关系。\n3. 最后，报告由观测数据所隐含的泊松回归暴露系数的数值。将最终数值答案四舍五入至四位有效数字。最终报告值无需单位。",
            "solution": "基本定义和假设意味着以下内容。组的发病率定义为 $I = \\frac{E}{T}$，其中 $E$ 是事件总数， $T$ 是累积人时。发病率比 (IRR) 比较暴露组（其率记为 $\\lambda_{1}$）和非暴露组（其率记为 $\\lambda_{0}$）之间的率，由下式给出\n$$\n\\text{IRR} = \\frac{\\lambda_{1}}{\\lambda_{0}}.\n$$\n\n步骤 $1$：根据观测数据计算发病率和发病率比。对于暴露组，\n$$\n\\lambda_{1} = \\frac{E_{1}}{T_{1}} = \\frac{37}{1250}.\n$$\n对于非暴露组，\n$$\n\\lambda_{0} = \\frac{E_{0}}{T_{0}} = \\frac{22}{2000}.\n$$\n因此，\n$$\n\\text{IRR} = \\frac{\\lambda_{1}}{\\lambda_{0}} = \\frac{\\frac{37}{1250}}{\\frac{22}{2000}} = \\frac{37 \\times 2000}{1250 \\times 22} = \\frac{74000}{27500} = \\frac{148}{55}.\n$$\n\n步骤 $2$：推导泊松回归中暴露系数与发病率比之间的关系。在恒定率的泊松过程假设下，组 $i \\in \\{0,1\\}$ 在人时 $T_{i}$ 内的计数 $Y_{i}$ 服从泊松分布，其均值为 $\\mu_{i} = \\lambda_{i} T_{i}$。一个带有对数连接函数和等于人时对数的偏移量的广义线性模型将均值表示为\n$$\n\\ln(\\mu_{i}) = \\beta_{0} + \\beta_{1} X_{i} + \\ln(T_{i}),\n$$\n其中 $X_{i} \\in \\{0,1\\}$ 表示暴露。重新整理可得\n$$\n\\ln(\\lambda_{i} T_{i}) = \\beta_{0} + \\beta_{1} X_{i} + \\ln(T_{i}) \\quad \\Rightarrow \\quad \\ln(\\lambda_{i}) = \\beta_{0} + \\beta_{1} X_{i}.\n$$\n因此，对于暴露组（$X_{1} = 1$），我们有 $\\ln(\\lambda_{1}) = \\beta_{0} + \\beta_{1}$，对于非暴露组（$X_{0} = 0$），我们有 $\\ln(\\lambda_{0}) = \\beta_{0}$。相减得，\n$$\n\\ln(\\lambda_{1}) - \\ln(\\lambda_{0}) = \\beta_{1},\n$$\n这意味着\n$$\n\\beta_{1} = \\ln\\!\\left(\\frac{\\lambda_{1}}{\\lambda_{0}}\\right) = \\ln(\\text{IRR}).\n$$\n因此，泊松回归中的暴露系数等于发病率比的自然对数。\n\n步骤 $3$：使用观测数据计算 $\\beta_{1}$ 的数值。从步骤 $1$ 可知，我们有 $\\text{IRR} = \\frac{148}{55}$。因此，\n$$\n\\beta_{1} = \\ln\\!\\left(\\frac{148}{55}\\right).\n$$\n进行数值计算，\n$$\n\\beta_{1} \\approx \\ln(2.6909090909) \\approx 0.989879088\\ldots\n$$\n四舍五入到四位有效数字，暴露系数为\n$$\n0.9899.\n$$",
            "answer": "$$\\boxed{0.9899}$$"
        },
        {
            "introduction": "在资源有限或疾病罕见的情况下，病例对照研究提供了一种比完整队列研究更高效的研究策略。这个练习聚焦于巢式病例对照研究，这是一种特别严谨的设计。通过这个假设场景，你将亲手验证一个核心理论：当对照组通过发病密度抽样被正确选择时，病例对照研究计算出的比值比（$OR$）可以无偏地估计源队列的发病率比（$IRR$），从而证明了$OR$在动态人群中作为关联度量指标的有效性。",
            "id": "4617399",
            "problem": "观察一个动态人群队列，以研究二元暴露与疾病发病率之间的关联。假设总暴露人时为 $12{,}000$ 人年，总非暴露人时为 $36{,}000$ 人年。在随访期间，识别出发病病例，并进行了一项采用发病密度抽样（也称风险集抽样）的巢式病例对照研究，其中在每个病例发生时，从仍处于风险中的个体中精确抽取 $2$ 名对照。在整个研究中，获得了以下暴露计数的 $2 \\times 2$ 表：\n- 在发病病例中：$60$ 名暴露者和 $72$ 名非暴露者。\n- 在抽样对照中：$66$ 名暴露者和 $198$ 名非暴露者。\n\n仅使用比值、比值比、发病率的核心定义以及发病密度抽样规则，根据 $2 \\times 2$ 表计算病例与对照相比的暴露比值比，然后运用第一性原理确定其在所述抽样方案下的因果意义。将数值比值比表示为四位有效数字。最终数值不需要单位。",
            "solution": "该题要求计算病例对照研究的比值比（Odds Ratio, OR），并阐明在采用发病密度抽样时，该OR的因果意义。\n\n**第1部分：计算比值比**\n\n根据问题提供的数据，我们可以构建一个 $2 \\times 2$ 表：\n\n| 暴露状态 | 病例 | 对照 |\n| :--- | :---: | :---: |\n| 暴露 | $a=60$ | $b=66$ |\n| 非暴露 | $c=72$ | $d=198$ |\n\n病例中的暴露比值是 $\\frac{a}{c}$，对照中的暴露比值是 $\\frac{b}{d}$。比值比（OR）是这两个比值的比率：\n$$ OR = \\frac{a/c}{b/d} = \\frac{ad}{bc} $$\n代入数值：\n$$ OR = \\frac{60 \\times 198}{72 \\times 66} $$\n为简化计算，可以先分别简化分数：\n$$ \\frac{60}{72} = \\frac{5 \\times 12}{6 \\times 12} = \\frac{5}{6} $$\n$$ \\frac{198}{66} = 3 $$\n因此，比值比为：\n$$ OR = \\frac{5}{6} \\times 3 = \\frac{5}{2} = 2.5 $$\n根据题目要求，将结果表示为四位有效数字，即 $2.500$。\n\n**第2部分：比值比的因果意义**\n\n这里的关键在于理解发病密度抽样（Incidence Density Sampling）的特性。在源队列（source cohort）中，真实的关联度量是发病率比（Incidence Rate Ratio, IRR），其定义为：\n$$ IRR = \\frac{\\text{暴露组发病率}}{\\text{非暴露组发病率}} = \\frac{IR_E}{IR_{\\bar{E}}} = \\frac{C_E / PT_E}{C_{\\bar{E}} / PT_{\\bar{E}}} $$\n其中，$C_E$ 和 $C_{\\bar{E}}$ 分别是暴露组和非暴露组的病例数，$PT_E$ 和 $PT_{\\bar{E}}$ 则是相应的人时数。\n\n在巢式病例对照研究中：\n1.  **病例**是源队列中所有的发病病例。因此，研究中的病例暴露分布（$a$ vs $c$）直接反映了源队列中病例的暴露分布。即 $a = C_E$ 且 $c = C_{\\bar{E}}$。\n2.  **对照**是通过发病密度抽样选出的。这意味着每当一个病例发生时，对照是从该时间点仍处于风险中的人群中随机抽取的。这种抽样方法的一个重要特性是，最终选出的所有对照的暴露分布（$b$ vs $d$），能够无偏地估计源队列中总人时的暴露分布。也就是说，对照中的暴露比值 $\\frac{b}{d}$ 是源队列中人时比值 $\\frac{PT_E}{PT_{\\bar{E}}}$ 的一个有效估计。\n\n我们可以验证这一点：\n- 对照中的暴露比值：$\\frac{b}{d} = \\frac{66}{198} = \\frac{1}{3}$。\n- 源队列中的人时比值：$\\frac{PT_E}{PT_{\\bar{E}}} = \\frac{12,000}{36,000} = \\frac{1}{3}$。\n这两个比值完全相等，证实了对照组成功地代表了源队列的人时分布。\n\n现在，我们将这些关系代入比值比的公式：\n$$ OR = \\frac{a/c}{b/d} \\approx \\frac{C_E / C_{\\bar{E}}}{PT_E / PT_{\\bar{E}}} $$\n重新整理这个表达式：\n$$ OR = \\frac{C_E}{C_{\\bar{E}}} \\times \\frac{PT_{\\bar{E}}}{PT_E} = \\frac{C_E / PT_E}{C_{\\bar{E}} / PT_{\\bar{E}}} = IRR $$\n这一推导证明，在采用发病密度抽样的病例对照研究中，计算出的比值比（OR）并不是风险比（Risk Ratio）的近似值，而是发病率比（IRR）的一个无偏估计量。因此，我们计算出的 $OR = 2.500$ 的意义是：暴露组的疾病发病率是非暴露组的 $2.5$ 倍。在没有混杂和其他偏倚的情况下，它直接量化了暴露对疾病发生率的乘性效应。",
            "answer": "$$\n\\boxed{2.500}\n$$"
        },
        {
            "introduction": "在解释观察性研究结果时，混杂偏倚是一个无处不在的重大挑战，它可能制造虚假的关联或掩盖真实的联系。这个练习让你不再仅仅停留在混杂的概念层面，而是通过一个具体的量化实例来深入理解其影响。在一个假设没有真实因果效应的场景下，你将计算出一个与暴露和结局均相关的混杂因素是如何产生一个具有误导性的观测相对风险，从而让你对偏倚的来源和大小有更清晰的认识。",
            "id": "4617352",
            "problem": "一项前瞻性队列研究旨在检验二元暴露 $E$（暴露组与非暴露组）与二元结局 $Y$（发生事件与未发生事件）之间的关系。研究中存在一个二元混杂因素 $C$，它在不同暴露组中分布不同，并对结局产生乘性影响。设 $P(C=1 \\mid E=1) = 0.60$ 且 $P(C=1 \\mid E=0) = 0.20$。在没有混杂因素的非暴露组中，$Y$ 的风险为 $R(Y=1 \\mid E=0, C=0) = 0.05$。该混杂因素以一个恒定的相对风险增加 $Y$ 的风险，因此 $RR_{YC} = \\frac{R(Y=1 \\mid C=1)}{R(Y=1 \\mid C=0)} = 3.0$，且在相对风险尺度上，$E$ 和 $C$ 之间没有交互作用。\n\n假设 $E$ 对 $Y$ 没有因果效应（即 $E$ 对 $Y$ 的真实相对风险为 $RR_{\\text{true}} = 1$）。使用相对风险的定义和基于 $C$ 的分层的全概率定律，计算观测到的相对风险中的有符号混杂偏倚，其定义为 $B = RR_{\\text{obs}} - RR_{\\text{true}}$，其中 $RR_{\\text{obs}}$ 是在未对 $C$ 进行分层或校正的情况下，比较暴露组与非暴露组的 $Y$ 的边际相对风险。将您计算的 $B$ 的最终答案四舍五入到四位有效数字。无需单位。",
            "solution": "题目要求计算观测到的相对风险 $RR_{\\text{obs}}$ 的有符号混杂偏倚 $B$。该偏倚定义为 $B = RR_{\\text{obs}} - RR_{\\text{true}}$。我们已知真实相对风险 $RR_{\\text{true}}$ 为 $1$。观测到的相对风险是比较暴露组与非暴露组的边际（粗）风险比。\n\n设 $E$ 为二元暴露变量，其中 $E=1$ 表示暴露，$E=0$ 表示非暴露。设 $Y$ 为二元结局变量，其中 $Y=1$ 表示发生事件，$Y=0$ 表示未发生事件。设 $C$ 为二元混杂因素，其中 $C=1$ 表示存在混杂因素，$C=0$ 表示不存在混杂因素。\n\n已知条件如下：\n1.  暴露组中混杂因素的比例：$P(C=1 \\mid E=1) = 0.60$。\n2.  非暴露组中混杂因素的比例：$P(C=1 \\mid E=0) = 0.20$。\n3.  在没有混杂因素的非暴露组中，结局的风险：$R(Y=1 \\mid E=0, C=0) = 0.05$。\n4.  与混杂因素相关的结局相对风险在各暴露分层中是恒定的：$RR_{YC} = \\frac{R(Y=1 \\mid E, C=1)}{R(Y=1 \\mid E, C=0)} = 3.0$。\n5.  暴露对结局没有因果效应，这意味着真实的、分层特异性的相对风险为1：$RR_{\\text{true}} = \\frac{R(Y=1 \\mid E=1, C)}{R(Y=1 \\mid E=0, C)} = 1$。在相对风险尺度上没有交互作用的条件意味着该值在 $C$ 的各分层中是恒定的。\n\n我们的目标是计算 $B = RR_{\\text{obs}} - 1$，其中 $RR_{\\text{obs}} = \\frac{R(Y=1 \\mid E=1)}{R(Y=1 \\mid E=0)}$。\n\n首先，我们确定四个分层特异性风险，记为 $R_{ec} = R(Y=1 \\mid E=e, C=c)$。\n基线风险已知：\n$R_{00} = R(Y=1 \\mid E=0, C=0) = 0.05$。\n\n使用真实相对风险 $RR_{\\text{true}}=1$，我们求出没有混杂因素的暴露组的风险：\n$R_{10} = R(Y=1 \\mid E=1, C=0) = R_{00} \\times RR_{\\text{true}} = 0.05 \\times 1 = 0.05$。\n\n使用与混杂因素相关的相对风险 $RR_{YC}=3.0$，我们求出存在混杂因素的受试者的风险。对于非暴露组：\n$R_{01} = R(Y=1 \\mid E=0, C=1) = R_{00} \\times RR_{YC} = 0.05 \\times 3.0 = 0.15$。\n\n对于暴露组：\n$R_{11} = R(Y=1 \\mid E=1, C=1) = R_{10} \\times RR_{YC} = 0.05 \\times 3.0 = 0.15$。\n这与 $C=1$ 分层中 $RR_{\\text{true}}=1$ 的条件相符，因为 $R_{11}/R_{01} = 0.15/0.15 = 1$。\n\n接下来，我们使用全概率定律计算暴露组和非暴露组的边际风险。一个组的边际风险是分层特异性风险的加权平均值，其中权重是该组中混杂因素的比例。\n\n非暴露组的边际风险 $R_0 = R(Y=1 \\mid E=0)$ 为：\n$$R_0 = R(Y=1 \\mid E=0, C=0)P(C=0 \\mid E=0) + R(Y=1 \\mid E=0, C=1)P(C=1 \\mid E=0)$$\n已知 $P(C=1 \\mid E=0) = 0.20$，因此 $P(C=0 \\mid E=0) = 1 - 0.20 = 0.80$。\n代入数值：\n$$R_0 = R_{00} \\times (1 - P(C=1 \\mid E=0)) + R_{01} \\times P(C=1 \\mid E=0)$$\n$$R_0 = (0.05)(0.80) + (0.15)(0.20)$$\n$$R_0 = 0.04 + 0.03 = 0.07$$\n\n同样地，暴露组的边际风险 $R_1 = R(Y=1 \\mid E=1)$ 为：\n$$R_1 = R(Y=1 \\mid E=1, C=0)P(C=0 \\mid E=1) + R(Y=1 \\mid E=1, C=1)P(C=1 \\mid E=1)$$\n已知 $P(C=1 \\mid E=1) = 0.60$，因此 $P(C=0 \\mid E=1) = 1 - 0.60 = 0.40$。\n代入数值：\n$$R_1 = R_{10} \\times (1 - P(C=1 \\mid E=1)) + R_{11} \\times P(C=1 \\mid E=1)$$\n$$R_1 = (0.05)(0.40) + (0.15)(0.60)$$\n$$R_1 = 0.02 + 0.09 = 0.11$$\n\n现在，我们可以计算观测到的相对风险 $RR_{\\text{obs}}$：\n$$RR_{\\text{obs}} = \\frac{R_1}{R_0} = \\frac{0.11}{0.07} = \\frac{11}{7}$$\n\n最后，我们计算有符号混杂偏倚 $B$：\n$$B = RR_{\\text{obs}} - RR_{\\text{true}}$$\n$$B = \\frac{11}{7} - 1 = \\frac{11}{7} - \\frac{7}{7} = \\frac{4}{7}$$\n\n为了提供数值答案，我们将分数转换为小数并四舍五入到四位有效数字。\n$$B = \\frac{4}{7} \\approx 0.57142857...$$\n四舍五入到四位有效数字得到 $0.5714$。",
            "answer": "$$\\boxed{0.5714}$$"
        }
    ]
}