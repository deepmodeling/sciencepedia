{
    "hands_on_practices": [
        {
            "introduction": "“疾病冰山”概念形象地说明了，我们能观测到的病例往往只是全部感染者中的一小部分。本次练习将提供一种量化这一差距的动手方法，通过计算“漏报因子”，帮助你理解疾病监测系统如何仅仅捕捉到冰山的尖端。",
            "id": "4585457",
            "problem": "一种传染病在一次单一的疫情波中通过一个封闭人群传播。在疾病自然史框架中，考虑以下核心定义：血清阳性率是指人群中已感染并产生可检测抗体的累计比例；有症状比例是指受感染个体出现症状的概率；有症状病例的检出概率是指一个有症状病例被常规监测系统捕获的概率。假设无症状感染的检出可以忽略不计。\n\n设人口规模为 $N = 1{,}000$。假设血清阳性率为 $0.30$，有症状比例为 $0.25$，有症状病例的检出概率为 $0.60$。将冰山低估因子定义为真实累计感染人数与监测系统捕获的已检出病例数之比。\n\n仅使用上述定义和数值，从第一性原理推导冰山低估因子。最终答案以无单位的最简分数形式表示。",
            "solution": "在进行求解之前，对问题陈述的有效性进行审查。\n\n### 步骤1：提取已知条件\n- 人口规模：$N = 1{,}000$\n- 血清阳性率：$S_p = 0.30$\n- 有症状比例：$P_{sym} = 0.25$\n- 有症状病例的检出概率：$P_{det|sym} = 0.60$\n- 定义：无症状感染的检出可以忽略不计。\n- 定义：冰山低估因子（此处记为$F_u$）是真实累计感染人数与监测系统捕获的已检出病例数之比。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题使用了流行病学中的标准、明确定义的概念，特别是“疾病冰山”、血清阳性率和病例检出。这些概念是预防医学和疾病自然史研究的基础。其前提具有科学合理性。\n- **适定性**：该问题提供了推导唯一数值解所需的所有必要数据和清晰定义。\n- **客观性**：语言精确且量化，没有主观或模棱两可的术语。\n- **完整性与一致性**：所提供的值是一致的（概率在$0$和$1$之间）。虽然给出了人口规模$N$和血清阳性率$S_p$，但后续将证明它们与最终的比率无关，这并不构成矛盾，而是该问题结构的一个特点。\n\n### 步骤3：结论与行动\n该问题被认为是有效的，因为它具有科学依据、适定性、客观性和内部一致性。将从第一性原理推导求解。\n\n### 解的推导\n设以下变量代表问题中定义的量：\n- $N$：总人口规模，$N = 1{,}000$。\n- $S_p$：血清阳性率，即已感染人群的比例，$S_p = 0.30$。\n- $P_{sym}$：受感染个体出现症状的概率，$P_{sym} = 0.25$。\n- $P_{det|sym}$：有症状病例被检出的概率，$P_{det|sym} = 0.60$。\n- $F_u$：冰山低估因子。\n\n问题将冰山低估因子定义为：\n$$\nF_u = \\frac{\\text{真实累计感染人数}}{\\text{已检出病例数}}\n$$\n\n让我们根据给定信息推导分子和分母的表达式。\n\n首先是分子，即真实累计感染人数（$I_{true}$）。这由作用于总人口的血清阳性率决定：\n$$\nI_{true} = N \\times S_p\n$$\n\n其次是分母，即已检出病例数（$C_{det}$）。这是一个多步计算。感染被分为有症状和无症状两组。\n- 有症状感染人数（$I_{sym}$）是总感染人数乘以有症状比例：\n$$\nI_{sym} = I_{true} \\times P_{sym} = (N \\times S_p) \\times P_{sym}\n$$\n- 问题陈述，无症状感染的检出可以忽略不计，我们将其形式化为无症状病例的检出概率为$0$。因此，所有检出的病例都必须来自有症状个体库。\n- 已检出病例数是有症状感染人数乘以有症状病例的检出概率：\n$$\nC_{det} = I_{sym} \\times P_{det|sym} = ((N \\times S_p) \\times P_{sym}) \\times P_{det|sym}\n$$\n\n现在，我们可以将这些表达式代入冰山低估因子$F_u$的定义中：\n$$\nF_u = \\frac{I_{true}}{C_{det}} = \\frac{N \\times S_p}{(N \\times S_p) \\times P_{sym} \\times P_{det|sym}}\n$$\n\n总感染人数的项 $N \\times S_p$ 同时出现在分子和分母中，因此可以消去。这表明低估因子与总人口规模和血清阳性率无关，而完全是疾病自然史和检出过程的条件概率的函数。\n$$\nF_u = \\frac{1}{P_{sym} \\times P_{det|sym}}\n$$\n\n现在，我们代入所提供的数值：\n- $P_{sym} = 0.25$\n- $P_{det|sym} = 0.60$\n\n$$\nF_u = \\frac{1}{0.25 \\times 0.60}\n$$\n\n首先，计算分母中的乘积。使用分数通常更清晰：\n$0.25 = \\frac{1}{4}$\n$0.60 = \\frac{6}{10} = \\frac{3}{5}$\n\n乘积是：\n$$\nP_{sym} \\times P_{det|sym} = \\frac{1}{4} \\times \\frac{3}{5} = \\frac{3}{20}\n$$\n\n或者，使用小数：\n$0.25 \\times 0.60 = 0.15$\n\n现在，我们计算最终的因子 $F_u$：\n$$\nF_u = \\frac{1}{3/20} = \\frac{20}{3}\n$$\n\n这个因子表明，对于每一个检出的病例，人群中大约有 $\\frac{20}{3}$ 或 $6.67$ 个真实感染。问题要求答案以最简分数形式表示。\n最终结果是 $\\frac{20}{3}$。",
            "answer": "$$\n\\boxed{\\frac{20}{3}}\n$$"
        },
        {
            "introduction": "估算疾病冰山的真实大小并非易事，因为我们的测量工具——诊断测试——并非完美。本练习将引导你推导并应用一个关键公式，利用测试的灵敏度（$Se$）和特异度（$Sp$）来校正观测患病率，这是任何流行病学工作者都应具备的一项基本技能。",
            "id": "4644789",
            "problem": "在一个针对具有大量亚临床负担（疾病的“冰山现象”）的感染进行的社区筛查项目中，由于诊断性能不完善，只有一部分真正感染的个体被检测出来，而一些未感染的个体被错误地归类为阳性。设真实患病率为 $P_{t}$，筛查试验的灵敏度（Se）为 $Se = P(\\text{test} + \\mid \\text{disease})$，试验的特异性（Sp）为 $Sp = P(\\text{test} - \\mid \\text{no disease})$。在筛查人群中观察到的阳性检测比例即为观察患病率 $\\hat{P}_{o} = P(\\text{test} +)$。\n\n仅使用灵敏度（Se）、特异性（Sp）的定义、全概率定律以及恒等式 $P(\\text{no disease}) = 1 - P(\\text{disease})$，完成以下任务：\n\n1. 从第一性原理出发，推导一个在不完美检测条件下，连接观察患病率 $\\hat{P}_{o}$ 与真实患病率 $P_{t}$ 的通用表达式。\n2. 对该表达式进行代数求解，用 $\\hat{P}_{o}$、$Se$ 和 $Sp$ 来表示 $P_{t}$。\n3. 将您的结果应用于以下筛查场景：观察患病率为 $\\hat{P}_{o} = 0.18$，灵敏度为 $Se = 0.88$，特异性为 $Sp = 0.96$。计算由此得出的真实患病率 $P_{t}$。\n\n将最终答案以小数比例表示，并四舍五入至四位有效数字。",
            "solution": "首先将对问题陈述的科学合理性、完整性和客观性进行验证。\n\n### 步骤 1：提取已知条件\n以下是根据问题陈述逐字提取的已知条件：\n-   真实患病率：$P_{t}$\n-   灵敏度：$Se = P(\\text{test} + \\mid \\text{disease})$\n-   特异性：$Sp = P(\\text{test} - \\mid \\text{no disease})$\n-   观察患病率：$\\hat{P}_{o} = P(\\text{test} +)$\n-   恒等式：$P(\\text{no disease}) = 1 - P(\\text{disease})$\n-   任务 1：推导用 $P_{t}$、$Se$ 和 $Sp$ 表示 $\\hat{P}_{o}$ 的表达式。\n-   任务 2：求解推导出的表达式以得出 $P_{t}$。\n-   任务 3：在 $\\hat{P}_{o} = 0.18$，$Se = 0.88$ 和 $Sp = 0.96$ 的情况下计算 $P_{t}$。最终答案应为小数比例，并四舍五入至四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n-   **科学依据**：该问题在根本上是合理的。它使用了流行病学和概率论中的标准、正确的定义，包括灵敏度、特异性、患病率和全概率定律。“疾病的冰山概念”是流行病学中一个公认的比喻，指代大量未被观察到的（亚临床、未诊断或无症状）病例，对于这类病例，这种计算方法具有高度相关性。\n-   **适定性**：该问题是适定的（well-posed）。它提供了执行所要求的推导和计算所需的所有定义和数据。每个步骤都逻辑相连，从而导出一个唯一且有意义的解。条件 $Se + Sp - 1 \\neq 0$ 是 $P_t$ 存在唯一解所必需的。给定的值 $Se = 0.88$ 和 $Sp = 0.96$ 得出 $Se + Sp - 1 = 0.84 \\neq 0$，因此对于给定的参数，该问题是良定义的。\n-   **客观性**：该问题以精确、客观和数学化的语言陈述。它没有歧义、主观性以及基于观点的论断。\n\n### 步骤 3：结论与行动\n该问题是有效的，因为它具有科学依据、适定、客观且完整。现在我将按要求进行解答。\n\n解答将按照问题陈述的要求分为三个部分呈现。\n\n#### 第 1 部分：观察患病率 $\\hat{P}_{o}$ 的推导\n观察患病率 $\\hat{P}_{o}$ 是检测结果为阳性的概率，即 $P(\\text{test} +)$。为了将其与真实患病率 $P_{t}$ 联系起来，我们必须考虑整个群体，该群体由两个互斥且完备的组构成：患病者和未患病者。\n\n根据全概率定律，检测结果为阳性的总概率可以表示为在每个组内检测为阳性的概率之和，并按该组的患病率进行加权：\n$$\n\\hat{P}_{o} = P(\\text{test} +) = P(\\text{test} + \\mid \\text{disease}) P(\\text{disease}) + P(\\text{test} + \\mid \\text{no disease}) P(\\text{no disease})\n$$\n我们已知以下定义：\n-   真实患病率为 $P(\\text{disease}) = P_{t}$。\n-   灵敏度为 $Se = P(\\text{test} + \\mid \\text{disease})$。\n-   根据概率公理， $P(\\text{no disease}) = 1 - P(\\text{disease}) = 1 - P_{t}$。\n-   特异性定义为 $Sp = P(\\text{test} - \\mid \\text{no disease})$。由于对于给定条件，检测结果只能是阳性或阴性，因此 $P(\\text{test} + \\mid \\text{no disease}) + P(\\text{test} - \\mid \\text{no disease}) = 1$。所以，在无病个体中检测呈阳性的概率（即假阳性率）为 $P(\\text{test} + \\mid \\text{no disease}) = 1 - Sp$。\n\n将这些项代入全概率定律的方程中，即可得到观察患病率的期望表达式：\n$$\n\\hat{P}_{o} = (Se)(P_{t}) + (1 - Sp)(1 - P_{t})\n$$\n该表达式将观察患病率与真实患病率以及检测性能特征（灵敏度和特异性）联系起来。\n\n#### 第 2 部分：求解真实患病率 $P_{t}$\n现在，我们对第 1 部分推导出的表达式进行代数变换，以求解 $P_{t}$。\n从以下表达式开始：\n$$\n\\hat{P}_{o} = Se \\cdot P_{t} + (1 - Sp)(1 - P_{t})\n$$\n将右侧的 $(1 - Sp)$ 项展开：\n$$\n\\hat{P}_{o} = Se \\cdot P_{t} + 1 - Sp - P_{t} + Sp \\cdot P_{t}\n$$\n将所有包含 $P_{t}$ 的项移到方程一侧，其他项移到另一侧：\n$$\n\\hat{P}_{o} - 1 + Sp = Se \\cdot P_{t} - P_{t} + Sp \\cdot P_{t}\n$$\n从右侧的项中提取公因子 $P_{t}$：\n$$\n\\hat{P}_{o} + Sp - 1 = (Se + Sp - 1) P_{t}\n$$\n最后，假设 $Se + Sp - 1 \\neq 0$，通过将两边同时除以系数 $(Se + Sp - 1)$ 来分离出 $P_{t}$：\n$$\nP_{t} = \\frac{\\hat{P}_{o} + Sp - 1}{Se + Sp - 1}\n$$\n这就是用观察患病率 $\\hat{P}_{o}$、灵敏度 $Se$ 和特异性 $Sp$ 表示的真实患病率 $P_t$ 的通用表达式。该关系通常被称为 Rogan 和 Gladen 公式。\n\n#### 第 3 部分：针对给定情景计算 $P_{t}$\n对于一个特定的筛查场景，我们已知以下数值：\n-   观察患病率 $\\hat{P}_{o} = 0.18$\n-   灵敏度 $Se = 0.88$\n-   特异性 $Sp = 0.96$\n\n我们将这些数值代入第 2 部分推导出的公式中：\n$$\nP_{t} = \\frac{0.18 + 0.96 - 1}{0.88 + 0.96 - 1}\n$$\n首先，我们计算分子：\n$$\n\\text{Numerator} = 0.18 + 0.96 - 1 = 1.14 - 1 = 0.14\n$$\n接着，我们计算分母：\n$$\n\\text{Denominator} = 0.88 + 0.96 - 1 = 1.84 - 1 = 0.84\n$$\n现在，我们计算该比率以求得 $P_{t}$：\n$$\nP_{t} = \\frac{0.14}{0.84}\n$$\n该分数可化简为：\n$$\nP_{t} = \\frac{14}{84} = \\frac{1}{6}\n$$\n换算成小数，即为 $P_{t} = 0.16666...$。问题要求将答案四舍五入至四位有效数字。\n$$\nP_{t} \\approx 0.1667\n$$\n因此，该社区中感染的隐含真实患病率约为 $16.67\\%$。观察患病率（$18\\%$）与真实患病率（$16.67\\%$）之间的差异是由于检测的特异性不完善，导致出现假阳性，从而夸大了表观患病率。",
            "answer": "$$\n\\boxed{0.1667}\n$$"
        },
        {
            "introduction": "即便使用一个高度准确的测试，当筛查一个存在大量亚临床病例的罕见疾病时，一个阳性结果究竟意味着什么？这个进阶练习将探讨疾病患病率与阳性预测值（$PPV$）之间的关系，揭示为何庞大的未感染人群会导致出人意料的诊断结论。",
            "id": "4644747",
            "problem": "一个人群正在接受一种慢性病的筛查，该病具有“疾病冰山概念”的特征，即大多数病例是亚临床的，不经筛查不易检测。令 $D$ 表示随机选择的个体确实患有该病（包括亚临床病例）的事件，令 $T^{+}$ 表示筛查测试返回阳性结果的事件。总患病率（包括潜藏的亚临床部分）为 $P(D)=P_{t}$，其中 $0P_{t}1$。测试的灵敏度为 $P(T^{+}\\mid D)=Se$（其中 $0Se1$），特异度为 $P(T^{-}\\mid \\neg D)=Sp$（其中 $0Sp1$），其中 $\\neg D$ 是不患病的事件。\n\n首先，推导阳性预测值 ($PPV = P(D\\mid T^{+})$) 作为 $Se$、$Sp$ 和 $P_t$ 的函数。然后，确定当患病率趋近于零时，$PPV$ 的极限 $\\lim_{P_{t}\\to 0} PPV(P_t)$，并求出当 $P_t \\to 0$ 时，$PPV$ 关于 $P_t$ 的一阶泰勒展开式 $PPV(P_t) = c \\cdot P_t + o(P_t)$ 中的系数 $c$。将这两个结果（极限和系数 $c$）放在一个 $1 \\times 2$ 的矩阵中。",
            "solution": "问题要求推导阳性预测值 ($PPV$) 及其在低患病率极限下的解析行为。问题陈述在流行病学和概率论的原理上有科学依据，并且是适定的，为得到唯一解提供了所有必要的定义和约束。因此，该问题是有效的。\n\n首先，我们推导 $PPV$ 的表达式，它被定义为条件概率 $P(D\\mid T^{+})$。我们将使用贝叶斯定理 (Bayes' theorem)，其表述为：\n$$P(D\\mid T^{+}) = \\frac{P(T^{+}\\mid D)P(D)}{P(T^{+})}$$\n\n问题给出的条件是：\n- 总患病率：$P(D) = P_{t}$\n- 测试灵敏度：$P(T^{+}\\mid D) = Se$\n- 测试特异度：$P(T^{-}\\mid \\neg D) = Sp$\n\n因此，贝叶斯定理的分子是 $P(T^{+}\\mid D)P(D) = Se \\cdot P_{t}$。\n\n分母 $P(T^{+})$ 是阳性测试结果的总概率。我们可以使用全概率公式，以疾病状态 $D$ 及其补集 $\\neg D$ 为条件来求得：\n$$P(T^{+}) = P(T^{+}\\mid D)P(D) + P(T^{+}\\mid \\neg D)P(\\neg D)$$\n\n我们需要确定右边的两项。第一项同样是 $Se \\cdot P_{t}$。对于第二项，我们需要 $P(\\neg D)$ 和 $P(T^{+}\\mid \\neg D)$。\n不患病的概率是患病率的补集：\n$$P(\\neg D) = 1 - P(D) = 1 - P_{t}$$\n\n量 $P(T^{+}\\mid \\neg D)$ 是在没有疾病的情况下测试结果为阳性的概率，也称为假阳性率。它是特异度 $Sp = P(T^{-}\\mid \\neg D)$ 的补集：\n$$P(T^{+}\\mid \\neg D) = 1 - P(T^{-}\\mid \\neg D) = 1 - Sp$$\n\n将这些代入 $P(T^{+})$ 的表达式中：\n$$P(T^{+}) = (Se \\cdot P_{t}) + (1 - Sp)(1 - P_{t})$$\n\n现在我们可以组合出 $PPV(P_{t}) = P(D\\mid T^{+})$ 的完整表达式：\n$$PPV(P_{t}) = \\frac{Se \\cdot P_{t}}{(Se \\cdot P_{t}) + (1 - Sp)(1 - P_{t})}$$\n我们可以重新整理分母，按 $P_{t}$ 对各项进行分组：\n$$PPV(P_{t}) = \\frac{Se \\cdot P_{t}}{Se \\cdot P_{t} + 1 - Sp - P_{t} + Sp \\cdot P_{t}} = \\frac{Se \\cdot P_{t}}{(Se + Sp - 1)P_{t} + (1 - Sp)}$$\n这是所要求的阳性预测值作为 $Se$、$Sp$ 和 $P_{t}$ 的函数的表达式。\n\n接下来，我们分析 $PPV(P_{t})$ 在 $P_{t} \\to 0$ 时的行为。\n\n首先，我们计算极限 $\\lim_{P_{t}\\to 0} PPV(P_{t})$：\n$$\\lim_{P_{t}\\to 0} PPV(P_{t}) = \\lim_{P_{t}\\to 0} \\frac{Se \\cdot P_{t}}{(Se + Sp - 1)P_{t} + (1 - Sp)}$$\n当 $P_{t} \\to 0$ 时，分子趋近于 $Se \\cdot 0 = 0$。分母趋近于 $(Se + Sp - 1)\\cdot 0 + (1 - Sp) = 1 - Sp$。\n由于问题陈述 $0   Sp  1$，分母 $1 - Sp$ 是一个非零正常数。因此，极限是：\n$$\\lim_{P_{t}\\to 0} PPV(P_{t}) = \\frac{0}{1 - Sp} = 0$$\n\n其次，我们确定展开式 $PPV(P_{t}) = c \\cdot P_{t} + o(P_{t})$ 在 $P_{t} \\to 0$ 时的首阶系数 $c$。该系数由 $PPV(P_{t})$ 关于 $P_{t}$ 的导数在 $P_{t}=0$ 处的值给出。\n$$c = \\frac{d(PPV)}{dP_{t}} \\bigg|_{P_{t}=0}$$\n令 $u(P_{t}) = Se \\cdot P_{t}$ 且 $v(P_{t}) = (Se + Sp - 1)P_{t} + (1 - Sp)$。\n则 $u'(P_{t}) = Se$ 且 $v'(P_{t}) = Se + Sp - 1$。\n使用导数的商法则，$\\frac{d}{dx}\\left(\\frac{u}{v}\\right) = \\frac{u'v - uv'}{v^2}$：\n$$\\frac{d(PPV)}{dP_{t}} = \\frac{(Se)[(Se + Sp - 1)P_{t} + (1 - Sp)] - (Se \\cdot P_{t})(Se + Sp - 1)}{[(Se + Sp - 1)P_{t} + (1 - Sp)]^2}$$\n展开分子：\n$$\\frac{d(PPV)}{dP_{t}} = \\frac{Se(Se + Sp - 1)P_{t} + Se(1 - Sp) - Se(Se + Sp - 1)P_{t}}{[(Se + Sp - 1)P_{t} + (1 - Sp)]^2} = \\frac{Se(1 - Sp)}{[(Se + Sp - 1)P_{t} + (1 - Sp)]^2}$$\n现在，我们在 $P_{t}=0$ 处计算这个导数：\n$$c = \\frac{d(PPV)}{dP_{t}} \\bigg|_{P_{t}=0} = \\frac{Se(1 - Sp)}{[(Se + Sp - 1)(0) + (1 - Sp)]^2} = \\frac{Se(1 - Sp)}{(1 - Sp)^2}$$\n因为 $0  Sp  1$，我们可以通过消去项 $(1 - Sp)$ 来简化：\n$$c = \\frac{Se}{1 - Sp}$$\n该系数代表了 $PPV$ 曲线作为患病率 $P_{t}$ 的函数，从 $PPV(0)=0$ 开始的初始斜率。对于罕见病，$PPV$ 近似与患病率成线性正比，比例常数为灵敏度 ($Se$) 与假阳性率 ($1-Sp$) 之比。\n\n所要求的两个量是极限（为 $0$）和首阶系数 $c$（为 $\\frac{Se}{1-Sp}$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{Se}{1-Sp}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}