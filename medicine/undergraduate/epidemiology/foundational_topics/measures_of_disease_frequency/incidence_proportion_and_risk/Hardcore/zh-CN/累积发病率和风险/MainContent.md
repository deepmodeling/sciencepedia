## 引言
发病比例，或更直观地称为风险，是流行病学和公共卫生领域量化疾病发生频率的基石，它回答了“在特定时间内，一个人发生某个健康事件的可能性有多大？”这一核心问题。准确评估风险对于追踪疾病趋势、评价干预措施和指导临床决策至关重要。然而，将这一概念从理想化的定义应用于复杂的现实世界数据时，研究者常面临随访数据不完整（删失）和竞争性事件等挑战，这构成了理论与实践之间的知识鸿沟。

本文旨在系统性地弥合这一差距。首先，在“原理与机制”一章中，我们将深入探讨发病比例的定义、基本属性，并介绍处理删失与竞争风险等复杂情况的先进方法。随后，“应用与跨学科联系”一章将展示风险概念在临床试验、公共卫生决策和现代因果推断中的广泛应用。最后，“动手实践”部分将提供练习，帮助您将理论知识应用于解决实际问题。

通过本指南，您将能够超越简单的公式计算，掌握在复杂条件下准确估计和解释风险的核心技能。

## 原理与机制

本章深入探讨了发病比例（Incidence Proportion）的核心原理和机制，将其作为衡量风险的基本工具。我们将从其严格定义出发，阐明其作为一种概率度量所必须满足的条件。随后，我们将探讨其基本属性，并将其与另一种重要的发病率度量——发病率（Incidence Rate）——进行区分。最后，本章将延伸至现实世界研究中不可避免的复杂情况，例如随访数据不完整（删失）和竞争性风险的存在，并介绍处理这些挑战的先进方法。

### 将发病比例定义为风险

在流行病学中，我们的核心任务之一是量化人群中新发疾病或其他健康事件的发生情况。**发病比例 (Incidence Proportion, IP)**，通常也被称为**累积发病率 (Cumulative Incidence)** 或简称为**风险 (Risk)**，是衡量这一情况的最直观的指标之一。它回答了一个简单而关键的问题：“在一个特定时间段内，一个处于风险中的[个体发生](@entry_id:164036)某个事件的平均概率是多少？”

#### 形式化定义与[概率基础](@entry_id:187304)

对于一个从时间 $0$ 开始观察、长度为 $t$ 的特定时期，发病比例的计算公式为：

$$
IP(t) = \frac{\text{在 } [0,t] \text{ 时间段内发生新事件的个体数}}{\text{在时间 } 0 \text{ 处于风险中的个体总数}}
$$

要使这个比率能够被严谨地解释为一个概率，必须满足一系列严格的条件。这些条件确保了分母是一个固定的、明确定义的集合，而分子则是该集合中发生事件的完整计数。具体而言：

1.  **封闭队列 (Closed Cohort)**：研究人群在研究开始时（基线）就已确定，并且在研究期间没有新成员加入。这确保了分母的稳定性。

2.  **基线无事件 (Event-Free at Baseline)**：在时间 $0$，队列中的所有成员都必须未发生目标事件，并且有资格（即易感）发生该事件。

3.  **完全随访 (Complete Follow-up)**：在直至时间 $t$ 的整个随访期间，必须能够明确每个队列成员的事件状态。这意味着没有个体因失访或在时间 $t$ 之前因行政原因（如研究结束）而数据不完整。

在这些理想化的条件下，$IP(t)$ 不仅是一个比例，更是一个介于 $0$ 和 $1$ 之间的、有良好定义的概率。从概率论的角度来看，我们可以为队列中的每个个体定义一个随机变量 $T$，代表其首次发生事件的时间。那么，群体的发病比例 $IP(t)$ 就是对[边际概率](@entry_id:201078) $\Pr(T \le t)$ 的估计。这个关系可以通过一个[指示随机变量](@entry_id:260717) $I(t) = \mathbf{1}\{T \le t\}$ 来形式化。该变量在事件发生时取值为 $1$，否则为 $0$。根据期望的定义，$\mathbb{E}[I(t)] = 1 \cdot \Pr(T \le t) + 0 \cdot \Pr(T > t) = \Pr(T \le t)$。因此，发病比例在概念上正是这个指示变量的群体均值，即一个随机选择的基线成员在时间 $t$ 之前发生事件的概率。

### 识别风险人群：分母的界定

发病比例计算的准确性在很大程度上取决于对分母——即**风险人群 (Population at Risk)**——的正确界定。风险人群是指在研究开始时，那些既可能也易于首次发生目标事件的个体所组成的群体。因此，在构建分母时，必须仔细地从总队列中排除不符合条件的个体。

主要的排除标准包括：
*   **现患病例 (Prevalent Cases)**：在基线时已经患有目标疾病的个体。他们不是新发病例的候选者。
*   **有既往史的个体 (Individuals with Prior History)**：如果研究的目标是“首次”事件，那么任何在基线前已经发生过该事件的个体都不再处于首次发生的风险中。
*   **免疫或非易感个体 (Immune or Non-susceptible Individuals)**：由于生物学原因无法发生该事件的个体。例如，因手术切除而失去某个器官的个体。

为了阐明这一点，设想一项为期两年的研究，旨在评估一家工厂 $1,200$ 名员工首次发生急性阑尾炎的风险。在基线时，我们发现：$90$ 人有阑尾切除史，$10$ 人正因急性阑尾炎住院（现患病例），$25$ 人曾有阑尾炎病史但已治愈。为了计算两年发病比例，我们必须将这些个体从分母中排除，因为他们都不再处于“首次”发生阑尾炎的风险中。因此，真正的风险人群是 $1,200 - 90 - 10 - 25 = 1,075$ 人。如果在随访期间观察到 $30$ 例新发病例，那么正确的两年[风险估计](@entry_id:754371)应为 $\frac{30}{1,075} \approx 0.0279$。值得注意的是，如果这 $1,075$ 人中有一部分（例如，$100$ 人）同时患有肠易激综合征（IBS），他们不应被排除。尽管IBS的症状可能与阑尾炎相似，增加了诊断的复杂性，但这是一种共病，并不会消除[个体发生](@entry_id:164036)阑尾炎的生物学可能性。

### 发病比例的基本属性

由于 $IP(t)$ 是对累积概率 $\Pr(T \le t)$ 的度量，它具有一些源自[概率公理](@entry_id:262004)的基本数学属性。其中最重要的是其**单调性 (Monotonicity)**。

对于一个不可逆的事件（即一旦发生就不会消失），在封闭队列中，$IP(t)$ 必须是时间 $t$ 的一个[非递减函数](@entry_id:202520)。也就是说，对于任何两个时间点 $t_1$ 和 $t_2$，如果 $t_1  t_2$，那么必然有 $IP(t_1) \le IP(t_2)$。

这个属性可以从两个角度来理解：

1.  **[集合论](@entry_id:137783)角度**：发生事件的个体的集合会随着时间的推移而累积。在时间 $t_1$ 之前发生事件的个体集合，必然是“在时间 $t_2$ 之前发生事件的个体集合”的一个子集。根据概率论的单调性公理，如果事件 $A$ 是事件 $B$ 的子集，则 $\Pr(A) \le \Pr(B)$。

2.  **概率分解角度**：在时间 $t_2$ 之前发生事件的概率，可以分解为两部分之和：在时间 $t_1$ 之前发生事件的概率，加上在 $t_1$ 和 $t_2$ 之间首次发生事件的概率。即，$IP(t_2) = IP(t_1) + \Pr(\text{在 } (t_1, t_2] \text{ 期间首次发生事件})$。由于概率值不能为负，因此 $IP(t_2)$ 必然大于或等于 $IP(t_1)$。

因此，如果一份研究报告声称，在一个具有完整随访的封闭队列中，某不可逆疾病的 $3$ 个月发病比例为 $0.18$，而 $6$ 个月发病比例为 $0.14$，那么这一发现与概率论的基本公理相矛盾。它荒谬地暗示了某些个体从“已发病”状态恢复到了“未发病”状态，这违背了事件不可逆的前提。

### 区分发病比例与发病率

在流行病学文献中，另一个衡量发病情况的核心指标是**发病率 (Incidence Rate, IR)**，有时也称为**发病密度 (Incidence Density)**。虽然名称相似，但发病比例和发病率在概念、计算和应用上存在根本区别。

*   **发病比例 (风险)**：
    *   **分母**：基线时的**风险个体数**。
    *   **单位**：无量纲的**概率**，取值范围为 $[0, 1]$。
    *   **解释**：在一个固定的时间段内，个体发生事件的**平均概率**。
    *   **适用场景**：定义明确的**封闭队列**，且随访信息相对完整。

*   **发病率 (速率)**：
    *   **分母**：所有风险个体贡献的**人时数 (Person-Time)** 之和。
    *   **单位**：每个单位人时的事件数，例如“每 $1,000$ 人年 $X$ 例”，单位为**时间**$^{-1}$。
    *   **解释**：人群中新发病例的**[瞬时速率](@entry_id:182981)**或“速度”。
    *   **适用场景**：成员随时间变化的**动态或开放人群 (Dynamic or Open Population)**，或随访时间不等的队列。

设想一个公共卫生部门同时进行两项研究。在一个由 $1,800$ 名工人组成的封闭队列中，经过 $3$ 年的完整随访，有 $162$ 人首次发病。这里的 $3$ 年发病比例是 $IP(3) = \frac{162}{1,800} = 0.09$，即 $9\%$ 的风险。在另一项对全市居民的监测中，由于人口流动，研究人员在相同的 $3$ 年内累计了 $27,000$ 人年的观察时间，并记录了 $180$ 例新发病例。这里的发病率是 $IR = \frac{180}{27,000 \text{ 人年}} \approx 0.0067 \text{ 年}^{-1}$。这是一个速率，而不是概率。将两者混淆是一个严重的类别错误。

### 应对不完整随访：删失与生存分析

在理想条件下计算发病比例需要对队列中的每个人都有完整的随访信息。然而，在实际研究中，这几乎是不可能的。研究对象可能因搬家、退学或不愿继续参与而失访，或者研究在所有人都发生事件之前就结束了。当我们在一个人的事件发生之前就失去了对其的观察时，这种情况被称为**[右删失](@entry_id:164686) (Right Censoring)**。

#### 朴素[估计量的偏差](@entry_id:168594)

当数据中存在[右删失](@entry_id:164686)时，使用标准的“新发病例数/基线人数”（即 $D(t)/N$）公式（我们称之为**朴素估计量**）来[估计风险](@entry_id:139340)会导致偏差。因为那些被删失的个体没有被完整地观察，他们发生事件的机会也相应减少。然而，朴素估计量在计算时，要么将他们从分子中排除，同时又将他们完整地保留在分母中，这会系统性地**低估**真实的风险。

例如，一项为期 $6$ 个月的[流感](@entry_id:190386)风险研究，基线时有 $12,000$ 名居民。期间，有 $3,000$ 人在头 $3$ 个月内搬离了城市（被删失），其余 $9,000$ 人被完整随访。最终观察到 $800$ 例[流感](@entry_id:190386)病例。朴素的[风险估计](@entry_id:754371)是 $\frac{800}{12,000} \approx 6.7\%$。这个数字是偏低的，因为它没有考虑到那 $3,000$ 人只被观察了部分时间。

#### 基于速率的校正与生存分析方法

为了在存在删失的情况下获得更准确的[风险估计](@entry_id:754371)，流行病学家转向了生存分析的方法。

一种方法是先计算发病率。在上文的[流感](@entry_id:190386)例子中，我们可以计算总人时数。假设搬离均匀发生，这 $3,000$ 人平均每人贡献了 $1.5$ 个月（$0.125$ 年）的观察时间。总人时约为 $(9,000 \text{ 人} \times 0.5 \text{ 年}) + (3,000 \text{ 人} \times 0.125 \text{ 年}) = 4,875$ 人年。发病率 $\lambda = \frac{800}{4,875} \approx 0.164 \text{ 年}^{-1}$。假设该率在短期内恒定，我们可以用公式 $Risk(t) = 1 - \exp(-\lambda \times t)$ 将其转换回 $6$ 个月的风险：$Risk(0.5 \text{ 年}) = 1 - \exp(-0.164 \times 0.5) \approx 7.9\%$。这个经过校正的[风险估计](@entry_id:754371)值（$7.9\%$）高于朴素估计值（$6.7\%$），这符合我们的预期。

另一种更通用的非参数方法是**Kaplan-Meier (KM) 方法**。KM方法不依赖于发病率恒定的假设，它可以直接从随时间变化的事件和[删失数据](@entry_id:173222)中估计**生存函数 (Survival Function)** $S(t)$，即生存到时间 $t$ 之后的概率 $\Pr(T  t)$。一旦我们有了生存函数 $\hat{S}(t)$ 的估计，发病比例就可以通过关系式 $IP(t) = 1 - S(t)$ 来估计，即 $1 - \hat{S}(t)$。

KM方法的有效性依赖于一个至关重要的假设：**非信息性删失 (Non-informative Censoring)**。这个假设要求，在任何时间点，被删失的个体在未来的事件风险与继续被观察的个体是相同的。换句话说，删失的发生不能提供关于个体未来结局的任何信息。例如，如果病情更重的患者更有可能失访，那么删失就是信息性的，KM估计将会高估生存率（从而低估风险）。

只有在最理想的情况下——即在时间 $t$ 之前没有任何删失、竞争性风险或延迟入组——朴素估计量 $D(t)/N$ 的结果才会与 $1 - \hat{S}(t)$ 相等，并成为 $IP(t)$ 的一个一致估计。这清楚地表明，KM方法是朴素方法的一种推广，它放宽了“完整随访”这一苛刻要求。

### 高级主题：竞争性风险的挑战

在许多研究中，我们面临的不仅仅是删失，还有**竞争性风险 (Competing Risks)**。竞争性风险是指某种事件的发生，会妨碍或完全阻止我们感兴趣的主要事件的发生。一个典型的例子是，在研究心肌梗死（MI）的风险时，因其他原因（如癌症）死亡就是一个竞争性事件，因为一个人一旦死亡，就不可能再发生MI。

#### 标准方法的陷阱：净风险与粗风险

一个常见但错误的做法是，将竞争性事件（如死亡）当作标准的[右删失](@entry_id:164686)来处理，然后使用KM方法。这种做法严重违反了非信息性删失假设，因为一个已经死亡的人未来发生MI的风险为零，这与仍然存活的人的风险截然不同。

这种不当处理所估计的，并非我们通常关心的真实世界风险，而是一种被称为**净风险 (Net Risk)** 的理论量。它回答的是一个反事实的问题：“在一个没有人会因竞争性事件而退出的理想世界里，发生MI的风险是多少？” 这个净风险几乎总是会高于在现实世界中可观察到的**粗风险 (Crude Risk)**，即真正的发病比例。原因很简单：在现实世界中，竞争性事件会“带走”一部分本来可能发生MI的个体，从而降低了MI的实际发生概率。正确估计粗风险的统计量是**累积发生函数 (Cumulative Incidence Function, CIF)**，记为 $F_k(t)$。

#### 竞争性风险的建模策略

为了正确处理竞争性风险数据并区分不同类型的风险效应，研究人员发展了专门的[回归模型](@entry_id:163386)。

1.  **因果特异性风险模型 (Cause-Specific Hazard, CSH, Model)**：该模型关注的是在仍然未发生任何事件的个体中，某一特定原因（如MI）的瞬时发生率。在拟合模型时，其他原因的事件被当作删失处理。CSH模型非常适合回答**病因学 (Etiologic)** 问题，即评估某个暴露因素对特定疾病发生过程的直接生物学效应。

2.  **亚分布风险模型 (Subdistribution Hazard, SDH, Model)**：以**Fine-Gray模型**为代表，该模型对CIF直接建模。其巧妙之处在于定义了一个不同的风险集：对于我们关心的事件 $k$，发生过竞争性事件的个体并不会从风险集中移除，而是继续被“背负”在分母中。因此，SDH模型评估的是暴露因素对CIF的总体影响，这对于**风险预测 (Prediction)** 和评估公共卫生干预的总体效果至关重要。

这两种模型的解释可能大相径庭。设想一种药物，它本身不影响癌症（事件 $k$）的生物学发生率，但能有效降低心血管疾病死亡（竞争性事件 $c$）的风险。
*   一个**CSH模型**在评估该药物对癌症的效应时，会得到一个接近 $1$ 的风险比（Hazard Ratio），正确地反映出该药物没有直接的抗癌或致癌效应。
*   然而，一个**SDH模型**会显示，服用该药物的人群其癌症的累积发生率反而增加了（亚分布风险比大于 $1$）。这并非因为药物致癌，而是因为它通过减少竞争性死亡，让更多的人“活得足够长”，从而有机会患上癌症。

这个例子鲜明地揭示了两种模型在解释上的差异：CSH模型关注“病因机制”，而SDH模型关注“人群结局”。在面对竞争性风险时，选择哪种模型取决于研究者试图回答的具体科学问题。