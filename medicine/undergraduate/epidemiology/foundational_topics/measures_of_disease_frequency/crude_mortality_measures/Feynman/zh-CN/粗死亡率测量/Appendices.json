{
    "hands_on_practices": [
        {
            "introduction": "死亡率分析的第一步是将原始的死亡人数和人口时间数据转化为有意义的流行病学指标。本练习将指导你根据总死亡人数和风险人口时间，计算基础的粗死亡率。然后，你将学习如何将这个代表瞬时死亡“强度”的率，转化为年度风险——一个在公共卫生沟通中通常更直观的概率。",
            "id": "4584603",
            "problem": "一个卫生部门监测一个大型都会区在单一自然年内的死亡率。在这一年中，监测系统记录到常住人口中共有 $D = 530$ 例死亡。利用登记档案和随访记录，该部门估计所有个体在这一年内贡献的总累积观察时间为 $PT = 2{,}650{,}000$ 人年（人年 (PY) 是人时 (person-time) 的单位）。\n\n从粗死亡率是死亡人数与总风险人时之比的基本定义出发，并使用恒定死亡风险下的标准指数生存模型，完成以下任务：\n\n- 从基本原理出发，推导出以“每人年死亡数”为单位的粗死亡率。\n- 使用1年内风险恒定的假设，从粗死亡率推导出一年的累积发生率（年风险）。\n- 用决策者能理解的通俗语言，对粗死亡率和一年期风险进行简要解释。\n\n仅报告一年期累积发生率（年风险）作为你的最终数值答案。将其表示为一个无单位的小数（无百分号），并将最终报告值四舍五入到四位有效数字。",
            "solution": "该问题陈述经评估有效。它在科学上基于流行病学和生存分析的原理，问题设定良好，数据充分且一致，表述客观。该问题要求推导和计算基本的流行病学指标，这是一项标准且可验证的任务。\n\n求解过程如下。\n\n首先，我们推导粗死亡率。题目将此率定义为总死亡人数 $D$ 与总风险人时 $PT$ 之比。这个率是一个发生率（incidence rate），我们用 $\\lambda$ 表示。它代表每单位时间的瞬时死亡风险。\n\n给定值为 $D = 530$ 例死亡和 $PT = 2,650,000$ 人年。\n\n粗死亡率 $\\lambda$ 计算如下：\n$$\n\\lambda = \\frac{D}{PT} = \\frac{530}{2,650,000} \\text{ years}^{-1}\n$$\n化简该分数：\n$$\n\\lambda = \\frac{53}{265,000} \\text{ years}^{-1} = \\frac{1}{5000} \\text{ years}^{-1} = 0.0002 \\text{ years}^{-1}\n$$\n这个从汇总数据计算出的粗死亡率，可作为指数生存模型中恒定风险参数的最大似然估计。题目陈述中明确给出了风险 $\\lambda$ 恒定的假设。\n\n接下来，我们推导一年期累积发生率，也称为年风险。指数生存模型描述了在恒定风险率 $\\lambda$ 下，个体存活超过时间 $t$ 的概率。生存函数 $S(t)$ 为：\n$$\nS(t) = \\exp(-\\lambda t)\n$$\n在长度为 $t$ 的时间区间内的累积发生率，记为 $CI(t)$，是指在时间 0 处于风险中的个体在该区间内经历事件（死亡）的概率。它是生存函数的补集：\n$$\nCI(t) = 1 - S(t) = 1 - \\exp(-\\lambda t)\n$$\n为了求得一年期累积发生率，我们将时间区间 $t$ 设为 1 年。\n$$\nCI(1) = 1 - \\exp(-\\lambda \\cdot 1) = 1 - \\exp(-\\lambda)\n$$\n现在我们代入计算出的 $\\lambda = 0.0002 \\text{ years}^{-1}$ 的值。乘积 $\\lambda t$ 是无量纲的，符合要求。\n$$\nCI(1) = 1 - \\exp(-0.0002)\n$$\n计算此值：\n$$\nCI(1) \\approx 1 - 0.999800019998... = 0.000199980001...\n$$\n题目要求将此值四舍五入到四位有效数字。第一位有效数字是 $1$。前四位有效数字是 $1, 9, 9, 9$。第五位有效数字是 $8$，这要求对第四位数字进行进位。将 $0.0001999$ 向上取整得到 $0.0002000$。尾部的零是有效的，因为它们表示了指定的精度水平。\n$$\nCI(1) \\approx 0.0002000\n$$\n\n最后，我们按要求提供通俗语言的解释。\n\n粗死亡率（$\\lambda$）的解释：\n粗死亡率为每人年 $0.0002$ 例死亡。对于决策者而言，这可以理解为在一年中的任何时刻作用于人口的平均“死亡力”。一个更具体的解释是，如果我们跟踪观察 $10,000$ 人整整一年，我们预计该群体中大约会发生 $10,000 \\times 0.0002 = 2$ 例死亡。这个量是一个率，而不是一个概率。\n\n一年期累积发生率（年风险，$CI(1)$）的解释：\n一年期累积发生率约为 $0.0002000$，即每年每 $10,000$ 人中有 $2$ 例。这个值是一个概率。它意味着，从年初的人口中随机选择一个个体，其在该年结束前死亡的平均概率为 $0.02\\%$。这为该人群中的个体提供了一年期风险的直接度量。",
            "answer": "$$\\boxed{0.0002000}$$"
        },
        {
            "introduction": "在比较不同年龄结构的人群时，粗死亡率可能会产生误导，因为年龄是死亡率的一个强决定因素。本练习将介绍一种解决此类混杂的强大技术——标准化。通过为一个群体构建一个使用另一群体年龄结构的反事实粗死亡率，我们可以更公平地比较它们潜在的死亡风险，从而区分真实死亡率差异与人口结构差异的影响。",
            "id": "4584676",
            "problem": "一个市卫生部门评估两个人群在单个$1$年期内的死亡率，期间迁入和迁出可忽略不计，因此统计的人口数可近似视为观察人年数。粗死亡率定义为总死亡人数除以总人年数。年龄别死亡率定义为特定年龄分层内的死亡人数除以该分层的人年数。该部门旨在通过为人群$A$构建一个反映人群$B$年龄结构的反事实粗死亡率，来了解人群$A$和人群$B$之间死亡率的粗差异在多大程度上可归因于年龄分布的差异。\n\n人群被划分为三个年龄分层：$0–39$岁，$40–64$岁，以及$\\geq 65$岁。观测数据如下：\n\n- 人群$A$：\n  - $0–39$岁：$320{,}000$人，$160$例死亡。\n  - $40–64$岁：$180{,}000$人，$540$例死亡。\n  - $\\geq 65$岁：$100{,}000$人，$2{,}500$例死亡。\n\n- 人群$B$：\n  - $0–39$岁：$500{,}000$人，$250$例死亡。\n  - $40–64$岁：$250{,}000$人，$500$例死亡。\n  - $\\geq 65$岁：$50{,}000$人，$1{,}000$例死亡。\n\n仅使用上述核心定义，完成以下任务：\n\n1. 从基本原理出发，构建人群$A$的反事实粗死亡率，即假设人群$A$保持其自身的年龄别死亡率，但采用人群$B$的年龄分布时所能观察到的死亡率。将此反事实粗死亡率以每$1{,}000$人年的死亡人数表示。\n\n2. 计算标准化对比值，此处定义为标准化差异与粗差异的比值。其中，标准化差异是人群$A$的反事实粗死亡率（构建以反映人群$B$的年龄分布）与人群$B$的粗死亡率之差，而粗差异是人群$A$和人群$B$的粗死亡率之差。\n\n按以下格式提供您的最终数值答案：\n- 人群$A$的反事实粗死亡率，以每$1{,}000$人年的死亡人数表示。\n- 标准化对比值，作为一个无量纲比率。\n\n将两个值均四舍五入至四位有效数字。在最终的方框答案中不要包含单位；在计算过程中说明任何必要的单位。",
            "solution": "该问题要求计算两个流行病学指标：一个反事实粗死亡率和一个标准化对比值。我们将首先验证问题陈述的有效性，然后进行逐步推导。\n\n### 问题验证\n问题被认为是有效的。它在科学上基于流行病学的既定原则，特别是粗死亡率、年龄别死亡率和直接标准化法的概念。问题提法得当，为所有待计算的量提供了所有必要的数据和清晰、明确的定义。数据对于大型人群而言在数值上是合理的。语言客观、正式。整个设定是自洽的，没有矛盾。该任务是生物统计学方法的一个标准（尽管是多步骤的）应用。\n\n### 解题推导\n设人群由索引 $i \\in \\{A, B\\}$ 表示，年龄分层由索引 $j \\in \\{1, 2, 3\\}$ 表示，分别对应 $0–39$ 岁、$40–64$ 岁和 $\\geq 65$ 岁。\n\n设 $D_{i,j}$ 为人群 $i$ 中年龄分层 $j$ 的死亡人数。\n设 $N_{i,j}$ 为人群 $i$ 中年龄分层 $j$ 的人数（近似为人年数）。\n\n人群 $i$ 在分层 $j$ 的年龄别死亡率定义为：\n$$m_{i,j} = \\frac{D_{i,j}}{N_{i,j}}$$\n人群 $i$ 的粗死亡率定义为总死亡人数除以总人口数：\n$$M_i = \\frac{\\sum_{j} D_{i,j}}{\\sum_{j} N_{i,j}} = \\frac{D_i}{N_i}$$\n粗死亡率也可以表示为年龄别死亡率的加权平均值，其中权重是各年龄分层的人口比例，$w_{i,j} = N_{i,j} / N_i$：\n$$M_i = \\sum_{j} m_{i,j} w_{i,j}$$\n\n**第一部分：人群A的反事实粗死亡率**\n\n我们被要求构建人群A的反事实粗死亡率（$M'_A$），即假设人群A具有其自身的年龄别死亡率（$m_{A,j}$），但采用人群B的年龄分布（$w_{B,j}$）时所观察到的死亡率。这是将人群A的死亡率以人群B的年龄结构进行直接标准化。公式为：\n$$M'_A = \\sum_{j=1}^{3} m_{A,j} w_{B,j}$$\n首先，我们计算所需的组成部分：人群A的年龄别死亡率（$m_{A,j}$）和人群B的年龄分布权重（$w_{B,j}$）。\n\n对于人群A，年龄别死亡率为：\n$m_{A,1} = \\frac{D_{A,1}}{N_{A,1}} = \\frac{160}{320000} = 0.0005$\n$m_{A,2} = \\frac{D_{A,2}}{N_{A,2}} = \\frac{540}{180000} = 0.003$\n$m_{A,3} = \\frac{D_{A,3}}{N_{A,3}} = \\frac{2500}{100000} = 0.025$\n\n对于人群B，总人口为 $N_B = 500000 + 250000 + 50000 = 800000$。年龄分布权重为：\n$w_{B,1} = \\frac{N_{B,1}}{N_B} = \\frac{500000}{800000} = \\frac{5}{8} = 0.625$\n$w_{B,2} = \\frac{N_{B,2}}{N_B} = \\frac{250000}{800000} = \\frac{5}{16} = 0.3125$\n$w_{B,3} = \\frac{N_{B,3}}{N_B} = \\frac{50000}{800000} = \\frac{1}{16} = 0.0625$\n\n现在，我们计算反事实率 $M'_A$：\n$$M'_A = m_{A,1} w_{B,1} + m_{A,2} w_{B,2} + m_{A,3} w_{B,3}$$\n$$M'_A = (0.0005)(0.625) + (0.003)(0.3125) + (0.025)(0.0625)$$\n$$M'_A = 0.0003125 + 0.0009375 + 0.0015625 = 0.0028125$$\n为将此率表示为每$1000$人年的死亡人数，我们乘以$1000$：\n$$M'_A \\text{ (per 1000)} = 0.0028125 \\times 1000 = 2.8125$$\n四舍五入到四位有效数字，反事实粗死亡率为每$1000$人年$2.813$例死亡。\n\n**第二部分：标准化对比值**\n\n标准化对比值 $C_{std}$ 定义为标准化差异 ($\\Delta_{std}$) 与粗差异 ($\\Delta_{crude}$) 的比值。\n$$C_{std} = \\frac{\\Delta_{std}}{\\Delta_{crude}}$$\n首先，我们计算两个人群的粗死亡率。\n对于人群A：\n$D_A = 160 + 540 + 2500 = 3200$\n$N_A = 320000 + 180000 + 100000 = 600000$\n$M_A = \\frac{D_A}{N_A} = \\frac{3200}{600000} = \\frac{8}{1500} \\approx 0.005333...$\n\n对于人群B：\n$D_B = 250 + 500 + 1000 = 1750$\n$N_B = 500000 + 250000 + 50000 = 800000$\n$M_B = \\frac{D_B}{N_B} = \\frac{1750}{800000} = \\frac{7}{3200} = 0.0021875$\n\n粗差异为：\n$$\\Delta_{crude} = M_A - M_B = \\frac{8}{1500} - \\frac{7}{3200} = \\frac{8 \\cdot 32 - 7 \\cdot 15}{48000} = \\frac{256 - 105}{48000} = \\frac{151}{48000}$$\n标准化差异定义为人群A的反事实粗死亡率与人群B的粗死亡率之差：\n$$\\Delta_{std} = M'_A - M_B = 0.0028125 - 0.0021875 = 0.000625$$\n以分数形式表示，$0.000625 = \\frac{1}{1600}$。\n\n现在我们可以计算标准化对比值：\n$$C_{std} = \\frac{\\Delta_{std}}{\\Delta_{crude}} = \\frac{1/1600}{151/48000} = \\frac{1}{1600} \\times \\frac{48000}{151} = \\frac{30}{151}$$\n以小数形式表示，结果是：\n$$C_{std} = \\frac{30}{151} \\approx 0.198675496...$$\n四舍五入到四位有效数字，标准化对比值为 $0.1987$。\n\n最终结果是：\n1. 人群A的反事实粗死亡率为每$1000$人年$2.813$例死亡。\n2. 标准化对比值为 $0.1987$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.813  0.1987 \\end{pmatrix}}$$"
        },
        {
            "introduction": "我们计算出的任何死亡率都只是基于样本数据的点估计值，其本身具有统计不确定性。为了做出可靠的科学推断，我们必须量化这种不确定性。本练习将演示如何为一个死亡率构建置信区间，为真实的潜在率值提供一个合理的范围，并反映我们估计的精确度。",
            "id": "4584619",
            "problem": "一个前瞻性工人群组在为期 $10$ 年的观察期内累积了总共 $185{,}000$ 人年的观察时间，在此期间追踪了由某种特定罕见职业危害导致的死亡。在此期间，有 $37$ 例死亡归因于此危害。假设事件来自一个均匀泊松过程，其恒定的粗病因别死亡率为 $r$（单位为死亡数/人年），因此在随访时间 $T$ 内的总死亡数 $D$ 满足 $D \\sim \\text{Poisson}(r T)$。仅使用计数数据的核心似然和大样本原理，通过在对数尺度上进行计算并使用标准正态分位数 $z_{0.975}$，推导 $r$ 在乘法尺度上的近似双侧 $95\\%$ 置信区间。然后计算这些数据的数值区间。将最终区间的端点表示为每 $1{,}000$ 人年的死亡数，并将答案四舍五入至三位有效数字。此外，简要解释在何种情况下，$D$ 的精确泊松限值比您推导的大样本近似更可取。",
            "solution": "该问题被认为是有效的，因为它在流行病学原理上有科学依据，数据充分，问题设定良好，并且表述客观。\n\n问题指出，在总随访时间 $T$ 人年内观察到的死亡数 $D$ 服从泊松分布。该分布的参数是 $\\lambda = rT$，其中 $r$ 是恒定的粗病因别死亡率。给定 $D=37$ 例死亡和 $T=185,000$ 人年。$D$ 的概率质量函数为：\n$$ P(D=k) = \\frac{\\exp(-\\lambda) \\lambda^k}{k!} = \\frac{\\exp(-rT) (rT)^k}{k!} $$\n我们的目标是求出率 $r$ 的 $95\\%$ 置信区间。\n\n首先，我们求 $r$ 的最大似然估计量（MLE）。给定观测值 $D$ 的似然函数是：\n$$ L(r; D, T) = \\frac{\\exp(-rT) (rT)^D}{D!} $$\n使用对数似然函数 $\\ell(r) = \\ln L(r)$ 更为方便：\n$$ \\ell(r) = \\ln\\left(\\frac{\\exp(-rT) (rT)^D}{D!}\\right) = -rT + D \\ln(rT) - \\ln(D!) $$\n$$ \\ell(r) = -rT + D\\ln(r) + D\\ln(T) - \\ln(D!) $$\n为了求出 MLE $\\hat{r}$，我们将 $\\ell(r)$ 对 $r$ 求导，并令结果为零：\n$$ \\frac{d\\ell}{dr} = -T + \\frac{D}{r} = 0 $$\n解出 $r$ 得到 MLE：\n$$ \\hat{r} = \\frac{D}{T} $$\n对于给定数据，率的点估计是：\n$$ \\hat{r} = \\frac{37}{185,000} = 0.0002 \\text{ deaths per person-year} $$\n\n问题指示我们在对数尺度上推导近似置信区间。这种方法有助于稳定方差，并确保得到的 $r$ 的置信区间是严格为正的。令 $\\theta = \\ln(r)$。$\\theta$ 的 MLE 是 $\\hat{\\theta} = \\ln(\\hat{r})$。\n\n我们需要 $\\hat{\\theta}$ 的方差。根据 MLE 的大样本理论，$\\hat{\\theta}$ 的方差可以用费雪信息量的倒数来近似。或者，我们可以使用德尔塔方法。$\\hat{r}$ 的方差是：\n$$ \\text{Var}(\\hat{r}) = \\text{Var}\\left(\\frac{D}{T}\\right) = \\frac{1}{T^2}\\text{Var}(D) $$\n由于 $D \\sim \\text{Poisson}(rT)$，其方差为 $\\text{Var}(D) = rT$。因此，\n$$ \\text{Var}(\\hat{r}) = \\frac{rT}{T^2} = \\frac{r}{T} $$\n德尔塔方法将函数 $g(\\hat{r})$ 的方差近似为 $\\text{Var}(g(\\hat{r})) \\approx [g'(r)]^2 \\text{Var}(\\hat{r})$。这里，$g(r) = \\ln(r)$，所以 $g'(r) = 1/r$。\n$$ \\text{Var}(\\hat{\\theta}) = \\text{Var}(\\ln(\\hat{r})) \\approx \\left(\\frac{1}{r}\\right)^2 \\text{Var}(\\hat{r}) = \\frac{1}{r^2} \\frac{r}{T} = \\frac{1}{rT} $$\n在实践中，我们通过代入 MLE $\\hat{r}$ 来估计此方差：\n$$ \\widehat{\\text{Var}}(\\ln(\\hat{r})) \\approx \\frac{1}{\\hat{r}T} = \\frac{1}{\\frac{D}{T}T} = \\frac{1}{D} $$\n因此，$\\ln(\\hat{r})$ 的标准误是：\n$$ \\text{SE}(\\ln(\\hat{r})) = \\sqrt{\\widehat{\\text{Var}}(\\ln(\\hat{r}))} \\approx \\frac{1}{\\sqrt{D}} $$\n对于大的 $D$，$\\ln(\\hat{r})$ 的分布近似为均值为 $\\ln(r)$、标准差为 $1/\\sqrt{D}$ 的正态分布。$\\theta = \\ln(r)$ 的双侧 $(1-\\alpha)100\\%$ 置信区间由下式给出：\n$$ \\hat{\\theta} \\pm z_{1-\\alpha/2} \\times \\text{SE}(\\hat{\\theta}) $$\n对于 $95\\%$ 置信区间，$\\alpha=0.05$，我们使用标准正态分位数 $z_{1-0.05/2} = z_{0.975} \\approx 1.96$。$\\ln(r)$ 的区间是：\n$$ \\ln(\\hat{r}) \\pm z_{0.975} \\frac{1}{\\sqrt{D}} $$\n代入给定值 $D=37$ 和 $z_{0.975} \\approx 1.96$：\n$$ \\ln\\left(\\frac{37}{185,000}\\right) \\pm 1.96 \\times \\frac{1}{\\sqrt{37}} $$\n为了获得率 $r$ 本身的置信区间，我们对 $\\ln(r)$ 区间的下限和上限取指数：\n$$ \\text{CI}(r) = \\exp\\left( \\ln(\\hat{r}) \\pm \\frac{z_{0.975}}{\\sqrt{D}} \\right) = \\hat{r} \\exp\\left( \\pm \\frac{z_{0.975}}{\\sqrt{D}} \\right) $$\n我们来计算数值。点估计为 $\\hat{r} = 0.0002$。区间的乘法因子是：\n$$ \\exp\\left(\\frac{1.96}{\\sqrt{37}}\\right) \\approx \\exp\\left(\\frac{1.96}{6.08276}\\right) \\approx \\exp(0.32220) \\approx 1.38015 $$\n$r$ 的下限是：\n$$ r_{\\text{lower}} = \\hat{r} \\exp\\left(-\\frac{z_{0.975}}{\\sqrt{D}}\\right) \\approx 0.0002 / 1.38015 \\approx 0.00014491 \\text{ deaths per person-year} $$\n$r$ 的上限是：\n$$ r_{\\text{upper}} = \\hat{r} \\exp\\left(+\\frac{z_{0.975}}{\\sqrt{D}}\\right) \\approx 0.0002 \\times 1.38015 \\approx 0.00027603 \\text{ deaths per person-year} $$\n问题要求最终答案以每 $1,000$ 人年的死亡数表示。我们将上下限乘以 $1,000$：\n$$ r_{\\text{lower}} \\approx 0.00014491 \\times 1000 = 0.14491 $$\n$$ r_{\\text{upper}} \\approx 0.00027603 \\times 1000 = 0.27603 $$\n将这些值四舍五入至三位有效数字，我们得到：\n$$ r_{\\text{lower}} \\approx 0.145 $$\n$$ r_{\\text{upper}} \\approx 0.276 $$\n死亡率的近似 $95\\%$ 置信区间是每 $1,000$ 人年 $0.145$ 至 $0.276$ 例死亡。\n\n最后，问题要求简要解释在何种情况下 $D$ 的精确泊松限值更可取。这里使用的大样本近似依赖于中心极限定理，在此背景下，这意味着 $\\ln(\\hat{r})$ 的抽样分布近似为正态分布。当观测到的事件数 $D$ 足够大（例如 $D \\ge 10$ 或 $20$）时，这种近似通常被认为是可靠的。在本题中，$D=37$，因此该近似预期是准确的。然而，如果事件数 $D$ 很小（例如 $D  10$），正态性假设将不成立。真实的抽样分布将是偏态的，在对数尺度上构建的对称区间其实际覆盖概率将不同于名义的 $95\\%$。在这种事件计数小的情况下，首选“精确”方法，例如 Clopper-Pearson 区间。精确方法直接从泊松分布的累积分布函数推导而来，不依赖于渐近正态近似，并保证至少达到名义覆盖水平，尽管它们可能偏于保守（即区间比必要的更宽）。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.145  0.276 \\end{pmatrix}} $$"
        }
    ]
}