{
    "hands_on_practices": [
        {
            "introduction": "这个练习是我们理解发病率-患病率-病程关系的核心。我们将从一个简单的两状态模型（即非患病态和患病态）出发，利用基本原理推导出在稳定状态下，发病率（$i$）、患病率（$P$）和平均病程（$D$）之间的精确数学关系。通过这个推导，我们不仅能掌握其精确公式 $P = \\frac{iD}{1+iD}$，还能深刻理解广为流传的近似公式 $P \\approx iD$ 的由来及其适用条件，即当 $iD$ 的值很小时。",
            "id": "4600275",
            "problem": "考虑一个大型的封闭种群，其中个体在两种相互排斥的状态之间转移：未患病和患病。假设以下科学上真实且内部一致的条件成立：\n- 总人口规模随时间保持不变。\n- 未患病个体的瞬时发病风险（率）为常数 $i$（每人年）。\n- 以恒定的风险 $\\mu$（每人年）脱离患病状态（通过康复或导致患病状态消除的死亡），因此平均患病期为 $D$ 年，且 $D = 1/\\mu$。\n- 所有转移都是无记忆的（持续时间呈指数分布），并且除了指定的转移外，没有其他竞争性转移。\n\n仅从物量平衡和上述假设出发，推导稳态患病率 $P^{\\ast}$ 作为 $i$ 和 $D$ 的函数的精确表达式。然后，使用一个对小 $iD$ 值成立的第一性原理近似，推导 $P^{\\ast}$ 的主阶近似。最后，对于 $i = 0.02$ /年 和 $D = 10$ 年，计算：\n1. 精确的稳态患病率 $P^{\\ast}$。\n2. 主阶近似患病率。\n3. 绝对近似误差，定义为 $|P_{\\text{approx}} - P^{\\ast}|$。\n\n将患病率和误差表示为小数比例。将所有报告的数值四舍五入到四位有效数字。按上述顺序列出你的最终数值结果。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个基于科学、定义明确且客观的问题陈述，其根植于流行病学房室模型的基本原理。所有必要信息均已提供，且问题内部一致。\n\n设 $N$ 为总人口规模，其为常数。设 $S(t)$ 和 $I(t)$ 分别表示在时间 $t$ 的未患病和患病个体数量。根据定义，对于所有 $t$，$S(t) + I(t) = N$。在时间 $t$ 的疾病患病率为 $P(t) = \\frac{I(t)}{N}$。\n\n系统的动态由患病个体数量的变化率 $\\frac{dI}{dt}$ 描述。这个变化由流入患病状态（新病例）和流出患病状态（康复或死亡）之间的平衡决定。\n\n新病例的发生率（流入）是未患病个体数量 $S(t)$ 与恒定的发病风险 $i$ 的乘积。\n$$\n\\text{Inflow rate} = i S(t)\n$$\n脱离患病状态的速率（流出）是患病个体数量 $I(t)$ 与恒定的脱离风险 $\\mu$ 的乘积。\n$$\n\\text{Outflow rate} = \\mu I(t)\n$$\n因此，患病房室的物量平衡方程为：\n$$\n\\frac{dI}{dt} = i S(t) - \\mu I(t)\n$$\n代入 $S(t) = N - I(t)$，我们得到控制患病个体数量的微分方程：\n$$\n\\frac{dI}{dt} = i(N - I(t)) - \\mu I(t) = iN - (i + \\mu)I(t)\n$$\n\n首先，我们推导稳态患病率 $P^{\\ast}$ 的精确表达式。在稳态下，每个状态中的个体数量是恒定的，这意味着净变化率为零。设 $I^{\\ast}$ 为稳态下的患病个体数量。令 $\\frac{dI}{dt} = 0$：\n$$\n0 = i(N - I^{\\ast}) - \\mu I^{\\ast}\n$$\n该方程表示稳态条件：流入等于流出。\n$$\ni(N - I^{\\ast}) = \\mu I^{\\ast}\n$$\n我们求解 $I^{\\ast}$：\n$$\niN - iI^{\\ast} = \\mu I^{\\ast}\n$$\n$$\niN = (i + \\mu)I^{\\ast}\n$$\n$$\nI^{\\ast} = \\frac{iN}{i + \\mu}\n$$\n稳态患病率 $P^{\\ast}$ 定义为 $P^{\\ast} = \\frac{I^{\\ast}}{N}$。\n$$\nP^{\\ast} = \\frac{1}{N} \\left( \\frac{iN}{i + \\mu} \\right) = \\frac{i}{i + \\mu}\n$$\n问题给出了平均患病期 $D$，它与脱离风险 $\\mu$ 的关系为 $D = \\frac{1}{\\mu}$。因此，我们可以写成 $\\mu = \\frac{1}{D}$。将此代入 $P^{\\ast}$ 的表达式中：\n$$\nP^{\\ast} = \\frac{i}{i + \\frac{1}{D}}\n$$\n分子和分母同乘以 $D$，得到稳态患病率作为 $i$ 和 $D$ 的函数的精确表达式：\n$$\nP^{\\ast} = \\frac{iD}{iD + 1}\n$$\n\n接下来，我们推导当 $iD$ 很小时的主阶近似。这个近似基于疾病是罕见的条件，意味着稳态患病率 $P^{\\ast}$ 很小 ($P^{\\ast} \\ll 1$)。如果 $P^{\\ast}$ 很小，那么患病个体数量 $I^{\\ast}$ 远小于总人口 $N$。因此，未患病个体数量 $S^{\\ast} = N - I^{\\ast}$ 约等于总人口，$S^{\\ast} \\approx N$。\n\n我们再次从稳态平衡方程出发：\n$$\ni S^{\\ast} = \\mu I^{\\ast}\n$$\n应用近似 $S^{\\ast} \\approx N$：\n$$\ni N \\approx \\mu I^{\\ast}\n$$\n现在，两边同除以 $N$ 并代入 $\\mu = \\frac{1}{D}$：\n$$\ni \\approx \\frac{\\mu I^{\\ast}}{N} = \\mu P^{\\ast} = \\frac{P^{\\ast}}{D}\n$$\n整理后得到众所周知近似关系：\n$$\nP_{\\text{approx}} = iD\n$$\n这就是主阶近似。我们可以通过对精确表达式 $P^{\\ast}(x) = \\frac{x}{1+x}$（其中 $x = iD$）进行泰勒级数展开来验证这个结果。对于小的 $x$，我们使用几何级数 $(1+x)^{-1} = 1 - x + x^2 - \\dots$。\n$$\nP^{\\ast} = \\frac{iD}{1+iD} = (iD)(1+iD)^{-1} = (iD)(1 - iD + (iD)^2 - \\dots) = iD - (iD)^2 + \\dots\n$$\n主阶项（展开式的第一项）确实是 $iD$。\n\n最后，我们计算 $i = 0.02 \\text{ year}^{-1}$ 和 $D = 10 \\text{ years}$ 时的数值。\n首先，我们计算无量纲乘积 $iD$：\n$$\niD = 0.02 \\times 10 = 0.2\n$$\n1. 精确的稳态患病率 $P^{\\ast}$：\n$$\nP^{\\ast} = \\frac{iD}{1 + iD} = \\frac{0.2}{1 + 0.2} = \\frac{0.2}{1.2} = \\frac{2}{12} = \\frac{1}{6}\n$$\n换算成小数，$P^{\\ast} = 0.16666...$。四舍五入到四位有效数字，结果是 $0.1667$。\n\n2. 主阶近似患病率 $P_{\\text{approx}}$：\n$$\nP_{\\text{approx}} = iD = 0.2\n$$\n表示为四位有效数字，结果是 $0.2000$。\n\n3. 绝对近似误差，$|P_{\\text{approx}} - P^{\\ast}|$：\n$$\n\\text{Error} = |P_{\\text{approx}} - P^{\\ast}| = \\left| 0.2 - \\frac{1}{6} \\right| = \\left| \\frac{1}{5} - \\frac{1}{6} \\right| = \\left| \\frac{6 - 5}{30} \\right| = \\frac{1}{30}\n$$\n换算成小数，误差为 $0.03333...$。四舍五入到四位有效数字，结果是 $0.03333$。\n结果按要求以小数比例形式呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1667  0.2000  0.03333 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在基础模型之上，这个练习引入了一个关键的现实复杂性：疾病本身可能导致额外的死亡风险。简单的模型往往假设个体仅通过康复来脱离患病状态，但这忽略了许多慢性病会缩短患者预期寿命的现实。通过建立一个包含疾病所致死亡率（$\\mu_c$）的模型，我们将定量地探索这种超额死亡风险如何影响疾病的平均“病程”，并最终改变其在人群中的稳定状态患病率。",
            "id": "4600254",
            "problem": "一个封闭种群被分为两种互斥的状态：易感者（没有慢性病的人）和患病者（患有慢性病的人）。设 $N$ 表示总人口规模，$S$ 表示易感者数量，$C$ 表示患病者数量，且 $N = S + C$。将患病率定义为 $P = C/N$。假设人均率不随时间变化且与年龄无关。人均易感者发病率为 $i$，因此新病例以 $i S$ 的流量出现。患病者以人均康复率 $r$ 康复，或以人均死亡率 $\\mu_{c}$ 死亡，从而脱离患病状态。易感者以人均死亡率 $\\mu_{s}$ 死亡。存在一个新生易感者的背景流入，该流入经过调整以使总人口规模 $N$ 随时间保持恒定。\n\n仅从患病库的流入和流出流量的定义以及患病率作为比例的定义出发，推导出稳态患病率 $P^{\\ast}$，用 $i$、$r$ 和 $\\mu_{c}$ 表示。然后，将其特化为康复可忽略不计的慢性病情况，取 $r = 0$。对于固定的发病率 $i = 0.02$ 每年和背景死亡率 $\\mu_{s} = 0.01$ 每年，假设患病者的死亡率升高为 $\\mu_{c} = 3\\,\\mu_{s}$ 每年。将 $P_{\\text{base}}$ 定义为患病者与易感者死亡率相同（即 $\\mu_{c} = \\mu_{s}$）时的稳态患病率，将 $P_{\\text{elev}}$ 定义为患病者死亡率升高（$\\mu_{c} = 3\\,\\mu_{s}$）下的稳态患病率。计算比率 $R = P_{\\text{elev}}/P_{\\text{base}}$。将 $R$ 的最终答案四舍五入至四位有效数字，并以小数形式表示。",
            "solution": "患病房室中个体数量 $C$ 的变化率 $\\frac{dC}{dt}$ 由流入和流出该房室的流量决定。\n$$ \\frac{dC}{dt} = (\\text{流入}) - (\\text{流出}) $$\n流入量是来自易感人群 $S$ 的新发病例，速率为 $iS$。流出量包括康复（速率 $rC$）和因病死亡（速率 $\\mu_c C$）。因此，控制方程为：\n$$ \\frac{dC}{dt} = iS - (r + \\mu_c)C $$\n在稳态下，各房室数量恒定，即 $\\frac{dC}{dt} = 0$。设稳态下的数量为 $C^*$ 和 $S^*$。\n$$ iS^* = (r + \\mu_c)C^* $$\n根据定义，患病率 $P = C/N$，易感者比例为 $S/N = (N-C)/N = 1-P$。因此，$S^* = N(1-P^*)$ 且 $C^* = NP^*$。代入稳态方程：\n$$ iN(1 - P^*) = (r + \\mu_c)NP^* $$\n总人口 $N$ 非零，可以从等式两边消去：\n$$ i(1 - P^*) = (r + \\mu_c)P^* $$\n求解稳态患病率 $P^*$：\n$$ i - iP^* = rP^* + \\mu_c P^* $$\n$$ i = (i + r + \\mu_c)P^* $$\n$$ P^* = \\frac{i}{i + r + \\mu_c} $$\n这是稳态患病率的一般表达式。对于康复可忽略不计的慢性病，我们设 $r=0$，公式简化为：\n$$ P^* = \\frac{i}{i + \\mu_c} $$\n现在我们使用给定的数值进行计算：$i = 0.02 \\text{ 每年}$ 和 $\\mu_s = 0.01 \\text{ 每年}$。\n\n对于基准情况 $P_{\\text{base}}$，患病者的死亡率与易感者相同，即 $\\mu_c = \\mu_s = 0.01 \\text{ 每年}$。\n$$ P_{\\text{base}} = \\frac{i}{i + \\mu_s} = \\frac{0.02}{0.02 + 0.01} = \\frac{0.02}{0.03} = \\frac{2}{3} $$\n对于死亡率升高的情况 $P_{\\text{elev}}$，患病者的死亡率为 $\\mu_c = 3\\mu_s = 3 \\times 0.01 = 0.03 \\text{ 每年}$。\n$$ P_{\\text{elev}} = \\frac{i}{i + 3\\mu_s} = \\frac{0.02}{0.02 + 0.03} = \\frac{0.02}{0.05} = \\frac{2}{5} $$\n最后，计算比率 $R = P_{\\text{elev}}/P_{\\text{base}}$：\n$$ R = \\frac{P_{\\text{elev}}}{P_{\\text{base}}} = \\frac{2/5}{2/3} = \\frac{2}{5} \\times \\frac{3}{2} = \\frac{3}{5} = 0.6 $$\n将答案四舍五入到四位有效数字，得到 $R = 0.6000$。",
            "answer": "$$\n\\boxed{0.6000}\n$$"
        },
        {
            "introduction": "流行病学理论的最终目的是应用于公共卫生实践。这个练习将理论与实际数据分析联系起来，展示了如何利用患病率（$P$）和病程（$D$）的观测估计值来反向推算难以直接测量的发病率（$i$）。我们将运用从精确关系 $P = \\frac{iD}{1+iD}$ 推导出的公式 $i = \\frac{P}{(1-P)D}$，并结合统计学中的德尔塔方法（delta method），为一个基于样本数据的发病率估计值构建一个置信区间，这是生物统计学中的一项基本技能。",
            "id": "4600271",
            "problem": "在一个封闭、稳定的群体中，对于一种可逆的非致命性疾病，假设其疾病过程可建模如下：个体以恒定的发病率 $i$（每单位时间）患病，在患病个体中，恢复所需时间是独立的，且服从均值为 $D$ 的指数分布。在这些假设和稳态条件下，长期患病率 $P$ 由发病流入和恢复流出的平衡决定。从这些核心定义和事实出发，首先推导一个将 $i$ 表示为 $P$ 和 $D$ 的函数的精确恒等式，该恒等式不含近似。\n\n一项大型横断面调查提供了患病率的估计值 $\\hat{P}$ 及其已知标准误，一项独立的队列研究提供了平均病程的估计值 $\\hat{D}$ 及其已知标准误。假设如下：\n- $\\hat{P} = 0.12$，标准误为 $\\operatorname{SE}(\\hat{P}) = 0.01$，\n- $\\hat{D} = 3.0$ 年，标准误为 $\\operatorname{SE}(\\hat{D}) = 0.3$ 年，\n- $\\hat{P}$ 和 $\\hat{D}$ 近似无偏且独立，根据中心极限定理（CLT），其抽样分布近似为正态分布。\n\n使用您推导出的关于 $P$ 和 $D$ 的 $i$ 的精确恒等式，通过在对数尺度上应用一阶 delta 方法来稳定方差并确保正定性，为发病率 $i$ 构建一个 $95\\%$ 的置信区间。以每年为单位表示最终的区间端点，并将您的两个数值答案四舍五入到三位有效数字。最终答案必须仅为两个数值端点，不带单位。",
            "solution": "我们从稳态、可逆的两状态模型开始，该模型中，以恒定速率 $i$ 流入疾病状态，恢复过程呈指数分布，平均病程为 $D$。设 $P$ 表示群体中处于患病状态的长期比例。在稳态下，预期的患病比例满足平衡关系，即流入疾病状态的流量在期望上等于流出疾病状态的流量。在恒定发病率 $i$ 和恢复率为 $1/D$ 的指数恢复条件下，处于患病状态的平稳概率为\n$$\nP = \\frac{i}{i + 1/D} = \\frac{iD}{1 + iD}.\n$$\n求解该恒等式以得到 $i$：\n$$\nP = \\frac{iD}{1 + iD}\n\\quad\\Longrightarrow\\quad\nP(1 + iD) = iD\n\\quad\\Longrightarrow\\quad\nP + PiD = iD\n\\quad\\Longrightarrow\\quad\nP = iD(1 - P)\n\\quad\\Longrightarrow\\quad\ni = \\frac{P}{(1-P)D}.\n$$\n等价地，记患病率比值 $PO = P/(1-P)$，则有 $i = PO/D$。这是由稳态模型所蕴含的精确变换。\n\n给定估计量 $\\hat{P}$ 和 $\\hat{D}$，一个自然的代入估计量是\n$$\n\\hat{i} = \\frac{\\hat{P}}{(1-\\hat{P})\\hat{D}}.\n$$\n当 $\\hat{P} = 0.12$ 且 $\\hat{D} = 3.0$ 时，我们计算\n$$\n\\hat{i} = \\frac{0.12}{(1-0.12)\\times 3.0} = \\frac{0.12}{0.88 \\times 3.0} = \\frac{0.12}{2.64} = \\frac{3}{22} \\times \\frac{1}{3} = \\frac{1}{22} \\approx 0.0454545.\n$$\n\n为了在构建置信区间的同时保持正定性并改善对称性，我们在对数尺度上进行操作。定义平滑函数\n$$\ng(P,D) = \\ln\\!\\left(\\frac{P}{1-P}\\right) - \\ln D,\n$$\n因此 $\\ln i = g(P,D)$ 且 $\\ln \\hat{i} = g(\\hat{P},\\hat{D})$。根据 delta 方法，如果 $\\hat{P}$ 和 $\\hat{D}$ 近似独立且服从正态分布，其方差分别为 $\\operatorname{Var}(\\hat{P}) = \\operatorname{SE}(\\hat{P})^{2}$ 和 $\\operatorname{Var}(\\hat{D}) = \\operatorname{SE}(\\hat{D})^{2}$，则\n$$\n\\operatorname{Var}\\!\\big(g(\\hat{P},\\hat{D})\\big) \\approx\n\\left(\\frac{\\partial g}{\\partial P}\\Big|_{(\\hat{P},\\hat{D})}\\right)^{2}\\operatorname{Var}(\\hat{P})\n+\n\\left(\\frac{\\partial g}{\\partial D}\\Big|_{(\\hat{P},\\hat{D})}\\right)^{2}\\operatorname{Var}(\\hat{D}),\n$$\n因为根据独立性，$\\operatorname{Cov}(\\hat{P},\\hat{D}) \\approx 0$。\n\n我们计算梯度分量：\n$$\n\\frac{\\partial g}{\\partial P} = \\frac{\\partial}{\\partial P}\\left[\\ln P - \\ln(1-P)\\right] = \\frac{1}{P} + \\frac{1}{1-P} = \\frac{1}{P(1-P)},\n$$\n$$\n\\frac{\\partial g}{\\partial D} = \\frac{\\partial}{\\partial D}(-\\ln D) = -\\frac{1}{D}.\n$$\n在 $(\\hat{P},\\hat{D}) = (0.12, 3.0)$ 处求值，\n$$\n\\frac{\\partial g}{\\partial P}\\Big| = \\frac{1}{0.12 \\times 0.88} = \\frac{1}{0.1056} \\approx 9.469697,\\quad\n\\frac{\\partial g}{\\partial D}\\Big| = -\\frac{1}{3.0} \\approx -0.333333.\n$$\n方差为\n$$\n\\operatorname{Var}(\\hat{P}) = (0.01)^{2} = 0.0001,\\quad \\operatorname{Var}(\\hat{D}) = (0.3)^{2} = 0.09.\n$$\n因此，\n$$\n\\operatorname{Var}\\!\\big(\\ln \\hat{i}\\big) \\approx \\left(9.469697\\right)^{2}\\times 0.0001 + \\left(0.333333\\right)^{2}\\times 0.09.\n$$\n计算每一项：\n$$\n\\left(9.469697\\right)^{2} \\approx 89.678261,\\quad 89.678261 \\times 0.0001 \\approx 0.008967826,\n$$\n$$\n\\left(0.333333\\right)^{2} \\approx 0.111111,\\quad 0.111111 \\times 0.09 = 0.01.\n$$\n于是，\n$$\n\\operatorname{Var}\\!\\big(\\ln \\hat{i}\\big) \\approx 0.008967826 + 0.01 = 0.018967826,\\quad\n\\operatorname{SE}\\!\\big(\\ln \\hat{i}\\big) \\approx \\sqrt{0.018967826} \\approx 0.13773.\n$$\n\n$\\ln i$ 的一个近似 $95\\%$ 置信区间是\n$$\n\\ln \\hat{i} \\pm z_{0.975}\\,\\operatorname{SE}\\!\\big(\\ln \\hat{i}\\big),\n$$\n其中 $z_{0.975} \\approx 1.96$。我们有\n$$\n\\ln \\hat{i} = \\ln\\!\\left(\\frac{1}{22}\\right) = -\\ln(22) \\approx -3.091042,\n$$\n和\n$$\n1.96 \\times 0.13773 \\approx 0.26995.\n$$\n因此，\n$$\n\\text{对数尺度下限} \\approx -3.091042 - 0.26995 = -3.36099,\\quad\n\\text{对数尺度上限} \\approx -3.091042 + 0.26995 = -2.82109.\n$$\n取指数可得 $i$ 的置信区间：\n$$\ni \\in \\left[\\exp(-3.36099),\\ \\exp(-2.82109)\\right] \\approx \\left[0.0347,\\ 0.0595\\right]\\ \\text{每年}。\n$$\n等价地，利用对数尺度上关于 $\\ln \\hat{i}$ 的对称性，\n$$\n\\left[\\hat{i}\\exp(-1.96\\,\\operatorname{SE}(\\ln \\hat{i})),\\ \\hat{i}\\exp(1.96\\,\\operatorname{SE}(\\ln \\hat{i}))\\right]\n=\n0.0454545 \\times [\\exp(-0.26995),\\ \\exp(0.26995)]\n\\approx [0.0347,\\ 0.0595].\n$$\n\n四舍五入到三位有效数字，并以每年为单位表示端点（单位不包含在最终方框答案中），$95\\%$ 置信区间的端点为 $0.0347$ 和 $0.0595$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.0347  0.0595\\end{pmatrix}}$$"
        }
    ]
}