## 引言
在流行病学中，量化疾病在人群中的分布与动态是理解和控制疾病负担的基础。其中，发病率（新病例的流入速率）、患病率（现存病例的存量）与病程（病例的持续时间）之间的关系，构成了一个核心的理论基石。然而，许多从业者仅熟悉其近似形式 $P \approx i \times D$，却对其背后的数学原理、关键假设及其在复杂现实场景中的应用与局限性缺乏深入理解。本文旨在填补这一知识鸿沟。在接下来的内容中，我们首先将在“原理与机制”一章中，从第一性原理出发，建立[动态平衡模型](@entry_id:197754)，推导出精确的数学关系。随后，在“应用与跨学科联系”一章中，我们将通过丰富的实例，展示这一关系如何在疾病监测、干预评估和卫生资源规划中发挥关键作用。最后，通过“动手实践”部分的交互式练习，读者将有机会亲手应用这些概念，巩固对理论的掌握，并探索其在更复杂情境下的延伸。

## 原理与机制

在流行病学中，理解疾病在人群中的动态分布是核心任务之一。发病率、患病率和病程之间的关系是描述这一动态的基石。本章将深入探讨这些概念的内在原理和它们相互作用的机制。我们将从基本定义出发，建立一个[动态平衡模型](@entry_id:197754)，推导出精确的数学关系，并阐明在公共卫生实践中广泛使用的近似公式的理论基础及其局限性。

### 基本概念：定义三要素 (P, i, D)

为了建立三者之间的严谨关系，我们必须首先精确地定义每一个组成部分。

#### 患病率 (Prevalence, $P$)

**患病率**衡量的是在特定时间点，人群中患有某种疾病的个体所占的比例。在我们的讨论中，除非特别说明，患病率指的是**点患病率 (point prevalence)**，即在某个精确时刻（如2023年1月1日中午12点）患病人数与总人口数的比值。它是一个无量纲的比例，取值范围为 $0$ 到 $1$。

将点患病率与**期间患病率 (period prevalence)**区分开来至关重要。期间患病率衡量的是在一段时期内（例如，一年中）任何时间点患病过的个体占总人口的比例。期间患病率的分子既包括期初的存量病例，也包括期间发生的新发病例。点患病率则是一个“快照”，而期间患病率则是一个“时间窗口”内的累[积度量](@entry_id:637352)。随着时间窗口 $\Delta t$ 趋近于零，在一定的数学[正则性条件](@entry_id:166962)下，期间患病率会收敛于点患病率 。

#### 发病率 (Incidence, $i$)

**发病率**衡量的是在特定时期内，高危人群中新发病例的出现速度。与患病率不同，发病率不是一个静态的比例，而是一个动态的速率。在本书中，我们关注的是**发病率 (incidence rate)**，也称为**发病密度 (incidence density)**或**风险率 (hazard rate)**。它的定义是，在单位“人-时”内发生的新发病例数。例如，其单位可能是“每1000人年”。

发病率的分母是**人-时 (person-time)**，即人群中每个个体处于疾病风险状态下所贡献的观察[时间总和](@entry_id:148146)。这意味着已经患病或通过其他方式不再有患病风险的个体，将不再对分母的人-时做出贡献。发病率的量纲是时间的倒数（即 $T^{-1}$）。

我们必须将发病率与**累积发病率 (cumulative incidence)** 或**风险 (risk)** 区分开来。累积发病率是在一个特定时期内，一个初始无病的封闭队列中发生新发病例的比例。它是一个无量纲的概率，而发病率是一个速率 。如果一个恒定的发病率 $i$ 作用于一个队列，那么在时间 $\Delta t$ 内的累积发病率 $CI$ 是 $CI = 1 - \exp(-i \cdot \Delta t)$，而非简单的 $i \cdot \Delta t$。

#### 病程 (Duration, $D$)

**病程**指的是从疾病发作到结束（因痊愈或死亡）的平均时间长度。病程的定义必须与患病率和发病率的定义相匹配，以确保模型的一致性。

对于只会发作一次的疾病，病程的定义相对直接。但对于可**复发性疾病**，例如哮喘或抑郁症，精确定义至关重要。如果我们将“患病状态”定义为“有症状的时期”，那么相应的，**发病率**就应该衡量症状期开始的速率，而**病程 ($D$)** 则必须定义为**单次发作的平均持续时间**，不包括两次发作之间的无症状期。换言之，我们关心的是在“患病”这个状态下的[平均停留时间](@entry_id:181819)。将无症状期计入病程会破坏发病率、患病率和病程之间基于流量平衡的基本关系 。

### 核心关系：从动态平衡到[稳态](@entry_id:139253)

发病率、患病率和病程之间的关系源于一个简单的**守恒原理**：在一个稳定的人群中，患病人群数量的变化率等于进入该人群的流量（新发病例）减去离开该人群的流量（痊愈或死亡）。

我们可以构建一个简单的两状态（易感态和患病态）模型来形式化这个思想。设 $P(t)$ 为 $t$ 时刻的患病率，那么易感人群的比例为 $1 - P(t)$。设 $i$ 为易感人群中的发病率（单位：时间$^{-1}$），$\mu$ 为患病人群的离开率（单位：时间$^{-1}$）。这个离开率 $\mu$ 正是平均病程 $D$ 的倒数，即 $\mu = 1/D$。

进入患病人群的流量率为：
$$ \text{流入率} = i \times (1 - P(t)) $$

离开患病人群的流量率为：
$$ \text{流出率} = \mu \times P(t) = \frac{1}{D} P(t) $$

因此，患病率随时间变化的[微分](@entry_id:158422)方程为 ：
$$ \frac{dP(t)}{dt} = \text{流入率} - \text{流出率} = i(1 - P(t)) - \mu P(t) $$

这个[一阶线性常微分方程](@entry_id:164502)的解为：
$$ P(t) = \frac{i}{i + \mu} + \left(P_0 - \frac{i}{i + \mu}\right)\exp(-(i + \mu)t) $$
其中 $P_0$ 是初始患病率。这个解清晰地揭示了系统的动态行为。第二项是一个**瞬态部分**，它会随时间指数衰减。第一项 $\frac{i}{i + \mu}$ 是一个**[稳态](@entry_id:139253)部分**，代表了当 $t \to \infty$ 时系统最终达到的**平衡患病率 (equilibrium prevalence)**。

在流行病学中，我们通常假设疾病在一个所谓的**[稳态](@entry_id:139253) (steady state)**下进行分析。这意味着系统已经达到了平衡，患病率不再随时间变化，即 $\frac{dP(t)}{dt} = 0$。在此条件下，流入率精确地等于流出率。

### 精确关系的推导

从[稳态](@entry_id:139253)条件 $\frac{dP}{dt} = 0$ 出发，我们得到：
$$ i(1 - P) = \frac{P}{D} $$

这个简单的代数方程是我们所有后续推导的基石。通过对它进行变形，我们可以得到两个非常重要的精确关系。

#### 关系一：患病优势比

将上述方程两边同时乘以 $D$，我们得到：
$$ iD(1 - P) = P $$

然后，两边同时除以 $(1 - P)$，得到：
$$ iD = \frac{P}{1 - P} $$

方程的右侧 $\frac{P}{1 - P}$ 正是**患病优势比 (prevalence odds)** 的定义，即患病概率与不患病概率之比。因此，我们得到了第一个精确的定律 ：

**患病优势比 = 发病率 × 病程**

这个关系是精确的，它不依赖于疾病是否罕见。它揭示了发病率和病程的乘积 $iD$ 直接决定了患病的“优势”。如果 $i$ 增加一倍而 $D$ 减半，乘积 $iD$ 不变，那么患病优势比也将保持不变。

#### 关系二：患病率

我们可以直接从方程 $iD = \frac{P}{1 - P}$ 求解患病率 $P$。
$$ iD(1 - P) = P $$
$$ iD - iDP = P $$
$$ iD = P(1 + iD) $$

由此得到第二个精确关系 ：
$$ P = \frac{iD}{1 + iD} $$

这个公式精确地描述了患病率 $P$ 是如何由发病率-病程乘积 $iD$ 决定的。它清晰地表明，患病率与 $iD$ 之间是一种非线性关系。无论 $iD$ 多大，患病率 $P$ 总是小于1，这符合其作为比例的物理意义。

### 广泛应用的近似公式：$P \approx iD$

在流行病学文献和实践中，最常见的关系是线性近似公式 $P \approx iD$。这个公式的简洁性使其极具吸[引力](@entry_id:189550)，但理解其推导过程和适用条件至关重要。

该近似公式来源于一个核心假设：**疾病罕见 (rare disease assumption)**。当患病率 $P$ 非常小（$P \ll 1$）时，我们可以进行如下近似：
1.  在患病优势比的定义中，$1-P \approx 1$，因此患病优势比 $\frac{P}{1-P} \approx P$。将此代入第一个精确关系 $iD = \frac{P}{1-P}$，我们直接得到 $iD \approx P$。
2.  在第二个精确关系 $P = \frac{iD}{1 + iD}$ 中，如果 $P$ 很小，那么必然有 $iD \ll 1$。此时，分母 $1+iD \approx 1$，因此 $P \approx iD$。

这两种推导殊途同归。这个近似的根本原因在于，当疾病罕见时，绝大多数人口都处于易感状态，因此易感人群的规模约等于总人口规模。在这种情况下，因患病而导致的易感者“耗竭”可以忽略不计 。

然而，当疾病不再罕见时，这个线性近似的误差会迅速增大。我们可以精确地量化这个误差。近似值 $P_{\text{lin}} = iD$ 与真实值 $P = \frac{iD}{1+iD}$ 之间的[绝对误差](@entry_id:139354)为 ：
$$ E_{\text{abs}} = |P_{\text{lin}} - P| = \left|iD - \frac{iD}{1 + iD}\right| = \frac{(iD)^2}{1 + iD} $$

例如，考虑不同 $iD$ 值下的近似误差：
-   若 $iD = 0.05$（对应罕见病），真实 $P \approx 0.0476$，[绝对误差](@entry_id:139354)约为 $0.0024$。近似公式的误差很小。
-   若 $iD = 0.5$（对应较常见疾病），真实 $P \approx 0.3333$，[绝对误差](@entry_id:139354)约为 $0.1667$。此时近似值 $0.5$ 比真实值高出 $50\%$，误差已不可接受。
-   若 $iD = 1.0$，真实 $P = 0.5$，而近似值 $P_{\text{lin}} = 1.0$。这不仅误差巨大，而且得出了一个物理上不可能的结论（患病率为100%）。

因此，使用 $P \approx iD$ 时必须谨慎，始终要评估疾病是否满足“罕见”的条件。对于常见病，使用精确公式 $P = \frac{iD}{1 + iD}$ 或 $iD = \frac{P}{1-P}$ 是唯一严谨的选择 。

### 理论基础与核心假设

上述关系的成立依赖于一系列明确的假设，这些假设共同定义了一个理想化的模型系统。

#### [稳态](@entry_id:139253)与平稳性

最核心的假设是系统处于**[稳态](@entry_id:139253)**。这意味着驱动系统的参数，即发病率 $i$ 和病程 $D$（或离开率 $\mu$），在感兴趣的时间尺度内是恒定的。只有在这种情况下，系统才能达到一个真正的平衡，使得患病率 $P$ 也成为一个不随时间变化的常数。

在更深入的讨论中，区分**[稳态](@entry_id:139253) (steady state)**、**平衡 (equilibrium)** 和 **[平稳性](@entry_id:143776) (stationarity)** 是有益的 。
-   **平衡**是动力系统的概念，指系统状态不再变化（$\frac{dP}{dt} = 0$）。这可以是因为流量为零，也可以是因为流入和流出达到动态平衡。
-   **[稳态](@entry_id:139253)**通常指一种特殊的平衡，即不仅系统状态恒定，驱动系统的外部参数（如$i$和$\mu$）也是恒定的。
-   **[平稳性](@entry_id:143776)**是[随机过程](@entry_id:268487)的概念，指过程的统计特性（如均值、方差）不随时间改变。一个[随机过程](@entry_id:268487)可以是平稳的，但其具体实现（样本路径）在微观上是波动的。

我们的确定性模型假设了一个[稳态](@entry_id:139253)，这可以看作是巨大人口规模下平稳[随机过程](@entry_id:268487)的宏观平均。

#### 封闭人群

我们的推导假设人群是**封闭的**，即没有迁入和迁出。如果存在人口迁移，那么守恒方程需要增加迁移项。只有当净迁移对患病人群数量的影响为零时（例如，迁入人群的患病率与迁出人群的患病率相同，且等于本地人群患病率），简单的流量[平衡模型](@entry_id:636099)才依然成立 。

#### 独立性与同质性

该模型隐含地假设人群是**同质的**，或者至少发病风险与病程长短在人群中是相互独立的。如果在一个异质性人群中，高发病风险的亚群（高 $i_k$）恰好也有较短的病程（低 $D_k$），那么将人群平均的 $\bar{i}$ 和 $\bar{D}$ 直接代入 $P \approx \bar{i}\bar{D}$ 会产生**聚合偏倚 (aggregation bias)**。因此，该公式在人群层面的有效性要求发病风险与病程之间不存在相关性 。此外，模型还假设患病率本身不会反过来影响发病率（除了移除易感者），这对于通过行为改变来预防的非传染性疾病可能是一个需要审视的假设 。

#### 与[排队论](@entry_id:274141)的类比：[利特尔定律](@entry_id:271523)

发病率-患病率-病程关系在概念上与运筹学中的**[利特尔定律](@entry_id:271523) (Little's Law)** 完[全等](@entry_id:194418)价。[利特尔定律](@entry_id:271523)指出，在一个处于[稳态](@entry_id:139253)的[排队系统](@entry_id:273952)中，系统中的平均顾客数 ($L$) 等于顾客的平均[到达率](@entry_id:271803) ($\lambda$) 乘以每个顾客在系统中的平均逗留时间 ($W$)，即 $L = \lambda W$。

我们可以建立如下类比 ：
-   **系统中的顾客 (Customers)** $\leftrightarrow$ **患病个体 (Prevalent cases)**
-   **平均顾客数 ($L$)** $\leftrightarrow$ **平均患病人数 ($N \times P$)**
-   **顾客[到达率](@entry_id:271803) ($\lambda$)** $\leftrightarrow$ **新发病例率 (Incidence rate, $i \times N(1-P)$)**
-   **平均逗留时间 ($W$)** $\leftrightarrow$ **平均病程 ($D$)**

将这些对应关系代入[利特尔定律](@entry_id:271523)：
$$ N \times P = (i \times N(1-P)) \times D $$
两边同除以 $N$，我们便重新得到了 $P = i(1-P)D$。这个类比提供了一个强大而直观的方式来理解为什么这三个量必须以这种方式联系在一起：患病存量是新发流量在平均病程这段时间内的累积。[利特尔定律](@entry_id:271523)成立的条件，如系统平稳性和遍历性，也与我们在流行病学模型中所需的[稳态](@entry_id:139253)和[同质性](@entry_id:636502)假设[一一对应](@entry_id:143935)。

综上所述，发病率-患病率-病程关系是一个强大但有其适用边界的工具。作为流行病学家，我们的任务不仅是应用这些公式，更要批判性地审视其背后的假设在特定研究情境中是否成立。