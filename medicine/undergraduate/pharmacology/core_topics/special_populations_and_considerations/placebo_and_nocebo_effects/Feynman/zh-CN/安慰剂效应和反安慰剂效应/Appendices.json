{
    "hands_on_practices": [
        {
            "introduction": "在启动任何临床试验之前，一个基础且至关重要的问题是：我们需要多少参与者？这个问题不仅关系到研究的成本和可行性，更直接影响到研究结果的统计效力。本练习将引导你从中心极限定理等基本原理出发，推导出计算双臂随机对照试验所需样本量的公式，让你深入理解统计功效、显著性水平、效应大小和数据变异性是如何共同决定一项研究能否科学、可靠地检验药物与安慰剂之间的差异的。",
            "id": "4979630",
            "problem": "一个药理学团队正在设计一项随机、双盲、安慰剂对照试验，以评估一种镇痛药的效果，同时考虑到安慰剂和反安慰剂效应对主观疼痛报告的影响。设主要终点为给药后一个固定时间点测量的、在连续标度上的疼痛强度变化。假设在每个组内，个体结果是独立同分布的，具有共同方差 $\\sigma^{2}$，并且分配是均衡的，每组有 $n$ 名参与者。设 $\\mu_{D}$ 和 $\\mu_{P}$ 分别表示药物组和安慰剂组的真实平均结果。该团队旨在设计一个关于 $H_{0}: \\mu_{D}-\\mu_{P}=0$ 对 $H_{1}: \\mu_{D}-\\mu_{P}\\neq 0$ 的双侧假设检验，将I类错误概率控制在水平 $\\alpha$，并达到 $1-\\beta$ 的功效，以检测一个预先设定的、具有临床意义的平均差异 $\\Delta>0$。\n\n仅从中心极限定理（CLT）、样本均值的抽样分布和正态分布的性质出发，推导在方差已知的大样本 $Z$ 检验下，为达到所述的I类错误和功效目标所需的每组最小样本量 $n$ 的闭式表达式。您可以假设：\n- 组间和组内独立。\n- 等量分配（每组 $n$ 名参与者）。\n- 一个基于标准正态分位数 $z_{1-\\alpha/2}$ 的双侧拒绝域，其中对于 $Z\\sim \\mathcal{N}(0,1)$，$z_{p}$ 由 $\\mathbb{P}(Z\\leq z_{p})=p$ 定义。\n\n将您的最终答案表示为用 $\\sigma^{2}$、$\\Delta$、$z_{1-\\alpha/2}$ 和 $z_{1-\\beta}$ 表示的关于 $n$ 的单个解析表达式。不要代入数值。最终答案必须是一个无单位的单一闭式表达式。",
            "solution": "问题陈述已经过验证，被认为是合理的。这是生物统计学中一个适定、有科学依据且客观的问题，代表了双样本 Z 检验的标准樣本量计算。所有必要的信息和约束都已提供且无矛盾。因此，我们可以进行推导。\n\n目标是为均值的双样本检验推导每组所需样本量 $n$ 的表达式。设 $\\bar{X}_{D}$ 和 $\\bar{X}_{P}$ 分别是药物组和安慰剂组中疼痛强度变化的样本均值。每组有 $n$ 名参与者。个体结果被假设为独立同分布，具有共同方差 $\\sigma^{2}$。\n\n根据中心极限定理（CLT），对于足够大的样本量 $n$，样本均值的抽样分布近似为正态分布。\n对于药物组，样本均值 $\\bar{X}_{D}$ 近似服从均值为 $\\mu_{D}$、方差为 $\\frac{\\sigma^{2}}{n}$ 的正态分布。我们将其写作 $\\bar{X}_{D} \\sim \\mathcal{N}\\left(\\mu_{D}, \\frac{\\sigma^{2}}{n}\\right)$。\n类似地，对于安慰剂组，$\\bar{X}_{P} \\sim \\mathcal{N}\\left(\\mu_{P}, \\frac{\\sigma^{2}}{n}\\right)$。\n\n该检验关注的是均值之差 $\\mu_{D} - \\mu_{P}$。这个差的估计量是 $\\bar{X}_{D} - \\bar{X}_{P}$。由于两组是独立的，它们的样本均值之差也近似服从正态分布。\n该差值的均值是 $E[\\bar{X}_{D} - \\bar{X}_{P}] = E[\\bar{X}_{D}] - E[\\bar{X}_{P}] = \\mu_{D} - \\mu_{P}$。\n该差值的方差是 $\\text{Var}(\\bar{X}_{D} - \\bar{X}_{P}) = \\text{Var}(\\bar{X}_{D}) + \\text{Var}(\\bar{X}_{P}) = \\frac{\\sigma^{2}}{n} + \\frac{\\sigma^{2}}{n} = \\frac{2\\sigma^{2}}{n}$。\n因此，样本均值之差的抽样分布是 $\\bar{X}_{D} - \\bar{X}_{P} \\sim \\mathcal{N}\\left(\\mu_{D} - \\mu_{P}, \\frac{2\\sigma^{2}}{n}\\right)$。\n\n零假设是 $H_{0}: \\mu_{D} - \\mu_{P} = 0$。在 $H_{0}$ 下，检验统计量 $Z$ 是通过将观察到的样本均值之差标准化来构建的：\n$$Z = \\frac{(\\bar{X}_{D} - \\bar{X}_{P}) - 0}{\\sqrt{\\frac{2\\sigma^{2}}{n}}} = \\frac{\\bar{X}_{D} - \\bar{X}_{P}}{\\sqrt{\\frac{2\\sigma^{2}}{n}}}$$\n在 $H_{0}$ 下，该统计量服从标准正态分布，$Z \\sim \\mathcal{N}(0, 1)$。\n\n该检验的双侧I类错误率为 $\\alpha$。如果 $|Z|$ 的观测值大于临界值 $z_{1-\\alpha/2}$，我们就拒绝 $H_{0}$，其中 $z_{1-\\alpha/2}$ 是标准正态分布的分位数，使得 $\\mathbb{P}(Z \\leq z_{1-\\alpha/2}) = 1-\\alpha/2$。\n因此，拒绝法则为 $|Z| > z_{1-\\alpha/2}$。\n这等价于如果 $\\frac{|\\bar{X}_{D} - \\bar{X}_{P}|}{\\sqrt{2\\sigma^{2}/n}} > z_{1-\\alpha/2}$ 则拒绝 $H_{0}$，这可以重写为：\n$$|\\bar{X}_{D} - \\bar{X}_{P}| > z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}}$$\n\n接下来，我们施加功效要求。功效是 $1-\\beta$，即当备择假设 $H_{1}$ 为真时正确拒绝 $H_{0}$ 的概率。我们被给定一个感兴趣的特定备择假设，其中真实均值差为 $\\mu_{D} - \\mu_{P} = \\Delta$，且 $\\Delta > 0$。\n功效定义为 $\\mathbb{P}(\\text{reject } H_{0} | \\mu_{D} - \\mu_{P} = \\Delta) = 1-\\beta$。\nII类错误 $\\beta$ 是当 $\\mu_{D} - \\mu_{P} = \\Delta$ 时未能拒绝 $H_{0}$ 的概率：\n$$\\beta = \\mathbb{P}\\left(|\\bar{X}_{D} - \\bar{X}_{P}| \\leq z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}} \\;\\Bigg|\\; \\mu_{D} - \\mu_{P} = \\Delta\\right)$$\n在这个备择假设下，样本均值之差的分布是 $\\bar{X}_{D} - \\bar{X}_{P} \\sim \\mathcal{N}\\left(\\Delta, \\frac{2\\sigma^{2}}{n}\\right)$。为了评估概率 $\\beta$，我们使用变量 $\\bar{X}_{D} - \\bar{X}_{P}$ 在 $H_{1}$ 下的分布将其标准化：\n$$Z' = \\frac{(\\bar{X}_{D} - \\bar{X}_{P}) - \\Delta}{\\sqrt{\\frac{2\\sigma^{2}}{n}}} \\sim \\mathcal{N}(0, 1)$$\nII类错误的条件变为：\n$$\\beta = \\mathbb{P}\\left(-z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}} \\leq \\bar{X}_{D} - \\bar{X}_{P} \\leq z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}} \\;\\Bigg|\\; \\mu_{D} - \\mu_{P} = \\Delta\\right)$$\n我们将概率表达式内的变量转换为标准正态尺度 $Z'$：\n$$\\beta = \\mathbb{P}\\left(\\frac{-z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}} - \\Delta}{\\sqrt{\\frac{2\\sigma^{2}}{n}}} \\leq Z' \\leq \\frac{z_{1-\\alpha/2}\\sqrt{\\frac{2\\sigma^{2}}{n}} - \\Delta}{\\sqrt{\\frac{2\\sigma^{2}}{n}}}\\right)$$\n$$\\beta = \\mathbb{P}\\left(-z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}} \\leq Z' \\leq z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}\\right)$$\n为使研究有意义，它必须有足够的功效，这意味着 $H_{1}$ 下的分布必须与 $H_{0}$ 下的分布相距足够远。由于 $\\Delta > 0$，$H_{1}$ 下分布的均值位于正尾部。错误地未能拒绝 $H_0$ 的概率，将主要由 $H_1$ 分布中落在上拒绝边界 $z_{1-\\alpha/2}\\sqrt{2\\sigma^{2}/n}$ 以下部分的概率所主导。标准化区间的下界 $-z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}$ 会成为一个绝对值很大的负数，且 $Z'$ 小于此值的概率可以忽略不计。因此我们可以将 $\\beta$ 近似为：\n$$\\beta \\approx \\mathbb{P}\\left(Z' \\leq z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}\\right)$$\n根据标准正态分位数 $z_{p}$ 的定义，如果 $\\mathbb{P}(Z' \\leq x) = \\beta$，那么 $x = z_{\\beta}$。因此，我们将概率函数的参数设为等于 $z_{\\beta}$：\n$$z_{\\beta} = z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}$$\n利用标准正态分布的对称性，我们知道 $z_{\\beta} = -z_{1-\\beta}$。将此代入方程得到：\n$$-z_{1-\\beta} = z_{1-\\alpha/2} - \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}$$\n现在，我们重排方程以求解样本量 $n$。\n$$z_{1-\\alpha/2} + z_{1-\\beta} = \\frac{\\Delta}{\\sqrt{2\\sigma^{2}/n}}$$\n为了分离出 $n$，我们首先求解项 $\\sqrt{n}$：\n$$\\sqrt{\\frac{2\\sigma^{2}}{n}} = \\frac{\\Delta}{z_{1-\\alpha/2} + z_{1-\\beta}}$$\n$$\\frac{\\sqrt{2}\\sigma}{\\sqrt{n}} = \\frac{\\Delta}{z_{1-\\alpha/2} + z_{1-\\beta}}$$\n$$\\sqrt{n} = \\frac{\\sqrt{2}\\sigma(z_{1-\\alpha/2} + z_{1-\\beta})}{\\Delta}$$\n最后，我们将两边平方以获得 $n$ 的表达式：\n$$n = \\left(\\frac{\\sqrt{2}\\sigma(z_{1-\\alpha/2} + z_{1-\\beta})}{\\Delta}\\right)^{2}$$\n$$n = \\frac{2\\sigma^{2}(z_{1-\\alpha/2} + z_{1-\\beta})^{2}}{\\Delta^{2}}$$\n这就是每组所需最小样本量的闭式表达式。",
            "answer": "$$\\boxed{\\frac{2\\sigma^{2}(z_{1-\\alpha/2} + z_{1-\\beta})^{2}}{\\Delta^{2}}}$$"
        },
        {
            "introduction": "随机化是临床试验的基石，但它并不能保证治疗组和安慰剂组在所有基线特征上都完全相同。当基线水平（如初始疼痛程度）与治疗改善程度相关时，偶然出现的基线不平衡会因“均值回归”现象而引入系统性偏倚。本练习将剖析这一偏倚的来源和计算方法，并介绍协方差分析（ANCOVA）作为一种强大的统计工具，如何通过对基线值进行校正，从而更精确地估计真实的治疗效果。",
            "id": "4979616",
            "problem": "考虑一项随机、双盲镇痛试验，该试验在 $0$–$10$ 数字评分量表 (NRS) 上评估一种口服药物与安慰剂对慢性疼痛的疗效。设基线疼痛严重程度由 $X$ 表示，$4$ 周改善程度由 $I$ 表示，其中 $I = X - Y$，$Y$ 是 $4$ 周时的疼痛严重程度。在慢性疼痛中，自然病程、期望驱动的安慰剂镇痛效应和测量误差共同导致向均数回归，这在经验上表现为所有参与者的基线 $X$ 和改善程度 $I$ 之间的线性关联。假设以下经过充分检验的线性关系和统计事实成立：\n\n1. 将 $I$ 对 $X$ 进行回归得到的最小二乘斜率等于 $b = \\frac{\\operatorname{Cov}(X,I)}{\\operatorname{Var}(X)}$。\n2. 在试验中，由于机会性不平衡，基线均值相差 $\\Delta_{X} = \\bar{X}_{T} - \\bar{X}_{C}$。\n\n您将分析在比较治疗组和安慰剂组的平均改善程度时，未经基线调整的平均治疗效应的朴素估计量中的偏差。\n\n假设合并两组数据，经验基线方差为 $\\operatorname{Var}(X) = 6.76$ (平方分)，基线-改善协方差为 $\\operatorname{Cov}(X,I) = 2.11$ (平方分)，观察到的基线不平衡为 $\\Delta_{X} = 1.35$ (分)。从期望、方差、协方差和线性最小二乘斜率的定义出发，推导当 $X$ 和 $I$ 相关时，由向均数回归引起的均值改善差异朴素估计量的预期偏差。然后，提出一种协方差分析 (ANCOVA) 调整方法，该方法将基线 $X$ 作为协变量包含在 $Y$ 的线性模型中，并从基本原理出发，解释为什么在标准线性模型假设下，这种调整能消除由基线不平衡引起的偏差。\n\n计算给定数据所隐含的偏差数值。将您的最终数值答案四舍五入到三位有效数字。用 NRS 评分点表示您的答案。",
            "solution": "问题要求推导治疗效应朴素估计量的偏差，解释协方差分析 (ANCOVA) 如何校正此偏差，并根据所提供的数据计算偏差的数值。\n\n首先，我们验证问题陈述。\n步骤1：提取给定条件。\n- 结果变量是基线疼痛 $X$、$4$周疼痛 $Y$ 和 $4$周改善程度 $I = X - Y$。\n- 结果量表是 $0$–$10$ 数字评分量表 (NRS)。\n- 向均数回归现象被建模为 $X$ 和 $I$ 之间的线性关联。\n- 将 $I$ 对 $X$ 进行回归得到的最小二乘斜率为 $b = \\frac{\\operatorname{Cov}(X,I)}{\\operatorname{Var}(X)}$。\n- 治疗组 (T) 和对照组 (C) 之间的基线不平衡为 $\\Delta_{X} = \\bar{X}_{T} - \\bar{X}_{C}$。\n- 经验合并数据：$\\operatorname{Var}(X) = 6.76$ (平方分)，$\\operatorname{Cov}(X,I) = 2.11$ (平方分)，$\\Delta_{X} = 1.35$ (分)。\n- 任务1：推导朴素估计量 $\\hat{\\tau}_{\\text{naive}} = \\bar{I}_T - \\bar{I}_C$ 的预期偏差。\n- 任务2：提出一种使用 $Y$ 的线性模型（以 $X$ 为协变量）的 ANCOVA 调整方法，并解释为什么它能消除偏差。\n- 任务3：计算偏差的数值。\n\n步骤2：使用提取的给定条件进行验证。\n该问题具有科学依据，提法明确且客观。它描述了生物统计学和临床试验分析中的一个标准情景。向均数回归是一个基本的统计概念，而 ANCOVA 是处理基线不平衡的标准方法。所提供的数据是一致且合理的。该问题没有列出的缺陷。\n\n步骤3：结论和行动。\n问题有效。我们继续进行解答。\n\n第1部分：偏差的推导\n关于改善程度的平均治疗效应的朴素估计量是治疗组 ($T$) 和对照组 ($C$) 之间平均改善程度的简单差值：\n$$\n\\hat{\\tau}_{\\text{naive}} = \\bar{I}_{T} - \\bar{I}_{C}\n$$\n该估计量的偏差是其期望值与真实治疗效应 $\\tau$ 之间的差。我们假设真实效应 $\\tau$ 是由药物引起的改善差异，且与基线疼痛无关。\n\n问题陈述了由于向均数回归和其他因素，基线疼痛 $X$ 与改善程度 $I$ 之间存在线性关联。我们可以在每个组内对这种关系进行建模。设真实治疗效应为 $\\tau$。对于一个受试者，在给定其基线疼痛 $x$ 的条件下，预期改善程度可以写为：\n对于安慰剂组 (C)：$E[I_C | X=x] = \\alpha + b x$\n对于治疗组 (T)：$E[I_T | X=x] = (\\alpha + \\tau) + b x$\n这里，$\\alpha$ 表示安慰剂组中基线疼痛 $X=0$ 的患者的预期改善程度，$b$ 是改善程度与基线之间关系的斜率，假设两组的斜率相同。真实治疗效应 $\\tau$ 是在任何给定的基线疼痛水平下，治疗组额外的改善程度。\n\n为了求出朴素估计量的期望值，我们对每个组内 $X$ 的分布取期望。使用全期望定律，$E[I] = E[E[I|X]]$：\n$$\nE[\\bar{I}_{C}] = E \\left[ \\frac{1}{n_C} \\sum_{i \\in C} I_i \\right] = E[E[I_C | X]] = E[\\alpha + b X_C] = \\alpha + b E[X_C] = \\alpha + b \\mu_{X_C}\n$$\n$$\nE[\\bar{I}_{T}] = E \\left[ \\frac{1}{n_T} \\sum_{i \\in T} I_i \\right] = E[E[I_T | X]] = E[(\\alpha+\\tau) + b X_T] = (\\alpha+\\tau) + b E[X_T] = \\alpha + \\tau + b \\mu_{X_T}\n$$\n其中 $\\mu_{X_C}$ 和 $\\mu_{X_T}$ 是对照组和治疗组样本来源的总体的真实基线均值。\n\n那么，朴素估计量的期望值为：\n$$\nE[\\hat{\\tau}_{\\text{naive}}] = E[\\bar{I}_T] - E[\\bar{I}_C] = (\\alpha + \\tau + b \\mu_{X_T}) - (\\alpha + b \\mu_{X_C}) = \\tau + b (\\mu_{X_T} - \\mu_{X_C})\n$$\n偏差定义为 $E[\\hat{\\tau}_{\\text{naive}}] - \\tau$。\n$$\n\\text{Bias} = [\\tau + b (\\mu_{X_T} - \\mu_{X_C})] - \\tau = b (\\mu_{X_T} - \\mu_{X_C})\n$$\n对于一个观察到基线不平衡 $\\Delta_{X} = \\bar{X}_{T} - \\bar{X}_{C}$ 的特定试验，引入估计的偏差为 $b \\Delta_{X}$。产生这种偏差的原因是，起始平均基线疼痛较高的组 ($\\Delta_X > 0$) 仅因向均数回归就有望表现出更大的改善，而这种效应与真实的治疗效应相混淆。\n使用问题中给出的斜率 $b$ 的定义：\n$$\n\\text{Bias} = \\frac{\\operatorname{Cov}(X,I)}{\\operatorname{Var}(X)} \\Delta_{X}\n$$\n\n第2部分：ANCOVA 调整\n问题指定提出一种 ANCOVA 调整方法，该方法使用一个关于 $4$ 周疼痛评分 $Y$ 的线性模型，并将基线 $X$ 作为协变量。该 ANCOVA 模型为：\n$$\nY_i = \\beta_0 + \\tau_{A} Z_i + \\beta_1 X_i + \\epsilon_i\n$$\n其中 $Z_i$ 是治疗指示变量（治疗组为 $Z_i=1$，安慰剂组为 $Z_i=0$），$\\beta_0$ 是截距，$\\beta_1$ 是 $Y$ 对 $X$ 的斜率，$\\tau_{A}$ 是 ANCOVA 治疗效应估计值。\n\n从基本原理来看，参数 $\\tau_A$ 表示在保持基线 $X$ 不变的情况下，两组之间预期结果 $Y$ 的差异。它是对最终疼痛评分的治疗效应的估计，并已对基线进行了调整。我们想了解这与对*改善程度* $I$ 的效应偏差有何关系。\n\n让我们将 $Y$ 模型的参数与 $I$ 关系式的参数联系起来。我们知道 $I = X - Y$。代入 $Y$ 的 ANCOVA 模型：\n$$\nI_i = X_i - (\\beta_0 + \\tau_{A} Z_i + \\beta_1 X_i + \\epsilon_i) = -\\beta_0 - \\tau_{A} Z_i + (1 - \\beta_1)X_i - \\epsilon_i\n$$\n这揭示了对改善程度的治疗效应是 $\\tau = -\\tau_A$，而改善程度 $I$ 对基线 $X$ 的斜率是 $b = 1 - \\beta_1$。后一个恒等式可以从协方差的定义中得到验证：\n$$\nb = \\frac{\\operatorname{Cov}(X,I)}{\\operatorname{Var}(X)} = \\frac{\\operatorname{Cov}(X, X-Y)}{\\operatorname{Var}(X)} = \\frac{\\operatorname{Cov}(X,X) - \\operatorname{Cov}(X,Y)}{\\operatorname{Var}(X)} = \\frac{\\operatorname{Var}(X)}{\\operatorname{Var}(X)} - \\frac{\\operatorname{Cov}(X,Y)}{\\operatorname{Var}(X)} = 1 - \\beta_1\n$$\n在 ANCOVA 模型中，$\\tau_A$ 的普通最小二乘 (OLS) 估计量由下式给出：\n$$\n\\hat{\\tau}_{A} = (\\bar{Y}_T - \\bar{Y}_C) - \\hat{\\beta}_1 (\\bar{X}_T - \\bar{X}_C)\n$$\n在标准线性模型假设下，该估计量是 $\\tau_A$ 的无偏估计量。因此，对改善程度的治疗效应 $\\tau$ 的一个无偏估计量是 $\\hat{\\tau}_{\\text{ANCOVA}} = -\\hat{\\tau}_{A}$。\n$$\n\\hat{\\tau}_{\\text{ANCOVA}} = - \\left[ (\\bar{Y}_T - \\bar{Y}_C) - \\hat{\\beta}_1 (\\bar{X}_T - \\bar{X}_C) \\right] = (\\bar{Y}_C - \\bar{Y}_T) + \\hat{\\beta}_1 (\\bar{X}_T - \\bar{X}_C)\n$$\n我们可以用改善程度和基线来表示 $\\bar{Y}_C - \\bar{Y}_T$：$\\bar{Y}_C - \\bar{Y}_T = (\\bar{X}_C - \\bar{I}_C) - (\\bar{X}_T - \\bar{I}_T) = (\\bar{I}_T - \\bar{I}_C) - (\\bar{X}_T - \\bar{X}_C)$。\n将此代入 $\\hat{\\tau}_{\\text{ANCOVA}}$ 的表达式中：\n$$\n\\hat{\\tau}_{\\text{ANCOVA}} = \\left[ (\\bar{I}_T - \\bar{I}_C) - (\\bar{X}_T - \\bar{X}_C) \\right] + \\hat{\\beta}_1 (\\bar{X}_T - \\bar{X}_C)\n$$\n$$\n\\hat{\\tau}_{\\text{ANCOVA}} = (\\bar{I}_T - \\bar{I}_C) - (1 - \\hat{\\beta}_1)(\\bar{X}_T - \\bar{X}_C)\n$$\n因为我们已经证明 $b = 1 - \\beta_1$，并且 $\\hat{b}$ 是 $b$ 的估计量：\n$$\n\\hat{\\tau}_{\\text{ANCOVA}} = (\\bar{I}_T - \\bar{I}_C) - \\hat{b}(\\bar{X}_T - \\bar{X}_C) = \\hat{\\tau}_{\\text{naive}} - \\text{估计偏差}\n$$\n这个推导明确地表明，ANCOVA 程序通过将基线测量值 $X$ 作为协变量，计算出一个调整后的治疗效应，这等同于取朴素的均值差异估计量，然后减去由基线不平衡引起的估计偏差。因此，ANCOVA 消除了由基线不平衡引起的偏差。\n\n第3部分：数值计算\n我们被要求计算数据所隐含的偏差的数值。\n根据第1部分，偏差由下式给出：\n$$\n\\text{Bias} = b \\Delta_{X} = \\frac{\\operatorname{Cov}(X,I)}{\\operatorname{Var}(X)} \\Delta_{X}\n$$\n给定的数值是：\n$\\operatorname{Var}(X) = 6.76$\n$\\operatorname{Cov}(X,I) = 2.11$\n$\\Delta_{X} = 1.35$\n\n将这些值代入偏差公式中：\n$$\n\\text{Bias} = \\left(\\frac{2.11}{6.76}\\right) \\times 1.35\n$$\n$$\n\\text{Bias} \\approx (0.3121301775...) \\times 1.35 \\approx 0.4213757...\n$$\n将结果四舍五入到三位有效数字，我们得到 $0.421$。单位是 NRS 评分点。\n正偏差表明朴素估计量高估了真实的治疗效应，因为治疗组开始时的平均疼痛评分更高，因此仅因向均数回归就有望获得更大的改善。",
            "answer": "$$\n\\boxed{0.421}\n$$"
        },
        {
            "introduction": "药理学中的一个核心问题是：安慰剂效应是简单地与药物效应相加，还是以更复杂的方式相互作用？例如，积极的期望是否能“放大”药物的镇痛效果？本练习将向你展示如何通过$2 \\times 2$析因设计来解答这类问题，通过分析药物效应和期望效应之间的交互作用项（interaction term），我们可以从统计上判断这两种效应是独立的、协同的（supra-additive）还是拮抗的（infra-additive）。",
            "id": "4979655",
            "problem": "进行了一项随机对照试验（RCT），旨在剖析药物和期望（安慰剂/反安慰剂）对镇痛结果的贡献。随机化确保在每个试验臂内，唯一的系统性差异是被分配的干预措施，这意味着样本臂均值是相应总体均值的无偏估计量。考虑一个双因素析因设计，其中包含二元指示变量 $Drug \\in \\{0,1\\}$ 和 $Expectation \\in \\{0,1\\}$。结局 $Y$ 是24小时内疼痛强度在0到10数字评分量表上的变化，较大的 $Y$ 值表示更强的镇痛效果。参与者接受活性药物或其匹配的安慰剂（$Drug = 1$ 对比 $Drug = 0$），并被独立随机分配至接受旨在诱导安慰剂效应的积极期望信息脚本（$Expectation = 1$）或中性脚本（$Expectation = 0$）。本实验不诱导负面期望（反安慰剂效应）。\n\n根据基本原理，如果 $Drug$ 和 $Expectation$ 的效应在 $Y$ 量表上是加性结合的，那么在 $Drug=1,Expectation=1$ 单元中的预期组合效应等于基线 $Drug=0,Expectation=0$ 单元加上 $Drug$ 的主效应（在 $Expectation=0$ 时）加上 $Expectation$ 的主效应（在 $Drug=0$ 时）。对这种加性效应的偏离代表了交互作用。在一个带有交互作用项的线性模型中，这种偏离由乘积项 $Drug \\times Expectation$ 的系数所捕捉。\n\n假设存在同方差性（组内方差相等）和由随机化引起的组间独立性。令 $\\mu_{ij}$ 表示在单元 $(Drug=i,Expectation=j)$ 中 $Y$ 的总体均值，令 $\\hat{\\mu}_{ij}$ 为对应的样本均值。该试验得出以下单元摘要：\n- $Drug=0,Expectation=0$：$n = 40$，样本均值 $\\hat{\\mu}_{00} = 1.0$，样本标准差 $s_{00} = 2.5$。\n- $Drug=0,Expectation=1$：$n = 40$，样本均值 $\\hat{\\mu}_{01} = 2.0$，样本标准差 $s_{01} = 2.5$。\n- $Drug=1,Expectation=0$：$n = 40$，样本均值 $\\hat{\\mu}_{10} = 3.0$，样本标准差 $s_{10} = 2.5$。\n- $Drug=1,Expectation=1$：$n = 40$，样本均值 $\\hat{\\mu}_{11} = 5.8$，样本标准差 $s_{11} = 2.5$。\n\n考虑带有交互作用的线性回归模型，\n$$\nY = \\beta_0 + \\beta_1\\,Drug + \\beta_2\\,Expectation + \\beta_3\\,(Drug \\times Expectation) + \\varepsilon,\n$$\n其中 $\\varepsilon$ 是独立的、均值为0且方差恒定的误差。使用析因设计和上述摘要，根据基本原理估计 $\\beta_3$ 及其标准误（将 $\\hat{\\mu}_{ij}$ 视为具有由合并标准差决定的共同方差的独立样本均值），构建用于在显著性水平 $\\alpha=0.05$ 下检验 $H_0:\\beta_3=0$ 与 $H_1:\\beta_3\\neq 0$ 的 $t$ 统计量，并选择正确的结论。\n\n哪项结论与该分析最一致？\n\nA. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上是加性结合的；未能拒绝 $H_0:\\beta_3=0$。\n\nB. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上表现出超加性协同作用；拒绝 $H_0:\\beta_3=0$ 且 $\\hat{\\beta}_3>0$。\n\nC. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上表现出次加性拮抗作用；拒绝 $H_0:\\beta_3=0$ 且 $\\hat{\\beta}_3<0$。\n\nD. 该检验无效，因为 $Drug$ 和 $Expectation$ 是共线的；在这种设计中无法估计 $\\beta_3$。",
            "solution": "问题陈述已经过严格验证，并被认定为有效。它具有科学依据，问题提出得当，且客观。它呈现了一个基于 $2 \\times 2$ 析因随机对照试验的标准统计分析任务，为获得唯一解提供了所有必要的数据和假设。\n\n分析过程如下：首先从给定的线性模型中估计交互作用系数 $\\beta_3$，然后检验原假设 $H_0: \\beta_3 = 0$。\n\n线性模型由下式给出：\n$$\nY = \\beta_0 + \\beta_1\\,Drug + \\beta_2\\,Expectation + \\beta_3\\,(Drug \\times Expectation) + \\varepsilon\n$$\n其中 $Drug \\in \\{0,1\\}$ 且 $Expectation \\in \\{0,1\\}$。对于四个实验单元中的每一个，其预期结局 $\\mu_{ij} = E[Y|Drug=i, Expectation=j]$ 可以用模型系数表示如下：\n- $\\mu_{00} = E[Y|Drug=0, Expectation=0] = \\beta_0$\n- $\\mu_{01} = E[Y|Drug=0, Expectation=1] = \\beta_0 + \\beta_2$\n- $\\mu_{10} = E[Y|Drug=1, Expectation=0] = \\beta_0 + \\beta_1$\n- $\\mu_{11} = E[Y|Drug=1, Expectation=1] = \\beta_0 + \\beta_1 + \\beta_2 + \\beta_3$\n\n从这些方程中，我们可以用单元均值来表示交互作用系数 $\\beta_3$。\n将 $\\beta_0$、$\\beta_1$（即 $\\mu_{10} - \\beta_0 = \\mu_{10} - \\mu_{00}$）和 $\\beta_2$（即 $\\mu_{01} - \\beta_0 = \\mu_{01} - \\mu_{00}$）的表达式代入 $\\mu_{11}$ 的方程中：\n$$\n\\mu_{11} = \\mu_{00} + (\\mu_{10} - \\mu_{00}) + (\\mu_{01} - \\mu_{00}) + \\beta_3\n$$\n$$\n\\mu_{11} = \\mu_{10} + \\mu_{01} - \\mu_{00} + \\beta_3\n$$\n解出 $\\beta_3$ 得到交互作用效应：\n$$\n\\beta_3 = \\mu_{11} - \\mu_{10} - \\mu_{01} + \\mu_{00}\n$$\n值 $\\mu_{10} + \\mu_{01} - \\mu_{00}$ 表示在纯加性模型下 $(1,1)$ 单元的预测均值。交互作用项 $\\beta_3$ 量化了与这种加性模型的偏差。\n\n$\\beta_3$ 的最佳线性无偏估计量，记作 $\\hat{\\beta}_3$，是通过将样本均值 $\\hat{\\mu}_{ij}$ 替换总体均值 $\\mu_{ij}$ 得到的：\n$$\n\\hat{\\beta}_3 = \\hat{\\mu}_{11} - \\hat{\\mu}_{10} - \\hat{\\mu}_{01} + \\hat{\\mu}_{00}\n$$\n使用提供的数据：$\\hat{\\mu}_{00} = 1.0$，$\\hat{\\mu}_{01} = 2.0$，$\\hat{\\mu}_{10} = 3.0$，$\\hat{\\mu}_{11} = 5.8$。\n$$\n\\hat{\\beta}_3 = 5.8 - 3.0 - 2.0 + 1.0 = 1.8\n$$\n估计的交互作用效应为 $\\hat{\\beta}_3 = 1.8$。由于该值为正，表明存在超加性或协同效应：观测到的均值 $\\hat{\\mu}_{11}=5.8$ 大于加性模型预测的值 $4.0$（$\\hat{\\mu}_{10} + \\hat{\\mu}_{01} - \\hat{\\mu}_{00} = 3.0 + 2.0 - 1.0 = 4.0$）。\n\n为了检验这一发现的统计显著性，我们为原假设 $H_0: \\beta_3 = 0$ 构建一个 $t$ 统计量。$t$ 统计量由下式给出：\n$$\nt = \\frac{\\hat{\\beta}_3 - 0}{SE(\\hat{\\beta}_3)}\n$$\n我们必须首先计算 $\\hat{\\beta}_3$ 的标准误 $SE(\\hat{\\beta}_3)$。由于四个实验组是独立的，样本均值线性组合的方差是它们各自方差的总和：\n$$\nVar(\\hat{\\beta}_3) = Var(\\hat{\\mu}_{11} - \\hat{\\mu}_{10} - \\hat{\\mu}_{01} + \\hat{\\mu}_{00}) = Var(\\hat{\\mu}_{11}) + Var(\\hat{\\mu}_{10}) + Var(\\hat{\\mu}_{01}) + Var(\\hat{\\mu}_{00})\n$$\n样本均值的方差是 $Var(\\hat{\\mu}_{ij}) = \\frac{\\sigma_{ij}^2}{n_{ij}}$。问题陈述要求假设同方差性（所有单元的 $\\sigma_{ij}^2 = \\sigma^2$）并提供了相等的样本量（$n_{ij} = n = 40$）。因此：\n$$\nVar(\\hat{\\beta}_3) = \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} + \\frac{\\sigma^2}{n} = \\frac{4\\sigma^2}{n}\n$$\n我们使用合并样本方差 $s_p^2$ 来估计共同的总体方差 $\\sigma^2$。鉴于所有单元的样本标准差都相等（$s_{ij} = s = 2.5$）且所有样本量都相等，合并方差就是 $s_p^2 = s^2$。\n$$\ns_p^2 = (2.5)^2 = 6.25\n$$\n$\\hat{\\beta}_3$ 的估计方差为：\n$$\n\\widehat{Var}(\\hat{\\beta}_3) = \\frac{4 s_p^2}{n} = \\frac{4 \\times 6.25}{40} = \\frac{25}{40} = 0.625\n$$\n标准误是估计方差的平方根：\n$$\nSE(\\hat{\\beta}_3) = \\sqrt{0.625} \\approx 0.79057\n$$\n现在我们可以计算 $t$ 统计量：\n$$\nt = \\frac{1.8}{\\sqrt{0.625}} \\approx \\frac{1.8}{0.79057} \\approx 2.2768\n$$\n此 $t$ 检验的自由度基于总样本量减去组数（$k=4$）：\n$$\ndf = N_{total} - k = (4 \\times 40) - 4 = 160 - 4 = 156\n$$\n对于显著性水平 $\\alpha = 0.05$ 和自由度 $df = 156$ 的双尾检验，临界 $t$ 值为 $t_{crit} = t_{0.025, 156}$。使用标准 $t$ 分布，该值约为 $1.975$。\n由于我们计算出的检验统计量 $|t| \\approx 2.28$ 大于临界值 $t_{crit} \\approx 1.975$，我们拒绝原假设 $H_0: \\beta_3 = 0$。\n\n结果具有统计显著性。交互作用项的估计值 $\\hat{\\beta}_3 = 1.8$ 是正的，表明药物和积极期望的联合效应大于它们各自效应的总和。这被称为超加性协同作用。\n\n现在，我们评估每个选项：\n\nA. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上是加性结合的；未能拒绝 $H_0:\\beta_3=0$。\n这是 **不正确的**。统计检验导致拒绝了代表加性效应的原假设 $H_0: \\beta_3=0$。\n\nB. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上表现出超加性协同作用；拒绝 $H_0:\\beta_3=0$ 且 $\\hat{\\beta}_3>0$。\n这是 **正确的**。我们拒绝了无交互作用的原假设。估计的交互作用系数 $\\hat{\\beta}_3 = 1.8$ 为正，这对应于超加性协同效应。\n\nC. 安慰剂（期望）和药物效应在观测的 $Y$ 量表上表现出次加性拮抗作用；拒绝 $H_0:\\beta_3=0$ 且 $\\hat{\\beta}_3<0$。\n这是 **不正确的**。虽然我们拒绝了原假设，但我们对交互作用效应的估计是正的（$\\hat{\\beta}_3 > 0$），而不是负的。负的交互作用将意味着拮抗作用。\n\nD. 该检验无效，因为 $Drug$ 和 $Expectation$ 是共线的；在这种设计中无法估计 $\\beta_3$。\n这是 **不正确的**。析因设计与独立随机化的一个关键特征是各因素之间不共线。在像本例这样的平衡析因设计中，预测变量在均值中心化后是正交的，这是估计所有效应（包括交互作用）的理想条件。如前面的计算所示，交互作用系数 $\\beta_3$ 显然是可以估计的。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}