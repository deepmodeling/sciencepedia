{
    "hands_on_practices": [
        {
            "introduction": "The journey of a new drug begins with understanding its fundamental interaction with its target. This practice simulates a crucial step in early drug discovery by analyzing data from an *in vitro* enzyme assay . By processing these simulated experimental progress curves, you will learn to extract initial reaction velocities, apply the principles of competitive inhibition to determine the inhibitory constant ($K_i$), and calculate selectivity indices, which quantify how preferentially a drug binds to its intended target over other related enzymes.",
            "id": "4996124",
            "problem": "You are asked to design a computational workflow that emulates an in vitro kinetic assay panel to quantify selectivity across alpha-glucosidase isoforms and compute the inhibitory constant $K_i$ from provided progress curves. Use fundamental enzyme kinetics principles grounded in pharmacology, starting from the Michaelis-Menten framework and the definition of competitive inhibition. The inhibitor is a small molecule that competes with the substrate at the active site of the enzyme alpha-glucosidase; assume no other mechanisms such as mixed or noncompetitive inhibition are present. For each isoform, the substrate concentration $S$ is held fixed for all runs, and the canonical kinetic parameters $K_m$ and $V_{max}$ are known from prior characterization. A series of product formation progress curves $P(t)$ for different inhibitor concentrations $I$ is provided. Your task is to extract the initial velocities $v$ from the progress curves and, using principled derivations from the stated base, express $K_i$ in terms of quantities you can estimate. You must formulate and implement an algorithm that transforms the progress curves into $K_i$ estimates and then computes selectivity indices between isoforms.\n\nScientific base you must use:\n- Michaelis-Menten kinetics, which defines the catalytic transformation of substrate to product by an enzyme and the meaning of parameters $K_m$ and $V_{max}$.\n- Competitive inhibition, where the inhibitor binds the free enzyme, changing the apparent substrate affinity but not the maximal velocity, under a fixed substrate concentration $S$.\n- The initial velocity $v$ can be obtained from the slope of the early-time progress curve $P(t)$.\n\nYou must not use any unstated shortcut formulas. Derive your computational method from the above base in your solution. The method must be universally applicable to any modern programming language and must be implemented as a complete, runnable program in Python as specified. All concentrations must be treated and reported in micromolar (μM). Time must be treated in seconds (s). Initial velocities must be in μM/s. The final $K_i$ values must be expressed in μM, rounded to two decimal places. Selectivity indices must be computed as dimensionless ratios of $K_i$ values, rounded to two decimal places, and expressed as decimal numbers (not percentages).\n\nTest suite and data:\nFor three alpha-glucosidase isoforms, the fixed substrate concentration $S$, and the known parameters $K_m$ and $V_{max}$ are:\n- Isoform G1: $S = 200$ μM, $K_m = 300$ μM, $V_{max} = 1.8$ μM/s.\n- Isoform G2: $S = 200$ μM, $K_m = 150$ μM, $V_{max} = 1.2$ μM/s.\n- Isoform G3: $S = 200$ μM, $K_m = 500$ μM, $V_{max} = 2.0$ μM/s.\n\nFor each isoform, the inhibitor concentrations $I$ (in μM), the time points $t$ (in s), and the measured product concentrations $P(t)$ (in μM) are provided as follows. Each list of $P(t)$ corresponds to the same ordered list of time points $t = [\\,0,\\,20,\\,40,\\,60\\,]$ s.\n\nIsoform G1:\n- Inhibitor concentrations $I = [\\,0,\\,20,\\,40,\\,80,\\,160\\,]$ μM.\n- Progress curves $P(t)$ at each $I$:\n  - $I = 0$: $[\\,0,\\,14.4,\\,28.8,\\,43.2\\,]$.\n  - $I = 20$: $[\\,0,\\,12.52173913,\\,25.04347826,\\,37.56521739\\,]$.\n  - $I = 40$: $[\\,0,\\,11.07692308,\\,22.15384615,\\,33.23076923\\,]$.\n  - $I = 80$: $[\\,0,\\,9.0,\\,18.0,\\,27.0\\,]$.\n  - $I = 160$: $[\\,0,\\,6.545454545,\\,13.09090909,\\,19.63636364\\,]$.\n\nIsoform G2:\n- Inhibitor concentrations $I = [\\,0,\\,10,\\,20,\\,40,\\,80\\,]$ μM.\n- Progress curves $P(t)$ at each $I$:\n  - $I = 0$: $[\\,0,\\,13.714285714285714,\\,27.428571428571427,\\,41.14285714285714\\,]$.\n  - $I = 10$: $[\\,0,\\,11.294117647058824,\\,22.588235294117647,\\,33.88235294117647\\,]$.\n  - $I = 20$: $[\\,0,\\,9.6,\\,19.2,\\,28.8\\,]$.\n  - $I = 40$: $[\\,0,\\,7.384615384615385,\\,14.76923076923077,\\,22.153846153846153\\,]$.\n  - $I = 80$: $[\\,0,\\,5.052631578947368,\\,10.105263157894736,\\,15.157894736842104\\,]$.\n\nIsoform G3:\n- Inhibitor concentrations $I = [\\,0,\\,50,\\,200,\\,1000\\,]$ μM.\n- Progress curves $P(t)$ at each $I$:\n  - $I = 0$: $[\\,0,\\,11.428571428571429,\\,22.857142857142858,\\,34.285714285714285\\,]$.\n  - $I = 50$: $[\\,0,\\,11.03448275862069,\\,22.06896551724138,\\,33.10344827586207\\,]$.\n  - $I = 200$: $[\\,0,\\,10.0,\\,20.0,\\,30.0\\,]$.\n  - $I = 1000$: $[\\,0,\\,6.666666666666667,\\,13.333333333333334,\\,20.0\\,]$.\n\nTasks:\n1. For each isoform and inhibitor concentration $I$, estimate the initial velocity $v$ (in μM/s) from the corresponding progress curve $P(t)$ by fitting a straight line to $P$ versus $t$ over the provided time points and taking the slope. State and apply the rationale for using the initial slope as $v$.\n2. Using only the fundamental base above, derive an expression that connects $v$ and $I$ for competitive inhibition under fixed $S$, and identify a linearizable relationship that allows estimation of $K_i$ via least-squares fitting. Implement that estimation.\n3. Compute the $K_i$ (in μM) for each isoform G1, G2, and G3. Round each to two decimal places.\n4. Define the selectivity index $SI_{X/Y}$ between isoforms $X$ and $Y$ as the ratio $K_{i,X} / K_{i,Y}$ (dimensionless). Treat G1 as the reference (target) isoform and compute $SI_{\\text{G2}/\\text{G1}}$ and $SI_{\\text{G3}/\\text{G1}}$. Round each to two decimal places and express as decimal numbers without a percentage sign.\n5. Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[\\,K_{i,\\text{G1}},\\,K_{i,\\text{G2}},\\,K_{i,\\text{G3}},\\,SI_{\\text{G2}/\\text{G1}},\\,SI_{\\text{G3}/\\text{G1}}\\,]$, all rounded to two decimal places and with $K_i$ reported in μM.\n\nDesign for coverage:\n- The isoform G1 represents a typical case with moderate $K_i$ and multiple inhibitor points (general case).\n- The isoform G2 represents a higher-affinity inhibition case with smaller $K_i$ values (sensitivity to slope).\n- The isoform G3 represents a weak inhibition case with a large $K_i$ and includes a boundary condition with a very high inhibitor concentration $I = 1000$ μM to test numerical robustness at low velocities.\n\nYour solution must specify how the algorithm derives $K_i$ from first principles and implement it to produce the exact required output.",
            "solution": "The computational design begins with the foundational description of enzyme catalysis and competitive inhibition. In Michaelis-Menten kinetics, the enzymatic transformation of substrate to product proceeds through the elementary steps $E + S \\rightleftharpoons ES \\rightarrow E + P$, and under steady-state assumptions the reaction velocity depends on the substrate concentration and the kinetic parameters. The key parameters are the Michaelis constant $K_m$ and the maximal velocity $V_{max}$. Competitive inhibition involves the inhibitor binding to the free enzyme to form $EI$, which reduces access of the substrate to the enzyme’s active site without changing the catalytic turnover at saturation, thereby affecting the apparent affinity for substrate. Under competitive inhibition at a fixed substrate concentration $S$, the initial velocity $v$ depends on both $S$ and the inhibitor concentration $I$ through the altered effective affinity.\n\nThe progress curve $P(t)$ represents the amount of product formed as a function of time $t$. In the early-time regime where $S$ does not appreciably deplete (a valid approximation in in vitro initial-rate assays and especially in the dataset provided where $P(t)$ increases linearly), the initial velocity $v$ is the slope of $P(t)$ with respect to $t$. Formally, in the short-time limit, $v = \\frac{dP}{dt}$. Operationally, we estimate $v$ by fitting a straight line to the measured $P(t)$ points and using the slope. Because each provided $P(t)$ is linear across the sampled times, ordinary least squares on the pairs $(t, P(t))$ yields an unbiased estimate of $v$ for each inhibitor concentration $I$.\n\nTo connect $v$ and $I$ for competitive inhibition under fixed $S$, begin with the principle that competitive inhibition modifies the effective substrate binding term while leaving $V_{max}$ unchanged. From the established Michaelis-Menten framework and the definition of competitive inhibition, one can derive that the dependence of $v$ on $I$ at fixed $S$ can be expressed in a form where the reciprocal of velocity $\\frac{1}{v}$ is an affine (linear) function of $I$. Specifically, introducing the constants $A = V_{max} \\cdot S$ and $B = K_m$, the relationship can be rearranged into\n$$\n\\frac{1}{v} = \\alpha + \\beta \\, I,\n$$\nwhere $\\alpha$ and $\\beta$ are constants that depend on $A$, $B$, and the inhibitory constant $K_i$. The constant $\\beta$ is directly proportional to $\\frac{B}{A}$ and inversely proportional to $K_i$. In particular, one can show that\n$$\n\\beta = \\frac{B}{A \\, K_i},\n$$\nwhich leads to the expression\n$$\nK_i = \\frac{B}{\\beta A} = \\frac{K_m}{\\beta \\, V_{max} \\, S}.\n$$\nThis linearization enables estimation of $K_i$ by a straightforward least-squares fit of $\\frac{1}{v}$ against $I$ to obtain $\\beta$, provided $K_m$, $V_{max}$, and $S$ are known and $v$ is estimated from the progress curves.\n\nAlgorithmic procedure:\n1. For each isoform and each inhibitor concentration $I$, compute the initial velocity $v$ by performing a least-squares linear regression of $P$ versus $t$ over the provided time points and taking the slope. Units: $v$ in μM/s since $P$ is in μM and $t$ in s.\n2. For each isoform, construct the data pairs $(I, \\frac{1}{v})$ using the $v$ values from step $1$. Perform a least-squares linear regression to fit $\\frac{1}{v} = \\alpha + \\beta I$, and extract the slope $\\beta$.\n3. Calculate $K_i$ for each isoform via $K_i = \\frac{K_m}{\\beta \\, V_{max} \\, S}$, with $K_i$ reported in μM. Round to two decimal places.\n4. Compute selectivity indices relative to G1: $SI_{\\text{G2}/\\text{G1}} = \\frac{K_{i,\\text{G2}}}{K_{i,\\text{G1}}}$ and $SI_{\\text{G3}/\\text{G1}} = \\frac{K_{i,\\text{G3}}}{K_{i,\\text{G1}}}$, rounded to two decimal places.\n5. Output the list $[\\,K_{i,\\text{G1}},\\,K_{i,\\text{G2}},\\,K_{i,\\text{G3}},\\,SI_{\\text{G2}/\\text{G1}},\\,SI_{\\text{G3}/\\text{G1}}\\,]$ as a single line, with $K_i$ values in μM and selectivity indices as decimals.\n\nApplying the procedure to the provided data:\n- Isoform G1: $S = 200$ μM, $K_m = 300$ μM, $V_{max} = 1.8$ μM/s. The linear fits to $P(t)$ yield initial velocities approximately $[\\,0.72,\\,0.6260869565,\\,0.5538461538,\\,0.45,\\,0.3272727273\\,]$ μM/s at $I = [\\,0,\\,20,\\,40,\\,80,\\,160\\,]$ μM. Fitting $\\frac{1}{v}$ versus $I$ gives a slope $\\beta$ near $0.0104166667$ $\\text{s/μM}^2$, yielding $K_i \\approx \\frac{300}{0.0104166667 \\cdot 1.8 \\cdot 200} \\approx 80$ μM.\n- Isoform G2: $S = 200$ μM, $K_m = 150$ μM, $V_{max} = 1.2$ μM/s. Initial velocities approximately $[\\,0.6857142857,\\,0.5647058824,\\,0.48,\\,0.3692307692,\\,0.2526315789\\,]$ μM/s at $I = [\\,0,\\,10,\\,20,\\,40,\\,80\\,]$ μM. The fit gives $\\beta$ near $0.03125$ $\\text{s/μM}^2$, so $K_i \\approx \\frac{150}{0.03125 \\cdot 1.2 \\cdot 200} \\approx 20$ μM.\n- Isoform G3: $S = 200$ μM, $K_m = 500$ μM, $V_{max} = 2.0$ μM/s. Initial velocities approximately $[\\,0.5714285714,\\,0.5517241379,\\,0.5,\\,0.3333333333\\,]$ μM/s at $I = [\\,0,\\,50,\\,200,\\,1000\\,]$ μM. The fit gives $\\beta$ near $0.00125$ $\\text{s/μM}^2$, yielding $K_i \\approx \\frac{500}{0.00125 \\cdot 2.0 \\cdot 200} \\approx 1000$ μM.\n\nSelectivity indices relative to G1:\n- $SI_{\\text{G2}/\\text{G1}} = \\frac{20}{80} = 0.25$.\n- $SI_{\\text{G3}/\\text{G1}} = \\frac{1000}{80} = 12.5$.\n\nRounded to two decimal places, the expected output is the single line with list $[\\,80.00,\\,20.00,\\,1000.00,\\,0.25,\\,12.50\\,]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef estimate_initial_velocity(time_points, product_points):\n    \"\"\"\n    Estimate the initial velocity v (μM/s) by linear regression of P vs t.\n    Returns the slope of the best-fit line.\n    \"\"\"\n    # Fit P = m * t + b; m is the velocity.\n    m, b = np.polyfit(time_points, product_points, 1)\n    return m\n\ndef estimate_ki(S, Km, Vmax, inhibitor_concs, velocities):\n    \"\"\"\n    Estimate Ki using linearization: 1/v = alpha + beta * I,\n    where Ki = Km / (beta * Vmax * S).\n    \"\"\"\n    inv_v = 1.0 / np.array(velocities, dtype=float)\n    I = np.array(inhibitor_concs, dtype=float)\n    # Fit inv_v = alpha + beta * I\n    beta, alpha = np.polyfit(I, inv_v, 1)\n    Ki = Km / (beta * Vmax * S)\n    return Ki\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each isoform includes S (μM), Km (μM), Vmax (μM/s),\n    # inhibitor concentrations (μM), time points (s), and progress curves P(t) (μM).\n    test_cases = [\n        {\n            \"name\": \"G1\",\n            \"S\": 200.0,\n            \"Km\": 300.0,\n            \"Vmax\": 1.8,\n            \"I_values\": [0.0, 20.0, 40.0, 80.0, 160.0],\n            \"time_points\": [0.0, 20.0, 40.0, 60.0],\n            \"P_values\": [\n                [0.0, 14.4, 28.8, 43.2],                      # I=0\n                [0.0, 12.52173913, 25.04347826, 37.56521739], # I=20\n                [0.0, 11.07692308, 22.15384615, 33.23076923], # I=40\n                [0.0, 9.0, 18.0, 27.0],                        # I=80\n                [0.0, 6.545454545, 13.09090909, 19.63636364], # I=160\n            ],\n        },\n        {\n            \"name\": \"G2\",\n            \"S\": 200.0,\n            \"Km\": 150.0,\n            \"Vmax\": 1.2,\n            \"I_values\": [0.0, 10.0, 20.0, 40.0, 80.0],\n            \"time_points\": [0.0, 20.0, 40.0, 60.0],\n            \"P_values\": [\n                [0.0, 13.714285714285714, 27.428571428571427, 41.14285714285714], # I=0\n                [0.0, 11.294117647058824, 22.588235294117647, 33.88235294117647], # I=10\n                [0.0, 9.6, 19.2, 28.8],                                            # I=20\n                [0.0, 7.384615384615385, 14.76923076923077, 22.153846153846153],  # I=40\n                [0.0, 5.052631578947368, 10.105263157894736, 15.157894736842104], # I=80\n            ],\n        },\n        {\n            \"name\": \"G3\",\n            \"S\": 200.0,\n            \"Km\": 500.0,\n            \"Vmax\": 2.0,\n            \"I_values\": [0.0, 50.0, 200.0, 1000.0],\n            \"time_points\": [0.0, 20.0, 40.0, 60.0],\n            \"P_values\": [\n                [0.0, 11.428571428571429, 22.857142857142858, 34.285714285714285], # I=0\n                [0.0, 11.03448275862069, 22.06896551724138, 33.10344827586207],    # I=50\n                [0.0, 10.0, 20.0, 30.0],                                            # I=200\n                [0.0, 6.666666666666667, 13.333333333333334, 20.0],                 # I=1000\n            ],\n        },\n    ]\n\n    # Compute Ki for each isoform.\n    ki_values = []\n    for case in test_cases:\n        S = case[\"S\"]\n        Km = case[\"Km\"]\n        Vmax = case[\"Vmax\"]\n        I_values = case[\"I_values\"]\n        time_points = np.array(case[\"time_points\"], dtype=float)\n\n        velocities = []\n        for P_curve in case[\"P_values\"]:\n            P = np.array(P_curve, dtype=float)\n            v = estimate_initial_velocity(time_points, P)\n            velocities.append(v)\n\n        Ki = estimate_ki(S, Km, Vmax, I_values, velocities)\n        ki_values.append(Ki)\n\n    # Compute selectivity indices relative to G1 (first isoform).\n    si_g2_over_g1 = ki_values[1] / ki_values[0]\n    si_g3_over_g1 = ki_values[2] / ki_values[0]\n\n    # Prepare results rounded to two decimals.\n    results = [\n        f\"{ki_values[0]:.2f}\",\n        f\"{ki_values[1]:.2f}\",\n        f\"{ki_values[2]:.2f}\",\n        f\"{si_g2_over_g1:.2f}\",\n        f\"{si_g3_over_g1:.2f}\",\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After characterizing a drug's effect on an isolated enzyme, the next step is to predict its effect within a living system. This exercise  uses a simple but powerful pharmacokinetic/pharmacodynamic (PK/PD) model to simulate how an $\\alpha$-glucosidase inhibitor alters the plasma glucose curve during an Oral Glucose Tolerance Test (OGTT). You will see firsthand how slowing the rate of carbohydrate absorption ($k_a$) translates into blunting the post-meal glucose spike, demonstrating the clinical relevance of concepts like peak concentration reduction and time-to-peak delay.",
            "id": "4996121",
            "problem": "An Oral Glucose Tolerance Test (OGTT) delivers a glucose load into the gastrointestinal tract, where carbohydrate digestion and absorption can be idealized by first-order kinetics. Alpha-glucosidase inhibitors reduce the effective rate of carbohydrate hydrolysis at the intestinal brush border and thus slow glucose appearance into the plasma. Consider a minimal, mass-balance, one-compartment plasma model coupled to a gut compartment that tracks the remaining undigested carbohydrate.\n\nUse the following fundamental base:\n- Conservation of mass and first-order kinetics for disappearance and appearance processes.\n- A gut compartment with carbohydrate mass $M_g(t)$, with initial condition $M_g(0)=D$ and a first-order digestion/absorption rate constant $k_a^{\\mathrm{eff}}$.\n- A plasma glucose concentration $C(t)$ in a single well-mixed compartment with effective volume of distribution $V_d$, a baseline concentration $C_0$, and a first-order clearance rate constant $k_c$ that acts on the excursion above baseline.\n- A fraction $F$ (bioavailability to plasma) of the carbohydrate that appears as plasma glucose.\n- Unit conversion $1000$ milligrams per gram.\n\nModel structure and inputs:\n- Gut dynamics: $\\dfrac{dM_g}{dt} = -k_a^{\\mathrm{eff}}\\,M_g(t)$, with $M_g(0)=D$.\n- Plasma glucose dynamics: $\\dfrac{dC}{dt} = \\left(\\dfrac{F\\cdot 1000}{V_d}\\right)\\,k_a^{\\mathrm{eff}}\\,M_g(t) - k_c\\,(C(t)-C_0)$, with $C(0)=C_0$.\n- Inhibitor effect: $k_a^{\\mathrm{eff}} = s\\,k_a$, where $s\\in(0,1]$ is the fractional activity under inhibition ($s=1$ represents no inhibitor, $s<1$ represents inhibition).\n\nTask:\n- Using the model above, for each provided parameter set, compute two outputs:\n  1. The peak reduction in plasma glucose concentration due to the inhibitor, defined as $\\Delta C_{\\mathrm{peak}}^{\\mathrm{no\\,inh}} - \\Delta C_{\\mathrm{peak}}^{\\mathrm{inh}}$, expressed in mg/dL, where $\\Delta C_{\\mathrm{peak}} = \\max_{t\\ge 0}\\{C(t)-C_0\\}$ under the specified condition (no inhibitor uses $s=1$, inhibitor uses the given $s<1$).\n  2. The time-to-peak delay, defined as $t_{\\mathrm{peak}}^{\\mathrm{inh}}-t_{\\mathrm{peak}}^{\\mathrm{no\\,inh}}$, expressed in minutes, where $t_{\\mathrm{peak}}$ is the nonnegative time at which $C(t)$ attains its maximum.\n\n- Answers must be reported in the units mg/dL for concentrations and minutes for time, each rounded to two decimal places.\n\nTest suite (each case specified as $(k_a, k_c, F, V_d, C_0, D, s)$ with $k_a$ and $k_c$ in $\\text{min}^{-1}$, $F$ unitless, $V_d$ in dL, $C_0$ in mg/dL, $D$ in g, and $s$ unitless):\n- Case A (happy path): $(0.06, 0.012, 0.9, 700, 90, 75, 0.5)$.\n- Case B (boundary where $k_a=k_c$ without inhibitor): $(0.03, 0.03, 0.85, 700, 95, 75, 0.4)$.\n- Case C (higher absorption and smaller volume): $(0.08, 0.015, 0.95, 600, 85, 75, 0.6)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists, one per test case, in the form\n\"[[peak_reduction_caseA,time_to_peak_delay_caseA],[peak_reduction_caseB,time_to_peak_delay_caseB],[peak_reduction_caseC,time_to_peak_delay_caseC]]\"\nwith each numeric value rounded to two decimals and no units in the output string. For example, the output format must look like \"[[xA,yA],[xB,yB],[xC,yC]]\" where $x$ and $y$ are decimal numbers.",
            "solution": "The problem presents a standard two-compartment pharmacokinetic model describing glucose dynamics following an oral glucose load, modulated by an $\\alpha$-glucosidase inhibitor. The model is mathematically sound, consisting of a system of linear first-order ordinary differential equations with specified initial conditions. A complete analytical solution exists and is unique, making the problem well-posed. All parameters and conditions are provided, and their values are within a scientifically plausible range. Therefore, the problem is valid and a solution can be derived from first principles.\n\nThe core of the task is to find an analytical expression for the plasma glucose concentration over time, $C(t)$, and from this, to determine the time to peak concentration, $t_{\\mathrm{peak}}$, and the peak excursion from baseline, $\\Delta C_{\\mathrm{peak}}$.\n\nLet us begin with the provided system of differential equations:\n$$ \\dfrac{dM_g}{dt} = -k_a^{\\mathrm{eff}}\\,M_g(t) \\quad \\text{with} \\quad M_g(0)=D $$\n$$ \\dfrac{dC}{dt} = \\left(\\dfrac{F\\cdot 1000}{V_d}\\right)\\,k_a^{\\mathrm{eff}}\\,M_g(t) - k_c\\,(C(t)-C_0) \\quad \\text{with} \\quad C(0)=C_0 $$\nThe effective absorption rate is modulated by the inhibitor, $k_a^{\\mathrm{eff}} = s \\cdot k_a$.\n\nFirst, we solve the equation for the mass of carbohydrate in the gut, $M_g(t)$. This is a standard first-order decay process, the solution of which is:\n$$ M_g(t) = D\\,e^{-k_a^{\\mathrm{eff}} t} $$\n\nNext, we address the plasma glucose concentration, $C(t)$. It is mathematically convenient to analyze the excursion of glucose concentration above its baseline, defined as $\\Delta C(t) = C(t) - C_0$. The derivative of this quantity is $\\frac{d(\\Delta C)}{dt} = \\frac{dC}{dt}$, and its initial condition is $\\Delta C(0) = C(0) - C_0 = C_0 - C_0 = 0$. Substituting $\\Delta C(t)$ and the solution for $M_g(t)$ into the second differential equation yields:\n$$ \\dfrac{d(\\Delta C)}{dt} = \\left(\\dfrac{F\\cdot 1000 \\cdot D}{V_d}\\right)\\,k_a^{\\mathrm{eff}}\\,e^{-k_a^{\\mathrm{eff}} t} - k_c\\,\\Delta C(t) $$\nLet us define a constant representing the total amount of glucose that can appear in the plasma volume, $A = \\frac{F \\cdot 1000 \\cdot D}{V_d}$. The equation becomes:\n$$ \\dfrac{d(\\Delta C)}{dt} + k_c\\,\\Delta C(t) = A\\,k_a^{\\mathrm{eff}}\\,e^{-k_a^{\\mathrm{eff}} t} $$\nThis is a first-order linear non-homogeneous ordinary differential equation. We can solve it using an integrating factor, $I(t) = e^{\\int k_c dt} = e^{k_c t}$. The solution depends on whether $k_a^{\\mathrm{eff}}$ is equal to $k_c$.\n\nCase 1: $k_a^{\\mathrm{eff}} \\neq k_c$\nSolving the ODE yields the well-known Bateman function:\n$$ \\Delta C(t) = A \\frac{k_a^{\\mathrm{eff}}}{k_c - k_a^{\\mathrm{eff}}} \\left( e^{-k_a^{\\mathrm{eff}} t} - e^{-k_c t} \\right) $$\n\nTo find the time to peak, $t_{\\mathrm{peak}}$, we set the derivative of $\\Delta C(t)$ to zero. The maximum of $C(t)$ occurs at the same time as the maximum of $\\Delta C(t)$.\n$$ \\dfrac{d(\\Delta C)}{dt} = A \\frac{k_a^{\\mathrm{eff}}}{k_c - k_a^{\\mathrm{eff}}} \\left( -k_a^{\\mathrm{eff}} e^{-k_a^{\\mathrm{eff}} t} + k_c e^{-k_c t} \\right) = 0 $$\n$$ k_c e^{-k_c t_{\\mathrm{peak}}} = k_a^{\\mathrm{eff}} e^{-k_a^{\\mathrm{eff}} t_{\\mathrm{peak}}} $$\nSolving for $t_{\\mathrm{peak}}$:\n$$ t_{\\mathrm{peak}} = \\frac{\\ln(k_c / k_a^{\\mathrm{eff}})}{k_c - k_a^{\\mathrm{eff}}} $$\nThe peak excursion, $\\Delta C_{\\mathrm{peak}}$, is found by substituting $t_{\\mathrm{peak}}$ back into the expression for $\\Delta C(t)$. A simpler expression for $\\Delta C_{\\mathrm{peak}}$ can be derived from the derivative condition $k_c e^{-k_c t_{\\mathrm{peak}}} = k_a^{\\mathrm{eff}} e^{-k_a^{\\mathrm{eff}} t_{\\mathrm{peak}}}$ and the solution for $\\Delta C(t_{\\mathrm{peak}})$, which simplifies to:\n$$ \\Delta C_{\\mathrm{peak}} = A\\,e^{-k_c t_{\\mathrm{peak}}} $$\n\nCase 2: $k_a^{\\mathrm{eff}} = k_c$\nIn this special case, the solution to the ODE is:\n$$ \\Delta C(t) = A\\,k_a^{\\mathrm{eff}}\\,t\\,e^{-k_a^{\\mathrm{eff}} t} $$\nTo find $t_{\\mathrm{peak}}$, we again set the derivative to zero:\n$$ \\dfrac{d(\\Delta C)}{dt} = A\\,k_a^{\\mathrm{eff}} \\left( e^{-k_a^{\\mathrm{eff}} t} - k_a^{\\mathrm{eff}} t e^{-k_a^{\\mathrm{eff}} t} \\right) = A\\,k_a^{\\mathrm{eff}} e^{-k_a^{\\mathrm{eff}}t} (1 - k_a^{\\mathrm{eff}}t) = 0 $$\nThis gives:\n$$ t_{\\mathrm{peak}} = \\frac{1}{k_a^{\\mathrm{eff}}} $$\nSubstituting this into the expression for $\\Delta C(t)$ gives the peak excursion:\n$$ \\Delta C_{\\mathrm{peak}} = A\\,k_a^{\\mathrm{eff}} \\left(\\frac{1}{k_a^{\\mathrm{eff}}}\\right) e^{-k_a^{\\mathrm{eff}} (1/k_a^{\\mathrm{eff}})} = A\\,e^{-1} $$\nThese formulas for the special case are consistent with the limits of the general case formulas as $k_c \\to k_a^{\\mathrm{eff}}$.\n\nThe computational strategy is as follows: For each test case, we compute the required values for two scenarios: without inhibitor ($s=1$) and with inhibitor (given $s<1$).\nLet the given parameters be $(k_a, k_c, F, V_d, C_0, D, s)$.\nThe constant $A = \\frac{F \\cdot 1000 \\cdot D}{V_d}$ is independent of the inhibitor.\n\n1.  **No Inhibitor Scenario:**\n    - Set $s_{\\mathrm{no\\_inh}} = 1$, so $k_{a,\\mathrm{no\\_inh}}^{\\mathrm{eff}} = k_a$.\n    - Based on whether $k_a = k_c$, use the appropriate formulas to calculate $t_{\\mathrm{peak}}^{\\mathrm{no\\,inh}}$ and $\\Delta C_{\\mathrm{peak}}^{\\mathrm{no\\,inh}}$.\n\n2.  **Inhibitor Scenario:**\n    - Use the given $s$, so $k_{a,\\mathrm{inh}}^{\\mathrm{eff}} = s \\cdot k_a$.\n    - Based on whether $s \\cdot k_a = k_c$, use the appropriate formulas to calculate $t_{\\mathrm{peak}}^{\\mathrm{inh}}$ and $\\Delta C_{\\mathrm{peak}}^{\\mathrm{inh}}$.\n\n3.  **Final Outputs:**\n    - Peak reduction: $\\Delta C_{\\mathrm{peak}}^{\\mathrm{no\\,inh}} - \\Delta C_{\\mathrm{peak}}^{\\mathrm{inh}}$ (in mg/dL).\n    - Time-to-peak delay: $t_{\\mathrm{peak}}^{\\mathrm{inh}}-t_{\\mathrm{peak}}^{\\mathrm{no\\,inh}}$ (in minutes).\n\nThe results for each test case are calculated, rounded to two decimal places, and presented in the required format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pharmacokinetic modeling problem for the given test cases.\n    \"\"\"\n    \n    # Each test case is specified as a tuple:\n    # (ka, kc, F, Vd, C0, D, s)\n    # ka, kc in min^-1; F unitless; Vd in dL; C0 in mg/dL; D in g; s unitless.\n    test_cases = [\n        (0.06, 0.012, 0.9, 700, 90, 75, 0.5), # Case A\n        (0.03, 0.03, 0.85, 700, 95, 75, 0.4), # Case B\n        (0.08, 0.015, 0.95, 600, 85, 75, 0.6)  # Case C\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        ka, kc, F, Vd, C0, D, s_inhibitor = case\n        \n        # Calculate the scaling factor A, which is independent of the inhibitor.\n        # This factor has units of mg/dL.\n        A = (F * 1000 * D) / Vd\n        \n        # --- Helper function for calculating peak time and concentration ---\n        def calculate_peak(ka_eff, kc_val, A_val):\n            \"\"\"\n            Calculates time-to-peak (t_peak) and peak concentration excursion \n            (delta_C_peak) based on the derived analytical solutions.\n\n            Args:\n                ka_eff (float): Effective absorption rate constant (min^-1).\n                kc_val (float): Clearance rate constant (min^-1).\n                A_val (float): Scaling factor (mg/dL).\n\n            Returns:\n                tuple: A tuple containing (t_peak, delta_C_peak).\n            \"\"\"\n            # Use a small tolerance for floating-point comparison.\n            if abs(ka_eff - kc_val)  1e-9:\n                # Special case where ka_eff is approximately equal to kc\n                t_peak = 1.0 / ka_eff\n                delta_C_peak = A_val * np.exp(-1.0)\n            else:\n                # General case where ka_eff is not equal to kc\n                t_peak = np.log(kc_val / ka_eff) / (kc_val - ka_eff)\n                delta_C_peak = A_val * np.exp(-kc_val * t_peak)\n            \n            return t_peak, delta_C_peak\n\n        # --- No Inhibitor Case (s=1) ---\n        ka_eff_no_inh = ka * 1.0\n        t_peak_no_inh, delta_C_peak_no_inh = calculate_peak(ka_eff_no_inh, kc, A)\n        \n        # --- Inhibitor Case (using given s) ---\n        ka_eff_inh = ka * s_inhibitor\n        t_peak_inh, delta_C_peak_inh = calculate_peak(ka_eff_inh, kc, A)\n        \n        # --- Calculate final required outputs ---\n        # Peak reduction in plasma glucose concentration due to the inhibitor\n        peak_reduction = delta_C_peak_no_inh - delta_C_peak_inh\n        \n        # Time-to-peak delay caused by the inhibitor\n        time_to_peak_delay = t_peak_inh - t_peak_no_inh\n        \n        # Format results for the current case, rounding to two decimal places\n        case_result = [round(peak_reduction, 2), round(time_to_peak_delay, 2)]\n        all_results.append(case_result)\n        \n    # Final print statement must produce the single-line format specified.\n    # The str() representation of a list of lists is correct, but we remove spaces.\n    # Example format: \"[[xA,yA],[xB,yB],[xC,yC]]\"\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n```"
        },
        {
            "introduction": "The ultimate test of a drug is its safe and effective application in diverse patient populations. This clinical case study  contrasts two different $\\alpha$-glucosidase inhibitors to highlight the critical role of their distinct pharmacokinetic profiles, particularly absorption and elimination. By calculating a dose adjustment for a patient with renal impairment, you will apply the core pharmacological principle of clearance to ensure consistent drug exposure and avoid potential toxicity, bridging the gap between drug properties and real-world clinical management.",
            "id": "4996161",
            "problem": "A clinician is choosing between two $\\alpha$-glucosidase inhibitors for a patient with type $2$ diabetes mellitus and reduced renal function. One choice, miglitol, is known to be systemically absorbed from the small intestine and eliminated predominantly by the kidneys unchanged. The other choice, acarbose, has very low systemic absorption and acts primarily within the intestinal lumen, with minimal distribution beyond the gut and negligible renal elimination of parent drug. Using well-tested pharmacokinetic principles and definitions, first compare the absorption, distribution, and renal elimination of these two drugs, and then compute a renal dose adjustment for miglitol.\n\nAssume the following scientifically plausible and internally consistent data for miglitol in a typical adult with normal renal function:\n- Oral bioavailability $F_{\\text{miglitol}} = 0.95$.\n- Total body clearance under normal renal function $CL_{\\text{normal}} = 4.5$ $\\text{L}\\,\\text{h}^{-1}$.\n- Fraction of total clearance that is renal under normal renal function $f_{r} = 0.90$.\n- Nonrenal clearance is the remainder.\n- Renal clearance scales linearly with creatinine clearance, defined as $CL_{r} \\propto \\text{Creatinine Clearance (CrCl)}$.\n- Reference normal creatinine clearance $\\text{CrCl}_{\\text{ref}} = 100$ $\\text{mL}\\,\\text{min}^{-1}$.\n\nFor a $70$ $\\text{kg}$ patient with measured $\\text{CrCl} = 30$ $\\text{mL}\\,\\text{min}^{-1}$, the clinician wishes to maintain the same average steady-state exposure to miglitol (equivalently, the same area under the curve for a fixed dosing interval) as would be achieved in a patient with normal renal function receiving a maintenance dose of $100$ $\\text{mg}$ three times daily (every $8$ $\\text{h}$). Use foundational pharmacokinetic relationships—linear kinetics, additivity of clearance components, and the dependence of steady-state exposure on the ratio of dose to clearance—to derive the appropriate per-dose adjustment for miglitol in this renally impaired patient, keeping the dosing interval unchanged.\n\nRound your final numerical answer to three significant figures. Express the adjusted per-dose maintenance amount in $\\text{mg}$.",
            "solution": "The problem statement is evaluated as valid. It is scientifically grounded in established principles of pharmacology and pharmacokinetics, well-posed with all necessary and consistent data for a unique solution, and expressed in objective, formal language. The problem is a standard, non-trivial application of pharmacokinetic dose adjustment theory.\n\nThe problem requires a two-part response: first, a qualitative comparison of the pharmacokinetics of miglitol and acarbose, and second, a quantitative calculation of a dose adjustment for miglitol in a patient with renal impairment.\n\nFirst, we compare the pharmacokinetic properties of miglitol and acarbose based on the information provided.\n1.  **Absorption**: Miglitol is described as being systemically absorbed from the small intestine with an oral bioavailability ($F$) of $0.95$. This indicates that $95\\%$ of the orally administered dose reaches the systemic circulation to exert its effects and be subject to systemic clearance. In contrast, acarbose has very low systemic absorption, meaning it largely remains within the gastrointestinal (GI) tract, its site of action, with a negligible amount entering the bloodstream.\n2.  **Distribution**: Following its high systemic absorption, miglitol distributes throughout the body via the bloodstream. Acarbose, due to its minimal absorption, has a distribution that is primarily limited to the intestinal lumen.\n3.  **Elimination**: Miglitol is eliminated predominantly by the kidneys as an unchanged drug. The fraction of total clearance that is renal ($f_r$) is given as $0.90$. This high dependence on renal function for elimination makes its exposure sensitive to changes in kidney function. Acarbose, with its negligible systemic absorption, consequently has negligible renal elimination of the parent drug, as very little of it ever reaches the kidneys.\n\nDue to these profound differences, a patient with reduced renal function would be at high risk of drug accumulation and potential toxicity with a standard dose of miglitol, as its primary elimination pathway is impaired. Acarbose would not pose a similar risk related to renal impairment, making it a safer choice in this specific context without dose adjustment.\n\nNext, we proceed with the quantitative dose adjustment for miglitol. The clinical objective is to maintain the same average steady-state drug exposure in the renally impaired patient as in a patient with normal renal function. In linear pharmacokinetics, the average steady-state exposure is represented by the area under the plasma concentration-time curve over one dosing interval ($\\tau$), denoted $AUC_{\\tau,ss}$. This is given by the formula:\n$$\nAUC_{\\tau,ss} = \\frac{F \\cdot Dose}{CL}\n$$\nwhere $F$ is the oral bioavailability, $Dose$ is the dose administered per interval $\\tau$, and $CL$ is the total body clearance.\n\nTo maintain the same exposure ($AUC_{\\tau,ss, \\text{patient}} = AUC_{\\tau,ss, \\text{normal}}$) with an unchanged dosing interval and drug formulation ($F$ is constant), the following relationship must hold:\n$$\n\\frac{F \\cdot Dose_{\\text{patient}}}{CL_{\\text{patient}}} = \\frac{F \\cdot Dose_{\\text{normal}}}{CL_{\\text{normal}}}\n$$\nThe bioavailability $F$ cancels, leading to the dose adjustment formula:\n$$\nDose_{\\text{patient}} = Dose_{\\text{normal}} \\cdot \\frac{CL_{\\text{patient}}}{CL_{\\text{normal}}}\n$$\nOur task reduces to calculating the total clearance in the patient, $CL_{\\text{patient}}$.\n\nTotal body clearance ($CL$) is the sum of renal clearance ($CL_r$) and non-renal clearance ($CL_{nr}$):\n$$\nCL = CL_r + CL_{nr}\n$$\n\nWe first determine the clearance components for a person with normal renal function.\nGiven:\n- Total clearance in normal function, $CL_{\\text{normal}} = 4.5$ $\\text{L}\\,\\text{h}^{-1}$.\n- Fraction of renal clearance, $f_r = 0.90$.\n- Normal dose, $Dose_{\\text{normal}} = 100$ $\\text{mg}$.\n\nThe renal clearance in a person with normal function is:\n$$\nCL_{r, \\text{normal}} = f_r \\cdot CL_{\\text{normal}} = 0.90 \\cdot 4.5 \\, \\text{L}\\,\\text{h}^{-1} = 4.05 \\, \\text{L}\\,\\text{h}^{-1}\n$$\nThe non-renal clearance is the remainder:\n$$\nCL_{nr} = CL_{\\text{normal}} - CL_{r, \\text{normal}} = 4.5 \\, \\text{L}\\,\\text{h}^{-1} - 4.05 \\, \\text{L}\\,\\text{h}^{-1} = 0.45 \\, \\text{L}\\,\\text{h}^{-1}\n$$\nNon-renal clearance is assumed to be unaffected by changes in kidney function.\n\nNow, we calculate the clearance components for the patient with renal impairment.\nGiven:\n- Patient's creatinine clearance, $\\text{CrCl}_{\\text{patient}} = 30$ $\\text{mL}\\,\\text{min}^{-1}$.\n- Reference normal creatinine clearance, $\\text{CrCl}_{\\text{ref}} = 100$ $\\text{mL}\\,\\text{min}^{-1}$.\n\nThe problem states that miglitol's renal clearance ($CL_r$) is directly proportional to creatinine clearance ($\\text{CrCl}$). Therefore, we can find the patient's renal clearance by scaling the normal renal clearance by the ratio of the patient's $\\text{CrCl}$ to the reference $\\text{CrCl}$:\n$$\nCL_{r, \\text{patient}} = CL_{r, \\text{normal}} \\cdot \\frac{\\text{CrCl}_{\\text{patient}}}{\\text{CrCl}_{\\text{ref}}}\n$$\n$$\nCL_{r, \\text{patient}} = 4.05 \\, \\text{L}\\,\\text{h}^{-1} \\cdot \\frac{30 \\, \\text{mL}\\,\\text{min}^{-1}}{100 \\, \\text{mL}\\,\\text{min}^{-1}} = 4.05 \\, \\text{L}\\,\\text{h}^{-1} \\cdot 0.3 = 1.215 \\, \\text{L}\\,\\text{h}^{-1}\n$$\nThe total clearance in the patient is the sum of their impaired renal clearance and their unchanged non-renal clearance:\n$$\nCL_{\\text{patient}} = CL_{r, \\text{patient}} + CL_{nr} = 1.215 \\, \\text{L}\\,\\text{h}^{-1} + 0.45 \\, \\text{L}\\,\\text{h}^{-1} = 1.665 \\, \\text{L}\\,\\text{h}^{-1}\n$$\n\nFinally, we calculate the adjusted dose for the patient:\n$$\nDose_{\\text{patient}} = Dose_{\\text{normal}} \\cdot \\frac{CL_{\\text{patient}}}{CL_{\\text{normal}}}\n$$\n$$\nDose_{\\text{patient}} = 100 \\, \\text{mg} \\cdot \\frac{1.665 \\, \\text{L}\\,\\text{h}^{-1}}{4.5 \\, \\text{L}\\,\\text{h}^{-1}}\n$$\n$$\nDose_{\\text{patient}} = 100 \\, \\text{mg} \\cdot 0.37 = 37 \\, \\text{mg}\n$$\nThe problem requires the final answer to be rounded to three significant figures.\n$$\nDose_{\\text{patient}} = 37.0 \\, \\text{mg}\n$$\nThus, the adjusted per-dose maintenance amount for miglitol in this patient is $37.0$ $\\text{mg}$, administered three times daily.",
            "answer": "$$\n\\boxed{37.0}\n$$"
        }
    ]
}