{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of pharmacology is the design of rational dosing regimens that maximize therapeutic benefit while minimizing toxicity. This practice grounds this concept by using a classic pharmacokinetic model to predict how a drug's concentration behaves over time with repeated dosing. By applying fundamental principles, you will determine the optimal dosing interval to keep drug levels safely and effectively within the desired therapeutic window, a core skill for any pharmacologist. ",
            "id": "4957507",
            "problem": "A cytokine or immunomodulator administered by an extravascular route can often be modeled using a one-compartment pharmacokinetic system with first-order absorption and first-order elimination. Assume bioavailability is constant and equal to a known fraction, and that doses are repeated at a fixed dosing interval. The concentration-time profile under these assumptions is governed by linear differential equations and the principle of superposition. For steady-state under linear kinetics, the concentration between any two doses is periodic with the dosing interval. The therapeutic window for immunomodulatory effect can be defined by a minimum effective concentration and a maximum tolerated concentration. A practical dosing interval should keep the entire steady-state concentration-time curve within this window.\n\nStarting from the following foundational bases:\n- The one-compartment model with first-order absorption and first-order elimination, where the amount in the absorption site decreases proportionally to the current amount and the central compartment undergoes elimination proportional to its amount, and\n- The definition of clearance as $Cl = k_{e} \\cdot V_{d}$ and linear superposition for repeated dosing,\n\ndesign an algorithm that, for each candidate dosing interval, constructs the steady-state concentration-time function over one dosing interval and checks whether it remains entirely within a specified therapeutic window. Your algorithm must:\n- Use the assumptions above to correctly construct the steady-state concentration-time curve for a given set of parameters without relying on any external data,\n- Compute the maximum and minimum steady-state concentrations over the interval $[0,\\tau)$ for each candidate interval $\\tau$,\n- Select the largest dosing interval (in hours) among the provided candidates that satisfies both $C_{\\min,\\mathrm{ss}} \\geq \\mathrm{MEC}$ and $C_{\\max,\\mathrm{ss}} \\leq \\mathrm{MTC}$, where $\\mathrm{MEC}$ is the minimum effective concentration and $\\mathrm{MTC}$ is the maximum tolerated concentration,\n- Return $-1$ if no candidate interval satisfies these constraints.\n\nAll concentrations must be treated in $\\mathrm{mg}/\\mathrm{L}$, doses in $\\mathrm{mg}$, volumes in $\\mathrm{L}$, and rates in $\\mathrm{h}^{-1}$. Your program must express the final selected dosing interval in hours. When a case is not feasible, return the integer $-1$. The time variable is in $\\mathrm{h}$. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[12,24,-1]$), where each entry corresponds to one test case in order.\n\nTest suite. For each test case below, the parameters are given as a tuple:\n$(D, F, V_{d}, k_{a}, k_{e}, \\mathrm{MEC}, \\mathrm{MTC}, \\text{candidates})$ where:\n- $D$ is the dose in $\\mathrm{mg}$,\n- $F$ is the absolute bioavailability (unitless),\n- $V_{d}$ is the apparent volume of distribution in $\\mathrm{L}$,\n- $k_{a}$ is the first-order absorption rate constant in $\\mathrm{h}^{-1}$,\n- $k_{e}$ is the first-order elimination rate constant in $\\mathrm{h}^{-1}$,\n- $\\mathrm{MEC}$ is the minimum effective concentration in $\\mathrm{mg}/\\mathrm{L}$,\n- $\\mathrm{MTC}$ is the maximum tolerated concentration in $\\mathrm{mg}/\\mathrm{L}$,\n- $\\text{candidates}$ is the list of candidate dosing intervals in hours.\n\nUse the following test cases:\n- Case $1$ (short half-life cytokine agonist): $(D=100, F=0.9, V_{d}=10, k_{a}=1.5, k_{e}=0.2, \\mathrm{MEC}=2, \\mathrm{MTC}=10, \\text{candidates}=[6, 8, 12, 24])$.\n- Case $2$ (type I interferon analog): $(D=50, F=0.9, V_{d}=20, k_{a}=1.0, k_{e}=0.05, \\mathrm{MEC}=1, \\mathrm{MTC}=8, \\text{candidates}=[12, 24, 48])$.\n- Case $3$ (subcutaneous monoclonal antibody with slow absorption): $(D=240, F=0.7, V_{d}=5, k_{a}=0.02, k_{e}=0.0015, \\mathrm{MEC}=20, \\mathrm{MTC}=200, \\text{candidates}=[168, 336, 504, 672])$.\n- Case $4$ (low-dose interleukin-2 analog; infeasible window): $(D=5, F=0.5, V_{d}=15, k_{a}=2.0, k_{e}=0.3, \\mathrm{MEC}=1, \\mathrm{MTC}=5, \\text{candidates}=[6, 8, 12])$.\n\nFinal output format: Your program should produce a single line containing a Python-style list of the chosen dosing intervals in hours for the four cases, in order, for example $[\\tau_{1},\\tau_{2},\\tau_{3},\\tau_{4}]$, where each $\\tau_{i}$ is either a number in hours or the integer $-1$.",
            "solution": "The user wants me to act as a meticulous STEM professor. I have to validate the problem, and if it's valid, provide a solution.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Model:** One-compartment pharmacokinetic system with first-order absorption and first-order elimination.\n*   **Administration:** Extravascular route.\n*   **Dosing:** Repeated doses ($D$, in $\\mathrm{mg}$) at a fixed dosing interval ($\\tau$, in $\\mathrm{h}$).\n*   **Parameters:**\n    *   $D$: dose in $\\mathrm{mg}$.\n    *   $F$: absolute bioavailability (unitless).\n    *   $V_d$: apparent volume of distribution in $\\mathrm{L}$.\n    *   $k_a$: first-order absorption rate constant in $\\mathrm{h}^{-1}$.\n    *   $k_e$: first-order elimination rate constant in $\\mathrm{h}^{-1}$.\n    *   $\\mathrm{MEC}$: minimum effective concentration in $\\mathrm{mg}/\\mathrm{L}$.\n    *   $\\mathrm{MTC}$: maximum tolerated concentration in $\\mathrm{mg}/\\mathrm{L}$.\n    *   `candidates`: a list of candidate dosing intervals in hours.\n*   **Principles:**\n    *   The system is governed by linear differential equations.\n    *   The principle of superposition applies for repeated dosing.\n    *   Clearance is defined as $Cl = k_e \\cdot V_d$.\n*   **Objective:**\n    1.  Design an algorithm to construct the steady-state concentration-time function, $C_{\\mathrm{ss}}(t)$, over one dosing interval $[0, \\tau)$.\n    2.  For each candidate interval $\\tau$, compute the minimum ($C_{\\min,\\mathrm{ss}}$) and maximum ($C_{\\max,\\mathrm{ss}}$) steady-state concentrations.\n    3.  Select the largest dosing interval from the `candidates` list that satisfies both $C_{\\min,\\mathrm{ss}} \\geq \\mathrm{MEC}$ and $C_{\\max,\\mathrm{ss}} \\leq \\mathrm{MTC}$.\n    4.  Return $-1$ if no candidate interval meets the criteria.\n*   **Test Cases:**\n    *   Case 1: $(D=100, F=0.9, V_d=10, k_a=1.5, k_e=0.2, \\mathrm{MEC}=2, \\mathrm{MTC}=10, \\text{candidates}=[6, 8, 12, 24])$.\n    *   Case 2: $(D=50, F=0.9, V_d=20, k_a=1.0, k_e=0.05, \\mathrm{MEC}=1, \\mathrm{MTC}=8, \\text{candidates}=[12, 24, 48])$.\n    *   Case 3: $(D=240, F=0.7, V_d=5, k_a=0.02, k_e=0.0015, \\mathrm{MEC}=20, \\mathrm{MTC}=200, \\text{candidates}=[168, 336, 504, 672])$.\n    *   Case 4: $(D=5, F=0.5, V_d=15, k_a=2.0, k_e=0.3, \\mathrm{MEC}=1, \\mathrm{MTC}=5, \\text{candidates}=[6, 8, 12])$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is based on the standard, universally accepted one-compartment model with first-order absorption and elimination. This model is a fundamental concept in pharmacology and pharmacokinetics. All principles mentioned (linear kinetics, superposition, steady state) are cornerstones of the field.\n*   **Well-Posed:** The problem is clearly specified. For each test case, all necessary parameters are provided. The objective is to find the maximum value from a finite, explicitly given set of candidates that satisfies a pair of well-defined inequalities. The existence and uniqueness of such a value (or the lack thereof, resulting in a return value of $-1$) are guaranteed.\n*   **Objective:** The problem is stated using precise, objective, and technical language. The criteria for success are quantitative and unambiguous.\n*   **Flaw Checklist:**\n    1.  *Scientific/Factual Unsoundness:* No violations. The model is sound.\n    2.  *Non-Formalizable/Irrelevant:* The problem is a classic example of applying mathematical models in pharmacology and is directly formalizable. The topic is immunopharmacology, which is a sub-field of pharmacology where such models are extensively used for biologics.\n    3.  *Incomplete/Contradictory:* The problem is self-contained. All necessary data are provided. No contradictions are present. An important edge case, $k_a = k_e$, which would require a different mathematical formula, does not occur in any of the test cases.\n    4.  *Unrealistic/Infeasible:* The parameters provided in the test cases are pharmacokinetically plausible for the described drug types (e.g., very slow rates for a monoclonal antibody).\n    5.  *Ill-Posed/Poorly Structured:* The problem is well-structured and admits a unique solution for each test case.\n    6.  *Pseudo-Profound/Trivial:* The problem requires substantive knowledge of pharmacokinetic modeling and calculus to derive and apply the correct formulas. It is a standard, non-trivial academic problem.\n    7.  *Outside Scientific Verifiability:* The calculations are deterministic and can be independently verified.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A solution will be provided.\n\n### Principle-Based Design of the Solution\n\nThe algorithm design is rooted in the mathematical description of a one-compartment pharmacokinetic model with first-order absorption and elimination following repeated extravascular administration.\n\n**1. Single-Dose Pharmacokinetics**\n\nLet $A_a(t)$ be the amount of drug at the extravascular absorption site and $A_c(t)$ be the amount in the central compartment at time $t$. The system is described by a pair of linear first-order ordinary differential equations:\n$$\n\\frac{dA_a}{dt} = -k_a A_a(t)\n$$\n$$\n\\frac{dA_c}{dt} = k_a A_a(t) - k_e A_c(t)\n$$\nFor a single dose $D$ administered at $t=0$, with bioavailability $F$, the initial conditions are $A_a(0) = F \\cdot D$ and $A_c(0) = 0$. Solving this system yields the amount in the central compartment:\n$$\nA_c(t) = \\frac{F D k_a}{k_a - k_e} (e^{-k_e t} - e^{-k_a t})\n$$\nThe concentration in the central compartment, $C(t)$, is $A_c(t)$ divided by the volume of distribution, $V_d$:\n$$\nC(t) = \\frac{A_c(t)}{V_d} = \\frac{F D k_a}{V_d (k_a - k_e)} (e^{-k_e t} - e^{-k_a t})\n$$\nThis equation is valid for $k_a \\neq k_e$, a condition met by all test cases.\n\n**2. Steady-State Pharmacokinetics with Repeated Dosing**\n\nWhen a dose is administered repeatedly every $\\tau$ hours, the concentration at steady-state, $C_{\\mathrm{ss}}(t)$, for time $t$ within any dosing interval (e.g., $t \\in [0, \\tau)$) can be found by applying the principle of superposition. This involves summing the contributions from an infinite series of past doses:\n$$\nC_{\\mathrm{ss}}(t) = \\sum_{n=0}^{\\infty} C(t + n\\tau)\n$$\nSubstituting the expression for $C(t)$ and evaluating the resulting geometric series gives the closed-form solution for the steady-state concentration:\n$$\nC_{\\mathrm{ss}}(t) = \\frac{F D k_a}{V_d (k_a - k_e)} \\left[ \\left(\\sum_{n=0}^{\\infty} e^{-k_e(t+n\\tau)}\\right) - \\left(\\sum_{n=0}^{\\infty} e^{-k_a(t+n\\tau)}\\right) \\right]\n$$\n$$\nC_{\\mathrm{ss}}(t) = \\frac{F D k_a}{V_d (k_a - k_e)} \\left[ \\frac{e^{-k_e t}}{1 - e^{-k_e \\tau}} - \\frac{e^{-k_a t}}{1 - e^{-k_a \\tau}} \\right]\n$$\nThis function describes the periodic concentration profile between doses at steady state.\n\n**3. Extrema of the Steady-State Concentration Profile**\n\nTo ensure the dosing regimen is safe and effective, the entire concentration curve over a dosing interval, $[C_{\\mathrm{ss}}(t)]_{t \\in [0, \\tau)}$, must lie within the therapeutic window $[\\mathrm{MEC}, \\mathrm{MTC}]$. This requires finding the minimum and maximum concentrations at steady state, $C_{\\min,\\mathrm{ss}}$ and $C_{\\max,\\mathrm{ss}}$.\n\n*   **Minimum Concentration ($C_{\\min,\\mathrm{ss}}$):**\n    The concentration is at its lowest just before the administration of the next dose. This corresponds to time $t=0$ (or equivalently, $t=\\tau$ from the previous interval).\n    $$\n    C_{\\min,\\mathrm{ss}} = C_{\\mathrm{ss}}(0) = \\frac{F D k_a}{V_d (k_a - k_e)} \\left[ \\frac{1}{1 - e^{-k_e \\tau}} - \\frac{1}{1 - e^{-k_a \\tau}} \\right]\n    $$\n*   **Maximum Concentration ($C_{\\max,\\mathrm{ss}}$):**\n    The maximum concentration occurs at a time $t_{\\max,\\mathrm{ss}}$ where the derivative $\\frac{dC_{\\mathrm{ss}}}{dt}$ is zero. Differentiating $C_{\\mathrm{ss}}(t)$ and setting the result to zero yields:\n    $$\n    \\frac{dC_{\\mathrm{ss}}}{dt} = \\frac{F D k_a}{V_d (k_a - k_e)} \\left[ \\frac{-k_e e^{-k_e t}}{1 - e^{-k_e \\tau}} - \\frac{-k_a e^{-k_a t}}{1 - e^{-k_a \\tau}} \\right] = 0\n    $$\n    Solving for $t = t_{\\max,\\mathrm{ss}}$ gives:\n    $$\n    t_{\\max,\\mathrm{ss}} = \\frac{1}{k_a - k_e} \\ln\\left[ \\frac{k_a}{k_e} \\frac{1 - e^{-k_e \\tau}}{1 - e^{-k_a \\tau}} \\right]\n    $$\n    The maximum concentration is then found by substituting this time back into the steady-state equation:\n    $$\n    C_{\\max,\\mathrm{ss}} = C_{\\mathrm{ss}}(t_{\\max,\\mathrm{ss}})\n    $$\n    The derivative of the concentration at $t=0$ is always positive (for $k_a \\neq k_e$), confirming that the concentration rises from its minimum at the start of the interval to a peak within the interval, before declining.\n\n**4. Algorithmic Implementation**\n\nThe final algorithm iterates through each test case and, for each case, through each candidate dosing interval $\\tau$.\n\n1.  For a given candidate interval $\\tau$ from the list, calculate $C_{\\min,\\mathrm{ss}}$ using its formula.\n2.  Calculate the time to peak, $t_{\\max,\\mathrm{ss}}$.\n3.  Calculate $C_{\\max,\\mathrm{ss}}$ by evaluating $C_{\\mathrm{ss}}(t)$ at $t=t_{\\max,\\mathrm{ss}}$.\n4.  Check if the therapeutic window conditions are met: $C_{\\min,\\mathrm{ss}} \\geq \\mathrm{MEC}$ and $C_{\\max,\\mathrm{ss}} \\leq \\mathrm{MTC}$.\n5.  If the conditions are met, the interval $\\tau$ is considered valid.\n6.  After testing all candidate intervals for a given drug, identify all valid intervals.\n7.  If the set of valid intervals is empty, the result for that case is $-1$.\n8.  Otherwise, the result is the largest value in the set of valid intervals, as required by the problem.\n\nThis procedure is systematically applied to all test cases to generate the final output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the pharmacokinetic dosing interval problem for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (short half-life cytokine agonist)\n        {'D': 100, 'F': 0.9, 'Vd': 10, 'ka': 1.5, 'ke': 0.2, 'MEC': 2, 'MTC': 10, 'candidates': [6, 8, 12, 24]},\n        # Case 2 (type I interferon analog)\n        {'D': 50, 'F': 0.9, 'Vd': 20, 'ka': 1.0, 'ke': 0.05, 'MEC': 1, 'MTC': 8, 'candidates': [12, 24, 48]},\n        # Case 3 (subcutaneous monoclonal antibody with slow absorption)\n        {'D': 240, 'F': 0.7, 'Vd': 5, 'ka': 0.02, 'ke': 0.0015, 'MEC': 20, 'MTC': 200, 'candidates': [168, 336, 504, 672]},\n        # Case 4 (low-dose interleukin-2 analog; infeasible window)\n        {'D': 5, 'F': 0.5, 'Vd': 15, 'ka': 2.0, 'ke': 0.3, 'MEC': 1, 'MTC': 5, 'candidates': [6, 8, 12]},\n    ]\n    \n    results = []\n    for case in test_cases:\n        result = find_best_interval(\n            case['D'], case['F'], case['Vd'], case['ka'], case['ke'],\n            case['MEC'], case['MTC'], case['candidates']\n        )\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_best_interval(D, F, Vd, ka, ke, MEC, MTC, candidates):\n    \"\"\"\n    Finds the largest dosing interval from a list of candidates that keeps\n    steady-state concentrations within the therapeutic window.\n    \n    Args:\n        D (float): Dose (mg)\n        F (float): Bioavailability\n        Vd (float): Volume of distribution (L)\n        ka (float): Absorption rate constant (h^-1)\n        ke (float): Elimination rate constant (h^-1)\n        MEC (float): Minimum effective concentration (mg/L)\n        MTC (float): Maximum tolerated concentration (mg/L)\n        candidates (list): List of candidate dosing intervals (h)\n        \n    Returns:\n        int: The largest valid dosing interval, or -1 if none are valid.\n    \"\"\"\n    valid_intervals = []\n    \n    # Pre-calculate the constant part of the concentration equation\n    # This assumes ka is not equal to ke, which is true for all test cases.\n    if ka == ke:\n        # This case requires a different formula not implemented here as it's not needed.\n        # All test cases have ka != ke.\n        pass\n\n    prefactor = (F * D * ka) / (Vd * (ka - ke))\n\n    for tau in candidates:\n        # Calculate C_min_ss, which is C_ss(t=0)\n        # Using the formula: C_min_ss = Prefactor * [1/(1-exp(-ke*tau)) - 1/(1-exp(-ka*tau))]\n        term_e_min = 1.0 / (1.0 - np.exp(-ke * tau))\n        term_a_min = 1.0 / (1.0 - np.exp(-ka * tau))\n        C_min_ss = prefactor * (term_e_min - term_a_min)\n\n        # Calculate t_max_ss, the time of maximum concentration at steady state\n        # Using the formula: t_max_ss = (1/(ka-ke)) * ln[(ka/ke) * (1-exp(-ke*tau))/(1-exp(-ka*tau))]\n        log_arg = (ka / ke) * ((1.0 - np.exp(-ke * tau)) / (1.0 - np.exp(-ka * tau)))\n        t_max_ss = (1.0 / (ka - ke)) * np.log(log_arg)\n        \n        # Calculate C_max_ss, which is C_ss(t_max_ss)\n        # Using the formula: C_max_ss = Prefactor * [exp(-ke*t_max)/(1-exp(-ke*tau)) - exp(-ka*t_max)/(1-exp(-ka*tau))]\n        term_e_max = np.exp(-ke * t_max_ss) / (1.0 - np.exp(-ke * tau))\n        term_a_max = np.exp(-ka * t_max_ss) / (1.0 - np.exp(-ka * tau))\n        C_max_ss = prefactor * (term_e_max - term_a_max)\n\n        # Check if the calculated concentrations are within the therapeutic window\n        if C_min_ss >= MEC and C_max_ss = MTC:\n            valid_intervals.append(tau)\n            \n    if not valid_intervals:\n        return -1\n    else:\n        return max(valid_intervals)\n\nsolve()\n```"
        },
        {
            "introduction": "For immunomodulators like monoclonal antibodies, efficacy depends not just on the concentration in the blood, but on the drug reaching its molecular target in affected tissues. This exercise bridges the gap between pharmacokinetics and pharmacodynamics by modeling the journey of an antibody from the plasma into the tissue interstitium. You will calculate the \"target engagement\"—the fraction of the target bound by the drug—a critical metric for predicting a biologic's therapeutic effect at its site of action. ",
            "id": "4957438",
            "problem": "A neutralizing monoclonal antibody against Interleukin-6 (IL-6) is administered chronically such that the plasma concentration achieves a time-invariant steady state. Consider a two-compartment physiology in which plasma and a target tissue interstitium exchange antibody by permeability-limited transport. Assume the following:\n\n- The interstitium is well-stirred and at steady state with respect to antibody transport.\n- Transport between plasma and interstitium is described by a permeability–surface area product, with permeability–surface area product (PS) equal to $0.015$ $\\mathrm{L \\cdot h^{-1}}$.\n- Lymphatic efflux from the interstitium is described by a clearance $CL_{L}$ equal to $0.025$ $\\mathrm{L \\cdot h^{-1}}$.\n- The steady-state plasma concentration of antibody is $C_{p} = 24.0$ $\\mathrm{mg \\cdot L^{-1}}$.\n- The antibody has a molecular weight $MW = 150{,}000$ $\\mathrm{g \\cdot mol^{-1}}$.\n- Binding between antibody and IL-6 in the interstitium is rapid and reversible with dissociation constant $K_{d} = 3.0$ $\\mathrm{nM}$, and IL-6 concentration is sufficiently low that antibody depletion by binding is negligible (treat free antibody concentration as equal to total antibody concentration in the interstitium).\n- IL-6 has a single binding site for the antibody.\n\nStarting from conservation of mass at steady state for transport between compartments and the law of mass action for binding at equilibrium, derive the interstitial antibody concentration and then the fraction of IL-6 bound by antibody in the interstitium. Use molar concentrations for the binding calculation; convert from mass concentration using the given molecular weight. Express the final fraction of IL-6 bound (target engagement) as a unitless decimal, and round your answer to four significant figures.",
            "solution": "The problem describes a valid scenario in pharmacokinetics and pharmacodynamics. All parameters are provided, and the assumptions are scientifically sound for a simplified model. We can proceed with the solution.\n\nFirst, we determine the steady-state concentration of the antibody in the interstitium, denoted as $C_{i}$. This is achieved by applying the principle of mass conservation to the interstitial compartment. At steady state, the rate of antibody mass influx into the interstitium must equal the rate of antibody mass efflux.\n\nThe net transport rate of the antibody from the plasma to the interstitium is described by the permeability–surface area product, $PS$, and the concentration gradient between the plasma ($C_p$) and the interstitium ($C_i$).\n$$\n\\text{Rate of Influx} = PS \\cdot (C_{p} - C_{i})\n$$\nThe efflux of the antibody from the interstitium occurs via lymphatic drainage, which is modeled as a clearance process. The rate of efflux is the product of the lymphatic clearance, $CL_{L}$, and the interstitial concentration, $C_i$.\n$$\n\\text{Rate of Efflux} = CL_{L} \\cdot C_{i}\n$$\nAt steady state, the rate of influx equals the rate of efflux:\n$$\nPS \\cdot (C_{p} - C_{i}) = CL_{L} \\cdot C_i\n$$\nWe rearrange this equation to solve for $C_i$:\n$$\nPS \\cdot C_p - PS \\cdot C_i = CL_{L} \\cdot C_i\n$$\n$$\nPS \\cdot C_p = (PS + CL_{L}) \\cdot C_i\n$$\n$$\nC_i = \\frac{PS}{PS + CL_{L}} \\cdot C_p\n$$\nNow, we substitute the given values: $PS = 0.015$ $\\mathrm{L \\cdot h^{-1}}$, $CL_{L} = 0.025$ $\\mathrm{L \\cdot h^{-1}}$, and $C_p = 24.0$ $\\mathrm{mg \\cdot L^{-1}}$.\n$$\nC_i = \\frac{0.015}{0.015 + 0.025} \\cdot 24.0 = \\frac{0.015}{0.040} \\cdot 24.0 = 0.375 \\cdot 24.0 = 9.0 \\, \\mathrm{mg \\cdot L^{-1}}\n$$\nNext, we must convert this mass concentration to a molar concentration to analyze the binding equilibrium. Let $[Ab]_i$ represent the molar concentration of the antibody in the interstitium. The molecular weight is given as $MW = 150{,}000$ $\\mathrm{g \\cdot mol^{-1}}$.\n$$\nC_i = 9.0 \\, \\mathrm{mg \\cdot L^{-1}} = 9.0 \\times 10^{-3} \\, \\mathrm{g \\cdot L^{-1}}\n$$\n$$\n[Ab]_i = \\frac{C_i}{MW} = \\frac{9.0 \\times 10^{-3} \\, \\mathrm{g \\cdot L^{-1}}}{150{,}000 \\, \\mathrm{g \\cdot mol^{-1}}} = \\frac{9.0 \\times 10^{-3}}{1.5 \\times 10^{5}} \\, \\mathrm{mol \\cdot L^{-1}} = 6.0 \\times 10^{-8} \\, \\mathrm{mol \\cdot L^{-1}}\n$$\nSo, the molar concentration of the antibody in the interstitium is $[Ab]_i = 6.0 \\times 10^{-8}$ M.\n\nThe second part of the problem is to determine the fraction of IL-6 bound by the antibody. The binding reaction is $Ab + IL6 \\rightleftharpoons Ab \\cdot IL6$. The dissociation constant, $K_d$, is defined by the law of mass action at equilibrium:\n$$\nK_d = \\frac{[Ab]_{\\text{free}} [IL6]_{\\text{free}}}{[Ab \\cdot IL6]}\n$$\nThe fraction of IL-6 that is bound, which we denote as $f_b$, is the ratio of the concentration of the bound complex to the total concentration of IL-6.\n$$\nf_b = \\frac{[Ab \\cdot IL6]}{[IL6]_{\\text{total}}} = \\frac{[Ab \\cdot IL6]}{[IL6]_{\\text{free}} + [Ab \\cdot IL6]}\n$$\nFrom the expression for $K_d$, we can express $[IL6]_{\\text{free}}$ as $K_d \\frac{[Ab \\cdot IL6]}{[Ab]_{\\text{free}}}$. Substituting this into the equation for $f_b$:\n$$\nf_b = \\frac{[Ab \\cdot IL6]}{K_d \\frac{[Ab \\cdot IL6]}{[Ab]_{\\text{free}}} + [Ab \\cdot IL6]}\n$$\nBy dividing the numerator and denominator by $[Ab \\cdot IL6]$, we simplify the expression:\n$$\nf_b = \\frac{1}{\\frac{K_d}{[Ab]_{\\text{free}}} + 1} = \\frac{[Ab]_{\\text{free}}}{K_d + [Ab]_{\\text{free}}}\n$$\nThe problem states that \"antibody depletion by binding is negligible\". This is a critical assumption, which means the concentration of free antibody, $[Ab]_{\\text{free}}$, is effectively equal to the total interstitial antibody concentration, $[Ab]_i$. Therefore:\n$$\nf_b \\approx \\frac{[Ab]_i}{K_d + [Ab]_i}\n$$\nTo perform the final calculation, we must use consistent units. The dissociation constant is given as $K_d = 3.0$ nM. We convert our calculated interstitial antibody concentration to nM:\n$$\n[Ab]_i = 6.0 \\times 10^{-8} \\, \\mathrm{M} = 60 \\times 10^{-9} \\, \\mathrm{M} = 60 \\, \\mathrm{nM}\n$$\nNow we substitute the values of $[Ab]_i$ and $K_d$ into the equation for $f_b$:\n$$\nf_b = \\frac{60 \\, \\mathrm{nM}}{3.0 \\, \\mathrm{nM} + 60 \\, \\mathrm{nM}} = \\frac{60}{63}\n$$\nThe numerical value is:\n$$\nf_b = \\frac{60}{63} = \\frac{20}{21} \\approx 0.95238095...\n$$\nRounding the result to four significant figures, as requested, gives the final answer.",
            "answer": "$$\n\\boxed{0.9524}\n$$"
        },
        {
            "introduction": "The therapeutic journey of a biologic drug can be complicated by the patient's own immune system, which can develop anti-drug antibodies (ADAs) that compromise efficacy. This advanced practice introduces you to the challenge of immunogenicity by modeling the dynamic interactions between a drug and the ADAs that bind to it. By implementing a computational model based on mass-action kinetics, you will explore how ADAs can dramatically alter a drug's concentration profile, providing a window into the sophisticated analyses used in modern drug development. ",
            "id": "4957487",
            "problem": "A biologic immunomodulator can elicit Immunoglobulin G anti-drug antibodies (ADAs) that bind the drug and alter its pharmacokinetics. Consider a single, well-mixed compartment with free drug concentration $D(t)$, free antibody concentration $A(t)$, and drug–antibody complex concentration $C(t)$, each measured in arbitrary concentration units (a.u.). The binding follows mass-action kinetics and all eliminations are first-order. The fundamental starting point is the law of mass action and first-order decay, applied to the reversible binding reaction $D + A \\rightleftharpoons C$ with forward rate constant $k_{\\mathrm{on}}$ and reverse rate constant $k_{\\mathrm{off}}$, and independent first-order elimination of free drug, free antibody, and complex.\n\nFrom these principles, the system of ordinary differential equations (ODEs) is:\n$$\n\\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C,\n$$\n$$\n\\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C,\n$$\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - k_{\\mathrm{off}}\\,C - k_{\\mathrm{clearC}}\\,C,\n$$\nwhere $k_{\\mathrm{el}}$ is the free drug first-order elimination rate in $\\mathrm{hr}^{-1}$, $k_{\\mathrm{on}}$ is the binding rate constant in $\\mathrm{(a.u.)}^{-1}\\mathrm{hr}^{-1}$, $k_{\\mathrm{off}}$ is the dissociation rate in $\\mathrm{hr}^{-1}$, $k_{\\mathrm{clearC}}$ is the complex elimination rate in $\\mathrm{hr}^{-1}$, $p$ is the constant antibody production rate in $\\mathrm{a.u./hr}$, and $d$ is the antibody first-order elimination rate in $\\mathrm{hr}^{-1}$. Dosing is modeled as instantaneous bolus additions to $D$ at specified times. Initial conditions at time $t=0$ are $D(0)=0$, $A(0)=A_0$, $C(0)=0$, followed immediately by an initial bolus.\n\nA four-dose regimen is administered at times $t \\in \\{0,168,336,504\\}$ hours, each dose adding $\\Delta D$ a.u. instantaneously to $D$. The goal is to compute the trough free drug concentration $D(T)$ at $T=672$ hours (that is, $168$ hours after the last dose), in a.u., for different ADA scenarios. Use numerical integration of the ODEs between bolus times; at each bolus time, increment $D$ by $\\Delta D$ and continue integration.\n\nYour program must implement this model and produce the trough $D(T)$ for each parameter set in the test suite below. Express the final results in a.u. rounded to three decimal places. Angles do not appear, and there are no percentages.\n\nTest suite parameter sets are specified as ordered tuples:\n$(\\Delta D,\\; k_{\\mathrm{el}},\\; k_{\\mathrm{on}},\\; k_{\\mathrm{off}},\\; k_{\\mathrm{clearC}},\\; p,\\; d,\\; A_0)$\nwith all quantities as defined above. Use the following test suite:\n- Case $1$ (no ADA): $(20,\\; 0.03,\\; 0,\\; 0,\\; 0.02,\\; 0,\\; 0,\\; 0)$.\n- Case $2$ (moderate ADA): $(20,\\; 0.03,\\; 0.03,\\; 0.01,\\; 0.02,\\; 0.005,\\; 0.01,\\; 0)$.\n- Case $3$ (high-affinity, high-production ADA): $(20,\\; 0.03,\\; 0.10,\\; 0.005,\\; 0.05,\\; 0.02,\\; 0.02,\\; 0)$.\n- Case $4$ (slow complex clearance): $(20,\\; 0.03,\\; 0.03,\\; 0.02,\\; 0.005,\\; 0.005,\\; 0.01,\\; 0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[x_1,x_2,x_3,x_4]$), where $x_i$ are the trough values $D(672)$ for the four cases above, each rounded to three decimal places, in a.u.",
            "solution": "The user has provided a problem that requires the numerical solution of a system of ordinary differential equations (ODEs) to model the pharmacokinetics of a biologic drug in the presence of anti-drug antibodies (ADA).\n\n### Problem Validation\n\nFirst, the problem statement is validated against the mandatory criteria.\n\n**Step 1: Extract Givens**\n-   **State Variables**: Free drug concentration $D(t)$, free antibody concentration $A(t)$, and drug-antibody complex concentration $C(t)$. All are in arbitrary concentration units (a.u.).\n-   **System of ODEs**:\n    $$\n    \\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n    $$\n    $$\n    \\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n    $$\n    $$\n    \\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - k_{\\mathrm{off}}\\,C - k_{\\mathrm{clearC}}\\,C\n    $$\n-   **Parameters**: $k_{\\mathrm{el}}$ ($\\mathrm{hr}^{-1}$), $k_{\\mathrm{on}}$ ($\\mathrm{(a.u.)}^{-1}\\mathrm{hr}^{-1}$), $k_{\\mathrm{off}}$ ($\\mathrm{hr}^{-1}$), $k_{\\mathrm{clearC}}$ ($\\mathrm{hr}^{-1}$), $p$ ($\\mathrm{a.u./hr}$), $d$ ($\\mathrm{hr}^{-1}$).\n-   **Initial Conditions at $t=0$**: $D(0)=0$, $A(0)=A_0$, $C(0)=0$.\n-   **Dosing Regimen**: Instantaneous bolus dose $\\Delta D$ (a.u.) added to $D(t)$ at times $t \\in \\{0, 168, 336, 504\\}$ hours.\n-   **Objective**: Compute the trough free drug concentration $D(T)$ at $T=672$ hours.\n-   **Test Suite**: A list of four parameter sets $(\\Delta D,\\; k_{\\mathrm{el}},\\; k_{\\mathrm{on}},\\; k_{\\mathrm{off}},\\; k_{\\mathrm{clearC}},\\; p,\\; d,\\; A_0)$:\n    1.  $(20,\\; 0.03,\\; 0,\\; 0,\\; 0.02,\\; 0,\\; 0,\\; 0)$\n    2.  $(20,\\; 0.03,\\; 0.03,\\; 0.01,\\; 0.02,\\; 0.005,\\; 0.01,\\; 0)$\n    3.  $(20,\\; 0.03,\\; 0.10,\\; 0.005,\\; 0.05,\\; 0.02,\\; 0.02,\\; 0)$\n    4.  $(20,\\; 0.03,\\; 0.03,\\; 0.02,\\; 0.005,\\; 0.005,\\; 0.01,\\; 0)$\n\n**Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is based on the law of mass action and first-order decay, which are fundamental principles in chemical kinetics and pharmacology. The model is a standard representation of target-mediated drug disposition (TMDD), a well-established concept.\n-   **Well-Posed**: The problem specifies a system of ODEs with well-defined initial conditions and piecewise forcing events (doses). This constitutes a well-posed initial value problem for each interval between doses, guaranteeing a unique numerical solution.\n-   **Objective**: The problem is stated using precise mathematical terminology and is free of subjective or ambiguous language. The task is a purely computational one.\n-   **Completeness and Consistency**: The problem is self-contained. All necessary parameters, initial conditions, and the dosing schedule are provided. The units are internally consistent.\n-   **Plausibility**: The parameter values are within a realistic range for biological processes of this nature.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, mathematically well-posed, objective, and self-contained. It is therefore deemed **valid**. A solution will be provided.\n\n### Solution\n\nThe problem requires solving a system of three coupled, non-linear ordinary differential equations that describe the concentrations of a drug $D(t)$, an anti-drug antibody $A(t)$, and the drug-antibody complex $C(t)$. The system is subject to a multi-dose regimen, which introduces discontinuities in the drug concentration.\n\nThe governing equations are:\n$$\n\\frac{dD}{dt} = -k_{\\mathrm{el}}\\,D - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n$$\n$$\n\\frac{dA}{dt} = p - d\\,A - k_{\\mathrm{on}}\\,D\\,A + k_{\\mathrm{off}}\\,C\n$$\n$$\n\\frac{dC}{dt} = k_{\\mathrm{on}}\\,D\\,A - (k_{\\mathrm{off}} + k_{\\mathrm{clearC}})\\,C\n$$\nThe state of the system is described by the vector of concentrations $y(t) = [D(t), A(t), C(t)]^T$. The initial state at $t=0$ is $y(0) = [0, A_0, 0]^T$.\n\nThe dosing regimen consists of four bolus injections of amount $\\Delta D$ at times $t \\in \\{0, 168, 336, 504\\}$ hours. These injections are modeled as instantaneous increases in the drug concentration. This piecewise nature of the problem necessitates a segmented simulation. The total simulation time is from $t=0$ to $T=672$ hours, which is divided into four intervals:\n1.  $t \\in [0, 168]$\n2.  $t \\in [168, 336]$\n3.  $t \\in [336, 504]$\n4.  $t \\in [504, 672]$\n\nThe solution is found by following these steps for each parameter set:\n1.  Initialize the state vector at $t=0$ to $y_{current} = [0, A_0, 0]$.\n2.  Iterate through the four time intervals. Let the current interval be $[t_{start}, t_{end}]$.\n3.  At the beginning of each interval, $t_{start}$, apply the bolus dose by updating the drug concentration: $D(t_{start}) \\leftarrow D(t_{start}) + \\Delta D$. This is done for $t_{start} \\in \\{0, 168, 336, 504\\}$.\n4.  Solve the system of ODEs numerically over the interval $[t_{start}, t_{end}]$ using the state at $t_{start}$ (after a dose, if applicable) as the initial condition. For this, we employ a high-quality numerical integrator. The `scipy.integrate.solve_ivp` function is used, with the `Radau` method, which is an implicit Runge-Kutta method well-suited for potentially stiff systems often encountered in pharmacokinetics. To ensure accuracy, stringent absolute and relative error tolerances (e.g., $10^{-12}$ and $10^{-9}$, respectively) are used.\n5.  The state vector at the end of the interval, $y(t_{end})$, becomes the starting state for the subsequent interval.\n6.  This process is repeated until the final time $T=672$ hours is reached. The free drug concentration $D(672)$ is the desired trough value.\n7.  The final result for each case is rounded to three decimal places as specified.\n\nThis procedure is implemented for each of the four test cases, and the results are aggregated into a single formatted output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the pharmacokinetic model for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (no ADA)\n        # (delta_D, k_el, k_on, k_off, k_clearC, p, d, A0)\n        (20.0, 0.03, 0.0, 0.0, 0.02, 0.0, 0.0, 0.0),\n        # Case 2 (moderate ADA)\n        (20.0, 0.03, 0.03, 0.01, 0.02, 0.005, 0.01, 0.0),\n        # Case 3 (high-affinity, high-production ADA)\n        (20.0, 0.03, 0.10, 0.005, 0.05, 0.02, 0.02, 0.0),\n        # Case 4 (slow complex clearance)\n        (20.0, 0.03, 0.03, 0.02, 0.005, 0.005, 0.01, 0.0),\n    ]\n\n    def odes(t, y, k_el, k_on, k_off, k_clearC, p, d):\n        \"\"\"\n        Defines the system of ordinary differential equations for the TMDD model.\n        \n        Args:\n            t (float): Time.\n            y (np.ndarray): State vector [D, A, C].\n            k_el, k_on, ...: Model parameters.\n\n        Returns:\n            list: The derivatives [dD/dt, dA/dt, dC/dt].\n        \"\"\"\n        D, A, C = y\n        \n        # Rate of change for the free drug concentration D\n        dD_dt = -k_el * D - k_on * D * A + k_off * C\n        \n        # Rate of change for the free antibody concentration A\n        dA_dt = p - d * A - k_on * D * A + k_off * C\n        \n        # Rate of change for the drug-antibody complex concentration C\n        dC_dt = k_on * D * A - k_off * C - k_clearC * C\n        \n        return [dD_dt, dA_dt, dC_dt]\n\n    def solve_one_case(params):\n        \"\"\"\n        Solves the ODE system for a single set of parameters and dosing regimen.\n        \n        Args:\n            params (tuple): A tuple of model parameters.\n            \n        Returns:\n            float: The trough drug concentration D at T=672 hours.\n        \"\"\"\n        delta_D, k_el, k_on, k_off, k_clearC, p, d, A0 = params\n        \n        # Arguments for the ODE function\n        ode_args = (k_el, k_on, k_off, k_clearC, p, d)\n        \n        # Initial state at t=0\n        current_y = np.array([0.0, A0, 0.0])\n        \n        # Simulation time points and dose schedule\n        time_points = [0, 168, 336, 504, 672]\n        dose_times = {0, 168, 336, 504}\n        \n        for i in range(len(time_points) - 1):\n            t_start = time_points[i]\n            t_end = time_points[i+1]\n            \n            # Apply bolus dose at the start of the interval if it's a dose time\n            if t_start in dose_times:\n                current_y[0] += delta_D\n            \n            # Numerically integrate the ODEs over the interval\n            sol = solve_ivp(\n                fun=odes,\n                t_span=[t_start, t_end],\n                y0=current_y,\n                args=ode_args,\n                method='Radau',  # An implicit solver suitable for stiff problems\n                dense_output=False,\n                atol=1e-12,     # Strict tolerances for high accuracy\n                rtol=1e-9\n            )\n            \n            # Check if the integration was successful\n            if not sol.success:\n                raise RuntimeError(f\"ODE integration failed for params: {params}\")\n            \n            # Update state vector for the next interval\n            current_y = sol.y[:, -1]\n            \n        final_D = current_y[0]\n        return final_D\n\n    results = []\n    for case in test_cases:\n        result_D = solve_one_case(case)\n        results.append(result_D)\n    \n    # Format the results to three decimal places and print\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}