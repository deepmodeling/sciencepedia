{
    "hands_on_practices": [
        {
            "introduction": "To apply pharmacogenomics in practice, we must first translate a patient's genetic information into a clinically useful prediction of enzyme function. This exercise introduces the activity score system, a standardized method used to convert a complex genotype, including variations like gene duplications, into a single, quantitative measure of metabolic capacity . By working with the highly polymorphic enzyme CYP2D6, you will practice the essential skill of predicting a patient's metabolizer phenotype—a critical first step in personalizing drug therapy.",
            "id": "4952639",
            "problem": "Cytochrome P450 2D6 (CYP2D6) metabolizer phenotype can be inferred from a genotype by first computing an activity score that reflects allele function and gene copy number. Let each allele have a functional value $f \\in \\{0, 0.5, 1\\}$ corresponding to no function, decreased function, and normal function, respectively. For a genotype, the activity score is the sum of allele functional values across all gene copies; if an allele with functional value $f$ is duplicated to a total of $N$ copies, its contribution to the activity score is $N \\times f$. Consider the four genotypes $[0/0]$, $[0/0.5]$, $[0.5/1]$, and $[1/1 \\times N]$, where $N$ is an integer with $N \\geq 2$ indicating duplication of the normal-function allele and thus $N$ total copies of that allele on one chromosome.\n\nUse the following widely adopted phenotype mapping, consistent with Clinical Pharmacogenetics Implementation Consortium (CPIC) categorizations: activity score $= 0$ implies Poor Metabolizer (PM); activity score in the interval $(0, 1]$ implies Intermediate Metabolizer (IM); activity score in $[1.25, 2.25]$ implies Normal Metabolizer (NM); activity score $> 2.25$ implies Ultrarapid Metabolizer (UM).\n\n(a) For each of the four genotypes, compute the activity score from first principles by applying allele additivity and gene-dosage effects, and then assign the metabolizer phenotype category based on the stated mapping.\n\n(b) Define a normalized metabolic capacity for each genotype as the ratio of its activity score to the reference value $2$ (the value corresponding to two normal-function alleles without duplication). Treat the four genotypes as equally common and compute the arithmetic mean of these normalized capacities across the set $\\{[0/0],[0/0.5],[0.5/1],[1/1 \\times N]\\}$. Express your final answer as a closed-form function of $N$. No rounding is required, and no units should be included in your final answer.",
            "solution": "The goal is to compute activity scores based on the additive contribution of alleles and the effect of gene duplication, then map these scores to phenotype categories using the given thresholds, and finally compute an average normalized capacity.\n\nFoundational principles:\n1. Allele additivity: if a genotype carries alleles with functional values $f_{1}$ and $f_{2}$ (or more in the presence of duplications), the activity score is the sum of the functional values across all copies.\n2. Gene dosage: if an allele with functional value $f$ is duplicated to $N$ copies, its contribution becomes $N \\times f$.\n3. Normalization to a reference: the reference normal activity is $2$ (two alleles, each with functional value $1$), so a normalized capacity is defined as activity score divided by $2$.\n\nPart (a): Compute activity scores and assign phenotypes.\n\n- Genotype $[0/0]$:\n  The two alleles have functional values $0$ and $0$. The activity score is\n  $$ 0 + 0 = 0. $$\n  Using the mapping, activity score $= 0$ corresponds to Poor Metabolizer (PM).\n\n- Genotype $[0/0.5]$:\n  The two alleles have functional values $0$ and $0.5$. The activity score is\n  $$ 0 + 0.5 = 0.5. $$\n  Since $0 < 0.5 \\leq 1$, this corresponds to Intermediate Metabolizer (IM).\n\n- Genotype $[0.5/1]$:\n  The two alleles have functional values $0.5$ and $1$. The activity score is\n  $$ 0.5 + 1 = 1.5. $$\n  Since $1.25 \\leq 1.5 \\leq 2.25$, this corresponds to Normal Metabolizer (NM).\n\n- Genotype $[1/1 \\times N]$:\n  One allele has functional value $1$, and the other normal-function allele is duplicated to $N$ total copies, each with functional value $1$. The activity score is\n  $$ 1 + N \\times 1 = N + 1. $$\n  With $N \\geq 2$, we have $N + 1 \\geq 3$, and thus $N + 1 > 2.25$, which corresponds to Ultrarapid Metabolizer (UM) for all $N \\geq 2$ under the stated mapping.\n\nPart (b): Compute normalized capacities and their mean.\n\nDefine normalized capacity for a genotype as\n$$ \\text{Normalized capacity} = \\frac{\\text{Activity score}}{2}. $$\nCompute for each genotype:\n\n- $[0/0]$: activity score $= 0$, so normalized capacity $= \\frac{0}{2} = 0$.\n- $[0/0.5]$: activity score $= 0.5$, so normalized capacity $= \\frac{0.5}{2} = 0.25$.\n- $[0.5/1]$: activity score $= 1.5$, so normalized capacity $= \\frac{1.5}{2} = 0.75$.\n- $[1/1 \\times N]$: activity score $= N + 1$, so normalized capacity $= \\frac{N + 1}{2}$.\n\nTreating the four genotypes as equally common, the arithmetic mean of the normalized capacities is\n$$ \\frac{1}{4} \\left( 0 + 0.25 + 0.75 + \\frac{N + 1}{2} \\right) = \\frac{1}{4} \\left( 1.0 + \\frac{N + 1}{2} \\right). $$\nCombine terms:\n$$ 1.0 = \\frac{2}{2}, \\quad \\frac{2}{2} + \\frac{N + 1}{2} = \\frac{N + 3}{2}. $$\nThus,\n$$ \\text{Mean normalized capacity} = \\frac{1}{4} \\cdot \\frac{N + 3}{2} = \\frac{N + 3}{8}. $$\n\nThis is a closed-form function of $N$, requires no rounding, and is dimensionless.",
            "answer": "$$\\boxed{\\frac{N+3}{8}}$$"
        },
        {
            "introduction": "Once a patient's metabolizer status is known, the next step is to determine how it impacts drug disposition and adjust dosing accordingly. This problem uses the classic example of warfarin and its metabolizing enzyme, CYP2C9, to bridge the gap between a genetic variant and a clinical decision . By applying fundamental pharmacokinetic principles of steady-state clearance, you will calculate the necessary dose adjustment for a patient with reduced enzyme function, a core skill in quantitative personalized medicine.",
            "id": "4952610",
            "problem": "Warfarin’s anticoagulant effect is monitored by the International Normalized Ratio (INR). Within a narrow therapeutic window, assume a linear pharmacodynamic relationship between dose and INR such that maintaining a target INR requires maintaining a target average steady-state plasma concentration. Consider the S-enantiomer of warfarin, primarily metabolized by cytochrome P450 2C9 (CYP2C9). The CYP2C9*3 allele is known to reduce enzymatic activity relative to the wild-type CYP2C9*1 allele.\n\nStarting from steady-state mass balance for maintenance dosing in linear pharmacokinetics, use the fact that the average steady-state concentration is determined by the dosing rate, oral bioavailability, and clearance. Assume the oral bioavailability is identical between genotypes, with $F = 0.95$ for both. Suppose the systemic clearance is $CL_{\\text{wt}} = 0.25\\,\\mathrm{L\\,h^{-1}}$ in a CYP2C9*1/*1 individual and $CL_{\\text{var}} = 0.05\\,\\mathrm{L\\,h^{-1}}$ in a CYP2C9*3/*3 individual.\n\nUnder these assumptions, compute the initial maintenance dose reduction fraction (expressed as a unitless decimal) for warfarin in the CYP2C9*3/*3 individual relative to the CYP2C9*1/*1 individual, based on maintaining the same target average steady-state concentration corresponding to the same INR in the linear range. Express your final answer as a decimal fraction rounded to four significant figures.",
            "solution": "The solution starts from the steady-state mass balance for maintenance dosing, where the rate of drug administration into the systemic circulation equals the rate of drug elimination.\n\nThe rate of drug administration is $F \\cdot R$, where $F$ is oral bioavailability and $R$ is the dosing rate (Dose/interval). The rate of drug elimination is $CL \\cdot \\bar{C}_{ss}$, where $CL$ is systemic clearance and $\\bar{C}_{ss}$ is the average steady-state plasma concentration.\n\nAt steady state:\n$$F \\cdot R = CL \\cdot \\bar{C}_{ss}$$\nThis can be rearranged to:\n$$\\bar{C}_{ss} = \\frac{F \\cdot R}{CL}$$\nWe apply this relationship to both the wild-type (wt) and the variant (var) individuals. For the wild-type individual:\n$$\\bar{C}_{ss, \\text{wt}} = \\frac{F_{\\text{wt}} \\cdot R_{\\text{wt}}}{CL_{\\text{wt}}}$$\nFor the variant individual:\n$$\\bar{C}_{ss, \\text{var}} = \\frac{F_{\\text{var}} \\cdot R_{\\text{var}}}{CL_{\\text{var}}}$$\nThe problem requires maintaining the same target concentration, so $\\bar{C}_{ss, \\text{wt}} = \\bar{C}_{ss, \\text{var}}$. Given that bioavailability is also identical ($F_{\\text{wt}} = F_{\\text{var}}$), the $F$ terms cancel out:\n$$\\frac{R_{\\text{wt}}}{CL_{\\text{wt}}} = \\frac{R_{\\text{var}}}{CL_{\\text{var}}}$$\nThis shows that the dosing rate must be adjusted in direct proportion to clearance. The required dosing rate for the variant is:\n$$R_{\\text{var}} = R_{\\text{wt}} \\cdot \\frac{CL_{\\text{var}}}{CL_{\\text{wt}}}$$\nThe dose reduction fraction, $\\delta$, is the difference between the wild-type and variant doses (or dosing rates), as a fraction of the wild-type dose:\n$$\\delta = \\frac{R_{\\text{wt}} - R_{\\text{var}}}{R_{\\text{wt}}} = 1 - \\frac{R_{\\text{var}}}{R_{\\text{wt}}}$$\nSubstituting the clearance ratio:\n$$\\delta = 1 - \\frac{CL_{\\text{var}}}{CL_{\\text{wt}}}$$\nNow, we substitute the given numerical values: $CL_{\\text{wt}} = 0.25\\,\\mathrm{L\\,h^{-1}}$ and $CL_{\\text{var}} = 0.05\\,\\mathrm{L\\,h^{-1}}$.\n$$\\delta = 1 - \\frac{0.05\\,\\mathrm{L\\,h^{-1}}}{0.25\\,\\mathrm{L\\,h^{-1}}} = 1 - 0.2 = 0.8$$\nThe result, expressed as a decimal fraction to four significant figures, is $0.8000$. The provided bioavailability ($F=0.95$) is not needed for the final calculation as it cancels.",
            "answer": "$$\\boxed{0.8000}$$"
        },
        {
            "introduction": "While steady-state calculations provide a target dose, they do not capture the dynamic time-course of a drug's effect, which is crucial for medications with a narrow therapeutic window like warfarin. This exercise moves beyond static calculations to a dynamic simulation, modeling drug concentration and response over time using fundamental principles of pharmacokinetics (PK) and pharmacodynamics (PD) . By integrating genetic influences on both clearance (PK) and drug sensitivity (PD), you will explore how different patient profiles affect the time required to reach a therapeutic goal, representing the forefront of predictive pharmacology.",
            "id": "4952655",
            "problem": "You are tasked with building a program that simulates the time to therapeutic International Normalized Ratio (INR) for patients starting warfarin therapy under different genotypes that alter the pharmacokinetics and pharmacodynamics of the active enantiomer S-warfarin. The simulation must be formulated from first principles using mass balance and delayed pharmacodynamic response and must compute, for each test case, the first time the model-predicted INR reaches a therapeutic threshold.\n\nStart from these fundamental bases and definitions that are widely accepted in pharmacology:\n\n- One-compartment absorption and elimination model with first-order processes derived from mass conservation. Let $A_g(t)$ denote the amount of S-warfarin in the gastrointestinal compartment and $A_c(t)$ the amount in the central (plasma) compartment. With first-order absorption rate constant $k_a$ and elimination rate constant $k_{el}$, and with discrete daily oral dosing, the dynamics between dosing instants follow\n$$\n\\frac{dA_g}{dt} = -k_a\\,A_g,\\quad\n\\frac{dA_c}{dt} = k_a\\,A_g - k_{el}\\,A_c.\n$$\nThe plasma concentration is $C(t) = \\frac{A_c(t)}{V_d}$, where $V_d$ is the apparent volume of distribution. The elimination rate constant relates to clearance $CL$ by $k_{el} = \\frac{CL}{V_d}$.\n\n- Delayed pharmacodynamic effect modeled via an effect-site compartment that exponentially relaxes to the plasma concentration, representing clotting factor turnover. The effect-site concentration $C_e(t)$ satisfies\n$$\n\\frac{dC_e}{dt} = k_d\\left(C(t) - C_e(t)\\right),\n$$\nwhich is equivalent to a convolution\n$$C_e(t) = \\int_0^t C(s)\\,k_d\\,e^{-k_d(t-s)}\\,ds,$$\ni.e., a delayed function of cumulative exposure.\n\n- Pharmacodynamic Emax model for INR increase above baseline,\n$$\n\\mathrm{INR}(t) = \\mathrm{INR}_0 + \\frac{E_{\\max}\\,C_e(t)}{EC_{50} + C_e(t)},\n$$\nwhere $\\mathrm{INR}_0$ is the baseline International Normalized Ratio, $E_{\\max}$ is the maximum possible INR increase due to S-warfarin, and $EC_{50}$ is the effect-site concentration that produces half of $E_{\\max}$.\n\nGenetic polymorphisms modulate parameters as follows:\n\n- Cytochrome P450 family 2 subfamily C member 9 (CYP2C9) genotype modifies S-warfarin clearance $CL$ via multiplicative factors $m_{CL}$:\n  - $*1/*1$: $m_{CL} = 1.0$,\n  - $*1/*3$: $m_{CL} = 0.7$,\n  - $*3/*3$: $m_{CL} = 0.4$.\n  The effective clearance is $CL = m_{CL}\\cdot CL_{\\text{base}}$.\n\n- Vitamin K epoxide reductase complex subunit 1 (VKORC1) genotype modifies $EC_{50}$ via multiplicative factors $m_{EC50}$:\n  - $G/G$: $m_{EC50} = 1.0$,\n  - $G/A$: $m_{EC50} = 0.8$,\n  - $A/A$: $m_{EC50} = 0.6$.\n  The effective $EC_{50}$ is $EC_{50} = m_{EC50}\\cdot EC_{50,\\text{base}}$.\n\nAssume the following scientifically plausible constants, using the specified units:\n\n- Oral bioavailability $F = 1.0$ (unitless),\n- S-warfarin fraction of racemate $f_S = 0.5$ (unitless),\n- Baseline INR $\\mathrm{INR}_0 = 1.0$ (unitless),\n- Apparent volume of distribution $V_d = 10\\ \\mathrm{L}$,\n- First-order absorption rate $k_a = 1.0\\ \\mathrm{h}^{-1}$,\n- Baseline clearance $CL_{\\text{base}} = 0.2\\ \\mathrm{L/h}$,\n- Effect-site rate constant $k_d = 0.03\\ \\mathrm{h}^{-1}$,\n- Maximum INR increment $E_{\\max} = 3.0$ (unitless),\n- Baseline $EC_{50,\\text{base}} = 0.6\\ \\mathrm{mg/L}$,\n- Daily dosing interval $\\tau = 24\\ \\mathrm{h}$.\n\nDosing is a once-daily oral bolus at times $t = 0, \\tau, 2\\tau, \\dots$ of racemic warfarin with dose $D$ in $\\mathrm{mg/day}$; only S-warfarin contributes, so each bolus adds $F\\cdot f_S \\cdot D$ (in $\\mathrm{mg}$) to the gastrointestinal compartment $A_g$ at the dosing instants. Between doses, the system follows the differential equations given above. All amounts are in $\\mathrm{mg}$, concentrations in $\\mathrm{mg/L}$, time in $\\mathrm{h}$.\n\nFor each case, define the therapeutic threshold as the first time $t$ at which $\\mathrm{INR}(t) \\ge 2.0$. If $\\mathrm{INR}(t)$ never reaches $2.0$ within a total simulation horizon of $21$ days (i.e., $504$ hours), report a sentinel value of $-1$. Express each case’s result as time in days, rounded to two decimal places.\n\nConstruct a program that, for the following test suite, simulates the trajectories and returns the times to therapeutic INR as specified above:\n\n- Case $1$ (happy path): $D = 5$ $\\mathrm{mg/day}$, CYP2C9 $*1/*1$, VKORC1 $G/G$.\n- Case $2$: $D = 5$ $\\mathrm{mg/day}$, CYP2C9 $*1/*3$, VKORC1 $G/A$.\n- Case $3$ (edge: likely non-attainment): $D = 2$ $\\mathrm{mg/day}$, CYP2C9 $*1/*1$, VKORC1 $G/G$.\n- Case $4$ (edge: rapid attainment): $D = 7$ $\\mathrm{mg/day}$, CYP2C9 $*3/*3$, VKORC1 $A/A$.\n- Case $5$: $D = 4$ $\\mathrm{mg/day}$, CYP2C9 $*1/*3$, VKORC1 $G/G$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[t_1,t_2,t_3,t_4,t_5]$), where each $t_i$ is the time to therapeutic INR in days rounded to two decimal places (use decimal numbers, not percentages). For any case where the threshold is not reached within $21$ days, use $-1$ in place of the time. No other output is permitted.",
            "solution": "The solution requires simulating a pharmacokinetic/pharmacodynamic (PK/PD) model for S-warfarin. The model is described by a system of coupled first-order ordinary differential equations (ODEs), a standard approach for modeling drug concentration and effect over time.\n\n1.  **System of ODEs**: The model's core is a system of three linear ODEs for the amount of drug in the gastrointestinal tract ($A_g(t)$), the central plasma compartment ($A_c(t)$), and the effect-site concentration ($C_e(t)$):\n    $$\n    \\frac{dA_g}{dt} = -k_a\\,A_g \\\\\n    \\frac{dA_c}{dt} = k_a\\,A_g - k_{el}\\,A_c \\\\\n    \\frac{dC_e}{dt} = k_d\\left(\\frac{A_c}{V_d} - C_e\\right)\n    $$\n    These equations represent mass balance. The final INR is a nonlinear function of $C_e(t)$.\n\n2.  **Hybrid System**: Daily oral dosing introduces discrete events (discontinuities) into the continuous system. At each dosing time, the amount of drug in the gastrointestinal compartment, $A_g$, is instantaneously increased by the effective dose. This creates a hybrid dynamic system.\n\n3.  **Numerical Solution**: A numerical ODE solver is the most robust approach. The simulation is performed interval-by-interval between doses to correctly handle the discontinuities. The Python library `scipy.integrate.solve_ivp` is used for this purpose.\n\n4.  **Event Detection**: The primary goal is to find the first time $t$ when $\\mathrm{INR}(t) \\ge 2.0$. The `solve_ivp` function's built-in event detection is used. An event function calculates `INR(t) - 2.0`, and the solver finds the root (when the function is zero). The integration is set to terminate when the event is found, providing a precise time.\n\n5.  **Implementation**: For each test case, patient-specific parameters ($CL$ and $EC_{50}$) are calculated from the genotype multipliers. The simulation is then run. If the INR threshold is reached, the time is converted to days and rounded. If the simulation completes the 21-day horizon without reaching the threshold, the sentinel value of $-1$ is reported.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the warfarin PK/PD simulation for all test cases.\n    \"\"\"\n    # Define constants based on the problem statement\n    F = 1.0           # Oral bioavailability (unitless)\n    FS = 0.5          # S-warfarin fraction of racemate (unitless)\n    INR0 = 1.0        # Baseline INR (unitless)\n    VD = 10.0         # Apparent volume of distribution (L)\n    KA = 1.0          # First-order absorption rate (h^-1)\n    CL_BASE = 0.2     # Baseline clearance (L/h)\n    KD = 0.03         # Effect-site rate constant (h^-1)\n    EMAX = 3.0        # Maximum INR increment (unitless)\n    EC50_BASE = 0.6   # Baseline EC50 (mg/L)\n    TAU = 24.0        # Daily dosing interval (h)\n    T_HORIZON = 21 * TAU # Simulation horizon (h)\n\n    # Genotype-specific multiplicative factors\n    M_CL_MAP = {'*1/*1': 1.0, '*1/*3': 0.7, '*3/*3': 0.4}\n    M_EC50_MAP = {'G/G': 1.0, 'G/A': 0.8, 'A/A': 0.6}\n\n    def pkpd_model(t, y, k_a, k_el, k_d, v_d, ec50, inr0, emax):\n        \"\"\"\n        System of ODEs for the PK/PD model.\n        y[0]: Ag (amount in GI tract)\n        y[1]: Ac (amount in central compartment)\n        y[2]: Ce (concentration in effect compartment)\n        Additional arguments are passed via solve_ivp's `args` parameter, \n        but only the first four are used here.\n        \"\"\"\n        Ag, Ac, Ce = y\n        C = Ac / v_d\n        \n        dAg_dt = -k_a * Ag\n        dAc_dt = k_a * Ag - k_el * Ac\n        dCe_dt = k_d * (C - Ce)\n        \n        return [dAg_dt, dAc_dt, dCe_dt]\n\n    def inr_threshold_event(t, y, k_a, k_el, k_d, v_d, ec50, inr0, emax):\n        \"\"\"\n        Event function to detect when INR reaches the therapeutic threshold of 2.0.\n        All arguments are passed via solve_ivp's `args`.\n        \"\"\"\n        _, _, Ce = y\n        inr = inr0 + (emax * Ce) / (ec50 + Ce)\n        return inr - 2.0\n\n    # Configure the event to be terminal and to trigger on an increasing INR\n    inr_threshold_event.terminal = True\n    inr_threshold_event.direction = 1\n\n    def solve_for_case(D, cyp2c9, vkorc1):\n        \"\"\"\n        Simulates a single patient case to find the time to therapeutic INR.\n        \"\"\"\n        # Calculate patient-specific parameters\n        m_cl = M_CL_MAP[cyp2c9]\n        m_ec50 = M_EC50_MAP[vkorc1]\n        \n        cl = m_cl * CL_BASE\n        k_el = cl / VD\n        ec50 = m_ec50 * EC50_BASE\n        d_eff = F * FS * D\n        \n        # Initial state: no drug in any compartment\n        y_current = np.array([0.0, 0.0, 0.0])\n        \n        # Pack all parameters for the ODE solver and event function\n        all_args = (KA, k_el, KD, VD, ec50, INR0, EMAX)\n\n        num_days = int(T_HORIZON / TAU)\n        for day in range(num_days):\n            # Apply the daily dose at the beginning of the interval\n            y_initial = y_current.copy()\n            y_initial[0] += d_eff\n            \n            t_start = day * TAU\n            t_end = (day + 1) * TAU\n            \n            # Solve the ODEs for the current dosing interval\n            sol = solve_ivp(\n                fun=pkpd_model,\n                t_span=[t_start, t_end],\n                y0=y_initial,\n                args=all_args,\n                events=inr_threshold_event,\n                method='RK45',\n                dense_output=True # Needed for accurate event location\n            )\n            \n            # Check if the therapeutic threshold event was triggered\n            if sol.t_events[0].size > 0:\n                t_event_hours = sol.t_events[0][0]\n                t_event_days = t_event_hours / TAU\n                return round(t_event_days, 2)\n            \n            # Update the state for the start of the next interval\n            y_current = sol.y[:, -1]\n\n        # If the loop completes, the threshold was not reached\n        return -1\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        (5, '*1/*1', 'G/G'),\n        (5, '*1/*3', 'G/A'),\n        (2, '*1/*1', 'G/G'),\n        (7, '*3/*3', 'A/A'),\n        (4, '*1/*3', 'G/G'),\n    ]\n\n    results = []\n    for case in test_cases:\n        D, cyp2c9, vkorc1 = case\n        time_to_inr = solve_for_case(D, cyp2c9, vkorc1)\n        results.append(time_to_inr)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}