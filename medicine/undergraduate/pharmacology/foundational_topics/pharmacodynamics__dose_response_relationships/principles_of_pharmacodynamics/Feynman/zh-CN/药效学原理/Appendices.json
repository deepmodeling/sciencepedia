{
    "hands_on_practices": [
        {
            "introduction": "量化药物浓度与其效应之间的关系是药理学中的一项基本任务。S型（Sigmoidal）的希尔方程（Hill equation）是描述此关系的标准数学模型，它能够捕捉最大效应（$E_{\\max}$）、效能（$EC_{50}$）和曲线陡度（希尔系数 $n$）。这项练习将提供使用实际数据分析技术提取这些关键药效学参数的实践经验，这些参数是比较药物和理解其作用的基础。",
            "id": "4584147",
            "problem": "您的任务是使用适合临床药理学和药效学（PD）的原理，根据效应与浓度的测量数据估算关键的药效学参数。该场景根植于受体理论和质量作用定律，即药物效应源于与有限靶标群体的结合，当可用靶标被完全占据时效应达到饱和，浓度-效应关系的陡峭程度反映了结合或信号传导中的协同相互作用。从这些基本思想出发，构建一个非线性最小二乘估计器，用于估算表征可饱和、单调、S型浓度-效应关系的三个参数：最大效应 $E_{\\max}$、半最大效应浓度 $EC_{50}$，以及通常称为希尔系数的斜率参数 $n$。$E_{\\max}$ 和 $EC_{50}$ 的量必须是严格正值，并具有物理单位，$E_{\\max}$ 的单位是任意效应单位（a.u.），$EC_{50}$ 的单位是 $\\mathrm{mg}/\\mathrm{L}$，希尔系数 $n$ 必须是严格正值的无量纲数。以下数据提供了测量的药物浓度（单位：$\\mathrm{mg}/\\mathrm{L}$）和观察到的效应（单位：a.u.），您的程序必须拟合一个源自质量作用定律以及效应与分数占据率之间比例关系的三参数受体占据一致模型，不得假定对测量值进行任何线性化或变换。\n\n您的估计器必须：\n1. 最小化在每个给定浓度下，观察效应与模型预测效应之间的残差平方和。\n2. 在优化过程中强制执行约束条件 $E_{\\max} \\gt 0$、$EC_{50} \\gt 0$ 和 $n \\gt 0$。\n3. 仅根据数据提供稳健的初始猜测值，不使用任何基准实况参数。\n4. 返回拟合参数 $E_{\\max}$（单位：a.u.）、$EC_{50}$（单位：$\\mathrm{mg}/\\mathrm{L}$）和 $n$（无量纲），每个参数四舍五入到3位小数。\n\n此外，使用以下分类规则（容差 $\\tau = 0.05$）对希尔系数 $n$ 关于协同行为的解释进行量化编码：如果 $n \\lt 1 - \\tau$（负协同性），输出 $-1$；如果 $|n - 1| \\le \\tau$（非协同性），输出 $0$；如果 $n \\gt 1 + \\tau$（正协同性），输出 $+1$。分类代码必须是整数。\n\n使用以下包含四个独立数据集的测试套件。对于每个数据集，浓度单位为 $\\mathrm{mg}/\\mathrm{L}$，效应单位为 a.u.。请分别为每个数据集提供估算值。\n\n数据集A（宽范围，中等斜率）：\n- 浓度：$\\{0.25, 0.5, 1, 2, 4, 8, 16\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070\\}$ a.u.\n\n数据集B（边界接近非协同性）：\n- 浓度：$\\{0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455\\}$ a.u.\n\n数据集C（高协同性，陡峭过渡）：\n- 浓度：$\\{0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992\\}$ a.u.\n\n数据集D（观测范围内饱和度差）：\n- 浓度：$\\{1.00, 2.00, 5.00, 10.00, 20.00, 50.00\\}$ $\\mathrm{mg}/\\mathrm{L}$\n- 效应：$\\{0.891, 1.765, 4.286, 8.182, 15.000, 30.000\\}$ a.u.\n\n角度单位不适用。最终输出必须严格使用上述指定单位表示。\n\n您的程序必须生成单行输出，其中包含一个嵌套的逗号分隔四元组列表形式的结果，每个数据集对应一个四元组，格式为 $[E_{\\max}, EC_{50}, n, \\text{coop\\_code}]$。整个输出必须用方括号括起来，并且每个浮点值都必须四舍五入到3位小数。例如，两个数据集的输出将如下所示：$[[e_{1},c_{1},n_{1},k_{1}],[e_{2},c_{2},n_{2},k_{2}]]$，其中 $e_{i}$、$c_{i}$ 和 $n_{i}$ 是浮点数，$k_{i}$ 是整数。\n\n您的程序必须确定性地运行，并且不得读取任何外部输入。",
            "solution": "该问题旨在根据测量的浓度-效应关系估算药物的药效学参数。问题陈述在科学上是合理的、适定的且内部一致的。它准确地描述了临床药理学中的一项标准任务，即对S型剂量-反应曲线进行参数化。\n\n其基本原理是应用于药物-受体结合的质量作用定律。药物浓度 $C$ 与产生的生理效应 $E$ 之间的关系由希尔-朗缪尔方程描述。该模型假设效应与被药物占据的受体分数成正比。对于一个涉及 $n$ 个结合位点的系统，效应 $E$ 作为浓度 $C$ 的函数由下式给出：\n$$\nE(C) = \\frac{E_{\\max} \\cdot C^n}{EC_{50}^n + C^n}\n$$\n需要确定的三个参数是：\n1.  $E_{\\max}$：最大效应，表示在饱和药物浓度下的效应。它必须是正值（$E_{\\max} > 0$），单位为效应单位（a.u.）。\n2.  $EC_{50}$：半最大效应浓度，即产生 $50\\%$ 最大效应的药物浓度。它必须是正值（$EC_{50} > 0$），单位为浓度（$\\mathrm{mg}/\\mathrm{L}$）。\n3.  $n$：希尔系数，一个无量纲参数，描述曲线的陡峭程度并反映药物-受体相互作用的协同性。它必须是正值（$n > 0$）。\n\n这些参数的估计（统称为向量 $\\theta = [E_{\\max}, EC_{50}, n]$）是使用非线性最小二乘法进行的。这涉及找到使每个对应浓度 $C_i$ 下的观测效应数据 $E_{\\text{obs},i}$ 与模型预测效应 $E(C_i, \\theta)$ 之间的残差平方和（SSR）最小化的参数值。要最小化的目标函数是：\n$$\n\\text{SSR}(\\theta) = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - E(C_i, \\theta)\\right]^2 = \\sum_{i=1}^{N} \\left[E_{\\text{obs},i} - \\frac{E_{\\max} \\cdot C_i^n}{EC_{50}^n + C_i^n}\\right]^2\n$$\n这个优化问题通过数值方法求解。实现了Levenberg-Marquardt算法的 `scipy.optimize.curve_fit` 函数是完成此项任务的合适且稳健的工具。\n\n非线性优化的一个关键方面是为参数提供良好的初始猜测值。根据希尔方程的性质，我们可以直接从数据中推导出这些猜测值：\n-   **$E_{\\max}$ 的初始猜测值（$E_{\\max,0}$）**：一个合理的起点是数据集中的最大观测效应，$E_{\\max,0} = \\max(E_{\\text{obs}})$。这是一个稳健的选择，尽管如果数据未显示完全饱和，它可能会被低估。\n-   **$EC_{50}$ 的初始猜测值（$EC_{50,0}$）**：根据定义，$EC_{50}$ 是效应达到半最大值时的浓度。因此，一个合乎逻辑的猜测是数据集中对应观测效应 $E_{\\text{obs},i}$ 最接近 $E_{\\max,0} / 2$ 的浓度 $C_i$。\n-   **$n$ 的初始猜测值（$n_0$）**：希尔系数的一个中性和常见的起始值是 $n_0 = 1$，这对应于非协同性的 Michaelis-Menten 模型。\n\n问题要求物理约束条件 $E_{\\max} > 0$、$EC_{50} > 0$ 和 $n > 0$。通过向 `curve_fit` 函数提供所有三个参数的下界为 $0$ 来强制执行这些约束。\n\n最后，根据结合协同性来解释拟合的希尔系数 $n$。使用指定的容差 $\\tau = 0.05$，分类如下：\n-   负协同性（代码 $-1$）：$n < 1 - \\tau = 0.95$。\n-   非协同性（代码 $0$）：$|n - 1| \\le \\tau$，即 $0.95 \\le n \\le 1.05$。\n-   正协同性（代码 $+1$）：$n > 1 + \\tau = 1.05$。\n\n该过程独立应用于四个提供的数据集中的每一个。对于每个数据集，算法将：\n1. 定义浓度和效应数据数组。\n2. 计算初始参数猜测值（$p_0 = [E_{\\max,0}, EC_{50,0}, n_0]$）。\n3. 使用 `curve_fit` 进行约束非线性最小二乘拟合，以找到最优参数。\n4. 对得出的希尔系数 $n$进行分类，以确定协同性代码。\n5. 将最终参数（$E_{\\max}$、$EC_{50}$、$n$）四舍五入到3位小数，连同整数协同性代码，格式化为指定的输出结构。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Fits a three-parameter Hill equation to pharmacodynamic data and classifies cooperativity.\n    \"\"\"\n    \n    # Define the Hill equation model for the concentration-effect relationship.\n    # The parameters are E_max, EC50, and n (Hill coefficient).\n    # Using np.asarray ensures inputs are arrays and handles C_safe**n correctly for scalars.\n    def hill_equation(C, E_max, EC50, n):\n        C_safe = np.asarray(C, dtype=float)\n        # To prevent 0**n issues for n0 (though n is constrained >0),\n        # we add a small epsilon. Since concentrations are positive, this has no effect.\n        # This also guards against potential warnings or DomainErrors in some math libraries.\n        numerator = E_max * (C_safe**n)\n        denominator = EC50**n + C_safe**n\n        # Avoid division by zero, although denominator is always > 0 \n        # due to the bounds EC50 > 0.\n        return np.divide(numerator, denominator, out=np.zeros_like(numerator), where=denominator!=0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"C\": np.array([0.25, 0.5, 1, 2, 4, 8, 16]),\n            \"E\": np.array([3.828, 9.520, 21.710, 42.270, 65.880, 83.580, 93.070])\n        },\n        {\n            \"C\": np.array([0.05, 0.10, 0.20, 0.50, 1.00, 2.00, 5.00]),\n            \"E\": np.array([4.545, 8.333, 14.286, 25.000, 33.333, 40.000, 45.455])\n        },\n        {\n            \"C\": np.array([0.10, 0.20, 0.50, 1.00, 2.00, 3.00, 5.00, 10.00]),\n            \"E\": np.array([0.008, 0.128, 4.706, 40.000, 75.294, 79.024, 79.872, 79.992])\n        },\n        {\n            \"C\": np.array([1.00, 2.00, 5.00, 10.00, 20.00, 50.00]),\n            \"E\": np.array([0.891, 1.765, 4.286, 8.182, 15.000, 30.000])\n        }\n    ]\n\n    all_results = []\n    \n    # Process each dataset\n    for case in test_cases:\n        C_data = case[\"C\"]\n        E_data = case[\"E\"]\n\n        # 1. Generate robust initial guesses from the data.\n        #    - E_max_0: Maximum observed effect.\n        #    - EC50_0: Concentration where effect is closest to half of E_max_0.\n        #    - n_0: Neutral guess of 1.0 (non-cooperative).\n        E_max_0 = np.max(E_data)\n        if E_max_0 == 0: E_max_0 = 1.0 # Fallback for pathological data\n        \n        half_max_effect = E_max_0 / 2.0\n        # Find index of the effect value closest to half_max_effect\n        idx = np.argmin(np.abs(E_data - half_max_effect))\n        EC50_0 = C_data[idx]\n        if EC50_0 == 0: EC50_0 = np.mean(C_data) # Fallback\n\n        n_0 = 1.0\n        \n        p0 = [E_max_0, EC50_0, n_0]\n\n        # 2. Define the bounds for the parameters (Emax > 0, EC50 > 0, n > 0).\n        bounds = ([0, 0, 0], [np.inf, np.inf, np.inf])\n\n        # 3. Perform nonlinear least-squares fitting.\n        try:\n            popt, _ = curve_fit(hill_equation, C_data, E_data, p0=p0, bounds=bounds, maxfev=10000)\n            E_max_fit, EC50_fit, n_fit = popt\n        except RuntimeError:\n            # In case the fit fails, though it shouldn't for these datasets.\n            E_max_fit, EC50_fit, n_fit = np.nan, np.nan, np.nan\n\n        # 4. Classify the Hill coefficient for cooperativity.\n        tau = 0.05\n        if n_fit  1 - tau:\n            coop_code = -1\n        elif n_fit  1 + tau:\n            coop_code = 1\n        else:\n            coop_code = 0\n            \n        # 5. Store the formatted result quadruple.\n        # The formatting to 3 decimal places happens during string creation.\n        result_quad = [E_max_fit, EC50_fit, n_fit, coop_code]\n        all_results.append(result_quad)\n\n    # 6. Format the final output string as specified.\n    # Each sublist is formatted as a string with no spaces, e.g., '[1.234,5.678,9.012,1]'\n    # Then these strings are joined by commas and enclosed in outer brackets.\n    list_of_quad_strings = []\n    for quad in all_results:\n        # Format floats to 3 decimal places exactly for the output.\n        quad_str = f\"[{quad[0]:.3f},{quad[1]:.3f},{quad[2]:.3f},{quad[3]}]\"\n        list_of_quad_strings.append(quad_str)\n    \n    final_output_string = f\"[{','.join(list_of_quad_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n\n```"
        },
        {
            "introduction": "在临床实践中，患者常常同时服用多种药物，这使得药物相互作用成为一个至关重要的研究领域。当拮抗剂与激动剂竞争同一受体时，就会发生一种常见的相互作用。这项练习将探讨竞争性拮抗作用，即拮抗剂的存在会使激动剂的表观效能降低，但不改变其最大效应，这种剂量-效应曲线的平行右移可以通过Gaddum-Schild方程进行精确描述。通过完成这项计算，您将对如何预测竞争性拮抗剂的影响获得定量的理解，这是药物开发和治疗中的一个基石性原理。",
            "id": "4982958",
            "problem": "一种可逆性竞争性拮抗剂与一种完全激动剂结合到相同的受体位点。假设以下基本前提：受体结合遵循质量作用定律；拮抗剂的解离常数定义为 $K_{B} = \\frac{[R][B]}{[RB]}$；激动剂的解离常数定义为 $K_{A} = \\frac{[R][A]}{[RA]}$；总受体浓度为 $R_{T} = [R] + [RA] + [RB]$；并且药理效应与被激动剂占据的受体分数成正比，因此对于完全激动剂有 $E = E_{\\max} \\cdot \\frac{[RA]}{R_{T}}$。在这些条件下，没有拮抗剂时，激动剂的浓度-效应关系具有等于 $K_{A}$ 的半数最大效应浓度 (EC50)，即半数最大效应浓度 (EC50) 满足 $EC_{50,\\ \\text{control}} = K_{A}$。\n\n引入浓度为 $[B]$、效能为零的竞争性拮抗剂，它与激动剂竞争相同的结合位点。使用上述基本前提，推导拮抗剂的存在如何改变达到半数最大效应所需的激动剂浓度。然后，对于激动剂浓度-效应曲线期望的两倍右移（定义为剂量比 $r = \\frac{EC_{50,\\ \\text{with antagonist}}}{EC_{50,\\ \\text{control}}} = 2$），在给定拮抗剂解离常数 $K_{B} = 37\\ \\text{nM}$ 的条件下，计算所需的拮抗剂浓度 $[B]$，并在给定 $EC_{50,\\ \\text{control}} = 13.0\\ \\text{nM}$ 的条件下，预测激动剂新的半数最大效应浓度 $EC_{50,\\ \\text{with antagonist}}$。\n\n以纳摩尔 (nM) 为单位表示最终的拮抗剂浓度和预测的半数最大效应浓度，并将您的数值答案四舍五入到三位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **结合模型：** 受体结合遵循质量作用定律。\n- **拮抗剂解离常数：** $K_{B} = \\frac{[R][B]}{[RB]}$\n- **激动剂解离常数：** $K_{A} = \\frac{[R][A]}{[RA]}$\n- **总受体浓度：** $R_{T} = [R] + [RA] + [RB]$\n- **药理效应方程：** $E = E_{\\max} \\cdot \\frac{[RA]}{R_{T}}$\n- **对照条件：** $EC_{50,\\ \\text{control}} = K_{A}$\n- **剂量比：** $r = \\frac{EC_{50,\\ \\text{with antagonist}}}{EC_{50,\\ \\text{control}}} = 2$\n- **拮抗剂特性：** $K_{B} = 37\\ \\text{nM}$\n- **激动剂特性：** $EC_{50,\\ \\text{control}} = 13.0\\ \\text{nM}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于药效学的基本原理，特别是质量作用定律所描述的单一受体位点上的竞争性拮抗作用。所提供的模型是一个标准且被广泛接受的简化模型（Clark-Gaddum 模型）。这个问题是良定的，因为它提供了一套完整的定义、初始条件和常数，足以推导出唯一的解。其语言客观精确，使用了药理学中的既定术语。给定的信息是自洽且一致的；例如，$EC_{50,\\ \\text{control}} = K_{A}$ 的陈述是在没有拮抗剂（$[B]=0$）的情况下，由所提供的效应方程得出的直接且正确的推论。因此，该问题是有效的。\n\n### 步骤 3：结论与行动\n该问题被认为是有效的。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n目标是确定在存在浓度为 $[B]$ 的竞争性拮抗剂时，达到半数最大效应 ($E = \\frac{1}{2} E_{\\max}$) 所需的激动剂浓度 $[A]$。这个激动剂浓度将是新的半数最大效应浓度，记为 $EC_{50,\\ \\text{with antagonist}}$。\n\n从效应方程 $E = E_{\\max} \\cdot \\frac{[RA]}{R_{T}}$，半数最大效应的条件是：\n$$\n\\frac{1}{2} E_{\\max} = E_{\\max} \\cdot \\frac{[RA]}{R_{T}}\n$$\n这可以简化为激动剂的受体分数占据率 $\\frac{[RA]}{R_{T}}$ 必须等于 $\\frac{1}{2}$ 的要求：\n$$\n\\frac{[RA]}{R_{T}} = \\frac{1}{2}\n$$\n为了求解满足此条件的激动剂浓度 $[A]$，我们首先需要用 $[A]$、$[B]$、$K_{A}$ 和 $K_{B}$ 来表示分数占据率 $\\frac{[RA]}{R_{T}}$。\n\n根据解离常数的定义，我们可以用游离受体浓度 $[R]$ 来表示受体-配体复合物的浓度 $[RA]$ 和 $[RB]$：\n$$\nK_{A} = \\frac{[R][A]}{[RA]} \\implies [RA] = \\frac{[R][A]}{K_{A}}\n$$\n$$\nK_{B} = \\frac{[R][B]}{[RB]} \\implies [RB] = \\frac{[R][B]}{K_{B}}\n$$\n总受体浓度 $R_T$ 是游离受体、与激动剂结合的受体以及与拮抗剂结合的受体之和：\n$$\nR_{T} = [R] + [RA] + [RB]\n$$\n将 $[RA]$ 和 $[RB]$ 的表达式代入 $R_{T}$ 的方程中：\n$$\nR_{T} = [R] + \\frac{[R][A]}{K_{A}} + \\frac{[R][B]}{K_{B}}\n$$\n提出游离受体浓度 $[R]$ 作为公因子：\n$$\nR_{T} = [R] \\left( 1 + \\frac{[A]}{K_{A}} + \\frac{[B]}{K_{B}} \\right)\n$$\n现在，我们可以构建激动剂的分数占据率表达式 $\\frac{[RA]}{R_{T}}$：\n$$\n\\frac{[RA]}{R_{T}} = \\frac{\\frac{[R][A]}{K_{A}}}{[R] \\left( 1 + \\frac{[A]}{K_{A}} + \\frac{[B]}{K_{B}} \\right)}\n$$\n分子和分母中的项 $[R]$ 被消去：\n$$\n\\frac{[RA]}{R_{T}} = \\frac{\\frac{[A]}{K_{A}}}{1 + \\frac{[A]}{K_{A}} + \\frac{[B]}{K_{B}}}\n$$\n为了获得类似于 Michaelis-Menten 或 Hill-Langmuir 方程的形式，我们可以将分子和分母同乘以 $K_A$：\n$$\n\\frac{[RA]}{R_{T}} = \\frac{[A]}{K_{A} \\left( 1 + \\frac{[B]}{K_{B}} \\right) + [A]}\n$$\n因此，激动剂浓度-效应关系为：\n$$\nE = E_{\\max} \\frac{[A]}{K_{A} \\left( 1 + \\frac{[B]}{K_{B}} \\right) + [A]}\n$$\n半数最大效应浓度 $EC_{50}$ 是当 $E = \\frac{1}{2} E_{\\max}$ 时的 $[A]$ 值。这种情况发生在分母等于 $2[A]$ 时，这意味着 $[A]$ 必须等于分母中与之相加的项。因此，在拮抗剂存在下的 $EC_{50}$ 是：\n$$\nEC_{50,\\ \\text{with antagonist}} = K_{A} \\left( 1 + \\frac{[B]}{K_{B}} \\right)\n$$\n问题将剂量比 $r$ 定义为：\n$$\nr = \\frac{EC_{50,\\ \\text{with antagonist}}}{EC_{50,\\ \\text{control}}}\n$$\n鉴于 $EC_{50,\\ \\text{control}} = K_{A}$，我们可以代入两个 $EC_{50}$ 值的表达式：\n$$\nr = \\frac{K_{A} \\left( 1 + \\frac{[B]}{K_{B}} \\right)}{K_{A}}\n$$\n这可以简化为 Gaddum-Schild 方程：\n$$\nr = 1 + \\frac{[B]}{K_{B}}\n$$\n该方程将剂量比 $r$ 与拮抗剂浓度 $[B]$ 及其解离常数 $K_{B}$ 联系起来。\n\n### 所需值的计算\n我们已知 $r=2$，$K_{B} = 37\\ \\text{nM}$，以及 $EC_{50,\\ \\text{control}} = 13.0\\ \\text{nM}$。\n\n**1. 计算拮抗剂浓度 $[B]$：**\n使用 Gaddum-Schild 方程，我们求解 $[B]$：\n$$\n2 = 1 + \\frac{[B]}{K_{B}}\n$$\n$$\n1 = \\frac{[B]}{K_{B}}\n$$\n$$\n[B] = K_{B}\n$$\n代入给定的 $K_{B}$ 值：\n$$\n[B] = 37\\ \\text{nM}\n$$\n四舍五入到三位有效数字，我们得到 $[B] = 37.0\\ \\text{nM}$。\n\n**2. 计算新的半数最大效应浓度 $EC_{50,\\ \\text{with antagonist}}$：**\n使用剂量比 $r$ 的定义：\n$$\nEC_{50,\\ \\text{with antagonist}} = r \\cdot EC_{50,\\ \\text{control}}\n$$\n代入给定的 $r$ 和 $EC_{50,\\ \\text{control}}$ 值：\n$$\nEC_{50,\\ \\text{with antagonist}} = 2 \\cdot 13.0\\ \\text{nM}\n$$\n$$\nEC_{50,\\ \\text{with antagonist}} = 26.0\\ \\text{nM}\n$$\n这个值已经是三位有效数字。\n\n所需的拮抗剂浓度为 $37.0\\ \\text{nM}$，预测的激动剂新半数最大效应浓度为 $26.0\\ \\text{nM}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n37.0  26.0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "一个简单的模型可能会假设，要达到50%的效应，就需要占据50%的受体。然而，现实情况往往更为复杂和高效。本练习介绍了激动剂作用的操作模型（operational model of agonism），该模型将受体结合与后续的信号转导过程区分开来，从而引出了“备用受体”（spare receptors）或“受体储备”（receptor reserve）这一关键概念。通过计算产生半数最大效应所需的受体占有率，您将揭示为何通常只需占据一小部分受体即可达到最大效应，这是理解生物系统效率和决定药物表观效能的关键。",
            "id": "4982968",
            "problem": "一种竞争性完全激动剂可逆地结合到组织中同质的受体群体上。假设达到快速平衡且无构成性活性。设分数受体占有率由质量作用定律定义为 $f = \\frac{[A]}{K_A + [A]}$，其中 $[A]$ 是游离激动剂浓度， $K_A$ 是平衡解离常数。该组织遵循激动作用的操作模型 (Black and Leff)，其转导系数为 $\\tau$，希尔系数为 $n=1$。组织的最大反应为 $E_{\\max}$。\n\n仅基于这些基础，推导出一个表达式，将归一化效应 $E/E_{\\max}$ 与分数受体占有率 $f$ (当 $n=1$ 时) 联系起来，然后确定在特定情况 $\\tau = 9$ 下，产生最大反应一半 (即 $E = \\tfrac{1}{2} E_{\\max}$) 所需的 $f$ 值。将所需的分数占有率 $f$ 表示为总受体群体的精确分数。简要论证此结果对该系统中备用受体存在与否的意义。\n\n你的最终答案必须是一个没有单位的精确分数。不要四舍五入；请提供确切值。",
            "solution": "问题要求基于激动作用的操作模型，推导归一化效应 $\\frac{E}{E_{\\max}}$ 与分数受体占有率 $f$ 之间的关系，然后计算在给定的转导系数下产生半数最大效应所需的分数占有率。\n\n首先，我们验证问题陈述。\n\n**步骤 1：提取已知条件**\n- 一种竞争性完全激动剂可逆地结合到同质的受体群体上。\n- 系统处于快速平衡状态。\n- 没有构成性活性。\n- 分数受体占有率：$f = \\frac{[A]}{K_A + [A]}$，其中 $[A]$ 是游离激动剂浓度， $K_A$ 是平衡解离常数。\n- 系统遵循激动作用的操作模型 (Black and Leff)。\n- 转导系数为 $\\tau$。\n- 希尔系数为 $n=1$。\n- 组织的最大反应为 $E_{\\max}$。\n- 目标是推导一个用 $f$ 表示 $\\frac{E}{E_{\\max}}$ 的表达式。\n- 给出了一个具体案例：当 $E = \\frac{1}{2} E_{\\max}$ 且 $\\tau = 9$ 时，求 $f$。\n-  $f$ 的最终答案必须是一个精确分数。\n- 要求对备用受体进行简要论证。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，基于定量药理学的基本且公认的原理，即质量作用定律和激动作用的操作模型。所有术语如 $f$, $K_A$, $\\tau$ 和 $E_{\\max}$ 在该领域都是标准术语。问题提法严谨，提供了推导唯一解所需的所有必要信息和定义。语言客观且精确。该问题不违反任何无效性标准。\n\n**步骤 3：结论和行动**\n该问题有效。将提供完整解答。\n\n**推导与解答**\n\n由 Black and Leff 发展的激动作用操作模型提供了一个将受体占有率与组织反应联系起来的框架。该模型假定观察到的效应 $E$ 是中间刺激 $S$ 的双曲线函数。对于一个转导步骤的希尔系数为 $n=1$ 的系统，此关系为：\n$$ E = \\frac{E_{\\max} \\cdot S}{K_S + S} $$\n其中 $E_{\\max}$ 是组织能产生的最大可能效应，而 $K_S$ 是产生半数最大反应（$E_{\\max}$ 的 $50\\%$）所需的刺激。\n\n刺激 $S$ 是由激动剂与受体结合产生的。假设它与激动剂-受体复合物的浓度 $[AR]$ 以及激动剂的内在效能 $\\epsilon$ 成正比。浓度 $[AR]$ 由总受体浓度 $[R_{tot}]$ 和分数占有率 $f$ 的乘积给出。\n$$ S = \\epsilon [AR] = \\epsilon \\cdot f \\cdot [R_{tot}] $$\n\n将刺激 $S$ 的这个表达式代入效应方程得到：\n$$ E = \\frac{E_{\\max} \\cdot (\\epsilon \\cdot f \\cdot [R_{tot}])}{K_S + (\\epsilon \\cdot f \\cdot [R_{tot}])} $$\n为简化此表达式，我们可以将分子和分母同除以 $K_S$：\n$$ E = \\frac{E_{\\max} \\cdot \\frac{\\epsilon \\cdot [R_{tot}]}{K_S} \\cdot f}{1 + \\frac{\\epsilon \\cdot [R_{tot}]}{K_S} \\cdot f} $$\n无量纲比值 $\\frac{\\epsilon \\cdot [R_{tot}]}{K_S}$ 被定义为转导系数 $\\tau$。该比率量化了系统的信号放大能力。它代表了最大可能刺激（$\\epsilon \\cdot [R_{tot}]$）与产生半数最大反应所需刺激（$K_S$）之比。\n\n将 $\\tau$ 代入方程，得到效应 $E$ 与分数占有率 $f$ 之间的期望关系：\n$$ E = \\frac{E_{\\max} \\cdot \\tau \\cdot f}{1 + \\tau \\cdot f} $$\n为获得归一化效应，我们除以 $E_{\\max}$：\n$$ \\frac{E}{E_{\\max}} = \\frac{\\tau \\cdot f}{1 + \\tau \\cdot f} $$\n这个表达式通过转导系数 $\\tau$ 将归一化效应与分数占有率联系起来，符合问题第一部分的要求。\n\n接下来，我们必须确定在特定情况 $\\tau = 9$ 下，产生半数最大反应（即当 $E = \\frac{1}{2} E_{\\max}$ 时）所需的分数占有率 $f$ 的值。我们在推导出的方程中设 $\\frac{E}{E_{\\max}} = \\frac{1}{2}$ 和 $\\tau = 9$：\n$$ \\frac{1}{2} = \\frac{9f}{1 + 9f} $$\n我们现在解这个关于 $f$ 的方程。两边同乘以 $2(1 + 9f)$ 得到：\n$$ 1 \\cdot (1 + 9f) = 2 \\cdot (9f) $$\n$$ 1 + 9f = 18f $$\n两边都减去 $9f$，我们得到：\n$$ 1 = 18f - 9f $$\n$$ 1 = 9f $$\n解出 $f$，我们发现：\n$$ f = \\frac{1}{9} $$\n因此，在该系统中，需要 $\\frac{1}{9}$ 的分数占有率才能产生半数最大反应。\n\n最后，我们被要求论证此结果对备用受体存在与否的意义。\n备用受体（或受体储备）的概念描述了这样一种情况：激动剂在未占据所有可用受体（即 $f  1$）的浓度下即可引起最大反应（$E_{\\max}$）。等价地，如果产生半数最大效应的浓度（$EC_{50}$）低于解离常数（$K_A$），则系统拥有受体储备。\n在一个没有受体储备的假想系统中，效应与分数占有率成正比：$\\frac{E}{E_{\\max}} = f$。在这样的系统中，半数最大反应（$\\frac{E}{E_{\\max}} = \\frac{1}{2}$）将需要恰好 $f = \\frac{1}{2}$ 的分数占有率。\n在给定的问题中，当只有 $f = \\frac{1}{9}$ 的受体被占据时，就达到了半数最大反应。由于 $\\frac{1}{9}  \\frac{1}{2}$，该系统产生半数最大反应所占用的受体数量明显少于无储备系统所需。这表明由受体结合产生的信号被下游转导途径放大了。这种放大的存在是受体储备的决定性特征。转导系数 $\\tau = 9$ 远大于 $1$，这从数量上证实了大量备用受体的存在。",
            "answer": "$$\\boxed{\\frac{1}{9}}$$"
        }
    ]
}