{
    "hands_on_practices": [
        {
            "introduction": "我们的实践始于受体占有率这一核心概念。在药理学中，理解在给定配体浓度下有多少比例的受体被结合，是分析药物效应的基石。本练习将引导您首先使用一个常见的简化假设来计算占有率，然后采用一种更严谨的方法，从而揭示配体耗竭这一重要的现实世界问题。",
            "id": "4987288",
            "problem": "在配体因结合而可能发生显著消耗的条件下，研究一个处于平衡状态的单位点配体-受体系统。某目标配体与受体以 $1{:}1$ 的化学计量比结合，解离常数（dissociation constant, $K_D$）为 $10\\,\\text{nM}$。进行一项实验，其中总配体浓度 $ [L_T] = 5\\,\\text{nM} $，总受体浓度 $ [R_T] = 20\\,\\text{nM} $。假设无协同性，每个受体只有一个结合位点，且非特异性结合可忽略不计。基于质量作用平衡和质量守恒定律，确定在以下两种情况下的占据分数 $ \\theta \\equiv \\frac{[RL]}{[R_T]} $：\n- 情况 A（无消耗近似）：将游离配体浓度视为等于总配体浓度。\n- 情况 B（消耗校正）：在求解结合复合物浓度时，对配体和受体均强制执行质量守恒。\n\n仅从定义和基本平衡关系（例如，质量作用定律和质量守恒定律）出发，不得使用任何预先推导出的结合方程。将两个答案表示为无单位的小数。将每个占据分数四舍五入到四位有效数字。按顺序报告你的答案：情况 A（无消耗），然后是情况 B（消耗校正）。最终答案必须按规定使用括号表示法以行向量的形式提供，其中的条目是两个四舍五入后的值（无单位）。",
            "solution": "评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 系统：处于平衡状态的单位点配体-受体系统。\n- 化学计量比：$1:1$。\n- 解离常数：$K_D = 10\\,\\text{nM}$。\n- 总配体浓度：$[L_T] = 5\\,\\text{nM}$。\n- 总受体浓度：$[R_T] = 20\\,\\text{nM}$。\n- 假设：无协同性，每个受体只有一个结合位点，非特异性结合可忽略不计。\n- 任务：确定两种情况下的占据分数 $\\theta \\equiv \\frac{[RL]}{[R_T]}$。\n- 情况 A：无消耗近似，其中假设平衡时的游离配体浓度 $[L]$ 等于总配体浓度，即 $[L] = [L_T]$。\n- 情况 B：消耗校正，其中对配体和受体均强制执行质量守恒。\n- 方法论约束：推导必须从基本平衡关系（质量作用定律和质量守恒定律）开始。\n- 报告格式：结果为无单位小数，四舍五入至四位有效数字，分别以行向量形式表示情况 A 和情况 B 的结果。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是受体药理学和生物物理化学中的一个标准练习。它基于公认的质量作用定律和质量守恒原理。给定的浓度和解离常数对于生物系统是物理上现实的。该问题是适定的，为待分析的两种情况提供了所有必要的参数和清晰、客观的定义。它没有任何验证标准中列出的缺陷：它不是科学上不合理、不可形式化、不完整、不切实际或不适定的。该问题要求严格应用基本原理来推导两种不同且明确定义的场景的解，并对它们进行比较，这是一项有意义的科学实践。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n控制配体 ($L$) 和受体 ($R$) 相互作用形成复合物 ($RL$) 的基本关系是可逆反应：\n$$ R + L \\rightleftharpoons RL $$\n在平衡状态下，质量作用定律将解离常数 $K_D$ 定义为：\n$$ K_D = \\frac{[R][L]}{[RL]} $$\n其中 $[R]$、$[L]$ 和 $[RL]$ 分别是平衡时游离受体、游离配体和受体-配体复合物的浓度。\n\n总受体浓度 $[R_T]$ 和总配体浓度 $[L_T]$ 的质量守恒定律由以下公式给出：\n$$ [R_T] = [R] + [RL] $$\n$$ [L_T] = [L] + [RL] $$\n占据分数 $\\theta$ 定义为与配体结合的总受体所占的比例：\n$$ \\theta = \\frac{[RL]}{[R_T]} $$\n\n### 情况 A：无消耗近似\n在这种情况下，我们假设与受体结合的配体量与总配体量相比可以忽略不计。这使得我们可以近似认为平衡时的游离配体浓度等于总配体浓度：\n$$ [L] \\approx [L_T] $$\n这个近似通常仅在 $[R_T] \\ll [L_T]$ 时有效。我们被要求应用它，而不考虑其有效性。\n\n我们从 $K_D$ 的定义开始：\n$$ K_D = \\frac{[R][L]}{[RL]} $$\n从受体质量守恒方程代入 $[R] = [R_T] - [RL]$：\n$$ K_D = \\frac{([R_T] - [RL])[L]}{[RL]} $$\n现在应用无消耗近似，$[L] = [L_T]$：\n$$ K_D = \\frac{([R_T] - [RL])[L_T]}{[RL]} $$\n我们求解复合物浓度 $[RL]$：\n$$ K_D [RL] = [R_T][L_T] - [RL][L_T] $$\n$$ K_D [RL] + [RL][L_T] = [R_T][L_T] $$\n$$ [RL](K_D + [L_T]) = [R_T][L_T] $$\n$$ [RL] = \\frac{[R_T][L_T]}{K_D + [L_T]} $$\n那么情况 A 的占据分数 $\\theta_A$ 为：\n$$ \\theta_A = \\frac{[RL]}{[R_T]} = \\frac{1}{[R_T]} \\left( \\frac{[R_T][L_T]}{K_D + [L_T]} \\right) = \\frac{[L_T]}{K_D + [L_T]} $$\n这是标准的 Hill-Langmuir 方程。我们代入给定值：$[L_T] = 5\\,\\text{nM}$ 和 $K_D = 10\\,\\text{nM}$。\n$$ \\theta_A = \\frac{5}{10 + 5} = \\frac{5}{15} = \\frac{1}{3} $$\n作为四舍五入到四位有效数字的小数，结果是：\n$$ \\theta_A \\approx 0.3333 $$\n\n### 情况 B：消耗校正计算\n在这种情况下，我们不作 $[L] \\approx [L_T]$ 的近似。我们必须考虑由于结合导致的游离配体池的消耗。我们使用完整的方程组。\n\n根据质量守恒定律，我们用复合物浓度 $[RL]$ 来表示游离浓度：\n$$ [R] = [R_T] - [RL] $$\n$$ [L] = [L_T] - [RL] $$\n将这些表达式代入 $K_D$ 方程：\n$$ K_D = \\frac{([R_T] - [RL])([L_T] - [RL])}{[RL]} $$\n这个方程必须求解 $[RL]$。我们将其重新排列成标准的二次方程形式 $ax^2 + bx + c = 0$，其中 $x = [RL]$。\n$$ K_D [RL] = ([R_T] - [RL])([L_T] - [RL]) $$\n$$ K_D [RL] = [R_T][L_T] - [R_T][RL] - [L_T][RL] + [RL]^2 $$\n$$ 0 = [RL]^2 - ([R_T] + [L_T] + K_D)[RL] + [R_T][L_T] $$\n我们使用二次公式求解 $[RL]$：\n$$ [RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} $$\n其中 $a=1$，$b = -([R_T] + [L_T] + K_D)$，$c = [R_T][L_T]$。\n$$ [RL] = \\frac{([R_T] + [L_T] + K_D) \\pm \\sqrt{([R_T] + [L_T] + K_D)^2 - 4[R_T][L_T]}}{2} $$\n为了选择正确的根，我们考虑物理约束条件，即复合物的浓度 $[RL]$ 不能超过总配体浓度 $[L_T]$ 或总受体浓度 $[R_T]$。正根会得到一个大于 $[R_T] + [L_T]$ 的 $[RL]$ 值，这在物理上是不可能的。因此，我们必须选择负根。\n\n代入给定值：$[L_T] = 5\\,\\text{nM}$，$[R_T] = 20\\,\\text{nM}$，以及 $K_D = 10\\,\\text{nM}$。\n首先，计算项 $([R_T] + [L_T] + K_D)$：\n$$ [R_T] + [L_T] + K_D = 20 + 5 + 10 = 35\\,\\text{nM} $$\n接下来，计算项 $4[R_T][L_T]$：\n$$ 4[R_T][L_T] = 4(20)(5) = 400\\,\\text{nM}^2 $$\n现在，将这些代入 $[RL]$ 的解中：\n$$ [RL] = \\frac{35 - \\sqrt{(35)^2 - 400}}{2} = \\frac{35 - \\sqrt{1225 - 400}}{2} = \\frac{35 - \\sqrt{825}}{2}\\,\\text{nM} $$\n数值计算 $[RL]$：\n$$ [RL] \\approx \\frac{35 - 28.722813}{2} = \\frac{6.277187}{2} \\approx 3.13859\\,\\text{nM} $$\n最后，计算情况 B 的占据分数 $\\theta_B$：\n$$ \\theta_B = \\frac{[RL]}{[R_T]} = \\frac{3.13859\\,\\text{nM}}{20\\,\\text{nM}} \\approx 0.1569295 $$\n作为四舍五入到四位有效数字的小数，结果是：\n$$ \\theta_B \\approx 0.1569 $$\n$\\theta_A$ ($0.3333$) 和 $\\theta_B$ ($0.1569$) 之间的显著差异突显了在该体系中，无消耗近似的失败，因为总受体浓度与总配体浓度相比不可忽略。\n\n情况 A 和情况 B 的最终答案，四舍五入到四位有效数字，分别为 $0.3333$ 和 $0.1569$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.3333  0.1569\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了平衡结合的计算之后，我们现在转向其动态过程：这种结合发生得有多快？本练习深入探讨配体-受体相互作用的动力学，指导您将观测到的结合速率 $k_{\\text{obs}}$ 分解为其基本组成部分：结合速率常数 $k_{\\text{on}}$ 和解离速率常数 $k_{\\text{off}}$。通过这个练习，您将在静态的平衡状态和达到平衡的动态过程之间建立起联系。",
            "id": "4987319",
            "problem": "一个受体 $\\mathrm{R}$ 和一个配体 $\\mathrm{L}$ 通过简单的可逆双分子结合进行相互作用，实验条件为在测量期间配体浓度基本恒定。结合时间曲线显示，当配体浓度保持在 $[ \\mathrm{L} ] = 30$ $\\mathrm{nM}$ 时，复合物浓度 $[ \\mathrm{RL} ](t)$ 在 $t = 10$ $\\mathrm{s}$ 时达到其平衡值的 $63\\%$。一个独立的平衡实验（例如，饱和结合实验）测得解离常数 $K_{D}$ 为 $15$ $\\mathrm{nM}$。假设只有一个结合位点，且系统遵循质量作用定律，没有竞争过程。\n\n仅从核心定义和经过充分检验的动力学原理出发，利用上述信息：\n- 从趋向平衡的时间曲线分数中估算表观结合速率常数 $k_{\\text{obs}}$。\n- 推导出与给定 $K_{D}$ 一致的微观结合速率常数 $k_{\\text{on}}$ 和微观解离速率常数 $k_{\\text{off}}$。\n\n将每个速率常数四舍五入至三位有效数字。$k_{\\text{obs}}$ 和 $k_{\\text{off}}$ 的单位为 $\\mathrm{s}^{-1}$，$k_{\\text{on}}$ 的单位为 $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$。按 $\\left( k_{\\text{obs}},\\, k_{\\text{on}},\\, k_{\\text{off}} \\right)$ 的顺序报告这三个值。",
            "solution": "受体 $\\mathrm{R}$ 和配体 $\\mathrm{L}$ 形成复合物 $\\mathrm{RL}$ 的可逆结合过程遵循质量作用定律，可由以下方程描述：\n$$\n\\frac{d[ \\mathrm{RL} ]}{dt} \\;=\\; k_{\\text{on}} [ \\mathrm{R} ][ \\mathrm{L} ] \\;-\\; k_{\\text{off}} [ \\mathrm{RL} ].\n$$\n在实验条件下，当 $[ \\mathrm{L} ]$ 保持恒定且远大于受体浓度时，适用伪一级动力学。受体的质量平衡为 $[ \\mathrm{R} ] = [ \\mathrm{R} ]_{T} - [ \\mathrm{RL} ]$，其中 $[ \\mathrm{R} ]_{T}$ 是总受体浓度。代入后得到：\n$$\n\\frac{d[ \\mathrm{RL} ]}{dt} \\;=\\; k_{\\text{on}} \\left( [ \\mathrm{R} ]_{T} - [ \\mathrm{RL} ] \\right) [ \\mathrm{L} ] \\;-\\; k_{\\text{off}} [ \\mathrm{RL} ] \\;=\\; k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ] \\;-\\; \\left( k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} \\right) [ \\mathrm{RL} ].\n$$\n这是一个一阶线性微分方程，其解以指数形式趋近平衡。平衡时的复合物浓度满足：\n$$\n0 \\;=\\; k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ] \\;-\\; \\left( k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} \\right) [ \\mathrm{RL} ]_{\\text{eq}},\n$$\n所以\n$$\n[ \\mathrm{RL} ]_{\\text{eq}} \\;=\\; \\frac{k_{\\text{on}} [ \\mathrm{R} ]_{T} [ \\mathrm{L} ]}{k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}} }.\n$$\n与平衡的偏差以速率常数衰减：\n$$\nk_{\\text{obs}} \\;=\\; k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}},\n$$\n结合的时间过程可以写成：\n$$\n[ \\mathrm{RL} ](t) \\;=\\; [ \\mathrm{RL} ]_{\\text{eq}} \\left( 1 - \\exp\\!\\left( - k_{\\text{obs}} t \\right) \\right),\n$$\n假设系统起始时 $[ \\mathrm{RL} ](0) = 0$。因此，在时间 $t$ 达到平衡的分数为：\n$$\nf(t) \\;\\equiv\\; \\frac{[ \\mathrm{RL} ](t)}{[ \\mathrm{RL} ]_{\\text{eq}}} \\;=\\; 1 - \\exp\\!\\left( - k_{\\text{obs}} t \\right).\n$$\n\n根据题意，当 $[ \\mathrm{L} ] = 30\\,\\mathrm{nM}$ 时，$f(10\\,\\mathrm{s}) = 0.63$。求解 $k_{\\text{obs}}$：\n$$\n0.63 \\;=\\; 1 - \\exp\\!\\left( - k_{\\text{obs}} \\cdot 10 \\right)\n\\;\\;\\Rightarrow\\;\\;\n\\exp\\!\\left( - k_{\\text{obs}} \\cdot 10 \\right) \\;=\\; 0.37\n\\;\\;\\Rightarrow\\;\\;\nk_{\\text{obs}} \\;=\\; -\\frac{1}{10} \\ln(0.37).\n$$\n数值计算 $k_{\\text{obs}}$：\n$$\n\\ln(0.37) \\approx -0.994252273 \\;\\;\\Rightarrow\\;\\; k_{\\text{obs}} \\approx \\frac{0.994252273}{10} \\;=\\; 0.0994252273 \\;\\mathrm{s}^{-1}.\n$$\n四舍五入至三位有效数字：\n$$\nk_{\\text{obs}} \\approx 0.0994 \\;\\mathrm{s}^{-1}.\n$$\n\n为推导 $k_{\\text{on}}$ 和 $k_{\\text{off}}$，我们使用解离常数 $K_{D}$ 的定义：\n$$\nK_{D} \\;=\\; \\frac{k_{\\text{off}}}{k_{\\text{on}}}.\n$$\n结合 $k_{\\text{obs}} = k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}}$，我们消去 $k_{\\text{off}}$：\n$$\nk_{\\text{obs}} \\;=\\; k_{\\text{on}} [ \\mathrm{L} ] + K_{D} k_{\\text{on}} \\;=\\; k_{\\text{on}} \\left( [ \\mathrm{L} ] + K_{D} \\right),\n$$\n因此\n$$\nk_{\\text{on}} \\;=\\; \\frac{k_{\\text{obs}}}{[ \\mathrm{L} ] + K_{D}}.\n$$\n当 $[ \\mathrm{L} ] = 30\\,\\mathrm{nM} = 30 \\times 10^{-9}\\,\\mathrm{M}$ 且 $K_{D} = 15\\,\\mathrm{nM} = 15 \\times 10^{-9}\\,\\mathrm{M}$ 时，\n$$\n[ \\mathrm{L} ] + K_{D} \\;=\\; (30 + 15) \\times 10^{-9}\\,\\mathrm{M} \\;=\\; 45 \\times 10^{-9}\\,\\mathrm{M}.\n$$\n因此，\n$$\nk_{\\text{on}} \\;=\\; \\frac{0.0994252273\\,\\mathrm{s}^{-1}}{45 \\times 10^{-9}\\,\\mathrm{M}} \\;=\\; 2.20944949 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}.\n$$\n四舍五入至三位有效数字：\n$$\nk_{\\text{on}} \\approx 2.21 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}.\n$$\n最后，使用 $k_{\\text{off}} = K_{D} \\, k_{\\text{on}}$ 计算 $k_{\\text{off}}$：\n$$\nk_{\\text{off}} \\;=\\; (15 \\times 10^{-9}\\,\\mathrm{M}) \\times \\left( 2.20944949 \\times 10^{6}\\,\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1} \\right)\n\\;=\\; 0.0331417424 \\,\\mathrm{s}^{-1}.\n$$\n四舍五入至三位有效数字：\n$$\nk_{\\text{off}} \\approx 0.0331 \\,\\mathrm{s}^{-1}.\n$$\n\n作为一致性检验，我们数值验证 $k_{\\text{obs}} \\approx k_{\\text{on}} [ \\mathrm{L} ] + k_{\\text{off}}$：\n$$\nk_{\\text{on}} [ \\mathrm{L} ] \\;=\\; (2.20944949 \\times 10^{6}) \\times (30 \\times 10^{-9}) \\;\\mathrm{s}^{-1} \\;=\\; 0.0662834847 \\,\\mathrm{s}^{-1},\n$$\n和\n$$\n0.0662834847 + 0.0331417424 \\;\\approx\\; 0.0994252271 \\,\\mathrm{s}^{-1},\n$$\n结果与四舍五入前的 $k_{\\text{obs}}$ 值相匹配。因此，推导出的 $k_{\\text{on}}$ 和 $k_{\\text{off}}$ 与时间曲线和平衡解离常数均一致。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.0994 & 2.21 \\times 10^{6} & 0.0331\\end{pmatrix}}$$"
        },
        {
            "introduction": "现在，我们将应用对受体结合的理解来解决一个经典的药理学问题：表征拮抗剂药物的作用。这项高级实践将向您介绍Schild分析法，这是一种用于确定拮抗剂亲和力及其作用机制的强大工具。通过分析模拟的实验数据，您将完成从数据转换、统计分析到最终机理诠释的完整工作流程，这与药理学研究者的实际工作非常相似。",
            "id": "4987342",
            "problem": "一个药理学实验室通过量化可逆拮抗剂如何改变激动剂的浓度-效应关系来研究受体理论。目标是绘制 Schild 图，并从第一性原理出发，估算拮抗剂的解离常数（$K_B$），检验 Schild 斜率是否偏离 $1$，并将拮抗作用机制解释为竞争性、非竞争性或不可逾越性。\n\n从以下基本原理开始：\n- 质量作用定律指出，受体-配体复合物的形成速率与游离受体和游离配体浓度的乘积成正比，在平衡状态下，被占据受体的比例取决于解离常数。\n- 在纯竞争性拮抗作用下，增加拮抗剂浓度会减少可供激动剂使用的受体比例，从而需要增加激动剂浓度才能产生相同的效应，但不会改变最大效应。可以观察到激动剂浓度-效应曲线发生平行右移。\n- 剂量比（$DR$）定义为在有拮抗剂存在时产生特定效应所需的激动剂浓度与无拮抗剂存在时所需浓度的比值。根据定义，$DR \\geq 1$。\n- Schild 图绘制的是 $\\log_{10}(DR - 1)$ 相对于 $\\log_{10}([B])$ 的关系，其中 $[B]$ 是拮抗剂浓度。斜率为 $1$ 的线性关系与简单竞争性拮抗作用一致，且截距与 $K_B$ 相关。\n\n你的任务是在一个程序中实现以下内容：\n1. 对于每个提供的测试用例，通过计算所有数据点 $i$ 的 $x_i = \\log_{10}([B_i])$ 和 $y_i = \\log_{10}(DR_i - 1)$ 来构建 Schild 图坐标。\n2. 对 $y$ 关于 $x$ 进行普通最小二乘法线性回归，以估计直线 $y = m x + c$ 的斜率 $m$ 和截距 $c$。\n3. 使用回归的残差方差和斜率的标准误，在显著性水平 $\\alpha = 0.05$ 下对原假设 $H_0: m = 1$ 进行双侧 $t$ 检验，并计算 $p$ 值。\n4. 按如下方式估算拮抗剂解离常数 $K_B$，单位为摩尔（$\\mathrm{M}$）：\n   - 如果原假设 $H_0$ 未被拒绝（即斜率与 $1$ 没有显著差异），则在竞争性假设下使用截距估算 $K_B$。\n   - 如果 $H_0$ 被拒绝（即斜率与 $1$ 有显著差异），则报告对应于激动剂效应两倍偏移时的浓度（即 $y = 0$ 时的 x 轴截距），并理解这是一个与理想竞争性行为偏差一致的表观估计值。\n5. 使用以下决策规则及所提供的最大效应比率来解释拮抗作用：\n   - 令 $r_{\\max}$ 表示在所有拮抗剂浓度中观察到的最小最大效应比率（无量纲，相对于对照组）。如果 $r_{\\max}  0.9$，则归类为不可逾越性拮抗作用。\n   - 否则，如果斜率与 $1$ 没有显著差异，则归类为竞争性拮抗作用。\n   - 否则，归类为非竞争性拮抗作用。\n6. 对于数值输出，$K_B$ 以 $\\mathrm{M}$ 为单位表示，所有报告的浮点数四舍五入至六位小数。\n\n测试套件：\n提供以下三个测试用例，每个用例由拮抗剂浓度（单位 $\\mathrm{M}$）、剂量比 $DR$（无量纲）和最大效应比率 $R_{\\max}$（无量纲）定义：\n- 用例 A（预期与具有小实验变异性的竞争性拮抗作用一致）：\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.105, 1.29, 2.02, 3.90, 11.20]$\n  - $R_{\\max} = [1.00, 0.99, 1.01, 0.98, 1.00]$\n- 用例 B（预期为不可逾越性，具有亚线性 Schild 斜率和降低的最大效应）：\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.042, 1.081, 1.197, 1.435, 2.010]$\n  - $R_{\\max} = [0.95, 0.90, 0.82, 0.70, 0.50]$\n- 用例 C（预期为非竞争性，具有超线性 Schild 斜率但最大效应不变）：\n  - $[B] = [1.0 \\times 10^{-9}, 3.0 \\times 10^{-9}, 1.0 \\times 10^{-8}, 3.0 \\times 10^{-8}, 1.0 \\times 10^{-7}]$\n  - $DR = [1.015, 1.048, 1.242, 2.005, 5.75]$\n  - $R_{\\max} = [1.00, 0.99, 1.00, 0.99, 0.98]$\n\n答案规格和单位：\n- 以 $\\mathrm{M}$ 为单位报告 $K_B$。\n- 所有浮点输出必须四舍五入至六位小数。\n- 斜率偏差检验必须使用 $\\alpha = 0.05$ 的双侧 $t$ 检验。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含每个用例结果的列表，每个用例结果是一个列表：$[m, p, K_B, \\text{dev}, \\text{code}]$，其中 $m$ 是估计的斜率（浮点数），$p$ 是检验 $m = 1$ 的 $p$ 值（浮点数），$K_B$ 的单位是 $\\mathrm{M}$（浮点数），$\\text{dev}$ 是一个布尔值，指示在 $\\alpha = 0.05$ 水平下斜率是否显著偏离 $1$，$\\text{code}$ 是一个整数解释代码，使用映射关系 $0 \\rightarrow$ 竞争性，$1 \\rightarrow$ 非竞争性，$2 \\rightarrow$ 不可逾越性。整个输出必须是单行，显示一个逗号分隔的 Python 风格的列表，其中包含这些用例列表，例如：$[[m_1,p_1,K_{B,1},\\text{dev}_1,\\text{code}_1],[m_2,p_2,K_{B,2},\\text{dev}_2,\\text{code}_2],[m_3,p_3,K_{B,3},\\text{dev}_3,\\text{code}_3]]$。",
            "solution": "该问题要求使用 Schild 回归对激动剂-拮抗剂相互作用数据进行深入分析，这是药理学中表征受体拮抗作用的一项基本技术。分析包括几个步骤：数据转换、线性回归、统计假设检验、参数估计以及拮抗作用机制的分类。整个过程基于受体理论和质量作用定律的原理。\n\n此分析的理论基础是 Schild 方程，该方程描述了竞争性拮抗剂浓度 $[B]$ 与剂量比 $DR$ 之间的关系。剂量比是指在拮抗剂存在的情况下，为产生与无拮抗剂时相同的效应，激动剂浓度必须增加的倍数。对于一个简单的、可逆的、竞争性的拮抗剂，其关系由 Gaddum-Schild 方程给出：\n$$\nDR = 1 + \\frac{[B]}{K_B}\n$$\n其中 $K_B$ 是拮抗剂-受体复合物的平衡解离常数。较低的 $K_B$ 值表示拮抗剂对受体的亲和力较高。\n\n为便于进行线性分析，该方程经过重排和对数变换。两边减去 $1$ 并取以 10 为底的对数，得到 Schild 方程：\n$$\n\\log_{10}(DR - 1) = \\log_{10}\\left(\\frac{[B]}{K_B}\\right) = \\log_{10}([B]) - \\log_{10}(K_B)\n$$\n该方程是直线 $y = mx + c$ 的形式，其中：\n- 因变量为 $y = \\log_{10}(DR - 1)$。\n- 自变量为 $x = \\log_{10}([B])$。\n- 理论斜率为 $m = 1$。\n- 理论 y 轴截距为 $c = -\\log_{10}(K_B)$。\n\n对每个测试用例，分析按以下计算步骤进行：\n\n1.  **数据转换**：对于每对给定的拮抗剂浓度 $[B_i]$ 和剂量比 $DR_i$，我们计算 Schild 图的坐标：\n    $$\n    x_i = \\log_{10}([B_i]) \\quad \\text{and} \\quad y_i = \\log_{10}(DR_i - 1)\n    $$\n    问题陈述保证了 $DR_i > 1$，确保 $y_i$ 是有定义的。\n\n2.  **普通最小二乘法（OLS）线性回归**：我们对转换后的数据点 $(x_i, y_i)$ 拟合一条直线 $y = mx + c$。通过最小化数据点与回归线之间的垂直距离的平方和来估计斜率 $m$ 和截距 $c$。OLS 估计量的公式为：\n    $$\n    m = \\frac{n \\sum_{i=1}^{n} x_i y_i - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n \\sum_{i=1}^{n} x_i^2 - (\\sum_{i=1}^{n} x_i)^2}\n    $$\n    $$\n    c = \\bar{y} - m\\bar{x} = \\frac{1}{n}\\left(\\sum_{i=1}^{n} y_i - m \\sum_{i=1}^{n} x_i\\right)\n    $$\n    其中 $n$ 是数据点的数量。\n\n3.  **斜率的假设检验**：竞争性拮抗作用的一个关键诊断是经验斜率 $m$ 是否与理论值 $1$ 一致。我们对原假设 $H_0: m = 1$ 与备择假设 $H_a: m \\neq 1$ 进行双侧 t 检验。\n    - 检验统计量计算如下：\n      $$\n      t = \\frac{m - 1}{SE(m)}\n      $$\n      其中 $SE(m)$ 是斜率的标准误。\n    - $SE(m)$ 由残差的方差导出。残差为 $e_i = y_i - (mx_i + c)$。误差方差的估计值为：\n      $$\n      s_e^2 = \\frac{\\sum_{i=1}^{n} e_i^2}{n-2}\n      $$\n      其中 $df = n-2$ 是自由度。\n    - 于是，斜率的标准误为：\n      $$\n      SE(m) = \\sqrt{\\frac{s_e^2}{\\sum_{i=1}^{n} (x_i - \\bar{x})^2}}\n      $$\n    - $p$ 值由具有 $n-2$ 个自由度的 t 分布计算得出：$p = 2 \\cdot P(T_{n-2} > |t|)$。如果在显著性水平 $\\alpha = 0.05$ 下，$p  \\alpha$，则认为斜率显著偏离 $1$。\n\n4.  **拮抗剂解离常数（$K_B$）的估算**：估算 $K_B$ 的方法取决于假设检验的结果。\n    - 如果 $H_0$ 未被拒绝（$p \\geq 0.05$），我们假设简单竞争性拮抗模型成立。估计的截距 $c$ 是 $-\\log_{10}(K_B)$ 的一个估计值。因此，$K_B$ 计算如下：\n      $$\n      K_B = 10^{-c}\n      $$\n    - 如果 $H_0$ 被拒绝（$p  0.05$），则斜率偏离 1，表明与理想模型不符。在这种情况下，问题指定估算一个表观亲和力参数。该值是产生剂量比为 $2$ 时的拮抗剂浓度。这对应于回归线上 $y = \\log_{10}(2-1) = 0$ 的点。Schild 图的 x 轴截距给出了该点的 $\\log_{10}([B])$。\n      $$\n      0 = m \\log_{10}([B]) + c \\implies \\log_{10}([B]) = -\\frac{c}{m}\n      $$\n      这个浓度，即表观 $K_B$，计算如下：\n      $$\n      K_B = 10^{-c/m}\n      $$\n\n5.  **拮抗作用机制的解释**：应用决策规则对拮抗作用进行分类。\n    - 首先，我们检查可逾越性。如果观察到的最小最大效应比率 $r_{\\max} = \\min(R_{\\max})$ 小于 $0.9$，则认为拮抗剂抑制了可能的最大效应，这是**不可逾越性拮抗作用**（代码 $2$）的特征。\n    - 如果最大效应得以保留（$r_{\\max} \\geq 0.9$），则分类取决于 Schild 斜率。如果斜率与 $1$ 没有显著差异（$p \\geq 0.05$），则先验模型得到验证，该机制被归类为**竞争性拮抗作用**（代码 $0$）。\n    - 如果最大效应得以保留，但斜率显著偏离 $1$（$p  0.05$），则该机制被归类为**非竞争性拮抗作用**（代码 $1$）。此类别包括变构调节或其他复杂的相互作用，这些作用以简单竞争模型未描述的方式改变了激动剂的亲和力或效能，但并未将最大效应抑制到不可逾越的水平。\n\n所有浮点数值结果（$m$、$p$ 和 $K_B$）均按要求四舍五入至六位小数。这种基于原理的结构化方法，可以根据所提供的实验数据对拮抗剂的药理学特征进行严谨的定量表征。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to process test cases for Schild analysis.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Competitive Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.105, 1.29, 2.02, 3.90, 11.20]),\n            \"R_max\": np.array([1.00, 0.99, 1.01, 0.98, 1.00])\n        },\n        # Case B: Insurmountable Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.042, 1.081, 1.197, 1.435, 2.010]),\n            \"R_max\": np.array([0.95, 0.90, 0.82, 0.70, 0.50])\n        },\n        # Case C: Noncompetitive Antagonism\n        {\n            \"B\": np.array([1.0e-9, 3.0e-9, 1.0e-8, 3.0e-8, 1.0e-7]),\n            \"DR\": np.array([1.015, 1.048, 1.242, 2.005, 5.75]),\n            \"R_max\": np.array([1.00, 0.99, 1.00, 0.99, 0.98])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_schild_data(case[\"B\"], case[\"DR\"], case[\"R_max\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results)\n\ndef analyze_schild_data(B_conc, DR, R_max):\n    \"\"\"\n    Performs Schild regression and analysis for a single dataset.\n\n    Args:\n        B_conc (np.ndarray): Antagonist concentrations in M.\n        DR (np.ndarray): Dose ratios (dimensionless).\n        R_max (np.ndarray): Maximal response ratios (dimensionless).\n\n    Returns:\n        list: A list containing [m, p, K_B, dev, code].\n    \"\"\"\n    \n    # 1. Construct Schild plot coordinates\n    # x = log10([B]), y = log10(DR - 1)\n    x = np.log10(B_conc)\n    y = np.log10(DR - 1)\n    \n    # 2. Perform ordinary least squares linear regression from first principles\n    n = len(x)\n    sum_x = np.sum(x)\n    sum_y = np.sum(y)\n    sum_xy = np.sum(x * y)\n    sum_x2 = np.sum(x * x)\n    \n    # Slope (m) and intercept (c)\n    m_numerator = n * sum_xy - sum_x * sum_y\n    m_denominator = n * sum_x2 - sum_x**2\n    m = m_numerator / m_denominator\n    \n    c = (sum_y - m * sum_x) / n\n    \n    # 3. Perform a t-test of the null hypothesis H0: m = 1\n    # Calculate residuals and related statistics\n    y_pred = m * x + c\n    residuals = y - y_pred\n    ss_res = np.sum(residuals**2)\n    df = n - 2  # degrees of freedom\n    \n    # Handle case where df is 0 or less, although n=5 guarantees df=3\n    if df = 0:\n        p_value = np.nan\n    else:\n        # Variance of residuals\n        s_e2 = ss_res / df\n        # Sum of squares of x\n        ss_xx = np.sum((x - np.mean(x))**2)\n        # Standard error of the slope\n        se_m = np.sqrt(s_e2 / ss_xx)\n        \n        # t-statistic for H0: m=1\n        t_stat = (m - 1.0) / se_m\n        \n        # Two-sided p-value from t-distribution\n        p_value = 2 * stats.t.sf(np.abs(t_stat), df)\n\n    alpha = 0.05\n    dev = p_value  alpha\n\n    # 4. Estimate the antagonist dissociation constant (K_B)\n    if not dev:\n        # If slope is not significantly different from 1, assume competitive model\n        # c = -log10(K_B) => K_B = 10^(-c)\n        K_B = 10**(-c)\n    else:\n        # If slope deviates, find x-intercept (where y=0, i.e., DR=2)\n        # 0 = m*log10([B]) + c => log10([B]) = -c/m => [B] = 10^(-c/m)\n        if m != 0:\n            K_B = 10**(-c / m)\n        else: # Avoid division by zero, though unlikely in this context.\n            K_B = np.inf\n\n\n    # 5. Interpret antagonism using the decision rule\n    r_max_min = np.min(R_max)\n    if r_max_min  0.9:\n        # Insurmountable if max response is suppressed\n        code = 2\n    elif not dev:\n        # Competitive if max response is preserved and slope is ~1\n        code = 0\n    else:\n        # Noncompetitive if max response is preserved but slope deviates from 1\n        code = 1\n\n    # 6. Format numerical outputs rounded to six decimal places\n    m_rounded = round(m, 6)\n    p_rounded = round(p_value, 6)\n    KB_rounded = round(K_B, 6)\n    \n    return [m_rounded, p_rounded, KB_rounded, dev, code]\n\nsolve()\n```"
        }
    ]
}