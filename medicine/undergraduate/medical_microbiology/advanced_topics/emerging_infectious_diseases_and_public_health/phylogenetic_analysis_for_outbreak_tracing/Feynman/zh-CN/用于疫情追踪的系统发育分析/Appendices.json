{
    "hands_on_practices": [
        {
            "introduction": "系统发育树是基因组流行病学的基石，它使我们能够可视化病原体之间的进化关系。邻接法（Neighbor-Joining, NJ）是一种从遗传距离数据构建系统发育树的基本且广泛使用的方法。这项实践将引导你逐步完成该算法的计算过程，将一个抽象的距离矩阵转化为一个具体的进化历史，从而为系统发育重建打下坚实的计算基础 。",
            "id": "4661528",
            "problem": "一起疑似医院内爆发的细菌病原体感染事件中，从患者身上获得了四个全基因组共有序列，标记为 $A$、$B$、$C$ 和 $D$。在祝克斯-康托 (Jukes–Cantor, JC) 核苷酸替换模型下校正的成对遗传距离，以每位点替换数为单位进行估计，并汇编成如下所示的对称 $4 \\times 4$ 距离矩阵 $D$（对角线上为零）：\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0  0.004  0.020  0.018 \\\\\n0.004  0  0.022  0.019 \\\\\n0.020  0.022  0  0.005 \\\\\n0.018  0.019  0.005  0\n\\end{pmatrix}.\n$$\n使用系统发育距离法推断的第一性原理，并且不假设任何给定的快捷公式，执行邻接法 (Neighbor-Joining, NJ) 算法，从矩阵 $D$ 重建无根树的拓扑结构和分支长度。完成重建后，计算总树长，其定义为无根 NJ 树中所有分支长度的总和。以每位点替换数为单位表示最终的总分支长度，并将您的答案四舍五入到四位有效数字。",
            "solution": "从距离矩阵重建系统发育树是计算生物学中的一个标准任务。所提供的问题陈述是有效的。\n\n**问题验证：**\n1.  **已知条件：** 提供了一个针对四个分类单元 $A$、$B$、$C$ 和 $D$ 的对称 $4 \\times 4$ 配对距离矩阵 $D$。任务是使用邻接法 (NJ) 算法找出无根树的拓扑结构和分支长度，然后计算总树长。\n2.  **科学依据：** 该问题在科学上是合理的。邻接法是基于距离的系统发育推断的基石。使用祝克斯-康托校正距离是标准做法。追踪医院爆发情景是该方法论的一个主要应用。\n3.  **适定性：** 该问题是适定的。对于任何给定的距离矩阵，NJ 算法都会产生一个唯一的无根树拓扑结构和一组相应的分支长度。该问题是自洽且无矛盾的。\n4.  **结论：** 该问题有效。\n\n**使用邻接法算法求解：**\n邻接法 (NJ) 算法是一种凝聚式聚类方法，它迭代地连接作为拓扑邻居的分类单元对。选择标准基于最小进化原则，旨在找到总分支长度最小的树。\n\n初始分类单元集合为 $S = \\{A, B, C, D\\}$，因此分类单元的数量为 $L = 4$。距离矩阵为：\n$$\nD \\;=\\;\n\\begin{pmatrix}\n0  0.004  0.020  0.018 \\\\\n0.004  0  0.022  0.019 \\\\\n0.020  0.022  0  0.005 \\\\\n0.018  0.019  0.005  0\n\\end{pmatrix}\n$$\n\n**迭代 1：$L=4$ 个分类单元**\n\n**步骤 1：计算 $Q$ 矩阵**\n首先，对于每个分类单元 $i$，我们计算其净分化度 $r_i$，即其到所有其他分类单元的距离之和：\n$$r_i = \\sum_{k \\in S} d_{ik}$$\n$r_A = d_{AB} + d_{AC} + d_{AD} = 0.004 + 0.020 + 0.018 = 0.042$\n$r_B = d_{BA} + d_{BC} + d_{BD} = 0.004 + 0.022 + 0.019 = 0.045$\n$r_C = d_{CA} + d_{CB} + d_{CD} = 0.020 + 0.022 + 0.005 = 0.047$\n$r_D = d_{DA} + d_{DB} + d_{DC} = 0.018 + 0.019 + 0.005 = 0.042$\n\n接下来，我们构建 $Q$ 矩阵，其中条目 $Q_{ij}$ 决定了要连接哪一对分类单元。选择使 $Q_{ij}$ 最小化的对 $(i, j)$。$Q_{ij}$ 的公式为：\n$$Q_{ij} = (L-2)d_{ij} - r_i - r_j$$\n对于 $L=4$，该公式变为 $Q_{ij} = 2d_{ij} - r_i - r_j$。我们为所有对计算这个值：\n$Q_{AB} = 2(0.004) - (0.042 + 0.045) = 0.008 - 0.087 = -0.079$\n$Q_{AC} = 2(0.020) - (0.042 + 0.047) = 0.040 - 0.089 = -0.049$\n$Q_{AD} = 2(0.018) - (0.042 + 0.042) = 0.036 - 0.084 = -0.048$\n$Q_{BC} = 2(0.022) - (0.045 + 0.047) = 0.044 - 0.092 = -0.048$\n$Q_{BD} = 2(0.019) - (0.045 + 0.042) = 0.038 - 0.087 = -0.049$\n$Q_{CD} = 2(0.005) - (0.047 + 0.042) = 0.010 - 0.089 = -0.079$\n\n$Q$ 矩阵中的最小值为 $-0.079$，对应于对 $(A, B)$ 和 $(C, D)$。如果出现平局，可以选择任何一个最小化对。我们任意选择连接对 $(A, B)$。\n\n**步骤 2：计算分支长度并定义一个新节点**\n我们定义一个新的内部节点 $U$，作为 $A$ 和 $B$ 的父节点。连接 $A$ 和 $B$ 到 $U$ 的分支长度计算如下：\n$$d_{iU} = \\frac{1}{2}d_{ij} + \\frac{1}{2(L-2)}(r_i - r_j)$$\n对于 $L=4$ 的对 $(A, B)$：\n$d_{AU} = \\frac{1}{2}d_{AB} + \\frac{1}{2(4-2)}(r_A - r_B) = \\frac{1}{2}(0.004) + \\frac{1}{4}(0.042 - 0.045) = 0.002 - 0.00075 = 0.00125$\n连接 $B$到 $U$ 的分支长度可以通过对称性求得，也可以通过 $d_{AU} + d_{BU} = d_{AB}$ 的性质求得：\n$d_{BU} = d_{AB} - d_{AU} = 0.004 - 0.00125 = 0.00275$\n\n**步骤 3：更新距离矩阵**\n我们现在有一个新的分类单元集合 $S' = \\{U, C, D\\}$，其中 $U$ 代表簇 $(A,B)$。我们计算剩余分类单元（$C$ 和 $D$）到新节点 $U$ 的距离。公式为：\n$$d_{kU} = \\frac{1}{2}(d_{kA} + d_{kB} - d_{AB})$$\n$d_{CU} = \\frac{1}{2}(d_{CA} + d_{CB} - d_{AB}) = \\frac{1}{2}(0.020 + 0.022 - 0.004) = \\frac{1}{2}(0.038) = 0.019$\n$d_{DU} = \\frac{1}{2}(d_{DA} + d_{DB} - d_{AB}) = \\frac{1}{2}(0.018 + 0.019 - 0.004) = \\frac{1}{2}(0.033) = 0.0165$\n\n针对分类单元 $\\{U, C, D\\}$ 的新的、简化的距离矩阵 $D'$ 为：\n$$\nD' \\;=\\;\n\\begin{pmatrix}\n0  0.019  0.0165 \\\\\n0.019  0  0.005 \\\\\n0.0165  0.005  0\n\\end{pmatrix}\n$$\n距离 $d_{CD}$ 保持为原始矩阵 $D$ 中的 $0.005$。\n\n**迭代 2：$L=3$ 个分类单元**\n\n当只剩下三个分类单元时，算法终止。无根树的拓扑结构现在已经完全解析。剩下的三个分类单元 $\\{U, C, D\\}$ 连接到一个中心内部节点，我们将其标记为 $V$。\n连接 $U, C, D$ 到 $V$ 的三个最终分支的长度使用三分类单元树的公式计算：\n$$d_{iV} = \\frac{1}{2}(d_{ij} + d_{ik} - d_{jk})$$\n$d_{UV} = \\frac{1}{2}(d_{UC} + d_{UD} - d_{CD}) = \\frac{1}{2}(0.019 + 0.0165 - 0.005) = \\frac{1}{2}(0.0305) = 0.01525$\n$d_{CV} = \\frac{1}{2}(d_{CU} + d_{CD} - d_{UD}) = \\frac{1}{2}(0.019 + 0.005 - 0.0165) = \\frac{1}{2}(0.0075) = 0.00375$\n$d_{DV} = \\frac{1}{2}(d_{DU} + d_{DC} - d_{UC}) = \\frac{1}{2}(0.0165 + 0.005 - 0.019) = \\frac{1}{2}(0.0025) = 0.00125$\n\n**最终树与总长度**\n重建完成。无根树的拓扑结构是 $((A,B),(C,D))$，有两个内部节点 $U$ 和 $V$。\n分支长度为：\n- 末端分支 $A \\to U$：$d_{AU} = 0.00125$\n- 末端分支 $B \\to U$：$d_{BU} = 0.00275$\n- 末端分支 $C \\to V$：$d_{CV} = 0.00375$\n- 末端分支 $D \\to V$：$d_{DV} = 0.00125$\n- 内部分支 $U \\leftrightarrow V$：$d_{UV} = 0.01525$\n\n总树长是所有五个分支长度的总和：\n$$L_{\\text{total}} = d_{AU} + d_{BU} + d_{CV} + d_{DV} + d_{UV}$$\n$$L_{\\text{total}} = 0.00125 + 0.00275 + 0.00375 + 0.00125 + 0.01525$$\n$$L_{\\text{total}} = 0.00400 + 0.00500 + 0.01525$$\n$$L_{\\text{total}} = 0.02425$$\n\n问题要求将答案四舍五入到四位有效数字。计算出的值 $0.02425$ 恰好有四位有效数字（$2$、$4$、$2$、$5$）。因此，无需进行四舍五入。该值按原样呈现。",
            "answer": "$$\\boxed{0.02425}$$"
        },
        {
            "introduction": "构建出系统发育树后，关键的下一步是如何解读它。两个病原体基因组之间的遗传距离，为它们在传播链中的关系远近提供了线索。这项练习将向你展示如何基于分子钟速率和病毒代际时间等参数，估算在单次传播事件中预期的基因突变数量 。这个计算为我们在评估系统发育树上的连接是否代表直接传播时，提供了一个至关重要的基准。",
            "id": "4661525",
            "problem": "一家医院正在调查一个由正链单股RNA病毒引起的聚集性感染事件。研究人员以高覆盖度对病毒基因组进行测序，并通过比较一致性序列来推断可能的传播链。假设突变的发生遵循一个时间均匀的泊松过程，其恒定的每位点替换（固定）速率与分子钟一致。设每位点时钟速率为 $\\mu$（单位：替换数/位点/年），基因组长度为 $L$（单位：核苷酸），供体感染与受体感染之间的平均代际时间为 $g$（单位：天）。仅使用基本定义，即在恒定速率的泊松过程中，一段时间内事件的期望数是速率与时间的乘积，并且独立位点上的事件数可以相加，请从第一性原理推导出每次传播事件中新产生的单核苷酸多态性（SNPs）的期望数表达式。然后，使用 $\\mu = 9.5 \\times 10^{-4}$、$L = 29{,}903$ 和 $g = 5.2$ 的数值计算该期望值，并设一年为 $365$ 天。将每次传播事件中新产生SNP的最终期望数表示为保留三位有效数字的小数。在你的推理中，假设每次传播产生的新SNP数量遵循泊松分布，简要解释你的结果对于使用一致性基因组比较来区分真实传播对的意义。",
            "solution": "该问题要求推导每次传播事件中新产生的单核苷酸多态性（SNPs）的期望数，进行数值计算，并讨论其意义。该问题具有科学依据且定义明确，为获得唯一解提供了所有必要的参数和假设。\n\n首先，我们推导每次传播事件中新产生SNP的期望数表达式，记为 $E[N_{SNP}]$。推导过程将严格遵循问题陈述中规定的原理。\n\n问题提供了以下参数：\n- 每位点替换速率为 $\\mu$，单位为“替换数/位点/年”。\n- 基因组长度为 $L$ 个核苷酸。\n- 平均代际时间为 $g$ 天。\n\n在单次传播事件中，突变累积的时间间隔即为代际时间 $g$。速率 $\\mu$ 的单位涉及年份，而 $g$ 的单位是天。为保持单位一致，我们必须将代际时间转换为年。使用提供的一年 $365$ 天的换算系数，以年为单位的代际时间 $t$ 为：\n$$t = \\frac{g}{365}$$\n\n问题陈述要求使用基本定义，即对于一个恒定速率的泊松过程，事件的期望数是速率与时间间隔的乘积。我们首先考虑单个核苷酸位点。该位点的替换速率为 $\\mu$。在时间间隔 $t$ 内，该单位点上发生替换的期望数 $E[N_{site}]$ 为：\n$$E[N_{site}] = \\mu \\times t = \\mu \\frac{g}{365}$$\n\n问题进一步指出，独立位点上的事件（替换）数是可加的。基因组由 $L$ 个位点组成。假设每个位点的替换独立发生，那么整个基因组中新产生SNP的总期望数是 $L$ 个位点上替换期望数的总和。由于假设速率 $\\mu$ 在所有位点上都是恒定的，这个总和就是 $L$ 乘以单个位点的期望值：\n$$E[N_{SNP}] = \\sum_{i=1}^{L} E[N_{site}] = L \\times E[N_{site}]$$\n代入 $E[N_{site}]$ 的表达式，我们得到每次传播事件中新产生SNP期望数的最终符号表达式：\n$$E[N_{SNP}] = L \\mu \\frac{g}{365}$$\n\n接下来，我们使用所提供的值对该表达式进行数值计算：\n- $\\mu = 9.5 \\times 10^{-4}$ 替换数/位点/年\n- $L = 29{,}903$ 核苷酸\n- $g = 5.2$ 天\n\n将这些值代入我们推导出的表达式：\n$$E[N_{SNP}] = 29{,}903 \\times (9.5 \\times 10^{-4}) \\times \\frac{5.2}{365}$$\n进行计算：\n$$E[N_{SNP}] \\approx 28.40785 \\times \\frac{5.2}{365}$$\n$$E[N_{SNP}] \\approx 28.40785 \\times 0.014246575...$$\n$$E[N_{SNP}] \\approx 0.404674...$$\n\n问题要求最终答案保留三位有效数字。将 $0.404674...$ 四舍五入到三位有效数字得到 $0.405$。\n\n最后，我们讨论此结果的意义。问题要求我们假设每次传播产生的新SNP数量 $N_{SNP}$ 遵循泊松分布。一个服从泊松分布的随机变量的期望值是其速率参数 $\\lambda$。因此，我们有 $N_{SNP} \\sim \\text{Poisson}(\\lambda)$，其中 $\\lambda = E[N_{SNP}] \\approx 0.405$。\n\n泊松分布的概率质量函数为 $P(N_{SNP}=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$，其中 $k$ 是观测到的SNP数量。我们可以计算出 $k$ 取较小值时的概率：\n- 观测到 $k=0$ 个SNP的概率：$P(N_{SNP}=0) = \\frac{(0.405)^0 \\exp(-0.405)}{0!} = \\exp(-0.405) \\approx 0.667$。\n- 观测到 $k=1$ 个SNP的概率：$P(N_{SNP}=1) = \\frac{(0.405)^1 \\exp(-0.405)}{1!} \\approx 0.405 \\times 0.667 \\approx 0.270$。\n- 观测到 $k=2$ 个SNP的概率：$P(N_{SNP}=2) = \\frac{(0.405)^2 \\exp(-0.405)}{2!} \\approx \\frac{0.164025}{2} \\times 0.667 \\approx 0.0547$。\n\n关键的意义在于，对于一次真实的直接传播事件，供体和受体的一致性基因组最有可能是完全相同的（零个SNP），概率约为 $67\\%$。同时，观测到恰好一个SNP的概率也相当大（约为 $27\\%$）。观测到两个或更多SNP的概率相对较小（$1 - 0.667 - 0.270 = 0.063$，约 $6.3\\%$）。因此，观测到零个或一个SNP与直接传播链高度一致。然而，零SNP差异并非直接传播的确凿证据，因为这是最常见的结果。相反，观测到较多数量的SNP（例如 $3$ 个或更多）使得直接传播链的可能性变得极低，并表明可能存在未被采样的中间宿主或更远的流行病学关系。每次传播的SNP期望值较低，这凸显了仅使用一致性基因组来明确解析传播链的困难，因为如果不同的传播事件都未产生新的突变，它们之间就无法被可靠地区分。",
            "answer": "$$\n\\boxed{0.405}\n$$"
        },
        {
            "introduction": "在公共卫生实践中，调查人员需要明确的标准来界定哪些病例属于同一疫情暴发，以便进行调查和控制。这项练习介绍了一种用于该目的的常见方法——基于阈值的聚类分析。通过设定一个可容忍的最大单核苷酸多态性（SNP）距离阈值，该方法可以正式定义暴发集群的边界，帮助我们将系统发育分析的结果转化为明确的公共卫生决策 。",
            "id": "4661511",
            "problem": "一家医院报告了一起疑似细菌病原体暴发。对 $8$ 株患者分离株进行了全基因组测序，得到了一个成对的单核苷酸多态性（SNP）距离矩阵。为了进行暴发追踪，使用了一种基于阈值的单连锁聚类规则：当且仅当分离株之间存在一条由一系列成对连接构成的路径时，这些分离株被划分到同一个聚类中，其中每个连接所连接的两个分离株的 SNP 距离小于或等于给定的阈值 $\\tau$。在按 SNP 距离非递减顺序添加连接来构建聚类时，如果多个候选连接具有相同的 SNP 距离（出现平局），则确定性的平局打破规则是：首先添加其分离株包含最早采样日期（以自首个采样病例以来的天数计算）的连接，剩余的平局连接通过重复相同规则来处理，直到该距离上的所有平局都被解决。在阈值或阈值以下没有任何连接的分离株被视为大小为 1 的单例聚类。\n\n分离株 $I_1,\\dots,I_8$ 的成对 SNP 距离矩阵 $D$ 为：\n$$\nD=\\begin{pmatrix}\n0  2  3  7  7  8  9  9 \\\\\n2  0  3  6  7  8  9  9 \\\\\n3  3  0  7  7  8  9  8 \\\\\n7  6  7  0  2  4  10  3 \\\\\n7  7  7  2  0  2  10  3 \\\\\n8  8  8  4  2  0  11  5 \\\\\n9  9  9  10  10  11  0  8 \\\\\n9  9  8  3  3  5  8  0\n\\end{pmatrix}.\n$$\n采样日期（以自首个采样病例以来的天数计算）为：\n$$\nt_1=2,\\quad t_2=5,\\quad t_3=3,\\quad t_4=10,\\quad t_5=11,\\quad t_6=13,\\quad t_7=7,\\quad t_8=9.\n$$\n设阈值为 $\\tau=3$。使用所述的聚类规则，确定由 $D$ 和 $\\tau$ 所隐含的连通分量（聚类），根据系统发育聚类和图论的核心定义解释如何处理平局和单例，并报告聚类的总数 $k$。将你的最终答案表示为 $k$ 的值，不带任何单位。无需四舍五入。",
            "solution": "该问题要求根据一个成对的单核苷酸多态性（SNP）距离矩阵 $D$ 和一个阈值 $\\tau$，确定由一组 $8$ 个患者分离株形成的聚类数量 $k$。该聚类规则是单连锁聚类的一种形式。\n\n首先，我们必须验证问题陈述。\n问题提供了一套完整的已知条件：\n- 分离株的数量 $N=8$，标记为 $I_1, \\dots, I_8$。\n- 一个对称的 $8 \\times 8$ SNP 距离矩阵 $D$，其中 $D_{ij}$ 是分离株 $I_i$ 和分离株 $I_j$ 之间的距离。\n- 每个分离株 $I_i$ 的采样日期集合 $t_i$。\n- 一个距离阈值 $\\tau=3$。\n- 一条聚类规则：“当且仅当分离株之间存在一条由一系列成对连接构成的路径时，这些分离株被划分到同一个聚类中，其中每个连接所连接的两个分离株的 SNP 距离小于或等于给定的阈值 $\\tau$。”\n- 一个用于凝聚式构建过程的平局打破规则。\n\n该问题具有科学依据，使用了系统发育分析和图论中的标准概念（SNP 距离、单连锁聚类、连通分量）。该问题是适定的，因为所有必要的数据都已提供，并且规则是确定性的，从而可以得到唯一解。问题陈述客观，没有歧义或矛盾。所提供的距离矩阵是有效的，它是对称的（$D_{ij}=D_{ji}$）且对角线元素为零（$D_{ii}=0$）。因此，该问题是有效的，我们可以继续进行求解。\n\n问题的核心可以用图论来建模。设分离株集合为图 $G=(V, E)$ 的顶点，其中 $V=\\{I_1, I_2, I_3, I_4, I_5, I_6, I_7, I_8\\}$。根据聚类规则，如果两个顶点 $I_i$ 和 $I_j$ 之间的 SNP 距离 $D_{ij}$ 小于或等于阈值 $\\tau$，则它们之间存在一条边。因此，边集为 $E = \\{ (I_i, I_j) \\mid i \\neq j, D_{ij} \\le \\tau \\}$。\n\n问题陈述，如果两个分离株之间存在路径，则它们属于同一个聚类。在图论中，所有可通过路径相互到达的顶点的集合构成一个连通分量。因此，聚类就是图 $G$ 的连通分量。聚类的总数 $k$ 就是图 $G$ 的连通分量的数量。\n\n问题还描述了一个凝聚过程，即按 SNP 距离的非递减顺序添加连接，并使用基于采样日期的平局打破规则。这个过程描述了如何为层次聚类构建一个树状图。然而，对于固定的阈值 $\\tau$，顶点到聚类的最终划分仅由权重小于或等于 $\\tau$ 的所有边的集合决定。考虑这些边的顺序不会改变最终的连通分量集。因此，虽然平局打破规则对于唯一确定树状图是必要的，但对于在单一指定阈值 $\\tau=3$ 下确定聚类而言并非必需。\n\n给定阈值 $\\tau=3$。我们必须从矩阵 $D$ 中找出所有满足 $D_{ij} \\le 3$ 的分离株对 $(I_i, I_j)$。由于矩阵是对称的，我们只需要检查矩阵的上三角部分。\n\n距离矩阵为：\n$$\nD=\\begin{pmatrix}\n0  2  3  7  7  8  9  9 \\\\\n2  0  3  6  7  8  9  9 \\\\\n3  3  0  7  7  8  9  8 \\\\\n7  6  7  0  2  4  10  3 \\\\\n7  7  7  2  0  2  10  3 \\\\\n8  8  8  4  2  0  11  5 \\\\\n9  9  9  10  10  11  0  8 \\\\\n9  9  8  3  3  5  8  0\n\\end{pmatrix}\n$$\n\n$D_{ij} \\le 3$ 的分离株对 $(I_i, I_j)$ 如下：\n- $D_{12} = 2 \\le 3$，所以在 $I_1$ 和 $I_2$ 之间存在一条边。\n- $D_{13} = 3 \\le 3$，所以在 $I_1$ 和 $I_3$ 之间存在一条边。\n- $D_{23} = 3 \\le 3$，所以在 $I_2$ 和 $I_3$ 之间存在一条边。\n- $D_{45} = 2 \\le 3$，所以在 $I_4$ 和 $I_5$ 之间存在一条边。\n- $D_{48} = 3 \\le 3$，所以在 $I_4$ 和 $I_8$ 之间存在一条边。\n- $D_{56} = 2 \\le 3$，所以在 $I_5$ 和 $I_6$ 之间存在一条边。\n- $D_{58} = 3 \\le 3$，所以在 $I_5$ 和 $I_8$ 之间存在一条边。\n- 对于分离株 $I_7$，其到任何其他分离株的最小距离是 $D_{78}=8$，大于阈值 $\\tau=3$。因此，$I_7$ 没有连接到任何其他分离株的边。\n\n现在我们找出由这些边定义的图的连通分量。\n分量 1：\n- 从 $I_1$ 开始。它连接到 $I_2$ 和 $I_3$。\n- $I_2$ 连接到 $I_1$ 和 $I_3$。\n- $I_3$ 连接到 $I_1$ 和 $I_2$。\n- 因此，分离株 $\\{I_1, I_2, I_3\\}$ 彼此相互连接，形成一个单一的连通分量。\n\n分量 2：\n- 选择一个尚未分配到分量的分离株，例如 $I_4$。\n- $I_4$ 连接到 $I_5$ 和 $I_8$。\n- $I_5$ 连接到 $I_4$、$I_6$ 和 $I_8$。这将 $I_6$ 也带入该分量中。\n- $I_6$ 连接到 $I_5$。\n- $I_8$ 连接到 $I_4$ 和 $I_5$。\n- 因此，分离株 $\\{I_4, I_5, I_6, I_8\\}$ 形成第二个连通分量。\n\n分量 3：\n- 唯一剩下的分离株是 $I_7$。如前所述，$I_7$ 在图中没有连接到任何其他分离株的边，因为其所有的 SNP 距离都大于 $\\tau=3$。\n- 在阈值或阈值以下没有任何连接的分离株是一个单例聚类。用图论的术语来说，$I_7$ 是一个孤立顶点。\n- 因此，分离株 $\\{I_7\\}$ 自身形成第三个连通分量。\n\n所有 $8$ 个分离株都已被分配到一个分量中。最终的聚类（连通分量）是：\n1. $\\{I_1, I_2, I_3\\}$\n2. $\\{I_4, I_5, I_6, I_8\\}$\n3. $\\{I_7\\}$\n\n不同聚类的总数是 $3$。\n单例的处理是基于图的定义的直接结果：如果一个分离株在阈值定义的图中是一个孤立顶点，它就成为一个单例聚类。平局的处理被证明与固定阈值下的最终聚类划分无关，因为所有符合条件的连接都会对图结构做出贡献，而不管它们被包含的顺序如何。\n\n聚类的总数 $k$ 是 $3$。",
            "answer": "$$\\boxed{3}$$"
        }
    ]
}