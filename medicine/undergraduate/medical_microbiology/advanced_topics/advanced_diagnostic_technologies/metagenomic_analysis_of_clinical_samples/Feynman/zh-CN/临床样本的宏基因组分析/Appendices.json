{
    "hands_on_practices": [
        {
            "introduction": "在临床宏基因组学中，样本中的宿主DNA含量通常远超微生物DNA，这对检测构成了巨大挑战。本练习将引导你通过计算来理解宿主DNA去除步骤如何显著提高微生物序列的相对丰度，这是成功进行病原体检测的关键前提。通过这个练习，你将掌握评估样本处理效率的基本定量技能。",
            "id": "4651340",
            "problem": "一份临床粪便样本采用新一代测序（NGS; Next-Generation Sequencing）进行宏基因组测序处理。在文库制备之前，进行了宿主DNA去除。去除前，样本中含有质量为 $10\\ \\mathrm{ng}$ 的微生物脱氧核糖核酸（DNA）和质量为 $1\\ \\mathrm{\\mu g}$ 的人类DNA。该去除方案移除了 $90\\%$ 质量的人类DNA，而微生物DNA保持不变。假设文库制备和测序对于来源（微生物与人类）是无偏的，并且不同来源的片段大小分布和向可测序分子的转化效率是相似的，因此源自某一来源的测序读段的预期比例等于该来源在文库总DNA质量中所占的比例。\n\n在这些假设下，计算宿主去除后文库中微生物来源读段的预期比例。请将您的答案表示为无单位小数，并四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。其科学依据基于宏基因组学原理，问题提法得当，具有唯一可解的结果，且使用客观、无歧义的语言表述。所有必要数据均已提供，且无内部矛盾。\n\n设 $m_{M,0}$ 为样本中微生物脱氧核糖核酸 (DNA) 的初始质量， $m_{H,0}$ 为人类DNA的初始质量。根据问题陈述，我们已知：\n$$ m_{M,0} = 10\\ \\mathrm{ng} $$\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} $$\n\n为确保量纲一致性，我们必须用相同的单位表示两种质量。我们将微克 ($\\mathrm{\\mu g}$) 转换为纳克 ($\\mathrm{ng}$)，使用换算因子 $1\\ \\mathrm{\\mu g} = 1000\\ \\mathrm{ng}$。\n$$ m_{H,0} = 1\\ \\mathrm{\\mu g} \\times \\frac{1000\\ \\mathrm{ng}}{1\\ \\mathrm{\\mu g}} = 1000\\ \\mathrm{ng} $$\n\n问题指出，应用了一个宿主去除方案。设 $m_{M,f}$ 和 $m_{H,f}$ 分别为去除过程后微生物和人类DNA的最终质量。\n\n微生物DNA的质量保持不变：\n$$ m_{M,f} = m_{M,0} = 10\\ \\mathrm{ng} $$\n\n该去除方案去除了 $90\\%$ 质量的人类DNA。这对应于 $0.9$ 的去除比例。剩余的人类DNA比例为 $1 - 0.9 = 0.1$。因此，人类DNA的最终质量为：\n$$ m_{H,f} = m_{H,0} \\times (1 - 0.90) = m_{H,0} \\times 0.10 $$\n代入 $m_{H,0}$ 的值：\n$$ m_{H,f} = 1000\\ \\mathrm{ng} \\times 0.10 = 100\\ \\mathrm{ng} $$\n\n去除后文库中DNA的总质量 $m_{T,f}$ 是最终微生物和人类DNA质量之和：\n$$ m_{T,f} = m_{M,f} + m_{H,f} $$\n$$ m_{T,f} = 10\\ \\mathrm{ng} + 100\\ \\mathrm{ng} = 110\\ \\mathrm{ng} $$\n\n问题假设源自某一来源的测序读段的预期比例等于该来源在文库总DNA质量中所占的比例。题目要求我们计算微生物来源读段的预期比例，我们将其记为 $F_M$。根据该假设：\n$$ F_M = \\frac{m_{M,f}}{m_{T,f}} $$\n代入计算出的值：\n$$ F_M = \\frac{10\\ \\mathrm{ng}}{110\\ \\mathrm{ng}} = \\frac{10}{110} = \\frac{1}{11} $$\n\n为将此分数表示为无单位的小数，我们进行除法运算：\n$$ F_M = \\frac{1}{11} \\approx 0.09090909... $$\n\n问题要求答案四舍五入到四位有效数字。第一位有效数字是第一个非零数字，即 $9$。接下来的三位有效数字是 $0, 9, 0$。第四位有效数字后面的数字是 $9$。由于 $9 \\ge 5$，我们将最后一位有效数字进位。\n$$ F_M \\approx 0.09091 $$",
            "answer": "$$\\boxed{0.09091}$$"
        },
        {
            "introduction": "获得了测序数据后，一个核心问题是：我们对目标病原体的基因组测序是否足够深入？本练习将介绍测序覆盖度这一基本概念，它是评估测序数据质量和信息完整性的关键指标。通过计算理论覆盖度并考虑PCR扩增重复对有效覆盖度的影响，你将学会评估测序深度的基本方法，并理解实验偏差如何影响数据解读。",
            "id": "4651408",
            "problem": "从一份血液样本中生成了一个临床鸟枪法宏基因组数据集。经过宿主去除和物种分类分配后，推断出一个疑似病原体贡献了 $N=1\\times 10^{5}$ 条读长，平均长度为 $L=150$ 个碱基对 (bp)。该病原体的基因组大约为 $G=5\\times 10^{6}$ bp。从平均测序覆盖度的基本定义（即在碱基均匀随机抽样下，基因组中每个碱基被抽样到的期望次数）出发，计算该病原体的期望平均覆盖度。然后，考虑到聚合酶链式反应 (PCR) 会引入不增加新的独特分子信息的重复读长，估计在 PCR 重复率为 $10\\%$ （即 $p=0.10$ 的读长是重复的）情况下的有效覆盖度。假设重复读长相对于基因组是均匀分布的，并且除了其原始读长外，不贡献任何额外的独特碱基。将期望覆盖度和考虑重复后的有效覆盖度均以无单位的覆盖倍数形式报告。提供精确值，不要四舍五入。",
            "solution": "用户提供的问题首先经过严格的验证过程。\n\n### 步骤1：提取已知条件\n- 分配给病原体的读长数量：$N = 1 \\times 10^{5}$\n- 平均读长长度：$L = 150$ 个碱基对 (bp)\n- 病原体基因组大小：$G = 5 \\times 10^{6}$ bp\n- PCR 重复率：$p = 0.10$\n- 平均测序覆盖度的定义：“在碱基均匀随机抽样下，基因组中每个碱基被抽样到的期望次数”\n- 关于重复读长的假设：“重复读长相对于基因组是均匀分布的，并且除了其原始读长外，不贡献任何额外的独特碱基”\n- 要求输出：\n    1. 该病原体的期望平均覆盖度。\n    2. 考虑 PCR 重复率后的有效覆盖度。\n\n### 步骤2：使用提取的已知条件进行验证\n根据提供的标准评估问题的有效性。\n\n- **科学依据**：该问题牢固地植根于基因组学和生物信息学的原理。测序覆盖度的计算是分析下一代测序数据的一个基本和标准程序。提供的基因组大小（$G$）、读长数量（$N$）、读长长度（$L$）和 PCR 重复率（$p$）都在典型的鸟枪法宏基因组学实验的现实范围内。定义和假设对于一阶分析是标准的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了计算两个要求量（期望覆盖度和有效覆盖度）所需的所有定量信息（$N$、$L$、$G$、$p$）和清晰的定义。问题结构导向一个唯一且有意义的解。\n- **客观性**：问题以精确、定量和无偏见的语言陈述。没有主观或基于意见的元素。\n\n### 步骤3：结论与行动\n该问题被确定为**有效**。它在科学上是合理的、适定的、客观的，并且没有可辨别的缺陷。可以继续进行求解过程。\n\n### 解题推导\n解答分为两部分，对应于要求的两个量。\n\n**第1部分：期望平均覆盖度**\n\n平均测序覆盖度，记为 $C$，定义为基因组中每个碱基被抽样到的期望次数。这可以计算为测序总碱基数与基因组总大小的比率。\n\n测序总碱基数是读长数量（$N$）与每条读长的平均长度（$L$）的乘积。\n$$ \\text{Total sequenced bases} = N \\times L $$\n\n基因组大小给定为 $G$。\n\n根据定义，假设均匀随机抽样，平均覆盖度 $C$ 为：\n$$ C = \\frac{N \\times L}{G} $$\n\n将给定值代入此方程：\n- $N = 1 \\times 10^{5}$\n- $L = 150$ bp\n- $G = 5 \\times 10^{6}$ bp\n\n$$ C = \\frac{(1 \\times 10^{5}) \\times 150}{5 \\times 10^{6}} $$\n$$ C = \\frac{150 \\times 10^{5}}{5 \\times 10^{6}} $$\n$$ C = \\frac{1.5 \\times 10^{7}}{5 \\times 10^{6}} $$\n$$ C = \\frac{1.5}{5} \\times 10^{7-6} $$\n$$ C = 0.3 \\times 10^{1} $$\n$$ C = 3 $$\n\n期望平均覆盖度为 $3X$（3倍）。这是一个按要求给出的无单位数字。\n\n**第2部分：考虑重复后的有效覆盖度**\n\nPCR 重复会引入冗余的读长，这些读长不提供关于基因组序列的新信息。问题指出 PCR 重复率为 $p = 0.10$，意味着 $10\\%$ 的读长是重复的。\n\n唯一的、提供信息的读长数量 $N_{\\text{unique}}$ 是总读长数 $N$ 减去重复读长的数量。重复读长的数量是 $p \\times N$。\n$$ N_{\\text{unique}} = N - (p \\times N) = N(1-p) $$\n\n有效覆盖度 $C_{\\text{eff}}$ 是仅使用唯一的、提供信息的读长计算出的覆盖度。因此，有效测序总碱基数是 $N_{\\text{unique}} \\times L$。\n$$ C_{\\text{eff}} = \\frac{N_{\\text{unique}} \\times L}{G} $$\n代入 $N_{\\text{unique}}$ 的表达式：\n$$ C_{\\text{eff}} = \\frac{N(1-p)L}{G} $$\n我们可以识别出，这等于原始覆盖度 $C$ 乘以唯一读长的比例 $(1-p)$：\n$$ C_{\\text{eff}} = C \\times (1-p) $$\n\n使用先前计算出的值 $C=3$ 和给定的重复率 $p = 0.10$：\n$$ C_{\\text{eff}} = 3 \\times (1 - 0.10) $$\n$$ C_{\\text{eff}} = 3 \\times 0.90 $$\n$$ C_{\\text{eff}} = 2.7 $$\n\n在考虑了 $10\\%$ 的重复率后，有效覆盖度为 $2.7X$（2.7倍）。这也是一个无单位的数字。\n\n要求的两个值是期望覆盖度（$3$）和有效覆盖度（$2.7$）。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3  2.7 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "宏基因组检测在临床诊断中日益重要，但一个“阳性”结果在临床上究竟意味着什么？本练习将引导你运用贝叶斯定理，计算阳性预测值（PPV）和阴性预测值（NPV），从而将检测的灵敏度和特异性与疾病的实际患病率联系起来。通过这个练习，你将深刻理解为何在低患病率人群中进行筛查时，即使是高精度的检测也可能产生误导性的结果，并学会如何批判性地解读诊断测试报告。",
            "id": "4651397",
            "problem": "一家医院正在评估一项应用于脑脊液 (CSF) 的宏基因组下一代测序 (mNGS) 检测，用于在表现为未分化型脑病的患者中筛查病毒性脑炎。在一个明确的临床人群中，独立验证估计该检测的灵敏度和特异度如下：灵敏度 $\\left(\\mathrm{Se}\\right)=0.95$，特异度 $\\left(\\mathrm{Sp}\\right)=0.98$。该筛查人群中的疾病患病率为 $\\pi=0.01$。仅使用灵敏度、特异度和患病率的基本定义，以及将它们与验后概率联系起来的条件概率法则，推导出阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，然后计算它们在给定参数下的数值。将 PPV 和 NPV 均以小数形式表示（不带百分号），并报告四舍五入至四位有效数字的有序对 $\\left(\\mathrm{PPV},\\mathrm{NPV}\\right)$。最后，根据您的结果和所使用的定义，用一两句话说明这些值如何影响 mNGS 在该人群中作为脑脊液病毒性脑炎筛查测试的临床效用。",
            "solution": "该问题陈述是有效的。它在科学上基于生物统计学和流行病学的原理，提法严谨，信息充分且一致，并且表述客观。我们可以进行推导和计算。\n\n设 $D$ 为患者患有病毒性脑炎的事件， $D^c$ 为患者未患该病的事件。设 $T^+$ 为 mNGS 检测结果为阳性的事件， $T^-$ 为检测结果为阴性的事件。\n\n问题陈述中给出的条件可转化为概率术语如下：\n- 疾病患病率 $\\pi$ 是患病的先验概率：$P(D) = \\pi = 0.01$。\n- 因此，未患病的概率为 $P(D^c) = 1 - P(D) = 1 - \\pi = 1 - 0.01 = 0.99$。\n- 灵敏度 $\\mathrm{Se}$ 是在患病条件下检测结果为阳性的条件概率：$P(T^+ | D) = \\mathrm{Se} = 0.95$。\n- 特异度 $\\mathrm{Sp}$ 是在未患病条件下检测结果为阴性的条件概率：$P(T^- | D^c) = \\mathrm{Sp} = 0.98$。\n\n根据灵敏度和特异度的定义，我们也可以定义它们的补集：\n- 假阴性率是在患病条件下检测结果为阴性的概率：$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\mathrm{Se} = 1 - 0.95 = 0.05$。\n- 假阳性率是在未患病条件下检测结果为阳性的概率：$P(T^+ | D^c) = 1 - P(T^- | D^c) = 1 - \\mathrm{Sp} = 1 - 0.98 = 0.02$。\n\n我们的目标是推导并计算阳性预测值 (PPV) 和阴性预测值 (NPV)。\n\nPPV 是在检测结果为阳性的条件下患病的验后概率，即条件概率 $P(D | T^+)$。\n使用 Bayes 定理，我们有：\n$$\n\\mathrm{PPV} = P(D | T^+) = \\frac{P(T^+ | D) P(D)}{P(T^+)}\n$$\n分母 $P(T^+)$ 是检测结果为阳性的总概率，可以使用全概率定律展开：\n$$\nP(T^+) = P(T^+ | D) P(D) + P(T^+ | D^c) P(D^c)\n$$\n代入灵敏度、特异度和患病率的项：\n$$\nP(T^+) = (\\mathrm{Se})(\\pi) + (1 - \\mathrm{Sp})(1 - \\pi)\n$$\n因此，推导出的 PPV 表达式为：\n$$\n\\mathrm{PPV} = \\frac{\\mathrm{Se} \\cdot \\pi}{\\mathrm{Se} \\cdot \\pi + (1 - \\mathrm{Sp}) \\cdot (1 - \\pi)}\n$$\n\nNPV 是在检测结果为阴性的条件下未患病的验后概率，即条件概率 $P(D^c | T^-)$。\n再次使用 Bayes 定理：\n$$\n\\mathrm{NPV} = P(D^c | T^-) = \\frac{P(T^- | D^c) P(D^c)}{P(T^-)}\n$$\n分母 $P(T^-)$ 是检测结果为阴性的总概率，可以使用全概率定律展开：\n$$\nP(T^-) = P(T^- | D^c) P(D^c) + P(T^- | D) P(D)\n$$\n代入灵敏度、特异度和患病率的项：\n$$\nP(T^-) = (\\mathrm{Sp})(1 - \\pi) + (1 - \\mathrm{Se})(\\pi)\n$$\n因此，推导出的 NPV 表达式为：\n$$\n\\mathrm{NPV} = \\frac{\\mathrm{Sp} \\cdot (1 - \\pi)}{\\mathrm{Sp} \\cdot (1 - \\pi) + (1 - \\mathrm{Se}) \\cdot \\pi}\n$$\n\n现在，我们使用给定的参数计算数值：$\\mathrm{Se} = 0.95$，$\\mathrm{Sp} = 0.98$，以及 $\\pi = 0.01$。\n\n对于 PPV：\n$$\n\\mathrm{PPV} = \\frac{0.95 \\cdot 0.01}{0.95 \\cdot 0.01 + (1 - 0.98) \\cdot (1 - 0.01)} = \\frac{0.0095}{0.0095 + (0.02)(0.99)} = \\frac{0.0095}{0.0095 + 0.0198} = \\frac{0.0095}{0.0293} \\approx 0.32423208...\n$$\n四舍五入至四位有效数字，$\\mathrm{PPV} \\approx 0.3242$。\n\n对于 NPV：\n$$\n\\mathrm{NPV} = \\frac{0.98 \\cdot (1 - 0.01)}{0.98 \\cdot (1 - 0.01) + (1 - 0.95) \\cdot 0.01} = \\frac{0.98 \\cdot 0.99}{0.98 \\cdot 0.99 + 0.05 \\cdot 0.01} = \\frac{0.9702}{0.9702 + 0.0005} = \\frac{0.9702}{0.9707} \\approx 0.9994848...\n$$\n四舍五入至四位有效数字，$\\mathrm{NPV} \\approx 0.9995$。\n\n关于临床效用：极高的 NPV ($0.9995$) 使 mNGS 检测成为排除病毒性脑炎的绝佳筛查工具，因为阴性结果高度可靠。然而，较低的 PPV ($0.3242$) 表明阳性结果有很高的可能性是假阳性，需要进行确证性检测来建立明确的诊断。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3242  0.9995 \\end{pmatrix}}\n$$"
        }
    ]
}