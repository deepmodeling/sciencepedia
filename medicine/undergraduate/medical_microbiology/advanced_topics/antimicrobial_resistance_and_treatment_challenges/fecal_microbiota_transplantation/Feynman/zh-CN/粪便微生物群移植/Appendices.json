{
    "hands_on_practices": [
        {
            "introduction": "粪菌移植（FMT）的安全性是其临床应用的首要前提，而严格的供体筛查是保障安全的关键。然而，任何检测方法都存在局限性，理解检测结果的真实含义至关重要。本练习将运用贝叶斯定理，通过一个模拟场景计算在得到阴性筛查结果后，供体携带病原体的“后验概率”，帮助你深入理解诊断测试的敏感性、特异性以及患病率如何共同影响最终的风险评估。",
            "id": "4630418",
            "problem": "一个用于粪菌移植 (FMT) 的临床粪便捐赠项目，使用单次核酸扩增检测来筛查潜在捐赠者是否携带某种特定的肠道病原体。该检测的灵敏度为 $99.5\\%$，特异性为 $99.9\\%$。在经过初步非实验室筛选的预合格捐赠者中，该病原体的检测前患病率为 $1$ 万分之 $1$。一位特定捐赠者的实验室筛查结果为阴性。使用贝叶斯定理以及灵敏度和特异性的标准定义，从第一性原理推导出一个解析表达式，用于计算尽管检测结果为阴性，但捐赠者仍然携带该病原体的后验概率，然后对其进行数值计算。将最终概率以小数形式表示（而非百分比），并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算在检测结果为阴性的情况下，捐赠者携带特定病原体的后验概率。这是贝叶斯定理在医学诊断背景下的一个经典应用。\n\n首先，我们必须根据问题陈述正式定义事件和概率。\n设 $D$ 表示捐赠者携带病原体的事件。\n设 $D^c$ 表示捐赠者不携带病原体的事件。\n设 $T^-$ 表示实验室筛查结果为阴性的事件。\n设 $T^+$ 表示实验室筛查结果为阳性的事件。\n\n已知条件可以转化为以下概率术语：\n该病原体的检测前患病率为 $1$ 万分之 $1$。这是捐赠者携带病原体的先验概率，$P(D)$。\n$$P(D) = \\frac{1}{10{,}000} = 0.0001$$\n因此，捐赠者不携带病原体的概率是：\n$$P(D^c) = 1 - P(D) = 1 - 0.0001 = 0.9999$$\n\n检验的灵敏度为 $99.5\\%$。灵敏度是指在个体携带病原体的情况下，检测结果为阳性的概率。\n$$\\text{灵敏度} = P(T^+ | D) = 0.995$$\n\n检验的特异性为 $99.9\\%$。特异性是指在个体不携带病原体的情况下，检测结果为阴性的概率。\n$$\\text{特异性} = P(T^- | D^c) = 0.999$$\n\n我们需要求解的是，在检测结果为阴性的情况下，捐赠者仍然携带病原体的后验概率。这就是条件概率 $P(D | T^-)$。\n\n我们将使用贝叶斯定理来推导这个概率，贝叶斯定理的公式如下：\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^-)}$$\n\n为了使用这个公式，我们需要确定右侧各项的值。\n项 $P(D)$ 是患病率，已知为 $0.0001$。\n项 $P(T^- | D)$ 是在捐赠者携带病原体的情况下，检测结果为阴性的概率。这是灵敏度的补集。由于携带病原体的捐赠者检测结果可能为阳性或阴性，这些概率之和为 $1$。\n$$P(T^- | D) = 1 - P(T^+ | D) = 1 - \\text{灵敏度} = 1 - 0.995 = 0.005$$\n这个值也被称为检验的假阴性率。\n\n项 $P(T^-)$ 是无论捐赠者真实患病状况如何，获得阴性检测结果的总概率。我们可以使用全概率公式来计算：\n$$P(T^-) = P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)$$\n我们已经有了进行此计算所需的所有部分：\n- $P(T^- | D) = 0.005$\n- $P(D) = 0.0001$\n- $P(T^- | D^c) = \\text{特异性} = 0.999$\n- $P(D^c) = 0.9999$\n\n将这些值代入全概率公式：\n$$P(T^-) = (0.005)(0.0001) + (0.999)(0.9999)$$\n\n现在，我们可以构建 $P(D | T^-)$ 的完整解析表达式。设患病率为 $p = P(D)$，灵敏度为 $\\text{Sens} = P(T^+|D)$，特异性为 $\\text{Spec} = P(T^-|D^c)$。表达式为：\n$$P(D | T^-) = \\frac{P(T^- | D) \\cdot P(D)}{P(T^- | D) \\cdot P(D) + P(T^- | D^c) \\cdot P(D^c)}$$\n$$P(D | T^-) = \\frac{(1 - \\text{Sens}) \\cdot p}{(1 - \\text{Sens}) \\cdot p + \\text{Spec} \\cdot (1 - p)}$$\n这就是从第一性原理推导出的解析表达式。\n\n接下来，我们使用给定的数值来计算这个表达式：\n$p = 0.0001$, $\\text{Sens} = 0.995$, $\\text{Spec} = 0.999$.\n$$P(D | T^-) = \\frac{(1 - 0.995) \\cdot 0.0001}{(1 - 0.995) \\cdot 0.0001 + 0.999 \\cdot (1 - 0.0001)}$$\n$$P(D | T^-) = \\frac{0.005 \\cdot 0.0001}{0.005 \\cdot 0.0001 + 0.999 \\cdot 0.9999}$$\n首先，我们计算分子：\n$$\\text{分子} = 0.005 \\times 0.0001 = 0.0000005 = 5 \\times 10^{-7}$$\n接下来，我们计算分母：\n$$\\text{分母} = (0.0000005) + (0.999 \\times 0.9999)$$\n$$0.999 \\times 0.9999 = 0.9989001$$\n$$\\text{分母} = 0.0000005 + 0.9989001 = 0.9989006$$\n最后，我们计算概率：\n$$P(D | T^-) = \\frac{0.0000005}{0.9989006} \\approx 0.0000005005501$$\n问题要求最终概率以小数形式表示，并四舍五入到四位有效数字。结果的前四位有效数字是 $5$、$0$、$0$ 和 $5$。第五位有效数字是 $5$，这意味着我们必须将第四位有效数字向上取整。\n$$0.0000005005501 \\approx 0.0000005006$$\n这就是在检测结果为阴性的情况下，捐赠者携带病原体的后验概率。",
            "answer": "$$\\boxed{0.0000005006}$$"
        },
        {
            "introduction": "我们可以将移植的微生物群落视为一种“活的药物”，其疗效可能与“剂量”相关。本练习引入了药理学中经典的剂量-效应关系模型（$E_{\\max}$模型），来概念化粪菌移植的效力与所用微生物剂量（以CFU衡量）之间的关系。通过推导并应用此模型，你将学会如何定量分析治疗剂量与预期临床效果之间的关联，这是优化治疗方案的基础。",
            "id": "4630387",
            "problem": "在用于治疗复发性艰难梭菌感染 (CDI) 的粪菌移植中，临床医生通常以菌落形成单位 (CFU) 来量化所施用的活体供体微生物群。考虑一个概念模型，其中临床疗效（以 $E$ 表示，并解释为介于 $0$ 和 $1$ 之间的无量纲分数）随剂量 $D$（以 CFU 为单位）单调增加，并在最大疗效 $E_{\\max}$ 处达到饱和。假设一个简单的质量作用定律框架，用于描述微生物群在有限数量的相同、独立的生态位中的定植，并具有以下基本定义和约束：(i) 疗效与平衡时被占据的生态位比例成正比，(ii) 半数有效剂量 $ED_{50}$ 定义为当 $D=ED_{50}$ 时，$E$ 等于 $\\frac{E_{\\max}}{2}$，以及 (iii) 当 $D \\to \\infty$ 时，响应饱和至 $E_{\\max}$，而在 $D=0$ 时为 $0$。使用这些假设，推导 $E$ 作为 $D$、$E_{\\max}$ 和 $ED_{50}$ 的函数的解析表达式。然后，在 $E_{\\max}=0.9$，$ED_{50}=5\\times 10^{10}$ CFU 和 $D=1\\times 10^{11}$ CFU 的条件下，评估预期疗效。将最终疗效表示为不带百分号的小数。无需四舍五入。",
            "solution": "该问题要求基于质量作用定律模型，推导供体微生物群在有限数量的生态位中定植的剂量-反应关系。此过程类似于配体与一组独立受体的结合。\n\n设 $N$ 为可用生态位的总数。设 $N_{occ}$ 为平衡时被供体微生物群占据的生态位数，而 $N_{unocc}$ 为未被占据的生态位数。生态位总数是恒定的：\n$$N = N_{occ} + N_{unocc}$$\n\n定植过程可以建模为一个可逆反应，其中来自剂量 $D$ 的一个微生物群单位与一个未被占据的生态位 $U$ 结合，形成一个被占据的生态位 $O$：\n$$D + U \\underset{k_{off}}{\\stackrel{k_{on}}{\\rightleftharpoons}} O$$\n这里，$k_{on}$ 是结合速率常数，$k_{off}$ 是解离速率常数。\n\n根据质量作用定律，生态位占据的速率与剂量 $D$ 和未被占据的生态位数 $N_{unocc}$ 成正比：\n$$Rate_{occupation} = k_{on} D N_{unocc}$$\n生态位空出（解离）的速率与被占据的生态位数 $N_{occ}$ 成正比：\n$$Rate_{vacation} = k_{off} N_{occ}$$\n\n在平衡状态下，这两个速率相等：\n$$k_{on} D N_{unocc} = k_{off} N_{occ}$$\n代入 $N_{unocc} = N - N_{occ}$：\n$$k_{on} D (N - N_{occ}) = k_{off} N_{occ}$$\n我们可以解出 $N_{occ}$：\n$$k_{on} D N - k_{on} D N_{occ} = k_{off} N_{occ}$$\n$$k_{on} D N = (k_{off} + k_{on} D) N_{occ}$$\n$$N_{occ} = \\frac{k_{on} D N}{k_{off} + k_{on} D}$$\n\n被占据生态位的分数 $f$ 由 $\\frac{N_{occ}}{N}$ 给出：\n$$f = \\frac{N_{occ}}{N} = \\frac{k_{on} D}{k_{off} + k_{on} D}$$\n将分子和分母同时除以 $k_{on}$ 得：\n$$f = \\frac{D}{\\frac{k_{off}}{k_{on}} + D}$$\n我们定义解离常数 $K_D = \\frac{k_{off}}{k_{on}}$，它代表了一半生态位被占据时的剂量。被占据生态位的分数方程变为：\n$$f(D) = \\frac{D}{K_D + D}$$\n\n根据约束 (i)，疗效 $E$ 与被占据生态位的分数 $f$ 成正比。设 $c$ 为比例常数：\n$$E(D) = c \\cdot f(D) = c \\frac{D}{K_D + D}$$\n\n我们现在使用给定的边界条件，用 $E_{\\max}$ 和 $ED_{50}$ 来确定常数 $c$ 和 $K_D$。\n\n根据约束 (iii)，当剂量 $D$ 趋于无穷大时，疗效 $E$ 饱和于 $E_{\\max}$：\n$$E_{\\max} = \\lim_{D \\to \\infty} E(D) = \\lim_{D \\to \\infty} c \\frac{D}{K_D + D} = c \\lim_{D \\to \\infty} \\frac{1}{\\frac{K_D}{D} + 1} = c \\cdot 1 = c$$\n因此，比例常数 $c$ 等于最大疗效 $E_{\\max}$。模型现在是：\n$$E(D) = E_{\\max} \\frac{D}{K_D + D}$$\n\n根据约束 (ii)，当剂量为 $D=ED_{50}$ 时，疗效为 $E = \\frac{E_{\\max}}{2}$：\n$$\\frac{E_{\\max}}{2} = E_{\\max} \\frac{ED_{50}}{K_D + ED_{50}}$$\n两边同时除以 $E_{\\max}$（假设 $E_{\\max} \\neq 0$）：\n$$\\frac{1}{2} = \\frac{ED_{50}}{K_D + ED_{50}}$$\n$$K_D + ED_{50} = 2 \\cdot ED_{50}$$\n$$K_D = ED_{50}$$\n这个结果证实了基础结合模型的解离常数 $K_D$ 等同于现象学参数 $ED_{50}$。\n\n将 $K_D = ED_{50}$ 代入疗效方程，得到 $E$ 作为 $D$、$E_{\\max}$ 和 $ED_{50}$ 的函数的最终解析表达式：\n$$E(D) = E_{\\max} \\frac{D}{ED_{50} + D}$$\n这是解的第一部分。\n\n对于第二部分，我们评估一个具体案例。给定的值为：\n$E_{\\max} = 0.9$\n$ED_{50} = 5 \\times 10^{10}$ CFU\n$D = 1 \\times 10^{11}$ CFU\n\n将这些值代入推导出的表达式：\n$$E = 0.9 \\cdot \\frac{1 \\times 10^{11}}{5 \\times 10^{10} + 1 \\times 10^{11}}$$\n可以通过提取公因数 $10^{10}$ 来简化计算：\n$$E = 0.9 \\cdot \\frac{10 \\times 10^{10}}{5 \\times 10^{10} + 10 \\times 10^{10}} = 0.9 \\cdot \\frac{10 \\times 10^{10}}{(5 + 10) \\times 10^{10}} = 0.9 \\cdot \\frac{10}{15}$$\n简化分数：\n$$E = 0.9 \\cdot \\frac{2}{3}$$\n$$E = \\frac{9}{10} \\cdot \\frac{2}{3} = \\frac{18}{30} = \\frac{3}{5}$$\n作为小数，疗效为：\n$$E = 0.6$$\n这是在给定条件下的预期疗效。",
            "answer": "$$\n\\boxed{0.6}\n$$"
        },
        {
            "introduction": "一次成功的粪菌移植会深刻地重塑患者肠道内的微生物生态系统。那么，我们如何定量地衡量这种改变的程度呢？本练习将指导你使用Bray-Curtis相异度指数，这是微生物生态学中一个核心的β-多样性度量指标，来比较移植前后两个微生物群落的组成差异。掌握这种计算方法可以让你客观地评估FMT对肠道菌群结构带来的巨大转变。",
            "id": "4630361",
            "problem": "一名患有复发性艰难梭菌感染的患者接受了粪便微生物群移植（FMT；Fecal Microbiota Transplantation）。通过$16$S核糖体RNA（rRNA）基因测序，对FMT前和FMT后第$30$天收集的粪便样本进行了分析，得到了一组固定的$8$个属的扩增子计数，顺序如下：Bacteroides、Prevotella、Faecalibacterium、Ruminococcus、Akkermansia、Escherichia/Shigella、Enterococcus、Clostridioides。设FMT前的丰度向量为\n\n$$\n\\mathbf{x} = (600,\\,200,\\,150,\\,100,\\,50,\\,2500,\\,1800,\\,2700)\n$$\n\nFMT后的丰度向量为\n\n$$\n\\mathbf{y} = (2100,\\,900,\\,1300,\\,800,\\,400,\\,500,\\,200,\\,100).\n$$\n\n仅使用量化共享丰度和总计数的组成差异的生态学核心定义，推导FMT前和FMT后群落之间的Bray–Curtis相异度，并计算给定数据下的该值。然后，根据数值越接近$0$表示群落越相似，越接近$1$表示群落越不相似的一般原则，解释计算出的数值大小所代表的FMT后群落变化的程度。\n\n将Bray–Curtis相异度报告为四舍五入到四位有效数字的无单位小数。",
            "solution": "Bray–Curtis相异度是一种生态学度量，用于量化两个不同样本之间的组成相异性，在本例中即FMT前和FMT后的微生物群落。对于由丰度向量$\\mathbf{x} = (x_1, x_2, \\dots, x_n)$和$\\mathbf{y} = (y_1, y_2, \\dots, y_n)$表示的两个群落，其中$n$是物种（在本例中为属）的数量，Bray–Curtis相异度（记为$BC(\\mathbf{x}, \\mathbf{y})$）由以下公式定义：\n\n$$\nBC(\\mathbf{x}, \\mathbf{y}) = \\frac{\\sum_{i=1}^{n} |x_i - y_i|}{\\sum_{i=1}^{n} (x_i + y_i)}\n$$\n\n分子$\\sum_{i=1}^{n} |x_i - y_i|$表示每个属丰度绝对差异的总和，量化了整个群落变化的总幅度。分母$\\sum_{i=1}^{n} (x_i + y_i)$是两个群落中个体总数（总扩增子计数）的总和。因此，该指数表示总丰度变化占总丰度的比例，其值介于$0$（对于完全相同的群落）和$1$（对于没有共同分类单元的群落）之间。\n\n给定的向量是：\n$$\n\\mathbf{x} = (600, 200, 150, 100, 50, 2500, 1800, 2700)\n$$\n$$\n\\mathbf{y} = (2100, 900, 1300, 800, 400, 500, 200, 100)\n$$\n这里，属的数量是$n=8$。\n\n首先，我们计算分子，即每个对应元素的绝对差之和：\n$$\n\\sum_{i=1}^{8} |x_i - y_i| = |600 - 2100| + |200 - 900| + |150 - 1300| + |100 - 800| + |50 - 400| + |2500 - 500| + |1800 - 200| + |2700 - 100|\n$$\n$$\n\\sum_{i=1}^{8} |x_i - y_i| = 1500 + 700 + 1150 + 700 + 350 + 2000 + 1600 + 2600 = 10600\n$$\n\n接下来，我们计算分母，即两个向量中所有丰度的总和。这可以计算为每个向量的总丰度之和。\nFMT前样本的总丰度（$\\sum x_i$）：\n$$\n\\sum_{i=1}^{8} x_i = 600 + 200 + 150 + 100 + 50 + 2500 + 1800 + 2700 = 8100\n$$\nFMT后样本的总丰度（$\\sum y_i$）：\n$$\n\\sum_{i=1}^{8} y_i = 2100 + 900 + 1300 + 800 + 400 + 500 + 200 + 100 = 6300\n$$\n分母是这两个总和的和：\n$$\n\\sum_{i=1}^{8} (x_i + y_i) = \\sum_{i=1}^{8} x_i + \\sum_{i=1}^{8} y_i = 8100 + 6300 = 14400\n$$\n\n最后，我们通过将分子除以分母来计算Bray–Curtis相异度：\n$$\nBC(\\mathbf{x}, \\mathbf{y}) = \\frac{10600}{14400} = \\frac{106}{144} = \\frac{53}{72}\n$$\n为了得到小数值，我们进行除法运算：\n$$\nBC(\\mathbf{x}, \\mathbf{y}) \\approx 0.736111...\n$$\n根据问题要求，四舍五入到四位有效数字，我们得到：\n$$\nBC(\\mathbf{x}, \\mathbf{y}) \\approx 0.7361\n$$\n\n### 解释\n计算出的Bray–Curtis相异度为$0.7361$。该值在$0$到$1$的范围内，$0$表示完全相似，$1$表示完全相异。数值$0.7361$明显更接近$1$而不是$0$，表明在FMT前和FMT后状态之间，肠道微生物群落的组成发生了非常巨大和实质性的变化。这一结果与成功FMT的目标和结果在生物学上是一致的，FMT旨在用一个健康的、多样化的群落（其特征是共生分类单元如*Bacteroides*和*Faecalibacterium*的丰度较高，如向量$\\mathbf{y}$所示）取代一个患病的、失调的微生物群落（其特征通常是致病菌如*Clostridioides*、*Enterococcus*和*Escherichia/Shigella*的高丰度，如向量$\\mathbf{x}$所示）。高的相异度值定量地证实了发生了深刻的生态重构。",
            "answer": "$$\n\\boxed{0.7361}\n$$"
        }
    ]
}