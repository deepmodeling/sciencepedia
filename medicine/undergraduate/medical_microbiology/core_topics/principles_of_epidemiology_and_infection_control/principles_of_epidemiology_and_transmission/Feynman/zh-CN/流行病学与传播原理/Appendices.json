{
    "hands_on_practices": [
        {
            "introduction": "疾病监测与控制的基石是对病例的准确诊断。本练习将引导您完成评估一种新诊断测试的全过程，从其固有特性——灵敏度（$Se$）和特异性（$Sp$）——入手，最终计算其在真实筛查场景中的预测价值。掌握这些计算对于正确解读检测结果和制定明智的公共卫生决策至关重要。",
            "id": "4666923",
            "problem": "一家医院实验室使用聚合酶链式反应（PCR）作为参考标准，评估一种用于呼吸道病原体的新型快速抗原检测试剂。在一个验证队列中，该试剂被应用于由参考标准确定的两个组：第一组由 $180$ 名确诊感染者组成，其中 $168$ 人返回阳性检测结果；第二组由 $220$ 名确诊未感染者组成，其中 $198$ 人返回阴性检测结果。随后，该试剂计划用于一个社区筛查项目，已知该社区的感染患病率为 $P = 0.15$。\n\n从灵敏度是条件概率 $P(\\text{test positive} \\mid \\text{disease})$、特异度是条件概率 $P(\\text{test negative} \\mid \\text{no disease})$ 以及患病率是边际概率 $P(\\text{disease})$ 这些基础流行病学定义出发，首先根据验证队列中的观测计数推导灵敏度 $Se$ 和特异度 $Sp$ 的表达式。然后，利用全概率定律和贝叶斯定理，推导阳性预测值 $PPV = P(\\text{disease} \\mid \\text{test positive})$ 和阴性预测值 $NPV = P(\\text{no disease} \\mid \\text{test negative})$ 关于 $P$、$Se$ 和 $Sp$ 的解析表达式。最后，计算所述检测方法和筛查场景下的 $Se$、$Sp$、$PPV$ 和 $NPV$ 的数值，将每个值表示为小数（而非百分比），并将所有四个量四舍五入到四位有效数字。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 确诊感染（患病）人数：$N_D = 180$。\n- 检测结果为阳性的感染者人数（真阳性， $TP$）：$168$。\n- 确诊未感染（未患病）人数：$N_{\\bar{D}} = 220$。\n- 检测结果为阴性的未感染者人数（真阴性， $TN$）：$198$。\n- 社区筛查项目的感染患病率：$P = P(\\text{disease}) = 0.15$。\n- 灵敏度定义：$Se = P(\\text{test positive} \\mid \\text{disease})$。\n- 特异度定义：$Sp = P(\\text{test negative} \\mid \\text{no disease})$。\n- 阳性预测值定义：$PPV = P(\\text{disease} \\mid \\text{test positive})$。\n- 阴性预测值定义：$NPV = P(\\text{no disease} \\mid \\text{test negative})$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了流行病学和生物统计学中标准的、普遍接受的原则（灵敏度、特异度、预测值、贝叶斯定理）。验证诊断测试的场景是医学科学中一项常规且基础的任务。该问题是适定的，为推导和计算提供了所有必要的数据。数据内部一致（例如，$168 \\leq 180$ 且 $198 \\leq 220$）。语言客观，术语定义明确。该问题是完整的且无矛盾。\n\n### 第3步：结论与行动\n问题有效。将提供完整的解答。\n\n设 $D$ 为个体患病的事件，$\\bar{D}$ 为个体未患病的事件。设 $T^+$ 为测试结果为阳性的事件， $T^-$ 为测试结果为阴性的事件。\n\n问题需要一个包含三部分的解答：\n1.  从验证队列数据中推导灵敏度（$Se$）和特异度（$Sp$）的表达式。\n2.  根据患病率（$P$）、$Se$ 和 $Sp$ 推导阳性预测值（$PPV$）和阴性预测值（$NPV$）的解析表达式。\n3.  计算 $Se$、$Sp$、$PPV$ 和 $NPV$ 的数值。\n\n**第1部分：灵敏度（$Se$）和特异度（$Sp$）的推导**\n\n根据验证队列数据，我们可以定义真阳性（$TP$）、真阴性（$TN$）、假阳性（$FP$）和假阴性（$FN$）的计数。\n- 真阳性（$TP$）：检测呈阳性的患病者人数。给定 $TP = 168$。\n- 假阴性（$FN$）：检测呈阴性的患病者人数。这是患病总人数减去真阳性人数。$FN = N_D - TP = 180 - 168 = 12$。\n- 真阴性（$TN$）：检测呈阴性的非患病者人数。给定 $TN = 198$。\n- 假阳性（$FP$）：检测呈阳性的非患病者人数。这是非患病总人数减去真阴性人数。$FP = N_{\\bar{D}} - TN = 220 - 198 = 22$。\n\n灵敏度 $Se$ 是在存在疾病的情况下测试结果为阳性的条件概率，即 $P(T^+ \\mid D)$。这个概率是根据验证数据估算的，即检测呈阳性的患病者所占的比例。\n$$Se = \\frac{\\text{Number of True Positives}}{\\text{Total Number with Disease}} = \\frac{TP}{TP + FN}$$\n特异度 $Sp$ 是在没有疾病的情况下测试结果为阴性的条件概率，即 $P(T^- \\mid \\bar{D})$。这个概率估算为检测呈阴性的非患病者所占的比例。\n$$Sp = \\frac{\\text{Number of True Negatives}}{\\text{Total Number without Disease}} = \\frac{TN}{TN + FP}$$\n这些就是根据观测计数得出的所求表达式。\n\n**第2部分：阳性预测值（$PPV$）和阴性预测值（$NPV$）的推导**\n\n阳性预测值 $PPV = P(D \\mid T^+)$ 是在测试结果为阳性的条件下患病的条件概率。我们使用贝叶斯定理来推导其表达式：\n$$PPV = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)}$$\n项 $P(D)$ 是患病率，给定为 $P$。项 $P(T^+ \\mid D)$ 是灵敏度 $Se$。分母 $P(T^+)$ 是测试呈阳性的边际概率，可以使用全概率定律展开：\n$$P(T^+) = P(T^+ \\mid D)P(D) + P(T^+ \\mid \\bar{D})P(\\bar{D})$$\n我们有 $P(D) = P$ 和 $P(\\bar{D}) = 1 - P$。我们知道 $P(T^+ \\mid D) = Se$。项 $P(T^+ \\mid \\bar{D})$ 是假阳性率，它与特异度的关系是 $P(T^+ \\mid \\bar{D}) = 1 - P(T^- \\mid \\bar{D}) = 1 - Sp$。\n将这些代入 $P(T^+)$ 的展开式中：\n$$P(T^+) = (Se)(P) + (1 - Sp)(1 - P)$$\n将此代回 $PPV$ 的表达式中：\n$$PPV = \\frac{Se \\cdot P}{Se \\cdot P + (1 - Sp)(1 - P)}$$\n阴性预测值 $NPV = P(\\bar{D} \\mid T^-)$ 是在测试结果为阴性的条件下未患病的条件概率。使用贝叶斯定理：\n$$NPV = P(\\bar{D} \\mid T^-) = \\frac{P(T^- \\mid \\bar{D}) P(\\bar{D})}{P(T^-)}$$\n项 $P(\\bar{D}) = 1 - P$。项 $P(T^- \\mid \\bar{D})$ 是特异度 $Sp$。分母 $P(T^-)$ 是测试呈阴性的边际概率，使用全概率定律展开：\n$$P(T^-) = P(T^- \\mid \\bar{D})P(\\bar{D}) + P(T^- \\mid D)P(D)$$\n项 $P(T^- \\mid D)$ 是假阴性率，它与灵敏度的关系是 $P(T^- \\mid D) = 1 - P(T^+ \\mid D) = 1 - Se$。\n将这些代入 $P(T^-)$ 的展开式中：\n$$P(T^-) = (Sp)(1 - P) + (1 - Se)(P)$$\n将此代回 $NPV$ 的表达式中：\n$$NPV = \\frac{Sp \\cdot (1 - P)}{Sp \\cdot (1 - P) + (1 - Se)P}$$\n\n**第3部分：数值计算**\n\n首先，我们根据验证队列数据计算 $Se$ 和 $Sp$ 的值。\n$$Se = \\frac{168}{180} = \\frac{14}{15} \\approx 0.933333...$$\n四舍五入到四位有效数字， $Se = 0.9333$。\n$$Sp = \\frac{198}{220} = \\frac{9}{10} = 0.9$$\n表示为四位有效数字， $Sp = 0.9000$。\n\n接下来，我们计算社区筛查项目的 $PPV$ 和 $NPV$，其中患病率 $P = 0.15$。因此，$1 - P = 0.85$。\n使用推导出的公式以及计算出的 $Se$ 和 $Sp$ 值：\n对于 $PPV$，我们使用 $Se = \\frac{14}{15}$ 和 $Sp = \\frac{9}{10}$：\n$$PPV = \\frac{(\\frac{14}{15}) \\cdot 0.15}{(\\frac{14}{15}) \\cdot 0.15 + (1 - \\frac{9}{10})(1 - 0.15)} = \\frac{\\frac{14}{15} \\cdot \\frac{15}{100}}{\\frac{14}{15} \\cdot \\frac{15}{100} + (\\frac{1}{10})(0.85)} = \\frac{\\frac{14}{100}}{\\frac{14}{100} + \\frac{8.5}{100}} = \\frac{0.14}{0.14 + 0.085} = \\frac{0.140}{0.225}$$\n$$PPV = \\frac{140}{225} = \\frac{28}{45} \\approx 0.622222...$$\n四舍五入到四位有效数字， $PPV = 0.6222$。\n\n对于 $NPV$，我们使用 $Se = \\frac{14}{15}$ 和 $Sp = \\frac{9}{10}$：\n$$NPV = \\frac{\\frac{9}{10} \\cdot (1 - 0.15)}{\\frac{9}{10} \\cdot (1 - 0.15) + (1 - \\frac{14}{15}) \\cdot 0.15} = \\frac{0.9 \\cdot 0.85}{0.9 \\cdot 0.85 + (\\frac{1}{15})(0.15)} = \\frac{0.765}{0.765 + (\\frac{1}{15}) \\frac{15}{100}} = \\frac{0.765}{0.765 + \\frac{1}{100}}$$\n$$NPV = \\frac{0.765}{0.765 + 0.01} = \\frac{0.765}{0.775} = \\frac{765}{775} = \\frac{153}{155} \\approx 0.987096...$$\n四舍五入到四位有效数字， $NPV = 0.9871$。\n\n计算出的四个数值是：\n- 灵敏度 ($Se$): $0.9333$\n- 特异度 ($Sp$): $0.9000$\n- 阳性预测值 ($PPV$): $0.6222$\n- 阴性预测值 ($NPV$): $0.9871$\n这些值在最终答案中以行矩阵的形式按（$Se$, $Sp$, $PPV$, $NPV$）的顺序列出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9333  0.9000  0.6222  0.9871\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "为了有效控制疫情，我们需要理解其即时传播动态。本练习将介绍更新方程（renewal equation），这是一个强大的模型，可用于根据每日新增病例数据估算瞬时有效再生数（$R_t$）。通过推导并应用 $R_t$ 的最大似然估计，您将学习流行病学家用于追踪疫情增长或衰退的一项基本技术。",
            "id": "4666875",
            "problem": "在一个封闭人群中，每日监测一场传染病的暴发情况。设每日发病数表示为 $I_t$，并假设采用更新模型，其代际间隔分布 $g(\\tau)$ 为已知的离散分布，其中 $g(\\tau) \\ge 0$ 且 $\\sum_{\\tau=1}^{\\infty} g(\\tau) = 1$。在更新模型下，时间 $t$ 的期望发病数与先前病例产生的总传染性成正比，瞬时有效再生数为 $R_t$，因此发病数满足泊松假设，其均值为 $R_t \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$。假设在给定过去发病数和 $g(\\tau)$ 的条件下，各时间点的发病数是独立的。\n\n您的任务是：\n1. 从泊松似然的定义和更新模型的假设出发，推导瞬时有效再生数 $R_t$ 的最大似然估计（MLE）。定义并使用 $\\Lambda_t = \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$。\n2. 使用以下经验估计的代际间隔分布和时间点 $t-1$, $t-2$, $t-3$ 及 $t$ 的发病数数据，计算 $R_t$ 的最大似然估计的数值：\n   - $g(1) = 0.5$, $g(2) = 0.3$, $g(3) = 0.2$，且对于 $\\tau \\ge 4$，$g(\\tau) = 0$，\n   - $I_{t-1} = 18$, $I_{t-2} = 12$, $I_{t-3} = 9$, $I_t = 17$。\n   将您计算出的 $R_t$ 的最终数值答案报告为一个纯数（无量纲），并四舍五入到四位有效数字。\n3. 简要解释如何通过用负二项观测模型替换泊松观测模型来校正过度离散，并说明在过度离散参数固定的情况下，这是否会改变 $R_t$ 的最大似然估计。\n\n只有第2部分要求的数值将被作为最终答案评分。",
            "solution": "用户提供的问题已经过分析，并被确定为有效。该问题科学上基于数学流行病学的既定原则，问题设定良好，信息充分，可得出唯一解，且陈述客观。该问题不违反任何无效标准。因此，我们可以着手解决。\n\n该问题分为三个部分。我们将依次解答。\n\n第1部分：推导 $R_t$ 的最大似然估计（MLE）。\n\n问题陈述，每日发病数 $I_t$ 服从泊松分布。该分布的参数，即其均值 $\\lambda_t$，由更新方程给出：\n$$\n\\lambda_t = R_t \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)\n$$\n根据题目要求，我们定义 $\\Lambda_t = \\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)$，它代表由先前感染者产生的总传染性，并由代际间隔分布 $g(\\tau)$ 加权。根据此定义，泊松分布的均值变为 $\\lambda_t = R_t \\Lambda_t$。\n\n因此，时间 $t$ 的新增病例数，记为 $I_t$，是从具有此均值的泊松分布中抽取的随机变量：\n$$\nI_t \\sim \\text{Poisson}(R_t \\Lambda_t)\n$$\n对于在时间 $t$ 观测到的单个发病数 $I_t$，其似然函数 $L(R_t)$ 由泊松分布在 $I_t$ 处的概率质量函数（PMF）给出：\n$$\nL(R_t; I_t, \\Lambda_t) = \\frac{(\\lambda_t)^{I_t} \\exp(-\\lambda_t)}{I_t!} = \\frac{(R_t \\Lambda_t)^{I_t} \\exp(-R_t \\Lambda_t)}{I_t!}\n$$\n为了找到最大似然估计，使用对数似然函数 $\\ell(R_t) = \\ln(L(R_t))$ 更为方便：\n$$\n\\ell(R_t) = \\ln\\left( \\frac{(R_t \\Lambda_t)^{I_t} \\exp(-R_t \\Lambda_t)}{I_t!} \\right)\n$$\n利用对数的性质，我们展开此表达式：\n$$\n\\ell(R_t) = \\ln((R_t \\Lambda_t)^{I_t}) - \\ln(\\exp(R_t \\Lambda_t)) - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t \\ln(R_t \\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t (\\ln(R_t) + \\ln(\\Lambda_t)) - R_t \\Lambda_t - \\ln(I_t!)\n$$\n$$\n\\ell(R_t) = I_t \\ln(R_t) + I_t \\ln(\\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!)\n$$\n为了找到使该函数最大化的 $R_t$ 值，我们对 $\\ell(R_t)$ 关于 $R_t$ 求一阶导数，并令其为零。在求导过程中，$I_t$ 和 $\\Lambda_t$被视为常数，因为 $\\Lambda_t$ 依赖于过去的发病数数据，而不依赖于 $R_t$。\n$$\n\\frac{d\\ell(R_t)}{dR_t} = \\frac{d}{dR_t} \\left( I_t \\ln(R_t) + I_t \\ln(\\Lambda_t) - R_t \\Lambda_t - \\ln(I_t!) \\right)\n$$\n$$\n\\frac{d\\ell(R_t)}{dR_t} = \\frac{I_t}{R_t} + 0 - \\Lambda_t - 0 = \\frac{I_t}{R_t} - \\Lambda_t\n$$\n将导数设为零，得到最大似然估计的方程，我们将其表示为 $\\hat{R}_t$：\n$$\n\\frac{I_t}{\\hat{R}_t} - \\Lambda_t = 0\n$$\n$$\n\\frac{I_t}{\\hat{R}_t} = \\Lambda_t\n$$\n解出 $\\hat{R}_t$，我们得到最大似然估计：\n$$\n\\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\n代入 $\\Lambda_t$ 的定义，完整的表达式为：\n$$\n\\hat{R}_t = \\frac{I_t}{\\sum_{\\tau=1}^{\\infty} I_{t-\\tau} g(\\tau)}\n$$\n为了确认这是一个最大值，我们检查二阶导数：\n$$\n\\frac{d^2\\ell(R_t)}{dR_t^2} = \\frac{d}{dR_t} \\left( \\frac{I_t}{R_t} - \\Lambda_t \\right) = -\\frac{I_t}{R_t^2}\n$$\n由于发病数 $I_t$ 必须为非负（$I_t \\ge 0$）且 $R_t$ 必须为正（$R_t > 0$），二阶导数是非正的。对于任何 $I_t > 0$，它都是严格为负的，这证实了我们的解对应于似然函数的最大值。\n\n第2部分：$R_t$ 的最大似然估计的数值计算。\n\n我们被给予以下数据：\n代际间隔分布为 $g(1) = 0.5$，$g(2) = 0.3$，$g(3) = 0.2$，且对于所有 $\\tau \\ge 4$，$g(\\tau) = 0$。\n发病数数据为 $I_{t-1} = 18$，$I_{t-2} = 12$，$I_{t-3} = 9$，以及 $I_t = 17$。\n\n首先，我们计算总传染性 $\\Lambda_t$。由于当 $\\tau \\ge 4$ 时 $g(\\tau)=0$，无限求和在 $\\tau=3$ 后截断：\n$$\n\\Lambda_t = \\sum_{\\tau=1}^{3} I_{t-\\tau} g(\\tau) = I_{t-1} g(1) + I_{t-2} g(2) + I_{t-3} g(3)\n$$\n代入给定的数值：\n$$\n\\Lambda_t = (18)(0.5) + (12)(0.3) + (9)(0.2)\n$$\n$$\n\\Lambda_t = 9.0 + 3.6 + 1.8 = 14.4\n$$\n现在，我们使用第1部分推导出的最大似然估计公式来计算 $\\hat{R}_t$：\n$$\n\\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\n代入 $I_t$ 和计算出的 $\\Lambda_t$ 的值：\n$$\n\\hat{R}_t = \\frac{17}{14.4} \\approx 1.180555...\n$$\n问题要求将结果四舍五入到四位有效数字。第五位有效数字是5，所以我们向上取整。\n$$\n\\hat{R}_t \\approx 1.181\n$$\n\n第3部分：过度离散与负二项模型。\n\n泊松分布有一个定义性属性，即其均值等于其方差，即 $E[I_t] = \\text{Var}(I_t) = \\lambda_t$。过度离散是在许多真实世界的计数数据集中观察到的现象，其中样本方差显著大于样本均值。这违反了泊松假设。\n\n校正过度离散的一种标准方法是用负二项（NB）模型替换泊松观测模型。负二项分布有两个参数，并允许方差大于均值。一种常见的参数化是使用均值 $\\mu$ 和过度离散参数 $\\phi > 0$，使得方差由 $\\text{Var}(I_t) = \\mu + \\phi \\mu^2$ 给出。当 $\\phi \\to 0$ 时，负二项分布收敛于泊松分布。\n\n为了将此应用于我们的问题，我们将 $I_t$ 建模为：\n$$\nI_t \\sim \\text{NB}(\\mu_t, \\phi)\n$$\n其中均值 $\\mu_t$ 由相同的更新过程模型指定，$\\mu_t = R_t \\Lambda_t$。问题询问，在过度离散参数 $\\phi$ *固定*的假设下，这种改变是否会影响 $R_t$ 的最大似然估计。\n\n为了确定这一点，我们考察负二项分布均值参数的最大似然估计。对于来自均值为 $\\mu$、固定大小参数为 $k = 1/\\phi$ 的负二项分布的单个观测值 $y$，其对数似然为 $\\ell_{NB}(\\mu) = \\ln(f(y; \\mu, k))$。对数似然关于均值 $\\mu$ 的导数为 $\\frac{\\partial \\ell_{NB}}{\\partial \\mu} = \\frac{y-\\mu}{\\mu(1+\\mu/k)}$。将此得分函数设为零以找到均值的最大似然估计 $\\hat{\\mu}$，可得：\n$$\n\\frac{y - \\hat{\\mu}}{\\hat{\\mu}(1+\\hat{\\mu}/k)} = 0 \\implies y - \\hat{\\mu} = 0 \\implies \\hat{\\mu} = y\n$$\n因此，对于单个观测值，负二项分布（具有固定的离散参数）均值的最大似然估计就是观测值本身。在我们的案例中，对于单个观测值 $I_t$，其均值 $\\mu_t$ 的最大似然估计是 $\\hat{\\mu}_t = I_t$。\n\n这个结果与泊松分布均值的最大似然估计相同，后者也是观测值本身。因为在两个模型中，均值都通过相同的方程（$\\mu_t = R_t \\Lambda_t$）与 $R_t$ 相关，并且均值的最大似然估计是相同的（$\\hat{\\mu}_t = I_t$），所以得到的 $R_t$ 的最大似然估计也必然相同。设 $\\hat{\\mu}_t = \\hat{R}_t \\Lambda_t$ 并使用 $\\hat{\\mu}_t = I_t$，我们得到：\n$$\nI_t = \\hat{R}_t \\Lambda_t \\implies \\hat{R}_t = \\frac{I_t}{\\Lambda_t}\n$$\n因此，在过度离散参数 $\\phi$ 是固定且已知的条件下，用负二项模型替换泊松观测模型*不会*改变 $R_t$ 的最大似然估计量。该估计量仍然是当前发病数与过去总传染性的比率。",
            "answer": "$$\\boxed{1.181}$$"
        },
        {
            "introduction": "在明确定义的群体（如家庭或宿舍）中进行的暴发调查，为我们深入了解疾病的传播能力提供了宝贵信息。本问题聚焦于估算续发率（Secondary Attack Rate, SAR），即易感接触者被感染的概率。您不仅将计算这一关键指标，还将推导和计算其置信区间，从而学习如何量化暴发数据中固有的统计不确定性。",
            "id": "4666939",
            "problem": "在一所封闭大学宿舍区的一次暴发调查中，确定了一例首发病例，该病例在一个离散的暴露窗口期内与一个已明确的易感接触者队列有过互动。为建模之目的，假设以下流行病学条件成立：每位易感接触者在该区间内有单次暴露机会，各接触者的暴露是同质的，且二代感染由一个共同的传播概率独立产生。定义二代侵袭率（SAR）为易感接触者在暴露于首发病例后被感染的概率。假设在 $120$ 名易感接触者中，有 $36$ 人在暴露窗口期后的一个最长潜伏期内发展为实验室确诊感染。\n\n从二项传播模型和核心定义出发，推导二代侵襲率的估计量及其概率基础。使用带有 Beta 先验的贝叶斯公式推导 SAR 的后验分布以及 $95\\%$ 等尾可信区间的一般形式。独立地，推导在二项抽样下 SAR 的基于得分检验的（Wilson）$95\\%$ 置信区间。\n\n使用所提供的数据，计算 SAR 的 Wilson $95\\%$ 置信下限。将你的最终数值答案四舍五入至四位有效数字。以小数形式表示你的答案（不要使用百分号）。",
            "solution": "问题陈述经评估有效。其科学基础是流行病学和生物统计学的既定原则，问题提出得当，数据充分且一致，表述客观。因此，我们可以进行推导和求解。\n\n该问题要求对二项传播过程进行多步分析。令 $p$ 代表二代侵袭率（SAR），即给定易感接触者被感染的概率。令 $N$ 为易感接触者总数，$k$ 为被感染的接触者人数。\n\n在同质暴露和独立结果的假设下， $N$ 名易感个体中的二代感染人数 $k$ 可被建模为一个服从二项分布的随机变量，即 $k \\sim \\text{Binomial}(N, p)$。其概率质量函数由下式给出：\n$$P(k|N, p) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n当将此函数视为观测数据 $(k, N)$ 下参数 $p$ 的函数时，它就是似然函数 $L(p|k, N)$。\n\n首要任务是推导 SAR 的点估计量。标准方法是最大似然估计。我们寻找使似然函数最大化的 $p$ 值。通常，最大化对数似然函数 $\\ln L(p|k, N)$ 更为方便：\n$$\\ln L(p|k, N) = \\ln\\binom{N}{k} + k\\ln(p) + (N-k)\\ln(1-p)$$\n为求最大值，我们对 $p$ 求导并令其等于零：\n$$\\frac{d}{dp}\\ln L(p|k, N) = \\frac{k}{p} - \\frac{N-k}{1-p} = 0$$\n求解 $p$ 得到最大似然估计量（MLE），记为 $\\hat{p}$：\n$$\\frac{k}{\\hat{p}} = \\frac{N-k}{1-\\hat{p}} \\implies k(1-\\hat{p}) = \\hat{p}(N-k) \\implies k - k\\hat{p} = N\\hat{p} - k\\hat{p} \\implies k = N\\hat{p}$$\n$$\\hat{p} = \\frac{k}{N}$$\n该估计量的概率基础是，它是使得观测结果（ $N$ 名接触者中有 $k$ 人感染）最可能发生的 SAR 值。对于给定数据 $N=120$ 和 $k=36$，SAR 的最大似然估计量为 $\\hat{p} = \\frac{36}{120} = 0.3$。\n\n接下来，我们处理贝叶斯公式。题目要求我们使用 Beta 分布作为 $p$ 的先验分布。令先验分布为 $p \\sim \\text{Beta}(\\alpha, \\beta)$，其概率密度函数（PDF）为：\n$$f(p; \\alpha, \\beta) = \\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n其中 $B(\\alpha, \\beta)$ 是 Beta 函数。根据贝叶斯定理，后验分布与似然和先验的乘积成正比：\n$$f(p|k, N, \\alpha, \\beta) \\propto P(k|N, p) \\times f(p; \\alpha, \\beta)$$\n$$f(p|k, N, \\alpha, \\beta) \\propto \\left[p^k (1-p)^{N-k}\\right] \\times \\left[p^{\\alpha-1}(1-p)^{\\beta-1}\\right]$$\n$$f(p|k, N, \\alpha, \\beta) \\propto p^{k+\\alpha-1}(1-p)^{N-k+\\beta-1}$$\n得到的这个函数形式是 Beta 分布的核。因此，$p$ 的后验分布也是一个 Beta 分布：\n$$p|k, N \\sim \\text{Beta}(k+\\alpha, N-k+\\beta)$$\n这表明 Beta 分布是二项似然的共轭先验。$p$ 的 $95\\%$ 等尾可信区间是一个区间 $(p_L, p_U)$，满足 $P(p  p_L | k, N) = 0.025$ 和 $P(p > p_U | k, N) = 0.025$。这些界限对应于后验分布的第 $2.5$ 百分位数和第 $97.5$ 百分位数。该区间的一般形式为：\n$$(p_L, p_U) = (F^{-1}_{\\text{Beta}}(0.025; k+\\alpha, N-k+\\beta), F^{-1}_{\\text{Beta}}(0.975; k+\\alpha, N-k+\\beta))$$\n其中 $F^{-1}_{\\text{Beta}}$ 是具有指定后验参数的 Beta 分布的分位数函数（逆累积分布函数）。\n\n独立地，我们推导基于得分检验的（Wilson）$95\\%$ 置信区间。该区间是通过对比例的得分检验进行反演推导出来的。对于原假设 $H_0: p = p_0$ 的得分检验统计量为：\n$$Z = \\frac{\\hat{p} - p_0}{\\sqrt{\\frac{p_0(1-p_0)}{N}}}$$\n$100(1-\\alpha)\\%$ 置信区间包含所有在显著性水平 $\\alpha$ 下我们不拒绝 $H_0$ 的 $p_0$ 值。这对应于满足 $|Z| \\le z_{\\alpha/2}$ 或 $Z^2 \\le z_{\\alpha/2}^2$ 的 $p_0$ 值集合。对于 $95\\%$ 区间，$\\alpha=0.05$ 且 $z_{\\alpha/2} = z_{0.025}$。\n令 $p$ 为参数，$z = z_{\\alpha/2}$。求解区间端点的方程为：\n$$(\\hat{p} - p)^2 = z^2 \\frac{p(1-p)}{N}$$\n$$N(\\hat{p}^2 - 2\\hat{p}p + p^2) = z^2(p - p^2)$$\n将此式重排成 $Ap^2 + Bp + C = 0$ 形式的二次方程：\n$$(N+z^2)p^2 - (2N\\hat{p} + z^2)p + N\\hat{p}^2 = 0$$\n两边同除以 $N$ 得：\n$$\\left(1+\\frac{z^2}{N}\\right)p^2 - \\left(2\\hat{p} + \\frac{z^2}{N}\\right)p + \\hat{p}^2 = 0$$\n使用二次公式 $p = \\frac{-B \\pm \\sqrt{B^2-4AC}}{2A}$，其中 $A = 1+\\frac{z^2}{N}$，$B = -(2\\hat{p} + \\frac{z^2}{N})$，$C = \\hat{p}^2$，我们得到区间的端点：\n$$p = \\frac{\\left(2\\hat{p} + \\frac{z^2}{N}\\right) \\pm \\sqrt{\\left(2\\hat{p} + \\frac{z^2}{N}\\right)^2 - 4\\left(1+\\frac{z^2}{N}\\right)\\hat{p}^2}}{2\\left(1+\\frac{z^2}{N}\\right)}$$\n对平方根下的项进行代数简化后，区间的表达式为：\n$$p = \\frac{\\hat{p} + \\frac{z^2}{2N}}{1+\\frac{z^2}{N}} \\pm \\frac{z}{1+\\frac{z^2}{N}}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{N} + \\frac{z^2}{4N^2}}$$\n\n题目要求我们使用所提供的数据计算 Wilson $95\\%$ 置信下限。\n给定的数据是：\n易感接触者人数，$N = 120$。\n二代感染人数，$k = 36$。\n样本比例为 $\\hat{p} = \\frac{k}{N} = \\frac{36}{120} = 0.3$。\n对于 $95\\%$ 置信区间，显著性水平为 $\\alpha = 0.05$，来自标准正态分布的临界值为 $z_{\\alpha/2} = z_{0.025} \\approx 1.959964$。\n置信下限 $p_L$ 由下式给出：\n$$p_L = \\frac{\\hat{p} + \\frac{z_{0.025}^2}{2N} - z_{0.025}\\sqrt{\\frac{\\hat{p}(1-\\hat{p})}{N} + \\frac{z_{0.025}^2}{4N^2}}}{1+\\frac{z_{0.025}^2}{N}}$$\n我们代入数值：\n$z_{0.025}^2 \\approx (1.959964)^2 \\approx 3.841459$。\n分子是：\n$0.3 + \\frac{3.841459}{2(120)} - 1.959964\\sqrt{\\frac{0.3(1-0.3)}{120} + \\frac{3.841459}{4(120)^2}}$\n$= 0.3 + \\frac{3.841459}{240} - 1.959964\\sqrt{\\frac{0.21}{120} + \\frac{3.841459}{57600}}$\n$= 0.3 + 0.016006 - 1.959964\\sqrt{0.00175 + 0.00006669}$\n$= 0.316006 - 1.959964\\sqrt{0.00181669}$\n$= 0.316006 - 1.959964(0.0426227)$\n$= 0.316006 - 0.083539$\n$= 0.232467$\n分母是：\n$1 + \\frac{3.841459}{120} = 1 + 0.032012 = 1.032012$\n所以，下限是：\n$$p_L = \\frac{0.232467}{1.032012} \\approx 0.2252561$$\n四舍五入到四位有效数字，结果是 $0.2253$。",
            "answer": "$$\\boxed{0.2253}$$"
        }
    ]
}