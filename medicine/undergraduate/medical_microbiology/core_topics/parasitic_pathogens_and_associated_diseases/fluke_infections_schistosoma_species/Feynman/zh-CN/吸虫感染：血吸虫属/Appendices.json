{
    "hands_on_practices": [
        {
            "introduction": "了解感染的严重程度，不能仅仅停留在“阳性”或“阴性”的诊断上。本练习将演示如何利用循环阳极抗原（CAA）等临床生物标志物和粪便虫卵计数等诊断数据，来估算潜在的寄生虫负荷（童虫对数量）及致病产出（每日产卵量），从而将实验室结果与宿主体内的寄生虫生物学联系起来。",
            "id": "4631709",
            "problem": "一名流行地区的患者有记录的两种血吸虫（吸虫）的混合感染：Schistosoma mansoni 和 Schistosoma japonicum。您将获得相关的测量数据和参数，用以将循环抗原水平与成年血吸虫负荷联系起来，并独立地将粪便虫卵计数与产卵量联系起来。假设成年血吸虫在宿主血管系统中呈单配偶制配对，且每对血吸虫含有一只产卵的雌虫。\n\n基本原理：\n- 循环阳极抗原（CAA）由成年血吸虫对释放。在稳态下，抗原浓度动力学遵循一级清除，并通过每对血吸虫的恒定产生速率来维持。具体而言，使用稳态质量平衡对抗原进行建模，其中产生速率与血吸虫对的数量成正比，清除为一级动力学过程。\n- 粪便中检测到的虫卵来自于雌虫产生的总卵量的一部分；剩余的卵被保留在宿主组织中。将排泄的虫卵占总产卵量的比例视为物种特异性常数。\n\n数据和模型参数：\n- 测量的 Schistosoma mansoni 血浆CAA浓度：$C_{\\mathrm{sm}} = 0.050\\,\\text{mg/L}$。\n- 测量的 Schistosoma japonicum 血浆CAA浓度：$C_{\\mathrm{sj}} = 0.080\\,\\text{mg/L}$。\n- 抗原分布容积：$V_{d} = 3.0\\,\\text{L}$（假设为血浆分布）。\n- 抗原清除速率常数：$\\lambda = 2.0\\,\\text{day}^{-1}$（假设两种物种相同）。\n- Schistosoma mansoni 每对成虫的抗原产生速率：$q_{\\mathrm{sm}} = 0.005\\,\\text{mg/day/pair}$。\n- Schistosoma japonicum 每对成虫的抗原产生速率：$q_{\\mathrm{sj}} = 0.008\\,\\text{mg/day/pair}$。\n- Schistosoma mansoni 粪便中平均每克虫卵数（EPG）：$\\mathrm{EPG}_{\\mathrm{sm}} = 50\\,\\text{eggs/g}$。\n- Schistosoma japonicum 粪便中平均每克虫卵数（EPG）：$\\mathrm{EPG}_{\\mathrm{sj}} = 200\\,\\text{eggs/g}$。\n- 每日粪便排出量：$M = 200\\,\\text{g/day}$。\n- Schistosoma mansoni 排泄的虫卵占总产卵量的比例：$\\varepsilon_{\\mathrm{sm}} = 0.25$。\n- Schistosoma japonicum 排泄的虫卵占总产卵量的比例：$\\varepsilon_{\\mathrm{sj}} = 0.50$。\n\n任务：\n1. 使用循环抗原的稳态质量平衡模型（其中产生速率与成虫对数量成正比，清除为一级动力学过程），估算每种血吸虫的成虫对数量。\n2. 根据粪便数据和排泄比例，估算 Schistosoma mansoni 和 Schistosoma japonicum 每只雌虫的每日产卵量（$\\text{eggs/day/female}$）。\n3. 计算宿主层面的每日总虫卵负荷，即两种血吸虫每日产生的总虫卵数。\n\n将您的最终数值答案四舍五入至四位有效数字，并以“卵/天”为单位表示。仅提供宿主层面的每日总虫卵负荷作为最终数值答案。",
            "solution": "该问题陈述已经过评估并被认为是有效的。它在科学上基于寄生虫学和药代动力学的原理，问题设定良好，提供了所有必要信息，并且表述客观。该问题提供了一个清晰、可形式化的模型，可以使用给定的参数来求解。这些数值对于生物建模问题而言在合理范围内。\n\n解决方案按顺序处理三个指定的任务。\n\n任务1：估算每种血吸虫的成虫对数量。\n\n问题描述了循环阳极抗原（CAA）的稳态质量平衡。设 $A$ 为分布容积 $V_d$ 中抗原的总质量。则浓度 $C$ 为 $A/V_d$。抗原质量的变化率 $\\frac{dA}{dt}$ 是产生速率与清除速率之差。\n\n产生速率与成虫对数量 $N$ 成正比。对于给定物种，该速率为 $q \\times N$，其中 $q$ 是特定物种每对成虫的产生速率。\n清除是一级动力学过程，因此清除速率为 $\\lambda \\times A$，其中 $\\lambda$ 是清除速率常数。\n\n质量平衡方程为：\n$$ \\frac{dA}{dt} = (q \\times N) - (\\lambda \\times A) $$\n在稳态下，$\\frac{dA}{dt} = 0$。因此，产生速率等于清除速率：\n$$ q \\times N = \\lambda \\times A $$\n由于测量量是浓度 $C$，我们代入 $A = C \\times V_d$：\n$$ q \\times N = \\lambda \\times C \\times V_d $$\n求解成虫对数量 $N$，得到：\n$$ N = \\frac{\\lambda C V_d}{q} $$\n我们使用提供的数据将此公式应用于每种*Schistosoma*物种。\n\n对于*Schistosoma mansoni*：\n已知：$C_{\\mathrm{sm}} = 0.050\\,\\text{mg/L}$，$V_{d} = 3.0\\,\\text{L}$，$\\lambda = 2.0\\,\\text{day}^{-1}$，以及 $q_{\\mathrm{sm}} = 0.005\\,\\text{mg/day/pair}$。\n*S. mansoni*的成虫对数量 $N_{\\mathrm{sm}}$ 为：\n$$ N_{\\mathrm{sm}} = \\frac{\\lambda C_{\\mathrm{sm}} V_d}{q_{\\mathrm{sm}}} = \\frac{(2.0\\,\\text{day}^{-1}) \\times (0.050\\,\\text{mg/L}) \\times (3.0\\,\\text{L})}{0.005\\,\\text{mg/day/pair}} $$\n$$ N_{\\mathrm{sm}} = \\frac{0.3}{0.005}\\,\\text{pairs} = 60\\,\\text{pairs} $$\n\n对于*Schistosoma japonicum*：\n已知：$C_{\\mathrm{sj}} = 0.080\\,\\text{mg/L}$，$V_{d} = 3.0\\,\\text{L}$，$\\lambda = 2.0\\,\\text{day}^{-1}$，以及 $q_{\\mathrm{sj}} = 0.008\\,\\text{mg/day/pair}$。\n*S. japonicum*的成虫对数量 $N_{\\mathrm{sj}}$ 为：\n$$ N_{\\mathrm{sj}} = \\frac{\\lambda C_{\\mathrm{sj}} V_d}{q_{\\mathrm{sj}}} = \\frac{(2.0\\,\\text{day}^{-1}) \\times (0.080\\,\\text{mg/L}) \\times (3.0\\,\\text{L})}{0.008\\,\\text{mg/day/pair}} $$\n$$ N_{\\mathrm{sj}} = \\frac{0.48}{0.008}\\,\\text{pairs} = 60\\,\\text{pairs} $$\n\n任务2：估算每种血吸虫每只雌虫的每日产卵量。\n\n问题指出每对成虫含有一只雌虫，因此雌虫数量等于成虫对数量。设 $F$ 为每只雌虫的每日产卵量（单位为 $\\text{eggs/day/female}$）。\n一个物种每日产生的总虫卵数 $E_{\\mathrm{prod}}$ 为 $F \\times N$，其中 $N$ 是雌虫数量（或成虫对数量）。\n每日随粪便排出的总虫卵数 $E_{\\mathrm{excr}}$ 由粪便虫卵计数（$\\mathrm{EPG}$）和每日粪便质量（$M$）计算得出：\n$$ E_{\\mathrm{excr}} = \\mathrm{EPG} \\times M $$\n产生的虫卵与排泄的虫卵之间的联系是排泄比例 $\\varepsilon$：\n$$ E_{\\mathrm{excr}} = \\varepsilon \\times E_{\\mathrm{prod}} $$\n代入 $E_{\\mathrm{excr}}$ 和 $E_{\\mathrm{prod}}$ 的表达式，得到：\n$$ \\mathrm{EPG} \\times M = \\varepsilon \\times (F \\times N) $$\n求解每只雌虫的每日产卵量 $F$：\n$$ F = \\frac{\\mathrm{EPG} \\times M}{\\varepsilon \\times N} $$\n\n对于*Schistosoma mansoni*：\n已知：$\\mathrm{EPG}_{\\mathrm{sm}} = 50\\,\\text{eggs/g}$，$M = 200\\,\\text{g/day}$，$\\varepsilon_{\\mathrm{sm}} = 0.25$，以及 $N_{\\mathrm{sm}} = 60$。\n$$ F_{\\mathrm{sm}} = \\frac{(50\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.25 \\times 60\\,\\text{females}} = \\frac{10000\\,\\text{eggs/day}}{15\\,\\text{females}} = \\frac{2000}{3}\\,\\text{eggs/day/female} \\approx 666.7\\,\\text{eggs/day/female} $$\n\n对于*Schistosoma japonicum*：\n已知：$\\mathrm{EPG}_{\\mathrm{sj}} = 200\\,\\text{eggs/g}$，$M = 200\\,\\text{g/day}$，$\\varepsilon_{\\mathrm{sj}} = 0.50$，以及 $N_{\\mathrm{sj}} = 60$。\n$$ F_{\\mathrm{sj}} = \\frac{(200\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.50 \\times 60\\,\\text{females}} = \\frac{40000\\,\\text{eggs/day}}{30\\,\\text{females}} = \\frac{4000}{3}\\,\\text{eggs/day/female} \\approx 1333.3\\,\\text{eggs/day/female} $$\n\n任务3：计算宿主层面的每日总虫卵负荷。\n\n宿主层面的每日总虫卵负荷是两种血吸虫每日产生的总虫卵数之和。\n设 $E_{\\mathrm{burden}}$ 为该总负荷。\n$$ E_{\\mathrm{burden}} = E_{\\mathrm{prod, sm}} + E_{\\mathrm{prod, sj}} $$\n一个物种的总产卵数 $E_{\\mathrm{prod}}$ 可以更直接地从排泄数据中计算得出：\n$$ E_{\\mathrm{prod}} = \\frac{E_{\\mathrm{excr}}}{\\varepsilon} = \\frac{\\mathrm{EPG} \\times M}{\\varepsilon} $$\n\n对于*Schistosoma mansoni*：\n$$ E_{\\mathrm{prod, sm}} = \\frac{\\mathrm{EPG}_{\\mathrm{sm}} \\times M}{\\varepsilon_{\\mathrm{sm}}} = \\frac{(50\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.25} = \\frac{10000}{0.25}\\,\\text{eggs/day} = 40000\\,\\text{eggs/day} $$\n\n对于*Schistosoma japonicum*：\n$$ E_{\\mathrm{prod, sj}} = \\frac{\\mathrm{EPG}_{\\mathrm{sj}} \\times M}{\\varepsilon_{\\mathrm{sj}}} = \\frac{(200\\,\\text{eggs/g}) \\times (200\\,\\text{g/day})}{0.50} = \\frac{40000}{0.50}\\,\\text{eggs/day} = 80000\\,\\text{eggs/day} $$\n\n宿主层面的每日总虫卵负荷为两者之和：\n$$ E_{\\mathrm{burden}} = 40000\\,\\text{eggs/day} + 80000\\,\\text{eggs/day} = 120000\\,\\text{eggs/day} $$\n问题要求将最终答案四舍五入至四位有效数字。\n$$ 120000 = 1.200 \\times 10^5 $$\n该值以科学记数法表示，以明确显示四位有效数字。",
            "answer": "$$\\boxed{1.200 \\times 10^5}$$"
        },
        {
            "introduction": "虫卵计数是血吸虫病诊断和评估寄生虫负荷（如中所计算的）的关键。然而，由于寄生虫产卵和宿主排便的波动，每日的虫卵排出量变化很大，这给单次检测的可靠性带来了挑战。本练习将探讨如何使用统计模型来理解这种变异性，并量化重复检测如何显著提高诊断的准确性。",
            "id": "4631705",
            "problem": "一位居住在曼氏血吸虫病（Schistosoma mansoni）流行区的患者前来接受Kato–Katz厚涂片技术筛查。Kato–Katz模板每张涂片承载的粪便质量为 $g_{s} = 4.17 \\times 10^{-2}\\,\\mathrm{g}$。设每日每克粪便的虫卵数（EPG）为一个随机变量 $X_{d}$，该变量捕捉了因蠕虫繁殖力波动和宿主排便规律变化引起的每日排卵量的日常波动。假设以下基本前提：\n- 在给定 $X_{d}$ 的条件下，涂片上计数的虫卵数 $Y_{d}$ 服从均值为 $\\lambda_{d} = g_{s} X_{d}$ 的泊松分布（Poisson distribution），这与虫卵在被检粪便样本中的随机抽样一致。\n- 每日EPG $X_{d}$ 在各天之间独立同分布，服从形状参数为 $k$ 和尺度参数为 $\\theta$ 的伽马分布（Gamma distribution），这是一个经过充分检验的、用于描述过度离散的蠕虫卵计数的模型。该分布的均值为 $\\mathbb{E}[X_{d}] = k \\theta$，方差为 $\\mathrm{Var}(X_{d}) = k \\theta^{2}$。\n\n假设轻度血吸虫病的流行病学数据提供参数 $k = 2$ 和 $\\theta = 25\\,\\mathrm{eggs}/\\mathrm{g}$，因此平均感染负荷为 $k \\theta = 50\\,\\mathrm{eggs}/\\mathrm{g}$，且存在显著的日常波动。如果观察到至少一个虫卵（即 $Y_{d} \\geq 1$），则该涂片被称为“阳性”。\n\n仅使用上述原理，首先定性地论证，与$X_{d}$为非随机（即每日恒定）的假设情景相比，$X_{d}$的日常波动如何改变诊断灵敏度。然后，从第一性原理出发，推导当检查来自同一患者的$n$份独立日粪便涂片时，无条件检出概率的解析表达式。最后，使用给定的参数值，对$n = 1$和$n = 3$的情况计算该表达式的值，并计算将粪便样本数量从一份增加到三份时检出概率的绝对提升。将该提升值以小数形式表示，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "问题陈述被评估为有效。它在科学上基于已确立的蠕虫感染流行病学和统计模型，特别是使用泊松-伽马混合模型（其结果为负二项分布）来解释虫卵计数的过度离散现象。问题是适定的，所有必要的参数和分布都已明确定义，从而可以得出一个唯一的、有意义的解。不存在矛盾、模糊或事实错误。\n\n该解决方案按要求分三部分进行：定性论证、检出概率解析表达式的推导以及最终的数值计算。\n\n**第一部分：定性论证**\n\n问题要求在两种情景下比较诊断灵敏度（检测到至少一个虫卵的概率）：\n1.  实际情景，其中每日每克虫卵数（EPG）$X_{d}$是服从伽马分布的随机变量。\n2.  假设情景，其中 $X_{d}$ 是恒定的，等于其均值 $\\mathbb{E}[X_{d}] = k\\theta$。\n\n设 $p(x)$ 为在EPG为 $X_{d}=x$ 的条件下，在单张涂片上检测到至少一个虫卵的概率。涂片上的虫卵数 $Y_{d}$ 服从均值为 $\\lambda_{d} = g_{s}X_{d}$ 的泊松分布。因此，涂片为阳性的条件概率是：\n$$p(x) = P(Y_{d} \\geq 1 | X_{d}=x) = 1 - P(Y_{d}=0 | X_{d}=x) = 1 - \\exp(-\\lambda_{d}) = 1 - \\exp(-g_{s}x)$$\n这个函数 $p(x)$ 代表了对于给定EPG $x$ 的灵敏度。为了评估该函数是凸函数还是凹函数，我们计算它关于 $x$ 的二阶导数：\n$$p'(x) = g_{s}\\exp(-g_{s}x)$$\n$$p''(x) = -g_{s}^{2}\\exp(-g_{s}x)$$\n由于对于所有 $x$，$g_{s}^{2} > 0$ 且 $\\exp(-g_{s}x) > 0$，我们有 $p''(x)  0$。这表明函数 $p(x)$ 是一个严格凹函数。\n\n对于任何非常数随机变量 $X$ 和任何严格凹函数 $f$，根据詹森不等式（Jensen's inequality），有 $\\mathbb{E}[f(X)]  f(\\mathbb{E}[X])$。\n将此应用于我们的问题：\n- 实际情景中的灵敏度是条件灵敏度在 $X_{d}$ 分布上的期望值：$S_{\\text{actual}} = \\mathbb{E}[p(X_{d})] = \\mathbb{E}[1 - \\exp(-g_{s}X_{d})]$。\n- 假设情景中的灵敏度是在平均EPG处评估的灵敏度：$S_{\\text{hypothetical}} = p(\\mathbb{E}[X_{d}]) = 1 - \\exp(-g_{s}\\mathbb{E}[X_{d}])$。\n\n根据凹函数 $p(x)$ 的詹森不等式：\n$$\\mathbb{E}[p(X_{d})]  p(\\mathbb{E}[X_{d}])$$\n$$S_{\\text{actual}}  S_{\\text{hypothetical}}$$\n定性地讲，这意味着与虫卵排出量恒定等于均值的情况相比，每日排卵量($X_{d}$)的日常波动降低了单张涂片的平均诊断灵敏度。由于灵敏度函数 $p(x)$ 的凹性（饱和）特性，低排卵日（在这些日子里检测到的可能性极低）对降低平均灵敏度的影响，要大于高排卵日对其的提升影响。\n\n**第二部分：检出概率的解析表达式**\n\n我们需要求解检查 $n$ 份独立日粪便涂片时的无条件检出概率。设该概率为 $P_{n}$。它是所有 $n$ 张涂片均为阴性的互补事件的概率。\n$$P_{n} = 1 - P(\\text{all } n \\text{ smears are negative})$$\n由于每日虫卵计数 $X_{d}$ 是独立同分布的，因此不同日期的涂片结果也是相互独立的。\n$$P_{n} = 1 - [P(\\text{a single smear is negative})]^{n}$$\n如果 $Y_{d} = 0$，则单张涂片为阴性。我们必须求出无条件概率 $P(Y_{d}=0)$。这可以通过将条件概率 $P(Y_{d}=0 | X_{d}=x)$ 对 $X_{d}$ 的概率分布进行积分来得到。\n条件概率为 $P(Y_{d}=0 | X_{d}=x) = \\exp(-g_{s}x)$。\n服从形状参数为 $k$ 和尺度参数为 $\\theta$ 的伽马分布的 $X_{d}$ 的概率密度函数（PDF）为：\n$$f_{X_d}(x; k, \\theta) = \\frac{x^{k-1}\\exp(-x/\\theta)}{\\Gamma(k)\\theta^{k}} \\quad \\text{for } x > 0$$\n零计数的无条件概率是条件概率的期望：\n$$P(Y_{d}=0) = \\mathbb{E}[P(Y_{d}=0 | X_{d})] = \\int_{0}^{\\infty} P(Y_{d}=0 | X_{d}=x) f_{X_d}(x; k, \\theta) \\,dx$$\n$$P(Y_{d}=0) = \\int_{0}^{\\infty} \\exp(-g_{s}x) \\frac{x^{k-1}\\exp(-x/\\theta)}{\\Gamma(k)\\theta^{k}} \\,dx$$\n$$P(Y_{d}=0) = \\frac{1}{\\Gamma(k)\\theta^{k}} \\int_{0}^{\\infty} x^{k-1}\\exp\\left(-\\left(g_{s} + \\frac{1}{\\theta}\\right)x\\right) \\,dx$$\n$$P(Y_{d}=0) = \\frac{1}{\\Gamma(k)\\theta^{k}} \\int_{0}^{\\infty} x^{k-1}\\exp\\left(-\\frac{1+g_{s}\\theta}{\\theta}x\\right) \\,dx$$\n该积分具有伽马分布核的形式。我们知道，对于形状参数为 $\\alpha$ 和尺度参数为 $\\beta$ 的伽马分布，有 $\\int_{0}^{\\infty} t^{\\alpha-1}\\exp(-t/\\beta) \\,dt = \\Gamma(\\alpha)\\beta^{\\alpha}$。\n在我们的例子中，$\\alpha = k$，速率参数为 $\\frac{1+g_{s}\\theta}{\\theta}$，因此尺度参数为 $\\beta = \\frac{\\theta}{1+g_{s}\\theta}$。\n将此代入积分的计算中：\n$$\\int_{0}^{\\infty} x^{k-1}\\exp\\left(-\\frac{1+g_{s}\\theta}{\\theta}x\\right) \\,dx = \\Gamma(k) \\left(\\frac{\\theta}{1+g_{s}\\theta}\\right)^{k}$$\n现在将此结果代回 $P(Y_{d}=0)$ 的表达式中：\n$$P(Y_{d}=0) = \\frac{1}{\\Gamma(k)\\theta^{k}} \\left[ \\Gamma(k) \\left(\\frac{\\theta}{1+g_{s}\\theta}\\right)^{k} \\right] = \\left(\\frac{\\theta}{\\theta(1+g_{s}\\theta)}\\right)^{k} = (1+g_{s}\\theta)^{-k}$$\n这是单张涂片为阴性的概率。所有 $n$ 张涂片均为阴性的概率是 $[(1+g_{s}\\theta)^{-k}]^n = (1+g_{s}\\theta)^{-nk}$。\n因此，用 $n$ 张涂片进行检测的无条件检出概率为：\n$$P_{n} = 1 - (1+g_{s}\\theta)^{-nk}$$\n\n**第三部分：数值计算**\n\n给定的参数值为：\n- 粪便质量: $g_{s} = 4.17 \\times 10^{-2}$\n- 伽马形状参数: $k = 2$\n- 伽马尺度参数: $\\theta = 25$\n\n首先，我们计算无量纲积 $g_{s}\\theta$：\n$$g_{s}\\theta = (4.17 \\times 10^{-2}) \\times 25 = 0.0417 \\times 25 = 1.0425$$\n检出概率的公式变为：\n$$P_{n} = 1 - (1+1.0425)^{-2n} = 1 - (2.0425)^{-2n}$$\n\n现在，我们对 $n=1$ 和 $n=3$ 进行计算：\n对于 $n=1$：\n$$P_{1} = 1 - (2.0425)^{-2(1)} = 1 - (2.0425)^{-2} = 1 - \\frac{1}{4.17180625} \\approx 1 - 0.23970344 = 0.76029656$$\n对于 $n=3$：\n$$P_{3} = 1 - (2.0425)^{-2(3)} = 1 - (2.0425)^{-6} = 1 - \\left((2.0425)^{2}\\right)^{-3} \\approx 1 - (4.17180625)^{-3}$$\n$$P_{3} \\approx 1 - (72.585095)^{-1} \\approx 1 - 0.01377685 = 0.98622315$$\n\n最后，我们计算从 $n=1$ 到 $n=3$ 检出概率的绝对提升：\n$$\\text{Improvement} = P_{3} - P_{1} \\approx 0.98622315 - 0.76029656 = 0.22592659$$\n将此结果四舍五入至四位有效数字，得到 $0.2259$。",
            "answer": "$$\n\\boxed{0.2259}\n$$"
        },
        {
            "introduction": "在了解了如何量化个体感染和应对诊断不确定性之后，公共卫生的重点转向了在群体层面控制疾病。本练习将指导你构建一个数学模型，以预测大规模药物干预（MDA）的效果。通过一个基于治疗覆盖率和药物疗效的简单递推关系，我们可以模拟并预测多年干预后疾病流行率的下降趋势。",
            "id": "4631761",
            "problem": "一个社区存在由血吸虫 (Schistosoma) 物种引起的血吸虫病地方性流行。考虑一项使用吡喹酮 (praziquantel) 的年度大规模药物治疗 (MDA) 运动，其中大规模药物治疗 (MDA) 定义为每年治疗总人口的一部分，比例为 $c$，无论个体的感染状况如何。治疗有效性定义为接受治疗的受感染个体被治愈的概率 $e$。患病率定义为在特定时间受感染个体的比例 $p_t \\in [0,1]$，其中 $t$ 为年份索引（例如，$t = 0$ 表示任何 MDA 开始前的基线年份）。假设个体之间和年份之间相互独立，只有受感染的个体才能通过治疗被治愈，在测量区间内各年度治疗回合之间没有再感染或自发清除，并且测量在每个年度 MDA 回合后立即进行。\n\n仅使用这些基本定义，从第一性原理推导出一个原则性的更新规则，用于计算从基线患病率 $p_0$ 开始，每个年度 MDA 回合后立即的预期患病率。然后实施此规则，模拟 $n$ 年内的患病率轨迹，给定参数 $(p_0, c, e, n)$，生成列表 $\\{p_1, p_2, \\dots, p_n\\}$。\n\n将所有患病率值表示为区间 $[0,1]$ 内的小数，四舍五入到六位小数。没有物理单位。不涉及角度。\n\n您的程序必须运行以下测试套件，并按指定的最终输出格式汇总结果：\n\n- 测试用例 1 (正常路径): $(p_0, c, e, n) = (0.50, 0.75, 0.85, 3)$。\n- 测试用例 2 (边界，零覆盖率): $(p_0, c, e, n) = (0.50, 0.00, 0.85, 3)$。\n- 测试用例 3 (边界，完全覆盖率和有效性): $(p_0, c, e, n) = (0.50, 1.00, 1.00, 3)$。\n- 测试用例 4 (边缘情况，零基线): $(p_0, c, e, n) = (0.00, 0.75, 0.85, 3)$。\n- 测试用例 5 (一般部分值，更长时间范围): $(p_0, c, e, n) = (0.90, 0.50, 0.50, 5)$。\n- 测试用例 6 (边界，零有效性): $(p_0, c, e, n) = (0.50, 0.75, 0.00, 3)$。\n- 测试用例 7 (边界，零回合): $(p_0, c, e, n) = (0.50, 0.75, 0.85, 0)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素是对应测试用例的患病率轨迹列表，按顺序排列，并且每个患病率值都四舍五入到六位小数（例如：\"[[p1_case1,p2_case1,...],[p1_case2,...],...]\"）。",
            "solution": "该问题要求从第一性原理推导出一个数学模型，以描述在特定公共卫生干预策略下疾病患病率的逐年变化，然后实施该模型以模拟给定情景下的轨迹。\n\n我们首先按照问题陈述中的规定定义变量和参数。\n设 $p_t$ 为感染患病率，定义为受感染个体占总人口的比例。索引 $t$ 代表年份，测量在年度干预后立即进行。设 $p_0$ 为首次干预前的基线患病率。\n干预是一项大规模药物治疗 (MDA) 运动，具有以下参数：\n- $c \\in [0,1]$：治疗覆盖率，表示每年接受治疗的总人口比例。\n- $e \\in [0,1]$：治疗有效性，表示接受治疗的受感染个体被治愈的概率。\n\n该模型建立在指定测量区间的几个关键假设之上：\n1.  没有再感染。\n2.  没有感染的自发清除。\n3.  人口是封闭的（没有出生、死亡或迁移）。\n4.  治疗是相对于感染状况随机进行的。\n5.  事件在个体之间和年份之间是独立的。\n\n我们的目标是推导一个更新规则，将第 $t$ 年干预后的患病率（表示为 $p_t$）与该次干预前的患病率 $p_{t-1}$（即第 $t-1$ 年干预后的患病率，假定干预之间没有变化）联系起来。\n\n让我们考虑第 $t$ 年初，MDA 回合开始之前的人口状态。患病率为 $p_{t-1}$。\n在第 $t$ 年的 MDA 期间，总人口的一部分（比例为 $c$）被选中接受治疗。由于是随机选择，此过程与个体的感染状况无关。我们可以根据两个独立属性的组合将人口分为四个不同的组：感染状况（患病率 $p_{t-1}$）和治疗状况（覆盖率 $c$）。\n\n每个组在总人口中所占的比例为：\n1.  受感染且接受治疗：受感染的人口比例为 $p_{t-1}$，接受治疗的比例为 $c$。既受感染又接受治疗的比例是这些概率的乘积，$p_{t-1} \\times c$。\n2.  受感染但未接受治疗：受感染的比例为 $p_{t-1}$，未接受治疗的比例为 $(1-c)$。既受感染又未接受治疗的比例是 $p_{t-1} \\times (1-c)$。\n3.  未受感染但接受治疗：未受感染的比例为 $(1-p_{t-1})$，接受治疗的比例为 $c$。此组中的比例为 $(1-p_{t-1}) \\times c$。\n4.  未受感染且未接受治疗：未受感染的比例为 $(1-p_{t-1})$，未接受治疗的比例为 $(1-c)$。此组中的比例为 $(1-p_{t-1}) \\times (1-c)$。\n\n新的患病率 $p_t$ 是在治疗实施后立即仍然受感染的个体占总人口的比例。我们通过对干预后可能包含受感染个体的各组的贡献求和来计算这个值。\n\n-   来自“受感染且接受治疗”组（比例为 $p_{t-1}c$）：治疗有效性 $e$ 是被治愈的概率。因此，*未*被治愈的概率是 $(1-e)$。来自该组仍然受感染的个体占总人口的比例是 $(p_{t-1}c) \\times (1-e)$。\n-   来自“受感染但未接受治疗”组（比例为 $p_{t-1}(1-c)$）：这些个体没有接受治疗，并且根据无自发清除的假设，他们都仍然受感染。来自该组仍然受感染的个体占总人口的比例是 $p_{t-1}(1-c)$。\n-   另外两组由未受感染的个体组成，由于治疗不会导致感染，它们对干预后患病率的贡献为 $0$。\n\n总患病率 $p_t$ 是仍然受感染的人口比例之和：\n$$\np_t = [p_{t-1}c \\times (1-e)] + [p_{t-1}(1-c)]\n$$\n\n我们可以从表达式中提出因子 $p_{t-1}$：\n$$\np_t = p_{t-1} [c(1-e) + (1-c)]\n$$\n\n简化括号内的项：\n$$\np_t = p_{t-1} [c - ce + 1 - c]\n$$\n$$\np_t = p_{t-1} (1 - ce)\n$$\n\n这就是第一性原理更新规则。它是一个线性递推关系，表明一年的患病率是前一年患病率的一个恒定比例。因子 $(1 - ce)$ 表示在给定年份内未被清除感染的受感染个体比例。\n\n这种关系描述了一个几何级数。对于任何年份 $t \\ge 1$，患病率 $p_t$ 可以直接用基线患病率 $p_0$ 表示：\n$$\np_t = p_0 (1 - ce)^t\n$$\n\n为了实施模拟，我们将从初始患病率 $p_0$ 开始，迭代更新规则 $n$ 次，以生成 MDA 后患病率序列 $\\{p_1, p_2, \\dots, p_n\\}$。在模拟的每一步中，我们计算 $p_t = p_{t-1}(1-ce)$，并在计算过程中保持完整的浮点数精度。最终列表中的值将按照输出格式要求四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements an update rule for schistosomiasis prevalence\n    under annual Mass Drug Administration (MDA).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (p0, c, e, n)\n        (0.50, 0.75, 0.85, 3),    # Test case 1\n        (0.50, 0.00, 0.85, 3),    # Test case 2\n        (0.50, 1.00, 1.00, 3),    # Test case 3\n        (0.00, 0.75, 0.85, 3),    # Test case 4\n        (0.90, 0.50, 0.50, 5),    # Test case 5\n        (0.50, 0.75, 0.00, 3),    # Test case 6\n        (0.50, 0.75, 0.85, 0)     # Test case 7\n    ]\n\n    all_results = []\n    for p0, c, e, n in test_cases:\n        # p0: baseline prevalence\n        # c: treatment coverage\n        # e: treatment efficacy\n        # n: number of years (MDA rounds)\n\n        # The recurrence relation is p_t = p_{t-1} * (1 - c*e)\n        reduction_factor = 1.0 - c * e\n        \n        # Initialize the prevalence with the baseline value.\n        current_prevalence = float(p0)\n        \n        trajectory = []\n        for _ in range(n):\n            # Calculate the prevalence for the next year.\n            # Full precision is carried during calculation.\n            current_prevalence *= reduction_factor\n            trajectory.append(current_prevalence)\n        \n        all_results.append(trajectory)\n\n    # Format the final output string according to the problem specification.\n    # Each prevalence value must be a string rounded to six decimal places.\n    # The final string is a list of lists, with no spaces.\n    \n    # This manual construction is necessary to satisfy the specific formatting rules\n    # for numbers (fixed 6 decimal places) and list structure (no whitespace),\n    # which standard `str()` on lists of floats does not guarantee.\n    \n    case_strings = []\n    for traj in all_results:\n        # Format each number in the trajectory to a string with 6 decimal places.\n        num_strings = [f\"{p:.6f}\" for p in traj]\n        # Join the numbers into a string representation of a list.\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    # Join all case strings into the final output format.\n    final_output_string = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}