{
    "hands_on_practices": [
        {
            "introduction": "Understanding Epstein-Barr virus begins with the clinical picture it presents. This problem places you in the role of a clinician faced with a classic case of infectious mononucleosis, challenging you to apply fundamental virologic and immunologic principles to navigate a realistic diagnostic dilemma . By working through the differential diagnosis and evaluating the utility of various tests, you will gain a practical appreciation for how the timing of the immune response and the virus's specific cellular tropism guide modern diagnostics.",
            "id": "4629444",
            "problem": "A 21-year-old college student presents with 6 days of fever, severe fatigue, sore throat, and painful neck swelling. Examination shows marked tonsillar exudates, tender posterior cervical lymphadenopathy, and a palpable, mildly enlarged spleen. There are petechiae on the soft palate. Laboratory studies reveal leukocytosis of $11.8 \\times 10^9/\\text{L}$ with $62\\%$ lymphocytes and $18\\%$ atypical lymphocytes, platelets $125 \\times 10^9/\\text{L}$, and mildly elevated aspartate aminotransferase and alanine aminotransferase. A rapid antigen detection test for Group A Streptococcus is negative. A heterophile antibody agglutination test performed on illness day 5 is negative. Two days ago he began amoxicillin for presumed bacterial pharyngitis, after which he developed a diffuse, nonpruritic morbilliform rash.\n\nUsing fundamental immunologic and virologic principles—namely, that primary viral infections elicit an initial immunoglobulin M (IgM) response followed by class switching to immunoglobulin G (IgG), that Epstein-Barr virus (EBV) infects B lymphocytes via complement receptor 2 (cluster of differentiation 21) inducing polyclonal antibody production including heterophile antibodies, and that the timing and specificity of serologic and molecular assays differ across etiologies of mononucleosis-like syndromes—select the single best next diagnostic test to confirm the most likely diagnosis.\n\nA. Repeat heterophile antibody (Monospot) testing in 2 weeks\n\nB. Epstein-Barr virus viral capsid antigen (VCA) IgM serology\n\nC. Human immunodeficiency virus (HIV) ribonucleic acid (RNA) quantitative polymerase chain reaction (PCR)\n\nD. Cytomegalovirus (CMV) IgM and IgG serology with IgG avidity testing\n\nE. Throat culture for Group A Streptococcus (Streptococcus pyogenes)",
            "solution": "The clinical presentation is overwhelmingly suggestive of acute infectious mononucleosis (IM) caused by the Epstein-Barr virus (EBV). The key features supporting this diagnosis are: the classic triad of fever, pharyngitis, and posterior cervical lymphadenopathy; significant fatigue; splenomegaly; palatal petechiae; and laboratory findings of lymphocytosis with a high percentage ($18\\%$) of atypical lymphocytes (activated $CD8^+$ T-cells responding to EBV-infected B-cells).\n\nTwo crucial pieces of information solidify EBV as the most probable etiology:\n1.  **The Amoxicillin Rash**: The development of a diffuse morbilliform rash after administration of an aminopenicillin (like amoxicillin) occurs in over $90\\%$ of patients with acute EBV infection. This is a highly specific, though not entirely pathognomonic, finding.\n2.  **The Negative Heterophile Antibody Test**: The heterophile antibody test (e.g., Monospot test) is often used as a rapid screen for IM. These antibodies are IgM class immunoglobulins produced as a result of the polyclonal B-cell activation induced by EBV. However, the sensitivity of this test is imperfect. In the first week of illness, up to $25\\%$ of patients with acute EBV will have a negative test. Furthermore, approximately $10\\%$ of adults with primary EBV infection never develop detectable heterophile antibodies. Therefore, a negative result, especially one obtained early in the illness (day $5$), does not rule out EBV infection.\n\nThe task is to select the single best next test to *confirm* this diagnosis. The ideal test must be more sensitive and specific for acute EBV than the heterophile test. This requires the use of EBV-specific serology. The immune response to primary EBV infection involves the sequential production of antibodies against specific viral antigens:\n*   **Immunoglobulin M (IgM) to Viral Capsid Antigen (VCA)**: Anti-VCA IgM appears very early in the acute infection and typically disappears within $1$ to $3$ months. Its presence is the most reliable serological marker of a primary, acute EBV infection.\n*   **Immunoglobulin G (IgG) to Viral Capsid Antigen (VCA)**: Anti-VCA IgG also appears early in the infection, peaks at $2$ to $4$ weeks, and then persists for life, indicating current or past infection.\n*   **Antibody to Epstein-Barr Nuclear Antigen (EBNA)**: Anti-EBNA antibodies develop late in the convalescent phase, typically $6$ to $12$ weeks after the onset of symptoms, and also persist for life. The absence of anti-EBNA in the presence of anti-VCA IgG is indicative of a recent primary infection.\n\nGiven this, the most direct and reliable way to confirm an acute primary EBV infection is to test for anti-VCA IgM.\n\n**A. Repeat heterophile antibody (Monospot) testing in 2 weeks**\nThis approach is based on the principle that the sensitivity of the heterophile test increases as the illness progresses. Indeed, the test might become positive if repeated in the third week of illness. However, this strategy has two major drawbacks. First, it delays a definitive diagnosis by two weeks. Second, as noted, a subset of patients with genuine EBV mononucleosis will never produce heterophile antibodies. A second negative test would therefore still leave ambiguity, necessitating EBV-specific serology anyway. It is not the most efficient or definitive approach.\n**Verdict: Incorrect**\n\n**B. Epstein-Barr virus viral capsid antigen (VCA) IgM serology**\nThis test directly assays for the presence of IgM antibodies specific to the EBV VCA. As established, anti-VCA IgM is the gold standard serologic marker for acute primary EBV infection. It is highly sensitive and specific, appearing early in the course of the disease. A positive result would confirm the clinically suspected diagnosis of acute EBV mononucleosis, resolving the ambiguity of the negative heterophile test. This is the most direct and accurate next step.\n**Verdict: Correct**\n\n**C. Human immunodeficiency virus (HIV) ribonucleic acid (RNA) quantitative polymerase chain reaction (PCR)**\nAcute retroviral syndrome due to primary HIV infection can mimic infectious mononucleosis. Therefore, HIV is an important consideration in the differential diagnosis of any \"mono-like\" illness. An HIV RNA PCR can detect the virus during the serological window period before antibodies are detectable. However, the patient's clinical picture, especially the amoxicillin-induced rash, points so strongly towards EBV that it is the *most likely* diagnosis. The logical diagnostic algorithm is to first confirm or rule out the most probable cause. Testing for HIV would be an appropriate subsequent step if EBV serology were negative or if specific risk factors for HIV were present. It is not the *best next* test.\n**Verdict: Incorrect**\n\n**D. Cytomegalovirus (CMV) IgM and IgG serology with IgG avidity testing**\nCMV is the most common cause of heterophile-negative infectious mononucleosis. However, CMV mononucleosis is typically associated with less severe pharyngitis and less prominent cervical lymphadenopathy compared to EBV. Most importantly, the characteristic rash after amoxicillin is strongly associated with EBV, not CMV. While CMV is a valid differential diagnosis, it is significantly less likely than EBV in this specific clinical context. Consequently, testing for CMV is not the best *next* step; it should be considered if tests for the more probable cause (EBV) are negative.\n**Verdict: Incorrect**\n\n**E. Throat culture for Group A Streptococcus (Streptococcus pyogenes)**\nThe patient has exudative pharyngitis, for which Group A Streptococcus (GAS) is a primary bacterial cause. However, the rapid antigen detection test (RADT) for GAS was negative. While a throat culture is more sensitive than a RADT, the overall clinical syndrome (profound fatigue, splenomegaly, atypical lymphocytosis, transaminitis, amoxicillin rash) is not explained by a localized GAS infection. The findings are characteristic of a systemic viral illness. Pursuing a bacterial culture for a less likely diagnosis that does not fit the full clinical picture is not the best next diagnostic step.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "At the heart of EBV's ability to promote cell survival and proliferation is its arsenal of latent proteins that hijack host signaling pathways. This exercise focuses on Latent Membrane Protein 1 (LMP1), a key viral oncoprotein that mimics a constitutively active host receptor to drive cell growth . By building a simple quantitative model, you will calculate the downstream effect of LMP1 on the $NF-\\kappa B$ pathway, a crucial regulator of inflammation and cell survival, providing insight into the molecular basis of EBV-driven transformation.",
            "id": "4629390",
            "problem": "Epstein-Barr virus (EBV) Latent Membrane Protein 1 (LMP1) is a constitutively active signaling adaptor that can activate the Nuclear Factor kappa-light-chain-enhancer of activated B cells ($NF-\\kappa B$) pathway by recruiting and stimulating $I\\kappa B$ kinase (IKK), which phosphorylates inhibitor of $\\kappa$B ($I\\kappa B$), leading to $I\\kappa B$ degradation and nuclear translocation of $NF-\\kappa B$. Consider a simplified, steady-state model of $NF-\\kappa B$ activation in a single EBV-positive cell where the following assumptions hold:\n\n- IKK activity is a Hill-type function of LMP1 concentration $L$, given by $A(L) = \\dfrac{L^{n}}{K^{n} + L^{n}}$, where $n$ is the cooperativity exponent and $K$ is the half-activation constant.\n- $I\\kappa B$ is produced at a constant rate $s$ and degraded with a first-order rate constant $d(L) = d_{0} + d_{1} A(L)$, set by IKK activity. At steady state, the total $I\\kappa B$ concentration is $I_{\\text{tot}} = \\dfrac{s}{d(L)}$.\n- Cytosolic $NF-\\kappa B$ and $I\\kappa B$ bind with $1:1$ stoichiometry to form a complex $C$, with dissociation constant $K_{d}$ defined by the law of mass action, $K_{d} = \\dfrac{[N_{\\text{free}}][I_{\\text{free}}]}{[C]}$, where $[N_{\\text{free}}]$ and $[I_{\\text{free}}]$ are the free cytosolic concentrations of $NF-\\kappa B$ and $I\\kappa B$, respectively. Mass conservation gives $N_{\\text{tot}} = [N_{\\text{free}}] + [C]$ and $I_{\\text{tot}} = [I_{\\text{free}}] + [C]$, where $N_{\\text{tot}}$ is the total cytosolic $NF-\\kappa B$.\n- Free cytosolic $NF-\\kappa B$ enters the nucleus with first-order rate constant $k_{\\text{in}}$, and nuclear $NF-\\kappa B$ exits to the cytosol with rate constant $k_{\\text{out}}$. At steady state, nuclear $NF-\\kappa B$ concentration $N_{\\text{nuc}}$ satisfies $k_{\\text{in}} [N_{\\text{free}}] = k_{\\text{out}} N_{\\text{nuc}}$.\n\nGiven the parameter values $L = 40\\,\\mathrm{nM}$, $K = 30\\,\\mathrm{nM}$, $n = 2$, $s = 60\\,\\mathrm{nM}\\,\\mathrm{min}^{-1}$, $d_{0} = 0.2\\,\\mathrm{min}^{-1}$, $d_{1} = 0.8\\,\\mathrm{min}^{-1}$, $N_{\\text{tot}} = 100\\,\\mathrm{nM}$, $K_{d} = 10\\,\\mathrm{nM}$, $k_{\\text{in}} = 0.5\\,\\mathrm{min}^{-1}$, and $k_{\\text{out}} = 0.2\\,\\mathrm{min}^{-1}$, compute the steady-state nuclear $NF-\\kappa B$ concentration $N_{\\text{nuc}}$. Round your answer to four significant figures and express the final value in $\\mathrm{nM}$.",
            "solution": "The overall goal is to find $N_{\\text{nuc}}$, which at steady state is given by the relation $k_{\\text{in}} [N_{\\text{free}}] = k_{\\text{out}} N_{\\text{nuc}}$. This can be rearranged to $N_{\\text{nuc}} = \\frac{k_{\\text{in}}}{k_{\\text{out}}} [N_{\\text{free}}]$. Thus, our primary task is to determine the concentration of free cytosolic NF-$\\kappa$B, $[N_{\\text{free}}]$.\n\nFirst, we compute the IKK activity, $A(L)$, which is a Hill-type function of the Latent Membrane Protein 1 (LMP1) concentration, $L$. The given parameters are $L = 40\\,\\mathrm{nM}$, $K = 30\\,\\mathrm{nM}$, and the cooperativity exponent $n=2$.\n$$A(L) = \\dfrac{L^{n}}{K^{n} + L^{n}} = \\dfrac{40^{2}}{30^{2} + 40^{2}} = \\dfrac{1600}{900 + 1600} = \\dfrac{1600}{2500} = 0.64$$\nThe activity $A(L)$ is a dimensionless quantity.\n\nSecond, we determine the first-order degradation rate constant for $I\\kappa B$, $d(L)$, which is a linear function of IKK activity $A(L)$. The base degradation rate is $d_{0} = 0.2\\,\\mathrm{min}^{-1}$ and the IKK-dependent rate modulation is scaled by $d_{1} = 0.8\\,\\mathrm{min}^{-1}$.\n$$d(L) = d_{0} + d_{1} A(L) = 0.2\\,\\mathrm{min}^{-1} + (0.8\\,\\mathrm{min}^{-1})(0.64) = 0.2\\,\\mathrm{min}^{-1} + 0.512\\,\\mathrm{min}^{-1} = 0.712\\,\\mathrm{min}^{-1}$$\n\nThird, using the degradation rate $d(L)$, we find the total steady-state concentration of $I\\kappa B$, $I_{\\text{tot}}$. This is determined by the balance between the constant production rate $s = 60\\,\\mathrm{nM}\\,\\mathrm{min}^{-1}$ and the first-order degradation.\n$$I_{\\text{tot}} = \\dfrac{s}{d(L)} = \\dfrac{60\\,\\mathrm{nM}\\,\\mathrm{min}^{-1}}{0.712\\,\\mathrm{min}^{-1}} \\approx 84.2696629\\,\\mathrm{nM}$$\n\nFourth, we calculate the concentration of free cytosolic NF-$\\kappa$B, $[N_{\\text{free}}]$. This requires solving the system of equations that describe the binding equilibrium between NF-$\\kappa$B and $I\\kappa B$:\n$1.$ Mass conservation for NF-$\\kappa$B: $N_{\\text{tot}} = [N_{\\text{free}}] + [C]$\n$2.$ Mass conservation for $I\\kappa B$: $I_{\\text{tot}} = [I_{\\text{free}}] + [C]$\n$3.$ Law of mass action: $K_{d} = \\dfrac{[N_{\\text{free}}][I_{\\text{free}}]}{[C]}$\nFrom the mass conservation equations, we can express the complex concentration $[C]$ and free $I\\kappa B$ concentration $[I_{\\text{free}}]$ in terms of $[N_{\\text{free}}]$:\n$[C] = N_{\\text{tot}} - [N_{\\text{free}}]$\n$[I_{\\text{free}}] = I_{\\text{tot}} - [C] = I_{\\text{tot}} - (N_{\\text{tot}} - [N_{\\text{free}}]) = I_{\\text{tot}} - N_{\\text{tot}} + [N_{\\text{free}}]$\nSubstituting these into the dissociation constant expression:\n$$K_{d} = \\dfrac{[N_{\\text{free}}](I_{\\text{tot}} - N_{\\text{tot}} + [N_{\\text{free}}])}{N_{\\text{tot}} - [N_{\\text{free}}]}$$\nThis expression can be rearranged into a quadratic equation for $[N_{\\text{free}}]$ of the form $ax^2 + bx + c = 0$, where $x = [N_{\\text{free}}]$:\n$$[N_{\\text{free}}]^{2} + (I_{\\text{tot}} - N_{\\text{tot}} + K_{d})[N_{\\text{free}}] - K_{d} N_{\\text{tot}} = 0$$\nWe substitute the known and calculated parameter values: $I_{\\text{tot}} \\approx 84.26966\\,\\mathrm{nM}$, $N_{\\text{tot}} = 100\\,\\mathrm{nM}$, and $K_{d} = 10\\,\\mathrm{nM}$.\n$$[N_{\\text{free}}]^{2} + (84.26966 - 100 + 10)[N_{\\text{free}}] - (10)(100) = 0$$\n$$[N_{\\text{free}}]^{2} - 5.73034[N_{\\text{free}}] - 1000 = 0$$\nWe solve this quadratic equation using the formula $x = \\dfrac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=1$, $b \\approx -5.73034$, and $c=-1000$.\n$$[N_{\\text{free}}] = \\dfrac{5.73034 \\pm \\sqrt{(-5.73034)^2 - 4(1)(-1000)}}{2(1)}$$\n$$[N_{\\text{free}}] = \\dfrac{5.73034 \\pm \\sqrt{32.83679 + 4000}}{2} = \\dfrac{5.73034 \\pm \\sqrt{4032.83679}}{2} = \\dfrac{5.73034 \\pm 63.50462}{2}$$\nSince concentration must be a physically meaningful positive value, we take the positive root:\n$$[N_{\\text{free}}] = \\dfrac{5.73034 + 63.50462}{2} = \\dfrac{69.23496}{2} \\approx 34.61748\\,\\mathrm{nM}$$\n\nFinally, we compute the steady-state nuclear NF-$\\kappa$B concentration, $N_{\\text{nuc}}$, using the nuclear transport balance. The rate constants are $k_{\\text{in}} = 0.5\\,\\mathrm{min}^{-1}$ and $k_{\\text{out}} = 0.2\\,\\mathrm{min}^{-1}$.\n$$N_{\\text{nuc}} = \\dfrac{k_{\\text{in}}}{k_{\\text{out}}} [N_{\\text{free}}] = \\dfrac{0.5\\,\\mathrm{min}^{-1}}{0.2\\,\\mathrm{min}^{-1}} \\times 34.61748\\,\\mathrm{nM} = 2.5 \\times 34.61748\\,\\mathrm{nM} \\approx 86.5437\\,\\mathrm{nM}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$N_{\\text{nuc}} \\approx 86.54\\,\\mathrm{nM}$$",
            "answer": "$$\\boxed{86.54}$$"
        },
        {
            "introduction": "EBV-associated oncogenesis is a complex process involving the interplay of viral genes, host epigenetics, and the cellular environment. This final practice reflects the cutting-edge of viral oncology, where researchers integrate diverse 'multi-omic' data to build a comprehensive picture of a tumor's state . You will implement a probabilistic framework based on Bayes' theorem to synthesize multiple lines of evidence—from viral gene expression to host cell methylation—into a single, powerful diagnostic score, demonstrating how bioinformatics is used to unravel the molecular signatures of cancer.",
            "id": "4629413",
            "problem": "Design and implement a program that integrates multi-omic indicators of Epstein-Barr virus (EBV) oncogenesis using a principled probabilistic framework grounded in first principles. Use the following base facts and assumptions, which are widely accepted in medical microbiology and biostatistics: (1) the Central Dogma of molecular biology implies that abundances of viral transcripts and proteins can causally modulate host cell phenotypes; (2) Epstein-Barr virus (EBV) latent gene products such as Latent Membrane Protein 1 (LMP1) and Epstein-Barr Nuclear Antigen 1 (EBNA1) are mechanistically linked to oncogenic signaling and episome maintenance; (3) epigenetic promoter hypermethylation of host tumor suppressor genes can silence gene expression and is observed in EBV-associated malignancies; (4) viral microRNA (miRNA) expression reflects viral regulatory activity in the host cell; (5) somatic mutation burden can be lower in virally driven tumors compared to carcinogen-driven ones; (6) conditional independence of features given the oncogenic state is assumed for tractability. Starting from Bayes’ theorem, let the oncogenic state be a binary variable $Y \\in \\{0,1\\}$, where $Y=1$ denotes EBV-driven oncogenesis. With prior probability $p_0$ for $Y=1$, prior odds are $O_0 = \\frac{p_0}{1-p_0}$. Under the conditional independence assumption, the posterior odds are the product of $O_0$ and per-feature likelihood ratios. The posterior probability is then $p = \\frac{O}{1+O}$, where $O$ is the posterior odds. Missing features contribute a neutral likelihood ratio of $1$.\n\nUse the following calibrated prior and per-feature likelihood ratios (Likelihood Ratio (LR)) consistent with EBV biology. The prior probability is $p_0 = 0.15$, so $O_0 = \\frac{0.15}{0.85}$. Features and their Likelihood Ratio binning rules are:\n\n- LMP1 expression in Transcripts Per Million (TPM), value $x$:\n  - $x = 0$: $\\text{LR} = 0.5$\n  - $0 < x < 1$: $\\text{LR} = 1.0$\n  - $1 \\le x < 10$: $\\text{LR} = 2.0$\n  - $x \\ge 10$: $\\text{LR} = 5.0$\n- EBNA1 expression in TPM, value $y$:\n  - $y = 0$: $\\text{LR} = 0.4$\n  - $0 < y < 5$: $\\text{LR} = 1.5$\n  - $y \\ge 5$: $\\text{LR} = 3.0$\n- Viral load in copies per cell, value $v$:\n  - $v < 0.1$: $\\text{LR} = 0.3$\n  - $0.1 \\le v < 1$: $\\text{LR} = 1.0$\n  - $1 \\le v \\le 5$: $\\text{LR} = 2.5$\n  - $v > 5$: $\\text{LR} = 4.0$\n- Average promoter methylation fraction of a tumor suppressor gene panel (unitless fraction between $0$ and $1$), value $m$:\n  - $m < 0.2$: $\\text{LR} = 0.8$\n  - $0.2 \\le m < 0.4$: $\\text{LR} = 1.2$\n  - $0.4 \\le m \\le 0.6$: $\\text{LR} = 1.8$\n  - $m > 0.6$: $\\text{LR} = 2.5$\n- Somatic mutation burden in mutations per megabase, value $b$:\n  - $b < 2$: $\\text{LR} = 1.5$\n  - $2 \\le b \\le 10$: $\\text{LR} = 1.0$\n  - $b > 10$: $\\text{LR} = 0.5$\n- Viral miRNA (microRNA) expression in counts per million (CPM), value $r$:\n  - $r < 10$: $\\text{LR} = 0.6$\n  - $10 \\le r < 100$: $\\text{LR} = 1.5$\n  - $r \\ge 100$: $\\text{LR} = 3.0$\n- B-cell activation score (dimensionless), value $a$:\n  - $a < 0.5$: $\\text{LR} = 0.9$\n  - $0.5 \\le a \\le 1.5$: $\\text{LR} = 1.2$\n  - $a > 1.5$: $\\text{LR} = 1.8$\n\nIf any feature is missing, treat it as contributing $\\text{LR} = 1.0$. Compute, for each test case, the posterior probability $p$ that $Y=1$ as a decimal rounded to four places. All physical units have been specified above.\n\nTest suite (each case is an ordered 7-tuple: $(\\text{LMP1\\_TPM}, \\text{EBNA1\\_TPM}, \\text{viral\\_load\\_copies\\_per\\_cell}, \\text{methylation\\_fraction}, \\text{mutation\\_burden\\_mut/Mb}, \\text{viral\\_miRNA\\_CPM}, \\text{activation\\_score})$):\n- Case $1$: $(15, 8, 6, 0.65, 1, 150, 1.8)$\n- Case $2$: $(0, 0, 0.05, 0.1, 15, 2, 0.3)$\n- Case $3$: $(5, 0.5, 0.5, 0.5, 12, 50, 1.0)$\n- Case $4$: $(1, 5, 1, 0.4, 2, 10, 0.5)$\n- Case $5$: $(9, 2, 4, 0.55, 3, \\text{None}, 0.7)$\n- Case $6$: $(0.2, 0, 0.2, 0.25, 0.5, 9.9, 0.49)$\n- Case $7$: $(12, 7, 3, 0.45, 30, 120, 1.4)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite, with each posterior probability rounded to four decimal places, for example, $[x_1,x_2,\\dots,x_7]$ where each $x_i$ is a decimal with exactly four digits after the decimal point.",
            "solution": "Let $Y$ be a binary random variable representing the oncogenic state, where $Y=1$ denotes EBV-driven oncogenesis and $Y=0$ denotes the absence of this state. The goal is to compute the posterior probability $P(Y=1 | E)$, where $E$ is the evidence provided by a set of $n$ features, $E = \\{F_1, F_2, \\dots, F_n\\}$.\n\nThe foundation of the model is Bayes' theorem, which can be expressed in terms of odds. The odds of an event $A$ are defined as $O(A) = \\frac{P(A)}{1-P(A)}$. The prior odds of oncogenesis are $O_{\\text{prior}} = O(Y=1) = \\frac{P(Y=1)}{1-P(Y=1)}$. Given the prior probability $p_0 = P(Y=1) = 0.15$, the prior odds are:\n$$\nO_0 = \\frac{p_0}{1-p_0} = \\frac{0.15}{1-0.15} = \\frac{0.15}{0.85} = \\frac{3}{17}\n$$\nThe posterior odds, $O_{\\text{posterior}} = O(Y=1 | E)$, are related to the prior odds by the likelihood ratio (LR) of the evidence $E$:\n$$\nO_{\\text{posterior}} = \\frac{P(E | Y=1)}{P(E | Y=0)} \\times O_{\\text{prior}}\n$$\nThe term $\\frac{P(E | Y=1)}{P(E | Y=0)}$ is the overall likelihood ratio for the full set of evidence. The problem specifies a critical simplifying assumption: the features $F_i$ are conditionally independent given the state $Y$. This assumption, characteristic of a Naive Bayes classifier, allows the decomposition of the overall likelihood ratio into the product of the individual likelihood ratios for each feature:\n$$\n\\frac{P(E | Y=1)}{P(E | Y=0)} = \\frac{P(F_1, F_2, \\dots, F_n | Y=1)}{P(F_1, F_2, \\dots, F_n | Y=0)} = \\prod_{i=1}^{n} \\frac{P(F_i | Y=1)}{P(F_i | Y=0)} = \\prod_{i=1}^{n} \\text{LR}_i\n$$\nwhere $\\text{LR}_i$ is the pre-calibrated likelihood ratio for the $i$-th feature, $F_i$.\n\nCombining these principles, the formula for the posterior odds becomes:\n$$\nO = O_0 \\times \\prod_{i=1}^{7} \\text{LR}_i\n$$\nHere, $n=7$ corresponding to the seven specified omic features. If a feature's value is missing (e.g., `None`), its contribution to the product is neutral, meaning its $\\text{LR}_i$ is set to $1$.\n\nOnce the posterior odds $O$ are calculated, they are converted back to a posterior probability, $p = P(Y=1 | E)$, using the relation:\n$$\np = \\frac{O}{1+O}\n$$\nThe computational procedure for each test case is as follows:\n1.  Initialize a running product for the total likelihood ratio, $\\text{LR}_{\\text{total}}$, to $1.0$.\n2.  For each of the $7$ features in a given test case tuple $(\\text{LMP1\\_TPM, EBNA1\\_TPM, \\dots, activation\\_score})$:\n    a. Check if the feature value is present. If it is missing (e.g., `None`), the likelihood ratio for this feature is $1.0$.\n    b. If the value is present, determine the corresponding likelihood ratio ($\\text{LR}_i$) by applying the specified binning rules for that feature. For instance, for LMP1 expression $x$, if $x \\ge 10$, then $\\text{LR}_{\\text{LMP1}} = 5.0$.\n    c. Multiply the running product by the determined likelihood ratio: $\\text{LR}_{\\text{total}} = \\text{LR}_{\\text{total}} \\times \\text{LR}_i$.\n3.  Calculate the posterior odds by multiplying the prior odds by the total likelihood ratio: $O = O_0 \\times \\text{LR}_{\\text{total}}$.\n4.  Calculate the final posterior probability: $p = \\frac{O}{1+O}$.\n5.  Round the resulting probability $p$ to four decimal places as required for the final output.\n\nThis probabilistic and modular approach allows for the systematic integration of diverse biological data types into a single, interpretable score representing the probability of EBV-driven oncogenesis, grounded in the principles of Bayesian inference.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the posterior probability of EBV-driven oncogenesis for a suite of test cases\n    based on a Naive Bayes framework.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (LMP1_TPM, EBNA1_TPM, viral_load_copies_per_cell,\n    # methylation_fraction, mutation_burden_mut/Mb, viral_miRNA_CPM, activation_score)\n    test_cases = [\n        (15, 8, 6, 0.65, 1, 150, 1.8),\n        (0, 0, 0.05, 0.1, 15, 2, 0.3),\n        (5, 0.5, 0.5, 0.5, 12, 50, 1.0),\n        (1, 5, 1, 0.4, 2, 10, 0.5),\n        (9, 2, 4, 0.55, 3, None, 0.7),\n        (0.2, 0, 0.2, 0.25, 0.5, 9.9, 0.49),\n        (12, 7, 3, 0.45, 30, 120, 1.4),\n    ]\n\n    # Prior probability and odds\n    p0 = 0.15\n    O0 = p0 / (1 - p0)\n\n    # --- Likelihood Ratio Functions ---\n\n    def get_lmp1_lr(x):\n        if x is None: return 1.0\n        if x == 0: return 0.5\n        if 0  x  1: return 1.0\n        if 1 = x  10: return 2.0\n        if x >= 10: return 5.0\n        return 1.0\n\n    def get_ebna1_lr(y):\n        if y is None: return 1.0\n        if y == 0: return 0.4\n        if 0  y  5: return 1.5\n        if y >= 5: return 3.0\n        return 1.0\n\n    def get_viral_load_lr(v):\n        if v is None: return 1.0\n        if v  0.1: return 0.3\n        if 0.1 = v  1: return 1.0\n        if 1 = v = 5: return 2.5\n        if v > 5: return 4.0\n        return 1.0\n\n    def get_methylation_lr(m):\n        if m is None: return 1.0\n        if m  0.2: return 0.8\n        if 0.2 = m  0.4: return 1.2\n        if 0.4 = m = 0.6: return 1.8\n        if m > 0.6: return 2.5\n        return 1.0\n\n    def get_mutation_burden_lr(b):\n        if b is None: return 1.0\n        if b  2: return 1.5\n        if 2 = b = 10: return 1.0\n        if b > 10: return 0.5\n        return 1.0\n\n    def get_viral_mirna_lr(r):\n        if r is None: return 1.0\n        if r  10: return 0.6\n        if 10 = r  100: return 1.5\n        if r >= 100: return 3.0\n        return 1.0\n\n    def get_activation_score_lr(a):\n        if a is None: return 1.0\n        if a  0.5: return 0.9\n        if 0.5 = a = 1.5: return 1.2\n        if a > 1.5: return 1.8\n        return 1.0\n    \n    lr_functions = [\n        get_lmp1_lr, get_ebna1_lr, get_viral_load_lr, get_methylation_lr,\n        get_mutation_burden_lr, get_viral_mirna_lr, get_activation_score_lr,\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate the product of likelihood ratios for the current case\n        total_lr = 1.0\n        for i, feature_value in enumerate(case):\n            total_lr *= lr_functions[i](feature_value)\n        \n        # Calculate posterior odds\n        posterior_odds = O0 * total_lr\n        \n        # Calculate posterior probability\n        posterior_prob = posterior_odds / (1 + posterior_odds)\n        \n        results.append(posterior_prob)\n\n    # Format results to four decimal places and print in the specified format\n    formatted_results = [f\"{res:.4f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}