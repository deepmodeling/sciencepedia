{
    "hands_on_practices": [
        {
            "introduction": "An antiviral drug's effectiveness is fundamentally dependent on the presence and necessity of its target. This principle is vividly illustrated by HIV entry inhibitors like maraviroc, which function by blocking the CCR5 co-receptor used by some viral strains to enter host cells. This exercise challenges you to reason from first principles about how viral tropism—the virus's specific co-receptor preference—determines the clinical utility of such a highly specific drug, a core concept in the age of personalized virology. ",
            "id": "4649614",
            "problem": "A clinician considers prescribing maraviroc to a patient whose human immunodeficiency virus (HIV) strain has been phenotyped as exclusively C-X-C chemokine receptor type 4 (CXCR4)-tropic, with zero detectable dependence on C-C chemokine receptor type 5 (CCR5). Maraviroc is a small-molecule entry inhibitor that binds CCR5 and prevents its productive engagement with the HIV envelope glycoprotein. Using the core definitions that HIV entry requires sequential binding of the envelope glycoprotein to CD4 followed by engagement of a chemokine coreceptor, and that maraviroc’s antiviral effect arises solely by functionally antagonizing CCR5, reason from first principles to estimate the expected loss of efficacy of maraviroc, expressed as a percent relative to the efficacy it would have in a purely CCR5-tropic infection. Assume negligible off-target effects on CXCR4, no significant effects on CD4 binding, and that “efficacy” here refers to reduction in productive entry events. Which option best states the expected percent loss of efficacy and the correct mechanistic basis?\n\nA. $0\\%$ loss; maraviroc blocks HIV fusion via gp41 irrespective of which coreceptor is used.\n\nB. $100\\%$ loss; maraviroc targets CCR5, so a CXCR4-tropic virus that does not use CCR5 bypasses the drug’s mechanism entirely.\n\nC. $50\\%$ loss; although the virus is CXCR4-tropic, maraviroc partially inhibits entry through off-target interactions with CXCR4.\n\nD. Variable loss that may be less than $100\\%$; blocking CCR5 forces the virus to upregulate alternative entry pathways, paradoxically increasing drug effectiveness.",
            "solution": "The validity of the problem statement must first be assessed.\n\n### Step 1: Extract Givens\n-   The human immunodeficiency virus (HIV) strain is phenotyped as exclusively C-X-C chemokine receptor type 4 (CXCR4)-tropic.\n-   The HIV strain has zero detectable dependence on C-C chemokine receptor type 5 (CCR5).\n-   The drug prescribed is maraviroc.\n-   Maraviroc's mechanism of action: it is a small-molecule entry inhibitor that binds to CCR5 and prevents its productive engagement with the HIV envelope glycoprotein.\n-   Core definition of HIV entry: sequential binding of the envelope glycoprotein to CD4 followed by engagement of a chemokine coreceptor.\n-   Core definition of maraviroc's antiviral effect: it arises solely by functionally antagonizing CCR5.\n-   Assumptions: negligible off-target effects on CXCR4; no significant effects on CD4 binding.\n-   Definition of efficacy: reduction in productive entry events.\n-   The question asks for the expected loss of efficacy of maraviroc, expressed as a percent relative to its efficacy in a purely CCR5-tropic infection, and the mechanistic basis for this loss.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective.\n-   **Scientific Grounding**: The premises are factually correct. HIV entry does involve CD4 and a coreceptor (CCR5 or CXCR4). Viral tropism is a key concept in HIV pathogenesis. Maraviroc is a real drug, a CCR5 antagonist, and its mechanism of action is accurately described. The scenario is clinically realistic, as tropism testing is performed before prescribing maraviroc.\n-   **Well-Posed**: The problem is clearly defined. It provides all necessary information: the virus's tropism, the drug's target, and key assumptions that constrain the system. This allows for a unique, logical deduction.\n-   **Objective**: The language is precise and unbiased. Terms like \"exclusively CXCR4-tropic\" and assumptions like \"negligible off-target effects on CXCR4\" remove ambiguity.\n\nThe problem statement is free of contradictions, incompleteness, or other flaws. It is a valid problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\n### Derivation of Solution\nThe solution is derived by reasoning from the given principles.\n\n1.  **Baseline Efficacy (Reference Case)**: The problem asks for the loss of efficacy relative to a purely CCR5-tropic infection. In such a reference case, the virus would depend entirely on the CCR5 coreceptor for entry. Maraviroc, by binding to and antagonizing CCR5, would block the virus's sole entry pathway (post-CD4 binding). Let us denote the efficacy in this ideal reference case as $E_{ref}$. This is the maximum efficacy achievable by the drug, representing a near-complete reduction in productive entry events. We can normalize this ideal efficacy to $100\\%$.\n\n2.  **Efficacy in the Stated Scenario**: The problem specifies an HIV strain that is exclusively CXCR4-tropic and has zero dependence on CCR5.\n    -   According to the defined entry mechanism, this virus binds to CD4 and then must engage a coreceptor.\n    -   Its tropism dictates that this coreceptor is CXCR4.\n    -   The drug, maraviroc, acts \"solely by functionally antagonizing CCR5\".\n    -   A critical assumption is that maraviroc has \"negligible off-target effects on CXCR4\".\n    -   Therefore, when maraviroc is administered, it will bind to CCR5 receptors on the host cells. However, a. the virus does not use CCR5 for entry, and b. the virus's required coreceptor, CXCR4, is unaffected by the drug.\n    -   Consequently, the virus remains fully capable of binding CD4 and then CXCR4, leading to productive entry. The drug's action is irrelevant to the virus's\n        entry pathway.\n\n3.  **Calculation of Efficacy Loss**: Efficacy is defined as the \"reduction in productive entry events\".\n    -   In the scenario with the CXCR4-tropic virus, maraviroc does not block the entry pathway. The reduction in productive entry events due to the drug is, therefore, $0$. The efficacy in this case, $E_{current}$, is $0\\%$.\n    -   The loss of efficacy is the difference between the reference efficacy and the current efficacy, expressed as a percentage of the reference efficacy.\n    $$ \\text{Loss of Efficacy} = \\frac{E_{ref} - E_{current}}{E_{ref}} \\times 100\\% $$\n    -   Substituting the values derived:\n    $$ \\text{Loss of Efficacy} = \\frac{100\\% - 0\\%}{100\\%} \\times 100\\% = 100\\% $$\n    -   The expected loss of efficacy is $100\\%$. The mechanistic basis is that the drug's target (CCR5) is not part of the virus's essential machinery for cell entry; the virus uses an alternative coreceptor (CXCR4) that is not targeted by the drug.\n\n### Option-by-Option Analysis\n\n**A. $0\\%$ loss; maraviroc blocks HIV fusion via gp41 irrespective of which coreceptor is used.**\n-   The calculation of a $0\\%$ loss is incorrect. The derivation shows a $100\\%$ loss.\n-   The mechanistic explanation that maraviroc blocks fusion via the glycoprotein $gp41$ is factually incorrect. Maraviroc is a coreceptor antagonist, not a fusion inhibitor. Fusion inhibitors, such as enfuvirtide, target $gp41$.\n-   **Verdict: Incorrect.**\n\n**B. $100\\%$ loss; maraviroc targets CCR5, so a CXCR4-tropic virus that does not use CCR5 bypasses the drug’s mechanism entirely.**\n-   The calculation of a $100\\%$ loss is correct, as derived above.\n-   The mechanistic explanation is precise and accurate. The drug's mechanism is bypassed because its target (CCR5) is not used by the virus, which relies on a different coreceptor (CXCR4). This aligns perfectly with the derivation.\n-   **Verdict: Correct.**\n\n**C. $50\\%$ loss; although the virus is CXCR4-tropic, maraviroc partially inhibits entry through off-target interactions with CXCR4.**\n-   The calculation of a $50\\%$ loss is arbitrary and not supported by the principles given.\n-   The mechanistic explanation directly contradicts a premise of the problem, which is to \"assume negligible off-target effects on CXCR4\". This option is therefore invalid within the context of the problem.\n-   **Verdict: Incorrect.**\n\n**D. Variable loss that may be less than $100\\%$; blocking CCR5 forces the virus to upregulate alternative entry pathways, paradoxically increasing drug effectiveness.**\n-   The calculation of a \"variable loss that may be less than $100\\%$\" is incorrect. The loss is total and deterministic based on the premises.\n-   The mechanistic explanation is illogical. Blocking CCR5, a receptor the virus does not use, exerts no selective pressure and cannot force the virus to \"upregulate\" its existing CXCR4-mediated pathway. The claim of a paradoxical increase in effectiveness is nonsensical; a drug that is completely ineffective cannot become more effective.\n-   **Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Once a suitable drug target is identified, the crucial pharmacological question becomes: \"how much drug is required for a therapeutic effect?\". This practice delves into the quantitative world of enzyme kinetics, focusing on the competitive inhibition of HIV reverse transcriptase by nucleotide analogs like tenofovir. By applying the Michaelis-Menten model, you will calculate the drug concentration needed to effectively outcompete the natural substrate and achieve a specified level of viral suppression, connecting biochemical theory to practical dosing considerations. ",
            "id": "4649675",
            "problem": "A human immunodeficiency virus (HIV) reverse transcriptase (RT) reaction uses deoxyadenosine triphosphate (dATP) as a natural substrate. Tenofovir diphosphate (TFV-DP), a nucleotide analog that acts as a chain terminator, competes with dATP at the RT active site. Assume the polymerization rate can be modeled by Michaelis–Menten kinetics for a single substrate and that TFV-DP behaves as a purely competitive inhibitor that increases the apparent Michaelis constant without changing the maximal velocity. The Michaelis constant is $K_{m}=10\\,\\mu\\mathrm{M}$ for dATP, the inhibition constant is $K_{i}=2\\,\\mu\\mathrm{M}$ for TFV-DP, and the intracellular dATP concentration is $[S]=[{\\rm dATP}]=50\\,\\mu\\mathrm{M}$. \n\nStarting from the definitions of Michaelis–Menten kinetics and competitive inhibition, and treating the fractional activity as the ratio of inhibited to uninhibited initial velocities, determine the minimal TFV-DP concentration $[I]$ required to achieve greater than $95\\%$ inhibition of RT activity, that is, to reduce the normalized activity to at most $0.05$. \n\nExpress your final answer in $\\mu\\mathrm{M}$ and round your answer to three significant figures.",
            "solution": "The problem as stated is biochemically and mathematically well-posed, complete, and devoid of contradictions. All necessary parameters for a standard competitive enzyme inhibition analysis are provided. We may therefore proceed with a formal solution.\n\nThe initial velocity of an enzymatic reaction, $v$, as a function of substrate concentration, $[S]$, can be described by the Michaelis–Menten equation. In the absence of an inhibitor, the initial velocity, $v_0$, is given by:\n$$v_0 = \\frac{V_{\\max} [S]}{K_m + [S]}$$\nwhere $V_{\\max}$ is the maximal reaction velocity and $K_m$ is the Michaelis constant, defined as the substrate concentration at which the reaction velocity is half of $V_{\\max}$.\n\nThe problem states that tenofovir diphosphate (TFV-DP), denoted by $[I]$, is a competitive inhibitor. A competitive inhibitor binds reversibly to the enzyme's active site, competing with the substrate. This mode of inhibition increases the apparent Michaelis constant, $K_m^{\\text{app}}$, without affecting the maximal velocity, $V_{\\max}$. The relationship between the apparent and true Michaelis constants is given by:\n$$K_m^{\\text{app}} = K_m \\left(1 + \\frac{[I]}{K_i}\\right)$$\nwhere $K_i$ is the inhibition constant for the inhibitor.\n\nThe velocity of the reaction in the presence of the competitive inhibitor, $v_i$, is therefore:\n$$v_i = \\frac{V_{\\max} [S]}{K_m^{\\text{app}} + [S]} = \\frac{V_{\\max} [S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}$$\n\nThe problem defines the fractional activity as the ratio of the inhibited velocity to the uninhibited velocity, $\\frac{v_i}{v_0}$. We can construct this ratio:\n$$\\frac{v_i}{v_0} = \\frac{\\frac{V_{\\max} [S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]}}{\\frac{V_{\\max} [S]}{K_m + [S]}}$$\nThe term $V_{\\max}[S]$ cancels, leaving:\n$$\\frac{v_i}{v_0} = \\frac{K_m + [S]}{K_m \\left(1 + \\frac{[I]}{K_i}\\right) + [S]} = \\frac{K_m + [S]}{K_m + \\frac{K_m [I]}{K_i} + [S]}$$\n\nThe objective is to find the minimal concentration of the inhibitor, $[I]$, required to achieve greater than $95\\%$ inhibition. This is equivalent to reducing the normalized activity to at most $5\\%$, or $0.05$. Mathematically, this condition is expressed as:\n$$\\frac{v_i}{v_0} \\le 0.05$$\n\nSubstituting our derived expression for the fractional activity:\n$$\\frac{K_m + [S]}{K_m + [S] + \\frac{K_m [I]}{K_i}} \\le 0.05$$\nTo solve for $[I]$, we can invert both sides of the inequality, which requires reversing the inequality sign:\n$$\\frac{K_m + [S] + \\frac{K_m [I]}{K_i}}{K_m + [S]} \\ge \\frac{1}{0.05}$$\nThe right side simplifies to $\\frac{1}{0.05} = 20$. The left side can be split into two terms:\n$$1 + \\frac{\\frac{K_m [I]}{K_i}}{K_m + [S]} \\ge 20$$\nSubtracting $1$ from both sides gives:\n$$\\frac{K_m [I]}{K_i(K_m + [S])} \\ge 19$$\nNow, we isolate $[I]$ by multiplying both sides by $\\frac{K_i(K_m + [S])}{K_m}$. Since all constants ($K_m$, $K_i$) and concentrations ($[S]$) are positive, the direction of the inequality is preserved.\n$$[I] \\ge 19 \\frac{K_i(K_m + [S])}{K_m}$$\nThis inequality gives the condition on $[I]$ to achieve at least $95\\%$ inhibition. The minimal concentration required is the value that satisfies the equality.\n\nWe are given the following values:\n- Michaelis constant for dATP: $K_m = 10\\,\\mu\\mathrm{M}$\n- Inhibition constant for TFV-DP: $K_i = 2\\,\\mu\\mathrm{M}$\n- Intracellular dATP concentration: $[S] = 50\\,\\mu\\mathrm{M}$\n\nSubstituting these values into the expression for the minimal $[I]$:\n$$[I]_{\\min} = 19 \\times \\frac{(2\\,\\mu\\mathrm{M})(10\\,\\mu\\mathrm{M} + 50\\,\\mu\\mathrm{M})}{10\\,\\mu\\mathrm{M}}$$\n$$[I]_{\\min} = 19 \\times \\frac{(2\\,\\mu\\mathrm{M})(60\\,\\mu\\mathrm{M})}{10\\,\\mu\\mathrm{M}}$$\n$$[I]_{\\min} = 19 \\times \\frac{120\\,(\\mu\\mathrm{M})^2}{10\\,\\mu\\mathrm{M}}$$\n$$[I]_{\\min} = 19 \\times 12\\,\\mu\\mathrm{M}$$\n$$[I]_{\\min} = 228\\,\\mu\\mathrm{M}$$\nThe problem asks for the answer to be rounded to three significant figures. The calculated value, $228$, already has three significant figures.\n\nThus, the minimal concentration of TFV-DP required to reduce RT activity to at most $5\\%$ of its uninhibited level (i.e., achieve $>95\\%$ inhibition) is $228\\,\\mu\\mathrm{M}$.",
            "answer": "$$\\boxed{228}$$"
        },
        {
            "introduction": "Beyond simply calculating an overall inhibition percentage, a deeper understanding of an antiviral's mechanism comes from modeling its precise molecular consequences. This advanced practice guides you in building a probabilistic model to describe the action of chain-terminating nucleoside reverse transcriptase inhibitors (NRTIs). You will predict the distribution of resulting DNA fragment lengths, translating concepts of enzyme competition and stochastic processes into a tangible outcome and gaining insight into how these drugs systematically dismantle the process of viral replication. ",
            "id": "4649618",
            "problem": "You are modeling reverse transcriptase (RT) primer extension in the presence of both natural deoxynucleoside triphosphates (dNTPs) and a nucleoside reverse transcriptase inhibitor (NRTI). Use a first-principles, probability-based model grounded in enzyme competition and the Central Dogma to estimate the expected fragment length distribution under homogeneous conditions.\n\nFundamental base and assumptions:\n- The Central Dogma states that nucleic acids are templated polymers. Reverse transcriptase (RT) extends a primer by incorporating one nucleotide per step along a template of fixed remaining length.\n- Under steady-state, pseudo-first-order competition between two substrates A and B for the same enzyme active site, the probability that A is chosen at an event is proportional to its catalytic efficiency times its concentration. Concretely, if the catalytic efficiencies are $E_{A} \\equiv (k_{\\mathrm{cat}}/K_{M})_{A}$ and $E_{B} \\equiv (k_{\\mathrm{cat}}/K_{M})_{B}$ and the concentrations are $[A]$ and $[B]$, then the probability that A is incorporated in an eligible event is $E_{A}[A] / (E_{A}[A] + E_{B}[B])$.\n- Let the NRTI be a chain terminator lacking a $3^{\\prime}$ hydroxyl, so incorporation immediately terminates extension.\n- Let the NRTI compete only at a fraction $f_{\\mathrm{target}}$ of template positions (those where its base analog can pair), and never at other positions. Assume positions are independent and identically distributed with respect to eligibility, so the effective per-step termination hazard is homogeneous.\n- Define the selectivity factor $s \\equiv E_{\\mathrm{NRTI}}/E_{\\mathrm{dNTP}}$, the ratio of catalytic efficiencies of the NRTI to the corresponding natural dNTP, a dimensionless number.\n\nTasks:\n1. Using the competition principle above, express the probability $q$ that, at an eligible step, the NRTI is incorporated as a function of $s$, the dNTP concentration $C_{d}$, and the NRTI concentration $C_{i}$, all in $\\mu$M. Then express the effective per-step termination probability $p$ over all steps in terms of $q$ and $f_{\\mathrm{target}}$. Do not assume any position-specific sequence; treat $f_{\\mathrm{target}}$ as the expected eligibility frequency.\n2. From independence across steps, derive the distribution of the fragment length $K$ (in nucleotides added) on a template of remaining length $L$, where at each step either extension continues or terminates by NRTI incorporation, and reaching $L$ implies full-length without NRTI incorporation. Provide $P(K = k)$ for $k \\in \\{1,2,\\dots,L\\}$ in terms of $p$ and $L$. You must treat the natural completion at $k=L$ as survival through $L-1$ steps without termination.\n3. Implement a program that, given parameter sets, computes the fragment length probability mass function across $k=1$ to $k=L$. For each test case, output the list of $L$ probabilities as decimals rounded to exactly $6$ places.\n\nNumerical details and units:\n- Concentrations $C_{d}$ and $C_{i}$ are provided in $\\mu$M. You must treat $s$ as dimensionless. All probabilities must be expressed as decimals, not percentages.\n- Angle units are not applicable.\n\nTest suite:\nProvide outputs for each of the following $4$ test cases, in the order listed. In each tuple $\\left(L, C_{d}, C_{i}, s, f_{\\mathrm{target}}\\right)$:\n- Case A: $\\left(6, 50, 5, 0.1, 0.25\\right)$\n- Case B (boundary, no NRTI): $\\left(6, 50, 0, 0.1, 1.0\\right)$\n- Case C (high NRTI dominance): $\\left(6, 5, 50, 1.0, 1.0\\right)$\n- Case D (low selectivity and partial targeting): $\\left(6, 10, 10, 0.02, 0.5\\right)$\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Construct this list by concatenating, in order, the $L$ rounded probabilities for Case A, then the $L$ rounded probabilities for Case B, then Case C, then Case D. For example, the output must look like $[p_{A,1},p_{A,2},\\dots,p_{A,6},p_{B,1},\\dots,p_{D,6}]$, with each $p$ rounded to $6$ decimal places.",
            "solution": "The problem is scientifically grounded, well-posed, and objective, meeting all criteria for validity. The model is based on established principles of enzyme kinetics and probability theory.\n\n### Step 1: Derivation of the Per-Step Termination Probability, $p$\n\nThe problem statement establishes a model for competitive inhibition based on steady-state enzyme kinetics. The probability that a substrate is chosen by an enzyme is proportional to the product of its catalytic efficiency and its concentration. Here, the two competing substrates are the natural deoxynucleoside triphosphate (dNTP) and the nucleoside reverse transcriptase inhibitor (NRTI).\n\nLet the catalytic efficiency of the dNTP be $E_{\\mathrm{dNTP}} \\equiv (k_{\\mathrm{cat}}/K_{M})_{\\mathrm{dNTP}}$ and its concentration be $C_{d}$.\nLet the catalytic efficiency of the NRTI be $E_{\\mathrm{NRTI}} \\equiv (k_{\\mathrm{cat}}/K_{M})_{\\mathrm{NRTI}}$ and its concentration be $C_{i}$.\n\nAt a template position where the NRTI can compete (an \"eligible\" step), the probability $q$ of NRTI incorporation is given by the provided formula:\n$$ q = \\frac{E_{\\mathrm{NRTI}} [NRTI]}{E_{\\mathrm{NRTI}} [NRTI] + E_{\\mathrm{dNTP}} [dNTP]} $$\nSubstituting the given variable names for concentrations, $[NRTI]=C_{i}$ and $[dNTP]=C_{d}$, we have:\n$$ q = \\frac{E_{\\mathrm{NRTI}} C_{i}}{E_{\\mathrm{NRTI}} C_{i} + E_{\\mathrm{dNTP}} C_{d}} $$\nThe problem defines the selectivity factor $s$ as the dimensionless ratio of catalytic efficiencies, $s \\equiv E_{\\mathrm{NRTI}}/E_{\\mathrm{dNTP}}$. To express $q$ in terms of $s$, we divide the numerator and denominator by $E_{\\mathrm{dNTP}}$:\n$$ q = \\frac{(E_{\\mathrm{NRTI}}/E_{\\mathrm{dNTP}}) C_{i}}{(E_{\\mathrm{NRTI}}/E_{\\mathrm{dNTP}}) C_{i} + (E_{\\mathrm{dNTP}}/E_{\\mathrm{dNTP}}) C_{d}} = \\frac{s C_{i}}{s C_{i} + C_{d}} $$\nThis probability $q$ applies only to the fraction $f_{\\mathrm{target}}$ of template positions where the NRTI is a valid base analog. At the remaining fraction, $1 - f_{\\mathrm{target}}$, the NRTI cannot be incorporated, so the termination probability is $0$.\n\nThe effective per-step termination probability, $p$, is the expected probability of termination at any given step. Assuming the eligibility of positions is independent and identically distributed, $p$ is the weighted average of the termination probabilities at eligible and non-eligible sites:\n$$ p = q \\cdot f_{\\mathrm{target}} + 0 \\cdot (1 - f_{\\mathrm{target}}) $$\n$$ p = q f_{\\mathrm{target}} $$\nSubstituting the expression for $q$, we arrive at the final formula for the effective per-step termination probability:\n$$ p = \\left( \\frac{s C_{i}}{s C_{i} + C_{d}} \\right) f_{\\mathrm{target}} $$\n\n### Step 2: Derivation of the Fragment Length Distribution, $P(K=k)$\n\nThe process of primer extension is modeled as a sequence of discrete steps. At each step, one nucleotide is added. This process can be viewed as a series of Bernoulli trials, where at each step $k$, there are two outcomes:\n1.  **Termination**: The NRTI is incorporated, and the chain extension stops. This occurs with probability $p$.\n2.  **Continuation**: A natural dNTP is incorporated, and the chain extends. This occurs with probability $1-p$.\n\nThe fragment length $K$ is the total number of nucleotides added before the process stops, either by NRTI incorporation or by reaching the end of the template of length $L$.\n\nFor a fragment to have a final length of $k$ nucleotides, where $k < L$, the extension process must have continued for the first $k-1$ steps and then terminated at the $k$-th step. Since the steps are independent, the probability of this sequence of events is the product of their individual probabilities:\n$$ P(K=k) = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{k-1 \\text{ times}} \\times p = (1-p)^{k-1} p \\quad \\text{for } k \\in \\{1, 2, \\dots, L-1\\} $$\nThis is the probability mass function of a geometric distribution.\n\nIf the extension process does not terminate at any of the first $L-1$ steps, it will naturally complete at step $L$ by reaching the end of the template. Therefore, the event that the fragment length is $L$ ($K=L$) corresponds to surviving all $L-1$ opportunities for termination. The probability of this is:\n$$ P(K=L) = \\underbrace{(1-p) \\times (1-p) \\times \\dots \\times (1-p)}_{L-1 \\text{ times}} = (1-p)^{L-1} $$\nThe complete probability mass function for the fragment length $K$ is therefore:\n$$ P(K=k) = \\begin{cases} (1-p)^{k-1} p & \\text{for } k = 1, 2, \\ldots, L-1 \\\\ (1-p)^{L-1} & \\text{for } k = L \\end{cases} $$\nThis distribution is properly normalized, as the sum of all probabilities is $1$:\n$$ \\sum_{k=1}^{L} P(K=k) = \\left( \\sum_{k=1}^{L-1} (1-p)^{k-1} p \\right) + (1-p)^{L-1} $$\nThe summation is a finite geometric series:\n$$ p \\sum_{j=0}^{L-2} (1-p)^{j} = p \\frac{1 - (1-p)^{L-1}}{1 - (1-p)} = 1 - (1-p)^{L-1} $$\nThus, the total probability is $(1 - (1-p)^{L-1}) + (1-p)^{L-1} = 1$.\n\n### Step 3: Implementation for Numerical Calculation\n\nThe implementation will follow the derived formulas. For each test case defined by a tuple $(L, C_{d}, C_{i}, s, f_{\\mathrm{target}})$:\n1.  Calculate the effective termination probability $p$ using $p = f_{\\mathrm{target}} \\cdot s \\cdot C_{i} / (s \\cdot C_{i} + C_{d})$. A check for the denominator being zero is good practice, but given the constraints ($C_d, C_i \\ge 0$), it would only be zero if both concentrations are zero, which is not the case in the provided tests.\n2.  Iterate for $k$ from $1$ to $L$.\n3.  For each $k < L$, compute $P(K=k) = (1-p)^{k-1} p$.\n4.  For $k=L$, compute $P(K=L) = (1-p)^{L-1}$.\n5.  Store these probabilities, round each to exactly $6$ decimal places, and collect them for all test cases.\n6.  Finally, format the collected probabilities into a single comma-separated string enclosed in brackets as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the fragment length probability distribution for reverse transcriptase\n    primer extension in the presence of a nucleoside reverse transcriptase inhibitor (NRTI).\n    \"\"\"\n\n    # Test cases are defined as tuples: (L, C_d, C_i, s, f_target)\n    # L: template length (nucleotides)\n    # C_d: dNTP concentration (μM)\n    # C_i: NRTI concentration (μM)\n    # s: selectivity factor (dimensionless)\n    # f_target: fraction of template positions where NRTI can compete\n    test_cases = [\n        (6, 50, 5, 0.1, 0.25),      # Case A\n        (6, 50, 0, 0.1, 1.0),       # Case B (boundary, no NRTI)\n        (6, 5, 50, 1.0, 1.0),       # Case C (high NRTI dominance)\n        (6, 10, 10, 0.02, 0.5),      # Case D (low selectivity and partial targeting)\n    ]\n\n    all_results_formatted = []\n\n    for case in test_cases:\n        L, C_d, C_i, s, f_target = case\n\n        # Step 1: Calculate the effective per-step termination probability 'p'.\n        # The probability 'q' of NRTI incorporation at an eligible site.\n        denominator = s * C_i + C_d\n        if denominator == 0:\n            # This case occurs if both C_i and C_d are zero (or s=0 and C_d=0)\n            # which implies no substrates are available for extension.\n            # In such a scenario, termination is not well-defined.\n            # However, for the given test cases, C_d is always positive.\n            q = 0.0\n        else:\n            q = (s * C_i) / denominator\n        \n        # The effective per-step termination probability 'p' over all steps.\n        p = q * f_target\n\n        # Step 2: Calculate the fragment length probability distribution P(K=k).\n        case_probabilities = []\n        one_minus_p = 1.0 - p\n\n        for k in range(1, L + 1):\n            if k  L:\n                # Probability of k-1 continuations followed by 1 termination.\n                # Using np.power for potentially better precision with floating point exponents.\n                prob = np.power(one_minus_p, k - 1) * p\n            else: # k == L\n                # Probability of L-1 continuations.\n                prob = np.power(one_minus_p, L - 1)\n            \n            case_probabilities.append(prob)\n        \n        # Round results to 6 decimal places and add to the final list.\n        for prob in case_probabilities:\n            # \"{:.6f}\".format() provides standard rounding to a fixed number of decimal places.\n            all_results_formatted.append(f\"{prob:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results_formatted)}]\")\n\nsolve()\n```"
        }
    ]
}