{
    "hands_on_practices": [
        {
            "introduction": "Real-time quantitative PCR (qPCR) is a cornerstone of molecular MRD detection, but its quantitative power relies on its amplification efficiency. This exercise guides you through a fundamental laboratory task: analyzing a standard curve to calculate the qPCR efficiency from cycle threshold ($C_t$) data. Understanding this process is key to appreciating how raw fluorescence signals are converted into reliable quantitative measurements of tumor burden. ",
            "id": "5231553",
            "problem": "In laboratory diagnostics of Minimal Residual Disease (MRD), real-time quantitative polymerase chain reaction (qPCR) is used to infer the initial target copy number in a patient sample by comparing its cycle threshold to a calibration curve constructed from known standards. Assume the following foundational facts: in qPCR, the target amplicon population increases multiplicatively by a constant factor per cycle, the fluorescence threshold is fixed across runs, and the cycle threshold $C_t$ is the cycle at which the accumulated amplicon first exceeds this fixed threshold. A ten-fold serial dilution of a standard with known initial target copies per reaction $N_0$ was run in triplicate and produced the following averaged calibration data (one value per dilution for this exercise):\n\n- $N_0$: $1.00 \\times 10^5$, $1.00 \\times 10^4$, $1.00 \\times 10^3$, $1.00 \\times 10^2$, $1.00 \\times 10^1$\n- $C_t$: $16.50$, $19.95$, $23.40$, $26.85$, $30.30$\n\nStarting from the exponential amplification model and the definition of $C_t$ with a fixed fluorescence threshold, derive the linear relationship between $C_t$ and $\\log_{10}(N_0)$ and identify the slope $m$ in terms of the per-cycle efficiency $E$. Then, using the given calibration data, compute the best-fit slope $m$ of $C_t$ versus $\\log_{10}(N_0)$ by least-squares linear regression, use your derived relation to compute the qPCR efficiency $E$, and round your final $E$ to four significant figures. Express the final efficiency as a decimal fraction (do not use a percentage sign).",
            "solution": "The problem is valid as it is scientifically grounded in the principles of real-time quantitative PCR (qPCR), is well-posed with sufficient data for a unique solution, and is expressed in objective, formal language. We can proceed with the solution.\n\nThe first step is to derive the theoretical relationship between the cycle threshold $C_t$ and the initial number of target molecules $N_0$. The amplification of the target DNA in qPCR follows an exponential model. Let $N_c$ be the number of target molecules after $c$ cycles. If $N_0$ is the initial number of molecules and $E$ is the per-cycle amplification efficiency (where $0 \\le E \\le 1$), the number of molecules after $c$ cycles is given by:\n$$N_c = N_0 (1+E)^c$$\nIn this equation, an efficiency $E=1$ corresponds to a perfect doubling of the product in each cycle.\n\nThe cycle threshold, $C_t$, is defined as the fractional cycle number at which the fluorescence signal, which is proportional to the amount of amplified DNA, crosses a fixed threshold. Let $N_T$ be the number of DNA molecules required to cross this fluorescence threshold. At the cycle threshold, $c=C_t$, we have $N_{C_t} = N_T$. Substituting this into the amplification equation:\n$$N_T = N_0 (1+E)^{C_t}$$\nTo establish the relationship between $C_t$ and $N_0$, we rearrange this equation. First, we isolate the term containing $C_t$:\n$$\\frac{N_T}{N_0} = (1+E)^{C_t}$$\nNext, we take the base-10 logarithm of both sides, as the problem requires a relationship with $\\log_{10}(N_0)$:\n$$\\log_{10}\\left(\\frac{N_T}{N_0}\\right) = \\log_{10}\\left((1+E)^{C_t}\\right)$$\nUsing the properties of logarithms, $\\log(a/b) = \\log(a) - \\log(b)$ and $\\log(a^b) = b\\log(a)$, we get:\n$$\\log_{10}(N_T) - \\log_{10}(N_0) = C_t \\log_{10}(1+E)$$\nNow, we solve for $C_t$:\n$$C_t = \\frac{\\log_{10}(N_T) - \\log_{10}(N_0)}{\\log_{10}(1+E)}$$\nThis can be written in the form of a linear equation, $y = mx + b$, where $y = C_t$ and $x = \\log_{10}(N_0)$:\n$$C_t = \\left(-\\frac{1}{\\log_{10}(1+E)}\\right) \\log_{10}(N_0) + \\left(\\frac{\\log_{10}(N_T)}{\\log_{10}(1+E)}\\right)$$\nFrom this derived form, we can identify the slope $m$ of the line $C_t$ versus $\\log_{10}(N_0)$:\n$$m = -\\frac{1}{\\log_{10}(1+E)}$$\nThis completes the first part of the problem.\n\nThe second part is to compute the best-fit slope $m$ using the provided experimental data. We will use the formula for the slope of a least-squares linear regression line. Let our data points be $(x_i, y_i)$, where $x_i = \\log_{10}(N_{0,i})$ and $y_i = C_{t,i}$. The number of data points is $n=5$.\n\nThe data are:\n- $N_0$: $1.00 \\times 10^5, 1.00 \\times 10^4, 1.00 \\times 10^3, 1.00 \\times 10^2, 1.00 \\times 10^1$\n- $x = \\log_{10}(N_0)$: $5, 4, 3, 2, 1$\n- $y = C_t$: $16.50, 19.95, 23.40, 26.85, 30.30$\n\nThe formula for the slope $m$ is:\n$$m = \\frac{n(\\sum_{i=1}^{n} x_i y_i) - (\\sum_{i=1}^{n} x_i)(\\sum_{i=1}^{n} y_i)}{n(\\sum_{i=1}^{n} x_i^2) - (\\sum_{i=1}^{n} x_i)^2}$$\nWe compute the necessary sums:\n$$ \\sum_{i=1}^{5} x_i = 5 + 4 + 3 + 2 + 1 = 15 $$\n$$ \\sum_{i=1}^{5} y_i = 16.50 + 19.95 + 23.40 + 26.85 + 30.30 = 117.00 $$\n$$ \\sum_{i=1}^{5} x_i^2 = 5^2 + 4^2 + 3^2 + 2^2 + 1^2 = 25 + 16 + 9 + 4 + 1 = 55 $$\n$$ \\sum_{i=1}^{5} x_i y_i = (5)(16.50) + (4)(19.95) + (3)(23.40) + (2)(26.85) + (1)(30.30) $$\n$$ \\sum_{i=1}^{5} x_i y_i = 82.50 + 79.80 + 70.20 + 53.70 + 30.30 = 316.50 $$\nNow, we substitute these sums into the formula for $m$:\n$$ m = \\frac{5(316.50) - (15)(117.00)}{5(55) - (15)^2} = \\frac{1582.5 - 1755}{275 - 225} = \\frac{-172.5}{50} = -3.45 $$\nThe best-fit slope of the calibration curve is $m = -3.45$.\n\nFinally, we use the derived relationship between $m$ and $E$ to calculate the qPCR efficiency.\n$$ m = -3.45 = -\\frac{1}{\\log_{10}(1+E)} $$\nSolving for $\\log_{10}(1+E)$:\n$$ \\log_{10}(1+E) = \\frac{-1}{m} = \\frac{-1}{-3.45} = \\frac{1}{3.45} $$\nTo find $E$, we first take the antilogarithm (power of $10$):\n$$ 1+E = 10^{(1/3.45)} $$\nThen, we solve for $E$:\n$$ E = 10^{(1/3.45)} - 1 $$\nNow we compute the numerical value:\n$$ \\frac{1}{3.45} \\approx 0.28985507 $$\n$$ 1+E \\approx 10^{0.28985507} \\approx 1.94916005 $$\n$$ E \\approx 1.94916005 - 1 = 0.94916005 $$\nThe problem requires the final answer for $E$ to be rounded to four significant figures.\n$$ E \\approx 0.9492 $$\nThe qPCR efficiency is approximately $0.9492$, or $94.92\\%$.",
            "answer": "$$\\boxed{0.9492}$$"
        },
        {
            "introduction": "Detecting MRD is fundamentally a search for rare events. A critical question in assay design is: \"How large must our sample be to ensure we can detect the disease if it's present at a very low level?\" This practice uses foundational probability theory to determine the minimum number of cells required to find at least one malignant cell with a given confidence, directly linking statistical reasoning to the practical detection limits of an MRD assay. ",
            "id": "5231515",
            "problem": "A clinical laboratory is validating an assay for Minimal Residual Disease (MRD) detection in hematologic malignancy. Assume a large, well-mixed cell population in which each independently assayed cell has probability $f$ of being malignant. The assay is analytically perfect for any malignant cell that enters the measurement (that is, if a malignant cell is present in the assayed set, it will be detected with probability $1$), and cells are sampled independently and identically distributed (i.i.d.). Define the experimental success event as observing at least one malignant cell among $n$ assayed cells. The laboratory requires confidence $1-\\alpha$ that the experiment will succeed when the malignant cell fraction is $f$.\n\nStarting from the Bernoulli-trial model and the definition of the probability of zero successes, derive an explicit condition on $n$ (in terms of $f$ and $\\alpha$) that guarantees the desired confidence without invoking any specialized MRD-specific shortcut formulas. Then, using the small-$f$ limit to first order to obtain a tractable closed-form approximation, determine the minimal integer $n$ that satisfies the exact condition for the target fraction $f = 1.0 \\times 10^{-5}$ and confidence parameter $\\alpha = 0.05$. If you use any approximation in an intermediate step, verify that your final $n$ satisfies the exact condition derived from first principles.\n\nExpress your final result as the minimal integer number of assayed cells. Do not round to a specified number of significant figures; report the smallest integer $n$ that guarantees the required confidence under the exact Bernoulli model.",
            "solution": "The foundational probabilistic model for this MRD detection task is the Bernoulli-trial framework. Each assayed cell is an independent trial with probability $f$ of being malignant (a \"success\"). Let $X$ be the number of malignant cells among $n$ assayed cells. Under independence with constant success probability $f$, the distribution of $X$ is binomial:\n$$\nX \\sim \\mathrm{Binomial}(n, f).\n$$\nThe probability of zero malignant cells in the sample is the probability of zero successes in $n$ Bernoulli trials, given by\n$$\n\\mathbb{P}(X=0) = (1 - f)^{n}.\n$$\nThe event that the assay detects MRD (under the assumption of perfect analytical detection for any malignant cell present) is the event that at least one malignant cell is included in the $n$ assayed cells, i.e., $X \\geq 1$. By the complement rule,\n$$\n\\mathbb{P}(X \\geq 1) = 1 - \\mathbb{P}(X=0) = 1 - (1 - f)^{n}.\n$$\nThe laboratory requires that this probability be at least $1 - \\alpha$, which yields the inequality\n$$\n1 - (1 - f)^{n} \\geq 1 - \\alpha \\quad \\Longleftrightarrow \\quad (1 - f)^{n} \\leq \\alpha.\n$$\nTake natural logarithms of both sides. Because $0 < 1 - f < 1$ for $0 < f < 1$, we have $\\ln(1 - f) < 0$, and because $0 < \\alpha < 1$, we have $\\ln(\\alpha) < 0$. Applying $\\ln$ preserves the inequality direction when dividing by a negative quantity is handled carefully:\n$$\nn \\ln(1 - f) \\leq \\ln(\\alpha).\n$$\nSince $\\ln(1 - f) < 0$, dividing both sides by $\\ln(1 - f)$ reverses the inequality, giving the exact necessary and sufficient condition\n$$\nn \\geq \\frac{\\ln(\\alpha)}{\\ln(1 - f)}.\n$$\nThis expression provides the minimal real-valued $n$ to achieve the desired confidence for given $f$ and $\\alpha$. Because $n$ must be an integer number of assayed cells, the minimal integer is\n$$\nn_{\\min} = \\left\\lceil \\frac{\\ln(\\alpha)}{\\ln(1 - f)} \\right\\rceil,\n$$\nwhere $\\lceil \\cdot \\rceil$ denotes the ceiling function.\n\nTo obtain a tractable closed-form approximation for small $f$, we use the first-order Taylor expansion of the natural logarithm around $0$:\n$$\n\\ln(1 - f) = -f - \\frac{f^{2}}{2} - \\frac{f^{3}}{3} - \\cdots \\approx -f \\quad \\text{for small } f.\n$$\nSubstituting this into the exact condition yields the widely used small-$f$ approximation\n$$\nn \\approx -\\frac{\\ln(\\alpha)}{f}.\n$$\nNow apply these results to the specified values $f = 1.0 \\times 10^{-5}$ and $\\alpha = 0.05$.\n\nFirst compute the exact real-valued threshold:\n$$\nn_{\\ast} = \\frac{\\ln(0.05)}{\\ln(1 - 1.0 \\times 10^{-5})}.\n$$\nWe evaluate the numerator and denominator numerically:\n$$\n\\ln(0.05) = -2.995732273553991\\ldots,\n$$\n$$\n\\ln(1 - 1.0 \\times 10^{-5}) = \\ln(0.99999) = -1.0000050000333335 \\times 10^{-5}\\ldots\n$$\nHence,\n$$\nn_{\\ast} = \\frac{-2.995732273553991\\ldots}{-1.0000050000333335 \\times 10^{-5}} \\approx 299\\,571.729\\ldots\n$$\nTherefore, the minimal integer that satisfies the exact binomial condition is\n$$\nn_{\\min} = \\lceil 299\\,571.729\\ldots \\rceil = 299\\,572.\n$$\n\nFor cross-checking, the small-$f$ approximation gives\n$$\nn_{\\text{approx}} = -\\frac{\\ln(0.05)}{1.0 \\times 10^{-5}} \\approx 299\\,573.227\\ldots,\n$$\nwhich is slightly larger (conservative) due to the first-order approximation $\\ln(1 - f) \\approx -f$ having $|\\ln(1 - f)| > f$ for $f > 0$. Verifying that the exact condition is indeed met by $n = 299\\,572$:\n$$\n(1 - f)^{n} = (1 - 1.0 \\times 10^{-5})^{299\\,572} = \\exp\\!\\big(n \\ln(1 - f)\\big) \\approx \\exp\\!\\big(299\\,572 \\cdot (-1.0000050000333335 \\times 10^{-5})\\big) \\approx \\exp(-2.995747) \\approx 0.0500\\ldots \\leq 0.05,\n$$\nwhich confirms that $n = 299\\,572$ satisfies $(1 - f)^{n} \\leq \\alpha$ and thus guarantees confidence $1 - \\alpha$ under the exact Bernoulli model.\n\nThe requested final result is the minimal integer number of assayed cells.",
            "answer": "$$\\boxed{299572}$$"
        },
        {
            "introduction": "A positive lab result is not a final diagnosis; its clinical significance requires careful interpretation. This practice explores the concepts of sensitivity, specificity, and predictive values, which are essential for evaluating any diagnostic test. By applying Bayes' theorem to derive the Positive Predictive Value (PPV), you will see how the reliability of an MRD test is influenced not only by its intrinsic accuracy but also by the prevalence of the disease in the patient population. ",
            "id": "5231437",
            "problem": "A laboratory develops an assay for Minimal Residual Disease (MRD) detection using circulating tumor DNA (ctDNA) quantified by digital polymerase chain reaction (PCR). In a given clinical cohort, disease status is unknown, and a single MRD test result is observed for each individual. Let $D$ denote the event \"true residual disease present\" and $\\neg D$ denote \"true residual disease absent.\" Let $T$ denote the event \"MRD test positive\" and $\\neg T$ denote \"MRD test negative.\" The cohort has disease prevalence $\\pi$, understood as the probability $P(D)$ and expressed as a decimal fraction. The assay has sensitivity $s$ and specificity $c$, defined in terms of conditional probabilities on $D$ and $\\neg D$.\n\nUsing only the fundamental definitions of conditional probability, the law of total probability, and Bayes' theorem, do the following:\n- Define sensitivity, specificity, Positive Predictive Value (PPV), and Negative Predictive Value (NPV) for this MRD assay in terms of $P(\\cdot)$ with the events $D$, $\\neg D$, $T$, and $\\neg T$.\n- Derive an analytic expression for the PPV, $P(D \\mid T)$, as a function of $\\pi$, $s$, and $c$.\n\nExpress the final PPV strictly as a closed-form analytic expression in terms of $\\pi$, $s$, and $c$. Do not use a percentage sign anywhere; treat all probabilities, including $\\pi$, as decimal fractions. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of biostatistics and medical diagnostics, well-posed with a clear objective and sufficient information, and objective in its formulation. We can proceed with a formal derivation.\n\nThe problem requires us to first define several key metrics for a diagnostic test and then derive an expression for the Positive Predictive Value (PPV).\n\nLet $D$ be the event that true residual disease is present, and $\\neg D$ be the event that it is absent. Let $T$ be the event of a positive test result, and $\\neg T$ be the event of a negative test result. Let the disease prevalence be $\\pi = P(D)$.\n\nThe definitions of sensitivity, specificity, Positive Predictive Value (PPV), and Negative Predictive Value (NPV) are based on conditional probabilities involving these events.\n\n1.  **Sensitivity ($s$)**: Sensitivity is the probability that the test correctly identifies individuals who have the disease. It is the probability of a positive test result ($T$) given that the disease is present ($D$).\n    $$s = P(T \\mid D)$$\n\n2.  **Specificity ($c$)**: Specificity is the probability that the test correctly identifies individuals who do not have the disease. It is the probability of a negative test result ($\\neg T$) given that the disease is absent ($\\neg D$).\n    $$c = P(\\neg T \\mid \\neg D)$$\n\n3.  **Positive Predictive Value (PPV)**: PPV is the probability that an individual with a positive test result actually has the disease. It is the probability of the disease being present ($D$) given a positive test result ($T$).\n    $$\\text{PPV} = P(D \\mid T)$$\n\n4.  **Negative Predictive Value (NPV)**: NPV is the probability that an individual with a negative test result is truly free of the disease. It is the probability of the disease being absent ($\\neg D$) given a negative test result ($\\neg T$).\n    $$\\text{NPV} = P(\\neg D \\mid \\neg T)$$\n\nNext, we derive an analytic expression for the PPV, $P(D \\mid T)$, as a function of prevalence $\\pi$, sensitivity $s$, and specificity $c$.\n\nThe derivation starts with the definition of conditional probability, which can be rearranged into the form known as Bayes' theorem. The PPV is $P(D \\mid T)$, and by Bayes' theorem, it is expressed as:\n$$P(D \\mid T) = \\frac{P(T \\mid D) P(D)}{P(T)}$$\n\nWe can identify the terms in the numerator from the problem's givens and our definitions:\n-   $P(T \\mid D)$ is the sensitivity, $s$.\n-   $P(D)$ is the prevalence, $\\pi$.\n\nSo, the numerator is $s \\pi$.\n\nThe denominator, $P(T)$, is the overall probability of a positive test result in the cohort. To express this in terms of the given parameters, we use the Law of Total Probability. The sample space is partitioned by the events $D$ and $\\neg D$. Therefore, the probability of event $T$ can be written as:\n$$P(T) = P(T \\cap D) + P(T \\cap \\neg D)$$\n\nUsing the definition of conditional probability, $P(A \\cap B) = P(A \\mid B) P(B)$, we can rewrite this as:\n$$P(T) = P(T \\mid D) P(D) + P(T \\mid \\neg D) P(\\neg D)$$\n\nLet's evaluate each term in this expression for $P(T)$:\n-   $P(T \\mid D) = s$, the sensitivity.\n-   $P(D) = \\pi$, the prevalence.\n-   $P(\\neg D)$ is the probability of not having the disease, which is $1 - P(D) = 1 - \\pi$.\n-   $P(T \\mid \\neg D)$ is the probability of a positive test given the absence of disease. This is the false positive rate. It can be derived from the specificity, $c$. Since for a disease-absent individual the test can only be positive or negative, we have $P(T \\mid \\neg D) + P(\\neg T \\mid \\neg D) = 1$. The specificity is $c = P(\\neg T \\mid \\neg D)$. Therefore, $P(T \\mid \\neg D) = 1 - c$.\n\nSubstituting these components back into the expression for $P(T)$:\n$$P(T) = (s)(\\pi) + (1 - c)(1 - \\pi)$$\n$$P(T) = s\\pi + (1 - c)(1 - \\pi)$$\n\nNow we have expressions for both the numerator and the denominator of the Bayes' theorem formula for PPV. Substituting them back, we obtain the final expression for PPV, $P(D \\mid T)$:\n$$P(D \\mid T) = \\frac{s \\pi}{s\\pi + (1 - c)(1 - \\pi)}$$\n\nThis is the analytic expression for the Positive Predictive Value as a function of prevalence ($\\pi$), sensitivity ($s$), and specificity ($c$).",
            "answer": "$$\\boxed{\\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)}}$$"
        }
    ]
}