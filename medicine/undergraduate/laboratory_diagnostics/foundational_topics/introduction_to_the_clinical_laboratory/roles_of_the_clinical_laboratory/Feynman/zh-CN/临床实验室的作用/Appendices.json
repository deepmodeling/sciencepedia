{
    "hands_on_practices": [
        {
            "introduction": "临床实验室的核心作用不仅是生成一个检测数值，更是提供关于该数值如何辅助临床诊断的信息。本练习将向您展示如何将灵敏度和特异性等抽象的测试性能指标，转化为具有临床实用价值的度量，如阳性预测值 ($PPV$)。这些指标直接回答了关键问题：“如果检测结果为阳性，我的病人患病的概率有多大？”，从而架起了从测试性能到以患者为中心的临床解读之间的桥梁。",
            "id": "5236897",
            "problem": "一个临床实验室正在评估一种新的单阈值诊断检测方法，该方法用于检测一种人群患病率为 $0.15$ 的疾病。在选定的决策阈值下，该检测方法的灵敏度为 $0.92$，特异度为 $0.88$。临床实验室的职责包括量化这些操作特性如何转化为测试后的可解释性以及整体的区分能力，以支持临床决策。\n\n仅使用基本概率定义、贝叶斯定理以及正态分布作为连续检测结果模型的标准属性，按以下步骤进行：\n\n1. 根据灵敏度、特异度的核心定义以及疾病患病率，推导出阳性预测值 (PPV) 和阴性预测值 (NPV) 的表达式，并计算其数值。\n2. 使用似然比 (LR) 的定义，即在患病状态下获得某一检测结果的概率与在非患病状态下获得该结果的概率之比，推导并计算给定灵敏度和特异度下的阳性似然比 ($LR^{+}$) 和阴性似然比 ($LR^{-}$)。\n3. 为了将单个操作点与预期的整体区分性能联系起来，假设连续检测测量值服从等方差双正态模型：非患病者的结果服从标准正态分布，患病者的结果服从一个具有未知均值漂移但方差相同的正态分布。利用该模型下受试者工作特征 (ROC) 曲线的定义属性，用标准化均值差表示曲线下面积 (AUC)，根据固定阈值下观察到的灵敏度和特异度推断出此均值差，并计算预期的 AUC。\n\n将 $PPV$、$NPV$、$LR^{+}$、$LR^{-}$ 和 $AUC$ 的最终数值以小数形式报告。将每个值四舍五入到四位有效数字。",
            "solution": "设 $D$ 为受试者患有该疾病的事件，$D^c$ 为受试者未患该疾病的事件。设 $T^+$ 为检测结果为阳性的事件，$T^-$ 为检测结果为阴性的事件。\n\n已知信息如下：\n- 人群患病率: $P(D) = 0.15$\n- 灵敏度 (真阳性率, TPR): $\\text{Sens} = P(T^+|D) = 0.92$\n- 特异度 (真阴性率, TNR): $\\text{Spec} = P(T^-|D^c) = 0.88$\n\n由此，我们可以推导出其他基本概率：\n- 未患病概率: $P(D^c) = 1 - P(D) = 1 - 0.15 = 0.85$\n- 假阳性率 (FPR): $P(T^+|D^c) = 1 - P(T^-|D^c) = 1 - \\text{Spec} = 1 - 0.88 = 0.12$\n- 假阴性率 (FNR): $P(T^-|D) = 1 - P(T^+|D) = 1 - \\text{Sens} = 1 - 0.92 = 0.08$\n\n**1. 阳性预测值 (PPV) 和阴性预测值 (NPV)**\n\n阳性预测值 $PPV = P(D|T^+)$，是指检测结果为阳性的受试者确实患有该疾病的概率。使用贝叶斯定理：\n$$PPV = P(D|T^+) = \\frac{P(T^+|D)P(D)}{P(T^+)}$$\n为了求得 $P(T^+)$，即检测结果为阳性的总概率，我们使用全概率公式：\n$$P(T^+) = P(T^+|D)P(D) + P(T^+|D^c)P(D^c)$$\n代入已知值：\n$$P(T^+) = (0.92)(0.15) + (0.12)(0.85) = 0.138 + 0.102 = 0.24$$\n现在我们可以计算 $PPV$：\n$$PPV = \\frac{0.138}{0.24} = 0.575$$\n\n阴性预测值 $NPV = P(D^c|T^-)$，是指检测结果为阴性的受试者确实未患病的概率。使用贝叶斯定理：\n$$NPV = P(D^c|T^-) = \\frac{P(T^-|D^c)P(D^c)}{P(T^-)}$$\n为了求得 $P(T^-)$，即检测结果为阴性的总概率，我们可以用 $P(T^-) = 1 - P(T^+) = 1 - 0.24 = 0.76$。或者，使用全概率公式：\n$$P(T^-) = P(T^-|D)P(D) + P(T^-|D^c)P(D^c) = (0.08)(0.15) + (0.88)(0.85) = 0.012 + 0.748 = 0.76$$\n现在我们可以计算 $NPV$：\n$$NPV = \\frac{(0.88)(0.85)}{0.76} = \\frac{0.748}{0.76} \\approx 0.9842105$$\n\n**2. 似然比 ($LR^+$ and $LR^-$)**\n\n阳性似然比 $LR^+$，是患病受试者中出现阳性检测结果的概率与非患病受试者中出现阳性检测结果的概率之比。\n$$LR^+ = \\frac{P(T^+|D)}{P(T^+|D^c)} = \\frac{\\text{Sens}}{1 - \\text{Spec}}$$\n代入数值：\n$$LR^+ = \\frac{0.92}{0.12} = \\frac{92}{12} = \\frac{23}{3} \\approx 7.6666...$$\n\n阴性似然比 $LR^-$，是患病受试者中出现阴性检测结果的概率与非患病受试者中出现阴性检测结果的概率之比。\n$$LR^- = \\frac{P(T^-|D)}{P(T^-|D^c)} = \\frac{1 - \\text{Sens}}{\\text{Spec}}$$\n代入数值：\n$$LR^- = \\frac{0.08}{0.88} = \\frac{8}{88} = \\frac{1}{11} \\approx 0.090909...$$\n\n**3. 曲线下面积 (AUC)**\n\n我们假设一个等方差双正态模型。设非患病受试者的连续检测测量值为一个随机变量 $X_{D^c} \\sim \\mathcal{N}(0, 1)$，服从标准正态分布。对于患病受试者，其测量值为 $X_D \\sim \\mathcal{N}(\\mu_D, 1)$，方差相同但均值有漂移 $\\mu_D$。\n\n设 $c$ 为决策阈值。如果测量值超过 $c$，则检测结果为阳性。\n特异度是非患病受试者检测结果为阴性的概率：\n$$\\text{Spec} = P(X_{D^c} \\le c) = \\Phi(c)$$\n其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。\n给定 $\\text{Spec} = 0.88$，我们有 $\\Phi(c) = 0.88$，这意味着 $c = \\Phi^{-1}(0.88)$。\n\n灵敏度是患病受试者检测结果为阳性的概率：\n$$\\text{Sens} = P(X_D > c) = 1 - P(X_D \\le c)$$\n为了计算 $P(X_D \\le c)$，我们将变量标准化：$Z = \\frac{X_D - \\mu_D}{1} \\sim \\mathcal{N}(0,1)$。\n$$P(X_D \\le c) = P\\left(\\frac{X_D - \\mu_D}{1} \\le \\frac{c - \\mu_D}{1}\\right) = \\Phi(c - \\mu_D)$$\n因此，$\\text{Sens} = 1 - \\Phi(c - \\mu_D)$。给定 $\\text{Sens}=0.92$，我们有：\n$$0.92 = 1 - \\Phi(c - \\mu_D) \\implies \\Phi(c - \\mu_D) = 0.08$$\n这意味着 $c - \\mu_D = \\Phi^{-1}(0.08)$。\n\n我们现在有一个包含两个方程的方程组，用以求解标准化均值差 $\\mu_D$：\n1. $c = \\Phi^{-1}(0.88)$\n2. $c - \\mu_D = \\Phi^{-1}(0.08)$\n\n将第一个方程代入第二个方程得到：\n$$\\Phi^{-1}(0.88) - \\mu_D = \\Phi^{-1}(0.08)$$\n求解 $\\mu_D$：\n$$\\mu_D = \\Phi^{-1}(0.88) - \\Phi^{-1}(0.08)$$\n利用标准正态分布的对称性，$\\Phi^{-1}(p) = -\\Phi^{-1}(1-p)$，我们有 $\\Phi^{-1}(0.08) = -\\Phi^{-1}(1-0.08) = -\\Phi^{-1}(0.92)$。\n$$\\mu_D = \\Phi^{-1}(0.88) + \\Phi^{-1}(0.92)$$\n使用标准统计表或软件，我们找到分位数：\n$\\Phi^{-1}(0.88) \\approx 1.174987$\n$\\Phi^{-1}(0.92) \\approx 1.405072$\n因此，均值差为：\n$$\\mu_D \\approx 1.174987 + 1.405072 = 2.580059$$\n\n对于等方差双正态模型，ROC 曲线下面积 (AUC) 由以下公式给出：\n$$AUC = \\Phi\\left(\\frac{\\mu_D}{\\sqrt{2}}\\right)$$\n代入 $\\mu_D$ 的值：\n$$AUC = \\Phi\\left(\\frac{2.580059}{\\sqrt{2}}\\right) \\approx \\Phi(1.82436)$$\n使用标准正态分布的累积分布函数，我们求得 AUC：\n$$AUC \\approx 0.965935$$\n\n最后，我们将所有计算值四舍五入到四位有效数字：\n- $PPV = 0.575 \\rightarrow 0.5750$\n- $NPV \\approx 0.9842105 \\rightarrow 0.9842$\n- $LR^+ \\approx 7.6666... \\rightarrow 7.667$\n- $LR^- \\approx 0.090909... \\rightarrow 0.09091$\n- $AUC \\approx 0.965935 \\rightarrow 0.9659$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.5750  0.9842  7.667  0.09091  0.9659 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个可靠的检测结果始于一份合格的标本，确保结果的准确性是实验室的首要职责之一。本练习将探讨实验室在分析前阶段的关键作用，即识别并量化那些可能干扰检测的物质，例如因红细胞破裂（溶血）而释放的血红蛋白。通过这个假设场景，您将计算干扰物质所导致的预期误差，并依据实验室的质量政策来判断样本是否合格，这体现了实验室在保障数据完整性中的门控作用。",
            "id": "5236877",
            "problem": "临床实验室的临床化学部采用间接离子选择电极法（ISE）进行血清钾检测。该实验室通过溶血指数来监测分析前溶血，该指数报告为血清中游离血红蛋白的浓度。在一次方法学评价中，钾的检测方法表现出游离血红蛋白的线性正干扰：在经过验证的线性范围内，游离血红蛋白每增加 $0.3$ g/L，测得的钾浓度增加 $+0.3$ mmol/L。一份患者样本送达，其溶血指数对应于 $0.5$ g/L 的游离血红蛋白浓度。该实验室的样本接收政策规定，由溶血引起的钾检测最大允许绝对偏倚为 $0.3$ mmol/L。\n\n从分析干扰在验证的线性范围内会产生与干扰物浓度成正比的系统误差这一基本定义出发，计算该钾检测结果中预期的溶血所致偏倚，并根据既定政策判断该样本是否应被拒收。将决策编码为 $D$，如果样本必须被拒收（预期偏倚严格大于允许阈值），则 $D = 1$，否则 $D = 0$。将 $D$ 作为您的最终答案报告（无单位）。",
            "solution": "问题要求根据溶血引起的血清钾测量中的预期分析偏倚，来判断一份患者样本是否应该被拒收。该决策将被编码为一个二元变量 $D$。\n\n首先，我们必须将干扰物（游离血红蛋白）的浓度与钾测量中产生的偏倚之间的关系形式化。问题指出该干扰是线性的，意味着偏倚与游离血红蛋白的浓度成正比。设 $C_{Hb}$ 为游离血红蛋白的浓度（单位 g/L），$\\Delta K$ 为由此产生的钾浓度正偏倚（单位 mmol/L）。该关系可以表示为：\n$$\n\\Delta K = k \\cdot C_{Hb}\n$$\n其中 $k$ 是比例常数，或称干扰系数。\n\n问题提供了确定 $k$ 值所需的信息。问题中提到，“游离血红蛋白每增加 $0.3$ g/L，测得的钾浓度增加 $+0.3$ mmol/L”。这可以写成：\n$$\n+0.3 \\text{ mmol/L} = k \\cdot (0.3 \\text{ g/L})\n$$\n求解 $k$ 可得：\n$$\nk = \\frac{0.3 \\text{ mmol/L}}{0.3 \\text{ g/L}} = 1.0 \\frac{\\text{mmol/L}}{\\text{g/L}}\n$$\n这个常数衡量了干扰的程度。由于这种特定的分析干扰，游离血红蛋白每增加 $1$ g/L，测得的钾浓度预计将增加 $1.0$ mmol/L。\n\n接下来，我们将此关系应用于所讨论的患者样本。该样本的溶血指数对应的游离血红蛋白浓度为 $C_{Hb, patient} = 0.5$ g/L。我们可以使用推导出的干扰系数 $k$ 来计算该样本的预期偏倚 $\\Delta K_{patient}$：\n$$\n\\Delta K_{patient} = k \\cdot C_{Hb, patient} = \\left(1.0 \\frac{\\text{mmol/L}}{\\text{g/L}}\\right) \\cdot (0.5 \\text{ g/L})\n$$\n$$\n\\Delta K_{patient} = 0.5 \\text{ mmol/L}\n$$\n因此，对于这个特定样本，钾检测结果中预期的溶血所致偏倚为 $+0.5$ mmol/L。\n\n最后一步是将计算出的偏倚与实验室的样本接收政策进行比较。该政策规定，最大允许绝对偏倚，我们称之为 $\\text{Bias}_{max}$，是 $0.3$ mmol/L。如果预期偏倚 *严格大于* 此阈值，则必须拒收样本。拒收的条件是：\n$$\n|\\Delta K_{patient}| > \\text{Bias}_{max}\n$$\n问题指明是正干扰，因此 $\\Delta K_{patient}$ 是正值，其绝对值等于其本身。阈值为 $\\text{Bias}_{max} = 0.3$ mmol/L。我们必须检查以下不等式是否成立：\n$$\n0.5 \\text{ mmol/L} > 0.3 \\text{ mmol/L}\n$$\n这个不等式是成立的，因为 $0.5$ 确实大于 $0.3$。\n\n由于满足了拒收条件，该样本必须被拒收。问题定义了一个决策变量 $D$，其中 $D=1$ 表示拒收，$D=0$ 表示接收（或不拒收）。因为样本必须被拒收，所以决策变量的值为 $D=1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "临床决策往往不仅依赖于单次检测结果，更要关注患者病情随时间的变化趋势。本练习将演示实验室如何利用“差量检查”(delta checks)这一自动化质量工具，来评估患者连续两次检测结果之间的变化是否具有统计学意义。通过计算相对变化并将其与参考变化值 ($RCV$) 进行比较，您将能实践一个区分真实生理变化与分析随机性的关键质控流程。",
            "id": "5236910",
            "problem": "一家医院的临床实验室进行差值审核，以支持分析后审查和解释性报告。对于一位患者的系列血红蛋白结果，前一次的有效值为 $9.8$ g/dL，当前结果为 $11.5$ g/dL。该实验室使用参考变化值 (RCV) 来判断连续结果之间的变化是否可能具有临床和分析上的显著性；该实验室血红蛋白的RCV为 $8.0\\%$，该值由分析变异和个体内生物学变异共同导出。如果两次连续结果之间的绝对相对变化超过RCV，实验室会在报告中附加一条解释性注释。\n\n使用临床差值审核中相对变化的标准定义以及所述的RCV决策规则，计算两个血红蛋白结果之间的差值百分比变化，并判断是否超过RCV标准。将差值百分比变化表示为一个无单位的小数（不带百分号），并将您的答案四舍五入到四位有效数字。只提供该差值百分比变化作为您的最终数值答案。",
            "solution": "任务是计算一位患者两次连续血红蛋白测量值之间的相对变化，并判断该变化是否超过预定义的参考变化值 (RCV)。\n\n首先，我们定义给定的变量：\n前一次的血红蛋白值为 $H_{prev} = 9.8$ g/dL。\n当前的血红蛋白值为 $H_{curr} = 11.5$ g/dL。\n参考变化值阈值以百分比形式给出，$RCV_{\\%} = 8.0\\%$。为了计算，我们将其表示为无单位的小数：$RCV = 0.080$。\n\n差值审核计算涉及计算相对变化，我们将其表示为 $\\Delta_{rel}$。在临床背景下，其标准定义是相对于前一次值的变化量。公式为：\n$$ \\Delta_{rel} = \\frac{H_{curr} - H_{prev}}{H_{prev}} $$\n\n将给定值代入此公式：\n$$ \\Delta_{rel} = \\frac{11.5 - 9.8}{9.8} $$\n$$ \\Delta_{rel} = \\frac{1.7}{9.8} $$\n\n进行除法运算，得出相对变化的数值：\n$$ \\Delta_{rel} \\approx 0.1734693877... $$\n\n实验室的决策规则基于绝对相对变化是否超过RCV。绝对相对变化为：\n$$ |\\Delta_{rel}| = |0.1734693877...| \\approx 0.17347 $$\n\n现在我们将此值与RCV进行比较：\n$$ |\\Delta_{rel}| \\approx 0.17347 \\text{ and } RCV = 0.080 $$\n由于 $0.17347 > 0.080$，两个血红蛋白结果之间的绝对相对变化确实超过了实验室的RCV标准。这表明该变化具有统计学显著性，可能需要在报告中附加解释性注释。\n\n问题要求最终答案是“表示为无单位小数的差值百分比变化”，并四舍五入到四位有效数字。这种措辞，特别是“不带百分号”的说明，表明我们应该提供 $\\Delta_{rel}$ 的值。我们必须将 $\\Delta_{rel}$ 的计算值四舍五入到四位有效数字。\n\n计算值为 $\\Delta_{rel} \\approx 0.1734693877...$。\n前四位有效数字是 $1$、$7$、$3$ 和 $4$。第五位有效数字是 $6$，大于或等于 $5$，因此我们必须将第四位有效数字向上取整。\n$$ \\Delta_{rel, rounded} = 0.1735 $$\n\n这就是所要求的、表示为无单位小数并四舍五入到四位有效数字的差值百分比变化。",
            "answer": "$$\\boxed{0.1735}$$"
        }
    ]
}