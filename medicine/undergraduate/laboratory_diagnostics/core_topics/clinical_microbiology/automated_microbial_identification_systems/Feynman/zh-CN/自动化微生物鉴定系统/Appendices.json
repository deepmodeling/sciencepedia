{
    "hands_on_practices": [
        {
            "introduction": "现代微生物鉴定在很大程度上依赖于MALDI-TOF质谱等技术，该技术通过测量细菌蛋白质的质量来生成独特的“指纹”图谱。这种测量的准确性至关重要。本练习旨在探讨质谱校准误差（一个在质谱分析中常见的问题）所带来的实际后果，以及它如何影响系统将测得的图谱与参考数据库进行匹配的能力。",
            "id": "5208469",
            "problem": "一套基于基质辅助激光解吸/电离飞行时间质谱 (MALDI-TOF MS) 的自动化微生物鉴定系统会生成一个指纹图谱，该图谱由一系列显著的离子峰构成，这些离子峰主要对应于质量范围在 $[2, 20]\\,\\mathrm{kDa}$ 内的完整核糖体蛋白。假设如下：\n\n- 一个系统性的质量校准误差在整个质量范围内产生了一个恒定的 $50\\,\\mathrm{ppm}$ 的相对质量偏移。根据定义，百万分之几 (ppm) 误差意味着相对误差为 $50 \\times 10^{-6}$。\n- 如果一个峰的绝对质量偏差在 $\\pm 0.3\\,\\mathrm{Da}$ 的绝对容差窗口内，匹配算法就判定该峰与参考库正确匹配。\n- 指纹图谱中的峰在 $[2, 20]\\,\\mathrm{kDa}$ 质量范围内呈均匀分布。\n- 将匹配准确度定义为：在 $50\\,\\mathrm{ppm}$ 的系统性校准误差下，$[2, 20]\\,\\mathrm{kDa}$ 范围内的峰满足匹配标准的比例。\n\n仅使用上述定义和假设，计算匹配准确度，结果应为一个实数。请将您的最终答案表示为无量纲小数，并四舍五入至四位有效数字。",
            "solution": "用户提供了一个需要解决的问题，我的首要职责是验证其完整性。\n\n### 第 1 步：提取已知条件\n问题陈述提供了以下数据和定义：\n- **质量范围：**系统分析质量范围在 $[2, 20]\\,\\mathrm{kDa}$ 内的峰。\n- **系统误差：**恒定的相对质量偏移 $\\delta = 50\\,\\mathrm{ppm}$。\n- **ppm 误差的定义：**相对误差明确定义为 $50 \\times 10^{-6}$。\n- **匹配标准：**如果一个峰的绝对质量偏差在 $\\pm T$ 的容差窗口内，则认为该峰匹配，其中 $T = 0.3\\,\\mathrm{Da}$。\n- **峰分布：**指纹图谱的峰在 $[2, 20]\\,\\mathrm{kDa}$ 区间内呈质量均匀分布。\n- **匹配准确度的定义：**在指定质量范围内满足匹配标准的峰的比例。\n- **要求输出：**匹配准确度，表示为一个实数，四舍五入到四位有效数字。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行验证检查。\n- **科学依据：**该问题基于质谱分析原理，特别是 MALDI-TOF MS，这是分析化学和微生物学中的一种标准技术。给定的参数——核糖体蛋白的质量范围、用于质量精度的 ppm 误差以及道尔顿级别的容差——对于这类仪器是符合实际的。该问题是对仪器性能评估的一个有效且简化的模型。\n- **良态问题：**该问题是良态的。它提供了所有必要的信息：质量范围、系统误差的性质和大小、匹配容差以及变量（质量）的分布。这使得可以计算出唯一、稳定且有意义的匹配准确度解。\n- **客观性：**语言是技术性的，没有主观性。所有术语都进行了定量定义。\n\n该问题没有表现出任何缺陷，如科学上的不健全、不完整、矛盾或模糊不清。这是一个可以形式化的物理学和统计学问题。\n\n### 第 3 步：结论和行动\n该问题被判定为**有效**。我将继续提供完整解答。\n\n### 解题推导\n\n设 $m$ 是一个蛋白质峰的真实质量。问题指出，我们关注的质量范围是 $[2, 20]\\,\\mathrm{kDa}$。为了方便计算，我们使用单一的质量单位道尔顿 ($\\mathrm{Da}$)，其中 $1\\,\\mathrm{kDa} = 1000\\,\\mathrm{Da}$。因此，质量范围为 $[2000, 20000]\\,\\mathrm{Da}$。设该范围的下限和上限分别为 $m_{min} = 2000\\,\\mathrm{Da}$ 和 $m_{max} = 20000\\,\\mathrm{Da}$。\n\n系统引入了一个恒定的相对质量偏移 $\\delta$。给定其值为 $50\\,\\mathrm{ppm}$，定义为：\n$$ \\delta = 50 \\times 10^{-6} $$\n\n对于真实质量 $m$，观测质量 $m_{obs}$ 会发生偏移。绝对质量偏差 $\\Delta m$ 是观测质量与真实质量之差的绝对值：\n$$ \\Delta m = |m_{obs} - m| $$\n给定相对误差 $\\delta$，观测质量为 $m_{obs} = m(1 \\pm \\delta)$。问题中的“质量偏移”一词暗示了方向性误差，但匹配标准基于“绝对质量偏差”，因此偏移的符号对偏差的大小无关紧要。偏差为：\n$$ \\Delta m = |m(1+\\delta) - m| = |m\\delta| $$\n由于质量 $m$ 和相对误差因子 $\\delta$ 都是正数，我们可以写成：\n$$ \\Delta m = m\\delta $$\n该方程表明，绝对质量偏差不是恒定的，而是随质量 $m$ 线性增加。\n\n如果一个峰的绝对质量偏差在指定的容差窗口内，则该峰被正确匹配。设容差为 $T = 0.3\\,\\mathrm{Da}$。匹配标准是：\n$$ \\Delta m \\le T $$\n代入 $\\Delta m$ 的表达式，成功匹配的条件变为：\n$$ m\\delta \\le T $$\n\n这个不等式定义了峰能被正确识别的质量范围。我们可以求解满足匹配标准的最大质量，称之为 $m_{crit}$。在这个临界质量下，偏差恰好等于容差：\n$$ m_{crit}\\delta = T $$\n求解 $m_{crit}$：\n$$ m_{crit} = \\frac{T}{\\delta} $$\n代入给定值：\n$$ m_{crit} = \\frac{0.3\\,\\mathrm{Da}}{50 \\times 10^{-6}} = \\frac{0.3}{5 \\times 10^{-5}} = \\frac{3 \\times 10^{-1}}{5 \\times 10^{-5}} = 0.6 \\times 10^{4}\\,\\mathrm{Da} = 6000\\,\\mathrm{Da} $$\n\n任何质量为 $m \\le m_{crit}$ 的峰都将满足匹配标准 ($m\\delta \\le T$)，而任何质量为 $m > m_{crit}$ 的峰都将不满足。因此，在仪器的操作范围 $[m_{min}, m_{max}]$ 内，成功匹配的峰的质量范围是 $[m_{min}, m_{crit}]$，因为 $m_{min} = 2000\\,\\mathrm{Da}  m_{crit} = 6000\\,\\mathrm{Da}$ 且 $m_{max} = 20000\\,\\mathrm{Da} > m_{crit}$。成功匹配的具体区间是 $[2000, 6000]\\,\\mathrm{Da}$。\n\n问题将匹配准确度定义为被正确匹配的峰的比例。题目说明峰在整个质量范围 $[m_{min}, m_{max}]$ 内呈均匀分布。对于均匀分布，这个比例等于“已匹配”质量区间的长度与总质量区间长度之比。\n\n总质量区间的长度 $L_{total}$：\n$$ L_{total} = m_{max} - m_{min} = 20000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 18000\\,\\mathrm{Da} $$\n\n成功匹配的质量区间的长度 $L_{matched}$：\n$$ L_{matched} = m_{crit} - m_{min} = 6000\\,\\mathrm{Da} - 2000\\,\\mathrm{Da} = 4000\\,\\mathrm{Da} $$\n\n匹配准确度，我们记作 $A$，是以下比率：\n$$ A = \\frac{L_{matched}}{L_{total}} = \\frac{4000}{18000} = \\frac{4}{18} = \\frac{2}{9} $$\n\n为了给出最终答案，我们必须将此分数表示为小数，并四舍五入到四位有效数字。\n$$ A = \\frac{2}{9} = 0.22222... $$\n四舍五入到四位有效数字得到 $0.2222$。",
            "answer": "$$ \\boxed{0.2222} $$"
        },
        {
            "introduction": "自动化系统在收集到数据后——无论是来自生化测试还是质谱图——它必须运用一个逻辑框架来得出鉴定结果。许多系统采用基于贝叶斯定理的概率方法来确定最有可能的微生物。这个动手实践将让你扮演系统算法的角色，挑战你根据一组生化反应模式和已知的物种概率数据，计算出最有可能的物种。",
            "id": "5208490",
            "problem": "一个自动化的微生物鉴定系统评估一个包含 $20$ 个生化孔板的测试板，每个孔板产生一个二元反应结果 $R_{i} \\in \\{0,1\\}$，其中 $1$ 表示阳性反应，$0$ 表示阴性反应。假设在给定微生物种类 $S \\in \\{1,2,3\\}$ 的条件下，各孔板之间是条件独立的，并且每个孔板都有一个特定于该种类的阳性概率。该鉴定引擎使用基于贝叶斯定理的最大后验 (MAP) 估计。物种的先验概率为 $P(S=1)=0.5$，$P(S=2)=0.3$ 和 $P(S=3)=0.2$。\n\n这 $20$ 个孔板被分为四个生化特性一致的组，对于给定的物种，每个组内的条件阳性概率相同：\n- $\\mathcal{C}$ 组（碳水化合物利用）：孔板 $1$–$5$。\n- $\\mathcal{D}$ 组（氨基酸脱羧酶）：孔板 $6$–$12$。\n- $\\mathcal{E}$ 组（酶活性）：孔板 $13$–$15$。\n- $\\mathcal{M}$ 组（其他反应）：孔板 $16$–$20$。\n\n对于每个物种 $s \\in \\{1,2,3\\}$ 和组 $G \\in \\{\\mathcal{C},\\mathcal{D},\\mathcal{E},\\mathcal{M}\\}$，该组中任意孔板出现阳性反应的条件概率为 $p_{G|s}$，具体如下：\n- $p_{\\mathcal{C}|1}=0.9$, $p_{\\mathcal{C}|2}=0.6$, $p_{\\mathcal{C}|3}=0.3$。\n- $p_{\\mathcal{D}|1}=0.2$, $p_{\\mathcal{D}|2}=0.7$, $p_{\\mathcal{D}|3}=0.4$。\n- $p_{\\mathcal{E}|1}=0.95$, $p_{\\mathcal{E}|2}=0.5$, $p_{\\mathcal{E}|3}=0.8$。\n- $p_{\\mathcal{M}|1}=0.4$, $p_{\\mathcal{M}|2}=0.3$, $p_{\\mathcal{M}|3}=0.6$。\n\n一个样本产生以下观测到的反应向量 $\\mathbf{r}=(r_{1},\\dots,r_{20})$：\n- 孔板 $1$–$5$：$\\{1,1,1,1,0\\}$。\n- 孔板 $6$–$12$：$\\{1,0,0,1,0,0,0\\}$。\n- 孔板 $13$–$15$：$\\{1,1,1\\}$。\n- 孔板 $16$–$20$：$\\{0,0,0,1,0\\}$。\n\n使用贝叶斯定理和各孔之间条件独立的假设，计算最大后验物种分配。将你的最终答案表示为物种索引 $s^{*} \\in \\{1,2,3\\}$。无需四舍五入。",
            "solution": "该问题要求对于给定的一组生化反应结果，确定最大后验 (MAP) 物种分配。物种 $S$ 的 MAP 估计 $s^{*}$ 是使后验概率 $P(S=s | \\mathbf{R}=\\mathbf{r})$ 最大化的 $s \\in \\{1,2,3\\}$ 的值，其中 $\\mathbf{r}$ 是观测到的反应向量。\n\n根据贝叶斯定理，后验概率由下式给出：\n$$\nP(S=s | \\mathbf{R}=\\mathbf{r}) = \\frac{P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)}{P(\\mathbf{R}=\\mathbf{r})}\n$$\n分母 $P(\\mathbf{R}=\\mathbf{r})$ 是观测到数据的边际概率，对于所有物种 $s$ 都是常数。因此，为了找到使后验概率最大化的物种，我们只需要最大化分子，该分子与后验概率成正比。我们为每个物种 $s$ 定义一个分数 $\\text{Score}(s)$，即这个分子：\n$$\n\\text{Score}(s) = P(\\mathbf{R}=\\mathbf{r} | S=s) P(S=s)\n$$\nMAP 估计则为 $s^{*} = \\arg\\max_{s \\in \\{1,2,3\\}} \\text{Score}(s)$。\n\n项 $P(\\mathbf{R}=\\mathbf{r} | S=s)$ 是在给定物种 $s$ 的情况下观测到反应向量 $\\mathbf{r}$ 的似然。问题陈述，在给定物种 $S$ 的条件下，这 $20$ 个生化孔板是条件独立的。因此，似然是各个反应结果概率的乘积：\n$$\nP(\\mathbf{R}=\\mathbf{r} | S=s) = \\prod_{i=1}^{20} P(R_i=r_i | S=s)\n$$\n孔板被分为四个组 $\\mathcal{C}, \\mathcal{D}, \\mathcal{E}, \\mathcal{M}$，其大小分别为 $n_{\\mathcal{C}}=5$, $n_{\\mathcal{D}}=7$, $n_{\\mathcal{E}}=3$ 和 $n_{\\mathcal{M}}=5$。在每个组 $G$ 内，阳性反应的条件概率 $P(R_i=1 | S=s)$ 是一个常数，记为 $p_{G|s}$。阴性反应的概率是 $P(R_i=0 | S=s) = 1 - p_{G|s}$。\n\n设 $k_G$ 为在组 $G$ 中观测到的阳性反应数量。组 $G$ 对总似然的贡献是 $p_{G|s}^{k_G} (1 - p_{G|s})^{n_G - k_G}$。总似然 $L(s) = P(\\mathbf{R}=\\mathbf{r} | S=s)$ 是这些贡献的乘积：\n$$\nL(s) = \\left( p_{\\mathcal{C}|s}^{k_{\\mathcal{C}}} (1-p_{\\mathcal{C}|s})^{n_{\\mathcal{C}} - k_{\\mathcal{C}}} \\right) \\left( p_{\\mathcal{D}|s}^{k_{\\mathcal{D}}} (1-p_{\\mathcal{D}|s})^{n_{\\mathcal{D}} - k_{\\mathcal{D}}} \\right) \\left( p_{\\mathcal{E}|s}^{k_{\\mathcal{E}}} (1-p_{\\mathcal{E}|s})^{n_{\\mathcal{E}} - k_{\\mathcal{E}}} \\right) \\left( p_{\\mathcal{M}|s}^{k_{\\mathcal{M}}} (1-p_{\\mathcal{M}|s})^{n_{\\mathcal{M}} - k_{\\mathcal{M}}} \\right)\n$$\n根据观测到的反应向量 $\\mathbf{r}$：\n- $\\mathcal{C}$ 组（孔板 $1$–$5$）：$\\{1,1,1,1,0\\}$。因此，$k_{\\mathcal{C}}=4$ 且 $n_{\\mathcal{C}}-k_{\\mathcal{C}}=1$。\n- $\\mathcal{D}$ 组（孔板 $6$–$12$）：$\\{1,0,0,1,0,0,0\\}$。因此，$k_{\\mathcal{D}}=2$ 且 $n_{\\mathcal{D}}-k_{\\mathcal{D}}=5$。\n- $\\mathcal{E}$ 组（孔板 $13$–$15$）：$\\{1,1,1\\}$。因此，$k_{\\mathcal{E}}=3$ 且 $n_{\\mathcal{E}}-k_{\\mathcal{E}}=0$。\n- $\\mathcal{M}$ 组（孔板 $16$–$20$）：$\\{0,0,0,1,0\\}$。因此，$k_{\\mathcal{M}}=1$ 且 $n_{\\mathcal{M}}-k_{\\mathcal{M}}=4$。\n\n现在我们计算每个物种的分数。\n\n对于物种 $S=1$：\n先验概率为 $P(S=1)=0.5$。条件概率为 $p_{\\mathcal{C}|1}=0.9$, $p_{\\mathcal{D}|1}=0.2$, $p_{\\mathcal{E}|1}=0.95$ 和 $p_{\\mathcal{M}|1}=0.4$。\n似然为：\n$L(1) = (0.9^{4} \\cdot (1-0.9)^{1}) \\cdot (0.2^{2} \\cdot (1-0.2)^{5}) \\cdot (0.95^{3} \\cdot (1-0.95)^{0}) \\cdot (0.4^{1} \\cdot (1-0.4)^{4})$\n$L(1) = (0.9^{4} \\cdot 0.1^{1}) \\cdot (0.2^{2} \\cdot 0.8^{5}) \\cdot (0.95^{3} \\cdot 0.05^{0}) \\cdot (0.4^{1} \\cdot 0.6^{4})$\n$L(1) = (0.6561 \\cdot 0.1) \\cdot (0.04 \\cdot 0.32768) \\cdot (0.857375 \\cdot 1) \\cdot (0.4 \\cdot 0.1296)$\n$L(1) = (0.06561) \\cdot (0.0131072) \\cdot (0.857375) \\cdot (0.05184)$\n$L(1) \\approx 3.82216 \\times 10^{-5}$\n分数为：\n$\\text{Score}(1) = L(1) \\cdot P(S=1) \\approx (3.82216 \\times 10^{-5}) \\cdot 0.5 = 1.91108 \\times 10^{-5}$\n\n对于物种 $S=2$：\n先验概率为 $P(S=2)=0.3$。条件概率为 $p_{\\mathcal{C}|2}=0.6$, $p_{\\mathcal{D}|2}=0.7$, $p_{\\mathcal{E}|2}=0.5$ 和 $p_{\\mathcal{M}|2}=0.3$。\n似然为：\n$L(2) = (0.6^{4} \\cdot (1-0.6)^{1}) \\cdot (0.7^{2} \\cdot (1-0.7)^{5}) \\cdot (0.5^{3} \\cdot (1-0.5)^{0}) \\cdot (0.3^{1} \\cdot (1-0.3)^{4})$\n$L(2) = (0.6^{4} \\cdot 0.4^{1}) \\cdot (0.7^{2} \\cdot 0.3^{5}) \\cdot (0.5^{3} \\cdot 0.5^{0}) \\cdot (0.3^{1} \\cdot 0.7^{4})$\n$L(2) = (0.1296 \\cdot 0.4) \\cdot (0.49 \\cdot 0.00243) \\cdot (0.125 \\cdot 1) \\cdot (0.3 \\cdot 0.2401)$\n$L(2) = (0.05184) \\cdot (0.0011907) \\cdot (0.125) \\cdot (0.07203)$\n$L(2) \\approx 5.55806 \\times 10^{-7}$\n分数为：\n$\\text{Score}(2) = L(2) \\cdot P(S=2) \\approx (5.55806 \\times 10^{-7}) \\cdot 0.3 = 1.66742 \\times 10^{-7}$\n\n对于物种 $S=3$：\n先验概率为 $P(S=3)=0.2$。条件概率为 $p_{\\mathcal{C}|3}=0.3$, $p_{\\mathcal{D}|3}=0.4$, $p_{\\mathcal{E}|3}=0.8$ 和 $p_{\\mathcal{M}|3}=0.6$。\n似然为：\n$L(3) = (0.3^{4} \\cdot (1-0.3)^{1}) \\cdot (0.4^{2} \\cdot (1-0.4)^{5}) \\cdot (0.8^{3} \\cdot (1-0.8)^{0}) \\cdot (0.6^{1} \\cdot (1-0.6)^{4})$\n$L(3) = (0.3^{4} \\cdot 0.7^{1}) \\cdot (0.4^{2} \\cdot 0.6^{5}) \\cdot (0.8^{3} \\cdot 0.2^{0}) \\cdot (0.6^{1} \\cdot 0.4^{4})$\n$L(3) = (0.0081 \\cdot 0.7) \\cdot (0.16 \\cdot 0.07776) \\cdot (0.512 \\cdot 1) \\cdot (0.6 \\cdot 0.0256)$\n$L(3) = (0.00567) \\cdot (0.0124416) \\cdot (0.512) \\cdot (0.01536)$\n$L(3) \\approx 5.54755 \\times 10^{-7}$\n分数为：\n$\\text{Score}(3) = L(3) \\cdot P(S=3) \\approx (5.54755 \\times 10^{-7}) \\cdot 0.2 = 1.10951 \\times 10^{-7}$\n\n比较分数：\n$\\text{Score}(1) \\approx 1.91108 \\times 10^{-5}$\n$\\text{Score}(2) \\approx 1.66742 \\times 10^{-7}$\n$\\text{Score}(3) \\approx 1.10951 \\times 10^{-7}$\n\n由于 $1.91108 \\times 10^{-5}$ 是最大值，所以物种 $s=1$ 的分数最高。\n因此，最大后验物种分配为 $s^{*}=1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "一个鉴定系统的性能并非绝对的；我们必须对其进行严格评估，尤其是在处理近缘物种时。本问题模拟了一个临床实验室中的真实场景：对某些物种的精确鉴定充满挑战，且容易出错。你将使用像 `$F_1$` 分数这样的标准性能指标来量化系统的准确性，并探索将报告级别从“种”调整到“属”如何能够显著提高结果的可靠性。",
            "id": "5208465",
            "problem": "一个临床微生物学实验室正在评估一个自动化微生物鉴定系统（例如，基质辅助激光解吸/电离飞行时间(MALDI-TOF)质谱法）对属于两个属的四个临床相关物种的鉴定性能。每个菌株都只属于一个真实物种，而系统对每个菌株也只输出一个预测物种。测试集包含每种物种的$100$个菌株。这些物种及其所属的属为：\n- A属：$A_1$种和$A_2$种。\n- B属：$B_1$种和$B_2$种。\n\n观察到的种级鉴定结果（行代表真实物种；值为被预测为每个物种的菌株数量）如下：\n- 真实$A_1$种：预测为$A_1$种 $40$个，$A_2$种 $50$个，$B_1$种 $7$个，$B_2$种 $3$个。\n- 真实$A_2$种：预测为$A_1$种 $45$个，$A_2$种 $42$个，$B_1$种 $8$个，$B_2$种 $5$个。\n- 真实$B_1$种：预测为$A_1$种 $6$个，$A_2$种 $4$个，$B_1$种 $52$个，$B_2$种 $38$个。\n- 真实$B_2$种：预测为$A_1$种 $3$个，$A_2$种 $7$个，$B_1$种 $41$个，$B_2$种 $49$个。\n\n在报告属级结果时，实验室通过汇总属于同一属的物种，将真实标签和预测结果都归纳到属一级（即，对$A_1$种或$A_2$种的预测被视为A属；对$B_1$种或$B_2$种的预测被视为B属）。\n\n仅使用多类别单标签分类中精确率、召回率和F$_1$分数的基本定义，计算报告级别从种级切换到属级时，宏平均F$_1$分数的绝对变化量。此处，宏平均F$_1$分数是指在特定报告级别下，所有类别的F$_1$分数的简单平均值。请用小数表示最终结果，并四舍五入到四位有效数字。答案中不要包含任何单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确、客观，并包含得出唯一解所需的所有信息。我们将按以下步骤求解：首先计算种级的宏平均F$_1$分数，然后计算属级的宏平均F$_1$分数，最后计算这两个分数之间的绝对差值。\n\n对于给定的类别$i$，性能指标定义如下：\n精确率：$P_i = \\frac{TP_i}{TP_i + FP_i}$\n召回率：$R_i = \\frac{TP_i}{TP_i + FN_i}$\nF$_1$分数：$F_{1,i} = 2 \\cdot \\frac{P_i \\cdot R_i}{P_i + R_i}$\n其中，$TP_i$是类别$i$的真阳性（true positives）数量，$FP_i$是假阳性（false positives）数量，$FN_i$是假阴性（false negatives）数量。宏平均F$_1$分数是所有类别F$_1$分数的算术平均值。\n\n种级的鉴定结果可以用一个$4 \\times 4$的混淆矩阵$C_S$来表示，其中行代表真实物种，列代表预测物种。类别为$A_1$、$A_2$、$B_1$和$B_2$。\n$$ C_S = \\begin{pmatrix} 40 & 50 & 7 & 3 \\\\ 45 & 42 & 8 & 5 \\\\ 6 & 4 & 52 & 38 \\\\ 3 & 7 & 41 & 49 \\end{pmatrix} $$\n每个真实物种的菌株数量为$100$。\n\n首先，我们计算种级的宏平均F$_1$分数（$F_{1,\\text{species}}$）。\n\n对于$A_1$种：\n$TP_{A_1} = 40$\n$FP_{A_1} = 45 + 6 + 3 = 54$\n$FN_{A_1} = 50 + 7 + 3 = 60$\n$P_{A_1} = \\frac{40}{40 + 54} = \\frac{40}{94}$\n$R_{A_1} = \\frac{40}{40 + 60} = \\frac{40}{100}$\n$F_{1, A_1} = 2 \\cdot \\frac{\\frac{40}{94} \\cdot \\frac{40}{100}}{\\frac{40}{94} + \\frac{40}{100}} = \\frac{2 \\cdot 40}{94 + 100} = \\frac{80}{194} = \\frac{40}{97}$\n\n对于$A_2$种：\n$TP_{A_2} = 42$\n$FP_{A_2} = 50 + 4 + 7 = 61$\n$FN_{A_2} = 45 + 8 + 5 = 58$\n$P_{A_2} = \\frac{42}{42 + 61} = \\frac{42}{103}$\n$R_{A_2} = \\frac{42}{42 + 58} = \\frac{42}{100}$\n$F_{1, A_2} = 2 \\cdot \\frac{\\frac{42}{103} \\cdot \\frac{42}{100}}{\\frac{42}{103} + \\frac{42}{100}} = \\frac{2 \\cdot 42}{103 + 100} = \\frac{84}{203} = \\frac{12}{29}$\n\n对于$B_1$种：\n$TP_{B_1} = 52$\n$FP_{B_1} = 7 + 8 + 41 = 56$\n$FN_{B_1} = 6 + 4 + 38 = 48$\n$P_{B_1} = \\frac{52}{52 + 56} = \\frac{52}{108}$\n$R_{B_1} = \\frac{52}{52 + 48} = \\frac{52}{100}$\n$F_{1, B_1} = 2 \\cdot \\frac{\\frac{52}{108} \\cdot \\frac{52}{100}}{\\frac{52}{108} + \\frac{52}{100}} = \\frac{2 \\cdot 52}{108 + 100} = \\frac{104}{208} = \\frac{1}{2}$\n\n对于$B_2$种：\n$TP_{B_2} = 49$\n$FP_{B_2} = 3 + 5 + 38 = 46$\n$FN_{B_2} = 3 + 7 + 41 = 51$\n$P_{B_2} = \\frac{49}{49 + 46} = \\frac{49}{95}$\n$R_{B_2} = \\frac{49}{49 + 51} = \\frac{49}{100}$\n$F_{1, B_2} = 2 \\cdot \\frac{\\frac{49}{95} \\cdot \\frac{49}{100}}{\\frac{49}{95} + \\frac{49}{100}} = \\frac{2 \\cdot 49}{95 + 100} = \\frac{98}{195}$\n\n种级的宏平均F$_1$分数是这四个分数的平均值：\n$F_{1,\\text{species}} = \\frac{1}{4} (F_{1, A_1} + F_{1, A_2} + F_{1, B_1} + F_{1, B_2})$\n$F_{1,\\text{species}} = \\frac{1}{4} \\left(\\frac{40}{97} + \\frac{12}{29} + \\frac{1}{2} + \\frac{98}{195}\\right)$\n使用小数近似值：\n$F_{1,\\text{species}} \\approx \\frac{1}{4} (0.412371 + 0.413793 + 0.5 + 0.502564) = \\frac{1}{4}(1.828728) = 0.457182$\n\n接下来，我们计算属级的宏平均F$_1$分数（$F_{1,\\text{genus}}$）。我们将$4 \\times 4$的矩阵$C_S$压缩成一个用于A属和B属的$2 \\times 2$矩阵$C_G$。\n\n属级混淆矩阵$C_G$的计数如下：\n$N(\\text{真实A属, 预测A属}) = 40 + 50 + 45 + 42 = 177$\n$N(\\text{真实A属, 预测B属}) = 7 + 3 + 8 + 5 = 23$\n$N(\\text{真实B属, 预测A属}) = 6 + 4 + 3 + 7 = 20$\n$N(\\text{真实B属, 预测B属}) = 52 + 38 + 41 + 49 = 180$\n\n得到的$2 \\times 2$混淆矩阵$C_G$为：\n$$ C_G = \\begin{pmatrix} 177 & 23 \\\\ 20 & 180 \\end{pmatrix} $$\n\n对于A属：\n$TP_A = 177$\n$FP_A = 20$\n$FN_A = 23$\n$P_A = \\frac{177}{177+20} = \\frac{177}{197}$\n$R_A = \\frac{177}{177+23} = \\frac{177}{200}$\n$F_{1, A} = 2 \\cdot \\frac{\\frac{177}{197} \\cdot \\frac{177}{200}}{\\frac{177}{197} + \\frac{177}{200}} = \\frac{2 \\cdot 177}{197+200} = \\frac{354}{397}$\n\n对于B属：\n$TP_B = 180$\n$FP_B = 23$\n$FN_B = 20$\n$P_B = \\frac{180}{180+23} = \\frac{180}{203}$\n$R_B = \\frac{180}{180+20} = \\frac{180}{200}$\n$F_{1, B} = 2 \\cdot \\frac{\\frac{180}{203} \\cdot \\frac{180}{200}}{\\frac{180}{203} + \\frac{180}{200}} = \\frac{2 \\cdot 180}{203+200} = \\frac{360}{403}$\n\n属级的宏平均F$_1$分数是这两个分数的平均值：\n$F_{1,\\text{genus}} = \\frac{1}{2} (F_{1, A} + F_{1, B}) = \\frac{1}{2}\\left(\\frac{354}{397} + \\frac{360}{403}\\right)$\n使用小数近似值：\n$F_{1,\\text{genus}} \\approx \\frac{1}{2}(0.891688 + 0.893300) = \\frac{1}{2}(1.784988) = 0.892494$\n\n最后，我们计算宏平均F$_1$分数的绝对变化量：\n$|\\Delta F_1| = |F_{1,\\text{genus}} - F_{1,\\text{species}}|$\n$|\\Delta F_1| \\approx |0.892494 - 0.457182| = 0.435312$\n\n将结果四舍五入到四位有效数字，得到$0.4353$。",
            "answer": "$$\\boxed{0.4353}$$"
        }
    ]
}