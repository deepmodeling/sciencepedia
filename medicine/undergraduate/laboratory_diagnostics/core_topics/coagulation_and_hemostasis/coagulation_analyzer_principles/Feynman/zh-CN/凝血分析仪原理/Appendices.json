{
    "hands_on_practices": [
        {
            "introduction": "光学法凝血分析仪的核心在于监测样本因血纤蛋白网络形成而引起的光学特性变化。本练习旨在通过一个结合了一级反应动力学和比尔-朗伯定律（在此应用于浊度测量）的简化模型，来模拟这一过程。通过完成此项计算，您将能够定量地理解分析仪如何将生化反应的动态过程转化为具有临床意义的凝固时间，从而掌握其最基本的工作原理。",
            "id": "5217010",
            "problem": "一台光学凝血分析仪通过记录由不断增长的纤维蛋白网络引起的光散射所导致的表观吸光度的增加，来监测波长为 $660$ 纳米下的血栓形成过程。假设仪器已经过基线校正，因此在添加试剂的瞬间，吸光度为 $0$。表观吸光度使用应用于经验性质量比浊度系数的比尔-朗伯定律进行建模：瞬时吸光度 $A(t)$ 与光程 $l$、表观比吸光系数 $\\epsilon_{\\text{app}}$（单位为 $\\mathrm{L\\,g^{-1}\\,cm^{-1}}$）以及已形成的纤维蛋白的瞬时浓度 $c_{\\text{fibrin}}(t)$（单位为 $\\mathrm{g\\,L^{-1}}$）成正比。一份柠檬酸盐血浆样本的纤维蛋白原浓度为 $c_{0} = 2.0$ $\\mathrm{g\\,L^{-1}}$。比色皿光程为 $l = 1.00$ $\\mathrm{cm}$。该分析仪在 $660$ 纳米波长下校准的经验系数为 $\\epsilon_{\\text{app}} = 0.25$ $\\mathrm{L\\,g^{-1}\\,cm^{-1}}$。在加入凝血酶后，在 $37$ 摄氏度下，相对于剩余的未聚合纤维蛋白原，纤维蛋白的形成遵循伪一级反应过程，其有效速率常数为 $k = 0.35$ $\\mathrm{s^{-1}}$。当吸光度达到预设阈值 $A_{\\mathrm{th}} = 0.300$（无量纲）时，分析仪触发。仅使用比尔-朗伯衰减和一级动力学的定义，首先计算当所有纤维蛋白原都转化为对浊度信号有贡献的纤维蛋白时，反应完成时的渐近吸光度，然后确定吸光度首次达到阈值的时间 $t^{\\ast}$。仅报告 $t^{\\ast}$ 的值，单位为秒。将最终报告的时间四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其科学上合理、内容自洽且提法明确。提取所有给定条件并检查其一致性。\n\n给定条件：\n- 监测波长：$660$ 纳米\n- 初始吸光度：$A(0) = 0$\n- 吸光度模型：$A(t) = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{\\text{fibrin}}(t)$\n- 初始纤维蛋白原浓度：$c_{0} = 2.0$ $\\mathrm{g\\,L^{-1}}$\n- 比色皿光程：$l = 1.00$ $\\mathrm{cm}$\n- 表观比吸光系数：$\\epsilon_{\\text{app}} = 0.25$ $\\mathrm{L\\,g^{-1}\\,cm^{-1}}$\n- 动力学模型：纤维蛋白形成的伪一级过程\n- 有效速率常数：$k = 0.35$ $\\mathrm{s^{-1}}$\n- 温度：$37$ 摄氏度\n- 吸光度阈值：$A_{\\text{th}} = 0.300$\n\n该问题基于化学动力学（一级反应）和分光光度法（比尔-朗伯定律，经验性地应用于浊度测量）的既定原理。这些参数对于凝血分析来说是物理上现实的。问题定义明确，且有唯一解。该问题被认为是有效的。\n\n求解过程首先建立一个数学模型，将已形成的纤维蛋白浓度与测得的吸光度联系起来，然后整合一个纤维蛋白形成的动力学模型。\n\n表观吸光度 $A(t)$ 由适用于浊度测量的比尔-朗伯定律给出：\n$$A(t) = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{\\text{fibrin}}(t)$$\n其中 $c_{\\text{fibrin}}(t)$ 是光散射纤维蛋白网络的瞬时浓度。\n\n纤维蛋白原形成纤维蛋白的过程被描述为一个伪一级动力学过程。设 $c_{\\text{fibrinogen}}(t)$ 为时间 $t$ 时未聚合的纤维蛋白原的浓度。其消耗速率为：\n$$\\frac{d c_{\\text{fibrinogen}}(t)}{dt} = -k \\cdot c_{\\text{fibrinogen}}(t)$$\n在初始条件 $c_{\\text{fibrinogen}}(0) = c_0$ 下，此一阶常微分方程的解为：\n$$c_{\\text{fibrinogen}}(t) = c_{0} \\exp(-kt)$$\n\n根据质量守恒定律，假设在聚合过程中质量浓度守恒，那么在时间 $t$ 形成的纤维蛋白浓度是初始纤维蛋白原浓度与剩余未聚合的纤维蛋白原浓度之差：\n$$c_{\\text{fibrin}}(t) = c_{0} - c_{\\text{fibrinogen}}(t) = c_{0} - c_{0} \\exp(-kt) = c_{0}(1 - \\exp(-kt))$$\n\n将 $c_{\\text{fibrin}}(t)$ 的这个表达式代入吸光度方程，得到随时间变化的吸光度：\n$$A(t) = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{0}(1 - \\exp(-kt))$$\n\n问题首先要求我们计算反应完成时的渐近吸光度，我们记为 $A_{\\text{max}}$。这是时间趋于无穷大（$t \\to \\infty$）时的吸光度。在此极限下，由于 $k > 0$，指数项 $\\exp(-kt)$ 趋于 $0$。\n$$A_{\\text{max}} = \\lim_{t \\to \\infty} A(t) = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{0}(1 - 0) = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{0}$$\n这个结果在物理上对应于所有初始纤维蛋白原完全转化为纤维蛋白网络。我们可以计算其值：\n$$A_{\\text{max}} = (0.25 \\mathrm{~L\\,g^{-1}\\,cm^{-1}}) \\cdot (1.00 \\mathrm{~cm}) \\cdot (2.0 \\mathrm{~g\\,L^{-1}}) = 0.50$$\n指定的阈值吸光度 $A_{\\mathrm{th}} = 0.300$ 小于 $A_{\\text{max}} = 0.50$，这证实了该阈值是可以达到的。\n\n接下来，我们确定吸光度首次达到阈值 $A_{\\text{th}}$ 的时间 $t^{\\ast}$。这可以通过在我们的模型中令 $A(t^{\\ast}) = A_{\\text{th}}$ 来找到：\n$$A_{\\text{th}} = \\epsilon_{\\text{app}} \\cdot l \\cdot c_{0}(1 - \\exp(-kt^{\\ast}))$$\n认识到项 $\\epsilon_{\\text{app}} \\cdot l \\cdot c_{0}$ 是最大吸光度 $A_{\\text{max}}$，我们可以更紧凑地写出方程：\n$$A_{\\text{th}} = A_{\\text{max}}(1 - \\exp(-kt^{\\ast}))$$\n现在我们求解这个方程以得到 $t^{\\ast}$：\n$$\\frac{A_{\\text{th}}}{A_{\\text{max}}} = 1 - \\exp(-kt^{\\ast})$$\n$$\\exp(-kt^{\\ast}) = 1 - \\frac{A_{\\text{th}}}{A_{\\text{max}}}$$\n对两边取自然对数，分离出指数部分：\n$$-kt^{\\ast} = \\ln\\left(1 - \\frac{A_{\\text{th}}}{A_{\\text{max}}}\\right)$$\n$$t^{\\ast} = -\\frac{1}{k} \\ln\\left(1 - \\frac{A_{\\text{th}}}{A_{\\text{max}}}\\right)$$\n\n现在，我们将数值代入此表达式以求得 $t^{\\ast}$ 的值：\n$$t^{\\ast} = -\\frac{1}{0.35} \\ln\\left(1 - \\frac{0.300}{0.50}\\right)$$\n$$t^{\\ast} = -\\frac{1}{0.35} \\ln(1 - 0.60)$$\n$$t^{\\ast} = -\\frac{1}{0.35} \\ln(0.40)$$\n\n使用值 $\\ln(0.40) \\approx -0.91629073$：\n$$t^{\\ast} \\approx -\\frac{1}{0.35} (-0.91629073) \\approx 2.6179735 \\mathrm{~s}$$\n\n问题要求最终报告的时间需四舍五入到四位有效数字。\n$$t^{\\ast} \\approx 2.618 \\mathrm{~s}$$",
            "answer": "$$\n\\boxed{2.618}\n$$"
        },
        {
            "introduction": "在理想模型之外，临床实践充满了各种挑战，其中分析前变异是影响凝血检测结果准确性的一个关键因素。本练习聚焦于一个典型的分析前问题：异常的血细胞比容（HCT）。您将从化学计量学的基本原理出发，推导高血细胞比容如何导致样本“过度枸橼酸盐化”，并最终影响复钙后游离钙离子的浓度，从而揭示其对凝血时间测定产生偏差的机制。这项练习不仅能加深您对凝血检测中化学平衡的理解，还训练您如何设计校正方案以应对实际工作中的复杂情况。",
            "id": "5216965",
            "problem": "一台执行活化部分凝血活酶时间 (APTT) 检测的凝血分析仪，通过对枸橼酸盐血浆进行再钙化来测量凝血时间。样本被采集到含有浓度为 $C_{\\text{cit}} = 0.109\\ \\text{mol}\\ \\text{L}^{-1}$ 的枸橼酸钠的试管中，并以 $9:1$ 的血液与抗凝剂体积比（即 $V_{b} : V_{a} = 9:1$）混合。红细胞比容 $H$ 定义为全血中压积细胞的体积分数，因此全血中的血浆分数为 $(1 - H)$。离心后，分析仪吸取 $V_{p} = 100\\ \\mu\\text{L}$ 的血浆，并加入体积为 $V_{\\text{add}} = 100\\ \\mu\\text{L}$、含有浓度为 $C_{\\text{Ca,add}} = 25\\ \\text{mmol}\\ \\text{L}^{-1}$ 的氯化钙 ($\\text{CaCl}_{2}$) 的再钙化试剂。\n\n假设：\n- 所有枸橼酸钠都存在于血浆相中，并且在采集后均匀分布。\n- 在再钙化之前，枸橼酸盐血浆中的游离钙 $[\\text{Ca}^{2+}]$ 浓度可忽略不计。\n- 在再钙化过程中，游离钙以 $1:1$ 的化学计量比被枸橼酸盐消耗，形成钙-枸橼酸盐复合物，并且本计算可以忽略其他缓冲液或离子强度效应。\n\n从质量守恒和红细胞比容的定义出发，并且不使用经验校正公式，完成以下任务：\n1. 推导血浆中枸橼酸盐浓度 $C_{\\text{cit,plasma}}(H)$ 作为红细胞比容 $H$ 和采集比例 $V_{b} : V_{a} = 9:1$ 的函数表达式。\n2. 使用混合体积 $V_{p}$ 和 $V_{\\text{add}}$ 的通用质量平衡方法，推导反应混合物中再钙化后的游离钙浓度 $[\\text{Ca}^{2+}]_{\\text{free}}(H)$ 的表达式。\n3. 对于给定的 $V_{p}$、$V_{\\text{add}}$ 和 $C_{\\text{Ca,add}}$，量化高红细胞比容 $H_{1} = 0.60$ 相对于标称红细胞比容 $H_{0} = 0.45$ 所引入的偏差，偏差体现在采集管中的血浆分数和再钙化后的游离钙浓度 $[\\text{Ca}^{2+}]_{\\text{free}}$ 这两个方面。\n4. 提出一个经过验证的校正方案，推导出一个校正后 $\\text{CaCl}_{2}$ 浓度 $C_{\\text{Ca,corr}}$ 的闭式表达式。对于给定的 $V_{p}$ 和 $V_{\\text{add}}$，该浓度可以使任意红细胞比容 $H$ 的反应混合物达到目标游离钙浓度 $T$。设目标浓度为您推导出的标称红细胞比容 $H_{0} = 0.45$ 时的游离钙浓度。\n\n最后，对于 $H_{1} = 0.60$ 且 $V_{p} = V_{\\text{add}} = 100\\ \\mu\\text{L}$ 的特定高红细胞比容情况，计算达到上述定义的目标游离钙浓度 $T$ 所需的校正后 $\\text{CaCl}_{2}$ 浓度 $C_{\\text{Ca,corr}}$ 的数值。将您最终的校正浓度以 $\\text{mmol}\\ \\text{L}^{-1}$ 为单位表示，并四舍五入至四位有效数字。",
            "solution": "问题陈述已经过严格评估，并被确定为有效。它在科学上基于凝血检测的原理，问题提法得当，信息充分且一致，表述客观。该问题要求对浓度和校正方案进行严格的第一性原理推导，这是与实验室诊断相关的化学计量学和质量平衡计算方面一个有意义的练习。因此，我们可以开始解答。\n\n解答按照问题陈述的要求分为四个部分，最后是最终的数值计算。\n\n**第1部分：血浆中枸橼酸盐浓度 $C_{\\text{cit,plasma}}(H)$ 的推导**\n\n给定全血体积 $V_b$ 与抗凝剂体积 $V_a$ 以 $V_b : V_a = 9:1$ 的比例混合。添加到采集管中的枸橼酸盐总量由抗凝剂溶液中枸橼酸盐的摩尔数给出：\n$$n_{\\text{cit}} = C_{\\text{cit}} V_a$$\n其中 $C_{\\text{cit}} = 0.109\\ \\text{mol}\\ \\text{L}^{-1}$ 是抗凝剂中枸橼酸钠的浓度。\n\n问题陈述指出，混合后所有枸橼酸盐都存在于血浆相中。首先，我们必须确定该相的总体积。全血的体积是 $V_b$。红细胞比容 $H$ 代表该体积中由压积细胞占据的分数。因此，血液样本中的血浆体积为：\n$$V_{\\text{plasma, from blood}} = V_b (1 - H)$$\n枸橼酸盐可溶解于其中的总体积是来自血液的血浆体积与抗凝剂本身的水溶液体积 $V_a$ 之和。\n$$V_{\\text{total plasma phase}} = V_{\\text{plasma, from blood}} + V_a = V_b (1 - H) + V_a$$\n血浆中枸橼酸盐的浓度 $C_{\\text{cit,plasma}}(H)$ 是枸橼酸盐的总摩尔数除以这个总血浆相体积：\n$$C_{\\text{cit,plasma}}(H) = \\frac{n_{\\text{cit}}}{V_{\\text{total plasma phase}}} = \\frac{C_{\\text{cit}} V_a}{V_b (1 - H) + V_a}$$\n我们可以使用给定的比例 $V_b : V_a = 9:1$，这意味着 $V_b = 9V_a$。将此代入表达式中，$V_a$ 项被消去：\n$$C_{\\text{cit,plasma}}(H) = \\frac{C_{\\text{cit}} V_a}{9V_a (1 - H) + V_a} = \\frac{C_{\\text{cit}}}{9(1 - H) + 1}$$\n化简分母，得到血浆枸橼酸盐浓度作为红细胞比容函数的最终表达式：\n$$C_{\\text{cit,plasma}}(H) = \\frac{C_{\\text{cit}}}{9 - 9H + 1} = \\frac{C_{\\text{cit}}}{10 - 9H}$$\n\n**第2部分：再钙化后游离钙浓度 $[\\text{Ca}^{2+}]_{\\text{free}}(H)$ 的推导**\n\n分析仪将体积为 $V_p = 100\\ \\mu\\text{L}$ 的枸橼酸盐血浆与体积为 $V_{\\text{add}} = 100\\ \\mu\\text{L}$ 的再钙化试剂混合。此反应混合物的总体积为 $V_{\\text{mix}} = V_p + V_{\\text{add}}$。\n\n从血浆样本引入反应混合物中的枸橼酸盐总摩尔数为：\n$$n_{\\text{cit,p}} = C_{\\text{cit,plasma}}(H) V_p$$\n从再钙化试剂引入的钙 ($\\text{Ca}^{2+}$) 总摩尔数为：\n$$n_{\\text{Ca,add}} = C_{\\text{Ca,add}} V_{\\text{add}}$$\n其中 $C_{\\text{Ca,add}} = 25\\ \\text{mmol}\\ \\text{L}^{-1}$。\n\n根据问题，钙离子和枸橼酸根离子以 $1:1$ 的化学计量比反应。假设加入的钙相对于枸橼酸盐是摩尔过量的，则络合反应后剩余的游离钙摩尔数为：\n$$n_{\\text{Ca,free}} = n_{\\text{Ca,add}} - n_{\\text{cit,p}}$$\n在总反应混合物体积 $V_{\\text{mix}}$ 中，该游离钙的浓度 $[\\text{Ca}^{2+}]_{\\text{free}}(H)$ 为：\n$$[\\text{Ca}^{2+}]_{\\text{free}}(H) = \\frac{n_{\\text{Ca,free}}}{V_{\\text{mix}}} = \\frac{n_{\\text{Ca,add}} - n_{\\text{cit,p}}}{V_p + V_{\\text{add}}}$$\n代入摩尔数的表达式：\n$$[\\text{Ca}^{2+}]_{\\text{free}}(H) = \\frac{C_{\\text{Ca,add}} V_{\\text{add}} - C_{\\text{cit,plasma}}(H) V_p}{V_p + V_{\\text{add}}}$$\n现在，我们代入第1部分推导出的 $C_{\\text{cit,plasma}}(H)$ 表达式：\n$$[\\text{Ca}^{2+}]_{\\text{free}}(H) = \\frac{C_{\\text{Ca,add}} V_{\\text{add}} - \\left(\\frac{C_{\\text{cit}}}{10 - 9H}\\right) V_p}{V_p + V_{\\text{add}}}$$\n鉴于 $V_p = V_{\\text{add}} = 100\\ \\mu\\text{L}$，我们可以简化这个表达式。设 $V = V_p = V_{\\text{add}}$：\n$$[\\text{Ca}^{2+}]_{\\text{free}}(H) = \\frac{C_{\\text{Ca,add}} V - \\left(\\frac{C_{\\text{cit}}}{10 - 9H}\\right) V}{V + V} = \\frac{V \\left( C_{\\text{Ca,add}} - \\frac{C_{\\text{cit}}}{10 - 9H} \\right)}{2V}$$\n这可以简化为最终表达式：\n$$[\\text{Ca}^{2+}]_{\\text{free}}(H) = \\frac{1}{2}\\left(C_{\\text{Ca,add}} - \\frac{C_{\\text{cit}}}{10 - 9H}\\right)$$\n\n**第3部分：偏差的量化**\n\n我们通过计算标称红细胞比容 $H_0 = 0.45$ 和高红细胞比容 $H_1 = 0.60$ 时的血浆分数和再钙化后游离钙浓度来量化偏差。计算时，我们使用 $C_{\\text{cit}} = 109\\ \\text{mmol}\\ \\text{L}^{-1}$ 和 $C_{\\text{Ca,add}} = 25\\ \\text{mmol}\\ \\text{L}^{-1}$。\n\n*   **采集管中血浆分数的偏差：** 试管中的血浆体积为 $V_{\\text{total plasma phase}} = V_b(1-H) + V_a$。总采集体积为 $V_b+V_a = 10V_a$。试管总液体体积中血浆的分数为 $\\frac{V_b(1-H)+V_a}{V_b+V_a} = \\frac{9V_a(1-H)+V_a}{10V_a} = \\frac{9(1-H)+1}{10} = \\frac{10-9H}{10} = 1 - 0.9H$。\n    在 $H_0 = 0.45$ 时：血浆分数为 $1 - 0.9(0.45) = 1 - 0.405 = 0.595$。\n    在 $H_1 = 0.60$ 时：血浆分数为 $1 - 0.9(0.60) = 1 - 0.54 = 0.460$。\n    高红细胞比容样本的血浆与抗凝剂比例显著降低，导致血浆成分中枸橼酸盐过量。\n\n*   **再钙化后游离钙浓度 $[\\text{Ca}^{2+}]_{\\text{free}}$ 的偏差：**\n    首先，我们计算两种情况下的血浆枸橼酸盐浓度：\n    $C_{\\text{cit,plasma}}(H_0 = 0.45) = \\frac{109}{10 - 9(0.45)} = \\frac{109}{10 - 4.05} = \\frac{109}{5.95} \\approx 18.319\\ \\text{mmol}\\ \\text{L}^{-1}$。\n    $C_{\\text{cit,plasma}}(H_1 = 0.60) = \\frac{109}{10 - 9(0.60)} = \\frac{109}{10 - 5.4} = \\frac{109}{4.6} \\approx 23.696\\ \\text{mmol}\\ \\text{L}^{-1}$。\n\n    现在，我们计算两种情况下的游离钙浓度：\n    $[\\text{Ca}^{2+}]_{\\text{free}}(H_0 = 0.45) = \\frac{1}{2}(25 - \\frac{109}{5.95}) \\approx \\frac{1}{2}(25 - 18.319) = 3.3405\\ \\text{mmol}\\ \\text{L}^{-1}$。\n    $[\\text{Ca}^{2+}]_{\\text{free}}(H_1 = 0.60) = \\frac{1}{2}(25 - \\frac{109}{4.6}) \\approx \\frac{1}{2}(25 - 23.696) = 0.652\\ \\text{mmol}\\ \\text{L}^{-1}$。\n    偏差是显著的：高红细胞比容样本中的游离钙浓度仅为标称值的约 $19.5\\%$，这将剧烈地且人为地延长测量的凝血时间。\n\n**第4部分：校正方案和最终计算**\n\n我们的目标是推导一个校正后的钙试剂浓度 $C_{\\text{Ca,corr}}$ 的表达式，该浓度能使任意红细胞比容 $H$ 的样本达到一个目标游离钙浓度 $T$。目标浓度定义为标称红细胞比容 $H_0$ 时的浓度：\n$$T = [\\text{Ca}^{2+}]_{\\text{free}}(H_0) = \\frac{1}{2}\\left(C_{\\text{Ca,add}} - \\frac{C_{\\text{cit}}}{10 - 9H_0}\\right)$$\n对于红细胞比容为 $H$ 的患者，使用校正后的试剂浓度 $C_{\\text{Ca,corr}}$ 所达到的游离钙浓度为：\n$$[\\text{Ca}^{2+}]_{\\text{free,corr}}(H) = \\frac{1}{2}\\left(C_{\\text{Ca,corr}} - \\frac{C_{\\text{cit}}}{10 - 9H}\\right)$$\n将此值设为等于目标值 $T$：\n$$\\frac{1}{2}\\left(C_{\\text{Ca,corr}} - \\frac{C_{\\text{cit}}}{10 - 9H}\\right) = \\frac{1}{2}\\left(C_{\\text{Ca,add}} - \\frac{C_{\\text{cit}}}{10 - 9H_0}\\right)$$\n两边乘以 $2$ 并求解 $C_{\\text{Ca,corr}}$：\n$$C_{\\text{Ca,corr}} - \\frac{C_{\\text{cit}}}{10 - 9H} = C_{\\text{Ca,add}} - \\frac{C_{\\text{cit}}}{10 - 9H_0}$$\n$$C_{\\text{Ca,corr}} = C_{\\text{Ca,add}} + \\frac{C_{\\text{cit}}}{10 - 9H} - \\frac{C_{\\text{cit}}}{10 - 9H_0}$$\n这可以进行因式分解，得出校正方案的闭式表达式：\n$$C_{\\text{Ca,corr}} = C_{\\text{Ca,add}} + C_{\\text{cit}}\\left(\\frac{1}{10 - 9H} - \\frac{1}{10 - 9H_0}\\right)$$\n这个经过验证的方案允许根据患者测量的红细胞比容 $H$ 来计算合适的 CaCl$_2$ 浓度。\n\n最后，我们计算高红细胞比容情况 $H_1 = 0.60$ 下 $C_{\\text{Ca,corr}}$ 的数值。\n我们有 $H = 0.60$，$H_0 = 0.45$，$C_{\\text{cit}} = 109\\ \\text{mmol}\\ \\text{L}^{-1}$，以及 $C_{\\text{Ca,add}} = 25\\ \\text{mmol}\\ \\text{L}^{-1}$。\n$$C_{\\text{Ca,corr}} = 25 + 109\\left(\\frac{1}{10 - 9(0.60)} - \\frac{1}{10 - 9(0.45)}\\right)$$\n$$C_{\\text{Ca,corr}} = 25 + 109\\left(\\frac{1}{10 - 5.4} - \\frac{1}{10 - 4.05}\\right)$$\n$$C_{\\text{Ca,corr}} = 25 + 109\\left(\\frac{1}{4.6} - \\frac{1}{5.95}\\right)$$\n$$C_{\\text{Ca,corr}} = 25 + 109\\left(\\frac{5.95 - 4.6}{4.6 \\times 5.95}\\right)$$\n$$C_{\\text{Ca,corr}} = 25 + 109\\left(\\frac{1.35}{27.37}\\right)$$\n$$C_{\\text{Ca,corr}} = 25 + 109(0.049324077...)$$\n$$C_{\\text{Ca,corr}} = 25 + 5.37632444...$$\n$$C_{\\text{Ca,corr}} = 30.37632444...\\ \\text{mmol}\\ \\text{L}^{-1}$$\n四舍五入到四位有效数字，所需的校正浓度为 $30.38\\ \\text{mmol}\\ \\text{L}^{-1}$。",
            "answer": "$$\\boxed{30.38}$$"
        },
        {
            "introduction": "确保凝血分析仪长期稳定可靠地运行，是实验室诊断工作的核心要求，这需要依赖于严谨的统计质量控制（SQC）。本练习将带您进入实验室质量保证的实践领域，运用韦氏规则（Westgard rules）对模拟的质量控制数据进行分析。通过编写程序来识别$1_{2s}$和$2_{2s}$等常见规则的违规情况，并估算其理论假性拒绝率，您将掌握评估分析系统稳定性的核心技能。这项练习有助于您理解如何区分测量系统的随机波动与需要干预的系统性偏移，这是每一位检验专业人员的必备能力。",
            "id": "5216975",
            "problem": "在多种场景下，您会获得一台凝血分析仪在一个日历月内的每日质量控制 (QC) 结果序列。每次 QC 结果都是在给定批次中对一个质控水平的单次测量。假设以下基本前提：每次运行的测量误差被建模为均值为 $0$ 且标准差 (SD) 已知的独立同分布高斯噪声，第 $i$ 次运行的观测测量值为 $x_i = \\mu + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$ 且 $\\mu$ 是稳定的目标均值。将每次运行的标准化分数（z-score）定义为 $z_i = \\dfrac{x_i - \\mu}{\\sigma}$。对 $z$ 分数使用以下 Westgard 规则：\n- 两倍标准差规则之一 ($1_{2s}$): 当 $\\lvert z_i \\rvert \\geq 2$ 时，第 $i$ 次运行发生违规。\n- 连续两次两倍标准差规则 ($2_{2s}$): 当第 $i$ 次运行 ($i \\geq 2$) 满足 $\\lvert z_i \\rvert \\geq 2$ 和 $\\lvert z_{i-1} \\rvert \\geq 2$ 且 $\\operatorname{sign}(z_i) = \\operatorname{sign}(z_{i-1})$ 时，发生违规。在配对中第二次运行的索引处对每个违规对进行计数，允许重叠。\n\n您的任务是：\n1. 对于下方的每个测试用例，计算在给定月份内 $1_{2s}$ 和 $2_{2s}$ 规则的违规总数。\n2. 在指定的稳定过程和运行间独立的假设下，估算每条规则的假失控率，以每次运行的概率表示（小数形式，非百分比）。对于阈值为 $k$ 的 $1_{2s}$ 规则，此概率为 $P(\\lvert Z \\rvert \\geq k)$，其中 $Z \\sim \\mathcal{N}(0,1)$。对于 $2_{2s}$ 规则，此概率是在独立性和平稳性条件下，一次运行因其自身和紧邻的前一次运行均在同一侧超过阈值而被标记的概率。\n\n实现一个程序，该程序既能根据数据计算违规次数，又能使用给定阈值的高斯模型估算假失控率。使用以下测试套件。对于每个用例，规则阈值为 $k_{1_{2s}} = 2$ 和 $k_{2_{2s}} = 2$。\n\n测试用例 1（正常情况，偏差多样）：\n- 均值 $\\mu = 12.0$，标准差 $\\sigma = 0.3$。\n- 月度数据（长度 $30$）：$[12.1, 11.9, 12.2, 12.65, 11.3, 12.0, 12.4, 11.5, 12.8, 11.2, 12.05, 11.95, 12.6, 11.4, 12.3, 11.7, 12.55, 12.62, 11.35, 12.15, 11.85, 12.45, 11.6, 12.0, 12.7, 11.25, 12.35, 11.8, 12.1, 11.9]$。\n\n测试用例 2（在恰好 $2$ 倍标准差和连续阈值处的边界行为）：\n- 均值 $\\mu = 10.0$，标准差 $\\sigma = 1.0$。\n- 月度数据（长度 $12$）：$[10.0, 12.0, 8.0, 10.5, 9.7, 12.0, 12.0, 9.5, 8.0, 8.0, 10.2, 10.0]$。\n\n测试用例 3（无违规的边缘情况，全部在 $1$ 倍标准差内）：\n- 均值 $\\mu = 30.0$，标准差 $\\sigma = 2.0$。\n- 月度数据（长度 $10$）：$[30.5, 29.0, 30.8, 30.1, 31.2, 28.7, 30.2, 29.8, 30.0, 30.7]$。\n\n测试用例 4（集中的超标产生多个 $2_{2s}$ 重叠）：\n- 均值 $\\mu = 50.0$，标准差 $\\sigma = 1.5$。\n- 月度数据（长度 $20$）：$[50.2, 53.4, 53.6, 53.1, 52.9, 53.3, 53.2, 49.8, 47.1, 46.8, 46.9, 50.5, 49.7, 50.0, 49.9, 53.5, 53.6, 53.7, 53.8, 53.9]$。\n\n最终输出规格：\n- 对于每个测试用例，生成四元组 $[C_{1_{2s}}, C_{2_{2s}}, R_{1_{2s}}, R_{2_{2s}}]$，其中 $C_{\\cdot}$ 是违规的整数计数，$R_{\\cdot}$ 是每次运行的估计假失控概率（小数）。\n- 将所有测试用例的结果通过连接聚合成一个单一列表，顺序与测试用例相同，生成一个包含 $16$ 个元素的扁平列表。\n- 将所有估计概率四舍五入到 $6$ 位小数。违规计数必须是未舍入的整数。\n\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，$[a_1,a_2,\\dots,a_{16}]$）。不应打印任何其他文本。",
            "solution": "我们从实验室诊断中稳定分析过程的内部质量控制的核心假设和定义开始。每次运行的 QC 测量值被建模为 $x_i = \\mu + \\epsilon_i$，其中误差 $\\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 独立。标准化为 $z$ 分数 $z_i = \\dfrac{x_i - \\mu}{\\sigma}$ 将问题转化，使得在稳定过程中，每个 $z_i \\sim \\mathcal{N}(0,1)$ 且相互独立。\n\n指定的 Westgard 规则是：\n- $1_{2s}$：当 $\\lvert z_i \\rvert \\geq 2$ 时发生违规。从数据中计数是直接的：计算每个 $z_i$，如果 $\\lvert z_i \\rvert \\geq 2$ 则增加计数。\n- $2_{2s}$：如果运行 $i-1$ 和运行 $i$ 的 $\\lvert z \\rvert \\geq 2$ 且在均值的同一侧，即 $(z_{i-1} \\geq 2 \\wedge z_i \\geq 2)$ 或 $(z_{i-1} \\leq -2 \\wedge z_i \\leq -2)$，则在运行 $i$ 处记录一次违规。允许重叠；对于一连串在同一侧违规的运行，从该串中的第二次运行开始，每次运行都会贡献一次 $2_{2s}$ 违规。从数据中计数时，通过从 $2$ 到 $n$ 迭代 $i$ 并检验所述条件来进行。\n\n为了估计假失控率（稳定过程触发规则的单次运行概率），我们使用标准正态分布从第一性原理推导：\n- 对于阈值为 $k$ 的 $1_{2s}$ 规则， $R_{1_{2s}}(k) = P(\\lvert Z \\rvert \\geq k)$，其中 $Z \\sim \\mathcal{N}(0,1)$。根据对称性，$R_{1_{2s}}(k) = 2\\left(1 - \\Phi(k)\\right)$，其中 $\\Phi$ 是标准正态分布的累积分布函数。对于 $k = 2$，$R_{1_{2s}}(2) = 2\\big(1 - \\Phi(2)\\big)$。\n- 对于阈值为 $k$ 的 $2_{2s}$ 规则，如果 $Z_{i-1}$ 和 $Z_i$ 两者独立地在同一侧超过阈值，则索引为 $i$ 的运行被标记。根据独立性和对称性，$R_{2_{2s}}(k) = P(Z_{i-1} \\geq k, Z_i \\geq k) + P(Z_{i-1} \\leq -k, Z_i \\leq -k) = \\left(1 - \\Phi(k)\\right)^2 + \\left(\\Phi(-k)\\right)^2 = 2\\left(1 - \\Phi(k)\\right)^2$，因为 $\\Phi(-k) = 1 - \\Phi(k)$。对于 $k = 2$，$R_{2_{2s}}(2) = 2\\big(1 - \\Phi(2)\\big)^2$。\n\n这些公式源于高斯分布的标准属性以及运行之间的独立性。请注意，假失控率仅取决于标准化阈值 $k$，而不取决于 $\\mu$ 或 $\\sigma$，因为标准化将问题简化为 $\\mathcal{N}(0,1)$。\n\n算法设计：\n1. 对于每个测试用例，为所有运行计算 $z_i = \\dfrac{x_i - \\mu}{\\sigma}$。\n2. 计数 $C_{1_{2s}} = \\#\\{i : \\lvert z_i \\rvert \\geq 2\\}$。\n3. 计数 $C_{2_{2s}} = \\#\\{i \\in \\{2,\\dots,n\\} : (z_{i-1} \\geq 2 \\wedge z_i \\geq 2) \\vee (z_{i-1} \\leq -2 \\wedge z_i \\leq -2)\\}$。\n4. 计算 $R_{1_{2s}} = 2\\left(1 - \\Phi(2)\\right)$ 和 $R_{2_{2s}} = 2\\left(1 - \\Phi(2)\\right)^2$，然后四舍五入到 $6$ 位小数。\n5. 对于每个测试用例，输出四元组 $[C_{1_{2s}}, C_{2_{2s}}, R_{1_{2s}}, R_{2_{2s}}]$，并在所有用例之间连接成一个扁平列表。\n\n通过使用经过充分检验的稳定过程高斯误差模型、运行间的独立性假设以及 Westgard 多规则的规范定义，保证了科学真实性。恰好为 $2$ SD 的边缘情况由不等式 $\\geq$ 处理，确保了一致的边界定义。根据要求，结果以整数表示计数，以小数表示概率。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef count_westgard_violations(z_scores, k_1_2s=2.0, k_2_2s=2.0):\n    \"\"\"\n    Count violations for Westgard rules 1_2s and 2_2s.\n    Definitions:\n      - 1_2s: |z_i| >= k_1_2s\n      - 2_2s: consecutive pair on same side, both with |z| >= k_2_2s\n              counted at the second run in the pair, overlaps allowed.\n    \"\"\"\n    z = np.asarray(z_scores, dtype=float)\n    # 1_2s count\n    c_1_2s = int(np.sum(np.abs(z) >= k_1_2s))\n\n    # 2_2s count\n    prev_high = z[:-1] >= k_2_2s\n    prev_low = z[:-1] = -k_2_2s\n    curr_high = z[1:] >= k_2_2s\n    curr_low = z[1:] = -k_2_2s\n    c_2_2s = int(np.sum((prev_high  curr_high) | (prev_low  curr_low)))\n\n    return c_1_2s, c_2_2s\n\ndef false_rejection_rates(k_1_2s=2.0, k_2_2s=2.0):\n    \"\"\"\n    Compute per-run false rejection probabilities under N(0,1) and independence.\n    R_1_2s = 2 * (1 - Phi(k_1_2s))\n    R_2_2s = 2 * (1 - Phi(k_2_2s))^2\n    \"\"\"\n    tail1 = 1.0 - norm.cdf(k_1_2s)\n    r1 = 2.0 * tail1\n    tail2 = 1.0 - norm.cdf(k_2_2s)\n    r2 = 2.0 * (tail2 ** 2)\n    return r1, r2\n\ndef z_scores(data, mu, sigma):\n    data = np.asarray(data, dtype=float)\n    return (data - mu) / sigma\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (mu, sigma, data_list, k_1_2s, k_2_2s)\n        (\n            12.0,\n            0.3,\n            [12.1, 11.9, 12.2, 12.65, 11.3, 12.0, 12.4, 11.5, 12.8, 11.2,\n             12.05, 11.95, 12.6, 11.4, 12.3, 11.7, 12.55, 12.62, 11.35, 12.15,\n             11.85, 12.45, 11.6, 12.0, 12.7, 11.25, 12.35, 11.8, 12.1, 11.9],\n            2.0,\n            2.0\n        ),\n        (\n            10.0,\n            1.0,\n            [10.0, 12.0, 8.0, 10.5, 9.7, 12.0, 12.0, 9.5, 8.0, 8.0, 10.2, 10.0],\n            2.0,\n            2.0\n        ),\n        (\n            30.0,\n            2.0,\n            [30.5, 29.0, 30.8, 30.1, 31.2, 28.7, 30.2, 29.8, 30.0, 30.7],\n            2.0,\n            2.0\n        ),\n        (\n            50.0,\n            1.5,\n            [50.2, 53.4, 53.6, 53.1, 52.9, 53.3, 53.2, 49.8, 47.1, 46.8,\n             46.9, 50.5, 49.7, 50.0, 49.9, 53.5, 53.6, 53.7, 53.8, 53.9],\n            2.0,\n            2.0\n        ),\n    ]\n\n    results = []\n    # Process each test case\n    for mu, sigma, data, k1, k2 in test_cases:\n        zs = z_scores(data, mu, sigma)\n        c1, c2 = count_westgard_violations(zs, k_1_2s=k1, k_2_2s=k2)\n        r1, r2 = false_rejection_rates(k_1_2s=k1, k_2_2s=k2)\n        # Round probabilities to 6 decimal places\n        r1_str = f\"{r1:.6f}\"\n        r2_str = f\"{r2:.6f}\"\n        results.append(str(c1))\n        results.append(str(c2))\n        results.append(r1_str)\n        results.append(r2_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}