{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了一个经典的流行病学场景，旨在比较两个具有不同环境暴露的社区之间的寄生虫病发病率。通过解决这个问题 ()，你将学习如何通过正确核算动态队列中的人时 (person-time)，来计算疾病频率最基本的衡量标准之一——发病率 (incidence rate)。计算发病率比 (Incidence Rate Ratio, IRR) 将使你能够量化暴露（水源）与感染风险之间的关联强度。",
            "id": "4788954",
            "problem": "一个现场团队对两个相邻的农村社区的 *Giardia lamblia* 感染动态进行了为期一年的调查。$T$ 社区使用经过处理的管道水；$U$ 社区依赖未经处理的地表水。在基线时，进行了一项横断面粪便检查以识别当前感染者。只有在基线时未感染的个体（即风险人群）被纳入前瞻性随访；每个被纳入的个体从基线开始贡献观察时间，直到首次新发感染、失访或年底，以先发生者为准。\n\n使用以下数据：\n\n- $T$ 社区：基线检查总人数 $= 740$；基线感染人数 $= 37$；因此风险人群 $= 703$。随访期间，新发感染 $= 51$，失访 $= 88$，其余 $564$ 人全年未感染。新发感染者的平均观察时间为 $0.40$ 年，失访者的平均观察时间为 $0.50$ 年，全年未感染者的平均观察时间为 $1.00$ 年。\n- $U$ 社区：基线检查总人数 $= 660$；基线感染人数 $= 141$；因此风险人群 $= 519$。随访期间，新发感染 $= 135$，失访 $= 70$，其余 $314$ 人全年未感染。新发感染者的平均观察时间为 $0.35$ 年，失访者的平均观察时间为 $0.60$ 年，全年未感染者的平均观察时间为 $1.00$ 年。\n\n从医学寄生虫学中适当的核心流行病学定义出发，将患病率视为特定时间点的感染比例（此处用于定义风险人群），并将发病率视为风险人群中每单位人时的新发感染数。计算在为期一年的时间内，$U$ 社区与 $T$ 社区相比的发病率比 (IRR)。将您的最终答案表示为无单位的小数，并四舍五入到四位有效数字。",
            "solution": "为了计算 $U$ 社区与 $T$ 社区相比的发病率比（Incidence Rate Ratio, IRR），我们首先需要分别计算两个社区的发病率（Incidence Rate, IR）。发病率的定义是新发病例数除以总风险人时。\n$$ IR = \\frac{\\text{新发病例数}}{\\text{总风险人时}} $$\n\n**第 1 步：计算 T 社区的发病率 ($IR_T$)**\n\n首先计算 $T$ 社区的总风险人时（Person-Time, $PT_T$）。这是队列中三个亚组（新发感染者、失访者、全程未感染者）贡献的观察时间总和。\n$$PT_T = (51 \\times 0.40) + (88 \\times 0.50) + (564 \\times 1.00)$$\n$$PT_T = 20.4 + 44.0 + 564.0 = 628.4 \\text{ 人-年}$$\n$T$ 社区的新发病例数为 $I_T = 51$。因此，其发病率为：\n$$IR_T = \\frac{I_T}{PT_T} = \\frac{51}{628.4} \\text{ 例/人-年}$$\n\n**第 2 步：计算 U 社区的发病率 ($IR_U$)**\n\n同样地，计算 $U$ 社区的总风险人时 $PT_U$。\n$$PT_U = (135 \\times 0.35) + (70 \\times 0.60) + (314 \\times 1.00)$$\n$$PT_U = 47.25 + 42.0 + 314.0 = 403.25 \\text{ 人-年}$$\n$U$ 社区的新发病例数为 $I_U = 135$。因此，其发病率为：\n$$IR_U = \\frac{I_U}{PT_U} = \\frac{135}{403.25} \\text{ 例/人-年}$$\n\n**第 3 步：计算发病率比 (IRR)**\n\n发病率比是两个社区发病率的比值：\n$$IRR = \\frac{IR_U}{IR_T} = \\frac{135 / 403.25}{51 / 628.4} = \\frac{135 \\times 628.4}{51 \\times 403.25} = \\frac{84834}{20565.75} \\approx 4.12502$$\n根据题目要求，将答案四舍五入到四位有效数字，得到 $4.125$。这个结果表明，使用未经处理的地表水的 $U$ 社区，其贾第鞭毛虫感染的发病率是使用处理水的 $T$ 社区的 $4.125$ 倍。",
            "answer": "$$\n\\boxed{4.125}\n$$"
        },
        {
            "introduction": "在基础计算之上，下一个练习将深入探讨传染病流行病学中一个更复杂、更现实的挑战：处理复发感染。在许多寄生虫病中，个体可能会被多次感染。本练习 () 要求你应用严格的病例定义，包括区分新发病例与复发的规则，并考虑感染后的非风险期，从而精确计算发病率。",
            "id": "4788968",
            "problem": "一个高年级本科生现场团队正在一个以学校为基础的队列中，量化有症状的 *Giardia lamblia* 感染的发生情况。为确保在计算复发事件时的流行病学严谨性，该团队依据标准的流行病学原理，规定了以下的事件定义和风险归因惯例。一次有症状的发作期被定义为出现临床腹泻并伴有贾第鞭毛虫抗原检测阳性。在同一名儿童中观察到的发作期，如果其开始时间距离前一次发作的起始时间不足 $9$ 天，则被视为同一次发作的一部分，不计为新事件。在每次经确认的有症状发作期结束后，该儿童在 $7$ 天内被认为没有发生后续新发作的风险，这反映了发作期后的短期抑制和治疗效果；这些非风险期将从风险人时中排除。在基线时（第 $0$ 天），进行了一次横断面评估以量化感染状况；这一基线状况不限制后续有症状发作期的计数，因为团队的目标是有症状发作的发生率，而不仅仅是初次感染。在为期 $90$ 天的预定随访中，共有 $240$ 名儿童被纳入研究。出勤记录显示，由于缺勤或永久退出，有 $420$ 个人-日未能被观察到。随访期间，最初记录到 $96$ 次有症状的发作。其中，$22$ 次发作的起始时间在同一儿童前一次发作的 $9$ 天之内，根据事件定义，这些发作被合并到前一次发作中，不计为新事件。整个队列中，不重叠的发作期后非风险窗口的总和经测量为 $518$ 个人-日。\n\n请仅使用基本的流行病学定义——患病率（prevalence）为特定时间点的感染比例，发生率（incidence rate）为每单位风险人时内新发作的频率——计算在上述事件定义下，新发有症状贾第鞭毛虫发作的发生率。请以“事件数/人-年”为单位表示您的最终比率，设一年为 $365$ 天，并将答案四舍五入至四位有效数字。请勿使用百分号；仅报告数值。",
            "solution": "本题要求我们根据一套严谨的流行病学定义，计算有症状贾第鞭毛虫发作的发生率（Incidence Rate）。发生率的计算公式为：\n$$ IR = \\frac{\\text{新发病例数}}{\\text{总风险人时}} $$\n\n**第 1 步：计算分子（新发病例数）**\n\n研究方案规定，如果一次发作的起始时间距离前一次发作不足 $9$ 天，则不计为新事件。\n- 最初记录的发作数：$96$ 次\n- 因时间过近而被合并的发作数：$22$ 次\n\n因此，独立的、新的有症状发作次数（分子）为：\n$$ I = 96 - 22 = 74 \\text{ 次} $$\n\n**第 2 步：计算分母（总风险人时）**\n\n总风险人时是所有儿童在研究期间处于“有风险”状态的总时间。我们需要从总潜在观察时间中，减去所有不处于风险或未被观察到的时间。时间单位为“人-日”。\n\n1.  **计算总潜在人时**：假设所有儿童都完成了全部随访。\n    $$ PT_{\\text{总潜在}} = 240 \\text{ 名儿童} \\times 90 \\text{ 天/儿童} = 21600 \\text{ 人-日} $$\n\n2.  **减去因失访损失的人时**：由于缺勤或退出，一部分时间未能观察到。\n    $$ PT_{\\text{损失}} = 420 \\text{ 人-日} $$\n    因此，总观察人时为：\n    $$ PT_{\\text{观察}} = 21600 - 420 = 21180 \\text{ 人-日} $$\n\n3.  **减去非风险期人时**：每次确诊发作后，有 $7$ 天的非风险期。\n    $$ PT_{\\text{非风险}} = 518 \\text{ 人-日} $$\n    （该数据与新发作次数一致：$74 \\text{ 次} \\times 7 \\text{ 天/次} = 518 \\text{ 人-日}$）\n\n最终，总风险人时（分母）为：\n$$ PT_{\\text{风险}} = PT_{\\text{观察}} - PT_{\\text{非风险}} = 21180 - 518 = 20662 \\text{ 人-日} $$\n\n**第 3 步：计算发生率并转换单位**\n\n现在我们可以计算发生率，单位为“事件/人-日”。\n$$ IR_{\\text{日}} = \\frac{74 \\text{ 事件}}{20662 \\text{ 人-日}} \\approx 0.00358145 \\text{ 事件/人-日} $$\n\n题目要求以“事件/人-年”为单位，并设一年为 $365$ 天。\n$$ IR_{\\text{年}} = IR_{\\text{日}} \\times 365 \\frac{\\text{天}}{\\text{年}} = \\frac{74}{20662} \\times 365 \\approx 1.30723 \\text{ 事件/人-年} $$\n\n根据要求，将结果四舍五入到四位有效数字，得到 $1.307$。",
            "answer": "$$\n\\boxed{1.307}\n$$"
        },
        {
            "introduction": "最后的练习将我们的重点从分析数据转移到规划未来的研究，这是任何流行病学家的关键技能。在开始一项研究之前，我们必须确保其设计能够产生有意义的结果。这个问题 () 将指导你完成确定所需样本量的过程，你需要同时满足两个不同的目标：以足够的精度估计疾病的患病率，并确保有足够的统计功效来检测干预措施对发病率的影响。",
            "id": "4788967",
            "problem": "一个寄生虫学团队正在计划一项关于蓝氏贾第鞭毛虫（*Giardia lamblia*）感染的社区研究，该研究结合了对感染患病率的基线横断面评估和一项前瞻性随机随访，以评估干预措施下的发病率。目标是选择一个总队列规模，记为$N$，该规模能同时满足基线患病率估计的精确度要求和发病率比较的统计功效要求。\n\n背景、假设和目标：\n- 基线横断面患病率：患病率$p$定义为随机选择的个体在某个时间点被感染的概率。初步数据表明$p \\approx 0.12$。团队要求对$p$的基线估计的95%置信区间（CI）半宽不超过$d = 0.03$。假设从一个足够大的源总体中进行简单随机抽样（不放回），使得有限总体校正可以忽略不计，并假设个体结果是独立的。将个体感染状态视为$\\mathrm{Bernoulli}(p)$分布，并使用中心极限定理（CLT）下样本比例的大样本行为。\n- 前瞻性发病率比较：基线调查后，规模为$N$的队列将被平均随机分配到两个组（对照组和干预组），因此每组有$N/2$名个体。每位参与者将被随访$T = 4$个月，并记录有症状的感染计数。假设感染事件在每组中遵循独立的泊松过程，对照组的率为$\\lambda_{0}$，干预组的率为$\\lambda_{1}$，并且每位参与者的人时恰好为$T$。根据先前的监测，对照组的率预计为$\\lambda_{0} = 0.05$次感染/人-月。预计干预措施将产生一个率比$\\mathrm{RR} = \\lambda_{1}/\\lambda_{0} = 0.6$。团队将以I型错误率（显著性水平）$\\alpha = 0.05$进行$H_{0}:\\mathrm{RR}=1$对$H_{1}:\\mathrm{RR}1$的单侧Wald检验，并要求统计功效为$1-\\beta = 0.80$。使用基于泊松计数特性的对数率比的大样本正态近似，并将两组的计数视为独立的。\n\n从核心概率模型定义（横断面感染状态的伯努利分布和发病率计数的泊松分布）出发，并使用由中心极限定理和delta方法证明合理的大样本正态近似，推导由以下条件对$N$施加的约束：\n1. 基线患病率的95%置信区间半宽不超过$d$。\n2. 单侧Wald检验达到统计功效$1-\\beta$以检测$\\mathrm{RR}=0.6$。\n\n计算同时满足这两个约束的最小整数$N$。仅报告这个$N$作为你的最终答案。不需要按有效数字进行四舍五入；提供满足两个目标的最小整数$N$。",
            "solution": "为了确定满足研究目标的最小总队列规模 $N$，我们需要分别计算由两个条件施加的样本量约束，然后取其中的较大值。\n\n**约束 1：患病率估计的精确度**\n\n此约束要求基线患病率 $p$ 的95%置信区间（CI）的半宽 $d$ 不超过 $0.03$。根据中心极限定理，样本比例 $\\hat{p}$ 的抽样分布近似为正态分布，其置信区间的半宽由以下公式给出：\n$$ d = z_{1-\\alpha_{CI}/2} \\sqrt{\\frac{p(1-p)}{N}} $$\n此处，$z_{1-\\alpha_{CI}/2}$ 是对应于95%置信水平的标准正态分布临界值，即 $z_{0.975} \\approx 1.96$。\n我们求解 $N$：\n$$ N \\geq \\left(\\frac{z_{1-\\alpha_{CI}/2}}{d}\\right)^2 p(1-p) $$\n代入给定值：$p = 0.12$，$d = 0.03$，以及 $z_{0.975} = 1.96$。\n$$ N \\geq \\left(\\frac{1.96}{0.03}\\right)^2 (0.12)(1 - 0.12) $$\n$$ N \\geq \\left(\\frac{1.96}{0.03}\\right)^2 (0.12)(0.88) $$\n$$ N \\geq (65.333...)^2 (0.1056) \\approx 4268.44 \\times 0.1056 \\approx 450.77 $$\n因此，满足患病率估计精确度要求的最小样本量为 $N_{prev} = \\lceil 450.77 \\rceil = 451$。由于研究的第二部分要求将队列平均分配到两组，总样本量 $N$ 必须是偶数。因此，满足此约束的最小偶数样本量是 $452$。\n\n**约束 2：发病率比较的统计功效**\n\n此约束要求在比较两个组的发病率时具有足够的统计功效（$80\\%$）来检测到 $0.6$ 的率比（RR）。总队列 $N$ 被分为两组，每组 $n = N/2$ 人，随访 $T=4$ 个月。\n功效分析的样本量公式基于对数率比的大样本正态近似，其形式如下：\n$$ N = \\frac{2(z_{1-\\alpha} + z_{1-\\beta})^2 \\left(1 + \\frac{1}{\\mathrm{RR}}\\right)}{T\\lambda_0 (\\ln(\\mathrm{RR}))^2} $$\n其中，显著性水平 $\\alpha = 0.05$（单侧），功效 $1-\\beta = 0.80$。对应的标准正态分位数为 $z_{1-\\alpha} = z_{0.95} \\approx 1.6449$ 和 $z_{1-\\beta} = z_{0.80} \\approx 0.8416$。\n其他参数为：$T=4$ 个月，对照组率 $\\lambda_0 = 0.05$ 例/人-月，率比 $\\mathrm{RR} = 0.6$。\n\n代入这些值：\n$$ z_{1-\\alpha} + z_{1-\\beta} \\approx 1.6449 + 0.8416 = 2.4865 $$\n$$ \\ln(\\mathrm{RR}) = \\ln(0.6) \\approx -0.5108256 $$\n$$ 1 + \\frac{1}{\\mathrm{RR}} = 1 + \\frac{1}{0.6} = 1 + \\frac{5}{3} = \\frac{8}{3} $$\n现在计算 $N$：\n$$ N \\geq \\frac{2(2.4865)^2 \\left(1 + \\frac{1}{0.6}\\right)}{4 \\times 0.05 \\times (\\ln(0.6))^2} $$\n$$ N \\geq \\frac{2 \\times 6.1827 \\times (\\frac{8}{3})}{0.2 \\times (-0.5108)^2} $$\n$$ N \\geq \\frac{32.974}{0.2 \\times 0.2609} \\approx \\frac{32.974}{0.05218} \\approx 631.88 $$\n满足统计功效要求的最小整数样本量是 $N_{inc} = \\lceil 631.88 \\rceil = 632$。这个数字是偶数，与研究设计兼容。\n\n**最终确定样本量**\n\n研究必须同时满足两个约束：\n1.  来自患病率精确度：$N \\geq 452$。\n2.  来自发病率统计功效：$N \\geq 632$。\n\n为满足这两个要求，我们必须选择两个最小样本量中较大的一个。\n$$ N = \\max(452, 632) = 632 $$\n因此，同时满足患病率估计的精确度要求和发病率比较的统计功效要求的最小总队列规模$N$是632。",
            "answer": "$$\\boxed{632}$$"
        }
    ]
}