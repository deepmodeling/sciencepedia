{
    "hands_on_practices": [
        {
            "introduction": "在公共卫生领域，基因组检测的一个核心应用是更精确地评估个体未来的患病风险。本练习将通过一个关于多基因风险评分（Polygenic Risk Score, PRS）的实例，引导你应用贝叶斯定理这一基本工具。你将学习如何根据阳性检测结果，更新个体的先验风险，并计算出其患病的后验概率，从而深入理解先验概率、似然比和后验概率在风险评估中的作用。",
            "id": "4564872",
            "problem": "一个公共卫生基因组学项目正在评估一个二元多基因风险评分（Polygenic Risk Score, PRS）阈值，以识别在$75$岁前患上某种常见复杂疾病的终生风险升高的个体。在目标人群中，$75$岁前患上该疾病的基线终生风险为$0.05$。在选定的阈值下，对代表目标人群的队列进行验证性研究显示，真阳性率为$0.40$，假阳性率为$0.10$。从目标人群中随机抽取的一名个体在此PRS阈值下检测结果为阳性。\n\n仅使用条件概率、优势比和似然比的定义，并假设验证指标在没有谱系偏倚的情况下适用于目标人群，确定该个体在检测结果为阳性的情况下，$75$岁前患上该疾病的后验概率。将您的最终答案以小数形式表示，并四舍五入到四位有效数字。请勿使用百分号。",
            "solution": "该问题要求计算在多基因风险评分（PRS）检测结果为阳性的情况下，个体患病的后验概率。这是贝叶斯推断的一个应用，解题过程将遵循使用优势比和似然比的定义的约束。\n\n设$D$表示从目标人群中随机抽取的个体在$75$岁前患病的事件。其补集$D^c$表示该个体不患病的事件。设$T^+$表示个体收到阳性检测结果的事件。\n\n问题提供了以下信息：\n1.  患病的先验概率（基线终生风险）：$P(D) = 0.05$。\n2.  真阳性率（灵敏度）：在个体将患病的情况下检测结果为阳性的概率，$P(T^+|D) = 0.40$。\n3.  假阳性率：在个体不会患病的情况下检测结果为阳性的概率，$P(T^+|D^c) = 0.10$。\n\n我们的目标是计算后验概率$P(D|T^+)$。\n\n首先，我们确定患病的先验优势比。一个事件的优势比定义为该事件发生的概率与不发生的概率之比。不患病的先验概率为 $P(D^c) = 1 - P(D) = 1 - 0.05 = 0.95$。\n因此，先验优势比为：\n$$Odds(D) = \\frac{P(D)}{P(D^c)} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}$$\n\n接下来，我们计算阳性检测结果的似然比，记为$LR(+)$。似然比是患有该病的人群中出现某种检测结果的概率与未患该病的人群中出现相同结果的概率之比。\n$$LR(+) = \\frac{P(T^+|D)}{P(T^+|D^c)}$$\n使用给定的真阳性率和假阳性率值：\n$$LR(+) = \\frac{0.40}{0.10} = 4$$\n对于将患病的个体，其检测结果为阳性的可能性是不会患病的个体的$4$倍。\n\n先验优势比、后验优势比和似然比之间的关系是贝叶斯定理的一种表述形式：\n$$后验优势比 = 先验优势比 \\times 似然比$$\n用我们定义的事件来表示，即：\n$$Odds(D|T^+) = Odds(D) \\times LR(+)$$\n这里，$Odds(D|T^+)$表示在收到阳性检测结果后患病的优势比。代入计算出的先验优势比和似然比的值：\n$$Odds(D|T^+) = \\frac{1}{19} \\times 4 = \\frac{4}{19}$$\n\n最后，必须将后验优势比转换回概率。一个事件$A$的概率可以从其优势比$Odds(A)$通过公式$P(A) = \\frac{Odds(A)}{1 + Odds(A)}$计算得出。\n将此应用于后验优势比：\n$$P(D|T^+) = \\frac{Odds(D|T^+)}{1 + Odds(D|T^+)} = \\frac{\\frac{4}{19}}{1 + \\frac{4}{19}}$$\n为了简化这个繁分数：\n$$P(D|T^+) = \\frac{\\frac{4}{19}}{\\frac{19}{19} + \\frac{4}{19}} = \\frac{\\frac{4}{19}}{\\frac{23}{19}} = \\frac{4}{23}$$\n\n问题要求最终答案以小数形式表示，并四舍五入到四位有效数字。我们进行除法运算：\n$$P(D|T^+) = \\frac{4}{23} \\approx 0.17391304...$$\n四舍五入到四位有效数字得到最终值。",
            "answer": "$$\\boxed{0.1739}$$"
        },
        {
            "introduction": "在评估一项公共卫生筛查项目的有效性时，阳性预测值（Positive Predictive Value, PPV）是一个至关重要的指标。它直接反映了筛查结果的可靠性，即一个阳性结果有多大可能是真正的阳性。本练习将个人风险评估的范畴扩展到群体层面，要求你结合群体遗传学基本原理（哈迪-温伯格平衡）与筛查测试的性能参数，来计算新生儿筛查项目的PPV，从而揭示疾病的患病率如何深刻影响筛查测试的实际表现。",
            "id": "4564890",
            "problem": "一个公共卫生项目评估一项新生儿筛查检测，该检测用于筛查一种由双等位基因座（等位基因为 $A$ 和 $a$）上的致病等位基因 $a$ 引起的常染色体隐性遗传代谢病。该种群数量庞大，进行随机交配，且没有选择、突变或迁移。在这些条件下，假设种群处于哈迪-温伯格平衡状态。种群中等位基因 $A$ 的频率为 $p$，因此等位基因 $a$ 的频率为 $q=1-p$。根据随机交配条件下孟德尔遗传的基本原理，推导出基因型 $AA$、$Aa$ 和 $aa$ 的频率（用 $p$ 和 $q$ 表示）。\n\n筛查检测对于基因型为 $aa$ 的真正患病新生儿，得出阳性结果的概率为 $s$；对于基因型为 $Aa$ 的携带者（由于偶尔出现的临界酶活性），得出阳性结果的概率为 $r$；对于基因型为 $AA$ 的非携带者（假阳性），得出阳性结果的概率为 $f$。该项目将此检测应用于所有新生儿。使用推导出的基因型频率，构建阳性预测值的表达式。阳性预测值定义为随机选择的一个阳性筛查结果确实是患病者的概率，即阳性预测值 (PPV) 等于 $\\mathbb{P}(aa \\mid \\text{positive})$。\n\n计算当 $p=0.972$、$s=0.95$、$r=0.02$ 和 $f=0.001$ 时此 PPV 的值。将最终数值答案以小数形式表示，并四舍五入到四位有效数字。",
            "solution": "基本依据是哈迪-温伯格平衡，它源于随机交配、大种群以及不存在选择、突变和迁移等进化力的核心假设。在孟德尔遗传中，对于一个基因座上的两个等位基因 $A$ 和 $a$，配子中某个等位基因的频率等于其在种群中的等位基因频率。一个合子具有特定基因型的概率，是从两个亲本配子库中抽取相应等位基因的概率之积。\n\n设等位基因 $A$ 的频率为 $p$，等位基因 $a$ 的频率为 $q$，其中 $q=1-p$。那么：\n- 新生儿基因型为 $AA$ 的概率是从两个配子中都抽到 $A$ 的概率，即 $p \\times p = p^{2}$。\n- 新生儿基因型为 $Aa$（或 $aA$）的概率是按任意顺序抽到一个 $A$ 和一个 $a$ 的概率，即 $p \\times q + q \\times p = 2pq$。\n- 新生儿基因型为 $aa$ 的概率是从两个配子中都抽到 $a$ 的概率，即 $q \\times q = q^{2}$。\n\n因此，在哈迪-温伯格平衡下，基因型频率分别为 $AA$ 是 $p^{2}$，$Aa$ 是 $2pq$，$aa$ 是 $q^{2}$。\n\n我们需要计算阳性预测值 (PPV)，定义为条件概率 $\\mathbb{P}(aa \\mid \\text{positive})$。根据贝叶斯法则和关于基因型的全概率定律，\n$$\n\\mathbb{P}(aa \\mid \\text{positive}) \\;=\\; \\frac{\\mathbb{P}(\\text{positive} \\mid aa)\\,\\mathbb{P}(aa)}{\\mathbb{P}(\\text{positive})}\n\\;=\\; \\frac{s \\cdot q^{2}}{s \\cdot q^{2} + r \\cdot (2pq) + f \\cdot p^{2}}.\n$$\n该表达式使用了给定基因型 $aa$ 时检测呈阳性的概率为 $s$，给定 $Aa$ 时为 $r$，给定 $AA$ 时为 $f$ 的事实，并按基因型频率进行加权。\n\n现在我们用给定的参数值 $p=0.972$、$s=0.95$、$r=0.02$ 和 $f=0.001$ 来评估这个表达式。首先计算 $q$：\n$$\nq \\;=\\; 1 - p \\;=\\; 1 - 0.972 \\;=\\; 0.028.\n$$\n接下来计算哈迪-温伯格基因型频率：\n$$\np^{2} \\;=\\; (0.972)^{2} \\;=\\; 0.944784, \\quad\n2pq \\;=\\; 2 \\cdot 0.972 \\cdot 0.028 \\;=\\; 0.054432, \\quad\nq^{2} \\;=\\; (0.028)^{2} \\;=\\; 0.000784.\n$$\n计算对总阳性概率的各部分贡献：\n- 患病者 ($aa$): $s \\cdot q^{2} \\;=\\; 0.95 \\cdot 0.000784 \\;=\\; 0.0007448$。\n- 携带者 ($Aa$): $r \\cdot 2pq \\;=\\; 0.02 \\cdot 0.054432 \\;=\\; 0.00108864$。\n- 非携带者 ($AA$): $f \\cdot p^{2} \\;=\\; 0.001 \\cdot 0.944784 \\;=\\; 0.000944784$。\n\n求和得到 $\\mathbb{P}(\\text{positive})$：\n$$\n\\mathbb{P}(\\text{positive}) \\;=\\; 0.0007448 + 0.00108864 + 0.000944784 \\;=\\; 0.002778224.\n$$\n因此，PPV 为\n$$\n\\text{PPV} \\;=\\; \\frac{0.0007448}{0.002778224} \\;\\approx\\; 0.2680849.\n$$\n四舍五入到四位有效数字并以小数表示，PPV 为 $0.2681$。",
            "answer": "$$\\boxed{0.2681}$$"
        },
        {
            "introduction": "级联筛查（Cascade screening）是一种高效且有针对性的公共卫生策略，它通过对先证者（第一个被发现的患者）的亲属进行检测来识别更多的高风险个体。本练习旨在挑战你构建一个数学模型，用以预测此类筛查项目的预期诊断产出。你需要综合运用孟德尔遗传定律、群体参数（如新生突变率 $d$）以及项目实施因素（如检测接受度），来估算每个先证者平均可以带来的新增携带者检出数量。",
            "id": "4564863",
            "problem": "一个公共卫生基因组学项目对常染色体显性遗传病实施级联筛查，以在先证者（proband）的亲属中识别出更多的携带者。假设先证者携带一个常染色体显性基因中的杂合致病性变异。设先证者的变异是新发（de novo）（即非遗传自任何一方父母）的概率为 $d$，其中 $0 \\leq d \\leq 1$。级联筛查仅提供给一级亲属，并使用一种变异特异性基因检测，其分析灵敏度为 $s$，其中 $0 \\leq s \\leq 1$。\n\n定义家庭结构和检测接受情况如下：\n- $N_{\\mathrm{par}}$: 符合检测资格的在世父母人数。\n- $N_{\\mathrm{sib}}$: 符合检测资格的在世同胞兄弟姐妹人数。\n- $N_{\\mathrm{child}}$: 符合检测资格的在世亲生子女人数。\n- $u_{\\mathrm{par}}$: 任何一位指定父母被联系、同意并完成检测的净概率。\n- $u_{\\mathrm{sib}}$: 任何一位指定同胞兄弟姐妹被联系、同意并完成检测的净概率。\n- $u_{\\mathrm{child}}$: 任何一位指定子女被联系、同意并完成检测的净概率。\n\n假设：\n- 常染色体显性杂合变异遵循孟德尔遗传规律，杂合携带者的每个子女有 $\\frac{1}{2}$ 的概率遗传该变异。\n- 如果先证者的变异是新发的（概率为 $d$），则其父母均不携带该变异，并且其同胞兄弟姐妹的风险可忽略不计（视为 $0$）。如果先证者的变异是遗传的（概率为 $1-d$），则其父母中恰好有一方携带该变异，且每个同胞兄弟姐妹有 $\\frac{1}{2}$ 的概率携带该变异。\n- 亲属间的检测接受度和检测性能相互独立，且检测接受度和检测灵敏度与携带者状态无关。\n\n仅使用这些假设和概率法则，推导出一个单一的闭式解析表达式，用于表示当对父母、同胞兄弟姐妹和子女提供级联筛查时，每个先证者平均新发现的携带者期望数量 $Y$。请用 $N_{\\mathrm{par}}$、$N_{\\mathrm{sib}}$、$N_{\\mathrm{child}}$、$u_{\\mathrm{par}}$、$u_{\\mathrm{sib}}$、$u_{\\mathrm{child}}$、$s$ 和 $d$ 来表示 $Y$。不需要进行数值计算或四舍五入。最终答案必须是单一的无单位解析表达式。",
            "solution": "问题要求推导一个闭式表达式，用于表示级联筛查项目所产生的新发现携带者的期望数量，记为 $Y$。发现携带者的总期望数量是来自各一级亲属群体（父母、同胞兄弟姐妹和子女）的期望数量之和。根据期望的线性性质，我们可以写出：\n$$Y = E[\\text{total carriers}] = E[\\text{carriers from parents}] + E[\\text{carriers from siblings}] + E[\\text{carriers from children}]$$\n我们将分别计算每个亲属群体的期望数量。设 $Y_{\\mathrm{par}}$、$Y_{\\mathrm{sib}}$ 和 $Y_{\\mathrm{child}}$ 分别代表在父母、同胞兄弟姐妹和子女群体中发现的携带者数量的随机变量。我们的目标是求得 $Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$。\n\n让我们首先确定在先证者的子女中发现的携带者期望数量 $E[Y_{\\mathrm{child}}]$。先证者是已知的杂合携带者。根据常染色体显性遗传病的孟德尔遗传规律，先证者的每个亲生子女有 $\\frac{1}{2}$ 的概率遗传该致病性变异。识别出一个携带者子女需要三个独立事件的发生：该子女必须是携带者，该子女必须接受检测，且检测必须得出阳性结果。\n某个特定子女是携带者的概率为 $P(\\text{carrier}) = \\frac{1}{2}$。\n某个特定子女接受检测的概率由检测接受概率 $u_{\\mathrm{child}}$ 给出。\n检测对携带者呈阳性的概率是分析灵敏度 $s$。\n因此，将任何一个子女识别为携带者的概率是这些概率的乘积：\n$$P(\\text{child identified}) = P(\\text{carrier}) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{child}} \\cdot s$$\n共有 $N_{\\mathrm{child}}$ 个子女。由于识别每个子女是独立事件，子女中发现的携带者总期望数量是各单个期望之和。对每个子女 $i$，设 $I_i$ 为该子女被识别出的指示变量。$E[I_i] = P(\\text{child identified})$。\n$$E[Y_{\\mathrm{child}}] = \\sum_{i=1}^{N_{\\mathrm{child}}} E[I_i] = \\sum_{i=1}^{N_{\\mathrm{child}}} \\left(\\frac{1}{2} u_{\\mathrm{child}} s\\right) = N_{\\mathrm{child}} \\frac{1}{2} u_{\\mathrm{child}} s$$\n这个期望值与是否为新发变异无关，因为计算的起点是先证者的携带者状态。\n\n接下来，我们计算在父母中发现的携带者期望数量 $E[Y_{\\mathrm{par}}]$ 和在同胞兄弟姐妹中发现的期望数量 $E[Y_{\\mathrm{sib}}]$。这些亲属的携带者状态取决于先证者的变异是遗传的还是新发的。我们使用全期望定律，以变异的来源为条件。设 $I$ 为变异是遗传的事件，$D$ 为变异是新发的事件。我们已知 $P(D) = d$ 和 $P(I) = 1-d$。\n\n对于父母，发现的携带者期望数量为：\n$$E[Y_{\\mathrm{par}}] = E[Y_{\\mathrm{par}} | I] P(I) + E[Y_{\\mathrm{par}} | D] P(D)$$\n如果变异是新发的（事件 $D$），则父母双方都不携带该变异。因此，在他们当中发现的携带者数量为零：$E[Y_{\\mathrm{par}} | D] = 0$。\n如果变异是遗传的（事件 $I$），则父母中恰好有一方是携带者。这位携带者亲代被成功识别的概率是其接受检测的概率（$u_{\\mathrm{par}}$）与检测灵敏度（$s$）的乘积。因此，在遗传条件下，从父母中发现的携带者期望数量为 $E[Y_{\\mathrm{par}} | I] = 1 \\cdot u_{\\mathrm{par}} \\cdot s$。\n代入父母的全期望定律公式中：\n$$E[Y_{\\mathrm{par}}] = (u_{\\mathrm{par}} s)(1-d) + (0)(d) = u_{\\mathrm{par}} s (1-d)$$\n\n对于同胞兄弟姐妹，我们遵循相同的逻辑：\n$$E[Y_{\\mathrm{sib}}] = E[Y_{\\mathrm{sib}} | I] P(I) + E[Y_{\\mathrm{sib}} | D] P(D)$$\n如果变异是新发的（事件 $D$），同胞兄弟姐妹不携带该变异，因此 $E[Y_{\\mathrm{sib}} | D] = 0$。\n如果变异是遗传的（事件 $I$），先证者从一个携带者亲代那里遗传了它。先证者的每个同胞兄弟姐妹都有相同的父母，因此有 $\\frac{1}{2}$ 的机会从那位携带者亲代那里遗传该变异。在先证者的变异是遗传的条件下，将某个特定同胞兄弟姐妹识别为携带者的概率为：\n$$P(\\text{sibling identified} | I) = P(\\text{sibling is carrier} | I) \\times P(\\text{tested}) \\times P(\\text{detected | carrier}) = \\frac{1}{2} \\cdot u_{\\mathrm{sib}} \\cdot s$$\n在遗传的条件下，在 $N_{\\mathrm{sib}}$ 个同胞兄弟姐妹中发现的携带者总期望数量为：\n$$E[Y_{\\mathrm{sib}} | I] = \\sum_{k=1}^{N_{\\mathrm{sib}}} P(\\text{sibling } k \\text{ identified} | I) = N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s$$\n代入同胞兄弟姐妹的全期望定律公式中：\n$$E[Y_{\\mathrm{sib}}] = \\left(N_{\\mathrm{sib}} \\frac{1}{2} u_{\\mathrm{sib}} s\\right)(1-d) + (0)(d) = \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d)$$\n\n最后，我们将所有三个亲属群体的期望值相加，求出新发现的携带者总期望数量 $Y$：\n$$Y = E[Y_{\\mathrm{par}}] + E[Y_{\\mathrm{sib}}] + E[Y_{\\mathrm{child}}]$$\n$$Y = u_{\\mathrm{par}} s (1-d) + \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} s (1-d) + \\frac{1}{2} N_{\\mathrm{child}} u_{\\mathrm{child}} s$$\n为将其表示为单一的闭式表达式，我们可以提取公因式：\n$$Y = s \\left[ u_{\\mathrm{par}}(1-d) + \\frac{1}{2} N_{\\mathrm{sib}} u_{\\mathrm{sib}} (1-d) + \\frac{1}{2} N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\n$$Y = \\frac{s}{2} \\left[ (2u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]$$\n这个表达式代表了每个先证者在级联筛查项目中的预期诊断收益。",
            "answer": "$$\\boxed{\\frac{s}{2} \\left[ (2u_{\\mathrm{par}} + N_{\\mathrm{sib}} u_{\\mathrm{sib}})(1-d) + N_{\\mathrm{child}} u_{\\mathrm{child}} \\right]}$$"
        }
    ]
}