{
    "hands_on_practices": [
        {
            "introduction": "构建任何传染病模型的一个基本选择是如何表示传播过程。本练习探讨了两个核心假设——密度依赖性（density-dependent）和频率依赖性（frequency-dependent）传播——并要求您推导出每种情况下的疫情阈值。理解这种区别至关重要，因为它决定了模型的预测如何随人口规模而变化，这是公共卫生领域的一个关键考量因素。",
            "id": "4544623",
            "problem": "一个人口规模固定为 $N$ 的封闭人群引入了一种新型急性传染原，其传播遵循易感-感染-移除（SIR）仓室动力学模型。在该模型中，个体通过有效接触从易感状态转为感染状态，并通过康复从感染状态转为移除状态。假设在短暂的疫情时间尺度内，不存在人口变化（即无出生或非疾病死亡），人群为均匀混合，且平均传染期为 $1/\\gamma$（其中 $\\gamma > 0$）。设传播参数为 $\\beta > 0$，并考虑预防医学和数学流行病学中使用的两种合理的发病率假设：\n\n- 密度依赖（质量作用）发病率：感染力与易感者和感染者数量的乘积 $S I$ 成正比。\n- 频率依赖（标准）发病率：感染力与 $S I / N$ 成正比。\n\n假设在传染原引入后，初始时刻满足 $I(0) \\ll N$ 且 $S(0) \\approx N$。请仅使用每种发病率假设下的 SIR 控制方程，推导感染初始增长的疫情阈值。该阈值定义为参数空间中区分 $I(t)$ 初始衰减与初始增长的边界。将最终的疫情阈值表示为以 $\\beta$、$\\gamma$ 和 $N$ 表示的无量纲闭式表达式，一个用于密度依赖发病率，一个用于频率依赖发病率。无需进行数值评估。此外，在你的推理中，简要比较两种假设下阈值对 $N$ 的定性依赖关系。最终提交的答案必须只包含两个阈值表达式，并以单行矩阵的形式并排呈现。最终方框内的答案不应包含单位。",
            "solution": "该问题要求在两种不同的发病率假设（密度依赖和频率依赖）下，推导易感-感染-移除（SIR）模型的疫情阈值。该阈值条件决定了当传染原被引入易感人群后，疫情是会增长还是会消亡。\n\n首先，我们建立关于感染者数量 $I(t)$ 的控制微分方程。状态变量为 $S(t)$、$I(t)$ 和 $R(t)$，分别代表易感、感染和移除仓室中的个体数量。总人口规模 $N$ 是恒定的，满足 $N = S(t) + I(t) + R(t)$。感染者被移除（例如，通过康复并获得免疫）的速率为 $\\gamma I(t)$，其中 $\\gamma > 0$ 是移除率，$1/\\gamma$ 是平均传染期。\n\n新发疫情的初始条件特征是感染者数量非常少，$I(0) > 0$，而人群几乎完全是易感的，因此 $S(0) \\approx N$。疫情暴发的条件是感染者数量必须在初始阶段增加，即 $\\frac{dI}{dt}|_{t=0} > 0$。\n\n情况1：密度依赖（质量作用）发病率\n在此假设下，新感染的速率与易感者和感染者的密度乘积成正比。在一个使用人口数量而非密度的模型中，这被形式化为与个体数量 $S$ 和 $I$ 的乘积成正比。新感染的速率为 $\\beta S I$，其中 $\\beta > 0$ 是传播参数。感染仓室的微分方程为：\n$$ \\frac{dI}{dt} = \\text{感染率} - \\text{移除率} = \\beta S(t) I(t) - \\gamma I(t) $$\n我们可以提出因子 $I(t)$：\n$$ \\frac{dI}{dt} = I(t) (\\beta S(t) - \\gamma) $$\n为评估初始增长，我们计算该导数在 $t=0$ 时的值：\n$$ \\frac{dI}{dt}|_{t=0} = I(0) (\\beta S(0) - \\gamma) $$\n为使疫情增长，我们需要 $\\frac{dI}{dt}|_{t=0} > 0$。根据定义（已有感染引入），$I(0) > 0$，因此增长的条件是：\n$$ \\beta S(0) - \\gamma > 0 $$\n使用人群几乎完全易感的近似条件 $S(0) \\approx N$，该条件变为：\n$$ \\beta N - \\gamma > 0 $$\n整理此不等式，得到阈值条件：\n$$ \\frac{\\beta N}{\\gamma} > 1 $$\n因此，疫情阈值为无量纲表达式 $\\frac{\\beta N}{\\gamma}$。这个量通常被称为基本再生数，$R_0$。对于密度依赖模型，我们有：\n$$ R_{0, \\text{density}} = \\frac{\\beta N}{\\gamma} $$\n\n情况2：频率依赖（标准）发病率\n在此假设下，新感染的速率与易感个体数量和感染者在总人口中所占的*比例* $I/N$ 的乘积成正比。新感染的速率为 $\\beta S \\frac{I}{N}$。感染仓室的微分方程为：\n$$ \\frac{dI}{dt} = \\beta \\frac{S(t) I(t)}{N} - \\gamma I(t) $$\n提出因子 $I(t)$：\n$$ \\frac{dI}{dt} = I(t) \\left( \\beta \\frac{S(t)}{N} - \\gamma \\right) $$\n在 $t=0$ 时，根据条件 $\\frac{dI}{dt}|_{t=0} > 0$ 和 $I(0) > 0$ 进行评估，我们得到：\n$$ \\beta \\frac{S(0)}{N} - \\gamma > 0 $$\n再次代入近似条件 $S(0) \\approx N$：\n$$ \\beta \\frac{N}{N} - \\gamma > 0 \\implies \\beta - \\gamma > 0 $$\n整理后得到阈值条件：\n$$ \\frac{\\beta}{\\gamma} > 1 $$\n因此，频率依赖模型的疫情阈值为：\n$$ R_{0, \\text{freq}} = \\frac{\\beta}{\\gamma} $$\n\n$N$ 的依赖性比较：\n推导出的疫情阈值在对总人口规模 $N$ 的依赖性上显示出关键差异。\n密度依赖阈值 $R_{0, \\text{density}} = \\frac{\\beta N}{\\gamma}$ 与 $N$ 成正比。这意味着，在其他条件相同的情况下，更大规模的人群本质上更容易发生疫情暴发。该模型假设个体的接触数量随人口密度而变化。\n频率依赖阈值 $R_{0, \\text{freq}} = \\frac{\\beta}{\\gamma}$ 与 $N$ 无关。该模型假设无论总人口规模如何，个体的接触数量相对固定。疾病的传播取决于任意一次接触的对象是感染者（$I/N$）的概率，而不是感染者的绝对数量。对于通过密切接触在人群中传播的疾病，这通常被认为是一个更现实的模型，因为在这些人群中，社会结构限制了接触率。\n\n所要求的两个表达式分别是密度依赖发病率的 $\\frac{\\beta N}{\\gamma}$ 和频率依赖发病率的 $\\frac{\\beta}{\\gamma}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\beta N}{\\gamma}  \\frac{\\beta}{\\gamma} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在疫情爆发初期，最关键的任务之一是根据可观察数据（如疫情增长率）估算基本再生数 $R_0$。本练习将引导您使用更新方程（renewal equation）框架，将指数增长率 $r$ 与 $R_0$ 联系起来。您还将研究关于代际间隔（generation interval）——即相继感染之间的时间——的不同假设如何显著影响这一关键估算值。",
            "id": "4544603",
            "problem": "一种呼吸道病原体在一个充分混合的大型人群中出现。早期爆发数据显示，发病率以速率 $r$（每日）近似指数增长。预防医学团队也对恢复率 $\\gamma$（每日）有独立的临床估计，在无记忆（指数）传染期的假设下，该值等于平均代际间隔的倒数。\n\n使用关联基本再生数 $R_{0}$、早期指数增长率 $r$ 和代际间隔分布 $g(\\tau)$ 的更新方程框架，按以下步骤进行：\n\n- 在指数传染期（因此代际间隔为均值为 $1/\\gamma$ 的指数分布）的假设下，通过在 $r=0$ 附近进行线性化，得到 $R_{0}$ 关于 $r$ 和 $\\gamma$ 的一阶近似。然后，使用 $r=0.2$ (每日) 和 $\\gamma=0.25$ (每日) 对此近似值进行数值计算。\n\n- 现在假设详细的接触者追踪表明，代际间隔分布更适合用形状参数 $k=2$ 且均值为 $1/\\gamma$ 的伽马分布来描述。使用相同的更新框架，计算当 $r=0.2$ (每日)，$\\gamma=0.25$ (每日)，且 $k=2$ 时的精确 $R_{0}$。\n\n- 定义有符号相对近似误差为 $\\left(R_{0}^{\\text{approx}}-R_{0}^{\\text{exact}}\\right)/R_{0}^{\\text{exact}}$。使用您上述的结果计算此值。\n\n将您的最终答案表示为一个无单位的单一数字，以精确分数形式给出（不要四舍五入）。不要使用百分号。最终答案必须是如上定义的有符号相对误差。",
            "solution": "用户希望我解决一个数学流行病学中的多部分问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n-   早期爆发的发病率以速率 $r$（每日）呈指数增长。\n-   恢复率为 $\\gamma$（每日）。\n-   更新方程关联了基本再生数 $R_{0}$、增长率 $r$ 和代际间隔分布 $g(\\tau)$。\n-   第1部分假设：代际间隔分布是均值为 $1/\\gamma$ 的指数分布。任务是通过在 $r=0$ 附近进行线性化，找到 $R_{0}$ 的一阶近似。\n-   第1部分数值：$r=0.2$ (每日)，$\\gamma=0.25$ (每日)。\n-   第2部分假设：代际间隔分布是形状参数为 $k=2$、均值为 $1/\\gamma$ 的伽马分布。任务是计算精确的 $R_{0}$。\n-   第2部分数值：$r=0.2$ (每日)，$\\gamma=0.25$ (每日)，$k=2$。\n-   第3部分定义：有符号相对近似误差为 $\\frac{R_{0}^{\\text{approx}}-R_{0}^{\\text{exact}}}{R_{0}^{\\text{exact}}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n-   **科学依据充分：** 该问题牢固地植根于传染病动力学的标准数学理论。更新方程（特别是 Euler-Lotka 方程）是关联基本再生数（$R_{0}$）、流行病增长率（$r$）和代际间隔分布的基本工具。使用指数分布和伽马分布来模拟传染期是常见且成熟的做法。\n-   **问题适定：** 该问题是自洽的，提供了所有必要的参数（$r$, $\\gamma$, $k$）、定义（指数分布和伽马分布，相对误差）和一个清晰的分析框架（更新方程），以推导出一个唯一且有意义的解。\n-   **客观性：** 该问题以精确的量化术语陈述。所有变量都明确定义，任务清晰明确。\n\n**步骤3：结论与行动**\n\n该问题有效。这是一个在数学流行病学中应用更新方程框架的、适定且科学合理的好练习。我将继续进行完整的解答。\n\n### 解答\n\n基本再生数 $R_{0}$、指数增长率 $r$ 和代际间隔分布 $g(\\tau)$ 之间的基本关系由更新方程给出，也称为 Euler-Lotka 方程：\n$$1 = R_{0} \\int_{0}^{\\infty} \\exp(-r\\tau) g(\\tau) d\\tau$$\n该积分表示在 $-r$ 处求值的代际间隔分布的矩生成函数，或者等效地，在 $s=r$ 处求值的 $g(\\tau)$ 的拉普拉斯变换，记为 $\\tilde{g}(s)$。因此，该方程可以写成：\n$$1 = R_{0} \\tilde{g}(r)$$\n这使我们能够将 $R_{0}$ 表示为 $r$ 的函数：\n$$R_{0}(r) = \\frac{1}{\\tilde{g}(r)}$$\n\n**第1部分：指数代际间隔的一阶近似**\n\n首先，我们建立 $R_{0}(r)$ 在 $r=0$ 附近的一般一阶近似。这由 $R_{0}(r)$ 的泰勒展开式在一次项后截断给出：\n$$R_{0}(r) \\approx R_{0}(0) + R_{0}'(0)r$$\n我们计算各项。在 $r=0$ 时：\n$$R_{0}(0) = \\frac{1}{\\tilde{g}(0)} = \\frac{1}{\\int_{0}^{\\infty} g(\\tau) d\\tau} = \\frac{1}{1} = 1$$\n这是因为 $g(\\tau)$ 是一个概率密度函数。\n$R_{0}(r)$ 的导数是 $R_{0}'(r) = -(\\tilde{g}(r))^{-2} \\tilde{g}'(r)$。拉普拉斯变换的导数是：\n$$\\tilde{g}'(r) = \\frac{d}{dr} \\int_{0}^{\\infty} \\exp(-r\\tau) g(\\tau) d\\tau = \\int_{0}^{\\infty} (-\\tau) \\exp(-r\\tau) g(\\tau) d\\tau$$\n在 $r=0$ 时，这变为：\n$$\\tilde{g}'(0) = \\int_{0}^{\\infty} (-\\tau) g(\\tau) d\\tau = -T_{g}$$\n其中 $T_{g}$ 是平均代际间隔。\n代回后，$R_{0}(r)$ 在 $r=0$ 的导数是：\n$$R_{0}'(0) = -(\\tilde{g}(0))^{-2} \\tilde{g}'(0) = -(1)^{-2} (-T_{g}) = T_{g}$$\n因此，一般的一阶近似是：\n$$R_{0}(r) \\approx 1 + rT_{g}$$\n对于第1部分给出的具体情况，假定代际间隔是均值为 $T_{g} = 1/\\gamma$ 的指数分布。将此代入一般近似中，得到该模型的近似值：\n$$R_{0}^{\\text{approx}} = 1 + r \\left(\\frac{1}{\\gamma}\\right) = 1 + \\frac{r}{\\gamma}$$\n现在我们用给定的值 $r=0.2$ 和 $\\gamma=0.25$ 来计算这个近似值：\n$$R_{0}^{\\text{approx}} = 1 + \\frac{0.2}{0.25} = 1 + \\frac{20}{25} = 1 + \\frac{4}{5} = \\frac{9}{5}$$\n\n**第2部分：伽马代际间隔的精确计算**\n\n在这一部分，代际间隔遵循一个形状参数为 $k=2$、均值为 $T_{g}=1/\\gamma$ 的伽马分布。伽马分布的均值是其形状参数 $k$ 和尺度参数 $\\theta$ 的乘积。因此，$T_{g} = k\\theta$，这意味着 $\\theta = T_{g}/k = (1/\\gamma)/2 = 1/(2\\gamma)$。\n这个伽马分布的概率密度函数是：\n$$g(\\tau) = \\frac{\\tau^{k-1} \\exp(-\\tau/\\theta)}{\\theta^k \\Gamma(k)} = \\frac{\\tau^{2-1} \\exp(-\\tau/(1/(2\\gamma)))}{(1/(2\\gamma))^2 \\Gamma(2)} = \\frac{\\tau \\exp(-2\\gamma \\tau)}{1/(4\\gamma^2) \\cdot 1} = 4\\gamma^2 \\tau \\exp(-2\\gamma \\tau)$$\n形状为 $k$、尺度为 $\\theta$ 的伽马分布的拉普拉斯变换是 $\\tilde{g}(s) = (1+\\theta s)^{-k}$。对于我们的参数：\n$$\\tilde{g}(s) = \\left(1 + \\frac{1}{2\\gamma} s\\right)^{-2} = \\left(\\frac{2\\gamma+s}{2\\gamma}\\right)^{-2} = \\left(\\frac{2\\gamma}{s+2\\gamma}\\right)^2$$\n使用更新方程 $R_{0} = 1/\\tilde{g}(r)$，我们找到 $R_{0}$ 的精确表达式：\n$$R_{0}^{\\text{exact}} = \\frac{1}{\\left(\\frac{2\\gamma}{r+2\\gamma}\\right)^2} = \\left(\\frac{r+2\\gamma}{2\\gamma}\\right)^2 = \\left(1 + \\frac{r}{2\\gamma}\\right)^2$$\n我们用 $r=0.2$, $\\gamma=0.25$ 和 $k=2$ 来计算这个值：\n$$R_{0}^{\\text{exact}} = \\left(1 + \\frac{0.2}{2 \\times 0.25}\\right)^2 = \\left(1 + \\frac{0.2}{0.5}\\right)^2 = \\left(1 + \\frac{2}{5}\\right)^2 = \\left(\\frac{7}{5}\\right)^2 = \\frac{49}{25}$$\n\n**第3部分：有符号相对近似误差**\n\n最后，我们计算问题陈述中定义的有符号相对近似误差：\n$$\\text{误差} = \\frac{R_{0}^{\\text{approx}} - R_{0}^{\\text{exact}}}{R_{0}^{\\text{exact}}}$$\n代入我们计算出的值：\n$$R_{0}^{\\text{approx}} = \\frac{9}{5} = \\frac{45}{25}$$\n$$R_{0}^{\\text{exact}} = \\frac{49}{25}$$\n误差为：\n$$\\text{误差} = \\frac{\\frac{45}{25} - \\frac{49}{25}}{\\frac{49}{25}} = \\frac{-\\frac{4}{25}}{\\frac{49}{25}} = -\\frac{4}{49}$$\n这是最终答案，以精确分数形式表示。",
            "answer": "$$\n\\boxed{-\\frac{4}{49}}\n$$"
        },
        {
            "introduction": "经典模型通常假设个体是随机混合的，但实际上，感染是通过一个结构化的接触网络传播的。这个问题引入了强大的网络流行病学框架，来计算在随机图上爆发的最终规模。通过求解一个源自逾渗理论（percolation theory）的不动点方程，您将看到接触网络的结构与传播率相结合，如何决定了疾病的最终波及范围。",
            "id": "4990194",
            "problem": "考虑一种在接触网络上传播的传染病，该网络被建模为一个 Erdős–Rényi (ER) 随机图。在该图中，任意两个个体之间以一定概率独立连接，该概率的选择使得节点的度分布是平均度为 $z$ 的泊松分布。假设每次沿着边的感染性接触都以概率 $T$（边传播率）独立导致传播，并且疫情以单波形式进行，其最终感染人群的比例等于渗流网络中巨连通分量中的节点比例。使用概率生成函数 (PGF) 框架和配置模型假设作为基本基础：度分布为平均度为 $z$ 的泊松分布，该度分布的 PGF 为 $G_0(x)$，超额度分布的 PGF 为 $G_1(x)$，且边占用概率为 $T$ 的键渗流过程将最终的疫情爆发规模映射为占用边图中的巨连通分量的大小。\n\n任务：\n1. 从泊松度分布的 PGF 定义以及“沿着一条随机占用的边不会到达巨连通分量”的概率所满足的自洽条件出发，推导出决定最终爆发规模 $S$（作为 $z$ 和 $T$ 的函数）的控制性不动点方程，过程中不得引用任何捷径公式。明确指出存在非零解 $S$ 的条件，并用 $z$ 和 $T$ 表示。\n2. 设计一个算法，在给定 $z$ 和 $T$ 的情况下，通过数值求解所推导出的不动点方程，计算出与巨连通分量相对应的非平凡根 $S$（如果存在）。当推导的条件表明巨连通分量不存在时，该算法必须返回 $S=0$。数值求解过程对于 $S \\in [0,1]$ 必须是稳健的，并且在存在非平凡解时，不得依赖可能收敛到平凡解的初始猜测。\n3. 将该算法实现为一个完整的、可运行的程序。最终输出必须是无量纲的分数。将每个输出表示为四舍五入到六位小数。你的程序必须评估以下参数值的测试套件：\n   - 测试用例 1：$z=3$, $T=0.4$。\n   - 测试用例 2：$z=0.5$, $T=1.0$。\n   - 测试用例 3：$z=10$, $T=0.1$。\n   - 测试用例 4：$z=6$, $T=0.3$。\n   - 测试用例 5：$z=2.5$, $T=0.41$。\n   - 测试用例 6：$z=4$, $T=0$。\n4. 最终输出格式：你的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，其顺序与测试套件的顺序相同（例如，$[s_1,s_2,s_3,s_4,s_5,s_6]$），其中每个 $s_i$ 是对应测试用例计算出的最终爆发规模，并四舍五入到六位小数。\n\n由于 $S$ 是人口比例，因此不涉及物理单位。所有数学实体必须用 LaTeX 书写。必须基于 PGF 框架和配置模型，使用严谨、科学合理的推理来处理该情景和参数值。",
            "solution": "该问题的解是使用概率生成函数 (PGF) 框架推导出来的，用于为网络上的类 SIR 疫情建模，其中疫情的最终规模对应于一个相关键渗流问题中巨连通分量的大小。\n\n### 第 1 步：控制性不动点方程的推导\n\n问题指出接触网络是一个 Erdős–Rényi (ER) 随机图。在节点数量巨大的极限下，ER 图的度分布是泊松分布。设 $p_k$ 为随机选择的节点度为 $k$ 的概率。对于平均度为 $z$ 的泊松分布，此概率由下式给出：\n$$p_k = \\frac{e^{-z} z^k}{k!}$$\n\n该度分布的概率生成函数 (PGF)，记为 $G_0(x)$，定义为：\n$$G_0(x) = \\sum_{k=0}^{\\infty} p_k x^k$$\n将泊松分布的 $p_k$ 代入：\n$$G_0(x) = \\sum_{k=0}^{\\infty} \\frac{e^{-z} z^k}{k!} x^k = e^{-z} \\sum_{k=0}^{\\infty} \\frac{(zx)^k}{k!} = e^{-z} e^{zx} = e^{z(x-1)}$$\n\n接下来，我们考虑超额度分布。这是通过遍历一条随机边到达的节点的度分布，其中不包括被遍历的那条边。到达一个度为 $k$ 的节点的概率与 $k p_k$ 成正比。超额度分布的 PGF，$G_1(x)$，由下式给出：\n$$G_1(x) = \\sum_{k=1}^{\\infty} \\frac{k p_k}{\\langle k \\rangle} x^{k-1}$$\n其中 $\\langle k \\rangle = z$ 是平均度。这可以与 $G_0(x)$ 相关联：\n$$G_1(x) = \\frac{1}{z} \\sum_{k=1}^{\\infty} k p_k x^{k-1} = \\frac{1}{z} \\frac{d}{dx} \\left( \\sum_{k=0}^{\\infty} p_k x^k \\right) = \\frac{1}{z} G_0'(x)$$\n对于我们的泊松分布，$G_0'(x) = \\frac{d}{dx} e^{z(x-1)} = z e^{z(x-1)}$。因此：\n$$G_1(x) = \\frac{1}{z} \\left( z e^{z(x-1)} \\right) = e^{z(x-1)}$$\n泊松分布的一个关键特性是 $G_0(x) = G_1(x)$。\n\n疾病的传播被映射到一个键渗流过程。一条边以概率 $T$ 被“占用”（可传播）。设 $u$ 为沿着一条随机占用的边行进 *不会* 到达巨连通分量的概率（即，它连接到一个有限的感染者簇）。为了建立 $u$ 的自洽条件，考虑通过这样一条边到达的一个节点。要使此节点不属于巨连通分量，其所有其他“出”路径也必须不能通向巨连通分量。\n\n从该节点出发的一条出边，如果它未被占用（概率为 $1-T$），或者被占用（概率为 $T$）但通向一个本身不在巨连通分量中的节点（概率为 $u$），则该出边不会通向巨连通分量。因此，单条出路径不通向巨连通分量的概率是 $(1-T) + Tu$。\n\n通过随机边到达的节点具有由 $G_1(x)$ 生成的超额度分布。如果这样一个节点的超额度为 $m=k-1$，其 $m$ 条出路径均不通向巨连通分量的概率是 $((1-T) + Tu)^m$。为了找到总概率 $u$，我们必须对所有可能的超额度进行平均，这正是 PGF $G_1(x)$ 在 $x = 1 - T + Tu$ 处求值时所完成的计算。这就给出了自洽方程：\n$$u = G_1(1-T+Tu)$$\n将推导出的泊松分布下的 $G_1(x)$ 形式代入：\n$$u = e^{z((1-T+Tu)-1)} = e^{z(Tu-T)} = e^{zT(u-1)}$$\n\n现在，我们将其与最终爆发规模 $S$ 联系起来。爆发规模是巨连通分量中的节点比例，即 $S = 1 - P(\\text{节点不在 GCC 中})$。设 $u_0$ 为随机选择的节点不在巨连通分量中的概率。一个度为 $k$ 的随机节点，如果它的所有 $k$ 条边都未能将其连接到巨连通分量，那么它就不在 GCC 中。如前所述，单条边连接失败的概率是 $1-T+Tu$。对于一个度为 $k$ 的节点，此概率为 $(1-T+Tu)^k$。使用其 PGF $G_0(x)$ 对度分布 $p_k$ 进行平均：\n$$u_0 = \\sum_{k=0}^{\\infty} p_k (1-T+Tu)^k = G_0(1-T+Tu)$$\n最终的爆发规模为 $S = 1 - u_0 = 1 - G_0(1-T+Tu)$。对于泊松分布的情况，由于 $G_0(x) = e^{z(x-1)}$：\n$$S = 1 - e^{z((1-T+Tu)-1)} = 1 - e^{zT(u-1)}$$\n将这个 $S$ 的表达式与 $u$ 的自洽方程 $u = e^{zT(u-1)}$ 进行比较，我们发现 $S = 1-u$。\n\n将 $u = 1-S$ 代入自洽方程，得到关于爆发规模 $S$ 的最终控制性不动点方程：\n$$1-S = e^{zT((1-S)-1)}$$\n$$1-S = e^{-zTS}$$\n该方程隐式地定义了最终爆发规模 $S$ 作为平均度 $z$ 和传播率 $T$ 的函数。\n\n### 非零爆发的条件\n如果疫情能够大范围传播，就会发生非零爆发（$S>0$）。我们分析方程 $S = 1 - e^{-zTS}$ 的非平凡解。设 $f(S) = 1 - e^{-zTS}$。我们寻找在区间 $[0,1]$ 内的不动点 $S = f(S)$。\n$S=0$ 始终是一个解，因为 $f(0) = 1 - e^0 = 0$。这对应于没有爆发的情况。\n如果对于 $S0$，曲线 $y=f(S)$ 上升到直线 $y=S$ 之上，则存在第二个正解。这由 $f(S)$ 在原点的斜率决定。\n$$f'(S) = \\frac{d}{dS}(1 - e^{-zTS}) = -(-zT)e^{-zTS} = zTe^{-zTS}$$\n存在非平凡解的条件是 $f'(0)  1$。\n$$f'(0) = zTe^{-0} = zT$$\n因此，当且仅当 $zT  1$ 时，才可能出现非零的爆发规模 $S$。乘积 $R_0 = zT$ 是该疫情的基本再生数。\n\n### 第 2 步：算法设计\n寻找 $S$ 的算法如下：\n1.  给定输入参数 $z$ 和 $T$，计算基本再生数 $R_0 = zT$。\n2.  如果 $R_0 \\le 1$，唯一有物理意义的解是 $S=0$。返回 $S=0.0$。\n3.  如果 $R_0  1$，则存在一个唯一的非平凡解 $S \\in (0, 1]$。该解是超越方程 $S - 1 + e^{-zTS} = 0$ 的根。\n4.  为了稳健地找到这个根，我们使用数值求根方法。我们定义函数 $F(S) = S - 1 + e^{-zTS}$。\n5.  我们需要在区间 $(0, 1]$ 中找到 $F(S)=0$ 的一个根。我们来分析在 $zT  1$ 的情况下，该函数在此区间内的性质：\n    -   在 $S=0$ 处，$F(0) = 0 - 1 + e^0 = 0$。\n    -   在 $S=1$ 处，$F(1) = 1 - 1 + e^{-zT} = e^{-zT}  0$。\n    -   在原点的导数是 $F'(0) = 1 - zT  0$。\n    由于 $F(0) = 0$ 且函数初始时递减，所以对于小的正数 $S$，$F(S)$ 将为负值。又因为 $F(1)$ 为正，所以在 0 和 1 之间必定存在一个根。像 Brent-Dekker 方法（`scipy.optimize.brentq`）这样的稳健方法是理想选择。该方法需要一个根所在的区间 $[a, b]$，其中 $F(a)$ 和 $F(b)$ 的符号相反。\n6.  我们可以选择一个区间，例如 $[10^{-9}, 1]$。对于任何 $zT  1$，$F(10^{-9}) \\approx 10^{-9}(1-zT)  0$ 并且 $F(1)  0$。这种区间设置保证了算法将找到唯一的正根，而不是 $S=0$ 处的平凡根。\n\n该算法是稳健的，并直接源于对所推导方程的数学分析。它将在最终的程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (z, T)\n        (3.0, 0.4),\n        (0.5, 1.0),\n        (10.0, 0.1),\n        (6.0, 0.3),\n        (2.5, 0.41),\n        (4.0, 0.0),\n    ]\n\n    results = []\n    for z, T in test_cases:\n        s = calculate_outbreak_size(z, T)\n        results.append(s)\n\n    # Final print statement in the exact required format.\n    # The list elements are formatted to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef calculate_outbreak_size(z: float, T: float) - float:\n    \"\"\"\n    Calculates the final outbreak size S for a disease on an ER random graph.\n\n    Args:\n        z (float): The mean degree of the Poisson degree distribution.\n        T (float): The edge transmissibility probability.\n\n    Returns:\n        float: The final fraction of the population infected, S.\n    \"\"\"\n    R0 = z * T\n\n    # If the basic reproduction number is not greater than 1,\n    # no large outbreak occurs, and the final size is 0.\n    if R0 = 1.0:\n        return 0.0\n\n    # For R0  1, a non-trivial solution S in (0, 1] exists.\n    # We need to solve the transcendental equation: S = 1 - exp(-R0 * S)\n    # This is equivalent to finding the root of the function F(S) = S - 1 + exp(-R0 * S).\n    def F(S, R0_val):\n        return S - 1.0 + np.exp(-R0_val * S)\n\n    # Use a robust numerical root-finding algorithm (Brent's method).\n    # The root is guaranteed to be in the interval (0, 1].\n    # We use a small positive lower bound (a) to avoid the trivial root at S=0.\n    # The upper bound (b) is 1. For R0  1, F(a) is negative and F(b) is positive,\n    # so the root is bracketed.\n    try:\n        # Lower bound is a small positive number to avoid the trivial root S=0.\n        lower_bound = 1e-9\n        # Upper bound is 1, as S is a fraction.\n        upper_bound = 1.0\n        \n        # scipy.optimize.brentq is a robust root-finder for a bracketed root.\n        # args passes the additional R0 parameter to the function F.\n        s_nontrivial = brentq(F, a=lower_bound, b=upper_bound, args=(R0,))\n    except ValueError:\n        # This block should not be reached given the mathematical properties\n        # of F(S) for R0  1, but is included for robustness. If brentq fails\n        # to find a root because the function values at the endpoints do not\n        # have opposite signs, it indicates an issue or a boundary case.\n        # The safe return value is 0.\n        s_nontrivial = 0.0\n        \n    return s_nontrivial\n\n# Execute the solution\nsolve()\n\n```"
        }
    ]
}