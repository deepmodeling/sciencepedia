{
    "hands_on_practices": [
        {
            "introduction": "在抽样理论中，当我们从有限的总体中抽取一个相当大比例的样本时，我们获得的关于总体的信息比从一个假设的无限总体中抽样要多。这种信息增益会降低我们估计的不确定性，这一概念通过“有限总体校正”（Finite Population Correction, FPC）来量化。本练习将指导您计算有限总体校正系数，并应用它来调整样本均值的方差，从而直观地理解它在实际公共卫生调查中的作用 ()。",
            "id": "4570367",
            "problem": "一个市卫生部门正在评估一个高血压社区筛查项目的收缩压部分。该部门维护着一个包含 $N=10000$ 名符合筛查条件的成年人的登记册。为了评估本季的筛查过程，该部门将从登记册中进行一次规模为 $n=1000$ 的不放回简单随机抽样（Simple Random Sampling Without Replacement (SRSWOR)），并计算样本的平均收缩压。根据上一季的完整登记册，已知的收缩压有限总体方差，定义为 $S^{2}=\\sigma^{2}=\\frac{1}{N-1}\\sum_{j=1}^{N}(y_{j}-\\mu)^{2}$，其值为 $\\sigma^{2}=225$ 平方毫米汞柱（$\\text{mmHg}^2$）。\n\n使用不放回简单随机抽样（SRSWOR）和有限总体抽样的原理，计算：\n- 样本均值方差的有限总体校正系数，以及\n- 在不放回简单随机抽样（SRSWOR）下，样本平均收缩压的方差。\n\n报告有限总体校正系数（无量纲）和方差（单位为平方毫米汞柱，$\\text{mmHg}^2$）。将两个值都四舍五入到四位有效数字。",
            "solution": "该问题要求计算与从有限总体进行不放回简单随机抽样（SRSWOR）相关的两个量：有限总体校正系数和样本均值的方差。\n\n给定的参数如下：\n- 总总体大小，$N = 10000$。\n- 样本大小，$n = 1000$。\n- 抽样方法为不放回简单随机抽样（SRSWOR）。\n- 收缩压的有限总体方差，定义为 $S^2 = \\sigma^2 = \\frac{1}{N-1}\\sum_{j=1}^{N}(y_{j}-\\mu)^{2}$，给定为 $\\sigma^2 = 225 \\text{ mmHg}^2$。\n\n首先，我们计算有限总体校正系数（fpc）。fpc 是一个因子，用于在从有限总体中进行不放回抽样时，调整估计量方差。它考虑了当抽样分数不可忽略时，抽样变异会减小这一事实。fpc 定义为：\n$$ \\text{fpc} = 1 - \\frac{n}{N} $$\n这也可以表示为 $\\frac{N-n}{N}$。我们将使用给定的 $N$ 和 $n$ 值：\n$$ \\text{fpc} = 1 - \\frac{1000}{10000} = 1 - 0.1 = 0.9 $$\n问题要求将此值报告为四位有效数字。因此，有限总体校正系数为 $0.9000$。这个量是无量纲的。\n\n其次，我们计算样本平均收缩压的方差，记为 $\\text{Var}(\\bar{y})$。对于有放回简单随机抽样，样本均值的方差为 $\\frac{\\sigma_{\\text{pop}}^2}{n}$。然而，由于抽样是*不放回*的，我们必须应用有限总体校正。在不放回简单随机抽样（SRSWOR）下，样本均值的方差公式为：\n$$ \\text{Var}(\\bar{y}) = \\frac{\\sigma^2}{n} \\left( \\frac{N-n}{N} \\right) $$\n必须注意，当所提供的总体方差 $\\sigma^2$ 是以 $N-1$ 为分母定义时（即 $\\sigma^2 = S^2$），此公式才适用，这一点在问题中已明确说明。项 $\\left( \\frac{N-n}{N} \\right)$ 正是我们之前计算的有限总体校正因子。\n\n现在我们可以将给定值代入此公式：\n- $\\sigma^2 = 225 \\text{ mmHg}^2$\n- $n = 1000$\n- fpc 项为 $\\frac{N-n}{N} = \\frac{10000 - 1000}{10000} = \\frac{9000}{10000} = 0.9$。\n\n因此，样本均值的方差为：\n$$ \\text{Var}(\\bar{y}) = \\frac{225}{1000} \\times 0.9 $$\n$$ \\text{Var}(\\bar{y}) = 0.225 \\times 0.9 $$\n$$ \\text{Var}(\\bar{y}) = 0.2025 \\text{ mmHg}^2 $$\n问题要求将此值四舍五入到四位有效数字。计算出的值 $0.2025$ 已经包含四位有效数字（数字 $2$、$0$、$2$ 和 $5$）。\n\n因此，所要求的两个值为：\n1. 有限总体校正系数：$0.9000$\n2. 样本均值的方差：$0.2025 \\text{ mmHg}^2$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.9000 & 0.2025 \\end{pmatrix}}$$"
        },
        {
            "introduction": "简单随机抽样是基础，但在实践中，我们常常可以通过更智能的设计来提高估计的效率。分层抽样就是一种强大的技术，它将总体划分为若干个内部同质的亚群（或称“层”），然后从每一层中独立抽样。本练习将带您探索奈曼最优分配（Neyman allocation）的原理，这是一种在总样本量固定的情况下，将样本在不同层之间进行分配以使总体均值估计量方差最小化的方法 ()。",
            "id": "4570316",
            "problem": "一个预防医学团队正在设计一个分层简单无放回随机抽样 (SRSWOR)，以估计按社区健康区域定义的三个层中的总体平均身体质量指数 (BMI, 单位为 $\\mathrm{kg/m^2}$)。各层的大小为 $N_{1}=1000$，$N_{2}=2000$ 和 $N_{3}=3000$。以往的监测提供了近似的层内标准差 $S_{1}=12$，$S_{2}=6$ 和 $S_{3}=9$ (单位均为 $\\mathrm{kg/m^2}$)。该团队总共可以抽取 $n=600$ 个个体，并且每个参与者的数据收集成本在各层之间是相等的。\n\n从分层均值估计量 $\\bar{Y}_{st}$ (定义为层样本均值的加权平均) 以及在SRSWOR下的精确方差表达式出发，推导出在总样本量固定和成本相等的约束下使方差最小化的层样本量分配方案。然后，使用该分配方案，计算各层中包含有限总体校正的分层总体平均BMI估计量的方差。\n\n说明：\n- 将 $S_{h}$ 视为已知的层内标准差，并将每层内的抽样视为SRSWOR。\n- 展示最优分配是如何通过在约束条件 $\\sum_{h} n_{h}=n$ 下最小化精确方差表达式得出的，然后通过四舍五入到最近的整数来计算最终总和为 $n$ 的整数分配。\n- 最后，使用您的整数分配计算 $\\bar{Y}_{st}$ 的方差，并以 $(\\text{kg}/\\text{m}^2)^2$ 为单位表示最终的数值。\n- 将您的最终方差四舍五入到四位有效数字。",
            "solution": "### 第1步：提取已知信息\n- 层：$H=3$ 个，由社区健康区域定义。\n- 层大小：$N_{1}=1000$，$N_{2}=2000$ 和 $N_{3}=3000$。\n- 层内标准差：$S_{1}=12 \\ \\mathrm{kg/m^2}$，$S_{2}=6 \\ \\mathrm{kg/m^2}$，$S_{3}=9 \\ \\mathrm{kg/m^2}$。\n- 总样本量：$n=600$。\n- 成本：每个参与者的数据收集成本在各层之间相等。\n- 抽样方法：每层内采用简单无放回随机抽样 (SRSWOR)。\n\n### 第2步：使用提取的信息进行验证\n这个问题是抽样调查理论中的一个标准、定义明确的练习，抽样调查理论是生物统计学和流行病学的核心组成部分，而这两者是预防医学的基础。\n- **科学依据**：该问题使用了既定的统计学原理（分层抽样、方差估计、最优分配），并将其应用于一个现实的公共卫生场景（估计平均BMI）。这些概念是基础性的，而非推测性的。\n- **适定性**：该问题提供了推导唯一最优分配并计算其方差所需的所有数据（$N_h$、$S_h$、$n$）。目标（最小化方差）和约束（固定的总样本量）是明确的。\n- **客观性**：该问题使用精确的定量语言陈述，没有歧义或主观性陈述。\n\n该问题不违反任何无效标准。它是完整的、一致的、现实的，并且可以使用标准方法解决。\n\n### 第3步：结论与行动\n该问题有效。将提供完整解答。\n\n### 推导与求解\n\n目标是使用分层估计量 $\\bar{Y}_{st}$ 来估计总体平均BMI $\\bar{Y}$。总体被划分为 $H=3$ 个层。\n\n总体均值的估计量是分层均值，定义为各层样本均值的加权平均：\n$$ \\bar{Y}_{st} = \\sum_{h=1}^{H} W_h \\bar{y}_h $$\n其中 $\\bar{y}_h$ 是第 $h$ 层的样本均值，$W_h = N_h/N$ 是第 $h$ 层的权重。总体大小为 $N = N_1 + N_2 + N_3 = 1000 + 2000 + 3000 = 6000$。\n各层权重为：\n$W_1 = \\frac{1000}{6000} = \\frac{1}{6}$\n$W_2 = \\frac{2000}{6000} = \\frac{2}{6} = \\frac{1}{3}$\n$W_3 = \\frac{3000}{6000} = \\frac{3}{6} = \\frac{1}{2}$\n\n在每层内通过SRSWOR进行抽样时，分层估计量的方差由下式给出：\n$$ V(\\bar{Y}_{st}) = \\sum_{h=1}^{H} W_h^2 V(\\bar{y}_h) = \\sum_{h=1}^{H} W_h^2 \\left( \\frac{S_h^2}{n_h} \\right) \\left( 1 - \\frac{n_h}{N_h} \\right) $$\n其中 $S_h^2$ 是第 $h$ 层的总体方差，$n_h$ 是第 $h$ 层的样本量，$(1 - n_h/N_h)$ 是有限总体校正 (FPC) 因子。\n该表达式可以展开为：\n$$ V(\\bar{Y}_{st}) = \\sum_{h=1}^{H} W_h^2 \\left( \\frac{S_h^2}{n_h} - \\frac{S_h^2}{N_h} \\right) = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h} - \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{N_h} $$\n\n我们的目标是找到层样本量 $n_1, n_2, n_3$ 使得 $V(\\bar{Y}_{st})$ 最小化，约束条件为总样本量固定为 $n=600$，即 $\\sum_{h=1}^{H} n_h = n$。\n\n在方差表达式中，项 $\\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{N_h}$ 对于分配 $\\{n_h\\}$ 来说是一个常数。因此，最小化 $V(\\bar{Y}_{st})$ 等价于最小化依赖于 $n_h$ 的项：\n$$ \\text{最小化 } f(n_1, \\dots, n_H) = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h} $$\n约束条件为 $g(n_1, \\dots, n_H) = \\sum_{h=1}^{H} n_h - n = 0$。\n\n我们使用拉格朗日乘数法。拉格朗日函数为：\n$$ L(n_1, \\dots, n_H, \\lambda) = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h} + \\lambda \\left( \\left(\\sum_{h=1}^{H} n_h\\right) - n \\right) $$\n为求最小值，我们对 $L$ 关于每个 $n_h$ 求偏导数，并令其为零：\n$$ \\frac{\\partial L}{\\partial n_h} = -\\frac{W_h^2 S_h^2}{n_h^2} + \\lambda = 0 $$\n这意味着：\n$$ \\frac{W_h^2 S_h^2}{n_h^2} = \\lambda \\implies n_h = \\frac{W_h S_h}{\\sqrt{\\lambda}} $$\n现在，我们使用约束条件 $\\sum_{h=1}^{H} n_h = n$：\n$$ \\sum_{h=1}^{H} \\frac{W_h S_h}{\\sqrt{\\lambda}} = n \\implies \\frac{1}{\\sqrt{\\lambda}} \\sum_{h=1}^{H} W_h S_h = n \\implies \\frac{1}{\\sqrt{\\lambda}} = \\frac{n}{\\sum_{k=1}^{H} W_k S_k} $$\n将此代回 $n_h$ 的表达式中：\n$$ n_h = W_h S_h \\left( \\frac{n}{\\sum_{k=1}^{H} W_k S_k} \\right) = n \\frac{W_h S_h}{\\sum_{k=1}^{H} W_k S_k} $$\n这是最优分配的公式，也称为奈曼分配。由于 $W_h = N_h/N$，这等价于：\n$$ n_h = n \\frac{(N_h/N) S_h}{\\sum_{k=1}^{H} (N_k/N) S_k} = n \\frac{N_h S_h}{\\sum_{k=1}^{H} N_k S_k} $$\n\n现在，我们计算分配的具体数值。首先，我们计算乘积 $N_h S_h$：\n$N_1 S_1 = 1000 \\times 12 = 12000$\n$N_2 S_2 = 2000 \\times 6 = 12000$\n$N_3 S_3 = 3000 \\times 9 = 27000$\n\n总和为 $\\sum_{h=1}^{3} N_h S_h = 12000 + 12000 + 27000 = 51000$。\n\n每层的最优分配为：\n$n_1 = n \\frac{N_1 S_1}{\\sum N_k S_k} = 600 \\times \\frac{12000}{51000} = 600 \\times \\frac{12}{51} = \\frac{7200}{51} = \\frac{2400}{17} \\approx 141.176$\n$n_2 = n \\frac{N_2 S_2}{\\sum N_k S_k} = 600 \\times \\frac{12000}{51000} = 600 \\times \\frac{12}{51} \\approx 141.176$\n$n_3 = n \\frac{N_3 S_3}{\\sum N_k S_k} = 600 \\times \\frac{27000}{51000} = 600 \\times \\frac{27}{51} = \\frac{16200}{51} = \\frac{5400}{17} \\approx 317.647$\n\n这些值的总和为 $141.176 + 141.176 + 317.647 = 599.999 \\approx 600$，这证实了我们的计算。\n我们将这些值四舍五入到最接近的整数，并确保总和为 $600$：\n$n_1 \\rightarrow 141$\n$n_2 \\rightarrow 141$\n$n_3 \\rightarrow 318$\n总和为 $141 + 141 + 318 = 600$。这些是我们的整数分配。\n\n最后，我们使用这些整数分配来计算 $\\bar{Y}_{st}$ 的方差。方差的单位为 $(\\mathrm{kg/m^2})^2$。\n$$ V(\\bar{Y}_{st}) = \\sum_{h=1}^{3} W_h^2 \\left( \\frac{S_h^2}{n_h} - \\frac{S_h^2}{N_h} \\right) $$\n我们计算每个层的贡献：\n\n对于层 $h=1$：\n$V_1 = W_1^2 \\left( \\frac{S_1^2}{n_1} - \\frac{S_1^2}{N_1} \\right) = \\left(\\frac{1}{6}\\right)^2 \\left( \\frac{12^2}{141} - \\frac{12^2}{1000} \\right) = \\frac{1}{36} \\left( \\frac{144}{141} - \\frac{144}{1000} \\right)$\n$V_1 = \\frac{4}{141} - \\frac{4}{1000} \\approx 0.02836879 - 0.004 = 0.02436879$\n\n对于层 $h=2$：\n$V_2 = W_2^2 \\left( \\frac{S_2^2}{n_2} - \\frac{S_2^2}{N_2} \\right) = \\left(\\frac{1}{3}\\right)^2 \\left( \\frac{6^2}{141} - \\frac{6^2}{2000} \\right) = \\frac{1}{9} \\left( \\frac{36}{141} - \\frac{36}{2000} \\right)$\n$V_2 = \\frac{4}{141} - \\frac{4}{2000} \\approx 0.02836879 - 0.002 = 0.02636879$\n\n对于层 $h=3$：\n$V_3 = W_3^2 \\left( \\frac{S_3^2}{n_3} - \\frac{S_3^2}{N_3} \\right) = \\left(\\frac{1}{2}\\right)^2 \\left( \\frac{9^2}{318} - \\frac{9^2}{3000} \\right) = \\frac{1}{4} \\left( \\frac{81}{318} - \\frac{81}{3000} \\right)$\n$V_3 = \\frac{81}{1272} - \\frac{81}{12000} \\approx 0.063679245 - 0.00675 = 0.05692925$\n\n总方差是这些分量的和：\n$V(\\bar{Y}_{st}) = V_1 + V_2 + V_3 \\approx 0.02436879 + 0.02636879 + 0.05692925 = 0.10766683$\n\n题目要求将最终答案四舍五入到四位有效数字。\n$V(\\bar{Y}_{st}) \\approx 0.1077 \\ \\mathrm{(kg/m^2)^2}$。",
            "answer": "$$\n\\boxed{0.1077}\n$$"
        },
        {
            "introduction": "在现实世界的公共卫生研究中，除了抽样误差外，我们还必须面对“非抽样误差”的挑战，它可能严重影响研究结果的有效性。一个常见的例子是抽样框不完整，例如一份遗漏了部分人群的患者登记表。本练习将运用基本的概率论原理，向您展示如何量化由这种覆盖不全所引入的系统性偏差，强调了在公共卫生实践中批判性地评估数据来源的重要性 ()。",
            "id": "4570311",
            "problem": "一个公共卫生部门使用免疫接种登记系统来估计其管辖区内符合条件的儿童的疫苗覆盖率。设目标参数为真实总体覆盖率 $p$，定义为随机选择一名符合条件的儿童已接种疫苗的概率。已知该登记系统会遗漏 $12\\%$ 的符合条件的儿童，即一名符合条件的儿童未被登记系统捕获的概率为 $0.12$。实证研究表明，与登记系统中捕获的儿童相比，被遗漏的符合条件的儿童接种疫苗的可能性要低 $1.8$ 倍。登记系统报告的被捕获儿童的覆盖率为 $0.78$。\n\n仅使用偏差和全概率定律的基本定义，根据这些输入数据推导出真实的总体覆盖率，然后量化基于登记系统的朴素估计量的绝对偏差，其定义为 $\\mathbb{E}[\\hat{p}_{R}] - p$，其中 $\\hat{p}_{R}$ 是登记系统报告的被捕获儿童中的比例。假设选择机制（捕获与遗漏）将总体划分为两个组，其覆盖率概率分别为 $p_{I}$（被捕获）和 $p_{M}$（被遗漏），并假设登记系统报告的比例等于 $p_{I}$。\n\n将绝对偏差的最终答案表示为小数比例，并四舍五入到四位有效数字。",
            "solution": "该问题被认为是有效的，因为它在流行病学和生物统计学方面有科学依据，提法得当，客观，并包含足够的信息以得出唯一解。该问题要求应用全概率定律来纠正总体估计中的抽样偏差。\n\n设 $p$ 为真实总体覆盖率，即随机选择一名符合条件的儿童已接种疫苗的概率。我们将其表示为 $p = P(V)$，其中 $V$ 是接种疫苗事件。\n设 $R$ 为符合条件的儿童被免疫接种登记系统捕获的事件， $R^c$ 为儿童未被捕获（即被遗漏）的事件。\n\n根据问题陈述，我们得到以下信息：\n1.  一名符合条件的儿童未被登记系统捕获的概率为 $P(R^c) = 0.12$。\n2.  因此，一名符合条件的儿童被登记系统捕获的概率为 $P(R) = 1 - P(R^c) = 1 - 0.12 = 0.88$。\n3.  登记系统报告的覆盖率是在被登记系统捕获的儿童中已接种疫苗者的比例。这是一个条件概率，我们将其表示为 $p_I = P(V|R)$。问题陈述该值为 $0.78$。因此，$p_I = 0.78$。\n4.  被遗漏儿童中的覆盖率为 $p_M = P(V|R^c)$。\n5.  问题陈述，与登记系统中捕获的儿童相比，被遗漏的符合条件的儿童接种疫苗的可能性要低 $1.8$ 倍。这建立了 $p_M$ 和 $p_I$ 之间的关系：\n$$p_M = \\frac{p_I}{1.8}$$\n代入 $p_I$ 的值：\n$$p_M = \\frac{0.78}{1.8} = \\frac{78}{180} = \\frac{13}{30}$$\n\n为了求得真实总体覆盖率 $p$，我们应用全概率定律。事件 $R$ 和 $R^c$ 构成了对所有符合条件的儿童总体的划分。因此，总的疫苗接种概率 $p$ 是每个子总体中条件概率的加权平均：\n$$p = P(V) = P(V|R)P(R) + P(V|R^c)P(R^c)$$\n代入我们已定义的符号和值：\n$$p = p_I P(R) + p_M P(R^c)$$\n$$p = (0.78)(0.88) + \\left(\\frac{13}{30}\\right)(0.12)$$\n我们进行计算：\n$$p = 0.6864 + \\left(\\frac{13}{30}\\right)\\left(\\frac{12}{100}\\right)$$\n$$p = 0.6864 + \\frac{156}{3000}$$\n$$p = 0.6864 + \\frac{52}{1000}$$\n$$p = 0.6864 + 0.052$$\n$$p = 0.7384$$\n所以，真实的总体覆盖率为 $0.7384$。\n\n接着，问题要求计算基于登记系统的朴素估计量 $\\hat{p}_R$ 的绝对偏差。偏差定义为 $B = \\mathbb{E}[\\hat{p}_{R}] - p$。\n问题陈述中提到，登记系统报告的比例 $\\hat{p}_R$ 等于 $p_I$。由于 $p_I$ 是被捕获儿童子总体的参数，它是一个固定值，而不是基于该子总体样本的随机变量。因此，其期望就是其值本身：$\\mathbb{E}[\\hat{p}_{R}] = p_I$。\n所以，偏差为：\n$$B = p_I - p$$\n代入已知值和计算值：\n$$B = 0.78 - 0.7384$$\n$$B = 0.0416$$\n问题要求最终答案四舍五入到四位有效数字。数字 $0.0416$ 有三位有效数字（数字 $4$、$1$ 和 $6$）。为了将此结果表示为四位有效数字，我们添加一个尾随的零，这在此语境下是有效的。\n$$B = 0.04160$$\n这个正偏差表明，基于登记系统的朴素估计量高估了真实的总体覆盖率。",
            "answer": "$$\\boxed{0.04160}$$"
        }
    ]
}