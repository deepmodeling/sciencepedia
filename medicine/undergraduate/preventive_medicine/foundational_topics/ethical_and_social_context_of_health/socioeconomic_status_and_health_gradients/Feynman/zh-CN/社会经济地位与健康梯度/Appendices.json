{
    "hands_on_practices": [
        {
            "introduction": "研究健康梯度首先要学会如何量化它。本练习将介绍两种最基本的衡量指标——绝对梯度和相对梯度，它们分别从不同角度揭示了社会经济地位对健康影响的严重程度。通过计算这些指标，我们可以更清晰地理解健康不平等的公共卫生负担及其相对强度，为制定干预策略提供关键依据。",
            "id": "4577111",
            "problem": "在一项大都市队列研究中，研究人员使用公认的标准人口进行年龄标化，估算了为期 $5$ 年的社会经济地位 (SES) 五分位数组的年龄标化全因死亡率（每 $100{,}000$ 人年）。其中，$Q_{1}$ 代表社会经济地位最低的群体，$Q_{5}$ 代表社会经济地位最高的群体。观察到的死亡率为：$Q_{1}: 934.7$，$Q_{2}: 811.3$，$Q_{3}: 706.5$，$Q_{4}: 623.9$，$Q_{5}: 571.9$ 例死亡/每 $100{,}000$ 人年。\n\n从将率定义为每人时事件数的核心流行病学测量原则，以及社会流行病学中通过对比分布两端来总结SES-健康梯度的标准做法出发，计算 $Q_{1}$ 和 $Q_{5}$ 之间的绝对SES死亡率梯度以及相对SES死亡率梯度。然后，从人群健康差异的角度对这两个量进行简要解释。\n\n以行矩阵的形式提供最终数值答案，顺序为：$[$绝对梯度, 相对梯度$]$。将每个量四舍五入到 $4$ 位有效数字。绝对梯度以每 $100{,}000$ 人年的死亡数表示，相对梯度以无单位的小数表示。在加框的最终答案中不要包含任何单位。",
            "solution": "用户提供了一个来自预防医学领域，特别是社会流行病学领域的问题，并要求计算和解释社会经济健康梯度。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n- **研究类型**：大都市队列研究。\n- **标化**：年龄标化率。\n- **结局**：全因死亡率。\n- **随访期**：$5$ 年。\n- **测量单位**：每 $100{,}000$ 人年的死亡数。\n- **暴露变量**：社会经济地位 (SES)，分为五分位数。\n- **五分位数定义**：$Q_{1}$ 是社会经济地位最低的群体；$Q_{5}$ 是社会经济地位最高的群体。\n- **观察到的年龄标化死亡率（每 $100{,}000$ 人年）**：\n  - $Q_{1}$ 的率：$934.7$\n  - $Q_{2}$ 的率：$811.3$\n  - $Q_{3}$ 的率：$706.5$\n  - $Q_{4}$ 的率：$623.9$\n  - $Q_{5}$ 的率：$571.9$\n- **任务**：\n  1. 计算 $Q_{1}$ 和 $Q_{5}$ 之间的绝对SES死亡率梯度。\n  2. 计算 $Q_{1}$ 和 $Q_{5}$ 之间的相对SES死亡率梯度。\n  3. 对这两个量进行简要解释。\n  4. 以行矩阵的形式提供最终数值答案，并四舍五入到 $4$ 位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在流行病学和公共卫生的原则上有充分的依据。健康方面的SES梯度概念、年龄标化死亡率的使用、人时分母以及SES五分位数都是该领域的标准且有效的方法。所提供的数据显示死亡率随着贫困程度的增加而单调上升，这与大量科学文献的结论一致。\n- **适定性**：该问题是适定的。它提供了计算所需的所有必要数据和明确定义。通过对比极端五分位数（$Q_{1}$ 和 $Q_{5}$）来计算绝对和相对梯度的要求，是社会流行病学中一种标准且明确的分析方法。\n- **客观性**：该问题是客观、定量的，不含主观或基于观点的陈述。\n\n### 步骤3：结论与行动\n该问题是有效的。它科学合理、适定且客观。没有矛盾、信息缺失或逻辑谬误。我现在将进行解答。\n\n### 解答\n\n该问题要求计算两个基本的健康不平等测量指标：绝对梯度和相对梯度。这些指标用于量化不同社会经济群体之间健康差异的幅度。问题指定比较两个极端的五分位数，$Q_{1}$（最贫困）和 $Q_{5}$（最富裕），这是总结整体梯度的常用做法。\n\n设 $R_{i}$ 表示五分位数 $Q_{i}$ 的年龄标化死亡率。我们关注的给定率为：\n- $R_1 = 934.7$ 例死亡/每 $100{,}000$ 人年。\n- $R_5 = 571.9$ 例死亡/每 $100{,}000$ 人年。\n\n**1. 绝对SES死亡率梯度**\n\n绝对梯度，在其他情况下也称为率差 (RD) 或绝对风险降低，是两组率之间的算术差。它衡量了较贫困组比较富裕组多出的健康事件（在此例中为死亡）数量。\n\n五分位数 $Q_{1}$ 和 $Q_{5}$ 之间的绝对梯度 $G_{A}$ 的公式是：\n$$ G_{A} = R_1 - R_5 $$\n代入给定值：\n$$ G_{A} = 934.7 - 571.9 = 362.8 $$\n绝对梯度的单位与率的单位相同，即每 $100{,}000$ 人年的死亡数。数值 $362.8$ 有四位有效数字，因此无需进一步四舍五入。\n\n**2. 相对SES死亡率梯度**\n\n相对梯度，通常也称为率比 (RR) 或相对风险，是两组率的比值。它通过量化较贫困组发生健康事件的可能性比较富裕组高多少倍来衡量关联的强度。\n\n五分位数 $Q_{1}$ 和 $Q_{5}$ 之间的相对梯度 $G_{R}$ 的公式是：\n$$ G_{R} = \\frac{R_1}{R_5} $$\n代入给定值：\n$$ G_{R} = \\frac{934.7}{571.9} \\approx 1.634376639... $$\n问题要求四舍五入到 $4$ 位有效数字。\n$$ G_{R} \\approx 1.634 $$\n相对梯度是一个无量纲的量。\n\n**3. 梯度的解释**\n\n- **绝对梯度的解释（$G_{A} = 362.8$ 例死亡/每 $100{,}000$ 人年）**：该值表示与最富裕的社会经济五分位数相比，处于最贫困的五分位数所带来的超额死亡。可以解释如下：在一年期间，如果 $Q_{1}$ 组的死亡率与 $Q_{5}$ 组相同，那么每 $100{,}000$ 人中， $Q_{1}$ 组的实际死亡人数比预期多出约 $363$ 人。从公共卫生的角度来看，如果消除了健康结果中的社会经济不平等，这部分死亡负担是潜在可预防的绝对负担。它凸显了问题的严重程度。\n\n- **相对梯度的解释（$G_{R} \\approx 1.634$）**：该值表示差异的乘法幅度。可以解释如下：在对年龄进行调整后，最贫困五分位数（$Q_{1}$）个体的死亡率是最富裕五分位数（$Q_{5}$）个体的 $1.634$ 倍，即高出 $63.4\\%$。该指标可用于传达社会经济地位与死亡率之间关联的强度，且不受基线率的影响。\n\n这两个测量指标是互补的。绝对梯度以超额死亡数来量化公共卫生影响，而相对梯度则量化了不平等的强度。\n\n最终答案要求将两个计算出的值以行矩阵的形式表示，并四舍五入到 $4$ 位有效数字。\n绝对梯度：$362.8$\n相对梯度：$1.634$",
            "answer": "$$ \\boxed{\\begin{pmatrix} 362.8  1.634 \\end{pmatrix}} $$"
        },
        {
            "introduction": "在真实的公共卫生研究中，分析往往始于原始数据。本练习模拟了从家庭调查数据中构建有意义的社会经济地位指标（等效收入），并进一步估算健康梯度的完整流程。掌握这一实践技能，对于将理论概念转化为可操作的研究和评估至关重要。",
            "id": "4577207",
            "problem": "您会获得多个数据集，其中包含个人层面的税前收入、家庭规模和二元高血压状态。在预防医学中，社会经济地位通常通过等值收入来操作化，以解释家庭内部的规模经济。请使用平方根等值量表计算每个个体的等值收入，公式为 $I_e = I / \\sqrt{n}$，其中 $I$ 是以美元/年为单位的税前年收入，$n$ 是家庭规模（人数）。然后，根据每个数据集中等值收入分布得出的收入四分位数，估计高血压患病率的梯度。\n\n基本定义与任务：\n- 等值收入定义为 $I_e = I / \\sqrt{n}$，单位为美元/年。所有收入输入 $I$ 的单位均为美元/年。等值变换 $I_e$ 是一种在健康经济学中经过广泛使用和检验的成熟公式。\n- 患病率定义为组内患有高血压的个体比例，计算公式为 $p = \\frac{\\sum_{i=1}^{m} h_i}{m}$，其中 $h_i \\in \\{0,1\\}$ 是个体 $i$ 的高血压指标，$m$ 是组内个体数量。请将所有患病率和梯度以小数形式表示（不使用百分号）。\n- 四分位数是使用数据集中等值收入分布的经验百分位数来定义的。设第 $25$、$50$ 和 $75$ 百分位数分别为 $Q_{25}$、$Q_{50}$ 和 $Q_{75}$。根据以下规则为每个个体分配四分位数索引 $q \\in \\{1,2,3,4\\}$：\n  - 若 $I_e \\le Q_{25}$，则 $q=1$，\n  - 若 $Q_{25}  I_e \\le Q_{50}$，则 $q=2$，\n  - 若 $Q_{50}  I_e \\le Q_{75}$，则 $q=3$，\n  - 若 $I_e > Q_{75}$，则 $q=4$。\n  此边界约定确保每个观测值（包括在百分位数阈值上的并列值）都被精确分配到一个四分位数中。\n- 对于每个数据集，计算四分位数级别的患病率 $\\{p_1, p_2, p_3, p_4\\}$，其中 $p_q$ 是四分位数 $q$ 内的患病率。\n- 将梯度定义为，在四分位数级别上，对每个四分位数使用相等权重，将 $p_q$ 对四分位数索引 $q \\in \\{1,2,3,4\\}$ 进行普通最小二乘回归所得的斜率 $b$。设 $q$ 的均值为 $\\bar{q}$，$p$ 的均值为 $\\bar{p}$，则斜率为\n  $$ b = \\frac{\\sum_{q=1}^{4} (q - \\bar{q})(p_q - \\bar{p})}{\\sum_{q=1}^{4} (q - \\bar{q})^2}。$$\n  梯度 $b$ 的单位是患病率变化（以小数表示）/四分位数等级单步增加，即每个四分位数步长是无量纲的。\n\n您的程序必须实现以上步骤，并为每个数据集生成梯度 $b$。\n\n测试套件（四个数据集）。每个数据集由三个等长列表指定：收入 $I$（美元/年）、家庭规模 $n$（人数）和高血压指标 $h$（二元）。\n\n- 数据集 A（一般情况，家庭规模混合，预期患病率随等值收入升高而降低）：\n  - $I = [$ $22000$, $28000$, $32000$, $35000$, $40000$, $45000$, $50000$, $55000$, $60000$, $65000$, $70000$, $80000$, $90000$, $100000$, $110000$, $120000$ $]$\n  - $n = [$ $4$, $3$, $3$, $2$, $2$, $2$, $2$, $2$, $3$, $3$, $3$, $3$, $4$, $4$, $4$, $5$ $]$\n  - $h = [$ $1$, $1$, $1$, $1$, $1$, $1$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$ $]$\n- 数据集 B（在四分位数边界附近有并列值，家庭规模混合）：\n  - $I = [$ $30000$, $30000$, $30000$, $45000$, $45000$, $60000$, $60000$, $60000$, $75000$, $75000$, $90000$, $90000$ $]$\n  - $n = [$ $1$, $2$, $2$, $3$, $3$, $2$, $4$, $4$, $2$, $3$, $2$, $5$ $]$\n  - $h = [$ $1$, $1$, $0$, $1$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$ $]$\n- 数据集 C（旨在使各四分位数患病率相等的平衡设计）：\n  - $I = [$ $25000$, $40000$, $55000$, $70000$, $85000$, $100000$, $115000$, $130000$ $]$\n  - $n = [$ $1$, $2$, $3$, $2$, $3$, $4$, $5$, $2$ $]$\n  - $h = [$ $1$, $0$, $1$, $0$, $1$, $0$, $1$, $0$ $]$\n- 数据集 D（低收入的大型家庭影响等值化计算的边缘情况）：\n  - $I = [$ $18000$, $22000$, $26000$, $30000$, $34000$, $38000$, $42000$, $46000$, $50000$, $54000$, $58000$, $62000$, $66000$, $70000$, $74000$, $78000$, $82000$, $86000$, $90000$, $94000$ $]$\n  - $n = [$ $6$, $5$, $5$, $5$, $4$, $4$, $4$, $4$, $3$, $3$, $3$, $3$, $2$, $2$, $2$, $2$, $1$, $1$, $1$, $1$ $]$\n  - $h = [$ $1$, $1$, $1$, $1$, $1$, $1$, $1$, $1$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$, $0$ $]$\n\n角度单位不适用。物理单位仅出现在收入上，以美元/年为单位。高血压患病率是无量纲的，必须以小数形式表示。梯度必须表示为每个四分位数步长的小数变化量。\n\n您的程序应生成单行输出，其中包含四个数据集的梯度，每个梯度四舍五入到六位小数，形式为用方括号括起来的逗号分隔列表。例如，输出必须如下所示：\n$[$ $g_A$, $g_B$, $g_C$, $g_D$ $]$\n其中，$g_A, g_B, g_C, g_D$ 分别是数据集 A 到 D 的浮点数，四舍五入到六位小数。",
            "solution": "该问题陈述是预防医学和健康经济学领域内一个有效且定义明确的定量分析练习。所有术语、变量和程序都得到了足够严谨的定义，所提供的数据也是一致和完整的。该任务要求应用标准方法来评估健康结果中的社会经济梯度。\n\n为确定健康梯度，需要对每个给定的数据集执行以下几个连续步骤。\n\n**第 1 步：计算等值收入**\n\n基本原则是，由于规模经济（例如，共享住房、水电费），家庭收入不会随着家庭规模的扩大而线性增长。平方根等值量表 $I_e = I / \\sqrt{n}$ 是一种调整原始家庭收入（$I$）以适应家庭规模（$n$）的标准方法，从而产生一个可在不同规模家庭之间进行比较的等值收入（$I_e$）。对于给定数据集中的每个个体，我们计算其 $I_e$。\n\n**第 2 步：确定收入四分位数**\n\n为了按社会经济地位对人口进行分层，我们根据其等值收入 $I_e$ 的分布将人口分为四组（四分位数）。这需要计算 $I_e$ 分布的经验百分位数。具体来说，我们计算第 $25$ ($Q_{25}$)、第 $50$ ($Q_{50}$) 和第 $75$ ($Q_{75}$) 百分位数。这些值将作为我们划分四分位数的边界。在计算中，我们使用标准的百分位数线性插值法，这是像 NumPy 这样的大多数数值计算软件包的默认方法。\n\n**第 3 步：将个体分配到四分位数**\n\n根据每个个体的等值收入 $I_e$ 相对于计算出的百分位数边界，将其分配到由 $q \\in \\{1, 2, 3, 4\\}$ 索引的四个四分位数之一。问题指定了一个精确且不重叠的分配规则：\n- 第一四分位数：$I_e \\le Q_{25}$ 的个体\n- 第二四分位数：$Q_{25}  I_e \\le Q_{50}$ 的个体\n- 第三四分位数：$Q_{50}  I_e \\le Q_{75}$ 的个体\n- 第四四分位数：$I_e > Q_{75}$ 的个体\n\n这条规则至关重要，尤其是在数据集中存在落在百分位数边界上的并列 $I_e$ 值时。它确保每个个体都被精确地分配到一个四分位数中。由于 $I_e$ 数据中存在并列值，每个四分位数中的个体数量 $m_q$ 可能不相等。\n\n**第 4 步：计算特定四分位数的高血压患病率**\n\n对于每个四分位数 $q$，我们计算高血压患病率 $p_q$。患病率定义为该组内患有该病的个体比例。在数学上，它是该四分位数中所有个体的二元高血压指标 $h_i \\in \\{0, 1\\}$ 的均值：\n$$ p_q = \\frac{\\sum_{i \\in \\text{Quartile } q} h_i}{m_q} $$\n其中 $m_q$ 是四分位数 $q$ 中的个体数量。这将产生一组四个患病率值 $\\{p_1, p_2, p_3, p_4\\}$，分别对应四个收入四分位数。\n\n**第 5 步：估计社会经济梯度**\n\n最后一步是量化有序收入四分位数之间高血压患病率的趋势。这被定义为梯度 $b$，即通过对患病率 ($p_q$) 和四分位数索引 ($q$) 进行普通最小二乘法 (OLS) 回归得到的斜率。四分位数索引 $q \\in \\{1, 2, 3, 4\\}$ 作为自变量，患病率 $p_q$ 作为因变量。\n\n简单线性回归斜率 $b$ 的公式如下：\n$$ b = \\frac{\\sum_{q=1}^{4} (q - \\bar{q})(p_q - \\bar{p})}{\\sum_{q=1}^{4} (q - \\bar{q})^2} $$\n其中 $\\bar{q}$ 是四分位数索引的均值，$\\bar{p}$ 是四个患病率值的均值。\n\n对于 $q \\in \\{1, 2, 3, 4\\}$，均值为 $\\bar{q} = (1+2+3+4)/4 = 2.5$。分母是一个常数：\n$$ \\sum_{q=1}^{4} (q - \\bar{q})^2 = (1-2.5)^2 + (2-2.5)^2 + (3-2.5)^2 + (4-2.5)^2 = (-1.5)^2 + (-0.5)^2 + (0.5)^2 + (1.5)^2 = 2.25 + 0.25 + 0.25 + 2.25 = 5.0 $$\n斜率的 OLS 估计量可以简化，因为 $\\sum(q - \\bar{q})(p_q - \\bar{p}) = \\sum(q - \\bar{q})p_q$。因此，分子变为：\n$$ \\sum_{q=1}^{4} (q - \\bar{q})p_q = (-1.5)p_1 + (-0.5)p_2 + (0.5)p_3 + (1.5)p_4 $$\n因此，梯度计算如下：\n$$ b = \\frac{-1.5 p_1 - 0.5 p_2 + 0.5 p_3 + 1.5 p_4}{5.0} $$\n这个值 $b$ 表示等值收入每增加一个四分位数等级时，高血压患病率的平均变化。负值表示患病率随收入增加而降低。\n\n将此完整流程应用于四个数据集中的每一个，以获得各自的梯度。\n\n例如，对数据集 A 执行这些计算：\n1.  计算所有 16 个个体的等值收入 ($I_e$)。\n2.  对 $I_e$ 值进行排序以确定四分位数。16 个个体被分成四组，每组四个。\n3.  根据排序后的 $I_e$ 值重新排列高血压指标 $h$。\n    -   第一四分位数：$h=\\{1, 1, 1, 1\\}$，因此 $p_1 = 4/4 = 1.0$。\n    -   第二四分位数：$h=\\{1, 1, 0, 0\\}$，因此 $p_2 = 2/4 = 0.5$。\n    -   第三四分位数：$h=\\{0, 0, 0, 0\\}$，因此 $p_3 = 0/4 = 0.0$。\n    -   第四四分位数：$h=\\{0, 0, 0, 0\\}$，因此 $p_4 = 0/4 = 0.0$。\n4.  计算梯度 $b_A$：\n    $$ b_A = \\frac{-1.5(1.0) - 0.5(0.5) + 0.5(0.0) + 1.5(0.0)}{5.0} = \\frac{-1.5 - 0.25}{5.0} = \\frac{-1.75}{5.0} = -0.35 $$\n对每个数据集重复此过程，以获得最终的梯度列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to calculate and print the socioeconomic gradient in hypertension\n    for the provided datasets.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {\n            \"I\": np.array([22000, 28000, 32000, 35000, 40000, 45000, 50000, 55000, 60000, 65000, 70000, 80000, 90000, 100000, 110000, 120000]),\n            \"n\": np.array([4, 3, 3, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5]),\n            \"h\": np.array([1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),\n        },\n        # Dataset B\n        {\n            \"I\": np.array([30000, 30000, 30000, 45000, 45000, 60000, 60000, 60000, 75000, 75000, 90000, 90000]),\n            \"n\": np.array([1, 2, 2, 3, 3, 2, 4, 4, 2, 3, 2, 5]),\n            \"h\": np.array([1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]),\n        },\n        # Dataset C\n        {\n            \"I\": np.array([25000, 40000, 55000, 70000, 85000, 100000, 115000, 130000]),\n            \"n\": np.array([1, 2, 3, 2, 3, 4, 5, 2]),\n            \"h\": np.array([1, 0, 1, 0, 1, 0, 1, 0]),\n        },\n        # Dataset D\n        {\n            \"I\": np.array([18000, 22000, 26000, 30000, 34000, 38000, 42000, 46000, 50000, 54000, 58000, 62000, 66000, 70000, 74000, 78000, 82000, 86000, 90000, 94000]),\n            \"n\": np.array([6, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1]),\n            \"h\": np.array([1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),\n        }\n    ]\n\n    def calculate_gradient(I, n, h):\n        \"\"\"\n        Calculates the health gradient for a single dataset.\n        \n        Args:\n            I (np.ndarray): Array of pre-tax incomes.\n            n (np.ndarray): Array of household sizes.\n            h (np.ndarray): Array of binary hypertension statuses.\n            \n        Returns:\n            float: The calculated gradient.\n        \"\"\"\n        # Step 1: Compute equivalized income\n        Ie = I / np.sqrt(n)\n\n        # Step 2: Determine income quartiles\n        Q25, Q50, Q75 = np.percentile(Ie, [25, 50, 75])\n\n        # Step 3: Assign individuals to quartiles and get hypertension data for each\n        h1 = h[Ie = Q25]\n        h2 = h[(Ie > Q25)  (Ie = Q50)]\n        h3 = h[(Ie > Q50)  (Ie = Q75)]\n        h4 = h[Ie > Q75]\n        \n        # Step 4: Calculate quartile-specific prevalence\n        p = np.zeros(4)\n        h_groups = [h1, h2, h3, h4]\n        for i, group in enumerate(h_groups):\n            # If a quartile is empty, its prevalence is 0 (or NaN, but 0 is safe\n            # as it won't contribute to the sum of cases). np.mean on an empty\n            # array produces a warning and NaN, so we handle it explicitly.\n            if group.size > 0:\n                p[i] = np.mean(group)\n            else:\n                p[i] = 0.0\n        \n        p1, p2, p3, p4 = p\n\n        # Step 5: Estimate the gradient using the pre-calculated OLS formula\n        # Denominator = (1-2.5)^2 + (2-2.5)^2 + (3-2.5)^2 + (4-2.5)^2 = 5.0\n        # Numerator = -1.5*p1 - 0.5*p2 + 0.5*p3 + 1.5*p4\n        gradient = (-1.5 * p1 - 0.5 * p2 + 0.5 * p3 + 1.5 * p4) / 5.0\n        \n        return gradient\n\n    results = []\n    for case in test_cases:\n        gradient = calculate_gradient(case[\"I\"], case[\"n\"], case[\"h\"])\n        results.append(round(gradient, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "前沿研究致力于揭示社会经济地位影响健康的生物学机制，即“身体体现”（embodiment）的过程。本练习引入了“生理负荷”（allostatic load）这一概念，将其作为衡量累积生理压力的指标，并运用多元回归模型在控制了年龄、性别等混杂因素后，分离出社会经济地位对健康影响的纯粹梯度。这项练习代表了社会流行病学中一种更为精密的分析方法。",
            "id": "4577251",
            "problem": "您的任务是实现一个程序，将预防医学中的一个核心概念——跨社会经济地位的单调健康梯度——进行操作化。该任务包含两个步骤，这些步骤植根于广为接受的定义和建模方法。首先，使用高风险阈值从生物标志物组中构建一个生理负荷分数。其次，在使用线性回归调整年龄和性别后，对其跨社会经济地位五分位数的梯度进行建模。\n\n基本出发点和定义：\n- 生理负荷是生理失调的累积度量。一种标准的操作化方法是，对一组生物标志物的高风险指标进行求和。\n- 普通最小二乘法 (OLS) 是一种经过充分检验的线性回归方法，它通过最小化残差平方和来估计系数。\n- 在此，跨社会经济地位 (SES) 的健康梯度被量化为：在控制年龄和性别的情况下，SES 五分位数每增加一个单位，预期生理负荷的变化量。\n\n建模要求：\n- 对于每个个体 $i$，计算其生理负荷分数 $A_i$，该分数为以下生物标志物高风险指标的总和：C反应蛋白 (CRP)、白细胞介素-6 (IL-6)、皮质醇 (cortisol) 和收缩压 (SBP)。\n- 使用以下特定于生物标志物的高风险阈值：\n  - CRP 高风险，如果 $x_{\\text{CRP}} > 3$ mg/L。\n  - IL-6 高风险，如果 $x_{\\text{IL6}} > 3$ pg/mL。\n  - 皮质醇高风险，如果 $x_{\\text{cort}} > 20$ $\\mu$g/dL。\n  - SBP 高风险，如果 $x_{\\text{SBP}} > 130$ mmHg。\n- 将每个个体的生理负荷分数定义为\n  $$A_i = \\sum_{b \\in \\{\\text{CRP}, \\text{IL6}, \\text{cort}, \\text{SBP}\\}} \\mathbb{1}\\{x_{ib} > t_b\\},$$\n  其中 $t_b$ 表示生物标志物 $b$ 的阈值，$\\mathbb{1}\\{\\cdot\\}$ 是指示函数。\n- 拟合以下 OLS 回归模型：\n  $$A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i,$$\n  其中 $SES_i \\in \\{1,2,3,4,5\\}$ 是编码为整数的社会经济地位五分位数，$\\text{age}_i$ 是以年为单位的年龄，$\\text{sex}_i \\in \\{0,1\\}$ 是编码性别的变量（女性为 $0$，男性为 $1$），$\\varepsilon_i$ 是误差项。SES 梯度即为系数 $\\beta_1$。\n\n单位：\n- 生物标志物输入必须按以下单位解释：CRP 单位为 mg/L，IL-6 单位为 pg/mL，皮质醇单位为 $\\mu$g/dL，收缩压单位为 mmHg。年龄单位为年。性别是无单位的，编码为女性 $0$ 和男性 $1$。生理负荷分数和回归系数是无单位的。您的程序必须计算并输出十进制数形式的系数。\n\n需实现的计算细节：\n- 完全按照上述阈值规则为每个个体计算 $A_i$。\n- 使用设计矩阵 $X$ 拟合 OLS 模型，该矩阵的列为：全为1的截距项、$SES_i$、$\\text{age}_i$ 和 $\\text{sex}_i$。通过最小二乘解估计 $\\hat{\\beta}$。提取并报告 SES 系数 $\\hat{\\beta}_1$。\n- 将报告的每个系数表示为四舍五入到 $6$ 位小数的十进制数。\n\n测试套件：\n- 使用以下三个数据集。每个数据集由具有生物标志物值、年龄、性别和 SES 五分位数的个体组成。对于每个数据集，仅计算并报告调整后的 SES 梯度系数 $\\hat{\\beta}_1$。\n\n数据集 $1$ (混合风险，预期为负SES梯度)：\n- 个体 $1$：CRP $5.0$ mg/L，IL-6 $4.0$ pg/mL，皮质醇 $22.0$ $\\mu$g/dL，SBP $145.0$ mmHg，年龄 $55$，性别 $0$，SES $1$。\n- 个体 $2$：CRP $4.2$，IL-6 $2.5$，皮质醇 $18.0$，SBP $135.0$，年龄 $48$，性别 $1$，SES $1$。\n- 个体 $3$：CRP $3.5$，IL-6 $3.2$，皮质醇 $19.0$，SBP $128.0$，年龄 $60$，性别 $0$，SES $2$。\n- 个体 $4$：CRP $2.0$，IL-6 $1.2$，皮质醇 $21.0$，SBP $132.0$，年龄 $45$，性别 $1$，SES $2$。\n- 个体 $5$：CRP $2.8$，IL-6 $2.0$，皮质醇 $18.0$，SBP $125.0$，年龄 $50$，性别 $0$，SES $3$。\n- 个体 $6$：CRP $3.1$，IL-6 $1.0$，皮质醇 $16.0$，SBP $120.0$，年龄 $35$，性别 $1$，SES $3$。\n- 个体 $7$：CRP $1.5$，IL-6 $1.1$，皮质醇 $15.0$，SBP $118.0$，年龄 $42$，性别 $0$，SES $4$。\n- 个体 $8$：CRP $2.2$，IL-6 $0.9$，皮质醇 $17.0$，SBP $122.0$，年龄 $38$，性别 $1$，SES $4$。\n- 个体 $9$：CRP $0.8$，IL-6 $1.0$，皮质醇 $14.0$，SBP $110.0$，年龄 $40$，性别 $0$，SES $5$。\n- 个体 $10$：CRP $1.0$，IL-6 $0.7$，皮质醇 $13.0$，SBP $108.0$，年龄 $33$，性别 $1$，SES $5$。\n- 个体 $11$：CRP $4.8$，IL-6 $2.8$，皮质醇 $21.0$，SBP $129.0$，年龄 $52$，性别 $0$，SES $2$。\n- 个体 $12$：CRP $3.5$，IL-6 $2.0$，皮质醇 $22.0$，SBP $131.0$，年龄 $47$，性别 $1$，SES $3$。\n\n数据集 $2$ (所有生物标志物均低于阈值：整体生理负荷为零)：\n- 个体 $1$：CRP $2.0$，IL-6 $1.0$，皮质醇 $18.0$，SBP $120.0$，年龄 $50$，性别 $0$，SES $1$。\n- 个体 $2$：CRP $1.5$，IL-6 $0.8$，皮质醇 $10.0$，SBP $110.0$，年龄 $60$，性别 $1$，SES $2$。\n- 个体 $3$：CRP $2.5$，IL-6 $1.2$，皮质醇 $15.0$，SBP $115.0$，年龄 $45$，性别 $0$，SES $3$。\n- 个体 $4$：CRP $2.1$，IL-6 $2.0$，皮质醇 $12.0$，SBP $118.0$，年龄 $35$，性别 $1$，SES $4$。\n- 个体 $5$：CRP $1.0$，IL-6 $0.5$，皮质醇 $9.0$，SBP $105.0$，年龄 $30$，性别 $0$，SES $5$。\n- 个体 $6$：CRP $2.9$，IL-6 $2.5$，皮质醇 $19.0$，SBP $120.0$，年龄 $55$，性别 $1$，SES $2$。\n- 个体 $7$：CRP $2.7$，IL-6 $1.7$，皮质醇 $17.0$，SBP $122.0$，年龄 $48$，性别 $0$，SES $3$。\n- 个体 $8$：CRP $2.2$，IL-6 $1.1$，皮质醇 $11.0$，SBP $119.0$，年龄 $41$，性别 $1$，SES $4$。\n\n数据集 $3$ (所有生物标志物均高于阈值：整体生理负荷达到最大值)：\n- 个体 $1$：CRP $3.5$，IL-6 $3.5$，皮质醇 $21.0$，SBP $140.0$，年龄 $50$，性别 $0$，SES $1$。\n- 个体 $2$：CRP $4.0$，IL-6 $3.2$，皮质醇 $22.0$，SBP $150.0$，年龄 $60$，性别 $1$，SES $2$。\n- 个体 $3$：CRP $5.0$，IL-6 $4.0$，皮质醇 $25.0$，SBP $160.0$，年龄 $45$，性别 $0$，SES $3$。\n- 个体 $4$：CRP $3.1$，IL-6 $3.8$，皮质醇 $23.0$，SBP $135.0$，年龄 $35$，性别 $1$，SES $4$。\n- 个体 $5$：CRP $6.0$，IL-6 $5.0$，皮质醇 $26.0$，SBP $170.0$，年龄 $30$，性别 $0$，SES $5$。\n- 个体 $6$：CRP $3.2$，IL-6 $3.3$，皮质醇 $24.0$，SBP $145.0$，年龄 $55，性别 $1$，SES $2$。\n- 个体 $7$：CRP $4.5$，IL-6 $4.2$，皮质醇 $28.0$，SBP $155.0$，年龄 $48$，性别 $0$，SES $3$。\n- 个体 $8$：CRP $3.8$，IL-6 $3.6$，皮质醇 $27.0$，SBP $138.0$，年龄 $41$，性别 $1$，SES $4$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素是对应一个数据集的 SES 梯度系数 $\\hat{\\beta}_1$，按数据集 $1$、数据集 $2$、数据集 $3$ 的顺序排列，每个系数都四舍五入到 $6$ 位小数。例如，输出格式为 $[\\text{d1},\\text{d2},\\text{d3}]$，其中每个 $\\text{d}$ 是一个十进制数。\n\n不允许外部输入。所需的所有常量和数据均已在上方指定。程序必须是自包含的，并且必须在没有用户交互的情况下运行。",
            "solution": "该问题要求计算调整后的社会经济地位 (SES) 对健康的影响梯度，该过程通过两步法操作化：首先，从一组生物标志物中计算生理负荷分数；其次，使用普通最小二乘法 (OLS) 估计一个多元线性回归模型。代表健康梯度的模型中 SES 五分位数的系数，必须针对三个不同的数据集进行计算。\n\n### 步骤 1：问题验证\n\n**1. 提取给定条件：**\n- **生理负荷分数 ($A_i$)：**对于每个个体 $i$，$A_i$ 是超过高风险阈值的生物标志物数量。\n- **生物标志物与阈值：**\n    - C反应蛋白 (CRP)：高风险，如果 $x_{\\text{CRP}} > 3$ mg/L。\n    - 白细胞介素-6 (IL-6)：高风险，如果 $x_{\\text{IL6}} > 3$ pg/mL。\n    - 皮质醇：高风险，如果 $x_{\\text{cort}} > 20$ $\\mu$g/dL。\n    - 收缩压 (SBP)：高风险，如果 $x_{\\text{SBP}} > 130$ mmHg。\n- **生理负荷公式：**\n  $$A_i = \\sum_{b \\in \\{\\text{CRP}, \\text{IL6}, \\text{cort}, \\text{SBP}\\}} \\mathbb{1}\\{x_{ib} > t_b\\}$$\n  其中 $\\mathbb{1}\\{\\cdot\\}$ 是指示函数，而 $t_b$ 是生物标志物 $b$ 的阈值。\n- **普通最小二乘 (OLS) 回归模型：**\n  $$A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i$$\n- **变量定义：**\n    - $SES_i$：社会经济地位五分位数，一个在 $\\{1, 2, 3, 4, 5\\}$ 中的整数。\n    - $\\text{age}_i$：以年为单位的年龄。\n    - $\\text{sex}_i$：编码为女性 $0$ 和男性 $1$。\n    - $\\varepsilon_i$：误差项。\n- **目标量：**SES 梯度系数 $\\beta_1$。\n- **计算方法：**OLS 系数向量 $\\hat{\\beta}$ 通过最小二乘解估计。\n- **数据：**提供了三个数据集，每个数据集包含个体层面的四个生物标志物、年龄、性别和 SES 五分位数的数据。\n- **输出格式：**一个包含三个估计系数 $\\hat{\\beta}_1$ 的列表，每个数据集一个，四舍五入到 $6$ 位小数。\n\n**2. 使用提取的给定条件进行验证：**\n- **科学依据：**该问题是合理的。生理负荷是心身医学和公共卫生领域广泛接受的用于衡量累积生理压力的概念。对二值化的高风险生物标志物指标进行求和的方法，是一种标准的、尽管简化的操作化方式。普通最小二乘回归是用于建模变量之间关系的基础统计技术。所选的生物标志物是炎症 (CRP, IL-6)、应激反应 (皮质醇) 和心血管健康 (SBP) 的相关指标。跨社会经济地位的健康梯度的存在是社会流行病学的一项基石性发现。\n- **适定性：**该问题是适定的。它提供了所有必要的数据、计算因变量 ($A_i$) 的明确公式、回归模型的精确规范，以及所需输出量 ($\\hat{\\beta}_1$) 的清晰定义。OLS 解存在且唯一，因为从所提供的数据集形成的设计矩阵不表现出完全多重共线性。虽然有两个数据集的因变量没有方差，但这会导出一个确定的且有意义的 OLS 解，其中非截距项的系数为零。\n- **客观性：**该问题以精确、客观和数学化的语言陈述，没有歧义或主观解释的空间。\n\n**3. 结论与行动：**\n问题陈述有效、科学上合理且适定。我将继续进行完整解答。\n\n### 步骤 2：方法论与求解推导\n\n求解过程首先是为每个数据集中的每个个体构建因变量，即生理负荷分数 $A_i$。随后，使用 OLS 方法拟合一个多元线性回归模型来估计系数，特别是与 SES 变量相关的系数 $\\beta_1$。\n\n**1. 生理负荷分数 ($A_i$) 计算：**\n对于每个个体 $i$，生理负荷分数 $A_i$ 是一个介于 $0$ 和 $4$ 之间的整数，通过将超过其指定高风险阈值的生物标志物数量相加计算得出：\n- 如果 CRP $ 3$ mg/L，则加 $1$ 分\n- 如果 IL-6 $ 3$ pg/mL，则加 $1$ 分\n- 如果皮质醇 $ 20$ $\\mu$g/dL，则加 $1$ 分\n- 如果 SBP $ 130$ mmHg，则加 $1$ 分\n\n**2. OLS 回归：**\n待估计的模型为 $A_i = \\beta_0 + \\beta_1 \\cdot SES_i + \\beta_2 \\cdot \\text{age}_i + \\beta_3 \\cdot \\text{sex}_i + \\varepsilon_i$。\n其矩阵形式写作 $y = X\\beta + \\varepsilon$，其中：\n- $y$ 是生理负荷分数的 $N \\times 1$ 向量，$[A_1, A_2, ..., A_N]^T$。\n- $X$ 是 $N \\times 4$ 的设计矩阵，其中第 $i$ 行对应一个个体，由 $[1, SES_i, \\text{age}_i, \\text{sex}_i]$ 给出。第一列全为1，代表截距项 $\\beta_0$。\n- $\\beta$ 是 $4 \\times 1$ 的系数向量，$[\\beta_0, \\beta_1, \\beta_2, \\beta_3]^T$。\n- $\\varepsilon$ 是 $N \\times 1$ 的误差项向量。\n\n系数向量 $\\beta$ 的 OLS 估计量 $\\hat{\\beta}$ 由最小化残差平方和的公式给出：\n$$ \\hat{\\beta} = (X^T X)^{-1} X^T y $$\n我们的目标是找到该向量的第二个元素 $\\hat{\\beta}_1$。\n\n### 步骤 3：应用于数据集\n\n**数据集 1：**\n首先，我们为这 12 个个体中的每一个计算生理负荷分数 $A_i$。\n- 个体 $1$：$A_1 = \\mathbb{1}\\{5.03\\} + \\mathbb{1}\\{4.03\\} + \\mathbb{1}\\{22.020\\} + \\mathbb{1}\\{145.0130\\} = 1+1+1+1=4$\n- 个体 $2$：$A_2 = \\mathbb{1}\\{4.23\\} + \\mathbb{1}\\{2.53\\} + \\mathbb{1}\\{18.020\\} + \\mathbb{1}\\{135.0130\\} = 1+0+0+1=2$\n- 个体 $3$：$A_3 = \\mathbb{1}\\{3.53\\} + \\mathbb{1}\\{3.23\\} + \\mathbb{1}\\{19.020\\} + \\mathbb{1}\\{128.0130\\} = 1+1+0+0=2$\n- 个体 $4$：$A_4 = \\mathbb{1}\\{2.03\\} + \\mathbb{1}\\{1.23\\} + \\mathbb{1}\\{21.020\\} + \\mathbb{1}\\{132.0130\\} = 0+0+1+1=2$\n- 个体 $5$：$A_5 = 0+0+0+0=0$\n- 个体 $6$：$A_6 = \\mathbb{1}\\{3.13\\} + 0+0+0=1$\n- 个体 $7$：$A_7 = 0+0+0+0=0$\n- 个体 $8$：$A_8 = 0+0+0+0=0$\n- 个体 $9$：$A_9 = 0+0+0+0=0$\n- 个体 $10$：$A_{10} = 0+0+0+0=0$\n- 个体 $11$：$A_{11} = \\mathbb{1}\\{4.83\\} + \\mathbb{1}\\{2.83\\} + \\mathbb{1}\\{21.020\\} + \\mathbb{1}\\{129.0130\\} = 1+0+1+0=2$\n- 个体 $12$：$A_{12} = \\mathbb{1}\\{3.53\\} + \\mathbb{1}\\{2.03\\} + \\mathbb{1}\\{22.020\\} + \\mathbb{1}\\{131.0130\\} = 1+0+1+1=3$\n\n因变量向量为 $y_1 = [4, 2, 2, 2, 0, 1, 0, 0, 0, 0, 2, 3]^T$。\n设计矩阵 $X_1$ 为：\n$$ X_1 = \\begin{pmatrix} 1  1  55  0 \\\\ 1  1  48  1 \\\\ 1  2  60  0 \\\\ 1  2  45  1 \\\\ 1  3  50  0 \\\\ 1  3  35  1 \\\\ 1  4  42  0 \\\\ 1  4  38  1 \\\\ 1  5  40  0 \\\\ 1  5  33  1 \\\\ 1  2  52  0 \\\\ 1  3  47  1 \\end{pmatrix} $$\n计算 $\\hat{\\beta} = (X_1^T X_1)^{-1} X_1^T y_1$ 得到系数向量 $\\hat{\\beta} \\approx [4.295280, -0.871038, 0.009406, 0.061737]^T$。\nSES 梯度为 $\\hat{\\beta}_1 \\approx -0.871038$。\n\n**数据集 2：**\n在此数据集中，每个个体的所有四个生物标志物值均低于其各自的高风险阈值。\n- 例如，个体 $1$：$x_{\\text{CRP}}=2.0 \\le 3$, $x_{\\text{IL6}}=1.0 \\le 3$, $x_{\\text{cort}}=18.0 \\le 20$, $x_{\\text{SBP}}=120.0 \\le 130$。\n因此，对所有 $i$ 而言，生理负荷分数 $A_i = 0$。\n因变量向量为 $y_2 = [0, 0, 0, 0, 0, 0, 0, 0]^T$。\n当因变量向量是零向量时，最小化误差平方和的 OLS 解是系数的零向量，即 $\\hat{\\beta}=[0, 0, 0, 0]^T$。也就是说，$\\hat{\\beta} = (X_2^T X_2)^{-1} X_2^T y_2 = (X_2^T X_2)^{-1} \\mathbf{0} = \\mathbf{0}$。\n因此，SES 梯度为 $\\hat{\\beta}_1 = 0$。\n\n**数据集 3：**\n在此数据集中，每个个体的所有四个生物标志物值均高于其各自的高风险阈值。\n- 例如，个体 $1$：$x_{\\text{CRP}}=3.5  3$, $x_{\\text{IL6}}=3.5  3$, $x_{\\text{cort}}=21.0  20$, $x_{\\text{SBP}}=140.0  130$。\n因此，对所有 $i$ 而言，生理负荷分数为 $A_i=4$。\n因变量向量为 $y_3=[4, 4, 4, 4, 4, 4, 4, 4]^T$。\n当因变量为常数 $y_i = c$，且模型包含截距项时，截距项的 OLS 估计值为 $\\hat{\\beta}_0 = c$，而所有其他斜率系数的估计值为 $0$。这将误差平方和最小化为 $0$。此处，$c=4$。\n解为 $\\hat{\\beta}=[4, 0, 0, 0]^T$。\n因此，SES 梯度为 $\\hat{\\beta}_1 = 0$。这个结果是符合逻辑的：如果结果变量（生理负荷）没有变异，那么任何预测变量（如 SES）都无法解释任何方差。\n\n**结果摘要：**\n- 数据集 1: $\\hat{\\beta}_1 \\approx -0.87103753 \\rightarrow -0.871038$\n- 数据集 2: $\\hat{\\beta}_1 = 0.0 \\rightarrow 0.000000$\n- 数据集 3: $\\hat{\\beta}_1 = 0.0 \\rightarrow 0.000000$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the adjusted socioeconomic status (SES) gradient on health for three datasets.\n    The process involves:\n    1. Calculating an allostatic load score for each individual based on biomarker thresholds.\n    2. Fitting an Ordinary Least Squares (OLS) regression of the score on SES, age, and sex.\n    3. Extracting the coefficient for SES.\n    \"\"\"\n    \n    # Define the high-risk thresholds for the biomarkers.\n    # Order: CRP, IL-6, Cortisol, SBP\n    thresholds = np.array([3.0, 3.0, 20.0, 130.0])\n\n    # Define the three test case datasets.\n    # Each entry is a tuple: (biomarkers, covariates)\n    # biomarkers: [CRP, IL-6, Cortisol, SBP]\n    # covariates: [SES, age, sex]\n    test_cases = [\n        # Dataset 1\n        [\n            ([5.0, 4.0, 22.0, 145.0], [1, 55, 0]),\n            ([4.2, 2.5, 18.0, 135.0], [1, 48, 1]),\n            ([3.5, 3.2, 19.0, 128.0], [2, 60, 0]),\n            ([2.0, 1.2, 21.0, 132.0], [2, 45, 1]),\n            ([2.8, 2.0, 18.0, 125.0], [3, 50, 0]),\n            ([3.1, 1.0, 16.0, 120.0], [3, 35, 1]),\n            ([1.5, 1.1, 15.0, 118.0], [4, 42, 0]),\n            ([2.2, 0.9, 17.0, 122.0], [4, 38, 1]),\n            ([0.8, 1.0, 14.0, 110.0], [5, 40, 0]),\n            ([1.0, 0.7, 13.0, 108.0], [5, 33, 1]),\n            ([4.8, 2.8, 21.0, 129.0], [2, 52, 0]),\n            ([3.5, 2.0, 22.0, 131.0], [3, 47, 1]),\n        ],\n        # Dataset 2\n        [\n            ([2.0, 1.0, 18.0, 120.0], [1, 50, 0]),\n            ([1.5, 0.8, 10.0, 110.0], [2, 60, 1]),\n            ([2.5, 1.2, 15.0, 115.0], [3, 45, 0]),\n            ([2.1, 2.0, 12.0, 118.0], [4, 35, 1]),\n            ([1.0, 0.5, 9.0, 105.0], [5, 30, 0]),\n            ([2.9, 2.5, 19.0, 120.0], [2, 55, 1]),\n            ([2.7, 1.7, 17.0, 122.0], [3, 48, 0]),\n            ([2.2, 1.1, 11.0, 119.0], [4, 41, 1]),\n        ],\n        # Dataset 3\n        [\n            ([3.5, 3.5, 21.0, 140.0], [1, 50, 0]),\n            ([4.0, 3.2, 22.0, 150.0], [2, 60, 1]),\n            ([5.0, 4.0, 25.0, 160.0], [3, 45, 0]),\n            ([3.1, 3.8, 23.0, 135.0], [4, 35, 1]),\n            ([6.0, 5.0, 26.0, 170.0], [5, 30, 0]),\n            ([3.2, 3.3, 24.0, 145.0], [2, 55, 1]),\n            ([4.5, 4.2, 28.0, 155.0], [3, 48, 0]),\n            ([3.8, 3.6, 27.0, 138.0], [4, 41, 1]),\n        ]\n    ]\n\n    results = []\n    for dataset in test_cases:\n        # Unpack data for the current dataset\n        biomarker_data = np.array([p[0] for p in dataset])\n        covariate_data = np.array([p[1] for p in dataset])\n        \n        # Step 1: Calculate the allostatic load score (y vector)\n        # Compare each biomarker value against its threshold\n        high_risk_indicators = biomarker_data > thresholds\n        # Sum the indicators for each person to get the allostatic load score\n        y = high_risk_indicators.sum(axis=1)\n\n        # Step 2: Construct the design matrix X\n        num_individuals = covariate_data.shape[0]\n        # Create an intercept column of ones\n        intercept = np.ones((num_individuals, 1))\n        # Combine intercept with covariates (SES, age, sex)\n        X = np.hstack((intercept, covariate_data))\n        \n        # Step 3: Compute OLS coefficients using the normal equation: beta = (X'X)^(-1)X'y\n        # A check for constant y can optimize, but the formula works for all cases.\n        # If y is constant, all non-intercept betas will be zero.\n        try:\n            XTX = X.T @ X\n            XTX_inv = np.linalg.inv(XTX)\n            XTY = X.T @ y\n            beta_hat = XTX_inv @ XTY\n        except np.linalg.LinAlgError:\n            # Fallback to lstsq for numerical stability, though not expected for this data\n            beta_hat = np.linalg.lstsq(X, y, rcond=None)[0]\n        \n        # The SES gradient is the second coefficient (index 1)\n        ses_gradient = beta_hat[1]\n        results.append(ses_gradient)\n\n    # Format the final output as a string with 6 decimal places for each result.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}