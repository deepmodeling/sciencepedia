{
    "hands_on_practices": [
        {
            "introduction": "在预防医学中，将“健康”这一抽象概念转化为可操作的定义是关键第一步。本练习将探讨如何使用统计学方法，特别是正态分布，来定义生理指标的“正常”范围，并让您亲手计算划定异常界限所带来的后果。通过这个练习，您将深入理解临床参考值的设定依据，以及在健康与疾病之间划定界限时所固有的权衡。",
            "id": "4518317",
            "problem": "一个预防医学项目通过使用人群参考分布，来操作化健康、良好状态和疾病对于单一的生理变量的定义。设该变量在一个健康参考类别中由正态分布 $X \\sim N(\\mu,\\sigma^{2})$ 建模，其中 $X$ 是测量值，$\\mu$ 是总体均值，$\\sigma$ 是总体标准差。在一个基于经验规范的定义下，如果一个个体的测量值低于某个截止值 $T$，则该个体被标记为具有潜在的疾病状态（偏离健康和良好状态）。该截止值 $T$ 被选为低于均值 $k$ 个标准差，即 $T = \\mu - k\\sigma$。该规则旨在检测缺乏型异常，而 $k$ 的选择是一个旨在平衡假阳性和假阴性的惯例。\n\n仅从正态分布的性质和异常的定义 $X  T$ 出发，推导在健康参考类别中将被标记为异常的个体所占的预期比例，并将其表示为 $k$ 的函数。然后，在 $k = 2$（常规的“双标准差”规则）时计算这个比例，并提供数值。将最终结果表示为小数，并四舍五入到四位有效数字。此外，从概念上简要解释，在不改变所要求的数值结果的前提下，$k$ 的选择如何体现了在健康、良好状态和疾病的定义边界中操作性阈值的任意性。",
            "solution": "问题陈述已经过验证，被认为是科学上可靠、定义明确且客观的。它提出了一个生物统计学中的标准问题，可以使用概率论的基本原理解答。\n\n问题要求计算在一个健康参考类别中将被标记为异常的个体的预期比例。这个健康类别的生理变量 $X$ 由正态分布 $X \\sim N(\\mu, \\sigma^2)$ 建模，其中 $\\mu$ 是总体均值，$\\sigma^2$ 是方差。如果一个个体的测量值 $X$ 小于一个截止阈值 $T$，则该个体被标记为异常。该阈值定义为 $T = \\mu - k\\sigma$，其中 $k$ 是一个指定的标准差数。\n\n被标记的个体的预期比例是该事件发生的概率，即 $P(X  T)$。我们可以将 $T$ 的定义代入不等式中：\n$$\nP(X  \\mu - k\\sigma)\n$$\n为了计算这个概率，我们对随机变量 $X$ 进行标准化。我们定义一个新的随机变量 $Z$ 为：\n$$\nZ = \\frac{X - \\mu}{\\sigma}\n$$\n根据正态分布的性质，如果 $X \\sim N(\\mu, \\sigma^2)$，那么 $Z$ 服从标准正态分布，$Z \\sim N(0, 1)$。现在我们将关于 $X$ 的不等式转换为一个等价的关于 $Z$ 的不等式：\n$$\nX  \\mu - k\\sigma\n$$\n两边都减去 $\\mu$ 得：\n$$\nX - \\mu  -k\\sigma\n$$\n两边都除以标准差 $\\sigma$（这是一个正值）得：\n$$\n\\frac{X - \\mu}{\\sigma}  -k\n$$\n用 $Z$ 替换左边，我们得到：\n$$\nZ  -k\n$$\n问题现在简化为求标准正态变量 $Z$ 的概率 $P(Z  -k)$。这个概率由标准正态分布的累积分布函数（CDF）给出，通常表示为 $\\Phi(z)$。CDF 定义为 $\\Phi(z) = P(Z \\le z)$。对于像正态分布这样的连续分布，$P(Z \\le z) = P(Z  z)$。因此，被标记为异常的个体比例，作为 $k$ 的函数，是：\n$$\n\\text{比例}(k) = P(Z  -k) = \\Phi(-k)\n$$\n这可以利用误差函数 $\\operatorname{erf}(x)$ 来正式表示，其中标准正态分布的CDF是 $\\Phi(z) = \\frac{1}{2}\\left(1 + \\operatorname{erf}\\left(\\frac{z}{\\sqrt{2}}\\right)\\right)$。使用 $\\operatorname{erf}(-x) = -\\operatorname{erf}(x)$ 这个性质，我们有：\n$$\n\\Phi(-k) = \\frac{1}{2}\\left(1 + \\operatorname{erf}\\left(\\frac{-k}{\\sqrt{2}}\\right)\\right) = \\frac{1}{2}\\left(1 - \\operatorname{erf}\\left(\\frac{k}{\\sqrt{2}}\\right)\\right)\n$$\n这就是推导出的作为 $k$ 的函数的比例。\n\n接下来，我们计算 $k=2$ 这一特定情况下的这个比例。我们需要计算 $\\Phi(-2)$。利用标准正态分布的对称性，即 $\\Phi(-z) = 1 - \\Phi(z)$，我们有：\n$$\n\\Phi(-2) = 1 - \\Phi(2)\n$$\n$\\Phi(2)$ 的值是统计学中的一个标准结果，它表示直到高于均值 $2$ 个标准差的累积概率。从标准正态分布表或计算器中，我们发现：\n$$\n\\Phi(2) \\approx 0.977249868...\n$$\n因此，对于 $k=2$，被标记的健康个体的比例是：\n$$\n\\Phi(-2) \\approx 1 - 0.977249868... = 0.022750132...\n$$\n问题要求将此结果四舍五入到四位有效数字。第一个有效数字是第一个非零数字，即百分位上的 $2$。四位有效数字是 $2$、$2$、$7$ 和 $5$。第五位小数后面的数字是 $0$，所以我们不向上取整。\n$$\n0.02275\n$$\n\n最后，关于概念性要点：$k$ 的选择体现了医学中操作性阈值的任意性。推导出的比例 $\\Phi(-k)$ 是健康人群的假阳性率。在选择 $k$ 时存在一个固有的权衡：\n1.  较小的 $k$（例如，$k=1$）会标记出更大部分的健康个体（$\\Phi(-1) \\approx 0.1587$ 或 $15.87\\%$）。这增加了测试的灵敏度（更少的患病个体被漏检，即更少的假阴性），但代价是牺牲了特异性（许多健康个体被错误标记，即更多的假阳性）。\n2.  较大的 $k$（例如，$k=3$）会标记出小得多的健康个体比例（$\\Phi(-3) \\approx 0.00135$ 或 $0.135\\%$）。这增加了特异性，但增加了漏掉实际疾病病例的风险（较低的灵敏度，更多的假阴性），尤其是轻度或早期的病例。\n\n选择 $k=2$（对应约 $2.3\\%$ 的假阳性率）是一个惯例。这是一个务实的折衷，而不是从基本生物学原理推导出的值。“健康”与“疾病”之间的界限是一个生物学上的连续体。通过施加一个明确的截止值 $T$，我们正在创造一个人为的二分法。这个截止值的具体位置由 $k$ 决定，它反映了在特定临床背景下对假阳性与假阴性相对成本的价值判断。因此，这个选择在某种意义上是任意的，因为它是一个基于临床效用和风险管理的惯例，而不是发现了一条自然的、预先存在的分割线。",
            "answer": "$$\n\\boxed{0.02275}\n$$"
        },
        {
            "introduction": "拥有一个筛查工具后，我们必须评估其在真实世界中的表现。本练习将引导您从第一性原理出发，推导并计算衡量一项筛查测试准确性的核心指标：灵敏度、特异度、阳性预测值和阴性预测值。掌握这些概念对于正确解读测试结果至关重要，它将揭示疾病的患病率如何深刻影响测试的实际预测能力。",
            "id": "4518322",
            "problem": "一个社区预防医学项目采用一种筛查测试，以识别患有慢性无症状疾病的个体，这种疾病会影响他们参与健康干预的准备情况。在此背景下，个体根据其潜在的疾病状态（患病与非患病）和筛查测试结果（阳性与阴性）进行分类。使用标准的流行病学条件概率框架，根据疾病和测试结果的事件，为灵敏度、特异度、阳性预测值和阴性预测值提供精确的定义。然后，仅从这些定义以及全概率公式和贝叶斯法则出发，推导阳性预测值和阴性预测值作为灵敏度、特异度和患病率的函数的符号表达式。最后，对于一个筛查测试灵敏度 $Se = 0.90$、特异度 $Sp = 0.95$、疾病患病率 $p = 0.05$ 的人群，计算阳性预测值和阴性预测值。将这两个值以小数形式表示，并四舍五入到四位有效数字。不应使用单位符号。",
            "solution": "我们用事件和条件概率来形式化这个场景。令 $D$ 表示个体确实患病的事件，$D^{c}$ 表示其补集（未患病）。令 $T^{+}$ 表示筛查测试结果为阳性，$T^{-}$ 表示筛查测试结果为阴性。患病率为 $p = \\Pr(D)$，因此 $\\Pr(D^{c}) = 1 - p$。\n\n我们从基于条件概率的精确定义开始：\n- 灵敏度 $Se$ 是在个体患病的情况下测试结果为阳性的概率，即 $Se = \\Pr(T^{+} \\mid D)$。\n- 特异度 $Sp$ 是在个体未患病的情况下测试结果为阴性的概率，即 $Sp = \\Pr(T^{-} \\mid D^{c})$。\n- 阳性预测值 (PPV) 是在测试结果为阳性的情况下个体确实患病的概率，即 $\\mathrm{PPV} = \\Pr(D \\mid T^{+})$。\n- 阴性预测值 (NPV) 是在测试结果为阴性的情况下个体确实未患病的概率，即 $\\mathrm{NPV} = \\Pr(D^{c} \\mid T^{-})$。\n\n为了推导 $\\mathrm{PPV}$，我们使用贝叶斯法则：\n$$\n\\Pr(D \\mid T^{+}) = \\frac{\\Pr(T^{+} \\mid D)\\Pr(D)}{\\Pr(T^{+})}.\n$$\n全概率公式给出\n$$\n\\Pr(T^{+}) = \\Pr(T^{+} \\mid D)\\Pr(D) + \\Pr(T^{+} \\mid D^{c})\\Pr(D^{c}).\n$$\n我们知道 $\\Pr(T^{+} \\mid D) = Se$ 且 $\\Pr(D) = p$。对于未患病的个体，$\\Pr(T^{-} \\mid D^{c}) = Sp$，所以 $\\Pr(T^{+} \\mid D^{c}) = 1 - Sp$。同时 $\\Pr(D^{c}) = 1 - p$。因此，\n$$\n\\Pr(T^{+}) = Se \\cdot p + (1 - Sp)\\cdot (1 - p).\n$$\n代入贝叶斯法则，得到阳性预测值：\n$$\n\\mathrm{PPV} = \\frac{Se \\cdot p}{Se \\cdot p + (1 - Sp)\\cdot (1 - p)}.\n$$\n\n为了推导 $\\mathrm{NPV}$，我们将贝叶斯法则应用于 $\\Pr(D^{c} \\mid T^{-})$：\n$$\n\\Pr(D^{c} \\mid T^{-}) = \\frac{\\Pr(T^{-} \\mid D^{c})\\Pr(D^{c})}{\\Pr(T^{-})}.\n$$\n根据全概率公式，\n$$\n\\Pr(T^{-}) = \\Pr(T^{-} \\mid D)\\Pr(D) + \\Pr(T^{-} \\mid D^{c})\\Pr(D^{c}).\n$$\n我们有 $\\Pr(T^{-} \\mid D) = 1 - Se$，$\\Pr(D) = p$，$\\Pr(T^{-} \\mid D^{c}) = Sp$，以及 $\\Pr(D^{c}) = 1 - p$。因此，\n$$\n\\Pr(T^{-}) = (1 - Se)\\cdot p + Sp\\cdot (1 - p),\n$$\n因此阴性预测值为\n$$\n\\mathrm{NPV} = \\frac{Sp\\cdot (1 - p)}{(1 - Se)\\cdot p + Sp\\cdot (1 - p)}.\n$$\n\n现在对 $Se = 0.90$，$Sp = 0.95$ 和 $p = 0.05$ 进行数值计算。\n\n首先，计算 $\\mathrm{PPV}$：\n$$\n\\mathrm{PPV} = \\frac{0.90 \\cdot 0.05}{0.90 \\cdot 0.05 + (1 - 0.95)\\cdot (1 - 0.05)} = \\frac{0.045}{0.045 + 0.05 \\cdot 0.95}.\n$$\n分母为 $0.045 + 0.0475 = 0.0925$，所以\n$$\n\\mathrm{PPV} = \\frac{0.045}{0.0925}.\n$$\n这个比率可以精确地化简为一个分数：$0.045/0.0925 = \\frac{18}{37}$。作为小数，$\\frac{18}{37} \\approx 0.486486\\ldots$。四舍五入到四位有效数字，$\\mathrm{PPV} = 0.4865$。\n\n接下来，计算 $\\mathrm{NPV}$：\n$$\n\\mathrm{NPV} = \\frac{0.95 \\cdot (1 - 0.05)}{(1 - 0.90)\\cdot 0.05 + 0.95 \\cdot (1 - 0.05)} = \\frac{0.95 \\cdot 0.95}{0.10 \\cdot 0.05 + 0.95 \\cdot 0.95}.\n$$\n分子是 $0.9025$。分母是 $0.005 + 0.9025 = 0.9075$。因此，\n$$\n\\mathrm{NPV} = \\frac{0.9025}{0.9075}.\n$$\n这个比率可以精确地化简为 $\\frac{361}{363}$。作为小数，$\\frac{361}{363} \\approx 0.994490\\ldots$。四舍五入到四位有效数字，$\\mathrm{NPV} = 0.9945$。\n\n因此，以小数形式表示并保留四位有效数字，阳性预测值为 $0.4865$，阴性预测值为 $0.9945$。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.4865  0.9945\\end{pmatrix}}$$"
        },
        {
            "introduction": "在现实世界中，错误的医学决策会带来不同程度的代价，例如，漏诊（假阴性）的代价可能远高于虚惊一场（假阳性）。本练习将带您进入贝叶斯决策理论的世界，学习如何通过量化不同错误分类的成本，来确定一个最优的决策阈值。这项实践将统计学原理与现实中的风险管理相结合，展示了在预防医学中如何做出更明智、更负责任的决策。",
            "id": "4518347",
            "problem": "一个社区预防医学项目部署了一种筛查工具，该工具输出在给定个体观测筛查数据 $x$ 的情况下，其患有某种特定慢性病 $D$ 的后验概率 $P(D=1 \\mid x)$。该疾病在目标人群中的患病率为 $p=0.1$。该项目必须为每个个体选择一个二元标签：“患病”($D=1$)或“未患病”($D=0$)。决策策略是将 $P(D=1 \\mid x)$ 与一个阈值 $\\theta$ 进行比较，如果 $P(D=1 \\mid x) \\ge \\theta$，则标记为“患病”，否则标记为“未患病”。\n\n使用 Bayes 决策理论和以下错分成本：当 $D=0$ 时标记为“患病”的假阳性成本 $C_{FP}=1$，以及当 $D=1$ 时标记为“未患病”的假阴性成本 $C_{FN}=10$，从第一性原理推导出能使每个给定数据 $x$ 的个体的后验期望损失最小化的最优后验阈值 $\\theta^{*}$。将最终答案表示为单个精确值，不要四舍五入。",
            "solution": "所述问题具有科学依据、提法明确、客观，并包含足够的信息以得到唯一解。这是 Bayes 决策理论的一个直接应用。因此，这是一个有效的问题。\n\n目标是确定在给定个体筛查数据 $x$ 的情况下，能使其后验期望损失最小化的最优决策阈值 $\\theta^*$。该决策是一个二元分类：将个体标记为“患病”($D=1$)或“未患病”($D=0$)。该决策基于后验概率 $P(D=1 \\mid x)$。\n\n设两种可能的行动为 $a_1$ (决策为“患病”) 和 $a_0$ (决策为“未患病”)。问题给出了与错分相关的成本：\n- 假阳性的成本，$C_{FP}$：当真实状态为 $D=0$ 时决策为 $a_1$。我们已知 $C_{FP}=1$。\n- 假阴性的成本，$C_{FN}$：当真实状态为 $D=1$ 时决策为 $a_0$。我们已知 $C_{FN}=10$。\n\n正确分类的成本隐含为零：\n- 真阳性的成本，$C_{TP}$：当真实状态为 $D=1$ 时决策为 $a_1$。我们有 $C_{TP}=0$。\n- 真阴性的成本，$C_{TN}$：当真实状态为 $D=0$ 时决策为 $a_0$。我们有 $C_{TN}=0$。\n\n在给定观测值 $x$ 的情况下，采取特定行动 $a$ 的后验期望损失（或条件风险）$R(a \\mid x)$，是每种可能结果的成本乘以其后验概率的总和。\n\n首先，我们计算采取行动 $a_1$ (决策为“患病”) 的后验期望损失：\n可能的结果是真阳性（如果该人患病，$D=1$）或假阳性（如果该人未患病，$D=0$）。\n$$R(a_1 \\mid x) = C_{TP} \\cdot P(D=1 \\mid x) + C_{FP} \\cdot P(D=0 \\mid x)$$\n代入给定的成本值：\n$$R(a_1 \\mid x) = 0 \\cdot P(D=1 \\mid x) + 1 \\cdot P(D=0 \\mid x)$$\n使用恒等式 $P(D=0 \\mid x) = 1 - P(D=1 \\mid x)$，我们得到：\n$$R(a_1 \\mid x) = 1 \\cdot (1 - P(D=1 \\mid x)) = 1 - P(D=1 \\mid x)$$\n\n接下来，我们计算采取行动 $a_0$ (决策为“未患病”) 的后验期望损失：\n可能的结果是假阴性（如果该人患病，$D=1$）或真阴性（如果该人未患病，$D=0$）。\n$$R(a_0 \\mid x) = C_{FN} \\cdot P(D=1 \\mid x) + C_{TN} \\cdot P(D=0 \\mid x)$$\n代入给定的成本值：\n$$R(a_0 \\mid x) = 10 \\cdot P(D=1 \\mid x) + 0 \\cdot P(D=0 \\mid x)$$\n$$R(a_0 \\mid x) = 10 \\cdot P(D=1 \\mid x)$$\n\n根据 Bayes 决策理论，最优行动是使后验期望损失最小化的行动。因此，如果决策为“患病”（采取行动 $a_1$）的期望损失小于或等于决策为“未患病”（行动 $a_0$）的期望损失，我们应该决策为“患病”。为了与问题的决策规则格式 $P(D=1 \\mid x) \\ge \\theta$ 保持一致，相等的情况被分配给行动 $a_1$。\n决策为 $a_1$ 的条件是：\n$$R(a_1 \\mid x) \\le R(a_0 \\mid x)$$\n代入期望损失的表达式：\n$$1 - P(D=1 \\mid x) \\le 10 \\cdot P(D=1 \\mid x)$$\n现在，我们求解这个关于 $P(D=1 \\mid x)$ 的不等式。\n$$1 \\le 10 \\cdot P(D=1 \\mid x) + P(D=1 \\mid x)$$\n$$1 \\le 11 \\cdot P(D=1 \\mid x)$$\n$$P(D=1 \\mid x) \\ge \\frac{1}{11}$$\n这个推导出的最优决策规则表明，如果一个个体患病的后验概率大于或等于 $\\frac{1}{11}$，我们应该将其标记为“患病”。\n\n问题陈述，该项目的决策策略是如果 $P(D=1 \\mid x) \\ge \\theta$ 则标记为“患病”。最优阈值 $\\theta^*$ 是使该策略成为最优的 $\\theta$ 值。通过将我们推导出的规则 $P(D=1 \\mid x) \\ge \\frac{1}{11}$ 与给定的策略 $P(D=1 \\mid x) \\ge \\theta^*$进行比较，我们可以直接确定最优阈值。\n$$\\theta^* = \\frac{1}{11}$$\n对于这个特定的推导，疾病的患病率 $p=0.1$ 是无关信息，因为优化是针对后验期望损失进行的，而该损失是已经计算出的后验概率 $P(D=1 \\mid x)$ 的函数。",
            "answer": "$$\\boxed{\\frac{1}{11}}$$"
        }
    ]
}