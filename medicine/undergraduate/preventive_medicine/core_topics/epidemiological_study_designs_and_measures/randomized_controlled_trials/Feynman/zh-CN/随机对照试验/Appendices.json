{
    "hands_on_practices": [
        {
            "introduction": "一个稳健的随机对照试验始于坚实的设计，而设计的基石是确定合适的样本量。本练习将指导您从第一性原理出发，推导样本量计算公式。通过这个过程，您将深刻理解统计功效、效应大小和错误率如何与研究所需的参与者数量产生根本性的联系。",
            "id": "4628034",
            "problem": "考虑一项双臂随机对照试验，干预组与对照组等比例分配，在稳定条件下，于一个共同的随访时间点，对每位参与者观测一次二元结局。令 $p_0$ 表示对照组的真实事件概率，$p_1$ 表示干预组的真实事件概率。目标效应为风险差 $\\Delta = p_1 - p_0$，并假设设计的目的是检验零假设 $H_0: p_1 - p_0 = 0$ 相对于双侧备择假设 $H_1: p_1 - p_0 \\neq 0$，要求I类错误率为 $\\,\\alpha\\,$，并达到 $\\,1 - \\beta\\,$ 的检验效能来检测预设的非零风险差 $\\,\\Delta\\,$。\n\n使用以下基本依据：\n- 根据独立抽样，由中心极限定理可知，对于每组 $n$ 名参与者，组 $a \\in \\{0,1\\}$ 中的样本比例 $\\hat{p}_a$ 的大样本分布为 $\\hat{p}_a \\approx \\mathcal{N}\\!\\left(p_a,\\, p_a(1 - p_a)/n\\right)$，并且在等比例分配下，两组是独立的。\n- 根据独立性，样本比例之差 $D = \\hat{p}_1 - \\hat{p}_0$ 近似服从正态分布，其均值为 $p_1 - p_0$，方差为 $p_1(1 - p_1)/n + p_0(1 - p_0)/n$。\n- 对于 $H_0$ 的双侧 $\\alpha$ 水平检验，使用标准正态分位数函数 $\\Phi^{-1}(\\cdot)$ 和一个设计阶段的零方差来设定一个拒绝阈值。令设计阶段的合并计划值为 $p_{\\ast} = (p_0 + p_1)/2$，这给出了 $D$ 的零标准差为 $\\sqrt{2\\,p_{\\ast}(1 - p_{\\ast})/n}$。\n\n从这些基础出发，不使用任何预先记忆的样本量公式，推导所需每组样本量 $n$ 的闭式解析表达式（不需要是整数；忽略任何整数取整），该样本量需确保在等比例分配下，I类错误率为 $\\,\\alpha\\,$，且有 $\\,1 - \\beta\\,$ 的检验效能来检测风险差 $\\Delta$。将你的最终答案表示为一个关于 $p_0$、$p_1$、$\\alpha$、$\\beta$ 和 $\\Delta$ 以及标准正态分位数函数 $\\Phi^{-1}(\\cdot)$ 的单一解析表达式。你可以假设 $\\Delta \\neq 0$。不需要进行数值计算，也不需要取整。答案必须是每组的样本量。",
            "solution": "该问题陈述是生物统计学领域一个有效且适定的问题，具体涉及随机对照试验的设计。它提供了一套完整且一致的给定条件和假设，从中可以推导出唯一的解析解。\n\n### 步骤1：提取给定条件\n-   **研究设计**：双臂随机对照试验，等比例分配（每组 $n$ 名参与者）。\n-   **结局**：二元。\n-   **参数**：$p_0$ 是对照组的真实事件概率；$p_1$ 是干预组的真实事件概率。\n-   **效应度量**：风险差，$\\Delta = p_1 - p_0$。\n-   **假设**：零假设 $H_0: p_1 - p_0 = 0$；备择假设 $H_1: p_1 - p_0 \\neq 0$。\n-   **错误率**：I类错误率为 $\\alpha$；II类错误率为 $\\beta$，对应检验效能为 $1 - \\beta$。\n-   **分布假设**：\n    1.  组 $a \\in \\{0,1\\}$ 中的样本比例，记为 $\\hat{p}_a$，近似服从正态分布：$\\hat{p}_a \\sim \\mathcal{N}(p_a, \\frac{p_a(1-p_a)}{n})$。\n    2.  样本比例之差，$D = \\hat{p}_1 - \\hat{p}_0$，近似服从正态分布：$D \\sim \\mathcal{N}(p_1 - p_0, \\frac{p_1(1-p_1)}{n} + \\frac{p_0(1-p_0)}{n})$。\n-   **检验构建**：\n    1.  检验使用标准正态分位数函数 $\\Phi^{-1}(\\cdot)$。\n    2.  为了设计， $D$ 在零假设下的方差基于一个计划值 $p_{\\ast} = (p_0 + p_1)/2$，从而得出 $D$ 在 $H_0$ 下的标准差为 $\\sqrt{2 p_{\\ast}(1-p_{\\ast})/n}$。\n\n### 步骤2：使用提取的给定条件进行验证\n-   **具有科学依据**：该问题基于成熟的统计理论，即使用正态近似于二项分布来比较两个比例，这是设计临床试验的基本概念。\n-   **适定性**：问题定义清晰，提供了推导所需样本量 $n$ 的所有必要参数（$\\alpha, \\beta, p_0, p_1$）和分布基础。指令明确，可导向唯一解。\n-   **客观性**：语言形式化、精确，没有任何主观性或模糊性。\n\n该问题是有效的，因为它满足了一个形式良好的科学问题的所有标准。\n\n### 样本量公式的推导\n\n目标是推导出满足指定的I类和II类错误约束的每组样本量 $n$ 的表达式。推导从给定的第一性原理出发。\n\n**1. I类错误与拒绝法则**\n\n零假设为 $H_0: \\Delta = p_1 - p_0 = 0$。检验统计量是观测到的比例差，$D = \\hat{p}_1 - \\hat{p}_0$。\n\n根据问题陈述，为了试验设计的目的，$D$ 在 $H_0$ 下的分布被认为是近似正态的，均值为 $0$，方差 $\\text{Var}_0(D)$ 使用计划值 $p_{\\ast} = (p_0 + p_1)/2$ 构建。\n$$ \\text{Var}_0(D) = \\frac{2 p_{\\ast}(1 - p_{\\ast})}{n} = \\frac{2 \\left(\\frac{p_0+p_1}{2}\\right) \\left(1 - \\frac{p_0+p_1}{2}\\right)}{n} $$\n对于一个I类错误率为 $\\alpha$ 的双侧检验，如果观测到的差值 $|D|$ 大于一个临界值 $C$，我们便拒绝 $H_0$。这个临界值由零分布的尾部确定。在 $H_0$ 下的标准化统计量将是 $Z = D / \\sqrt{\\text{Var}_0(D)}$。如果 $|Z| > \\Phi^{-1}(1 - \\alpha/2)$，我们便拒绝。\n这意味着对于未标准化的差值 $D$ 的拒绝域是 $|D| > C$，其中：\n$$ C = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\text{Var}_0(D)} = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\frac{2 p_{\\ast}(1 - p_{\\ast})}{n}} $$\n\n**2. II类错误与检验效能**\n\n检验效能是在备择假设 $H_1$ 为真时正确拒绝 $H_0$ 的概率。在 $H_1$ 下，真实差值为 $\\Delta = p_1 - p_0 \\neq 0$。\n\n在 $H_1$ 下，$D$ 的分布近似为正态分布，均值为 $\\Delta$，方差为 $\\text{Var}_1(D)$：\n$$ D \\sim \\mathcal{N}\\left(\\Delta, \\text{Var}_1(D)\\right) \\quad \\text{其中} \\quad \\text{Var}_1(D) = \\frac{p_1(1-p_1)}{n} + \\frac{p_0(1-p_0)}{n} $$\n检验效能 $1 - \\beta$ 是 $D$ 落入拒绝域的概率，即 $P(|D| > C | H_1)$。\n$$ 1 - \\beta = P(D > C | H_1) + P(D  -C | H_1) $$\n假设 $\\Delta  0$（$\\Delta  0$ 的情况是对称的），对于一个具有足够效能的研究，$P(D  -C | H_1)$ 这一项通常可以忽略不计，因为 $D$ 的分布中心远离 $-C$。因此，我们可以用第一项来近似检验效能：\n$$ 1 - \\beta \\approx P(D  C | H_1) $$\n为了评估这个概率，我们使用 $D$ 在 $H_1$ 下的分布对其进行标准化：\n$$ 1 - \\beta \\approx P\\left( \\frac{D - \\Delta}{\\sqrt{\\text{Var}_1(D)}}  \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} \\right) $$\n概率内部左边的项是一个标准正态变量，$Z \\sim \\mathcal{N}(0,1)$。\n$$ P\\left( Z  \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} \\right) = 1 - \\beta $$\n根据标准正态累积分布函数 $\\Phi$ 的定义，这意味着：\n$$ \\frac{C - \\Delta}{\\sqrt{\\text{Var}_1(D)}} = \\Phi^{-1}(1 - (1-\\beta)) = \\Phi^{-1}(\\beta) $$\n解出临界值 $C$，我们得到了它的第二个表达式，这一次是根据检验效能要求得出的：\n$$ C = \\Delta + \\Phi^{-1}(\\beta) \\sqrt{\\text{Var}_1(D)} $$\n\n**3. 求解样本量 n**\n\n现在我们有两个关于临界值 $C$ 的表达式，一个来自I类错误约束，另一个来自检验效能约束。通过将它们相等，我们可以解出 $n$。\n$$ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{\\text{Var}_0(D)} = \\Delta + \\Phi^{-1}(\\beta) \\sqrt{\\text{Var}_1(D)} $$\n代入方差的表达式，两者都依赖于 $1/\\sqrt{n}$：\n$$ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\frac{\\sqrt{2 p_{\\ast}(1 - p_{\\ast})}}{\\sqrt{n}} = \\Delta + \\Phi^{-1}(\\beta) \\frac{\\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\sqrt{n}} $$\n重新整理方程以分离出 $\\Delta$：\n$$ \\Delta = \\frac{1}{\\sqrt{n}} \\left[ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} - \\Phi^{-1}(\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)} \\right] $$\n利用标准正态分位数函数的对称性，$\\Phi^{-1}(\\beta) = -\\Phi^{-1}(1-\\beta)$：\n$$ \\Delta = \\frac{1}{\\sqrt{n}} \\left[ \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)} \\right] $$\n现在，我们解出 $\\sqrt{n}$，然后将结果平方得到 $n$：\n$$ \\sqrt{n} = \\frac{\\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\Delta} $$\n$$ n = \\left( \\frac{\\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 p_{\\ast}(1 - p_{\\ast})} + \\Phi^{-1}(1-\\beta) \\sqrt{p_1(1-p_1) + p_0(1-p_0)}}{\\Delta} \\right)^2 $$\n代入 $p_{\\ast} = (p_0+p_1)/2$ 的定义，并将表达式写成单个分数形式，就得到了每组样本量 $n$ 的最终闭式表达式。\n$$ n = \\frac{\\left( \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\sqrt{2 \\left(\\frac{p_0+p_1}{2}\\right)\\left(1 - \\frac{p_0+p_1}{2}\\right)} + \\Phi^{-1}(1-\\beta) \\sqrt{p_0(1-p_0) + p_1(1-p_1)} \\right)^2}{\\Delta^2} $$\n该表达式以指定的参数 $p_0$、$p_1$、$\\alpha$、$\\beta$ 以及风险差 $\\Delta = p_1-p_0$ 的函数形式，给出了每组所需的样本量。",
            "answer": "$$ \\boxed{ \\frac{\\left( \\Phi^{-1}\\left(1-\\frac{\\alpha}{2}\\right) \\sqrt{2 \\left(\\frac{p_0+p_1}{2}\\right) \\left(1 - \\frac{p_0+p_1}{2}\\right)} + \\Phi^{-1}(1-\\beta) \\sqrt{p_0(1-p_0) + p_1(1-p_1)} \\right)^{2}}{\\Delta^{2}} } $$"
        },
        {
            "introduction": "随机化是确保研究组间可比性的有力工具，但它并不能保证完美的平衡，尤其是在较小的试验中。本练习将探讨如何使用标准化均数差来量化基线不平衡，更重要的是，如何计算这些偶然的不平衡可能给最终结果带来的偏倚。这阐明了为什么即使在随机对照试验中，对基线协变量的仔细评估和潜在校正仍然至关重要。",
            "id": "4568090",
            "problem": "一项预防医学领域的双臂随机对照试验 (RCT) 旨在评估一个基于智能手机的生活方式指导项目对患有糖尿病前期的成年人降低空腹血糖 (FPG) 的效果。参与者被随机分配到治疗组 ($Z=1$) 或对照组 ($Z=0$)。主要结局是 $6$ 个月时的空腹血糖 (单位为 $\\mathrm{mg/dL}$)。两个基线协变量是年龄 (单位为岁，记作 $A$) 和基线空腹血糖 (记作 $G_0$，单位为 $\\mathrm{mg/dL}$)。\n\n在基线时，观察到以下汇总数据：\n- 治疗组样本量 $n_T = 160$，对照组样本量 $n_C = 140$。\n- 年龄：治疗组均值 $\\bar{A}_T = 54.2$，治疗组标准差 $s_{A,T} = 9.1$；对照组均值 $\\bar{A}_C = 51.0$，对照组标准差 $s_{A,C} = 8.7$。\n- 基线空腹血糖：治疗组均值 $\\bar{G}_{0,T} = 110.0$，治疗组标准差 $s_{G,T} = 12.0$；对照组均值 $\\bar{G}_{0,C} = 106.0$，对照组标准差 $s_{G,C} = 11.5$。\n\n该研究预先设定的平衡标准是，两个协变量的最大绝对标准化均数差 (SMD) 必须小于 $0.10$，才能放弃采取补救措施。如果未达到该标准，研究将根据发现时间，或进行重新随机化 (如果在入组前发现)，或在主要分析中计划进行协变量调整 (如果在随机化后发现)。\n\n假设 $6$ 个月空腹血糖 $Y$ 的结构结局模型是线性的：\n$$\nY = \\alpha + \\tau Z + \\beta_G G_0 + \\beta_A A + \\varepsilon,\n$$\n其中 $\\varepsilon$ 的均值为 $0$，且独立于 $Z$ 和基线协变量。真实治疗效应为 $\\tau = -4.0$ (单位为 $\\mathrm{mg/dL}$)，协变量效应为 $\\beta_G = 0.50$ (单位为 $\\mathrm{mg/dL}$ 每 $\\mathrm{mg/dL}$) 和 $\\beta_A = 0.020$ (单位为 $\\mathrm{mg/dL}$ 每岁)。\n\n任务：\n1. 使用观察到的基线汇总数据，通过计算每个协变量 (年龄和基线空腹血糖) 的标准化均数差来评估基线不平衡。\n2. 判断是否满足平衡标准，并确定原则上应采用哪种补救策略 (重新随机化或协变量调整)。\n3. 在上述线性模型下，并考虑到观察到的基线不平衡，计算治疗组和对照组之间未经调整的平均结局差异的期望值 (即不针对 $A$ 或 $G_0$ 进行调整的朴素估计量)。\n\n仅报告任务 $3$ 的数值结果作为最终答案。最终答案以 $\\mathrm{mg/dL}$ 为单位表示，并四舍五入至四位有效数字。",
            "solution": "该问题被评估为有效的，因为它以随机对照试验和生物统计学的原理为科学依据，定义明确且信息充分，可得出唯一解，并且表述客观。\n\n该问题需要进行三部分分析。最终答案将是第三部分的结果。\n\n**任务 1：通过计算标准化均数差 (SMD) 来评估基线不平衡。**\n\n对于一个给定的协变量，标准化均数差的计算方法是治疗组和对照组之间的均值差除以合并标准差。合并标准差 $s_p$ 的公式为：\n$$ s_p = \\sqrt{\\frac{(n_T - 1)s_T^2 + (n_C - 1)s_C^2}{n_T + n_C - 2}} $$\n其中 $n_T$ 和 $n_C$ 分别是治疗组和对照组的样本量，$s_T$ 和 $s_C$ 分别是治疗组和对照组的标准差。\n\n对于协变量年龄 ($A$)：\n给定数据为：\n- 治疗组：$n_T = 160$, $\\bar{A}_T = 54.2$, $s_{A,T} = 9.1$。\n- 对照组：$n_C = 140$, $\\bar{A}_C = 51.0$, $s_{A,C} = 8.7$。\n\n首先，我们计算年龄的合并标准差 $s_{p,A}$：\n$$ s_{p,A} = \\sqrt{\\frac{(160 - 1)(9.1)^2 + (140 - 1)(8.7)^2}{160 + 140 - 2}} $$\n$$ s_{p,A} = \\sqrt{\\frac{159 \\times 82.81 + 139 \\times 75.69}{298}} $$\n$$ s_{p,A} = \\sqrt{\\frac{13166.79 + 10520.91}{298}} = \\sqrt{\\frac{23687.7}{298}} \\approx 8.91565 $$\n现在，我们计算年龄的 SMD：\n$$ \\text{SMD}_A = \\frac{\\bar{A}_T - \\bar{A}_C}{s_{p,A}} = \\frac{54.2 - 51.0}{8.91565} = \\frac{3.2}{8.91565} \\approx 0.35891 $$\n\n对于协变量基线空腹血糖 ($G_0$)：\n给定数据为：\n- 治疗组：$n_T = 160$, $\\bar{G}_{0,T} = 110.0$, $s_{G,T} = 12.0$。\n- 对照组：$n_C = 140$, $\\bar{G}_{0,C} = 106.0$, $s_{G,C} = 11.5$。\n\n我们计算基线空腹血糖的合并标准差 $s_{p,G}$：\n$$ s_{p,G} = \\sqrt{\\frac{(160 - 1)(12.0)^2 + (140 - 1)(11.5)^2}{160 + 140 - 2}} $$\n$$ s_{p,G} = \\sqrt{\\frac{159 \\times 144 + 139 \\times 132.25}{298}} $$\n$$ s_{p,G} = \\sqrt{\\frac{22896 + 18382.75}{298}} = \\sqrt{\\frac{41278.75}{298}} \\approx 11.76943 $$\n现在，我们计算基线空腹血糖的 SMD：\n$$ \\text{SMD}_G = \\frac{\\bar{G}_{0,T} - \\bar{G}_{0,C}}{s_{p,G}} = \\frac{110.0 - 106.0}{11.76943} = \\frac{4.0}{11.76943} \\approx 0.33986 $$\n\n**任务 2：判断是否满足平衡标准以及确定适当的补救策略。**\n\n计算出的绝对 SMD 分别为 $|\\text{SMD}_A| \\approx 0.359$ 和 $|\\text{SMD}_G| \\approx 0.340$。最大绝对 SMD 约为 $0.359$。预先设定的平衡标准要求该值小于 $0.10$。由于 $0.359  0.10$，因此未满足平衡标准。\n\n问题指出需要采取补救措施。因为不平衡是从观察到的基线汇总数据中检测出来的，这意味着试验处于“随机化后”阶段。因此，适当的补救策略是在主要分析中计划进行协变量调整，而不是重新随机化。\n\n**任务 3：计算未经调整的平均结局差异的期望值。**\n\n我们需要计算治疗组和对照组之间未经调整的平均结局差异的期望值，即 $E[\\bar{Y}_T - \\bar{Y}_C]$。$6$ 个月空腹血糖 $Y$ 的结构模型由下式给出：\n$$ Y_i = \\alpha + \\tau Z_i + \\beta_G G_{0,i} + \\beta_A A_i + \\varepsilon_i $$\n其中 $E[\\varepsilon_i] = 0$。此处的期望值是基于特定样本中观察到的协变量和治疗分配的条件期望。\n\n治疗组 ($Z_i=1$) 的预期平均结局是：\n$$ E[\\bar{Y}_T] = E\\left[ \\frac{1}{n_T} \\sum_{i \\in \\text{Treatment}} Y_i \\right] = \\frac{1}{n_T} \\sum_{i \\in \\text{Treatment}} E[Y_i] $$\n$$ E[\\bar{Y}_T] = \\frac{1}{n_T} \\sum_{i \\in \\text{Treatment}} (\\alpha + \\tau(1) + \\beta_G G_{0,i} + \\beta_A A_i) $$\n利用求和的线性性质和样本均值的定义：\n$$ E[\\bar{Y}_T] = \\alpha + \\tau + \\beta_G \\bar{G}_{0,T} + \\beta_A \\bar{A}_T $$\n\n类似地，对照组 ($Z_j=0$) 的预期平均结局是：\n$$ E[\\bar{Y}_C] = E\\left[ \\frac{1}{n_C} \\sum_{j \\in \\text{Control}} Y_j \\right] = \\frac{1}{n_C} \\sum_{j \\in \\text{Control}} E[Y_j] $$\n$$ E[\\bar{Y}_C] = \\frac{1}{n_C} \\sum_{j \\in \\text{Control}} (\\alpha + \\tau(0) + \\beta_G G_{0,j} + \\beta_A A_j) $$\n$$ E[\\bar{Y}_C] = \\alpha + \\beta_G \\bar{G}_{0,C} + \\beta_A \\bar{A}_C $$\n\n未经调整的平均结局差异的期望值是这两个期望值之差：\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = (\\alpha + \\tau + \\beta_G \\bar{G}_{0,T} + \\beta_A \\bar{A}_T) - (\\alpha + \\beta_G \\bar{G}_{0,C} + \\beta_A \\bar{A}_C) $$\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = \\tau + \\beta_G (\\bar{G}_{0,T} - \\bar{G}_{0,C}) + \\beta_A (\\bar{A}_T - \\bar{A}_C) $$\n该表达式表示真实治疗效应 $\\tau$ 加上由观察到的协变量不平衡所引入的偏倚。\n\n我们代入给定的值：\n- 真实治疗效应：$\\tau = -4.0$。\n- 协变量效应：$\\beta_G = 0.50$, $\\beta_A = 0.020$。\n- 观察到的均值差异：$\\bar{G}_{0,T} - \\bar{G}_{0,C} = 110.0 - 106.0 = 4.0$。\n- 观察到的均值差异：$\\bar{A}_T - \\bar{A}_C = 54.2 - 51.0 = 3.2$。\n\n将这些值代入方程：\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = -4.0 + (0.50)(4.0) + (0.020)(3.2) $$\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = -4.0 + 2.0 + 0.064 $$\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = -2.0 + 0.064 $$\n$$ E[\\bar{Y}_T - \\bar{Y}_C] = -1.936 $$\n未经调整的平均结局差异的期望值为 $-1.936$ $\\mathrm{mg/dL}$。该值按要求保留了四位有效数字。",
            "answer": "$$\\boxed{-1.936}$$"
        },
        {
            "introduction": "收集数据后，下一步是使用适当的指标来总结治疗效果。本练习涉及从试验数据中计算风险差、风险比和比值比，并深入探讨“可折叠性” (collapsibility) 这一关键概念。理解哪些效应度量是可折叠的，有助于解释为什么粗略和调整后的效应估计值可能不同，这对于准确解释和交流试验结果至关重要。",
            "id": "4628160",
            "problem": "一项随机对照试验 (RCT) 评估了一项旨在减少二元结局的预防性干预措施。在随机分配到干预组的 $1000$ 名参与者中，$100$ 人出现了该结局。在随机分配到对照组的 $1000$ 名参与者中，$150$ 人出现了该结局。从流行病学的基本原理出发，使用由随机化导出的概率、比值和独立性的核心定义，从观测数据中推导并计算以下人群效应指标：风险差、风险比和比值比。然后，根据可合并性的定义（在随机化和无效应修饰的情况下，边际效应等于共同的层特异性效应），确定在这三个指标中，哪些在随机分配且无未测量混杂因素的背景下是可合并的。将最终答案表示为行矩阵，顺序为 $[\\text{风险差}, \\text{风险比}, \\text{比值比}, I_{\\text{RD}}, I_{\\text{RR}}, I_{\\text{OR}}]$，其中 $I_{\\text{RD}}$、$I_{\\text{RR}}$ 和 $I_{\\text{OR}}$ 是指示变量，如果指标是可合并的，则取值为 $1$，否则为 $0$。如果可能，请以精确分数形式提供风险差、风险比和比值比；如果选择提供小数近似值，请四舍五入到 $4$ 位有效数字。不涉及物理单位；所有量均报告为无量纲数。",
            "solution": "该问题是有效的，因为它在科学上基于流行病学和生物统计学的原理，提法明确，信息充分且一致，并且陈述客观。\n\n设 $X$ 表示治疗分配，其中 $X=1$ 代表干预组，$X=0$ 代表对照组。设 $Y$ 表示二元结局，其中 $Y=1$ 表示结局发生，$Y=0$ 表示结局未发生。该问题提供了一项随机对照试验（RCT）的以下数据：\n对于干预组 ($X=1$):\n- 参与者人数: $N_1 = 1000$\n- 出现结局的人数: $A_1 = 100$\n- 未出现结局的人数: $B_1 = N_1 - A_1 = 1000 - 100 = 900$\n\n对于对照组 ($X=0$):\n- 参与者人数: $N_0 = 1000$\n- 出现结局的人数: $A_0 = 150$\n- 未出现结局的人数: $B_0 = N_0 - A_0 = 1000 - 150 = 850$\n\n任务是推导和计算三个效应指标（风险差、风险比、比值比）并确定它们的可合并性属性。\n\n首先，我们定义各组中结局的风险（概率）。风险是在给定治疗分配下结局发生的条件概率，即 $P(Y=1|X=x)$。在随机对照试验中，这些概率可以直接从各组的观测比例中估计出来。\n\n干预组的风险估计为：\n$$ \\hat{R}_1 = \\frac{A_1}{N_1} = \\frac{100}{1000} = \\frac{1}{10} $$\n对照组的风险估计为：\n$$ \\hat{R}_0 = \\frac{A_0}{N_0} = \\frac{150}{1000} = \\frac{15}{100} = \\frac{3}{20} $$\n\n**第一部分：效应指标的计算**\n\n1.  **风险差 (RD)**：风险差是两组风险的算术差。\n    $$ RD = R_1 - R_0 $$\n    使用样本估计值：\n    $$ \\hat{RD} = \\hat{R}_1 - \\hat{R}_0 = \\frac{1}{10} - \\frac{3}{20} = \\frac{2}{20} - \\frac{3}{20} = -\\frac{1}{20} $$\n\n2.  **风险比 (RR)**：风险比是两组风险的比值。\n    $$ RR = \\frac{R_1}{R_0} $$\n    使用样本估计值：\n    $$ \\hat{RR} = \\frac{\\hat{R}_1}{\\hat{R}_0} = \\frac{1/10}{3/20} = \\frac{1}{10} \\times \\frac{20}{3} = \\frac{20}{30} = \\frac{2}{3} $$\n\n3.  **比值比 (OR)**：首先，我们将结局的比值定义为结局发生的概率与不发生的概率之比。\n    $$ \\text{Odds}(x) = \\frac{P(Y=1|X=x)}{P(Y=0|X=x)} = \\frac{R_x}{1-R_x} $$\n    比值比是干预组的比值与对照组的比值之比。\n    $$ OR = \\frac{\\text{Odds}(1)}{\\text{Odds}(0)} = \\frac{R_1 / (1-R_1)}{R_0 / (1-R_0)} $$\n    样本比值为：\n    $$ \\hat{\\text{Odds}}_1 = \\frac{\\hat{R}_1}{1-\\hat{R}_1} = \\frac{1/10}{1 - 1/10} = \\frac{1/10}{9/10} = \\frac{1}{9} $$\n    $$ \\hat{\\text{Odds}}_0 = \\frac{\\hat{R}_0}{1-\\hat{R}_0} = \\frac{3/20}{1 - 3/20} = \\frac{3/20}{17/20} = \\frac{3}{17} $$\n    样本比值比为：\n    $$ \\hat{OR} = \\frac{\\hat{\\text{Odds}}_1}{\\hat{\\text{Odds}}_0} = \\frac{1/9}{3/17} = \\frac{1}{9} \\times \\frac{17}{3} = \\frac{17}{27} $$\n    另外，比值比也可以通过 $2 \\times 2$ 列联表的交叉乘积比来计算：\n    $$ \\hat{OR} = \\frac{A_1 B_0}{A_0 B_1} = \\frac{100 \\times 850}{150 \\times 900} = \\frac{85000}{135000} = \\frac{85}{135} = \\frac{17}{27} $$\n\n**第二部分：可合并性分析**\n\n可合并性指的是，在各层之间没有效应修饰的情况下，边际（粗略）效应指标等于共同的层特异性效应指标的性质。分层是根据第三个变量（例如 $Z$）进行的。问题指明了“随机分配且无未测量混杂因素”以及“无效应修饰”的背景。\n\n设 $Z$ 是一个基线协变量（例如，年龄、性别），其水平为 $k=1, 2, \\dots, K$。\n$x$ 组的边际风险是 $R_x = P(Y=1|X=x)$。根据全概率公式，我们可以在 $Z$ 的各层上展开这个式子：\n$$ R_x = \\sum_{k=1}^{K} P(Y=1|X=x, Z=k) P(Z=k|X=x) $$\n设 $R_{xk} = P(Y=1|X=x, Z=k)$ 为层特异性风险。\n在随机对照试验中，随机化确保了治疗分配 $X$ 与任何基线协变量 $Z$ 统计上独立。因此，对于所有的 $x$，都有 $P(Z=k|X=x) = P(Z=k)$。令 $p_k = P(Z=k)$。\n于是，边际风险是层特异性风险的加权平均值：\n$$ R_1 = \\sum_{k} R_{1k} p_k $$\n$$ R_0 = \\sum_{k} R_{0k} p_k $$\n“无效应修饰”的条件意味着效应指标在 $Z$ 的各层中是恒定的。\n\n- **风险差 (RD)**：\n  边际 RD 是 $RD = R_1 - R_0$。层特异性 RD 是 $RD_k = R_{1k} - R_{0k}$。\n  “无效应修饰”条件意味着对所有 $k$ 都有 $RD_k = RD_{\\text{common}}$。\n  $$ RD = R_1 - R_0 = \\sum_{k} R_{1k} p_k - \\sum_{k} R_{0k} p_k = \\sum_{k} (R_{1k} - R_{0k}) p_k = \\sum_{k} RD_k p_k $$\n  代入 $RD_k = RD_{\\text{common}}$：\n  $$ RD = \\sum_{k} RD_{\\text{common}} p_k = RD_{\\text{common}} \\sum_{k} p_k = RD_{\\text{common}} \\times 1 = RD_{\\text{common}} $$\n  边际 RD 等于共同的层特异性 RD。因此，风险差是可合并的。$I_{\\text{RD}} = 1$。\n\n- **风险比 (RR)**：\n  边际 RR 是 $RR = R_1 / R_0$。层特异性 RR 是 $RR_k = R_{1k} / R_{0k}$。\n  “无效应修饰”条件意味着对所有 $k$ 都有 $RR_k = RR_{\\text{common}}$，所以 $R_{1k} = RR_{\\text{common}} \\times R_{0k}$。\n  $$ RR = \\frac{R_1}{R_0} = \\frac{\\sum_{k} R_{1k} p_k}{\\sum_{k} R_{0k} p_k} $$\n  代入 $R_{1k} = RR_{\\text{common}} R_{0k}$：\n  $$ RR = \\frac{\\sum_{k} (RR_{\\text{common}} R_{0k}) p_k}{\\sum_{k} R_{0k} p_k} = \\frac{RR_{\\text{common}} \\sum_{k} R_{0k} p_k}{\\sum_{k} R_{0k} p_k} = RR_{\\text{common}} $$\n  边际 RR 等于共同的层特异性 RR。因此，风险比是可合并的。$I_{\\text{RR}} = 1$。\n\n- **比值比 (OR)**：\n  边际 OR 是 $OR = \\frac{R_1/(1-R_1)}{R_0/(1-R_0)}$。层特异性 OR 是 $OR_k = \\frac{R_{1k}/(1-R_{1k})}{R_{0k}/(1-R_{0k})}$。\n  “无效应修饰”条件意味着对所有 $k$ 都有 $OR_k = OR_{\\text{common}}$。\n  比值函数 $f(p) = p/(1-p)$，在 $p \\in (0, 0.5)$ 上是一个非线性凸函数，在 $p \\in (0.5, 1)$ 上是凹函数。由于这种非线性，风险的加权平均值不能简单地转换为比值的形式。边际比值为：\n  $$ \\text{Odds}_1 = \\frac{\\sum_k R_{1k}p_k}{1 - \\sum_k R_{1k}p_k} \\quad \\text{和} \\quad \\text{Odds}_0 = \\frac{\\sum_k R_{0k}p_k}{1 - \\sum_k R_{0k}p_k} $$\n  根据琴生不等式，对于一个非线性函数 $f$，$f(E[X]) \\neq E[f(X)]$。在这里，边际风险 $R_x$ 是层特异性风险 $R_{xk}$ 在 $Z$ 分布上的期望。因此，边际比值 $\\text{Odds}_x = f(R_x) = f(E[R_{xk}])$ 不等于层特异性比值的加权平均值 $E[f(R_{xk})] = \\sum_k f(R_{xk}) p_k$。\n  因此，边际比值比 $OR = \\text{Odds}_1 / \\text{Odds}_0$ 通常不等于共同的层特异性比值比 $OR_{\\text{common}}$，除非 $Z$ 不是结局的风险因素（即 $R_{0k}$ 对所有 $k$ 都是常数）或者治疗没有效果（$OR_{\\text{common}}=1$）。由于这些例外情况通常不成立，所以比值比是不可合并的。$I_{\\text{OR}} = 0$。\n\n综合结果，最终值为：\n- 风险差：$-\\frac{1}{20}$\n- 风险比：$\\frac{2}{3}$\n- 比值比：$\\frac{17}{27}$\n- $I_{\\text{RD}} = 1$ (可合并)\n- $I_{\\text{RR}} = 1$ (可合并)\n- $I_{\\text{OR}} = 0$ (不可合并)\n\n最终答案将以行矩阵形式呈现。\n$$\n\\begin{pmatrix}\n-\\frac{1}{20}  \\frac{2}{3}  \\frac{17}{27}  1  1  0\n\\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{20}  \\frac{2}{3}  \\frac{17}{27}  1  1  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}