{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在巩固对胸骨基本形态学的理解。通过计算胸骨体在特定总长度下的期望长度，学生可以深入理解胸骨各组成部分——胸骨柄、胸骨体和剑突——之间的比例关系。这项技能对于通过体表标志（如胸骨角）定位内部器官以及解读胸部影像学检查至关重要 。",
            "id": "5153266",
            "problem": "一位解剖学专业的高年级本科生正在分析成年人的胸骨，以预测一个与胸部表面解剖学相关的中线测量值。胸骨通常被分为胸骨柄、胸骨体（corpus sterni）和剑突三个部分。胸骨角（胸骨柄胸骨体结合处）位于胸骨柄和胸骨体之间，而剑胸结合处位于胸骨体和剑突之间。在普通成年人中，胸骨总长度是这三部分长度的总和，而广泛报道的形态计量学平均值表明，胸骨体通常占总长度的大部分。\n\n已知一位成年人沿前中线测量的胸骨总长度为 $175$ mm，并使用成年人各部分的典型比例长度：胸骨柄为 $0.23$，胸骨体为 $0.66$，剑突为 $0.11$（这些比例合起来近似于观察到的人群平均分布），请计算胸骨角和剑胸结合处之间沿前中线的预期线性距离。将您的答案四舍五入到三位有效数字，并以 mm 为单位表示最终结果。\n\n仅使用核心的解剖学定义和胸骨总长度等于各部分长度之和这一基本事实；为进行此估算，假设测量线上的曲率可忽略不计，并忽略与年龄相关的骨化变异。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 胸骨总长度：$175$ mm。\n- 胸骨柄的比例长度：$0.23$。\n- 胸骨体（corpus sterni）的比例长度：$0.66$。\n- 剑突的比例长度：$0.11$。\n- 解剖学定义：胸骨角是胸骨柄胸骨体结合处（位于胸骨柄和胸骨体之间）。剑胸结合处位于胸骨体和剑突之间。\n- 假设：胸骨总长度是三部分长度的总和。\n- 假设：测量线上的曲率可忽略不计。\n- 任务：计算胸骨角和剑胸结合处之间的线性距离。\n- 格式要求：将答案四舍五入到三位有效数字，并以 mm 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题的有效性。\n1.  **科学依据**：该问题基于人体大体解剖学和形态计量学的既定原则。胸骨的划分（胸骨柄、胸骨体、剑突）以及胸骨角和剑胸结合处的位置是标准的解剖学事实。给定的比例（$0.23$、$0.66$、$0.11$）与已发表的成年人平均值一致，并且总和为 $1.00$（$0.23 + 0.66 + 0.11 = 1.00$），代表一个完整的系统。该问题在科学上是合理的。\n2.  **适定性**：问题定义清晰，并提供了得出唯一解所需的所有数据。问题要求计算两个特定解剖标志点之间的距离，这由单个胸骨部分的长度明确定义。\n3.  **客观性**：问题使用了精确、客观的解剖学术语和定量数据。它没有主观或模糊的语言。\n4.  **无缺陷**：问题陈述没有违反任何基本原则，不完整或不矛盾，不包含不切实际的数据，并且结构良好。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将推导出解答。\n\n问题要求计算在给定胸骨总长度的情况下，成年人胸骨角和剑胸结合处之间沿前中线的线性距离。\n\n设 $L_{total}$ 为胸骨总长度。设 $L_{man}$、$L_{body}$ 和 $L_{xiph}$ 分别为胸骨柄、胸骨体（corpus sterni）和剑突的长度。相应的比例长度由 $P_{man}$、$P_{body}$ 和 $P_{xiph}$ 给出。\n\n给定的值为：\n- $L_{total} = 175$ mm\n- $P_{man} = 0.23$\n- $P_{body} = 0.66$\n- $P_{xiph} = 0.11$\n\n根据所提供的定义：\n1.  胸骨角（胸骨柄胸骨体结合处）是胸骨柄和胸骨体之间的关节连接点。\n2.  剑胸结合处是胸骨体和剑突之间的关节连接点。\n\n因此，根据定义，胸骨角和剑胸结合处之间的中线线性距离就是胸骨体的长度，$L_{body}$。\n\n问题陈述指出，每个部分的长度是总长度的特定比例。胸骨体的长度计算如下：\n$$L_{body} = P_{body} \\times L_{total}$$\n\n将给定值代入此方程：\n$$L_{body} = 0.66 \\times 175 \\text{ mm}$$\n\n进行乘法运算：\n$$L_{body} = 115.5 \\text{ mm}$$\n\n问题要求最终答案四舍五入到三位有效数字。计算出的值为 $115.5$。前三位有效数字是 $1$、$1$ 和 $5$。第四位数字是 $5$。根据标准四舍五入规则（当数字为 $5$ 或更大时向上取整），该值向上取整。\n$$115.5 \\approx 116$$\n\n因此，胸骨角和剑胸结合处之间的预期线性距离为 $116$ mm。",
            "answer": "$$\\boxed{116}$$"
        },
        {
            "introduction": "胸廓并非一个静止的骨骼结构，而是呼吸运动的动态核心。本练习将带领我们从静态解剖学转向功能生物力学，通过量化分析上部肋骨的“泵柄式”运动 。通过一个简化的运动学模型，我们可以计算出肋骨微小的旋转如何转化为胸廓前后径的显著增加，从而加深对呼吸机制的理解。",
            "id": "5153224",
            "problem": "一名学习系统解剖学的高年级本科生正在模拟上位肋骨的泵柄运动及其对胸骨角水平胸廓前后径的影响。使用以下基于解剖学的假设和参数来计算前后径的变化。从刚体旋转和小角度运动学的基本原理出发，不要使用预先推导的捷径。\n\n假设一个成年人胸廓处于功能残气量状态，第 $2$ 到第 $5$ 肋骨围绕其各自靠近肋椎复合体的瞬时轴对称地进行泵柄式旋转，旋转角度为 $3^\\circ$。对于每根肋骨 $n \\in \\{2,3,4,5\\}$，设从瞬时旋转轴到胸骨端的有效半径为 $r_n$，近似为 $r_n = (1 - f_n) L_n$，其中 $L_n$ 是从椎骨旋转轴到胸骨端的肋骨长度（沿运动弦测量），$f_n$ 是从椎骨端沿肋骨测量确定该轴位置的分数。设每根肋骨胸骨端的局部运动方向大致位于矢状面内，并与纯粹的前后轴向上方倾斜一个角度 $\\beta_n$（反映了观察到的泵柄运动轨迹）；因此，第 $n$ 根肋骨运动的前后分量是其在前后轴上的投影。\n\n将沿运动圆切线的小角度位移大小视为旋转角度（以弧度为单位）与半径 $r_n$ 的乘积。假设第二至第五肋软骨的顺应性相等，并将胸骨视为一阶近似下无旋转地向前平移，使得胸骨角处的前向平移等于第 $2$ 至第 $5$ 肋骨胸骨端前后位移的算术平均值。\n\n使用以下参数值：\n- 第2肋：$L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$。\n- 第3肋：$L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$。\n- 第4肋：$L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$。\n- 第5肋：$L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$。\n\n旋转角度为 $\\theta = 3^\\circ$。\n\n计算由该旋转引起的胸骨角水平前后径的变化（以毫米为单位）。将您的答案四舍五入到三位有效数字。最终结果以毫米表示。角度以度为单位给出；如果计算需要，请转换为弧度。",
            "solution": "在进行求解之前，对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 考虑的肋骨：$n \\in \\{2, 3, 4, 5\\}$。\n- 每根肋骨的旋转角度：$\\theta = 3^\\circ$。\n- 旋转是围绕靠近肋椎复合体的瞬时轴进行的。\n- 第 $n$ 根肋骨的有效旋转半径：$r_n = (1 - f_n) L_n$。\n- $L_n$：第 $n$ 根肋骨从椎骨旋转轴到胸骨端的长度。\n- $f_n$：从椎骨端沿肋骨测量，瞬时轴位置的分数距离。\n- 胸骨端运动方向：与前后（AP）轴向上方倾斜一个角度 $\\beta_n$。\n- AP 位移分量：总位移在 AP 轴上的投影。\n- 小角度近似：位移大小 $d_n \\approx r_n \\theta_{rad}$，其中 $\\theta_{rad}$ 是以弧度为单位的角度。\n- 胸骨角处 AP 直径的总变化：等于第 $2$ 到第 $5$ 肋骨胸骨端 AP 位移的算术平均值。\n- 第2肋的参数：$L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$。\n- 第3肋的参数：$L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$。\n- 第4肋的参数：$L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$。\n- 第5肋的参数：$L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$。\n- 要求输出：AP 直径的变化，以毫米为单位，四舍五入到三位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n问题被评估为有效。它具有科学依据，采用了一个简化但物理上和解剖学上合理的胸廓生物力学模型（泵柄运动、刚体旋转、小角度运动学）。所有参数都已提供，术语精确，关系在数学上定义明确。问题是自包含、一致且适定的，允许一个唯一且有意义的解。不存在违反科学原理、逻辑不一致或会使其无效的模糊之处。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n**解题推导**\n\n目标是计算胸廓在胸骨角水平的前后（AP）直径的变化，记为 $\\Delta D_{AP}$。问题指出，这个变化是第 $2$ 到第 $5$ 肋骨胸骨端 AP 位移的算术平均值。设 $\\Delta x_n$ 为第 $n$ 根肋骨的 AP 位移。则总变化为：\n$$ \\Delta D_{AP} = \\frac{1}{4} \\sum_{n=2}^{5} \\Delta x_n $$\n\n我们必须首先确定每根肋骨 $n$ 的 AP 位移 $\\Delta x_n$。每根肋骨胸骨端的运动被描述为围绕一个瞬时旋转轴旋转一个小角度 $\\theta$。\n\n旋转角度以度为单位给出，$\\theta = 3^\\circ$。在运动学计算中，必须将此角度转换为弧度：\n$$ \\theta_{rad} = \\theta \\cdot \\frac{\\pi}{180} = 3 \\cdot \\frac{\\pi}{180} = \\frac{\\pi}{60} \\text{ rad} $$\n\n对于每根肋骨 $n$，有效旋转半径 $r_n$ 是从瞬时轴到胸骨端的距离。问题将其定义为 $r_n = (1 - f_n) L_n$，其中 $L_n$ 是从椎骨轴到胸骨端的长度，而 $f_n$ 是从椎骨侧沿此长度的瞬时轴位置的分数。\n\n使用小角度近似，第 $n$ 根肋骨胸骨端沿其运动弧线切线的位移大小 $d_n$ 由下式给出：\n$$ d_n = r_n \\theta_{rad} $$\n代入 $r_n$ 的表达式：\n$$ d_n = (1 - f_n) L_n \\theta_{rad} $$\n\n这个位移 $d_n$ 并非纯粹在 AP 方向上。它相对于 AP 轴向上倾斜一个角度 $\\beta_n$。AP 分量 $\\Delta x_n$ 是通过将位移矢量投影到 AP 轴上得到的。假设 AP 轴是参考方向，则投影位移为：\n$$ \\Delta x_n = d_n \\cos(\\beta_n) $$\n\n代入 $d_n$ 的表达式：\n$$ \\Delta x_n = (1 - f_n) L_n \\theta_{rad} \\cos(\\beta_n) $$\n\n现在，我们可以通过将 $\\Delta x_n$ 的这个表达式代入平均公式来表示 AP 直径的总变化 $\\Delta D_{AP}$。常数项 $\\frac{1}{4}$ 和 $\\theta_{rad}$ 可以从求和中提出来：\n$$ \\Delta D_{AP} = \\frac{1}{4} \\sum_{n=2}^{5} \\left[ (1 - f_n) L_n \\theta_{rad} \\cos(\\beta_n) \\right] = \\frac{\\theta_{rad}}{4} \\sum_{n=2}^{5} (1 - f_n) L_n \\cos(\\beta_n) $$\n\n我们现在将每根肋骨给定的数值代入求和项。设 $T_n = (1 - f_n) L_n \\cos(\\beta_n)$。\n\n对于第 n=2 肋：\n$L_2 = 180$ mm, $f_2 = 0.35$, $\\beta_2 = 15^\\circ$\n$T_2 = (1 - 0.35) \\cdot 180 \\cdot \\cos(15^\\circ) = 0.65 \\cdot 180 \\cdot \\cos(15^\\circ) = 117 \\cos(15^\\circ)$ mm\n\n对于第 n=3 肋：\n$L_3 = 190$ mm, $f_3 = 0.37$, $\\beta_3 = 18^\\circ$\n$T_3 = (1 - 0.37) \\cdot 190 \\cdot \\cos(18^\\circ) = 0.63 \\cdot 190 \\cdot \\cos(18^\\circ) = 119.7 \\cos(18^\\circ)$ mm\n\n对于第 n=4 肋：\n$L_4 = 210$ mm, $f_4 = 0.40$, $\\beta_4 = 22^\\circ$\n$T_4 = (1 - 0.40) \\cdot 210 \\cdot \\cos(22^\\circ) = 0.60 \\cdot 210 \\cdot \\cos(22^\\circ) = 126 \\cos(22^\\circ)$ mm\n\n对于第 n=5 肋：\n$L_5 = 230$ mm, $f_5 = 0.43$, $\\beta_5 = 25^\\circ$\n$T_5 = (1 - 0.43) \\cdot 230 \\cdot \\cos(25^\\circ) = 0.57 \\cdot 230 \\cdot \\cos(25^\\circ) = 131.1 \\cos(25^\\circ)$ mm\n\n现在我们计算每一项 $T_n$ 的数值：\n$T_2 = 117 \\cdot \\cos(15^\\circ) \\approx 117 \\cdot 0.965926 \\approx 113.013$ mm\n$T_3 = 119.7 \\cdot \\cos(18^\\circ) \\approx 119.7 \\cdot 0.951057 \\approx 113.841$ mm\n$T_4 = 126 \\cdot \\cos(22^\\circ) \\approx 126 \\cdot 0.927184 \\approx 116.825$ mm\n$T_5 = 131.1 \\cdot \\cos(25^\\circ) \\approx 131.1 \\cdot 0.906308 \\approx 118.830$ mm\n\n总和是：\n$$ \\sum_{n=2}^{5} T_n \\approx 113.013 + 113.841 + 116.825 + 118.830 = 462.509 \\text{ mm} $$\n\n最后，我们计算 $\\Delta D_{AP}$：\n$$ \\Delta D_{AP} = \\frac{\\theta_{rad}}{4} \\sum_{n=2}^{5} T_n = \\frac{\\pi/60}{4} \\cdot (462.509) = \\frac{\\pi}{240} \\cdot 462.509 $$\n$$ \\Delta D_{AP} \\approx 0.01308997 \\cdot 462.509 \\approx 6.0543 \\text{ mm} $$\n\n问题要求答案四舍五入到三位有效数字。\n$$ \\Delta D_{AP} \\approx 6.05 \\text{ mm} $$",
            "answer": "$$\\boxed{6.05}$$"
        },
        {
            "introduction": "解剖学知识的价值在临床实践中体现得淋漓尽致，尤其是在处理解剖变异时。胸骨孔是一种常见的先天性变异，虽然通常无害，但在进行胸骨穿刺等操作时会带来致命风险 。这个高级练习要求我们构建一个三维几何模型，以算法方式评估穿刺针穿过胸骨孔并损伤心脏的风险，这凸显了将解剖学知识与空间推理相结合以确保患者安全的重要性。",
            "id": "5153241",
            "problem": "永久性胸骨孔是胸骨体的一种先天性穿孔，由胚胎发育和生后骨化过程中成对的胸骨条和节段性骨化中心（胸骨节）不完全融合所致。这种解剖变异可能为从前表面插入的器械提供一条无阻碍的路径，使其穿过胸骨进入前纵隔，从而增加了胸骨穿刺时损伤右心室的风险。请从骨形成中胚胎学节段化和融合以及Euclidean三维几何学的基本定义出发，使用以下抽象和参数对前胸壁和心脏进行建模，并构建一个评估损伤风险的算法。\n\n假设一个右手笛卡尔坐标系，其坐标轴定义如下：$x$轴向患者左侧递增，$y$轴向上方递增，$z$轴向后方递增。胸骨前表面位于平面 $z = 0$。胸骨被建模为一个均匀的板状结构，占据 $0 \\le z \\le T$ 的空间，但有一个与 $z$ 轴对齐、中心位于 $(x_f,y_f)$、半径为 $R$ 的圆柱形胸骨孔（一个通孔）除外。胸骨内表面位于平面 $z = T$。处于危险中的右心室前表面由一个半径为 $r_h$、中心位于 $(x_h,y_h,z_h)$（其中 $z_h > T$）的球体近似表示。\n\n一根穿刺针从点 $(x_0,y_0,z_0)$（其中 $z_0 = 0$）处插入，并沿长度为 $L$ 的直线轨迹前进，其方向由两个角度给出：从 $z$ 轴测量的仰角 $\\alpha$（$\\alpha = 0$ 表示完全垂直于胸骨表面，指向后方），以及在 $x$–$y$ 平面内从正 $x$ 轴向正 $y$ 轴测量的方位角 $\\varphi$。使用Euclidean几何学，穿刺针的轨迹可以表示为从 $t = 0$ 到 $t = L$ 的参数化线段：\n$$\n\\mathbf{p}(t) = \\mathbf{p}_0 + t\\,\\mathbf{d},\n$$\n其中 $\\mathbf{p}_0 = (x_0,y_0,0)$，$\\mathbf{d}$ 是由 $\\alpha$ 和 $\\varphi$ 决定的单位方向向量。角度必须以度为单位处理。所有长度必须以毫米（mm）为单位处理。\n\n风险标准：当且仅当以下两个条件都满足时，才认为可能发生医源性心脏损伤：\n1. 穿刺针穿过胸骨厚度 $0 \\le z \\le T$ 的路径完全位于圆柱形孔内部（即，它不与骨板相交），并且\n2. 穿刺针路径在 $z \\ge T$ 的部分与代表右心室的球形区域相交。\n\n请从第一性原理出发，使用上述定义推导并实现一个算法，该算法在给定数值参数的情况下，如果存在损伤风险则返回 $True$，否则返回 $False$。\n\n除非在测试中另有规定，否则对所有测试用例使用以下固定的解剖模型参数：\n- 胸骨厚度 $T = 12$ mm。\n- 孔中心 $(x_f,y_f) = (0,0)$ mm，半径 $R = 3.5$ mm。\n- 心脏球体半径 $r_h = 15$ mm，中心 $(x_h,y_h,z_h) = (0,0,37)$ mm。\n\n您的程序必须评估以下穿刺针轨迹的测试套件，并输出一行结果，该结果为方括号括起来的逗号分隔列表：\n\n- 测试用例 1 (常规垂直、穿过孔、长度足够)：$(x_0,y_0) = (0,0)$ mm，$\\alpha = 0$ 度，$\\varphi = 0$ 度，$L = 60$ mm。使用默认的心脏中心。\n- 测试用例 2 (侧向倾斜导致在到达内表面前离开孔)：$(x_0,y_0) = (0,0)$ mm，$\\alpha = 20$ 度，$\\varphi = 90$ 度，$L = 60$ mm。使用默认的心脏中心。\n- 测试用例 3 (垂直但长度不足以到达心脏球体)：$(x_0,y_0) = (0,0)$ mm，$\\alpha = 0$ 度，$\\varphi = 0$ 度，$L = 20$ mm。使用默认的心脏中心。\n- 测试用例 4 (偏心进入但由于补偿性方位角仍保持在孔内，长度足够)：$(x_0,y_0) = (2,0)$ mm，$\\alpha = 10$ 度，$\\varphi = 180$ 度，$L = 60$ mm。使用默认的心脏中心。\n- 测试用例 5 (垂直穿过孔但心脏中心横向偏移，导致轨迹错过)：$(x_0,y_0) = (0,0)$ mm，$\\alpha = 0$ 度，$\\varphi = 0$ 度，$L = 60$ mm。对于此测试用例，使用心脏中心 $(x_h,y_h,z_h) = (30,0,37)$ mm 和半径 $r_h = 15$ mm。\n\n角度输入必须以度为单位处理。长度必须以毫米为单位处理。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,result4,result5]”），其中每个结果是一个布尔值（$True$ 或 $False$），按顺序对应每个测试用例的损伤风险。",
            "solution": "该问题要求基于简化的胸壁和心脏几何模型，对胸骨穿刺过程中的医源性损伤风险进行算法评估。模型和风险标准已给出，解决方案必须从Euclidean几何学的第一性原理推导得出。\n\n解决方案分三个主要步骤展开：\n1. 在三维笛卡尔坐标系中，将穿刺针的轨迹公式化为参数化线。\n2. 推导穿刺针完全穿过胸骨孔而不与周围骨骼相交的数学条件。\n3. 推导穿刺针在胸骨后方的路径段与代表心脏的球形体积相交的数学条件。\n\n当且仅当这两个条件都满足时，才存在损伤风险。\n\n**1. 穿刺针轨迹的公式化**\n\n定义一个右手笛卡尔坐标系，其中胸骨前表面位于平面 $z=0$。穿刺针从 $\\mathbf{p}_0 = (x_0, y_0, 0)$ 处插入，并沿直线前进。该直线的方向由仰角 $\\alpha$ 和方位角 $\\varphi$ 给出。角度 $\\alpha$ 从正 $z$ 轴（向后）测量，而 $\\varphi$ 在 $x-y$ 平面内从正 $x$ 轴测量。\n\n要使用这些角度，必须首先将它们从度转换为弧度：\n$$ \\alpha_{\\text{rad}} = \\alpha_{\\text{deg}} \\frac{\\pi}{180} $$\n$$ \\varphi_{\\text{rad}} = \\varphi_{\\text{deg}} \\frac{\\pi}{180} $$\n穿刺针轨迹的单位方向向量 $\\mathbf{d}$ 可通过标准的球坐标到笛卡尔坐标转换得到：\n$$ \\mathbf{d} = (d_x, d_y, d_z) = (\\sin\\alpha_{\\text{rad}}\\cos\\varphi_{\\text{rad}}, \\sin\\alpha_{\\text{rad}}\\sin\\varphi_{\\text{rad}}, \\cos\\alpha_{\\text{rad}}) $$\n穿刺针的轨迹是一个长度为 $L$，从 $\\mathbf{p}_0$ 开始的参数化线段 $\\mathbf{p}(t)$：\n$$ \\mathbf{p}(t) = \\mathbf{p}_0 + t\\mathbf{d} \\quad \\text{对于 } t \\in [0, L] $$\n用分量形式表示为：\n$$ x(t) = x_0 + t\\sin\\alpha_{\\text{rad}}\\cos\\varphi_{\\text{rad}} $$\n$$ y(t) = y_0 + t\\sin\\alpha_{\\text{rad}}\\sin\\varphi_{\\text{rad}} $$\n$$ z(t) = t\\cos\\alpha_{\\text{rad}} $$\n为使穿刺针能向后进入纵隔，其方向的 $z$ 分量 $d_z = \\cos\\alpha_{\\text{rad}}$ 必须为正。这意味着 $\\alpha_{\\text{deg}} \\in [0, 90)$。如果 $\\alpha_{\\text{deg}} \\ge 90$，穿刺针不会向后行进，风险为零。\n\n**2. 条件 1：穿过孔**\n\n第一个风险标准是穿刺针的路径在穿过胸骨时完全保持在圆柱形孔内。胸骨占据了 $0 \\le z \\le T$ 的板状空间。孔是一个半径为 $R$、中心在 $(x_f, y_f)$、与 $z$ 轴对齐的圆柱体。其方程为 $(x-x_f)^2 + (y-y_f)^2 \\le R^2$。\n\n穿刺针从 $z=0$ 到 $z=T$ 穿过胸骨厚度。参数 $t$ 的相应值可由 $z(t) = t\\cos\\alpha_{\\text{rad}}$ 求出。\n- 在 $z=0$ 处，$t=0$。\n- 在 $z=T$ 处，$t = T/\\cos\\alpha_{\\text{rad}}$。我们将其记为 $t_T$。\n因此，对于对应于 $t \\in [0, t_T]$ 的整个路径段，穿刺针的 $x$ 和 $y$ 坐标必须满足孔的不等式。\n$$ (x(t)-x_f)^2 + (y(t)-y_f)^2 \\le R^2 \\quad \\text{对于所有 } t \\in [0, t_T] $$\n我们来分析表示穿刺针投影与孔中心距离平方的函数：\n$$ g(t) = ((x_0 - x_f) + t d_x)^2 + ((y_0 - y_f) + t d_y)^2 $$\n这是一个关于 $t$ 的二次函数，$g(t) = At^2 + Bt + C$，其中 $A = d_x^2 + d_y^2 = \\sin^2\\alpha_{\\text{rad}} \\ge 0$。由于系数 $A$ 是非负的，该函数描述了一个开口向上的抛物线（如果 $A=0$，则为常数）。这样一个函数在闭区间 $[t_a, t_b]$ 上的最大值必然出现在其中一个端点 $t_a$ 或 $t_b$ 处。\n在我们的情况下，区间是 $[0, t_T]$。因此，我们只需要在 $t=0$ 和 $t=t_T$ 处验证该条件：\n1. 在 $t=0$ 处（入口点）：$(x_0-x_f)^2 + (y_0-y_f)^2 \\le R^2$。\n2. 在 $t=t_T$ 处（出口点）：$(x(t_T)-x_f)^2 + (y(t_T)-y_f)^2 \\le R^2$，其中 $x(t_T) = x_0 + t_T d_x$ 且 $y(t_T) = y_0 + t_T d_y$。\n\n如果两个不等式都成立，则条件 1 满足。否则，不满足。\n\n**3. 条件 2：与心脏相交**\n\n第二个风险标准是穿刺针穿过胸骨后与心脏相交。心脏被建模为一个半径为 $r_h$、中心在 $\\mathbf{c} = (x_h, y_h, z_h)$ 的球体。需要考虑的穿刺针路径段是 $z \\ge T$ 的部分，对应于 $t \\in [t_T, L]$。只有当 $L > t_T$ 时，这段路径才存在。如果 $L \\le t_T$，穿刺针前进的距离不足以可能击中心脏，因此条件 2 不满足。\n\n假设 $L > t_T$，我们进行线段与球体相交测试。球体的方程是 $\\|\\mathbf{p} - \\mathbf{c}\\|^2 = r_h^2$。代入直线方程 $\\mathbf{p}(t) = \\mathbf{p}_0 + t\\mathbf{d}$ 得：\n$$ \\|\\mathbf{p}_0 + t\\mathbf{d} - \\mathbf{c}\\|^2 = r_h^2 $$\n设 $\\mathbf{v} = \\mathbf{p}_0 - \\mathbf{c}$。方程变为 $\\|\\mathbf{v} + t\\mathbf{d}\\|^2 = r_h^2$，展开后为：\n$$ (\\mathbf{v}\\cdot\\mathbf{v}) + 2t(\\mathbf{v}\\cdot\\mathbf{d}) + t^2(\\mathbf{d}\\cdot\\mathbf{d}) - r_h^2 = 0 $$\n由于 $\\mathbf{d}$ 是单位向量，$\\mathbf{d}\\cdot\\mathbf{d}=1$。这是一个关于 $t$ 的标准二次方程：$at^2+bt+c=0$，其系数为：\n- $a = 1$\n- $b = 2(\\mathbf{v}\\cdot\\mathbf{d})$\n- $c = (\\mathbf{v}\\cdot\\mathbf{v}) - r_h^2$\n\n判别式为 $\\Delta = b^2 - 4ac$。\n- 如果 $\\Delta  0$，直线不与球体相交。条件 2 不满足。\n- 如果 $\\Delta \\ge 0$，则至少有一个交点。$t$ 的解为：\n$$ t_{i1, i2} = \\frac{-b \\pm \\sqrt{\\Delta}}{2a} = -(\\mathbf{v}\\cdot\\mathbf{d}) \\pm \\sqrt{(\\mathbf{v}\\cdot\\mathbf{d})^2 - ((\\mathbf{v}\\cdot\\mathbf{v}) - r_h^2)} $$\n这两个值 $t_{i1}$ 和 $t_{i2}$（其中 $t_{i1} \\le t_{i2}$）定义了无限长直线在球体内部的区间。\n\n要发生损伤，穿刺针在胸骨后方的路径段 $[t_T, L]$ 必须与球体的相交区间 $[t_{i1}, t_{i2}]$ 重叠。两个区间 $[a, b]$ 和 $[c, d]$ 重叠的充要条件是 $a \\le d$ 且 $c \\le b$。\n因此，如果 $L > t_T$，$\\Delta \\ge 0$，并且区间重叠，则条件 2 满足：\n$$ t_T \\le t_{i2} \\quad \\text{且} \\quad t_{i1} \\le L $$\n\n**算法总结**\n\n对于一组给定的参数，最终的算法如下：\n1. 将角度 $\\alpha$ 和 $\\varphi$ 转换为弧度。如果 $\\alpha \\ge 90^\\circ$，则返回 `False`。\n2. 计算方向向量 $\\mathbf{d}$。\n3. 检查条件 1：\n    a. 验证入口点 $(x_0, y_0)$ 在孔半径 $R$ 内。如果不在，返回 `False`。\n    b. 计算 $t_T = T/\\cos\\alpha_{\\text{rad}}$ 和相应的出口点的 $xy$ 坐标。验证该点在孔半径 $R$ 内。如果不在，返回 `False`。\n4. 检查条件 2：\n    a. 如果穿刺针长度 $L \\le t_T$，返回 `False`。\n    b. 建立并求解直线与球体相交的二次方程。如果判别式为负，返回 `False`。\n    c. 找到相交区间 $[t_{i1}, t_{i2}]$。\n    d. 检查 $[t_T, L]$ 和 $[t_{i1}, t_{i2}]$ 是否重叠。如果重叠，返回 `True`。否则，返回 `False`。\n\n将此过程应用于每个测试用例，以生成最终的结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the sternal puncture risk assessment problem for a suite of test cases.\n    \"\"\"\n\n    def evaluate_risk(x0, y0, alpha_deg, phi_deg, L, T, xf, yf, R, xh, yh, zh, rh):\n        \"\"\"\n        Evaluates the risk of iatrogenic cardiac injury for a single needle trajectory.\n\n        Args:\n            x0, y0 (float): Needle entry coordinates (mm).\n            alpha_deg (float): Elevation angle from z-axis (degrees).\n            phi_deg (float): Azimuth angle from x-axis (degrees).\n            L (float): Needle trajectory length (mm).\n            T (float): Sternal thickness (mm).\n            xf, yf (float): Foramen center coordinates (mm).\n            R (float): Foramen radius (mm).\n            xh, yh, zh (float): Heart sphere center coordinates (mm).\n            rh (float): Heart sphere radius (mm).\n\n        Returns:\n            bool: True if injury risk exists, False otherwise.\n        \"\"\"\n        # Convert angles to radians\n        alpha_rad = np.deg2rad(alpha_deg)\n        phi_rad = np.deg2rad(phi_deg)\n\n        # The needle must advance posteriorly (positive z-direction).\n        # cos(alpha)  0 implies alpha is in [0, 90) degrees.\n        # If alpha is 90 degrees, cos(alpha) is 0, needle moves parallel to sternum.\n        # If alpha  90, it moves away from the heart.\n        if alpha_deg = 90.0:\n            return False\n\n        # 1. Formulate the needle trajectory\n        # Direction vector d from spherical coordinates\n        d = np.array([\n            np.sin(alpha_rad) * np.cos(phi_rad),\n            np.sin(alpha_rad) * np.sin(phi_rad),\n            np.cos(alpha_rad)\n        ])\n        \n        # Start point p0\n        p0 = np.array([x0, y0, 0.0])\n\n        # 2. Check Condition 1: Foramen Pass-Through\n        foramen_center_2d = np.array([xf, yf])\n        \n        # Check entry point at t=0\n        entry_point_2d = p0[:2]\n        if np.linalg.norm(entry_point_2d - foramen_center_2d)**2  R**2:\n            return False\n            \n        # Check exit point from sternum at z=T\n        # z(t) = t * d_z = t_T = T / d_z\n        t_sternum_exit = T / d[2]\n        \n        exit_point_3d = p0 + t_sternum_exit * d\n        exit_point_2d = exit_point_3d[:2]\n\n        if np.linalg.norm(exit_point_2d - foramen_center_2d)**2  R**2:\n            return False\n\n        # 3. Check Condition 2: Heart Intersection\n        # Needle must be long enough to exit the sternum\n        if L = t_sternum_exit:\n            return False\n\n        # Line-segment-sphere intersection test\n        heart_center = np.array([xh, yh, zh])\n        v = p0 - heart_center\n        \n        # Solve quadratic equation for t: a*t^2 + b*t + c = 0\n        # where a=1, b=2*(v.d), c=(v.v) - rh^2\n        dot_v_d = np.dot(v, d)\n        dot_v_v = np.dot(v, v)\n        \n        # Discriminant of the quadratic equation\n        discriminant = dot_v_d**2 - (dot_v_v - rh**2)\n        \n        if discriminant  0:\n            return False # Line misses the sphere entirely\n        \n        sqrt_discriminant = np.sqrt(discriminant)\n        \n        # Intersection interval of the infinite line with the sphere\n        t_intersect1 = -dot_v_d - sqrt_discriminant\n        t_intersect2 = -dot_v_d + sqrt_discriminant\n        \n        # The relevant segment of the needle path is [t_sternum_exit, L]\n        # Check for overlap between [t_sternum_exit, L] and [t_intersect1, t_intersect2]\n        # Overlap exists if start1 = end2 and start2 = end1\n        if t_sternum_exit = t_intersect2 and t_intersect1 = L:\n            return True\n        else:\n            return False\n\n    # Default anatomical model parameters\n    default_params = {\n        'T': 12.0,       # Sternal thickness (mm)\n        'xf': 0.0,       # Foramen center x (mm)\n        'yf': 0.0,       # Foramen center y (mm)\n        'R': 3.5,        # Foramen radius (mm)\n        'xh': 0.0,       # Heart center x (mm)\n        'yh': 0.0,       # Heart center y (mm)\n        'zh': 37.0,      # Heart center z (mm)\n        'rh': 15.0       # Heart radius (mm)\n    }\n\n    # Test suite of needle trajectories\n    test_cases = [\n        # Test case 1\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 60.0},\n        # Test case 2\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 20.0, 'phi_deg': 90.0, 'L': 60.0},\n        # Test case 3\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 20.0},\n        # Test case 4\n        {'x0': 2.0, 'y0': 0.0, 'alpha_deg': 10.0, 'phi_deg': 180.0, 'L': 60.0},\n        # Test case 5 (with overridden heart center)\n        {'x0': 0.0, 'y0': 0.0, 'alpha_deg': 0.0, 'phi_deg': 0.0, 'L': 60.0, 'xh': 30.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Combine default params with case-specific params\n        params = default_params.copy()\n        params.update(case)\n        result = evaluate_risk(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}