{
    "hands_on_practices": [
        {
            "introduction": "The defining characteristic of a simple cell in the primary visual cortex is its spatially structured receptive field, composed of distinct 'ON' and 'OFF' subregions. This spatial opponency is the foundation for its selectivity to oriented stimuli. In this practice , you will use a linear model with opposing Gaussian subfields to demonstrate a classic property: a perfectly balanced simple cell does not respond to a diffuse, uniform flash of light, revealing how its structure is tuned to detect spatial contrast rather than absolute luminance levels.",
            "id": "5052613",
            "problem": "A simple cell in the primary visual cortex shows two spatially separate subregions of opposite sign in its spike-triggered average (STA), indicating spatial opponency. Let the STA-derived linear receptive field kernel be modeled as $w(x,y) = A_{+} G_{+}(x,y) - A_{-} G_{-}(x,y)$, where $G_{+}(x,y)$ and $G_{-}(x,y)$ are two Gaussian subfields centered on distinct locations along the $x$-axis, each normalized such that $\\iint G_{\\pm}(x,y) \\, dx \\, dy = 1$. Consider the linear receptive field model in which the generator signal $u$ produced by a static spatial stimulus $s(x,y)$ is $u = \\iint w(x,y) \\, s(x,y) \\, dx \\, dy$, and the small-contrast firing rate change is $\\Delta r = g \\, u$, where $g$ is a gain converting generator signal to firing rate change.\n\nAssume the stimulus is a uniform flash that fully covers both subfields, with spatial contrast $c$ relative to baseline, i.e., $s(x,y) = c$ over the entire region containing both lobes. Using the superposition principle for linear systems and the normalization of $G_{\\pm}(x,y)$, demonstrate that if $A_{+} = A_{-}$, then the predicted firing rate change to this uniform flash is $\\Delta r = 0$ for any $c$.\n\nNext, suppose that reverse correlation measurements yield $A_{+} = 1.2$ and $A_{-} = 1.0$ (dimensionless spatial weights), the gain is $g = 45$ spikes per second per unit generator signal, and the flash contrast is $c = 0.15$. The flash aperture fully covers both lobes such that $\\iint_{\\text{aperture}} G_{\\pm}(x,y) \\, dx \\, dy = 1$ holds exactly. Calculate the expected firing rate change $\\Delta r$ under this uniform flash. Express the final firing rate change in spikes per second and round your answer to three significant figures.",
            "solution": "The problem is divided into two parts. The first is a demonstration, and the second is a calculation.\n\n**Part 1: Demonstration for $A_{+} = A_{-}$**\n\nThe generator signal $u$ is produced by the spatial stimulus $s(x,y)$ interacting with the receptive field kernel $w(x,y)$. The relationship is given by the integral:\n$$u = \\iint w(x,y) \\, s(x,y) \\, dx \\, dy$$\nWe substitute the given expression for the kernel $w(x,y) = A_{+} G_{+}(x,y) - A_{-} G_{-}(x,y)$:\n$$u = \\iint \\left[ A_{+} G_{+}(x,y) - A_{-} G_{-}(x,y) \\right] s(x,y) \\, dx \\, dy$$\nThe stimulus is a uniform flash of contrast $c$. This means $s(x,y) = c$ over the entire extent of the receptive field. Substituting this into the integral:\n$$u = \\iint \\left[ A_{+} G_{+}(x,y) - A_{-} G_{-}(x,y) \\right] c \\, dx \\, dy$$\nSince $c$ is a constant, it can be factored out of the integral. By the linearity of integration, we can also separate the terms:\n$$u = c \\left( \\iint A_{+} G_{+}(x,y) \\, dx \\, dy - \\iint A_{-} G_{-}(x,y) \\, dx \\, dy \\right)$$\nThe weights $A_{+}$ and $A_{-}$ are constants and can also be factored out of their respective integrals:\n$$u = c \\left( A_{+} \\iint G_{+}(x,y) \\, dx \\, dy - A_{-} \\iint G_{-}(x,y) \\, dx \\, dy \\right)$$\nThe problem states that the Gaussian subfields $G_{\\pm}(x,y)$ are normalized such that their integral over all space is $1$. The condition that the flash fully covers both lobes ensures that the integration domain is sufficiently large to capture the entirety of the Gaussians, so we can use the normalization property $\\iint G_{\\pm}(x,y) \\, dx \\, dy = 1$. Substituting this into our expression for $u$:\n$$u = c \\left( A_{+} \\cdot 1 - A_{-} \\cdot 1 \\right) = c (A_{+} - A_{-})$$\nThis is the general expression for the generator signal in response to a uniform flash. Now, we apply the specific condition for this part of the problem, which is that the subfields are balanced, i.e., $A_{+} = A_{-}$.\n_If_ $A_{+} = A_{-}$, then the expression for $u$ becomes:\n$$u = c (A_{+} - A_{+}) = c \\cdot 0 = 0$$\nThe change in firing rate, $\\Delta r$, is related to the generator signal by the gain $g$:\n$$\\Delta r = g \\, u$$\nSince $u = 0$, the change in firing rate is:\n$$\\Delta r = g \\cdot 0 = 0$$\nThis demonstrates that if a simple cell's receptive field has perfectly balanced 'ON' and 'OFF' subregions ($A_{+} = A_{-}$), it will not respond to a uniform, diffuse flash of light, irrespective of the contrast $c$ (assuming $c$ is not infinite) or gain $g$. This property is a hallmark of balanced spatial opponency.\n\n**Part 2: Calculation of Firing Rate Change**\n\nFor the second part, we are given a case where the subfields are not perfectly balanced. We use the same general formula for the generator potential $u$ derived above:\n$$u = c (A_{+} - A_{-})$$\nWe are given the following values:\n- Contrast $c = 0.15$\n- Positive subfield weight $A_{+} = 1.2$\n- Negative subfield weight $A_{-} = 1.0$\n\nSubstituting these values into the expression for $u$:\n$$u = 0.15 \\times (1.2 - 1.0) = 0.15 \\times 0.2 = 0.03$$\nThe generator signal $u$ is a dimensionless quantity in this formulation since $c$, $A_{+}$, and $A_{-}$ are given as dimensionless quantities.\nNext, we calculate the change in firing rate, $\\Delta r$, using the gain $g$:\n$$\\Delta r = g \\, u$$\nWe are given the gain $g = 45$ spikes per second per unit generator signal. Substituting the values for $g$ and $u$:\n$$\\Delta r = 45 \\, \\frac{\\text{spikes}}{\\text{s}} \\times 0.03 = 1.35 \\, \\frac{\\text{spikes}}{\\text{s}}$$\nThe problem requires the answer to be rounded to three significant figures. The calculated value $1.35$ is already presented with three significant figures. Therefore, the expected firing rate change is $1.35$ spikes per second.",
            "answer": "$$\\boxed{1.35}$$"
        },
        {
            "introduction": "Simple cells are often described by a Linear-Nonlinear (LN) model, where a linear receptive field filters the input before a static nonlinearity generates the output firing rate. This exercise  provides a direct test of this model's properties by examining the principle of linear superposition. You will calculate the cell's response to two stimuli that are designed to cancel each other out at the linear stage, demonstrating precisely how the output nonlinearity (a firing threshold) creates a response that a purely linear system could not, thereby solidifying your intuition for why superposition fails in neural processing.",
            "id": "5052599",
            "problem": "A primary visual cortex simple cell is modeled by a linear receptive field followed by a static output nonlinearity. The spatial receptive field kernel is an even-symmetric Gabor given by $h(x) = \\exp\\!\\big(-\\frac{x^{2}}{2\\sigma^{2}}\\big)\\,\\cos(2\\pi f_{0} x)$, where $x$ is position in degrees of visual angle, $\\sigma$ is the Gaussian width in degrees, and $f_{0}$ is the preferred spatial frequency in cycles per degree. The linear generator signal $L[s]$ to a static stimulus $s(x)$ is defined by $L[s] = \\int_{-\\infty}^{\\infty} h(x)\\,s(x)\\,dx$. The measured steady firing rate $R[s]$ is modeled by a half-wave threshold-linear output nonlinearity $\\varphi(u) = \\max(0,\\,u - \\theta)$, so that $R[s] = \\varphi(L[s])$, where $\\theta$ is a threshold in generator units.\n\nConsider two sinusoidal grating stimuli $s_{1}(x) = A_{1}\\,\\cos(2\\pi f_{1} x + \\phi_{1})$ and $s_{2}(x) = A_{2}\\,\\cos(2\\pi f_{2} x + \\phi_{2})$ with parameters $\\sigma = 0.1$ (degrees), $f_{0} = 3$ (cycles per degree), $A_{1} = 0.8$ (dimensionless Michelson contrast), $A_{2} = 0.5$ (dimensionless Michelson contrast), $f_{1} = f_{2} = f_{0}$, $\\phi_{1} = 0$, $\\phi_{2} = \\pi$, and $\\theta = 0.09$ (generator units). The sum stimulus is $s_{1+2}(x) = s_{1}(x) + s_{2}(x)$.\n\nStarting only from the definitions above and well-tested properties of linear systems and Gaussian integrals, do the following:\n- Derive the analytic expressions for the linear generator signals $L[s_{1}]$, $L[s_{2}]$, and $L[s_{1+2}]$.\n- Compute the measured firing rates $R[s_{1}]$, $R[s_{2}]$, and $R[s_{1+2}]$ using the specified nonlinearity $\\varphi$.\n- Using the principle of linear superposition, form the linear prediction based on additivity by comparing $R[s_{1+2}]$ to $R[s_{1}] + R[s_{2}]$.\n- Quantify the deviation from linearity with the nonlinearity index $NI = \\dfrac{R[s_{1+2}] - \\big(R[s_{1}] + R[s_{2}]\\big)}{|R[s_{1}]| + |R[s_{2}]|}$.\n\nExpress the final nonlinearity index as a single decimal number. No rounding instruction is required beyond exact evaluation.",
            "solution": "The solution begins by deriving an analytic expression for the linear generator signal $L[s]$ for a general sinusoidal stimulus $s(x) = A \\cos(2\\pi f x + \\phi)$. The given problem uses stimuli where the frequency $f$ is equal to the filter's preferred frequency $f_0$. This simplifies the calculation significantly.\nLet $s(x) = A \\cos(2\\pi f_0 x + \\phi)$. The linear generator signal is:\n$$L[s] = \\int_{-\\infty}^{\\infty} h(x)s(x)dx = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)\\cos(2\\pi f_0 x) \\cdot A \\cos(2\\pi f_0 x + \\phi) dx$$\nWe use the trigonometric identity $\\cos(a)\\cos(b) = \\frac{1}{2}[\\cos(a-b) + \\cos(a+b)]$. Let $a=2\\pi f_0 x$ and $b=2\\pi f_0 x + \\phi$.\n$$L[s] = \\frac{A}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right) [\\cos(-\\phi) + \\cos(4\\pi f_0 x + \\phi)] dx$$\nUsing $\\cos(-\\phi)=\\cos(\\phi)$ and $\\cos(u+v) = \\cos(u)\\cos(v) - \\sin(u)\\sin(v)$:\n$$L[s] = \\frac{A \\cos(\\phi)}{2} \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)dx + \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)\\cos(4\\pi f_0 x)dx \\right]$$\nThe integral of the term with $\\sin(4\\pi f_0 x)$ is zero because the integrand is an odd function integrated over a symmetric interval $(-\\infty, \\infty)$.\nWe use two standard integral results. The Gaussian integral is $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$. For $a = 1/(2\\sigma^2)$, this gives $\\int_{-\\infty}^{\\infty} \\exp(-\\frac{x^2}{2\\sigma^2})dx = \\sigma\\sqrt{2\\pi}$. The Fourier cosine transform of a Gaussian is $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\cos(kx)dx = \\sqrt{\\pi/a} \\exp(-k^2/(4a))$. For $a=1/(2\\sigma^2)$ and $k=4\\pi f_0$, this gives $\\int_{-\\infty}^{\\infty} \\exp(-\\frac{x^2}{2\\sigma^2})\\cos(4\\pi f_0 x)dx = \\sigma\\sqrt{2\\pi} \\exp(-\\frac{(4\\pi f_0)^2 \\sigma^2}{2})$.\nSubstituting these results back:\n$$L[s] = \\frac{A \\cos(\\phi)}{2} \\left[ \\sigma\\sqrt{2\\pi} + \\sigma\\sqrt{2\\pi} \\exp(-8\\pi^2 f_0^2 \\sigma^2) \\right]$$\n$$L[s] = A \\cos(\\phi) \\left( \\frac{\\sigma\\sqrt{2\\pi}}{2} [1 + \\exp(-8\\pi^2 f_0^2 \\sigma^2)] \\right)$$\nLet's define the constant factor $K = \\frac{\\sigma\\sqrt{2\\pi}}{2} [1 + \\exp(-8\\pi^2 f_0^2 \\sigma^2)]$. The expression simplifies to $L[s] = K A \\cos(\\phi)$.\n\nNow we derive the expressions for $L[s_1]$, $L[s_2]$, and $L[s_{1+2}]$.\nFor $s_1(x)$, we have $A_1 = 0.8$ and $\\phi_1 = 0$.\n$$L[s_1] = K A_1 \\cos(\\phi_1) = K (0.8) \\cos(0) = 0.8 K$$\nFor $s_2(x)$, we have $A_2 = 0.5$ and $\\phi_2 = \\pi$.\n$$L[s_2] = K A_2 \\cos(\\phi_2) = K (0.5) \\cos(\\pi) = -0.5 K$$\nDue to the linearity of the integral operator $L$, the response to the sum of stimuli is the sum of the responses.\n$$L[s_{1+2}] = L[s_1 + s_2] = L[s_1] + L[s_2] = 0.8 K - 0.5 K = 0.3 K$$\n\nNext, we compute the numerical value of the constant $K$ using the given parameters $\\sigma = 0.1$ and $f_0 = 3$.\n$$f_0^2 \\sigma^2 = (3)^2 (0.1)^2 = 9 \\times 0.01 = 0.09$$\n$$K = \\frac{0.1\\sqrt{2\\pi}}{2} [1 + \\exp(-8\\pi^2 (0.09))] = \\frac{0.1\\sqrt{2\\pi}}{2} [1 + \\exp(-0.72\\pi^2)]$$\nUsing numerical values for constants, $\\pi \\approx 3.14159$, we get:\n$$-0.72\\pi^2 \\approx -0.72 \\times 9.8696 = -7.1061$$\n$$\\exp(-0.72\\pi^2) \\approx \\exp(-7.1061) \\approx 0.000822$$\n$$K \\approx \\frac{0.1 \\times 2.5066}{2} [1 + 0.000822] \\approx 0.12533 \\times 1.000822 \\approx 0.12543$$\nNow, we compute the numerical values for the generator signals:\n$$L[s_1] = 0.8 \\times 0.12543 \\approx 0.10034$$\n$$L[s_2] = -0.5 \\times 0.12543 \\approx -0.06272$$\n$$L[s_{1+2}] = 0.3 \\times 0.12543 \\approx 0.03763$$\n\nWe now compute the measured firing rates $R[s]$ using the nonlinearity $\\varphi(u) = \\max(0, u-\\theta)$ with threshold $\\theta = 0.09$.\n$$R[s_1] = \\max(0, L[s_1] - 0.09) = \\max(0, 0.10034 - 0.09) = \\max(0, 0.01034) = 0.01034$$\n$$R[s_2] = \\max(0, L[s_2] - 0.09) = \\max(0, -0.06272 - 0.09) = \\max(0, -0.15272) = 0$$\n$$R[s_{1+2}] = \\max(0, L[s_{1+2}] - 0.09) = \\max(0, 0.03763 - 0.09) = \\max(0, -0.05237) = 0$$\n\nThe linear prediction for the combined response is the sum of individual responses:\n$$R[s_1] + R[s_2] = 0.01034 + 0 = 0.01034$$\nThe actual measured response to the combined stimulus is $R[s_{1+2}] = 0$.\nThe two are not equal ($0 \\neq 0.01034$), demonstrating the failure of linear superposition for the output firing rates.\n\nFinally, we quantify this deviation using the nonlinearity index $NI$:\n$$NI = \\dfrac{R[s_{1+2}] - \\big(R[s_{1}] + R[s_{2}]\\big)}{|R[s_{1}]| + |R[s_{2}]|}$$\nSubstituting the computed values:\n$$NI = \\dfrac{0 - (0.01034 + 0)}{|0.01034| + |0|} = \\dfrac{-0.01034}{0.01034}$$\n$$NI = -1$$\nThe result is exactly $-1$. This can be seen analytically. We established that $L[s_1] > \\theta$, $L[s_2]  0$, and $L[s_1]+L[s_2]  \\theta$.\nThis means $R[s_1] = L[s_1] - \\theta > 0$, $R[s_2] = 0$, and $R[s_{1+2}]=0$.\n$$NI = \\dfrac{0 - ((L[s_1]-\\theta) + 0)}{|L[s_1]-\\theta| + |0|} = \\dfrac{-(L[s_1]-\\theta)}{L[s_1]-\\theta} = -1$$",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "Modern neuroscience heavily relies on computational models to synthesize complex data and generate testable predictions. This advanced practice  challenges you to step into the role of a computational modeler by integrating several key properties of V1 neurons into a single framework. You will fit a divisive normalization model to contrast-response data and then use the fitted parameters to predict how orientation tuning bandwidth changes with contrast, revealing a fundamental distinction between simple-like and complex-like cells. This exercise provides hands-on experience with data fitting and model-based prediction, core skills in quantitative neurobiology.",
            "id": "5052549",
            "problem": "You are asked to implement a program that models and analyzes responses of neurons in the primary visual cortex using contrast normalization and orientation tuning, reflecting canonical properties of simple and complex receptive fields. The program must estimate parameters for the divisive normalization contrast-response function and then use those estimates to predict how tuning bandwidth changes with contrast for simple-like and complex-like receptive fields.\n\nBegin from the following valid and widely used foundational bases:\n\n- Divisive normalization: the contrast-response function of many primary visual cortex neurons is well described by a saturating nonlinearity in the form $R(C) = \\frac{C^n}{\\sigma^n + C^n}$, where $C$ is contrast (dimensionless, expressed as a decimal between $0$ and $1$), $n$ is an exponent controlling response steepness, and $\\sigma$ is the semi-saturation constant (the contrast at which half-maximal response occurs when $n$ is correctly parameterized).\n- Orientation tuning: an oriented linear filterâ€™s sensitivity can be represented by a normalized von Mises function $s(\\theta) = \\exp\\!\\big(\\kappa(\\cos(\\theta - \\theta_0) - 1)\\big)$, where $\\theta$ is orientation (expressed in degrees), $\\theta_0$ is the preferred orientation (degrees), and $\\kappa  0$ is a concentration parameter controlling tuning sharpness. By construction $s(\\theta_0) = 1$.\n\nUsing these bases, assume the following output models:\n\n- Simple-like model: $T_{\\text{simple}}(\\theta; C) = A(C) \\, s(\\theta) + B$, where $A(C) = R(C)$ is the contrast-dependent gain and $B \\ge 0$ is a baseline offset attributed to rectification and background activity.\n- Complex-like model: $T_{\\text{complex}}(\\theta; C) = A(C) \\, s(\\theta)$, which has no additive baseline ($B = 0$) and is often approximately contrast-invariant in its bandwidth because contrast scales the gain multiplicatively.\n\nDefine the tuning bandwidth as the half-width at half-maximum (HWHM) of $T(\\theta; C)$ around the preferred orientation $\\theta_0$, measured in degrees. By definition, HWHM is the smallest positive angle $\\Delta$ satisfying $T(\\theta_0 \\pm \\Delta; C) = \\frac{1}{2}\\max_{\\theta} T(\\theta; C)$. Use degrees for all orientation-related quantities.\n\nYour program must:\n\n1. Estimate parameters $n$ and $\\sigma$ by nonlinear regression (least-squares fit) of the function $R(C) = \\frac{C^n}{\\sigma^n + C^n}$ to the provided contrast-response data $(C_i, R_i)$. Constrain $n$ and $\\sigma$ to be nonnegative, and use a sensible initial guess without relying on closed-form solutions.\n2. Using the fitted parameters, compute $A(C)$ and then the predicted HWHM at two specified contrasts $C_{\\text{low}}$ and $C_{\\text{high}}$ for each test case. For the simple-like model, use $T_{\\text{simple}}(\\theta; C) = A(C) s(\\theta) + B$, and for the complex-like model, use $T_{\\text{complex}}(\\theta; C) = A(C) s(\\theta)$. If the half-maximum level falls below the baseline (for the simple-like model), define the HWHM to be $180$ degrees to reflect an effectively flat or undefinable half-maximum crossing in the physiological measurement convention.\n3. Report, for each test case, the fitted $n$, the fitted $\\sigma$, the HWHM at $C_{\\text{low}}$, the HWHM at $C_{\\text{high}}$, and the difference $\\Delta \\text{HWHM} = \\text{HWHM}(C_{\\text{low}}) - \\text{HWHM}(C_{\\text{high}})$, all as floating-point numbers. HWHM and $\\Delta \\text{HWHM}$ must be in degrees.\n\nUse the following test suite. Each case specifies the neuron class (simple-like or complex-like), the tuning parameters, the measured contrast-response data, and the contrasts at which to compute HWHM. All numerical values are dimensionless except orientation in degrees.\n\n- Test case 1 (simple-like):\n  - Tuning parameters: $\\kappa = 5.0$, $\\theta_0 = 0^\\circ$, $B = 0.05$.\n  - Measured contrasts $C$: $[0.05, 0.1, 0.2, 0.4, 0.8]$.\n  - Measured responses $R$: $[0.048, 0.183, 0.497, 0.818, 0.948]$.\n  - Bandwidth contrasts: $C_{\\text{low}} = 0.1$, $C_{\\text{high}} = 0.8$.\n\n- Test case 2 (complex-like):\n  - Tuning parameters: $\\kappa = 5.0$, $\\theta_0 = 0^\\circ$, $B = 0.0$.\n  - Measured contrasts $C$: $[0.05, 0.1, 0.2, 0.4, 0.8]$.\n  - Measured responses $R$: $[0.11, 0.3, 0.635, 0.881, 0.963]$.\n  - Bandwidth contrasts: $C_{\\text{low}} = 0.1$, $C_{\\text{high}} = 0.8$.\n\n- Test case 3 (simple-like, extreme saturating):\n  - Tuning parameters: $\\kappa = 5.0$, $\\theta_0 = 0^\\circ$, $B = 0.07$.\n  - Measured contrasts $C$: $[0.05, 0.1, 0.2, 0.4, 0.8]$.\n  - Measured responses $R$: $[0.025, 0.301, 0.902, 0.997, 0.999]$.\n  - Bandwidth contrasts: $C_{\\text{low}} = 0.1$, $C_{\\text{high}} = 0.8$.\n\nAngle unit specification: use degrees for $\\theta$, $\\theta_0$, HWHM, and $\\Delta \\text{HWHM}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist in the form $[n, \\sigma, \\text{HWHM}_{\\text{low}}, \\text{HWHM}_{\\text{high}}, \\Delta \\text{HWHM}]$. For example: $[[n_1,\\sigma_1,h_1^{\\text{low}},h_1^{\\text{high}},\\Delta h_1],[n_2,\\sigma_2,h_2^{\\text{low}},h_2^{\\text{high}},\\Delta h_2],[n_3,\\sigma_3,h_3^{\\text{low}},h_3^{\\text{high}},\\Delta h_3]]$.",
            "solution": "The solution is broken down into two main components: first, estimating the parameters of the contrast-response function from data, and second, using these parameters to calculate the orientation tuning bandwidth (Half-Width at Half-Maximum, or HWHM) at different contrast levels for two distinct neuron models.\n\n### Part 1: Parameter Estimation for the Contrast-Response Function\n\nThe relationship between stimulus contrast $C$ and a neuron's response magnitude is modeled by the divisive normalization equation:\n$$\nR(C) = \\frac{C^n}{\\sigma^n + C^n}\n$$\nwhere $R(C)$ is the normalized response, $C$ is the contrast (a dimensionless value from $0$ to $1$), $n$ is an exponent that controls the steepness of the response function, and $\\sigma$ is the semi-saturation constant, representing the contrast at which the response reaches half of its maximum.\n\nFor each test case, we are given a set of measured responses $R_i$ at corresponding contrasts $C_i$. To find the specific parameters $n$ and $\\sigma$ that best describe the neuron's behavior, we perform a nonlinear least-squares regression. The objective is to find the values of $n$ and $\\sigma$ that minimize the sum of squared differences between the model's predictions and the measured data:\n$$\nS(n, \\sigma) = \\sum_{i} \\left( R_i - \\frac{C_i^n}{\\sigma^n + C_i^n} \\right)^2\n$$\nThis optimization problem is solved numerically. A sensible initial guess for the optimization algorithm is essential for robust convergence; typical values from neurophysiology suggest starting with $n$ around $2$ and $\\sigma$ near the midpoint of the tested contrast range, such as $0.3$.\n\n### Part 2: Calculation of Orientation Tuning Bandwidth (HWHM)\n\nOnce the parameters $n$ and $\\sigma$ are determined, they define the contrast-dependent gain of the neuron, $A(C) = R(C)$. This gain term scales the neuron's orientation tuning curve. The orientation sensitivity is given by the von Mises function:\n$$\ns(\\theta) = \\exp\\!\\big(\\kappa(\\cos(\\theta - \\theta_0) - 1)\\big)\n$$\nwhere $\\theta$ is the stimulus orientation in degrees, $\\theta_0$ is the neuron's preferred orientation, and $\\kappa$ is a concentration parameter determining the sharpness of the tuning.\n\nTwo models for the full orientation tuning curve $T(\\theta; C)$ are considered:\n\n1.  **Simple-like Model**: $T_{\\text{simple}}(\\theta; C) = A(C) \\, s(\\theta) + B$, which includes an additive baseline response $B \\ge 0$.\n2.  **Complex-like Model**: $T_{\\text{complex}}(\\theta; C) = A(C) \\, s(\\theta)$, which has no baseline ($B=0$).\n\nThe HWHM is defined as the smallest positive angle $\\Delta$ such that the response at orientation $\\theta_0 \\pm \\Delta$ is half of the maximum response. The maximum response occurs at $\\theta = \\theta_0$, where $s(\\theta_0) = 1$.\n\nFor the simple-like model:\n- Maximum response: $T_{\\text{max}} = T_{\\text{simple}}(\\theta_0; C) = A(C) \\cdot 1 + B = A(C) + B$.\n- Half-maximum response level: $T_{\\text{half-max}} = \\frac{1}{2} T_{\\text{max}} = \\frac{1}{2}(A(C) + B)$.\n\nWe solve for the HWHM, $\\Delta$, by setting $T_{\\text{simple}}(\\theta_0 + \\Delta; C) = T_{\\text{half-max}}$:\n$$\nA(C) \\, s(\\theta_0 + \\Delta) + B = \\frac{1}{2}(A(C) + B)\n$$\nSubstituting $s(\\theta_0 + \\Delta) = \\exp(\\kappa(\\cos(\\Delta) - 1))$ and rearranging gives:\n$$\nA(C) \\exp(\\kappa(\\cos(\\Delta) - 1)) = \\frac{A(C)}{2} - \\frac{B}{2}\n$$\n$$\n\\exp(\\kappa(\\cos(\\Delta) - 1)) = \\frac{1}{2} - \\frac{B}{2A(C)}\n$$\nTaking the natural logarithm of both sides and solving for $\\Delta$:\n$$\n\\kappa(\\cos(\\Delta) - 1) = \\ln\\left(\\frac{1}{2} - \\frac{B}{2A(C)}\\right)\n$$\n$$\n\\cos(\\Delta) = 1 + \\frac{1}{\\kappa} \\ln\\left(\\frac{1}{2} - \\frac{B}{2A(C)}\\right)\n$$\n$$\n\\Delta = \\arccos\\left(1 + \\frac{1}{\\kappa} \\ln\\left(\\frac{1}{2} - \\frac{B}{2A(C)}\\right)\\right)\n$$\nThe resulting angle $\\Delta$ is in radians and must be converted to degrees.\n\nA special condition arises for the simple-like model if the half-maximum level falls below the baseline activity $B$. This occurs when $\\frac{1}{2}(A(C)+B)  B$, which simplifies to $A(C)  B$. In this scenario, the model's response never drops to the half-maximum level, and the HWHM is conventionally defined as $180^\\circ$. This condition also corresponds to the argument of the logarithm becoming non-positive, making the expression for $\\Delta$ mathematically undefined for real numbers.\n\nFor the complex-like model, we set $B = 0$ in the above derivation:\n$$\n\\cos(\\Delta) = 1 + \\frac{1}{\\kappa} \\ln\\left(\\frac{1}{2}\\right) = 1 - \\frac{\\ln(2)}{\\kappa}\n$$\n$$\n\\Delta = \\arccos\\left(1 - \\frac{\\ln(2)}{\\kappa}\\right)\n$$\nNotably, for the complex-like model, the HWHM $\\Delta$ depends only on the tuning sharpness $\\kappa$ and is independent of contrast $C$. This contrast-invariance of tuning bandwidth is a hallmark property of complex cells.\n\n### Computational Procedure Summary\n\nFor each test case provided:\n1.  Use the measured data $(C_i, R_i)$ to perform a nonlinear least-squares fit to the function $R(C) = \\frac{C^n}{\\sigma^n + C^n}$, yielding the optimal parameters $\\hat{n}$ and $\\hat{\\sigma}$.\n2.  For each specified contrast, $C_{\\text{low}}$ and $C_{\\text{high}}$:\n    a. Calculate the gain $A(C)$ using the fitted parameters $\\hat{n}$ and $\\hat{\\sigma}$.\n    b. Apply the appropriate HWHM formula based on the neuron model (simple-like or complex-like) and the parameters $\\kappa$ and $B$. For the simple-like model, check the $A(C)  B$ condition.\n    c. Convert the resulting HWHM from radians to degrees.\n3.  Calculate the difference $\\Delta \\text{HWHM} = \\text{HWHM}(C_{\\text{low}}) - \\text{HWHM}(C_{\\text{high}})$.\n4.  Collect and format the five output values: $[\\hat{n}, \\hat{\\sigma}, \\text{HWHM}_{\\text{low}}, \\text{HWHM}_{\\text{high}}, \\Delta \\text{HWHM}]$.\n\nThis procedure is repeated for all test cases, and the final results are aggregated into a single list of lists.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\n\ndef solve():\n    \"\"\"\n    Solves the problem of modeling V1 neuron responses, fitting parameters for divisive\n    normalization, and predicting tuning bandwidth changes with contrast.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"model\": \"simple\",\n            \"kappa\": 5.0, \"theta0_deg\": 0.0, \"B\": 0.05,\n            \"C_data\": np.array([0.05, 0.1, 0.2, 0.4, 0.8]),\n            \"R_data\": np.array([0.048, 0.183, 0.497, 0.818, 0.948]),\n            \"C_low\": 0.1, \"C_high\": 0.8\n        },\n        {\n            \"model\": \"complex\",\n            \"kappa\": 5.0, \"theta0_deg\": 0.0, \"B\": 0.0,\n            \"C_data\": np.array([0.05, 0.1, 0.2, 0.4, 0.8]),\n            \"R_data\": np.array([0.11, 0.3, 0.635, 0.881, 0.963]),\n            \"C_low\": 0.1, \"C_high\": 0.8\n        },\n        {\n            \"model\": \"simple\",\n            \"kappa\": 5.0, \"theta0_deg\": 0.0, \"B\": 0.07,\n            \"C_data\": np.array([0.05, 0.1, 0.2, 0.4, 0.8]),\n            \"R_data\": np.array([0.025, 0.301, 0.902, 0.997, 0.999]),\n            \"C_low\": 0.1, \"C_high\": 0.8\n        },\n    ]\n\n    results = []\n    \n    def contrast_response_func(C, n, sigma):\n        \"\"\"Divisive normalization contrast-response function.\"\"\"\n        # Add a small epsilon to avoid division by zero or log(0) for C=0\n        C_safe = C + 1e-9\n        sigma_safe = sigma + 1e-9\n        return (C_safe**n) / (sigma_safe**n + C_safe**n)\n\n    def calculate_hwhm(C, n, sigma, kappa, B, model_type):\n        \"\"\"\n        Calculates the Half-Width at Half-Maximum (HWHM) in degrees.\n        \"\"\"\n        gain_A = contrast_response_func(C, n, sigma)\n\n        if model_type == \"simple\":\n            # Condition for HWHM=180: half-max level is below baseline\n            # (A(C) + B)/2  B  =  A(C)  B\n            if gain_A  B:\n                return 180.0\n            \n            # Argument of logarithm must be positive\n            log_arg = 0.5 - B / (2.0 * gain_A)\n            if log_arg = 0:\n                return 180.0\n            \n            arccos_arg = 1.0 + (1.0 / kappa) * np.log(log_arg)\n\n        elif model_type == \"complex\": # B is 0.0\n            arccos_arg = 1.0 - np.log(2.0) / kappa\n        \n        else:\n            raise ValueError(\"Unknown model type\")\n            \n        # Clip to handle potential floating point inaccuracies\n        arccos_arg = np.clip(arccos_arg, -1.0, 1.0)\n        \n        hwhm_rad = np.arccos(arccos_arg)\n        return np.rad2deg(hwhm_rad)\n\n\n    for case in test_cases:\n        # Step 1: Estimate parameters n and sigma by nonlinear regression\n        initial_guess = (2.0, 0.3)\n        bounds = ([0.0, 0.0], [np.inf, np.inf])\n        \n        popt, _ = curve_fit(\n            contrast_response_func, \n            case[\"C_data\"], \n            case[\"R_data\"], \n            p0=initial_guess, \n            bounds=bounds\n        )\n        n_fit, sigma_fit = popt\n\n        # Step 2: Compute predicted HWHM at C_low and C_high\n        hwhm_low = calculate_hwhm(\n            case[\"C_low\"], n_fit, sigma_fit, case[\"kappa\"], case[\"B\"], case[\"model\"]\n        )\n        hwhm_high = calculate_hwhm(\n            case[\"C_high\"], n_fit, sigma_fit, case[\"kappa\"], case[\"B\"], case[\"model\"]\n        )\n        \n        # Step 3: Compute difference and store results\n        delta_hwhm = hwhm_low - hwhm_high\n        \n        case_result = [n_fit, sigma_fit, hwhm_low, hwhm_high, delta_hwhm]\n        results.append(case_result)\n\n    # Format the final output string as specified\n    sublist_strings = [f\"[{','.join(map(str, res))}]\" for res in results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```"
        }
    ]
}