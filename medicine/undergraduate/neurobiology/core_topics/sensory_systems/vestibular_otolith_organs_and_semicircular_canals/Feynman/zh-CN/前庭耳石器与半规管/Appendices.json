{
    "hands_on_practices": [
        {
            "introduction": "三个半规管的巧妙排列使其能作为头部旋转的3D传感器。本练习将引导你通过数学计算，理解任意头部角速度如何投影到每个半规管的敏感轴上。通过解决这个问题，你将具体地理解大脑是如何接收头部运动的分解分量的。",
            "id": "5078236",
            "problem": "单个迷路包含三个半规管：外（水平）半规管、前（上）半规管和后半规管。半规管的敏感轴定义为其平面的单位法向量，并约定半规管的角速度敏感性由头部瞬时角速度矢量在该敏感轴上的投影给出。\n\n采用一个头固定右手坐标系，其单位基向量为 $\\hat{\\boldsymbol{x}}$（向前为正）、$\\hat{\\boldsymbol{y}}$（向左）和 $\\hat{\\boldsymbol{z}}$（向上）。令 Reid 平面与头固定的 $x$–$y$ 平面重合。\n\n假设右侧迷路的三个半规管具有以下理想化但解剖学上一致的朝向模型：\n- 外半规管平面与 Reid 平面重合，因此其敏感轴为 $\\hat{\\boldsymbol{n}}_{L}=\\hat{\\boldsymbol{z}}$。\n- 前半规管平面经过旋转，使其敏感轴 $\\hat{\\boldsymbol{n}}_{A}$ 可通过将 $\\hat{\\boldsymbol{z}}$ 朝平面内单位方向 $\\hat{\\boldsymbol{u}}_{A}=\\frac{1}{\\sqrt{2}}\\left(\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}\\right)$ 旋转角度 $\\theta=\\pi/4$ 得到。\n- 后半规管平面经过旋转，使其敏感轴 $\\hat{\\boldsymbol{n}}_{P}$ 可通过将 $\\hat{\\boldsymbol{z}}$ 朝平面内单位方向 $\\hat{\\boldsymbol{u}}_{P}=\\frac{1}{\\sqrt{2}}\\left(-\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}\\right)$ 旋转相同的角度 $\\theta=\\pi/4$ 得到。\n\n设头部的瞬时角速度在头固定坐标系中表示为 $\\boldsymbol{\\omega}=\\omega_{x}\\hat{\\boldsymbol{x}}+\\omega_{y}\\hat{\\boldsymbol{y}}+\\omega_{z}\\hat{\\boldsymbol{z}}$，单位为弧度/秒。使用刚体运动学和矢量投影，为三个半规管的投影 $s_{L}$、$s_{A}$ 和 $s_{P}$ 推导闭式表达式，其定义为 $s_{i}=\\boldsymbol{\\omega}\\cdot\\hat{\\boldsymbol{n}}_{i}$（$i\\in\\{L,A,P\\}$）。将最终结果表示为一个 $1\\times 3$ 的行矩阵，其元素为用 $\\omega_{x}$、$\\omega_{y}$ 和 $\\omega_{z}$ 表示的 $s_{L}$、$s_{A}$、$s_{P}$。使用精确值（不要对平方根进行近似），并以弧度/秒为单位报告投影值。不需要进行数值舍入。",
            "solution": "该问题陈述具有科学依据、适定、客观，并包含得出唯一解所需的所有信息。它描述了神经生物学和生物力学领域中一个标准的、尽管是理想化的半规管朝向和功能模型。因此，该问题被认为是有效的，并将提供解答。\n\n目标是计算头部瞬时角速度矢量 $\\boldsymbol{\\omega}$ 在右侧迷路三个半规管的敏感轴 $\\hat{\\boldsymbol{n}}_{i}$ 上的投影 $s_{i}$。每个投影的控制方程是标量积（点积）：\n$$s_{i} = \\boldsymbol{\\omega} \\cdot \\hat{\\boldsymbol{n}}_{i}$$\n角速度矢量在头固定坐标系中给出为 $\\boldsymbol{\\omega}=\\omega_{x}\\hat{\\boldsymbol{x}}+\\omega_{y}\\hat{\\boldsymbol{y}}+\\omega_{z}\\hat{\\boldsymbol{z}}$。我们必须首先确定每个敏感轴 $\\hat{\\boldsymbol{n}}_{i}$（$i \\in \\{L, A, P\\}$）在同一坐标系中的矢量表示。\n\n1.  **外半规管投影 ($s_{L}$)**\n    外半规管的敏感轴明确给出为 $\\hat{\\boldsymbol{n}}_{L}=\\hat{\\boldsymbol{z}}$。\n    我们按如下方式计算投影 $s_{L}$：\n    $$s_{L} = \\boldsymbol{\\omega} \\cdot \\hat{\\boldsymbol{n}}_{L} = (\\omega_{x}\\hat{\\boldsymbol{x}}+\\omega_{y}\\hat{\\boldsymbol{y}}+\\omega_{z}\\hat{\\boldsymbol{z}}) \\cdot \\hat{\\boldsymbol{z}}$$\n    利用基向量的标准正交性（$\\hat{\\boldsymbol{x}}\\cdot\\hat{\\boldsymbol{z}}=0$，$\\hat{\\boldsymbol{y}}\\cdot\\hat{\\boldsymbol{z}}=0$，$\\hat{\\boldsymbol{z}}\\cdot\\hat{\\boldsymbol{z}}=1$），表达式简化为：\n    $$s_{L} = \\omega_{x}(0) + \\omega_{y}(0) + \\omega_{z}(1) = \\omega_{z}$$\n\n2.  **前半规管投影 ($s_{A}$)**\n    敏感轴 $\\hat{\\boldsymbol{n}}_{A}$ 是通过将矢量 $\\hat{\\boldsymbol{z}}$ 朝单位方向 $\\hat{\\boldsymbol{u}}_{A}=\\frac{1}{\\sqrt{2}}\\left(\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}\\right)$ 旋转角度 $\\theta=\\pi/4$ 得到的。矢量 $\\hat{\\boldsymbol{z}}$ 和 $\\hat{\\boldsymbol{u}}_{A}$ 是正交的，因为 $\\hat{\\boldsymbol{z}} \\cdot \\hat{\\boldsymbol{u}}_{A} = \\hat{\\boldsymbol{z}} \\cdot \\left(\\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{x}} + \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{y}}\\right) = 0$。\n    将单位矢量 $\\hat{\\boldsymbol{v}}$ 朝一个正交的单位矢量 $\\hat{\\boldsymbol{u}}$ 旋转角度 $\\theta$ 的公式是 $\\hat{\\boldsymbol{v}}_{\\text{rot}} = \\hat{\\boldsymbol{v}}\\cos\\theta + \\hat{\\boldsymbol{u}}\\sin\\theta$。\n    应用此公式，其中 $\\hat{\\boldsymbol{v}}=\\hat{\\boldsymbol{z}}$ 且 $\\hat{\\boldsymbol{u}}=\\hat{\\boldsymbol{u}}_{A}$：\n    $$\\hat{\\boldsymbol{n}}_{A} = \\hat{\\boldsymbol{z}}\\cos\\left(\\frac{\\pi}{4}\\right) + \\hat{\\boldsymbol{u}}_{A}\\sin\\left(\\frac{\\pi}{4}\\right)$$\n    代入数值 $\\cos(\\pi/4) = \\sin(\\pi/4) = \\frac{1}{\\sqrt{2}}$ 以及 $\\hat{\\boldsymbol{u}}_{A}$ 的表达式：\n    $$\\hat{\\boldsymbol{n}}_{A} = \\hat{\\boldsymbol{z}}\\left(\\frac{1}{\\sqrt{2}}\\right) + \\left(\\frac{1}{\\sqrt{2}}(\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}})\\right)\\left(\\frac{1}{\\sqrt{2}}\\right)$$\n    $$\\hat{\\boldsymbol{n}}_{A} = \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}} + \\frac{1}{2}(\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}) = \\frac{1}{2}\\hat{\\boldsymbol{x}} + \\frac{1}{2}\\hat{\\boldsymbol{y}} + \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}}$$\n    现在我们计算投影 $s_{A}$：\n    $$s_{A} = \\boldsymbol{\\omega} \\cdot \\hat{\\boldsymbol{n}}_{A} = (\\omega_{x}\\hat{\\boldsymbol{x}}+\\omega_{y}\\hat{\\boldsymbol{y}}+\\omega_{z}\\hat{\\boldsymbol{z}}) \\cdot \\left(\\frac{1}{2}\\hat{\\boldsymbol{x}} + \\frac{1}{2}\\hat{\\boldsymbol{y}} + \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}}\\right)$$\n    $$s_{A} = \\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z}$$\n\n3.  **后半规管投影 ($s_{P}$)**\n    类似地，敏感轴 $\\hat{\\boldsymbol{n}}_{P}$ 是通过将 $\\hat{\\boldsymbol{z}}$ 朝单位方向 $\\hat{\\boldsymbol{u}}_{P}=\\frac{1}{\\sqrt{2}}\\left(-\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}\\right)$ 旋转角度 $\\theta=\\pi/4$ 得到的。矢量 $\\hat{\\boldsymbol{z}}$ 和 $\\hat{\\boldsymbol{u}}_{P}$ 也是正交的。\n    使用相同的旋转公式：\n    $$\\hat{\\boldsymbol{n}}_{P} = \\hat{\\boldsymbol{z}}\\cos\\left(\\frac{\\pi}{4}\\right) + \\hat{\\boldsymbol{u}}_{P}\\sin\\left(\\frac{\\pi}{4}\\right)$$\n    代入数值：\n    $$\\hat{\\boldsymbol{n}}_{P} = \\hat{\\boldsymbol{z}}\\left(\\frac{1}{\\sqrt{2}}\\right) + \\left(\\frac{1}{\\sqrt{2}}(-\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}})\\right)\\left(\\frac{1}{\\sqrt{2}}\\right)$$\n    $$\\hat{\\boldsymbol{n}}_{P} = \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}} + \\frac{1}{2}(-\\hat{\\boldsymbol{x}}+\\hat{\\boldsymbol{y}}) = -\\frac{1}{2}\\hat{\\boldsymbol{x}} + \\frac{1}{2}\\hat{\\boldsymbol{y}} + \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}}$$\n    现在我们计算投影 $s_{P}$：\n    $$s_{P} = \\boldsymbol{\\omega} \\cdot \\hat{\\boldsymbol{n}}_{P} = (\\omega_{x}\\hat{\\boldsymbol{x}}+\\omega_{y}\\hat{\\boldsymbol{y}}+\\omega_{z}\\hat{\\boldsymbol{z}}) \\cdot \\left(-\\frac{1}{2}\\hat{\\boldsymbol{x}} + \\frac{1}{2}\\hat{\\boldsymbol{y}} + \\frac{1}{\\sqrt{2}}\\hat{\\boldsymbol{z}}\\right)$$\n    $$s_{P} = -\\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z}$$\n\n4.  **最终结果**\n    题目要求将结果表示为包含元素 $s_{L}$、$s_{A}$ 和 $s_{P}$ 的单个 $1\\times 3$ 行矩阵。将 $\\frac{1}{\\sqrt{2}}$ 的分母有理化为 $\\frac{\\sqrt{2}}{2}$ 是常规做法，但题目并未要求；我们将保留推导过程中的形式。各分量为：\n    $$s_{L} = \\omega_{z}$$\n    $$s_{A} = \\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z}$$\n    $$s_{P} = -\\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z}$$\n    将这些组合成一个行矩阵，即可得到最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\omega_{z} & \\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z} & -\\frac{1}{2}\\omega_{x} + \\frac{1}{2}\\omega_{y} + \\frac{1}{\\sqrt{2}}\\omega_{z}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "前庭系统的主要作用是稳定凝视和姿势。本练习探讨了一个经典的前庭-眼动反射（VOR）——眼反向扭转（OCR），它由耳石器官感知头部倾斜所驱动。你将对整个反射弧进行建模，从重力的物理检测到眼睛的最终反向旋转，包括神经增益和饱和等现实的生物学约束。",
            "id": "5078182",
            "problem": "一名受试者绕鼻枕轴进行缓慢的、准静态的侧倾，与地球垂直方向的夹角为 $\\phi$，其中 $\\phi>0$ 表示右耳向下（从后方看为顺时针方向）。耳石器官中的椭圆囊斑检测重力加速度投影到耳间（横向）轴上的分量。半规管编码角速度，因此在准静态条件下对稳态信号没有贡献。假设如下：\n\n- 重力加速度矢量的大小为 $g$，在稳定倾斜期间，由椭圆囊测量的横向投影为 $a_{\\ell} = g \\sin(\\phi)$。\n- 中枢神经系统将耳石信号按 $g$ 进行重新缩放，并反演几何关系以估计倾斜角度：$\\hat{\\phi} = \\arcsin\\!\\big(a_{\\ell}/g\\big)$。\n- 前庭-眼动反射（VOR）的眼反向扭转（OCR）分量将估计的倾斜角度映射到扭转眼位，总中枢增益为 $G$（无量纲），使得指令扭转与 $\\hat{\\phi}$ 成正比，且与头部侧倾的符号相反：$\\theta = -G\\,\\hat{\\phi}$，其中 $\\theta$ 是扭转眼位。\n- 扭转力学和神经约束施加一个对称饱和 $|\\theta| \\leq \\theta_{\\max}$。\n\n基于以上基础，在假设 $|\\phi|  \\pi/2$ 的条件下，推导稳态OCR $\\theta(\\phi)$（以弧度为单位）作为侧倾角 $\\phi$（以弧度为单位）、增益 $G$ 和饱和值 $\\theta_{\\max}$ 的函数的闭式表达式。然后，使用 $G = 0.18$ 和 $\\theta_{\\max} = 7^{\\circ}$，计算在倾斜角为 $\\phi_{1} = 10^{\\circ}$、$\\phi_{2} = 30^{\\circ}$ 和 $\\phi_{3} = 50^{\\circ}$ 时预期的带符号扭转眼位（以度为单位），并采用正 $\\phi$ 引起负 $\\theta$ 的约定。将三个数值结果以度为单位表示，按 $(\\phi_{1}, \\phi_{2}, \\phi_{3})$ 的顺序排列，并将答案四舍五入到四位有效数字。",
            "solution": "椭圆囊斑感知沿耳间轴的重力加速度分量。在除了重力外没有其他线性运动的稳定倾斜状态下，测得的横向加速度由下式给出\n$$\na_{\\ell} = g \\sin(\\phi).\n$$\n通过 $g$ 进行归一化并反演几何关系，得到侧倾的中枢估计值：\n$$\n\\hat{\\phi} = \\arcsin\\!\\left(\\frac{a_{\\ell}}{g}\\right) = \\arcsin\\!\\big(\\sin(\\phi)\\big).\n$$\n对于 $|\\phi|  \\pi/2$，主值满足 $\\arcsin(\\sin(\\phi)) = \\phi$，因此\n$$\n\\hat{\\phi} = \\phi \\quad \\text{for} \\quad |\\phi|  \\pi/2.\n$$\n前庭-眼动反射（VOR）的扭转分量，即眼反向扭转（OCR），与估计的倾斜角成正比，总中枢增益为 $G$，且符号相反（眼睛相对于头部倾斜方向反向旋转）：\n$$\n\\theta_{\\text{cmd}}(\\phi) = -G\\,\\hat{\\phi} = -G\\,\\phi.\n$$\n在生理上，扭转眼位的大小受饱和极限 $\\theta_{\\max}$ 的限制，因此实现的稳态扭转为\n$$\n\\theta(\\phi) = -\\operatorname{sgn}(\\phi)\\,\\min\\!\\big(G\\,|\\phi|,\\ \\theta_{\\max}\\big),\n$$\n其中 $\\phi$ 和 $\\theta$ 的单位是弧度。这个表达式是通过取指令值 $\\theta_{\\text{cmd}}(\\phi)$ 并将其裁剪到区间 $[-\\theta_{\\max},\\ \\theta_{\\max}]$ 内得到的。\n\n接下来，我们根据指定的倾斜角和参数来计算 $\\theta$。题目要求我们以度为单位报告扭转值，并四舍五入到四位有效数字，遵循正 $\\phi$ 引起负 $\\theta$ 的约定。\n\n将饱和值转换为弧度以进行内部计算：\n$$\n\\theta_{\\max} = 7^{\\circ} = 7 \\times \\frac{\\pi}{180}\\ \\text{rad} = \\frac{7\\pi}{180}\\ \\text{rad}.\n$$\n然而，注意到在非饱和情况下存在一个方便的单位关系：如果 $\\theta(\\text{rad}) = -G\\,\\phi(\\text{rad})$，那么将两者都转换为度可得\n$$\n\\theta(\\text{deg}) = \\theta(\\text{rad})\\times\\frac{180}{\\pi} = -G\\,\\phi(\\text{rad})\\times\\frac{180}{\\pi} = -G\\left(\\phi(\\text{deg})\\times\\frac{\\pi}{180}\\right)\\times\\frac{180}{\\pi} = -G\\,\\phi(\\text{deg}).\n$$\n因此，在非饱和区域，以度为单位的OCR数值就是 $-G$ 乘以以度为单位的倾斜数值。\n\n我们对每个倾斜角进行计算：\n\n1. 对于 $\\phi_{1} = 10^{\\circ}$，\n   - 非饱和预测值（以度为单位）：$\\theta_{1,\\text{unsat}} = -G\\,\\phi_{1} = -0.18 \\times 10^{\\circ} = -1.8^{\\circ}$。\n   - 与饱和值比较：$|\\theta_{1,\\text{unsat}}| = 1.8^{\\circ}  7^{\\circ}$，因此没有饱和。\n   - 四舍五入到四位有效数字：$\\theta_{1} = -1.800^{\\circ}$。\n\n2. 对于 $\\phi_{2} = 30^{\\circ}$，\n   - 非饱和预测值（以度为单位）：$\\theta_{2,\\text{unsat}} = -G\\,\\phi_{2} = -0.18 \\times 30^{\\circ} = -5.4^{\\circ}$。\n   - 与饱和值比较：$|\\theta_{2,\\text{unsat}}| = 5.4^{\\circ}  7^{\\circ}$，因此没有饱和。\n   - 四舍五入到四位有效数字：$\\theta_{2} = -5.400^{\\circ}$。\n\n3. 对于 $\\phi_{3} = 50^{\\circ}$，\n   - 非饱和预测值（以度为单位）：$\\theta_{3,\\text{unsat}} = -G\\,\\phi_{3} = -0.18 \\times 50^{\\circ} = -9.0^{\\circ}$。\n   - 与饱和值比较：$|\\theta_{3,\\text{unsat}}| = 9.0^{\\circ} > 7^{\\circ}$，因此响应在边界处饱和。\n   - 应用饱和时的符号约定：$\\theta_{3} = -7.0^{\\circ}$。\n   - 四舍五入到四位有效数字：$\\theta_{3} = -7.000^{\\circ}$。\n\n因此，推导出的函数和所要求的数值（按 $(\\phi_{1}, \\phi_{2}, \\phi_{3})$ 顺序报告）与由耳石驱动的倾斜估计、中枢增益和扭转饱和相符，并且在准静态、稳态条件下，半规管的贡献可以忽略不计。",
            "answer": "$$\\boxed{\\begin{pmatrix}-1.800  -5.400  -7.000\\end{pmatrix}}$$"
        },
        {
            "introduction": "大脑并不依赖于单个神经元，而是从大量神经元群体中解码信息。这个计算练习将深入探讨大脑如何从许多半规管传入神经元的组合活动中重建头部的真实角速度。通过比较一个简单的解码器和一个更复杂的解码器，你将明白为什么大脑的计算策略必须考虑到其神经元群体的具体特性。",
            "id": "5078244",
            "problem": "要求您为半规管传入信号实现一种群体向量解码算法，并量化在非均匀轴分布下的偏差。编码模型应从神经生物学和力学的第一性原理出发：半规管传入神经近似于头部角速度在其解剖轴向上的分量。形式上，对于一个由 $N$ 个传入神经组成的群体，其单位轴向量为 $\\mathbf{u}_i \\in \\mathbb{R}^3$，增益为 $k_i$，则传入神经 $i$ 的瞬时发放响应模型为 $r_i = k_i \\left(\\mathbf{u}_i \\cdot \\boldsymbol{\\omega}\\right)$，其中 $\\boldsymbol{\\omega} \\in \\mathbb{R}^3$ 是头部角速度向量。您的解码应基于群体向量 $\\mathbf{s} = \\sum_{i=1}^{N} r_i \\,\\mathbf{u}_i$，并且您将检验由非均匀轴分布和非均匀增益引入的偏差。\n\n从上述定义和基础线性代数出发，实现以下两种解码器：\n\n- 一个朴素解码器，它假设轴呈均匀分布，并使用基于该假设推导出的标量校准。在各向同性分布（在单位球面上均匀分布）下，$\\mathbf{u}_i \\mathbf{u}_i^\\top$ 的平均值满足 $\\mathbb{E}\\left[\\mathbf{u}\\mathbf{u}^\\top\\right] = \\frac{1}{3}\\mathbf{I}$。利用这一点，朴素校准矩阵为 $\\mathbf{C}_0 = \\bar{k}\\,\\frac{N}{3}\\,\\mathbf{I}$，其中 $\\bar{k}$ 是平均增益。朴素估计值为 $\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} = \\mathbf{C}_0^{-1}\\,\\mathbf{s}$。\n\n- 一个校正解码器，它计算带增益的轴分布的实际二阶矩矩阵 $\\mathbf{M} = \\sum_{i=1}^{N} k_i\\,\\mathbf{u}_i\\,\\mathbf{u}_i^\\top$，然后对其求逆（或伪逆）以获得 $\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} = \\mathbf{M}^{+}\\,\\mathbf{s}$，其中如果 $\\mathbf{M}$ 可逆，则 $\\mathbf{M}^{+}$ 表示其逆矩阵，否则表示 Moore–Penrose 伪逆。\n\n对于下面提供的每个测试用例，计算两种解码器的估计误差的欧几里得范数，即 $\\left\\|\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} - \\boldsymbol{\\omega}\\right\\|_2$ 和 $\\left\\|\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} - \\boldsymbol{\\omega}\\right\\|_2$，并以浮点数形式报告这些值，单位为弧度/秒 (rad/s)。您必须以 rad/s 表示结果。角度（当其作为 $\\boldsymbol{\\omega}$ 的分量出现时）以弧度为单位。不使用百分比；所有标量输出必须是浮点数。\n\n使用以下测试套件，它涵盖了均匀轴分布、非均匀分布、增益异质性以及一个带有奇异矩阵的退化情况：\n\n- 测试用例 1（均匀轴，单位增益）：$\\mathbf{u}_i \\in \\left\\{\\begin{bmatrix}1  0  0\\end{bmatrix}^T, \\begin{bmatrix}-1  0  0\\end{bmatrix}^T, \\begin{bmatrix}0  1  0\\end{bmatrix}^T, \\begin{bmatrix}0  -1  0\\end{bmatrix}^T, \\begin{bmatrix}0  0  1\\end{bmatrix}^T, \\begin{bmatrix}0  0  -1\\end{bmatrix}^T\\right\\}$，$k_i = 1$ 对所有 $i$，$\\boldsymbol{\\omega} = \\begin{bmatrix}0.3  -0.2  0.5\\end{bmatrix}^T$ rad/s。\n\n- 测试用例 2（非均匀轴，单位增益）：$\\mathbf{u}_i \\in \\left\\{\\begin{bmatrix}1  0  0\\end{bmatrix}^T, \\begin{bmatrix}-1  0  0\\end{bmatrix}^T, \\begin{bmatrix}0  1  0\\end{bmatrix}^T, \\begin{bmatrix}0  0  1\\end{bmatrix}^T, \\begin{bmatrix}0  0  1\\end{bmatrix}^T, \\begin{bmatrix}0  0  1\\end{bmatrix}^T\\right\\}$，$k_i = 1$ 对所有 $i$，$\\boldsymbol{\\omega} = \\begin{bmatrix}0.3  -0.2  0.5\\end{bmatrix}^T$ rad/s。\n\n- 测试用例 3（退化共线轴，单位增益）：$\\mathbf{u}_i = \\begin{bmatrix}0  0  1\\end{bmatrix}^T$ 对 $i = 1,\\dots,5$，$k_i = 1$ 对所有 $i$，$\\boldsymbol{\\omega} = \\begin{bmatrix}0.3  -0.2  0.5\\end{bmatrix}^T$ rad/s。\n\n- 测试用例 4（均匀轴，异质增益）：$\\mathbf{u}_i \\in \\left\\{\\begin{bmatrix}1  0  0\\end{bmatrix}^T, \\begin{bmatrix}-1  0  0\\end{bmatrix}^T, \\begin{bmatrix}0  1  0\\end{bmatrix}^T, \\begin{bmatrix}0  -1  0\\end{bmatrix}^T, \\begin{bmatrix}0  0  1\\end{bmatrix}^T, \\begin{bmatrix}0  0  -1\\end{bmatrix}^T\\right\\}$，$\\mathbf{k} = \\begin{bmatrix}2  0.5  1  3  0.8  1.2\\end{bmatrix}^T$，$\\boldsymbol{\\omega} = \\begin{bmatrix}0.1  0.05  -0.2\\end{bmatrix}^T$ rad/s。\n\n- 测试用例 5（可逆但各向异性轴，单位增益）：$\\mathbf{u}_1 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  1  0\\end{bmatrix}^T$，$\\mathbf{u}_2 = \\begin{bmatrix}1  0  0\\end{bmatrix}^T$，$\\mathbf{u}_3 = \\begin{bmatrix}0  1  0\\end{bmatrix}^T$，$\\mathbf{u}_4 = \\begin{bmatrix}0  0  -1\\end{bmatrix}^T$，$\\mathbf{u}_5 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix}0  1  1\\end{bmatrix}^T$，$\\mathbf{u}_6 = \\frac{1}{\\sqrt{2}}\\begin{bmatrix}1  0  1\\end{bmatrix}^T$，$k_i = 1$ 对所有 $i$，$\\boldsymbol{\\omega} = \\begin{bmatrix}-0.4  0.2  0.1\\end{bmatrix}^T$ rad/s。\n\n实现细节：\n\n- 使用 $r_i = k_i \\left(\\mathbf{u}_i \\cdot \\boldsymbol{\\omega}\\right)$，根据定义 $\\mathbf{s} = \\sum_{i=1}^{N} r_i \\,\\mathbf{u}_i$ 直接构建 $\\mathbf{s}$。\n\n- 对于朴素解码器，计算平均增益 $\\bar{k} = \\frac{1}{N}\\sum_{i=1}^{N} k_i$ 并使用 $\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} = \\left(\\frac{3}{N\\,\\bar{k}}\\right)\\mathbf{s}$。\n\n- 对于校正解码器，计算 $\\mathbf{M} = \\sum_{i=1}^{N} k_i\\,\\mathbf{u}_i\\,\\mathbf{u}_i^\\top$，然后使用 $\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} = \\mathbf{M}^{+}\\,\\mathbf{s}$，必要时使用 Moore–Penrose 伪逆。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result1},\\text{result2},\\text{result3}\\right]$）。按顺序对每个测试用例，附加朴素误差，然后是校正误差，两者都以 rad/s 为单位的浮点数表示，因此最终输出包含 5 个测试用例的 10 个浮点数，顺序为 $[\\text{naive}_1,\\text{corr}_1,\\text{naive}_2,\\text{corr}_2,\\dots,\\text{naive}_5,\\text{corr}_5]$。",
            "solution": "用户要求实现并比较两种用于半规管传入信号的群体向量解码算法。分析的核心是量化估计误差，特别是由非均匀感觉轴分布和异质增益引入的偏差。\n\n### 理论基础\n\n该问题植根于神经群体编码的原理，特别是应用于前庭系统感知头部角速度的场景。\n\n**1. 编码模型：**\n单个半规管传入神经元的响应由一个线性方程建模。第 $i$ 个神经元的发放率 $r_i$ 与头部角速度向量 $\\boldsymbol{\\omega}$ 在该神经元特定敏感轴 $\\mathbf{u}_i$ 上的投影成正比。\n\n$$r_i = k_i (\\mathbf{u}_i \\cdot \\boldsymbol{\\omega})$$\n\n这里，$k_i$ 是神经元的增益。该模型在刺激（$\\boldsymbol{\\omega}$）和神经响应（$r_i$）之间建立了一个线性关系。\n\n**2. 群体向量：**\n为了解码刺激，大脑被认为会整合来自整个 $N$ 个神经元群体的信息。一个常见的模型是群体向量 $\\mathbf{s}$，它是偏好方向 $\\mathbf{u}_i$ 的向量和，并由它们各自的发放率 $r_i$ 加权。\n\n$$\\mathbf{s} = \\sum_{i=1}^{N} r_i \\mathbf{u}_i$$\n\n**3. 作为线性系统的解码：**\n我们可以将编码模型代入群体向量的定义中，以建立刺激 $\\boldsymbol{\\omega}$ 和群体向量 $\\mathbf{s}$ 之间的直接联系：\n\n$$\\mathbf{s} = \\sum_{i=1}^{N} \\left( k_i (\\mathbf{u}_i \\cdot \\boldsymbol{\\omega}) \\right) \\mathbf{u}_i$$\n\n使用向量恒等式 $(\\mathbf{a} \\cdot \\mathbf{b})\\mathbf{c} = (\\mathbf{c}\\mathbf{a}^\\top)\\mathbf{b}$，其中 $\\mathbf{u}_i\\mathbf{u}_i^\\top$ 是外积（一个 $3 \\times 3$ 矩阵），我们可以重写该表达式：\n\n$$\\mathbf{s} = \\sum_{i=1}^{N} k_i (\\mathbf{u}_i \\mathbf{u}_i^\\top) \\boldsymbol{\\omega} = \\left( \\sum_{i=1}^{N} k_i \\mathbf{u}_i \\mathbf{u}_i^\\top \\right) \\boldsymbol{\\omega}$$\n\n这揭示了群体向量 $\\mathbf{s}$ 是原始刺激 $\\boldsymbol{\\omega}$ 的一个线性变换。我们记为 $\\mathbf{M}$ 的变换矩阵，捕获了关于群体轴向和增益的完整信息：\n\n$$\\mathbf{M} = \\sum_{i=1}^{N} k_i \\mathbf{u}_i \\mathbf{u}_i^\\top$$\n\n该关系简化为一个矩阵方程：\n$$\\mathbf{s} = \\mathbf{M} \\boldsymbol{\\omega}$$\n\n解码问题现在等同于求解这个关于 $\\boldsymbol{\\omega}$ 的线性方程组。\n\n### 解码器实现\n\n**1. 校正解码器：**\n求解 $\\mathbf{s} = \\mathbf{M} \\boldsymbol{\\omega}$ 以得到 $\\boldsymbol{\\omega}$ 的最直接方法是使用 $\\mathbf{M}$ 的逆矩阵。如果 $\\mathbf{M}$ 不可逆（即，它是奇异的，这种情况发生在传感器轴 $\\mathbf{u}_i$ 无法张成所有三个维度时），该系统没有唯一解。在这种情况下，最小二乘意义下的最佳线性无偏估计量可以通过使用 Moore-Penrose 伪逆（记为 $\\mathbf{M}^{+}$）找到。这给出了校正后的估计值：\n\n$$\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} = \\mathbf{M}^{+} \\mathbf{s}$$\n\n只要 $\\mathbf{M}$ 是可逆的，该解码器将提供完美的重建，即 $\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} = \\boldsymbol{\\omega}$。当 $\\mathbf{M}$ 是奇异的时，它将 $\\boldsymbol{\\omega}$ 投影到由传感器轴张成的子空间上，从而恢复系统实际可以测量的运动分量。\n\n**2. 朴素解码器：**\n朴素解码器在一个强简化假设下运行：传感器轴是各向同性分布的，且增益是均匀的（$\\forall i, k_i = \\bar{k}$）。在这种理想条件下，矩阵 $\\mathbf{M}$ 会简化为单位矩阵 $\\mathbf{I}$ 的一个标量倍数。这基于统计力学的一个结果：对于球面上单位向量 $\\mathbf{u}$ 的均匀分布，其外积的期望值为 $\\mathbb{E}[\\mathbf{u}\\mathbf{u}^\\top] = \\frac{1}{3}\\mathbf{I}$。对 $N$ 个具有平均增益 $\\bar{k}$ 的神经元求和，理想化的矩阵变为：\n\n$$\\mathbf{C}_0 = \\sum_{i=1}^{N} \\bar{k} \\mathbb{E}[\\mathbf{u}\\mathbf{u}^\\top] = N \\bar{k} \\left( \\frac{1}{3} \\mathbf{I} \\right) = \\frac{N\\bar{k}}{3} \\mathbf{I}$$\n\n朴素解码器使用这个理想化矩阵 $\\mathbf{C}_0$ 的逆来估计 $\\boldsymbol{\\omega}$：\n\n$$\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} = \\mathbf{C}_0^{-1} \\mathbf{s} = \\left(\\frac{N\\bar{k}}{3} \\mathbf{I}\\right)^{-1} \\mathbf{s} = \\frac{3}{N\\bar{k}}\\mathbf{I}^{-1}\\mathbf{s} = \\frac{3}{N\\bar{k}}\\mathbf{s}$$\n\n该解码器实质上将群体向量 $\\mathbf{s}$ 视为与 $\\boldsymbol{\\omega}$ 完全对齐，仅相差一个标量因子。当真实矩阵 $\\mathbf{M}$ 不是单位矩阵的倍数时（这在非均匀轴分布或异质增益的情况下发生），这个假设不成立，从而导致系统性的估计误差（偏差）。\n\n### 算法与计算步骤\n\n对于每个测试用例，执行以下步骤：\n1.  **定义输入**：定义角速度 $\\boldsymbol{\\omega}$、包含 $N$ 个轴向量的集合 $\\{\\mathbf{u}_i\\}$ 以及增益集合 $\\{k_i\\}$。\n2.  **计算响应**：计算每个神经元的发放率 $r_i = k_i (\\mathbf{u}_i \\cdot \\boldsymbol{\\omega})$。\n3.  **计算群体向量**：计算群体向量 $\\mathbf{s} = \\sum_{i=1}^{N} r_i \\mathbf{u}_i$。\n4.  **应用朴素解码器**：a. 计算平均增益 $\\bar{k} = \\frac{1}{N}\\sum k_i$。b. 计算朴素估计值：$\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} = \\frac{3}{N\\bar{k}}\\mathbf{s}$。c. 计算朴素误差的欧几里得范数：$\\|\\hat{\\boldsymbol{\\omega}}_{\\text{naive}} - \\boldsymbol{\\omega}\\|_2$。\n5.  **应用校正解码器**：a. 通过对外积求和来构建矩阵 $\\mathbf{M} = \\sum_{i=1}^{N} k_i (\\mathbf{u}_i \\mathbf{u}_i^\\top)$。b. 计算 Moore-Penrose 伪逆 $\\mathbf{M}^{+}$。c. 计算校正估计值：$\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} = \\mathbf{M}^{+} \\mathbf{s}$。d. 计算校正误差的欧几里得范数：$\\|\\hat{\\boldsymbol{\\omega}}_{\\text{corr}} - \\boldsymbol{\\omega}\\|_2$。\n6.  **存储结果**：存储朴素误差和校正误差以备最终输出。\n\n此过程演示了校正解码器如何通过显式计算系统矩阵 $\\mathbf{M}$ 来适应传感器的特定配置，而朴素解码器的性能则随着系统偏离理想的均匀假设而下降。",
            "answer": "$$\n\\boxed{\n[0.000000000000, 0.000000000000, 0.269258240357, 0.000000000000, 1.063014581273, 0.360555127546, 0.108392195254, 0.000000000000, 0.201646279383, 0.000000000000]\n}\n$$"
        }
    ]
}