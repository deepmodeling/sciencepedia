{
    "hands_on_practices": [
        {
            "introduction": "在探索神经元兴奋性的第一步，我们通常将其在静息电位附近的行为简化为一个无源$RC$电路模型。这个练习将帮助你应用欧姆定律的基本原理来计算神经元的输入电阻，这是衡量其对输入电流敏感度的关键参数。通过这个实践，你将掌握如何从一个给定的漏电导和注入电流，计算出稳态的膜电位变化，并确定该线性模型的适用范围 。",
            "id": "5010530",
            "problem": "在全细胞电流钳记录下一个神经元，并假设其在静息膜电位附近表现为具有主导线性漏电的被动阻容 (RC) 膜。在此范围内，该膜可以被建模为一个漏电导与一个膜电容并联。漏电导，记为 $G_{\\text{leak}}$，由独立的电压钳数据估算得出。对于从静息状态开始的足够小的去极化，电压依赖性离子通道的贡献可忽略不计，且电压-电流关系是线性的。响应恒定直流电 (DC) 注入的稳态电压变化定义为 $\\Delta V \\equiv V_{\\infty} - V_{\\text{rest}}$，其中 $V_{\\infty}$ 是在长电流脉冲期间达到的渐近电压。\n\n假设以下基于实验的数值：\n- 漏电导: $G_{\\text{leak}} = 10$ nS。\n- 膜电容: $C_{m} = 150$ pF。\n- 注入的直流电脉冲幅度: $I = 25$ pA。\n- 膜响应的线性范围适用于从静息状态算起最高达 $\\Delta V_{\\text{lin,max}} = 7.5$ mV 的去极化。\n\n使用适用于被动膜和稳态行为的第一性原理，计算：\n1. 由注入电流 $I$ 产生的稳态去极化 $\\Delta V$。\n2. 使响应保持在以 $\\Delta V_{\\text{lin,max}}$ 为特征的线性范围内的最大直流电流 $I_{\\text{max}}$。\n\n将两个数值结果四舍五入到三位有效数字。以 mV 表示 $\\Delta V$，以 pA 表示 $I_{\\text{max}}$。按 $\\Delta V$ 然后 $I_{\\text{max}}$ 的顺序提供这两个数字。",
            "solution": "该物理系统是处于静息电位附近的神经元膜，可以精确地建模为一个由膜电容 $C_m$ 和漏电导 $G_{\\text{leak}}$ 并联组成的被动线性电路。当注入电流 $I$ 时，它在电容支路 ($I_C$) 和电导支路 ($I_R$) 之间分配：\n$$I = I_C + I_R$$\n两个支路中的电流由各自的物理定律定义。通过电容器的电流与电压变化率成正比，通过导体的电流由欧姆定律给出。令 $\\Delta V$ 表示膜电位与静息电位之差，即 $\\Delta V = V(t) - V_{\\text{rest}}$。支路电流为：\n$$I_C = C_m \\frac{d(\\Delta V)}{dt}$$\n$$I_R = G_{\\text{leak}} \\Delta V$$\n将这些结合起来，得到控制膜电压的一阶线性常微分方程：\n$$I = C_m \\frac{d(\\Delta V)}{dt} + G_{\\text{leak}} \\Delta V$$\n问题要求计算稳态条件下的两个量。\n\n首先，我们计算由恒定注入电流 $I$ 引起的稳态去极化 $\\Delta V$。在稳态下，即经过足够长的时间后 ($t \\rightarrow \\infty$)，膜电位不再变化，这意味着系统已达到平衡。在数学上，这个条件表示为：\n$$\\frac{d(\\Delta V)}{dt} = 0$$\n在此条件下，电容电流 $I_C$ 为零。电容器对恒定的直流电来说相当于开路。因此，全部注入电流 $I$ 必须通过漏电导 $G_{\\text{leak}}$。控制方程简化为：\n$$I = G_{\\text{leak}} \\Delta V$$\n求解 $\\Delta V$，我们得到：\n$$\\Delta V = \\frac{I}{G_{\\text{leak}}}$$\n给定值为 $I = 25 \\text{ pA} = 25 \\times 10^{-12} \\text{ A}$ 和 $G_{\\text{leak}} = 10 \\text{ nS} = 10 \\times 10^{-9} \\text{ S}$。将这些值代入方程：\n$$\\Delta V = \\frac{25 \\times 10^{-12} \\text{ A}}{10 \\times 10^{-9} \\text{ S}} = 2.5 \\times 10^{-3} \\text{ V}$$\n按要求，我们将此结果以毫伏 ($mV$) 表示：\n$$\\Delta V = 2.5 \\text{ mV}$$\n问题指出，线性模型在去极化高达 $\\Delta V_{\\text{lin,max}} = 7.5 \\text{ mV}$ 时有效。我们计算出的值 $2.5 \\text{ mV}$ 远在此范围内，这证明了使用被动线性模型的合理性。四舍五入到三位有效数字，结果为 $2.50 \\text{ mV}$。\n\n其次，我们计算使响应保持在指定线性范围内的最大直流电流 $I_{\\text{max}}$。该电流将产生最大允许的稳态去极化 $\\Delta V_{\\text{lin,max}}$。我们使用相同的稳态关系：\n$$I_{\\text{max}} = G_{\\text{leak}} \\Delta V_{\\text{lin,max}}$$\n给定 $G_{\\text{leak}} = 10 \\text{ nS} = 10 \\times 10^{-9} \\text{ S}$ 和 $\\Delta V_{\\text{lin,max}} = 7.5 \\text{ mV} = 7.5 \\times 10^{-3} \\text{ V}$。代入这些值：\n$$I_{\\text{max}} = (10 \\times 10^{-9} \\text{ S}) \\times (7.5 \\times 10^{-3} \\text{ V}) = 75 \\times 10^{-12} \\text{ A}$$\n按要求，我们将此结果以皮安 (pA) 表示：\n$$I_{\\text{max}} = 75 \\text{ pA}$$\n四舍五入到三位有效数字，结果为 $75.0 \\text{ pA}$。\n\n所求值为 $\\Delta V=2.50 \\text{ mV}$ 和 $I_{\\text{max}}=75.0 \\text{ pA}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2.50  75.0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "理想化的模型与真实的电生理实验之间存在差距，其中一个关键的差异便是测量误差的来源。本练习聚焦于全细胞记录中一个常见的系统性误差——液接电位（LJP），它会系统性地偏移所有测得的电压值。通过亲手校正一个假设的记录数据，你将学会如何消除这种伪影，从而获得更准确的静息膜电位和动作电位阈值，这是确保数据可比性和解释可靠性的重要一步 。",
            "id": "5010543",
            "problem": "一个神经元在全细胞电流钳模式下被记录，使用的是填充了基于葡萄糖酸钾的内溶液的硼硅酸盐玻璃吸管。外部浴液是标准的人工脑脊液。在破膜前，放大器相对于浴液电位进行归零，并且不执行任何液接电位校正。\n\n在一次兴奋性实验中，测得的静息膜电位为 $-78.6\\,\\mathrm{mV}$，动作电位阈值通过斜率标准（即 $\\mathrm{d}V/\\mathrm{d}t$ 首次超过 $10\\,\\mathrm{mV/ms}$ 时的电压）在第一个峰电位起始时被确定为 $-62.1\\,\\mathrm{mV}$。基于Henderson方程的估算表明，吸管内溶液和外部浴液之间的液接电位为 $+14.8\\,\\mathrm{mV}$（吸管侧相对于浴液侧为正）。\n\n从膜电位的基本定义以及液接电位在电压测量中的作用出发，确定校正后的静息膜电位和校正后的阈值电压。以 $\\mathrm{mV}$ 为单位表示两个答案，并四舍五入至四位有效数字。按顺序提供这两个数值：校正后的静息膜电位，校正后的阈值电压。",
            "solution": "这个问题的核心在于理解液接电位（LJP）如何在全细胞电压记录中引入系统误差，以及如何对其进行校正。\n\n首先，我们来定义相关的电位。真实的膜电位 $V_m$ 是细胞内部和外部之间的电位差：\n$$V_m = V_{\\text{inside}} - V_{\\text{outside}}$$\n按照惯例，细胞外电位 $V_{\\text{outside}}$ 是参考电位，被设置为 $0\\,\\mathrm{mV}$。因此，$V_m = V_{\\text{inside}}$。\n\n液接电位 $V_{LJP}$ 产生于记录吸管内的电解质溶液与外部浴液之间的界面，原因是带电离子在接界处的不均等扩散速率。它被定义为吸管溶液相对于浴液的电位：\n$$V_{LJP} = V_{\\text{pipette}} - V_{\\text{bath}}$$\n在本问题中，我们已知 $V_{LJP} = +14.8\\,\\mathrm{mV}$。这意味着吸管溶液比浴液正 $14.8\\,\\mathrm{mV}$。\n\n在全细胞电流钳实验中，放大器测量的是吸管内电极与外部浴液中参考电极之间的电位差。标准程序包括在形成全细胞构型之前对放大器进行归零。在这个阶段，吸管尖端在浴液中，尖端两端的唯一电位差就是液接电位（LJP）。当放大器归零时，其电子设备被调整，使得显示的电压为 $0\\,\\mathrm{mV}$，而实际上它测量的是 $V_{LJP}$。这实际上为所有后续测量引入了一个恒定的电压偏移。\n\n设 $V_{true}$ 为被测量的实际电位（例如，膜电位），$V_{meas}$ 为放大器显示的电位。这些量之间的关系由下式给出：\n$$V_{meas} = V_{true} - V_{LJP}$$\n放大器在测量 $V_{LJP}$ 时被归零，因此它会从建立全细胞构型后测量的真实电位中减去这个值。\n\n为了找到真实的或校正后的电位，我们必须重新整理这个方程：\n$$V_{true} = V_{meas} + V_{LJP}$$\n这就是我们将要应用的校正公式。问题陈述中提到，放大器不执行任何自动LJP校正，这就是为什么我们必须手动进行校正。\n\n问题提供了以下测量值：\n- 测得的静息膜电位, $V_{m, meas} = -78.6\\,\\mathrm{mV}$\n- 测得的动作电位阈值, $V_{th, meas} = -62.1\\,\\mathrm{mV}$\n- 液接电位, $V_{LJP} = +14.8\\,\\mathrm{mV}$\n\n我们将校正公式应用于每个测量值。\n\n首先，对于静息膜电位：\n校正后的静息膜电位 $V_{m, corr}$ 是：\n$$V_{m, corr} = V_{m, meas} + V_{LJP}$$\n$$V_{m, corr} = -78.6\\,\\mathrm{mV} + 14.8\\,\\mathrm{mV} = -63.8\\,\\mathrm{mV}$$\n\n其次，对于动作电位阈值：\n校正后的阈值电压 $V_{th, corr}$ 是：\n$$V_{th, corr} = V_{th, meas} + V_{LJP}$$\n$$V_{th, corr} = -62.1\\,\\mathrm{mV} + 14.8\\,\\mathrm{mV} = -47.3\\,\\mathrm{mV}$$\n\n问题要求答案四舍五入至四位有效数字。\n计算出的静息电位是 $-63.8\\,\\mathrm{mV}$。为了用四位有效数字表示，我们写为 $-63.80\\,\\mathrm{mV}$。\n计算出的阈值电压是 $-47.3\\,\\mathrm{mV}$。为了用四位有效数字表示，我们写为 $-47.30\\,\\mathrm{mV}$。\n\n最终校正后的值为静息膜电位 $-63.80\\,\\mathrm{mV}$ 和动作电位阈值 $-47.30\\,\\mathrm{mV}$。答案需要按此顺序提供。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-63.80  -47.30\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了神经元的亚阈值特性后，下一个核心任务是量化其超阈值行为，即动作电位的发放。本练习将引导你分析神经元最重要的输入-输出关系之一：频率-电流（$f$-$I$）曲线。你将通过编程实践，使用两种不同的标准方法——线性外推法和直接阈值插值法——来估算兴奋性的关键指标“基电流”（rheobase），并比较它们之间的差异，从而深入理解数据分析方法对科学结论的潜在影响 。",
            "id": "5010538",
            "problem": "您将获得四个合成的电流钳数据集，这些数据集代表了用于量化神经元兴奋性的标准阶跃方案。对于每个数据集，一个神经元被注入指定幅度的恒定电流阶跃，并记录每个阶跃下观察到的稳态放电频率。您的任务是通过两种方法估计基础电流，然后进行比较：\n\n- 方法A（外推基础电流）：通过对频率-电流（f-I）曲线的准线性部分进行直线拟合，并外推至零频率来估计基础电流。\n- 方法B（直接阶跃阈值）：使用最近的两个测量点之间的线性插值，将基础电流估计为在持续时间为 $T$ 秒的阶跃期间能产生至少一个动作电位的最小电流。\n\n所有电流必须以皮安（pA）为单位报告，放电频率以赫兹（Hz）为单位，时间以秒（s）为单位。所有基础电流估计值和差异均以 pA 为单位报告，并四舍五入到三位小数。\n\n使用的基本原理：\n- 无源膜遵循 $C \\, dV/dt = -g_L (V - E_L) + I_{\\text{inj}} + I_{\\text{nonlinear}}$，其中 $C$ 是膜电容，$g_L$ 是漏电导，$E_L$ 是漏泄逆转电位，$I_{\\text{inj}}$ 是注入电流，$I_{\\text{nonlinear}}$ 聚合了与峰电位产生相关的主动电流。\n- 对于一个恒定阶跃，放电频率 $f$ 由持续时间为 $T$ 的阶跃内的峰电位计数 $N$ 定义为 $f = N/T$（单位为 $\\text{Hz}$）。\n- 基础电流是在稳态条件下引发持续重复放电的最小恒定电流。\n- 在许多神经元中，在中等范围内，稳态频率-电流曲线 $f(I)$ 近似线性；适应和非线性起始动力学可能导致在阈值附近和高电流下出现偏差。\n\n计算要求：\n- 将用于拟合的准线性区域定义为放电频率介于 $0.3 \\, f_{\\text{max}}$ 和 $0.8 \\, f_{\\text{max}}$（含边界）之间的点集，其中 $f_{\\text{max}}$ 是该数据集记录的最大放电频率。\n- 在该区域内，通过普通最小二乘法对 $f$ 与 $I$ 进行直线拟合，并确定最佳拟合线达到零频率时的电流。将此作为外推基础电流的估计值。如果符合条件的点少于两个，或者拟合的斜率为非正数，则该情况下的外推基础电流返回 $\\mathrm{NaN}$。\n- 对于直接阶跃阈值估计，定义产生 $f \\ge 1/T$ 的最小电流 $I_{\\text{dir}}$。如果该阈值位于两个测量点 $(I_k, f_k)$ 和 $(I_{k+1}, f_{k+1})$ 之间，且满足 $f_k < 1/T \\le f_{k+1}$，则通过在这两个点之间进行线性插值来估计 $I_{\\text{dir}}$。如果在给定范围内不存在这样的交叉点，则该情况下的直接阈值返回 $\\mathrm{NaN}$。\n\n测试套件：\n对于每个数据集，使用给定的注入电流和测量的稳态放电频率数组，以及阶跃持续时间 $T$。\n\n- 情况 1：\n  - 注入电流 $I$（单位 pA）：$[0,20,40,60,80,100,120,140]$\n  - 测量的稳态放电频率 $f$（单位 Hz）：$[0.0,0.0,0.0,0.0,10.3,19.8,30.5,38.9]$\n  - 阶跃持续时间 $T$（单位 s）：$1.0$\n\n- 情况 2：\n  - 注入电流 $I$（单位 pA）：$[40,60,80,90,100,110,130]$\n  - 测量的稳态放电频率 $f$（单位 Hz）：$[0.0,0.0,0.0,15.8,22.4,27.4,35.3]$\n  - 阶跃持续时间 $T$（单位 s）：$2.0$\n\n- 情况 3：\n  - 注入电流 $I$（单位 pA）：$[50,70,90,110,130,150,170]$\n  - 测量的稳态放电频率 $f$（单位 Hz）：$[0.0,0.0,0.0,12.0,24.0,30.0,36.0]$\n  - 阶跃持续时间 $T$（单位 s）：$1.0$\n\n- 情况 4：\n  - 注入电流 $I$（单位 pA）：$[40,50,60,70,80,90]$\n  - 测量的稳态放电频率 $f$（单位 Hz）：$[0.0,0.0,4.0,8.0,12.0,16.0]$\n  - 阶跃持续时间 $T$（单位 s）：$0.2$\n\n每个情况需要计算的内容：\n- 通过对 $0.3$ 至 $0.8$ $f_{\\text{max}}$ 区间进行线性拟合得到的外推基础电流 $I_{\\text{rheo}}^{\\text{fit}}$（单位 pA）。\n- 基于准则 $f \\ge 1/T$ 并使用相邻数据点之间的线性插值得到的直接阶跃阈值电流 $I_{\\text{dir}}$（单位 pA）。\n- 差异 $\\Delta I$（单位 pA），定义为 $\\Delta I = I_{\\text{rheo}}^{\\text{fit}} - I_{\\text{dir}}$，如果外推基础电流超过直接阈值，则为正值。\n\n本问题不使用角度单位。所有电流均以 pA 表示，并四舍五入到三位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 具体来说，输出一个列表的列表，每个内部列表对应一个情况，并按上述情况的顺序排列。每个内部列表必须包含三个以 pA 为单位的浮点数：$[I_{\\text{rheo}}^{\\text{fit}}, I_{\\text{dir}}, \\Delta I]$，每个数都四舍五入到三位小数。\n- 如果任何量未定义，则使用 $\\mathrm{NaN}$ 代替。\n- 示例结构格式（仅作说明）：$[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$，其中每个 $x_i$、$y_i$、$z_i$ 的单位都是 pA。",
            "solution": "任务是为四个数据集计算基础电流的两种估计值及其差异。方法是：（A）通过对频率-电流（$f$-$I$）曲线进行线性拟合外推，以及（B）通过插值找到触发至少一个动作电位的电流阈值。\n\n以下程序将应用于每个数据集。\n\n**方法 A：外推基础电流 ($I_{\\text{rheo}}^{\\text{fit}}$)**\n\n此方法通过识别 $f$-$I$ 曲线的准线性部分，并外推最佳拟合线至零频率来估计基础电流。\n\n1.  给定一组测量数据点 $(I_i, f_i)$，确定最大记录放电频率 $f_{\\text{max}} = \\max_i(f_i)$。\n2.  准线性区域由放电频率 $f_j$ 满足条件 $0.3 \\, f_{\\text{max}} \\le f_j \\le 0.8 \\, f_{\\text{max}}$ 的点 $(I_j, f_j)$ 定义。\n3.  如果该区域中的点数少于两个，则认为拟合不成立，并将 $I_{\\text{rheo}}^{\\text{fit}}$ 设置为非数字（$\\mathrm{NaN}$）。\n4.  对于选定的点，使用普通最小二乘法（OLS）拟合形式为 $f = mI + c$ 的直线。斜率 $m$ 和截距 $c$ 计算如下：\n    $$m = \\frac{n \\sum(I_j f_j) - (\\sum I_j)(\\sum f_j)}{n \\sum(I_j^2) - (\\sum I_j)^2}$$\n    $$c = \\bar{f} - m \\bar{I}$$\n    其中 $n$ 是线性区域中的点数，$\\bar{I}$ 和 $\\bar{f}$ 分别是这些点的平均电流和频率。\n5.  如果拟合的斜率 $m$ 为非正数（$m \\le 0$），则结果在生理学上与兴奋性反应不一致，并将 $I_{\\text{rheo}}^{\\text{fit}}$ 设置为 $\\mathrm{NaN}$。\n6.  外推基础电流 $I_{\\text{rheo}}^{\\text{fit}}$ 是拟合线与频率轴在 $f=0$ 处相交时的电流 $I$。\n    $$I_{\\text{rheo}}^{\\text{fit}} = -\\frac{c}{m}$$\n\n**方法 B：直接阶跃阈值 ($I_{\\text{dir}}$)**\n\n此方法估计在持续时间为 $T$ 的电流阶跃期间引发至少一个峰电位所需的阈值电流。\n\n1.  在时间间隔 $T$ 内触发至少一个峰电位（$N \\ge 1$）的条件等效于放电频率 $f = N/T \\ge 1/T$。设此阈值频率为 $f_{\\text{thresh}} = 1/T$。\n2.  扫描数据集以找到两个相邻的测量点 $(I_k, f_k)$ 和 $(I_{k+1}, f_{k+1})$，它们将此阈值包含在内，即 $f_k < f_{\\text{thresh}} \\le f_{k+1}$。\n3.  如果在提供的数据范围内不存在这样一对点，则无法确定直接阈值，并将 $I_{\\text{dir}}$ 设置为 $\\mathrm{NaN}$。\n4.  直接阶跃阈值电流 $I_{\\text{dir}}$ 是通过在这两个点之间执行线性插值来估计的，以找到对应于 $f_{\\text{thresh}}$ 的电流。\n    $$I_{\\text{dir}} = I_k + (I_{k+1} - I_k) \\frac{f_{\\text{thresh}} - f_k}{f_{k+1} - f_k}$$\n\n**差异计算**\n\n两种估计值之间的差异 $\\Delta I$ 计算如下：\n$$\\Delta I = I_{\\text{rheo}}^{\\text{fit}} - I_{\\text{dir}}$$\n\n所有结果均以皮安（$\\mathrm{pA}$）报告，并四舍五入到三位小数。我们现在将此方法应用于每个情况。\n\n**情况 1**\n- 注入电流 $I$：$[0, 20, 40, 60, 80, 100, 120, 140]\\, \\mathrm{pA}$\n- 放电频率 $f$：$[0.0, 0.0, 0.0, 0.0, 10.3, 19.8, 30.5, 38.9]\\, \\mathrm{Hz}$\n- 阶跃持续时间 $T$：$1.0\\, \\mathrm{s}$\n\n- **方法 A：**\n    - $f_{\\text{max}} = 38.9\\, \\mathrm{Hz}$。\n    - 线性区域范围：$[0.3 \\times 38.9, 0.8 \\times 38.9] = [11.67, 31.12]\\, \\mathrm{Hz}$。\n    - 区域内的点：$(100, 19.8)$ 和 $(120, 30.5)$。有两个点。\n    - 对这两点进行 OLS 拟合，得到直线 $f = mI + c$。\n    - 斜率 $m = (30.5 - 19.8) / (120 - 100) = 10.7 / 20 = 0.535$。由于 $m > 0$，我们继续。\n    - 截距 $c = 19.8 - 0.535 \\times 100 = -33.7$。\n    - $I_{\\text{rheo}}^{\\text{fit}} = -c/m = -(-33.7) / 0.535 \\approx 62.99065\\, \\mathrm{pA}$。\n\n- **方法 B：**\n    - 阈值频率 $f_{\\text{thresh}} = 1/T = 1/1.0 = 1.0\\, \\mathrm{Hz}$。\n    - 包围点是 $(I_k, f_k) = (60, 0.0)$ 和 $(I_{k+1}, f_{k+1}) = (80, 10.3)$，因为 $0.0 < 1.0 \\le 10.3$。\n    - $I_{\\text{dir}} = 60 + (80 - 60) \\frac{1.0 - 0.0}{10.3 - 0.0} = 60 + 20 \\times (1.0/10.3) \\approx 61.94175\\, \\mathrm{pA}$。\n\n- **差异：**\n    - $\\Delta I = 62.99065 - 61.94175 = 1.04890\\, \\mathrm{pA}$。\n\n- **结果（四舍五入）：** $I_{\\text{rheo}}^{\\text{fit}} = 62.991\\, \\mathrm{pA}$，$I_{\\text{dir}} = 61.942\\, \\mathrm{pA}$，$\\Delta I = 1.049\\, \\mathrm{pA}$。\n\n**情况 2**\n- 注入电流 $I$：$[40, 60, 80, 90, 100, 110, 130]\\, \\mathrm{pA}$\n- 放电频率 $f$：$[0.0, 0.0, 0.0, 15.8, 22.4, 27.4, 35.3]\\, \\mathrm{Hz}$\n- 阶跃持续时间 $T$：$2.0\\, \\mathrm{s}$\n\n- **方法 A：**\n    - $f_{\\text{max}} = 35.3\\, \\mathrm{Hz}$。\n    - 线性区域范围：$[0.3 \\times 35.3, 0.8 \\times 35.3] = [10.59, 28.24]\\, \\mathrm{Hz}$。\n    - 区域内的点：$(90, 15.8)$、$(100, 22.4)$、$(110, 27.4)$。有三个点。\n    - 对这些点进行 OLS 拟合得到 $m \\approx 0.58$ 和 $c \\approx -36.1333$。由于 $m > 0$，我们继续。\n    - $I_{\\text{rheo}}^{\\text{fit}} = -c/m \\approx -(-36.1333) / 0.58 \\approx 62.29885\\, \\mathrm{pA}$。\n\n- **方法 B：**\n    - 阈值频率 $f_{\\text{thresh}} = 1/T = 1/2.0 = 0.5\\, \\mathrm{Hz}$。\n    - 包围点是 $(80, 0.0)$ 和 $(90, 15.8)$，因为 $0.0 < 0.5 \\le 15.8$。\n    - $I_{\\text{dir}} = 80 + (90 - 80) \\frac{0.5 - 0.0}{15.8 - 0.0} = 80 + 10 \\times (0.5/15.8) \\approx 80.31646\\, \\mathrm{pA}$。\n\n- **差异：**\n    - $\\Delta I = 62.29885 - 80.31646 \\approx -18.01761\\, \\mathrm{pA}$。\n\n- **结果（四舍五入）：** $I_{\\text{rheo}}^{\\text{fit}} = 62.299\\, \\mathrm{pA}$，$I_{\\text{dir}} = 80.316\\, \\mathrm{pA}$，$\\Delta I = -18.018\\, \\mathrm{pA}$。\n\n**情况 3**\n- 注入电流 $I$：$[50, 70, 90, 110, 130, 150, 170]\\, \\mathrm{pA}$\n- 放电频率 $f$：$[0.0, 0.0, 0.0, 12.0, 24.0, 30.0, 36.0]\\, \\mathrm{Hz}$\n- 阶跃持续时间 $T$：$1.0\\, \\mathrm{s}$\n\n- **方法 A：**\n    - $f_{\\text{max}} = 36.0\\, \\mathrm{Hz}$。\n    - 线性区域范围：$[0.3 \\times 36.0, 0.8 \\times 36.0] = [10.8, 28.8]\\, \\mathrm{Hz}$。\n    - 区域内的点：$(110, 12.0)$ 和 $(130, 24.0)$。有两个点。\n    - OLS 拟合：$m = (24.0 - 12.0) / (130 - 110) = 12.0 / 20 = 0.6$。由于 $m > 0$，我们继续。\n    - $c = 12.0 - 0.6 \\times 110 = -54.0$。\n    - $I_{\\text{rheo}}^{\\text{fit}} = -(-54.0) / 0.6 = 90.000\\, \\mathrm{pA}$。\n\n- **方法 B：**\n    - 阈值频率 $f_{\\text{thresh}} = 1/T = 1/1.0 = 1.0\\, \\mathrm{Hz}$。\n    - 包围点是 $(90, 0.0)$ 和 $(110, 12.0)$，因为 $0.0 < 1.0 \\le 12.0$。\n    - $I_{\\text{dir}} = 90 + (110 - 90) \\frac{1.0 - 0.0}{12.0 - 0.0} = 90 + 20 \\times (1.0/12.0) \\approx 91.66667\\, \\mathrm{pA}$。\n\n- **差异：**\n    - $\\Delta I = 90.000 - 91.66667 = -1.66667\\, \\mathrm{pA}$。\n\n- **结果（四舍五入）：** $I_{\\text{rheo}}^{\\text{fit}} = 90.000\\, \\mathrm{pA}$，$I_{\\text{dir}} = 91.667\\, \\mathrm{pA}$，$\\Delta I = -1.667\\, \\mathrm{pA}$。\n\n**情况 4**\n- 注入电流 $I$：$[40, 50, 60, 70, 80, 90]\\, \\mathrm{pA}$\n- 放电频率 $f$：$[0.0, 0.0, 4.0, 8.0, 12.0, 16.0]\\, \\mathrm{Hz}$\n- 阶跃持续时间 $T$：$0.2\\, \\mathrm{s}$\n\n- **方法 A：**\n    - $f_{\\text{max}} = 16.0\\, \\mathrm{Hz}$。\n    - 线性区域范围：$[0.3 \\times 16.0, 0.8 \\times 16.0] = [4.8, 12.8]\\, \\mathrm{Hz}$。\n    - 区域内的点：$(70, 8.0)$ 和 $(80, 12.0)$。有两个点。\n    - OLS 拟合：$m = (12.0 - 8.0) / (80 - 70) = 4.0 / 10 = 0.4$。由于 $m > 0$，我们继续。\n    - $c = 8.0 - 0.4 \\times 70 = -20.0$。\n    - $I_{\\text{rheo}}^{\\text{fit}} = -(-20.0) / 0.4 = 50.000\\, \\mathrm{pA}$。\n\n- **方法 B：**\n    - 阈值频率 $f_{\\text{thresh}} = 1/T = 1/0.2 = 5.0\\, \\mathrm{Hz}$。\n    - 包围点是 $(60, 4.0)$ 和 $(70, 8.0)$，因为 $4.0 < 5.0 \\le 8.0$。\n    - $I_{\\text{dir}} = 60 + (70 - 60) \\frac{5.0 - 4.0}{8.0 - 4.0} = 60 + 10 \\times (1.0/4.0) = 62.500\\, \\mathrm{pA}$。\n\n- **差异：**\n    - $\\Delta I = 50.000 - 62.500 = -12.500\\, \\mathrm{pA}$。\n\n- **结果（四舍五入）：** $I_{\\text{rheo}}^{\\text{fit}} = 50.000\\, \\mathrm{pA}$，$I_{\\text{dir}} = 62.500\\, \\mathrm{pA}$，$\\Delta I = -12.500\\, \\mathrm{pA}$。\n\n计算现已完成，并将在最终程序中实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Solves the neuronal excitability problem for four test cases.\n    For each case, it computes the extrapolated rheobase (I_rheo_fit),\n    the direct step-threshold (I_dir), and their discrepancy (Delta_I).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"I\": np.array([0, 20, 40, 60, 80, 100, 120, 140]),\n            \"f\": np.array([0.0, 0.0, 0.0, 0.0, 10.3, 19.8, 30.5, 38.9]),\n            \"T\": 1.0,\n        },\n        {\n            \"I\": np.array([40, 60, 80, 90, 100, 110, 130]),\n            \"f\": np.array([0.0, 0.0, 0.0, 15.8, 22.4, 27.4, 35.3]),\n            \"T\": 2.0,\n        },\n        {\n            \"I\": np.array([50, 70, 90, 110, 130, 150, 170]),\n            \"f\": np.array([0.0, 0.0, 0.0, 12.0, 24.0, 30.0, 36.0]),\n            \"T\": 1.0,\n        },\n        {\n            \"I\": np.array([40, 50, 60, 70, 80, 90]),\n            \"f\": np.array([0.0, 0.0, 4.0, 8.0, 12.0, 16.0]),\n            \"T\": 0.2,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        I_data, f_data, T = case[\"I\"], case[\"f\"], case[\"T\"]\n\n        # --- Method A: Extrapolated Rheobase (I_rheo_fit) ---\n        I_rheo_fit = np.nan\n        if f_data.any(): # check if there is any non-zero firing\n            f_max = np.max(f_data)\n            lower_bound = 0.3 * f_max\n            upper_bound = 0.8 * f_max\n            \n            # Select points in the quasi-linear region\n            mask = (f_data >= lower_bound) & (f_data <= upper_bound)\n            I_fit = I_data[mask]\n            f_fit = f_data[mask]\n            \n            if len(f_fit) >= 2:\n                # Perform ordinary least squares regression\n                lin_reg_result = stats.linregress(I_fit, f_fit)\n                slope = lin_reg_result.slope\n                intercept = lin_reg_result.intercept\n                \n                if slope > 0:\n                    I_rheo_fit = -intercept / slope\n\n        # --- Method B: Direct Step-Threshold (I_dir) ---\n        I_dir = np.nan\n        f_thresh = 1.0 / T\n        \n        # Find indices where the frequency crosses the threshold\n        cross_indices = np.where((f_data[:-1] < f_thresh) & (f_data[1:] >= f_thresh))[0]\n        \n        if cross_indices.size > 0:\n            k = cross_indices[0]\n            I_k, f_k = I_data[k], f_data[k]\n            I_k1, f_k1 = I_data[k+1], f_data[k+1]\n            \n            # Linear interpolation\n            if f_k1 - f_k > 0: # Avoid division by zero\n                I_dir = I_k + (I_k1 - I_k) * (f_thresh - f_k) / (f_k1 - f_k)\n        \n        # --- Discrepancy (Delta I) ---\n        if np.isnan(I_rheo_fit) or np.isnan(I_dir):\n            delta_I = np.nan\n        else:\n            delta_I = I_rheo_fit - I_dir\n            \n        results.append([I_rheo_fit, I_dir, delta_I])\n\n    # --- Format Output ---\n    def format_num(n):\n        if np.isnan(n):\n            return \"NaN\"\n        return f\"{n:.3f}\"\n\n    inner_strings = []\n    for res_list in results:\n        formatted_list = [format_num(n) for n in res_list]\n        inner_strings.append(f\"[{','.join(formatted_list)}]\")\n\n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}