{
    "hands_on_practices": [
        {
            "introduction": "渗透压调节是稳态的经典范例。我们可以用一个简单的数学模型来描述血浆渗透压（刺激）与精氨酸血管加压素（AVP）释放（响应）之间的关系。这个练习将帮助你巩固稳态设定点（阈值）和比例增益（斜率）等基本概念，这是理解任何生理控制系统的基础。",
            "id": "5026098",
            "problem": "精氨酸加压素（AVP）由下丘脑渗透压感受神经元检测到高渗透压后，从垂体后叶释放。这种稳态控制的一个普遍观察到的特性是存在一个设定点（阈值）渗透压，低于该值时 AVP 的释放和血浆浓度可忽略不计；高于该阈值时，AVP 浓度与渗透压误差成比例增加，其特征为一个增益（斜率），该增益将渗透压误差映射到激素浓度。假设以下生物物理和生理条件成立：\n- 阈值（设定点）血浆渗透压为 $280$ mOsm/kg，低于此值时，稳态血浆 AVP 浓度约为 $0$ pg/mL。\n- 高于该阈值时，稳态血浆 AVP 浓度随渗透压误差线性增加，斜率为 $0.6$ pg/mL 每 mOsm/kg。\n- 在所考虑的时间尺度上，系统以准稳态运行，因此在恒定渗透压下，血浆 AVP 浓度与释放速率成正比。\n血浆渗透压从 $290$ mOsm/kg 上升到 $300$ mOsm/kg。利用上述设定点和增益的控制观点，确定在最终渗透压为 $300$ mOsm/kg 时的预期稳态血浆 AVP 浓度。答案以 pg/mL 为单位表示。无需四舍五入。",
            "solution": "在尝试给出解答之前，将根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 阈值（设定点）血浆渗透压, $O_{threshold}$：$280$ mOsm/kg。\n- 渗透压 $\\le O_{threshold}$ 时的稳态血浆 AVP 浓度：约 $0$ pg/mL。\n- 高于阈值的关系：稳态血浆 AVP 浓度随渗透压误差线性增加。\n- 该线性关系的斜率（增益）, $k$：$0.6$ pg/mL 每 mOsm/kg。\n- 假设：系统在准稳态下运行。\n- 初始血浆渗透压：$290$ mOsm/kg。\n- 最终血浆渗透压, $O_{final}$：$300$ mOsm/kg。\n- 目标：确定在最终渗透压为 $300$ mOsm/kg 时的稳态血浆 AVP 浓度。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题描述了一个公认的、简化的线性模型，用于精氨酸加压素（AVP）释放的渗透压调节。设定点（阈值）和增益（斜率）的概念是生理控制系统的基础。提供的阈值渗透压（$280$ mOsm/kg）、增益（$0.6$ pg/mL 每 mOsm/kg）以及生理渗透压范围（$290$ 到 $300$ mOsm/kg）的数值与标准医学和生理学文献中的数据一致。该问题是控制理论原理在神经内分泌学中的一个有效应用。\n- **适定性**：问题陈述清晰，提供了构建血浆渗透压与 AVP 浓度之间数学关系所需的所有参数。它要求基于所提供的模型计算一个具体值，并且存在唯一解。\n- **客观性**：问题以精确、定量的语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n该问题被认为是**有效的**，因为它具有科学依据、适定、客观且完整。将提供解答。\n\n### 解答\n\n根据所提供的信息，稳态血浆 AVP 浓度（表示为 $C_{AVP}$）与血浆渗透压（表示为 $O$）之间的关系可以建模为一个分段线性函数。\n\n设阈值渗透压为 $O_{threshold} = 280 \\text{ mOsm/kg}$。\n设增益（斜率）为 $k = 0.6 \\text{ pg/mL per mOsm/kg}$。\n\n根据问题描述：\n1.  对于血浆渗透压低于或等于阈值（$O \\le O_{threshold}$）的情况，AVP 浓度可以忽略不计。我们可以将其建模为：\n    $$C_{AVP}(O) = 0 \\quad \\text{for } O \\le 280$$\n2.  对于血浆渗透压高于阈值（$O > O_{threshold}$）的情况，AVP 浓度线性增加。“渗透压误差”是当前渗透压与阈值之差，即 $(O - O_{threshold})$。AVP 浓度与此误差成正比，比例常数为增益 $k$。这定义了一个线性函数：\n    $$C_{AVP}(O) = k \\cdot (O - O_{threshold}) \\quad \\text{for } O > 280$$\n\n综合这两个条件，得到稳态 AVP 浓度作为血浆渗透压函数的分段函数表达式为：\n$$\nC_{AVP}(O) = \\begin{cases}\n0  \\text{if } O \\le 280 \\text{ mOsm/kg} \\\\\n0.6 \\cdot (O - 280)  \\text{if } O > 280 \\text{ mOsm/kg}\n\\end{cases}\n$$\n这里，$C_{AVP}$ 的单位是 pg/mL，$O$ 的单位是 mOsm/kg。\n\n问题要求计算最终渗透压为 $O_{final} = 300 \\text{ mOsm/kg}$ 时的稳态血浆 AVP 浓度。首先，我们必须通过比较 $O_{final}$ 和 $O_{threshold}$ 来确定使用分段函数的哪一部分。\n\n已知 $O_{final} = 300 \\text{ mOsm/kg}$ 且 $O_{threshold} = 280 \\text{ mOsm/kg}$。\n由于 $300 > 280$，血浆渗透压高于阈值。因此，我们使用定义函数的第二部分：\n$$C_{AVP}(O_{final}) = k \\cdot (O_{final} - O_{threshold})$$\n\n代入给定的数值：\n$$C_{AVP}(300) = 0.6 \\cdot (300 - 280)$$\n\n首先，计算渗透压误差：\n$$300 - 280 = 20 \\text{ mOsm/kg}$$\n\n现在，将此误差乘以增益，求出 AVP 浓度：\n$$C_{AVP}(300) = 0.6 \\cdot 20$$\n$$C_{AVP}(300) = 12$$\n\n最终单位为 $(\\text{pg/mL per mOsm/kg}) \\times (\\text{mOsm/kg}) = \\text{pg/mL}$，这正是浓度所要求的单位。关于初始渗透压为 $290$ mOsm/kg 的信息对于计算最终稳态浓度是多余的，因为最终稳态浓度仅取决于最终渗透压。\n\n因此，在渗透压为 $300$ mOsm/kg 时，预期的稳态血浆 AVP 浓度为 $12$ pg/mL。",
            "answer": "$$\\boxed{12}$$"
        },
        {
            "introduction": "稳态系统并非瞬时响应；它们包含时间延迟，这对其行为至关重要。本练习将体温调节作为一个动态反馈回路进行探索，并引入稳定性的关键概念。 通过运用控制理论的工具，我们将研究为何过于“激进”的校正（即过高的系统增益）会导致系统振荡甚至失控，这是生物调节中的一个核心限制。",
            "id": "5026254",
            "problem": "在下丘脑体温调节中，核心温度与设定点的偏差由温度感受器检测，并传递给下丘脑，下丘脑驱动效应器反应（例如，出汗或颤抖）以恢复体内平衡。考虑此负反馈回路的一个线性化小信号模型，其中下丘脑作为一个积分控制器，随时间对温度误差进行积分；效应器通路具有一阶激活动态；身体的热质量和向环境的散热构成了一阶温度动态。设前向路径传递函数为 $G(s) = K \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s T_{e}} \\cdot \\frac{\\beta}{1 + s T_{b}}$，其中 $K$ 是一个无量纲的下丘脑增益，$T_{e}$ 是效应器时间常数，$T_{b}$ 是身体热时间常数，$\\beta$ 是一个无量纲的静态增益，表示从效应器驱动到温度变化的转换。假设单位反馈 $H(s) = 1$。\n\n从负反馈和线性系统稳定性的核心原理出发，针对由 $G(s)H(s)$ 控制的闭环传递函数，使用 Routh–Hurwitz 方法对闭环的特征多项式推导关于 $K$ 的稳定性判据。然后，对于 $T_{e} = 60 \\ \\text{s}$，$T_{b} = 1200 \\ \\text{s}$ 和 $\\beta = 0.05$，计算保证闭环稳定性的最大允许 $K$ 值。\n\n使用推导出的判据和第一性原理，从机理上解释为何足够大的 $K$ 会在此体温调节回路中产生振荡或不稳定性。\n\n将最大允许增益 $K$ 的最终数值表示为无量纲数，并四舍五入至四位有效数字。",
            "solution": "对问题陈述进行分析，认定其有效。该问题提出了一个应用于生理性体温调节简化模型的、在线性系统控制理论中适定的问题。其前提具有科学依据，且为推导解法提供了完整一致的信息。\n\n闭环系统的稳定性由其特征方程的根决定，该方程为 $1 + G(s)H(s) = 0$。给定前向路径传递函数 $G(s) = K \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s T_{e}} \\cdot \\frac{\\beta}{1 + s T_{b}}$ 和单位反馈 $H(s) = 1$，特征方程为：\n$$\n1 + K \\cdot \\frac{1}{s} \\cdot \\frac{1}{1 + s T_{e}} \\cdot \\frac{\\beta}{1 + s T_{b}} = 0\n$$\n为得到特征多项式，我们消去分母：\n$$\ns(1 + s T_{e})(1 + s T_{b}) + K\\beta = 0\n$$\n展开括号内的项得到：\n$$\ns(1 + s T_{b} + s T_{e} + s^2 T_{e}T_{b}) + K\\beta = 0\n$$\n将开头的 $s$ 项分配进去，得到以 $s$ 的幂次表示的特征多项式：\n$$\ns + (T_{e} + T_{b})s^2 + T_{e}T_{b}s^3 + K\\beta = 0\n$$\n将其按 $s$ 的降幂排列，我们得到一个三阶多项式：\n$$\n(T_{e}T_{b})s^3 + (T_{e} + T_{b})s^2 + (1)s^1 + (K\\beta)s^0 = 0\n$$\n其形式为 $a_3 s^3 + a_2 s^2 + a_1 s + a_0 = 0$，系数如下：\n$a_3 = T_{e}T_{b}$\n$a_2 = T_{e} + T_{b}$\n$a_1 = 1$\n$a_0 = K\\beta$\n\n为使系统稳定，Routh-Hurwitz 判据要求特征多项式的所有根都必须有负实部。对于一个三阶系统，这需要满足两个条件：\n1. 所有系数（$a_3, a_2, a_1, a_0$）必须为正。\n2. 不等式 $a_2 a_1 > a_3 a_0$ 必须成立。\n\n首先，我们检查系数的正性。时间常数 $T_{e}$ 和 $T_{b}$ 是物理量，必须为正。增益 $K$ 和 $\\beta$ 也给定为正值。因此，$a_3 = T_{e}T_{b} > 0$，$a_2 = T_{e} + T_{b} > 0$，$a_1 = 1 > 0$。条件 $a_0 = K\\beta > 0$ 要求 $K > 0$，这对于一个负反馈系统在物理上是合理的。\n\n接下来，我们应用第二个 Routh-Hurwitz 条件：\n$$\na_2 a_1 > a_3 a_0\n$$\n代入系数：\n$$\n(T_{e} + T_{b})(1) > (T_{e}T_{b})(K\\beta)\n$$\n为确保稳定性，下丘脑增益 $K$ 必须满足此不等式。我们可以分离出 $K$ 以推导稳定性判据：\n$$\nK  \\frac{T_{e} + T_{b}}{\\beta T_{e} T_{b}}\n$$\n将此与正性要求结合，得到关于 $K$ 的完整稳定性判据：\n$$\n0  K  \\frac{T_{e} + T_{b}}{\\beta T_{e} T_{b}}\n$$\n这是增益 $K$ 的通用稳定性判据。对于此范围内的任何 $K$，系统都是稳定的，并在上界处为临界稳定。\n\n现在，我们为给定参数计算 $K$ 的最大允许值，记为 $K_{max}$：$T_{e} = 60 \\ \\text{s}$，$T_{b} = 1200 \\ \\text{s}$，以及 $\\beta = 0.05$。\n$$\nK_{max} = \\frac{T_{e} + T_{b}}{\\beta T_{e} T_{b}}\n$$\n代入数值：\n$$\nK_{max} = \\frac{60 + 1200}{(0.05)(60)(1200)} = \\frac{1260}{(0.05)(72000)}\n$$\n$$\nK_{max} = \\frac{1260}{3600} = \\frac{126}{360} = \\frac{63}{180} = \\frac{7}{20} = 0.35\n$$\n题目要求答案四舍五入至四位有效数字。精确值为 $0.35$，写作 $0.3500$。\n\n从机理上看，不稳定性源于系统增益与其固有时间延迟之间的相互作用。开环传递函数 $G(s)$ 包含三个相位滞后的来源：\n1. 积分器 ($1/s$)：该项代表下丘脑随时间对温度误差进行积分。它在所有频率上引入一个恒定的 $-90^\\circ$ 相位滞后。\n2. 效应器动态 ($1/(1+sT_e)$)：这个一阶滞后环节随着频率的增加引入一个从 $0^\\circ$ 到 $-90^\\circ$ 的相移。它代表了像汗腺或肌肉（用于颤抖）这样的生理效应器响应神经指令所需的时间。\n3. 身体的热动态 ($1/(1+sT_b)$)：这第二个一阶滞后环节也贡献一个从 $0^\\circ$ 到 $-90^\\circ$ 的相移。它代表了身体的热惯性；核心温度响应效应器的产热或散热而发生变化需要时间。\n\n因此，回路中的总相位滞后可以接近 $-270^\\circ$。反馈稳定性的一个基本原理（与 Nyquist 判据相关）是，如果在某个频率下相位滞后达到 $-180^\\circ$ 且此时回路增益 $|G(j\\omega)H(j\\omega)|$ 大于或等于 $1$，系统将变得不稳定。下丘脑增益 $K$ 直接缩放此回路增益。\n\n当 $K$ 较小时，控制器的响应是温和的。即使存在时间延迟，任何过度校正都很小且会被衰减掉。随着 $K$ 的增加，控制器对误差的响应变得更强。当 $K$ 足够大时，会发生以下情况：温度偏差导致下丘脑发出强烈的校正指令。由于延迟（$T_e$ 和 $T_b$），该指令的效果不会立即显现。当反馈（核心温度变化）到达下丘脑时，强烈的校正已经导致温度超调至设定点的另一侧。然后下丘脑感知到一个新的、大的误差，并发出另一个强大的、相反的指令。这种“强作用、延迟反馈、过度校正”的循环会导致持续或增长的振荡，这表明系统不稳定。推导出的判据 $K  (T_e + T_b) / (\\beta T_e T_b)$ 表明，最大稳定增益与时间常数的乘积成反比。更长的延迟（即更大的 $T_e$ 或 $T_b$）会减小稳定裕度，这意味着需要更小的增益来防止振荡。",
            "answer": "$$\n\\boxed{0.3500}\n$$"
        },
        {
            "introduction": "现在，我们从系统分析更进一步，来进行控制器设计。这个实践将下丘脑模拟为一个工程控制器——具体来说，是一个比例-积分（PI）控制器，这在系统神经科学中是一个强有力的类比。 你的挑战是确定该控制器的最佳“调谐”参数，以便在不违反物理限制的情况下实现快速而稳定的温度校正，从而深入理解演化如何塑造神经回路以实现稳健的生理功能。",
            "id": "5026257",
            "problem": "您需要将下丘脑内侧视前区（MPOA）神经元的体温调节反馈形式化为一个比例-积分控制器，并计算能最小化核心温度响应振荡的增益参数。使用一个与能量守恒一致的身体和环境的集总热模型：身体热含量的变化率等于净热流入减去净熱流出。仅从以下基本原理开始：\n- 具有热惯性（热容）$C$ 的身体通过一个恒定的热导 $G$ 与环境耦合，一个加热器（或新陈代谢驱动）产生一个物理单位为瓦特的控制输入 $u(t)$。令 $T(t)$ 为核心温度，$T_{\\mathrm{env}}$ 为环境温度，$T_{\\mathrm{set}}$ 为下丘脑回路编码的设定点。定义误差 $e(t) = T_{\\mathrm{set}} - T(t)$，并采用一个比例-积分控制器 $u(t) = K_p \\, e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau$，其中 $K_p$ 和 $K_i$ 是待确定的恒定增益。\n\n仅从以下基本原理出发：\n- 集总热系统的能量守恒：$$C \\, \\frac{dT}{dt} = -G \\, \\big(T(t) - T_{\\mathrm{env}}\\big) + u(t).$$\n- 具有误差 $e(t) = T_{\\mathrm{set}} - T(t)$ 和线性时不变比例-积分控制器 $u(t) = K_p \\, e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau$ 的单位负反馈。\n- 通过闭环系统的特征多项式进行闭环稳定性和避免振荡的标准线性系统分析。\n\n您的任务是：\n1. 将闭环误差动态推导为一个齐次微分方程，并将复频率变量 $s$ 中的特征多项式确定为 $a_2 s^2 + a_1 s + a_0 = 0$ 的二次形式，其中 $a_2$、$a_1$ 和 $a_0$ 用 $C$、$G$、$K_p$ 和 $K_i$ 表示。\n2. 利用振荡由共轭复根产生的性质，确定使系统产生临界阻尼响应（零振荡且最快无振荡地返回平衡的边界情况）的 $K_p$ 和 $K_i$ 的条件。\n3. 施加一个物理上现实的执行器约束：加热器的最大功率为 $U_{\\max}$，初始误差大小为一个阶跃 $\\Delta T = T_{\\mathrm{set}} - T(0)$。在 $t=0$ 时，积分项为零，因此 $u(0) = K_p \\, \\Delta T$ 必须满足 $u(0) \\le U_{\\max}$。在所有避免振荡的选择中，选择能在不违反 $u(0) \\le U_{\\max}$ 的前提下实现最快临界阻尼响应的增益。\n4. 实现一个程序，给定 $(C, G, \\Delta T, U_{\\max})$，计算满足上述标准的增益对 $(K_p, K_i)$。将 $K_p$ 以瓦特每开尔文 (W/K) 表示，$K_i$ 以瓦特每开尔文秒 (W/(K·s)) 表示。在最终输出中将 $K_p$ 和 $K_i$ 都四舍五入到六位小数。\n5. 使用以下参数集测试套件（每个元组为 $(C, G, \\Delta T, U_{\\max})$，单位为 $(\\mathrm{J/K}, \\mathrm{W/K}, \\mathrm{K}, \\mathrm{W})$):\n   - $(3500, 10, 2, 50)$\n   - $(3500, 0, 2, 50)$\n   - $(500, 15, 0.1, 50)$\n   - $(10000, 30, 3, 40)$\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔的结果列表，每个测试用例对应一个子列表 $[K_p,K_i]$，并按指定要求四舍五入，不含空格。例如，格式必须像这样 $$[[K_{p1},K_{i1}],[K_{p2},K_{i2}],\\dots].$$",
            "solution": "这个问题是适定的，有科学依据，并为获得唯一解提供了足够的信息。我们首先将系统动态形式化，然后求解最优控制器增益。\n\n分析从所提供的控制方程开始。身体的热动态（被控对象）由一个表示能量守恒的一阶线性微分方程描述：\n$$C \\, \\frac{dT}{dt} = -G \\, \\big(T(t) - T_{\\mathrm{env}}\\big) + u(t)$$\n其中 $C$ 是热惯性（热容），$G$ 是与环境的热导，$T(t)$ 是核心体温，$T_{\\mathrm{env}}$ 是环境温度，$u(t)$ 是来自控制器的热输入。\n\n控制器是一个作用于误差信号 $e(t)$ 的比例-积分 (PI) 控制器，误差信号定义为期望的设定点温度 $T_{\\mathrm{set}}$ 与实际温度 $T(t)$ 之差：\n$$e(t) = T_{\\mathrm{set}} - T(t)$$\n控制作用 $u(t)$ 由下式给出：\n$$u(t) = K_p \\, e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau$$\n其中 $K_p$ 和 $K_i$ 分别是比例增益和积分增益。\n\n**1. 推导闭环误差动态**\n\n我们的第一个任务是推导关于误差 $e(t)$ 的单一微分方程。我们首先用 $e(t)$ 来表示被控对象的动态。根据误差的定义，我们有 $T(t) = T_{\\mathrm{set}} - e(t)$。对时间 $t$求导，得到：\n$$\\frac{dT}{dt} = -\\frac{de}{dt}$$\n将这些关于 $T(t)$ 及其导数的表达式代入被控对象方程：\n$$C \\left(-\\frac{de}{dt}\\right) = -G \\big((T_{\\mathrm{set}} - e(t)) - T_{\\mathrm{env}}\\big) + u(t)$$\n重新整理各项，将 $e(t)$ 的导数放在左侧：\n$$-C \\frac{de}{dt} = -G(T_{\\mathrm{set}} - T_{\\mathrm{env}}) + G e(t) + u(t)$$\n$$C \\frac{de}{dt} + G e(t) = G(T_{\\mathrm{set}} - T_{\\mathrm{env}}) - u(t)$$\n现在，我们代入控制输入 $u(t)$ 的表达式：\n$$C \\frac{de}{dt} + G e(t) = G(T_{\\mathrm{set}} - T_{\\mathrm{env}}) - \\left(K_p \\, e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau\\right)$$\n合并包含 $e(t)$ 的项：\n$$C \\frac{de}{dt} + (G + K_p) e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau = G(T_{\\mathrm{set}} - T_{\\mathrm{env}})$$\n这是一个线性积分-微分方程。为了得到一个纯粹的微分方程，我们对整个方程关于时间 $t$求导。假设 $T_{\\mathrm{set}}$ 和 $T_{\\mathrm{env}}$ 是常数，它们的差也是常数，其导数为零。\n$$\\frac{d}{dt} \\left( C \\frac{de}{dt} + (G + K_p) e(t) + K_i \\int_0^t e(\\tau) \\, d\\tau \\right) = \\frac{d}{dt} \\left( G(T_{\\mathrm{set}} - T_{\\mathrm{env}}) \\right)$$\n$$C \\frac{d^2e}{dt^2} + (G + K_p) \\frac{de}{dt} + K_i e(t) = 0$$\n这就是描述闭环系统误差动态的二阶齐次线性常微分方程。\n\n为了找到特征多项式，我们应用拉普拉斯变换，或者等效地，用 $s$ 替代微分算子 $d/dt$。这产生了复频率变量 $s$ 中的特征多项式：\n$$C s^2 + (G + K_p) s + K_i = 0$$\n将其与要求的形式 $a_2 s^2 + a_1 s + a_0 = 0$ 比较，我们可以确定系数：\n- $a_2 = C$\n- $a_1 = G + K_p$\n- $a_0 = K_i$\n\n**2. 临界阻尼响应的条件**\n\n当二阶系统的特征多项式的根为相等的实根时，系统表现出临界阻尼响应。这发生在二次方程的判别式为零时。判别式 $\\Delta$ 由 $\\Delta = a_1^2 - 4 a_2 a_0$ 给出。\n令判别式为零：\n$$(G + K_p)^2 - 4 C K_i = 0$$\n这给出了临界阻尼的条件，它将控制器增益 $K_p$ 和 $K_i$ 与被控对象参数 $C$ 和 $G$ 联系起来：\n$$(G + K_p)^2 = 4 C K_i$$\n\n**3. 在执行器约束下的增益优化**\n\n目标是实现最快的临界阻尼响应。临界阻尼二阶系统的瞬态响应由其重复实极点的位置决定。当临界阻尼时，特征方程有一个二重根位于：\n$$s = \\frac{-a_1}{2 a_2} = - \\frac{G + K_p}{2C}$$\n误差动态将具有形式 $e(t) = (A t + B) e^{-\\lambda t}$，其中衰减率 $\\lambda = \\frac{G + K_p}{2C}$。更快的响应对应于更大的衰减率 $\\lambda$。为了最大化 $\\lambda$，我们必须最大化项 $\\frac{G + K_p}{2C}$。由于 $C$ 和 $G$ 是固定的正物理参数，这等同于最大化比例增益 $K_p$（假设 $K_p \\ge 0$，这是负反馈的标准物理约定）。\n\n增益 $K_p$ 受到执行器约束的限制。在时间 $t=0$ 时的控制器输出由下式给出：\n$$u(0) = K_p \\, e(0) + K_i \\int_0^0 e(\\tau) \\, d\\tau = K_p \\, e(0)$$\n问题说明初始误差为 $e(0) = \\Delta T$。加热器的最大功率为 $U_{\\max}$，因此控制作用必须满足 $u(t) \\le U_{\\max}$ 对所有 $t \\ge 0$。对 $K_p$ 最严格的条件发生在 $t=0$ 时，此时误差最大。这给出了不等式：\n$$u(0) = K_p \\Delta T \\le U_{\\max}$$\n假设 $\\Delta T > 0$，这为 $K_p$ 提供了一个上限：\n$$K_p \\le \\frac{U_{\\max}}{\\Delta T}$$\n为了实现最快响应，我们必须最大化 $K_p$。因此，我们选择 $K_p$ 的最大允许值：\n$$K_{p, \\mathrm{opt}} = \\frac{U_{\\max}}{\\Delta T}$$\n有了这个最优的 $K_p$ 值，我们可以通过使用上一步推导出的条件，找到确保临界阻尼的相应积分增益 $K_i$：\n$$K_{i, \\mathrm{opt}} = \\frac{(G + K_{p, \\mathrm{opt}})^2}{4C} = \\frac{\\left(G + \\frac{U_{\\max}}{\\Delta T}\\right)^2}{4C}$$\n\n这两个方程提供了满足所有给定条件的最优增益 $(K_p, K_i)$。\n\n**4. 测试用例计算**\n\n推导出的公式是：\n$$K_p = \\frac{U_{\\max}}{\\Delta T}$$\n$$K_i = \\frac{(G + K_p)^2}{4C}$$\n我们将这些公式应用于提供的测试用例。\n\n- 情况 1: $(C, G, \\Delta T, U_{\\max}) = (3500, 10, 2, 50)$\n  $K_p = 50 / 2 = 25.0$\n  $K_i = (10 + 25.0)^2 / (4 \\times 3500) = 35^2 / 14000 = 1225 / 14000 = 0.0875$\n\n- 情况 2: $(C, G, \\Delta T, U_{\\max}) = (3500, 0, 2, 50)$\n  $K_p = 50 / 2 = 25.0$\n  $K_i = (0 + 25.0)^2 / (4 \\times 3500) = 25^2 / 14000 = 625 / 14000 \\approx 0.044642857$\n\n- 情况 3: $(C, G, \\Delta T, U_{\\max}) = (500, 15, 0.1, 50)$\n  $K_p = 50 / 0.1 = 500.0$\n  $K_i = (15 + 500.0)^2 / (4 \\times 500) = 515^2 / 2000 = 265225 / 2000 = 132.6125$\n\n- 情况 4: $(C, G, \\Delta T, U_{\\max}) = (10000, 30, 3, 40)$\n  $K_p = 40 / 3 \\approx 13.333333333$\n  $K_i = (30 + 40/3)^2 / (4 \\times 10000) = (130/3)^2 / 40000 = (16900/9) / 40000 = 16900 / 360000 = 169 / 3600 \\approx 0.046944444$\n\n这些值将在附带的程序中计算和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are permitted.\n\ndef solve():\n    \"\"\"\n    Computes the optimal proportional (Kp) and integral (Ki) gains\n    for a thermoregulatory system modeled as a PI controller on a\n    first-order plant. The optimization criteria are to achieve the\n    fastest critically damped response without violating an actuator\n    power limit.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (C, G, Delta_T, U_max) with units\n    # (J/K, W/K, K, W).\n    test_cases = [\n        (3500, 10, 2, 50),\n        (3500, 0, 2, 50),\n        (500, 15, 0.1, 50),\n        (10000, 30, 3, 40),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        C, G, Delta_T, U_max = case\n        \n        # Validate inputs to prevent division by zero, although test cases are valid.\n        if C == 0:\n            # Physically impossible, thermal inertia must be positive.\n            raise ValueError(\"Heat capacity C must be positive.\")\n        if Delta_T == 0:\n            # The optimization formulation relies on Delta_T > 0 to set an\n            # upper bound on Kp. If Delta_T is zero, Kp is unconstrained.\n            # This formulation is not defined for Delta_T = 0.\n            # The problem context implies Delta_T > 0.\n            # If Delta_T was 0, Kp could be infinite, which is not physical.\n            # The problem setter implies Delta_T > 0.\n            # The problem also does not handle Delta_T  0 which would flip the sign of Kp.\n            if Delta_T = 0:\n                raise ValueError(\"Initial error Delta_T must be positive for this formulation.\")\n\n        \n        # 1. Calculate the optimal proportional gain, Kp.\n        # This is determined by the actuator constraint at t=0, where saturation\n        # provides the tightest bound on Kp to achieve the fastest response.\n        # Kp = U_max / Delta_T\n        kp = U_max / Delta_T\n        \n        # 2. Calculate the optimal integral gain, Ki.\n        # This is determined by the critical damping condition:\n        # (G + Kp)^2 - 4*C*Ki = 0  => Ki = (G + Kp)^2 / (4*C)\n        ki = (G + kp)**2 / (4 * C)\n        \n        # 3. Round the results to six decimal places as specified.\n        kp_rounded = round(kp, 6)\n        ki_rounded = round(ki, 6)\n        \n        all_results.append([kp_rounded, ki_rounded])\n\n    # 4. Format the final output string as required.\n    # The format is a comma-separated list of sublists, with no spaces.\n    # e.g., [[Kp1,Ki1],[Kp2,Ki2],...]\n    result_strings = [f\"[{kp},{ki}]\" for kp, ki in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\n# Since this code is executed in an environment where solve() is called,\n# we can simplify the code to just define the function.\n# For standalone testing, the call to solve() is necessary.\n# Let's assume the environment calls it. If not, this is the correct way.\ntry:\n    solve()\nexcept ValueError as e:\n    # If there's an issue with the inputs, we might want to handle it.\n    # For this problem, the inputs are fixed and valid.\n    print(e)\n```"
        }
    ]
}