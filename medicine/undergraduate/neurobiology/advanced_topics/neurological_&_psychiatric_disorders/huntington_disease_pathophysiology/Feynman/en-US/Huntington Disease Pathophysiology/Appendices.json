{
    "hands_on_practices": [
        {
            "introduction": "A central event in the pathophysiology of Huntington's disease is the misfolding of the mutant Huntingtin protein (mHTT). This practice provides a hands-on approach to modeling the complex process of protein aggregation using a simplified, yet powerful, quasi-equilibrium framework. By applying the law of mass action, you will derive the relative concentrations of monomers, oligomers, and fibrils, gaining insight into how the accumulation of potentially toxic oligomeric intermediates is governed by fundamental biophysical principles.",
            "id": "5025629",
            "problem": "A central feature of Huntington's disease pathophysiology is the misfolding and self-assembly of mutant Huntingtin protein (mHTT) with expanded polyglutamine (polyQ) tracts into oligomers and fibrils. Consider a coarse-grained, quasi-equilibrium model in which the cellular pool of mHTT monomeric equivalents partitions among three conformational states: monomer $M$, oligomer $O$, and fibril $F$. Let the total concentration of monomeric equivalents be $C_T$, so that mass conservation requires $[M] + [O] + [F] = C_T$. Assume thermodynamic equilibrium among the states and define the dimensionless equilibrium constants by the law of mass action for state interconversion: $K_1$ for $M \\rightleftharpoons O$ and $K_2$ for $O \\rightleftharpoons F$, with $K_1 \\equiv \\frac{[O]}{[M]}$ and $K_2 \\equiv \\frac{[F]}{[O]}$. Starting from these definitions and the mass conservation constraint, derive analytic expressions for the equilibrium concentrations $[M]$, $[O]$, and $[F]$ as functions of $K_1$, $K_2$, and $C_T$. Then, using first principles, determine the parameter regime (in terms of $K_1$ and $K_2$) under which the oligomer population dominates, meaning the oligomer concentration exceeds both the monomer and fibril concentrations. Provide the final equilibrium concentrations as closed-form symbolic expressions. If you perform any numerical evaluation, express concentrations in micromolar, but no numerical evaluation is required. The final reported answer must be a single row vector containing $[M]$, $[O]$, and $[F]$ as functions of $K_1$, $K_2$, and $C_T$.",
            "solution": "The user has provided a problem to be solved. As per the instructions, the first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n-   **Conformational States:** Monomer ($M$), Oligomer ($O$), Fibril ($F$).\n-   **Total Concentration:** The total concentration of monomeric equivalents is $C_T$.\n-   **Mass Conservation:** $[M] + [O] + [F] = C_T$.\n-   **Equilibrium Reactions:** $M \\rightleftharpoons O$ and $O \\rightleftharpoons F$.\n-   **Equilibrium Constants:** $K_1 \\equiv \\frac{[O]}{[M]}$ and $K_2 \\equiv \\frac{[F]}{[O]}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity against the established criteria.\n-   **Scientifically Grounded:** The problem describes a simplified quasi-equilibrium model of protein aggregation, a common and valid approach in biophysical chemistry and neurobiology. The use of the law of mass action and a mass conservation constraint are fundamental principles. The context of Huntington's disease and mutant Huntingtin (mHTT) protein is scientifically accurate.\n-   **Well-Posed:** The problem provides a system of three linear algebraic equations for three unknown concentrations ($[M]$, $[O]$, $[F]$). The system is self-contained, consistent, and has a unique solution.\n-   **Objective:** The problem is defined with precise mathematical relationships and objective language. There are no subjective or opinion-based claims.\n-   **Other Flaws:** The problem does not violate any of the other criteria for invalidity. It is formalizable, complete, feasible, well-structured, non-trivial, and scientifically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution process will now proceed.\n\n### Solution Derivation\nThe objective is to find the equilibrium concentrations $[M]$, $[O]$, and $[F]$ in terms of the total concentration $C_T$ and the equilibrium constants $K_1$ and $K_2$. The system is defined by the following three equations:\n1.  Mass Conservation: $[M] + [O] + [F] = C_T$\n2.  First Equilibrium: $[O] = K_1 [M]$\n3.  Second Equilibrium: $[F] = K_2 [O]$\n\nWe can express both $[O]$ and $[F]$ in terms of $[M]$. The expression for $[O]$ is already given by equation (2). To express $[F]$ in terms of $[M]$, we substitute equation (2) into equation (3):\n$$[F] = K_2 ([O]) = K_2 (K_1 [M]) = K_1 K_2 [M]$$\n\nNow, we have both $[O]$ and $[F]$ as functions of $[M]$. We can substitute these expressions into the mass conservation equation (1):\n$$[M] + (K_1 [M]) + (K_1 K_2 [M]) = C_T$$\n\nFactor out the common term, $[M]$, from the left-hand side of the equation:\n$$[M] (1 + K_1 + K_1 K_2) = C_T$$\n\nSolving for $[M]$ yields the equilibrium concentration of the monomer:\n$$[M] = \\frac{C_T}{1 + K_1 + K_1 K_2}$$\n\nWith the expression for $[M]$ now known, we can find the equilibrium concentrations for the oligomer, $[O]$, and the fibril, $[F]$.\n\nFor the oligomer concentration, $[O]$, we use equation (2):\n$$[O] = K_1 [M] = K_1 \\left( \\frac{C_T}{1 + K_1 + K_1 K_2} \\right) = \\frac{K_1 C_T}{1 + K_1 + K_1 K_2}$$\n\nFor the fibril concentration, $[F]$, we use the relationship $[F] = K_1 K_2 [M]$:\n$$[F] = K_1 K_2 [M] = K_1 K_2 \\left( \\frac{C_T}{1 + K_1 + K_1 K_2} \\right) = \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2}$$\n\nThese three expressions provide the equilibrium concentrations of each species as a function of the given parameters.\n\n### Analysis of Oligomer Dominance\nThe second part of the problem requires determining the parameter regime where the oligomer population dominates, i.e., where its concentration is greater than both the monomer and fibril concentrations. This is expressed by the simultaneous inequalities:\n1.  $[O] > [M]$\n2.  $[O] > [F]$\n\nLet's analyze the first inequality, $[O] > [M]$:\n$$\\frac{K_1 C_T}{1 + K_1 + K_1 K_2} > \\frac{C_T}{1 + K_1 + K_1 K_2}$$\nSince concentrations and equilibrium constants are non-negative, $C_T > 0$ and the denominator $(1 + K_1 + K_1 K_2)$ is strictly positive. Therefore, we can multiply both sides by $\\frac{1 + K_1 + K_1 K_2}{C_T}$ without changing the direction of the inequality:\n$$K_1 > 1$$\nThis condition implies that the equilibrium $M \\rightleftharpoons O$ must favor the formation of oligomers.\n\nNext, let's analyze the second inequality, $[O] > [F]$:\n$$\\frac{K_1 C_T}{1 + K_1 + K_1 K_2} > \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2}$$\nAssuming $K_1 > 0$, we can multiply both sides by $\\frac{1 + K_1 + K_1 K_2}{K_1 C_T}$:\n$$1 > K_2$$\nThis condition implies that the equilibrium $O \\rightleftharpoons F$ must favor the oligomeric state over the fibrillar state.\n\nTherefore, the oligomer population dominates when both conditions are met: $K_1 > 1$ and $K_2 < 1$. This regime corresponds to a scenario where monomer-to-oligomer conversion is favorable, but oligomer-to-fibril conversion is unfavorable, leading to the accumulation of the intermediate oligomeric species.\n\nThe final answer requires only the derived expressions for the concentrations in a specific format.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{C_T}{1 + K_1 + K_1 K_2} & \\frac{K_1 C_T}{1 + K_1 + K_1 K_2} & \\frac{K_1 K_2 C_T}{1 + K_1 + K_1 K_2} \\end{pmatrix} } $$"
        },
        {
            "introduction": "Beyond protein aggregation, mutant Huntingtin renders neurons vulnerable to other pathological stresses, most notably excitotoxicity. This exercise models this critical process, where excessive glutamatergic stimulation of NMDA receptors leads to toxic levels of intracellular calcium ($[Ca^{2+}]$) in striatal neurons. You will apply principles of receptor pharmacology and kinetic modeling to quantify this calcium overload and, importantly, to calculate the minimum concentration of a competitive antagonist needed to provide a neuroprotective effect, linking cellular pathology directly to a rational therapeutic strategy.",
            "id": "5025600",
            "problem": "In Huntington's disease, striatal medium spiny neurons experience pathological calcium loading driven by excessive activation of N-methyl-D-aspartate (NMDA) receptors during high glutamatergic input and impaired uptake. Consider a single-compartment neuron in which cytosolic calcium concentration, denoted $[Ca^{2+}]$, follows first-order balance dynamics under sustained stimulation: $\\frac{d[Ca^{2+}]}{dt} = J_{\\text{in}} - k_{\\text{eff}}[Ca^{2+}]$, where $J_{\\text{in}}$ is the NMDA receptor-mediated calcium influx rate and $k_{\\text{eff}}$ is an effective first-order clearance rate constant that summarizes buffering, pumps, and sequestration. Under sustained input, assume the membrane is sufficiently depolarized that the magnesium block of NMDA receptors is relieved, and the glycine co-agonist site is saturated. Assume further that the open probability of NMDA receptors is proportional to the fraction of receptors occupied by glutamate, which you must model using the law of mass action for a single binding site with a competitive antagonist.\n\nLet $[G]$ be the glutamate concentration during high input, $[A]$ the concentration of a competitive NMDA receptor antagonist, $K_G$ the dissociation constant for glutamate, and $K_A$ the dissociation constant for the antagonist. Under these assumptions, let $J_{\\text{in}} = \\alpha f_G$, where $\\alpha$ is a constant scaling the maximum calcium influx rate of the receptor population and $f_G$ is the fraction of receptors occupied by glutamate in the presence of the antagonist. At steady state, $[Ca^{2+}]_{\\text{ss}} = J_{\\text{in}}/k_{\\text{eff}}$.\n\nUse the following parameter values, chosen to reflect a high-input, transporter-impaired state relevant to Huntington's disease pathophysiology:\n- $[G] = 20\\,\\mu\\text{M}$\n- $K_G = 2.0\\,\\mu\\text{M}$\n- $K_A = 1.0\\,\\mu\\text{M}$\n- $\\alpha = 0.15\\,\\mu\\text{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\text{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- Target threshold $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\text{M}$\n\nStarting from the law of mass action for a single receptor binding site with a competitive antagonist and the calcium balance equation above, derive an expression for the minimum antagonist concentration $[A]_{\\min}$ that guarantees $[Ca^{2+}]_{\\text{ss}} \\le [Ca^{2+}]^\\ast$ during the sustained high-input condition. Then compute its numerical value using the parameters provided. Round your final result to two significant figures. Express the final antagonist concentration in micromolar ($\\mu\\text{M}$).",
            "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained. The model used is a standard simplification in biophysical pharmacology and presents no contradictions or factual unsoundness. All necessary parameters and relationships are provided to arrive at a unique, meaningful solution. Thus, the problem is valid, and a full solution follows.\n\nThe core of the problem is to determine the minimum concentration of a competitive antagonist, $[A]_{\\min}$, required to keep the steady-state intracellular calcium concentration, $[Ca^{2+}]_{\\mathrm{ss}}$, below a specified threshold, $[Ca^{2+}]^\\ast$.\n\nFirst, we must derive the expression for the fraction of NMDA receptors occupied by glutamate, $f_G$, in the presence of both glutamate ($[G]$) and a competitive antagonist ($[A]$). According to the law of mass action for a single binding site, the equilibria for the agonist (glutamate, $G$) and antagonist ($A$) binding to the receptor ($R$) are:\n$$R + G \\rightleftharpoons RG \\quad \\text{with dissociation constant} \\quad K_G = \\frac{[R][G]}{[RG]}$$\n$$R + A \\rightleftharpoons RA \\quad \\text{with dissociation constant} \\quad K_A = \\frac{[R][A]}{[RA]}$$\nThe total concentration of receptors, $[R]_{\\mathrm{tot}}$, is the sum of receptors in all possible states: unbound ($[R]$), glutamate-bound ($[RG]$), and antagonist-bound ($[RA]$).\n$$[R]_{\\mathrm{tot}} = [R] + [RG] + [RA]$$\nWe can express the concentrations of the bound states in terms of the free receptor concentration $[R]$:\n$$[RG] = \\frac{[R][G]}{K_G} \\quad \\text{and} \\quad [RA] = \\frac{[R][A]}{K_A}$$\nSubstituting these into the equation for $[R]_{\\mathrm{tot}}$:\n$$[R]_{\\mathrm{tot}} = [R] + \\frac{[R][G]}{K_G} + \\frac{[R][A]}{K_A} = [R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)$$\nThe fraction of receptors occupied by glutamate, $f_G$, is the ratio $[RG]/[R]_{\\mathrm{tot}}$:\n$$f_G = \\frac{\\frac{[R][G]}{K_G}}{[R] \\left(1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}\\right)} = \\frac{\\frac{[G]}{K_G}}{1 + \\frac{[G]}{K_G} + \\frac{[A]}{K_A}}$$\nMultiplying the numerator and denominator by $K_G$ yields the final expression for $f_G$:\n$$f_G = \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}}$$\nNext, we establish the relationship for the steady-state calcium concentration, $[Ca^{2+}]_{\\mathrm{ss}}$. The system dynamics are given by $\\frac{d[Ca^{2+}]}{dt} = J_{\\mathrm{in}} - k_{\\mathrm{eff}}[Ca^{2+}]$. At steady state, $\\frac{d[Ca^{2+}]}{dt} = 0$, which gives:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{J_{\\mathrm{in}}}{k_{\\mathrm{eff}}}$$\nThe problem states that the calcium influx $J_{\\mathrm{in}}$ is proportional to the fraction of glutamate-bound receptors, $J_{\\mathrm{in}} = \\alpha f_G$. Substituting this relation gives:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha f_G}{k_{\\mathrm{eff}}}$$\nNow, we combine the expressions for $f_G$ and $[Ca^{2+}]_{\\mathrm{ss}}$:\n$$[Ca^{2+}]_{\\mathrm{ss}} = \\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right)$$\nThe condition to be met is $[Ca^{2+}]_{\\mathrm{ss}} \\le [Ca^{2+}]^\\ast$. To find the minimum antagonist concentration, $[A]_{\\min}$, we solve the equality $[Ca^{2+}]_{\\mathrm{ss}} = [Ca^{2+}]^\\ast$.\n$$\\frac{\\alpha}{k_{\\mathrm{eff}}} \\left( \\frac{[G]}{K_G + [G] + [A]\\frac{K_G}{K_A}} \\right) = [Ca^{2+}]^\\ast$$\nWe rearrange this equation to solve for $[A]$. Since all terms are positive, we can manipulate the expression directly:\n$$K_G + [G] + [A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$$\nIsolating the term containing $[A]$:\n$$[A]\\frac{K_G}{K_A} = \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G])$$\nFinally, solving for $[A]$ yields the general expression for the minimum required concentration, $[A]_{\\min}$:\n$$[A]_{\\min} = \\frac{K_A}{K_G} \\left( \\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast} - (K_G + [G]) \\right)$$\nNow, we substitute the given numerical values into this expression:\n- $[G] = 20\\,\\mu\\text{M}$\n- $K_G = 2.0\\,\\mu\\text{M}$\n- $K_A = 1.0\\,\\mu\\text{M}$\n- $\\alpha = 0.15\\,\\mu\\text{M}\\,\\mathrm{s}^{-1}$\n- $k_{\\mathrm{eff}} = 0.25\\,\\mathrm{s}^{-1}$\n- $[Ca^{2+}]^\\ast = 0.30\\,\\mu\\text{M}$\n\nFirst, we compute the term $\\frac{\\alpha [G]}{k_{\\mathrm{eff}} [Ca^{2+}]^\\ast}$:\n$$\\frac{(0.15)(20)}{(0.25)(0.30)} \\mu\\mathrm{M} = \\frac{3.0}{0.075} \\mu\\mathrm{M} = 40\\,\\mu\\mathrm{M}$$\nNext, we compute the term $(K_G + [G])$:\n$$2.0\\,\\mu\\mathrm{M} + 20\\,\\mu\\mathrm{M} = 22\\,\\mu\\mathrm{M}$$\nSubstituting these back into the equation for $[A]_{\\min}$:\n$$[A]_{\\min} = \\frac{1.0}{2.0} \\left( 40\\,\\mu\\mathrm{M} - 22\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 0.5 \\left( 18\\,\\mu\\mathrm{M} \\right)$$\n$$[A]_{\\min} = 9.0\\,\\mu\\mathrm{M}$$\nThe result is $9.0\\,\\mu\\mathrm{M}$. This value is already presented with two significant figures as requested.",
            "answer": "$$\\boxed{9.0}$$"
        },
        {
            "introduction": "The clinical presentation of Huntington's disease evolves over time, often beginning with hyperkinetic movements and progressing to an akinetic, rigid state. This complex progression arises from the selective and time-dependent degeneration of different neuron populations within the basal ganglia motor circuit. This final practice challenges you to build a computational model that simulates this entire process, connecting the loss of specific cell types to the large-scale changes in motor output. By implementing a model of the direct and indirect pathways, you will see firsthand how systems-level neuroscience can explain the dynamic and biphasic nature of a neurodegenerative disease.",
            "id": "5025611",
            "problem": "You are to build, explain, and implement a discrete-time progression model of basal ganglia-thalamocortical motor output that connects early hyperkinetic symptoms to later akinetic symptoms in Huntington's disease pathophysiology by tracking the degeneration of indirect-pathway medium spiny neurons (MSNs) and predicting threshold-crossing transitions in motor output. You must derive the model from core neurobiological sign rules and a standard firing-rate transfer function, then implement it and evaluate it on a specified test suite. All neural activities are to be treated as dimensionless in arbitrary units (a.u.). The final program output must be a single line containing all test-case results as a comma-separated Python-style list, as specified below.\n\nFoundational base and definitions to use:\n- Basal ganglia circuit sign rules. The direct pathway (striatonigral) inhibits the internal segment of the globus pallidus (GPi), thereby disinhibiting thalamus and facilitating movement; the indirect pathway (striatopallidal via the external segment of the globus pallidus (GPe) and subthalamic nucleus (STN)) has a net excitatory effect on GPi, thereby inhibiting thalamus and suppressing movement. The thalamus excites motor cortex.\n- Huntington’s disease early-stage preferentially degenerates indirect-pathway MSNs, effectively reducing the net excitatory drive to GPi, leading to thalamic disinhibition and hyperkinesia; later disease involves degeneration that reduces direct-pathway MSNs and cortical drive, increasing GPi influence and leading to akinesia.\n- Rate-model assumption. Each nucleus’ output is a monotonic function of a weighted sum of its inputs. Use a static logistic nonlinearity for the thalamic transfer function.\n\nModel specification to be derived and implemented:\n- Let $C_t$ denote cortical drive at discrete time step $t$, in a.u.\n- Let $D_t \\in [0,1]$ denote the fraction of intact direct-pathway MSNs at time $t$, and $I_t \\in [0,1]$ denote the fraction of intact indirect-pathway MSNs at time $t$.\n- Let $G_t$ denote GPi output at time $t$ and $T_t$ denote thalamic output at time $t$.\n- Parameters are fixed constants: baseline GPi output $G_0 = 1.0$ (a.u.), indirect-pathway gain $k_I = 1.0$, direct-pathway gain $k_D = 1.0$, thalamic pre-activation bias $u_0 = 0.0$, cortical gain $k_C = 1.0$, GPi-to-thalamus gain $k_G = 1.0$, and thalamic logistic gain $g = 4.0$ (dimensionless).\n- Use the qualitative sign structure to construct the following computational stages:\n  1) Compute the GPi output $G_t$ as a baseline $G_0$ plus the net indirect-pathway effect (excitatory to GPi) minus the net direct-pathway effect (inhibitory to GPi), each proportional to both the corresponding MSN fraction and the cortical drive, consistent with a feedforward approximation.\n  2) Compute the thalamic pre-activation $U_t$ as the difference of an excitatory cortical term and an inhibitory GPi term with bias $u_0$.\n  3) Map $U_t$ to thalamic output $T_t$ using the logistic transfer $S(x) = \\dfrac{1}{1 + \\exp(-x)}$ with slope parameter $g$, i.e., $T_t = S(g \\, U_t)$.\n  4) Treat $T_t$ as a dimensionless motor output proxy in $[0,1]$.\n- Define two clinically interpretable thresholds: a hyperkinesia threshold $H = 0.8$ and an akinesia threshold $A = 0.2$. A hyperkinetic phase onset occurs at the smallest index $t$ such that $T_t \\ge H$. An akinetic phase onset occurs at the smallest index $t$ such that $T_t \\le A$. If no such index exists within the provided series, return $-1$ for that transition.\n\nInput and test suite (hard-coded; no user input):\nFor each test case, you must generate discrete series for $t = 0, 1, \\dots, T-1$ as described. All sequences and constants are in a.u., and angles are not involved.\n- Test case $1$ (happy path, early hyperkinesia then late akinesia):\n  - Horizon $T = 11$.\n  - Indirect-pathway integrity $I_t$ decreases linearly from $1.0$ at $t = 0$ to $0.2$ at $t = 10$.\n  - Direct-pathway integrity $D_t$ remains $1.0$ for $t \\le 5$, then decreases linearly to $0.1$ at $t = 10$.\n  - Cortical drive $C_t$ remains $1.0$ for $t \\le 5$, then decreases linearly to $0.5$ at $t = 10$.\n- Test case $2$ (edge case: indirect-pathway loss only; hyperkinesia but no akinesia):\n  - Horizon $T = 11$.\n  - $I_t$ decreases linearly from $1.0$ at $t = 0$ to $0.2$ at $t = 10$.\n  - $D_t \\equiv 1.0$ for all $t$.\n  - $C_t \\equiv 1.0$ for all $t$.\n- Test case $3$ (edge case: late akinesia without preceding hyperkinesia):\n  - Horizon $T = 11$.\n  - $I_t \\equiv 0.9$ for all $t$.\n  - $D_t$ decreases linearly from $1.0$ at $t = 0$ to $0.1$ at $t = 10$.\n  - $C_t$ decreases linearly from $1.0$ at $t = 0$ to $0.5$ at $t = 10$.\n- Test case $4$ (boundary conditions: exact-threshold equality):\n  - Horizon $T = 2$.\n  - Let $U^\\star = \\dfrac{\\ln 4}{g}$ so that $S(g \\, U^\\star) = 0.8$, and let $U_\\star = -\\dfrac{\\ln 4}{g}$ so that $S(g \\, U_\\star) = 0.2$.\n  - For $t = 0$, use $C_0 = 1.0$, $D_0 = 1.0$, and $I_0 = 1.0 - U^\\star$ so that $U_0 = 1.0 - I_0 = U^\\star$ and hence $T_0 = 0.8$.\n  - For $t = 1$, use $C_1 = 1.0$, set $I_1 = I_0$, and choose $D_1 = I_0 + U_\\star$ so that $U_1 = D_1 - I_1 = U_\\star$ and hence $T_1 = 0.2$.\n\nRequired computations:\n- For each test case, generate $I_t$, $D_t$, and $C_t$ as above, then compute $G_t$, $U_t$, and $T_t$ for all $t$.\n- Determine the smallest time index $t_H$ such that $T_t \\ge H$ and the smallest time index $t_A$ such that $T_t \\le A$. If a condition is never met within the horizon, report $-1$ for that index.\n- The program must output a single line containing a Python-style list of lists with the pair $[t_H, t_A]$ for each test case in order $1$ through $4$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[[t_{H,1}, t_{A,1}],[t_{H,2}, t_{A,2}],[t_{H,3}, t_{A,3}],[t_{H,4}, t_{A,4}]]$ where each entry is an integer. No additional text must be printed.",
            "solution": "The problem requires the construction and implementation of a discrete-time computational model of the basal ganglia-thalamocortical circuit to simulate the motor symptoms of Huntington's disease. The model must be derived from specified neurobiological principles and then used to predict the onset of hyperkinetic and akinetic phases for a suite of test cases.\n\n### Principles and Model Derivation\n\nThe model is founded upon a simplified rate-based representation of key nuclei in the motor loop, consistent with established circuit diagrams. The core components are the cortex, the striatum (comprising direct and indirect pathway Medium Spiny Neurons, or MSNs), the Globus Pallidus internal segment (GPi), and the thalamus. The sign rules governing their interactions are as follows: cortical drive excites both striatal pathways; the direct pathway ultimately inhibits the GPi; the indirect pathway ultimately excites the GPi; the GPi tonically inhibits the thalamus; and the thalamus excites the motor cortex, closing the loop. Motor output is facilitated by thalamic disinhibition (i.e., reduced GPi activity).\n\nHuntington's disease progression is modeled by the selective degeneration of MSN populations. Early in the disease, degeneration is concentrated in the indirect pathway MSNs ($I_t$ decreases). Reduced indirect pathway function lessens the net excitatory drive to the GPi. This lowers GPi output, disinhibits the thalamus, and leads to excessive motor output (hyperkinesia). Later, the disease also affects the direct pathway MSNs ($D_t$ decreases) and reduces cortical drive ($C_t$ decreases). The loss of direct pathway function reduces the inhibitory influence on the GPi, while reduced cortical drive lowers the overall input to the system. The net effect is a pathological increase in GPi's inhibitory output, which suppresses thalamic activity and leads to a lack of movement (akinesia).\n\nWe formalize this conceptual model into a set of discrete-time equations. All activities are dimensionless, in arbitrary units (a.u.).\n\n**1. GPi Output ($G_t$)**\n\nThe GPi output at time $t$, denoted $G_t$, is determined by a baseline activity $G_0$, modulated by the opposing effects of the direct and indirect pathways.\n- The indirect pathway's net effect is excitatory on the GPi. Its influence is proportional to the fraction of intact indirect-pathway MSNs, $I_t$, the cortical drive, $C_t$, and a gain factor, $k_I$. This term is $+k_I I_t C_t$.\n- The direct pathway's net effect is inhibitory on the GPi. Its influence is proportional to the fraction of intact direct-pathway MSNs, $D_t$, the cortical drive, $C_t$, and a gain factor, $k_D$. This term is $-k_D D_t C_t$.\n\nThe resulting equation for GPi output is:\n$$\nG_t = G_0 + k_I I_t C_t - k_D D_t C_t\n$$\nUsing the provided parameters ($G_0=1.0$, $k_I=1.0$, $k_D=1.0$):\n$$\nG_t = 1.0 + (1.0) \\cdot I_t C_t - (1.0) \\cdot D_t C_t = 1.0 + C_t(I_t - D_t)\n$$\n\n**2. Thalamic Pre-activation ($U_t$)**\n\nThe thalamus receives excitatory input from the cortex and inhibitory input from the GPi. Its pre-activation potential, $U_t$, is the weighted sum of these inputs plus a bias term, $u_0$.\n- The excitatory cortical input is proportional to cortical drive $C_t$ with gain $k_C$. Term: $+k_C C_t$.\n- The inhibitory GPi input is proportional to GPi output $G_t$ with gain $k_G$. Term: $-k_G G_t$.\n\nThe equation for thalamic pre-activation is:\n$$\nU_t = u_0 + k_C C_t - k_G G_t\n$$\nUsing the provided parameters ($u_0=0.0$, $k_C=1.0$, $k_G=1.0$):\n$$\nU_t = 0.0 + (1.0) \\cdot C_t - (1.0) \\cdot G_t = C_t - G_t\n$$\nSubstituting the expression for $G_t$ into the equation for $U_t$:\n$$\nU_t = C_t - (1.0 + C_t(I_t - D_t)) = C_t - 1.0 - C_t I_t + C_t D_t\n$$\nFactoring out $C_t$ yields the final compact form:\n$$\nU_t = C_t(1.0 - I_t + D_t) - 1.0\n$$\n\n**3. Thalamic Output ($T_t$)**\n\nThe thalamic output, $T_t$, which serves as a proxy for motor output, is a non-linear, saturating function of its pre-activation. We use the standard logistic function, $S(x) = \\frac{1}{1 + \\exp(-x)}$, with a gain parameter $g$ that controls the steepness of the response.\n$$\nT_t = S(g \\cdot U_t)\n$$\nUsing the given thalamic logistic gain $g = 4.0$:\n$$\nT_t = \\frac{1}{1 + \\exp(-4.0 \\cdot U_t)}\n$$\n\n**4. Clinical Phase Onset**\n\nThe model's output, $T_t$, is compared against two thresholds to determine the onset of clinical phases.\n- **Hyperkinesia onset ($t_H$)**: The first time index $t$ where motor output exceeds a high threshold, $H = 0.8$. Formally, $t_H = \\min(\\{t \\mid T_t \\ge 0.8\\} \\cup \\{-1\\})$, where $-1$ is used if the set is empty.\n- **Akinesia onset ($t_A$)**: The first time index $t$ where motor output falls below a low threshold, $A = 0.2$. Formally, $t_A = \\min(\\{t \\mid T_t \\le 0.2\\} \\cup \\{-1\\})$.\n\n### Algorithmic Implementation\n\nThe implementation proceeds by first defining the model parameters and the logistic function. Then, for each of the four test cases, we perform the following steps:\n1. Generate the input time series for $I_t$, $D_t$, and $C_t$ over the specified time horizon $T$, from $t=0$ to $t=T-1$. This involves creating constant arrays or using linear interpolation (e.g., via `numpy.linspace`) for simple or piecewise linear functions as specified.\n2. Apply the derived equations vectorially to the time series arrays to compute the sequence of GPi outputs ($G_t$), thalamic pre-activations ($U_t$), and finally the motor outputs ($T_t$).\n3. Search the resulting $T_t$ sequence for the first indices where the hyperkinesia ($T_t \\ge 0.8$) and akinesia ($T_t \\le 0.2$) conditions are met. The `numpy.where` function is suitable for finding all indices satisfying a condition; the first element of the resulting index array is the desired onset time. If the condition is never met, the index array will be empty, and we report $-1$.\n4. Store the resulting pair $[t_H, t_A]$ for each test case.\n5. After processing all test cases, format the collected results into a single string representing a Python list of lists, e.g., `[[t_H1, t_A1],[t_H2, t_A2],...]`, and print it to standard output. This requires careful string formatting to match the required output precisely, without extra spaces.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Derives and implements a discrete-time model for Huntington's disease\n    pathophysiology, evaluating it on four test cases to find the onset times\n    of hyperkinesia and akinesia.\n    \"\"\"\n\n    # Define model parameters\n    G_0 = 1.0\n    k_I = 1.0\n    k_D = 1.0\n    u_0 = 0.0\n    k_C = 1.0\n    k_G = 1.0\n    g = 4.0\n    \n    # Define clinical thresholds\n    H = 0.8\n    A = 0.2\n\n    def S(x):\n        \"\"\"Logistic transfer function.\"\"\"\n        return 1.0 / (1.0 + np.exp(-g * x))\n\n    def run_simulation(C_t, D_t, I_t):\n        \"\"\"\n        Computes GPi, thalamic pre-activation, and thalamic output series.\n        \n        Args:\n            C_t (np.ndarray): Cortical drive time series.\n            D_t (np.ndarray): Direct-pathway integrity time series.\n            I_t (np.ndarray): Indirect-pathway integrity time series.\n\n        Returns:\n            np.ndarray: Thalamic output (motor proxy) time series.\n        \"\"\"\n        G_t = G_0 + k_I * I_t * C_t - k_D * D_t * C_t\n        U_t = u_0 + k_C * C_t - k_G * G_t\n        T_t = S(U_t)\n        return T_t\n\n    def find_onsets(T_series):\n        \"\"\"\n        Finds the first time indices for hyperkinesia and akinesia.\n\n        Args:\n            T_series (np.ndarray): Thalamic output time series.\n\n        Returns:\n            list[int, int]: A pair of indices [t_H, t_A].\n        \"\"\"\n        tH_indices = np.where(T_series >= H)[0]\n        tH = tH_indices[0] if len(tH_indices) > 0 else -1\n        \n        tA_indices = np.where(T_series <= A)[0]\n        tA = tA_indices[0] if len(tA_indices) > 0 else -1\n        \n        return [tH, tA]\n\n    all_results = []\n\n    # Test Case 1: Happy path (hyperkinesia then akinesia)\n    T = 11\n    I_t1 = np.linspace(1.0, 0.2, T)\n    D_t1 = np.ones(T)\n    D_t1[5:] = np.linspace(1.0, 0.1, T - 5)\n    C_t1 = np.ones(T)\n    C_t1[5:] = np.linspace(1.0, 0.5, T - 5)\n    T_series_1 = run_simulation(C_t1, D_t1, I_t1)\n    all_results.append(find_onsets(T_series_1))\n\n    # Test Case 2: Indirect-pathway loss only (hyperkinesia only)\n    T = 11\n    I_t2 = np.linspace(1.0, 0.2, T)\n    D_t2 = np.ones(T)\n    C_t2 = np.ones(T)\n    T_series_2 = run_simulation(C_t2, D_t2, I_t2)\n    all_results.append(find_onsets(T_series_2))\n\n    # Test Case 3: Late akinesia without preceding hyperkinesia\n    T = 11\n    I_t3 = np.full(T, 0.9)\n    D_t3 = np.linspace(1.0, 0.1, T)\n    C_t3 = np.linspace(1.0, 0.5, T)\n    T_series_3 = run_simulation(C_t3, D_t3, I_t3)\n    all_results.append(find_onsets(T_series_3))\n\n    # Test Case 4: Boundary conditions (exact threshold equality)\n    T = 2\n    U_star = math.log(4) / g\n    U_star_neg = -math.log(4) / g\n    \n    C_t4 = np.ones(T)\n    D_t4 = np.zeros(T)\n    I_t4 = np.zeros(T)\n    \n    # Time t=0 setup\n    D_t4[0] = 1.0\n    I_t4[0] = 1.0 - U_star\n    \n    # Time t=1 setup\n    I_t4[1] = I_t4[0]\n    D_t4[1] = I_t4[0] + U_star_neg\n    \n    T_series_4 = run_simulation(C_t4, D_t4, I_t4)\n    all_results.append(find_onsets(T_series_4))\n    \n    # Format the final output string precisely as specified\n    formatted_results = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}