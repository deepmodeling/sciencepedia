{
    "hands_on_practices": [
        {
            "introduction": "突触强度的改变，例如长时程增强（LTP），是学习和记忆的细胞基础。然而，触发这些变化所需满足的条件并非一成不变。该练习将引导你通过一个具体的计算，探索像多巴胺这样的神经调质如何通过调节可塑性阈值来影响学习规则，从而揭示了神经调质在促进杏仁核恐惧关联学习中的关键作用。",
            "id": "5069570",
            "problem": "在听觉恐惧条件反射中，当关键诱导窗口期间的膜去极化超过长时程增强（LTP）阈值时，基底外侧杏仁核主神经元上的兴奋性突触输入会被增强。多巴胺（DA）通过环磷酸腺苷（cAMP）依赖性蛋白激酶A（PKA）作用，可以通过增强促进可塑性的靶标的磷酸化来调节该阈值。考虑一个从条件刺激（CS）到基底外侧杏仁核神经元的通路，其中每个CS诱发的峰电位产生一个兴奋性突触后电位，平均贡献$2\\,\\mathrm{mV}$的去极化。假设在诱导窗口期间为线性时间总和，并且在所关注的时间尺度上衰减和分流可忽略不计，因此总去极化是单个峰电位贡献的总和。在DA调节前，LTP诱导阈值为$\\theta = 15\\,\\mathrm{mV}$。在DA诱导的PKA活性增加后，阈值降低至$\\theta' = 10\\,\\mathrm{mV}$。使用“达到阈值所需的最小峰电位数是满足$n \\cdot \\Delta V \\geq \\text{threshold}$的最小整数$n$（其中$\\Delta V$是每次峰电位引起的去极化）”这一原理，计算在DA调节后，相对于调节前所需的数量，达到LTP阈值需要多少额外的CS峰电位。将您的答案以带符号整数$\\Delta n = n' - n$的形式报告，其中$n'$是DA调节后的最小峰电位数，$n$是DA调节前的最小峰电位数。负的$\\Delta n$表示需要更少的峰电位。请提供一个不带单位的数值答案。",
            "solution": "该问题是有效的，因为它科学地基于神经生物学原理，特别是突触可塑性和神经调节，并且提法明确，为获得唯一解提供了所有必要信息。\n\n问题要求计算在多巴胺（DA）调节后，诱导基底外侧杏仁核神经元长时程增强（LTP）所需的条件刺激（CS）诱发的峰电位的最小数量的变化。\n\n设$\\Delta V$为单个CS诱发的峰电位所贡献的平均膜去极化。问题陈述$\\Delta V = 2\\,\\mathrm{mV}$。\n模型假设这些电位是线性叠加的，所以$k$次峰电位的总去极化是$k \\cdot \\Delta V$。\n\n达到给定阈值所需的最小峰电位数$n$定义为使得总去极化大于或等于该阈值的最小整数$n$。这可以用向上取整函数表示，$n = \\lceil \\frac{\\text{threshold}}{\\Delta V} \\rceil$。\n\n首先，我们计算在DA调节前达到LTP阈值所需的峰电位数$n$。初始阈值给定为$\\theta = 15\\,\\mathrm{mV}$。\n使用LTP的诱导条件：\n$$n \\cdot \\Delta V \\geq \\theta$$\n代入给定值：\n$$n \\cdot 2 \\geq 15$$\n$$n \\geq \\frac{15}{2}$$\n$$n \\geq 7.5$$\n由于峰电位数$n$必须是整数，满足此不等式的最小整数是$n=8$。\n形式上，使用向上取整函数：\n$$n = \\left\\lceil \\frac{\\theta}{\\Delta V} \\right\\rceil = \\left\\lceil \\frac{15}{2} \\right\\rceil = \\lceil 7.5 \\rceil = 8$$\n\n接下来，我们计算在DA调节后达到LTP阈值所需的峰电位数$n'$。新的、降低后的阈值给定为$\\theta' = 10\\,\\mathrm{mV}$。\n使用新阈值下的相同LTP诱导条件：\n$$n' \\cdot \\Delta V \\geq \\theta'$$\n代入给定值：\n$$n' \\cdot 2 \\geq 10$$\n$$n' \\geq \\frac{10}{2}$$\n$$n' \\geq 5$$\n满足此不等式的最小整数$n'$是$n'=5$。\n形式上，使用向上取整函数：\n$$n' = \\left\\lceil \\frac{\\theta'}{\\Delta V} \\right\\rceil = \\left\\lceil \\frac{10}{2} \\right\\rceil = \\lceil 5 \\rceil = 5$$\n\n问题要求计算峰电位数量的变化量$\\Delta n$，其定义为$\\Delta n = n' - n$。\n代入计算出的$n$和$n'$的值：\n$$\\Delta n = 5 - 8 = -3$$\n结果是一个带符号整数。负值表示在多巴胺降低阈值后，达到LTP阈值所需的峰电位数减少了3个，这与多巴胺在此情境下促进突触可塑性的原理一致。",
            "answer": "$$\\boxed{-3}$$"
        },
        {
            "introduction": "学习过程并非简单地叠加经验，而是由“意外”或“预测误差”——即预期与实际结果之间的差异——所驱动。本练习将应用著名的 Rescorla-Wagner 模型于恐惧条件反射，让你亲手计算在一个条件刺激（如声音）与一个非条件刺激（如足底电击）的重复配对过程中，它们之间的关联强度是如何逐步建立起来的。",
            "id": "5069627",
            "problem": "在一个巴甫洛夫恐惧条件反射范式中，一个声音条件刺激（CS）与一个足部电击非条件刺激（US）配对，而基底外侧杏仁核（BLA）中的突触变化被认为编码了联结强度。设经过 $n$ 次 CS-US 配对后的联结强度为 $V_{n}$，它代表了下一次试验中预期的 US 强度。联结学习领域的实证和理论研究表明，学习是由预测误差驱动的，预测误差定义为所施加的 US 幅度与当前预期之间的差异，并利用误差校正来减小平方损失。\n\n从以下符合情境的基础出发：\n- 瞬时预测误差为 $\\delta = \\lambda - V$，其中 $\\lambda$ 是 US 幅度，$V$ 是当前预期。\n- 损失函数是瞬时平方误差 $E(V) = \\tfrac{1}{2}\\,\\delta^{2} = \\tfrac{1}{2}\\,(\\lambda - V)^{2}$。\n- 突触更新遵循学习率为 $\\alpha$ 的标准梯度下降法对 $E(V)$ 进行优化，因此单次配对中联结强度的变化为 $\\Delta V = -\\alpha\\,\\dfrac{dE}{dV}$。\n\n(a) 根据这些假设，推导出 $\\Delta V$ 的逐次试验学习更新规则。然后写出 $V_{n+1}$ 关于 $V_{n}$、$\\alpha$ 和 $\\lambda$ 的递推关系。\n\n(b) 考虑在 US 幅度恒为 $\\lambda = 1$、学习率为 $\\alpha = 0.1$ 的条件下进行习得，初始值为 $V_{0} = 0$。使用你推导出的更新规则，计算三次 CS-US 配对后的 $V_{1}$、$V_{2}$ 和 $V_{3}$。将这些值表示为无需四舍五入的精确小数。\n\n(c) 从预测误差的角度，简要解释 $V_{n}$ 趋近其渐近线的过程，并说明随着试验次数 $n$ 的增加，学习是会减慢还是会加速。\n\n在你的最终答案中，将(b)部分的三个数值按顺序以单行矩阵的形式呈现。无需单位。",
            "solution": "该问题描述了联结学习中的 Rescorla-Wagner 模型，这是计算神经科学和心理学中的一个基本概念。该模型提出学习是由预测误差驱动的，并且可以用梯度下降法对平方误差损失函数进行形式化。该问题具有科学依据，提问清晰，并提供了求解所需的所有信息。\n\n(a) 学习更新规则和递推关系的推导。\n\n问题提供了以下信息：\n损失函数，或瞬时平方误差，由 $E(V) = \\frac{1}{2}(\\lambda - V)^{2}$ 给出，其中 $\\lambda$ 是非条件刺激（US）的幅度，$V$ 是当前的联结强度或对 US 的预期。\n联结强度的更新规则以梯度下降的形式给出：\n$$\n\\Delta V = -\\alpha\\,\\dfrac{dE}{dV}\n$$\n其中 $\\alpha$ 是学习率。\n\n为了找到具体的更新规则，我们必须首先计算损失函数 $E(V)$ 关于 $V$ 的导数。使用链式法则，设 $u = \\lambda - V$。那么 $\\frac{du}{dV} = -1$。\n$$\n\\dfrac{dE}{dV} = \\dfrac{d}{dV} \\left( \\frac{1}{2}(\\lambda - V)^{2} \\right) = \\dfrac{d}{dV} \\left( \\frac{1}{2}u^{2} \\right) = \\dfrac{dE}{du}\\dfrac{du}{dV} = (u)(-1) = -(\\lambda - V)\n$$\n将此导数代入 $\\Delta V$ 的表达式中：\n$$\n\\Delta V = -\\alpha \\left( -(\\lambda - V) \\right) = \\alpha(\\lambda - V)\n$$\n这就是明确的逐次试验学习更新规则。它表明联结强度的变化与预测误差 $\\delta = \\lambda - V$ 成正比。\n\n试验 $n+1$ 后的联结强度，记为 $V_{n+1}$，是试验前强度 $V_n$ 与试验期间发生的变化 $\\Delta V_n$ 的和。变化量 $\\Delta V_n$ 是基于试验 $n$ 开始时的条件计算的：\n$$\n\\Delta V_n = \\alpha(\\lambda - V_n)\n$$\n因此，$V_{n+1}$ 的递推关系为：\n$$\nV_{n+1} = V_n + \\Delta V_n = V_n + \\alpha(\\lambda - V_n)\n$$\n\n(b) 计算 $V_{1}$、$V_{2}$ 和 $V_{3}$。\n\n给定初始条件 $V_{0} = 0$ 以及恒定参数 $\\lambda = 1$ 和 $\\alpha = 0.1$。我们使用在(a)部分推导出的递推关系：$V_{n+1} = V_n + 0.1(1 - V_n)$。\n\n对于试验 1 (从 $V_0$ 计算 $V_1$):\n$$\nV_{1} = V_{0} + \\alpha(\\lambda - V_{0}) = 0 + 0.1(1 - 0) = 0.1\n$$\n\n对于试验 2 (从 $V_1$ 计算 $V_2$):\n$$\nV_{2} = V_{1} + \\alpha(\\lambda - V_{1}) = 0.1 + 0.1(1 - 0.1) = 0.1 + 0.1(0.9) = 0.1 + 0.09 = 0.19\n$$\n\n对于试验 3 (从 $V_2$ 计算 $V_3$):\n$$\nV_{3} = V_{2} + \\alpha(\\lambda - V_{2}) = 0.19 + 0.1(1 - 0.19) = 0.19 + 0.1(0.81) = 0.19 + 0.081 = 0.271\n$$\n因此，经过三次 CS-US 配对后，联结强度分别为 $V_1 = 0.1$，$V_2 = 0.19$ 和 $V_3 = 0.271$。\n\n(c) 学习动态的解释。\n\n学习过程由递推关系 $V_{n+1} = V_n + \\alpha(\\lambda - V_n)$ 控制。只要联结强度存在变化，即只要 $\\Delta V_n = \\alpha(\\lambda - V_n) \\neq 0$，学习就会继续。由于学习率 $\\alpha$ 是一个正常数，学习只有在预测误差项 $\\delta_n = \\lambda - V_n$ 变为零时才会停止。这发生在 $V_n = \\lambda$ 时。因此，联结强度 $V_n$ 会趋近于一个等于 US 幅度的渐近值，即 $V_{\\infty} = \\lambda$。\n\n在初始试验中，当 $V_n$ 远离 $\\lambda$ 时，预测误差 $\\delta_n$ 很大。例如，在第一次试验中，$\\delta_0 = \\lambda - V_0 = 1 - 0 = 1$，这是可能的最大误差。这个大的预测误差会驱动联结强度发生相应的大幅更新，$\\Delta V_0 = \\alpha \\delta_0 = 0.1$。\n\n随着 $n$ 的增加，$V_n$ 逐渐接近 $\\lambda = 1$。因此，预测误差 $\\delta_n = \\lambda - V_n$ 随每次试验而减小。由于更新的幅度 $\\Delta V_n$ 与预测误差成正比，联结强度的增量在每次连续的试验中都会变小。例如，$\\Delta V_0 = 0.1$，$\\Delta V_1 = 0.09$，以及 $\\Delta V_2 = 0.081$。\n\n这表明，在习得初期，当 US 最出乎意料时，学习速度最快；而随着联结强度接近真实的 US 幅度且 US 变得完全可预测时，学习速度会**减慢**。学习曲线是负加速的，显示出每次配对的收益递减。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.1  0.19  0.271\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "抽象的学习规则最终需要通过具体的神经环路来实现和调控。最终的恐惧行为输出（如僵直反应）由杏仁核中央核（CeM）控制，而其活动又受到外侧中央核（CeL）抑制性神经元的精密门控。这项高级练习将指导你从第一性原理出发，构建一个计算模型来模拟这种兴奋-抑制相互作用，让你能够直观地观察到抑制性输入是如何调控已习得恐惧的表达。",
            "id": "5069617",
            "problem": "要求您形式化、模拟和分析一个由中央杏仁核外侧区 (CeL) 抑制性神经元和中央杏仁核内侧区 (CeM) 输出神经元组成的最小确定性网络模型，以在一个有原则的生物物理框架内，论证增加的 CeL 抑制性驱动如何将 CeM 放电降低到与冻结行为相关的阈值以下。目标是从适用于神经生物学的第一性原理推导出控制方程，并实现一个数值模拟，该模拟能对几个测试案例输出 CeM 放电频率是高于还是低于指定的冻结阈值。请使用以下基础和模型规范。\n\n基础原理：\n- 神经元膜被视为一个电阻-电容电路。设膜电容为 $C_m$，膜电阻为 $R_m$。电流平衡方程为\n$$\nC_m \\frac{dV(t)}{dt} = -\\frac{V(t) - V_{\\mathrm{rest}}}{R_m} + I_{\\mathrm{tot}}(t),\n$$\n其中 $V(t)$ 是以毫伏为单位的膜电位，$V_{\\mathrm{rest}}$ 是以毫伏为单位的静息电位，$I_{\\mathrm{tot}}(t)$ 是以纳安为单位的总输入电流。定义膜时间常数 $ \\tau_m = R_m C_m $，并将方程重写为\n$$\n\\frac{dV(t)}{dt} = \\frac{-(V(t)-V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}(t)}{\\tau_m}.\n$$\n这是带有欧姆漏电的漏电积分-发放模型。\n- 来自 CeL 的抑制性突触电流通过一个门控变量 $s(t)$ 进行建模，其演化遵循\n$$\n\\frac{ds(t)}{dt} = -\\frac{s(t)}{\\tau_{\\mathrm{syn}}} + \\sum_k \\delta(t - t_k),\n$$\n其中 $\\tau_{\\mathrm{syn}}$ 是以毫秒为单位的突触时间常数，$\\delta(\\cdot)$ 是狄拉克δ函数，$t_k$ 是来自 CeL 的抑制性脉冲时间。抑制性电流为\n$$\nI_{\\mathrm{inh}}(t) = w_{\\mathrm{inh}} \\, s(t),\n$$\n其中 $w_{\\mathrm{inh}}$ 的单位是纳安。\n- 条件刺激 (CS) 向 CeM 注入一个恒定的兴奋性电流：\n$$\nI_{\\mathrm{exc}}(t) = I_{\\mathrm{CS}},\n$$\n其中 $I_{\\mathrm{CS}}$ 的单位是纳安。\n- 流向 CeM 的总电流为 $I_{\\mathrm{tot}}(t) = I_{\\mathrm{exc}}(t) - I_{\\mathrm{inh}}(t)$。\n\nCeM 脉冲发放规则：\n- 当 $V(t)$ 从下方穿过阈值 $V_{\\mathrm{th}}$ 时，记录一个脉冲并将 $V(t)$ 重置为 $V_{\\mathrm{reset}}$。实现一个持续时间为 $t_{\\mathrm{ref}}$ 毫秒的绝对不应期，在此期间 $V(t)$ 保持在 $V_{\\mathrm{reset}}$。\n\n数值方法：\n- 使用具有固定步长 $\\Delta t$ 的显式欧拉积分来随时间推进 $V(t)$ 和 $s(t)$。CeL 脉冲序列是确定性的，周期性频率为 $f_{\\mathrm{CeL}}$ 赫兹，产生脉冲间隔 $T_{\\mathrm{CeL}} = 1000/f_{\\mathrm{CeL}}$ 毫秒。当 $f_{\\mathrm{CeL}} = 0$ 时，没有 CeL 脉冲。\n\n行为决策规则：\n- 将 CeM 放电频率 $r_{\\mathrm{CeM}}$（单位为赫兹）定义为 CeM 脉冲数除以模拟持续时间（单位为秒）。定义冻结阈值 $r_{\\mathrm{freeze}}$（单位为赫兹）。当且仅当 $r_{\\mathrm{CeM}}$ 严格大于 $r_{\\mathrm{freeze}}$ 时，认为冻结行为被启动。\n\n单位：\n- 时间变量（$t$, $\\tau_m$, $\\tau_{\\mathrm{syn}}$, $t_{\\mathrm{ref}}$, 模拟持续时间）必须以毫秒为单位。\n- 膜电位（$V$, $V_{\\mathrm{rest}}$, $V_{\\mathrm{th}}$, $V_{\\mathrm{reset}}$）必须以毫伏为单位。\n- 电流（$I_{\\mathrm{CS}}$, $I_{\\mathrm{inh}}$, $I_{\\mathrm{tot}}$）必须以纳安为单位。\n- 电阻（$R_m$）必须以兆欧为单位，这样当 $I$ 以纳安为单位时，$R_m I$ 的结果为毫伏。\n- 频率（$f_{\\mathrm{CeL}}$, $r_{\\mathrm{CeM}}$, $r_{\\mathrm{freeze}}$）必须以赫兹为单位。\n\n实现要求：\n- 实现指定的模型，并为下面列出的每个测试案例计算 CeM 放电频率 $r_{\\mathrm{CeM}}$，然后计算指示冻结行为是否被启动的布尔值（$r_{\\mathrm{CeM}}  r_{\\mathrm{freeze}}$）。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，\"[result1,result2,result3]\"）。\n\n测试套件（每个案例指定参数；请精确使用这些值）：\n- 案例 1（基准情况，中等抑制）：$T = 1000$ ms, $\\Delta t = 0.1$ ms, $V_{\\mathrm{rest}} = -65$ mV, $V_{\\mathrm{th}} = -50$ mV, $V_{\\mathrm{reset}} = -65$ mV, $\\tau_m = 20$ ms, $R_m = 100$ MOhm, $t_{\\mathrm{ref}} = 2$ ms, $\\tau_{\\mathrm{syn}} = 10$ ms, $I_{\\mathrm{CS}} = 0.25$ nA, $w_{\\mathrm{inh}} = 0.02$ nA, $f_{\\mathrm{CeL}} = 10$ Hz, $r_{\\mathrm{freeze}} = 10$ Hz。\n- 案例 2（增强的抑制，预期的抑制效果）：与案例 1 相同，但 $w_{\\mathrm{inh}} = 0.08$ nA 且 $f_{\\mathrm{CeL}} = 25$ Hz，以及 $r_{\\mathrm{freeze}} = 10$ Hz。\n- 案例 3（CeL零输入的边界情况）：与案例 1 相同，但 $w_{\\mathrm{inh}} = 0$ nA 且 $f_{\\mathrm{CeL}} = 0$ Hz，以及 $r_{\\mathrm{freeze}} = 10$ Hz。\n\n输出规范：\n- 对于每个案例，输出一个布尔值，指示是否 $r_{\\mathrm{CeM}}  r_{\\mathrm{freeze}}$。将三个布尔值聚合成单行输出，格式为“[b1,b2,b3]”。",
            "solution": "我们从神经元膜的电阻-电容描述开始构建模型。膜电位 $V(t)$ 的基本电流平衡为\n$$\nC_m \\frac{dV(t)}{dt} = -\\frac{V(t) - V_{\\mathrm{rest}}}{R_m} + I_{\\mathrm{tot}}(t),\n$$\n其中 $C_m$ 是膜电容，$R_m$ 是膜电阻，$V_{\\mathrm{rest}}$ 是静息电位，$I_{\\mathrm{tot}}(t)$ 是所有进入膜的外部电流之和。定义膜时间常数 $ \\tau_m = R_m C_m $，我们可以将漏电积分-发放动力学表示为\n$$\n\\frac{dV(t)}{dt} = \\frac{-(V(t)-V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}(t)}{\\tau_m}.\n$$\n该公式使用欧姆定律 $V=IR$ 的形式，将通过 $R_m$（单位为兆欧）的输入电流（单位为纳安）映射为等效的毫伏驱动，确保了单位的一致性。\n\n我们将进入 CeM 神经元的总输入电流划分为代表条件刺激的兴奋性分量 $I_{\\mathrm{exc}}(t)$ 和代表 CeL 影响的抑制性分量 $I_{\\mathrm{inh}}(t)$：\n$$\nI_{\\mathrm{tot}}(t) = I_{\\mathrm{exc}}(t) - I_{\\mathrm{inh}}(t), \\quad I_{\\mathrm{exc}}(t) = I_{\\mathrm{CS}}.\n$$\n对于抑制性突触，我们使用一个标准的一阶动力学模型来描述门控变量 $s(t)$：\n$$\n\\frac{ds(t)}{dt} = -\\frac{s(t)}{\\tau_{\\mathrm{syn}}} + \\sum_k \\delta(t - t_k),\n$$\n其中 $\\tau_{\\mathrm{syn}}$ 是突触衰减时间常数，$t_k$ 是来自 CeL 的确定性抑制性脉冲时间。每个脉冲使 $s(t)$ 瞬时增加1，而在脉冲之间 $s(t)$呈指数衰减。抑制性电流由下式给出\n$$\nI_{\\mathrm{inh}}(t) = w_{\\mathrm{inh}} s(t),\n$$\n其中 $w_{\\mathrm{inh}}$ 设定了单位 $s(t)$ 的抑制强度。\n\n当 $V(t)$ 从下方越过 $V_{\\mathrm{th}}$ 时，检测到 CeM 脉冲。在脉冲发放后，膜电位被重置为 $V_{\\mathrm{reset}}$，并在绝对不应期 $t_{\\mathrm{ref}}$ 内保持在该值。放电频率 $r_{\\mathrm{CeM}}$ 是脉冲计数除以模拟持续时间（秒）。\n\n使用显式欧拉积分的算法设计：\n1.  初始化 $V(0) = V_{\\mathrm{rest}}$, $s(0) = 0$, 脉冲计数 $N_{\\mathrm{spk}} = 0$, 以及不应期计时器 $t_{\\mathrm{ref,rem}} = 0$。\n2.  确定 CeL 脉冲间隔 $T_{\\mathrm{CeL}} = 1000/f_{\\mathrm{CeL}}$ ms。如果 $f_{\\mathrm{CeL}} = 0$，则不发生抑制性脉冲。\n3.  对于从 $t=0$ 到 $t=T$ 的大小为 $\\Delta t$ 的离散时间步：\n    -   如果 $t$ 到达下一个 CeL 脉冲时间 $t_k$，则增加 $s \\leftarrow s + 1$ 并将下一个脉冲安排在 $t_k + T_{\\mathrm{CeL}}$。\n    -   使用以下公式更新突触门控变量\n        $$\n        s \\leftarrow s + \\left(-\\frac{s}{\\tau_{\\mathrm{syn}}}\\right) \\Delta t.\n        $$\n    -   计算 $I_{\\mathrm{inh}} = w_{\\mathrm{inh}} s$ 和 $I_{\\mathrm{tot}} = I_{\\mathrm{CS}} - I_{\\mathrm{inh}}$。\n    -   如果 $t_{\\mathrm{ref,rem}}  0$，则设置 $V \\leftarrow V_{\\mathrm{reset}}$ 并递减 $t_{\\mathrm{ref,rem}} \\leftarrow t_{\\mathrm{ref,rem}} - \\Delta t$。\n    -   否则，使用以下公式更新膜电位\n        $$\n        V \\leftarrow V + \\frac{-(V - V_{\\mathrm{rest}}) + R_m I_{\\mathrm{tot}}}{\\tau_m} \\Delta t.\n        $$\n    -   如果 $V \\ge V_{\\mathrm{th}}$（在离散时间内从下方穿越），记录一个脉冲 ($N_{\\mathrm{spk}} \\leftarrow N_{\\mathrm{spk}} + 1$)，设置 $V \\leftarrow V_{\\mathrm{reset}}$，并设置 $t_{\\mathrm{ref,rem}} \\leftarrow t_{\\mathrm{ref}}$。\n4.  循环结束后，计算\n    $$\n    r_{\\mathrm{CeM}} = \\frac{N_{\\mathrm{spk}}}{T/1000}.\n    $$\n5.  通过评估布尔值 $r_{\\mathrm{CeM}}  r_{\\mathrm{freeze}}$ 来确定冻结行为是否被启动。\n\n科学解释：\n- 在具有频率 $f_{\\mathrm{CeL}}$ 的周期性抑制性脉冲序列的稳态下，门控变量满足 $s_{\\mathrm{ss}} \\approx \\tau_{\\mathrm{syn}} f_{\\mathrm{CeL}}$（因为每个脉冲增加1，而 $s$ 以时间常数 $\\tau_{\\mathrm{syn}}$ 衰减），导致平均抑制电流\n$$\n\\langle I_{\\mathrm{inh}} \\rangle \\approx w_{\\mathrm{inh}} \\tau_{\\mathrm{syn}} f_{\\mathrm{CeL}}.\n$$\n- 增加 $w_{\\mathrm{inh}}$ 或 $f_{\\mathrm{CeL}}$ 都会增加 $\\langle I_{\\mathrm{inh}} \\rangle$，降低膜方程中的驱动项 $R_m I_{\\mathrm{tot}}$，减少 $V(t)$ 在阈值附近停留的时间，从而减少脉冲计数 $N_{\\mathrm{spk}}$ 和频率 $r_{\\mathrm{CeM}}$。\n- 如果抑制性驱动足够强，$r_{\\mathrm{CeM}}$ 可以被降低到行为阈值 $r_{\\mathrm{freeze}}$ 以下，从而预测尽管存在兴奋性 CS，但不会出现冻结行为。\n\n测试套件探讨了：\n- 案例 1：中等抑制，预期 $r_{\\mathrm{CeM}}$ 高于阈值（$r_{\\mathrm{freeze}} = 10$ Hz）。\n- 案例 2：通过更高的 $w_{\\mathrm{inh}}$ 和 $f_{\\mathrm{CeL}}$ 增加抑制，预期抑制效果会将频率降至阈值以下。\n- 案例 3：零 CeL 抑制（抑制驱动的下限边界），对于给定的 $I_{\\mathrm{CS}}$ 将产生最大的 $r_{\\mathrm{CeM}}$。\n\n程序计算每个案例的布尔结果 $[b_1, b_2, b_3]$，指示 $r_{\\mathrm{CeM}}  r_{\\mathrm{freeze}}$，并以指定格式将它们打印为单行。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef simulate_cem_cel_case(\n    T_ms,\n    dt_ms,\n    V_rest_mV,\n    V_thresh_mV,\n    V_reset_mV,\n    tau_m_ms,\n    R_m_MOhm,\n    t_ref_ms,\n    tau_syn_ms,\n    I_CS_nA,\n    w_inh_nA,\n    f_CeL_Hz,\n    r_freeze_Hz,\n):\n    \"\"\"\n    Simulate a minimal deterministic network:\n    - CeM: leaky integrate-and-fire neuron.\n    - CeL: periodic inhibitory spike train driving a decaying synaptic gating variable s(t).\n\n    Returns: boolean indicating whether freezing is engaged (CeM rate  r_freeze_Hz).\n    \"\"\"\n    n_steps = int(T_ms / dt_ms)\n    V = V_rest_mV\n    s_inh = 0.0\n    spikes = 0\n    ref_remaining_ms = 0.0\n\n    # CeL spike scheduling\n    if f_CeL_Hz  0.0:\n        cel_interval_ms = 1000.0 / f_CeL_Hz\n        next_cel_spike_ms = 0.0\n    else:\n        cel_interval_ms = None\n        next_cel_spike_ms = None\n\n    t_ms = 0.0\n    for _ in range(n_steps):\n        # CeL spike occurs?\n        if next_cel_spike_ms is not None and t_ms = next_cel_spike_ms:\n            s_inh += 1.0  # instantaneous increment per inhibitory spike\n            next_cel_spike_ms += cel_interval_ms\n\n        # Synaptic gating decay (explicit Euler)\n        s_inh += (-s_inh / tau_syn_ms) * dt_ms\n\n        # Inhibitory current\n        I_inh_nA = w_inh_nA * s_inh\n\n        # Total input current to CeM\n        I_tot_nA = I_CS_nA - I_inh_nA\n\n        if ref_remaining_ms  0.0:\n            # Absolute refractory: hold at reset\n            V = V_reset_mV\n            ref_remaining_ms = max(0.0, ref_remaining_ms - dt_ms)\n        else:\n            # Membrane update (explicit Euler)\n            dVdt = (-(V - V_rest_mV) + R_m_MOhm * I_tot_nA) / tau_m_ms\n            V += dVdt * dt_ms\n\n            # Spike condition\n            if V = V_thresh_mV:\n                spikes += 1\n                V = V_reset_mV\n                ref_remaining_ms = t_ref_ms\n\n        t_ms += dt_ms\n\n    duration_s = T_ms / 1000.0\n    r_CeM_Hz = spikes / duration_s\n    return r_CeM_Hz  r_freeze_Hz\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: happy path, moderate inhibition\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.02,\n            \"f_CeL_Hz\": 10.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n        # Case 2: increased inhibition, expected suppression\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.08,\n            \"f_CeL_Hz\": 25.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n        # Case 3: zero CeL input (boundary)\n        {\n            \"T_ms\": 1000.0,\n            \"dt_ms\": 0.1,\n            \"V_rest_mV\": -65.0,\n            \"V_thresh_mV\": -50.0,\n            \"V_reset_mV\": -65.0,\n            \"tau_m_ms\": 20.0,\n            \"R_m_MOhm\": 100.0,\n            \"t_ref_ms\": 2.0,\n            \"tau_syn_ms\": 10.0,\n            \"I_CS_nA\": 0.25,\n            \"w_inh_nA\": 0.0,\n            \"f_CeL_Hz\": 0.0,\n            \"r_freeze_Hz\": 10.0,\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        result = simulate_cem_cel_case(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}