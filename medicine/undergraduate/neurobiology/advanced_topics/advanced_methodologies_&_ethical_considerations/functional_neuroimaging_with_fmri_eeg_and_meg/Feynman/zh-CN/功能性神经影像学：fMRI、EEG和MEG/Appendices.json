{
    "hands_on_practices": [
        {
            "introduction": "fMRI的强大之处在于其能够绘制全脑活动图。然而，图像的几何准确性可能会受到伪影的影响。本练习探讨了由磁敏感性差异（例如，空气与组织的交界处）引起的常见伪影，这会导致磁场不均匀，并最终在图像采集过程中造成像素位移。通过计算这种位移，你将亲身体会到fMRI数据的物理基础以及理解采集参数对于数据质量的重要性。",
            "id": "5018755",
            "problem": "在使用平面回波成像 (EPI) 技术采集的功能性磁共振成像 (fMRI) 中，静磁磁化率的差异会产生局部磁场不均匀性，从而导致核磁共振频率发生偏移。拉莫尔关系指出，共振频率与磁场成正比，即 $f = \\gamma B$，其中 $\\gamma$ 是氢核的旋磁比，B 是磁通量密度。考虑一个 EPI 序列，其相位编码方向将频率偏移映射到位置，相位编码带宽为每个像素 $b = 20$ Hz。假设整个大脑存在一个由磁化率引起的线性磁场扰动，使得局部磁场偏离标称主场的偏差为 $\\Delta B = 0.4\\,\\mathrm{\\mu T}$，并使用氢的旋磁比 $\\gamma = 42.577 \\times 10^{6}$ Hz/T。从第一性原理出发，推导由该磁场扰动引起的频率偏移以及在相位编码方向上产生的像素位移，并计算像素偏移的数值。以像素为单位表示最终的位移，并将答案四舍五入到三位有效数字。",
            "solution": "该问题具有科学依据，提法明确，并包含了推导唯一解所需的所有必要信息。它描述了 fMRI 中使用的平面回波成像 (EPI) 的一种基本伪影，该伪影由磁化率引起的磁场不均匀性造成。\n\n我们首先陈述给定的参数：\n每个像素的相位编码带宽，$b = 20\\,\\mathrm{Hz/pixel}$。\n局部磁场扰动的大小，$\\Delta B = 0.4\\,\\mathrm{\\mu T} = 0.4 \\times 10^{-6}\\,\\mathrm{T}$。\n氢核（$^1\\mathrm{H}$）的旋磁比，$\\gamma = 42.577 \\times 10^{6}\\,\\mathrm{Hz/T}$。\n\n推导过程分两步进行。首先，我们确定由磁场扰动引起的频率偏移。其次，我们确定与此频率偏移相对应的以像素为单位的空间位移。\n\n第一步：推导频率偏移（$\\Delta f$）。\n根据问题中给出的拉莫尔关系，$f = \\gamma B$，其中 $\\gamma$ 的单位为 $\\mathrm{Hz/T}$。磁场中的微小扰动 $\\Delta B$ 将导致共振频率发生相应的偏移 $\\Delta f$。假设 $\\gamma$ 是一个常数，我们可以通过考虑拉莫尔方程的变化来找到这种关系：\n$$f + \\Delta f = \\gamma (B + \\Delta B) = \\gamma B + \\gamma \\Delta B$$\n由于 $f = \\gamma B$，我们可以从扰动后的方程中减去这一项，以求得频率偏移 $\\Delta f$：\n$$\\Delta f = \\gamma \\Delta B$$\n这就是频率偏移的第一性原理推导。现在我们可以代入给定值来计算其数值：\n$$\\Delta f = (42.577 \\times 10^{6}\\,\\mathrm{Hz/T}) \\times (0.4 \\times 10^{-6}\\,\\mathrm{T})$$\n$$\\Delta f = 42.577 \\times 0.4\\,\\mathrm{Hz}$$\n$$\\Delta f = 17.0308\\,\\mathrm{Hz}$$\n\n第二步：推导像素位移（$S_{pix}$）。\n在 EPI 中，相位编码方向是 k 空间遍历的“慢”方向。众所周知，它对由 $\\Delta B$ 等引起的离共振效应特别敏感。图像重建是基于一个完美、均匀磁场的假设。任何频率偏移 $\\Delta f$ 都会被重建算法误解为空间位移。问题指明，该成像序列在相位编码方向上将频率偏移映射到位置，其带宽为每个像素 $b = 20\\,\\mathrm{Hz}$。这个值 $b$ 充当了频率偏移和空间位移之间的缩放因子。\n因此，以像素为单位的位移（我们表示为 $S_{pix}$）是总频率偏移 $\\Delta f$ 除以对应单个像素的频率范围 $b$。\n$$S_{pix} = \\frac{\\Delta f}{b}$$\n这就是像素位移的推导过程。现在，我们将其与之前得到的 $\\Delta f$ 结果相结合：\n$$S_{pix} = \\frac{\\gamma \\Delta B}{b}$$\n最后，我们使用计算出的 $\\Delta f$ 和给定的 $b$ 来计算像素偏移的数值：\n$$S_{pix} = \\frac{17.0308\\,\\mathrm{Hz}}{20\\,\\mathrm{Hz/pixel}}$$\n$$S_{pix} \\approx 0.85154\\,\\mathrm{pixels}$$\n问题要求将答案四舍五入到三位有效数字。\n$$S_{pix} \\approx 0.852\\,\\mathrm{pixels}$$\n因此，由磁化率引起的磁场不均匀性导致图像信息在相位编码方向上偏移了大约 $0.852$ 个像素。这种几何畸变是 fMRI 数据中的一种典型伪影。",
            "answer": "$$\\boxed{0.852}$$"
        },
        {
            "introduction": "与fMRI不同，EEG和MEG直接测量神经活动的电磁信号，但这些信号通常非常微弱，淹没在背景噪声中。为了提取有意义的事件相关电位（ERP），研究人员必须对许多试验进行平均。本练习将通过一个核心计算来揭示信号平均的力量：确定需要多少次试验才能达到所需的信噪比（SNR），从而将抽象的统计原理与EEG研究的日常实践联系起来。",
            "id": "5018722",
            "problem": "在功能性神经影像学中，脑电图 (EEG) 通过对重复试验的时间锁定响应进行平均，来测量事件相关电位 (ERP)，以提高信噪比 (SNR)。考虑一个 ERP 成分，其单次试验的信号振幅为 $5\\,\\mu\\mathrm{V}$，每次试验的加性噪声是零均值、平稳且跨试验独立的，其标准差为 $20\\,\\mu\\mathrm{V}$。使用以下基本事实：(i) SNR 定义为信号振幅与噪声标准差之比，以及 (ii) 对于跨试验独立同分布的噪声，$N$ 次试验算术平均值的方差是单次试验方差的 $1/N$。假设信号是完全锁相且跨试验相同的，因此平均过程保持其振幅不变。根据这些原理，推导平均 ERP 的信噪比作为试验次数 $N$ 的函数的表达式，并确定在平均 ERP 中达到 $\\text{SNR} = 5$ 所需的试验次数 $N$。将您的最终答案表示为一个不带单位的精确整数。",
            "solution": "问题陈述经评估有效，因为它基于神经影像学中信号处理的科学原理，提法恰当，包含了所有必要信息，并且表述客观。\n\n设 $S_1$ 表示单次试验的信号振幅，$\\sigma_1$ 表示单次试验中噪声的标准差。问题给出的这些值为：\n$$ S_1 = 5\\,\\mu\\mathrm{V} $$\n$$ \\sigma_1 = 20\\,\\mu\\mathrm{V} $$\n信噪比 (SNR) 定义为信号振幅与噪声标准差之比。因此，单次试验的信噪比，记为 $\\text{SNR}_1$，为：\n$$ \\text{SNR}_1 = \\frac{S_1}{\\sigma_1} = \\frac{5\\,\\mu\\mathrm{V}}{20\\,\\mu\\mathrm{V}} = \\frac{1}{4} $$\n创建事件相关电位 (ERP) 的过程涉及对 $N$ 次重复试验的信号进行平均。设 $S_N$ 为平均 ERP 的信号振幅，$\\sigma_N$ 为平均 ERP 噪声的标准差。\n\n根据问题陈述，信号分量是完全锁相且跨所有试验相同的。当我们计算 $N$ 个相同信号的算术平均值时，所得振幅保持不变。\n$$ S_N = \\frac{1}{N} \\sum_{i=1}^{N} S_1 = \\frac{N \\cdot S_1}{N} = S_1 = 5\\,\\mu\\mathrm{V} $$\n噪声分量被陈述为零均值、平稳且跨试验独立的。问题明确指出，对于此类噪声，$N$ 次试验算术平均值的方差是单次试验方差的 $1/N$。设 $\\text{Var}_1 = \\sigma_1^2$ 是单次试验中噪声的方差，并设 $\\text{Var}_N$ 是平均 ERP 中噪声的方差。它们的关系是：\n$$ \\text{Var}_N = \\frac{\\text{Var}_1}{N} = \\frac{\\sigma_1^2}{N} $$\n标准差是方差的平方根。因此，平均 ERP 中噪声的标准差 $\\sigma_N$ 为：\n$$ \\sigma_N = \\sqrt{\\text{Var}_N} = \\sqrt{\\frac{\\sigma_1^2}{N}} = \\frac{\\sigma_1}{\\sqrt{N}} $$\n我们现在可以推导平均 ERP 的信噪比 $\\text{SNR}_N$ 作为试验次数 $N$ 的函数的表达式。\n$$ \\text{SNR}_N = \\frac{S_N}{\\sigma_N} = \\frac{S_1}{\\left(\\frac{\\sigma_1}{\\sqrt{N}}\\right)} = \\left(\\frac{S_1}{\\sigma_1}\\right) \\sqrt{N} $$\n这可以用单次试验的信噪比来表示：\n$$ \\text{SNR}_N = \\text{SNR}_1 \\sqrt{N} $$\n代入 $\\text{SNR}_1 = \\frac{1}{4}$ 的值，我们得到此问题的具体表达式：\n$$ \\text{SNR}_N = \\frac{1}{4} \\sqrt{N} $$\n这个方程是解答所要求的第一部分，表示了平均 ERP 的信噪比作为 $N$ 的函数。\n\n任务的第二部分是确定达到信噪比为 $5$ 所需的试验次数 $N$。我们在推导出的方程中设 $\\text{SNR}_N = 5$，然后解出 $N$：\n$$ 5 = \\frac{1}{4} \\sqrt{N} $$\n为了分离出 $\\sqrt{N}$，我们将方程两边同乘以 $4$：\n$$ 20 = \\sqrt{N} $$\n最后，为了解出 $N$，我们将方程两边平方：\n$$ N = 20^2 = 400 $$\n因此，在平均 ERP 中，需要总共 400 次试验才能达到为 5 的信噪比。",
            "answer": "$$\\boxed{400}$$"
        },
        {
            "introduction": "在分析fMRI数据时，我们在大脑的数万个体素中分别进行统计检验，这带来了巨大的多重比较问题。如果不加以校正，我们可能会发现大量实际上是随机噪声的“激活”区域。本练习将引导你比较两种关键的校正策略——经典的Bonferroni校正和更现代的错误发现率（FDR）控制——让你能够通过计算理解它们在统计功效和严格性上的根本差异。",
            "id": "5018733",
            "problem": "在一项基于任务的功能性磁共振成像（fMRI）研究中，对每个体素拟合一个质量单变量广义线性模型，从而产生一个遍布全脑的体素级p值向量。假设有 $50{,}000$ 个体素，并且排序后的p值 $\\{p_{(k)}\\}_{k=1}^{50{,}000}$（从小到大排序）遵循以下经验观察到的单调关系\n$$\np_{(k)} \\;=\\; 0.12 \\left(\\frac{k}{50{,}000}\\right)^{1.5} \\quad \\text{for} \\quad k=1,2,\\dots,50{,}000.\n$$\n仅使用基本定义，计算：\n1) 对 $50{,}000$ 个体素级检验，在总体水平 $\\alpha=0.05$ 下控制族总错误率（FWER）的Bonferroni阈值。\n2) 应用于上述排序后的p值，在目标水平 $q=0.05$ 下的Benjamini–Hochberg错误发现率（FDR）阈值。该阈值定义为，在所有拒绝的假设中，错误拒绝的期望比例不超过 $q$ 的最大秩相关阈值。\n\n按 $[\\text{Bonferroni阈值}, \\text{Benjamini–Hochberg阈值}]$ 的顺序列出一个双元素行向量来报告这两个阈值。将两个阈值均四舍五入至四位有效数字。无需单位。最后，基于错误率控制的基本原理，简要解释为什么在高维神经影像学中，Benjamini–Hochberg程序通常比Bonferroni校正更具统计功效。\n\n在答案中按以上要求给出最终的数值阈值，四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，并被确定为神经影像统计学领域中一个有效且适定的问题。所有必要信息均已提供，且问题基于成熟的统计理论。\n\n设 $m$ 为体素级检验的总数，其中 $m = 50,000$。排序后的p值由模型 $p_{(k)} = 0.12 \\left(\\frac{k}{m}\\right)^{1.5}$ 给出，其中 $k=1, 2, \\dots, m$。\n\n**1) Bonferroni阈值**\n\nBonferroni校正控制族总错误率（FWER），即在所有 $m$ 个检验中犯至少一次I类错误（假阳性）的概率。为将FWER控制在指定的水平 $\\alpha$，Bonferroni方法对每个单独的检验应用一个统一的显著性阈值 $\\alpha_{bonf}$。该阈值由Bonferroni不等式推导得出，该不等式表明 $FWER \\le m \\cdot \\alpha_{test}$。为确保 $FWER \\le \\alpha$，我们将每个检验的阈值设置为：\n$$\n\\alpha_{bonf} = \\frac{\\alpha}{m}\n$$\n给定总体显著性水平 $\\alpha = 0.05$ 且检验次数 $m = 50,000$，Bonferroni阈值为：\n$$\n\\alpha_{bonf} = \\frac{0.05}{50,000} = \\frac{5 \\times 10^{-2}}{5 \\times 10^4} = 1 \\times 10^{-6}\n$$\n将此结果四舍五入至四位有效数字，Bonferroni阈值为 $1.000 \\times 10^{-6}$。在此校正下，任何p值 $p \\le 1.000 \\times 10^{-6}$ 的体素都将被宣布为统计上显著的。\n\n**2) Benjamini–Hochberg错误发现率（FDR）阈值**\n\nBenjamini–Hochberg（BH）程序控制错误发现率（FDR），即在所有被拒绝的原假设（即所有“发现”）中I类错误的期望比例。该程序如下：\n1.  将 $m$ 个p值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。\n2.  对于一个目标FDR水平 $q$，找到最大的整数索引 $k$（记作 $k_{FDR}$），使得该秩次的p值满足以下条件：\n    $$\n    p_{(k)} \\le \\frac{k}{m} q\n    $$\n3.  拒绝所有 $i=1, \\dots, k_{FDR}$ 的原假设 $H_{(i)}$。这等同于将显著性阈值设为 $p_{(k_{FDR})}$。\n\n我们已知排序后p值的模型为：$p_{(k)} = 0.12 \\left(\\frac{k}{m}\\right)^{1.5}$。我们将此模型代入BH不等式，其中 $q = 0.05$ 且 $m = 50,000$：\n$$\n0.12 \\left(\\frac{k}{m}\\right)^{1.5} \\le \\frac{k}{m} \\cdot 0.05\n$$\n对于 $k > 0$，我们可以将两边同时除以正数 $\\frac{k}{m}$：\n$$\n0.12 \\left(\\frac{k}{m}\\right)^{0.5} \\le 0.05\n$$\n解出比率 $\\frac{k}{m}$：\n$$\n\\left(\\frac{k}{m}\\right)^{0.5} \\le \\frac{0.05}{0.12}\n$$\n$$\n\\frac{k}{m} \\le \\left(\\frac{0.05}{0.12}\\right)^2 = \\left(\\frac{5}{12}\\right)^2 = \\frac{25}{144}\n$$\n现在，我们找到满足此条件的最大整数秩 $k$：\n$$\nk \\le m \\cdot \\frac{25}{144} = 50,000 \\cdot \\frac{25}{144} = \\frac{1,250,000}{144} \\approx 8680.555...\n$$\n由于 $k$ 必须是整数，满足该不等式的最大秩为 $k_{FDR} = 8680$。\n\nBH阈值是与此秩相对应的p值，即 $p_{(k_{FDR})}$。我们使用给定的 $p_{(k)}$ 模型并代入 $k = 8680$ 进行计算：\n$$\np_{FDR} = p_{(8680)} = 0.12 \\left(\\frac{8680}{50,000}\\right)^{1.5}\n$$\n首先，计算比率：\n$$\n\\frac{8680}{50,000} = 0.1736\n$$\n现在将此值代入阈值的表达式中：\n$$\np_{FDR} = 0.12 \\times (0.1736)^{1.5} = 0.12 \\times (0.1736) \\times \\sqrt{0.1736} \\approx 0.12 \\times 0.1736 \\times 0.4166533\n$$\n$$\np_{FDR} \\approx 0.008680008...\n$$\n将此结果四舍五入至四位有效数字，Benjamini–Hochberg阈值为 $0.008680$。\n\n**统计功效差异的解释**\n\n在诸如神经影像学的高维环境中，Benjamini–Hochberg（BH）程序通常比Bonferroni校正更具统计功效，因为BH程序基于一个较不严格的错误控制标准。\n\n1.  **错误标准**：Bonferroni方法控制族总错误率（FWER），即做出哪怕一个错误发现的概率（$P(\\text{至少一个假阳性}) \\le \\alpha$）。当检验次数（$m$）很大时，这是一个极其严格的标准，因为它旨在防止在整个检验“族”中出现任何假阳性。这种严格性导致了一个非常低的显著性阈值（$\\alpha_{bonf} = \\alpha/m = 1 \\times 10^{-6}$），从而降低了检测真实效应的能力（即统计功效较低）。\n\n2.  **自适应阈值**：相比之下，BH程序控制错误发现率（FDR），即在所有显著性发现中，错误发现的期望*比例*（$E[\\frac{\\text{假阳性}}{\\text{总发现数}}] \\le q$）。该标准承认，在一次大规模分析中，只要少量假阳性占总发现的一小部分，它们就是可以容忍的。BH阈值不是固定的，而是根据数据本身自适应地确定。它是保持在直线 $\\frac{k}{m}q$ 以下的最大的p值 $p_{(k)}$。\n\n3.  **由此产生的统计功效**：因为FDR标准比FWER标准更不保守，所以BH程序得出的显著性阈值（$p_{FDR} \\approx 0.008680$）通常远大于Bonferroni阈值（$\\alpha_{bonf} = 0.000001$）。更高的阈值意味着更多的原假设将被拒绝。虽然这增加了犯下一些错误发现的风险，但它也大大增加了检测到真实效应的概率，从而产生更强的统计功效。在fMRI研究中，可能有数千个体素被真正激活，在这种情况下，控制错误的比例（FDR）是比试图消除所有错误（FWER）更实用、更有效的方法。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1.000 \\times 10^{-6}  0.008680 \\end{pmatrix}}\n$$"
        }
    ]
}