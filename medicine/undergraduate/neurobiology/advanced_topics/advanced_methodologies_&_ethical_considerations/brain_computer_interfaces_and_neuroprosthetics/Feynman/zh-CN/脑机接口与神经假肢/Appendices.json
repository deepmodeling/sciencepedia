{
    "hands_on_practices": [
        {
            "introduction": "任何脑机接口（BCI）的核心功能都是采集神经信号。第一个实践练习将带你进入BCI系统的最前端，探索决定数据产生量的基本工程考量。通过计算一个典型的微电极阵列的原始数据速率和存储需求，你将对神经技术中的“大数据”挑战获得一个切实的理解，并认识到数据压缩和实时处理的至关重要性。",
            "id": "4457855",
            "problem": "在一个脑机接口 (BCI) 应用中，一个多通道细胞外记录系统使用具有 $96$ 个独立通道的微电极阵列 (MEA) 来采集神经元尖峰波形。每个通道以 $30\\,\\mathrm{kHz}$ 的恒定采样频率进行数字化，模数转换器 (ADC) 的分辨率为每样本 $12$ 位。假设是连续采集、各通道同步采样，并且是原始流式传输，没有压缩、成帧、元数据或线路编码开销；假设样本按位紧密打包，因此每个样本恰好存储 $12$ 位。\n\n从采样频率（每秒样本数）和数字系统中信息表示（每样本位数）的基本定义出发，推导计算以下内容所需的表达式：\n1. 整个系统的原始数据速率。\n2. 录制 $1$ 小时所需的总存储量。\n\n使用十进制定义 $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$ 和 $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$，将原始数据速率以兆字节每秒 (MB/s) 表示，总存储量以吉字节 (GB) 表示。提供最终的数值，无需四舍五入。",
            "solution": "我们使用的基本定义是：\n- 采样频率 $f_{s}$ 给出每通道每秒产生的样本数。\n- 模数转换器分辨率 $n_{b}$ 给出用于表示每个样本的位数。\n- 对于 $N_{c}$ 个独立同步采样的通道，每秒的总样本数为 $N_{c} f_{s}$。\n- 原始比特率是每秒样本数与每样本位数的乘积。\n\n设 $f_{s} = 30\\,\\mathrm{kHz} = 30{,}000\\,\\mathrm{s}^{-1}$，$n_{b} = 12\\,\\mathrm{bits/sample}$，以及 $N_{c} = 96$ 个通道。\n\n原始比特率 $R_{\\mathrm{bits}}$ 为\n$$\nR_{\\mathrm{bits}} = f_{s} \\times n_{b} \\times N_{c}.\n$$\n代入符号，然后代入数值：\n$$\nR_{\\mathrm{bits}} = 30{,}000 \\times 12 \\times 96 = 34{,}560{,}000 \\ \\text{bits/s}.\n$$\n\n要转换为字节每秒，使用 $1\\,\\mathrm{byte} = 8\\,\\mathrm{bits}$：\n$$\nR_{\\mathrm{bytes}} = \\frac{R_{\\mathrm{bits}}}{8} = \\frac{34{,}560{,}000}{8} = 4{,}320{,}000 \\ \\text{bytes/s}.\n$$\n\n要以兆字节每秒（十进制）表示原始数据速率，使用 $1\\,\\mathrm{MB} = 10^{6}\\,\\mathrm{bytes}$：\n$$\nR_{\\mathrm{MB/s}} = \\frac{R_{\\mathrm{bytes}}}{10^{6}} = \\frac{4{,}320{,}000}{1{,}000{,}000} = 4.32.\n$$\n\n接下来，计算录制时长 $T = 1\\,\\mathrm{hour} = 3600\\,\\mathrm{s}$ 所需的总存储量。存储的总字节数 $S_{\\mathrm{bytes}}$ 为\n$$\nS_{\\mathrm{bytes}} = R_{\\mathrm{bytes}} \\times T = 4{,}320{,}000 \\times 3{,}600 = 15{,}552{,}000{,}000 \\ \\text{bytes}.\n$$\n\n使用 $1\\,\\mathrm{GB} = 10^{9}\\,\\mathrm{bytes}$ 转换为吉字节（十进制）：\n$$\nS_{\\mathrm{GB}} = \\frac{S_{\\mathrm{bytes}}}{10^{9}} = \\frac{15{,}552{,}000{,}000}{1{,}000{,}000{,}000} = 15.552.\n$$\n\n因此，在所述的假设和十进制单位定义下，原始数据速率为 $4.32\\,\\mathrm{MB/s}$，一小时所需的存储量为 $15.552\\,\\mathrm{GB}$。",
            "answer": "$$\\boxed{4.32, 15.552}$$"
        },
        {
            "introduction": "当神经数据被采集和解码后，我们如何客观地衡量一个BCI系统的性能？这个实践练习超越了简单的准确率，引入了信息传输速率（ITR），这是评估基于通信的BCI性能的黄金标准。通过推导ITR公式并将其应用于一个假设的BCI拼写器，你将学会如何量化从大脑到计算机的信息流，这是比较不同BCI设计和解码算法的一项关键技能。",
            "id": "5002103",
            "problem": "脑机接口（BCI）拼写器向用户呈现一组固定的 $N$ 个等概率符号。每个选择试验从提示出现到最终输出需要 $T$ 秒，分类器以概率 $P$ 选择目标符号；当发生错误时，错误均匀分布在 $N-1$ 个非目标符号上。假设各试验相互独立，且符号的先验概率是均匀的。\n\n从 Shannon 熵和互信息的基本定义出发，推导用于形式化以下指标的表达式：\n- 符号吞吐量（每分钟预期正确通信的符号数），\n- 原始比特率上限（假设 $N$ 元符号无差错通信时的每分钟比特数），\n- 信息传输率（在所述错误模型下，通过选择通道的每分钟互信息量）。\n\n然后，对于一个参数为 $N=36$，$T=4\\,\\mathrm{s}$，$P=0.85$ 的拼写器，计算符号吞吐量、原始比特率和信息传输率的数值。请报告信息传输率的最终数值，单位为比特/分钟。将您的最终答案四舍五入到四位有效数字，并以比特/分钟为单位表示。",
            "solution": "### 性能指标的推导\n\n我们将根据给定的参数 $N$、$T$ 和 $P$ 推导所要求的三个指标的表达式。所有信息论量将使用以 2 为底的对数计算，结果以比特为单位。每分钟可以进行的试验（选择）次数由 $\\frac{60}{T}$ 给出。\n\n**1. 符号吞吐量 (ST)**\n符号吞吐量是单位时间内预期正确通信的符号数量。\n单次试验产生正确符号的概率为 $P$。因此，每次试验的预期正确符号数为 $1 \\times P + 0 \\times (1-P) = P$。\n将每次试验的预期正确符号数乘以每分钟的试验次数，即可得到以“符号/分钟”为单位的符号吞吐量。\n$$\n\\text{ST} = P \\times \\frac{60}{T}\n$$\n\n**2. 原始比特率上限 (RBUB)**\n原始比特率代表假设无差错通信（$P=1$）时的理论最大信息传输率。对于一个有 $N$ 个等概率符号的信源，其 Shannon 熵（每个符号的信息量）为 $H = \\log_2(N)$。\n原始比特率是每个符号的信息量乘以每分钟选择的符号数。\n$$\n\\text{RBUB} = \\log_2(N) \\times \\frac{60}{T}\n$$\n\n**3. 信息传输率 (ITR)**\nITR 量化了通过噪声信道成功传输的实际信息量。它被定义为目标符号和分类器输出之间的互信息，以单位时间表示。\n\n令 $X$ 为代表用户意图符号的随机变量，$Y$ 为 BCI 分类器选择的符号的随机变量。$X$ 和 $Y$ 都可以取 $N$ 个可能符号值中的任意一个。\n\n每次试验的互信息 $I(X;Y)$ 由下式给出：\n$$\nI(X;Y) = H(Y) - H(Y|X)\n$$\n其中 $H(Y)$ 是输出分布的熵，$H(Y|X)$ 是给定输入下输出的条件熵。\n\n由于目标符号的先验概率是均匀的（$p(x) = \\frac{1}{N}$）以及错误模型的对称性，输出分布 $p(y)$ 也是均匀的。我们可以验证这一点：\n$$\np(y) = \\sum_{x} p(y|x)p(x) = p(y|x=y)p(x=y) + \\sum_{x \\neq y} p(y|x \\neq y)p(x \\neq y)\n$$\n$$\np(y) = P \\cdot \\frac{1}{N} + (N-1) \\cdot \\left(\\frac{1-P}{N-1}\\right) \\cdot \\frac{1}{N} = \\frac{P}{N} + \\frac{1-P}{N} = \\frac{1}{N}\n$$\n由于输出分布是均匀的，其熵为：\n$$\nH(Y) = -\\sum_{y} p(y)\\log_2(p(y)) = -\\sum_{i=1}^N \\frac{1}{N}\\log_2\\left(\\frac{1}{N}\\right) = \\log_2(N)\n$$\n\n接下来，我们计算条件熵 $H(Y|X)$，它表示在已知输入的情况下输出的不确定性。\n$$\nH(Y|X) = -\\sum_{x,y} p(x,y) \\log_2(p(y|x)) = -\\sum_{x} p(x) \\sum_{y} p(y|x)\\log_2(p(y|x))\n$$\n由于信道的对称性，内部的和对于所有的 $x$ 都是相同的。对于任何给定的输入 $x$，正确输出的概率是 $p(y=x|x) = P$，而任何特定错误输出 $y \\neq x$ 的概率是 $p(y \\neq x|x) = \\frac{1-P}{N-1}$。\n对于给定的 $x$，其熵为：\n$$\nH(Y|X=x) = -p(y=x|x)\\log_2(p(y=x|x)) - \\sum_{y \\neq x} p(y \\neq x|x)\\log_2(p(y \\neq x|x))\n$$\n$$\nH(Y|X=x) = -P\\log_2(P) - (N-1)\\left(\\frac{1-P}{N-1}\\right)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\n$$\nH(Y|X=x) = -P\\log_2(P) - (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\n因为这对所有的 $x$ 都是一个常数，所以 $H(Y|X) = H(Y|X=x)$。\n\n现在我们可以计算每次试验的互信息，通常表示为 $B$：\n$$\nB = I(X;Y) = H(Y) - H(Y|X) = \\log_2(N) - \\left[-P\\log_2(P) - (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\\right]\n$$\n$$\nB = \\log_2(N) + P\\log_2(P) + (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right)\n$$\n这个表达式给出了每次试验传输的信息量（单位：比特）。ITR 是这个量乘以每分钟的试验次数：\n$$\n\\text{ITR} = \\left[ \\log_2(N) + P\\log_2(P) + (1-P)\\log_2\\left(\\frac{1-P}{N-1}\\right) \\right] \\times \\frac{60}{T}\n$$\n\n### 数值计算\n给定数值 $N=36$，$T=4\\,\\mathrm{s}$ 和 $P=0.85$。\n每分钟的试验次数为 $\\frac{60}{4} = 15$。\n\n**1. 符号吞吐量 (ST)**\n$$\n\\text{ST} = 0.85 \\times 15 = 12.75 \\text{ 符号/分钟}\n$$\n\n**2. 原始比特率上限 (RBUB)**\n$$\n\\text{RBUB} = \\log_2(36) \\times 15 = \\frac{\\ln(36)}{\\ln(2)} \\times 15 \\approx 5.1699 \\times 15 \\approx 77.55 \\text{ 比特/分钟}\n$$\n\n**3. 信息传输率 (ITR)**\n首先，我们计算每次试验的信息量 $B$：\n$$\nB = \\log_2(36) + 0.85\\log_2(0.85) + (1-0.85)\\log_2\\left(\\frac{1-0.85}{36-1}\\right)\n$$\n$$\nB = \\log_2(36) + 0.85\\log_2(0.85) + 0.15\\log_2\\left(\\frac{0.15}{35}\\right)\n$$\n我们计算各项的值：\n- $\\log_2(36) \\approx 5.169925$\n- $0.85\\log_2(0.85) = 0.85 \\times \\frac{\\ln(0.85)}{\\ln(2)} \\approx 0.85 \\times (-0.234453) \\approx -0.199285$\n- $0.15\\log_2\\left(\\frac{0.15}{35}\\right) = 0.15 \\times \\frac{\\ln(0.15/35)}{\\ln(2)} \\approx 0.15 \\times (-7.86613) \\approx -1.179920$\n将这些项相加得到每次试验的比特数：\n$$\nB \\approx 5.169925 - 0.199285 - 1.179920 \\approx 3.79072 \\text{ 比特/试验}\n$$\n最后，我们计算以比特/分钟为单位的 ITR：\n$$\n\\text{ITR} = B \\times 15 \\approx 3.79072 \\times 15 \\approx 56.8608 \\text{ 比特/分钟}\n$$\n将 ITR 的最终答案四舍五入到四位有效数字，得到 $56.86$ 比特/分钟。",
            "answer": "$$\n\\boxed{56.86}\n$$"
        },
        {
            "introduction": "脑机接口不仅是从大脑“读取”信息；许多先进的神经假体也通过微电刺激向大脑“写入”信息。最后的这个实践练习探讨了这类系统中至关重要的问题：安全性。通过根据刺激电极的材料特性和脉冲持续时间计算其最大安全电流，你将接触到电化学安全和生物相容性的关键原则，这些原则是所有植入式神经设备设计的基础。",
            "id": "4457814",
            "problem": "一个由溅射氧化铱薄膜制成的皮层微刺激电极被用于脑机接口中以提供体感反馈。为避免不可逆法拉第反应和组织损伤，刺激受到材料每相可逆电荷注入极限的限制。假设使用一个矩形、恒流、阴极优先的双相脉冲，其阴极相持续时间为 $200\\,\\mu\\text{s}$。电极的几何表面积为 $A=0.02\\,\\text{cm}^2$，并且制造商报告称，在相关波形和偏置条件下，阴极相的每相可逆电荷注入极限为 $\\sigma_{\\text{max}}=0.35\\,\\text{mC/cm}^2$。为安全起见，该设备在 $10\\%$ 的安全裕度下运行，此处定义为将操作限制在每相理论最大可逆电荷的 $90\\%$。\n\n仅使用以下基本关系：(i) 某一相中传递的电荷是该相电流对时间的积分，以及 (ii) 每相电荷不得超过可逆单位面积极限与几何面积的乘积，计算阴极相的最大安全电流幅值。最终答案以毫安为单位表示，并四舍五入到三位有效数字。",
            "solution": "问题陈述已经过评估并被确定为有效。它具有科学依据，问题定义明确，客观，完整，并包含了神经工程领域问题中的现实参数。\n\n目标是计算双相刺激脉冲阴极相的最大安全电流幅值 $I_{\\text{safe, max}}$。这将通过遵守电荷注入的约束条件来完成。\n\n首先，我们用符号定义所提供的参数：\n- 阴极相持续时间：$t_c = 200\\,\\mu\\text{s}$\n- 电极几何表面积：$A = 0.02\\,\\text{cm}^2$\n- 每相可逆电荷注入极限（单位面积电荷密度）：$\\sigma_{\\text{max}} = 0.35\\,\\text{mC/cm}^2$\n- 安全系数：$S_f = 0.90$（根据 $10\\%$ 的安全裕度，表示在最大极限的 $90\\%$ 下运行）。\n\n该问题受两个明确说明的基本关系支配。\n\n首先，在单相期间可以注入的最大理论可逆电荷 $Q_{\\text{max, theoretical}}$ 是材料的单位面积电荷注入极限 $\\sigma_{\\text{max}}$ 与电极的几何表面积 $A$ 的乘积。\n$$Q_{\\text{max, theoretical}} = \\sigma_{\\text{max}} \\times A$$\n\n其次，为安全起见，操作电荷不得超过该理论最大值的一定比例。因此，通过应用安全系数 $S_f$ 来确定每相最大安全电荷 $Q_{\\text{safe}}$。\n$$Q_{\\text{safe}} = S_f \\times Q_{\\text{max, theoretical}} = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\n第三，由恒定电流 $I$ 在持续时间 $t$ 内传递的总电荷 $Q$ 是电流与持续时间的乘积。这是在时间间隔内对恒定电流进行积分的结果。对于阴极相，传递的电荷为：\n$$Q_c = I_c \\times t_c$$\n其中 $I_c$ 是阴极相期间的电流幅值。\n\n为了找到最大安全电流幅值 $I_{\\text{safe, max}}$，我们将阴极相期间传递的电荷设置为等于最大安全电荷极限 $Q_{\\text{safe}}$。\n$$I_{\\text{safe, max}} \\times t_c = Q_{\\text{safe}}$$\n\n代入 $Q_{\\text{safe}}$ 的表达式得到：\n$$I_{\\text{safe, max}} \\times t_c = S_f \\times \\sigma_{\\text{max}} \\times A$$\n\n现在我们可以求解 $I_{\\text{safe, max}}$：\n$$I_{\\text{safe, max}} = \\frac{S_f \\times \\sigma_{\\text{max}} \\times A}{t_c}$$\n\n现在，我们将给定的数值代入该方程。保持单位一致性至关重要。我们将首先以毫库仑（$ \\text{mC} $）为单位计算 $Q_{\\text{safe}}$。\n$$Q_{\\text{safe}} = 0.90 \\times (0.35\\,\\frac{\\text{mC}}{\\text{cm}^2}) \\times (0.02\\,\\text{cm}^2)$$\n$$Q_{\\text{safe}} = 0.90 \\times 0.007\\,\\text{mC}$$\n$$Q_{\\text{safe}} = 0.0063\\,\\text{mC}$$\n\n接下来，我们计算 $I_{\\text{safe, max}}$。电荷的单位是毫库仑（$ \\text{mC} $），持续时间的单位是微秒（$ \\mu\\text{s} $）。明智的做法是先将这些单位转换为国际单位制（SI）的基本单位（库仑和秒），以安培为单位求出电流，最后再根据要求转换为毫安。\n$Q_{\\text{safe}} = 0.0063\\,\\text{mC} = 0.0063 \\times 10^{-3}\\,\\text{C} = 6.3 \\times 10^{-6}\\,\\text{C}$\n$t_c = 200\\,\\mu\\text{s} = 200 \\times 10^{-6}\\,\\text{s} = 2.0 \\times 10^{-4}\\,\\text{s}$\n\n现在，我们以安培（$ \\text{A} $）为单位计算电流：\n$$I_{\\text{safe, max}} = \\frac{Q_{\\text{safe}}}{t_c} = \\frac{6.3 \\times 10^{-6}\\,\\text{C}}{2.0 \\times 10^{-4}\\,\\text{s}}$$\n$$I_{\\text{safe, max}} = 3.15 \\times 10^{-2}\\,\\text{A}$$\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A}$$\n\n问题要求最终答案以毫安（$ \\text{mA} $）为单位表示，并四舍五入到三位有效数字。为了从安培转换为毫安，我们乘以 $1000$：\n$$I_{\\text{safe, max}} = 0.0315\\,\\text{A} \\times \\frac{1000\\,\\text{mA}}{1\\,\\text{A}} = 31.5\\,\\text{mA}$$\n\n值 $31.5$ 恰好有三位有效数字（$3$，$1$ 和 $5$）。因此，无需进一步四舍五入。阴极相的最大安全电流幅值为 $31.5\\,\\text{mA}$。",
            "answer": "$$\n\\boxed{31.5}\n$$"
        }
    ]
}