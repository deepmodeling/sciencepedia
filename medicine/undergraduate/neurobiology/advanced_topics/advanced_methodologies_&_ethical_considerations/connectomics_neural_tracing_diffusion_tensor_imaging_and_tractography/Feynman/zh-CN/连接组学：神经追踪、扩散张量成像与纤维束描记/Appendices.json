{
    "hands_on_practices": [
        {
            "introduction": "神经束追踪算法通过在弥散张量场中“行走”来重建白质通路。这个过程在数学上等同于求解一个常微分方程。本练习将探讨两种基础的数值积分方法——欧拉法和龙格-库塔法，它们是构建神经束的核心。通过推导这些方法并分析其误差累积，您将深刻理解神经束是如何生成的，以及步长等算法选择为何会引入系统性偏差 。",
            "id": "5009373",
            "problem": "在纤维束示踪（tractography）中，一条确定性流线（deterministic streamline）遵循从扩散张量成像（Diffusion Tensor Imaging, DTI）获得的主扩散方向。令 $\\mathbf{n}(\\mathbf{x})$ 表示单位主特征向量场（最快扩散率的单位方向），并用弧长 $s$ 对流线进行参数化，因此曲线 $\\mathbf{x}(s)$ 满足常微分方程 $d\\mathbf{x}/ds = \\mathbf{n}(\\mathbf{x})$，其中 $|\\mathbf{n}(\\mathbf{x})| = 1$。以此为基础，推导流线的两种显式数值更新方案：一阶显式 Euler 方法和经典的四阶 Runge–Kutta 方法。然后分析使用有限步长所产生的角度误差的累积。\n\n为了进行角度误差分析，考虑一个二维旋转单位向量场模型，该模型围绕中心 $\\mathbf{c} = (0, R)$ 生成曲率为 $\\kappa = 1/R$ 的恒定曲率圆形流线。取初始点 $\\mathbf{x}(0) = (0, 0)$，使得 $s=0$ 处的真实切线指向 x 轴正方向。使用弧长步长 $h$。\n\n1. 仅从该场的几何定义和流线常微分方程出发，用 $\\mathbf{n}(\\mathbf{x})$ 和 $h$ 推导从 $\\mathbf{x}_{k}$ 到 $\\mathbf{x}_{k+1}$ 的显式 Euler 和经典四阶 Runge–Kutta 更新方案。\n\n2. 对于圆形场，计算步长为 $h$ 的一步后，在经 Euler 方法更新的点 $\\mathbf{x}_{1}^{E}$ 处预测的切线方向（方向角），并将其与弧长 $s=h$ 处的真实切线方向进行比较。求出每步角度偏差 $\\delta \\theta_{\\text{step}}$ 的闭式表达式及其关于小 $h$ 的主项。\n\n3. 假设对于此恒定曲率场，在第 2 部分中获得的每步角度偏差在各步中保持不变。再假设，由于从扩散张量估计 $\\mathbf{n}(\\mathbf{x})$ 的不确定性，每一步都存在一个独立的、标准差为 $\\sigma$（单位为弧度）的零均值角度噪声。在总弧长为 $L$、步数为 $N = L/h$ 的情况下，推导最终均方根（RMS）角度误差 $\\theta_{\\text{RMS}}$ 作为 $R$, $h$, $L$ 和 $\\sigma$ 的函数表达式。然后，对 $R = 40$ 毫米、$L = 120$ 毫米、$h = 4$ 毫米和 $\\sigma = 0.005$ 弧度的情况，数值计算 $\\theta_{\\text{RMS}}$。以度为单位表示您的最终数值答案，并将其四舍五入到四位有效数字。",
            "solution": "该问题已经过验证，被认为是一个基于数值分析和计算神经科学原理的、有效的、适定的科学问题。\n\n任务是为流线纤维束示踪推导数值积分方案，然后在一个圆形向量场的特定测试案例中，分析 Euler 方法的角度误差累积。\n\n### 第 1 部分：数值更新方案的推导\n\n问题将流线轨迹 $\\mathbf{x}(s)$ 定义为常微分方程（ODE）的解：\n$$\n\\frac{d\\mathbf{x}}{ds} = \\mathbf{n}(\\mathbf{x}(s))\n$$\n其中 $s$ 是弧长，$\\mathbf{n}(\\mathbf{x})$ 是一个单位向量场，满足 $|\\mathbf{n}(\\mathbf{x})| = 1$。这是一个形式为 $\\frac{d\\mathbf{y}}{dt} = f(t, \\mathbf{y})$ 的标准初值问题，此处 $t \\to s$，$\\mathbf{y} \\to \\mathbf{x}$，且函数 $f$ 与参数 $s$ 无关，即 $f(\\mathbf{x}) = \\mathbf{n}(\\mathbf{x})$。\n我们被要求推导两种数值更新方案来近似该解，使用步长 $h$ 从点 $\\mathbf{x}_k = \\mathbf{x}(s_k)$ 前进到 $\\mathbf{x}_{k+1} \\approx \\mathbf{x}(s_k+h)$。\n\n**1. 一阶显式 Euler 方法：**\n显式 Euler 方法通过沿当前点切线场的方向取一个线性步长来近似解。其通用公式为 $\\mathbf{y}_{k+1} = \\mathbf{y}_k + h f(t_k, \\mathbf{y}_k)$。将此应用于我们的常微分方程，得到：\n$$\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + h \\mathbf{n}(\\mathbf{x}_k)\n$$\n\n**2. 经典的四阶 Runge–Kutta (RK4) 方法：**\nRK4 方法通过在步长内评估几个中间点的方向场 $\\mathbf{n}(\\mathbf{x})$ 来提供更精确的近似。其通用公式为：\n$$\n\\mathbf{y}_{k+1} = \\mathbf{y}_k + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n其中\n\\begin{align*}\n\\mathbf{k}_1 = f(t_k, \\mathbf{y}_k) \\\\\n\\mathbf{k}_2 = f(t_k + h/2, \\mathbf{y}_k + (h/2)\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = f(t_k + h/2, \\mathbf{y}_k + (h/2)\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = f(t_k + h, \\mathbf{y}_k + h\\mathbf{k}_3)\n\\end{align*}\n将此应用于我们的特定常微分方程 $\\frac{d\\mathbf{x}}{ds} = \\mathbf{n}(\\mathbf{x})$，从 $\\mathbf{x}_k$ 到 $\\mathbf{x}_{k+1}$ 的更新方案是：\n\\begin{align*}\n\\mathbf{k}_1 = \\mathbf{n}(\\mathbf{x}_k) \\\\\n\\mathbf{k}_2 = \\mathbf{n}\\left(\\mathbf{x}_k + \\frac{h}{2}\\mathbf{k}_1\\right) \\\\\n\\mathbf{k}_3 = \\mathbf{n}\\left(\\mathbf{x}_k + \\frac{h}{2}\\mathbf{k}_2\\right) \\\\\n\\mathbf{k}_4 = \\mathbf{n}\\left(\\mathbf{x}_k + h\\mathbf{k}_3\\right) \\\\\n\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{align*}\n\n### 第 2 部分：Euler 方法的角度误差分析\n\n我们考虑一个二维旋转场，该场围绕中心 $\\mathbf{c} = (0, R)$ 生成半径为 $R$、曲率为 $\\kappa=1/R$ 的圆形流线。初始条件为 $\\mathbf{x}(0) = (0, 0)$，初始切线沿 x 轴正方向，即 $\\mathbf{n}(\\mathbf{x}(0)) = (1, 0)$。\n\n首先，我们必须定义向量场 $\\mathbf{n}(\\mathbf{x})$。对于任意点 $\\mathbf{x}=(x,y)$，从旋转中心出发的向量为 $\\mathbf{r} = \\mathbf{x} - \\mathbf{c} = (x, y-R)$。切向量 $\\mathbf{n}(\\mathbf{x})$ 必须垂直于 $\\mathbf{r}$。一个与 $(a,b)$ 垂直的向量是 $(-b,a)$。因此，一个与圆相切的向量场是 $(-(y-R), x) = (R-y, x)$。为了使其成为单位向量场，我们将其单位化：\n$$\n\\mathbf{n}(\\mathbf{x}) = \\mathbf{n}(x,y) = \\frac{(R-y, x)}{\\sqrt{(R-y)^2 + x^2}}\n$$\n在初始点 $\\mathbf{x}_0 = (0,0)$，该场为 $\\mathbf{n}(0,0) = \\frac{(R,0)}{\\sqrt{R^2+0^2}} = (1,0)$，这与给定的初始条件相符。\n\n我们现在用步长 $h$ 执行一步 Euler 方法：\n$$\n\\mathbf{x}_{1}^{E} = \\mathbf{x}_0 + h \\mathbf{n}(\\mathbf{x}_0) = (0,0) + h(1,0) = (h,0)\n$$\n问题要求的是在这个新点 $\\mathbf{x}_{1}^{E}$ 处预测的切线方向。我们计算在该点的场 $\\mathbf{n}$：\n$$\n\\mathbf{n}(\\mathbf{x}_{1}^{E}) = \\mathbf{n}(h,0) = \\frac{(R-0, h)}{\\sqrt{(R-0)^2 + h^2}} = \\frac{(R, h)}{\\sqrt{R^2 + h^2}}\n$$\n这个预测切向量的方向角是：\n$$\n\\theta_{1}^{E} = \\arctan\\left(\\frac{h/ \\sqrt{R^2+h^2}}{R/ \\sqrt{R^2+h^2}}\\right) = \\arctan\\left(\\frac{h}{R}\\right)\n$$\n接下来，我们求弧长 $s=h$ 处的真实切线方向。切线角 $\\theta$ 相对于弧长 $s$ 的变化率是曲率 $\\kappa$。因此，$\\frac{d\\theta}{ds} = \\kappa = \\frac{1}{R}$。在初始条件 $\\theta(0)=0$ 下，$s=h$ 处的真实角度是：\n$$\n\\theta_{\\text{true}}(h) = \\int_0^h \\frac{1}{R} ds = \\frac{h}{R}\n$$\n每步角度偏差 $\\delta \\theta_{\\text{step}}$ 是预测切线角与真实切线角之差：\n$$\n\\delta \\theta_{\\text{step}} = \\theta_{1}^{E} - \\theta_{\\text{true}}(h) = \\arctan\\left(\\frac{h}{R}\\right) - \\frac{h}{R}\n$$\n为了求出关于小 $h$ 的主项，我们使用 $\\arctan(z)$ 在 $z=0$ 附近的泰勒级数展开式，即 $\\arctan(z) = z - \\frac{z^3}{3} + O(z^5)$。令 $z = h/R$：\n$$\n\\delta \\theta_{\\text{step}} = \\left(\\frac{h}{R} - \\frac{1}{3}\\left(\\frac{h}{R}\\right)^3 + O\\left(h^5\\right)\\right) - \\frac{h}{R} = -\\frac{1}{3}\\frac{h^3}{R^3} + O\\left(h^5\\right)\n$$\n每步角度偏差关于小 $h$ 的主项是 $-\\frac{h^3}{3R^3}$。\n\n### 第 3 部分：RMS 角度误差累积\n\n我们需要推导在以 $N=L/h$ 步追踪总弧长 $L$ 后的均方根（RMS）角度误差 $\\theta_{\\text{RMS}}$。在纤维束末端的总角度误差 $\\Theta_N$ 是两个分量的和：一个系统性偏差和一个随机误差。\n\n1.  **系统性偏差：** 问题假设第 2 部分中得到的每步角度偏差 $\\delta_b = \\delta \\theta_{\\text{step}}$ 对每一步都是恒定的。$N$ 步后的总累积偏差是这些单个偏差的和：\n    $$\n    \\Theta_{\\text{bias}} = \\sum_{i=1}^N \\delta_b = N \\delta_b = \\frac{L}{h} \\delta_b\n    $$\n\n2.  **随机误差：** 在每一步，都会引入一个独立的、零均值的、标准差为 $\\sigma$ 的随机角度噪声 $\\eta_i$。总随机误差是这些噪声的和：\n    $$\n    \\Theta_{\\text{rand}} = \\sum_{i=1}^N \\eta_i\n    $$\n    总随机误差的期望值为 $E[\\Theta_{\\text{rand}}] = \\sum E[\\eta_i] = 0$。由于独立性，总随机误差的方差是各个方差的和：\n    $$\n    \\text{Var}(\\Theta_{\\text{rand}}) = \\sum_{i=1}^N \\text{Var}(\\eta_i) = \\sum_{i=1}^N \\sigma^2 = N\\sigma^2 = \\frac{L}{h}\\sigma^2\n    $$\n\n总角度误差为 $\\Theta_N = \\Theta_{\\text{bias}} + \\Theta_{\\text{rand}}$。均方误差 (MSE) 是 $E[\\Theta_N^2]$。\n$$\nE[\\Theta_N^2] = E[(\\Theta_{\\text{bias}} + \\Theta_{\\text{rand}})^2] = E[\\Theta_{\\text{bias}}^2 + 2\\Theta_{\\text{bias}}\\Theta_{\\text{rand}} + \\Theta_{\\text{rand}}^2]\n$$\n利用期望的线性性质和 $E[\\Theta_{\\text{rand}}]=0$：\n$$\nE[\\Theta_N^2] = \\Theta_{\\text{bias}}^2 + 2\\Theta_{\\text{bias}}E[\\Theta_{\\text{rand}}] + E[\\Theta_{\\text{rand}}^2] = \\Theta_{\\text{bias}}^2 + \\text{Var}(\\Theta_{\\text{rand}})\n$$\n均方根误差是均方误差的平方根：\n$$\n\\theta_{\\text{RMS}} = \\sqrt{\\Theta_{\\text{bias}}^2 + \\text{Var}(\\Theta_{\\text{rand}})} = \\sqrt{\\left(N \\delta_b\\right)^2 + N\\sigma^2}\n$$\n代入 $N$ 和 $\\delta_b$ 的表达式：\n$$\n\\theta_{\\text{RMS}}(R, h, L, \\sigma) = \\sqrt{\\left(\\frac{L}{h}\\left(\\arctan\\left(\\frac{h}{R}\\right) - \\frac{h}{R}\\right)\\right)^2 + \\frac{L}{h}\\sigma^2}\n$$\n现在，我们用给定的数值来计算该表达式：\n$R = 40$ 毫米，$L = 120$ 毫米，$h = 4$ 毫米，以及 $\\sigma = 0.005$ 弧度。\n\n首先，计算无量纲参数：\n步数：$N = L/h = 120/4 = 30$。\n比率 $h/R$: $h/R = 4/40 = 0.1$。\n\n接下来，计算每步偏差（以弧度为单位）：\n$$\n\\delta_b = \\arctan(0.1) - 0.1 \\approx 0.099668652 - 0.1 = -0.000331348 \\text{ rad}\n$$\n\n计算总偏差和方差分量：\n总偏差的平方：\n$$\n\\Theta_{\\text{bias}}^2 = (N \\delta_b)^2 = (30 \\times -0.000331348)^2 = (-0.00994044)^2 \\approx 9.88124 \\times 10^{-5} \\text{ rad}^2\n$$\n总方差：\n$$\nN \\sigma^2 = 30 \\times (0.005)^2 = 30 \\times 0.000025 = 0.00075 \\text{ rad}^2\n$$\n\n均方误差是这两个值的和：\n$$\n\\theta_{\\text{RMS}}^2 = 9.88124 \\times 10^{-5} + 0.00075 = 0.0008488124 \\text{ rad}^2\n$$\n以弧度为单位的均方根误差是其平方根：\n$$\n\\theta_{\\text{RMS}} = \\sqrt{0.0008488124} \\approx 0.02913438 \\text{ rad}\n$$\n最后，将结果转换为度，并四舍五入到四位有效数字：\n$$\n\\theta_{\\text{RMS}} (\\text{deg}) = 0.02913438 \\times \\frac{180}{\\pi} \\approx 1.66935^\\circ\n$$\n四舍五入到四位有效数字得到 $1.669^\\circ$。",
            "answer": "$$\\boxed{1.669}$$"
        },
        {
            "introduction": "生成神经束后，连接组学的下一步是量化大脑区域间的连接强度。一种常见的方法是计算连接两个区域的神经束数量，但这个看似简单的指标充满了方法学上的陷阱。本练习将使用一个概率模型，揭示一个核心问题：原始神经束计数严重依赖于用户定义的参数（如种子点密度），因此不适合进行定量比较。通过本练习，您将学习如何通过适当的归一化来构建更稳健的连接权重，并理解精确定义感兴趣区域（种子掩模）所面临的持续挑战 。",
            "id": "5009439",
            "problem": "考虑一个简化但科学上一致的弥散张量成像（DTI）中的概率性纤维束追踪模型。两个标记为 $A$ 和 $B$ 的灰质区域，每个区域都由一组可播种的体素组成。一个种子掩膜指定了每个区域中哪些体素符合播种资格。在此模型中，种子在种子掩膜内以每个体素 $s$ 个种子的密度均匀放置。对于区域 $A$ 中的每个种子，从体素 $i$ 生成的纤维束流到达区域 $B$ 的概率为 $p_i \\in [0,1]$。类似地，对于区域 $B$ 中的每个种子，从体素 $j$ 生成的纤维束流到达区域 $A$ 的概率为 $q_j \\in [0,1]$。假设纤维束流的行为分别是概率为 $\\{p_i\\}$ 和 $\\{q_j\\}$ 的独立 Bernoulli 试验，并且种子在掩膜体素上是均匀且独立采样的。\n\n从概率论的基本事实出发，即独立 Bernoulli 随机变量之和的期望值等于它们期望值的总和，并且期望的线性性在不考虑依赖结构的情况下也成立，推导并实现以下量：\n\n- 在给定种子密度 $s$ 和种子掩膜 $S_A$ 的情况下，从区域 $A$ 到区域 $B$ 的期望纤维束流计数为\n$$\nC_{A \\to B}(s, S_A) = s \\cdot \\sum_{i \\in S_A} p_i.\n$$\n- 在种子密度 $s$ 和种子掩膜 $S_B$ 的情况下，从区域 $B$ 到区域 $A$ 的期望纤维束流计数为\n$$\nC_{B \\to A}(s, S_B) = s \\cdot \\sum_{j \\in S_B} q_j.\n$$\n- 总期望双向计数为\n$$\nC_{\\text{tot}}(s, S_A, S_B) = C_{A \\to B}(s, S_A) + C_{B \\to A}(s, S_B).\n$$\n- 将区域 $A$ 和 $B$ 之间的对称连接矩阵权重（一个无量纲量）定义为由两个区域中放置的种子总数归一化的期望双向计数：\n$$\nw_{AB}(s, S_A, S_B) = \\frac{C_{\\text{tot}}(s, S_A, S_B)}{s \\cdot \\left(|S_A| + |S_B|\\right)}.\n$$\n\n对于每个测试用例，您必须计算连接播种选择与连接性估计的三个效应：\n\n- 密度缩放比\n$$\nR_C = \\frac{C_{\\text{tot}}(2s, S_A^{\\text{strict}}, S_B^{\\text{strict}})}{C_{\\text{tot}}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}})}.\n$$\n- 连接权重上的密度不变性差异\n$$\n\\Delta w_{\\text{density}} = w_{AB}(2s, S_A^{\\text{strict}}, S_B^{\\text{strict}}) - w_{AB}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}}).\n$$\n- 在固定密度 $s$ 下，掩膜定义对连接权重的影响\n$$\n\\Delta w_{\\text{mask}} = w_{AB}(s, S_A^{\\text{dil}}, S_B^{\\text{dil}}) - w_{AB}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}}).\n$$\n\n这里，$S_A^{\\text{strict}}$ 和 $S_B^{\\text{strict}}$ 表示区域 $A$ 和 $B$ 的严格种子掩膜，$S_A^{\\text{dil}}$ 和 $S_B^{\\text{dil}}$ 表示经过假设的形态学膨胀后，向每个区域的播种集添加了特定体素的掩膜。\n\n您的程序必须为以下测试套件实现这些计算，每个测试套件由概率数组和种子密度 $s$ 指定。对于每种情况，概率列表定义了掩膜：“严格”掩膜精确包含每个区域列出的概率，“膨胀”掩膜则包含严格掩膜及所列出的“新增”概率。\n\n- 测试用例 1（一般情况）：\n    - 区域 A：严格 $p$ 值为 $[\\,0.20,\\,0.10,\\,0.05\\,]$；膨胀后新增 $[\\,0.40\\,]$。\n    - 区域 B：严格 $q$ 值为 $[\\,0.15,\\,0.25\\,]$；膨胀后新增 $[\\,0.05\\,]$。\n    - 种子密度：$s = 100$。\n- 测试用例 2（一个区域为低概率）：\n    - 区域 A：严格 $p$ 值为 $[\\,0,\\,0\\,]$；膨胀后新增 $[\\,0.10\\,]$。\n    - 区域 B：严格 $q$ 值为 $[\\,0.80\\,]$；膨胀后新增 $[\\,\\,]$（无新增）。\n    - 种子密度：$s = 50$。\n- 测试用例 3（接近确定性的高概率）：\n    - 区域 A：严格 $p$ 值为 $[\\,1.00\\,]$；膨胀后新增 $[\\,\\,]$（无新增）。\n    - 区域 B：严格 $q$ 值为 $[\\,1.00\\,]$；膨胀后新增 $[\\,1.00\\,]$。\n    - 种子密度：$s = 10$。\n\n您的程序应生成单行输出，按顺序包含每个测试用例的三元组\n$[\\,R_C,\\,\\Delta w_{\\text{density}},\\,\\Delta w_{\\text{mask}}\\,]$\n，以逗号分隔列表形式，并将所有测试用例聚合到一个顶级列表中。最终输出格式必须是严格的单行形式\n$[ [r_1, d_1, m_1], [r_2, d_2, m_2], [r_3, d_3, m_3] ]$，\n所有条目均为十进制浮点数。不涉及物理单位；所有输出均为无量纲实数。",
            "solution": "问题陈述提出了一个有效且定义明确的计算任务，该任务基于一个简化但科学上一致的概率性纤维束追踪模型。它是客观、自洽的，并且没有矛盾或谬误。所有必要的数据和定义都已提供，以推导出唯一且有意义的解决方案。因此，我们可以进行推导和求解。\n\n这个问题的核心在于理解连接性指标如何从概率论的基本原理中推导出来，以及它们如何响应方法学参数（如播种密度和掩膜定义）的变化。我们首先正式推导感兴趣的量的表达式。\n\n设 $S_A$ 和 $S_B$ 分别是构成区域 $A$ 和 $B$ 的种子掩膜的体素集合。种子密度 $s$ 是在掩膜内每个体素中放置的种子数量。对于放置在体素 $i \\in S_A$ 中的单个种子，其生成的纤维束流到达区域 $B$ 的事件是一个成功概率为 $p_i$ 的 Bernoulli 试验。由于在体素 $i$ 中放置了 $s$ 个种子，且每个都是独立试验，因此源于该体素的成功纤维束流的数量服从二项分布 $B(s, p_i)$。从体素 $i$ 到区域 $B$ 的期望纤维束流数量是其均值，即 $s \\cdot p_i$。\n\n根据期望的线性性，从区域 $A$ 到区域 $B$ 的总期望纤维束流计数，记为 $C_{A \\to B}$，是其种子掩膜 $S_A$ 中每个体素的期望计数之和。\n$$\nC_{A \\to B}(s, S_A) = \\sum_{i \\in S_A} (s \\cdot p_i) = s \\sum_{i \\in S_A} p_i\n$$\n尽管问题陈述它们是独立的，但此推导在不考虑源自不同体素的纤维束流之间任何依赖关系的情况下都成立。对于反向方向，一个完全类似的论证给出了从区域 $B$ 到区域 $A$ 的期望计数：\n$$\nC_{B \\to A}(s, S_B) = s \\sum_{j \\in S_B} q_j\n$$\n总期望双向计数 $C_{\\text{tot}}$ 是这两个量之和：\n$$\nC_{\\text{tot}}(s, S_A, S_B) = C_{A \\to B}(s, S_A) + C_{B \\to A}(s, S_B) = s \\left( \\sum_{i \\in S_A} p_i + \\sum_{j \\in S_B} q_j \\right)\n$$\n对称连接权重 $w_{AB}$ 定义为由两个区域中放置的种子总数归一化的总期望计数。种子总数为 $s \\cdot |S_A| + s \\cdot |S_B| = s(|S_A| + |S_B|)$，其中 $|S_A|$ 和 $|S_B|$ 分别是相应种子掩膜中的体素数量。\n$$\nw_{AB}(s, S_A, S_B) = \\frac{C_{\\text{tot}}(s, S_A, S_B)}{s \\cdot (|S_A| + |S_B|)} = \\frac{s \\left( \\sum_{i \\in S_A} p_i + \\sum_{j \\in S_B} q_j \\right)}{s \\left(|S_A| + |S_B|\\right)}\n$$\n关键在于，只要 $s \\neq 0$，种子密度 $s$ 就会从分子和分母中抵消掉：\n$$\nw_{AB}(S_A, S_B) = \\frac{\\sum_{i \\in S_A} p_i + \\sum_{j \\in S_B} q_j}{|S_A| + |S_B|}\n$$\n这个表达式揭示了 $w_{AB}$ 代表每个种子的平均连接概率，该概率是在两个区域中放置的所有种子上取平均值得到的。\n\n有了这些正式的表达式，我们就可以分析要计算的三个量。\n\n1.  **密度缩放比, $R_C$**: 该比率比较了种子密度为 $2s$ 时的总期望计数与密度为 $s$ 时的总期望计数。\n    $$\n    R_C = \\frac{C_{\\text{tot}}(2s, S_A^{\\text{strict}}, S_B^{\\text{strict}})}{C_{\\text{tot}}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}})} = \\frac{2s \\left( \\sum_{i \\in S_A^{\\text{strict}}} p_i + \\sum_{j \\in S_B^{\\text{strict}}} q_j \\right)}{s \\left( \\sum_{i \\in S_A^{\\text{strict}}} p_i + \\sum_{j \\in S_B^{\\text{strict}}} q_j \\right)}\n    $$\n    只要总期望计数不为零（即概率之和不为零），该比率可简化为：\n    $$\n    R_C = 2\n    $$\n    这表明原始纤维束流计数，一个未经归一化的指标，与播种密度成线性关系。这使其成为一个不理想的定量生物标记物，因为其值会受到一个方法学参数的混淆。\n\n2.  **密度不变性差异, $\\Delta w_{\\text{density}}$**: 这衡量了当种子密度加倍时，归一化连接权重 $w_{AB}$ 的变化。\n    $$\n    \\Delta w_{\\text{density}} = w_{AB}(2s, S_A^{\\text{strict}}, S_B^{\\text{strict}}) - w_{AB}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}})\n    $$\n    正如我们在推导中所证明的，权重 $w_{AB}$ 在数学上与种子密度 $s$ 无关。因此：\n    $$\n    w_{AB}(2s, S_A^{\\text{strict}}, S_B^{\\text{strict}}) = w_{AB}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}})\n    $$\n    这导出的结论是：\n    $$\n    \\Delta w_{\\text{density}} = 0\n    $$\n    这说明了连接组学中的一个关键原则：适当的归一化可以产生对播种策略变化具有鲁棒性的指标，从而使其在比较研究中更为可靠。\n\n3.  **掩膜定义影响, $\\Delta w_{\\text{mask}}$**: 这个量评估了在保持种子密度 $s$ 不变的情况下，改变种子掩膜对连接权重的影响。\n    $$\n    \\Delta w_{\\text{mask}} = w_{AB}(s, S_A^{\\text{dil}}, S_B^{\\text{dil}}) - w_{AB}(s, S_A^{\\text{strict}}, S_B^{\\text{strict}})\n    $$\n    使用我们简化的、与密度无关的 $w_{AB}$ 公式：\n    $$\n    \\Delta w_{\\text{mask}} = \\frac{\\sum_{i \\in S_A^{\\text{dil}}} p_i + \\sum_{j \\in S_B^{\\text{dil}}} q_j}{|S_A^{\\text{dil}}| + |S_B^{\\text{dil}}|} - \\frac{\\sum_{i \\in S_A^{\\text{strict}}} p_i + \\sum_{j \\in S_B^{\\text{strict}}} q_j}{|S_A^{\\text{strict}}| + |S_B^{\\text{strict}}|}\n    $$\n    这个值通常不为零，并且取决于包含在严格和膨胀掩膜中的体素的具体概率，以及掩膜大小的变化。它量化了连接性估计对感兴趣区域精确解剖学定义的敏感性，这是连接组学中一个众所周知的挑战，通常被称为“脑区划分问题”。\n\n以下程序为提供的测试套件实现了这些计算。",
            "answer": "[[2.0, 0.0, 0.02142857142857142], [2.0, 0.0, -0.04166666666666663], [2.0, 0.0, 0.0]]"
        },
        {
            "introduction": "可靠的神经束追踪重建在很大程度上取决于何时停止追踪。算法通常使用诸如分数各向异性（$FA$）阈值和解剖边界等终止标准来做出决策。然而，大脑复杂的生物学特性和成像技术的局限性使这项任务变得异常复杂。本练习将挑战您像研究员一样思考，评估不同终止策略的利弊。您将分析交叉纤维、部分容积效应和成像伪影等问题如何导致假阳性和假阴性连接，从而加深您对神经束追踪结果的实际局限性和正确解读的理解 。",
            "id": "5009404",
            "problem": "一项弥散张量成像 (DTI) 研究旨在使用确定性流线束追踪重建长程白质通路。在每一步中，流线沿着主弥散方向前进，如果局部各向异性分数 (FA) 低于阈值 $T$，或者下一步将进入被组织分割标记为灰质 (GM) 或脑脊液 (CSF) 的体素，则流线终止。数据是通过回波平面成像 (EPI) 采集的，组织分割是通过将高分辨率解剖图像配准到 DTI 空间生成的。在标准分辨率下，典型的成人组织特征包括：脑脊液具有低各向异性；与白质 (WM) 相比，灰质的弥散相对各向同性；白质具有较高的各向异性，但交叉纤维结构会降低其各向异性。没有提供具体的 FA 计算公式；假设 FA 量化了从弥散张量导出的弥散各向异性程度。\n\n关于使用 FA 阈值 $T$ 和解剖边界掩模（GM 和 CSF）作为终止标准的以下陈述中，哪些在生物学上是合理的，并正确指出了现实的失效模式？选择所有适用项。\n\nA. 设置一个统一的 FA 阈值 $T \\approx 0.10$ 足以防止流线进入灰质，因为灰质的 $FA \\approx 0$，所以该阈值将阻止流线进入灰质，而不会影响有效的白质通路。\n\nB. 在进入 CSF 掩模时终止流线在生物学上是合理的，但可能因脑室壁的部分容积效应而失败，其中体素包含 CSF 和薄层脑室周白质的混合物；即使底层的轴突沿着脑室壁继续延伸，流线也可能被过早终止。\n\nC. 将 FA 阈值从 $T=0.20$ 增加到 $T=0.35$ 会减少通过各向同性组织的错误延续，但可能导致在具有多个纤维群的区域（例如，半卵圆中心）中有效纤维的过早终止，因为尽管轴突束完好无损，但弥散张量测得的各向异性降低了。\n\nD. 在 GM 边界停止对于终止于皮质第四层的长程皮质-皮质联络纤维是普遍有效的；因此，流线应在进入皮质灰质后立即停止。\n\nE. 使用与组织分割相关的解剖边界在生物学上是合理的，但可能在磁敏感性伪影扭曲区域附近失败，因为 EPI 引起的几何扭曲和不完美的配准可能错误地对边界处的组织进行分类，导致错误的流线终止或延续。",
            "solution": "问题陈述描述了一个使用弥散张量成像 (DTI) 的标准确定性流线束追踪实验。核心任务是评估关于终止标准的几个陈述的生物学合理性，并识别其现实的失效模式。所提供的问题陈述具有科学依据、问题明确且客观。它准确地反映了计算神经影像学领域的常见实践和挑战。因此，该问题是有效的，我们可以进行分析。\n\n支配此问题的基本原则是：\n1.  **弥散各向异性**：在白质 (WM) 中，水的弥散是高度定向的（各向异性），因为它受到轴突膜和髓鞘的限制。在灰质 (GM) 和脑脊液 (CSF) 中，弥散更具各向同性（方向性较弱）。各向异性分数 (FA) 是一个标量指标，范围从 $0$（完全各向同性）到约 $1$（完全各向异性），用于量化此属性。\n2.  **确定性束追踪**：一种通过从起始点迭代地跟随主弥散方向（弥散张量的主特征向量）来重建神经通路的算法。\n3.  **终止标准**：停止流线重建的规则。问题指定了两个常见标准：(i) 局部 FA 值降至阈值 $T$ 以下，以及 (ii) 流线试图进入解剖学上分类为 GM 或 CSF 的体素。\n4.  **DTI的局限性**：DTI 模型有已知的局限性。在包含具有不同方向的多个纤维群（交叉、相切或扇形纤维）的体素中，DTI 张量表示的是一个平均值，导致 FA 人为降低和主方向不明确。这是束追踪错误的主要原因。\n5.  **成像和处理伪影**：DTI 数据通常使用回波平面成像 (EPI) 采集，会受到诸如磁敏感梯度引起的几何扭曲等伪影的影响。此外，将解剖图像（用于组织分割）配准到扭曲的 DTI 空间通常是不完美的。当单个体素包含多种组织类型时，会发生部分容积效应，从而平均了它们各自的弥散特性。\n\n我们现在将根据这些原则评估每个选项。\n\n**选项 A: 设置一个统一的 FA 阈值 $T \\approx 0.10$ 足以防止流线进入灰质，因为灰质的 $FA \\approx 0$，所以该阈值将阻止流线进入灰质，而不会影响有效的白质通路。**\n\n这一陈述在事实上是不正确的，且过于简单化。\n首先，灰质的 FA 值约等于 $0$ ($FA \\approx 0$) 的前提是错误的。虽然灰质比白质更具各向同性，但它拥有复杂的微观结构，导致非零的各向异性。皮质灰质的典型 FA 值在 $0.1$ 到 $0.25$ 的范围内，并不接近 $0$。FA 值接近 $0$ 的是脑脊液。\n其次，声称 $T \\approx 0.10$ 的阈值不会影响有效白质通路的说法也是错误的。在纤维结构高度复杂的区域，例如半卵圆中心或投射纤维与联络纤维交叉处，白质体素内测得的 FA 值会显著降低。尽管存在健康、密集的轴突通路，但在这种交叉纤维区域，FA 值通常会低于 $0.20$，甚至接近 $0.10$。因此，$T=0.10$ 的阈值很容易导致这些关键白质区域中有效流线的过早终止。该陈述未能考虑到众所周知的交叉纤维问题。\n\n结论：**不正确**。\n\n**选项 B: 在进入 CSF 掩模时终止流线在生物学上是合理的，但可能因脑室壁的部分容积效应而失败，其中体素包含 CSF 和薄层脑室周白质的混合物；即使底层的轴突沿着脑室壁继续延伸，流线也可能被过早终止。**\n\n这一陈述在生物学上是合理的，并准确地指出了一个常见的失效模式。\n在流线进入 CSF 时终止它在生物学上是合理的，因为主要的轴突束不会穿过脑室或蛛网膜下腔。然而，白质和脑脊液之间的交界面是部分容积效应 (PVE) 的典型发生位置。位于脑室边界的一个体素可能同时包含 CSF（FA 值约等于 $0$）和一部分紧邻脑室走行但很重要的薄层白质束（例如，扣带束、穹窿或上纵束的部分）。来自这样一个体素的 DTI 信号将是这两种组织类型的体积加权平均值，导致其 FA 值远低于纯白质。解剖掩模可能将此体素分类为 CSF 或混合物，导致束追踪算法过早终止流线，尽管底层的轴突通路仍在继续。这准确地描述了追踪脑室周通路时的一个现实挑战。\n\n结论：**正确**。\n\n**选项 C: 将 FA 阈值从 $T=0.20$ 增加到 $T=0.35$ 会减少通过各向同性组织的错误延续，但可能导致在具有多个纤维群的区域（例如，半卵圆中心）中有效纤维的过早终止，因为尽管轴突束完好无损，但弥散张量测得的各向异性降低了。**\n\n这一陈述正确地描述了选择 FA 阈值时的基本权衡。\n将阈值从常用的值（如 $T=0.20$）增加到更严格的值（如 $T=0.35$）会使算法更具特异性。它不太可能生成错误地穿过非白质组织（例如，灰质或具有虚假高 FA 值的噪声区域）的假阳性纤维束。这“减少了错误延续”。\n其缺点是（该陈述正确地指出了这一点）敏感性的丧失。具有复杂纤维结构的区域，例如多个主要通路相交的半卵圆中心，在使用单个张量建模时表现出较低的 FA 值。这是因为 DTI 张量平均了体素内不同的纤维方向，导致弥散轮廓更趋于平面或球形，从而降低了 FA。通过将阈值提高到 $T=0.35$，流线在到达这些区域时极有可能被错误地终止，从而使长程联络和投射通路的重建变得支离破碎。这表明了对 DTI 模型局限性的清晰理解。\n\n结论：**正确**。\n\n**选项 D: 在 GM 边界停止对于终止于皮质第四层的长程皮质-皮质联络纤维是普遍有效的；因此，流线应在进入皮质灰质后立即停止。**\n\n这一陈述在生物学上不准确，在方法论上很幼稚。\n其神经解剖学前提是错误的。虽然丘脑皮质投射主要靶向皮质第四层，但皮质-皮质联络纤维和连合纤维具有更复杂的终止模式，突触遍布多个层次，主要是浅层的 II/III 层和深层的 V/VI 层。声称它们终止于第四层是严重的过度简化。\n此外，“流线应在进入皮质灰质后立即停止”的结论是有问题的。灰质-白质交界面并非一个无限薄的边界，而是一个纤维散开进入皮质的过渡区。由于 DTI 的分辨率有限和部分容积效应，FA 值在该边界上是逐渐下降的。在基于解剖掩模分类为灰质的第一个体素处就停止，通常会导致流线终止在表层，距离其真正的皮质目标还有几毫米。对于像束追踪这样一个充满方法学挑战的领域，任何启发式方法都远非“普遍有效”。\n\n结论：**不正确**。\n\n**选项 E: 使用与组织分割相关的解剖边界在生物学上是合理的，但可能在磁敏感性伪影扭曲区域附近失败，因为 EPI 引起的几何扭曲和不完美的配准可能错误地对边界处的组织进行分类，导致错误的流线终止或延续。**\n\n这一陈述正确地指出了一个重大的技术性失效模式。\n使用解剖掩模（例如 GM/CSF）作为终止标准是一种具有生物学动机的常见做法。然而，其实施易受图像处理错误的影响。DTI 数据通常使用回波平面成像 (EPI) 采集，该序列以其对局部磁场不均匀性的高敏感性而闻名。这些不均匀性在空气-组织交界处（例如，靠近鼻窦的眶额皮质，靠近乳突气房的颞叶前部）尤为突出，会导致最终图像出现严重的几何扭曲。\n组织分割是在不受这些扭曲影响的高分辨率解剖扫描（如 T1 加权像）上进行的。要将分割应用于 DTI 数据，必须将解剖图像配准到扭曲的 EPI 空间。这个配准过程具有挑战性且通常不完美，尤其是在扭曲最严重的区域。解剖掩模和 DTI 数据之间的错位可能导致白质体素被错误标记为灰质，从而导致流线过早终止；或者灰质区域被错误标记为白质，从而允许错误的流线延续。这是连接组学研究中一个有据可查的错误来源。\n\n结论：**正确**。",
            "answer": "$$\\boxed{BCE}$$"
        }
    ]
}