{
    "hands_on_practices": [
        {
            "introduction": "要将遗传学原理应用于临床实践，我们首先需要了解致病性等位基因在人群中的分布情况。这个练习将指导你使用群体遗传学的基石——哈迪-温伯格平衡（Hardy–Weinberg equilibrium）——来解决一个基本问题：对于一个已知的隐性遗传癌症综合征，在人群中有多少人是致病等位基因的携带者？通过这个计算，你可以将抽象的等位基因频率转化为具体的公共卫生指标。",
            "id": "5045356",
            "problem": "在遗传性癌症综合征的背景下，考虑一个常染色体基因座，该基因座有两个等位基因：一个野生型等位基因 $A$ 和一个致病性等位基因 $a$。仅在纯合状态 $aa$ 下，等位基因 $a$ 才会导致癌症易感性增加（例如，在MUTYH相关性息肉病中，双等位基因携带者所见的隐性遗传易感性）。假设一个大的随机交配群体，在繁殖前，$AA$ 或 $Aa$ 相对于彼此没有选择作用，没有迁移，新突变可忽略不计，因此哈代-温伯格平衡（HWE）成立。致病性等位基因的群体频率为 $q = 0.005$。令 $p$ 表示野生型等位基因 $A$ 的频率。\n\n仅使用二倍体群体中等位基因频率的核心定义、定律 $p + q = 1$ 以及随机交配下基因型形成的哈代-温伯格平衡（HWE）原理，从基本原理推导杂合携带者 $Aa$ 个体的预期比例，并计算当 $q = 0.005$ 时的数值。将您的最终结果表示为小数，并四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它科学地基于群体遗传学原理，特别是哈代-温伯格平衡（HWE），并且问题陈述清晰，提供了所有必要信息。\n\n该问题要求在一个处于HWE的群体中，从基本原理推导杂合携带者（$Aa$）的预期比例，然后进行数值计算。\n\n令 $p$ 为群体基因库中野生型等位基因 $A$ 的频率，$q$ 为致病性等位基因 $a$ 的频率。问题陈述该常染色体基因座上只有两个等位基因。因此，它们的频率之和必须等于 $1$。\n$$p + q = 1$$\n问题指明该群体是大的，并且进行随机交配。在这些条件下，下一代的基因型频率是可以预测的。一个二倍体合子的形成涉及来自父母双方的两个配子的随机结合。在一个随机交配的群体中，这等同于从基因库中独立抽取两个等位基因。\n\n抽取到等位基因 $A$ 的概率是 $p$。\n抽取到等位基因 $a$ 的概率是 $q$。\n\n我们可以如下推导三种可能基因型（$AA$、$Aa$ 和 $aa$）的预期频率：\n\n1.  纯合野生型基因型 $AA$ 的频率是个体从母亲处遗传一个 $A$ 等位基因 并且 从父亲处遗传一个 $A$ 等位基因的概率。假设独立性，这个概率是：\n    $$\\text{Freq}(AA) = p \\times p = p^2$$\n2.  纯合致病型基因型 $aa$ 的频率是个体从母亲处遗传一个 $a$ 等位基因 并且 从父亲处遗传一个 $a$ 等位基因的概率。这个概率是：\n    $$\\text{Freq}(aa) = q \\times q = q^2$$\n3.  杂合基因型 $Aa$ 可以通过两种互斥的方式形成：\n    -   从母亲处遗传等位基因 $A$，从父亲处遗传等位基因 $a$。此事件的概率是 $p \\times q$。\n    -   从母亲处遗传等位基因 $a$，从父亲处遗传等位基因 $A$。此事件的概率是 $q \\times p$。\n    杂合携带者的总预期频率是这两个事件概率的总和：\n    $$\\text{Freq}(Aa) = (p \\times q) + (q \\times p) = 2pq$$\n\n这个从基本原理出发的推导表明，杂合携带者个体的预期比例由项 $2pq$ 给出。基因型频率的总和必须等于 $1$，这与我们的推导是一致的：\n$$p^2 + 2pq + q^2 = (p+q)^2 = 1^2 = 1$$\n\n现在，我们可以计算数值。我们已知致病性等位基因 $a$ 的频率：\n$$q = 0.005$$\n使用关系式 $p + q = 1$，我们可以求出野生型等位基因 $A$ 的频率：\n$$p = 1 - q = 1 - 0.005 = 0.995$$\n杂合携带者（$Aa$）的预期比例使用推导出的公式 $2pq$ 计算：\n$$\\text{Freq}(Aa) = 2pq = 2 \\times 0.995 \\times 0.005$$\n进行乘法运算：\n$$2 \\times 0.995 \\times 0.005 = 1.99 \\times 0.005 = 0.00995$$\n问题要求最终结果以小数形式表示，并四舍五入到四位有效数字。计算出的值 $0.00995$ 有三位有效数字（数字 $9, 9, 5$）。要用四位有效数字表示，我们必须在末尾添加一个零。\n$$0.009950$$\n因此，该群体中杂合携带者的预期比例为 $0.009950$。",
            "answer": "$$\\boxed{0.009950}$$"
        },
        {
            "introduction": "在确定了人群中的风险后，下一步是评估个体。当患者接受基因检测时，我们如何根据检测结果（阳性或阴性）来更新其携带致病性变异的概率？本练习将带你应用贝叶斯定理（Bayes' theorem）来解决这个核心的临床问题，计算得到阳性结果后，患者携带BRCA1致病性变异的“后验概率”。",
            "id": "5045261",
            "problem": "一名正在接受乳腺癌1号基因（BRCA1）致病性变异胚系检测的患者，其携带致病性变异的检测前概率或先验概率 $ \\pi $ 为 $ 0.10 $。所使用的临床检测的灵敏度 $ s = 0.95 $，特异度 $ c = 0.99 $。检测返回了阳性结果。请从条件概率的公理化定义和全概率公式出发，并使用标准的临床定义——灵敏度是在确实携带变异的情况下检测结果为阳性的概率，特异度是在确实不携带变异的情况下检测结果为阴性的概率——推导出一个表达式，用于计算在观察到阳性结果后，该患者携带BRCA1致病性变异的后验概率。然后，使用给定的 $ \\pi $、$ s $ 和 $ c $ 值对该表达式进行数值计算。将最终答案以小数形式表示，并四舍五入到四位有效数字。",
            "solution": "该问题陈述有效。其科学基础是概率论原理及其在医学诊断中的应用，这是医学遗传学的核心课题。该问题提法恰当，提供了计算唯一后验概率所需的所有数据——先验概率、灵敏度和特异度。其定义和数值在临床遗传学背景下是标准且符合实际的。语言客观而精确。因此，我们可以着手求解。\n\n目标是推导出一个表达式，用于计算在检测结果为阳性的条件下患者携带致病性变异的后验概率，然后对该表达式进行数值计算。我们将首先正式定义事件，并将给定信息转化为概率论的语言。\n\n令 $V$ 为患者携带 *BRCA1* 基因致病性变异的事件。\n令 $V^c$ 为患者不携带此类变异的互补事件。\n令 $T^+$ 为临床检测返回阳性结果的事件。\n令 $T^-$ 为检测返回阴性结果的事件。\n\n问题提供了以下信息：\n1.  携带变异的检测前概率或先验概率：$P(V) = \\pi = 0.10$。\n2.  检测的灵敏度，定义为患者携带变异条件下检测结果为阳性的概率：$P(T^+ | V) = s = 0.95$。这是真阳性率。\n3.  检测的特异度，定义为患者不携带变异条件下检测结果为阴性的概率：$P(T^- | V^c) = c = 0.99$。这是真阴性率。\n\n根据这些已知条件，我们可以推导出另外两个概率：\n- 不携带变异的先验概率为 $P(V^c) = 1 - P(V) = 1 - \\pi = 1 - 0.10 = 0.90$。\n- 患者不携带变异但检测结果为阳性的概率（假阳性率）为 $P(T^+ | V^c) = 1 - P(T^- | V^c) = 1 - c = 1 - 0.99 = 0.01$。\n\n我们的目标是计算后验概率 $P(V | T^+)$，即在检测结果为阳性的条件下携带变异的概率。\n\n根据问题的要求，我们从条件概率的公理化定义开始：\n$$P(A|B) = \\frac{P(A \\cap B)}{P(B)}$$\n将此定义应用于我们的特定事件，得到：\n$$P(V | T^+) = \\frac{P(V \\cap T^+)}{P(T^+)}$$\n分子 $P(V \\cap T^+)$ 是携带变异且检测呈阳性的联合概率。我们可以再次使用条件概率的定义来重新表达此项：$P(T^+ | V) = \\frac{P(V \\cap T^+)}{P(V)}$，整理后得到 $P(V \\cap T^+) = P(T^+ | V) P(V)$。代入我们的符号，分子为 $s\\pi$。\n\n分母 $P(T^+)$ 是获得阳性检测结果的总概率。问题要求我们使用全概率公式。阳性结果可以通过两种互斥的途径发生：\n1.  患者携带变异且检测结果为阳性（真阳性）。其概率为 $P(T^+ \\cap V) = P(T^+ | V) P(V) = s\\pi$。\n2.  患者不携带变异但检测结果为阳性（假阳性）。其概率为 $P(T^+ \\cap V^c) = P(T^+ | V^c) P(V^c) = (1-c)(1-\\pi)$。\n\n根据全概率公式，阳性检测的总概率 $P(T^+)$ 是这两种途径的概率之和：\n$$P(T^+) = P(T^+ | V) P(V) + P(T^+ | V^c) P(V^c)$$\n代入我们的符号表示：\n$$P(T^+) = s\\pi + (1 - c)(1 - \\pi)$$\n现在，我们将分子和分母的表达式结合起来，得到后验概率的最终推导表达式，这是贝叶斯定理的一种形式：\n$$P(V | T^+) = \\frac{P(T^+ | V) P(V)}{P(T^+ | V) P(V) + P(T^+ | V^c) P(V^c)} = \\frac{s\\pi}{s\\pi + (1 - c)(1 - \\pi)}$$\n至此，通用表达式的推导完成。\n\n接下来，我们使用给定的值 $\\pi = 0.10$、$s = 0.95$ 和 $c = 0.99$ 对该表达式进行数值计算。\n\n首先，计算分子的值：\n$$s\\pi = (0.95)(0.10) = 0.095$$\n接下来，计算分母的值：\n$$s\\pi + (1 - c)(1 - \\pi) = (0.95)(0.10) + (1 - 0.99)(1 - 0.10)$$\n$$= 0.095 + (0.01)(0.90)$$\n$$= 0.095 + 0.009$$\n$$= 0.104$$\n最后，通过将分子除以分母来计算后验概率：\n$$P(V | T^+) = \\frac{0.095}{0.104} \\approx 0.913461538...$$\n问题要求将答案四舍五入到四位有效数字。前四位有效数字是 $9$、$1$、$3$ 和 $4$。第五位有效数字是 $6$，由于 $\\ge 5$，所以我们将第四位数字向上取整。\n$$P(V | T^+) \\approx 0.9135$$\n因此，在得到阳性检测结果后，该患者携带 *BRCA1* 致病性变异的概率从 $10\\%$ 的先验概率增加到约 $91.35\\%$ 的后验概率。",
            "answer": "$$\\boxed{0.9135}$$"
        },
        {
            "introduction": "对于已知的致病性变异携带者，下一个关键问题是：“我一生中患癌的风险有多大？以及干预措施能多大程度上降低这种风险？” 本练习将引导你进入生存分析（survival analysis）的领域，使用微积分来模拟随年龄变化的癌症风险。你将计算BRCA1携带者从40岁到80岁的终生风险，并量化风险降低手术（risk-reducing salpingo-oophorectomy）带来的益处，从而体验遗传咨询中定量风险评估的威力。",
            "id": "5045365",
            "problem": "由乳腺癌1号基因（BRCA1）的致病性变异引起的遗传性乳腺癌和卵巢癌综合征，与随年龄增长而升高的乳腺癌风险率相关。对于一位在40岁时无事件发生的BRCA1携带者，考虑其在年龄 $t \\in [40,80]$ 区间内的特定年龄乳腺癌风险函数 $h(t)$（单位：每年），该函数由一个科学上合理的分段形式给出：\n- 对于 $40 \\leq t  50$：$h(t) = 0.025 + 0.002\\,(t - 40)$。\n- 对于 $50 \\leq t \\leq 80$：$h(t) = 0.045\\,\\exp\\!\\big(-0.05\\,(t - 50)\\big)$。\n\n假设：\n- 风险函数 $h(t)$ 指的是在年龄$t$时无事件发生的条件下，在该年龄发生首次乳腺癌事件的瞬时率。\n- 不存在竞争风险，且在40岁之前没有患过乳腺癌。\n- 该事件最多发生一次。\n\n作为一项风险降低干预措施，考虑在45岁时进行降低风险的输卵管卵巢切除术（RRSO），该手术对所有 $t \\geq 45$ 的年龄段，通过因子 $\\rho = 0.6$ 使乳腺癌风险率产生恒定的乘性降低（即，RRSO术后风险率为 $\\rho\\,h(t)$ (对于 $t \\geq 45$)；而RRSO术前 $40 \\leq t  45$ 年龄段的风险率仍为 $h(t)$）。\n\n使用事件发生时间分析中风险函数和生存函数的基本定义，为这位BRCA1携带者推导在40岁至80岁之间发生乳腺癌的条件剩余终生风险：\n1. 不进行RRSO。\n2. 按规定在45岁时进行RRSO。\n\n将两个答案以小数形式报告。将您的答案四舍五入到四位有效数字。最终数值答案中无需单位。",
            "solution": "该问题要求计算一位BRCA1携带者在40岁至80岁之间发生乳腺癌的累积风险，分两种情景：不进行和进行风险降低干预。问题的核心在于应用生存分析原理，特别是风险函数 $h(t)$、累积风险函数 $H(t_1, t_2)$、条件生存函数 $S(t_2 | t_1)$ 和风险 $R(t_2 | t_1)$ 之间的关系。\n\n基本定义如下：\n- 从时间 $t_1$ 到 $t_2$ 的累积风险函数是在此区间上对风险函数 $h(t)$ 的积分：\n$$H(t_1, t_2) = \\int_{t_1}^{t_2} h(u) \\, du$$\n- 条件生存概率，即在时间 $t_1$ 无事件发生的条件下，直到时间 $t_2$ 仍然保持无事件的概率，与累积风险的关系如下：\n$$S(t_2 | t_1) = \\exp\\left( -H(t_1, t_2) \\right)$$\n- 在时间 $t_1$ 无事件发生的条件下，在 $t_1$ 和 $t_2$ 之间经历事件的条件风险是生存概率的补集：\n$$R(t_1, t_2) = 1 - S(t_2 | t_1) = 1 - \\exp\\left( -H(t_1, t_2) \\right)$$\n\n问题为一位女性从40岁到80岁指定了一个分段风险函数 $h(t)$：\n- 对于 $40 \\leq t  50$：$h(t) = 0.025 + 0.002(t - 40)$\n- 对于 $50 \\leq t \\leq 80$：$h(t) = 0.045\\exp(-0.05(t - 50))$\n\n我们现在将计算这两种情况下所需的风险。\n\n**1. 不进行RRSO的风险**\n\n我们需要计算40岁至80岁之间的乳腺癌风险，即 $R(40, 80)$。这需要计算累积风险 $H(40, 80)$。由于 $h(t)$ 的分段性质，积分必须在 $t=50$ 处分割。\n\n$$H(40, 80) = \\int_{40}^{80} h(t) \\, dt = \\int_{40}^{50} h(t) \\, dt + \\int_{50}^{80} h(t) \\, dt$$\n\n让我们分别计算每个积分。\n\n第一个积分（从 $t=40$ 到 $t=50$）：\n$$H_1 = \\int_{40}^{50} [0.025 + 0.002(t - 40)] \\, dt$$\n令 $u = t - 40$，则 $du = dt$。当 $t=40$ 时，$u=0$。当 $t=50$ 时，$u=10$。\n$$H_1 = \\int_{0}^{10} (0.025 + 0.002u) \\, du = \\left[ 0.025u + 0.001u^2 \\right]_{0}^{10}$$\n$$H_1 = (0.025 \\times 10 + 0.001 \\times 10^2) - 0 = 0.25 + 0.1 = 0.35$$\n\n第二个积分（从 $t=50$ 到 $t=80$）：\n$$H_2 = \\int_{50}^{80} 0.045\\exp(-0.05(t - 50)) \\, dt$$\n令 $v = -0.05(t - 50)$，则 $dv = -0.05 \\, dt$，这意味着 $dt = -20 \\, dv$。当 $t=50$ 时，$v=0$。当 $t=80$ 时，$v = -0.05(30) = -1.5$。\n$$H_2 = \\int_{0}^{-1.5} 0.045 \\exp(v) (-20 \\, dv) = -0.9 \\int_{0}^{-1.5} \\exp(v) \\, dv$$\n$$H_2 = -0.9 [\\exp(v)]_{0}^{-1.5} = -0.9 (\\exp(-1.5) - \\exp(0)) = 0.9(1 - \\exp(-1.5))$$\n\n总累积风险为 $H(40, 80) = H_1 + H_2 = 0.35 + 0.9(1 - \\exp(-1.5))$。\n那么风险为：\n$$R_{\\text{no RRSO}} = 1 - \\exp(-H(40, 80)) = 1 - \\exp\\left( -[0.35 + 0.9(1 - \\exp(-1.5))] \\right)$$\n数值上：\n$$H(40, 80) \\approx 0.35 + 0.9(1 - 0.22313) = 0.35 + 0.9(0.77687) = 0.35 + 0.699183 = 1.049183$$\n$$R_{\\text{no RRSO}} = 1 - \\exp(-1.049183) \\approx 1 - 0.350224 = 0.649776$$\n四舍五入到四位有效数字，风险为 $0.6498$。\n\n**2. 在45岁时进行RRSO的风险**\n\n在年龄 $t=45$ 时的干预对所有 $t \\ge 45$ 的风险函数引入了一个乘性降低因子 $\\rho = 0.6$。新的风险函数 $h^*(t)$ 为：\n- 对于 $40 \\leq t  45$：$h^*(t) = h(t) = 0.025 + 0.002(t - 40)$\n- 对于 $45 \\leq t \\leq 80$：$h^*(t) = \\rho \\cdot h(t) = 0.6 \\cdot h(t)$\n\n由于在 $t=45$ 时的变化以及在 $t=50$ 时基线风险的变化，累积风险 $H^*(40, 80)$ 现在需要分三个区间进行计算：\n$$H^*(40, 80) = \\int_{40}^{45} h(t) \\, dt + \\int_{45}^{80} \\rho \\cdot h(t) \\, dt$$\n$$H^*(40, 80) = \\int_{40}^{45} h(t) \\, dt + \\rho \\left( \\int_{45}^{50} h(t) \\, dt + \\int_{50}^{80} h(t) \\, dt \\right)$$\n\n让我们为新的划分计算积分。从50到80的积分与之前的 $H_2$ 相同。我们需要将原来的 $H_1$ 分成两部分。\n\n从 $t=40$ 到 $t=45$ 的积分：\n$$H^*_{1a} = \\int_{40}^{45} [0.025 + 0.002(t-40)] \\, dt = \\left[ 0.025(t-40) + 0.001(t-40)^2 \\right]_{40}^{45}$$\n$$H^*_{1a} = (0.025 \\times 5 + 0.001 \\times 5^2) - 0 = 0.125 + 0.025 = 0.15$$\n\n从 $t=45$ 到 $t=50$ 的积分：\n这可以计算为 $H_1 - H^*_{1a}$。\n$$H^*_{1b} = \\int_{45}^{50} [0.025 + 0.002(t-40)] \\, dt = H_1 - H^*_{1a} = 0.35 - 0.15 = 0.20$$\n\n现在，我们组合总累积风险 $H^*(40, 80)$：\n$$H^*(40, 80) = H^*_{1a} + \\rho(H^*_{1b} + H_2)$$\n$$H^*(40, 80) = 0.15 + 0.6 \\left( 0.20 + 0.9(1 - \\exp(-1.5)) \\right)$$\n\n数值上：\n$$H^*(40, 80) \\approx 0.15 + 0.6 (0.20 + 0.699183) = 0.15 + 0.6 (0.899183) = 0.15 + 0.539510 = 0.689510$$\n\n进行RRSO的风险是：\n$$R_{\\text{RRSO}} = 1 - \\exp(-H^*(40, 80)) \\approx 1 - \\exp(-0.689510)$$\n$$R_{\\text{RRSO}} \\approx 1 - 0.501815 = 0.498185$$\n四舍五入到四位有效数字，风险为 $0.4982$。\n\n两个结果是：\n1. 不进行RRSO的风险：$0.6498$\n2. 在45岁时进行RRSO的风险：$0.4982$",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.6498  0.4982 \\end{pmatrix}}$$"
        }
    ]
}