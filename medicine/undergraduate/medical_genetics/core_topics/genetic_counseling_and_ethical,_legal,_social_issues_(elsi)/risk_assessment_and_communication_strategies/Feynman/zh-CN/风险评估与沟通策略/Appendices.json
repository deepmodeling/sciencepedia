{
    "hands_on_practices": [
        {
            "introduction": "基因筛查测试是强大的工具，但并非完美无缺。一个阳性结果并不总是意味着受检者确实携带致病变异。这个练习将指导您如何计算阳性预测值（$PPV$）和阴性预测值（$NPV$），这两个关键指标揭示了测试结果的真实临床意义。通过这个计算，您将深刻理解为何一个测试的预测能力不仅取决于其自身的灵敏度（$Se$）和特异性（$Sp$），还强烈地依赖于致病变异在目标人群中的患病率（或称先验概率，$p$）。掌握这项技能对于准确解读基因检测报告、避免常见误解至关重要。",
            "id": "5079098",
            "problem": "一名遗传咨询师正准备向一个高风险临床人群传达一种特定致病性变异的筛查检测结果。该检测具有经过验证的性能，其特征为灵敏度（Se）和特异性（Sp），并且该临床人群中该变异的估计检测前概率（患病率）用 $p$ 表示。定义：灵敏度（Se）是 $P(\\text{检测阳性} \\mid \\text{存在变异})$，特异性（Sp）是 $P(\\text{检测阴性} \\mid \\text{不存在变异})$，阳性预测值（PPV）是 $P(\\text{存在变异} \\mid \\text{检测阳性})$，阴性预测值（NPV）是 $P(\\text{不存在变异} \\mid \\text{检测阴性})$。仅使用这些定义、全概率公式和贝叶斯定理，首先推导出以 $Se$、$Sp$ 和 $p$ 表示的 $PPV$ 和 $NPV$ 的表达式。然后用 $Se=0.95$、$Sp=0.98$ 和 $p=0.01$ 对它们进行求值。按 $PPV$、$NPV$ 的顺序，以小数形式报告这两个值（不带百分号），并将您的数值结果四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它科学地基于概率论原理及其在医学诊断（贝叶斯推断）中的应用。该问题提法恰当、客观，并包含所有必要信息以获得唯一且有意义的解。\n\n我们如下定义事件：\n$V$：存在致病性变异的事件。\n$V^c$：不存在致病性变异的事件。\n$T^+$：检测结果为阳性的事件。\n$T^-$：检测结果为阴性的事件。\n\n问题陈述中给出的已知条件可以用这些事件来表示：\n检测前概率，或患病率，为 $p = P(V) = 0.01$。\n因此，不存在变异的概率为 $P(V^c) = 1 - P(V) = 1 - p$。\n\n检测的灵敏度为 $Se = P(T^+ \\mid V) = 0.95$。\n这意味着假阴性率为 $P(T^- \\mid V) = 1 - P(T^+ \\mid V) = 1 - Se$。\n\n检测的特异性为 $Sp = P(T^- \\mid V^c) = 0.98$。\n这意味着假阳性率为 $P(T^+ \\mid V^c) = 1 - P(T^- \\mid V^c) = 1 - Sp$。\n\n需要推导的量是阳性预测值（$PPV$）和阴性预测值（$NPV$）：\n$PPV = P(V \\mid T^+)$\n$NPV = P(V^c \\mid T^-)$\n\n我们首先使用贝叶斯定理推导 $PPV$ 的表达式：\n$$PPV = P(V \\mid T^+) = \\frac{P(T^+ \\mid V) P(V)}{P(T^+)}$$\n\n分母 $P(T^+)$ 是检测结果为阳性的总概率。可以使用全概率公式将其展开：\n$$P(T^+) = P(T^+ \\mid V) P(V) + P(T^+ \\mid V^c) P(V^c)$$\n代入已定义的项（$Se$, $Sp$, $p$）：\n$$P(T^+) = (Se)(p) + (1 - Sp)(1 - p)$$\n\n现在，将此展开式代回 $PPV$ 的表达式中：\n$$PPV = \\frac{(Se)(p)}{(Se)(p) + (1 - Sp)(1 - p)}$$\n这就是用 $Se$、$Sp$ 和 $p$ 表示的 $PPV$ 的通用表达式。\n\n接下来，我们推导 $NPV$ 的表达式。根据其定义和贝叶斯定理：\n$$NPV = P(V^c \\mid T^-) = \\frac{P(T^- \\mid V^c) P(V^c)}{P(T^-)}$$\n\n分母 $P(T^-)$ 是检测结果为阴性的总概率。可以使用全概率公式将其展开：\n$$P(T^-) = P(T^- \\mid V^c) P(V^c) + P(T^- \\mid V) P(V)$$\n代入已定义的项（$Se$, $Sp$, $p$）：\n$$P(T^-) = (Sp)(1 - p) + (1 - Se)(p)$$\n\n现在，将此展开式代回 $NPV$ 的表达式中：\n$$NPV = \\frac{(Sp)(1 - p)}{(Sp)(1 - p) + (1 - Se)(p)}$$\n这就是用 $Se$、$Sp$ 和 $p$ 表示的 $NPV$ 的通用表达式。\n\n现在我们使用给定的数值来计算这些表达式：$Se=0.95$，$Sp=0.98$，以及 $p=0.01$。\n\n对于阳性预测值（$PPV$）：\n$$PPV = \\frac{(0.95)(0.01)}{(0.95)(0.01) + (1 - 0.98)(1 - 0.01)}$$\n$$PPV = \\frac{0.0095}{0.0095 + (0.02)(0.99)}$$\n$$PPV = \\frac{0.0095}{0.0095 + 0.0198}$$\n$$PPV = \\frac{0.0095}{0.0293} \\approx 0.32423208...$$\n四舍五入到四位有效数字，我们得到 $PPV = 0.3242$。\n\n对于阴性预测值（$NPV$）：\n$$NPV = \\frac{(0.98)(1 - 0.01)}{(0.98)(1 - 0.01) + (1 - 0.95)(0.01)}$$\n$$NPV = \\frac{(0.98)(0.99)}{(0.98)(0.99) + (0.05)(0.01)}$$\n$$NPV = \\frac{0.9702}{0.9702 + 0.0005}$$\n$$NPV = \\frac{0.9702}{0.9707} \\approx 0.9994849...$$\n四舍五入到四位有效数字，我们得到 $NPV = 0.9995$。\n\n计算出的值为 $PPV=0.3242$ 和 $NPV=0.9995$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.3242  0.9995 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在遗传流行病学研究中，研究人员通常使用比值比（Odds Ratio, $OR$）来报告某个基因变异带来的风险，但这个相对风险的度量对于非专业人士（如患者）来说可能难以直观理解。为了进行有效的风险沟通，临床医生需要将这些抽象的统计数据转化为更具体、更易于理解的绝对风险。这项练习将带您实践如何将一个给定的比值比（$OR$）和人群基线风险（$p_0$）转换为携带该变异个体的绝对风险（$p'$）。这项技能对于以患者为中心的循证风险沟通至关重要。",
            "id": "5079076",
            "problem": "一位遗传咨询师正准备向一位携带与复杂疾病相关的致病性变异的患者传达风险信息。与普通人群相比，该变异的疾病比值比（OR）为 $OR=3$。普通人群的基线绝对风险（在固定时间范围内的患病概率）为 $p_{0}=0.05$。在循证医学遗传学的风险沟通中，临床医生在为患者提供咨询时，应以绝对概率而非比值比来表达风险。\n\n从基本定义出发，通过以下步骤推导携带者的绝对风险 $p'$：\n- 使用比值（odds）的定义，即概率与其补数之比。\n- 使用比值比（OR）的定义，即变异后比值与基线比值之比。\n- 将比值转换回概率。\n\n在给定 $OR=3$ 和 $p_{0}=0.05$ 的情况下，计算患者的 $p'$ 的数值。将最终答案四舍五入至四位有效数字，并以小数形式表示（不要使用百分号）。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于流行病学和医学统计学的原理，问题提出得当，提供了所有必要的数据，并且语言客观。该问题需要一个用于风险评估的标准、可形式化的计算。\n\n设 $p_0$ 代表普通人群的基线绝对风险（概率），$p'$ 代表携带者的绝对风险。问题给出了比值比 $OR=3$ 和基线风险 $p_0 = 0.05$。任务是推导并计算 $p'$。\n\n推导过程遵循问题中概述的三个步骤。\n\n首先，我们将概率为 $P$ 的事件的比值（odds）定义为事件发生的概率与事件不发生的概率之比。普通人群的基线比值，我们记为 $\\text{odds}_0$，由基线概率 $p_0$ 计算得出：\n$$\n\\text{odds}_0 = \\frac{p_0}{1 - p_0}\n$$\n代入给定值 $p_0 = 0.05$：\n$$\n\\text{odds}_0 = \\frac{0.05}{1 - 0.05} = \\frac{0.05}{0.95} = \\frac{5}{95} = \\frac{1}{19}\n$$\n\n其次，比值比（$OR$）定义为携带变异的组（携带者）的比值与基线组（普通人群）的比值之比。设 $\\text{odds}'$ 为携带者的比值。其关系为：\n$$\nOR = \\frac{\\text{odds}'}{\\text{odds}_0}\n$$\n我们可以重新整理这个公式来求解携带者的比值：\n$$\n\\text{odds}' = OR \\times \\text{odds}_0\n$$\n代入给定值 $OR = 3$ 和计算出的 $\\text{odds}_0$ 值：\n$$\n\\text{odds}' = 3 \\times \\frac{1}{19} = \\frac{3}{19}\n$$\n\n第三，我们将携带者的比值 $\\text{odds}'$ 转换回携带者的绝对风险 $p'$。概率和比值之间的关系是可逆的。给定比值，概率 $p'$ 的计算公式为：\n$$\np' = \\frac{\\text{odds}'}{1 + \\text{odds}'}\n$$\n代入 $\\text{odds}'$ 的值：\n$$\np' = \\frac{\\frac{3}{19}}{1 + \\frac{3}{19}} = \\frac{\\frac{3}{19}}{\\frac{19}{19} + \\frac{3}{19}} = \\frac{\\frac{3}{19}}{\\frac{22}{19}} = \\frac{3}{22}\n$$\n\n为了推导以 $p_0$ 和 $OR$ 表示 $p'$ 的通用公式，我们可以代入符号表达式：\n$$\np' = \\frac{\\text{odds}'}{1 + \\text{odds}'} = \\frac{OR \\times \\frac{p_0}{1-p_0}}{1 + OR \\times \\frac{p_0}{1-p_0}}\n$$\n为简化这个繁分数，我们将分子和分母同乘以 $(1 - p_0)$：\n$$\np' = \\frac{OR \\times p_0}{(1 - p_0) + (OR \\times p_0)} = \\frac{OR \\cdot p_0}{1 - p_0 + OR \\cdot p_0}\n$$\n使用这个通用公式并代入给定值 $OR=3$ 和 $p_0=0.05$ 来验证我们的结果：\n$$\np' = \\frac{3 \\times 0.05}{1 - 0.05 + (3 \\times 0.05)} = \\frac{0.15}{0.95 + 0.15} = \\frac{0.15}{1.10} = \\frac{15}{110} = \\frac{3}{22}\n$$\n\n最后，我们计算 $p'$ 的数值，并按要求四舍五入到四位有效数字。\n$$\np' = \\frac{3}{22} \\approx 0.13636363...\n$$\n前四位有效数字是 $1$、$3$、$6$ 和 $3$。第五位有效数字是 $6$，大于或等于 $5$，因此我们将第四位有效数字向上取整。\n$$\np' \\approx 0.1364\n$$\n因此，携带者患上该疾病的绝对风险约为 $0.1364$。",
            "answer": "$$\\boxed{0.1364}$$"
        },
        {
            "introduction": "许多常见复杂疾病（如冠心病、糖尿病）的发生都受到成百上千个遗传变异的共同影响，每个变异的作用都比较微小。多基因风险评分（Polygenic Risk Score, $PRS$）是一种前沿的评估工具，它能够将这些微小的遗传效应汇总起来，评估个体的总体遗传易感性。本练习将通过一个简化的案例，向您展示$PRS$的基本构建方法，即在线性模型框架下将每个单核苷酸多态性（SNP）的效应值（以对数比值比 $\\beta$ 表示）与其基因型进行加权求和。理解$PRS$的构建原理，有助于您把握基因组医学的前沿动态，并为解读复杂疾病的遗传风险评估打下坚实基础。",
            "id": "5079080",
            "problem": "一个临床遗传学团队正在使用遗传流行病学中标准的逻辑回归框架来建模疾病风险。在此类模型中，单核苷酸多态性 (SNPs) 的每等位基因效应量是在对数优势比标度上测量的，并且根据效应等位基因的数量，基因型被加性编码为 $0$、$1$ 或 $2$。该团队希望使用多基因风险评分 (PRS) 来传达患者的遗传风险贡献，PRS 定义为在加性模型下，来自多个 SNP 的对数优势比的总遗传成分。\n\n考虑一个包含三个 SNP 的简单案例，其每等位基因的对数优势比效应量为 $\\beta=(0.2, 0.1, -0.05)$，在加性编码下，患者的基因型为 $(2, 1, 0)$。计算该患者的 PRS，并根据该值的符号，说明其相对于模型的基线（截距）是增加还是降低了风险。将 PRS 报告为一个无单位的纯数字。最终报告值无需四舍五入。您的解释应基于医学遗传学风险评估和沟通策略，但您最终报告的答案必须仅为 PRS 的数值。",
            "solution": "此处风险建模的基础是遗传流行病学中常用的逻辑回归模型。在逻辑回归中，疾病的对数优势比（优势比的对数），即 $\\ln(\\frac{p}{1-p})$，被建模为预测变量的线性函数，其中 $p$ 是疾病概率。在加性遗传模型中，每个 SNP 的贡献项与其基因型计数及其在对数优势比标度上的每等位基因效应量成正比。这些每等位基因效应量通常表示为 SNP $j$ 的 $\\beta_{j}$，基因型计数为 $G_{j} \\in \\{0,1,2\\}$，代表效应等位基因的数量。在对数优势比标度的加性假设下，对数优势比的遗传成分是每等位基因贡献的总和。\n\n多基因风险评分 (PRS) 是一个聚合量，通过将这些每等位基因的对数优势比贡献相加来捕捉风险的遗传成分。从概念上讲，它代表了由所考虑的 SNP 集合贡献的那部分对数优势比。给定三个 SNP 的效应量为 $\\beta=(0.2, 0.1, -0.05)$，基因型为 $(2, 1, 0)$，PRS 通过将这三个贡献相加得到：\n$$\n\\text{PRS} = (0.2)\\cdot 2 + (0.1)\\cdot 1 + (-0.05)\\cdot 0\n$$\n逐项计算：\n$$\n(0.2)\\cdot 2 = 0.4, \\quad (0.1)\\cdot 1 = 0.1, \\quad (-0.05)\\cdot 0 = 0\n$$\n将这些项相加，\n$$\n\\text{PRS} = 0.4 + 0.1 + 0 = 0.5\n$$\n\n相对于基线的解释：因为 PRS 是在对数优势比标度上，正值表示相对于基线截距（模型的非遗传部分）的对数优势比增加，而负值表示相对于基线的减少。此处，$\\text{PRS} = 0.5$ 为正，因此它相对于基线增加了风险。\n\n为了便于沟通，将对数优势比与优势比联系起来通常很有帮助，优势比在优势比标度上是乘法关系。与 PRS 对应的优势比是\n$$\n\\text{OR} = \\exp(\\text{PRS}) = \\exp(0.5)\n$$\n该值大于 $1$，这进一步证实了该基因图谱相对于基线增加了优势比。如果已知基线概率 $p$，可以使用以下公式将其转换为更新后的概率：\n$$\n\\text{updated odds} = \\text{OR} \\times \\frac{p}{1-p}, \\quad \\text{and} \\quad p_{\\text{updated}} = \\frac{\\text{OR}\\cdot p}{1 - p + \\text{OR}\\cdot p}\n$$\n在以患者为中心的风险沟通中，可以解释说该基因图谱将优势比增加了 $\\exp(0.5)$ 倍，同时也要强调概率的绝对变化取决于基线风险，并且 PRS 仅代表遗传成分，不包括环境或临床因素。然而，要求最终报告的值是 PRS 本身，我们已计算出其值为 $0.5$。",
            "answer": "$$\\boxed{0.5}$$"
        }
    ]
}