{
    "hands_on_practices": [
        {
            "introduction": "多基因风险评分 (Polygenic Risk Score, PRS) 的核心是一个加权和，即将个体在一系列遗传变异上的基因型数值乘以各自的效应量后相加。本练习将让你亲手体验这一核心计算过程，为一个假设的个体计算原始PRS，并将其标准化，以了解该个体在参考人群中的位置。这能帮助你理解PRS的基本构成以及个体评分的相对意义 。",
            "id": "4326881",
            "problem": "在一家精准医疗诊所，使用线性多基因评分来总结加性遗传模型下复杂性状的常见变异易感性。某一个体在 $5$ 个独立的单核苷酸多态性 (SNP) 位点上的风险等位基因剂量为 $x=(2,1,0,2,1)$，来自外部全基因组关联研究 (GWAS) 的相应每等位基因效应量估计值为 $\\hat{\\beta}=(0.08,-0.05,0.12,0.02,0.09)$。假设采用常规的加性模型，其中每个位点独立地、可加地贡献于易感性尺度上的对数风险，风险等位基因剂量是每个位点的精确计数，并且这 $5$ 个位点在发现研究中已经过连锁不平衡剪枝，因此可以线性组合权重而不会重复计算相关信号。使用线性多基因评分的常规定义（即通过加权和汇总各位点特异性贡献），根据这些输入构建该个体的未标准化评分 $S$。然后，使用均值为 $\\mu=0.15$、标准差为 $\\sigma=0.10$ 的参考人群评分分布，计算该个体相对于该参考的标准化值 $z$。将报告的两个值都四舍五入到四位有效数字。以行向量的形式报告您的最终答案，其中依次包含 $S$ 和 $z$。不需要单位。",
            "solution": "用户要求基于提供的遗传数据计算未标准化和标准化的多基因评分。\n\n### 步骤 1：问题验证\n\n首先，根据所需标准对问题陈述进行验证。\n\n**提取的已知条件：**\n-   **模型：** 基于加性遗传模型的线性多基因评分。\n-   **风险等位基因剂量向量：** 对于 $5$ 个独立的单核苷酸多态性 (SNP)，$x = (2, 1, 0, 2, 1)$。\n-   **每等位基因效应量估计值向量：** $\\hat{\\beta} = (0.08, -0.05, 0.12, 0.02, 0.09)$。\n-   **未标准化评分 ($S$) 的定义：** 位点特异性贡献的加权和，这可以转化为剂量向量和效应量向量的点积。\n-   **参考人群参数：** 评分均值 $\\mu = 0.15$，标准差 $\\sigma = 0.10$。\n-   **任务：**\n    1.  计算未标准化评分 $S$。\n    2.  计算标准化评分 $z$。\n    3.  将两个值都四舍五入到四位有效数字。\n    4.  以行向量 $[S, z]$ 的形式报告结果。\n\n**验证结论：**\n该问题被判定为**有效**。\n-   **科学依据充分：** 所述计算多基因评分的方法是统计遗传学和精准医疗领域的标准实践。加性模型、使用全基因组关联研究 (GWAS) 的效应量以及标准化都是公认的概念。\n-   **定义明确：** 提供了获得唯一解所需的所有数据和定义。向量 $x$ 和 $\\hat{\\beta}$ 的维度一致。\n-   **客观性：** 问题陈述使用精确的量化语言，没有歧义或主观论断。\n-   该问题不违反任何其他无效标准（例如，它不是不完整的、矛盾的、不切实际的或微不足道的）。\n\n可以继续进行求解过程。\n\n### 步骤 2：计算未标准化多基因评分 ($S$)\n\n问题将未标准化多基因评分 $S$ 定义为风险等位基因剂量的加权和，其中权重是相应的每等位基因效应量。这可以表示为剂量向量 $x$ 和效应量向量 $\\hat{\\beta}$ 的点积。对于 $n$ 个 SNP，公式为：\n$$S = \\sum_{i=1}^{n} x_i \\hat{\\beta}_i = x \\cdot \\hat{\\beta}$$\n在本例中，我们有 $n=5$ 个 SNP。给定的向量是：\n$$x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}$$\n$$\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\\\ \\hat{\\beta}_3 \\\\ \\hat{\\beta}_4 \\\\ \\hat{\\beta}_5 \\end{pmatrix} = \\begin{pmatrix} 0.08 \\\\ -0.05 \\\\ 0.12 \\\\ 0.02 \\\\ 0.09 \\end{pmatrix}$$\n计算如下：\n$$S = (x_1 \\times \\hat{\\beta}_1) + (x_2 \\times \\hat{\\beta}_2) + (x_3 \\times \\hat{\\beta}_3) + (x_4 \\times \\hat{\\beta}_4) + (x_5 \\times \\hat{\\beta}_5)$$\n$$S = (2 \\times 0.08) + (1 \\times -0.05) + (0 \\times 0.12) + (2 \\times 0.02) + (1 \\times 0.09)$$\n$$S = 0.16 - 0.05 + 0 + 0.04 + 0.09$$\n$$S = 0.11 + 0.04 + 0.09$$\n$$S = 0.24$$\n问题要求将此值四舍五入到四位有效数字。数值 $0.24$ 有两位有效数字。为了用四位有效数字表示，我们在后面添加零：\n$$S = 0.2400$$\n\n### 步骤 3：计算标准化多基因评分 ($z$)\n\n标准化评分，或称 $z$-分数，衡量的是一个个体的评分与参考人群均值之间相差多少个标准差。其公式为：\n$$z = \\frac{S - \\mu}{\\sigma}$$\n使用计算出的未标准化评分 $S = 0.24$ 和给定的参考人群参数 $\\mu = 0.15$ 和 $\\sigma = 0.10$：\n$$z = \\frac{0.24 - 0.15}{0.10}$$\n$$z = \\frac{0.09}{0.10}$$\n$$z = 0.9$$\n问题要求也将此值四舍五入到四位有效数字。数值 $0.9$ 有一位有效数字。为了用四位有效数字表示，我们在后面添加零：\n$$z = 0.9000$$\n\n### 步骤 4：最终答案的构建\n\n最终答案应以行向量的形式报告，其中按顺序包含 $S$ 和 $z$ 的四舍五入值。\n所要求的向量是 $(S, z)$，即 $(0.2400, 0.9000)$。这在 LaTeX 中使用 `pmatrix` 环境表示。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.2400  0.9000 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一个PRS并非利用全部三十亿个DNA碱基对来构建，而是需要筛选出与疾病风险最相关的遗传变异。本练习将演示一种经典方法，“剪枝和阈值法” (Clumping and Thresholding, C+T)，用于从全基因组关联研究 (GWAS) 的结果中挑选信息量最丰富的变异。通过这个练习，你将模拟一个关键的生物信息学流程，学习如何在统计显著性和遗传连锁导致的冗余信息之间做出权衡 。",
            "id": "4326863",
            "problem": "在多基因风险建模中，一个核心定义是，个体的多基因风险评分 (PRS) 是通过对选定的单核苷酸多态性 (SNPs) 的基因型剂量进行加权求和来计算的，其中权重是从全基因组关联研究 (GWAS) 中获得的等位基因效应量。形式上，对于选定集合 $\\mathcal{J}$ 中由 $j$ 索引的 SNPs，原始 PRS 为 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$，其中 $\\hat{\\beta}_{j}$ 是 GWAS 的效应量（例如，每等位基因的对数优势比或标准化回归系数），$G_{j}\\in\\{0,1,2\\}$ 是个体风险增加等位基因的基因型剂量。在广泛使用的剪枝和阈值法 (Clumping and Thresholding, C+T) 中，SNP 的选择过程是：(i) 对 GWAS 汇总统计数据应用一个 p 值阈值，然后 (ii) 通过修剪来解决局部连锁不平衡 (LD) 问题，以使保留的 SNPs 之间的成对 LD 低于指定的阈值，该阈值通常用两个位点上等位基因之间的平方相关系数 $r^{2}$ 来衡量。\n\n考虑一个由 10 个 SNPs 组成的玩具位点集，标记为 $s_{1},\\dots,s_{10}$。给定以下针对单个个体的 GWAS p 值、等位基因效应量 $\\hat{\\beta}_{j}$ 和基因型剂量 $G_{j}$：\n- p 值：$p_{1}=1.0\\times 10^{-8}$， $p_{2}=2.0\\times 10^{-7}$， $p_{3}=1.0\\times 10^{-5}$， $p_{4}=4.0\\times 10^{-6}$， $p_{5}=3.0\\times 10^{-5}$， $p_{6}=4.0\\times 10^{-7}$， $p_{7}=2.0\\times 10^{-6}$， $p_{8}=7.0\\times 10^{-6}$， $p_{9}=4.0\\times 10^{-9}$， $p_{10}=1.0\\times 10^{-4}$。\n- 效应量：$\\hat{\\beta}_{1}=0.12$， $\\hat{\\beta}_{2}=0.08$， $\\hat{\\beta}_{3}=-0.05$， $\\hat{\\beta}_{4}=0.04$， $\\hat{\\beta}_{5}=0.02$， $\\hat{\\beta}_{6}=0.09$， $\\hat{\\beta}_{7}=0.06$， $\\hat{\\beta}_{8}=-0.03$， $\\hat{\\beta}_{9}=0.11$， $\\hat{\\beta}_{10}=-0.01$。\n- 个体基因型（剂量）：$G_{1}=2$， $G_{2}=1$， $G_{3}=0$， $G_{4}=2$， $G_{5}=1$， $G_{6}=0$， $G_{7}=2$， $G_{8}=1$， $G_{9}=1$， $G_{10}=2$。\n\n成对 LD 由无序 SNP 对之间的 $r^{2}$ 概括。以下 SNP 对具有非默认的 LD 值：\n- 区块 1 LD：$r^{2}(s_{1},s_{2})=0.35$， $r^{2}(s_{1},s_{4})=0.12$， $r^{2}(s_{2},s_{4})=0.08$。\n- 区块 2 LD：$r^{2}(s_{6},s_{7})=0.15$， $r^{2}(s_{6},s_{8})=0.11$， $r^{2}(s_{7},s_{8})=0.09$。\n- 区块 3 LD：$r^{2}(s_{3},s_{5})=0.20$， $r^{2}(s_{3},s_{10})=0.05$， $r^{2}(s_{5},s_{10})=0.14$。\n对于上面未列出的所有其他无序对 $(s_{i},s_{j})$，取 $r^{2}(s_{i},s_{j})=0.04$。\n\n使用 C+T 程序，GWAS p 值阈值为 $p  5\\times 10^{-6}$，LD 修剪规则为仅保留与已选 SNPs 的成对 $r^{2}$ 严格小于 0.1 的 SNPs。请根据以下明确的剪枝和阈值规则构建选定的 SNP 集合：在通过 p 值阈值的 SNPs 中，按 p 值升序排列；遍历此有序列表，当选择一个 SNP 时，排除任何与该选定 SNP 的 $r^{2}$ 大于或等于 0.1 的剩余 SNP。继续此过程，直到有序列表耗尽。然后，为给定个体计算得到的原始 PRS $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$。将最终的 PRS 表示为一个无单位数，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取给定信息\n- **PRS 公式**：原始多基因风险评分 (PRS) 为 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$，其中 $\\mathcal{J}$ 是选定的单核苷酸多态性 (SNPs) 集合，$\\hat{\\beta}_{j}$ 是效应量，$G_{j}$ 是基因型剂量。\n- **SNPs**：一个包含 10 个 SNPs 的集合，索引为 $j=1, \\dots, 10$。\n- **GWAS p 值**：$p_{1}=1.0\\times 10^{-8}$， $p_{2}=2.0\\times 10^{-7}$， $p_{3}=1.0\\times 10^{-5}$， $p_{4}=4.0\\times 10^{-6}$， $p_{5}=3.0\\times 10^{-5}$， $p_{6}=4.0\\times 10^{-7}$， $p_{7}=2.0\\times 10^{-6}$， $p_{8}=7.0\\times 10^{-6}$， $p_{9}=4.0\\times 10^{-9}$， $p_{10}=1.0\\times 10^{-4}$。\n- **效应量 ($\\hat{\\beta}_{j}$)**：$\\hat{\\beta}_{1}=0.12$， $\\hat{\\beta}_{2}=0.08$， $\\hat{\\beta}_{3}=-0.05$， $\\hat{\\beta}_{4}=0.04$， $\\hat{\\beta}_{5}=0.02$， $\\hat{\\beta}_{6}=0.09$， $\\hat{\\beta}_{7}=0.06$， $\\hat{\\beta}_{8}=-0.03$， $\\hat{\\beta}_{9}=0.11$， $\\hat{\\beta}_{10}=-0.01$。\n- **个体基因型 ($G_{j}$)**：$G_{1}=2$, $G_{2}=1$, $G_{3}=0$, $G_{4}=2$, $G_{5}=1$, $G_{6}=0$, $G_{7}=2$, $G_{8}=1$, $G_{9}=1$, $G_{10}=2$。\n- **连锁不平衡 ($r^{2}$)**：\n  - $r^{2}(s_{1},s_{2})=0.35$\n  - $r^{2}(s_{1},s_{4})=0.12$\n  - $r^{2}(s_{2},s_{4})=0.08$\n  - $r^{2}(s_{6},s_{7})=0.15$\n  - $r^{2}(s_{6},s_{8})=0.11$\n  - $r^{2}(s_{7},s_{8})=0.09$\n  - $r^{2}(s_{3},s_{5})=0.20$\n  - $r^{2}(s_{3},s_{10})=0.05$\n  - $r^{2}(s_{5},s_{10})=0.14$\n  - 所有其他成对 $r^{2}$ 值为 $0.04$。\n- **C+T 程序参数**：\n  - p 值阈值: $p  5 \\times 10^{-6}$。\n  - LD 修剪阈值: $r^{2}  0.1$。\n- **剪枝和阈值规则**：按 p 值阈值筛选 SNPs，按 p 值升序排列，然后迭代：选择一个索引 SNP，并修剪掉任何与该索引 SNP 的 $r^{2} \\ge 0.1$ 的剩余 SNPs。\n- **任务**：计算原始 PRS, $S$，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的给定信息进行验证\n该问题具有科学依据，描述了用于构建 PRS 的标准剪枝和阈值 (C+T) 方法，这是统计遗传学中的一项基石技术。所有定义和参数——p 值、效应量、基因型剂量 ($G_j \\in \\{0, 1, 2\\}$) 和连锁不平衡 ($r^2$)——都是标准的，并且具有合理的值。问题陈述清晰且自洽；提供了所有必要的数据和用于 SNP 选择的确定性、无歧义的算法，确保了唯一解。语言客观、精确。该问题没有违反任何有效性标准。\n\n### 步骤 3：结论与行动\n问题有效，可以按陈述求解。\n\n### 解题过程\n多基因风险评分 (PRS) 的计算主要分两个阶段进行：首先，使用指定的剪枝和阈值 (C+T) 程序选择相关的 SNPs 集合 $\\mathcal{J}$；其次，计算加权和 $S = \\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$。\n\n**阶段 1：使用 C+T 程序选择 SNP**\n\n该程序包括一个 p 值阈值筛选步骤，随后是一个连锁不平衡 (LD) 剪枝（或称clumping）步骤。\n\n**步骤 (i)：p 值阈值筛选**\n我们首先识别所有 GWAS p 值严格小于阈值 $5\\times 10^{-6}$ 的 SNPs。我们检查每个 SNP：\n- $s_{1}: p_{1}=1.0\\times 10^{-8}  5\\times 10^{-6}$ (通过)\n- $s_{2}: p_{2}=2.0\\times 10^{-7}  5\\times 10^{-6}$ (通过)\n- $s_{3}: p_{3}=1.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{4}: p_{4}=4.0\\times 10^{-6}  5\\times 10^{-6}$ (通过)\n- $s_{5}: p_{5}=3.0\\times 10^{-5} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{6}: p_{6}=4.0\\times 10^{-7}  5\\times 10^{-6}$ (通过)\n- $s_{7}: p_{7}=2.0\\times 10^{-6}  5\\times 10^{-6}$ (通过)\n- $s_{8}: p_{8}=7.0\\times 10^{-6} \\ge 5\\times 10^{-6}$ (未通过)\n- $s_{9}: p_{9}=4.0\\times 10^{-9}  5\\times 10^{-6}$ (通过)\n- $s_{10}: p_{10}=1.0\\times 10^{-4} \\ge 5\\times 10^{-6}$ (未通过)\n\n通过此筛选的 SNPs 集合，我们称之为候选集 $\\mathcal{C}$，是 $\\mathcal{C} = \\{s_{1}, s_{2}, s_{4}, s_{6}, s_{7}, s_{9}\\}$。\n\n**步骤 (ii)：LD 剪枝 (Clumping)**\n该算法要求将 $\\mathcal{C}$ 中的 SNPs 按其 p 值升序排列。\n候选 SNPs 的 p 值为：\n- $p_{9} = 4.0\\times 10^{-9}$\n- $p_{1} = 1.0\\times 10^{-8}$\n- $p_{2} = 2.0\\times 10^{-7}$\n- $p_{6} = 4.0\\times 10^{-7}$\n- $p_{7} = 2.0\\times 10^{-6}$\n- $p_{4} = 4.0\\times 10^{-6}$\n\n要遍历的候选者有序列表是 $(s_{9}, s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$。设 $\\mathcal{J}$ 为最终选定的 SNPs 集合，初始为空。修剪规则是，如果某个剩余候选 SNP $s_k$ 与当前索引 SNP $s_i$ 的 LD 满足 $r^{2}(s_i, s_k) \\ge 0.1$，则将其丢弃。\n\n**迭代 1：**\n- 索引 SNP：$s_{9}$（最显著的 SNP）。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}\\}$。\n- 我们检查剩余的候选者 $(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$ 与 $s_{9}$ 的 LD。除非另有说明，LD 为 $r^2=0.04$。\n  - $r^{2}(s_{9}, s_{1}) = 0.04  0.1$。$s_{1}$ 被保留。\n  - $r^{2}(s_{9}, s_{2}) = 0.04  0.1$。$s_{2}$ 被保留。\n  - $r^{2}(s_{9}, s_{6}) = 0.04  0.1$。$s_{6}$ 被保留。\n  - $r^{2}(s_{9}, s_{7}) = 0.04  0.1$。$s_{7}$ 被保留。\n  - $r^{2}(s_{9}, s_{4}) = 0.04  0.1$。$s_{4}$ 被保留。\n- 剩余候选者列表保持不变：$(s_{1}, s_{2}, s_{6}, s_{7}, s_{4})$。\n\n**迭代 2：**\n- 索引 SNP：$s_{1}$（有序列表中的下一个 SNP）。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}, s_{1}\\}$。\n- 我们检查剩余的候选者 $(s_{2}, s_{6}, s_{7}, s_{4})$ 与 $s_{1}$ 的 LD。\n  - $r^{2}(s_{1}, s_{2}) = 0.35 \\ge 0.1$。$s_{2}$ 从列表中修剪掉。\n  - $r^{2}(s_{1}, s_{6}) = 0.04  0.1$。$s_{6}$ 被保留。\n  - $r^{2}(s_{1}, s_{7}) = 0.04  0.1$。$s_{7}$ 被保留。\n  - $r^{2}(s_{1}, s_{4}) = 0.12 \\ge 0.1$。$s_{4}$ 从列表中修剪掉。\n- 剩余候选者列表现在为 $(s_{6}, s_{7})$。\n\n**迭代 3：**\n- 索引 SNP：$s_{6}$。它被添加到选择集中：$\\mathcal{J}=\\{s_{9}, s_{1}, s_{6}\\}$。\n- 我们检查唯一剩余的候选者 $(s_{7})$ 与 $s_{6}$ 的 LD。\n  - $r^{2}(s_{6}, s_{7}) = 0.15 \\ge 0.1$。$s_{7}$ 从列表中修剪掉。\n- 剩余候选者列表现在为空。\n\n由于候选列表已耗尽，算法终止。最终选定的 SNPs 集合为 $\\mathcal{J} = \\{s_{1}, s_{6}, s_{9}\\}$。\n\n**阶段 2：PRS 计算**\n\n原始 PRS, $S$, 使用公式 $S=\\sum_{j\\in\\mathcal{J}}\\hat{\\beta}_{j}G_{j}$ 计算，其中选定的 SNPs 为 $\\mathcal{J}=\\{1, 6, 9\\}$。\n$$S = \\hat{\\beta}_{1}G_{1} + \\hat{\\beta}_{6}G_{6} + \\hat{\\beta}_{9}G_{9}$$\n我们将这三个 SNPs 的给定效应量 ($\\hat{\\beta}_{j}$) 和基因型剂量 ($G_{j}$) 值代入：\n- 对于 $j=1$：$\\hat{\\beta}_{1}=0.12$, $G_{1}=2$\n- 对于 $j=6$：$\\hat{\\beta}_{6}=0.09$, $G_{6}=0$\n- 对于 $j=9$：$\\hat{\\beta}_{9}=0.11$, $G_{9}=1$\n\n计算过程如下：\n$$S = (0.12 \\times 2) + (0.09 \\times 0) + (0.11 \\times 1)$$\n$$S = 0.24 + 0 + 0.11$$\n$$S = 0.35$$\n题目要求答案四舍五入到四位有效数字。计算出的值 $0.35$ 有两位有效数字。为了用四位有效数字表示，我们添加后缀零。\n$$S = 0.3500$$",
            "answer": "$$\\boxed{0.3500}$$"
        },
        {
            "introduction": "一个PRS只有在能有效区分将患病个体和健康个体时才具有临床应用价值。本理论练习通过对“病例”和“对照”人群中评分分布的建模，探讨了PRS的预测能力是如何被决定的。你将推导出评估PRS预测性能的关键指标——受试者工作特征曲线下面积 (Area Under the Curve, AUC)，从而连接起分数的统计特性及其实际临床效用 。",
            "id": "5072377",
            "problem": "评估多基因风险评分 (PRS) 临床效用的一种常用方法是，在合理的分布假设下，研究 PRS 在多大程度上能够区分病例和对照。考虑一种疾病，其病例中的 PRS 模型为均值为 $\\mu_{1}$、方差为 $\\sigma^{2}$ 的正态分布，记为 $N(\\mu_{1},\\sigma^{2})$；对照组中的 PRS 模型为均值为 $\\mu_{0}$、方差为 $\\sigma^{2}$ 的正态分布，记为 $N(\\mu_{0},\\sigma^{2})$。假设病例和对照组的 PRS 值相互独立。基于阈值的分类器将 PRS 值 $x$ 超过阈值 $c$ 的个体判定为病例。\n\n利用受试者工作特征 (ROC) 曲线（所有阈值下的真阳性率与假阳性率的关系）和曲线下面积 (AUC) 的基本定义，以及正态分布及其累积分布函数的经过充分检验的性质，执行以下操作：\n\n1. 通过消除阈值 $c$，推导出 ROC 曲线，将真阳性率表示为假阳性率的函数。\n2. 推导出以 $\\mu_{1}$、$\\mu_{0}$ 和 $\\sigma$ 表示的曲线下面积的封闭形式解析表达式。\n\n提供曲线下面积的封闭形式表达式作为最终答案。无需进行数值计算。",
            "solution": "该问题是有效的。它在科学上基于标准的统计学和生物统计学理论，问题陈述清晰，提供了所有必要信息，并且表述客观。其前提——使用正态分布对多基因风险评分 (PRS) 进行建模，并使用 ROC 分析对其进行评估——是医学遗传学中常见且公认的做法。该问题是信号检测理论中的一个标准推导，提出了一个具有唯一、有意义解的可形式化挑战。\n\n根据要求，解答过程分为两部分：首先，推导受试者工作特征 (ROC) 曲线；其次，推导曲线下面积 (AUC) 的封闭形式表达式。\n\n设 $X_1$ 为代表病例 PRS 的随机变量，$X_0$ 为代表对照组 PRS 的随机变量。问题陈述其分布为：\n$$X_1 \\sim N(\\mu_1, \\sigma^2)$$\n$$X_0 \\sim N(\\mu_0, \\sigma^2)$$\n如果个体的 PRS 值（记为 $x$）超过某一阈值 $c$，则将其分类为病例。\n\nROC 曲线的两个关键指标是真阳性率 (TPR) 和假阳性率 (FPR)。\n\n真阳性率 (TPR)，或称灵敏度，是病例被正确分类为病例的概率。\n$$ \\text{TPR}(c) = P(X_1  c) $$\n假阳性率 (FPR) 是对照被错误分类为病例的概率。\n$$ \\text{FPR}(c) = P(X_0  c) $$\n设 $\\Phi(z)$ 为标准正态分布 $N(0, 1)$ 的累积分布函数 (CDF)。对于一个服从正态分布的随机变量 $X \\sim N(\\mu, \\sigma^2)$，其概率 $P(X  a)$ 可以写为 $1 - P(X \\le a) = 1 - \\Phi\\left(\\frac{a-\\mu}{\\sigma}\\right)$。\n\n利用这个性质，我们可以将 TPR 和 FPR 表示为阈值 $c$ 的函数：\n$$ \\text{TPR}(c) = 1 - \\Phi\\left(\\frac{c - \\mu_1}{\\sigma}\\right) $$\n$$ \\text{FPR}(c) = 1 - \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\nROC 曲线是对于所有可能的阈值 $c$，TPR 与 FPR 的关系图。为了获得 ROC 曲线的表达式，我们必须通过消除 $c$ 来将 TPR 表示为 FPR 的函数。\n\n**第一部分：ROC 曲线的推导**\n\n首先，我们求解 FPR 的方程，以 FPR 表示 $c$。\n$$ \\text{FPR} = 1 - \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\n$$ 1 - \\text{FPR} = \\Phi\\left(\\frac{c - \\mu_0}{\\sigma}\\right) $$\n设 $\\Phi^{-1}$ 表示标准正态分布的反累积分布函数（分位数函数或概率单位函数）。对两边应用 $\\Phi^{-1}$：\n$$ \\Phi^{-1}(1 - \\text{FPR}) = \\frac{c - \\mu_0}{\\sigma} $$\n利用标准正态分布的对称性，$\\Phi^{-1}(1-p) = -\\Phi^{-1}(p)$，我们得到：\n$$ -\\Phi^{-1}(\\text{FPR}) = \\frac{c - \\mu_0}{\\sigma} $$\n求解 $c$：\n$$ c = \\mu_0 - \\sigma \\Phi^{-1}(\\text{FPR}) $$\n现在，我们将这个 $c$ 的表达式代入 TPR 的方程中：\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{(\\mu_0 - \\sigma \\Phi^{-1}(\\text{FPR})) - \\mu_1}{\\sigma}\\right) $$\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\frac{\\sigma \\Phi^{-1}(\\text{FPR})}{\\sigma}\\right) $$\n$$ \\text{TPR} = 1 - \\Phi\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\Phi^{-1}(\\text{FPR})\\right) $$\n利用 CDF 的对称性，$1 - \\Phi(z) = \\Phi(-z)$：\n$$ \\text{TPR} = \\Phi\\left(-\\left(\\frac{\\mu_0 - \\mu_1}{\\sigma} - \\Phi^{-1}(\\text{FPR})\\right)\\right) $$\n$$ \\text{TPR} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma} + \\Phi^{-1}(\\text{FPR})\\right) $$\n这个方程将 TPR 表示为 FPR 的函数，从而定义了 ROC 曲线。\n\n**第二部分：曲线下面积 (AUC) 的推导**\n\nAUC 是 ROC 曲线从 $\\text{FPR} = 0$ 到 $\\text{FPR} = 1$ 的积分：\n$$ \\text{AUC} = \\int_0^1 \\text{TPR}(\\text{FPR}) \\, d(\\text{FPR}) $$\n在这种情况下，一个更直接且更具洞察力的计算 AUC 的方法是利用其概率解释。AUC 等于随机选择一个病例的风险评分高于随机选择一个对照的风险评分的概率。\n$$ \\text{AUC} = P(X_1  X_0) $$\n这可以重写为：\n$$ \\text{AUC} = P(X_1 - X_0  0) $$\n我们定义一个新的随机变量 $Y = X_1 - X_0$。由于 $X_1$ 和 $X_0$ 是独立的服从正态分布的随机变量，它们的差 $Y$ 也服从正态分布。\n$Y$ 的均值是均值之差：\n$$ E[Y] = E[X_1 - X_0] = E[X_1] - E[X_0] = \\mu_1 - \\mu_0 $$\n$Y$ 的方差是方差之和（由于独立性）：\n$$ \\text{Var}(Y) = \\text{Var}(X_1 - X_0) = \\text{Var}(X_1) + \\text{Var}(-X_0) = \\text{Var}(X_1) + (-1)^2 \\text{Var}(X_0) = \\sigma^2 + \\sigma^2 = 2\\sigma^2 $$\n所以，$Y$ 的分布是：\n$$ Y \\sim N(\\mu_1 - \\mu_0, 2\\sigma^2) $$\n$Y$ 的标准差是 $\\sigma_Y = \\sqrt{2\\sigma^2} = \\sigma\\sqrt{2}$。\n\n现在我们可以计算概率 $P(Y  0)$。我们通过减去其均值并除以其标准差来标准化变量 $Y$，以获得一个标准正态变量 $Z$：\n$$ P(Y  0) = P\\left(\\frac{Y - E[Y]}{\\sigma_Y}  \\frac{0 - E[Y]}{\\sigma_Y}\\right) $$\n$$ P(Y  0) = P\\left(Z  \\frac{0 - (\\mu_1 - \\mu_0)}{\\sigma\\sqrt{2}}\\right) $$\n$$ P(Y  0) = P\\left(Z  -\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\n利用标准正态分布的对称性，$P(Z > -z) = P(Z  z)$，我们得到：\n$$ P(Y > 0) = P\\left(Z  \\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\n根据定义，这个概率是标准正态 CDF $\\Phi$ 在该点的值。\n$$ \\text{AUC} = \\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right) $$\n这就是以给定参数 $\\mu_1$、$\\mu_0$ 和 $\\sigma$ 表示的曲线下面积的封闭形式解析表达式。",
            "answer": "$$\\boxed{\\Phi\\left(\\frac{\\mu_1 - \\mu_0}{\\sigma\\sqrt{2}}\\right)}$$"
        }
    ]
}