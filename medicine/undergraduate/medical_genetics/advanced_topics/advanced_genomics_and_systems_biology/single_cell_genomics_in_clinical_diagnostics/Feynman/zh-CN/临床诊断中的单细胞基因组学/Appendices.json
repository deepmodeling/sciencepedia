{
    "hands_on_practices": [
        {
            "introduction": "从实体组织活检到适用于基因组分析的单细胞悬液，这一过程充满了细胞损失。这个初始练习将我们的工作置于这一实际问题中，教您如何通过对连续处理步骤进行建模来计算预期的最终细胞产量 。掌握此计算对于实验规划至关重要，可确保有足够的细胞来满足临床检测的灵敏度要求。",
            "id": "5081910",
            "problem": "一份来自异质性肿瘤的手术活检样本被处理用于单细胞转录组学，以支持医学遗传学的临床诊断。该工作流程包括三个连续的步骤：酶促组织解离以获得单细胞悬液，荧光激活细胞分选（FACS）以富集活细胞并去除碎片或双细胞，以及用于单细胞文库制备的微流控捕获。假设活检样本的初始细胞产量为 $N = 1.0 \\times 10^{6}$ 个细胞。根据经验测得的逐步损失为：解离过程中损失 $30\\%$，分选过程中损失 $20\\%$，捕获过程中损失 $10\\%$。假设这些损失对每个细胞独立起作用，并且每一步的细胞活力已反映在所述的损失率中。所考虑的临床检测要求在捕获后至少有 $M = 2.5 \\times 10^{5}$ 个活的单细胞，以满足检测低频嵌合变异的灵敏度要求。\n\n仅使用核心概率定义和序贯处理步骤的独立性假设，推导出捕获后回收的活单细胞的期望数量。然后，根据该期望值，判断是否满足检测要求。将期望数量以科学记数法表示，并四舍五入到四位有效数字。",
            "solution": "该问题陈述被评估为具有科学依据、问题明确、客观且自洽。所有提供的数据——初始细胞数、连续损失百分比和最低要求细胞计数——在临床环境中的单细胞基因组学工作流程背景下都是合理的。该问题基于概率论的基本原理，特别是独立事件的概念。要求是计算一个期望值并将其与一个阈值进行比较，这是一个标准的、可形式化的任务。因此，该问题是有效的，并将提供解决方案。\n\n设 $N$ 为活检样本的初始细胞数。设 $L_1$、$L_2$ 和 $L_3$ 分别为解离、分选和捕获这三个连续步骤的损失分数。\n给定值为：\n初始细胞产量：$N = 1.0 \\times 10^{6}$\n解离过程中的损失：$L_1 = 30\\% = 0.30$\n分选过程中的损失：$L_2 = 20\\% = 0.20$\n捕获过程中的损失：$L_3 = 10\\% = 0.10$\n检测所需最小细胞数：$M = 2.5 \\times 10^{5}$\n\n保留率，即单个细胞在特定步骤中存活的概率，是损失率的补集。设 $R_1$、$R_2$ 和 $R_3$ 为这三个步骤的保留率。\n解离过程中的保留率为 $R_1 = 1 - L_1 = 1 - 0.30 = 0.70$。\n分选过程中的保留率为 $R_2 = 1 - L_2 = 1 - 0.20 = 0.80$。\n捕获过程中的保留率为 $R_3 = 1 - L_3 = 1 - 0.10 = 0.90$。\n\n问题陈述指出这些损失是独立作用的。因此，单个细胞能够存活所有三个连续处理步骤的总概率 $R_{\\text{total}}$ 是各个保留率的乘积：\n$$R_{\\text{total}} = R_1 \\times R_2 \\times R_3$$\n\n该过程可以被形式化地描述为：将 $N$ 个初始细胞中的每一个都视为进行一次独立的伯努利试验，其中“成功”定义为在所有三个步骤中都存活下来。任何给定细胞的成功概率为 $p = R_{\\text{total}}$。回收的总细胞数 $N_{\\text{final}}$ 服从二项分布 $B(N, p)$。二项分布的期望值由试验次数 ($N$) 和成功概率 ($p$) 的乘积给出。\n\n因此，捕获后回收的活单细胞的期望数量 $E[N_{\\text{final}}]$ 为：\n$$E[N_{\\text{final}}] = N \\times p = N \\times R_{\\text{total}}$$\n$$E[N_{\\text{final}}] = N \\times (1 - L_1) \\times (1 - L_2) \\times (1 - L_3)$$\n\n将给定值代入方程：\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (1 - 0.30) \\times (1 - 0.20) \\times (1 - 0.10)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (0.70) \\times (0.80) \\times (0.90)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times (0.56) \\times (0.90)$$\n$$E[N_{\\text{final}}] = (1.0 \\times 10^{6}) \\times 0.504$$\n$$E[N_{\\text{final}}] = 504000$$\n\n题目要求答案以科学记数法表示，并四舍五入到四位有效数字。\n$$E[N_{\\text{final}}] = 5.040 \\times 10^{5}$$\n\n接下来，我们必须判断是否满足检测要求。这需要将回收细胞的期望数量 $E[N_{\\text{final}}]$ 与最低要求的细胞数量 $M$ 进行比较。\n临床检测要求至少有 $M = 2.5 \\times 10^{5}$ 个细胞。\n我们计算出的回收细胞期望数量为 $E[N_{\\text{final}}] = 5.040 \\times 10^{5}$。\n\n比较这两个值：\n$$5.040 \\times 10^{5} > 2.5 \\times 10^{5}$$\n由于回收细胞的期望数量大于最低要求，我们得出结论，基于此期望，检测要求得到满足。期望产量超过了临床检测的最低阈值。",
            "answer": "$$\\boxed{5.040 \\times 10^{5}}$$"
        },
        {
            "introduction": "基于液滴的单细胞测序依赖于细胞的随机封装，这个过程可以用泊松统计进行优雅地描述。然而，这种随机性带来了一个关键的权衡：加载过多细胞会提高通量，但也会增加“双细胞”（一个液滴中含有多个细胞）的风险，从而污染数据。本练习  将指导您推导双细胞概率，并挑战您找到最佳的细胞加载率，这是设计高质量单细胞实验的一项基本技能。",
            "id": "5081929",
            "problem": "一种用于临床诊断的基于液滴的单细胞RNA测序（scRNA-seq）系统将细胞分配到微液滴中，使得每个液滴中的细胞数量源于随机封装。在标准实践中，对于稀释上样和混合均匀的悬浮液，每个液滴中的细胞数被建模为一个泊松随机变量，其平均上样率为每个液滴 $\\lambda$ 个细胞。从这个假设和泊松过程的定义出发，推导出一个液滴包含两个或更多细胞（双细胞体或更高阶的多细胞体）的期望概率，并将其表示为 $\\lambda$ 的函数。然后，确定在单次运行中实现 $10^{4}$ 个成功捕获的单细胞图谱的预期通量时，能够最小化双细胞体概率的上样率 $\\lambda$。其中，“通量”指产生恰好一个有活性、带条形码细胞的液滴的预期数量。\n\n假设该次运行的以下参数基于实验得出：\n- 液滴生成速率 $R_{d} = 2000$ 个液滴/秒。\n- 运行时间 $T_{\\text{run}} = 1800$ 秒。\n- 有效捕获效率 $\\eta = 0.6$，该效率结合了细胞活性和分子条形码的成功率。\n\n报告在达到目标通量的同时双细胞体概率尽可能小的 $\\lambda$ 的单一值。将 $\\lambda$ 表示为一个无量纲的量，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先验证问题陈述的科学合理性、自洽性和清晰度。\n\n**步骤1：提取已知条件**\n- 每个液滴中的细胞数 $X$ 是一个平均上样率为 $\\lambda$ 的泊松随机变量。\n- 目标1：推导一个液滴包含两个或更多细胞的期望概率 $P(X \\ge 2)$，作为 $\\lambda$ 的函数。\n- 目标2：确定在实现 $10^{4}$ 个成功捕获的单细胞图谱的预期通量时，能够最小化双细胞体概率的上样率 $\\lambda$。\n- “通量”的定义：产生恰好一个有活性、带条形码细胞的液滴的预期数量。\n- 液滴生成速率：$R_{d} = 2000$ 个液滴/秒。\n- 运行时间：$T_{\\text{run}} = 1800$ 秒。\n- 有效捕获效率：$\\eta = 0.6$。\n- 最终答案约束：将 $\\lambda$ 报告为一个无量纲的量，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：液滴微流控技术中细胞封装遵循泊松分布的前提，是单细胞基因组学中一个标准且经过实验验证的模型。它是分析基于液滴的测序数据的基石。给定的参数（$R_{d}$、$T_{\\text{run}}$、$\\eta$）对于商业系统是符合实际的。该问题牢固地植根于已确立的概率论和生物物理学原理。\n- **良态问题**：该问题要求进行推导和约束优化。要最小化的目标函数是双细胞体概率 $P(X \\ge 2)$。约束条件是固定的目标通量。如下所示，双细胞体概率是上样率 $\\lambda$ 的单调递增函数。通量是 $\\lambda$ 的函数，该函数有一个最大值，这意味着一个给定的通量水平可以由两个不同的 $\\lambda$ 值实现。最小化双细胞体概率的指令明确地选择了这两个 $\\lambda$ 值中较小的一个，从而使问题成为一个具有唯一解的良态问题。\n- **客观性**：问题陈述使用了精确、定量和无偏见的语言。所有术语要么是该领域的标准术语，要么被明确定义。\n\n**步骤3：结论与行动**\n该问题是有效的。它在科学上是合理的，是良态的、客观的，并包含了获得唯一解所需的所有信息。开始求解。\n\n**第一部分：多细胞体概率的推导**\n\n令 $X$ 为表示单个液滴中细胞数量的随机变量。根据问题陈述，$X$ 服从均值为 $\\lambda$ 的泊松分布。其概率质量函数（PMF）由下式给出：\n$$\nP(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} \\quad \\text{for } k = 0, 1, 2, \\dots\n$$\n一个液滴包含两个或更多细胞的事件是“多细胞体”事件（双细胞体、三细胞体等）。此事件的概率为 $P(X \\ge 2)$。使用补集法则计算此概率更为方便：\n$$\nP(X \\ge 2) = 1 - P(X  2) = 1 - (P(X=0) + P(X=1))\n$$\n使用PMF，我们求出 $k=0$ 和 $k=1$ 时的概率：\n$$\nP(X=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)\n$$\n$$\nP(X=1) = \\frac{\\lambda^1 \\exp(-\\lambda)}{1!} = \\lambda \\exp(-\\lambda)\n$$\n将这些代入 $P(X \\ge 2)$ 的表达式中，得到所求的函数：\n$$\nP(X \\ge 2) = 1 - \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)\n$$\n\n**第二部分：最优上样率 $\\lambda$ 的确定**\n\n问题要求在满足通量约束的条件下，找到使多细胞体概率 $P(X \\ge 2)$ 最小的上样率 $\\lambda$。为了理解 $P(X \\ge 2)$ 如何依赖于 $\\lambda$，我们可以考察它对 $\\lambda$ 的导数：\n$$\n\\frac{d}{d\\lambda} P(X \\ge 2) = \\frac{d}{d\\lambda} (1 - \\exp(-\\lambda) - \\lambda \\exp(-\\lambda)) = -(-\\exp(-\\lambda)) - (\\exp(-\\lambda) - \\lambda \\exp(-\\lambda)) = \\lambda \\exp(-\\lambda)\n$$\n对于任何有物理意义的上样率 $\\lambda  0$，导数 $\\lambda \\exp(-\\lambda)$ 恒为正。这意味着 $P(X \\ge 2)$ 是 $\\lambda$ 的严格递增函数。因此，要最小化多细胞体概率，我们必须找到满足通量约束的最小可能 $\\lambda$ 值。\n\n通量，我们记为 $T_p$，是成功捕获的单细胞图谱的预期数量。它由生成的总液滴数、一个液滴恰好包含一个细胞的概率以及有效捕获效率共同决定。\n\n首先，我们计算运行期间生成的总液滴数 $N_{\\text{total}}$：\n$$\nN_{\\text{total}} = R_d \\times T_{\\text{run}} = (2000 \\, \\text{s}^{-1}) \\times (1800 \\, \\text{s}) = 3.6 \\times 10^6\n$$\n预期通量 $T_p$ 由下列表达式给出：\n$$\nT_p = N_{\\text{total}} \\times P(X=1) \\times \\eta\n$$\n我们已知目标通量 $T_p = 10^4$ 和效率 $\\eta = 0.6$。代入已知值和 $P(X=1)$ 的表达式：\n$$\n10^4 = (3.6 \\times 10^6) \\times (\\lambda \\exp(-\\lambda)) \\times 0.6\n$$\n我们现在可以解出 $\\lambda \\exp(-\\lambda)$ 这一项：\n$$\n\\lambda \\exp(-\\lambda) = \\frac{10^4}{3.6 \\times 10^6 \\times 0.6} = \\frac{10^4}{2.16 \\times 10^6} = \\frac{1}{216}\n$$\n令此常数为 $C = \\frac{1}{216}$。我们必须解超越方程 $\\lambda \\exp(-\\lambda) = C$。函数 $f(\\lambda) = \\lambda \\exp(-\\lambda)$ 从 $\\lambda=0$ 时的 $0$ 增加到 $\\lambda=1$ 时的最大值 $\\exp(-1) \\approx 0.3679$，然后随着 $\\lambda \\to \\infty$ 递减至 $0$。由于我们的常数 $C = \\frac{1}{216} \\approx 0.00463$ 介于 $0$ 和 $\\exp(-1)$ 之间，因此 $\\lambda$ 有两个实数解：一个在区间 $(0, 1)$ 内，另一个在 $(1, \\infty)$ 内。\n\n如前所述，为了最小化多细胞体概率 $P(X \\ge 2)$，我们必须选择这两个 $\\lambda$ 解中较小的一个。\n\n这个方程可以用朗伯W函数（Lambert W function）正式求解。令 $y = -\\lambda$。方程变为：\n$$\n-(-y) \\exp(y) = C \\implies y \\exp(y) = -C\n$$\n$y$ 的解由 $y = W(-C)$ 给出。朗伯W函数 $W(z)$ 在 $z \\in [-1/e, 0)$ 区间上是多值的。两个实数分支是主分支 $W_0(z)$（其值域为 $[-1, 0]$）和下分支 $W_{-1}(z)$（其值域为 $(-\\infty, -1]$）。\n$\\lambda = -y$ 的两个解是：\n$$\n\\lambda_0 = -W_0(-C)\n$$\n$$\n\\lambda_{-1} = -W_{-1}(-C)\n$$\n由于 $W_0(-C)$ 介于 $-1$ 和 $0$ 之间，所以 $\\lambda_0$ 介于 $0$ 和 $1$ 之间。由于 $W_{-1}(-C)$ 小于 $-1$，所以 $\\lambda_{-1}$ 大于 $1$。我们必须选择较小的解 $\\lambda_0$。\n\n我们现在计算 $\\lambda = -W_0(-1/216)$ 的数值：\n$$\n\\lambda = -W_0\\left(-\\frac{1}{216}\\right) \\approx -W_0(-0.0046296)\n$$\n使用朗伯W函数的数值求解器：\n$$\n\\lambda \\approx 0.004651037\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\lambda \\approx 0.004651\n$$\n这 就是在达到 $10^4$ 个细胞的目标通量的同时，产生多细胞体概率最低的上样率。",
            "answer": "$$\\boxed{0.004651}$$"
        },
        {
            "introduction": "许多临床单细胞分析的最终目标是在单个细胞内可靠地识别遗传变异。这项任务需要将真实的生物学信号与背景测序噪声区分开来。在本练习  中，您将应用概率论的基本原理来构建一个正式的假设检验，从而计算观察到潜在单核苷酸变异 ($SNV$) 的统计显著性，并做出数据驱动的诊断决策。",
            "id": "5081884",
            "problem": "在临床遗传学实验室中，使用一种靶向单细胞DNA测序分析来评估单个细胞是否携带杂合性单核苷酸变异（SNV）。每个覆盖该位点的测序读数（read）独立地报告参考碱基或变异碱基。假设，如果细胞在该位点确实是纯合参考型（即不存在SNV），那么观察到支持变异的读数的唯一方式是通过每个读数的替换错误，其概率为 $\\epsilon$，并且读数错误在不同读数之间是独立的。\n\n基于独立伯努利试验的基本原理和二项分布的定义，在原假设 $H_{0}$（即细胞是纯合参考型，因此支持变异的读数的概率为 $\\epsilon$）下，推导一个用于检验是否存在杂合性SNV的单边假设检验。该检验基于在 $n$ 个总读数中观察到 $k$ 个支持变异的读数。明确地推导出一个以 $k$、$n$ 和 $\\epsilon$ 为函数的 $p$ 值的闭式表达式。\n\n然后，计算当 $k=3$，$n=20$ 且 $\\epsilon=0.01$ 时的 $p$ 值。将你最终的数值概率表示为四舍五入到四位有效数字的小数。",
            "solution": "该问题要求根据DNA测序数据，推导一个单边假设检验，以确定单个细胞中是否存在杂合性单核苷酸变异（SNV）。\n\n首先，我们用统计学术语来形式化这个问题。设 $X$ 为随机变量，表示在覆盖所讨论基因组位点的总共 $n$ 个读数中，支持变异碱基的读数数量。我们已知该变量的观测值为 $X=k$。\n\n问题将原假设 $H_{0}$ 定义为细胞是参考等位基因纯合子的情景。在此假设下，观察到支持变异的读数纯粹是测序错误的结果。每个读数都是一次独立的试验。我们将观察到支持变异的读数定义为一次“成功”。在 $H_{0}$ 下，任何单个读数成功的概率即为给定的错误率 $\\epsilon$。\n\n由于有 $n$ 次独立的试验（读数），每次成功的概率均为 $\\epsilon$，因此随机变量 $X$ 服从二项分布。我们可以将其写作：\n$$\nX | H_{0} \\sim \\text{Binomial}(n, \\epsilon)\n$$\n在原假设下， $X$ 的概率质量函数（PMF）由下式给出：\n$$\nP(X=i | H_{0}) = \\binom{n}{i} \\epsilon^i (1-\\epsilon)^{n-i}\n$$\n对于 $i \\in \\{0, 1, 2, \\ldots, n\\}$。\n\n备择假设 $H_{a}$ 是细胞为SNV杂合子。在这种情况下，我们预期支持变异的读数数量会显著高于仅由错误所能解释的数量。一个理想的杂合位点产生变异读数的概率约为 $0.5$。因此，观察到较大的 $k$ 值提供了反对 $H_{0}$ 并支持 $H_{a}$ 的证据。这表明使用单边右尾检验是合适的。\n\n$p$ 值定义为在原假设 $H_{0}$ 为真的前提下，观察到至少与实际观测结果（即 $k$ 个变异读数）一样极端的结果的概率。对于右尾检验，“至少一样极端”意味着观察到 $k$ 次或更多次成功。\n\n因此，$p$ 值为 $P(X \\ge k | H_0)$。我们可以将其表示为二项分布概率的和：\n$$\np\\text{-value} = P(X \\ge k) = \\sum_{i=k}^{n} P(X=i | H_{0})\n$$\n代入二项PMF，我们得到 $p$ 值作为观测到的变异读数计数 $k$、总读数计数 $n$ 和错误概率 $\\epsilon$ 的函数的通用闭式表达式：\n$$\np\\text{-value}(k, n, \\epsilon) = \\sum_{i=k}^{n} \\binom{n}{i} \\epsilon^i (1-\\epsilon)^{n-i}\n$$\n这完成了问题的第一部分。\n\n对于第二部分，我们必须计算当 $k=3$，$n=20$ 且 $\\epsilon=0.01$ 时的 $p$ 值。表达式变为：\n$$\np\\text{-value} = \\sum_{i=3}^{20} \\binom{20}{i} (0.01)^i (1-0.01)^{20-i}\n$$\n直接计算这18项的和计算量很大。更有效的方法是计算其互补事件 $P(X  3)$ 的概率，然后用1减去它：\n$$\np\\text{-value} = 1 - P(X  3) = 1 - [P(X=0) + P(X=1) + P(X=2)]\n$$\n我们使用二项PMF，其中 $n=20$ 且 $p=\\epsilon=0.01$，来计算这些概率中的每一个：\n$$\nP(X=0) = \\binom{20}{0} (0.01)^0 (0.99)^{20} = 1 \\cdot 1 \\cdot (0.99)^{20} \\approx 0.81790693\n$$\n$$\nP(X=1) = \\binom{20}{1} (0.01)^1 (0.99)^{19} = 20 \\cdot (0.01) \\cdot (0.99)^{19} \\approx 0.16523372\n$$\n$$\nP(X=2) = \\binom{20}{2} (0.01)^2 (0.99)^{18} = \\frac{20 \\cdot 19}{2} \\cdot (0.01)^2 \\cdot (0.99)^{18} = 190 \\cdot (0.0001) \\cdot (0.99)^{18} \\approx 0.01585576\n$$\n现在，我们将这些概率相加：\n$$\nP(X  3) \\approx 0.81790693 + 0.16523372 + 0.01585576 \\approx 0.99899641\n$$\n最后，我们计算 $p$ 值：\n$$\np\\text{-value} = 1 - P(X  3) \\approx 1 - 0.99899641 = 0.00100359\n$$\n问题要求将此结果四舍五入到四位有效数字。第一位有效数字是千分位上的1。第四位有效数字是百万分位上的3。下一位数字是5，所以我们向上取整。\n$$\np\\text{-value} \\approx 0.001004\n$$\n这个很小的 $p$ 值表明，如果细胞确实是纯合参考型（在错误率为1%的情况下），观察到20个读数中有3个变异读数的可能性极低，因此为存在杂合性SNV提供了强有力的统计证据。",
            "answer": "$$\n\\boxed{0.001004}\n$$"
        }
    ]
}