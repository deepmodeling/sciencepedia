{
    "hands_on_practices": [
        {
            "introduction": "The power of a Manhattan plot lies in its use of a logarithmic scale to display an enormous range of $p$-values, making extremely significant associations visible. This first practice grounds your understanding in the fundamental transformation used for the plot's vertical axis, $y = -\\log_{10}(p)$. By working backward from a given y-coordinate to its corresponding $p$-value, you will develop an intuitive feel for what the towering \"skyscrapers\" on the plot truly represent in terms of statistical evidence .",
            "id": "5056435",
            "problem": "In medical genetics, Genome-Wide Association Studies (GWAS) often visualize statistical significance across the genome using a Manhattan plot. In a standard Manhattan plot, the vertical axis for each tested single nucleotide polymorphism (SNP) is defined as the negative base-ten logarithm of its association test p-value. Consider a SNP that appears at vertical coordinate $y=12$ on such a plot. Using only the definition of the Manhattan plot axis and properties of logarithms, compute the corresponding p-value $p$ for this SNP. Then, starting from the same base definitions, rigorously justify why a difference of $1$ unit on the vertical axis corresponds to a tenfold change in $p$-value. Express the final p-value in scientific notation. No rounding is required.",
            "solution": "The problem is well-posed and scientifically sound, resting on the standard definition of the vertical axis in a Manhattan plot used in genome-wide association studies (GWAS). We proceed with the solution by addressing the two parts of the problem statement in order.\n\nPart 1: Calculation of the p-value.\n\nThe problem states that the vertical coordinate, $y$, on a Manhattan plot is defined as the negative base-ten logarithm of the association test p-value, $p$. This relationship can be expressed by the equation:\n$$y = -\\log_{10}(p)$$\nWe are given that a specific single nucleotide polymorphism (SNP) has a vertical coordinate of $y = 12$. Substituting this value into the definitional equation gives:\n$$12 = -\\log_{10}(p)$$\nTo solve for the p-value, $p$, we first isolate the logarithm term by multiplying both sides of the equation by $-1$:\n$$-12 = \\log_{10}(p)$$\nBy the definition of a logarithm, the equation $\\log_b(x) = a$ is equivalent to $b^a = x$. Applying this principle to our equation, with base $b=10$, argument $x=p$, and value $a=-12$, we can rewrite the logarithmic equation in its exponential form:\n$$p = 10^{-12}$$\nThe problem requires the answer to be expressed in scientific notation. The value $10^{-12}$ is equivalent to $1 \\times 10^{-12}$. Thus, the p-value for the SNP is $1 \\times 10^{-12}$.\n\nPart 2: Justification of the tenfold change in p-value.\n\nWe are asked to demonstrate rigorously why a difference of $1$ unit on the vertical axis corresponds to a tenfold change in the p-value. Let us consider two distinct points on the vertical axis, $y_1$ and $y_2$, and their corresponding p-values, $p_1$ and $p_2$. According to the definition:\n$$y_1 = -\\log_{10}(p_1)$$\n$$y_2 = -\\log_{10}(p_2)$$\nLet us set the difference between these two vertical coordinates to be $1$:\n$$y_2 - y_1 = 1$$\nNow, substitute the expressions for $y_1$ and $y_2$ into this difference equation:\n$$(-\\log_{10}(p_2)) - (-\\log_{10}(p_1)) = 1$$\nRearranging the terms gives:\n$$\\log_{10}(p_1) - \\log_{10}(p_2) = 1$$\nWe now apply the quotient rule for logarithms, which states that $\\log_b(u) - \\log_b(v) = \\log_b(\\frac{u}{v})$. Applying this rule to our equation yields:\n$$\\log_{10}\\left(\\frac{p_1}{p_2}\\right) = 1$$\nTo find the relationship between $p_1$ and $p_2$, we convert this logarithmic equation back into its exponential form:\n$$\\frac{p_1}{p_2} = 10^1$$\n$$\\frac{p_1}{p_2} = 10$$\nThis result shows that $p_1 = 10 \\times p_2$. Since we defined $y_2 - y_1 = 1$, or $y_2  y_1$, this means that the p-value $p_2$ (corresponding to the higher, more significant y-value) is one-tenth of the p-value $p_1$ (corresponding to the lower y-value). Conversely, increasing the p-value by a factor of $10$ (a tenfold increase) causes the y-value to decrease by $1$. A decrease in p-value by a factor of $10$ (a tenfold decrease) causes the y-value to increase by $1$. Therefore, a change of $1$ unit on the $y$-axis precisely corresponds to a tenfold change in the p-value, $p$. This completes the formal justification.",
            "answer": "$$\\boxed{1 \\times 10^{-12}}$$"
        },
        {
            "introduction": "Once you can interpret the y-axis, the next key feature of a Manhattan plot is the horizontal line indicating genome-wide significance. This practice explores the statistical foundation of this threshold, focusing on the Bonferroni correction—a method to control for the high risk of false positives when performing millions of tests. You will derive this threshold from first principles and use it to critically evaluate the conventional significance level used in many studies, gaining insight into the trade-offs between statistical rigor and discovery .",
            "id": "5056489",
            "problem": "A Genome-Wide Association Study (GWAS) tests association between a phenotype and genetic variants across the genome. Consider an imputed GWAS that tests $m=8{,}000{,}000$ variants, and suppose, for the purpose of calibration, that the test statistics across variants are independent. A Manhattan plot is to be annotated with a horizontal line indicating the per-variant significance threshold used to control the Family-Wise Error Rate (FWER) at $\\alpha=0.05$.\n\nStarting from first principles, use the definition of FWER and Boole’s inequality (the union bound) to derive the per-variant significance threshold that guarantees $\\mathrm{FWER} \\leq \\alpha$ under no assumptions beyond valid $p$-values. Then, compare this derived threshold to the conventional Manhattan plot line at $5\\times 10^{-8}$, which historically approximates control for about $10^{6}$ effectively independent tests.\n\nLet $t_{\\mathrm{Bonf}}$ denote the Bonferroni per-variant threshold you derive. Compute the ratio\n$$\nR \\;=\\; \\frac{5\\times 10^{-8}}{t_{\\mathrm{Bonf}}}.\n$$\nReport $R$ as your final answer in exact form (no rounding). In your reasoning, determine whether the conventional $5 \\times 10^{-8}$ line is overly conservative or liberal for $m=8{,}000{,}000$ independent tests. No units are required for $R$.",
            "solution": "The Family-Wise Error Rate (FWER) at level $\\alpha$ is the probability of making at least one false rejection among $m$ null hypotheses tested at a common per-test threshold $t$. Formally, if $V$ denotes the number of false positives, then\n$$\n\\mathrm{FWER} \\;=\\; \\Pr(V \\ge 1) \\;=\\; \\Pr\\Big(\\bigcup_{i=1}^{m}\\{\\text{test } i \\text{ is a false positive}\\}\\Big).\n$$\nBy Boole’s inequality (the union bound), for valid $p$-values under true null hypotheses,\n$$\n\\Pr\\Big(\\bigcup_{i=1}^{m} A_i\\Big) \\;\\le\\; \\sum_{i=1}^{m} \\Pr(A_i),\n$$\nwhere $A_i$ is the event that test $i$ is a false positive. If each hypothesis is tested at per-test threshold $t$, then under the null $\\Pr(A_i) \\le t$, so the union bound implies\n$$\n\\mathrm{FWER} \\;\\le\\; m\\,t.\n$$\nTo guarantee $\\mathrm{FWER} \\le \\alpha$, it suffices to choose $t$ such that $m\\,t \\le \\alpha$. The largest such choice is the Bonferroni threshold\n$$\nt_{\\mathrm{Bonf}} \\;=\\; \\frac{\\alpha}{m}.\n$$\nFor the given study with $m=8{,}000{,}000$ and $\\alpha=0.05$, we have\n$$\nt_{\\mathrm{Bonf}} \\;=\\; \\frac{0.05}{8{,}000{,}000} \\;=\\; 6.25 \\times 10^{-9}.\n$$\nThe conventional Manhattan plot line is placed at $t_{\\mathrm{conv}} = 5 \\times 10^{-8}$. The requested ratio is\n$$\nR \\;=\\; \\frac{t_{\\mathrm{conv}}}{t_{\\mathrm{Bonf}}}\n\\;=\\; \\frac{5 \\times 10^{-8}}{6.25 \\times 10^{-9}}\n\\;=\\; 8.\n$$\nInterpretation under independence: because $t_{\\mathrm{conv}}  t_{\\mathrm{Bonf}}$, the conventional line is less stringent than the Bonferroni control appropriate for $m=8{,}000{,}000$ tests. Under independence, the exact FWER when using a common threshold $t$ is\n$$\n\\mathrm{FWER}_{\\mathrm{indep}} \\;=\\; 1 - (1 - t)^{m},\n$$\nwhich is strictly increasing in $t$. Therefore, using $t_{\\mathrm{conv}}$ instead of $t_{\\mathrm{Bonf}}$ yields $\\mathrm{FWER}_{\\mathrm{indep}}  0.05$. Hence, the conventional $5 \\times 10^{-8}$ line is liberal (too permissive) for $m=8{,}000{,}000$ independent tests, by a factor of $R=8$ relative to Bonferroni control at $\\alpha=0.05$.",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "The simple Bonferroni correction assumes all genetic tests are independent, which is rarely true in practice due to linkage disequilibrium (LD). This advanced practice tackles this real-world complexity, showing how correlations between SNPs reduce the \"effective\" number of tests performed. By calculating a significance threshold that accounts for LD within a block of SNPs, you will see why naive corrections can be overly conservative and appreciate the statistical nuance needed for powerful and accurate genetic association analysis .",
            "id": "5056479",
            "problem": "A genome-wide association study in medical genetics has identified a linkage disequilibrium (LD) block containing $50$ single-nucleotide polymorphisms (SNPs). The average pairwise LD measure is reported as $\\overline{r^{2}} = 0.80$. Assume within this block that pairwise genotype correlations are approximately equal, positive, and can be taken as $\\rho \\approx \\sqrt{\\overline{r^{2}}}$. You are interested in how correlation reduces the number of effectively independent tests and how this changes the horizontal significance line in a Manhattan plot.\n\nUse the following foundational facts as your starting point:\n1. Linkage disequilibrium (LD) induces correlation among SNP-based association test statistics, reducing the number of effectively independent tests relative to the raw SNP count.\n2. For a symmetric correlation matrix with equal off-diagonal entries $\\rho$ (compound symmetry), linear algebra implies a spectral decomposition with one large principal component and $M-1$ repeated smaller components when there are $M$ SNPs.\n3. The Bonferroni family-wise error rate control at level $\\alpha$ across $m_{\\text{eff}}$ effectively independent tests yields a per-test threshold $p_{\\text{thr}} = \\alpha / m_{\\text{eff}}$, and the Manhattan plot horizontal line is drawn at $-\\log_{10}\\!\\left(p_{\\text{thr}}\\right)$.\n\nTask:\n1. Starting from the eigen-structure of a compound-symmetry correlation matrix and the spectral notion that each principal component can contribute at most the variance of a single independent test, derive an analytic expression for the effective number of independent tests $m_{\\text{eff}}$ for $M$ equally correlated SNPs in terms of $M$ and $\\rho$.\n2. Specialize to this block with $M = 50$ and $\\rho = \\sqrt{0.80}$, and compute the corresponding family-wise Bonferroni Manhattan threshold $-\\log_{10}\\!\\left( \\alpha / m_{\\text{eff}} \\right)$ for $\\alpha = 0.05$.\n3. Briefly explain qualitatively how your $m_{\\text{eff}}$ compares to $50$ given the high LD and why that changes the Manhattan threshold.\n\nReport only the final numeric value of the Manhattan threshold as a dimensionless quantity. Round your final numeric answer to four significant figures.",
            "solution": "The problem is assessed to be valid. It is scientifically grounded in statistical genetics, well-posed with sufficient information, and uses objective, precise language. All conditions for proceeding with a solution are met.\n\nThe solution is organized into the three tasks requested by the problem statement.\n\n### Task 1: Derivation of the Effective Number of Independent Tests ($m_{\\text{eff}}$)\n\nWe are asked to derive an analytic expression for the effective number of independent tests, $m_{\\text{eff}}$, for $M$ equally correlated single-nucleotide polymorphisms (SNPs). The pairwise correlation is given as $\\rho$. This scenario is modeled by a compound-symmetry correlation matrix.\n\nLet $R$ be the $M \\times M$ correlation matrix. By definition, its diagonal elements are $R_{ii} = 1$ and its off-diagonal elements are $R_{ij} = \\rho$ for $i \\neq j$. This matrix can be expressed as a linear combination of the identity matrix, $I$, and the matrix of all ones, $J$:\n$$\nR = (1-\\rho)I + \\rho J\n$$\nTo find the eigenvalues of $R$, we first identify the eigenvalues of $J$. The matrix $J$ has rank $1$, and its trace is $M$. Its eigenvalues are $\\lambda_J = M$ with multiplicity $1$ (eigenvector is a vector of ones, $\\mathbf{1}$) and $\\lambda_J = 0$ with multiplicity $M-1$ (any vector orthogonal to $\\mathbf{1}$ is an eigenvector).\n\nThe eigenvalues of $R$ are therefore:\n1.  For the single eigenvector corresponding to $\\lambda_J = M$:\n    $$\n    \\lambda_1 = (1-\\rho)(1) + \\rho(M) = 1 - \\rho + M\\rho = 1 + (M-1)\\rho\n    $$\n2.  For the $M-1$ eigenvectors corresponding to $\\lambda_J = 0$:\n    $$\n    \\lambda_i = (1-\\rho)(1) + \\rho(0) = 1 - \\rho \\quad \\text{for } i = 2, 3, \\dots, M\n    $$\nAs a check, the sum of the eigenvalues should equal the trace of the matrix, which is $\\text{Tr}(R) = M$.\n$$\n\\sum_{i=1}^{M} \\lambda_i = \\lambda_1 + \\sum_{i=2}^{M} \\lambda_i = [1 + (M-1)\\rho] + (M-1)(1-\\rho) = 1 + M\\rho - \\rho + M - M\\rho - 1 + \\rho = M\n$$\nThe check is successful.\n\nThe problem states that we should use the \"spectral notion that each principal component can contribute at most the variance of a single independent test\". The variance of a single, standardized, independent test is $1$. The variance of the $i$-th principal component is given by its corresponding eigenvalue, $\\lambda_i$. The effective number of tests, $m_{\\text{eff}}$, can thus be interpreted as the sum of the variances contributed by each principal component, where each contribution is capped at $1$.\n$$\nm_{\\text{eff}} = \\sum_{i=1}^{M} \\min(1, \\lambda_i)\n$$\nFor the given problem, the correlation $\\rho$ is derived from $\\overline{r^2} = 0.80$, so $\\rho = \\sqrt{0.80}$ is in the interval $(0, 1)$.\n- The largest eigenvalue is $\\lambda_1 = 1 + (M-1)\\rho$. Since $M  1$ and $\\rho  0$, $\\lambda_1  1$. Therefore, $\\min(1, \\lambda_1) = 1$.\n- The other $M-1$ eigenvalues are $\\lambda_i = 1-\\rho$. Since $\\rho \\in (0, 1)$, these eigenvalues are in the interval $(0, 1)$. Therefore, $\\min(1, \\lambda_i) = \\lambda_i = 1-\\rho$.\n\nSubstituting these into the expression for $m_{\\text{eff}}$:\n$$\nm_{\\text{eff}} = \\min(1, \\lambda_1) + \\sum_{i=2}^{M} \\min(1, \\lambda_i) = 1 + (M-1)(1-\\rho)\n$$\nThis is the required analytic expression for the effective number of independent tests in terms of $M$ and $\\rho$.\n\n### Task 2: Calculation of the Manhattan Plot Threshold\n\nWe are given:\n- Number of SNPs, $M = 50$.\n- Average pairwise LD, $\\overline{r^{2}} = 0.80$.\n- Family-wise error rate, $\\alpha = 0.05$.\n\nFirst, we compute the correlation $\\rho$:\n$$\n\\rho = \\sqrt{\\overline{r^{2}}} = \\sqrt{0.80}\n$$\nNext, we calculate the effective number of independent tests, $m_{\\text{eff}}$, using the derived formula:\n$$\nm_{\\text{eff}} = 1 + (M-1)(1-\\rho) = 1 + (50-1)(1-\\sqrt{0.80}) = 1 + 49(1-\\sqrt{0.80})\n$$\nNumerically, $m_{\\text{eff}} \\approx 1 + 49(1 - 0.894427) = 1 + 49(0.105573) \\approx 1 + 5.17307 \\approx 6.17307$.\n\nThe Bonferroni-corrected p-value threshold, $p_{\\text{thr}}$, is given by:\n$$\np_{\\text{thr}} = \\frac{\\alpha}{m_{\\text{eff}}} = \\frac{0.05}{1 + 49(1-\\sqrt{0.80})}\n$$\nNumerically, $p_{\\text{thr}} \\approx \\frac{0.05}{6.17307} \\approx 0.008100$.\n\nThe corresponding significance threshold for the Manhattan plot is $-\\log_{10}(p_{\\text{thr}})$:\n$$\n\\text{Threshold} = -\\log_{10}\\left(p_{\\text{thr}}\\right) = -\\log_{10}\\left( \\frac{0.05}{1 + 49(1-\\sqrt{0.80})} \\right)\n$$\nCalculating the numerical value:\n$$\n\\text{Threshold} \\approx -\\log_{10}(0.008100096) \\approx -(-2.091515) \\approx 2.091515\n$$\nRounding to four significant figures, the final value is $2.092$.\n\n### Task 3: Qualitative Explanation\n\nOur calculation shows that for $M=50$ SNPs with high average LD ($\\overline{r^2}=0.80$), the effective number of independent tests is $m_{\\text{eff}} \\approx 6.17$. This is dramatically lower than the raw count of $50$ tests. This reduction occurs because the high correlation between SNPs introduces substantial redundancy in the genetic data; the $50$ statistical tests are not independent. The value $m_{\\text{eff}}$ quantifies the number of \"truly independent\" pieces of information being tested.\n\nThis has a direct impact on the significance threshold. A naive Bonferroni correction would use $M=50$, leading to a p-value threshold of $p_{\\text{naive}} = 0.05/50 = 0.001$, and a Manhattan plot line at $-\\log_{10}(0.001) = 3$. By using the much smaller $m_{\\text{eff}}$, our corrected p-value threshold becomes $p_{\\text{eff}} \\approx 0.0081$, which is nearly an order of magnitude larger (less stringent).\n\nConsequently, the significance line on the Manhattan plot is lowered from $3$ to approximately $2.092$. The $-\\log_{10}(p)$ function is monotonically decreasing, so a larger p-value threshold corresponds to a lower line on the plot's y-axis. This adjustment is crucial: it prevents the over-correction that would occur if correlations were ignored, thereby increasing the statistical power to detect true associations that might otherwise be dismissed as non-significant.",
            "answer": "$$\n\\boxed{2.092}\n$$"
        }
    ]
}