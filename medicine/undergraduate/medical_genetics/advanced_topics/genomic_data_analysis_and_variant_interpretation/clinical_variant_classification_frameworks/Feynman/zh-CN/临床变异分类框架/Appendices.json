{
    "hands_on_practices": [
        {
            "introduction": "在变异分类中，等位基因频率是一个关键证据。一个在普通人群中过于常见的变异，不太可能导致一种罕见的遗传病。这个练习  将指导你如何综合考虑疾病患病率、外显率、遗传异质性及等位基因异质性等关键参数，来计算显性遗传病的最大可信等位基因频率 ($AF_{\\text{max}}$)。这个计算为应用BS1（良性强证据）或BA1（良性独立证据）标准提供了坚实的量化基础。",
            "id": "5021397",
            "problem": "一个实验室正在评估一个常染色体显性遗传基因中的错义变异是否满足美国医学遗传学与基因组学学会/分子病理学协会 (ACMG/AMP) 框架中的良性强证据1 (BS1) 标准。当人群等位基因频率高于某种疾病的预期频率时，可应用此标准。请使用以下公认的定义作为起点：疾病患病率 $K$ 是群体中受影响个体的比例；遗传异质性 $g$ 是所有病例中可归因于目标基因的比例；等位基因异质性 $a$ 是该基因中可归因于所考虑的特定变异的最大病例比例；外显率 $\\pi$ 是该变异携带者表现出疾病的概率。假设这是一种罕见的常染色体显性遗传病，其中纯合子可以忽略不计，大多数携带者是杂合子，因此人群等位基因频率约等于携带者频率的一半。\n\n给定 $K = \\frac{1}{5000}$，$g = 0.2$，$a = 0.1$ 和 $\\pi = 0.5$，首先根据这些定义推导出一个公式，用于计算在这种显性遗传病中一个潜在致病性变异的最大可信人群等位基因频率 $AF_{\\max}$。然后根据所提供的参数计算 $AF_{\\max}$。观测到的 gnomAD 等位基因频率为 $AF_{\\text{obs}} = 0.0006$。定义比率 $R = \\frac{AF_{\\text{obs}}}{AF_{\\max}}$。当 $R \\geq 1$ 时，表明支持该显性遗传病的BS1标准，因为观测到的等位基因频率大于最大可信频率。\n\n将 $R$ 的单个数值作为最终答案报告。将最终答案四舍五入到三位有效数字，并以无单位数字的形式表示。",
            "solution": "问题陈述经评估为有效。它在科学上基于群体遗传学原理和广泛接受的用于临床变异分类的ACMG/AMP框架。问题提取得当，提供了推导公式和计算所需比率 $R$ 的所有必要定义和数据 ($K, g, a, \\pi, AF_{\\text{obs}}$)。术语精确客观，所作假设（例如，罕见常染色体显性遗传病中等位基因频率是携带者频率的一半）是此类计算的标准假设。该问题不违反任何无效标准。\n\n主要任务是为一个致病性变异推导最大可信人群等位基因频率 $AF_{\\max}$ 的公式，然后用它来计算比率 $R$。\n\n推导从提供的定义开始：\n- $K$: 群体中的疾病患病率。\n- $g$: 遗传异质性，表示可归因于目标基因的疾病病例比例。\n- $a$: 等位基因异质性，表示该基因内可归因于被评估的特定变异的最大病例比例。\n- $\\pi$: 外显率，即变异携带者表现出疾病的概率。\n\n首先，我们确定可归因于特定变异的疾病最大患病率。这可以通过将总疾病患病率乘以遗传和等位基因异质性的比例来计算。设这个特定变异的患病率为 $K_{\\text{variant}}$。\n$$K_{\\text{variant}} = K \\times g \\times a$$\n\n接下来，我们将此患病率与群体中携带该变异的个体频率联系起来。设 $CF$ 为该变异的携带者频率。群体中因该变异而受影响的个体数量是携带者数量乘以携带者受影响的概率（外显率，$\\pi$）。因此，由该变异引起的疾病患病率也可以表示为：\n$$K_{\\text{variant}} = CF \\times \\pi$$\n\n通过将 $K_{\\text{variant}}$ 的两个表达式相等，我们可以在群体遗传学参数和携带者频率之间建立关系。最大可信携带者频率 $CF_{\\max}$ 对应于一个变异对疾病贡献达到其最大可能性的情景。\n$$CF_{\\max} \\times \\pi = K \\times g \\times a$$\n\n解出 $CF_{\\max}$ 得：\n$$CF_{\\max} = \\frac{K \\times g \\times a}{\\pi}$$\n\n问题陈述指出，对于罕见的常染色体显性遗传病，人群等位基因频率 ($AF$) 约等于携带者频率 ($CF$) 的一半。这是因为在罕见疾病中，几乎所有携带者都是杂合子，携带一个变异等位基因的拷贝。因此，等位基因的频率是携带它的个体频率的一半。\n$$AF = \\frac{1}{2} CF$$\n\n应用此关系，我们推导出最大可信人群等位基因频率 $AF_{\\max}$ 的公式。\n$$AF_{\\max} = \\frac{1}{2} CF_{\\max} = \\frac{Kga}{2\\pi}$$\n\n现在，我们将给定的数值代入这个推导出的公式中：\n- $K = \\frac{1}{5000} = 0.0002$\n- $g = 0.2$\n- $a = 0.1$\n- $\\pi = 0.5$\n\n$$AF_{\\max} = \\frac{(0.0002) \\times (0.2) \\times (0.1)}{2 \\times (0.5)}$$\n$$AF_{\\max} = \\frac{0.000004}{1}$$\n$$AF_{\\max} = 0.000004$$\n\n问题将比率 $R$ 定义为观测到的等位基因频率 $AF_{\\text{obs}}$ 除以计算出的最大可信等位基因频率 $AF_{\\max}$。\n$$R = \\frac{AF_{\\text{obs}}}{AF_{\\max}}$$\n\n给定 $AF_{\\text{obs}} = 0.0006$。我们现在可以计算 $R$ 的值。\n$$R = \\frac{0.0006}{0.000004}$$\n$$R = \\frac{6 \\times 10^{-4}}{4 \\times 10^{-6}} = \\frac{6}{4} \\times 10^{-4 - (-6)} = 1.5 \\times 10^{2}$$\n$$R = 150$$\n\n问题要求将最终答案四舍五入到三位有效数字。计算出的值 $150$ 可以写成 $1.50 \\times 10^2$，它有三位有效数字。因此，不需要进一步四舍五入。由于 $R = 150 \\geq 1$，BS1标准得到支持。",
            "answer": "$$\n\\boxed{150}\n$$"
        },
        {
            "introduction": "gnomAD等大型人群数据库是变异解读的重要工具，但其数据并非完美无瑕。这个案例研究  让我们直面测序技术的局限性，尤其是在像 $PMS2$ 基因这样的复杂基因组区域。它教导我们在应用PM2（在对照人群中缺失）这类标准之前，必须先评估数据质量（如覆盖度、比对质量和基因组背景）的至关重要的技能，以避免基于无信息数据做出错误分类。",
            "id": "5021401",
            "problem": "一个实验室正在研究 PMS2 基因外显子 $12$ 中的一个单核苷酸缺失（临床怀疑：林奇综合征），该缺失位于一个由 $8$ 个腺嘌呤组成的均聚物内。先证者的变异是 c.$2276$delA。查询了来自基因组聚合数据库 (gnomAD) 的群体数据：\n\n- gnomAD v$2$ 外显子组报告，在测序深度 $\\ge 20\\times$ 时，位点水平的可调用比例为 $f_c^{20\\times} = 0.38$，深度中位数为 $D_{\\text{median}} = 12\\times$。该变异缺失。各个祖源的等位基因数 (AN) 分别为：欧洲人 $AN = 1800$，非洲人 $AN = 600$，拉丁美洲人 $AN = 450$，东亚人 $AN = 700$。\n- gnomAD v$3$ 基因组报告，$f_c^{20\\times} = 0.62$，比对质量中位数 $MQ_{\\text{median}} = 23$。该位点被标记为位于片段重复区域内，并与 PMS2CL 假基因同源。该变异缺失。\n\n您必须决定是否对该变异应用美国医学遗传学与基因组学学会 (ACMG) 和分子病理学协会 (AMP) 的 PM$2$ 标准（在对照组中缺失）。仅使用群体遗传学和测序技术的核心定义（例如，只有当位点具有足够的测序深度、比对质量和祖源代表性，从而被良好检出时，其在群体数据库中的缺失才能说明其稀有性；覆盖深度 $D$ 和比对质量 $MQ$ 定义了可调用性；均聚物和片段重复的背景会影响可靠检测），请选择一个选项，该选项能最好地论证在本案例中是否应应用 PM$2$ 标准，并为决定 PM$2$ 在类似案例中的适用性提出一个明确的、量化的数据充分性防护标准。\n\nA. 应用 PM$2$ 标准，因为该变异在 gnomAD 中缺失。一个充分的防护标准是，只要在任何 gnomAD 数据集中缺失即可，无需考虑 $D$、$MQ$ 或特定祖源的 $AN$。\n\nB. 此处不应用 PM$2$ 标准。一个防护标准应要求外显子组或基因组在 $D \\ge 30\\times$ 时达到 $\\ge 90\\%$ 的可调用比例，所有主要群体的每个祖源 $AN \\ge 20000$，并且该位点不在片段重复或均聚物区域内；否则将群体数据视为无信息性。\n\nC. 以降低的强度（PM$2$_支持）应用 PM$2$ 标准，因为尽管存在一些技术标记，gnomAD 仍显示该变异缺失。一个防护标准应认为，如果 $\\ge 50\\%$ 的样本具有 $D \\ge 10\\times$ 和 $MQ \\ge 20$，则覆盖度足够，无论是否存在片段重复或均聚物背景。\n\nD. 此处不应用 PM$2$ 标准，并将群体数据视为无信息性，因为覆盖度、比对和背景均不充分。一个防护标准应要求满足以下所有条件：在外显子组和基因组中，位点水平在 $D \\ge 20\\times$ 时的可调用比例 $\\ge 85\\%$，$MQ \\ge 30$，不存在片段重复或长度 $\\ge 6$ 的均聚物，并且每个主要祖源的 $AN \\ge 2000$；只有这样，缺失才能用于 PM$2$ 标准。",
            "solution": "用户要求对一个关于应用 ACMG/AMP PM$2$ 标准的临床遗传学问题进行评估。\n\n### 问题验证\n\n**步骤1：提取已知信息**\n- **变异：** *PMS2* 基因外显子 $12$ 中的 c.$2276$delA。\n- **临床背景：** 怀疑为林奇综合征。\n- **基因组背景：** 由 $8$ 个腺嘌呤组成的均聚物。\n- **gnomAD v$2$ 外显子组数据：**\n    - 测序深度 $\\ge 20\\times$ 时的可调用比例：$f_c^{20\\times} = 0.38$。\n    - 深度中位数：$D_{\\text{median}} = 12\\times$。\n    - 变异缺失。\n    - 各个祖源的等位基因数 (AN)：欧洲人 $AN = 1800$，非洲人 $AN = 600$，拉丁美洲人 $AN = 450$，东亚人 $AN = 700$。\n- **gnomAD v$3$ 基因组数据：**\n    - 测序深度 $\\ge 20\\times$ 时的可调用比例：$f_c^{20\\times} = 0.62$。\n    - 比对质量中位数：$MQ_{\\text{median}} = 23$。\n    - 位点被标记为位于片段重复区域内。\n    - 位点与 *PMS2CL* 假基因同源。\n    - 变异缺失。\n- **ACMG/AMP 标准：** PM$2$ (在对照组中缺失)。\n- **评估的核心原则：**\n    1. 只有当位点被良好检出时，其在群体数据库中的缺失才能说明其稀有性。\n    2. 良好检出取决于足够的测序深度 ($D$)、比对质量 ($MQ$) 和祖源代表性。\n    3. 均聚物和片段重复的背景会影响可靠检测。\n\n**步骤2：使用提取的已知信息进行验证**\n问题陈述具有科学依据、提法明确且客观。它提供了一个现实的临床场景，涉及 *PMS2* 基因，该基因因与假基因 *PMS2CL* 高度同源而出了名地难以准确测序。所提供的数据（可调用比例、测序深度、比对质量、基因组背景标记）是基因组学中用于评估特定位点数据质量的标准指标。为评估提供的核心原则对于正确解读新一代测序数据至关重要。该问题是自洽的，没有内部矛盾，也不缺少做出合理判断所需的信息。该问题是有效的。\n\n**步骤3：结论和行动**\n该问题有效。将推导出一个完整的解决方案。\n\n### 解决方案推导\n\n是否应用 ACMG/AMP 的 PM$2$ 标准，取决于该变异在对照数据库 (gnomAD) 中的缺失是否具有信息性。这需要对 *PMS2* 基因 c.$2276$ 变异位点的数据质量进行严格评估。我们必须在核心原则的背景下分析所提供的数据。\n\n1.  **基因组背景：** 该变异位于两个有问题的背景中：\n    - 一个由 $8$ 个腺嘌呤组成的均聚物。短读长测序技术在均聚物区域内对插入和删除（indels）的错误率很高，特别是长度 $\\ge 6$ 的均聚物。所讨论的变异是一个单核苷酸缺失（c.$2276$delA），属于一种 indel。因此，在这种背景下，其检测本身就不可靠。\n    - 一个片段重复区域，并与假基因 *PMS2CL* 同源。这是一个关键问题。基因和假基因之间的高度序列相似性导致短测序读段模糊比对。这种模糊性导致比对质量 ($MQ$) 低，而 $MQ$ 是衡量读段是否被正确定位到基因组中的置信度指标。gnomAD v$3$ 的数据证实了这一点，指出比对质量中位数 $MQ_{\\text{median}} = 23$。这是一个非常低的值；高置信度的变异检出通常要求 $MQ$ 分数至少为 $30$，甚至常常 >$50$。低 $MQ$ 的读段通常被过滤掉或降低权重，这意味着一个真实的变异可能会被漏检。\n\n2.  **测序覆盖度和可调用性：**\n    - **gnomAD v2 (外显子组)：** $D_{\\text{median}} = 12\\times$ 的深度中位数不足以进行可靠的杂合变异检出，特别是对于一个位于困难区域的 indel。此外，在最低深度为 $20\\times$ 时的可调用比例仅为 $f_c^{20\\times} = 0.38$。这意味着，在这种贫乏的深度下，我们只对外显子测序群体中的 $38\\%$ 拥有可调用的数据。剩下的 $62\\%$ 无法进行可靠评估。\n    - **gnomAD v3 (基因组)：** 虽然情况有所改善，但在 $20\\times$ 深度下的可调用比例仍然只有 $f_c^{20\\times} = 0.62$。这表明对于 $38\\%$ 的基因组测序群体，数据不足以进行可靠的基因分型。对于一个依赖于缺失的准则来说，如此大比例的对照群体数据不具信息性是不可接受的。\n\n3.  **等位基因数 ($AN$):** 所提供的等位基因数（例如，欧洲人 $AN = 1800$）代表该祖源群体中的等位基因总数，而不是*可调用*的等位基因数。鉴于低的可调用比例（$0.38$ 和 $0.62$），能够可靠检测到变异的有效等位基因数要低得多。例如，使用 v$2$ 数据，欧洲人的有效 AN 最多约为 $1800 \\times 0.38 \\approx 684$。这个样本量太小，无法有把握地断言其稀有性。\n\n**关于 PM2 应用的结论：**\n困难的基因组背景（长均聚物、片段重复）、明显低的比对质量 ($MQ_{\\text{median}} = 23$) 以及差的覆盖度（$f_c^{20\\times}$ 分别为 $0.38$ 和 $0.62$）的组合，使得来自 gnomAD 的群体数据在该位点上不具信息性。变异 c.$2276$delA 的缺失并不意味着该变异是稀有的；它意味着数据库很可能即使该变异存在也无法检测到它。因此，应用 PM$2$ 在科学上是不正确的。必须忽略该变异的群体数据。\n\n### 逐项分析选项\n\n**A. 应用 PM$2$ 标准，因为该变异在 gnomAD 中缺失。一个充分的防护标准是，只要在任何 gnomAD 数据集中缺失即可，无需考虑 $D$、$MQ$ 或特定祖源的 $AN$。**\n这个选项应用 PM$2$ 的建议是不正确的，如上文推导。所提议的防护标准在科学上是不可靠的，因为它忽略了基因组学中数据质量评估的所有原则。这种方法将导致变异解读中频繁出现重大错误。\n**结论：不正确。**\n\n**B. 此处不应用 PM$2$ 标准。一个防护标准应要求外显子组或基因组在 $D \\ge 30\\times$ 时达到 $\\ge 90\\%$ 的可调用比例，所有主要群体的每个祖源 $AN \\ge 20000$，并且该位点不在片段重复或均聚物区域内；否则将群体数据视为无信息性。**\n这个选项正确地建议不应用 PM$2$。所提议的防护标准包含了正确的原则（覆盖度、深度、祖源、背景）。然而，一些阈值过于严格。每个祖源 $AN \\ge 20000$ 远高于大多数标准方案，并将严重限制 PM$2$ 的适用性。虽然安全，但它不是一个实用或标准的防护措施。\n**结论：不正确。** 其理由是合理的，但提议的防护标准过于严格，不切实际，使其在选项中并非“最佳”论证。\n\n**C. 以降低的强度（PM$2$_支持）应用 PM$2$ 标准，因为尽管存在一些技术标记，gnomAD 仍显示该变异缺失。一个防护标准应认为，如果 $\\ge 50\\%$ 的样本具有 $D \\ge 10\\times$ 和 $MQ \\ge 20$，则覆盖度足够，无论是否存在片段重复或均聚物背景。**\n这个选项应用 PM$2$ 的建议，即使是在支持级别，也是不正确的。数据不是弱信息性的；它是无信息性的。所提议的防护标准过于宽松，十分危险，其使用的阈值（$D \\ge 10\\times$, $MQ \\ge 20$）远低于可靠变异检出的公认标准，并且明确忽略了关键的混杂因素（片段重复、均聚物）。\n**结论：不正确。**\n\n**D. 此处不应用 PM$2$ 标准，并将群体数据视为无信息性，因为覆盖度、比对和背景均不充分。一个防护标准应要求满足以下所有条件：在外显子组和基因组中，位点水平在 $D \\ge 20\\times$ 时的可调用比例 $\\ge 85\\%$，$MQ \\ge 30$，不存在片段重复或长度 $\\ge 6$ 的均聚物，并且每个主要祖源的 $AN \\ge 2000$；只有这样，缺失才能用于 PM$2$ 标准。**\n这个选项正确地得出结论，即不应应用 PM$2$，并且由于数据质量不足，应将群体数据视为无信息性。所提议的防护标准非常出色、全面，并与当前临床基因组学的最佳实践相符。\n- 在 $D \\ge 20\\times$ 时 $f_c \\ge 85\\%$：一个强大且实用的覆盖度标准。\n- $MQ \\ge 30$：一个合理的比对质量最低阈值，它正确地将此 *PMS2* 变异的数据（$MQ_{\\text{median}} = 23$）识别为不充分。\n- `不存在片段重复或长度 $\\ge 6$ 的均聚物`：针对有问题的基因组背景的特定且正确的排除标准。给定的变异位于一个长度为 $8$ 的均聚物中，因此它会被正确排除。\n- `每个主要祖源的 $AN \\ge 2000$`：一个标准的、统计上合理的等位基因计数阈值。\n这个选项提供了正确的行动、正确的理由，以及最科学合理且实用的量化防护标准。\n**结论：正确。**",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "ACMG/AMP框架提供了通用指南，但在实际应用中，往往需要针对特定基因进行细化。这个练习  模拟了这一过程，要求你为 $\\text{MYH7}$ 基因的PM1标准（突变热点或功能域）构建一个详细的、量化的决策规则。你将把关于蛋白质结构域和变异密度的生物学知识，转化为一个精确的、可编程的算法，这是现代规模化临床基因组学的一项核心任务。",
            "id": "5021410",
            "problem": "您的任务是为基因 β-肌球蛋白重链（$\\text{MYH7}$）（一种经过深入研究的家族性心肌病病因）构建一个基于规则的美国医学遗传学与基因组学学会 (ACMG) 和分子病理学协会 (AMP) 框架标准（称为 PM1）的实现。PM1 标准考虑的是变异是否落在一个没有良性变异的突变热点或公认的功能域内。您的规则必须根据基本定义和经过检验的事实从第一性原理推导得出，不得依赖快捷公式。\n\n从以下基础出发：\n- 分子生物学的中心法则确立了这样一个观点：改变蛋白质序列的变异（例如，错义变异）如果发生在关键的蛋白质功能域内，就可能影响其功能。这是一个定性的陈述，但它为从基因组变异到蛋白质位置的映射提供了动因。\n- ACMG 和 AMP 框架将 PM1 定义为适用于位于对蛋白质功能至关重要的突变热点或功能域内，并且其中不存在或罕见良性变异的变异。这为规则设计提供了结构基础，但并未提供计算实现。\n- 群体遗传学事实：能够容忍良性变异的区域将显示出相对较高的良性错义观测密度，而受约束的区域则显示出较低的密度。这为设定定量密度阈值提供了动因。\n- 经实验验证的功能域为功能关键性提供了证据。它们可作为分类的功能域边界。\n\n您必须使用以下经实验验证的功能域为 $\\text{MYH7}$ 重新设计 PM1，这些功能域被建模为蛋白质序列上的区间（氨基酸位置，$p$，其中 $p$ 是一个整数）：\n- 马达结构域：起始 $p = 1$，终止 $p = 778$，标记为关键，良性错义密度 $d = 0.6$ 良性观测/100个残基，热点密度 $h = 1.8$ 致病性观测/100个残基。\n- 转换区：起始 $p = 706$，终止 $p = 790$，标记为关键，其中 $d = 0.3$，$h = 4.2$。\n- 卷曲螺旋杆中的相互作用头基序界面片段：起始 $p = 1780$，终止 $p = 1850$，标记为关键，其中 $d = 0.7$，$h = 2.5$。\n- 卷曲螺旋杆结构域：起始 $p = 840$，终止 $p = 1935$，标记为非关键（支持性），其中 $d = 2.0$，$h = 0.8$。\n\n此外，需要纳入特定残基上存在良性变异的位点水平证据，这些证据由一组存在已记录的良性错义观测的位置表示。使用以下位置集合作为位点水平的良性证据：$\\{100, 860, 1785\\}$。\n\n将 PM1 强度等级定义为整数：\n- PM1 无：$0$，\n- PM1 支持：$1$，\n- PM1 中等：$2$，\n- PM1 强：$3$。\n\n构建一个 PM1 决策规则，该规则将一个由位置 $p$、变异类型 $t$ 和一个布尔值 $b$（指示在该确切残基上是否有已记录的良性变异，$b = \\text{True}$ 表示有记录，否则为 $b = \\text{False}$）表征的变异映射到一个 PM1 强度整数。您的决策规则必须满足以下所有约束，并从上述基础推导得出：\n1. PM1 仅适用于错义变异；对于 $t \\neq \\text{\"missense\"}$，将 PM1 设置为 $0$。\n2. 如果 $b = \\text{True}$，则无论功能域背景如何，都将 PM1 设置为 $0$，以强制执行“无良性变异”条款。\n3. 如果多个功能域与位置 $p$ 重叠，则选择良性错义密度 $d$ 最小的功能域，以代表最强的局部约束证据。\n4. 如果所选功能域为关键功能域，并且同时满足 $d \\le 0.5$ 和 $h \\ge 2.0$，则指定为 PM1 强 ($3$)。\n5. 如果所选功能域为关键功能域，并且至少满足 $d \\le 1.5$ 或 $h \\ge 1.5$ 中的一个条件，则指定为 PM1 中等 ($2$)。\n6. 如果所选功能域经过验证（关键或支持性），并且满足 $d < 2.5$，则指定为 PM1 支持 ($1$)。\n7. 否则，指定为 PM1 无 ($0$)。\n\n所有密度 ($d$) 和热点度量 ($h$) 均应视为浮点数。不涉及物理单位。请勿使用百分比；以小数形式表示任何比例量。\n\n将此规则集实现为一个完整、可运行的程序，处理以下变异测试套件，其中每个案例都是一个元组 $(p, t, b)$：\n- 案例 1：$(725,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 2：$(100,\\ \\text{\"missense\"},\\ \\text{True})$\n- 案例 3：$(900,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 4：$(750,\\ \\text{\"nonsense\"},\\ \\text{False})$\n- 案例 5：$(820,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 6：$(860,\\ \\text{\"missense\"},\\ \\text{True})$\n- 案例 7：$(1800,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 8：$(790,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 9：$(840,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 10：$(500,\\ \\text{\"missense\"},\\ \\text{False})$\n- 案例 11：$(1785,\\ \\text{\"missense\"},\\ \\text{True})$\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\text{\"[0,1,2]\"}$）。预期的输出列表必须按所列顺序包含各案例的 PM1 强度整数。",
            "solution": "问题陈述经评估有效。它在科学上植根于医学遗传学原理，特别是 ACMG/AMP 变异分类框架。问题阐述清晰，提供了一套完整且一致的定义、数据和逻辑规则，从而能够为每个测试案例推导出唯一的解决方案。该问题是客观且可形式化的。\n\n任务是构建并应用一套决策规则，以确定 $\\text{MYH7}$ 基因中遗传变异的 PM1 证据标准的强度。提供的参数和规则将被形式化，然后应用于每个测试案例。\n\n首先，我们将蛋白质功能域定义为数据结构。每个功能域都有一个名称、一个起始和终止位置 ($p$)、一个关键性状态、一个良性错义密度 ($d$) 和一个致病性热点密度 ($h$)。所有序列位置都是基于 1 且包含在内的。\n- **马达结构域**：$p \\in [1, 778]$，critical=True，$d=0.6$，$h=1.8$\n- **转换区**：$p \\in [706, 790]$，critical=True，$d=0.3$，$h=4.2$\n- **相互作用头基序**：$p \\in [1780, 1850]$，critical=True，$d=0.7$，$h=2.5$\n- **卷曲螺旋杆结构域**：$p \\in [840, 1935]$，critical=False (支持性)，$d=2.0$，$h=0.8$\n\nPM1 强度等级被编码为整数：无 ($0$)、支持 ($1$)、中等 ($2$) 和强 ($3$)。\n\n决策逻辑是一系列应用于由 $(p, t, b)$ 指定的输入变异的规则，其中 $p$ 是氨基酸位置，$t$ 是变异类型，$b$ 是一个布尔值，指示该位点是否存在已知的良性变异。这些规则必须按特定的层级顺序应用。\n\n1.  如果变异类型 $t$ 不是 $\\text{\"missense\"}$，则 PM1 得分为 $0$。\n2.  如果在该位点有已记录的良性变异 ($b = \\text{True}$)，则 PM1 得分为 $0$。\n3.  对于给定的位置 $p$，识别所有重叠的功能域。如果多个功能域重叠，则选择良性密度 $d$ 最小的一个。如果没有功能域重叠，则不选择任何功能域。\n4.  如果选择了功能域，则应用以下层级评分规则：\n    a. (PM1 强，得分 $3$)：所选功能域为关键功能域，并且其良性密度 $d \\le 0.5$ 且其热点密度 $h \\ge 2.0$。\n    b. (PM1 中等，得分 $2$)：如果不满足“强”的条件，所选功能域为关键功能域，并且 ($d \\le 1.5$ 或 $h \\ge 1.5$)。\n    c. (PM1 支持，得分 $1$)：如果不满足“强”或“中等”的条件，该功能域经过验证（关键或支持性）并且 $d < 2.5$。\n    d. (PM1 无，得分 $0$)：其他情况。这也适用于步骤 3 中未选择任何功能域的情况。\n\n现在我们将这套完整的规则应用于每个测试案例。\n\n**案例 1：($p=725$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：变异是 $\\text{\"missense\"}$ 并且 $b$ 是 $\\text{False}$。我们继续。\n- 规则 3：位置 $p=725$ 落在两个功能域内：马达结构域 ($p \\in [1, 778]$，$d=0.6$) 和转换区 ($p \\in [706, 790]$，$d=0.3$)。我们选择转换区，因为它的良性密度较低 ($0.3  0.6$)。\n- 规则 4：所选的功能域（转换区）是关键的，其 $d=0.3 \\le 0.5$，并且其 $h=4.2 \\ge 2.0$。满足 PM1 强的条件。\n- 结果：$3$。\n\n**案例 2：($p=100$, $t=\\text{\"missense\"}$, $b=\\text{True}$)**\n- 规则 2：布尔值 $b$ 是 $\\text{True}$。\n- 结果：$0$。\n\n**案例 3：($p=900$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=900$ 仅落在卷曲螺旋杆结构域内 ($p \\in [840, 1935]$，$d=2.0$，$h=0.8$，支持性)。选择此功能域。\n- 规则 4：\n    a. (强)：此功能域不是关键功能域。条件不满足。\n    b. (中等)：此功能域不是关键功能域。条件不满足。\n    c. (支持)：该功能域经过验证（支持性）。其 $d=2.0  2.5$。满足 PM1 支持的条件。\n- 结果：$1$。\n\n**案例 4：($p=750$, $t=\\text{\"nonsense\"}$, $b=\\text{False}$)**\n- 规则 1：变异类型 $t$ 是 $\\text{\"nonsense\"}$，而不是 $\\text{\"missense\"}$。\n- 结果：$0$。\n\n**案例 5：($p=820$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=820$ 不落在任何已定义的功能域内。转换区的最后一个残基是 $790$，而卷曲螺旋杆的第一个残基是 $840$。\n- 规则 4：没有选择任何功能域，因此我们进入“其他情况”条件。\n- 结果：$0$。\n\n**案例 6：($p=860$, $t=\\text{\"missense\"}$, $b=\\text{True}$)**\n- 规则 2：布尔值 $b$ 是 $\\text{True}$。\n- 结果：$0$。\n\n**案例 7：($p=1800$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=1800$ 落在两个功能域内：相互作用头基序 ($p \\in [1780, 1850]$，$d=0.7$) 和卷曲螺旋杆 ($p \\in [840, 1935]$，$d=2.0$)。我们选择相互作用头基序功能域，因为其良性密度较低 ($0.7  2.0$)。\n- 规则 4：所选的功能域（相互作用头基序）具有以下属性：critical=True，$d=0.7$，$h=2.5$。\n    a. (强)：该功能域是关键的，但 $d=0.7$ 不满足 $\\le 0.5$。条件不满足。\n    b. (中等)：该功能域是关键的。我们检查 OR 条件：($d \\le 1.5$ 或 $h \\ge 1.5$)。由于 $d=0.7 \\le 1.5$ (并且 $h=2.5 \\ge 1.5$)，条件满足。\n- 结果：$2$。\n\n**案例 8：($p=790$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=790$ 仅落在转换区内 ($p \\in [706, 790]$)。选择此功能域。\n- 规则 4：转换区是关键的，$d=0.3 \\le 0.5$，并且 $h=4.2 \\ge 2.0$。满足 PM1 强的条件。\n- 结果：$3$。\n\n**案例 9：($p=840$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=840$ 仅落在卷曲螺旋杆结构域内 ($p \\in [840, 1935]$)。\n- 规则 4：\n    a. (强)：非关键。\n    b. (中等)：非关键。\n    c. (支持)：该功能域经过验证。其 $d=2.0  2.5$。条件满足。\n- 结果：$1$。\n\n**案例 10：($p=500$, $t=\\text{\"missense\"}$, $b=\\text{False}$)**\n- 规则 1 和 2：我们继续。\n- 规则 3：位置 $p=500$ 仅落在马达结构域内 ($p \\in [1, 778]$)。\n- 规则 4：所选的功能域（马达结构域）具有以下属性：critical=True，$d=0.6$，$h=1.8$。\n    a. (强)：功能域是关键的，但 $d=0.6$ 不满足 $\\le 0.5$。条件不满足。\n    b. (中等)：功能域是关键的。我们检查 ($d \\le 1.5$ 或 $h \\ge 1.5$)。由于 $d=0.6 \\le 1.5$ 且 $h=1.8 \\ge 1.5$，条件满足。\n- 结果：$2$。\n\n**案例 11：($p=1785$, $t=\\text{\"missense\"}$, $b=\\text{True}$)**\n- 规则 2：布尔值 $b$ 是 $\\text{True}$。\n- 结果：$0$。\n\n结果总结：\n- 案例 1：$3$\n- 案例 2：$0$\n- 案例 3：$1$\n- 案例 4：$0$\n- 案例 5：$0$\n- 案例 6：$0$\n- 案例 7：$2$\n- 案例 8：$3$\n- 案例 9：$1$\n- 案例 10：$2$\n- 案例 11：$0$\n\n最终输出是列表 $[3,0,1,0,0,0,2,3,1,2,0]$。此推导过程为计算实现提供了基础。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a rule-based version of the ACMG/AMP PM1 criterion for MYH7 variants.\n    \"\"\"\n    \n    # Define the domain data from the problem statement.\n    # A domain is represented as a dictionary with its properties.\n    domains = [\n        {\n            \"name\": \"Motor domain\",\n            \"start\": 1, \"end\": 778, \"is_critical\": True,\n            \"d\": 0.6, \"h\": 1.8\n        },\n        {\n            \"name\": \"Converter region\",\n            \"start\": 706, \"end\": 790, \"is_critical\": True,\n            \"d\": 0.3, \"h\": 4.2\n        },\n        {\n            \"name\": \"Interacting-heads motif\",\n            \"start\": 1780, \"end\": 1850, \"is_critical\": True,\n            \"d\": 0.7, \"h\": 2.5\n        },\n        {\n            \"name\": \"Coiled-coil rod domain\",\n            \"start\": 840, \"end\": 1935, \"is_critical\": False,\n            \"d\": 2.0, \"h\": 0.8\n        }\n    ]\n\n    # Define the test suite of variants from the problem statement.\n    # Each case is a tuple (p, t, b) where:\n    # p: amino acid position (int)\n    # t: variant type (str)\n    # b: benign variant at site (bool)\n    test_cases = [\n        (725, \"missense\", False),\n        (100, \"missense\", True),\n        (900, \"missense\", False),\n        (750, \"nonsense\", False),\n        (820, \"missense\", False),\n        (860, \"missense\", True),\n        (1800, \"missense\", False),\n        (790, \"missense\", False),\n        (840, \"missense\", False),\n        (500, \"missense\", False),\n        (1785, \"missense\", True),\n    ]\n\n    def classify_pm1(p, t, b):\n        \"\"\"\n        Applies the decision rules to classify a variant and return its PM1 score.\n        \"\"\"\n        \n        # Rule 1: PM1 applies only to missense variants.\n        if t != \"missense\":\n            return 0\n        \n        # Rule 2: If a benign variant is documented, PM1 is none.\n        if b:\n            return 0\n\n        # Rule 3 (Part 1): Find all overlapping domains.\n        overlapping_domains = []\n        for domain in domains:\n            if domain[\"start\"] = p = domain[\"end\"]:\n                overlapping_domains.append(domain)\n        \n        # If no domain overlaps, return PM1 none (Rule 7).\n        if not overlapping_domains:\n            return 0\n            \n        # Rule 3 (Part 2): Select domain with smallest benign density 'd'.\n        selected_domain = min(overlapping_domains, key=lambda dom: dom['d'])\n\n        # Apply hierarchical scoring rules (Rules 4, 5, 6, 7).\n        is_critical = selected_domain[\"is_critical\"]\n        d = selected_domain[\"d\"]\n        h = selected_domain[\"h\"]\n\n        # Rule 4: PM1 Strong\n        if is_critical and d = 0.5 and h >= 2.0:\n            return 3\n        \n        # Rule 5: PM1 Moderate\n        if is_critical and (d = 1.5 or h >= 1.5):\n            return 2\n        \n        # Rule 6: PM1 Supporting\n        # A domain is 'validated' if it's critical or supportive.\n        # Since all our defined domains are one of these, we just check the 'd' constraint.\n        if d  2.5:\n            return 1\n            \n        # Rule 7: Otherwise, PM1 none.\n        return 0\n\n    results = []\n    for case in test_cases:\n        p_val, t_val, b_val = case\n        score = classify_pm1(p_val, t_val, b_val)\n        results.append(score)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}