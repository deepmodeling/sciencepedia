{
    "hands_on_practices": [
        {
            "introduction": "在分析古DNA样本时，首要任务是确认其真实性。古DNA分子会随着时间的推移而降解，并表现出一种独特的化学损伤模式，其中最典型的是胞嘧啶脱氨导致的C到T的转换，这种转换在DNA片段的末端尤为富集。本练习将引导你超越简单的观察，应用贝叶斯统计模型来量化一个样本究竟是古代的还是现代的证据。通过这种方法，你将学习如何利用DNA损伤模式，在一个严谨的概率框架内做出科学推断。",
            "id": "5011632",
            "problem": "一位研究人员正在评估一个测序文库是源自古脱氧核糖核酸（aDNA）还是现代DNA。评估方法是利用胞嘧啶脱氨的典型损伤模式，这种模式会导致在读段末端附近出现过量的胞嘧啶到胸腺嘧啶以及鸟嘌呤到腺嘌呤的转换。假设在给定位置区间 $i$ 的条件下，每次观察到的与人类参考序列的错配都是一次伯努利试验，其转换概率 $p_i$（转换与颠换之比）未知，并且假设在给定其参数和假说的情况下，各个区间是相互独立的。研究人员根据错配在读段中的位置将其分为三个区间：$b_1$ 是末端碱基，$b_2$ 是距任一末端的第二个碱基，$b_3$ 是内部碱基（距任一末端 $\\geq 5$ 个碱基）。观察到的转换（$t_i$）和颠换（$v_i$）计数如下：\n- $b_1$：$t_1 = 8$, $v_1 = 2$，\n- $b_2$：$t_2 = 6$, $v_2 = 4$，\n- $b_3$：$t_3 = 9$, $v_3 = 11$。\n\n考虑两种假说：\n- 古代（$H_A$）：在每个区间 $i$ 中，转换概率 $p_i$ 服从Beta先验分布 $\\mathrm{Beta}(\\alpha_i^{A}, \\beta_i^{A})$，其参数为 $(\\alpha_1^{A}, \\beta_1^{A}) = (5, 2)$，$(\\alpha_2^{A}, \\beta_2^{A}) = (4, 3)$ 和 $(\\alpha_3^{A}, \\beta_3^{A}) = (2, 4)$。\n- 现代（$H_M$）：在每个区间 $i$ 中，转换概率 $p_i$ 服从Beta先验分布 $\\mathrm{Beta}(\\alpha_i^{M}, \\beta_i^{M})$，其参数为 $(\\alpha_1^{M}, \\beta_1^{M}) = (2, 5)$，$(\\alpha_2^{M}, \\beta_2^{M}) = (3, 4)$ 和 $(\\alpha_3^{M}, \\beta_3^{M}) = (4, 4)$。\n\n设假说的先验概率为 $\\pi_A = 0.2$ 和 $\\pi_M = 0.8$。使用贝叶斯定理，并在其Beta先验下对每个 $p_i$ 进行积分（即，在每个区间中使用Beta-二项边缘似然），计算后验概率 $P(H_A \\mid \\text{data})$。将您的答案四舍五入到五位有效数字，并表示为一个无单位的小数。",
            "solution": "目标是根据观察到的数据，计算“古代”假说 $H_A$ 的后验概率。数据由三个独立区间中的转换（$t_i$）和颠换（$v_i$）计数组成，表示为 $\\text{data} = \\{(t_1, v_1), (t_2, v_2), (t_3, v_3)\\}$。我们使用贝叶斯定理来求 $P(H_A \\mid \\text{data})$：\n$$ P(H_A \\mid \\text{data}) = \\frac{P(\\text{data} \\mid H_A) P(H_A)}{P(\\text{data})} $$\n总证据 $P(\\text{data})$ 由全概率定律给出：\n$$ P(\\text{data}) = P(\\text{data} \\mid H_A) P(H_A) + P(\\text{data} \\mid H_M) P(H_M) $$\n设假说的先验概率为 $\\pi_A = P(H_A) = 0.2$ 和 $\\pi_M = P(H_M) = 0.8$。后验概率可以写成：\n$$ P(H_A \\mid \\text{data}) = \\frac{P(\\text{data} \\mid H_A) \\pi_A}{P(\\text{data} \\mid H_A) \\pi_A + P(\\text{data} \\mid H_M) \\pi_M} $$\n核心任务是计算每种假说下数据的边缘似然 $P(\\text{data} \\mid H_A)$ 和 $P(\\text{data} \\mid H_M)$。由于各个区间是独立的，总边缘似然是每个区间的边缘似然的乘积：\n$$ P(\\text{data} \\mid H_k) = \\prod_{i=1}^{3} P(\\text{data}_i \\mid H_k) \\quad \\text{for } k \\in \\{A, M\\} $$\n对于每个区间 $i$，在 $n_i = t_i + v_i$ 次总错配中出现 $t_i$ 次转换的次数，使用二项似然进行建模，即 $t_i \\mid p_i \\sim \\mathrm{Binomial}(n_i, p_i)$。转换概率 $p_i$ 被赋予一个Beta先验，即 $p_i \\mid H_k \\sim \\mathrm{Beta}(\\alpha_i^k, \\beta_i^k)$。单个区间的边缘似然通过对 $p_i$ 积分得到，其结果是Beta-二项分布的概率质量函数：\n$$ P(\\text{data}_i \\mid H_k) = P(t_i \\mid n_i, \\alpha_i^k, \\beta_i^k) = \\binom{n_i}{t_i} \\frac{\\mathrm{B}(t_i + \\alpha_i^k, n_i - t_i + \\beta_i^k)}{\\mathrm{B}(\\alpha_i^k, \\beta_i^k)} $$\n其中 $\\mathrm{B}(x, y) = \\frac{\\Gamma(x)\\Gamma(y)}{\\Gamma(x+y)}$ 是Beta函数。对于整数参数，这可以用阶乘来计算。一个便于计算的替代公式是：\n$$ P(t_i \\mid n_i, \\alpha_i^k, \\beta_i^k) = \\frac{\\binom{t_i+\\alpha_i^k-1}{t_i} \\binom{n_i-t_i+\\beta_i^k-1}{n_i-t_i}}{\\binom{n_i+\\alpha_i^k+\\beta_i^k-1}{n_i}} $$\n观察到的数据是：\n- 区间 $1$：$t_1=8, v_1=2 \\implies n_1=10$\n- 区间 $2$：$t_2=6, v_2=4 \\implies n_2=10$\n- 区间 $3$：$t_3=9, v_3=11 \\implies n_3=20$\n\n首先，我们计算假说 $H_A$（古代）下的边缘似然。先验参数为 $(\\alpha_1^A, \\beta_1^A) = (5, 2)$，$(\\alpha_2^A, \\beta_2^A) = (4, 3)$ 和 $(\\alpha_3^A, \\beta_3^A) = (2, 4)$。\n- 对于区间 $1$：\n$$ P(\\text{data}_1 \\mid H_A) = \\frac{\\binom{8+5-1}{8} \\binom{10-8+2-1}{10-8}}{\\binom{10+5+2-1}{10}} = \\frac{\\binom{12}{8} \\binom{3}{2}}{\\binom{16}{10}} = \\frac{495 \\cdot 3}{8008} = \\frac{1485}{8008} = \\frac{135}{728} $$\n- 对于区间 $2$：\n$$ P(\\text{data}_2 \\mid H_A) = \\frac{\\binom{6+4-1}{6} \\binom{10-6+3-1}{10-6}}{\\binom{10+4+3-1}{10}} = \\frac{\\binom{9}{6} \\binom{6}{4}}{\\binom{16}{10}} = \\frac{84 \\cdot 15}{8008} = \\frac{1260}{8008} = \\frac{45}{286} $$\n- 对于区间 $3$：\n$$ P(\\text{data}_3 \\mid H_A) = \\frac{\\binom{9+2-1}{9} \\binom{20-9+4-1}{20-9}}{\\binom{20+2+4-1}{20}} = \\frac{\\binom{10}{9} \\binom{14}{11}}{\\binom{25}{20}} = \\frac{10 \\cdot 364}{53130} = \\frac{3640}{53130} = \\frac{364}{5313} $$\n$H_A$ 的总边缘似然为：\n$$ P(\\text{data} \\mid H_A) = \\frac{135}{728} \\cdot \\frac{45}{286} \\cdot \\frac{364}{5313} = \\frac{135 \\cdot 45 \\cdot 364}{728 \\cdot 286 \\cdot 5313} = \\frac{6075}{2 \\cdot 286 \\cdot 5313} = \\frac{6075}{3039036} $$\n接下来，我们计算假说 $H_M$（现代）下的边缘似然。先验参数为 $(\\alpha_1^M, \\beta_1^M) = (2, 5)$，$(\\alpha_2^M, \\beta_2^M) = (3, 4)$ 和 $(\\alpha_3^M, \\beta_3^M) = (4, 4)$。\n- 对于区间 $1$：\n$$ P(\\text{data}_1 \\mid H_M) = \\frac{\\binom{8+2-1}{8} \\binom{10-8+5-1}{10-8}}{\\binom{10+2+5-1}{10}} = \\frac{\\binom{9}{8} \\binom{6}{2}}{\\binom{16}{10}} = \\frac{9 \\cdot 15}{8008} = \\frac{135}{8008} $$\n- 对于区间 $2$：\n$$ P(\\text{data}_2 \\mid H_M) = \\frac{\\binom{6+3-1}{6} \\binom{10-6+4-1}{10-6}}{\\binom{10+3+4-1}{10}} = \\frac{\\binom{8}{6} \\binom{7}{4}}{\\binom{16}{10}} = \\frac{28 \\cdot 35}{8008} = \\frac{980}{8008} = \\frac{35}{286} $$\n- 对于区间 $3$：\n$$ P(\\text{data}_3 \\mid H_M) = \\frac{\\binom{9+4-1}{9} \\binom{20-9+4-1}{20-9}}{\\binom{20+4+4-1}{20}} = \\frac{\\binom{12}{9} \\binom{14}{11}}{\\binom{27}{20}} = \\frac{220 \\cdot 364}{888030} = \\frac{80080}{888030} = \\frac{8008}{88803} $$\n$H_M$ 的总边缘似然为：\n$$ P(\\text{data} \\mid H_M) = \\frac{135}{8008} \\cdot \\frac{35}{286} \\cdot \\frac{8008}{88803} = \\frac{135 \\cdot 35}{286 \\cdot 88803} = \\frac{4725}{25397658} $$\n为了简化最终计算，我们计算贝叶斯因子 $BF_{AM} = \\frac{P(\\text{data} \\mid H_A)}{P(\\text{data} \\mid H_M)}$。\n$$ BF_{AM} = \\frac{6075/3039036}{4725/25397658} = \\frac{6075}{4725} \\cdot \\frac{25397658}{3039036} $$\n似然分量的比率也可以逐项计算：\n$$ BF_{1} = \\frac{P(\\text{data}_1|H_A)}{P(\\text{data}_1|H_M)} = \\frac{1485/8008}{135/8008} = \\frac{1485}{135} = 11 $$\n$$ BF_{2} = \\frac{P(\\text{data}_2|H_A)}{P(\\text{data}_2|H_M)} = \\frac{1260/8008}{980/8008} = \\frac{1260}{980} = \\frac{9}{7} $$\n$$ BF_{3} = \\frac{P(\\text{data}_3|H_A)}{P(\\text{data}_3|H_M)} = \\frac{364/5313}{8008/88803} = \\frac{364}{5313} \\cdot \\frac{88803}{8008} = \\frac{364}{8008} \\cdot \\frac{88803}{5313} = \\frac{1}{22} \\cdot \\frac{117}{7} = \\frac{117}{154} $$\n总贝叶斯因子是乘积：\n$$ BF_{AM} = BF_1 \\cdot BF_2 \\cdot BF_3 = 11 \\cdot \\frac{9}{7} \\cdot \\frac{117}{154} = 11 \\cdot \\frac{9}{7} \\cdot \\frac{117}{11 \\cdot 14} = \\frac{9 \\cdot 117}{7 \\cdot 14} = \\frac{1053}{98} $$\n支持 $H_A$ 相对于 $H_M$ 的后验优势比是贝叶斯因子乘以先验优势比：\n$$ O_{AM} = \\frac{P(H_A \\mid \\text{data})}{P(H_M \\mid \\text{data})} = BF_{AM} \\cdot \\frac{\\pi_A}{\\pi_M} = \\frac{1053}{98} \\cdot \\frac{0.2}{0.8} = \\frac{1053}{98} \\cdot \\frac{1}{4} = \\frac{1053}{392} $$\n最后，我们将后验优势比转换为 $H_A$ 的后验概率：\n$$ P(H_A \\mid \\text{data}) = \\frac{O_{AM}}{1+O_{AM}} = \\frac{1053/392}{1 + 1053/392} = \\frac{1053/392}{(392+1053)/392} = \\frac{1053}{1445} $$\n为了给出最终答案，我们计算其小数值并四舍五入到五位有效数字：\n$$ P(H_A \\mid \\text{data}) = \\frac{1053}{1445} \\approx 0.728719723... $$\n将此值四舍五入到五位有效数字得到 $0.72872$。",
            "answer": "$$\n\\boxed{0.72872}\n$$"
        },
        {
            "introduction": "即使一个样本被证实含有古老的分子，现代DNA的污染仍然是古DNA研究中的一个巨大挑战。污染物会引入与内源性古DNA不一致的遗传信号，导致分析结果混乱。本练习模拟了一个真实的古遗传学研究场景，你将扮演一名遗传侦探的角色。通过整合来自线粒体DNA、核DNA以及DNA损伤模式的多条证据线索，你将学会如何辨别并解决这些冲突的信号，从而对样本的可靠性做出明智的判断。",
            "id": "5011615",
            "problem": "一个旧石器时代晚期的骨骼样本，使用标准的古DNA实验方案进行了测序。线粒体DNA（mtDNA）的平均覆盖深度约为$100\\times$，核DNA的覆盖深度约为$0.8\\times$。通过末端胞嘧啶到胸腺嘧啶的错配分数来评估死后损伤（PMD）。从许多研究中可知，真正的古老分子中典型的PMD分数相对于现代污染显著升高；对于此样本，你可以将末端位置的特征性损伤概率近似视为 $\\delta_{\\text{ancient}} \\approx 0.20$（古代）和 $\\delta_{\\text{modern}} \\approx 0.01$（现代）。\n\n对定义单倍群的mtDNA位点进行了探查。支持单倍群U诊断性等位基因的测序读段总数为 $N_U = 1700$，其中 $k_U = 425$ 个显示出末端PMD；而支持单倍群H诊断性等位基因的测序读段总数为 $N_H = 1000$，其中 $k_H = 10$ 个显示出末端PMD。在未进行损伤筛选的情况下构建的mtDNA共有序列判定为单倍群H，因为在整个位点集合中，诊断性位点上有更多的总读段支持与H相容的替换。\n\n独立的核DNA污染通过以下方式进行估计。遗传性别鉴定表明该个体为男性（$XY$），且根据X染色体表观杂合性得出的核DNA污染估计值为 $\\hat{c}_{\\text{nuc}} = 0.03$，其95%置信区间为 $[0.01, 0.05]$。你可以假设污染分子主要是现代的，并且相对于内源性古老分子，其PMD水平没有升高。\n\n仅从以下基本原理出发：\n- mtDNA是克隆式母系遗传，单个个体应只携带一个mtDNA单倍群；在定义位点上出现不一致的单倍群信号意味着混合。\n- 古老分子相对于现代污染表现出更高的PMD。\n- 对于男性个体，X染色体上的杂合性主要源于污染，因为其内源性X染色体是半合子的。\n- 污染的作用相当于混合：观察到的等位基因频率反映了 $(1 - c) \\times$ 内源性贡献加上 $c \\times$ 污染贡献。\n\n使用第一性原理推理来调和不一致的mtDNA单倍群信号，并决定是否应将该样本从下游的群体遗传学分析中排除。选择唯一的最佳选项。\n\nA. 接受未经过损伤筛选的mtDNA共有序列为单倍群H，并将样本纳入所有下游分析，因为核DNA污染估计值 $\\hat{c}_{\\text{nuc}}$ 低于0.05。\n\nB. 根据损伤模式推断单倍群U代表内源性mtDNA，将支持单倍群H的读段视为现代污染，并保留该个体用于核DNA分析（最好使用经过PMD筛选的读段）。在报告前，使用富含损伤的分子排除或重新确定mtDNA单倍群。\n\nC. 将样本完全从所有分析中排除，因为mtDNA显示出污染证据，这使得mtDNA和核DNA信号均无效。\n\nD. 将单倍群U和H之间的不一致解释为个体内的异质性，并将两个mtDNA单倍群及所有核数据都纳入下游分析，不进行特殊筛选。",
            "solution": "在尝试解答之前，必须先确定问题陈述的有效性。\n\n**步骤1：提取已知信息**\n问题提供了以下数据和原则：\n- 样本类型：旧石器时代晚期骨骼样本。\n- mtDNA覆盖度：$\\approx 100\\times$。\n- 核DNA覆盖度：$\\approx 0.8\\times$。\n- 古DNA末端位置的特征性PMD概率：$\\delta_{\\text{ancient}} \\approx 0.20$。\n- 现代DNA末端位置的特征性PMD概率：$\\delta_{\\text{modern}} \\approx 0.01$。\n- 支持单倍群U等位基因的读段数：$N_U = 1700$。\n- 具有末端PMD的支持U的读段数：$k_U = 425$。\n- 支持单倍群H等位基因的读段数：$N_H = 1000$。\n- 具有末端PMD的支持H的读段数：$k_H = 10$。\n- 未筛选的mtDNA共有序列单倍群：H。\n- 个体遗传性别：男性 ($XY$)。\n- 核DNA污染估计值：$\\hat{c}_{\\text{nuc}} = 0.03$。\n- $\\hat{c}_{\\text{nuc}}$ 的95%置信区间：$[0.01, 0.05]$。\n\n提供的核心原则：\n1.  个体携带单一的、克隆式遗传的mtDNA单倍群。混合意味着污染。\n2.  古DNA相对于现代DNA表现出更高的死后损伤（PMD）。\n3.  对于男性（$XY$），X染色体上的杂合性表明存在污染。\n4.  观察到的等位基因频率是内源性和污染源的混合。\n\n**步骤2：使用提取的已知信息进行验证**\n问题陈述具有科学依据，表述清晰且客观。它基于古基因组学领域的既定原则和标准方法。提供的测序覆盖度、PMD率和污染水平的定量值对于古DNA研究是现实的。问题内部逻辑一致，呈现了一个典型的数据信号冲突场景（mtDNA单倍群混合），需要通过逻辑应用所提供的原则和数据（PMD模式，独立的核DNA污染估计）来解决。该问题不违反任何基本科学定律，不基于错误的前提，没有歧义，并提出了一个有意义的推理挑战。\n\n**步骤3：结论与行动**\n问题陈述有效。将推导解答。\n\n**推导过程**\n\n核心问题是存在支持两种不同线粒体DNA（mtDNA）单倍群（U和H）的读段。根据提供的第一个原则，单个个体应只拥有一个mtDNA单倍群。因此，观察到两个单倍群是来自至少两个不同个体的DNA混合的有力证据。问题要求我们确定这种混合的来源——具体来说，哪个信号是内源于古代样本的，哪个是来自污染的。\n\n第二个原则指出，古老分子相对于现代污染表现出更高的PMD。我们已知末端胞嘧啶到胸腺嘧啶错配的特征概率：对于古DNA，$\\delta_{\\text{ancient}} \\approx 0.20$；对于现代DNA，$\\delta_{\\text{modern}} \\approx 0.01$。我们可以为支持每个单倍群的读段计算经验性PMD分数。\n\n对于支持单倍群U等位基因的读段：\n- 总读段数：$N_U = 1700$。\n- 具有末端PMD的读段数：$k_U = 425$。\n- 经验性PMD分数为 $\\hat{\\delta}_U = \\frac{k_U}{N_U} = \\frac{425}{1700} = 0.25$。\n\n对于支持单倍群H等位基因的读段：\n- 总读段数：$N_H = 1000$。\n- 具有末端PMD的读段数：$k_H = 10$。\n- 经验性PMD分数为 $\\hat{\\delta}_H = \\frac{k_H}{N_H} = \\frac{10}{1000} = 0.01$。\n\n现在我们将这些经验分数与特征概率进行比较：\n- 支持U的读段的PMD分数 $\\hat{\\delta}_U = 0.25$ 与古DNA的预期值 $\\delta_{\\text{ancient}} \\approx 0.20$ 高度一致。\n- 支持H的读段的PMD分数 $\\hat{\\delta}_H = 0.01$ 与现代DNA的预期值 $\\delta_{\\text{modern}} = 0.01$ 完全相同。\n\n该分析提供了压倒性的证据，表明单倍群U信号源于内源性的古代个体，而单倍群H信号源于现代污染。因此，未经过损伤筛选的mtDNA共有序列判定为单倍群H是这种污染造成的人为假象，并且是错误的。\n\n接下来，我们考虑核DNA。问题提供了一个独立的核DNA污染估计值，$\\hat{c}_{\\text{nuc}} = 0.03$（即$3\\%$），该值是根据此男性个体X染色体上的表观杂合性推导出来的。这是一种标准且可靠的方法。3%的污染水平被认为是低的，并且对于下游的群体遗传学分析通常是可以接受的，特别是对于来自旧石器时代晚期的稀有而珍贵的样本。mtDNA污染的存在不会自动使核DNA分析无效；事实上，由于两种基因组的拷贝数差异巨大，mtDNA的污染水平与核DNA的污染水平不同（且通常更高）是很常见的。\n\n适当的做法是根据PMD证据修正mtDNA单倍群的判定，并在考虑已量化的低水平污染的情况下，继续进行核基因组的分析。\n\n**逐项分析**\n\nA. 接受未经过损伤筛选的mtDNA共有序列为单倍群H，并将样本纳入所有下游分析，因为核DNA污染估计值 $\\hat{c}_{\\text{nuc}}$ 低于0.05。\n这个选项存在根本性缺陷。它忽略了明确将单倍群H信号识别为现代污染的强有力PMD证据。接受未筛选的共有序列判定是不严谨的科学实践。低的核DNA污染估计值证明了使用核数据的合理性，而不是接受一个明显错误的mtDNA结果。\n**结论：错误。**\n\nB. 根据损伤模式推断单倍群U代表内源性mtDNA，将支持单倍群H的读段视为现代污染，并保留该个体用于核DNA分析（最好使用经过PMD筛选的读段）。在报告前，使用富含损伤的分子排除或重新确定mtDNA单倍群。\n这个选项与我们的推导完全一致。它正确地使用PMD将单倍群U识别为内源性，将H识别为污染。它正确地得出结论：核DNA的污染率低且已量化（$\\hat{c}_{\\text{nuc}} = 0.03$），具有价值，应保留用于分析。建议对核分析使用经过PMD筛选的读段，并使用损伤阳性的读段重新评估mtDNA单倍群，这两种做法都是古基因组学中减轻污染的标准最佳实践。\n**结论：正确。**\n\nC. 将样本完全从所有分析中排除，因为mtDNA显示出污染证据，这使得mtDNA和核DNA信号均无效。\n这个选项过于保守，显示出对古DNA数据分析的误解。虽然mtDNA信号受到污染，但核DNA的污染已被独立量化为较低水平（$3\\%$）。有多种方法可以处理这类数据，不必要地丢弃一个稀有的旧石器时代晚期基因组将是重大损失。部分数据（mtDNA）的污染不会自动使所有其他部分（核DNA）失效，特别是当污染可以被表征和减轻时。\n**结论：错误。**\n\nD. 将单倍群U和H之间的不一致解释为个体内的异质性，并将两个mtDNA单倍群及所有核数据都纳入下游分析，不进行特殊筛选。\n这个选项提出了一个生物学上难以置信的解释。涉及两个系统发育上距离遥远的单倍群（U和H）并以高比例（在这个子集中，支持H的读段占总数的 $\\frac{1000}{1700+1000} \\approx 37\\%$）共存的异质性，并非已知的生物学现象。真正的异质性通常是微小的变异。至关重要的是，这种解释完全忽略了PMD模式的显著差异。如果这真的是异质性，那么两个mtDNA谱系都应该同样古老，并应表现出相似的高PMD率。数据明确驳斥了这一点。\n**结论：错误。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "古DNA研究的一个核心限制是测序覆盖度通常很低，这意味着基因组上的每个位点平均只被少数几个DNA片段覆盖。这种数据的稀疏性给准确判断个体在特定位点是纯合子还是杂合子带来了巨大挑战。在本练习中，你将通过推导一个数学表达式来精确计算在低覆盖度下将杂合子误判为纯合子的错误率。这能帮助你从根本上理解为什么在群体遗传学分析中，研究人员通常倾向于使用“伪单倍体”分型策略，以避免系统性偏差。",
            "id": "5011595",
            "problem": "古脱氧核糖核酸 (aDNA) 研究常常面临单个基因组位点测序覆盖度低的问题，这对二倍体基因型推断构成了挑战。考虑一个在古人类基因组中确实为杂合的单一双等位基因座。假设覆盖该基因座的 $c$ 个独立测序读段中的每一个都以相等的概率 $1/2$ 抽样到两个等位基因中的一个，并且读段错误和比对偏好可以忽略不计，因此每个读段报告任一等位基因的概率恰好是 $1/2$。一种标准的杂合子检测规则是，如果观测到的次要等位基因频率位于区间 $\\left[\\tau, 1 - \\tau\\right]$ 内（其中 $0  \\tau \\leq \\frac{1}{2}$），则将该位点判定为杂合；否则，将其判定为纯合。等价地，如果 $X$ 是支持某个任意标记的等位基因的读段数，则仅当 $X \\in \\{t, t+1, \\dots, c - t\\}$ 时，该位点才被判定为杂合，其中 $t = \\lceil \\tau c \\rceil$ 是所需的最小次要等位基因计数。\n\n从二项抽样模型和上述决策规则的定义出发，推导一个以 $c$ 和 $\\tau$ 表示的闭式表达式，用于表示预期错误率，该错误率定义为根据此规则将一个真正的杂合位点错误地判定为纯合的概率。将你的最终答案表示为仅包含 $c$ 和 $\\tau$ 的单个解析表达式。不需要进行数值评估。\n\n然后，使用推导出的表达式并从第一性原理出发进行推理，解释为什么在低覆盖度的古基因组中，对于下游群体遗传学分析，首选伪单倍体判定。你的解释必须基于在上述二倍体判定规则下，低 $c$ 值对杂合子错分概率的影响。不应引入除推导出的表达式之外的任何其他公式。",
            "solution": "问题陈述已经过验证，被认为是合理的。这是一个定义明确的统计遗传学问题，基于概率论原理及其在基因组学中的应用。所有术语都得到了清晰的定义，并且前提条件是一致的。\n\n该问题要求分两部分作答：首先，推导一个真正的杂合位点被错误判定为纯合的概率的闭式表达式；其次，基于该表达式解释在低覆盖度古DNA (aDNA) 研究中使用伪单倍体判定的理由。\n\n设真正的杂合位点的两个等位基因为 $A_1$ 和 $A_2$。我们已知有 $c$ 个独立的测序读段覆盖此位点。对于每个读段，抽样到等位基因 $A_1$ 的概率为 $1/2$，抽样到等位基因 $A_2$ 的概率也为 $1/2$，因为错误和偏好被视为可以忽略不计。\n\n设 $X$ 为表示支持等位基因 $A_1$ 的读段数的随机变量。剩下的 $c-X$ 个读段将支持等位基因 $A_2$。在给定的假设下，$X$ 服从试验次数为 $c$、成功概率为 $p=1/2$ 的二项分布。$X$ 的概率质量函数 (PMF) 由下式给出：\n$$P(X=k) = \\binom{c}{k} \\left(\\frac{1}{2}\\right)^k \\left(1-\\frac{1}{2}\\right)^{c-k} = \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n对于 $k \\in \\{0, 1, 2, \\dots, c\\}$。\n\n决策规则规定，如果支持一个等位基因的读段数 $X$ 落在范围 $\\{t, t+1, \\dots, c-t\\}$ 内（其中 $t = \\lceil \\tau c \\rceil$），则该位点被判定为杂合。参数 $\\tau$ 是最小次要等位基因频率阈值，满足 $0  \\tau \\leq 1/2$。\n\n如问题所定义，当一个真正的杂合位点被错误地判定为纯合时，就会发生错误。这种情况发生在不满足杂合子判定条件时。因此，错判事件对应于 $X$ 落在指定范围之外。导致纯合判定的 $X$ 的结果集合是 $\\{0, 1, \\dots, t-1\\} \\cup \\{c-t+1, c-t+2, \\dots, c\\}$。\n\n我们将此错误事件的概率记为 $P(\\text{error})$，它是这些结果的概率之和：\n$$P(\\text{error}) = P(X \\leq t-1) + P(X \\geq c-t+1)$$\n我们可以将这些概率表示为概率质量函数的和：\n$$P(\\text{error}) = \\sum_{k=0}^{t-1} P(X=k) + \\sum_{k=c-t+1}^{c} P(X=k)$$\n代入二项分布的概率质量函数：\n$$P(\\text{error}) = \\sum_{k=0}^{t-1} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c + \\sum_{k=c-t+1}^{c} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n当 $p=1/2$ 时，二项分布是对称的，这意味着 $P(X=k) = P(X=c-k)$，因为 $\\binom{c}{k} = \\binom{c}{c-k}$。我们可以证明这两个和的对称性。让我们在第二个和中进行换元。设 $j = c-k$。当 $k$ 从 $c-t+1$ 到 $c$ 时，新下标 $j$ 从 $c-(c-t+1) = t-1$ 降到 $c-c = 0$。\n$$\\sum_{k=c-t+1}^{c} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c = \\sum_{j=0}^{t-1} \\binom{c}{c-j} \\left(\\frac{1}{2}\\right)^c = \\sum_{j=0}^{t-1} \\binom{c}{j} \\left(\\frac{1}{2}\\right)^c$$\n这表明第二个和等于第一个和，即 $P(X \\geq c-t+1) = P(X \\leq t-1)$。\n因此，总错误概率可以简化为：\n$$P(\\text{error}) = 2 \\times P(X \\leq t-1) = 2 \\sum_{k=0}^{t-1} \\binom{c}{k} \\left(\\frac{1}{2}\\right)^c$$\n我们可以将常数项 $(1/2)^c$ 从求和中提取出来：\n$$P(\\text{error}) = 2 \\left(\\frac{1}{2}\\right)^c \\sum_{k=0}^{t-1} \\binom{c}{k} = 2^{1-c} \\sum_{k=0}^{t-1} \\binom{c}{k}$$\n用 $c$ 和 $\\tau$ 的定义替换 $t$，我们得到错误率的最终闭式表达式：\n$$P(\\text{error}) = 2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}$$\n这个表达式代表观察到次要等位基因读段数小于阈值 $t$ 的概率，再乘以2，以考虑两种等位基因都可能成为次要等位基因的情况。\n\n对于任务的第二部分，我们必须使用这个表达式来解释在低覆盖度 aDNA 中首选伪单倍体判定的原因。\n\n在 aDNA 研究中，低覆盖度意味着覆盖任何给定基因组位点的读段数 $c$ 很小。推导出的表达式 $P(\\text{error}) = 2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}$ 揭示了小 $c$ 值的后果。该求和项代表了二项抽样分布极端尾部的累积概率。当 $c$ 很小时，随机抽样方差很大。这意味着即使在一个真正的杂合位点，也很有可能随机抽样到的读段仅代表两种等位基因中的一种（例如，$X=0$ 或 $X=c$），或者两种等位基因的比例高度倾斜。\n\n二倍体判定规则要求观察到最小的次要等位基因计数 $t = \\lceil \\tau c \\rceil$。对于低 $c$ 值，很难满足这个标准。例如，如果覆盖度 $c=2$ 且阈值为 $\\tau=1/3$，则 $t = \\lceil 2/3 \\rceil = 1$。如果 $X=0$ 或 $X=2$，该位点就被判定为纯合。错误概率是 $P(\\text{error}) = 2^{1-2}\\sum_{k=0}^{0} \\binom{2}{k} = (1/2)\\binom{2}{0} = 1/2$。$50\\%$ 的错误率是极高的。如果覆盖度为 $c=1$，则不可能满足任何次要等位基因阈值 $t \\ge 1$，因此错误率为 $1$，意味着所有杂合子都被错误判定。\n\n推导出的表达式将这种直觉形式化：对于小的 $c$ 值，求和项 $\\sum_{k=0}^{t-1} \\binom{c}{k}$ 与前因子 $2^{1-c}$ 相结合，会导致 $P(\\text{error})$ 的值很大。这种将真正的杂合子系统性地错分为纯合子的情况，会给下游分析带来严重的偏见。它会导致对杂合度和遗传多样性的显著低估，进而使对群体分化、亲缘关系和其他关键群体遗传学统计量的估计产生偏见。\n\n伪单倍体判定是减轻这种偏见的一种策略。该方法不是试图进行二倍体基因型判定（这在低覆盖度下极易出错），而是在每个位点随机选择一个读段来代表等位基因。在一个真正的杂合位点，此过程以各 $1/2$ 的概率正确地抽样到两个等位基因中的一个。虽然这种方法舍弃了关于个体在特定位点杂合性的信息，但它提供了来自该个体基因组的无偏等位基因样本。当来自许多位点或许多个体的数据被汇总时，得到的等位基因频率不会系统性地偏向纯合性。这使得数据对于群体水平的推断更为可靠，因为在群体水平上，准确的等位基因频率估计比准确的个体二倍体基因分型更为关键。因此，由我们推导的表达式所量化的、在低 $c$ 值下的高杂合子错分概率，是为低覆盖度 aDNA 研究首选偏差较小的伪单倍体方法的根本原因。",
            "answer": "$$\n\\boxed{2^{1-c} \\sum_{k=0}^{\\lceil \\tau c \\rceil - 1} \\binom{c}{k}}\n$$"
        }
    ]
}