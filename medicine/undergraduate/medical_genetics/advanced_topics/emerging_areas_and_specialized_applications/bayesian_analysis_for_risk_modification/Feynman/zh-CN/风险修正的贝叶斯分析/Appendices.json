{
    "hands_on_practices": [
        {
            "introduction": "我们从一个遗传咨询中的经典问题开始。这个练习通过一个常染色体隐性遗传病的家族案例，帮助你理解如何利用新的临床观察信息（即一个孩子表型正常）来更新其基因型（即携带者）的概率 。这不仅是孟德尔遗传定律的直接应用，也是贝叶斯思维方式的一个直观体现。",
            "id": "5016302",
            "problem": "在一个家庭中，一种常染色体隐性遗传病由单个基因座上的致病等位基因 $a$ 引起，具有完全外显率且无新生突变。设正常等位基因为 $A$。父母双方临床表型均正常。该家庭有一个患病的孩子（先证者），以及另一个经临床确认未患病的孩子（同胞）。在常染色体隐性遗传模式下，以父母双方均为杂合子携带者 $Aa$ 为条件，其后代的基因型分布遵循经过充分检验的孟德尔分离比：$AA$ 的概率为 $1/4$，$Aa$ 的概率为 $1/2$，$aa$ 的概率为 $1/4$。假设在父母基因型已知的条件下，同胞之间是独立的，并且在所述假设下，表型完全由基因型决定。\n\n使用贝叶斯定理和隐性遗传模型，并明确考虑由观察到患病先证者和未患病父母所推断出的同胞基因型分布，计算该未患病同胞是杂合子携带者 $Aa$ 的后验概率。将最终答案表示为一个精确的分数。无需四舍五入。",
            "solution": "题目要求计算，在一个常染色体隐性遗传病家庭中，已知家庭史的情况下，一个患病个体的未患病同胞是杂合子携带者的后验概率。解答需要严格应用孟德尔遗传学和条件概率，特别是贝叶斯定理。\n\n首先，我们必须确定父母的基因型。该疾病是常染色体隐性遗传，由致病等位基因 $a$ 引起。正常等位基因为 $A$。可能的基因型及其对应的表型如下：\n- $AA$：临床表型正常。\n- $Aa$：临床表型正常（杂合子携带者）。\n- $aa$：临床表型患病。\n\n题目说明父母临床表型正常，但有一个患病的孩子。\n1.  患病孩子的基因型必须是 $aa$。\n2.  要想基因型为 $aa$，孩子必须从父母双方各遗传一个 $a$ 等位基因。\n3.  由于父母双方临床表型都正常，他们的基因型不可能是 $aa$。\n4.  两个表型正常的父母各自提供一个 $a$ 等位基因的唯一可能是，他们都是基因型为 $Aa$ 的杂合子携带者。\n\n因此，父母的杂交组合被明确确定为 $Aa \\times Aa$。题目陈述通过提及计算是“以父母双方均为杂合子携带者 $Aa$ 为条件”来证实了这一前提。\n\n根据孟德尔分离定律，对于 $Aa \\times Aa$ 的杂交，任何一个后代的基因型的先验概率为：\n-   $P(\\text{genotype} = AA) = \\frac{1}{4}$\n-   $P(\\text{genotype} = Aa) = \\frac{1}{2}$\n-   $P(\\text{genotype} = aa) = \\frac{1}{4}$\n\n题目要求计算在同胞临床表型正常的条件下，该同胞是杂合子携带者（$Aa$）的概率。让我们定义与该同胞相关的事件：\n-   设 $C$ 为该同胞是杂合子携带者（基因型为 $Aa$）的事件。\n-   设 $U$ 为该同胞临床表型正常的事件。\n\n我们需要计算条件概率 $P(C | U)$。\n\n题目说明“在父母基因型已知的条件下，同胞之间是独立的”。一旦父母的基因型确定为 $Aa \\times Aa$，先证者的基因型就不再为该同胞的基因型提供任何额外信息。该同胞的基因型是从 $Aa \\times Aa$ 杂交后代的概率分布中进行的一次独立抽样。\n\n我们可以应用贝叶斯定理，或者更直接地，使用条件概率的定义：\n$$P(C | U) = \\frac{P(C \\cap U)}{P(U)}$$\n\n让我们计算这个公式中的各项概率。\n\n分子 $P(C \\cap U)$ 是该同胞既是携带者又表型正常的概率。对于具有完全外显率的常染色体隐性遗传病，杂合子携带者（$Aa$）根据定义是临床表型正常的。因此，事件 $C$ 是事件 $U$ 的一个子集，它们的交集 $C \\cap U$ 就是事件 $C$ 本身。\n所以，分子的概率就是该同胞是携带者的先验概率：\n$$P(C \\cap U) = P(C) = P(\\text{genotype} = Aa) = \\frac{1}{2}$$\n\n分母 $P(U)$ 是该同胞临床表型正常的概率。如果一个个体的基因型是 $AA$ 或 $Aa$，那么他/她是表型正常的。这两个是互斥事件。\n$$P(U) = P(\\text{genotype} = AA \\text{ or genotype} = Aa) = P(\\text{genotype} = AA) + P(\\text{genotype} = Aa)$$\n代入孟德尔概率：\n$$P(U) = \\frac{1}{4} + \\frac{1}{2} = \\frac{3}{4}$$\n\n现在我们可以通过代入分子和分母的值来计算所求的后验概率：\n$$P(C | U) = \\frac{P(C)}{P(U)} = \\frac{\\frac{1}{2}}{\\frac{3}{4}}$$\n$$P(C | U) = \\frac{1}{2} \\times \\frac{4}{3} = \\frac{4}{6} = \\frac{2}{3}$$\n\n因此，该未患病同胞是杂合子携带者的后验概率是 $\\frac{2}{3}$。关于患病先证者的信息对于确定父母基因型为 $Aa \\times Aa$ 是至关重要的，但由于条件独立性，在此之外它并不改变该同胞的概率。对于未患病的同胞，其样本空间被限制在基因型 $\\{AA, Aa\\}$ 内，其先验概率之比为 $1/4 : 1/2$，即 $1:2$。将这些概率归一化后，得到基因型为 $AA$ 的概率是 $1/3$，基因型为 $Aa$ 的概率是 $2/3$。",
            "answer": "$$\\boxed{\\frac{2}{3}}$$"
        },
        {
            "introduction": "在掌握了基本原理之后，我们将转向一个更具临床实用性的场景。这个练习将介绍如何使用一个强大的工具——阳性似然比（positive likelihood ratio, LR$+$）——来量化一项检测结果对疾病风险的改变 。通过这个练习，你将学会使用贝叶斯定理的赔率（odds）形式，这是在临床实践中快速更新概率的常用方法。",
            "id": "5016304",
            "problem": "一位患者因一种常染色体显性遗传的单基因病在医学遗传学诊所接受评估。根据详细的家族史和经祖源校正的患病率数据，临床医生评估该患者在相关基因中携带致病性变异的先验概率为 $\\Pr(D)=0.02$，其中 $D$ 表示该患者是携带者的事件。该诊所使用一种标准化的风险预测分析，该分析将患者分为阳性或阴性，对于存在致病性变异的情况，其经过验证的阳性似然比（LR$+$）为 $\\text{LR}+=15$。其假设是，在给定真实携带者状态的条件下，该分析结果与用于设定先验概率的其他临床信息是独立的。\n\n患者的分析结果为阳性。使用应用于临床风险修正的条件概率和贝叶斯定理的基本定义，计算在这次阳性检测后该患者是携带者的后验概率 $\\Pr(D \\mid +)$。请以精确分数的形式给出你的最终数值答案。在你的推导过程中，请用一句话简要说明所得概率的临床意义。",
            "solution": "该问题要求计算后验概率 $\\Pr(D \\mid +)$，即在获得阳性检测结果（$+$）这一证据的条件下，事件 $D$（患者是携带者）发生的概率。这是贝叶斯定理在更新信念方面的直接应用。问题提供了事件的先验概率 $\\Pr(D) = 0.02$ 和检测的阳性似然比 $\\text{LR}+ = 15$。\n\n解决这个问题的最有效方法是使用贝叶斯定理的比值形式。一个事件的比值定义为该事件发生的概率与该事件不发生的概率之比。患者是携带者的先验比值，记作 $\\text{Odds}(D)$，由先验概率 $\\Pr(D)$ 计算得出：\n$$\n\\text{Odds}(D) = \\frac{\\Pr(D)}{1 - \\Pr(D)}\n$$\n我们已知 $\\Pr(D) = 0.02$。因此，患者不是携带者的概率 $\\Pr(D^c)$ 为 $1 - \\Pr(D) = 1 - 0.02 = 0.98$。先验比值为：\n$$\n\\text{Odds}(D) = \\frac{0.02}{0.98} = \\frac{2}{98} = \\frac{1}{49}\n$$\n阳性似然比 $\\text{LR}+$ 定义为携带者中出现阳性检测结果的概率与非携带者中出现阳性检测结果的概率之比：\n$$\n\\text{LR}+ = \\frac{\\Pr(+ \\mid D)}{\\Pr(+ \\mid D^c)}\n$$\n已知 $\\text{LR}+ = 15$。\n\n贝叶斯定理的比值形式表明，后验比值是先验比值与似然比的乘积：\n$$\n\\text{Odds}(D \\mid +) = \\text{Odds}(D) \\times \\text{LR}+\n$$\n此处，$\\text{Odds}(D \\mid +)$ 表示在收到阳性检测结果后，该患者是携带者的比值。将已知值代入此方程：\n$$\n\\text{Odds}(D \\mid +) = \\frac{1}{49} \\times 15 = \\frac{15}{49}\n$$\n我们需要计算的量是后验概率 $\\Pr(D \\mid +)$。我们可以使用将概率 $p$ 与其对应的比值 $O$ 相关联的公式，将后验比值转换回概率：\n$$\np = \\frac{O}{1 + O}\n$$\n将此公式应用于我们的后验比值：\n$$\n\\Pr(D \\mid +) = \\frac{\\text{Odds}(D \\mid +)}{1 + \\text{Odds}(D \\mid +)} = \\frac{\\frac{15}{49}}{1 + \\frac{15}{49}}\n$$\n为了简化这个繁分数，我们可以为主分数分母中的各项找到一个通分母：\n$$\n\\Pr(D \\mid +) = \\frac{\\frac{15}{49}}{\\frac{49}{49} + \\frac{15}{49}} = \\frac{\\frac{15}{49}}{\\frac{49 + 15}{49}} = \\frac{\\frac{15}{49}}{\\frac{64}{49}}\n$$\n将主分数的分子和分母中的公分母 $49$ 消去，得到最终结果：\n$$\n\\Pr(D \\mid +) = \\frac{15}{64}\n$$\n在临床上，这个 $\\frac{15}{64}$（约 $23.4\\%$）的后验概率代表，在结合了阳性分析结果的证据后，患者携带致病性变异的个人风险从最初的 $2\\%$ 大幅增加。",
            "answer": "$$\\boxed{\\frac{15}{64}}$$"
        },
        {
            "introduction": "最后的练习将展示贝叶斯分析在现代基因组学中的综合应用能力。我们将学习如何整合来自不同独立来源的证据——包括连锁分析的LOD分数和新发突变（de novo mutation）状态——来共同评估一个基因变异的致病性 。这个案例模拟了临床遗传学家在解读基因变异时所遵循的真实分析过程，突显了贝叶斯框架在处理复杂证据时的强大功能。",
            "id": "5016299",
            "problem": "在一个患病的先证者中发现了一个常染色体显性遗传病基因中的罕见错义变异，而其父母均未患病。您需要将两条独立的遗传学证据——在一个扩大家系中的共分离情况和该先证者变异已确认的新发（de novo）状态——整合到单个贝叶斯分析中，以更新该变异为致病的概率。\n\n使用以下有科学依据的出发点。\n\n1. 赔率形式的贝叶斯定理：后验赔率等于先验赔率乘以组合似然比，其中独立的证据以乘法方式贡献于总似然比。\n2. 在连锁和共分离分析中，赔率对数（LOD）得分的定义：LOD得分是在致病模型与良性模型下，观测到的家系数据的似然比的以$10$为底的对数。\n3. 一个新发（de novo）事件可以被视为一个概率性观测，其证据权重是在致病假设下其概率与在良性假设下其概率的比值。\n\n本案例的数据和假设：\n\n- 该基因中一个罕见的错义变异真正致病的基线（证据前）概率为 $P_{0} = 0.02$。\n- 在一个独立于先证者三联体构建的扩大家系中进行的共分离分析，得出与疾病共分離的LOD得分为 $\\mathrm{LOD}_{\\mathrm{seg}} = 1.0$。\n- 先证者的变异被确认为新发（de novo），其生物学父母均可及且未患病。对于该基因和表型，在受影响的个体中，真正致病的变异以新发形式出现的比例为 $\\alpha = 0.05$（这反映了新发致病变异在这种疾病中的实际贡献）。在良性模型下，该基因特异性的每个三联体出现新发错义变异的概率为 $\\mu = 2.0 \\times 10^{-5}$。\n- 假设外显率足够高，使得 $\\alpha$ 恰当地代表了在致病模型下受影响个体中新发表现的概率，并且共分离证据和新发证据流在给定变异致病性状态的条件下是条件独立的。\n\n通过整合这些证据，计算该变异为致病的后验概率。然后，使用广泛采用的美国医学遗传学与基因组学学会（ACMG）的贝叶斯解释阈值，其中“致病”对应于后验概率 $\\geq 0.99$，“可能致病”对应于后验概率 $\\geq 0.90$，确定满足哪个阈值。仅报告后验概率，以小数形式表示，并四舍五入至四位有效数字。不要包含百分号。",
            "solution": "该问题要求在给定两条独立证据（一个扩大家系中的共分离以及在一个患病先证者中确认的新发出现）的情况下，计算一个罕见错义变异为致病的后验概率。我们将使用赔率形式的贝叶斯定理来整合这些证据。\n\n设 $H_P$ 为变异是致病的假设， $H_B$ 为变异是良性（非致病）的假设。\n\n首先，我们确定致病性的先验赔率。该基因中一个罕见错义变异是致病的基线概率为 $P(H_P) = P_0 = 0.02$。因此，其为良性的概率是 $P(H_B) = 1 - P(H_P) = 1 - 0.02 = 0.98$。支持致病性的先验赔率是这些概率的比值：\n$$\n\\text{先验赔率} = \\frac{P(H_P)}{P(H_B)} = \\frac{0.02}{0.98} = \\frac{2}{98} = \\frac{1}{49}\n$$\n\n接下来，我们计算每条证据的似然比（LR）。假设在给定致病性状态的条件下证据是条件独立的，总似然比是各个似然比的乘积：$LR_{\\text{total}} = LR_{\\text{seg}} \\times LR_{\\text{de novo}}$。\n\n第一条证据来自共分离分析，其得出的赔率对数（LOD）得分为 $LOD_{\\text{seg}} = 1.0$。LOD得分定义为似然比的以$10$为底的对数，即 $LOD = \\log_{10}(LR)$。因此，我们可以通过指数运算求出共分离的似然比 $LR_{\\text{seg}}$：\n$$\nLR_{\\text{seg}} = 10^{LOD_{\\text{seg}}} = 10^{1.0} = 10\n$$\n\n第二条证据是该变异在患病先证者（其父母未患病）中的确认新发状态。对于此观测的似然比 $LR_{\\text{de novo}}$，是在致病假设下观测到新发事件的概率与在良性假设下观测到该事件的概率之比。\n$$\nLR_{\\text{de novo}} = \\frac{P(\\text{de novo} | H_P)}{P(\\text{de novo} | H_B)}\n$$\n问题提供了必要的值：\n- 真正致病的变异以新发形式出现的比例为 $P(\\text{de novo} | H_P) = \\alpha = 0.05$。\n- 在良性模型下，每个三联体出现新发错义变异的概率为 $P(\\text{de novo} | H_B) = \\mu = 2.0 \\times 10^{-5}$。\n\n代入这些值，我们计算 $LR_{\\text{de novo}}$：\n$$\nLR_{\\text{de novo}} = \\frac{0.05}{2.0 \\times 10^{-5}} = \\frac{5 \\times 10^{-2}}{2 \\times 10^{-5}} = 2.5 \\times 10^3 = 2500\n$$\n\n现在，我们可以通过将各个LR相乘来计算总似然比：\n$$\nLR_{\\text{total}} = LR_{\\text{seg}} \\times LR_{\\text{de novo}} = 10 \\times 2500 = 25000\n$$\n\n有了先验赔率和总似然比，我们可以使用赔率形式的贝叶斯定理计算致病性的后验赔率：\n$$\n\\text{后验赔率} = \\text{先验赔率} \\times LR_{\\text{total}} = \\frac{1}{49} \\times 25000 = \\frac{25000}{49}\n$$\n\n最后，我们将后验赔率转换回后验概率。概率 $P$ 和赔率之间的关系是 $P = \\frac{\\text{赔率}}{1 + \\text{赔率}}$。\n$$\nP(\\text{致病} | \\text{证据}) = \\frac{\\text{后验赔率}}{1 + \\text{后验赔率}} = \\frac{\\frac{25000}{49}}{1 + \\frac{25000}{49}} = \\frac{\\frac{25000}{49}}{\\frac{49 + 25000}{49}} = \\frac{25000}{25049}\n$$\n\n为了得到最终的数值答案，我们进行除法运算，并按要求四舍五入到四位有效数字：\n$$\n\\frac{25000}{25049} \\approx 0.9980438...\n$$\n四舍五入到四位有效数字，后验概率为 $0.9980$。\n\n根据ACMG的解释阈值，后验概率 $\\geq 0.99$ 支持“致病”分类。由于我们计算出的后验概率为 $0.9980$，超过了此阈值，因此证据强度足以满足致病标准。问题要求的是后验概率本身。",
            "answer": "$$\\boxed{0.9980}$$"
        }
    ]
}