{
    "hands_on_practices": [
        {
            "introduction": "一项诊断测试的价值不仅取决于其技术上的精确性（灵敏度 $s$ 和特异性 $c$），还深刻地依赖于它所应用的群体的疾病患病率 $\\pi$。这个练习 () 将指导你通过贝叶斯定理，推导并计算阳性预测值（PPV），从而揭示为什么在低患病率人群中进行筛查时，即使是高度特异性的测试也可能产生大量的假阳性结果。理解这一点对于解读ctDNA筛查报告至关重要。",
            "id": "5053056",
            "problem": "一家医院采用基于循环肿瘤脱氧核糖核酸 (ctDNA) 的液体活检技术，在无症状人群中筛查与某早期癌症相关的一种特定的、可靶向的驱动突变。假设测试结果为二元分类（阳性或阴性），疾病状态也为二元（存在或不存在携带突变的癌症）。设 $s$ 表示检验灵敏度，定义为在疾病存在的情况下检验结果为阳性的概率；设 $c$ 表示检验特异性，定义为在疾病不存在的情况下检验结果为阴性的概率；设 $\\pi$ 表示疾病患病率，定义为在该筛查人群中进行检验前疾病存在的概率。\n\n从灵敏度、特异性和患病率的核心定义出发，结合使用全概率公式和贝叶斯定理，推导出阳性预测值 (PPV) $P(\\text{疾病} \\mid \\text{检验阳性})$ 和阴性预测值 (NPV) $P(\\text{无疾病} \\mid \\text{检验阴性})$ 作为 $s$、$c$ 和 $\\pi$ 的函数的解析表达式。然后，对于一个 ctDNA 检测，其特征为灵敏度 $s=0.75$，特异性 $c=0.99$，在筛查人群中的患病率 $\\pi=0.005$，计算其 PPV。将 PPV 表示为小数，并将您的答案四舍五入到四位有效数字。",
            "solution": "首先，我们根据问题陈述来正式定义事件。设 $D$ 为疾病存在的事件，$D^c$ 为疾病不存在的事件。设 $T^+$ 为检验结果为阳性的事件，$T^-$ 为检验结果为阴性的事件。\n\n根据定义，我们有：\n- 患病率：$\\pi = P(D)$\n- 灵敏度：$s = P(T^+ \\mid D)$\n- 特异性：$c = P(T^- \\mid D^c)$\n\n**阳性预测值 (PPV) 的推导**\nPPV 定义为在检验结果为阳性的情况下疾病存在的概率，即 $P(D \\mid T^+)$。根据贝叶斯定理：\n$$ \\text{PPV} = P(D \\mid T^+) = \\frac{P(T^+ \\mid D) P(D)}{P(T^+)} $$\n分子是 $s \\pi$。分母 $P(T^+)$ 可通过全概率公式展开：\n$$ P(T^+) = P(T^+ \\mid D) P(D) + P(T^+ \\mid D^c) P(D^c) $$\n$$ P(T^+) = s \\pi + (1 - c)(1 - \\pi) $$\n将此代回 PPV 的公式，得到：\n$$ \\text{PPV} = \\frac{s \\pi}{s \\pi + (1 - c)(1 - \\pi)} $$\n\n**阴性预测值 (NPV) 的推导**\nNPV 定义为在检验结果为阴性的情况下疾病不存在的概率，即 $P(D^c \\mid T^-)$。根据贝叶斯定理：\n$$ \\text{NPV} = P(D^c \\mid T^-) = \\frac{P(T^- \\mid D^c) P(D^c)}{P(T^-)} $$\n分子是 $c(1 - \\pi)$。分母 $P(T^-)$ 可通过全概率公式展开：\n$$ P(T^-) = P(T^- \\mid D^c) P(D^c) + P(T^- \\mid D) P(D) $$\n$$ P(T^-) = c(1 - \\pi) + (1 - s)\\pi $$\n将此代回 NPV 的公式，得到：\n$$ \\text{NPV} = \\frac{c(1 - \\pi)}{c(1 - \\pi) + (1 - s)\\pi} $$\n\n**PPV 的计算**\n使用给定参数进行计算：$s = 0.75$，$c = 0.99$，$\\pi = 0.005$。\n代入推导出的 PPV 公式：\n$$ \\text{PPV} = \\frac{(0.75)(0.005)}{(0.75)(0.005) + (1 - 0.99)(1 - 0.005)} $$\n计算分子和分母的各项：\n$$ \\text{PPV} = \\frac{0.00375}{0.00375 + (0.01)(0.995)} $$\n$$ \\text{PPV} = \\frac{0.00375}{0.00375 + 0.00995} $$\n$$ \\text{PPV} = \\frac{0.00375}{0.0137} \\approx 0.2737226... $$\n将答案四舍五入到四位有效数字，得到：\n$$ \\text{PPV} \\approx 0.2737 $$\n这个结果表明，尽管测试的特异性很高，但在低患病率人群中，阳性结果的预测价值仍然相对较低。",
            "answer": "$$ \\boxed{0.2737} $$"
        },
        {
            "introduction": "循环肿瘤DNA（ctDNA）的一个关键临床应用是监测治疗反应，而这依赖于我们对其在血浆中动态变化的理解。本练习 () 将通过一个简化的单室药代动力学模型，让你推导ctDNA浓度在肿瘤负荷减少（如手术后）后的变化曲线。掌握这种动态变化规律是利用液体活检进行疗效评估和复发监测的理论基础。",
            "id": "5053009",
            "problem": "在液体活检背景下，循环肿瘤脱氧核糖核酸（ctDNA）是血浆中存在的一种游离脱氧核糖核酸（cfDNA）亚群。根据经验，cfDNA以一级动力学方式从血浆中清除，其典型半衰期在 $0.5$ 到 $2$ 小时之间。考虑一个单室、充分混合的血浆模型，其中ctDNA浓度（记为 $C(t)$）由肿瘤细胞死亡产生的输入与一级清除之间的平衡所控制。设输入（源）项为分段常数：在 $t=0$ 时刻进行外科手术干预之前，ctDNA的输入速率为 $S_{0}$；手术后（$t \\geq 0$），输入速率突然下降到一个较低的恒定值 $S_{1}$，且 $S_{1}  S_{0}$，这反映了肿瘤细胞死亡的减少。假设系统在手术前处于稳态，并且在所考虑的时间范围内血浆体积是恒定的。\n\n从单室质量平衡的第一性原理以及半衰期为 $t_{1/2}$ 的一级清除过程的定义出发，推导 $t \\geq 0$ 时 $C(t)$ 的时间变化曲线的闭式解析表达式。最终答案仅用 $S_{0}$、$S_{1}$、$t_{1/2}$ 和 $t$ 表示。无需进行数值计算，最终表达式中不应包含单位。",
            "solution": "在单个、充分混合的室中，ctDNA浓度 $C(t)$ 的时间演化由一个质量平衡方程描述。浓度的变化率是输入速率与清除速率之差。\n$$\n\\frac{dC(t)}{dt} = (\\text{输入速率}) - (\\text{清除速率})\n$$\n问题将输入速率定义为分段常数项 $S(t)$。在本模型中，$S(t)$ 代表由于ctDNA流入引起的浓度变化率，单位为浓度/时间。清除过程是一级过程，意味着移除速率与当前浓度成正比，由 $kC(t)$ 给出，其中 $k$ 是一级速率常数。\n\n因此，控制常微分方程（ODE）为：\n$$\n\\frac{dC(t)}{dt} = S(t) - kC(t)\n$$\n\n首先，我们必须将速率常数 $k$ 与给定的半衰期 $t_{1/2}$ 联系起来。对于一个纯粹的一级衰减过程（$\\frac{dC}{dt} = -kC$），解为 $C(t) = C(0)\\exp(-kt)$。半衰期是 $C(t_{1/2}) = \\frac{1}{2}C(0)$ 时的时间。\n$$\n\\frac{1}{2}C(0) = C(0)\\exp(-kt_{1/2})\n$$\n$$\n\\frac{1}{2} = \\exp(-kt_{1/2})\n$$\n对两边取自然对数：\n$$\n\\ln\\left(\\frac{1}{2}\\right) = -kt_{1/2} \\implies -\\ln(2) = -kt_{1/2}\n$$\n因此，速率常数 $k$ 为：\n$$\nk = \\frac{\\ln(2)}{t_{1/2}}\n$$\n\n接下来，我们为 $t \\geq 0$ 的时段建立初始条件。问题指出，在 $t  0$ 时，系统处于稳态。在稳态下，浓度不发生变化，所以 $\\frac{dC}{dt} = 0$。对于 $t  0$，输入速率为 $S(t) = S_{0}$。常微分方程变为：\n$$\n0 = S_0 - kC_{\\text{ss}}\n$$\n其中 $C_{\\text{ss}}$ 是稳态浓度。求解 $C_{\\text{ss}}$ 可得：\n$$\nC_{\\text{ss}} = \\frac{S_0}{k}\n$$\n由于浓度在干预时刻是连续的，因此 $t=0$ 时的浓度等于这个手术前的稳态值。\n$$\nC(0) = C_{\\text{ss}} = \\frac{S_0}{k}\n$$\n\n现在，我们求解 $t \\geq 0$ 时的常微分方程。在此期间，输入速率为 $S(t) = S_{1}$。常微分方程为：\n$$\n\\frac{dC(t)}{dt} = S_1 - kC(t)\n$$\n这是一个一阶线性非齐次常微分方程。它可以被整理成标准形式：\n$$\n\\frac{dC(t)}{dt} + kC(t) = S_1\n$$\n这个常微分方程的通解为 $C(t) = \\frac{S_1}{k} + A\\exp(-kt)$，其中 $A$ 是积分常数。为了求出常数 $A$，我们应用初始条件 $C(0) = S_0/k$：\n$$\nC(0) = \\frac{S_1}{k} + A\\exp(-k \\cdot 0) = \\frac{S_1}{k} + A\n$$\n$$\n\\frac{S_0}{k} = \\frac{S_1}{k} + A \\implies A = \\frac{S_0}{k} - \\frac{S_1}{k} = \\frac{S_0 - S_1}{k}\n$$\n将 $A$ 代回 $C(t)$ 的表达式中：\n$$\nC(t) = \\frac{S_1}{k} + \\left(\\frac{S_0 - S_1}{k}\\right) \\exp(-kt)\n$$\n这个解代表了浓度从初始稳态 $S_0/k$ 指数衰减至新的稳态 $S_1/k$ 的过程。\n\n最后，我们将解用给定的变量 $S_{0}$、$S_{1}$、$t_{1/2}$ 和 $t$ 表示。我们将 $k = \\frac{\\ln(2)}{t_{1/2}}$ 代入 $C(t)$ 的表达式中：\n$$\nC(t) = \\frac{S_1}{\\frac{\\ln(2)}{t_{1/2}}} + \\left(\\frac{S_0 - S_1}{\\frac{\\ln(2)}{t_{1/2}}}\\right) \\exp\\left(-\\frac{\\ln(2)}{t_{1/2}}t\\right)\n$$\n简化表达式：\n$$\nC(t) = \\frac{S_1 t_{1/2}}{\\ln(2)} + \\frac{(S_0 - S_1)t_{1/2}}{\\ln(2)} \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right)\n$$\n提出公因式 $\\frac{t_{1/2}}{\\ln(2)}$，得到最终的闭式解析表达式：\n$$\nC(t) = \\frac{t_{1/2}}{\\ln(2)} \\left[ S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right]\n$$\n该表达式描述了 $t \\geq 0$ 时的ctDNA浓度，它从手术前的稳态水平开始，指数性地趋近于与降低的输入速率 $S_1$ 相一致的新的、较低的稳态水平。",
            "answer": "$$\n\\boxed{\\frac{t_{1/2}}{\\ln(2)} \\left( S_1 + (S_0 - S_1) \\exp\\left(-\\frac{t \\ln(2)}{t_{1/2}}\\right) \\right)}\n$$"
        },
        {
            "introduction": "在微小残留病（MRD）检测等应用中，ctDNA信号极其微弱，检测的挑战如同“大海捞针”。本练习 () 将引导你使用泊松分布来近似模拟测序过程中的分子取样，从而量化多个基因位点联合检测如何提高整体的检测灵敏度。通过这个计算，你将深入理解增加检测靶标数量对于克服极低变异等位基因频率（VAF）挑战的重要性。",
            "id": "5053050",
            "problem": "一种基于循环肿瘤脱氧核糖核酸（ctDNA）液体活检的微小残留病（MRD）检测方法，追踪一组单核苷酸变异（SNV）。假设监测 $m$ 个独立的基因座，每个基因座的去重独特分子标识符（UMI）深度为 $N$，真实变异等位基因频率（VAF）为 $p$。如果在某个基因座上观察到的突变分子数（记为 $X$）满足 $X \\geq t$，则该基因座被称为阳性，其中 $t$ 是一个固定的检测阈值。\n\n将单个基因座的读数抽样建模为 $X \\sim \\mathrm{Binomial}(N,p)$。对于小的 $p$ 和大的 $N$，使用泊松近似 $X \\approx \\mathrm{Poisson}(\\lambda)$，其中 $\\lambda = Np$。假设不同基因座的检测事件是独立的。\n\n从这些假设出发，推导每个基因座的检测概率 $q$ 关于 $\\lambda$ 和 $t$ 的表达式，然后推导当追踪 $m$ 个基因座时，该组合检测到MRD（至少一个基因座为阳性）的总概率。最后，使用参数 $m = 8$，$N = 10,000$，$p = 2.0 \\times 10^{-4}$ 和 $t = 3$ 对这个总检测概率进行数值计算。将最终的灵敏度表示为一个无单位的小数，并将答案四舍五入到四位有效数字。",
            "solution": "首先，推导单个基因座的检测概率 $q$。如果观察到的突变分子数 $X$ 大于或等于阈值 $t$，则该基因座为阳性。因此，检测概率 $q = P(X \\geq t)$。\n根据泊松近似，$X \\sim \\mathrm{Poisson}(\\lambda)$，其中 $\\lambda = Np$。泊松分布的概率质量函数（PMF）为 $P(X=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$。\n计算 $P(X \\geq t)$ 通过计算其补事件 $P(X  t)$ 更为方便：\n$$q = 1 - P(X  t) = 1 - \\sum_{k=0}^{t-1} P(X=k)$$\n代入PMF，我们得到 $q$ 的表达式：\n$$q = 1 - \\sum_{k=0}^{t-1} \\frac{\\lambda^k \\exp(-\\lambda)}{k!} = 1 - \\exp(-\\lambda) \\sum_{k=0}^{t-1} \\frac{\\lambda^k}{k!}$$\n接下来，推导组合检测的总概率 $P_{\\text{overall}}$。当 $m$ 个独立的基因座中至少有一个为阳性时，发生检测。计算其补事件（即所有 $m$ 个基因座均为阴性）的概率更容易。单个基因座为阴性的概率是 $1-q$。由于基因座是独立的，所有基因座均为阴性的概率是 $(1-q)^m$。\n因此，总检测概率是：\n$$P_{\\text{overall}} = 1 - (1-q)^m$$\n最后，使用给定参数进行数值计算：$m = 8$，$N = 10,000$，$p = 2.0 \\times 10^{-4}$，$t = 3$。\n\n首先，计算泊松参数 $\\lambda$：\n$$\\lambda = Np = 10,000 \\times (2.0 \\times 10^{-4}) = 2.0$$\n接下来，计算单个基因座的检测概率 $q$，其中 $\\lambda=2$ 和 $t=3$。求和项为 $k=0, 1, 2$：\n$$q = 1 - \\exp(-2) \\sum_{k=0}^{2} \\frac{2^k}{k!} = 1 - \\exp(-2) \\left( \\frac{2^0}{0!} + \\frac{2^1}{1!} + \\frac{2^2}{2!} \\right)$$\n$$q = 1 - \\exp(-2) \\left( 1 + 2 + 2 \\right) = 1 - 5\\exp(-2)$$\n现在，计算总检测概率 $P_{\\text{overall}}$：\n$$P_{\\text{overall}} = 1 - (1-q)^m = 1 - (1 - (1 - 5\\exp(-2)))^8$$\n$$P_{\\text{overall}} = 1 - (5\\exp(-2))^8 = 1 - 5^8 \\exp(-16)$$\n进行数值计算：\n$$P_{\\text{overall}} = 1 - 390625 \\times \\exp(-16)$$\n使用 $\\exp(-16) \\approx 1.12535 \\times 10^{-7}$：\n$$P_{\\text{overall}} \\approx 1 - 390625 \\times (1.12535 \\times 10^{-7}) \\approx 1 - 0.04396$$\n$$P_{\\text{overall}} \\approx 0.95604$$\n将结果四舍五入到四位有效数字，得到 $0.9560$。",
            "answer": "$$\n\\boxed{0.9560}\n$$"
        }
    ]
}