{
    "hands_on_practices": [
        {
            "introduction": "标准的哈迪-温伯格原理处理的是双等位基因系统。本练习旨在挑战你将此原理想象到一个更真实的情境：单个基因座上存在三个等位基因。通过从第一性原理出发推导基因型频率，你将更深入地理解随机交配如何导致可预测的平衡频率，这是群体遗传学的基石。",
            "id": "5032321",
            "problem": "考虑一个大型、随机交配的人类群体中的单个常染色体二倍体基因座，该群体满足哈迪-温伯格平衡（HWE）的标准条件：随机交配、无突变、无迁移、无选择，且遗传漂变可忽略不计。该基因座有三个等位基因，记作 $A_{1}$、$A_{2}$ 和 $A_{3}$，它们在交配池中的配子（等位基因）频率分别为 $p_{1}$、$p_{2}$ 和 $p_{3}$。假设 $p_{1} + p_{2} + p_{3} = 1$。从配子随机结合以及来自双亲的等位基因贡献相互独立的第一性原理出发，推导在哈迪-温伯格平衡条件下六种无序二倍体基因型 $A_{1}A_{1}$、$A_{2}A_{2}$、$A_{3}A_{3}$、$A_{1}A_{2}$、$A_{1}A_{3}$ 和 $A_{2}A_{3}$ 的预期基因型频率。您的推导必须明确使用所述的假设和基本概率法则。请将最终答案表示为一个单行矩阵，其中包含按 $(A_{1}A_{1}, A_{2}A_{2}, A_{3}A_{3}, A_{1}A_{2}, A_{1}A_{3}, A_{2}A_{3})$ 顺序排列的六种基因型频率。请以符号形式提供最终表达式；不要代入数值，也不要四舍五入。",
            "solution": "该问题陈述被评估为有效。这是一个有科学依据、定义明确且客观的问题，是群体遗传学的核心内容。所有必要的条件和变量均已提供，其任务是针对三等位基因系统进行哈迪-温伯格原理的标准推导。\n\n在哈迪-温伯格平衡（HWE）下预期基因型频率的推导，源于在一个大群体中随机交配的基本假设。这在数学上等同于配子的随机结合。我们考虑一个非常大的配子库，其中等位基因 $A_1$、$A_2$ 和 $A_3$ 的频率分别为 $p_1$、$p_2$ 和 $p_3$。条件 $p_1 + p_2 + p_3 = 1$ 确保了这些是该基因座上仅有的等位基因。\n\n下一代二倍体基因型的形成是两个配子融合的结果，一个来自父方，一个来自母方。此处相关的关键哈迪-温伯格平衡假设是：\n1.  **随机交配**：群体中的任何个体与任何其他异性个体交配的机会均等。这意味着形成合子的亲代配子是从基因库中随机且独立抽取的。\n2.  **两性中等位基因频率相等**：等位基因频率 $p_1$、$p_2$ 和 $p_3$ 在雄性和雌性配子中是相同的。\n3.  **等位基因贡献的独立性**：一个亲本贡献的等位基因与另一个亲本贡献的等位基因是相互独立的。\n\n我们将从父方配子库中抽取等位基因 $A_i$ 的事件记为 $P_i$，从母方配子库中抽取的记为 $M_i$。根据问题的设定，这些事件的概率为：\n$P(\\text{抽取 } A_1) = p_1$\n$P(\\text{抽取 } A_2) = p_2$\n$P(\\text{抽取 } A_3) = p_3$\n\n这些概率对于父方和母方配子库是相同的。我们现在可以通过应用基本概率法则来计算六种可能的无序基因型中每一种的频率。\n\n**纯合基因型**\n纯合基因型，如 $A_1A_1$，是由一个携带 $A_1$ 等位基因的配子与另一个同样携带 $A_1$ 等位基因的配子融合形成的。由于配子选择的独立性，该事件的概率是各个概率的乘积。\n-   **$A_1A_1$ 的频率**：从父亲那里接收一个 $A_1$ 等位基因的概率是 $p_1$，从母亲那里接收一个 $A_1$ 等位基因的概率也是 $p_1$。\n    $$P(A_1A_1) = P(\\text{父方为 } A_1 \\text{ 且母方为 } A_1) = P(\\text{父方为 } A_1) \\times P(\\text{母方为 } A_1) = p_1 \\times p_1 = p_1^2$$\n-   **$A_2A_2$ 的频率**：根据同样的逻辑，形成 $A_2A_2$ 基因型的概率是：\n    $$P(A_2A_2) = p_2 \\times p_2 = p_2^2$$\n-   **$A_3A_3$ 的频率**：同样地，形成 $A_3A_3$ 基因型的概率是：\n    $$P(A_3A_3) = p_3 \\times p_3 = p_3^2$$\n\n**杂合基因型**\n杂合基因型，如 $A_1A_2$，可以通过两种互斥的方式形成：$A_1$ 等位基因可以来自父亲而 $A_2$ 来自母亲，或者反之亦然。总概率是这两个事件概率的总和。\n-   **$A_1A_2$ 的频率**：\n    （$A_1$ 来自父亲且 $A_2$ 来自母亲）的概率是 $p_1 \\times p_2$。\n    （$A_2$ 来自父亲且 $A_1$ 来自母亲）的概率是 $p_2 \\times p_1$。\n    由于这两个事件是互斥的，形成一个无序 $A_1A_2$ 基因型的总概率是：\n    $$P(A_1A_2) = (p_1 \\times p_2) + (p_2 \\times p_1) = 2p_1p_2$$\n-   **$A_1A_3$ 的频率**：根据同样的逻辑，形成 $A_1A_3$ 基因型的概率是：\n    $$P(A_1A_3) = (p_1 \\times p_3) + (p_3 \\times p_1) = 2p_1p_3$$\n-   **$A_2A_3$ 的频率**：同样地，形成 $A_2A_3$ 基因型的概率是：\n    $$P(A_2A_3) = (p_2 \\times p_3) + (p_3 \\times p_2) = 2p_2p_3$$\n\n这些推导出的频率代表了经过一代随机交配后群体中每种基因型的预期比例。它们是 $(p_1 + p_2 + p_3)^2$ 三项式展开的各项。作为检验，所有基因型频率的总和必须等于 $1$：\n$$p_1^2 + p_2^2 + p_3^2 + 2p_1p_2 + 2p_1p_3 + 2p_2p_3 = (p_1 + p_2 + p_3)^2$$\n鉴于 $p_1 + p_2 + p_3 = 1$，基因型频率的总和是 $1^2 = 1$，这证实了结果的一致性。\n\n最终答案是一个行矩阵，按指定顺序 $(A_1A_1, A_2A_2, A_3A_3, A_1A_2, A_1A_3, A_2A_3)$ 包含这六种基因型频率。",
            "answer": "$$\\boxed{\\begin{pmatrix} p_1^2 & p_2^2 & p_3^2 & 2p_1p_2 & 2p_1p_3 & 2p_2p_3 \\end{pmatrix}}$$"
        },
        {
            "introduction": "哈迪-温伯格平衡假设没有选择，但在现实中，自然选择是一种强大的进化力量。本实践探讨了一种经典的平衡选择案例——超显性（overdominance），即杂合子具有最高的适合度。你将推导出由这些相对的选择压力产生的稳定平衡等位基因频率，从而阐明选择如何在群体中维持遗传变异。",
            "id": "5032358",
            "problem": "考虑一个大型随机交配、满足哈代-温伯格平衡（HWE）的种群中的一个单常染色体基因座，其等位基因为 $A$ 和 $a$。设 $p_t$ 表示在第 $t$ 代合子中等位基因 $A$ 的频率，而 $q_t = 1 - p_t$ 表示等位基因 $a$ 的频率。生存力选择作用于基因型，其相对适应度分别为 $w_{AA} = 1 - s_1$、$w_{Aa} = 1$ 和 $w_{aa} = 1 - s_2$，其中 $s_1 > 0$ 且 $s_2 > 0$。假设没有其他进化力量（无突变、无迁移、无遗传漂变），并且交配每代都会恢复哈代-温伯格基因型比例。\n\n从基本事实出发：在HWE下，合子基因型频率为 $p_t^2$、$2 p_t q_t$ 和 $q_t^2$；生存力选择通过各自的适应度对这些基因型频率进行重新缩放，其中平均适应度 $\\bar{w}$ 由种群基因型适应度的平均值给出。请根据 $p_t$、$s_1$ 和 $s_2$ 推导出离散时间等位基因频率递归式 $p_{t+1}$。然后，确定满足 $0 < p^* < 1$ 和 $p_{t+1} = p_t = p^*$ 的内部平衡等位基因频率 $p^*$，并通过计算递归式对 $p_t$ 的导数在 $p^*$ 处的值（记为 $f'(p^*)$，其中 $p_{t+1} = f(p_t)$）来评估其局部稳定性。使用一维离散动力系统的稳定性判据：如果 $|f'(p^*)| < 1$，则平衡点是局部渐近稳定的。\n\n请以一个行矩阵的形式提供平衡点 $p^*$ 和导数 $f'(p^*)$ 的封闭形式表达式作为最终答案。不需要数值近似。",
            "solution": "用户要求我解决一个群体遗传学问题。\n\n我的计划如下：\n1.  **验证问题陈述。**\n    -   **步骤1：提取已知条件。** 我将列出问题中提供的所有信息。\n        -   单个常染色体基因座，等位基因为 $A$ 和 $a$。\n        -   大型随机交配种群，处于哈代-温伯格平衡（HWE）状态。\n        -   $p_t$ 是第 $t$ 代等位基因 $A$ 的频率。\n        -   $q_t = 1 - p_t$ 是第 $t$ 代等位基因 $a$ 的频率。\n        -   基因型的相对适应度：$w_{AA} = 1 - s_1$，$w_{Aa} = 1$，$w_{aa} = 1 - s_2$。\n        -   选择系数：$s_1 > 0$ 和 $s_2 > 0$。\n        -   无其他进化力量（突变、迁移、漂变）。\n        -   交配每代都会恢复HWE。\n        -   第 $t$ 代的合子基因型频率：$AA$ 为 $p_t^2$，$Aa$ 为 $2 p_t q_t$，$aa$ 为 $q_t^2$。\n        -   选择通过适应度重新缩放频率。\n        -   平均适应度 $\\bar{w}$ 是种群基因型适应度的平均值。\n    -   **步骤2：根据我的检查清单进行验证。**\n        -   **科学上是否成立？** 是的，这是群体遗传学中一个标准的选择模型（超显性或杂合子优势，因为 $s_1, s_2 > 0$）。HWE、适应度和等位基因频率递归等概念是该领域的基础。\n        -   **问题是否适定？** 是的，问题要求进行特定的推导和稳定性分析。参数已定义，目标明确。应该存在唯一解。\n        -   **是否客观？** 是的，语言精确且技术性强。没有主观成分。\n        -   **缺陷检查：**\n            1.  **科学上不健全？** 否。这是一个经典、公认的模型。\n            2.  **无法形式化？** 否。这是一个数学问题，与群体遗传学主题相关。\n            3.  **不完整/矛盾？** 否。提供了所有必要信息。条件 $s_1 > 0$ 和 $s_2 > 0$ 意味着杂合子优势，这是导致稳定内部平衡的标准情况。\n            4.  **不切实际/不可行？** 否。虽然完美的HWE种群不存在，但这是一个标准且有用的理论模型。在模型背景下，这些条件在科学上是合理的。\n            5.  **不适定/结构不良？** 否。问题结构良好，旨在引导用户完成标准的推导和分析。\n            6.  **伪深刻/琐碎？** 否。这是群体遗传学中一个基础性的、非琐碎的问题。\n            7.  **外部可验证性？** 否。推导过程是一个可以验证的数学过程。\n    -   **步骤3：结论和行动。** 问题是**有效的**。我将继续解答。\n\n2.  **解决问题。**\n    -   **第1部分：推导 $p_{t+1}$ 的递归式。**\n        -   从第 $t$ 代合子的基因型频率开始：\n            -   Freq($AA$) = $p_t^2$\n            -   Freq($Aa$) = $2 p_t q_t$\n            -   Freq($aa$) = $q_t^2$\n        -   应用生存力选择。成年个体（选择后）的基因型频率与合子频率乘以其各自适应度的乘积成正比：\n            -   Prop. Freq($AA$) $\\propto p_t^2 w_{AA} = p_t^2 (1 - s_1)$\n            -   Prop. Freq($Aa$) $\\propto 2 p_t q_t w_{Aa} = 2 p_t q_t (1)$\n            -   Prop. Freq($aa$) $\\propto q_t^2 w_{aa} = q_t^2 (1 - s_2)$\n        -   比例常数是 $1/\\bar{w}_t$，其中 $\\bar{w}_t$ 是第 $t$ 代种群的平均适应度。\n        -   计算平均适应度 $\\bar{w}_t$：\n            -   $\\bar{w}_t = p_t^2 w_{AA} + 2 p_t q_t w_{Aa} + q_t^2 w_{aa}$\n            -   $\\bar{w}_t = p_t^2 (1 - s_1) + 2 p_t q_t (1) + q_t^2 (1 - s_2)$\n            -   代入 $q_t = 1 - p_t$：\n            -   $\\bar{w}_t = p_t^2 (1 - s_1) + 2 p_t (1 - p_t) + (1 - p_t)^2 (1 - s_2)$\n            -   $\\bar{w}_t = p_t^2 - s_1 p_t^2 + 2 p_t - 2 p_t^2 + (1 - 2 p_t + p_t^2)(1 - s_2)$\n            -   $\\bar{w}_t = 2 p_t - p_t^2 - s_1 p_t^2 + 1 - 2 p_t + p_t^2 - s_2(1 - 2 p_t + p_t^2)$\n            -   $\\bar{w}_t = 1 - s_1 p_t^2 - s_2 q_t^2$ (这是一个更紧凑的形式，我们重新推导一下)\n            -   $\\bar{w}_t = p_t^2(1 - s_1) + 2 p_t q_t + q_t^2(1 - s_2)$\n            -   $\\bar{w}_t = (p_t^2 + 2 p_t q_t + q_t^2) - s_1 p_t^2 - s_2 q_t^2$\n            -   因为 $(p_t + q_t)^2 = 1^2 = 1$，所以 $p_t^2 + 2 p_t q_t + q_t^2 = 1$。\n            -   所以，$\\bar{w}_t = 1 - s_1 p_t^2 - s_2 q_t^2$。这是正确的，并且简洁得多。\n        -   计算成年个体的基因型频率：\n            -   Freq'($AA$) = $p_t^2 (1 - s_1) / \\bar{w}_t$\n            -   Freq'($Aa$) = $2 p_t q_t / \\bar{w}_t$\n            -   Freq'($aa$) = $q_t^2 (1 - s_2) / \\bar{w}_t$\n        -   计算下一代等位基因 $A$ 的频率 $p_{t+1}$。这是被选择的成年个体产生的配子中 $A$ 的频率。$AA$ 个体只贡献 $A$ 等位基因，$Aa$ 个体有一半时间贡献 $A$ 等位基因。\n            -   $p_{t+1} = \\text{Freq'}(AA) + \\frac{1}{2} \\text{Freq'}(Aa)$\n            -   $p_{t+1} = \\frac{p_t^2 (1 - s_1)}{\\bar{w}_t} + \\frac{1}{2} \\frac{2 p_t q_t}{\\bar{w}_t}$\n            -   $p_{t+1} = \\frac{p_t^2 (1 - s_1) + p_t q_t}{\\bar{w}_t}$\n            -   $p_{t+1} = \\frac{p_t (p_t (1 - s_1) + q_t)}{\\bar{w}_t}$\n            -   代入 $q_t = 1 - p_t$：\n            -   $p_{t+1} = \\frac{p_t (p_t - s_1 p_t + 1 - p_t)}{1 - s_1 p_t^2 - s_2 (1-p_t)^2}$\n            -   $p_{t+1} = \\frac{p_t (1 - s_1 p_t)}{1 - s_1 p_t^2 - s_2 (1-p_t)^2}$\n        -   这就是递归关系，$p_{t+1} = f(p_t)$。\n\n    -   **第2部分：确定内部平衡点 $p^*$。**\n        -   当 $p_{t+1} = p_t$ 时达到平衡。我们称这个平衡值为 $p^*$。\n        -   $p^* = \\frac{p^* (1 - s_1 p^*)}{1 - s_1 (p^*)^2 - s_2 (1-p^*)^2}$\n        -   一个解是平凡平衡点 $p^* = 0$。如果我们两边除以 $p^*$（假设 $p^* \\neq 0$），就可以找到内部平衡点。\n        -   $1 = \\frac{1 - s_1 p^*}{1 - s_1 (p^*)^2 - s_2 (1-p^*)^2}$\n        -   $1 - s_1 (p^*)^2 - s_2 (1 - p^*)^2 = 1 - s_1 p^*$\n        -   $- s_1 (p^*)^2 - s_2 (1 - 2p^* + (p^*)^2) = - s_1 p^*$\n        -   $- s_1 (p^*)^2 - s_2 + 2 s_2 p^* - s_2 (p^*)^2 = - s_1 p^*$\n        -   重新整理以组合含 $p^*$ 的项：\n        -   $-(s_1 + s_2)(p^*)^2 + (s_1 + 2s_2)p^* - s_2 = 0$\n        -   这是一个关于 $p^*$ 的二次方程。我来检查一下我的代数计算。\n        -   还有一种方法是使用 $\\Delta p = p_{t+1} - p_t$。\n        -   $\\Delta p = p_{t+1} - p_t = \\frac{p_t (1 - s_1 p_t)}{\\bar{w}_t} - p_t = \\frac{p_t(1 - s_1 p_t) - p_t \\bar{w}_t}{\\bar{w}_t}$\n        -   $\\Delta p = \\frac{p_t(1 - s_1 p_t - \\bar{w}_t)}{\\bar{w}_t}$\n        -   $\\Delta p = \\frac{p_t(1 - s_1 p_t - (1 - s_1 p_t^2 - s_2 q_t^2))}{\\bar{w}_t}$\n        -   $\\Delta p = \\frac{p_t(- s_1 p_t + s_1 p_t^2 + s_2 q_t^2)}{\\bar{w}_t}$\n        -   $\\Delta p = \\frac{p_t(- s_1 p_t(1-p_t) + s_2 q_t^2)}{\\bar{w}_t}$\n        -   由于 $q_t = 1 - p_t$：\n        -   $\\Delta p = \\frac{p_t(- s_1 p_t q_t + s_2 q_t^2)}{\\bar{w}_t}$\n        -   $\\Delta p = \\frac{p_t q_t (-s_1 p_t + s_2 q_t)}{\\bar{w}_t}$\n        -   令 $\\Delta p = 0$ 来寻找平衡点。当 $p_t=0$，$q_t=0$（即 $p_t=1$），或 $-s_1 p_t + s_2 q_t = 0$ 时，$\\Delta p = 0$。\n        -   内部平衡点 $p^*$ 满足 $0 < p^* < 1$，所以 $p^* \\neq 0$ 且 $q^* = 1 - p^* \\neq 0$。\n        -   因此，必须有 $-s_1 p^* + s_2 q^* = 0$。\n        -   $-s_1 p^* + s_2 (1 - p^*) = 0$\n        -   $-s_1 p^* + s_2 - s_2 p^* = 0$\n        -   $s_2 = (s_1 + s_2) p^*$\n        -   $p^* = \\frac{s_2}{s_1 + s_2}$\n        -   这是超显性的标准结果。\n        -   因为 $s_1 > 0$ 且 $s_2 > 0$，所以 $s_1 + s_2 > s_2 > 0$。因此，$0 < \\frac{s_2}{s_1 + s_2} < 1$。该平衡点确实是内部的。\n\n    -   **第3部分：评估局部稳定性。**\n        -   我们需要计算 $f'(p^*) = \\left. \\frac{d p_{t+1}}{d p_t} \\right|_{p_t=p^*}$，其中 $f(p_t) = p_{t+1} = \\frac{p_t (1 - s_1 p_t)}{1 - s_1 p_t^2 - s_2 (1-p_t)^2}$。\n        -   我们使用商法则。为简化符号，令 $p_t = p$。\n        -   $f(p) = \\frac{N(p)}{D(p)}$，其中 $N(p) = p(1 - s_1 p) = p - s_1 p^2$ 且 $D(p) = 1 - s_1 p^2 - s_2 (1-p)^2$。\n        -   $f'(p) = \\frac{N'(p) D(p) - N(p) D'(p)}{[D(p)]^2}$。\n        -   $N'(p) = 1 - 2 s_1 p$。\n        -   $D'(p) = -2 s_1 p - s_2 (2(1-p)(-1)) = -2 s_1 p + 2 s_2 (1-p)$。\n        -   在平衡点 $p=p^*$，我们知道 $\\Delta p = 0$，这意味着 $p_{t+1} = p^*$，所以 $f(p^*) = p^*$。\n        -   同样，在 $p=p^*$ 时，我们有 $p^* = N(p^*)/D(p^*)$，这意味着 $D(p^*) = N(p^*)/p^* = 1 - s_1 p^*$。\n        -   所以在 $p=p^*$ 时：\n        -   $N(p^*) = p^*(1 - s_1 p^*)$\n        -   $D(p^*) = 1 - s_1 (p^*)^2 - s_2 (1-p^*)^2$。\n        -   我们从 $\\Delta p$ 的计算中也知道 $-s_1 p^* + s_2(1-p^*) = 0$。\n        -   让我们计算在 $p^*$ 处的导数：\n        -   $N'(p^*) = 1 - 2 s_1 p^*$。\n        -   $D'(p^*) = -2 s_1 p^* + 2 s_2 (1 - p^*)$。因为 $s_2(1-p^*) = s_1 p^*$：\n        -   $D'(p^*) = -2 s_1 p^* + 2 (s_1 p^*) = 0$。\n        -   这极大地简化了计算！\n        -   我们来复核一下 $D'(p^*) = 0$。\n        -   我们重新审视 $\\bar{w}(p) = D(p) = 1 - s_1 p^2 - s_2 (1-p)^2$。\n        -   导数 $\\bar{w}'(p) = -2 s_1 p - s_2 (2(1-p)(-1)) = -2s_1 p + 2s_2(1-p)$。\n        -   我们令 $\\bar{w}'(p)=0$ 来找到平均适应度的极值点。\n        -   $-2s_1 p + 2s_2 - 2s_2 p = 0 \\implies 2s_2 = 2(s_1+s_2)p \\implies p = \\frac{s_2}{s_1+s_2}$。\n        -   所以，内部平衡点 $p^*$ 正是平均适应度最大化的点。这就是 Wright 的适应性地形。这意味着 $\\bar{w}'(p^*) = D'(p^*) = 0$。\n        -   现在，我们可以计算 $f'(p^*)$：\n        -   $f'(p^*) = \\frac{N'(p^*) D(p^*) - N(p^*) D'(p^*)}{[D(p^*)]^2} = \\frac{N'(p^*) D(p^*) - N(p^*) \\cdot 0}{[D(p^*)]^2} = \\frac{N'(p^*)}{D(p^*)}$\n        -   我们有 $N'(p^*) = 1 - 2 s_1 p^*$\n        -   以及 $D(p^*) = 1 - s_1 (p^*)^2 - s_2 (1-p^*)^2$。同样 $D(p^*) = \\bar{w}(p^*)$。\n        -   让我们代入 $p^* = \\frac{s_2}{s_1 + s_2}$ 和 $q^* = 1 - p^* = \\frac{s_1}{s_1 + s_2}$。\n        -   $N'(p^*) = 1 - 2 s_1 \\left(\\frac{s_2}{s_1 + s_2}\\right) = \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2}$。\n        -   $D(p^*) = \\bar{w}(p^*) = 1 - s_1 (p^*)^2 - s_2 (q^*)^2$\n        -   $D(p^*) = 1 - s_1 \\left(\\frac{s_2}{s_1 + s_2}\\right)^2 - s_2 \\left(\\frac{s_1}{s_1 + s_2}\\right)^2$\n        -   $D(p^*) = 1 - \\frac{s_1 s_2^2}{(s_1 + s_2)^2} - \\frac{s_2 s_1^2}{(s_1 + s_2)^2}$\n        -   $D(p^*) = 1 - \\frac{s_1 s_2(s_2 + s_1)}{(s_1 + s_2)^2} = 1 - \\frac{s_1 s_2}{s_1 + s_2}$。\n        -   让我们用我之前找到的 $D(p^*) = 1 - s_1 p^*$ 来检查 $D(p^*)$ 的这个结果。\n        -   $D(p^*) = 1 - s_1 \\left(\\frac{s_2}{s_1 + s_2}\\right) = \\frac{s_1 + s_2 - s_1 s_2}{s_1 + s_2}$。\n        -   有些地方不对。让我们重新检查 $D(p^*) = N(p^*)/p^* = 1 - s_1 p^*$。\n        -   $p_{t+1} = p_t \\frac{1-s_1 p_t}{\\bar{w}_t}$。\n        -   在平衡点， $p^* = p^* \\frac{1-s_1 p^*}{\\bar{w}(p^*)}$。是的，所以 $\\bar{w}(p^*) = 1 - s_1 p^*$。\n        -   让我们用定义重新计算 $\\bar{w}(p^*)$。\n        -   $\\bar{w}(p^*) = 1 - s_1 (p^*)^2 - s_2 (1-p^*)^2$。\n        -   $p^*=\\frac{s_2}{s_1+s_2}$。 $1-p^* = \\frac{s_1}{s_1+s_2}$。\n        -   $\\bar{w}(p^*) = 1 - s_1 (\\frac{s_2}{s_1+s_2})^2 - s_2 (\\frac{s_1}{s_1+s_2})^2$\n        -   $\\bar{w}(p^*) = 1 - \\frac{s_1 s_2^2}{(s_1+s_2)^2} - \\frac{s_2 s_1^2}{(s_1+s_2)^2}$\n        -   $\\bar{w}(p^*) = 1 - \\frac{s_1 s_2 (s_2+s_1)}{(s_1+s_2)^2} = 1 - \\frac{s_1 s_2}{s_1+s_2}$\n        -   所以，我们有两个关于 $\\bar{w}(p^*)$ 的表达式：\n        -   1) $\\bar{w}(p^*) = 1 - s_1 p^* = 1 - \\frac{s_1 s_2}{s_1+s_2}$\n        -   2) $\\bar{w}(p^*) = 1 - \\frac{s_1 s_2}{s_1+s_2}$\n        -   它们匹配。很好。所以 $D(p^*) = 1 - \\frac{s_1 s_2}{s_1+s_2}$。\n        -   现在回到 $f'(p^*)$：\n        -   $f'(p^*) = \\frac{N'(p^*)}{D(p^*)} = \\frac{1 - 2 s_1 p^*}{1 - s_1 p^*}$\n        -   代入 $p^* = \\frac{s_2}{s_1 + s_2}$。\n        -   分子: $1 - 2 s_1 \\left(\\frac{s_2}{s_1 + s_2}\\right) = \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2}$\n        -   分母: $1 - s_1 \\left(\\frac{s_2}{s_1 + s_2}\\right) = \\frac{s_1 + s_2 - s_1 s_2}{s_1 + s_2}$\n        -   $f'(p^*) = \\frac{\\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2}}{\\frac{s_1 + s_2 - s_1 s_2}{s_1 + s_2}} = \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2 - s_1 s_2}$\n        -   这似乎是正确的。\n        -   让我们简化这个表达式，以使稳定性条件 $|f'(p^*)| < 1$ 更加透明。\n        -   $f'(p^*) = \\frac{s_1 + s_2 - s_1 s_2 - s_1 s_2}{s_1 + s_2 - s_1 s_2} = 1 - \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2}$。\n        -   为保证稳定性，我们需要 $|f'(p^*)| < 1$，即 $-1 < f'(p^*) < 1$。\n        -   我们检查 $f'(p^*) < 1$。\n        -   $1 - \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2} < 1$\n        -   $-\\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2} < 0$\n        -   $\\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2} > 0$。\n        -   由于 $s_1 > 0$ 和 $s_2 > 0$，分子 $s_1 s_2$ 为正。\n        -   我们需要检查分母 $D_{f'} = s_1 + s_2 - s_1 s_2$ 的符号。\n        -   相对适应度必须为非负数。$w_{AA} = 1 - s_1 \\ge 0 \\implies s_1 \\le 1$。同样，$w_{aa} = 1 - s_2 \\ge 0 \\implies s_2 \\le 1$。问题陈述中说明了 $s_1 > 0, s_2 > 0$，但没有明确指出 $s_1, s_2 \\le 1$。然而，这是对生存力的标准假设。如果 $s > 1$，适应度为负，这在生物学上没有意义。我们假设 $0 < s_1, s_2 \\le 1$。\n        -   如果 $0 < s_1, s_2 \\le 1$，那么 $s_1 s_2 \\le s_1$ 且 $s_1 s_2 \\le s_2$。\n        -   $D_{f'} = s_1 + s_2 - s_1 s_2 = s_1(1-s_2) + s_2$。\n        -   因为 $s_2 > 0$ 且 $s_1 > 0$ 且 $(1-s_2) \\ge 0$，我们有 $D_{f'} > 0$。\n        -   所以 $\\frac{s_1 s_2}{D_{f'}} > 0$，这意味着 $f'(p^*) < 1$ 成立。\n\n        -   我们检查 $f'(p^*) > -1$。\n        -   $1 - \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2} > -1$\n        -   $2 > \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2}$\n        -   $2(s_1 + s_2 - s_1 s_2) > s_1 s_2$\n        -   $2s_1 + 2s_2 - 2s_1 s_2 > s_1 s_2$\n        -   $2s_1 + 2s_2 > 3s_1 s_2$\n        -   $1 > \\frac{3s_1 s_2}{2(s_1 + s_2)}$。\n        -   条件 $0 < s_1, s_2 \\le 1$ 并不能保证这一点。例如，如果 $s_1=1, s_2=1$:\n        -   $1 > \\frac{3(1)(1)}{2(1+1)} = \\frac{3}{4}$。这成立。\n        -   考虑调和平均数 $H(s_1, s_2) = \\frac{2s_1 s_2}{s_1+s_2}$。条件是 $1 > \\frac{3}{4} H(s_1, s_2)$。\n        -   算术平均数总是大于或等于调和平均数。$(s_1+s_2)/2 \\ge 2s_1s_2/(s_1+s_2)$。\n        -   如果我们假设 $0 < s_1, s_2 \\le 1$，那么 $s_1 s_2 \\le 1$。并且 $s_1 s_2 \\le s_1$ 和 $s_1 s_2 \\le s_2$。\n        -   让我们看一下表达式 $2(s_1 + s_2) - 3s_1 s_2 > 0$。\n        -   令 $s_1=x, s_2=y$。区域是正方形 $(0, 1] \\times (0, 1]$。我们需要检查在这个区域内是否有 $2x+2y-3xy > 0$。\n        -   令 $g(x,y) = 2x+2y-3xy$。在边界上：\n        -   $g(x, 1) = 2x+2-3x = 2-x$。因为 $x \\le 1$，所以 $g(x,1) \\ge 1 > 0$。\n        -   $g(1, y) = 2+2y-3y = 2-y$。因为 $y \\le 1$，所以 $g(1,y) \\ge 1 > 0$。\n        -   最小值可能在内部或在 $(0,0)$。\n        -   $\\partial g / \\partial x = 2 - 3y = 0 \\implies y=2/3$。\n        -   $\\partial g / \\partial y = 2 - 3x = 0 \\implies x=2/3$。\n        -   临界点在 $(2/3, 2/3)$。$g(2/3, 2/3) = 2(2/3)+2(2/3)-3(2/3)(2/3) = 4/3+4/3-12/9 = 8/3 - 4/3 = 4/3 > 0$。\n        -   在正方形 $[0,1] \\times [0,1]$ 上的最小值出现在某个角点。$g(0,0)=0$, $g(1,0)=2$, $g(0,1)=2$, $g(1,1)=1$。\n        -   所以对于 $s_1, s_2 > 0$ 和 $s_1, s_2 \\le 1$，条件 $2s_1 + 2s_2 > 3s_1 s_2$ 总是满足的，除了在极限 $s_1 \\to 0, s_2 \\to 0$ 的情况下。在此极限下，$f'(p^*) \\to 1$。\n        -   问题只给出了 $s_1 > 0, s_2 > 0$。如果 $s_1 > 1$ 或 $s_2 > 1$ 会怎样？这对应于负适应度。虽然在生物学上很奇怪，但在数学上是可能的。让我们看看稳定性条件是否成立。\n        -   $f'(p^*) = 1 - \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2}$。\n        -   为了保证稳定性，我们需要 $0 < \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2} < 2$。\n        -   让我们分析一下 $K = \\frac{s_1 s_2}{s_1 + s_2 - s_1 s_2}$ 这一项。\n        -   分母可以为零或负数。$s_1 + s_2 - s_1 s_2 = 0 \\implies s_1(1-s_2) + s_2 = 0$。因为 $s_1, s_2 > 0$，这要求 $1-s_2 < 0 \\implies s_2 > 1$。\n        -   然后 $s_1 = \\frac{-s_2}{1-s_2} = \\frac{s_2}{s_2-1}$。\n        -   因此，对于双曲线 $s_1 = s_2/(s_2-1)$ 上的 $(s_1, s_2)$ 对，导数是未定义的。该双曲线在 $s_1=1, s_2=1$ 处有渐近线。\n        -   对于超显性（$w_{AA} < w_{Aa}$ 且 $w_{aa} < w_{Aa}$）的情况，这个问题是良态的。\n        -   $1 - s_1 < 1 \\implies s_1 > 0$。\n        -   $1 - s_2 < 1 \\implies s_2 > 0$。\n        -   这些是已知条件。所以这是一个杂合子优势的情景。\n        -   当且仅当存在杂合子优势时，才存在稳定的内部平衡。本题就是这种情况。因此，该平衡点*必须*是稳定的。我的推导应该反映这一点。\n        -   我将判断该问题为有效，并在该背景下根据选择系数的标准解释进行操作。问题的核心是数学推导，它并不严格依赖于 $s_1, s_2$ 的范围，但稳定性分析的解释依赖于此。\n\n3.  **最终答案的构建。**\n    -   问题要求提供一个包含 $p^*$ 和 $f'(p^*)$ 封闭形式表达式的行矩阵。\n    -   $p^* = \\frac{s_2}{s_1 + s_2}$\n    -   $f'(p^*) = \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2 - s_1 s_2}$\n    -   最终答案格式将是 `$$\\boxed{\\begin{pmatrix} \\frac{s_2}{s_1 + s_2} & \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2 - s_1 s_2} \\end{pmatrix}}$$`\n\n4.  **审查整个解答文本的正确性和格式。**\n    -   所有数学公式必须使用LaTeX。\n    -   无 markdown 标题。\n    -   从推导递归式开始。\n    -   然后求解平衡点。\n    -   最后，进行稳定性分析。\n    -   逻辑流程是合理的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{s_2}{s_1 + s_2} & \\frac{s_1 + s_2 - 2 s_1 s_2}{s_1 + s_2 - s_1 s_2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "掌握了理论之后，一项关键技能是检验真实群体是否符合哈迪-温伯格模型。这个问题将带你从理论走向实践，指导你完成HWE精确检验的计算，这在处理医学遗传学中常见的小样本或稀有等位基因时至关重要。这种亲手进行的统计分析将巩固你对HWE假设及其作为遗传研究中零模型的应用的理解。",
            "id": "5032375",
            "problem": "一个包含 $n = 10$ 个无关个体的二倍体群体样本，在一个具有等位基因 $A$ 和 $a$ 的双等位基因座上进行了基因分型。在哈迪-温伯格平衡（Hardy–Weinberg equilibrium, HWE）下，假设配子随机结合、无选择、无突变、无迁移且无选择性交配，基因型频率由等位基因 $A$ 的频率 $p$ 决定，分别为 $AA$ 的 $p^{2}$、$Aa$ 的 $2p(1-p)$ 和 $aa$ 的 $(1-p)^{2}$。观察到的基因型计数为 $n_{AA} = 3$、$n_{Aa} = 2$ 和 $n_{aa} = 5$。\n\n从第一性原理出发——即HWE的定义，将 $2n$ 个独立的基因拷贝随机配对成 $n$ 个无序的二倍体基因型——通过枚举所有与固定的等位基因 $A$ 总数一致的可能的无序配对，推导出基因型配置的精确条件分布。设 $m$ 表示观察到的等位基因 $A$ 拷贝的总数，设 $h$ 表示某一配置中杂合子 $Aa$ 的数量。使用这个条件分布（在以 $m$ 为条件后，该分布必须独立于 $p$）来：\n\n1. 在给定观察到的 $m$ 的情况下，枚举所有可行的 $h$ 值，并计算每种配置的精确概率。\n2. 通过将所有条件概率小于或等于观察到的配置的概率的配置的概率相加，计算用于检验HWE的精确 $p$ 值（基于概率的精确检验）。\n3. 在你的推导过程中，简要解释在医学遗传学中，什么条件下精确检验比卡方检验更受青睐。\n\n将最终的 $p$ 值表示为小数，并四舍五入到四位有效数字。不需要单位。",
            "solution": "用户提供了一个问题，在进行解答之前需要验证其前提。\n\n### 步骤 1：提取已知条件\n- 二倍体个体样本量：$n = 10$。\n- 基因座类型：双等位基因座，等位基因为 $A$ 和 $a$。\n- 模型：哈迪-温伯格平衡（HWE）。\n- HWE基因型频率：$P(AA) = p^2$，$P(Aa) = 2p(1-p)$，$P(aa) = (1-p)^2$，其中 $p$ 是等位基因 $A$ 的频率。\n- 观察到的基因型计数：$n_{AA} = 3$，$n_{Aa} = 2$，$n_{aa} = 5$。\n- 任务：推导在给定等位基因 $A$ 总数（用 $m$ 表示）的条件下，基因型配置的精确条件分布。设 $h$ 为杂合子 $Aa$ 的数量。\n- 任务：使用该分布枚举可行的 $h$ 值，计算其概率，并计算HWE检验的精确 $p$ 值。\n- 任务：简要解释在某些情况下精确检验优于卡方检验的原因。\n- 格式：最终的 $p$ 值应为小数形式，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学上合理**：该问题基于群体遗传学的基本原理，特别是哈迪-温伯格平衡及其使用精确检验的统计评估。所涉及的概念和模型是标准的、科学上合理的。\n- **定义明确**：问题定义清晰，提供了所有必要的数据。样本量 $n = 10$ 和基因型计数 $n_{AA}=3, n_{Aa}=2, n_{aa}=5$ 是一致的，因为 $3+2+5=10$。推导分布、枚举可能性和计算 $p$ 值的指示是具体的，并能导出一个唯一的、有意义的解。\n- **客观性**：问题使用精确的、定量的语言陈述，没有歧义或主观论断。\n\n该问题没有表现出任何诸如科学上不合理、信息缺失或逻辑矛盾等缺陷。这是一个群体遗传学统计中标准而严谨的练习题。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n该问题要求在给定观察到的等位基因数量的情况下，推导基因型计数的精确条件分布。这是适用于HWE的Fisher精确检验的基础。我们从指定的第一性原理开始。\n\n在HWE下，在一个大小为 $n$ 的样本中观察到一组特定基因型计数 $(n_{AA}, n_{Aa}, n_{aa})$ 的概率由多项分布给出：\n$$P(n_{AA}, n_{Aa}, n_{aa} | p) = \\frac{n!}{n_{AA}! n_{Aa}! n_{aa}!} (p^2)^{n_{AA}} (2p(1-p))^{n_{Aa}} ((1-p)^2)^{n_{aa}}$$\n设 $h = n_{Aa}$ 为杂合子数量。我们可以通过收集含 $p$ 和 $(1-p)$ 的项来重写该概率：\n$$P(n_{AA}, h, n_{aa} | p) = \\frac{n!}{n_{AA}! h! n_{aa}!} 2^h p^{2n_{AA}+h} (1-p)^{2n_{aa}+h}$$\n样本中等位基因 $A$ 的总数是 $m = 2n_{AA} + h$，等位基因 $a$ 的总数是 $2n - m = 2n_{aa} + h$。等位基因总数为 $2n$。将 $m$ 代入方程中：\n$$P(n_{AA}, h, n_{aa} | p) = \\frac{n!}{n_{AA}! h! n_{aa}!} 2^h p^m (1-p)^{2n-m}$$\nHWE的精确检验以观察到的等位基因计数 $(m, 2n-m)$ 为条件。这是通过将基因型配置的概率除以在 $2n$ 个总等位基因中观察到 $m$ 个等位基因 $A$ 拷贝的概率来实现的。样本中等位基因 $A$ 的数量 $m$ 服从参数为 $2n$ 和 $p$ 的二项分布：\n$$P(m | p) = \\binom{2n}{m} p^m (1-p)^{2n-m}$$\n在给定等位基因计数 $m$ 的情况下，基因型配置的条件概率为：\n$$P(n_{AA}, h, n_{aa} | n, m) = \\frac{P(n_{AA}, h, n_{aa} | p)}{P(m | p)} = \\frac{\\frac{n!}{n_{AA}! h! n_{aa}!} 2^h p^m (1-p)^{2n-m}}{\\binom{2n}{m} p^m (1-p)^{2n-m}}$$\n包含未知等位基因频率 $p$ 的项被消去，从而得到一个独立于 $p$ 的分布：\n$$P(n_{AA}, h, n_{aa} | n, m) = \\frac{n! \\, 2^h}{n_{AA}! h! n_{aa}! \\binom{2n}{m}}$$\n这就是精确条件分布。注意，在给定 $n$ 和 $m$ 的情况下，基因型计数由单个变量 $h$ 决定。纯合子的计数可以用 $h$ 来表示：\n$m = 2n_{AA} + h \\implies n_{AA} = \\frac{m - h}{2}$\n$n = n_{AA} + h + n_{aa} \\implies n_{aa} = n - h - n_{AA} = n - h - \\frac{m-h}{2} = n - \\frac{m+h}{2}$\n为了使 $n_{AA}$ 和 $n_{aa}$ 为非负整数，$h$ 必须与 $m$ 具有相同的奇偶性，并且 $h \\leq m$。\n\n现在我们将此应用于给定的数据。\n个体总数为 $n=10$。等位基因总数为 $2n=20$。\n观察到的基因型计数为 $n_{AA}=3, n_{Aa}=2, n_{aa}=5$。\n观察到的等位基因 $A$ 的数量为 $m = 2 \\times n_{AA} + n_{Aa} = 2 \\times 3 + 2 = 8$。\n观察到的杂合子数量为 $h_{obs} = 2$。\n\n**1. 枚举可行的 $h$ 值及其概率：**\n我们需要在给定 $n=10$ 和 $m=8$ 的情况下，找出所有可能的 $h$ 的整数值。\n$h$ 的约束条件是：\n- $h \\ge 0$\n- $n_{AA} = (8-h)/2 \\ge 0 \\implies h \\le 8$。\n- $n_{aa} = 10 - (8+h)/2 \\ge 0 \\implies 20 \\ge 8+h \\implies h \\le 12$。\n- $h$ 和 $m$ 必须具有相同的奇偶性。由于 $m=8$ 是偶数，所以 $h$ 必须是偶数。\n综合这些条件，$h$ 的可行值集合为 $\\{0, 2, 4, 6, 8\\}$。\n\n我们使用推导出的公式计算每个可行的 $h$ 的概率。首先，我们计算常数分母：\n$$D = \\binom{2n}{m} = \\binom{20}{8} = \\frac{20!}{8!12!} = \\frac{20 \\times 19 \\times \\dots \\times 13}{8 \\times 7 \\times \\dots \\times 1} = 125970$$\n对于给定的 $h$，其概率为 $P(h) = \\frac{N(h)}{D}$，其中 $N(h) = \\frac{10! \\cdot 2^h}{n_{AA}! h! n_{aa}!}$。\n\n- 当 $h=0$ 时：$n_{AA} = (8-0)/2 = 4$，$n_{aa} = 10-(8+0)/2 = 6$。\n$N(0) = \\frac{10!}{4!0!6!} 2^0 = \\binom{10}{4} = 210$。\n$P(h=0) = \\frac{210}{125970}$。\n\n- 当 $h=2$ 时（观察到的情况）：$n_{AA} = (8-2)/2 = 3$，$n_{aa} = 10-(8+2)/2 = 5$。\n$N(2) = \\frac{10!}{3!2!5!} 2^2 = 2520 \\times 4 = 10080$。\n$P(h=2) = \\frac{10080}{125970}$。\n\n- 当 $h=4$ 时：$n_{AA} = (8-4)/2 = 2$，$n_{aa} = 10-(8+4)/2 = 4$。\n$N(4) = \\frac{10!}{2!4!4!} 2^4 = 3150 \\times 16 = 50400$。\n$P(h=4) = \\frac{50400}{125970}$。\n\n- 当 $h=6$ 时：$n_{AA} = (8-6)/2 = 1$，$n_{aa} = 10-(8+6)/2 = 3$。\n$N(6) = \\frac{10!}{1!6!3!} 2^6 = 840 \\times 64 = 53760$。\n$P(h=6) = \\frac{53760}{125970}$。\n\n- 当 $h=8$ 时：$n_{AA} = (8-8)/2 = 0$，$n_{aa} = 10-(8+8)/2 = 2$。\n$N(8) = \\frac{10!}{0!8!2!} 2^8 = 45 \\times 256 = 11520$。\n$P(h=8) = \\frac{11520}{125970}$。\n\n（检验：$210+10080+50400+53760+11520 = 125970$。概率总和为 $1$。）\n\n**2. 计算精确 $p$ 值：**\n$p$ 值是所有条件概率小于或等于观察配置的条件概率的配置的概率之和。观察到的配置是 $h=2$，其概率为 $P_{obs} = P(h=2) = \\frac{10080}{125970}$。我们将所有满足 $P(h) \\le P_{obs}$ 的 $h$ 的概率相加。\n- $P(h=0) = \\frac{210}{125970} \\le P_{obs}$。此配置被包括在内。\n- $P(h=2) = \\frac{10080}{125970} \\le P_{obs}$。此配置被包括在内。\n- $P(h=4) = \\frac{50400}{125970} > P_{obs}$。此配置被排除。\n- $P(h=6) = \\frac{53760}{125970} > P_{obs}$。此配置被排除。\n- $P(h=8) = \\frac{11520}{125970} > P_{obs}$。此配置被排除。\n\n$p$ 值是 $h=0$ 和 $h=2$ 的概率之和：\n$$p\\text{-value} = P(h=0) + P(h=2) = \\frac{210}{125970} + \\frac{10080}{125970} = \\frac{10290}{125970}$$\n计算小数值：\n$$p\\text{-value} = \\frac{10290}{125970} \\approx 0.081686195$$\n四舍五入到四位有效数字，$p$ 值为 $0.08169$。\n\n**3. 在医学遗传学中精确检验优于卡方检验的原因：**\n用于HWE的卡方检验是渐近检验，意味着其有效性依赖于大样本量。卡方统计量被假定服从 $\\chi^2$ 分布，当期望的基因型计数较低时（一个常见的经验法则是期望计数小于5），这种近似会变得不准确。在医学遗传学中，尤其是在罕见病或罕见变异的研究中，两种情况常常导致期望计数较低：小样本量和低等位基因频率。对于一个罕见等位基因，即使在中等大小的样本中，罕见纯合子基因型以及可能的杂合子的期望计数也会非常小。在这些情况下，卡方近似会失效，得到的 $p$ 值可能不准确，从而导致I类错误率膨胀或统计功效降低。精确检验，如此处所执行的检验，不依赖于渐近近似。它们直接从数据的精确离散条件分布计算 $p$ 值。这保证了检验是正确校准的（即，I类错误率被控制在名义显著性水平上），使其在小样本或罕见等位基因的情况下（这在医学遗传学研究中很常见）成为检验HWE的首选和更可靠的方法。",
            "answer": "$$\\boxed{0.08169}$$"
        }
    ]
}