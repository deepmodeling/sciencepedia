{
    "hands_on_practices": [
        {
            "introduction": "通用数据模型（CDM）的核心价值在于实现语义互操作性，这要求将来自不同源系统的各种词汇表（如ICD-10-CM）映射到一个统一的标准词汇表（如SNOMED）。这个练习将引导您完成在OMOP CDM中进行词汇映射的规范流程，您将使用`CONCEPT`和`CONCEPT_RELATIONSHIP`表来完成这一关键任务。掌握这项技能对于执行正确的数据转换（ETL）至关重要，是确保来自不同来源的数据具有真正可比性的基石 。",
            "id": "4829300",
            "problem": "一个卫生系统正在将诊断数据从国际疾病分类第十版临床修订版 (ICD-10-CM) 标准化到观察性医疗结果合作通用数据模型 (OMOP CDM)，使用医学系统命名法—临床术语 (SNOMED CT) 作为疾病状况的标准词汇表。您的任务是解析出标准 SNOMED 概念标识符，并描述当映射产生多个有效目标时的正确处理方法。\n\n需要使用的基本定义和事实：\n- 在 OMOP CDM 中，`CONCEPT` 表存储记录，其属性包括 `concept_id` (OMOP 内部标识符)、`concept_code` (源词汇表代码)、`vocabulary_id` (概念所属的词汇表)、`standard_concept` (以 `'S'` 表示标准概念)、`valid_start_date`、`valid_end_date` 和 `invalid_reason` (如果有效则为 null)。\n- `CONCEPT_RELATIONSHIP` 表存储概念之间的关系，其属性包括 `concept_id_1` (源)、`concept_id_2` (目标)、`relationship_id`、`valid_start_date`、`valid_end_date` 和 `invalid_reason` (如果有效则为 null)。\n- 关系 `'Maps to'` 表示从一个非标准源概念到一个或多个标准目标概念的等效映射。方向是从 `concept_id_1` (源) 到 `concept_id_2` (标准目标)。标准疾病状况概念位于 `vocabulary_id` = 'SNOMED' 且 `standard_concept` = 'S'。\n- 有效性筛选要求 `invalid_reason` = NULL，并且对于给定的当前时间 $T$，满足 $valid\\_start\\_date \\le T \\le valid\\_end\\_date$。\n\n考虑 ICD-10-CM 代码 `E11.9`（“无并发症的2型糖尿病”）。您获得了足以确定映射关系的一致的概念和关系记录样本：\n- `CONCEPT` 表条目：\n  - 源：`concept_id` = 1001，`concept_code` = `E11.9`，`vocabulary_id` = `ICD10CM`，`standard_concept` = NULL，`invalid_reason` = NULL，且其有效期覆盖当前时间 $T$。\n  - 目标候选 1：`concept_id` = 2001，`concept_code` = `44054006`，`vocabulary_id` = `SNOMED`，`standard_concept` = 'S'，`invalid_reason` = NULL，且其有效期覆盖 $T$。\n  - 目标候选 2：`concept_id` = 2002，`concept_code` = `999999999`，`vocabulary_id` = `SNOMED`，`standard_concept` = 'S'，`invalid_reason` = 'D'，且其有效期不覆盖 $T$。\n- `CONCEPT_RELATIONSHIP` 表条目：\n  - `concept_id_1` = 1001，`concept_id_2` = 2001，`relationship_id` = 'Maps to'，`invalid_reason` = NULL，且其有效期覆盖 $T$。\n  - `concept_id_1` = 1001，`concept_id_2` = 2002，`relationship_id` = 'Maps to'，`invalid_reason` = 'D'，且其有效期不覆盖 $T$。\n\n任务：选择一个选项，该选项正确地规定了使用 `CONCEPT` 和 `CONCEPT_RELATIONSHIP` 表为 `E11.9` 解析标准 SNOMED 目标 `concept_id` 集合的方法，为上述样本数据确定了正确的解析结果集合，并说明了当存在多个有效的 'Maps to' 目标时的正确处理方式。\n\nA. 筛选 `CONCEPT` 表，通过匹配 `vocabulary_id` = 'ICD10CM' 和 `concept_code` = `E11.9` 来定位 ICD-10-CM 源，得到 `concept_id` = 1001。从 `CONCEPT_RELATIONSHIP` 表中，选择 `concept_id_1` = 1001、`relationship_id` = 'Maps to'、`invalid_reason` = NULL 且其有效期覆盖时间 $T$ 的记录。将这些目标与 `CONCEPT` 表连接，并仅保留 `vocabulary_id` = 'SNOMED'、 `standard_concept` = 'S' 且在时间 $T$ 有效的记录。样本的解析结果集合是 $\\{2001\\}$；如果存在多个有效目标，则保留所有目标，并将它们表示为多个标准化记录（每个目标一条），而不是任意选择一个。\n\nB. 在 ICD-10-CM 概念上使用 `CONCEPT_RELATIONSHIP` 表中的 `'Is a'` 关系来查找层级父级，然后在目标中选择最小的 `concept_id` 作为标准。样本的解析结果集合是 $\\{2002\\}$；如果存在多个目标，则选择 `concept_id` 最小的那个以确保确定性。\n\nC. 通过字符串相等直接将 ICD-10-CM 代码 `E11.9` 匹配到 SNOMED `concept_code` `44054006`，并将该代码视为 OMOP `concept_id`。样本的解析结果集合是 $\\{44054006\\}$；如果存在多个匹配项，则通过最长字符串长度选择最具体的那个。\n\nD. 使用 `'Maps to'`，但在 `concept_id_2` 上反向连接到 `concept_id_1` 来查找目标；忽略 `invalid_reason` 和有效期，以避免丢弃历史映射。样本的解析结果集合是 $\\{2001, 2002\\}$；如果存在多个有效目标，则通过选择数据中流行度最高的一个来合并为单一目标。",
            "solution": "任务是确定在观察性医疗结果合作通用数据模型 (OMOP CDM) 中，将国际疾病分类第十版临床修订版 (ICD-10-CM) 代码标准化为医学系统命名法—临床术语 (SNOMED CT) 概念的正确流程。这涉及识别正确的标准 `concept_id`，将该流程应用于代码 `E11.9` 的样本数据，并陈述处理一对多映射的一般规则。\n\n首先，让我们根据提供的定义和事实来形式化这个流程。设 $T$ 为当前时间。\n\n1.  **识别源概念**：我们从一个源词汇表 $v_{source}$ 的源代码 $c_{source}$ 开始。在本问题中，$c_{source} = 'E11.9'$ 且 $v_{source} = 'ICD10CM'$。我们必须在 `CONCEPT` 表中找到其对应的 `concept_id`。\n    - 我们查询 `CONCEPT` 表，寻找 `concept_code` = $c_{source}$ 和 `vocabulary_id` = $v_{source}$ 的记录。\n    - 根据样本数据，对于 `concept_code` = 'E11.9' 和 `vocabulary_id` = 'ICD10CM'，我们找到源概念的 `concept_id` = 1001。\n    - 问题陈述断言此源概念在时间 $T$ 是有效的，这与样本数据（`invalid_reason` = NULL 且其有效期覆盖 $T$）一致。源概念应为非标准概念，这与 `standard_concept` = NULL 相符。\n\n2.  **查找并筛选 'Maps to' 关系**：我们使用源 `concept_id`（即 $1001$）来查找与标准概念的映射。问题指明等效映射是 `'Maps to'`。\n    - 我们查询 `CONCEPT_RELATIONSHIP` 表，寻找 `concept_id_1` = 1001 且 `relationship_id` = 'Maps to' 的记录。\n    - 样本数据提供了两个这样的关系，分别指向 `concept_id_2` = 2001 和 `concept_id_2` = 2002。\n    - 我们必须对这些关系应用有效性筛选规则：`invalid_reason` = NULL 且 $valid\\_start\\_date \\le T \\le valid\\_end\\_date$。\n    - 对于到 `concept_id_2` = 2001 的关系：`invalid_reason` = NULL 且其有效期覆盖 $T$。此关系有效。\n    - 对于到 `concept_id_2` = 2002 的关系：`invalid_reason` = 'D'（通常表示 'Deprecated'，即已弃用）且其有效期不覆盖 $T$。此关系无效。\n    - 此步骤之后，唯一候选的目标概念由 `concept_id` = 2001 标识。\n\n3.  **验证目标概念**：最后一步是验证从有效关系中获得的目标概念本身是否是目标词汇表中的有效标准概念。目标词汇表是 SNOMED，标准概念用 `standard_concept` = 'S' 标记。\n    - 我们必须检查 `CONCEPT` 表中 `concept_id` = 2001 的记录。\n    - `concept_id` = 2001 的样本数据：`vocabulary_id` = 'SNOMED'，`standard_concept` = 'S'，`invalid_reason` = NULL，且其有效期覆盖 $T$。所有条件都满足。因此，`concept_id` = 2001 是一个有效的标准目标。\n    - 为了完整起见，我们可以检查无效的目标 `concept_id` = 2002。样本数据显示 `invalid_reason` = 'D' 且其有效期不覆盖 $T$。这个概念是无效的，这为其被排除提供了第二个理由。\n\n4.  **确定样本的解析结果集合**：基于对规则的逐步应用，源代码 `E11.9`（即 `concept_id` = 1001）的唯一有效标准目标是 `concept_id` = 2001。因此，解析结果集合是 $\\{2001\\}$。\n\n5.  **处理多个有效目标的一般规则**：OMOP 词汇表中的 `'Maps to'` 关系可以是一对多的。如果单个源概念映射到多个目标概念，并且所有这些关系和目标概念都是有效且标准的，那么正确的流程是保留所有这些目标。这是因为目标概念的集合共同代表了源概念的含义。任意选择一个会导致临床相关信息的丢失。在将数据加载到像 `CONDITION_OCCURRENCE` 这样的临床数据表时，这将导致为每个有效的标准目标概念创建一条记录。\n\n现在我们根据这个推导出的正确流程来评估每个选项。\n\n**A. 筛选 `CONCEPT` 表，通过匹配 `vocabulary_id` = 'ICD10CM' 和 `concept_code` = `E11.9` 来定位 ICD-10-CM 源，得到 `concept_id` = 1001。从 `CONCEPT_RELATIONSHIP` 表中，选择 `concept_id_1` = 1001、`relationship_id` = 'Maps to'、`invalid_reason` = NULL 且其有效期覆盖时间 $T$ 的记录。将这些目标与 `CONCEPT` 表连接，并仅保留 `vocabulary_id` = 'SNOMED'、 `standard_concept` = 'S' 且在时间 $T$ 有效的记录。样本的解析结果集合是 $\\{2001\\}$；如果存在多个有效目标，则保留所有目标，并将它们表示为多个标准化记录（每个目标一条），而不是任意选择一个。**\n- 所描述的流程与上面推导的正确方法完全匹配，包括对关系和目标概念的所有必要筛选步骤。\n- 确定的样本解析结果集合 $\\{2001\\}$ 是正确的。\n- 关于处理多个目标的陈述（保留所有）是正确的，并与 OMOP 的最佳实践一致。\n- **结论：正确**。\n\n**B. 在 ICD-10-CM 概念上使用 `CONCEPT_RELATIONSHIP` 表中的 `'Is a'` 关系来查找层级父级，然后在目标中选择最小的 `concept_id` 作为标准。样本的解析结果集合是 $\\{2002\\}$；如果存在多个目标，则选择 `concept_id` 最小的那个以确保确定性。**\n- 这个选项错误地建议使用 `'Is a'` 关系而不是 `'Maps to'`。$'Is a'$ 关系定义的是层级结构，通常在单个词汇表内部，而不是用于不同词汇表之间的映射。\n- 提议的决胜规则（最小的 `concept_id`）是随意的，不是有效的 OMOP 约定。\n- 确定的解析结果集合 $\\{2002\\}$ 是不正确的；样本数据中明确定义该概念是无效的。\n- **结论：不正确**。\n\n**C. 通过字符串相等直接将 ICD-10-CM 代码 `E11.9` 匹配到 SNOMED `concept_code` `44054006`，并将该代码视为 OMOP `concept_id`。样本的解析结果集合是 $\\{44054006\\}$；如果存在多个匹配项，则通过最长字符串长度选择最具体的那个。**\n- 这个选项犯了一个根本性错误，试图将一个词汇表中的 `concept_code` 与另一个词汇表中的 `concept_code` 进行匹配。OMOP 词汇表（特别是 `CONCEPT` 和 `CONCEPT_RELATIONSHIP`）的目的是提供一种结构化的方式，通过整数 `concept_id` 来执行这些映射。\n- 它还混淆了 `concept_code` 和 `concept_id`。解析结果集合 $\\{44054006\\}$ 是一个 SNOMED 代码，而不是一个 OMOP `concept_id`。\n- 决胜规则（“最长字符串长度”）是毫无根据的。\n- **结论：不正确**。\n\n**D. 使用 `'Maps to'`，但在 `concept_id_2` 上反向连接到 `concept_id_1` 来查找目标；忽略 `invalid_reason` 和有效期，以避免丢弃历史映射。样本的解析结果集合是 $\\{2001, 2002\\}$；如果存在多个有效目标，则通过选择数据中流行度最高的一个来合并为单一目标。**\n- 这个选项错误地建议忽略有效性筛选器（`invalid_reason` 和日期窗口）。这些筛选器对于确保所使用的映射是词汇表维护者定义的当前和正确的映射至关重要。使用已弃用或无效的映射会导致不正确的标准化。\n- 由于忽略了有效性，它错误地将无效概念 $2002$ 包含在解析结果集合中。\n- 处理多个目标的规则（根据数据流行度进行合并）是特定于研究的选择，而不是标准的 ETL 流程，并且会导致信息丢失。标准方法要求仅基于词汇表进行确定性映射。\n- **结论：不正确**。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在标准化单个数据记录之后，OMOP CDM的一个关键特性是能够从离散的事件记录中构建连续的“纪元”（Era）。这个过程将交易性的原始数据（例如单次的处方记录）转换为具有分析价值的纵向事件片段。本练习将通过一个具体案例，演示如何基于`days_supply`（用药天数）和`persistence_window`（持续窗口期）的规则，将多个`DRUG_EXPOSURE`（药物暴露）记录合并成一个`DRUG_ERA`（药物纪元）。理解这一过程对于开展关于治疗持续性、用药依从性以及与连续用药相关的临床结局研究至关重要。",
            "id": "4829283",
            "problem": "在观察性医疗结果合作项目 (OMOP) 通用数据模型 (CDM) 中，表 `DRUG_ERA` 是从 `DRUG_EXPOSURE` 派生而来的。一条 `DRUG_EXPOSURE` 记录包含一个开始日期和一个药品供应天数 (`days-supply`)，它定义了一个从其开始日期到根据药品供应天数计算出的包含性结束日期的暴露区间。一个 `DRUG_ERA` 是通过合并那些重叠或被不超过一个固定持续窗口期 (`persistence_window`) 的间隙所分隔的 `DRUG_EXPOSURE` 区间而形成的。考虑单个患者，其有三条针对同一成分的 `DRUG_EXPOSURE` 记录，相对于索引日期的起始日偏移量分别为 $0$、$25$ 和 $90$，每条记录的药品供应天数均为 $30$ 天。持续窗口期为 $30$ 天。\n\n从上述定义出发，并且不使用任何快捷公式，通过以下步骤推导出最终的 `DRUG_ERA` 区间：\n- 根据每个 `DRUG_EXPOSURE` 的起始日和药品供应天数构建其区间，以及\n- 应用持续窗口期规则来确定区间是否应合并成一个单独的 `DRUG_ERA`。\n\n将最终的 `DRUG_ERA` 起始日和结束日偏移量表示为精确整数，按时间顺序排列，并以单行矩阵的形式提供这四个数字 $(s_{1}, e_{1}, s_{2}, e_{2})$。无需四舍五入。报告相对于索引日期的日偏移量，以不带单位的纯整数形式呈现。",
            "solution": "问题陈述经评估为有效。它在科学上基于医学信息学标准——观察性医疗结果合作项目 (OMOP) 通用数据模型 (CDM) 的既定定义。该问题是适定的，提供了推导唯一逻辑解所需的所有数据和定义。语言客观，前提一致。\n\n任务是确定由单个患者和同一成分的三条 `DRUG_EXPOSURE` 记录产生的 `DRUG_ERA` 区间。推导过程必须遵循 OMOP CDM 定义的区间构建和合并的基本规则。\n\n所提供的数据如下：\n- 三条 `DRUG_EXPOSURE` 记录，其相对于索引日期的起始日偏移量为 $s_1 = 0$，$s_2 = 25$ 和 $s_3 = 90$。\n- 每条记录的 `days_supply` (药品供应天数) 为 $d = 30$ 天。\n- 用于合并的 `persistence_window` (持续窗口期) 为 $P = 30$ 天。\n\n首先，我们为每条 `DRUG_EXPOSURE` 记录构建区间。暴露区间包括其起始日和结束日。对于起始日为 $s$、供应天数为 $d$ 天的记录，其暴露覆盖从第 $s$ 天到第 $s + d - 1$ 天。因此，结束日 $e$ 为 $e = s + d - 1$。\n\n设 $E_1$、$E_2$ 和 $E_3$ 为三个 `DRUG_EXPOSURE` 区间。\n\n对于第一条记录，有 $s_1 = 0$ 和 $d = 30$：\n起始日为 $s_1 = 0$。\n结束日为 $e_1 = s_1 + d - 1 = 0 + 30 - 1 = 29$。\n因此，第一个暴露区间为 $E_1 = [0, 29]$。\n\n对于第二条记录，有 $s_2 = 25$ 和 $d = 30$：\n起始日为 $s_2 = 25$。\n结束日为 $e_2 = s_2 + d - 1 = 25 + 30 - 1 = 54$。\n因此，第二个暴露区间为 $E_2 = [25, 54]$。\n\n对于第三条记录，有 $s_3 = 90$ 和 $d = 30$：\n起始日为 $s_3 = 90$。\n结束日为 $e_3 = s_3 + d - 1 = 90 + 30 - 1 = 119$。\n因此，第三个暴露区间为 $E_3 = [90, 119]$。\n\n接下来，我们应用 `DRUG_ERA` 合并逻辑。一个 `DRUG_ERA` 是通过合并那些重叠或间隙小于等于持续窗口期的暴露区间而形成的。该过程按时间顺序执行。\n\n我们从第一个暴露区间 $E_1 = [0, 29]$ 开始，将其作为我们第一个 drug era 的初始片段。设正在构建的当前 era 为 $Era_{current}$。初始时，$Era_{current} = [0, 29]$。\n\n然后我们考虑下一个暴露区间 $E_2 = [25, 54]$。我们必须确定 $E_2$ 是否应与 $Era_{current}$ 合并。对于两个区间 $[s_A, e_A]$ 和 $[s_B, e_B]$（其中 $s_A \\le s_B$），如果它们之间的间隙（计算公式为 $g = s_B - e_A - 1$）满足条件 $g \\le P$，则它们可以合并。间隙为负数或零表示重叠或连续，这总是会导致合并。\n\n$E_2$ 的开始是 $s_2 = 25$，$Era_{current}$ 的结束是 $e_{current} = 29$。\n间隙为 $g_{1,2} = s_2 - e_{current} - 1 = 25 - 29 - 1 = -5$。\n持续窗口期为 $P=30$。合并条件为 $g_{1,2} \\le P$，即 $-5 \\le 30$。这是成立的。\n因此，$E_2$ 与当前 era 合并。新的合并后 era 从第一个区间的开始延伸到第二个区间的结束。\n更新后的 $Era_{current}$ 变为 $[s_1, e_2] = [0, 54]$。\n\n现在，我们考虑下一个暴露区间 $E_3 = [90, 119]$。我们检查 $E_3$ 是否应与当前 era $Era_{current} = [0, 54]$ 合并。\n$E_3$ 的开始是 $s_3 = 90$，$Era_{current}$ 的结束是 $e_{current} = 54$。\n间隙为 $g_{2,3} = s_3 - e_{current} - 1 = 90 - 54 - 1 = 35$。\n我们检查合并条件：$g_{2,3} \\le P$，即 $35 \\le 30$。这是不成立的。\n由于 $35$ 天的间隙超过了 $30$ 天的持续窗口期，因此 $E_3$ 不与当前 era 合并。\n\n这意味着第一个 drug era 已最终确定。其区间为 $Era_1 = [0, 54]$。\n一个新的 drug era, $Era_2$，以未合并的暴露区间 $E_3$ 开始。因此，$Era_2 = E_3 = [90, 119]$。\n由于没有更多的暴露记录，第二个 drug era $Era_2$ 也已最终确定。\n\n最终的 `DRUG_ERA` 区间是：\n- $Era_1$：起始日 $0$，结束日 $54$。\n- $Era_2$：起始日 $90$，结束日 $119$。\n\n问题要求以单行矩阵的形式提供最终答案，包含四个数字 $(s_{Era1}, e_{Era1}, s_{Era2}, e_{Era2})$。这些数字是 $(0, 54, 90, 119)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  54  90  119\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "使用通用数据模型的最终目标是支持稳健、大规模的临床研究。一旦数据在多个研究中心之间被成功协调并汇总，我们便可以开展强有力的流行病学分析。本练习模拟了一个真实的研究场景，您将运用统计学原理（如泊松过程），对来自一个假设的OMOP网络中的汇总数据（新发病例数和总人年数）进行处理，以估算疾病的发生率及其不确定性 。这项实践连接了数据建模与真实世界研究，展示了标准化数据如何催生可靠的科学证据。",
            "id": "4829313",
            "problem": "一个多机构临床研究网络已将其电子健康记录标准化为观测性医疗结果合作通用数据模型 (OMOP CDM)，并使用生物学与临床信息整合信息学 (i2b2) 来定义和分发一份跨研究中心的某种疾病新发病例的队列规范。每个研究中心贡献其新发病例数和累积人时数，该人时数通过在队列进入时排除现患病例，并累加直至首次新发事件、删失或观察结束时的观察时间来计算。经过质量控制和 OMOP 词汇协调后，该网络汇总了数据，在 $12,500$ 人年的随访中，共产生 $150$ 例新发病例。\n\n从发病率定义为单位人时内的事件数出发，并假设新发事件服从具有恒定风险的泊松过程，请利用泊松分布的性质推导出发病率的估计量及其近似抽样变异性。利用这些推导，根据汇总数据 $150$ 和 $12,500$，计算以每 $1,000$ 人年表示的发病率的 $95\\%$ 正态近似误差范围。\n\n将最终数值答案四舍五入至四位有效数字。以“每 $1,000$ 人年”为单位表示误差范围。最终答案必须是一个数字。",
            "solution": "对问题陈述的有效性进行评估。\n\n**步骤 1：提取已知信息**\n- 数据模型：观测性医疗结果合作通用数据模型 (OMOP CDM)。\n- 队列定义工具：生物学与临床信息整合信息学 (i2b2)。\n- 研究设计参数：某种疾病的新发病例。\n- 汇总数据：总计 $150$ 例新发病例。\n- 汇总数据：总计 $12,500$ 人年的随访。\n- 假设：新发事件服从具有恒定风险的泊松过程。\n- 任务：推导发病率的估计量。\n- 任务：推导发病率估计量的近似抽样变异性。\n- 任务：计算发病率的 $95\\%$ 正态近似误差范围。\n- 最终结果单位：每 $1,000$ 人年。\n- 数值精度：将最终答案四舍五入至四位有效数字。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学依据：** 该问题坚实地植根于流行病学和生物统计学领域。使用 OMOP 和 i2b2 是临床研究信息学中的标准实践。使用泊松分布对人时内的新发事件计数进行建模是生存分析和率估计中的一种基本且被广泛接受的方法。\n- **良态问题：** 这是一个良态问题。它提供了所有必要的数据（$150$ 例病例，$12,500$ 人年）和一个清晰的建模假设（泊松过程），足以推导出所要求的量并计算出唯一的数值答案。\n- **客观性：** 该问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n**步骤 3：结论与行动**\n- **结论：** 问题有效。它在科学上是合理的，是自洽的，也是良态的。\n- **行动：** 继续进行求解。\n\n**推导与计算**\n\n令 $N$ 为观测到的新发事件数，$T$ 为总累积人时。问题陈述事件服从一个具有恒定发病率（风险）$\\lambda$ 的泊松过程。对于一个总人时为 $T$ 的给定观察期，事件数 $N$ 服从均值为 $\\mu = \\lambda T$ 的泊松分布。\n观测到 $N=n$ 个事件的概率质量函数为：\n$$ P(N=n | \\lambda) = \\frac{(\\lambda T)^n e^{-\\lambda T}}{n!} $$\n对于固定的观测值 $n$，将此函数视为参数 $\\lambda$ 的函数，即为似然函数 $L(\\lambda; n)$。为了求出 $\\lambda$ 的最大似然估计量 (MLE)，我们最大化对数似然函数 $\\ln L(\\lambda)$：\n$$ \\ln L(\\lambda) = \\ln\\left(\\frac{(\\lambda T)^n e^{-\\lambda T}}{n!}\\right) = n \\ln(\\lambda T) - \\lambda T - \\ln(n!) $$\n$$ \\ln L(\\lambda) = n \\ln(\\lambda) + n \\ln(T) - \\lambda T - \\ln(n!) $$\n为了求最大值，我们对 $\\lambda$ 求一阶导数并令其为零：\n$$ \\frac{d}{d\\lambda} \\ln L(\\lambda) = \\frac{n}{\\lambda} - T = 0 $$\n解出 $\\lambda$ 即可得到 MLE，记为 $\\hat{\\lambda}$：\n$$ \\hat{\\lambda} = \\frac{n}{T} $$\n这就是发病率的估计量，即单位人时内的事件数，与问题的定义一致。\n\n接下来，我们推导该估计量的抽样变异性。MLE 的方差可以通过费雪信息 $I(\\lambda)$ 的倒数来近似。费雪信息是对数似然函数二阶导数的负期望值。\n二阶导数为：\n$$ \\frac{d^2}{d\\lambda^2} \\ln L(\\lambda) = -\\frac{n}{\\lambda^2} $$\n费雪信息为：\n$$ I(\\lambda) = -E\\left[\\frac{d^2}{d\\lambda^2} \\ln L(\\lambda)\\right] = -E\\left[-\\frac{N}{\\lambda^2}\\right] = \\frac{E[N]}{\\lambda^2} $$\n由于 $E[N] = \\lambda T$，我们有：\n$$ I(\\lambda) = \\frac{\\lambda T}{\\lambda^2} = \\frac{T}{\\lambda} $$\n估计量 $\\hat{\\lambda}$ 的方差近似为费雪信息的倒数：\n$$ \\text{Var}(\\hat{\\lambda}) \\approx [I(\\lambda)]^{-1} = \\frac{\\lambda}{T} $$\n我们可以通过用 MLE $\\hat{\\lambda}$ 替代真实参数 $\\lambda$ 来估计此方差：\n$$ \\widehat{\\text{Var}}(\\hat{\\lambda}) = \\frac{\\hat{\\lambda}}{T} = \\frac{(n/T)}{T} = \\frac{n}{T^2} $$\n估计量的标准误 (SE) 是估计方差的平方根：\n$$ \\text{SE}(\\hat{\\lambda}) = \\sqrt{\\widehat{\\text{Var}}(\\hat{\\lambda})} = \\sqrt{\\frac{n}{T^2}} = \\frac{\\sqrt{n}}{T} $$\n问题要求以每 $1,000$ 人年表示的发病率的误差范围。令 $\\lambda_{1k}$ 为每 $1,000$ 人年的发病率，则 $\\lambda_{1k} = 1000 \\times \\lambda$。\n这个重新标度后的率的估计量是 $\\hat{\\lambda}_{1k} = 1000 \\times \\hat{\\lambda} = 1000 \\frac{n}{T}$。\n这个重新标度后的估计量的标准误是：\n$$ \\text{SE}(\\hat{\\lambda}_{1k}) = \\text{SE}(1000 \\times \\hat{\\lambda}) = 1000 \\times \\text{SE}(\\hat{\\lambda}) = 1000 \\frac{\\sqrt{n}}{T} $$\n问题指定了一个 $95\\%$ 正态近似置信区间。该区间的误差范围 (ME) 由以下公式给出：\n$$ \\text{ME} = z_{\\alpha/2} \\times \\text{SE}(\\hat{\\lambda}_{1k}) $$\n对于 $95\\%$ 的置信水平，$\\alpha = 0.05$，因此 $\\alpha/2 = 0.025$。来自标准正态分布的相应临界值为 $z_{0.025} \\approx 1.96$。\n\n我们已知的汇总数据为：$n = 150$ 例新发病例和 $T = 12,500$ 人年。\n现在我们可以计算误差范围：\n$$ \\text{ME} = 1.96 \\times 1000 \\times \\frac{\\sqrt{150}}{12,500} $$\n$$ \\text{ME} = 1.96 \\times \\frac{\\sqrt{150}}{12.5} $$\n为简化计算：$\\sqrt{150} = \\sqrt{25 \\times 6} = 5\\sqrt{6}$。\n$$ \\text{ME} = 1.96 \\times \\frac{5\\sqrt{6}}{12.5} = 1.96 \\times \\frac{5\\sqrt{6}}{25/2} = 1.96 \\times \\frac{10\\sqrt{6}}{25} = 1.96 \\times \\frac{2\\sqrt{6}}{5} $$\n$$ \\text{ME} = 1.96 \\times 0.4 \\sqrt{6} = 0.784 \\sqrt{6} $$\n现在我们计算数值：\n$$ \\text{ME} \\approx 0.784 \\times 2.44948974 \\dots $$\n$$ \\text{ME} \\approx 1.920400... $$\n问题要求将最终答案四舍五入至四位有效数字。\n$$ \\text{ME} \\approx 1.920 $$\n这个值就是发病率的误差范围，单位是每 $1,000$ 人年的病例数。",
            "answer": "$$\\boxed{1.920}$$"
        }
    ]
}