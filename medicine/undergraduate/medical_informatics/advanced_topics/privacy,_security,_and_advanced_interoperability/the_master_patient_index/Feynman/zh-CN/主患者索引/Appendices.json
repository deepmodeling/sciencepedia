{
    "hands_on_practices": [
        {
            "introduction": "任何主患者索引 (MPI) 算法都不是完美的，因此我们需要量化的方法来评估其准确性。阳性预测值 ($PPV$) 和阴性预测值 ($NPV$) 是两个关键指标，它们告诉我们一个“匹配”或“不匹配”的决策在多大程度上是可信的。本练习将引导你从灵敏度、特异性和重复记录流行率等基本概念出发，推导出这些关键性能指标，并理解它们如何受到数据特征的影响 。",
            "id": "4861538",
            "problem": "一个医疗系统部署了一个主患者索引（MPI），用于检测和整合重复的患者记录。该 MPI 将每个候选记录对分类为重复（阳性）或非重复（阴性）。设算法敏感性为 $s \\in (0,1)$，定义为在记录对确实为重复的情况下，MPI 将其标记为重复的概率。设算法特异性为 $t \\in (0,1)$，定义为在记录对确实为非重复的情况下，MPI 将其标记为非重复的概率。假设在候选记录对中，真实重复的普遍率为 $p \\in (0,1)$。\n\n仅从敏感性、特异性、普遍率、全概率定律和贝叶斯定理的定义出发，推导阳性预测值（PPV）和阴性预测值（NPV）的闭式表达式。其中，PPV 定义为被标记为阳性的记录对确实为重复的概率，NPV 定义为被标记为阴性的记录对确实为非重复的概率。这两个值都应表示为 $s$、$t$ 和 $p$ 的函数。然后，通过计算每个值关于普遍率 $p$ 的偏导数的符号，来解析地确定这些值如何依赖于 $p$。\n\n请将您的最终答案以行矩阵的形式写成有序对 $\\big[\\mathrm{PPV}(s,t,p),\\ \\mathrm{NPV}(s,t,p)\\big]$。不需要数值近似或四舍五入。",
            "solution": "我们从敏感性、特异性和普遍率的定义开始，并使用全概率定律和贝叶斯定理来推导阳性预测值（PPV）和阴性预测值（NPV）。\n\n设真实状态为 $Y \\in \\{\\text{dup}, \\text{nondup}\\}$，其中 $P(Y=\\text{dup})=p$ 且 $P(Y=\\text{nondup})=1-p$。设 MPI 的测试结果为 $T \\in \\{\\text{pos}, \\text{neg}\\}$，其中 $T=\\text{pos}$ 表示 MPI 将候选记录对标记为重复，而 $T=\\text{neg}$ 表示将其标记为非重复。根据定义，\n- 敏感性 $s = P(T=\\text{pos} \\mid Y=\\text{dup})$。\n- 特异性 $t = P(T=\\text{neg} \\mid Y=\\text{nondup})$。\n因此，\n- 假阳性率为 $P(T=\\text{pos} \\mid Y=\\text{nondup}) = 1 - t$。\n- 假阴性率为 $P(T=\\text{neg} \\mid Y=\\text{dup}) = 1 - s$。\n\n使用全概率定律，得到阳性结果的边缘概率为\n$$\nP(T=\\text{pos}) = P(T=\\text{pos} \\mid Y=\\text{dup})P(Y=\\text{dup}) + P(T=\\text{pos} \\mid Y=\\text{nondup})P(Y=\\text{nondup}) = s\\,p + (1-t)(1-p).\n$$\n根据贝叶斯定理，阳性预测值（PPV）为\n$$\n\\mathrm{PPV} = P(Y=\\text{dup} \\mid T=\\text{pos}) = \\frac{P(T=\\text{pos} \\mid Y=\\text{dup})P(Y=\\text{dup})}{P(T=\\text{pos})} = \\frac{s\\,p}{s\\,p + (1-t)(1-p)}.\n$$\n\n类似地，阴性结果的边缘概率为\n$$\nP(T=\\text{neg}) = P(T=\\text{neg} \\mid Y=\\text{dup})P(Y=\\text{dup}) + P(T=\\text{neg} \\mid Y=\\text{nondup})P(Y=\\text{nondup}) = (1-s)p + t(1-p).\n$$\n根据贝叶斯定理，阴性预测值（NPV）为\n$$\n\\mathrm{NPV} = P(Y=\\text{nondup} \\mid T=\\text{neg}) = \\frac{P(T=\\text{neg} \\mid Y=\\text{nondup})P(Y=\\text{nondup})}{P(T=\\text{neg})} = \\frac{t(1-p)}{t(1-p) + (1-s)p}.\n$$\n\n接下来，我们通过对 $\\mathrm{PPV}$ 和 $\\mathrm{NPV}$ 分别关于 $p$ 求导，来分析它们对普遍率 $p$ 的依赖性。\n\n对于 $\\mathrm{PPV}(p) = \\dfrac{s\\,p}{s\\,p + (1-t)(1-p)}$，定义分母为\n$$\nD_{1}(p) = s\\,p + (1-t)(1-p) = (1-t) + p(s + t - 1).\n$$\n则\n$$\n\\frac{d}{dp}\\mathrm{PPV} = \\frac{d}{dp}\\left(\\frac{s\\,p}{D_{1}(p)}\\right) = \\frac{s\\,D_{1}(p) - s\\,p\\,D_{1}'(p)}{[D_{1}(p)]^{2}}.\n$$\n因为 $D_{1}'(p) = s + t - 1$，我们有\n$$\n\\frac{d}{dp}\\mathrm{PPV} = \\frac{s\\left[(1-t) + p(s + t - 1)\\right] - s\\,p(s + t - 1)}{\\left[(1-t) + p(s + t - 1)\\right]^{2}} = \\frac{s(1-t)}{\\left[(1-t) + p(s + t - 1)\\right]^{2}}.\n$$\n对于 $s \\in (0,1)$ 和 $t \\in (0,1)$，分子 $s(1-t)$ 是正的，分母是一个平方项，因此也是正的。因此，对于 $p \\in (0,1)$，有 $\\dfrac{d}{dp}\\mathrm{PPV} > 0$，这表明 $\\mathrm{PPV}$ 随着普遍率 $p$ 单调增加。\n\n对于 $\\mathrm{NPV}(p) = \\dfrac{t(1-p)}{t(1-p) + (1-s)p}$，定义分母为\n$$\nD_{2}(p) = t(1-p) + (1-s)p = t + p(1 - s - t).\n$$\n则\n$$\n\\frac{d}{dp}\\mathrm{NPV} = \\frac{d}{dp}\\left(\\frac{t(1-p)}{D_{2}(p)}\\right) = \\frac{-t\\,D_{2}(p) - t(1-p)\\,D_{2}'(p)}{[D_{2}(p)]^{2}}.\n$$\n因为 $D_{2}'(p) = 1 - s - t$，我们简化分子：\n$$\n-t\\,D_{2}(p) - t(1-p)\\,D_{2}'(p) = -t\\left[D_{2}(p) + (1-p)(1 - s - t)\\right].\n$$\n但是\n$$\nD_{2}(p) + (1-p)(1 - s - t) = \\left[t + p(1 - s - t)\\right] + (1-p)(1 - s - t) = t + (1 - s - t) = 1 - s.\n$$\n因此，\n$$\n\\frac{d}{dp}\\mathrm{NPV} = -\\frac{t(1 - s)}{\\left[t + p(1 - s - t)\\right]^{2}}.\n$$\n对于 $s \\in (0,1)$ 和 $t \\in (0,1)$，分子 $-t(1 - s)$ 是负的，分母是正的，所以对于 $p \\in (0,1)$，有 $\\dfrac{d}{dp}\\mathrm{NPV}  0$。因此，$\\mathrm{NPV}$ 随着普遍率 $p$ 单调减少。\n\n总之，推导出的闭式表达式为\n$$\n\\mathrm{PPV}(s,t,p) = \\frac{s\\,p}{s\\,p + (1-t)(1-p)}, \\quad \\mathrm{NPV}(s,t,p) = \\frac{t(1-p)}{t(1-p) + (1-s)p},\n$$\n其对 $p$ 的单调依赖性由以下公式刻画：\n$$\n\\frac{d}{dp}\\mathrm{PPV} = \\frac{s(1-t)}{\\left[(1-t) + p(s + t - 1)\\right]^{2}}  0, \\quad \\frac{d}{dp}\\mathrm{NPV} = -\\frac{t(1 - s)}{\\left[t + p(1 - s - t)\\right]^{2}}  0,\n$$\n对于 $s \\in (0,1)$，$t \\in (0,1)$ 和 $p \\in (0,1)$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{s\\,p}{s\\,p + (1-t)(1-p)}  \\frac{t(1-p)}{t(1-p) + (1-s)p}\\end{pmatrix}}$$"
        },
        {
            "introduction": "将理论付诸实践，现实世界中的 MPI 系统通常采用三区模型（自动匹配、自动非匹配、人工审核）来处理记录对。这个练习模拟了一个核心的运营任务：如何设置分数阈值，以在满足监管机构对错误匹配和错误不匹配率要求的同时，平衡不同类型的风险。通过这个练习，你将学会如何将抽象的策略要求转化为具体的系统参数 。",
            "id": "4861608",
            "problem": "一个卫生系统运行着一个主患者索引（MPI），该索引通过比较患者记录对来检测重复记录。每个候选记录对都由一个经过验证的链接模型分配一个在区间 $[0,1]$ 上的相似度分数 $s$。为了控制操作风险，该系统使用两个阈值：一个下阈值 $L$，低于该阈值的记录对被自动分类为不匹配（不创建链接）；一个上阈值 $U$，高于该阈值的记录对被自动分类为匹配（创建链接）。相似度分数 $s \\in (L,U)$ 的记录对被送入人工审核队列。\n\n监管机构对自动决策施加了约束：错误匹配率（FMR），定义为真实不匹配的记录对被自动分类为匹配的概率，不得超过小数水平 $\\alpha$；以及错误不匹配率（FNMR），定义为真实匹配的记录对被自动分类为不匹配的概率，不得超过小数水平 $\\beta$。只有自动决策受这些约束的限制；被送往人工审核的记录对不在这些约束的范围之内。\n\n假设真实匹配的相似度分数 $S_{M}$ 近似服从均值为 $\\mu_{M}$、方差为 $\\sigma_{M}^{2}$ 的正态分布，而真实不匹配的相似度分数 $S_{N}$ 近似服从均值为 $\\mu_{N}$、方差为 $\\sigma_{N}^{2}$ 的正态分布。该MPI的模型校准给出 $S_{M} \\sim \\mathcal{N}(\\mu_{M},\\sigma_{M}^{2})$，其中 $\\mu_{M} = 0.82$ 且 $\\sigma_{M} = 0.06$；以及 $S_{N} \\sim \\mathcal{N}(\\mu_{N},\\sigma_{N}^{2})$，其中 $\\mu_{N} = 0.50$ 且 $\\sigma_{N} = 0.10$。监管机构规定 $\\alpha = 0.01$ 且 $\\beta = 0.02$。\n\n从错误匹配率和错误不匹配率的正式定义以及正态分布的累积分布函数出发，推导满足监管机构对自动分类约束的阈值 $L$ 和 $U$ 的表达式。然后计算 $L$ 和 $U$ 的数值。将两个阈值都四舍五入到四位有效数字。不需要单位。按顺序分别提供最终的阈值 $L$ 和 $U$。",
            "solution": "该问题陈述清晰，具有科学依据，并包含推导阈值 $L$ 和 $U$ 唯一解所需的所有信息。它基于应用于医学信息学的统计决策理论的标准原理。\n\n首先，我们根据所提供的定义和数据来形式化该问题。\n真实匹配的相似度分数 $S_{M}$ 服从正态分布 $\\mathcal{N}(\\mu_{M}, \\sigma_{M}^{2})$，其均值为 $\\mu_{M} = 0.82$，标准差为 $\\sigma_{M} = 0.06$。\n真实不匹配的相似度分数 $S_{N}$ 服从正态分布 $\\mathcal{N}(\\mu_{N}, \\sigma_{N}^{2})$，其均值为 $\\mu_{N} = 0.50$，标准差为 $\\sigma_{N} = 0.10$。\n\n自动决策的分类规则如下：\n- 如果分数 $s \\le L$，则该记录对为不匹配。\n- 如果分数 $s \\ge U$，则该记录对为匹配。\n- 如果分数 $s \\in (L, U)$，则该记录对被送往人工审核。\n\n监管约束仅针对自动决策定义：\n1.  错误匹配率（FMR）不得超过 $\\alpha = 0.01$。FMR 是指一个真实不匹配（分数来自 $S_N$）的记录对被自动分类为匹配（分数 $\\ge U$）的概率。\n    $$ \\text{FMR} = P(S_{N} \\ge U) \\le \\alpha $$\n2.  错误不匹配率（FNMR）不得超过 $\\beta = 0.02$。FNMR 是指一个真实匹配（分数来自 $S_M$）的记录对被自动分类为不匹配（分数 $\\le L$）的概率。\n    $$ \\text{FNMR} = P(S_{M} \\le L) \\le \\beta $$\n\n为了满足这些约束，我们将概率设定在其边界值上。这一选择对应于最小化人工审核区间 $(L, U)$ 的大小，这是一个理想的操作目标。这要求在遵守约束的同时，使 $L$ 尽可能大，使 $U$ 尽可能小。\n\n我们首先推导下阈值 $L$ 的表达式。对 $L$ 的约束由FNMR给出。为了找到 $L$ 的最大允许值，我们将概率设为其极限值：\n$$ P(S_{M} \\le L) = \\beta $$\n为了求解 $L$，我们将正态变量 $S_{M}$ 标准化。设 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$ P\\left(\\frac{S_{M} - \\mu_{M}}{\\sigma_{M}} \\le \\frac{L - \\mu_{M}}{\\sigma_{M}}\\right) = \\beta $$\n设 $\\Phi(\\cdot)$ 为标准正态分布的累积分布函数（CDF）。该表达式变为：\n$$ \\Phi\\left(\\frac{L - \\mu_{M}}{\\sigma_{M}}\\right) = \\beta $$\n为了分离出 $L$，我们应用逆标准正态CDF，或称分位数函数 $\\Phi^{-1}(\\cdot)$：\n$$ \\frac{L - \\mu_{M}}{\\sigma_{M}} = \\Phi^{-1}(\\beta) $$\n求解 $L$，我们得到通用表达式：\n$$ L = \\mu_{M} + \\sigma_{M} \\Phi^{-1}(\\beta) $$\n\n接下来，我们推导上阈值 $U$ 的表达式。对 $U$ 的约束由FMR给出。为了找到 $U$ 的最小允许值，我们将概率设为其极限值：\n$$ P(S_{N} \\ge U) = \\alpha $$\n使用CDF更为方便，因此我们使用补集法则：\n$$ 1 - P(S_{N}  U) = \\alpha $$\n对于像正态分布这样的连续分布，$P(S_{N}  U) = P(S_{N} \\le U)$。\n$$ P(S_{N} \\le U) = 1 - \\alpha $$\n现在，我们将正态变量 $S_{N}$ 标准化：\n$$ P\\left(\\frac{S_{N} - \\mu_{N}}{\\sigma_{N}} \\le \\frac{U - \\mu_{N}}{\\sigma_{N}}\\right) = 1 - \\alpha $$\n使用标准正态CDF：\n$$ \\Phi\\left(\\frac{U - \\mu_{N}}{\\sigma_{N}}\\right) = 1 - \\alpha $$\n应用逆CDF，$\\Phi^{-1}(\\cdot)$：\n$$ \\frac{U - \\mu_{N}}{\\sigma_{N}} = \\Phi^{-1}(1 - \\alpha) $$\n求解 $U$，我们得到通用表达式：\n$$ U = \\mu_{N} + \\sigma_{N} \\Phi^{-1}(1 - \\alpha) $$\n\n现在我们使用给定的参数计算 $L$ 和 $U$ 的数值：\n$\\mu_{M} = 0.82$，$\\sigma_{M} = 0.06$，$\\beta = 0.02$。\n$\\mu_{N} = 0.50$，$\\sigma_{N} = 0.10$，$\\alpha = 0.01$。\n\n对于下阈值 $L$：\n$$ L = 0.82 + 0.06 \\times \\Phi^{-1}(0.02) $$\n标准正态分位数 $\\Phi^{-1}(0.02)$ 的值约为 $-2.0537$。\n$$ L \\approx 0.82 + 0.06 \\times (-2.0537) $$\n$$ L \\approx 0.82 - 0.123222 $$\n$$ L \\approx 0.696778 $$\n四舍五入到四位有效数字，我们得到 $L = 0.6968$。\n\n对于上阈值 $U$：\n$$ U = 0.50 + 0.10 \\times \\Phi^{-1}(1 - 0.01) = 0.50 + 0.10 \\times \\Phi^{-1}(0.99) $$\n标准正态分位数 $\\Phi^{-1}(0.99)$ 的值约为 $2.3263$。\n$$ U \\approx 0.50 + 0.10 \\times 2.3263 $$\n$$ U \\approx 0.50 + 0.23263 $$\n$$ U \\approx 0.73263 $$\n四舍五入到四位有效数字，我们得到 $U = 0.7326$。\n\n得出的阈值为 $L=0.6968$ 和 $U=0.7326$。由于 $L  U$，人工审核区间 $(0.6968, 0.7326)$ 是明确定义的。两个值都位于分数范围 $[0, 1]$ 内。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.6968  0.7326 \\end{pmatrix}} $$"
        },
        {
            "introduction": "本章的最后一个练习探讨了当系统出错时我们该如何应对。本练习通过一个真实的场景，探讨了当发生“叠加”（即两个不同患者的数据被错误合并）这一严重错误时，如何进行补救。你将学习到，纠正这类身份错误不仅仅是技术操作，更是一个涉及法律、健康信息管理 (HIM) 和计费合规性的复杂工作流程 。",
            "id": "4861551",
            "problem": "一家医院使用主患者索引（MPI）来确保每个人在各个系统中都拥有单一、独特的身份。MPI 覆盖被定义为将两个不同个体的临床和人口统计数据错误地合并到一个身份中，这可能导致不正确的临床文档和计费归属。法律医疗记录的不可变性原则规定，一旦临床条目最终确定，就不能删除或更改；更正必须通过记录在案的修正案来处理，这些修正案保留原始内容、作者身份和时间戳，并由审计追踪支持。健康信息管理（HIM）学科将身份更正视为一种记录分割活动，其中必须保留来源和审计完整性。考虑以下情景。两名姓名和出生日期相似的患者，记为 $P_A$ 和 $P_B$，在登记时被覆盖，导致 $P_B$ 的入院就诊记录被附加到 $P_A$ 的病历号（MRN）$M_X$ 下。出院后，当 $P_A$ 查询一份显示其未接受服务的福利说明时，该机构发现了这一覆盖问题。医院已经以 $M_X$ 为该次出院提交了索赔，并且住院电子健康记录（EHR）中包含了关于此次错误归属的提供者记录、医嘱、诊断结果以及编码的诊断和操作。该机构必须在保护法律医疗记录的同时纠正临床文档和计费，通知受影响的下游系统，并防止再次发生。从上述核心定义和原则出发，哪个选项最能描述一个科学合理且合法合规的步骤序列，以纠正这种出院后的覆盖问题并恢复正确的归属？\n\nA. 立即为 $P_A$ 创建一个新的 MRN，将所有历史数据移至新的 MRN 下，从原始记录中删除不正确的条目以避免混淆，保持已提交的索赔不变以减少与付款方的摩擦，并且仅通知内部部门以最大限度地减少外部披露。\n\nB. 执行 MPI 反向合并（覆盖分离）以重新分割记录，为大部分历史数据正确归属的真实身份保留 $M_X$，如果需要，为被错误归属的患者 $P_B$ 分配一个独立的 MRN $M_Y$，并使用 HIM 管理的修正工作流程添加附录，以澄清原始作者、时间戳和正确的患者归属，而不删除任何条目。通过将医嘱、结果和提供者记录重新分配给正确的身份来核对就诊级别的文件，同时保留审计追踪；更新编码以反映正确的患者和就诊事件；撤回错误的索赔，并在正确的 MRN 下重新提交更正后的索赔；通过身份更正消息通知付款方、任何健康信息交换（HIE）和下游系统；执行根本原因分析并实施登记控制，以降低未来发生覆盖的风险。\n\nC. 将两名患者永久合并到一个 MRN 中以确保连续性，在图表中记录一个简短的免责声明说明身份问题，更新出院小结以反映两个姓名，保持原始账单不变以避免合规性审计，并稍后运行批处理作业来修复任何下游不匹配。\n\nD. 使用软删除标志隐藏错误的临床条目，以便提供者看不到它们，覆盖作者和时间戳以匹配正确的患者，用更正后的人口统计信息重新提交索赔，但不通知付款方先前的错误，并避免向外部 HIE 发送身份更新以将问题控制在组织内部。\n\n在检测到出院后覆盖后，选择与 MPI 身份管理、法律医疗记录的不可变性和修正、审计追踪完整性以及合规的收入周期更正相符的唯一最佳选项。",
            "solution": "核心定义和原则构成了纠正策略的基础。主患者索引（MPI）是用于唯一患者识别的记录系统。覆盖是指两个不同的身份被错误地合并到一个标识符下，导致临床和财务事件的错误归属。法律医疗记录受不可变性原则的约束：最终确定的条目不能被删除或更改；更正必须是通过明确的修正案来进行，这些修正案保留了原始内容、作者身份和时间戳，并带有可审计的来源追溯。健康信息管理（HIM）实践要求身份更正必须通过分割和重新分配来执行，而不是销毁数据，而收入周期合规性要求撤回错误的索赔，并在正确的身份下重新提交更正后的索赔，并通知付款方。下游系统，包括健康信息交换（HIE）的参与者，必须接收身份更正消息以保持一致性。\n\n基于这些原则，纠正措施必须满足几个约束条件：首先，通过重新分割记录来打破覆盖，使每个个体都有一个独立的MRN；其次，通过保留所有原始条目并应用HIM管理的修正案和附录来保护法律医疗记录，绝不删除或覆盖；第三，在保持审计追踪完整的同时，将就诊级别的产物（医嘱、结果、记录）重新分配给正确的身份；第四，通过撤回错误的索赔并在正确的MRN下重新提交，并与付款方沟通来更正编码和计费；第五，向所有下游系统传播身份更正信息以保持一致性；第六，执行根本原因分析并加强登记身份控制以防止再次发生。\n\n逐个选项分析：\n\nA. 此选项建议立即为 $P_A$ 创建一个新的 MRN，移动所有历史数据，删除不正确的条目，保持已提交的索赔不变，并将披露限制在内部部门。删除不正确的条目违反了法律医疗记录的不可变性原则，因为最终确定的内容不能被移除；它必须通过保留来源的修正案来更正。保持已提交的索赔不变会使错误的计费归属永久化，并且不符合收入周期更正的要求。将披露限制在内部部门忽略了通知付款方和下游系统以统一身份的必要性。结论：不正确。\n\nB. 此选项使用 MPI 反向合并（覆盖分离）来重新分割记录，为拥有大部分历史数据的正确身份保留 $M_X$，并在必要时为 $P_B$ 分配一个独立的 MRN $M_Y$，同时应用 HIM 管理的修正工作流程添加附录以澄清错误归属，保留作者身份和时间戳。它详细说明了将医嘱、结果和记录重新分配给正确的身份并保持审计追踪完整；更新编码；撤回错误的索赔并在正确的 MRN 下重新提交更正后的索赔；通知付款方和包括 HIE 在内的下游系统；以及执行根本原因分析并实施登记控制。此序列符合 MPI 身份管理原则、法律医疗记录的不可变性、审计追踪的保留、合规的收入周期更正以及全系统的一致性。结论：正确。\n\nC. 此选项建议将两名患者永久合并到一个 MRN 中，记录一个免责声明，更新出院小结以反映两个姓名，保持原始账单不变，并稍后修复下游的不匹配。永久合并不同的身份违反了 MPI 的唯一性原则并使错误归属永久化；免责声明既不满足修正案的要求，也无法更正身份错误。保持账单不变不符合合规性要求，推迟下游更正有传播错误的风险。结论：不正确。\n\nD. 此选项建议通过软删除隐藏错误的条目，覆盖作者身份和时间戳，重新提交索赔而不通知付款方先前的错误，并避免 HIE 更新。软删除和覆盖来源信息违反了法律医疗记录的不可变性和审计追踪的完整性。不通知付款方和 HIE 会破坏合规性和系统性的身份统一。结论：不正确。\n\n因此，基于 MPI 身份管理的基本定义、法律医疗记录的不可变性和修正流程、审计追踪的保留以及收入周期更正的要求，最佳答案是选项 B。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}