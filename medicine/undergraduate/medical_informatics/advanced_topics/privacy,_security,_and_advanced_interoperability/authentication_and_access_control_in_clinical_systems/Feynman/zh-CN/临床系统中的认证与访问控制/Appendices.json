{
    "hands_on_practices": [
        {
            "introduction": "临床系统安全的第一道防线通常是密码认证。然而，“强密码”不仅仅是一个模糊的概念；我们可以使用信息论中的“熵”来精确地量化其强度。本练习将指导您从基本原理出发，计算密码的熵和被猜测的概率，从而将抽象的安全概念转化为具体的、可衡量的指标 。",
            "id": "4823140",
            "problem": "一家医院的电子健康记录 (EHR) 系统通过其身份提供者 (IdP) 强制执行一项密码策略，该 IdP 使用一个密码学安全生成器来发放密码，以确保在所有允许的密码中实现均匀随机性。每个密码的长度正好是 $C$ 个字符，并且每个位置的字符都是从一个允许的字母表中独立选择的。在此临床认证设置中，假设允许的字母表由大写字母、小写字母和数字组成。因此，总的字母表大小为 $A$，等于大写字母、小写字母和数字的数量之和。一个在线攻击者对一个随机分配的用户密码进行一次盲猜。\n\n仅使用有限等可能样本空间的离散概率第一性原理和离散随机变量的 Shannon 熵定义，推导在此策略下攻击者单次猜测的预期成功概率的表达式，以及均匀生成的密码的熵（以比特为单位）。然后根据以下策略参数计算这些值：字母表大小 $A=62$（26个大写字母，26个小写字母，10个数字）和密码长度 $C=10$。\n\n提供：\n- 预期单次猜测成功概率（以小数形式表示），以及\n- 熵（以比特为单位）。\n\n将两个量都四舍五入到四位有效数字。熵以比特表示。概率不要使用百分号。",
            "solution": "该问题要求推导和计算与密码策略相关的两个量：攻击者的预期单次猜测成功概率，以及密码空间的 Shannon 熵。推导必须从第一性原理出发。\n\n**问题阐述**\n设 $C$ 为密码长度， $A$ 为选择字符的字母表的大小。\n问题陈述，密码中的 $C$ 个字符中的每一个都是从大小为 $A$ 的字母表中独立且均匀地选择的。\n\n给定参数为：\n- 密码长度，$C = 10$。\n- 字母表大小，$A = 62$。这由26个大写字母、26个小写字母和10个数字组成。\n\n**1. 预期单次猜测成功概率的推导**\n\n所有可能密码的集合构成了样本空间，我们将其表示为 $S$。由于密码中的 $C$ 个位置中的每一个都可以由 $A$ 个字符中的任意一个独立填充，因此唯一密码的总数就是样本空间的大小 $|S|$。根据计数中的乘法原理，这是：\n$$|S| = A \\times A \\times \\cdots \\times A \\text{ ($C$ times)} = A^C$$\n\n问题陈述密码生成器是“密码学安全的”并确保“均匀随机性”。这意味着样本空间 $S$ 中的每个密码被分配给用户的可能性是相等的。这就建立了一个有限等可能样本空间。任何特定密码 $p_i \\in S$ 是正确密码的概率为：\n$$P(p_i) = \\frac{1}{|S|} = \\frac{1}{A^C}$$\n\n一个在线攻击者进行一次“盲猜”。这意味着攻击者从所有可能的密码空间中选择一个密码并进行测试。这次猜测的成功与否取决于所选密码是否与用户的分配密码匹配。由于用户的密码是从 $S$ 中均匀随机选择的，攻击者的单次猜测正确的概率恰好是空间中任何单个密码的概率。设 $P_{\\text{success}}$ 表示这个概率。\n$$P_{\\text{success}} = \\frac{1}{|S|} = \\frac{1}{A^C} = A^{-C}$$\n\n**2. 密码熵的推导**\n\n对于一个具有可能结果集 $\\{x_1, x_2, \\ldots, x_N\\}$ 和概率质量函数 $p(x_i) = P(X=x_i)$ 的离散随机变量 $X$，其 Shannon 熵 $H(X)$ 定义为：\n$$H(X) = -\\sum_{i=1}^{N} p(x_i) \\log_b(p(x_i))$$\n为了使结果以比特为单位，对数的底 $b$ 必须为 $2$。\n\n在这个问题中，随机变量 $X$ 代表密码。可能结果的数量是 $N = |S| = A^C$。概率分布是均匀的，所以任何单个密码 $x_i$ 的概率是：\n$$p(x_i) = \\frac{1}{A^C}$$\n将此代入熵公式：\n$$H(X) = -\\sum_{i=1}^{A^C} \\left(\\frac{1}{A^C}\\right) \\log_2\\left(\\frac{1}{A^C}\\right)$$\n求和号内的项是一个常数，所以我们可以用项数 $A^C$ 的乘法来代替求和：\n$$H(X) = -A^C \\cdot \\left(\\frac{1}{A^C}\\right) \\log_2\\left(\\frac{1}{A^C}\\right)$$\n$$H(X) = -\\log_2\\left(A^{-C}\\right)$$\n使用对数幂法则 $\\log(x^y) = y \\log(x)$：\n$$H(X) = -(-C \\log_2(A)) = C \\log_2(A)$$\n这个表达式给出了密码的 Shannon 熵，单位是比特。\n\n**3. 数值计算**\n\n问题提供了具体参数 $A=62$ 和 $C=10$。我们将这些值代入推导出的表达式中。\n\n- **预期单次猜测成功概率：**\n$$P_{\\text{success}} = A^{-C} = 62^{-10}$$\n为了计算这个值，我们计算：\n$$P_{\\text{success}} = \\frac{1}{62^{10}} = \\frac{1}{839299365868340224}$$\n$$P_{\\text{success}} \\approx 1.19149216 \\times 10^{-18}$$\n按要求四舍五入到四位有效数字：\n$$P_{\\text{success}} \\approx 1.191 \\times 10^{-18}$$\n\n- **密码熵（以比特为单位）：**\n$$H = C \\log_2(A) = 10 \\log_2(62)$$\n为了计算以2为底的对数，我们可以使用换底公式 $\\log_b(x) = \\frac{\\ln(x)}{\\ln(b)}$：\n$$H = 10 \\frac{\\ln(62)}{\\ln(2)}$$\n使用数值 $\\ln(62) \\approx 4.127134385$ 和 $\\ln(2) \\approx 0.693147180$：\n$$H \\approx 10 \\times \\frac{4.127134385}{0.693147180} \\approx 10 \\times 5.95419631$$\n$$H \\approx 59.5419631 \\text{ bits}$$\n按要求四舍五入到四位有效数字：\n$$H \\approx 59.54 \\text{ bits}$$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.191 \\times 10^{-18} & 59.54 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在医疗保健中，访问控制规则有时必须为紧急情况破例，即所谓的“紧急破窗”机制。这在保障患者安全和保护隐私之间造成了微妙的权衡。本练习将引导您应用统计决策理论和效用函数，在一个模拟的紧急访问场景中，量化这种权衡并找到最佳决策阈值 。",
            "id": "4823107",
            "problem": "一家医院在其电子健康记录系统中部署了一种实时的“打破玻璃”机制，以允许紧急访问。每个“打破玻璃”请求都由一个校准的风险模型进行评分，该模型输出一个标量风险得分 $R \\in \\mathbb{R}$。令 $E \\in \\{0,1\\}$ 表示情况是否为真实紧急情况 ($E=1$) 或不是 ($E=0$)。历史验证表明该得分的概率模型如下：\n- $R \\mid E=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$，其中 $\\mu_{1} = 1.5$ 且 $\\sigma = 0.6$。\n- $R \\mid E=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，其中 $\\mu_{0} = 0.5$ 且 $\\sigma$ 相同，为 $0.6$。\n\n在“打破玻璃”尝试中，真实紧急情况的先验概率为 $p = 0.1$。该医院使用基于以下结果效用的单次决策期望效用，来形式化其在患者安全与隐私之间的权衡：\n- 在真实紧急情况下允许访问（真阳性）产生的效用为 $b_{e} = 100$。\n- 在真实紧急情况下拒绝访问（假阴性）会造成 $h_{e} = 300$ 的损失，因此其效用为 $-h_{e}$。\n- 在并非真实紧急情况下允许访问（假阳性）会造成 $h_{p} = 20$ 的隐私损失，因此其效用为 $-h_{p}$。\n- 在并非真实紧急情况下拒绝访问（真阴性）是基准情况，效用为 $0$。\n\n策略必须是“如果 $R \\ge t$ 则允许，否则拒绝”形式的分数阈值。为满足与《健康保险流通与责任法案》(HIPAA) 一致的内部政策，假阳性率必须满足监管约束 $\\Pr(\\text{allow} \\mid E=0) \\le \\beta$，其中 $\\beta = 0.02$。\n\n仅从期望效用、贝叶斯法则和给定高斯模型的定义出发，推导出在满足监管约束的条件下使期望效用最大化的阈值 $t^{\\star}$，然后计算其数值。将最优阈值 $t^{\\star}$ 报告为无单位的风险得分。将您的答案四舍五入到 $4$ 位有效数字。",
            "solution": "首先将验证问题的科学合理性、自洽性和清晰度。如果问题被认为是有效的，将推导一个完整的解。\n\n### 第1步：提取已知条件\n问题陈述中提供的数据和定义如下：\n- 一个标量风险得分 $R \\in \\mathbb{R}$。\n- 一个二元变量 $E \\in \\{0, 1\\}$，表示是真实紧急情况 ($E=1$) 或不是 ($E=0$)。\n- 风险得分 $R$ 在给定紧急状态 $E$ 下的条件概率分布：\n  - 对于真实紧急情况 ($E=1$)：$R \\mid E=1 \\sim \\mathcal{N}(\\mu_{1}, \\sigma^{2})$，其中均值为 $\\mu_{1} = 1.5$，标准差为 $\\sigma = 0.6$。\n  - 对于非紧急情况 ($E=0$)：$R \\mid E=0 \\sim \\mathcal{N}(\\mu_{0}, \\sigma^{2})$，其中均值为 $\\mu_{0} = 0.5$，标准差为 $\\sigma = 0.6$。方差相等。\n- 真实紧急情况的先验概率为 $\\Pr(E=1) = p = 0.1$。因此，$\\Pr(E=0) = 1-p = 0.9$。\n- 决策（允许/拒绝访问）的四种可能结果的一组效用：\n  - 真阳性 (TP: 允许访问, $E=1$): 效用为 $b_{e} = 100$。\n  - 假阴性 (FN: 拒绝访问, $E=1$): 效用为 $-h_{e} = -300$。\n  - 假阳性 (FP: 允许访问, $E=0$): 效用为 $-h_{p} = -20$。\n  - 真阴性 (TN: 拒绝访问, $E=0$): 效用为 $0$。\n- 决策策略由阈值 $t$ 定义：如果 $R \\ge t$ 则允许访问，如果 $R  t$ 则拒绝访问。\n- 对假阳性率的监管约束：$\\Pr(\\text{allow} \\mid E=0) \\le \\beta$，其中 $\\beta = 0.02$。\n- 目标是在满足监管约束的条件下，找到使期望效用最大化的最优阈值 $t^{\\star}$。最终答案应四舍五入到 $4$ 位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n根据所需标准对问题进行评估：\n- **科学性：** 该问题牢固地植根于统计决策理论，这是在不确定性下做出最优决策的标准框架。它使用了诸如正态（高斯）分布、期望效用最大化和贝叶斯概率等成熟概念。这是医疗环境中 P-D-C（感知-决策-控制）循环的经典且现实的表述。\n- **适定性：** 该问题是适定的。它要求在一个决策变量 ($t$)上最大化一个明确定义的函数（期望效用），并受一个清晰的不等式约束。定义目标函数和约束所需的所有参数都已提供。所涉及的函数（从高斯 CDF 导出）是连续且可微的，确保了标准优化方法的适用性并存在唯一解。\n- **客观性：** 问题陈述是客观和量化的。所有参数、条件和目标都以数学精度指定，没有主观解释的余地。\n\n该问题没有表现出任何列出的缺陷：它在科学上是合理的，是完全可形式化的，是完整和一致的，呈现了一个现实的场景，结构良好，非平凡，并且其解可通过数学推导来验证。\n\n### 第3步：结论与行动\n问题是有效的。现在将推导一个完整的解。\n\n### 解题推导\n目标是在假阳性率的约束下，找到使总期望效用 $\\mathbb{E}[U(t)]$ 最大化的阈值 $t^{\\star}$。\n\n令行动“允许访问”表示为 $A=1$，“拒绝访问”表示为 $A=0$。策略是如果 $R \\ge t$ 则 $A=1$，如果 $R  t$ 则 $A=0$。\n\n总期望效用是四种结果的效用之和，每种效用都按其发生概率加权：\n$$ \\mathbb{E}[U(t)] = U(\\text{TP})\\Pr(\\text{TP}) + U(\\text{FN})\\Pr(\\text{FN}) + U(\\text{FP})\\Pr(\\text{FP}) + U(\\text{TN})\\Pr(\\text{TN}) $$\n结果的概率取决于阈值 $t$：\n- $\\Pr(\\text{TP}) = \\Pr(A=1, E=1) = \\Pr(A=1 \\mid E=1)\\Pr(E=1) = \\Pr(R \\ge t \\mid E=1) p$\n- $\\Pr(\\text{FN}) = \\Pr(A=0, E=1) = \\Pr(A=0 \\mid E=1)\\Pr(E=1) = \\Pr(R  t \\mid E=1) p$\n- $\\Pr(\\text{FP}) = \\Pr(A=1, E=0) = \\Pr(A=1 \\mid E=0)\\Pr(E=0) = \\Pr(R \\ge t \\mid E=0) (1-p)$\n- $\\Pr(\\text{TN}) = \\Pr(A=0, E=0) = \\Pr(A=0 \\mid E=0)\\Pr(E=0) = \\Pr(R  t \\mid E=0) (1-p)$\n\n代入效用值 ($b_e$, $-h_e$, $-h_p$, $0$):\n$$ \\mathbb{E}[U(t)] = b_e \\Pr(R \\ge t \\mid E=1) p - h_e \\Pr(R  t \\mid E=1) p - h_p \\Pr(R \\ge t \\mid E=0) (1-p) $$\n\n我们定义真阳性率 $TPR(t) = \\Pr(R \\ge t \\mid E=1)$ 和假阳性率 $FPR(t) = \\Pr(R \\ge t \\mid E=0)$。注意 $\\Pr(R  t \\mid E=1) = 1 - TPR(t)$。期望效用的表达式变为：\n$$ \\mathbb{E}[U(t)] = b_e \\cdot TPR(t) \\cdot p - h_e (1 - TPR(t)) p - h_p \\cdot FPR(t) \\cdot (1-p) $$\n$$ \\mathbb{E}[U(t)] = (b_e + h_e)p \\cdot TPR(t) - h_p(1-p) \\cdot FPR(t) - h_e p $$\n为了最大化关于 $t$ 的 $\\mathbb{E}[U(t)]$，我们可以忽略常数项 $-h_e p$，并专注于最大化目标函数 $J(t)$：\n$$ J(t) = (b_e + h_e)p \\cdot TPR(t) - h_p(1-p) \\cdot FPR(t) $$\n\n优化问题是：\n$$ \\max_{t} J(t) \\quad \\text{subject to} \\quad FPR(t) \\le \\beta $$\n\n令 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0,1)$ 的累积分布函数 (CDF)。这些率可以表示为：\n$$ FPR(t) = \\Pr(R \\ge t \\mid E=0) = \\Pr\\left(\\frac{R-\\mu_0}{\\sigma} \\ge \\frac{t-\\mu_0}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) $$\n$$ TPR(t) = \\Pr(R \\ge t \\mid E=1) = \\Pr\\left(\\frac{R-\\mu_1}{\\sigma} \\ge \\frac{t-\\mu_1}{\\sigma}\\right) = 1 - \\Phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) $$\n\n首先，我们分析约束 $FPR(t) \\le \\beta$：\n$$ 1 - \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) \\le \\beta \\implies \\Phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) \\ge 1 - \\beta $$\n应用逆正态CDF $\\Phi^{-1}$，这是一个单调递增函数：\n$$ \\frac{t-\\mu_0}{\\sigma} \\ge \\Phi^{-1}(1 - \\beta) \\implies t \\ge \\mu_0 + \\sigma \\Phi^{-1}(1 - \\beta) $$\n这个不等式定义了 $t$ 的可行域。我们将法规施加的最小允许阈值定义为 $t_{reg}$：\n$$ t_{reg} = \\mu_0 + \\sigma \\Phi^{-1}(1 - \\beta) $$\n优化必须在 $t \\in [t_{reg}, \\infty)$ 上进行。\n\n接下来，我们找到最大化 $J(t)$ 的无约束阈值 $t_{unc}$。这可以通过将导数 $\\frac{dJ}{dt}$ 设为零来找到。令 $\\phi(z) = \\frac{d\\Phi(z)}{dz}$ 为标准正态概率密度函数 (PDF)。\n$$ \\frac{d}{dt} TPR(t) = -\\phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) \\frac{1}{\\sigma} \\quad \\text{and} \\quad \\frac{d}{dt} FPR(t) = -\\phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) \\frac{1}{\\sigma} $$\n$$ \\frac{dJ}{dt} = -\\frac{(b_e + h_e)p}{\\sigma} \\phi\\left(\\frac{t-\\mu_1}{\\sigma}\\right) + \\frac{h_p(1-p)}{\\sigma} \\phi\\left(\\frac{t-\\mu_0}{\\sigma}\\right) $$\n在 $t=t_{unc}$ 处令 $\\frac{dJ}{dt}=0$：\n$$ h_p(1-p)\\phi\\left(\\frac{t_{unc}-\\mu_0}{\\sigma}\\right) = (b_e + h_e)p\\phi\\left(\\frac{t_{unc}-\\mu_1}{\\sigma}\\right) $$\n代入高斯 PDF 的定义 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$：\n$$ h_p(1-p)\\exp\\left(-\\frac{(t_{unc}-\\mu_0)^2}{2\\sigma^2}\\right) = (b_e + h_e)p\\exp\\left(-\\frac{(t_{unc}-\\mu_1)^2}{2\\sigma^2}\\right) $$\n对两边取自然对数并整理：\n$$ \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) = \\frac{(t_{unc}-\\mu_0)^2 - (t_{unc}-\\mu_1)^2}{2\\sigma^2} $$\n$$ 2\\sigma^2 \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) = (t_{unc}^2 - 2t_{unc}\\mu_0 + \\mu_0^2) - (t_{unc}^2 - 2t_{unc}\\mu_1 + \\mu_1^2) $$\n$$ 2\\sigma^2 \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) = 2t_{unc}(\\mu_1 - \\mu_0) - (\\mu_1^2 - \\mu_0^2) $$\n$$ 2\\sigma^2 \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) = 2t_{unc}(\\mu_1 - \\mu_0) - (\\mu_1 - \\mu_0)(\\mu_1 + \\mu_0) $$\n两边除以 $2(\\mu_1 - \\mu_0)$：\n$$ \\frac{\\sigma^2}{\\mu_1 - \\mu_0} \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) = t_{unc} - \\frac{\\mu_1 + \\mu_0}{2} $$\n这给出了无约束最优阈值：\n$$ t_{unc} = \\frac{\\mu_1 + \\mu_0}{2} + \\frac{\\sigma^2}{\\mu_1 - \\mu_0} \\ln\\left(\\frac{h_p(1-p)}{(b_e+h_e)p}\\right) $$\n\n现在，我们代入数值：\n$\\mu_1 = 1.5$, $\\mu_0 = 0.5$, $\\sigma = 0.6$, $p = 0.1$, $b_e = 100$, $h_e = 300$, $h_p = 20$, $\\beta = 0.02$.\n\n首先，计算监管阈值 $t_{reg}$：\n$$ t_{reg} = 0.5 + 0.6 \\cdot \\Phi^{-1}(1 - 0.02) = 0.5 + 0.6 \\cdot \\Phi^{-1}(0.98) $$\n$\\Phi^{-1}(0.98)$ 的值（标准正态分布的第98个百分位数）约为 $2.0537$。\n$$ t_{reg} \\approx 0.5 + 0.6 \\times 2.0537 = 0.5 + 1.23222 = 1.73222 $$\n\n接下来，计算无约束最优阈值 $t_{unc}$：\n对数的参数为：\n$$ \\frac{h_p(1-p)}{(b_e+h_e)p} = \\frac{20 \\times (1-0.1)}{(100+300) \\times 0.1} = \\frac{20 \\times 0.9}{400 \\times 0.1} = \\frac{18}{40} = 0.45 $$\n$$ t_{unc} = \\frac{1.5 + 0.5}{2} + \\frac{0.6^2}{1.5 - 0.5} \\ln(0.45) = \\frac{2.0}{2} + \\frac{0.36}{1.0} \\ln(0.45) $$\n$$ t_{unc} = 1 + 0.36 \\ln(0.45) \\approx 1 + 0.36 \\times (-0.7985) = 1 - 0.28746 = 0.71254 $$\n\n我们得到 $t_{unc} \\approx 0.7125$ 和 $t_{reg} \\approx 1.7322$。\n无约束最大值点 $t_{unc}$ 不在可行域 $[t_{reg}, \\infty)$ 内，因为 $t_{unc}  t_{reg}$。\n目标函数 $J(t)$ 是单峰的，其最大值点在 $t_{unc}$。由于 $t_{reg} > t_{unc}$，函数 $J(t)$ 在整个可行域 $[t_{reg}, \\infty)$ 上是单调递减的。为了在某个区间上最大化一个递减函数，必须为其参数选择最小可能的值。\n因此，最优约束阈值 $t^{\\star}$ 是允许的最小值，即是可行域的边界 $t_{reg}$。\n$$ t^{\\star} = t_{reg} = \\mu_0 + \\sigma \\Phi^{-1}(1-\\beta) $$\n\n使用更精确的 $\\Phi^{-1}(0.98)$ 值，约等于 $2.0537489$：\n$$ t^{\\star} = 0.5 + 0.6 \\times 2.0537489 = 0.5 + 1.23224934 \\approx 1.73224934 $$\n问题要求答案四舍五入到 $4$ 位有效数字。\n$t^{\\star} \\approx 1.732$。",
            "answer": "$$\\boxed{1.732}$$"
        },
        {
            "introduction": "增强安全性（例如，使用多因素认证）往往会牺牲可用性，这在急诊等时间敏感的临床环境中是一个关键的挑战。本练习构建了一个综合模型，利用概率论和成本效益分析来量化比较单因素和多因素认证对临床工作流程延迟和安全风险的综合影响。通过这种方式，您将学会如何在相互冲突的目标之间做出数据驱动的系统设计决策 。",
            "id": "4823163",
            "problem": "考虑一个临床急诊科（ED），临床医生在开始关键任务之前必须进行身份验证。我们使用基础概率和期望原理，对单因素身份验证（SFA）和多因素身份验证（MFA）的可用性-安全性权衡进行建模。假设以下基本前提：关键任务的到达遵循泊松过程，速率为每小时 $\\lambda$ 个任务；身份验证时间是一个非负随机变量 $A$，建模为形状参数为 $k$、尺度参数为 $\\theta$ 的伽马分布（因此 $A \\sim \\mathrm{Gamma}(k,\\theta)$）；敌对访问尝试遵循泊松过程，速率为每小时 $\\alpha$ 次，每次尝试的成功概率 $p$ 取决于身份验证方法。成本被线性建模：临床延迟的延迟成本率为每秒 $c_d$ 个成本单位，每次成功未经授权访问的安全事件成本为 $c_s$ 个成本单位。延迟阈值 $T$（以秒为单位）定义了一个事件，即单次任务的身份验证延迟超过 $T$。\n\n仅从核心定义出发，为每个场景计算：\n- 预期的身份验证时间 $E[A]$（以秒为单位）。\n- 概率 $\\Pr(A  T)$（以小数形式表示）。\n- 在期望值独立且可加的假设下，计算每种方法的每小时预期延迟成本。\n- 使用成功敌对事件的期望数量，计算每种方法的每小时预期安全成本。\n- 每种方法的每小时总预期成本，即预期延迟成本与安全成本之和。\n- 一个布尔决策，指示是否应选择 MFA，定义为：如果 MFA 的每小时总预期成本严格小于 SFA 的成本，则为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n使用以下场景测试套件，每个场景都指定了 SFA 和 MFA 的伽马分布参数、延迟阈值、任务和攻击速率以及成本参数。所有时间必须以秒为单位，所有速率必须以每小时为单位；所有输出必须使用所要求的单位。\n\n场景$\\;1$（理想路径）：\n- SFA: $k_{\\mathrm{SFA}} = 3$, $\\theta_{\\mathrm{SFA}} = 2$。\n- MFA: $k_{\\mathrm{MFA}} = 4$, $\\theta_{\\mathrm{MFA}} = 5$。\n- 阈值: $T = 30$。\n- 任务到达率: $\\lambda = 12$。\n- 攻击尝试率: $\\alpha = 0.2$。\n- 每次尝试成功概率: $p_{\\mathrm{SFA}} = 0.02$, $p_{\\mathrm{MFA}} = 0.001$。\n- 延迟成本率: $c_d = 50$。\n- 安全事件成本: $c_s = 100000$。\n\n场景$\\;2$（安全主导边界）：\n- SFA: $k_{\\mathrm{SFA}} = 3$, $\\theta_{\\mathrm{SFA}} = 2$。\n- MFA: $k_{\\mathrm{MFA}} = 4$, $\\theta_{\\mathrm{MFA}} = 4.5$。\n- 阈值: $T = 20$。\n- 任务到达率: $\\lambda = 2$。\n- 攻击尝试率: $\\alpha = 4$。\n- 每次尝试成功概率: $p_{\\mathrm{SFA}} = 0.05$, $p_{\\mathrm{MFA}} = 0.002$。\n- 延迟成本率: $c_d = 50$。\n- 安全事件成本: $c_s = 100000$。\n\n场景$\\;3$（延迟阈值压力测试）：\n- SFA: $k_{\\mathrm{SFA}} = 2$, $\\theta_{\\mathrm{SFA}} = 3$。\n- MFA: $k_{\\mathrm{MFA}} = 7$, $\\theta_{\\mathrm{MFA}} = 2$。\n- 阈值: $T = 10$。\n- 任务到达率: $\\lambda = 20$。\n- 攻击尝试率: $\\alpha = 0.1$。\n- 每次尝试成功概率: $p_{\\mathrm{SFA}} = 0.015$, $p_{\\mathrm{MFA}} = 0.0008$。\n- 延迟成本率: $c_d = 50$。\n- 安全事件成本: $c_s = 100000$。\n\n场景$\\;4$（高负荷急诊科边界）：\n- SFA: $k_{\\mathrm{SFA}} = 5$, $\\theta_{\\mathrm{SFA}} = 2$。\n- MFA: $k_{\\mathrm{MFA}} = 6$, $\\theta_{\\mathrm{MFA}} = 3$。\n- 阈值: $T = 25$。\n- 任务到达率: $\\lambda = 40$。\n- 攻击尝试率: $\\alpha = 0.5$。\n- 每次尝试成功概率: $p_{\\mathrm{SFA}} = 0.03$, $p_{\\mathrm{MFA}} = 0.001$。\n- 延迟成本率: $c_d = 60$。\n- 安全事件成本: $c_s = 150000$。\n\n您的程序必须为每个场景计算以下有序的输出列表：\n[$E[A]_{\\mathrm{SFA}}$, $\\Pr(A_{\\mathrm{SFA}} > T)$, $\\text{TotalCost}_{\\mathrm{SFA}}$, $E[A]_{\\mathrm{MFA}}$, $\\Pr(A_{\\mathrm{MFA}} > T)$, $\\text{TotalCost}_{\\mathrm{MFA}}$, $\\text{ChooseMFA}$]，\n其中 $E[A]_{\\cdot}$ 以秒为单位，$\\Pr(A_{\\cdot} > T)$ 是一个小数，$\\text{TotalCost}_{\\cdot}$ 以成本单位计，而 $\\text{ChooseMFA}$ 是一个布尔值。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result1,result2,result3]$）。每个 $result_i$ 必须是上述为场景 $i$ 描述的内部列表，不含额外的空格或文本。除了打印这最后一行之外，程序不得执行任何其他输入/输出操作。",
            "solution": "所提出的问题是概率论和成本效益分析在临床环境中对安全性与可用性权衡进行建模的一个适定应用。它在科学上基于标准随机模型（泊松过程和伽马过程），内部一致，并为获得唯一解提供了所有必要的参数。因此，该问题被认为是有效的。我们接下来推导所需的量。\n\n问题的核心是通过一个通用的分析框架，分析两种身份验证方法：单因素身份验证（SFA）和多因素身份验证（MFA）。对于每种方法，用 $i \\in \\{\\mathrm{SFA}, \\mathrm{MFA}\\}$ 索引，我们都得到了一组参数。让我们首先为一种通用方法规范化计算过程。\n\n### 1. 身份验证时间建模\n身份验证时间 $A$ 被建模为一个遵循伽马分布的随机变量，其形状参数为 $k  0$，尺度参数为 $\\theta  0$。我们记作 $A \\sim \\mathrm{Gamma}(k, \\theta)$。其概率密度函数（PDF）由下式给出：\n$$\nf(t; k, \\theta) = \\frac{t^{k-1} e^{-t/\\theta}}{\\theta^k \\Gamma(k)} \\quad \\text{for } t \\ge 0\n$$\n其中 $\\Gamma(k)$ 是伽马函数，$\\Gamma(k) = \\int_0^\\infty x^{k-1}e^{-x}dx$。\n\n#### 预期身份验证时间 $E[A]$\n伽马分布随机变量的期望值（或均值）是该分布的一个基本属性。它是通过对其支撑集上的 $t \\cdot f(t; k, \\theta)$ 进行积分得出的：\n$$\nE[A] = \\int_0^\\infty t \\cdot \\frac{t^{k-1} e^{-t/\\theta}}{\\theta^k \\Gamma(k)} dt = \\frac{1}{\\theta^k \\Gamma(k)} \\int_0^\\infty t^k e^{-t/\\theta} dt\n$$\n使用换元法 $u = t/\\theta$，这意味着 $t = u\\theta$ 且 $dt = \\theta du$，积分变为：\n$$\nE[A] = \\frac{1}{\\theta^k \\Gamma(k)} \\int_0^\\infty (u\\theta)^k e^{-u} (\\theta du) = \\frac{\\theta^{k+1}}{\\theta^k \\Gamma(k)} \\int_0^\\infty u^k e^{-u} du\n$$\n剩下的积分是 $\\Gamma(k+1)$ 的定义。使用恒等式 $\\Gamma(k+1) = k\\Gamma(k)$，我们得到：\n$$\nE[A] = \\frac{\\theta}{\\Gamma(k)} \\Gamma(k+1) = \\frac{\\theta}{\\Gamma(k)} (k\\Gamma(k)) = k\\theta\n$$\n因此，预期的身份验证时间（以秒为单位）计算如下：\n$$\nE[A] = k \\theta\n$$\n\n#### 超过延迟阈值的概率 $\\Pr(A  T)$\n我们需要计算身份验证时间 $A$ 超过给定阈值 $T$ 的概率。这是伽马分布在 $T$ 点的生存函数（或互补累积分布函数，CCDF）。\n$$\n\\Pr(A  T) = \\int_T^\\infty f(t; k, \\theta) dt = \\int_T^\\infty \\frac{t^{k-1} e^{-t/\\theta}}{\\theta^k \\Gamma(k)} dt\n$$\n这个积分通常用上不完全伽马函数 $\\Gamma(s, x) = \\int_x^\\infty t^{s-1}e^{-t}dt$ 来表示。使用同样的换元法 $u = t/\\theta$：\n$$\n\\Pr(A  T) = \\frac{1}{\\Gamma(k)} \\int_{T/\\theta}^\\infty u^{k-1}e^{-u} du = \\frac{\\Gamma(k, T/\\theta)}{\\Gamma(k)}\n$$\n这个比率被称为正则化上不完全伽马函数，记作 $Q(k, T/\\theta)$。\n$$\n\\Pr(A  T) = Q(k, T/\\theta)\n$$\n\n### 2. 每小时成本建模\n问题定义了两种成本来源：临床延迟和安全漏洞。我们假设它们是独立的并且是可加的。\n\n#### 每小时预期延迟成本 ($C_{\\text{delay}}$)\n关键任务根据泊松过程到达，速率为每小时 $\\lambda$ 个任务。因此，一小时内的预期任务数是 $\\lambda$。每个任务需要一个平均持续时间为 $E[A]$ 秒的身份验证步骤。在一小时内累积的总预期延迟（以秒为单位）是预期任务数与每次身份验证的预期持续时间的乘积。这依赖于沃尔德恒等式。\n$$\n\\text{Expected total delay per hour (in seconds)} = \\lambda \\frac{\\text{tasks}}{\\text{hour}} \\times E[A] \\frac{\\text{seconds}}{\\text{task}} = \\lambda E[A]\n$$\n延迟成本率给定为每秒 $c_d$ 个成本单位。每小时的预期延迟成本是每小时总预期延迟与成本率的乘积：\n$$\nC_{\\text{delay}} = (\\lambda E[A]) \\cdot c_d\n$$\n单位是一致的：$(\\frac{\\text{秒}}{\\text{小时}}) \\times (\\frac{\\text{成本单位}}{\\text{秒}}) = \\frac{\\text{成本单位}}{\\text{小时}}$。\n\n#### 每小时预期安全成本 ($C_{\\text{security}}$)\n敌对访问尝试也遵循泊松过程，速率为每小时 $\\alpha$ 次尝试。一小时内的预期尝试次数是 $\\alpha$。每次尝试有概率 $p$ 成功。成功攻击的过程是一个速率为 $\\alpha p$ 的稀疏化泊松过程。\n每小时成功未经授权访问事件的预期数量是：\n$$\nE[\\text{successful attacks per hour}] = \\alpha p\n$$\n每个成功事件会产生固定的成本 $c_s$。因此，每小时的预期安全成本是：\n$$\nC_{\\text{security}} = (\\alpha p) \\cdot c_s\n$$\n\n### 3. 总成本与决策规则\n给定身份验证方法的每小时总预期成本是预期延迟成本和安全成本的总和：\n$$\nC_{\\text{total}} = C_{\\text{delay}} + C_{\\text{security}} = (\\lambda \\cdot (k\\theta) \\cdot c_d) + (\\alpha \\cdot p \\cdot c_s)\n$$\n这个计算对 SFA 和 MFA 都执行，得出 $C_{\\text{total, SFA}}$ 和 $C_{\\text{total, MFA}}$。\n\n选择 MFA 的决策基于严格的成本比较。当且仅当 MFA 的总预期成本严格小于 SFA 的总预期成本时，才选择 MFA。布尔决策 $\\text{ChooseMFA}$ 定义为：\n$$\n\\text{ChooseMFA} = (C_{\\text{total, MFA}}  C_{\\text{total, SFA}})\n$$\n\n### 各场景计算摘要\n对于一个场景中的每种方法（SFA 和 MFA），我们将计算：\n1.  $E[A] = k \\theta$\n2.  $\\Pr(A > T) = Q(k, T/\\theta)$\n3.  $C_{\\text{total}} = (\\lambda \\cdot (k\\theta) \\cdot c_d) + (\\alpha \\cdot p \\cdot c_s)$\n\nSFA 的这三个值，随后是 MFA 的相同三个值，最后是布尔决策 $\\text{ChooseMFA}$，共同构成了每个场景所需的七个输出。\n现在将使用这些推导出的公式对四个指定场景中的每一个进行计算。",
            "answer": "```\n[[6.0,1.3752583854580347e-05,4000.0,20.0,0.06680720126885805,12020.0,False],[6.0,0.00038814781488179975,20600.0,18.0,0.00989345511306352,18800.0,True],[6.0,0.1554571869389304,6150.0,14.0,0.3233235832731998,14080.0,False],[10.0,0.05265301734376917,26250.0,18.0,0.2443491322204593,43275.0,False]]\n```"
        }
    ]
}