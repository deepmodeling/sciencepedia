{
    "hands_on_practices": [
        {
            "introduction": "对称加密，如高级加密标准（AES），是保护静态数据安全的基石。其安全性并非绝对，而是建立在通过计算手段猜测密钥的极端困难性之上。本练习将通过一个动手计算，量化暴力破解一个 $128$ 位 AES 密钥所需的时间，让您直观地理解为何我们能够信任现代密码学，并认识到其抵御当前计算能力攻击的强大程度。",
            "id": "4850559",
            "problem": "一家区域性医院使用高级加密标准（AES）和一个 $128$ 位的密钥来加密其电子健康记录数据库。考虑一个外部攻击者，他试图使用一个每秒能够进行 $10^{12}$ 次独立密钥猜测的大型租用计算集群来进行一次朴素的穷举密钥搜索。假设医院的 AES 密钥是均匀随机生成的，并且穷举搜索会无重复地枚举候选密钥，因此正确密钥在枚举中的位置均匀分布在 $2^{128}$ 个可能的密钥之中。仅从有限均匀空间上的搜索、均匀分布位置的期望值和单位转换的基本定义出发，推导期望暴力破解时间的解析表达式，并以年为单位进行数值计算。然后，假设仅使用经典计算硬件，从第一性原理出发，简要论证这个时间量级应如何为医疗保健领域的现实攻击者模型（例如，受经济利益驱动的犯罪集团、国家级行为体、云服务提供商）提供信息。\n\n将最终数值答案四舍五入到三位有效数字，并以年为单位表示。您的最终答案必须是一个数字。",
            "solution": "问题要求推导和评估对使用 $128$ 位密钥的 AES 加密数据库进行暴力破解攻击的期望时间。它还要求论证这一结果如何为现实攻击者模型提供信息。\n\n首先，我们确定密钥空间的大小。一个 $128$ 位的 AES 密钥意味着存在 $N = 2^{128}$ 个可能的唯一密钥。\n\n根据题意，对正确密钥的搜索是穷举且无重复的，并且正确密钥的位置均匀分布在所有可能密钥的集合上。设随机变量 $X$ 表示为找到正确密钥而必须检查的密钥数量。$X$ 服从集合 $\\{1, 2, 3, \\dots, N\\}$ 上的离散均匀分布。在任何特定位置 $i$ 找到密钥的概率是 $P(X=i) = \\frac{1}{N}$。\n\n期望的猜测次数 $E[X]$ 是此分布的期望值。从离散随机变量期望值的基本定义出发：\n$$E[X] = \\sum_{i=1}^{N} i \\cdot P(X=i)$$\n代入概率 $P(X=i) = \\frac{1}{N}$：\n$$E[X] = \\sum_{i=1}^{N} i \\cdot \\frac{1}{N} = \\frac{1}{N} \\sum_{i=1}^{N} i$$\n前 $N$ 个正整数的和由著名公式 $\\sum_{i=1}^{N} i = \\frac{N(N+1)}{2}$ 给出。将此代入 $E[X]$ 的表达式中：\n$$E[X] = \\frac{1}{N} \\left( \\frac{N(N+1)}{2} \\right) = \\frac{N+1}{2}$$\n对于大小为 $N = 2^{128}$ 的密钥空间，需要检查的期望密钥数是 $E[X] = \\frac{2^{128}+1}{2}$。\n\n攻击者能够达到的猜测速率为 $R = 10^{12}$ 密钥/秒。找到密钥的期望时间 $T_{\\text{expected}}$ 是期望猜测次数除以猜测速率。以秒为单位的期望时间的解析表达式是：\n$$T_{\\text{expected}} = \\frac{E[X]}{R} = \\frac{(2^{128}+1)/2}{10^{12}} = \\frac{2^{128}+1}{2 \\times 10^{12}} \\text{ seconds}$$\n由于 $2^{128}$ 是一个极大的数，$+1$ 项可以忽略不计，该表达式可以精确地近似为 $\\frac{2^{128}}{2 \\times 10^{12}} = \\frac{2^{127}}{10^{12}}$ 秒。\n\n为了以年为单位评估此时间，我们必须进行单位转换。一年中的秒数 $S_{\\text{year}}$ 是基于一年平均长度为 $365.25$ 天来计算的，以考虑闰年：\n$$S_{\\text{year}} = 365.25 \\frac{\\text{days}}{\\text{year}} \\times 24 \\frac{\\text{hours}}{\\text{day}} \\times 60 \\frac{\\text{minutes}}{\\text{hour}} \\times 60 \\frac{\\text{seconds}}{\\text{minute}} = 31,557,600 \\frac{\\text{seconds}}{\\text{year}}$$\n这可以写成 $S_{\\text{year}} \\approx 3.15576 \\times 10^{7}$ 秒/年。\n\n因此，以年为单位的期望时间 $T_{\\text{years}}$ 是：\n$$T_{\\text{years}} = \\frac{T_{\\text{expected}}}{S_{\\text{year}}} = \\frac{2^{128}+1}{2 \\times 10^{12} \\times 31,557,600}$$\n现在，我们进行数值计算。我们使用近似值 $2^{128} \\approx 3.4028 \\times 10^{38}$。\n$$T_{\\text{years}} \\approx \\frac{3.4028 \\times 10^{38}}{2 \\times 10^{12} \\times 3.15576 \\times 10^7} = \\frac{3.4028 \\times 10^{38}}{6.31152 \\times 10^{19}}$$\n$$T_{\\text{years}} \\approx 0.53914 \\times 10^{19} \\approx 5.39 \\times 10^{18} \\text{ years}$$\n四舍五入到三位有效数字，期望时间是 $5.39 \\times 10^{18}$ 年。\n\n这个天文数字般的时间尺度，基于计算可行性的第一性原理，对医疗保健数据安全领域的现实攻击者模型有直接影响：\n计算出的约 $5.4 \\times 10^{18}$ 年的期望时间，是目前估计的宇宙年龄（约 $1.38 \\times 10^{10}$ 年）的一亿倍以上。从这个基本结果可以推断，对于任何局限于经典计算领域的攻击者来说，无论其拥有多少资源，对 AES-128 进行暴力破解攻击在计算上都是不可行的。\n\n1.  **受经济利益驱动的犯罪集团：** 这类攻击者通常在短时间范围内运作，并受投资回报率驱动。一项需要比太阳系寿命还长的时间的攻击，在经济上是荒谬的。因此，从第一性原理出发，他们的精力必然会转向安全链中的薄弱环节，例如社会工程（如通过网络钓鱼骗取医院员工的凭证）、利用电子健康记录系统中的软件漏洞，或物理窃取设备并寄希望于薄弱的密钥管理。\n\n2.  **国家级行为体：** 尽管拥有庞大的资源和长期的战略目标，但即使是国家级行为体也受到物理和计算极限的约束。这种规模的暴力破解攻击所需的能量和时间是令人望而却步的，远远超过任何可以想象的全球能力。因此，针对此类行为体的现实威胁模型也必须排除对算法本身的暴力破解攻击。相反，他们会专注于更复杂的方法：利用软件栈中的零日漏洞、进行侧信道攻击以从硬件中提取密钥、破坏密钥生成或管理基础设施，或利用间谍活动和胁迫手段获取密钥。\n\n3.  **云服务提供商：** 作为可能存储数据的基础设施的运营商，云服务提供商处于一个独特的位置。破解加密算法的不可行性意味着，如果患者数据使用提供商无法访问的密钥（例如，通过客户端加密）进行了适当加密，那么即使是提供商也无法获取数据内容，数据的机密性得以维持。威胁模型从提供商攻击密码学本身，转移到提供商的内部安全控制、访问策略，以及其可能被法律强制要求披露其所管理的任何密钥的风险。\n\n总而言之，对于所有实际目的而言，AES-128 原语本身的基本计算安全性对于暴力破解攻击是绝对的。这迫使任何理性的攻击者去攻击其实现方式、密钥管理过程、底层硬件和操作人员，而不是核心加密算法。因此，保护健康记录的现实安全模型和防御策略必须优先考虑整个系统的安全性，而不是仅仅依赖加密标准的数学强度。",
            "answer": "$$\\boxed{5.39 \\times 10^{18}}$$"
        },
        {
            "introduction": "信任强大的加密算法只是第一步，在真实系统中部署加密还需要精巧的设计并权衡利弊。信封加密是一种业界广泛采用的最佳实践模式，它兼顾了非对称加密的密钥管理优势和对称加密的高性能。本练习将带您分析信封加密方案带来的实际存储开销和性能延迟，从而将理论知识与系统设计的工程现实联系起来。",
            "id": "4850594",
            "problem": "一家医院的健康信息学团队正在为受保护的健康信息（PHI）文件标准化信封加密。对于一个大小为 $1$ GB 的单个 PHI 文件，该团队应用的信封加密过程如下：生成一个长度为 $256$ 位的随机数据密钥 $K_{\\text{data}}$；使用高级加密标准（AES）的伽罗瓦/计数器模式（GCM）和单个 nonce 对整个文件进行加密；然后，通过使用 $2048$ 位模数和最优非对称加密填充（OAEP）的 Rivest–Shamir–Adleman（RSA）算法，将在硬件安全模块（HSM）中维护的密钥加密密钥（KEK）下对数据密钥进行加密。密文与所有必要的元数据一起存储，以使解密过程自成一体。\n\n使用以下经过充分验证的事实和参数：\n\n- 信封加密将 RSA 包装的数据密钥、单个 AES-GCM nonce、单个 AES-GCM 认证标签、一个算法标识符字段和一个密钥标识符字段与密文一同存储。\n- 对于使用 $2048$ 位模数的 RSA，被包装的数据密钥的密文长度等于模数长度，即 $2048$ 位。假设 $256$ 位的数据密钥符合 RSA-OAEP 的输入限制。\n- AES-GCM 使用一个 $12$ 字节的 nonce，并产生一个 $16$ 字节的认证标签。AES-GCM 不会对密文进行任何填充。\n- 算法标识符存储为一个 $4$ 字节的字段，密钥标识符是一个通用唯一标识符（UUID），存储为一个 $16$ 字节的字段。\n- HSM 在单次 API 调用中执行 RSA-OAEP 包装；处理延迟为 $5$ 毫秒，网络往返时间为 $8$ 毫秒，客户端编组/反序列化延迟为 $1.5$ 毫秒。假设这些延迟是相互独立且可相加的。在延迟计算中排除批量 AES-GCM 数据加密时间；仅计算与信封加密密钥包装相关的控制平面延迟。\n\n基于这些事实和定义，推导信封加密所引入的总存储开销（除密文外）的表达式（以字节为单位），以及每次信封加密操作的控制平面延迟的表达式（以毫秒为单位）。然后计算它们的数值。最终开销以字节表示，最终延迟以毫秒表示。无需四舍五入；报告精确值。",
            "solution": "该问题陈述清晰，具有科学依据，并包含了推导所要求的量的所有必要信息。我们的任务是计算两个不同的值：由信封加密元数据引入的总存储开销，以及密钥包装操作的总控制平面延迟。\n\n首先，我们推导总存储开销的表达式，记为 $O_{\\text{total}}$。问题指明，开销是与密文一同存储的几个元数据组件大小的总和。这些组件是：\n1.  RSA 包装的数据密钥，其大小我们记为 $S_{\\text{wrap}}$。\n2.  AES-GCM nonce，其大小为 $S_{\\text{nonce}}$。\n3.  AES-GCM 认证标签，其大小为 $S_{\\text{tag}}$。\n4.  算法标识符，其大小为 $S_{\\text{algo}}$。\n5.  密钥标识符，其大小为 $S_{\\text{id}}$。\n\n总开销是这些组件大小的总和：\n$$O_{\\text{total}} = S_{\\text{wrap}} + S_{\\text{nonce}} + S_{\\text{tag}} + S_{\\text{algo}} + S_{\\text{id}}$$\n\n我们已知这些组件的大小，但其中一个需要单位换算。\n被包装的数据密钥的大小 $S_{\\text{wrap}}$，被说明为等于 RSA 模数长度，即 $2048$ 位。为了以字节表示，我们使用每字节 $8$ 位的换算因子。\n$$S_{\\text{wrap}} = \\frac{2048 \\text{ bits}}{8 \\text{ bits/byte}} = 256 \\text{ bytes}$$\n\n其他组件的大小直接以字节给出：\n-   $S_{\\text{nonce}} = 12$ 字节\n-   $S_{\\text{tag}} = 16$ 字节\n-   $S_{\\text{algo}} = 4$ 字节\n-   $S_{\\text{id}} = 16$ 字节\n\n将这些值代入 $O_{\\text{total}}$ 的表达式中：\n$$O_{\\text{total}} = 256 \\text{ bytes} + 12 \\text{ bytes} + 16 \\text{ bytes} + 4 \\text{ bytes} + 16 \\text{ bytes}$$\n进行求和，得出总存储开销的数值：\n$$O_{\\text{total}} = 304 \\text{ bytes}$$\n\n其次，我们推导总控制平面延迟的表达式，记为 $L_{\\text{total}}$。问题陈述指明，此延迟仅与密钥包装操作相关，不包括批量数据加密的时间。该延迟是三个独立、可相加的组成部分的总和：\n1.  HSM 处理延迟，$L_{\\text{HSM}}$。\n2.  网络往返时间，$L_{\\text{net}}$。\n3.  客户端编组/反序列化延迟，$L_{\\text{client}}$。\n\n因此，总控制平面延迟由以下表达式给出：\n$$L_{\\text{total}} = L_{\\text{HSM}} + L_{\\text{net}} + L_{\\text{client}}$$\n\n问题提供了这些延迟的数值：\n-   $L_{\\text{HSM}} = 5$ 毫秒\n-   $L_{\\text{net}} = 8$ 毫秒\n-   $L_{\\text{client}} = 1.5$ 毫秒\n\n将这些值代入 $L_{\\text{total}}$ 的表达式中：\n$$L_{\\text{total}} = 5 \\text{ ms} + 8 \\text{ ms} + 1.5 \\text{ ms}$$\n进行求和，得出总控制平面延迟的最终数值：\n$$L_{\\text{total}} = 14.5 \\text{ 毫秒}$$\n\n推导出的结果是 $304$ 字节的开销和 $14.5$ 毫秒的延迟。",
            "answer": "$$\\boxed{\\begin{pmatrix} 304  14.5 \\end{pmatrix}}$$"
        },
        {
            "introduction": "数据保护不仅仅是加密存储，当数据需要用于研究或公共卫生分析时，我们必须在数据共享和个人隐私之间找到平衡。简单地移除姓名等直接标识符并不足以保证匿名性，因为“准标识符”组合仍可能重新识别个人。本练习将介绍 $k$-匿名化这一重要的隐私保护技术，并指导您如何基于一个量化风险模型来计算实现特定隐私目标所需的最小 $k$ 值。",
            "id": "4850554",
            "problem": "某区域卫生主管部门计划发布一个包含准标识符的患者就诊记录去识别数据集。该数据集包含 $N = 100{,}000$ 条记录，这些记录是从一个规模为 $M = 500{,}000$ 的区域人口中通过无放回简单随机抽样得出的。该主管部门将强制执行 $k$-匿名化，这意味着在发布的数据集中，由准标识符构成的每个等价类将至少包含 $k$ 条记录。\n\n采用以下与基于群体的推理一致的风险解释：入侵者知道目标个体居住在区域人口中，但不知道目标是否包含在发布的数据集中。入侵者通过对准标识符进行精确匹配来单次尝试重识别目标，如果有多条记录匹配，则从这些匹配项中进行均匀随机选择。\n\n将每条记录的重识别风险定义为入侵者在这一次尝试中正确重识别目标的概率。主管部门要求，发布数据集中估计的最大每条记录重识别风险必须严格低于 $0.01$。\n\n仅使用 $k$-匿名化、简单随机抽样和概率的基本定义（不使用额外公式），并假设最坏情况风险出现在允许的最小等价类中，计算能确保最大重识别风险严格低于 $0.01$ 的最小整数 $k$。以整数形式提供最终的 $k$。除了选择满足风险要求的最小整数外，不需要其他舍入规则。",
            "solution": "该问题要求我们确定 $k$-匿名化的最小整数值 $k$，使得最大每条记录重识别风险严格低于给定阈值。解法将根据题目要求，从概率论的基本原理推导得出。\n\n设 $N$ 为发布数据集中的记录数，$M$ 为抽样所来源的总人口规模。已知 $N = 100,000$，$M = 500,000$。抽样方法为无放回简单随机抽样。\n\n每条记录的重识别风险定义为入侵者在一次尝试中能正确识别出目标个体的概率。我们将此风险记为 $R$。入侵者知道目标在规模为 $M$ 的人口中，但不知道目标是否在规模为 $N$ 的样本中。\n\n我们为给定的目标个体定义以下事件：\n$E_{sample}$：目标个体被包含在发布数据集中的事件。\n$E_{id}$：入侵者正确识别出目标个体的事件。\n\n重识别风险是事件 $E_{id}$ 的概率，即 $R = P(E_{id})$。使用全概率公式，我们可以根据目标是否在样本中进行条件分解：\n$$R = P(E_{id}) = P(E_{id} | E_{sample}) P(E_{sample}) + P(E_{id} | E_{sample}^c) P(E_{sample}^c)$$\n其中 $E_{sample}^c$ 是 $E_{sample}$ 的补集（目标不在样本中）。\n\n如果目标不在样本中（$E_{sample}^c$），入侵者无法从数据集中正确识别他们。因此，在目标不在样本中的条件下，正确识别的概率为零：$P(E_{id} | E_{sample}^c) = 0$。\n风险的公式简化为：\n$$R = P(E_{id} | E_{sample}) P(E_{sample})$$\n\n我们现在必须确定右边的两个概率。\n\n首先，我们计算 $P(E_{sample})$。数据集是从规模为 $M$ 的人口中无放回地抽取的规模为 $N$ 的简单随机样本。人口中任何特定个体被包含在此样本中的概率是样本规模与人口规模的比率。\n$$P(E_{sample}) = \\frac{N}{M}$$\n代入给定值：\n$$P(E_{sample}) = \\frac{100,000}{500,000} = \\frac{1}{5}$$\n\n接下来，我们计算 $P(E_{id} | E_{sample})$。这是在目标在样本中的条件下，正确识别的概率。\n根据问题描述，入侵者对准标识符进行精确匹配。这将数据集划分为多个等价类。我们考虑目标记录所属的等价类。设该等价类在样本中的大小为 $s$。\n入侵者找到这 $s$ 条匹配的记录。根据题意，如果有多条记录匹配，入侵者会随机均匀地选择一条。由于目标记录是这 $s$ 条记录中的一条，选择正确记录的概率是 $\\frac{1}{s}$。\n$$P(E_{id} | E_{sample}) = \\frac{1}{s}$$\n\n结合这些部分，对于大小为 $s$ 的等价类中的一条记录，其重识别风险 $R$ 为：\n$$R(s) = \\frac{1}{s} \\times \\frac{N}{M}$$\n\n问题要求*最大*每条记录重识别风险严格低于 $0.01$。风险 $R(s)$ 是 $s$ 的单调递减函数。因此，最大风险 $R_{max}$ 出现在 $s$ 的最小可能值处。\n\n数据集被规定为 $k$-匿名的，这意味着在发布的数据集中，每个等价类必须至少有 $k$ 条记录。因此，对于数据集中大小为 $s$ 的任何等价类，我们有 $s \\ge k$。因此 $s$ 的最小可能值为 $k$。题目明确指示我们假设“最坏情况风险出现在允许的最小等价类中”，这证实了我们应该使用 $s_{min} = k$ 来计算最大风险。\n\n$$R_{max} = R(s=k) = \\frac{1}{k} \\frac{N}{M}$$\n\n主管部门的要求是 $R_{max}  0.01$。我们现在可以建立不等式来求解 $k$：\n$$\\frac{1}{k} \\frac{N}{M}  0.01$$\n代入 $N$ 和 $M$ 的数值：\n$$\\frac{1}{k} \\left( \\frac{100,000}{500,000} \\right)  0.01$$\n$$\\frac{1}{k} \\left( \\frac{1}{5} \\right)  0.01$$\n$$\\frac{1}{5k}  \\frac{1}{100}$$\n由于 $k$ 是记录的数量，它必须是一个正整数（$k \\ge 1$）。我们可以在不等式两边同乘以 $100 \\times 5k$（这是一个正数），而不会改变不等号的方向：\n$$100  5k$$\n两边除以 $5$：\n$$\\frac{100}{5}  k$$\n$$20  k$$\n\n问题要求满足此条件的最小整数 $k$。严格大于 $20$ 的最小整数是 $21$。\n\n因此，为确保最大重识别风险严格低于 $0.01$ 阈值，所需的 $k$-匿名化的最小整数值为 $21$。",
            "answer": "$$\\boxed{21}$$"
        }
    ]
}