{
    "hands_on_practices": [
        {
            "introduction": "辅助临床系统，特别是图像归档与通信系统（PACS），需要处理海量数据。理解决定存储需求的因素对于系统设计、规划和成本管理至关重要。本练习将一个真实的医学影像检查分解为其基本组成部分，通过从头计算其存储足迹，您将具体了解采集参数如何直接影响PACS中的数据量。",
            "id": "4822799",
            "problem": "一家医院运营着包括检验信息系统（LIS）、放射学信息系统（RIS）和医学影像归档与通信系统（PACS）在内的辅助临床系统。PACS存储从计算机断层扫描（CT）和磁共振（MR）设备接收的医学数字成像与通信（DICOM）图像。使用以下科学既定的基础原则：\n\n- 数字图像由一个矩形像素矩阵组成，每个像素分配有固定数量的位数。未压缩的像素数据大小由公式 $($rows$) \\times ($columns$) \\times ($\\text{bits allocated}$)/8$ 字节给出。\n- 对于多层采集，重建的切片数是大于或等于扫描范围长度除以重建间隔的最小整数，即 $\\lceil L / \\Delta \\rceil$，其中 $L$ 是扫描范围长度，$\\Delta$ 是重建间隔（对于CT）或层厚加间距（对于MR重建连续切片时）。\n- 在无损压缩中，只有像素数据被压缩。DICOM头文件元数据不被压缩。如果像素数据被压缩了 $s$ 倍，则压缩后的像素数据大小是未压缩像素数据大小除以 $s$。\n- 每个实例的PACS存储足迹等于压缩后的像素数据大小加上未压缩的DICOM头文件大小。\n\n一项CT胸腹盆腔检查和一项MR脑部动态检查的配置如下。\n\nCT检查参数：\n- 纵向扫描范围长度 $L_{\\mathrm{CT}} = 1100~\\mathrm{mm}$。\n- 重建间隔 $\\Delta_{\\mathrm{CT}} = 0.8~\\mathrm{mm}$。\n- 期相 $P_{\\mathrm{CT}} = 3$ （动脉期、静脉期、延迟期），每个期相使用 $K_{\\mathrm{CT}} = 2$ 种重建核心（软组织和肺）进行重建。\n- 除了轴位重建外，还采集了两幅定位像。\n- 每实例的矩阵：$512 \\times 512$ 像素，$\\text{Bits Allocated} = 16$。\n- 每实例的DICOM头文件大小 $H = 4096$ 字节。\n- 应用于像素数据的无损压缩因子 $s_{\\mathrm{CT}} = 2.0$。\n\nMR检查参数：\n- 脑部扫描范围长度 $L_{\\mathrm{MR}} = 144~\\mathrm{mm}$，层厚 $\\Delta_{\\mathrm{MR}} = 3~\\mathrm{mm}$，无切片间距。\n- 回波 $E_{\\mathrm{MR}} = 2$，动态时间点 $T_{\\mathrm{MR}} = 60$。\n- 每实例的矩阵：$256 \\times 256$ 像素，$\\text{Bits Allocated} = 16$。\n- 每实例的DICOM头文件大小 $H = 4096$ 字节（与CT相同）。\n- 应用于像素数据的无损压缩因子 $s_{\\mathrm{MR}} = 1.5$。\n\n假设每期相重建的CT切片数等于 $\\left\\lceil L_{\\mathrm{CT}} / \\Delta_{\\mathrm{CT}} \\right\\rceil$，MR切片数等于 $\\left\\lceil L_{\\mathrm{MR}} / \\Delta_{\\mathrm{MR}} \\right\\rceil$。MR实例数等于 切片数 $\\times$ 回波数 $\\times$ 时间点数。对于CT，轴位实例数等于 切片数 $\\times$ 期相数 $\\times$ 核心数，再加上两个定位像实例。使用上述基本原则，推导出两项检查合计的总PACS存储足迹。以千兆字节（GB）为单位表示您的最终答案，其中 $1~\\mathrm{GB} = 10^{9}$ 字节，并将最终答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，并被认为是合理的。它具有科学依据，问题设定良好、客观，并包含推导唯一解所需的所有必要信息。我们可以开始计算。\n\n目标是计算计算机断层扫描（CT）检查和磁共振（MR）检查在医学影像归档与通信系统（PACS）上的总存储足迹。总足迹是各单项检查足迹之和。\n\n设 $F_{\\mathrm{total}}$ 是以字节为单位的总存储足迹。我们有：\n$$F_{\\mathrm{total}} = F_{\\mathrm{total, CT}} + F_{\\mathrm{total, MR}}$$\n其中 $F_{\\mathrm{total, CT}}$ 和 $F_{\\mathrm{total, MR}}$ 分别是CT和MR检查的存储足迹。\n\n首先，我们计算CT检查的存储足迹。\nCT检查的给定参数如下：\n-   纵向扫描范围长度：$L_{\\mathrm{CT}} = 1100~\\mathrm{mm}$\n-   重建间隔：$\\Delta_{\\mathrm{CT}} = 0.8~\\mathrm{mm}$\n-   期相：$P_{\\mathrm{CT}} = 3$\n-   重建核心：$K_{\\mathrm{CT}} = 2$\n-   定位像：$N_{\\mathrm{scout}} = 2$\n-   矩阵维度：$N_{\\mathrm{rows}} = 512$, $N_{\\mathrm{cols}} = 512$\n-   每像素分配位数：$B_{\\mathrm{CT}} = 16$\n-   每实例的DICOM头文件大小：$H = 4096$ 字节\n-   无损压缩因子：$s_{\\mathrm{CT}} = 2.0$\n\n每期相重建的轴位切片数由下式给出：\n$$N_{\\mathrm{slices, CT}} = \\lceil \\frac{L_{\\mathrm{CT}}}{\\Delta_{\\mathrm{CT}}} \\rceil = \\lceil \\frac{1100}{0.8} \\rceil = \\lceil 1375 \\rceil = 1375$$\n轴位实例总数是切片数、期相数和核心数的乘积：\n$$N_{\\mathrm{axial, CT}} = N_{\\mathrm{slices, CT}} \\times P_{\\mathrm{CT}} \\times K_{\\mathrm{CT}} = 1375 \\times 3 \\times 2 = 8250$$\nCT检查的实例总数是轴位实例数和定位像数之和：\n$$N_{\\mathrm{inst, CT}} = N_{\\mathrm{axial, CT}} + N_{\\mathrm{scout}} = 8250 + 2 = 8252$$\n接下来，我们计算单个CT实例的存储大小。未压缩的像素数据大小 $S_{\\mathrm{unc, CT}}$ 为：\n$$S_{\\mathrm{unc, CT}} = \\frac{N_{\\mathrm{rows}} \\times N_{\\mathrm{cols}} \\times B_{\\mathrm{CT}}}{8} = \\frac{512 \\times 512 \\times 16}{8} = 524288~\\text{字节}$$\n应用压缩因子后，压缩的像素数据大小 $S_{\\mathrm{comp, CT}}$ 为：\n$$S_{\\mathrm{comp, CT}} = \\frac{S_{\\mathrm{unc, CT}}}{s_{\\mathrm{CT}}} = \\frac{524288}{2.0} = 262144~\\text{字节}$$\n每个CT实例的足迹 $F_{\\mathrm{inst, CT}}$ 是压缩像素数据大小和DICOM头文件大小之和：\n$$F_{\\mathrm{inst, CT}} = S_{\\mathrm{comp, CT}} + H = 262144 + 4096 = 266240~\\text{字节}$$\nCT检查的总存储足迹是实例数与每实例足迹的乘积：\n$$F_{\\mathrm{total, CT}} = N_{\\mathrm{inst, CT}} \\times F_{\\mathrm{inst, CT}} = 8252 \\times 266240 = 2197178880~\\text{字节}$$\n\n其次，我们计算MR检查的存储足迹。\nMR检查的给定参数如下：\n-   脑部扫描范围长度：$L_{\\mathrm{MR}} = 144~\\mathrm{mm}$\n-   层厚：$3~\\mathrm{mm}$\n-   切片间距：$0~\\mathrm{mm}$，所以 $\\Delta_{\\mathrm{MR}} = 3~\\mathrm{mm}$\n-   回波：$E_{\\mathrm{MR}} = 2$\n-   动态时间点：$T_{\\mathrm{MR}} = 60$\n-   矩阵维度：$N_{\\mathrm{rows}} = 256$, $N_{\\mathrm{cols}} = 256$\n-   每像素分配位数：$B_{\\mathrm{MR}} = 16$\n-   每实例的DICOM头文件大小：$H = 4096$ 字节\n-   无损压缩因子：$s_{\\mathrm{MR}} = 1.5$\n\n重建的切片数是：\n$$N_{\\mathrm{slices, MR}} = \\lceil \\frac{L_{\\mathrm{MR}}}{\\Delta_{\\mathrm{MR}}} \\rceil = \\lceil \\frac{144}{3} \\rceil = \\lceil 48 \\rceil = 48$$\nMR检查的实例总数是切片数、回波数和时间点数的乘积：\n$$N_{\\mathrm{inst, MR}} = N_{\\mathrm{slices, MR}} \\times E_{\\mathrm{MR}} \\times T_{\\mathrm{MR}} = 48 \\times 2 \\times 60 = 5760$$\n接下来，我们计算单个MR实例的存储大小。未压缩的像素数据大小 $S_{\\mathrm{unc, MR}}$ 为：\n$$S_{\\mathrm{unc, MR}} = \\frac{N_{\\mathrm{rows}} \\times N_{\\mathrm{cols}} \\times B_{\\mathrm{MR}}}{8} = \\frac{256 \\times 256 \\times 16}{8} = 131072~\\text{字节}$$\n压缩的像素数据大小 $S_{\\mathrm{comp, MR}}$ 为：\n$$S_{\\mathrm{comp, MR}} = \\frac{S_{\\mathrm{unc, MR}}}{s_{\\mathrm{MR}}} = \\frac{131072}{1.5}$$\n每个MR实例的足迹 $F_{\\mathrm{inst, MR}}$ 为：\n$$F_{\\mathrm{inst, MR}} = S_{\\mathrm{comp, MR}} + H = \\frac{131072}{1.5} + 4096$$\nMR检查的总存储足迹是：\n$$F_{\\mathrm{total, MR}} = N_{\\mathrm{inst, MR}} \\times F_{\\mathrm{inst, MR}} = 5760 \\times \\left( \\frac{131072}{1.5} + 4096 \\right)$$\n$$F_{\\mathrm{total, MR}} = \\frac{5760}{1.5} \\times 131072 + 5760 \\times 4096 = 3840 \\times 131072 + 23592960$$\n$$F_{\\mathrm{total, MR}} = 503316480 + 23592960 = 526909440~\\text{字节}$$\n\n最后，我们将两项检查的足迹相加得到总量：\n$$F_{\\mathrm{total}} = F_{\\mathrm{total, CT}} + F_{\\mathrm{total, MR}} = 2197178880 + 526909440 = 2724088320~\\text{字节}$$\n问题要求答案以千兆字节（GB）为单位，其中 $1~\\mathrm{GB} = 10^9$ 字节。\n$$F_{\\mathrm{total, GB}} = \\frac{2724088320}{10^9} = 2.72408832~\\mathrm{GB}$$\n四舍五入到四位有效数字，我们得到 $2.724~\\mathrm{GB}$。",
            "answer": "$$\\boxed{2.724}$$"
        },
        {
            "introduction": "辅助系统不仅要存储数据，还必须能顺畅处理持续流入的信息，避免形成瓶颈。PACS的数据接收服务是关键节点，其性能直接关系到临床医生能否及时获取影像。本练习运用排队论这一强大的运筹学工具，来为PACS的数据接收子系统建立性能模型。 通过推导和应用M/M/c排队模型，您将学习如何量化分析系统性能、预测等待时间，并为资源配置（例如，确定所需路由器的数量）提供科学依据。",
            "id": "4822802",
            "problem": "一家医院的影像归档和通信系统（PACS）接收由放射学信息系统（RIS）协调的各种模态设备发来的医学数字成像和通信（DICOM）研究，这些研究带有源自检验信息系统（LIS）的患者标识符。为防止接收瓶颈，该PACS系统使用 $c$ 个相同的网络路由器，这些路由器运行先到先服务（FCFS）队列，在存储前接收并验证入站的研究。\n\n假设使用以下基本要素为PACS接收子系统建模：\n- 研究的到达构成一个泊松过程，其速率为 $\\lambda$（单位时间内的研究数）。\n- 每个路由器提供独立且服从指数分布的服务时间，其速率为 $\\mu$（每个路由器单位时间内的研究数）。\n- 系统在稳态下运行，且满足 $\\lambda < c\\mu$。\n\n将该接收子系统建模为 $M/M/c$ 排队。仅从上述定义和 $M/M/c$ 的稳态生灭平衡出发，推导出队列中的期望等待时间 $W_q$ 的闭式解析表达式，该表达式是关于 $\\lambda$、$\\mu$ 和 $c$ 的函数。然后，对于科学上符合实际的配置 $\\lambda = 12$ 研究/分钟，$\\mu = 5$ 研究/分钟/路由器，以及 $c = 3$ 个路由器，计算 $W_q$ 的值。将 $W_q$ 的最终数值以秒为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "本题要求推导 $M/M/c$ 排队系统中队列的期望等待时间 $W_q$，然后对一组特定参数进行数值计算。推导过程必须从基本的稳态生灭平衡方程出发。\n\n该系统被建模为一个 $M/M/c$ 排队，其到达率为 $\\lambda$，每个服务台的服务率为 $\\mu$，有 $c$ 个相同的服务台。系统处于稳态，这要求满足稳定性条件 $\\lambda < c\\mu$。\n\n设 $P_n$ 为系统中存在 $n$ 个研究（顾客）的稳态概率，其中 $n = 0, 1, 2, \\dots$。系统的状态是当前存在的研究数量。\n\n该生灭过程由以下速率来表征：\n- 到达率（生率）是恒定的，与状态 $n$ 无关：$\\lambda_n = \\lambda$ 对所有 $n \\ge 0$ 成立。\n- 服务率（灭率）取决于繁忙服务台的数量。如果系统中有 $n$ 个研究，则有 $\\min(n, c)$ 个服务台是繁忙的。由于每个服务台的服务速率为 $\\mu$，总服务率为 $\\mu_n = \\min(n, c)\\mu$。\n  - 对于 $1 \\le n < c$，$\\mu_n = n\\mu$。\n  - 对于 $n \\ge c$，$\\mu_n = c\\mu$。\n\n稳态平衡方程表达了这样一个原理：对于每个状态 $n$，进入状态 $n$ 的速率等于离开状态 $n$ 的速率。\n对于状态 $n=0$：\n$\\lambda P_0 = \\mu_1 P_1 \\implies \\lambda P_0 = \\mu P_1$\n对于状态 $1 \\le n < c$：\n$(\\lambda + n\\mu)P_n = \\lambda P_{n-1} + (n+1)\\mu P_{n+1}$\n对于状态 $n \\ge c$：\n$(\\lambda + c\\mu)P_n = \\lambda P_{n-1} + c\\mu P_{n+1}$\n\n通过考虑相邻状态之间的流量，可以简化这些方程，得到细致平衡方程：\n$\\lambda P_{n-1} = \\mu_n P_n$ 对于 $n \\ge 1$。\n\n由此，我们可以用 $P_0$ 来表示 $P_n$：\n对于 $1 \\le n \\le c$：\n$P_n = \\frac{\\lambda}{\\mu_n} P_{n-1} = \\frac{\\lambda}{n\\mu} P_{n-1}$。\n展开此递推关系，我们得到：\n$P_n = \\frac{\\lambda^n}{n!\\mu^n} P_0 = \\frac{(\\lambda/\\mu)^n}{n!} P_0$。\n\n对于 $n > c$：\n$P_n = \\frac{\\lambda}{\\mu_n} P_{n-1} = \\frac{\\lambda}{c\\mu} P_{n-1}$。\n令服务台利用率为 $\\rho = \\frac{\\lambda}{c\\mu}$。稳定性条件是 $\\rho < 1$。\n$P_n = \\rho P_{n-1}$ 对于 $n > c$。\n将此关系展开回溯至状态 $c$：\n$P_n = \\rho^{n-c} P_c$。\n代入 $P_c$ 的表达式：\n$P_n = \\rho^{n-c} \\frac{(\\lambda/\\mu)^c}{c!} P_0$。\n\n为了求出 $P_0$，我们使用归一化条件 $\\sum_{n=0}^{\\infty} P_n = 1$：\n$$1 = \\sum_{n=0}^{c-1} P_n + \\sum_{n=c}^{\\infty} P_n$$\n$$1 = P_0 \\sum_{n=0}^{c-1} \\frac{(\\lambda/\\mu)^n}{n!} + P_0 \\sum_{n=c}^{\\infty} \\frac{(\\lambda/\\mu)^c}{c!} \\rho^{n-c}$$\n令 $k = n-c$：\n$$\\sum_{n=c}^{\\infty} \\rho^{n-c} = \\sum_{k=0}^{\\infty} \\rho^k = \\frac{1}{1-\\rho}$$\n因为 $\\rho < 1$，这个几何级数收敛。将其代回：\n$$1 = P_0 \\left[ \\sum_{n=0}^{c-1} \\frac{(\\lambda/\\mu)^n}{n!} + \\frac{(\\lambda/\\mu)^c}{c!} \\frac{1}{1-\\rho} \\right]$$\n因此，$P_0$ 由下式给出：\n$$P_0 = \\left[ \\sum_{n=0}^{c-1} \\frac{(\\lambda/\\mu)^n}{n!} + \\frac{(\\lambda/\\mu)^c}{c! (1 - \\lambda/(c\\mu))} \\right]^{-1}$$\n\n一个到达的研究当且仅当所有 $c$ 个服务台都繁忙时才必须在队列中等待。这个事件的概率，通常称为爱尔兰C公式 $C(r,c)$（其中 $r=\\lambda/\\mu$），是：\n$$P(\\text{queue}) = \\sum_{n=c}^{\\infty} P_n = P_c \\sum_{k=0}^{\\infty} \\rho^k = \\frac{P_c}{1-\\rho} = P_0 \\frac{(\\lambda/\\mu)^c}{c!(1-\\rho)}$$\n\n队列中的期望等待时间 $W_q$ 可以通过对到达是否需要排队进行条件化来求得。\n$W_q = P(\\text{queue}) \\cdot E[W_q | \\text{must queue}] + P(\\text{no queue}) \\cdot 0$。\n假定一个到达的研究必须排队，它会发现系统中已有 $n \\ge c$ 个研究。由于指数服务时间的无记忆性，任何正在进行的服务其剩余服务时间仍然服从速率为 $\\mu$ 的指数分布。$c$ 个繁忙服务台的总服务率为 $c\\mu$。因此，到下一次服务完成的时间服从速率为 $c\\mu$ 的指数分布。\n令 $N_q$ 为一个到达必须排队时，队列中的研究数量。在 $n \\ge c$ 的条件下，到达时发现队列中有 $k$ 个研究（总共 $n=c+k$ 个）的概率是 $\\frac{P_{c+k}}{P(\\text{queue})} = \\frac{P_c \\rho^k}{P_c/(1-\\rho)} = (1-\\rho)\\rho^k$。这是一个几何分布，其均值为 $E[N_q] = \\frac{\\rho}{1-\\rho}$。\n一个到达的研究必须等待队列中排在它前面的 $N_q$ 个研究被服务完毕，再加上当前正在被那个将要空闲的服务台服务的那个研究。等等，这个思路稍有偏差。到达的研究必须等待来自 $c$ 个服务台的 $N_q+1$ 次服务*完成*。每次服务完成的期望时间是 $1/(c\\mu)$。因此，条件等待时间是：\n$E[W_q | \\text{must queue}] = E[N_q+1] \\cdot \\frac{1}{c\\mu} = (E[N_q]+1) \\frac{1}{c\\mu} = \\left(\\frac{\\rho}{1-\\rho} + 1\\right) \\frac{1}{c\\mu} = \\frac{1}{1-\\rho} \\frac{1}{c\\mu} = \\frac{1}{c\\mu - c\\mu\\rho} = \\frac{1}{c\\mu - \\lambda}$。\n这个结果非常简洁：那些必须排队者的期望等待时间是系统剩余服务能力的倒数。\n\n那么，队列中的无条件期望等待时间是：\n$$W_q = P(\\text{queue}) \\cdot \\frac{1}{c\\mu - \\lambda}$$\n代入 $P(\\text{queue})$ 的表达式：\n$$W_q = \\frac{1}{c\\mu - \\lambda} \\left( P_0 \\frac{(\\lambda/\\mu)^c}{c!(1 - \\lambda/(c\\mu))} \\right)$$\n其中 $P_0$ 如上所示。这就是 $W_q$ 的闭式解析表达式。\n\n现在我们对给定参数计算 $W_q$ 的值：\n- $\\lambda = 12$ 研究/分钟\n- $\\mu = 5$ 研究/分钟/路由器\n- $c = 3$ 个路由器\n\n首先，我们计算无量纲参数：\n- 话务强度，$r = \\frac{\\lambda}{\\mu} = \\frac{12}{5} = 2.4$。\n- 服务台利用率，$\\rho = \\frac{\\lambda}{c\\mu} = \\frac{12}{3 \\times 5} = \\frac{12}{15} = 0.8$。\n稳定性条件 $\\rho < 1$ 得到满足。\n\n接下来，我们计算 $P_0^{-1}$ 的各个组成部分：\n求和项：\n$$\\sum_{n=0}^{c-1} \\frac{r^n}{n!} = \\sum_{n=0}^{2} \\frac{(2.4)^n}{n!} = \\frac{(2.4)^0}{0!} + \\frac{(2.4)^1}{1!} + \\frac{(2.4)^2}{2!} = 1 + 2.4 + \\frac{5.76}{2} = 1 + 2.4 + 2.88 = 6.28$$\n排队项：\n$$\\frac{r^c}{c!(1-\\rho)} = \\frac{(2.4)^3}{3!(1-0.8)} = \\frac{13.824}{6 \\times 0.2} = \\frac{13.824}{1.2} = 11.52$$\n现在我们求 $P_0$：\n$$P_0 = (6.28 + 11.52)^{-1} = (17.80)^{-1}$$\n\n接下来，我们计算排队概率，$P(\\text{queue})$：\n$$P(\\text{queue}) = P_0 \\times \\frac{r^c}{c!(1-\\rho)} = \\frac{1}{17.80} \\times 11.52 = \\frac{11.52}{17.80} \\approx 0.647191$$\n\n最后，我们计算以分钟为单位的 $W_q$：\n$$W_q = \\frac{P(\\text{queue})}{c\\mu - \\lambda} = \\frac{11.52 / 17.80}{3 \\times 5 - 12} = \\frac{11.52 / 17.80}{3} = \\frac{11.52}{53.4} \\approx 0.215730337 \\text{ 分钟}$$\n\n题目要求答案以秒为单位，并四舍五入到四位有效数字。\n$$W_q \\text{ (单位：秒)} = 0.215730337 \\text{ 分钟} \\times 60 \\frac{\\text{秒}}{\\text{分钟}} \\approx 12.94382022 \\text{ 秒}$$\n四舍五入到四位有效数字，我们得到 $12.94$。",
            "answer": "$$\\boxed{12.94}$$"
        },
        {
            "introduction": "在复杂的医院信息环境中，数据并非总是完美的。“孤立”的DICOM检查——即在PACS中存在但未能与放射学信息系统（RIS）中的检查申请正确关联的检查——是数据质量和患者安全方面的一大挑战。本练习将指导您建立一个概率模型，以解决自动关联这些孤立数据这一难题。 通过这项实践，您将运用概率论在不确定性下进行推理，这是医疗信息学的一项核心技能，并学会量化评估数据关联算法的错误匹配风险。",
            "id": "4822823",
            "problem": "一家医院使用图像存档与通信系统 (PACS) 来存储医学数字成像与通信 (DICOM) 研究，并使用放射科信息系统 (RIS) 来管理医嘱和登记号。一项“孤立”DICOM 研究是指存在于 PACS 中，但缺少与其相应 RIS 登记号链接的研究。为了执行链接，该医院部署了一种确定性策略，该策略会考量从 DICOM 头文件和候选 RIS 登记号中提取的以下四个元数据字段：患者标识符、患者姓氏 Soundex 码、检查模态以及在容差窗口内的研究开始时间。当且仅当候选者中只有一个 RIS 登记号在所有四个字段上与 DICOM 研究匹配时，该策略才声明一个链接；如果零个或多于一个候选者在所有四个字段上都匹配，则该策略不进行链接。\n\n现要求您为此链接建立一个概率匹配模型，并在以下科学上合理的运行条件下，计算一个典型高流量日单个孤立 DICOM 研究的预期错误链接概率：\n\n- 候选池是该机构在 $24$ 小时窗口内的所有 RIS 登记号，总数为 $N = 400$。\n- 对于真实的 DICOM–RIS 对，由于独立的数据问题，每个字段都可能不一致，各字段的错误概率为：患者标识符 $e_{1} = 0.005$、患者姓氏 Soundex 码 $e_{2} = 0.03$、研究开始时间在 $\\pm 10$ 分钟内 $e_{3} = 0.02$、以及检查模态 $e_{4} = 0.01$。\n- 对于任何错误的 DICOM–RIS 对，单个字段偶然匹配的概率由该机构的经验背景率给出，这些率在不同字段和登记号之间是独立的：患者标识符 $r_{1} = 1.0 \\times 10^{-4}$、患者姓氏 Soundex 码 $r_{2} = 0.01$、研究开始时间在 $\\pm 10$ 分钟内 $r_{3} = 0.033$、以及检查模态 $r_{4} = 0.20$。\n\n假设在给定配对类型（真实或错误）的情况下，字段一致性是条件独立的，并且不同候选登记号之间相互独立。请使用独立伯努利试验的概率论第一性原理，从这些假设中推导出该策略在当天产生错误链接的预期概率的精确表达式。然后使用上述参数对其进行数值评估。将最终答案表示为小数，并四舍五入到四位有效数字。",
            "solution": "问题陈述已经过严格验证，被认为是自洽的、有科学依据且表述清晰的。解决问题所需的所有数据和条件均已提供，并且它们与概率论的基本原理和医学信息学的实践相符。该问题是一个可形式化的概率建模练习。因此，我将进行详细解答。\n\n设 $D$ 为孤立的 DICOM 研究。候选池由 $N=400$ 个 RIS 登记号组成。该池中包含一个且仅一个正确的对应登记号，我们将其表示为 $R_0$，以及 $N-1 = 399$ 个不正确的登记号，表示为 $R_1, R_2, \\dots, R_{399}$。\n\n链接策略声明一个链接，当且仅当整个池 $\\{R_0, R_1, \\dots, R_{399}\\}$ 中只有一个登记号在所有四个指定的元数据字段上与 $D$ 匹配。如果这个唯一的匹配登记号是不正确的登记号之一，即 $\\{R_1, R_2, \\dots, R_{399}\\}$ 中的一个元素，则发生错误链接。\n\n让我们来定义这些基本匹配事件的概率。\n\n真实配对 $(D, R_0)$ 在所有四个字段上都匹配的概率 $p_{true}$，是四个字段中任何一个都没有数据错误的概率。各字段的错误概率给出为 $e_1=0.005$，$e_2=0.03$，$e_3=0.02$ 和 $e_4=0.01$。由于错误是独立的，所有四个字段上一致的概率是各个一致概率的乘积：\n$$p_{true} = P(M_0) = (1-e_1)(1-e_2)(1-e_3)(1-e_4)$$\n真实配对在所有四个字段上*不*匹配的概率是：\n$$P(M_0^c) = 1 - p_{true} = 1 - (1-e_1)(1-e_2)(1-e_3)(1-e_4)$$\n\n对于 $i \\in \\{1, \\dots, 399\\}$，一个不正确的配对 $(D, R_i)$ 在所有四个字段上偶然匹配的概率 $p_{wrong}$，是独立的经验背景匹配率 $r_1=1.0 \\times 10^{-4}$、$r_2=0.01$、$r_3=0.033$ 和 $r_4=0.20$ 的乘积。\n$$p_{wrong} = P(M_i) = r_1 r_2 r_3 r_4 \\quad (\\text{for } i \\geq 1)$$\n\n如果 $M_0$ 为假，且 $N-1$ 个事件 $\\{M_1, M_2, \\dots, M_{N-1}\\}$ 中恰好有一个为真，则发生错误链接。设 $X$ 为在所有四个字段上与 $D$ 匹配的不正确登记号的数量。\n$$X = \\sum_{i=1}^{N-1} \\mathbf{1}_{M_i}$$\n其中 $\\mathbf{1}_{M_i}$ 是事件 $M_i$ 的指示变量。\n\n问题陈述中说明，不同错误登记号的匹配是独立的。因此，事件 $M_1, \\dots, M_{N-1}$ 是独立的伯努利试验，每次试验的成功概率为 $p_{wrong}$。因此，$X$ 服从二项分布：\n$$X \\sim \\text{Binomial}(n=N-1, p=p_{wrong})$$\n恰好有一个不正确登记号匹配的概率是 $P(X=1)$。\n$$P(X=1) = \\binom{N-1}{1} p_{wrong}^1 (1-p_{wrong})^{(N-1)-1} = (N-1) p_{wrong} (1-p_{wrong})^{N-2}$$\n\n错误链接事件 $F$ 是两个独立事件的交集：真实配对不匹配 ($M_0^c$) 和恰好有一个错误配对匹配 $(\\{X=1\\})$。独立性由问题陈述保证（“不同候选登记号之间相互独立”）。\n$$P(F) = P(M_0^c \\cap \\{X=1\\}) = P(M_0^c) \\times P(X=1)$$\n代入上面推导出的表达式，我们得到错误链接概率的精确公式：\n$$P(F) = \\left[1 - \\prod_{k=1}^{4}(1-e_k)\\right] \\times \\left[(N-1) \\left(\\prod_{k=1}^{4}r_k\\right) \\left(1 - \\prod_{k=1}^{4}r_k\\right)^{N-2}\\right]$$\n现在，我们代入给定的数值来计算这个表达式。\n给定的值为：\n$N=400$\n$e_1=0.005$，$e_2=0.03$，$e_3=0.02$，$e_4=0.01$\n$r_1=1.0 \\times 10^{-4}$，$r_2=0.01$，$r_3=0.033$，$r_4=0.20$\n\n首先，计算 $p_{true}$ 和 $P(M_0^c)$：\n$$p_{true} = (1-0.005)(1-0.03)(1-0.02)(1-0.01) = (0.995)(0.97)(0.98)(0.99)$$\n$$p_{true} = 0.96515 \\times 0.9702 = 0.93638853$$\n$$P(M_0^c) = 1 - p_{true} = 1 - 0.93638853 = 0.06361147$$\n\n接下来，计算 $p_{wrong}$：\n$$p_{wrong} = (1.0 \\times 10^{-4})(0.01)(0.033)(0.20)$$\n$$p_{wrong} = (10^{-4})(10^{-2})(3.3 \\times 10^{-2})(2 \\times 10^{-1}) = 6.6 \\times 10^{-9}$$\n\n现在，使用 $n=N-1=399$ 和 $p=p_{wrong}=6.6 \\times 10^{-9}$ 来计算 $P(X=1)$：\n$$P(X=1) = \\binom{399}{1} (6.6 \\times 10^{-9})^1 (1 - 6.6 \\times 10^{-9})^{399-1}$$\n$$P(X=1) = 399 \\times (6.6 \\times 10^{-9}) \\times (1 - 6.6 \\times 10^{-9})^{398}$$\n项 $(1 - 6.6 \\times 10^{-9})^{398}$ 非常接近于 $1$。\n$(1 - 6.6 \\times 10^{-9})^{398} \\approx 0.9999973732$\n所以，\n$$P(X=1) \\approx 399 \\times (6.6 \\times 10^{-9}) \\times 0.9999973732$$\n$$P(X=1) \\approx 2.6334 \\times 10^{-6} \\times 0.9999973732 \\approx 2.63339308 \\times 10^{-6}$$\n\n最后，我们计算总的错误链接概率 $P(F)$：\n$$P(F) = P(M_0^c) \\times P(X=1)$$\n$$P(F) \\approx 0.06361147 \\times (2.63339308 \\times 10^{-6})$$\n$$P(F) \\approx 1.675129 \\times 10^{-7}$$\n其小数值为 $0.0000001675129$。\n四舍五入到四位有效数字，我们得到 $0.0000001675$。",
            "answer": "$$\\boxed{0.0000001675}$$"
        }
    ]
}