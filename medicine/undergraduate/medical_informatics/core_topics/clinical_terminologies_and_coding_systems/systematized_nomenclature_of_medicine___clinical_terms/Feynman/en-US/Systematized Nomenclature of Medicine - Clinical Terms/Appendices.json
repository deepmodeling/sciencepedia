{
    "hands_on_practices": [
        {
            "introduction": "SNOMED CT's power comes not from being a simple list of terms, but from its structure as a vast, machine-readable network of interconnected clinical ideas. This exercise introduces the fundamental `$is\\_a$` relationship, known as subsumption, which allows a computer to infer that 'Streptococcal pharyngitis' is a type of 'Infectious disease'. You will practice traversing this hierarchy and see how the system handles retired or replaced concepts, a crucial skill for querying clinical data that has been recorded over many years .",
            "id": "4857928",
            "problem": "Consider a fragment of the Systematized Nomenclature of Medicine — Clinical Terms (SNOMED CT) ontology. In SNOMED CT, a concept hierarchy is represented by $is\\_a$ relationships. Let the directed graph $G = (V, E)$ represent the inferred $is\\_a$ hierarchy for a given release snapshot, where $V$ is the set of concepts and $E \\subseteq V \\times V$ contains an ordered pair $(c\\_1, c\\_2)$ when $c\\_1\\ is\\_a\\ c\\_2$ is inferred and active. Only active concepts and active relationships are included in the inferred view used for clinical queries. Let the strict descendant relation $<$ be the transitive closure of $is\\_a$ over the inferred graph, excluding reflexivity: for concepts $x, y \\in V$, $x < y$ if and only if there exists a path of length at least $1$ from $x$ to $y$ following edges in $E$. When querying with inactive concepts, the recommended practice is to first resolve historical associations, such as $REPLACED\\_BY$, to an active concept when available; those associations are not $is\\_a$ and do not themselves participate in the hierarchy.\n\nYou are given the following concepts with their statuses and associations, and the active inferred $is\\_a$ edges for a current release snapshot:\n\nConcepts (with identifiers and status):\n- $100000$: Clinical finding (Active)\n- $100100$: Infectious disease (Active)\n- $200000$: Respiratory disorder (Active)\n- $200101$: Disease of upper respiratory tract (Active)\n- $200110$: Acute pharyngitis (Active)\n- $300000$: Bacterial infectious disease (Active)\n- $300100$: Streptococcal pharyngitis (Active)\n- $200100$: Upper respiratory disorder (Inactive), with historical association $REPLACED\\_BY \\rightarrow 200101$\n- $900000$: Obsolete upper respiratory category (Inactive), with no historical associations\n\nActive inferred $is\\_a$ edges $E$ (each listed as child $\\rightarrow$ parent):\n- $100100 \\rightarrow 100000$\n- $200000 \\rightarrow 100000$\n- $200101 \\rightarrow 200000$\n- $200110 \\rightarrow 200101$\n- $300000 \\rightarrow 100100$\n- $300100 \\rightarrow 200110$\n- $300100 \\rightarrow 300000$\n\nAssume all edges shown are active and complete for this fragment, and no other active inferred $is\\_a$ edges exist among these nodes. For this question, interpret “$A$ subsumes $B$” as “$B$ is a strict descendant of $A$,” i.e., $B < A$ in the active inferred hierarchy. If the candidate ancestor is inactive, a query may first be rewritten by applying a single $REPLACED\\_BY$ association to obtain an active ancestor, if such an association exists; other historical associations must not be treated as $is\\_a$.\n\nWhich of the following statements are correct?\n\nA. In the active inferred hierarchy, $100100$ subsumes $300100$.\n\nB. In the active inferred hierarchy, $200100$ subsumes $200110$.\n\nC. If an implementation first resolves the inactive concept $200100$ via its $REPLACED\\_BY$ association to $200101$ and then performs subsumption, the query “Does $200100$ subsume $200110$?” should be answered as true.\n\nD. In the active inferred hierarchy, $200101$ subsumes $300100$.\n\nE. Since $900000$ has no $REPLACED\\_BY$ association, a system should treat “Does $900000$ subsume $200110$?” as true if there was historically any parent–child link, even if it is currently removed.",
            "solution": "### Problem Validation\n\n**Step 1: Extract Givens**\n\nThe problem provides the following information:\n- A directed graph $G = (V, E)$ represents the active inferred $is\\_a$ hierarchy from a SNOMED CT release snapshot. $V$ is the set of active concepts, and $E$ is the set of active inferred $is\\_a$ relationships.\n- An ordered pair $(c_1, c_2) \\in E$ means \"$c_1\\ is\\_a\\ c_2$\".\n- The strict descendant relation, denoted by $<$, is the transitive closure of the $is\\_a$ relation, excluding reflexivity. $x < y$ if there is a path of length at least $1$ from $x$ to $y$ in $G$.\n- The statement “$A$ subsumes $B$” is defined as $B < A$.\n- For queries involving an inactive candidate ancestor, the inactive concept may be replaced by an active concept using a single $REPLACED\\_BY$ association. Other historical associations are not used for this purpose.\n\n**Concepts and Statuses:**\n- $100000$: Clinical finding (Active)\n- $100100$: Infectious disease (Active)\n- $200000$: Respiratory disorder (Active)\n- $200101$: Disease of upper respiratory tract (Active)\n- $200110$: Acute pharyngitis (Active)\n- $300000$: Bacterial infectious disease (Active)\n- $300100$: Streptococcal pharyngitis (Active)\n- $200100$: Upper respiratory disorder (Inactive), with historical association $REPLACED\\_BY \\rightarrow 200101$.\n- $900000$: Obsolete upper respiratory category (Inactive), with no historical associations.\n\n**Active Inferred $is\\_a$ Edges $E$ (child $\\rightarrow$ parent):**\n- $(100100, 100000)$\n- $(200000, 100000)$\n- $(200101, 200000)$\n- $(200110, 200101)$\n- $(300000, 100100)$\n- $(300100, 200110)$\n- $(300100, 300000)$\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is grounded in medical informatics, specifically using the structure and terminology of SNOMED CT, a widely adopted clinical terminology standard. The concepts of polyhierarchy, active/inactive status, and historical associations like $REPLACED\\_BY$ are authentic features of SNOMED CT.\n- **Well-Posed**: The problem is well-posed. It defines a directed graph and a set of rules for traversal and substitution. The question asks to evaluate specific statements based on these rules. The provided data is sufficient to construct the graph and apply the rules to find a unique answer for each statement.\n- **Objective**: The language is precise and objective. Terms like \"subsumes\", \"strict descendant\", and \"active inferred hierarchy\" are given clear, formal definitions within the problem context.\n- **Completeness and Consistency**: The problem is self-contained. It provides all necessary concepts, their statuses, and the complete set of relevant active relationships ($is\\_a$ edges). The rules for handling inactive concepts are explicitly stated. There are no apparent contradictions in the given data or rules. For instance, the polyhierarchy of concept $300100$ is a valid structure in SNOMED CT.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. It is a well-defined question based on authentic principles of medical terminology systems and graph theory. The solution process can proceed.\n\n### Solution Derivation\n\nFirst, we construct the graph $G=(V, E)$ representing the active inferred hierarchy. The set of vertices $V$ consists of all active concepts, and the set of edges $E$ consists of the active inferred $is\\_a$ relationships.\n\nThe set of active concepts is $V = \\{100000, 100100, 200000, 200101, 200110, 300000, 300100\\}$.\nThe set of edges $E$ is given by the list of child $\\rightarrow$ parent relationships. Let's represent an edge as an ordered pair $(child, parent)$:\n$E = \\{ (100100, 100000), (200000, 100000), (200101, 200000), (200110, 200101), (300000, 100100), (300100, 200110), (300100, 300000) \\}$.\n\nThe problem defines \"$A$ subsumes $B$\" as $B < A$, which means there is a path of length at least $1$ from concept $B$ to concept $A$ in the graph $G$. We will now evaluate each option based on this definition and the provided rules.\n\n**A. In the active inferred hierarchy, $100100$ subsumes $300100$.**\n\nThis statement translates to verifying if $300100 < 100100$. This requires finding a path of length $\\ge 1$ from node $300100$ to node $100100$ in the graph $G$.\nLooking at the edges in $E$:\n1. There is an edge $(300100, 300000)$, meaning $300100 \\rightarrow 300000$.\n2. There is an edge $(300000, 100100)$, meaning $300000 \\rightarrow 100100$.\n\nBy concatenating these edges, we form the path $300100 \\rightarrow 300000 \\rightarrow 100100$. This is a path of length $2$. Since a path of length $\\ge 1$ exists, the condition $300100 < 100100$ is met. Thus, $100100$ subsumes $300100$.\n\nVerdict for A: **Correct**.\n\n**B. In the active inferred hierarchy, $200100$ subsumes $200110$.**\n\nThis statement refers to the \"active inferred hierarchy\". As defined in the problem, this hierarchy is represented by the graph $G=(V, E)$, where $V$ is the set of *active* concepts.\nThe concept $200100$ is explicitly stated to be 'Inactive'. Therefore, $200100 \\notin V$.\nSince the subsumption relationship is defined over the graph $G$, and $200100$ is not a vertex in $G$, it cannot subsume any concept within the active hierarchy. The statement makes a claim about the active hierarchy that involves an inactive concept in a role it cannot fulfill per the problem definition.\n\nVerdict for B: **Incorrect**.\n\n**C. If an implementation first resolves the inactive concept $200100$ via its $REPLACED\\_BY$ association to $200101$ and then performs subsumption, the query “Does $200100$ subsume $200110$?” should be answered as true.**\n\nThis option describes a specific querying procedure for an inactive concept.\n1. The query is \"Does $200100$ subsume $200110$?\". Here, the candidate ancestor is $200100$, which is inactive.\n2. The problem provides the rule for this scenario: \"a query may first be rewritten by applying a single $REPLACED\\_BY$ association to obtain an active ancestor\".\n3. The concept $200100$ has the association $REPLACED\\_BY \\rightarrow 200101$. The concept $200101$ is active.\n4. Following the rule, the query is rewritten by replacing $200100$ with $200101$. The new query is \"Does $200101$ subsume $200110$?\".\n5. This rewritten query translates to verifying if $20110 < 200101$. This requires finding a path of length $\\ge 1$ from $20110$ to $200101$.\n6. The set of edges $E$ contains the edge $(200110, 200101)$, which corresponds to the path $200110 \\rightarrow 200101$. This is a path of length $1$.\n7. Since a path exists, the rewritten query is true. The option states the original query should be answered as true, which is the correct outcome of this procedure.\n\nVerdict for C: **Correct**.\n\n**D. In the active inferred hierarchy, $200101$ subsumes $300100$.**\n\nThis statement translates to verifying if $300100 < 200101$. This requires finding a path of length $\\ge 1$ from node $300100$ to node $200101$ in the graph $G$.\nLet's trace paths from $300100$:\n1. There is an edge $(300100, 200110)$, meaning $300100 \\rightarrow 200110$.\n2. There is an edge $(200110, 200101)$, meaning $200110 \\rightarrow 200101$.\n\nConcatenating these edges forms the path $300100 \\rightarrow 200110 \\rightarrow 200101$. This is a path of length $2$. Since a path of length $\\ge 1$ exists, the condition $300100 < 200101$ is met. Thus, $200101$ subsumes $300100$.\n\nVerdict for D: **Correct**.\n\n**E. Since $900000$ has no $REPLACED\\_BY$ association, a system should treat “Does $900000$ subsume $200110$?” as true if there was historically any parent–child link, even if it is currently removed.**\n\nThis option proposes a rule for handling an inactive concept ($900000$) that has no $REPLACED\\_BY$ association.\nThe rule proposed is to \"treat as true if there was historically any parent-child link\".\nThe problem statement provides a very strict framework for queries: \"Only active concepts and active relationships are included in the inferred view used for clinical queries.\" This explicitly forbids using historical, inactive relationships for subsumption logic. The only exception provided for inactive concepts is the use of a $REPLACED\\_BY$ association to find an active substitute.\nThe concept $900000$ is inactive and has no $REPLACED\\_BY$ association, so it cannot be resolved to an active concept. It is not part of the active hierarchy $G$, and there is no mechanism specified in the problem to handle it otherwise. The rule suggested in option E directly contradicts the foundational principles laid out in the problem description.\n\nVerdict for E: **Incorrect**.",
            "answer": "$$\\boxed{ACD}$$"
        },
        {
            "introduction": "Beyond simple parent-child links, the definition of a single SNOMED CT concept can be highly detailed, using a formal system called Description Logic. This practice delves into 'role groups', a critical feature for correctly modeling complex procedures or diseases with multiple, related attributes, such as associating a specific surgical device with a specific anatomical site. By exploring a common modeling error, you will learn why precise attribute grouping is essential for preventing a classifier from making nonsensical inferences .",
            "id": "4857874",
            "problem": "An electronic health record system classifies procedures using the Systematized Nomenclature of Medicine - Clinical Terms (SNOMED CT). In SNOMED CT’s concept model, attributes such as Procedure site, Method, Using device, and Associated morphology are represented in description logic as existential role restrictions of the form $\\exists r.C$, combined with conjunction $\\sqcap$. Attribute co-occurrence is enforced by Role group via a grouping attribute, so that all attributes in a clinical “set” must be satisfied together within a single group. Consider the following fully defined procedure concepts intended to model two unilateral excisions performed during the same operative session, one on the left lung using a laser and one on the right lung using forceps, and three related reference concepts:\n\n- Target concept intended meaning (with Role groups): a bilateral procedure consisting of two sets:\n  Group $1$: Method $=$ Excision, Procedure site $=$ Left lung structure, Associated morphology $=$ Lesion, Using device $=$ Laser device.\n  Group $2$: Method $=$ Excision, Procedure site $=$ Right lung structure, Associated morphology $=$ Lesion, Using device $=$ Forceps.\n\n- Reference concepts:\n  $Q_1$: Excision of lesion of right lung using laser.\n  $Q_2$: Excision of lesion of left lung using forceps.\n  $Q_3$: Bilateral excision of lesions of lungs (devices unspecified).\n  $Q_4$: Excision of lesion of ear using laser.\n\nFormally, using description logic, let the following abbreviations denote SNOMED CT attribute roles and values: $site$ for Procedure site, $method$ for Method, $device$ for Using device, $morph$ for Associated morphology, $RG$ for Role group, and let $L$ denote Left lung structure, $R$ denote Right lung structure, $E$ denote Ear structure, $Exc$ denote Excision - action, $Les$ denote Lesion morphology, $Las$ denote Laser device, and $For$ denote Forceps.\n\nThen the intended bilateral concept with role groups is:\n$$P_{\\text{RG}} \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les)\\ \\sqcap\\ \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les).$$\n\nSuppose, however, that role groups are mistakenly omitted during authoring, and the concept is flattened to a simple conjunction of attributes:\n$$P_{\\neg RG} \\equiv \\exists site.L \\sqcap \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists device.For \\sqcap \\exists morph.Les.$$\n\nThe reference concepts are defined as:\n$$Q_1 \\equiv \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les),$$\n$$Q_2 \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les),$$\n$$Q_3 \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les)\\ \\sqcap\\ \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les),$$\n$$Q_4 \\equiv \\exists RG.(\\exists site.E \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les).$$\n\nAnalyze the consequences of omitting Role groups in this multi-attribute definition. Which of the following subsumptions would be incorrectly inferred by a classifier from $P_{\\neg RG}$, but would not be inferred from $P_{\\text{RG}}$? Select all that apply.\n\nA. $P_{\\neg RG}$ is subsumed by $Q_1$ (Excision of lesion of right lung using laser).\n\nB. $P_{\\neg RG}$ is subsumed by $Q_2$ (Excision of lesion of left lung using forceps).\n\nC. $P_{\\neg RG}$ is subsumed by $Q_3$ (Bilateral excision of lesions of lungs, devices unspecified).\n\nD. $P_{\\neg RG}$ is subsumed by $Q_4$ (Excision of lesion of ear using laser).\n\nAssume standard SNOMED CT description logic semantics, where fully defined concepts have necessary and sufficient conditions, $\\exists r.C$ denotes existential role restriction, $\\sqcap$ denotes conjunction, and subsumption $\\sqsubseteq$ holds when the left-hand concept’s conditions logically entail the right-hand concept’s conditions. The number of Role groups is $2$ in $P_{\\text{RG}}$, and $0$ in $P_{\\neg RG}$ due to omission.",
            "solution": "The user wants a critical validation of the provided problem statement followed by a detailed solution.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Logic System:** Description Logic (DL) as used in Systematized Nomenclature of Medicine - Clinical Terms (SNOMED CT).\n*   **DL Constructs:** Existential role restriction ($\\exists r.C$), conjunction ($\\sqcap$), subsumption ($\\sqsubseteq$), and Role Grouping ($RG$).\n*   **Scenario:** Modeling a bilateral procedure with two distinct parts: (1) excision on the left lung with a laser, and (2) excision on the right lung with forceps.\n*   **DL Abbreviations:**\n    *   Roles: $site$, $method$, $device$, $morph$, $RG$.\n    *   Concepts: $L$ (Left lung structure), $R$ (Right lung structure), $E$ (Ear structure), $Exc$ (Excision - action), $Les$ (Lesion morphology), $Las$ (Laser device), $For$ (Forceps).\n*   **Concept Definitions:**\n    *   Correctly modeled concept with Role Groups:\n        $$P_{\\text{RG}} \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les)\\ \\sqcap\\ \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les)$$\n    *   Incorrectly modeled concept omitting Role Groups:\n        $$P_{\\neg RG} \\equiv \\exists site.L \\sqcap \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists device.For \\sqcap \\exists morph.Les$$\n    *   Reference Concepts:\n        $$Q_1 \\equiv \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les)$$\n        $$Q_2 \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les)$$\n        $$Q_3 \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les)\\ \\sqcap\\ \\exists RG.(\\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les)$$\n        $$Q_4 \\equiv \\exists RG.(\\exists site.E \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les)$$\n*   **Question:** Identify which subsumptions of the form $P_{\\neg RG} \\sqsubseteq Q_i$ would be inferred by a classifier, but where the corresponding subsumption $P_{\\text{RG}} \\sqsubseteq Q_i$ would not be inferred.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem is firmly based on the principles of knowledge representation using description logic, which is the formal foundation of the SNOMED CT terminology. The use of existential restrictions, conjunction, and role grouping to model clinical concepts is standard practice in medical informatics. The problem is scientifically sound.\n2.  **Well-Posed:** The problem provides explicit and formal definitions for all concepts involved and asks a precise question about logical subsumption. The question is structured to have a unique, derivable answer based on the rules of description logic.\n3.  **Objective:** The problem is stated in the unambiguous and formal language of description logic, free from subjective or opinion-based assertions.\n4.  **Incomplete or Contradictory Setup:** The problem is self-contained. The scenario described, where role groups are omitted, is a well-known and critical type of modeling error in SNOMED CT. The provided definitions are consistent with this scenario.\n5.  **Unrealistic or Infeasible:** The scenario is a realistic representation of a potential authoring error in a large-scale clinical terminology.\n6.  **Ill-Posed or Poorly Structured:** The problem is well-structured and requires substantive reasoning about the semantic consequences of different logical representations.\n7.  **Pseudo-Profound, Trivial, or Tautological:** The problem addresses a non-trivial distinction between grouped and ungrouped attributes in a description logic model, which has significant practical implications for automated classification and data retrieval. It is not a trivial problem.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The analysis can proceed.\n\n### Solution Derivation\n\nThe central task is to analyze the logical consequences of the modeling error, which is the omission of explicit Role Groups ($RG$). In the SNOMED CT concept model, attributes like $site$ and $device$ are groupable. When they are defined on a concept without being explicitly assigned to different groups, a DL classifier treats them as belonging to a single, implicit group (often called group $0$).\n\nTherefore, the \"flattened\" concept $P_{\\neg RG}$ is interpreted by a classifier as a concept with a single role group that contains the conjunction of all specified attributes. The effective logical definition, which we will denote as $P'_{\\neg RG}$, is:\n$$P'_{\\neg RG} \\equiv \\exists RG.(\\exists site.L \\sqcap \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists device.For \\sqcap \\exists morph.Les)$$\nThis incorrectly represents a single procedural context that involves both lungs, both a laser and forceps, etc.\n\nThe correctly modeled concept $P_{\\text{RG}}$ uses two separate role groups to correctly associate the device with the site for each sub-procedure:\n$$P_{\\text{RG}} \\equiv \\exists RG.(\\exists site.L \\sqcap \\dots \\sqcap \\exists device.Las \\dots)\\ \\sqcap\\ \\exists RG.(\\exists site.R \\sqcap \\dots \\sqcap \\exists device.For \\dots)$$\n\nThe question asks for which concepts $Q_i$ the subsumption $P'_{\\neg RG} \\sqsubseteq Q_i$ is true, while $P_{\\text{RG}} \\sqsubseteq Q_i$ is false.\n\nLet us define the inner content of the role groups for clarity:\n$C_{\\neg RG} \\equiv \\exists site.L \\sqcap \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists device.For \\sqcap \\exists morph.Les$\n$C_{RG_L} \\equiv \\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les$ (from $P_{\\text{RG}}$)\n$C_{RG_R} \\equiv \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les$ (from $P_{\\text{RG}}$)\n$C_{Q1} \\equiv \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les$\n$C_{Q2} \\equiv \\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists device.For \\sqcap \\exists morph.Les$\n$C_{Q3_L} \\equiv \\exists site.L \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les$\n$C_{Q3_R} \\equiv \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les$\n$C_{Q4} \\equiv \\exists site.E \\sqcap \\exists method.Exc \\sqcap \\exists device.Las \\sqcap \\exists morph.Les$\n\nSubsumption for a single role group, $\\exists RG.C_A \\sqsubseteq \\exists RG.C_B$, holds if and only if $C_A \\sqsubseteq C_B$. This, in turn, holds if the set of restrictions in $C_B$ is a subset of the restrictions in $C_A$.\n\n### Option-by-Option Analysis\n\n**A. $P_{\\neg RG}$ is subsumed by $Q_1$ (Excision of lesion of right lung using laser).**\n\n1.  **Analyze $P'_{\\neg RG} \\sqsubseteq Q_1$:**\n    The subsumption $P'_{\\neg RG} \\equiv \\exists RG.C_{\\neg RG} \\sqsubseteq Q_1 \\equiv \\exists RG.C_{Q1}$ holds if $C_{\\neg RG} \\sqsubseteq C_{Q1}$.\n    The definition of $C_{\\neg RG}$ contains every role restriction present in $C_{Q1}$: $\\exists site.R$, $\\exists method.Exc$, $\\exists device.Las$, and $\\exists morph.Les$. Since $C_{\\neg RG}$ is a conjunction of all restrictions in $C_{Q1}$ plus others, any instance of $C_{\\neg RG}$ is necessarily an instance of $C_{Q1}$. Thus, $C_{\\neg RG} \\sqsubseteq C_{Q1}$ holds. The subsumption is inferred.\n\n2.  **Analyze $P_{\\text{RG}} \\sqsubseteq Q_1$:**\n    $P_{\\text{RG}} \\equiv \\exists RG.C_{RG_L} \\sqcap \\exists RG.C_{RG_R}$. For this to be subsumed by $Q_1 \\equiv \\exists RG.C_{Q1}$, at least one of its role groups must be subsumed by $Q_1$'s role group. This means we need either $C_{RG_L} \\sqsubseteq C_{Q1}$ or $C_{RG_R} \\sqsubseteq C_{Q1}$.\n    *   Is $C_{RG_L} \\sqsubseteq C_{Q1}$? No. $C_{RG_L}$ requires $\\exists site.L$, while $C_{Q1}$ requires $\\exists site.R$. Assuming Left lung ($L$) and Right lung ($R$) are disjoint concepts, this condition fails.\n    *   Is $C_{RG_R} \\sqsubseteq C_{Q1}$? No. $C_{RG_R}$ requires $\\exists device.For$, while $C_{Q1}$ requires $\\exists device.Las$. Assuming Forceps ($For$) and Laser device ($Las$) are disjoint, this condition fails.\n    Since neither role group's content from $P_{\\text{RG}}$ is a subtype of $C_{Q1}$, the subsumption $P_{\\text{RG}} \\sqsubseteq Q_1$ does not hold.\n\n**Verdict on A:** The subsumption is inferred for $P_{\\neg RG}$ but not for $P_{\\text{RG}}$. This is an incorrect inference resulting from the modeling error. Therefore, option A is **Correct**.\n\n**B. $P_{\\neg RG}$ is subsumed by $Q_2$ (Excision of lesion of left lung using forceps).**\n\n1.  **Analyze $P'_{\\neg RG} \\sqsubseteq Q_2$:**\n    The subsumption $P'_{\\neg RG} \\equiv \\exists RG.C_{\\neg RG} \\sqsubseteq Q_2 \\equiv \\exists RG.C_{Q2}$ holds if $C_{\\neg RG} \\sqsubseteq C_{Q2}$.\n    The definition of $C_{\\neg RG}$ contains every role restriction present in $C_{Q2}$: $\\exists site.L$, $\\exists method.Exc$, $\\exists device.For$, and $\\exists morph.Les$. Therefore, $C_{\\neg RG} \\sqsubseteq C_{Q2}$ holds. The subsumption is inferred.\n\n2.  **Analyze $P_{\\text{RG}} \\sqsubseteq Q_2$:**\n    For $P_{\\text{RG}} \\sqsubseteq Q_2$ to hold, we need either $C_{RG_L} \\sqsubseteq C_{Q2}$ or $C_{RG_R} \\sqsubseteq C_{Q2}$.\n    *   Is $C_{RG_L} \\sqsubseteq C_{Q2}$? No. $C_{RG_L}$ requires $\\exists device.Las$, while $C_{Q2}$ requires $\\exists device.For$.\n    *   Is $C_{RG_R} \\sqsubseteq C_{Q2}$? No. $C_{RG_R}$ requires $\\exists site.R$, while $C_{Q2}$ requires $\\exists site.L$.\n    The subsumption $P_{\\text{RG}} \\sqsubseteq Q_2$ does not hold.\n\n**Verdict on B:** The subsumption is inferred for $P_{\\neg RG}$ but not for $P_{\\text{RG}}$. This is an incorrect inference resulting from the modeling error. Therefore, option B is **Correct**.\n\n**C. $P_{\\neg RG}$ is subsumed by $Q_3$ (Bilateral excision of lesions of lungs, devices unspecified).**\n\n1.  **Analyze $P'_{\\neg RG} \\sqsubseteq Q_3$:**\n    $Q_3 \\equiv \\exists RG.C_{Q3_L} \\sqcap \\exists RG.C_{Q3_R}$. An instance of $P'_{\\neg RG}$ has one role group filler that is an instance of $C_{\\neg RG}$. For this to be an instance of $Q_3$, this filler must satisfy the conditions for $Q_3$. This is possible if a single filler can satisfy both conjuncts. This requires the filler to be an instance of $C_{Q3_L} \\sqcap C_{Q3_R}$.\n    We check if $C_{\\neg RG} \\sqsubseteq (C_{Q3_L} \\sqcap C_{Q3_R})$.\n    $C_{Q3_L} \\sqcap C_{Q3_R} = (\\exists site.L \\sqcap \\dots) \\sqcap (\\exists site.R \\sqcap \\dots) = \\exists site.L \\sqcap \\exists site.R \\sqcap \\exists method.Exc \\sqcap \\exists morph.Les$.\n    The definition of $C_{\\neg RG}$ contains all these restrictions, so $C_{\\neg RG} \\sqsubseteq (C_{Q3_L} \\sqcap C_{Q3_R})$. The subsumption is inferred.\n\n2.  **Analyze $P_{\\text{RG}} \\sqsubseteq Q_3$:**\n    For $P_{\\text{RG}} \\sqsubseteq Q_3$ to hold, an instance of $P_{\\text{RG}}$ must satisfy the definition of $Q_3$. An instance of $P_{\\text{RG}}$ has two role group fillers, one of type $C_{RG_L}$ and another of type $C_{RG_R}$.\n    We check $C_{RG_L} \\sqsubseteq C_{Q3_L}$: This is true, as $C_{RG_L}$ contains all restrictions of $C_{Q3_L}$ plus $\\exists device.Las$.\n    We check $C_{RG_R} \\sqsubseteq C_{Q3_R}$: This is true, as $C_{RG_R}$ contains all restrictions of $C_{Q3_R}$ plus $\\exists device.For$.\n    Thus, the two distinct role group fillers in an instance of $P_{\\text{RG}}$ satisfy the two role group requirements of $Q_3$. The subsumption $P_{\\text{RG}} \\sqsubseteq Q_3$ holds and is clinically correct.\n\n**Verdict on C:** The subsumption is inferred for both $P_{\\neg RG}$ and $P_{\\text{RG}}$. Since it is not a case where the inference is made for $P_{\\neg RG}$ but *not* for $P_{\\text{RG}}$, option C is **Incorrect**.\n\n**D. $P_{\\neg RG}$ is subsumed by $Q_4$ (Excision of lesion of ear using laser).**\n\n1.  **Analyze $P'_{\\neg RG} \\sqsubseteq Q_4$:**\n    The subsumption $P'_{\\neg RG} \\sqsubseteq Q_4$ holds if $C_{\\neg RG} \\sqsubseteq C_{Q4}$.\n    $C_{Q4}$ requires the restriction $\\exists site.E$ (Ear structure). The definition of $C_{\\neg RG}$ contains $\\exists site.L$ and $\\exists site.R$, but not $\\exists site.E$. Assuming that Lung ($L,R$) and Ear ($E$) are disjoint concepts, an instance of $C_{\\neg RG}$ is not guaranteed to be an instance of $C_{Q4}$. The subsumption does not hold.\n\n**Verdict on D:** The subsumption is not inferred for $P_{\\neg RG}$. Therefore, option D is **Incorrect**.",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "This final practice applies your knowledge to a core task in clinical analytics: identifying patient cohorts for research or quality measurement. You will use the SNOMED CT Expression Constraint Language (ECL) to build a computable definition for a group of patients based on their diagnoses. This hands-on simulation demonstrates how changes in the terminology version can impact cohort membership and calculated prevalence, highlighting a critical challenge in longitudinal data analysis .",
            "id": "4857948",
            "problem": "You are given a simplified, formal model of the Systematized Nomenclature of Medicine - Clinical Terms (SNOMED CT) and the Expression Constraint Language (ECL) to compute cohort prevalence over a fixed patient dataset, under multiple SNOMED CT versions with inactivation events. The objective is to derive, implement, and compute cohort prevalence strictly from first principles of set theory and graph traversal, and to quantify sensitivity to version changes.\n\nAssume a concept taxonomy is a directed acyclic graph where concepts are nodes and the edge relation is the \"is-a\" parent-to-child relation. For a version $V$, define a finite set of active concepts $\\mathcal{A}_V \\subset \\mathbb{N}$ and a parent-to-children adjacency $\\Gamma_V : \\mathbb{N} \\to 2^{\\mathbb{N}}$. For a concept $c \\in \\mathbb{N}$ and version $V$, define the descendant closure over active concepts as:\n$$\n\\mathrm{Desc}_V(c) = \\{ x \\in \\mathcal{A}_V \\mid \\text{there exists a path from } c \\text{ to } x \\text{ following } \\Gamma_V \\}.\n$$\nDefine the descendants-or-self set as:\n$$\n\\mathrm{DescSelf}_V(c) = \\{c\\} \\cap \\mathcal{A}_V \\;\\cup\\; \\mathrm{Desc}_V(c).\n$$\n\nDefine the core semantics of the subset of the Expression Constraint Language (ECL) used here:\n- A term of the form \"<<C\" denotes $\\mathrm{DescSelf}_V(C)$ for an integer concept identifier $C$.\n- A term of the form \"<C\" denotes $\\mathrm{Desc}_V(C)$ for an integer concept identifier $C$.\n- A constraint can be a disjunction of terms with \" OR \" interpreted as set union.\n\nLet the Systematized Nomenclature of Medicine - Clinical Terms (SNOMED CT) be represented in three versions $V_1$, $V_2$, and $V_3$ with active concepts and adjacency as follows (all concept identifiers are integers):\n\nVersion $V_1$ active set $\\mathcal{A}_{V_1}$:\n$\\{100, 110, 115, 120, 125, 130, 200, 210\\}$.\n\nVersion $V_1$ adjacency $\\Gamma_{V_1}$ given by parent-to-children sets:\n- $100 \\mapsto \\{110, 120, 130\\}$,\n- $110 \\mapsto \\{115\\}$,\n- $115 \\mapsto \\emptyset$,\n- $120 \\mapsto \\{125\\}$,\n- $125 \\mapsto \\emptyset$,\n- $130 \\mapsto \\emptyset$,\n- $200 \\mapsto \\{210\\}$,\n- $210 \\mapsto \\emptyset$.\n\nVersion $V_2$ active set $\\mathcal{A}_{V_2}$:\n$\\{100, 110, 115, 120, 125, 131, 200, 210\\}$, where $130$ is inactivated and a new concept $131$ is added.\n\nVersion $V_2$ adjacency $\\Gamma_{V_2}$:\n- $100 \\mapsto \\{110, 120, 131\\}$,\n- $110 \\mapsto \\{115\\}$,\n- $115 \\mapsto \\emptyset$,\n- $120 \\mapsto \\{125\\}$,\n- $125 \\mapsto \\emptyset$,\n- $131 \\mapsto \\emptyset$,\n- $200 \\mapsto \\{210\\}$,\n- $210 \\mapsto \\emptyset$.\n\nVersion $V_3$ active set $\\mathcal{A}_{V_3}$:\n$\\{100, 110, 115, 120, 131, 200, 210\\}$, where $125$ is inactivated.\n\nVersion $V_3$ adjacency $\\Gamma_{V_3}$:\n- $100 \\mapsto \\{110, 120, 131\\}$,\n- $110 \\mapsto \\{115\\}$,\n- $115 \\mapsto \\emptyset$,\n- $120 \\mapsto \\emptyset$,\n- $131 \\mapsto \\emptyset$,\n- $200 \\mapsto \\{210\\}$,\n- $210 \\mapsto \\emptyset$.\n\nLet the patient population be $\\mathcal{P} = \\{p_1, p_2, p_3, p_4, p_5, p_6, p_7, p_8\\}$ of size $|\\mathcal{P}| = 8$, and each patient has a finite set of diagnosis concept identifiers $D(p)$:\n- $D(p_1) = \\{110\\}$,\n- $D(p_2) = \\{115\\}$,\n- $D(p_3) = \\{120\\}$,\n- $D(p_4) = \\{130\\}$,\n- $D(p_5) = \\{210\\}$,\n- $D(p_6) = \\{200\\}$,\n- $D(p_7) = \\{100\\}$,\n- $D(p_8) = \\{125\\}$.\n\nFor a given ECL constraint interpreted into a set of active concepts $S_V \\subseteq \\mathcal{A}_V$ at version $V$, define cohort membership indicator function:\n$$\n\\mathbf{1}_S(p, V) = \n\\begin{cases}\n1 & \\text{if } D(p) \\cap S_V \\neq \\emptyset, \\\\\n0 & \\text{otherwise}.\n\\end{cases}\n$$\nDefine the prevalence at version $V$ as the fraction:\n$$\n\\mathrm{Prev}(V) = \\frac{\\sum_{p \\in \\mathcal{P}} \\mathbf{1}_S(p, V)}{|\\mathcal{P}|}.\n$$\nAll prevalence values must be reported as decimals rounded to $3$ decimal places (no percentage sign).\n\nTest suite:\nCompute the following, for each ECL constraint and for versions $V_1$, $V_2$, and $V_3$, and then compute successive differences $\\Delta_{2-1} = \\mathrm{Prev}(V_2) - \\mathrm{Prev}(V_1)$ and $\\Delta_{3-2} = \\mathrm{Prev}(V_3) - \\mathrm{Prev}(V_2)$:\n- Test $A$: ECL constraint \"<<100\".\n- Test $B$: ECL constraint \"<100\".\n- Test $C$: ECL constraint \"<<200 OR <<100\".\n- Test $D$: ECL constraint \"<<130\".\n\nFinal output format:\nYour program should produce a single line of output containing a flattened, comma-separated list enclosed in square brackets, comprising the sequence of $20$ values in this exact order with each value rounded to $3$ decimal places:\n$[\\mathrm{Prev}_{A}(V_1), \\mathrm{Prev}_{A}(V_2), \\mathrm{Prev}_{A}(V_3), \\Delta_{A,2-1}, \\Delta_{A,3-2}, \\mathrm{Prev}_{B}(V_1), \\mathrm{Prev}_{B}(V_2), \\mathrm{Prev}_{B}(V_3), \\Delta_{B,2-1}, \\Delta_{B,3-2}, \\mathrm{Prev}_{C}(V_1), \\mathrm{Prev}_{C}(V_2), \\mathrm{Prev}_{C}(V_3), \\Delta_{C,2-1}, \\Delta_{C,3-2}, \\mathrm{Prev}_{D}(V_1), \\mathrm{Prev}_{D}(V_2), \\mathrm{Prev}_{D}(V_3), \\Delta_{D,2-1}, \\Delta_{D,3-2}]$.",
            "solution": "The problem is valid as it is self-contained, scientifically grounded in the principles of medical informatics, set theory, and graph theory, and is mathematically well-posed. All necessary data, definitions, and constraints are provided to compute a unique, verifiable solution.\n\nThe solution proceeds by first translating the formal definitions provided in the problem statement into a computational algorithm. The core of this task involves modeling the SNOMED CT versions, evaluating Expression Constraint Language (ECL) queries against them, and calculating cohort prevalence from a given patient dataset.\n\nFirst, we represent the data for each SNOMED CT version, $V_1$, $V_2$, and $V_3$. Each version $V$ is defined by a pair of data structures:\n1.  The set of active concepts, $\\mathcal{A}_V$.\n2.  The parent-to-children adjacency list, $\\Gamma_V$, which defines the \"is-a\" hierarchy as a directed graph.\n\nThe central operation is the evaluation of an ECL constraint, which translates into a specific set of active concepts, $S_V \\subseteq \\mathcal{A}_V$. The problem provides definitions for two ECL operators, `<<C` and `<C`, and the `OR` conjunction.\n\nThe semantics of `<C` and `<<C` are defined via the descendant closure. A generic graph traversal algorithm, such as Breadth-First Search (BFS), is implemented to compute the set of all concepts reachable from a given starting concept $c$ following the edges in $\\Gamma_V$. This gives the full set of descendants, from which we derive $\\mathrm{Desc}_V(c)$ and $\\mathrm{DescSelf}_V(c)$ based on their formal definitions:\n\n1.  **Descendant Closure $\\mathrm{Desc}_V(c)$**: This set is computed by first finding all descendants of $c$ by traversing the graph $\\Gamma_V$. The resulting set of concepts is then intersected with the active concept set $\\mathcal{A}_V$ for the specific version, ensuring that only active concepts are included.\n    $$\n    \\mathrm{Desc}_V(c) = \\{ x \\in \\mathcal{A}_V \\mid \\text{there exists a path from } c \\text{ to } x \\text{ following } \\Gamma_V \\}.\n    $$\n2.  **Descendants-or-Self Closure $\\mathrm{DescSelf}_V(c)$**: This set is constructed by taking the union of $\\mathrm{Desc}_V(c)$ and the concept $c$ itself, if $c$ is present in the active set $\\mathcal{A}_V$.\n    $$\n    \\mathrm{DescSelf}_V(c) = (\\{c\\} \\cap \\mathcal{A}_V) \\cup \\mathrm{Desc}_V(c).\n    $$\n3.  **ECL Disjunction (`OR`)**: For a constraint like \"Term1 OR Term2\", the resulting concept set is the set union of the concepts derived from evaluating Term1 and Term2 individually.\n\nOnce the ECL constraint is evaluated to a final concept set $S_V$ for a given version $V$, we calculate the cohort prevalence. The patient population $\\mathcal{P}$ consists of $|\\mathcal{P}| = 8$ patients, each with a set of diagnosis codes $D(p)$. The cohort membership indicator function $\\mathbf{1}_S(p, V)$ determines if a patient belongs to the cohort defined by $S_V$. A patient $p$ is a member if their diagnosis set $D(p)$ has a non-empty intersection with the cohort's concept set $S_V$.\n$$\n\\mathbf{1}_S(p, V) = 1 \\iff D(p) \\cap S_V \\neq \\emptyset.\n$$\nThe prevalence is the fraction of patients in the cohort:\n$$\n\\mathrm{Prev}(V) = \\frac{\\sum_{p \\in \\mathcal{P}} \\mathbf{1}_S(p, V)}{|\\mathcal{P}|}.\n$$\n\nThis entire process is systematically applied to each of the four test cases (A, B, C, D). For each test, we calculate $\\mathrm{Prev}(V_1)$, $\\mathrm{Prev}(V_2)$, and $\\mathrm{Prev}(V_3)$. Subsequently, the successive differences $\\Delta_{2-1} = \\mathrm{Prev}(V_2) - \\mathrm{Prev}(V_1)$ and $\\Delta_{3-2} = \\mathrm{Prev}(V_3) - \\mathrm{Prev}(V_2)$ are computed. These $5$ values for each of the $4$ tests comprise the final flat list of $20$ results, with each value rounded to $3$ decimal places as required.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the SNOMED CT prevalence calculation problem based on the provided formal model.\n    \"\"\"\n\n    # Define the data for the three SNOMED CT versions\n    versions = [\n        {\n            'name': 'V1',\n            'active_set': {100, 110, 115, 120, 125, 130, 200, 210},\n            'adj_list': {\n                100: {110, 120, 130}, 110: {115}, 120: {125}, 200: {210}\n            }\n        },\n        {\n            'name': 'V2',\n            'active_set': {100, 110, 115, 120, 125, 131, 200, 210},\n            'adj_list': {\n                100: {110, 120, 131}, 110: {115}, 120: {125}, 200: {210}\n            }\n        },\n        {\n            'name': 'V3',\n            'active_set': {100, 110, 115, 120, 131, 200, 210},\n            'adj_list': {\n                100: {110, 120, 131}, 110: {115}, 200: {210}\n            }\n        }\n    ]\n\n    # Define patient data\n    patient_diagnoses = [\n        {110}, {115}, {120}, {130}, {210}, {200}, {100}, {125}\n    ]\n    num_patients = len(patient_diagnoses)\n\n    # Define test suite\n    test_ecls = [\n        (\"<<100\"),\n        (\"<100\"),\n        (\"<<200 OR <<100\"),\n        (\"<<130\"),\n    ]\n\n    def get_all_descendants(start_node, adj_list):\n        \"\"\"\n        Performs a graph traversal (BFS) to find all descendants of a start_node.\n        \"\"\"\n        queue = [start_node]\n        visited = {start_node}\n        descendants = set()\n        \n        head = 0\n        while head < len(queue):\n            current = queue[head]\n            head += 1\n            \n            for child in adj_list.get(current, set()):\n                if child not in visited:\n                    visited.add(child)\n                    descendants.add(child)\n                    queue.append(child)\n        return descendants\n\n    def evaluate_ecl(ecl_string, version):\n        \"\"\"\n        Evaluates an ECL string for a given version, returning the set of concepts.\n        \"\"\"\n        active_set = version['active_set']\n        adj_list = version['adj_list']\n        \n        final_concept_set = set()\n        \n        ecl_terms = ecl_string.split(' OR ')\n        \n        for term in ecl_terms:\n            term = term.strip()\n            op = ''\n            concept_id_str = ''\n            \n            if term.startswith('<<'):\n                op = '<<'\n                concept_id_str = term[2:]\n            elif term.startswith('<'):\n                op = '<'\n                concept_id_str = term[1:]\n            \n            concept_id = int(concept_id_str)\n            \n            # Desc_V(c)\n            all_desc = get_all_descendants(concept_id, adj_list)\n            desc_v_c = all_desc.intersection(active_set)\n            \n            # DescSelf_V(c) or Desc_V(c) based on operator\n            term_set = set()\n            if op == '<':\n                term_set = desc_v_c\n            elif op == '<<':\n                self_set = {concept_id}.intersection(active_set)\n                term_set = self_set.union(desc_v_c)\n            \n            final_concept_set.update(term_set)\n            \n        return final_concept_set\n\n    def calculate_prevalence(concept_set, diagnoses_list, total_patients):\n        \"\"\"\n        Calculates prevalence based on a concept set and patient diagnoses.\n        \"\"\"\n        if not concept_set:\n            return 0.0\n        \n        matched_patients = 0\n        for diag_set in diagnoses_list:\n            if not diag_set.isdisjoint(concept_set):\n                matched_patients += 1\n                \n        return matched_patients / total_patients\n\n    all_results = []\n    for ecl in test_ecls:\n        prevalences = []\n        for v in versions:\n            concept_set = evaluate_ecl(ecl, v)\n            prevalence = calculate_prevalence(concept_set, patient_diagnoses, num_patients)\n            prevalences.append(prevalence)\n\n        # Calculate successive differences\n        delta_21 = prevalences[1] - prevalences[0]\n        delta_32 = prevalences[2] - prevalences[1]\n        \n        test_results = prevalences + [delta_21, delta_32]\n        all_results.extend(test_results)\n\n    # Format results to 3 decimal places\n    formatted_results = [f\"{val:.3f}\" for val in all_results]\n    \n    # Print in the required single-line format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}