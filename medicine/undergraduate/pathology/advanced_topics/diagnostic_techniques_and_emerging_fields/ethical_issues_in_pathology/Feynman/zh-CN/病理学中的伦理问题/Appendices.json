{
    "hands_on_practices": [
        {
            "introduction": "病理学中的一个基本伦理责任是保护患者隐私。当为了研究目的而共享数据时，我们必须确保个体不会被重新识别。本练习将介绍一种名为 $k$-匿名的实用技术，它通过量化和限制重识别风险来实现这一目标。通过这个实践 ，你将学习如何将一个抽象的隐私保护要求（即风险阈值）转化为一个具体的数据处理策略。",
            "id": "4366371",
            "problem": "一家医院病理科打算在保密性的伦理原则和《健康保险流通与责任法案》(HIPAA) 中阐明的隐私保护监管要求下，共享一个去标识化的数据集用于二次研究。为了在保留分析效用的同时限制重识别风险，该科室对准标识符（年龄、居住地邮政编码和诊断）采用了$k$-匿名性。该团队将泛化约束在临床上可接受的分组内：年龄按十年分箱，邮政编码截断为其三位数字前缀，诊断分为三个具有临床意义的类别。\n\n在这些经批准的泛化下，数据集形成了由三元组（年龄十年段、三位邮政编码前缀、诊断类别）定义的等价类。每个等价类中的记录数为：\n(30–39岁, 021**, 感染性): $28$, (30–39岁, 021**, 肿瘤): $31$, (30–39岁, 021**, 自身免疫性): $26$; (30–39岁, 022**, 感染性): $24$, (30–39岁, 022**, 肿瘤): $29$, (30–39岁, 022**, 自身免疫性): $33$; (40–49岁, 021**, 感染性): $27$, (40–49岁, 021**, 肿瘤): $35$, (40–49岁, 021**, 自身免疫性): $25$; (40–49岁, 022**, 感染性): $32$, (40–49岁, 022**, 肿瘤): $36$, (40–49岁, 022**, 自身免疫性): $30$。\n\n在除了准标识符之外没有额外背景知识的情况下，该科室将每个等价类的重识别风险定义为：当攻击者仅知道准标识符时，其能正确匹配一条记录的概率。伦理要求是，这个每类风险不得超过一个目标值 $r$，其中 $r$ 被指定为 $r=\\frac{1}{24}$。\n\n从$k$-匿名性的第一性原理和所述的风险模型出发，计算最小的 $k$ 值，使得在应用了经批准的泛化之后，数据集中的每个等价类都同时满足其重识别风险小于或等于 $r$ 的要求。将 $k$ 报告为精确整数，无需四舍五入。",
            "solution": "该问题要求确定$k$-匿名性的最小整数 $k$，使得数据集中所有等价类都满足一个特定的重识别风险约束。\n\n首先，我们来形式化问题陈述中提供的原则和定义。\n准标识符是年龄、居住地邮政编码和诊断。对这些标识符应用泛化以形成等价类。一个等价类是一组基于泛化后的准标识符而无法区分的记录。在本问题中，一个等价类由一个唯一的三元组定义：（年龄十年段、三位邮政编码前缀、诊断类别）。\n\n令 $N_i$ 为第 $i$ 个等价类中的记录数，即其大小。问题提供了由指定泛化产生的所有等价类的大小：\n(30–39岁, 021**, 感染性) 的 $N_1 = 28$\n(30–39岁, 021**, 肿瘤) 的 $N_2 = 31$\n(30–39岁, 021**, 自身免疫性) 的 $N_3 = 26$\n(30–39岁, 022**, 感染性) 的 $N_4 = 24$\n(30–39岁, 022**, 肿瘤) 的 $N_5 = 29$\n(30–39岁, 022**, 自身免疫性) 的 $N_6 = 33$\n(40–49岁, 021**, 感染性) 的 $N_7 = 27$\n(40–49岁, 021**, 肿瘤) 的 $N_8 = 35$\n(40–49岁, 021**, 自身免疫性) 的 $N_9 = 25$\n(40–49岁, 022**, 感染性) 的 $N_{10} = 32$\n(40–49岁, 022**, 肿瘤) 的 $N_{11} = 36$\n(40–49岁, 022**, 自身免疫性) 的 $N_{12} = 30$\n\n问题定义了每个等价类的重识别风险。对于一个大小为 $N$ 的给定等价类，一个知道目标个体准标识符的攻击者知道该个体的记录是该类中 $N$ 条记录之一。在没有额外背景知识的情况下，这 $N$ 条记录中的每一条都同样可能是正确的那一条。因此，正确匹配的概率，定义为重识别风险 $R$，是：\n$$ R = \\frac{1}{N} $$\n\n伦理要求是这个每类风险不得超过一个目标值 $r$。对于每个大小为 $N_i$ 的等价类 $i$，其风险 $R_i = \\frac{1}{N_i}$ 必须满足：\n$$ R_i \\le r $$\n代入风险的定义，我们得到：\n$$ \\frac{1}{N_i} \\le r $$\n这个不等式可以被重新整理，以找到任何等价类所需的最小大小：\n$$ N_i \\ge \\frac{1}{r} $$\n这个条件必须对数据集中的所有等价类都成立。\n\n问题指定目标风险 $r$ 为：\n$$ r = \\frac{1}{24} $$\n将这个值代入我们的类大小不等式中：\n$$ N_i \\ge \\frac{1}{\\frac{1}{24}} $$\n$$ N_i \\ge 24 $$\n因此，为了满足风险约束，数据集中的每个等价类必须至少包含 $24$ 条记录。\n\n接下来，我们将这个要求与$k$-匿名性原则联系起来。如果每个等价类至少包含 $k$ 条记录，则称该数据集是$k$-匿名的。形式上，为了使一个数据集满足$k$-匿名性，每个等价类的大小 $N_i$ 必须满足：\n$$ N_i \\ge k $$\n问题要求的是最小整数 $k$，使得这个属性（$k$-匿名性）能确保风险约束被满足。为了确保对所有类都满足风险约束（$N_i \\ge 24$），我们必须选择一个能保证此条件的 $k$ 值。\n\n如果我们将匿名级别设置为 $k$，那么对于所有的 $i$ 都有 $N_i \\ge k$。为了保证 $N_i \\ge 24$，我们必须要求 $k$ 本身至少为 $24$。\n$$ k \\ge 24 $$\n问题要求满足此条件的*最小*整数 $k$。大于或等于 $24$ 的最小整数值是 $24$。\n因此，最小的 $k$ 是 $24$。\n\n我们可以用所提供的数据来验证这个结论。对于指定的泛化，数据集的等价类大小为 $\\{28, 31, 26, 24, 29, 33, 27, 35, 25, 32, 36, 30\\}$。其中的最小大小是：\n$$ N_{\\min} = \\min\\{28, 31, 26, 24, 29, 33, 27, 35, 25, 32, 36, 30\\} = 24 $$\n由于最小类大小为 $24$，所给的数据集是 $24$-匿名的。每个类的大小 $N_i$ 都满足 $N_i \\ge 24$，这意味着每个类的风险 $R_i = \\frac{1}{N_i}$ 都满足 $R_i \\le \\frac{1}{24}$。这证实了当 $k=24$ 时，要求被满足。该数据集不是 $25$-匿名的，因为有一个等价类只有 $24$ 条记录。因此，$24$ 确实是既描述了所需匿名级别又被给定数据集实现的最小 $k$ 值。\n最小的 $k$ 是由风险阈值 $r$ 决定的，而不是由观测数据决定的，但数据证实了实现这个 $k$ 值的一致性和可行性。最小要求的 $k$ 是 $\\lceil \\frac{1}{r} \\rceil$。\n$$ k = \\left\\lceil \\frac{1}{\\frac{1}{24}} \\right\\rceil = \\lceil 24 \\rceil = 24 $$",
            "answer": "$$\\boxed{24}$$"
        },
        {
            "introduction": "在诊断决策中，我们常常面临权衡。例如，对于一个癌症筛查测试，我们必须在漏诊（假阴性）的风险和过度诊断（假阳性）的成本之间找到平衡。本练习将向你展示如何运用效用理论，将这些复杂的伦理权衡形式化，并计算出一个“最优”的诊断阈值 。这个过程明确地体现了如何将我们对不同错误类型的价值判断（例如，认为漏诊癌症的危害远大于假警报）融入到客观的决策规则中。",
            "id": "4366335",
            "problem": "一个病理学实验室正在验证一个定量的数字组织病理学分类器，该分类器为每个病例输出一个连续的恶性程度评分 $x$。实验室必须选择一个决策阈值 $t$，使得评分 $x \\geq t$ 的病例被判定为“恶性”，而评分 $x  t$ 的病例被判定为“良性”。该决策的伦理影响通过一个期望效用函数来建模，该函数汇总了各种结果的临床获益与损害。设疾病患病率为 $p$，令 $U_{TP}$ 和 $U_{TN}$ 分别表示真阳性和真阴性决策的净伦理效用。令 $U_{FP}$ 和 $U_{FN}$ 分别表示假阳性和假阴性决策的伦理损害的非负量级（视为成本）。期望效用作为阈值 $t$ 的函数为：\n$$\nU(t) \\;=\\; p \\cdot U_{TP}\\cdot \\mathrm{TPR}(t)\\;+\\;(1-p)\\cdot U_{TN}\\cdot \\big(1-\\mathrm{FPR}(t)\\big)\\;-\\;(1-p)\\cdot U_{FP}\\cdot \\mathrm{FPR}(t)\\;-\\;p \\cdot U_{FN}\\cdot \\big(1-\\mathrm{TPR}(t)\\big),\n$$\n其中 $\\mathrm{TPR}(t)$ 是阈值为 $t$ 时的真阳性率 (TPR)，而 $\\mathrm{FPR}(t)$ 是阈值为 $t$ 时的假阳性率 (FPR)。\n\n假设分类器评分 $x$ 在以疾病状态为条件下服从高斯分布：\n- 对于恶性病例，$x \\sim \\mathcal{N}(\\mu_{D},\\sigma^{2})$；\n- 对于良性病例，$x \\sim \\mathcal{N}(\\mu_{N},\\sigma^{2})$，\n两者方差相等，为 $\\sigma^{2}$，且均值 $\\mu_{D} > \\mu_{N}$。在“若 $x \\geq t$ 则为恶性”的决策规则下，相应的比率为：\n$$\n\\mathrm{TPR}(t) \\;=\\; \\int_{t}^{\\infty} f_{D}(x)\\,dx,\\qquad \\mathrm{FPR}(t) \\;=\\; \\int_{t}^{\\infty} f_{N}(x)\\,dx,\n$$\n其中 $f_{D}$ 和 $f_{N}$ 分别是对应的正态概率密度函数。\n\n从期望效用的核心定义和这些概率定律出发，推导出使 $U(t)$ 最大化的阈值 $t^{*}$，然后根据以下反映癌症诊断中伦理优先级的科学上合理的参数化，计算其数值：\n- 患病率 $p = 0.15$，\n- 恶性评分均值 $\\mu_{D} = 3.2$，\n- 良性评分均值 $\\mu_{N} = 1.8$，\n- 共同标准差 $\\sigma = 0.6$，\n- $U_{TP} = 9$， $U_{TN} = 3$， $U_{FP} = 2$， $U_{FN} = 20$。\n\n以评分单位表示最终阈值，并将答案四舍五入至四位有效数字。",
            "solution": "我们的目标是找到使期望效用函数 $U(t)$ 最大化的阈值 $t^*$。这可以通过对 $U(t)$ 求导并令其等于零来实现。\n\n**步骤1：推导最优阈值**\n首先，我们将期望效用函数 $U(t)$ 重新整理，以便于求导：\n$$\nU(t) = \\mathrm{TPR}(t) \\cdot p(U_{TP} + U_{FN}) - \\mathrm{FPR}(t) \\cdot (1-p)(U_{TN} + U_{FP}) + \\text{常数项}\n$$\n其中常数项不影响最大值的位置。\n接下来，我们对 $U(t)$ 关于 $t$ 求导。根据微积分基本定理，我们知道 $\\frac{d}{dt}\\int_{t}^{\\infty} f(x)dx = -f(t)$。因此：\n$$\n\\frac{d}{dt}\\mathrm{TPR}(t) = -f_{D}(t)\n$$\n$$\n\\frac{d}{dt}\\mathrm{FPR}(t) = -f_{N}(t)\n$$\n对 $U(t)$ 求导得到：\n$$\n\\frac{dU}{dt} = -p(U_{TP} + U_{FN})f_{D}(t) + (1-p)(U_{TN} + U_{FP})f_{N}(t)\n$$\n令导数为零，以找到最优阈值 $t^*$：\n$$\np(U_{TP} + U_{FN})f_{D}(t^*) = (1-p)(U_{TN} + U_{FP})f_{N}(t^*)\n$$\n这可以写成似然比的形式：\n$$\n\\frac{f_{D}(t^*)}{f_{N}(t^*)} = \\frac{(1-p)(U_{TN} + U_{FP})}{p(U_{TP} + U_{FN})}\n$$\n我们用 $C$ 来表示等式右边的常数项。\n对于给定的高斯分布，$f_{D}(t) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t-\\mu_D)^2}{2\\sigma^2}\\right)$ 和 $f_{N}(t) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{(t-\\mu_N)^2}{2\\sigma^2}\\right)$。\n代入似然比公式：\n$$\n\\exp\\left(\\frac{(t^*-\\mu_N)^2 - (t^*-\\mu_D)^2}{2\\sigma^2}\\right) = C\n$$\n取自然对数并展开平方项：\n$$\n\\frac{(t^{*2} - 2t^*\\mu_N + \\mu_N^2) - (t^{*2} - 2t^*\\mu_D + \\mu_D^2)}{2\\sigma^2} = \\ln(C)\n$$\n化简后得到：\n$$\n2t^*(\\mu_D - \\mu_N) - (\\mu_D^2 - \\mu_N^2) = 2\\sigma^2\\ln(C)\n$$\n由于 $\\mu_D > \\mu_N$，我们可以解出 $t^*$：\n$$\nt^* = \\frac{\\mu_D + \\mu_N}{2} + \\frac{\\sigma^2}{\\mu_D - \\mu_N} \\ln(C)\n$$\n将 $C$ 的表达式代回，得到最优阈值的最终解析表达式：\n$$\nt^* = \\frac{\\mu_D + \\mu_N}{2} + \\frac{\\sigma^2}{\\mu_D - \\mu_N} \\ln\\left( \\frac{(1-p)(U_{TN} + U_{FP})}{p(U_{TP} + U_{FN})} \\right)\n$$\n\n**步骤2：数值计算**\n现在，我们代入给定的参数值：\n$p = 0.15$, $\\mu_{D} = 3.2$, $\\mu_{N} = 1.8$, $\\sigma = 0.6$, $U_{TP} = 9$, $U_{TN} = 3$, $U_{FP} = 2$, $U_{FN} = 20$.\n\n首先计算对数项中的常数 $C$：\n$$\nC = \\frac{(1-0.15)(3 + 2)}{0.15(9 + 20)} = \\frac{0.85 \\times 5}{0.15 \\times 29} = \\frac{4.25}{4.35} = \\frac{85}{87}\n$$\n接下来计算公式中的其他部分：\n-   $\\frac{\\mu_D + \\mu_N}{2} = \\frac{3.2 + 1.8}{2} = 2.5$\n-   $\\mu_D - \\mu_N = 3.2 - 1.8 = 1.4$\n-   $\\sigma^2 = 0.6^2 = 0.36$\n\n将这些值代入 $t^*$ 的表达式：\n$$\nt^* = 2.5 + \\frac{0.36}{1.4} \\ln\\left(\\frac{85}{87}\\right)\n$$\n进行数值计算：\n$$\n\\ln\\left(\\frac{85}{87}\\right) \\approx -0.023258\n$$\n$$\nt^* \\approx 2.5 + \\frac{0.36}{1.4} \\times (-0.023258)\n$$\n$$\nt^* \\approx 2.5 + 0.25714 \\times (-0.023258)\n$$\n$$\nt^* \\approx 2.5 - 0.005981\n$$\n$$\nt^* \\approx 2.494019\n$$\n\n**步骤3：格式化答案**\n将结果四舍五入到四位有效数字，得到 $2.494$。\n因此，使期望效用最大化的最优阈值是 $t^* = 2.494$。",
            "answer": "$$\n\\boxed{2.494}\n$$"
        },
        {
            "introduction": "人工智能正在改变病理学，但同时也带来了新的伦理挑战，尤其是算法的公平性。AI模型可能会在无意中学习并放大训练数据中存在的偏见，导致不同患者群体在医疗服务上出现差异。本练习模拟了一个真实的场景，一个AI分诊系统对特定人群存在偏见 。你需要评估不同的纠正策略，并在此过程中深入思考在临床环境中，“公平”究竟意味着什么，例如它是否意味着所有患者都应有同样的机会从准确的诊断中受益。",
            "id": "4366324",
            "problem": "一家医院的病理实验室部署了一套用于数字化切片的计算机辅助分诊系统。该算法为每个病例分配一个风险评分 $s \\in [0,1]$ 和一个内部置信度 $c \\in [0,1]$。风险评分 $s \\ge t$ 的病例被放入紧急审查队列，由病理学家进行快速评估；否则，它们将进入常规审查流程。该实验室服务于两个患者群体：一个受保护群体 $A$ 和一个参照群体 $B$，分别占每日病例的比例为 $w_A = 0.40$ 和 $w_B = 0.60$。真正紧急病理（快速审查对其有益）的患病率在两个群体中均为 $p = 0.25$。每日处理能力限制了紧急分诊的病例数最多为总数的 $\\kappa = 0.35$。\n\n在统一阈值 $t = 0.70$ 下测得的算法性能显示出差异：对于群体 $A$，真阳性率（TPR，即真属紧急病例被分诊为紧急的概率）为 $0.60$，假阳性率（FPR，即非紧急病例被分诊为紧急的概率）为 $0.10$；对于群体 $B$，$\\text{TPR} = 0.80$ 且 $\\text{FPR} = 0.12$。这意味着在相同阈值下，群体 $A$ 处于系统性劣势（灵敏度较低）。\n\n还提供了其他测量的操作点：\n- 如果对群体 $A$ 应用阈值 $t_A = 0.65$，则 $\\text{TPR}_A = 0.75$ 且 $\\text{FPR}_A = 0.14$。\n- 如果对群体 $B$ 应用阈值 $t_B = 0.73$，则 $\\text{TPR}_B = 0.75$ 且 $\\text{FPR}_B = 0.10$。\n\n该实验室寻求一种符合伦理且具备公平意识的分诊策略，该策略应满足以下要求：\n- 通过改善受保护群体获得有益紧急审查的机会，以符合正义原则（平等的受益机会）的方式，解决该群体的系统性劣势。\n- 遵循不伤害原则（最大限度地减少严重疾病的假阴性）和行善原则（优先考虑可能受益者），以维持患者安全。\n- 尊重专业监督，允许病理学家在出现某些警示性情况时进行干预否决。\n- 满足容量限制 $U_{\\text{total}} \\le \\kappa$，其中 $U_{\\text{total}}$ 是被放入紧急分诊队列的病例总比例。\n\n请考虑以下候选决策规则。哪一条最能满足这些伦理和操作要求，并明确指定了适当的干预否决标准？\n\nA. 采用群体特定阈值 $t_A = 0.65$ 和 $t_B = 0.73$，以使各群体的真阳性率相等；实施一条干预否决规则，在满足以下任一条件时将病例转入紧急审查：置信度 $c  \\gamma = 0.60$，切片质量指标 $q  \\eta = 0.50$（表明存在技术伪影），或申请单中的临床医生警示指标 $r = 1$（例如，临床状况迅速恶化）；监控合并后的紧急分诊比例保持在 $\\kappa$ 以下。\n\nB. 通过选择阈值 $t_A$ 和 $t_B$ 来强制实现人口统计均等，使得被分诊为紧急的病例比例满足 $U_A = U_B$，并禁用专家干预以防止超出容量；如有必要，接受不平等的灵敏度，因为紧急队列的成员资格已经均等化。\n\nC. 保留单一阈值 $t = 0.70$，但将群体 $A$ 中 $10\\%$ 的常规病例随机提升至紧急分诊，以弥补其劣势；仅当 $c  0.60$ 时允许对群体 $A$ 进行干预；不对群体 $B$ 的阈值做任何改变。\n\nD. 调整阈值以使群体间的阳性预测值（PPV，即被分诊为紧急的病例中真正为紧急病例的比例）相等；仅在 $c  0.40$ 时允许干预，以减少假警报；只要 PPV 相等，就接受各群体间可能存在的灵敏度差异。\n\n选择唯一的最佳选项。",
            "solution": "该问题要求我们从四个候选策略中选择一个，以最符合伦理和操作要求的方式来解决人工智能分诊系统中的算法偏见问题。我们将根据以下四个核心标准来评估每个选项：正义、安全、专业监督和容量。\n\n问题的核心伦理困境在于，在统一阈值下，受保护群体 $A$ 的真阳性率（TPR）为 $0.60$，显著低于参照群体 $B$ 的 $0.80$。这意味着群体 $A$ 中真正需要紧急审查的患者有更大概率被漏掉，这违反了作为“平等受益机会”的正义原则，也违反了不伤害原则。\n\n**选项 A 分析：**\n- **正义：** 此策略采用群体特定阈值，使得 $\\text{TPR}_A = 0.75$ 和 $\\text{TPR}_B = 0.75$。这实现了真阳性率的均等，直接对应“机会均等”这一公平性标准，从根本上解决了群体 $A$ 的系统性劣势。\n- **安全：** 通过将群体 $A$ 的TPR从 $0.60$ 提升至 $0.75$，该策略显著降低了该群体的假阴性率，从而提高了患者安全性。\n- **专业监督：** 它包含一个全面且合理的干预否决规则，允许病理学家基于模型置信度、技术问题或临床紧急情况来覆盖算法的决策，建立了一个重要的安全网。\n- **容量：** 我们需要计算总的紧急分诊比例 $U_{\\text{total}}$。\n  - 群体A的分诊比例 $U_A = \\text{TPR}_A \\cdot p + \\text{FPR}_A \\cdot (1-p) = 0.75(0.25) + 0.14(0.75) = 0.1875 + 0.105 = 0.2925$。\n  - 群体B的分诊比例 $U_B = \\text{TPR}_B \\cdot p + \\text{FPR}_B \\cdot (1-p) = 0.75(0.25) + 0.10(0.75) = 0.1875 + 0.075 = 0.2625$。\n  - 总分诊比例 $U_{\\text{total}} = w_A U_A + w_B U_B = 0.40(0.2925) + 0.60(0.2625) = 0.117 + 0.1575 = 0.2745$。\n  - 这个比例 $0.2745$ 远低于容量限制 $\\kappa = 0.35$，为专家干预留下了充足空间。\n- **结论：** 选项A全面且有效地满足了所有要求。\n\n**选项 B 分析：**\n- **正义与安全：** 该策略旨在实现“人口统计均等”（即$U_A = U_B$），但这是一种以系统为中心的公平性，而非以患者为中心。它明确表示“接受不平等的灵敏度”，这意味着它没有解决根本的公平问题——即群体A的患者没有得到平等的受益机会，这违反了正义和不伤害原则。\n- **专业监督：** 它“禁用专家干预”，这在任何高风险医疗环境中都是不可接受的，因为它移除了至关重要的人类安全网。\n- **结论：** 此选项在伦理上存在严重缺陷。\n\n**选项 C 分析：**\n- **正义与安全：** “随机提升”是一种粗糙且效率低下的方法。它无法精确地识别出被错误分类的真阳性病例，因此对提高群体A的TPR效果甚微，未能有效解决公平和安全问题。\n- **专业监督：** 干预规则仅限于群体A，这种不对称的设计是武断且不合理的。\n- **结论：** 这是一个设计拙劣的“补丁式”解决方案。\n\n**选项 D 分析：**\n- **正义与安全：** 该策略旨在均等化阳性预测值（PPV）。PPV关注的是“被分诊为紧急的病例中有多少是真紧急”，这优先考虑了紧急队列的“纯度”和病理学家的工作效率。然而，它可能以牺牲某些群体的TPR为代价来实现这一点，这意味着它无法保证所有患者都有平等的机会被正确识别。这不符合以患者为中心的“平等受益机会”原则。\n- **专业监督：** 干预规则过于严格，限制了专业判断。\n- **结论：** 此选项选择了错误的公平性指标，未能解决核心的伦理关切。\n\n**综合评估：**\n选项A是唯一一个正确识别了核心伦理问题（不平等的受益机会）并采取了最直接、最有效的纠正措施（均等化TPR）的策略。它同时兼顾了患者安全、专业监督的必要性以及操作上的可行性，因此是最佳选择。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}