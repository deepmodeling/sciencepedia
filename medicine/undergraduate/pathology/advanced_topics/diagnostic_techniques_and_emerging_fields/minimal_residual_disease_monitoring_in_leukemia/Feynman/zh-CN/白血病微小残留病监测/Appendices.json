{
    "hands_on_practices": [
        {
            "introduction": "我们的实践探索始于诊断流程的第一步：样本采集。在微小残留病（MRD）监测中，一份高质量的骨髓样本至关重要。此练习模拟了一个常见的陷阱——血液稀释——即骨髓样本与外周血混合，这可能会人为地降低测得的MRD水平。通过这个计算，您将量化这种分析前变量的影响，并理解为何规范的样本采集技术对于获得准确的临床结果至关重要 。",
            "id": "4408082",
            "problem": "为通过多参数流式细胞术 (MFC) 监测微小残留病 (MRD)，从一名急性淋巴细胞白血病患者身上获取了一份骨髓穿刺液。在骨髓穿刺抽吸中，首次抽吸的穿刺液富含骨髓颗粒，而后续的抽吸液则会逐渐被外周血稀释。假设以下场景在科学上是合理的且内部一致的。\n\n- 首次抽吸的穿刺液代表纯骨髓，其中有核细胞中真正的白血病细胞分数（即 MRD）为 $f_{\\mathrm{marrow}} = 0.0037$。\n- 用于 MRD 分析的第二次抽吸的穿刺液是骨髓和外周血以 $1\\!:\\!4$ 的体积比混合而成的混合物（一份骨髓对四份外周血）。\n- 骨髓中的有核细胞浓度为 $C_{\\mathrm{marrow}} = 40 \\times 10^{6}$ 细胞/毫升，外周血中的有核细胞（白细胞）浓度为 $C_{\\mathrm{blood}} = 5 \\times 10^{6}$ 细胞/毫升。\n- 此时，外周血中检测不到白血病母细胞；假设 $f_{\\mathrm{blood}} = 0$。\n\n仅使用 MRD 的定义（即白血病细胞在总有核细胞中的分数）和混合时细胞计数守恒的原则，通过推导混合（第二次抽吸）样本中预期的 MRD 测量分数，来建立血液稀释效应的模型。然后，根据上述参数计算其数值。将最终结果四舍五入至四位有效数字，并以小数形式表示（不要使用百分号）。",
            "solution": "我们将使用的基本定义和事实是：\n\n- 通过流式细胞术检测的微小残留病 (MRD) 定义为白血病细胞在总有核细胞中所占的分数，我们用 $f = \\dfrac{\\text{leukemic nucleated cells}}{\\text{total nucleated cells}}$ 表示。\n- 在混合物中，每种类型细胞的总数是各组分贡献的总和，这反映了细胞计数的守恒。\n\n设 $V_{\\mathrm{marrow}}$ 和 $V_{\\mathrm{blood}}$ 分别表示第二次抽吸的穿刺液中骨髓和外周血的体积。题目说明体积比为 $1\\!:\\!4$，因此我们可以设定 $V_{\\mathrm{marrow}} = 1$（任意体积单位）和 $V_{\\mathrm{blood}} = 4$（相同单位）。设 $C_{\\mathrm{marrow}}$ 和 $C_{\\mathrm{blood}}$ 分别为骨髓和血液中的有核细胞浓度（单位体积内的细胞数）。设 $f_{\\mathrm{marrow}}$ 和 $f_{\\mathrm{blood}}$ 分别为骨髓和血液中有核细胞中的白血病细胞分数。\n\n混合的第二次抽吸样本中白血病有核细胞的数量为\n$$\nL = f_{\\mathrm{marrow}} \\, C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; f_{\\mathrm{blood}} \\, C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}.\n$$\n混合样本中总有核细胞的数量为\n$$\nT = C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}.\n$$\n因此，根据 MRD 作为分数的定义，\n$$\nf_{\\mathrm{measured}} \\;=\\; \\frac{L}{T} \\;=\\; \\frac{f_{\\mathrm{marrow}} \\, C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; f_{\\mathrm{blood}} \\, C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}.\n$$\n\n在这种情况下，题目说明 $f_{\\mathrm{blood}} = 0$，所以表达式简化为\n$$\nf_{\\mathrm{measured}} \\;=\\; f_{\\mathrm{marrow}} \\, \\frac{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} \\;+\\; C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}.\n$$\n\n现在代入给定的数值：\n- $f_{\\mathrm{marrow}} = 0.0037$,\n- $C_{\\mathrm{marrow}} = 40 \\times 10^{6}$ 细胞/毫升,\n- $C_{\\mathrm{blood}} = 5 \\times 10^{6}$ 细胞/毫升,\n- $V_{\\mathrm{marrow}} = 1$,\n- $V_{\\mathrm{blood}} = 4$.\n\n计算由骨髓有核细胞贡献的稀释因子：\n$$\n\\frac{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}}}{C_{\\mathrm{marrow}} \\, V_{\\mathrm{marrow}} + C_{\\mathrm{blood}} \\, V_{\\mathrm{blood}}}\n\\;=\\;\n\\frac{\\left(40 \\times 10^{6}\\right)\\cdot 1}{\\left(40 \\times 10^{6}\\right)\\cdot 1 + \\left(5 \\times 10^{6}\\right)\\cdot 4}\n\\;=\\;\n\\frac{40}{40 + 20}\n\\;=\\;\n\\frac{2}{3}.\n$$\n\n因此，\n$$\nf_{\\mathrm{measured}} \\;=\\; 0.0037 \\times \\frac{2}{3} \\;=\\; 0.0024666\\ldots\n$$\n四舍五入到四位有效数字，并以小数形式表示（无百分号），结果为\n$$\n0.002467.\n$$",
            "answer": "$$\\boxed{0.002467}$$"
        },
        {
            "introduction": "获取高质量样本后，我们进入分析阶段：用流式细胞仪计数细胞。当目标（白血病细胞）极其罕见时，检测本身就成为一项统计学挑战。本练习探讨了检测的根本概率，揭示了找到至少一个癌细胞的机会如何直接取决于您分析的总细胞数。通过应用泊松分布这一罕见事件分析的基石，您将掌握分析灵敏度与样本量之间的核心关系 。",
            "id": "4408089",
            "problem": "在通过流式细胞术进行白血病的微小残留病（MRD）监测中，临床问题是在治疗后是否仍有任何残留的白血病细胞。假设一份血液或骨髓标本被充分混合，细胞由细胞仪独立取样。设真实的MRD细胞频率为 $p$，这意味着每个采集到的细胞是白血病细胞的概率为 $p$，且与其他细胞独立。采集的细胞事件总数为 $N$。在这些假设下，采集中观察到的MRD细胞计数可以被建模为一个稀有事件过程。\n\n请从基于概率和抽样的第一性原理出发，解释增加样本量和采集的总事件数 $N$ 如何影响检测到至少一个MRD细胞的概率。你的解释应从独立伯努利抽样的定义和典型的稀有事件极限开始，并论证为何当 $p$ 很小而 $N$ 很大时，该极限适用于流式细胞术的MRD检测。然后，在一个适用于稀有事件极限的泊松抽样模型下，计算当真实MRD频率为 $p = 10^{-5}$ 且仪器采集了 $N = 10^{6}$ 个总细胞时，观察到至少一个MRD细胞的概率。将你最终的概率四舍五入到 $5$ 位有效数字，并表示为一个无单位的小数。",
            "solution": "该问题陈述被评估为具有科学依据、问题明确且客观。它描述了概率论在真实世界生物医学问题——微小残留病（MRD）监测中的一个标准应用，使用了已建立的统计模型。所有必要参数都已提供，可得出唯一解。\n\n该问题要求解释样本量如何影响检测概率，并进行一项具体计算。解释将从独立伯努利试验的基础模型开始，到其在稀有事件极限下由泊松分布近似。\n\n设 $p$ 为标本中MRD细胞的真实频率。这代表任何单个被抽样的细胞是白血病细胞的概率。设 $N$ 是流式细胞仪采集和分析的细胞总数。我们假设细胞是独立抽样的。\n\n设 $K$ 为在大小为 $N$ 的样本中观察到的MRD细胞总数的随机变量。采集的 $N$ 个细胞中的每一个都可以被视为一次独立的伯努利试验，其中“成功”（观察到一个MRD细胞）的发生概率为 $p$。在 $N$ 次试验中，“成功”的总次数 $K$ 服从二项分布，记作 $K \\sim \\text{Binomial}(N, p)$。\n\n二项分布的概率质量函数（PMF）给出了观察到恰好 $k$ 个MRD细胞的概率：\n$$P(K=k) = \\binom{N}{k} p^k (1-p)^{N-k}$$\n\n临床问题是是否检测到*任何*残留细胞，这对应于事件 $K \\ge 1$。计算其互补事件 $K=0$（观察到零个MRD细胞）的概率，然后用 $1$ 减去它，在计算上更简单。\n使用二项PMF，观察到零个MRD细胞的概率是：\n$$P(K=0) = \\binom{N}{0} p^0 (1-p)^{N-0} = (1-p)^N$$\n因此，检测到至少一个MRD细胞的精确概率是：\n$$P(K \\ge 1) = 1 - P(K=0) = 1 - (1-p)^N$$\n\n为了理解增加采集的总事件数 $N$ 如何影响这个概率，我们考察 $(1-p)^N$ 这一项。因为 $p$ 是一个概率，所以 $0  p  1$，这意味着 $0  (1-p)  1$。对于此范围内的底数，函数 $f(N) = (1-p)^N$ 是一个关于 $N$ 的严格递减函数。因此，随着 $N$ 的增加，$(1-p)^N$ 减少并趋近于 $0$。这意味着 $P(K \\ge 1) = 1 - (1-p)^N$ 随着 $N$ 的增加而严格增加，并趋近于 $1$。因此，增加样本量会提高检测到疾病（如果存在）的概率。\n\n问题指出MRD监测涉及一个稀有事件过程，这为使用极限提供了理由。这是指二项分布的泊松近似。当 $N$ 很大且 $p$ 很小时，该近似有效，使得它们的乘积 $\\lambda = Np$ 是一个有限的、中等大小的值。在MRD检测中，情况正是如此：白血病细胞的频率 $p$ 非常低（例如，$10^{-4}$ 到 $10^{-6}$），而分析的细胞数 $N$ 非常大（例如，$10^5$ 到 $10^7$）。乘积 $\\lambda = Np$ 代表样本中MRD细胞的期望数。\n\n为了从第一性原理推导这个极限，我们从二项PMF开始，在保持 $\\lambda=Np$ 恒定的情况下，取 $N \\to \\infty$ 和 $p \\to 0$ 的极限。\n$$P(K=k) = \\frac{N!}{k!(N-k)!} p^k (1-p)^{N-k}$$\n代入 $p = \\lambda/N$：\n$$P(K=k) = \\frac{N(N-1)\\cdots(N-k+1)}{k!} \\left(\\frac{\\lambda}{N}\\right)^k \\left(1-\\frac{\\lambda}{N}\\right)^{N-k}$$\n重新整理各项：\n$$P(K=k) = \\frac{\\lambda^k}{k!} \\left(\\frac{N}{N} \\cdot \\frac{N-1}{N} \\cdots \\frac{N-k+1}{N}\\right) \\left(1-\\frac{\\lambda}{N}\\right)^N \\left(1-\\frac{\\lambda}{N}\\right)^{-k}$$\n现在我们计算当 $N \\to \\infty$ 时每一部分的极限：\n1. 乘积 $\\left(1 \\cdot \\left(1-\\frac{1}{N}\\right) \\cdots \\left(1-\\frac{k-1}{N}\\right)\\right) \\to 1$，因为 $k$ 是一个固定的有限数。\n2. 项 $\\left(1-\\frac{\\lambda}{N}\\right)^N \\to \\exp(-\\lambda)$，这来自于指数函数的基本极限定义。\n3. 项 $\\left(1-\\frac{\\lambda}{N}\\right)^{-k} \\to (1-0)^{-k} = 1$。\n\n结合这些结果，二项概率收敛于泊松概率：\n$$\\lim_{N\\to\\infty, p\\to 0, Np=\\lambda} P(K=k) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!}$$\n这是均值为 $\\lambda$ 的泊松分布的PMF。因此，在指定条件下，MRD细胞的计数 $K$ 可以被建模为 $K \\sim \\text{Poisson}(\\lambda=Np)$。\n\n使用这个泊松模型，我们可以再次计算检测到至少一个MRD细胞的概率。\n$$P(K \\ge 1) = 1 - P(K=0)$$\n对于泊松分布，零个事件的概率是：\n$$P(K=0) = \\frac{\\lambda^0 \\exp(-\\lambda)}{0!} = \\exp(-\\lambda)$$\n因此，检测的概率是：\n$$P(K \\ge 1) = 1 - \\exp(-\\lambda) = 1 - \\exp(-Np)$$\n这个表达式再次表明，随着 $N$ 的增加，指数 $-Np$ 变得更负，$\\exp(-Np)$ 减小，而检测概率 $1 - \\exp(-Np)$ 增加，这证实了更大样本采集量能提高检测灵敏度的原理。\n\n我们被要求计算在真实MRD频率为 $p = 10^{-5}$ 且仪器采集了 $N = 10^6$ 个总细胞的特定情况下的这个概率。\n\n首先，我们计算泊松参数 $\\lambda$：\n$$\\lambda = Np = (10^6)(10^{-5}) = 10$$\n这个值代表样本中MRD细胞的期望数。\n\n接下来，我们使用泊松近似计算观察到至少一个MRD细胞的概率：\n$$P(K \\ge 1) = 1 - \\exp(-\\lambda) = 1 - \\exp(-10)$$\n现在，我们计算数值：\n$$\\exp(-10) \\approx 0.00004539992976$$\n$$P(K \\ge 1) \\approx 1 - 0.00004539992976 = 0.99995460007023$$\n问题要求将最终概率四舍五入到 $5$ 位有效数字。前五位有效数字是 $9$、$9$、$9$、$9$ 和 $5$。随后的数字是 $4$，小于 $5$，所以我们不对第五位数字进行向上舍入。\n最终概率为 $0.99995$。",
            "answer": "$$\\boxed{0.99995}$$"
        },
        {
            "introduction": "在诊断流程的最后，我们必须解读测试结果并将其应用于临床。一个“阳性”或“阴性”的MRD结果本身并非最终诊断，其临床预测价值取决于多个因素。这个练习将指导您使用贝叶斯定理的基本原理，计算阳性预测值（PPV）和阴性预测值（NPV）。通过这项实践，您能学会如何将一个实验室检测的性能指标（如灵敏度和特异度）与患者的预后风险联系起来，从而真正理解检测结果对临床决策的意义 。",
            "id": "4408098",
            "problem": "一家血液病理学实验室实施了一项多参数流式细胞术检测，用于在诱导后随访期间监测急性白血病患者的微小残留病 (MRD)。为了在十二个月的固定时间范围内进行预后分类，根据临床结果将患者分为复发或不复发两类。当检测到残留的白血病母细胞时，MRD检测结果为阳性，未检测到时则为阴性。在此时间范围内，该检测对复发分类的灵敏度为 $0.95$，对非复发分类的特异度为 $0.99$。受监测队列最终复发的验前概率为 $0.20$。\n\n仅使用灵敏度、特异度、阳性预测值 (PPV) 和阴性预测值 (NPV) 的基础概率定义，从第一性原理推导出用灵敏度、特异度和复发验前概率表示的 PPV 和 NPV 表达式。然后，在灵敏度为 $0.95$，特异度为 $0.99$，复发验前概率为 $0.20$ 的条件下，计算该 MRD 检测的 PPV 和 NPV。\n\n将 PPV 和 NPV 表示为小数，并将每个值四舍五入到四位有效数字。你的最终答案必须是一个写成行矩阵形式的有序对，按顺序包含 PPV 和 NPV，不带单位。",
            "solution": "这个问题有科学依据、提法明确且客观。所有必要的数据均已提供，并与概率论和医学诊断学的既定原则一致。我现在开始解题。\n\n让我们定义以下事件：\n$R$：患者将在十二个月的时间范围内复发。\n$R^c$：患者不会在十二个月的时间范围内复发。\n$T^+$：MRD 检测结果为阳性。\n$T^-$：MRD 检测结果为阴性。\n\n问题陈述中提供的信息可以转化为概率术语：\n复发的验前概率，或称患病率，是 $P(R) = 0.20$。\n因此，不复发的概率是 $P(R^c) = 1 - P(R) = 1 - 0.20 = 0.80$。\n该检测的灵敏度是在患者将复发的情况下检测结果为阳性的概率：$P(T^+ | R) = 0.95$。\n该检测的特异度是在患者不会复发的情况下检测结果为阴性的概率：$P(T^- | R^c) = 0.99$。\n\n根据这些定义，我们还可以确定互补事件的概率：\n假阴性（对将要复发的患者检测结果为阴性）的概率是 $P(T^- | R) = 1 - P(T^+ | R) = 1 - 0.95 = 0.05$。\n假阳性（对不会复发的患者检测结果为阳性）的概率是 $P(T^+ | R^c) = 1 - P(T^- | R^c) = 1 - 0.99 = 0.01$。\n\n需要推导和计算的量是：\n阳性预测值 (PPV)：在检测结果为阳性的情况下，患者将复发的概率，即 $PPV = P(R | T^+)$。\n阴性预测值 (NPV)：在检测结果为阴性的情况下，患者不会复发的概率，即 $NPV = P(R^c | T^-)$。\n\n我们将从第一性原理推导 PPV 和 NPV 的表达式，这些原理是条件概率的基本定义和全概率定律。这种方法等同于应用贝叶斯定理。\n\n阳性预测值 (PPV) 的推导：\n根据条件概率的定义，\n$$ PPV = P(R | T^+) = \\frac{P(R \\cap T^+)}{P(T^+)} $$\n分子 $P(R \\cap T^+)$ 是复发和阳性检测结果的联合概率。它可以使用条件概率的定义表示为 $P(R \\cap T^+) = P(T^+ | R) P(R)$。该项代表真阳性。\n分母 $P(T^+)$ 是阳性检测结果的总概率。使用全概率定律，我们可以通过对所有可能的疾病状态（复发或不复发）求和来表示它：\n$$ P(T^+) = P(T^+ \\cap R) + P(T^+ \\cap R^c) $$\n$$ P(T^+) = P(T^+|R)P(R) + P(T^+|R^c)P(R^c) $$\n第一项是真阳性的概率，第二项是假阳性的概率。\n将这些表达式代回 PPV 的公式中，我们得到：\n$$ PPV = \\frac{P(T^+|R)P(R)}{P(T^+|R)P(R) + P(T^+|R^c)P(R^c)} $$\n用灵敏度 ($S_e$)、特异度 ($S_p$) 和验前概率 ($P_{pre}$) 表示：\n$$ PPV = \\frac{S_e \\cdot P_{pre}}{S_e \\cdot P_{pre} + (1 - S_p) \\cdot (1 - P_{pre})} $$\n\n阴性预测值 (NPV) 的推导：\n根据条件概率的定义，\n$$ NPV = P(R^c | T^-) = \\frac{P(R^c \\cap T^-)}{P(T^-)} $$\n分子 $P(R^c \\cap T^-)$ 是不复发和阴性检测结果的联合概率，可以表示为 $P(R^c \\cap T^-) = P(T^- | R^c) P(R^c)$。该项代表真阴性。\n分母 $P(T^-)$ 是阴性检测结果的总概率。使用全概率定律：\n$$ P(T^-) = P(T^- \\cap R^c) + P(T^- \\cap R) $$\n$$ P(T^-) = P(T^-|R^c)P(R^c) + P(T^-|R)P(R) $$\n第一项是真阴性的概率，第二项是假阴性的概率。\n将这些表达式代回 NPV 的公式中，我们得到：\n$$ NPV = \\frac{P(T^-|R^c)P(R^c)}{P(T^-|R^c)P(R^c) + P(T^-|R)P(R)} $$\n用灵敏度 ($S_e$)、特异度 ($S_p$) 和验前概率 ($P_{pre}$) 表示：\n$$ NPV = \\frac{S_p \\cdot (1 - P_{pre})}{S_p \\cdot (1 - P_{pre}) + (1 - S_e) \\cdot P_{pre}} $$\n\n现在，我们使用给定的数据计算数值：\n$S_e = 0.95$\n$S_p = 0.99$\n$P_{pre} = P(R) = 0.20$\n$1 - P_{pre} = P(R^c) = 0.80$\n$1 - S_e = 0.05$\n$1 - S_p = 0.01$\n\nPPV 的计算：\n$$ PPV = \\frac{(0.95) \\cdot (0.20)}{(0.95) \\cdot (0.20) + (1 - 0.99) \\cdot (1 - 0.20)} $$\n$$ PPV = \\frac{0.19}{0.19 + (0.01) \\cdot (0.80)} $$\n$$ PPV = \\frac{0.19}{0.19 + 0.008} $$\n$$ PPV = \\frac{0.19}{0.198} \\approx 0.959595... $$\n四舍五入到四位有效数字，$PPV = 0.9596$。\n\nNPV 的计算：\n$$ NPV = \\frac{(0.99) \\cdot (1 - 0.20)}{(0.99) \\cdot (1 - 0.20) + (1 - 0.95) \\cdot (0.20)} $$\n$$ NPV = \\frac{(0.99) \\cdot (0.80)}{(0.99) \\cdot (0.80) + (0.05) \\cdot (0.20)} $$\n$$ NPV = \\frac{0.792}{0.792 + 0.01} $$\n$$ NPV = \\frac{0.792}{0.802} \\approx 0.987531... $$\n四舍五入到四位有效数字，$NPV = 0.9875$。\n\n计算得出的 PPV 和 NPV 值分别为 $0.9596$ 和 $0.9875$。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.9596  0.9875 \\end{pmatrix}} $$"
        }
    ]
}