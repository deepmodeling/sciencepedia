{
    "hands_on_practices": [
        {
            "introduction": "从原始的测序数据到有意义的遗传信息，这一过程并非魔法，而是遵循一个结构化的计算流程。这项练习将帮助你理解生物信息学分析的核心逻辑，区分从零开始构建基因组（*de novo* 组装）和将个体基因组与现有标准进行比较（重测序）这两种基本策略。通过掌握基因组组装、比对和变异检测这些关键步骤及其相互依赖关系，你将对后人类基因组计划时代的个性化医疗分析流程建立一个清晰的框架。",
            "id": "4747025",
            "problem": "一家临床基因组学实验室在 $2020$ 年受托分析来自一名患者的全基因组测序读段，以鉴定用于个性化医疗的临床相关变异。另外，一个历史方法学小组试图从 $1995$ 年的数据中重建一个非模式生物的基因组，而该生物没有可靠的参考基因组。基于对以下基础知识的理解：脱氧核糖核酸（DNA）储存遗传信息，高通量测序产生称为“读段”（reads）的短序列片段，以及参考基因组作为序列比较的坐标系统。请选择一个选项，该选项正确定义了基因组组装、参考基因组比对和变异检测，并正确描绘了在标准的人类基因组计划后的人类工作流程中这些步骤之间的逻辑依赖关系，同时还指出了在没有参考基因组的情况下操作顺序会如何改变。\n\n哪个选项是正确的？\n\nA. 基因组组装通过重叠的读段重建更长的连续序列（重叠群和支架），无需先验参考，主要在没有可靠参考或解析新序列时需要；参考基因组比对使用序列相似性将单个读段映射到现有参考基因组上的位置；变异检测通过在每个位置比较比对后的读段证据与参考，来推断差异，如单核苷酸多态性（SNPs）和插入或缺失（indels）。因此，在人类基因组计划之后的标准人类重测序中，逻辑顺序是：读段 $\\rightarrow$ 质量控制 $\\rightarrow$ 与人类参考基因组比对 $\\rightarrow$ 变异检测（组装是可选的，非必需）。在 $1995$ 年没有参考基因组的从头（de novo）组装情境中，组装必须在任何全基因组比较分析之前进行；如果使用比对，则是将读段映射回组装结果以进行校正；相对于已知参考的变异检测在有合适的参考可用之前是不可能的。\n\nB. 基因组组装是获取一个已知的参考基因组并将读段映射上去以重建基因组的顺序；参考基因组比对是沿着染色体排列已组装的重叠群；变异检测与功能注释相同。因此，在标准实践中，首先进行变异检测以识别重要区域，然后进行比对以排列重叠群，最后进行组装以完成基因组。\n\nC. 参考基因组比对可以在没有任何参考的情况下通过将读段聚类成组来执行，而基因组组装需要一个完整的参考来指导构建；变异检测是一个可选的下游步骤，不依赖于比对。因此，在人类基因组计划后和人类基因组计划前的设置中，正确的顺序都是：比对 $\\rightarrow$ 组装 $\\rightarrow$ 变异检测。\n\nD. 为避免偏倚，变异检测最好在任何比对之前直接使用k-mer计数对原始读段进行；即使存在高质量的人类参考基因组，基因组组装也是强制性的；参考基因组比对仅用于可视化。因此，在所有设置中，正确的顺序都是：组装 $\\rightarrow$ 变异检测 $\\rightarrow$ 比对。",
            "solution": "将通过首先提取给定信息，然后根据有效科学问题的标准对其进行评估，来验证问题陈述。\n\n### 第1步：提取给定信息\n- **场景1：**一家临床基因组学实验室在 $2020$ 年分析来自一名人类患者的全基因组测序读段，用于个性化医疗。\n- **场景2：**一个历史方法学小组在 $1995$ 年试图重建一个非模式生物的基因组，该生物没有可靠的参考基因组。\n- **基础概念：**\n    1. 脱氧核糖核酸（DNA）储存遗传信息。\n    2. 高通量测序产生称为“读段”（reads）的短DNA片段。\n    3. 参考基因组作为序列比较的坐标系统。\n- **任务：**选择一个选项，该选项正确地：\n    1. 定义基因组组装、参考基因组比对和变异检测。\n    2. 描绘了在标准的人类基因组计划后的人类工作流程中（场景1）这些步骤之间的逻辑依赖关系。\n    3. 指出了在没有参考基因组的情况下（场景2）操作顺序会如何改变。\n\n### 第2步：使用提取的给定信息进行验证\n- **科学依据：**该问题牢固地植根于基因组学和生物信息学的既定原则和标准实践。DNA、测序读段、参考基因组、组装、比对和变异检测等概念是该领域的核心。提出的两种情景（人类重测序 vs. *de novo* 组装非模式生物）代表了全基因组测序的两个主要应用，并且是科学上现实的。\n- **适定性：**问题是适定的。它要求在两种不同且常见的条件下（有和没有参考基因组）为特定的、定义明确的生物信息学过程提供正确的定义和逻辑工作流程。应该存在一个描述这些标准操作程序的唯一正确答案。\n- **客观性：**问题陈述使用了基因组学领域精确、客观和标准的术语。它没有主观或模糊的语言。\n- **完整性和一致性：**提供的信息是充分且自洽的。两种情景之间的区别（存在与否参考基因组）是评估工作流程所需的关键信息，并且已明确说明。\n- **结论：**该问题是有效的。这是一个精心设计的问题，用以测试生物信息学工作流程的基础知识。\n\n### 第3步：推导与选项分析\n\n该问题要求理解基因组学分析流程中的数据逻辑流。核心区别在于是否有高质量的参考基因组可用。\n\n**基本定义：**\n1.  **基因组组装：**指从大量短测序读段中重建基因组的计算过程。在没有指导的情况下，这被称为*从头*（de novo）组装。该过程涉及寻找读段之间的重叠部分以构建更长的连续序列（重叠群）。在后续步骤中，可以利用来自读段对（双末端或配对末端读段）的信息将这些重叠群排序和定向，形成称为支架的更大结构。当生物体没有参考基因组时，此过程是基础。\n2.  **比对（或映射）：**这是将单个测序读段确定其在预先存在的参考基因组上的起源位置的过程。算法使用序列相似性为每个读段找到最佳匹配位置。这是任何“重测序”项目中的第一个主要计算步骤，其目标是将个体基因组与物种标准参考进行比较。\n3.  **变异检测：**比对后，来自单个个体的读段会堆叠在参考基因组上。变异检测是系统地扫描这些比对好的读段，以识别个体基因组序列与参考序列不同的位置的过程。这些差异或“变异”包括单核苷酸多态性（SNPs）、小的插入和缺失（indels）以及更大的结构变异。这个过程严重依赖于先前的比对步骤。\n\n**情景分析：**\n- **情景1：$2020$ 年的人类患者（基于参考的分析）：**由于人类基因组计划已经完成，因此有高质量的人类参考基因组可用。目标是个性化医疗，这需要鉴定患者的遗传变异。标准工作流程是：\n    1.  从患者的DNA生成原始读段。\n    2.  对读段进行质量控制（QC）。\n    3.  将经过质控的读段**比对**到人类参考基因组。\n    4.  通过将比对的读段与参考基因组进行比较来**检测变异**。\n    在此工作流程中，*de novo* 基因组组装不是必需的主要步骤。它计算成本高昂，仅在特殊情况下使用，例如，用于表征参考基因组中未体现的非常大、复杂的结构变异或新序列插入。\n\n- **情景2：$1995$ 年的非模式生物（*De novo* 分析）：**不存在参考基因组。因此，首要目标必须是创建一个。\n    1.  从生物体的DNA生成原始读段。\n    2.  对读段进行质量控制（QC）。\n    3.  执行*de novo* **基因组组装**，从读段构建重叠群和支架。这个组装好的序列成为该生物的参考基因组初稿。\n    4.  后续步骤可能包括通过将读段**比对**回组装结果以纠正错误来“校正”组装，或进行基因注释。在创建一个组装体作为参考之前，无法进行与标准参考比较意义上的**变异检测**。\n\n在确立了这些原则之后，我们来评估各个选项。\n\n**逐项选项分析：**\n\n**A.**\n- **定义：**将组装定义为*无需*参考基因组，从读段重建序列。将比对定义为将读段映射*到*参考基因组。将变异检测定义为通过比较比对后的读段*与*参考基因组来推断差异。这些定义都是正确的。\n- **人类工作流程：**指出顺序是 读段 $\\rightarrow$ 质量控制 $\\rightarrow$ 比对 $\\rightarrow$ 变异检测，并且组装是可选的。这对于标准的人类重测序是正确的。\n- **无参考工作流程：**指出组装必须先行，并且相对于已知参考的变异检测是不可能的。这也是正确的。\n- **结论：** **正确**。该选项准确地描述了两种情景下的定义和逻辑依赖关系。\n\n**B.**\n- **定义：**声称组装是“获取一个已知的参考基因组并将读段映射上去”，这是对比对的描述，而不是组装。它声称比对是“排列已组装的重叠群”，这是支架构建（组装的一部分）。它声称变异检测“与功能注释相同”，这是错误的；它们是不同的过程。\n- **工作流程：**提议的顺序“变异检测 $\\rightarrow$ 比对 $\\rightarrow$ 组装”是无稽之谈，与这些过程的基本逻辑相矛盾。\n- **结论：** **错误**。定义和工作流程描述存在根本性缺陷。\n\n**C.**\n- **定义：**声称比对可以*无需参考*通过聚类读段来完成；这描述的是组装中的一个步骤。它声称组装*需要参考*，这与*de novo* 组装的主要目的相反。它声称变异检测不依赖于比对，这对于标准的基于参考的变异检测是错误的。\n- **工作流程：**提议的顺序是错误的，并且声称在两种设置中顺序相同是一个关键错误。\n- **结论：** **错误**。该选项显示出对核心概念的完全误解。\n\n**D.**\n- **定义：**声称变异检测是在比对*之前*对原始读段进行的；虽然存在一些专门的基于k-mer的方法，但这并不是在重测序项目中生成全面变异列表的标准或最佳方法。它声称即使有高质量的人类参考基因组，组装也是*强制性*的；这是错误的。它声称比对*仅用于可视化*；这是错误的，因为比对是变异检测和其他下游分析的关键先决条件。\n- **工作流程：**提议的顺序“组装 $\\rightarrow$ 变异检测 $\\rightarrow$ 比对”是不合逻辑的。在与参考基因组比对之前，无法对其进行变异检测。\n- **结论：** **错误**。关于这些过程及其顺序的说法是不准确的。\n\n基于这一全面分析，选项A是唯一一个提供了科学上正确的定义，并准确描述了问题所规定的两种情景下的工作流程的选项。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "任何基因组分析的输出结果，其可靠性都取决于输入数据的质量。这项练习将让你接触到 DNA 测序中一个量化碱基置信度的核心指标——Phred 质量分数，它使用对数标度来表示碱基检出的错误概率。通过将抽象的质量分数 $Q$ 转换为整个基因组数据集中预期的错误碱基数量，你将具体地理解即使是高质量的测序数据也并非完美无瑕，从而认识到数据质量控制在个性化医疗中的关键作用。",
            "id": "4747031",
            "problem": "在从人类基因组计划 (HGP) 到现代个性化医疗的历史性转变中，DNA测序中的碱基判读准确性变得至关重要。衡量碱基判读置信度的一个标准是 Phred 质量得分，其定义如下：根据定义，一个碱基判读的 Phred 质量得分 $Q$ 与其碱基判读错误概率 $p$ 之间的关系为 $Q=-10\\log_{10}(p)$。考虑一个用于个性化医疗决策的全基因组测序数据集。该数据集总共包含 $N=3.20\\times 10^{9}$ 个已判读的碱基，其平均 Phred 质量得分为 $Q=35$。为进行此计算，假设每个碱基都具有与此平均质量得分所对应的相同错误概率，并且不同位点上的碱基判读错误是相互独立的。仅使用上述定义和基础概率论，计算数据集中错误碱基判读的期望数量。将最终答案以纯数字形式（无单位）表示，使用科学记数法，并四舍五入到三位有效数字。",
            "solution": "问题要求计算一个基因组数据集中错误碱基判读的期望数量。解题过程基于所提供的基本定义和原理。\n\n首先，我们已知 Phred 质量得分 $Q$ 是碱基判读错误概率 $p$ 的函数，其定义为：\n$$Q = -10\\log_{10}(p)$$\n问题说明该数据集总共包含 $N = 3.20 \\times 10^{9}$ 个已判读的碱基，平均 Phred 得分为 $Q = 35$。为进行此计算，提供了一个关键假设：我们将每个碱基视为具有与此平均得分相对应的相同错误概率 $p$。\n\n我们的第一步是确定这个错误概率 $p$。我们可以通过代数方法变换 $Q$ 的定义式来求解 $p$。\n$$-\\frac{Q}{10} = \\log_{10}(p)$$\n根据对数的定义，这等价于：\n$$p = 10^{-Q/10}$$\n代入给定的 $Q = 35$ 值：\n$$p = 10^{-35/10} = 10^{-3.5}$$\n\n接下来，我们必须确定错误的期望数量。问题说明不同位点上的碱基判读错误是相互独立的。因此，判读 $N$ 个碱基的过程可以建模为一系列 $N$ 次独立的伯努利试验 (Bernoulli trials)。在每次试验中，结果要么是错误（概率为 $p$），要么是正确判读（概率为 $1-p$）。数据集中错误的总数，我们称之为随机变量 $X$，服从二项分布 (binomial distribution)，即 $X \\sim B(N, p)$。\n\n一个服从二项分布的随机变量的期望值等于试验次数 $N$ 与每次试验中“成功”的概率 $p$ 的乘积。在此情境下，“成功”指的是一次碱基判读错误。因此，错误碱基判读的期望数量 $E[X]$ 为：\n$$E[X] = Np$$\n\n现在我们可以将给定的 $N$ 值和计算出的 $p$ 值代入此公式：\n$$E[X] = (3.20 \\times 10^9) \\times 10^{-3.5}$$\n为了方便计算，我们合并 $10$ 的幂：\n$$E[X] = 3.20 \\times 10^{(9 - 3.5)} = 3.20 \\times 10^{5.5}$$\n为了用标准科学记数法（$a \\times 10^b$，$1 \\le |a|  10$）表示，我们可以将 $10^{5.5}$ 重写为 $10^{0.5} \\times 10^5$，即 $\\sqrt{10} \\times 10^5$。\n$$E[X] = 3.20 \\times \\sqrt{10} \\times 10^5$$\n$\\sqrt{10}$ 的数值约等于 $3.16227766$。\n$$E[X] \\approx 3.20 \\times 3.16227766 \\times 10^5$$\n$$E[X] \\approx 10.1192885 \\times 10^5$$\n将其转换为标准科学记数法：\n$$E[X] \\approx 1.01192885 \\times 10^6$$\n问题要求最终答案四舍五入到三位有效数字。前三位有效数字是 $1.01$。第四位有效数字是 $1$，小于 $5$，因此我们向下舍入。\n$$E[X] \\approx 1.01 \\times 10^6$$\n因此，数据集中错误碱基判读的期望数量约为 $1.01 \\times 10^6$。",
            "answer": "$$\\boxed{1.01 \\times 10^6}$$"
        },
        {
            "introduction": "在鉴定出遗传变异后，一个关键步骤是检查基因分型过程中是否存在系统性错误，而群体遗传学为此提供了强有力的质量控制工具。哈代-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）原则描述了在一个稳定群体中等位基因频率与基因型频率之间的预期关系。这项练习将向你展示如何应用 HWE 和卡方检验，通过比较样本中观察到的基因型计数与理论预期值，来评估基因分型数据的质量，这对于确保个性化医疗决策所依据的数据的准确性至关重要。",
            "id": "4747024",
            "problem": "随着人类基因组计划 (HGP) 的完成，人群等位基因频率数据变得广泛可用，这使得对药物基因组学和个性化医疗中的基因分型数据进行质量评估成为可能。考虑一个与药物代谢相关的药物基因中的单核苷酸多态性 (SNP)，该位点有两个等位基因 $A$ 和 $a$。在一个由 $N=1000$ 名祖源匹配的个体组成的队列中，基因分型得到的观测计数为 $O_{AA}=120$，$O_{Aa}=460$ 和 $O_{aa}=420$。假设来自一个针对相同祖源、源自HGP的外部参考面板的数据显示，基础群体中等位基因 $A$ 的频率为 $p=0.35$。在哈迪-温伯格平衡 (HWE) 假设下，使用 $p$ 计算预期的基因型频率，并用它们推导出预期计数。然后，通过计算以下卡方统计量，使用卡方检验来评估与HWE的偏离程度：\n$$\\chi^{2}=\\sum_{g \\in \\{AA,Aa,aa\\}} \\frac{(O_{g}-E_{g})^{2}}{E_{g}},$$\n其中 $E_{g}$ 是HWE预期计数。请清楚地陈述在此情况下使用HWE和卡方检验的生物学和统计学假设，包括 $p$ 是被视为已知还是估计值，以及这对自由度的影响。仅报告卡方统计量的值，四舍五入到 $4$ 位有效数字，作为一个没有单位的纯数。",
            "solution": "该问题经评估为有效。它在科学上基于群体遗传学和生物统计学的原理，特别是哈迪-温伯格平衡 (HWE) 模型和卡方拟合优度检验。该问题是良定的、客观的，并为得出唯一解提供了所有必要的数据。\n\n首先，我们讨论证明HWE原理和卡方检验应用的合理性的生物学和统计学假设。\n\n一个群体处于哈迪-温伯格平衡状态的生物学假设是：\n1.  生物体是二倍体。\n2.  进行有性生殖。\n3.  世代不重叠。\n4.  就所讨论的基因座而言，交配是随机的（随机交配）。\n5.  种群大小是无限大的，意味着遗传漂变可以忽略不计。\n6.  没有基因流（迁移）进出该种群。\n7.  该基因座上没有发生突变。\n8.  没有自然选择；所有基因型具有相同的生存能力和生育能力。\n在药物基因组学质量控制的背景下，一个祖源匹配的对照人群中出现与HWE的显著偏离，可能暗示存在基因分型错误（例如杂合子的错误分类），或存在“祖源匹配”描述未能涵盖的群体分层。\n\nPearson卡方($\\chi^2$)拟合优度检验的统计学假设是：\n1.  数据是原始计数，并被组织成离散的、不重叠的类别（在本例中为基因型 $AA$、$Aa$ 和 $aa$）。\n2.  观测值是独立的。队列中一个个体的基因型不影响另一个个体的基因型。\n3.  样本量足够大，以至于每个类别中的预期计数($E_g$)不太小。一个常见的准则是所有预期计数都应大于 $5$。\n\n这个问题的关键点是等位基因频率 $p$ 的来源。问题指出，等位基因 $A$ 的频率 $p=0.35$ 是从一个外部的、源自HGP的参考面板中获得的，而不是从 $N=1000$ 个体的样本队列中估计出来的。这对 $\\chi^2$ 检验的自由度 ($df$) 有直接影响。自由度的计算公式是 $df = k - 1 - m$，其中 $k$ 是类别数量， $m$ 是从数据中估计出来用于生成预期频率的参数数量。在这里，我们有 $k=3$ 个基因型类别（$AA$、$Aa$、$aa$）。由于等位基因频率 $p$ 被视为一个已知常数，没有参数是从样本数据中估计的，所以 $m=0$。因此，该检验的正确自由度是 $df = 3 - 1 - 0 = 2$。\n\n现在，我们开始计算 $\\chi^2$ 统计量。\n\n给定数据如下：\n-   总样本量: $N = 1000$\n-   观测基因型计数: $O_{AA} = 120$, $O_{Aa} = 460$, $O_{aa} = 420$。总和为 $120 + 460 + 420 = 1000$，与 $N$ 相符。\n-   群体中等位基因 $A$ 的频率: $p = 0.35$。\n\n等位基因 $a$ 的频率必须是 $q = 1 - p$。\n$$q = 1 - 0.35 = 0.65$$\n\n在HWE下，预期的基因型频率由 $p^2$（对于 $AA$），$2pq$（对于 $Aa$）和 $q^2$（对于 $aa$）给出。\n-   $AA$ 的预期频率: $f_{AA} = p^2 = (0.35)^2 = 0.1225$。\n-   $Aa$ 的预期频率: $f_{Aa} = 2pq = 2 \\times 0.35 \\times 0.65 = 0.455$。\n-   $aa$ 的预期频率: $f_{aa} = q^2 = (0.65)^2 = 0.4225$。\n我们可以检验这些频率的总和为 $1$：$0.1225 + 0.455 + 0.4225 = 1$。\n\n接下来，我们在一个大小为 $N=1000$ 的样本中计算每个基因型的预期计数 ($E_g$)。\n-   $AA$ 的预期计数: $E_{AA} = N \\times f_{AA} = 1000 \\times 0.1225 = 122.5$。\n-   $Aa$ 的预期计数: $E_{Aa} = N \\times f_{Aa} = 1000 \\times 0.455 = 455$。\n-   $aa$ 的预期计数: $E_{aa} = N \\times f_{aa} = 1000 \\times 0.4225 = 422.5$。\n预期计数的总和是 $122.5 + 455 + 422.5 = 1000$，与 $N$ 相符。所有预期计数都远大于 $5$，满足 $\\chi^2$ 检验的假设。\n\n现在我们可以使用以下公式计算 $\\chi^2$ 统计量：\n$$\\chi^{2}=\\sum_{g \\in \\{AA,Aa,aa\\}} \\frac{(O_{g}-E_{g})^{2}}{E_{g}}$$\n\n代入观测值 ($O_g$) 和预期值 ($E_g$)：\n$$\\chi^{2} = \\frac{(120 - 122.5)^{2}}{122.5} + \\frac{(460 - 455)^{2}}{455} + \\frac{(420 - 422.5)^{2}}{422.5}$$\n$$\\chi^{2} = \\frac{(-2.5)^{2}}{122.5} + \\frac{(5)^{2}}{455} + \\frac{(-2.5)^{2}}{422.5}$$\n$$\\chi^{2} = \\frac{6.25}{122.5} + \\frac{25}{455} + \\frac{6.25}{422.5}$$\n\n现在我们计算每一项的值：\n-   第一项: $\\frac{6.25}{122.5} \\approx 0.0510204$\n-   第二项: $\\frac{25}{455} \\approx 0.0549451$\n-   第三项: $\\frac{6.25}{422.5} \\approx 0.0147929$\n\n将各项相加得到 $\\chi^2$ 值：\n$$\\chi^{2} \\approx 0.0510204 + 0.0549451 + 0.0147929 = 0.1207584$$\n\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$\\chi^{2} \\approx 0.1208$$",
            "answer": "$$\\boxed{0.1208}$$"
        }
    ]
}