{
    "hands_on_practices": [
        {
            "introduction": "贝塔（Beta）分布是生物统计学中一个极其灵活的工具，常用于为比例或频率数据（例如，某基因在群体中的流行率）建立模型。这个练习将向你展示，仅通过调整其两个参数 $\\alpha$ 和 $\\beta$，贝塔分布就能呈现出截然不同的形态——从典型的单峰（unimodal）到独特的U形（bimodal），再到边界众数，甚至均匀分布。通过这个练习，你将运用微积分来揭示分布参数与其众数形态之间的深刻联系。",
            "id": "4909532",
            "problem": "一个连续随机变量 $X$ 服从贝塔分布 $\\mathrm{Beta}(\\alpha,\\beta)$，其在区间 $x \\in (0,1)$ 上的概率密度函数为 $f(x \\, ; \\, \\alpha,\\beta)$，其中 $\\alpha>0$ 且 $\\beta>0$。贝塔分布是生物统计学中用于为比例和率建模的一个标准分布族。请仅从贝塔概率密度函数的核心定义和标准微积分出发，确定众数的位置作为 $\\alpha$ 和 $\\beta$ 的函数，并对所有参数体系分类，指明众数是位于区间 $(0,1)$ 内部，还是位于一个或两个边界 $x=0$ 或 $x=1$ 上。这包括 $\\alpha1, \\beta1$（U形）、$\\alpha1, \\beta1$（内部单峰）以及众数在边界上的边缘情况。请将您的最终结果表示为一个单一的显式分段解析表达式 $m(\\alpha,\\beta)$，该表达式返回每个参数体系的众数位置集合。不要对您的表达式进行数值计算或近似。",
            "solution": "用户想要找到贝塔分布 $\\mathrm{Beta}(\\alpha, \\beta)$ 在所有可能的参数值 $\\alpha  0$ 和 $\\beta  0$ 下的众数。\n\n这是我的计划：\n1.  **问题验证**：\n    *   **第1步：提取已知信息**：我将列出贝塔分布的定义、其概率密度函数（PDF）、随机变量的定义域以及参数 $\\alpha$ 和 $\\beta$ 的约束条件。\n    *   **第2步：验证**：我将检查问题是否具有科学依据、是否定义明确、客观和完整。该问题要求求解一个标准的、定义明确的概率分布的众数。这是微积分和概率论中的一个经典练习。问题定义明确、客观且科学上合理。它没有缺少任何信息。我预计验证会通过。\n    *   **第3步：结论**：问题有效。我将继续解决它。\n\n2.  **求解推导**：\n    *   **写下PDF**：贝塔分布的概率密度函数是 $f(x; \\alpha, \\beta) = \\frac{x^{\\alpha-1}(1-x)^{\\beta-1}}{B(\\alpha, \\beta)}$，其中 $B(\\alpha, \\beta)$ 是贝塔函数，作为归一化常数。定义域为 $x \\in (0, 1)$。\n    *   **寻找众数**：众数是使概率密度函数 $f(x)$ 最大化的 $x$ 值。由于分母 $B(\\alpha, \\beta)$ 是一个关于 $x$ 的正常数，最大化 $f(x)$ 等价于最大化其分子部分，我们称之为 $g(x) = x^{\\alpha-1}(1-x)^{\\beta-1}$。\n    *   **使用微积分寻找最大值**：为了找到 $g(x)$ 的最大值，通常更容易找到其自然对数 $\\ln(g(x))$ 的最大值，因为这将乘积转化为和。这是一个有效的单调变换。\n        *   $\\ln(g(x)) = \\ln(x^{\\alpha-1}(1-x)^{\\beta-1}) = (\\alpha-1)\\ln(x) + (\\beta-1)\\ln(1-x)$。\n    *   **对x求导**：我将计算 $\\ln(g(x))$ 关于 $x$ 的导数，并将其设为零以找到临界点。\n        *   $\\frac{d}{dx} \\ln(g(x)) = \\frac{\\alpha-1}{x} - \\frac{\\beta-1}{1-x}$。\n    *   **求解x**：将导数设为零：\n        *   $\\frac{\\alpha-1}{x} = \\frac{\\beta-1}{1-x}$\n        *   $(\\alpha-1)(1-x) = (\\beta-1)x$\n        *   $\\alpha - \\alpha x - 1 + x = \\beta x - x$\n        *   $\\alpha - 1 = \\alpha x - x + \\beta x - x = (\\alpha + \\beta - 2)x$\n        *   $x = \\frac{\\alpha-1}{\\alpha+\\beta-2}$\n    *   **分析x的解**：这个临界点，我们称之为 $x_c = \\frac{\\alpha-1}{\\alpha+\\beta-2}$，*如果*它位于区间 $(0, 1)$ 内，则它是一个潜在的众数。我需要分析何时是这种情况。\n    *   **检查二阶导数**：为了确认它是一个最大值，我将检查 $\\ln(g(x))$ 的二阶导数的符号。\n        *   $\\frac{d^2}{dx^2} \\ln(g(x)) = -\\frac{\\alpha-1}{x^2} - \\frac{\\beta-1}{(1-x)^2}$。\n        *   如果 $\\alpha  1$ 且 $\\beta  1$，则 $\\alpha-1  0$ 且 $\\beta-1  0$。在这种情况下，二阶导数中的两项都是负的，所以二阶导数是负的。这证实了 $x_c$ 是一个局部最大值。\n    *   **情况分析**：众数的行为关键取决于 $\\alpha$ 和 $\\beta$ 的值。我需要按照问题的要求考虑所有情况。\n\n        *   **情况1：$\\alpha  1$ 且 $\\beta  1$（单峰，内部众数）**\n            *   在这种情况下，$\\alpha-1  0$ 且 $\\beta-1  0$。\n            *   同时，$\\alpha+\\beta-2 = (\\alpha-1) + (\\beta-1)  0$。\n            *   临界点是 $x_c = \\frac{\\alpha-1}{\\alpha+\\beta-2}$。\n            *   $x_c \\in (0, 1)$ 吗？\n                *   因为 $\\alpha-1  0$ 且 $\\alpha+\\beta-2  0$，所以 $x_c  0$。\n                *   $x_c  1$ 吗？$\\frac{\\alpha-1}{\\alpha+\\beta-2}  1 \\iff \\alpha-1  \\alpha+\\beta-2 \\iff -1  \\beta-2 \\iff 1  \\beta$，这在此情况下为真。\n            *   因此，对于 $\\alpha  1$ 和 $\\beta  1$，在区间 $(0, 1)$ 的内部存在一个单一众数，位于 $x = \\frac{\\alpha-1}{\\alpha+\\beta-2}$。二阶导数为负，证实了这是一个最大值。\n\n        *   **情况2：$\\alpha  1$ 且 $\\beta  1$（U形，边界双峰）**\n            *   在这种情况下，$\\alpha-1  0$ 且 $\\beta-1  0$。\n            *   让我们看一下 $\\ln(g(x))$ 的一阶导数：$\\frac{d}{dx} \\ln(g(x)) = \\frac{\\alpha-1}{x} - \\frac{\\beta-1}{1-x}$。\n            *   对于 $x \\in (0, 1)$，第一项 $\\frac{\\alpha-1}{x}$ 是负的。\n            *   第二项 $-\\frac{\\beta-1}{1-x}$ 是正的。\n            *   导数是一个负项和一个正项的和。让我们再看一下临界点公式：$x_c = \\frac{\\alpha-1}{\\alpha+\\beta-2}$。\n            *   分子 $\\alpha-1$ 是负的。分母 $\\alpha+\\beta-2$ 也是负的。所以 $x_c$ 是正的。\n            *   让我们检查 $x_c  1$ 是否成立。$\\frac{\\alpha-1}{\\alpha+\\beta-2}  1 \\iff \\alpha-1 > \\alpha+\\beta-2$（因为分母是负的，不等式方向反转）。这简化为 $-1 > \\beta-2 \\iff \\beta  1$，这在此情况下为真。\n            *   因此，在 $(0, 1)$ 内仍然存在一个临界点 $x_c$。\n            *   让我们检查二阶导数：$\\frac{d^2}{dx^2} \\ln(g(x)) = -\\frac{\\alpha-1}{x^2} - \\frac{\\beta-1}{(1-x)^2}$。\n            *   由于 $\\alpha-1  0$ 且 $\\beta-1  0$，两项都是正的。二阶导数是正的。这意味着 $x_c$ 是一个局部*最小值*。\n            *   函数 $f(x)$ 从 $x=0$ 向 $x_c$ 递减，并从 $x_c$ 向 $x=1$ 递增。让我们检查边界处的行为。\n            *   当 $x \\to 0^+$ 时，$f(x) \\propto x^{\\alpha-1}$。由于 $\\alpha-1  0$，$f(x) \\to \\infty$。\n            *   当 $x \\to 1^-$ 时，$f(x) \\propto (1-x)^{\\beta-1}$。由于 $\\beta-1  0$，$f(x) \\to \\infty$。\n            *   PDF是U形的，并在两个边界处趋近于无穷大。严格来说，最大值不存在。然而，在这种情况下，众数被理解为密度集中的位置，即边界。因此，众数位于 $x=0$ 和 $x=1$。\n\n        *   **情况3：$(\\alpha \\le 1, \\beta \\ge 1)$ 且 $(\\alpha, \\beta) \\ne (1,1)$**\n            *   这种复合情况涵盖了众数在 $x=0$ 处的分布。\n            *   我们来分析 $\\ln(g(x))$ 导数的符号，即 $\\frac{(\\alpha-1)(1-x) - (\\beta-1)x}{x(1-x)}$。符号由分子 $N(x) = (\\alpha-1) - (\\alpha+\\beta-2)x$ 决定。\n            *   如果 $\\alpha  1$ 且 $\\beta \\ge 1$：$N(0) = \\alpha-1  0$。$N(1) = 1-\\beta \\le 0$。由于 $N(x)$ 是 $x$ 的线性函数，并且其在端点的值非正（且不都为零），所以对于所有 $x \\in (0,1)$，$N(x)  0$。导数始终为负，因此 $f(x)$ 严格递减。众数在 $x=0$。\n            *   如果 $\\alpha = 1$ 且 $\\beta > 1$：$N(x) = (1-1) - (1+\\beta-2)x = -(\\beta-1)x$。由于 $\\beta > 1$，对于 $x \\in (0,1)$，$N(x)  0$。$f(x)$ 严格递减。众数在 $x=0$。\n            *   因此，对于这整个参数区域，众数在 $x=0$。\n\n        *   **情况4：$(\\alpha \\ge 1, \\beta \\le 1)$ 且 $(\\alpha, \\beta) \\ne (1,1)$**\n            *   这种复合情况涵盖了众数在 $x=1$ 处的分布。\n            *   同样，我们分析 $N(x) = (\\alpha-1) - (\\alpha+\\beta-2)x$。\n            *   如果 $\\alpha > 1$ 且 $\\beta \\le 1$：$N(0) = \\alpha-1 > 0$。$N(1) = 1-\\beta \\ge 0$。由于 $N(x)$ 是线性的，并且在端点处非负（且不都为零），所以对于所有 $x \\in (0,1)$，$N(x) > 0$。导数始终为正，因此 $f(x)$ 严格递增。众数在 $x=1$。\n            *   如果 $\\alpha = 1$ 且 $\\beta  1$：$N(x) = (1-1) - (1+\\beta-2)x = -(\\beta-1)x$。由于 $\\beta  1$，对于 $x \\in (0,1)$，$N(x) > 0$。$f(x)$ 严格递增。众数在 $x=1$。\n            *   因此，对于这整个参数区域，众数在 $x=1$。\n\n        *   **情况5：$\\alpha = 1$ 且 $\\beta = 1$**\n            *   PDF 为 $f(x; 1, 1) = \\frac{x^{1-1}(1-x)^{1-1}}{B(1,1)} = \\frac{1}{1} = 1$，对于 $x \\in (0,1)$。这是 $(0,1)$ 上的均匀分布。\n            *   PDF 是常数，因此区间 $(0,1)$ 中的每个点都是众数。众数的集合是整个开区间 $(0,1)$。\n\n为了总结这些发现，我们根据参数 $\\alpha$ 和 $\\beta$ 构建一个关于众数位置集合 $m(\\alpha, \\beta)$ 的分段表达式。\n\n参数空间 $\\alpha0, \\beta0$ 被划分如下：\n1.  $\\alpha  1$ 且 $\\beta  1$：分布是单峰的，有一个内部众数。众数集合为 $\\{\\frac{\\alpha-1}{\\alpha+\\beta-2}\\}$。\n2.  $\\alpha  1$ 且 $\\beta  1$：分布是U形的（双峰）。众数集合为 $\\{0, 1\\}$。\n3.  $(\\alpha \\in (0,1), \\beta \\ge 1) \\lor (\\alpha=1, \\beta1)$：分布是J形的（严格递减）。众数集合为 $\\{0\\}$。这可以更紧凑地写为 $\\alpha \\in(0,1]$ 且 $\\beta \\geq 1$，且 $(\\alpha,\\beta) \\neq (1,1)$。\n4.  $(\\alpha \\ge 1, \\beta \\in (0,1)) \\lor (\\alpha1, \\beta=1)$：分布是J形的（严格递增）。众数集合为 $\\{1\\}$。这可以更紧凑地写为 $\\alpha \\geq 1$ 且 $\\beta \\in (0,1]$，且 $(\\alpha,\\beta) \\neq (1,1)$。\n5.  $\\alpha = 1$ 且 $\\beta = 1$：分布是均匀的。众数集合是区间 $(0,1)$。\n\n这五种情况覆盖了 $\\alpha0$ 和 $\\beta0$ 的所有可能性，且没有重叠。最终答案是描述这些情况的分段函数。",
            "answer": "$$\n\\boxed{\nm(\\alpha, \\beta) = \n\\begin{cases} \n\\left\\{\\frac{\\alpha-1}{\\alpha+\\beta-2}\\right\\}  \\text{如果 } \\alpha  1 \\text{ 且 } \\beta  1 \\\\\n\\{0, 1\\}  \\text{如果 } \\alpha  1 \\text{ 且 } \\beta  1 \\\\\n\\{0\\}  \\text{如果 } \\alpha \\in (0, 1] \\text{ 且 } \\beta  1, \\text{ 或 } \\alpha \\in (0, 1) \\text{ 且 } \\beta = 1 \\\\\n\\{1\\}  \\text{如果 } \\alpha  1 \\text{ 且 } \\beta \\in (0, 1], \\text{ 或 } \\alpha = 1 \\text{ 且 } \\beta \\in (0, 1) \\\\\n(0, 1)  \\text{如果 } \\alpha = 1 \\text{ 且 } \\beta = 1\n\\end{cases}\n}\n$$"
        },
        {
            "introduction": "与连续分布不同，确定离散分布（其变量只能取特定整数值）的众数需要一种不同的分析方法。本练习以负二项分布为例，该分布常用于模拟重复试验中成功前的失败次数。你将学习通过比较相邻概率的比值来定位众数，这种方法是处理离散型变量的关键技巧。此练习还将揭示离散数据中可能出现的“并列”众数（即两个相邻整数具有相同的最高概率）的有趣现象。",
            "id": "4909516",
            "problem": "一个生物统计学团队对一项序贯临床试验中观察到的无应答者数量进行建模，该试验中，在第 $r$ 个应答者出现之前，每个患者独立地以概率 $p \\in (0,1)$ 产生应答。设 $K$ 表示在第 $r$ 个应答者出现之前观察到的无应答者的随机计数。根据负二项分布的标准定义，$K$ 的概率质量函数 (PMF) 由下式给出：\n$$\n\\Pr(K=k) \\;=\\; \\binom{k+r-1}{k} \\, p^{r} \\, (1-p)^{k}, \\quad k \\in \\{0,1,2,\\dots\\}, \\quad r \\in \\{1,2,3,\\dots\\}, \\quad p \\in (0,1).\n$$\n仅从此 PMF 出发，并利用序列的基本性质，通过考察连续概率的比值来证明 $K$ 的分布是单峰的。然后，推导最大众数（即使得 $\\Pr(K=k)$ 最大化的最大整数 $k$）的闭式表达式，并仔细处理可能在相邻整数处产生两个相等最大概率平台的离散边界效应。\n\n最终答案请以 $r$ 和 $p$ 的单个闭式表达式形式提供。无需进行数值计算。如果您的推导在平局情况下得到多个候选众数，请报告最大的众数。不涉及单位，无需四舍五入。",
            "solution": "问题要求从给定的概率质量函数 (PMF) 出发，证明负二项分布的单峰性，并为其最大众数推导一个闭式表达式。随机变量 $K$ 表示在第 $r$ 个应答者出现之前的无应答者数量，应答概率为 $p$。其 PMF 由下式给出：\n$$\n\\Pr(K=k) = \\binom{k+r-1}{k} p^{r} (1-p)^{k}, \\quad k \\in \\{0, 1, 2, \\dots\\}\n$$\n\n如果一个离散分布的概率 $\\Pr(K=k)$ 递增至一个最大值（或一个最大值平台）然后递减，那么该分布是单峰的。为了分析此行为，我们考察对于 $k \\in \\{1, 2, 3, \\dots\\}$ 的连续概率比值 $R(k) = \\frac{\\Pr(K=k)}{\\Pr(K=k-1)}$。\n\n该比值的构造如下：\n$$\nR(k) = \\frac{\\Pr(K=k)}{\\Pr(K=k-1)} = \\frac{\\binom{k+r-1}{k} p^{r} (1-p)^{k}}{\\binom{(k-1)+r-1}{k-1} p^{r} (1-p)^{k-1}} = \\frac{\\binom{k+r-1}{k}}{\\binom{k+r-2}{k-1}} (1-p)\n$$\n我们使用阶乘定义 $\\binom{n}{m} = \\frac{n!}{m!(n-m)!}$ 来简化二项式系数的比值：\n$$\n\\frac{\\binom{k+r-1}{k}}{\\binom{k+r-2}{k-1}} = \\frac{\\frac{(k+r-1)!}{k!(r-1)!}}{\\frac{(k+r-2)!}{(k-1)!(r-1)!}} = \\frac{(k+r-1)!}{k!(r-1)!} \\cdot \\frac{(k-1)!(r-1)!}{(k+r-2)!} = \\frac{k+r-1}{k}\n$$\n将此结果代回到 $R(k)$ 的表达式中：\n$$\nR(k) = \\frac{k+r-1}{k} (1-p)\n$$\n这个比值的值决定了概率如何从 $k-1$ 变化到 $k$：\n- 如果 $R(k) > 1$，则 $\\Pr(K=k) > \\Pr(K=k-1)$，概率序列是递增的。\n- 如果 $R(k)  1$，则 $\\Pr(K=k)  \\Pr(K=k-1)$，概率序列是递减的。\n- 如果 $R(k) = 1$，则 $\\Pr(K=k) = \\Pr(K=k-1)$，表示存在一个平台。\n\n让我们找出概率递增的条件：\n$$\nR(k) > 1 \\implies \\frac{k+r-1}{k} (1-p) > 1\n$$\n由于 $k \\ge 1$ 且 $p \\in (0,1)$，$k$ 和 $1-p$ 均为正数，因此我们可以直接相乘而不改变不等号方向：\n$$\n(k+r-1)(1-p) > k\n$$\n$$\nk(1-p) + (r-1)(1-p) > k\n$$\n$$\n(r-1)(1-p) > k - k(1-p)\n$$\n$$\n(r-1)(1-p) > k(1 - (1-p))\n$$\n$$\n(r-1)(1-p) > kp\n$$\n$$\nk  \\frac{(r-1)(1-p)}{p}\n$$\n反之，当 $k > \\frac{(r-1)(1-p)}{p}$ 时，概率递减（$R(k)  1$）；当 $k = \\frac{(r-1)(1-p)}{p}$ 时，概率相等（$R(k) = 1$）。\n\n设临界值为 $C = \\frac{(r-1)(1-p)}{p}$。由于 $r \\ge 1$ 且 $p \\in (0,1)$，我们有 $C \\ge 0$。概率序列 $\\Pr(K=k)$ 对所有 $k  C$ 的值递增，对所有 $k > C$ 的值递减。这证实了该分布是单峰的。\n\n众数（记为 $k_{mode}$）是使 $\\Pr(K=k)$ 最大化的整数 $k$。众数 $k_{mode}$ 必须满足两个条件：$\\Pr(K=k_{mode}) \\ge \\Pr(K=k_{mode}-1)$ 和 $\\Pr(K=k_{mode}) \\ge \\Pr(K=k_{mode}+1)$。对于 $k \\ge 1$，这些条件可转化为 $R(k_{mode}) \\ge 1$ 和 $R(k_{mode}+1) \\le 1$。\n\n条件 $R(k_{mode}) \\ge 1$ 意味着：\n$$\nk_{mode} \\le \\frac{(r-1)(1-p)}{p} = C\n$$\n条件 $R(k_{mode}+1) \\le 1$ 意味着：\n$$\nk_{mode}+1 \\ge \\frac{(r-1)(1-p)}{p} = C\n$$\n$$\nk_{mode} \\ge C - 1\n$$\n结合这两个不等式，任何众数 $k_{mode}$ 都必须是满足以下条件的整数：\n$$\nC - 1 \\le k_{mode} \\le C\n$$\n我们现在根据 $C$ 的值分两种情况进行分析。\n\n情况 1：$C = \\frac{(r-1)(1-p)}{p}$ 不是整数。\n在这种情况下，区间 $(C-1, C)$ 中有且仅有一个整数 $k$，即 $k = \\lfloor C \\rfloor$。不等式 $k_{mode}  C$ 和 $k_{mode} > C-1$ 是严格的。因此，当 $k \\le \\lfloor C \\rfloor$ 时 $R(k) > 1$，当 $k \\ge \\lfloor C \\rfloor + 1$ 时 $R(k)  1$。\n概率序列严格递增直到 $\\lfloor C \\rfloor$，然后严格递减：\n$$\n\\Pr(K=0)  \\dots  \\Pr(K=\\lfloor C \\rfloor - 1)  \\Pr(K=\\lfloor C \\rfloor) > \\Pr(K=\\lfloor C \\rfloor + 1) > \\dots\n$$\n因此，存在唯一的众数，即 $k_{mode} = \\lfloor C \\rfloor$。\n\n情况 2：$C = \\frac{(r-1)(1-p)}{p}$ 是一个整数。\n在这种情况下，当 $k=C$ 时，我们有 $R(C) = 1$，这意味着 $\\Pr(K=C) = \\Pr(K=C-1)$。\n对于 $k  C$，我们有 $R(k) > 1$，因此概率严格递增直到 $k=C-1$。\n对于 $k > C$，我们有 $R(k)  1$，因此概率从 $k \\ge C+1$ 开始严格递减。\n概率序列为：\n$$\n\\Pr(K=0)  \\dots  \\Pr(K=C-2)  \\Pr(K=C-1) = \\Pr(K=C) > \\Pr(K=C+1) > \\dots\n$$\n该分布有一个由两个最大概率点组成的平台。两个众数是 $C-1$ 和 $C$。问题要求的是最大的众数，即 $C$。\n\n我们可以将这两种情况统一成一个表达式。\n- 在情况 1（C 不是整数）中，最大众数是 $\\lfloor C \\rfloor$。\n- 在情况 2（C 是整数）中，最大众数是 $C$。由于 $C$ 是一个整数，所以 $C = \\lfloor C \\rfloor$。\n在这两种情况下，使 $\\Pr(K=k)$ 最大化的最大整数 $k$ 都由 $C$ 的底函数给出。\n\n因此，最大众数的闭式表达式为：\n$$\nk_{mode, max} = \\left\\lfloor \\frac{(r-1)(1-p)}{p} \\right\\rfloor\n$$\n此公式对所有 $r \\in \\{1, 2, 3, \\dots\\}$ 均有效。例如，当 $r=1$（几何分布）时，公式给出 $\\lfloor 0 \\rfloor = 0$，这是正确的众数。如果 $\\frac{(r-1)(1-p)}{p}  1$，公式给出 $0$，这也是正确的，因为 $R(1) = r(1-p)  1$ 意味着 $\\Pr(K=1)  \\Pr(K=0)$。",
            "answer": "$$\n\\boxed{\\left\\lfloor \\frac{(r-1)(1-p)}{p} \\right\\rfloor}\n$$"
        },
        {
            "introduction": "从理论世界转向经验数据，我们会发现一个重要问题：我们对数据形态的感知，尤其是众数的数量，很大程度上取决于我们如何可视化它。直方图是最常用的工具之一，但其呈现的形态对“分组区间宽度”（bin width）的选择极为敏感。这个练习将通过一个具体的案例，让你亲手计算并比较两种常用分组规则（Scott规则和Freedman–Diaconis规则）所产生的效果。你会发现，对于同一份数据，不同的分组选择可能导致你得出截然不同的关于其模态的结论，这凸显了统计理论与数据分析实践之间的关键联系和潜在陷阱。",
            "id": "4909562",
            "problem": "一位生物统计学研究者正在使用由单个单峰总体的​​小样本构建的直方图来评估经验分布中的众数性（局部最大值的数量）。考虑来自一项预研究的以下残差生物标志物 $z$ 分数样本：$-3$, $-0.2$, $0$, $0.1$, $0.2$, $0.3$, $0.4$, $3$。设 $n$ 表示样本量，$\\bar{x}$ 表示样本均值，$s$ 表示样本标准差，$\\mathrm{IQR}$ 表示四分位距，定义为 $Q_{3} - Q_{1}$，其中四分位数对于偶数 $n$ 采用半中位数法计算（即，对数据排序后，$Q_{1}$ 是下半部分数据的中位数，$Q_{3}$ 是上半部分数据的中位数，必要时使用两个中心点的平均值）。该研究者计划比较使用 Scott 法则和 Freedman–Diaconis 法则构建的直方图。直方图的构建遵循以下约定：除了最后一个组是右闭合的之外，所有组都是左闭右开的；组的原点位于样本最小值 $x_{(1)}$ 处；连续的组是通过根据所使用的法则加上一个恒定的组宽 $h$ 形成的。\n\n将直方图的“众数”定义为任何频数严格大于其相邻组频数的组；对于边缘组，仅与其单个相邻组进行比较。计算每个直方图中的众数数量，然后计算差值“Freedman–Diaconis 众数数量减去 Scott 众数数量”。将最终差值表示为一个整数。无需进行四舍五入。",
            "solution": "该问题被验证为具有科学依据、适定且客观。它提出了一个基于生物统计学标准原理的清晰计算任务。所有必需的数据、定义和规则都已提供，使得问题是自洽且可解的。\n\n求解过程首先计算必要的样本统计量，然后应用 Scott 法则和 Freedman–Diaconis 法则来确定组宽，构建相应的直方图，最后根据给定的定义确定每个直方图中的众数数量。\n\n提供的样本数据是 $z$ 分数集合 $X = \\{-3, -0.2, 0, 0.1, 0.2, 0.3, 0.4, 3\\}$。\n样本量为 $n=8$。\n\n首先，我们对数据进行排序以方便计算：$x_{(1)} = -3$, $x_{(2)} = -0.2$, $x_{(3)} = 0$, $x_{(4)} = 0.1$, $x_{(5)} = 0.2$, $x_{(6)} = 0.3$, $x_{(7)} = 0.4$, $x_{(8)} = 3$。\n样本最小值为 $x_{(1)} = -3$。\n\n样本均值 $\\bar{x}$ 计算如下：\n$$ \\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i = \\frac{1}{8} (-3 - 0.2 + 0 + 0.1 + 0.2 + 0.3 + 0.4 + 3) = \\frac{0.8}{8} = 0.1 $$\n\n样本标准差 $s$ 使用公式 $s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2}$ 计算。\n离均差平方和为：\n$$ \\sum_{i=1}^{8} (x_i - 0.1)^2 = (-3.1)^2 + (-0.3)^2 + (-0.1)^2 + (0)^2 + (0.1)^2 + (0.2)^2 + (0.3)^2 + (2.9)^2 $$\n$$ \\sum (x_i - 0.1)^2 = 9.61 + 0.09 + 0.01 + 0 + 0.01 + 0.04 + 0.09 + 8.41 = 18.26 $$\n因此，样本方差 $s^2$ 为 $\\frac{18.26}{7}$。\n样本标准差为 $s = \\sqrt{\\frac{18.26}{7}}$。\n\n接下来，我们使用半中位数法计算四分位数 $Q_1$ 和 $Q_3$。对于 $n=8$，样本被分成各有 $4$ 个数据点的两半。\n下半部分：$\\{-3, -0.2, 0, 0.1\\}$\n上半部分：$\\{0.2, 0.3, 0.4, 3\\}$\n$Q_1$ 是下半部分的中位数，即其两个中间值的平均数：\n$$ Q_1 = \\frac{-0.2 + 0}{2} = -0.1 $$\n$Q_3$ 是上半部分的中位数，即其两个中间值的平均数：\n$$ Q_3 = \\frac{0.3 + 0.4}{2} = 0.35 $$\n四分位距 $\\mathrm{IQR}$ 为：\n$$ \\mathrm{IQR} = Q_3 - Q_1 = 0.35 - (-0.1) = 0.45 $$\n\n有了这些统计量，我们就可以计算组宽了。对于这两种法则，我们都需要 $n^{1/3} = 8^{1/3} = 2$。\n\n对于 Scott 法则：\n$$ h_{\\mathrm{Scott}} = \\frac{3.49 s}{n^{1/3}} = \\frac{3.49 \\sqrt{\\frac{18.26}{7}}}{2} \\approx \\frac{3.49 \\times 1.6151}{2} \\approx 2.8184 $$\n对于 Freedman–Diaconis 法则：\n$$ h_{\\mathrm{FD}} = \\frac{2 \\cdot \\mathrm{IQR}}{n^{1/3}} = \\frac{2 \\times 0.45}{2} = 0.45 $$\n\n现在，我们构建每个直方图。原点是样本最小值 $x_{(1)} = -3$。\n\n**Scott 直方图构建**\n组宽为 $h_{\\mathrm{Scott}} \\approx 2.8184$。\n- 组 1：$[-3, -3 + 2.8184) = [-3, -0.1816)$。该组包含数据点 $-3$ 和 $-0.2$。频数为 $2$。\n- 组 2：$[-0.1816, -0.1816 + 2.8184) = [-0.1816, 2.6368)$。该组包含数据点 $0, 0.1, 0.2, 0.3, 0.4$。频数为 $5$。\n- 组 3：$[2.6368, 2.6368 + 2.8184) = [2.6368, 5.4552)$。该组包含数据点 $3$。频数为 $1$。\n直方图的组和频数如下：\n- $B_{\\mathrm{Scott}, 1}$：频数 = $2$\n- $B_{\\mathrm{Scott}, 2}$：频数 = $5$\n- $B_{\\mathrm{Scott}, 3}$：频数 = $1$\n为了找到众数的数量，我们应用定义：一个组的频数必须严格大于其相邻组的频数。\n- $B_{\\mathrm{Scott}, 1}$ (边缘组)：频数为 $2$。相邻频数为 $5$。$2  5$ 为假。不是众数。\n- $B_{\\mathrm{Scott}, 2}$ (内部组)：频数为 $5$。相邻频数为 $2$ 和 $1$。$5  2$ 和 $5  1$ 均为真。这是众数。\n- $B_{\\mathrm{Scott}, 3}$ (边缘组)：频数为 $1$。相邻频数为 $5$。$1  5$ 为假。不是众数。\nScott 直方图有 $1$ 个众数。\n\n**Freedman–Diaconis 直方图构建**\n组宽为 $h_{\\mathrm{FD}} = 0.45$。原点在 $-3$。我们通过计算组索引 $j = \\lfloor \\frac{x - (-3)}{0.45} \\rfloor$ 来确定每个数据点 $x$ 所在的组。\n- $x=-3$: $j = \\lfloor \\frac{-3+3}{0.45} \\rfloor = 0$。\n- $x=-0.2$: $j = \\lfloor \\frac{-0.2+3}{0.45} \\rfloor = \\lfloor 6.22...\\rfloor = 6$。\n- $x=0$: $j = \\lfloor \\frac{0+3}{0.45} \\rfloor = \\lfloor 6.66...\\rfloor = 6$。\n- $x=0.1$: $j = \\lfloor \\frac{0.1+3}{0.45} \\rfloor = \\lfloor 6.88...\\rfloor = 6$。\n- $x=0.2$: $j = \\lfloor \\frac{0.2+3}{0.45} \\rfloor = \\lfloor 7.11...\\rfloor = 7$。\n- $x=0.3$: $j = \\lfloor \\frac{0.3+3}{0.45} \\rfloor = \\lfloor 7.33...\\rfloor = 7$。\n- $x=0.4$: $j = \\lfloor \\frac{0.4+3}{0.45} \\rfloor = \\lfloor 7.55...\\rfloor = 7$。\n- $x=3$: $j = \\lfloor \\frac{3+3}{0.45} \\rfloor = \\lfloor 13.33...\\rfloor = 13$。\n直方图的范围从组 $0$ 到组 $13$。各组 $B_{\\mathrm{FD},0}, B_{\\mathrm{FD},1}, \\dots, B_{\\mathrm{FD},13}$ 的频数序列为：\n$[1, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 1]$\n为了找到众数的数量，我们应用定义：\n- $B_{\\mathrm{FD}, 0}$ (边缘组)：频数为 $1$。相邻频数为 $0$。$1  0$ 为真。这是众数。\n- $B_{\\mathrm{FD}, 1}$ 到 $B_{\\mathrm{FD}, 5}$：频数为 $0$。不是众数。\n- $B_{\\mathrm{FD}, 6}$ (内部组)：频数为 $3$。相邻频数为 $0$ 和 $3$。$3  0$ 为真，但 $3  3$ 为假。不是众数。\n- $B_{\\mathrm{FD}, 7}$ (内部组)：频数为 $3$。相邻频数为 $3$ 和 $0$。$3  3$ 为假，但 $3  0$ 为真。不是众数。\n- $B_{\\mathrm{FD}, 8}$ 到 $B_{\\mathrm{FD}, 12}$：频数为 $0$。不是众数。\n- $B_{\\mathrm{FD}, 13}$ (边缘组)：频数为 $1$。相邻频数为 $0$。$1  0$ 为真。这是众数。\nFreedman–Diaconis 直方图有 $2$ 个众数。\n\n**最终计算**\n问题要求计算差值：Freedman–Diaconis 众数数量减去 Scott 众数数量。\nFreedman–Diaconis 众数数量 = $2$。\nScott 众数数量 = $1$。\n差值 = $2 - 1 = 1$。\n结果是一个整数，并且在最终步骤中没有进行四舍五入。",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}