{
    "hands_on_practices": [
        {
            "introduction": "在生物统计实践中，我们常常需要整合来自不同样本或研究的数据。一个常见的误区是简单地对各组的均值再取平均，但这忽略了各组样本量的差异。这个练习将引导你推导合并均值的通用公式，让你亲身体会加权平均的重要性，这是理解更高级统计方法（如荟萃分析 Meta-analysis）的基石。",
            "id": "1934455",
            "problem": "一位金融分析师正在研究两个不同投资组合（组合A和组合B）的表现。对于组合A，该分析师检查了 $n_A$ 支个股的样本，发现它们的平均年回报率为 $\\bar{r}_A$。同样，对于组合B，一个包含 $n_B$ 支不同个股的样本，其平均年回报率为 $\\bar{r}_B$。该分析师现在希望计算这两个投资组合中所有股票合并后的总体平均年回报率。\n\n假设这两个投资组合包含完全不同的股票集合，请推导合并后平均年回报率 $\\bar{r}_c$ 的通用代数表达式，该表达式应以样本大小 $n_A$ 和 $n_B$ 以及样本均值 $\\bar{r}_A$ 和 $\\bar{r}_B$ 表示。",
            "solution": "设组合A中个股的年回报率记为 $r_{A,i}$（其中 $i=1,2,\\dots,n_{A}$），组合B中个股的年回报率记为 $r_{B,j}$（其中 $j=1,2,\\dots,n_{B}$）。根据样本均值的定义，组合A的平均年回报率为\n$$\n\\bar{r}_{A} = \\frac{1}{n_{A}} \\sum_{i=1}^{n_{A}} r_{A,i},\n$$\n这意味着\n$$\n\\sum_{i=1}^{n_{A}} r_{A,i} = n_{A} \\bar{r}_{A}.\n$$\n同样地，对于组合B，\n$$\n\\bar{r}_{B} = \\frac{1}{n_{B}} \\sum_{j=1}^{n_{B}} r_{B,j}\n\\quad \\Rightarrow \\quad\n\\sum_{j=1}^{n_{B}} r_{B,j} = n_{B} \\bar{r}_{B}.\n$$\n由于两个投资组合包含不相交的股票集合，合并后的群体共有 $n_{A} + n_{B}$ 支股票，其回报率的总和是两个独立总和之和：\n$$\nS_{c} = \\sum_{i=1}^{n_{A}} r_{A,i} + \\sum_{j=1}^{n_{B}} r_{B,j} = n_{A} \\bar{r}_{A} + n_{B} \\bar{r}_{B}.\n$$\n根据合并后群体的样本均值定义，合并后的平均年回报率是总和除以总股票数：\n$$\n\\bar{r}_{c} = \\frac{S_{c}}{n_{A} + n_{B}} = \\frac{n_{A} \\bar{r}_{A} + n_{B} \\bar{r}_{B}}{n_{A} + n_{B}}.\n$$\n这是两个投资组合均值的加权平均值，权重分别为 $n_{A}$ 和 $n_{B}$。",
            "answer": "$$\\boxed{\\frac{n_{A}\\bar{r}_{A}+n_{B}\\bar{r}_{B}}{n_{A}+n_{B}}}$$"
        },
        {
            "introduction": "接下来，让我们转向一个计算上的挑战。在许多现代科学应用中，例如实时病人监护或基因测序，数据是持续不断产生的，我们可能无法将所有数据都储存在内存中。这个练习将帮助你推导出一个高效的“单遍”算法来实时更新均值，这不仅展示了统计公式在解决实际工程约束时的巧妙之处，也加深了你对均值定义的代数理解。",
            "id": "1934443",
            "problem": "一个深空探测器上的星载计算机的任务是分析高能粒子通量。探测器的传感器生成一串测量值 $x_1, x_2, x_3, \\dots$，其中 $x_k$ 是在时间步长 $k$ 获得的测量值。由于严格的内存限制，计算机无法存储整个测量历史。相反，它必须在单次处理中计算运行算术平均值。\n\n设 $\\mu_n$ 为前 $n$ 次测量的算术平均值，即 $\\mu_n = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。当一个新的测量值 $x_n$ 到达时（对于 $n > 1$），计算机会将之前的平均值 $\\mu_{n-1}$ 更新为新的平均值 $\\mu_n$。这个更新规则可以表示为前一个平均值和新数据点的线性组合：\n$$ \\mu_n = A_n \\mu_{n-1} + B_n x_n $$\n其中系数 $A_n$ 和 $B_n$ 是测量次数 $n$ 的函数。\n\n确定系数 $B_n$ 作为 $n$ 的函数的表达式。",
            "solution": "我们从前 $n$ 次测量的运行平均值的定义开始：\n$$\n\\mu_{n}=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}.\n$$\n将和式分解为前 $n-1$ 项和第 $n$ 项：\n$$\n\\mu_{n}=\\frac{1}{n}\\left(\\sum_{i=1}^{n-1}x_{i}+x_{n}\\right).\n$$\n使用定义 $\\mu_{n-1}=\\frac{1}{n-1}\\sum_{i=1}^{n-1}x_{i}$，将部分和 $\\sum_{i=1}^{n-1}x_{i}$ 用 $\\mu_{n-1}$ 表示，可得\n$$\n\\sum_{i=1}^{n-1}x_{i}=(n-1)\\mu_{n-1}.\n$$\n将此代入 $\\mu_{n}$ 的表达式中：\n$$\n\\mu_{n}=\\frac{1}{n}\\left((n-1)\\mu_{n-1}+x_{n}\\right)=\\frac{n-1}{n}\\mu_{n-1}+\\frac{1}{n}x_{n}.\n$$\n与更新形式 $\\mu_{n}=A_{n}\\mu_{n-1}+B_{n}x_{n}$ 比较，我们得到\n$$\nB_{n}=\\frac{1}{n}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{n}}$$"
        },
        {
            "introduction": "算术平均值有一个众所周知的弱点：它对异常值（outliers）极其敏感，而真实的生物学数据很少是完美无瑕的。本练习将让你亲手计算并比较均值、中位数、缩尾均值（trimmed mean）和温莎化均值（Winsorized mean）在面对极端值时的表现。通过这个案例，你将深刻理解为什么为你的数据选择合适的集中趋势度量是生物统计学家的一项关键决策。",
            "id": "4811621",
            "problem": "一家医院实验室的一项小型初步研究评估了一种新的C反应蛋白自动化检测方法。对于一个$n=7$名患者的便利样本，新检测方法的首次运行得到以下数值（单位：$\\mathrm{mg/L}$）：$\\{2, 3, 3, 4, 4, 5, 50\\}$。一位资深生物统计学家指出，数值$50$可能反映了仪器伪影。您被要求仅从核心定义出发，使用几种对污染具有不同稳健性的度量来量化该分布的中心：样本均值（算术平均值）、样本中位数（中间顺序统计量）、$\\gamma=0.2$的$\\gamma$-缩尾均值（在求平均前从两端丢弃相同比例的数据），以及$\\gamma=0.2$的$\\gamma$-温莎化均值（在求平均前将最低和最高比例的数据替换为最接近的剩余值）。\n\n仅使用这些核心定义和顺序统计学的基本原理，对给定的数据集执行以下操作：计算样本均值、样本中位数、0.2-缩尾均值和0.2-温莎化均值。然后，在定性稳健性方面比较这四个摘要统计量，涉及极端污染下的崩溃情况以及极端值处的影响。\n\n作为您的最终数值答案，请报告此数据集的0.2-缩尾均值。将您的最终答案四舍五入到四位有效数字，并以$\\mathrm{mg/L}$为单位表示。",
            "solution": "我们首先将问题形式化。数据集为 $X = \\{2, 3, 3, 4, 4, 5, 50\\}$，样本量 $n=7$。为了计算基于顺序的统计量（中位数、缩尾均值、温莎化均值），我们必须首先按升序排列数据。设 $X_{(i)}$ 为第 $i$ 个顺序统计量。\n\n排序后的数据集是：\n$X_{(1)} = 2$\n$X_{(2)} = 3$\n$X_{(3)} = 3$\n$X_{(4)} = 4$\n$X_{(5)} = 4$\n$X_{(6)} = 5$\n$X_{(7)} = 50$\n\n我们现在将计算所要求的四个集中趋势度量。\n\n1.  **样本均值 ($\\bar{x}$)**\n    样本均值是所有观测值的算术平均值，定义为 $\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$。\n    对于给定的数据：\n    $$ \\bar{x} = \\frac{1}{7} (2 + 3 + 3 + 4 + 4 + 5 + 50) = \\frac{71}{7} \\approx 10.1429 $$\n\n2.  **样本中位数 ($\\tilde{x}$)**\n    对于奇数样本量 $n$，中位数是中间的顺序统计量 $X_{((n+1)/2)}$。\n    对于 $n=7$，中位数是第 $((7+1)/2)$ 个值，即第 $4$ 个顺序统计量 $X_{(4)}$。\n    $$ \\tilde{x} = X_{(4)} = 4 $$\n\n3.  **$\\gamma$-缩尾均值 ($\\bar{x}_{\\gamma}$)**\n    $\\gamma$-缩尾均值是通过从排序后的数据中丢弃比例为 $\\gamma$ 的最低值和最高值，然后计算剩余数据的均值来得到的。从每端要缩减的观测数量为 $k = \\lfloor n\\gamma \\rfloor$。\n    给定 $\\gamma=0.2$ 和 $n=7$：\n    $$ k = \\lfloor 7 \\times 0.2 \\rfloor = \\lfloor 1.4 \\rfloor = 1 $$\n    这意味着我们必须丢弃单个最小值（$X_{(1)}=2$）和单个最大值（$X_{(7)}=50$）。剩余的数据点是 $\\{X_{(2)}, X_{(3)}, X_{(4)}, X_{(5)}, X_{(6)}\\} = \\{3, 3, 4, 4, 5\\}$。\n    剩余观测值的数量是 $n - 2k = 7 - 2(1) = 5$。\n    0.2-缩尾均值 $\\bar{x}_{0.2}$ 是这5个值的平均值：\n    $$ \\bar{x}_{0.2} = \\frac{1}{5} (3 + 3 + 4 + 4 + 5) = \\frac{19}{5} = 3.8 $$\n\n4.  **$\\gamma$-温莎化均值 ($\\bar{x}_{W,\\gamma}$)**\n    $\\gamma$-温莎化均值是通过将 $k = \\lfloor n\\gamma \\rfloor$ 个最小值替换为第 $(k+1)$ 个最小值，并将 $k$ 个最大值替换为第 $(n-k)$ 个最大值来计算的。然后在得到的新修改数据集上计算均值。\n    和之前一样，对于 $\\gamma=0.2$ 和 $n=7$，我们有 $k=1$。\n    最小值 $X_{(1)}=2$ 被替换为第 $(1+1)$ 个值，即 $X_{(2)}=3$。\n    最大值 $X_{(7)}=50$ 被替换为第 $(7-1)$ 个值，即 $X_{(6)}=5$。\n    原始的有序集合 $\\{2, 3, 3, 4, 4, 5, 50\\}$ 被转换为温莎化集合 $\\{3, 3, 3, 4, 4, 5, 5\\}$。\n    0.2-温莎化均值 $\\bar{x}_{W,0.2}$ 是这个新的 $n=7$ 个值的集合的平均值：\n    $$ \\bar{x}_{W,0.2} = \\frac{1}{7} (3 + 3 + 3 + 4 + 4 + 5 + 5) = \\frac{27}{7} \\approx 3.8571 $$\n\n**稳健性的定性比较**\n\n稳健性指的是估计量抵抗异常值或模型假设偏差过度影响的能力。我们可以根据它们的崩溃点和极端值的影响来比较这四个估计量。\n\n-   **样本均值**：样本均值不是一个稳健的估计量。它的崩溃点为 $1/n$，对于大样本，该值趋近于 $0$。这意味着单个任意大的观测值就可以将均值拉到任何位置。在本例中，单个异常值 $50$ 就将均值（$\\approx 10.14$）拉离了数据的中心集群（所有其他数据点都 $\\le 5$）。其影响函数是线性的且无界，这意味着极端值会对估计产生无限制的影响。\n\n-   **样本中位数**：样本中位数是一个高度稳健的估计量。它的崩溃点接近 $50\\%$，这意味着必须污染近一半的数据才能使中位数崩溃。其影响是有限的；只要极端值的变动不跨越中位数本身，它对中位数的影响就为零。在我们的样本中，中位数是 $4$，完美地反映了非异常值数据的中心，并且完全不受数值 $50$ 的影响。\n\n-   **缩尾均值**：缩尾均值是一个稳健的估计量，其稳健性由缩尾比例 $\\gamma$ 控制。它的崩溃点等于 $\\gamma$。对于 $\\gamma=0.2$，其崩溃点是 $20\\%$。超出缩尾范围的极端值被完全丢弃，因此它们对估计量的影响为零。计算出的估计值 $\\bar{x}_{0.2}=3.8$ 非常接近中位数，并提供了一个不受异常值影响的稳定中心估计。\n\n-   **温莎化均值**：温莎化均值也是一个稳健的估计量，其崩溃点同样为 $\\gamma=0.2$。它不是丢弃极端值，而是用最接近的保留值替换它们，从而保留了原始样本量。如果基础分布是重尾的，这通常能带来比缩尾均值更高的统计效率。极端值对它的影响是有限的——一个异常值的具体数值仅用于判断它是否在需要被替换的尾部。计算出的估计值 $\\bar{x}_{W,0.2} \\approx 3.86$ 同样是稳定的，并且接近中位数和缩尾均值。\n\n总之，稳健性排序为：中位数 > 缩尾/温莎化均值 > 样本均值。均值对异常值 $50$ 高度敏感，而中位数、缩尾均值和温莎化均值都提供了围绕 $4$ 的集中趋势的稳定估计。\n\n最终要求的答案是0.2-缩尾均值，四舍五入到四位有效数字。\n计算值：$\\bar{x}_{0.2} = 3.8$。\n写成四位有效数字是 $3.800$。",
            "answer": "$$ \\boxed{3.800} $$"
        }
    ]
}