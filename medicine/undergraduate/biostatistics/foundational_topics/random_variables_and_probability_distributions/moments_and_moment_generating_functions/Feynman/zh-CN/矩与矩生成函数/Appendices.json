{
    "hands_on_practices": [
        {
            "introduction": "矩母函数 (MGF) 是一个强大的工具，因为它将整个矩序列编码在一个函数中。通过计算其在 $t=0$ 处的导数，我们可以轻松地提取分布的矩。这个练习  将帮助你掌握这一核心技巧，并回顾方差在线性变换下的性质。",
            "id": "1937144",
            "problem": "设 $Y$ 为一个连续随机变量。$Y$ 的统计特性由其矩生成函数 (MGF) 完全描述，其表达式为：\n$$M_Y(t) = \\exp(3t + 8t^2)$$\n其中 $t$ 是定义该函数的实变量。\n\n考虑一个新的随机变量 $X$，它被定义为 $Y$ 的线性变换：\n$$X = 5 - 2Y$$\n计算随机变量 $X$ 的方差。",
            "solution": "我们已知 $Y$ 的矩生成函数为 $M_{Y}(t)=\\exp(3t+8t^{2})$。根据矩生成函数的定义，$Y$ 的一阶矩和二阶矩可以通过在 $t=0$ 处的导数求得：\n- $\\mathbb{E}[Y]=M_{Y}'(0)$，\n- $\\mathbb{E}[Y^{2}]=M_{Y}''(0)$，\n且方差为 $\\operatorname{Var}(Y)=M_{Y}''(0)-\\left(M_{Y}'(0)\\right)^{2}$。\n\n使用链式法则对 $M_{Y}(t)$ 求导。设 $g(t)=\\exp(3t+8t^{2})$。则\n$$\nM_{Y}'(t)=\\frac{d}{dt}\\exp(3t+8t^{2})=(3+16t)\\exp(3t+8t^{2})=(3+16t)g(t).\n$$\n在 $t=0$ 处求值得\n$$\nM_{Y}'(0)=(3+0)\\exp(0)=3,\n$$\n所以 $\\mathbb{E}[Y]=3$。\n\n对于二阶导数，使用乘积法则，其中 $f(t)=3+16t$ 且 $g(t)=\\exp(3t+8t^{2})$：\n$$\nM_{Y}''(t)=f'(t)g(t)+f(t)g'(t).\n$$\n根据链式法则，我们有 $f'(t)=16$ 和 $g'(t)=(3+16t)g(t)$，因此\n$$\nM_{Y}''(t)=16\\,g(t)+(3+16t)(3+16t)\\,g(t)=\\left(16+(3+16t)^{2}\\right)\\exp(3t+8t^{2}).\n$$\n在 $t=0$ 处求值得\n$$\nM_{Y}''(0)=\\left(16+3^{2}\\right)\\exp(0)=25,\n$$\n所以 $\\mathbb{E}[Y^{2}]=25$。因此，\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-\\left(\\mathbb{E}[Y]\\right)^{2}=25-3^{2}=16.\n$$\n\n现在考虑 $X=5-2Y$。对于线性变换 $X=a+bY$，方差满足 $\\operatorname{Var}(X)=b^{2}\\operatorname{Var}(Y)$。这里 $b=-2$，所以\n$$\n\\operatorname{Var}(X)=(-2)^{2}\\operatorname{Var}(Y)=4\\cdot 16=64.\n$$",
            "answer": "$$\\boxed{64}$$"
        },
        {
            "introduction": "在掌握了如何从给定的生成函数中提取信息之后，我们现在更进一步。这个练习  要求你从第一性原理出发，使用概率生成函数 (PGF) 为泊松分布推导其均值和方差。这展示了生成函数在从理论上刻画分布特征方面的强大能力。",
            "id": "4929075",
            "problem": "一个生物统计学团队将单个细胞外显子组中观察到的体细胞突变数建模为一个离散非负随机变量 $X$，该变量服从参数为 $\\lambda>0$ 的泊松分布。其概率质量函数为 $\\Pr(X=k)=\\exp(-\\lambda)\\,\\lambda^{k}/k!$，$k\\in\\{0,1,2,\\dots\\}$。请仅使用概率生成函数 (PGF) 的定义 $G_{X}(s)=\\mathbb{E}[s^{X}]$，以及 $G_{X}(s)$ 的导数与 $X$ 的矩之间的基本关系，推导出均值 $\\mathbb{E}[X]$ 和方差 $\\operatorname{Var}(X)$ 关于 $\\lambda$ 的闭式表达式。你的最终答案必须以解析表达式的形式给出；不需要数值近似或四舍五入，也不需要报告单位。",
            "solution": "设 $X$ 是一个服从参数为 $\\lambda > 0$ 的泊松分布的离散随机变量。其概率质量函数 (PMF) 由下式给出\n$$\n\\Pr(X=k) = \\frac{\\exp(-\\lambda)\\lambda^{k}}{k!} \\quad \\text{for } k \\in \\{0, 1, 2, \\dots\\}\n$$\n$X$ 的概率生成函数 (PGF) 定义为 $G_{X}(s) = \\mathbb{E}[s^{X}]$。根据离散随机变量期望值的定义，我们有：\n$$\nG_{X}(s) = \\sum_{k=0}^{\\infty} s^{k} \\Pr(X=k)\n$$\n将泊松分布的 PMF 代入此定义，我们得到：\n$$\nG_{X}(s) = \\sum_{k=0}^{\\infty} s^{k} \\frac{\\exp(-\\lambda)\\lambda^{k}}{k!}\n$$\n我们可以将项 $\\exp(-\\lambda)$ 提出来，因为它不依赖于求和指数 $k$：\n$$\nG_{X}(s) = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{(s\\lambda)^{k}}{k!}\n$$\n该求和是指数函数 $\\exp(z) = \\sum_{k=0}^{\\infty} \\frac{z^{k}}{k!}$ 的泰勒级数展开。通过令 $z=s\\lambda$，我们可以简化 PGF 的表达式：\n$$\nG_{X}(s) = \\exp(-\\lambda) \\exp(s\\lambda) = \\exp(s\\lambda - \\lambda) = \\exp(\\lambda(s-1))\n$$\n这即是服从泊松分布的随机变量的 PGF 的闭式表达式。\n\n问题要求我们使用 PGF 的导数与 $X$ 的矩之间的基本关系。PGF 在 $s=1$ 处的一阶导数得到均值（一阶原点矩），而在 $s=1$ 处的二阶导数与二阶阶乘矩相关。\n\n具体来说，$G_X(s)$ 关于 $s$ 的一阶导数是：\n$$\nG'_{X}(s) = \\frac{d}{ds} G_{X}(s) = \\frac{d}{ds} \\mathbb{E}[s^{X}] = \\mathbb{E}\\left[\\frac{d}{ds}s^{X}\\right] = \\mathbb{E}[X s^{X-1}]\n$$\n在 $s=1$ 处求值，得到均值：\n$$\n\\mathbb{E}[X] = G'_{X}(1) = \\mathbb{E}[X \\cdot 1^{X-1}] = \\mathbb{E}[X]\n$$\n让我们根据我们推导出的 PGF，$G_X(s) = \\exp(\\lambda(s-1))$，来计算 $G'_{X}(s)$：\n$$\nG'_{X}(s) = \\frac{d}{ds} \\exp(\\lambda(s-1)) = \\exp(\\lambda(s-1)) \\cdot \\frac{d}{ds}(\\lambda s - \\lambda) = \\lambda \\exp(\\lambda(s-1))\n$$\n现在，我们在 $s=1$ 处求值：\n$$\n\\mathbb{E}[X] = G'_{X}(1) = \\lambda \\exp(\\lambda(1-1)) = \\lambda \\exp(0) = \\lambda \\cdot 1 = \\lambda\n$$\n因此，泊松分布的均值为 $\\lambda$。\n\n接下来，我们推导方差 $\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$。为了求出 $\\mathbb{E}[X^2]$，我们使用 PGF 的二阶导数。$G_X(s)$ 的二阶导数是：\n$$\nG''_{X}(s) = \\frac{d}{ds} G'_{X}(s) = \\frac{d}{ds} \\mathbb{E}[X s^{X-1}] = \\mathbb{E}\\left[\\frac{d}{ds} (X s^{X-1})\\right] = \\mathbb{E}[X(X-1)s^{X-2}]\n$$\n在 $s=1$ 处求值，得到二阶阶乘矩：\n$$\nG''_{X}(1) = \\mathbb{E}[X(X-1) \\cdot 1^{X-2}] = \\mathbb{E}[X(X-1)]\n$$\n让我们通过对 $G'_{X}(s) = \\lambda \\exp(\\lambda(s-1))$ 求导来计算 $G''_{X}(s)$：\n$$\nG''_{X}(s) = \\frac{d}{ds} \\left[\\lambda \\exp(\\lambda(s-1))\\right] = \\lambda \\left[ \\lambda \\exp(\\lambda(s-1)) \\right] = \\lambda^2 \\exp(\\lambda(s-1))\n$$\n现在，我们在 $s=1$ 处求值：\n$$\n\\mathbb{E}[X(X-1)] = G''_{X}(1) = \\lambda^2 \\exp(\\lambda(1-1)) = \\lambda^2 \\exp(0) = \\lambda^2\n$$\n二阶阶乘矩与二阶原点矩 $\\mathbb{E}[X^2]$ 的关系如下：\n$$\n\\mathbb{E}[X(X-1)] = \\mathbb{E}[X^2 - X] = \\mathbb{E}[X^2] - \\mathbb{E}[X]\n$$\n重新整理此方程以求解 $\\mathbb{E}[X^2]$：\n$$\n\\mathbb{E}[X^2] = \\mathbb{E}[X(X-1)] + \\mathbb{E}[X]\n$$\n代入我们已求得的值：\n$$\n\\mathbb{E}[X^2] = G''_{X}(1) + G'_{X}(1) = \\lambda^2 + \\lambda\n$$\n最后，我们可以计算方差：\n$$\n\\operatorname{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = (\\lambda^2 + \\lambda) - (\\lambda)^2 = \\lambda^2 + \\lambda - \\lambda^2 = \\lambda\n$$\n因此，泊松分布的方差也是 $\\lambda$。\n\n推导出的均值和方差表达式为 $\\mathbb{E}[X] = \\lambda$ 和 $\\operatorname{Var}(X) = \\lambda$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\lambda  \\lambda \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理论最终要应用于实践，矩的概念在统计建模中扮演着至关重要的角色。这个问题  将带你进入参数估计的世界，你将使用“矩量法”来估计零膨胀泊松 (ZIP) 模型的参数。这是一个在生物统计学中非常实用的模型，它展示了如何利用样本矩来推断潜在总体的特征。",
            "id": "4929083",
            "problem": "一个生物统计学研究团队将粪便样本中寄生虫卵的数量 $Y$ 建模为零膨胀泊松 (Zero-Inflated Poisson, ZIP) 分布，因为存在大量来自未感染个体的零值。在这个 ZIP 模型中，结果有 $p$ 的概率为结构性零，有 $(1-p)$ 的概率遵循速率为 $\\lambda$ 的泊松分布。具体来说，对于整数 $k \\ge 0$，其概率质量函数满足\n$$\n\\mathbb{P}(Y=0)=p+(1-p)\\exp(-\\lambda), \\quad \\mathbb{P}(Y=k)=(1-p)\\exp(-\\lambda)\\frac{\\lambda^{k}}{k!}\\ \\text{for}\\ k\\ge 1.\n$$\n假设 $Y_{1},\\dots,Y_{n}$ 是来自该模型的独立同分布样本。定义前两个经验原始矩\n$$\nm_{1}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}, \\qquad m_{2}=\\frac{1}{n}\\sum_{i=1}^{n}Y_{i}^{2}.\n$$\n仅使用 $Y$ 的前两个总体原始矩，并将它们与 $m_{1}$ 和 $m_{2}$ 相等，推导矩估计量 $\\hat{p}$ 和 $\\hat{\\lambda}$，并表示为 $m_{1}$ 和 $m_{2}$ 的简化闭合形式表达式。\n\n然后，讨论仅匹配前两个矩时 $(p,\\lambda)$ 的可识别性：从矩和模型的定义性质出发，确定矩方程在何种 $(m_{1},m_{2})$ 条件下存在满足 $0\\le p < 1$ 和 $\\lambda\\ge 0$ 的唯一解，并解释边界情况或失效情况。你最终报告的估计量必须以 $m_{1}$ 和 $m_{2}$ 的代数表达式给出。不要四舍五入。",
            "solution": "任务是推导零膨胀泊松 (ZIP) 分布参数 $p$ 和 $\\lambda$ 的矩估计量，并分析这些估计量存在性和唯一性的条件。\n\n设 $Y$ 是一个遵循指定 ZIP 分布的随机变量，参数为 $p$ 和 $\\lambda$，其中 $p$ 是结构性零的概率，$\\lambda$ 是泊松分量的速率。其概率质量函数 (PMF) 由下式给出\n$$\n\\mathbb{P}(Y=k) = \\begin{cases} p + (1-p)e^{-\\lambda}  \\text{if } k=0 \\\\ (1-p)e^{-\\lambda}\\frac{\\lambda^k}{k!}  \\text{if } k \\in \\{1, 2, 3, \\dots\\} \\end{cases}\n$$\n参数的约束条件是 $0 \\le p < 1$ 和 $\\lambda \\ge 0$。\n\n为了推导矩估计量，我们首先计算 $Y$ 的前两个总体原始矩，记为 $\\mu_1 = \\mathbb{E}[Y]$ 和 $\\mu_2 = \\mathbb{E}[Y^2]$。一个 ZIP 随机变量可以被看作是一个混合模型。结果有 $p$ 的概率为 $0$。有 $1-p$ 的概率是来自泊松($\\lambda$) 分布的一个抽样。设 $X \\sim \\text{Poisson}(\\lambda)$。\n\n根据全期望定律，一阶原始矩为：\n$$\n\\mu_1 = \\mathbb{E}[Y] = p \\cdot \\mathbb{E}[Y | \\text{structural zero}] + (1-p) \\cdot \\mathbb{E}[Y | \\text{from Poisson}]\n$$\n结构性零的期望值为 $0$。泊松随机变量的期望值是其速率参数 $\\lambda$。\n$$\n\\mu_1 = p \\cdot 0 + (1-p) \\cdot \\mathbb{E}[X] = (1-p)\\lambda\n$$\n\n类似地，对于二阶原始矩：\n$$\n\\mu_2 = \\mathbb{E}[Y^2] = p \\cdot \\mathbb{E}[Y^2 | \\text{structural zero}] + (1-p) \\cdot \\mathbb{E}[Y^2 | \\text{from Poisson}]\n$$\n结构性零的期望平方值为 $0^2=0$。对于泊松分量 $X$，我们知道其方差为 $\\text{Var}(X) = \\lambda$，其均值为 $\\mathbb{E}[X] = \\lambda$。$X$ 的二阶矩是 $\\mathbb{E}[X^2] = \\text{Var}(X) + (\\mathbb{E}[X])^2 = \\lambda + \\lambda^2$。\n$$\n\\mu_2 = p \\cdot 0 + (1-p) \\cdot \\mathbb{E}[X^2] = (1-p)(\\lambda + \\lambda^2)\n$$\n\n矩估计法包括将这些总体矩与从样本 $Y_1, \\dots, Y_n$ 中导出的相应经验原始矩 $m_1$ 和 $m_2$ 相等。\n这为估计量 $\\hat{p}$ 和 $\\hat{\\lambda}$ 提供了以下方程组：\n$$\n\\begin{cases}\n(1-\\hat{p})\\hat{\\lambda} = m_1  (1) \\\\\n(1-\\hat{p})(\\hat{\\lambda} + \\hat{\\lambda}^2) = m_2  (2)\n\\end{cases}\n$$\n\n我们求解这个方程组以得到 $\\hat{p}$ 和 $\\hat{\\lambda}$。我们可以将方程 $(2)$ 重写为：\n$$\n(1-\\hat{p})\\hat{\\lambda} + (1-\\hat{p})\\hat{\\lambda}^2 = m_2\n$$\n将方程 $(1)$ 代入方程 $(2)$ 的展开形式：\n$$\nm_1 + (1-\\hat{p})\\hat{\\lambda}^2 = m_2\n$$\n这得到 $(1-\\hat{p})\\hat{\\lambda}^2 = m_2 - m_1$。\n现在，假设 $m_1 \\neq 0$ 且 $\\hat{\\lambda} \\neq 0$，我们可以用这个新方程除以方程 $(1)$：\n$$\n\\frac{(1-\\hat{p})\\hat{\\lambda}^2}{(1-\\hat{p})\\hat{\\lambda}} = \\frac{m_2 - m_1}{m_1}\n$$\n$$\n\\hat{\\lambda} = \\frac{m_2 - m_1}{m_1}\n$$\n接下来，我们使用方程 $(1)$ 求解 $\\hat{p}$：$1-\\hat{p} = \\frac{m_1}{\\hat{\\lambda}}$。\n代入 $\\hat{\\lambda}$ 的表达式：\n$$\n1-\\hat{p} = \\frac{m_1}{\\frac{m_2 - m_1}{m_1}} = \\frac{m_1^2}{m_2 - m_1}\n$$\n$$\n\\hat{p} = 1 - \\frac{m_1^2}{m_2 - m_1}\n$$\n\n现在，我们讨论 $(p, \\lambda)$ 的可识别性，以及在何种 $(m_1, m_2)$ 条件下，这些方程在参数空间 $0 \\le p < 1$ 和 $\\lambda \\ge 0$ 内产生有效且唯一的解。\n\n首先，考虑表达式中的分母。我们要求 $m_1 \\neq 0$ 且 $m_2 - m_1 \\neq 0$。\n如果 $m_1 = 0$，那么所有样本值 $Y_i$ 都必须是 $0$，这也意味着 $m_2 = 0$。在这种情况下，估计量是 $0/0$ 的不定形式。矩方程变为 $(1-p)\\lambda = 0$ 和 $(1-p)(\\lambda+\\lambda^2)=0$，当 $\\lambda=0$ (对于任何 $p \\in [0,1)$) 或 $p$ 趋近于 $1$ 时，这些方程都成立。参数是不可识别的。这是一个失效情况。\n\n假设 $m_1 > 0$。\n条件 $\\hat{\\lambda} \\ge 0$ 要求 $\\frac{m_2 - m_1}{m_1} \\ge 0$。由于 $m_1 > 0$，这等价于 $m_2 \\ge m_1$。\n我们来检验 $m_2 - m_1 = \\frac{1}{n}\\sum_{i=1}^n Y_i^2 - \\frac{1}{n}\\sum_{i=1}^n Y_i = \\frac{1}{n}\\sum_{i=1}^n (Y_i^2 - Y_i)$。\n由于每个 $Y_i$ 都是非负整数，所以 $Y_i^2 - Y_i = Y_i(Y_i-1) \\ge 0$。因此，对于计数数据，$m_2 - m_1 \\ge 0$ 总是成立的。\n等式 $m_2=m_1$ 成立当且仅当所有 $Y_i$ 都是 $0$ 或 $1$。如果 $m_2=m_1$ 且 $m_1>0$，我们关于 $\\hat{\\lambda}$ 的表达式得出 $\\hat{\\lambda}=0$，但关于 $\\hat{p}$ 的表达式涉及到除以 $m_2-m_1=0$，使其无定义。在这种情况下，矩方程组是不一致的，因为如果 $\\hat{\\lambda}=0$，则 $(1-\\hat{p})\\hat{\\lambda}=m_1 > 0$ 无法满足。这是另一个失效情况，表明 ZIP 模型（通过矩估计法）不适用于仅包含零和一的数据。\n\n对于一个非退化的解，我们要求 $m_2 > m_1$，这意味着至少有一个观测值 $Y_i>1$。如果这个条件成立，那么 $\\hat{\\lambda} > 0$。\n\n接下来，考虑对 $\\hat{p}$ 的约束：$0 \\le \\hat{p} < 1$。\n条件 $\\hat{p} < 1$ 意味着 $1 - \\frac{m_1^2}{m_2 - m_1} < 1$，可简化为 $-\\frac{m_1^2}{m_2-m_1} < 0$。由于 $m_1 > 0$，所以 $m_1^2 > 0$。如果 $m_2 - m_1 > 0$，这个不等式成立，这与 $\\hat{\\lambda} > 0$ 的条件相同。\n\n条件 $\\hat{p} \\ge 0$ 意味着 $1 - \\frac{m_1^2}{m_2 - m_1} \\ge 0$，即 $1 \\ge \\frac{m_1^2}{m_2 - m_1}$。\n因为我们已经确定 $m_2 - m_1 > 0$，我们可以写成 $m_2 - m_1 \\ge m_1^2$。\n重新整理得到 $m_2 - m_1^2 \\ge m_1$。\n$m_2 - m_1^2$ 这一项是数据的有偏样本方差。我们将其表示为 $s^2_b = m_2-m_1^2$。条件是 $s_b^2 \\ge m_1$，意味着样本方差必须至少与样本均值一样大。这个性质被称为过离散（或在边界处为等离散），是 ZIP 模型的一个特征。ZIP 分布的方差是 $\\text{Var}(Y) = (1-p)\\lambda + p(1-p)\\lambda^2 = \\mu_1 + \\frac{p}{1-p}\\mu_1^2$，它总是大于或等于其均值 $\\mu_1$。只有当样本数据表现出此特性时，矩估计法才能为 $p$ 产生一个有效的估计。\n\n关于 $(m_1, m_2)$ 的条件总结：\n1.  **唯一有效解 ($0 < p < 1, \\lambda > 0$):** 当样本数据是严格过离散时发生，即 $m_2 - m_1^2 > m_1$。这个单一条件意味着 $m_1>0$ (因为 $m_2-m_1^2 > m_1 \\ge 0$) 且 $m_2 > m_1$ (因为 $m_2 > m_1^2+m_1 > m_1$)，从而确保 $\\hat{\\lambda}>0$ 和 $\\hat{p} \\in (0,1)$。\n2.  **边界解 (泊松情况, $p=0, \\lambda>0$):** 当样本表现出等离散时发生，即 $m_2 - m_1^2 = m_1$。在这种情况下，$\\hat{p}=0$ 且 $\\hat{\\lambda} = \\frac{m_1^2+m_1-m_1}{m_1}=m_1$。数据与标准泊松分布一致。\n3.  **失效情况 (无有效解):**\n    a. **低离散:** 如果 $m_2 - m_1^2 < m_1$，该方法得出 $\\hat{p} < 0$，这是无效的。ZIP 模型无法适应低离散数据。\n    b. **类伯努利数据:** 如果 $m_2 = m_1$ (且 $m_1>0$)，数据仅由 $0$ 和 $1$ 组成。这从公式中得出 $\\hat{\\lambda}=0$，但如果 $m_1>0$，这与一阶矩方程 $m_1 = (1-\\hat{p})\\hat{\\lambda}$ 相矛盾。方程组是不一致的。\n    c. **全零数据:** 如果 $m_1=0$ (因此 $m_2=0$)，估计量是不确定的，反映了参数的不可识别性。\n\n在有效条件下，推导出的估计量是关于 $m_1$ 和 $m_2$ 的简化闭合形式表达式。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 - \\frac{m_{1}^{2}}{m_{2} - m_{1}}  \\frac{m_{2} - m_{1}}{m_{1}} \\end{pmatrix} } $$"
        }
    ]
}