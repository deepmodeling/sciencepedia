{
    "hands_on_practices": [
        {
            "introduction": "简单随机抽样（Simple Random Sampling, SRS）是抽样理论的基石。然而，当我们的样本在有限总体中占有不可忽略的比例时，每次抽样不再是完全独立的事件。这个练习将引导你从第一性原理出发，推导样本均值的方差，从而揭示有限群体校正（Finite Population Correction, FPC）的来源和重要性 ()。通过比较使用与未使用FPC时的方差，你将能够量化其影响，并更深刻地理解从有限与无限总体中抽样的本质区别。",
            "id": "4938646",
            "problem": "一个生物统计学团队从一个多医院网络中构建了一个成年患者的完整抽样框。该抽样框列举了 $N=10{,}000$ 条独立的患者记录。他们计划通过抽取一个大小为 $n=500$ 的无放回简单随机样本（正式名称为 Simple Random Sampling Without Replacement, SRSWOR）来估计有限总体的平均收缩压。设有限总体方差记为 $S^2$，定义为 $S^2=\\frac{1}{N-1}\\sum_{i=1}^{N}\\left(Y_i-\\bar{Y}_U\\right)^2$，其中 $\\bar{Y}_U$ 是有限总体均值，$Y_i$ 是抽样框中患者 $i$ 记录的收缩压。使用在SRSWOR下相依抽样平均值的方差和协方差的第一性原理，以及分母为 $N$ 的有限总体方差 $\\sigma^2=\\frac{1}{N}\\sum_{i=1}^{N}\\left(Y_i-\\bar{Y}_U\\right)^2$ 与 $S^2$ 之间的关系，推导出一个包含有限总体校正（FPC）的样本均值方差表达式，以及一个忽略有限总体校正（将抽样视为如同来自无限总体的独立抽样）的表达式。然后，对于给定的 $N$ 和 $n$，量化使用FPC相对于忽略它的相对效率，定义为不含FPC的方差与含FPC的方差之比。将所有结果用 $S^2$、$N$ 和 $n$ 表示，然后代入 $N=10{,}000$ 和 $n=500$ 以获得封闭形式的表达式。不要四舍五入；报告精确表达式。你的最终答案应按顺序列表：不含FPC的方差、含FPC的方差，以及定义的相对效率。",
            "solution": "该问题要求推导在无放回简单随机抽样（SRSWOR）下样本均值的方差表达式，包括包含和不包含有限总体校正（FPC）两种情况，然后计算相对效率。\n\n设有限总体由数值集合 $\\{Y_1, Y_2, \\dots, Y_N\\}$ 表示。总体大小为 $N=10{,}000$。从中无放回地抽取一个大小为 $n=500$ 的简单随机样本。设代表连续抽样的随机变量为 $y_1, y_2, \\dots, y_n$。样本均值 $\\bar{y}$ 是总体均值 $\\bar{Y}_U = \\frac{1}{N}\\sum_{i=1}^{N}Y_i$ 的一个估计量。样本均值定义为：\n$$\n\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i\n$$\n样本均值的方差由随机变量线性组合的方差通用公式给出：\n$$\n\\text{Var}(\\bar{y}) = \\text{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} y_i\\right) = \\frac{1}{n^2} \\text{Var}\\left(\\sum_{i=1}^{n} y_i\\right) = \\frac{1}{n^2} \\left[ \\sum_{i=1}^{n} \\text{Var}(y_i) + \\sum_{i \\neq j} \\text{Cov}(y_i, y_j) \\right]\n$$\n由于简单随机抽样的对称性，抽样是可交换的。这意味着任何单次抽样 $y_i$ 的边际分布是相同的，并且对于 $i \\neq j$，任何一对抽样 $(y_i, y_j)$ 的联合分布也是相同的。因此，对于所有 $i$，$ \\text{Var}(y_i) = \\text{Var}(y_1)$，对于所有 $i \\neq j$，$ \\text{Cov}(y_i, y_j) = \\text{Cov}(y_1, y_2)$。方差公式简化为：\n$$\n\\text{Var}(\\bar{y}) = \\frac{1}{n^2} \\left[ n \\cdot \\text{Var}(y_1) + n(n-1) \\cdot \\text{Cov}(y_1, y_2) \\right] = \\frac{1}{n} \\left[ \\text{Var}(y_1) + (n-1) \\text{Cov}(y_1, y_2) \\right]\n$$\n为了继续，我们必须推导 $\\text{Var}(y_1)$ 和 $\\text{Cov}(y_1, y_2)$ 的表达式。\n\n首先，考虑单次抽样的方差 $\\text{Var}(y_1)$。随机变量 $y_1$ 可以以相等的概率取任何总体值 $Y_k$，即 $P(y_1 = Y_k) = \\frac{1}{N}$。\n$y_1$ 的期望值为 $E[y_1] = \\sum_{k=1}^{N} Y_k P(y_1 = Y_k) = \\frac{1}{N} \\sum_{k=1}^{N} Y_k = \\bar{Y}_U$。\n$y_1$ 的方差是 $\\text{Var}(y_1) = E[y_1^2] - (E[y_1])^2 = \\left(\\frac{1}{N}\\sum_{k=1}^{N} Y_k^2\\right) - \\bar{Y}_U^2$。根据定义，这是分母为 $N$ 的有限总体方差，记为 $\\sigma^2$：\n$$\n\\sigma^2 = \\frac{1}{N} \\sum_{i=1}^{N} (Y_i - \\bar{Y}_U)^2 = \\text{Var}(y_1)\n$$\n问题中定义了 $S^2 = \\frac{1}{N-1}\\sum_{i=1}^{N}(Y_i-\\bar{Y}_U)^2$。$S^2$ 和 $\\sigma^2$ 之间的关系是 $\\sigma^2 = \\frac{N-1}{N}S^2$。因此，\n$$\n\\text{Var}(y_1) = \\frac{N-1}{N}S^2\n$$\n\n接下来，考虑两次不同抽样的协方差 $\\text{Cov}(y_1, y_2)$。\n$\\text{Cov}(y_1, y_2) = E[y_1 y_2] - E[y_1]E[y_2] = E[y_1 y_2] - \\bar{Y}_U^2$。\n为了在SRSWOR下求得 $E[y_1 y_2]$，我们考虑对于任何一对不同的总体单元 $k \\neq l$，先抽到 $Y_k$ 再抽到 $Y_l$ 的概率是 $P(y_1=Y_k, y_2=Y_l) = P(y_1=Y_k)P(y_2=Y_l|y_1=Y_k) = \\frac{1}{N} \\frac{1}{N-1}$。\n$$\nE[y_1 y_2] = \\sum_{k=1}^{N} \\sum_{l \\neq k} Y_k Y_l P(y_1=Y_k, y_2=Y_l) = \\frac{1}{N(N-1)} \\sum_{k \\neq l} Y_k Y_l\n$$\n使用恒等式 $(\\sum_{k=1}^N Y_k)^2 = \\sum_{k=1}^N Y_k^2 + \\sum_{k \\neq l} Y_k Y_l$，我们可以写出 $\\sum_{k \\neq l} Y_k Y_l = (N\\bar{Y}_U)^2 - \\sum_{k=1}^N Y_k^2$。\n将此代入 $E[y_1 y_2]$ 的表达式中：\n$$\nE[y_1 y_2] = \\frac{N^2\\bar{Y}_U^2 - \\sum_{k=1}^N Y_k^2}{N(N-1)}\n$$\n现在，协方差为：\n$$\n\\text{Cov}(y_1, y_2) = \\frac{N^2\\bar{Y}_U^2 - \\sum Y_k^2}{N(N-1)} - \\bar{Y}_U^2 = \\frac{N^2\\bar{Y}_U^2 - \\sum Y_k^2 - N(N-1)\\bar{Y}_U^2}{N(N-1)}\n$$\n$$\n\\text{Cov}(y_1, y_2) = \\frac{N\\bar{Y}_U^2 - \\sum Y_k^2}{N(N-1)} = -\\frac{1}{N-1} \\left( \\frac{\\sum Y_k^2}{N} - \\bar{Y}_U^2 \\right) = -\\frac{\\sigma^2}{N-1}\n$$\n用 $S^2$ 表示：\n$$\n\\text{Cov}(y_1, y_2) = -\\frac{1}{N-1} \\left(\\frac{N-1}{N}S^2\\right) = -\\frac{S^2}{N}\n$$\n\n**1. 含有限总体校正（FPC）的样本均值方差**\n我们现在将 $\\text{Var}(y_1)$ 和 $\\text{Cov}(y_1, y_2)$ 的表达式代入SRSWOR的 $\\text{Var}(\\bar{y})$ 公式中：\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{1}{n} \\left[ \\frac{N-1}{N}S^2 + (n-1)\\left(-\\frac{S^2}{N}\\right) \\right]\n$$\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{S^2}{nN} [ (N-1) - (n-1) ] = \\frac{S^2}{nN} [N-n] = \\frac{S^2}{n} \\left(\\frac{N-n}{N}\\right)\n$$\n这个表达式是包含FPC的样本均值方差，其中FPC因子为 $\\left(1-\\frac{n}{N}\\right)$。\n代入 $N=10{,}000$ 和 $n=500$：\n$$\n\\text{Var}_{\\text{SRSWOR}}(\\bar{y}) = \\frac{S^2}{500} \\left(1 - \\frac{500}{10{,}000}\\right) = \\frac{S^2}{500} \\left(1 - \\frac{1}{20}\\right) = \\frac{S^2}{500} \\left(\\frac{19}{20}\\right) = \\frac{19S^2}{10{,}000}\n$$\n\n**2. 不含FPC的样本均值方差**\n忽略FPC等同于将抽样视为来自无限总体或有放回抽样。在这种情况下，抽样 $y_i$ 是独立的，这意味着对于 $i \\neq j$，$\\text{Cov}(y_i, y_j) = 0$。样本均值方差的公式简化为：\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\text{Var}(y_i) = \\frac{n \\cdot \\text{Var}(y_1)}{n^2} = \\frac{\\text{Var}(y_1)}{n}\n$$\n在无限总体的理想化情况下，$S^2$ 和 $\\sigma^2$ 之间的区别消失了。在这种情况下，样本均值方差的标准公式是 $\\frac{S^2}{n}$，其中 $S^2$ 是总体方差。这对应于将FPC因子 $\\left(\\frac{N-n}{N}\\right)$ 设置为1。\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{S^2}{n}\n$$\n代入 $n=500$：\n$$\n\\text{Var}_{\\text{no FPC}}(\\bar{y}) = \\frac{S^2}{500}\n$$\n\n**3. 相对效率**\n相对效率定义为不含FPC的方差与含FPC的方差之比。\n$$\n\\text{Relative Efficiency} = \\frac{\\text{Var}_{\\text{no FPC}}(\\bar{y})}{\\text{Var}_{\\text{SRSWOR}}(\\bar{y})} = \\frac{S^2/n}{\\frac{S^2}{n}\\left(\\frac{N-n}{N}\\right)} = \\frac{1}{\\frac{N-n}{N}} = \\frac{N}{N-n}\n$$\n代入 $N=10{,}000$ 和 $n=500$：\n$$\n\\text{Relative Efficiency} = \\frac{10{,}000}{10{,}000 - 500} = \\frac{10{,}000}{9{,}500} = \\frac{100}{95} = \\frac{20}{19}\n$$\n\n所需的三个量是：\n- 不含FPC的方差： $\\frac{S^2}{500}$\n- 含FPC的方差： $\\frac{19S^2}{10,000}$\n- 相对效率： $\\frac{20}{19}$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{S^2}{500} & \\frac{19S^2}{10000} & \\frac{20}{19} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在现实世界的研究中，我们使用的抽样框很少能完美覆盖整个目标群体。这种不匹配会引入系统性误差，即偏倚（bias），这种误差无法通过简单地增加样本量来减小。这个实践问题提供了一个真实的公共卫生场景，其中一个不完整的患者登记系统被用作抽样框 ()。通过系统地分析哪些群体被纳入、哪些被排除，你将推导出由此产生的患病率估计偏差的表达式，这将为你提供一个关于评估抽样框质量至关重要的深刻教训。",
            "id": "4938670",
            "problem": "一座城市计划使用一个全面的患者登记系统作为抽样框，来估计其居民人口中某种慢性感染的点流行率。设目标总体规模为 $N$，点流行率定义为 $p = D/N$，其中 $D$ 是在指标日期总体中的感染者总数。假设该登记系统包括所有非患病居民和所有有症状的感染居民。然而，在感染者中，有一部分比例 $s$ 是无症状的，并且由于未与医疗系统接触，已知比例 $e$ 的无症状感染者被排除在登记系统之外（也就是说，他们根本不出现在抽样框中）。\n\n该城市通过计算登记系统中所列个体中感染者的比例来计算流行率。使用上述设定，从流行率的定义以及偏差（定义为估计量的期望值与真实参数之差）的定义出发，推导因排除无症状病例而导致的基于登记系统的流行率估计值的偏差的解析表达式。然后，使用以下科学上合理的参数，对该偏差进行数值计算：\n- 总体规模 $N = 1{,}200{,}000$，\n- 真实流行率 $p = 0.08$，\n- 感染者中无症状者的比例 $s = 0.7$，\n- 从抽样框中排除的无症状感染者的比例 $e = 0.2$。\n\n将偏差表示为小数（不带百分号），并将最终答案四舍五入至四位有效数字。",
            "solution": "首先，我们定义总体和登记系统的各个组成部分，以推导出基于登记系统的流行率估计值 $\\hat{p}$。\n\n**总体构成:**\n- 总体规模：$N = 1,200,000$\n- 真实流行率：$p = 0.08$\n- 总感染人数：$D = pN$\n- 非感染人数：$N - D = N(1-p)$\n\n**感染人群内部构成:**\n- 无症状感染者比例：$s = 0.7$\n- 无症状感染人数：$D_{asymp} = sD = spN$\n- 有症状感染人数：$D_{symp} = (1-s)D = (1-s)pN$\n\n**抽样框（登记系统）构成:**\n根据问题描述，登记系统包括：\n1.  所有非感染居民：$N(1-p)$\n2.  所有有症状的感染居民：$(1-s)pN$\n3.  未被排除的无症状感染居民。由于比例为 $e$ 的无症状感染者被排除，因此比例为 $(1-e)$ 的无症状感染者被包括在内。人数为 $(1-e)D_{asymp} = (1-e)spN$。\n\n**登记系统中的总人数 ($N_{reg}$):**\n$N_{reg}$ 是上述三部分人数之和：\n$$ N_{reg} = N(1-p) + (1-s)pN + (1-e)spN $$\n简化表达式：\n$$ N_{reg} = N - pN + pN - spN + spN - espN = N - espN = N(1-esp) $$\n这等于总人口减去被排除的人数（$espN$）。\n\n**登记系统中的感染者总数 ($D_{reg}$):**\n$D_{reg}$ 是登记系统中所有感染者的总和（有症状 + 被包含的无症状）：\n$$ D_{reg} = (1-s)pN + (1-e)spN $$\n简化表达式：\n$$ D_{reg} = pN - spN + spN - espN = pN - espN = pN(1-es) $$\n\n**基于登记系统的流行率估计值 ($\\hat{p}$):**\n该估计值是登记系统中的感染者比例：\n$$ \\hat{p} = \\frac{D_{reg}}{N_{reg}} = \\frac{pN(1-es)}{N(1-esp)} = \\frac{p(1-es)}{1-esp} $$\n\n**偏差计算:**\n偏差定义为估计值与真实值之差，即 $\\text{偏差} = \\hat{p} - p$。\n$$ \\text{偏差} = \\frac{p(1-es)}{1-esp} - p $$\n通分并简化：\n$$ \\text{偏差} = \\frac{p(1-es) - p(1-esp)}{1-esp} = \\frac{p - pes - p + p^2es}{1-esp} = \\frac{p^2es - pes}{1-esp} = \\frac{pes(p-1)}{1-esp} $$\n这就是偏差的解析表达式。\n\n**数值计算:**\n代入给定参数 $p=0.08$，$s=0.7$，$e=0.2$：\n- 分子：$pes(p-1) = 0.08 \\times 0.2 \\times 0.7 \\times (0.08 - 1) = 0.0112 \\times (-0.92) = -0.010304$\n- 分母：$1 - esp = 1 - 0.2 \\times 0.7 \\times 0.08 = 1 - 0.0112 = 0.9888$\n- 偏差：$\\frac{-0.010304}{0.9888} \\approx -0.01042071...$\n\n根据要求，将结果四舍五入到四位有效数字，得到 $-0.01042$。",
            "answer": "$$\\boxed{-0.01042}$$"
        },
        {
            "introduction": "一个精心构建的抽样框通常包含可以用来提高抽样效率的辅助信息。分层抽样（Stratified Sampling）就是一种利用这类信息将总体划分为多个同质子群（层）的强大技术，从而确保样本更具代表性，并提高估计的精确度。在本练习中，你将使用分层设计来计算均值估计量及其方差，并将其与同样总样本量的简单随机抽样的性能进行比较 ()。这将具体展示如何通过利用抽样框的结构来显著提升统计效率，用同样的资源获得更精确的估计。",
            "id": "4938682",
            "problem": "一个卫生系统按年龄组对成年患者维持一个完整的分层抽样框：层 $h=1$ 为 $18$–$44$ 岁，层 $h=2$ 为 $45$–$64$ 岁，层 $h=3$ 为 $\\ge 65$ 岁。有限总体大小为 $N_1 = 2000$，$N_2 = 1500$ 和 $N_3 = 1500$，因此层权重为 $W_h = N_h/N$，其中 $N = 5000$，即 $W_1 = 0.4$，$W_2 = 0.3$，$W_3 = 0.3$。采用不放回分层简单随机抽样，抽取了 $n_1 = 80$，$n_2 = 60$ 和 $n_3 = 60$ 名患者（总计 $n = 200$）。结果 $Y$ 是以毫米汞柱为单位的收缩压。层内样本均值和方差为\n$\\bar{y}_1 = 130$，$s_1^2 = 225$；$\\bar{y}_2 = 140$，$s_2^2 = 400$；$\\bar{y}_3 = 150$，$s_3^2 = 625$。\n\n仅使用分层抽样和简单随机抽样下期望和方差的核心定义，以及样本方差的定义，完成以下任务：\n\n1. 从第一性原理出发，构建总体均值 $\\bar{Y}$ 的分层估计量，并推导其在不放回分层简单随机抽样下的设计方差，同时在各层内纳入有限总体校正（FPC）。然后，使用上述数据计算该方差估计量的数值。\n\n2. 作为反事实情景，考虑从规模为 $N=5000$ 的同一总体中，进行一次规模为 $n=200$ 的不放回简单随机抽样（SRS）。从样本方差的定义出发，推导如何从分组（层级）摘要中计算 $Y$ 的总样本方差的无偏估计量，并使用给定的 $\\bar{y}_h$、$s_h^2$ 和 $n_h$ 求其数值。利用此结果获得样本均值的常规SRS方差估计量，包括对整个总体的FPC。\n\n最后，计算SRS方差估计量与分层抽样方差估计量之比 $R$，\n$$\nR \\equiv \\frac{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}})}{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}})}.\n$$\n将 $R$ 报告为一个无单位数，并四舍五入到四位有效数字。",
            "solution": "该问题要求在两种不同的抽样设计下（分层简单随机抽样和简单随机抽样）计算并比较总体均值的方差估计量。该问题定义明确，科学上合理，且内部一致。\n\n首先，我们根据问题陈述建立符号表示。\n$H=3$ 是层的数量。\n$N_h$ 是层 $h$ 的总体大小，其中 $N_1=2000$，$N_2=1500$，$N_3=1500$。\n$N = \\sum_{h=1}^H N_h = 5000$ 是总总体大小。\n$W_h = N_h/N$ 是层 $h$ 的总体权重，其中 $W_1=0.4$，$W_2=0.3$，$W_3=0.3$。\n$n_h$ 是从层 $h$ 抽取的样本大小，其中 $n_1=80$，$n_2=60$，$n_3=60$。\n$n = \\sum_{h=1}^H n_h = 200$ 是总样本大小。\n$\\bar{y}_h$ 是层 $h$ 的样本均值，其中 $\\bar{y}_1=130$，$\\bar{y}_2=140$，$\\bar{y}_3=150$。\n$s_h^2$ 是层 $h$ 的样本方差，其中 $s_1^2=225$，$s_2^2=400$，$s_3^2=625$。\n$\\bar{Y}$ 是真实总体均值。\n$\\bar{Y}_h$ 是层 $h$ 的真实总体均值。\n$S_h^2$ 是层 $h$ 的真实总体方差。\n$S^2$ 是真实的总总体方差。\n$f_h = n_h/N_h$ 是层 $h$ 的抽样分数。\n$f = n/N$ 是总抽样分数。\n\n第1部分：分层抽样下的分析\n\n在分层抽样下，总体均值 $\\bar{Y}$ 的估计量（记为 $\\bar{y}_{\\mathrm{st}}$）是各层样本均值的加权平均，其权重等于总体层权重 $W_h$。\n$$ \\bar{y}_{\\mathrm{st}} = \\sum_{h=1}^{H} W_h \\bar{y}_h $$\n该估计量是无偏的，即 $E[\\bar{y}_{\\mathrm{st}}] = \\bar{Y}$。\n\n为推导其方差，我们利用了从各层独立抽样的性质。因此，和的方差等于方差的和：\n$$ \\operatorname{Var}(\\bar{y}_{\\mathrm{st}}) = \\operatorname{Var}\\left(\\sum_{h=1}^{H} W_h \\bar{y}_h\\right) = \\sum_{h=1}^{H} \\operatorname{Var}(W_h \\bar{y}_h) = \\sum_{h=1}^{H} W_h^2 \\operatorname{Var}(\\bar{y}_h) $$\n在每个层 $h$ 内，从一个规模为 $N_h$ 的总体中抽取一个规模为 $n_h$ 的不放回简单随机样本。样本均值 $\\bar{y}_h$ 的方差由下式给出：\n$$ \\operatorname{Var}(\\bar{y}_h) = \\frac{S_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n其中 $(1 - n_h/N_h)$ 是层 $h$ 的有限总体校正（FPC）。\n将此代入 $\\operatorname{Var}(\\bar{y}_{\\mathrm{st}})$ 的表达式中，得到：\n$$ \\operatorname{Var}(\\bar{y}_{\\mathrm{st}}) = \\sum_{h=1}^{H} W_h^2 \\frac{S_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n这是分层估计量的真实方差。为了从样本数据中估计此方差，我们将未知的总体方差 $S_h^2$ 替换为其无偏样本估计量，即样本方差 $s_h^2$。由此得到基于设计的方差估计量为：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}}) = \\sum_{h=1}^{H} W_h^2 \\frac{s_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right) $$\n现在，我们使用所提供的数据计算此估计量的数值。\n对于层 $h=1$：\n$W_1^2 \\frac{s_1^2}{n_1} (1 - \\frac{n_1}{N_1}) = (0.4)^2 \\frac{225}{80} (1 - \\frac{80}{2000}) = 0.16 \\times 2.8125 \\times (1 - 0.04) = 0.45 \\times 0.96 = 0.432$。\n对于层 $h=2$：\n$W_2^2 \\frac{s_2^2}{n_2} (1 - \\frac{n_2}{N_2}) = (0.3)^2 \\frac{400}{60} (1 - \\frac{60}{1500}) = 0.09 \\times \\frac{20}{3} \\times (1 - 0.04) = 0.6 \\times 0.96 = 0.576$。\n对于层 $h=3$：\n$W_3^2 \\frac{s_3^2}{n_3} (1 - \\frac{n_3}{N_3}) = (0.3)^2 \\frac{625}{60} (1 - \\frac{60}{1500}) = 0.09 \\times \\frac{625}{60} \\times (1 - 0.04) = 0.9375 \\times 0.96 = 0.9$。\n总估计方差是这些分量的和：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}}) = 0.432 + 0.576 + 0.9 = 1.908 $$\n\n第2部分：简单随机抽样（SRS）下的反事实分析\n\n我们考虑一个假设情景，即从总规模为 $N=5000$ 的总体中抽取一个规模为 $n=200$ 的简单随机样本。总体均值的估计量将是样本均值 $\\bar{y}_{\\mathrm{SRS}}$。其方差的标准无偏估计量为：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}}) = \\frac{s^2}{n} \\left(1 - \\frac{n}{N}\\right) $$\n其中 $s^2$ 是总样本方差。问题要求我们从提供的层级摘要中推导 $s^2$ 的计算方法。我们拥有的数据来自一个分层样本，而非简单随机样本。我们将各层的数据合并起来，以计算这 $n=200$ 个个体的总样本方差。\n\n合并样本的样本方差 $s^2$ 的定义为：\n$$ s^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2 $$\n其中 $\\bar{y}$ 是总样本均值，计算公式为 $\\bar{y} = \\frac{1}{n} \\sum_{h=1}^H n_h \\bar{y}_h$。总平方和 $TSS = \\sum_{i=1}^n(y_i - \\bar{y})^2 = (n-1)s^2$ 可以被分解。我们将对所有个体 $i$ 的求和表示为对层 $h$ 和层内个体 $i$ 的双重求和：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y})^2 $$\n其中 $y_{hi}$ 是层 $h$ 中第 $i$ 个个体的值。我们在平方项内部加上并减去层样本均值 $\\bar{y}_h$：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} \\left( (y_{hi} - \\bar{y}_h) + (\\bar{y}_h - \\bar{y}) \\right)^2 $$\n展开平方项得到：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} \\left( (y_{hi} - \\bar{y}_h)^2 + 2(y_{hi} - \\bar{y}_h)(\\bar{y}_h - \\bar{y}) + (\\bar{y}_h - \\bar{y})^2 \\right) $$\n分配求和符号：\n$$ TSS = \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2 + \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} 2(y_{hi} - \\bar{y}_h)(\\bar{y}_h - \\bar{y}) + \\sum_{h=1}^{H} \\sum_{i=1}^{n_h} (\\bar{y}_h - \\bar{y})^2 $$\n交叉乘积项得以简化。对每个层 $h$ 而言，$(\\bar{y}_h - \\bar{y})$ 相对于内层求和是一个常数，因此我们得到 $2(\\bar{y}_h - \\bar{y}) \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)$。根据样本均值的定义，$\\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h) = 0$。因此，整个交叉乘积项为零。\n我们得到方差分析（ANOVA）的分解式：\n$$ TSS = \\sum_{h=1}^{H} \\underbrace{\\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2}_{\\text{组内平方和 (SSW)}} + \\sum_{h=1}^{H} \\underbrace{\\sum_{i=1}^{n_h} (\\bar{y}_h - \\bar{y})^2}_{\\text{组间平方和 (SSB)}} $$\n根据样本方差的定义 $s_h^2 = \\frac{1}{n_h-1} \\sum_{i=1}^{n_h} (y_{hi} - \\bar{y}_h)^2$，第一项是 $SSW = \\sum_{h=1}^H (n_h-1)s_h^2$。第二项是 $SSB = \\sum_{h=1}^H n_h (\\bar{y}_h - \\bar{y})^2$。\n因此，从分组数据计算 $s^2$ 的公式是：\n$$ s^2 = \\frac{1}{n-1} \\left( \\sum_{h=1}^{H} (n_h-1)s_h^2 + \\sum_{h=1}^{H} n_h(\\bar{y}_h - \\bar{y})^2 \\right) $$\n这个计算出的 $s^2$ 是规模为 $n=200$ 的合并样本的样本方差，并作为 SRS 公式所需的总总体方差 $S^2$ 的估计值。\n\n我们现在计算其数值。首先是总样本均值 $\\bar{y}$：\n$$ \\bar{y} = \\frac{1}{200} \\left(80 \\times 130 + 60 \\times 140 + 60 \\times 150 \\right) = \\frac{10400 + 8400 + 9000}{200} = \\frac{27800}{200} = 139 $$\n接下来，我们计算 SSW 和 SSB：\n$$ SSW = (80-1)(225) + (60-1)(400) + (60-1)(625) = 79 \\times 225 + 59 \\times 400 + 59 \\times 625 = 17775 + 23600 + 36875 = 78250 $$\n$$ SSB = 80(130-139)^2 + 60(140-139)^2 + 60(150-139)^2 = 80(-9)^2 + 60(1)^2 + 60(11)^2 = 80(81) + 60(1) + 60(121) = 6480 + 60 + 7260 = 13800 $$\n总平方和是 $TSS = 78250 + 13800 = 92050$。\n总样本方差 $s^2$ 是：\n$$ s^2 = \\frac{92050}{n-1} = \\frac{92050}{199} $$\n现在我们计算 SRS 下均值的估计方差：\n$$ \\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}}) = \\frac{s^2}{n} \\left(1 - \\frac{n}{N}\\right) = \\frac{92050/199}{200} \\left(1 - \\frac{200}{5000}\\right) = \\frac{92050}{199 \\times 200} (1 - 0.04) = \\frac{92050}{39800} \\times 0.96 = \\frac{88368}{39800} \\approx 2.2203015 $$\n\n最后一步：计算比率 $R$\n\nSRS方差估计量与分层抽样方差估计量之比 $R$ 为：\n$$ R = \\frac{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{SRS}})}{\\widehat{\\operatorname{Var}}(\\bar{y}_{\\mathrm{st}})} = \\frac{88368 / 39800}{1.908} \\approx \\frac{2.2203015}{1.908} \\approx 1.1636799 $$\n四舍五入到四位有效数字，我们得到 $R = 1.164$。这个值通常与设计效应相关，它表明对于这个总体和变量，在总样本量相同的情况下，按比例分配的分层抽样比简单随机抽样效率高约 $16.4\\%$（即产生更小的方差）。",
            "answer": "$$\\boxed{1.164}$$"
        }
    ]
}