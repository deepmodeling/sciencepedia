{
    "hands_on_practices": [
        {
            "introduction": "当我们估计总体方差时，一个直观的想法是直接套用总体方差的定义，只不过用样本数据来计算。这个练习  将引导我们探究这个直观估计量（即最大似然估计量，MLE）的性质。通过此练习，我们将揭示一个微妙但至关重要的概念——统计偏差，并理解为何在实践中我们更常用分母为 $n-1$ 的样本方差公式。",
            "id": "1953265",
            "problem": "在先进陶瓷部件的制造质量控制过程中，部件的断裂强度是一个关键参数。假设来自一批 $n$ 个部件的断裂强度测量值 $X_1, X_2, \\dots, X_n$构成一个随机样本，该样本来自一个具有未知真实均值 $\\mu$ 和未知真实方差 $\\sigma^2$ 的正态分布。\n\n为了估计过程的变异性，一位工程师使用了方差的最大似然估计量 (MLE)，其表达式为：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^{n} (X_i - \\bar{X})^2\n$$\n其中 $\\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 是样本均值。\n\n一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的偏差定义为 $\\text{Bias}(\\hat{\\theta}) = E[\\hat{\\theta}] - \\theta$。评估一个估计量的一个重要指标是其相对偏差，即偏差除以参数的真实值。\n\n确定 MLE 估计量 $\\hat{\\sigma}^2$ 的相对偏差，定义为 $\\frac{\\text{Bias}(\\hat{\\sigma}^2)}{\\sigma^2}$。您的最终答案应该是一个关于样本大小 $n$ 的闭式解析表达式。",
            "solution": "设 $X_{1},\\dots,X_{n}$ 是来自 $\\mathcal{N}(\\mu,\\sigma^{2})$ 的一个独立同分布样本。方差的 MLE 是\n$$\n\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2},\\quad \\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}.\n$$\n对于正态样本，一个标准的结果是以下分解：\n$$\n\\sum_{i=1}^{n}(X_{i}-\\mu)^{2}=\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}+n(\\bar{X}-\\mu)^{2}.\n$$\n在正态性假设下，分布满足\n$$\n\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\mu)^{2}\\sim \\chi^{2}_{n},\\quad \\frac{n(\\bar{X}-\\mu)^{2}}{\\sigma^{2}}\\sim \\chi^{2}_{1},\n$$\n并且这两项是独立的。因此，通过相减，\n$$\n\\frac{1}{\\sigma^{2}}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}\\sim \\chi^{2}_{n-1}.\n$$\n利用如果 $Y\\sim \\chi^{2}_{k}$ 则 $E[Y]=k$ 这一事实，我们得到\n$$\nE\\!\\left[\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}\\right]=(n-1)\\sigma^{2}.\n$$\n因此，\n$$\nE[\\hat{\\sigma}^{2}]=E\\!\\left[\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}\\right]=\\frac{n-1}{n}\\sigma^{2}.\n$$\n偏差是\n$$\n\\text{Bias}(\\hat{\\sigma}^{2})=E[\\hat{\\sigma}^{2}]-\\sigma^{2}=\\left(\\frac{n-1}{n}-1\\right)\\sigma^{2}=-\\frac{1}{n}\\sigma^{2}.\n$$\n所以，相对偏差是\n$$\n\\frac{\\text{Bias}(\\hat{\\sigma}^{2})}{\\sigma^{2}}=-\\frac{1}{n}.\n$$",
            "answer": "$$\\boxed{-\\frac{1}{n}}$$"
        },
        {
            "introduction": "在上一个练习中，我们发现方差的最大似然估计量是有偏的，这解释了为何无偏样本方差 $S^2$ 更受青睐。但这是否意味着“无偏”总是更优的选择呢？这个练习  将通过引入一个更全面的评估标准——均方误差（MSE）——来挑战这一观念。通过比较这两个估计量的MSE，你将深入理解统计估计中著名的“偏差-方差权衡”问题。",
            "id": "1953254",
            "problem": "在统计估计中，估计量的质量通常使用其均方误差（MSE）来评估。考虑一个从具有未知均值 $\\mu$ 和未知正方差 $\\sigma^2$ 的正态分布中抽取的，大小为 $n \\ge 2$ 的随机样本 $X_1, X_2, \\ldots, X_n$。\n\n总体方差 $\\sigma^2$ 的两个常用估计量是：\n1.  最大似然估计量（MLE），由 $\\hat{\\sigma}^2 = \\frac{1}{n} \\sum_{i=1}^{n} (X_i - \\bar{X})^2$ 给出，其中 $\\bar{X}$ 是样本均值。已知这个估计量是有偏的。\n2.  无偏样本方差，由 $S^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (X_i - \\bar{X})^2$ 给出。\n\n参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的均方误差（MSE）定义为 $\\text{MSE}(\\hat{\\theta}) = \\text{E}[(\\hat{\\theta} - \\theta)^2]$。\n\n对于样本量 $n$ 的哪些整数值，有偏的最大似然估计量（MLE）的均方误差 $\\text{MSE}(\\hat{\\sigma}^2)$ 严格小于无偏估计量 $S^2$ 的均方误差 $\\text{MSE}(S^2)$？\n\nA. 对于所有 $n \\ge 2$\n\nB. 对于 $n \\ge 2$ 的任何值都不成立\n\nC. 仅对于 $n=2$\n\nD. 仅对于 $n > 21$\n\nE. 对于 $2 \\le n \\le 20$",
            "solution": "设 $X_{1},\\ldots,X_{n}$ 为来自 $\\mathcal{N}(\\mu,\\sigma^{2})$ 的独立同分布（i.i.d.）样本，其中 $n \\ge 2$。定义无偏样本方差 $S^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}$ 和最大似然估计量（MLE） $\\hat{\\sigma}^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(X_{i}-\\bar{X})^{2}$。它们满足关系式\n$$\n\\hat{\\sigma}^{2}=\\frac{n-1}{n}S^{2}.\n$$\n\n关于正态样本的一个标准结果是\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n因此 $\\mathbb{E}[S^{2}]=\\sigma^{2}$，并且利用 $\\operatorname{Var}(\\chi^{2}_{\\nu})=2\\nu$，我们得到\n$$\n\\operatorname{Var}(S^{2})=\\frac{\\sigma^{4}}{(n-1)^{2}}\\operatorname{Var}\\!\\left(\\chi^{2}_{n-1}\\right)=\\frac{\\sigma^{4}}{(n-1)^{2}}\\cdot 2(n-1)=\\frac{2\\sigma^{4}}{n-1}.\n$$\n因此，无偏估计量的均方误差为\n$$\n\\operatorname{MSE}(S^{2})=\\operatorname{Var}(S^{2})=\\frac{2\\sigma^{4}}{n-1}.\n$$\n\n对于最大似然估计量（MLE），使用 $\\hat{\\sigma}^{2}=\\frac{n-1}{n}S^{2}$ 和上述分布，我们同样有\n$$\n\\frac{n\\hat{\\sigma}^{2}}{\\sigma^{2}}=\\frac{(n-1)S^{2}}{\\sigma^{2}} \\sim \\chi^{2}_{n-1}.\n$$\n因此\n$$\n\\mathbb{E}[\\hat{\\sigma}^{2}]=\\sigma^{2}\\cdot \\frac{n-1}{n}, \\quad \\operatorname{Bias}(\\hat{\\sigma}^{2})=\\mathbb{E}[\\hat{\\sigma}^{2}]-\\sigma^{2}=-\\frac{\\sigma^{2}}{n},\n$$\n以及\n$$\n\\operatorname{Var}(\\hat{\\sigma}^{2})=\\frac{\\sigma^{4}}{n^{2}}\\operatorname{Var}\\!\\left(\\chi^{2}_{n-1}\\right)=\\frac{\\sigma^{4}}{n^{2}}\\cdot 2(n-1)=\\frac{2\\sigma^{4}(n-1)}{n^{2}}.\n$$\n所以\n$$\n\\operatorname{MSE}(\\hat{\\sigma}^{2})=\\operatorname{Var}(\\hat{\\sigma}^{2})+\\operatorname{Bias}(\\hat{\\sigma}^{2})^{2}=\\frac{2\\sigma^{4}(n-1)}{n^{2}}+\\left(\\frac{\\sigma^{2}}{n}\\right)^{2}=\\sigma^{4}\\cdot \\frac{2n-1}{n^{2}}.\n$$\n\n为了比较均方误差，我们需要判断不等式 $\\operatorname{MSE}(\\hat{\\sigma}^{2}) < \\operatorname{MSE}(S^{2})$ 何时成立。这等价于比较：\n$$\n\\frac{2n-1}{n^{2}} < \\frac{2}{n-1}\n$$\n由于 $n \\ge 2$，分母 $n^2$ 和 $n-1$ 均为正数。我们可以交叉相乘得到等价的不等式：\n$$\n(2n-1)(n-1) < 2n^{2}\n$$\n展开左侧：\n$$\n2n^{2} - 2n - n + 1 < 2n^{2}\n$$\n$$\n2n^{2} - 3n + 1 < 2n^{2}\n$$\n从不等式两边减去 $2n^2$：\n$$\n-3n + 1 < 0\n$$\n$$\n1 < 3n\n$$\n$$\nn > \\frac{1}{3}\n$$\n由于问题规定样本量 $n$ 为整数且 $n \\ge 2$，这个条件总是成立的。因此，对于所有 $n \\ge 2$，$\\operatorname{MSE}(\\hat{\\sigma}^{2})$ 都严格小于 $\\operatorname{MSE}(S^{2})$。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "抽样分布的理论知识在应用于计算机模拟等实际任务时，其威力才能完全展现。这个练习  旨在搭建理论与实践之间的桥梁。你将运用样本方差的关键分布特性（即它与卡方分布的关系），设计一个算法来生成其抽样分布的随机值，这是进行蒙特卡洛模拟、功效分析等现代统计计算中的一项基本技能。",
            "id": "1953257",
            "problem": "一位质量控制工程师正在进行统计模拟，以研究一个制造过程的变异性。该过程生产的滚珠轴承的直径已知服从均值为 $\\mu$、方差为 $\\sigma^2$ 的正态分布。工程师计划模拟采集一个大小为 $n$ 的滚珠轴承随机样本，并计算样本方差，其定义为 $S^2 = \\frac{1}{n-1}\\sum_{i=1}^n (X_i - \\bar{X})^2$，其中 $\\bar{X}$ 是样本均值。\n\n为了高效地进行模拟，工程师将使用一个统计软件库，该库提供一个函数 `chi2.rand(df)`，此函数返回一个服从自由度为 `df` 的卡方分布的随机变量。目标是设计一种算法，通过直接使用 `chi2.rand(df)` 函数来生成样本方差的一个模拟值，记为 $s^2$。\n\n以下哪种算法正确描述了如何从 $S^2$ 的抽样分布中生成这样一个值 $s^2$？\n\nA. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n-1}$。\n\nB. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\n\nC. 从标准正态分布 $N(0, 1)$ 中生成 $n$ 个随机值 $x_1, \\dots, x_n$。计算模拟值为 $s^2 = \\sum_{i=1}^n x_i^2$。\n\nD. 使用 `y = chi2.rand(n-1)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{\\sigma^2 y}{n}$。\n\nE. 使用 `y = chi2.rand(n)` 生成一个随机值 $y$。计算模拟的样本方差为 $s^2 = \\frac{(n-1) y}{\\sigma^2}$。",
            "solution": "设 $X_{1},\\dots,X_{n}$ 独立同分布于 $N(\\mu,\\sigma^{2})$。样本方差为\n$$\nS^{2}=\\frac{1}{n-1}\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2},\n$$\n其中 $\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。\n\n通过定义 $Z_{i}=\\frac{X_{i}-\\mu}{\\sigma}$（$i=1,\\dots,n$）进行标准化。则 $Z_{i}\\sim N(0,1)$ 独立同分布，且标准化变量的样本均值为 $\\bar{Z}=\\frac{\\bar{X}-\\mu}{\\sigma}$。使用恒等式\n$$\n\\sum_{i=1}^{n}\\left(X_{i}-\\bar{X}\\right)^{2}=\\sigma^{2}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2},\n$$\n我们将样本方差重写为\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}.\n$$\n根据 Cochran 定理（或关于正态样本的标准结论），二次型\n$$\n\\sum_{i=1}^{n}\\left(Z_{i}-\\bar{Z}\\right)^{2}\n$$\n服从自由度为 $n-1$ 的卡方分布，即，\n$$\n\\frac{(n-1)S^{2}}{\\sigma^{2}}\\sim \\chi^{2}_{n-1}.\n$$\n等价地，如果 $Y\\sim \\chi^{2}_{n-1}$，则\n$$\nS^{2}=\\frac{\\sigma^{2}}{n-1}Y.\n$$\n因此，要从 $S^{2}$ 的抽样分布中模拟一次抽样 $s^{2}$，生成 $y=\\texttt{chi2.rand}(n-1)$ 并设置\n$$\ns^{2}=\\frac{\\sigma^{2}y}{n-1}.\n$$\n这正是选项 A。其他选项要么使用了错误的自由度，要么使用了错误的缩放比例，或者没有生成以样本均值为中心的样本方差分布（这会使自由度减少一）。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}