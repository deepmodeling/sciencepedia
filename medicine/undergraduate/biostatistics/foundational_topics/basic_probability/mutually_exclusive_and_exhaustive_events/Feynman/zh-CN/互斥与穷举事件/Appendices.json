{
    "hands_on_practices": [
        {
            "introduction": "掌握互斥和穷尽事件的核心在于理解它们的概率如何遵循概率论的基本公理。这个练习是一个基础热身，旨在通过一个简单的场景来巩固你的理解，让你直接看到这些概念是如何协同工作的。",
            "id": "55",
            "problem": "考虑一个样本空间为 $S$ 的随机实验。设 $A$ 和 $B$ 是该样本空间内的两个可能结果或结果集（事件）。事件 $A$ 和 $B$ 被定义为**互斥**的，这意味着它们不能同时发生（即，它们的交集为空集，$A \\cap B = \\emptyset$）。\n\n设 $p_A$ 是事件 $A$ 发生的概率，$p_B$ 是事件 $B$ 发生的概率。\n$$\nP(A) = p_A\n$$\n$$\nP(B) = p_B\n$$\n\n此外，设 $C$ 为事件 $A$ **和**事件 $B$ **都**不发生的事件。该事件的概率记为 $p_C$。\n$$\nP(C) = p_C\n$$\n三个事件 $A$、$B$ 和 $C$ 是完备的，意味着它们的并集构成了整个样本空间 $S$。\n\n仅使用概率论的基本公理，推导事件 $A$ 和 $B$ 的并集的概率表达式，记作 $P(A \\cup B)$，且该表达式仅用给定的概率 $p_C$ 表示。",
            "solution": "根据互斥且完备事件 $A, B, C$ 的概率公理，我们有\n$$\nP(A\\cup B\\cup C)=1.\n$$\n由于 $A, B, C$ 两两不交，\n$$\nP(A\\cup B\\cup C)=P(A)+P(B)+P(C)=p_A+p_B+p_C.\n$$\n因此\n$$\np_A+p_B+p_C=1.\n$$\n又因为 $A$ 和 $B$ 是互斥的，\n$$\nP(A\\cup B)=P(A)+P(B)=p_A+p_B.\n$$\n利用完备事件概率和消去 $p_A+p_B$，\n$$\nP(A\\cup B)=1-p_C.\n$$",
            "answer": "$$\\boxed{1 - p_C}$$"
        },
        {
            "introduction": "在概率论中，一个常见的混淆点是“互斥”与“独立”之间的区别。此练习旨在通过一个具体的生物统计学情景来澄清这一关键区别；你将通过从头开始计算概率并应用它们的严格定义来学习区分它们，这是进行准确统计推断的一项基本技能。",
            "id": "4931655",
            "problem": "一个生物统计学团队正在一个队列中研究一个二元实验室生物标志物 $M$（阳性 $M^+$，阴性 $M^-$）与一个二元临床结局 $Y$（改善 $Y^+$，未改善 $Y^-$）之间的关系。随机选择的一名参与者的样本空间 $\\Omega$ 由四个联合结局 $\\{(M^+,Y^+),(M^+,Y^-),(M^-,Y^+),(M^-,Y^-)\\}$ 组成，每个联合结局都被赋予了概率。对于下面的每个选项，都给出了一个关于 $\\Omega$ 的完整概率模型以及事件 $A$ 和 $B$ 的定义。选择所有 $A$ 和 $B$ 既相互独立又非互斥的选项。独立性、互斥性和穷尽性必须使用所提供的概率模型从基本原理进行评估。\n\n选项 A：\n- 联合概率：$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。\n- 事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。\n\n选项 B：\n- 联合概率：$P(M^+,Y^+)=0.10$，$P(M^+,Y^-)=0.30$，$P(M^-,Y^+)=0.40$，$P(M^-,Y^-)=0.20$。\n- 事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。\n\n选项 C：\n- 联合概率：$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。\n- 事件：$A=\\{M^+\\}$，$B=\\{M^-\\}$。\n\n选项 D：\n- 联合概率：$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。\n- 事件：$A=\\{M^+ \\cup Y^+\\}$，$B=\\{Y^+\\}$。\n\n选项 E：\n- 联合概率：$P(M^+,Y^+)=0.30$，$P(M^+,Y^-)=0.30$，$P(M^-,Y^+)=0.20$，$P(M^-,Y^-)=0.20$。\n- 事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。",
            "solution": "首先，将对问题陈述的科学合理性、清晰度和完整性进行验证。\n\n### 第1步：提取已知条件\n\n-   **样本空间**：随机选择的一名参与者的样本空间 $\\Omega$ 由四个联合结局组成：$\\Omega = \\{(M^+,Y^+),(M^+,Y^-),(M^-,Y^+),(M^-,Y^-)\\}$。\n-   **生物标志物**：一个二元实验室生物标志物 $M$，其状态为阳性 ($M^+$) 和阴性 ($M^-$)。\n-   **临床结局**：一个二元临床结局 $Y$，其状态为改善 ($Y^+$) 和未改善 ($Y^-$)。\n-   **任务**：对于每个选项，都给出了一个完整的概率模型。我们必须选择所有定义的事件 $A$ 和 $B$ 既相互独立又非互斥的选项。\n-   **所需分析**：评估必须基于概率论的基本原理。\n\n### 第2步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于初等概率论及其在生物统计学（一个标准且合法的科学领域）中的应用。样本空间、事件、联合概率、边缘概率、独立性和互斥性的概念是概率论的基础。该场景在临床研究中很常见。\n-   **问题的适定性**：这个问题是适定的。对于每个选项，都提供了一个在样本空间上的完整概率分布（概率之和为 $1$），并且事件 $A$ 和 $B$ 都有明确的定义。问题要求基于这些定义进行判断，这将为每个选项得出唯一的答案。\n-   **客观性**：问题以精确、客观的语言陈述。独立性 ($P(A \\cap B) = P(A)P(B)$) 和互斥性 ($A \\cap B = \\emptyset$，意味着 $P(A \\cap B)=0$) 的标准是标准的数学定义。\n\n该问题没有违反任何无效标准。这是一个直接的应用概率问题。\n\n### 第3步：结论与行动\n\n问题陈述是 **有效的**。开始进行解答。\n\n### 解答推导\n\n问题要求我们找出所有事件 $A$ 和 $B$ 同时满足以下条件的选项：\n1.  **独立**：两个事件 $A$ 和 $B$ 相互独立，当且仅当 $P(A \\cap B) = P(A)P(B)$。\n2.  **非互斥**：两个事件 $A$ 和 $B$ 非互斥，如果它们的交集非空，即 $A \\cap B \\neq \\emptyset$。对于一个所有基本结局概率都非零的有效概率模型，这等价于 $P(A \\cap B) > 0$。\n\n我们将根据这两个标准来分析每个选项。事件 $\\{M^+\\}$ 对应于结局集合 $\\{(M^+, Y^+), (M^+, Y^-)\\}$，事件 $\\{Y^+\\}$ 对应于 $\\{(M^+, Y^+), (M^-, Y^+)\\}$。此类事件的概率（边缘概率）是通过将其包含的基本结局的概率相加得到的。\n\n**选项 A**\n-   联合概率：$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。总和为 $0.20+0.20+0.30+0.30=1.00$。\n-   事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。\n-   每个事件的基本结局是：\n    -   $A = \\{(M^+, Y^+), (M^+, Y^-)\\}$。\n    -   $B = \\{(M^+, Y^+), (M^-, Y^+)\\}$。\n-   事件的交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.20$。\n-   由于 $P(A \\cap B) = 0.20 > 0$，事件是 **非互斥的**。\n-   现在，我们检查独立性。我们计算边缘概率 $P(A)$ 和 $P(B)$：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.20 + 0.20 = 0.40$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.20 + 0.30 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.40 \\times 0.50 = 0.20$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.20$ 且 $P(A)P(B) = 0.20$。由于 $P(A \\cap B) = P(A)P(B)$，事件是 **独立的**。\n-   结论：选项A满足两个条件（独立且非互斥）。**正确**。\n\n**选项 B**\n-   联合概率：$P(M^+,Y^+)=0.10$，$P(M^+,Y^-)=0.30$，$P(M^-,Y^+)=0.40$，$P(M^-,Y^-)=0.20$。总和为 $0.10+0.30+0.40+0.20=1.00$。\n-   事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。\n-   交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.10$。\n-   由于 $P(A \\cap B) = 0.10 > 0$，事件是 **非互斥的**。\n-   现在，我们检查独立性：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.10 + 0.30 = 0.40$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.10 + 0.40 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.40 \\times 0.50 = 0.20$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.10$ 且 $P(A)P(B) = 0.20$。由于 $P(A \\cap B) \\neq P(A)P(B)$，事件是 **非独立的**。\n-   结论：选项B不满足独立性条件。**错误**。\n\n**选项 C**\n-   联合概率：与选项A相同。$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。\n-   事件：$A=\\{M^+\\}$，$B=\\{M^-\\}$。\n-   事件定义为：\n    -   $A = \\{(M^+, Y^+), (M^+, Y^-)\\}$。\n    -   $B = \\{(M^-, Y^+), (M^-, Y^-)\\}$。\n-   这两个集合的交集为空：$A \\cap B = \\emptyset$。\n-   因此，事件是 **互斥的**。\n-   问题要求事件是*非*互斥的。\n-   结论：选项C不满足“非互斥”条件。**错误**。\n\n**选项 D**\n-   联合概率：与选项A相同。$P(M^+,Y^+)=0.20$，$P(M^+,Y^-)=0.20$，$P(M^-,Y^+)=0.30$，$P(M^-,Y^-)=0.30$。\n-   事件：$A=\\{M^+ \\cup Y^+\\}$，$B=\\{Y^+\\}$。\n-   每个事件的基本结局是：\n    -   $A = \\{M^+\\} \\cup \\{Y^+\\} = \\{(M^+,Y^+), (M^+,Y^-)\\} \\cup \\{(M^+,Y^+), (M^-,Y^+)\\} = \\{(M^+,Y^+), (M^+,Y^-), (M^-,Y^+)\\}$。\n    -   $B = \\{Y^+\\} = \\{(M^+,Y^+), (M^-,Y^+)\\}$。\n-   交集是 $A \\cap B = B = \\{(M^+,Y^+), (M^-,Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(B) = P(Y^+) = P(M^+,Y^+) + P(M^-,Y^+) = 0.20 + 0.30 = 0.50$。\n-   由于 $P(A \\cap B) = 0.50 > 0$，事件是 **非互斥的**。\n-   现在，我们检查独立性。我们需要 $P(A)$ 和 $P(B)$。我们已经有 $P(B)=0.50$。\n    -   $P(A) = P(\\{(M^+,Y^+), (M^+,Y^-), (M^-,Y^+)\\}) = P(M^+,Y^+) + P(M^+,Y^-) + P(M^-,Y^+) = 0.20 + 0.20 + 0.30 = 0.70$。\n-   我们计算乘积 $P(A)P(B) = 0.70 \\times 0.50 = 0.35$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.50$ 且 $P(A)P(B) = 0.35$。由于 $P(A \\cap B) \\neq P(A)P(B)$，事件是 **非独立的**。（注意：当一个事件 $B$ 是另一个事件 $A$ 的真子集时，即 $B \\subset A$，它们只有在 $P(B)>0$ 且 $P(A)=1$ 时，或者在 $P(B)=0$ 时才能独立。在这里，$P(A)=0.70 \\neq 1$ 且 $P(B)=0.50 > 0$，所以它们不可能是独立的。）\n-   结论：选项D不满足独立性条件。**错误**。\n\n**选项 E**\n-   联合概率：$P(M^+,Y^+)=0.30$，$P(M^+,Y^-)=0.30$，$P(M^-,Y^+)=0.20$，$P(M^-,Y^-)=0.20$。总和为 $0.30+0.30+0.20+0.20=1.00$。\n-   事件：$A=\\{M^+\\}$，$B=\\{Y^+\\}$。\n-   交集是 $A \\cap B = \\{(M^+, Y^+)\\}$。\n-   交集的概率是 $P(A \\cap B) = P(M^+, Y^+) = 0.30$。\n-   由于 $P(A \\cap B) = 0.30 > 0$，事件是 **非互斥的**。\n-   现在，我们检查独立性：\n    -   $P(A) = P(M^+) = P(M^+, Y^+) + P(M^+, Y^-) = 0.30 + 0.30 = 0.60$。\n    -   $P(B) = P(Y^+) = P(M^+, Y^+) + P(M^-, Y^+) = 0.30 + 0.20 = 0.50$。\n-   我们计算乘积 $P(A)P(B) = 0.60 \\times 0.50 = 0.30$。\n-   与 $P(A \\cap B)$ 比较，我们看到 $P(A \\cap B) = 0.30$ 且 $P(A)P(B) = 0.30$。由于 $P(A \\cap B) = P(A)P(B)$，事件是 **独立的**。\n-   结论：选项E满足两个条件（独立且非互斥）。**正确**。\n\n综上所述，选项A和E都描述了事件 $A$ 和 $B$ 独立且非互斥的情景。",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "互斥和穷尽事件的概念不仅仅是理论上的练习；它们是许多重要统计模型的基石。这个练习将基本原理与实际建模联系起来，展示了将样本空间划分为 $K$ 个互斥且穷尽的类别是如何自然地引出多项分布的，这是分析分类数据的一项强大工具。",
            "id": "4931638",
            "problem": "一项医院监测研究将每位患者精确地分入 $K$ 个疾病类别中的一类，这些类别是互斥且完备的，意味着对于任何单个患者，$K$ 个类别中恰好有一个会发生，且任意两个类别不会同时发生。假设患者在疾病类别方面是独立同分布（i.i.d.）地入组，令 $\\mathbf{p} = (p_{1}, \\dots, p_{K})$ 表示类别概率的（未知）向量，其中 $\\sum_{k=1}^{K} p_{k} = 1$ 且对于所有 $k$ 都有 $p_{k} \\in (0,1)$。\n\n根据概率论的基本原理（概率公理以及互斥和完备事件的定义），对于 $n$ 个独立患者的计数向量 $\\mathbf{X} = (X_{1}, \\dots, X_{K})$，可以使用一个经过充分检验的、适用于总和受约束为 $n$ 的多变量计数的分布来进行建模。请明确地构建此模型，并利用似然原理和约束优化，根据观测到的计数推导出每个 $p_{k}$ 的最大似然估计（MLE）。\n\n将您的推导应用于以下来自 $n = 320$ 名患者的数据，这些患者被分为 $K = 5$ 个类别：\n- 传染病：$X_{1} = 124$\n- 心血管疾病：$X_{2} = 89$\n- 呼吸系统疾病：$X_{3} = 57$\n- 肿瘤：$X_{4} = 38$\n- 其他诊断：$X_{5} = 12$\n\n将最终估计的概率表示为保留四位有效数字的小数，并按 $(p_{1}, p_{2}, p_{3}, p_{4}, p_{5})$ 的顺序排列，对应于上面列出的类别。",
            "solution": "问题陈述被评估为有效。它在科学上基于概率论和统计推断的原理，特别是关于分类数据分析，这是生物统计学的一个核心课题。该问题提法恰当，提供了所有必要的数据和明确的目标：推导并应用多项分布参数的最大似然估计。所提供的数据是自洽的，因为计数总和 $124 + 89 + 57 + 38 + 12 = 320$ 等于患者总数 $n$。该问题是客观的，没有歧义。\n\n问题描述了将 $n$ 个独立患者分入 $K$ 个互斥且完备的类别之一的过程。这是一个典型的多项式实验设置。\n令 $\\mathbf{X} = (X_1, X_2, \\dots, X_K)$ 为 $K$ 个类别中每个类别的计数的随机向量，其中 $\\sum_{k=1}^{K} X_k = n$。\n令 $\\mathbf{p} = (p_1, p_2, \\dots, p_K)$ 为单个患者落入每个类别的概率向量，其中对于所有 $k$ 都有 $p_k > 0$ 且 $\\sum_{k=1}^{K} p_k = 1$。\n\n由于患者是独立同分布（i.i.d.）地入组，计数向量 $\\mathbf{X}$ 服从多项分布。观测到特定计数向量 $\\mathbf{x} = (x_1, x_2, \\dots, x_K)$ 的概率质量函数（PMF）由以下公式给出：\n$$ P(\\mathbf{X} = \\mathbf{x} | \\mathbf{p}) = \\frac{n!}{x_1! x_2! \\dots x_K!} \\prod_{k=1}^{K} p_k^{x_k} $$\n其中 $\\sum_{k=1}^{K} x_k = n$。\n\n$\\mathbf{p}$ 的最大似然估计（MLE）是使似然函数 $L(\\mathbf{p} | \\mathbf{x})$ 最大化的 $\\mathbf{p}$ 值，该函数在数值上等同于 PMF，但在固定观测数据 $\\mathbf{x}$ 的情况下被视为参数 $\\mathbf{p}$ 的函数。\n$$ L(\\mathbf{p}; \\mathbf{x}) = \\frac{n!}{\\prod_{k=1}^{K} x_k!} \\prod_{k=1}^{K} p_k^{x_k} $$\n为简化最大化过程，我们使用对数似然函数 $\\ell(\\mathbf{p}; \\mathbf{x}) = \\ln(L(\\mathbf{p}; \\mathbf{x}))$。最大化对数似然等同于最大化似然，因为对数是单调递增函数。\n$$ \\ell(\\mathbf{p}; \\mathbf{x}) = \\ln\\left(\\frac{n!}{\\prod_{k=1}^{K} x_k!}\\right) + \\ln\\left(\\prod_{k=1}^{K} p_k^{x_k}\\right) = \\ln(C) + \\sum_{k=1}^{K} x_k \\ln(p_k) $$\n其中 $C$ 是多项式系数，它是一个关于 $\\mathbf{p}$ 的常数。\n\n我们必须在概率总和为一的约束条件下最大化 $\\ell(\\mathbf{p}; \\mathbf{x})$：$g(\\mathbf{p}) = \\sum_{k=1}^{K} p_k - 1 = 0$。这是一个约束优化问题，可以使用拉格朗日乘数法求解。拉格朗日函数 $\\mathcal{L}(\\mathbf{p}, \\lambda)$ 是：\n$$ \\mathcal{L}(\\mathbf{p}, \\lambda) = \\ell(\\mathbf{p}; \\mathbf{x}) - \\lambda g(\\mathbf{p}) = \\left( \\ln(C) + \\sum_{k=1}^{K} x_k \\ln(p_k) \\right) - \\lambda \\left(\\sum_{k=1}^{K} p_k - 1\\right) $$\n为找到临界点，我们对 $\\mathcal{L}$ 分别求关于每个 $p_j$（对于 $j = 1, \\dots, K$）和拉格朗日乘数 $\\lambda$ 的偏导数，并令它们为零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_j} = \\frac{x_j}{p_j} - \\lambda = 0 $$\n这得到 $x_j = \\lambda p_j$，或 $p_j = \\frac{x_j}{\\lambda}$，对于每个 $j = 1, \\dots, K$。\n\n关于 $\\lambda$ 的偏导数恢复了约束条件：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left(\\sum_{k=1}^{K} p_k - 1\\right) = 0 \\implies \\sum_{k=1}^{K} p_k = 1 $$\n现在，我们将表达式 $p_k = x_k/\\lambda$ 代入约束方程中：\n$$ \\sum_{k=1}^{K} \\frac{x_k}{\\lambda} = 1 $$\n$$ \\frac{1}{\\lambda} \\sum_{k=1}^{K} x_k = 1 $$\n已知观测总数为 $n = \\sum_{k=1}^{K} x_k$，我们求出乘数 $\\lambda$ 的值：\n$$ \\frac{n}{\\lambda} = 1 \\implies \\lambda = n $$\n将 $\\lambda$ 的这个值代回 $p_j$ 的表达式中，我们得到最大似然估计量 $\\hat{p}_j$：\n$$ \\hat{p}_j = \\frac{x_j}{n} $$\n因此，每个类别概率的 MLE 是其样本比例。\n\n现在，我们将此结果应用于给定数据：\n患者总数，$n = 320$。\n类别数，$K = 5$。\n观测计数：\n- 传染病：$x_1 = 124$\n- 心血管疾病：$x_2 = 89$\n- 呼吸系统疾病：$x_3 = 57$\n- 肿瘤：$x_4 = 38$\n- 其他诊断：$x_5 = 12$\n\n我们计算估计概率 $\\hat{p}_k = x_k/n$ 并四舍五入到四位有效数字：\n- $\\hat{p}_1 = \\frac{124}{320} = 0.3875$。此值为精确值，且已有四位有效数字。\n- $\\hat{p}_2 = \\frac{89}{320} = 0.278125$。四舍五入到四位有效数字为 $0.2781$。\n- $\\hat{p}_3 = \\frac{57}{320} = 0.178125$。四舍五入到四位有效数字为 $0.1781$。\n- $\\hat{p}_4 = \\frac{38}{320} = 0.11875$。四舍五入到四位有效数字为 $0.1188$。\n- $\\hat{p}_5 = \\frac{12}{320} = 0.0375$。为了表示为四位有效数字，我们添加尾随零：$0.03750$。\n\n最终的估计概率向量为 $(\\hat{p}_1, \\hat{p}_2, \\hat{p}_3, \\hat{p}_4, \\hat{p}_5)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.3875 & 0.2781 & 0.1781 & 0.1188 & 0.03750 \\end{pmatrix}}\n$$"
        }
    ]
}