{
    "hands_on_practices": [
        {
            "introduction": "这个问题提出了一个动态的瓮模型，其中瓮的成分在每一步都会发生变化。通过应用全概率定律，我们可以系统地追踪这些变化，并计算未来某一步结果的概率。这个练习  非常有助于培养将多阶段随机过程分解为可管理的条件概率的技能，这在模拟疾病传播或生态系统动态等随时间演变的过程中非常重要。",
            "id": "785232",
            "problem": "一个基于瓮模型的概率过程定义如下：\n1.  初始时，在步骤 $k=0$ 时，一个瓮中包含一个红球和一个黑球。\n2.  在每个步骤 $k=1, 2, 3, \\dots$ 时，从瓮中随机抽取一个球。\n3.  记下抽出球的颜色，然后将该球放回瓮中。\n4.  然后将一个与抽出球颜色*相反*的球加入瓮中。瓮中球的总数在每个步骤增加一个。\n\n计算第三次从瓮中抽出的球（在步骤 $k=3$ 时）是红色的确切概率。",
            "solution": "设 $r_k$ 和 $b_k$ 分别表示第 $k$ 次抽球前红球和黑球的数量。初始时，在步骤 $k=0$ 时，我们有 $r_0=1, b_0=1$。\n\n**步骤 1：**\n第一次抽球的概率为：\n$$P(c_1=R) = \\frac{r_0}{r_0+b_0} = \\frac{1}{2}, \\quad P(c_1=B) = \\frac{1}{2}$$\n如果 $c_1=R$，那么瓮的成分变为 $(r_1,b_1)=(1,2)$。\n如果 $c_1=B$，那么瓮的成分变为 $(r_1,b_1)=(2,1)$。\n\n**步骤 2：**\n我们根据第一次抽球的结果来计算第二次抽球的概率：\n-   **情况 1** (如果 $c_1=R$，概率为 $1/2$)：瓮中有 (1,2) 个球。\n    $$P(c_2=R|c_1=R) = \\frac{1}{3}, \\quad P(c_2=B|c_1=R) = \\frac{2}{3}$$\n    如果 $c_2=R$，瓮的成分变为 $(r_2,b_2)=(1,3)$。如果 $c_2=B$，成分变为 $(2,2)$。\n-   **情况 2** (如果 $c_1=B$，概率为 $1/2$)：瓮中有 (2,1) 个球。\n    $$P(c_2=R|c_1=B) = \\frac{2}{3}, \\quad P(c_2=B|c_1=B) = \\frac{1}{3}$$\n    如果 $c_2=R$，瓮的成分变为 $(r_2,b_2)=(2,2)$。如果 $c_2=B$，成分变为 $(3,1)$。\n\n在步骤3开始时，有四种可能的状态，对应于前两次抽球的路径：\n1.  路径 $RR$: 概率 $P(c_1=R, c_2=R) = \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{6}$，瓮成分 $(r_2,b_2)=(1,3)$。\n2.  路径 $RB$: 概率 $P(c_1=R, c_2=B) = \\frac{1}{2} \\cdot \\frac{2}{3} = \\frac{1}{3}$，瓮成分 $(r_2,b_2)=(2,2)$。\n3.  路径 $BR$: 概率 $P(c_1=B, c_2=R) = \\frac{1}{2} \\cdot \\frac{2}{3} = \\frac{1}{3}$，瓮成分 $(r_2,b_2)=(2,2)$。\n4.  路径 $BB$: 概率 $P(c_1=B, c_2=B) = \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{6}$，瓮成分 $(r_2,b_2)=(3,1)$。\n\n**步骤 3：**\n我们使用全概率定律，根据前两步形成的四种可能路径来计算第三次抽到红球的概率 $P(c_3=R)$。总球数为 $r_2+b_2=4$。\n$$P(c_3=R) = \\sum_{\\text{路径 } xy} P(c_3=R | \\text{路径 } xy) P(\\text{路径 } xy)$$\n$$P(c_3=R) = P(c_3=R|c_1=R,c_2=R)P(c_1=R,c_2=R) + \\dots$$\n$$\\begin{aligned}\nP(c_3=R) &= \\left(\\frac{1}{4}\\right) \\cdot P(RR) + \\left(\\frac{2}{4}\\right) \\cdot P(RB) + \\left(\\frac{2}{4}\\right) \\cdot P(BR) + \\left(\\frac{3}{4}\\right) \\cdot P(BB) \\\\\n&= \\frac{1}{4} \\cdot \\frac{1}{6} + \\frac{2}{4} \\cdot \\frac{1}{3} + \\frac{2}{4} \\cdot \\frac{1}{3} + \\frac{3}{4} \\cdot \\frac{1}{6} \\\\\n&= \\frac{1}{24} + \\frac{2}{12} + \\frac{2}{12} + \\frac{3}{24} \\\\\n&= \\frac{1}{24} + \\frac{4}{24} + \\frac{4}{24} + \\frac{3}{24} = \\frac{1+4+4+3}{24} = \\frac{12}{24} = \\frac{1}{2}\n\\end{aligned}$$",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "下一个练习探讨了一种情景，其中我们过程的一个基本参数——在这里是随机游走中向右移动的概率 $p$——本身就是一个随机变量。全概率定律提供了一个强大的框架，通过对该参数所有可能的值进行“平均”，来求得一个事件的总体概率。这项技术  在生物统计学中至关重要，例如，在考虑不同个体对治疗有不同反应概率时，它可以用来计算群体的平均治疗效果。",
            "id": "785313",
            "problem": "一个粒子从一维整数格点上的原点 $x=0$ 出发。首先进行一个实验，掷一个均匀的六面骰子。设这次投掷的结果为整数 $D \\in \\{1, 2, 3, 4, 5, 6\\}$。之后，该粒子进行三次独立的移动。对于每一步，向右移动一个单位（即从 $x$ 到 $x+1$）的概率为 $p = D/c$，向左移动一个单位（即从 $x$ 到 $x-1$）的概率为 $q = 1-p$，其中 $c=6$ 是骰子的面数。\n\n计算经过这三次移动后，粒子位于位置 $x=+1$ 的总概率。",
            "solution": "1.  **定义单步概率**\n    对于给定的骰子结果 $D$，向右和向左移动的概率分别为：\n    $$p=\\frac{D}{c}, \\qquad q=1-p=\\frac{c-D}{c}$$\n    其中 $c=6$。\n\n2.  **计算给定 $D$ 时的条件概率**\n    经过三步后，要使净位移为 $+1$，粒子需要恰好两次向右移动和一次向左移动。这种情况的次数由二项式系数 $\\binom{3}{2}=3$ 给出。对于一个固定的 $D$ (因此固定的 $p$)，该事件的概率为：\n    $$P(\\text{位置}=+1 \\mid D) = \\binom{3}{2}p^2q = 3p^2(1-p) = 3\\left(\\frac{D}{c}\\right)^2\\left(\\frac{c-D}{c}\\right) = 3\\frac{D^2(c-D)}{c^3}$$\n\n3.  **应用全概率定律**\n    由于骰子是均匀的，$D$ 取 $\\{1, \\dots, c\\}$ 中每个值的概率都是 $1/c$。我们对所有可能的 $D$ 值进行平均，得到总概率 $P_{\\text{tot}}$：\n    $$P_{\\text{tot}} = \\sum_{D=1}^{c} P(\\text{位置}=+1 \\mid D) P(D) = \\sum_{D=1}^{c} \\left(3\\frac{D^2(c-D)}{c^3}\\right) \\frac{1}{c} = \\frac{3}{c^4}\\sum_{D=1}^{c}D^2(c-D)$$\n\n4.  **计算和式**\n    我们使用标准求和公式来计算和式：\n    $$\\begin{aligned}\n    \\sum_{D=1}^c D^2(c-D) &= c\\sum_{D=1}^c D^2 - \\sum_{D=1}^c D^3 \\\\\n    &= c\\left(\\frac{c(c+1)(2c+1)}{6}\\right) - \\left(\\frac{c(c+1)}{2}\\right)^2 \\\\\n    &= \\frac{c^2(c+1)(2c+1)}{6} - \\frac{c^2(c+1)^2}{4} \\\\\n    &= \\frac{c^2(c+1)}{12} \\left[ 2(2c+1) - 3(c+1) \\right] \\\\\n    &= \\frac{c^2(c+1)(c-1)}{12} = \\frac{c^2(c^2-1)}{12}\n    \\end{aligned}$$\n\n5.  **代回结果**\n    将和式的结果代回到总概率的表达式中：\n    $$P_{\\text{tot}} = \\frac{3}{c^4} \\cdot \\frac{c^2(c^2-1)}{12} = \\frac{c^2-1}{4c^2}$$\n\n6.  **代入 $c=6$**\n    最后，将 $c=6$ 代入，得到最终数值：\n    $$P_{\\text{tot}} = \\frac{6^2-1}{4 \\cdot 6^2} = \\frac{35}{4 \\cdot 36} = \\frac{35}{144}$$",
            "answer": "$$\\boxed{\\frac{35}{144}}$$"
        },
        {
            "introduction": "我们的最后一个问题展示了全概率定律如何在更宏大的统计模型中充当关键的构建模块。在这里，我们首先用它来确定一次复杂试验中单次“成功”的总体概率，然后将这个概率作为二项分布模型的输入参数，以分析多次独立试验的结果。这个例子  突出了基础概念如何被整合起来以解决更复杂的生物统计学问题，例如在临床试验中，当患者群体由具有不同反应率的亚组组成时，评估总体成功次数的分布。",
            "id": "785303",
            "problem": "通过一系列 $n$ 次独立的实验（或称试验）来研究一个量子系统。在每次试验开始时，系统被随机初始化为两种构型 $C_1$ 或 $C_2$ 中的一种。任何一次给定试验的初始化都与所有其他试验无关。构型 $C_1$ 被选中的概率为 $\\alpha$，构型 $C_2$ 被选中的概率为 $1-\\alpha$。\n\n初始化后，系统可能跃迁到一个特定的目标态 $A$。这个跃迁取决于其初始构型：\n- 在构型 $C_1$ 中初始化的系统，跃迁到状态 $A$ 的概率为 $p_1$。\n- 在构型 $C_2$ 中初始化的系统，跃迁到状态 $A$ 的概率为 $p_2$。\n\n如果系统跃迁到状态 $A$，则该次试验被记录为“成功”。否则，该次试验为“失败”。\n\n推导在 $n$ 次试验中观察到恰好 $k$ 次成功的概率，记为 $P(k; n)$。最终表达式应以 $n, k, \\alpha, p_1$ 和 $p_2$ 的形式表示。",
            "solution": "我们首先根据全概率定律计算单次试验中成功的概率，记为 $r$。我们将事件空间划分为系统初始化为构型 $C_1$ 和 $C_2$ 两种情况：\n$$r = P(\\text{success}) = P(\\text{success}\\mid C_1)P(C_1) + P(\\text{success}\\mid C_2)P(C_2)$$\n$$r = p_1 \\alpha + p_2 (1-\\alpha)$$\n\n由于这 $n$ 次试验是独立的，且每次试验的成功概率均为 $r$，因此成功次数 $k$ 服从参数为 $n$ 和 $r$ 的二项分布。其概率质量函数为：\n$$P(k;n) = \\binom{n}{k}r^k(1-r)^{n-k}$$\n\n将 $r$ 的表达式代回，我们得到最终的概率 $P(k;n)$：\n$$P(k;n) = \\binom{n}{k}(\\alpha p_1 + (1-\\alpha)p_2)^k \\bigl(1-(\\alpha p_1 + (1-\\alpha)p_2)\\bigr)^{n-k}$$",
            "answer": "$$\\boxed{\\binom{n}{k}(\\alpha p_1+(1-\\alpha)p_2)^k\\bigl(1-(\\alpha p_1+(1-\\alpha)p_2)\\bigr)^{n-k}}$$"
        }
    ]
}