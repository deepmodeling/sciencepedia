{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的巩固方式就是亲手实践。这项练习将引导你计算流行病学中的三个核心指标：发病率、累积发病率和患病率。通过解决这个基于一个假设稳定人群的场景问题，你将能够清晰地辨别作为“流量”的发病和作为“存量”的患病之间的区别，并理解它们在特定稳态条件下是如何关联的。",
            "id": "4393149",
            "problem": "一个城市的卫生部门正在监测一个稳定城市人口中的一种非传染性疾病。在$1$年的时间跨度内，在最初有$10{,}000$人的风险人群中，新确诊了$50$例病例。在同一年中，由于交错进入和失访，所有风险个体的累计总观察时间为$5{,}000$人年。历史数据和临床病程表明，在进入和退出流量恒定的稳态条件下，发病率和平均病程随时间大致保持不变，且该疾病在人群中相对罕见。从发病到结局（通过康复或死亡）的平均病程为$4$年。\n\n仅使用公共卫生测量的基本定义，计算：\n- 年发病率，\n- $1$年累积发病率，\n- 以及在所述的稳态和罕见病条件下，由所提供的平均病程所隐含的时点患病率。\n\n将发病率以病例/人年表示，并将累积发病率和患病率表示为无单位的小数（而非百分比）。将所求的三个量均四舍五入至四位有效数字。按所列顺序提供这三个结果。",
            "solution": "首先将验证该问题，以确保其在科学上是合理的、提法得当且是完整的。\n\n### 第1步：提取已知条件\n问题陈述中提供了以下数据和条件：\n- 观察时间跨度：$1$年\n- 新确诊病例数：$I = 50$\n- 初始风险人群：$N_0 = 10,000$\n- 累计总观察时间：$PT = 5,000$人年\n- 平均病程：$D = 4$年\n- 条件：\n    - 稳定城市人口\n    - 非传染性疾病\n    - 稳态（恒定的发病率和平均病程）\n    - 人群中的罕见病\n\n### 第2步：使用提取的已知条件进行验证\n根据所需标准对问题进行评估。\n- **科学依据**：该问题基于流行病学和公共卫生的基本标准定义，包括发病率（发病密度）、累积发病率（风险）和患病率。在稳态和罕见病假设下，这些量之间的关系是该领域的一个核心概念。所有概念在事实上和科学上都是合理的。\n- **提法得当**：该问题提法得当。它提供了计算所求三个量所需的所有数值和明确条件。问题无歧义，并有唯一、稳定的解。\n- **客观性**：该问题使用客观、定量的语言陈述，避免了任何主观或推测性的主张。\n- **完整性和一致性**：该问题是自洽的。所提供的数据是一致的。例如，对于一个$10,000$人的初始人群，在$1$年内总观察时间为$5,000$人年是合理的，因为这意味着每人的平均随访时间为$0.5$年，这可以由交错进入、失访或目标事件（诊断）的发生来解释，在事件发生后，该个体就不再是“风险”人群。\n\n### 第3步：结论与行动\n该问题被认为是**有效的**，因为它在科学上是合理的、提法得当、客观且内部一致。现在将推导解答。\n\n### 解答推导\n所求的三个量——发病率、$1$年累积发病率和时点患病率——将根据其在公共卫生中的标准定义按顺序计算。\n\n**1. 发病率 ($IR$)**\n\n发病率，也称为发病密度，衡量在特定时期内人群中新病例发生的速率，相对于人群被观察和处于风险中的总时间。其公式为：\n$$\nIR = \\frac{\\text{新病例数}}{\\text{总风险人时}}\n$$\n问题提供了新病例数 $I = 50$ 和总风险人时 $PT = 5,000$ 人年。\n\n代入给定值：\n$$\nIR = \\frac{50}{5,000} \\text{ 年}^{-1} = 0.01 \\text{ 年}^{-1}\n$$\n问题要求该值以病例/人年为单位，这等同于时间倒数的单位（例如，年$^{-1}$）。四舍五入到四位有效数字，我们得到：\n$$\nIR = 0.01000 \\text{ 病例/人年}\n$$\n\n**2. $1$年累积发病率 ($CI$)**\n\n累积发病率，也称为风险，是在指定时间间隔内，初始风险人群中发生该疾病的比例。它是针对一个固定队列计算的。其公式为：\n$$\nCI = \\frac{\\text{时期内的新病例数}}{\\text{时期开始时风险人群中的个体数}}\n$$\n问题提供了$1$年期间的新病例数 $I = 50$ 和初始风险人群的规模 $N_0 = 10,000$。\n\n代入给定值：\n$$\nCI = \\frac{50}{10,000} = 0.005\n$$\n这个量是一个无单位的比例。四舍五入到四位有效数字，我们得到：\n$$\nCI = 0.005000\n$$\n\n**3. 时点患病率 ($P$)**\n\n患病率是在特定时间点患有某种疾病的人群比例。问题陈述了稳态条件适用，发病率恒定，且该疾病罕见。在这些特定假设下，患病率($P$)、发病率($IR$)和平均病程($D$)之间存在一个基本关系：\n$$\nP \\approx IR \\times D\n$$\n这个近似关系成立是因为，在稳态下，新病例加入患病人群库的速率必须等于他们被移除（由于康复或死亡）的速率。新病例的速率是 $IR \\times N_{\\text{总人口}}$，而移除的速率是 $\\frac{\\text{患病病例数}}{D} = \\frac{P \\times N_{\\text{总人口}}}{D}$。令两者相等可得 $IR \\approx \\frac{P}{D}$。\n\n使用之前计算的发病率 ($IR = 0.01 \\text{ 年}^{-1}$) 和给定的平均病程 ($D = 4$ 年)：\n$$\nP \\approx (0.01 \\text{ 年}^{-1}) \\times (4 \\text{ 年}) = 0.04\n$$\n患病率是一个无单位的比例。四舍五入到四位有效数字，我们得到：\n$$\nP = 0.04000\n$$\n\n计算出的三个量，四舍五入到四位有效数字，是：\n- 发病率：$0.01000$\n- $1$年累积发病率：$0.005000$\n- 时点患病率：$0.04000$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01000  0.005000  0.04000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了基本定义之后，让我们来看一个更接近真实研究的场景。这项练习将我们从宏观的人群数据带入一个小型队列研究，你需要根据个体随访时间来计算总的人时数，并估算发病率。更重要的是，本练习引入了统计不确定性的概念，你将学习如何为发病率估算一个置信区间，这突显出我们的点估计值并非绝对精确，而是存在一个合理的波动范围。",
            "id": "4547023",
            "problem": "一项预防医学领域的前瞻性队列研究招募了四名参与者，以基于风险人时来量化作为发病率的疾病发生情况。每位参与者从队列入组开始被随访，直至其首次事件发生或删失为止，得到的随访时间分别为 $1.2$、$0.8$、$2.0$ 和 $0.5$ 年。在这些随访期间，共观察到 $3$ 次首次事件。假设首次事件的发生是一个与稀有事件的泊松模型相符的计数过程，并且发病率定义为每单位风险人时的预期首次事件数。使用这些数据：\n- 计算发病率的点估计值，单位为“事件/人-年”。\n- 计算 $95\\%$ 的泊松精确置信区间（首次事件率/人-年），该区间通过反演基于观察到的总人时内的总事件数的泊松计数模型得到。\n\n以“事件/人-年”为单位报告您的最终数值结果，并将所有三个值（点估计值、置信下限和置信上限）四舍五入至四位有效数字。将这三个数字按 $(\\text{点估计值}, \\text{下限}, \\text{上限})$ 的顺序以单行向量的形式呈现。最终答案中不使用百分号；所有量均以小数形式表示。",
            "solution": "### 步骤1：提取已知信息\n- 参与者人数：$4$\n- 个体随访时间：$1.2$ 年、$0.8$ 年、$2.0$ 年、$0.5$ 年。\n- 观察到的首次事件总数，$d$：$3$。\n- 统计模型：泊松过程。\n- 区间置信水平：$95\\%$。\n- 要求四舍五入：四位有效数字。\n- 要求输出格式：一个包含（点估计值，下限，上限）的行向量。\n\n### 步骤2：使用提取的已知信息进行验证\n该问题具有科学依据，提法明确且客观。它描述了根据队列研究数据计算发病率及其置信区间的标准流行病学方法。在这种情况下，使用人时和泊松模型是标准做法。所有必要的数据都已提供，且没有矛盾之处。该问题不违反任何无效性标准。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解决方案。\n\n### 解答\n\n该问题要求计算发病率的点估计值和一个 $95\\%$ 的精确置信区间。\n\n#### 第1部分：发病率的点估计\n\n发病率，记为 $\\lambda$，定义为每单位风险人时内的新发事件数。点估计值 $\\hat{\\lambda}$ 的计算方法是：观察到的事件总数 $d$ 除以总风险人时 $PT$。\n\n首先，我们通过将所有参与者的随访时间相加来计算总风险人时：\n$$\nPT = 1.2 \\text{ years} + 0.8 \\text{ years} + 2.0 \\text{ years} + 0.5 \\text{ years}\n$$\n$$\nPT = 4.5 \\text{ person-years}\n$$\n\n观察到的事件数给定为 $d = 3$。\n\n那么，发病率的点估计值为：\n$$\n\\hat{\\lambda} = \\frac{d}{PT} = \\frac{3}{4.5} = \\frac{2}{3} \\text{ events per person-year}\n$$\n将其转换为小数，我们得到：\n$$\n\\hat{\\lambda} \\approx 0.666666... \\text{ events per person-year}\n$$\n\n#### 第2部分：发病率的95%精确置信区间\n\n问题指明事件数遵循泊松分布。事件总数 $d=3$ 是来自均值为 $\\mu$ 的泊松分布的单个观测值。均值 $\\mu$ 通过方程 $\\mu = \\lambda \\times PT$ 与发病率 $\\lambda$ 和总人时 $PT$ 相关联。\n\n为了找到率 $\\lambda$ 的置信区间，我们首先计算均值计数 $\\mu$ 的置信区间，然后将其上下限除以 $PT$。\n\n给定观测计数 $d$ 时，泊松均值 $\\mu$ 的精确置信区间基于泊松分布和卡方（$\\chi^2$）分布之间的关系。对于一个 $(1-\\alpha) \\times 100\\%$ 的置信区间，均值 $\\mu$ 的下限 $\\mu_L$ 和上限 $\\mu_U$ 由以下公式给出：\n$$\n\\mu_L = \\frac{1}{2} \\chi^2_{\\alpha/2, 2d}\n$$\n$$\n\\mu_U = \\frac{1}{2} \\chi^2_{1-\\alpha/2, 2(d+1)}\n$$\n其中 $\\chi^2_{p, \\nu}$ 是自由度为 $\\nu$、累积概率为 $p$ 的卡方分布的分位数。\n\n对于 $95\\%$ 的置信区间，$1-\\alpha = 0.95$，因此 $\\alpha = 0.05$ 且 $\\alpha/2 = 0.025$。\n观察到的事件数为 $d=3$。\n\n下限的自由度为 $2d = 2 \\times 3 = 6$。\n上限的自由度为 $2(d+1) = 2 \\times (3+1) = 8$。\n\n我们需要以下卡方分位数：\n- 对于下限：$\\chi^2_{\\alpha/2, 2d} = \\chi^2_{0.025, 6}$\n- 对于上限：$\\chi^2_{1-\\alpha/2, 2(d+1)} = \\chi^2_{0.975, 8}$\n\n使用统计表或软件，我们找到这些值：\n$$\n\\chi^2_{0.025, 6} \\approx 1.237344\n$$\n$$\n\\chi^2_{0.975, 8} \\approx 17.534546\n$$\n\n现在，我们可以计算均值计数 $\\mu$ 的置信限：\n$$\n\\mu_L = \\frac{1}{2} \\times 1.237344 = 0.618672\n$$\n$$\n\\mu_U = \\frac{1}{2} \\times 17.534546 = 8.767273\n$$\n这些是在 $4.5$ 人-年内预期事件数的下限和上限。\n\n为了找到发病率 $\\lambda$ 的置信区间，我们将这些限值除以总人时 $PT = 4.5$ 人-年。\n$$\n\\lambda_L = \\frac{\\mu_L}{PT} = \\frac{0.618672}{4.5} \\approx 0.1374827 \\text{ events per person-year}\n$$\n$$\n\\lambda_U = \\frac{\\mu_U}{PT} = \\frac{8.767273}{4.5} \\approx 1.9482829 \\text{ events per person-year}\n$$\n\n#### 第3部分：最终结果与四舍五入\n\n问题要求将点估计值、下限和上限四舍五入到四位有效数字。\n\n- 点估计：$\\hat{\\lambda} \\approx 0.666666... \\to 0.6667$\n- 置信下限：$\\lambda_L \\approx 0.1374827... \\to 0.1375$\n- 置信上限：$\\lambda_U \\approx 1.9482829... \\to 1.948$\n\n最终结果是有序三元组 $(\\hat{\\lambda}, \\lambda_L, \\lambda_U)$。\n这三个值为 $(0.6667, 0.1375, 1.948)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.6667  0.1375  1.948\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在现实世界中，我们的测量工具（如诊断检验）并非完美无缺，这给疾病频率的估算带来了挑战。这项练习聚焦于患病率的估算，并探讨了诊断测试的灵敏度（$Se$）和特异度（$Sp$）如何影响我们观察到的结果。通过本练习，你将学会如何从数学上校正“表观患病率”以估算出更接近真实的“真实患病率”，这是解读筛查项目和横断面调查数据时一项至关重要的技能。",
            "id": "4546935",
            "problem": "一项对有限总体的横断面调查使用单一的二元诊断试验来估计疾病患病率。该试验具有已知的灵敏度 $\\mathrm{Se}$ 和特异度 $\\mathrm{Sp}$，其中灵敏度定义为 $\\mathrm{Se} = \\mathbb{P}(\\text{检验阳性}\\mid \\text{患病})$，特异度定义为 $\\mathrm{Sp} = \\mathbb{P}(\\text{检验阴性}\\mid \\text{未患病})$。令观测（表观）患病率为阳性检验结果的样本比例，记为 $P^{\\ast}$。考虑一项对 $n$ 个个体的调查，其中 $n = 2000$ 且有 $Y = 240$ 个个体检验结果为阳性，因此 $P^{\\ast} = Y/n = 0.12$。该试验的 $\\mathrm{Se} = 0.90$，$\\mathrm{Sp} = 0.98$。\n\n仅从上述基本定义和应用于 $\\mathbb{P}(\\text{检验阳性})$ 的全概率定律出发，推导出一个以 $P^{\\ast}$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 表示的源人群校正（真实）患病率的估计量，并根据给定数据计算其数值。然后，在假设 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 是无误差的已知常数，且唯一的抽样变异性源于 $Y \\sim \\mathrm{Binomial}(n, \\mathbb{P}(\\text{检验阳性}))$ 的前提下，使用 $\\mathrm{Var}(P^{\\ast})$ 的大样本近似和 delta 方法，得到您的校正患病率估计量方差的近似表达式，并根据给定数据进行数值计算。\n\n以小数形式报告校正后的患病率，并四舍五入到四位有效数字。不要以百分比形式报告。您可以科学记数法表示方差，四舍五入到两位有效数字，但只有校正后的患病率将作为最终数值答案进行评分。",
            "solution": "首先对问题进行验证检查。\n\n### 步骤1：提取已知条件\n- 调查类型：对有限总体的横断面调查。\n- 诊断试验：单一二元试验。\n- 灵敏度：$\\mathrm{Se} = \\mathbb{P}(\\text{检验阳性}\\mid \\text{患病})$。\n- 特异度：$\\mathrm{Sp} = \\mathbb{P}(\\text{检验阴性}\\mid \\text{未患病})$。\n- 观测（表观）患病率：$P^{\\ast} = Y/n$，阳性检验结果的样本比例。\n- 样本量：$n = 2000$。\n- 阳性检验数：$Y = 240$。\n- 计算出的表观患病率：$P^{\\ast} = Y/n = 0.12$。\n- 灵敏度数值：$\\mathrm{Se} = 0.90$。\n- 特异度数值：$\\mathrm{Sp} = 0.98$。\n- 任务1：推导出一个以 $P^{\\ast}$、$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 表示的校正（真实）患病率 $P$ 的估计量，并计算其数值。\n- 任务2：推导校正患病率估计量方差的近似表达式，并进行数值计算。\n- 方差计算的假设：$\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 是无误差的已知常数；$Y \\sim \\mathrm{Binomial}(n, \\mathbb{P}(\\text{检验阳性}))$。\n- 方差计算方法：$\\mathrm{Var}(P^{\\ast})$ 的大样本近似；delta 方法。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是流行病学和生物统计学中的一个标准练习。患病率、灵敏度、特异度、Rogan-Gladen 估计量、计数数据的二项分布以及用于方差近似的 delta 方法等概念，都是这些领域中基本且广泛使用的原则。\n- **问题适定**：问题陈述清晰，提供了推导所需估计量和计算其值所必需的所有数据和假设。存在一个唯一、稳定且有意义的解。\n- **客观性**：问题采用精确、定量和无偏见的语言进行阐述。\n\n该问题没有表现出任何科学上不健全、信息缺失或模棱两可等缺陷。这是一个在应用统计学中定义明确且可解的问题。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。现在开始求解过程。\n\n令 $P$ 表示人群中该疾病的真实患病率，定义为 $P = \\mathbb{P}(\\text{患病})$。目标是找到 $P$ 的一个估计量，我们将其记为 $\\hat{P}$。\n\n个体检验结果为阳性的概率 $\\mathbb{P}(\\text{检验阳性})$，可以根据真实患病状况，使用全概率定律表示：\n$$\n\\mathbb{P}(\\text{检验阳性}) = \\mathbb{P}(\\text{检验阳性}\\mid \\text{患病})\\mathbb{P}(\\text{患病}) + \\mathbb{P}(\\text{检验阳性}\\mid \\text{未患病})\\mathbb{P}(\\text{未患病})\n$$\n我们已知灵敏度的定义 $\\mathrm{Se} = \\mathbb{P}(\\text{检验阳性}\\mid \\text{患病})$ 和特异度的定义 $\\mathrm{Sp} = \\mathbb{P}(\\text{检验阴性}\\mid \\text{未患病})$。假阳性概率为 $\\mathbb{P}(\\text{检验阳性}\\mid \\text{未患病}) = 1 - \\mathbb{P}(\\text{检验阴性}\\mid \\text{未患病}) = 1 - \\mathrm{Sp}$。未患病的概率为 $\\mathbb{P}(\\text{未患病}) = 1 - P$。\n\n将这些项代入全概率定律方程可得：\n$$\n\\mathbb{P}(\\text{检验阳性}) = (\\mathrm{Se})(P) + (1 - \\mathrm{Sp})(1 - P)\n$$\n观测到的表观患病率 $P^{\\ast}$ 是阳性检验的样本比例 $Y/n$。它是总体参数 $\\mathbb{P}(\\text{检验阳性})$ 的一个自然估计量。通过矩估计法，我们可以用 $P^{\\ast}$ 替换 $\\mathbb{P}(\\text{检验阳性})$，用其估计量 $\\hat{P}$ 替换 $P$，来构造 $P$ 的估计量：\n$$\nP^{\\ast} = (\\mathrm{Se})(\\hat{P}) + (1 - \\mathrm{Sp})(1 - \\hat{P})\n$$\n现在我们求解这个方程以得到 $\\hat{P}$：\n$$\nP^{\\ast} = \\mathrm{Se} \\cdot \\hat{P} + 1 - \\mathrm{Sp} - \\hat{P} + \\mathrm{Sp} \\cdot \\hat{P}\n$$\n$$\nP^{\\ast} - (1 - \\mathrm{Sp}) = \\hat{P}(\\mathrm{Se} + \\mathrm{Sp} - 1)\n$$\n$$\n\\hat{P} = \\frac{P^{\\ast} + \\mathrm{Sp} - 1}{\\mathrm{Se} + \\mathrm{Sp} - 1}\n$$\n这就是推导出的校正（真实）患病率的估计量。\n\n接下来，我们使用给定的数据计算 $\\hat{P}$ 的数值：$P^{\\ast} = 0.12$，$\\mathrm{Se} = 0.90$，$\\mathrm{Sp} = 0.98$。\n$$\n\\hat{P} = \\frac{0.12 + 0.98 - 1}{0.90 + 0.98 - 1} = \\frac{0.10}{0.88} = \\frac{10}{88} = \\frac{5}{44}\n$$\n数值上，$\\hat{P} \\approx 0.113636...$。四舍五入到四位有效数字，校正后的患病率为 $0.1136$。\n\n现在，我们推导 $\\hat{P}$ 方差的近似表达式。估计量 $\\hat{P}$ 是随机变量 $P^{\\ast}$ 的一个函数，我们可以写成 $\\hat{P} = g(P^{\\ast})$。该函数为：\n$$\ng(P^{\\ast}) = \\frac{P^{\\ast} + \\mathrm{Sp} - 1}{\\mathrm{Se} + \\mathrm{Sp} - 1}\n$$\n由于 $\\mathrm{Se}$ 和 $\\mathrm{Sp}$ 被视为已知常数， $g(P^{\\ast})$ 对 $P^{\\ast}$ 的导数为：\n$$\ng'(P^{\\ast}) = \\frac{d}{dP^{\\ast}}\\left(\\frac{P^{\\ast} + \\mathrm{Sp} - 1}{\\mathrm{Se} + \\mathrm{Sp} - 1}\\right) = \\frac{1}{\\mathrm{Se} + \\mathrm{Sp} - 1}\n$$\ndelta 方法为随机变量的函数的方差提供了一个大样本近似：$\\mathrm{Var}(g(P^{\\ast})) \\approx [g'(\\mathbb{E}[P^{\\ast}])]^2 \\mathrm{Var}(P^{\\ast})$。假设 $Y \\sim \\mathrm{Binomial}(n, \\pi)$，其中 $\\pi = \\mathbb{P}(\\text{检验阳性})$，那么 $P^{\\ast} = Y/n$ 的方差为 $\\mathrm{Var}(P^{\\ast}) = \\frac{\\pi(1-\\pi)}{n}$。该方差的一个相合估计量是 $\\widehat{\\mathrm{Var}}(P^{\\ast}) = \\frac{P^{\\ast}(1-P^{\\ast})}{n}$。\n\n综合这些结果，$\\hat{P}$ 的近似方差估计为：\n$$\n\\widehat{\\mathrm{Var}}(\\hat{P}) \\approx \\left(\\frac{1}{\\mathrm{Se} + \\mathrm{Sp} - 1}\\right)^2 \\widehat{\\mathrm{Var}}(P^{\\ast}) = \\frac{P^{\\ast}(1-P^{\\ast})}{n(\\mathrm{Se} + \\mathrm{Sp} - 1)^2}\n$$\n这就是推导出的校正患病率估计量近似方差的表达式。\n\n最后，我们使用给定的数据对该表达式进行数值计算：$P^{\\ast}=0.12$，$n=2000$，$\\mathrm{Se}=0.90$ 和 $\\mathrm{Sp}=0.98$。\n$$\n\\widehat{\\mathrm{Var}}(\\hat{P}) \\approx \\frac{0.12(1-0.12)}{2000(0.90+0.98-1)^2} = \\frac{0.12(0.88)}{2000(0.88)^2}\n$$\n$$\n\\widehat{\\mathrm{Var}}(\\hat{P}) \\approx \\frac{0.12}{2000 \\times 0.88} = \\frac{0.12}{1760} \\approx 0.00006818...\n$$\n用科学记数法表示并四舍五入到两位有效数字，方差为 $6.8 \\times 10^{-5}$。\n\n所要求的最终答案是校正后的患病率，四舍五入到四位有效数字。\n校正患病率 $\\hat{P} = 0.1136$。",
            "answer": "$$\n\\boxed{0.1136}\n$$"
        }
    ]
}