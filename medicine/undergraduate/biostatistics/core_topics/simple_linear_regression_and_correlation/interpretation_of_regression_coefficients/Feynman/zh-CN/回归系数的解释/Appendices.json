{
    "hands_on_practices": [
        {
            "introduction": "理解回归系数是掌握回归分析的核心。这个练习将我们带回到最基本的简单线性回归模型，要求我们解释斜率和截距的实际意义。通过计算不同钠摄入量水平下预期血压的差异，我们可以具体地体会到斜率系数$ \\hat{\\beta}_1 $如何量化预测变量每单位变化对结果变量的平均影响。",
            "id": "4804683",
            "problem": "一项针对成人门诊患者的队列研究调查了每日钠摄入量与收缩压之间的关系，其中结局变量是以毫米汞柱（mm Hg）为单位测量的收缩压，而暴露是每日钠摄入量，单位为克。假设总体机制满足经典简单线性回归条件，即给定钠摄入量时，收缩压的条件均值是摄入量的线性函数，且给定摄入量时，残差的均值为零。对收缩压关于钠摄入量进行简单线性回归，得到拟合系数 $\\hat{\\beta}_{0}=110$ 和 $\\hat{\\beta}_{1}=2.5$。在该队列中，观测到的每日钠摄入量范围在 $1$ 克到 $6$ 克之间。\n\n基于条件期望和线性回归模型的基本定义，请根据指定摄入量下的期望收缩压，对截距 $\\hat{\\beta}_{0}$ 和斜率 $\\hat{\\beta}_{1}$ 给出精确解释。然后，仅使用这些定义，推导出钠摄入量分别为 $x_{1}=2$ 克和 $x_{2}=5$ 克的个体之间平均收缩压的期望差异的表达式，并计算其数值。将最终的期望差异以毫米汞柱（mm Hg）表示。不要四舍五入；报告精确值。",
            "solution": "我们从经典假设下的简单线性回归模型的核心定义开始：存在一个表示形式\n$$\nY=\\beta_{0}+\\beta_{1}X+\\varepsilon,\n$$\n其中 $Y$ 是收缩压，$X$ 是每日钠摄入量，误差项 $\\varepsilon$ 满足 $\\mathbb{E}[\\varepsilon \\mid X]=0$ 且具有有限方差。由此，可得出条件期望的基本性质：\n$$\n\\mathbb{E}[Y \\mid X=x]=\\beta_{0}+\\beta_{1}x.\n$$\n在此模型下，对系数的解释基于条件均值函数。\n\n截距 $\\hat{\\beta}_{0}$ 的解释：截距对应于当 $X=0$ 时 $Y$ 的期望值。具体来说，为了进行解释，用其估计量替换总体参数，得到\n$$\n\\widehat{\\mathbb{E}}[Y \\mid X=0]=\\hat{\\beta}_{0}.\n$$\n因此，$\\hat{\\beta}_{0}=110$ 被解释为每日钠摄入量为 $0$ 克的个体，其收缩压的估计平均值，单位为毫米汞柱。需要认识到 $0$ 克超出了观测范围，因此该解释涉及外推。\n\n斜率 $\\hat{\\beta}_{1}$ 的解释：斜率是 $X$ 每增加一个单位，$Y$ 的条件均值的边际变化。形式上，对于任意 $x$ 和增量 $\\Delta$，\n$$\n\\mathbb{E}[Y \\mid X=x+\\Delta]-\\mathbb{E}[Y \\mid X=x]=\\beta_{1}\\Delta.\n$$\n使用估计量，$\\hat{\\beta}_{1}=2.5$ 被解释为，在模型内保持其他所有条件不变的情况下，每日钠摄入量每增加一克，平均收缩压估计增加 $2.5$ 毫米汞柱。\n\n为了计算钠摄入量为 $x_{2}=5$ 克和 $x_{1}=2$ 克时平均收缩压的期望差异，我们使用条件均值的线性性质：\n$$\n\\Delta_{5-2}=\\widehat{\\mathbb{E}}[Y \\mid X=5]-\\widehat{\\mathbb{E}}[Y \\mid X=2] = \\left(\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 5\\right)-\\left(\\hat{\\beta}_{0}+\\hat{\\beta}_{1}\\cdot 2\\right).\n$$\n截距 $\\hat{\\beta}_{0}$ 被消掉，得到\n$$\n\\Delta_{5-2}=\\hat{\\beta}_{1}(5-2).\n$$\n代入 $\\hat{\\beta}_{1}=2.5$，\n$$\n\\Delta_{5-2}=2.5 \\times 3=7.5.\n$$\n因此，每日摄入 $5$ 克钠与每日摄入 $2$ 克钠的个体之间，平均收缩压的期望差异为 $7.5$ 毫米汞柱。此计算仅依赖于将斜率解释为暴露每单位变化引起的条件均值的变化，并且不需要超出观测范围进行外推，因为 $2$ 克和 $5$ 克都位于观测到的摄入量范围内。",
            "answer": "$$\\boxed{7.5}$$"
        },
        {
            "introduction": "在现实世界的生物统计学研究中，变量之间的关系很少是孤立的。这个练习引入了一个关键概念——混杂，即第三个变量（年龄）同时与我们关心的预测变量（钠摄入量）和结果（血压）相关。通过比较调整和未调整的斜率，我们将揭示忽略混杂因素如何导致对效应的错误估计，这也就是所谓的遗漏变量偏误。",
            "id": "4804684",
            "problem": "考虑一项针对无心血管疾病史成年人的大型观察性队列研究，旨在估计每日钠摄入量与收缩压之间的关联。令 $Y$ 表示以 $\\text{mm Hg}$ 为单位的收缩压，令 $X$ 表示以 $\\text{grams}$ 为单位的每日钠摄入量，令 $Z$ 表示以 $\\text{years}$ 为单位的年龄。假设以下总体水平的数据生成过程和联合分布成立：结果变量服从线性结构模型 $Y=\\beta_{0}+\\beta_{X}X+\\beta_{Z}Z+\\varepsilon$，其中 $\\mathbb{E}[\\varepsilon\\mid X,Z]=0$；并且 $(X,Z)$ 服从二元正态分布，其均值分别为 $\\mu_{X}=3.5$ 和 $\\mu_{Z}=55$，标准差分别为 $\\sigma_{X}=1.2$ 和 $\\sigma_{Z}=12$，相关系数为 $\\rho_{XZ}=0.25$。假设真实的调整后关联为 $\\beta_{X}=0.3$（可解释为每克钠 $\\text{mm Hg}$）和 $\\beta_{Z}=0.2$（可解释为每岁 $\\text{mm Hg}$）。假设研究样本量足够大，以至于 $Y$ 对 $X$ 的简单线性回归和 $Y$ 对 $(X,Z)$ 的多元线性回归能一致地估计它们各自的总体斜率。\n\n计算 $Y$ 对 $X$ 的未调整总体斜率（来自 $Y$ 对 $X$ 的简单回归）与对 $X$ 的调整后总体斜率（来自 $Y$ 对 $(X,Z)$ 的多元回归）之间的数值差异 $\\Delta$。最终答案以每克钠 $\\text{mm Hg}$ 为单位表示。无需四舍五入。用一句话，在此医学背景下，就年龄造成的混杂来解释 $\\Delta$ 的符号，但最终答案只提供数值。",
            "solution": "问题要求计算收缩压 ($Y$) 对钠摄入量 ($X$) 的未调整总体斜率与控制了年龄 ($Z$) 后的相应调整总体斜率之间的数值差异 $\\Delta$。\n\n真实的数据生成过程由以下多元线性回归模型给出：\n$$Y = \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\varepsilon$$\n其中 $\\mathbb{E}[\\varepsilon \\mid X, Z] = 0$。在此模型中，系数 $\\beta_X$ 代表了控制了 $Z$ 之后，$Y$ 对 $X$ 的调整后总体斜率。问题陈述该值为 $\\beta_X = 0.3$。因此，我们有：\n$$\\beta_{YX}^{\\text{adj}} = \\beta_X = 0.3$$\n\n$Y$ 对 $X$ 的未调整总体斜率，记为 $\\beta_{YX}^{\\text{unadj}}$，是 $Y$ 仅对 $X$ 进行简单线性回归所得的系数。该总体斜率的公式由 $X$ 和 $Y$ 的协方差与 $X$ 的方差之比给出：\n$$\\beta_{YX}^{\\text{unadj}} = \\frac{\\text{Cov}(X, Y)}{\\text{Var}(X)}$$\n\n为了计算 $\\text{Cov}(X, Y)$，我们使用 $Y$ 的真实结构方程：\n$$\\text{Cov}(X, Y) = \\text{Cov}(X, \\beta_{0} + \\beta_{X}X + \\beta_{Z}Z + \\varepsilon)$$\n使用协方差的性质，上式可展开为：\n$$\\text{Cov}(X, Y) = \\text{Cov}(X, \\beta_{0}) + \\text{Cov}(X, \\beta_{X}X) + \\text{Cov}(X, \\beta_{Z}Z) + \\text{Cov}(X, \\varepsilon)$$\n$$\\text{Cov}(X, Y) = 0 + \\beta_{X}\\text{Cov}(X, X) + \\beta_{Z}\\text{Cov}(X, Z) + \\text{Cov}(X, \\varepsilon)$$\n由于 $\\text{Cov}(X, X) = \\text{Var}(X)$ 并且条件 $\\mathbb{E}[\\varepsilon \\mid X, Z] = 0$ 意味着 $\\varepsilon$ 与 $X$ 和 $Z$ 的任何函数（包括 $X$ 本身）都不相关，因此我们有 $\\text{Cov}(X, \\varepsilon) = 0$。该表达式简化为：\n$$\\text{Cov}(X, Y) = \\beta_{X}\\text{Var}(X) + \\beta_{Z}\\text{Cov}(X, Z)$$\n\n现在我们将此表达式代回未调整斜率的公式中：\n$$\\beta_{YX}^{\\text{unadj}} = \\frac{\\beta_{X}\\text{Var}(X) + \\beta_{Z}\\text{Cov}(X, Z)}{\\text{Var}(X)} = \\beta_{X} + \\beta_{Z} \\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$$\n项 $\\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$ 是遗漏变量 $Z$ 对包含变量 $X$ 的简单线性回归的总体斜率。我们将此斜率记为 $\\beta_{ZX}$。因此：\n$$\\beta_{YX}^{\\text{unadj}} = \\beta_{X} + \\beta_{Z}\\beta_{ZX}$$\n\n问题要求计算差异 $\\Delta = \\beta_{YX}^{\\text{unadj}} - \\beta_{YX}^{\\text{adj}}$。代入上述表达式：\n$$\\Delta = (\\beta_{X} + \\beta_{Z}\\beta_{ZX}) - \\beta_{X} = \\beta_{Z}\\beta_{ZX}$$\n这就是众所周知的遗漏变量偏误公式。该偏误是遗漏变量 ($Z$) 对结果变量 ($Y$) 的影响（即 $\\beta_Z$）与遗漏变量 ($Z$) 和包含变量 ($X$) 之间的关联（即 $\\beta_{ZX}$）的乘积。\n\n我们需要计算 $\\beta_{ZX} = \\frac{\\text{Cov}(X, Z)}{\\text{Var}(X)}$。我们已知相关系数 $\\rho_{XZ}$ 以及标准差 $\\sigma_X$ 和 $\\sigma_Z$。协方差可以表示为 $\\text{Cov}(X, Z) = \\rho_{XZ}\\sigma_X\\sigma_Z$。方差为 $\\text{Var}(X) = \\sigma_X^2$。\n因此，斜率 $\\beta_{ZX}$ 为：\n$$\\beta_{ZX} = \\frac{\\rho_{XZ}\\sigma_X\\sigma_Z}{\\sigma_X^2} = \\rho_{XZ}\\frac{\\sigma_Z}{\\sigma_X}$$\n\n现在我们可以计算 $\\Delta$ 的值：\n$$\\Delta = \\beta_{Z} \\left( \\rho_{XZ}\\frac{\\sigma_Z}{\\sigma_X} \\right)$$\n问题提供了以下数值：\n$\\beta_Z = 0.2$\n$\\rho_{XZ} = 0.25$\n$\\sigma_Z = 12$\n$\\sigma_X = 1.2$\n\n将这些数值代入 $\\Delta$ 的表达式中：\n$$\\Delta = 0.2 \\times \\left( 0.25 \\times \\frac{12}{1.2} \\right)$$\n$$\\Delta = 0.2 \\times (0.25 \\times 10)$$\n$$\\Delta = 0.2 \\times 2.5$$\n$$\\Delta = 0.5$$\n\n数值差异为 $0.5 \\, \\text{mm Hg/克钠}$。$\\Delta$ 的正号表示存在正向混杂，即未调整的关联高估了钠对血压的真实效应，因为混杂因素“年龄”与钠摄入量（$\\rho_{XZ} > 0$）和血压（$\\beta_Z > 0$）都呈正相关。",
            "answer": "$$\\boxed{0.5}$$"
        },
        {
            "introduction": "回归模型可以变得更加精妙，以捕捉变量间更复杂的关系。本练习探讨了效应修饰（或交互作用）的概念，即一个变量（诊断后时间）对结果（糖化血红蛋白）的影响，会因另一个变量（药物依从性）水平的不同而改变。通过计算在不同依从性水平下的时间斜率，你将学会如何解释交互项，从而能够构建更符合现实临床情景的细致模型。",
            "id": "4804658",
            "problem": "一项针对新诊断为2型糖尿病成年人的纵向队列研究，随时间追踪每位参与者的糖化血红蛋白A1c（HbA1c）水平。设 $Y$ 表示HbA1c（单位：百分点），$X$ 表示诊断后的时间（单位：月），$Z$ 表示以0–10量表衡量的药物依从性，其中数值越高表示依从性越好。研究人员拟合了一个包含时间与依从性之间交互作用的线性回归模型，使用以下条件均值模型\n$$\n\\mathbb{E}[Y \\mid X,Z] = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ,\n$$\n其中 $\\beta_{0}$ 是截距，$\\beta_{1}$ 是时间的主效应，$\\beta_{2}$ 是依从性的主效应，$\\beta_{3}$ 捕捉了依从性对时间效应的修饰作用。假设与时间相关的参数的估计系数为 $\\hat{\\beta}_{1} = 0.10$ 和 $\\hat{\\beta}_{3} = -0.02$。 \n\n从条件均值模型和将变化率定义为偏导数的基本定义出发，推导在固定依从性水平 $Z$ 下，HbA1c相对于时间变化的斜率表达式。然后，使用给定的估计值计算当 $Z = 2$ 和 $Z = 8$ 时的斜率。将您的最终数值答案以每月HbA1c百分点的单位表示，并四舍五入到四位有效数字。",
            "solution": "该问题要求在给定一个线性回归的条件均值模型的情况下，推导糖化血红蛋白A1c (HbA1c) 相对于时间的变化率（斜率）。这个变化率在数学上等同于结果变量 $Y$ 的条件期望对时间变量 $X$ 的偏导数。\n\n给定的条件均值模型是：\n$$\n\\mathbb{E}[Y \\mid X,Z] = \\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ\n$$\n其中 $Y$ 是HbA1c（单位：百分点），$X$ 是时间（单位：月），$Z$ 是药物依从性（0到10的量表）。系数 $\\beta_{0}$、$\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 是模型的参数。\n\n在固定的依从性水平 $Z$ 下，HbA1c相对于时间变化的斜率是条件均值 $\\mathbb{E}[Y \\mid X,Z]$ 对 $X$ 的偏导数。这衡量了在保持依从性不变的情况下，当时间增加一个单位时，平均HbA1c的预期变化量。\n$$\n\\text{时间相关的斜率} = \\frac{\\partial}{\\partial X} \\mathbb{E}[Y \\mid X,Z]\n$$\n我们对模型的每一项应用偏导数算子，由于求导是相对于 $X$ 进行的，同时保持 $Z$ 固定，因此将 $Z$ 视为常数。\n$$\n\\frac{\\partial}{\\partial X} (\\beta_{0} + \\beta_{1} X + \\beta_{2} Z + \\beta_{3} XZ) = \\frac{\\partial}{\\partial X}(\\beta_{0}) + \\frac{\\partial}{\\partial X}(\\beta_{1} X) + \\frac{\\partial}{\\partial X}(\\beta_{2} Z) + \\frac{\\partial}{\\partial X}(\\beta_{3} XZ)\n$$\n各个偏导数分别为：\n1.  截距 $\\beta_{0}$ 对 $X$ 的导数为 $0$，因为 $\\beta_{0}$ 是一个常数。\n2.  $\\beta_{1} X$ 对 $X$ 的导数为 $\\beta_{1}$。\n3.  $\\beta_{2} Z$ 对 $X$ 的导数为 $0$，因为在这种情况下 $\\beta_{2}$ 和 $Z$ 都被视为常数。\n4.  $\\beta_{3} XZ$ 对 $X$ 的导数为 $\\beta_{3} Z$，因为 $\\beta_{3} Z$ 是 $X$ 的常数系数。\n\n将这些结果相加，得到斜率的一般表达式：\n$$\n\\frac{\\partial}{\\partial X} \\mathbb{E}[Y \\mid X,Z] = 0 + \\beta_{1} + 0 + \\beta_{3} Z = \\beta_{1} + \\beta_{3} Z\n$$\n这个推导出的表达式表明，时间对平均HbA1c的影响不是恒定的，而是依从性水平 $Z$ 的一个线性函数。这就是交互项 $\\beta_{3} XZ$ 的含义。\n\n问题提供了相关系数的估计值：$\\hat{\\beta}_{1} = 0.10$ 和 $\\hat{\\beta}_{3} = -0.02$。我们将这些估计值代入我们推导出的斜率表达式中，得到估计斜率，我们将其表示为 $\\widehat{\\text{Slope}}(Z)$：\n$$\n\\widehat{\\text{Slope}}(Z) = \\hat{\\beta}_{1} + \\hat{\\beta}_{3} Z = 0.10 + (-0.02) Z = 0.10 - 0.02 Z\n$$\n该斜率的单位是 $Y$ 的单位除以 $X$ 的单位，即每月HbA1c百分点。\n\n题目要求我们计算在两个特定的依从性水平下的斜率：$Z=2$ 和 $Z=8$。\n\n对于依从性水平 $Z = 2$：\n$$\n\\widehat{\\text{Slope}}(Z=2) = 0.10 - 0.02 \\times 2 = 0.10 - 0.04 = 0.06\n$$\n这意味着对于一个依从性得分为2的低依从性患者，其估计的平均HbA1c每月增加0.06个百分点。\n\n对于依从性水平 $Z = 8$：\n$$\n\\widehat{\\text{Slope}}(Z=8) = 0.10 - 0.02 \\times 8 = 0.10 - 0.16 = -0.06\n$$\n这意味着对于一个依从性得分为8的高依从性患者，其估计的平均HbA1c每月减少0.06个百分点。\n\n问题要求最终数值答案四舍五入到四位有效数字。\n- 对于 $Z=2$，值为 $0.06$。保留四位有效数字，写作 $0.06000$。\n- 对于 $Z=8$，值为 $-0.06$。保留四位有效数字，写作 $-0.06000$。\n\n最终答案分别为在 $Z=2$ 和 $Z=8$ 时计算出的斜率。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.06000 & -0.06000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}