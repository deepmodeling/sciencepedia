{
    "hands_on_practices": [
        {
            "introduction": "在线性回归中，一个核心问题是评估模型对数据变异的解释能力。决定系数 $R^2$ 是衡量这种拟合优度的关键指标，它量化了由回归模型解释的响应变量总变异的比例。通过这个练习，你将直接从方差分析（ANOVA）表中的平方和（Sum of Squares）计算 $R^2$，从而巩固对这一基本概念的理解。",
            "id": "1895447",
            "problem": "一位农业科学家正在研究添加到土壤中的特定营养补充剂的量（单位：克）与一种新开发植物物种的后续高度（单位：厘米）之间的关系。对收集到的数据拟合了一个简单线性回归模型。为了评估模型的拟合优度，进行了方差分析（ANOVA）。分析得出回归平方和（SSR）为 90.0 cm$^2$，总平方和（SST）为 120.0 cm$^2$。\n\n计算该线性回归模型的决定系数，记为 $R^2$。将答案表示为小数值。",
            "solution": "线性回归的决定系数定义为总变异中可由回归解释的比例：\n$$\nR^{2}=\\frac{\\text{SSR}}{\\text{SST}}.\n$$\n已知 $\\text{SSR}=90.0$ 且 $\\text{SST}=120.0$，代入公式：\n$$\nR^{2}=\\frac{90.0}{120.0}=\\frac{9}{12}=\\frac{3}{4}=0.75.\n$$\n因此，决定系数为 $0.75$。",
            "answer": "$$\\boxed{0.75}$$"
        },
        {
            "introduction": "现实世界中的生物学关系很少是简单相加的，一个变量的影响通常取决于另一个变量的水平。在线性模型中引入交互项，可以捕捉这种复杂的、非加性的效应，但这也会改变主效应系数的解释。本练习将指导你分析一个包含交互项的回归模型，并计算在特定条件下变量的边际效应，这对于在生物统计学研究中准确解释模型至关重要。",
            "id": "4919994",
            "problem": "一项临床试验研究了一种降脂药物对以毫克/分升 (mg/dL) 为单位测量的低密度脂蛋白胆固醇 (LDL-C) 的影响。设结局变量为空腹LDL-C水平，记为 $Y$。考虑了两个预测变量：一个是药物分配的二元指示变量 $X_{1}$（如果患者接受了药物治疗，则 $X_{1}=1$，否则 $X_{1}=0$），另一个是年龄（以年为单位），记为 $X_{2}$。为了让药物的效果随年龄变化，模型中包含了一个 $X_{1}$ 和 $X_{2}$ 之间的交互项。条件均值函数的普通最小二乘法 (OLS) 估计为\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\beta_{0} + \\beta_{1} X_{1} + \\beta_{2} X_{2} + \\beta_{3} X_{1} X_{2},\n$$\n其拟合系数为 $\\beta_{0} = 160$，$\\beta_{1} = -30$，$\\beta_{2} = 0.6$，以及 $\\beta_{3} = 0.2$。\n\n从线性模型中条件均值的定义和交互项的含义出发，解释包含乘积项 $X_{1} X_{2}$ 如何改变主效应系数 $\\beta_{1}$ 和 $\\beta_{2}$ 的解释，相较于省略交互项的模型。然后，使用上述拟合系数，计算在 $X_{2} = 60$ 时，$X_{1}$ 对预期LDL-C的边际效应，该边际效应定义为当 $X_{1}$ 增加一个单位而保持 $X_{2}$ 固定时，$\\mathbb{E}[Y \\mid X_{1}, X_{2}]$ 的变化。用 mg/dL 表示你的数值答案，并将答案四舍五入到四位有效数字。",
            "solution": "为了理解交互项 $X_{1}X_{2}$ 如何改变主效应系数 $\\beta_1$ 和 $\\beta_2$ 的解释，我们首先考虑一个不含此项的加性模型：\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\alpha_{0} + \\alpha_{1} X_{1} + \\alpha_{2} X_{2}\n$$\n在此模型中，$\\alpha_1$ 表示在保持 $X_2$ 不变的情况下，$X_1$ 从0变为1时 $Y$ 均值的恒定差异。\n\n现在，我们回到带交互项的模型：\n$$\n\\mathbb{E}[Y \\mid X_{1}, X_{2}] = \\beta_{0} + \\beta_{1} X_{1} + \\beta_{2} X_{2} + \\beta_{3} X_{1} X_{2}\n$$\n包含乘积项 $X_1X_2$ 意味着每个预测变量对结局变量的影响取决于另一个预测变量的水平。\n\n**$\\beta_1$的解释：**\n药物的“效应”，即患者接受药物治疗（$X_1$ 从0变为1）时预期LDL-C的变化，是通过计算条件期望的差异来计算的：\n$$\n\\text{药物效应} = \\mathbb{E}[Y \\mid X_1=1, X_2] - \\mathbb{E}[Y \\mid X_1=0, X_2]\n$$\n$$\n= (\\beta_0 + \\beta_1 + \\beta_2 X_2 + \\beta_3 X_2) - (\\beta_0 + \\beta_2 X_2) = \\beta_1 + \\beta_3 X_2\n$$\n与加性模型中效应是恒定的不同，这里药物的效应是年龄 $X_2$ 的函数。系数 $\\beta_1$ 不再是药物的总体主效应，而是表示在 $X_2=0$ 的特定条件下药物的效应。\n\n**$\\beta_2$的解释：**\n年龄（$X_2$）每增加一个单位对预期LDL-C的效应可以通过求条件均值函数关于 $X_2$ 的偏导数得到：\n$$\n\\frac{\\partial}{\\partial X_2} \\mathbb{E}[Y \\mid X_1, X_2] = \\beta_2 + \\beta_3 X_1\n$$\n年龄的效应取决于用药状态 $X_1$。\n- 对于对照组（$X_1=0$），年龄增加一岁的效应是 $\\beta_2$。\n- 对于用药组（$X_1=1$），年龄增加一岁的效应是 $\\beta_2 + \\beta_3$。\n\n因此，系数 $\\beta_2$ 仅表示在对照组（$X_1=0$）中，年龄增加一岁对LDL-C的特定效应。\n\n**计算边际效应：**\n我们计算在 $X_2 = 60$ 时，$X_1$ 对预期LDL-C的边际效应。我们已经推导出 $X_1$ 的边际效应为：\n$$\n\\text{边际效应} = \\beta_1 + \\beta_3 X_2\n$$\n代入拟合系数 $\\beta_1 = -30$ 和 $\\beta_3 = 0.2$：\n$$\n\\text{在 } X_2=60 \\text{ 时的边际效应} = -30 + (0.2)(60)\n$$\n$$\n= -30 + 12\n$$\n$$\n= -18\n$$\n这意味着对于一个60岁的患者，与不接受药物治疗相比，接受药物治疗与LDL-C平均降低18 mg/dL相关。问题要求答案四舍五入到四位有效数字，因此，$-18$应表示为$-18.00$。",
            "answer": "$$\n\\boxed{-18.00}\n$$"
        },
        {
            "introduction": "拟合回归模型仅仅是分析过程的第一步，接下来必须进行诊断检查，以识别可能对模型结果产生不当影响的异常观测值。区分“好的”高杠杆点和由测量误差导致的“坏的”离群值，需要结合统计诊断和科学判断。这个案例研究提供了一个真实场景，让你学习如何基于数据完整性和生理学合理性，对异常数据点做出有原则的决策。",
            "id": "4920003",
            "problem": "一个生物统计学团队在一项样本量为 $n=120$ 的社区研究中，将非糖尿病成年人的空腹血糖（以 $Y$ 表示，单位为毫克/分升）建模为年龄（以 $X$ 表示，单位为年）的线性函数。该团队拟合了普通最小二乘法 (OLS) 简单线性回归模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，并使用标准诊断方法来评估异常或强影响观测值。有两个观测值引起了关注：\n\n1. 受试者 A 的数据为 $X=92$ 和 $Y=95$。对受试者 A 的诊断显示杠杆值 $h_{ii}=0.30$，学生化残差 $r_i=0.4$，库克距离 $D_i=0.08$。该受试者 92 岁的年龄在研究的目标人群范围内，并且重复检查确认测量程序被正确遵循。拟合模型在 $X=92$ 处的点预测值为 98，与观测到的 $Y$ 值接近。\n\n2. 受试者 B 的数据为 $X=34$ 和 $Y=540$。对受试者 B 的诊断显示杠杆值 $h_{ii}=0.10$，学生化残差 $r_i=5.2$，库克距离 $D_i=1.1$。对于非糖尿病者的空腹测量值，实验室参考资料表明，在没有与研究纳入标准不符的急性病理情况下，高于 400 毫克/分升的数值在生理上是不合理的。一份实验室审核报告指出，该样本严重溶血，并且分析仪针对此标本触发了校准标志。\n\n基于线性回归的基本原理和科学严谨的离群值评估方法，哪个选项最恰当地区分了 $X$ 中的离群值和 $Y \\mid X$ 中的离群值，并为可能的排除设定了有原则的行动方案？\n\nA. 立即排除两名受试者，因为诊断结果表明他们都是强影响点。\n\nB. 在确认测量有效性和科学合理性后，保留受试者 A；对于受试者 B，调查数据来源，考虑生理合理性和记录在案的测量误差，如果测量误差得到证实或该值对于目标人群来说不合理，则排除受试者 B；否则，通过在包含和不包含受试者 B 的情况下重新拟合模型来进行敏感性分析，并报告其影响。\n\nC. 排除任何具有高杠杆值 $h_{ii}$ 的观测值，无论其残差或合理性如何，因为高杠杆值总是会使斜率估计产生偏差。\n\nD. 保留两个观测值，并收集更多数据，直到它们的影响变得可以忽略不计；排除观测值永远没有正当理由，因为它可能引入偏差。",
            "solution": "处理异常观测值的核心原则是，统计诊断是用于识别问题的工具，而非自动排除的规则。排除数据点的决定必须基于模型之外的证据，例如数据完整性或科学合理性。\n\n**对受试者 A 的分析：**\n- **统计诊断**: 该观测值具有高杠杆值 ($h_{ii}=0.30$)，表明其$X$值（年龄92岁）远离数据平均值，是一个在自变量空间中的离群点。然而，其学生化残差很小($r_i=0.4$)，意味着该数据点紧靠回归线。库克距离($D_i=0.08$)不大，表明其对模型的影响有限。\n- **科学背景**: 92岁是目标人群中的合理年龄，且测量有效性已得到确认。\n- **结论**: 这是一个“好的”高杠杆点。它是来自目标人群的真实、有效观测值。这样的数据点不仅不应被排除，反而有助于提高回归系数估计的精度。\n\n**对受试者 B 的分析：**\n- **统计诊断**: 该观测值具有极大的学生化残差($r_i=5.2$)，是一个在给定年龄下，$Y$值方向的极端离群值。其库克距离非常大($D_i=1.1$)，超过了常用的影响阈值1，表明它是一个强影响点，会显著改变回归模型的结果。\n- **科学背景**: 540 mg/dL的空腹血糖对于非糖尿病者在生理上是不合理的。更重要的是，存在已记录的测量误差（样本严重溶血和分析仪校准标志）。\n- **结论**: 该数据点不是对真实生物关系的有效反映，而是一个被污染的测量值。统计诊断正确地识别了问题，而外部证据证实了这是一个“坏”数据点。为了避免模型被错误信息带偏，应当将其排除。\n\n**评估选项：**\n- **A. 立即排除两名受试者...** 这是不正确的。机械地排除所有影响点是错误的做法，受试者 A 是一个有价值的数据点。\n- **B. 在确认测量有效性和...保留受试者 A...排除受试者 B...** 这是正确的。该选项描述了正确的科学流程：保留经过验证的有效数据点（A），并基于外部证据（测量误差、生理不合理性）排除已证实为无效的数据点（B）。如果B的证据不确定，进行敏感性分析也是正确的备选方案。\n- **C. 排除任何具有高杠杆值...** 这是不正确的。高杠杆点不一定有害，如受试者 A 的例子所示，它们可能是模型精度的来源。\n- **D. 保留两个观测值...** 这是不正确的。虽然随意排除数据会引入偏差，但故意保留已证实为错误的数据点（如受试者B）同样会使模型产生偏差。移除可证明无效的数据是减少偏差的必要步骤。\n\n因此，选项B是最恰当的行动方案。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}