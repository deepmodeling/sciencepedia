{
    "hands_on_practices": [
        {
            "introduction": "决定系数 $R^2$ 是评估回归模型的基石，但它根本上代表了什么？第一个练习旨在探索简单线性回归中 $R^2$ 与皮尔逊相关系数之间的深刻联系。通过思考一个预测变量和响应变量角色互换的场景，您将发现 $R^2$ 的一个关键对称性质，这有助于阐明其作为衡量线性关联强弱指标的角色，而不受因果方向的影响。",
            "id": "1955424",
            "problem": "一位材料科学家正在研究一种新型聚合物粘合剂的性能。对于一批 $n$ 个样本，测量了两个变量：固化时间 $T$（单位为小时）和产生的剪切强度 $S$（单位为兆帕斯卡，MPa）。假设在这些样本中，测得的固化时间和剪切强度都存在一定的变异，因此它们的样本方差不为零。\n\n对该数据集进行了两种不同的分析。\n\n分析 1：拟合一个简单线性回归模型，使用固化时间 ($T$) 作为预测变量来预测剪切强度 ($S$)。该模型形式为 $S = \\beta_0 + \\beta_1 T + \\epsilon$。计算该模型的决定系数，并记为 $R^2_{S|T}$。\n\n分析 2：对同一数据集拟合第二个简单线性回归模型，但这次是使用剪切强度 ($S$) 作为预测变量来预测固化时间 ($T$)。该模型形式为 $T = \\gamma_0 + \\gamma_1 S + \\delta$。计算该第二个模型的决定系数，并记为 $R^2_{T|S}$。\n\n分析 1 得到的 $R^2_{S|T}$ 值与分析 2 得到的 $R^2_{T|S}$ 值相比如何？\n\nA. $R^2_{S|T}$ 总是大于 $R^2_{T|S}$。\n\nB. $R^2_{S|T}$ 总是小于 $R^2_{T|S}$。\n\nC. $R^2_{S|T}$ 总是等于 $R^2_{T|S}$。\n\nD. 该关系取决于数据集中的具体数值，无法一概而论。\n\nE. 该关系取决于变量 $T$ 或 $S$ 中哪一个具有更大的样本方差。",
            "solution": "令 $(T_{i},S_{i})$（其中 $i=1,\\dots,n$）表示观测对，并假设 $\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2}>0$ 和 $\\sum_{i=1}^{n}(S_{i}-\\bar S)^{2}>0$。定义中心化和\n$$\nS_{TT}=\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2},\\quad\nS_{SS}=\\sum_{i=1}^{n}(S_{i}-\\bar S)^{2},\\quad\nS_{ST}=\\sum_{i=1}^{n}(S_{i}-\\bar S)(T_{i}-\\bar T).\n$$\n同样定义样本相关系数\n$$\nr_{ST}=\\frac{S_{ST}}{\\sqrt{S_{SS}S_{TT}}}.\n$$\n\n分析 1（$S$ 对 $T$ 进行回归）：普通最小二乘斜率为\n$$\n\\hat{\\beta}_{1}=\\frac{S_{ST}}{S_{TT}},\n$$\n拟合值为 $\\hat S_{i}=\\bar S+\\hat{\\beta}_{1}(T_{i}-\\bar T)$。解释平方和为\n$$\n\\mathrm{SSR}_{S|T}=\\sum_{i=1}^{n}(\\hat S_{i}-\\bar S)^{2}\n=\\hat{\\beta}_{1}^{2}\\sum_{i=1}^{n}(T_{i}-\\bar T)^{2}\n=\\hat{\\beta}_{1}^{2}S_{TT}.\n$$\n总平方和为 $\\mathrm{SST}_{S}=S_{SS}$。因此\n$$\nR^{2}_{S|T}=\\frac{\\mathrm{SSR}_{S|T}}{\\mathrm{SST}_{S}}\n=\\frac{\\hat{\\beta}_{1}^{2}S_{TT}}{S_{SS}}\n=\\frac{\\left(\\frac{S_{ST}}{S_{TT}}\\right)^{2}S_{TT}}{S_{SS}}\n=\\frac{S_{ST}^{2}}{S_{SS}S_{TT}}\n=r_{ST}^{2}.\n$$\n\n分析 2（$T$ 对 $S$ 进行回归）：斜率为\n$$\n\\hat{\\gamma}_{1}=\\frac{S_{ST}}{S_{SS}},\n$$\n解释平方和为\n$$\n\\mathrm{SSR}_{T|S}=\\hat{\\gamma}_{1}^{2}S_{SS}.\n$$\n$T$ 的总平方和为 $\\mathrm{SST}_{T}=S_{TT}$。所以\n$$\nR^{2}_{T|S}=\\frac{\\mathrm{SSR}_{T|S}}{\\mathrm{SST}_{T}}\n=\\frac{\\hat{\\gamma}_{1}^{2}S_{SS}}{S_{TT}}\n=\\frac{\\left(\\frac{S_{ST}}{S_{SS}}\\right)^{2}S_{SS}}{S_{TT}}\n=\\frac{S_{ST}^{2}}{S_{SS}S_{TT}}\n=r_{ST}^{2}.\n$$\n\n因此，两个 $R^{2}$ 值都等于 $S$ 和 $T$ 之间样本相关系数的平方，前提是两个变量的样本方差都不为零且模型包含截距项。所以\n$$\nR^{2}_{S|T}=R^{2}_{T|S}.\n$$\n这个等式关系不依赖于哪个变量的方差更大，也不依赖于除了非零方差条件之外的数据集的具体数值。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "虽然高 $R^2$ 值看起来很理想，但孤立地看它可能会产生误导。这个实践问题展示了模型诊断的一个关键原则：数字并不能说明全部问题。通过分析一个具有近乎完美的 $R^2$ 值，但其残差图却呈现出清晰、系统性模式的数据集，您将学会为何对残差进行可视化检查对于检测模型设定不当（例如隐藏的非线性关系）至关重要。",
            "id": "1455423",
            "problem": "一位本科生正在开发一种用于检测水中亚硝酸盐 ($\\text{NO}_2^−$) 的新型分析方法。该方法涉及一个化学反应，该反应会产生一种有色化合物，学生使用智能手机摄像头来量化颜色强度。为了创建校准曲线，学生制备了一系列已知亚硝酸盐浓度的标准溶液，并测量了相应的信号强度。收集到的数据如下：\n\n-   标准浓度 ($C$, 单位 $\\mu M$): 1.0, 5.0, 10.0, 15.0, 20.0\n-   测量信号 ($S$, 任意单位): 7.0, 14.5, 23.0, 30.5, 37.0\n\n对这些数据进行线性回归分析，得出最佳拟合线方程 $S = 1.57C + 5.61$，决定系数 $R^2 = 0.9996$。\n\n尽管 $R^2$ 值非常高，表明线性拟合效果极佳，但学生决定通过绘制残差图来更仔细地检查数据。残差计算为（测量信号 - 预测信号）。学生在残差中观察到一个明显的、非随机的模式：在最低和最高浓度下，残差略为负值，但在中间浓度下，残差明显为正值。\n\n根据所提供的所有信息，以下哪个陈述是关于该分析方法的最准确结论？\n\nA. 高 $R^2$ 值证实了线性模型是合适的，并且能准确预测未知浓度。残差中观察到的模式很可能是由随机实验误差引起的。\n\nB. 仪器存在恒定的系统误差，例如空白样品制备不当，这是导致非零残差的原因。\n\nC. 残差的模式表明浓度和信号之间的真实关系是非线性的。线性模型对于该系统是一个糟糕的选择，应该被舍弃。\n\nD. 残差中的系统性模式表明，虽然关系具有强线性，但并非完全线性。线性模型可能不是最准确的模型，而非线性模型（例如，二次模型）可能会提供更好的拟合度和更准确的结果。\n\nE. 学生很可能在制备具有最大残差的标准溶液时犯了重大错误，并且这一个点扭曲了原本完美的线性关系。",
            "solution": "设线性校准模型为 $S_{\\text{pred}}(C) = mC + b$，其中 $m = 1.57$，$b = 5.61$，这是通过回归分析得到的，决定系数 $R^{2} = 0.9996$。将浓度 $C$ 处的残差定义为\n$$\nr(C) = S_{\\text{meas}}(C) - S_{\\text{pred}}(C).\n$$\n观察到的残差模式是，在最低和最高的 $C$ 值处 $r(C)  0$，而在中间的 $C$ 值处 $r(C) > 0$。这种系统性的、非随机的模式意味着模型设定不当，而非随机误差。具体来说，符号的变化表明存在曲率：数据点在两端位于拟合线下方，在中间位于拟合线上方，这与一个向下凹的关系一致。一个二次模型，\n$$\nS(C) = a C^{2} + b C + c \\quad \\text{且} \\quad a  0,\n$$\n会自然地在中间范围产生 $S_{\\text{true}}(C) > S_{\\text{lin}}(C)$ 并在两端产生 $S_{\\text{true}}(C)  S_{\\text{lin}}(C)$，从而消除系统性的残差模式。\n\n一个恒定的系统误差（例如，不正确的空白样）会产生近似恒定的残差 $r(C) \\approx \\Delta b$，且在所有 $C$ 值上符号相同，这与观察到的情况不符。单一的严重制备误差会产生一个大的离群残差，而不是一个跨越多个数据点的、平滑的、依赖于浓度的模式。最后，仅凭一个高的 $R^{2}$ 值并不能验证函数形式的正确性；即使存在曲率，它在有限范围内也可能保持很高，而残差分析是诊断这种非线性的恰当方法。\n\n因此，最准确的结论是，该关系具有强线性但并非完全线性，而一个非线性模型（如二次模型）可能会改善拟合效果和预测准确性。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "当我们从简单回归转向多元回归时，模型变得更强大，但也更复杂。标准 $R^2$ 的一个已知问题是，随着我们添加更多变量，它的值会机械地增加，这可能导致过拟合。本练习将介绍调整后 $R^2$，这是一种对模型复杂度进行惩罚的修正指标，从而能更真实地评估模型性能。通过推导其公式并将其应用于临床研究场景，您将理解如何在模型拟合优度与简约性之间取得平衡。",
            "id": "4795902",
            "problem": "一个临床研究团队使用普通最小二乘法 (OLS) 拟合了一个多元线性回归模型，该模型用于在一个包含 $n=60$ 名成年患者的队列中，通过常规收集的预测变量来模拟基线对数转换后的 C-反应蛋白。该模型包含一个截距项和 $p=10$ 个解释变量（不包括截距）。报告的决定系数为 $R^2=0.35$。本着统计推断和医学循证的精神，研究人员希望以一种能够解释由多个预测变量引起的有限样本偏差的方式来量化模型的拟合优度。\n\n请仅从 OLS 回归的方差分析分解和基于自由度的经典无偏方差估计量出发，推导出用 $n$、$p$ 和 $R^{2}$ 表示的调整后决定系数的表达式。然后，使用 $n=60$，$p=10$ 和 $R^2=0.35$ 计算调整后决定系数。将您的数值答案四舍五入到四位有效数字，并以小数形式表示。最后，评估自由度惩罚是否在此医学背景下显著改变了对模型拟合优度的解释，重点关注变化的大小是否可能影响关于解释力的结论。",
            "solution": "**第一部分：调整后决定系数 ($R_{adj}^2$) 的推导**\n\n推导从普通最小二乘 (OLS) 线性回归模型的方差分析 (ANOVA) 分解开始。响应变量的总变异被划分为模型解释的变异和未解释的（残差）变异。\n\n总平方和 ($SST$) 衡量因变量 $y$ 的总方差。其定义为 $SST = \\sum_{i=1}^{n} (y_i - \\bar{y})^2$，其中 $n$ 是样本量，$\\bar{y}$ 是 $y$ 的样本均值。\n\n回归平方和 ($SSR$) 衡量由回归模型解释的因变量方差量。其定义为 $SSR = \\sum_{i=1}^{n} (\\hat{y}_i - \\bar{y})^2$，其中 $\\hat{y}_i$ 是模型的拟合值。\n\n残差平方和 ($SSE$)，也称为误差平方和，衡量未解释的方差。其定义为 $SSE = \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2$。\n\n基本的方差分析恒等式是：\n$$SST = SSR + SSE$$\n\n标准决定系数 $R^2$ 定义为因变量总方差中可由自变量预测的比例。\n$$R^2 = \\frac{SSR}{SST} = 1 - \\frac{SSE}{SST}$$\n$R^2$ 的一个已知问题是，它是总体决定系数的有偏估计量。当向模型中添加新的预测变量时，即使它们不相关，$R^2$ 也永远不会减小。这可能导致对模型拟合优度的过于乐观的评估，这种现象被称为过拟合，尤其是在预测变量数量 $p$ 相对于样本量 $n$ 较大时。\n\n调整后决定系数 $R_{adj}^2$ 通过惩罚无关预测变量的加入来对此进行校正。它通过使用方差的无偏估计量来做到这一点。总体总方差 $\\sigma_y^2$ 的无偏估计量是总均方 ($MST$)，即总平方和除以其自由度 $df_T = n-1$。\n$$MST = \\frac{SST}{n-1}$$\n误差方差 $\\sigma^2$ 的无偏估计量是均方误差 ($MSE$)，即残差平方和除以其自由度 $df_E = n - k$，其中 $k$ 是模型中估计系数的总数。对于包含 $p$ 个预测变量和一个截距的多元线性回归， $k = p+1$。因此，误差的自由度为：\n$$df_E = n - (p+1) = n-p-1$$\n因此，均方误差为：\n$$MSE = \\frac{SSE}{n-p-1}$$\n调整后 $R^2$ 的定义与 $R^2$ 类似，但它使用的是这些方差的无偏估计量：\n$$R_{adj}^2 = 1 - \\frac{MSE}{MST} = 1 - \\frac{SSE/(n-p-1)}{SST/(n-1)}$$\n为了用原始 $R^2$ 表示 $R_{adj}^2$，我们可以重新整理这个表达式：\n$$R_{adj}^2 = 1 - \\left(\\frac{SSE}{SST}\\right) \\left(\\frac{n-1}{n-p-1}\\right)$$\n根据 $R^2$ 的定义，我们知道 $\\frac{SSE}{SST} = 1 - R^2$。将此代入 $R_{adj}^2$ 的方程，得到所需的关系：\n$$R_{adj}^2 = 1 - (1 - R^2) \\frac{n-1}{n-p-1}$$\n这个表达式显示了调整后 $R^2$ 是如何通过应用一个惩罚因子 $\\frac{n-1}{n-p-1}$ 从 $R^2$ 推导出来的，对于 $p0$，该因子总是大于 1。随着 $p$ 的增加或 $n$ 的减小，这个因子会增大，使得对于预测变量相对于样本量较多的模型，调整更为严厉。\n\n**第二部分：数值计算**\n\n问题提供了以下值：\n样本量, $n = 60$。\n解释变量数量, $p = 10$。\n决定系数, $R^2 = 0.35$。\n\n使用推导出的公式：\n$$R_{adj}^2 = 1 - (1 - R^2) \\frac{n-1}{n-p-1}$$\n将给定值代入表达式：\n$$R_{adj}^2 = 1 - (1 - 0.35) \\frac{60-1}{60-10-1}$$\n$$R_{adj}^2 = 1 - (0.65) \\frac{59}{49}$$\n现在我们计算数值：\n$$R_{adj}^2 = 1 - 0.65 \\times \\left(\\frac{59}{49}\\right) \\approx 1 - 0.65 \\times 1.2040816...$$\n$$R_{adj}^2 \\approx 1 - 0.78265306...$$\n$$R_{adj}^2 \\approx 0.2173469...$$\n按要求将结果四舍五入到四位有效数字，得到：\n$$R_{adj}^2 \\approx 0.2173$$\n\n**第三部分：对解释变化的评估**\n\n原始决定系数 $R^2 = 0.35$ 表明模型解释了基线对数转换后 C-反应蛋白 $35\\%$ 的方差。在许多医学研究背景下，这被认为是一个中等但可能有意义的解释力水平。\n\n调整后决定系数 $R_{adj}^2 \\approx 0.2173$ 表明，在考虑了模型中使用的预测变量数量相对于样本量后，估计的已解释方差比例仅为约 $21.7\\%$。\n\n从 $0.35$ 下降到 $0.2173$ 是一个显著的下降。绝对减少量为 $0.35 - 0.2173 = 0.1327$。相对减少量为 $\\frac{0.1327}{0.35} \\approx 0.379$，这比原始 $R^2$ 值减少了近 $38\\%$。\n\n这种变化非常有意义，几乎肯定会影响关于模型解释力的结论。对于一个中等样本量 ($n=60$) 而言，相对较多的预测变量 ($p=10$) 造成了显著的过拟合可能性。未经调整的 $R^2$ 因这一事实而被夸大。调整后 $R^2$ 对模型在抽样总体中的表现提供了一个更现实（也更发人深省）的评估。\n\n在循证医学领域，这是一个关键的区别。一个解释 $35\\%$ 方差的模型可能被看作是开发预测工具的一个有希望的起点。相比之下，一个仅解释 $21.7\\%$ 方差的模型将被认为解释力有限。这样的结果会降低研究人员的热情，并表明这组预测变量虽然可能具有统计显著性，但并未构成一个强大的解释框架。它将促使研究人员寻找更具影响力的预测变量，考虑模型简化，或者得出结论：使用现有数据本质上难以预测该结果。对模型复杂度的惩罚，在这种情况下，显著地将其解释从“中等效用”变为“有限效用”。",
            "answer": "$$\\boxed{0.2173}$$"
        }
    ]
}