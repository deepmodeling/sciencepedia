{
    "hands_on_practices": [
        {
            "introduction": "本练习是预测建模的基石。在构建回归模型后，我们的主要目标之一是将其应用于新数据点以进行预测。本题将引导您完成一个具体案例，手动计算给定新协变量值的点预测值及其标准误。通过这个过程，您将巩固对普通最小二乘法 (OLS) 预测力学核心的理解，这是评估预测可靠性的基础。",
            "id": "4940014",
            "problem": "一项生物统计学研究调查了收缩压（单位：$\\mathrm{mm}\\,\\mathrm{Hg}$）作为患者年龄和身体质量指数的函数。假设采用具有独立同方差高斯误差的经典线性模型：对于 $i \\in \\{1,2,3,4,5\\}$，响应 $y_i$ 满足 $y_i = \\beta_0 + \\beta_1 A_i + \\beta_2 B_i + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，$A_i$ 和 $B_i$ 是通过 $A_i = \\text{age}_i - 50$（单位：年）和 $B_i = \\text{BMI}_i - 27$（单位：$\\mathrm{kg}\\,\\mathrm{m}^{-2}$）定义的均值中心化协变量。设计矩阵 $X$ 的行为 $x_i^{\\top} = (1, A_i, B_i)$，响应向量为 $y = (y_1,y_2,y_3,y_4,y_5)^{\\top}$。观测到的数据集是：\n- $(A_1,B_1,y_1) = (-10,-1,120)$，\n- $(A_2,B_2,y_2) = (-5,2,132)$，\n- $(A_3,B_3,y_3) = (0,0,127)$，\n- $(A_4,B_4,y_4) = (5,-2,131)$，\n- $(A_5,B_5,y_5) = (10,1,140)$。\n一名新患者的年龄为 $\\text{age} = 52$，身体质量指数为 $\\text{BMI} = 29$，在同样的中心化处理下，得到的协变量向量为 $x_*^{\\top} = (1, 2, 2)$。\n\n在所述假设下，使用普通最小二乘法 (OLS) 框架，计算在 $x_*$ 处的条件平均收缩压的点预测值以及该预测均值的标准误。将两个量都四舍五入到四位有效数字。两个数值结果都用 $\\mathrm{mm}\\,\\mathrm{Hg}$ 表示。",
            "solution": "线性模型由 $y = X\\beta + \\varepsilon$ 给出，其中 $y$ 是响应向量，$X$ 是设计矩阵，$\\beta$ 是参数向量，$\\varepsilon$ 是误差向量。\n设计矩阵 $X$ 和响应向量 $y$ 由给定数据构建：\n$$\nX = \\begin{pmatrix}\n1  A_1  B_1 \\\\\n1  A_2  B_2 \\\\\n1  A_3  B_3 \\\\\n1  A_4  B_4 \\\\\n1  A_5  B_5\n\\end{pmatrix} = \\begin{pmatrix}\n1  -10  -1 \\\\\n1  -5  2 \\\\\n1  0  0 \\\\\n1  5  -2 \\\\\n1  10  1\n\\end{pmatrix}, \\quad\ny = \\begin{pmatrix}\n120 \\\\\n132 \\\\\n127 \\\\\n131 \\\\\n140\n\\end{pmatrix}\n$$\n$\\beta = (\\beta_0, \\beta_1, \\beta_2)^{\\top}$ 的 OLS 估计量是 $\\hat{\\beta} = (X^{\\top}X)^{-1}X^{\\top}y$。\n首先，我们计算 $X^{\\top}X$：\n$$\nX^{\\top}X = \\begin{pmatrix}\n\\sum_{i=1}^5 1  \\sum_{i=1}^5 A_i  \\sum_{i=1}^5 B_i \\\\\n\\sum_{i=1}^5 A_i  \\sum_{i=1}^5 A_i^2  \\sum_{i=1}^5 A_i B_i \\\\\n\\sum_{i=1}^5 B_i  \\sum_{i=1}^5 A_i B_i  \\sum_{i=1}^5 B_i^2\n\\end{pmatrix}\n$$\n各项和为：\n$\\sum A_i = -10 - 5 + 0 + 5 + 10 = 0$\n$\\sum B_i = -1 + 2 + 0 - 2 + 1 = 0$\n$\\sum A_i^2 = (-10)^2 + (-5)^2 + 0^2 + 5^2 + 10^2 = 100 + 25 + 0 + 25 + 100 = 250$\n$\\sum B_i^2 = (-1)^2 + 2^2 + 0^2 + (-2)^2 + 1^2 = 1 + 4 + 0 + 4 + 1 = 10$\n$\\sum A_i B_i = (-10)(-1) + (-5)(2) + (0)(0) + (5)(-2) + (10)(1) = 10 - 10 + 0 - 10 + 10 = 0$\n涉及协变量的非对角线项为零，这表明这是一个正交设计。\n$$\nX^{\\top}X = \\begin{pmatrix}\n5  0  0 \\\\\n0  250  0 \\\\\n0  0  10\n\\end{pmatrix}\n$$\n其逆矩阵很容易计算：\n$$\n(X^{\\top}X)^{-1} = \\begin{pmatrix}\n\\frac{1}{5}  0  0 \\\\\n0  \\frac{1}{250}  0 \\\\\n0  0  \\frac{1}{10}\n\\end{pmatrix} = \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.004  0 \\\\\n0  0  0.1\n\\end{pmatrix}\n$$\n接下来，我们计算 $X^{\\top}y$：\n$$\nX^{\\top}y = \\begin{pmatrix}\n\\sum y_i \\\\\n\\sum A_i y_i \\\\\n\\sum B_i y_i\n\\end{pmatrix}\n$$\n$\\sum y_i = 120 + 132 + 127 + 131 + 140 = 650$\n$\\sum A_i y_i = (-10)(120) + (-5)(132) + (0)(127) + (5)(131) + (10)(140) = -1200 - 660 + 0 + 655 + 1400 = 195$\n$\\sum B_i y_i = (-1)(120) + (2)(132) + (0)(127) + (-2)(131) + (1)(140) = -120 + 264 + 0 - 262 + 140 = 22$\n所以，\n$$\nX^{\\top}y = \\begin{pmatrix}\n650 \\\\\n195 \\\\\n22\n\\end{pmatrix}\n$$\n现在我们可以计算 OLS 估计值 $\\hat{\\beta}$：\n$$\n\\hat{\\beta} = \\begin{pmatrix} \\hat{\\beta}_0 \\\\ \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\end{pmatrix} = (X^{\\top}X)^{-1}X^{\\top}y = \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.004  0 \\\\\n0  0  0.1\n\\end{pmatrix} \\begin{pmatrix}\n650 \\\\\n195 \\\\\n22\n\\end{pmatrix} = \\begin{pmatrix}\n0.2 \\times 650 \\\\\n0.004 \\times 195 \\\\\n0.1 \\times 22\n\\end{pmatrix} = \\begin{pmatrix}\n130 \\\\\n0.78 \\\\\n2.2\n\\end{pmatrix}\n$$\n在新协变量向量 $x_*$ 处的条件平均血压的点预测值为 $\\hat{y}_* = x_*^{\\top}\\hat{\\beta}$。当 $x_*^{\\top} = (1, 2, 2)$ 时：\n$$\n\\hat{y}_* = \\begin{pmatrix} 1  2  2 \\end{pmatrix} \\begin{pmatrix} 130 \\\\ 0.78 \\\\ 2.2 \\end{pmatrix} = 1(130) + 2(0.78) + 2(2.2) = 130 + 1.56 + 4.4 = 135.96\n$$\n该预测均值的标准误由 $s.e.(\\hat{y}_*) = \\sqrt{\\widehat{\\text{Var}}(\\hat{y}_*)} = \\sqrt{\\hat{\\sigma}^2 x_*^{\\top}(X^{\\top}X)^{-1}x_*}$ 给出。\n首先，我们需要误差方差 $\\sigma^2$ 的一个无偏估计。该估计为 $\\hat{\\sigma}^2 = \\frac{SSE}{n-p}$，其中 $SSE$ 是误差平方和，$n$ 是观测数量（$5$），$p$ 是参数数量（$3$）。误差的自由度为 $n-p = 5-3=2$。\n$SSE = \\sum (y_i - \\hat{y}_i)^2 = y^{\\top}y - \\hat{\\beta}^{\\top}X^{\\top}y$。\n$y^{\\top}y = 120^2 + 132^2 + 127^2 + 131^2 + 140^2 = 14400 + 17424 + 16129 + 17161 + 19600 = 84714$。\n$\\hat{\\beta}^{\\top}X^{\\top}y = \\begin{pmatrix} 130  0.78  2.2 \\end{pmatrix} \\begin{pmatrix} 650 \\\\ 195 \\\\ 22 \\end{pmatrix} = (130)(650) + (0.78)(195) + (2.2)(22) = 84500 + 152.1 + 48.4 = 84700.5$。\n$SSE = 84714 - 84700.5 = 13.5$。\n所以，$\\hat{\\sigma}^2 = \\frac{13.5}{2} = 6.75$。\n接下来，我们计算项 $x_*^{\\top}(X^{\\top}X)^{-1}x_*$：\n$$\nx_*^{\\top}(X^{\\top}X)^{-1}x_* = \\begin{pmatrix} 1  2  2 \\end{pmatrix} \\begin{pmatrix}\n0.2  0  0 \\\\\n0  0.004  0 \\\\\n0  0  0.1\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} 1  2  2 \\end{pmatrix} \\begin{pmatrix} 0.2 \\\\ 0.008 \\\\ 0.2 \\end{pmatrix} = 1(0.2) + 2(0.008) + 2(0.2) = 0.2 + 0.016 + 0.4 = 0.616\n$$\n现在我们可以计算预测均值的估计方差：\n$$\n\\widehat{\\text{Var}}(\\hat{y}_*) = \\hat{\\sigma}^2 x_*^{\\top}(X^{\\top}X)^{-1}x_* = (6.75)(0.616) = 4.158\n$$\n标准误是该值的平方根：\n$$\ns.e.(\\hat{y}_*) = \\sqrt{4.158} \\approx 2.03911745...\n$$\n问题要求将两个量都四舍五入到四位有效数字。\n点预测值：$\\hat{y}_* = 135.96 \\approx 136.0$。\n标准误：$s.e.(\\hat{y}_*)\n\\approx 2.039$。\n两个量的单位都是 $\\mathrm{mm}\\,\\mathrm{Hg}$。\n\n最终结果是：\n- 条件平均收缩压的点预测值：$136.0\\,\\mathrm{mm}\\,\\mathrm{Hg}$。\n- 该预测均值的标准误：$2.039\\,\\mathrm{mm}\\,\\mathrm{Hg}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 136.0  2.039 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "理解预测中的不确定性至关重要，但这其中存在一个关键的区别：预测平均响应和预测单个未来结果。本练习通过一个清晰的数值示例，阐明了均值置信区间和个体预测区间之间的差异。您将计算并比较这两个区间的宽度，从而深刻理解为何预测单个新观测值（包含个体变异）本质上比估计平均响应（个体变异被平均掉）具有更大的不确定性。",
            "id": "4940038",
            "problem": "一个生物统计学团队将空腹血糖浓度（单位：毫克/分升(mg/dL)）建模为身体质量指数(BMI)的线性函数。令响应变量为$y$，预测变量为$x$；模型为 $y_{i} = \\beta_{0} + \\beta_{1} x_{i} + \\varepsilon_{i}$，其中误差$\\varepsilon_{i}$是独立同分布的，服从均值为$0$、方差恒为$\\sigma^{2}$的高斯分布。该临床数据集包含$n = 10$名成人。最小二乘拟合得到的截距估计值为$\\hat{\\beta}_{0} = 60.0$ (mg/dL)，斜率估计值为$\\hat{\\beta}_{1} = 0.90$ (mg/dL每BMI单位)，残差标准误为$s = 6.0$ (mg/dL)。预测变量的汇总统计量为$\\sum_{i=1}^{n} x_{i} = 268$ 和 $\\sum_{i=1}^{n} x_{i}^{2} = 7354$。考虑在$x_{*} = 29$处进行预测。对于双侧$95$置信水平，自由度为$n - 2 = 8$，学生t分布的临界值为$t_{0.975,8} = 2.306$。\n\n使用正态误差线性回归框架和所提供的设计汇总统计量，计算在$x_{*}$处空腹血糖均值的双侧$95$置信区间，以及在$x_{*}$处单个空腹血糖结果的双侧$95$预测区间。然后，计算在$x_{*} = 29$处它们的总宽度之比（预测区间宽度除以置信区间宽度）。将最终的比率四舍五入至四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "解答需要计算均值响应的置信区间和单个响应的预测区间，然后求出它们宽度的比率。对于$95\\%$的置信水平，令$\\alpha = 0.05$。\n\n**1. 初步计算**\n首先，我们计算预测变量的样本均值$\\bar{x}$和离差平方和$S_{xx}$。\n样本均值为：\n$$ \\bar{x} = \\frac{\\sum_{i=1}^{n} x_{i}}{n} = \\frac{268}{10} = 26.8 $$\n离差平方和为：\n$$ S_{xx} = \\sum_{i=1}^{n} (x_{i} - \\bar{x})^{2} = \\sum_{i=1}^{n} x_{i}^{2} - n \\bar{x}^{2} $$\n代入给定值：\n$$ S_{xx} = 7354 - 10 \\cdot (26.8)^{2} = 7354 - 10 \\cdot 718.24 = 7354 - 7182.4 = 171.6 $$\n在$x_{*} = 29$处响应的预测值为：\n$$ \\hat{y}_{*} = \\hat{\\beta}_{0} + \\hat{\\beta}_{1} x_{*} = 60.0 + 0.90 \\cdot 29 = 60.0 + 26.1 = 86.1 $$\n\n**2. 均值响应的置信区间**\n均值响应$E(y_{*}) = \\beta_{0} + \\beta_{1} x_{*}$的$100(1-\\alpha)\\%$置信区间由下式给出：\n$$ \\hat{y}_{*} \\pm t_{1-\\alpha/2, n-2} \\cdot s \\cdot \\sqrt{\\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}} $$\n均值响应的标准误$SE(\\hat{y}_{*})$为：\n$$ SE(\\hat{y}_{*}) = s \\cdot \\sqrt{\\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}} $$\n我们来计算平方根下的项：\n$$ \\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}} = \\frac{1}{10} + \\frac{(29 - 26.8)^{2}}{171.6} = 0.1 + \\frac{(2.2)^{2}}{171.6} = 0.1 + \\frac{4.84}{171.6} $$\n为了使用精确分数，我们写成：\n$$ \\frac{4.84}{171.6} = \\frac{484}{17160} = \\frac{121}{4290} = \\frac{11}{390} $$\n所以，该项为：\n$$ \\frac{1}{10} + \\frac{11}{390} = \\frac{39}{390} + \\frac{11}{390} = \\frac{50}{390} = \\frac{5}{39} $$\n现在我们可以计算标准误：\n$$ SE(\\hat{y}_{*}) = 6.0 \\cdot \\sqrt{\\frac{5}{39}} $$\n置信区间的误差范围是：\n$$ ME_{CI} = t_{0.975, 8} \\cdot SE(\\hat{y}_{*}) = 2.306 \\cdot 6.0 \\cdot \\sqrt{\\frac{5}{39}} = 13.836 \\sqrt{\\frac{5}{39}} $$\n数值上，$ME_{CI} \\approx 13.836 \\cdot 0.358057 \\approx 4.9546$。\n在$x_{*} = 29$处均值血糖的$95\\%$置信区间为：\n$$ CI = 86.1 \\pm 4.9546 \\implies [81.1454, 91.0546] $$\n置信区间的总宽度为 $W_{CI} = 2 \\cdot ME_{CI} = 2 \\cdot 13.836 \\sqrt{\\frac{5}{39}}$。\n\n**3. 单个响应的预测区间**\n新单个观测值$y_{*}$的$100(1-\\alpha)\\%$预测区间由下式给出：\n$$ \\hat{y}_{*} \\pm t_{1-\\alpha/2, n-2} \\cdot s \\cdot \\sqrt{1 + \\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}} $$\n预测标准误$SE(\\text{pred})$为：\n$$ SE(\\text{pred}) = s \\cdot \\sqrt{1 + \\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}} $$\n使用我们之前的计算：\n$$ SE(\\text{pred}) = 6.0 \\cdot \\sqrt{1 + \\frac{5}{39}} = 6.0 \\cdot \\sqrt{\\frac{39+5}{39}} = 6.0 \\cdot \\sqrt{\\frac{44}{39}} $$\n预测区间的误差范围是：\n$$ ME_{PI} = t_{0.975, 8} \\cdot SE(\\text{pred}) = 2.306 \\cdot 6.0 \\cdot \\sqrt{\\frac{44}{39}} = 13.836 \\sqrt{\\frac{44}{39}} $$\n数值上，$ME_{PI} \\approx 13.836 \\cdot 1.06217 \\approx 14.7002$。\n在$x_{*} = 29$处单个血糖结果的$95\\%$预测区间为：\n$$ PI = 86.1 \\pm 14.7002 \\implies [71.3998, 100.8002] $$\n预测区间的总宽度为 $W_{PI} = 2 \\cdot ME_{PI} = 2 \\cdot 13.836 \\sqrt{\\frac{44}{39}}$。\n\n**4. 区间宽度之比**\n问题要求总宽度的比率，即预测区间宽度除以置信区间宽度。\n$$ R = \\frac{W_{PI}}{W_{CI}} = \\frac{2 \\cdot t_{1-\\alpha/2, n-2} \\cdot s \\cdot \\sqrt{1 + \\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}}}{2 \\cdot t_{1-\\alpha/2, n-2} \\cdot s \\cdot \\sqrt{\\frac{1}{n} + \\frac{(x_{*} - \\bar{x})^{2}}{S_{xx}}}} $$\n公共项消掉，比率简化为：\n$$ R = \\frac{\\sqrt{1 + \\frac{5}{39}}}{\\sqrt{\\frac{5}{39}}} = \\frac{\\sqrt{\\frac{44}{39}}}{\\sqrt{\\frac{5}{39}}} = \\sqrt{\\frac{44/39}{5/39}} = \\sqrt{\\frac{44}{5}} $$\n现在，我们计算数值：\n$$ R = \\sqrt{8.8} \\approx 2.96647939... $$\n将结果四舍五入至四位有效数字，我们得到$2.966$。这是一个无量纲数，正如从两个具有相同单位的量之比所预期的那样。",
            "answer": "$$\\boxed{2.966}$$"
        },
        {
            "introduction": "在现实世界的建模中，我们经常遇到一个棘手的问题：多重共线性，即预测变量之间高度相关。这种现象会严重影响普通最小二乘 (OLS) 估计的稳定性，导致预测结果极不可靠。本练习不仅从理论上解释了共线性如何“放大”预测的变异性，还通过一个数值计算，直观地展示了岭回归 (ridge regression) 如何通过引入一个惩罚项来有效稳定预测。",
            "id": "4940018",
            "problem": "一位生物统计学家正在使用两个高度共线的实验室生物标志物 $x_{1}$ 和 $x_{2}$ 对一个连续的炎症指数 $y$ 进行建模。这些预测变量已经过中心化（均值为 $0$）和标准化（单位方差）处理，样本量为 $n=50$ 名患者，因此设计矩阵 $X \\in \\mathbb{R}^{50 \\times 2}$ 的列是标准化的。基于这 $50$ 名患者，您获得了以下的充分交叉乘积摘要：\n- 预测变量的交叉乘积矩阵是\n$$\nX^{\\top}X=\\begin{pmatrix}\n50  49.95\\\\\n49.95  50\n\\end{pmatrix},\n$$\n这表明 $x_{1}$ 和 $x_{2}$ 之间存在近似共线性。\n- 预测变量与结果的交叉乘积向量是\n$$\nX^{\\top}y=\\begin{pmatrix}\n5\\\\\n-5\n\\end{pmatrix}.\n$$\n\n仅使用最小二乘法和惩罚最小二乘法的核心定义作为出发点，完成以下任务：\n1. 从第一性原理出发，解释为什么严重的共线性会增加由普通最小二乘 (OLS) 估计器产生的线性预测的变异性，以及岭回归如何缓解此问题。您的解释应使用对 $X^{\\top}X$ 进行特征分解的观点，并且必须明确地将惩罚项的效果与小特征值相关的方向联系起来。\n2. 对于一位新的患者，其标准化的生物标志物值为 $x_{0}=\\begin{pmatrix}1.00\\\\0.98\\end{pmatrix}$，计算：\n   - OLS 预测值 $\\hat{y}_{\\text{OLS}}=x_{0}^{\\top}\\hat{\\beta}$。\n   - 岭回归预测值 $\\hat{y}_{\\lambda}=x_{0}^{\\top}\\hat{\\beta}_{\\lambda}$，惩罚参数为 $\\lambda=10$，其中 $\\hat{\\beta}_{\\lambda}$ 是最小化带 $\\ell_{2}$ 惩罚的惩罚残差平方和的解。\n3. 只报告新患者的岭回归预测值 $\\hat{y}_{\\lambda}$。将您的答案四舍五入到四位有效数字。以任意标准化单位 (a.u.) 表示最终数值。",
            "solution": "根据问题要求，解答分为两部分。首先，提供从第一性原理出发的解释，然后进行具体计算。\n\n第一部分：共线性、OLS 和岭回归的理论解释\n\n标准线性模型由 $y = X\\beta + \\epsilon$ 给出，其中 $y$ 是响应向量，$X$ 是设计矩阵，$\\beta$ 是系数向量，$\\epsilon$ 是随机误差向量，其均值为 $0$，方差为 $\\sigma^2 I$。\n\nOLS 估计量 $\\hat{\\beta}$ 是使残差平方和 $S(\\beta) = (y - X\\beta)^{\\top}(y - X\\beta)$ 最小化的向量。该最小化过程导出正规方程 $(X^{\\top}X)\\hat{\\beta} = X^{\\top}y$，其解为：\n$$\n\\hat{\\beta}_{\\text{OLS}} = (X^{\\top}X)^{-1}X^{\\top}y\n$$\n该估计量的协方差矩阵为 $\\text{Cov}(\\hat{\\beta}_{\\text{OLS}}) = \\sigma^2(X^{\\top}X)^{-1}$。\n\n为了理解共线性的影响，我们使用对称半正定矩阵 $X^{\\top}X$ 的特征分解。设 $X^{\\top}X = VDV^{\\top}$，其中 $V$ 是一个正交矩阵，其列 $v_j$ 是 $X^{\\top}X$ 的特征向量，$D$ 是一个对角矩阵，其对角线上的元素是相应的非负特征值 $d_j$。那么其逆矩阵为 $(X^{\\top}X)^{-1} = V D^{-1} V^{\\top}$，其中 $D^{-1}$ 是对角元素为 $1/d_j$ 的对角矩阵。\n\n预测变量之间的严重共线性意味着 $X$ 的某些列近似线性相关。这意味着矩阵 $X^{\\top}X$ 近似奇异，这又意味着其至少有一个特征值（比如 $d_k$）非常接近于零（$d_k \\approx 0$）。\n\nOLS 估计量的方差直接受到这些小特征值的影响。投影到特征向量 $v_k$ 方向上的估计系数的方差为 $\\text{Var}(v_k^{\\top}\\hat{\\beta}_{\\text{OLS}}) = v_k^{\\top} \\text{Cov}(\\hat{\\beta}_{\\text{OLS}}) v_k = \\sigma^2 v_k^{\\top} (V D^{-1} V^{\\top}) v_k = \\sigma^2 (1/d_k)$。当 $d_k \\to 0$ 时，此方差项趋于无穷大。这种“方差膨胀”意味着 OLS 估计非常不稳定；输入数据的微小变化可能导致系数估计值的剧烈波动。这种不稳定性会转化为较差的预测性能，因为对于新数据点 $x_0$ 的预测值 $\\hat{y}_{\\text{OLS}} = x_0^{\\top}\\hat{\\beta}_{\\text{OLS}}$ 也会有很高的方差。\n\n岭回归通过在最小化目标中引入一个惩罚项来缓解这个问题。岭回归估计量 $\\hat{\\beta}_{\\lambda}$ 最小化惩罚残差平方和：\n$$\nS_{\\lambda}(\\beta) = (y - X\\beta)^{\\top}(y - X\\beta) + \\lambda \\beta^{\\top}\\beta\n$$\n其中 $\\lambda > 0$ 是惩罚参数，惩罚项是系数向量的 $\\ell_2$ 范数的平方。此最小化问题的解为：\n$$\n\\hat{\\beta}_{\\lambda} = (X^{\\top}X + \\lambda I)^{-1}X^{\\top}y\n$$\n使用 $X^{\\top}X$ 的特征分解，逆矩阵项变为：\n$$\n(X^{\\top}X + \\lambda I)^{-1} = (VDV^{\\top} + \\lambda VIV^{\\top})^{-1} = (V(D + \\lambda I)V^{\\top})^{-1} = V(D + \\lambda I)^{-1}V^{\\top}\n$$\n矩阵 $(D + \\lambda I)$ 是一个对角矩阵，其元素为 $d_j + \\lambda$。其逆矩阵 $(D + \\lambda I)^{-1}$ 是一个对角矩阵，其元素为 $1/(d_j + \\lambda)$。\n\n关键的区别在于，即使某个特征值 $d_k$ 接近于零，逆矩阵中的相应项 $1/(d_k + \\lambda)$ 也被 $1/\\lambda$ 所界定。惩罚参数 $\\lambda$ 确保了待求逆矩阵的所有特征值都远离零。这稳定了逆矩阵，从而控制了系数估计的方差。参数空间中与小特征值相对应的方向（即高度共线性的方向）被最显著地收缩，因为加上 $\\lambda$ 对小的 $d_j$ 具有最大的相对影响。这在估计中引入了少量偏差（因为 $\\hat{\\beta}_{\\lambda}$ 不再是 $\\beta$ 的无偏估计量），但极大地降低了方差，从而得到一个更稳定、预测性能更好的模型，这是偏差-方差权衡的一个经典例子。\n\n第二部分：数值计算\n\n我们已知以下信息：\n$$\nX^{\\top}X = \\begin{pmatrix} 50  49.95 \\\\ 49.95  50 \\end{pmatrix}, \\quad X^{\\top}y = \\begin{pmatrix} 5 \\\\ -5 \\end{pmatrix}, \\quad x_0 = \\begin{pmatrix} 1.00 \\\\ 0.98 \\end{pmatrix}, \\quad \\lambda=10\n$$\n\n首先，我们计算 OLS 预测值。我们需要 $X^{\\top}X$ 的逆矩阵。其行列式为 $\\det(X^{\\top}X) = (50)(50) - (49.95)(49.95) = 2500 - 2495.0025 = 4.9975$。\n逆矩阵是：\n$$\n(X^{\\top}X)^{-1} = \\frac{1}{4.9975} \\begin{pmatrix} 50  -49.95 \\\\ -49.95  50 \\end{pmatrix}\n$$\nOLS 系数向量是：\n$$\n\\hat{\\beta}_{\\text{OLS}} = (X^{\\top}X)^{-1}X^{\\top}y = \\frac{1}{4.9975} \\begin{pmatrix} 50  -49.95 \\\\ -49.95  50 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ -5 \\end{pmatrix} = \\frac{1}{4.9975} \\begin{pmatrix} 50(5) + (-49.95)(-5) \\\\ -49.95(5) + 50(-5) \\end{pmatrix}\n$$\n$$\n\\hat{\\beta}_{\\text{OLS}} = \\frac{1}{4.9975} \\begin{pmatrix} 250 + 249.75 \\\\ -249.75 - 250 \\end{pmatrix} = \\frac{1}{4.9975} \\begin{pmatrix} 499.75 \\\\ -499.75 \\end{pmatrix} = \\begin{pmatrix} 100 \\\\ -100 \\end{pmatrix}\n$$\n新患者的 OLS 预测值为：\n$$\n\\hat{y}_{\\text{OLS}} = x_0^{\\top}\\hat{\\beta}_{\\text{OLS}} = \\begin{pmatrix} 1.00  0.98 \\end{pmatrix} \\begin{pmatrix} 100 \\\\ -100 \\end{pmatrix} = 1.00(100) + 0.98(-100) = 100 - 98 = 2\n$$\n\n接下来，我们计算惩罚参数为 $\\lambda = 10$ 时的岭回归预测值。首先，我们计算矩阵 $(X^{\\top}X + \\lambda I)$：\n$$\nX^{\\top}X + \\lambda I = \\begin{pmatrix} 50  49.95 \\\\ 49.95  50 \\end{pmatrix} + \\begin{pmatrix} 10  0 \\\\ 0  10 \\end{pmatrix} = \\begin{pmatrix} 60  49.95 \\\\ 49.95  60 \\end{pmatrix}\n$$\n该矩阵的行列式为 $\\det(X^{\\top}X + \\lambda I) = (60)(60) - (49.95)(49.95) = 3600 - 2495.0025 = 1104.9975$。\n逆矩阵是：\n$$\n(X^{\\top}X + \\lambda I)^{-1} = \\frac{1}{1104.9975} \\begin{pmatrix} 60  -49.95 \\\\ -49.95  60 \\end{pmatrix}\n$$\n岭回归系数向量是：\n$$\n\\hat{\\beta}_{\\lambda} = (X^{\\top}X + \\lambda I)^{-1}X^{\\top}y = \\frac{1}{1104.9975} \\begin{pmatrix} 60  -49.95 \\\\ -49.95  60 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ -5 \\end{pmatrix}\n$$\n$$\n\\hat{\\beta}_{\\lambda} = \\frac{1}{1104.9975} \\begin{pmatrix} 60(5) + (-49.95)(-5) \\\\ -49.95(5) + 60(-5) \\end{pmatrix} = \\frac{1}{1104.9975} \\begin{pmatrix} 300 + 249.75 \\\\ -249.75 - 300 \\end{pmatrix} = \\frac{1}{1104.9975} \\begin{pmatrix} 549.75 \\\\ -549.75 \\end{pmatrix}\n$$\n新患者的岭回归预测值为：\n$$\n\\hat{y}_{\\lambda} = x_0^{\\top}\\hat{\\beta}_{\\lambda} = \\begin{pmatrix} 1.00  0.98 \\end{pmatrix} \\frac{1}{1104.9975} \\begin{pmatrix} 549.75 \\\\ -549.75 \\end{pmatrix}\n$$\n$$\n\\hat{y}_{\\lambda} = \\frac{1}{1104.9975} \\left( 1.00(549.75) + 0.98(-549.75) \\right) = \\frac{549.75}{1104.9975} (1.00 - 0.98)\n$$\n$$\n\\hat{y}_{\\lambda} = \\frac{549.75}{1104.9975} (0.02) = \\frac{10.995}{1104.9975} \\approx 0.009950248...\n$$\n问题要求将此值四舍五入到四位有效数字。前四位有效数字是 $9, 9, 5, 0$。第五位有效数字是 $2$，小于 $5$，因此我们向下舍入（即保持第四位数字不变）。\n四舍五入后的值为 $0.009950$。",
            "answer": "$$\n\\boxed{0.009950}\n$$"
        }
    ]
}