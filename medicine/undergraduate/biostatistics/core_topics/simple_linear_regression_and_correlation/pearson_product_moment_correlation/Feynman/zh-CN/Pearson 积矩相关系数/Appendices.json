{
    "hands_on_practices": [
        {
            "introduction": "掌握一个统计量的最佳方式，莫过于从第一性原理出发，亲手进行计算。本练习将引导你使用一个小型假设性医学数据集，分步计算皮尔逊相关系数。通过计算均值、标准差和协方差，你将清楚地看到这些独立的组成部分如何共同构成最终的相关值。",
            "id": "4825168",
            "problem": "一项循证医学（EBM）的试点研究旨在探究高血压成年人基线膳食钠摄入量与12周收缩压变化之间的线性关联。对于每位参与者，配对数据 $(x_i,y_i)$ 包括：$x_i$ 等于基线时每日消耗的钠克数，$y_i$ 等于随访期间收缩压的变化量（单位为毫米汞柱，正值的$y_i$表示升高）。样本量为 $n=5$，观测到的数据对为：$(2,3)$, $(4,5)$, $(6,4)$, $(8,9)$, $(10,11)$。\n\n仅使用适用于统计推断的基本定义，从第一性原理出发，计算钠摄入量 ($X$) 和血压变化 ($Y$) 的以下样本摘要统计量：样本均值 $\\bar{x}$ 和 $\\bar{y}$，无偏样本标准差 $s_X$ 和 $s_Y$，无偏样本协方差 $s_{XY}$，以及解释为标准化协方差的Pearson积矩相关系数 $r$。在循证医学的背景下，对 $r$ 的大小进行简要的定性解释，同时需指出样本量较小。\n\n仅报告 $r$ 的最终值，保留四位有效数字。不要对中间量进行超出精确计算所必需的四舍五入；在可能的情况下应保留精确形式。最终答案必须是无单位的，并且应该是一个单一的数字。",
            "solution": "问题陈述经评估有效。它具有科学依据、提法恰当、客观，并包含得出唯一解所需的所有必要信息。其背景是循证医学（EBM）中的一项标准统计分析，数据亦属合理。陈述中没有矛盾、歧义或逻辑缺陷。因此，我们可以着手求解。\n\n该问题要求从第一性原理出发，为一组 $n=5$ 的配对观测值 $(x_i, y_i)$ 计算若干样本统计量。数据如下：$(2,3)$, $(4,5)$, $(6,4)$, $(8,9)$, $(10,11)$。其中，$x_i$ 表示基线时每日膳食钠摄入量（克），$y_i$ 表示收缩压的变化量（毫米汞柱）。\n\n首先，我们计算 $X$ 和 $Y$ 的样本均值，记为 $\\bar{x}$ 和 $\\bar{y}$。\n样本均值的公式为 $\\bar{x} = \\frac{1}{n}\\sum_{i=1}^{n} x_i$。\n对于钠摄入量数据 $X$：\n$$ \\sum_{i=1}^{5} x_i = 2 + 4 + 6 + 8 + 10 = 30 $$\n$$ \\bar{x} = \\frac{30}{5} = 6 $$\n对于血压变化数据 $Y$：\n$$ \\sum_{i=1}^{5} y_i = 3 + 5 + 4 + 9 + 11 = 32 $$\n$$ \\bar{y} = \\frac{32}{5} = 6.4 $$\n\n接下来，我们计算无偏样本标准差 $s_X$ 和 $s_Y$。这需要先计算无偏样本方差 $s_X^2$ 和 $s_Y^2$。无偏样本方差的公式是 $s^2 = \\frac{1}{n-1}\\sum_{i=1}^{n} (z_i - \\bar{z})^2$，其中求和项是离均差平方和，通常记为 $SS$。\n\n对于 $X$，离均差平方和 $SS_{xx}$ 为：\n$$ SS_{xx} = \\sum_{i=1}^{5} (x_i - \\bar{x})^2 = (2-6)^2 + (4-6)^2 + (6-6)^2 + (8-6)^2 + (10-6)^2 $$\n$$ SS_{xx} = (-4)^2 + (-2)^2 + (0)^2 + (2)^2 + (4)^2 = 16 + 4 + 0 + 4 + 16 = 40 $$\n$X$ 的无偏样本方差为：\n$$ s_X^2 = \\frac{SS_{xx}}{n-1} = \\frac{40}{5-1} = \\frac{40}{4} = 10 $$\n$X$ 的无偏样本标准差为：\n$$ s_X = \\sqrt{s_X^2} = \\sqrt{10} $$\n\n对于 $Y$，离均差平方和 $SS_{yy}$ 为：\n$$ SS_{yy} = \\sum_{i=1}^{5} (y_i - \\bar{y})^2 = (3-6.4)^2 + (5-6.4)^2 + (4-6.4)^2 + (9-6.4)^2 + (11-6.4)^2 $$\n$$ SS_{yy} = (-3.4)^2 + (-1.4)^2 + (-2.4)^2 + (2.6)^2 + (4.6)^2 = 11.56 + 1.96 + 5.76 + 6.76 + 21.16 = 47.2 $$\n$Y$ 的无偏样本方差为：\n$$ s_Y^2 = \\frac{SS_{yy}}{n-1} = \\frac{47.2}{5-1} = \\frac{47.2}{4} = 11.8 $$\n$Y$ 的无偏样本标准差为：\n$$ s_Y = \\sqrt{s_Y^2} = \\sqrt{11.8} $$\n\n现在，我们计算无偏样本协方差 $s_{XY}$。其公式为 $s_{XY} = \\frac{1}{n-1}\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$。求和项是离差乘积和，记为 $SS_{xy}$。\n$$ SS_{xy} = \\sum_{i=1}^{5} (x_i - \\bar{x})(y_i - \\bar{y}) $$\n$$ SS_{xy} = (2-6)(3-6.4) + (4-6)(5-6.4) + (6-6)(4-6.4) + (8-6)(9-6.4) + (10-6)(11-6.4) $$\n$$ SS_{xy} = (-4)(-3.4) + (-2)(-1.4) + (0)(-2.4) + (2)(2.6) + (4)(4.6) $$\n$$ SS_{xy} = 13.6 + 2.8 + 0 + 5.2 + 18.4 = 40 $$\n无偏样本协方差为：\n$$ s_{XY} = \\frac{SS_{xy}}{n-1} = \\frac{40}{5-1} = \\frac{40}{4} = 10 $$\n\n最后，我们计算Pearson积矩相关系数 $r$。它定义为由样本标准差的乘积标准化的样本协方差。\n$$ r = \\frac{s_{XY}}{s_X s_Y} $$\n代入我们计算出的值：\n$$ r = \\frac{10}{\\sqrt{10} \\sqrt{11.8}} = \\frac{\\sqrt{10}}{\\sqrt{11.8}} = \\sqrt{\\frac{10}{11.8}} = \\sqrt{\\frac{100}{118}} = \\sqrt{\\frac{50}{59}} $$\n为了得到最终的数值，我们计算平方根并四舍五入到四位有效数字：\n$$ r \\approx \\sqrt{0.8474576...} \\approx 0.9205746... $$\n$$ r \\approx 0.9206 $$\n\n对该结果的定性解释如下。Pearson相关系数 $r \\approx 0.9206$ 表明，在该特定样本中，基线膳食钠摄入量与12周收缩压变化之间存在非常强的正线性关系。随着钠摄入量的增加，收缩压的变化也倾向于以高度线性的方式增加。然而，在循证医学的背景下，对这一发现必须极其谨慎地加以解释。$n=5$ 的样本量对于做出任何普适性推断来说都极小。在如此小的数据集中，强相关性很可能偶然出现，并且对总体相关性的估计会受到非常大的抽样误差的影响。因此，尽管这一试点研究的结果具有启发性，但远非结论性的，在声称其具有任何临床相关性之前，需要在更大规模、设计更完善的研究中进行验证。",
            "answer": "$$\\boxed{0.9206}$$"
        },
        {
            "introduction": "在掌握了基本计算之后，理解皮尔逊 $r$ 的局限性和潜在陷阱至关重要。下一个练习将展示单个异常值如何对相关系数产生深远影响——这是一种被称为非稳健性的特性。通过这个例子，你将更深刻地体会到为什么在进行统计计算时，总应辅以数据的可视化检查。",
            "id": "4825051",
            "problem": "一个转化医学团队研究在一个小型试点队列中，促炎性生物标志物与同一天记录的临床严重程度评分之间的关联。对于每个个体，令$x$表示记录的生物标志物值，$y$表示记录的临床评分。给定$n=6$个观测对：\n$$(x,y)\\in\\{(1,5),(2,4),(3,3),(4,2),(5,1),(100,100)\\}.$$\n最后一对被怀疑是由数据处理错误（例如，单位换算错误）引起的极端离群值。从样本均值、样本方差、样本协方差和皮尔逊积矩相关系数的核心定义出发，通过将其表示为样本原始和的形式，从基本原理推导相关性。计算所有$6$对的样本皮尔逊相关系数$r$，然后在您的推导中，明确指出对应于交叉离差（分子）和边际平方和（分母）的项。使用这些已识别的项来解释，在这种医学数据背景下，单个极端离群值如何改变每个组成部分，从而改变$r$的值。将您最终的$r$数值答案四舍五入到$4$位有效数字。",
            "solution": "将通过首先提取给定信息，然后评估其科学和逻辑完整性来验证问题陈述。\n\n### 步骤1：提取给定信息\n-   观测对的数量为$n=6$。\n-   数据由成对的$(x,y)$组成，其中$x$是生物标志物值，$y$是临床评分。\n-   数据集为$\\{(1,5),(2,4),(3,3),(4,2),(5,1),(100,100)\\}$。\n-   任务是从基本原理出发，推导皮尔逊积矩相关系数$r$，并将其表示为原始和的形式。\n-   任务要求计算给定$6$对的$r$值。\n-   任务要求明确识别交叉离差和边际平方和的项。\n-   任务要求解释单个极端离群值$(100,100)$如何改变每个组成部分以及最终的$r$值。\n-   最终的$r$数值答案必须四舍五入到$4$位有效数字。\n\n### 步骤2：使用提取的信息进行验证\n-   **科学依据**：该问题基于描述性统计学的基本且普遍接受的原理。皮尔逊相关系数、样本均值、方差、协方差以及离群值的概念是生物统计学和数据分析中的标准主题。所呈现的情景（生物标志物与临床评分，并存在数据处理错误）在医学研究中是现实且常见的。该问题在科学上是合理的。\n-   **适定性**：该问题提供了所有必要的数据和一个清晰、明确的目标。可以从给定信息中确定一个唯一且有意义的解（$r$的值和所要求的解释）。\n-   **客观性**：该问题使用精确、客观的数学和统计术语进行陈述。它要求基于计算进行计算和机理解释，不含主观因素。\n-   **缺陷清单**：该问题不违反任何无效性标准。它在事实上是合理的、可形式化的、完整的、可行的、适定的、非平凡的且可科学验证的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导与计算\n\n皮尔逊积矩相关系数$r$定义为两个变量的样本协方差除以它们样本标准差的乘积。\n\n设两个变量为$x$和$y$，有一个包含$n$对$(x_i, y_i)$的样本。\n$x$的样本均值为$\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$。\n$y$的样本均值为$\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$。\n\n样本协方差定义为$\\text{Cov}(x,y) = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$。\n$x$的样本方差为$s_x^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2$。样本标准差为$s_x = \\sqrt{s_x^2}$。\n$y$的样本方差为$s_y^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。样本标准差为$s_y = \\sqrt{s_y^2}$。\n\n皮尔逊相关系数$r$由下式给出：\n$$r = \\frac{\\text{Cov}(x,y)}{s_x s_y} = \\frac{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n因子$\\frac{1}{n-1}$在分子和分母中可以消去，从而得到以离差平方和表示的表达式：\n$$r = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n这就是从基本原理出发的所需推导。\n\n在此公式中：\n-   分子，$SS_{xy} = \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$，是**交叉离差和**。\n-   分母平方根内的项是**边际平方和**：$x$的边际平方和为$SS_{xx} = \\sum_{i=1}^{n} (x_i - \\bar{x})^2$，$y$的边际平方和为$SS_{yy} = \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。\n\n为便于计算，这些和可以用原始和来表示，这样可以避免计算每个单独的离差：\n$SS_{xy} = \\sum x_i y_i - n\\bar{x}\\bar{y} = \\sum x_i y_i - \\frac{(\\sum x_i)(\\sum y_i)}{n}$\n$SS_{xx} = \\sum x_i^2 - n\\bar{x}^2 = \\sum x_i^2 - \\frac{(\\sum x_i)^2}{n}$\n$SS_{yy} = \\sum y_i^2 - n\\bar{y}^2 = \\sum y_i^2 - \\frac{(\\sum y_i)^2}{n}$\n\n数据为：$n=6$，数据对为$(1,5), (2,4), (3,3), (4,2), (5,1), (100,100)$。\n首先，我们计算必要的原始和：\n$\\sum x_i = 1+2+3+4+5+100 = 115$\n$\\sum y_i = 5+4+3+2+1+100 = 115$\n$\\sum x_i^2 = 1^2+2^2+3^2+4^2+5^2+100^2 = 1+4+9+16+25+10000 = 10055$\n$\\sum y_i^2 = 5^2+4^2+3^2+2^2+1^2+100^2 = 25+16+9+4+1+10000 = 10055$\n$\\sum x_i y_i = (1)(5)+(2)(4)+(3)(3)+(4)(2)+(5)(1)+(100)(100) = 5+8+9+8+5+10000 = 10035$\n\n现在我们计算分量$SS_{xy}$、$SS_{xx}$和$SS_{yy}$：\n$SS_{xy} = 10035 - \\frac{(115)(115)}{6} = 10035 - \\frac{13225}{6} = \\frac{60210 - 13225}{6} = \\frac{46985}{6}$\n$SS_{xx} = 10055 - \\frac{(115)^2}{6} = 10055 - \\frac{13225}{6} = \\frac{60330 - 13225}{6} = \\frac{47105}{6}$\n$SS_{yy} = 10055 - \\frac{(115)^2}{6} = 10055 - \\frac{13225}{6} = \\frac{60330 - 13225}{6} = \\frac{47105}{6}$\n\n最后，我们计算$r$：\n$$r = \\frac{SS_{xy}}{\\sqrt{SS_{xx} SS_{yy}}} = \\frac{\\frac{46985}{6}}{\\sqrt{\\frac{47105}{6} \\cdot \\frac{47105}{6}}} = \\frac{\\frac{46985}{6}}{\\frac{47105}{6}} = \\frac{46985}{47105}$$\n$r \\approx 0.99745250...$\n四舍五入到$4$位有效数字，$r \\approx 0.9975$。\n\n### 离群值影响的解释\n\n为了理解离群值的影响，我们首先分析不包含它的数据。前五对是$(1,5), (2,4), (3,3), (4,2), (5,1)$。对于这$n'=5$个点：\n$\\sum x'_i = 1+2+3+4+5 = 15 \\implies \\bar{x}' = \\frac{15}{5} = 3$\n$\\sum y'_i = 5+4+3+2+1 = 15 \\implies \\bar{y}' = \\frac{15}{5} = 3$\n$SS'_{xy} = \\sum(x'_i - \\bar{x}')(y'_i - \\bar{y}') = (1-3)(5-3) + (2-3)(4-3) + (3-3)(3-3) + (4-3)(2-3) + (5-3)(1-3) = (-2)(2) + (-1)(1) + (0)(0) + (1)(-1) + (2)(-2) = -4 - 1 + 0 - 1 - 4 = -10$\n$SS'_{xx} = \\sum(x'_i - \\bar{x}')^2 = (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 = 4+1+0+1+4 = 10$\n$SS'_{yy} = \\sum(y'_i - \\bar{y}')^2 = (2)^2 + (1)^2 + 0^2 + (-1)^2 + (-2)^2 = 4+1+0+1+4 = 10$\n这五个点的相关性是$r' = \\frac{-10}{\\sqrt{10 \\cdot 10}} = -1$。\n这表示一个完全的负线性关系。这些点位于直线$y = 6 - x$上。\n\n现在，我们引入离群值$(100,100)$并分析其对决定整体相关性的总和的影响。新的均值为$\\bar{x} = \\frac{115}{6} \\approx 19.17$和$\\bar{y} = \\frac{115}{6} \\approx 19.17$。数据云的中心被猛烈地从$(3,3)$拉向离群值。\n\n我们来检验单个离群值$(x_6, y_6) = (100, 100)$对完整数据集（$n=6$）的平方和的贡献：\n1.  **边际平方和（$SS_{xx}$ 和 $SS_{yy}$）**：离群值对$SS_{xx}$的贡献是$(x_6 - \\bar{x})^2 = (100 - \\frac{115}{6})^2 = (\\frac{485}{6})^2 = \\frac{235225}{36} \\approx 6534.03$。前五个点的贡献总和为$\\sum_{i=1}^{5}(x_i - \\bar{x})^2 \\approx 1316.81$。因此，离群值在$x$上的平方离差比所有其他点的平方离差之和大约$\\frac{6534.03}{1316.81} \\approx 4.96$倍。由于数据的对称性，这同样适用于$SS_{yy}$。这个单点极大地夸大了在$x$和$y$上感知到的方差。\n\n2.  **交叉离差和（$SS_{xy}$）**：离群值的贡献是$(x_6 - \\bar{x})(y_6 - \\bar{y}) = (100 - \\frac{115}{6})(100 - \\frac{115}{6}) = (\\frac{485}{6})^2 = \\frac{235225}{36} \\approx 6534.03$。前五个点的贡献总和为$\\sum_{i=1}^{5}(x_i - \\bar{x})(y_i - \\bar{y}) \\approx 1296.81$。离群值的交叉乘积项比所有其他点的总和大约$\\frac{6534.03}{1296.81} \\approx 5.04$倍。\n\n**结论**：离群值$(100,100)$具有极高的杠杆效应。因为它远离均值$(\\bar{x}, \\bar{y})$，其对平方和（$SS_{xx}, SS_{yy}$）以及交叉离差和（$SS_{xy}$）的单个贡献是巨大的。这些单点贡献主导了总和，淹没了其他五个点的集体贡献。最初的强负相关（$r = -1$）是由前五个点的负交叉离差和（$SS'_{xy} = -10$）决定的。该离群值为这个和增加了一个巨大的正值，使其符号翻转并变得大而正（$SS_{xy} \\approx 7830.83$）。同时，它极大地增大了分母项$SS_{xx}$和$SS_{yy}$。因为离群值位于直线$y=x$上，它对$SS_{xy}$的贡献几乎与它对$SS_{xx}$和$SS_{yy}$的贡献相同。这迫使比率$\\frac{SS_{xy}}{\\sqrt{SS_{xx}SS_{yy}}}$非常接近$+1$，完全逆转并掩盖了大部分数据中的潜在关系。这证明了皮尔逊$r$对单个极端离群值的深度敏感性，这是任何科学数据分析中都需要考虑的一个关键特性。",
            "answer": "$$\\boxed{0.9975}$$"
        },
        {
            "introduction": "一个常见的误解是将较低的皮尔逊相关性等同于两个变量之间不存在任何关系。最后的这个练习旨在阐明，皮尔逊 $r$ 特别衡量的是*线性*关联的强度。通过在一个具有完美非线性关系的数据集上，将 $r$ 与斯皮尔曼等级相关系数 $\\rho_S$ 和肯德尔等级相关系数 $\\tau$ 进行比较，你将学会区分线性和单调趋势。",
            "id": "4825067",
            "problem": "一个临床方法团队正在评估，在存在单调但非线性的关系时，不同的相关性度量如何反映关联强度。在一项预试验设计研究中，他们特意选择了 $7$ 名参与者，使得一个标准化的暴露得分 $x$ 从低值到高值对称分布。然后，实验室对暴露得分应用一个严格递增的三次校准 $g(u) = u^{3}$，以形成一个衍生生物标志物 $y = g(x)$。观测数据为 $7$ 对\n$(x_{i}, y_{i}) \\in \\{(-3,-27),\\,(-2,-8),\\,(-1,-1),\\,(0,0),\\,(1,1),\\,(2,8),\\,(3,27)\\}$，\n这些数据呈现出一种单调但非线性的关联。\n\n仅从样本协方差、样本标准差、Pearson积矩相关系数、Spearman等级相关系数和Kendall tau等级相关系数的核心定义出发（不使用任何预封装的快捷公式），计算这些数据的以下三个量：\n- $x$ 和 $y$ 之间的 Pearson 积矩相关系数 $r$，\n- $x$ 和 $y$ 之间的 Spearman 等级相关系数 $\\rho_{S}$，\n- $x$ 和 $y$ 之间的 Kendall tau 等级相关系数 $\\tau$。\n\n解释为什么在这种单调但非线性的情况下，相对于 $\\rho_{S}$ 和 $\\tau$，$r$ 会低估关联强度。报告你的三个系数，并四舍五入到四位有效数字。",
            "solution": "问题陈述经评估有效。它具有科学依据、问题明确且客观。它提供了一个完整且一致的数据集，并要求计算和解释标准的统计度量，这是统计分析的核心任务。所有必要信息均已提供，问题没有任何说明中列出的无效缺陷。\n\n该问题要求为给定数据集计算三个相关系数：\n$D = \\{(-3,-27),\\,(-2,-8),\\,(-1,-1),\\,(0,0),\\,(1,1),\\,(2,8),\\,(3,27)\\}$。\n样本大小为 $n=7$。设这两个变量为 $x$ 和 $y$。\n\n首先，我们计算样本均值 $\\bar{x}$ 和 $\\bar{y}$。\n$x$ 的值为 $\\{-3, -2, -1, 0, 1, 2, 3\\}$。\n$$ \\sum_{i=1}^{7} x_i = -3 - 2 - 1 + 0 + 1 + 2 + 3 = 0 $$\n因此，$x$ 的样本均值为 $\\bar{x} = \\frac{1}{7} \\sum_{i=1}^{7} x_i = \\frac{0}{7} = 0$。\n\n$y$ 的值为 $\\{-27, -8, -1, 0, 1, 8, 27\\}$。\n$$ \\sum_{i=1}^{7} y_i = -27 - 8 - 1 + 0 + 1 + 8 + 27 = 0 $$\n因此，$y$ 的样本均值为 $\\bar{y} = \\frac{1}{7} \\sum_{i=1}^{7} y_i = \\frac{0}{7} = 0$。\n\n由于 $\\bar{x}=0$ 和 $\\bar{y}=0$，这简化了相关系数的计算。\n\n**1. Pearson 积矩相关系数 ($r$)**\n\nPearson 相关系数 $r$ 的核心定义是 $x$ 和 $y$ 的样本协方差除以它们的样本标准差的乘积。\n$$ r = \\frac{\\text{Cov}(x,y)}{s_x s_y} $$\n样本协方差定义为 $\\text{Cov}(x,y) = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})$。\n样本方差为 $s_x^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (x_i - \\bar{x})^2$ 和 $s_y^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} (y_i - \\bar{y})^2$。\n\n由于 $\\bar{x}=0$ 和 $\\bar{y}=0$，公式变为：\n$$ \\text{Cov}(x,y) = \\frac{1}{n-1} \\sum_{i=1}^{n} x_i y_i $$\n$$ s_x^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} x_i^2 $$\n$$ s_y^2 = \\frac{1}{n-1} \\sum_{i=1}^{n} y_i^2 $$\n所以，$r$ 可以表示为：\n$$ r = \\frac{\\frac{1}{n-1} \\sum x_i y_i}{\\sqrt{\\frac{1}{n-1} \\sum x_i^2} \\sqrt{\\frac{1}{n-1} \\sum y_i^2}} = \\frac{\\sum x_i y_i}{\\sqrt{(\\sum x_i^2)(\\sum y_i^2)}} $$\n我们计算所需的和：\n$$ \\sum_{i=1}^{7} x_i^2 = (-3)^2 + (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 + 3^2 = 9 + 4 + 1 + 0 + 1 + 4 + 9 = 28 $$\n$$ \\sum_{i=1}^{7} y_i^2 = (-27)^2 + (-8)^2 + (-1)^2 + 0^2 + 1^2 + 8^2 + 27^2 = 729 + 64 + 1 + 0 + 1 + 64 + 729 = 1588 $$\n请注意 $y_i=x_i^3$。所以，乘积之和为 $\\sum x_i y_i = \\sum x_i (x_i^3) = \\sum x_i^4$。\n$$ \\sum_{i=1}^{7} x_i y_i = (-3)(-27) + (-2)(-8) + (-1)(-1) + (0)(0) + (1)(1) + (2)(8) + (3)(27) $$\n$$ \\sum_{i=1}^{7} x_i y_i = 81 + 16 + 1 + 0 + 1 + 16 + 81 = 196 $$\n现在，我们将这些和代入 $r$ 的公式中：\n$$ r = \\frac{196}{\\sqrt{28 \\times 1588}} = \\frac{196}{\\sqrt{44464}} \\approx \\frac{196}{210.86488} \\approx 0.929532... $$\n四舍五入到四位有效数字，$r \\approx 0.9295$。\n\n**2. Spearman 等级相关系数 ($\\rho_S$)**\n\nSpearman 等级相关系数定义为对变量的等级计算的 Pearson 相关系数。设 $R(x_i)$ 和 $R(y_i)$ 分别为 $x_i$ 和 $y_i$ 的等级。\n\n$x$ 的值已经排好序：$\\{-3, -2, -1, 0, 1, 2, 3\\}$。\n对应的等级 $R(x)$ 是 $\\{1, 2, 3, 4, 5, 6, 7\\}$。\n\n$y$ 的值也已排好序，因为 $y=x^3$ 是一个严格递增函数：$\\{-27, -8, -1, 0, 1, 8, 27\\}$。\n对应的等级 $R(y)$ 是 $\\{1, 2, 3, 4, 5, 6, 7\\}$。\n\n由于等级完全相同，$R(x_i) = R(y_i)$ 对于所有的 $i=1, \\dots, 7$，等级之间的关系是完全线性的。当两个变量呈具有正斜率的完美线性关系时，它们的 Pearson 相关系数为 $1$。因此，Spearman 等级相关系数 $\\rho_S$ 必须恰好为 $1$。\n\n为了通过核心定义进行计算确认，我们将 Pearson 公式应用于等级变量 $u_i = R(x_i)$ 和 $v_i = R(y_i)$：\n$u = \\{1, 2, 3, 4, 5, 6, 7\\}$ 和 $v = \\{1, 2, 3, 4, 5, 6, 7\\}$。\n平均等级为 $\\bar{u} = \\bar{v} = \\frac{1}{7} \\sum_{i=1}^7 i = \\frac{1}{7}\\frac{7(7+1)}{2} = 4$。\n等级的离差平方和为：\n$$ \\sum_{i=1}^7 (u_i - \\bar{u})^2 = \\sum_{i=1}^7 (i - 4)^2 = (-3)^2 + (-2)^2 + (-1)^2 + 0^2 + 1^2 + 2^2 + 3^2 = 9+4+1+0+1+4+9 = 28 $$\n由于 $u_i=v_i$，我们有 $\\sum (v_i - \\bar{v})^2 = 28$ 和 $\\sum(u_i - \\bar{u})(v_i - \\bar{v}) = \\sum(u_i - \\bar{u})^2 = 28$。\n$$ \\rho_S = \\frac{\\sum(u_i - \\bar{u})(v_i - \\bar{v})}{\\sqrt{\\sum(u_i - \\bar{u})^2 \\sum(v_i - \\bar{v})^2}} = \\frac{28}{\\sqrt{28 \\times 28}} = \\frac{28}{28} = 1 $$\n四舍五入到四位有效数字，$\\rho_S = 1.000$。\n\n**3. Kendall tau 等级相关系数 ($\\tau$)**\n\nKendall 的 $\\tau$ 是根据一致对和不一致对的观测数量定义的。对于一组配对 $(x_i, y_i)$，两个配对 $(x_i, y_i)$ 和 $(x_j, y_j)$ 是：\n- 如果 $(x_i - x_j)$ 和 $(y_i - y_j)$ 的符号相同，则为一致对。\n- 如果 $(x_i - x_j)$ 和 $(y_i - y_j)$ 的符号相反，则为不一致对。\n给定数据中 $x$ 或 $y$ 均无结（tied ranks）。$\\tau$ 的公式为：\n$$ \\tau = \\frac{N_c - N_d}{N_c + N_d} = \\frac{N_c - N_d}{\\binom{n}{2}} $$\n其中 $N_c$ 是一致对的数量，$N_d$ 是不一致对的数量。唯一的观测对总数为 $\\binom{7}{2} = \\frac{7 \\times 6}{2} = 21$。\n\n$x$ 的数据按升序排列。由于 $y=x^3$ 是一个严格递增函数，$y$ 的数据也按升序排列。这意味着对于任意两点 $(x_i, y_i)$ 和 $(x_j, y_j)$，若 $i  j$，则有 $x_i  x_j$ 和 $y_i  y_j$。因此，$x_i - x_j$ 和 $y_i - y_j$ 都是负数，它们的符号都是相同的。\n因此，所有 $\\binom{7}{2}=21$ 对都是一致对。\n$N_c = 21$ 且 $N_d = 0$。\n将这些值代入 $\\tau$ 的公式中：\n$$ \\tau = \\frac{21 - 0}{21} = 1 $$\n四舍五入到四位有效数字，$\\tau = 1.000$。\n\n**结果解释**\n\n这三个系数是 $r \\approx 0.9295$，$\\rho_S = 1.000$ 和 $\\tau = 1.000$。这种差异的原因在于每个系数所测量的内涵不同。\n\n- **Pearson 的 $r$** 衡量两个变量之间*线性*关系的强度和方向。只有当数据点完全落在一条直线上时，$r=1$ 或 $r=-1$ 才能实现。本题中的数据位于曲线 $y=x^3$ 上。虽然这是一个完美的函数关系，但它是一个*非线性*关系。这些点不位于一条直线上，因此 Pearson 相关系数小于 $1$，反映了与线性的偏离。\n\n- **Spearman 的 $\\rho_S$ 和 Kendall 的 $\\tau$** 是基于等级的系数，用于衡量*单调*关系的强度。单调关系是指变量倾向于向相同的相对方向移动，但不一定以恒定的速率。\n    - Spearman 的 $\\rho_S$ 通过将 Pearson 相关性应用于数据的等级来评估单调性。排序过程将任何严格的单调关系转换为等级的完美线性关系。在这种情况下，由于 $y=x^3$ 是严格递增的，所以 $y_i$ 的等级总是与 $x_i$ 的等级相同。这种等级间的完美线性关系导致 $\\rho_S=1$。\n    - Kendall 的 $\\tau$ 通过比较所有数据点对的排序来评估单调性。对于像这样的严格单调关系，每一对点都是一致的（$x$ 的增加总是与 $y$ 的增加相关联）。没有不一致对，这会产生 $\\tau$ 的最大可能值 $\\tau=1$。\n\n本质上，$r$ 表明关联不是完全线性的，而 $\\rho_S$ 和 $\\tau$ 表明关联是完全单调的。在一个主要关注关联方向和一致性，而非其特定线性形式的背景下，可以说 $r$ “低估”了关联的强度。基于等级的系数正确地识别了数据中存在的完美序数关联。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.9295  1.000  1.000\n\\end{pmatrix}\n}\n$$"
        }
    ]
}