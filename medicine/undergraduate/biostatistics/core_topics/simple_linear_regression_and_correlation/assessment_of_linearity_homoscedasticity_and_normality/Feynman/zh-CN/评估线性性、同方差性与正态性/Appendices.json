{
    "hands_on_practices": [
        {
            "introduction": "在学习回归分析时，一个常见的绊脚石是正态性假设。这个假设究竟是针对结果变量 $Y$ 还是针对不可观测的误差项 $\\varepsilon$？本练习  旨在澄清这一关键区别。通过具体的反例，你将清楚地看到，为何模型有效性取决于误差的正态性，而非结果变量的正态性——在实践中，结果变量本身往往是非正态的。",
            "id": "4894614",
            "problem": "一位生物统计学家正在使用简单线性回归模型，分析一个结果变量 $Y$（例如，一个连续的生物标志物）作为单个预测变量 $X$（例如，一个二元基因型指示变量或一个连续暴露量）的函数。建模的目标是以一种支持对回归斜率进行有效推断的方式，来检验线性性、同方差性和正态性。\n\n根据经典线性模型的基本原理，核心假设是：给定 $X$ 时 $Y$ 的条件均值是线性的，给定 $X$ 时 $Y$ 的条件方差是恒定的，并且误差是条件独立同分布的，服从一个指定的分布。具体来说，设模型为 $Y=\\beta_0+\\beta_1 X+\\varepsilon$，其中 $\\mathbb{E}(\\varepsilon\\mid X)=0$ 且 $\\operatorname{Var}(\\varepsilon\\mid X)=\\sigma^2$；当作出正态性假设时，该假设为 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$ 并且独立于 $X$。\n\n选择所有正确的陈述。您的选择应能正确区分误差的正态性与 $Y$ 的正态性，并能识别出一个具体案例，其中即使误差在给定 $X$ 的条件下是正态的，$Y$ 也是非正态的，同时还应包括对线性性和同方差性的适当评估。\n\nA. 经典线性模型中的正态性假设指的是误差 $\\varepsilon=Y-\\mathbb{E}(Y\\mid X)$ 的条件分布（等价于 $Y\\mid X$ 围绕其均值的分布），而不是 $Y$ 的边际分布。\n\nB. 如果 $X\\in\\{0,1\\}$ 且 $\\mathbb{P}(X=1)=0.5$，$\\beta_1\\neq 0$，并且 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $X$，那么 $Y$ 是边际正态的，其方差为 $\\sigma^2+0.25\\,\\beta_1^2$。\n\nC. 如果 $X\\in\\{0,1\\}$ 且 $\\mathbb{P}(X=1)=p\\in(0,1)$，$\\beta_1\\neq 0$，并且 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $X$，那么 $Y$ 具有一个双组分正态混合边际分布，该分布通常是非正态的；尽管如此，条件误差是正态且同方差的。\n\nD. 线性模型中的同方差性意味着 $\\operatorname{Var}(Y\\mid X=x)$ 对于 $x$ 是一个常数，因此如果该假设成立，残差对拟合值图应不显示系统性的扇形散布或曲率。\n\nE. 为了评估作为线性回归中 $t$ 检验和置信区间基础的正态性假设，检查原始响应变量 $Y$ 的分位数-分位数（Q–Q）图并对其进行 Shapiro–Wilk 检验就足够了，因为如果 $Y$ 是正态的，那么误差也必须是正态的。\n\nF. 在模型 $Y=\\beta_0+\\beta_1 X+\\varepsilon$ 中，其中 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$，如果 $X$ 是连续且非正态的（例如，$X\\sim \\operatorname{Uniform}[0,1]$）并且独立于 $\\varepsilon$，那么即使条件误差是正态的，$Y$ 的边际分布通常也是非正态的。\n\n选择所有适用项。",
            "solution": "问题陈述为简单线性回归模型及其基本假设提供了正确和标准的定义。设模型为 $Y=\\beta_0+\\beta_1 X+\\varepsilon$。用于推断的核心假设是：\n1.  **线性性 (Linearity)**：$\\mathbb{E}(Y \\mid X=x) = \\beta_0 + \\beta_1 x$。这等价于陈述 $\\mathbb{E}(\\varepsilon \\mid X) = 0$。\n2.  **同方差性 (Homoscedasticity)**：对于所有 $x$，$\\operatorname{Var}(Y \\mid X=x) = \\sigma^2$。这等价于陈述 $\\operatorname{Var}(\\varepsilon \\mid X) = \\sigma^2$，一个常数。\n3.  **误差的正态性 (Normality of Errors)**：误差在以 $X$ 为条件下呈正态分布。即 $\\varepsilon \\mid X \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着 $Y \\mid X \\sim \\mathcal{N}(\\beta_0 + \\beta_1 X, \\sigma^2)$。\n4.  **独立性 (Independence)**：不同观测值的误差 $\\varepsilon_i$ 是相互独立的。\n\n这个问题具有科学依据，提法明确且客观。我们可以根据这些原则来评估每个陈述。\n\n**A. 经典线性模型中的正态性假设指的是误差 $\\varepsilon=Y-\\mathbb{E}(Y\\mid X)$ 的条件分布（等价于 $Y\\mid X$ 围绕其均值的分布），而不是 $Y$ 的边际分布。**\n\n模型是 $Y = \\mathbb{E}(Y \\mid X) + \\varepsilon$。根据定义，误差项是 $\\varepsilon = Y - \\mathbb{E}(Y \\mid X)$。正态性假设对于小样本中 $t$ 检验和置信区间的有效性至关重要，它是针对这个误差项指定的。具体来说，假设对于预测变量 $X$ 的任何给定值，误差都从一个均值为 $0$、方差为 $\\sigma^2$ 的正态分布中抽取。这正是条件分布 $\\varepsilon \\mid X$。\n\n等价地，由于 $Y \\mid X = \\mathbb{E}(Y \\mid X) + (\\varepsilon \\mid X)$，并且对于给定的 $X$，$\\mathbb{E}(Y \\mid X)$ 是固定的，因此给定 $X$ 时 $Y$ 的条件分布是一个由其均值 $\\mathbb{E}(Y \\mid X)$ 平移得到的正态分布。所以，$Y \\mid X \\sim \\mathcal{N}(\\mathbb{E}(Y \\mid X), \\sigma^2)$。\n\n该假设与 $Y$ 的边际分布（忽略 $X$ 的 $Y$ 的分布）无关，正如我们将看到的，后者通常是非正态的。这个陈述是对正态性假设的正确且根本的阐述。\n\n结论：**正确**。\n\n**B. 如果 $X\\in\\{0,1\\}$ 且 $\\mathbb{P}(X=1)=0.5$，$\\beta_1\\neq 0$，并且 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $X$，那么 $Y$ 是边际正态的，其方差为 $\\sigma^2+0.25\\,\\beta_1^2$。**\n\n让我们来确定 $Y$ 的边际分布和方差。\n$Y$ 的分布是其条件分布的混合。\n-   如果 $X=0$（概率为 $0.5$），则 $Y \\mid (X=0) = \\beta_0 + \\varepsilon \\sim \\mathcal{N}(\\beta_0, \\sigma^2)$。\n-   如果 $X=1$（概率为 $0.5$），则 $Y \\mid (X=1) = \\beta_0 + \\beta_1 + \\varepsilon \\sim \\mathcal{N}(\\beta_0+\\beta_1, \\sigma^2)$。\n\n$Y$ 的边际概率密度函数由全概率定律给出：\n$f_Y(y) = f_{Y \\mid X}(y \\mid 0)\\mathbb{P}(X=0) + f_{Y \\mid X}(y \\mid 1)\\mathbb{P}(X=1)$\n$f_Y(y) = 0.5 \\cdot \\phi(y; \\beta_0, \\sigma^2) + 0.5 \\cdot \\phi(y; \\beta_0+\\beta_1, \\sigma^2)$，其中 $\\phi(y; \\mu, \\sigma^2)$ 是正态概率密度函数（PDF）。\n这是一个具有不同均值（因为 $\\beta_1 \\neq 0$）的两个正态分布的混合。两个不同正态分布的混合不是一个正态分布。因此，“$Y$ 是边际正态的”这一说法是错误的。\n\n现在我们用全方差定律计算 $Y$ 的边际方差：$\\operatorname{Var}(Y) = \\mathbb{E}[\\operatorname{Var}(Y \\mid X)] + \\operatorname{Var}[\\mathbb{E}(Y \\mid X)]$。\n-   条件方差是 $\\operatorname{Var}(Y \\mid X) = \\operatorname{Var}(\\beta_0 + \\beta_1 X + \\varepsilon \\mid X) = \\operatorname{Var}(\\varepsilon \\mid X) = \\sigma^2$。这是一个常数，所以 $\\mathbb{E}[\\operatorname{Var}(Y \\mid X)] = \\sigma^2$。\n-   条件期望是 $\\mathbb{E}(Y \\mid X) = \\beta_0 + \\beta_1 X$。\n-   我们需要这个项的方差：$\\operatorname{Var}[\\mathbb{E}(Y \\mid X)] = \\operatorname{Var}(\\beta_0 + \\beta_1 X) = \\beta_1^2 \\operatorname{Var}(X)$。\n-   对于 $X \\sim \\text{Bernoulli}(p=0.5)$，$\\operatorname{Var}(X) = p(1-p) = 0.5(1-0.5) = 0.25$。\n-   所以，$\\operatorname{Var}[\\mathbb{E}(Y \\mid X)] = \\beta_1^2 (0.25) = 0.25 \\beta_1^2$。\n-   综合起来：$\\operatorname{Var}(Y) = \\sigma^2 + 0.25 \\beta_1^2$。\n\n方差的计算是正确的，但该陈述声称 $Y$ 是边际正态的，这是不正确的。一个陈述必须完全正确才行。\n\n结论：**不正确**。\n\n**C. 如果 $X\\in\\{0,1\\}$ 且 $\\mathbb{P}(X=1)=p\\in(0,1)$，$\\beta_1\\neq 0$，并且 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$ 独立于 $X$，那么 $Y$ 具有一个双组分正态混合边际分布，该分布通常是非正态的；尽管如此，条件误差是正态且同方差的。**\n\n这个陈述是 B 中设置的推广。\n-   $Y$ 的边际分布是 $\\mathcal{N}(\\beta_0, \\sigma^2)$（权重为 $1-p$）和 $\\mathcal{N}(\\beta_0+\\beta_1, \\sigma^2)$（权重为 $p$）的混合。由于 $p \\in (0,1)$ 且 $\\beta_1 \\neq 0$，这两个组分是不同的，且都具有非零权重。这样的混合分布不是正态分布。所以，这个陈述的第一部分是正确的。\n-   问题陈述 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$。这直接意味着条件误差是正态的。\n-   条件误差的方差是 $\\operatorname{Var}(\\varepsilon \\mid X) = \\sigma^2$。由于 $\\sigma^2$ 是一个不依赖于 $X$ 值的常数，所以误差是同方差的。\n\n这个陈述的所有部分都是正确的。它准确地描述了一个情景：回归模型的假设都成立，但结果变量的边际分布却不是正态的。\n\n结论：**正确**。\n\n**D. 线性模型中的同方差性意味着 $\\operatorname{Var}(Y\\mid X=x)$ 对于 $x$ 是一个常数，因此如果该假设成立，残差对拟合值图应不显示系统性的扇形散布或曲率。**\n\n陈述的第一部分，“同方差性...意味着 $\\operatorname{Var}(Y\\mid X=x)$ 对于 $x$ 是一个常数”，是正确的定义。\n第二部分是一个推论：“因此如果该假设成立，残差对拟合值图应不显示系统性的扇形散布或曲率。”\n让我们分析一下这个诊断图的组成部分。\n-   **扇形散布 (Fanning)**：残差对拟合值图中的“扇形”或“锥形”形状意味着残差的方差随着拟合值的水平变化而变化。没有扇形散布是同方差性的图形证据。所以，如果同方差性成立，我们期望没有系统性的扇形散布。\n-   **曲率 (Curvature)**：残差均值随拟合值变化的“曲率”或任何非随机模式表明线性性假设被违反（$\\mathbb{E}(Y \\mid X)$ 不是 $X$ 的线性函数）。\n该陈述声称如果同方差性成立，就不应该有*曲率*。这是错误的。一个模型可以在违反线性性假设的同时保持同方差性。例如，如果真实模型是 $Y = \\beta_0 + \\beta_1 X^2 + \\varepsilon$ 且 $\\operatorname{Var}(\\varepsilon)=\\sigma^2$，而我们错误地拟合了 $Y = \\alpha_0 + \\alpha_1 X + \\eta$，那么误差是同方差的，但残差图将显示出一条明显的抛物线曲线。同方差性并不意味着线性性。因此，同方差性的存在并不能保证残差图中没有曲率。\n\n结论：**不正确**。\n\n**E. 为了评估作为线性回归中 $t$ 检验和置信区间基础的正态性假设，检查原始响应变量 $Y$ 的分位数-分位数（Q–Q）图并对其进行 Shapiro–Wilk 检验就足够了，因为如果 $Y$ 是正态的，那么误差也必须是正态的。**\n\n线性回归推断的正态性假设是关于误差 $\\varepsilon$ 的，而不是响应变量 $Y$。正确的步骤是评估估计残差 $\\hat{\\varepsilon}_i = y_i - \\hat{y}_i$ 的正态性，例如，对这些残差使用 Q-Q 图或 Shapiro-Wilk 检验。检验原始响应变量 $Y$ 是根本错误的，正如选项 C 和 F 中所展示的。即使模型假设完全满足，$Y$ 的边际分布也常常是非正态的。\n\n所提供的理由“因为如果 $Y$ 是正态的，那么误差也必须是正态的”也是有缺陷且不相关的。关系是 $\\varepsilon = Y - (\\beta_0 + \\beta_1 X)$。$\\varepsilon$ 是否为正态取决于 $Y$ 和 $X$ 两者的分布。例如，如果 $Y \\sim \\mathcal{N}$ 且 $X \\sim \\text{Bernoulli}$，那么 $\\varepsilon$ 将是两个正态分布的混合，因而不是正态的。这个推论通常不成立。但更重要的是，检验 $Y$ 的前提从一开始就是错误的。\n\n结论：**不正确**。\n\n**F. 在模型 $Y=\\beta_0+\\beta_1 X+\\varepsilon$ 中，其中 $\\varepsilon\\mid X\\sim \\mathcal{N}(0,\\sigma^2)$，如果 $X$ 是连续且非正态的（例如，$X\\sim \\operatorname{Uniform}[0,1]$）并且独立于 $\\varepsilon$，那么即使条件误差是正态的，$Y$ 的边际分布通常也是非正态的。**\n\n这个陈述提出了另一个具体的反例，反驳了结果变量 $Y$ 必须是正态的这一观点。\n-   假设 $\\varepsilon \\mid X \\sim \\mathcal{N}(0,\\sigma^2)$ 已给出，并且由于 $\\varepsilon$ 也独立于 $X$，这等价于 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$。条件误差确实是正态的。\n-   变量 $Y$ 是两个独立随机变量之和：$\\varepsilon$ 和 $(\\beta_0 + \\beta_1 X)$。\n-   让我们以 $X \\sim \\operatorname{Uniform}[0,1]$ 为例。那么，假设 $\\beta_1 \\neq 0$，变量 $(\\beta_0 + \\beta_1 X)$ 服从均匀分布。\n-   一个正态分布变量与一个独立的均匀分布变量之和，可以通过它们的概率密度函数进行卷积来求得。概率论中一个著名的结果（与 Cramér 分解定理相关）指出，两个独立随机变量的和是正态的，当且仅当两个原始变量都是正态的。\n-   由于均匀分布不是正态分布，和 $Y = (\\beta_0 + \\beta_1 X) + \\varepsilon$ 将不服从正态分布。\n这提供了一个有效的例子，表明模型假设（包括正态误差）可以成立，而 $Y$ 的边际分布却是非正态的。\n\n结论：**正确**。\n\n正确选项的最终总结：A, C, F。",
            "answer": "$$\\boxed{ACF}$$"
        },
        {
            "introduction": "在明确了需要检验的*内容*之后，接下来的问题是*如何*检验。一个稳健的诊断流程并非一系列随机的测试，而是一项系统性的探究。本练习  勾勒出一个完整的诊断工作流程，要求你从几种常见但有缺陷的方法中，辨别出一种科学上严谨的方案。掌握这个工作流程是建立可靠且具有科学说服力的回归模型的关键。",
            "id": "4894659",
            "problem": "一位生物统计学家正在分析一个包含 $n=240$ 名成年人的横断面临床数据集，以研究空腹甘油三酯浓度 $Y$（单位为 $\\mathrm{mmol/L}$）与年龄 $X_1$（单位为年）、身体质量指数 $X_2$（单位为 $\\mathrm{kg/m^2}$）、吸烟状况 $X_3$（二元指标）以及基线C反应蛋白（CRP）$X_4$（单位为 $\\mathrm{mg/L}$）之间的函数关系。他们打算拟合一个形式如下的普通最小二乘（OLS）线性回归模型：\n\n$$\nY_i = \\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\beta_3 X_{3i} + \\beta_4 X_{4i} + \\varepsilon_i,\n$$\n\n并希望严格诊断均值结构的线性、误差的同方差性以及残差的正态性，然后在需要时对模型进行完善。\n\n其基本原理是，OLS在参数线性的假设下，目标是条件均值函数 $E(Y\\mid X)=X\\beta$；无偏性要求 $E(\\varepsilon\\mid X)=0$；同方差性是 $Var(\\varepsilon\\mid X)=\\sigma^2 I$；而精确的小样本$t$和$F$推断要求一个正态误差模型 $\\varepsilon \\sim N(0,\\sigma^2 I)$。残差 $r_i=Y_i-\\hat{Y}_i$ 是不可观测误差 $\\varepsilon_i$ 的可观测代理。诊断必须依赖于对 $r_i$ 和 $\\hat{Y}_i$ 的图形化和形式化评估，以及通过修改均值结构、转换结果变量或改变方差模型来解决违规问题的、有科学动机的模型改进。\n\n在本次生物统计回归中，哪个选项最贴切地概述了一个有原则、科学合理的工作流程，用于诊断线性、同方差性和正态性，包括适当的绘图、检验和模型完善？\n\nA. 立即拟合OLS模型，并对 $Y$ 进行Shapiro–Wilk检验。如果检验显著，则识别并移除异常值，直到检验不显著为止。使用Levene检验评估 $X_2$ 三分位数分组后残差的方差是否相等。如果表明存在异方差性，则对所有预测变量进行均值中心化以纠正它。将非正态的 $Y$ 视为必须使用逻辑回归；当所有 $p$-值都低于 $0.05$ 时最终确定模型。\n\nB. 从绘制 $Y$ 与每个 $X_j$ 的探索性图表开始，并附上非参数平滑曲线以评估函数形式。拟合初始OLS模型，并检查残差 $r_i$ 与拟合值 $\\hat{Y}_i$ 的关系图以及尺度-位置图，以评估线性和方差模式。使用标准化残差的分位数-分位数（Q–Q）图进行正态性评估，并可选择性地对残差进行Shapiro–Wilk检验。应用Breusch–Pagan检验或White检验来检查异方差性。检查杠杆值 $h_{ii}$ 和Cook距离 $D_i$ 以判断影响点。如果发现非线性，则添加有科学依据的多项式项或限制性三次样条到 $X_j$ 中，然后重新评估。如果方差随均值增加，考虑对 $Y$ 进行方差稳定化变换（例如，$\\log Y$ 或 $\\sqrt{Y}$）或拟合加权最小二乘法；若在不改变均值模型的情况下处理异方差性推断，则使用异方差稳健（HC$3$）标准误。如果残差非正态但样本量 $n$ 为中到大，则依赖大样本近似；否则考虑稳健回归或变换。重新拟合并重新检查诊断，报告最终模型的图形和检验证据。\n\nC. 计算 $Y$ 和每个 $X_j$ 之间的Pearson相关性以评估线性；如果任何相关性低于 $0.3$，则断定为非线性并删除该预测变量。拟合OLS模型，并使用Durbin–Watson检验来检查同方差性。对残差使用Kolmogorov–Smirnov检验进行正态性检验。如果任何检验失败，则删除变量直到所有检验都通过；当最高的 $p$-值超过 $0.2$ 时最终确定模型。\n\nD. 将所有预测变量标准化为z分数，然后拟合一个具有高斯族和恒等连接函数的广义线性模型，并要求每个预测变量都呈正态分布以证明模型的合理性。使用Bartlett检验对按拟合值三分位数分组的方差齐性进行评估，以判断同方差性。如果存在异方差性，则在预测变量之间添加交互项以吸收方差差异。忽略杠杆值和影响点，因为标准化预测变量能确保稳定性。\n\nE. 在进行任何绘图或模型拟合之前，对 $Y$ 应用自动的Box–Cox变换，并仅通过最大化似然来选择变换。变换后，仅通过线性项的 $p$-值来判断线性。对于正态性，使用单样本正态性检验来检验 $Y$。如果正态性检验失败，无论 $Y$ 的尺度如何，都切换到泊松回归。对于异方差性，依赖于对 $Y$ 直方图的视觉检查，而不是基于残差的图或检验；当变换后的 $Y$ 看起来对称时最终确定模型。",
            "solution": "用户要求对问题陈述进行批判性验证，然后提供一个有原则的解决方案，并对所有提供的选项进行详细评估。\n\n### 问题验证\n\n**步骤1：提取给定信息**\n\n- **数据来源**：一个横断面临床数据集。\n- **样本量**：$n=240$ 名成年人。\n- **结果变量 ($Y$)**：空腹甘油三酯浓度，单位 $\\mathrm{mmol/L}$。\n- **预测变量**：\n    - $X_1$：年龄，单位为年。\n    - $X_2$：身体质量指数 (BMI)，单位 $\\mathrm{kg/m^2}$。\n    - $X_3$：吸烟状况（二元指标）。\n    - $X_4$：基线C反应蛋白 (CRP)，单位 $\\mathrm{mg/L}$。\n- **提议的模型**：普通最小二乘 (OLS) 线性回归，形式为：\n    $$Y_i = \\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\beta_3 X_{3i} + \\beta_4 X_{4i} + \\varepsilon_i$$\n- **目标**：严格诊断均值结构的线性、误差的同方差性和残差的正态性，并根据需要完善模型。\n- **陈述的原则**：\n    - OLS的目标是条件均值 $E(Y\\mid X)=X\\beta$。\n    - 无偏性要求 $E(\\varepsilon\\mid X)=0$。\n    - 同方差性是 $Var(\\varepsilon\\mid X)=\\sigma^2 I$。\n    - 小样本推断要求 $\\varepsilon \\sim N(0,\\sigma^2 I)$。\n    - 残差 $r_i=Y_i-\\hat{Y}_i$ 是不可观测误差 $\\varepsilon_i$ 的可观测代理。\n    - 诊断依赖于对 $r_i$ 和 $\\hat{Y}_i$ 的图形和形式化评估。\n    - 完善模型需要修改均值结构、转换结果变量或改变方差模型。\n- **问题**：哪个选项最贴切地概述了一个用于诊断和完善模型的有原则、科学合理的工作流程？\n\n**步骤2：使用提取的给定信息进行验证**\n\n1.  **科学依据**：该问题牢固地植根于标准的生物统计学实践。这些变量是现实的，它们之间的关系是研究的常见主题。陈述的OLS回归的统计原则是教科书式的定义，构成了模型诊断的正确基础。该问题在科学上是合理的。\n2.  **问题明确**：该问题要求从一系列选项中确定最合适的工作流程。在应用统计学领域，对于回归诊断的最佳实践已形成广泛共识，这使得该问题定义明确，有确定的正确答案。\n3.  **客观性**：问题以精确、客观和技术性的语言陈述。它要求一个“有原则、科学合理的工作流程”，这在统计学中是一个客观基准，而非主观意见。\n4.  **无缺陷**：问题陈述没有违反任何列出的无效性标准。它在事实上是合理的、相关的、完整的、现实的、结构良好的、非琐碎的，并且是科学可验证的。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。分析将继续进行以提供完整解决方案。\n\n### 诊断工作流程的原则性推导\n\n一个用于诊断和完善多元线性回归模型（如此处提议的模型）的严谨工作流程如下：\n\n1.  **探索性数据分析 (EDA)**：在模型拟合之前，检查变量。\n    - 检查结果变量 $Y$ 和所有预测变量 $X_j$ 的单变量分布。生物标志物如甘油三酯 ($Y$) 和C反应蛋白 ($X_4$) 通常是高度右偏的，这可能从一开始就建议进行对数变换。\n    - 创建 $Y$ 与每个连续预测变量 ($X_1, X_2, X_4$) 的双变量图，并辅以非参数平滑器（例如LOESS），以直观地筛选潜在的非线性关系。对于二元预测变量 $X_3$，使用并排的箱线图来展示 $Y$。这为函数形式和潜在问题提供了初步见解。\n\n2.  **初始模型拟合**：拟合指定的OLS模型：$Y_i = \\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\beta_3 X_{3i} + \\beta_4 X_{4i} + \\varepsilon_i$。获取拟合值 $\\hat{Y}_i$ 和残差 $r_i = Y_i - \\hat{Y}_i$。\n\n3.  **核心诊断评估（使用残差）**：\n    - **均值结构的线性**：主要工具是残差与拟合值的图（$r_i$ vs. $\\hat{Y}_i$）。任何系统性趋势（例如，抛物线形状）都表明线性模型设定不当。成分-残差图可以进一步帮助诊断关于特定预测变量的非线性。均值线性的零假设意味着 $E(\\varepsilon_i \\mid X_i) = 0$，所以我们在代理变量 $r_i$ 中寻找模式。\n    - **同方差性（常数误差方差）**：假设是 $Var(\\varepsilon_i \\mid X_i) = \\sigma^2$。这也使用残差与拟合值的图来评估。一个“扇形”或“漏斗形”，即残差的散布随 $\\hat{Y}_i$ 的水平而变化，表明存在异方差性。尺度-位置图（标准化残差的平方根 vs. $\\hat{Y}_i$）是专门为可视化此问题而设计的。形式化检验，如Breusch-Pagan检验或更通用的White检验，可以提供反对同方差性零假设的统计证据。\n    - **误差的正态性**：假设是 $\\varepsilon_i \\sim N(0, \\sigma^2)$。这最好通过标准化残差的分位数-分位数（Q-Q）图进行图形诊断。如果误差是正态的，点应该紧靠一条直线。可以使用像Shapiro-Wilk检验这样的形式化检验，但对于 $n=240$ 的样本量，它们对与正态性的微小、无关紧要的偏差很敏感。中心极限定理通常确保在较大样本中，对系数的推断对于轻微的非正态性是稳健的。\n    - **影响点**：识别对回归结果有巨大影响的数据点。这涉及检查杠杆值统计量 ($h_{ii}$) 以寻找具有异常预测变量值的点，以及影响度量如Cook距离 ($D_i$) 以量化一个点对所有拟合值的影响。\n\n4.  **模型完善与迭代**：根据诊断结果完善模型。\n    - 如果检测到预测变量 $X_j$ 存在**非线性**，考虑添加科学上合理的多项式项（如 $X_j^2$），或使用灵活的方法如对 $X_j$ 使用限制性三次样条。\n    - 如果存在**异方差性**，常见的补救措施包括：(i) 对结果变量应用方差稳定化变换（例如 $\\log(Y)$, $\\sqrt(Y)$），这通常也有助于解决非正态性和非线性问题；(ii) 如果方差函数已知或可以建模，则使用加权最小二乘法 (WLS)；或 (iii) 保留OLS模型，但使用异方差稳健标准误（例如HC$3$）进行稳健推断。\n    - 如果残差的**非正态性**是一个主要问题（例如，严重的偏斜或重尾），且变换不足以解决或不希望使用，则考虑稳健回归方法。然而，对于 $n=240$，只要其他假设得到满足，渐近理论为即使在误差非正态的情况下对 $\\beta$ 进行推断也提供了坚实的基础。\n    - 在进行任何修改之后，必须**重新拟合模型并重复整个诊断过程**。\n\n### 逐项分析\n\n**A. 立即拟合OLS模型，并对 $Y$ 进行Shapiro–Wilk检验。如果检验显著，则识别并移除异常值，直到检验不显著为止。使用Levene检验评估 $X_2$ 三分位数分组后残差的方差是否相等。如果表明存在异方差性，则对所有预测变量进行均值中心化以纠正它。将非正态的 $Y$ 视为必须使用逻辑回归；当所有 $p$-值都低于 $0.05$ 时最终确定模型。**\n\n-   **分析**：此选项包含许多严重错误。\n    1.  正态性假设是针对误差 ($\\varepsilon_i$) 的，而不是结果变量 ($Y$) 的边际分布。检验 $Y$ 的正态性是错误的。\n    2.  仅仅为了通过统计检验而移除数据点是一种数据操纵形式，在科学上是站不住脚的。\n    3.  对预测变量进行均值中心化对异方差性完全没有影响。它会影响截距并可以减少多重共线性，但不会改变残差的方差。\n    4.  逻辑回归用于二元结果，而不是非正态的连续结果。这是对该方法的完全误用。\n    5.  基于 $p$-值阈值 ($p  0.05$) 来最终确定模型是一种糟糕的变量选择策略，与验证模型假设的过程无关。\n-   **结论**：**不正确**。\n\n**B. 从绘制 $Y$ 与每个 $X_j$ 的探索性图表开始，并附上非参数平滑曲线以评估函数形式。拟合初始OLS模型，并检查残差 $r_i$ 与拟合值 $\\hat{Y}_i$ 的关系图以及尺度-位置图，以评估线性和方差模式。使用标准化残差的分位数-分位数（Q–Q）图进行正态性评估，并可选择性地对残差进行Shapiro–Wilk检验。应用Breusch–Pagan检验或White检验来检查异方差性。检查杠杆值 $h_{ii}$ 和Cook距离 $D_i$ 以判断影响点。如果发现非线性，则添加有科学依据的多项式项或限制性三次样条到 $X_j$ 中，然后重新评估。如果方差随均值增加，考虑对 $Y$ 进行方差稳定化变换（例如，$\\log Y$ 或 $\\sqrt{Y}$）或拟合加权最小二乘法；若在不改变均值模型的情况下处理异方差性推断，则使用异方差稳健（HC$3$）标准误。如果残差非正态但样本量 $n$ 为中到大，则依赖大样本近似；否则考虑稳健回归或变换。重新拟合并重新检查诊断，报告最终模型的图形和检验证据。**\n\n-   **分析**：此选项描述了一个全面、现代且统计上严谨的工作流程，与上述原则性推导完美契合。它正确地安排了探索性数据分析、模型拟合和诊断的顺序。它指出了正确的图（残差与拟合值图、尺度-位置图、Q-Q图）、形式化检验（Breusch-Pagan, Shapiro-Wilk）和影响点诊断（杠杆值、Cook距离）。它为违规情况提出了一套复杂而恰当的补救措施（样条、变换、WLS、HCSE），并正确地强调了模型构建的迭代性质。提及HC$3$标准误以及在样本量为 $n=240$ 时依赖大样本理论，显示了高水平的专业知识。\n-   **结论**：**正确**。\n\n**C. 计算 $Y$ 和每个 $X_j$ 之间的Pearson相关性以评估线性；如果任何相关性低于 $0.3$，则断定为非线性并删除该预测变量。拟合OLS模型，并使用Durbin–Watson检验来检查同方差性。对残差使用Kolmogorov–Smirnov检验进行正态性检验。如果任何检验失败，则删除变量直到所有检验都通过；当最高的 $p$-值超过 $0.2$ 时最终确定模型。**\n\n-   **分析**：此选项存在严重缺陷。\n    1.  Pearson相关性仅衡量线性关联，不足以在多变量背景下评估线性假设。一个强的非线性关系可能相关系数为零。\n    2.  Durbin-Watson检验用于检验误差的**自相关**（一个时间序列概念），而非**同方差性**。这是一个根本性的误解。\n    3.  为了让诊断检验通过而删除变量是一种无效的建模策略。这相当于找到了一个碰巧满足假设的模型，而不是正确地指定了感兴趣变量之间的关系。\n    4.  停止标准是任意且无意义的。\n-   **结论**：**不正确**。\n\n**D. 将所有预测变量标准化为z分数，然后拟合一个具有高斯族和恒等连接函数的广义线性模型，并要求每个预测变量都呈正态分布以证明模型的合理性。使用Bartlett检验对按拟合值三分位数分组的方差齐性进行评估，以判断同方差性。如果存在异方差性，则在预测变量之间添加交互项以吸收方差差异。忽略杠杆值和影响点，因为标准化预测变量能确保稳定性。**\n\n-   **分析**：此选项包含多个基本的概念性错误。\n    1.  一个具有高斯族和恒等连接函数的广义线性模型在数学上与OLS回归是相同的。\n    2.  线性回归中**没有假设**预测变量 ($X_j$) 必须是正态分布的。这是一个非常普遍但严重的误解。\n    3.  Bartlett检验对非正态性不稳健，使其成为一个糟糕的选择。\n    4.  交互项处理的是效应修正（条件均值的变化），而不是异方差性（条件方差的变化）。\n    5.  标准化绝对不能消除杠杆值或影响点的问题。即使每个预测变量都单独标准化了，一个数据点也可能具有异常的预测变量*组合*，使其成为高杠杆点。\n-   **结论**：**不正确**。\n\n**E. 在进行任何绘图或模型拟合之前，对 $Y$ 应用自动的Box–Cox变换，并仅通过最大化似然来选择变换。变换后，仅通过线性项的 $p$-值来判断线性。对于正态性，使用单样本正态性检验来检验 $Y$。如果正态性检验失败，无论 $Y$ 的尺度如何，都切换到泊松回归。对于异方差性，依赖于对 $Y$ 直方图的视觉检查，而不是基于残差的图或检验；当变换后的 $Y$ 看起来对称时最终确定模型。**\n\n-   **分析**：此选项代表了对统计工具的机械化和不正确的应用。\n    1.  仅通过p值来判断线性是不充分的；它无法检测到非线性模式。\n    2.  与选项A一样，检验变换后的结果变量 $Y_{trans}$ 的正态性是错误的。假设是针对残差的。\n    3.  对于像甘油三酯浓度这样的连续变量，切换到泊松回归是对该模型的严重误用，该模型是为计数数据设计的。\n    4.  $Y$ 的直方图不能诊断异方差性。异方差性是条件方差 $Var(Y \\mid X)$ 的一个属性，必须使用涉及残差的图来诊断。\n    5.  $Y$ 的边际分布的对称性既不是回归假设成立的必要条件，也不是充分条件。\n-   **结论**：**不正确**。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "当诊断检验揭示了模型假设被违背时，我们该怎么办？尤其是在小样本数据中，标准修正方法可能不奏效。本练习  通过一个涉及偏态数据和异方差性的真实临床情境，让你直面这一挑战。你将学会评估并选择一个恰当的补救措施，例如非参数自助法 (bootstrap)，以确保在理想条件不满足时，你的统计推断依然有效。",
            "id": "4894646",
            "problem": "一位临床研究员研究了2型糖尿病患者的尿白蛋白与肌酐比值 $Y$ (mg/g) 与收缩压 $X$ (mmHg) 之间的线性关联。该研究员拟合了简单线性回归模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$（$i = 1, \\dots, n$），其中 $n = 12$，$E[\\varepsilon_i] = 0$，并且在经典模型下假定 $\\text{Var}(\\varepsilon_i)$ 是恒定的。目的是估计斜率 $\\beta_1$ 的95%置信区间。标准做法通常依赖于普通最小二乘法 (Ordinary Least Squares, OLS) 中的残差正态性和同方差性诊断来构建此类区间。然而，在该数据集中，诊断图显示以下情况：残差对拟合值图呈现漏斗形状（方差随拟合值增加而增加），分位数-分位数 (Quantile–Quantile, Q–Q) 图表明存在重右尾，而Shapiro–Wilk (SW) 检验得出的 $p$ 值为 $0.12$（未拒绝正态性，但由于 $n$ 较小，检验功效有限）。此外，初步尝试分析 $\\log(Y)$ 并未解决这些问题：残差仍然呈右偏态，残差对拟合值图显示出轻微的曲率，这引发了即使在变换后的尺度上，对线性和同方差性的担忧。\n\n从第一性原理出发，在正态误差假设下推导出的置信区间依赖于分布结果，而当 $n$ 较小且残差存在偏态和非恒定方差时，这些结果可能不成立。在这些条件下，研究员必须选择一种方法来获得对 $\\beta_1$ 更可靠的区间估计。\n\n在这种情况下，哪种方法最适合纠正为 $\\beta_1$ 的置信区间构建中对残差正态性和同方差性的误导性依赖？\n\nA. 继续使用来自OLS的标准基于$t$分布的置信区间，理由是Shapiro–Wilk检验未拒绝正态性。\n\nB. 对$Y$进行对数变换，重新拟合线性模型，并在重新检查诊断后，在变换后的尺度上构建常规的基于$t$分布的区间。\n\nC. 通过对观测对 $(X_i, Y_i)$ 进行有放回的重抽样来构建 $\\beta_1$ 的非参数自助法置信区间，以近似斜率的抽样分布，并使用自助法斜率的经验分位数（例如，百分位法或偏差校正和加速法 (BCa)）来形成95%置信区间。\n\nD. 移除两个最大的残差观测值以恢复对称性，并重新计算标准的OLS基于$t$分布的区间。\n\nE. 尽管 $n=12$ 且存在已观察到的诊断问题，仍依赖OLS斜率估计量的大样本渐近正态性，并使用基于正态分布的区间。",
            "solution": "该情景涉及一个简单线性回归模型 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$，其中 $n = 12$。$\\beta_1$ 的经典OLS置信区间依赖于特定的假设：均值函数的线性性、误差 $\\varepsilon_i$ 的独立性、同方差性 $\\text{Var}(\\varepsilon_i) = \\sigma^2$（对所有$i$成立）以及正态性 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。在这些假设下，OLS斜率估计量 $\\hat{\\beta}_1$ 可以写成响应 $Y_i$ 的线性组合，具体为 $\\hat{\\beta}_1 = \\sum_{i=1}^n w_i Y_i$，其中 $w_i$ 是依赖于观测值 $X_i$ 的确定性权重，并满足 $\\sum_{i=1}^n w_i = 0$。如果 $\\varepsilon_i$ 是独立同正态分布的，那么 $Y_i = \\beta_0 + \\beta_1 X_i + \\varepsilon_i$ 意味着 $\\hat{\\beta}_1$ 是正态分布的，并且当误差方差从残差中估计时，常规的基于$t$分布的置信区间具有精确的覆盖率。\n\n当正态性和同方差性假设被违反时，特别是在小样本量 $n$ 的情况下，这些分布结果不再成立。具体来说：\n\n1. 如果 $\\varepsilon_i$ 是偏态的，$\\hat{\\beta}_1 = \\sum_i w_i \\varepsilon_i + \\beta_1$ 的分布会继承 $\\varepsilon_i$ 的偏度，并且当 $n$ 较小时，可能会显著偏离正态分布。没有正态误差，学生t枢轴量就不再精确服从$t$分布。\n\n2. 如果 $\\text{Var}(\\varepsilon_i)$ 随均值增加（异方差性），$\\hat{\\beta}_1$ 的方差将依赖于 $X_i$ 的模式和 $\\text{Var}(\\varepsilon_i)$，这使得在恒定方差下推导出的常规标准误公式失效。小样本量 $n$ 限制了渐近近似的可靠性。\n\n3. 像Shapiro–Wilk检验得出 $p = 0.12$ 这样的诊断检验，在 $n=12$ 的情况下是无定论的；未能拒绝并不等于证实了正态性，并且视觉诊断显示出有意义的偏度和漏斗形的残差图，表明存在异方差性和可能的非线性。\n\n一个基于原理的补救措施是，在不强加正态性或同方差性假设的情况下，根据经验来近似 $\\hat{\\beta}_1$ 的抽样分布。对数据对 $(X_i, Y_i)$ 进行的非参数自助法通过重抽样观测到的数据结构来实现这一点，保留了联合分布，包括均值和方差之间的任何关系（异方差性）以及观测到的偏度。步骤如下：\n\n1. 从原始样本中计算OLS斜率 $\\hat{\\beta}_1$。\n\n2. 对于每次自助法迭代 $b = 1, \\dots, B$（其中 $B$ 很大，例如 $B = 2000$），从原始的 $n$ 个数据对 $(X_i, Y_i)$ 中有放回地抽取 $n$ 个数据对 $(X_i^*, Y_i^*)$。\n\n3. 对自助样本拟合相同的线性回归模型，并记录斜率 $\\hat{\\beta}_1^{*(b)}$。\n\n4. $\\{\\hat{\\beta}_1^{*(b)}\\}_{b=1}^B$ 的经验分布近似了数据生成机制下 $\\hat{\\beta}_1$ 的抽样分布。使用其分位数构建一个百分位95%置信区间，或应用偏差校正和加速 (BCa) 调整来校正偏差和偏度。\n\n这种方法不依赖于正态残差，能够适应偏态误差和非恒定方差，并且适用于小样本量 $n$，同时也承认极小样本固有的局限性。相比之下，正如该情景中所观察到的，变换和参数化修复可能仍无法解决残差问题。\n\n逐项分析：\n\nA. 继续使用来自OLS的标准基于$t$分布的区间，是假定残差具有正态性和同方差性。$p$值为$0.12$的Shapiro–Wilk检验在$n=12$时并不能证实正态性，并且诊断图显示出右偏和漏斗形状，直接违反了有效的基于$t$分布的覆盖率所需的假设。这种方法有覆盖不足或校准错误的风险。结论：不正确。\n\nB. 当误差结构是乘性时，对$Y$进行对数变换是减少右偏和稳定方差的常用技术。然而，问题陈述表明，这种尝试并未解决偏度问题，反而引入了轻微的曲率，表明即使在变换后的尺度上，也仍然存在偏离线性和同方差性的问题。在一个效果不佳的变换之后依赖基于$t$分布的区间仍然是有问题的，尤其是在$n=12$的情况下。结论：在此特定情景下不正确。\n\nC. 对数据对 $(X_i, Y_i)$ 进行的非参数自助法重抽样了联合数据，保留了$X$和$Y$之间的依赖结构、偏度以及异方差模式。从自助法斜率的经验分布构建百分位法或偏差校正和加速法 (BCa) 区间，提供了一个不依赖于残差正态性或恒定方差的区间，并直接解决了在小样本中误导性正态假设的担忧。结论：正确。\n\nD. 删除两个最大的残差观测值以强制对称是一种临时的离群值移除方法，它会引入选择偏差，通过对数据进行两次条件化而使推断无效，并且通常会低估变异性。它不构成解决偏度或异方差性的有原则的补救措施。结论：不正确。\n\nE. $\\hat{\\beta}_1$的渐近正态性在$n \\to \\infty$的广泛条件下成立，但当$n=12$且存在明显的偏度和异方差性时，大样本近似是不可靠的，可能产生校准错误的区间。结论：不正确。\n\n因此，在这种情况下最合适的补救措施是使用对数据对的非参数自助法来构建 $\\beta_1$ 的置信区间，该方法不依赖于残差正态性或同方差性假设，并考虑了观测到的偏度和较小的样本量$n$。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}