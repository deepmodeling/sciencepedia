{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握Levene检验，没有什么比亲手完成一次完整的计算更有效了。这项基础练习将指导您为一个小型数据集计算基于中位数的Levene检验统计量，从而巩固该程序的核心步骤 。通过这个过程，您不仅能熟悉计算细节，还能开始思考如何为大规模数据高效地实现这一检验。",
            "id": "4957201",
            "problem": "一位生物统计学研究员正在比较三种治疗方法下血清生物标志物的变异性。令 $Y_{ij}$ 表示第 $i$ 个治疗组中第 $j$ 名受试者的生物标志物测量值。数据如下：\n- 第 $1$ 组：$7.2$, $8.1$, $6.9$, $7.8$\n- 第 $2$ 组：$6.1$, $5.8$, $6.5$, $6.3$, $5.9$\n- 第 $3$ 组：$7.0$, $6.7$, $7.3$\n\n使用基于中位数的 Levene 检验（即，在每个组中构造与样本中位数的偏差），执行以下操作：\n- 计算对各组与中位数的绝对偏差应用单因素方差分析所得的检验统计量。\n- 评估一种计算实现策略，该策略相对于总样本量 $N$ 能达到 $\\mathcal{O}(N)$ 的时间复杂度，并为所有主要步骤（组中心计算、偏差计算、分组聚合和平方和计算）证明其复杂度阶数。\n- 针对大样本量 $N$，提出以数组和归约操作表示的向量化运算，用以计算 $Z_{ij}$ 以及组间和组内平方和。\n\n令 $g$ 表示组数，$N$ 表示总观测数。将您的最终答案以一个行矩阵的形式报告，其中包含 $F$ 统计量的数值（四舍五入到四位有效数字）和用大 $\\mathcal{O}$ 符号表示的渐近时间复杂度。最终结果中无需单位。",
            "solution": "该问题是有效的。它提出了一个定义明确的统计任务，该任务基于已建立的原则（用于检验方差齐性的 Levene 检验，单因素方差分析），并提供了所有必要的数据。该问题是自洽的、客观的、有科学依据的，并且计算上是可行的。我们将继续进行解答，解答包括三个部分：首先，计算检验统计量；其次，分析计算时间复杂度；第三，提出一种向量化的实现策略。\n\n基于中位数的 Levene 检验评估原假设 $H_0: \\sigma_1^2 = \\sigma_2^2 = \\dots = \\sigma_g^2$ 与备择假设（至少有一个组的方差不同）。该过程需要将原始数据 $Y_{ij}$（第 $i$ 组中第 $j$ 名受试者的测量值）转换为与组中位数的绝对偏差，$Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$，其中 $\\tilde{Y}_i$ 是第 $i$ 组的中位数。然后对这些 $Z_{ij}$ 值执行单因素方差分析（ANOVA）。\n\n**第1部分：F-统计量的计算**\n\n组数为 $g=3$。数据和各组样本量如下：\n- 第1组：$\\{7.2, 8.1, 6.9, 7.8\\}$，样本量 $n_1=4$。\n- 第2组：$\\{6.1, 5.8, 6.5, 6.3, 5.9\\}$，样本量 $n_2=5$。\n- 第3组：$\\{7.0, 6.7, 7.3\\}$，样本量 $n_3=3$。\n总观测数为 $N = n_1 + n_2 + n_3 = 4 + 5 + 3 = 12$。\n\n首先，我们计算每组的中位数。\n- 对于第1组，排序后的数据为 $\\{6.9, 7.2, 7.8, 8.1\\}$。中位数是中间两个值的平均值：\n  $\\tilde{Y}_1 = \\frac{7.2 + 7.8}{2} = 7.5$。\n- 对于第2组，排序后的数据为 $\\{5.8, 5.9, 6.1, 6.3, 6.5\\}$。中位数是中间值：\n  $\\tilde{Y}_2 = 6.1$。\n- 对于第3组，排序后的数据为 $\\{6.7, 7.0, 7.3\\}$。中位数是中间值：\n  $\\tilde{Y}_3 = 7.0$。\n\n接下来，我们计算每个观测值的绝对偏差 $Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$。\n- 对于第1组：$\\{|7.2-7.5|, |8.1-7.5|, |6.9-7.5|, |7.8-7.5|\\} = \\{0.3, 0.6, 0.6, 0.3\\}$。\n- 对于第2组：$\\{|6.1-6.1|, |5.8-6.1|, |6.5-6.1|, |6.3-6.1|, |5.9-6.1|\\} = \\{0.0, 0.3, 0.4, 0.2, 0.2\\}$。\n- 对于第3组：$\\{|7.0-7.0|, |6.7-7.0|, |7.3-7.0|\\} = \\{0.0, 0.3, 0.3\\}$。\n\n现在，我们对这些 $Z_{ij}$ 值执行单因素方差分析。我们需要偏差的组均值（$\\bar{Z}_i$）和总均值（$\\bar{Z}$）。\n- 偏差的组均值：\n  $\\bar{Z}_1 = \\frac{0.3+0.6+0.6+0.3}{4} = \\frac{1.8}{4} = 0.45$。\n  $\\bar{Z}_2 = \\frac{0.0+0.3+0.4+0.2+0.2}{5} = \\frac{1.1}{5} = 0.22$。\n  $\\bar{Z}_3 = \\frac{0.0+0.3+0.3}{3} = \\frac{0.6}{3} = 0.20$。\n- 偏差的总均值：\n  $\\bar{Z} = \\frac{\\sum_{i,j} Z_{ij}}{N} = \\frac{1.8 + 1.1 + 0.6}{12} = \\frac{3.5}{12} \\approx 0.29167$。\n\n方差分析需要组间平方和（$SSB$）和组内平方和（$SSW$）。\n- 组间平方和：$SSB = \\sum_{i=1}^g n_i (\\bar{Z}_i - \\bar{Z})^2$。\n  $$SSB = 4(0.45 - \\frac{3.5}{12})^2 + 5(0.22 - \\frac{3.5}{12})^2 + 3(0.20 - \\frac{3.5}{12})^2$$\n  $$SSB = 4(\\frac{5.4-3.5}{12})^2 + 5(\\frac{2.64-3.5}{12})^2 + 3(\\frac{2.4-3.5}{12})^2$$\n  $$SSB = 4(\\frac{1.9}{12})^2 + 5(\\frac{-0.86}{12})^2 + 3(\\frac{-1.1}{12})^2$$\n  $$SSB = \\frac{1}{144} [4(3.61) + 5(0.7396) + 3(1.21)] = \\frac{14.44 + 3.698 + 3.63}{144} = \\frac{21.768}{144} \\approx 0.15117$$\n- 组内平方和：$SSW = \\sum_{i=1}^g \\sum_{j=1}^{n_i} (Z_{ij} - \\bar{Z}_i)^2$。\n  对于第1组：$SSW_1 = (0.3-0.45)^2 + (0.6-0.45)^2 + (0.6-0.45)^2 + (0.3-0.45)^2 = 2(-0.15)^2 + 2(0.15)^2 = 4(0.0225) = 0.09$。\n  对于第2组：$SSW_2 = (0.0-0.22)^2 + (0.3-0.22)^2 + (0.4-0.22)^2 + (0.2-0.22)^2 + (0.2-0.22)^2 = 0.0484 + 0.0064 + 0.0324 + 0.0004 + 0.0004 = 0.088$。\n  对于第3组：$SSW_3 = (0.0-0.2)^2 + (0.3-0.2)^2 + (0.3-0.2)^2 = (-0.2)^2 + (0.1)^2 + (0.1)^2 = 0.04 + 0.01 + 0.01 = 0.06$。\n  总 $SSW = SSW_1 + SSW_2 + SSW_3 = 0.09 + 0.088 + 0.06 = 0.238$。\n\n均方是通过将平方和除以各自的自由度来计算的。\n- 组间自由度：$df_B = g - 1 = 3 - 1 = 2$。\n- 组内自由度：$df_W = N - g = 12 - 3 = 9$。\n- 组间均方：$MSB = \\frac{SSB}{df_B} = \\frac{0.15117}{2} \\approx 0.07558$。\n- 组内均方：$MSW = \\frac{SSW}{df_W} = \\frac{0.238}{9} \\approx 0.02644$。\n\n$F$-统计量是均方之比。\n$$F = \\frac{MSB}{MSW} = \\frac{0.07558}{0.02644} \\approx 2.8582$$\n四舍五入到四位有效数字，检验统计量为 $F = 2.858$。\n\n**第2部分：$\\mathcal{O}(N)$ 实现的时间复杂度分析**\n\n通过为每个步骤使用高效算法，可以实现相对于总样本量 $N$ 的时间复杂度为 $\\mathcal{O}(N)$ 的实现。\n1.  **组中心（中位数）计算**：要计算每个组 $i$（大小为 $n_i$）的中位数，一种简单的方法是对每个组进行排序，这将花费 $\\mathcal{O}(n_i \\log n_i)$ 的时间。总时间 $\\sum_{i} \\mathcal{O}(n_i \\log n_i)$ 不能保证是 $N$ 的线性函数。然而，线性时间选择算法（例如，中位数的中位数算法或 introselect）可以在 $\\mathcal{O}(n_i)$ 时间内找到大小为 $n_i$ 的未排序数组的中位数。将此算法应用于 $g$ 个组，总时间复杂度为 $\\sum_{i=1}^g \\mathcal{O}(n_i) = \\mathcal{O}(\\sum n_i) = \\mathcal{O}(N)$。\n2.  **偏差计算**：为所有 $N$ 个观测值计算 $Z_{ij} = |Y_{ij} - \\tilde{Y}_i|$ 需要遍历整个数据集一次。对每个元素执行一次减法和一次绝对值运算。此步骤的时间复杂度为 $\\mathcal{O}(N)$。\n3.  **分组聚合与平方和计算**：对 $Z_{ij}$ 值的最终方差分析计算也可以在 $\\mathcal{O}(N)$ 时间内完成。\n    - 要计算所有组均值 $\\bar{Z}_i$，只需对 $N$ 个 $Z_{ij}$ 值进行一次遍历，即可为每个组累加总和 $\\sum_j Z_{ij}$ 并计数 $n_i$。然后在 $\\mathcal{O}(g)$ 时间内计算均值。此步骤总时间为 $\\mathcal{O}(N) + \\mathcal{O}(g)$。\n    - 总均值 $\\bar{Z}$ 是在 $\\mathcal{O}(g)$ 时间内从各组的总和计算得出的。\n    - $SSB$ 是通过对 $g$ 个组进行循环计算的，使用预先计算好的 $n_i$、$\\bar{Z}_i$ 和 $\\bar{Z}$。这需要 $\\mathcal{O}(g)$ 的时间。\n    - $SSW$ 是通过对 $N$ 个 $Z_{ij}$ 值进行另一次单遍扫描来计算的，计算 $\\sum (Z_{ij} - \\bar{Z}_i)^2$。这需要 $\\mathcal{O}(N)$ 的时间。\n此阶段的总时间复杂度为 $\\mathcal{O}(N) + \\mathcal{O}(g) + \\mathcal{O}(N) = \\mathcal{O}(N+g)$。由于 $g \\le N$，这可以简化为 $\\mathcal{O}(N)$。\n\n因此，所有主要步骤的总时间复杂度为 $\\mathcal{O}(N) + \\mathcal{O}(N) + \\mathcal{O}(N) = \\mathcal{O}(N)$。\n\n**第3部分：向量化运算**\n\n对于大样本量 $N$，向量化运算对性能至关重要。假设数据存储在数组 $\\mathbf{Y}$ 中，组标签存储在相同长度的数组 $\\mathbf{I}$ 中：\n1.  **计算 $Z_{ij}$**：\n    - 首先，计算一个长度为 $N$ 的中位数数组 $\\tilde{\\mathbf{Y}}$，其中每个元素 $\\tilde{\\mathbf{Y}}_k$ 是 $\\mathbf{Y}_k$ 所属组的中位数。此操作通常是一个 `group-by`（分组）后跟一个 `transform`（转换）或 `broadcast`（广播）。\n    - 然后，通过完全向量化的逐元素运算计算偏差数组 $\\mathbf{Z}$：$\\mathbf{Z} = |\\mathbf{Y} - \\tilde{\\mathbf{Y}}|$。\n2.  **计算平方和**：\n    - **组均值和总均值**：组均值 $\\bar{\\mathbf{Z}}_{\\text{groups}}$（一个长度为 $g$ 的数组）是通过基于 $\\mathbf{I}$ 对 $\\mathbf{Z}$ 进行分段求和归约，然后除以通过分段计数归约得到的各组计数来找到的。总均值 $\\bar{Z}$ 是对 $\\mathbf{Z}$ 进行简单的求和归约再除以 $N$。\n    - **组间平方和 ($SSB$)**：使用组计数数组 $\\mathbf{n}$ 和组均值数组 $\\bar{\\mathbf{Z}}_{\\text{groups}}$：\n      $\\mathrm{SSB} = \\text{sum}(\\mathbf{n} \\odot (\\bar{\\mathbf{Z}}_{\\text{groups}} - \\bar{Z})^2)$，其中 $\\odot$ 表示逐元素乘法。这涉及广播、逐元素运算和最终的求和归约。\n    - **组内平方和 ($SSW$)**：\n      首先，将组均值 $\\bar{\\mathbf{Z}}_{\\text{groups}}$ 广播回一个长度为 $N$ 的数组 $\\bar{\\mathbf{Z}}_{\\text{expanded}}$。\n      $\\mathrm{SSW} = \\text{sum}((\\mathbf{Z} - \\bar{\\mathbf{Z}}_{\\text{expanded}})^2)$。这涉及逐元素减法和平方，然后对整个结果数组进行最终的求和归约。\n\n这些运算利用了高效的、通常是并行的底层实现来进行数组范围的计算，从而避免了在高级代码中使用显式循环。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.858  \\mathcal{O}(N)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了计算方法之后，让我们深入其理论核心。这项练习将探讨Levene检验的一个基本性质，通过推导两组情形下Levene $F$统计量与双样本$t$统计量之间的精确关系，您将更深刻地理解该检验背后的统计原理 。这个推导揭示了方差分析（ANOVA）和$t$检验这两种基本工具在特定应用中的内在联系。",
            "id": "4957230",
            "problem": "一位生物统计学研究者正在使用Levene程序评估两个独立组的方差齐性。设有由组 $i \\in \\{1,2\\}$ 索引的两个独立样本，组大小为 $n_{1} \\geq 2$ 和 $n_{2} \\geq 2$，总样本量为 $N = n_{1} + n_{2}$。对于每个组 $i$，假设原始观测值为 $Y_{ij}$（其中 $j = 1, \\dots, n_{i}$），并令 $T_{i}$ 为一个固定的、特定于组的中心（例如，均值、中位数或截尾均值），该中心仅根据组 $i$ 的数据计算得出。定义变换后的值为 $Z_{ij} = |Y_{ij} - T_{i}|$。Levene检验对 $Z_{ij}$ 进行单因素方差分析（ANOVA），以检验原始组间基本方差的齐性。将 $Z_{ij}$ 的组均值记为 $\\bar{Z}_{i} = \\frac{1}{n_{i}} \\sum_{j=1}^{n_{i}} Z_{ij}$，总均值记为 $\\bar{Z} = \\frac{1}{N} \\sum_{i=1}^{2} \\sum_{j=1}^{n_{i}} Z_{ij}$。令 $SS_{B}$ 和 $SS_{W}$ 分别为对 $Z_{ij}$ 进行单因素方差分析时计算的组间平方和与组内平方和，并令 $F_{L}$ 表示对 $Z_{ij}$ 得到的Levene $F$统计量。同时，考虑在两组 $Z_{ij}$ 的等方差模型下，根据 $Z_{ij}$ 计算的合并双样本 $t$ 统计量 $t_{p}$。\n\n从 $Z_{ij}$ 的单因素方差分析平方和以及 $Z_{ij}$ 的合并双样本 $t$ 统计量的定义出发，仅使用对任何实数数据值都有效的代数操作，推导在双组情况（$k=2$）下 $F_{L}$ 和 $t_{p}$ 之间的精确解析关系。将最终关系表示为单个封闭形式的解析表达式。无需进行数值计算，也无需四舍五入。",
            "solution": "本题要求在两组（$k=2$）的情况下，当应用于变换后的变量 $Z_{ij}$ 时，推导Levene $F$统计量 $F_L$ 与合并双样本 $t$ 统计量 $t_p$ 之间的解析关系。推导过程将通过将两个统计量表示为其基本组成部分，然后通过代数操作使它们相等来进行。\n\n首先，我们定义Levene $F$统计量 $F_L$。它是对变换后的数据 $Z_{ij}$ 进行单因素方差分析（ANOVA）得到的检验统计量。对于 $k=2$ 个组， $F$统计量是组间均方（$MS_B$）与组内均方（$MS_W$）之比。\n\n$$\nF_L = \\frac{MS_B}{MS_W}\n$$\n\n均方定义为平方和除以其各自的自由度。对于两组，组间方差的自由度为 $df_B = k-1 = 2-1 = 1$，组内方差的自由度为 $df_W = N-k = (n_1+n_2)-2$。\n\n因此，均方为：\n$$\nMS_B = \\frac{SS_B}{df_B} = \\frac{SS_B}{1} = SS_B\n$$\n$$\nMS_W = \\frac{SS_W}{df_W} = \\frac{SS_W}{n_1+n_2-2}\n$$\n\n平方和定义为：\n$$\nSS_B = \\sum_{i=1}^{2} n_i (\\bar{Z}_i - \\bar{Z})^2 = n_1(\\bar{Z}_1 - \\bar{Z})^2 + n_2(\\bar{Z}_2 - \\bar{Z})^2\n$$\n$$\nSS_W = \\sum_{i=1}^{2} \\sum_{j=1}^{n_i} (Z_{ij} - \\bar{Z}_i)^2 = \\sum_{j=1}^{n_1} (Z_{1j} - \\bar{Z}_1)^2 + \\sum_{j=1}^{n_2} (Z_{2j} - \\bar{Z}_2)^2\n$$\n将均方定义代入 $F_L$ 的公式中：\n$$\nF_L = \\frac{SS_B}{SS_W / (n_1+n_2-2)}\n$$\n\n接下来，我们定义用于比较第1组和第2组之间 $Z_{ij}$ 值均值的合并双样本 $t$ 统计量 $t_p$。\n$$\nt_p = \\frac{\\bar{Z}_1 - \\bar{Z}_2}{s_p \\sqrt{\\frac{1}{n_1} + \\frac{1}{n_2}}}\n$$\n其中 $s_p$ 是合并标准差。该统计量的平方，即合并方差 $s_p^2$，由下式给出：\n$$\ns_p^2 = \\frac{\\sum_{j=1}^{n_1} (Z_{1j} - \\bar{Z}_1)^2 + \\sum_{j=1}^{n_2} (Z_{2j} - \\bar{Z}_2)^2}{n_1+n_2-2}\n$$\n通过将 $s_p^2$ 的定义与 $SS_W$ 的定义进行比较，我们发现 $s_p^2$ 的分子恰好是 $SS_W$。因此：\n$$\ns_p^2 = \\frac{SS_W}{n_1+n_2-2} = MS_W\n$$\n这在 $t$ 统计量的一个分量与ANOVA中的组内均方之间建立了一个直接联系。\n\n现在，让我们简化组间平方和 $SS_B$ 的表达式。总均值 $\\bar{Z}$ 是组均值的加权平均值：\n$$\n\\bar{Z} = \\frac{n_1 \\bar{Z}_1 + n_2 \\bar{Z}_2}{n_1 + n_2}\n$$\n我们表示组均值与总均值之间的离差：\n$$\n\\bar{Z}_1 - \\bar{Z} = \\bar{Z}_1 - \\frac{n_1 \\bar{Z}_1 + n_2 \\bar{Z}_2}{n_1+n_2} = \\frac{(n_1+n_2)\\bar{Z}_1 - n_1\\bar{Z}_1 - n_2\\bar{Z}_2}{n_1+n_2} = \\frac{n_2(\\bar{Z}_1 - \\bar{Z}_2)}{n_1+n_2}\n$$\n$$\n\\bar{Z}_2 - \\bar{Z} = \\bar{Z}_2 - \\frac{n_1 \\bar{Z}_1 + n_2 \\bar{Z}_2}{n_1+n_2} = \\frac{(n_1+n_2)\\bar{Z}_2 - n_1\\bar{Z}_1 - n_2\\bar{Z}_2}{n_1+n_2} = \\frac{n_1(\\bar{Z}_2 - \\bar{Z}_1)}{n_1+n_2} = -\\frac{n_1(\\bar{Z}_1 - \\bar{Z}_2)}{n_1+n_2}\n$$\n将这些表达式代入 $SS_B$ 的公式中：\n$$\nSS_B = n_1 \\left( \\frac{n_2(\\bar{Z}_1 - \\bar{Z}_2)}{n_1+n_2} \\right)^2 + n_2 \\left( -\\frac{n_1(\\bar{Z}_1 - \\bar{Z}_2)}{n_1+n_2} \\right)^2\n$$\n$$\nSS_B = \\frac{n_1 n_2^2 (\\bar{Z}_1 - \\bar{Z}_2)^2}{(n_1+n_2)^2} + \\frac{n_2 n_1^2 (\\bar{Z}_1 - \\bar{Z}_2)^2}{(n_1+n_2)^2} = \\frac{(\\bar{Z}_1 - \\bar{Z}_2)^2}{(n_1+n_2)^2} (n_1 n_2^2 + n_2 n_1^2)\n$$\n从括号中的项中提出因子 $n_1 n_2$：\n$$\nSS_B = \\frac{(\\bar{Z}_1 - \\bar{Z}_2)^2}{(n_1+n_2)^2} [n_1 n_2 (n_2 + n_1)] = \\frac{n_1 n_2}{n_1+n_2} (\\bar{Z}_1 - \\bar{Z}_2)^2\n$$\n现在我们拥有了连接 $F_L$ 和 $t_p$ 所需的所有分量。让我们考虑 $t$ 统计量的平方，$t_p^2$：\n$$\nt_p^2 = \\frac{(\\bar{Z}_1 - \\bar{Z}_2)^2}{s_p^2 \\left( \\frac{1}{n_1} + \\frac{1}{n_2} \\right)}\n$$\n我们可以重写分母中倒数的和：$\\frac{1}{n_1} + \\frac{1}{n_2} = \\frac{n_1+n_2}{n_1 n_2}$。\n$$\nt_p^2 = \\frac{(\\bar{Z}_1 - \\bar{Z}_2)^2}{s_p^2 \\left( \\frac{n_1+n_2}{n_1 n_2} \\right)}\n$$\n从我们关于 $SS_B$ 的表达式中，我们可以解出 $(\\bar{Z}_1 - \\bar{Z}_2)^2$：\n$$\n(\\bar{Z}_1 - \\bar{Z}_2)^2 = SS_B \\left( \\frac{n_1+n_2}{n_1 n_2} \\right)\n$$\n将此结果以及恒等式 $s_p^2 = MS_W = \\frac{SS_W}{n_1+n_2-2}$ 代入 $t_p^2$ 的方程中：\n$$\nt_p^2 = \\frac{SS_B \\left( \\frac{n_1+n_2}{n_1 n_2} \\right)}{\\left(\\frac{SS_W}{n_1+n_2-2}\\right) \\left( \\frac{n_1+n_2}{n_1 n_2} \\right)}\n$$\n项 $\\left( \\frac{n_1+n_2}{n_1 n_2} \\right)$ 同时出现在分子和分母中，因此可以消去：\n$$\nt_p^2 = \\frac{SS_B}{SS_W / (n_1+n_2-2)}\n$$\n这个结果表达式与两组情况下 $F$ 统计量 $F_L$ 的表达式完全相同。\n$$\nF_L = \\frac{SS_B}{SS_W / (n_1+n_2-2)}\n$$\n因此，通过代数等价，我们得出了精确的关系：\n$$\nF_L = t_p^2\n$$\n这表明，对于两组比较，来自单因素方差分析的 $F$ 统计量恰好是合并方差双样本 $t$ 统计量的平方。这一普遍的统计学原理对于Levene检验程序同样成立，该程序是方差分析及相关的 $t$ 检验在变换后的绝对离差数据上的一种具体应用。",
            "answer": "$$\n\\boxed{F_L = t_p^2}\n$$"
        },
        {
            "introduction": "真实世界的数据分析常常充满挑战标准程序的边缘案例。本练习将探讨一个棘手的“如果……会怎样？”的情景：当我们将基于中位数的Levene检验应用于一个极小的样本组（例如，样本量$n=2$）时会发生什么 。这个问题揭示了一个微妙的模糊性，并促使我们批判性地思考如何稳健地定义我们的统计量，以确保结果的唯一性和有效性。",
            "id": "4957191",
            "problem": "一项生物统计学研究使用一种稳健性修正的Levene型程序，比较$k$个治疗组的收缩压变异性。对于每个组 $i \\in \\{1,\\dots,k\\}$，其观测值为 $\\{y_{ij}: j=1,\\dots,n_i\\}$，该程序计算转换值 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$，其中 $c_i$ 是特定于组的稳健中心。然后，通过对 $\\{z_{ij}\\}$ 进行单因素方差分析来评估方差的相等性。Brown–Forsythe变体在每个组中使用样本中位数作为稳健中心。\n\n从有限样本的样本中位数定义开始：中位数是任何能使绝对偏差之和 $\\sum_{j=1}^{n} \\lvert x_j - m \\rvert$ 最小化的值 $m$。等价地，对于偶数 $n$，两个中间顺序统计量之间的闭区间内的任何值都是中位数。使用这个定义，考虑一个特定的组 $i$，其样本量为 $n_i = 2$，有序观测值为 $y_{i(1)} \\le y_{i(2)}$。证明中位数的集合是整个区间 $\\left[y_{i(1)}, y_{i(2)}\\right]$，并推断出转换值 $z_{i1} = \\lvert y_{i1} - m \\rvert$ 和 $z_{i2} = \\lvert y_{i2} - m \\rvert$（以及因此后续的方差分析检验统计量）依赖于在该区间内对 $m$ 的选择。由此得出结论，当某些组的 $n_i=2$ 时，除非指定了平局决胜规则或替代的稳健中心，否则基于中位数的Levene程序是定义不明确的。\n\n以下哪项修改既能解决定义不明确的问题，又能保留位置估计量的自然不变性（位置等变性和在两点样本内的对称性），同时相对于普通均值仍保持稳健性？\n\nA. 在任何样本量为 $n_i = 2$ 的组中，将 $c_i$ 定义为两个顺序统计量的中点，$c_i = \\left(y_{i(1)} + y_{i(2)}\\right)/2$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nB. 在任何样本量为 $n_i = 2$ 的组中，将 $c_i$ 定义为较小的观测值，$c_i = y_{i(1)}$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nC. 将每个组中的中位数替换为固定百分比的截尾均值（例如，$10\\%$ 截尾均值），因此 $c_i$ 是一个唯一的截尾均值，且 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。\n\nD. 从Levene型检验中排除任何样本量为 $n_i = 2$ 的组，以使所有组的样本量都满足 $n_i \\ge 3$。\n\nE. 使用从所有组合并计算的单一合并全局中位数 $\\tilde{y}$ 来计算 $z_{ij} = \\lvert y_{ij} - \\tilde{y} \\rvert$，而不是使用特定于组的中心。\n\n选择所有适用项。",
            "solution": "用户提供了一个关于生物统计学中Brown–Forsythe检验的问题，该检验是Levene's方差齐性检验的一个变体。任务是首先验证问题陈述，如果有效，则确定适当的修改方法，以处理在小样本量下出现的特定模糊性。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **程序：** 一个用于检验$k$个组间方差是否相等的Levene型检验。\n- **组：** $i \\in \\{1, \\dots, k\\}$，其观测值为 $\\{y_{ij}: j=1, \\dots, n_i\\}$。\n- **转换：** $z_{ij} = \\lvert y_{ij} - c_i \\rvert$，其中 $c_i$ 是一个特定于组的稳健中心。\n- **检验：** 对转换值 $\\{z_{ij}\\}$ 进行单因素方差分析 (ANOVA)。\n- **Brown–Forsythe变体：** 这个特定的变体使用样本中位数作为 $c_i$。\n- **中位数定义：** 样本 $\\{x_j: j=1, \\dots, n\\}$ 的中位数 $m$ 是任何能使绝对偏差之和 $\\sum_{j=1}^{n} \\lvert x_j - m \\rvert$ 最小化的值。\n- **偶数$n$的中位数：** 两个中间顺序统计量之间的闭区间内的任何值都是中位数。\n- **情景：** 一个组 $i$，其样本量为 $n_i = 2$，有序观测值为 $y_{i(1)} \\le y_{i(2)}$。\n- **证明任务：** 问题陈述断言，对于此情景，中位数的集合是 $[y_{i(1)}, y_{i(2)}]$，这使得转换值 $z_{ij}$ 和后续的检验统计量依赖于中位数的选择，从而使该程序定义不明确。\n- **问题：** 确定给出的修改项 (A-E) 中哪些能解决这一定义不明确的问题，同时满足三个标准：\n    1.  保持位置等变性。\n    2.  保持两点样本的对称性。\n    3.  相对于普通均值保持稳健性。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于既定的统计理论。Levene's检验、Brown–Forsythe修正、样本中位数的性质以及位置等变性、对称性和稳健性等概念都是统计学中的标准主题。对于偶数个数据点，中位数的模糊性是一个众所周知的数学性质。\n- **适定性：** 问题陈述首先描述了一个有效的统计程序，然后正确地指出了一个特定的边界情况 ($n_i=2$)，在该情况下程序定义不明确。如何解决这种模糊性是一个有意义且适定的统计问题。有效修改的标准已明确说明。\n- **客观性：** 问题以精确、客观和正式的语言陈述。没有主观或基于意见的声明。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它准确地描述了统计方法学中的一个合理问题，并要求一个有原则的解决方案。\n**结论：** 问题是**有效的**（VALID）。\n解决方案现在将首先确认问题的前提，然后根据所述标准评估每个选项。\n\n### 解题推导\n\n首先，我们确认前提：对于一个大小为 $n_i = 2$ 的样本 $\\{y_{i(1)}, y_{i(2)}\\}$，中位数的集合是区间 $[y_{i(1)}, y_{i(2)}]$，并且这导致了一个定义不明确的程序。\n\n设 $S(m) = \\sum_{j=1}^{2} \\lvert y_{i(j)} - m \\rvert = \\lvert y_{i(1)} - m \\rvert + \\lvert y_{i(2)} - m \\rvert$。我们旨在最小化此函数 $S(m)$。\n- 如果 $m  y_{i(1)}$，则 $S(m) = (y_{i(1)} - m) + (y_{i(2)} - m) = y_{i(1)} + y_{i(2)} - 2m$。导数 $S'(m) = -2$，因此 $S(m)$ 是递减的。\n- 如果 $m > y_{i(2)}$，则 $S(m) = (m - y_{i(1)}) + (m - y_{i(2)}) = 2m - y_{i(1)} - y_{i(2)}$。导数 $S'(m) = 2$，因此 $S(m)$ 是递增的。\n- 如果 $y_{i(1)} \\le m \\le y_{i(2)}$，则 $S(m) = (m - y_{i(1)}) + (y_{i(2)} - m) = y_{i(2)} - y_{i(1)}$，这是一个常数。\n\n$S(m)$ 的最小值因此是 $y_{i(2)} - y_{i(1)}$，对于任何 $m \\in [y_{i(1)}, y_{i(2)}]$ 都能达到。这证实了中位数的集合是所指定的区间。\n\n转换值为 $z_{i1} = \\lvert y_{i(1)} - m \\rvert = m - y_{i(1)}$ 和 $z_{i2} = \\lvert y_{i(2)} - m \\rvert = y_{i(2)} - m$。这些值显然依赖于 $m$ 的选择。例如，如果选择 $m$ 为 $y_{i(1)}$，这些值是 $\\{0, y_{i(2)} - y_{i(1)}\\}$。如果选择 $m$ 为中点 $(y_{i(1)} + y_{i(2)})/2$，这些值是 $\\{(y_{i(2)} - y_{i(1)})/2, (y_{i(2)} - y_{i(1)})/2\\}$。由于ANOVA的F统计量是根据这些 $z_{ij}$ 值计算的，因此检验结果不是唯一的。前提是正确的。\n\n我们现在根据三个标准评估每个选项：\n1.  **解决定义不明确问题**：当 $n_i=2$ 时，为 $c_i$ 提供一个唯一的、单一的值。\n2.  **位置等变性**：对于一个估计量 $T$，如果对于常数 $a$ 有 $y'_j = y_j + a$，则 $T(y') = T(y) + a$。\n3.  **对称性**：对于一个两点样本 $\\{y_1, y_2\\}$，估计量 $T(y_1, y_2)$ 在点被置换后应保持不变，即 $T(y_1, y_2) = T(y_2, y_1)$。“自然不变性”这一说法也暗示了无偏的选择，指向中点 $c_i = (y_1 + y_2)/2$ 作为理想的对称估计量。\n4.  **保持稳健性**：该修改不应使整个程序对异常值的稳健性显著低于原始的基于中位数的提议。\n\n**逐项分析**\n\n**A. 在任何样本量为 $n_i = 2$ 的组中，将 $c_i$ 定义为两个顺序统计量的中点，$c_i = \\left(y_{i(1)} + y_{i(2)}\\right)/2$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。中点为 $c_i$ 提供了一个单一的、唯一定义的值。\n2.  **位置等变性？** 是。令 $y'_{i(1)} = y_{i(1)} + a$ 和 $y'_{i(2)} = y_{i(2)} + a$。新的中心是 $c'_i = (y'_{i(1)} + y'_{i(2)})/2 = (y_{i(1)}+a + y_{i(2)}+a)/2 = (y_{i(1)} + y_{i(2)})/2 + a = c_i + a$。\n3.  **对称性？** 是。对于样本 $\\{y_1, y_2\\}$，中心是 $(y_1+y_2)/2$，这是两点样本的典型对称位置估计量。\n4.  **保持稳健性？** 是。对于 $n_i  2$，该程序仍然使用稳健的中位数。对于 $n_i=2$ 的特殊情况，它使用样本均值。对于大小为2的样本，均值、中位数（作为像中点这样的选定单点）和截尾均值之间没有区别。这个选择是可能的中位数区间中最自然的选择，并且不会损害该方法的整体稳健性，该稳健性是由其在所有样本量下的性能定义的。\n\n**结论：** 正确。这是处理此特定问题的标准和推荐方法。\n\n**B. 在任何样本量为 $n_i = 2$ 的组中，将 $c_i$ 定义为较小的观测值，$c_i = y_{i(1)}$，并使用 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。它为 $c_i$ 提供了一个唯一的值。\n2.  **位置等变性？** 是。$c'_i = y'_{i(1)} = y_{i(1)} + a = c_i + a$。\n3.  **对称性？** 否。估计量 $T(y_1, y_2) = \\min(y_1, y_2)$ 在置换下是对称的（$T(y_1, y_2) = T(y_2, y_1)$），但它没有以“自然”对称的方式对待这两个点。这是一个任意有偏的选择，总是选择较小的值。中心趋势估计量不应系统地偏向数据范围的一端。这违反了对称、中心估计量的精神。\n4.  **保持稳健性？** 该估计量是一个顺序统计量，它对一侧的异常值是稳健的，但对另一侧的异常值则极为敏感。它不是一个平衡的稳健中心趋势估计量。鉴于其在对称性上的失败，此选项不合适。\n\n**结论：** 不正确。它未能满足中心估计量的自然对称性要求。\n\n**C. 将每个组中的中位数替换为固定百分比的截尾均值（例如，$10\\%$ 截尾均值），因此 $c_i$ 是一个唯一的截尾均值，且 $z_{ij} = \\lvert y_{ij} - c_i \\rvert$。**\n1.  **解决定义不明确问题？** 是。对于任何样本量，截尾均值都是唯一定义的（根据标准统计软件的定义）。对于 $n_i=2$ 和任何修剪百分比 $\\alpha  50\\%$，从每端修剪的观测数量 $\\lfloor n_i \\alpha \\rfloor$ 为 0。因此，截尾均值就是常规的样本均值，$(y_{i(1)}+y_{i(2)})/2$，它是唯一的。\n2.  **位置等变性？** 是。截尾均值是顺序统计量的线性组合，因此它是位置等变的。\n3.  **对称性？** 是。对于 $n_i=2$，截尾均值是中点，它是对称的。对于任何 $n_i$，截尾均值是数据的对称函数。\n4.  **保持稳健性？** 是。截尾均值是一种经典的位置稳健估计量，常被用作中位数的替代品。它在均值的效率和中位数的稳健性之间提供了一种平衡。这是对Brown-Forsythe检验的一个完全有效的替代方案。\n\n**结论：** 正确。此修改不仅解决了 $n_i=2$ 的问题，而且对所有组大小都有效，并满足所有要求的标准。\n\n**D. 从Levene型检验中排除任何样本量为 $n_i = 2$ 的组，以使所有组的样本量都满足 $n_i \\ge 3$。**\n1.  **解决定义不明确问题？** 是，它通过从分析中移除有问题的案例来避免该问题。\n2.  **其他标准：** 这种修改是一种数据删除形式。虽然它在计算上“解决”了模糊性，但这是一种在统计上不合理的做法。它改变了被检验的假设（从比较所有$k$个组变为比较组的一个子集），并丢弃了可能宝贵的信息。一个有效的统计*程序*应该旨在处理数据，而不是在没有充分理由（例如，数据质量问题，这里并非如此）的情况下丢弃数据。这个选项没有提供方法上的修复，而是一种规避。从统计意义上说，它不是一个恰当的解决方案。\n\n**结论：** 不正确。这是糟糕的统计实践，它改变了科学问题的范围，而不是修正方法。\n\n**E. 使用从所有组合并计算的单一合并全局中位数 $\\tilde{y}$ 来计算 $z_{ij} = \\lvert y_{ij} - \\tilde{y} \\rvert$，而不是使用特定于组的中心。**\n1.  **解决定义不明确问题？** 是，一个单一的合并中位数 $\\tilde{y}$ 可以被唯一定义。\n2.  **其他标准：** 这种修改从根本上改变了检验的性质。Levene's检验的逻辑要求测量与*特定于组的*中心的偏差，以分离出组内的离散度（方差）。通过使用一个共同的中心 $\\tilde{y}$，转换值 $z_{ij}$ 现在将组内离散度与组中心和全局中心之间的距离混为一谈。对这些 $z_{ij}$ 值进行方差分析将对组均值的差异以及组方差的差异敏感。因此，它不再是一个有效的方差齐性检验。该检验也将失去其对单个组位置平移的不变性。\n\n**结论：** 不正确。此修改使该程序作为方差齐性检验无效。\n\n**总结**\n选项A和C都为 $n_i=2$ 时中位数的定义不明确问题提供了有效的解决方案。两个选项都为 $n_i=2$ 的情况提供了一个唯一的、对称的、位置等变的中心，并且都保持了整个检验程序的稳健性。",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}