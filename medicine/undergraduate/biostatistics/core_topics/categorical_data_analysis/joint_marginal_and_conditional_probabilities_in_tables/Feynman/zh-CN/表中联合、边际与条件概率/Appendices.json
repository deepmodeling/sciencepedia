{
    "hands_on_practices": [
        {
            "introduction": "本练习将引导你完成一项在生物统计学中至关重要的基本技能：检验两个分类变量之间的独立性。通过一个关于基因型和疾病状态的假设性研究，你将学习如何计算期望频数，并将其与观测频数进行比较，从而构建皮尔逊卡方检验。这个实践不仅能巩固你对联合概率和边际概率的理解，还能让你掌握评估分类数据关联性的核心方法。",
            "id": "4920920",
            "problem": "一项队列研究在一个基于人群的成年人样本中，检验了三水平种系变异状态与三阶段疾病状态之间的关联。设 $G \\in \\{G_{0}, G_{1}, G_{2}\\}$ 表示基因型类别（无、杂合、纯合风险），设 $S \\in \\{S_{0}, S_{1}, S_{2}\\}$ 表示疾病状态（无疾病、临床前期、临床期）。该研究记录了以下列联计数 $n_{ij}$，其中 $i$ 为基因型类别的索引，$j$ 为疾病状态的索引：\n- 对于 $G_{0}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(98, 35, 17)$。\n- 对于 $G_{1}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(72, 43, 35)$。\n- 对于 $G_{2}$：在 $(S_{0}, S_{1}, S_{2})$ 上的计数为 $(30, 28, 62)$。\n\n仅使用联合概率 $p_{ij}$、边际概率 $p_{i+}$ 和 $p_{+j}$ 的核心定义，以及独立性定义 $p_{ij} = p_{i+} p_{+j}$，为完整的 $3 \\times 3$ 表格构建 $G$ 与 $S$ 之间的大样本 Pearson 卡方独立性检验（即，不以任何协变量为条件）。具体来说，从经验边际数据推导出独立性模型下每个单元格的期望计数，然后通过将观测计数与这些期望计数进行比较来计算 Pearson 卡方检验统计量。\n\n该表的 Pearson 卡方检验统计量的数值是多少？将您的答案四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其有科学依据、提法恰当、客观且完整。\n\n**步骤1：提取已知信息**\n-   基因型变量 $G \\in \\{G_{0}, G_{1}, G_{2}\\}$。\n-   疾病状态变量 $S \\in \\{S_{0}, S_{1}, S_{2}\\}$。\n-   列联计数 $n_{ij}$，其中 $i \\in \\{0, 1, 2\\}$ 为基因型索引，$j \\in \\{0, 1, 2\\}$ 为疾病状态索引。\n-   $G_{0}$ 的计数：$(n_{00}, n_{01}, n_{02}) = (98, 35, 17)$。\n-   $G_{1}$ 的计数：$(n_{10}, n_{11}, n_{12}) = (72, 43, 35)$。\n-   $G_{2}$ 的计数：$(n_{20}, n_{21}, n_{22}) = (30, 28, 62)$。\n-   任务：构建 G 与 S 之间独立性的 Pearson 卡方检验统计量。\n\n**步骤2：使用提取的已知信息进行验证**\n该问题是生物统计学中涉及列联表分析的标准练习。所提供的数据由整数计数组成，这在此背景下是合适的。该任务要求应用基本统计定义：联合概率和边际概率、独立性，以及 Pearson 卡方统计量的构建。该问题是自洽的、科学上合理的且提法恰当。问题中没有矛盾、歧义或违背科学原理之处。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**解题推导**\n\n该问题要求计算一个 $3 \\times 3$ 观测计数列联表的 Pearson 卡方统计量。首先，我们将给定的计数（记为 $O_{ij}$）整理成一个表格，并计算边际总计。设 $i$ 为行索引（代表基因型 $G$），$j$ 为列索引（代表疾病状态 $S$）。\n\n观测计数 $O_{ij}$ 的表格如下：\n\n| | $S_0$ | $S_1$ | $S_2$ | 行总计 ($n_{i+}$) |\n| :--- | :---: | :---: | :---: | :---: |\n| **$G_0$** | 98 | 35 | 17 | 150 |\n| **$G_1$** | 72 | 43 | 35 | 150 |\n| **$G_2$** | 30 | 28 | 62 | 120 |\n| **列总计 ($n_{+j}$)** | **200** | **106** | **114** | **420** |\n\n行总计为：\n$n_{0+} = 98 + 35 + 17 = 150$\n$n_{1+} = 72 + 43 + 35 = 150$\n$n_{2+} = 30 + 28 + 62 = 120$\n\n列总计为：\n$n_{+0} = 98 + 72 + 30 = 200$\n$n_{+1} = 35 + 43 + 28 = 106$\n$n_{+2} = 17 + 35 + 62 = 114$\n\n受试者总数为 $N = 150 + 150 + 120 = 420$。\n\nPearson 卡方检验评估了原假设 $H_0$：即两个分类变量，基因型 $G$ 和疾病状态 $S$，是独立的。在此假设下，观测到一个个体在单元格 $(i, j)$ 中的联合概率是边际概率的乘积：$p_{ij} = p_{i+} p_{+j}$。\n\n我们从数据中估计这些边际概率：\n$\\hat{p}_{i+} = \\frac{n_{i+}}{N}$\n$\\hat{p}_{+j} = \\frac{n_{+j}}{N}$\n\n那么，在独立性假设下，每个单元格 $(i, j)$ 的期望计数 $E_{ij}$ 计算如下：\n$$E_{ij} = N \\times \\hat{p}_{i+} \\times \\hat{p}_{+j} = N \\left( \\frac{n_{i+}}{N} \\right) \\left( \\frac{n_{+j}}{N} \\right) = \\frac{n_{i+} n_{+j}}{N}$$\n\n使用此公式，我们计算所有 $9$ 个单元格的期望计数：\n$E_{00} = \\frac{150 \\times 200}{420} = \\frac{30000}{420} = \\frac{500}{7} \\approx 71.429$\n$E_{01} = \\frac{150 \\times 106}{420} = \\frac{15900}{420} = \\frac{265}{7} \\approx 37.857$\n$E_{02} = \\frac{150 \\times 114}{420} = \\frac{17100}{420} = \\frac{285}{7} \\approx 40.714$\n\n$E_{10} = \\frac{150 \\times 200}{420} = \\frac{30000}{420} = \\frac{500}{7} \\approx 71.429$\n$E_{11} = \\frac{150 \\times 106}{420} = \\frac{15900}{420} = \\frac{265}{7} \\approx 37.857$\n$E_{12} = \\frac{150 \\times 114}{420} = \\frac{17100}{420} = \\frac{285}{7} \\approx 40.714$\n\n$E_{20} = \\frac{120 \\times 200}{420} = \\frac{24000}{420} = \\frac{400}{7} \\approx 57.143$\n$E_{21} = \\frac{120 \\times 106}{420} = \\frac{12720}{420} = \\frac{212}{7} \\approx 30.286$\n$E_{22} = \\frac{120 \\times 114}{420} = \\frac{13680}{420} = \\frac{228}{7} \\approx 32.571$\n\nPearson 卡方检验统计量，记为 $\\chi^2$，定义为观测计数与期望计数之差的平方的总和，其中每一项再除以其期望计数：\n$$\\chi^2 = \\sum_{i=0}^{2} \\sum_{j=0}^{2} \\frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$\n\n我们现在计算和中的每一项：\n项 $(0,0)$: $\\frac{(98 - 71.429)^2}{71.429} = \\frac{(26.571)^2}{71.429} \\approx 9.8846$\n项 $(0,1)$: $\\frac{(35 - 37.857)^2}{37.857} = \\frac{(-2.857)^2}{37.857} \\approx 0.2156$\n项 $(0,2)$: $\\frac{(17 - 40.714)^2}{40.714} = \\frac{(-23.714)^2}{40.714} \\approx 13.8125$\n\n项 $(1,0)$: $\\frac{(72 - 71.429)^2}{71.429} = \\frac{(0.571)^2}{71.429} \\approx 0.0046$\n项 $(1,1)$: $\\frac{(43 - 37.857)^2}{37.857} = \\frac{(5.143)^2}{37.857} \\approx 0.6987$\n项 $(1,2)$: $\\frac{(35 - 40.714)^2}{40.714} = \\frac{(-5.714)^2}{40.714} \\approx 0.8020$\n\n项 $(2,0)$: $\\frac{(30 - 57.143)^2}{57.143} = \\frac{(-27.143)^2}{57.143} \\approx 12.8929$\n项 $(2,1)$: $\\frac{(28 - 30.286)^2}{30.286} = \\frac{(-2.286)^2}{30.286} \\approx 0.1725$\n项 $(2,2)$: $\\frac{(62 - 32.571)^2}{32.571} = \\frac{(29.429)^2}{32.571} \\approx 26.5890$\n\n将这些项相加得到 $\\chi^2$ 统计量：\n$\\chi^2 \\approx 9.8846 + 0.2156 + 13.8125 + 0.0046 + 0.6987 + 0.8020 + 12.8929 + 0.1725 + 26.5890$\n$\\chi^2 \\approx 65.0724$\n\n问题要求将结果四舍五入到四位有效数字。数值 $65.0724$ 四舍五入到四位有效数字是 $65.07$。",
            "answer": "$$\\boxed{65.07}$$"
        },
        {
            "introduction": "这个练习将挑战你对数据关联性的直观理解，通过一个经典的辛普森悖论案例，揭示混杂变量的强大影响。你将分析一项观察性研究的数据，其中一种疗法在不同虚弱程度的患者亚组中均显示有效，但总体分析却得出相反的结论。通过亲手计算分层和边际比值比（odds ratio），你将深刻体会到为何在生物统计学分析中，控制混杂因素是得出正确因果推断的关键一步。",
            "id": "4920952",
            "problem": "一项生物统计学中的观察性队列研究考察了一个二元暴露 $X \\in \\{0,1\\}$（其中 $X=1$ 表示接受治疗，$X=0$ 表示未接受治疗）、一个二元结局 $Y \\in \\{0,1\\}$（其中 $Y=1$ 表示康复，$Y=0$ 表示未康复），以及一个表示衰弱状态的二元测量混杂因素 $Z \\in \\{0,1\\}$（其中 $Z=0$ 表示低度衰弱，$Z=1$ 表示高度衰弱）。构建联合频率是为了在保持科学合理性的同时阐释辛普森悖论。观察到的分层数据如下。\n\n在分层 $Z=0$（低度衰弱）中：\n- 在 $X=1$ 的人群中：$Y=1$ 的计数为 $9$，$Y=0$ 的计数为 $1$。\n- 在 $X=0$ 的人群中：$Y=1$ 的计数为 $80$，$Y=0$ 的计数为 $20$。\n\n在分层 $Z=1$（高度衰弱）中：\n- 在 $X=1$ 的人群中：$Y=1$ 的计数为 $30$，$Y=0$ 的计数为 $20$。\n- 在 $X=0$ 的人群中：$Y=1$ 的计数为 $5$，$Y=0$ 的计数为 $15$。\n\n仅使用联合概率、条件概率和边际概率的基本定义、全概率定律以及几率和比值比（OR）的定义，执行以下任务：\n\n- 任务 $1$：对于每个分层 $z \\in \\{0,1\\}$，计算比较 $X=1$ 与 $X=0$ 的特定分层比值比 $OR_{z}$，并验证 $OR_{z}>1$。\n- 任务 $2$：跨 $Z$ 进行汇总，使用整个样本计算比较 $X=1$ 与 $X=0$ 的合并边际比值比，并确认尽管特定分层的比值比都超过 $1$，但该值小于 $1$。\n- 任务 $3$：根据 $p(Z \\mid X)$ 如何通过全概率定律进入边际化过程，解释为什么合并关联的方向会反转，而层内关联却没有，并讨论混杂情况下的因果解释。\n\n将任务 $2$ 中的合并边际比值比表示为精确分数；不要四舍五入。最终答案不需要物理单位。",
            "solution": "在进行解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知信息\n- 二元暴露 $X \\in \\{0,1\\}$，其中 $X=1$ 是治疗，$X=0$ 是不治疗。\n- 二元结局 $Y \\in \\{0,1\\}$，其中 $Y=1$ 是康复，$Y=0$ 是不康复。\n- 二元混杂因素 $Z \\in \\{0,1\\}$，其中 $Z=0$ 是低度衰弱，$Z=1$ 是高度衰弱。\n- 分层 $Z=0$ 中的联合频率：\n  - $X=1, Y=1$ 的计数为 $9$。\n  - $X=1, Y=0$ 的计数为 $1$。\n  - $X=0, Y=1$ 的计数为 $80$。\n  - $X=0, Y=0$ 的计数为 $20$。\n- 分层 $Z=1$ 中的联合频率：\n  - $X=1, Y=1$ 的计数为 $30$。\n  - $X=1, Y=0$ 的计数为 $20$。\n  - $X=0, Y=1$ 的计数为 $5$。\n  - $X=0, Y=0$ 的计数为 $15$。\n- 任务 $1$：计算 $z \\in \\{0,1\\}$ 的特定分层比值比 $OR_{z}$ 并验证 $OR_z > 1$。\n- 任务 $2$：计算合并边际比值比并确认其小于 $1$。\n- 任务 $3$：根据 $p(Z \\mid X)$ 解释悖论性反转并讨论因果解释。\n- 最终答案要求：任务 $2$ 的合并边际比值比表示为精确分数。\n\n### 步骤2：使用提取的已知信息进行验证\n- **科学依据：** 该问题阐释了辛普森悖论，这是统计学和流行病学中一个公认的现象。变量及其关系（指征混杂）在生物统计学背景下具有科学合理性。\n- **良态问题：** 该问题提供了执行所需计算的所有必要数据（联合频率计数）。任务定义清晰，几率和比值比的定义是标准的，确保了解决方案的唯一性和意义。\n- **客观性：** 问题陈述使用精确、客观、正式的语言，没有主观论断或歧义。\n- **结论：** 该问题自成体系、一致且科学合理。被判定为有效。\n\n### 解答\n设 $N(x,y,z)$ 表示暴露 $X=x$、结局 $Y=y$、混杂因素状态 $Z=z$ 的受试者计数。所提供的数据可以整理成两个列联表，每个对应一个 $Z$ 的分层。\n\n对于分层 $Z=0$（低度衰弱）：\n| | $Y=1$ (康复) | $Y=0$ (未康复) | 总计 |\n|---|---|---|---|\n| $X=1$ (治疗) | $9$ | $1$ | $10$ |\n| $X=0$ (未治疗) | $80$ | $20$ | $100$ |\n\n对于分层 $Z=1$（高度衰弱）：\n| | $Y=1$ (康复) | $Y=0$ (未康复) | 总计 |\n|---|---|---|---|\n| $X=1$ (治疗) | $30$ | $20$ | $50$ |\n| $X=0$ (未治疗) | $5$ | $15$ | $20$ |\n\n**任务 1：特定分层的比值比**\n\n在特定分层 $z$ 内，对于给定的暴露水平 $x$，康复（$Y=1$）的几率定义为 $Odds(Y=1 \\mid X=x, Z=z) = \\frac{p(Y=1 \\mid X=x, Z=z)}{p(Y=0 \\mid X=x, Z=z)}$。由于在定义的子组内，概率与频率成正比，我们可以直接使用计数：\n$$Odds(Y=1 \\mid X=x, Z=z) = \\frac{N(x,1,z)}{N(x,0,z)}$$\n特定分层的比值比 $OR_z$ 比较了该分层内治疗组（$X=1$）与未治疗组（$X=0$）的康复几率：\n$$OR_z = \\frac{Odds(Y=1 \\mid X=1, Z=z)}{Odds(Y=1 \\mid X=0, Z=z)} = \\frac{N(1,1,z) / N(1,0,z)}{N(0,1,z) / N(0,0,z)} = \\frac{N(1,1,z) \\cdot N(0,0,z)}{N(1,0,z) \\cdot N(0,1,z)}$$\n\n对于分层 $Z=0$（低度衰弱）：\n治疗组的康复几率为 $Odds(Y=1 \\mid X=1, Z=0) = \\frac{9}{1} = 9$。\n未治疗组的康复几率为 $Odds(Y=1 \\mid X=0, Z=0) = \\frac{80}{20} = 4$。\n特定分层的比值比为：\n$$OR_0 = \\frac{9}{4} = 2.25$$\n按要求，$OR_0 = 2.25 > 1$。这表明在低度衰弱的个体中，与不接受治疗相比，接受治疗的康复几率是其 $2.25$ 倍。\n\n对于分层 $Z=1$（高度衰弱）：\n治疗组的康复几率为 $Odds(Y=1 \\mid X=1, Z=1) = \\frac{30}{20} = \\frac{3}{2} = 1.5$。\n未治疗组的康复几率为 $Odds(Y=1 \\mid X=0, Z=1) = \\frac{5}{15} = \\frac{1}{3}$。\n特定分层的比值比为：\n$$OR_1 = \\frac{3/2}{1/3} = \\frac{3}{2} \\cdot 3 = \\frac{9}{2} = 4.5$$\n按要求，$OR_1 = 4.5 > 1$。这表明在高度衰弱的个体中，与不接受治疗相比，接受治疗的康复几率是其 $4.5$ 倍。在两个分层中，治疗都显示出益处。\n\n**任务 2：合并边际比值比**\n\n为计算合并边际比值比，我们首先跨 $Z$ 的分层汇总计数，形成一个关于 $X$ 和 $Y$ 的边际表。\n- $N(X=1, Y=1) = N(1,1,0) + N(1,1,1) = 9 + 30 = 39$\n- $N(X=1, Y=0) = N(1,0,0) + N(1,0,1) = 1 + 20 = 21$\n- $N(X=0, Y=1) = N(0,1,0) + N(0,1,1) = 80 + 5 = 85$\n- $N(X=0, Y=0) = N(0,0,0) + N(0,0,1) = 20 + 15 = 35$\n\n汇总后的列联表为：\n| | $Y=1$ (康复) | $Y=0$ (未康复) |\n|---|---|---|\n| $X=1$ (治疗) | $39$ | $21$ |\n| $X=0$ (未治疗) | $85$ | $35$ |\n\n合并边际比值比 $OR_{marginal}$ 是根据此汇总表计算得出的：\n$$OR_{marginal} = \\frac{N(X=1,Y=1) \\cdot N(X=0,Y=0)}{N(X=1,Y=0) \\cdot N(X=0,Y=1)} = \\frac{39 \\cdot 35}{21 \\cdot 85}$$\n为了简化分数：\n$$OR_{marginal} = \\frac{(3 \\cdot 13) \\cdot (5 \\cdot 7)}{(3 \\cdot 7) \\cdot (5 \\cdot 17)} = \\frac{3 \\cdot 5 \\cdot 7 \\cdot 13}{3 \\cdot 5 \\cdot 7 \\cdot 17} = \\frac{13}{17}$$\n我们确认 $OR_{marginal} = \\frac{13}{17}  1$。这就是悖论所在：边际分析表明治疗与较低的康复几率相关，这与特定分层的发现直接矛盾。\n\n**任务 3：解释与因果解释**\n\n关联的反转是辛普森悖论的一个标志性特征，它是由混杂效应引起的。在这里，衰弱（$Z$）是一个混杂因素，因为它既与暴露（治疗，$X$）相关，也与结局（康复，$Y$）相关。\n\n根据全概率定律，结局的边际概率是混杂因素各分层中条件概率的加权平均值：\n$$p(Y=y \\mid X=x) = \\sum_{z \\in \\{0,1\\}} p(Y=y \\mid X=x, Z=z) \\cdot p(Z=z \\mid X=x)$$\n悖论的产生是因为权重因子 $p(Z=z \\mid X=x)$ 对于治疗组（$X=1$）和未治疗组（$X=0$）存在显著差异。\n\n我们来计算这些权重：\n- 对于治疗组（$X=1$），受试者总数为 $N(X=1) = 10 + 50 = 60$。\n  - $p(Z=1 \\mid X=1) = \\frac{N(X=1, Z=1)}{N(X=1)} = \\frac{50}{60} = \\frac{5}{6}$\n- 对于未治疗组（$X=0$），受试者总数为 $N(X=0) = 100 + 20 = 120$。\n  - $p(Z=1 \\mid X=0) = \\frac{N(X=0, Z=1)}{N(X=0)} = \\frac{20}{120} = \\frac{1}{6}$\n\n这表明 $Z$ 和 $X$ 之间存在强关联：治疗组主要由高度衰弱的个体组成（$p(Z=1|X=1) = 5/6$），而未治疗组主要由低度衰弱的个体组成（$p(Z=0|X=0) = 100/120 = 5/6$）。这是一个经典的“指征混杂”例子，即病情较重（衰弱程度较高）的患者更可能接受治疗。\n\n此外，衰弱与结局也密切相关。无论是否接受治疗，高度衰弱分层（$Z=1$）的康复概率远低于低度衰弱分层（$Z=0$）。\n- $p(Y=1 \\mid X=1, Z=0) = 9/10 = 0.9$ 对比 $p(Y=1 \\mid X=1, Z=1) = 30/50 = 0.6$\n- $p(Y=1 \\mid X=0, Z=0) = 80/100 = 0.8$ 对比 $p(Y=1 \\mid X=0, Z=1) = 5/20 = 0.25$\n\n治疗组的边际康复概率 $p(Y=1 \\mid X=1)$ 是特定分层概率 $p(Y=1 \\mid X=1, Z=0)=0.9$ 和 $p(Y=1 \\mid X=1, Z=1)=0.6$ 的加权平均值。由于治疗组大多为高度衰弱，这个平均值被严重地加权到了较低的概率（$0.6$）上，导致总体康复率较低：$p(Y=1 \\mid X=1) = (0.9)\\frac{1}{6} + (0.6)\\frac{5}{6} = 0.15 + 0.5 = 0.65$。\n\n相反，未治疗组的边际康复概率 $p(Y=1 \\mid X=0)$ 是 $p(Y=1 \\mid X=0, Z=0)=0.8$ 和 $p(Y=1 \\mid X=0, Z=1)=0.25$ 的加权平均值。由于未治疗组大多为低度衰弱，这个平均值被严重地加权到了较高的概率（$0.8$）上，导致总体康复率较高：$p(Y=1 \\mid X=0) = (0.8)\\frac{5}{6} + (0.25)\\frac{1}{6} \\approx 0.708$。\n\n**因果解释：** 边际比值比（$OR_{marginal}  1$）不是治疗因果效应的有效估计。它因衰弱的混杂效应而存在偏倚。这种比较是不公平的，因为它将未接受治疗的健康人群与接受了治疗的衰弱人群合并在一起。分层比值比 $OR_0$ 和 $OR_1$ 通过保持混杂因素恒定来对其进行控制。由于两者都大于 $1$，它们表明该疗法对低度衰弱和高度衰弱的患者均有益。因此，基于这些数据得出的因果结论是，该疗法是有效的。边际结果是一个统计假象。",
            "answer": "$$\\boxed{\\frac{13}{17}}$$"
        },
        {
            "introduction": "在处理真实世界的生物统计数据时，我们经常会遇到数据稀疏或某些类别没有观测样本的情况。本练习通过一个具体的案例，引导你思考一个根本性问题：当条件事件的概率为零时，我们该如何理解条件概率？通过辨析关于零计数单元格的不同陈述，你将加深对条件概率定义的理解，并认识到“正定性假设”（positivity assumption）在统计建模和因果推断中的重要性。",
            "id": "4920943",
            "problem": "一项生物统计监测研究记录了一个具有三个类别 $i \\in \\{1,2,3\\}$ 的暴露变量 $X$ 和一个具有两个水平 $j \\in \\{0,1\\}$ 的二元结局 $Y$。观测到的双向列联表计数 $n_{ij}$ 如下：\n- $n_{10} = 36$， $n_{11} = 9$，\n- $n_{20} = 24$， $n_{21} = 6$，\n- $n_{30} = 0$， $n_{31} = 0$。\n\n设总样本量为 $N = 75$，因此经验联合概率为 $\\hat p_{ij} = n_{ij}/N$，经验行边缘概率为 $\\hat p_{i+} = \\sum_{j} \\hat p_{ij}$，经验列边缘概率为 $\\hat p_{+j} = \\sum_{i} \\hat p_{ij}$。在列联表的联合概率、边缘概率和条件概率的标准定义下，考虑当行边缘概率 $p_{i+}$ 等于 $0$ 时，条件概率 $P(Y=j \\mid X=i)$ 的状态。以上述表格为具体情境，判断下列哪些陈述是正确的。选择所有适用项。\n\nA. $P(Y=j \\mid X=3)$ 是未定义的，因为 $p_{3+} = 0$；条件概率的定义不允许对零概率事件取条件。在实践中，如果不引入外部模型假设、平滑处理或重新定义类别以确保概率为正，就无法进行以 $X=3$ 为条件的条件分析。\n\nB. 因为 $n_{3+} = 0$，正确的约定是对所有 $j$，$P(Y=j \\mid X=3) = 0$。通过这种赋值，以 $X=3$ 为条件的条件分析仍然有效。\n\nC. 已定义分层的估计条件概率为 $P(Y=1 \\mid X=1) = 9/45$ 和 $P(Y=1 \\mid X=2) = 6/30$，并且根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$。\n\nD. 如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$，因此 $P(Y=j \\mid X=i)$ 是未定义的。在基于模型的分析中（例如，逻辑斯蒂回归或分层风险估计），涉及 $X=i$ 的参数或特定分层的风险是不可识别的，除非施加约束、进行信息借力或使用先验信息；这是违反正性（重叠）假设的一种体现。\n\nE. 零行边缘概率强制 $P(Y=j \\mid X=i) = P(Y=j)$，因为对不可能事件取条件不会改变分布，条件概率会简化为边缘概率。",
            "solution": "用户希望我验证问题陈述，然后提供详细的解决方案。\n\n### 步骤1：提取给定信息\n- 一个暴露变量 $X$ 有三个类别，索引为 $i \\in \\{1, 2, 3\\}$。\n- 一个二元结局变量 $Y$ 有两个水平，索引为 $j \\in \\{0, 1\\}$。\n- 给定一个观测计数的双向列联表 $n_{ij}$：\n  - $n_{10} = 36$, $n_{11} = 9$\n  - $n_{20} = 24$, $n_{21} = 6$\n  - $n_{30} = 0$, $n_{31} = 0$\n- 总样本量为 $N = 75$。\n- 经验联合概率定义为 $\\hat p_{ij} = n_{ij}/N$。\n- 经验行边缘概率定义为 $\\hat p_{i+} = \\sum_{j} \\hat p_{ij}$。\n- 经验列边缘概率定义为 $\\hat p_{+j} = \\sum_{i} \\hat p_{ij}$。\n- 问题的核心是，利用给定的数据作为具体例子，评估当相应的行边缘概率 $p_{i+}$ 为零时，条件概率 $P(Y=j \\mid X=i)$ 的状态。\n\n### 步骤2：使用提取的给定信息进行验证\n根据既定标准评估问题陈述。\n\n- **科学基础**：该问题牢固地植根于基础概率论及其在生物统计学中的应用，特别是关于列联表分析。问题探讨了条件概率的基本定义以及处理数据中零计数的实际问题，这是一个标准课题。所涉及的原理在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了分析情况所需的所有数据和定义。数据内部一致：给定计数的总和为 $n_{10} + n_{11} + n_{20} + n_{21} + n_{30} + n_{31} = 36 + 9 + 24 + 6 + 0 + 0 = 75$，与给定的总样本量 $N=75$ 相符。问题要求评估几个陈述，这些陈述的正确与否可以根据数学和统计学原理明确地确定。\n- **客观性**：问题以精确、客观且无歧义的语言陈述。它使用标准的数学和统计符号。\n\n问题没有表现出说明中列出的任何缺陷（例如，科学上不合理、信息缺失、含糊不清）。在实践中，某个类别没有观测值的情况很常见，这会导致统计分析中重要且非平凡的考虑。\n\n### 步骤3：结论和行动\n问题陈述是 **有效的**。开始进行解答。\n\n### 解答推导\n\n事件 $A$ 在给定事件 $B$ 的条件下的条件概率的基本定义是\n$$ P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)} $$\n该定义仅在 $P(B)  0$ 时有效。如果 $P(B) = 0$，则条件概率是未定义的。\n\n在给定问题的背景下，我们感兴趣的是给定暴露类别 $X=i$ 时，结局为 $Y=j$ 的条件概率。这表示为：\n$$ P(Y=j \\mid X=i) = \\frac{P(Y=j, X=i)}{P(X=i)} $$\n使用问题陈述中的符号，这对应于：\n$$ P(Y=j \\mid X=i) = \\frac{p_{ij}}{p_{i+}} $$\n问题提供了样本计数 $n_{ij}$，我们用它来计算经验概率（用帽子符号 $\\hat p$ 表示）。总样本量为 $N=75$。我们被要求考虑行边缘概率为零的情况，特别是对于 $i=3$。\n\n首先，我们计算行总和与经验行边缘概率：\n- 对于 $i=1$：$n_{1+} = n_{10} + n_{11} = 36 + 9 = 45$。经验边缘概率为 $\\hat p_{1+} = 45/75 = 3/5$。\n- 对于 $i=2$：$n_{2+} = n_{20} + n_{21} = 24 + 6 = 30$。经验边缘概率为 $\\hat p_{2+} = 30/75 = 2/5$。\n- 对于 $i=3$：$n_{3+} = n_{30} + n_{31} = 0 + 0 = 0$。经验边缘概率为 $\\hat p_{3+} = 0/75 = 0$。\n\n问题聚焦于分层 $X=3$ 的条件概率。对于该分层，条件事件 $\\{X=3\\}$ 的经验概率为 $\\hat p_{3+} = 0$。涉及该分层的联合概率也为零：\n- $\\hat p_{30} = n_{30}/N = 0/75 = 0$。\n- $\\hat p_{31} = n_{31}/N = 0/75 = 0$。\n\n现在，我们尝试计算经验条件概率 $\\hat P(Y=j \\mid X=3)$：\n$$ \\hat P(Y=j \\mid X=3) = \\frac{\\hat p_{3j}}{\\hat p_{3+}} = \\frac{0}{0} $$\n这个表达式是 $0$ 除以 $0$ 的比值，这在数学上是不确定的和未定义的。因此，根据条件概率的标准定义，无法从给定数据中计算出 $P(Y=j \\mid X=3)$。\n\n基于此，我们评估给出的每个选项。\n\n### 逐项分析\n\n**A. $P(Y=j \\mid X=3)$ 是未定义的，因为 $p_{3+} = 0$；条件概率的定义不允许对零概率事件取条件。在实践中，如果不引入外部模型假设、平滑处理或重新定义类别以确保概率为正，就无法进行以 $X=3$ 为条件的条件分析。**\n\n这个陈述准确地反映了数学情况及其实际后果。\n- 第一部分正确地指出，条件概率是未定义的，因为条件事件的概率为零（$p_{3+}=0$）。这直接源于定义 $P(A \\mid B) = P(A \\cap B)/P(B)$，该定义要求 $P(B)0$。\n- 第二部分正确地描述了统计实践中处理零计数单元的常用补救措施。当我们由于缺乏数据而无法计算特定于分层的估计时，我们必须采取以下方法：\n    - **建模**：假设一个参数模型（例如，逻辑斯蒂回归），该模型关联不同分层间的结局。这允许“借力”，但依赖于模型设定的正确性。\n    - **平滑**：向所有单元格添加小的伪计数（例如，带有先验的贝叶斯方法，或简单的连续性校正，如添加 $0.5$），以确保所有边缘概率为正。\n    - **重新定义类别**：将零计数的类别与相邻类别合并，假设它们足够相似。\n这个陈述是对该问题的完整而准确的总结。\n**结论：正确。**\n\n**B. 因为 $n_{3+} = 0$，正确的约定是对所有 $j$，$P(Y=j \\mid X=3) = 0$。通过这种赋值，以 $X=3$ 为条件的条件分析仍然有效。**\n\n这个陈述提出了一个约定。对于任何固定的条件（例如，$X=3$），所有可能结局的条件概率之和必须为 $1$。这是概率论的一个基本公理：对于任何给定的 $i$，$\\sum_j P(Y=j \\mid X=i) = 1$。\n如果我们采纳对所有 $j \\in \\{0, 1\\}$，$P(Y=j \\mid X=3) = 0$ 的约定，那么总和将是：\n$$ P(Y=0 \\mid X=3) + P(Y=1 \\mid X=3) = 0 + 0 = 0 $$\n由于 $0 \\neq 1$，这个约定违反了概率论的基本法则。因此，它不是一个“正确的约定”，并且会使后续分析无效，而不是有效。\n**结论：不正确。**\n\n**C. 已定义分层的估计条件概率为 $P(Y=1 \\mid X=1) = 9/45$ 和 $P(Y=1 \\mid X=2) = 6/30$，并且根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$。**\n\n陈述的第一部分正确地计算了分层 $1$ 和 $2$ 的经验条件概率：\n- $\\hat P(Y=1 \\mid X=1) = n_{11} / n_{1+} = 9/45 = 1/5$。\n- $\\hat P(Y=1 \\mid X=2) = n_{21} / n_{2+} = 6/30 = 1/5$。\n然而，关于 $X=3$ 情况的推理是错误的。它声称“根据分母为 $0$ 时比率的连续性，$P(Y=1 \\mid X=3) = 0$”。对于 $X=3$ 的比率是 $\\hat p_{31} / \\hat p_{3+} = 0/0$。在微积分中，$0/0$ 的形式是不定式。当 $f(x) \\to 0$ 且 $g(x) \\to 0$ 时，比率 $f(x)/g(x)$ 的极限可以是任何值，或者可能不存在。没有普遍的“比率连续性”原则会将 $0/0$ 表达式赋值为 $0$。这个推理在数学上是不合理的。\n**结论：不正确。**\n\n**D. 如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$，因此 $P(Y=j \\mid X=i)$ 是未定义的。在基于模型的分析中（例如，逻辑斯蒂回归或分层风险估计），涉及 $X=i$ 的参数或特定分层的风险是不可识别的，除非施加约束、进行信息借力或使用先验信息；这是违反正性（重叠）假设的一种体现。**\n\n这个陈述提供了详细且技术上精确的说明。\n- “如果 $p_{i+} = 0$，那么对所有 $j$ 都有 $p_{ij} = 0$”：这是正确的。因为 $p_{i+} = \\sum_j p_{ij}$ 并且联合概率 $p_{ij}$ 是非负的，所以只有当和中的每一项都为零时，和才能为零。\n- “...因此 $P(Y=j \\mid X=i)$ 是未定义的”：如前所述，比率 $p_{ij}/p_{i+}$ 变为 $0/0$，这是未定义的。这是正确的。\n- 陈述的其余部分正确地解释了其对统计建模的影响。不可识别性是描述无法从数据中估计参数的精确术语。如果没有 $X=3$ 的受试者，就没有数据可以为描述 $X=3$ 效应的任何参数（例如，回归模型中的系数）提供信息。\n- 最后，它正确地将此问题识别为违反“正性假设”（在因果推断中也称为重叠或共同支撑假设），该假设要求总体中每个个体都以非零概率属于任何给定的暴露/处理组，即对所有 $i$，$P(X=i)  0$。在我们的样本中，经验概率 $\\hat P(X=3)=0$，表明数据中缺乏对该假设的支持。\n这个陈述完全正确。\n**结论：正确。**\n\n**E. 零行边缘概率强制 $P(Y=j \\mid X=i) = P(Y=j)$，因为对不可能事件取条件不会改变分布，条件概率会简化为边缘概率。**\n\n这个陈述声称，如果 $p_{i+} = 0$，那么对 $X=i$ 取条件等价于独立性。事件 $A=\\{Y=j\\}$ 和 $B=\\{X=i\\}$ 之间独立性的条件是 $P(A \\cap B) = P(A)P(B)$。给定 $P(B)=p_{i+}=0$，我们有 $P(A \\cap B) = p_{ij} = 0$（如对D的分析所示）。独立性方程变为 $0 = P(A) \\cdot 0$，这对任何 $P(A)$ 都成立。所以，从技术上讲，概率为零的事件与任何其他事件都是独立的。\n然而，这并不意味着 $P(A \\mid B) = P(A)$。后一个公式是独立性的一个*推论*，它仅在 $P(B)  0$ 时有效，因为它是从 $P(A \\cap B) / P(B) = P(A)$ 推导出来的，这需要除以 $P(B)$。“对不可能事件取条件不会改变分布”的基本前提不是概率论的标准公理或定理；事实上，在这个基本框架中，对零概率事件取条件根本没有定义。该选项做出了一个无效的逻辑跳跃。\n**结论：不正确。**\n\n### 总结\n陈述 A 和 D 都是正确的。它们从略有不同但互补的角度描述了同一个核心问题。陈述 A 概述了问题和实际解决方案，而陈述 D 在统计建模的背景下提供了更技术性的解释，引入了“可识别性”和“正性”等关键术语。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}