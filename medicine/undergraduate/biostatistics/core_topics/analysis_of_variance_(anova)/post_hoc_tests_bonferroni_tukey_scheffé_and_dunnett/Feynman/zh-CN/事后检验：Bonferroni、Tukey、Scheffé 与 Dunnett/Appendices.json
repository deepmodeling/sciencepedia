{
    "hands_on_practices": [
        {
            "introduction": "在着手校正多重比较带来的统计问题之前，我们首先需要量化这个问题的规模。此练习引导你从最基本的组合学原理出发，推导出一个计算成对比较次数的关键公式 。通过这个过程，你将直观地感受到为何随着研究中分组数量的增加，进行多重比较校正变得至关重要。",
            "id": "4938861",
            "problem": "一位生物统计学家在一项关于降压药的随机临床研究中，对 $k$ 个独立的治疗组进行单因素方差分析。在发现一个统计上显著的总体结果后，该生物统计学家计划应用多重比较程序，例如 Tukey 诚实显著性差异 (HSD) 检验和 Bonferroni 方法，这些程序需要计算组间不同成对均值比较的数量来校准族系错误率 (FWER)。\n\n仅使用基本计数原理和成对比较的定义（即两个不同组均值之间的无序比较，排除自我比较，且组 $A$ 与组 $B$ 的比较等同于组 $B$ 与组 $A$ 的比较），推导不同成对均值比较总数作为 $k$ 的函数的解析表达式。然后，计算当 $k=7$ 时这个数值。\n\n将最终答案表示为单个实数。无需四舍五入。",
            "solution": "问题要求推导一个计算 $k$ 个组之间不同成对比较数量的通用公式，并在 $k=7$ 的特定情况下计算这个数量。问题陈述为成对比较提供了一个精确的定义：两个不同组均值之间的无序比较。\n\n设 $k$ 个治疗组的集合表示为 $G = \\{G_1, G_2, \\dots, G_k\\}$。一次成对比较涉及从这个集合中选择两个不同的组。比较是“无序”的这个条件意味着组 $G_i$ 和组 $G_j$ 之间的比较与组 $G_j$ 和组 $G_i$ 之间的比较是相同的。组必须是“不同”的这个条件意味着 $i \\neq j$，这实际上排除了像 $G_i$ 与 $G_i$ 这样的自我比较。\n\n这个问题是一个经典的组合问题，即从一个大小为 $k$ 的集合中选择一个大小为 $2$ 的子集。从一个包含 $n$ 个元素的集合中不考虑选择顺序地选择 $r$ 个元素的方法数，由二项式系数给出，记为 $\\binom{n}{r}$。\n\n在我们特定的情境中，我们是从一个包含 $n=k$ 个组的集合中选择 $r=2$ 个组。因此，不同成对比较的总数（我们可以用 $C$ 表示）由下式给出：\n$$ C = \\binom{k}{2} $$\n\n二项式系数的公式是：\n$$ \\binom{n}{r} = \\frac{n!}{r!(n-r)!} $$\n将 $n=k$ 和 $r=2$ 代入，我们得到 $C$ 作为 $k$ 的函数的解析表达式：\n$$ C(k) = \\binom{k}{2} = \\frac{k!}{2!(k-2)!} $$\n\n我们可以通过将阶乘项 $k!$ 展开为 $k \\times (k-1) \\times (k-2)!$ 来简化这个表达式：\n$$ C(k) = \\frac{k(k-1)(k-2)!}{2!(k-2)!} $$\n分子和分母中的 $(k-2)!$ 项相互抵消。由于 $2! = 2 \\times 1 = 2$，表达式简化为：\n$$ C(k) = \\frac{k(k-1)}{2} $$\n这就是所要求的、表示不同成对均值比较总数的解析表达式。\n\n这个结果也可以从基本计数原理推导出来。为了组成一对不同的组，我们首先从 $k$ 个可用组中选择一个组。第一次选择有 $k$ 种选择。选择一个组后，还剩下 $k-1$ 个组可供选择第二个组。这似乎表明有 $k(k-1)$ 种可能的配对。然而，这个过程计算的是有序对。例如，它将对 $(G_1, G_2)$ 和对 $(G_2, G_1)$ 计为不同的。问题陈述指明比较是无序的，意味着组 $A$ 与组 $B$ 的比较和组 $B$ 与组 $A$ 的比较是相同的。由于在有序计数过程中，每一对不同的组都被精确地计算了两次（一次是 $(G_i, G_j)$，一次是 $(G_j, G_i)$），我们必须将有序对的总数除以 $2$，以得到唯一的、无序的对的数量。\n$$ C(k) = \\frac{k(k-1)}{2} $$\n这证实了我们之前使用二项式系数的推导。\n\n问题的第二部分要求计算在一个有 $k=7$ 个治疗组的研究中这个数值。我们将 $k=7$ 代入我们推导出的公式中：\n$$ C(7) = \\frac{7(7-1)}{2} $$\n$$ C(7) = \\frac{7 \\times 6}{2} $$\n$$ C(7) = \\frac{42}{2} $$\n$$ C(7) = 21 $$\n\n因此，对于一个有 $7$ 个治疗组的研究，在进行如 Tukey HSD 检验等事后分析或应用 Bonferroni 校正时，需要考虑 $21$ 种不同的成对均值比较。",
            "answer": "$$\\boxed{21}$$"
        },
        {
            "introduction": "Bonferroni 校正法是控制族系误差率（FWER）最直接、最通用的方法。这个练习不仅仅是简单地应用公式，它要求你从概率论的联合界（union bound）这一基本原理出发，亲自推导 Bonferroni 校正的逻辑 。通过将此方法应用于一组假设的 $p$ 值，你将获得在多重检验场景下做出严谨统计决策的实践经验。",
            "id": "4938829",
            "problem": "一项生物统计学研究使用单因素方差分析 (ANOVA) 比较 $k$ 个治疗组的平均血清生物标志物水平。使用双样本$t$检验对所有组进行事后成对比较，得出所有成对比较集合的 $m=10$ 个原始$p$值：$p=(0.001,\\,0.02,\\,0.07,\\,0.11,\\,0.23,\\,0.045,\\,0.0045,\\,0.39,\\,0.003,\\,0.12)$。研究者希望将这 $m$ 个比较的族系误差率 (FWER) 控制在 $\\alpha=0.05$ 的水平。从概率的联合界和FWER的定义出发，推导用于 $m$ 个同时检验的Bonferroni族系控制方法以及相应的校正$p$值映射。然后将此校正应用于给定的原始$p$值，并确定在 $\\alpha=0.05$ 水平下被拒绝的成对原假设的总数。最终数值答案仅报告拒绝的总数。无需四舍五入。基于第一性原理，简要说明为什么在这种情况下，与Tukey、Scheffé或Dunnett程序相比，Bonferroni方法是适用的，并且在问题陈述中不使用任何快捷公式。",
            "solution": "问题要求推导用于控制族系误差率 (FWER) 的Bonferroni校正，将其应用于一组给定的$p$值，计算由此产生的拒绝次数，并说明其使用的理由。\n\n首先，我们从第一性原理推导Bonferroni校正。假设有一族 $m$ 个原假设，记为 $H_{0,i}$，其中 $i \\in \\{1, 2, \\dots, m\\}$。族系误差率 (FWER) 定义为犯至少一次I类错误的概率。I类错误是拒绝一个真实的原假设的事件。令 $I_0$ 为索引集合 $\\{1, 2, \\dots, m\\}$ 中对应原假设 $H_{0,i}$ 为真的子集。则FWER为：\n$$\n\\text{FWER} = P\\left(\\bigcup_{i \\in I_0} \\{\\text{reject } H_{0,i}\\}\\right)\n$$\n由于在实际实验环境中集合 $I_0$ 是未知的，我们通过界定拒绝 $m$ 个假设中任意一个的概率来控制FWER，这是对真实FWER的一个保守上界：\n$$\n\\text{FWER} \\le P\\left(\\bigcup_{i=1}^{m} \\{\\text{reject } H_{0,i}\\}\\right)\n$$\n我们引用联合界，也称为Boole不等式，该不等式指出，对于任意事件集合 $A_1, A_2, \\dots, A_m$，其并集的概率小于或等于它们各自概率的总和：$P(\\cup_{i=1}^m A_i) \\le \\sum_{i=1}^m P(A_i)$。将此应用于FWER上界的表达式，其中 $A_i$ 是事件 {拒绝 $H_{0,i}$}：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{m} P(\\text{reject } H_{0,i})\n$$\n对于单个假设检验 $i$，如果其关联的$p$值 $p_i$ 小于或等于选定的显著性水平 $\\alpha_i$，我们就拒绝 $H_{0,i}$。在原假设为真的情况下，拒绝它的概率由这个水平控制：$P(\\text{reject } H_{0,i} | H_{0,i} \\text{ is true}) = \\alpha_i$。因此，对于任何 $i$，有 $P(\\text{reject } H_{0,i}) \\le \\alpha_i$。将此代入不等式，得到：\n$$\n\\text{FWER} \\le \\sum_{i=1}^{m} \\alpha_i\n$$\n为了将总FWER控制在期望的水平 $\\alpha$，我们必须确保 $\\sum_{i=1}^{m} \\alpha_i \\le \\alpha$。满足此条件的最简单和最通用的方法是为每个单独的检验设置相等的显著性水平，即对所有 $i$ 都有 $\\alpha_i = \\alpha^*$。这得出：\n$$\nm \\alpha^* \\le \\alpha \\implies \\alpha^* \\le \\frac{\\alpha}{m}\n$$\nBonferroni程序将这个单独的显著性阈值设置为 $\\alpha^* = \\frac{\\alpha}{m}$。因此，决策规则是，如果其原始$p$值 $p_i \\le \\frac{\\alpha}{m}$，则拒绝原假设 $H_{0,i}$。\n\n相应的校正$p$值 $p_i^{\\text{adj}}$ 定义为能够拒绝假设 $H_{0,i}$ 的最小FWER水平 $\\alpha$。根据Bonferroni规则，如果 $p_i \\le \\frac{\\alpha}{m}$，我们就拒绝假设，这等价于 $\\alpha \\ge m \\cdot p_i$。满足此不等式的最小 $\\alpha$ 值为 $\\alpha = m \\cdot p_i$。由于概率不能超过1，Bonferroni校正$p$值正式定义为：\n$$\np_i^{\\text{adj}} = \\min(m \\cdot p_i, 1)\n$$\n如果一个假设的校正$p$值小于或等于期望的FWER水平，即 $p_i^{\\text{adj}} \\le \\alpha$，则该假设被拒绝。\n\n现在，我们将此方法应用于给定的问题。我们有 $m=10$ 个成对比较和期望的FWER为 $\\alpha=0.05$。每个单独检验的Bonferroni校正显著性水平是：\n$$\n\\alpha^* = \\frac{\\alpha}{m} = \\frac{0.05}{10} = 0.005\n$$\n原始$p$值的集合是 $p=(0.001, 0.02, 0.07, 0.11, 0.23, 0.045, 0.0045, 0.39, 0.003, 0.12)$。我们必须将每个原始$p$值与校正后的阈值 $\\alpha^*=0.005$进行比较，并计算被拒绝的假设数量。\n1. $p_1 = 0.001 \\le 0.005 \\implies$ 拒绝 $H_{0,1}$\n2. $p_2 = 0.02 > 0.005 \\implies$ 不拒绝 $H_{0,2}$\n3. $p_3 = 0.07 > 0.005 \\implies$ 不拒绝 $H_{0,3}$\n4. $p_4 = 0.11 > 0.005 \\implies$ 不拒绝 $H_{0,4}$\n5. $p_5 = 0.23 > 0.005 \\implies$ 不拒绝 $H_{0,5}$\n6. $p_6 = 0.045 > 0.005 \\implies$ 不拒绝 $H_{0,6}$\n7. $p_7 = 0.0045 \\le 0.005 \\implies$ 拒绝 $H_{0,7}$\n8. $p_8 = 0.39 > 0.005 \\implies$ 不拒绝 $H_{0,8}$\n9. $p_9 = 0.003 \\le 0.005 \\implies$ 拒绝 $H_{0,9}$\n10. $p_{10} = 0.12 > 0.005 \\implies$ 不拒绝 $H_{0,10}$\n\n对应于原始$p$值 $0.001$、$0.0045$ 和 $0.003$ 的假设被拒绝。被拒绝的成对原假设总数为 $3$。\n\n最后，我们证明Bonferroni方法的适用性。Bonferroni校正的推导仅依赖于概率的联合界。这使其普遍适用于任何 $m$ 个假设检验的集合，因为它对检验之间的依赖结构或生成$p$值的数据的性质不作任何假设。相比之下，其他方法则更为专门化：\n- **Tukey's HSD** 专为在ANOVA之后检验所有成对比较而设计。其有效性取决于ANOVA模型的假设，例如正态性、观测独立性和方差齐性，并且在每组样本量相等时表现最佳。本问题只提供了最终的$p$值，并未确认这些基本假设是否得到满足。\n- **Scheffé方法** 旨在控制组均值之间所有可能的线性对比的FWER，而不仅仅是成对比较。如果唯一的目标是检验所有成对差异，那么这种方法就过于保守了。\n- **Dunnett方法** 专为将多个治疗组与单个对照组进行比较的特定情况而设计，而不是用于所有组之间的所有可能成对比较。\n鉴于问题只提供了一组$p$值和控制 $m$ 个同时检验的FWER这一总体目标，从第一性原理出发，Bonferroni方法是最合适的程序，因为其有效性不依赖于所提供信息之外的任何信息。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "虽然 Bonferroni 方法普遍适用，但它有时可能过于保守，导致我们错过一些真实的差异。对于方差分析（ANOVA）后比较所有均值对这一常见任务，存在更具统计功效的专门检验。本练习将介绍 Tukey-Kramer 方法，该方法专为此类成对比较设计，尤其在各组样本量不等时（这是实际研究中的常见情况）非常有用 。",
            "id": "4938779",
            "problem": "一个生物统计学团队对一项临床试验进行了方差分析 (ANOVA)，比较了 $k=6$ 个样本量不等 $n=(8,12,9,15,10,11)$ 的处理组。组内残差均方为 $MS_{within}=7.1$，残差自由度为 $df=60$。为了将所有两两比较的族错误率控制在 $\\alpha=0.05$，他们计划使用 Tukey-Kramer 方法。实验室的统计软件报告称，在这些设置下（$k=6$，$df=60$，$\\alpha=0.05$），学生化全距临界值为 $q^{\\star}=4.05$。\n\n从误差呈正态分布和各组间方差齐性的标准方差分析假设出发，推导一对组均值的 Tukey-Kramer 临界差，然后计算由三个最小样本量组成的三对组的 Tukey-Kramer 临界差，具体为样本量对 $(n_i,n_j)=(8,9)$、$(8,10)$ 和 $(9,10)$。将每个临界差四舍五入到四位有效数字。按 $(8,9)$、$(8,10)$、$(9,10)$ 的顺序提供你的三个数值答案。",
            "solution": "目标是为样本量不等的特定组对推导并计算 Tukey-Kramer 临界差。Tukey-Kramer 方法是 Tukey 显著性差异 (HSD) 检验的一种改编，旨在处理样本量不等的情况，同时在方差分析后对所有两两比较控制族错误率 (FWER)。\n\n该方法的核心是学生化全距统计量 $q$，对于比较第 $i$ 组均值 ($\\bar{y}_i$) 和第 $j$ 组均值 ($\\bar{y}_j$)，其定义为：\n$$\nq = \\frac{|\\bar{y}_i - \\bar{y}_j|}{SE_{ij}}\n$$\n其中 $SE_{ij}$ 是两个均值之差的标准误。在方差分析的方差齐性（所有组的共同方差为 $\\sigma^2$）的标准假设下，$\\sigma^2$ 的最佳估计是组内均方 $MS_{within}$。\n\n两个独立样本均值之差的方差是它们各自方差的总和：\n$$\n\\text{Var}(\\bar{y}_i - \\bar{y}_j) = \\text{Var}(\\bar{y}_i) + \\text{Var}(\\bar{y}_j) = \\frac{\\sigma^2}{n_i} + \\frac{\\sigma^2}{n_j} = \\sigma^2 \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)\n$$\n用 $MS_{within}$ 估计 $\\sigma^2$，差值的标准误为：\n$$\nSE_{ij} = \\sqrt{MS_{within} \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}\n$$\nTukey-Kramer 检验统计量调整了此标准误以适应学生化全距分布。两两比较的统计量通常表示为：\n$$\nq_{ij} = \\frac{|\\bar{y}_i - \\bar{y}_j|}{\\sqrt{\\frac{MS_{within}}{2} \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}}\n$$\n如果计算出的统计量 $q_{ij}$ 超过了学生化全距分布的临界值 $q^{\\star}_{\\alpha, k, df}$，则均值之差 $|\\bar{y}_i - \\bar{y}_j|$ 在 $\\alpha$ 水平上被认为是统计显著的。其中 $k$ 是组数，$df$ 是残差自由度。\n\nTukey-Kramer 临界差，我们可记为 $CD_{ij}$，是两个均值之间被认为显著的最小绝对差。它是通过将显著性检验的不等式重排为 $|\\bar{y}_i - \\bar{y}_j| > CD_{ij}$ 的形式推导出来的：\n$$\nCD_{ij} = q^{\\star}_{\\alpha, k, df} \\sqrt{\\frac{MS_{within}}{2} \\left(\\frac{1}{n_i} + \\frac{1}{n_j}\\right)}\n$$\n这是 Tukey-Kramer 临界差的通用公式。\n\n我们已知以下数值：\n组数，$k=6$。\n组内均方，$MS_{within}=7.1$。\n残差自由度，$df=60$。\n族错误率，$\\alpha=0.05$。\n学生化全距临界值，$q^{\\star} = 4.05$。\n\n我们需要计算三对样本量 $(n_i, n_j)$ 的 $CD_{ij}$：$(8, 9)$、$(8, 10)$ 和 $(9, 10)$。\n\n情况1：样本量对 $(n_i, n_j) = (8, 9)$。\n$$\nCD_{8,9} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{8} + \\frac{1}{9}\\right)}\n$$\n$$\nCD_{8,9} = 4.05 \\sqrt{3.55 \\left(\\frac{9+8}{72}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{17}{72}\\right)}\n$$\n$$\nCD_{8,9} = 4.05 \\sqrt{0.8381944...} = 4.05 \\times 0.915530...\n$$\n$$\nCD_{8,9} = 3.70789...\n$$\n四舍五入到四位有效数字，我们得到 $3.708$。\n\n情况2：样本量对 $(n_i, n_j) = (8, 10)$。\n$$\nCD_{8,10} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{8} + \\frac{1}{10}\\right)}\n$$\n$$\nCD_{8,10} = 4.05 \\sqrt{3.55 \\left(\\frac{10+8}{80}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{18}{80}\\right)}\n$$\n$$\nCD_{8,10} = 4.05 \\sqrt{0.79875} = 4.05 \\times 0.893728...\n$$\n$$\nCD_{8,10} = 3.6196...\n$$\n四舍五入到四位有效数字，我们得到 $3.620$。\n\n情况3：样本量对 $(n_i, n_j) = (9, 10)$。\n$$\nCD_{9,10} = 4.05 \\sqrt{\\frac{7.1}{2} \\left(\\frac{1}{9} + \\frac{1}{10}\\right)}\n$$\n$$\nCD_{9,10} = 4.05 \\sqrt{3.55 \\left(\\frac{10+9}{90}\\right)} = 4.05 \\sqrt{3.55 \\left(\\frac{19}{90}\\right)}\n$$\n$$\nCD_{9,10} = 4.05 \\sqrt{0.749444...} = 4.05 \\times 0.865704...\n$$\n$$\nCD_{9,10} = 3.5061...\n$$\n四舍五入到四位有效数字，我们得到 $3.506$。\n\n按要求为对 $(8,9)$、$(8,10)$ 和 $(9,10)$ 排列的三个临界差为 $3.708$、$3.620$ 和 $3.506$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.708  3.620  3.506\n\\end{pmatrix}\n}\n$$"
        }
    ]
}