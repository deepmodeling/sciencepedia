{
    "hands_on_practices": [
        {
            "introduction": "主成分分析 (PCA) 不仅仅是抽象的数学计算；它是一种揭示数据几何结构的强大工具。本练习旨在建立一种直观的理解，将作为 PCA 输出的数学概念“特征向量”与数据点云的“形状”联系起来。通过理解最大特征值对应的特征向量如何决定数据的主要分布方向，我们可以从视觉上把握 PCA 的核心思想 。",
            "id": "1383893",
            "problem": "一位数据科学家正在对一个大的二维数据集进行主成分分析 (PCA)，其中每个数据点由向量 $ [x, y]^T $ 表示。在通过减去均值将数据中心化之后，计算出了 $2 \\times 2$ 的样本协方差矩阵。分析显示，该协方差矩阵的特征向量为 $\\mathbf{v}_1 = [1, 1]^T$ 和 $\\mathbf{v}_2 = [-1, 1]^T$。此外，还发现对应于 $\\mathbf{v}_1$ 的特征值远大于对应于 $\\mathbf{v}_2$ 的特征值。\n\n根据这些信息，下列哪个陈述最可能描述了在 $xy$ 平面中中心化后数据点的几何分布？\n\nA. 数据点分布在以原点为中心的大致圆形云中。\n\nB. 数据点形成一个主要沿 y 轴对齐的细长云。\n\nC. 数据点形成一个细长云，其长轴与直线 $y = -x$ 对齐。\n\nD. 数据点形成一个细长云，其长轴与直线 $y = x$ 对齐。\n\nE. 数据点集中在两个不同的簇中，一个在第一象限，一个在第三象限。",
            "solution": "设中心化后的数据点为 $\\{\\mathbf{x}_{i}\\}_{i=1}^{n}$，其中 $\\mathbf{x}_{i} \\in \\mathbb{R}^{2}$，样本协方差矩阵为\n$$\nS=\\frac{1}{n-1}\\sum_{i=1}^{n}\\mathbf{x}_{i}\\mathbf{x}_{i}^{T}.\n$$\n主成分分析通过特征分解将 $S$ 对角化。特征向量 $\\{\\mathbf{v}_{k}\\}$ 和特征值 $\\{\\lambda_{k}\\}$ 满足\n$$\nS\\mathbf{v}_{k}=\\lambda_{k}\\mathbf{v}_{k},\n$$\n其中每个 $\\lambda_{k}$ 等于数据投影到方向 $\\mathbf{v}_{k}$ 上的方差。中心化后点云的几何形状可以由一个椭圆很好地近似，其主轴与 $S$ 的特征向量对齐，轴长与 $\\sqrt{\\lambda_{k}}$ 成正比。最大的特征值决定了长轴的方向。\n\n我们给定的特征向量为 $\\mathbf{v}_{1}=[1,1]^{T}$ 和 $\\mathbf{v}_{2}=[-1,1]^{T}$，且对应于 $\\mathbf{v}_{1}$ 的特征值远大于对应于 $\\mathbf{v}_{2}$ 的特征值。方向 $\\mathbf{v}_{1}=[1,1]^{T}$ 对应于直线 $y=x$，因为对于方向向量 $[a,b]^{T}$，对齐的直线斜率为 $b/a$。因此 $[1,1]^{T}$ 得到 $y=(1/1)x=x$。类似地，$\\mathbf{v}_{2}=[-1,1]^{T}$ 对应于 $y=(1/(-1))x$，即 $y=-x$。由于 $\\lambda_{1}\\gg\\lambda_{2}$，沿 $\\mathbf{v}_{1}$ 方向的方差要大得多，所以数据云的长轴与 $y=x$ 对齐。\n\n因此，最可能的描述是中心化后的数据形成一个细长的云，其长轴与直线 $y=x$ 对齐，这对应于选项 D。选项 A 和 B 与特征结构不一致（A 要求特征值大致相等；B 要求主方向与 y 轴对齐），而选项 C 则要求最大特征值与 $\\mathbf{v}_{2}$ 相关联。仅从协方差无法推断出选项 E，这也不是给定 PCA 结果最直接的推论。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "在应用 PCA 时，一个至关重要但常被忽视的方面是它对变量尺度的敏感性。这个练习通过一个具体的例子阐明了这一点：简单地缩放一个变量就会显著改变计算出的主成分方向。这个实践突出了在执行 PCA 之前进行数据标准化的重要性，这是确保分析结果公平反映所有变量贡献的关键预处理步骤 。",
            "id": "1946276",
            "problem": "一个二维数据集由一对中心化（零均值）的随机变量 $(X_1, X_2)$ 表示。该数据集的统计特性由其协方差矩阵 $\\Sigma$ 完全描述，如下所示：\n$$\n\\Sigma = \\begin{pmatrix} 25  12 \\\\ 12  10 \\end{pmatrix}\n$$\n其中对角线元素分别代表 $X_1$ 和 $X_2$ 的方差，非对角线元素代表它们的协方差。\n\n一位数据分析师通过对原始数据应用线性变换创建了一个新的数据集 $(Y_1, Y_2)$：$Y_1 = 10X_1$ 和 $Y_2 = X_2$。接着对这个新的、变换后的数据集执行主成分分析 (PCA)。\n\n第一主成分被定义为 $(Y_1, Y_2)$ 的协方差矩阵中与最大特征值对应的特征向量。这个特征向量代表了在 $(Y_1, Y_2)$ 平面内的一个方向。\n\n确定变换后数据的第一主成分向量与 $Y_1$ 轴正半轴所成的角度。角度应沿逆时针方向测量。请以度为单位表示您的答案，并四舍五入到三位有效数字。",
            "solution": "第一步是确定变换后数据集 $(Y_1, Y_2)$ 的协方差矩阵。设新的协方差矩阵为 $\\Sigma'$。$\\Sigma'$ 的元素是根据方差和协方差的性质计算的。\n\n$Y_1$ 的方差为：\n$$\n\\text{Var}(Y_1) = \\text{Var}(10X_1) = 10^2 \\text{Var}(X_1)\n$$\n从原始协方差矩阵 $\\Sigma$ 中，我们知道 $\\text{Var}(X_1) = 25$。因此：\n$$\n\\text{Var}(Y_1) = 100 \\times 25 = 2500\n$$\n$Y_2$ 的方差保持不变：\n$$\n\\text{Var}(Y_2) = \\text{Var}(X_2) = 10\n$$\n$Y_1$ 和 $Y_2$ 之间的协方差为：\n$$\n\\text{Cov}(Y_1, Y_2) = \\text{Cov}(10X_1, X_2) = 10 \\text{Cov}(X_1, X_2)\n$$\n从原始协方差矩阵 $\\Sigma$ 中，我们知道 $\\text{Cov}(X_1, X_2) = 12$。因此：\n$$\n\\text{Cov}(Y_1, Y_2) = 10 \\times 12 = 120\n$$\n有了这些分量，变换后数据的新的协方差矩阵 $\\Sigma'$ 为：\n$$\n\\Sigma' = \\begin{pmatrix} 2500  120 \\\\ 120  10 \\end{pmatrix}\n$$\n主成分是该协方差矩阵的特征向量。设 $\\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$ 是 $\\Sigma'$ 对应于特征值 $\\lambda$ 的一个特征向量。特征值方程为 $\\Sigma' \\mathbf{v} = \\lambda \\mathbf{v}$，可以写成 $(\\Sigma' - \\lambda I)\\mathbf{v} = \\mathbf{0}$。\n\n为了找到特征值，我们求解特征方程 $\\det(\\Sigma' - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} 2500 - \\lambda  120 \\\\ 120  10 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(2500 - \\lambda)(10 - \\lambda) - (120)^2 = 0\n$$\n$$\n25000 - 2500\\lambda - 10\\lambda + \\lambda^2 - 14400 = 0\n$$\n$$\n\\lambda^2 - 2510\\lambda + 10600 = 0\n$$\n第一主成分对应于与最大特征值 $\\lambda_1$ 相关联的特征向量。我们可以用求根公式找到 $\\lambda_1$：\n$$\n\\lambda_1 = \\frac{-(-2510) + \\sqrt{(-2510)^2 - 4(1)(10600)}}{2} = \\frac{2510 + \\sqrt{6300100 - 42400}}{2}\n$$\n$$\n\\lambda_1 = \\frac{2510 + \\sqrt{6257700}}{2}\n$$\n现在，我们通过求解 $(\\Sigma' - \\lambda_1 I)\\mathbf{v} = \\mathbf{0}$ 来找到对应的特征向量 $\\mathbf{v} = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。这得到一个由两个线性方程组成的方程组。我们只需要其中一个方程就可以找到向量的方向。使用第二行：\n$$\n120v_1 + (10 - \\lambda_1)v_2 = 0\n$$\n在 $(Y_1, Y_2)$ 平面内，特征向量的斜率为 $m = \\frac{v_2}{v_1}$。重新整理该方程得到：\n$$\nm = \\frac{v_2}{v_1} = \\frac{-120}{10 - \\lambda_1} = \\frac{120}{\\lambda_1 - 10}\n$$\n代入 $\\lambda_1$ 的表达式：\n$$\n\\lambda_1 - 10 = \\frac{2510 + \\sqrt{6257700}}{2} - 10 = \\frac{2490 + \\sqrt{6257700}}{2}\n$$\n所以斜率为：\n$$\nm = \\frac{120}{\\frac{2490 + \\sqrt{6257700}}{2}} = \\frac{240}{2490 + \\sqrt{6257700}}\n$$\n现在我们计算斜率的数值：\n$$\n\\sqrt{6257700} \\approx 2501.5395\n$$\n$$\nm \\approx \\frac{240}{2490 + 2501.5395} = \\frac{240}{4991.5395} \\approx 0.0480836\n$$\n该向量与 $Y_1$ 轴正半轴所成的角度 $\\theta$ 由斜率的反正切给出：\n$$\n\\theta = \\arctan(m) = \\arctan(0.0480836)\n$$\n为了以度为单位表示角度，我们从弧度进行转换：\n$$\n\\theta_{\\text{deg}} = \\arctan(0.0480836) \\times \\frac{180}{\\pi} \\approx 2.7543^\\circ\n$$\n将结果四舍五入到三位有效数字，我们得到 $2.75$ 度。",
            "answer": "$$\\boxed{2.75}$$"
        },
        {
            "introduction": "要真正掌握一种分析技术，亲手从头到尾计算一遍是最好的方法之一。本练习将引导你完成在小型基因表达数据集上进行 PCA 的完整流程。通过逐步完成数据中心化、构建协方差矩阵以及计算主成分载荷向量，你将巩固对 PCA 工作原理的理解 。",
            "id": "2416060",
            "problem": "一项基因表达实验测量了基因 $G_1$、$G_2$ 和 $G_3$ 在样本 $S_1$、$S_2$、$S_3$ 和 $S_4$ 中的对数转换表达值。数据矩阵 $X \\in \\mathbb{R}^{4 \\times 3}$ 以样本为行，基因为列：\n$$\nX \\;=\\; \\begin{pmatrix}\n1  2  3 \\\\\n2  3  4 \\\\\n3  4  5 \\\\\n4  5  6\n\\end{pmatrix}.\n$$\n将样本视为独立观测值，基因视为变量。使用主成分分析 (PCA)，通过以下步骤计算基因空间中的第一主成分载荷向量：\n- 对 $X$ 进行列中心化，\n- 对于 $n=4$ 个样本，使用分母 $n-1$ 构建基因间的样本协方差矩阵，以及\n- 取该协方差矩阵对应于最大特征值的单位范数特征向量。\n\n将载荷向量以 $1 \\times 3$ 行矩阵的形式报告，按 $(G_1, G_2, G_3)$ 排序，并选择符号以使其第一个非零元素为正。无需进行四舍五入。",
            "solution": "题目要求我们通过对基因间样本协方差矩阵进行特征分解来计算基因空间中的第一主成分载荷向量。令 $n=4$ 为样本数量，$p=3$ 为基因数量。数据矩阵为 $X \\in \\mathbb{R}^{n \\times p}$，其中行为样本，列为基因。\n\n步骤 1：列中心化。计算 $X$ 的列均值：\n$$\n\\bar{x}_{\\cdot 1} \\;=\\; \\frac{1+2+3+4}{4} \\;=\\; 2.5,\\quad\n\\bar{x}_{\\cdot 2} \\;=\\; \\frac{2+3+4+5}{4} \\;=\\; 3.5,\\quad\n\\bar{x}_{\\cdot 3} \\;=\\; \\frac{3+4+5+6}{4} \\;=\\; 4.5.\n$$\n从每列中减去这些均值以获得中心化矩阵 $Z$：\n$$\nZ \\;=\\; X - \\mathbf{1}\\bar{x}^{\\top}\n\\;=\\;\n\\begin{pmatrix}\n1-2.5  2-3.5  3-4.5 \\\\\n2-2.5  3-3.5  4-4.5 \\\\\n3-2.5  4-3.5  5-4.5 \\\\\n4-2.5  5-3.5  6-4.5\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n-1.5  -1.5  -1.5 \\\\\n-0.5  -0.5  -0.5 \\\\\n\\phantom{-}0.5  \\phantom{-}0.5  \\phantom{-}0.5 \\\\\n\\phantom{-}1.5  \\phantom{-}1.5  \\phantom{-}1.5\n\\end{pmatrix}.\n$$\n\n步骤 2：基因间的样本协方差矩阵。使用分母 $n-1=3$，基因的样本协方差为\n$$\nS \\;=\\; \\frac{1}{n-1}\\, Z^{\\top} Z \\;=\\; \\frac{1}{3}\\, Z^{\\top} Z.\n$$\n观察到 $Z$ 的每一行都是 $(1,\\,1,\\,1)$ 的标量倍数，因此所有三个中心化的基因列都是相同的。计算 $Z^{\\top}Z$，注意到对于任意两列 $j$ 和 $k$，$(j,k)$ 项等于 $\\sum_{i=1}^{n} Z_{ij} Z_{ik}$。由于所有三列都相同，$Z^{\\top}Z$ 的每个元素都等于单个中心化列的平方和：\n$$\n\\sum_{i=1}^{4} Z_{i1}^{2} \\;=\\; (-1.5)^{2} + (-0.5)^{2} + (0.5)^{2} + (1.5)^{2} \\;=\\; 2.25 + 0.25 + 0.25 + 2.25 \\;=\\; 5.\n$$\n因此，\n$$\nZ^{\\top} Z \\;=\\; 5 \\begin{pmatrix}\n1  1  1 \\\\\n1  1  1 \\\\\n1  1  1\n\\end{pmatrix}\n\\quad\\text{and}\\quad\nS \\;=\\; \\frac{1}{3} Z^{\\top}Z \\;=\\; \\frac{5}{3}\n\\begin{pmatrix}\n1  1  1 \\\\\n1  1  1 \\\\\n1  1  1\n\\end{pmatrix}.\n$$\n\n步骤 3：特征分解。令 $J \\in \\mathbb{R}^{3 \\times 3}$ 表示全1矩阵，即对于所有 $j,k$，$J_{jk}=1$。从基本原理可知，$J$ 的秩为 $1$，其特征值为 $3$ 和 $0$（重数为 $2$）。对应于特征值 $3$ 的一个单位范数特征向量与 $(1,\\,1,\\,1)^{\\top}$ 成比例，具体为\n$$\nv \\;=\\; \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}.\n$$\n由于 $S = \\frac{5}{3} J$，$S$ 的特征值为 $\\lambda_{1} = \\frac{5}{3} \\cdot 3 = 5$ 和 $\\lambda_{2} = 0$, $\\lambda_{3} = 0$，其特征向量与 $J$ 相同。因此，基因空间中的第一主成分载荷向量是与 $\\lambda_{1}=5$ 相关联的单位范数特征向量，即上面提到的 $v$。选择符号以使其第一个非零元素为正，得到\n$$\nv \\;=\\; \\left( \\frac{1}{\\sqrt{3}},\\; \\frac{1}{\\sqrt{3}},\\; \\frac{1}{\\sqrt{3}} \\right).\n$$\n\n因此，按 $(G_1, G_2, G_3)$ 排序并写成 $1 \\times 3$ 行矩阵形式，第一主成分载荷向量是\n$$\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}  \\frac{1}{\\sqrt{3}}\\end{pmatrix}}$$"
        }
    ]
}