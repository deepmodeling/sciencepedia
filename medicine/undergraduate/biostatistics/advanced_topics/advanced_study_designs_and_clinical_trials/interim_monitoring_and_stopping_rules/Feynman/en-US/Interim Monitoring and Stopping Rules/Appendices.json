{
    "hands_on_practices": [
        {
            "introduction": "To properly design and analyze a trial with interim looks, we must first understand the statistical relationship between the test statistics calculated at each stage. Because they are based on cumulative data, these statistics are not independent. This exercise guides you through deriving the covariance matrix for a set of sequential test statistics, revealing the 'canonical' correlation structure that forms the mathematical foundation of group sequential methods. ",
            "id": "4918094",
            "problem": "A two-arm randomized clinical trial is monitored using a group sequential design with three analyses at information times $t_{1} = 0.25$, $t_{2} = 0.50$, and $t_{3} = 1.00$. Under the canonical joint normal framework, the sequential test statistics $\\{Z_{i}\\}$ are modeled via a standardized Brownian motion with drift representation: for each analysis time $t$, the statistic $Z(t)$ is defined by $Z(t) = \\left(W(t) + \\theta t\\right)/\\sqrt{t}$, where $W(t)$ is standard Brownian motion and $\\theta$ is a constant drift parameter representing the standardized treatment effect. It is known that $W(t)$ has covariance function $\\operatorname{Cov}\\!\\left(W(s), W(t)\\right) = \\min\\{s,t\\}$ and $W(0) = 0$.\n\nStarting from these fundamental definitions, derive the covariance matrix of $\\left(Z_{1}, Z_{2}, Z_{3}\\right)$ at $\\left(t_{1}, t_{2}, t_{3}\\right)$ and express its entries in exact closed form. Then verify that this covariance matrix is positive semidefinite by reasoning from first principles. Express the matrix entries in simplest exact form using radicals and fractions, and do not round any quantities.",
            "solution": "The problem specifies a canonical joint normal representation of interim test statistics in a group sequential design. The foundational base is the standardized Brownian motion with drift $W(t)$, which is a Gaussian process with $W(0) = 0$, mean $0$, and covariance function $\\operatorname{Cov}\\!\\left(W(s), W(t)\\right) = \\min\\{s,t\\}$. The canonical statistic at time $t$ is given by\n$$\nZ(t) = \\frac{W(t) + \\theta t}{\\sqrt{t}}.\n$$\nFor any fixed set of analysis times $t_{1}, t_{2}, t_{3}$, the vector $\\left(Z(t_{1}), Z(t_{2}), Z(t_{3})\\right)$ is jointly normal. Its covariance structure can be derived directly from the covariance of $W(t)$, as the drift $\\theta t$ contributes only to the mean and not to the covariance.\n\nSpecifically, for $i,j \\in \\{1,2,3\\}$,\n$$\n\\operatorname{Cov}\\!\\left(Z(t_{i}), Z(t_{j})\\right)\n= \\operatorname{Cov}\\!\\left(\\frac{W(t_{i})}{\\sqrt{t_{i}}}, \\frac{W(t_{j})}{\\sqrt{t_{j}}}\\right)\n= \\frac{\\operatorname{Cov}\\!\\left(W(t_{i}), W(t_{j})\\right)}{\\sqrt{t_{i} t_{j}}}\n= \\frac{\\min\\{t_{i}, t_{j}\\}}{\\sqrt{t_{i} t_{j}}}.\n$$\nThis shows that the covariance matrix $\\Sigma$ has entries\n$$\n\\Sigma_{ij} = \\frac{\\min\\{t_{i}, t_{j}\\}}{\\sqrt{t_{i} t_{j}}}.\n$$\nObserve that for $i = j$, $\\Sigma_{ii} = \\min\\{t_{i}, t_{i}\\}/t_{i} = 1$, so each $Z(t_{i})$ is standardized to variance $1$. For $i  j$, $\\Sigma_{ij} = \\frac{t_{i}}{\\sqrt{t_{i} t_{j}}} = \\sqrt{\\frac{t_{i}}{t_{j}}}$.\n\nWith $t_{1} = 0.25$, $t_{2} = 0.50$, $t_{3} = 1.00$, we compute the off-diagonal entries:\n- For $i=1$, $j=2$, $\\Sigma_{12} = \\sqrt{\\frac{t_{1}}{t_{2}}} = \\sqrt{\\frac{0.25}{0.50}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}$.\n- For $i=1$, $j=3$, $\\Sigma_{13} = \\sqrt{\\frac{t_{1}}{t_{3}}} = \\sqrt{\\frac{0.25}{1.00}} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}$.\n- For $i=2$, $j=3$, $\\Sigma_{23} = \\sqrt{\\frac{t_{2}}{t_{3}}} = \\sqrt{\\frac{0.50}{1.00}} = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}$.\n\nBy symmetry, $\\Sigma_{21} = \\Sigma_{12}$, $\\Sigma_{31} = \\Sigma_{13}$, and $\\Sigma_{32} = \\Sigma_{23}$. The full covariance matrix is\n$$\n\\Sigma =\n\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix}.\n$$\nAny covariance matrix is positive semidefinite by definition. Since $\\Sigma$ is derived as the covariance matrix of the random vector $(Z_1, Z_2, Z_3)$, it must be positive semidefinite. \n\nWe can also verify this by showing its eigenvalues are non-negative.\nLet $a = 1/\\sqrt{2}$ and $b = 1/2$.\nThe eigenvalues $\\lambda$ of $\\Sigma$ satisfy the characteristic equation $\\det(\\Sigma - \\lambda I) = 0$.\n$$\n\\det \\begin{pmatrix} 1-\\lambda  a  b \\\\ a  1-\\lambda  a \\\\ b  a  1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(1-\\lambda)((1-\\lambda)^2 - a^2) - a(a(1-\\lambda) - ab) + b(a^2 - b(1-\\lambda)) = 0\n$$\nThis calculation is cumbersome. A simpler approach is to use the fact that the vector $(Z_1, Z_2, Z_3)$ is constructed from a Gaussian process, guaranteeing that its covariance matrix is positive semidefinite. For any vector $x \\in \\mathbb{R}^3$, we must have $x^T \\Sigma x \\geq 0$.\n$$\nx^T \\Sigma x = \\text{Var}(x_1 Z_1 + x_2 Z_2 + x_3 Z_3) \\geq 0\n$$\nThis establishes from first principles that $\\Sigma$ is positive semidefinite.\nThe eigenvalues can be calculated to be $\\lambda_1 = 1 - 1/2 = 1/2$, $\\lambda_2 = \\frac{5+\\sqrt{17}}{4}$, and $\\lambda_3 = \\frac{5-\\sqrt{17}}{4}$. All are positive, so the matrix is positive definite.\n\nTherefore, the covariance matrix is\n$$\n\\Sigma =\n\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix},\n$$\nwhich is positive semidefinite.",
            "answer": "$$\\boxed{\\begin{pmatrix}\n1  \\frac{1}{\\sqrt{2}}  \\frac{1}{2} \\\\\n\\frac{1}{\\sqrt{2}}  1  \\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{2}  \\frac{1}{\\sqrt{2}}  1\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Controlling the overall Type I error rate, $\\alpha$, is paramount in a clinical trial. Alpha-spending functions provide a flexible way to 'spend' this error budget over the course of the study. This practice problem demonstrates how to apply a common power-spending function and explores the real-world complication of what happens when interim analyses deviate from their planned schedule, a crucial skill for adaptive trial management. ",
            "id": "4918088",
            "problem": "A randomized clinical trial is monitored with a group sequential design using an alpha-spending approach to control the overall Type I error rate. Let the overall two-sided Type I error be $\\alpha=0.05$, and suppose the Data and Safety Monitoring Board (DSMB) uses a power alpha-spending function with exponent $\\rho=2$, so that the cumulative alpha spent by information time $t \\in [0,1]$ is the spending function $g(t)$ satisfying $g(0)=0$, $g(1)=\\alpha$, monotonicity in $t$, and a late-spending profile consistent with conservative early looks.\n\nThe trial was planned to have three interim looks at information times $(0.25, 0.50, 0.75)$, but due to operational variation, the looks occurred at $(0.22, 0.49, 0.85)$. Using the power spending paradigm and the definition of information time as the fraction of planned maximum Fisher information accrued, quantify the impact of this unplanned timing variation on the cumulative alpha allocation across the three looks by computing the sum of absolute deviations between the planned and actual cumulative alpha spending at the corresponding look indices:\n$$\n\\Delta \\equiv \\sum_{i=1}^{3} \\left| g\\big(t^{\\text{actual}}_{i}\\big) - g\\big(t^{\\text{planned}}_{i}\\big) \\right|.\n$$\n\nExpress your final numerical answer for $\\Delta$ as a decimal and round your answer to four significant figures.",
            "solution": "The core of the problem lies in the application of the power alpha-spending function. This family of functions is defined by the formula:\n$$\ng(t) = \\alpha t^{\\rho}\n$$\nwhere $t$ is the information time (the fraction of total planned information accrued, with $t \\in [0,1]$), $\\alpha$ is the total Type I error rate, and $\\rho$ is a parameter that controls the rate of spending. A value of $\\rho > 1$ corresponds to a \"late-spending\" function, which is more conservative at early looks.\n\nThe problem specifies an overall two-sided Type I error rate of $\\alpha=0.05$ and an exponent of $\\rho=2$. Substituting these values into the general formula gives the specific spending function for this trial:\n$$\ng(t) = 0.05 \\times t^2\n$$\nThe objective is to compute the total absolute deviation, $\\Delta$, between the planned and actual cumulative alpha allocations across three interim looks. The formula for $\\Delta$ is given as:\n$$\n\\Delta = \\sum_{i=1}^{3} \\left| g\\big(t^{\\text{actual}}_{i}\\big) - g\\big(t^{\\text{planned}}_{i}\\big) \\right|\n$$\nThe planned information times are $t^{\\text{planned}}_1 = 0.25$, $t^{\\text{planned}}_2 = 0.50$, and $t^{\\text{planned}}_3 = 0.75$.\nThe actual, observed information times are $t^{\\text{actual}}_1 = 0.22$, $t^{\\text{actual}}_2 = 0.49$, and $t^{\\text{actual}}_3 = 0.85$.\n\nFirst, we calculate the cumulative alpha allocations that were planned for each look:\n- Look 1 ($i=1$): $g(t^{\\text{planned}}_1) = g(0.25) = 0.05 \\times (0.25)^2 = 0.05 \\times 0.0625 = 0.003125$.\n- Look 2 ($i=2$): $g(t^{\\text{planned}}_2) = g(0.50) = 0.05 \\times (0.50)^2 = 0.05 \\times 0.25 = 0.0125$.\n- Look 3 ($i=3$): $g(t^{\\text{planned}}_3) = g(0.75) = 0.05 \\times (0.75)^2 = 0.05 \\times 0.5625 = 0.028125$.\n\nNext, we calculate the cumulative alpha allocations corresponding to the actual information times when the looks occurred:\n- Look 1 ($i=1$): $g(t^{\\text{actual}}_1) = g(0.22) = 0.05 \\times (0.22)^2 = 0.05 \\times 0.0484 = 0.00242$.\n- Look 2 ($i=2$): $g(t^{\\text{actual}}_2) = g(0.49) = 0.05 \\times (0.49)^2 = 0.05 \\times 0.2401 = 0.012005$.\n- Look 3 ($i=3$): $g(t^{\\text{actual}}_3) = g(0.85) = 0.05 \\times (0.85)^2 = 0.05 \\times 0.7225 = 0.036125$.\n\nNow, we compute the absolute deviation for each corresponding look index:\n- Deviation for look 1: $| g(t^{\\text{actual}}_1) - g(t^{\\text{planned}}_1) | = |0.00242 - 0.003125| = |-0.000705| = 0.000705$.\n- Deviation for look 2: $| g(t^{\\text{actual}}_2) - g(t^{\\text{planned}}_2) | = |0.012005 - 0.0125| = |-0.000495| = 0.000495$.\n- Deviation for look 3: $| g(t^{\\text{actual}}_3) - g(t^{\\text{planned}}_3) | = |0.036125 - 0.028125| = |0.008| = 0.008$.\n\nFinally, we sum these three absolute deviations to find $\\Delta$:\n$$\n\\Delta = 0.000705 + 0.000495 + 0.008 = 0.0092\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value is $0.0092$. The leading zeros are not significant figures. To express this value with four significant figures, we add two trailing zeros. Thus, the value becomes $0.009200$.",
            "answer": "$$\n\\boxed{0.009200}\n$$"
        },
        {
            "introduction": "The decision to stop a trial early or continue it based on accumulating data has consequences for our final analysis. A standard confidence interval calculated at the end of the trial will be biased and have incorrect coverage if it ignores the stopping rule. This exercise shows how to construct a valid confidence interval by inverting the sequential test, a technique that correctly accounts for the monitoring process, and allows you to quantify the statistical 'cost' of interim looks. ",
            "id": "4918074",
            "problem": "A two-arm randomized clinical trial compares the mean outcome between a treatment and a control. Assume independent and identically distributed outcomes with known variance $\\sigma^{2} = 1$ per subject in each arm. Let the parameter of interest be the true mean difference $\\theta$ (treatment minus control). The trial is monitored with one interim analysis and one final analysis under a pre-specified stopping rule: a two-sided Pocock boundary with critical value $c_{1} = c_{2} = 2.41$ for total type I error $\\alpha = 0.05$.\n\nThe design uses equal sample sizes at both looks: $n_{1} = 100$ per arm at the interim and an additional $n_{2} = 100$ per arm at the final, for a total of $n_{1} + n_{2} = 200$ per arm if not stopped early. At the interim, the stage-$1$ mean difference estimate is $\\hat{\\theta}_{1} = 0.20$; in the second stage, based on the new data only, the stage-$2$ mean difference estimate is $\\hat{\\theta}_{2} = 0.05$. Assume stage-wise independence between the interim and the second-stage data.\n\nConsider the Inverse-Normal Combination Test (INCT) with weights $w_{1} = \\sqrt{\\frac{n_{1}}{n_{1} + n_{2}}}$ and $w_{2} = \\sqrt{\\frac{n_{2}}{n_{1} + n_{2}}}$ to combine the stage-wise standardized statistics. Under the parameter value $\\theta$, define the stage-wise standardized $z$-statistics\n$$\nz_{1}(\\theta) = \\frac{\\hat{\\theta}_{1} - \\theta}{\\mathrm{SE}_{1}}, \\quad z_{2}(\\theta) = \\frac{\\hat{\\theta}_{2} - \\theta}{\\mathrm{SE}_{2}},\n$$\nwhere $\\mathrm{SE}_{j}$ is the standard error of the stage-$j$ mean difference based on $n_{j}$ subjects per arm, and the INCT combination statistic\n$$\nC(\\theta) = w_{1}\\,z_{1}(\\theta) + w_{2}\\,z_{2}(\\theta).\n$$\nUnder the monitoring rule, the trial would have stopped early for efficacy at the interim if $|z_{1}(\\theta)| \\geq c_{1}$; otherwise it continues and would reject at the final if $|C(\\theta)| \\geq c_{2}$. A $(1-\\alpha)$ confidence interval for $\\theta$ that accounts for the stopping rule is obtained by inverting this two-stage procedure: it is the set of $\\theta$ values for which the observed path would not have led to rejection at either stage under that $\\theta$.\n\nUsing the given data and design:\n- Derive the adjusted two-sided $(1-\\alpha)$ confidence interval for $\\theta$ by inverting the INCT with the Pocock boundaries, and compute its width.\n- Derive the naive fixed-sample two-sided $(1-\\alpha)$ confidence interval for $\\theta$ that ignores interim monitoring, using the combined data from both stages as if there were no stopping rule, and compute its width.\n- Compute the ratio of the adjusted CI width to the naive CI width.\n\nExpress the final ratio as a single real number and round your answer to four significant figures. No units are required.",
            "solution": "First, we calculate the standard errors for each stage and the final combined data. The variance of a mean difference estimate $\\hat{\\theta}_j$ based on $n_j$ subjects per arm is $\\mathrm{Var}(\\hat{\\theta}_j) = \\frac{\\sigma^2}{n_j} + \\frac{\\sigma^2}{n_j} = \\frac{2\\sigma^2}{n_j}$.\nGiven $n_1=100$, $n_2=100$, and $\\sigma^2=1$:\n-   Stage 1 Standard Error: $\\mathrm{SE}_1 = \\sqrt{\\frac{2(1)}{100}} = \\sqrt{0.02} \\approx 0.1414$.\n-   Final Standard Error: $\\mathrm{SE}_{final} = \\sqrt{\\frac{2(1)}{n_1+n_2}} = \\sqrt{\\frac{2}{200}} = \\sqrt{0.01} = 0.1$.\n\nThe overall mean difference estimate is the weighted average of the stage-wise estimates:\n$$ \\hat{\\theta}_{final} = \\frac{n_1 \\hat{\\theta}_1 + n_2 \\hat{\\theta}_2}{n_1 + n_2} = \\frac{100(0.20) + 100(0.05)}{200} = 0.125 $$\nThe trial continued to the final stage because the interim Z-statistic under the null, $|z_1(0)| = |\\hat{\\theta}_1 / \\mathrm{SE}_1| = |0.20 / \\sqrt{0.02}| \\approx 1.414$, was less than the Pocock boundary $c_1=2.41$.\n\n**1. Adjusted Confidence Interval (CI) Width**\nThe adjusted CI is the set of $\\theta$ values consistent with the observed data not leading to rejection at either stage. This requires two conditions to be met:\n1.  $|z_1(\\theta)|  c_1 \\implies |\\frac{\\hat{\\theta}_1 - \\theta}{\\mathrm{SE}_1}|  2.41$\n2.  $|C(\\theta)|  c_2$, where $C(\\theta)$ is the INCT statistic, which simplifies to $\\frac{\\hat{\\theta}_{final} - \\theta}{\\mathrm{SE}_{final}}$. So, $|\\frac{\\hat{\\theta}_{final} - \\theta}{\\mathrm{SE}_{final}}|  2.41$\n\nFrom condition 1, we get the interval for $\\theta$:\n$$ |0.20 - \\theta|  2.41 \\times \\sqrt{0.02} \\implies |0.20 - \\theta|  0.3408 \\implies \\theta \\in (-0.1408, 0.5408) $$\nFrom condition 2, we get the interval for $\\theta$:\n$$ |\\frac{0.125 - \\theta}{0.1}|  2.41 \\implies |0.125 - \\theta|  0.241 \\implies \\theta \\in (-0.116, 0.366) $$\n\nThe adjusted CI is the intersection of these two intervals, which is $(-0.116, 0.366)$.\nThe width of the adjusted CI is $W_{adj} = 0.366 - (-0.116) = 0.482$.\n\n**2. Naive Confidence Interval Width**\nThe naive CI ignores the interim monitoring and is constructed using the standard normal critical value for $\\alpha=0.05$, which is $z_{1-\\alpha/2} = z_{0.975} \\approx 1.96$.\n$$ CI_{naive} = \\hat{\\theta}_{final} \\pm z_{0.975} \\times \\mathrm{SE}_{final} = 0.125 \\pm 1.96 \\times 0.1 $$\nThe width of the naive CI is $W_{naive} = 2 \\times 1.96 \\times 0.1 = 0.392$.\n\n**3. Ratio of Widths**\nThe ratio of the adjusted CI width to the naive CI width is:\n$$ \\text{Ratio} = \\frac{W_{adj}}{W_{naive}} = \\frac{0.482}{0.392} \\approx 1.22959 $$\nRounding to four significant figures, the ratio is $1.230$. This inflation in width is the \"price\" paid for the opportunity to stop the trial early.",
            "answer": "$$\n\\boxed{1.230}\n$$"
        }
    ]
}