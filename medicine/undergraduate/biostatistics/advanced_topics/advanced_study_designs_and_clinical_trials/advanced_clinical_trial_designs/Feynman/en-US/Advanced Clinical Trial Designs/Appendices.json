{
    "hands_on_practices": [
        {
            "introduction": "Randomization is a cornerstone of the randomized controlled trial, but simple randomization can lead to chance imbalances in important patient characteristics, especially in smaller studies. Covariate-adaptive randomization, particularly minimization, addresses this by dynamically adjusting allocation probabilities to keep prognostic factors balanced between treatment arms. This exercise  offers hands-on practice with the mechanics of a minimization algorithm, guiding you to calculate imbalance scores and use a biased-coin rule to assign a patient, thereby demonstrating the crucial balance between achieving covariate distribution similarity and maintaining randomization's unpredictability.",
            "id": "4892430",
            "problem": "A two-arm randomized controlled trial (RCT) seeks to minimize covariate imbalance at the point of allocation using a biased-coin minimization algorithm. Consider three binary covariates with prespecified importance weights: sex (male level coded as $1$) with weight $w_{1} = 0.5$, disease stage (advanced stage coded as $1$) with weight $w_{2} = 1.0$, and a molecular biomarker (high level coded as $1$) with weight $w_{3} = 2.0$. Let $n_{A,j,1}$ and $n_{B,j,1}$ denote the current counts in arms $A$ and $B$ at level $1$ of covariate $j \\in \\{1,2,3\\}$, respectively. The next patient has covariate profile $x = (x_{1}, x_{2}, x_{3}) = (1,1,1)$.\nThe current counts for level $1$ across arms are: $n_{A,1,1} = 18$, $n_{B,1,1} = 22$; $n_{A,2,1} = 15$, $n_{B,2,1} = 13$; $n_{A,3,1} = 9$, $n_{B,3,1} = 14$.\n\nDefine the covariate-imbalance score for a hypothetical assignment $t \\in \\{A,B\\}$ as\n$$\nS(t) \\;=\\; \\sum_{j=1}^{3} w_{j} \\left| \\left(n_{A,j,1} + \\mathbf{1}\\{t = A\\}\\,\\mathbf{1}\\{x_{j} = 1\\}\\right) - \\left(n_{B,j,1} + \\mathbf{1}\\{t = B\\}\\,\\mathbf{1}\\{x_{j} = 1\\}\\right) \\right|,\n$$\nwhich evaluates the weighted marginal imbalance for the specific levels occupied by the incoming patient.\n\nConstruct a biased-coin minimization allocation rule that:\n- is symmetric with respect to relabeling arms $A$ and $B$,\n- assigns higher probability to the arm resulting in a smaller imbalance score $S(t)$,\n- preserves randomness by maximizing uncertainty subject to a constraint on expected imbalance controlled by an intensity parameter $\\lambda = 0.25$.\n\nUsing this rule, compute the allocation probability to arm $A$ for the incoming patient based on the given data. Express your final answer as a decimal between $0$ and $1$, and round to four significant figures.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   Trial Design: Two-arm randomized controlled trial (A and B).\n-   Allocation Algorithm: Biased-coin minimization.\n-   Covariates and Weights:\n    -   $j=1$ (sex): weight $w_{1} = 0.5$.\n    -   $j=2$ (disease stage): weight $w_{2} = 1.0$.\n    -   $j=3$ (molecular biomarker): weight $w_{3} = 2.0$.\n-   Notation: $n_{A,j,1}$ and $n_{B,j,1}$ are the current counts in arms A and B for level $1$ of covariate $j$.\n-   Incoming Patient Profile: $x = (x_{1}, x_{2}, x_{3}) = (1, 1, 1)$.\n-   Current Counts for level $1$:\n    -   $j=1$: $n_{A,1,1} = 18$, $n_{B,1,1} = 22$.\n    -   $j=2$: $n_{A,2,1} = 15$, $n_{B,2,1} = 13$.\n    -   $j=3$: $n_{A,3,1} = 9$, $n_{B,3,1} = 14$.\n-   Covariate-Imbalance Score Definition for assignment $t \\in \\{A, B\\}$:\n    $$ S(t) = \\sum_{j=1}^{3} w_{j} \\left| \\left(n_{A,j,1} + \\mathbf{1}\\{t = A\\}\\,\\mathbf{1}\\{x_{j} = 1\\}\\right) - \\left(n_{B,j,1} + \\mathbf{1}\\{t = B\\}\\,\\mathbf{1}\\{x_{j} = 1\\}\\right) \\right| $$\n-   Allocation Rule Properties:\n    1.  Symmetric with respect to relabeling arms.\n    2.  Assigns higher probability to the arm with a smaller imbalance score $S(t)$.\n    3.  Maximizes uncertainty subject to a constraint on expected imbalance, controlled by an intensity parameter $\\lambda = 0.25$.\n-   Objective: Compute the allocation probability to arm A, $p_A$, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and scientifically sound. It describes a standard procedure in clinical biostatistics known as minimization, a method of covariate-adaptive randomization. The criteria for the allocation rule—maximizing uncertainty (entropy) for a given expected imbalance—uniquely specifies a probability distribution from the exponential family, often called a Gibbs distribution or softmax function in other contexts. This is a common and rigorous way to construct a biased-coin randomization scheme. All necessary data (weights, counts, patient profile, $\\lambda$ parameter) are provided and are consistent. The problem is therefore deemed valid.\n\n### Step 3: Proceed to Solution\n\nThe problem requires constructing a specific biased-coin allocation rule and applying it to find the probability of assigning the next patient to arm $A$.\n\nThe allocation rule must satisfy three properties. The property of \"maximizing uncertainty subject to a constraint on expected imbalance\" is a clear directive to use the principle of maximum entropy. For a discrete choice between two options (arm $A$ or arm $B$) with associated cost or score functions $S(A)$ and $S(B)$, the probability distribution that maximizes the Shannon entropy $H = -p_A \\ln(p_A) - p_B \\ln(p_B)$ for a given expected score $\\mathbb{E}[S] = p_A S(A) + p_B S(B)$ is the Gibbs distribution:\n$$ p_t = \\frac{\\exp(-\\lambda S(t))}{\\sum_{k \\in \\{A,B\\}} \\exp(-\\lambda S(k))} $$\nwhere $t \\in \\{A, B\\}$ and $\\lambda$ is the parameter that controls the trade-off between randomness (minimized at high $\\lambda$) and imbalance (minimized at high $\\lambda$). This form satisfies the other two properties as well: it is symmetric in $A$ and $B$, and if $S(A) < S(B)$, then $p_A > p_B$ for $\\lambda > 0$.\n\nThe task thus breaks down into two main parts:\n$1$. Calculate the imbalance scores $S(A)$ and $S(B)$ for the hypothetical assignments of the new patient to arm $A$ and arm $B$.\n$2$. Use these scores and the given parameter $\\lambda=0.25$ to compute the allocation probability $p_A$.\n\n**Part 1: Calculate Imbalance Scores**\n\nThe incoming patient has the covariate profile $x = (1, 1, 1)$, meaning $x_j=1$ for all $j \\in \\{1, 2, 3\\}$. The indicator function $\\mathbf{1}\\{x_j=1\\}$ is always $1$. The score function simplifies to:\n$$ S(t) = \\sum_{j=1}^{3} w_{j} \\left| \\left(n_{A,j,1} + \\mathbf{1}\\{t = A\\}\\right) - \\left(n_{B,j,1} + \\mathbf{1}\\{t = B\\}\\right) \\right| $$\n\nLet's calculate $S(A)$, the score if the patient is assigned to arm $A$ (so $t=A$):\nThe counts for level $1$ covariates would hypothetically become:\n-   $j=1$: $n_A = 18+1 = 19$, $n_B = 22$. Difference: $|19-22|=3$.\n-   $j=2$: $n_A = 15+1 = 16$, $n_B = 13$. Difference: $|16-13|=3$.\n-   $j=3$: $n_A = 9+1 = 10$, $n_B = 14$. Difference: $|10-14|=4$.\n\nThe total weighted imbalance score $S(A)$ is:\n$$ S(A) = w_1 |(18+1) - 22| + w_2 |(15+1) - 13| + w_3 |(9+1) - 14| $$\n$$ S(A) = (0.5)|-3| + (1.0)|3| + (2.0)|-4| $$\n$$ S(A) = (0.5)(3) + (1.0)(3) + (2.0)(4) = 1.5 + 3.0 + 8.0 = 12.5 $$\n\nNext, let's calculate $S(B)$, the score if the patient is assigned to arm $B$ (so $t=B$):\nThe counts for level $1$ covariates would hypothetically become:\n-   $j=1$: $n_A = 18$, $n_B = 22+1 = 23$. Difference: $|18-23|=5$.\n-   $j=2$: $n_A = 15$, $n_B = 13+1 = 14$. Difference: $|15-14|=1$.\n-   $j=3$: $n_A = 9$, $n_B = 14+1 = 15$. Difference: $|9-15|=6$.\n\nThe total weighted imbalance score $S(B)$ is:\n$$ S(B) = w_1 |18 - (22+1)| + w_2 |15 - (13+1)| + w_3 |9 - (14+1)| $$\n$$ S(B) = (0.5)|-5| + (1.0)|1| + (2.0)|-6| $$\n$$ S(B) = (0.5)(5) + (1.0)(1) + (2.0)(6) = 2.5 + 1.0 + 12.0 = 15.5 $$\n\nAs expected, $S(A) < S(B)$, so arm $A$ is the preferred arm to reduce covariate imbalance.\n\n**Part 2: Compute Allocation Probability**\n\nThe allocation probability for arm $A$, denoted $p_A$, is given by the formula:\n$$ p_A = \\frac{\\exp(-\\lambda S(A))}{\\exp(-\\lambda S(A)) + \\exp(-\\lambda S(B))} $$\nWe are given $\\lambda = 0.25$, and we have calculated $S(A) = 12.5$ and $S(B) = 15.5$.\n\nLet's compute the exponents:\n-   $-\\lambda S(A) = -0.25 \\times 12.5 = -3.125$\n-   $-\\lambda S(B) = -0.25 \\times 15.5 = -3.875$\n\nSubstituting these values into the probability formula:\n$$ p_A = \\frac{\\exp(-3.125)}{\\exp(-3.125) + \\exp(-3.875)} $$\nTo simplify the calculation, we can divide the numerator and the denominator by $\\exp(-3.125)$:\n$$ p_A = \\frac{1}{1 + \\frac{\\exp(-3.875)}{\\exp(-3.125)}} = \\frac{1}{1 + \\exp(-3.875 - (-3.125))} $$\n$$ p_A = \\frac{1}{1 + \\exp(-0.75)} $$\nAlternatively, we can express this as:\n$$ p_A = \\frac{1}{1 + \\exp(-\\lambda(S(B)-S(A)))} = \\frac{\\exp(\\lambda(S(B)-S(A)))}{1 + \\exp(\\lambda(S(B)-S(A)))} $$\nWith $S(B) - S(A) = 15.5 - 12.5 = 3.0$, and $\\lambda = 0.25$, the term in the exponent is $\\lambda(S(B)-S(A)) = 0.25 \\times 3.0 = 0.75$.\n$$ p_A = \\frac{\\exp(0.75)}{1 + \\exp(0.75)} $$\nNow, we compute the numerical value:\n$$ \\exp(0.75) \\approx 2.1170000166... $$\n$$ p_A \\approx \\frac{2.1170000166}{1 + 2.1170000166} = \\frac{2.1170000166}{3.1170000166} \\approx 0.67917290... $$\nThe problem requires rounding the final answer to four significant figures.\n$$ p_A \\approx 0.6792 $$",
            "answer": "$$\\boxed{0.6792}$$"
        },
        {
            "introduction": "Traditional fixed-sample trials can be inefficient, often continuing to completion even when early data suggests a treatment is ineffective. Two-stage adaptive designs offer a solution by incorporating a pre-planned interim analysis where a trial can be stopped early for futility, saving valuable time and resources. This practice problem  immerses you in a classic two-stage design scenario, where you will apply the decision rules to determine if a hypothetical trial should proceed and what performance is required in the second stage to declare success, cementing your understanding of how these efficient designs function.",
            "id": "4892401",
            "problem": "A single-arm Phase II oncology study is planned using a two-stage design to allow early termination for lack of activity while controlling type I error and power at design-specified levels. The binary endpoint is objective response (responder versus non-responder). The design specifies a first-stage enrollment of $n_1=18$ participants and a total maximum enrollment of $n=44$ participants. The early futility boundary is $r_1=3$: after the first stage, if the observed number of responders is $x_1 \\le r_1$, the trial stops for futility; otherwise, it proceeds to stage $2$. At the end of stage $2$, efficacy is declared if the total number of responders across both stages is at least the final boundary $r=10$.\n\nSuppose that after completing stage $1$, the observed number of responders is $x_1=5$. Using only the defining properties of this two-stage design and the arithmetic relationship between stage-wise and total responses, determine whether the trial continues beyond stage $1$, and compute the minimum number of additional responders required in stage $2$ among the additional $n-n_1$ participants so that the final decision at $n$ would declare efficacy. Let $Q$ denote this minimum required number of additional responders in stage $2$; report the value of $Q$ as a single integer. No rounding is needed.",
            "solution": "The problem is a valid application of the principles of a two-stage clinical trial design. All necessary parameters and conditions are provided, and the problem is scientifically grounded, well-posed, and objective. We may proceed with a formal solution.\n\nThe two-stage design is defined by the following parameters:\n-   The number of participants in stage $1$: $n_1 = 18$.\n-   The total number of participants if the trial proceeds to stage $2$: $n = 44$.\n-   The early futility boundary for stage $1$: $r_1 = 3$. If the number of responders in stage $1$, denoted by $x_1$, is less than or equal to this value ($x_1 \\le r_1$), the trial is terminated.\n-   The final efficacy boundary: $r = 10$. If the total number of responders across both stages, denoted by $x$, is greater than or equal to this value ($x \\ge r$), the trial is declared a success.\n\nThe problem provides the observed outcome from stage $1$: the number of responders is $x_1 = 5$.\n\nFirst, we must determine if the trial continues to the second stage. The rule for early termination for futility is to stop if $x_1 \\le r_1$. In this case, we have the observed value $x_1 = 5$ and the futility boundary $r_1 = 3$. We evaluate the condition:\n$$5 \\le 3$$\nThis inequality is false. Since the observed number of responders, $x_1=5$, is greater than the futility boundary, $r_1=3$, the trial does not stop for futility. Therefore, the trial proceeds to the second stage.\n\nIn the second stage, an additional number of participants, $n_2$, will be enrolled. The value of $n_2$ is the difference between the total planned enrollment and the stage $1$ enrollment:\n$$n_2 = n - n_1 = 44 - 18 = 26$$\nLet $x_2$ be the number of responders among these additional $n_2 = 26$ participants in stage $2$.\n\nThe total number of responders at the conclusion of the trial is the sum of responders from both stages:\n$$x = x_1 + x_2$$\nFor the trial to be declared a success (i.e., to declare efficacy), the total number of responders, $x$, must meet or exceed the final efficacy boundary, $r$. The condition for success is:\n$$x \\ge r$$\nSubstituting the expression for $x$, this becomes:\n$$x_1 + x_2 \\ge r$$\nWe are given the observed outcome from stage $1$, $x_1 = 5$, and the final boundary, $r = 10$. We can substitute these values into the inequality:\n$$5 + x_2 \\ge 10$$\nTo find the minimum number of responders required in stage $2$, we solve for $x_2$:\n$$x_2 \\ge 10 - 5$$\n$$x_2 \\ge 5$$\nThe variable $x_2$ represents a count of people (responders), so it must be a non-negative integer. The question asks for the minimum number of additional responders in stage $2$ required to declare efficacy. This quantity is denoted by $Q$. Based on the inequality $x_2 \\ge 5$, the smallest integer value that $x_2$ can take is $5$.\nTherefore, the minimum required number of additional responders in stage $2$ is:\n$$Q = 5$$\nThis is a feasible outcome, as it is possible to observe $5$ responders among the $n_2=26$ participants enrolled in stage $2$ (since $0 \\le 5 \\le 26$).",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "Modern clinical trials often investigate multiple treatments, endpoints, or subgroups, leading to a \"multiplicity\" problem where conducting many statistical tests inflates the overall probability of a false-positive finding. To maintain scientific integrity, the Family-Wise Error Rate (FWER)—the probability of making at least one Type I error—must be controlled. This exercise  tasks you with applying the Bonferroni-Holm method, a sequential procedure that is more powerful than the classic Bonferroni correction, to results from a multi-arm, multi-endpoint trial, providing practical experience in making robust statistical claims in the face of multiplicity.",
            "id": "4892393",
            "problem": "A multi-arm, multi-endpoint randomized controlled trial compares $m=3$ experimental treatments $\\{A,B,C\\}$ against a shared control on $e=2$ co-primary continuous endpoints $\\{E_{1},E_{2}\\}$. For each arm-endpoint pair, a two-sided large-sample $z$-test for superiority versus control is performed, based on standardized mean differences under a common variance assumption. The null hypotheses are $H_{A,1}$, $H_{A,2}$, $H_{B,1}$, $H_{B,2}$, $H_{C,1}$, and $H_{C,2}$, where $H_{X,j}$ states no difference between arm $X \\in \\{A,B,C\\}$ and control on endpoint $E_{j} \\in \\{E_{1},E_{2}\\}$.\n\nObserved $z$-statistics are:\n- $H_{A,1}$: $z=3.10$,\n- $H_{A,2}$: $z=2.50$,\n- $H_{B,1}$: $z=2.20$,\n- $H_{B,2}$: $z=1.99$,\n- $H_{C,1}$: $z=1.60$,\n- $H_{C,2}$: $z=0.80$.\n\nAssume the null distribution of each $z$-statistic is standard normal and compute two-sided $p$-values as $p = 2(1 - \\Phi(|z|))$, where $\\Phi$ is the cumulative distribution function of the standard normal distribution. Treat the family of all $m\\times e=6$ hypotheses as the multiplicity family requiring strong control of the Family-Wise Error Rate (FWER). Apply the Bonferroni-Holm (Holm) step-down method to obtain adjusted $p$-values for the six hypotheses and determine which are rejected at FWER level $\\alpha=0.05$.\n\nReport only the total number of null hypotheses rejected at $\\alpha=0.05$ using the Holm method across all six tests. The final answer must be a single integer.",
            "solution": "The problem requires the application of the Bonferroni-Holm (Holm) step-down method to a family of $m \\times e = 3 \\times 2 = 6$ null hypotheses to control the Family-Wise Error Rate (FWER) at a significance level of $\\alpha=0.05$. The total number of hypotheses is $k=6$.\n\nThe Holm procedure is executed in the following steps:\n\n**Step 1: Calculate unadjusted $p$-values**\n\nFirst, we must calculate the two-sided unadjusted $p$-value for each of the six null hypotheses using the given $z$-statistics and the formula $p = 2(1 - \\Phi(|z|))$, where $\\Phi$ is the cumulative distribution function (CDF) of the standard normal distribution $N(0,1)$.\n\n- For $H_{A,1}$ with $z=3.10$:\n$p_{A,1} = 2(1 - \\Phi(3.10))$. Using standard normal tables or a calculator, $\\Phi(3.10) \\approx 0.99903$.\n$p_{A,1} \\approx 2(1 - 0.99903) = 2(0.00097) = 0.00194$.\n\n- For $H_{A,2}$ with $z=2.50$:\n$p_{A,2} = 2(1 - \\Phi(2.50))$. $\\Phi(2.50) \\approx 0.99379$.\n$p_{A,2} \\approx 2(1 - 0.99379) = 2(0.00621) = 0.01242$.\n\n- For $H_{B,1}$ with $z=2.20$:\n$p_{B,1} = 2(1 - \\Phi(2.20))$. $\\Phi(2.20) \\approx 0.98610$.\n$p_{B,1} \\approx 2(1 - 0.98610) = 2(0.01390) = 0.02780$.\n\n- For $H_{B,2}$ with $z=1.99$:\n$p_{B,2} = 2(1 - \\Phi(1.99))$. $\\Phi(1.99) \\approx 0.97670$.\n$p_{B,2} \\approx 2(1 - 0.97670) = 2(0.02330) = 0.04660$.\n\n- For $H_{C,1}$ with $z=1.60$:\n$p_{C,1} = 2(1 - \\Phi(1.60))$. $\\Phi(1.60) \\approx 0.94520$.\n$p_{C,1} \\approx 2(1 - 0.94520) = 2(0.05480) = 0.10960$.\n\n- For $H_{C,2}$ with $z=0.80$:\n$p_{C,2} = 2(1 - \\Phi(0.80))$. $\\Phi(0.80) \\approx 0.78814$.\n$p_{C,2} \\approx 2(1 - 0.78814) = 2(0.21186) = 0.42372$.\n\n**Step 2: Order the unadjusted $p$-values**\n\nNext, we order the $p$-values from smallest to largest, denoting them as $p_{(1)}, p_{(2)}, \\dots, p_{(6)}$, and keep track of their corresponding null hypotheses $H_{(1)}, H_{(2)}, \\dots, H_{(6)}$.\n\n- $p_{(1)} = p_{A,1} \\approx 0.00194$ (Hypothesis $H_{A,1}$)\n- $p_{(2)} = p_{A,2} \\approx 0.01242$ (Hypothesis $H_{A,2}$)\n- $p_{(3)} = p_{B,1} \\approx 0.02780$ (Hypothesis $H_{B,1}$)\n- $p_{(4)} = p_{B,2} \\approx 0.04660$ (Hypothesis $H_{B,2}$)\n- $p_{(5)} = p_{C,1} \\approx 0.10960$ (Hypothesis $H_{C,1}$)\n- $p_{(6)} = p_{C,2} \\approx 0.42372$ (Hypothesis $H_{C,2}$)\n\n**Step 3: Apply the sequential comparison**\n\nThe Holm method proceeds sequentially by comparing each ordered $p$-value $p_{(j)}$ with a decreasingly stringent significance level $\\frac{\\alpha}{k-j+1}$, for $j = 1, 2, \\dots, k$. The FWER level is $\\alpha=0.05$ and the total number of hypotheses is $k=6$.\n\n- **For $j=1$**: Compare $p_{(1)}$ with $\\frac{\\alpha}{k-1+1} = \\frac{\\alpha}{6} = \\frac{0.05}{6} \\approx 0.00833$.\nWe have $p_{(1)} \\approx 0.00194$.\nThe condition is $0.00194 \\le 0.00833$. This is true.\nTherefore, we **reject** the null hypothesis $H_{(1)}$, which is $H_{A,1}$. We proceed to the next step.\n\n- **For $j=2$**: Compare $p_{(2)}$ with $\\frac{\\alpha}{k-2+1} = \\frac{\\alpha}{5} = \\frac{0.05}{5} = 0.01$.\nWe have $p_{(2)} \\approx 0.01242$.\nThe condition is $0.01242 \\le 0.01$. This is false.\nTherefore, we **fail to reject** the null hypothesis $H_{(2)}$, which is $H_{A,2}$.\n\nAccording to the Holm step-down procedure, once a null hypothesis is not rejected, the procedure stops, and all subsequent null hypotheses with larger $p$-values are also not rejected. Thus, we fail to reject $H_{(2)}, H_{(3)}, H_{(4)}, H_{(5)}$, and $H_{(6)}$.\n\n**Conclusion:**\n\nBased on the Bonferroni-Holm procedure, only the first null hypothesis in the ordered sequence, $H_{A,1}$, is rejected. All other five hypotheses ($H_{A,2}, H_{B,1}, H_{B,2}, H_{C,1}, H_{C,2}$) are not rejected at the FWER level of $\\alpha=0.05$.\n\nThe total number of rejected null hypotheses is $1$.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}