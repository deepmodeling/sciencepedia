{
    "hands_on_practices": [
        {
            "introduction": "在生存分析中，首要任务之一是从原始观测数据中估算生存概率。本练习将指导您使用生命表法（也称为精算方法），这是一种处理分组和删失数据的基本技术。通过亲手构建一个生命表来估算灯泡的寿命，您将掌握处理不完整数据和理解风险集随时间变化的核心技能。",
            "id": "1925049",
            "problem": "一家工程公司正在对一种新型号的工业灯泡进行可靠性研究。一批250个灯泡被投入测试，并在每周结束时记录其状态。如果灯泡烧坏，其寿命被视为‘失效’；如果因非失效原因（例如，意外破损或为其他实验而移除）而退出研究，则其寿命被视为‘删失’。该研究进行了五周，收集了以下数据：\n\n- **第1周（区间 [0, 1) 周）：** 10个失效，5个删失。\n- **第2周（区间 [1, 2) 周）：** 25个失效，3个删失。\n- **第3周（区间 [2, 3) 周）：** 40个失效，2个删失。\n- **第4周（区间 [3, 4) 周）：** 55个失效，0个删失。\n- **第5周（区间 [4, 5) 周）：** 30个失效，1个删失。\n\n为了处理删失数据，假设被删失的灯泡在其被撤出的区间内平均承担了一半时间的风险。使用精算方法和线性插值法，估计这些灯泡的中位生存时间。\n\n最终答案以周为单位，并四舍五入到三位有效数字。",
            "solution": "目标是找到中位生存时间，即生存函数 $S(t)$ 等于0.5时的时间 $t_m$。我们将首先使用精算方法构建一个生命表来估计生存函数 $S(t)$，然后使用线性插值法求出 $t_m$。\n\n生命表的计算按区间逐一进行。对于每个从时间 $t_i$ 开始到 $t_{i+1}$ 结束的区间 $i$：\n- $n_i$：在区间 $i$ 开始时处于风险中的项目数。\n- $d_i$：在区间 $i$ 内的失效（事件）数。\n- $c_i$：在区间 $i$ 内的删失项目数。\n- $n'_i$：在区间 $i$ 内的有效风险项目数。根据删失平均发生在区间中点的假设，其计算公式为 $n'_i = n_i - \\frac{c_i}{2}$。\n- $q_i$：在区间 $i$ 内的条件失效概率，计算公式为 $q_i = \\frac{d_i}{n'_i}$。\n- $p_i$：在区间 $i$ 内的条件生存概率，计算公式为 $p_i = 1 - q_i$。\n- $S(t_{i+1})$：存活到区间 $i$ 结束的累积概率。这是所有先前条件生存概率的乘积：$S(t_{i+1}) = S(t_i) \\times p_i$。我们从 $S(t_0) = S(0) = 1$ 开始。\n\n让我们根据所提供的数据填充生命表。\n\n**区间 1: [0, 1) 周**\n- 期初风险数，$n_0 = 250$。\n- 失效数，$d_0 = 10$。\n- 删失数，$c_0 = 5$。\n- 有效风险数，$n'_0 = 250 - \\frac{5}{2} = 247.5$。\n- 条件失效概率，$q_0 = \\frac{10}{247.5}$。\n- 条件生存概率，$p_0 = 1 - \\frac{10}{247.5} = \\frac{237.5}{247.5}$。\n- 在 $t=1$ 时的累积生存率，$S(1) = S(0) \\times p_0 = 1 \\times \\frac{237.5}{247.5} \\approx 0.959596$。\n\n**区间 2: [1, 2) 周**\n- 期初风险数，$n_1 = n_0 - d_0 - c_0 = 250 - 10 - 5 = 235$。\n- 失效数，$d_1 = 25$。\n- 删失数，$c_1 = 3$。\n- 有效风险数，$n'_1 = 235 - \\frac{3}{2} = 233.5$。\n- 条件失效概率，$q_1 = \\frac{25}{233.5}$。\n- 条件生存概率，$p_1 = 1 - \\frac{25}{233.5} = \\frac{208.5}{233.5}$。\n- 在 $t=2$ 时的累积生存率，$S(2) = S(1) \\times p_1 = \\left(\\frac{237.5}{247.5}\\right) \\times \\left(\\frac{208.5}{233.5}\\right) \\approx 0.857790$。\n\n**区间 3: [2, 3) 周**\n- 期初风险数，$n_2 = n_1 - d_1 - c_1 = 235 - 25 - 3 = 207$。\n- 失效数，$d_2 = 40$。\n- 删失数，$c_2 = 2$。\n- 有效风险数，$n'_2 = 207 - \\frac{2}{2} = 206$。\n- 条件失效概率，$q_2 = \\frac{40}{206} = \\frac{20}{103}$。\n- 条件生存概率，$p_2 = 1 - \\frac{20}{103} = \\frac{83}{103}$。\n- 在 $t=3$ 时的累积生存率，$S(3) = S(2) \\times p_2 \\approx 0.857790 \\times \\frac{83}{103} \\approx 0.691143$。\n\n**区间 4: [3, 4) 周**\n- 期初风险数，$n_3 = n_2 - d_2 - c_2 = 207 - 40 - 2 = 165$。\n- 失效数，$d_3 = 55$。\n- 删失数，$c_3 = 0$。\n- 有效风险数，$n'_3 = 165 - \\frac{0}{2} = 165$。\n- 条件失效概率，$q_3 = \\frac{55}{165} = \\frac{1}{3}$。\n- 条件生存概率，$p_3 = 1 - \\frac{1}{3} = \\frac{2}{3}$。\n- 在 $t=4$ 时的累积生存率，$S(4) = S(3) \\times p_3 \\approx 0.691143 \\times \\frac{2}{3} \\approx 0.460762$。\n\n我们现在已经确定 $S(3) \\approx 0.691143$ 且 $S(4) \\approx 0.460762$。由于 $S(3)  0.5$ 且 $S(4)  0.5$，中位生存时间 $t_m$ 位于区间 $[3, 4)$ 内。\n\n我们使用线性插值法来估计 $t_m$。线性插值的公式是：\n$t_m = t_j + w_j \\left( \\frac{S(t_j) - 0.5}{S(t_j) - S(t_{j+1})} \\right)$\n其中：\n- $t_j$ 是中位区间的起始时间，所以 $t_j = 3$ 周。\n- $w_j$ 是中位区间的宽度，所以 $w_j = 4 - 3 = 1$ 周。\n- $S(t_j)$ 是区间开始时的生存概率，$S(3) \\approx 0.691143$。\n- $S(t_{j+1})$ 是区间结束时的生存概率，$S(4) \\approx 0.460762$。\n\n代入数值：\n$t_m = 3 + 1 \\times \\left( \\frac{0.691143 - 0.5}{0.691143 - 0.460762} \\right)$\n$t_m = 3 + \\frac{0.191143}{0.230381}$\n$t_m \\approx 3 + 0.82968$\n$t_m \\approx 3.82968$\n\n题目要求答案四舍五入到三位有效数字。\n$t_m \\approx 3.83$ 周。",
            "answer": "$$\\boxed{3.83}$$"
        },
        {
            "introduction": "除了从数据直接估计的非参数方法，我们有时会假设生存时间遵循特定的数学模型。本练习探讨了当生存时间服从指数分布时的情形，指数分布是生存分析中最简洁的参数模型。您将通过计算一个深空探测器部件的条件生存概率，来揭示指数分布独特的“无记忆性”——这是一个在可靠性工程和许多其他领域都具有深刻含义的核心概念。",
            "id": "1925092",
            "problem": "对于任务规划者来说，深空探测器上一个关键低温泵的可靠性是一个主要问题。该部件的故障时间 $T$（以年为单位）被建模为一个连续随机变量。泵在 $t$ 年后仍然正常工作的概率由生存函数 $S(t) = \\exp(-\\lambda t)$ 描述，其中 $\\lambda = 0.08 \\text{ years}^{-1}$ 是恒定故障率。\n\n已知该泵在任务的最初 5.0 年里一直无故障运行，它至少能再继续工作 3.0 年的概率是多少？将您的最终答案四舍五入到三位有效数字。",
            "solution": "设 $T$ 为表示低温泵寿命（以年为单位）的随机变量。生存函数给出为 $S(t) = P(T  t) = \\exp(-\\lambda t)$，故障率为 $\\lambda = 0.08 \\text{ years}^{-1}$。\n\n我们需要求的是，在泵已经工作了 5.0 年的条件下，它至少能再工作 3.0 年的概率。这是一个条件概率。我们想计算 $P(T  5.0 + 3.0 \\mid T  5.0)$，可以写成 $P(T  8.0 \\mid T  5.0)$。\n\n两个事件 A 和 B 的条件概率定义为 $P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)}$。\n在我们的情况下，事件 A 是 $T  8.0$，事件 B 是 $T  5.0$。\n\n这两个事件的交集 $A \\cap B$ 是寿命 $T$ 大于 8.0 年且大于 5.0 年的条件。如果 $T  8.0$，那么它自动也大于 5.0。因此，交集就是 $T  8.0$。\n所以，$P(A \\cap B) = P(T  8.0)$。\n\n现在我们可以将条件概率写为：\n$$P(T  8.0 \\mid T  5.0) = \\frac{P(T  8.0)}{P(T  5.0)}$$\n\n我们可以使用给定的生存函数 $S(t) = P(T  t)$ 来表示这些概率：\n$P(T  8.0) = S(8.0) = \\exp(-\\lambda \\times 8.0)$\n$P(T  5.0) = S(5.0) = \\exp(-\\lambda \\times 5.0)$\n\n将这些代入我们的条件概率表达式中：\n$$P(T  8.0 \\mid T  5.0) = \\frac{\\exp(-\\lambda \\times 8.0)}{\\exp(-\\lambda \\times 5.0)}$$\n\n使用指数的性质 $\\frac{\\exp(a)}{\\exp(b)} = \\exp(a-b)$，我们得到：\n$$P(T  8.0 \\mid T  5.0) = \\exp(-\\lambda \\times 8.0 - (-\\lambda \\times 5.0)) = \\exp(-\\lambda \\times 8.0 + \\lambda \\times 5.0)$$\n$$P(T  8.0 \\mid T  5.0) = \\exp(-\\lambda(8.0 - 5.0)) = \\exp(-\\lambda \\times 3.0)$$\n\n这个结果展示了指数分布的无记忆性：再工作 3.0 年的概率与已经工作的 5.0 年无关，等于一个新泵工作 3.0 年的概率，即 $S(3.0)$。\n\n现在，我们代入 $\\lambda = 0.08 \\text{ years}^{-1}$ 的数值：\n$$P(\\text{survival}) = \\exp(-0.08 \\times 3.0) = \\exp(-0.24)$$\n\n计算数值：\n$$\\exp(-0.24) \\approx 0.78662786...$$\n\n问题要求将最终答案四舍五入到三位有效数字。前三位有效数字是 7、8 和 6。下一位数字是 6，所以我们将最后一位有效数字向上取整。\n$$0.787$$",
            "answer": "$$\\boxed{0.787}$$"
        },
        {
            "introduction": "计算出估计值只是分析工作的一半，一位优秀的统计学家还必须理解其估计的质量和局限性。本练习通过一个真实的临床试验场景，挑战您对数据删失如何影响Kaplan-Meier生存曲线估计的理解。您将深入思考在研究后期出现大量删失数据时，我们对生存概率估计的精确度（方差）和准确度（偏差）会产生何种影响，这对于正确解读分析结果至关重要。",
            "id": "1925065",
            "problem": "一个生物统计学团队正在分析一项为期5年的临床试验结果，该试验旨在评估一种旨在减缓一种非致命性慢性病进展的新治疗药物。研究关注的事件是疾病进展的一个特定的、明确定义的里程碑。该研究在时间 $t=0$ 招募了一大批患者。\n\n在研究的前四年，患者的随访情况非常好。然而，在第五年也就是最后一年，尚未经历关注事件的剩余患者中有相当一部分因与疾病状态无关的记录在案的原因（例如，为新工作而搬迁、不喜欢研究方案）而退出了研究。这些退出者在他们离开研究时被视为右删失数据点。\n\n该团队使用 Kaplan-Meier 方法来估计生存函数 $S(t)$，它表示患者在时间 $t$ 之前未经历疾病进展事件的概率。首席统计学家尤其关注分布尾部，特别是研究最后一年（即 $t \\in (4, 5]$ 年）$S(t)$ 估计的质量。\n\n以下哪个陈述最能描述这种大量的晚期右删失对分布尾部生存概率的 Kaplan-Meier 估计值产生的主要统计学后果？\n\nA. 估计值变得更精确（即方差更小），并且仍然是真实生存概率的无偏估计。\n\nB. 估计值变得不那么精确（即方差更大），但仍然是真实生存概率的无偏估计。\n\nC. 估计值变得有偏，倾向于高估真实的生存概率，并且也变得更精确。\n\nD. 估计值变得有偏，倾向于低估真实的生存概率，并且也变得不那么精确。\n\nE. 就偏差和精度而言，估计值基本不受影响，因为被删失的个体没有发生事件。",
            "solution": "问题询问的是在研究后期出现高比例右删失对 Kaplan-Meier (KM) 生存估计的统计学影响。我们需要分析对估计量的两个关键属性的影响：其偏差和其精度（方差）。\n\n首先，让我们回顾一下生存函数 $S(t)$ 的 Kaplan-Meier 估计量。设 $t_1  t_2  \\dots  t_k$ 是至少发生一次事件（疾病进展）的不同时间点。KM 估计值由以下乘积给出：\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right) $$\n这里，$d_i$ 是在时间 $t_i$ 发生事件的患者数量，而 $n_i$ 是在时间 $t_i$ 之前处于风险中（即存活且在观察中）的患者数量。\n\n**偏差分析：**\nKaplan-Meier 估计量有效性的一个关键假设是删失是无信息的。这意味着导致患者被删失的机制与他们的预后或经历事件的风险是独立的。问题陈述明确给出了退出的原因（“为新工作而搬迁、不喜欢研究方案”），这些原因“与他们的疾病状态无关”。在无信息删失的假设下，Kaplan-Meier 估计量被认为是对真实生存函数 $S(t)$ 的渐近无偏估计量。这意味着对于足够大的样本，估计量的期望值 $E[\\hat{S}(t)]$ 近似等于真实值 $S(t)$。大量的删失本身不会引入系统性地高估或低估生存概率的倾向。因此，我们可以得出结论，估计值仍然是无偏的。\n\n**精度（方差）分析：**\n精度是方差的倒数。一个不那么精确的估计具有更大的方差。Kaplan-Meier 估计量的方差可以使用 Greenwood 公式来近似：\n$$ \\text{Var}(\\hat{S}(t)) \\approx [\\hat{S}(t)]^2 \\sum_{i: t_i \\le t} \\frac{d_i}{n_i(n_i - d_i)} $$\n让我们分析这个公式中的各项。求和是对截至时间 $t$ 的所有事件时间进行的。问题指出，在研究的最后一年有大量的右删失。当一名患者被删失时，他们将从所有后续时间点的风险集中移除。因此，对于分布尾部（最后一年）的事件时间 $t_i$，处于风险中的患者数量 $n_i$ 将会显著减少。\n\n当 $n_i$ 变小时，方差公式中的项 $\\frac{d_i}{n_i(n_i - d_i)}$ 会变得非常大。例如，如果只有 $n_i = 5$ 名患者处于风险中，并且发生了 $d_i = 1$ 个事件，那么对总和的贡献是 $\\frac{1}{5(4)} = 0.05$。如果由于大量删失，只有 $n_i = 2$ 名患者处于风险中，并且发生了 $d_i = 1$ 个事件，那么贡献将是 $\\frac{1}{2(1)} = 0.5$，大了一个数量级。\n\n因为处于风险中的数量 $n_i$ 出现在分母中，所以一个小的风险集会导致一个大的方差。这意味着估计值 $\\hat{S}(t)$ 在分布的尾部变得高度不稳定和不确定。KM 曲线周围的置信区间会变得非常宽。因此，估计值的精度会显著降低。\n\n**结论：**\n晚期阶段的大量无信息右删失使得分布尾部处于风险中的患者数量变得非常小。这极大地增加了 Kaplan-Meier 估计值在较大 $t$ 时的方差，使其精度降低。然而，由于删失是无信息的，该估计量仍然是无偏的。\n\n综合这两个发现：\n- 估计值保持无偏。\n- 估计值变得不那么精确（方差增加）。\n\n这对应于选项 B。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}