{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Cox model, it's essential to understand its core engine: the partial likelihood. This exercise takes you back to first principles, asking you to construct the risk sets and derive the partial likelihood for a small, hypothetical cohort with delayed entry . Working through this calculation by hand provides a concrete intuition for how the model evaluates risk at each event time, a process fundamental to estimating hazard ratios.",
            "id": "4906397",
            "problem": "Consider a prospective cohort study analyzed with the Cox proportional hazards model (CPH), where the hazard for an individual with covariate value $x$ at time $t$ is $h(t \\mid x) = h_{0}(t)\\exp(\\beta x)$, with $h_{0}(t)$ an unspecified baseline hazard and $\\beta$ a regression coefficient. Assume delayed entry (left truncation), so that an individual $i$ with entry time $E_{i}$ is only at risk at time $t$ if $t \\geq E_{i}$, and an observed failure at time $T_{i}$ is indicated by $\\delta_{i} = 1$.\n\nYou observe two subjects with $(E,T,\\delta)$ equal to $(1,5,1)$ and $(3,6,1)$ and a single covariate $x$ taking values $x_{1} = 0$ and $x_{2} = 1$ for subject $1$ and subject $2$, respectively. Using the hazard-based definition of the Cox model and the concept of risk sets under delayed entry, do the following:\n\n- Identify the risk sets at the event times $t = 5$ and $t = 6$.\n- From first principles, derive the partial likelihood contributions at $t = 5$ and $t = 6$.\n- Simplify the overall partial likelihood as a single closed-form expression in $\\beta$.\n\nProvide your final answer as a single analytic expression in $\\beta$. No rounding is required, and no units are needed.",
            "solution": "The user has provided a well-posed problem in biostatistics concerning the derivation of a partial likelihood for a Cox proportional hazards model with delayed entry. The problem is scientifically grounded and contains all necessary information for its solution.\n\nThe Cox proportional hazards model specifies the hazard rate for an individual with covariate vector $\\mathbf{x}$ as:\n$$h(t \\mid \\mathbf{x}) = h_{0}(t)\\exp(\\boldsymbol{\\beta}' \\mathbf{x})$$\nIn this problem, we have a single covariate $x$, so the model simplifies to:\n$$h(t \\mid x) = h_{0}(t)\\exp(\\beta x)$$\nwhere $h_{0}(t)$ is the baseline hazard function, and $\\beta$ is the regression coefficient for the covariate $x$.\n\nThe partial likelihood is constructed by considering the conditional probability of observing the specific subject failing at each event time, given the set of subjects at risk at that time. A subject $i$ is said to be in the risk set at time $t$, denoted $R(t)$, if they have entered the study by time $t$ (i.e., $E_{i} \\leq t$) and have not yet failed or been censored (i.e., $T_{i} \\geq t$).\n\nThe given data are:\n- Subject 1: $(E_1, T_1, \\delta_1) = (1, 5, 1)$ with covariate $x_1 = 0$.\n- Subject 2: $(E_2, T_2, \\delta_2) = (3, 6, 1)$ with covariate $x_2 = 1$.\n\nThe problem requires us to work with the unique observed event times, which are $t=5$ and $t=6$.\n\nFirst, we must identify the risk sets at each event time.\n\n**1. Risk Set at $t = 5$**\nAn event occurs for subject 1 at $t=5$. The risk set $R(5)$ consists of all subjects $i$ for whom $E_i \\le 5$ and $T_i \\ge 5$.\n- For subject 1: $E_1 = 1 \\le 5$ and $T_1 = 5 \\ge 5$. Both conditions are met. Subject 1 is in $R(5)$.\n- For subject 2: $E_2 = 3 \\le 5$ and $T_2 = 6 \\ge 5$. Both conditions are met. Subject 2 is in $R(5)$.\nTherefore, the risk set at the first event time is $R(5) = \\{1, 2\\}$.\n\n**2. Risk Set at $t = 6$**\nAn event occurs for subject 2 at $t=6$. The risk set $R(6)$ consists of all subjects $i$ for whom $E_i \\le 6$ and $T_i \\ge 6$.\n- For subject 1: $E_1 = 1 \\le 6$ but $T_1 = 5 < 6$. The second condition is not met because subject 1 has already failed. Subject 1 is not in $R(6)$.\n- For subject 2: $E_2 = 3 \\le 6$ and $T_2 = 6 \\ge 6$. Both conditions are met. Subject 2 is in $R(6)$.\nTherefore, the risk set at the second event time is $R(6) = \\{2\\}$.\n\nNext, we derive the partial likelihood contributions from first principles. The contribution to the partial likelihood at an event time $t_j$ for subject $j$ is the ratio of the hazard of the subject who failed to the sum of the hazards of all subjects in the risk set at that time.\n$$ L_j(\\beta) = \\frac{h(t_j \\mid x_j)}{\\sum_{k \\in R(t_j)} h(t_j \\mid x_k)} = \\frac{h_0(t_j) \\exp(\\beta x_j)}{\\sum_{k \\in R(t_j)} h_0(t_j) \\exp(\\beta x_k)} = \\frac{\\exp(\\beta x_j)}{\\sum_{k \\in R(t_j)} \\exp(\\beta x_k)} $$\n\n**3. Partial Likelihood Contribution at $t=5$**\nAt $t=5$, subject 1 fails. The risk set is $R(5) = \\{1, 2\\}$. The covariates are $x_1=0$ and $x_2=1$. The contribution is:\n$$ L_{t=5}(\\beta) = \\frac{\\exp(\\beta x_1)}{\\exp(\\beta x_1) + \\exp(\\beta x_2)} = \\frac{\\exp(\\beta \\cdot 0)}{\\exp(\\beta \\cdot 0) + \\exp(\\beta \\cdot 1)} = \\frac{\\exp(0)}{\\exp(0) + \\exp(\\beta)} = \\frac{1}{1 + \\exp(\\beta)} $$\n\n**4. Partial Likelihood Contribution at $t=6$**\nAt $t=6$, subject 2 fails. The risk set is $R(6) = \\{2\\}$. The covariate is $x_2=1$. The contribution is:\n$$ L_{t=6}(\\beta) = \\frac{\\exp(\\beta x_2)}{\\exp(\\beta x_2)} = \\frac{\\exp(\\beta \\cdot 1)}{\\exp(\\beta \\cdot 1)} = 1 $$\n\nFinally, we find the overall partial likelihood by multiplying the contributions from all event times.\n$$ L(\\beta) = \\prod_{j \\text{ where } \\delta_j=1} L_{t_j}(\\beta) $$\nIn this case, we have two events, so the overall partial likelihood is:\n$$ L(\\beta) = L_{t=5}(\\beta) \\times L_{t=6}(\\beta) = \\left( \\frac{1}{1 + \\exp(\\beta)} \\right) \\times 1 $$\nSimplifying this expression gives the final form of the partial likelihood:\n$$ L(\\beta) = \\frac{1}{1 + \\exp(\\beta)} $$\nThis is the single closed-form expression for the overall partial likelihood as a function of $\\beta$.",
            "answer": "$$\\boxed{\\frac{1}{1 + \\exp(\\beta)}}$$"
        },
        {
            "introduction": "Real-world relationships are often more complex than simple main effects. This practice delves into modeling effect modification by including an interaction term between two covariates in a Cox model . Understanding how the effect of a treatment can vary across different levels of a biomarker is a crucial skill for personalized medicine and robust analysis, and this exercise will solidify your ability to correctly specify and interpret these more nuanced models.",
            "id": "4906518",
            "problem": "A cohort study follows patients from hospital discharge until cardiovascular death, recording time-to-event and censoring times. Investigators plan a Cox proportional hazards (PH) model to assess the effect of a binary treatment indicator $x_1$ (with $x_1=0$ for control and $x_1=1$ for treated) and a continuous baseline biomarker $x_2$ (mean-centered so that $x_2=0$ corresponds to the cohort mean). They suspect that the treatment effect may depend on the biomarker level and thus intend to include an interaction between $x_1$ and $x_2$. Which option correctly specifies how to include the interaction term in the Cox PH model and correctly interprets the interaction coefficient on the hazard ratio (HR) scale?\n\nA. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$. On the HR scale, $\\exp(\\beta_3)$ is the multiplicative change in the treatment HR per $1$-unit increase in $x_2$; that is, $\\dfrac{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2+1)}{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2)}=\\exp(\\beta_3)$.\n\nB. Specify $h(t \\mid x_1,x_2)=h_0(t)+\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2$; here $\\beta_3$ is the additional hazard due to interaction, and $\\exp(\\beta_3)$ is not meaningful on the HR scale.\n\nC. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$, but interpret $\\exp(\\beta_3)$ as the HR for a $1$-unit increase in $x_2$ regardless of $x_1$.\n\nD. Interactions cannot be included in a Cox PH model because they violate proportional hazards; any $x_1 x_2$ term would make hazards non-proportional over time.\n\nE. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$ and interpret $\\exp(\\beta_3)$ as the treatment HR at $x_2=0$.",
            "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Study Design**: A cohort study.\n- **Event of Interest**: Cardiovascular death.\n- **Data Collected**: Time-to-event and censoring times.\n- **Proposed Model**: Cox proportional hazards (PH) model.\n- **Covariates**:\n    - $x_1$: A binary treatment indicator, where $x_1=0$ for the control group and $x_1=1$ for the treated group.\n    - $x_2$: A continuous baseline biomarker, which is mean-centered so that $x_2=0$ represents the cohort mean.\n- **Hypothesis**: The effect of the treatment ($x_1$) may depend on the level of the biomarker ($x_2$).\n- **Objective**: Include an interaction term between $x_1$ and $x_2$ in the Cox PH model and correctly interpret the coefficient of this interaction term on the hazard ratio (HR) scale.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the field of biostatistics, specifically survival analysis. The Cox proportional hazards model is a standard and widely used method for analyzing time-to-event data. The inclusion of an interaction term to test for effect modification is a routine and critical aspect of multivariable modeling. The scenario described is a common and realistic application in clinical or epidemiological research.\n- **Well-Posed**: The problem is clearly stated and asks for a specific model formulation and the interpretation of a parameter within that model. A unique, correct answer exists based on the established theory of Cox regression.\n- **Objective**: The language is precise and uses standard terminology from biostatistics (e.g., \"cohort study\", \"Cox proportional hazards\", \"hazard ratio\", \"mean-centered\", \"interaction\"). There is no ambiguity or subjective content.\n- **Completeness and Consistency**: The problem provides all necessary information to determine the correct model form and parameter interpretation. The definitions of the variables and the modeling context are self-consistent.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a standard, well-posed question in biostatistics. The solution process can proceed.\n\n### Derivation of the Solution\nThe Cox proportional hazards model describes the hazard function $h(t)$ for an individual at time $t$ with a vector of covariates $\\mathbf{x}$ as:\n$$h(t \\mid \\mathbf{x}) = h_0(t) \\exp(\\boldsymbol{\\beta}' \\mathbf{x})$$\nwhere $h_0(t)$ is the baseline hazard function at time $t$, and $\\boldsymbol{\\beta}$ is a vector of regression coefficients.\n\nTo model the main effects of the treatment indicator $x_1$ and the biomarker $x_2$, as well as their interaction, the linear predictor $\\boldsymbol{\\beta}' \\mathbf{x}$ must include terms for $x_1$, $x_2$, and their product, $x_1 x_2$. The model is therefore specified as:\n$$h(t \\mid x_1, x_2) = h_0(t) \\exp(\\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_1 x_2)$$\nHere, $\\beta_1$ and $\\beta_2$ are the coefficients for the main effects of $x_1$ and $x_2$ respectively, and $\\beta_3$ is the coefficient for their interaction.\n\nNow, let us interpret these coefficients, focusing on the hazard ratio (HR). The HR is the ratio of hazards for two different sets of covariate values.\n\nThe primary quantity of interest is the effect of the treatment ($x_1=1$ vs. $x_1=0$). Due to the interaction term, this effect is conditional on the value of the biomarker $x_2$. The hazard for a treated individual ($x_1=1$) at a specific biomarker level $x_2$ is:\n$$h(t \\mid x_1=1, x_2) = h_0(t) \\exp(\\beta_1(1) + \\beta_2 x_2 + \\beta_3(1)x_2) = h_0(t) \\exp(\\beta_1 + \\beta_2 x_2 + \\beta_3 x_2)$$\nThe hazard for a control individual ($x_1=0$) at the same biomarker level $x_2$ is:\n$$h(t \\mid x_1=0, x_2) = h_0(t) \\exp(\\beta_1(0) + \\beta_2 x_2 + \\beta_3(0)x_2) = h_0(t) \\exp(\\beta_2 x_2)$$\n\nThe hazard ratio for treatment versus control, conditional on the biomarker level $x_2$, is:\n$$\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2) = \\frac{h(t \\mid x_1=1, x_2)}{h(t \\mid x_1=0, x_2)} = \\frac{h_0(t) \\exp(\\beta_1 + \\beta_2 x_2 + \\beta_3 x_2)}{h_0(t) \\exp(\\beta_2 x_2)} = \\exp(\\beta_1 + \\beta_3 x_2)$$\nThis equation shows that the log-hazard ratio for the treatment effect is a linear function of $x_2$, i.e., $\\ln(\\mathrm{HR}) = \\beta_1 + \\beta_3 x_2$.\n\nTo interpret $\\beta_3$, we examine how this HR changes as $x_2$ changes. Let's compare the treatment HR for an individual with biomarker level $x_2+1$ to the treatment HR for an individual with biomarker level $x_2$.\n- The treatment HR at $x_2+1$ is $\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2+1) = \\exp(\\beta_1 + \\beta_3(x_2+1))$.\n- The treatment HR at $x_2$ is $\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2) = \\exp(\\beta_1 + \\beta_3 x_2)$.\n\nThe ratio of these two hazard ratios is:\n$$ \\frac{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2+1)}{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2)} = \\frac{\\exp(\\beta_1 + \\beta_3(x_2+1))}{\\exp(\\beta_1 + \\beta_3 x_2)} = \\frac{\\exp(\\beta_1 + \\beta_3 x_2 + \\beta_3)}{\\exp(\\beta_1 + \\beta_3 x_2)} = \\exp(\\beta_3) $$\nThus, $\\exp(\\beta_3)$ represents the multiplicative change in the treatment hazard ratio for every $1$-unit increase in the biomarker $x_2$.\n\n### Option-by-Option Analysis\n\n**A. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$. On the HR scale, $\\exp(\\beta_3)$ is the multiplicative change in the treatment HR per $1$-unit increase in $x_2$; that is, $\\dfrac{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2+1)}{\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2)}=\\exp(\\beta_3)$.**\n- The model specification is the correct form for including an interaction in a Cox PH model.\n- The interpretation of $\\exp(\\beta_3)$ precisely matches our derivation. It is the factor by which the hazard ratio of treatment vs. control is multiplied for each $1$-unit increase in $x_2$.\n- **Verdict: Correct**\n\n**B. Specify $h(t \\mid x_1,x_2)=h_0(t)+\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2$; here $\\beta_3$ is the additional hazard due to interaction, and $\\exp(\\beta_3)$ is not meaningful on the HR scale.**\n- The model specified is an additive hazard model, not a Cox proportional hazards model. The Cox model specifies a multiplicative relationship between the baseline hazard and the covariate-dependent part, $h(t) = h_0(t) \\exp(\\dots)$.\n- **Verdict: Incorrect**\n\n**C. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$, but interpret $\\exp(\\beta_3)$ as the HR for a $1$-unit increase in $x_2$ regardless of $x_1$.**\n- The model specification is correct.\n- The interpretation is incorrect. The HR for a $1$-unit increase in $x_2$ is found by comparing the hazard at $x_2+1$ to the hazard at $x_2$, holding $x_1$ constant:\n$$ \\frac{h(t \\mid x_1, x_2+1)}{h(t \\mid x_1, x_2)} = \\frac{h_0(t)\\exp(\\beta_1 x_1 + \\beta_2(x_2+1) + \\beta_3 x_1(x_2+1))}{h_0(t)\\exp(\\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_1 x_2)} = \\exp(\\beta_2 + \\beta_3 x_1) $$\nThis HR depends on $x_1$. It is $\\exp(\\beta_2)$ for the control group ($x_1=0$) and $\\exp(\\beta_2+\\beta_3)$ for the treated group ($x_1=1$). It is not simply $\\exp(\\beta_3)$.\n- **Verdict: Incorrect**\n\n**D. Interactions cannot be included in a Cox PH model because they violate proportional hazards; any $x_1 x_2$ term would make hazards non-proportional over time.**\n- This statement is false. An interaction term between two covariates, like $x_1 x_2$, models effect modificationâ€”where the effect of one covariate depends on the level of another. It does *not* inherently violate the proportional hazards assumption. The PH assumption means that the ratio of hazards for any two individuals is constant over time. The model $h(t|\\mathbf{x}) = h_0(t)\\exp(\\beta_1 x_1 + \\beta_2 x_2 + \\beta_3 x_1 x_2)$ maintains this property. A violation of the PH assumption would be modeled by an interaction with time, e.g., a term like $\\beta_4 x_1 g(t)$, where $g(t)$ is a function of time.\n- **Verdict: Incorrect**\n\n**E. Specify $h(t \\mid x_1,x_2)=h_0(t)\\exp\\!\\big(\\beta_1 x_1+\\beta_2 x_2+\\beta_3 x_1 x_2\\big)$ and interpret $\\exp(\\beta_3)$ as the treatment HR at $x_2=0$.**\n- The model specification is correct.\n- The interpretation is incorrect. As derived previously, the treatment HR is $\\mathrm{HR}(x_1=1 \\text{ vs } 0 \\mid x_2) = \\exp(\\beta_1 + \\beta_3 x_2)$. At $x_2=0$ (the mean biomarker value), this HR is $\\exp(\\beta_1 + \\beta_3(0)) = \\exp(\\beta_1)$. The coefficient $\\beta_1$ represents the log-hazard ratio for treatment at the mean value of the biomarker. $\\exp(\\beta_3)$ is not the HR at any specific level of $x_2$.\n- **Verdict: Incorrect**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The power of the Cox model lies in its proportional hazards (PH) assumption, but we must always verify it. This hands-on exercise demonstrates a common and powerful method for diagnosing violations of the PH assumption using Schoenfeld residuals . By testing for a time-dependent trend in these residuals, you will learn how to formally assess whether a covariate's effect is stable over time, a critical step in ensuring your model is reliable.",
            "id": "4906532",
            "problem": "A cohort study of survival to infection was analyzed using the Cox proportional hazards model. Let the hazard function conditional on a single covariate $X$ be $h(t \\mid X) = h_{0}(t) \\exp\\{\\beta X\\}$, where the proportional hazards (PH) assumption states that the coefficient $\\beta$ does not vary with time $t$. To assess the PH assumption for $X$, scaled Schoenfeld residuals were computed at each event time and regressed on the logarithm of time, resulting in the simple linear model $r_{i} = \\gamma \\log t_{i} + \\varepsilon_{i}$, where $r_{i}$ is the scaled Schoenfeld residual at event time $t_{i}$, $\\gamma$ is the slope, and $\\varepsilon_{i}$ is a mean-zero error term. Under the PH assumption, $\\gamma = 0$.\n\nSuppose the regression yields an estimated slope $\\hat{\\gamma} = 0.22$ and its estimated standard error $se = 0.07$. Starting from the definition of the Cox model and the PH assumption, derive an appropriate standardized test statistic to test $H_{0} : \\gamma = 0$ based on large-sample properties of the slope estimator, compute its value using the given estimates, and interpret whether there is evidence of a violation of the proportional hazards assumption for $X$ at a two-sided significance level $\\alpha = 0.05$.\n\nRound your computed test statistic to four significant figures. No physical units are required.",
            "solution": "The problem asks for a hypothesis test to assess the proportional hazards (PH) assumption using the output from a regression of scaled Schoenfeld residuals on the logarithm of time.\n\n### Step 1: State the Hypothesis\nThe proportional hazards assumption for covariate $X$ implies that its coefficient $\\beta$ is constant over time. The Grambsch-Therneau test assesses this by checking for a non-zero slope in the relationship between Schoenfeld residuals and a function of time. Here, the model for the scaled residuals is $r_{i} = \\gamma \\log t_{i} + \\varepsilon_{i}$. A non-zero slope $\\gamma$ indicates that the effect of the covariate changes with time, thus violating the PH assumption.\nThe null and alternative hypotheses are:\n- Null Hypothesis ($H_0$): The PH assumption holds. This corresponds to $\\gamma = 0$.\n- Alternative Hypothesis ($H_A$): The PH assumption is violated. This corresponds to $\\gamma \\neq 0$.\n\n### Step 2: Choose the Test Statistic\nFor a large sample, the estimator for the regression slope, $\\hat{\\gamma}$, is approximately normally distributed. A standardized test statistic can be constructed to test if the true slope $\\gamma$ is zero. The appropriate statistic is the Wald test statistic, which is given by:\n$$\nW = \\frac{\\text{Estimate} - \\text{Null Value}}{\\text{Standard Error}} = \\frac{\\hat{\\gamma} - 0}{se(\\hat{\\gamma})}\n$$\nUnder the null hypothesis $H_0: \\gamma = 0$, this statistic follows a standard normal distribution, $W \\sim N(0, 1)$.\n\n### Step 3: Compute the Test Statistic\nThe problem provides the following values:\n- Estimated slope: $\\hat{\\gamma} = 0.22$\n- Standard error of the slope: $se = 0.07$\n\nPlugging these values into the formula for the Wald statistic:\n$$\nW = \\frac{0.22}{0.07} \\approx 3.142857...\n$$\nRounding to four significant figures, the test statistic is $3.143$.\n\n### Step 4: Make a Decision and Interpret the Result\nThe test is conducted at a two-sided significance level of $\\alpha = 0.05$. For a standard normal distribution, the critical values are $z_{\\alpha/2} = z_{0.025} = \\pm 1.96$.\nWe compare the absolute value of our computed test statistic to the critical value:\n$$\n|W| = |3.143| = 3.143\n$$\nSince $3.143 > 1.96$, our test statistic falls in the rejection region.\n\n**Conclusion:** We reject the null hypothesis $H_0$. There is statistically significant evidence at the $\\alpha = 0.05$ level to conclude that the slope $\\gamma$ is not zero. This indicates that the effect of the covariate $X$ is not constant over time, which constitutes a violation of the proportional hazards assumption for this covariate.",
            "answer": "$$\\boxed{3.143}$$"
        }
    ]
}