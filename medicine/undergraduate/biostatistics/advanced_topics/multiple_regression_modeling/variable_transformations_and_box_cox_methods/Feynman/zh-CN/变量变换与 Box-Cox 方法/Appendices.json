{
    "hands_on_practices": [
        {
            "introduction": "在许多统计模型中，一个基本假设是数据的方差是恒定的，即与均值无关。然而，在处理计数数据（如泊松分布）时，我们经常发现方差与均值是相关的。这个练习将引导你通过“德尔塔方法”（delta method）来从数学上证明为什么平方根变换是稳定泊松数据方差的有效手段 ()。通过这个推导，你将深入理解变量变换背后的理论依据，而不仅仅是将其作为一个黑箱工具来使用。",
            "id": "4965046",
            "problem": "一位生物统计学家将每个受试者的事件计数建模为泊松随机变量 $Y$，其均值为 $ \\mu > 0 $，因此 $ \\mathbb{E}[Y] = \\mu $ 且 $ \\operatorname{Var}(Y) = \\mu $。为了满足线性建模假设中要求方差在不同 $ \\mu $ 水平上近似恒定的条件，该生物统计学家考虑使用平方根变换 $ g(Y) = \\sqrt{Y} $，这是 Box–Cox 变换族的一个特例。使用一阶泰勒展开的理据（delta 方法），推导 $ g(Y) $ 的近似方差（用 $ \\mu $ 表示），并确定此变换是否能稳定方差，即主阶近似值不依赖于 $ \\mu $。请以单个精确常数的形式提供该近似方差。无需四舍五入，不涉及单位。",
            "solution": "问题是使用一阶泰勒展开（delta 方法）推导泊松分布随机变量的平方根变换的近似方差，并确定该变换是否具有方差稳定性。\n\n问题陈述已经过验证，被认为是合理的。这是一个在生物统计学中定义明确的问题，具有科学依据和内部一致性。\n\n令 $Y$ 为表示事件计数的随机变量。问题陈述 $Y$ 服从均值为 $\\mu > 0$ 的泊松分布。泊松分布的关键性质是其均值和方差：\n$$ \\mathbb{E}[Y] = \\mu $$\n$$ \\operatorname{Var}(Y) = \\mu $$\n目标是分析一个新的随机变量 $Z = g(Y)$ 的方差，其中变换由 $g(y) = \\sqrt{y}$ 给出。\n\n我们将使用 delta 方法，该方法基于函数 $g(Y)$ 在 $Y$ 的均值 $\\mu$ 附近的的一阶泰勒级数展开。展开式为：\n$$ g(Y) \\approx g(\\mu) + g'(\\mu)(Y - \\mu) $$\n这里，$g'(\\mu)$ 是 $g(y)$ 关于 $y$ 的一阶导数在 $y = \\mu$ 处的值。\n\n$g(Y)$ 的这个线性近似的方差被用来近似 $g(Y)$ 本身的方差。利用方差的性质，对于常数 $a$ 和 $b$，有 $\\operatorname{Var}(aX + b) = a^2 \\operatorname{Var}(X)$，我们得到：\n$$ \\operatorname{Var}(g(Y)) \\approx \\operatorname{Var}(g(\\mu) + g'(\\mu)(Y - \\mu)) $$\n由于 $g(\\mu)$ 和 $g'(\\mu)$ 是相对于随机变量 $Y$ 的常数，项 $g(\\mu)$ 对方差没有贡献。因此，\n$$ \\operatorname{Var}(g(Y)) \\approx \\operatorname{Var}(g'(\\mu)(Y - \\mu)) = [g'(\\mu)]^2 \\operatorname{Var}(Y - \\mu) $$\n此外，由于对于任何常数 $c$，都有 $\\operatorname{Var}(Y - c) = \\operatorname{Var}(Y)$，我们得到 delta 方法方差近似的一般公式：\n$$ \\operatorname{Var}(g(Y)) \\approx [g'(\\mu)]^2 \\operatorname{Var}(Y) $$\n\n现在，我们将此公式应用于具体问题。\n变换为 $g(y) = \\sqrt{y} = y^{1/2}$。\n$g(y)$ 的一阶导数是：\n$$ g'(y) = \\frac{d}{dy}(y^{1/2}) = \\frac{1}{2} y^{-1/2} = \\frac{1}{2\\sqrt{y}} $$\n我们在 $Y$ 的均值 $y = \\mu$ 处计算这个导数：\n$$ g'(\\mu) = \\frac{1}{2\\sqrt{\\mu}} $$\n我们已知对于泊松分布，$\\operatorname{Var}(Y) = \\mu$。将这些部分代入 delta 方法公式：\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx [g'(\\mu)]^2 \\operatorname{Var}(Y) = \\left( \\frac{1}{2\\sqrt{\\mu}} \\right)^2 \\cdot \\mu $$\n现在，我们简化表达式：\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx \\left( \\frac{1}{4\\mu} \\right) \\cdot \\mu $$\n$$ \\operatorname{Var}(\\sqrt{Y}) \\approx \\frac{\\mu}{4\\mu} = \\frac{1}{4} $$\n\n这个一阶近似的结果是，变换后的变量 $\\sqrt{Y}$ 的方差近似为 $\\frac{1}{4}$。\n如果变换后变量的方差近似为常数，即它不依赖于原始变量的均值 $\\mu$，则称该变换是方差稳定的。在这种情况下，近似方差是常数 $\\frac{1}{4}$，它与 $\\mu$ 无关。因此，平方根变换 $g(Y) = \\sqrt{Y}$ 是泊松分布的一种方差稳定变换，至少在 delta 方法提供的一阶近似下是如此。\n\n问题要求以单个精确常数的形式给出近似方差。这个值是 $\\frac{1}{4}$。",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "Box-Cox 变换在生物统计学中有着广泛的应用，其中一个非常重要的领域就是儿童生长发育评估。世界卫生组织（WHO）使用的 Lambda-Mu-Sigma (LMS) 方法正是基于 Box-Cox 变换，用以建立标准化的生长曲线。这个实践练习让你扮演一位儿科临床医生的角色，使用真实的 LMS 参数来计算一个儿童的年龄别体重 Z-评分 ()。通过这个计算，你将把抽象的统计概念与具体的临床诊断指标联系起来，体会统计方法在公共卫生领域的实际价值。",
            "id": "5216265",
            "problem": "一位儿科临床医生正在使用世界卫生组织（WHO）基于 Lambda-Mu-Sigma (LMS) 方法的生长标准来评估一名儿童。LMS 方法将给定年龄下的人体测量值 $Y$ 建模为经过 Box-Cox 族变换后近似服从正态分布的变量，该变换由三个特定于年龄和性别的参数控制：Box-Cox 幂 $L$、中位数 $M$ 和广义变异系数 $S$。标准化后的值被解释为 $Z$ 分数，它代表观测值与特定年龄和性别的参考值相差的标准差倍数。请仅从“$Y$ 关于参考值 $M$ 的 Box-Cox 变换可对偏度和离散度进行线性重缩放，以近似一个标准正态变量”这一基本定义出发，推导出适当的标准化公式，并计算一名年龄为 $24$ 个月、体重为 $y = 11.8$ 公斤的儿童的年龄别体重 $Z$ 分数。已知该年龄和性别的 LMS 参数为 $L = -0.1$，$M = 12.5$，$S = 0.09$。请以纯数字形式提供最终数值答案，不带单位，并四舍五入到四位有效数字。",
            "solution": "该问题陈述具有科学依据，内容自洽且表述清晰。Lambda-Mu-Sigma (LMS) 方法是世界卫生组织（WHO）用于制定生长曲线的一种标准且有据可查的统计技术。计算所需的所有参数和数据均已提供，不存在内部矛盾或不科学的前提。因此，该问题被认为是有效的，并将提供解答。\n\n任务是从 LMS 方法的基本原理推导出标准化 $Z$ 分数的公式，然后用它来计算一个具体的值。LMS 方法假定，在特定年龄下，给定的人体测量值 $Y$ 可以通过变换转化为一个服从标准正态分布的变量 $Z \\sim N(0, 1)$。这种变换基于 Box-Cox 幂变换，涉及三个参数：中位数 $M$、广义变异系数 $S$ 和 Box-Cox 幂参数 $L$。\n\n推导过程分三步进行：\n1.  **处理尺度和位置**：首先用特定年龄和性别下的中位数 $M$ 对测量值 $Y$ 进行缩放。这是通过考虑比率 $\\frac{Y}{M}$ 来实现的。这一步使得测量值与其绝对尺度无关，并将其中心置于 $1$ 左右。\n\n2.  **处理偏度**：使用 Box-Cox 变换对 $\\frac{Y}{M}$ 的偏态分布进行正态化。对于一个变量 $X$，其幂为 $\\lambda$ 的 Box-Cox 变换定义如下：\n    $$ T(X; \\lambda) = \\begin{cases} \\dfrac{X^\\lambda - 1}{\\lambda},  \\lambda \\neq 0 \\\\ \\ln(X),  \\lambda = 0 \\end{cases} $$\n    $\\lambda=0$ 的情况由极限 $\\lim_{\\lambda \\to 0} \\frac{X^\\lambda - 1}{\\lambda} = \\ln(X)$ 推导得出。在 LMS 方法中，幂用 $L$ 表示。将此变换应用于缩放后的测量值 $\\frac{Y}{M}$，我们得到变换后的变量，称之为 $Y_{T}$：\n    $$ Y_{T} = \\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{L} \\quad (\\text{for } L \\neq 0) $$\n    这个变换旨在生成一个近似服从正态分布且均值约为 $0$ 的变量 $Y_T$。\n\n3.  **处理离散度（标准化）**：问题陈述指出最终的标准化值是一个 $Z$ 分数，根据定义，其标准差必须为 $1$。变换后的变量 $Y_T$ 的标准差由参数 $S$（广义变异系数）给出。为了将 $Y_T$ 标准化为一个标准差为 $1$ 的变量 $Z$，我们必须将 $Y_T$ 除以其标准差 $S$。\n    $$ Z = \\frac{Y_T}{\\text{std.dev}(Y_T)} = \\frac{Y_T}{S} $$\n    代入 $Y_T$ 的表达式，我们推导出 $L \\neq 0$ 情况下的 $Z$ 分数公式：\n    $$ Z = \\frac{\\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{L}}{S} = \\frac{\\left(\\frac{Y}{M}\\right)^L - 1}{LS} $$\n    对于 $L=0$ 的特殊情况，变换是对数变换，公式变为：\n    $$ Z = \\frac{\\ln\\left(\\frac{Y}{M}\\right)}{S} $$\n推导现已完成。我们可以使用所提供的数据进行计算。\n\n给定的数值如下：\n-   实际体重：$y = 11.8$ 公斤\n-   特定年龄和性别的中位体重：$M = 12.5$\n-   特定年龄和性别的 Box-Cox 幂：$L = -0.1$\n-   特定年龄和性别的广义变异系数：$S = 0.09$\n\n由于 $L = -0.1 \\neq 0$，我们使用第一个推导出的公式：\n$$ Z = \\frac{\\left(\\frac{y}{M}\\right)^L - 1}{LS} $$\n将给定值代入公式：\n$$ Z = \\frac{\\left(\\frac{11.8}{12.5}\\right)^{-0.1} - 1}{(-0.1)(0.09)} $$\n首先，计算比率 $\\frac{y}{M}$：\n$$ \\frac{11.8}{12.5} = 0.944 $$\n现在，将此结果代回 $Z$ 的方程中：\n$$ Z = \\frac{(0.944)^{-0.1} - 1}{-0.009} $$\n接下来，我们计算分子中的项。幂项 $(0.944)^{-0.1}$ 的计算如下：\n$$ (0.944)^{-0.1} = \\exp(-0.1 \\times \\ln(0.944)) $$\n$$ \\ln(0.944) \\approx -0.0576352 $$\n$$ -0.1 \\times \\ln(0.944) \\approx 0.00576352 $$\n$$ \\exp(0.00576352) \\approx 1.0057801 $$\n现在，我们可以计算分子：\n$$ (0.944)^{-0.1} - 1 \\approx 1.0057801 - 1 = 0.0057801 $$\n最后，我们可以计算 $Z$ 分数 $Z$：\n$$ Z \\approx \\frac{0.0057801}{-0.009} \\approx -0.6422367 $$\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $6$、$4$、$2$ 和 $2$。第五位数字是 $3$，因此我们向下舍入。\n$$ Z \\approx -0.6422 $$\n这就是该儿童的年龄别体重 $Z$ 分数。",
            "answer": "$$\\boxed{-0.6422}$$"
        },
        {
            "introduction": "当我们在变换后（例如，对数尺度）的数据上建立模型后，一个常见的挑战是如何将预测结果准确地转换回原始尺度进行解释。一个常见的错误是简单地进行逆变换（如取指数），但这会导致系统性的偏差。这个练习将引导你推导在线性模型使用对数变换后，如何在原始尺度上计算条件均值的正确表达式 ()。通过这个过程，你将理解偏差产生的原因，并掌握如何应用修正因子以获得无偏的预测，这是进行准确模型解释和预测的关键一步。",
            "id": "4965126",
            "problem": "一项临床生物统计学研究使用 Box-Cox (BC) 变换对一个严格为正的生物标志物 $Y$（例如，浓度）与协变量 $X$ 的函数关系进行建模，该变换定义为\n$$\nT_{\\lambda}(y) = \\begin{cases}\n\\dfrac{y^{\\lambda} - 1}{\\lambda},  \\lambda \\neq 0 \\\\\n\\ln(y),  \\lambda = 0\n\\end{cases}\n$$\n假设模型选择确定 $\\lambda=0$，因此使用对数变换。假设以下对数线性模型成立：\n$$\n\\ln(Y)=X\\beta+\\varepsilon,\n$$\n其中 $\\varepsilon$ 独立于 $X$，且 $\\varepsilon\\sim \\mathcal{N}(0,\\sigma^{2})$，$\\mathcal{N}(0,\\sigma^{2})$ 表示均值为 $0$、方差为 $\\sigma^{2}$ 的正态分布。\n\n从条件期望的核心定义和广为接受的分布性质出发，推导原始尺度上条件均值 $E(Y\\mid X)$ 的解析表达式，并解释为什么从对数尺度对线性预测量进行朴素的反变换会引入偏差。找出校正此偏差的乘法因子，并用 $X$、$\\beta$ 和 $\\sigma^{2}$ 紧凑地表示最终的条件均值。请以 $E(Y\\mid X)$ 的单个闭式表达式形式提供最终答案。无需进行数值计算，最终表达式也无需单位。",
            "solution": "所述问题具有科学依据、提法恰当、客观，并包含得出唯一且有意义解所需的所有信息。它代表了对数线性模型背景下的一个标准和基本的推导，在生物统计学及相关定量领域中经常遇到。因此，该问题被认为是**有效的**，可以推导出完整的解。\n\n问题要求在给定一组协变量 $X$ 的情况下，计算原始尺度上生物标志物 $Y$ 的条件期望。其关系由以下对数线性模型定义：\n$$\n\\ln(Y) = X\\beta + \\varepsilon\n$$\n其中 $\\varepsilon$ 是一个随机误差项，它独立于 $X$，并服从均值为 $0$、方差为 $\\sigma^2$ 的正态分布，记为 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n为了求得条件期望 $E(Y \\mid X)$，我们必须首先用模型方程右侧的变量来表示 $Y$。我们可以通过对等式两边取指数来实现：\n$$\nY = \\exp(\\ln(Y)) = \\exp(X\\beta + \\varepsilon)\n$$\n现在，我们可以对 $Y$ 应用条件期望算子 $E(\\cdot \\mid X)$：\n$$\nE(Y \\mid X) = E[\\exp(X\\beta + \\varepsilon) \\mid X]\n$$\n利用指数函数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将表达式重写为：\n$$\nE(Y \\mid X) = E[\\exp(X\\beta) \\cdot \\exp(\\varepsilon) \\mid X]\n$$\n当我们以 $X$ 为条件时，任何关于 $X$ 的函数都被视为常数。因此，项 $\\exp(X\\beta)$ 可以从条件期望中提出来：\n$$\nE(Y \\mid X) = \\exp(X\\beta) \\cdot E[\\exp(\\varepsilon) \\mid X]\n$$\n问题陈述误差项 $\\varepsilon$ 独立于协变量 $X$。这种独立性的一个推论是，给定 $X$ 时，$\\varepsilon$ 的任何函数的条件期望都等于该函数的无条件期望。也就是说，对于任何函数 $g(\\cdot)$：\n$$\nE[g(\\varepsilon) \\mid X] = E[g(\\varepsilon)]\n$$\n将此应用于我们的具体情况，即 $g(\\varepsilon) = \\exp(\\varepsilon)$，我们有：\n$$\nE[\\exp(\\varepsilon) \\mid X] = E[\\exp(\\varepsilon)]\n$$\n将此结果代回到我们关于 $E(Y \\mid X)$ 的表达式中，得到：\n$$\nE(Y \\mid X) = \\exp(X\\beta) \\cdot E[\\exp(\\varepsilon)]\n$$\n剩下的任务是计算期望 $E[\\exp(\\varepsilon)]$。该项可被看作是随机变量 $\\varepsilon$ 的矩生成函数（MGF）在点 $t=1$ 处的值。设 $M_{\\varepsilon}(t)$ 表示 $\\varepsilon$ 的 MGF。根据定义：\n$$\nM_{\\varepsilon}(t) = E[\\exp(t\\varepsilon)]\n$$\n所以，我们需要求 $M_{\\varepsilon}(1)$。对于一个服从正态分布的随机变量 $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其 MGF 由标准公式给出：\n$$\nM_{Z}(t) = \\exp\\left(\\mu t + \\frac{1}{2}\\sigma^2 t^2\\right)\n$$\n在我们的问题中，误差项 $\\varepsilon$ 服从均值为 $\\mu=0$、方差为 $\\sigma^2$ 的正态分布，即 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。因此，其 MGF 为：\n$$\nM_{\\varepsilon}(t) = \\exp\\left(0 \\cdot t + \\frac{1}{2}\\sigma^2 t^2\\right) = \\exp\\left(\\frac{1}{2}\\sigma^2 t^2\\right)\n$$\n将此 MGF 在 $t=1$ 处求值，得到 $E[\\exp(\\varepsilon)]$ 的值：\n$$\nE[\\exp(\\varepsilon)] = M_{\\varepsilon}(1) = \\exp\\left(\\frac{1}{2}\\sigma^2 (1)^2\\right) = \\exp\\left(\\frac{\\sigma^2}{2}\\right)\n$$\n该项是参数为 $\\mu=0$ 和 $\\sigma^2$ 的对数正态分布的均值。\n\n最后，我们将此结果代回到 $Y$ 的条件均值方程中：\n$$\nE(Y \\mid X) = \\exp(X\\beta) \\cdot \\exp\\left(\\frac{\\sigma^2}{2}\\right)\n$$\n通过合并指数项，可以更紧凑地写成：\n$$\nE(Y \\mid X) = \\exp\\left(X\\beta + \\frac{\\sigma^2}{2}\\right)\n$$\n这个推导也解释了朴素反变换中偏差的来源。在对数尺度上，变换后响应的条件均值为 $E[\\ln(Y) \\mid X] = E[X\\beta + \\varepsilon \\mid X] = X\\beta + E[\\varepsilon] = X\\beta$。朴素的反变换将只是对此条件均值取指数：$\\exp(E[\\ln(Y) \\mid X]) = \\exp(X\\beta)$。然而，正如我们所证明的，原始尺度上的正确条件均值是 $E[Y \\mid X] = E[\\exp(\\ln(Y)) \\mid X] = \\exp(X\\beta + \\frac{\\sigma^2}{2})$。\n\n存在差异是因为非线性函数的期望不等于期望的函数。具体来说，对于严格凸函数 $g(z) = \\exp(z)$，根据琴生不等式，$E[g(Z)] \\ge g(E[Z])$，如果 $Z$ 不是常数，则不等式为严格不等。在我们的例子中，$Z = \\ln(Y) \\mid X$ 是一个方差为非零 $\\sigma^2$ 的随机变量，所以：\n$$\nE[Y \\mid X] = E[\\exp(\\ln Y) \\mid X] > \\exp(E[\\ln Y \\mid X]) = \\exp(X\\beta)\n$$\n朴素反变换 $\\exp(X\\beta)$ 系统地低估了真实的条件均值 $E(Y \\mid X)$。校正这种偏差所需的乘法因子正是我们推导出的项 $\\exp(\\frac{\\sigma^2}{2})$。这个因子，在非参数情境下常被称为“涂抹”估计，或者简称为对数正态校正因子，它在将预测转换回 $Y$ 的原始尺度时，考虑了对数尺度上误差的方差。",
            "answer": "$$\\boxed{\\exp\\left(X\\beta + \\frac{\\sigma^2}{2}\\right)}$$"
        }
    ]
}