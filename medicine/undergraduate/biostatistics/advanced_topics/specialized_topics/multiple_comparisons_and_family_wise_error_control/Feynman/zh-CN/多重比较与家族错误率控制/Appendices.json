{
    "hands_on_practices": [
        {
            "introduction": "在多重假设检验中，最直接的挑战是控制族系误差率（FWER）。本练习将指导您应用 Bonferroni 校正，这是一种基础且广泛使用的方法。通过一个生物标志物研究的实例，您将亲手计算校正后的显著性水平和调整 $p$ 值，从而牢固掌握 FWER 控制的基本原理。",
            "id": "4930328",
            "problem": "一项转化肿瘤学研究评估了五种预先指定的血清生物标志物在病例组和对照组之间是否存在水平差异。对于每种生物标志物，一项假设检验都会得出一个未经调整的 $p$-值。这一组检验需要进行联合解释，研究者试图使用 Bonferroni 原则将族系误差率 (FWER) 控制在 $\\alpha=0.05$ 的水平。\n\n给定 $m=5$ 个未经调整的 $p$-值，按生物标志物 1 至 5 的顺序排列为：$(0.003, 0.01, 0.02, 0.04, 0.06)$。\n\n从族系误差率 (FWER) 的定义（即在 $m$ 个原假设中犯至少一个 I类错误的概率）出发，使用基本概率原理来论证一个能将 FWER 控制在水平 $\\alpha$ 的 Bonferroni 决策规则，并确定哪些原假设被拒绝。然后，计算每种生物标志物的 Bonferroni 调整后的 $p$-值。\n\n将你的最终答案报告为一个包含 10 个条目的单行矩阵：前五个条目是按给定顺序排列的生物标志物 1 至 5 的 Bonferroni 调整后的 $p$-值，后五个条目是使用 Bonferroni 规则在族系水平 $\\alpha$ 下的拒绝指示符，其中 $1$ 表示“拒绝”，$0$ 表示“不拒绝”。无需四舍五入。",
            "solution": "该问题被评估为有效。它在科学上基于生物统计学原理，特别是多重假设检验。该问题提法明确，提供了所有必要数据，并且使用了清晰精确的语言，是客观的。\n\n任务是从族系误差率 (FWER) 的定义出发，论证 Bonferroni 校正的合理性，将其应用于一组给定的 $p$-值以确定哪些原假设被拒绝，并计算相应的 Bonferroni 调整后的 $p$-值。\n\n设有 $m$ 个原假设，$H_{0,1}, H_{0,2}, \\dots, H_{0,m}$。对于每个假设检验 $i$，我们得到一个 $p$-值 $p_i$。族系误差率 (FWER) 定义为在全部 $m$ 个检验中犯至少一个 I类错误（即拒绝一个真实的原假设）的概率。设 $E_i$ 为对第 $i$ 个假设犯 I类错误的事件。FWER 是这些事件并集的概率：\n$$\n\\text{FWER} = P\\left(\\bigcup_{i \\in I_0} E_i\\right)\n$$\n其中 $I_0$ 是真实原假设的索引集。为了控制 FWER，我们考虑所有原假设均为真的最坏情况，即 $I_0 = \\{1, 2, \\dots, m\\}$。在这种情况下，\n$$\n\\text{FWER} = P\\left(\\bigcup_{i=1}^{m} E_i\\right)\n$$\n根据布尔不等式（也称为联合界），事件并集的概率小于或等于它们各自概率的总和：\n$$\nP\\left(\\bigcup_{i=1}^{m} E_i\\right) \\leq \\sum_{i=1}^{m} P(E_i)\n$$\n当原假设 $H_{0,i}$ 为真时，如果我们拒绝它，就会发生检验 $i$ 的 I类错误。单个检验的决策规则是，如果其 $p$-值 $p_i$ 小于或等于某个显著性水平（我们称之为 $\\alpha_{ind}$，代表“单个”），则拒绝 $H_{0,i}$。在 $H_{0,i}$ 为真的条件下，此事件的概率即为检验的显著性水平的定义：$P(E_i) = P(p_i \\leq \\alpha_{ind} | H_{0,i} \\text{ 为真}) = \\alpha_{ind}$。\n\n将此代入不等式，我们得到：\n$$\n\\text{FWER} \\leq \\sum_{i=1}^{m} \\alpha_{ind}\n$$\nBonferroni 方法对所有检验使用相同的单个显著性水平，因此对于所有 $i=1, \\dots, m$，$\\alpha_{ind}$ 是一个常数。不等式简化为：\n$$\n\\text{FWER} \\leq m \\cdot \\alpha_{ind}\n$$\n为了将 FWER 控制在预先指定的水平 $\\alpha$，我们必须确保不等式的右侧不大于 $\\alpha$。我们设定 $m \\cdot \\alpha_{ind} \\leq \\alpha$，这得出 $\\alpha_{ind} \\leq \\frac{\\alpha}{m}$。为了使检验效力尽可能大（即使用尽可能大的单个显著性水平），我们选择 $\\alpha_{ind} = \\frac{\\alpha}{m}$。\n\n这就得出了 Bonferroni 决策规则：如果原假设 $H_{0,i}$ 的未经调整的 $p$-值 $p_i$ 小于或等于 Bonferroni 校正后的显著性阈值 $\\frac{\\alpha}{m}$，则拒绝该原假设。这个过程保证了 $\\text{FWER} \\leq \\alpha$。\n\n现在，我们将此规则应用于给定的问题。\n假设检验的数量为 $m=5$。\n期望的族系误差率为 $\\alpha=0.05$。\nBonferroni 校正后的显著性阈值为 $\\alpha_{adj} = \\frac{\\alpha}{m} = \\frac{0.05}{5} = 0.01$。\n\n给定的未经调整的 $p$-值分别为 $p_1=0.003$, $p_2=0.01$, $p_3=0.02$, $p_4=0.04$ 和 $p_5=0.06$。我们将每个 $p$-值与 $\\alpha_{adj} = 0.01$ 进行比较。\n\n1.  对于生物标志物 1：$p_1 = 0.003$。因为 $0.003 \\leq 0.01$，我们拒绝原假设 $H_{0,1}$。\n2.  对于生物标志物 2：$p_2 = 0.01$。因为 $0.01 \\leq 0.01$，我们拒绝原假设 $H_{0,2}$。\n3.  对于生物标志物 3：$p_3 = 0.02$。因为 $0.02 > 0.01$，我们不拒绝原假设 $H_{0,3}$。\n4.  对于生物标志物 4：$p_4 = 0.04$。因为 $0.04 > 0.01$，我们不拒绝原假设 $H_{0,4}$。\n5.  对于生物标志物 5：$p_5 = 0.06$。因为 $0.06 > 0.01$，我们不拒绝原假设 $H_{0,5}$。\n\n生物标志物 1 至 5 的拒绝指示符（$1$ 表示拒绝，$0$ 表示不拒绝）为 $(1, 1, 0, 0, 0)$。\n\n接下来，我们计算 Bonferroni 调整后的 $p$-值，记为 $\\tilde{p}_i$。调整后的 $p$-值定义为：如果 $\\tilde{p}_i \\leq \\alpha$，则可拒绝 $H_{0,i}$。原始的拒绝规则是 $p_i \\leq \\frac{\\alpha}{m}$。整理后得到 $m \\cdot p_i \\leq \\alpha$。因此，调整后的 $p$-值 $\\tilde{p}_i$ 是 $m \\cdot p_i$。由于概率不能超过 1，其正式定义为：\n$$\n\\tilde{p}_i = \\min(m \\cdot p_i, 1)\n$$\n我们对每种生物标志物计算该值，其中 $m=5$：\n\n1.  $\\tilde{p}_1 = \\min(5 \\times 0.003, 1) = \\min(0.015, 1) = 0.015$。\n2.  $\\tilde{p}_2 = \\min(5 \\times 0.01, 1) = \\min(0.05, 1) = 0.05$。\n3.  $\\tilde{p}_3 = \\min(5 \\times 0.02, 1) = \\min(0.10, 1) = 0.1$。\n4.  $\\tilde{p}_4 = \\min(5 \\times 0.04, 1) = \\min(0.20, 1) = 0.2$。\n5.  $\\tilde{p}_5 = \\min(5 \\times 0.06, 1) = \\min(0.30, 1) = 0.3$。\n\n生物标志物 1 至 5 的调整后 $p$-值分别为 $(0.015, 0.05, 0.1, 0.2, 0.3)$。我们可以使用这些调整后的 $p$-值与 $\\alpha=0.05$ 进行比较，来验证拒绝决策：\n- $\\tilde{p}_1 = 0.015 \\leq 0.05 \\implies$ 拒绝。\n- $\\tilde{p}_2 = 0.05 \\leq 0.05 \\implies$ 拒绝。\n- $\\tilde{p}_3 = 0.1 > 0.05 \\implies$ 不拒绝。\n- $\\tilde{p}_4 = 0.2 > 0.05 \\implies$ 不拒绝。\n- $\\tilde{p}_5 = 0.3 > 0.05 \\implies$ 不拒绝。\n这证实了之前的结论。\n\n最终答案要求一个单行矩阵，其中包含五个调整后的 $p$-值，后跟五个拒绝指示符。\n调整后的 $p$-值：$(0.015, 0.05, 0.1, 0.2, 0.3)$。\n拒绝指示符：$(1, 1, 0, 0, 0)$。\n\n合并后的行矩阵为 $(0.015, 0.05, 0.1, 0.2, 0.3, 1, 1, 0, 0, 0)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.015  0.05  0.1  0.2  0.3  1  1  0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "虽然 Bonferroni 校正简单有效，但它通常被认为是保守的，可能会错失一些真实的发现。Holm 程序作为一种更强大的序列拒绝（step-down）方法，通过逐级调整检验标准来提高统计功效。本练习将让您实践 Holm 程序的具体步骤，理解其如何比 Bonferroni 校正更精细地平衡第一类错误和统计功效。",
            "id": "4930339",
            "problem": "一位生物统计学研究员分析了$m=4$个预先指定的生物标志物与临床结果的关联性，得到了排序后的$p$值：$p_{(1)}=0.004$，$p_{(2)}=0.012$，$p_{(3)}=0.02$ 和 $p_{(4)}=0.08$。目标是使用Holm的序列拒绝降步程序，在$\\alpha=0.05$的水平上控制族系误差率 (FWER)。从族系误差率（即至少有一次错误拒绝的概率）的定义出发，并结合Bonferroni不等式以及按$p$值升序筛选假设的降步程序的逻辑，推导确保在$\\alpha$水平上对族系误差率进行强控制所需的逐步临界值。将您推导的程序应用于给定的排序后的$p$值，以确定有多少个原假设被拒绝。将最终答案报告为被拒绝的原假设的整数数量$k$。",
            "solution": "该问题经评估为有效，因为它具有科学依据、提法明确、客观且完整。它提出了一个基于既定原则的标准生物统计学任务。\n\n任务是为控制族系误差率 (FWER) 的Holm序列拒绝程序推导临界值，然后将其应用于给定的数据集。\n\n**第一部分：Holm程序的推导**\n\n族系误差率 (FWER) 定义为在所有被检验的假设中犯一个或多个I类错误（错误拒绝）的概率。设有$m$个原假设 $H_1, H_2, \\dots, H_m$，其对应的$p$值为$p_1, p_2, \\dots, p_m$。我们的目标是确保对于预先指定的显著性水平$\\alpha$，$FWER \\le \\alpha$。这被称为对FWER的强控制，因为它必须对任何为真和为假的原假设的组合都成立。令$V$为被错误拒绝的为真的原假设的数量。则FWER为$P(V \\ge 1)$。\n\n令$I_0$为$m_0$个真正为真的假设的索引集。与这些假设相对应的$p$值 $\\{p_i : i \\in I_0\\}$ 在它们各自的原假设下是独立同分布于均匀分布Uniform$(0,1)$的随机变量。\n\nHolm程序是一种降步法。首先，将$p$值从小到大排序：$p_{(1)} \\le p_{(2)} \\le \\dots \\le p_{(m)}$。令与这些排序后的$p$值相对应的假设为 $H_{(1)}, H_{(2)}, \\dots, H_{(m)}$。程序如下：\n对于 $j = 1, 2, \\dots, m$，将第$j$个排序后的$p$值$p_{(j)}$与临界值 $\\alpha_j = \\frac{\\alpha}{m-j+1}$进行比较。\n- 如果 $p_{(1)} > \\frac{\\alpha}{m}$，则停止且不拒绝任何假设。\n- 否则，拒绝$H_{(1)}$并继续检验$H_{(2)}$。\n- 如果 $p_{(2)} > \\frac{\\alpha}{m-1}$，则停止且只拒绝$H_{(1)}$。\n- 否则，拒绝$H_{(2)}$并继续检验$H_{(3)}$。\n- 这个过程继续下去。在第$j$步，如果 $p_{(j)} > \\frac{\\alpha}{m-j+1}$，则程序停止，只拒绝假设$H_{(1)}, \\dots, H_{(j-1)}$。如果 $p_{(j)} \\le \\frac{\\alpha}{m-j+1}$，则拒绝$H_{(j)}$，程序继续进行到第$j+1$步。\n\n为了推导和证明该程序在$\\alpha$水平上强控制FWER，我们必须证明对于任何为真的原假设子集$I_0$，都有$P(V \\ge 1) \\le \\alpha$。\n\n令$I_0$为$m_0$个为真的原假设的索引集。如果我们拒绝了至少一个$i \\in I_0$的假设$H_i$，就发生了I类错误。\n令$p_{\\min,0} = \\min_{i \\in I_0} \\{p_i\\}$ 为所有为真的原假设中最小的$p$值。\n设这个特定$p$值在整个排序列表中的排名为$k$，因此$p_{\\min,0} = p_{(k)}$。根据其定义，$H_{(k)}$是排序列表中的第一个为真的原假设（即假设$H_{(1)}, \\dots, H_{(k-1)}$必定是为假的原假设）。\n\n要发生任何I类错误，至少必须拒绝一个为真的原假设。因为Holm程序是序贯的，并且在第一次未能拒绝时就停止，所以如果要拒绝任何为真的原假设$H_{(l)}$（其中$l \\ge k$），那么包括$H_{(k)}$在内的所有在它之前的假设也必须被拒绝。因此，犯至少一个I类错误的事件等价于$H_{(k)}$被拒绝的事件。\n\n该程序拒绝$H_{(k)}$当且仅当对所有的$j=1, \\dots, k$都有$p_{(j)} \\le \\frac{\\alpha}{m-j+1}$。这必然意味着$p_{(k)} \\le \\frac{\\alpha}{m-k+1}$。因此，如果发生I类错误，则必然有$p_{(k)} \\le \\frac{\\alpha}{m-k+1}$。\n\n现在，我们将这个条件与为真的原假设的数量$m_0$联系起来。\n根据$p_{(k)}$是来自一个为真的原假设的最小$p$值的定义，所有$m_0$个为真的原假设都必须在集合$\\{H_{(k)}, H_{(k+1)}, \\dots, H_{(m)}\\}$中。这个集合的大小是$m-k+1$。\n因此，为真的原假设的数量不能超过这个集合的大小，这就得到了不等式$m_0 \\le m-k+1$。\n这个不等式可以重新整理为$\\frac{1}{m-k+1} \\le \\frac{1}{m_0}$。\n\n结合这些发现，发生I类错误的条件意味着：\n$p_{(k)} \\le \\frac{\\alpha}{m-k+1} \\le \\frac{\\alpha}{m_0}$。\n令$E$为犯至少一个I类错误的事件。我们已经证明$E$的发生意味着条件$p_{(k)} \\le \\frac{\\alpha}{m_0}$成立。这意味着$E$是事件$\\{p_{(k)} \\le \\frac{\\alpha}{m_0}\\}$的子集。\n因此，$FWER = P(E) \\le P(p_{(k)} \\le \\frac{\\alpha}{m_0})$。\n\n回顾一下，$p_{(k)}$是来自为真的原假设的$m_0$个$p$值$\\{p_i : i \\in I_0\\}$中的最小值。因此，事件$\\{p_{(k)} \\le \\frac{\\alpha}{m_0}\\}$等价于这$m_0$个$p$值中至少有一个小于或等于$\\frac{\\alpha}{m_0}$的事件。我们可以将其表示为事件的并集：\n$P(p_{(k)} \\le \\frac{\\alpha}{m_0}) = P\\left( \\bigcup_{i \\in I_0} \\left\\{p_i \\le \\frac{\\alpha}{m_0}\\right\\} \\right)$。\n\n我们现在应用Bonferroni不等式（也称为Boole不等式），该不等式表明对于任何事件集$A_1, \\dots, A_n$，都有$P(\\cup_{i=1}^n A_i) \\le \\sum_{i=1}^n P(A_i)$。\n将此应用于我们的情况：\n$P\\left( \\bigcup_{i \\in I_0} \\left\\{p_i \\le \\frac{\\alpha}{m_0}\\right\\} \\right) \\le \\sum_{i \\in I_0} P\\left(p_i \\le \\frac{\\alpha}{m_0}\\right)$。\n\n对于每个为真的原假设$H_i$，$p$值$p_i$服从$U(0,1)$分布。因此，对于任何值$x \\in [0,1]$，都有$P(p_i \\le x) = x$。令$x=\\frac{\\alpha}{m_0}$，我们得到$P(p_i \\le \\frac{\\alpha}{m_0}) = \\frac{\\alpha}{m_0}$。\n将此代入求和式中：\n$\\sum_{i \\in I_0} P\\left(p_i \\le \\frac{\\alpha}{m_0}\\right) = \\sum_{i \\in I_0} \\frac{\\alpha}{m_0} = m_0 \\times \\frac{\\alpha}{m_0} = \\alpha$。\n\n综上所述，我们已经证明：\n$FWER = P(E) \\le P(p_{(k)} \\le \\frac{\\alpha}{m_0}) \\le \\alpha$。\n这证明了Holm程序在$\\alpha$水平上强控制FWER。推导出的逐步临界值确实是$\\alpha_j = \\frac{\\alpha}{m-j+1}$，其中$j=1, \\dots, m$。\n\n**第二部分：应用于给定问题**\n\n我们有以下给定条件：\n- 假设数量：$m=4$。\n- FWER控制水平：$\\alpha=0.05$。\n- 排序后的$p$值：$p_{(1)}=0.004$，$p_{(2)}=0.012$，$p_{(3)}=0.02$ 和 $p_{(4)}=0.08$。\n\n我们逐步应用Holm程序。\n\n**步骤 1 ($j=1$):**\n- 检验假设$H_{(1)}$，其$p$值为 $p_{(1)} = 0.004$。\n- 临界值为 $\\alpha_1 = \\frac{\\alpha}{m-1+1} = \\frac{0.05}{4} = 0.0125$。\n- 我们将$p_{(1)}$与$\\alpha_1$进行比较：$0.004 \\le 0.0125$。\n- 条件满足，因此我们拒绝$H_{(1)}$并进行下一步。\n\n**步骤 2 ($j=2$):**\n- 检验假设$H_{(2)}$，其$p$值为 $p_{(2)} = 0.012$。\n- 临界值为 $\\alpha_2 = \\frac{\\alpha}{m-2+1} = \\frac{0.05}{3} \\approx 0.01667$。\n- 我们将$p_{(2)}$与$\\alpha_2$进行比较：$0.012 \\le \\frac{0.05}{3}$。\n- 条件满足，因此我们拒绝$H_{(2)}$并进行下一步。\n\n**步骤 3 ($j=3$):**\n- 检验假设$H_{(3)}$，其$p$值为 $p_{(3)} = 0.02$。\n- 临界值为 $\\alpha_3 = \\frac{\\alpha}{m-3+1} = \\frac{0.05}{2} = 0.025$。\n- 我们将$p_{(3)}$与$\\alpha_3$进行比较：$0.02 \\le 0.025$。\n- 条件满足，因此我们拒绝$H_{(3)}$并进行下一步。\n\n**步骤 4 ($j=4$):**\n- 检验假设$H_{(4)}$，其$p$值为 $p_{(4)} = 0.08$。\n- 临界值为 $\\alpha_4 = \\frac{\\alpha}{m-4+1} = \\frac{0.05}{1} = 0.05$。\n- 我们将$p_{(4)}$与$\\alpha_4$进行比较：$0.08 > 0.05$。\n- 条件不满足。我们未能拒绝$H_{(4)}$并停止程序。\n\n根据此程序，我们拒绝了与三个最小$p$值相对应的原假设：$H_{(1)}、H_{(2)}$和$H_{(3)}$。被拒绝的原假设总数为$k=3$。",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "仅仅掌握如何应用一个统计方法是不够的，理解其背后的假设和适用边界同样至关重要。本练习设计了一个精巧的思想实验，探讨 $p$ 值之间的依赖性如何影响多重比较校正的结果。通过分析一个负相关的极端案例，您将揭示为何 Šidák 等基于独立性假设的方法可能会失效，而 Bonferroni 校正却能保持其有效性，从而深化对统计方法稳健性的理解。",
            "id": "4930323",
            "problem": "一位生物统计学家检验 $m=2$ 个原假设，这两个假设都为真。检验产生了有效的单检验 $p$ 值，其零分布在边际上恰好是 $\\mathrm{Uniform}(0,1)$。为了在保持边际有效性的同时有意地在检验之间引入负相关性，该生物统计学家在全局原假设下抽取单个随机变量 $U \\sim \\mathrm{Uniform}(0,1)$，并设置 $p_{1} = U$ 和 $p_{2} = 1 - U$，以此构造这对 $p$ 值。这种构造方法产生了完全负相关的 $p$ 值，且其边际分布是正确的 $\\mathrm{Uniform}(0,1)$ 分布。\n\n从第一性原理出发——即族系误差率（FWER）的定义（在全局原假设下至少发生一次I类错误的概率）以及并集界（Bonferroni不等式）（对于任意事件 $A_{1}, A_{2}$ 满足 $\\mathbb{P}(A_{1} \\cup A_{2}) \\leq \\mathbb{P}(A_{1}) + \\mathbb{P}(A_{2})$）——回答以下问题：\n\n1. 仅使用这些核心定义，推导当 $m=2$ 个检验的共同拒绝阈值设为 $t_{\\mathrm{B}} = \\alpha/2$ 时，Bonferroni程序的族系误差率（FWER），并用目标族水平 $\\alpha$ 表示。\n\n2. 根据定义Šidák校正的独立性原理，确定当检验统计量（或 $p$ 值）独立时，能将FWER控制在水平 $\\alpha$ 的阈值 $t_{\\mathrm{S}}$。用 $\\alpha$ 表示当 $m=2$ 时的 $t_{\\mathrm{S}}$。\n\n3. 在上述负相关场景中，计算使用你在第2部分中推导出的Šidák阈值 $t_{\\mathrm{S}}$ 所达到的实际FWER，将其表示为 $\\alpha$ 的函数。你的推导应仅依赖于给定的定义和 $(p_{1}, p_{2})$ 的指定联合构造。\n\n4. 简要解释 $(p_{1}, p_{2})$ 中的负相关性是如何违反Šidák等式 $\\mathbb{P}(\\text{无拒绝})$ 所依赖的独立性假设的，并说明为何这会使Šidák校正变得反保守（anti-conservative），而Bonferroni校正却仍能控制FWER。\n\n在此负相关场景下，计算当 $\\alpha = 0.05$ 时Šidák FWER的数值，并将你的答案以四舍五入到四位有效数字的小数形式报告。",
            "solution": "所述问题具有科学依据，表述清晰，客观且内部一致。它在多重比较理论中呈现了一个标准的、尽管是程式化的场景，用以检验对基本原理的理解。所有必要信息均已提供。因此，该问题是有效的，可以构建解决方案。\n\n解决方案将按顺序处理问题的四个部分。\n\n设 $m=2$ 为原假设的数量，且两个假设都为真。两个 $p$ 值 $p_1$ 和 $p_2$ 由单个随机变量 $U \\sim \\mathrm{Uniform}(0,1)$ 构造，即 $p_1 = U$ 和 $p_2 = 1-U$。这确保了在边际上，$p_1 \\sim \\mathrm{Uniform}(0,1)$ 和 $p_2 \\sim \\mathrm{Uniform}(0,1)$，但它们是完全负相关的。目标族系误差率（FWER）为 $\\alpha$。\n\n**1. Bonferroni程序的族系误差率（FWER）**\n\nFWER定义为犯至少一次I类错误的概率。对于检验 $i$，如果我们在原假设 $H_i$ 为真时拒绝了它，就发生了I类错误。在这个问题中，两个原假设都为真。如果 $p_i \\le t$（其中 $t$ 是拒绝阈值），则发生拒绝。\n\n$\\mathrm{FWER} = \\mathbb{P}(\\text{拒绝至少一个 } H_i) = \\mathbb{P}(p_1 \\le t \\cup p_2 \\le t)$\n\nBonferroni程序设置了一个共同的拒绝阈值 $t_{\\mathrm{B}} = \\alpha/m$。对于 $m=2$，该阈值为 $t_{\\mathrm{B}} = \\alpha/2$。\n\n问题要求使用并集界（Bonferroni不等式）进行推导，该不等式指出，对于任意两个事件 $A_1$ 和 $A_2$，$\\mathbb{P}(A_1 \\cup A_2) \\le \\mathbb{P}(A_1) + \\mathbb{P}(A_2)$。设 $A_i$ 为检验 $i$ 被拒绝的事件，即 $A_i = \\{p_i \\le t_{\\mathrm{B}}\\}$。\n\n将并集界应用于FWER的定义：\n$\\mathrm{FWER} = \\mathbb{P}(p_1 \\le \\alpha/2 \\cup p_2 \\le \\alpha/2) \\le \\mathbb{P}(p_1 \\le \\alpha/2) + \\mathbb{P}(p_2 \\le \\alpha/2)$\n\n由于两个 $p$ 值都被构造成边际上服从 $\\mathrm{Uniform}(0,1)$ 分布，因此对于任何值 $x \\in [0,1]$，我们有 $\\mathbb{P}(p_i \\le x) = x$。\n将此代入不等式中：\n$\\mathrm{FWER} \\le \\frac{\\alpha}{2} + \\frac{\\alpha}{2} = \\alpha$\n\n这个推导表明，Bonferroni程序通过设计将FWER控制在水平 $\\alpha$（即 $\\mathrm{FWER} \\le \\alpha$），因为该不等式在任何 $p$ 值间的相关性结构下都成立。值得注意的是，对于给定的特定负相关性，实际的FWER恰好为 $\\alpha$。事件 $\\{p_1 \\le \\alpha/2\\}$ 和 $\\{p_2 \\le \\alpha/2\\}$ 变为 $\\{U \\le \\alpha/2\\}$ 和 $\\{1-U \\le \\alpha/2\\} \\equiv \\{U \\ge 1-\\alpha/2\\}$。对于典型的 $\\alpha$（例如 $\\alpha < 1$），这些事件是互斥的，因此它们并集的概率是它们各自概率之和，得出精确的FWER为 $\\alpha/2 + \\alpha/2 = \\alpha$。\n\n**2. Šidák校正阈值**\n\nŠidák校正是基于检验统计量（因此也包括 $p$ 值）独立的假设推导出来的。其目标是将FWER控制在水平 $\\alpha$。\n$\\mathrm{FWER} = 1 - \\mathbb{P}(\\text{无拒绝}) = \\alpha$\n\n“无拒绝”事件是指所有 $p$ 值都大于阈值 $t_{\\mathrm{S}}$：$\\mathbb{P}(p_1 > t_{\\mathrm{S}} \\text{ and } p_2 > t_{\\mathrm{S}} \\text{ and } \\dots \\text{ and } p_m > t_{\\mathrm{S}})$。\n在独立性假设下，这个概率变成一个乘积：\n$\\mathbb{P}(\\text{无拒绝}) = \\prod_{i=1}^{m} \\mathbb{P}(p_i > t_{\\mathrm{S}})$\n\n对于 $m=2$ 和 $p_i \\sim \\mathrm{Uniform}(0,1)$，我们有 $\\mathbb{P}(p_i > t_{\\mathrm{S}}) = 1 - t_{\\mathrm{S}}$。\n因此，我们设置“无拒绝”的概率以达到期望的FWER：\n$(1 - t_{\\mathrm{S}})^{2} = 1 - \\alpha$\n\n求解 $t_{\\mathrm{S}}$：\n$1 - t_{\\mathrm{S}} = \\sqrt{1 - \\alpha}$\n$t_{\\mathrm{S}} = 1 - \\sqrt{1 - \\alpha}$\n\n这就是对于 $m=2$ 个独立检验的Šidák阈值。\n\n**3. 在负相关场景下使用Šidák阈值的实际FWER**\n\n我们现在计算当使用阈值 $t_{\\mathrm{S}} = 1 - \\sqrt{1 - \\alpha}$ 和给定的负相关 $p$ 值 $p_1 = U$ 及 $p_2 = 1-U$ 时的实际FWER。\n\n实际FWER为：\n$\\mathrm{FWER}_{\\text{actual}} = \\mathbb{P}(p_1 \\le t_{\\mathrm{S}} \\cup p_2 \\le t_{\\mathrm{S}})$\n\n代入 $p_1$ 和 $p_2$ 的定义：\n$\\mathrm{FWER}_{\\text{actual}} = \\mathbb{P}(U \\le t_{\\mathrm{S}} \\cup 1-U \\le t_{\\mathrm{S}})$\n第二个事件 $1-U \\le t_{\\mathrm{S}}$ 等价于 $U \\ge 1-t_{\\mathrm{S}}$。\n$\\mathrm{FWER}_{\\text{actual}} = \\mathbb{P}(U \\le t_{\\mathrm{S}} \\cup U \\ge 1-t_{\\mathrm{S}})$\n\n为了计算这个概率，我们必须检查这两个事件是否互斥。如果 $t_{\\mathrm{S}} < 1 - t_{\\mathrm{S}}$，即 $2t_{\\mathrm{S}} < 1$ 或 $t_{\\mathrm{S}} < 1/2$，则事件是不相交的。\n代入 $t_{\\mathrm{S}}$ 的表达式：$1 - \\sqrt{1-\\alpha} < 1/2 \\implies 1/2 < \\sqrt{1-\\alpha} \\implies 1/4 < 1-\\alpha \\implies \\alpha < 3/4$。对于任何常规的 $\\alpha$（例如 $\\alpha=0.05$），此条件都成立。\n由于事件是互斥的，它们并集的概率是它们各自概率的和：\n$\\mathrm{FWER}_{\\text{actual}} = \\mathbb{P}(U \\le t_{\\mathrm{S}}) + \\mathbb{P}(U \\ge 1-t_{\\mathrm{S}})$\n\n由于 $U \\sim \\mathrm{Uniform}(0,1)$：\n$\\mathbb{P}(U \\le t_{\\mathrm{S}}) = t_{\\mathrm{S}}$\n$\\mathbb{P}(U \\ge 1-t_{\\mathrm{S}}) = 1 - (1-t_{\\mathrm{S}}) = t_{\\mathrm{S}}$\n\n因此，实际的FWER是：\n$\\mathrm{FWER}_{\\text{actual}} = t_{\\mathrm{S}} + t_{\\mathrm{S}} = 2 t_{\\mathrm{S}} = 2(1 - \\sqrt{1-\\alpha})$\n\n**4. 对Šidák程序失效和Bonferroni程序稳健性的解释**\n\nŠidák校正的推导关键依赖于等式 $\\mathbb{P}(\\text{无拒绝}) = \\prod_{i=1}^m \\mathbb{P}(p_i > t_S)$，而该等式仅在事件 $\\{p_i > t_S\\}$ 相互独立时才成立。\n\n在给定场景中，事件是 $\\{p_1 > t_S\\}$ 和 $\\{p_2 > t_S\\}$，即 $\\{U > t_S\\}$ 和 $\\{1-U > t_S\\} \\equiv \\{U < 1-t_S\\}$。这些事件是负相关的。实际的“无拒绝”概率是 $\\mathbb{P}(p_1 > t_S \\text{ and } p_2 > t_S) = \\mathbb{P}(t_S < U < 1-t_S)$。对于 $U \\sim \\mathrm{Uniform}(0,1)$，假设 $t_S < 1/2$，这个概率是区间的长度，即 $(1-t_S) - t_S = 1 - 2t_S$。\n\n在独立性假设下假定的“无拒绝”概率是 $(\\mathbb{P}(p_1 > t_S))^2 = (1-t_S)^2 = 1 - 2t_S + t_S^2$。\n比较实际的和假定的“无拒绝”概率：\n对于任何 $t_S > 0$，$1 - 2t_S < 1 - 2t_S + t_S^2$。\n\n这意味着 $\\mathbb{P}(\\text{无拒绝})_{\\text{实际}} < \\mathbb{P}(\\text{无拒绝})_{\\text{独立}}$。与独立情况相比，负相关性使得两个检验同时不显著的可能性*更小*。因此，实际的FWER，即 $1 - \\mathbb{P}(\\text{无拒绝})_{\\text{实际}}$，*大于*独立性下的FWER，即 $1 - \\mathbb{P}(\\text{无拒绝})_{\\text{独立}} = \\alpha$。这使得Šidák程序变得反保守（即真实的FWER超过了名义水平 $\\alpha$）。\n\n相比之下，Bonferroni程序的保证 $\\mathrm{FWER} \\le \\alpha$ 是基于Bonferroni不等式（并集界）$\\mathbb{P}(\\cup A_i) \\le \\sum \\mathbb{P}(A_i)$。这个不等式普遍成立，对事件 $A_i$ 之间的相关性没有任何假设。因此，Bonferroni校正对于任何相关性结构，包括负相关性，都保持有效（即将FWER控制在水平 $\\alpha$）。\n\n**数值计算**\n\n最后，我们计算在这个负相关场景下，当 $\\alpha = 0.05$ 时，使用Šidák阈值所达到的实际FWER的数值。\n使用第3部分推导的公式：\n$\\mathrm{FWER}_{\\text{actual}} = 2(1 - \\sqrt{1-\\alpha})$\n代入 $\\alpha = 0.05$：\n$\\mathrm{FWER}_{\\text{actual}} = 2(1 - \\sqrt{1 - 0.05}) = 2(1 - \\sqrt{0.95})$\n$\\sqrt{0.95} \\approx 0.97467943$\n$\\mathrm{FWER}_{\\text{actual}} \\approx 2(1 - 0.97467943) = 2(0.02532057) \\approx 0.05064114$\n四舍五入到四位有效数字，结果是 $0.05064$。",
            "answer": "$$\n\\boxed{0.05064}\n$$"
        }
    ]
}