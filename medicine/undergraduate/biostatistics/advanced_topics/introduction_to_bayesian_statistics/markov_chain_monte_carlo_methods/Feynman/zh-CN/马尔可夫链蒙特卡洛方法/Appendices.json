{
    "hands_on_practices": [
        {
            "introduction": "Metropolis-Hastings 算法是 MCMC 方法的一块基石。其核心逻辑在于接受或拒绝一个新提议状态的决策机制。这个动手练习将该算法简化至其最基本的一步，让你能够为一个给定的移动直接计算其接受概率。掌握这个计算过程  是理解 MCMC 链如何探索目标概率分布的第一步。",
            "id": "1371728",
            "problem": "一位数据科学家正在实施一个马尔可夫链蒙特卡洛 (MCMC) 模拟，以从参数 $x$ 的后验概率分布中抽取样本。目标分布 $\\pi(x)$ 与参数负绝对值的指数成正比，即 $\\pi(x) \\propto \\exp(-|x|)$。\n\n该科学家使用 Metropolis 算法和一个对称提议分布 $q(x'|x)$，其中在给定当前状态 $x$ 的情况下提议一个新状态 $x'$ 的概率等于在给定 $x'$ 的情况下提议 $x$ 的概率（即，$q(x'|x) = q(x|x')$）。\n\n假设在模拟的某一步，链的当前状态是 $x = 1.5$。然后，算法提议移动到一个新的候选状态 $x' = 2.0$。\n\n计算这次特定移动的接受概率。你的答案应该是一个无量纲实数。将你的最终答案四舍五入到四位有效数字。",
            "solution": "对于从 $x$ 到 $x'$ 的移动，使用对称提议分布 $q(x'|x)=q(x|x')$ 时，Metropolis 接受概率为\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\frac{\\pi(x')q(x|x')}{\\pi(x)q(x'|x)}\\right)=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x)}\\right).\n$$\n给定目标分布 $\\pi(x)\\propto \\exp(-|x|)$，该比率可简化为\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\frac{\\exp(-|x'|)}{\\exp(-|x|)}=\\exp\\!\\left(-\\left(|x'|-|x|\\right)\\right).\n$$\n当 $x=1.5$ 和 $x'=2.0$ 时，我们有 $|x|=1.5$ 和 $|x'|=2.0$，所以\n$$\n\\frac{\\pi(x')}{\\pi(x)}=\\exp\\!\\left(-\\left(2.0-1.5\\right)\\right)=\\exp(-0.5).\n$$\n因此，\n$$\n\\alpha(x \\to x')=\\min\\left(1,\\exp(-0.5)\\right)=\\exp(-0.5).\n$$\n数值上，$\\exp(-0.5)\\approx 0.6065$（四舍五入到四位有效数字）。",
            "answer": "$$\\boxed{0.6065}$$"
        },
        {
            "introduction": "Metropolis-Hastings 算法是先提议后决策，而吉布斯采样 (Gibbs sampler) 则另辟蹊径，通过从每个变量的条件分布中迭代抽样来工作。因此，构建吉布斯采样的前提是能够推导出这些“全条件分布”。这个练习  要求你为一个简单的二元分布完成这项任务，从而突显了联合概率、边缘概率和条件概率之间的根本联系。",
            "id": "1932854",
            "problem": "吉布斯采样器 (Gibbs sampler) 是一种马尔可夫链蒙特卡洛 (MCMC) 算法，用于生成近似目标多元概率分布的观测序列，当直接采样困难时，该算法尤其有用。实现吉布斯采样器的一个关键步骤是推导模型中每个变量的全条件分布。\n\n考虑一个二元随机向量 $(X, Y)$，其联合概率密度函数 (PDF) $p(x, y)$ 在 $xy$ 平面上的一个三角形区域 $\\mathcal{R}$ 内是均匀的。区域 $\\mathcal{R}$ 由不等式 $x0$, $y0$ 和 $x+y  1$ 定义。因此，联合 PDF 为：\n$$\np(x, y) =\n\\begin{cases}\n2  \\text{ if } (x,y) \\in \\mathcal{R} \\\\\n0  \\text{ otherwise}\n\\end{cases}\n$$\n为了构建该分布的吉布斯采样器，我们需要全条件分布 $p(x|y)$ 和 $p(y|x)$。\n\n下列哪个选项正确地指出了这两个条件分布？注意 $\\text{Uniform}(a,b)$ 表示在区间 $(a,b)$ 上的均匀分布。\n\nA: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1-y)$ 分布，对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1-x)$ 分布。\n\nB: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, 1)$ 分布，对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, 1)$ 分布。\n\nC: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(0, y)$ 分布，对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(0, x)$ 分布。\n\nD: 条件分布不是均匀分布。\n\nE: 对于 $y \\in (0,1)$，$p(x|y)$ 是 Uniform$(y, 1)$ 分布，对于 $x \\in (0,1)$，$p(y|x)$ 是 Uniform$(x, 1)$ 分布。",
            "solution": "我们给定一个联合密度 $p(x,y)$，它在区域 $\\mathcal{R}=\\{(x,y): x0,\\ y0,\\ x+y  1\\}$ 上是均匀的，在 $\\mathcal{R}$ 上 $p(x,y)=2$，其他地方为 $0$。为了获得全条件分布，我们通过边缘分布来使用条件分布的定义。\n\n首先，计算 $Y$ 的边缘密度。对于一个固定的 $y$，在 $0y1$ 的范围内，我们对所有可能的 $x$ 值积分来计算 $p(y)$。由于联合分布的支撑域是 $x0$ 和 $x+y1$ (即 $x1-y$)，积分限是 $0$ 和 $1-y$。因此，对于 $y \\in (0,1)$，\n$$\np(y) = \\int_0^{1-y} p(x,y) \\,dx = \\int_0^{1-y} 2 \\,dx = 2(1-y)\n$$\n现在，我们可以推导条件分布 $p(x|y)$，对于 $y \\in (0,1)$ 和 $x \\in (0,1-y)$：\n$$\np(x|y) = \\frac{p(x,y)}{p(y)} = \\frac{2}{2(1-y)} = \\frac{1}{1-y}\n$$\n这正是区间 $(0, 1-y)$ 上均匀分布的概率密度函数。因此，$p(x|y)$ 是 Uniform$(0, 1-y)$ 分布。\n由于联合分布在 $x$ 和 $y$ 上是对称的，通过交换变量，我们可以立即得出 $p(y|x)$ 是 Uniform$(0, 1-x)$ 分布。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "一个 MCMC 算法即使在理论上是正确的，但如果它探索状态空间的速度太慢，也可能在实践中毫无用处。随机游走 Metropolis 算法的性能在很大程度上取决于其提议分布的调整。这个概念性练习  深入探讨了在接受率和探索速度之间的关键权衡，迫使你思考选择过小或过大的提议步长所带来的实际后果。",
            "id": "1932810",
            "problem": "一位分析师正在使用马尔可夫链蒙特卡洛（MCMC）方法，特别是随机游走 Metropolis 算法，从定义在实数线上的一个连续、单峰的目标概率密度函数 $\\pi(x)$ 中生成样本。该算法流程如下：给定链的当前状态为 $x^{(t)}$，从一个对称的提议分布 $q(x'|x^{(t)})$ 中提出了一个新的候选状态 $x'$。在此具体实现中，提议是通过添加随机扰动来生成的：$x' = x^{(t)} + \\epsilon$，其中 $\\epsilon$ 是从均值为 0、标准差为 $\\sigma$ 的正态分布中抽取的，即 $\\epsilon \\sim N(0, \\sigma^2)$。然后，提议的状态 $x'$ 以概率 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$ 被接受为下一个状态 $x^{(t+1)} = x'$。如果提议被拒绝，链将保持在当前状态，即 $x^{(t+1)} = x^{(t)}$。\n\n该分析师正在试验提议分布标准差的两种不同设置：\n1.  一个非常窄的提议分布，其中 $\\sigma = \\sigma_{small}$ 是一个非常小的正数。\n2.  一个非常宽的提议分布，其中 $\\sigma = \\sigma_{large}$ 是一个非常大的正数。\n\n假设链已在一个概率不容忽视的区域（例如，在 $\\pi(x)$ 的众数附近）被初始化。以下哪个陈述最准确地描述了 MCMC 链在这两种情况下的预期行为？\n\nA. 窄提议（$\\sigma_{small}$）将导致低接受率和慢速探索。宽提议（$\\sigma_{large}$）将导致高接受率和快速探索。\nB. 两种提议宽度都将导致相似的接受率，但使用宽提议（$\\sigma_{large}$）的链将比使用窄提议（$\\sigma_{small}$）的链更快地探索状态空间。\nC. 窄提议（$\\sigma_{small}$）将导致非常高的接受率，但链将非常缓慢地探索状态空间。宽提议（$\\sigma_{large}$）将导致非常低的接受率，导致链在多次迭代中停留在同一状态。\nD. 窄提议（$\\sigma_{small}$）将导致高接受率和快速探索。宽提议（$\\sigma_{large}$）将导致低接受率和慢速探索。\nE. 提议分布的宽度对算法性能的影响可以忽略不计；接受率和探索速度主要由目标分布 $\\pi(x)$ 的性质决定。",
            "solution": "问题要求我们分析随机游走 Metropolis 算法的行为，重点关注提议分布 $N(0, \\sigma^2)$ 的宽度（标准差 $\\sigma$）如何影响链的接受率及其探索目标分布 $\\pi(x)$ 状态空间的能力。\n\n从 $x^{(t)}$ 到 $x'$ 的提议移动的接受概率由 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$ 给出。让我们分别分析这两种情况。\n\n**情况1：窄提议分布（$\\sigma = \\sigma_{small}$）**\n\n当标准差 $\\sigma_{small}$ 非常小时，从 $N(0, \\sigma_{small}^2)$ 中抽取的随机扰动 $\\epsilon$ 的量级也将非常小。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 将非常接近当前状态 $x^{(t)}$。\n\n由于目标分布 $\\pi(x)$ 是连续的，如果 $x'$ 非常接近 $x^{(t)}$，那么这两点的概率密度值 $\\pi(x')$ 和 $\\pi(x^{(t)})$ 将会非常相似。\n因此，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近 1。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率接近 1，接受概率 $\\alpha$ 将会非常高（接近 1）。这意味着几乎每个提议的移动都会被接受。\n\n然而，由于每次接受的移动都只是离前一个位置一个微小的步长，链在状态空间中移动得非常缓慢。这是一种探索目标分布 $\\pi(x)$ 整个范围（尤其是尾部）的低效方式。链表现出高自相关性，意味着连续的样本高度相关，需要非常大量的迭代才能获得一组具有代表性的独立样本。这构成了非常慢的探索。\n\n**情况2：宽提议分布（$\\sigma = \\sigma_{large}$）**\n\n当标准差 $\\sigma_{large}$ 非常大时，随机扰动 $\\epsilon$ 的量级通常会很大。这意味着提议的状态 $x' = x^{(t)} + \\epsilon$ 很可能离当前状态 $x^{(t)}$ 非常远。\n\n我们已知目标分布 $\\pi(x)$ 是单峰的，且链从一个高概率区域（众数附近）开始。当链处于这样一个区域时，$\\pi(x^{(t)})$ 的值相对较大。从 $x^{(t)}$ 进行一个大的跳跃很可能落入分布遥远的尾部区域，那里的概率密度极低。因此，$\\pi(x') \\ll \\pi(x^{(t)})$ 的可能性非常高。\n\n在这种情况下，比率 $\\frac{\\pi(x')}{\\pi(x^{(t)})}$ 将非常接近 0。\n\n接受概率为 $\\alpha(x', x^{(t)}) = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x^{(t)})}\\right)$。由于该比率非常小，接受概率 $\\alpha$ 也将非常小。这意味着绝大多数提议的移动都将被拒绝。\n\n当一个提议被拒绝时，链不会移动：$x^{(t+1)} = x^{(t)}$。因此，对于宽提议分布，链将在连续多次迭代中停留在同一状态，等待一个罕见的、恰好落在另一个高概率区域的提议。这也是一种非常低效的状态空间探索方式。\n\n**结论与选项评估：**\n\n-   窄提议带来**高接受率**但**慢速探索**。\n-   宽提议带来**低接受率**和**慢速探索**（因为链会卡住）。\n\n让我们基于此分析评估给定的选项：\n\n-   **A：** 不正确。它声称宽提议导致高接受率。\n-   **B：** 不正确。它声称两者的接受率相似。\n-   **C：** 这个陈述正确地捕捉了两种行为。窄提议导致高接受率但探索缓慢。宽提议导致非常低的接受率，使链卡住。这是最准确的描述。\n-   **D：** 不正确。它声称窄提议导致快速探索。\n-   **E：** 不正确。提议分布的宽度是一个关键的调整参数，它深刻影响算法的性能。\n\n因此，最准确的陈述是 C。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}