{
    "hands_on_practices": [
        {
            "introduction": "在分层数据中，同一组内的观测值（例如，同一家诊所的患者）往往比其他组的观测值更相似。组内相关系数（Intraclass Correlation Coefficient, ICC）为我们提供了一个单一的数值来量化这种相似性。将指导您如何通过随机截距模型的方差分量计算ICC，从而为组结构对结果的影响程度提供一个具体的衡量标准。",
            "id": "4915039",
            "problem": "一项公共卫生研究调查了个体在诊所内的收缩压，其中诊所被视为聚类。设 $Y_{ij}$ 表示诊所 $j$ 中个体 $i$ 的连续结果。考虑随机截距线性混合模型 $Y_{ij}=\\mu+b_{j}+\\varepsilon_{ij}$，其中 $b_{j}$ 独立同分布，均值为 $0$，方差为 $\\sigma_{b}^{2}$；$\\varepsilon_{ij}$ 独立同分布，均值为 $0$，方差为 $\\sigma_{w}^{2}$；且 $b_{j}$ 与 $\\varepsilon_{ij}$ 相互独立。使用限制性最大似然估计，诊所间方差的估计值为 $\\hat{\\sigma}_{b}^{2}=0.8$，诊所内方差的估计值为 $\\hat{\\sigma}_{w}^{2}=1.2$（两者均以结果的原始平方单位表示）。根据组内相关系数（ICC）的核心定义（即在该模型下，从同一诊所随机选择的两个个体之间的相关性），计算估计的ICC值，并从聚类内聚性的角度简要解释其大小。将ICC的最终数值答案表示为无单位小数，并四舍五入到 $4$ 位有效数字。",
            "solution": "该问题要求根据随机截距线性混合模型的方差分量估计值来计算组内相关系数（ICC）。\n\n**模型定义**\n所给定的随机截距线性混合模型为：\n$$ Y_{ij} = \\mu + b_j + \\varepsilon_{ij} $$\n其中：\n- $Y_{ij}$ 是诊所 $j$ 中个体 $i$ 的结果。\n- $\\mu$ 是总体均值。\n- $b_j$ 是诊所 $j$ 的随机效应，服从均值为 $0$，方差为 $\\sigma_{b}^{2}$ (诊所间方差) 的分布。\n- $\\varepsilon_{ij}$ 是个体 $i$ 的随机误差，服从均值为 $0$，方差为 $\\sigma_{w}^{2}$ (诊所内方差) 的分布。\n- $b_j$ 和 $\\varepsilon_{ij}$ 相互独立。\n\n**ICC 定义与推导**\n组内相关系数 (ICC)，记为 $\\rho$，定义为从同一聚类（诊所 $j$）中随机抽取的两个不同个体（$i$ 和 $k$）其结果之间的相关性：\n$$ \\rho = \\text{Corr}(Y_{ij}, Y_{kj}) = \\frac{\\text{Cov}(Y_{ij}, Y_{kj})}{\\sqrt{\\text{Var}(Y_{ij})\\text{Var}(Y_{kj})}} $$\n首先，我们计算总方差 $\\text{Var}(Y_{ij})$。由于 $b_j$ 和 $\\varepsilon_{ij}$ 相互独立：\n$$ \\text{Var}(Y_{ij}) = \\text{Var}(\\mu + b_j + \\varepsilon_{ij}) = \\text{Var}(b_j) + \\text{Var}(\\varepsilon_{ij}) = \\sigma_{b}^{2} + \\sigma_{w}^{2} $$\n接着，我们计算同一诊所内两个不同个体结果的协方差 $\\text{Cov}(Y_{ij}, Y_{kj})$：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\text{Cov}(\\mu + b_j + \\varepsilon_{ij}, \\mu + b_k + \\varepsilon_{kj}) $$\n由于 $i \\neq k$ 但同属诊所 $j$，上述表达式应为：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\text{Cov}(\\mu + b_j + \\varepsilon_{ij}, \\mu + b_j + \\varepsilon_{kj}) $$\n利用协方差的性质，并考虑到 $b_j$ 是共享项，而不同个体的误差 $\\varepsilon_{ij}$ 和 $\\varepsilon_{kj}$ 是独立的：\n$$ \\text{Cov}(Y_{ij}, Y_{kj}) = \\text{Cov}(b_j, b_j) = \\text{Var}(b_j) = \\sigma_{b}^{2} $$\n将方差和协方差的表达式代回 ICC 的定义公式，我们得到：\n$$ \\rho = \\frac{\\sigma_{b}^{2}}{\\sigma_{b}^{2} + \\sigma_{w}^{2}} $$\n这个公式直观地表示了总变异中由聚类间差异所占的比例。\n\n**计算**\n问题给出了方差分量的估计值：$\\hat{\\sigma}_{b}^{2} = 0.8$ 和 $\\hat{\\sigma}_{w}^{2} = 1.2$。我们将这些值代入 ICC 公式中进行计算：\n$$ \\hat{\\rho} = \\frac{\\hat{\\sigma}_{b}^{2}}{\\hat{\\sigma}_{b}^{2} + \\hat{\\sigma}_{w}^{2}} = \\frac{0.8}{0.8 + 1.2} = \\frac{0.8}{2.0} = 0.4 $$\n按要求四舍五入到4位有效数字，结果为 $0.4000$。\n\n**解释**\nICC 值为 $0.4$ 表示结果变量（收缩压）总变异中的 $40\\%$ 可以归因于诊所间的系统性差异。这表明来自同一诊所的患者其血压值存在中等程度的相关性或相似性。这种非零的 ICC 证实了将观测值视为独立是不恰当的，从而支持了使用混合效应模型来解释这种聚类结构的合理性。",
            "answer": "$$\\boxed{0.4000}$$"
        },
        {
            "introduction": "在聚类数据中分析预测变量时，简单地将变量纳入模型可能会产生误导，因为一个变量在个体层面和群体层面的效应可能是不同的（例如，个人收入与社区平均收入）。介绍了一种强有力的技术，通过将预测变量分解为组内和组间分量来厘清这些效应。通过拟合一个包含这两个分量的模型，您将学会如何识别和量化这些独特的个体层面和背景层面的关联，这是避免生态谬误的一项关键技能。",
            "id": "4915003",
            "problem": "一项多中心观察性研究旨在调查各诊所中循环炎症生物标志物（以 $X$ 表示）与收缩压（以 $Y$ 表示）之间的关联。患者嵌套在诊所内，形成聚类数据结构。研究目标是将生物标志物的关联分解为诊所内部分量和诊所间部分量，然后评估这两个分量是否与结果有不同的关联。\n\n现提供来自 $3$ 个诊所的患者层面测量数据，每个诊所有 $2$ 名患者：\n- 诊所 $1$：生物标志物值 $X$：$2$、$4$；血压值 $Y$：$95$、$106$。\n- 诊所 $2$：生物标志物值 $X$：$5$、$7$；血压值 $Y$：$123$、$137$。\n- 诊所 $3$：生物标志物值 $X$：$3$、$9$；血压值 $Y$：$114$、$145$。\n\n设患者由 $i$ 索引，诊所由 $j$ 索引。计算每个诊所的特定生物标志物均值 $\\bar{X}_{j}$ 和所有患者的总体生物标志物均值 $\\bar{X}$。将诊所内生物标志物分量定义为 $W_{ij} = X_{ij} - \\bar{X}_{j}$，将诊所间生物标志物分量定义为 $B_{ij} = \\bar{X}_{j} - \\bar{X}$（即由总体均值中心化的诊所均值）。考虑使用普通最小二乘法 (OLS) 拟合的线性模型\n$$Y_{ij} = \\alpha + \\beta_{W} W_{ij} + \\beta_{B} B_{ij} + \\varepsilon_{ij},$$\n使用上述数据以及 $W_{ij}$ 和 $B_{ij}$ 的定义，估计诊所内效应 $\\beta_{W}$ 和诊所间效应 $\\beta_{B}$，然后基于 OLS 拟合结果，通过学生 $t$ 统计量检验这两个效应是否相等，即原假设 $H_{0}: \\beta_{W} = \\beta_{B}$。\n\n报告 $t$ 统计量的值，作为一个无单位的量。将您的最终答案四舍五入到四位有效数字。",
            "solution": "为了解决这个问题，我们需遵循以下步骤：首先，根据给定的数据计算预测变量 $X$ 的诊所内分量 $W_{ij}$ 和诊所间分量 $B_{ij}$。其次，建立一个包含这两个分量的普通最小二乘（OLS）线性回归模型，并估计其系数。最后，构造并计算一个 $t$ 统计量来检验诊所内效应 $\\beta_W$ 和诊所间效应 $\\beta_B$ 是否相等。\n\n**步骤 1：计算均值和转换后的预测变量**\n\n首先，我们计算每个诊所的生物标志物均值 $\\bar{X}_j$ 和总体均值 $\\bar{X}$。\n- 诊所 1 均值: $\\bar{X}_1 = (2+4)/2 = 3$\n- 诊所 2 均值: $\\bar{X}_2 = (5+7)/2 = 6$\n- 诊所 3 均值: $\\bar{X}_3 = (3+9)/2 = 6$\n- 总体均值: $\\bar{X} = (2+4+5+7+3+9)/6 = 30/6 = 5$\n\n接下来，我们为每个患者计算诊所内分量 $W_{ij} = X_{ij} - \\bar{X}_j$ 和诊所间分量 $B_{ij} = \\bar{X}_j - \\bar{X}$。\n| 诊所 (j) | 患者 (i) | $X_{ij}$ | $Y_{ij}$ | $\\bar{X}_j$ | $W_{ij}$ | $B_{ij}$ |\n|---|---|---|---|---|---|---|\n| 1 | 1 | 2 | 95 | 3 | -1 | -2 |\n| 1 | 2 | 4 | 106 | 3 | 1 | -2 |\n| 2 | 1 | 5 | 123 | 6 | -1 | 1 |\n| 2 | 2 | 7 | 137 | 6 | 1 | 1 |\n| 3 | 1 | 3 | 114 | 6 | -3 | 1 |\n| 3 | 2 | 9 | 145 | 6 | 3 | 1 |\n\n**步骤 2：建立并求解 OLS 回归**\n\n模型为 $Y_{ij} = \\alpha + \\beta_W W_{ij} + \\beta_B B_{ij} + \\varepsilon_{ij}$。由于经过中心化处理，$W$ 和 $B$ 两个预测变量是正交的，这简化了计算。OLS 估计量可以分别计算：\n$\\hat{\\alpha} = \\bar{Y} = (95+...+145)/6 = 720/6 = 120$\n$\\hat{\\beta}_W = \\frac{\\sum W_{ij} Y_{ij}}{\\sum W_{ij}^2}$\n$\\hat{\\beta}_B = \\frac{\\sum B_{ij} Y_{ij}}{\\sum B_{ij}^2}$\n\n我们计算所需的和：\n$\\sum W_{ij} Y_{ij} = (-1)(95) + (1)(106) + (-1)(123) + (1)(137) + (-3)(114) + (3)(145) = 118$\n$\\sum W_{ij}^2 = (-1)^2 + 1^2 + (-1)^2 + 1^2 + (-3)^2 + 3^2 = 22$\n$\\sum B_{ij} Y_{ij} = (-2)(95) + (-2)(106) + (1)(123) + (1)(137) + (1)(114) + (1)(145) = 117$\n$\\sum B_{ij}^2 = (-2)^2(2) + 1^2(4) = 8 + 4 = 12$\n\n因此，系数估计值为：\n$\\hat{\\beta}_W = 118/22 = 59/11$\n$\\hat{\\beta}_B = 117/12 = 39/4$\n\n**步骤 3：检验系数相等的假设**\n\n我们要检验的原假设是 $H_0: \\beta_W = \\beta_B$，等价于 $H_0: \\beta_W - \\beta_B = 0$。$t$ 检验统计量为：\n$$ t = \\frac{\\hat{\\beta}_W - \\hat{\\beta}_B}{\\text{SE}(\\hat{\\beta}_W - \\hat{\\beta}_B)} $$\n系数之差为：\n$\\hat{\\beta}_W - \\hat{\\beta}_B = \\frac{59}{11} - \\frac{39}{4} = \\frac{236 - 429}{44} = -\\frac{193}{44}$\n\n由于预测变量正交，$\\text{Cov}(\\hat{\\beta}_W, \\hat{\\beta}_B) = 0$，因此差值的方差为：\n$\\text{Var}(\\hat{\\beta}_W - \\hat{\\beta}_B) = \\text{Var}(\\hat{\\beta}_W) + \\text{Var}(\\hat{\\beta}_B) = \\frac{\\sigma^2}{\\sum W_{ij}^2} + \\frac{\\sigma^2}{\\sum B_{ij}^2} = \\sigma^2(\\frac{1}{22} + \\frac{1}{12}) = \\sigma^2(\\frac{17}{132})$\n\n我们需要估计误差方差 $\\sigma^2$，其估计值为 $\\hat{\\sigma}^2 = \\frac{\\text{RSS}}{n-p}$，其中 $n=6$ 是观测总数，$p=3$ 是模型参数数量（$\\alpha, \\beta_W, \\beta_B$）。自由度为 $df = n-p = 3$。\n残差平方和 (RSS) = $\\sum (Y_{ij} - \\hat{Y}_{ij})^2 = \\sum Y_{ij}^2 - (\\hat{\\alpha}\\sum Y_{ij} + \\hat{\\beta}_W\\sum W_{ij}Y_{ij} + \\hat{\\beta}_B\\sum B_{ij}Y_{ij})$\n$\\sum Y_{ij}^2 = 95^2 + 106^2 + 123^2 + 137^2 + 114^2 + 145^2 = 88180$\n$\\hat{\\alpha}\\sum Y_{ij} + \\dots = 120(720) + (59/11)(118) + (39/4)(117) = 86400 + 6962/11 + 4563/4 = 86400 + \\frac{27848+50193}{44} = 86400 + \\frac{78041}{44}$\n$\\text{RSS} = 88180 - (86400 + \\frac{78041}{44}) = 1780 - \\frac{78041}{44} = \\frac{78320 - 78041}{44} = \\frac{279}{44}$\n$\\hat{\\sigma}^2 = \\frac{\\text{RSS}}{df} = \\frac{279/44}{3} = \\frac{93}{44}$\n\n现在，我们计算差值的估计方差和标准误：\n$\\widehat{\\text{Var}}(\\hat{\\beta}_W - \\hat{\\beta}_B) = \\hat{\\sigma}^2(\\frac{17}{132}) = \\frac{93}{44} \\times \\frac{17}{132} = \\frac{1581}{5808} = \\frac{527}{1936}$\n$\\widehat{\\text{SE}}(\\hat{\\beta}_W - \\hat{\\beta}_B) = \\sqrt{\\frac{527}{1936}} = \\frac{\\sqrt{527}}{44}$\n\n最后，计算 $t$ 统计量：\n$$ t = \\frac{-193/44}{\\sqrt{527}/44} = -\\frac{193}{\\sqrt{527}} \\approx -\\frac{193}{22.95648} \\approx -8.40722 $$\n四舍五入到四位有效数字，结果为 $-8.407$。",
            "answer": "$$\n\\boxed{-8.407}\n$$"
        },
        {
            "introduction": "在非线性分层模型（如用于二元结果的逻辑回归）中，对回归系数的解释变得更加微妙，明确区分特定于组的效应和总体平均效应变得至关重要。这个高级练习深入探讨了比值比（odds ratio）的不可合并性（non-collapsibility）这一概念。您将从一个条件（特定于组）逻辑混合模型中推导出近似的总体平均（边际）比值比，并理解为什么它相对于条件比值比会发生衰减，这对于正确解释广义线性混合模型（GLMM）的结果至关重要。",
            "id": "4915054",
            "problem": "一项生物统计学研究记录了医院 $j$ 中患者 $i$ 的二元结局 $Y_{ij} \\in \\{0,1\\}$，以及一个二元暴露 $X_{ij} \\in \\{0,1\\}$。假设数据可信地由一个具有 logit 连接和随机截距的分层广义线性混合模型（GLMM）生成，其中在给定医院特定随机效应 $u_{j}$ 的情况下，$Y_{ij}$ 的条件模型为\n$$\n\\operatorname{logit}\\left\\{ \\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_{j}\\right) \\right\\} = \\alpha + \\beta X_{ij} + u_{j},\n$$\n其中 $u_{j} \\sim \\mathcal{N}(0, \\sigma^{2})$ 且独立于 $X_{ij}$。一个拟合后的模型得到的估计值为 $\\hat{\\beta} = 1.10$ 和 $\\hat{\\sigma}^{2} = 0.60$。暴露的条件（集群特定）比值比为 $\\exp(\\beta)$。\n\n从比值比、logit 连接和正态混合分布性质的核心定义出发，通过对随机截距分布进行解析边缘化，并引用一个由分布性质证明其合理性的有原则的近似方法，来推导暴露的近似群体平均（边际）比值比。然后，使用提供的估计值 $\\hat{\\beta}$ 和 $\\hat{\\sigma}^{2}$ 计算其数值，并简要解释在这种随机截距 logistic 设定中，为何边际比值比相对于条件比值比有所衰减。\n\n将最终的数值比值比四舍五入到四位有效数字。答案中无需单位。",
            "solution": "该问题要求从给定的条件（集群特定）广义线性混合模型（GLMM）推导出近似的群体平均（边际）比值比，并计算其数值。\n\n**1. 定义条件与边际比值比**\n给定的条件模型为：\n$$ \\operatorname{logit}\\left\\{ \\Pr\\left(Y_{ij}=1 \\mid X_{ij}, u_{j}\\right) \\right\\} = \\alpha + \\beta X_{ij} + u_{j} $$\n其中随机效应 $u_j \\sim \\mathcal{N}(0, \\sigma^2)$。\n对于一个给定的集群 $j$（即 $u_j$ 固定），暴露 $(X_{ij}=1)$ 与未暴露 $(X_{ij}=0)$ 的对数比值比为 $(\\alpha + \\beta + u_j) - (\\alpha + u_j) = \\beta$。因此，**条件比值比**为 $\\text{OR}_{\\text{conditional}} = \\exp(\\beta)$，它不依赖于 $u_j$。\n\n**边际比值比**则是基于对随机效应 $u_j$ 进行积分（边缘化）后的边际概率 $\\Pr(Y_{ij}=1 \\mid X_{ij})$ 来定义的。对 logistic-正态模型的精确边缘化没有封闭解。因此，我们采用一个标准的近似方法。\n\n**2. 推导近似的边际模型**\n该近似方法基于潜变量的视角。条件模型可以被看作是一个潜变量 $Y_{ij}^* = \\alpha + \\beta X_{ij} + u_j + \\varepsilon_{ij}$，其中 $\\varepsilon_{ij}$ 服从标准 logistic 分布，其方差为 $\\pi^2/3$。当 $Y_{ij}^* > 0$ 时，$Y_{ij}=1$。\n\n边际模型通过整合随机效应 $u_j$ 得到，其潜变量模型为 $Y_{ij}^* = \\alpha + \\beta X_{ij} + v_{ij}$，其中复合误差项 $v_{ij} = u_j + \\varepsilon_{ij}$。由于 $u_j$ 和 $\\varepsilon_{ij}$ 独立，其方差为：\n$$ \\operatorname{Var}(v_{ij}) = \\operatorname{Var}(u_j) + \\operatorname{Var}(\\varepsilon_{ij}) = \\sigma^2 + \\frac{\\pi^2}{3} $$\n该近似方法是用一个具有不同尺度参数 $s$ 的 logistic 分布来逼近 $v_{ij}$ 的分布。一个尺度为 $s$ 的 logistic 分布的方差为 $s^2\\pi^2/3$。通过匹配方差，我们得到：\n$$ s^2 \\frac{\\pi^2}{3} = \\sigma^2 + \\frac{\\pi^2}{3} \\implies s^2 = 1 + \\frac{3\\sigma^2}{\\pi^2} \\implies s = \\sqrt{1 + \\frac{3\\sigma^2}{\\pi^2}} $$\n近似的边际模型为：\n$$ \\operatorname{logit}\\left\\{ \\Pr(Y_{ij}=1 \\mid X_{ij}) \\right\\} \\approx \\frac{\\alpha}{s} + \\frac{\\beta}{s} X_{ij} $$\n因此，近似的边际对数比值比为 $\\beta^* \\approx \\beta/s$，**边际比值比**为 $\\text{OR}_{\\text{marginal}} \\approx \\exp(\\beta/s)$。\n\n**3. 计算数值**\n使用给定的估计值 $\\hat{\\beta} = 1.10$ 和 $\\hat{\\sigma}^2 = 0.60$：\n首先，计算尺度因子 $s$：\n$$ s \\approx \\sqrt{1 + \\frac{3(0.60)}{\\pi^2}} = \\sqrt{1 + \\frac{1.8}{9.8696}} \\approx \\sqrt{1.182378} \\approx 1.087372 $$\n然后，计算近似的边际对数比值比 $\\hat{\\beta}^*$：\n$$ \\hat{\\beta}^* \\approx \\frac{1.10}{1.087372} \\approx 1.011614 $$\n最后，计算边际比值比：\n$$ \\text{OR}_{\\text{marginal}} \\approx \\exp(1.011614) \\approx 2.74996 $$\n四舍五入到四位有效数字，结果为 $2.750$。\n\n**4. 衰减效应的解释**\n边际比值比相对于条件比值比的衰减现象被称为比值比的**不可合并性 (non-collapsibility)**，这是 logit 连接函数非线性的直接后果。\n- **数学上**：只要集群间存在异质性（即 $\\sigma^2 > 0$），尺度因子 $s$ 就会大于 1。这导致边际对数比值比的绝对值 $|\\beta^*| = |\\beta|/s$ 小于条件对数比值比的绝对值 $|\\beta|$，从而使得边际比值比 $\\exp(\\beta^*)$ 比条件比值比 $\\exp(\\beta)$ 更接近 1。\n- **概念上**：条件比值比描述的是在某个特定风险水平（由 $u_j$ 决定）的集群内部，暴露与结局的关联强度。而边际比值比是在整个群体中平均后的关联强度。由于群体由不同基线风险的集群混合而成，对非线性的 S 形 logistic 曲线进行平均，会得到一条更平缓的平均曲线。更平缓的曲线意味着更弱的关联，即更小的比值比。因此，集群间的异质性“稀释”或“衰减”了在群体层面观察到的平均效应。",
            "answer": "$$\\boxed{2.750}$$"
        }
    ]
}