{
    "hands_on_practices": [
        {
            "introduction": "广义估计方程（GEE）的强大之处在于它能明确处理同一受试者重复测量数据间的相关性。此过程的第一步是选择并定义一个“工作”相关矩阵。本练习旨在让你从基本原理出发，推导出一阶自回归（AR(1)）相关矩阵的形式，这是一种常用于等时间间隔数据的结构。",
            "id": "4913842",
            "problem": "一项纵向队列研究在$4$个等间隔的临床访视中测量每位受试者的一个连续生物标志物，访视时间索引为 $t \\in \\{0,1,2,3\\}$。为了使用广义估计方程（GEE）拟合边际均值模型，需要一个工作相关矩阵来捕捉访视间的受试者内相关性。考虑使用与弱平稳性和等间隔时间上的马尔可夫性质兼容的一阶自回归（AR(1)）机制来对受试者内依赖性进行建模。假设一个中心化过程满足以下基本条件：对每位受试者，定义 $X_{t} = Y_{t} - \\mu$，并假设 $X_{t}$ 满足 $X_{t} = \\rho X_{t-1} + \\epsilon_{t}$，其中 $|\\rho|1$，$\\{\\epsilon_{t}\\}$ 是一个均值为 $0$、方差为 $\\sigma_{\\epsilon}^{2}$ 的白噪声过程，并且在时间上以及与 $X_{t}$ 的过去值不相关。\n\n仅使用这些假设和弱平稳性下自协方差函数的定义，论证为何AR(1)工作相关矩阵适用于等间隔的纵向测量，并推导单个受试者在$4$次访视下的隐含工作相关矩阵，该矩阵是未知参数 $\\rho$ 的函数。请以关于 $\\rho$ 的 $4 \\times 4$ 工作相关矩阵的单一封闭形式解析表达式提供最终答案。请勿对答案进行四舍五入。",
            "solution": "该问题陈述被评估为有效。其科学基础在于随机过程和生物统计学理论，特别是关于广义估计方程（GEE）和AR(1)模型。该问题是适定的，提供了所有必要的定义和约束，例如AR(1)过程的形式 $X_{t} = \\rho X_{t-1} + \\epsilon_{t}$、白噪声过程 $\\{\\epsilon_t\\}$ 的性质、平稳性条件 $|\\rho|1$ 以及时间点的数量。其目标清晰明确：论证AR(1)结构的合理性并推导相应的 $4 \\times 4$ 工作相关矩阵。该问题是客观、完整且没有任何逻辑矛盾或事实错误的。\n\n任务是论证一阶自回归（AR(1)）工作相关结构对等间隔纵向数据的适用性，并推导相应的 $4 \\times 4$ 工作相关矩阵 $R(\\rho)$。\n\n首先，我们来论证其合理性。AR(1)模型特别适用于在等间隔时间点收集的纵向数据，原因有以下几点：\n1.  它假设在给定时间 $t$ 的测量值是紧接着的前一个时间点 $t-1$ 的测量值的函数，外加随机噪声。这反映了马尔可夫性质，对于许多生物或物理过程而言，这是一个合理的简化假设，在这些过程中，最近的过去状态是当前状态最重要的预测因子。\n2.  该模型意味着两次测量之间的相关性随着它们之间的时间滞后增加而呈指数级衰减。对于同一受试者的重复测量，时间上更近的测量（例如，访视1和访视2）比时间上相距更远的测量（例如，访视1和访视4）具有更强的相关性，这是非常合理的。AR(1)结构在数学上形式化了这种直观的衰减。\n3.  GEE工作相关框架和约束条件 $|\\rho|1$ 所隐含的弱平稳性假设，意味着均值、方差和自相关结构不随时间变化。这为受试者内依赖性提供了一个稳定且简约的模型，该模型由单个参数 $\\rho$ 表征。\n\n接下来，我们推导工作相关矩阵。单个受试者的相关矩阵 $R$ 的元素为 $R_{ij} = \\text{Corr}(Y_i, Y_j)$，其中 $Y_i$ 和 $Y_j$ 是在时间索引 $i$ 和 $j$（来自集合 $\\{0, 1, 2, 3\\}$）时的结果。让矩阵索引从$1$到$4$，对应于时间 $t=0, 1, 2, 3$。因此，元素 $R_{ij}$ 对应于 $\\text{Corr}(Y_{i-1}, Y_{j-1})$。\n\n给定中心化过程 $X_t = Y_t - \\mu$，$Y_t$ 的协方差和方差性质与 $X_t$ 的相同。具体来说，$\\text{Var}(Y_t) = \\text{Var}(X_t)$ 且 $\\text{Cov}(Y_i, Y_j) = \\text{Cov}(X_i, X_j)$。相关性由下式给出：\n$$\n\\text{Corr}(Y_i, Y_j) = \\frac{\\text{Cov}(Y_i, Y_j)}{\\sqrt{\\text{Var}(Y_i)\\text{Var}(Y_j)}} = \\frac{\\text{Cov}(X_i, X_j)}{\\sqrt{\\text{Var}(X_i)\\text{Var}(X_j)}}\n$$\n在弱平稳性假设下，所有 $t$ 的方差是恒定的，即 $\\text{Var}(X_t) = \\gamma(0)$，并且协方差仅取决于时间滞后 $k = |i-j|$，即 $\\text{Cov}(X_i, X_j) = \\gamma(k)$。因此，自相关函数（ACF）为 $\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$。我们的目标是找到 $\\rho(k)$ 的形式。\n\n1.  方差 $\\gamma(0)$ 的推导：\n根据模型定义，$X_t = \\rho X_{t-1} + \\epsilon_t$。我们计算 $X_t$ 的方差：\n$$\n\\text{Var}(X_t) = \\text{Var}(\\rho X_{t-1} + \\epsilon_t)\n$$\n由于 $\\epsilon_t$ 与 $X_t$ 的过去值（包括 $X_{t-1}$）不相关，和的方差等于方差的和：\n$$\n\\text{Var}(X_t) = \\text{Var}(\\rho X_{t-1}) + \\text{Var}(\\epsilon_t) = \\rho^2 \\text{Var}(X_{t-1}) + \\sigma_{\\epsilon}^2\n$$\n根据弱平稳性，$\\text{Var}(X_t) = \\text{Var}(X_{t-1}) = \\gamma(0)$。将此代入方程得：\n$$\n\\gamma(0) = \\rho^2 \\gamma(0) + \\sigma_{\\epsilon}^2\n$$\n解出 $\\gamma(0)$：\n$$\n\\gamma(0)(1 - \\rho^2) = \\sigma_{\\epsilon}^2 \\implies \\gamma(0) = \\frac{\\sigma_{\\epsilon}^2}{1 - \\rho^2}\n$$\n此结果是有效的，因为问题陈述中 $|\\rho|1$，确保了 $1 - \\rho^2 > 0$。\n\n2.  自协方差函数 $\\gamma(k)$（对于 $k > 0$）的推导：\n滞后 $k$ 的自协方差为 $\\gamma(k) = \\text{Cov}(X_t, X_{t-k})$。由于过程是中心化的（$E[X_t] = 0$），这等于 $E[X_t X_{t-k}]$。\n$$\n\\gamma(k) = E[X_t X_{t-k}] = E[(\\rho X_{t-1} + \\epsilon_t) X_{t-k}]\n$$\n根据期望的线性性：\n$$\n\\gamma(k) = \\rho E[X_{t-1} X_{t-k}] + E[\\epsilon_t X_{t-k}]\n$$\n对于任何滞后 $k > 0$，时间点 $t-k$ 相对于时间 $t$ 是过去的。根据假设，噪声项 $\\epsilon_t$ 与过程 $X$ 的所有过去值不相关，所以 $E[\\epsilon_t X_{t-k}] = 0$。方程简化为：\n$$\n\\gamma(k) = \\rho E[X_{t-1} X_{t-k}] = \\rho \\text{Cov}(X_{t-1}, X_{t-k})\n$$\n根据平稳性，$\\text{Cov}(X_{t-1}, X_{t-k}) = \\gamma((t-1) - (t-k)) = \\gamma(k-1)$。这产生了AR(1)过程的Yule-Walker方程：\n$$\n\\gamma(k) = \\rho \\gamma(k-1)\n$$\n这是一个递推关系。从 $k=1$ 开始：\n$\\gamma(1) = \\rho \\gamma(0)$\n$\\gamma(2) = \\rho \\gamma(1) = \\rho (\\rho \\gamma(0)) = \\rho^2 \\gamma(0)$\n通过归纳法，对于任何整数滞后 $k \\ge 0$，自协方差为：\n$$\n\\gamma(k) = \\rho^k \\gamma(0)\n$$\n\n3.  自相关函数 $\\rho(k)$ 的推导：\nACF定义为 $\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)}$。代入 $\\gamma(k)$ 的表达式：\n$$\n\\rho(k) = \\frac{\\rho^k \\gamma(0)}{\\gamma(0)} = \\rho^k \\quad \\text{for } k \\ge 0\n$$\n由于 $\\rho(k) = \\rho(-k)$，对于任何整数滞后 $k$ 的一般形式是 $\\rho(k) = \\rho^{|k|}$。\n\n4.  构建 $4 \\times 4$ 工作相关矩阵 $R(\\rho)$：\n矩阵元素为 $R_{ij} = \\text{Corr}(Y_{i-1}, Y_{j-1}) = \\rho(|(i-1)-(j-1)|) = \\rho^{|i-j|}$，其中 $i,j \\in \\{1, 2, 3, 4\\}$。\n对角线元素对应滞后 $k=0$：$R_{ii} = \\rho^{|i-i|} = \\rho^0 = 1$。\n非对角线元素为：\n$R_{12} = R_{21} = \\rho^{|1-2|} = \\rho^1 = \\rho$\n$R_{13} = R_{31} = \\rho^{|1-3|} = \\rho^2$\n$R_{14} = R_{41} = \\rho^{|1-4|} = \\rho^3$\n$R_{23} = R_{32} = \\rho^{|2-3|} = \\rho^1 = \\rho$\n$R_{24} = R_{42} = \\rho^{|2-4|} = \\rho^2$\n$R_{34} = R_{43} = \\rho^{|3-4|} = \\rho^1 = \\rho$\n\n将这些元素组合成一个 $4 \\times 4$ 矩阵，得到AR(1)工作相关矩阵：\n$$\nR(\\rho) = \\begin{pmatrix}\n1  \\rho  \\rho^2  \\rho^3 \\\\\n\\rho  1  \\rho  \\rho^2 \\\\\n\\rho^2  \\rho  1  \\rho \\\\\n\\rho^3  \\rho^2  \\rho  1\n\\end{pmatrix}\n$$\n这是一个对称托普利茨矩阵（symmetric Toeplitz matrix），是平稳时间序列过程的特征。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  \\rho  \\rho^2  \\rho^3 \\\\\n\\rho  1  \\rho  \\rho^2 \\\\\n\\rho^2  \\rho  1  \\rho \\\\\n\\rho^3  \\rho^2  \\rho  1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在探究了特定的工作相关结构之后，我们现在来组装完整的广义估计方程。本练习将指导你为相关的二元数据推导完整的估计方程组，这是临床试验和队列研究中的常见情景。通过结合均值模型、方差函数和可交换相关结构，你将构建出统计软件求解模型系数时所依赖的核心方程。",
            "id": "4913837",
            "problem": "一项队列研究跟踪了 $n$ 个相关个体的聚类（例如，兄弟姐妹），其中第 $i$ 个聚类有 $m_i$ 个重复二元结果 $\\{Y_{ij}: j=1,\\dots,m_i\\}$ 和协变量向量 $\\{x_{ij} \\in \\mathbb{R}^p\\}$。假设采用具有 logit 连接函数的广义线性模型，因此边际均值为 $\\mu_{ij} = \\Pr(Y_{ij}=1 \\mid x_{ij}) = \\exp(\\eta_{ij})/(1+\\exp(\\eta_{ij}))$，其中线性预测子为 $\\eta_{ij} = x_{ij}^{\\top}\\beta$。令 $X_i$ 为 $m_i \\times p$ 的设计矩阵，其第 $j$ 行为 $x_{ij}^{\\top}$，$\\mu_i = (\\mu_{i1},\\dots,\\mu_{im_i})^{\\top}$，以及 $y_i = (y_{i1},\\dots,y_{im_i})^{\\top}$。在处理相关结果的广义估计方程方法下，使用以下基本事实：\n- 对于均值为 $\\mu_{ij}$ 的伯努利变量，其方差为 $\\mu_{ij}(1-\\mu_{ij})$。\n- 对于 logit 连接函数，逆连接函数的导数满足 $\\frac{d\\mu_{ij}}{d\\eta_{ij}} = \\mu_{ij}(1-\\mu_{ij})$。\n- 工作协方差的形式为 $V_i = A_i^{1/2} R_i(\\alpha) A_i^{1/2}$，其中 $A_i$ 是边际方差的对角矩阵，$R_i(\\alpha)$ 是工作相关性矩阵。对于可交换结构，$R_i(\\alpha)$ 的对角线元素为 $1$，非对角线元素为 $\\alpha$，其中 $-1/(m_i-1)  \\alpha  1$ 以确保正定性。\n\n任务：\n1. 用 $\\mu_{ij}$（$j=1,\\dots,m_i$）显式表示 $A_i$。\n2. 在可交换工作相关性假设下，推导关于 $\\beta$ 的广义估计方程组，将估计函数 $U(\\beta)$ 写成仅依赖于 $X_i$、$\\mu_i$、$y_i$、$\\alpha$、$m_i$、$m_i \\times m_i$ 单位矩阵 $I_{m_i}$ 和 $m_i \\times m_i$ 全一矩阵 $J_{m_i}$ 的闭合形式。你的最终表达式应展示用 $\\alpha$、$m_i$、$I_{m_i}$ 和 $J_{m_i}$ 表示的显式逆矩阵 $R_i(\\alpha)^{-1}$。\n\n你的最终答案应为两个表达式，按顺序为：首先是显式的 $A_i$，其次是显式的 $U(\\beta)$。不需要进行数值计算。最终答案中不要包含任何等号。不需要四舍五入，也不涉及单位。",
            "solution": "用户提供了来自生物统计学领域的一个适定的问题陈述，具体涉及广义估计方程（GEE）的构建。经过严格验证，确认该问题具有科学依据、内容自洽且客观。所有提供的信息、定义和条件在处理相关二元数据的 GEE 统计理论中都是标准的。\n\n该问题有效。我现在将进行一个完整且有理有据的解答。\n\n根据要求，解答分为两部分。首先，我们确定矩阵 $A_i$。其次，我们推导 GEE 估计函数 $U(\\beta)$。\n\n### 任务 1：显式表示 $A_i$\n\n问题陈述指出，$A_i$ 是第 $i$ 个聚类中结果 $Y_{ij}$ 的边际方差构成的对角矩阵。结果 $\\{Y_{ij}\\}$ 是二元的，服从伯努利分布。对于均值为 $\\mu = \\Pr(Y=1)$ 的伯努利随机变量 $Y$，其方差由 $\\text{Var}(Y) = \\mu(1-\\mu)$ 给出。\n\n在此问题中，$Y_{ij}$ 的均值给定为 $\\mu_{ij}$。因此，$Y_{ij}$ 的边际方差为 $\\text{Var}(Y_{ij}) = \\mu_{ij}(1-\\mu_{ij})$。\n\n矩阵 $A_i$ 是一个 $m_i \\times m_i$ 的对角矩阵，其第 $j$ 个对角元素为 $\\text{Var}(Y_{ij})$。因此，$A_i$ 的元素为 $(A_i)_{jk} = \\delta_{jk} \\mu_{ij}(1-\\mu_{ij})$，其中 $\\delta_{jk}$ 是克罗内克 δ。这可以使用 $\\text{diag}(\\cdot)$ 算子写为：\n$$\nA_i = \\text{diag}(\\mu_{i1}(1-\\mu_{i1}), \\mu_{i2}(1-\\mu_{i2}), \\dots, \\mu_{im_i}(1-\\mu_{im_i}))\n$$\n\n### 任务 2：推导广义估计方程组\n\n广义估计函数 $U(\\beta)$ 是 $n$ 个聚类中每个聚类的贡献之和：\n$$\nU(\\beta) = \\sum_{i=1}^{n} U_i(\\beta)\n$$\n第 $i$ 个聚类的贡献 $U_i(\\beta)$ 由通用公式给出：\n$$\nU_i(\\beta) = D_i^{\\top} V_i^{-1} S_i\n$$\n其中 $S_i = y_i - \\mu_i$ 是第 $i$ 个聚类的残差向量，$V_i$ 是工作协方差矩阵，而 $D_i = \\frac{\\partial \\mu_i}{\\partial \\beta^{\\top}}$ 是均值向量对回归系数 $\\beta$ 的导数构成的 $m_i \\times p$ 矩阵。我们依次推导每个分量。\n\n1.  **导数矩阵 $D_i$**：\n    $D_i$ 的第 $(j,k)$ 个元素是 $\\frac{\\partial \\mu_{ij}}{\\partial \\beta_k}$。使用链式法则：\n    $$\n    \\frac{\\partial \\mu_{ij}}{\\partial \\beta_k} = \\frac{d\\mu_{ij}}{d\\eta_{ij}} \\frac{\\partial \\eta_{ij}}{\\partial \\beta_k}\n    $$\n    问题提供了两个必要的事实：\n    -   对于 logit 连接函数，$\\frac{d\\mu_{ij}}{d\\eta_{ij}} = \\mu_{ij}(1-\\mu_{ij})$。这是 $A_i$ 的第 $j$ 个对角元素。\n    -   线性预测子是 $\\eta_{ij} = x_{ij}^{\\top}\\beta = \\sum_{l=1}^{p} x_{ijl}\\beta_l$。因此，$\\frac{\\partial \\eta_{ij}}{\\partial \\beta_k} = x_{ijk}$。这是协变量向量 $x_{ij}$ 的第 $k$ 个元素。\n    \n    结合这些，矩阵 $D_i$ 的第 $j$ 行由 $\\frac{\\partial \\mu_{ij}}{\\partial \\beta^{\\top}} = \\mu_{ij}(1-\\mu_{ij}) x_{ij}^{\\top}$ 给出。\n    通过堆叠 $m_i$ 行，我们可以将 $D_i$ 写成方差对角矩阵 $A_i$ 和设计矩阵 $X_i$ 的乘积的矩阵形式：\n    $$\n    D_i = A_i X_i\n    $$\n\n2.  **逆工作协方差矩阵 $V_i^{-1}$**：\n    工作协方差矩阵给出为 $V_i = A_i^{1/2} R_i(\\alpha) A_i^{1/2}$。为了求其逆矩阵，我们使用属性 $(BCD)^{-1} = D^{-1}C^{-1}B^{-1}$。\n    由于 $A_i$ 是对角矩阵，所以 $A_i^{1/2}$ 也是对角矩阵，其逆矩阵 $(A_i^{1/2})^{-1}$ 是一个对角元素为 $1/\\sqrt{\\mu_{ij}(1-\\mu_{ij})}$ 的对角矩阵。我们将其表示为 $A_i^{-1/2}$。\n    因此，$V_i$ 的逆矩阵为：\n    $$\n    V_i^{-1} = (A_i^{1/2} R_i(\\alpha) A_i^{1/2})^{-1} = (A_i^{1/2})^{-1} R_i(\\alpha)^{-1} (A_i^{1/2})^{-1} = A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2}\n    $$\n\n3.  **逆工作相关性矩阵 $R_i(\\alpha)^{-1}$**：\n    可交换工作相关性矩阵 $R_i(\\alpha)$ 的对角线元素为 $1$，非对角线元素为 $\\alpha$。这种结构可以表示为单位矩阵 $I_{m_i}$ 和全一矩阵 $J_{m_i}$ 的线性组合：\n    $$\n    R_i(\\alpha) = (1-\\alpha)I_{m_i} + \\alpha J_{m_i}\n    $$\n    这种形式的矩阵的逆是一个标准结果。它具有相同的形式，$c_1 I_{m_i} + c_2 J_{m_i}$。通过求解方程 $( (1-\\alpha)I_{m_i} + \\alpha J_{m_i} ) (c_1 I_{m_i} + c_2 J_{m_i}) = I_{m_i}$ 并使用属性 $J_{m_i}^2 = m_i J_{m_i}$，我们可以找到系数 $c_1$ 和 $c_2$。得到的逆矩阵是：\n    $$\n    R_i(\\alpha)^{-1} = \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i}\n    $$\n    条件 $-1/(m_i-1)  \\alpha  1$ 确保了分母不为零且矩阵是正定的。\n\n4.  **组装估计函数 $U(\\beta)$**：\n    我们现在将推导出的分量代入 $U_i(\\beta)$ 的表达式中：\n    $$\n    U_i(\\beta) = D_i^{\\top} V_i^{-1} S_i = (A_i X_i)^{\\top} (A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2}) (y_i - \\mu_i)\n    $$\n    使用转置属性 $(AB)^\\top = B^\\top A^\\top$：\n    $$\n    U_i(\\beta) = X_i^{\\top} A_i^{\\top} A_i^{-1/2} R_i(\\alpha)^{-1} A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    由于 $A_i$ 是对角矩阵，所以它是对称的 ($A_i^{\\top} = A_i$)。此外，根据定义，$A_i = A_i^{1/2} A_i^{1/2}$。乘积 $A_i^{\\top} A_i^{-1/2}$ 可以简化：\n    $$\n    A_i^{\\top} A_i^{-1/2} = A_i A_i^{-1/2} = (A_i^{1/2} A_i^{1/2}) A_i^{-1/2} = A_i^{1/2} (A_i^{1/2} A_i^{-1/2}) = A_i^{1/2} I_{m_i} = A_i^{1/2}\n    $$\n    将此代回到 $U_i(\\beta)$ 的表达式中：\n    $$\n    U_i(\\beta) = X_i^{\\top} A_i^{1/2} R_i(\\alpha)^{-1} A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    最后，我们对所有聚类 $i=1, \\dots, n$ 求和，并代入 $R_i(\\alpha)^{-1}$ 的显式表达式：\n    $$\n    U(\\beta) = \\sum_{i=1}^{n} X_i^{\\top} A_i^{1/2} \\left( \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i} \\right) A_i^{-1/2} (y_i - \\mu_i)\n    $$\n    这是在指定条件下 GEE 估计函数的最终闭合形式表达式。它依赖于数据 ($X_i, y_i$)、模型参数（通过 $\\mu_i$ 的 $\\beta$ 和 $\\alpha$）以及聚类大小 ($m_i$)。如第一部分所述，矩阵 $A_i$ 是 $\\mu_i$ 的函数。",
            "answer": "$$\n\\boxed{A_i = \\text{diag}(\\mu_{i1}(1-\\mu_{i1}), \\mu_{i2}(1-\\mu_{i2}), \\dots, \\mu_{im_i}(1-\\mu_{im_i}))}\n$$\n\n$$\n\\boxed{U(\\beta) = \\sum_{i=1}^{n} X_i^{\\top} A_i^{1/2} \\left[ \\frac{1}{1-\\alpha} I_{m_i} - \\frac{\\alpha}{(1-\\alpha)(1 + (m_i-1)\\alpha)} J_{m_i} \\right] A_i^{-1/2} (y_i - \\mu_i)}\n$$"
        },
        {
            "introduction": "理论在应用于数据时才真正焕发生机。最后一个练习将重点从推导方程转移到解释GEE分析的输出，这对任何生物统计学家来说都是一项关键技能。你将比较对数（log）连接函数与对数几率（logit）连接函数的选择如何改变暴露效应的解释，然后使用拟合的模型来计算并比较特定情景下的预测风险。",
            "id": "4913822",
            "problem": "一项呼吸道感染监测研究对 $n$ 个家庭进行了连续 $T$ 周的跟踪，产生了相关的二元结果 $Y_{it} \\in \\{0,1\\}$，表示家庭 $i$ 在第 $t$ 周是否报告了至少一例新感染。由于每周的感染不常见，经验边际风险很小。为了在建模边际均值的同时考虑家庭内部的相关性，分析人员拟合了两个具有可交换工作相关性的广义估计方程（GEE；Generalized Estimating Equations）：一个使用对数连接，另一个使用 logit 连接。两个模型都使用相同的协变量向量 $X_{it} = (1, \\text{exposure}_{it}, \\text{age}_{i}^{*})^{\\top}$，其中 $\\text{exposure}_{it} \\in \\{0,1\\}$ 表示在第 $t$ 周是否采取了有针对性的预防措施，而 $\\text{age}_{i}^{*} = (\\text{age}_{i} - 40)/10$ 是以 40 岁为中心、以十年为单位缩放的年龄。家庭内工作相关性的估计值为 $\\hat{\\rho} = 0.20$。\n\n从对数连接 GEE 中，估计的回归系数为 $\\hat{\\beta}^{\\log} = (\\hat{\\beta}^{\\log}_{0}, \\hat{\\beta}^{\\log}_{1}, \\hat{\\beta}^{\\log}_{2}) = (-4.70, 0.40, 0.03)$。从 logit 连接 GEE 中，估计的回归系数为 $\\hat{\\beta}^{\\mathrm{logit}} = (\\hat{\\beta}^{\\mathrm{logit}}_{0}, \\hat{\\beta}^{\\mathrm{logit}}_{1}, \\hat{\\beta}^{\\mathrm{logit}}_{2}) = (-4.90, 0.70, 0.05)$。\n\n仅使用具有正则连接映射的边际模型的第一性原理，并从 GEE 通过连接函数 $g$ 指定一个均值模型的定义出发，即对于边际均值 $\\mu_{it} = \\mathbb{E}(Y_{it} \\mid X_{it})$，有 $g\\!\\left(\\mu_{it}\\right) = X_{it}^{\\top}\\beta$，完成以下任务：\n\n1. 根据边际均值模型的参数，解释在对数连接与 logit 连接下，暴露效应的可解释性有何不同，特别是在罕见事件的情况下。\n2. 对于一个 $\\text{exposure}_{it} = 1$ 且 $\\text{age}_{i} = 30$ 岁的家庭，计算在每个拟合的 GEE 模型下的预测边际风险。使用 $X_{0} = (1, 1, -1)^{\\top}$，因为 $\\text{age}_{i}^{*} = (30 - 40)/10 = -1$。将两个预测值四舍五入到四位有效数字。以一个双元素行矩阵的形式报告这两个预测值，其中第一个元素对应于对数连接 GEE，第二个元素对应于 logit 连接 GEE。不需要单位。",
            "solution": "该问题是有效的，因为它科学地基于广义估计方程（GEE）的理论，问题陈述清晰，为所需任务提供了所有必要信息，并以客观、正式的语言表达。我们可以开始解答。\n\n问题要求基于相关二元结果 $Y_{it}$ 的 GEE 框架完成两个任务。边际均值 $\\mu_{it} = \\mathbb{E}(Y_{it} \\mid X_{it})$ 通过连接函数 $g$ 建模为 $g(\\mu_{it}) = X_{it}^{\\top}\\beta$。这里，$\\mu_{it}$ 表示家庭 $i$ 在第 $t$ 周的边际感染风险。\n\n### 第 1 部分：暴露效应的解释\n\n暴露效应的可解释性由对应于 $\\text{exposure}_{it}$ 协变量的系数 $\\beta_1$ 捕获，它直接取决于所选的连接函数 $g$。\n\n**对数连接（相对风险模型）**\n\n对于第一个 GEE，连接函数是自然对数，$g(\\mu_{it}) = \\ln(\\mu_{it})$。因此，边际均值模型为：\n$$\n\\ln(\\mu_{it}) = \\beta^{\\log}_{0} + \\beta^{\\log}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\n$$\n对两边取指数，得到风险本身的模型：\n$$\n\\mu_{it} = \\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)\n$$\n为了解释 $\\beta^{\\log}_{1}$，我们考察在保持所有其他协变量不变的情况下，暴露个体（$\\text{exposure}_{it} = 1$）与非暴露个体（$\\text{exposure}_{it} = 0$）的风险之比。这个比率是风险比（RR）。\n$$\n\\text{RR} = \\frac{\\mu_{it}(\\text{exposure}_{it}=1)}{\\mu_{it}(\\text{exposure}_{it}=0)} = \\frac{\\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1}(1) + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)}{\\exp\\left(\\beta^{\\log}_{0} + \\beta^{\\log}_{1}(0) + \\beta^{\\log}_{2} \\cdot \\text{age}_{i}^{*}\\right)} = \\exp(\\beta^{\\log}_{1})\n$$\n因此，$\\exp(\\beta^{\\log}_{1})$ 是风险比。对数连接模型直接估计风险比的对数。效应度量 $\\exp(\\beta^{\\log}_{1})$ 在其他协变量（在此例中为年龄）的所有水平上都是恒定的。\n\n**Logit 连接（逻辑斯蒂回归模型）**\n\n对于第二个 GEE，连接函数是 logit，$g(\\mu_{it}) = \\text{logit}(\\mu_{it}) = \\ln\\left(\\frac{\\mu_{it}}{1-\\mu_{it}}\\right)$。项 $\\frac{\\mu_{it}}{1-\\mu_{it}}$ 是结果的比值（odds）。边际均值模型为：\n$$\n\\ln\\left(\\frac{\\mu_{it}}{1-\\mu_{it}}\\right) = \\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1} \\cdot \\text{exposure}_{it} + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\n$$\n为了解释 $\\beta^{\\mathrm{logit}}_{1}$，我们考察在保持其他协变量不变的情况下，暴露个体与非暴露个体的比值之比。这就是比值比（OR）。\n$$\n\\text{OR} = \\frac{\\text{odds}(\\text{exposure}_{it}=1)}{\\text{odds}(\\text{exposure}_{it}=0)} = \\frac{\\exp\\left(\\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1}(1) + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\\right)}{\\exp\\left(\\beta^{\\mathrm{logit}}_{0} + \\beta^{\\mathrm{logit}}_{1}(0) + \\beta^{\\mathrm{logit}}_{2} \\cdot \\text{age}_{i}^{*}\\right)} = \\exp(\\beta^{\\mathrm{logit}}_{1})\n$$\n因此，$\\exp(\\beta^{\\mathrm{logit}}_{1})$ 是比值比。logit 连接模型直接估计比值比的对数。这个效应度量在其他协变量的所有水平上也是恒定的。\n\n**针对罕见事件的比较**\n\n问题指出感染不常见，意味着边际风险 $\\mu_{it}$ 很小。当 $\\mu_{it} \\to 0$ 时，比值计算中的分母 $1-\\mu_{it}$ 接近 $1$。因此，比值近似于风险：\n$$\n\\text{odds} = \\frac{\\mu_{it}}{1-\\mu_{it}} \\approx \\mu_{it} = \\text{risk}\n$$\n根据这个近似，比值比（OR）近似于风险比（RR）：\n$$\n\\text{OR} = \\frac{\\mu_1/(1-\\mu_1)}{\\mu_0/(1-\\mu_0)} = \\frac{\\mu_1}{\\mu_0} \\cdot \\frac{1-\\mu_0}{1-\\mu_1} = \\text{RR} \\cdot \\frac{1-\\mu_0}{1-\\mu_1} \\approx \\text{RR}\n$$\n因此，对于罕见事件，$\\exp(\\beta^{\\mathrm{logit}}_{1})$（即 OR）是 RR 的一个近似值。相比之下，$\\exp(\\beta^{\\log}_{1})$ 是 RR 的直接估计，而不是近似值。对数连接提供了一种更直接、更易于解释的相对风险度量，这在流行病学中通常是主要关注的量，特别是对于罕见结果。\n\n### 第 2 部分：边际风险的预测\n\n我们被要求为一个 $\\text{exposure}_{it} = 1$ 且 $\\text{age}_{i} = 30$ 岁的家庭计算预测的边际风险 $\\hat{\\mu}$。缩放后的年龄为 $\\text{age}_{i}^{*} = (30-40)/10 = -1$。协变量向量是 $X_{0} = (1, 1, -1)^{\\top}$。\n\n**对数连接 GEE 预测**\n\n估计的线性预测器 $\\hat{\\eta}^{\\log}$ 使用系数 $\\hat{\\beta}^{\\log} = (-4.70, 0.40, 0.03)^{\\top}$ 计算：\n$$\n\\hat{\\eta}^{\\log} = X_{0}^{\\top}\\hat{\\beta}^{\\log} = (1)(-4.70) + (1)(0.40) + (-1)(0.03) = -4.70 + 0.40 - 0.03 = -4.33\n$$\n预测风险 $\\hat{\\mu}^{\\log}$ 是通过应用反向连接函数（即指数函数）得到的：\n$$\n\\hat{\\mu}^{\\log} = \\exp(\\hat{\\eta}^{\\log}) = \\exp(-4.33) \\approx 0.0131682\n$$\n四舍五入到四位有效数字，预测风险为 $0.01317$。\n\n**Logit 连接 GEE 预测**\n\n估计的线性预测器 $\\hat{\\eta}^{\\mathrm{logit}}$ 使用系数 $\\hat{\\beta}^{\\mathrm{logit}} = (-4.90, 0.70, 0.05)^{\\top}$ 计算：\n$$\n\\hat{\\eta}^{\\mathrm{logit}} = X_{0}^{\\top}\\hat{\\beta}^{\\mathrm{logit}} = (1)(-4.90) + (1)(0.70) + (-1)(0.05) = -4.90 + 0.70 - 0.05 = -4.25\n$$\n预测风险 $\\hat{\\mu}^{\\mathrm{logit}}$ 是通过应用反向 logit（逻辑斯蒂）函数得到的：\n$$\n\\hat{\\mu}^{\\mathrm{logit}} = \\frac{\\exp(\\hat{\\eta}^{\\mathrm{logit}})}{1 + \\exp(\\hat{\\eta}^{\\mathrm{logit}})} = \\frac{\\exp(-4.25)}{1 + \\exp(-4.25)}\n$$\n首先，$\\exp(-4.25) \\approx 0.0142641$。然后，\n$$\n\\hat{\\mu}^{\\mathrm{logit}} = \\frac{0.0142641}{1 + 0.0142641} = \\frac{0.0142641}{1.0142641} \\approx 0.0140635\n$$\n四舍五入到四位有效数字，预测风险为 $0.01406$。\n\n这两个预测值，$0.01317$（来自对数连接模型）和 $0.01406$（来自 logit 连接模型），确实很小，这与问题中关于罕见事件的描述一致。最终答案要求将这两个值放入一个行矩阵中。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.01317  0.01406\n\\end{pmatrix}\n}\n$$"
        }
    ]
}