{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握Cochran-Mantel-Haenszel (CMH)检验，没有什么比亲手实践其计算过程更有效的方法了。这个练习将指导您从分层数据开始，一步步计算$Q_{MH}$统计量。通过在零假设下计算预期单元格计数及其方差，您将对CMH检验如何跨层汇总证据以检验总体关联建立起基础性的理解 。",
            "id": "4900624",
            "problem": "一位研究者在 $3$ 个临床定义的分层（例如，年龄组）中研究了二元暴露与二元疾病结局之间的关联，得到了三个 $2 \\times 2$ 列联表，其层特异性单元格计数为 $(a_k,b_k,c_k,d_k)$，其中 $k \\in \\{1,2,3\\}$。观测到的计数为 $(a_1,b_1,c_1,d_1)=(12,8,18,22)$，$(a_2,b_2,c_2,d_2)=(5,15,20,10)$ 和 $(a_3,b_3,c_3,d_3)=(9,11,13,27)$。定义第 $k$ 层的行总计 $m_{1k}=a_k+b_k$ 和 $m_{0k}=c_k+d_k$，列总计 $n_{1k}=a_k+c_k$ 和 $n_{0k}=b_k+d_k$，以及总计 $n_k=m_{1k}+m_{0k}=n_{1k}+n_{0k}$。\n\n在每个分层内暴露与结局无关联的原假设下（即共同比值比等于 $1$），在固定边际 $(m_{1k},m_{0k},n_{1k},n_{0k})$ 的条件下，单元格计数 $a_k$ 服从超几何模型，其期望值为 $E[a_k]=\\frac{m_{1k}n_{1k}}{n_k}$，方差为 $\\operatorname{Var}(a_k)=\\frac{m_{1k}m_{0k}n_{1k}n_{0k}}{n_k^{2}(n_k-1)}$。从这个分层超几何框架出发，通过汇总各层的层特异性偏差 $a_k-E[a_k]$ 及其方差，构建用于检验共同比值比是否为 $1$ 的 Cochran–Mantel–Haenszel (CMH) 检验统计量 $Q_{MH}$。根据上述数据计算 $Q_{MH}$ 的数值，并结合大样本参考分布对其进行简要解释。\n\n将您的 $Q_{MH}$ 最终数值答案四舍五入至四位有效数字。不需要单位。",
            "solution": "问题陈述定义明确，科学合理，并提供了计算 Cochran-Mantel-Haenszel 检验统计量的所有必要信息。因此，我将继续进行解答。\n\nCochran–Mantel–Haenszel (CMH) 检验用于检验二元暴露和二元结局之间的关联，同时校正一个或多个分类混杂变量（分层）。原假设 $H_0$ 为：在任何分层内，暴露与结局之间均无关联，这对应于所有分层的共同比值比 (OR) 为 $1$。\n\nCMH 检验统计量 $Q_{MH}$ 汇总了 $K$ 个分层的信息。对于每个分层 $k$（其中 $k=1, \\dots, K$），数据可以表示为一个 $2 \\times 2$ 列联表：\n\n$$\n\\begin{array}{c|cc|c}\n  \\text{结局 +}  \\text{结局 -}  \\text{总计} \\\\\n\\hline\n\\text{暴露}  a_k  b_k  m_{1k} \\\\\n\\text{未暴露}  c_k  d_k  m_{0k} \\\\\n\\hline\n\\text{总计}  n_{1k}  n_{0k}  n_k\n\\end{array}\n$$\n\n问题陈述指出，在原假设下，以边际总计 $(m_{1k}, m_{0k}, n_{1k}, n_{0k})$ 为条件，计数 $a_k$ 服从超几何分布。$a_k$ 的期望值和方差由下式给出：\n$$E[a_k] = \\frac{m_{1k}n_{1k}}{n_k}$$\n$$\\operatorname{Var}(a_k) = \\frac{m_{1k}m_{0k}n_{1k}n_{0k}}{n_k^{2}(n_k-1)}$$\n\nCMH 统计量是通过对所有分层的观测计数 $a_k$ 与其期望值 $E[a_k]$ 的偏差求和，然后将此总和的平方与方差的总和进行比较来构建的。未校正的 CMH 统计量公式为：\n$$Q_{MH} = \\frac{\\left( \\sum_{k=1}^{K} (a_k - E[a_k]) \\right)^2}{\\sum_{k=1}^{K} \\operatorname{Var}(a_k)}$$\n\n我们有 $K=3$ 个分层的数据。我们将为每个分层计算必要的量。\n\n**分层 1：**\n观测计数为 $(a_1, b_1, c_1, d_1) = (12, 8, 18, 22)$。\n边际总计为：\n$m_{11} = a_1 + b_1 = 12 + 8 = 20$\n$m_{01} = c_1 + d_1 = 18 + 22 = 40$\n$n_{11} = a_1 + c_1 = 12 + 18 = 30$\n$n_{01} = b_1 + d_1 = 8 + 22 = 30$\n$n_1 = m_{11} + m_{01} = 20 + 40 = 60$\n\n在 $H_0$ 下，$a_1$ 的期望值为：\n$$E[a_1] = \\frac{m_{11}n_{11}}{n_1} = \\frac{20 \\times 30}{60} = 10$$\n$a_1$ 的方差为：\n$$\\operatorname{Var}(a_1) = \\frac{m_{11}m_{01}n_{11}n_{01}}{n_1^{2}(n_1-1)} = \\frac{20 \\times 40 \\times 30 \\times 30}{60^2 (60-1)} = \\frac{720000}{3600 \\times 59} = \\frac{200}{59}$$\n偏差为 $a_1 - E[a_1] = 12 - 10 = 2$。\n\n**分层 2：**\n观测计数为 $(a_2, b_2, c_2, d_2) = (5, 15, 20, 10)$。\n边际总计为：\n$m_{12} = a_2 + b_2 = 5 + 15 = 20$\n$m_{02} = c_2 + d_2 = 20 + 10 = 30$\n$n_{12} = a_2 + c_2 = 5 + 20 = 25$\n$n_{02} = b_2 + d_2 = 15 + 10 = 25$\n$n_2 = m_{12} + m_{02} = 20 + 30 = 50$\n\n在 $H_0$ 下，$a_2$ 的期望值为：\n$$E[a_2] = \\frac{m_{12}n_{12}}{n_2} = \\frac{20 \\times 25}{50} = 10$$\n$a_2$ 的方差为：\n$$\\operatorname{Var}(a_2) = \\frac{m_{12}m_{02}n_{12}n_{02}}{n_2^{2}(n_2-1)} = \\frac{20 \\times 30 \\times 25 \\times 25}{50^2 (50-1)} = \\frac{375000}{2500 \\times 49} = \\frac{150}{49}$$\n偏差为 $a_2 - E[a_2] = 5 - 10 = -5$。\n\n**分层 3：**\n观测计数为 $(a_3, b_3, c_3, d_3) = (9, 11, 13, 27)$。\n边际总计为：\n$m_{13} = a_3 + b_3 = 9 + 11 = 20$\n$m_{03} = c_3 + d_3 = 13 + 27 = 40$\n$n_{13} = a_3 + c_3 = 9 + 13 = 22$\n$n_{03} = b_3 + d_3 = 11 + 27 = 38$\n$n_3 = m_{13} + m_{03} = 20 + 40 = 60$\n\n在 $H_0$ 下，$a_3$ 的期望值为：\n$$E[a_3] = \\frac{m_{13}n_{13}}{n_3} = \\frac{20 \\times 22}{60} = \\frac{44}{6} = \\frac{22}{3}$$\n$a_3$ 的方差为：\n$$\\operatorname{Var}(a_3) = \\frac{m_{13}m_{03}n_{13}n_{03}}{n_3^{2}(n_3-1)} = \\frac{20 \\times 40 \\times 22 \\times 38}{60^2 (60-1)} = \\frac{668800}{3600 \\times 59} = \\frac{1672}{9 \\times 59} = \\frac{1672}{531}$$\n偏差为 $a_3 - E[a_3] = 9 - \\frac{22}{3} = \\frac{27-22}{3} = \\frac{5}{3}$。\n\n现在我们汇总这些结果。\n偏差之和为：\n$$\\sum_{k=1}^{3} (a_k - E[a_k]) = 2 + (-5) + \\frac{5}{3} = -3 + \\frac{5}{3} = \\frac{-9+5}{3} = -\\frac{4}{3}$$\n方差之和为：\n$$\\sum_{k=1}^{3} \\operatorname{Var}(a_k) = \\frac{200}{59} + \\frac{150}{49} + \\frac{1672}{531}$$\n为对这些分数求和，我们找到一个公分母。分母分别为 $59$，$49=7^2$ 和 $531=9 \\times 59 = 3^2 \\times 59$。最小公分母是 $9 \\times 49 \\times 59 = 26019$。\n$$\\sum_{k=1}^{3} \\operatorname{Var}(a_k) = \\frac{200 \\times (9 \\times 49)}{26019} + \\frac{150 \\times (9 \\times 59)}{26019} + \\frac{1672 \\times 49}{26019}$$\n$$\\sum_{k=1}^{3} \\operatorname{Var}(a_k) = \\frac{200 \\times 441}{26019} + \\frac{150 \\times 531}{26019} + \\frac{81928}{26019} = \\frac{88200 + 79650 + 81928}{26019} = \\frac{249778}{26019}$$\n\n最后，我们计算 CMH 统计量 $Q_{MH}$：\n$$Q_{MH} = \\frac{\\left(-\\frac{4}{3}\\right)^2}{\\frac{249778}{26019}} = \\frac{\\frac{16}{9}}{\\frac{249778}{26019}} = \\frac{16}{9} \\times \\frac{26019}{249778}$$\n由于 $26019 = 9 \\times 2891$，我们可以简化：\n$$Q_{MH} = \\frac{16 \\times (9 \\times 2891)}{9 \\times 249778} = \\frac{16 \\times 2891}{249778} = \\frac{46256}{249778} \\approx 0.185186$$\n四舍五入到四位有效数字，我们得到 $Q_{MH} \\approx 0.1852$。\n\n**解释：**\n在无关联的原假设（共同比值比为 $1$）下，对于足够大的样本量，CMH 检验统计量 $Q_{MH}$ 服从自由度为 $1$ 的卡方分布，记为 $\\chi^2_1$。\n该统计量的计算值为 $Q_{MH} \\approx 0.1852$。我们将此值与 $\\chi^2_1$ 分布的临界值进行比较。对于典型的显著性水平 $\\alpha = 0.05$，临界值为 $3.841$。由于 $0.1852  3.841$，检验统计量不落在拒绝域内。因此，我们没有充分的统计证据来拒绝原假设。在对分层变量进行校正后，观测数据与暴露和结局之间无关联的假设相符。",
            "answer": "$$\\boxed{0.1852}$$"
        },
        {
            "introduction": "现实世界的数据集很少像教科书中的例子那样完美，稀疏数据，特别是零单元格计数，是一个常见的挑战。本练习探讨了在其中一个分层中出现零单元格对CMH检验统计量和Mantel-Haenszel共同比值比估计值的实际影响。通过这个假设性场景的练习，您将加深对该方法稳健性的理解，并掌握处理稀疏数据时所需的精细解读技巧。",
            "id": "4900582",
            "problem": "一项分层病例对照分析在 $K=3$ 个层中比较暴露与疾病，每个层由一个 $2\\times 2$ 表格总结，其单元格计数为 $(a_k,b_k,c_k,d_k)$，其中 $k$ 为层编号，$a_k$ 是暴露病例数，$b_k$ 是暴露对照数，$c_k$ 是非暴露病例数，$d_k$ 是非暴露对照数。假设各层数据如下：\n- 第1层：$(a_1,b_1,c_1,d_1) = (12,18,8,22)$，\n- 第2层：修改为 $(a_2,b_2,c_2,d_2) = (0,20,25,5)$，\n- 第3层：$(a_3,b_3,c_3,d_3) = (15,10,5,30)$。\n\n考虑用于检验各层间暴露与疾病无关联的原假设的Cochran-Mantel-Haenszel (CMH) 卡方统计量 $Q_{MH}$，以及公共比值比的Mantel-Haenszel (MH) 估计量 $\\hat{\\theta}_{MH}$。在存在零单元格 $a_2 = 0$ 的情况下，关于 $Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 的计算和解释，下列哪个陈述是正确的？\n\nA. 使用固定边际条件模型，尽管 $a_2=0$，$Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 仍然有明确定义；对于这些数据，可以发现 $\\hat{\\theta}_{MH} \\approx 0.90$ 且 $Q_{MH} \\approx 0.18$，因此在 $\\alpha=0.05$ 的水平上，没有证据反对原假设。\n\nB. 零单元格 $a_2=0$ 使得 $Q_{MH}$ 未定义，因为其方差计算中需要除以 $a_k$，并迫使 $\\hat{\\theta}_{MH}$ 恰好为 $0$。\n\nC. 当任何单元格为 $0$ 时，计算 $\\hat{\\theta}_{MH}$ 的唯一方法是在该层中添加连续性校正（例如，在所有四个单元格中都加上 $0.5$）；如果没有这样的校正，$\\hat{\\theta}_{MH}$ 无法计算，并且在此数据集中，校正后的 $\\hat{\\theta}_{MH}$ 会超过 $1$。\n\nD. 零单元格会增加 $Q_{MH}$ 所依赖的卡方近似的小样本问题；虽然在这里 $Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 都可以无需连续性校正即可计算，但解释时应考虑精确条件推断或对小样本校正的敏感性，并注意，即使其他层表明存在正相关，某一层中的零值也可以将 $\\hat{\\theta}_{MH}$ 拉向低于 $1$ 的值。\n\nE. 如果在任何单个层中 $a_k=0$，那么跨层的合并估计 $\\hat{\\theta}_{MH}$ 必然小于 $1$。",
            "solution": "问题陈述提供了一项分层病例对照研究的数据，并要求评估在存在零单元格计数的情况下，关于公共比值比的Mantel-Haenszel (MH) 估计量 $\\hat{\\theta}_{MH}$ 和Cochran-Mantel-Haenszel (CMH) 检验统计量 $Q_{MH}$ 的计算和解释的陈述。\n\n对问题陈述的验证发现其具有科学依据、问题明确且客观。该设置是生物统计学问题的标准设置，计算所需的所有数据均已提供且内部一致。该问题是有效的。\n\n我们现在将进行所需统计量的推导并评估每个选项。\n\n给出 $K=3$ 个层的数据，其单元格计数为 $(a_k, b_k, c_k, d_k)$，其中 $k=1, 2, 3$。\n- 第1层：$(a_1,b_1,c_1,d_1) = (12,18,8,22)$\n- 第2层：$(a_2,b_2,c_2,d_2) = (0,20,25,5)$\n- 第3层：$(a_3,b_3,c_3,d_3) = (15,10,5,30)$\n\n第 $k$ 层的总样本量为 $n_k=a_k+b_k+c_k+d_k$。\n- $n_1 = 12+18+8+22 = 60$\n- $n_2 = 0+20+25+5 = 50$\n- $n_3 = 15+10+5+30 = 60$\n\n**1. Mantel-Haenszel 估计量 $\\hat{\\theta}_{MH}$ 的计算**\n\n公共比值比的 MH 估计量的公式为：\n$$ \\hat{\\theta}_{MH} = \\frac{\\sum_{k=1}^K R_k}{\\sum_{k=1}^K S_k} = \\frac{\\sum_{k=1}^K a_k d_k / n_k}{\\sum_{k=1}^K b_k c_k / n_k} $$\n只要分母 $\\sum b_k c_k / n_k$ 不为零，该公式就有明确定义。$a_k$ 单元格中存在零值不会影响其可计算性。\n\n让我们计算每个层的分量：\n- 第1层：$R_1 = \\frac{a_1 d_1}{n_1} = \\frac{12 \\times 22}{60} = \\frac{264}{60} = 4.4$。\n  $S_1 = \\frac{b_1 c_1}{n_1} = \\frac{18 \\times 8}{60} = \\frac{144}{60} = 2.4$。\n- 第2层：$R_2 = \\frac{a_2 d_2}{n_2} = \\frac{0 \\times 5}{50} = 0$。\n  $S_2 = \\frac{b_2 c_2}{n_2} = \\frac{20 \\times 25}{50} = \\frac{500}{50} = 10$。\n- 第3层：$R_3 = \\frac{a_3 d_3}{n_3} = \\frac{15 \\times 30}{60} = \\frac{450}{60} = 7.5$。\n  $S_3 = \\frac{b_3 c_3}{n_3} = \\frac{10 \\times 5}{60} = \\frac{50}{60} = \\frac{5}{6}$。\n\n现在我们对这些分量求和：\n- $\\sum_{k=1}^3 R_k = 4.4 + 0 + 7.5 = 11.9$\n- $\\sum_{k=1}^3 S_k = 2.4 + 10 + \\frac{5}{6} = 12.4 + \\frac{5}{6} = \\frac{124}{10} + \\frac{5}{6} = \\frac{62}{5} + \\frac{5}{6} = \\frac{372+25}{30} = \\frac{397}{30}$\n\n最后，我们计算估计量：\n$$ \\hat{\\theta}_{MH} = \\frac{11.9}{397/30} = \\frac{119/10}{397/30} = \\frac{119}{10} \\times \\frac{30}{397} = \\frac{119 \\times 3}{397} = \\frac{357}{397} \\approx 0.89924 $$\n所以，$\\hat{\\theta}_{MH} \\approx 0.90$。\n\n**2. Cochran-Mantel-Haenszel 统计量 $Q_{MH}$ 的计算**\n\nCMH 检验统计量的公式为：\n$$ Q_{MH} = \\frac{\\left( \\sum_{k=1}^K a_k - \\sum_{k=1}^K E[a_k] \\right)^2}{\\sum_{k=1}^K \\text{Var}(a_k)} $$\n期望值 $E[a_k]$ 和方差 $\\text{Var}(a_k)$ 是在原假设（$\\theta=1$）下，以每个 $2 \\times 2$ 表的边际总和为条件计算的。令 $r_{1k} = a_k+c_k$（病例），$r_{2k} = b_k+d_k$（对照），$m_{1k} = a_k+b_k$（暴露），以及 $m_{2k} = c_k+d_k$（非暴露）。\n\n公式为：\n- $E[a_k] = \\frac{r_{1k} m_{1k}}{n_k}$\n- $\\text{Var}(a_k) = \\frac{r_{1k} r_{2k} m_{1k} m_{2k}}{n_k^2 (n_k-1)}$\n\n让我们计算每个层的分量：\n- 第1层：$r_{11}=12+8=20$, $m_{11}=12+18=30, n_1=60$。\n  $E[a_1] = \\frac{20 \\times 30}{60} = 10$。\n  $r_{21}=18+22=40, m_{21}=8+22=30$。\n  $\\text{Var}(a_1) = \\frac{20 \\times 40 \\times 30 \\times 30}{60^2 (59)} = \\frac{720000}{3600 \\times 59} = \\frac{200}{59} \\approx 3.3898$。\n- 第2层：$r_{12}=0+25=25, m_{12}=0+20=20, n_2=50$。\n  $E[a_2] = \\frac{25 \\times 20}{50} = 10$。\n  $r_{22}=20+5=25, m_{22}=25+5=30$。\n  $\\text{Var}(a_2) = \\frac{25 \\times 25 \\times 20 \\times 30}{50^2 (49)} = \\frac{375000}{2500 \\times 49} = \\frac{150}{49} \\approx 3.0612$。\n- 第3层：$r_{13}=15+5=20, m_{13}=15+10=25, n_3=60$。\n  $E[a_3] = \\frac{20 \\times 25}{60} = \\frac{500}{60} = \\frac{25}{3}$。\n  $r_{23}=10+30=40, m_{23}=5+30=35$。\n  $\\text{Var}(a_3) = \\frac{20 \\times 40 \\times 25 \\times 35}{60^2 (59)} = \\frac{700000}{3600 \\times 59} = \\frac{1750}{9 \\times 59} = \\frac{1750}{531} \\approx 3.2957$。\n\n现在，我们对所需分量求和：\n- 观测总和：$O = \\sum a_k = 12 + 0 + 15 = 27$。\n- 期望总和：$E = \\sum E[a_k] = 10 + 10 + \\frac{25}{3} = 20 + \\frac{25}{3} = \\frac{60+25}{3} = \\frac{85}{3} \\approx 28.333$。\n- 方差总和：$V = \\sum \\text{Var}(a_k) = \\frac{200}{59} + \\frac{150}{49} + \\frac{1750}{531} \\approx 3.3898 + 3.0612 + 3.2957 \\approx 9.7467$。\n\n最后，我们计算统计量：\n$$ Q_{MH} = \\frac{(O - E)^2}{V} = \\frac{(27 - 85/3)^2}{9.7467} = \\frac{((81-85)/3)^2}{9.7467} = \\frac{(-4/3)^2}{9.7467} = \\frac{16/9}{9.7467} \\approx \\frac{1.777...}{9.7467} \\approx 0.1824 $$\n所以，$Q_{MH} \\approx 0.18$。在原假设下，$Q_{MH}$ 服从自由度为 $1$ 的卡方分布。对于 $\\alpha=0.05$，临界值为 $\\chi^2_{1, 0.95} \\approx 3.84$。由于 $0.18  3.84$，我们不拒绝原假设。\n\n**评估选项**\n\nA. 使用固定边际条件模型，尽管 $a_2=0$，$Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 仍然有明确定义；对于这些数据，可以发现 $\\hat{\\theta}_{MH} \\approx 0.90$ 且 $Q_{MH} \\approx 0.18$，因此在 $\\alpha=0.05$ 的水平上，没有证据反对原假设。\n- 我们的计算证实了，尽管 $a_2=0$，$\\hat{\\theta}_{MH}$ 和 $Q_{MH}$ 仍然有明确定义且可计算。它们各自公式中的分母不为零。\n- 我们的计算值 $\\hat{\\theta}_{MH} \\approx 0.89924$ 被正确地近似为 $0.90$。\n- 我们的计算值 $Q_{MH} \\approx 0.1824$ 被正确地近似为 $0.18$。\n- 没有证据反对原假设的结论在 $\\alpha=0.05$ 水平上是正确的，因为 $Q_{MH} \\approx 0.18  3.84$。\n- 结论：**正确**。\n\nB. 零单元格 $a_2=0$ 使得 $Q_{MH}$ 未定义，因为其方差计算中需要除以 $a_k$，并迫使 $\\hat{\\theta}_{MH}$ 恰好为 $0$。\n- $\\text{Var}(a_k)$ 的公式是 $\\frac{r_{1k} r_{2k} m_{1k} m_{2k}}{n_k^2 (n_k-1)}$。该公式不涉及除以 $a_k$。方差有明确定义。\n- $\\hat{\\theta}_{MH}$ 的公式是 $\\frac{\\sum a_k d_k / n_k}{\\sum b_k c_k / n_k}$。单个项 $a_k d_k / n_k$ 为零不会迫使整个和（分子）为零，除非所有这样的项都为零。在我们的数据中，分子是 $11.9 \\neq 0$。总的估计值不为 $0$。\n- 结论：**错误**。\n\nC. 当任何单元格为 $0$ 时，计算 $\\hat{\\theta}_{MH}$ 的唯一方法是在该层中添加连续性校正（例如，在所有四个单元格中都加上 $0.5$）；如果没有这样的校正，$\\hat{\\theta}_{MH}$ 无法计算，并且在此数据集中，校正后的 $\\hat{\\theta}_{MH}$ 会超过 $1$。\n- $\\hat{\\theta}_{MH}$ 无法计算而需校正的说法是错误的。我们直接根据其定义计算了它。这种校正通常用于特定层的比值比 $\\hat{\\theta}_k = a_k d_k / b_k c_k$（当某个单元格为零时），但不用于合并的 MH 估计量。\n- 连续性校正不是“唯一方法”；未校正的估计量是标准定义。\n- 即使我们对第2层的单元格加上 $0.5$，新数据 $(0.5, 20.5, 25.5, 5.5)$ 且 $n_2' = 52$ 会得到 $R_2' = \\frac{0.5 \\times 5.5}{52} \\approx 0.0529$ 和 $S_2' = \\frac{20.5 \\times 25.5}{52} \\approx 10.0529$。校正后的估计量将是 $\\hat{\\theta}_{MH}' = \\frac{4.4 + 0.0529 + 7.5}{2.4 + 10.0529 + 5/6} = \\frac{11.9529}{13.2862} \\approx 0.8996$，不大于 $1$。\n- 结论：**错误**。\n\nD. 零单元格会增加 $Q_{MH}$ 所依赖的卡方近似的小样本问题；虽然在这里 $Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 都可以无需连续性校正即可计算，但解释时应考虑精确条件推断或对小样本校正的敏感性，并注意，即使其他层表明存在正相关，某一层中的零值也可以将 $\\hat{\\theta}_{MH}$ 拉向低于 $1$ 的值。\n- “零单元格会增加小样本问题...”：这是一个正确的统计学原理。稀疏数据对 $Q_{MH}$ 的卡方分布等渐近近似的有效性提出了挑战。\n- “...在这里 $Q_{MH}$ 和 $\\hat{\\theta}_{MH}$ 都可以计算...”：这是正确的，如前所示。\n- “...解释时应考虑精确条件推断...”：在处理稀疏数据时，这是一个标准且恰当的建议。精确方法避免了对渐近近似的依赖。\n- “...某一层中的零值可以将 $\\hat{\\theta}_{MH}$ 拉向低于 $1$ 的值...”：这也是正确的。特定层的比值比为 $\\hat{\\theta}_1 = \\frac{12 \\times 22}{18 \\times 8} \\approx 1.83$，$\\hat{\\theta}_2=0$，以及 $\\hat{\\theta}_3 = \\frac{15 \\times 30}{10 \\times 5} = 9$。比值比为0的第2层，在MH计算中权重很大（$S_2=10$），相比之下其他层权重较小（$S_1=2.4$, $S_3 \\approx 0.83$）。尽管第1层和第3层存在强正相关，但这个大权重将合并估计值 $\\hat{\\theta}_{MH} \\approx 0.90$ 拉低至1以下。\n- 该陈述的每个部分都代表了在这种情况下统计实践和解释的一个正确且有见地的方面。\n- 结论：**正确**。\n\nE. 如果在任何单个层中 $a_k=0$，那么跨层的合并估计 $\\hat{\\theta}_{MH}$ 必然小于 $1$。\n- 这个陈述暗示了一个普遍规则。我们可以用一个反例来检验它。考虑两个层：第1层：$(a_1,b_1,c_1,d_1)=(0,1,10,10)$，所以 $a_1=0$。第2层：$(a_2,b_2,c_2,d_2)=(10,1,1,10)$。\n- 在此例中，$n_1=21, n_2=22$。\n- $R_1=0/21=0$, $S_1=10/21$。\n- $R_2=100/22$, $S_2=1/22$。\n- $\\hat{\\theta}_{MH} = \\frac{0 + 100/22}{10/21 + 1/22} = \\frac{100/22}{(220+21)/(21 \\times 22)} = \\frac{100}{22} \\frac{462}{241} = \\frac{100 \\times 21}{241} = \\frac{2100}{241} \\approx 8.71  1$。\n- 这个反例证伪了该说法。具有 $a_k=0$ 的单个层的影响取决于其他层中的相对权重和关联强度。\n- 结论：**错误**。\n\n陈述A和D都是正确的。陈述A确认了该数据集的具体数值结果和直接结论。陈述D就存在零单元格相关的方法学问题和解释提供了正确且更普遍的评论。",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "统计分析是一个整体过程，孤立地解释单个检验结果可能会产生误导。最后一个练习将CMH检验置于其恰当的分析背景中，将其与用于检验同质性的Breslow-Day检验配对。通过共同解读这两个检验的结果，您将学会在对总体关联得出结论之前，首先评估共同比值比假设有效性的关键技能。",
            "id": "4900599",
            "problem": "一项观察性多中心研究调查了暴露 $E$ 是否与二元疾病结局 $D$ 相关，并按临床中心 $S \\in \\{1,2,3\\}$ 进行了分层。在每个分层内，患者根据 $E$ 和 $D$ 进行交叉分类，得到 $2 \\times 2$ 表。观察到的计数如下：\n\n分层 $S=1$：\n$$\n\\begin{array}{c|cc}\n  D=1  D=0 \\\\\n\\hline\nE=1  18  82 \\\\\nE=0  9  91\n\\end{array}\n$$\n\n分层 $S=2$：\n$$\n\\begin{array}{c|cc}\n  D=1  D=0 \\\\\n\\hline\nE=1  25  75 \\\\\nE=0  12  88\n\\end{array}\n$$\n\n分层 $S=3$：\n$$\n\\begin{array}{c|cc}\n  D=1  D=0 \\\\\n\\hline\nE=1  30  70 \\\\\nE=0  14  86\n\\end{array}\n$$\n\n你应用 Cochran-Mantel-Haenszel (CMH) 检验来评估在对 $S$ 进行调整后，$E$ 和 $D$ 之间是否存在关联，并应用 Breslow-Day (BD) 检验来评估分层特异性比值比在各个 $S$ 层之间是否同质。CMH 检验得出的 $p$ 值为 $0.004$，BD 检验得出的 $p$ 值为 $0.55$。\n\n仅使用基本原理和核心定义来解释这些结果。特别要讨论，一个显著的 CMH 检验结果与一个不显著的 BD 检验结果并存的模式，对于声称和报告一个共同效应意味着什么。选择唯一最佳的陈述。\n\nA. 数据提供了在以 $S$ 为条件下 $E$ 和 $D$ 之间存在关联的证据，且没有证据表明分层特异性比值比存在异质性；使用单一的共同比值比（例如，Mantel-Haenszel 估计值）及其置信区间进行总结是恰当的，同时应注意，不显著的 BD 检验并不能证明完全的同质性。\n\nB. 显著的 CMH 检验和不显著的 BD 检验的组合表明存在辛普森悖论；调整后的关联是一种假象，因此只应报告未经调整的合并 $2 \\times 2$ 表。\n\nC. 显著的 CMH 检验与不显著的 BD 检验一起表明存在强烈的效应修饰；因此，共同效应是无效的，只应报告分层特异性比值比。\n\nD. 结果表明，按 $S$ 分层已完全消除了混杂，以至于不存在调整后的关联；因此，该暴露没有效应，不应报告任何比值比。\n\nE. CMH 检验仅在 BD 检验显著时才有效；由于此处的 BD 检验不显著，CMH 结果应被忽略，并且必须使用带有交互项的逻辑斯谛回归。",
            "solution": "用户提供了一个生物统计学问题，要求解释应用于分层 $2 \\times 2$ 列联表的 Cochran-Mantel-Haenszel (CMH) 检验和 Breslow-Day (BD) 检验的结果。\n\n### 第一步：提取已知条件\n\n-   **研究设计**：一项观察性多中心研究，调查二元暴露 $E$ 与二元疾病结局 $D$ 之间的关联。\n-   **分层**：研究按临床中心 $S$ 进行分层，其中 $S \\in \\{1, 2, 3\\}$。\n-   **数据**：每个分层中 $2 \\times 2$ 表的观察计数如下。对于一个通用分层 $i$，表格为：\n    $$\n    \\begin{array}{c|cc|c}\n      D=1  D=0  \\text{Total} \\\\\n    \\hline\n    E=1  a_i  b_i  n_{1i} \\\\\n    E=0  c_i  d_i  n_{0i} \\\\\n    \\hline\n    \\text{Total}  m_{1i}  m_{0i}  N_i\n    \\end{array}\n    $$\n    -   分层 $S=1$：$a_1=18$, $b_1=82$, $c_1=9$, $d_1=91$。\n    -   分层 $S=2$：$a_2=25$, $b_2=75$, $c_2=12$, $d_2=88$。\n    -   分层 $S=3$：$a_3=30$, $b_3=70$, $c_3=14$, $d_3=86$。\n-   **统计结果**：\n    -   Cochran-Mantel-Haenszel (CMH) 检验：$p$ 值 $= 0.004$。\n    -   Breslow-Day (BD) 检验：$p$ 值 $= 0.55$。\n-   **问题**：解释这两个检验结果的组合，特别是关于声称和报告共同效应，并从选项中选择最佳陈述。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于流行病学和生物统计学的既定原则。使用 CMH 和 BD 检验分析分层分类数据是处理混杂和效应修饰的标准和基本技术。\n-   **适定性**：该问题是适定的。它提供了得出明确解释所需的必要背景（研究设计）、数据（列联表中的计数）和具体的统计结果（$p$ 值）。问题清晰，需要应用核心的统计推理。\n-   **客观性**：问题陈述是客观的，没有主观或含糊的语言。它呈现了事实数据和检验结果。\n-   **一致性检查**：让我们对结果的合理性进行简要检查。分层特异性比值比 ($OR_i = \\frac{a_i d_i}{b_i c_i}$) 为：\n    -   $OR_1 = \\frac{18 \\times 91}{82 \\times 9} = \\frac{1638}{738} \\approx 2.22$\n    -   $OR_2 = \\frac{25 \\times 88}{75 \\times 12} = \\frac{2200}{900} \\approx 2.44$\n    -   $OR_3 = \\frac{30 \\times 86}{70 \\times 14} = \\frac{2580}{980} \\approx 2.63$\n    比值比均大于 $1$ 且数量级相似。这种一致性正是 Breslow-Day 同质性检验所评估的。一个高的 $p$ 值 ($0.55$) 是完全合理的，因为它表示未能检测到这些比值比之间存在统计学上的显著差异。CMH 检验在假设同质性的前提下，评估了无关联（共同 $OR=1$）的原假设。由于每个分层都表明存在关联且 $OR  2$，因此合并后的证据很可能具有统计学显著性，这与给定的 $p$ 值 $0.004$ 一致。所提供的信息内部一致且事实可靠。\n\n### 第三步：判断与行动\n\n问题陈述是有效的。它科学合理、适定、客观且一致。我将继续推导解决方案。\n\n### 推导与选项分析\n\n**核心原则**\n\n1.  **Cochran-Mantel-Haenszel (CMH) 检验**：CMH 检验用于评估跨多个分层（此处为 $S$）的两个二元变量（此处为 $E$ 和 $D$）之间的关联。它检验原假设 $H_0: OR_{\\text{common}} = 1$，其中 $OR_{\\text{common}}$ 是所有分层中的共同比值比。一个显著的结果（小的 $p$ 值）表明，在调整分层变量后，暴露与结局之间存在关联。对 CMH 检验进行标准解释的一个关键假设是，比值比在各分层之间是同质的（恒定的）。\n\n2.  **Breslow-Day (BD) 检验**：BD 检验是用于检验比值比同质性的。它评估原假设 $H_0: OR_1 = OR_2 = \\dots = OR_k$，其中 $k$ 是分层的数量。一个不显著的结果（大的 $p$ 值）表明数据没有提供足够的证据来拒绝各分层之间存在共同比值比的假设。这支持了 CMH 检验的主要假设。一个显著的结果（小的 $p$ 值）则表明存在异质性或“效应修饰”，意味着暴露与结局之间关联的强度或方向因分层而异。\n\n**对给定结果的解释**\n\n-   **BD 检验结果 ($p=0.55$)**：这个 $p$ 值很大（即，大于常规的显著性水平如 $\\alpha=0.05$ 或 $\\alpha=0.10$）。我们未能拒绝比值比同质的原假设。这意味着数据与 $E$ 和 $D$ 之间的关联在所有三个临床中心具有相似幅度的假设是一致的。这并不能证明同质性，但意味着我们缺乏反对它的证据。\n-   **CMH 检验结果 ($p=0.004$)**：这个 $p$ 值很小。我们拒绝共同比值比为 $1$ 的原假设。这提供了强有力的证据，表明在控制了临床中心 $S$ 的混杂效应后，暴露 $E$ 和疾病 $D$ 之间存在统计学上显著的关联。\n\n**综合分析**\n\n不显著的 BD 检验和显著的 CMH 检验的组合，是使用单一的、调整后的关联度量来总结效应的理想情况。BD 检验的结果支持了 CMH 检验所需的同质性假设，而 CMH 检验的结果表明存在显著的潜在关联。因此，报告一个汇总的度量（如 Mantel-Haenszel 估计的共同比值比）作为主要发现，是标准且恰当的做法。\n\n**逐项选项分析**\n\n**A. 数据提供了在以 $S$ 为条件下 $E$ 和 $D$ 之间存在关联的证据，且没有证据表明分层特异性比值比存在异质性；使用单一的共同比值比（例如，a Mantel-Haenszel 估计值）及其置信区间进行总结是恰当的，同时应注意，不显著的 BD 检验并不能证明完全的同质性。**\n该陈述正确地解释了两个检验结果。显著的 CMH 检验 ($p=0.004$) 显示了在以 $S$ 为条件下的关联。不显著的 BD 检验 ($p=0.55$) 显示没有反对同质性的证据。结论是报告一个共同比值比，这是在这种情况下正确的统计实践。最后的附带说明，“……注意不显著的 BD 检验并不能证明完全的同质性”，是一个统计学上合理且重要的警告，正确地区分了“接受”原假设和“未能拒绝”原假设。\n**结论：正确。**\n\n**B. 显著的 CMH 检验和不显著的 BD 检验的组合表明存在辛普森悖论；调整后的关联是一种假象，因此只应报告未经调整的合并 $2 \\times 2$ 表。**\n不正确。辛普森悖论通常涉及分层后关联方向的反转。不显著的 BD 检验意味着关联在各分层间是一致的，而不是反转的。分层和调整分析的目的是控制像 $S$ 这样的混杂变量。调整后的关联（来自 CMH 检验）被认为是更有效的，而不是一种假象。仅报告未经调整的（粗略的）结果将忽略最初促使进行分层分析的潜在混杂。\n**结论：不正确。**\n\n**C. 显著的 CMH 检验与不显著的 BD 检验一起表明存在强烈的效应修饰；因此，共同效应是无效的，只应报告分层特异性比值比。**\n不正确。效应修饰（效应的异质性）是由*显著的* BD 检验指示的，而不是不显著的。$p$ 值为 $0.55$ 没有提供效应修饰的证据。因此，共同效应无效的结论是错误的；结果实际上支持了报告共同效应的有效性。\n**结论：不正确。**\n\n**D. 结果表明，按 $S$ 分层已完全消除了混杂，以至于不存在调整后的关联；因此，该暴露没有效应，不应报告任何比值比。**\n事实不正确。衡量调整后关联的 CMH 检验得出了一个高度显著的 $p$ 值 $0.004$。这明确表明，在分层后，调整后的关联*确实*存在。暴露没有效应的结论与证据直接矛盾。\n**结论：不正确。**\n\n**E. CMH 检验仅在 BD 检验显著时才有效；由于此处的 BD 检验不显著，CMH 结果应被忽略，并且必须使用带有交互项的逻辑斯谛回归。**\n该陈述的逻辑是颠倒的。用于共同关联的标准 CMH 检验，在其同质性的基本假设得到满足时，其解释最为恰当，而这一假设由*不显著的* BD 检验支持。如果 BD 检验是显著的，那才会对从 CMH 检验中得出的单一共同比值比的解释提出质疑。此外，带有交互项的逻辑斯谛回归是与*显著* BD 检验相对应的（即，当存在效应修饰时）。由于 BD 检验不显著，相应的基于模型的类比应该是一个仅包含主效应（无交互作用）的逻辑斯谛回归模型。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}