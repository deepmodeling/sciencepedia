{
    "hands_on_practices": [
        {
            "introduction": "在生物统计学中，我们常常需要整合来自不同中心或群体的研究数据，以得出一个更可靠的总体结论。本练习将引导你掌握Mantel-Haenszel (MH) 估计量的基本计算方法，这是控制混杂因素并获得一个合并优势比（odds ratio）的经典工具。通过这个实例，你将学会如何从分层数据中一步步计算出合并的效应估计值$\\hat{\\theta}_{MH}$，为更复杂的分析打下坚实基础。",
            "id": "4808964",
            "problem": "一项临床流行病学中的多中心病例对照研究旨在调查二元暴露与二元疾病结局之间的关联，其中中心的潜在混杂效应通过分层进行处理。对于每个层 $i \\in \\{1,2,3\\}$，其 $2 \\times 2$ 表格的单元格定义如下：$a_i$ 为暴露病例数，$b_i$ 为暴露对照数，$c_i$ 为非暴露病例数，$d_i$ 为非暴露对照数。现有来自 $3$ 个中心（层）的数据，其单元格计数分别为 $(a_i,b_i,c_i,d_i) = (10,40,20,30)$、$(5,25,15,55)$ 和 $(12,18,8,62)$。\n\n从 $2 \\times 2$ 表中比值的核心定义以及比值比作为暴露组间比值的比率出发，并假设由于研究设计导致各层边际固定且各层具有一个共同的层特异性比值比，请推导共同比值比的大样本 Mantel–Haenszel (MH) 估计量，并将其表示为层加权交叉乘积的比率。然后，根据这些数据计算各层总数 $n_i$，并评估 Mantel–Haenszel 比值比估计值 $\\hat{\\theta}_{MH}$。\n\n报告 $n_i$ 的精确整数值，并报告四舍五入到四位有效数字的 $\\hat{\\theta}_{MH}$ 值。不要使用百分号；最终结果以不带单位的纯数字表示。",
            "solution": "本问题要求从基本定义出发，推导共同比值比的 Mantel-Haenszel (MH) 估计量，并随后对一个来自于分层病例对照研究的给定数据集进行计算。\n\n**第一部分：Mantel-Haenszel 估计量的推导**\n\n我们首先将单个层内的数据结构形式化。对于每个层 $i$，数据可以整理成一个 $2 \\times 2$ 列联表，其中 $D+$ 表示患有疾病（病例），$D-$ 表示未患疾病（对照），$E+$ 和 $E-$ 分别表示存在暴露和不存在暴露。\n\n第 $i$ 层的单元格计数为：\n- $a_i$：暴露病例数 ($E+, D+$)\n- $b_i$：暴露对照数 ($E+, D-$)\n- $c_i$：非暴露病例数 ($E-, D+$)\n- $d_i$：非暴露对照数 ($E-, D-$)\n\n第 $i$ 层的表格如下：\n$$\n\\begin{array}{c|cc|c}\n D+  D-  \\text{总计} \\\\\n\\hline\nE+  a_i  b_i  a_i+b_i \\\\\nE-  c_i  d_i  c_i+d_i \\\\\n\\hline\n\\text{总计}  a_i+c_i  b_i+d_i  n_i\n\\end{array}\n$$\n其中 $n_i = a_i+b_i+c_i+d_i$ 是第 $i$ 层的受试者总数。问题指明了这是一个病例对照研究设计，即受试者是根据其疾病状态进行抽样的。在每个层中，病例数 ($n_{1i} = a_i+c_i$) 和对照数 ($n_{0i} = b_i+d_i$) 由研究设计固定。\n\n事件比值的核心定义是事件发生的概率与不发生概率之比。在病例对照研究中，我们分别估计病例组和对照组的暴露比值。\n\n在第 $i$ 层中，病例组的暴露比值通过暴露病例数与非暴露病例数之比来估计：\n$$\n\\text{Odds}(E+|D+, \\text{stratum } i) = \\frac{a_i}{c_i}\n$$\n在第 $i$ 层中，对照组的暴露比值通过暴露对照数与非暴露对照数之比来估计：\n$$\n\\text{Odds}(E+|D-, \\text{stratum } i) = \\frac{b_i}{d_i}\n$$\n第 $i$ 层的比值比 (OR)，记为 $\\theta_i$，是这两个比值的比率。它量化了该层内暴露与疾病之间的关联强度。\n$$\n\\hat{\\theta}_i = \\frac{\\text{Odds}(E+|D+, \\text{stratum } i)}{\\text{Odds}(E+|D-, \\text{stratum } i)} = \\frac{a_i/c_i}{b_i/d_i} = \\frac{a_i d_i}{b_i c_i}\n$$\n问题陈述了所有层具有一个共同比值比 $\\theta$ 的假设。即 $\\theta_1 = \\theta_2 = \\dots = \\theta_k = \\theta$。我们寻求一个单一的、合并了所有 $k$ 个层信息的 $\\theta$ 的汇总估计值。\n\nMantel-Haenszel 估计量 $\\hat{\\theta}_{MH}$ 提供了这样一个汇总估计值。它被构造为层特异性信息的加权平均，其形式使其具有良好的统计特性，尤其是在数据稀疏的情况下。MH 方法不是直接平均各层特异性比值比 $\\hat{\\theta}_i$（这样做可能不稳定），而是合并了交叉乘积。\n\nMH 估计量被定义为加权交叉乘积之和的比率。根据要求，其具体形式通过为每个层选择一个与其总样本量 $n_i$ 成反比的权重来推导。令“分子”交叉乘积 ($a_i d_i$) 和“分母”交叉乘积 ($b_i c_i$) 的权重为 $w_i = 1/n_i$。这导出了如下估计量：\n$$\n\\hat{\\theta}_{MH} = \\frac{\\sum_{i=1}^k w_i (a_i d_i)}{\\sum_{i=1}^k w_i (b_i c_i)}\n$$\n代入 $w_i = 1/n_i$，我们得到标准的大样本 Mantel-Haenszel 估计量：\n$$\n\\hat{\\theta}_{MH} = \\frac{\\sum_{i=1}^k \\frac{a_i d_i}{n_i}}{\\sum_{i=1}^k \\frac{b_i c_i}{n_i}}\n$$\n该公式将估计量表示为层加权交叉乘积总和的比率，其中每个层的权重是其总样本量的倒数。这就是所要求的推导过程。\n\n**第二部分：针对给定数据的计算**\n\n问题提供了来自 $k=3$ 个层的数据。\n- 第1层：$(a_1, b_1, c_1, d_1) = (10, 40, 20, 30)$\n- 第2层：$(a_2, b_2, c_2, d_2) = (5, 25, 15, 55)$\n- 第3层：$(a_3, b_3, c_3, d_3) = (12, 18, 8, 62)$\n\n首先，我们计算每个层的受试者总数 $n_i$。\n$$\nn_1 = a_1 + b_1 + c_1 + d_1 = 10 + 40 + 20 + 30 = 100\n$$\n$$\nn_2 = a_2 + b_2 + c_2 + d_2 = 5 + 25 + 15 + 55 = 100\n$$\n$$\nn_3 = a_3 + b_3 + c_3 + d_3 = 12 + 18 + 8 + 62 = 100\n$$\n各层总数分别为 $n_1 = 100$，$n_2 = 100$ 和 $n_3 = 100$。\n\n接下来，我们应用 Mantel-Haenszel 公式。我们计算分子，即加权交叉乘积 $\\frac{a_i d_i}{n_i}$ 的和：\n$$\n\\sum_{i=1}^3 \\frac{a_i d_i}{n_i} = \\frac{a_1 d_1}{n_1} + \\frac{a_2 d_2}{n_2} + \\frac{a_3 d_3}{n_3}\n$$\n$$\n= \\frac{10 \\times 30}{100} + \\frac{5 \\times 55}{100} + \\frac{12 \\times 62}{100}\n$$\n$$\n= \\frac{300}{100} + \\frac{275}{100} + \\frac{744}{100}\n$$\n$$\n= 3.00 + 2.75 + 7.44 = 13.19\n$$\n现在，我们计算分母，即加权交叉乘积 $\\frac{b_i c_i}{n_i}$ 的和：\n$$\n\\sum_{i=1}^3 \\frac{b_i c_i}{n_i} = \\frac{b_1 c_1}{n_1} + \\frac{b_2 c_2}{n_2} + \\frac{b_3 c_3}{n_3}\n$$\n$$\n= \\frac{40 \\times 20}{100} + \\frac{25 \\times 15}{100} + \\frac{18 \\times 8}{100}\n$$\n$$\n= \\frac{800}{100} + \\frac{375}{100} + \\frac{144}{100}\n$$\n$$\n= 8.00 + 3.75 + 1.44 = 13.19\n$$\n最后，我们计算 Mantel-Haenszel 比值比估计值 $\\hat{\\theta}_{MH}$：\n$$\n\\hat{\\theta}_{MH} = \\frac{\\sum_{i=1}^3 \\frac{a_i d_i}{n_i}}{\\sum_{i=1}^3 \\frac{b_i c_i}{n_i}} = \\frac{13.19}{13.19} = 1\n$$\n问题要求 $\\hat{\\theta}_{MH}$ 的结果四舍五入到四位有效数字。其精确值为 $1$。为用四位有效数字表示，我们写作 $1.000$。\n\n所要求的值为：\n- 各层总数：$n_1=100$, $n_2=100$, $n_3=100$。\n- Mantel-Haenszel 比值比估计值：$\\hat{\\theta}_{MH} = 1.000$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 100  100  100  1.000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "掌握了计算方法后，理解其必要性是下一个关键步骤。当一个外部变量（混杂因素）同时与暴露和结局相关时，直接合并数据计算出的“粗略”关联可能会产生严重误导，这有时也被称为辛普森悖论的一个实例。这个练习通过一个经典的混杂案例，让你直观地看到分层分析的威力，并理解为何Mantel-Haenszel估计值是获得一个调整后、更准确的效应度量的标准方法。",
            "id": "4924632",
            "problem": "一项病例-对照研究调查了暴露 $X$ 与二元疾病结局 $Y$ 之间的关联，并按就诊时的临床严重程度（两个分层）进行分层。设每个分层由一个 $2 \\times 2$ 表表示，对于分层 $k$，其单元格为 $(a_k, b_k, c_k, d_k)$，其中 $a_k$ 是暴露病例数， $b_k$ 是暴露非病例数， $c_k$ 是非暴露病例数， $d_k$ 是非暴露非病例数。任何表格中的比值比（OR）根据基本原理定义为比值的比率，即 $\\text{OR} = \\dfrac{a d}{b c}$，其中 $a$、$b$、$c$ 和 $d$ 是 $2 \\times 2$ 表中的单元格计数。粗比值比通过在形成相同比率之前将各分层的单元格计数相加来合并分层。以下数据在科学上是合理的，反映了一种情景，即暴露 $X$ 的分布随临床严重程度的差异而显著变化，这可能导致混杂。\n\n分层 $1$ (高严重程度):\n- 暴露病例 $a_1 = 500$\n- 暴露非病例 $b_1 = 500$\n- 非暴露病例 $c_1 = 30$\n- 非暴露非病例 $d_1 = 40$\n\n分层 $2$ (低严重程度):\n- 暴露病例 $a_2 = 4$\n- 暴露非病例 $b_2 = 57$\n- 非暴露病例 $c_2 = 200$\n- 非暴露非病例 $d_2 = 3800$\n\n仅使用比值和比值比的定义以及 $2 \\times 2$ 分层分析的标准属性，首先验证通过合并分层计算出的粗比值比高于两个层特异性比值比中的任何一个。然后，通过计算 Mantel–Haenszel (MH) 合并比值比来校正由临床严重程度引起的混杂，以获得跨分层的共同效应。\n\n请以单个精确的既约分数形式提供最终的 Mantel–Haenszel 合并比值比。不要四舍五入。",
            "solution": "该问题需要分三部分进行计算：\n1.  计算两个分层各自的层特异性比值比（$\\text{OR}_k$）。\n2.  通过合并分层计算粗比值比（$\\text{OR}_{\\text{crude}}$），并验证其大于两个层特异性比值比。\n3.  计算 Mantel-Haenszel (MH) 合并比值比（$\\text{OR}_{\\text{MH}}$），以获得校正后的关联度量。\n\n各分层由以下 $2 \\times 2$ 表定义，其中单元格为 $(a_k, b_k, c_k, d_k)$：\n- 分层 $k=1$ (高严重程度):\n  - $a_1 = 500$ (暴露病例)\n  - $b_1 = 500$ (暴露非病例)\n  - $c_1 = 30$ (非暴露病例)\n  - $d_1 = 40$ (非暴露非病例)\n- 分层 $k=2$ (低严重程度):\n  - $a_2 = 4$ (暴露病例)\n  - $b_2 = 57$ (暴露非病例)\n  - $c_2 = 200$ (非暴露病例)\n  - $d_2 = 3800$ (非暴露非病例)\n\n对于给定的 $2 \\times 2$ 表，比值比定义为 $\\text{OR} = \\frac{ad}{bc}$。\n\n**1. 层特异性比值比**\n\n对于分层 $1$：\n$$ \\text{OR}_1 = \\frac{a_1 d_1}{b_1 c_1} = \\frac{(500)(40)}{(500)(30)} = \\frac{40}{30} = \\frac{4}{3} $$\n\n对于分层 $2$：\n$$ \\text{OR}_2 = \\frac{a_2 d_2}{b_2 c_2} = \\frac{(4)(3800)}{(57)(200)} = \\frac{15200}{11400} = \\frac{152}{114} $$\n为了化简分数 $\\frac{152}{114}$，我们可以找到公因子。$152 = 4 \\times 38$ 且 $114 = 3 \\times 38$。\n$$ \\text{OR}_2 = \\frac{4 \\times 38}{3 \\times 38} = \\frac{4}{3} $$\n层特异性比值比是相同的：$\\text{OR}_1 = \\text{OR}_2 = \\frac{4}{3}$。这表明暴露的效应在不同临床严重程度的分层中是同质的（无效应修饰）。\n\n**2. 粗比值比与验证**\n\n为了计算粗比值比，我们首先通过将相应的单元格计数相加来合并分层：\n- 总暴露病例： $a = a_1 + a_2 = 500 + 4 = 504$\n- 总暴露非病例： $b = b_1 + b_2 = 500 + 57 = 557$\n- 总非暴露病例： $c = c_1 + c_2 = 30 + 200 = 230$\n- 总非暴露非病例： $d = d_1 + d_2 = 40 + 3800 = 3840$\n\n那么，粗比值比为：\n$$ \\text{OR}_{\\text{crude}} = \\frac{ad}{bc} = \\frac{(504)(3840)}{(557)(230)} = \\frac{1935360}{128110} = \\frac{193536}{12811} $$\n为了将其与层特异性比值比进行比较，我们可以近似其值：\n$$ \\text{OR}_{\\text{crude}} \\approx 15.107 $$\n$$ \\text{OR}_1 = \\text{OR}_2 = \\frac{4}{3} \\approx 1.333 $$\n显然，$\\text{OR}_{\\text{crude}}  \\text{OR}_1$ 且 $\\text{OR}_{\\text{crude}}  \\text{OR}_2$。粗比值比显著高估了在每个分层内发现的关联。这是一个混杂的经典例子，其中分层变量（临床严重程度）与暴露和结局均相关，在未进行适当校正时，会产生一个虚假的总体关联。\n\n**3. Mantel-Haenszel 合并比值比**\n\nMantel-Haenszel 公式提供了一个合并比值比，该比值比校正了分层变量。它是层特异性比值比的加权平均值。其公式为：\n$$ \\text{OR}_{\\text{MH}} = \\frac{\\sum_{k=1}^{2} \\frac{a_k d_k}{N_k}}{\\sum_{k=1}^{2} \\frac{b_k c_k}{N_k}} $$\n其中 $N_k = a_k + b_k + c_k + d_k$ 是分层 $k$ 中的总受试者数。\n\n首先，我们计算每个分层中的总受试者数：\n- $N_1 = 500 + 500 + 30 + 40 = 1070$\n- $N_2 = 4 + 57 + 200 + 3800 = 4061$\n\n现在，我们计算 $\\text{OR}_{\\text{MH}}$ 公式的分子和分母。\n分子：\n$$ \\sum_{k=1}^{2} \\frac{a_k d_k}{N_k} = \\frac{(500)(40)}{1070} + \\frac{(4)(3800)}{4061} = \\frac{20000}{1070} + \\frac{15200}{4061} $$\n\n分母：\n$$ \\sum_{k=1}^{2} \\frac{b_k c_k}{N_k} = \\frac{(500)(30)}{1070} + \\frac{(57)(200)}{4061} = \\frac{15000}{1070} + \\frac{11400}{4061} $$\n\n我们可以使用层特异性比值比 $\\text{OR}_k = \\frac{a_k d_k}{b_k c_k}$ 来重写分子项，这意味着 $a_k d_k = \\text{OR}_k \\cdot b_k c_k$。\n由于我们发现 $\\text{OR}_1 = \\text{OR}_2 = \\frac{4}{3}$，我们可以将 $\\text{OR}_k = \\frac{4}{3}$ 代入两个分层：\n$$ \\sum_{k=1}^{2} \\frac{a_k d_k}{N_k} = \\sum_{k=1}^{2} \\frac{\\left(\\frac{4}{3}\\right) b_k c_k}{N_k} = \\frac{4}{3} \\sum_{k=1}^{2} \\frac{b_k c_k}{N_k} $$\n现在我们可以将 Mantel-Haenszel 比值比表示为：\n$$ \\text{OR}_{\\text{MH}} = \\frac{\\frac{4}{3} \\sum_{k=1}^{2} \\frac{b_k c_k}{N_k}}{\\sum_{k=1}^{2} \\frac{b_k c_k}{N_k}} $$\n项 $\\sum_{k=1}^{2} \\frac{b_k c_k}{N_k}$ 是非负权重的非零和，因此可以从分子和分母中约去。\n$$ \\text{OR}_{\\text{MH}} = \\frac{4}{3} $$\n这一结果展示了 Mantel-Haenszel 估计量的一个关键性质：当所有分层的比值比恒定时（即无效应修饰），MH 合并比值比等于该共同比值比。该计算提供了校正后的共同比值比，它在考虑了临床严重程度的混杂效应后，正确地反映了关联。\n最终答案要求以精确的既约分数形式给出。",
            "answer": "$$\\boxed{\\frac{4}{3}}$$"
        },
        {
            "introduction": "Mantel-Haenszel方法的一个核心前提是，暴露与结局之间的关联强度（即优势比）在所有亚组（层）中是基本一致的，这被称为“同质性”。如果各层之间的效应大小差异悬殊（即存在交互作用），那么将它们强行合并成一个单一的数值就可能没有意义。本练习将教你如何使用Breslow-Day检验来评估这一关键假设，从而判断MH合并优势比是否是当前数据的恰当总结指标。",
            "id": "4809044",
            "problem": "一项多阶段随机临床试验按基线疾病分期进行分层，评估一种新的预防性疗法与标准护理相比，是否会增加肝脏不良事件的比值比。在每个分层中，患者被随机分配到治疗组（暴露组）或标准护理组（非暴露组），并在随访期间记录不良事件。分层由疾病的 I、II 和 III 期定义，在每个分层中，$2 \\times 2$ 表格中每个单元格的总数如下：\n\n- I 期：暴露组不良事件 $a_1 = 8$，暴露组无事件 $b_1 = 32$，非暴露组不良事件 $c_1 = 4$，非暴露组无事件 $d_1 = 36$。\n- II 期：暴露组不良事件 $a_2 = 12$，暴露组无事件 $b_2 = 28$，非暴露组不良事件 $c_2 = 8$，非暴露组无事件 $d_2 = 32$。\n- III 期：暴露组不良事件 $a_3 = 20$，暴露组无事件 $b_3 = 30$，非暴露组不良事件 $c_3 = 18$，非暴露组无事件 $d_3 = 32$。\n\n使用分层分析，通过 Mantel–Haenszel 方法估计各分层的共同比值比。然后，在各分层具有共同比值比的原假设下，使用 Breslow–Day 检验进行比值比的同质性检验，评估在显著性水平 $\\alpha = 0.05$ 下，共同比值比的假设是否合理。在你的推理中，将各分层视为独立的，并以各分层特定的边际为条件。\n\n将 Mantel–Haenszel 共同比值比作为你的最终数值答案，四舍五入至四位有效数字。最终答案以纯数字形式表示，不带任何单位。",
            "solution": "该问题要求使用 Mantel-Haenszel (MH) 方法估计三个分层的共同比值比，并使用 Breslow-Day (BD) 检验评估比值比的同质性。\n\n首先，我们为每个分层 $i$（其中 $i=1, 2, 3$）建立一个 $2 \\times 2$ 列联表的符号表示：\n- $a_i$：暴露组中发生不良事件的人数。\n- $b_i$：暴露组中未发生不良事件的人数。\n- $c_i$：非暴露组中发生不良事件的人数。\n- $d_i$：非暴露组中未发生不良事件的人数。\n- $N_i = a_i + b_i + c_i + d_i$：分层 $i$ 中的总人数。\n\n所提供的数据如下：\n- 分层 $1$：$a_1 = 8$, $b_1 = 32$, $c_1 = 4$, $d_1 = 36$。\n- 分层 $2$：$a_2 = 12$, $b_2 = 28$, $c_2 = 8$, $d_2 = 32$。\n- 分层 $3$：$a_3 = 20$, $b_3 = 30$, $c_3 = 18$, $d_3 = 32$。\n\n每个分层的总人数为：\n- $N_1 = 8 + 32 + 4 + 36 = 80$。\n- $N_2 = 12 + 28 + 8 + 32 = 80$。\n- $N_3 = 20 + 30 + 18 + 32 = 100$。\n\n主要目标是计算共同比值比的 Mantel-Haenszel 估计量 $\\widehat{\\text{OR}}_{\\text{MH}}$，其由以下公式给出：\n$$ \\widehat{\\text{OR}}_{\\text{MH}} = \\frac{\\sum_{i=1}^{k} \\frac{a_i d_i}{N_i}}{\\sum_{i=1}^{k} \\frac{b_i c_i}{N_i}} $$\n其中 $k=3$ 是分层的数量。\n\n我们为每个分层计算分子和分母的项：\n对于分层 1：\n- 分子项：$\\frac{a_1 d_1}{N_1} = \\frac{8 \\times 36}{80} = \\frac{288}{80} = 3.6$。\n- 分母项：$\\frac{b_1 c_1}{N_1} = \\frac{32 \\times 4}{80} = \\frac{128}{80} = 1.6$。\n\n对于分层 2：\n- 分子项：$\\frac{a_2 d_2}{N_2} = \\frac{12 \\times 32}{80} = \\frac{384}{80} = 4.8$。\n- 分母项：$\\frac{b_2 c_2}{N_2} = \\frac{28 \\times 8}{80} = \\frac{224}{80} = 2.8$。\n\n对于分层 3：\n- 分子项：$\\frac{a_3 d_3}{N_3} = \\frac{20 \\times 32}{100} = \\frac{640}{100} = 6.4$。\n- 分母项：$\\frac{b_3 c_3}{N_3} = \\frac{30 \\times 18}{100} = \\frac{540}{100} = 5.4$。\n\n现在，我们将这些项相加，以求得 $\\widehat{\\text{OR}}_{\\text{MH}}$ 的总分子和总分母：\n- 分子项之和：$\\sum_{i=1}^{3} \\frac{a_i d_i}{N_i} = 3.6 + 4.8 + 6.4 = 14.8$。\n- 分母项之和：$\\sum_{i=1}^{3} \\frac{b_i c_i}{N_i} = 1.6 + 2.8 + 5.4 = 9.8$。\n\nMantel-Haenszel 共同比值比为：\n$$ \\widehat{\\text{OR}}_{\\text{MH}} = \\frac{14.8}{9.8} \\approx 1.510204... $$\n\n问题的第二部分是使用 Breslow-Day 同质性检验来评估共同比值比假设的合理性。该检验的原假设是所有分层的比值比均相等：$H_0: \\text{OR}_1 = \\text{OR}_2 = \\text{OR}_3$。检验统计量由以下公式给出：\n$$ X^2_{\\text{BD}} = \\sum_{i=1}^{k} \\frac{[a_i - E(a_i | \\widehat{\\text{OR}}_{\\text{MH}})]^2}{\\text{Var}(a_i | \\widehat{\\text{OR}}_{\\text{MH}})} $$\n在 $H_0$ 下，该统计量服从自由度为 $k-1$ 的卡方分布。此处 $k=3$，所以我们有 $2$ 个自由度。\n\n为了计算这个统计量，我们需要在共同比值比 $\\psi = \\widehat{\\text{OR}}_{\\text{MH}} \\approx 1.5102$ 的假设下，计算每个分层中单元格计数 $a_i$ 的期望值 $E(a_i)$ 和方差 $\\text{Var}(a_i)$。期望值 $E(a_i)$ 是通过求解一个二次方程得到的，该方程源于给定表格固定边际总和的期望单元格计数的交叉乘积比。\n\n令 $E_i = E(a_i | \\widehat{\\text{OR}}_{\\text{MH}})$。对于每个分层 $i$，其边际总和为 $n_{1i} = a_i+b_i$、$n_{0i} = c_i+d_i$、$m_{1i} = a_i+c_i$ 和 $N_i$，$E_i$ 是以下二次方程的相关根：\n$$ (\\psi-1)x^2 - [(\\psi-1)(n_{1i}+m_{1i}) + N_i]x + \\psi n_{1i} m_{1i} = 0 $$\n然后方差计算如下：\n$$ \\text{Var}(a_i | \\widehat{\\text{OR}}_{\\text{MH}}) = \\left( \\frac{1}{E_i} + \\frac{1}{n_{1i}-E_i} + \\frac{1}{m_{1i}-E_i} + \\frac{1}{N_i-n_{1i}-m_{1i}+E_i} \\right)^{-1} $$\n\n我们使用 $\\psi = \\frac{14.8}{9.8} \\approx 1.5102$ 对每个分层进行计算：\n\n- 分层 1：$n_{11}=40, m_{11}=12, N_1=80$。求解 $E_1$ 得到 $E(a_1) \\approx 7.042$。这得出 $\\text{Var}(a_1) \\approx 2.484$。对统计量的贡献为 $\\frac{(8 - 7.042)^2}{2.484} \\approx 0.369$。\n\n- 分层 2：$n_{12}=40, m_{12}=20, N_2=80$。求解 $E_2$ 得到 $E(a_2) \\approx 11.536$。这得出 $\\text{Var}(a_2) \\approx 3.681$。对统计量的贡献为 $\\frac{(12 - 11.536)^2}{3.681} \\approx 0.058$。\n\n- 分层 3：$n_{13}=50, m_{13}=38, N_3=100$。求解 $E_3$ 得到 $E(a_3) \\approx 21.418$。这得出 $\\text{Var}(a_3) \\approx 5.817$。对统计量的贡献为 $\\frac{(20 - 21.418)^2}{5.817} \\approx 0.346$。\n\nBreslow-Day 检验统计量是这些贡献的总和：\n$$ X^2_{\\text{BD}} \\approx 0.369 + 0.058 + 0.346 = 0.773 $$\n我们将此值与在显著性水平 $\\alpha = 0.05$ 下、自由度为 $df = 3-1=2$ 的卡方分布的临界值进行比较。临界值为 $\\chi^2_{2, 0.05} = 5.991$。\n由于我们的检验统计量 $X^2_{\\text{BD}} \\approx 0.773$ 远小于临界值 $5.991$，我们不拒绝同质性的原假设。这表明数据与三个疾病分层具有共同比值比的假设是一致的。因此，使用 Mantel-Haenszel 共同比值比作为汇总度量是合适的。\n\n最终答案是 Mantel-Haenszel 共同比值比，四舍五入到四位有效数字。\n$$ \\widehat{\\text{OR}}_{\\text{MH}} = \\frac{14.8}{9.8} \\approx 1.510204...$$\n四舍五入到四位有效数字得到 $1.510$。",
            "answer": "$$\n\\boxed{1.510}\n$$"
        }
    ]
}