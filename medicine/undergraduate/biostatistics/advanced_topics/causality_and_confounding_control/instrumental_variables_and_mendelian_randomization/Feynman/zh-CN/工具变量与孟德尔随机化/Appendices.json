{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的动手实践，我们将首先推导孟德尔随机化研究中使用单个遗传变异作为工具变量时的基础估计量。这个练习将揭示如何通过计算两个可观测关联的比率——基因对结局的效应与基因对暴露的效应之比——来巧妙地还原因果效应。通过完成这个推导，你将深刻理解为何这个被称为Wald估计量的比率，能够成功地从混杂因素的影响中分离出因果参数。",
            "id": "4916926",
            "problem": "考虑一项孟德尔随机化（MR）研究，其中使用单个双等位基因变异作为工具变量。设工具变量为一个二元指示符 $Z \\in \\{0,1\\}$，表示风险等位基因的存在（$Z=1$）或不存在（$Z=0$），暴露 $X$ 为连续变量，结局 $Y$ 也为连续变量。假设以下线性结构关系和工具变量假设成立：\n- 暴露模型为 $X = \\gamma_{0} + \\gamma_{Z} Z + \\gamma_{U} U + \\varepsilon_{X}$。\n- 结局模型为 $Y = \\beta X + \\delta U + \\varepsilon_{Y}$。\n- 未观测到的混杂因素 $U$ 可能同时影响 $X$ 和 $Y$，但工具变量 $Z$ 与 $U$ 及误差项独立：$\\operatorname{Cov}(Z,U)=0$，$\\operatorname{Cov}(Z,\\varepsilon_{X})=0$，以及 $\\operatorname{Cov}(Z,\\varepsilon_{Y})=0$。\n- 排他性限制成立：$Z$ 仅通过 $X$ 影响 $Y$。\n- 工具变量相关性成立：$\\gamma_{Z} \\neq 0$。\n\n从工具变量的矩条件和协方差的定义出发，推导系数 $\\beta$ 的一个闭式表达式。该系数可以使用 $Z$ 作为工具变量进行识别，并且可以通过比较 $Z=1$ 与 $Z=0$ 时条件均值的差异，从观测数据中估计。您的最终表达式必须仅用 $z \\in \\{0,1\\}$ 的 $\\mathbb{E}[Y \\mid Z=z]$ 和 $\\mathbb{E}[X \\mid Z=z]$ 来表示。然后，根据您的推导，解释在此 MR 设置中，分子和分母分别量化了什么。仅提供最终表达式作为您的答案。无需四舍五入，也无需单位。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第1步：提取已知条件\n明确提供的信息如下：\n- **工具变量 (IV):** 一个二元指示符 $Z \\in \\{0,1\\}$。\n- **暴露:** 一个连续变量 $X$。\n- **结局:** 一个连续变量 $Y$。\n- **未观测到的混杂因素:** 一个变量 $U$。\n- **结构模型:**\n    - 暴露模型: $X = \\gamma_{0} + \\gamma_{Z} Z + \\gamma_{U} U + \\varepsilon_{X}$。\n    - 结局模型: $Y = \\beta X + \\delta U + \\varepsilon_{Y}$。\n- **IV 假设:**\n    1.  **独立性:** 工具变量 $Z$ 与混杂因素 $U$ 以及误差项 $\\varepsilon_{X}$ 和 $\\varepsilon_{Y}$ 独立。这被正式表述为 $\\operatorname{Cov}(Z,U)=0$，$\\operatorname{Cov}(Z,\\varepsilon_{X})=0$，以及 $\\operatorname{Cov}(Z,\\varepsilon_{Y})=0$。\n    2.  **排他性限制:** $Z$ 仅通过其对 $X$ 的影响来影响 $Y$。这一点已内含在结局模型中，因为 $Z$ 并未作为直接影响 $Y$ 的项出现。\n    3.  **工具变量相关性:** 工具变量与暴露相关，正式表述为 $\\gamma_{Z} \\neq 0$。\n\n### 第2步：使用已知条件进行验证\n根据所需标准对问题进行评估：\n- **科学基础:** 该问题提出了工具变量分析的一个经典范式，特别是在孟德尔随机化的生物统计学背景下。结构方程和三个核心IV假设是这一成熟方法论的基本原则。该设定在科学上是合理的。\n- **适定性:** 该问题要求推导因果参数 $\\beta$ 的一个闭式表达式。在给定一套完整的标准线性IV假设下，$\\beta$ 的唯一解是可识别的。该问题是适定的。\n- **客观性:** 该问题使用精确的数学和统计语言陈述，没有歧义或主观内容。\n\n该问题没有科学上不合理、不完整、矛盾或模棱两可等缺陷。这是生物统计学中一个标准的、可形式化的问题。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。现在将提供一个完整的、有理有据的解决方案。\n\n### 推导\n目标是使用工具变量 $Z$ 推导因果系数 $\\beta$ 的表达式。参数 $\\beta$ 代表暴露 $X$ 对结局 $Y$ 的因果效应。\n\n核心的工具变量矩条件指出，工具变量 $Z$ 必须与结局方程中的误差项不相关。结局模型被指定为 $Y = \\beta X + \\delta U + \\varepsilon_{Y}$。在 $Y$ 对 $X$ 的普通最小二乘回归中，误差项为 $\\eta = \\delta U + \\varepsilon_{Y}$。由于混杂因素 $U$ 的存在，且 $U$ 与 $X$ 相关，导致 $\\operatorname{Cov}(X, \\eta) \\neq 0$，从而使得 $\\beta$ 的OLS估计量产生偏倚。\n\nIV方法利用了这样一个事实：根据假设，工具变量 $Z$ 与 $\\eta$ 不相关。我们可以正式验证这一点：\n$$\n\\operatorname{Cov}(Z, \\eta) = \\operatorname{Cov}(Z, \\delta U + \\varepsilon_{Y}) = \\delta \\operatorname{Cov}(Z, U) + \\operatorname{Cov}(Z, \\varepsilon_{Y})\n$$\n根据给定的假设，$\\operatorname{Cov}(Z, U) = 0$ 且 $\\operatorname{Cov}(Z, \\varepsilon_{Y}) = 0$。因此，$\\operatorname{Cov}(Z, \\eta) = 0$。\n\n我们可以将结局模型重写为 $\\eta = Y - \\beta X$。因此，矩条件 $\\operatorname{Cov}(Z, \\eta) = 0$ 变为：\n$$\n\\operatorname{Cov}(Z, Y - \\beta X) = 0\n$$\n利用协方差算子的线性性质：\n$$\n\\operatorname{Cov}(Z, Y) - \\operatorname{Cov}(Z, \\beta X) = 0\n$$\n$$\n\\operatorname{Cov}(Z, Y) - \\beta \\operatorname{Cov}(Z, X) = 0\n$$\n在 $\\operatorname{Cov}(Z, X) \\neq 0$ 的条件下（我们将证明这等价于相关性假设 $\\gamma_{Z} \\neq 0$），求解 $\\beta$ 可得通用IV估计量：\n$$\n\\beta = \\frac{\\operatorname{Cov}(Z, Y)}{\\operatorname{Cov}(Z, X)}\n$$\n这个形式被称为Wald估计量。问题要求将此表达式重写为关于 $Z$ 的条件期望的形式。对于二元工具变量 $Z \\in \\{0, 1\\}$，协方差项具有一个特别简单的形式。\n\n我们来分析分母 $\\operatorname{Cov}(Z, X)$。我们可以使用全期望定律将协方差与条件均值的差异联系起来。\n从暴露模型 $X = \\gamma_{0} + \\gamma_{Z} Z + \\gamma_{U} U + \\varepsilon_{X}$ 出发，我们可以取以 $Z=z$ 为条件的期望：\n$$\n\\mathbb{E}[X \\mid Z=z] = \\mathbb{E}[\\gamma_{0} + \\gamma_{Z} z + \\gamma_{U} U + \\varepsilon_{X} \\mid Z=z]\n$$\n$$\n\\mathbb{E}[X \\mid Z=z] = \\gamma_{0} + \\gamma_{Z} z + \\gamma_{U} \\mathbb{E}[U \\mid Z=z] + \\mathbb{E}[\\varepsilon_{X} \\mid Z=z]\n$$\n根据独立性假设，$\\mathbb{E}[U \\mid Z=z] = \\mathbb{E}[U]$ 且 $\\mathbb{E}[\\varepsilon_{X} \\mid Z=z] = \\mathbb{E}[\\varepsilon_{X}]$。不失一般性地假设 $\\mathbb{E}[\\varepsilon_{X}] = 0$：\n$$\n\\mathbb{E}[X \\mid Z=z] = \\gamma_{0} + \\gamma_{Z} z + \\gamma_{U} \\mathbb{E}[U]\n$$\n现在，我们可以针对 $z=1$ 和 $z=0$ 对其求值：\n$$\n\\mathbb{E}[X \\mid Z=1] = \\gamma_{0} + \\gamma_{Z} + \\gamma_{U} \\mathbb{E}[U]\n$$\n$$\n\\mathbb{E}[X \\mid Z=0] = \\gamma_{0} + \\gamma_{U} \\mathbb{E}[U]\n$$\n这些条件均值之间的差异是：\n$$\n\\mathbb{E}[X \\mid Z=1] - \\mathbb{E}[X \\mid Z=0] = (\\gamma_{0} + \\gamma_{Z} + \\gamma_{U} \\mathbb{E}[U]) - (\\gamma_{0} + \\gamma_{U} \\mathbb{E}[U]) = \\gamma_{Z}\n$$\n两个基因型组之间平均暴露的差异量化了基因-暴露关联的强度，即 $\\gamma_{Z}$。由于假设了 $\\gamma_{Z} \\neq 0$，这个差异是非零的。这证实了 $\\operatorname{Cov}(Z, X) \\neq 0$。\n\n接下来，我们分析分子 $\\operatorname{Cov}(Z, Y)$。我们首先将 $X$ 的模型代入 $Y$ 的模型，以将 $Y$ 表示为 $Z$ 和误差项的函数：\n$$\nY = \\beta(\\gamma_{0} + \\gamma_{Z} Z + \\gamma_{U} U + \\varepsilon_{X}) + \\delta U + \\varepsilon_{Y}\n$$\n$$\nY = \\beta\\gamma_{0} + \\beta\\gamma_{Z} Z + (\\beta\\gamma_{U} + \\delta)U + \\beta\\varepsilon_{X} + \\varepsilon_{Y}\n$$\n取 $Y$ 在 $Z=z$ 条件下的期望：\n$$\n\\mathbb{E}[Y \\mid Z=z] = \\mathbb{E}[\\beta\\gamma_{0} + \\beta\\gamma_{Z} z + (\\beta\\gamma_{U} + \\delta)U + \\beta\\varepsilon_{X} + \\varepsilon_{Y} \\mid Z=z]\n$$\n使用独立性假设，并假设 $\\mathbb{E}[\\varepsilon_{X}] = 0$ 和 $\\mathbb{E}[\\varepsilon_{Y}] = 0$：\n$$\n\\mathbb{E}[Y \\mid Z=z] = \\beta\\gamma_{0} + \\beta\\gamma_{Z} z + (\\beta\\gamma_{U} + \\delta)\\mathbb{E}[U]\n$$\n对 $z=1$ 和 $z=0$ 进行求值：\n$$\n\\mathbb{E}[Y \\mid Z=1] = \\beta\\gamma_{0} + \\beta\\gamma_{Z} + (\\beta\\gamma_{U} + \\delta)\\mathbb{E}[U]\n$$\n$$\n\\mathbb{E}[Y \\mid Z=0] = \\beta\\gamma_{0} + (\\beta\\gamma_{U} + \\delta)\\mathbb{E}[U]\n$$\n这些条件均值之间的差异是：\n$$\n\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0] = (\\beta\\gamma_{0} + \\beta\\gamma_{Z} + (\\beta\\gamma_{U} + \\delta)\\mathbb{E}[U]) - (\\beta\\gamma_{0} + (\\beta\\gamma_{U} + \\delta)\\mathbb{E}[U]) = \\beta\\gamma_{Z}\n$$\n两个基因型组之间平均结局的这种差异量化了基因-结局关联。\n\n我们现在有两个结果：\n1.  $\\mathbb{E}[X \\mid Z=1] - \\mathbb{E}[X \\mid Z=0] = \\gamma_{Z}$\n2.  $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0] = \\beta\\gamma_{Z}$\n\n将这些结果代入Wald估计量形式 $\\beta = \\frac{\\beta\\gamma_{Z}}{\\gamma_{Z}}$，得到最终表达式：\n$$\n\\beta = \\frac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[X \\mid Z=1] - \\mathbb{E}[X \\mid Z=0]}\n$$\n通过用样本均值类似物替换总体条件期望，该表达式可以从观测数据中估计出来。\n\n### 分子与分母的解释\n- **分母:** 项 $\\mathbb{E}[X \\mid Z=1] - \\mathbb{E}[X \\mid Z=0]$ 代表携带风险等位基因（$Z=1$）的个体与不携带（$Z=0$）的个体之间暴露 $X$ 的平均差异。在孟德尔随机化背景下，它代表了“基因-暴露”关联的强度，量化了遗传工具变量对暴露水平的扰动程度。\n- **分子:** 项 $\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]$ 代表携带风险等位基因的个体与不携带的个体之间结局 $Y$ 的平均差异。这是“基因-结局”关联。由于排他性限制，基因对结局的任何影响都必须通过暴露来介导。因此，这一差异反映了基因对暴露的初始效应在结局上的下游结果。\n\n因此，因果效应 $\\beta$ 被识别为基因-结局关联与基因-暴露关联的比值。通过将基因对结局的总效应除以基因对暴露的总效应，这种方法巧妙地消除了混杂。",
            "answer": "$$\n\\boxed{\\frac{\\mathbb{E}[Y \\mid Z=1] - \\mathbb{E}[Y \\mid Z=0]}{\\mathbb{E}[X \\mid Z=1] - \\mathbb{E}[X \\mid Z=0]}}\n$$"
        },
        {
            "introduction": "这个练习题将抽象的理论公式具体化。通过代入简单的数值，你将亲眼看到在一个简化但貼近真实世界的情境中，因果效应的估计值是如何被计算出来的。这个练习为你搭建了一座从抽象方程到数据分析的桥梁。",
            "id": "4966574",
            "problem": "一名研究者进行了一项单样本孟德尔随机化 (MR) 研究，以估计连续暴露 $X$ 对连续结局 $Y$ 的因果效应，其中使用一个二元遗传变异 $Z \\in \\{0,1\\}$ 作为工具变量 (IV)。遗传变异 $Z$ 的编码方式为：$Z=1$ 表示效应等位基因的携带者，$Z=0$ 表示非携带者。假设在潜在人群中，以下标准 IV 假设成立：工具变量相关性（$Z$ 与 $X$ 相关），工具变量独立性（$Z$ 与 $X$ 和 $Y$ 的所有未测量混杂因素无关），以及排他性限制（$Z$ 对 $Y$ 的效应仅通过 $X$ 发挥作用，没有直接路径）。同时假设单调性（不存在 $Z$ 增加会导致 $X$ 减少的个体），因此估计量对应于依从者中的局部平均处理效应。$X$ 和 $Y$ 均在标准化的对数尺度上测量（无量纲），因此任何因果效应都是无量纲的。\n\n给定按 $Z$ 分层的 $X$ 和 $Y$ 的样本均值：\n$$\\bar{Y}_{1}=6,\\quad \\bar{Y}_{0}=4,\\quad \\bar{X}_{1}=3,\\quad \\bar{X}_{0}=2.$$\n仅使用所述假设以及因果效应和工具变量的基本定义，推导一个依赖于按 $Z$ 分组的组均值差异的 $X$ 对 $Y$ 因果效应的估计器，并根据所提供的数据计算其数值 $\\hat{\\beta}_{W}$。在所述 IV 假设和单调性条件下，说明该估计值作为因果效应的解释。提供确切的数值，不要四舍五入。",
            "solution": "该问题要求在一个孟德尔随机化 (MR) 背景下，使用一个二元遗传变异 $Z$ 作为工具变量 (IV)，推导并计算连续暴露 $X$ 对连续结局 $Y$ 的因果效应的估计器。所提供的数据包括按工具变量 $Z$ 分层的 $X$ 和 $Y$ 的样本均值。\n\n令 $\\beta_{XY}$ 表示 $X$ 对 $Y$ 的因果效应。观察性研究中的核心挑战是，由于未测量的混杂，对 $Y$ 和 $X$ 进行简单回归可能会得到 $\\beta_{XY}$ 的有偏估计。一个工具变量 $Z$ 允许在一系列假设下识别该因果效应。给定的标准 IV 假设如下：\n1.  **相关性**：$Z$ 与 $X$ 相关。形式上，$\\text{Cov}(Z, X) \\neq 0$。\n2.  **独立性（可交换性）**：$Z$ 与任何同时影响 $X$ 和 $Y$ 的未测量混杂因素 $U$ 无关。形式上，$\\text{Cov}(Z, U) = 0$。\n3.  **排他性限制**：$Z$ 仅通过其对 $X$ 的效应来影响 $Y$。不存在从 $Z$ 到 $Y$ 的直接因果路径。\n\n让我们考虑因果关系。工具变量 $Z$ 对结局 $Y$ 的总效应可以分解为 $Z$ 对暴露 $X$ 的效应，继而是 $X$ 对 $Y$ 的效应。这是排他性限制假设的结果。\n\n在一个简化的线性框架中，我们可以如下表示这些关系。工具变量 $Z$ 对暴露 $X$ 的效应由以 $Z$ 为条件的 $X$ 的期望值之差给出。让我们将 $Z$ 对 $X$ 的群体平均效应表示为 $\\Delta_X$。\n$$ \\Delta_X = E[X | Z=1] - E[X | Z=0] $$\n类似地，工具变量 $Z$ 对结局 $Y$ 的效应由以 $Z$ 为条件的 $Y$ 的期望值之差给出。让我们将这个群体平均效应表示为 $\\Delta_Y$。\n$$ \\Delta_Y = E[Y | Z=1] - E[Y | Z=0] $$\n排他性限制假设意味着 $Z$ 对 $Y$ 的全部效应都是通过 $X$ 来中介的。因此，总效应 $\\Delta_Y$ 可以表示为 $Z$ 对 $X$ 的效应与 $X$ 对 $Y$ 的因果效应（我们用 $\\beta_{XY}$ 表示）的乘积。\n$$ \\Delta_Y = \\beta_{XY} \\times \\Delta_X $$\n这个关系是 IV 估计器的基础。相关性假设确保了 $\\Delta_X \\neq 0$，这是求解 $\\beta_{XY}$ 所必需的。独立性假设确保了 $Z$ 和 $Y$ 之间的关系不受混杂因素影响，从而使 $\\Delta_Y$ 成为衡量 $Z$ 对 $Y$ 总效应的有效指标。\n\n从上面的方程中，我们可以通过代数方法分离出因果效应 $\\beta_{XY}$：\n$$ \\beta_{XY} = \\frac{\\Delta_Y}{\\Delta_X} = \\frac{E[Y | Z=1] - E[Y | Z=0]}{E[X | Z=1] - E[X | Z=0]} $$\n在 IV 假设下，这个比率是因果效应的理论表达式。在现实世界的研究中，我们无法获知真实的群体期望值 ($E[\\cdot]$)。相反，我们拥有的是样本估计值。我们可以通过用样本均值替代群体期望值来构建 $\\beta_{XY}$ 的一个估计器。这种基于均值差异之比的特定形式的 IV 估计器被称为 Wald 估计器。\n\n令 $\\bar{Y}_{z}$ 和 $\\bar{X}_{z}$ 分别为工具变量取值为 $z \\in \\{0, 1\\}$ 的组中 $Y$ 和 $X$ 的样本均值。问题中表示为 $\\hat{\\beta}_{W}$ 的 $\\beta_{XY}$ 的估计器由下式给出：\n$$ \\hat{\\beta}_{W} = \\frac{\\bar{Y}_{1} - \\bar{Y}_{0}}{\\bar{X}_{1} - \\bar{X}_{0}} $$\n在 IV 假设成立的条件下，该估计器是因果效应 $\\beta_{XY}$ 的一个一致估计量。\n\n我们被给予了以下样本均值：\n- $\\bar{Y}_{1} = 6$（效应等位基因携带者，$Z=1$ 的平均结局）\n- $\\bar{Y}_{0} = 4$（非携带者，$Z=0$ 的平均结局）\n- $\\bar{X}_{1} = 3$（携带者，$Z=1$ 的平均暴露）\n- $\\bar{X}_{0} = 2$（非携带者，$Z=0$ 的平均暴露）\n\n首先，我们可以计算结局 $Y$ 的均值差异的样本估计值：\n$$ \\Delta\\bar{Y} = \\bar{Y}_{1} - \\bar{Y}_{0} = 6 - 4 = 2 $$\n接下来，我们计算暴露 $X$ 的均值差异的样本估计值：\n$$ \\Delta\\bar{X} = \\bar{X}_{1} - \\bar{X}_{0} = 3 - 2 = 1 $$\n$\\Delta\\bar{X}$ 的非零值 ($1 \\neq 0$) 提供了来自样本的经验证据，表明工具变量相关性假设成立。\n\n现在，我们可以计算 Wald 估计器 $\\hat{\\beta}_{W}$ 的数值：\n$$ \\hat{\\beta}_{W} = \\frac{\\Delta\\bar{Y}}{\\Delta\\bar{X}} = \\frac{2}{1} = 2 $$\n\n问题还要求对该估计值进行解释。加上单调性假设（即工具变量 $Z$ 不会使任何个体的暴露 $X$ 减少），该估计器提供了局部平均处理效应 (LATE) 的一个估计。LATE 是特指在“依从者”亚群中，暴露对结局的平均因果效应。在此背景下，依从者是指其暴露水平 $X$ 受遗传变异 $Z$ 影响且方向符合预期的个体（即，如果他们是效应等位基因的携带者 $Z=1$，他们的 $X$ 值会比他们是非携带者 $Z=0$ 时更高）。因此，$\\hat{\\beta}_{W} = 2$ 被解释为：对于那些其暴露水平对遗传工具 $Z$ 敏感的个体，暴露 $X$ 每增加 1 个单位对结局 $Y$ 的估计平均因果效应为 2。由于 $X$ 和 $Y$ 均在标准化的对数尺度上，这对应于在依从者中，对数转换后的暴露每增加 1 个单位，对数转换后的结局增加 2 个单位。",
            "answer": "$$\n\\boxed{2}\n$$"
        },
        {
            "introduction": "一个有效的工具变量必须与所研究的暴露有很强的关联。这个练习将指导你推导第一阶段的F统计量，这是一个用于评估“工具变量相关性”假设的关键诊断工具。理解该统计量对于批判性地评估任何孟德尔随机化研究的可靠性都至关重要。",
            "id": "4916953",
            "problem": "考虑一项孟德尔随机化（MR）研究，其中单个遗传变异 $Z$ 被用作暴露 $X$ 的工具变量（IV）。假设对于个体 $i = 1, \\dots, n$，存在第一阶段线性模型 $X_{i} = \\pi Z_{i} + V_{i}$，其中 $X$ 和 $Z$ 都已进行均值中心化，因此不需要截距项。您将从普通最小二乘法和经典平方和分解的基本定义出发，推导用于检验原假设 $H_{0}: \\pi = 0$ 的第一阶段 $F$ 统计量。\n\n数据集摘要如下：\n- 样本量 $n = 1000$。\n- $\\sum_{i=1}^{n} Z_{i}^{2} = 1000$。\n- $\\sum_{i=1}^{n} X_{i}^{2} = 1000$。\n- $\\sum_{i=1}^{n} Z_{i} X_{i} = 210$。\n\n从最小二乘估计量和残差平方和的定义开始，推导在这个单回归变量、无截距的回归模型中检验 $H_{0}: \\pi = 0$ 的第一阶段 $F$ 统计量，并解释它如何反映工具变量的强度，以及它与两阶段最小二乘估计量相对于普通最小二乘估计量的近似偏倚之间的联系。\n\n使用提供的数据集摘要计算 $F$ 统计量的数值，并将最终答案四舍五入至四位有效数字。无需单位。",
            "solution": "用户提供了一个有效的生物统计学问题。\n\n该问题要求在孟德尔随机化（MR）背景下推导第一阶段 $F$ 统计量，解释其含义，并根据提供的摘要统计数据进行数值计算。该模型是一个无截距的简单线性回归，我们需要检验单个预测变量的显著性。\n\n### 第1步：推导F统计量\n\n指定模型为MR研究的第一阶段回归：\n$$X_{i} = \\pi Z_{i} + V_{i}$$\n其中 $i = 1, \\dots, n$。变量 $X$（暴露）和 $Z$（工具变量）已进行均值中心化，因此不需要截距项。待检验的原假设为 $H_{0}: \\pi = 0$。\n\n普通最小二乘（OLS）估计量 $\\hat{\\pi}$ 通过最小化残差平方和（RSS）得到：\n$$RSS = \\sum_{i=1}^{n} (X_{i} - \\pi Z_{i})^{2}$$\n为求最小值，我们对 $\\pi$ 求导并令其为零：\n$$\\frac{d(RSS)}{d\\pi} = \\sum_{i=1}^{n} 2(X_{i} - \\pi Z_{i})(-Z_{i}) = -2 \\left( \\sum_{i=1}^{n} X_{i}Z_{i} - \\pi \\sum_{i=1}^{n} Z_{i}^{2} \\right) = 0$$\n解出 $\\pi$ 得到 OLS 估计量 $\\hat{\\pi}$：\n$$\\hat{\\pi} \\sum_{i=1}^{n} Z_{i}^{2} = \\sum_{i=1}^{n} X_{i}Z_{i} \\implies \\hat{\\pi} = \\frac{\\sum_{i=1}^{n} X_{i}Z_{i}}{\\sum_{i=1}^{n} Z_{i}^{2}}$$\n$F$ 统计量是均方之比。对于回归模型，它是回归均方（MSR）与误差均方（MSE）之比。\n$$F = \\frac{\\text{MSR}}{\\text{MSE}} = \\frac{\\text{ESS}/k}{\\text{RSS}/(n-k)}$$\n这里，预测变量的数量为 $k=1$。回归的自由度为 $k=1$，残差的自由度为 $n-k = n-1$。\n\n均值中心化变量 $X$ 的总平方和（TSS）为 $\\sum_{i=1}^{n} X_{i}^{2}$。这可以分解为解释平方和（ESS）和残差平方和（RSS）。\n$$TSS = ESS + RSS \\implies \\sum_{i=1}^{n} X_{i}^{2} = ESS + RSS$$\nESS 是预测值 $\\hat{X}_{i} = \\hat{\\pi}Z_{i}$ 的平方和：\n$$ESS = \\sum_{i=1}^{n} \\hat{X}_{i}^{2} = \\sum_{i=1}^{n} (\\hat{\\pi}Z_{i})^{2} = \\hat{\\pi}^{2} \\sum_{i=1}^{n} Z_{i}^{2}$$\n代入 $\\hat{\\pi}$ 的表达式：\n$$ESS = \\left( \\frac{\\sum_{i=1}^{n} X_{i}Z_{i}}{\\sum_{i=1}^{n} Z_{i}^{2}} \\right)^{2} \\sum_{i=1}^{n} Z_{i}^{2} = \\frac{\\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}{\\sum_{i=1}^{n} Z_{i}^{2}}$$\nRSS 是总变异中未被模型解释的部分：\n$$RSS = TSS - ESS = \\sum_{i=1}^{n} X_{i}^{2} - \\frac{\\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}{\\sum_{i=1}^{n} Z_{i}^{2}}$$\n现在，我们可以构建 $F$ 统计量：\n$$F = \\frac{ESS/1}{RSS/(n-1)} = \\frac{ESS \\cdot (n-1)}{RSS}$$\n代入 ESS 和 RSS 的表达式：\n$$F = \\frac{\\frac{\\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}{\\sum_{i=1}^{n} Z_{i}^{2}} \\cdot (n-1)}{\\sum_{i=1}^{n} X_{i}^{2} - \\frac{\\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}{\\sum_{i=1}^{n} Z_{i}^{2}}}$$\n为简化，分子和分母同乘以 $\\sum_{i=1}^{n} Z_{i}^{2}$：\n$$F = \\frac{(n-1) \\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}{\\left(\\sum_{i=1}^{n} X_{i}^{2}\\right) \\left(\\sum_{i=1}^{n} Z_{i}^{2}\\right) - \\left( \\sum_{i=1}^{n} X_{i}Z_{i} \\right)^{2}}$$\n这就是推导出的第一阶段 $F$ 统计量的表达式。\n\n### 第2步：解释及其与2SLS偏倚的联系\n\n$F$ 统计量用于检验原假设 $H_{0}: \\pi=0$。较大的 $F$ 值会导致拒绝 $H_{0}$，表明工具变量 $Z$ 是暴露 $X$ 的一个统计上显著的预测变量。这对应于工具变量的“相关性”或“强度”假设。如果这种关联不强，则该工具变量被认为是“弱”的，通常通过较小的第一阶段 $F$ 统计量来诊断（一个常见的经验法则是 $F  10$）。\n\n弱工具变量在两阶段最小二乘法（2SLS）估计中会造成严重问题。在第二阶段模型 $Y = \\beta X + U$ 中，用于估计因果效应 $\\beta$ 的传统 2SLS 估计量在有限样本中是有偏的。这种偏倚的大小与工具变量的强度有关。Staiger 和 Stock (1997) 表明，2SLS 估计量的近似偏倚 $E[\\hat{\\beta}_{2SLS}] - \\beta$ 与 OLS 估计量的偏倚 $E[\\hat{\\beta}_{OLS}] - \\beta$ 通过总体 $F$ 统计量相关联。一个常见的近似是：\n$$ E[\\hat{\\beta}_{2SLS}] - \\beta \\approx \\frac{E[\\hat{\\beta}_{OLS}] - \\beta}{E[F]}$$\n这揭示了 2SLS 估计量的偏倚与第一阶段 $F$ 统计量的期望值成反比。当工具变量较弱时，$F$ 值较小，2SLS 估计量的偏倚可能很大，接近 OLS 估计量的偏倚。相反，强工具变量（大 $F$ 值）会导致分母很大，从而显著减少 2SLS 估计量相对于 OLS 的偏倚。因此，第一阶段 $F$ 统计量是评估 MR 分析可靠性的关键诊断指标，因为它直接量化了弱工具变量偏倚问题的严重程度。\n\n### 第3步：数值计算\n\n我们使用推导出的公式和提供的摘要统计数据：\n- $n = 1000$\n- $\\sum_{i=1}^{n} Z_{i}^{2} = 1000$\n- $\\sum_{i=1}^{n} X_{i}^{2} = 1000$\n- $\\sum_{i=1}^{n} Z_{i} X_{i} = 210$\n\n将这些值代入 $F$ 统计量的公式中：\n$$F = \\frac{(n-1) \\left( \\sum Z_{i} X_{i} \\right)^{2}}{(\\sum X_{i}^{2})(\\sum Z_{i}^{2}) - (\\sum Z_{i} X_{i})^{2}}$$\n$$F = \\frac{(1000-1) (210)^{2}}{(1000)(1000) - (210)^{2}}$$\n$$F = \\frac{999 \\times 44100}{1000000 - 44100}$$\n$$F = \\frac{44055900}{955900}$$\n$$F = \\frac{440559}{9559} \\approx 46.08829375$$\n四舍五入到四位有效数字，我们得到 $F = 46.09$。该值远大于 10，表明在此数据集中，遗传变异 $Z$ 是暴露 $X$ 的一个强工具变量。",
            "answer": "$$\n\\boxed{46.09}\n$$"
        }
    ]
}