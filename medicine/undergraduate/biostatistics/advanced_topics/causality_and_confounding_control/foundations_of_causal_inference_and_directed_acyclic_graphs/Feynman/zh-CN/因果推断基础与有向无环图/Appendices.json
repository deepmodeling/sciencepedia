{
    "hands_on_practices": [
        {
            "introduction": "混杂是观察性研究中的一个核心挑战，它可能严重扭曲我们对因果关系的理解，甚至导致“辛普森悖论”这种违反直觉的现象。本练习  将通过一个具体的数值案例，让你亲手揭示悖论的产生过程，并运用后门准则进行调整，从而消除混杂偏倚，计算出真实的因果效应。",
            "id": "4912904",
            "problem": "考虑一个生物统计因果模型，其中包含三个二元变量：一个暴露前协变量 $Z \\in \\{0,1\\}$、一个处理 $X \\in \\{0,1\\}$ 和一个结果 $Y \\in \\{0,1\\}$。其因果结构由一个有向无环图 (DAG) 表示，具体为一个包含箭头 $Z \\to X$、$Z \\to Y$ 和 $X \\to Y$ 的有向无环图 (DAG)。假设数据生成机制如下：\n- $P(Z=1) = 0.5$ 且 $P(Z=0) = 0.5$。\n- $P(X=1 \\mid Z=0) = 0.9$ 且 $P(X=1 \\mid Z=1) = 0.1$。\n- $P(Y=1 \\mid X=1, Z=0) = 0.2$，$P(Y=1 \\mid X=0, Z=0) = 0.1$。\n- $P(Y=1 \\mid X=1, Z=1) = 0.6$，$P(Y=1 \\mid X=0, Z=1) = 0.5$。\n\n任务：\n1) 证明边际关联 $\\mathbb{E}[Y \\mid X=1] - \\mathbb{E}[Y \\mid X=0]$ 与每个分层特异性关联 $\\mathbb{E}[Y \\mid X=1, Z=z] - \\mathbb{E}[Y \\mid X=0, Z=z]$（对于 $z \\in \\{0,1\\}$）的符号相反。\n\n2) 使用后门准则，将 $Z$ 作为容许调整集，计算定义为 $\\mathbb{E}[Y_1] - \\mathbb{E}[Y_0]$ 的平均因果效应，其中 $Y_x$ 表示将 $X$ 设置为 $x$ 的干预下的潜在结果。请将最终答案以单个数字的形式给出；无需四舍五入。",
            "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n- 变量：暴露前协变量 $Z \\in \\{0,1\\}$，处理 $X \\in \\{0,1\\}$，结果 $Y \\in \\{0,1\\}$。\n- 因果结构 (DAG)：箭头 $Z \\to X$、$Z \\to Y$ 和 $X \\to Y$。\n- 概率：\n  - $P(Z=1) = 0.5$，$P(Z=0) = 0.5$。\n  - $P(X=1 \\mid Z=0) = 0.9$，$P(X=1 \\mid Z=1) = 0.1$。\n  - $P(Y=1 \\mid X=1, Z=0) = 0.2$，$P(Y=1 \\mid X=0, Z=0) = 0.1$。\n  - $P(Y=1 \\mid X=1, Z=1) = 0.6$，$P(Y=1 \\mid X=0, Z=1) = 0.5$。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学上成立**：该问题使用了因果推断中的标准概念，特别是有向无环图 (DAG)、潜在结果、后门准则和辛普森悖论。这些是生物统计学和流行病学中的基本课题。指定的 DAG 代表了一个典型的混杂结构。该问题是一个形式良好的教科书练习题。\n- **适定的**：所有必要的概率和条件都已提供，足以计算所需的量。问题明确，且导向一个唯一的、稳定的解。\n- **客观的**：问题以精确、客观的数学语言陈述。\n- **结论**：问题在科学上合理、完整、一致且适定。未发现任何缺陷。\n\n**步骤 3：判定与行动**\n问题有效。下面提供完整的解答。\n\n解答分为两部分，对应问题陈述中的两个任务。对于像 $Y$ 这样的二元结果变量，条件期望等同于条件概率：$\\mathbb{E}[Y \\mid A] = P(Y=1 \\mid A)$。\n\n**任务 1：辛普森悖论的论证**\n\n首先，我们计算 $z \\in \\{0,1\\}$ 的分层特异性关联。\n对于 $Z=0$ 的分层，关联为：\n$$\n\\mathbb{E}[Y \\mid X=1, Z=0] - \\mathbb{E}[Y \\mid X=0, Z=0] = P(Y=1 \\mid X=1, Z=0) - P(Y=1 \\mid X=0, Z=0)\n$$\n$$\n= 0.2 - 0.1 = 0.1\n$$\n对于 $Z=1$ 的分层，关联为：\n$$\n\\mathbb{E}[Y \\mid X=1, Z=1] - \\mathbb{E}[Y \\mid X=0, Z=1] = P(Y=1 \\mid X=1, Z=1) - P(Y=1 \\mid X=0, Z=1)\n$$\n$$\n= 0.6 - 0.5 = 0.1\n$$\n在两个分层中，$X$ 和 $Y$ 之间的关联都是正的，其值为 $0.1$。\n\n接下来，我们计算边际关联 $\\mathbb{E}[Y \\mid X=1] - \\mathbb{E}[Y \\mid X=0]$。为此，我们必须首先通过对 $Z$ 进行边际化来计算边际期望 $\\mathbb{E}[Y \\mid X=1]$ 和 $\\mathbb{E}[Y \\mid X=0]$。\n$$\nP(Y=1 \\mid X=x) = \\sum_{z \\in \\{0,1\\}} P(Y=1 \\mid X=x, Z=z) P(Z=z \\mid X=x)\n$$\n我们需要后验概率 $P(Z=z \\mid X=x)$，这可以通过贝叶斯法则求得：\n$$\nP(Z=z \\mid X=x) = \\frac{P(X=x \\mid Z=z)P(Z=z)}{P(X=x)}\n$$\n首先，我们求出 $X$ 的边际概率。\n$$\nP(X=1) = \\sum_{z \\in \\{0,1\\}} P(X=1 \\mid Z=z) P(Z=z) = P(X=1 \\mid Z=0)P(Z=0) + P(X=1 \\mid Z=1)P(Z=1)\n$$\n$$\nP(X=1) = (0.9)(0.5) + (0.1)(0.5) = 0.45 + 0.05 = 0.5\n$$\n因此，$P(X=0) = 1 - P(X=1) = 1 - 0.5 = 0.5$。\n\n现在我们可以计算后验概率：\n$$\nP(Z=0 \\mid X=1) = \\frac{P(X=1 \\mid Z=0)P(Z=0)}{P(X=1)} = \\frac{(0.9)(0.5)}{0.5} = 0.9\n$$\n$$\nP(Z=1 \\mid X=1) = \\frac{P(X=1 \\mid Z=1)P(Z=1)}{P(X=1)} = \\frac{(0.1)(0.5)}{0.5} = 0.1\n$$\n$$\nP(Z=0 \\mid X=0) = \\frac{P(X=0 \\mid Z=0)P(Z=0)}{P(X=0)} = \\frac{(1 - 0.9)(0.5)}{0.5} = 0.1\n$$\n$$\nP(Z=1 \\mid X=0) = \\frac{P(X=0 \\mid Z=1)P(Z=1)}{P(X=0)} = \\frac{(1 - 0.1)(0.5)}{0.5} = 0.9\n$$\n我们现在可以计算 $Y$ 的边际期望。\n$$\n\\mathbb{E}[Y \\mid X=1] = P(Y=1 \\mid X=1) = P(Y=1 \\mid X=1, Z=0)P(Z=0 \\mid X=1) + P(Y=1 \\mid X=1, Z=1)P(Z=1 \\mid X=1)\n$$\n$$\n= (0.2)(0.9) + (0.6)(0.1) = 0.18 + 0.06 = 0.24\n$$\n$$\n\\mathbb{E}[Y \\mid X=0] = P(Y=1 \\mid X=0) = P(Y=1 \\mid X=0, Z=0)P(Z=0 \\mid X=0) + P(Y=1 \\mid X=0, Z=1)P(Z=1 \\mid X=0)\n$$\n$$\n= (0.1)(0.1) + (0.5)(0.9) = 0.01 + 0.45 = 0.46\n$$\n因此，边际关联为：\n$$\n\\mathbb{E}[Y \\mid X=1] - \\mathbb{E}[Y \\mid X=0] = 0.24 - 0.46 = -0.22\n$$\n分层特异性关联均为正值 ($+0.1$)，而边际关联为负值 ($-0.22$)。这表明边际关联与每个分层特异性关联的符号相反，这种现象被称为辛普森悖论。\n\n**任务 2：计算平均因果效应 (ACE)**\n\n为了计算平均因果效应 $\\text{ACE} = \\mathbb{E}[Y_1] - \\mathbb{E}[Y_0]$，我们使用后门准则。该 DAG 为 $Z \\to X$、$Z \\to Y$、$X \\to Y$。路径 $X \\leftarrow Z \\to Y$ 是从 $X$ 到 $Y$ 的一条后门路径，因为它包含一个指向 $X$ 的箭头。变量 $Z$ 位于这条路径上。要使用 $Z$ 作为调整集，它必须满足两个条件：\n1. $\\{Z\\}$ 中没有节点是 $X$ 的后代。这是正确的，因为没有从 $X$ 到 $Z$ 的路径。\n2. 集合 $\\{Z\\}$ 阻断了所有从 $X$ 到 $Y$ 的后门路径。唯一的后门路径是 $X \\leftarrow Z \\to Y$，对 $Z$ 进行条件化可以阻断该路径。\n由于两个条件都满足，$\\{Z\\}$ 是一个容许调整集。\n\nACE 的后门调整公式为：\n$$\n\\text{ACE} = \\mathbb{E}[Y_1] - \\mathbb{E}[Y_0] = \\sum_{z \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=1, Z=z]P(Z=z) - \\sum_{z \\in \\{0,1\\}} \\mathbb{E}[Y \\mid X=0, Z=z]P(Z=z)\n$$\n这可以重写为分层特异性效应的加权平均值：\n$$\n\\text{ACE} = \\sum_{z \\in \\{0,1\\}} \\left( \\mathbb{E}[Y \\mid X=1, Z=z] - \\mathbb{E}[Y \\mid X=0, Z=z] \\right) P(Z=z)\n$$\n我们已知概率 $P(Z=0)=0.5$ 和 $P(Z=1)=0.5$。分层特异性效应已在任务 1 中计算。\n$$\n\\text{ACE} = (P(Y=1 \\mid X=1, Z=0) - P(Y=1 \\mid X=0, Z=0))P(Z=0) + (P(Y=1 \\mid X=1, Z=1) - P(Y=1 \\mid X=0, Z=1))P(Z=1)\n$$\n$$\n\\text{ACE} = (0.2 - 0.1)(0.5) + (0.6 - 0.5)(0.5)\n$$\n$$\n\\text{ACE} = (0.1)(0.5) + (0.1)(0.5) = 0.05 + 0.05 = 0.1\n$$\n$X$ 对 $Y$ 的平均因果效应为 $0.1$。",
            "answer": "$$\\boxed{0.1}$$"
        },
        {
            "introduction": "在上一练习中，我们学会了通过控制混杂变量来估计因果效应，但这是否意味着控制的变量越多越好？本练习  将探讨一个关键的例外情况——对撞偏倚。你将看到，当错误地对一个“对撞节点”（两个变量的共同结果）进行控制时，即使在原本独立的变量之间也会人为地产生虚假关联，这是正确选择控制变量时的重要一课。",
            "id": "4912830",
            "problem": "一位生物统计学家正在研究一个群体中的二元暴露 $X \\in \\{0,1\\}$ 和二元结局 $Y \\in \\{0,1\\}$，在该群体中，$X$ 对 $Y$ 没有因果效应，且 $X$ 和 $Y$ 之间没有共同的原因。其因果结构由一个有向无环图（DAG）给出，其中 $X$ 和 $Y$ 是第三个二元变量 $C \\in \\{0,1\\}$ 的边际独立原因，即 $X \\to C \\leftarrow Y$，且没有其他箭头。假设有以下数据生成机制：\n\n- $X$ 和 $Y$ 相互独立，且 $P(X=1)=0.4$ 和 $P(Y=1)=0.3$。因此，$(X,Y)$ 的联合分布为：\n  - $P(X=1,Y=1)=0.12$,\n  - $P(X=1,Y=0)=0.28$,\n  - $P(X=0,Y=1)=0.18$,\n  - $P(X=0,Y=0)=0.42$。\n\n- 对撞变量 $C$ 由其父变量 $(X,Y)$ 随机生成，其条件概率如下：\n  - $P(C=1 \\mid X=1,Y=1)=0.9$,\n  - $P(C=1 \\mid X=1,Y=0)=0.6$,\n  - $P(C=1 \\mid X=0,Y=1)=0.6$,\n  - $P(C=1 \\mid X=0,Y=0)=0.1$,\n  对于每个 $(X,Y)$，有 $P(C=0 \\mid X,Y)=1-P(C=1 \\mid X,Y)$。\n\n仅使用独立性和条件概率的定义以及上述概率表，计算诱导差异\n$$D \\equiv P(Y=1 \\mid X=1, C=1) - P(Y=1 \\mid X=1)$$\n你的最终答案必须是一个精确的数值（不要四舍五入）。",
            "solution": "该问题被确定为有效，因为它科学地基于因果推断和概率论的原理，信息充分且一致，表述客观，是一个适定的问题。所提供的概率是内部一致的，并符合概率公理。\n\n目标是计算诱导差异 $D$，其定义为：\n$$D \\equiv P(Y=1 \\mid X=1, C=1) - P(Y=1 \\mid X=1)$$\n\n我们将分别计算此表达式中的每一项。\n\n首先，我们计算 $P(Y=1 \\mid X=1)$ 这一项。问题陈述指明变量 $X$ 和 $Y$ 是边际独立的。根据统计独立性的定义，$Y$ 在给定 $X$ 下的条件概率等于 $Y$ 的边际概率。\n$$P(Y=1 \\mid X=1) = P(Y=1)$$\n问题给出了 $Y=1$ 的边际概率：\n$$P(Y=1) = 0.3$$\n因此，$D$ 表达式中的第二项是 $0.3$。\n\n接下来，我们计算 $P(Y=1 \\mid X=1, C=1)$ 这一项。根据条件概率的定义，我们可以写出：\n$$P(Y=1 \\mid X=1, C=1) = \\frac{P(X=1, Y=1, C=1)}{P(X=1, C=1)}$$\n为了计算这个表达式，我们必须计算分子 $P(X=1, Y=1, C=1)$ 和分母 $P(X=1, C=1)$。\n\n分子是所有三个变量都等于 $1$ 的联合概率。使用概率的链式法则，我们可以将其表示为：\n$$P(X=1, Y=1, C=1) = P(C=1 \\mid X=1, Y=1) \\, P(X=1, Y=1)$$\n问题提供了所需的值：\n$$P(C=1 \\mid X=1, Y=1) = 0.9$$\n$$P(X=1, Y=1) = 0.12$$\n代入这些值，我们得到：\n$$P(X=1, Y=1, C=1) = 0.9 \\times 0.12 = 0.108$$\n\n分母 $P(X=1, C=1)$ 是一个边际联合概率。我们可以通过应用全概率定律并对变量 $Y$ 进行边际化来获得它：\n$$P(X=1, C=1) = \\sum_{y \\in \\{0,1\\}} P(X=1, Y=y, C=1)$$\n$$P(X=1, C=1) = P(X=1, Y=1, C=1) + P(X=1, Y=0, C=1)$$\n我们已经计算了第一项：$P(X=1, Y=1, C=1) = 0.108$。\n现在我们计算第二项 $P(X=1, Y=0, C=1)$，同样使用链式法则：\n$$P(X=1, Y=0, C=1) = P(C=1 \\mid X=1, Y=0) \\, P(X=1, Y=0)$$\n问题提供了这些值：\n$$P(C=1 \\mid X=1, Y=0) = 0.6$$\n$$P(X=1, Y=0) = 0.28$$\n代入这些值，我们得到：\n$$P(X=1, Y=0, C=1) = 0.6 \\times 0.28 = 0.168$$\n现在，我们可以通过将两项相加来计算分母：\n$$P(X=1, C=1) = 0.108 + 0.168 = 0.276$$\n\n在计算出分子和分母之后，我们可以求得条件概率 $P(Y=1 \\mid X=1, C=1)$：\n$$P(Y=1 \\mid X=1, C=1) = \\frac{0.108}{0.276}$$\n为了将其表示为精确分数，我们将其写成整数之比并化简：\n$$\\frac{108}{276} = \\frac{27 \\times 4}{69 \\times 4} = \\frac{27}{69} = \\frac{9 \\times 3}{23 \\times 3} = \\frac{9}{23}$$\n\n最后，我们计算诱导差异 $D$：\n$$D = P(Y=1 \\mid X=1, C=1) - P(Y=1 \\mid X=1)$$\n$$D = \\frac{9}{23} - 0.3$$\n为了进行减法运算，我们将 $0.3$ 表示为分数 $\\frac{3}{10}$，并找到公分母，即 $23 \\times 10 = 230$：\n$$D = \\frac{9}{23} - \\frac{3}{10} = \\frac{9 \\times 10}{23 \\times 10} - \\frac{3 \\times 23}{10 \\times 23} = \\frac{90}{230} - \\frac{69}{230}$$\n$$D = \\frac{90 - 69}{230} = \\frac{21}{230}$$\n这个正值展示了对撞偏倚现象，即以一个共同效应（$C=1$）为条件，在两个边际独立的原因（$X$ 和 $Y$）之间诱导出了统计关联。",
            "answer": "$$\\boxed{\\frac{21}{230}}$$"
        },
        {
            "introduction": "当混杂变量无法被测量时，后门调整便无从下手，但这并不意味着因果推断的终结。本练习  引入了一个更复杂的场景，其中存在未观测到的混杂因素。我们将学习并应用“前门准则”，这是一种精妙的替代方法，它利用一个完全观测到的中介变量来识别因果效应，充分展示了基于有向无环图的因果推理框架的强大与灵活。",
            "id": "4912922",
            "problem": "考虑一项生物统计学观察性研究，其中涉及药物暴露变量 $X \\in \\{0,1\\}$、暴露后生物标志物 $M \\in \\{0,1\\}$、最终临床结局 $Y \\in \\{0,1\\}$ 以及一个未被测量的潜在受试者层面特征 $U$（例如，潜在的遗传易感性）。假设其因果结构由一个有向无环图（DAG）表示，图中包含边 $X \\rightarrow M \\rightarrow Y$、$U \\rightarrow X$ 和 $U \\rightarrow Y$，但不存在边 $U \\rightarrow M$ 和直接的边 $X \\rightarrow Y$。这意味着 $U$ 是 $X$ 和 $Y$ 之间关系的混杂因素，但它不影响 $M$，并且从 $X$到 $Y$ 的所有有向因果影响都通过 $M$ 进行中介。\n\n使用 Pearl 的 $do$-算子定义的干预、DAG 的截断因子分解以及 $d$-分离，首先从第一性原理出发，论证为何在该图下，干预估计量 $E[Y_x]$ 可以通过前门调整进行识别。然后，使用从一个具有正定性（对于 $x \\in \\{0,1\\}$，$P(X=x)>0$）的大型代表性队列中获得的以下观测数据，计算干预均值 $E[Y_{x=1}]$：\n\n- $P(X=1)=0.4$, $P(X=0)=0.6$。\n- $P(M=1 \\mid X=1)=0.7$, $P(M=1 \\mid X=0)=0.2$。\n- $P(Y=1 \\mid M=1, X=1)=0.8$, $P(Y=1 \\mid M=1, X=0)=0.6$。\n- $P(Y=1 \\mid M=0, X=1)=0.3$, $P(Y=1 \\mid M=0, X=0)=0.2$。\n\n你的最终数值答案必须是 $E[Y_{x=1}]$ 的值，以小数形式表示。请将答案四舍五入到四位有效数字。",
            "solution": "此问题已经过验证。\n\n### 第一步：提取已知条件\n-   **变量**：\n    -   药物暴露：$X \\in \\{0,1\\}$\n    -   暴露后生物标志物：$M \\in \\{0,1\\}$\n    -   最终临床结局：$Y \\in \\{0,1\\}$\n    -   潜在受试者层面特征：$U$ (未测量)\n-   **因果结构（DAG）**：\n    -   $X \\rightarrow M$\n    -   $M \\rightarrow Y$\n    -   $U \\rightarrow X$\n    -   $U \\rightarrow Y$\n    -   无边 $U \\rightarrow M$\n    -   无直接的边 $X \\rightarrow Y$\n-   **观测数据**：\n    -   $P(X=1)=0.4$, $P(X=0)=0.6$。\n    -   $P(M=1 \\mid X=1)=0.7$\n    -   $P(M=1 \\mid X=0)=0.2$\n    -   $P(Y=1 \\mid M=1, X=1)=0.8$\n    -   $P(Y=1 \\mid M=1, X=0)=0.6$\n    -   $P(Y=1 \\mid M=0, X=1)=0.3$\n    -   $P(Y=1 \\mid M=0, X=0)=0.2$\n-   **条件**：假设正定性成立，$P(X=x)>0$ 对于 $x \\in \\{0,1\\}$。\n-   **任务**：\n    1.  从第一性原理出发，论证为何干预估计量 $E[Y_x]$ 可以通过前门调整进行识别。\n    2.  计算 $E[Y_{x=1}]$ 的数值。\n\n### 第二步：使用提取的已知条件进行验证\n-   **科学性**：该问题基于因果推断的基本原理，特别是使用了有向无环图（DAGs）、Pearl 的 do-演算和前门调整。这些是生物统计学、流行病学和计算机科学中标准且成熟的概念。所描述的因果结构是用于教授前门准则的典型例子。该问题是科学合理的。\n-   **良构性**：问题陈述清晰。它要求进行理论推导和数值计算。所提供的 DAG 和观测概率足以唯一确定解。\n-   **客观性**：该问题以精确、客观的数学语言陈述，不含任何主观或基于观点的论断。\n-   **完整性与一致性**：该问题是自洽的。它提供了所有必要的条件概率和完整的因果结构。给定的概率是一致的（例如，$P(X=1) + P(X=0) = 0.4 + 0.6 = 1.0$）。\n-   **其他缺陷**：该问题没有违反任何其他验证标准。它并非微不足道，因为它需要对一个不明显的因果公式进行形式化推导和应用。\n\n### 第三步：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答\n\n按照要求，解答分为两部分：第一部分是可识别性的理论论证，第二部分是数值计算。\n\n**第一部分：可识别性论证**\n\n目标是证明干预量 $P(Y=y \\mid \\operatorname{do}(X=x))$ 可以完全用观测概率分布 $P(X, M, Y)$ 来表示。对于二元结局 $Y$，期望 $E[Y_x]$ 等价于 $P(Y=1 \\mid \\operatorname{do}(X=x))$。\n\n所提供 DAG 中的因果关系可以通过对包括潜在变量 $U$ 在内的所有变量的联合概率分布进行因子分解来编码：\n$$ P(u, x, m, y) = P(u) P(x \\mid u) P(m \\mid x) P(y \\mid m, u) $$\n这是基于给定 DAG 的截断因子分解，其中每个变量都以其直接父节点为条件。注意，$Y$ 的父节点是 $M$ 和 $U$，$X$ 不是其父节点，因此因子是 $P(y \\mid m, u)$。\n\n干预 $\\operatorname{do}(X=x_0)$ 产生的分布是通过修改原始联合分布得到的。该干预切断了指向 $X$ 的箭头（此处为从 $U$ 指向 $X$ 的箭头），并将 $X$ 的值设为 $x_0$。这对应于将因子 $P(x \\mid u)$ 替换为狄拉克δ函数 $\\delta(x-x_0)$，当 $x=x_0$ 时为1，否则为0。干预后的联合分布是：\n$$ P(u, m, y \\mid \\operatorname{do}(X=x_0)) = P(u) P(m \\mid x_0) P(y \\mid m, u) $$\n为了找到我们想要的干预概率 $P(y \\mid \\operatorname{do}(x_0))$，我们必须将潜在变量 $U$ 和中介变量 $M$ 边缘化：\n$$ P(y \\mid \\operatorname{do}(X=x_0)) = \\sum_{m} \\sum_u P(u, m, y \\mid \\operatorname{do}(X=x_0)) $$\n$$ P(y \\mid \\operatorname{do}(X=x_0)) = \\sum_{m} \\sum_u P(u) P(m \\mid x_0) P(y \\mid m, u) $$\n由于 $P(m \\mid x_0)$ 不依赖于 $u$，我们可以重新排列并重写为：\n$$ P(y \\mid \\operatorname{do}(X=x_0)) = \\sum_m P(m \\mid x_0) \\left( \\sum_u P(y \\mid m, u) P(u) \\right) $$\n项 $P(m \\mid x_0)$ 是一个可观测的条件概率。然而，括号中的项 $\\sum_u P(y \\mid m, u) P(u)$ 涉及未观测的变量 $U$，无法直接计算。可识别任务的核心就是用可观测量来表示这一项。\n\n让我们分析量 $\\sum_{x'} P(y \\mid m, x')P(x')$，它完全由可观测概率构成。根据全概率定律，我们可以通过以 $U$ 为条件来展开 $P(y \\mid m, x')$：\n$$ P(y \\mid m, x') = \\sum_u P(y \\mid m, x', u) P(u \\mid m, x') $$\n从 DAG 中可知，$Y$ 被集合 $\\{M, U\\}$ d-分离于 $X$。因此，$P(y \\mid m, x', u) = P(y \\mid m, u)$。\n同样从 DAG 中可知，$U$ 被 $X$ d-分离于 $M$ (路径 $U \\to X \\to M$ 被 $X$ 阻断)。因此，$P(u \\mid m, x') = P(u \\mid x')$。\n将这两个简化代回：\n$$ P(y \\mid m, x') = \\sum_u P(y \\mid m, u) P(u \\mid x') $$\n现在，让我们将它代回到表达式 $\\sum_{x'} P(y \\mid m, x')P(x')$ 中：\n$$ \\sum_{x'} P(y \\mid m, x')P(x') = \\sum_{x'} \\left( \\sum_u P(y \\mid m, u) P(u \\mid x') \\right) P(x') $$\n通过交换求和顺序：\n$$ = \\sum_u P(y \\mid m, u) \\left( \\sum_{x'} P(u \\mid x')P(x') \\right) $$\n内部的和 $\\sum_{x'} P(u \\mid x')P(x')$ 等价于 $\\sum_{x'} P(u, x')$，根据全概率定律，这正是 $P(u)$。\n所以我们证明了：\n$$ \\sum_{x'} P(y \\mid m, x') P(x') = \\sum_u P(y \\mid m, u) P(u) $$\n左边是可观测量的一个表达式。右边正是在我们关于 $P(y \\mid \\operatorname{do}(x_0))$ 的表达式中那个不可观测的项。\n\n将此结果代回到 $P(y \\mid \\operatorname{do}(x_0))$ 的方程中，我们得到：\n$$ P(Y=y \\mid \\operatorname{do}(X=x)) = \\sum_{m} P(M=m \\mid X=x) \\left( \\sum_{x'} P(Y=y \\mid M=m, X=x') P(X=x') \\right) $$\n这就是前门调整公式。由于右边的每一项——$P(M=m \\mid X=x)$、$P(Y=y \\mid M=m, X=x')$ 和 $P(X=x')$——都是可以从观测数据中估计的量，所以干预估计量 $P(Y=y \\mid \\operatorname{do}(X=x))$ 是可识别的。因此，$E[Y_x] = P(Y=1 \\mid \\operatorname{do}(X=x))$ 是可识别的。\n\n**第二部分：数值计算**\n\n我们需要计算 $E[Y_{x=1}] = P(Y=1 \\mid \\operatorname{do}(X=1))$。使用上面推导出的前门调整公式，令 $y=1$ 和 $x=1$：\n$$ E[Y_{x=1}] = \\sum_{m \\in \\{0,1\\}} P(M=m \\mid X=1) \\left( \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=m, X=x') P(X=x') \\right) $$\n我们首先计算内部的和，它代表了 $M$ 对 $Y$ 的因果效应，即 $P(Y=1 \\mid \\operatorname{do}(M=m))$，分别计算 $m=1$ 和 $m=0$ 的情况。\n\n对于 $m=1$：\n$$ P(Y=1 \\mid \\operatorname{do}(M=1)) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=1, X=x') P(X=x') $$\n$$ = P(Y=1 \\mid M=1, X=1)P(X=1) + P(Y=1 \\mid M=1, X=0)P(X=0) $$\n代入给定值：\n$$ = (0.8)(0.4) + (0.6)(0.6) = 0.32 + 0.36 = 0.68 $$\n\n对于 $m=0$：\n$$ P(Y=1 \\mid \\operatorname{do}(M=0)) = \\sum_{x' \\in \\{0,1\\}} P(Y=1 \\mid M=0, X=x') P(X=x') $$\n$$ = P(Y=1 \\mid M=0, X=1)P(X=1) + P(Y=1 \\mid M=0, X=0)P(X=0) $$\n代入给定值：\n$$ = (0.3)(0.4) + (0.2)(0.6) = 0.12 + 0.12 = 0.24 $$\n\n现在，我们可以通过组合这些结果来计算最终的量：\n$$ E[Y_{x=1}] = P(M=1 \\mid X=1)P(Y=1 \\mid \\operatorname{do}(M=1)) + P(M=0 \\mid X=1)P(Y=1 \\mid \\operatorname{do}(M=0)) $$\n我们已知 $P(M=1 \\mid X=1) = 0.7$，这意味着 $P(M=0 \\mid X=1) = 1 - 0.7 = 0.3$。\n代入所有值：\n$$ E[Y_{x=1}] = (0.7)(0.68) + (0.3)(0.24) $$\n$$ E[Y_{x=1}] = 0.476 + 0.072 $$\n$$ E[Y_{x=1}] = 0.548 $$\n问题要求将答案四舍五入到四位有效数字。\n$$ E[Y_{x=1}] = 0.5480 $$",
            "answer": "$$\\boxed{0.5480}$$"
        }
    ]
}