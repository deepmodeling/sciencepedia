{
    "hands_on_practices": [
        {
            "introduction": "逻辑回归中的一个关键挑战是解释模型系数。与线性回归中系数代表简单的加法变化不同，逻辑回归中的系数与事件的*几率*（odds）相关。本练习将指导您掌握一项基本技能：将回归系数转换为几率比（Odds Ratio, OR），这是量化和交流预测变量效应的基本方法。",
            "id": "4970670",
            "problem": "一项针对成人手术患者的前瞻性队列研究对二元结局 $Y \\in \\{0,1\\}$ 进行了建模，其中 $Y=1$ 表示在 $30$ 天内发生严重术后感染。设 $\\mathbf{x} = (x_1,\\dots,x_p)$ 表示患者的协变量，包括高敏C反应蛋白 (hs-CRP)。hs-CRP 协变量被编码为 $x_j$，其定义为 $x_j$ 每增加一个单位，对应于 hs-CRP 增加 $10$ mg/L。研究人员拟合了一个具有 logit 链接的逻辑回归模型，其中给定协变量下的感染概率为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$，感染几率为 $p(\\mathbf{x})/(1 - p(\\mathbf{x}))$，对数几率 (logit) 为 $\\ln\\!\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)$。假设 $x_j$ 的估计回归系数为 $\\beta_j = 0.693$。\n\n从几率和 logit 链接的定义出发，在将所有其他协变量视为固定的情况下，推导与 $x_j$ 增加一个单位相关联的严重术后感染几率的乘法变化。然后，根据给定的 $\\beta_j$ 计算这个乘法变化。将最终数值答案四舍五入到四位有效数字，且不包括单位。此外，请陈述 $x_j$ 每增加一个单位，几率比为 $2$ 的临床解释（此解释不属于最终数值答案的一部分）。",
            "solution": "该问题是有效的，因为它科学地基于生物统计学原理，特别是逻辑回归，并且提法适定，为求得唯一解提供了所有必要信息。\n\n该问题要求在逻辑回归模型中，推导协变量每增加一个单位时事件几率的乘法变化，根据给定的系数计算其值，并提供临床解释。\n\n设二元结局为 $Y \\in \\{0, 1\\}$，其中 $Y=1$ 表示我们感兴趣的事件（严重术后感染）。在给定协变量向量 $\\mathbf{x} = (x_1, \\dots, x_p)$ 的条件下，该事件的概率表示为 $p(\\mathbf{x}) = \\Pr(Y=1 \\mid \\mathbf{x})$。\n\n逻辑回归模型使用 logit 链接函数，该函数将事件几率的自然对数建模为协变量的线性函数。几率定义为事件发生的概率与不发生的概率之比：\n$$\n\\text{Odds}(\\mathbf{x}) = \\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\n$$\n因此，对数几率（或 logit）为：\n$$\n\\text{logit}(p(\\mathbf{x})) = \\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right)\n$$\n在逻辑回归模型中，logit 表示为：\n$$\n\\ln\\left(\\frac{p(\\mathbf{x})}{1 - p(\\mathbf{x})}\\right) = \\beta_0 + \\beta_1 x_1 + \\dots + \\beta_j x_j + \\dots + \\beta_p x_p = \\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\n$$\n其中 $\\beta_0, \\beta_1, \\dots, \\beta_p$ 是回归系数。\n\n为了推导与特定协变量 $x_j$ 增加一个单位相关联的几率的乘法变化，我们必须比较 $x_j$ 在两个不同水平上的几率，同时保持所有其他协变量（$k \\neq j$ 时的 $x_k$）不变。\n\n设具有协变量 $\\mathbf{x}$ 的患者的几率为 $\\text{Odds}(\\mathbf{x})$。对 logit 方程取指数，我们得到：\n$$\n\\text{Odds}(\\mathbf{x}) = \\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)\n$$\n现在，考虑第二种情况，即协变量 $x_j$ 增加一个单位变为 $x_j + 1$。新的协变量向量为 $\\mathbf{x}' = (x_1, \\dots, x_j+1, \\dots, x_p)$。这种情况下的几率为：\n$$\n\\text{Odds}(\\mathbf{x}') = \\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)\n$$\n几率的乘法变化是新几率与原始几率之比。这个比率定义为 $x_j$ 增加一个单位的几率比 (OR)。\n$$\n\\text{OR}_j = \\frac{\\text{Odds}(\\mathbf{x}')}{\\text{Odds}(\\mathbf{x})} = \\frac{\\exp\\left(\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j(x_j + 1)\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n我们可以重写分子中的指数项：\n$$\n\\beta_0 + \\sum_{k \\neq j} \\beta_k x_k + \\beta_j x_j + \\beta_j = \\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\n$$\n将此代回几率比的表达式中：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) + \\beta_j\\right)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n利用性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们得到：\n$$\n\\text{OR}_j = \\frac{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right) \\exp(\\beta_j)}{\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)}\n$$\n分子和分母中的项 $\\exp\\left(\\beta_0 + \\sum_{k=1}^{p} \\beta_k x_k\\right)$ 可以消去，得到基本结果：\n$$\n\\text{OR}_j = \\exp(\\beta_j)\n$$\n这个推导表明，$x_j$ 每增加一个单位，几率的乘法变化等于系数 $\\beta_j$ 的指数。\n\n问题陈述协变量 $x_j$（代表 hs-CRP）的估计系数为 $\\beta_j = 0.693$。我们现在可以计算几率的乘法变化：\n$$\n\\text{OR}_j = \\exp(0.693)\n$$\n我们计算这个值，并按要求四舍五入到四位有效数字：\n$$\n\\exp(0.693) \\approx 1.99970535 \\approx 2.000\n$$\n几率的乘法变化为 $2.000$。\n\n问题还要求对 $x_j$ 每增加一个单位的几率比为 $2$ 进行临床解释。协变量 $x_j$ 的编码方式是，每增加一个单位对应于 hs-CRP 增加 $10$ mg/L。因此，$x_j$ 的几率比为 $2$ 意味着，在模型中所有其他患者特征保持不变的假设下，患者的 hs-CRP 水平每增加 $10$ mg/L，其在 $30$ 天内发生严重术后感染的几率估计会乘以 $2$（即翻倍）。",
            "answer": "$$\\boxed{2.000}$$"
        },
        {
            "introduction": "对于特定个体，逻辑回归模型的直接输出是其对数几率（log-odds），这是一个从负无穷到正无穷的数值，本身不具直观意义。为了提供具体的风险评估，我们必须将此对数几率值转换回概率。本练习将演示这一关键转换，将模型抽象的线性预测值与一个具体且具有临床相关性的概率联系起来。",
            "id": "4970702",
            "problem": "一个临床研究团队正在为因急性失代偿性心力衰竭入住重症监护室 (ICU) 的患者，开发一个关于$30$天死亡率的预后模型。令 $Y \\in \\{0,1\\}$ 表示二元结果，其中 $Y=1$ 表示30天内死亡，$Y=0$ 表示存活。假设 $Y \\mid \\boldsymbol{X}$ 服从参数为 $p(\\boldsymbol{X})$ 的伯努利分布，且该模型是具有标准 logit 链接的广义线性模型。对于具有协变量 $\\boldsymbol{X}$ 的特定患者，拟合的线性预测子（也称为对数几率）为 $\\eta=-1.386$。\n\n请仅从伯努利模型和广义线性模型中标准 logit 链接的定义出发，推导从线性预测子 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系，并计算该患者的 $p$ 的数值。简要说明所得到的 $p$ 值对于30天死亡风险的临床意义。\n\n提供 $p$ 的值，以小数形式表示，并四舍五入到三位有效数字。不要使用百分号。",
            "solution": "对问题陈述的有效性进行评估。\n\n**步骤1：提取已知条件**\n-   结果变量：$Y \\in \\{0,1\\}$，其中 $Y=1$ 表示30天内死亡，$Y=0$ 表示存活。\n-   结果的条件分布：$Y \\mid \\boldsymbol{X} \\sim \\text{Bernoulli}(p(\\boldsymbol{X}))$。\n-   模型框架：广义线性模型 (GLM)。\n-   链接函数：标准 logit 链接。\n-   特定患者的拟合线性预测子：$\\eta = -1.386$。\n-   任务：\n    1.  推导从线性预测子 $\\eta$ 到概率 $p(\\boldsymbol{X})$ 的映射关系。\n    2.  计算给定患者的 $p$ 的数值。\n    3.  简要说明所计算出的概率的临床意义。\n    4.  提供四舍五入到三位有效数字的 $p$ 值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上基于广义线性模型理论，这是统计建模中的一个标准和基础课题。在此框架内，对二元结果使用伯努利分布和 logit 链接函数是标准的典则选择。该问题是适定的，提供了执行所要求的推导和计算所需的所有必要信息，从而能够得到唯一的解。所用术语精确且客观。提供的线性预测子值 $\\eta = -1.386$ 是一个合理的现实世界数值。问题中没有矛盾、歧义或违反科学原理之处。\n\n**步骤3：结论与行动**\n该问题是有效的。将提供完整的解答。\n\n***\n\n该问题要求在广义线性模型 (GLM) 框架下，为服从伯努利分布的结果推导线性预测子 $\\eta$ 和事件概率 $p$ 之间的关系。\n\n一个广义线性模型由三个部分组成：\n1.  随机部分：响应变量 $Y$ 的分布是指数族的一员。\n2.  系统部分：一个线性预测子，$\\eta = \\boldsymbol{X}^T\\boldsymbol{\\beta}$。\n3.  链接函数：一个函数 $g$，它将随机部分的期望值 $\\mu = E[Y]$ 与系统部分联系起来，使得 $g(\\mu) = \\eta$。\n\n对于二元结果 $Y \\in \\{0,1\\}$，其条件分布是参数为 $p = P(Y=1 \\mid \\boldsymbol{X})$ 的伯努利分布。其概率质量函数为 $f(y;p) = p^y(1-p)^{1-y}$。为了确定标准链接函数，我们必须将其表示为指数族的典则形式：\n$$f(y; \\theta) = \\exp \\left( \\frac{y\\theta - b(\\theta)}{a(\\phi)} + c(y, \\phi) \\right)$$\n重写伯努利概率质量函数：\n$$f(y;p) = p^y(1-p)^{1-y} = \\exp\\left( \\ln\\left(p^y(1-p)^{1-y}\\right) \\right)$$\n$$= \\exp\\left( y\\ln(p) + (1-y)\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln(p) + \\ln(1-p) - y\\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\left[\\ln(p) - \\ln(1-p)\\right] + \\ln(1-p) \\right)$$\n$$= \\exp\\left( y\\ln\\left(\\frac{p}{1-p}\\right) + \\ln(1-p) \\right)$$\n将此与典则形式进行比较，我们可以确定典则参数为 $\\theta = \\ln\\left(\\frac{p}{1-p}\\right)$。量 $\\frac{p}{1-p}$ 是事件 $Y=1$ 的几率，其自然对数即为对数几率。伯努利变量的期望值为 $\\mu = E[Y] = p$。\n\n标准链接函数是将均值 $\\mu$ 映射到典则参数 $\\theta$ 的函数。对于伯努利分布，该函数为：\n$$g(p) = \\theta = \\ln\\left(\\frac{p}{1-p}\\right)$$\n这个函数 $g(p)$ 被称为 logit 函数。\n\n在广义线性模型中，链接函数将结果的均值与线性预测子 $\\eta$ 联系起来。使用标准 logit 链接，我们有：\n$$\\eta = g(p) = \\ln\\left(\\frac{p}{1-p}\\right)$$\n第一个任务是推导从 $\\eta$ 到 $p$ 的映射。这需要对 logit 函数求逆。我们对上述方程求解 $p$：\n$$\\exp(\\eta) = \\frac{p}{1-p}$$\n$$\\exp(\\eta)(1-p) = p$$\n$$\\exp(\\eta) - p\\exp(\\eta) = p$$\n$$\\exp(\\eta) = p + p\\exp(\\eta)$$\n$$\\exp(\\eta) = p(1 + \\exp(\\eta))$$\n$$p = \\frac{\\exp(\\eta)}{1 + \\exp(\\eta)}$$\n这个表达式提供了从线性预测子 $\\eta$ 到概率 $p$ 的映射。这个函数通常被称为 logistic sigmoid 函数。通过将分子和分母同时除以 $\\exp(\\eta)$，可以得到一个等价且通常在数值上更稳定的形式：\n$$p = \\frac{1}{\\exp(-\\eta) + 1}$$\n推导至此完成。\n\n第二个任务是计算线性预测子为 $\\eta = -1.386$ 的患者的 $p$ 值。使用推导出的公式：\n$$p = \\frac{1}{1 + \\exp(-\\eta)} = \\frac{1}{1 + \\exp(-(-1.386))}$$\n$$p = \\frac{1}{1 + \\exp(1.386)}$$\n我们计算 $\\exp(1.386)$ 的值：\n$$\\exp(1.386) \\approx 3.998854$$\n将此值代回 $p$ 的表达式中：\n$$p \\approx \\frac{1}{1 + 3.998854} = \\frac{1}{4.998854} \\approx 0.20004585$$\n题目要求答案四舍五入到三位有效数字。第一位有效数字是 $2$，第二位是 $0$，第三位是 $0$。第四位数字是 $0$，所以我们向下舍入。\n$$p \\approx 0.200$$\n\n最后的任务是说明该值的临床意义。概率 $p$ 代表了对于具有给定协变量集合 $\\boldsymbol{X}$ 的患者，模型预测其发生事件 $Y=1$（30天内死亡）的可能性。因此，$p=0.200$ 的值意味着，对于这位特定患者，预后模型估计其在入住 ICU 后30天内的死亡概率为 $20.0\\%$。这是该患者的个体预测风险。",
            "answer": "$$\n\\boxed{0.200}\n$$"
        },
        {
            "introduction": "虽然几率比提供了衡量预测变量效应的单一恒定指标，但其在*概率*尺度上的影响更为微妙，并取决于个体的基线风险。本练习将介绍边际效应（marginal effect）的概念，它量化了当预测变量发生微小变化时概率的变化量。您将学习如何计算这种效应，从而揭示逻辑模型特有的预测变量与结果之间的非线性关系。",
            "id": "4970705",
            "problem": "一项临床研究使用逻辑回归对术后急性肾损伤的概率进行建模，将其作为二元结果。设 $Y \\in \\{0,1\\}$ 表示是否发生急性肾损伤（$Y=1$）或不发生（$Y=0$）。对于协变量向量为 $\\boldsymbol{x}$ 的患者，该模型通过对数几率（logit）链接函数指定条件概率 $p(\\boldsymbol{x}) = \\mathbb{P}(Y=1 \\mid \\boldsymbol{x})$：对数几率是协变量的线性函数，其线性预测量为 $\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$，概率 $p(\\boldsymbol{x})$ 是通过逻辑函数将 $\\eta(\\boldsymbol{x})$ 映射到单位区间得到的。考虑一个特定的连续协变量 $x_{j}$，它代表一个标准化的术前生物标志物。在某特定患者的协变量值下，模型得出的预测概率为 $p(\\boldsymbol{x}) = p = 0.3$，且 $x_{j}$ 的估计系数为 $\\beta_{j} = 1.2$。从逻辑回归模型和逻辑函数的定义出发，推导 $x_{j}$ 对概率的边际效应 $\\frac{\\partial p}{\\partial x_{j}}$（在该患者的协变量值处进行评估），并计算其数值。将您的最终答案表示为一个纯数字。无需四舍五入。",
            "solution": "该问题提法明确，有科学依据，并提供了足够的信息来推导和计算所要求的量。这是将微分学应用于逻辑回归模型函数形式的一个标准应用。因此，该问题是有效的。\n\n逻辑回归模型将给定协变量向量 $\\boldsymbol{x}$ 的二元结果 $Y=1$ 的概率定义为线性预测量 $\\eta(\\boldsymbol{x})$ 的函数。该关系由逻辑函数（通常表示为 $\\sigma(\\cdot)$）给出：\n$$p(\\boldsymbol{x}) = \\sigma(\\eta(\\boldsymbol{x})) = \\frac{1}{1 + \\exp(-\\eta(\\boldsymbol{x}))}$$\n线性预测量 $\\eta(\\boldsymbol{x})$ 是协变量的线性组合：\n$$\\eta(\\boldsymbol{x}) = \\beta_{0} + \\sum_{k} \\beta_{k} x_{k}$$\n其中 $\\beta_0$ 是截距，$\\beta_k$ 是协变量 $x_k$ 的系数。\n\n我们需要求出特定连续协变量 $x_j$ 对概率 $p(\\boldsymbol{x})$ 的边际效应。这个边际效应定义为偏导数 $\\frac{\\partial p}{\\partial x_{j}}$。为求此导数，我们应用链式求导法则：\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}}$$\n\n首先，我们计算线性预测量 $\\eta(\\boldsymbol{x})$ 对 $x_j$ 的导数：\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\frac{\\partial}{\\partial x_{j}} \\left( \\beta_{0} + \\sum_{k} \\beta_{k} x_{k} \\right)$$\n假设协变量是不同的变量，则 $x_k$ 对 $x_j$ 的导数在 $k=j$ 时为 $1$，否则为 $0$。因此，只有包含 $\\beta_j x_j$ 的项对导数有贡献。\n$$\\frac{\\partial \\eta}{\\partial x_{j}} = \\beta_{j}$$\n\n接下来，我们计算逻辑函数 $p(\\eta)$ 对其参数 $\\eta$ 的导数：\n$$p(\\eta) = (1 + \\exp(-\\eta))^{-1}$$\n使用幂法则和链式法则：\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot \\frac{d}{d\\eta}(\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = -1 \\cdot (1 + \\exp(-\\eta))^{-2} \\cdot (-\\exp(-\\eta))$$\n$$\\frac{d p}{d \\eta} = \\frac{\\exp(-\\eta)}{(1 + \\exp(-\\eta))^{2}}$$\n这个表达式可以方便地用 $p$ 本身来重写。我们认识到：\n$$p = \\frac{1}{1 + \\exp(-\\eta)}$$\n我们可以将 $1-p$ 写为：\n$$1 - p = 1 - \\frac{1}{1 + \\exp(-\\eta)} = \\frac{(1 + \\exp(-\\eta)) - 1}{1 + \\exp(-\\eta)} = \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)}$$\n因此，导数 $\\frac{dp}{d\\eta}$ 是这两项的乘积：\n$$\\frac{d p}{d \\eta} = \\left( \\frac{1}{1 + \\exp(-\\eta)} \\right) \\cdot \\left( \\frac{\\exp(-\\eta)}{1 + \\exp(-\\eta)} \\right) = p \\cdot (1 - p)$$\n这是逻辑函数的一个基本性质。\n\n现在，我们将链式法则的两个部分结合起来，得到边际效应的最终表达式：\n$$\\frac{\\partial p}{\\partial x_{j}} = \\frac{d p}{d \\eta} \\cdot \\frac{\\partial \\eta}{\\partial x_{j}} = p(\\boldsymbol{x}) \\cdot (1 - p(\\boldsymbol{x})) \\cdot \\beta_{j}$$\n\n问题提供了针对特定患者评估的必要数值：\n预测概率为 $p(\\boldsymbol{x}) = p = 0.3$。\n协变量 $x_j$ 的估计系数为 $\\beta_j = 1.2$。\n\n我们将这些数值代入我们推导出的边际效应公式中：\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot (1 - 0.3) \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.3 \\cdot 0.7 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.21 \\cdot 1.2$$\n$$\\frac{\\partial p}{\\partial x_{j}} = 0.252$$\n因此，在该患者的协变量值下，标准化生物标志物 $x_j$ 每增加一个单位，与急性肾损伤概率增加约 $0.252$ 相关。",
            "answer": "$$\n\\boxed{0.252}\n$$"
        }
    ]
}