{
    "hands_on_practices": [
        {
            "introduction": "The concept of the herd immunity threshold is central to designing effective vaccination campaigns. This exercise guides you through the fundamental calculation that connects a pathogen's intrinsic transmissibility, represented by the basic reproduction number $R_0$, to the minimum population immunity needed to prevent an epidemic. By deriving this threshold and exploring how uncertainty in our estimate of $R_0$ translates to uncertainty in our vaccination target, you will gain a core competency in epidemiological modeling .",
            "id": "2543678",
            "problem": "In a large, homogeneously mixing host population governed by the Susceptible–Infectious–Removed (SIR) framework, the basic reproduction number $R_{0}$ is defined as the expected number of secondary infections generated by a single typical infectious individual in a wholly susceptible population. Let $H \\in [0,1]$ denote the immune fraction (for example, immune due to sterilizing vaccination or prior infection), so that the susceptible fraction is $S = 1 - H$. It is a well-tested fact that at the start of an epidemic, when depletion of susceptibles by infection is negligible, the effective reproduction number satisfies $R_{\\mathrm{e}} = R_{0} S$. Sustained transmission requires $R_{\\mathrm{e}} > 1$, and prevention of sustained transmission requires $R_{\\mathrm{e}} < 1$.\n\nStarting from these foundational facts, derive the minimal immune fraction $H^{*}$ that just prevents sustained transmission (that is, the threshold at which $R_{\\mathrm{e}} = 1$). Then, treat $H^{*}$ as an explicit function of $R_{0}$ and, using a first-order Taylor (delta-method) approximation, obtain the leading-order linear uncertainty propagation from uncertainty in $R_{0}$ to uncertainty in $H^{*}$; that is, if the standard deviation of $R_{0}$ is $\\sigma_{R_{0}}$, define the sensitivity coefficient $c$ by $\\sigma_{H^{*}} \\approx c\\,\\sigma_{R_{0}}$ and express $c$ in terms of $R_{0}$.\n\nFinally, evaluate both quantities at $R_{0} = 3.5$. For the minimal immune fraction $H^{*}$ at $R_{0} = 3.5$, report your result as a decimal fraction rounded to four significant figures (do not use a percentage sign). For the sensitivity coefficient $c$ at $R_{0} = 3.5$, provide an exact expression. Report your final result as a two-entry row matrix $\\big[\\,H^{*},\\,c\\,\\big]$ with no units inside the matrix.",
            "solution": "The problem statement is subjected to validation.\n\nGivens are extracted verbatim as follows:\n1.  The population is large, homogeneously mixing, and governed by the Susceptible–Infectious–Removed (SIR) framework.\n2.  The basic reproduction number is $R_{0}$.\n3.  The immune fraction is $H \\in [0,1]$.\n4.  The susceptible fraction is $S = 1 - H$.\n5.  The effective reproduction number is $R_{\\mathrm{e}} = R_{0} S$ at the start of an epidemic.\n6.  Sustained transmission requires $R_{\\mathrm{e}} > 1$.\n7.  Prevention of sustained transmission requires $R_{\\mathrm{e}} < 1$.\n8.  The task is to find the minimal immune fraction $H^{*}$ that just prevents sustained transmission, where $R_{\\mathrm{e}} = 1$.\n9.  The task is to find the sensitivity coefficient $c$ in the relation $\\sigma_{H^{*}} \\approx c\\,\\sigma_{R_{0}}$, derived from a first-order Taylor approximation.\n10. The values must be evaluated at $R_{0} = 3.5$.\n11. The value for $H^{*}$ must be a decimal fraction rounded to four significant figures.\n12. The value for $c$ must be an exact expression.\n\nThe problem is validated against the mandatory criteria.\n*   **Scientific Grounding**: The problem is built upon the foundational principles of mathematical epidemiology, specifically the SIR model and the concept of the herd immunity threshold. The relation $R_{\\mathrm{e}} = R_{0} S$ is a cornerstone of this field. Thus, the problem is scientifically sound.\n*   **Well-Posedness**: The objectives are clearly stated and mathematically derivable from the provided premises. The questions ask for specific quantities ($H^{*}$ and $c$) for which unique solutions exist.\n*   **Objectivity**: The problem is stated using precise, quantitative, and unbiased language.\n\nThe problem is deemed valid as it does not exhibit any of the enumerated flaws. It is scientifically grounded, well-posed, and objective. The solution proceeds.\n\nThe first objective is to derive the minimal immune fraction, denoted $H^{*}$, required to prevent sustained transmission. The threshold for preventing sustained transmission is the point at which the effective reproduction number, $R_{\\mathrm{e}}$, is equal to $1$. At this threshold, each infectious individual produces, on average, one new infection, so the epidemic does not grow.\n\nWe are given the relation:\n$$R_{\\mathrm{e}} = R_{0} S$$\nWe are also given that the susceptible fraction $S$ is related to the immune fraction $H$ by:\n$$S = 1 - H$$\nSubstituting the expression for $S$ into the equation for $R_{\\mathrm{e}}$ yields:\n$$R_{\\mathrm{e}} = R_{0} (1 - H)$$\nTo find the herd immunity threshold $H^{*}$, we set $R_{\\mathrm{e}} = 1$:\n$$1 = R_{0} (1 - H^{*})$$\nWe now solve for $H^{*}$ as a function of $R_{0}$. This is under the assumption that $R_{0} > 1$, which is the necessary condition for an epidemic to be possible in the first place. If $R_{0} \\le 1$, no epidemic can occur even in a fully susceptible population, and the required immune fraction is $0$. Given the context and the value $R_{0} = 3.5$, the assumption $R_{0} > 1$ is valid.\n$$\\frac{1}{R_{0}} = 1 - H^{*}$$\n$$H^{*} = 1 - \\frac{1}{R_{0}}$$\nThis expression gives the minimal immune fraction needed to achieve herd immunity.\n\nThe second objective is to determine the sensitivity coefficient $c$ that relates the uncertainty in $H^{*}$ to the uncertainty in $R_{0}$. This is achieved using a first-order Taylor series approximation, also known as the delta method. For a function $H^{*}(R_{0})$, the uncertainty propagation is given by:\n$$\\sigma_{H^{*}} \\approx \\left| \\frac{dH^{*}}{dR_{0}} \\right| \\sigma_{R_{0}}$$\nThe problem defines the sensitivity coefficient $c$ as the factor in this approximation:\n$$c = \\left| \\frac{dH^{*}}{dR_{0}} \\right|$$\nWe must compute the derivative of $H^{*}(R_{0}) = 1 - \\frac{1}{R_{0}} = 1 - R_{0}^{-1}$ with respect to $R_{0}$:\n$$\\frac{dH^{*}}{dR_{0}} = \\frac{d}{dR_{0}} \\left( 1 - R_{0}^{-1} \\right) = 0 - (-1)R_{0}^{-2} = \\frac{1}{R_{0}^{2}}$$\nSince $R_{0}^{2}$ is always positive for $R_{0} > 1$, the derivative is positive, and the absolute value is redundant. Therefore, the sensitivity coefficient is:\n$$c = \\frac{1}{R_{0}^{2}}$$\n\nFinally, we evaluate both $H^{*}$ and $c$ for the given value $R_{0} = 3.5$.\n\nFor the minimal immune fraction $H^{*}$:\n$$H^{*} = 1 - \\frac{1}{3.5} = 1 - \\frac{1}{7/2} = 1 - \\frac{2}{7} = \\frac{5}{7}$$\nThe problem requires this result as a decimal fraction rounded to four significant figures.\n$$\\frac{5}{7} \\approx 0.7142857...$$\nRounding to four significant figures, we get:\n$$H^{*} \\approx 0.7143$$\n\nFor the sensitivity coefficient $c$:\n$$c = \\frac{1}{R_{0}^{2}} = \\frac{1}{(3.5)^{2}}$$\nThe problem requires an exact expression for this value.\n$$(3.5)^{2} = \\left(\\frac{7}{2}\\right)^{2} = \\frac{49}{4} = 12.25$$\nTherefore,\n$$c = \\frac{1}{49/4} = \\frac{4}{49}$$\n\nThe final answer is to be reported as a two-entry row matrix $\\begin{pmatrix} H^{*} & c \\end{pmatrix}$.\nThe two calculated values are $H^{*} \\approx 0.7143$ and $c = \\frac{4}{49}$.\nThe matrix is thus $\\begin{pmatrix} 0.7143 & \\frac{4}{49} \\end{pmatrix}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.7143 & \\frac{4}{49} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While the basic herd immunity threshold provides a theoretical target, real-world planning must account for the fact that vaccines are not perfectly effective. This practice builds upon the foundational model by incorporating vaccine efficacy, $E$, a crucial parameter that modifies the relationship between coverage and population immunity. You will derive the formula for the minimum vaccination coverage needed with an imperfect vaccine and analyze a scenario where herd immunity might be unachievable, highlighting the critical interplay between pathogen transmissibility and vaccine performance .",
            "id": "5008154",
            "problem": "A measles-like pathogen circulates in a large, well-mixed population. The basic reproduction number, defined as the average number of secondary infections caused by a single infectious individual in a fully susceptible population, is $R_0 = 12$. A vaccine is available that reduces each vaccinated individual's susceptibility to infection per exposure by a factor of $(1 - E)$ relative to an unvaccinated individual, where $E$ is the vaccine efficacy against susceptibility. Assume homogeneous vaccination coverage: a fraction $p$ of the population is vaccinated, with no waning and no heterogeneity in contact patterns or susceptibility beyond vaccination status.\n\nUse only the following foundational principles:\n- The effective reproduction number $R_{\\mathrm{eff}}$ equals the basic reproduction number multiplied by the average transmission success per contact relative to a fully susceptible population.\n- Sustained transmission is not possible when $R_{\\mathrm{eff}} < 1$.\n- In a homogeneously vaccinated population under random mixing, the average susceptibility is the coverage-weighted mean of susceptibilities of vaccinated and unvaccinated individuals.\n\nTasks:\n1. Starting from these principles, derive an expression for the minimal homogeneous coverage $p_{\\min}$ required to prevent sustained transmission as a function of $R_0$ and $E$.\n2. Evaluate $p_{\\min}$ for $R_0 = 12$ and $E = 0.9$. If the computed $p_{\\min}$ exceeds $1$, report the value as computed and interpret it as indicating that vaccination alone, even at complete coverage, cannot achieve herd immunity under the stated assumptions.\n3. To assess sensitivity to vaccine efficacy, compute the partial derivative $\\frac{\\partial p_{\\min}}{\\partial E}$ at $R_0 = 12$ and $E = 0.9$.\n\nRound both numerical results to $4$ significant figures. Express the coverage and the derivative as pure decimals without a percentage sign. Provide your final answer as a row matrix $\\begin{pmatrix} p_{\\min} & \\frac{\\partial p_{\\min}}{\\partial E} \\end{pmatrix}$ with no units.",
            "solution": "The problem has been validated and is deemed scientifically grounded, well-posed, and objective. It is based on standard principles of mathematical epidemiology and provides all necessary information for a complete solution.\n\nThe solution is developed in three parts as requested.\n\n**1. Derivation of the minimal vaccination coverage, $p_{\\min}$**\n\nThe analysis begins from the foundational principles provided.\nAn unvaccinated individual has a baseline susceptibility to infection, which we can normalize to $1$. The vaccine has an efficacy $E$ against susceptibility, meaning it reduces a vaccinated individual's susceptibility by a factor of $(1-E)$. Therefore, the relative susceptibility of a vaccinated individual is $(1-E)$.\n\nAccording to the third principle provided, in a homogeneously vaccinated population with a coverage fraction $p$, the average susceptibility of the population, denoted by $\\bar{s}$, is the coverage-weighted mean of the susceptibilities of vaccinated and unvaccinated individuals. A fraction $(1-p)$ of the population is unvaccinated (susceptibility of $1$), and a fraction $p$ is vaccinated (susceptibility of $1-E$).\n\nThe average susceptibility is therefore:\n$$ \\bar{s} = (1-p) \\cdot 1 + p \\cdot (1-E) $$\nSimplifying this expression:\n$$ \\bar{s} = 1 - p + p - pE = 1 - pE $$\n\nAccording to the first principle, the effective reproduction number, $R_{\\mathrm{eff}}$, is the product of the basic reproduction number, $R_0$, and the average population susceptibility, $\\bar{s}$.\n$$ R_{\\mathrm{eff}} = R_0 \\cdot \\bar{s} $$\nSubstituting the expression for $\\bar{s}$:\n$$ R_{\\mathrm{eff}} = R_0 (1 - pE) $$\n\nAccording to the second principle, sustained transmission is prevented when $R_{\\mathrm{eff}} < 1$. The critical threshold for achieving herd immunity is when $R_{\\mathrm{eff}} = 1$. We can find the minimal vaccination coverage, $p_{\\min}$, by setting $p = p_{\\min}$ and $R_{\\mathrm{eff}} = 1$.\n$$ 1 = R_0 (1 - p_{\\min}E) $$\n\nWe now solve for $p_{\\min}$ as a function of $R_0$ and $E$.\n$$ \\frac{1}{R_0} = 1 - p_{\\min}E $$\n$$ p_{\\min}E = 1 - \\frac{1}{R_0} $$\n$$ p_{\\min}E = \\frac{R_0 - 1}{R_0} $$\n$$ p_{\\min} = \\frac{R_0 - 1}{E R_0} $$\nThis is the required expression for the minimal homogeneous coverage $p_{\\min}$.\n\n**2. Evaluation of $p_{\\min}$ for the given parameters**\n\nWe are given $R_0 = 12$ and a vaccine efficacy of $E = 0.9$. Substituting these values into the derived expression for $p_{\\min}$:\n$$ p_{\\min} = \\frac{12 - 1}{(0.9) \\cdot 12} = \\frac{11}{10.8} $$\nCalculating the numerical value:\n$$ p_{\\min} \\approx 1.0185185... $$\nRounding to $4$ significant figures, we get:\n$$ p_{\\min} \\approx 1.019 $$\nSince $p_{\\min} > 1$, this result indicates that achieving herd immunity (i.e., reducing $R_{\\mathrm{eff}}$ to less than $1$) is impossible under these conditions, even with $100\\%$ vaccination coverage ($p=1$). With $p=1$, the effective reproduction number would be $R_{\\mathrm{eff}} = R_0(1 - E) = 12(1-0.9) = 12(0.1) = 1.2$. As $1.2 > 1$, transmission would still be sustained. The calculated value $p_{\\min} \\approx 1.019$ represents a mathematically required coverage level that is practically unattainable, as coverage cannot exceed $1$.\n\n**3. Calculation of the partial derivative $\\frac{\\partial p_{\\min}}{\\partial E}$**\n\nTo assess the sensitivity of the required coverage to vaccine efficacy, we compute the partial derivative of $p_{\\min}$ with respect to $E$. Our starting expression is:\n$$ p_{\\min}(E) = \\frac{R_0 - 1}{R_0 E} = \\left(\\frac{R_0 - 1}{R_0}\\right) E^{-1} $$\nWe differentiate this expression with respect to $E$, treating $R_0$ as a constant:\n$$ \\frac{\\partial p_{\\min}}{\\partial E} = \\left(\\frac{R_0 - 1}{R_0}\\right) \\frac{d}{dE}(E^{-1}) $$\n$$ \\frac{\\partial p_{\\min}}{\\partial E} = \\left(\\frac{R_0 - 1}{R_0}\\right) (-1 \\cdot E^{-2}) $$\n$$ \\frac{\\partial p_{\\min}}{\\partial E} = - \\frac{R_0 - 1}{R_0 E^2} $$\nNow, we evaluate this derivative at the given values, $R_0 = 12$ and $E = 0.9$:\n$$ \\frac{\\partial p_{\\min}}{\\partial E} \\bigg|_{R_0=12, E=0.9} = - \\frac{12 - 1}{12 \\cdot (0.9)^2} = - \\frac{11}{12 \\cdot 0.81} = - \\frac{11}{9.72} $$\nCalculating the numerical value:\n$$ \\frac{\\partial p_{\\min}}{\\partial E} \\approx -1.1316872... $$\nRounding to $4$ significant figures, we obtain:\n$$ \\frac{\\partial p_{\\min}}{\\partial E} \\approx -1.132 $$\nThis negative value indicates that as vaccine efficacy $E$ increases, the required minimum coverage $p_{\\min}$ decreases, which is an expected relationship. The magnitude of the derivative, approximately $-1.132$, quantifies this sensitivity at the specified parameters.",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.019 & -1.132 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Populations are not uniform masses; they are structured networks of individuals with diverse behaviors and characteristics. This advanced practice transitions from simplified 'well-mixed' assumptions to a more realistic, age-structured model, reflecting how modern epidemiologists use computational tools to guide public health policy. By implementing a model with heterogeneous contact rates and vaccine uptake, you will not only calculate the effective reproduction number ($R_e$) but also learn how to identify the specific demographic groups driving residual transmission—a vital skill for targeted interventions .",
            "id": "5008235",
            "problem": "A developer is provided the following conceptual base from infectious disease epidemiology: in a population partitioned into discrete age groups, early epidemic growth for a directly transmitted infection can be represented by a nonnegative next-generation operator whose largest eigenvalue determines the Basic Reproduction Number (R0). Vaccination reduces susceptibility of recipients, thereby altering this operator and yielding the Effective Reproduction Number (R_e). The developer must build a program to compute $R_e$ after vaccination and to identify, under early exponential growth, which age group contributes most to residual transmission.\n\nFundamental base to use:\n- The Basic Reproduction Number (R0) is the largest eigenvalue (spectral radius) of a nonnegative next-generation matrix.\n- Vaccination reduces the susceptible fraction in each recipient group, which reduces the expected infections per generation from infectious contacts.\n- In a structured mixing model with $n$ age groups, let $C$ be an $n \\times n$ nonnegative contact matrix whose entry $C_{ij}$ is the average number of infectious contacts from a person in group $j$ to recipients in group $i$ over one infectious period. Let $\\lambda$ be a nonnegative scalar equal to the product of per-contact transmission probability and infectious period length, and let $S_i$ be the susceptible fraction in recipient group $i$ after vaccination. Then the post-vaccination next-generation matrix is nonnegative and its largest eigenvalue gives $R_e$.\n\nTask:\n- For each test case, compute the Effective Reproduction Number $R_e$ as the largest eigenvalue of the post-vaccination next-generation matrix.\n- Identify the single age group (by zero-based index) that contributes most to residual transmission in the early exponential phase, defined as the source age group $j$ that maximizes the quantity $v_j \\sum_{i=1}^{n} K_{ij}$, where $K$ is the post-vaccination next-generation matrix and $v$ is the dominant right eigenvector of $K$ normalized to have entries summing to $1$. If there is a tie, choose the smallest index.\n- All coverage inputs are decimals in $[0,1]$. No physical units are required for outputs; $R_e$ is dimensionless.\n\nDefinitions and construction requirements:\n- The susceptible fraction in recipient group $i$ after vaccination is $S_i = 1 - e_s \\cdot c_i$, where $c_i$ is the coverage in group $i$ expressed as a decimal (between $0$ and $1$) and $e_s$ is the vaccine efficacy against susceptibility (also a decimal in $[0,1]$).\n- The post-vaccination next-generation matrix is $$K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C,$$ where $\\operatorname{diag}(S)$ is the diagonal matrix with entries $S_1,\\dots,S_n$.\n- The Effective Reproduction Number is $$R_e = \\rho(K),$$ the largest eigenvalue of $K$.\n- Let $v$ be the dominant right eigenvector of $K$ associated with $R_e$, chosen real and normalized so that $\\sum_{i=1}^{n} v_i = 1$. The residual transmission contribution of source group $j$ is $$\\text{contrib}_j = v_j \\cdot \\sum_{i=1}^{n} K_{ij}.$$ The group with the largest $\\text{contrib}_j$ is the answer for that test case.\n\nInput to be hardcoded by the program (the test suite):\nFor each test case, the program is given the tuple $(C, c, e_s, \\lambda)$ with:\n- $C$: a list of lists representing an $n \\times n$ contact matrix,\n- $c$: a list of length $n$ with coverage decimals,\n- $e_s$: a decimal efficacy against susceptibility,\n- $\\lambda$: a nonnegative scalar equal to per-contact transmission probability multiplied by infectious period length.\n\nTest cases:\n1. General case (three age groups, moderate uptake and high efficacy):\n   - $C = \\begin{bmatrix} 8.0 & 3.0 & 1.0 \\\\ 2.0 & 10.0 & 2.5 \\\\ 1.5 & 2.0 & 6.0 \\end{bmatrix}$,\n   - $c = [0.9, 0.7, 0.5]$,\n   - $e_s = 0.95$,\n   - $\\lambda = 0.08$.\n2. Boundary case (efficacy is zero; vaccination has no effect):\n   - $C = \\begin{bmatrix} 8.0 & 3.0 & 1.0 \\\\ 2.0 & 10.0 & 2.5 \\\\ 1.5 & 2.0 & 6.0 \\end{bmatrix}$,\n   - $c = [0.5, 0.5, 0.5]$,\n   - $e_s = 0.0$,\n   - $\\lambda = 0.08$.\n3. Four-group case (high coverage in a high-contact group, high efficacy):\n   - $C = \\begin{bmatrix} 12.0 & 2.0 & 1.0 & 0.5 \\\\ 3.0 & 9.0 & 3.0 & 1.0 \\\\ 1.0 & 2.0 & 8.0 & 2.0 \\\\ 0.5 & 1.0 & 1.5 & 5.0 \\end{bmatrix}$,\n   - $c = [0.3, 0.95, 0.2, 0.2]$,\n   - $e_s = 0.90$,\n   - $\\lambda = 0.06$.\n4. Near herd-immunity scenario (three groups, very high coverage and high efficacy):\n   - $C = \\begin{bmatrix} 9.0 & 2.5 & 1.0 \\\\ 2.0 & 7.5 & 2.0 \\\\ 1.0 & 1.5 & 6.0 \\end{bmatrix}$,\n   - $c = [0.95, 0.85, 0.80]$,\n   - $e_s = 0.90$,\n   - $\\lambda = 0.08$.\n\nOutput specification:\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets.\n- Each result must be a list with two elements: the first is the float $R_e$, and the second is the integer index (zero-based) of the age group that contributes most to residual transmission according to the criterion above.\n- Example formatting: [[Re_case1,idx_case1],[Re_case2,idx_case2],[Re_case3,idx_case3],[Re_case4,idx_case4]].",
            "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of mathematical epidemiology, well-posed with a clear and complete set of definitions and data, and objective in its formulation. It requires the application of linear algebra to a standard model of infectious disease transmission in a structured population. The following solution implements the specified methodology.\n\nThe core of the problem is to analyze the impact of a targeted vaccination campaign on the transmission dynamics of an infectious disease. The model operates on a population stratified into $n$ distinct age groups. The transmission dynamics in the early, exponential growth phase of an epidemic are governed by a next-generation matrix, denoted here as $K$.\n\nFirst, we define the components required to construct the post-vaccination next-generation matrix $K$.\nThe susceptible fraction in each age group $i$, denoted $S_i$, is determined by the vaccination coverage $c_i$ and the vaccine's efficacy against susceptibility $e_s$. The formula is given as:\n$$S_i = 1 - e_s \\cdot c_i$$\nThis formula represents a \"leaky\" vaccine model, where vaccination reduces but does not necessarily eliminate susceptibility. The values $S_i$ for $i=1, \\dots, n$ can be collected into a diagonal matrix, $\\operatorname{diag}(S)$, where the diagonal entry $(i,i)$ is $S_i$ and all off-diagonal entries are $0$.\n\nThe transmission process itself is described by two components: a contact matrix $C$ and a scalar transmission parameter $\\lambda$. The entry $C_{ij}$ of the $n \\times n$ matrix $C$ represents the rate of effective contact made by an infectious individual in group $j$ with individuals in group $i$. The scalar $\\lambda$ incorporates the probability of transmission per contact and the duration of infectiousness.\n\nThe post-vaccination next-generation matrix $K$ is constructed by combining these elements. The element $K_{ij}$ represents the average number of new infections in group $i$ produced by a single infectious individual in group $j$ in a partially vaccinated population. The matrix $K$ is given by:\n$$K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C$$\n\nThe Effective Reproduction Number, $R_e$, is a threshold quantity that determines whether an epidemic can grow. If $R_e > 1$, the number of infected individuals will increase, whereas if $R_e < 1$, the epidemic will decline. For the class of models used here, $R_e$ is defined as the spectral radius of the next-generation matrix $K$:\n$$R_e = \\rho(K)$$\nSince $K$ is a non-negative matrix (as $\\lambda \\ge 0$, $S_i \\in [0, 1]$, and $C$ is non-negative), the Perron-Frobenius theorem guarantees that its spectral radius $\\rho(K)$ is a real, non-negative eigenvalue, and that there exists a corresponding non-negative right eigenvector $v$. This eigenvector, known as the dominant right eigenvector, is unique up to scaling if $K$ is irreducible. The entries of $v$, after normalization, represent the relative proportions of infectious individuals in each age group during the exponential growth phase.\n\nTo identify which age group contributes most to the remaining transmission, we use the quantity $\\text{contrib}_j$. This metric for each source group $j$ is defined as:\n$$\\text{contrib}_j = v_j \\cdot \\sum_{i=1}^{n} K_{ij}$$\nHere, $v$ is the dominant right eigenvector of $K$ normalized such that its entries sum to $1$ (i.e., $\\sum_{i=1}^{n} v_i = 1$). The term $\\sum_{i=1}^{n} K_{ij}$ is the sum of the $j$-th column of $K$ and represents the total number of secondary infections generated by a single infectious individual in group $j$. The metric $\\text{contrib}_j$ therefore weighs this reproductive output by the relative prevalence of infectiousness in group $j$ ($v_j$), giving a measure of the total transmission originating from that group. The group with the largest value of $\\text{contrib}_j$ is identified as the primary driver of residual transmission.\n\nThe computational procedure for each test case is as follows:\n1. Given $C$, $c$, $e_s$, and $\\lambda$, compute the vector of susceptible fractions $S$ where $S_i = 1 - e_s \\cdot c_i$.\n2. Construct the next-generation matrix $K = \\lambda \\cdot \\operatorname{diag}(S) \\cdot C$.\n3. Compute the eigenvalues and right eigenvectors of $K$.\n4. Identify the largest eigenvalue, which is $R_e = \\rho(K)$.\n5. Find the corresponding dominant right eigenvector $v$. Since the eigenvector returned by numerical libraries may be complex and have an arbitrary sign or normalization, its real part is taken, and its elements are made non-negative (e.g., by taking absolute values).\n6. Normalize the eigenvector $v$ such that its elements sum to $1$.\n7. For each group $j$ (from $0$ to $n-1$), calculate the total secondary infections $\\sum_{i=1}^{n} K_{ij}$ by summing the columns of $K$.\n8. Calculate the contribution of each group $\\text{contrib}_j$ using the formula above.\n9. Determine the index $j$ that maximizes $\\text{contrib}_j$. In case of a tie, the smallest index is chosen.\n10. The final output for the test case is the pair $[R_e, \\text{index}]$.\nThis algorithm is applied to each of the provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the epidemiological problem for a set of test cases.\n    For each case, it computes the Effective Reproduction Number (R_e) and\n    identifies the age group contributing most to residual transmission.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            [[8.0, 3.0, 1.0], [2.0, 10.0, 2.5], [1.5, 2.0, 6.0]],\n            [0.9, 0.7, 0.5],\n            0.95,\n            0.08,\n        ),\n        (\n            [[8.0, 3.0, 1.0], [2.0, 10.0, 2.5], [1.5, 2.0, 6.0]],\n            [0.5, 0.5, 0.5],\n            0.0,\n            0.08,\n        ),\n        (\n            [\n                [12.0, 2.0, 1.0, 0.5],\n                [3.0, 9.0, 3.0, 1.0],\n                [1.0, 2.0, 8.0, 2.0],\n                [0.5, 1.0, 1.5, 5.0],\n            ],\n            [0.3, 0.95, 0.2, 0.2],\n            0.90,\n            0.06,\n        ),\n        (\n            [[9.0, 2.5, 1.0], [2.0, 7.5, 2.0], [1.0, 1.5, 6.0]],\n            [0.95, 0.85, 0.80],\n            0.90,\n            0.08,\n        ),\n    ]\n\n    results = []\n    for C_list, c_list, e_s, lambda_val in test_cases:\n        # Convert inputs to numpy arrays for matrix operations\n        C = np.array(C_list, dtype=float)\n        c = np.array(c_list, dtype=float)\n        n = C.shape[0]\n\n        # 1. Calculate the vector of susceptible fractions, S\n        S_vec = 1.0 - e_s * c\n        S_diag = np.diag(S_vec)\n\n        # 2. Construct the post-vaccination next-generation matrix, K\n        K = lambda_val * S_diag @ C\n\n        # 3. Compute eigenvalues and right eigenvectors of K\n        eigenvalues, eigenvectors = np.linalg.eig(K)\n\n        # 4. R_e is the largest eigenvalue (spectral radius)\n        # For non-negative matrices, the spectral radius is real and is the max of the real parts.\n        R_e = np.max(np.real(eigenvalues))\n\n        # 5. Find the dominant right eigenvector v\n        # It corresponds to the largest eigenvalue.\n        dominant_eigenvalue_idx = np.argmax(np.real(eigenvalues))\n        v = eigenvectors[:, dominant_eigenvalue_idx]\n        \n        # The eigenvector should be real and non-negative for a non-negative matrix.\n        # We take the absolute value of the real part to handle potential numerical artifacts.\n        v = np.abs(np.real(v))\n\n        # 6. Normalize v such that its elements sum to 1\n        v_normalized = v / np.sum(v)\n\n        # 7. Compute the column sums of K\n        # This represents the total number of secondary infections per infected person in each group j\n        col_sums_K = np.sum(K, axis=0)\n\n        # 8. Calculate the contribution of each group\n        # contrib_j = v_normalized_j * sum(K_ij for i in 1..n)\n        contributions = v_normalized * col_sums_K\n\n        # 9. Find the index of the group with the maximum contribution\n        # np.argmax returns the smallest index in case of a tie.\n        max_contrib_idx = np.argmax(contributions)\n\n        # 10. Store the results for this case\n        results.append([R_e, int(max_contrib_idx)])\n\n    # Final print statement in the exact required format.\n    # The format [[val1, val2], [val3, val4]] is created by default python list string representation.\n    print(f\"{results}\")\n\nsolve()\n```"
        }
    ]
}