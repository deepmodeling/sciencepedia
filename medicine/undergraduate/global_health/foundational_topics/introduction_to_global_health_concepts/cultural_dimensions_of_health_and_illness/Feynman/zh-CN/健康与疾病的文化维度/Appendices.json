{
    "hands_on_practices": [
        {
            "introduction": "在全球健康领域，理解个人为何选择某种医疗方式而非另一种至关重要。本练习运用理性选择理论，构建了一个量化模型，用以分析患者在生物医学和传统医学之间的决策过程。通过这个练习，你将学会如何将文化价值观（体现为“道德可接受性”）与经济成本和感知效果等因素相结合，从而洞察在特定文化背景下，影响个体健康寻求行为的复杂动态。这个模型化的方法，为我们提供了一个将抽象文化概念转化为具体、可分析变量的框架。",
            "id": "4971360",
            "problem": "一位社区健康研究员正在使用理性选择理论，模拟在文化约束下患者如何在生物医学护理和传统护理之间做出选择。对于每位患者和每种疗法 $k \\in \\{\\text{biomedical}, \\text{traditional}\\}$，定义效用\n$$\nU_k \\;=\\; \\alpha E_k \\;-\\; \\beta C_k \\;+\\; \\gamma M_k,\n$$\n其中 $E_k$ 是在 $[0,1]$ 范围内的感知功效，$C_k$ 是以当地货币单位计算的自付货币成本，$M_k$ 是根据经过验证的文化价值观量表得出的在 $[0,1]$ 范围内的道德可接受性。参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 是严格为正的权重，分别量化了患者对感知功效的重视程度、对成本的厌恶程度以及对道德可接受性的重视程度，所有这些都以效用单位衡量。假设每位患者都选择效用较高的疗法。\n\n假设在一个具有强大祖先治疗传统的特定地区，以下基于经验的分布假设对所有患者的六个决定因素均成立，并且所有六个随机变量都是相互独立的：\n- 生物医学护理的感知功效：$E_{\\text{biomedical}} \\sim \\mathcal{N}(\\mu_{E_b}, \\sigma_{E_b}^2)$，其中 $\\mu_{E_b} = 0.72$，$\\sigma_{E_b} = 0.15$。\n- 传统护理的感知功效：$E_{\\text{traditional}} \\sim \\mathcal{N}(\\mu_{E_t}, \\sigma_{E_t}^2)$，其中 $\\mu_{E_t} = 0.56$，$\\sigma_{E_t} = 0.20$。\n- 生物医学护理的道德可接受性：$M_{\\text{biomedical}} \\sim \\mathcal{N}(\\mu_{M_b}, \\sigma_{M_b}^2)$，其中 $\\mu_{M_b} = 0.41$，$\\sigma_{M_b} = 0.25$。\n- 传统护理的道德可接受性：$M_{\\text{traditional}} \\sim \\mathcal{N}(\\mu_{M_t}, \\sigma_{M_t}^2)$，其中 $\\mu_{M_t} = 0.80$，$\\sigma_{M_t} = 0.15$。\n- 生物医学护理的自付成本：$C_{\\text{biomedical}} \\sim \\mathcal{N}(\\mu_{C_b}, \\sigma_{C_b}^2)$，其中 $\\mu_{C_b} = 22$，$\\sigma_{C_b} = 10$。\n- 传统护理的自付成本：$C_{\\text{traditional}} \\sim \\mathcal{N}(\\mu_{C_t}, \\sigma_{C_t}^2)$，其中 $\\mu_{C_t} = 7$，$\\sigma_{C_t} = 3$。\n\n在该地区，根据文化背景估算的效用权重为：$\\alpha = 10$ 效用单位/功效点，$\\beta = 0.05$ 效用单位/货币单位，以及 $\\gamma = 8$ 效用单位/道德可接受性点。\n\n任务：\n- 从定义和理性选择原则（选择效用更高的备选项）出发，推导出选择生物医学护理而非传统护理的决策条件，该条件为一个不等式，其中包含一个单一随机变量，该变量是感知功效、成本和道德可接受性差异的线性组合。\n- 仅使用独立正态分布变量之和与差的经过充分检验的性质，推导出该决策变量的分布，并计算该地区随机选择的一名患者选择生物医学护理的概率。\n\n将最终概率以 $0$ 和 $1$ 之间的小数形式报告，四舍五入到四位有效数字。不要使用百分号。概率不需要物理单位。",
            "solution": "该问题被认为是有效的，因为它在科学上基于理性选择理论和概率论，其设定完整且一致，提法得当，并以客观语言表达。在定量社会科学建模中，使用正态分布来模拟有界变量是一种常见且可接受的理想化方法，定义范围之外的概率质量足够小，不会使此类练习的问题前提失效。\n\n任务是计算随机选择的一名患者选择生物医学护理而非传统护理的概率。根据理性选择原则，患者会选择效用更高的疗法。设生物医学护理的效用为 $U_b$，传统护理的效用为 $U_t$。当且仅当 $U_b > U_t$ 时，患者会选择生物医学护理。\n\n每种疗法 $k \\in \\{\\text{biomedical}, \\text{traditional}\\}$ 的效用由以下方程给出：\n$$\nU_k = \\alpha E_k - \\beta C_k + \\gamma M_k\n$$\n其中 $E_k$ 是感知功效，$C_k$ 是自付成本，$M_k$ 是道德可接受性。参数 $\\alpha$、$\\beta$ 和 $\\gamma$ 是正权重。\n\n为分析该选择，我们定义一个决策变量 $D$ 作为效用差：\n$$\nD = U_b - U_t\n$$\n选择生物医学护理的条件 $U_b > U_t$ 变为 $D > 0$。\n\n代入 $U_b$ 和 $U_t$ 的表达式，我们可以将 $D$ 写成基础随机变量的线性组合：\n$$\nD = (\\alpha E_b - \\beta C_b + \\gamma M_b) - (\\alpha E_t - \\beta C_t + \\gamma M_t)\n$$\n重新整理各项，我们按权重参数将它们分组：\n$$\nD = \\alpha(E_b - E_t) - \\beta(C_b - C_t) + \\gamma(M_b - M_t)\n$$\n该表达式将决策变量表示为功效、成本和道德可接受性差异的线性组合，完成了任务的第一部分。\n\n问题陈述所有六个随机变量（$E_b, E_t, C_b, C_t, M_b, M_t$）都是相互独立且呈正态分布的。正态分布的一个基本性质是，独立正态随机变量的任何线性组合也是一个正态随机变量。因此，决策变量 $D$ 呈正态分布，即 $D \\sim \\mathcal{N}(\\mu_D, \\sigma_D^2)$。我们需要确定其均值 $\\mu_D$ 和方差 $\\sigma_D^2$。\n\n$D$ 的均值可利用期望算子的线性性质求得：\n$$\n\\mu_D = E[D] = E[\\alpha(E_b - E_t) - \\beta(C_b - C_t) + \\gamma(M_b - M_t)]\n$$\n$$\n\\mu_D = \\alpha(E[E_b] - E[E_t]) - \\beta(E[C_b] - E[C_t]) + \\gamma(E[M_b] - E[M_t])\n$$\n代入给定的均值：\n$$\n\\mu_D = \\alpha(\\mu_{E_b} - \\mu_{E_t}) - \\beta(\\mu_{C_b} - \\mu_{C_t}) + \\gamma(\\mu_{M_b} - \\mu_{M_t})\n$$\n$D$ 的方差可利用独立随机变量线性组合的方差性质求得。对于独立变量 $X$ 和 $Y$ 以及常数 $a$ 和 $b$，$\\text{Var}(aX+bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y)$。\n$$\n\\sigma_D^2 = \\text{Var}(D) = \\text{Var}(\\alpha E_b - \\alpha E_t - \\beta C_b + \\beta C_t + \\gamma M_b - \\gamma M_t)\n$$\n由于独立性，和的方差等于方差的和：\n$$\n\\sigma_D^2 = \\alpha^2 \\text{Var}(E_b) + (-\\alpha)^2 \\text{Var}(E_t) + (-\\beta)^2 \\text{Var}(C_b) + \\beta^2 \\text{Var}(C_t) + \\gamma^2 \\text{Var}(M_b) + (-\\gamma)^2 \\text{Var}(M_t)\n$$\n$$\n\\sigma_D^2 = \\alpha^2(\\sigma_{E_b}^2 + \\sigma_{E_t}^2) + \\beta^2(\\sigma_{C_b}^2 + \\sigma_{C_t}^2) + \\gamma^2(\\sigma_{M_b}^2 + \\sigma_{M_t}^2)\n$$\n现在，我们代入给定的数值：\n参数： $\\alpha = 10$, $\\beta = 0.05$, $\\gamma = 8$。\n均值： $\\mu_{E_b} = 0.72$, $\\mu_{E_t} = 0.56$, $\\mu_{C_b} = 22$, $\\mu_{C_t} = 7$, $\\mu_{M_b} = 0.41$, $\\mu_{M_t} = 0.80$。\n标准差： $\\sigma_{E_b} = 0.15$, $\\sigma_{E_t} = 0.20$, $\\sigma_{C_b} = 10$, $\\sigma_{C_t} = 3$, $\\sigma_{M_b} = 0.25$, $\\sigma_{M_t} = 0.15$。\n方差： $\\sigma_{E_b}^2 = 0.15^2 = 0.0225$, $\\sigma_{E_t}^2 = 0.20^2 = 0.04$, $\\sigma_{C_b}^2 = 10^2 = 100$, $\\sigma_{C_t}^2 = 3^2 = 9$, $\\sigma_{M_b}^2 = 0.25^2 = 0.0625$, $\\sigma_{M_t}^2 = 0.15^2 = 0.0225$。\n\n计算均值 $\\mu_D$：\n$$\n\\mu_D = 10(0.72 - 0.56) - 0.05(22 - 7) + 8(0.41 - 0.80)\n$$\n$$\n\\mu_D = 10(0.16) - 0.05(15) + 8(-0.39)\n$$\n$$\n\\mu_D = 1.6 - 0.75 - 3.12 = -2.27\n$$\n计算方差 $\\sigma_D^2$：\n$$\n\\sigma_D^2 = 10^2(0.15^2 + 0.20^2) + 0.05^2(10^2 + 3^2) + 8^2(0.25^2 + 0.15^2)\n$$\n$$\n\\sigma_D^2 = 100(0.0225 + 0.04) + 0.0025(100 + 9) + 64(0.0625 + 0.0225)\n$$\n$$\n\\sigma_D^2 = 100(0.0625) + 0.0025(109) + 64(0.085)\n$$\n$$\n\\sigma_D^2 = 6.25 + 0.2725 + 5.44 = 11.9625\n$$\n因此，决策变量的分布为 $D \\sim \\mathcal{N}(-2.27, 11.9625)$。标准差为 $\\sigma_D = \\sqrt{11.9625}$。\n\n患者选择生物医学护理的概率为 $P(D>0)$。我们通过定义一个标准正态变量 $Z = \\frac{D - \\mu_D}{\\sigma_D} \\sim \\mathcal{N}(0, 1)$ 来标准化此概率。\n不等式 $D > 0$ 等价于 $D - \\mu_D > -\\mu_D$，并进一步等价于 $\\frac{D - \\mu_D}{\\sigma_D} > \\frac{-\\mu_D}{\\sigma_D}$。\n因此，我们需要计算 $P(Z > -\\frac{\\mu_D}{\\sigma_D})$。\n设 $\\Phi(z)$ 为标准正态分布的累积分布函数（CDF），即 $\\Phi(z) = P(Z \\le z)$。那么 $P(Z>z) = 1 - \\Phi(z)$。\nCDF的自变量为：\n$$\n-\\frac{\\mu_D}{\\sigma_D} = -\\frac{-2.27}{\\sqrt{11.9625}} \\approx \\frac{2.27}{3.45868} \\approx 0.65633\n$$\n所以概率是：\n$$\nP(D>0) = P(Z > 0.65633) = 1 - P(Z \\le 0.65633) = 1 - \\Phi(0.65633)\n$$\n使用标准正态分布表或计算器，$\\Phi(0.65633) \\approx 0.744167$。\n$$\nP(D>0) \\approx 1 - 0.744167 = 0.255833\n$$\n将最终结果四舍五入到四位有效数字，我们得到 $0.2558$。",
            "answer": "$$\\boxed{0.2558}$$"
        },
        {
            "introduction": "在理解了个体层面的决策之后，我们需要将视野扩展到群体层面，评估文化因素对公共卫生的总体影响。本练习引入了“人群归因分数”（Population Attributable Fraction, PAF）这一核心流行病学工具，用以量化由特定风险因素（如此处的污名化态度）导致的疾病负担。通过计算和比较两种不同文化情境下的PAF，你将清晰地看到，即使个体层面的风险（由比值比$OR$衡量）保持不变，文化背景中风险因素的流行程度仍会极大地改变其对整个群体健康状况的最终影响。该练习强调了在制定公共卫生政策时，考虑文化背景流行率的重要性。",
            "id": "4971534",
            "problem": "一名研究人员正在评估对人类免疫缺陷病毒（HIV）的污名化态度的文化流行程度如何影响抗逆转录病毒疗法的依从性。在两种文化背景中，假设污名对不依从性的因果效应是不变的，依从性的测量是一致的，并且在基础研究中混杂因素已得到充分控制。\n\n现给出以下经经验支持的量：\n- 比较遭受HIV相关污名的个体与未遭受污名的个体，其不依从性的比值比（OR）为 $\\text{OR} = 1.8$。\n- 在未遭受污名的个体中，不依从性的基线概率为 $p_{0} = 0.28$。\n\n考虑两种文化情景，这两种情景在HIV感染者中污名化态度的流行程度上有所不同：\n- 情景H（高污名文化）：暴露流行率为 $p_{e,H} = 0.65$。\n- 情景L（较低污名文化）：暴露流行率为 $p_{e,L} = 0.30$。\n\n从优势、比值比和人群归因分数（PAF）的基本定义出发，按以下步骤进行：\n1. 使用优势和比值比的定义，用 $\\text{OR}$ 和 $p_{0}$ 表示暴露组不依从的风险 $p_{1}$。\n2. 使用 $p_{1}$ 和 $p_{0}$，求出有污名与无污名相比的不依从性相对风险 $\\text{RR}$。\n3. 根据定义 $PAF = \\dfrac{\\text{risk in the actual population} - \\text{risk if exposure were eliminated}}{\\text{risk in the actual population}}$，在暴露流行率为 $p_{e}$ 的人群中推导人群归因分数（PAF）的表达式，假设消除暴露会使暴露风险等于非暴露风险。\n4. 计算情景H的 $PAF_{H}$ 和情景L的 $PAF_{L}$。\n5. 以小数形式报告单个标量值 $\\Delta = PAF_{H} - PAF_{L}$。\n\n将 $\\Delta$ 的最终答案四舍五入到四位有效数字。无需单位，并将结果表示为小数（不使用百分号）。",
            "solution": "首先需要对问题的科学性和逻辑一致性进行验证。\n\n### 第1步：提取已知条件\n问题提供了以下量和条件：\n- 不依从性的比值比（污名 vs. 无污名）：$\\text{OR} = 1.8$。\n- 不依从性的基线概率（非暴露组风险）：$p_{0} = 0.28$。\n- 情景H（高污名文化）中的暴露流行率（污名）：$p_{e,H} = 0.65$。\n- 情景L（较低污名文化）中的暴露流行率（污名）：$p_{e,L} = 0.30$。\n- 假设：污名的因果效应不变，测量一致性，且混杂因素已得到控制。\n- 人群归因分数（PAF）的定义：$\\text{PAF} = \\dfrac{\\text{risk in the actual population} - \\text{risk if exposure were eliminated}}{\\text{risk in the actual population}}$。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估：\n- **科学依据**：该问题使用了流行病学和生物统计学中标准的、明确定义的度量（比值比、相对风险、人群归因分数），并基于一个现实的公共卫生情景。所提供的数值是合理的。\n- **良构问题**：该问题是良构的。它提供了所有必要的数据和定义，可以通过一系列逻辑计算得出一个唯一的解。所述的假设（不变性、测量一致性、无混杂）对于确保问题是自足且可解的是至关重要的。\n- **客观性**：语言精确且无偏见。它基于所提供的数据提出了一个定量问题。\n\n问题陈述没有科学上的不健全、信息缺失或模糊不清之处。这是一个应用流行病学原理的标准练习。\n\n### 结论\n该问题有效。可以构建一个分步的解决方案。\n\n### 解题推导\n\n解题过程遵循问题陈述中概述的五个步骤。\n\n#### 1. 用 $\\text{OR}$ 和 $p_{0}$ 表示暴露组的风险 $p_{1}$。\n概率为 $p$ 的事件的优势定义为 $\\text{odds} = \\frac{p}{1-p}$。\n非暴露组（无污名）中不依从性的优势为 $\\text{odds}_{0} = \\frac{p_{0}}{1-p_{0}}$。\n暴露组（有污名）中不依从性的优势为 $\\text{odds}_{1} = \\frac{p_{1}}{1-p_{1}}$。\n比值比（$\\text{OR}$）是这些优势的比率：\n$$ \\text{OR} = \\frac{\\text{odds}_{1}}{\\text{odds}_{0}} $$\n根据这个定义，我们可以将 $\\text{odds}_{1}$ 表示为：\n$$ \\text{odds}_{1} = \\text{OR} \\times \\text{odds}_{0} = \\text{OR} \\times \\frac{p_{0}}{1-p_{0}} $$\n现在，我们从 $\\text{odds}_{1}$ 的定义中求解 $p_{1}$：\n$$ \\frac{p_{1}}{1-p_{1}} = \\text{OR} \\times \\frac{p_{0}}{1-p_{0}} $$\n为简化起见，令 $K = \\text{OR} \\times \\frac{p_{0}}{1-p_{0}}$。则 $\\frac{p_{1}}{1-p_{1}} = K$。\n求解 $p_{1}$：\n$p_{1} = K(1-p_{1}) = K - Kp_{1}$\n$p_{1} + Kp_{1} = K$\n$p_{1}(1+K) = K$\n$p_{1} = \\frac{K}{1+K}$\n将 $K$ 的表达式代回，得到 $p_{1}$ 的所需表达式：\n$$ p_{1} = \\frac{\\text{OR} \\frac{p_{0}}{1-p_{0}}}{1 + \\text{OR} \\frac{p_{0}}{1-p_{0}}} $$\n\n#### 2. 求出相对风险 $\\text{RR}$。\n首先，我们使用给定的数据计算 $p_{1}$ 的数值：$\\text{OR} = 1.8$ 和 $p_{0} = 0.28$。\n非暴露组的优势为：\n$$ \\text{odds}_{0} = \\frac{0.28}{1 - 0.28} = \\frac{0.28}{0.72} = \\frac{28}{72} = \\frac{7}{18} $$\n暴露组的优势为：\n$$ \\text{odds}_{1} = \\text{OR} \\times \\text{odds}_{0} = 1.8 \\times \\frac{7}{18} = \\frac{18}{10} \\times \\frac{7}{18} = \\frac{7}{10} = 0.7 $$\n现在，我们从 $\\text{odds}_{1}$ 中求出 $p_{1}$：\n$$ p_{1} = \\frac{\\text{odds}_{1}}{1 + \\text{odds}_{1}} = \\frac{0.7}{1 + 0.7} = \\frac{0.7}{1.7} = \\frac{7}{17} $$\n相对风险（$\\text{RR}$）是暴露组风险与非暴露组风险的比值：\n$$ \\text{RR} = \\frac{p_{1}}{p_{0}} = \\frac{7/17}{0.28} = \\frac{7/17}{28/100} = \\frac{7}{17} \\times \\frac{100}{28} = \\frac{1}{17} \\times \\frac{100}{4} = \\frac{25}{17} $$\n\n#### 3. 推导人群归因分数（PAF）的表达式。\n问题将 PAF 定义为：\n$$ \\text{PAF} = \\frac{\\text{risk in the actual population} - \\text{risk if exposure were eliminated}}{\\text{risk in the actual population}} $$\n在暴露流行率为 $p_{e}$ 的实际人群中，风险是结果的总概率。这是暴露组（$p_{1}$）和非暴露组（$p_{0}$）风险的加权平均值：\n$$ \\text{risk}_{\\text{total}} = p_{1} p_{e} + p_{0}(1 - p_{e}) $$\n如果暴露被消除，风险是整个人群都未暴露时的风险水平，即 $p_0$。\n$$ \\text{risk}_{\\text{counterfactual}} = p_{0} $$\n将这些代入 PAF 的定义中：\n$$ \\text{PAF} = \\frac{(p_{1} p_{e} + p_{0}(1 - p_{e})) - p_{0}}{p_{1} p_{e} + p_{0}(1 - p_{e})} $$\n简化分子：\n$$ (p_{1} p_{e} + p_{0} - p_{0} p_{e}) - p_{0} = p_{1} p_{e} - p_{0} p_{e} = p_{e}(p_{1} - p_{0}) $$\n所以，PAF 的表达式为：\n$$ \\text{PAF} = \\frac{p_{e}(p_{1} - p_{0})}{p_{1} p_{e} + p_{0}(1 - p_{e})} $$\n一个更常见的形式，称为Levin公式，是通过将分子和分母同时除以 $p_{0}$ 并使用 $\\text{RR} = p_1/p_0$ 推导出来的：\n$$ \\text{PAF} = \\frac{p_{e}(\\frac{p_{1}}{p_{0}} - 1)}{\\frac{p_{1}}{p_{0}} p_{e} + (1 - p_{e})} = \\frac{p_{e}(\\text{RR} - 1)}{\\text{RR} p_{e} + 1 - p_{e}} = \\frac{p_{e}(\\text{RR} - 1)}{1 + p_{e}(\\text{RR} - 1)} $$\n\n#### 4. 计算 $PAF_{H}$ 和 $PAF_{L}$。\n我们使用推导出的 PAF 公式，其中 $\\text{RR} = \\frac{25}{17}$。$\\text{RR} - 1$ 项为：\n$$ \\text{RR} - 1 = \\frac{25}{17} - 1 = \\frac{25-17}{17} = \\frac{8}{17} $$\n对于情景H（高污名），$p_{e,H} = 0.65$：\n$$ \\text{PAF}_{H} = \\frac{p_{e,H}(\\text{RR} - 1)}{1 + p_{e,H}(\\text{RR} - 1)} = \\frac{0.65 \\times \\frac{8}{17}}{1 + 0.65 \\times \\frac{8}{17}} = \\frac{\\frac{13}{20} \\times \\frac{8}{17}}{1 + \\frac{13}{20} \\times \\frac{8}{17}} = \\frac{\\frac{26}{85}}{1 + \\frac{26}{85}} = \\frac{26/85}{111/85} = \\frac{26}{111} $$\n对于情景L（较低污名），$p_{e,L} = 0.30$：\n$$ \\text{PAF}_{L} = \\frac{p_{e,L}(\\text{RR} - 1)}{1 + p_{e,L}(\\text{RR} - 1)} = \\frac{0.30 \\times \\frac{8}{17}}{1 + 0.30 \\times \\frac{8}{17}} = \\frac{\\frac{3}{10} \\times \\frac{8}{17}}{1 + \\frac{3}{10} \\times \\frac{8}{17}} = \\frac{\\frac{12}{85}}{1 + \\frac{12}{85}} = \\frac{12/85}{97/85} = \\frac{12}{97} $$\n\n#### 5. 报告标量值 $\\Delta = PAF_{H} - PAF_{L}$。\n我们计算两个 PAF 值之间的差值。\n$$ \\Delta = \\text{PAF}_{H} - \\text{PAF}_{L} = \\frac{26}{111} - \\frac{12}{97} $$\n为了求得数值，我们使用小数近似值：\n$$ \\text{PAF}_{H} \\approx 0.23423423... $$\n$$ \\text{PAF}_{L} \\approx 0.12371134... $$\n$$ \\Delta \\approx 0.23423423 - 0.12371134 = 0.11052289... $$\n将结果四舍五入到四位有效数字，得到：\n$$ \\Delta \\approx 0.1105 $$",
            "answer": "$$\\boxed{0.1105}$$"
        },
        {
            "introduction": "理解和量化文化影响是基础，但全球健康的最终目标是设计并实施有效的干预措施以改善健康结果。本练习模拟了评估一项“文化适应性信息干预”对传染病爆发影响的真实场景。你将运用基于更新方程的贝叶斯框架来估算随时间变化的再生数（$R_t$），并以此来衡量干预措施的成效。这提供了一个宝贵的实践机会，让你掌握如何使用严谨的流行病学数据分析方法，来验证文化敏感性健康项目在现实世界中是否取得了成功。",
            "id": "4971401",
            "problem": "给定离散的暴发病例时间序列和离散的代际时间分布。你必须使用基于更新方程的贝叶斯共轭框架来估计时变再生数 ($R_t$)，然后量化并检验文化定制信息干预对 $R_t$ 的影响。将干预定义为一个特定日期，届时启动文化上适宜的沟通，从而引发后续的行为改变，进而改变接触模式，影响再生数。你的程序必须从基本原理出发实现以下内容，并生成指定的输出。\n\n基本原理：\n- 传染病传播的更新方程：时间 $t$ 的期望发病数由 $E[I_t] = R_t \\Lambda_t$ 给出，其中 $\\Lambda_t = \\sum_{s=1}^{\\min(S, t-1)} I_{t-s} w_s$ 是由先前病例累积的总传染力，并由代际时间质量函数加权。\n- 似然模型：假设 $I_t \\mid R_t, \\Lambda_t \\sim \\text{Poisson}(R_t \\Lambda_t)$，这是更新过程下病例计数的一个经过充分检验的模型。\n- 共轭先验和后验：Gamma先验 $R_t \\sim \\text{Gamma}(a, b)$（形状参数为 $a$，速率参数为 $b$）产生的后验分布为 $R_t \\mid I_t, \\Lambda_t \\sim \\text{Gamma}(a + I_t, b + \\Lambda_t)$，后验均值为 $\\hat{R}_t = \\dfrac{a + I_t}{b + \\Lambda_t}$。\n\n估计与检验任务：\n1. 对每一天 $t$，使用给定的 $I_t$ 和 $w_s$ 计算 $\\Lambda_t$。\n2. 对每一天 $t$，使用所述的共轭更新方法计算后验均值 $\\hat{R}_t$。\n3. 给定干预日 $d$、延迟 $\\ell$（以考虑行为改变和报告延迟）以及窗口长度 $W$，将干预前窗口定义为第 $[d - W + 1, d]$ 天，干预后窗口定义为第 $[d + \\ell + 1, d + \\ell + W]$ 天。使用这些窗口内的 $\\hat{R}_t$ 值计算效应量：\n   $$\\Delta = \\frac{\\overline{R}_{\\text{post}} - \\overline{R}_{\\text{pre}}}{\\overline{R}_{\\text{pre}}},$$\n   其中 $\\overline{R}_{\\text{pre}}$ 和 $\\overline{R}_{\\text{post}}$ 分别是各自窗口中 $\\hat{R}_t$ 的算术平均值。将 $\\Delta$ 表示为小数（而非百分号）。\n4. 使用 Welch's 双样本t检验（不等方差）检验原假设，即干预前和干预后 $\\hat{R}_t$ 窗口的均值相等。计算 $p$ 值，并使用 $p  \\alpha$（其中 $\\alpha$ 是给定的显著性阈值）确定统计显著性（布尔值）。\n\n输出规范：\n- 对于每个测试用例，输出一个列表 $[\\Delta, p, \\text{significant}]$，其中 $\\Delta$ 是浮点数，$p$ 是浮点数，$\\text{significant}$ 是通过 $p  \\alpha$ 计算得出的布尔值。\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，每个测试用例对应一个内部列表。例如： $[[\\Delta_1, p_1, \\text{True}],[\\Delta_2, p_2, \\text{False}],[\\Delta_3, p_3, \\text{True}]]$.\n\n测试套件：\n使用以下参数集。描述中的所有索引都是基于1的，但在代码中为基于0的数组实现时请务必小心。\n\n- 公共的代际时间质量函数 $w$，$S = 7$：$w = [0.06, 0.12, 0.18, 0.22, 0.22, 0.12, 0.08]$。其和为 $1.00$。\n- 公共的先验参数：$a = 1$，$b = 5$。\n\n测试用例1（信息传递效果明显）：\n- 病例序列 $I$: $[5, 7, 9, 12, 15, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 45, 43, 41, 38, 35, 32, 29, 26, 23, 20, 18, 16, 14, 12, 10, 8, 7, 6, 5, 4]$。\n- 干预日 $d = 20$。\n- 延迟 $\\ell = 5$。\n- 窗口长度 $W = 7$。\n- 显著性阈值 $\\alpha = 0.05$。\n\n测试用例2（无明显效果）：\n- 病例序列 $I$: $[18, 19, 20, 20, 21, 19, 20, 21, 20, 19, 20, 21, 20, 20, 20, 19, 20, 21, 20, 20, 20, 19, 20, 20, 21, 20, 19, 20, 20, 20]$。\n- 干预日 $d = 15$。\n- 延迟 $\\ell = 5$。\n- 窗口长度 $W = 7$。\n- 显著性阈值 $\\alpha = 0.05$。\n\n测试用例3（低计数和零值的边缘情况）：\n- 病例序列 $I$: $[0, 0, 1, 0, 2, 1, 0, 3, 0, 2, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0]$。\n- 干预日 $d = 10$。\n- 延迟 $\\ell = 3$。\n- 窗口长度 $W = 5$。\n- 显著性阈值 $\\alpha = 0.05$。\n\n科学现实性说明：\n文化定制信息可以以符合当地规范的方式改变就医和接触行为，从而改变有效接触率和时变再生数 $R_t$。所构建的测试用例分别代表了可能的下降、无变化以及低计数的边缘情况。\n\n你的程序必须实现上述逻辑并生成单行输出：一个包含三个内部列表的列表，对应三个测试用例，每个内部列表的形式为 $[\\Delta, p, \\text{significant}]$。",
            "solution": "用户提供了一个问题，要求根据暴发数据估计时变再生数 ($R_t$)，并对干预措施的效果进行后续的统计分析。该问题在科学上基于已确立的流行病学原理，在数学上是适定的。所有必要的数据和参数均已提供。因此，该问题是有效的，并将提供一个解决方案。\n\n解决方案分为四个主要步骤：\n1.  计算总传染力 $\\Lambda_t$。\n2.  贝叶斯估计时变再生数 $\\hat{R}_t$。\n3.  计算干预效应量 $\\Delta$。\n4.  对干预效果进行统计假设检验。\n\n在我们的技术描述中，我们将对数组使用基于0的索引，以便与实现保持一致，其中问题描述中的时间 $t$ 对应于索引 $i=t-1$。\n\n**1. 计算总传染力 ($\\Lambda_t$)**\n\n在给定日期 $t$ 的总传染力 $\\Lambda_t$ 是所有先前感染者传染贡献的总和。它通过将过去的发病序列 $I$ 与代际时间分布 $w$ 进行卷积来计算。代际时间分布 $w_s$ 给出了在第0天感染的个体在第 $s$ 天感染他人的概率。给定一个发病序列 $I = [I_0, I_1, \\dots, I_{T-1}]$ 和一个代际时间分布 $w = [w_0, w_1, \\dots, w_{S-1}]$，在时间索引 $i$ 的总传染力 $\\Lambda_i$ 由下式给出：\n$$ \\Lambda_i = \\sum_{s=1}^{\\min(i, S)} I_{i-s} w_{s-1} $$\n其中 $S$ 是最长序列间隔持续时间（$w$ 的长度），$T$ 是发病序列的总持续时间（$I$ 的长度）。该和定义于 $i \\geq 1$。按照惯例，对于第一天 ($i=0$)，没有先前的病例可以贡献传染力，因此 $\\Lambda_0 = 0$。对于随后的每一天 $i  0$，$\\Lambda_i$ 是通过将过去的发病值 $I_{i-s}$ 与相应的代际时间权重 $w_{s-1}$ 的乘积相加来计算的。\n\n**2. 估计时变再生数 ($\\hat{R}_t$)**\n\n问题指定了一个贝叶斯框架来估计 $R_t$。假设第 $t$ 天的新感染人数 $I_t$ 服从泊松分布，其均值等于再生数 $R_t$ 与总传染力 $\\Lambda_t$ 的乘积：\n$$ I_i \\mid R_i, \\Lambda_i \\sim \\text{Poisson}(R_i \\Lambda_i) $$\n选择Gamma分布作为 $R_t$ 的先验，因为它是泊松分布速率参数的共轭先验。这个选择简化了后验计算。先验分布为：\n$$ R_i \\sim \\text{Gamma}(a, b) $$\n其中 $a$ 是形状参数，$b$ 是速率参数。给定观测到的发病数 $I_i$ 和计算出的传染力 $\\Lambda_i$，$R_i$ 的后验分布也是一个Gamma分布，其参数更新为：\n$$ R_i \\mid I_i, \\Lambda_i \\sim \\text{Gamma}(a + I_i, b + \\Lambda_i) $$\n$R_i$ 的点估计值，记为 $\\hat{R}_i$，是该后验分布的均值：\n$$ \\hat{R}_i = E[R_i \\mid I_i, \\Lambda_i] = \\frac{a + I_i}{b + \\Lambda_i} $$\n对每个时间索引 $i = 0, 1, \\dots, T-1$ 执行此计算，从而得到一个再生数估计值的时间序列 $\\hat{R} = [\\hat{R}_0, \\hat{R}_1, \\dots, \\hat{R}_{T-1}]$。\n\n**3. 计算干预效应量 ($\\Delta$)**\n\n为了量化干预的影响，我们比较干预生效前后的平均再生数。干预发生在第 $d$ 天（索引 $d-1$），之后有 $\\ell$ 天的延迟期以便效果显现。我们分析两个长度为 $W$ 的窗口。\n\n-   **干预前窗口**：这包括到第 $d$ 天为止的 $W$ 天。在基于0的索引中，这对应于从 $d-W$ 到 $d-1$ 的索引。\n-   **干预后窗口**：这包括从第 $d+\\ell+1$ 天开始的 $W$ 天。在基于0的索引中，这对应于从 $d+\\ell$ 到 $d+\\ell+W-1$ 的索引。\n\n设这些窗口中的 $\\hat{R}_i$ 值集合分别为 $R_{\\text{pre}}$ 和 $R_{\\text{post}}$。我们计算它们的算术平均值：\n$$ \\overline{R}_{\\text{pre}} = \\frac{1}{W} \\sum_{i \\in \\text{pre-window}} \\hat{R}_i $$\n$$ \\overline{R}_{\\text{post}} = \\frac{1}{W} \\sum_{i \\in \\text{post-window}} \\hat{R}_i $$\n相对变化，即效应量 $\\Delta$，计算如下：\n$$ \\Delta = \\frac{\\overline{R}_{\\text{post}} - \\overline{R}_{\\text{pre}}}{\\overline{R}_{\\text{pre}}} $$\n由于先验参数 $a$ 和 $b$ 为正，且发病数 $I_i$ 为非负，估计量 $\\hat{R}_i = (a+I_i)/(b+\\Lambda_i)$ 总是正的。因此，$\\overline{R}_{\\text{pre}}$ 保证为正，从而避免了除以零的情况。\n\n**4. 假设检验**\n\n为了确定观察到的 $R_t$ 变化是否具有统计显著性，我们执行双样本 Welch's t检验。此检验比较两个独立样本 $R_{\\text{pre}}$ 和 $R_{\\text{post}}$ 的均值，而不假设它们的方差相等。原假设 ($H_0$) 是，在干预前和干预后时期，潜在 $R_t$ 过程的真实均值相等 ($\\mu_{\\text{pre}} = \\mu_{\\text{post}}$)。\n\nWelch's t统计量的计算公式为：\n$$ t = \\frac{\\overline{R}_{\\text{pre}} - \\overline{R}_{\\text{post}}}{\\sqrt{\\frac{s_{\\text{pre}}^2}{W} + \\frac{s_{\\text{post}}^2}{W}}} $$\n其中 $s_{\\text{pre}}^2$ 和 $s_{\\text{post}}^2$ 分别是各自窗口中 $\\hat{R}_i$ 值的样本方差，$W$ 是每个窗口的大小。自由度使用 Welch-Satterthwaite 方程计算。\n\n根据t统计量和自由度，可以获得一个双尾p值。这个p值表示在原假设为真的前提下，观察到至少与计算出的均值差异一样大的差异的概率。如果p值小于预定的显著性水平 $\\alpha$，则认为干预效果具有统计显著性：\n$$ \\text{significant} = (p  \\alpha) $$\n每个测试用例的最终结果是一个三元组 $[\\Delta, p, \\text{significant}]$。此过程将应用于提供的三个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    # Common parameters for all test cases\n    w = np.array([0.06, 0.12, 0.18, 0.22, 0.22, 0.12, 0.08])\n    a = 1.0\n    b = 5.0\n\n    test_cases = [\n        {\n            \"I\": np.array([5, 7, 9, 12, 15, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 45, 43, 41, 38, 35, 32, 29, 26, 23, 20, 18, 16, 14, 12, 10, 8, 7, 6, 5, 4]),\n            \"d\": 20,\n            \"ell\": 5,\n            \"W\": 7,\n            \"alpha\": 0.05,\n        },\n        {\n            \"I\": np.array([18, 19, 20, 20, 21, 19, 20, 21, 20, 19, 20, 21, 20, 20, 20, 19, 20, 21, 20, 20, 20, 19, 20, 20, 21, 20, 19, 20, 20, 20]),\n            \"d\": 15,\n            \"ell\": 5,\n            \"W\": 7,\n            \"alpha\": 0.05,\n        },\n        {\n            \"I\": np.array([0, 0, 1, 0, 2, 1, 0, 3, 0, 2, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0]),\n            \"d\": 10,\n            \"ell\": 3,\n            \"W\": 5,\n            \"alpha\": 0.05,\n        },\n    ]\n\n    def _process_case(I_series, w_dist, a_prior, b_prior, d_day, l_delay, W_window, alpha_sig):\n        \"\"\"\n        Processes a single test case to estimate Rt and test intervention effect.\n        \"\"\"\n        T = len(I_series)\n        S = len(w_dist)\n        \n        # 1. Compute total infectiousness Lambda_t\n        Lambda = np.zeros(T)\n        for i in range(1, T):\n            # Sum over past incidence weighted by generation time distribution\n            # The sum is over s = 1 to min(i, S)\n            # This corresponds to a convolution\n            relevant_I = I_series[max(0, i - S) : i]\n            relevant_w = w_dist[:len(relevant_I)]\n            Lambda[i] = np.dot(relevant_I[::-1], relevant_w)\n\n        # 2. Compute the posterior mean R_hat_t\n        R_hat = (a_prior + I_series) / (b_prior + Lambda)\n\n        # 3. Define pre- and post-intervention windows and compute effect size\n        # Problem uses 1-based indexing for d, l, W. We convert to 0-based slices.\n        pre_start_idx = d_day - W_window\n        pre_end_idx = d_day\n        \n        post_start_idx = d_day + l_delay\n        post_end_idx = d_day + l_delay + W_window\n\n        R_pre = R_hat[pre_start_idx:pre_end_idx]\n        R_post = R_hat[post_start_idx:post_end_idx]\n\n        R_pre_mean = np.mean(R_pre)\n        R_post_mean = np.mean(R_post)\n        \n        # Guard against division by zero, though analytically R_pre_mean > 0\n        if R_pre_mean == 0:\n            delta = float('inf') if R_post_mean > 0 else 0.0\n        else:\n            delta = (R_post_mean - R_pre_mean) / R_pre_mean\n\n        # 4. Perform Welch's t-test\n        # scipy's ttest_ind with equal_var=False performs Welch's t-test\n        t_stat, p_value = stats.ttest_ind(R_pre, R_post, equal_var=False)\n        \n        significant = p_value  alpha_sig\n\n        return [delta, p_value, significant]\n\n    results = []\n    for case in test_cases:\n        result = _process_case(\n            I_series=case[\"I\"],\n            w_dist=w,\n            a_prior=a,\n            b_prior=b,\n            d_day=case[\"d\"],\n            l_delay=case[\"ell\"],\n            W_window=case[\"W\"],\n            alpha_sig=case[\"alpha\"]\n        )\n        results.append(result)\n    \n    # Format the final output string\n    # Python's str() on a list uses repr() for elements, which is what we need.\n    # str() on a bool gives 'True'/'False' as required.\n    output_str = \"[\" + ','.join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}