{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Gray-Level Size Zone Matrix (GLSZM), there is no substitute for building one from the ground up. This practice guides you through the fundamental process, starting with a small digital image. By manually identifying the connected zones of pixels and recording their sizes, you will construct the GLSZM and then use it to compute a texture feature, solidifying your understanding of how raw image data is transformed into a quantitative descriptor. ",
            "id": "4564811",
            "problem": "An imaging scientist is analyzing a two-dimensional Region of Interest (ROI) in radiomics using the Gray-Level Size Zone Matrix (GLSZM). The ROI is a discretized image of size $5\\times 5$ with gray levels in $\\{1,2\\}$. Two pixels are considered connected under $4$-connectivity if they are adjacent in one of the cardinal directions (north, south, east, or west). A zone is defined as a maximally connected set of pixels with identical gray level under $4$-connectivity. The ROI is given by the following matrix of gray levels:\n$$\n\\begin{pmatrix}\n1 & 1 & 2 & 2 & 2 \\\\\n1 & 2 & 2 & 1 & 2 \\\\\n1 & 1 & 1 & 1 & 2 \\\\\n2 & 2 & 1 & 2 & 2 \\\\\n2 & 1 & 1 & 2 & 1\n\\end{pmatrix}.\n$$\nStarting strictly from the core definitions of a zone and the Gray-Level Size Zone Matrix (GLSZM), carry out the following tasks:\n- Enumerate all zones in the ROI under $4$-connectivity, making explicit their gray level and size (measured as the number of pixels in the zone).\n- Populate the GLSZM entry counts $P(i,j)$, where $i\\in\\{1,2\\}$ indexes gray level and $j\\in\\mathbb{N}$ indexes zone size.\n- Using the populated matrix and the foundational definition of GLSZM-based Small Zone Emphasis (SZE) as a scalar quantity that emphasizes the contribution of small zones relative to large ones, derive the SZE from first principles and compute its value for this ROI.\n\nRound your final numeric answer to four significant figures. Express the final answer as a pure number without units.",
            "solution": "The problem requires an analysis of a given $5 \\times 5$ Region of Interest (ROI) using the Gray-Level Size Zone Matrix (GLSZM) methodology. The tasks are to identify all zones, populate the GLSZM, and compute the Small Zone Emphasis (SZE) feature. The analysis will proceed step-by-step from the fundamental definitions provided.\n\nThe ROI is given by the gray-level matrix $G$:\n$$\nG = \\begin{pmatrix}\n1 & 1 & 2 & 2 & 2 \\\\\n1 & 2 & 2 & 1 & 2 \\\\\n1 & 1 & 1 & 1 & 2 \\\\\n2 & 2 & 1 & 2 & 2 \\\\\n2 & 1 & 1 & 2 & 1\n\\end{pmatrix}\n$$\nThe set of gray levels is $i \\in \\{1, 2\\}$. A zone is a maximally connected set of pixels with an identical gray level, where connectivity is defined by the $4$-connectivity rule (pixels are connected if they are adjacent cardinally). The size of a zone, $j$, is the number of pixels it contains.\n\n### Step 1: Enumeration of Zones\n\nWe will identify all zones by performing a connected-component analysis on the matrix $G$.\n\n**Zones for Gray Level $i=1$:**\nBy systematically scanning the matrix for pixels with gray level $1$, we identify the distinct connected components.\n1.  A large, interconnected zone is found. Let us trace its members using coordinates $(row, col)$:\n    The pixel at $(1,1)$ is connected to $(1,2)$ and $(2,1)$.\n    The pixel at $(2,1)$ is connected to $(3,1)$.\n    The pixel at $(3,1)$ is connected to $(3,2)$, which connects to $(3,3)$.\n    The pixel at $(3,3)$ is connected to $(3,4)$ and $(4,3)$.\n    The pixel at $(3,4)$ is connected to $(2,4)$.\n    The pixel at $(4,3)$ is connected to $(5,3)$.\n    The pixel at $(5,3)$ is connected to $(5,2)$.\n    All of these pixels with gray level $1$ form a single, maximally connected set. The pixels in this zone are:\n    $\\{(1,1), (1,2), (2,1), (2,4), (3,1), (3,2), (3,3), (3,4), (4,3), (5,2), (5,3)\\}$.\n    Counting these pixels gives the size of the zone. The size is $j=11$.\n    Thus, we have one zone with gray level $i=1$ and size $j=11$.\n\n2.  We inspect the matrix for any remaining pixels with gray level $1$. The pixel at $(5,5)$ has a value of $1$. Its neighbors under $4$-connectivity are at $(4,5)$ (gray level $2$) and $(5,4)$ (gray level $2$). Since none of its neighbors share its gray level, this pixel forms a zone by itself.\n    The size of this zone is $j=1$.\n    Thus, we have one zone with gray level $i=1$ and size $j=1$.\n\nIn summary, for gray level $i=1$, there are two zones: one of size $11$ and one of size $1$.\n\n**Zones for Gray Level $i=2$:**\nWe repeat the process for pixels with gray level $2$.\n1.  Let's trace the component starting at $(1,3)$:\n    The pixels at $(1,3)$, $(1,4)$, and $(1,5)$ are connected.\n    $(1,3)$ connects to $(2,3)$, which connects to $(2,2)$.\n    $(1,5)$ connects to $(2,5)$, which connects to $(3,5)$.\n    $(3,5)$ connects to $(4,5)$, which connects to $(4,4)$.\n    $(4,4)$ connects to $(5,4)$.\n    A careful check confirms that all these pixels form a single, maximally connected component. The pixels in this zone are:\n    $\\{(1,3), (1,4), (1,5), (2,2), (2,3), (2,5), (3,5), (4,4), (4,5), (5,4)\\}$.\n    The size of this zone is the number of pixels, which is $j=10$.\n    Thus, we have one zone with gray level $i=2$ and size $j=10$.\n\n2.  The remaining pixels with gray level $2$ are at $(4,1)$, $(4,2)$, and $(5,1)$.\n    The pixel at $(4,1)$ is connected to $(4,2)$ and $(5,1)$. The pixel at $(4,2)$ is connected to $(4,1)$. The pixel at $(5,1)$ is connected to $(4,1)$. These three pixels form a distinct connected component.\n    The size of this zone is $j=3$.\n    Thus, we have one zone with gray level $i=2$ and size $j=3$.\n\nIn summary, for gray level $i=2$, there are two zones: one of size $10$ and one of size $3$.\n\nThe complete enumeration of zones is as follows:\n-   Zone 1: Gray Level $1$, Size $11$.\n-   Zone 2: Gray Level $1$, Size $1$.\n-   Zone 3: Gray Level $2$, Size $10$.\n-   Zone 4: Gray Level $2$, Size $3$.\n\n### Step 2: Population of the GLSZM\n\nThe Gray-Level Size Zone Matrix, denoted by $P(i, j)$, stores the number of zones with gray level $i$ and size $j$. Based on our enumeration, we populate the matrix. The number of gray levels is $N_g=2$, and the distinct zone sizes found are $\\{1, 3, 10, 11\\}$.\n\nThe non-zero entries of the GLSZM are:\n-   $P(1, 1) = 1$ (one zone of gray level $1$ and size $1$).\n-   $P(1, 11) = 1$ (one zone of gray level $1$ and size $11$).\n-   $P(2, 3) = 1$ (one zone of gray level $2$ and size $3$).\n-   $P(2, 10) = 1$ (one zone of gray level $2$ and size $10$).\n\nAll other entries $P(i,j)$ are $0$. The total number of zones, $N_z$, is the sum of all entries in the matrix:\n$$\nN_z = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} P(i, j) = P(1,1) + P(1,11) + P(2,3) + P(2,10) = 1 + 1 + 1 + 1 = 4\n$$\nwhere $N_s$ is the maximum zone size.\n\n### Step 3: Derivation and Computation of Small Zone Emphasis (SZE)\n\nThe Small Zone Emphasis (SZE) feature is designed to give greater weight to smaller zones. Following this principle, we can construct the feature by assigning a score to each zone that is inversely related to its size, $j$. A standard and effective choice for this weighting is $1/j^2$, which strongly emphasizes smaller zones. The SZE is then the average of these scores over all zones found in the ROI.\n\nThe total weighted sum for all zones is $\\sum_{i,j} P(i,j) \\cdot (1/j^2)$. To obtain the average score, we normalize this sum by the total number of zones, $N_z$. This \"first principles\" derivation leads to the formal definition of SZE:\n$$\n\\text{SZE} = \\frac{\\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} \\frac{P(i, j)}{j^2}}{\\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} P(i, j)}\n$$\n\nUsing our populated GLSZM and $N_z=4$, we can compute the SZE for this ROI. The numerator is:\n$$\n\\sum_{i,j} \\frac{P(i,j)}{j^2} = \\frac{P(1,1)}{1^2} + \\frac{P(1,11)}{11^2} + \\frac{P(2,3)}{3^2} + \\frac{P(2,10)}{10^2}\n$$\nSubstituting the non-zero values:\n$$\n\\sum_{i,j} \\frac{P(i,j)}{j^2} = \\frac{1}{1^2} + \\frac{1}{11^2} + \\frac{1}{3^2} + \\frac{1}{10^2} = \\frac{1}{1} + \\frac{1}{121} + \\frac{1}{9} + \\frac{1}{100}\n$$\nTo calculate this sum precisely:\n$$\n1 + \\frac{1}{9} + \\frac{1}{100} + \\frac{1}{121} \\approx 1 + 0.1111\\ldots + 0.01 + 0.00826446\\ldots \\approx 1.12937557\n$$\nThe exact fractional value is:\n$$\n\\frac{108900}{108900} + \\frac{12100}{108900} + \\frac{1089}{108900} + \\frac{900}{108900} = \\frac{108900 + 12100 + 1089 + 900}{108900} = \\frac{122989}{108900}\n$$\nNow, we compute SZE:\n$$\n\\text{SZE} = \\frac{\\text{Numerator}}{N_z} = \\frac{122989/108900}{4} = \\frac{122989}{435600}\n$$\nCalculating the numerical value:\n$$\n\\text{SZE} \\approx 0.2823427456 \\ldots\n$$\nRounding to four significant figures, we get $0.2823$.",
            "answer": "$$\\boxed{0.2823}$$"
        },
        {
            "introduction": "The quantitative values of texture features are not absolute; they depend critically on foundational choices, such as the definition of pixel connectivity. This exercise uses a perfect checkerboard pattern—a model of maximum local heterogeneity—to explore this sensitivity. By calculating the GLSZM and the Small Area Emphasis (SAE) feature under both 4-connectivity and 8-connectivity, you will witness firsthand how a change in this single parameter can lead to profoundly different characterizations of the same image. ",
            "id": "4564774",
            "problem": "Consider a finite, discrete, two-dimensional image consisting of a $6 \\times 6$ grid with a perfect checkerboard pattern of two quantized gray levels, denoted by labels $1$ and $2$. Specifically, the pixel at integer coordinates $\\left(x,y\\right)$, with $x,y \\in \\{1,2,3,4,5,6\\}$, has gray level $1$ if $x+y$ is even and gray level $2$ if $x+y$ is odd. Adopt the standard definitions of connectivity on a lattice, where $4$-connectivity means two pixels are adjacent if they share an edge, and $8$-connectivity means two pixels are adjacent if they share either an edge or a corner.\n\nUsing the core definition of the Gray-Level Size Zone Matrix (GLSZM), where $P(i,j)$ counts the number of connected zones (maximal connected sets) consisting of exactly $j$ pixels all at gray level $i$, perform the following:\n\n- Under $4$-connectivity, compute $P(i,1)$ for each gray level $i \\in \\{1,2\\}$, and justify from first principles why all zones are of size $1$ in this configuration.\n\n- Under $8$-connectivity, determine the nonzero entries of the GLSZM, i.e., specify the pairs $\\left(i,j\\right)$ for which $P(i,j) \\neq 0$ and their values.\n\nFinally, let the Small Area Emphasis (SAE) be defined from the normalized GLSZM as follows. Let $N_{z} = \\sum_{i}\\sum_{j} P(i,j)$ be the total number of zones, and define $p(i,j) = P(i,j)/N_{z}$ and $p_{\\cdot j} = \\sum_{i} p(i,j)$. Then the Small Area Emphasis is\n$$\n\\mathrm{SAE} \\;=\\; \\sum_{j=1}^{\\infty} \\frac{p_{\\cdot j}}{j^{2}} \\, .\n$$\nCompute the ratio $R$ of the Small Area Emphasis under $4$-connectivity to that under $8$-connectivity for this image. Report the final ratio $R$ as an exact number with no units. No rounding is necessary. The answer is dimensionless.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The solution proceeds by first analyzing the image structure, then computing the Gray-Level Size Zone Matrix (GLSZM) for both $4$-connectivity and $8$-connectivity, and finally calculating the Small Area Emphasis (SAE) feature for each case to find their ratio.\n\nFirst, we characterize the image. It is a $6 \\times 6$ grid of pixels. The total number of pixels is $6 \\times 6 = 36$. The gray level $G(x,y)$ at coordinates $(x,y)$, where $x, y \\in \\{1, 2, 3, 4, 5, 6\\}$, is determined by the parity of the sum $x+y$. Specifically, $G(x,y) = 1$ if $x+y$ is even, and $G(x,y) = 2$ if $x+y$ is odd. The total number of pixels of gray level $1$, $N_1$, is the number of pairs $(x,y)$ such that $x+y$ is even. In each row, there are $3$ columns for which $x+y$ is even and $3$ for which it is odd. Thus, across $6$ rows, there are $6 \\times 3 = 18$ pixels with gray level $1$. Similarly, the number of pixels of gray level $2$, $N_2$, is $18$. The sum is $N_1 + N_2 = 18 + 18 = 36$, the total number of pixels, as expected.\n\nThe GLSZM is denoted by $P(i,j)$, which counts the number of connected zones of size $j$ composed of pixels with gray level $i$.\n\nAnalysis under $4$-connectivity:\nUnder $4$-connectivity, two pixels are adjacent if they share an edge. A pixel at $(x,y)$ is $4$-connected to pixels at $(x \\pm 1, y)$ and $(x, y \\pm 1)$, provided these coordinates are within the grid boundaries. Let a pixel at $(x,y)$ have a gray level determined by the parity of $S = x+y$. Its $4$-connected neighbors are at coordinates $(x',y')$ for which the sum is $S' = (x \\pm 1) + y = S \\pm 1$ or $S' = x + (y \\pm 1) = S \\pm 1$. In all cases, if $S$ is even, $S'$ is odd, and if $S$ is odd, $S'$ is even. This means that any pixel of gray level $1$ has all its $4$-connected neighbors with gray level $2$, and any pixel of gray level $2$ has all its $4$-connected neighbors with gray level $1$.\nConsequently, no two pixels of the same gray level are $4$-connected. Therefore, a connected zone of a given gray level cannot contain more than one pixel. Every pixel constitutes a zone of size $j=1$.\nFor gray level $i=1$, there are $N_1 = 18$ pixels. Each forms a zone of size $1$. Thus, the GLSZM has the entry $P_{4-\\text{conn}}(1,1) = 18$.\nFor gray level $i=2$, there are $N_2 = 18$ pixels. Each forms a zone of size $1$. Thus, $P_{4-\\text{conn}}(2,1) = 18$.\nAll other entries of the GLSZM for $4$-connectivity, $P_{4-\\text{conn}}(i,j)$ for $j \\neq 1$, are zero.\n\nAnalysis under $8$-connectivity:\nUnder $8$-connectivity, two pixels are adjacent if they share an edge or a corner. A pixel at $(x,y)$ is $8$-connected to pixels at $(x+\\Delta x, y+\\Delta y)$ for $\\Delta x, \\Delta y \\in \\{-1, 0, 1\\}$, not both zero. The sum of coordinates for a neighbor is $S' = (x+\\Delta x) + (y+\\Delta y) = (x+y) + (\\Delta x + \\Delta y)$. A neighbor has the same gray level if $S'$ has the same parity as $S=x+y$, which requires $\\Delta x + \\Delta y$ to be an even number.\nThe possible values for $\\Delta x + \\Delta y$ for neighbors are:\n- Edge neighbors: $(\\Delta x, \\Delta y) \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$. Here, $\\Delta x + \\Delta y \\in \\{-1, 1\\}$, which is odd. These neighbors have a different gray level.\n- Corner neighbors: $(\\Delta x, \\Delta y) \\in \\{(\\pm 1, \\pm 1), (\\pm 1, \\mp 1)\\}$. Here, $\\Delta x + \\Delta y \\in \\{-2, 0, 2\\}$, which is even. These neighbors have the same gray level.\nThis shows that all pixels of a given gray level are connected to their corner-adjacent neighbors, which are of the same gray level. For the checkerboard pattern, the set of all pixels with gray level $1$ forms a single connected component under $8$-connectivity. Any pixel with $x+y$ even can be reached from any other such pixel through a path of corner-adjacent pixels. The same holds true for the set of all pixels with gray level $2$.\nTherefore, under $8$-connectivity, there are exactly two zones:\n- One zone of gray level $i=1$ comprising all $N_1=18$ pixels. Its size is $j=18$. This gives $P_{8-\\text{conn}}(1,18) = 1$.\n- One zone of gray level $i=2$ comprising all $N_2=18$ pixels. Its size is $j=18$. This gives $P_{8-\\text{conn}}(2,18) = 1$.\nAll other entries $P_{8-\\text{conn}}(i,j)$ are zero.\n\nComputation of the Small Area Emphasis (SAE) ratio:\nThe SAE is defined as $\\mathrm{SAE} = \\sum_{j=1}^{\\infty} \\frac{p_{\\cdot j}}{j^{2}}$, where $p_{\\cdot j} = \\sum_{i} p(i,j)$ and $p(i,j) = P(i,j)/N_z$, with $N_z = \\sum_{i,j} P(i,j)$ being the total number of zones.\n\nFor $4$-connectivity:\nThe non-zero entries are $P_{4-\\text{conn}}(1,1) = 18$ and $P_{4-\\text{conn}}(2,1) = 18$.\nThe total number of zones is $N_{z,4} = P_{4-\\text{conn}}(1,1) + P_{4-\\text{conn}}(2,1) = 18 + 18 = 36$.\nThe only non-zero column in the GLSZM is for size $j=1$. The column probability is:\n$$p_{\\cdot 1} = \\sum_{i=1}^{2} p(i,1) = \\frac{P_{4-\\text{conn}}(1,1) + P_{4-\\text{conn}}(2,1)}{N_{z,4}} = \\frac{18+18}{36} = 1$$\nAll other $p_{\\cdot j}$ are zero for $j \\neq 1$.\nThe SAE for $4$-connectivity is:\n$$\\mathrm{SAE}_{4} = \\sum_{j=1}^{\\infty} \\frac{p_{\\cdot j}}{j^{2}} = \\frac{p_{\\cdot 1}}{1^2} = \\frac{1}{1} = 1$$\n\nFor $8$-connectivity:\nThe non-zero entries are $P_{8-\\text{conn}}(1,18) = 1$ and $P_{8-\\text{conn}}(2,18) = 1$.\nThe total number of zones is $N_{z,8} = P_{8-\\text{conn}}(1,18) + P_{8-\\text{conn}}(2,18) = 1 + 1 = 2$.\nThe only non-zero column is for size $j=18$. The column probability is:\n$$p_{\\cdot 18} = \\sum_{i=1}^{2} p(i,18) = \\frac{P_{8-\\text{conn}}(1,18) + P_{8-\\text{conn}}(2,18)}{N_{z,8}} = \\frac{1+1}{2} = 1$$\nAll other $p_{\\cdot j}$ are zero for $j \\neq 18$.\nThe SAE for $8$-connectivity is:\n$$\\mathrm{SAE}_{8} = \\sum_{j=1}^{\\infty} \\frac{p_{\\cdot j}}{j^{2}} = \\frac{p_{\\cdot 18}}{18^{2}} = \\frac{1}{324}$$\n\nFinally, the ratio $R$ of the SAE under $4$-connectivity to that under $8$-connectivity is:\n$$R = \\frac{\\mathrm{SAE}_{4}}{\\mathrm{SAE}_{8}} = \\frac{1}{\\frac{1}{324}} = 324$$\nThe final ratio is an exact number.",
            "answer": "$$\\boxed{324}$$"
        },
        {
            "introduction": "While manual computation is invaluable for learning, real-world radiomics requires efficient algorithms to process large datasets. This problem challenges you to think like a programmer and design a method for automatically computing the GLSZM. By considering how graph traversal algorithms like Breadth-First Search (BFS) can be adapted into a \"flood-fill\" procedure, you will gain insight into the computational backbone of texture analysis and the importance of algorithmic efficiency, such as achieving a time complexity of $O(N_p + |E|)$. ",
            "id": "4564805",
            "problem": "In texture analysis for radiomics, the Gray-Level Size Zone Matrix (GLSZM) encodes the distribution of homogeneous zones in a region of interest. Let a region of interest be represented as an undirected graph with vertex set $V$ of $N_p$ voxels and edge set $E$ describing adjacency under a fixed connectivity. Each voxel $v \\in V$ has a discretized gray level given by a function $g: V \\to \\{1,2,\\dots,N_g\\}$. A zone for gray level $i$ is a maximal connected subset $Z \\subseteq V$ such that every $v \\in Z$ satisfies $g(v)=i$, and connectivity is judged via edges in $E$. The Gray-Level Size Zone Matrix $P(i,j)$ counts, for each gray level $i$, the number of zones of size $j$, where zone size is the cardinality $|Z|$.\n\nUsing only the following foundational facts:\n- In an undirected graph, Breadth-First Search (BFS) or Depth-First Search (DFS) explores a connected component in time proportional to the number of visited vertices plus the number of incident edges, which in the whole graph yields $O(N_p + |E|)$ when each vertex and edge is processed a constant number of times.\n- A flood-fill is a graph traversal that restricts expansion according to a predicate (here, equality of gray level), which can be checked in $O(1)$ time per neighbor,\n\nselect the option that both correctly describes a flood-fill algorithm based on Breadth-First Search (BFS) or Depth-First Search (DFS) to compute $P(i,j)$ from $g$ and $E$, and gives the correct asymptotic worst-case time complexity in terms of $N_p$ and $|E|$.\n\nA. Maintain a Boolean array `visited` initialized to `false`. For each voxel $v \\in V$, if `visited[v]` is `false`, let $c \\leftarrow g(v)$ and run a flood-fill using Breadth-First Search (BFS) or Depth-First Search (DFS) starting from $v$, expanding from a voxel $x$ only to neighbors $u$ with `visited[u]` being `false` and $g(u)=c$. Count the number $s$ of visited voxels during this traversal, set all those `visited` values to `true`, and increment $P(c,s)$ by $1$. Repeat until all voxels are visited. This runs in $O(N_p + |E|)$ time because each voxel is enqueued or pushed and marked once, and each edge is inspected a constant number of times with an $O(1)$ equality check.\n\nB. For each gray level $i \\in \\{1,\\dots,N_g\\}$, reset a Boolean array `visited` to `false` and run flood-fills using Breadth-First Search (BFS) restricted to voxels with $g(\\cdot)=i$ across the entire graph, incrementing $P(i,s)$ for every connected component discovered at level $i$. This runs in $O(N_p + |E|)$ time because each per-level traversal is linear in the graph size.\n\nC. Run a single Breadth-First Search (BFS) over the entire graph ignoring gray levels, labeling each connected component regardless of $g(\\cdot)$, then compute the size of each component and add it to every $P(i,j)$ that appears within the component. This runs in $O(N_p + |E|)$ time and yields the correct $P(i,j)$.\n\nD. Sort the voxels by gray level in $O(N_p \\log N_p)$ time, then for each contiguous block of equal gray level in the sorted order, run a flood-fill using Depth-First Search (DFS) over the graph to find connected sets and sizes, incrementing $P(i,s)$. The overall time is $O((N_p + |E|)\\log N_p)$ due to the sorting step, which is necessary to correctly group voxels by gray level before connectivity is checked.",
            "solution": "The problem asks for an evaluation of algorithms to compute the Gray-Level Size Zone Matrix (GLSZM), denoted as $P(i,j)$. This matrix quantifies the texture of a region of interest by counting, for each gray level $i$, the number of zones of size $j$.\n\nFirst, let us formalize the definitions provided.\n- The region of interest is an undirected graph with a vertex set $V$ of $N_p$ voxels and an edge set $E$ defining adjacency.\n- A gray level function $g: V \\to \\{1, 2, \\dots, N_g\\}$ assigns an integer gray level to each voxel.\n- A \"zone\" of gray level $i$ is a maximal connected subset of voxels all having the gray level $i$. In graph-theoretic terms, this is a connected component of the subgraph induced by the set of vertices $\\{v \\in V \\mid g(v) = i\\}$.\n- The GLSZM, $P(i,j)$, is a $2$D histogram where $P(i,j)$ is the number of zones with gray level $i$ and size (number of voxels) $j$.\n\nThe task is to find a correct algorithm based on Breadth-First Search (BFS) or Depth-First Search (DFS) and to state its correct worst-case time complexity in terms of $N_p$ and $|E|$.\n\nTo compute $P(i,j)$, we must identify every zone in the graph, determine its gray level, and count its size. This is a classic \"connected components\" problem, but with the additional constraint that components are defined on vertices of the same gray level.\n\nA correct and efficient algorithm can be designed by iterating through all voxels. If a voxel has not yet been assigned to a zone, it must be the starting point of a new zone. A graph traversal, such as BFS or DFS, can be initiated from this voxel to find all other voxels in the same zone. This is a \"flood-fill\" procedure.\n\nLet us outline such an algorithm:\n1.  Initialize a data structure to mark visited voxels, for example, a Boolean array `visited` of size $N_p$, with all entries set to `false`.\n2.  Initialize the GLSZM, $P(i,j)$, to a matrix of zeros. The dimensions will be $N_g \\times N_p$ at maximum, as a zone can have a size from $1$ to $N_p$.\n3.  Iterate through each voxel $v \\in V$:\n    a. If `visited[v]` is `true`, this voxel has already been accounted for in a previously identified zone, so we continue to the next voxel.\n    b. If `visited[v]` is `false`, a new, unexplored zone has been found.\n        i.   Determine the gray level of this zone: $c \\leftarrow g(v)$.\n        ii.  Initialize a size counter for this zone: $s \\leftarrow 0$.\n        iii. Start a traversal (BFS or DFS) from $v$. Let us use a queue for a BFS-based flood-fill.\n        iv.  Add $v$ to the queue and set `visited[v] = true`.\n        v.   While the queue is not empty:\n             1. Dequeue a voxel, let's call it $x$.\n             2. Increment the zone size: $s \\leftarrow s + 1$.\n             3. For each neighbor $u$ of $x$ (connected by an edge in $E$):\n                - Check if $u$ is part of the same zone: `visited[u]` must be `false` (not yet in any zone) and $g(u)$ must be equal to $c$ (same gray level).\n                - If both conditions are met, add $u$ to the queue and set `visited[u] = true`.\n        vi.  The traversal for this zone is complete. The size is $s$.\n        vii. Increment the corresponding entry in the GLSZM: $P(c, s) \\leftarrow P(c, s) + 1$.\n4. After the main loop has traversed all voxels in $V$, every voxel will have been visited and assigned to exactly one zone. The matrix $P(i,j)$ is complete.\n\nNow for the complexity analysis of this algorithm:\n- The outer loop iterates through all $N_p$ voxels.\n- The `if(visited[v] == false)` condition ensures that the inner traversal (the flood-fill) is executed exactly once for each zone. Since the zones form a partition of the vertex set $V$, every vertex $v \\in V$ will be enqueued and dequeued exactly once throughout the entire process. Thus, the total work on vertices is $O(N_p)$.\n- During the traversals, for each vertex dequeued, we inspect its neighbors. An edge $\\{u,v\\}$ is inspected at most twice over the entire algorithm: once when processing $u$ and once when processing $v$. The total number of edge inspections is therefore proportional to $|E|$. The predicate check $g(u) = c$ is an $O(1)$ operation.\n- Combining these, the total worst-case time complexity is $O(N_p + |E|)$.\n\nWe will now evaluate each option against this derivation.\n\n**Option A:** Maintain a Boolean array `visited` initialized to `false`. For each voxel $v \\in V$, if `visited[v]` is `false`, let $c \\leftarrow g(v)$ and run a flood-fill using Breadth-First Search (BFS) or Depth-First Search (DFS) starting from $v$, expanding from a voxel $x$ only to neighbors $u$ with `visited[u]` being `false` and $g(u)=c$. Count the number $s$ of visited voxels during this traversal, set all those `visited` values to `true`, and increment $P(c,s)$ by $1$. Repeat until all voxels are visited. This runs in $O(N_p + |E|)$ time because each voxel is enqueued or pushed and marked once, and each edge is inspected a constant number of times with an $O(1)$ equality check.\n\n- **Algorithm Correctness:** This description perfectly matches the correct and efficient algorithm derived above. It correctly identifies each zone by starting a flood-fill from an unvisited voxel and correctly populates the GLSZM.\n- **Complexity Correctness:** The stated complexity $O(N_p + |E|)$ and its justification are also fully correct, matching our analysis. Each voxel is processed once, and each edge is inspected a constant number of times.\n\n- **Verdict:** Correct.\n\n**Option B:** For each gray level $i \\in \\{1,\\dots,N_g\\}$, reset a Boolean array `visited` to `false` and run flood-fills using Breadth-First Search (BFS) restricted to voxels with $g(\\cdot)=i$ across the entire graph, incrementing $P(i,s)$ for every connected component discovered at level $i$. This runs in $O(N_p + |E|)$ time because each per-level traversal is linear in the graph size.\n\n- **Algorithm Correctness:** The algorithm is logically correct. It computes the zones for each gray level one by one. For a fixed $i$, it finds all connected components in the subgraph induced by vertices with that gray level.\n- **Complexity Correctness:** The complexity claim is incorrect. The algorithm involves an outer loop that runs $N_g$ times. Inside this loop, it must find all zones for gray level $i$. To do this, it would need to iterate through all $N_p$ voxels to find starting points for the flood-fills for level $i$. A conservative analysis of the inner work for one gray level $i$ is $O(N_p + |E_i|)$, where $E_i$ are edges between vertices of level $i$. The total complexity would be $\\sum_{i=1}^{N_g} O(N_{p,i} + |E_i|)$ with an outer loop that scans all $N_p$ vertices, leading to $O(N_g \\cdot N_p + |E|)$. Or if it resets a visited array and scans all $N_p$ voxels for each of the $N_g$ levels, the complexity is $O(N_g \\cdot (N_p + |E|))$. In either case, it is not $O(N_p+|E|)$. The claim that \"each per-level traversal is linear in the graph size\" is true, but multiplying this by $N_g$ gives a total complexity that is worse than linear unless $N_g$ is a constant. The stated complexity is an oversimplification and is incorrect for the general case.\n\n- **Verdict:** Incorrect.\n\n**Option C:** Run a single Breadth-First Search (BFS) over the entire graph ignoring gray levels, labeling each connected component regardless of $g(\\cdot)$, then compute the size of each component and add it to every $P(i,j)$ that appears within the component.\n\n- **Algorithm Correctness:** This algorithm is fundamentally flawed. A zone is defined by connectivity *and* constant gray level. This algorithm ignores the gray level constraint during the connectivity analysis. For example, a single connected component of the graph could contain voxels of many different gray levels. This is not a zone. The logic for what to do with such a component (\"add it to every $P(i,j)$ that appears within the component\") is incoherent and does not produce the GLSZM.\n\n- **Verdict:** Incorrect.\n\n**Option D:** Sort the voxels by gray level in $O(N_p \\log N_p)$ time, then for each contiguous block of equal gray level in the sorted order, run a flood-fill using Depth-First Search (DFS) over the graph to find connected sets and sizes, incrementing $P(i,s)$. The overall time is $O((N_p + |E|)\\log N_p)$ due to the sorting step, which is necessary to correctly group voxels by gray level before connectivity is checked.\n\n- **Algorithm Correctness:** This algorithm's logic is confused. Sorting voxels by gray level destroys the spatial adjacency information encoded in the graph $E$. A \"contiguous block\" in a sorted list of voxel gray levels has no correlation with a \"connected zone\" in the graph. The premise that sorting is a necessary or useful preprocessing step for checking connectivity is false. The flood-fill algorithm itself naturally \"groups\" voxels by checking the gray level of neighbors during traversal, as described in Option A.\n- **Complexity Correctness:** The sorting step introduces an unnecessary $O(N_p \\log N_p)$ overhead. The algorithm described in Option A achieves the goal in $O(N_p + |E|)$ time, which is superior. The claim that sorting is \"necessary\" is false. The overall complexity stated, $O((N_p + |E|)\\log N_p)$, seems to be a strange combination that does not logically follow from the (flawed) algorithmic description.\n\n- **Verdict:** Incorrect.\n\nBased on this analysis, Option A is the only one that provides a correct algorithm and a correct analysis of its time complexity.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}