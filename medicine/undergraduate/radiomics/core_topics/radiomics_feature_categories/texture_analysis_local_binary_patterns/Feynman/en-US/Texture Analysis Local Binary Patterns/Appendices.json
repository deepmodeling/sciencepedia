{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Local Binary Patterns (LBP) operator, there is no substitute for direct computation. This first exercise provides a concrete $3 \\times 3$ pixel patch and guides you through the fundamental steps of generating a binary code by comparing neighbor intensities to a central value. By calculating both the standard $LBP_{8,1}$ code and its more robust rotation-invariant uniform variant, you will build a solid foundation in the core mechanics of this powerful texture descriptor .",
            "id": "4612936",
            "problem": "In radiomics-driven analysis of Magnetic Resonance Imaging (MRI) textures, Local Binary Patterns (LBP) provide a compact representation of local micro-structures that is robust to monotonic grayscale transformations. Consider a single-channel grayscale $3\\times 3$ patch extracted from a T$_2$-weighted MRI slice. Let the center intensity be $g_c = 10$ and the $8$ neighbors sampled on a circle of radius $R=1$ in clockwise order starting from the neighbor at angle $0$ (the positive $x$-axis, “east”) be the sequence $[12, 9, 11, 8, 10, 13, 7, 10]$. Using the standard Local Binary Patterns (LBP) operator with $P=8$ neighbors and radius $R=1$, define the thresholding indicator for each neighbor intensity $g_p$ as $s(g_p - g_c)$, where $s(t)$ equals $1$ if $t \\ge 0$ and $0$ otherwise. Form the circular binary pattern in the given clockwise order, and interpret this pattern as a base-$2$ integer with the first neighbor (at angle $0$) assigned the least-significant bit and bit weights increasing clockwise. Then, determine the rotation-invariant uniform label by the canonical rule: if the circular binary pattern exhibits at most two transitions between $0$ and $1$, the label equals the number of ones in the pattern; otherwise, the label equals $P+1$. Compute the resulting $LBP_{8,1}$ code and its rotation-invariant uniform label. Report both values without units. The final answer must be a calculation and expressed as a single row matrix. No rounding is required.",
            "solution": "The problem requires the computation of the Local Binary Patterns ($LBP$) code and the corresponding rotation-invariant uniform label for a given $3\\times3$ image patch.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- The image patch is a $3 \\times 3$ single-channel grayscale region.\n- The center pixel intensity is $g_c = 10$.\n- The number of neighbors is $P=8$ on a circle of radius $R=1$.\n- The sequence of $P=8$ neighbor intensities, starting from the east ($0$ degrees) and proceeding clockwise, is given as $[12, 9, 11, 8, 10, 13, 7, 10]$. Let's denote this sequence by $\\{g_p\\}_{p=0}^{7}$, so $g_0=12$, $g_1=9$, and so on.\n- The thresholding function is defined as $s(t)$, where $s(t) = 1$ if $t \\ge 0$ and $s(t) = 0$ if $t < 0$.\n- The binary pattern is formed from the sequence of thresholded differences $s(g_p - g_c)$ for $p=0, 1, \\dots, 7$.\n- The $LBP$ code is the decimal value of the resulting $8$-bit binary number, where the bit from the first neighbor ($p=0$) is the least-significant bit (LSB), and bit weights increase clockwise.\n- The rotation-invariant uniform label is determined by a rule based on the number of spatial transitions (bit-flips from $0$ to $1$ or $1$ to $0$) in the circular binary pattern. Let this be $U(LBP)$.\n    - If $U(LBP) \\le 2$, the pattern is \"uniform\", and its label is the number of '1's in the pattern.\n    - If $U(LBP) > 2$, the pattern is \"non-uniform\", and its label is $P+1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded as it concerns the standard Local Binary Patterns operator, a fundamental technique in texture analysis and radiomics. It is well-posed, providing all necessary parameters, data, and unambiguous rules for computation. The language is objective and formal. The problem is complete, consistent, and computationally feasible. There are no violations of scientific principles, logical inconsistencies, or ambiguities.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nFirst, we compute the binary pattern by comparing each neighbor's intensity $g_p$ with the center intensity $g_c=10$. We apply the thresholding function $s(g_p - g_c)$.\n\nThe neighbor intensities are $g_0=12, g_1=9, g_2=11, g_3=8, g_4=10, g_5=13, g_6=7, g_7=10$.\n\nThe thresholded values, which form the bits of the pattern, are calculated as follows:\n- For $p=0$: $s(g_0 - g_c) = s(12 - 10) = s(2) = 1$.\n- For $p=1$: $s(g_1 - g_c) = s(9 - 10) = s(-1) = 0$.\n- For $p=2$: $s(g_2 - g_c) = s(11 - 10) = s(1) = 1$.\n- For $p=3$: $s(g_3 - g_c) = s(8 - 10) = s(-2) = 0$.\n- For $p=4$: $s(g_4 - g_c) = s(10 - 10) = s(0) = 1$.\n- For $p=5$: $s(g_5 - g_c) = s(13 - 10) = s(3) = 1$.\n- For $p=6$: $s(g_6 - g_c) = s(7 - 10) = s(-3) = 0$.\n- For $p=7$: $s(g_7 - g_c) = s(10 - 10) = s(0) = 1$.\n\nThe sequence of bits, corresponding to neighbors $p=0, \\dots, 7$, is $\\{s_p\\}_{p=0}^7 = \\{1, 0, 1, 0, 1, 1, 0, 1\\}$.\n\nNext, we calculate the $LBP_{8,1}$ code. The problem specifies that the bit from neighbor $p=0$ is the LSB. The formula for the $LBP$ code is:\n$$ LBP_{P,R} = \\sum_{p=0}^{P-1} s(g_p - g_c) \\cdot 2^p $$\nUsing $P=8$ and the bits we calculated:\n$$ LBP_{8,1} = s_0 \\cdot 2^0 + s_1 \\cdot 2^1 + s_2 \\cdot 2^2 + s_3 \\cdot 2^3 + s_4 \\cdot 2^4 + s_5 \\cdot 2^5 + s_6 \\cdot 2^6 + s_7 \\cdot 2^7 $$\nThe binary string, read from $s_7$ to $s_0$, is $10110101_2$.\n$$ LBP_{8,1} = 1 \\cdot 2^0 + 0 \\cdot 2^1 + 1 \\cdot 2^2 + 0 \\cdot 2^3 + 1 \\cdot 2^4 + 1 \\cdot 2^5 + 0 \\cdot 2^6 + 1 \\cdot 2^7 $$\n$$ LBP_{8,1} = 1 \\cdot 1 + 0 \\cdot 2 + 1 \\cdot 4 + 0 \\cdot 8 + 1 \\cdot 16 + 1 \\cdot 32 + 0 \\cdot 64 + 1 \\cdot 128 $$\n$$ LBP_{8,1} = 1 + 4 + 16 + 32 + 128 = 181 $$\nThe first required value, the $LBP_{8,1}$ code, is $181$.\n\nNow, we determine the rotation-invariant uniform label, denoted as $LBP_{P,R}^{riu2}$. We must count the number of transitions $U$ in the circular binary pattern $(s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7)$.\nThe pattern is $(1, 0, 1, 0, 1, 1, 0, 1)$.\nThe number of transitions $U$ is given by:\n$$ U = |s_{P-1} - s_0| + \\sum_{p=1}^{P-1} |s_p - s_{p-1}| $$\nWith $P=8$, the pattern is $(s_0, s_1, s_2, s_3, s_4, s_5, s_6, s_7) = (1, 0, 1, 0, 1, 1, 0, 1)$.\nLet's count the transitions sequentially:\n- $s_0 \\to s_1$: $1 \\to 0$, transition. ($1$)\n- $s_1 \\to s_2$: $0 \\to 1$, transition. ($2$)\n- $s_2 \\to s_3$: $1 \\to 0$, transition. ($3$)\n- $s_3 \\to s_4$: $0 \\to 1$, transition. ($4$)\n- $s_4 \\to s_5$: $1 \\to 1$, no transition.\n- $s_5 \\to s_6$: $1 \\to 0$, transition. ($5$)\n- $s_6 \\to s_7$: $0 \\to 1$, transition. ($6$)\n- $s_7 \\to s_0$ (circular part): $1 \\to 1$, no transition.\nThe total number of transitions is $U=6$.\n\nAccording to the rule for uniform patterns, a pattern is uniform if $U \\le 2$. Since $U=6$, which is greater than $2$, the pattern is non-uniform.\nFor non-uniform patterns, the rotation-invariant uniform label is defined as $P+1$.\nGiven $P=8$, the label is $8+1=9$.\n\nThe two computed values are the $LBP_{8,1}$ code, which is $181$, and its rotation-invariant uniform label, which is $9$. The final answer should be presented as a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n181 & 9\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Once you understand how to compute a single LBP code, the next step is to apply it across an entire region of interest (ROI). This immediately raises a practical question: how should we handle pixels at the boundary whose neighborhoods extend outside the ROI? This practice explores four common border-handling strategies, from ignoring boundary pixels to more sophisticated wrapping and mirroring techniques, and quantifies their impact on the final LBP histogram . This exercise highlights how seemingly small implementation choices can significantly affect texture analysis results.",
            "id": "4565398",
            "problem": "In radiomics, Local Binary Patterns (LBP) are used to quantify local texture around each pixel of a region of interest (ROI). Consider the following ROI as a $3 \\times 3$ grayscale image with intensity values\n$$\nI = \\begin{pmatrix}\n10 & 10 & 10 \\\\\n10 & 20 & 10 \\\\\n10 & 10 & 10\n\\end{pmatrix}.\n$$\nThe LBP operator with $P=8$ neighbors at radius $R=1$ is defined as follows: for each pixel at coordinates $(r,c)$ with center intensity $I_{r,c}$, define the neighbor offsets in fixed order\n$$\n(\\Delta r_k, \\Delta c_k) = \\{(-1,-1),\\, (-1,0),\\, (-1,1),\\, (0,1),\\, (1,1),\\, (1,0),\\, (1,-1),\\, (0,-1)\\}, \\quad k = 0,1,\\dots,7,\n$$\nand the corresponding binary tests\n$$\nb_k(r,c) = \\begin{cases}\n1, & \\text{if } I_{r+\\Delta r_k,\\,c+\\Delta c_k} \\ge I_{r,c}, \\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThe LBP code for pixel $(r,c)$ is the integer\n$$\ns(r,c) = \\sum_{k=0}^{7} b_k(r,c)\\,2^{k}.\n$$\nAn LBP histogram is the distribution of codes $s(r,c)$ over the ROI pixels that are deemed valid under a specified border handling strategy, normalized to sum to $1$.\n\nFor pixels near the ROI boundary, four border handling strategies are commonly used:\n- Ignore: exclude any pixel whose $P$ neighbors at radius $R$ do not all lie within the ROI.\n- Mirror: for any neighbor index that would fall outside the ROI, map it back inside by reflecting across the closest ROI boundary.\n- Wrap: for any neighbor index that would fall outside the ROI, map it back inside by applying periodic (toroidal) boundary conditions.\n- Partial sampling: for any neighbor index that would fall outside the ROI, assign the corresponding bit $b_k(r,c)$ the value $0$.\n\nStarting only from these fundamental definitions, first formalize each strategy as a precise mathematical rule acting on $(r+\\Delta r_k, c+\\Delta c_k)$, then derive the normalized LBP histogram for the given ROI under each strategy. Finally, quantify the impact of border handling by computing the Jensen–Shannon (JS) divergence between the normalized LBP histograms obtained from the Ignore and Mirror strategies. Use the natural logarithm for all information measures. Round your final numeric answer to four significant figures and express the divergence in nats.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The solution proceeds in four stages: (1) formalizing the four border handling strategies, (2) calculating the Local Binary Pattern (LBP) codes for every pixel in the given $3 \\times 3$ region of interest (ROI) under each strategy, (3) constructing the normalized LBP histograms, and (4) computing the Jensen-Shannon (JS) divergence between the histograms from the 'Ignore' and 'Mirror' strategies.\n\nThe ROI is given by the intensity matrix $I$, with dimensions $N_r=3$ rows and $N_c=3$ columns. We use $1$-indexed coordinates $(r,c)$, where $r,c \\in \\{1, 2, 3\\}$.\n$$\nI = \\begin{pmatrix}\n10 & 10 & 10 \\\\\n10 & 20 & 10 \\\\\n10 & 10 & 10\n\\end{pmatrix}\n$$\nThe LBP operator is defined with $P=8$ neighbors at radius $R=1$. The neighbor offsets for $k = 0, \\dots, 7$ are $(\\Delta r_k, \\Delta c_k) = \\{(-1,-1), (-1,0), (-1,1), (0,1), (1,1), (1,0), (1,-1), (0,-1)\\}$. The LBP code for a pixel at $(r,c)$ is $s(r,c) = \\sum_{k=0}^{7} b_k(r,c) 2^k$, where $b_k(r,c)=1$ if the neighbor's intensity is greater than or equal to the center pixel's intensity $I_{r,c}$, and $b_k(r,c)=0$ otherwise.\n\n**1. Formalization of Border Handling Strategies**\n\nFor a center pixel at $(r,c)$, let a neighbor's raw coordinate be $(r', c') = (r+\\Delta r_k, c+\\Delta c_k)$. Let $(\\tilde{r}, \\tilde{c})$ be the mapped coordinate used to access intensity values. The ROI domain is $\\mathcal{D} = \\{(i,j) \\mid 1 \\le i \\le N_r, 1 \\le j \\le N_c\\}$.\n\n-   **Ignore**: The set of valid center pixels is restricted to those whose $3 \\times 3$ neighborhood is entirely within $\\mathcal{D}$. For any pixel $(r,c)$ in this set, we have $(\\tilde{r}, \\tilde{c}) = (r',c')$. Any pixel not meeting this condition is excluded from the histogram calculation.\n-   **Mirror**: All pixels in $\\mathcal{D}$ are processed. If a neighbor coordinate $(r',c')$ is outside $\\mathcal{D}$, it is mapped to $(\\tilde{r},\\tilde{c})$ by reflection across the nearest boundary. The mapping is:\n    $$ \\tilde{r} = \\begin{cases} r' & \\text{if } 1 \\le r' \\le N_r \\\\ 2-r' & \\text{if } r' < 1 \\\\ 2N_r-r' & \\text{if } r' > N_r \\end{cases} \\quad \\text{and} \\quad \\tilde{c} = \\begin{cases} c' & \\text{if } 1 \\le c' \\le N_c \\\\ 2-c' & \\text{if } c' < 1 \\\\ 2N_c-c' & \\text{if } c' > N_c \\end{cases} $$\n    For this problem, $N_r=N_c=3$.\n-   **Wrap**: All pixels in $\\mathcal{D}$ are processed. If $(r',c')$ is outside $\\mathcal{D}$, it is mapped to $(\\tilde{r},\\tilde{c})$ using periodic boundary conditions:\n    $$ \\tilde{r} = (r'-1 \\pmod{N_r}) + 1 \\quad \\text{and} \\quad \\tilde{c} = (c'-1 \\pmod{N_c}) + 1 $$\n    where the modulo operator maps its inputs to $\\{0, 1, \\dots, N-1\\}$.\n-   **Partial sampling**: All pixels in $\\mathcal{D}$ are processed. The bit $b_k(r,c)$ is determined as:\n    $$ b_k(r,c) = \\begin{cases} 1 & \\text{if } (r',c') \\in \\mathcal{D} \\text{ and } I_{r',c'} \\ge I_{r,c} \\\\ 0 & \\text{if } (r',c') \\notin \\mathcal{D} \\text{ or } I_{r',c'} < I_{r,c} \\end{cases} $$\n\n**2. LBP Code Calculation**\n\nThe central pixel is $(2,2)$ with intensity $I_{2,2}=20$. All its 8 neighbors have intensity $10$. Since $10 < 20$, all bits $b_k(2,2)$ are $0$. Thus, $s(2,2) = \\sum_{k=0}^{7} 0 \\cdot 2^k = 0$. This code is the same for all strategies as the neighborhood is fully contained in the ROI.\n\nThe other $8$ pixels are on the border and all have an intensity of $10$. For these pixels, any neighbor with intensity $I_{neigh} \\ge 10$ will result in a bit $b_k=1$. In this ROI, all pixels have intensity $10$ or $20$, so any valid neighbor lookup will result in a bit of $1$.\n\n-   **Ignore**: Only the center pixel $(2,2)$ has a neighborhood fully within the $3 \\times 3$ ROI. Thus, only $s(2,2)=0$ is calculated.\n-   **Mirror**: For any of the $8$ border pixels, the center intensity is $10$. Any neighbor, whether inside the ROI or mirrored, will have an intensity of $10$ or $20$. Since all neighbor intensities are $\\ge 10$, all $8$ bits will be $1$.\n    Therefore, for all $8$ border pixels, the code is $s = \\sum_{k=0}^{7} 1 \\cdot 2^k = 2^8 - 1 = 255$.\n-   **Wrap**: Similarly, for any of the $8$ border pixels (center intensity $10$), any wrapped neighbor will have intensity $10$ or $20$. So, all $8$ bits are $1$. The code for all $8$ border pixels is $255$.\n-   **Partial sampling**: For the $8$ border pixels (center intensity $10$), a bit $b_k$ is $1$ if its corresponding neighbor is within the ROI, and $0$ if it is outside.\n    -   Pixel $(1,1)$: In-ROI neighbors are at $k=3,4,5$. $s(1,1)=2^3+2^4+2^5 = 8+16+32 = 56$.\n    -   Pixel $(1,3)$: In-ROI neighbors are at $k=5,6,7$. $s(1,3)=2^5+2^6+2^7 = 32+64+128 = 224$.\n    -   Pixel $(3,1)$: In-ROI neighbors are at $k=1,2,3$. $s(3,1)=2^1+2^2+2^3 = 2+4+8 = 14$.\n    -   Pixel $(3,3)$: In-ROI neighbors are at $k=7,0,1$. $s(3,3)=2^7+2^0+2^1 = 128+1+2 = 131$.\n    -   Pixel $(1,2)$: In-ROI neighbors are at $k=3,4,5,6,7$. $s(1,2)=2^3+2^4+2^5+2^6+2^7 = 8+16+32+64+128 = 248$.\n    -   Pixel $(2,1)$: In-ROI neighbors are at $k=1,2,3,4,5$. $s(2,1)=2^1+2^2+2^3+2^4+2^5 = 2+4+8+16+32 = 62$.\n    -   Pixel $(2,3)$: In-ROI neighbors are at $k=5,6,7,0,1$. $s(2,3)=2^5+2^6+2^7+2^0+2^1 = 32+64+128+1+2 = 227$.\n    -   Pixel $(3,2)$: In-ROI neighbors are at $k=7,0,1,2,3$. $s(3,2)=2^7+2^0+2^1+2^2+2^3 = 128+1+2+4+8 = 143$.\n\n**3. Normalized LBP Histograms**\n\nThe histogram is the normalized distribution of the calculated LBP codes.\n-   $H_{\\text{Ignore}}$: One pixel with code $0$.\n    $H_{\\text{Ignore}}(0) = 1$.\n-   $H_{\\text{Mirror}}$: One pixel with code $0$, eight pixels with code $255$.\n    $H_{\\text{Mirror}}(0) = 1/9$, $H_{\\text{Mirror}}(255) = 8/9$.\n-   $H_{\\text{Wrap}}$: One pixel with code $0$, eight pixels with code $255$.\n    $H_{\\text{Wrap}}(0) = 1/9$, $H_{\\text{Wrap}}(255) = 8/9$.\n-   $H_{\\text{Partial}}$: Nine pixels, each with a unique code.\n    $H_{\\text{Partial}}(s) = 1/9$ for $s \\in \\{0, 14, 56, 62, 131, 143, 224, 227, 248\\}$.\n\n**4. Jensen-Shannon Divergence Calculation**\n\nThe JS divergence between two probability distributions $P$ and $Q$ is $D_{JS}(P || Q) = \\frac{1}{2} D_{KL}(P || M) + \\frac{1}{2} D_{KL}(Q || M)$, where $M = \\frac{1}{2}(P+Q)$ and $D_{KL}(P || M) = \\sum_i P(i) \\ln\\frac{P(i)}{M(i)}$.\n\nLet $P = H_{\\text{Ignore}}$ and $Q = H_{\\text{Mirror}}$. The LBP codes are indexed by $i$.\nThe non-zero probabilities are:\n$P(0) = 1$\n$Q(0) = 1/9$, $Q(255) = 8/9$\n\nThe mixture distribution $M = \\frac{1}{2}(P+Q)$ has non-zero probabilities:\n$M(0) = \\frac{1}{2}(P(0) + Q(0)) = \\frac{1}{2}(1 + 1/9) = \\frac{1}{2}(10/9) = 5/9$.\n$M(255) = \\frac{1}{2}(P(255) + Q(255)) = \\frac{1}{2}(0 + 8/9) = \\frac{1}{2}(8/9) = 4/9$.\n\nFirst KL divergence term, $D_{KL}(P || M)$:\nThe sum is over $i$ where $P(i) > 0$, which is only $i=0$.\n$$ D_{KL}(P || M) = P(0) \\ln\\left(\\frac{P(0)}{M(0)}\\right) = 1 \\cdot \\ln\\left(\\frac{1}{5/9}\\right) = \\ln(9/5) $$\n\nSecond KL divergence term, $D_{KL}(Q || M)$:\nThe sum is over $i$ where $Q(i) > 0$, which are $i=0$ and $i=255$.\n$$ D_{KL}(Q || M) = Q(0) \\ln\\left(\\frac{Q(0)}{M(0)}\\right) + Q(255) \\ln\\left(\\frac{Q(255)}{M(255)}\\right) $$\n$$ D_{KL}(Q || M) = \\frac{1}{9} \\ln\\left(\\frac{1/9}{5/9}\\right) + \\frac{8}{9} \\ln\\left(\\frac{8/9}{4/9}\\right) = \\frac{1}{9} \\ln\\left(\\frac{1}{5}\\right) + \\frac{8}{9} \\ln(2) = -\\frac{1}{9}\\ln(5) + \\frac{8}{9}\\ln(2) $$\n\nNow, combine them to find the JS divergence:\n$$ D_{JS}(P || Q) = \\frac{1}{2} \\left[ D_{KL}(P || M) + D_{KL}(Q || M) \\right] $$\n$$ D_{JS}(P || Q) = \\frac{1}{2} \\left[ \\ln\\left(\\frac{9}{5}\\right) - \\frac{1}{9}\\ln(5) + \\frac{8}{9}\\ln(2) \\right] $$\n$$ D_{JS}(P || Q) = \\frac{1}{2} \\left[ \\ln(9) - \\ln(5) - \\frac{1}{9}\\ln(5) + \\frac{8}{9}\\ln(2) \\right] $$\n$$ D_{JS}(P || Q) = \\frac{1}{2} \\left[ 2\\ln(3) - \\frac{10}{9}\\ln(5) + \\frac{8}{9}\\ln(2) \\right] $$\n$$ D_{JS}(P || Q) = \\ln(3) - \\frac{5}{9}\\ln(5) + \\frac{4}{9}\\ln(2) $$\n\nTo obtain the numerical value, we use the natural logarithm values:\n$\\ln(2) \\approx 0.693147$\n$\\ln(3) \\approx 1.098612$\n$\\ln(5) \\approx 1.609438$\n$$ D_{JS}(P || Q) \\approx 1.098612 - \\frac{5}{9}(1.609438) + \\frac{4}{9}(0.693147) $$\n$$ D_{JS}(P || Q) \\approx 1.098612 - 0.894132 + 0.308065 $$\n$$ D_{JS}(P || Q) \\approx 0.512545 $$\nRounding to four significant figures, the result is $0.5125$ nats.",
            "answer": "$$\\boxed{0.5125}$$"
        },
        {
            "introduction": "The LBP algorithm is based on a simple thresholding rule: is a neighbor's intensity greater than or equal to the center's? This practice delves into a subtle but critical detail: what happens in the case of a tie, where $I_{n} = I_{c}$? Using a principled model of image noise and quantization, this exercise reveals how arbitrary tie-breaking can introduce systematic bias into texture features, especially in low-contrast regions . It challenges you to move beyond simple rules and adopt a statistical mindset to ensure the robustness and reproducibility of your analysis.",
            "id": "4565424",
            "problem": "In a radiomics pipeline, Local Binary Patterns (LBP) are used to summarize local texture by thresholding each neighbor intensity against the center intensity. Let the $P$-neighbor LBP at radius $R$ be defined by the thresholding function $s(x)$ applied to the difference $x = I_{n} - I_{c}$ for each neighbor $n$, where $I_{n}$ and $I_{c}$ are observed image intensities at the neighbor and center, respectively. Assume the following foundational model in a low-contrast homogeneous region:\n- The true underlying intensity is constant, so $T_{n} = T_{c} = T$.\n- Observed intensities are corrupted by additive, independent, zero-mean Gaussian noise: $I_{n} = T + \\varepsilon_{n}$ and $I_{c} = T + \\varepsilon_{c}$ with $\\varepsilon_{n}, \\varepsilon_{c} \\sim \\mathcal{N}(0,\\sigma^{2})$, independent.\n- Intensities are discretized by uniform scalar quantization with step size $\\Delta > 0$, i.e., $Q(x) = \\Delta \\left\\lfloor \\frac{x}{\\Delta} \\right\\rfloor$, and the LBP comparison is performed on the quantized intensities, so the observable decision variable is $d_{q} = Q(I_{n}) - Q(I_{c})$.\n\nDefine the binary thresholding function by\n$$\ns(x) = \n\\begin{cases}\n1, & x > 0, \\\\\n0, & x < 0,\n\\end{cases}\n$$\nand a tie convention for $x = 0$ is required. In low-contrast homogeneous regions, ties occur when $d_{q} = 0$. Let $p_{t} = \\mathbb{P}(d_{q} = 0)$ denote the tie probability under the model above.\n\nUsing the model assumptions and first principles about independence, symmetry, and quantization, analyze the effect of setting $s(0) = 1$ versus $s(0) = 0$ on the expected fraction of ones per neighbor in the LBP code for low-contrast regions. Then, propose a principled tie-breaking rule based on noise statistics that avoids bias in the expected fraction of ones and enhances reproducibility of histogram-based radiomic features.\n\nWhich option is correct?\n\nA. In homogeneous low-contrast regions with additive symmetric noise and uniform quantization, $\\mathbb{P}(d_{q} > 0) = \\mathbb{P}(d_{q} < 0)$ and $\\mathbb{P}(d_{q} = 0) = p_{t}$. The expected fraction of ones per neighbor is $\\frac{1 - p_{t}}{2} + p_{t} s(0)$, so $s(0) = 1$ yields an upward bias of $\\frac{p_{t}}{2}$ relative to $0.5$ and $s(0) = 0$ yields a downward bias of $\\frac{p_{t}}{2}$. A principled tie-breaking rule is to assign ties using the posterior probability $w = \\mathbb{P}(I_{n} \\ge I_{c} \\mid d_{q} = 0)$; under the symmetric noise model $w = \\frac{1}{2}$, so ties contribute half to the $1$ outcome and half to the $0$ outcome (soft histogram weighting), removing bias without randomization.\n\nB. In homogeneous low-contrast regions, setting $s(0) = 0$ is unbiased because $\\mathbb{P}(d_{q} = 0)$ is negligible; therefore, no special tie-breaking is needed.\n\nC. The choice $s(0) = 1$ or $s(0) = 0$ is equivalent whenever $p_{t} > 0$. A principled rule is to set $s(0) = 1$ if $\\sigma < \\Delta$ and $s(0) = 0$ otherwise, because quantization dominates noise when $\\sigma < \\Delta$.\n\nD. Setting $s(0) = 1$ reduces the count of uniform patterns and increases non-uniform patterns in low-contrast regions. A principled tie-breaking rule is to add a small random jitter $\\eta \\sim \\mathcal{N}(0,\\sigma^{2})$ to break ties by sampling, which ensures fair outcomes across images.",
            "solution": "The problem asks for an analysis of tie-breaking in the computation of Local Binary Patterns (LBP) in a specific context of radiomics, where image intensities are modeled as a constant true value corrupted by additive, independent, zero-mean Gaussian noise, followed by uniform scalar quantization.\n\n### Problem Validation\n\nThe problem statement has been validated and is deemed **valid**. It is scientifically grounded in statistical signal processing and image analysis, well-posed with a clear probabilistic model, and uses objective, formal language. All necessary information for a rigorous derivation is provided.\n\n### Derivation\n\n**1. Distribution of the Intensity Difference**\n\nLet the unquantized intensities at a neighbor and center pixel be $I_n$ and $I_c$, respectively. According to the model, we have:\n$$I_n = T + \\varepsilon_n$$\n$$I_c = T + \\varepsilon_c$$\nwhere $T$ is the constant true intensity, and $\\varepsilon_n, \\varepsilon_c$ are independent and identically distributed (i.i.d.) random variables from a normal distribution $\\mathcal{N}(0, \\sigma^2)$.\n\nThe difference in unquantized intensities is a random variable $X = I_n - I_c = (T + \\varepsilon_n) - (T + \\varepsilon_c) = \\varepsilon_n - \\varepsilon_c$.\nAs the difference of two independent, zero-mean Gaussian random variables, $X$ is also a Gaussian random variable.\n- The mean of $X$ is $\\mathbb{E}[X] = \\mathbb{E}[\\varepsilon_n] - \\mathbb{E}[\\varepsilon_c] = 0 - 0 = 0$.\n- The variance of $X$ is $\\text{Var}(X) = \\text{Var}(\\varepsilon_n - \\varepsilon_c) = \\text{Var}(\\varepsilon_n) + \\text{Var}(\\varepsilon_c) = \\sigma^2 + \\sigma^2 = 2\\sigma^2$, due to independence.\nThus, $X \\sim \\mathcal{N}(0, 2\\sigma^2)$. The probability density function (PDF) of $X$ is continuous and symmetric about $0$. This implies $\\mathbb{P}(X > 0) = \\mathbb{P}(X < 0) = 1/2$.\n\n**2. Distribution of the Quantized Difference**\n\nThe LBP comparison is performed on quantized intensities. The decision variable is $d_q = Q(I_n) - Q(I_c)$, where $Q(x) = \\Delta \\lfloor \\frac{x}{\\Delta} \\rfloor$.\nThe possible values of $d_q$ are integer multiples of the quantization step $\\Delta$. The distribution of $d_q$ is discrete.\n\nLet's analyze the symmetry of the distribution of $d_q$. We are interested in the probabilities of three mutually exclusive events: $d_q > 0$, $d_q < 0$, and $d_q = 0$.\nThe event $d_q=0$ is the tie event, with probability $p_t = \\mathbb{P}(d_q=0)$. This occurs when $Q(I_n) = Q(I_c)$, which implies $I_n$ and $I_c$ fall into the same quantization bin. For any finite $\\Delta > 0$ and $\\sigma > 0$, this probability $p_t$ is strictly positive.\n\nConsider the joint PDF of $(I_n, I_c)$, let it be $f(i_n, i_c)$. Since $I_n$ and $I_c$ are i.i.d. (after subtracting the mean $T$), their joint PDF is symmetric with respect to its arguments: $f(i_n, i_c) = f(i_c, i_n)$.\n\nThe probability $\\mathbb{P}(d_q > 0)$ is the sum of probabilities $\\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$ for all integers $k > 0$.\nThe probability $\\mathbb{P}(d_q < 0)$ is the sum of probabilities $\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta)$ for all integers $k > 0$.\n\nLet's compare $\\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$ and $\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta)$ for a fixed $k > 0$.\n$\\mathbb{P}(Q(I_n) - Q(I_c) = -k\\Delta) = \\mathbb{P}(Q(I_c) - Q(I_n) = k\\Delta)$.\nBecause the pair $(I_n, I_c)$ has the same joint distribution as the pair $(I_c, I_n)$, it follows that $\\mathbb{P}(Q(I_c) - Q(I_n) = k\\Delta) = \\mathbb{P}(Q(I_n) - Q(I_c) = k\\Delta)$.\nTherefore, the distribution of $d_q$ is symmetric about $0$. This implies:\n$$\\mathbb{P}(d_q > 0) = \\mathbb{P}(d_q < 0)$$\nSince the total probability is $1$, we have:\n$$\\mathbb{P}(d_q > 0) + \\mathbb{P}(d_q < 0) + \\mathbb{P}(d_q = 0) = 1$$\nSubstituting the symmetry property and $p_t = \\mathbb{P}(d_q=0)$:\n$$2 \\cdot \\mathbb{P}(d_q > 0) + p_t = 1$$\nThis yields:\n$$\\mathbb{P}(d_q > 0) = \\mathbb{P}(d_q < 0) = \\frac{1 - p_t}{2}$$\n\n**3. Expected Fraction of Ones and Bias Analysis**\n\nThe LBP bit is determined by the function $s(d_q)$. The expected fraction of ones is the expected value $\\mathbb{E}[s(d_q)]$.\nThe function is defined as $s(x)=1$ for $x>0$ and $s(x)=0$ for $x<0$. The value $s(0)$ is a chosen convention.\nThe expected value is:\n$$\\mathbb{E}[s(d_q)] = 1 \\cdot \\mathbb{P}(s(d_q)=1) + 0 \\cdot \\mathbb{P}(s(d_q)=0) = \\mathbb{P}(s(d_q)=1)$$\nThe event $s(d_q)=1$ occurs if $d_q > 0$, or if $d_q = 0$ and we define $s(0)=1$.\nSo, $\\mathbb{P}(s(d_q)=1) = \\mathbb{P}(d_q > 0) + \\mathbb{P}(d_q=0 \\text{ and } s(0)=1)$.\nAssuming $s(0)$ is a fixed value (e.g., $0$ or $1$), we can write this as:\n$$\\mathbb{E}[s(d_q)] = \\mathbb{P}(d_q > 0) + s(0) \\cdot \\mathbb{P}(d_q=0)$$\nSubstituting the probabilities derived earlier:\n$$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + s(0) \\cdot p_t$$\nIn a homogeneous region, the underlying signal provides no directional information, so an unbiased LBP operator should yield '1's and '0's with equal probability, i.e., the expected fraction of ones should be $1/2$.\nLet's analyze the bias (deviation from $1/2$) for the two common conventions for $s(0)$:\n\n- If $s(0)=1$:\n  $$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + p_t = \\frac{1+p_t}{2} = \\frac{1}{2} + \\frac{p_t}{2}$$\n  This introduces a positive bias of $\\frac{p_t}{2}$.\n\n- If $s(0)=0$:\n  $$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + 0 \\cdot p_t = \\frac{1 - p_t}{2} = \\frac{1}{2} - \\frac{p_t}{2}$$\n  This introduces a negative bias of $-\\frac{p_t}{2}$.\n\nSince $p_t > 0$, both conventions introduce a systematic bias in homogeneous regions, which can corrupt texture features derived from LBP histograms.\n\n**4. Principled Tie-Breaking Rule**\n\nTo eliminate bias, the expected fraction of ones must be $1/2$. This requires a rule for handling ties ($d_q=0$). A principled approach is to determine the best estimate for the \"true\" sign of the unquantized difference $I_n - I_c$, given the observation $d_q=0$. This can be formulated as finding the posterior probability $w = \\mathbb{P}(I_n \\ge I_c \\mid d_q = 0)$. This probability $w$ represents the ideal \"soft\" value for $s(0)$.\n\nLet's calculate $w$.\n$$w = \\mathbb{P}(I_n \\ge I_c \\mid Q(I_n) = Q(I_c)) = \\frac{\\mathbb{P}(I_n \\ge I_c \\text{ and } Q(I_n) = Q(I_c))}{\\mathbb{P}(Q(I_n) = Q(I_c))}$$\nThe event $\\{I_n \\ge I_c\\}$ can be split into $\\{I_n > I_c\\}$ and $\\{I_n=I_c\\}$. Since the underlying distribution of $I_n-I_c$ is continuous, $\\mathbb{P}(I_n=I_c)=0$. Thus, $\\mathbb{P}(I_n \\ge I_c) = \\mathbb{P}(I_n > I_c)$.\n\nAs established in step 2, the joint PDF $f(i_n, i_c)$ is symmetric. This symmetry implies:\n$$\\mathbb{P}(I_n > I_c \\text{ and } Q(I_n) = Q(I_c)) = \\mathbb{P}(I_c > I_n \\text{ and } Q(I_c) = Q(I_n))$$\nThe denominator is $p_t = \\mathbb{P}(Q(I_n) = Q(I_c))$, which is the sum of probabilities over three disjoint regions:\n$$p_t = \\mathbb{P}(I_n > I_c, Q(I_n)=Q(I_c)) + \\mathbb{P}(I_n < I_c, Q(I_n)=Q(I_c)) + \\mathbb{P}(I_n = I_c, Q(I_n)=Q(I_c))$$\nLet $P_{>}$ be the first term and $P_{<}$ be the second. The third term is $0$.\nFrom the symmetry argument, $P_{>} = P_{<}$. Thus, $p_t = 2 P_{>}$.\nThe numerator of $w$ is $\\mathbb{P}(I_n \\ge I_c \\text{ and } Q(I_n)=Q(I_c)) = P_{>}$.\nTherefore,\n$$w = \\frac{P_{>}}{p_t} = \\frac{P_{>}}{2 P_{>}} = \\frac{1}{2}$$\nThis means that given a tie in the quantized domain, it is equally likely that the true unquantized neighbor intensity was greater or smaller than the center intensity. The most principled value for $s(0)$ is this posterior probability, $1/2$.\n\nUsing $s(0)=1/2$ (conceptually, as a soft weight), the expected fraction of ones becomes:\n$$\\mathbb{E}[s(d_q)] = \\frac{1 - p_t}{2} + \\frac{1}{2} \\cdot p_t = \\frac{1 - p_t + p_t}{2} = \\frac{1}{2}$$\nThis choice removes the bias. In practice, this can be implemented deterministically by adding $1/2$ to the LBP code value for each tie, or by using soft histogramming. This deterministic approach avoids the reproducibility issues of random tie-breaking.\n\n### Option-by-Option Analysis\n\n**A. In homogeneous low-contrast regions with additive symmetric noise and uniform quantization, $\\mathbb{P}(d_{q} > 0) = \\mathbb{P}(d_{q} < 0)$ and $\\mathbb{P}(d_{q} = 0) = p_{t}$. The expected fraction of ones per neighbor is $\\frac{1 - p_{t}}{2} + p_{t} s(0)$, so $s(0) = 1$ yields an upward bias of $\\frac{p_{t}}{2}$ relative to $0.5$ and $s(0) = 0$ yields a downward bias of $\\frac{p_{t}}{2}$. A principled tie-breaking rule is to assign ties using the posterior probability $w = \\mathbb{P}(I_{n} \\ge I_{c} \\mid d_{q} = 0)$; under the symmetric noise model $w = \\frac{1}{2}$, so ties contribute half to the $1$ outcome and half to the $0$ outcome (soft histogram weighting), removing bias without randomization.**\nThis statement is fully consistent with our derivation. Each sub-claim—the symmetry of $d_q$'s distribution, the formula for the expected fraction of ones, the resulting bias for $s(0)=1$ and $s(0)=0$, and the proposed principled, unbiased, and reproducible tie-breaking rule—is correct.\n**Verdict: Correct.**\n\n**B. In homogeneous low-contrast regions, setting $s(0) = 0$ is unbiased because $\\mathbb{P}(d_{q} = 0)$ is negligible; therefore, no special tie-breaking is needed.**\nThis is incorrect. As shown above, setting $s(0)=0$ results in a bias of $-\\frac{p_t}{2}$. The claim that $p_t = \\mathbb{P}(d_q=0)$ is negligible is an unsubstantiated and generally false assumption. The tie probability depends on the ratio of noise variance $\\sigma^2$ to the quantization step size $\\Delta$, and can be substantial, especially when noise is low relative to the quantization step ($\\sigma \\ll \\Delta$).\n**Verdict: Incorrect.**\n\n**C. The choice $s(0) = 1$ or $s(0) = 0$ is equivalent whenever $p_{t} > 0$. A principled rule is to set $s(0) = 1$ if $\\sigma < \\Delta$ and $s(0) = 0$ otherwise, because quantization dominates noise when $\\sigma < \\Delta$.**\nThis statement is incorrect. The choices $s(0)=1$ and $s(0)=0$ are not equivalent; they lead to biases of opposite signs. They would only be equivalent if $p_t = 0$. The proposed rule is ad-hoc and not principled; it does not remove the bias but merely switches between a positive and negative bias based on an arbitrary threshold on $\\sigma/\\Delta$. The reasoning is fallacious.\n**Verdict: Incorrect.**\n\n**D. Setting $s(0) = 1$ reduces the count of uniform patterns and increases non-uniform patterns in low-contrast regions. A principled tie-breaking rule is to add a small random jitter $\\eta \\sim \\mathcal{N}(0,\\sigma^{2})$ to break ties by sampling, which ensures fair outcomes across images.**\nThe first claim is questionable. In a low-contrast region with high tie probability $p_t$, setting $s(0)=1$ would tend to produce LBP codes with many '1's (e.g., `11111111`), while $s(0)=0$ would produce codes with many '0's (e.g., `00000000`). Both are uniform patterns. The choice of $s(0)$ influences *which* uniform pattern is prevalent, but does not necessarily reduce the overall count of uniform patterns. The second part of the statement proposes randomization to break ties. While this can remove the bias *in expectation*, it violates the goal of enhancing reproducibility, which is critical for robust radiomic features. The method proposed in option A is superior as it is both unbiased and deterministic.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}