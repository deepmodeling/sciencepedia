{
    "hands_on_practices": [
        {
            "introduction": "在医学图像分析中，分割算法的性能通常通过混淆矩阵进行评估，该矩阵提供了真正例 ($TP$)、假正例 ($FP$) 和假反例 ($FN$) 等计数。本练习旨在巩固这些基本计数与戴斯相似系数 (Dice Similarity Coefficient, DSC) 和雅卡尔指数 (Jaccard Index) 的集合论定义之间的核心联系。通过解决这个问题 ，你将学会如何将原始的性能计数直接转换为最常用的基于重叠的准确度指标，这是评估分割模型的一项核心技能。",
            "id": "4560066",
            "problem": "一份三维脑部磁共振成像（MRI）扫描被分割成固定的体素网格，用于放射组学中的定量分析。令 $G$ 表示专家标注的金标准中被标记为肿瘤感兴趣区域（ROI）的体素集合，令 $S$ 表示由自动分割算法标记为肿瘤的体素集合。在将 $S$ 与 $G$ 进行比较时，记录了以下混淆矩阵计数：真正例 (TP) $=800$，假正例 (FP) $=200$，假负例 (FN) $=100$，以及真负例 (TN) $=4900$。仅使用集合论定义以及混淆矩阵计数与集合基数之间的映射关系，计算此分割的 Dice 相似系数（DSC）与 Jaccard 指数（JI）之比。将您的最终答案表示为一个未经四舍五入的精确分数。",
            "solution": "此问题已经过验证。\n\n### 步骤 1：提取已知条件\n- $G$：金标准感兴趣区域（ROI）中的体素集合。\n- $S$：自动算法分割出的 ROI 中的体素集合。\n- 真正例计数，$TP = 800$。\n- 假正例计数，$FP = 200$。\n- 假负例计数，$FN = 100$。\n- 真负例计数，$TN = 4900$。\n- 任务是计算 Dice 相似系数（$DSC$）与 Jaccard 指数（$JI$）之比。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于图像分割算法量化评估中使用的标准、公认的度量标准（Dice 相似系数、Jaccard 指数）和概念（真正例、假正例、假负例），这是放射组学和医学图像分析中的一项核心任务。这些概念在事实上和科学上都是合理的。\n- **适定性**：该问题提供了计算 $DSC$ 和 $JI$ 所需的所有数值（$TP$、$FP$、$FN$）。这些度量标准的定义是明确的。目标清晰，且存在唯一解。\n- **客观性**：该问题使用精确、量化且无偏见的语言进行陈述。\n\n### 步骤 3：结论与操作\n该问题是有效的，因为它具有科学依据、适定、客观，并包含足够的信息以获得唯一解。\n\n### 解题过程\n解决方案源于分割精度度量标准的基本集合论定义及其与混淆矩阵计数的关系。\n\n令 $G$ 为金标准分割中的体素集合，令 $S$ 为算法分割中的体素集合。混淆矩阵计数（$TP$、$FP$、$FN$）可以用 $G$ 和 $S$ 上集合运算的基数来表示：\n- 真正例数 $TP$ 是被正确识别为肿瘤一部分的体素数量。这对应于两个集合交集的基数：\n$$TP = |G \\cap S|$$\n- 假正例数 $FP$ 是被算法错误识别为肿瘤一部分的体素数量。这对应于在 $S$ 中但不在 $G$ 中的体素集合的基数：\n$$FP = |S \\setminus G| = |S| - |G \\cap S|$$\n- 假负例数 $FN$ 是算法遗漏的肿瘤体素数量。这对应于在 $G$ 中但不在 $S$ 中的体素集合的基数：\n$$FN = |G \\setminus S| = |G| - |G \\cap S|$$\n请注意，真负例数 $TN$ 代表被正确识别为背景的体素，计算 Dice 或 Jaccard 指数时不需要此值。\n\n根据这些定义，我们可以用 $TP$、$FP$ 和 $FN$ 来表示单个集合 $G$ 和 $S$ 的基数：\n$$|G| = |G \\cap S| + |G \\setminus S| = TP + FN$$\n$$|S| = |G \\cap S| + |S \\setminus G| = TP + FP$$\n\nDice 相似系数（$DSC$）定义为交集大小的两倍除以两个集合大小之和：\n$$DSC = \\frac{2 |G \\cap S|}{|G| + |S|}$$\n代入混淆矩阵项：\n$$DSC = \\frac{2 \\cdot TP}{(TP + FN) + (TP + FP)} = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}$$\n\nJaccard 指数（$JI$），也称为交并比（IoU），定义为交集的大小除以两个集合并集的大小：\n$$JI = \\frac{|G \\cap S|}{|G \\cup S|}$$\n并集的基数由 $|G \\cup S| = |G| + |S| - |G \\cap S|$ 给出。代入混淆矩阵项：\n$$|G \\cup S| = (TP + FN) + (TP + FP) - TP = TP + FP + FN$$\n因此，雅卡尔指数为：\n$$JI = \\frac{TP}{TP + FP + FN}$$\n\n问题要求计算比率 $\\frac{DSC}{JI}$。现在我们可以代入 $DSC$ 和 $JI$ 的表达式：\n$$\\frac{DSC}{JI} = \\frac{\\left( \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} \\right)}{\\left( \\frac{TP}{TP + FP + FN} \\right)}$$\n为简化这个繁分数，我们将分子乘以分母的倒数：\n$$\\frac{DSC}{JI} = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} \\times \\frac{TP + FP + FN}{TP}$$\n分子和分母中的 $TP$ 项可以消去，前提是 $TP \\neq 0$，在本例中此条件成立（$TP = 800$）。\n$$\\frac{DSC}{JI} = \\frac{2 (TP + FP + FN)}{2 \\cdot TP + FP + FN}$$\n现在，我们代入给定的数值：$TP = 800$，$FP = 200$，$FN = 100$。\n$$\\frac{DSC}{JI} = \\frac{2 (800 + 200 + 100)}{2(800) + 200 + 100}$$\n我们计算分子和分母的值。\n分子：$2 \\times (1100) = 2200$。\n分母：$1600 + 200 + 100 = 1900$。\n因此，该比率为：\n$$\\frac{DSC}{JI} = \\frac{2200}{1900}$$\n为了将其表示为最简精确分数，我们将分子和分母同时除以它们的最大公约数 $100$：\n$$\\frac{DSC}{JI} = \\frac{22}{19}$$\n分数 $\\frac{22}{19}$ 是不可约分的，因为 $19$ 是一个质数，不能整除 $22$。",
            "answer": "$$\n\\boxed{\\frac{22}{19}}\n$$"
        },
        {
            "introduction": "除了戴斯系数和雅卡尔指数，精确率 (precision)、召回率 (recall) 和 F1 分数 (F1 score) 等指标也常用于评估模型性能，理解它们之间的关系是进行全面评估的关键。本练习将引导你探索基于重叠的指数与常见分类指标之间的深层数学联系。通过这个练习 ，你将揭示一个重要的恒等式——戴斯系数等价于 F1 分数，从而将两个看似不同的评估指标体系联系起来，丰富你的概念工具箱。",
            "id": "4560067",
            "problem": "一个放射组学流程评估了计算机断层扫描（CT）图像上一个肝脏病灶的二元分割结果，该评估在一个包含 $N$ 个体素的感兴趣区域（ROI）内进行。设预测的病灶掩码为集合 $\\mathcal{P}$，真实的病灶掩码为集合 $\\mathcal{G}$。重叠部分为 $\\mathcal{P} \\cap \\mathcal{G}$，标准的混淆计数根据集合基数定义如下：真阳性（TP）为 $|\\mathcal{P} \\cap \\mathcal{G}|$，假阳性（FP）为 $|\\mathcal{P} \\setminus \\mathcal{G}|$，假阴性（FN）为 $|\\mathcal{G} \\setminus \\mathcal{P}|$，真阴性（TN）为 ROI 中既不属于 $\\mathcal{P}$ 也不属于 $\\mathcal{G}$ 的体素数量。精确率定义为预测为阳性中正确的比例，召回率定义为实际为阳性中被正确预测的比例，F1 分数定义为精确率和召回率的调和平均数，准确率定义为所有 ROI 体素中被正确分类的比例。\n\n对于一个特定案例，给定 $N = 10{,}000$，$|\\mathcal{G}| = 1{,}280$，$|\\mathcal{P}| = 1{,}000$，以及在 ROI 上的测量准确率 $a = 0.95$。仅使用上述基本定义：\n\n1.  推导 $|\\mathcal{P} \\cap \\mathcal{G}|$ 关于 $N$、$|\\mathcal{G}|$、$|\\mathcal{P}|$ 和 $a$ 的表达式。\n2.  推导 Dice 系数关于精确率和召回率的表达式，并另外推导 Jaccard 指数关于 F1 分数的表达式。\n3.  为给定案例数值计算 Jaccard 指数。\n\n将最终数值表示为精确分数。无需四舍五入。",
            "solution": "首先验证问题，确保其自洽、科学合理且提问清晰。\n\n**第一步：提取已知条件**\n- 感兴趣区域（ROI）中的总体素数：$N = 10,000$。\n- 预测的病灶掩码集合：$\\mathcal{P}$。\n- 真实的病灶掩码集合：$\\mathcal{G}$。\n- 真实掩码的基数：$|\\mathcal{G}| = 1,280$。\n- 预测掩码的基数：$|\\mathcal{P}| = 1,000$。\n- 在 ROI 上测得的准确率：$a = 0.95$。\n- 真阳性（TP）：$TP = |\\mathcal{P} \\cap \\mathcal{G}|$。\n- 假阳性（FP）：$FP = |\\mathcal{P} \\setminus \\mathcal{G}|$。\n- 假阴性（FN）：$FN = |\\mathcal{G} \\setminus \\mathcal{P}|$。\n- 真阴性（TN）：ROI 中既不属于 $\\mathcal{P}$ 也不属于 $\\mathcal{G}$ 的体素数量，即 $|\\Omega \\setminus (\\mathcal{P} \\cup \\mathcal{G})|$，其中 $\\Omega$ 是 ROI 中所有体素的集合。\n- 精确率：$P = \\frac{TP}{TP + FP}$。\n- 召回率：$R = \\frac{TP}{TP + FN}$。\n- F1 分数：精确率和召回率的调和平均数。\n- 准确率：$a = \\frac{TP + TN}{N}$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题使用了机器学习和医学图像分析领域的标准、正式定义。所提供的数据是数值性的且内部一致。问题具体，可导出一个唯一的解。没有违反任何科学原理，也没有歧义或完成任务所需的信息缺失。问题被判定为有效。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n**第一部分：推导 $|\\mathcal{P} \\cap \\mathcal{G}|$ 的表达式**\n\n准确率 $a$ 定义为正确分类的体素数占总体素数 $N$ 的比例：\n$$a = \\frac{TP + TN}{N}$$\n真阳性数 $TP$ 由预测集合与真实集合交集的基数给出：\n$$TP = |\\mathcal{P} \\cap \\mathcal{G}|$$\n真阴性数 $TN$ 表示被正确识别为背景的体素。这些是同时在预测掩码 $\\mathcal{P}$ 和真实掩码 $\\mathcal{G}$ 之外的体素。使用容斥原理，两个集合并集中的体素数为 $|\\mathcal{P} \\cup \\mathcal{G}| = |\\mathcal{P}| + |\\mathcal{G}| - |\\mathcal{P} \\cap \\mathcal{G}|$。真阴性数是总体素数 $N$ 减去该并集中的体素数：\n$$TN = N - |\\mathcal{P} \\cup \\mathcal{G}| = N - (|\\mathcal{P}| + |\\mathcal{G}| - |\\mathcal{P} \\cap \\mathcal{G}|)$$\n$$TN = N - |\\mathcal{P}| - |\\mathcal{G}| + |\\mathcal{P} \\cap \\mathcal{G}|$$\n现在，将 $TP$ 和 $TN$ 的表达式代入准确率公式：\n$$a = \\frac{(|\\mathcal{P} \\cap \\mathcal{G}|) + (N - |\\mathcal{P}| - |\\mathcal{G}| + |\\mathcal{P} \\cap \\mathcal{G}|)}{N}$$\n为求解 $|\\mathcal{P} \\cap \\mathcal{G}|$ 的表达式，我们整理方程：\n$$a \\cdot N = 2|\\mathcal{P} \\cap \\mathcal{G}| + N - |\\mathcal{P}| - |\\mathcal{G}|$$\n$$a \\cdot N - N + |\\mathcal{P}| + |\\mathcal{G}| = 2|\\mathcal{P} \\cap \\mathcal{G}|$$\n$$|\\mathcal{P} \\cap \\mathcal{G}| = \\frac{a \\cdot N - N + |\\mathcal{P}| + |\\mathcal{G}|}{2}$$\n这可以更紧凑地写为：\n$$|\\mathcal{P} \\cap \\mathcal{G}| = \\frac{N(a-1) + |\\mathcal{P}| + |\\mathcal{G}|}{2}$$\n\n**第二部分：推导 Dice 和 Jaccard 指数的关系**\n\n**Dice 系数关于精确率 ($P$) 和召回率 ($R$) 的表达式**\nDice 系数定义为：\n$$Dice = \\frac{2 TP}{2 TP + FP + FN}$$\n精确率 ($P$) 和召回率 ($R$) 定义为：\n$$P = \\frac{TP}{TP+FP} \\quad \\text{and} \\quad R = \\frac{TP}{TP+FN}$$\n根据这些定义，我们可以用 $TP$、$P$ 和 $R$ 表示 $FP$ 和 $FN$：\n$$TP + FP = \\frac{TP}{P} \\implies FP = \\frac{TP}{P} - TP = TP \\left(\\frac{1}{P} - 1\\right)$$\n$$TP + FN = \\frac{TP}{R} \\implies FN = \\frac{TP}{R} - TP = TP \\left(\\frac{1}{R} - 1\\right)$$\n将这些代入 Dice 公式：\n$$Dice = \\frac{2 TP}{2 TP + TP \\left(\\frac{1}{P} - 1\\right) + TP \\left(\\frac{1}{R} - 1\\right)}$$\n假设 $TP  0$，我们可以约去分子和分母中的 $TP$：\n$$Dice = \\frac{2}{2 + \\left(\\frac{1}{P} - 1\\right) + \\left(\\frac{1}{R} - 1\\right)} = \\frac{2}{\\frac{1}{P} + \\frac{1}{R}}$$\n$$Dice = \\frac{2}{\\frac{R+P}{PR}} = \\frac{2PR}{P+R}$$\n此表达式是精确率和召回率的调和平均数，也即 F1 分数的定义。因此，$Dice = F_1$。Dice 系数关于精确率和召回率的表达式是 $\\frac{2PR}{P+R}$。\n\n**Jaccard 指数关于 F1 分数的表达式**\nJaccard 指数 $J$ 定义为交集与并集之比：\n$$J = \\frac{|\\mathcal{P} \\cap \\mathcal{G}|}{|\\mathcal{P} \\cup \\mathcal{G}|} = \\frac{TP}{TP+FP+FN}$$\nF1 分数（等同于 Dice 系数）为：\n$$F_1 = \\frac{2 TP}{2 TP + FP + FN}$$\n我们可以在 $J$ 和 $F_1$ 之间建立关系。根据 $J$ 的定义，我们有 $TP+FP+FN = \\frac{TP}{J}$。将此代入 $F_1$ 公式：\n$$F_1 = \\frac{2 TP}{TP + (TP+FP+FN)} = \\frac{2 TP}{TP + \\frac{TP}{J}}$$\n假设 $TP  0$，我们约去 $TP$：\n$$F_1 = \\frac{2}{1 + \\frac{1}{J}} = \\frac{2}{\\frac{J+1}{J}} = \\frac{2J}{J+1}$$\n现在，我们必须解出 $J$ 关于 $F_1$ 的表达式：\n$$F_1 (J+1) = 2J$$\n$$F_1 J + F_1 = 2J$$\n$$F_1 = 2J - F_1 J$$\n$$F_1 = J(2 - F_1)$$\n$$J = \\frac{F_1}{2 - F_1}$$\n\n**第三部分：计算给定案例的 Jaccard 指数**\n\n首先，我们使用第一部分推导的公式和给定值计算真阳性数 $TP = |\\mathcal{P} \\cap \\mathcal{G}|$：$N = 10,000$，$a = 0.95$，$|\\mathcal{P}| = 1,000$，$|\\mathcal{G}| = 1,280$。\n$$TP = \\frac{10,000(0.95-1) + 1,000 + 1,280}{2}$$\n$$TP = \\frac{10,000(-0.05) + 2,280}{2}$$\n$$TP = \\frac{-500 + 2,280}{2} = \\frac{1,780}{2} = 890$$\n接下来，我们计算假阳性数 ($FP$) 和假阴性数 ($FN$)：\n$$FP = |\\mathcal{P}| - TP = 1,000 - 890 = 110$$\n$$FN = |\\mathcal{G}| - TP = 1,280 - 890 = 390$$\n现在我们可以使用 Jaccard 指数 $J$ 的基本定义来计算它：\n$$J = \\frac{TP}{TP + FP + FN}$$\n$$J = \\frac{890}{890 + 110 + 390} = \\frac{890}{1,390}$$\n为了将其表示为最简精确分数，我们将分子和分母除以它们的最大公约数，即 $10$：\n$$J = \\frac{89}{139}$$\n由于 $89$ 和 $139$ 都是质数，此分数为最简形式。",
            "answer": "$$\\boxed{\\frac{89}{139}}$$"
        },
        {
            "introduction": "现实世界的评估通常涉及不止一张图像或一个切片，而是需要对整个数据集的分数进行汇总，这引入了诸如选择平均策略和处理边缘情况等挑战。本问题介绍了微平均 (micro-averaging) 和宏平均 (macro-averaging) 的实用概念，以及处理数值稳定性和空分割等边缘情况的惯例。通过解决这个场景 ，你将深入了解如何将单个案例的指标扩展到数据集级别的评估，并学习在计算前聚合计数（微平均）与计算后聚合平均值（宏平均）之间的关键区别。",
            "id": "4560070",
            "problem": "在一项放射组学研究中，为了评估一个三维体数据中四个轴向切片上的二值病灶分割，每个切片的金标准集和预测集通过其体素计数和交集大小来定义。记录的各切片计数如下：切片 $1$ 的金标准大小为 $120$，预测大小为 $130$，交集大小为 $110$；切片 $2$ 的金标准大小为 $80$，预测大小为 $70$，交集大小为 $60$；切片 $3$ 的金标准大小为 $0$，预测大小为 $0$，交集大小为 $0$；切片 $4$ 的金标准大小为 $5$，预测大小为 $50$，交集大小为 $5$。假设在计算正类分割的重叠度指标时，不使用真阴性；并且所有集合仅指被金标准或预测标记为阳性的体素。\n\n从基于集合论的分割重叠相似度的标准定义出发，使用集合基数来定义 Dice 相似系数 (DSC) 和 Jaccard 指数（也称为交并比 IoU）。根据以下约定处理边缘情况和数值稳定性：\n- 如果某个切片的金标准和预测均为空，按照惯例，该切片的基于重叠的指标定义为 $1$。\n- 为了数值稳定性，在所有用于定义基于重叠的指标的比率中，在分子和分母上都加上一个微小常数 $\\epsilon$，其中 $\\epsilon = 1 \\times 10^{-6}$。\n\n通过在计算指标前聚合所有切片的计数来计算微平均 Dice 相似系数 $D_{\\text{micro}}$，并使用上述边缘情况约定对四个切片的逐切片指标进行平均来计算宏平均 Jaccard 指数 $J_{\\text{macro}}$。最后，构建综合得分\n$$S = \\lambda D_{\\text{micro}} + (1 - \\lambda) J_{\\text{macro}},$$\n其中 $\\lambda = 0.4$。将 $S$ 的最终答案四舍五入到五位有效数字，并以小数形式表示，不使用百分号。",
            "solution": "问题陈述已经过严格验证，并且被认为是科学上可靠、定义明确且客观的。它提供了一套来自医学图像分析（放射组学）领域的自洽、一致的数据和定义，特别是关于分割准确性度量。四个切片各自的金标准、预测和交集大小的数据在逻辑上是一致的，因为交集大小从未超过金标准和预测大小中的较小者。问题清楚地定义了处理边缘情况（空集）和确保数值稳定性的程序，这消除了歧义。该任务是一个标准的、尽管是多步骤的计算，它会得出一个唯一的、可验证的结果。因此，该问题是有效的，并且有必要给出完整解答。\n\n问题要求我们计算一个综合得分 $S$，该得分基于微平均 Dice 系数和宏平均 Jaccard 指数。让我们首先定义这些度量指标。\n\n设 $G$ 为金标准分割中的体素集合，$P$ 为预测分割中的体素集合。这些集合的基数分别表示为 $|G|$ 和 $|P|$。这些集合的交集是 $G \\cap P$。\n\nDice 相似系数 (DSC)，通常表示为 $D$，定义为：\n$$D(G, P) = \\frac{2 |G \\cap P|}{|G| + |P|}$$\nJaccard 指数，也称为交并比 (IoU)，通常表示为 $J$，定义为：\n$$J(G, P) = \\frac{|G \\cap P|}{|G \\cup P|} = \\frac{|G \\cap P|}{|G| + |P| - |G \\cap P|}$$\n\n问题指定，为了数值稳定性，应在这些比率的分子和分母上都加上一个微小常数 $\\epsilon = 1 \\times 10^{-6}$。稳定化后的公式为：\n$$D_{stab}(G, P) = \\frac{2 |G \\cap P| + \\epsilon}{|G| + |P| + \\epsilon}$$\n$$J_{stab}(G, P) = \\frac{|G \\cap P| + \\epsilon}{|G| + |P| - |G \\cap P| + \\epsilon}$$\n\n我们有 $4$ 个切片的数据。设切片 $i$ 的金标准、预测和交集分别为 $G_i$、$P_i$ 和 $G_i \\cap P_i$。给定的体素计数如下：\n- 切片 $1$：$|G_1| = 120$， $|P_1| = 130$， $|G_1 \\cap P_1| = 110$。\n- 切片 $2$：$|G_2| = 80$， $|P_2| = 70$， $|G_2 \\cap P_2| = 60$。\n- 切片 $3$：$|G_3| = 0$， $|P_3| = 0$， $|G_3 \\cap P_3| = 0$。\n- 切片 $4$：$|G_4| = 5$， $|P_4| = 50$， $|G_4 \\cap P_4| = 5$。\n\n首先，我们计算微平均 Dice 相似系数 $D_{\\text{micro}}$。微平均要求在计算度量之前，先聚合所有切片的计数。我们计算金标准、预测及其交集的总大小。\n$$|G_{\\text{total}}| = \\sum_{i=1}^{4} |G_i| = 120 + 80 + 0 + 5 = 205$$\n$$|P_{\\text{total}}| = \\sum_{i=1}^{4} |P_i| = 130 + 70 + 0 + 50 = 250$$\n$$|G_{\\text{total}} \\cap P_{\\text{total}}| = \\sum_{i=1}^{4} |G_i \\cap P_i| = 110 + 60 + 0 + 5 = 175$$\n现在我们使用这些聚合计数和稳定化的 Dice 公式来计算 $D_{\\text{micro}}$：\n$$D_{\\text{micro}} = \\frac{2 |G_{\\text{total}} \\cap P_{\\text{total}}| + \\epsilon}{|G_{\\text{total}}| + |P_{\\text{total}}| + \\epsilon} = \\frac{2(175) + 1 \\times 10^{-6}}{205 + 250 + 1 \\times 10^{-6}} = \\frac{350 + 1 \\times 10^{-6}}{455 + 1 \\times 10^{-6}}$$\n$$D_{\\text{micro}} = \\frac{350.000001}{455.000001} \\approx 0.769230769$$\n\n接下来，我们计算宏平均 Jaccard 指数 $J_{\\text{macro}}$。宏平均涉及为每个切片单独计算 Jaccard 指数，然后对这些逐切片得分进行平均。\n$$J_{\\text{macro}} = \\frac{1}{4} \\sum_{i=1}^{4} J_i$$\n我们计算 $J_1, J_2, J_3,$ 和 $J_4$。\n\n对于切片 1：$|G_1|=120, |P_1|=130, |G_1 \\cap P_1|=110$。\n并集大小为 $|G_1 \\cup P_1| = |G_1| + |P_1| - |G_1 \\cap P_1| = 120 + 130 - 110 = 140$。\n$$J_1 = \\frac{|G_1 \\cap P_1| + \\epsilon}{|G_1 \\cup P_1| + \\epsilon} = \\frac{110 + 1 \\times 10^{-6}}{140 + 1 \\times 10^{-6}} = \\frac{110.000001}{140.000001} \\approx 0.785714281$$\n\n对于切片 2：$|G_2|=80, |P_2|=70, |G_2 \\cap P_2|=60$。\n并集大小为 $|G_2 \\cup P_2| = |G_2| + |P_2| - |G_2 \\cap P_2| = 80 + 70 - 60 = 90$。\n$$J_2 = \\frac{|G_2 \\cap P_2| + \\epsilon}{|G_2 \\cup P_2| + \\epsilon} = \\frac{60 + 1 \\times 10^{-6}}{90 + 1 \\times 10^{-6}} = \\frac{60.000001}{90.000001} \\approx 0.666666670$$\n\n对于切片 3：$|G_3|=0, |P_3|=0$。问题指定了边缘情况约定：如果金标准和预测均为空，该切片的指标定义为 $1$。\n$$J_3 = 1$$\n\n对于切片 4：$|G_4|=5, |P_4|=50, |G_4 \\cap P_4|=5$。\n并集大小为 $|G_4 \\cup P_4| = |G_4| + |P_4| - |G_4 \\cap P_4| = 5 + 50 - 5 = 50$。\n$$J_4 = \\frac{|G_4 \\cap P_4| + \\epsilon}{|G_4 \\cup P_4| + \\epsilon} = \\frac{5 + 1 \\times 10^{-6}}{50 + 1 \\times 10^{-6}} = \\frac{5.000001}{50.000001} \\approx 0.100000018$$\n\n现在我们计算这四个 Jaccard 指数的平均值：\n$$J_{\\text{macro}} = \\frac{1}{4} (J_1 + J_2 + J_3 + J_4)$$\n$$J_{\\text{macro}} \\approx \\frac{1}{4} (0.785714281 + 0.666666670 + 1 + 0.100000018) = \\frac{1}{4} (2.552380969) \\approx 0.638095242$$\n\n最后，我们使用公式 $S = \\lambda D_{\\text{micro}} + (1 - \\lambda) J_{\\text{macro}}$ 计算综合得分 $S$，其中 $\\lambda = 0.4$。\n$$S = (0.4) D_{\\text{micro}} + (0.6) J_{\\text{macro}}$$\n代入计算出的值：\n$$S \\approx (0.4)(0.769230769) + (0.6)(0.638095242)$$\n$$S \\approx 0.307692308 + 0.382857145$$\n$$S \\approx 0.690549453$$\n\n问题要求将 $S$ 的最终答案四舍五入到五位有效数字。计算值为 $0.690549453...$。前五位有效数字是 $6, 9, 0, 5, 4$。第六位数字是 $9$，大于或等于 $5$，因此对第五位数字进行进位。\n$$S \\approx 0.69055$$",
            "answer": "$$\\boxed{0.69055}$$"
        }
    ]
}