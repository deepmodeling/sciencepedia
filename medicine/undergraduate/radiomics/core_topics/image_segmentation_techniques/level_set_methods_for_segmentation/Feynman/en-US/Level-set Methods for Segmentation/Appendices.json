{
    "hands_on_practices": [
        {
            "introduction": "Before a contour can evolve, it must first be defined. This practice focuses on this foundational concept of implicit representation, where a shape is encoded as the zero-level set of a higher-dimensional function. By constructing a signed distance function for a simple circle on a discrete grid, you will gain a concrete understanding of how continuous geometry is captured by a discrete scalar field, a crucial first step in any level-set based segmentation task. ",
            "id": "4548887",
            "problem": "A two-dimensional radiology slice is modeled as a discrete image grid of size $128 \\times 128$ pixels. In level-set segmentation, one represents the evolving contour implicitly as the zero level set of an embedding function $\\phi$, with the convention that $\\phi  0$ inside the segmented Region of Interest (ROI) and $\\phi  0$ outside. The Euclidean distance between two pixel centers at coordinates $(i_{1}, j_{1})$ and $(i_{2}, j_{2})$ is defined as $\\sqrt{(i_{1} - i_{2})^{2} + (j_{1} - j_{2})^{2}}$, and pixel centers are located at integer coordinates $(i, j)$ with $i, j \\in \\{0, 1, \\dots, 127\\}$. Assume the circular seed region is centered at $(i_{0}, j_{0}) = (64, 64)$ with radius $r = 13$ pixels.\n\nUsing only the core definition that a level-set embedding function’s zero level set encodes the target contour, construct an initial $\\phi$ on this grid that encodes the given circular seed region as a signed embedding, and then compute the zero level set in discrete pixel coordinates, meaning the set of all integer pairs $(i, j)$ for which $\\phi(i, j) = 0$. Express the final list of $(i, j)$ pairs as a single row matrix, sorted in ascending lexicographic order by $i$ and then by $j$. No rounding is required; the coordinates are exact integers and dimensionless.",
            "solution": "The problem statement has been critically evaluated and is determined to be valid. It is scientifically grounded in the principles of level-set methods and computational geometry, is well-posed with all necessary information provided and no contradictions, and is expressed in objective, formal language. We may therefore proceed with a solution.\n\nThe problem requires the construction of a level-set function $\\phi$ for a circular region and the identification of its zero level set on a discrete pixel grid. A level-set function $\\phi$ implicitly represents a contour as the set of points where $\\phi=0$. The sign of $\\phi$ indicates whether a point is inside ($\\phi0$) or outside ($\\phi0$) the region.\n\nThe most natural choice for an embedding function for a geometric shape is the signed distance function (SDF). For a point with coordinates $(i, j)$ and a circular contour of radius $r$ centered at $(i_0, j_0)$, the SDF is defined as the Euclidean distance to the center minus the radius:\n$$\n\\phi(i, j) = \\sqrt{(i - i_{0})^{2} + (j - j_{0})^{2}} - r\n$$\nThis function is negative for points inside the circle (where the distance to the center is less than $r$), positive for points outside, and zero for points exactly on the circle.\n\nThe problem specifies the center of the circular seed region as $(i_0, j_0) = (64, 64)$ and the radius as $r = 13$. The pixel coordinates $(i, j)$ are integers. We are tasked with finding the zero level set, which is the set of all integer pairs $(i, j)$ for which $\\phi(i, j) = 0$.\nSetting the expression for $\\phi(i, j)$ to zero gives:\n$$\n\\sqrt{(i - 64)^{2} + (j - 64)^{2}} - 13 = 0\n$$\n$$\n\\sqrt{(i - 64)^{2} + (j - 64)^{2}} = 13\n$$\nSquaring both sides of the equation, we obtain:\n$$\n(i - 64)^{2} + (j - 64)^{2} = 13^{2} = 169\n$$\nThis is a Diophantine equation, representing a circle in the integer lattice. We need to find all integer solutions. Let us introduce a change of variables to simplify the problem:\nLet $x = i - 64$ and $y = j - 64$. The equation becomes:\n$$\nx^{2} + y^{2} = 169\n$$\nWe need to find all integer pairs $(x, y)$ that satisfy this equation. These pairs are related to Pythagorean triples. We can systematically find the integer solutions by testing integer values for $x$ from $0$ up to $\\lfloor\\sqrt{169}\\rfloor = 13$.\n\n- If $x=0$, $y^2 = 169 \\implies y = \\pm 13$. This gives the pairs $(0, 13)$ and $(0, -13)$.\n- If $x=1$, $y^2 = 169 - 1 = 168$, which is not a perfect square.\n- If $x=2$, $y^2 = 169 - 4 = 165$, not a perfect square.\n- If $x=3$, $y^2 = 169 - 9 = 160$, not a perfect square.\n- If $x=4$, $y^2 = 169 - 16 = 153$, not a perfect square.\n- If $x=5$, $y^2 = 169 - 25 = 144 \\implies y = \\pm 12$. This gives the pairs $(5, 12)$ and $(5, -12)$.\n- If $x=6$, $y^2 = 169 - 36 = 133$, not a perfect square.\n- If $x=7$, $y^2 = 169 - 49 = 120$, not a perfect square.\n- If $x=8$, $y^2 = 169 - 64 = 105$, not a perfect square.\n- If $x=9$, $y^2 = 169 - 81 = 88$, not a perfect square.\n- If $x=10$, $y^2 = 169 - 100 = 69$, not a perfect square.\n- If $x=11$, $y^2 = 169 - 121 = 48$, not a perfect square.\n- If $x=12$, $y^2 = 169 - 144 = 25 \\implies y = \\pm 5$. This gives the pairs $(12, 5)$ and $(12, -5)$.\n- If $x=13$, $y^2 = 169 - 169 = 0 \\implies y = 0$. This gives the pair $(13, 0)$.\n\nBy symmetry, if $(x, y)$ is a solution, then so are $(-x, y)$, $(x, -y)$, $(-x, -y)$, $(y, x)$, $(-y, x)$, $(y, -x)$, and $(-y, -x)$. Compiling all unique integer pairs $(x, y)$:\n1. From the base pair $(0, 13)$: $(0, 13), (0, -13), (13, 0), (-13, 0)$.\n2. From the base pair $(5, 12)$: $(5, 12), (5, -12), (-5, 12), (-5, -12), (12, 5), (12, -5), (-12, 5), (-12, -5)$.\n\nThis gives a total of $4 + 8 = 12$ integer solutions for $(x, y)$.\n\nNow, we transform these solutions back to the original $(i, j)$ coordinate system using $i = x + 64$ and $j = y + 64$:\n- $(x,y) = (0, 13) \\implies (i,j) = (64, 77)$\n- $(x,y) = (0, -13) \\implies (i,j) = (64, 51)$\n- $(x,y) = (13, 0) \\implies (i,j) = (77, 64)$\n- $(x,y) = (-13, 0) \\implies (i,j) = (51, 64)$\n- $(x,y) = (5, 12) \\implies (i,j) = (69, 76)$\n- $(x,y) = (5, -12) \\implies (i,j) = (69, 52)$\n- $(x,y) = (-5, 12) \\implies (i,j) = (59, 76)$\n- $(x,y) = (-5, -12) \\implies (i,j) = (59, 52)$\n- $(x,y) = (12, 5) \\implies (i,j) = (76, 69)$\n- $(x,y) = (12, -5) \\implies (i,j) = (76, 59)$\n- $(x,y) = (-12, 5) \\implies (i,j) = (52, 69)$\n- $(x,y) = (-12, -5) \\implies (i,j) = (52, 59)$\n\nThese $12$ points constitute the discrete zero level set. The final step is to sort these pairs in ascending lexicographic order (first by $i$, then by $j$):\n1. $i=51$: $(51, 64)$\n2. $i=52$: $(52, 59), (52, 69)$\n3. $i=59$: $(59, 52), (59, 76)$\n4. $i=64$: $(64, 51), (64, 77)$\n5. $i=69$: $(69, 52), (69, 76)$\n6. $i=76$: $(76, 59), (76, 69)$\n7. $i=77$: $(77, 64)$\n\nThe final ordered list of pairs is:\n$(51, 64), (52, 59), (52, 69), (59, 52), (59, 76), (64, 51), (64, 77), (69, 52), (69, 76), (76, 59), (76, 69), (77, 64)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(51, 64)  (52, 59)  (52, 69)  (59, 52)  (59, 76)  (64, 51)  (64, 77)  (69, 52)  (69, 76)  (76, 59)  (76, 69)  (77, 64)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The evolution of a level-set contour is often driven by its intrinsic geometry, particularly its mean curvature, $\\kappa$, which acts to smooth the shape. This exercise demonstrates how to compute this crucial property directly from the discrete level-set function, $\\phi$, using finite difference approximations. This practice bridges the essential gap between continuous calculus and discrete computation and introduces the vital concept of numerical accuracy by comparing the computed result with the known analytical value. ",
            "id": "4548936",
            "problem": "In radiomics segmentation using level-set methods, the interface is represented as the zero level set of a scalar field $\\phi(x,y)$, and its geometric influence on the evolution is determined by the mean curvature $\\kappa$, defined by the divergence of the unit normal field as $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\left\\lvert \\nabla \\phi \\right\\rvert} \\right)$. Consider a two-dimensional, uniformly sampled grid with spacing $\\Delta x = \\Delta y = 1$ mm. Let the level-set function be the signed distance to a circle of radius $R$, centered at the origin, namely $\\phi(x,y) = \\sqrt{x^{2} + y^{2}} - R$, with $R = 2$ mm. You will approximate $\\kappa$ at the grid node $(x_{0}, y_{0}) = (2\\ \\text{mm}, 0\\ \\text{mm})$ using second-order central differences applied to $\\phi$ on the local $3 \\times 3$ stencil consisting of the points $(x, y) \\in \\{1, 2, 3\\}\\ \\text{mm} \\times \\{-1, 0, 1\\}\\ \\text{mm}$. Treat the evaluations of $\\phi$ at grid nodes as exact. Compare the resulting discrete curvature $\\kappa_{\\text{FD}}$ to the analytic curvature of the circle at the zero level set, which equals $1/R$. Compute the absolute error $\\left\\lvert \\kappa_{\\text{FD}} - \\frac{1}{R} \\right\\rvert$ and provide it as your single final answer. Round your final answer to four significant figures. Express the final answer in $\\mathrm{mm}^{-1}$.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and self-contained. It presents a standard numerical analysis task within the context of medical imaging and computational geometry. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe task is to compute the absolute error between the numerically approximated mean curvature and its analytical value for a specific level-set function. The mean curvature, $\\kappa$, is defined by the divergence of the unit normal field of the level-set function $\\phi$.\n$$ \\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{\\left\\lvert \\nabla \\phi \\right\\rvert} \\right) $$\nIn a two-dimensional Cartesian coordinate system $(x,y)$, this expression expands to:\n$$ \\kappa = \\frac{\\phi_{xx}\\phi_y^2 - 2\\phi_x\\phi_y\\phi_{xy} + \\phi_{yy}\\phi_x^2}{(\\phi_x^2 + \\phi_y^2)^{3/2}} $$\nwhere the subscripts denote partial derivatives (e.g., $\\phi_x = \\frac{\\partial \\phi}{\\partial x}$, $\\phi_{xy} = \\frac{\\partial^2 \\phi}{\\partial x \\partial y}$).\n\nWe are given the level-set function $\\phi(x,y) = \\sqrt{x^2 + y^2} - R$, with radius $R=2$ mm. The grid spacing is $\\Delta x = \\Delta y = 1$ mm. We need to approximate $\\kappa$ at the point $(x_0, y_0) = (2, 0)$ using second-order central differences on the specified $3 \\times 3$ stencil. The stencil consists of the grid nodes $(x,y)$ for $x \\in \\{1, 2, 3\\}$ and $y \\in \\{-1, 0, 1\\}$.\n\nFirst, we evaluate $\\phi(x,y)$ at each of the $9$ points on the stencil.\nThe values of $\\phi(x,y) = \\sqrt{x^2 + y^2} - 2$ are:\n- $\\phi(1, -1) = \\sqrt{1^2 + (-1)^2} - 2 = \\sqrt{2} - 2$\n- $\\phi(1, 0) = \\sqrt{1^2 + 0^2} - 2 = 1 - 2 = -1$\n- $\\phi(1, 1) = \\sqrt{1^2 + 1^2} - 2 = \\sqrt{2} - 2$\n- $\\phi(2, -1) = \\sqrt{2^2 + (-1)^2} - 2 = \\sqrt{5} - 2$\n- $\\phi(2, 0) = \\sqrt{2^2 + 0^2} - 2 = 2 - 2 = 0$\n- $\\phi(2, 1) = \\sqrt{2^2 + 1^2} - 2 = \\sqrt{5} - 2$\n- $\\phi(3, -1) = \\sqrt{3^2 + (-1)^2} - 2 = \\sqrt{10} - 2$\n- $\\phi(3, 0) = \\sqrt{3^2 + 0^2} - 2 = 3 - 2 = 1$\n- $\\phi(3, 1) = \\sqrt{3^2 + 1^2} - 2 = \\sqrt{10} - 2$\n\nNext, we approximate the partial derivatives of $\\phi$ at $(x_0, y_0) = (2, 0)$ using second-order central difference formulas. With $\\Delta x = \\Delta y = 1$, these are:\n- $\\phi_x \\approx \\frac{\\phi(x_0+\\Delta x, y_0) - \\phi(x_0-\\Delta x, y_0)}{2\\Delta x} = \\frac{\\phi(3,0) - \\phi(1,0)}{2(1)} = \\frac{1 - (-1)}{2} = 1$\n- $\\phi_y \\approx \\frac{\\phi(x_0, y_0+\\Delta y) - \\phi(x_0, y_0-\\Delta y)}{2\\Delta y} = \\frac{\\phi(2,1) - \\phi(2,-1)}{2(1)} = \\frac{(\\sqrt{5}-2) - (\\sqrt{5}-2)}{2} = 0$\n- $\\phi_{xx} \\approx \\frac{\\phi(x_0+\\Delta x, y_0) - 2\\phi(x_0, y_0) + \\phi(x_0-\\Delta x, y_0)}{(\\Delta x)^2} = \\frac{\\phi(3,0) - 2\\phi(2,0) + \\phi(1,0)}{1^2} = \\frac{1 - 2(0) + (-1)}{1} = 0$\n- $\\phi_{yy} \\approx \\frac{\\phi(x_0, y_0+\\Delta y) - 2\\phi(x_0, y_0) + \\phi(x_0, y_0-\\Delta y)}{(\\Delta y)^2} = \\frac{\\phi(2,1) - 2\\phi(2,0) + \\phi(2,-1)}{1^2} = \\frac{(\\sqrt{5}-2) - 2(0) + (\\sqrt{5}-2)}{1} = 2\\sqrt{5} - 4$\n- $\\phi_{xy} \\approx \\frac{\\phi(x_0+\\Delta x, y_0+\\Delta y) - \\phi(x_0+\\Delta x, y_0-\\Delta y) - \\phi(x_0-\\Delta x, y_0+\\Delta y) + \\phi(x_0-\\Delta x, y_0-\\Delta y)}{4\\Delta x \\Delta y} = \\frac{\\phi(3,1) - \\phi(3,-1) - \\phi(1,1) + \\phi(1,-1)}{4(1)(1)}$\n  Substituting the values:\n  $\\phi_{xy} \\approx \\frac{(\\sqrt{10}-2) - (\\sqrt{10}-2) - (\\sqrt{2}-2) + (\\sqrt{2}-2)}{4} = \\frac{0 - 0}{4} = 0$\n\nNow, we substitute these discrete derivative values into the expression for $\\kappa$ to find the finite difference approximation, $\\kappa_{\\text{FD}}$:\n$$ \\kappa_{\\text{FD}} = \\frac{(0)(0)^2 - 2(1)(0)(0) + (2\\sqrt{5}-4)(1)^2}{((1)^2 + (0)^2)^{3/2}} = \\frac{2\\sqrt{5}-4}{1^{3/2}} = 2\\sqrt{5}-4 $$\nThe numerical value is $\\kappa_{\\text{FD}} \\approx 2(2.236068) - 4 = 4.472136 - 4 = 0.472136$ mm$^{-1}$.\n\nThe analytical curvature for a circle of radius $R$ is $\\kappa_{\\text{analytic}} = \\frac{1}{R}$. Given $R=2$ mm, we have:\n$$ \\kappa_{\\text{analytic}} = \\frac{1}{2} = 0.5 \\ \\mathrm{mm}^{-1} $$\nFinally, we compute the absolute error between the discrete and analytical values:\n$$ \\text{Error} = \\left\\lvert \\kappa_{\\text{FD}} - \\kappa_{\\text{analytic}} \\right\\rvert = \\left\\lvert (2\\sqrt{5}-4) - \\frac{1}{2} \\right\\rvert = \\left\\lvert 2\\sqrt{5} - 4.5 \\right\\rvert $$\nNumerically, this is:\n$$ \\text{Error} \\approx |0.472135955 - 0.5| = |-0.027864045| = 0.027864045 $$\nThe problem requires rounding the final answer to four significant figures. The first four significant figures are $2$, $7$, $8$, and $6$. The subsequent digit is $4$, so we round down.\n$$ \\text{Error} \\approx 0.02786 $$\nIn standard scientific notation, this is $2.786 \\times 10^{-2}$. The units are $\\mathrm{mm}^{-1}$.",
            "answer": "$$\\boxed{2.786 \\times 10^{-2}}$$"
        },
        {
            "introduction": "Having established how to represent a contour and measure its properties, we now turn to making it move. This comprehensive practice guides you through implementing a complete, time-dependent solver for the level-set evolution governed by a Hamilton-Jacobi partial differential equation. By deriving the analytical stability constraint (the CFL condition) and verifying it empirically, you will gain deep insight into the theoretical underpinnings and practical challenges of creating stable numerical simulations, a cornerstone of modern computational science. ",
            "id": "4548852",
            "problem": "You will implement and analyze a two-dimensional explicit level-set scheme for the Hamilton–Jacobi equation used in radiomics-oriented segmentation, starting from fundamental definitions. Consider the evolution of a scalar field $\\phi(x,y,t)$ governed by the partial differential equation\n$$\n\\partial_t \\phi + F \\lvert \\nabla \\phi \\rvert = 0,\n$$\nwith a constant speed function $F \\ge 0$ on a periodic square domain. Your task is to derive, implement, and empirically verify the stability of a first-order explicit scheme under a Courant–Friedrichs–Lewy (CFL) condition.\n\nFundamental base and numerical setup:\n- The equation is a Hamilton–Jacobi equation with Hamiltonian $H(p_x,p_y) = F \\sqrt{p_x^2 + p_y^2}$ and is the mathematical core underlying many level-set segmentation approaches in radiomics.\n- Use a uniform periodic grid on the domain $[0,1) \\times [0,1)$ with $N_x$ points in the $x$-direction and $N_y$ points in the $y$-direction. Let $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$.\n- Initialize $\\phi(x,y,0) = \\sin(2\\pi x)\\sin(2\\pi y)$ evaluated at the grid nodes.\n- Discretize time with a forward Euler scheme of step $\\Delta t$. For $\\lvert \\nabla \\phi \\rvert$, use a first-order monotone Godunov numerical Hamiltonian constructed from one-sided finite differences. Let the one-sided differences be\n$$\nD_x^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i-1,j}}{\\Delta x},\\quad\nD_x^+ \\phi_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x},\\quad\nD_y^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i,j-1}}{\\Delta y},\\quad\nD_y^+ \\phi_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y},\n$$\nwith periodic indexing. For $F \\ge 0$, use the monotone Godunov approximation\n$$\nG_{i,j} = \\sqrt{\n\\max\\!\\big( \\max(D_x^-\\phi_{i,j},0)^2,\\;\\min(D_x^+\\phi_{i,j},0)^2 \\big)\\;+\\;\n\\max\\!\\big( \\max(D_y^-\\phi_{i,j},0)^2,\\;\\min(D_y^+\\phi_{i,j},0)^2 \\big)\n},\n$$\nand update by\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t F G_{i,j}.\n$$\n\nAnalytical stability target:\n- Starting from the Hamilton–Jacobi structure and the requirement that an explicit monotone scheme remains a contraction in the uniform norm, derive the most restrictive upper bound on $\\Delta t$ in terms of $F$, $\\Delta x$, and $\\Delta y$ such that the forward Euler update is stable for all grid points in two dimensions.\n- Base your derivation on bounding the directional Lipschitz constants of the Hamiltonian with respect to each spatial derivative and on the principle that the forward Euler method requires the sum of suitably scaled directional contributions not to exceed unity to preserve monotonicity. Do not assume any unstated formulas; start from the Hamilton–Jacobi definition and monotonicity of the numerical Hamiltonian.\n\nEmpirical stability verification:\n- A necessary property of the continuous equation with $F \\ge 0$ is that $\\partial_t \\phi \\le 0$ pointwise, hence the discrete maximum of $\\phi$ should be nonincreasing in time for a stable monotone scheme under a valid CFL constraint.\n- For each test case, classify the numerical evolution as stable if both conditions hold throughout the simulation:\n  1. No occurrence of non-numerical values, i.e., no $\\mathrm{NaN}$ or $\\pm\\infty$ in $\\phi$.\n  2. The discrete maximum $\\max_{i,j} \\phi_{i,j}^n$ does not increase at any time step beyond its initial value by more than a tolerance of $10^{-8}$.\n\nTest suite:\n- Use the following four parameter sets. For each, let $\\Delta t_{\\mathrm{theory}}$ be the theoretically derived maximal stable time step from your analysis. Evolve for the specified number of steps using $\\Delta t = \\alpha \\Delta t_{\\mathrm{theory}}$ with the given factor $\\alpha$.\n  - Case $1$ (happy path): $N_x = 64$, $N_y = 64$, $F = 1.0$, steps $= 200$, $\\alpha = 0.90$.\n  - Case $2$ (boundary): $N_x = 64$, $N_y = 64$, $F = 1.0$, steps $= 200$, $\\alpha = 1.00$.\n  - Case $3$ (CFL violation): $N_x = 64$, $N_y = 64$, $F = 1.0$, steps $= 200$, $\\alpha = 1.10$.\n  - Case $4$ (anisotropic grid, near-violation): $N_x = 128$, $N_y = 32$, $F = 0.5$, steps $= 300$, $\\alpha = 1.05$.\n\nRequired final output format:\n- Your program must run these four cases in order and produce a single line of output containing the four stability classifications as a comma-separated list of booleans enclosed in square brackets, for example `[True,False,True,False]` (this is only an example formatting; your results must reflect your computations).",
            "solution": "The problem requires the derivation of a stability condition and subsequent numerical implementation and verification for a first-order explicit scheme for the Hamilton–Jacobi equation $\\partial_t \\phi + F \\lvert \\nabla \\phi \\rvert = 0$.\n\n### Problem Validation\n\nThe problem statement is critically assessed prior to any solution attempt.\n\n**Step 1: Extracted Givens**\n- **PDE**: $\\partial_t \\phi + F \\lvert \\nabla \\phi \\rvert = 0$ for a scalar field $\\phi(x,y,t)$ with a constant speed function $F \\ge 0$.\n- **Hamiltonian**: $H(p_x,p_y) = F \\sqrt{p_x^2 + p_y^2}$.\n- **Domain**: Periodic square domain $[0,1) \\times [0,1)$.\n- **Grid**: Uniform, $N_x \\times N_y$ points, with grid spacings $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$.\n- **Initial Condition**: $\\phi(x,y,0) = \\sin(2\\pi x)\\sin(2\\pi y)$ evaluated at grid nodes.\n- **Numerical Scheme**: Forward Euler in time ($\\Delta t$), first-order monotone Godunov for space.\n- **Difference Operators**: $D_x^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i-1,j}}{\\Delta x}$, $D_x^+ \\phi_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x}$, $D_y^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i,j-1}}{\\Delta y}$, $D_y^+ \\phi_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y}$.\n- **Numerical Flux**: $G_{i,j} = \\sqrt{ \\max\\!\\big( \\max(D_x^-\\phi_{i,j},0)^2,\\;\\min(D_x^+\\phi_{i,j},0)^2 \\big)\\;+\\; \\max\\!\\big( \\max(D_y^-\\phi_{i,j},0)^2,\\;\\min(D_y^+\\phi_{i,j},0)^2 \\big) }$.\n- **Update Rule**: $\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t F G_{i,j}$.\n- **Stability Derivation Goal**: Derive the upper bound on $\\Delta t$ (CFL condition) from first principles of monotone explicit schemes.\n- **Empirical Stability Criteria**: Evolution is stable if, for all time steps, $1)$ no $\\mathrm{NaN}$ or $\\pm\\infty$ values appear, and $2)$ $\\max_{i,j} \\phi_{i,j}^n \\le \\max_{i,j} \\phi_{i,j}^0 + 10^{-8}$.\n- **Test Suite**: Four specific cases defined by parameters $(N_x, N_y, F, \\text{steps}, \\alpha)$, where $\\alpha$ is a multiplier for the derived theoretical max time step $\\Delta t_{\\mathrm{theory}}$.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a canonical exercise in numerical analysis for partial differential equations. The Hamilton–Jacobi equation, level-set method, Godunov scheme, and CFL stability condition are fundamental, well-established concepts in computational science.\n- **Well-Posed**: The problem is clearly stated. It requests the derivation of a standard theoretical result and its empirical verification through a concrete numerical implementation. All parameters, equations, and criteria are explicitly provided.\n- **Objective**: The language is precise and mathematical. The success criteria (stability classification) are quantitative and unambiguous.\n\nThe problem statement is self-contained, logically consistent, and scientifically sound. It does not exhibit any of the invalidity flaws listed in the instructions.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n### Analytical Derivation of the CFL Condition\n\nThe task is to derive the Courant–Friedrichs–Lewy (CFL) condition for the given numerical scheme. The scheme is an explicit forward-in-time method:\n$$\n\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t F G_{i,j}(\\phi^n)\n$$\nwhere $G_{i,j}$ is the numerical approximation to $\\lvert \\nabla \\phi \\rvert$ at grid point $(i,j)$. For a first-order, explicit, monotone scheme for a hyperbolic PDE to be stable, the time step $\\Delta t$ must be sufficiently small to ensure that information does not propagate more than one grid cell per time step. This is encapsulated in the CFL condition.\n\nThe derivation is based on the principle that for a forward Euler scheme applied to a hyperbolic equation, stability (specifically, preserving monotonicity and ensuring convergence in the maximum norm) requires that the sum of the scaled maximum characteristic speeds over all spatial dimensions does not exceed unity. The problem statement itself alludes to this: \"the sum of suitably scaled directional contributions not to exceed unity\".\n\nThe continuous Hamilton–Jacobi equation is $\\partial_t \\phi + H(\\nabla \\phi) = 0$, with Hamiltonian $H(p_x, p_y) = F \\sqrt{p_x^2 + p_y^2}$. The characteristic velocities, which represent the speeds of information propagation, are given by the partial derivatives of the Hamiltonian with respect to the components of its argument vector $p = \\nabla \\phi = (p_x, p_y)$:\n$$\nv_x = \\frac{\\partial H}{\\partial p_x} = \\frac{F p_x}{\\sqrt{p_x^2 + p_y^2}}\n$$\n$$\nv_y = \\frac{\\partial H}{\\partial p_y} = \\frac{F p_y}{\\sqrt{p_x^2 + p_y^2}}\n$$\nThe CFL condition requires bounding the time step based on the maximum possible speeds in each direction. We must find the supremum of the absolute values of these velocities over all possible gradients $(p_x, p_y) \\neq (0,0)$:\n$$\n\\max |v_x| = \\sup_{p_x, p_y} \\left| \\frac{F p_x}{\\sqrt{p_x^2 + p_y^2}} \\right| = \\sup_{p_x, p_y} F \\left| \\frac{p_x}{\\sqrt{p_x^2 + p_y^2}} \\right| = F\n$$\nThe maximum value of $F$ is attained when $p_y = 0$ and $p_x \\neq 0$, where the fraction becomes $\\pm 1$. Symmetrically, for the $y$-direction:\n$$\n\\max |v_y| = \\sup_{p_x, p_y} \\left| \\frac{F p_y}{\\sqrt{p_x^2 + p_y^2}} \\right| = F\n$$\nThe CFL condition for a multi-dimensional, first-order explicit scheme is given by the sum of these maximum speeds, each scaled by the corresponding grid spacing:\n$$\n\\Delta t \\left( \\frac{\\max |v_x|}{\\Delta x} + \\frac{\\max |v_y|}{\\Delta y} \\right) \\le 1\n$$\nSubstituting the maximum speeds we found:\n$$\n\\Delta t \\left( \\frac{F}{\\Delta x} + \\frac{F}{\\Delta y} \\right) \\le 1\n$$\nSolving for $\\Delta t$ gives the most restrictive upper bound for the time step, which we define as $\\Delta t_{\\mathrm{theory}}$:\n$$\n\\Delta t \\le \\frac{1}{F \\left( \\frac{1}{\\Delta x} + \\frac{1}{\\Delta y} \\right)}\n$$\nThus, the maximal stable time step is:\n$$\n\\Delta t_{\\mathrm{theory}} = \\frac{1}{F \\left( \\frac{1}{\\Delta x} + \\frac{1}{\\Delta y} \\right)} = \\frac{\\Delta x \\Delta y}{F(\\Delta x + \\Delta y)}\n$$\nThis derivation fulfills the requirement of starting from the Hamilton–Jacobi structure and the principle of stability for explicit schemes.\n\n### Implementation and Verification Strategy\n\nThe empirical verification will be performed by implementing the numerical scheme in Python using the `numpy` library.\n\n1.  **Grid and Initial State**: For each test case, a $2$D grid of size $N_y \\times N_x$ is created. The coordinates $x_i = i \\Delta x$ and $y_j = j \\Delta y$ are used to initialize the field $\\phi$ according to $\\phi(x,y,0) = \\sin(2\\pi x)\\sin(2\\pi y)$. The maximum value of this initial field is stored as $\\max_{i,j} \\phi_{i,j}^0$.\n\n2.  **Time Loop**: The simulation evolves $\\phi$ for the specified number of steps. In each step:\n    a.  **Finite Differences**: The one-sided spatial differences $D_x^-\\phi, D_x^+\\phi, D_y^-\\phi, D_y^+\\phi$ are computed for the entire grid. Periodic boundary conditions are handled efficiently using `numpy.roll`, which shifts array elements along a given axis.\n    b.  **Numerical Flux (G)**: The Godunov term $G_{i,j}$ is calculated at every grid point using the computed differences, following the specified formula. Vectorized `numpy` operations (`numpy.maximum`, `numpy.minimum`, `numpy.sqrt`) are used for efficiency.\n    c.  **Update**: The field $\\phi$ is updated to the next time step $\\phi^{n+1}$ using the forward Euler rule: $\\phi_{i,j}^{n+1} = \\phi_{i,j}^{n} - \\Delta t F G_{i,j}$.\n\n3.  **Stability Check**: At the end of each time step, two conditions are checked:\n    a.  The presence of any non-finite numbers (`NaN` or `inf`) in the array $\\phi$, which is a clear sign of numerical blow-up.\n    b.  Whether the maximum value of the field has increased beyond a small tolerance: $\\max_{i,j} \\phi_{i,j}^{n+1} > \\max_{i,j} \\phi_{i,j}^0 + 10^{-8}$. The continuous equation implies the maximum should be non-increasing, so any significant increase signals instability.\n\nIf either condition is met during the simulation, the evolution for that test case is classified as unstable (`False`), and the loop for that case terminates. If the simulation completes all steps without triggering these conditions, it is classified as stable (`True`). The boolean results from all four test cases are collected and printed in the required format.",
            "answer": "`[True,True,False,False]`"
        }
    ]
}