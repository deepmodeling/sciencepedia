{
    "hands_on_practices": [
        {
            "introduction": "The Gaussian function is a cornerstone for modeling the Point Spread Function due to its mathematical properties and frequent appearance in physical processes. While the standard deviation, $\\sigma$, precisely defines the Gaussian curve, the Full Width at Half Maximum (FWHM) offers a more intuitive and directly measurable descriptor of an imaging system's spatial resolution. This exercise will guide you through the fundamental derivation that connects these two key parameters, a crucial step in understanding and quantifying image blur .",
            "id": "4892468",
            "problem": "In a one-dimensional, linear and shift-invariant medical imaging system, the point spread function (PSF) is the impulse response that characterizes spatial blur. Suppose the point spread function (PSF) is Gaussian with standard deviation $\\sigma$, with functional form given by $h(x)=\\dfrac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\dfrac{x^{2}}{2\\sigma^{2}}\\right)$. The full width at half maximum (FWHM) of a nonnegative, symmetric function is defined as the distance between the two points at which the function attains one-half of its global maximum value.\n\nUsing only these definitions and elementary properties of the natural logarithm, derive an analytical expression for the full width at half maximum (FWHM) of this Gaussian point spread function (PSF) in terms of $\\sigma$. Then evaluate your expression for $\\sigma = 0.6$ millimeters. Express the final numerical result in millimeters and round your answer to four significant figures.",
            "solution": "We begin from the definition of the Gaussian point spread function (PSF) in one spatial dimension,\n$$\nh(x)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right).\n$$\nBy definition, the full width at half maximum (FWHM) of a nonnegative, symmetric function is the distance between the two points where the function equals one-half of its maximum value. The Gaussian $h(x)$ is even and attains its global maximum at $x=0$. Its maximum value is\n$$\nh(0)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}.\n$$\nLet $x_{1/2}>0$ denote the positive location where $h(x)$ equals half its maximum. The half-maximum condition is\n$$\nh(x_{1/2})=\\frac{1}{2}\\,h(0).\n$$\nSubstituting the explicit form of $h(x)$ and canceling the common normalization factor yields\n$$\n\\exp\\!\\left(-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}\\right)=\\frac{1}{2}.\n$$\nTaking the natural logarithm of both sides gives\n$$\n-\\frac{x_{1/2}^{2}}{2\\sigma^{2}}=\\ln\\!\\left(\\frac{1}{2}\\right)=-\\ln(2),\n$$\nso that\n$$\nx_{1/2}^{2}=2\\sigma^{2}\\ln(2)\\quad\\Rightarrow\\quad x_{1/2}=\\sigma\\,\\sqrt{2\\ln(2)}.\n$$\nBecause the Gaussian is symmetric, the two half-maximum points are located at $x=\\pm x_{1/2}$, and therefore the full width at half maximum is the distance between these two points:\n$$\n\\mathrm{FWHM}=2\\,x_{1/2}=2\\,\\sigma\\,\\sqrt{2\\ln(2)}.\n$$\n\nTo evaluate this for a given standard deviation $\\sigma$, substitute $\\sigma=0.6$ millimeters:\n$$\n\\mathrm{FWHM}=2\\,(0.6)\\,\\sqrt{2\\ln(2)}\\ \\text{ millimeters}.\n$$\nCompute the dimensionless factor $\\sqrt{2\\ln(2)}$. Symbolically, leave constants intact until the final numerical evaluation. Using $\\ln(2)$ as the natural logarithm of $2$, we have\n$$\n\\mathrm{FWHM}=(1.2)\\,\\sqrt{2\\ln(2)}\\ \\text{ millimeters}.\n$$\nNumerically evaluating at the final step,\n$$\n\\sqrt{2\\ln(2)}\\approx 1.177410022,\\quad \\text{so}\\quad \\mathrm{FWHM}\\approx (1.2)\\times(1.177410022)=1.412892026\\ \\text{ millimeters}.\n$$\nRounding to four significant figures and expressing the value in millimeters as requested gives\n$$\n\\mathrm{FWHM}=1.413\\ \\text{ millimeters}.\n$$",
            "answer": "$$\\boxed{1.413}$$"
        },
        {
            "introduction": "While the PSF describes an imaging system's response in the spatial domain, its performance is often more powerfully analyzed in the frequency domain through the Modulation Transfer Function (MTF). This practice explores the fundamental Fourier relationship between PSF and MTF by using a rectangular function—a simple yet effective model for the averaging effect of a detector element . By deriving the MTF, you will see how a physical characteristic, the detector bin width, directly determines the range of spatial frequencies the system can faithfully capture.",
            "id": "4555628",
            "problem": "In a radiomics workflow analyzing a one-dimensional line profile of a medical image acquired by a linear, shift-invariant detector, the finite width of each detector bin causes spatial averaging of the incoming signal. Model this averaging as the system’s point spread function (PSF), where the PSF is a rectangular function of width $\\Delta$ normalized to unit area. The modulation transfer function (MTF) is defined as the magnitude of the Fourier transform of the PSF. Assume the Fourier transform convention\n$$\nH(f) = \\int_{-\\infty}^{\\infty} h(x)\\,\\exp(-i\\,2\\pi f x)\\,dx,\n$$\nwhere $f$ is the spatial frequency in cycles per millimeter. Let the rectangular function be defined as\n$$\n\\mathrm{rect}(u) = \n\\begin{cases}\n1, & |u| \\leq \\tfrac{1}{2},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nStarting from the definitions of point spread function and Fourier transform, derive the analytic expression for the modulation transfer function $M(f) = |H(f)|$ for this detector model. Then, identify the smallest positive spatial frequency $f$ at which $M(f)$ is exactly zero (the first zero of the MTF), expressed in terms of $\\Delta$. Finally, evaluate this first zero frequency for a detector bin width of $\\Delta = 0.73\\,\\mathrm{mm}$.\n\nExpress the final frequency in cycles per millimeter and round your answer to four significant figures.",
            "solution": "The Point Spread Function (PSF) is a rectangular function of width $\\Delta$ normalized to unit area. We can express this using the standard rectangular function, $\\mathrm{rect}(u)$, which is 1 for $|u| \\leq 1/2$ and 0 otherwise. To have a width of $\\Delta$ and unit area, the PSF must be:\n$$\nh(x) = \\frac{1}{\\Delta} \\mathrm{rect}\\left(\\frac{x}{\\Delta}\\right)\n$$\nExplicitly, this is:\n$$\nh(x) = \n\\begin{cases}\n\\frac{1}{\\Delta}, & |x| \\leq \\frac{\\Delta}{2} \\\\\n0, & |x| > \\frac{\\Delta}{2}\n\\end{cases}\n$$\nThe transfer function $H(f)$ is the Fourier transform of the PSF. Using the provided definition of the Fourier transform:\n$$\nH(f) = \\int_{-\\infty}^{\\infty} h(x)\\,\\exp(-i\\,2\\pi f x)\\,dx = \\int_{-\\Delta/2}^{\\Delta/2} \\frac{1}{\\Delta}\\,\\exp(-i\\,2\\pi f x)\\,dx\n$$\nWe perform the integration:\n$$\nH(f) = \\frac{1}{\\Delta} \\left[ \\frac{\\exp(-i\\,2\\pi f x)}{-i\\,2\\pi f} \\right]_{x=-\\Delta/2}^{x=\\Delta/2} = \\frac{1}{\\Delta(-i\\,2\\pi f)} \\left( \\exp(-i\\pi f \\Delta) - \\exp(i\\pi f \\Delta) \\right)\n$$\nUsing the Euler identity $\\sin(\\theta) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2i}$, this simplifies to:\n$$\nH(f) = \\frac{\\sin(\\pi f \\Delta)}{\\pi f \\Delta}\n$$\nThis is the normalized sinc function, often written as $\\mathrm{sinc}(f\\Delta)$.\n\nThe Modulation Transfer Function (MTF) is the magnitude of the transfer function:\n$$\nM(f) = |H(f)| = \\left| \\frac{\\sin(\\pi f \\Delta)}{\\pi f \\Delta} \\right|\n$$\nThe first zero of the MTF for positive frequency $f>0$ occurs when the numerator is zero, provided the denominator is non-zero. This happens when the argument of the sine function is an integer multiple of $\\pi$:\n$$\n\\pi f \\Delta = n\\pi, \\quad \\text{for } n = \\pm 1, \\pm 2, \\ldots\n$$\nThe smallest positive frequency corresponds to $n=1$, which gives:\n$$\nf_{\\text{zero}} = \\frac{1}{\\Delta}\n$$\nGiven the detector bin width $\\Delta = 0.73\\,\\mathrm{mm}$, the first zero frequency is:\n$$\nf_{\\text{zero}} = \\frac{1}{0.73\\,\\mathrm{mm}} \\approx 1.369863... \\,\\mathrm{cycles/mm}\n$$\nRounding to four significant figures, we get:\n$$\nf_{\\text{zero}} = 1.370 \\,\\mathrm{cycles/mm}\n$$",
            "answer": "$$\n\\boxed{1.370}\n$$"
        },
        {
            "introduction": "Moving beyond idealized models, real-world imaging systems like Positron Emission Tomography (PET) scanners exhibit a Point Spread Function that varies depending on where in the field of view an event occurs. This advanced practice simulates a complete calibration experiment to characterize this position-dependent resolution degradation . You will generate synthetic data based on a physical model, apply statistical methods to estimate the PSF parameters, and ultimately fit a model that predicts system performance across the scanner, bridging the gap between theoretical concepts and practical system characterization.",
            "id": "4555649",
            "problem": "You are tasked with formalizing and implementing a calibration experiment to measure the Point Spread Function (PSF) of a Positron Emission Tomography (PET) system using a point source placed at multiple radial positions. The goal is to estimate a position-dependent PSF model from measured data. The problem must be solved from first principles, starting from foundational definitions and widely accepted formulas, without relying on undocumented shortcuts.\n\nDefinitions and fundamental base:\n- The Point Spread Function (PSF) is the impulse response of an imaging system. For a one-dimensional profile along a detector axis, an idealized symmetric PSF can be modeled by a normalized Gaussian function. If the PSF is Gaussian with standard deviation $\\sigma$, its Full Width at Half Maximum (FWHM) is given by\n$$\\mathrm{FWHM} = 2 \\sqrt{2 \\ln 2} \\, \\sigma.$$\n- A measured one-dimensional line profile for a point source at position $r$ can be represented by sampled counts $\\{c_j\\}$ at spatial sample positions $\\{x_j\\}$ in millimeters, where the counts are assumed to be generated according to a Gaussian intensity profile. Under ideal conditions with negligible background, the weighted sample mean and variance of the counts approximate the Gaussian parameters:\n$$\\mu \\approx \\frac{\\sum_j c_j x_j}{\\sum_j c_j}, \\quad \\sigma^2 \\approx \\frac{\\sum_j c_j (x_j - \\mu)^2}{\\sum_j c_j}.$$\n- For a position-dependent PSF, a first-order physically plausible model assumes that independent blurring contributions add in quadrature. This leads to a variance model,\n$$\\sigma^2(r) = \\sigma_0^2 + (b r)^2,$$\nwhere $\\sigma_0$ is the intrinsic on-axis resolution in millimeters, $b$ is a dimensionless coefficient parameterizing off-axis blur growth, and $r$ is the radial position in millimeters.\n\nYour tasks:\n1. For each test case, simulate measurement data $\\{(x_j, c_j)\\}$ at each specified radial position $r$ using a Gaussian profile with a known amplitude and position offset. Specifically, for each radial position $r$, compute counts at spatial samples $x_j$ via\n$$c_j = \\mathrm{round}\\left(A \\cdot \\exp\\left(-\\frac{(x_j - \\mu)^2}{2 \\, \\sigma(r)^2}\\right)\\right),$$\nwhere $A$ is the amplitude (counts), $\\mu$ is a position offset (in millimeters), and $\\sigma(r)$ is given by the model above with the provided $\\sigma_0$ and $b$ for that test case.\n2. From the simulated counts at each $r$, estimate the empirical $\\mu(r)$ and $\\sigma(r)$ using the weighted moments formulas given above.\n3. Fit the position-dependent model parameters $(\\sigma_0, b)$ using ordinary least squares on the transformed linear relation\n$$\\sigma^2(r) = \\sigma_0^2 + (b r)^2,$$\nby regressing $y_i = \\sigma(r_i)^2$ against $x_i = r_i^2$. Extract $\\sigma_0$ as $\\sqrt{\\text{intercept}}$ and $b$ as $\\sqrt{\\text{slope}}$.\n4. Using the fitted $(\\sigma_0, b)$ for each test case, compute the predicted $\\mathrm{FWHM}$ at $r = 150$ millimeters using the Gaussian $\\mathrm{FWHM}$ relation.\n5. Express all length quantities in millimeters and round all reported floating-point outputs to three decimal places.\n\nTest suite:\nImplement and solve for the following three independent test cases. In each case, the specified parameters produce three distinct radial measurement profiles.\n\n- Case 1 (general case):\n    - Spatial sample positions $x_j$ (millimeters): $[-10,-8,-6,-4,-2,0,2,4,6,8,10]$.\n    - Amplitude $A = 1200$.\n    - True intrinsic resolution $\\sigma_0 = 2.5$ millimeters.\n    - Off-axis coefficient $b = 0.006$ (dimensionless).\n    - Radial positions $r$ (millimeters): $[0, 100, 200]$.\n    - Position offsets $\\mu$ (millimeters): $[0.0, 0.5, -0.3]$.\n\n- Case 2 (boundary towards edge of field of view):\n    - Spatial sample positions $x_j$ (millimeters): $[-12,-9,-6,-3,0,3,6,9,12]$.\n    - Amplitude $A = 900$.\n    - True intrinsic resolution $\\sigma_0 = 2.2$ millimeters.\n    - Off-axis coefficient $b = 0.008$ (dimensionless).\n    - Radial positions $r$ (millimeters): $[0, 150, 250]$.\n    - Position offsets $\\mu$ (millimeters): $[0.0, -0.7, 0.4]$.\n\n- Case 3 (edge case with minimal sampling):\n    - Spatial sample positions $x_j$ (millimeters): $[-2, 0, 2]$.\n    - Amplitude $A = 1100$.\n    - True intrinsic resolution $\\sigma_0 = 3.0$ millimeters.\n    - Off-axis coefficient $b = 0.0$ (dimensionless).\n    - Radial positions $r$ (millimeters): $[0, 180, 240]$.\n    - Position offsets $\\mu$ (millimeters): $[0.0, 0.0, 0.0]$.\n\nRequired final output format:\n- For each test case, your program must output a list of three values: $[\\sigma_0, b, \\mathrm{FWHM}(r=150\\,\\mathrm{mm})]$, all rounded to three decimal places.\n- Aggregate the results for the three test cases into a single line: a comma-separated list enclosed in square brackets, where each element is the per-case list described above, for example\n$$[[\\sigma_{0,1}, b_1, \\mathrm{FWHM}_{1@150}], [\\sigma_{0,2}, b_2, \\mathrm{FWHM}_{2@150}], [\\sigma_{0,3}, b_3, \\mathrm{FWHM}_{3@150}]].$$\n- Your program should produce a single line of output containing the results exactly in this bracketed list format.\n\nAll angles are to be considered irrelevant for this problem. All length quantities must be expressed in millimeters and all outputs rounded to three decimal places. Percentages are not used anywhere; use decimal floats where appropriate. The solution must not read input from the user or external files.",
            "solution": "The calibration experiment is formalized by the impulse response definition of the Point Spread Function (PSF) and a physically grounded model for how resolution degrades with radial position in a Positron Emission Tomography (PET) system. The implementation proceeds from principles to an algorithm as follows.\n\nPrinciple-based foundation:\n1. The Point Spread Function (PSF) is the imaging system’s response to a spatial impulse. In the one-dimensional case, an idealized isotropic PSF is represented by a Gaussian function:\n$$g(x; \\mu, \\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2} \\right).$$\nIn practice for PET calibration using a point source, we measure the counts at discrete spatial samples $\\{x_j\\}$, which we model as proportional to the Gaussian, and recorded as integer counts.\n2. For a Gaussian with standard deviation $\\sigma$, the Full Width at Half Maximum (FWHM) is\n$$\\mathrm{FWHM} = 2\\sqrt{2\\ln 2}\\,\\sigma.$$\nThis relation is a well-tested formula connecting $\\sigma$ to the FWHM.\n\nDeriving the position-dependent model:\n3. Several independent blur sources contribute to the resolution in PET, including intrinsic detector resolution, positron range, non-collinearity, and parallax or depth-of-interaction effects. When these contributions are independent, their variances add in quadrature. A first-order model for radial dependence is\n$$\\sigma^2(r) = \\sigma_0^2 + (b r)^2,$$\nwhere $\\sigma_0$ (in millimeters) is the on-axis variance contribution and $b$ (dimensionless) parameterizes the radial growth under a linear assumption for one contribution (for example, parallax error growing with $r$). This is a widely used modeling approach and is physically plausible at an advanced undergraduate level.\n\nMeasurement and estimation from sampled data:\n4. For each radial position $r$, we simulate measured counts at sample positions $x_j$ by\n$$c_j = \\mathrm{round}\\left( A \\exp\\left( -\\frac{(x_j - \\mu)^2}{2\\,\\sigma(r)^2} \\right) \\right),$$\nwhere $A$ is a known amplitude and $\\mu$ is a small offset reflecting imperfect centering. These counts emulate the histogram of detected events along a line.\n5. From the measured counts $\\{c_j\\}$, we estimate the central location and spread by the weighted moments:\n$$\\mu(r) \\approx \\frac{\\sum_j c_j x_j}{\\sum_j c_j}, \\quad \\sigma(r)^2 \\approx \\frac{\\sum_j c_j (x_j - \\mu(r))^2}{\\sum_j c_j}.$$\nThese formulas are obtained from the definition of the mean and variance under the assumption that the weighting reflects the probability density scaled by counts.\n\nModel fitting via linearization:\n6. To estimate $\\sigma_0$ and $b$, we use the linearized form. Define $y_i = \\sigma(r_i)^2$ and $x_i = r_i^2$, then\n$$y_i = \\sigma_0^2 + b^2 x_i.$$\nWe fit a straight line $y = \\alpha + \\beta x$ by ordinary least squares, where $\\alpha = \\sigma_0^2$ and $\\beta = b^2$. Given sample means $\\bar{x} = \\frac{1}{N}\\sum_i x_i$ and $\\bar{y} = \\frac{1}{N}\\sum_i y_i$, the slope and intercept are\n$$\\beta = \\frac{\\sum_i (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_i (x_i - \\bar{x})^2}, \\quad \\alpha = \\bar{y} - \\beta \\bar{x}.$$\nThen extract\n$$\\sigma_0 = \\sqrt{\\max(\\alpha, 0)}, \\quad b = \\sqrt{\\max(\\beta, 0)}.$$\nClamping negative values to zero avoids nonphysical estimates due to numerical artifacts.\n\nPrediction:\n7. With the fitted $\\sigma_0$ and $b$, the predicted standard deviation at $r = 150$ millimeters is\n$$\\sigma(150) = \\sqrt{\\sigma_0^2 + (b \\cdot 150)^2},$$\nand the predicted Full Width at Half Maximum is\n$$\\mathrm{FWHM}(150) = 2 \\sqrt{2 \\ln 2} \\, \\sigma(150).$$\n\nAlgorithmic steps implemented in the program:\n- For each test case, generate the measurement counts at each specified $r$ using the provided $x_j$, amplitude $A$, and offset $\\mu$ values together with the PSF model $\\sigma(r) = \\sqrt{\\sigma_0^2 + (b r)^2}$.\n- Estimate $\\mu(r)$ and $\\sigma(r)$ via weighted moments for each $r$.\n- Fit the linearized model $\\sigma^2(r)$ versus $r^2$ to obtain $\\sigma_0$ and $b$.\n- Compute $\\mathrm{FWHM}(150)$.\n- Round all outputs to three decimal places and produce the single-line bracketed list required.\n\nScientific realism and test coverage:\n- Case 1 is a general, well-sampled scenario across the field of view.\n- Case 2 includes larger radial positions approaching the edge of a typical field of view, testing robustness of the fit.\n- Case 3 uses minimal sampling points to stress the estimation procedure at sparse sampling, with a constant resolution across radius.\n\nAll quantities are expressed in millimeters as required. Angles are not used. The final printed output strictly conforms to the single-line, bracketed list format with three decimal places for all floating-point outputs.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef generate_counts(x_grid_mm, amplitude, sigma_mm, mu_mm):\n    \"\"\"\n    Generate integer counts from a Gaussian profile at sample positions x_grid_mm.\n    c_j = round(A * exp(-(x_j - mu)^2 / (2 * sigma^2)))\n    \"\"\"\n    x = np.asarray(x_grid_mm, dtype=float)\n    counts = np.rint(amplitude * np.exp(-((x - mu_mm) ** 2) / (2.0 * sigma_mm ** 2)))\n    return counts.astype(int)\n\ndef estimate_gaussian_moments(x_grid_mm, counts):\n    \"\"\"\n    Estimate weighted mean and variance from counts at positions x_grid_mm.\n    mu = sum(c_j * x_j) / sum(c_j)\n    var = sum(c_j * (x_j - mu)^2) / sum(c_j)\n    \"\"\"\n    x = np.asarray(x_grid_mm, dtype=float)\n    c = np.asarray(counts, dtype=float)\n    total = np.sum(c)\n    if total = 0:\n        # Degenerate case: no counts; return zeros\n        return 0.0, 0.0\n    mu_hat = np.sum(c * x) / total\n    var_hat = np.sum(c * (x - mu_hat) ** 2) / total\n    sigma_hat = np.sqrt(max(var_hat, 0.0))\n    return mu_hat, sigma_hat\n\ndef fit_sigma_model(r_mm_list, sigma_hat_list):\n    \"\"\"\n    Fit sigma^2(r) = s0^2 + (b * r)^2 using OLS on y = s0^2 + (b^2) * x,\n    where x = r^2, y = sigma^2.\n    Returns s0 (mm) and b (dimensionless).\n    \"\"\"\n    r = np.asarray(r_mm_list, dtype=float)\n    sigma = np.asarray(sigma_hat_list, dtype=float)\n    x = r ** 2\n    y = sigma ** 2\n    x_mean = np.mean(x)\n    y_mean = np.mean(y)\n    denom = np.sum((x - x_mean) ** 2)\n    if denom == 0.0:\n        # If all r are identical (should not happen in provided test cases), fallback:\n        slope = 0.0\n        intercept = y_mean\n    else:\n        slope = np.sum((x - x_mean) * (y - y_mean)) / denom\n        intercept = y_mean - slope * x_mean\n    # Clamp to non-negative for physical plausibility\n    slope = max(slope, 0.0)\n    intercept = max(intercept, 0.0)\n    s0 = np.sqrt(intercept)\n    b = np.sqrt(slope)\n    return s0, b\n\ndef fwhm_from_sigma(sigma_mm):\n    \"\"\"Compute FWHM (mm) from sigma (mm) for a Gaussian: FWHM = 2*sqrt(2*ln(2))*sigma.\"\"\"\n    return 2.0 * np.sqrt(2.0 * np.log(2.0)) * sigma_mm\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"x_grid_mm\": [-10,-8,-6,-4,-2,0,2,4,6,8,10],\n            \"A\": 1200,\n            \"sigma0_mm\": 2.5,\n            \"b\": 0.006,\n            \"r_mm\": [0, 100, 200],\n            \"mu_offsets_mm\": [0.0, 0.5, -0.3],\n        },\n        {\n            \"x_grid_mm\": [-12,-9,-6,-3,0,3,6,9,12],\n            \"A\": 900,\n            \"sigma0_mm\": 2.2,\n            \"b\": 0.008,\n            \"r_mm\": [0, 150, 250],\n            \"mu_offsets_mm\": [0.0, -0.7, 0.4],\n        },\n        {\n            \"x_grid_mm\": [-2, 0, 2],\n            \"A\": 1100,\n            \"sigma0_mm\": 3.0,\n            \"b\": 0.0,\n            \"r_mm\": [0, 180, 240],\n            \"mu_offsets_mm\": [0.0, 0.0, 0.0],\n        },\n    ]\n\n    results_str = []\n    for case in test_cases:\n        x_grid = case[\"x_grid_mm\"]\n        A = case[\"A\"]\n        sigma0_true = case[\"sigma0_mm\"]\n        b_true = case[\"b\"]\n        r_list = case[\"r_mm\"]\n        mu_offsets = case[\"mu_offsets_mm\"]\n\n        # For each radial position, generate counts and estimate sigma via weighted moments\n        sigma_estimates = []\n        for r, mu in zip(r_list, mu_offsets):\n            sigma_r = np.sqrt(sigma0_true ** 2 + (b_true * r) ** 2)\n            counts = generate_counts(x_grid, A, sigma_r, mu)\n            _, sigma_hat = estimate_gaussian_moments(x_grid, counts)\n            sigma_estimates.append(sigma_hat)\n\n        # Fit position-dependent model: sigma^2 vs r^2\n        s0_hat, b_hat = fit_sigma_model(r_list, sigma_estimates)\n\n        # Predict FWHM at r=150 mm\n        sigma_150 = np.sqrt(s0_hat ** 2 + (b_hat * 150.0) ** 2)\n        fwhm_150 = fwhm_from_sigma(sigma_150)\n\n        # Round to three decimals and format\n        s0_str = f\"{s0_hat:.3f}\"\n        b_str = f\"{b_hat:.3f}\"\n        fwhm_str = f\"{fwhm_150:.3f}\"\n        results_str.append(f\"[{s0_str},{b_str},{fwhm_str}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        }
    ]
}