{
    "hands_on_practices": [
        {
            "introduction": "重复采集多次然后取平均，是提高信噪比（Signal-to-Noise Ratio, $SNR$）的经典方法。本练习  邀请你从数学上探索，为何这种方法对随机噪声非常有效，却无法抑制结构性伪影（例如CT中的环状伪影或MRI中的偏置场伪影）。通过分别推导不相关噪声和相关噪声下的$SNR$改善因子，你将对信号平均在真实医学成像应用中的局限性有更深刻的理解。",
            "id": "4533078",
            "problem": "在一个影像组学流程中，可以通过对重复采集的医学图像进行平均来提高体素级特征的保真度，但这样做有保留结构化伪影的风险。考虑对同一体素强度进行 $n$ 次重复采集，其模型为 $X_{k} = s + \\varepsilon_{k}$，其中 $k \\in \\{1,\\dots,n\\}$，$s$ 是一个确定性非零信号，$\\varepsilon_{k}$ 是零均值高斯噪声。将信噪比（SNR）定义为 $\\mathrm{SNR} \\equiv \\dfrac{|s|}{\\sigma_{\\text{noise}}}$，其中 $\\sigma_{\\text{noise}}$ 是当前测量中加性噪声项的标准差。在提取影像组学特征之前，您通过计算算术平均值 $\\overline{X} = \\dfrac{1}{n} \\sum_{k=1}^{n} X_{k}$ 来抑制噪声。\n\n首先，分析噪声项独立同分布的情况，即 $\\operatorname{Var}(\\varepsilon_{k}) = \\sigma^{2}$ 且当 $i \\neq j$ 时 $\\operatorname{Cov}(\\varepsilon_{i},\\varepsilon_{j}) = 0$。仅使用随机变量求和的核心概率性质，计算通过对 $n$ 次采集进行平均所获得的预期信噪比改善因子 $\\mathcal{R}(n) \\equiv \\dfrac{\\mathrm{SNR}_{\\text{avg}}}{\\mathrm{SNR}_{\\text{single}}}$。\n\n接下来，为了模拟医学成像中常见的相关伪影模式（例如，在重复扫描中反复出现的静态偏置场或环形伪影），假设噪声项具有共同的方差 $\\operatorname{Var}(\\varepsilon_{k}) = \\sigma^{2}$，并表现出相等的成对相关性 $\\rho \\in [0,1)$，因此当 $i \\neq j$ 时 $\\operatorname{Cov}(\\varepsilon_{i},\\varepsilon_{j}) = \\rho \\sigma^{2}$。从协方差和的基本原理出发，推导在这种相关情况下的信噪比改善因子 $\\mathcal{R}(n,\\rho) \\equiv \\dfrac{\\mathrm{SNR}_{\\text{avg}}}{\\mathrm{SNR}_{\\text{single}}}$。然后，定性地解释为什么当 $\\rho > 0$ 时，独立情况下的尺度缩放关系不再持续，并结合平均处理如何与磁共振成像（MRI）和计算机断层扫描（CT）等医学图像中的结构化伪影相互作用进行说明。\n\n将您的最终答案表示为关于 $n$ 和 $\\rho$ 的单一简化解析表达式 $\\mathcal{R}(n,\\rho)$。无需四舍五入。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 对一体素强度进行 `n` 次重复采集，其模型为 $X_{k} = s + \\varepsilon_{k}$，其中 $k \\in \\{1,\\dots,n\\}$。\n- $s$ 是一个确定性的非零信号。\n- $\\varepsilon_{k}$ 是零均值高斯噪声，即 $\\mathrm{E}[\\varepsilon_{k}] = 0$。\n- 信噪比（SNR）定义为 $\\mathrm{SNR} \\equiv \\dfrac{|s|}{\\sigma_{\\text{noise}}}$，其中 $\\sigma_{\\text{noise}}$ 是加性噪声的标准差。\n- 算术平均值为 $\\overline{X} = \\dfrac{1}{n} \\sum_{k=1}^{n} X_{k}$。\n- 信噪比改善因子为 $\\mathcal{R} \\equiv \\dfrac{\\mathrm{SNR}_{\\text{avg}}}{\\mathrm{SNR}_{\\text{single}}}$。\n\n- **情况 1 (独立噪声)：**\n  - $\\operatorname{Var}(\\varepsilon_{k}) = \\sigma^{2}$ (同分布)。\n  - $\\operatorname{Cov}(\\varepsilon_{i},\\varepsilon_{j}) = 0$ 当 $i \\neq j$ (独立)。\n  - 任务是计算 $\\mathcal{R}(n)$。\n\n- **情况 2 (相关噪声)：**\n  - $\\operatorname{Var}(\\varepsilon_{k}) = \\sigma^{2}$。\n  - $\\operatorname{Cov}(\\varepsilon_{i},\\varepsilon_{j}) = \\rho \\sigma^{2}$ 当 $i \\neq j$，其中 $\\rho \\in [0,1)$。\n  - 任务是从基本原理推导 $\\mathcal{R}(n,\\rho)$ 并提供定性解释。\n\n- **最终答案要求：** 关于 $\\mathcal{R}(n,\\rho)$ 的单一简化解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据充分：** 该问题牢固地植根于统计信号处理，这是工程学和物理学的核心学科。模型 $X = s + \\varepsilon$ 是被加性噪声损坏的信号的经典表示。信噪比、平均、方差和协方差等概念是基础性的。将其应用于医学成像伪影（结构化、相关噪声）既现实，也是影像组学等领域的一个关键考虑因素。\n2.  **问题定义良好：** 该问题在数学上是明确定义的。所有变量（$s$, $n$, $\\rho$, $\\sigma^2$）和关系都已指定。诸如 $s \\neq 0$ 和 $\\rho \\in [0,1)$ 等约束条件是适当的，并且对于获得有意义的解是必要的。任务是具体的，并能导出唯一的解析表达式。\n3.  **客观性：** 该问题以精确、客观、形式化的数学语言陈述。没有主观性或模糊性。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。它科学上合理，定义良好且客观。将按要求推导解答。\n\n### 推导\n信噪比（SNR）定义为绝对信号强度与噪声标准差之比。\n\n对于单次采集 $X_k = s + \\varepsilon_k$，信号是 $s$，噪声是 $\\varepsilon_k$。测量的方差为 $\\operatorname{Var}(X_k) = \\operatorname{Var}(s + \\varepsilon_k) = \\operatorname{Var}(\\varepsilon_k) = \\sigma^2$，因为 $s$ 是一个确定性常数。因此，噪声标准差为 $\\sigma_{\\text{single}} = \\sqrt{\\sigma^2} = \\sigma$。\n单次采集的信噪比为：\n$$ \\mathrm{SNR}_{\\text{single}} = \\frac{|s|}{\\sigma} $$\n\n平均后的测量值为 $\\overline{X} = \\frac{1}{n} \\sum_{k=1}^{n} X_k$。我们可以将信号和噪声分量分开：\n$$ \\overline{X} = \\frac{1}{n} \\sum_{k=1}^{n} (s + \\varepsilon_k) = \\frac{1}{n} \\left( \\sum_{k=1}^{n} s + \\sum_{k=1}^{n} \\varepsilon_k \\right) = \\frac{1}{n} (ns) + \\frac{1}{n} \\sum_{k=1}^{n} \\varepsilon_k = s + \\overline{\\varepsilon} $$\n其中 $\\overline{\\varepsilon} = \\frac{1}{n} \\sum_{k=1}^{n} \\varepsilon_k$ 是平均后的噪声项。\n平均后测量中的信号仍然是 $s$。噪声标准差为 $\\sigma_{\\text{avg}} = \\sqrt{\\operatorname{Var}(\\overline{X})} = \\sqrt{\\operatorname{Var}(s + \\overline{\\varepsilon})} = \\sqrt{\\operatorname{Var}(\\overline{\\varepsilon})}$。\n平均后采集的信噪比为：\n$$ \\mathrm{SNR}_{\\text{avg}} = \\frac{|s|}{\\sigma_{\\text{avg}}} $$\n\n信噪比改善因子 $\\mathcal{R}$ 是这两个量的比值：\n$$ \\mathcal{R} = \\frac{\\mathrm{SNR}_{\\text{avg}}}{\\mathrm{SNR}_{\\text{single}}} = \\frac{|s|/\\sigma_{\\text{avg}}}{|s|/\\sigma} = \\frac{\\sigma}{\\sigma_{\\text{avg}}} $$\n为了求出 $\\mathcal{R}$，我们必须在每种情况下计算 $\\sigma_{\\text{avg}} = \\sqrt{\\operatorname{Var}(\\overline{\\varepsilon})}$。\n\n**第 1 部分：独立噪声情况（$\\rho=0$）**\n在此情况下，$\\operatorname{Var}(\\varepsilon_k) = \\sigma^2$ 且当 $i \\neq j$ 时 $\\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) = 0$。\n平均噪声项 $\\overline{\\varepsilon}$ 的方差为：\n$$ \\operatorname{Var}(\\overline{\\varepsilon}) = \\operatorname{Var}\\left(\\frac{1}{n} \\sum_{k=1}^{n} \\varepsilon_k\\right) = \\frac{1}{n^2} \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\varepsilon_k\\right) $$\n由于噪声项不相关，和的方差等于方差的和：\n$$ \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\varepsilon_k\\right) = \\sum_{k=1}^{n} \\operatorname{Var}(\\varepsilon_k) = \\sum_{k=1}^{n} \\sigma^2 = n\\sigma^2 $$\n将其代回，我们得到平均噪声的方差：\n$$ \\sigma_{\\text{avg}}^2 = \\operatorname{Var}(\\overline{\\varepsilon}) = \\frac{1}{n^2} (n\\sigma^2) = \\frac{\\sigma^2}{n} $$\n平均噪声的标准差为 $\\sigma_{\\text{avg}} = \\sqrt{\\frac{\\sigma^2}{n}} = \\frac{\\sigma}{\\sqrt{n}}$。\n独立情况下的信噪比改善因子 $\\mathcal{R}(n)$ 为：\n$$ \\mathcal{R}(n) = \\frac{\\sigma}{\\sigma_{\\text{avg}}} = \\frac{\\sigma}{\\sigma/\\sqrt{n}} = \\sqrt{n} $$\n\n**第 2 部分：相关噪声情况**\n在此情况下，$\\operatorname{Var}(\\varepsilon_k) = \\sigma^2$ 且当 $i \\neq j$ 时 $\\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) = \\rho\\sigma^2$。\n我们再次从 $\\sigma_{\\text{avg}}^2 = \\frac{1}{n^2} \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\varepsilon_k\\right)$ 开始。\n现在我们使用相关随机变量求和的方差通用公式：\n$$ \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\varepsilon_k\\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) = \\sum_{k=1}^{n} \\operatorname{Var}(\\varepsilon_k) + \\sum_{i \\neq j} \\operatorname{Cov}(\\varepsilon_i, \\varepsilon_j) $$\n第一项是方差之和。共有 $n$ 个这样的项，每项都等于 $\\sigma^2$。其和为 $n\\sigma^2$。\n第二项是协方差之和。其中 $i \\neq j$ 的索引对 $(i,j)$ 共有 $n(n-1)$ 对。每个协方差为 $\\rho\\sigma^2$。其和为 $n(n-1)\\rho\\sigma^2$。\n合并各项：\n$$ \\operatorname{Var}\\left(\\sum_{k=1}^{n} \\varepsilon_k\\right) = n\\sigma^2 + n(n-1)\\rho\\sigma^2 = n\\sigma^2 \\left[1 + (n-1)\\rho\\right] $$\n现在我们求平均噪声的方差：\n$$ \\sigma_{\\text{avg}}^2 = \\operatorname{Var}(\\overline{\\varepsilon}) = \\frac{1}{n^2} \\left( n\\sigma^2 \\left[1 + (n-1)\\rho\\right] \\right) = \\frac{\\sigma^2}{n} \\left[1 + (n-1)\\rho\\right] $$\n平均噪声的标准差为 $\\sigma_{\\text{avg}} = \\sqrt{\\frac{\\sigma^2}{n} \\left[1 + (n-1)\\rho\\right]} = \\frac{\\sigma}{\\sqrt{n}} \\sqrt{1 + (n-1)\\rho}$。\n最后，相关情况下的信噪比改善因子 $\\mathcal{R}(n,\\rho)$ 为：\n$$ \\mathcal{R}(n,\\rho) = \\frac{\\sigma}{\\sigma_{\\text{avg}}} = \\frac{\\sigma}{\\frac{\\sigma}{\\sqrt{n}} \\sqrt{1 + (n-1)\\rho}} = \\frac{\\sqrt{n}}{\\sqrt{1 + (n-1)\\rho}} $$\n这可以写成一个单独的根式：\n$$ \\mathcal{R}(n,\\rho) = \\sqrt{\\frac{n}{1 + (n-1)\\rho}} $$\n此表达式即为所求结果。作为检验，如果我们设 $\\rho=0$，该表达式正确地简化为 $\\sqrt{\\frac{n}{1}} = \\sqrt{n}$，与第 1 部分的结果相符。\n\n**第 3 部分：定性解释**\n信噪比改善的经典 $\\sqrt{n}$ 尺度缩放关系依赖于噪声在各次采集之间是随机且不相关的。对 $n$ 次这样的采集进行平均，会使那些同样可能为正或为负的随机波动相互抵消，从而将噪声方差降低 $n$ 倍。\n\n当存在正相关（$\\rho > 0$）时，这意味着一部分“噪声”并非随机，而是结构化和系统性的。这个相关分量是所有采集中共有的。在医学成像的背景下，这对应于持续存在的伪影，例如：\n1.  **CT 中的环形伪影：** 一个有故障的探测器元件在每个投影角度都持续产生错误的信号，导致在每次重复扫描中都出现圆形伪影。\n2.  **MRI 中的偏置场：** 主磁场（$B_0$）的不均匀性或射频线圈的灵敏度分布会在图像上产生平滑的低频强度变化。这种偏置场是静态的，并且会存在于每次重复采集中。\n3.  **周期性运动产生的伪影：** 如果扫描与呼吸或血流等生理运动同步，这些运动可能会产生在多次扫描中以相似模式复制的伪影。\n\n当我们对包含此类结构化伪影的图像进行平均时，真正的随机噪声分量会像以前一样被抑制。然而，结构化伪影由于存在于每幅图像中且几乎完全相同，因此不会被“平均掉”。相反，它在最终的平均图像中被保留甚至增强。其数学原因可以通过在固定 $\\rho > 0$ 的情况下，取改善因子在 $n \\to \\infty$ 时的极限来看出：\n$$ \\lim_{n\\to\\infty} \\mathcal{R}(n, \\rho) = \\lim_{n\\to\\infty} \\sqrt{\\frac{n}{1 - \\rho + n\\rho}} = \\lim_{n\\to\\infty} \\sqrt{\\frac{1}{(1-\\rho)/n + \\rho}} = \\sqrt{\\frac{1}{\\rho}} = \\frac{1}{\\sqrt{\\rho}} $$\n这表明，对于任何大小的相关噪声（$\\rho > 0$），信噪比的改善不会随着 $n$ 无限增长。它会饱和在一个有限值 $1/\\sqrt{\\rho}$。平均过程只能抑制噪声的非相关部分；它对系统性的、相关的部分无能为力，这部分噪声为可达到的噪声水平设定了一个基本下限，从而也为信噪比的改善设定了一个上限。",
            "answer": "$$\\boxed{\\sqrt{\\frac{n}{1 + (n-1)\\rho}}}$$"
        },
        {
            "introduction": "通过“零填充”技术重建出像素更多的图像，虽然在视觉上更平滑，但这真的提高了分辨率吗？本练习  深入探讨了由数据采集的物理限制所引起的吉布斯振铃伪影。你将量化分析零填充如何在不改变底层物理分辨率的情况下，改变这种伪影的表观频率，从而使其在视觉上更明显。理解这一区别，对于正确解读那些测量纹理和边缘特征的影像组学特征至关重要。",
            "id": "4533031",
            "problem": "考虑在有限视场 $L$ 上沿空间坐标 $x$ 的一维磁共振成像 (MRI) 重建。连续空间图像 $f(x)$ 是从k空间中均匀采样的空间频率数据（波数）$k$ 重建而来的。采样遵循傅里叶变换约定 $F(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-i 2 \\pi k x)\\,dx$，并且采集的数据仅限于有限的k空间范围，这意味着在k空间中与一个矩形窗函数相乘，并且根据卷积定理，在图像域中与相应的点扩散函数进行卷积。\n\n您在k空间中以采样间隔 $\\Delta k$ 采集了 $N$ 个均匀间隔的样本，覆盖范围为 $k \\in [-k_{\\max}, k_{\\max}]$。设视场满足标准MRI采样关系 $\\Delta k = 1/L$。将补零前重建图像中的离散像素间距定义为 $\\Delta x = L/N$。\n\n现在考虑在k空间中进行因子为2的补零：您将采集的k空间数据对称地用零填充，形成一个长度为 $2N$ 的序列，而不改变物理采样间隔 $\\Delta k$ 或测量的 $k_{\\max}$。重建后的图像像素间距变为 $\\Delta x' = L/(2N)$，而由 $k_{\\max}$ 决定的真实潜在连续空间分辨率保持不变。\n\n从上述基础（傅里叶变换定义、均匀采样和卷积定理）出发，完成以下任务：\n\n1. 推导由有限k空间范围 $[-k_{\\max}, k_{\\max}]$ 引入的图像域点扩散函数的零点空间位置，并由此推导出与锐利边缘附近的吉布斯振铃相关的物理振荡周期 $\\Delta x_{\\text{zero}}$（连续零点之间的距离）。\n\n2. 对于在像素间距为 $\\Delta x$ 的网格上采样的图像，将像素坐标下的表观离散振铃频率定义为 $f_{\\text{pix}} = \\Delta x / \\Delta x_{\\text{zero}}$（单位为周期/像素）。计算原始 $N$ 点重建的 $f_{\\text{pix, before}}$ 和补零后 $2N$ 点重建的 $f_{\\text{pix, after}}$。\n\n3. 计算比率 $r = f_{\\text{pix, after}} / f_{\\text{pix, before}}$ 并将此比率作为您的最终答案。将 $r$ 表示为一个纯数。无需四舍五入。\n\n最后，用文字简要解释为什么因子为2的补零会改变像素坐标下的表观振铃频率，但不会改变由 $k_{\\max}$ 决定的真实分辨率，并描述其对依赖于局部振荡结构的基于边缘的影像组学特征的一项影响。您的解释将进行定性评估，但只有 $r$ 的值会被定量评分。",
            "solution": "该问题陈述具有科学依据、适定、客观且内部一致。解决问题所需的所有必要参数和定义均已提供。所描述的场景是基于傅里叶分析基本原理，在磁共振成像（MRI）中分析有限k空间采样和补零效应的标准模型。因此，该问题是有效的，并且可以推导出解决方案。\n\n解答过程按问题陈述的要求分为三个部分。\n\n1.  点扩散函数（PSF）和振铃周期的推导：\n\nk空间中从 $k \\in [-k_{\\max}, k_{\\max}]$ 的有限采集等效于将理想、完整的k空间数据与一个矩形窗函数 $W(k) = \\text{rect}(k / (2k_{\\max}))$ 相乘，该函数在 $|k| \\le k_{\\max}$ 时等于 $1$，否则为 $0$。\n\n根据卷积定理，空间域中的重建图像 $f_{\\text{recon}}(x)$ 是真实图像 $f(x)$ 与窗函数 $W(k)$ 的傅里叶逆变换的卷积。这个逆变换就是系统的点扩散函数 $\\text{PSF}(x)$。\n\n傅里叶变换对定义为 $F(k) = \\int_{-\\infty}^{\\infty} f(x)\\,\\exp(-i 2 \\pi k x)\\,dx$，其逆变换为 $f(x) = \\int_{-\\infty}^{\\infty} F(k)\\,\\exp(i 2 \\pi k x)\\,dk$。我们通过对矩形窗进行傅里叶逆变换来计算 $\\text{PSF}(x)$：\n$$ \\text{PSF}(x) = \\int_{-\\infty}^{\\infty} W(k) \\exp(i 2 \\pi k x) dk = \\int_{-k_{\\max}}^{k_{\\max}} 1 \\cdot \\exp(i 2 \\pi k x) dk $$\n计算该积分得到：\n$$ \\text{PSF}(x) = \\left[ \\frac{\\exp(i 2 \\pi k x)}{i 2 \\pi x} \\right]_{-k_{\\max}}^{k_{\\max}} = \\frac{\\exp(i 2 \\pi k_{\\max} x) - \\exp(-i 2 \\pi k_{\\max} x)}{i 2 \\pi x} $$\n使用欧拉公式 $\\sin(\\theta) = (\\exp(i\\theta) - \\exp(-i\\theta)) / (2i)$，我们简化该表达式：\n$$ \\text{PSF}(x) = \\frac{2i \\sin(2 \\pi k_{\\max} x)}{i 2 \\pi x} = \\frac{\\sin(2 \\pi k_{\\max} x)}{\\pi x} $$\n这个函数是一个缩放的sinc函数，$\\text{PSF}(x) = 2k_{\\max} \\text{sinc}(2k_{\\max}x)$，其中 $\\text{sinc}(u) = \\sin(\\pi u)/(\\pi u)$。\n\n$\\text{PSF}(x)$ 的零点出现在分子 $\\sin(2 \\pi k_{\\max} x)$ 为零且分母不为零时。这发生在正弦函数的自变量是 $\\pi$ 的整数倍时：\n$$ 2 \\pi k_{\\max} x = m \\pi, \\quad \\text{for } m \\in \\mathbb{Z}, m \\neq 0 $$\n因此，零点的位置为 $x_m = \\frac{m}{2k_{\\max}}$。\n\n吉布斯振铃的物理振荡周期 $\\Delta x_{\\text{zero}}$ 是连续零点之间的距离。例如，位于 $m=1$ 和 $m=2$ 的零点之间的距离是：\n$$ \\Delta x_{\\text{zero}} = x_2 - x_1 = \\frac{2}{2k_{\\max}} - \\frac{1}{2k_{\\max}} = \\frac{1}{2k_{\\max}} $$\n这就是振铃伪影的特征物理波长。\n\n2.  表观离散振铃频率的计算：\n\n首先，我们建立 $k_{\\max}$ 与给定采样参数之间的关系。问题陈述指出，以间隔 $\\Delta k$ 采集 $N$ 个样本以覆盖范围 $[-k_{\\max}, k_{\\max}]$。采集的k空间总宽度为 $2k_{\\max}$。这必须对应于 $N$ 个样本的跨度，即 $N \\Delta k$。因此，我们有关系式 $2k_{\\max} = N \\Delta k$。\n使用给定的关系式 $\\Delta k = 1/L$，我们可以写出：\n$$ 2k_{\\max} = N \\left(\\frac{1}{L}\\right) = \\frac{N}{L} $$\n现在，我们可以用 $N$ 和 $L$ 来表示物理振铃周期：\n$$ \\Delta x_{\\text{zero}} = \\frac{1}{2k_{\\max}} = \\frac{1}{N/L} = \\frac{L}{N} $$\n这是一个关键的中间结果：吉布斯振铃的物理周期等于原始、未补零图像的像素大小。\n\n问题将表观离散振铃频率定义为 $f_{\\text{pix}} = \\Delta x / \\Delta x_{\\text{zero}}$，其中 $\\Delta x$ 是像素间距。\n\n情况 A：补零前。\n像素间距给定为 $\\Delta x_{\\text{before}} = \\Delta x = L/N$。物理振铃周期 $\\Delta x_{\\text{zero}}$ 为 $L/N$。补零前的表观频率为：\n$$ f_{\\text{pix, before}} = \\frac{\\Delta x_{\\text{before}}}{\\Delta x_{\\text{zero}}} = \\frac{L/N}{L/N} = 1 $$\n单位是 周期/像素。\n\n情况 B：因子为2的补零后。\n关键信息是补零不改变采集的k空间范围，所以 $k_{\\max}$ 不变。因此，物理PSF及其特征振铃周期 $\\Delta x_{\\text{zero}}$ 保持不变：$\\Delta x_{\\text{zero}} = L/N$。\n然而，图像现在被重建到一个更精细的网格上。在相同的视场 $L$ 上，新的像素数为 $2N$。新的像素间距给定为 $\\Delta x_{\\text{after}} = \\Delta x' = L/(2N)$。\n补零后的表观频率为：\n$$ f_{\\text{pix, after}} = \\frac{\\Delta x_{\\text{after}}}{\\Delta x_{\\text{zero}}} = \\frac{L/(2N)}{L/N} = \\frac{L}{2N} \\cdot \\frac{N}{L} = \\frac{1}{2} $$\n单位是 周期/像素。\n\n3.  比率 $r$ 的计算：\n该比率定义为 $r = f_{\\text{pix, after}} / f_{\\text{pix, before}}$。\n$$ r = \\frac{1/2}{1} = \\frac{1}{2} $$\n\n现象解释及其影像组学影响：\n\n补零改变了像素坐标系下的表观振铃频率，但没有改变真实分辨率。真实空间分辨率从根本上由采集到的最大空间频率 $k_{\\max}$ 决定。该值定义了点扩散函数（PSF）主瓣的宽度，这决定了最小可分辨特征尺寸，约等于 $\\Delta x_{\\text{res}} \\propto 1/k_{\\max}$。吉布斯振铃伪影的特征物理周期 $\\Delta x_{\\text{zero}} = 1/(2k_{\\max})$ 也由采集物理过程固定。由于补零是一个后处理步骤，不增加新的高频信息（它只是在k空间数据中添加零），因此它不能提高真实分辨率或改变PSF的物理结构。\n\n补零的作用是内插图像数据。通过将k空间数组从 $N$ 点填充到 $2N$ 点，傅里叶逆变换在相同的视场 $L$ 内生成一个包含 $2N$ 像素的图像。这将像素间距从 $\\Delta x = L/N$ 减半为 $\\Delta x' = L/(2N)$。吉布斯振铃的固定物理模式现在由更小的像素进行采样。结果，波长为 $\\Delta x_{\\text{zero}} = L/N$ 的振荡现在跨越了两个新像素（$\\Delta x_{\\text{zero}} / \\Delta x' = (L/N) / (L/(2N)) = 2$）。这使得振荡在基于像素的单位中表现出更低的频率（从 $1$ 周期/像素降至 $0.5$ 周期/像素），从而有效地使振铃作为一种更平滑的波纹在视觉上更加明显。\n\n对基于边缘的影像组学特征的一项影响是再现性和鲁棒性的显著降低。设计用于测量纹理的影像组学特征，例如基于小波的特征或来自灰度共生矩阵（GLCM）的特征，对图像的空间频率内容很敏感。吉布斯振铃伪影引入了一种特定的振荡模式，尤其是在组织边界处。正如我们所展示的，补零改变了这种伪影在离散像素网格中的表观频率。分析原始图像高频内容的纹理特征可能会将该伪影解释为精细纹理，而在补零后的图像中，它将被测量为中频纹理。因此，影像组学特征值可能强烈依赖于补零这一重建参数，而非潜在的生物学特性，这损害了在可能使用不同重建协议的不同站点或扫描仪之间标准化和比较影像组学模型的潜力。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "在影像组学分析中，将图像重采样至统一的体素大小是一个关键的标准化步骤，但这并非没有代价。本练习  将引导你对不同的插值方法（如线性和三次B样条插值）如何引入其自身的伪影进行理论分析。通过对边缘锐度和纹理的量化建模，你将了解到这个看似简单的预处理步骤如何系统性地影响定量特征的提取，从而引入偏倚。",
            "id": "4533124",
            "problem": "在放射组学中，重采样到各向同性体素被广泛用于归一化以各向异性体素尺寸采集的图像。这个通过可分离插值实现的过程，已知会引入插值伪影，这里理解为信号边缘和纹理发生的一种系统性的、依赖于插值核的改变，而这种改变在原始对象中并不存在。考虑一个三维图像，其初始采样间距为 $\\Delta_{x}=\\Delta_{y}=1$ 毫米和 $\\Delta_{z}=3$ 毫米，该图像通过仅沿 $z$ 轴的可分离插值被重采样到一个各向同性的 $\\Delta^{\\ast}=1$ 毫米的网格上（$x$ 和 $y$ 轴保持不变）。您将需要建模插值核的选择如何改变边缘锐度并引入各向异性纹理偏差。\n\n仅使用以下基本原理：\n- 线性系统理论与卷积：如果 $f$ 与一个单位面积的平滑核 $k$ 进行卷积，其导数遵循 $\\frac{d}{dx}(f \\ast k)=\\left(\\frac{df}{dx}\\right)\\ast k$；对于单位阶跃函数 $H(x)$，有 $\\frac{d}{dx}H(x)=\\delta(x)$，因此卷积后边缘的导数等于 $k$。\n- 一维可分离插值可以建模为与一个单位面积的重建核 $k(x)$ 的卷积，该核的带宽和支撑域随目标间距 $\\Delta^{\\ast}$ 缩放。\n- 0次B样条（盒状函数）是 $\\Pi(x)$，1次B样条（用于线性插值）是三角函数 $\\Lambda(x)=\\Pi\\ast\\Pi(x)$，3次B样条是 $\\beta_{3}(x)=\\Pi\\ast\\Pi\\ast\\Pi\\ast\\Pi(x)$。\n- 卷积的傅里叶变换是傅里叶变换的乘积。对于角频率 $\\omega$，宽度为 $\\Delta^{\\ast}$ 的单位面积盒状函数的傅里叶变换是 $\\operatorname{sinc}\\!\\left(\\frac{\\omega\\Delta^{\\ast}}{2}\\right)$，其中 $\\operatorname{sinc}(u)=\\frac{\\sin u}{u}$。\n\n任务：\n1) 将沿 $z$ 轴的一维边缘建模为 $f(z)=H(z)$。在使用线性（1次）或三次（3次）B样条重建核 $k_{L}(z)=\\frac{1}{\\Delta^{\\ast}}\\Lambda\\!\\left(\\frac{z}{\\Delta^{\\ast}}\\right)$ 和 $k_{C}(z)=\\frac{1}{\\Delta^{\\ast}}\\beta_{3}\\!\\left(\\frac{z}{\\Delta^{\\ast}}\\right)$ 沿 $z$ 轴进行插值的情况下，将边缘锐度 $S$ 定义为重建后边缘沿 $z$ 轴导数的最大幅值。以闭式形式推导 $S_{L}$、$S_{C}$ 以及比率 $\\frac{S_{C}}{S_{L}}$。\n2) 将角空间频率 $\\omega_{0}$ 处的各向异性纹理偏差度量定义为重采样后沿 $z$ 轴相对于 $x$ 轴的功率比，即 $B=\\frac{|K_{z}(\\omega_{0})|^{2}}{|K_{x}(\\omega_{0})|^{2}}$，其中 $K_{z}$ 和 $K_{x}$ 分别是重采样算子沿 $z$ 轴和 $x$ 轴的一维频率响应。假设沿 $x$ 轴未应用插值，因此 $K_{x}(\\omega)=1$。利用上述卷积结构，推导 $K_{L}(\\omega)$ 和 $K_{C}(\\omega)$，然后以 $\\operatorname{sinc}$ 的形式获得比率 $\\frac{B_{C}}{B_{L}}$ 的闭式解。\n3) 定义一个复合标量度量 $M=\\left(\\frac{S_{C}}{S_{L}}\\right)\\left(\\frac{B_{C}}{B_{L}}\\right)$，用于量化从线性插值切换到三次插值时边缘锐度和各向异性纹理偏差的综合变化。对于 $\\Delta^{\\ast}=1$ 毫米和空间频率 $f_{0}=0.25$ 周/毫米（因此 $\\omega_{0}=2\\pi f_{0}$），对 $M$ 进行数值计算。将最终数值答案四舍五入到四位有效数字，并以无单位的纯数字形式报告。",
            "solution": "该问题是有效的，因为它科学地基于应用于图像处理的线性系统理论和傅里叶分析原理，问题定义明确、客观且自成体系。我现在将开始解答。\n\n该问题分为三个任务。首先，我将推导三次B样条插值与线性B样条插值的边缘锐度值之比。其次，我将推导两种核的各向异性纹理偏差度量之比。最后，我将结合这些结果来计算复合度量 $M$。\n\n### 任务1：边缘锐度比\n\n问题将边缘锐度 $S$ 定义为重建边缘导数的最大幅值。沿 $z$ 轴的边缘被建模为单位阶跃函数，$f(z) = H(z)$。重建过程是信号与插值核 $k(z)$ 的卷积。重建后的信号为 $f_{recon}(z) = f(z) \\ast k(z) = H(z) \\ast k(z)$。\n\n利用给定的卷积和微分性质 $\\frac{d}{dz}(f \\ast k) = (\\frac{df}{dz}) \\ast k$，以及单位阶跃函数的导数是狄拉克δ函数这一事实 $\\frac{d}{dz}H(z) = \\delta(z)$，重建边缘的导数为：\n$$\n\\frac{d}{dz}f_{recon}(z) = \\frac{d}{dz}(H(z) \\ast k(z)) = \\left(\\frac{d}{dz}H(z)\\right) \\ast k(z) = \\delta(z) \\ast k(z) = k(z)\n$$\n因此，边缘锐度是插值核本身的最大幅值：\n$$\nS = \\max_{z} \\left| \\frac{d}{dz}f_{recon}(z) \\right| = \\max_{z} |k(z)|\n$$\n对于线性插值，核函数为 $k_{L}(z) = \\frac{1}{\\Delta^{\\ast}}\\Lambda\\left(\\frac{z}{\\Delta^{\\ast}}\\right)$，其中 $\\Lambda(u)$ 是1次B样条（三角函数）。函数 $\\Lambda(u)$ 定义为 $\\max(0, 1 - |u|)$，其在 $u=0$ 处取得最大值1。因此，$k_L(z)$ 的最大值出现在 $z=0$ 处：\n$$\nS_{L} = \\max_{z} \\left| \\frac{1}{\\Delta^{\\ast}}\\Lambda\\left(\\frac{z}{\\Delta^{\\ast}}\\right) \\right| = \\frac{1}{\\Delta^{\\ast}} \\max_{u} |\\Lambda(u)| = \\frac{1}{\\Delta^{\\ast}} \\cdot 1 = \\frac{1}{\\Delta^{\\ast}}\n$$\n对于三次插值，核函数为 $k_{C}(z) = \\frac{1}{\\Delta^{\\ast}}\\beta_{3}\\left(\\frac{z}{\\Delta^{\\ast}}\\right)$，其中 $\\beta_3(u)$ 是3次B样条。三次B样条函数 $\\beta_3(u)$ 是一个分段多项式，它是对称的，并在 $u=0$ 处有最大值。在该点的值为 $\\beta_3(0) = \\frac{2}{3}$。该函数是非负的，所以其最大幅值就是其最大值。\n$$\nS_{C} = \\max_{z} \\left| \\frac{1}{\\Delta^{\\ast}}\\beta_{3}\\left(\\frac{z}{\\Delta^{\\ast}}\\right) \\right| = \\frac{1}{\\Delta^{\\ast}} \\max_{u} |\\beta_3(u)| = \\frac{1}{\\Delta^{\\ast}} \\beta_3(0) = \\frac{1}{\\Delta^{\\ast}} \\cdot \\frac{2}{3} = \\frac{2}{3\\Delta^{\\ast}}\n$$\n锐度值的比率为：\n$$\n\\frac{S_{C}}{S_{L}} = \\frac{2 / (3\\Delta^{\\ast})}{1 / \\Delta^{\\ast}} = \\frac{2}{3}\n$$\n\n### 任务2：各向异性纹理偏差比\n\n各向异性纹理偏差定义为 $B = \\frac{|K_{z}(\\omega_{0})|^{2}}{|K_{x}(\\omega_{0})|^{2}}$。由于沿 $x$ 轴没有应用插值，相应的频率响应为 $K_{x}(\\omega) = 1$。因此，偏差简化为 $B = |K_{z}(\\omega_{0})|^{2}$。$K_z(\\omega)$ 项是重采样算子的频率响应，也就是插值核 $k(z)$ 的傅里叶变换。\n\nB样条是通过对0次B样条 $\\Pi(x)$（即单位宽度、单位面积的盒状函数）进行重复卷积构建的。其傅里叶变换为 $\\mathcal{F}\\{\\Pi(x)\\}(\\omega) = \\operatorname{sinc}(\\frac{\\omega}{2})$。\n根据卷积定理，$\\Lambda(z) = \\Pi(z) \\ast \\Pi(z)$ 的傅里葉变换为 $\\hat{\\Lambda}(\\omega) = (\\operatorname{sinc}(\\frac{\\omega}{2}))^2$。\n类似地，$\\beta_3(z) = \\Pi(z) \\ast \\Pi(z) \\ast \\Pi(z) \\ast \\Pi(z)$ 的傅里叶变换为 $\\hat{\\beta}_3(\\omega) = (\\operatorname{sinc}(\\frac{\\omega}{2}))^4$。\n\n这些核是基本样条的缩放版本：$k(z) = \\frac{1}{\\Delta^{\\ast}} \\text{base\\_spline}(\\frac{z}{\\Delta^{\\ast}})$。利用傅里叶变换的缩放性质 $\\mathcal{F}\\{f(az)\\} = \\frac{1}{|a|}\\hat{f}(\\frac{\\omega}{a})$，频率响应为 $K(\\omega) = \\hat{\\text{base\\_spline}}(\\omega\\Delta^{\\ast})$。\n\n对于线性插值：\n$$\nK_{L}(\\omega) = \\hat{\\Lambda}(\\omega\\Delta^{\\ast}) = \\left(\\operatorname{sinc}\\left(\\frac{\\omega\\Delta^{\\ast}}{2}\\right)\\right)^{2}\n$$\n对于三次插值：\n$$\nK_{C}(\\omega) = \\hat{\\beta}_{3}(\\omega\\Delta^{\\ast}) = \\left(\\operatorname{sinc}\\left(\\frac{\\omega\\Delta^{\\ast}}{2}\\right)\\right)^{4}\n$$\n现在我们可以在 $\\omega_0$ 处计算偏差度量。因为 $\\operatorname{sinc}(u)$ 是一个实值函数，所以模的平方就是函数的平方。\n$$\nB_{L} = |K_{L}(\\omega_{0})|^{2} = \\left| \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{2} \\right|^{2} = \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{4}\n$$\n$$\nB_{C} = |K_{C}(\\omega_{0})|^{2} = \\left| \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{4} \\right|^{2} = \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{8}\n$$\n偏差度量的比率为：\n$$\n\\frac{B_{C}}{B_{L}} = \\frac{\\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{8}}{\\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{4}} = \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{4}\n$$\n\n### 任务3：复合度量评估\n\n复合度量 $M$ 是上面推导出的两个比率的乘积：\n$$\nM = \\left(\\frac{S_{C}}{S_{L}}\\right)\\left(\\frac{B_{C}}{B_{L}}\\right) = \\frac{2}{3} \\left(\\operatorname{sinc}\\left(\\frac{\\omega_{0}\\Delta^{\\ast}}{2}\\right)\\right)^{4}\n$$\n我们被给予了计算该表达式所需的数值：\n$\\Delta^{\\ast} = 1$ 毫米。\n空间频率 $f_{0} = 0.25$ 周/毫米。\n角空间频率为 $\\omega_{0} = 2\\pi f_{0} = 2\\pi(0.25) = \\frac{\\pi}{2}$ 弧度/毫米。\n\nsinc函数的参数是：\n$$\n\\frac{\\omega_{0}\\Delta^{\\ast}}{2} = \\frac{(\\pi/2) \\cdot 1}{2} = \\frac{\\pi}{4}\n$$\nsinc函数为 $\\operatorname{sinc}(u) = \\frac{\\sin(u)}{u}$。在 $u=\\frac{\\pi}{4}$ 处求值：\n$$\n\\operatorname{sinc}\\left(\\frac{\\pi}{4}\\right) = \\frac{\\sin(\\pi/4)}{\\pi/4} = \\frac{\\sqrt{2}/2}{\\pi/4} = \\frac{2\\sqrt{2}}{\\pi}\n$$\n现在我们将此代入 $M$ 的表达式中：\n$$\nM = \\frac{2}{3} \\left( \\frac{2\\sqrt{2}}{\\pi} \\right)^{4} = \\frac{2}{3} \\frac{(2\\sqrt{2})^{4}}{\\pi^{4}} = \\frac{2}{3} \\frac{(2^{4})(\\sqrt{2}^{4})}{\\pi^{4}} = \\frac{2}{3} \\frac{16 \\cdot 4}{\\pi^{4}} = \\frac{2}{3} \\frac{64}{\\pi^{4}} = \\frac{128}{3\\pi^{4}}\n$$\n为求数值，我们使用 $\\pi \\approx 3.14159...$：\n$$\nM = \\frac{128}{3\\pi^{4}} \\approx \\frac{128}{3 \\cdot (97.40909...)} \\approx \\frac{128}{292.22727...} \\approx 0.4379998...\n$$\n将此结果四舍五入到四位有效数字，得到 $0.4380$。",
            "answer": "$$\\boxed{0.4380}$$"
        }
    ]
}