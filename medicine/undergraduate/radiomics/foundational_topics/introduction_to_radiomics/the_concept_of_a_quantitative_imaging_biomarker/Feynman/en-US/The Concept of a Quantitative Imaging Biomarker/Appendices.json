{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in many radiomic analyses is the discretization of continuous voxel intensities into a finite number of gray levels. This process simplifies the data but also introduces a parameter—the bin width—that can significantly influence the final feature values. This practice  provides hands-on experience with this process, demonstrating how the choice of bin width directly impacts the calculation of a fundamental first-order feature, Shannon entropy, and introducing the important concept of feature sensitivity.",
            "id": "4566402",
            "problem": "A quantitative imaging biomarker in radiomics is an objectively measured characteristic derived from medical images that reflects underlying biology, defined from reproducible image measurements and well-posed feature computations. Consider a small Region of Interest (ROI) containing $12$ preprocessed voxel intensities (in arbitrary intensity units): $12, 15, 17, 18, 19, 20, 23, 27, 33, 37, 42, 49$. You will build a discretized gray-level representation using a fixed-bin-width scheme and recompute first-order features on the discretized values, then analyze sensitivity to the bin width choice.\n\nStart from the following foundational definitions, using only natural logarithms:\n\n- A fixed-bin-width discretization assigns to each voxel with intensity $I$ a discrete gray level $g(I; w)$ given by $g(I; w) = \\left\\lfloor \\dfrac{I - I_{\\min}}{w} \\right\\rfloor + 1$, where $I_{\\min}$ is the minimum intensity in the ROI and $w$ is the bin width.\n- The empirical gray-level histogram is defined by relative frequencies $p_k = \\dfrac{n_k}{N}$, where $n_k$ is the number of voxels in gray level $k$ and $N$ is the total number of voxels.\n- First-order features on the discretized values include the mean $\\mu = \\sum_{k} k\\,p_k$ and the Shannon entropy $H = -\\sum_{k} p_k \\ln(p_k)$.\n\nUsing the given ROI intensities, let $I_{\\min}$ be the minimum of the list and evaluate the discretized gray levels for two bin widths, $w_1 = 5$ and $w_2 = 10$. For each bin width, construct the histogram over the occurring gray levels, then compute the first-order features $\\mu$ and $H$ as defined above. Finally, define the bin-width sensitivity of the entropy at these two widths by the finite difference\n$$S = \\dfrac{H(w_2) - H(w_1)}{w_2 - w_1}.$$\nCompute $S$ and express your final answer in nats per intensity unit. Round your final numerical answer to four significant figures.",
            "solution": "The problem requires the calculation of the sensitivity of Shannon entropy to a change in bin width for a set of discretized voxel intensities. The process involves discretization, histogram construction, and entropy calculation for two different bin widths, followed by a finite difference approximation of the sensitivity.\n\nThe given set of $N=12$ voxel intensities is $I = \\{12, 15, 17, 18, 19, 20, 23, 27, 33, 37, 42, 49\\}$. The minimum intensity in this set is $I_{\\min} = 12$.\n\nThe discretization of an intensity value $I$ into a gray level $g$ is given by the formula:\n$$g(I; w) = \\left\\lfloor \\dfrac{I - I_{\\min}}{w} \\right\\rfloor + 1$$\nwhere $w$ is the bin width. We will perform this process for two bin widths, $w_1 = 5$ and $w_2 = 10$.\n\nFirst, we analyze the case with bin width $w_1 = 5$.\nThe discretization formula becomes $g(I; 5) = \\left\\lfloor \\dfrac{I - 12}{5} \\right\\rfloor + 1$. Applying this to each voxel intensity:\n- $g(12; 5) = \\lfloor (12-12)/5 \\rfloor + 1 = 1$\n- $g(15; 5) = \\lfloor (15-12)/5 \\rfloor + 1 = 1$\n- $g(17; 5) = \\lfloor (17-12)/5 \\rfloor + 1 = 2$\n- $g(18; 5) = \\lfloor (18-12)/5 \\rfloor + 1 = 2$\n- $g(19; 5) = \\lfloor (19-12)/5 \\rfloor + 1 = 2$\n- $g(20; 5) = \\lfloor (20-12)/5 \\rfloor + 1 = 2$\n- $g(23; 5) = \\lfloor (23-12)/5 \\rfloor + 1 = 3$\n- $g(27; 5) = \\lfloor (27-12)/5 \\rfloor + 1 = 4$\n- $g(33; 5) = \\lfloor (33-12)/5 \\rfloor + 1 = 5$\n- $g(37; 5) = \\lfloor (37-12)/5 \\rfloor + 1 = 6$\n- $g(42; 5) = \\lfloor (42-12)/5 \\rfloor + 1 = 7$\n- $g(49; 5) = \\lfloor (49-12)/5 \\rfloor + 1 = 8$\n\nThe set of discretized gray levels is $\\{1, 1, 2, 2, 2, 2, 3, 4, 5, 6, 7, 8\\}$.\nFrom this set, we construct the histogram. The counts $n_k$ for each gray level $k$ are:\n$n_1=2$, $n_2=4$, $n_3=1$, $n_4=1$, $n_5=1$, $n_6=1$, $n_7=1$, $n_8=1$.\nThe total count is $\\sum n_k = 2+4+1+1+1+1+1+1 = 12$, which equals $N$.\nThe relative frequencies $p_k = n_k/N$ are:\n$p_1=2/12=1/6$, $p_2=4/12=1/3$, and $p_k=1/12$ for $k \\in \\{3, 4, 5, 6, 7, 8\\}$.\n\nThe Shannon entropy for this distribution, denoted $H(w_1)$, is calculated as:\n$$H(w_1) = -\\sum_{k} p_k \\ln(p_k)$$\n$$H(w_1) = -\\left[ \\left(\\frac{1}{6}\\right)\\ln\\left(\\frac{1}{6}\\right) + \\left(\\frac{1}{3}\\right)\\ln\\left(\\frac{1}{3}\\right) + 6 \\cdot \\left(\\frac{1}{12}\\right)\\ln\\left(\\frac{1}{12}\\right) \\right]$$\nUsing the property $\\ln(1/x) = -\\ln(x)$:\n$$H(w_1) = \\frac{1}{6}\\ln(6) + \\frac{1}{3}\\ln(3) + \\frac{6}{12}\\ln(12) = \\frac{1}{6}\\ln(6) + \\frac{1}{3}\\ln(3) + \\frac{1}{2}\\ln(12)$$\nWe can express this in terms of prime logarithms, $\\ln(2)$ and $\\ln(3)$:\n$H(w_1) = \\frac{1}{6}(\\ln(2)+\\ln(3)) + \\frac{1}{3}\\ln(3) + \\frac{1}{2}(\\ln(4)+\\ln(3)) = \\frac{1}{6}(\\ln(2)+\\ln(3)) + \\frac{1}{3}\\ln(3) + \\frac{1}{2}(2\\ln(2)+\\ln(3))$\n$H(w_1) = \\left(\\frac{1}{6}+1\\right)\\ln(2) + \\left(\\frac{1}{6}+\\frac{1}{3}+\\frac{1}{2}\\right)\\ln(3) = \\frac{7}{6}\\ln(2) + \\ln(3)$\nNumerically, $H(w_1) \\approx 1.90728$.\n\nNext, we analyze the case with bin width $w_2 = 10$.\nThe discretization formula becomes $g(I; 10) = \\left\\lfloor \\dfrac{I - 12}{10} \\right\\rfloor + 1$.\n- $g(12; 10)=1$, $g(15; 10)=1$, $g(17; 10)=1$, $g(18; 10)=1$, $g(19; 10)=1$, $g(20; 10)=1$\n- $g(23; 10)=2$, $g(27; 10)=2$\n- $g(33; 10)=3$, $g(37; 10)=3$\n- $g(42; 10)=4$, $g(49; 10)=4$\n\nThe set of discretized gray levels is $\\{1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 4, 4\\}$.\nThe histogram counts $n_k$ are: $n_1=6$, $n_2=2$, $n_3=2$, $n_4=2$.\nThe total count is $6+2+2+2=12=N$.\nThe relative frequencies $p_k$ are: $p_1=6/12=1/2$, $p_2=2/12=1/6$, $p_3=1/6$, $p_4=1/6$.\n\nThe Shannon entropy for this distribution, $H(w_2)$, is:\n$$H(w_2) = -\\left[ \\left(\\frac{1}{2}\\right)\\ln\\left(\\frac{1}{2}\\right) + 3 \\cdot \\left(\\frac{1}{6}\\right)\\ln\\left(\\frac{1}{6}\\right) \\right]$$\n$$H(w_2) = \\frac{1}{2}\\ln(2) + \\frac{1}{2}\\ln(6) = \\frac{1}{2}(\\ln(2) + \\ln(6)) = \\frac{1}{2}\\ln(12)$$\nNumerically, $H(w_2) \\approx 1.24245$.\n\nFinally, we compute the bin-width sensitivity $S$ using the given finite difference formula:\n$$S = \\dfrac{H(w_2) - H(w_1)}{w_2 - w_1}$$\nSubstituting the calculated values and expressions:\n$$S = \\dfrac{\\frac{1}{2}\\ln(12) - \\left(\\frac{1}{6}\\ln(6) + \\frac{1}{3}\\ln(3) + \\frac{1}{2}\\ln(12)\\right)}{10 - 5}$$\n$$S = \\dfrac{-\\frac{1}{6}\\ln(6) - \\frac{1}{3}\\ln(3)}{5} = \\dfrac{-\\frac{1}{6}(\\ln(2)+\\ln(3)) - \\frac{2}{6}\\ln(3)}{5}$$\n$$S = \\dfrac{-\\frac{1}{6}\\ln(2) - \\frac{3}{6}\\ln(3)}{5} = \\dfrac{-\\frac{1}{6}\\ln(2) - \\frac{1}{2}\\ln(3)}{5}$$\n$$S = -\\frac{1}{30}\\ln(2) - \\frac{1}{10}\\ln(3) = -\\frac{1}{30}(\\ln(2) + 3\\ln(3)) = -\\frac{1}{30}(\\ln(2) + \\ln(3^3))$$\n$$S = -\\frac{\\ln(2 \\cdot 27)}{30} = -\\frac{\\ln(54)}{30}$$\n\nTo obtain the final numerical answer, we evaluate this expression:\n$$S = -\\frac{\\ln(54)}{30} \\approx -\\frac{3.988984}{30} \\approx -0.1329661...$$\nRounding to four significant figures, we get:\n$$S \\approx -0.1330$$\n\nThe problem also requested the calculation of the mean $\\mu = \\sum_k k\\,p_k$ for each distribution, though it is not used in the final sensitivity calculation. For completeness:\nFor $w_1=5$:\n$\\mu(w_1) = 1(\\frac{2}{12}) + 2(\\frac{4}{12}) + 3(\\frac{1}{12}) + 4(\\frac{1}{12}) + 5(\\frac{1}{12}) + 6(\\frac{1}{12}) + 7(\\frac{1}{12}) + 8(\\frac{1}{12}) = \\frac{2+8+3+4+5+6+7+8}{12} = \\frac{43}{12}$.\nFor $w_2=10$:\n$\\mu(w_2) = 1(\\frac{6}{12}) + 2(\\frac{2}{12}) + 3(\\frac{2}{12}) + 4(\\frac{2}{12}) = \\frac{6+4+6+8}{12} = \\frac{24}{12} = 2$.\n\nThe primary result required is the sensitivity $S$.",
            "answer": "$$\\boxed{-0.1330}$$"
        },
        {
            "introduction": "While first-order features summarize the intensity distribution, they ignore spatial patterns. Texture features, such as those derived from the Gray-Level Co-occurrence Matrix ($GLCM$), quantify the relationships between neighboring voxels to describe properties like roughness or heterogeneity. In this exercise , you will manually construct a $GLCM$ from a small image patch and compute key texture metrics, gaining a foundational understanding of how algorithms translate spatial patterns into quantitative biomarkers.",
            "id": "4566408",
            "problem": "A central goal in radiomics is to define quantitative imaging biomarkers as reproducible, quantitative measurements derived from images. Consider a discrete image patch already quantized into $L=4$ gray levels labeled $0,1,2,3$. The patch is\n$$\n\\begin{pmatrix}\n0 & 1 & 1 & 2 \\\\\n0 & 0 & 1 & 2 \\\\\n3 & 2 & 2 & 1 \\\\\n3 & 3 & 2 & 1\n\\end{pmatrix}.\n$$\nUsing the Gray Level Co-occurrence Matrix (GLCM) concept as a basis for a quantitative imaging biomarker of texture, do the following under these conditions:\n- Use offset distance $d=1$ at angle $0^{\\circ}$ (to the right along rows).\n- Count only pairs for which both pixels lie inside the patch; do not use wrap-around.\n- Construct a single, non-symmetric GLCM $G$ where entry $G(i,j)$ is the count of ordered pairs whose reference pixel has intensity $i$ and its neighbor at the specified offset has intensity $j$.\n- Normalize $G$ by the total number of counted pairs to obtain a probability mass function $P(i,j)$ on the set $\\{0,1,2,3\\} \\times \\{0,1,2,3\\}$.\n\nFrom $P(i,j)$, compute:\n1) the entropy $H=-\\sum_{i=0}^{3}\\sum_{j=0}^{3} P(i,j)\\,\\ln P(i,j)$, where $\\ln$ denotes the natural logarithm and $0\\ln 0$ is taken to be $0$;\n2) the contrast $C=\\sum_{i=0}^{3}\\sum_{j=0}^{3} (i-j)^{2}\\,P(i,j)$.\n\nReport your final answers as a two-entry row vector $(H, C)$, rounded to four significant figures. Both quantities are unitless and must be expressed using the natural logarithm definition given above. Angle is specified in degrees.",
            "solution": "The solution proceeds in three stages:\n1. Construction of the Gray Level Co-occurrence Matrix (GLCM), $G$.\n2. Normalization of $G$ to obtain the probability mass function, $P$.\n3. Computation of the entropy, $H$, and contrast, $C$, from $P$.\n\nThe image patch, $I$, is given as:\n$$\nI = \\begin{pmatrix}\n0 & 1 & 1 & 2 \\\\\n0 & 0 & 1 & 2 \\\\\n3 & 2 & 2 & 1 \\\\\n3 & 3 & 2 & 1\n\\end{pmatrix}\n$$\nThe gray levels range from $i, j \\in \\{0, 1, 2, 3\\}$. The offset is specified by distance $d=1$ and angle $\\theta=0^{\\circ}$, which corresponds to examining the pixel immediately to the right of each reference pixel. We only consider pairs where both pixels are within the patch. For a $4 \\times 4$ patch, this yields $4 \\times (4-1) = 12$ valid pairs.\n\nThe ordered pairs of gray levels $(i,j)$ are extracted by scanning the image patch from left to right, row by row:\nRow 1: $(0, 1), (1, 1), (1, 2)$\nRow 2: $(0, 0), (0, 1), (1, 2)$\nRow 3: $(3, 2), (2, 2), (2, 1)$\nRow 4: $(3, 3), (3, 2), (2, 1)$\n\nNext, we count the occurrences of each unique pair $(i, j)$ to populate the non-symmetric GLCM, $G(i,j)$. The indices $i$ and $j$ correspond to the gray levels $\\{0, 1, 2, 3\\}$.\n- $G(0,0)$: one occurrence.\n- $G(0,1)$: two occurrences.\n- $G(1,1)$: one occurrence.\n- $G(1,2)$: two occurrences.\n- $G(2,1)$: two occurrences.\n- $G(2,2)$: one occurrence.\n- $G(3,2)$: two occurrences.\n- $G(3,3)$: one occurrence.\nAll other entries $G(i,j)$ are zero. The resulting GLCM, $G$, is:\n$$\nG = \\begin{pmatrix}\n1 & 2 & 0 & 0 \\\\\n0 & 1 & 2 & 0 \\\\\n0 & 2 & 1 & 0 \\\\\n0 & 0 & 2 & 1\n\\end{pmatrix}\n$$\nThe sum of all entries in $G$ is $\\sum_{i,j} G(i,j) = 1+2+1+2+2+1+2+1=12$, which matches the total number of counted pairs, $N=12$.\n\nTo obtain the probability mass function $P(i,j)$, we normalize $G$ by the total number of pairs, $N=12$.\n$$\nP(i,j) = \\frac{G(i,j)}{N} = \\frac{G(i,j)}{12}\n$$\n$$\nP = \\frac{1}{12} \\begin{pmatrix}\n1 & 2 & 0 & 0 \\\\\n0 & 1 & 2 & 0 \\\\\n0 & 2 & 1 & 0 \\\\\n0 & 0 & 2 & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1/12 & 2/12 & 0 & 0 \\\\\n0 & 1/12 & 2/12 & 0 \\\\\n0 & 2/12 & 1/12 & 0 \\\\\n0 & 0 & 2/12 & 1/12\n\\end{pmatrix} = \\begin{pmatrix}\n1/12 & 1/6 & 0 & 0 \\\\\n0 & 1/12 & 1/6 & 0 \\\\\n0 & 1/6 & 1/12 & 0 \\\\\n0 & 0 & 1/6 & 1/12\n\\end{pmatrix}\n$$\nThe non-zero probabilities are $P(i,j) \\in \\{1/12, 1/6\\}$. There are $4$ entries with probability $1/12$ and $4$ entries with probability $1/6$.\n\nNow, we compute the entropy $H$ using the formula $H=-\\sum_{i=0}^{3}\\sum_{j=0}^{3} P(i,j)\\,\\ln P(i,j)$, with the convention $0\\ln 0 = 0$.\n$$\nH = - \\left( 4 \\cdot \\frac{1}{12} \\ln\\left(\\frac{1}{12}\\right) + 4 \\cdot \\frac{1}{6} \\ln\\left(\\frac{1}{6}\\right) \\right)\n$$\n$$\nH = - \\left( \\frac{1}{3} (-\\ln 12) + \\frac{2}{3} (-\\ln 6) \\right) = \\frac{1}{3}\\ln 12 + \\frac{2}{3}\\ln 6\n$$\nUsing logarithm properties, $\\ln(ab) = \\ln a + \\ln b$ and $\\ln(a^k) = k \\ln a$:\n$ \\ln 12 = \\ln(2^2 \\cdot 3) = 2\\ln 2 + \\ln 3 $\n$ \\ln 6 = \\ln(2 \\cdot 3) = \\ln 2 + \\ln 3 $\nSubstituting these into the expression for $H$:\n$$\nH = \\frac{1}{3}(2\\ln 2 + \\ln 3) + \\frac{2}{3}(\\ln 2 + \\ln 3) = \\frac{2}{3}\\ln 2 + \\frac{1}{3}\\ln 3 + \\frac{2}{3}\\ln 2 + \\frac{2}{3}\\ln 3 = \\frac{4}{3}\\ln 2 + \\ln 3\n$$\nNumerically, using $\\ln 2 \\approx 0.693147$ and $\\ln 3 \\approx 1.098612$:\n$$\nH \\approx \\frac{4}{3}(0.693147) + 1.098612 \\approx 0.924196 + 1.098612 = 2.022808\n$$\nRounding to four significant figures, $H \\approx 2.023$.\n\nNext, we compute the contrast $C$ using the formula $C=\\sum_{i=0}^{3}\\sum_{j=0}^{3} (i-j)^{2}\\,P(i,j)$.\nThe summation is performed over all non-zero entries of $P$:\n$$\nC = (0-0)^2 P(0,0) + (0-1)^2 P(0,1) + (1-1)^2 P(1,1) + (1-2)^2 P(1,2) + (2-1)^2 P(2,1) + (2-2)^2 P(2,2) + (3-2)^2 P(3,2) + (3-3)^2 P(3,3)\n$$\nAll diagonal terms $(i=j)$ contribute $0$ to the sum. The non-zero, non-diagonal terms all have $|i-j|=1$, so $(i-j)^2 = 1$.\n$$\nC = 1 \\cdot P(0,1) + 1 \\cdot P(1,2) + 1 \\cdot P(2,1) + 1 \\cdot P(3,2)\n$$\n$$\nC = \\frac{2}{12} + \\frac{2}{12} + \\frac{2}{12} + \\frac{2}{12} = \\frac{8}{12} = \\frac{2}{3}\n$$\nNumerically, $C = 2/3 \\approx 0.666666\\dots$.\nRounding to four significant figures, $C \\approx 0.6667$.\n\nThe final result is the two-entry row vector $(H, C)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.023 & 0.6667\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "For a quantitative imaging biomarker to be clinically useful, it must be robust, meaning its value should remain stable despite minor variations in the imaging or analysis process. A primary source of such variation is the manual delineation of the region of interest by different observers. This practice  explores this concept by having you calculate standard segmentation agreement metrics and correlate them with the variability of a radiomic feature, providing insight into what makes a biomarker reliable.",
            "id": "4566416",
            "problem": "A key requirement for a quantitative imaging biomarker is that its value be robust to reasonable variations in image segmentation across observers. Consider three independent imaging cases, each segmented by two observers (Observer A and Observer B). You will evaluate segmentation agreement using the standard set overlap coefficient known as the Dice Similarity Coefficient (DSC) and the boundary disagreement using the empirical ninety-fifth percentile Hausdorff distance (HD95). You will then relate these to the variability of a candidate radiomic texture feature, the first-order intensity variance computed with the population formula. Assume voxel spacing is isotropic with unit edge length so that Euclidean distances between boundary points are measured in voxel units.\n\nFor each case, you are given:\n- Case-level set sizes and overlaps: for case $1$, $|A|=50$, $|B|=48$, and $|A \\cap B|=44$; for case $2$, $|A|=60$, $|B|=42$, and $|A \\cap B|=30$; for case $3$, $|A|=55$, $|B|=55$, and $|A \\cap B|=50$.\n- The union of directed shortest boundary-to-surface distances used for the Hausdorff calculation (that is, distances from the boundary of one segmentation to the other segmentation, computed in both directions, pooled together). For case $1$, there are $N=40$ distances: $30$ equal to $0$, $8$ equal to $1$, and $2$ equal to $2$. For case $2$, there are $N=40$ distances: $10$ equal to $0$, $10$ equal to $1$, $10$ equal to $2$, and $10$ equal to $3$. For case $3$, there are $N=40$ distances: $34$ equal to $0$ and $6$ equal to $1$. Define the empirical $95$th percentile as the element at rank $k=\\lceil 0.95\\,N\\rceil$ in the nondecreasingly sorted list of these distances.\n- The precomputed first-order intensity variance values within each observer’s segmentation (population variance): for case $1$, $\\mathrm{Var}_{A}=22$, $\\mathrm{Var}_{B}=26$; for case $2$, $\\mathrm{Var}_{A}=49$, $\\mathrm{Var}_{B}=31$; for case $3$, $\\mathrm{Var}_{A}=15$, $\\mathrm{Var}_{B}=16$.\n\nTasks:\n1. For each case $i \\in \\{1,2,3\\}$, compute the Dice Similarity Coefficient (DSC) from the provided set sizes and overlap, and compute the HD95 from the provided pooled distance multiset using the rank definition $k=\\lceil 0.95\\,N\\rceil$.\n2. For each case $i$, compute the absolute difference in the first-order variance between observers, $\\Delta \\mathrm{Var}_{i}=|\\mathrm{Var}_{A,i}-\\mathrm{Var}_{B,i}|$.\n3. Let $\\mathbf{d}$ be the vector of the three DSC values, $\\mathbf{h}$ be the vector of the three HD95 values, and $\\mathbf{v}$ be the vector of the three $\\Delta \\mathrm{Var}$ values. Compute the Pearson linear correlation coefficient between $\\mathbf{d}$ and $\\mathbf{v}$, and independently between $\\mathbf{h}$ and $\\mathbf{v}$. Finally, compute the difference between these two correlation coefficients.\n\nReport the single final value of the difference between the two correlation coefficients as a dimensionless number, rounded to $4$ significant figures.",
            "solution": "The problem requires a three-part calculation to assess the relationship between segmentation variability and the stability of a radiomic feature. First, we compute metrics of segmentation agreement and disagreement for three cases. Second, we compute the inter-observer variability of a radiomic feature for each case. Third, we correlate these metrics to quantify their relationship.\n\nThe definitions for the metrics are as follows:\nThe Dice Similarity Coefficient (DSC) for two sets $A$ and $B$ is given by:\n$$ \\mathrm{DSC} = \\frac{2 |A \\cap B|}{|A| + |B|} $$\nThe empirical $95$th percentile Hausdorff distance (HD95) is defined as the element at rank $k=\\lceil 0.95\\,N\\rceil$ in the nondecreasingly sorted list of $N$ boundary-to-surface distances.\nThe absolute difference in the first-order variance for case $i$ is:\n$$ \\Delta \\mathrm{Var}_{i} = |\\mathrm{Var}_{A,i} - \\mathrm{Var}_{B,i}| $$\nThe Pearson linear correlation coefficient $r$ between two vectors of observations $\\mathbf{x}=(x_1, x_2, \\dots, x_n)$ and $\\mathbf{y}=(y_1, y_2, \\dots, y_n)$ is:\n$$ r(\\mathbf{x}, \\mathbf{y}) = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2 \\sum_{i=1}^{n} (y_i - \\bar{y})^2}} $$\nwhere $\\bar{x}$ and $\\bar{y}$ are the sample means of $\\mathbf{x}$ and $\\mathbf{y}$, respectively.\n\n**Task 1: Compute DSC and HD95 for each case**\n\nFor all cases, the number of pooled boundary distances is $N=40$. The rank for the $95$th percentile is thus $k = \\lceil 0.95 \\times 40 \\rceil = \\lceil 38 \\rceil = 38$. We must find the $38$th value in the sorted list of distances for each case.\n\n**Case 1:**\n- Given: $|A_1|=50$, $|B_1|=48$, $|A_1 \\cap B_1|=44$.\n- $\\mathrm{DSC}_1 = \\frac{2 \\times 44}{50 + 48} = \\frac{88}{98} = \\frac{44}{49}$.\n- The sorted distance multiset has $30$ values of $0$, $8$ values of $1$, and $2$ values of $2$. The element at rank $38$ (the last of the $1$s) is $1$.\n- Thus, $\\mathrm{HD95}_1 = 1$.\n\n**Case 2:**\n- Given: $|A_2|=60$, $|B_2|=42$, $|A_2 \\cap B_2|=30$.\n- $\\mathrm{DSC}_2 = \\frac{2 \\times 30}{60 + 42} = \\frac{60}{102} = \\frac{10}{17}$.\n- The sorted distance multiset has $10$ values of $0$, $10$ of $1$, $10$ of $2$, and $10$ of $3$. The elements from rank $31$ to $40$ are all $3$. The element at rank $38$ is $3$.\n- Thus, $\\mathrm{HD95}_2 = 3$.\n\n**Case 3:**\n- Given: $|A_3|=55$, $|B_3|=55$, $|A_3 \\cap B_3|=50$.\n- $\\mathrm{DSC}_3 = \\frac{2 \\times 50}{55 + 55} = \\frac{100}{110} = \\frac{10}{11}$.\n- The sorted distance multiset has $34$ values of $0$ and $6$ values of $1$. The elements from rank $35$ to $40$ are all $1$. The element at rank $38$ is $1$.\n- Thus, $\\mathrm{HD95}_3 = 1$.\n\n**Task 2: Compute $\\Delta \\mathrm{Var}$ for each case**\n\n**Case 1:**\n- Given: $\\mathrm{Var}_{A,1}=22$, $\\mathrm{Var}_{B,1}=26$.\n- $\\Delta \\mathrm{Var}_1 = |22 - 26| = 4$.\n\n**Case 2:**\n- Given: $\\mathrm{Var}_{A,2}=49$, $\\mathrm{Var}_{B,2}=31$.\n- $\\Delta \\mathrm{Var}_2 = |49 - 31| = 18$.\n\n**Case 3:**\n- Given: $\\mathrm{Var}_{A,3}=15$, $\\mathrm{Var}_{B,3}=16$.\n- $\\Delta \\mathrm{Var}_3 = |15 - 16| = 1$.\n\n**Task 3: Compute correlations and their difference**\n\nWe assemble the three vectors of calculated values:\n- DSC values: $\\mathbf{d} = (\\frac{44}{49}, \\frac{10}{17}, \\frac{10}{11})$\n- HD95 values: $\\mathbf{h} = (1, 3, 1)$\n- $\\Delta \\mathrm{Var}$ values: $\\mathbf{v} = (4, 18, 1)$\n\nFirst, we compute the Pearson correlation coefficient $r(\\mathbf{d}, \\mathbf{v})$.\nThe means are:\n$\\bar{d} = \\frac{1}{3}(\\frac{44}{49} + \\frac{10}{17} + \\frac{10}{11}) = \\frac{7316}{9163}$\n$\\bar{v} = \\frac{1}{3}(4 + 18 + 1) = \\frac{23}{3}$\nThe sum of products of deviations (covariance term) is:\n$\\sum (d_i - \\bar{d})(v_i - \\bar{v}) = (\\frac{44}{49}-\\frac{7316}{9163})(4-\\frac{23}{3}) + (\\frac{10}{17}-\\frac{7316}{9163})(18-\\frac{23}{3}) + (\\frac{10}{11}-\\frac{7316}{9163})(1-\\frac{23}{3})$\n$= (\\frac{912}{9163})(-\\frac{11}{3}) + (\\frac{-1926}{9163})(\\frac{31}{3}) + (\\frac{1014}{9163})(-\\frac{20}{3})$\n$= \\frac{-10032 - 59706 - 20280}{27489} = \\frac{-90018}{27489} \\approx -3.274655$\nThe sums of squared deviations are:\n$\\sum (d_i - \\bar{d})^2 = (\\frac{912}{9163})^2 + (\\frac{-1926}{9163})^2 + (\\frac{1014}{9163})^2 = \\frac{5569416}{9163^2} \\approx 0.066336$\n$\\sum (v_i - \\bar{v})^2 = (4-\\frac{23}{3})^2 + (18-\\frac{23}{3})^2 + (1-\\frac{23}{3})^2 = (-\\frac{11}{3})^2 + (\\frac{31}{3})^2 + (-\\frac{20}{3})^2 = \\frac{121+961+400}{9} = \\frac{1482}{9} = \\frac{494}{3}$\n$r(\\mathbf{d}, \\mathbf{v}) = \\frac{-90018/27489}{\\sqrt{(\\frac{5569416}{9163^2})(\\frac{494}{3})}} \\approx \\frac{-3.274655}{\\sqrt{0.066336 \\times 164.666...}} \\approx \\frac{-3.274655}{\\sqrt{10.9234}} \\approx -0.99080$\n\nNext, we compute the Pearson correlation coefficient $r(\\mathbf{h}, \\mathbf{v})$.\nThe means are:\n$\\bar{h} = \\frac{1}{3}(1 + 3 + 1) = \\frac{5}{3}$\n$\\bar{v} = \\frac{23}{3}$ (as before)\nThe covariance term is:\n$\\sum (h_i - \\bar{h})(v_i - \\bar{v}) = (1-\\frac{5}{3})(4-\\frac{23}{3}) + (3-\\frac{5}{3})(18-\\frac{23}{3}) + (1-\\frac{5}{3})(1-\\frac{23}{3})$\n$= (-\\frac{2}{3})(-\\frac{11}{3}) + (\\frac{4}{3})(\\frac{31}{3}) + (-\\frac{2}{3})(-\\frac{20}{3})$\n$= \\frac{22 + 124 + 40}{9} = \\frac{186}{9} = \\frac{62}{3}$\nThe sum of squared deviations for $\\mathbf{h}$ is:\n$\\sum (h_i - \\bar{h})^2 = (-\\frac{2}{3})^2 + (\\frac{4}{3})^2 + (-\\frac{2}{3})^2 = \\frac{4+16+4}{9} = \\frac{24}{9} = \\frac{8}{3}$\n$r(\\mathbf{h}, \\mathbf{v}) = \\frac{62/3}{\\sqrt{(8/3)(494/3)}} = \\frac{62/3}{\\sqrt{3952/9}} = \\frac{62/3}{\\sqrt{3952}/3} = \\frac{62}{\\sqrt{3952}} \\approx \\frac{62}{62.8649} \\approx 0.98624$\n\nFinally, we compute the difference between the two correlation coefficients.\nDifference $= r(\\mathbf{d}, \\mathbf{v}) - r(\\mathbf{h}, \\mathbf{v}) \\approx -0.99080 - 0.98624 = -1.97704$\nRounding to $4$ significant figures, the result is $-1.977$.\nThe strong negative correlation between DSC and $\\Delta\\mathrm{Var}$ indicates that better volumetric overlap corresponds to lower feature variability. The strong positive correlation between HD95 and $\\Delta\\mathrm{Var}$ indicates that larger boundary discrepancies correspond to higher feature variability. Both findings are consistent with the properties of a robust biomarker. The requested difference is the final result.",
            "answer": "$$\\boxed{-1.977}$$"
        }
    ]
}