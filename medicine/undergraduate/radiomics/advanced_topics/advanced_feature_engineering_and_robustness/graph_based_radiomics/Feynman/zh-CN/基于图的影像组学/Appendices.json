{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握基于图的放射组学，理解图上的基本操作至关重要。此练习将带您亲手计算图拉普拉斯算子（Graph Laplacian）如何平滑信号，这是图信号处理（Graph Signal Processing, GSP）中的一个核心概念。通过模拟一个简化的肿瘤超体素网络中的信号扩散，您将直观地看到加权连接如何影响局部特征值的平均化过程，从而加深对图结构如何调节信息的理解。",
            "id": "4542586",
            "problem": "在基于图的放射组学中，一个肿瘤区域被分割成 $4$ 个超体素，并且在每个超体素上定义了一个标量放射组学信号（例如，一个由强度衍生的纹理值）。考虑一个具有 $4$ 个节点的简单无向加权图，这些节点代表这些超体素。加权邻接矩阵 $W$ 为\n$$\nW \\,=\\, \\begin{pmatrix}\n0 & 2 & 0 & 0\\\\\n2 & 0 & 1 & 0\\\\\n0 & 1 & 0 & 3\\\\\n0 & 0 & 3 & 0\n\\end{pmatrix},\n$$\n且对应的度矩阵 $D$ 是一个对角矩阵，其对角线上的元素等于 $W$ 的行和。组合图拉普拉斯算子定义为 $L \\,=\\, D \\,-\\, W$。这 $4$ 个超体素上的初始放射组学信号是向量\n$$\nx(0) \\,=\\, \\begin{pmatrix} 8\\\\ 4\\\\ 10\\\\ 2 \\end{pmatrix}.\n$$\n假设信号根据图热方程 $\\frac{dx(t)}{dt} \\,=\\, -\\,L\\,x(t)$ 演化，这是一个在图信号处理（GSP）中用于平滑图上信号的、经过充分检验的扩散模型。使用大小为 $\\tau \\,=\\, \\frac{1}{4}$ 的单个显式欧拉时间步，计算一步后更新的信号 $x(\\tau)$。使用 $\\texttt{pmatrix}$ 环境将您的最终答案报告为单个行向量，要求使用精确值且不进行四舍五入。然后，仅根据您计算出的结果，简要解释该操作是否在强连接的超体素之间表现出平滑效应。信号值没有物理单位。",
            "solution": "任务是计算在放射组学背景下，代表超体素的小型图上的图热方程的一个显式欧拉步。其基本原理是图热方程，即图信号处理（GSP）中图上的标准扩散方程：$\\frac{dx(t)}{dt} \\,=\\, -\\,L\\,x(t)$，其中 $L$ 是组合图拉普拉斯算子。一个步长为 $\\tau$ 的单个显式欧拉步通过以下方式更新信号\n$$\nx(\\tau) \\,=\\, x(0) \\,-\\, \\tau\\,L\\,x(0).\n$$\n我们首先从邻接矩阵 $W$ 构建度矩阵 $D$。每个节点的度是其关联边权重的总和。读取 $W$ 的行和：\n- 节点 $1$：$2$，所以 $d_{1} \\,=\\, 2$，\n- 节点 $2$：$2 \\,+\\, 1 \\,=\\, 3$，所以 $d_{2} \\,=\\, 3$，\n- 节点 $3$：$1 \\,+\\, 3 \\,=\\, 4$，所以 $d_{3} \\,=\\, 4$，\n- 节点 $4$：$3$，所以 $d_{4} \\,=\\, 3$。\n因此，\n$$\nD \\,=\\, \\begin{pmatrix}\n2 & 0 & 0 & 0\\\\\n0 & 3 & 0 & 0\\\\\n0 & 0 & 4 & 0\\\\\n0 & 0 & 0 & 3\n\\end{pmatrix}.\n$$\n组合拉普拉斯算子是 $L \\,=\\, D \\,-\\, W$，因此\n$$\nL \\,=\\, \\begin{pmatrix}\n2 & -2 & 0 & 0\\\\\n-2 & 3 & -1 & 0\\\\\n0 & -1 & 4 & -3\\\\\n0 & 0 & -3 & 3\n\\end{pmatrix}.\n$$\n现在我们计算 $L\\,x(0)$。设 $x(0) \\,=\\, \\begin{pmatrix} 8\\\\ 4\\\\ 10\\\\ 2 \\end{pmatrix}$。那么\n$$\nL\\,x(0) \\,=\\, \\begin{pmatrix}\n2 & -2 & 0 & 0\\\\\n-2 & 3 & -1 & 0\\\\\n0 & -1 & 4 & -3\\\\\n0 & 0 & -3 & 3\n\\end{pmatrix}\n\\begin{pmatrix} 8\\\\ 4\\\\ 10\\\\ 2 \\end{pmatrix}\n\\,=\\, \\begin{pmatrix}\n2\\cdot 8 \\,+\\, (-2)\\cdot 4 \\,+\\, 0\\cdot 10 \\,+\\, 0\\cdot 2\\\\\n(-2)\\cdot 8 \\,+\\, 3\\cdot 4 \\,+\\, (-1)\\cdot 10 \\,+\\, 0\\cdot 2\\\\\n0\\cdot 8 \\,+\\, (-1)\\cdot 4 \\,+\\, 4\\cdot 10 \\,+\\, (-3)\\cdot 2\\\\\n0\\cdot 8 \\,+\\, 0\\cdot 4 \\,+\\, (-3)\\cdot 10 \\,+\\, 3\\cdot 2\n\\end{pmatrix}\n\\,=\\, \\begin{pmatrix}\n16 \\,-\\, 8\\\\\n-16 \\,+\\, 12 \\,-\\, 10\\\\\n-4 \\,+\\, 40 \\,-\\, 6\\\\\n-30 \\,+\\, 6\n\\end{pmatrix}\n\\,=\\, \\begin{pmatrix}\n8\\\\\n-14\\\\\n30\\\\\n-24\n\\end{pmatrix}.\n$$\n当步长 $\\tau \\,=\\, \\frac{1}{4}$ 时，显式欧拉更新为\n$$\nx(\\tau) \\,=\\, x(0) \\,-\\, \\tau\\,L\\,x(0) \\,=\\, \\begin{pmatrix} 8\\\\ 4\\\\ 10\\\\ 2 \\end{pmatrix} \\,-\\, \\frac{1}{4}\\begin{pmatrix} 8\\\\ -14\\\\ 30\\\\ -24 \\end{pmatrix}\n\\,=\\, \\begin{pmatrix}\n8 \\,-\\, 2\\\\\n4 \\,-\\, (-3.5)\\\\\n10 \\,-\\, 7.5\\\\\n2 \\,-\\, (-6)\n\\end{pmatrix}\n\\,=\\, \\begin{pmatrix}\n6\\\\\n7.5\\\\\n2.5\\\\\n8\n\\end{pmatrix}.\n$$\n为了解释平滑效应，请注意操作 $x(\\tau) \\,=\\, x(0) \\,-\\, \\tau L x(0)$ 对应于在边上进行一步扩散平均，权重较大的边上交换更强。节点 $3$ 和 $4$ 之间的边权重为 $3$，是图中最大的，节点 $3$ 和 $4$ 的值确实显著地向彼此靠拢：节点 $3$ 的值从 $10$ 减少到 $2.5$，而节点 $4$ 的值从 $2$ 增加到 $8$，这反映了在该重权连接上的强平滑效应。类似地，节点 $1$ 和 $2$ 通过权重为 $2$ 的边进行交换，节点 $2$ 的值增加而节点 $1$ 的值减少，这与从高值向低值扩散的现象一致。总的来说，单步滤波器抑制了图上的高频变化，并促进了局部平滑，尤其是在强连接的超体素之间。",
            "answer": "$$\\boxed{\\begin{pmatrix} 6 & 7.5 & 2.5 & 8 \\end{pmatrix}}$$"
        },
        {
            "introduction": "图论在放射组学中的一个关键应用是识别肿瘤内部的异质性区域，即“肿瘤栖息地”（tumor habitats）。归一化切割（Normalized Cut, Ncut）是一种强大的图分割技术，它旨在将图分割成平衡且内部联系紧密的子图。本次练习通过一个微型图，让您完整地计算并比较不同分割方案的Ncut值，从而找到最优分割。这个过程将揭示Ncut为何能有效避免将单个节点孤立出来，并能识别出有意义的结构性分区。",
            "id": "4542577",
            "problem": "在基于图的影像组学中，病变感兴趣区域内的空间连续强度模式通常表示为节点，它们之间的成对相似性表示为加权边。考虑一个玩具无向加权图，其节点 $v_1, v_2, v_3, v_4, v_5$ 代表从磁共振成像病变中提取的五个超体素。边权重模拟外观和空间相似性，由对角线为零的对称邻接矩阵 $W = (w_{ij})$ 指定：\n$$\nW \\;=\\;\n\\begin{pmatrix}\n0 & 8 & 7 & 1 & 1 \\\\\n8 & 0 & 9 & 1 & 1 \\\\\n7 & 9 & 0 & 1 & 1 \\\\\n1 & 1 & 1 & 0 & 6 \\\\\n1 & 1 & 1 & 6 & 0\n\\end{pmatrix}.\n$$\n设节点 $v_i$ 的加权度为 $d_i = \\sum_{j=1}^{5} w_{ij}$。对于节点的任何子集 $S \\subseteq V$，定义其关联度为 $\\operatorname{assoc}(S, V) = \\sum_{i \\in S} d_i$，以及 $S$ 与其补集 $\\bar{S}$ 之间的切割为 $\\operatorname{cut}(S, \\bar{S}) = \\sum_{i \\in S} \\sum_{j \\in \\bar{S}} w_{ij}$。标准化切割 (Ncut) 定义为\n$$\n\\operatorname{Ncut}(S,\\bar{S}) \\;=\\; \\frac{\\operatorname{cut}(S,\\bar{S})}{\\operatorname{assoc}(S, V)} \\;+\\; \\frac{\\operatorname{cut}(S,\\bar{S})}{\\operatorname{assoc}(\\bar{S}, V)}.\n$$\n从这些定义出发，计算所有节点的加权度 $d_i$、图的总度 $\\sum_{i=1}^{5} d_i$，然后对于 $V$ 的每一个非平凡二分（划分为两个不相交的非空子集 $(S,\\bar{S})$），计算 $\\operatorname{cut}(S,\\bar{S})$、$\\operatorname{assoc}(S, V)$、$\\operatorname{assoc}(\\bar{S}, V)$ 和 $\\operatorname{Ncut}(S,\\bar{S})$。确定使 $\\operatorname{Ncut}(S,\\bar{S})$ 最小化的二分，并报告最小的标准化切割值。将最终的最小值表示为一个精确的有理数，不进行四舍五入。",
            "solution": "目标是找到顶点集 $V=\\{v_1, v_2, v_3, v_4, v_5\\}$ 的一个二分 $(S, \\bar{S})$，使得标准化切割 $\\operatorname{Ncut}(S,\\bar{S})$ 最小，并报告这个最小值。图的结构由对称邻接矩阵 $W$ 定义。\n\n首先，我们通过对邻接矩阵 $W$ 中相应行的元素求和，来计算每个节点 $v_i \\in V$ 的加权度 $d_i$。\n$d_1 = \\sum_{j=1}^{5} w_{1j} = 0 + 8 + 7 + 1 + 1 = 17$\n$d_2 = \\sum_{j=1}^{5} w_{2j} = 8 + 0 + 9 + 1 + 1 = 19$\n$d_3 = \\sum_{j=1}^{5} w_{3j} = 7 + 9 + 0 + 1 + 1 = 18$\n$d_4 = \\sum_{j=1}^{5} w_{4j} = 1 + 1 + 1 + 0 + 6 = 9$\n$d_5 = \\sum_{j=1}^{5} w_{5j} = 1 + 1 + 1 + 6 + 0 = 9$\n\n度向量为 $(d_1, d_2, d_3, d_4, d_5) = (17, 19, 18, 9, 9)$。\n\n图的总度是所有加权度之和，为：\n$$ \\operatorname{assoc}(V, V) = \\sum_{i=1}^{5} d_i = 17 + 19 + 18 + 9 + 9 = 72 $$\n\n接下来，我们评估 $V$ 的所有非平凡二分 $(S, \\bar{S})$。如果 $S$ 和其补集 $\\bar{S} = V \\setminus S$ 均非空，则该二分为非平凡的。$\\operatorname{Ncut}$ 函数是对称的，即 $\\operatorname{Ncut}(S, \\bar{S}) = \\operatorname{Ncut}(\\bar{S}, S)$。因此，我们只需要考虑 $|S| \\le |\\bar{S}|$ 的划分。对于一个包含5个节点的集合，这意味着我们只需要评估大小为 $|S|=1$ 和 $|S|=2$ 的子集 $S$。\n\n**情况1：$|S|=1$ 的划分**\n共有 $\\binom{5}{1} = 5$ 种这样的划分。对于 $S = \\{v_i\\}$，我们有 $\\operatorname{cut}(S, \\bar{S}) = \\sum_{j \\ne i} w_{ij} = d_i$ 和 $\\operatorname{assoc}(S, V) = d_i$。\n1.  $S = \\{v_1\\}$, $\\bar{S} = \\{v_2, v_3, v_4, v_5\\}$：\n    $\\operatorname{cut}(S, \\bar{S}) = d_1 = 17$。\n    $\\operatorname{assoc}(S, V) = d_1 = 17$。\n    $\\operatorname{assoc}(\\bar{S}, V) = 72 - 17 = 55$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{17}{17} + \\frac{17}{55} = 1 + \\frac{17}{55} = \\frac{72}{55}$。\n\n2.  $S = \\{v_2\\}$, $\\bar{S} = \\{v_1, v_3, v_4, v_5\\}$：\n    $\\operatorname{cut}(S, \\bar{S}) = d_2 = 19$。\n    $\\operatorname{assoc}(S, V) = d_2 = 19$。\n    $\\operatorname{assoc}(\\bar{S}, V) = 72 - 19 = 53$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{19}{19} + \\frac{19}{53} = 1 + \\frac{19}{53} = \\frac{72}{53}$。\n\n3.  $S = \\{v_3\\}$, $\\bar{S} = \\{v_1, v_2, v_4, v_5\\}$：\n    $\\operatorname{cut}(S, \\bar{S}) = d_3 = 18$。\n    $\\operatorname{assoc}(S, V) = d_3 = 18$。\n    $\\operatorname{assoc}(\\bar{S}, V) = 72 - 18 = 54$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{18}{18} + \\frac{18}{54} = 1 + \\frac{1}{3} = \\frac{4}{3}$。\n\n4.  $S = \\{v_4\\}$, $\\bar{S} = \\{v_1, v_2, v_3, v_5\\}$：\n    $\\operatorname{cut}(S, \\bar{S}) = d_4 = 9$。\n    $\\operatorname{assoc}(S, V) = d_4 = 9$。\n    $\\operatorname{assoc}(\\bar{S}, V) = 72 - 9 = 63$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{9}{9} + \\frac{9}{63} = 1 + \\frac{1}{7} = \\frac{8}{7}$。\n\n5.  $S = \\{v_5\\}$, $\\bar{S} = \\{v_1, v_2, v_3, v_4\\}$：\n    $\\operatorname{cut}(S, \\bar{S}) = d_5 = 9$。\n    $\\operatorname{assoc}(S, V) = d_5 = 9$。\n    $\\operatorname{assoc}(\\bar{S}, V) = 72 - 9 = 63$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{9}{9} + \\frac{9}{63} = 1 + \\frac{1}{7} = \\frac{8}{7}$。\n\n**情况2：$|S|=2$ 的划分**\n共有 $\\binom{5}{2} = 10$ 种这样的划分。对于 $S = \\{v_i, v_j\\}$，我们有 $\\operatorname{assoc}(S,V) = d_i+d_j$ 和 $\\operatorname{cut}(S,\\bar{S}) = (d_i+d_j) - 2w_{ij}$。\n1.  $S = \\{v_1, v_2\\}$: $\\operatorname{assoc}(S,V)=17+19=36$, $\\operatorname{assoc}(\\bar{S},V)=72-36=36$。\n    $\\operatorname{cut}(S,\\bar{S}) = 36 - 2w_{12} = 36 - 2(8) = 20$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{20}{36} + \\frac{20}{36} = \\frac{40}{36} = \\frac{10}{9}$。\n\n2.  $S = \\{v_1, v_3\\}$: $\\operatorname{assoc}(S,V)=17+18=35$, $\\operatorname{assoc}(\\bar{S},V)=72-35=37$。\n    $\\operatorname{cut}(S,\\bar{S}) = 35 - 2w_{13} = 35 - 2(7) = 21$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{21}{35} + \\frac{21}{37} = \\frac{3}{5} + \\frac{21}{37} = \\frac{111+105}{185} = \\frac{216}{185}$。\n\n3.  $S = \\{v_1, v_4\\}$: $\\operatorname{assoc}(S,V)=17+9=26$, $\\operatorname{assoc}(\\bar{S},V)=72-26=46$。\n    $\\operatorname{cut}(S,\\bar{S}) = 26 - 2w_{14} = 26 - 2(1) = 24$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{24}{26} + \\frac{24}{46} = \\frac{12}{13} + \\frac{12}{23} = \\frac{12(23+13)}{13 \\times 23} = \\frac{12 \\times 36}{299} = \\frac{432}{299}$。\n\n4.  $S = \\{v_1, v_5\\}$: $\\operatorname{assoc}(S,V)=17+9=26$, $\\operatorname{assoc}(\\bar{S},V)=46$。\n    $\\operatorname{cut}(S,\\bar{S}) = 26 - 2w_{15} = 26 - 2(1) = 24$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{432}{299}$。\n\n5.  $S = \\{v_2, v_3\\}$: $\\operatorname{assoc}(S,V)=19+18=37$, $\\operatorname{assoc}(\\bar{S},V)=35$。\n    $\\operatorname{cut}(S,\\bar{S}) = 37 - 2w_{23} = 37 - 2(9) = 19$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{19}{37} + \\frac{19}{35} = \\frac{19(35+37)}{37 \\times 35} = \\frac{19 \\times 72}{1295} = \\frac{1368}{1295}$。\n\n6.  $S = \\{v_2, v_4\\}$: $\\operatorname{assoc}(S,V)=19+9=28$, $\\operatorname{assoc}(\\bar{S},V)=72-28=44$。\n    $\\operatorname{cut}(S,\\bar{S}) = 28 - 2w_{24} = 28 - 2(1) = 26$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{26}{28} + \\frac{26}{44} = \\frac{13}{14} + \\frac{13}{22} = \\frac{13(11+7)}{154} = \\frac{13 \\times 18}{154} = \\frac{234}{154} = \\frac{117}{77}$。\n\n7.  $S = \\{v_2, v_5\\}$: $\\operatorname{assoc}(S,V)=19+9=28$, $\\operatorname{assoc}(\\bar{S},V)=44$。\n    $\\operatorname{cut}(S,\\bar{S}) = 28 - 2w_{25} = 28 - 2(1) = 26$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{117}{77}$。\n\n8.  $S = \\{v_3, v_4\\}$: $\\operatorname{assoc}(S,V)=18+9=27$, $\\operatorname{assoc}(\\bar{S},V)=72-27=45$。\n    $\\operatorname{cut}(S,\\bar{S}) = 27 - 2w_{34} = 27 - 2(1) = 25$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{25}{27} + \\frac{25}{45} = \\frac{25}{27} + \\frac{5}{9} = \\frac{25+15}{27} = \\frac{40}{27}$。\n\n9.  $S = \\{v_3, v_5\\}$: $\\operatorname{assoc}(S,V)=18+9=27$, $\\operatorname{assoc}(\\bar{S},V)=45$。\n    $\\operatorname{cut}(S,\\bar{S}) = 27 - 2w_{35} = 27 - 2(1) = 25$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{40}{27}$。\n\n10. $S = \\{v_4, v_5\\}$: $\\operatorname{assoc}(S,V)=9+9=18$, $\\operatorname{assoc}(\\bar{S},V)=72-18=54$。\n    $\\operatorname{cut}(S,\\bar{S}) = 18 - 2w_{45} = 18 - 2(6) = 6$。\n    $\\operatorname{Ncut}(S, \\bar{S}) = \\frac{6}{18} + \\frac{6}{54} = \\frac{1}{3} + \\frac{1}{9} = \\frac{3}{9} + \\frac{1}{9} = \\frac{4}{9}$。\n\n**总结与结论**\n我们比较所有计算出的 Ncut 值以找到最小值。\n这些值是：\n$\\frac{72}{55} \\approx 1.309$, $\\frac{72}{53} \\approx 1.358$, $\\frac{4}{3} \\approx 1.333$, $\\frac{8}{7} \\approx 1.143$, $\\frac{10}{9} \\approx 1.111$, $\\frac{216}{185} \\approx 1.168$, $\\frac{432}{299} \\approx 1.445$, $\\frac{1368}{1295} \\approx 1.056$, $\\frac{117}{77} \\approx 1.519$, $\\frac{40}{27} \\approx 1.481$, $\\frac{4}{9} \\approx 0.444$。\n最小值为 $\\frac{4}{9}$，它出现在二分 $(\\{v_4, v_5\\}, \\{v_1, v_2, v_3\\})$ 的情况下。这个划分将图分成一个强连通分量 $\\{v_1, v_2, v_3\\}$ 和另一个强连通分量 $\\{v_4, v_5\\}$，它们之间的连接很弱。这正是标准化切割旨在识别的行为。\n\n最小的标准化切割值为 $\\frac{4}{9}$。",
            "answer": "$$\n\\boxed{\\frac{4}{9}}\n$$"
        },
        {
            "introduction": "除了将图分割成几个部分，我们还常常对图中自然形成的“社区”结构感兴趣，这些社区是内部连接密集而外部连接稀疏的节点群。模块度（Modularity）是衡量这种社区结构强度的一个关键指标。本次练习模拟了经典的Louvain社区发现算法中的一个核心步骤：评估移动单个节点到邻近社区所带来的模块度增益。通过精确计算这一变化，您将深入理解模块度优化是如何驱动社区发现过程的。",
            "id": "4542519",
            "problem": "在基于图的放射组学中，一个肿瘤的感兴趣区域（ROI）被分割成多个超体素，这些超体素被建模为一个加权无向图的节点。边权重编码了超体素之间的空间邻接性和强度相似性的组合。考虑这样一个图，它有 $5$ 个节点 $\\{v_{1},v_{2},v_{3},v_{4},v_{5}\\}$ 和以下非零的对称边权重（所有未列出的边的权重为 $0$，且没有自环）：$w_{12}=2$, $w_{13}=1.5$, $w_{23}=1$, $w_{14}=0.2$, $w_{24}=0.1$, $w_{34}=0.8$, $w_{35}=0.7$, $w_{45}=1.2$。在先前一次类Louvain算法的迭代中获得的初始社区分配为 $C_{A}=\\{v_{1},v_{2},v_{3}\\}$ 和 $C_{B}=\\{v_{4},v_{5}\\}$。您需要评估一个候选移动，该移动将节点 $v_{3}$ 从社区 $C_{A}$ 转移到社区 $C_{B}$。\n\n使用加权无向图的模块度定义，计算将节点 $v_{3}$ 从 $C_{A}$ 移动到 $C_{B}$ 所带来的模块度增益 $\\Delta Q=Q_{\\text{after}}-Q_{\\text{before}}$。然后，根据 $\\Delta Q$ 的符号，决定在一个模块度最大化的更新规则中是否应该接受这个移动。\n\n仅报告 $\\Delta Q$ 的值作为您的最终答案，四舍五入到四位有效数字。不需要单位。",
            "solution": "目标是计算将节点 $v_{3}$ 从社区 $C_{A}$ 移动到社区 $C_{B}$ 所导致的模块度变化 $\\Delta Q$。\n\n对于一个加权无向图的划分，模块度 $Q$ 定义为：\n$$Q = \\sum_{c \\in \\mathcal{C}} \\left[ \\frac{L_c}{m} - \\left( \\frac{D_c}{2m} \\right)^2 \\right]$$\n其中 $\\mathcal{C}$ 是社区的集合，$L_c$ 是社区 $c$ 内部所有边的权重之和，$D_c$ 是社区 $c$ 中所有节点的度之和，$m$ 是图中所有边的总权重。节点 $i$ 的度 $k_i$ 是所有与其相连的边的权重之和。\n\n当一个节点 $i$ 从社区 $A$ 移动到社区 $B$ 时，模块度的变化 $\\Delta Q$ 可以通过考虑社区 $A$ 和 $B$ 的相关项的变化来计算。设移动后的社区为 $A' = A \\setminus \\{i\\}$ 和 $B' = B \\cup \\{i\\}$。模块度的变化 $\\Delta Q = Q_{\\text{after}} - Q_{\\text{before}}$ 为：\n$$\\Delta Q = (Q_{A'} + Q_{B'}) - (Q_A + Q_B) = (Q_{A'} - Q_A) + (Q_{B'} - Q_B)$$\n社区 $A$ 的变化为：\n$$\\Delta Q_A = \\left[ \\frac{L_A - k_{i,A}}{m} - \\left( \\frac{D_A - k_i}{2m} \\right)^2 \\right] - \\left[ \\frac{L_A}{m} - \\left( \\frac{D_A}{2m} \\right)^2 \\right] = -\\frac{k_{i,A}}{m} + \\frac{2D_A k_i - k_i^2}{4m^2}$$\n其中 $k_{i,A}$ 是从节点 $i$ 到社区 $A$ 中其他节点的边的权重之和。\n社区 $B$ 的变化为：\n$$\\Delta Q_B = \\left[ \\frac{L_B + k_{i,B}}{m} - \\left( \\frac{D_B + k_i}{2m} \\right)^2 \\right] - \\left[ \\frac{L_B}{m} - \\left( \\frac{D_B}{2m} \\right)^2 \\right] = \\frac{k_{i,B}}{m} - \\frac{2D_B k_i + k_i^2}{4m^2}$$\n其中 $k_{i,B}$ 是从节点 $i$ 到社区 $B$ 中节点的边的权重之和。\n将这些变化相加得到总的模块度增益：\n$$\\Delta Q = \\frac{k_{i,B} - k_{i,A}}{m} + \\frac{k_i(D_A - D_B) - k_i^2}{2m^2}$$\n我们现在将根据所提供的数据计算此公式中的各项。\n\n1.  **总边权重 ($m$)**：\n    所有独立边权重的总和是：\n    $m = w_{12} + w_{13} + w_{23} + w_{14} + w_{24} + w_{34} + w_{35} + w_{45}$\n    $m = 2 + 1.5 + 1 + 0.2 + 0.1 + 0.8 + 0.7 + 1.2 = 7.5$\n    因此，$2m = 15$ 且 $2m^2 = 2 \\times (7.5)^2 = 112.5$。\n\n2.  **节点度 ($k_i$)**：\n    $k_1 = w_{12} + w_{13} + w_{14} = 2 + 1.5 + 0.2 = 3.7$\n    $k_2 = w_{21} + w_{23} + w_{24} = 2 + 1 + 0.1 = 3.1$\n    $k_3 = w_{31} + w_{32} + w_{34} + w_{35} = 1.5 + 1 + 0.8 + 0.7 = 4.0$\n    $k_4 = w_{41} + w_{42} + w_{43} + w_{45} = 0.2 + 0.1 + 0.8 + 1.2 = 2.3$\n    $k_5 = w_{53} + w_{54} = 0.7 + 1.2 = 1.9$\n    被移动的节点是 $i=v_3$，所以它的度是 $k_3 = 4.0$。\n\n3.  **社区度 ($D_c$)**：\n    初始社区为 $C_A = \\{v_1, v_2, v_3\\}$ 和 $C_B = \\{v_4, v_5\\}$。\n    社区 $C_A$ 的度之和为：\n    $D_A = k_1 + k_2 + k_3 = 3.7 + 3.1 + 4.0 = 10.8$\n    社区 $C_B$ 的度之和为：\n    $D_B = k_4 + k_5 = 2.3 + 1.9 = 4.2$\n\n4.  **节点 $v_3$ 与社区的连接权重**：\n    从 $v_3$ 到其原始社区 $C_A$ 中其他节点的边的权重之和为：\n    $k_{3,C_A} = w_{31} + w_{32} = 1.5 + 1 = 2.5$\n    从 $v_3$ 到目标社区 $C_B$ 中节点的边的权重之和为：\n    $k_{3,C_B} = w_{34} + w_{35} = 0.8 + 0.7 = 1.5$\n\n5.  **$\\Delta Q$的计算**：\n    我们将计算出的值代入 $\\Delta Q$ 的公式中：\n    $$\\Delta Q = \\frac{k_{3,C_B} - k_{3,C_A}}{m} + \\frac{k_3(D_A - D_B) - k_3^2}{2m^2}$$\n    $$\\Delta Q = \\frac{1.5 - 2.5}{7.5} + \\frac{4.0(10.8 - 4.2) - (4.0)^2}{112.5}$$\n    $$\\Delta Q = \\frac{-1.0}{7.5} + \\frac{4.0(6.6) - 16}{112.5}$$\n    $$\\Delta Q = \\frac{-1.0}{7.5} + \\frac{26.4 - 16}{112.5}$$\n    $$\\Delta Q = \\frac{-1.0}{7.5} + \\frac{10.4}{112.5}$$\n    为了合并这些项，我们使用 $112.5$ 作为公分母：\n    $$\\Delta Q = \\frac{-1.0 \\times 15}{7.5 \\times 15} + \\frac{10.4}{112.5} = \\frac{-15}{112.5} + \\frac{10.4}{112.5}$$\n    $$\\Delta Q = \\frac{-15 + 10.4}{112.5} = \\frac{-4.6}{112.5}$$\n    进行最后的除法运算：\n    $$\\Delta Q \\approx -0.040888...$$\n    问题要求四舍五入到四位有效数字。第一位有效数字是 $4$，其后是 $0$、$8$、$8$。下一位数字是 $8$，它 $\\ge 5$，所以我们将最后一位有效数字向上取整。\n    $$\\Delta Q \\approx -0.04089$$\n\n像Louvain方法这样的模块度最大化算法，仅当移动导致正的模块度增益（$\\Delta Q > 0$）时才接受该移动。由于 $\\Delta Q$ 是负数，因此将节点 $v_3$ 从 $C_A$ 移动到 $C_B$ 的这个特定移动会降低图划分的整体模块度，应该被拒绝。",
            "answer": "$$\\boxed{-0.04089}$$"
        }
    ]
}