{
    "hands_on_practices": [
        {
            "introduction": "理论知识是基础，但真正的理解源于实践。本节将指导你完成一系列动手练习，以巩固你对组内相关系数（ICC）的理解。我们将从一个核心计算开始：在典型的测试-再测试（test-retest）研究中，如何从方差分析（ANOVA）的结果中计算最基本的ICC形式。这个练习将为你提供量化影像组学特征稳定性的基本技能。",
            "id": "4547420",
            "problem": "一项影像组学重测信度研究评估了一个标量影像特征在相隔$48$小时的两次测试中的稳定性。研究包含$n=25$名受试者，每名受试者被扫描两次。单因素随机效应方差分析将变异分解为被试间分量和被试内（残差）分量，并得出以下均方：被试间均方$MS_{B}=3.6$和被试内均方$MS_{W}=0.9$。在用于单一测量信度的单因素随机效应框架下，使用所提供的均方以及每名受试者有$k=2$次重复测量这一事实，计算表示为$ICC(1,1)$的单一测量组内相关系数（ICC）。然后，根据如果$ICC \\geq 0.75$则认为特征是稳定的这一标准，指出该特征是否稳定。将ICC表示为一个无单位的纯数。如果选择四舍五入，请保留四位有效数字。",
            "solution": "问题要求计算单一测量组内相关系数（表示为$ICC(1,1)$），并根据给定的标准评估特征的稳定性。背景是一项使用单因素随机效应模型分析的影像组学重测信度研究。\n\n对于测量值$x_{ij}$（受试者$i$的第$j$次测量），单因素随机效应模型由$x_{ij} = \\mu + \\alpha_i + \\epsilon_{ij}$给出，其中$\\mu$是总平均值，$\\alpha_i$是受试者$i$的随机效应，其方差为$\\sigma^2_B$（被试间方差），$\\epsilon_{ij}$是随机误差项，其方差为$\\sigma^2_W$（被试内方差）。\n\n组内相关系数定义为总方差中可归因于被试间方差的比例。对于单次测量，总方差为$\\sigma^2_B + \\sigma^2_W$。因此，单一测量ICC为：\n$$ICC(1,1) = \\frac{\\sigma^2_B}{\\sigma^2_B + \\sigma^2_W}$$\n在方差分析（ANOVA）的框架中，方差分量$\\sigma^2_B$和$\\sigma^2_W$可以从均方中估计出来。被试间均方（$MS_B$）和被试内均方（$MS_W$）的期望值与方差分量的关系如下：\n$$E(MS_W) = \\sigma^2_W$$\n$$E(MS_B) = \\sigma^2_W + k \\sigma^2_B$$\n其中$k$是每个受试者的重复测量次数。\n\n使用观测到的均方作为其期望值的估计，我们可以将估计的方差分量表示为：\n$$\\hat{\\sigma}^2_W = MS_W$$\n$$\\hat{\\sigma}^2_B = \\frac{MS_B - MS_W}{k}$$\n将这些估计量代入$ICC(1,1)$的公式，得到一个用均方表示的表达式：\n$$ICC(1,1) = \\frac{\\frac{MS_B - MS_W}{k}}{\\left(\\frac{MS_B - MS_W}{k}\\right) + MS_W}$$\n为了简化这个表达式，我们将分子和分母同乘以$k$：\n$$ICC(1,1) = \\frac{MS_B - MS_W}{(MS_B - MS_W) + k \\cdot MS_W}$$\n$$ICC(1,1) = \\frac{MS_B - MS_W}{MS_B + (k-1)MS_W}$$\n这是$ICC(1,1)$的标准计算公式。\n\n问题提供了以下数值：\n- 被试间均方：$MS_B = 3.6$\n- 被试内均方：$MS_W = 0.9$\n- 每名受试者的重复测量次数：$k=2$\n- 受试者数量：$n=25$（请注意，此计算不需要$n$，因为它的影响已经包含在均方值中）。\n\n我们将给定值代入$ICC(1,1)$的公式中：\n$$ICC(1,1) = \\frac{3.6 - 0.9}{3.6 + (2-1) \\times 0.9}$$\n$$ICC(1,1) = \\frac{2.7}{3.6 + (1) \\times 0.9}$$\n$$ICC(1,1) = \\frac{2.7}{3.6 + 0.9}$$\n$$ICC(1,1) = \\frac{2.7}{4.5}$$\n计算得出一个精确值：\n$$ICC(1,1) = 0.6$$\n问题提供了稳定性的标准：如果$ICC \\geq 0.75$，则认为该特征是稳定的。我们计算出的值为$ICC(1,1) = 0.6$。\n将计算值与标准进行比较：\n$$0.6  0.75$$\n因此，根据所提供的数据和标准，该影像特征被认为是**不**稳定的。最终要求的答案是ICC的数值。",
            "answer": "$$\\boxed{0.6}$$"
        },
        {
            "introduction": "在评估特征稳定性时，理解我们具体衡量的是什么至关重要。本练习将探讨观察者间可靠性（inter-observer reliability）这一常见场景，并揭示两种关键ICC形式之间的差异：一致性（consistency）与绝对一致性（absolute agreement）。通过这个练习，你将学会根据研究目的选择合适的ICC类型，并理解为何观察者之间的系统性偏差会影响特征的绝对一致性，但可能不影响其一致性。",
            "id": "4547472",
            "problem": "一个影像组学团队评估了单个标量影像组学特征在三位人类观察者之间的稳定性，这些观察者独立地分割了同一组图像。对于 $n$ 个受试者中的每一位，该特征都是从每位观察者的分割结果中计算出来的。该团队希望使用组内相关系数 (ICC) 来量化信度，该系数有两种反映不同科学意图的定义：绝对一致性 (absolute agreement) 与一致性 (consistency)。\n\n该研究是均衡设计，有 $n=6$ 名受试者和 $k=3$ 名观察者（评分者）。设 $x_{ij}$ 表示评分者 $j$ 为受试者 $i$ 测量的特征值，其中 $i \\in \\{1,\\dots,6\\}$ 且 $j \\in \\{1,2,3\\}$。观测到的数据矩阵为\n$$\nX \\;=\\; \\begin{pmatrix}\n10  13  8 \\\\\n12  15  10 \\\\\n14  17  12 \\\\\n17  20  15 \\\\\n21  24  19 \\\\\n23  26  21\n\\end{pmatrix},\n$$\n其中行索引受试者，列索引评分者。实验室有独立的理由预期评分者之间存在系统性偏差（例如，某位评分者倾向于勾画稍大的感兴趣区域），这可能会影响绝对一致性，但不会影响一致性。\n\n从受试者和评分者的均衡双因素设计的双向方差分析分解出发，将受试者效应视为随机效应，而在计算绝对一致性时将评分者效应视为随机效应，在计算一致性时则视为固定效应。使用此分解的标准均方分量，推导以均方表示的单一测量绝对一致性系数 $ICC(2,1)$ 和单一测量一致性系数 $ICC(3,1)$ 的表达式。根据数据计算 $ICC(2,1)$ 和 $ICC(3,1)$，然后在影像组学特征跨观察者稳定性的背景下，对这两个值之间的任何差异提供一个简明的解释。\n\n将差值 $ICC(3,1) - ICC(2,1)$ 作为最终数值答案报告，四舍五入到四位有效数字。ICC 是无量纲的，请勿包含单位。",
            "solution": "解题过程首先进行双向方差分析 (two-way ANOVA)，将总方差分解为可归因于受试者（行）、评分者（列）和残差（交互作用）的分量。这些由其均方 ($MS$) 表示的方差分量，随后被用来计算两种形式的 ICC。\n\n设 $x_{ij}$ 为受试者 $i \\in \\{1, \\dots, n\\}$ 和评分者 $j \\in \\{1, \\dots, k\\}$ 的特征值。研究参数为 $n=6$ 名受试者和 $k=3$ 名评分者。\n\n首先，我们从数据矩阵 $X$ 中计算必要的汇总统计量。\n总和为 $\\sum_{i=1}^n \\sum_{j=1}^k x_{ij} = 297$。\n观测总数为 $N=nk = 6 \\times 3 = 18$。\n总均值为 $\\bar{x}_{..} = \\frac{297}{18} = 16.5$。\n\n所有观测值的平方和为 $\\sum_{i=1}^n \\sum_{j=1}^k x_{ij}^2 = 5369$。\n\n总平方和 ($SS_{TOT}$) 为：\n$$ SS_{TOT} = \\sum_{i=1}^n \\sum_{j=1}^k (x_{ij} - \\bar{x}_{..})^2 = \\sum_{i=1}^n \\sum_{j=1}^k x_{ij}^2 - \\frac{(\\sum \\sum x_{ij})^2}{nk} $$\n$$ SS_{TOT} = 5369 - \\frac{297^2}{18} = 5369 - \\frac{88209}{18} = 5369 - 4900.5 = 468.5 $$\n总自由度为 $df_{TOT} = nk - 1 = 18-1=17$。\n\n接下来，我们计算受试者间平方和（$SS_R$，行间平方和）。受试者总和分别为 $T_{1.}=31$，$T_{2.}=37$，$T_{3.}=43$，$T_{4.}=52$，$T_{5.}=64$，$T_{6.}=70$。\n$$ SS_R = \\frac{1}{k} \\sum_{i=1}^n (\\sum_{j=1}^k x_{ij})^2 - \\frac{(\\sum \\sum x_{ij})^2}{nk} = \\frac{1}{3}(31^2+37^2+43^2+52^2+64^2+70^2) - 4900.5 $$\n$$ SS_R = \\frac{1}{3}(961+1369+1849+2704+4096+4900) - 4900.5 = \\frac{15879}{3} - 4900.5 = 5293 - 4900.5 = 392.5 $$\n受试者的自由度为 $df_R = n - 1 = 6-1=5$。\n\n接下来，我们计算评分者间平方和（$SS_C$，列间平方和）。评分者总和分别为 $T_{.1}=97$，$T_{.2}=115$，$T_{.3}=85$。\n$$ SS_C = \\frac{1}{n} \\sum_{j=1}^k (\\sum_{i=1}^n x_{ij})^2 - \\frac{(\\sum \\sum x_{ij})^2}{nk} = \\frac{1}{6}(97^2+115^2+85^2) - 4900.5 $$\n$$ SS_C = \\frac{1}{6}(9409+13225+7225) - 4900.5 = \\frac{29859}{6} - 4900.5 = 4976.5 - 4900.5 = 76 $$\n评分者的自由度为 $df_C = k - 1 = 3-1=2$。\n\n最后，通过减法求得残差（误差）平方和（$SS_E$）：\n$$ SS_E = SS_{TOT} - SS_R - SS_C = 468.5 - 392.5 - 76 = 0 $$\n误差的自由度为 $df_E = (n-1)(k-1) = 5 \\times 2 = 10$。\n\n现在，我们计算均方 ($MS$)：\n受试者均方：$MS_R = \\frac{SS_R}{df_R} = \\frac{392.5}{5} = 78.5$。\n评分者均方：$MS_C = \\frac{SS_C}{df_C} = \\frac{76}{2} = 38$。\n误差均方：$MS_E = \\frac{SS_E}{df_E} = \\frac{0}{10} = 0$。\n\n有了这些值，我们就可以计算 ICC。\n\n**$ICC(2,1)$：单一测量，绝对一致性**\n这种形式使用双向随机效应模型，其中受试者和评分者都被视为来自更大总体的随机样本。它量化了单个评分的信度，并对评分者之间的系统性偏差进行惩罚。公式为：\n$$ ICC(2,1) = \\frac{MS_R - MS_E}{MS_R + (k-1)MS_E + \\frac{k}{n}(MS_C - MS_E)} $$\n代入我们计算出的值：\n$$ ICC(2,1) = \\frac{78.5 - 0}{78.5 + (3-1)(0) + \\frac{3}{6}(38 - 0)} = \\frac{78.5}{78.5 + 0 + 0.5(38)} = \\frac{78.5}{78.5 + 19} = \\frac{78.5}{97.5} $$\n$$ ICC(2,1) \\approx 0.805128... $$\n\n**$ICC(3,1)$：单一测量，一致性**\n这种形式使用双向混合效应模型，其中受试者是随机效应，而特定的评分者是固定效应。它量化了评分者对受试者排序的一致性程度，忽略了他们平均评分中的系统性差异。公式为：\n$$ ICC(3,1) = \\frac{MS_R - MS_E}{MS_R + (k-1)MS_E} $$\n代入我们计算出的值：\n$$ ICC(3,1) = \\frac{78.5 - 0}{78.5 + (2)(0)} = \\frac{78.5}{78.5} = 1 $$\n\n**对差异的解释**\n$ICC(3,1) = 1$ 的值表明三位评分者之间存在完美的一致性。这是误差均方（$MS_E$）为 $0$ 的直接结果。$MS_E$ 为 $0$ 意味着没有受试者-评分者交互作用；对于所有受试者，从一个评分者换到另一个评分者的影响是完全恒定的。例如，评分者2的测量值总是恰好比评分者1的高 $3$ 个单位。因此，受试者特征值的相对排序和间距在所有评分者中都是相同的。\n\n$ICC(2,1) \\approx 0.8051$ 的值小于 $1$，因为它衡量的是绝对一致性。这种形式的 ICC 会因任何非归因于受试者的方差来源而受到惩罚，包括评分者之间的系统性偏差。评分者均方（$MS_C = 38$）为非零，表明评分者们对其测量值有不同的均值。从绝对一致性的角度来看，评分者之间的这种系统性偏移构成了一个测量误差源，从而将 ICC 值降低到 $1$ 以下。在影像组学的背景下，这意味着虽然该特征对于受试者排序而言是完全稳定的，但由于评分者特有的倾向，其绝对值并不可互换，如果使用固定的决策阈值，这可能会带来问题。\n\n**最终计算**\n题目要求计算差值 $ICC(3,1) - ICC(2,1)$，并四舍五入到四位有效数字。\n$$ \\text{差值} = 1 - \\frac{78.5}{97.5} = 1 - \\frac{157}{195} = \\frac{195-157}{195} = \\frac{38}{195} $$\n$$ \\text{差值} \\approx 0.19487179... $$\n四舍五入到四位有效数字得到 $0.1949$。",
            "answer": "$$\\boxed{0.1949}$$"
        },
        {
            "introduction": "计算ICC值本身并不是最终目的，理解其对我们最终研究目标——构建准确的预测模型——的影响才是关键。本练习将理论与实践相结合，揭示特征的不稳定性（即较低的ICC值）如何直接削弱其在下游回归模型中的预测能力。你将通过推导和计算，亲身体验测量误差如何导致回归系数的“衰减”（attenuation），从而更深刻地理解为何追求高稳定性的特征对于建立可靠的影像组学模型至关重要。",
            "id": "4547452",
            "problem": "一项放射组学研究评估了在一个标量影像特征上的重测稳定性。该特征是在 $n$ 名受试者上测量的，每名受试者在相同的采集和重建条件下，在 $48$ 小时内被扫描两次。该特征通过一个单因素随机效应重复测量框架进行建模，其中受试者 $i$ 在扫描 $j$ 上的观测值为 $X_{ij}^{\\ast} = X_{i} + U_{ij}$，其中 $X_{i}$ 是受试者特异性的真实特征值，$U_{ij}$ 是一个加性的、均值为零的、与 $X_{i}$ 独立且在重复测量间独立的受试者内测量误差。重测分析得出的组内相关系数 (ICC) 为 $0.55$。该值是在标准假设下计算的，即组间方差为 $ \\operatorname{Var}(X_{i})$，组内方差为 $\\operatorname{Var}(U_{ij})$，因此 ICC 等于组间方差与总方差的比值。\n\n假设一个下游的连续结局 $Y$ 是根据线性模型 $Y = \\alpha + \\beta X + \\varepsilon$ 生成的，其中 $X$ 表示受试者的真实特征值，$\\alpha$ 和 $\\beta$ 是常数，$\\varepsilon$ 是一个与 $X$ 和测量误差过程都独立的零均值误差。在实践中，使用普通最小二乘法拟合了 $Y$ 对观测到的、含误差的特征 $X^{\\ast}$ 的回归。假设上述经典的加性误差结构成立，并且 $X$、$U$ 和 $\\varepsilon$ 相互独立。\n\n仅从 ICC 在单因素随机效应重复测量模型中作为组间方差与总方差之比的定义出发，并从普通最小二乘斜率作为协方差与方差之比的定义表达式出发，推导连接拟合斜率与真实斜率的预期衰减因子。然后，在给定 $\\beta = 1.20$ 的情况下，计算在这些假设下将 $Y$ 对 $X^{\\ast}$ 进行回归时预期的拟合斜率。将您的最终数值答案四舍五入到四位有效数字。不需要单位。",
            "solution": "用户需要解决一个问题，该问题涉及在变量含误差模型中推导真实回归斜率与观测回归斜率之间的关系，然后利用此关系计算预期的拟合斜率。这种联系是通过组内相关系数 (ICC) 建立的。\n\n首先，我们将问题陈述中定义的量形式化。受试者 $i$ 在扫描 $j$ 上的观测特征值由单因素随机效应模型给出：\n$$ X_{ij}^{\\ast} = X_{i} + U_{ij} $$\n其中 $X_i$ 是真实的受试者特异性特征值，$U_{ij}$ 是随机测量误差。给定条件为 $E[U_{ij}] = 0$，且 $X_i$ 和 $U_{ij}$ 独立。\n\n组间方差定义为 $\\sigma_X^2 = \\operatorname{Var}(X_i)$。\n组内方差定义为 $\\sigma_U^2 = \\operatorname{Var}(U_{ij})$。\n\n问题陈述 ICC 是组间方差与总方差的比值。单次观测 $X_{ij}^{\\ast}$ 的总方差为：\n$$ \\operatorname{Var}(X_{ij}^{\\ast}) = \\operatorname{Var}(X_i + U_{ij}) $$\n由于 $X_i$ 和 $U_{ij}$ 的独立性，这变为：\n$$ \\operatorname{Var}(X_{ij}^{\\ast}) = \\operatorname{Var}(X_i) + \\operatorname{Var}(U_{ij}) = \\sigma_X^2 + \\sigma_U^2 $$\n因此，ICC 由下式给出：\n$$ \\text{ICC} = \\frac{\\sigma_X^2}{\\sigma_X^2 + \\sigma_U^2} $$\n\n接下来，我们考虑连续结局 $Y$ 的线性回归模型。真实关系是：\n$$ Y = \\alpha + \\beta X + \\varepsilon $$\n其中 $X$ 是真实特征值，$\\beta$ 是真实斜率，$\\varepsilon$ 是一个零均值误差项。给定条件为 $X$、$U$ 和 $\\varepsilon$ 相互独立。\n\n在实践中，回归是使用含误差的测量值 $X^{\\ast}$ 而不是真实值 $X$ 来执行的。对于回归分析，我们考虑每个受试者进行单次测量，因此我们可以将符号简化为 $X^{\\ast} = X + U$。在 $Y$ 对 $X^{\\ast}$ 的简单线性回归中，斜率的 OLS 估计量是一个随机变量。问题要求的是*预期*的拟合斜率，在测量误差模型的背景下，这指的是 OLS 估计量收敛到的总体参数。这个理论斜率，我们记为 $\\beta^{\\ast}$，根据问题陈述中的规定，由 $Y$ 和 $X^{\\ast}$ 的协方差与 $X^{\\ast}$ 的方差之比给出。\n$$ \\beta^{\\ast} = \\frac{\\operatorname{Cov}(Y, X^{\\ast})}{\\operatorname{Var}(X^{\\ast})} $$\n\n我们现在推导分子和分母的表达式。\n\n分母是观测特征 $X^{\\ast}$ 的方差：\n$$ \\operatorname{Var}(X^{\\ast}) = \\operatorname{Var}(X + U) $$\n由于 $X$ 和 $U$ 是独立的，我们有：\n$$ \\operatorname{Var}(X^{\\ast}) = \\operatorname{Var}(X) + \\operatorname{Var}(U) = \\sigma_X^2 + \\sigma_U^2 $$\n\n分子是结局 $Y$ 和观测特征 $X^{\\ast}$ 的协方差：\n$$ \\operatorname{Cov}(Y, X^{\\ast}) = \\operatorname{Cov}(\\alpha + \\beta X + \\varepsilon, X + U) $$\n使用协方差的双线性性质：\n$$ \\operatorname{Cov}(Y, X^{\\ast}) = \\operatorname{Cov}(\\alpha, X+U) + \\operatorname{Cov}(\\beta X, X+U) + \\operatorname{Cov}(\\varepsilon, X+U) $$\n由于 $\\alpha$ 是一个常数，$\\operatorname{Cov}(\\alpha, X+U) = 0$。\n涉及 $\\beta X$ 的项可以展开：\n$$ \\operatorname{Cov}(\\beta X, X+U) = \\operatorname{Cov}(\\beta X, X) + \\operatorname{Cov}(\\beta X, U) = \\beta \\operatorname{Cov}(X, X) + \\beta \\operatorname{Cov}(X, U) $$\n由于 $\\operatorname{Cov}(X,X) = \\operatorname{Var}(X) = \\sigma_X^2$ 且 $X$ 和 $U$ 是独立的，所以 $\\operatorname{Cov}(X, U) = 0$。因此，该项简化为 $\\beta \\sigma_X^2$。\n涉及 $\\varepsilon$ 的项可以展开：\n$$ \\operatorname{Cov}(\\varepsilon, X+U) = \\operatorname{Cov}(\\varepsilon, X) + \\operatorname{Cov}(\\varepsilon, U) $$\n由于 $\\varepsilon$ 与 $X$ 和 $U$ 都独立，所以两个协方差项都为 $0$。\n综合这些结果，分子是：\n$$ \\operatorname{Cov}(Y, X^{\\ast}) = \\beta \\sigma_X^2 $$\n\n现在我们可以写出预期拟合斜率 $\\beta^{\\ast}$ 的表达式：\n$$ \\beta^{\\ast} = \\frac{\\beta \\sigma_X^2}{\\sigma_X^2 + \\sigma_U^2} $$\n\n任务的第一部分是推导预期衰减因子，即预期拟合斜率 $\\beta^{\\ast}$ 与真实斜率 $\\beta$ 的比值。\n$$ \\text{Attenuation Factor} = \\frac{\\beta^{\\ast}}{\\beta} = \\frac{1}{\\beta} \\left( \\frac{\\beta \\sigma_X^2}{\\sigma_X^2 + \\sigma_U^2} \\right) = \\frac{\\sigma_X^2}{\\sigma_X^2 + \\sigma_U^2} $$\n将此表达式与 ICC 的定义进行比较，我们发现衰减因子等于 ICC。\n$$ \\text{Attenuation Factor} = \\text{ICC} $$\n推导到此完成。这个结果是变量含误差文献中的一个经典发现，表明预测变量中的测量误差会使 OLS 斜率估计向零偏倚。这种偏倚的大小由测量的可靠性决定，而 ICC 正是衡量这种可靠性的指标。\n\n任务的第二部分是根据给定的特定值 $\\beta = 1.20$ 和 $\\text{ICC} = 0.55$ 计算预期的拟合斜率 $\\beta^{\\ast}$。\n根据我们的推导，我们有以下关系：\n$$ \\beta^{\\ast} = \\beta \\times (\\text{Attenuation Factor}) = \\beta \\times \\text{ICC} $$\n代入给定值：\n$$ \\beta^{\\ast} = 1.20 \\times 0.55 $$\n$$ \\beta^{\\ast} = 0.66 $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\beta^{\\ast} = 0.6600 $$",
            "answer": "$$\n\\boxed{0.6600}\n$$"
        }
    ]
}