{
    "hands_on_practices": [
        {
            "introduction": "放射组学的第一步是将医学图像转化为定量数据。纹理特征，例如从灰度游程矩阵 (Gray-Level Run Length Matrix, GLRLM) 中提取的特征，能够捕捉肉眼无法感知的体素强度模式。本练习 () 提供了一个亲手从零开始计算这些特征的机会，揭示了“纹理”等抽象概念如何被转化为可供分析的具体数字。",
            "id": "4557656",
            "problem": "在将图像衍生的纹理与信使核糖核酸 (mRNA) 表达联系起来的放射基因组学工作流程中，从磁共振成像 (MRI) 扫描中提取一个三维 (3D) 感兴趣区域 (ROI)，并将其强度量化为离散的灰度级。考虑以下合成的 3D ROI，其中每个体素都属于该 ROI。体素坐标由 $(x,y,z)$ 索引，其中 $x \\in \\{1,2,3\\}$，$y \\in \\{1,2\\}$，$z \\in \\{1,2\\}$。强度已经被量化为灰度级 $\\{1,2,3\\}$。\n\n切片 $z=1$：\n- 行 $y=1$：$[1\\ 1\\ 2]$ (对于 $x=1,2,3$)\n- 行 $y=2$：$[2\\ 2\\ 2]$ (对于 $x=1,2,3$)\n\n切片 $z=2$：\n- 行 $y=1$：$[3\\ 1\\ 1]$ (对于 $x=1,2,3$)\n- 行 $y=2$：$[1\\ 3\\ 3]$ (对于 $x=1,2,3$)\n\n使用灰度游程矩阵 (GLRLM) 的定义，其中一个游程是在指定方向上具有相同灰度级的连续、共线体素的最大序列，仅在 $+\\hat{x}$ 方向上为该 ROI 构建 GLRLM（即，在每个固定的 $(y,z)$ 直线内沿 $x$ 递增方向追踪游程；无环绕或跨线延续）。然后，从此 GLRLM 中计算短游程强调 (SRE) 和长游程强调 (LRE) 特征，其中 SRE 对较短的游程赋予更高的权重，LRE 对较长的游程赋予更高的权重，两者都通过总游程数进行归一化。\n\n在代入数字之前，请用符号形式说明您推导出的任何量，并基于游程长度计数和从 GLRLM 构建特征的核心定义进行推导。将最终的 SRE 和 LRE 表示为无单位的实数，四舍五入到四位有效数字。按 $\\text{SRE}$、$\\text{LRE}$ 的顺序提供您的最终答案作为两个值。",
            "solution": "该问题陈述经评估有效。它在放射组学领域有科学依据，定义明确，提供了所有必要的数据和定义，且其表述是客观的。我们可以继续进行求解。\n\n该问题要求从一个灰度游程矩阵 (GLRLM) 中计算两个纹理特征：短游程强调 (SRE) 和长游程强调 (LRE)。第一步是为给定的三维感兴趣区域 (ROI) 在指定方向上构建 GLRLM。\n\n该 ROI 由坐标为 $x \\in \\{1,2,3\\}$、$y \\in \\{1,2\\}$ 和 $z \\in \\{1,2\\}$ 的体素强度 $I(x,y,z)$ 定义。灰度级为 $G \\in \\{1,2,3\\}$。提供的数据如下：\n切片 $z=1$：\n$I(x, y=1, z=1) = [1, 1, 2]$\n$I(x, y=2, z=1) = [2, 2, 2]$\n切片 $z=2$：\n$I(x, y=1, z=2) = [3, 1, 1]$\n$I(x, y=2, z=2) = [1, 3, 3]$\n\n一个游程是具有相同灰度级的连续、共线体素的最大序列。我们被指示仅在 $+\\hat{x}$ 方向上寻找游程。这涉及到分析每一条 $y$ 和 $z$ 固定而 $x$ 变化的体素线。在此 ROI 中，有 $2 \\times 2 = 4$ 条这样的线。\n\n1.  **第1行：$(y=1, z=1)$**\n    强度序列为 $[1, 1, 2]$。我们识别出两个游程：\n    - 一个灰度级为 $g=1$、长度为 $l=2$ 的游程。\n    - 一个灰度级为 $g=2$、长度为 $l=1$ 的游程。\n\n2.  **第2行：$(y=2, z=1)$**\n    强度序列为 $[2, 2, 2]$。我们识别出一个游程：\n    - 一个灰度级为 $g=2$、长度为 $l=3$ 的游程。\n\n3.  **第3行：$(y=1, z=2)$**\n    强度序列为 $[3, 1, 1]$。我们识别出两个游程：\n    - 一个灰度级为 $g=3$、长度为 $l=1$ 的游程。\n    - 一个灰度级为 $g=1$、长度为 $l=2$ 的游程。\n\n4.  **第4行：$(y=2, z=2)$**\n    强度序列为 $[1, 3, 3]$。我们识别出两个游程：\n    - 一个灰度级为 $g=1$、长度为 $l=1$ 的游程。\n    - 一个灰度级为 $g=3$、长度为 $l=2$ 的游程。\n\n接下来，我们构建 GLRLM，用矩阵 $P$ 表示。条目 $P(i,j)$ 表示灰度级为 $i$、长度为 $j$ 的游程数量。灰度级的数量为 $N_g=3$，观察到的最大游程长度为 $N_s=3$。\n\n统计每个灰度级的游程：\n- **灰度级 $i=1$**:\n    - 来自第1行的一个长度为 $j=2$ 的游程。\n    - 来自第3行的一个长度为 $j=2$ 的游程。\n    - 来自第4行的一个长度为 $j=1$ 的游程。\n    - 总计：$P(1,1)=1$, $P(1,2)=2$, $P(1,3)=0$。\n\n- **灰度级 $i=2$**:\n    - 来自第1行的一个长度为 $j=1$ 的游程。\n    - 来自第2行的一个长度为 $j=3$ 的游程。\n    - 总计：$P(2,1)=1$, $P(2,2)=0$, $P(2,3)=1$。\n\n- **灰度级 $i=3$**:\n    - 来自第3行的一个长度为 $j=1$ 的游程。\n    - 来自第4行的一个长度为 $j=2$ 的游程。\n    - 总计：$P(3,1)=1$, $P(3,2)=1$, $P(3,3)=0$。\n\n由此产生的 GLRLM $P$ 是一个 $3 \\times 3$ 矩阵：\n$$\nP = \\begin{pmatrix}\nP(1,1)  P(1,2)  P(1,3) \\\\\nP(2,1)  P(2,2)  P(2,3) \\\\\nP(3,1)  P(3,2)  P(3,3)\n\\end{pmatrix} = \\begin{pmatrix}\n1  2  0 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix}\n$$\n\n总游程数 $N_R$ 是 $P$ 中所有元素的和：\n$$\nN_R = \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} P(i,j) = (1+2+0) + (1+0+1) + (1+1+0) = 3 + 2 + 2 = 7\n$$\n\n现在我们可以计算 SRE 和 LRE 特征。\n\n**短游程强调 (SRE)**：此特征对较短的游程赋予更高的权重。其定义为：\n$$\n\\text{SRE} = \\frac{1}{N_R} \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} \\frac{P(i,j)}{j^2}\n$$\n代入我们的 GLRLM $P$ 的值：\n$$\n\\text{SRE} = \\frac{1}{7} \\left( \\frac{P(1,1)}{1^2} + \\frac{P(1,2)}{2^2} + \\frac{P(2,1)}{1^2} + \\frac{P(2,3)}{3^2} + \\frac{P(3,1)}{1^2} + \\frac{P(3,2)}{2^2} \\right)\n$$\n$$\n\\text{SRE} = \\frac{1}{7} \\left( \\frac{1}{1} + \\frac{2}{4} + \\frac{1}{1} + \\frac{1}{9} + \\frac{1}{1} + \\frac{1}{4} \\right)\n$$\n$$\n\\text{SRE} = \\frac{1}{7} \\left( 1 + \\frac{1}{2} + 1 + \\frac{1}{9} + 1 + \\frac{1}{4} \\right) = \\frac{1}{7} \\left( 3 + \\frac{1}{2} + \\frac{1}{4} + \\frac{1}{9} \\right)\n$$\n为了对分数求和，我们找到一个公分母，即 $36$：\n$$\n\\text{SRE} = \\frac{1}{7} \\left( 3 + \\frac{18}{36} + \\frac{9}{36} + \\frac{4}{36} \\right) = \\frac{1}{7} \\left( 3 + \\frac{31}{36} \\right) = \\frac{1}{7} \\left( \\frac{108+31}{36} \\right) = \\frac{1}{7} \\left( \\frac{139}{36} \\right) = \\frac{139}{252}\n$$\n数值上，这是：\n$$\n\\text{SRE} \\approx 0.5515873...\n$$\n四舍五入到四位有效数字，我们得到 $\\text{SRE} \\approx 0.5516$。\n\n**长游程强调 (LRE)**：此特征对较长的游程赋予更高的权重。其定义为：\n$$\n\\text{LRE} = \\frac{1}{N_R} \\sum_{i=1}^{N_g} \\sum_{j=1}^{N_s} j^2 P(i,j)\n$$\n代入我们的 GLRLM $P$ 的值：\n$$\n\\text{LRE} = \\frac{1}{7} \\left( 1^2 P(1,1) + 2^2 P(1,2) + 1^2 P(2,1) + 3^2 P(2,3) + 1^2 P(3,1) + 2^2 P(3,2) \\right)\n$$\n$$\n\\text{LRE} = \\frac{1}{7} \\left( 1(1) + 4(2) + 1(1) + 9(1) + 1(1) + 4(1) \\right)\n$$\n$$\n\\text{LRE} = \\frac{1}{7} (1 + 8 + 1 + 9 + 1 + 4) = \\frac{1}{7} (24) = \\frac{24}{7}\n$$\n数值上，这是：\n$$\n\\text{LRE} \\approx 3.4285714...\n$$\n四舍五入到四位有效数字，我们得到 $\\text{LRE} \\approx 3.429$。\n\n最终计算出的 SRE 和 LRE 值分别约为 $0.5516$ 和 $3.429$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5516 & 3.429\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "放射基因组学的核心目标是发现影像表型与基因组特征之间有意义的关联。典型相关性分析 (Canonical Correlation Analysis, CCA) 正是为此目的而设计的一种强大的多元统计技术，它能识别两组变量之间的共同模式。本练习 () 将指导您从基本原理出发实现 CCA，从而深入理解如何揭示并量化放射组学特征与基因表达数据之间的关联强度。",
            "id": "4557615",
            "problem": "给定一个玩具放射基因组学场景，其中一个小型队列中的两个放射组学影像特征与两个基因表达水平相关联。目标是根据典型相关分析（Canonical Correlation Analysis, CCA）计算典型变量和典型相关性。CCA是一种多变量方法，旨在找到两组变量中相关性最大的线性组合。使用以下基本定义作为基础：给定中心化的数据矩阵 $\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$ 和 $\\mathbf{Y} \\in \\mathbb{R}^{n \\times q}$，它们的样本协方差矩阵为 $\\mathbf{S}_{\\mathbf{X}\\mathbf{X}} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{X}$、$\\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}} = \\frac{1}{n-1}\\mathbf{Y}^\\top \\mathbf{Y}$ 和 $\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{Y}$。典型相关性定义为线性组合 $\\mathbf{X}\\mathbf{a}$ 和 $\\mathbf{Y}\\mathbf{b}$ 之间的最大皮尔逊相关性，约束条件为 $\\mathrm{Var}(\\mathbf{X}\\mathbf{a}) = 1$ 和 $\\mathrm{Var}(\\mathbf{Y}\\mathbf{b}) = 1$。您的任务是根据第一性原理计算这些量，不使用任何内置的典型相关函数。\n\n构建以下固定的、确定性的测试套件。所有向量的长度为 $n = 5$，且所有列均已进行均值中心化。根据两个列向量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 定义共享的影像特征矩阵 $\\mathbf{X}$ 如下：\n$$\n\\mathbf{u} = \\begin{bmatrix} -2 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ 2 \\end{bmatrix}, \\quad\n\\mathbf{v} = \\begin{bmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ -2 \\end{bmatrix}, \\quad\n\\mathbf{X} = \\begin{bmatrix} \\mathbf{u} & \\mathbf{v} \\end{bmatrix}.\n$$\n定义辅助向量，这些向量与 $\\mathbf{u}$ 和 $\\mathbf{v}$ 均正交（在样本内积意义上）且均值为零：\n$$\n\\mathbf{w}_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ -2 \\\\ 0 \\\\ 1 \\end{bmatrix}, \\quad\n\\mathbf{w}_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ -2 \\\\ 1 \\\\ 0 \\end{bmatrix}.\n$$\n现在定义三个基因表达矩阵 $\\mathbf{Y}$ 以探测不同的情况：\n- 测试用例1（两个维度上完全线性关联）：令\n$$\n\\mathbf{A} = \\begin{bmatrix} 2 & 1 \\\\ -1 & 3 \\end{bmatrix}, \\quad \\mathbf{Y}_1 = \\mathbf{X}\\mathbf{A}.\n$$\n- 测试用例2（两个维度上均无线性关联）：令\n$$\n\\mathbf{Y}_2 = \\begin{bmatrix} \\mathbf{w}_1 & \\mathbf{w}_2 \\end{bmatrix}.\n$$\n- 测试用例3（一个关联维度和一个非关联维度）：令\n$$\n\\mathbf{Y}_3 = \\begin{bmatrix} \\mathbf{u} & \\mathbf{w}_1 \\end{bmatrix}.\n$$\n\n程序要求：\n- 对于每个测试用例，计算上述CCA优化问题所隐含的前两个典型相关性。在每种情况下，也要计算相应的典型变量（线性组合），以确保您的程序逻辑忠实于基于原理的定义，但您不需要打印典型变量向量。使用样本协方差定义 $\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}$、$\\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}}$、$\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}}$，其中因子为 $\\frac{1}{n-1}$ 且 $n = 5$。\n- 通过对 $\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}$、$\\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}}$ 和 $\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}}$ 进行适定的线性代数运算来处理计算。不要使用任何黑箱典型相关例程。\n- 数值输出规范：对于每个测试用例 $k \\in \\{1,2,3\\}$，令 $c_{k,1}$ 和 $c_{k,2}$ 分别表示第一个和第二个典型相关性。将每个 $c_{k,j}$ 四舍五入到小数点后6位。您的程序应生成单行输出，其中包含所有结果，格式为方括号内以逗号分隔的列表，顺序为 $[c_{1,1}, c_{1,2}, c_{2,1}, c_{2,2}, c_{3,1}, c_{3,2}]$。\n- 不涉及角度，也没有物理单位。所有数值输出必须是精确到小数点后6位的小数。\n\n测试套件覆盖范围的基本原理：\n- 测试用例1探测 $\\mathbf{Y}$ 是 $\\mathbf{X}$ 的满秩线性变换的情况，这应产生可能的最强关联。\n- 测试用例2探测影像和基因组子空间关于样本内积正交的情况，测试无线性关联的边界。\n- 测试用例3探测一个混合情况，其中影像和基因组空间仅共享一个维度。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含结果，格式为方括号内以逗号分隔的列表（例如，$[c_{1,1},c_{1,2},c_{2,1},c_{2,2},c_{3,1},c_{3,2}]$），每个条目精确到小数点后6位。",
            "solution": "对用户提供的问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **数据矩阵**：$\\mathbf{X} \\in \\mathbb{R}^{n \\times p}$ 和 $\\mathbf{Y} \\in \\mathbb{R}^{n \\times q}$ 是中心化的数据矩阵。\n- **样本大小**：$n = 5$。\n- **影像特征向量**：\n$$\n\\mathbf{u} = \\begin{bmatrix} -2 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ 2 \\end{bmatrix}, \\quad\n\\mathbf{v} = \\begin{bmatrix} 2 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ -2 \\end{bmatrix}\n$$\n- **影像特征矩阵**：$\\mathbf{X} = \\begin{bmatrix} \\mathbf{u} & \\mathbf{v} \\end{bmatrix}$。\n- **辅助向量**：\n$$\n\\mathbf{w}_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ -2 \\\\ 0 \\\\ 1 \\end{bmatrix}, \\quad\n\\mathbf{w}_2 = \\begin{bmatrix} 0 \\\\ 1 \\\\ -2 \\\\ 1 \\\\ 0 \\end{bmatrix}\n$$\n- **基因表达矩阵（测试用例）**：\n  1. $\\mathbf{A} = \\begin{bmatrix} 2 & 1 \\\\ -1 & 3 \\end{bmatrix}, \\quad \\mathbf{Y}_1 = \\mathbf{X}\\mathbf{A}$。\n  2. $\\mathbf{Y}_2 = \\begin{bmatrix} \\mathbf{w}_1 & \\mathbf{w}_2 \\end{bmatrix}$。\n  3. $\\mathbf{Y}_3 = \\begin{bmatrix} \\mathbf{u} & \\mathbf{w}_1 \\end{bmatrix}$。\n- **协方差定义**：$\\mathbf{S}_{\\mathbf{X}\\mathbf{X}} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{X}$、$\\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}} = \\frac{1}{n-1}\\mathbf{Y}^\\top \\mathbf{Y}$ 和 $\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{Y}$。\n- **CCA目标**：在 $\\mathrm{Var}(\\mathbf{X}\\mathbf{a}) = 1$ 和 $\\mathrm{Var}(\\mathbf{Y}\\mathbf{b}) = 1$ 的约束下，最大化 $\\mathrm{Corr}(\\mathbf{X}\\mathbf{a}, \\mathbf{Y}\\mathbf{b})$。\n- **输出要求**：对于每种情况，计算两个典型相关性，四舍五入到小数点后6位，并以单个逗号分隔的列表形式呈现：$[c_{1,1}, c_{1,2}, c_{2,1}, c_{2,2}, c_{3,1}, c_{3,2}]$。\n\n### 第2步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是典型相关分析（CCA）的标准应用，这是多变量统计学中的一种基本方法。所指定的背景——放射基因组学——是一个使用此类方法的有效科学领域。数学公式是正确的。\n2.  **适定性**：该问题提供了所有必要的数据和定义。给定的向量已确认是均值中心化的。构造的矩阵是良态的（例如，$\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}$ 是可逆的），确保存在唯一解。测试用例系统地探索了线性关联的不同情况，这表明问题设计良好。\n3.  **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n问题是有效的。将推导并实现一个基于第一性原理的解决方案。\n\n### 基于原理的解决方案\n典型相关分析（CCA）的目标是找到权重向量 $\\mathbf{a}$ 和 $\\mathbf{b}$，以最大化典型变量 $\\mathbf{U} = \\mathbf{X}\\mathbf{a}$ 和 $\\mathbf{V} = \\mathbf{Y}\\mathbf{b}$ 之间的相关性 $\\rho$。相关性定义为：\n$$\n\\rho = \\frac{\\mathrm{Cov}(\\mathbf{X}\\mathbf{a}, \\mathbf{Y}\\mathbf{b})}{\\sqrt{\\mathrm{Var}(\\mathbf{X}\\mathbf{a}) \\mathrm{Var}(\\mathbf{Y}\\mathbf{b})}}\n$$\n鉴于数据是中心化的，并使用所提供的协方差定义，我们有：\n-   $\\mathrm{Var}(\\mathbf{X}\\mathbf{a}) = \\mathbf{a}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}} \\mathbf{a}$\n-   $\\mathrm{Var}(\\mathbf{Y}\\mathbf{b}) = \\mathbf{b}^\\top \\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}} \\mathbf{b}$\n-   $\\mathrm{Cov}(\\mathbf{X}\\mathbf{a}, \\mathbf{Y}\\mathbf{b}) = \\mathbf{a}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}} \\mathbf{b}$\n\n该优化问题是在归一化约束条件 $\\mathbf{a}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}} \\mathbf{a} = 1$ 和 $\\mathbf{b}^\\top \\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}} \\mathbf{b} = 1$ 下，最大化 $\\rho = \\mathbf{a}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}} \\mathbf{b}$。此问题可以使用拉格朗日乘数法求解，将其转换为一个广义特征值问题。该解法会得到两个等价的长期方程。我们将使用求解权重向量 $\\mathbf{b}$ 的形式：\n$$\n(\\mathbf{S}_{\\mathbf{Y}\\mathbf{Y}}^{-1} \\mathbf{S}_{\\mathbf{Y}\\mathbf{X}} \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}}) \\mathbf{b} = \\rho^2 \\mathbf{b}\n$$\n其中 $\\mathbf{S}_{\\mathbf{Y}\\mathbf{X}} = \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}}^\\top$。这是一个标准的特征值问题。特征值 $\\lambda_i = \\rho_i^2$ 是典型相关系数的平方。典型相关系数 $\\rho_i$ 是这些特征值的正平方根。相应的特征向量 $\\mathbf{b}_i$ 是 $\\mathbf{Y}$ 变量的典型权重向量。非零典型相关性的数量最多为 $\\min(\\dim(\\mathbf{X}), \\dim(\\mathbf{Y}))$。这里，$\\mathbf{X}$ 和 $\\mathbf{Y}$ 分别有 $p=2$ 和 $q=2$ 列，因此我们将在每种情况下找到两个典型相关性。\n\n计算过程如下：\n1.  为每个测试用例 $k \\in \\{1, 2, 3\\}$ 构建数据矩阵 $\\mathbf{X}$ 和 $\\mathbf{Y}_k$。\n2.  使用因子 $\\frac{1}{n-1} = \\frac{1}{4}$ 计算样本协方差矩阵 $\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}$、$\\mathbf{S}_{\\mathbf{Y}_k\\mathbf{Y}_k}$ 和 $\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_k}$。\n3.  计算矩阵 $\\mathbf{K}_k = \\mathbf{S}_{\\mathbf{Y}_k\\mathbf{Y}_k}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_k}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_k}$。\n4.  计算 $\\mathbf{K}_k$ 的特征值。\n5.  典型相关性是这些特征值的平方根，按降序排列。\n\n首先，我们计算公共矩阵 $\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}$ 及其逆矩阵。\n$$\n\\mathbf{X}^\\top\\mathbf{X} = \\begin{bmatrix} \\mathbf{u}^\\top\\mathbf{u} & \\mathbf{u}^\\top\\mathbf{v} \\\\ \\mathbf{v}^\\top\\mathbf{u} & \\mathbf{v}^\\top\\mathbf{v} \\end{bmatrix} = \\begin{bmatrix} 10 & -6 \\\\ -6 & 10 \\end{bmatrix}\n$$\n$$\n\\mathbf{S}_{\\mathbf{X}\\mathbf{X}} = \\frac{1}{4} \\begin{bmatrix} 10 & -6 \\\\ -6 & 10 \\end{bmatrix} = \\begin{bmatrix} 2.5 & -1.5 \\\\ -1.5 & 2.5 \\end{bmatrix}\n$$\n$$\n\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} = \\frac{1}{2.5^2 - (-1.5)^2} \\begin{bmatrix} 2.5 & 1.5 \\\\ 1.5 & 2.5 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} 2.5 & 1.5 \\\\ 1.5 & 2.5 \\end{bmatrix} = \\begin{bmatrix} 0.625 & 0.375 \\\\ 0.375 & 0.625 \\end{bmatrix}\n$$\n\n**测试用例1：$\\mathbf{Y}_1 = \\mathbf{X}\\mathbf{A}$**\n这里，$\\mathbf{Y}_1$ 是 $\\mathbf{X}$ 的一个满秩线性变换。这种关系应该是可以完全发现的。\n$\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_1} = \\frac{1}{n-1}\\mathbf{X}^\\top(\\mathbf{X}\\mathbf{A}) = \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}\\mathbf{A}$。\n$\\mathbf{S}_{\\mathbf{Y}_1\\mathbf{Y}_1} = \\frac{1}{n-1}(\\mathbf{X}\\mathbf{A})^\\top(\\mathbf{X}\\mathbf{A}) = \\mathbf{A}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}} \\mathbf{A}$。\n矩阵 $\\mathbf{K}_1$ 变为：\n$$\n\\mathbf{K}_1 = (\\mathbf{A}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}} \\mathbf{A})^{-1} (\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}\\mathbf{A})^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} (\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}\\mathbf{A}) = \\mathbf{A}^{-1}\\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1}(\\mathbf{A}^\\top)^{-1} \\mathbf{A}^\\top\\mathbf{S}_{\\mathbf{X}\\mathbf{X}} \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}\\mathbf{A} = \\mathbf{I}\n$$\n$2 \\times 2$ 单位矩阵 $\\mathbf{I}$ 的特征值为 $1$ 和 $1$。因此，典型相关的平方为 $\\rho_1^2 = 1.0$ 和 $\\rho_2^2 = 1.0$。典型相关为 $c_{1,1} = 1.0$ 和 $c_{1,2} = 1.0$。\n\n**测试用例2：$\\mathbf{Y}_2 = [\\mathbf{w}_1, \\mathbf{w}_2]$**\n向量 $\\mathbf{w}_1$ 和 $\\mathbf{w}_2$ 被构造为与 $\\mathbf{X}$ 的列空间正交。\n$\\mathbf{u}^\\top\\mathbf{w}_1 = 0$, $\\mathbf{v}^\\top\\mathbf{w}_1 = 0$, $\\mathbf{u}^\\top\\mathbf{w}_2 = 0$, $\\mathbf{v}^\\top\\mathbf{w}_2 = 0$。\n这意味着 $\\mathbf{X}^\\top\\mathbf{w}_1 = \\mathbf{0}$ 和 $\\mathbf{X}^\\top\\mathbf{w}_2 = \\mathbf{0}$。\n因此，互协方差矩阵为空：\n$$\n\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_2} = \\frac{1}{n-1}\\mathbf{X}^\\top\\mathbf{Y}_2 = \\frac{1}{4} [\\mathbf{X}^\\top\\mathbf{w}_1, \\mathbf{X}^\\top\\mathbf{w}_2] = \\begin{bmatrix} 0 & 0 \\\\ 0 & 0 \\end{bmatrix}\n$$\n因此，矩阵 $\\mathbf{K}_2$ 也是零矩阵：\n$$\n\\mathbf{K}_2 = \\mathbf{S}_{\\mathbf{Y}_2\\mathbf{Y}_2}^{-1} \\mathbf{0}^\\top \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} \\mathbf{0} = \\mathbf{0}\n$$\n零矩阵的特征值为 $0$ 和 $0$。典型相关为 $c_{2,1} = 0.0$ 和 $c_{2,2} = 0.0$。\n\n**测试用例3：$\\mathbf{Y}_3 = [\\mathbf{u}, \\mathbf{w}_1]$**\n这是一个混合情况。$\\mathbf{Y}_3$ 的一个维度在 $\\mathbf{X}$ 的空间内，而另一个维度是正交的。\n$$\n\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_3} = \\frac{1}{4} \\mathbf{X}^\\top [\\mathbf{u}, \\mathbf{w}_1] = \\frac{1}{4} \\begin{bmatrix} \\mathbf{u}^\\top\\mathbf{u} & \\mathbf{u}^\\top\\mathbf{w}_1 \\\\ \\mathbf{v}^\\top\\mathbf{u} & \\mathbf{v}^\\top\\mathbf{w}_1 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} 10 & 0 \\\\ -6 & 0 \\end{bmatrix} = \\begin{bmatrix} 2.5 & 0 \\\\ -1.5 & 0 \\end{bmatrix}\n$$\n$$\n\\mathbf{S}_{\\mathbf{Y}_3\\mathbf{Y}_3} = \\frac{1}{4} \\begin{bmatrix} \\mathbf{u}^\\top\\mathbf{u} & \\mathbf{u}^\\top\\mathbf{w}_1 \\\\ \\mathbf{w}_1^\\top\\mathbf{u} & \\mathbf{w}_1^\\top\\mathbf{w}_1 \\end{bmatrix} = \\frac{1}{4} \\begin{bmatrix} 10 & 0 \\\\ 0 & 6 \\end{bmatrix} = \\begin{bmatrix} 2.5 & 0 \\\\ 0 & 1.5 \\end{bmatrix}\n$$\n$$\n\\mathbf{S}_{\\mathbf{Y}_3\\mathbf{Y}_3}^{-1} = \\begin{bmatrix} 1/2.5 & 0 \\\\ 0 & 1/1.5 \\end{bmatrix} = \\begin{bmatrix} 0.4 & 0 \\\\ 0 & 2/3 \\end{bmatrix}\n$$\n我们计算中间产物 $\\mathbf{M} = \\mathbf{S}_{\\mathbf{X}\\mathbf{X}}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_3}$：\n$$\n\\mathbf{M} = \\begin{bmatrix} 0.625 & 0.375 \\\\ 0.375 & 0.625 \\end{bmatrix} \\begin{bmatrix} 2.5 & 0 \\\\ -1.5 & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 0 \\end{bmatrix}\n$$\n现在我们计算 $\\mathbf{K}_3 = \\mathbf{S}_{\\mathbf{Y}_3\\mathbf{Y}_3}^{-1} \\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_3}^\\top \\mathbf{M}$：\n$$\n\\mathbf{S}_{\\mathbf{X}\\mathbf{Y}_3}^\\top \\mathbf{M} = \\begin{bmatrix} 2.5 & -1.5 \\\\ 0 & 0 \\end{bmatrix} \\begin{bmatrix} 1 & 0 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 2.5 & 0 \\\\ 0 & 0 \\end{bmatrix}\n$$\n$$\n\\mathbf{K}_3 = \\begin{bmatrix} 0.4 & 0 \\\\ 0 & 2/3 \\end{bmatrix} \\begin{bmatrix} 2.5 & 0 \\\\ 0 & 0 \\end{bmatrix} = \\begin{bmatrix} 1 & 0 \\\\ 0 & 0 \\end{bmatrix}\n$$\n$\\mathbf{K}_3$ 的特征值为 $1$ 和 $0$。典型相关为 $c_{3,1} = \\sqrt{1} = 1.0$ 和 $c_{3,2} = \\sqrt{0} = 0.0$。\n\n**结果摘要**：\n-   用例1相关性：$1.0, 1.0$\n-   用例2相关性：$0.0, 0.0$\n-   用例3相关性：$1.0, 0.0$\n结果将按问题陈述中的要求排序。",
            "answer": "$$\n\\boxed{[1.000000, 1.000000, 0.000000, 0.000000, 1.000000, 0.000000]}\n$$"
        }
    ]
}