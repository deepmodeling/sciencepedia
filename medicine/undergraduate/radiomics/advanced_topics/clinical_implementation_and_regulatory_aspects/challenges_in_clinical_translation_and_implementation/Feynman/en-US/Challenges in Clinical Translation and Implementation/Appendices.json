{
    "hands_on_practices": [
        {
            "introduction": "A primary challenge in radiomics is ensuring that features are robust and not merely artifacts of image processing choices. The values of many texture features, for instance, can be highly sensitive to how image intensities are discretized into gray levels. This practice provides a concrete, hands-on calculation to demonstrate how a common texture feature, Gray-Level Co-Occurrence Matrix (GLCM) contrast, can vary significantly after a standard preprocessing step like intensity normalization, underscoring the critical need for standardized image processing pipelines in clinical applications. ",
            "id": "4531998",
            "problem": "A core challenge in the clinical translation of radiomics features is their sensitivity to acquisition differences and preprocessing choices such as intensity normalization and discretization. Consider a fixed bin width discretization scheme commonly used in radiomics, applied to a small region of interest (ROI) to illustrate how Gray-Level Co-Occurrence Matrix (GLCM) contrast may change under different preprocessing. Assume the following:\n\n- The raw intensity range is $[I_{\\min}, I_{\\max}] = [0, 300]$ and the fixed bin width is $w = 25$.\n- The number of bins $B$ is defined on a zero-based index using right-open intervals, with a clipping rule for the upper bound: $b(I) = \\min\\!\\left(\\left\\lfloor \\dfrac{I - I_{\\min}}{w} \\right\\rfloor, B - 1\\right)$, where $B$ is the total number of bins covering $[I_{\\min}, I_{\\max}]$.\n- The Gray-Level Co-Occurrence Matrix (GLCM) is computed over a $2 \\times 2$ neighborhood with one-pixel rightward and downward adjacency, counting each such directed pair once, and normalizing by the total number of counted pairs so that the co-occurrence probabilities sum to $1$.\n- The GLCM-based contrast feature is defined as $\\displaystyle \\text{contrast} = \\sum_{i} \\sum_{j} (i - j)^{2} P(i,j)$, where $P(i,j)$ is the normalized co-occurrence probability of discretized gray levels $i$ and $j$.\n\nNow, analyze the following $2 \\times 2$ ROI with raw intensities:\n$$\n\\begin{pmatrix}\n112 & 137 \\\\\n261 & 296\n\\end{pmatrix}.\n$$\n\nTasks:\n1. Compute the total number of bins $B$ for $[0, 300]$ with $w = 25$.\n2. Discretize a sample voxel intensity of $137$ to its bin index using the zero-based rule above.\n3. Discretize the entire $2 \\times 2$ ROI and compute the GLCM-based contrast using the specified adjacency before any normalization.\n4. Apply min–max normalization to the ROI intensities to the same target range $[0, 300]$ using\n$$\nI' = I_{\\min}^{\\mathrm{target}} + \\frac{(I - I_{\\min})(I_{\\max}^{\\mathrm{target}} - I_{\\min}^{\\mathrm{target}})}{I_{\\max} - I_{\\min}},\n$$\nwith $I_{\\min}^{\\mathrm{target}} = 0$ and $I_{\\max}^{\\mathrm{target}} = 300$, where $I_{\\min}$ and $I_{\\max}$ are the minimum and maximum in the $2 \\times 2$ ROI. Then re-discretize the normalized intensities using the same $w$ and compute the GLCM-based contrast after normalization.\n\nFinally, compute the ratio\n$$\nR = \\frac{\\text{contrast after normalization}}{\\text{contrast before normalization}}.\n$$\n\nExpress the final ratio $R$ as a unitless number, and round your answer to four significant figures.",
            "solution": "The problem requires an analysis of the stability of a radiomics feature, specifically Gray-Level Co-Occurrence Matrix (GLCM) contrast, under intensity normalization. We will proceed by first validating the problem and then solving it step-by-step as requested.\n\nThe problem is determined to be valid. It is scientifically grounded in the principles of radiomics, internally consistent, and well-posed, providing all necessary definitions and data for a unique solution. We will now proceed with the detailed calculations.\n\nThe problem asks for a series of computations based on a given $2 \\times 2$ Region of Interest (ROI) with raw intensity values:\n$$\nM = \\begin{pmatrix}\n112 & 137 \\\\\n261 & 296\n\\end{pmatrix}\n$$\nThe analysis will be conducted in two main parts: before and after applying min-max intensity normalization to this ROI.\n\n**Preliminary Step: Determine the Number of Bins**\n\nThe problem specifies a raw intensity range of $[I_{\\min}, I_{\\max}] = [0, 300]$ and a fixed bin width of $w = 25$. The total number of bins, $B$, must cover this range. The span of the intensity range is $300 - 0 = 300$. The number of bins of width $25$ required to cover this span is:\n$$\nB = \\frac{I_{\\max} - I_{\\min}}{w} = \\frac{300}{25} = 12\n$$\nThus, there are $B=12$ bins, which will be indexed from $0$ to $11$. This answers Task 1.\n\nThe discretization rule is given as $b(I) = \\min\\!\\left(\\left\\lfloor \\dfrac{I - I_{\\min}}{w} \\right\\rfloor, B - 1\\right)$. With our parameters, this becomes:\n$$\nb(I) = \\min\\!\\left(\\left\\lfloor \\frac{I}{25} \\right\\rfloor, 11\\right)\n$$\n\n**Part 1: Analysis Before Intensity Normalization**\n\nWe first analyze the raw ROI data.\n\n**Task 2: Discretize a Sample Voxel Intensity**\nFor a sample intensity of $I=137$, the bin index is:\n$$\nb(137) = \\min\\!\\left(\\left\\lfloor \\frac{137}{25} \\right\\rfloor, 11\\right) = \\min(\\lfloor 5.48 \\rfloor, 11) = \\min(5, 11) = 5\n$$\nThe intensity value $137$ is assigned to bin index $5$.\n\n**Task 3: Discretize the ROI and Compute GLCM Contrast**\nWe apply the discretization rule to each voxel in the given ROI:\n- $b(112) = \\min\\!\\left(\\left\\lfloor \\frac{112}{25} \\right\\rfloor, 11\\right) = \\min(\\lfloor 4.48 \\rfloor, 11) = 4$\n- $b(137) = \\min\\!\\left(\\left\\lfloor \\frac{137}{25} \\right\\rfloor, 11\\right) = \\min(\\lfloor 5.48 \\rfloor, 11) = 5$\n- $b(261) = \\min\\!\\left(\\left\\lfloor \\frac{261}{25} \\right\\rfloor, 11\\right) = \\min(\\lfloor 10.44 \\rfloor, 11) = 10$\n- $b(296) = \\min\\!\\left(\\left\\lfloor \\frac{296}{25} \\right\\rfloor, 11\\right) = \\min(\\lfloor 11.84 \\rfloor, 11) = 11$\n\nThe discretized ROI, $M_d$, is:\n$$\nM_d = \\begin{pmatrix}\n4 & 5 \\\\\n10 & 11\n\\end{pmatrix}\n$$\nNext, we compute the GLCM by considering one-pixel rightward and downward adjacencies. There are two rightward pairs and two downward pairs, for a total of $N_p = 4$ pairs.\n- Rightward pairs: $(4, 5)$ and $(10, 11)$.\n- Downward pairs: $(4, 10)$ and $(5, 11)$.\n\nThe normalized GLCM, $P(i, j)$, contains the probabilities of these co-occurrences. Since each pair appears once out of $4$ total pairs, their probabilities are:\n- $P(4, 5) = \\frac{1}{4}$\n- $P(10, 11) = \\frac{1}{4}$\n- $P(4, 10) = \\frac{1}{4}$\n- $P(5, 11) = \\frac{1}{4}$\nAll other $P(i, j)$ are $0$.\n\nThe GLCM contrast is calculated using the formula $\\text{contrast} = \\sum_{i} \\sum_{j} (i - j)^{2} P(i,j)$.\n$$\n\\text{contrast}_{\\text{before}} = (4-5)^2 P(4, 5) + (10-11)^2 P(10, 11) + (4-10)^2 P(4, 10) + (5-11)^2 P(5, 11)\n$$\n$$\n\\text{contrast}_{\\text{before}} = (-1)^2 \\left(\\frac{1}{4}\\right) + (-1)^2 \\left(\\frac{1}{4}\\right) + (-6)^2 \\left(\\frac{1}{4}\\right) + (-6)^2 \\left(\\frac{1}{4}\\right)\n$$\n$$\n\\text{contrast}_{\\text{before}} = \\frac{1}{4} (1 + 1 + 36 + 36) = \\frac{74}{4} = 18.5\n$$\n\n**Part 2: Analysis After Intensity Normalization**\n\n**Task 4: Normalize, Re-discretize, and Compute Contrast**\nFirst, we apply min-max normalization to the raw ROI intensities. The minimum and maximum intensities within the ROI are $I_{\\min, \\text{ROI}} = 112$ and $I_{\\max, \\text{ROI}} = 296$. The target range is $[I_{\\min}^{\\mathrm{target}}, I_{\\max}^{\\mathrm{target}}] = [0, 300]$.\nThe normalization formula is:\n$$\nI' = I_{\\min}^{\\mathrm{target}} + \\frac{(I - I_{\\min, \\text{ROI}})(I_{\\max}^{\\mathrm{target}} - I_{\\min}^{\\mathrm{target}})}{I_{\\max, \\text{ROI}} - I_{\\min, \\text{ROI}}} = 0 + \\frac{(I - 112)(300 - 0)}{296 - 112} = \\frac{300}{184} (I - 112) = \\frac{75}{46} (I - 112)\n$$\nWe apply this transformation to each voxel intensity:\n- $I'_{11} = \\frac{75}{46} (112 - 112) = 0$\n- $I'_{12} = \\frac{75}{46} (137 - 112) = \\frac{75 \\times 25}{46} = \\frac{1875}{46} \\approx 40.76$\n- $I'_{21} = \\frac{75}{46} (261 - 112) = \\frac{75 \\times 149}{46} = \\frac{11175}{46} \\approx 242.93$\n- $I'_{22} = \\frac{75}{46} (296 - 112) = \\frac{75 \\times 184}{46} = 75 \\times 4 = 300$\n\nThe normalized ROI, $M'$, has intensities:\n$$\nM' = \\begin{pmatrix} 0 & \\frac{1875}{46} \\\\ \\frac{11175}{46} & 300 \\end{pmatrix}\n$$\nNow, we re-discretize these new intensities using the same binning rule $b(I') = \\min\\!\\left(\\left\\lfloor I'/25 \\right\\rfloor, 11\\right)$.\n- $b(0) = \\min\\!\\left(\\left\\lfloor 0/25 \\right\\rfloor, 11\\right) = 0$\n- $b(\\frac{1875}{46}) = \\min\\!\\left(\\left\\lfloor \\frac{1875}{46 \\times 25} \\right\\rfloor, 11\\right) = \\min\\!\\left(\\left\\lfloor \\frac{75}{46} \\right\\rfloor, 11\\right) = \\min(\\lfloor 1.63... \\rfloor, 11) = 1$\n- $b(\\frac{11175}{46}) = \\min\\!\\left(\\left\\lfloor \\frac{11175}{46 \\times 25} \\right\\rfloor, 11\\right) = \\min\\!\\left(\\left\\lfloor \\frac{447}{46} \\right\\rfloor, 11\\right) = \\min(\\lfloor 9.71... \\rfloor, 11) = 9$\n- $b(300) = \\min\\!\\left(\\left\\lfloor 300/25 \\right\\rfloor, 11\\right) = \\min(12, 11) = 11$\n\nThe new discretized ROI, $M'_d$, is:\n$$\nM'_d = \\begin{pmatrix}\n0 & 1 \\\\\n9 & 11\n\\end{pmatrix}\n$$\nThe new set of co-occurring pairs is:\n- Rightward pairs: $(0, 1)$ and $(9, 11)$.\n- Downward pairs: $(0, 9)$ and $(1, 11)$.\nEach pair occurs once out of $N_p=4$ pairs. The normalized probabilities $P'(i,j)$ are all $\\frac{1}{4}$.\nThe contrast is now:\n$$\n\\text{contrast}_{\\text{after}} = (0-1)^2 P'(0, 1) + (9-11)^2 P'(9, 11) + (0-9)^2 P'(0, 9) + (1-11)^2 P'(1, 11)\n$$\n$$\n\\text{contrast}_{\\text{after}} = (-1)^2 \\left(\\frac{1}{4}\\right) + (-2)^2 \\left(\\frac{1}{4}\\right) + (-9)^2 \\left(\\frac{1}{4}\\right) + (-10)^2 \\left(\\frac{1}{4}\\right)\n$$\n$$\n\\text{contrast}_{\\text{after}} = \\frac{1}{4} (1 + 4 + 81 + 100) = \\frac{186}{4} = 46.5\n$$\n\n**Final Calculation: The Ratio**\n\nFinally, we compute the ratio $R$ of the contrast after normalization to the contrast before normalization.\n$$\nR = \\frac{\\text{contrast}_{\\text{after}}}{\\text{contrast}_{\\text{before}}} = \\frac{46.5}{18.5} = \\frac{93}{37}\n$$\n$$\nR \\approx 2.5135135...\n$$\nRounding the result to four significant figures gives:\n$$\nR \\approx 2.514\n$$\nThis result demonstrates the significant impact that intensity normalization, a common preprocessing step, can have on radiomic feature values, highlighting a key challenge in their clinical implementation.",
            "answer": "$$\\boxed{2.514}$$"
        },
        {
            "introduction": "For a radiomic feature to have any clinical value, it must be reliable and repeatable; its measurement should consistently reflect the underlying biology of a patient rather than random variations from the imaging process. The Intraclass Correlation Coefficient ($ICC$) is a key statistical metric used to quantify this reliability. This exercise walks you through the fundamental calculation of the $ICC$ from its core components—the between-subject and within-subject variance—to help you understand how we determine if a feature is stable enough for clinical use. ",
            "id": "4532023",
            "problem": "A radiomics team evaluates the repeatability and reliability of a computed tomography texture feature across repeated scans in a single center. For each subject, two identical acquisitions are performed within the same session. A one-way random effects measurement model is assumed, in which each observed feature value for subject $i$ on replicate $j$ is the sum of a population mean, a subject-specific random effect, and an independent measurement error. Across the cohort, the between-subject variance is estimated as $\\sigma^{2}_{\\text{b}} = 1.5$, and the within-subject (repeatability) variance is estimated as $\\sigma^{2}_{\\text{w}} = 0.5$. The Intraclass Correlation Coefficient (ICC) is used as the reliability metric for clinical implementation decisions in radiomics.\n\nUsing only the fundamental definition of reliability as the ratio of variance attributable to true subject differences over the total observed variance, derive an expression for the Intraclass Correlation Coefficient ($ICC$) under the stated model in terms of $\\sigma^{2}_{\\text{b}}$ and $\\sigma^{2}_{\\text{w}}$, compute its value for the given variance components, and determine whether the feature meets a minimum clinical reliability criterion of $ICC \\ge 0.75$. Report the numerical value of $ICC$ as a pure number with no units. No rounding is required unless unavoidable.",
            "solution": "The problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n- Model: \"A one-way random effects measurement model is assumed, in which each observed feature value for subject $i$ on replicate $j$ is the sum of a population mean, a subject-specific random effect, and an independent measurement error.\"\n- Between-subject variance: \"$\\sigma^{2}_{\\text{b}} = 1.5$\"\n- Within-subject (repeatability) variance: \"$\\sigma^{2}_{\\text{w}} = 0.5$\"\n- Definition of Reliability: \"the ratio of variance attributable to true subject differences over the total observed variance\"\n- Goal: \"derive an expression for the Intraclass Correlation Coefficient ($ICC$) under the stated model in terms of $\\sigma^{2}_{\\text{b}}$ and $\\sigma^{2}_{\\text{w}}$, compute its value for the given variance components, and determine whether the feature meets a minimum clinical reliability criterion of $ICC \\ge 0.75$.\"\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard statistical scenario for assessing measurement reliability using a one-way random effects model and the Intraclass Correlation Coefficient ($ICC$). This is a common and fundamental procedure in medical imaging research, including radiomics. The provided data are sufficient, consistent, and plausible. The definition of reliability is clear and allows for a direct derivation. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be generated.\n\nThe problem requires the derivation and calculation of the Intraclass Correlation Coefficient ($ICC$) based on a one-way random effects model. Let $Y_{ij}$ be the observed feature value for subject $i$ on replicate measurement $j$. According to the problem statement, the model is:\n$$\nY_{ij} = \\mu + s_i + e_{ij}\n$$\nHere, $\\mu$ represents the overall population mean of the feature, which is a fixed constant. The term $s_i$ is the random effect associated with subject $i$, representing the deviation of subject $i$'s true mean value from the population mean $\\mu$. The term $e_{ij}$ is the random measurement error for the $j$-th replicate of subject $i$. The random effects $s_i$ and errors $e_{ij}$ are assumed to be independent of each other.\n\nThe variances of these random components are given. The variance of the subject-specific effects, $s_i$, is the between-subject variance:\n$$\n\\text{Var}(s_i) = \\sigma^{2}_{\\text{b}}\n$$\nThis variance, $\\sigma^{2}_{\\text{b}}$, quantifies the \"true\" variability between different subjects in the population. It is the variance component that the problem refers to as \"variance attributable to true subject differences.\"\n\nThe variance of the measurement errors, $e_{ij}$, is the within-subject variance:\n$$\n\\text{Var}(e_{ij}) = \\sigma^{2}_{\\text{w}}\n$$\nThis variance, $\\sigma^{2}_{\\text{w}}$, quantifies the variability of measurements taken on the same subject, which is due to measurement error or lack of repeatability.\n\nTo calculate the $ICC$, we first need to determine the total variance of a single observed measurement, $\\text{Var}(Y_{ij})$. Since $\\mu$ is a constant, its variance is zero. Because $s_i$ and $e_{ij}$ are independent, the variance of their sum is the sum of their variances:\n$$\n\\text{Var}(Y_{ij}) = \\text{Var}(\\mu + s_i + e_{ij}) = \\text{Var}(\\mu) + \\text{Var}(s_i) + \\text{Var}(e_{ij})\n$$\n$$\n\\text{Var}(Y_{ij}) = 0 + \\sigma^{2}_{\\text{b}} + \\sigma^{2}_{\\text{w}} = \\sigma^{2}_{\\text{b}} + \\sigma^{2}_{\\text{w}}\n$$\nThis sum, $\\sigma^{2}_{\\text{b}} + \\sigma^{2}_{\\text{w}}$, represents the total observed variance for any single measurement.\n\nThe problem explicitly defines reliability (which is the $ICC$ in this context) as \"the ratio of variance attributable to true subject differences over the total observed variance.\" Following this definition, we can construct the expression for the $ICC$:\n$$\nICC = \\frac{\\text{Variance attributable to true subject differences}}{\\text{Total observed variance}}\n$$\nThe numerator is the between-subject variance, $\\sigma^{2}_{\\text{b}}$. The denominator is the total variance we just derived, $\\sigma^{2}_{\\text{b}} + \\sigma^{2}_{\\text{w}}$. Therefore, the derived expression for the $ICC$ is:\n$$\nICC = \\frac{\\sigma^{2}_{\\text{b}}}{\\sigma^{2}_{\\text{b}} + \\sigma^{2}_{\\text{w}}}\n$$\nThis corresponds to the formal definition of $ICC(1,1)$ for absolute agreement in a one-way random effects model.\n\nNext, we compute the numerical value of the $ICC$ using the given variance components: $\\sigma^{2}_{\\text{b}} = 1.5$ and $\\sigma^{2}_{\\text{w}} = 0.5$. Substituting these values into our derived formula:\n$$\nICC = \\frac{1.5}{1.5 + 0.5} = \\frac{1.5}{2.0}\n$$\n$$\nICC = 0.75\n$$\nThe computed value of the Intraclass Correlation Coefficient is $0.75$.\n\nFinally, we must determine if this value meets the minimum clinical reliability criterion, which is stated as $ICC \\ge 0.75$. Our calculated value is $ICC = 0.75$. Since $0.75$ is indeed greater than or equal to $0.75$, the condition $0.75 \\ge 0.75$ is met. Therefore, the feature meets the minimum clinical reliability criterion. The final answer required is the numerical value of the $ICC$.",
            "answer": "$$\\boxed{0.75}$$"
        },
        {
            "introduction": "Translating a radiomics model into clinical practice requires more than just statistical accuracy; it demands a framework for making optimal decisions. A model typically outputs a probability of disease, and this exercise demonstrates how to use that probability effectively. By applying Bayes' theorem and decision theory, you will calculate how a model's performance translates into predictive values in a specific population and determine an optimal decision threshold by weighing the clinical costs of false positive versus false negative results. ",
            "id": "4531899",
            "problem": "A radiomics classifier trained on Computed Tomography (CT) images outputs for each patient a calibrated posterior probability $p$ of having a clinically significant lesion. In a target implementation cohort, the disease prevalence is $\\pi = 0.1$. At a reference operating point of the classifier, the sensitivity is $0.85$ and the specificity is $0.90$. The health system specifies a cost matrix for decision-making in terms of expected harm: the cost of a false positive is $C_{\\mathrm{FP}} = 1$ harm-unit, the cost of a false negative is $C_{\\mathrm{FN}} = 5$ harm-units, and the cost of a correct decision (true positive or true negative) is $0$.\n\nUsing the core definitions of sensitivity and specificity, together with Bayes’ theorem, derive expressions for the Positive Predictive Value (PPV) and the Negative Predictive Value (NPV) and compute their values for the given $\\pi$, sensitivity, and specificity. Then, using Bayesian decision theory and the given cost matrix, derive the decision rule in terms of the probability threshold $t$ for classifying a patient as positive, and compute the threshold $t^{*}$ that maximizes expected utility (equivalently, minimizes expected cost).\n\nRound all reported numeric values to four significant figures and express probabilities as decimals with no units. Provide only the optimal threshold $t^{*}$ as your final boxed answer.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It is based on fundamental principles of probability theory, Bayesian statistics, and decision theory as applied to medical diagnostics. All necessary data are provided, and there are no contradictions.\n\nLet $D$ be the event that a patient has a clinically significant lesion (disease is present), and let $D^c$ be the event that the patient does not. The prevalence of the disease is given as $\\pi = P(D) = 0.1$. Consequently, the probability of not having the disease is $P(D^c) = 1 - \\pi = 1 - 0.1 = 0.9$.\n\nLet $T$ be the event that the classifier's output is positive (i.e., the output probability $p$ is above a certain threshold), and $T^c$ be the event that the output is negative.\nThe problem provides the classifier's performance at a reference operating point:\n- Sensitivity: $Se = P(T|D) = 0.85$. This is the true positive rate (TPR).\n- Specificity: $Sp = P(T^c|D^c) = 0.90$. This is the true negative rate (TNR).\n\nFrom these, we can derive the false negative rate (FNR) and false positive rate (FPR):\n- False Negative Rate: $FNR = P(T^c|D) = 1 - P(T|D) = 1 - Se = 1 - 0.85 = 0.15$.\n- False Positive Rate: $FPR = P(T|D^c) = 1 - P(T^c|D^c) = 1 - Sp = 1 - 0.90 = 0.10$.\n\n**Part 1: Positive and Negative Predictive Values (PPV and NPV)**\n\nThe Positive Predictive Value (PPV) is the probability that a patient has the disease given that the test is positive, $P(D|T)$. Using Bayes' theorem:\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\nThe denominator, $P(T)$, is the total probability of a positive test, which can be found using the law of total probability:\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\nSubstituting the known quantities ($Se$, $\\pi$, $Sp$):\n$$P(T) = (Se)(\\pi) + (1-Sp)(1-\\pi)$$\nTherefore, the expression for PPV is:\n$$PPV = \\frac{(Se)(\\pi)}{(Se)(\\pi) + (1-Sp)(1-\\pi)}$$\nPlugging in the given values:\n$$PPV = \\frac{(0.85)(0.1)}{(0.85)(0.1) + (1-0.90)(1-0.1)} = \\frac{0.085}{0.085 + (0.10)(0.9)} = \\frac{0.085}{0.085 + 0.09} = \\frac{0.085}{0.175}$$\n$$PPV \\approx 0.485714 \\dots$$\nRounded to four significant figures, $PPV = 0.4857$.\n\nThe Negative Predictive Value (NPV) is the probability that a patient does not have the disease given that the test is negative, $P(D^c|T^c)$. Using Bayes' theorem:\n$$NPV = P(D^c|T^c) = \\frac{P(T^c|D^c)P(D^c)}{P(T^c)}$$\nThe denominator, $P(T^c)$, is the total probability of a negative test, found using the law of total probability:\n$$P(T^c) = P(T^c|D)P(D) + P(T^c|D^c)P(D^c)$$\nSubstituting the known quantities ($Se$, $\\pi$, $Sp$):\n$$P(T^c) = (1-Se)(\\pi) + (Sp)(1-\\pi)$$\nTherefore, the expression for NPV is:\n$$NPV = \\frac{(Sp)(1-\\pi)}{(1-Se)(\\pi) + (Sp)(1-\\pi)}$$\nPlugging in the given values:\n$$NPV = \\frac{(0.90)(1-0.1)}{(1-0.85)(0.1) + (0.90)(1-0.1)} = \\frac{(0.90)(0.9)}{(0.15)(0.1) + (0.90)(0.9)} = \\frac{0.81}{0.015 + 0.81} = \\frac{0.81}{0.825}$$\n$$NPV \\approx 0.981818 \\dots$$\nRounded to four significant figures, $NPV = 0.9818$.\n\n**Part 2: Optimal Decision Threshold ($t^*$ )**\n\nThe classifier outputs a calibrated posterior probability $p$ for each patient, where $p$ represents the probability of the patient having the disease given the image features, i.e., $p = P(D|\\text{evidence})$. The decision rule is to classify a patient as positive if $p \\geq t$ and negative if $p < t$, where $t$ is the decision threshold. We seek the optimal threshold $t^*$ that minimizes the expected cost (or maximizes expected utility).\n\nThe cost matrix is specified as:\n- Cost of a True Positive: $C_{\\mathrm{TP}} = 0$.\n- Cost of a True Negative: $C_{\\mathrm{TN}} = 0$.\n- Cost of a False Positive: $C_{\\mathrm{FP}} = 1$.\n- Cost of a False Negative: $C_{\\mathrm{FN}} = 5$.\n\nFor a patient with a specific posterior probability $p$, we can calculate the expected cost for each of the two possible decisions (classify as positive or classify as negative).\n\nThe expected cost of classifying the patient as positive (Action 'Pos') is:\n$$E[\\text{Cost}|\\text{Pos}] = P(D|\\text{evidence}) \\cdot C_{\\mathrm{TP}} + P(D^c|\\text{evidence}) \\cdot C_{\\mathrm{FP}}$$\n$$E[\\text{Cost}|\\text{Pos}] = p \\cdot C_{\\mathrm{TP}} + (1-p) \\cdot C_{\\mathrm{FP}}$$\nSubstituting the cost values:\n$$E[\\text{Cost}|\\text{Pos}] = p \\cdot (0) + (1-p) \\cdot (1) = 1 - p$$\n\nThe expected cost of classifying the patient as negative (Action 'Neg') is:\n$$E[\\text{Cost}|\\text{Neg}] = P(D|\\text{evidence}) \\cdot C_{\\mathrm{FN}} + P(D^c|\\text{evidence}) \\cdot C_{\\mathrm{TN}}$$\n$$E[\\text{Cost}|\\text{Neg}] = p \\cdot C_{\\mathrm{FN}} + (1-p) \\cdot C_{\\mathrm{TN}}$$\nSubstituting the cost values:\n$$E[\\text{Cost}|\\text{Neg}] = p \\cdot (5) + (1-p) \\cdot (0) = 5p$$\n\nAccording to Bayesian decision theory, the optimal decision minimizes the expected cost. We should classify a patient as positive if $E[\\text{Cost}|\\text{Pos}] < E[\\text{Cost}|\\text{Neg}]$, and negative otherwise. The threshold $t^*$ is the value of $p$ at which the expected costs of both actions are equal:\n$$E[\\text{Cost}|\\text{Pos}] = E[\\text{Cost}|\\text{Neg}]$$\n$$1 - t^* = 5 t^*$$\nSolving for $t^*$:\n$$1 = 6 t^*$$\n$$t^* = \\frac{1}{6}$$\n\nThe decision rule is to classify as positive if $p > \\frac{1}{6}$. The optimal threshold is the boundary condition for this rule.\n\nIn general, the threshold $t^*$ is found by setting $p \\cdot C_{\\mathrm{TP}} + (1-p) \\cdot C_{\\mathrm{FP}} = p \\cdot C_{\\mathrm{FN}} + (1-p) \\cdot C_{\\mathrm{TN}}$ at $p=t^*$.\nRearranging the equation to solve for $t^*$:\n$$t^*(C_{\\mathrm{FN}} - C_{\\mathrm{TP}}) = (1-t^*)(C_{\\mathrm{FP}} - C_{\\mathrm{TN}})$$\n$$t^*(C_{\\mathrm{FN}} - C_{\\mathrm{TP}}) = C_{\\mathrm{FP}} - C_{\\mathrm{TN}} - t^*(C_{\\mathrm{FP}} - C_{\\mathrm{TN}})$$\n$$t^*((C_{\\mathrm{FN}} - C_{\\mathrm{TP}}) + (C_{\\mathrm{FP}} - C_{\\mathrm{TN}})) = C_{\\mathrm{FP}} - C_{\\mathrm{TN}}$$\n$$t^* = \\frac{C_{\\mathrm{FP}} - C_{\\mathrm{TN}}}{(C_{\\mathrm{FP}} - C_{\\mathrm{TN}}) + (C_{\\mathrm{FN}} - C_{\\mathrm{TP}})}$$\nSubstituting the given costs:\n$$t^* = \\frac{1 - 0}{(1 - 0) + (5 - 0)} = \\frac{1}{1 + 5} = \\frac{1}{6}$$\nAs a decimal, $t^* = 0.166666...$. Rounding to four significant figures gives $0.1667$.\nThis is the optimal probability threshold for classifying a patient as positive to minimize the expected harm.",
            "answer": "$$\\boxed{0.1667}$$"
        }
    ]
}