{
    "hands_on_practices": [
        {
            "introduction": "毛细血管是心血管系统的功能核心，是血液与组织之间交换营养物质、废物和液体的场所。这个交换过程由斯他林力（Starling forces）精确调控，这些力包括静水压和胶体渗透压。本练习将引导您超越教科书中对斯他林方程的静态应用，通过对沿毛细血管长度变化的压力梯度进行积分，来计算净液体通量 ()。这种方法能让您更深入地理解在生理现实中，滤过和重吸收是如何在一个单一血管段内动态变化的。",
            "id": "4949352",
            "problem": "骨骼肌中单个微血管毛细血管段的长度为 $L = 1.0$ mm。毛细血管内的静水压力沿轴向坐标 $x \\in [0, L]$ 从动脉小头端的压力 $P_{a} = 35$ mmHg 线性下降至静脉小头端的压力 $P_{v} = 15$ mmHg。周围的组织间液静水压力在空间上是均匀的，其值为 $P_{i} = 3$ mmHg。血浆蛋白主要保留在毛细血管腔内，而水可以有效地自由通过内皮；毛细血管内的胶体渗透压近似恒定为 $\\pi_{c} = 25$ mmHg，而组织间液的胶体渗透压近似恒定为 $\\pi_{i} = 5$ mmHg。内皮对蛋白质的半透性由有效溶质反射系数 $\\sigma = 0.90$ 来表征，并且毛细血管壁表现出单位长度的滤过系数 $k = 2.0 \\times 10^{-6}$ mL/(min·mmHg·mm)，假定其沿 $x$ 轴是均匀的。\n\n从以下基本原理出发：\n- 静水压力是流体施加的单位面积上的力 ($P$)，跨膜的静水压力差有利于流体从高静水压区向低静水压区移动。\n- 不可渗透溶质的渗透压在半透膜上产生一个有效的反向压力差；其半透性特征由一个反射系数来体现，该系数用于调整水所感受到的有效渗透压差。\n- 对于生物膜中的小驱动力，体积通量与净驱动压力成正比（一种输运定律），比例常数由滤过系数给出。\n\n假设 $P_{i}$、$\\pi_{c}$ 和 $\\pi_{i}$ 沿轴向均匀，且 $P_{c}(x)$ 在 $P_{a}$ 和 $P_{v}$ 之间呈线性分布。利用这些基本原理，通过沿 $x$ 积分局部通量，推导出整个毛细血管段的净流体体积通量表达式，并根据给定参数计算其数值。将最终数值答案四舍五入至三位有效数字，并以 mL/min 为单位表示。",
            "solution": "该问题要求推导和计算跨毛细血管段的净流体体积通量。这由 Starling 方程所决定，该方程描述了流体跨半透膜的运动。所提供的基本原理引导我们建立局部流体通量作为沿毛细血管位置的函数，然后可将其沿毛细血管长度积分以求得总通量。\n\n毛细血管单位长度的局部体积流体通量，我们可表示为 $\\frac{dQ}{dx}$，与跨毛细血管壁的净驱动压力成正比。比例常数是单位长度的滤过系数 $k$。\n在任何轴向位置 $x$ 的净驱动压力 $\\Delta P_{eff}(x)$ 是净静水压力与净有效胶体渗透压力之差。\n净静水压力是毛细血管内静水压力 $P_c(x)$ 与组织间液静水压力 $P_i$ 之差。\n净有效胶体渗透压力是反射系数 $\\sigma$ 与毛细血管胶体渗透压 $\\pi_c$ 和组织间液胶体渗透压 $\\pi_i$ 之差的乘积。\n\n因此，局部通量由 Starling 方程给出：\n$$ \\frac{dQ}{dx} = k \\left[ (P_c(x) - P_i) - \\sigma(\\pi_c - \\pi_i) \\right] $$\n\n问题指出，毛细血管内静水压力 $P_c(x)$ 沿毛细血管长度 $L$ 从动脉小头端 ($x=0$) 到静脉小头端 ($x=L$) 线性下降。动脉小头端的压力为 $P_c(0) = P_a$，静脉小头端的压力为 $P_c(L) = P_v$。在区间 $x \\in [0, L]$ 上，$P_c(x)$ 的线性函数为：\n$$ P_c(x) = P_a + \\frac{P_v - P_a}{L} x $$\n\n其余的压力（$P_i$、$\\pi_c$、$\\pi_i$）和系数（$\\sigma$、$k$）被给出为均匀常数。将 $P_c(x)$ 的表达式代入 Starling 方程得到：\n$$ \\frac{dQ}{dx} = k \\left[ \\left( P_a + \\frac{P_v - P_a}{L} x \\right) - P_i - \\sigma(\\pi_c - \\pi_i) \\right] $$\n\n为了求出整个毛细血管段的总净体积通量 $Q$，我们必须将这个单位长度的局部通量从 $x=0$ 积分到 $x=L$：\n$$ Q = \\int_{0}^{L} \\frac{dQ}{dx} dx = \\int_{0}^{L} k \\left[ P_a + \\frac{P_v - P_a}{L} x - P_i - \\sigma(\\pi_c - \\pi_i) \\right] dx $$\n\n由于 $k$ 是一个常数，我们可以将其移到积分符号外。被积函数是 $x$ 的线性函数。\n$$ Q = k \\int_{0}^{L} \\left[ (P_a - P_i - \\sigma(\\pi_c - \\pi_i)) + \\left(\\frac{P_v - P_a}{L}\\right) x \\right] dx $$\n\n对 $x$ 进行积分：\n$$ Q = k \\left[ (P_a - P_i - \\sigma(\\pi_c - \\pi_i))x + \\left(\\frac{P_v - P_a}{L}\\right)\\frac{x^2}{2} \\right]_{0}^{L} $$\n\n在积分上下限 $x=L$ 和 $x=0$ 处求定积分的值：\n$$ Q = k \\left( \\left[ (P_a - P_i - \\sigma(\\pi_c - \\pi_i))L + \\frac{P_v - P_a}{L}\\frac{L^2}{2} \\right] - [0] \\right) $$\n$$ Q = k \\left[ (P_a - P_i - \\sigma(\\pi_c - \\pi_i))L + \\frac{(P_v - P_a)L}{2} \\right] $$\n\n我们可以提出长度 $L$：\n$$ Q = k L \\left[ P_a - P_i - \\sigma(\\pi_c - \\pi_i) + \\frac{P_v - P_a}{2} \\right] $$\n重新整理括号内的项：\n$$ Q = k L \\left[ \\frac{2P_a + P_v - P_a}{2} - P_i - \\sigma(\\pi_c - \\pi_i) \\right] $$\n$$ Q = k L \\left[ \\frac{P_a + P_v}{2} - P_i - \\sigma(\\pi_c - \\pi_i) \\right] $$\n这就是推导出的总净通量的解析表达式。它表明总通量与总滤过能力（$kL$）和使用平均毛细血管静水压力 $\\bar{P}_c = \\frac{P_a + P_v}{2}$ 计算的净驱动压力的乘积成正比。\n\n现在，我们代入给定的数值：\n毛细血管长度: $L = 1.0$ mm\n动脉小头端压力: $P_{a} = 35$ mmHg\n静脉小头端压力: $P_{v} = 15$ mmHg\n组织间液静水压力: $P_{i} = 3$ mmHg\n毛细血管胶体渗透压: $\\pi_{c} = 25$ mmHg\n组织间液胶体渗透压: $\\pi_{i} = 5$ mmHg\n反射系数: $\\sigma = 0.90$\n单位长度滤过系数: $k = 2.0 \\times 10^{-6}$ mL/(min·mmHg·mm)\n\n首先，计算平均毛细血管静水压力：\n$$ \\bar{P}_c = \\frac{P_a + P_v}{2} = \\frac{35 + 15}{2} = \\frac{50}{2} = 25 \\text{ mmHg} $$\n\n接下来，计算有效胶体渗透压差：\n$$ \\sigma(\\pi_c - \\pi_i) = 0.90 \\times (25 - 5) = 0.90 \\times 20 = 18 \\text{ mmHg} $$\n\n现在，将这些值代入推导出的 $Q$ 的表达式中：\n$$ Q = k L \\left[ \\bar{P}_c - P_i - \\sigma(\\pi_c - \\pi_i) \\right] $$\n$$ Q = (2.0 \\times 10^{-6}) \\times (1.0) \\times [25 - 3 - 18] $$\n$$ Q = (2.0 \\times 10^{-6}) \\times (1.0) \\times [4] $$\n$$ Q = 8.0 \\times 10^{-6} \\text{ mL/min} $$\n\n问题要求答案四舍五入到三位有效数字。\n$$ Q = 8.00 \\times 10^{-6} \\text{ mL/min} $$\n正号表示流体从毛细血管净滤出到组织间隙。",
            "answer": "$$\\boxed{8.00 \\times 10^{-6}}$$"
        },
        {
            "introduction": "从微观循环转向宏观系统，我们来探讨大动脉在维持稳定血流中的关键作用。“风箱模型”（Windkessel model）是一个经典且强大的简化模型，它将大动脉的弹性储能功能比作一个空气室，有效缓冲了心脏搏动射血所产生的压力脉动。在本练习中，您将从基本物理原理（如体积守恒）出发，推导和计算动脉系统中的压力 ()。这项实践将使您亲身体验如何运用数学和物理学工具来揭示心血管系统的动态行为。",
            "id": "4949372",
            "problem": "将一个健康的成年人模型化为一个集总参数动脉系统，其中大的弹性动脉表现为一个单一的顺应性腔室，该腔室接收来自左心室的搏动性血流，并通过一个单一的下游阻力排向压力可忽略不计的静脉储血库。假设顺应性为线性，血流为层流，并且在整个心动周期内阻力和顺应性恒定。\n\n心率为每分钟$75$次，由此可得心动周期为$T$秒。左心室在$0.30$秒的收缩射血时间内射出$70$毫升的每搏输出量，收缩期进入动脉腔室的血流被建模为恒定流量，而舒张期没有血流进入。总外周阻力为$1.10$ mmHg·s/mL，大动脉顺应性为$1.60$ mL/mmHg。将该系统视为一个二元件Windkessel模型：一个单一的顺应性元件$C$连接到一个单一的阻力元件$R$，静脉压近似为零。\n\n利用顺应性腔室内的体积守恒和线性本构关系，从第一性原理推导该模型的稳态周期性收缩末期动脉压（收缩射血结束时的峰值压力）。然后计算其数值。\n\n将您的答案四舍五入到四位有效数字。压力以mmHg为单位表示。您的最终答案必须是一个数字。",
            "solution": "本题要求解二元件Windkessel模型在稳态周期性条件下的收缩末期动脉压。我们将从体积守恒的基本原理出发，建立并求解描述动脉压随时间变化的微分方程。\n\n**1. 建立控制微分方程**\n\n分析基于顺应性动脉腔室内的体积守恒原理。顺应性元件中储存的体积变化率 $\\frac{dV}{dt}$ 等于流入该腔室的血流速率 $Q_{in}(t)$ 减去流出该腔室的血流速率 $Q_{out}(t)$：\n$$ \\frac{dV}{dt} = Q_{in}(t) - Q_{out}(t) $$\n\n根据模型假设，我们有以下两个本构关系：\n1.  动脉腔室储存的体积 $V(t)$ 与动脉压 $P(t)$ 呈线性关系：$V(t) = C \\cdot P(t)$。假设顺应性 $C$ 为常数，对时间求导得到 $\\frac{dV}{dt} = C \\frac{dP}{dt}$。\n2.  通过外周阻力的流出量 $Q_{out}(t)$ 遵循欧姆定律：$Q_{out}(t) = \\frac{P(t) - P_{venous}}{R}$。由于静脉压 $P_{venous}$ 近似为零，这简化为 $Q_{out}(t) = \\frac{P(t)}{R}$。\n\n将这些关系代入体积守恒方程，得到关于动脉压 $P(t)$ 的一阶线性常微分方程：\n$$ C \\frac{dP}{dt} = Q_{in}(t) - \\frac{P(t)}{R} $$\n整理成标准形式：\n$$ \\frac{dP}{dt} + \\frac{1}{RC}P(t) = \\frac{1}{C}Q_{in}(t) $$\n我们定义动脉系统的时间常数 $\\tau = RC$。\n\n**2. 分阶段求解方程**\n\n首先，计算心动周期的总时长 $T$：\n$$ T = \\frac{60 \\text{ s/min}}{75 \\text{ beats/min}} = 0.8 \\text{ s} $$\n\n**收缩期 ($0 \\le t \\le T_s$)：**\n在此期间，流入动脉系统的血流为恒定速率 $Q_s$。\n$$ Q_s = \\frac{V_{stroke}}{T_s} = \\frac{70 \\text{ mL}}{0.30 \\text{ s}} = \\frac{700}{3} \\text{ mL/s} $$\n微分方程为：$\\frac{dP}{dt} + \\frac{1}{\\tau}P(t) = \\frac{Q_s}{C}$。\n该方程的通解为齐次解与特解之和：$P_{sys}(t) = A e^{-t/\\tau} + R Q_s$。设 $P(0) = P_d$（舒张末期压力），代入可求得积分常数 $A = P_d - R Q_s$。\n因此，收缩期的压力方程为：\n$$ P_{sys}(t) = R Q_s + (P_d - R Q_s) e^{-t/\\tau} $$\n收缩末期压力 $P_s$ 是 $t = T_s$ 时的压力：\n$$ P_s = R Q_s + (P_d - R Q_s) e^{-T_s/\\tau} \\quad (1) $$\n\n**舒张期 ($T_s < t \\le T$)：**\n在此期间，没有血液流入，即 $Q_{in}(t) = 0$。舒张期持续时间为 $T_d = T - T_s = 0.8 - 0.3 = 0.5$ s。\n微分方程为：$\\frac{dP}{dt} + \\frac{1}{\\tau}P(t) = 0$。\n其解为指数衰减形式：$P_{dias}(t') = B e^{-t'/\\tau}$，其中 $t' = t - T_s$。初始条件为 $P_{dias}(0) = P_s$，因此 $B=P_s$。\n舒张期的压力方程为：\n$$ P_{dias}(t') = P_s e^{-t'/\\tau} $$\n\n**3. 应用稳态周期性条件**\n\n在稳态下，一个心动周期结束时的压力等于下一个周期开始时的压力。即舒张期结束时的压力等于舒张末期压力 $P_d$：\n$$ P_d = P_{dias}(T_d) = P_s e^{-T_d/\\tau} \\quad (2) $$\n\n**4. 求解收缩末期压力 $P_s$**\n\n我们得到了一个关于两个未知数 $P_s$ 和 $P_d$ 的方程组（方程1和2）。将方程(2)代入方程(1)以消去 $P_d$：\n$$ P_s = R Q_s + (P_s e^{-T_d/\\tau} - R Q_s) e^{-T_s/\\tau} $$\n$$ P_s = R Q_s + P_s e^{-(T_s+T_d)/\\tau} - R Q_s e^{-T_s/\\tau} $$\n注意到 $T_s + T_d = T$，整理可得：\n$$ P_s (1 - e^{-T/\\tau}) = R Q_s (1 - e^{-T_s/\\tau}) $$\n最终，得到收缩末期压力 $P_s$ 的解析表达式：\n$$ P_s = R Q_s \\frac{1 - e^{-T_s/\\tau}}{1 - e^{-T/\\tau}} $$\n\n**5. 数值计算**\n\n代入给定参数：\n- $R = 1.10$ mmHg·s/mL\n- $C = 1.60$ mL/mmHg\n- $T = 0.8$ s\n- $T_s = 0.30$ s\n- $Q_s = \\frac{700}{3}$ mL/s\n\n首先，计算时间常数 $\\tau$ 和乘积 $R Q_s$：\n$$ \\tau = RC = (1.10) (1.60) = 1.76 \\text{ s} $$\n$$ R Q_s = (1.10) \\left(\\frac{700}{3}\\right) = \\frac{770}{3} \\text{ mmHg} $$\n然后，计算指数项的幂：\n$$ -\\frac{T_s}{\\tau} = -\\frac{0.30}{1.76} \\approx -0.1704545 $$\n$$ -\\frac{T}{\\tau} = -\\frac{0.8}{1.76} \\approx -0.4545454 $$\n将这些值代入 $P_s$ 的表达式：\n$$ P_s = \\frac{770}{3} \\times \\frac{1 - e^{-0.1704545}}{1 - e^{-0.4545454}} $$\n$$ P_s \\approx 256.6667 \\times \\frac{1 - 0.8432853}{1 - 0.6347341} $$\n$$ P_s \\approx 256.6667 \\times \\frac{0.1567147}{0.3652659} \\approx 110.123 \\text{ mmHg} $$\n\n根据题目要求，将答案四舍五入到四位有效数字：\n$$ P_s = 110.1 \\text{ mmHg} $$",
            "answer": "$$\\boxed{110.1}$$"
        },
        {
            "introduction": "心血管系统的最终目标是维持体内稳态，即使在面临出血或剧烈运动等巨大扰动时也能确保关键器官的灌注。这个终极练习将引导您构建一个闭环的血压调控模型，以模拟压力感受器反射（baroreflex）这一短期调节的关键机制 ()。通过编写程序来求解在不同生理挑战下的稳态动脉压，您将把前面学到的关于压力、流量和阻力的概念整合到一个动态的反馈控制系统中。这不仅能加深您对心血管生理学集成特性的理解，还能展示计算建模在解决复杂生理问题中的威力。",
            "id": "4949398",
            "problem": "您将构建一个简约且符合生理学的短期动脉血压调节闭环模型，以量化心血管系统在受到扰动时如何维持稳态。该模型必须反映心脏与脉管系统之间的耦合以及压力反射介导的传出反应。您的任务是仅使用此处陈述的原理和普适科学定律，推导、实施并求解稳态平均动脉压，而非使用任何预先指定的目标公式。\n\n基本原理和建模假设：\n- 血流动力学欧姆定律：全身循环的压力-流量关系遵循 $P = Q \\cdot R$，其中 $P$ 是平均动脉压，单位为 $\\text{mmHg}$，$Q$ 是心输出量，单位为 $\\text{L}\\,\\text{min}^{-1}$，$R$ 是总外周阻力，单位为 $\\text{mmHg}\\cdot\\text{min}\\cdot\\text{L}^{-1}$。\n- 心输出量等于心率乘以每搏输出量：$Q = \\text{HR}\\cdot \\text{SV}$，其中 $\\text{HR}$ 的单位为 $\\text{beats}\\,\\text{min}^{-1}$，$\\text{SV}$ 的单位为 $\\text{L}\\,\\text{beat}^{-1}$。\n- 短期压力反射控制通过围绕设定点压力的效应器的线性调制来近似。这些是围绕操作点的稳态、静态关系（无动力学或延迟），每个关系都被限制在生理上合理的范围内：\n  - 心率 (HR)：$\\text{HR}(P) = \\mathrm{clip}\\!\\left(\\text{HR}_{0} + k_{\\text{hr}}\\left(P_{\\text{set}} - P\\right),\\, \\text{HR}_{\\min},\\, \\text{HR}_{\\max}\\right)$。\n  - 每搏输出量 (SV)：$\\text{SV}(P, V_{\\text{rel}}) = \\mathrm{clip}\\!\\left(\\text{SV}_{0} + k_{\\text{sv}}\\left(P_{\\text{set}} - P\\right) + k_{v}\\left(V_{\\text{rel}} - 1\\right),\\, \\text{SV}_{\\min},\\, \\text{SV}_{\\max}\\right)$。此处 $V_{\\text{rel}}$ 是相对循环血量（无量纲），其中 $V_{\\text{rel}} = 1$ 表示基线血量，$V_{\\text{rel}} < 1$ 表示出血，$V_{\\text{rel}} > 1$ 表示输液。\n  - 总外周阻力 (TPR，记为 $R$)：$R(P, \\Delta R_{\\text{exo}}) = \\mathrm{clip}\\!\\left(R_{0} + \\Delta R_{\\text{exo}} + k_{R}\\left(P_{\\text{set}} - P\\right),\\, R_{\\min},\\, R_{\\max}\\right)$，其中 $\\Delta R_{\\text{exo}}$ 代表外源性血管舒张或血管收缩（例如，运动驱动的血管舒张导致 $\\Delta R_{\\text{exo}} < 0$）。\n- 限幅值强制执行生理界限：\n  - $\\text{HR}_{\\min} = 40\\,\\text{beats}\\,\\text{min}^{-1}$，$\\text{HR}_{\\max} = 180\\,\\text{beats}\\,\\text{min}^{-1}$。\n  - $\\text{SV}_{\\min} = 0.03\\,\\text{L}\\,\\text{beat}^{-1}$，$\\text{SV}_{\\max} = 0.12\\,\\text{L}\\,\\text{beat}^{-1}$。\n  - $R_{\\min} = 8.0\\,\\text{mmHg}\\cdot\\text{min}\\cdot\\text{L}^{-1}$，$R_{\\max} = 30.0\\,\\text{mmHg}\\cdot\\text{min}\\cdot\\text{L}^{-1}$。\n\n基线参数（静息、健康成年人）：\n- 设定点压力：$P_{\\text{set}} = 93.0\\,\\text{mmHg}$。\n- 基线心率：$\\text{HR}_{0} = 70.0\\,\\text{beats}\\,\\text{min}^{-1}$。\n- 基线每搏输出量：$\\text{SV}_{0} = 0.07\\,\\text{L}\\,\\text{beat}^{-1}$。\n- 基线心输出量：$Q_{0} = \\text{HR}_{0}\\cdot \\text{SV}_{0} = 4.9\\,\\text{L}\\,\\text{min}^{-1}$。\n- 与设定点一致的基线阻力：$R_{0} = \\dfrac{P_{\\text{set}}}{Q_{0}} = 18.9795918367\\,\\text{mmHg}\\cdot\\text{min}\\cdot\\text{L}^{-1}$。\n- 操作点附近的压力反射增益：\n  - $k_{\\text{hr}} = 0.5\\,\\text{beats}\\,\\text{min}^{-1}\\,\\text{mmHg}^{-1}$，\n  - $k_{\\text{sv}} = 3.0\\times 10^{-4}\\,\\text{L}\\,\\text{beat}^{-1}\\,\\text{mmHg}^{-1}$，\n  - $k_{R} = 0.25\\,\\text{min}\\cdot\\text{L}^{-1}$，\n  - 容量-每搏输出量敏感度：$k_{v} = 0.10\\,\\text{L}\\,\\text{beat}^{-1}$ 每单位相对容量。\n\n任务：\n- 仅使用上述基本原理，推导出一个标量稳态条件，该条件确定在由 $(V_{\\text{rel}}, \\Delta R_{\\text{exo}})$ 指定的给定扰动下，平均动脉压 $P$ 作为压力反射控制的效应器 $\\text{HR}(P)$、$\\text{SV}(P, V_{\\text{rel}})$ 和 $R(P, \\Delta R_{\\text{exo}})$ 的函数。不要假设或使用任何未提供的捷径关系。\n- 证明您推导的条件可以作为一个关于 $P$ 的一维求根问题来解决。\n- 实现一个数值稳健的求解器，通过在区间 $[P_{\\text{low}}, P_{\\text{high}}] = [20.0, 200.0]\\,\\text{mmHg}$ 上求解推导出的标量方程，计算下面每个测试用例的稳态 $P$，公差不大于 $10^{-6}\\,\\text{mmHg}$。鉴于反馈结构和限幅所预期的单调性，您可以使用如二分法之类的区间法。\n- 对于每个测试用例，输出稳态平均动脉压，单位为 $\\text{mmHg}$，四舍五入到一位小数。\n\n测试套件（每个案例为 $(V_{\\text{rel}}, \\Delta R_{\\text{exo}})$）：\n- 案例 1：$(1.0,\\, 0.0)$ 基线静息状态。\n- 案例 2：$(0.9,\\, 0.0)$ 轻度出血。\n- 案例 3：$(0.7,\\, 0.0)$ 重度出血。\n- 案例 4：$(1.0,\\, -6.0)$ 中度运动性血管舒张。\n- 案例 5：$(0.85,\\, -4.0)$ 轻度出血合并轻度运动性血管舒张。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件中的顺序相同，例如 $[x_{1},x_{2},x_{3},x_{4},x_{5}]$，其中每个 $x_{i}$ 是稳态平均动脉压，单位为 $\\text{mmHg}$，四舍五入到一位小数。",
            "solution": "### 稳态条件的推导\n\n本题旨在寻找描述短期血压调节的闭环模型的稳态平衡点。系统的核心是心脏（泵）与体循环脉管系统（阻力）之间的相互作用，其关系由血流动力学欧姆定律描述：\n$$ P = Q \\cdot R $$\n其中，$P$ 是平均动脉压，$Q$ 是心输出量，$R$ 是总外周阻力。\n\n心输出量 $Q$ 定义为心率 ($\\text{HR}$) 和每搏输出量 ($\\text{SV}$) 的乘积：\n$$ Q = \\text{HR} \\cdot \\text{SV} $$\n\n将 $Q$ 的表达式代入欧姆定律，得到系统状态的核心方程：\n$$ P = \\left(\\text{HR} \\cdot \\text{SV}\\right) \\cdot R $$\n\n在这个闭环模型中，效应器变量 $\\text{HR}$、$\\text{SV}$ 和 $R$ 并非独立的常数，而是由压力感受器反射介导的、本身是平均动脉压 $P$ 的函数。正是这种负反馈使得系统能够围绕一个设定点压力 $P_{\\text{set}}$ 维持稳态。问题给出了这些控制关系的函数形式：\n$$ \\text{HR} = \\text{HR}(P) $$\n$$ \\text{SV} = \\text{SV}(P, V_{\\text{rel}}) $$\n$$ R = R(P, \\Delta R_{\\text{exo}}) $$\n\n当系统处于稳态时，压力 $P$ 必须满足核心方程，其中 $\\text{HR}$、$\\text{SV}$ 和 $R$ 由相同的压力 $P$ 和给定的外部扰动 $(V_{\\text{rel}}, \\Delta R_{\\text{exo}})$ 共同决定。因此，我们将效应器的函数形式代入核心方程，得到一个关于未知变量 $P$ 的单一、标量、非线性方程，即稳态条件：\n$$ P = \\text{HR}(P) \\cdot \\text{SV}(P, V_{\\text{rel}}) \\cdot R(P, \\Delta R_{\\text{exo}}) $$\n\n为了进行数值求解，我们通常将此方程重新表述为一个求根问题。定义一个函数 $f(P)$，其根 $P_{ss}$ 即为我们寻求的稳态压力：\n$$ f(P, V_{\\text{rel}}, \\Delta R_{\\text{exo}}) = P - \\text{HR}(P) \\cdot \\text{SV}(P, V_{\\text{rel}}) \\cdot R(P, \\Delta R_{\\text{exo}}) = 0 $$\n\n### 数值求解方法的合理性\n\n我们可以使用如二分法之类的区间法来可靠地求解此方程。为证明这一点，需要分析函数 $f(P)$ 的性质。\n\n我们将效应器的乘积项记为 $G(P) = \\text{HR}(P) \\cdot \\text{SV}(P, V_{\\text{rel}}) \\cdot R(P, \\Delta R_{\\text{exo}})$。则求根函数为 $f(P) = P - G(P)$。\n\n根据模型定义，压力反射的增益 $k_{\\text{hr}}$, $k_{\\text{sv}}$, 和 $k_{R}$ 均为正值，且控制逻辑均基于误差项 $(P_{\\text{set}} - P)$。这意味着，随着压力 $P$ 的升高，$\\text{HR}$, $\\text{SV}$, 和 $R$ 的未限幅值都会减小。由于限幅（clip）函数是单调非递减的，因此其输出 $\\text{HR}(P)$, $\\text{SV}(P)$, 和 $R(P)$ 都是关于 $P$ 的单调非增函数。\n\n由于所有生理参数均被限制为正值，它们的乘积 $G(P)$ 也必然是关于 $P$ 的一个正的、单调非增函数。\n\n我们要求解其根的函数是 $f(P) = P - G(P)$。它对 $P$ 的导数是：\n$$ f'(P) = \\frac{d}{dP} (P - G(P)) = 1 - G'(P) $$\n因为 $G(P)$ 是一个非增函数，其导数 $G'(P)$ 在其定义域内必然小于或等于零。因此，$f'(P) = 1 - (\\text{一个非正值}) \\geq 1$。\n\n由于对所有 $P$ 都有 $f'(P) > 0$，所以 $f(P)$ 是一个关于 $P$ 的严格单调递增函数。一个连续且严格单调递增的函数，最多只有一个根，这保证了根的唯一性。\n\n此外，我们可以验证在给定的区间 $[20.0, 200.0]\\,\\text{mmHg}$ 内存在一个根。\n- 在 $P=20$ 时，压力远低于设定点，$P_{\\text{set}}-P$ 是一个大的正数，压力反射将使效应器达到或接近其最大值，导致 $G(20)$ 很大，从而 $f(20) = 20 - G(20)$ 是一个负数。\n- 在 $P=200$ 时，压力远高于设定点，$P_{\\text{set}}-P$ 是一个大的负数，压力反射将使效应器达到其最小值，导致 $G(200)$ 相对较小，从而 $f(200) = 200 - G(200)$ 是一个正数。\n\n根据介值定理，一个在区间两端异号的连续函数，在该区间内必有至少一个根。结合单调性，我们可以断定在 $[20, 200]$ 区间内存在唯一的根。\n\n因此，二分法是寻找这个根的一个稳健且合适的数值方法。下面的答案部分提供的Python代码实现了这一求解过程，并计算了所有测试用例的稳态压力。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and solves for the steady-state mean arterial pressure in a \n    closed-loop cardiovascular model.\n    \"\"\"\n\n    # --- Model Parameters ---\n    params = {\n        # Baseline parameters\n        \"P_set\": 93.0,          # mmHg, setpoint pressure\n        \"HR_0\": 70.0,           # beats/min, baseline heart rate\n        \"SV_0\": 0.07,           # L/beat, baseline stroke volume\n        # Note: Q_0 = HR_0 * SV_0 = 4.9 L/min\n        # Note: R_0 = P_set / Q_0 = 93.0 / 4.9 = 18.9795918367\n        \"R_0\": 18.979591836734693, # mmHg*min/L, baseline resistance\n\n        # Baroreflex gains\n        \"k_hr\": 0.5,            # (beats/min)/mmHg\n        \"k_sv\": 3.0e-4,         # (L/beat)/mmHg\n        \"k_R\": 0.25,            # (mmHg*min/L)/mmHg = min/L\n        \"k_v\": 0.10,            # L/beat per unit relative volume\n\n        # Physiological clipping limits\n        \"HR_min\": 40.0,         # beats/min\n        \"HR_max\": 180.0,        # beats/min\n        \"SV_min\": 0.03,         # L/beat\n        \"SV_max\": 0.12,         # L/beat\n        \"R_min\": 8.0,           # mmHg*min/L\n        \"R_max\": 30.0,          # mmHg*min/L\n    }\n\n    # --- Effector Functions ---\n    \n    def get_hr(P, p):\n        \"\"\"Calculates Heart Rate as a function of pressure P.\"\"\"\n        val = p[\"HR_0\"] + p[\"k_hr\"] * (p[\"P_set\"] - P)\n        return np.clip(val, p[\"HR_min\"], p[\"HR_max\"])\n\n    def get_sv(P, V_rel, p):\n        \"\"\"Calculates Stroke Volume as a function of P and relative volume V_rel.\"\"\"\n        val = p[\"SV_0\"] + p[\"k_sv\"] * (p[\"P_set\"] - P) + p[\"k_v\"] * (V_rel - 1.0)\n        return np.clip(val, p[\"SV_min\"], p[\"SV_max\"])\n\n    def get_r(P, dR_exo, p):\n        \"\"\"Calculates Total Peripheral Resistance as a function of P and exogenous change dR_exo.\"\"\"\n        val = p[\"R_0\"] + dR_exo + p[\"k_R\"] * (p[\"P_set\"] - P)\n        return np.clip(val, p[\"R_min\"], p[\"R_max\"])\n    \n    # --- Root-finding problem formulation ---\n\n    def objective_function(P, V_rel, dR_exo, p):\n        \"\"\"\n        The root of this function f(P) = 0 gives the steady-state pressure.\n        f(P) = P - (HR(P) * SV(P) * R(P))\n        \"\"\"\n        hr = get_hr(P, p)\n        sv = get_sv(P, V_rel, p)\n        r = get_r(P, dR_exo, p)\n        \n        return P - hr * sv * r\n\n    # --- Numerical Solver ---\n        \n    def bisection_solver(func, a, b, tol=1e-7, max_iter=100):\n        \"\"\"\n        Finds the root of a function `func` within the bracket [a, b]\n        using the bisection method.\n        \"\"\"\n        fa = func(a)\n        fb = func(b)\n        \n        if np.sign(fa) == np.sign(fb):\n            raise ValueError(\"Root not bracketed or multiple roots exist.\")\n            \n        for _ in range(max_iter):\n            mid = (a + b) / 2.0\n            f_mid = func(mid)\n            \n            if (b - a) / 2.0  tol:\n                return mid\n            \n            if np.sign(fa) != np.sign(f_mid):\n                b = mid\n            else:\n                a = mid\n                fa = f_mid\n        \n        return (a + b) / 2.0\n\n    # --- Test Cases ---\n    test_cases = [\n        (1.0, 0.0),   # Case 1: Baseline rest\n        (0.9, 0.0),   # Case 2: Mild hemorrhage\n        (0.7, 0.0),   # Case 3: Severe hemorrhage\n        (1.0, -6.0),  # Case 4: Moderate exercise vasodilation\n        (0.85, -4.0)  # Case 5: Combined hemorrhage and vasodilation\n    ]\n\n    results = []\n    P_low, P_high = 20.0, 200.0 # Search bracket for pressure\n    tolerance = 1e-7\n\n    for V_rel, dR_exo in test_cases:\n        # Create a single-variable function for the solver\n        f_to_solve = lambda p_val: objective_function(p_val, V_rel, dR_exo, params)\n        \n        # Solve for steady-state pressure\n        P_steady_state = bisection_solver(f_to_solve, P_low, P_high, tol=tolerance)\n        \n        # Round and append result\n        results.append(round(P_steady_state, 1))\n\n    # --- Final Output ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}