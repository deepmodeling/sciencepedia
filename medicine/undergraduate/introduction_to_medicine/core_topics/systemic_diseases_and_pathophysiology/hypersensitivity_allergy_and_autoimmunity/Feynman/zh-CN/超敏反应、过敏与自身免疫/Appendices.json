{
    "hands_on_practices": [
        {
            "introduction": "I型超敏反应，即我们常说的过敏，其核心事件是肥大细胞的脱颗粒。这一过程由过敏原交联结合在肥大细胞表面的免疫球蛋白E（$IgE$）抗体触发，从而释放出组胺等炎性介质。这个练习 () 引导我们运用化学动力学基本定律，将分子结合速率（$k_{\\text{on}}$ 和 $k_{\\text{off}}$）与细胞的生理反应联系起来，计算触发脱颗粒所需的时间。通过这种方式，我们可以量化地理解为何过敏反应会如此迅速地发生。",
            "id": "4964937",
            "problem": "一位有特应性病史的患者经历了由免疫球蛋白E（IgE）介导的快速发作的I型超敏反应。在组织中，肥大细胞表达与高亲和力Fc epsilon受体I（FcεRI）结合的IgE。一种多价过敏原突然扩散到组织中，并维持恒定的细胞外浓度。过敏原引起的IgE-FcεRI交联会引发脱颗粒。在此情景下，假设以下基于生物物理的近似：一旦被过敏原占据的、与FcεRI结合的IgE的比例达到阈值分数$p_{\\mathrm{th}}$，脱颗粒就会被可靠地触发，这反映了当占据率足够高时，会发生充分的交联。在时间 $t=0$ 时，过敏原浓度突然跃升然后保持恒定，且所有受体最初都未被占据。\n\n使用恒定配体浓度下受体-配体结合的质量作用定律作为你的出发点。过敏原浓度为 $C = 5.0 \\times 10^{-9}$ M。过敏原与受体结合的IgE的结合（on）速率常数为 $k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$，解离（off）速率常数为 $k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$。脱颗粒阈值为 $p_{\\mathrm{th}} = 0.25$。假设环境充分混合，$C$ 随时间恒定，并且每个受体的占据动力学遵循单一位点可逆结合过程。\n\n从第一性原理推导出受体占据率达到 $p_{\\mathrm{th}}$ 所需的时间 $t^{\\ast}$，并计算其数值。以秒为单位表示最终时间，并将你的答案四舍五入到四位有效数字。",
            "solution": "经评估，问题陈述是有效的，因为它在科学上基于化学动力学和免疫学原理，问题设定良好，信息充分，目标明确，并且没有任何使其无效的缺陷。\n\n问题要求计算在引入恒定浓度的配体（过敏原）后，一部分受体的占据比例 $p(t)$ 达到阈值 $p_{\\mathrm{th}}$ 所需的时间 $t^{\\ast}$。该结合被建模为单一位点可逆过程。\n\n令 $R$ 表示未结合的IgE-FcεRI复合物，$A$ 表示过敏原。过敏原结合的复合物 $RA$ 的形成由以下反应描述：\n$$ R + A \\underset{k_{\\mathrm{off}}}{\\stackrel{k_{\\mathrm{on}}}{\\rightleftharpoons}} RA $$\n其中 $k_{\\mathrm{on}}$ 是结合速率常数，$k_{\\mathrm{off}}$ 是解离速率常数。\n\n结合复合物浓度 $[RA]$ 的变化速率由质量作用定律给出：\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}[R][A] - k_{\\mathrm{off}}[RA] $$\n问题陈述过敏原浓度是恒定的，所以我们设 $[A] = C$。\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C[R] - k_{\\mathrm{off}}[RA] $$\n受体总浓度 $[R_T]$ 是恒定的，并且是未结合受体和结合受体浓度之和：$[R_T] = [R] + [RA]$。因此，我们可以将 $[R]$ 表示为 $[R] = [R_T] - [RA]$。将此代入速率方程得到：\n$$ \\frac{d[RA]}{dt} = k_{\\mathrm{on}}C([R_T] - [RA]) - k_{\\mathrm{off}}[RA] $$\n受体的占据比例定义为 $p(t) = \\frac{[RA]}{[R_T]}$。由此，我们有 $[RA] = p(t)[R_T]$。对时间求导，并注意到 $[R_T]$ 是常数，我们得到 $\\frac{d[RA]}{dt} = [R_T]\\frac{dp}{dt}$。\n\n将 $[RA]$ 及其导数的这些表达式代入速率方程：\n$$ [R_T]\\frac{dp}{dt} = k_{\\mathrm{on}}C([R_T] - p(t)[R_T]) - k_{\\mathrm{off}}(p(t)[R_T]) $$\n受体总浓度 $[R_T]$ 是一个公因子，可以从方程中消去：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C(1 - p) - k_{\\mathrm{off}}p $$\n这是一个关于占据比例 $p(t)$ 的一阶线性常微分方程。我们可以通过组合包含 $p$ 的项来重新整理它：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - (k_{\\mathrm{on}}C + k_{\\mathrm{off}})p $$\n我们定义表观伪一级速率常数，$k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}}$。方程变为：\n$$ \\frac{dp}{dt} = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p $$\n在平衡状态下（$t \\to \\infty$），净速率为零（$\\frac{dp}{dt} = 0$），占据率达到其平衡值 $p_{\\mathrm{eq}}$。\n$$ 0 = k_{\\mathrm{on}}C - k_{\\mathrm{obs}}p_{\\mathrm{eq}} \\implies p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{obs}}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} $$\n我们可以用 $p_{\\mathrm{eq}}$ 和 $k_{\\mathrm{obs}}$ 来重写这个微分方程：\n$$ \\frac{dp}{dt} = k_{\\mathrm{obs}}p_{\\mathrm{eq}} - k_{\\mathrm{obs}}p = -k_{\\mathrm{obs}}(p - p_{\\mathrm{eq}}) $$\n为了解这个方程，我们使用分离变量法，初始条件为在 $t=0$ 时，受体未被占据，即 $p(0)=0$。\n$$ \\int_{p(0)}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = \\int_{0}^{t} -k_{\\mathrm{obs}} dt' $$\n$$ \\int_{0}^{p(t)} \\frac{dp'}{p' - p_{\\mathrm{eq}}} = -k_{\\mathrm{obs}} t $$\n$$ \\left[ \\ln|p' - p_{\\mathrm{eq}}| \\right]_{0}^{p(t)} = -k_{\\mathrm{obs}} t $$\n$$ \\ln|p(t) - p_{\\mathrm{eq}}| - \\ln|-p_{\\mathrm{eq}}| = -k_{\\mathrm{obs}} t $$\n由于对于任何有限时间 $t$，$p(t)  p_{\\mathrm{eq}}$，所以 $|p(t) - p_{\\mathrm{eq}}| = p_{\\mathrm{eq}} - p(t)$。\n$$ \\ln\\left(\\frac{p_{\\mathrm{eq}} - p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\n$$ \\ln\\left(1 - \\frac{p(t)}{p_{\\mathrm{eq}}}\\right) = -k_{\\mathrm{obs}}t $$\n解出 $p(t)$：\n$$ 1 - \\frac{p(t)}{p_{\\mathrm{eq}}} = \\exp(-k_{\\mathrm{obs}}t) $$\n$$ p(t) = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t)\\right) $$\n我们需要找到使 $p(t^{\\ast}) = p_{\\mathrm{th}}$ 成立的时间 $t^{\\ast}$。\n$$ p_{\\mathrm{th}} = p_{\\mathrm{eq}}\\left(1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast})\\right) $$\n解出 $t^{\\ast}$：\n$$ \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} = 1 - \\exp(-k_{\\mathrm{obs}}t^{\\ast}) $$\n$$ \\exp(-k_{\\mathrm{obs}}t^{\\ast}) = 1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}} $$\n$$ -k_{\\mathrm{obs}}t^{\\ast} = \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{k_{\\mathrm{obs}}} \\ln\\left(1 - \\frac{p_{\\mathrm{th}}}{p_{\\mathrm{eq}}}\\right) $$\n这就是达到阈值所需时间的符号表达式。\n\n现在，我们代入给定的数值：\n$C = 5.0 \\times 10^{-9}$ M\n$k_{\\mathrm{on}} = 2.0 \\times 10^{5}$ M$^{-1}$ s$^{-1}$\n$k_{\\mathrm{off}} = 2.0 \\times 10^{-3}$ s$^{-1}$\n$p_{\\mathrm{th}} = 0.25$\n\n首先，我们计算中间项 $k_{\\mathrm{obs}}$ 和 $p_{\\mathrm{eq}}$。\n乘积 $k_{\\mathrm{on}}C$ 是：\n$$ k_{\\mathrm{on}}C = (2.0 \\times 10^{5} \\, \\mathrm{M}^{-1}\\mathrm{s}^{-1}) \\times (5.0 \\times 10^{-9} \\, \\mathrm{M}) = 10.0 \\times 10^{-4} \\, \\mathrm{s}^{-1} = 1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\n表观速率常数 $k_{\\mathrm{obs}}$ 是：\n$$ k_{\\mathrm{obs}} = k_{\\mathrm{on}}C + k_{\\mathrm{off}} = (1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) + (2.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}) = 3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1} $$\n平衡占据比例 $p_{\\mathrm{eq}}$ 是：\n$$ p_{\\mathrm{eq}} = \\frac{k_{\\mathrm{on}}C}{k_{\\mathrm{on}}C + k_{\\mathrm{off}}} = \\frac{1.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} = \\frac{1}{3} $$\n阈值占据率为 $p_{\\mathrm{th}}=0.25 = \\frac{1}{4}$。由于 $p_{\\mathrm{th}}  p_{\\mathrm{eq}}$（即 $\\frac{1}{4}  \\frac{1}{3}$），阈值将在有限时间内达到。\n\n现在，我们计算 $t^{\\ast}$：\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3} \\, \\mathrm{s}^{-1}} \\ln\\left(1 - \\frac{1/4}{1/3}\\right) $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(1 - \\frac{3}{4}\\right) \\, \\mathrm{s} $$\n$$ t^{\\ast} = -\\frac{1}{3.0 \\times 10^{-3}} \\ln\\left(\\frac{1}{4}\\right) \\, \\mathrm{s} $$\n使用恒等式 $\\ln(1/x) = -\\ln(x)$，我们有 $\\ln(1/4) = -\\ln(4)$。\n$$ t^{\\ast} = \\frac{1}{3.0 \\times 10^{-3}} \\ln(4) \\, \\mathrm{s} $$\n$$ t^{\\ast} = \\frac{\\ln(2^2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{2\\ln(2)}{3.0 \\times 10^{-3}} \\, \\mathrm{s} $$\n使用 $\\ln(2) \\approx 0.693147$ 的值：\n$$ t^{\\ast} \\approx \\frac{2 \\times 0.693147}{3.0 \\times 10^{-3}} \\, \\mathrm{s} = \\frac{1.386294}{3.0 \\times 10^{-3}} \\, \\mathrm{s} \\approx 462.098 \\, \\mathrm{s} $$\n按要求将结果四舍五入到四位有效数字：\n$$ t^{\\ast} \\approx 462.1 \\, \\mathrm{s} $$",
            "answer": "$$\\boxed{462.1}$$"
        },
        {
            "introduction": "II型超敏反应的特征是抗体靶向并介导细胞的破坏，例如在某些药物引起的溶血性贫血中。然而，细胞的命运（如溶解）通常不仅仅取决于抗体是否结合，还取决于结合了多少抗体以及它们的空间排布。这个练习 () 将平衡结合理论与概率论（二项分布）相结合，来预测在给定的抗体和靶点浓度下，有多少比例的红细胞会被补体系统摧毁。这种练习建立了一座从单分子结合概率到群体细胞结局的关键桥梁。",
            "id": "4964883",
            "problem": "一名患者在接触一种能使红细胞膜半抗原化的β-内酰胺类抗生素后，出现了药物诱导的溶血性贫血，这与II型（抗体介导的细胞毒性）超敏反应一致。在一个平衡状态下的受控体外测定中，每个红细胞（RBC）带有恰好$N = 10$个相同的半抗原化位点，这些位点可被循环中的免疫球蛋白G（$IgG$）识别。抗药物$IgG$对每个位点的平衡解离常数为$K_{D} = 10\\,\\text{nM}$，血浆中的总$IgG$浓度为$[\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}$。RBC浓度足够低，使得游离$IgG$浓度约等于总$IgG$浓度（即$[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$）。假设所有位点都是等效的且独立结合。\n\n假设在测定时间内，经典补体途径会裂解一个RBC，当且仅当至少有两个$IgG$分子同时结合到该RBC表面（也就是说，在测定的时间尺度上，同一个RBC上有两个或更多被占据的位点足以触发C1q结合和膜攻击复合物的形成）。\n\n仅从平衡状态下配体-受体结合的质量作用定律和$N$个位点上独立Bernoulli试验的定义出发，推导一个表达式，用于计算在该测定中发生补体介导裂解的RBC的期望分数，并根据上述参数对其进行数值计算。将你的最终答案表示为一个无量纲的小数，并四舍五入到四位有效数字。",
            "solution": "该场景可以用免疫球蛋白G（$IgG$）与每个红细胞（RBC）上$N$个相同且独立的位点的平衡配体结合模型来描述，并结合经典补体激活的概率要求。基本出发点是：\n\n1. 单个位点的质量作用定律：对于平衡状态下的可逆结合反应$\\text{IgG} + \\text{Site} \\rightleftharpoons \\text{IgG}\\text{-Site}$，解离常数$K_{D}$定义为\n$$\nK_{D} = \\frac{[\\text{IgG}]_{\\text{free}} \\,[\\text{Site}]_{\\text{free}}}{[\\text{IgG}\\text{-Site}]}.\n$$\n对于单个位点，平衡状态下的分数占据率$\\theta$（即给定站点被结合的概率）由经过充分验证的关系式给出\n$$\n\\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n2. RBC上独立且相同的结合位点意味着每个RBC上结合的$IgG$分子数量遵循参数为$N$和$p$的二项分布，其中$p$是单位点的结合概率：\n$$\np = \\theta = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}}.\n$$\n\n3. 在此测定中，经典补体的要求是，一个RBC被裂解当且仅当至少有两个$IgG$分子与其结合。因此，一个RBC被裂解的概率等于在$N$次试验中，成功概率为$p$的情况下，至少有两次成功（结合位点）的二项概率：\n$$\nP(\\text{lysis}) = \\sum_{k=2}^{N} \\binom{N}{k} p^{k} (1-p)^{N-k} = 1 - \\left[ \\binom{N}{0} p^{0} (1-p)^{N} + \\binom{N}{1} p^{1} (1-p)^{N-1} \\right].\n$$\n这可以简化为\n$$\nP(\\text{lysis}) = 1 - \\left[ (1-p)^{N} + N p (1-p)^{N-1} \\right].\n$$\n\n现在我们使用给定参数从结合平衡中计算$p$。假设$[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}}$是合理的，因为RBC浓度相对于$IgG$池来说很低，所以\n$$\n[\\text{IgG}]_{\\text{free}} \\approx [\\text{IgG}]_{\\text{tot}} = 5\\,\\text{nM}, \\quad K_{D} = 10\\,\\text{nM}.\n$$\n因此，\n$$\np = \\frac{[\\text{IgG}]_{\\text{free}}}{K_{D} + [\\text{IgG}]_{\\text{free}}} = \\frac{5}{10 + 5} = \\frac{5}{15} = \\frac{1}{3}.\n$$\n\n当$N = 10$且$p = \\frac{1}{3}$时，裂解概率的精确表达式变为\n$$\nP(\\text{lysis}) = 1 - \\left[ \\left(1 - \\frac{1}{3}\\right)^{10} + 10 \\cdot \\frac{1}{3} \\left(1 - \\frac{1}{3}\\right)^{9} \\right]\n= 1 - \\left[ \\left(\\frac{2}{3}\\right)^{10} + \\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} \\right].\n$$\n我们可以将所有项放在共同的分母$3^{10}$上：\n$$\n\\left(\\frac{2}{3}\\right)^{10} = \\frac{2^{10}}{3^{10}} = \\frac{1024}{59049}, \\quad\n\\frac{10}{3} \\left(\\frac{2}{3}\\right)^{9} = \\frac{10 \\cdot 2^{9}}{3^{10}} = \\frac{5120}{59049}.\n$$\n因此，\n$$\nP(\\text{lysis}) = 1 - \\frac{1024 + 5120}{59049} = 1 - \\frac{6144}{59049} = \\frac{59049 - 6144}{59049} = \\frac{52905}{59049}.\n$$\n这个分数可以约去因子$3$：\n$$\nP(\\text{lysis}) = \\frac{17635}{19683}.\n$$\n数值上，\n$$\nP(\\text{lysis}) \\approx 0.8959508\\ldots\n$$\n四舍五入到四位有效数字，作为一个无量纲的小数，\n$$\nP(\\text{lysis}) \\approx 0.8960.\n$$\n\n因此，在所述条件下，发生补体介导裂解的红细胞的期望分数是$0.8960$（四舍五入到四位有效数字）。",
            "answer": "$$\\boxed{0.8960}$$"
        },
        {
            "introduction": "自身免疫病的一个关键特征是“抗原表位扩散”（epitope spreading），即免疫反应从最初针对少数几个自身抗原表位，逐渐扩展到攻击越来越多的表位，导致疾病的慢性化和进行性加重。这个概念虽然复杂，但可以通过数学模型来捕捉其动态。这个高级练习 () 将指导您从基本免疫学原理出发，构建并实现一个动力学模型，以仿真自身免疫反应是如何从一个初始触发点演变成一场多方位的攻击。这展示了计算建模在揭示慢性病复杂动力学方面的强大能力。",
            "id": "4964942",
            "problem": "本题要求您形式化一个关于自身抗原生成和表位扩散的有原则的定量模型，从基础免疫学和概率论中推导出期望离散时间更新，并实现该模型以计算在连续的炎症周期中，被适应性免疫系统识别的不同自身表位的期望数量。该模型必须基于以下基本定义和经过充分检验的事实：表位扩散是指免疫应答最初集中于一组有限的表位，但由于持续的组织损伤和抗原处理，应答范围扩大到包括其他表位的过程；克隆选择需要在激活性背景下进行抗原识别；期望的线性性允许对期望计数进行加性分解；以及有限的抗原池限制了可被识别的新表位的数量。\n\n假设与定义：\n- 在目标组织中存在一个大小为 $M$ 的有限潜在自身表位池。这代表了在所考虑的炎症背景下，原则上可以被识别的所有不同表位。\n- 在离散周期 $t$，令 $n_t$ 表示当前被识别（主动靶向）的独特自身表位的期望数量。\n- 每个被识别的表位都会导致组织损伤和抗原释放；在每个周期中，每个被识别的表位平均会向抗原处理途径释放或揭示 $r$ 个新的候选表位（自身抗原生成）。\n- 对于每个新释放的候选表位，其被处理、呈递并打破耐受性从而被添加到识别集中的独立概率为 $p$。一个调节控制参数 $c$ 在 $[0,1]$ 区间内，将有效激活概率缩放为 $p_{\\mathrm{eff}} = (1 - c)\\,p$，这反映了当 $c$ 接近 1 时的抑制作用。\n- 只有先前未被识别的表位才能被添加。在有限池约束下，在周期 $t$ 释放的候选表位中，新表位的期望比例是 $\\frac{M - n_t}{M}$。\n- 您应假设候选表位的评估是独立的，并应用期望的线性性来获得确定性的期望值更新。在所有周期中，期望计数必须保持在闭区间 $[0,M]$ 内。\n\n任务：\n1. 根据所述假设，用 $M$、$r$、$p$、$c$ 和 $n_t$ 来逻辑推导 $n_{t+1}$ 相对于 $n_t$ 的确定性离散时间期望更新，不得引入任何未声明的参数。\n2. 实现一个程序，该程序：\n   - 根据给定的值初始化 $n_0$。\n   - 对下述每个测试用例，将推导出的期望值更新迭代恰好 $T$ 个周期，以获得 $n_T$。\n   - 通过在每一步进行必要的钳位操作（clamping）来确保期望计数始终保持在 $[0,M]$ 区间内，以应对浮点运算。\n   - 以保留恰好3位小数的实数形式生成结果。\n\n测试套件：\n为下面列出的每个参数集 $(M, n_0, r, p, c, T)$ 计算 $n_T$：\n- 案例 A: $M=100$, $n_0=1$, $r=3$, $p=0.1$, $c=0.2$, $T=10$。\n- 案例 B: $M=50$, $n_0=5$, $r=0$, $p=0.5$, $c=0.0$, $T=20$。\n- 案例 C: $M=5$, $n_0=1$, $r=5$, $p=0.8$, $c=0.0$, $T=10$。\n- 案例 D: $M=1000$, $n_0=10$, $r=0.05$, $p=0.02$, $c=0.5$, $T=50$。\n- 案例 E: $M=20$, $n_0=20$, $r=10$, $p=1.0$, $c=0.0$, $T=100$。\n- 案例 F: $M=200$, $n_0=2$, $r=1.5$, $p=0.2$, $c=1.0$, $T=15$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,\\dots,x_6]$），其中每个 $x_i$ 是对应案例计算出的 $n_T$ 值，并精确到3位小数。不应产生任何其他输出。此问题中没有物理单位，答案为实数（浮点数）。",
            "solution": "该问题被评估为有效，因为它在免疫学原理上有科学依据，在数学上是适定的、客观的，并包含一套完整且一致的定义和参数。它代表了一项与指定主题直接相关的、可形式化的定量建模任务。\n\n### 第1部分：离散时间期望更新的推导\n\n目标是推导 $n_{t+1}$（在周期 $t+1$ 时被识别的独特自身表位的期望数量）作为 $n_t$（在周期 $t$ 时的数量）的函数的更新规则。我们将从给定的假设出发，应用期望的线性性原理，一步步进行推导。\n\n1.  **在周期 $t$ 时被识别表位的期望数量**：用 $n_t$ 表示。这是我们系统的状态变量。\n\n2.  **自身抗原生成的总期望值**：问题陈述，每个被识别的 $n_t$ 表位都会导致组织损伤，进而导致新的候选表位的释放或揭示。平均而言，每个周期中，每个被识别的表位会生成 $r$ 个新候选表位。根据期望的线性性，在周期 $t$ 中生成的候选表位的总期望数量是被识别表位的数量与每个表位的生成率的乘积：\n    $$ E[\\text{candidates generated}] = n_t \\times r $$\n\n3.  **新候选表位的比例**：潜在自身表位的总池是有限的，大小为 $M$。在周期 $t$，其中有 $n_t$ 个已被识别。因此，未被识别的，即“新的”表位的数量是 $M - n_t$。问题给出的假设是，释放的候选表位中新表位的期望比例由以下公式给出：\n    $$ \\text{Fraction}_{\\text{novel}} = \\frac{M - n_t}{M} = 1 - \\frac{n_t}{M} $$\n    这假设生成的候选表位是整个表位池的一个代表性样本。\n\n4.  **新候选表位的期望数量**：为了找到在周期 $t$ 中生成的新候选表位的期望数量，我们将生成的候选表位总数乘以期望为新表位的比例：\n    $$ E[\\text{novel candidates}] = (n_t r) \\times \\left( \\frac{M - n_t}{M} \\right) $$\n\n5.  **打破耐受的概率**：每个新的候选表位都必须被处理、由抗原呈递细胞呈递，并在打破自身耐受的背景下被 T 细胞或 B 细胞克隆识别。这一系列事件的基础概率是 $p$。该概率受到一个调节控制参数 $c \\in [0, 1]$ 的调制，其中 $c \\approx 1$ 意味着强烈的抑制。有效概率 $p_{\\mathrm{eff}}$ 如下所示：\n    $$ p_{\\mathrm{eff}} = (1 - c) p $$\n\n6.  **新识别表位的期望数量**：假设对每个新候选表位打破耐受的过程是独立事件，我们可以再次应用期望的线性性。新加入到识别集合中的新表位的期望数量，记为 $\\Delta n_t$，是新候选表位的期望数量乘以有效识别概率：\n    $$ \\Delta n_t = E[\\text{newly recognized}] = E[\\text{novel candidates}] \\times p_{\\mathrm{eff}} $$\n    代入第4步和第5步的表达式：\n    $$ \\Delta n_t = \\left( n_t r \\frac{M - n_t}{M} \\right) \\times (1 - c) p $$\n\n7.  **更新方程**：在周期 $t+1$ 时被识别的表位的期望数量，记为 $n_{t+1}$，是在周期 $t$ 时已识别的数量与该周期内新识别表位的期望数量之和：\n    $$ n_{t+1} = n_t + \\Delta n_t $$\n    代入 $\\Delta n_t$ 的完整表达式，得到最终的确定性离散时间更新方程：\n    $$ n_{t+1} = n_t + n_t r \\left( \\frac{M - n_t}{M} \\right) p (1 - c) $$\n    这可以改写成类似于离散逻辑斯谛方程的形式：\n    $$ n_{t+1} = n_t + r p (1 - c) n_t \\left(1 - \\frac{n_t}{M}\\right) $$\n    这个方程描述了被识别表位的期望数量随离散时间周期的演变。模型的约束要求 $n_t \\in [0, M]$。如果参数导致 $n_{t+1}$ 的值超出此范围，则必须进行钳位。具体来说，如果计算出的 $n_{t+1}$ 超过 $M$，则将其设置为 $M$，表示表位池饱和。如果它低于 $0$（这只有在 $n_t \\in [0,M]$ 时由于浮点误差才可能发生，因为增量是非负的），则将其设置为 $0$。\n\n### 第2部分：实现\n\n推导出的更新规则在一个程序中实现，该程序对每个给定的参数集迭代 $T$ 个周期。状态变量 $n_t$ 用 $n_0$ 初始化，并根据公式进行更新。在每一步，该值都被钳位在区间 $[0, M]$ 内。最终值 $n_T$ 保留3位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the expected number of distinct self-epitopes recognized by the\n    adaptive immune system over T inflammatory cycles for several test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (M, n0, r, p, c, T)\n    test_cases = [\n        (100, 1, 3, 0.1, 0.2, 10),      # Case A\n        (50, 5, 0, 0.5, 0.0, 20),      # Case B\n        (5, 1, 5, 0.8, 0.0, 10),      # Case C\n        (1000, 10, 0.05, 0.02, 0.5, 50),  # Case D\n        (20, 20, 10, 1.0, 0.0, 100),   # Case E\n        (200, 2, 1.5, 0.2, 1.0, 15),   # Case F\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M, n0, r, p, c, T = case\n        \n        # Initialize the expected number of recognized epitopes.\n        # Use floating-point numbers for the calculation.\n        n_current = float(n0)\n        M_float = float(M)\n\n        # Iterate the discrete-time update for T cycles.\n        for _ in range(T):\n            # The model is invalid if n_current > M or n_current  0.\n            # We proceed assuming n_current is in [0, M] due to clamping.\n            \n            # The fraction of candidates that are novel.\n            # This term is zero if M is zero to avoid division by zero, or if all epitopes are recognized.\n            if M_float == 0 or n_current >= M_float:\n                novel_fraction = 0.0\n            else:\n                novel_fraction = (M_float - n_current) / M_float\n\n            # Calculate the expected number of newly recognized epitopes.\n            # This is the core of the derived update rule.\n            increment = r * n_current * novel_fraction * (1.0 - c) * p\n            \n            # Update the expected number of recognized epitopes.\n            n_current += increment\n            \n            # Enforce the constraint that n must be in [0, M] by clamping.\n            # This is necessary for discrete models with high growth rates (e.g., Case C)\n            # and as a safeguard against floating-point inaccuracies.\n            n_current = max(0.0, min(n_current, M_float))\n\n        # Append the final result, rounded to 3 decimal places.\n        # The f-string format ensures exactly three decimal places.\n        results.append(f\"{n_current:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}