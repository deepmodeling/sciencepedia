{
    "hands_on_practices": [
        {
            "introduction": "诊断检验的价值不仅在于其固有的准确性，更在于它如何改变我们对患者病情的判断。本练习将指导你掌握两个关键指标——阳性预测值 ($PPV$) 和阴性预测值 ($NPV$) 的计算。通过结合检验的灵敏度、特异性以及疾病在人群中的患病率，你将学会如何从基础概率原理出发，量化一个阳性或阴性结果对患者的真正意义。",
            "id": "4954900",
            "problem": "一家社区诊所正在考虑采用一种新的筛查方法来检测一种慢性病。在该诊所的目标人群中，该疾病的患病率估计为 $0.03$。在验证研究中，该筛查方法的灵敏度为 $0.92$，特异度为 $0.95$。请仅使用概率论的核心定义（包括条件概率和全概率公式）以及灵敏度、特异度和患病率的流行病学定义，推导出阳性预测值（PPV）和阴性预测值（NPV）关于灵敏度、特异度和患病率的表达式。然后，计算该诊所情况下PPV和NPV的数值。将PPV和NPV均表示为 $0$ 到 $1$ 之间的小数。将每个值四舍五入至三位有效数字。最后，为每个值提供一句临床解释，说明在该情况下它对患者的检测结果意味着什么。按 $\\text{PPV}$，$\\text{NPV}$ 的顺序报告您的最终数值答案。",
            "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它提出了一个生物统计学和流行病学中的标准任务，可以使用概率论的基本原理解答。\n\n我们定义以下事件：\n- $D$：从人群中随机抽取的个体患有该慢性病的事件。\n- $D^c$：该个体未患病的事件。\n- $T^+$：个体的检测结果为阳性的事件。\n- $T^-$：个体的检测结果为阴性的事件。\n\n问题陈述中提供的信息可以转化为概率术语。\n疾病的患病率，记为 $P$，是患病的先验概率：\n$$P(D) = P = 0.03$$\n因此，未患病的概率为：\n$$P(D^c) = 1 - P(D) = 1 - 0.03 = 0.97$$\n\n筛查的灵敏度，记为 $S_n$，是在个体患病的情况下，检测结果为阳性的条件概率：\n$$S_n = P(T^+ | D) = 0.92$$\n\n筛查的特异度，记为 $S_p$，是在个体未患病的情况下，检测结果为阴性的条件概率：\n$$S_p = P(T^- | D^c) = 0.95$$\n\n问题要求计算阳性预测值（PPV）和阴性预测值（NPV）。\n\nPPV是在检测结果为阳性的情况下，个体确实患病的条件概率，即 $P(D | T^+)$。\nNPV是在检测结果为阴性的情况下，个体确实未患病的条件概率，即 $P(D^c | T^-)$。\n\n首先，我们推导PPV的表达式。根据条件概率的定义（这也是贝叶斯定理的基础）：\n$$\\text{PPV} = P(D | T^+) = \\frac{P(D \\cap T^+)}{P(T^+)}$$\n分子可以再次使用条件概率的定义重写：$P(D \\cap T^+) = P(T^+ | D)P(D)$。\n分母 $P(T^+)$ 可以使用全概率公式展开：\n$$P(T^+) = P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)$$\n我们知道 $P(T^+ | D) = S_n$ 且 $P(D) = P$。$P(T^+ | D^c)$ 项是假阳性的概率。它与特异度 $S_p = P(T^- | D^c)$ 相关。由于对于未患病的人，检测结果要么是阳性要么是阴性，所以 $P(T^+ | D^c) + P(T^- | D^c) = 1$。因此，$P(T^+ | D^c) = 1 - S_p$。\n将这些代入 $P(T^+)$ 的表达式中：\n$$P(T^+) = S_n \\cdot P + (1 - S_p) \\cdot (1 - P)$$\n现在，将所有部分代回PPV的公式中：\n$$\\text{PPV} = \\frac{P(T^+ | D)P(D)}{P(T^+ | D)P(D) + P(T^+ | D^c)P(D^c)} = \\frac{S_n \\cdot P}{S_n \\cdot P + (1 - S_p) \\cdot (1 - P)}$$\n这就是PPV关于灵敏度、特异度和患病率的通用表达式。\n\n接下来，我们推导NPV的表达式。遵循类似的步骤：\n$$\\text{NPV} = P(D^c | T^-) = \\frac{P(D^c \\cap T^-)}{P(T^-)}$$\n分子是 $P(D^c \\cap T^-) = P(T^- | D^c)P(D^c)$。\n分母 $P(T^-)$ 可使用全概率公式求得：\n$$P(T^-) = P(T^- | D)P(D) + P(T^- | D^c)P(D^c)$$\n我们知道 $P(T^- | D^c) = S_p$ 且 $P(D^c) = 1-P$。$P(T^- | D)$ 项是假阴性的概率。它与灵敏度 $S_n = P(T^+ | D)$ 相关。由于对于患病的人，检测结果要么是阳性要么是阴性，所以 $P(T^+ | D) + P(T^- | D) = 1$。因此，$P(T^- | D) = 1 - S_n$。\n将这些代入 $P(T^-)$ 的表达式中：\n$$P(T^-) = (1 - S_n) \\cdot P + S_p \\cdot (1 - P)$$\n现在，将所有部分代回NPV的公式中：\n$$\\text{NPV} = \\frac{P(T^- | D^c)P(D^c)}{P(T^- | D)P(D) + P(T^- | D^c)P(D^c)} = \\frac{S_p \\cdot (1 - P)}{(1 - S_n) \\cdot P + S_p \\cdot (1 - P)}$$\n这就是NPV的通用表达式。\n\n现在我们使用给定的数据计算数值：$P = 0.03$, $S_n = 0.92$, $S_p = 0.95$。\n\n对于PPV：\n$$\\text{PPV} = \\frac{0.92 \\cdot 0.03}{0.92 \\cdot 0.03 + (1 - 0.95) \\cdot (1 - 0.03)} = \\frac{0.0276}{0.0276 + 0.05 \\cdot 0.97} = \\frac{0.0276}{0.0276 + 0.0485} = \\frac{0.0276}{0.0761} \\approx 0.362679$$\n四舍五入到三位有效数字，我们得到 $\\text{PPV} \\approx 0.363$。\n\n对于NPV：\n$$\\text{NPV} = \\frac{0.95 \\cdot (1 - 0.03)}{(1 - 0.92) \\cdot 0.03 + 0.95 \\cdot (1 - 0.03)} = \\frac{0.95 \\cdot 0.97}{0.08 \\cdot 0.03 + 0.95 \\cdot 0.97} = \\frac{0.9215}{0.0024 + 0.9215} = \\frac{0.9215}{0.9239} \\approx 0.997402$$\n四舍五入到三位有效数字，我们得到 $\\text{NPV} \\approx 0.997$。\n\n最后，我们为这些数值提供一句临床解释。\n\nPPV的临床解释：对于来自该人群且检测结果为阳性的患者，他们实际患有该慢性病的概率为 $36.3\\%$。\n\nNPV的临床解释：对于来自该人群且检测结果为阴性的患者，他们确实未患该慢性病的概率为 $99.7\\%$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.363  0.997 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了预测值的基本计算后 ()，我们来探讨一个更深层次的问题：检验的预测能力是否恒定不变？本练习将通过一个具体的数值案例，揭示阳性预测值 ($PPV$) 与疾病患病率之间的密切关系。你会发现，即使一个检验的灵敏度和特异性非常高，当它应用于低患病率人群时，其阳性结果的可信度也可能大幅下降，这是理解和开展大规模筛查项目的关键。",
            "id": "4954872",
            "problem": "一家医院正在考虑采用一种新的疾病诊断测试。该测试的内在准确性特征很高且固定：其灵敏度为 $0.95$，特异性为 $0.95$。设疾病患病率用 $\\pi$ 表示，定义为从目标人群中随机选择的患者患有该疾病的先验概率。阳性预测值（PPV）定义为在测试结果为阳性的条件下，患者患有该疾病的后验概率。\n\n仅使用核心概率定义和贝叶斯定理（不使用任何预先推导的诊断测试快捷公式），推导以灵敏度、特异性和 $\\pi$ 表示的 $PPV$ 表达式，并计算比率\n$$R=\\frac{PPV\\text{ at } \\pi=0.01}{PPV\\text{ at } \\pi=0.50}.$$\n该比率量化了当患病率下降时，即使灵敏度和特异性保持高且固定的情况下，阳性预测值下降了多少。\n\n将 $R$ 的最终结果表示为四舍五入到四位有效数字的小数。不要使用百分号。",
            "solution": "首先对问题的科学合理性、自洽性和适定性进行验证。\n\n**步骤1：提取已知条件**\n- 灵敏度，记为 $s$，是给定患病条件下测试呈阳性的概率：$s = 0.95$。\n- 特异性，记为 $c$，是给定未患病条件下测试呈阴性的概率：$c = 0.95$。\n- 疾病患病率，记为 $\\pi$，是患病的先验概率。\n- 阳性预测值，$PPV$，是给定测试呈阳性条件下患病的后验概率。\n- 任务是使用贝叶斯定理推导以 $s$、$c$ 和 $\\pi$ 表示的 $PPV$ 表达式。\n- 第二个任务是计算比率 $R = \\frac{PPV\\text{ at } \\pi=0.01}{PPV\\text{ at } \\pi=0.50}$。\n- $R$ 的最终结果必须是四舍五入到四位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了流行病学和生物统计学中的标准基础概念（灵敏度、特异性、患病率、PPV、贝叶斯定理）。所提供的值对于高性能诊断测试是切合实际的。该问题具有科学合理性。\n- **适定性：** 提供了所有必要信息。定义清晰且标准。期望的输出（一个公式和一个数值比率）被明确指定。存在唯一解。\n- **客观性：** 该问题以精确、客观的数学语言陈述。\n- **结论：** 该问题是有效的。\n\n**步骤3：裁定与行动**\n该问题被视为有效。将提供完整解答。\n\n**PPV的推导**\n设 $D$ 为随机选择的患者患有该疾病的事件，$D^c$ 为患者未患该疾病的事件。设 $T$ 为测试结果为阳性的事件，$T^c$ 为测试结果为阴性的事件。\n\n给定的量可以表示为条件概率：\n- 患病率：$P(D) = \\pi$。因此，未患该疾病的概率为 $P(D^c) = 1 - P(D) = 1 - \\pi$。\n- 灵敏度：$P(T|D) = s = 0.95$。\n- 特异性：$P(T^c|D^c) = c = 0.95$。\n\n根据特异性的定义，我们可以求出假阳性概率，即在患者未患病的情况下测试结果为阳性的概率：\n$$P(T|D^c) = 1 - P(T^c|D^c) = 1 - c = 1 - 0.95 = 0.05$$\n\n阳性预测值（$PPV$）是在测试结果为阳性的条件下患者患有该疾病的概率，即 $P(D|T)$。\n\n根据贝叶斯定理，这表示为：\n$$PPV = P(D|T) = \\frac{P(T|D)P(D)}{P(T)}$$\n\n分母 $P(T)$ 是测试结果为阳性的总概率。可以使用全概率公式，通过对疾病状态进行边缘化来求得：\n$$P(T) = P(T|D)P(D) + P(T|D^c)P(D^c)$$\n\n将我们已知条件的符号表示代入 $P(T)$ 的表达式中：\n$$P(T) = s \\cdot \\pi + (1 - c) \\cdot (1 - \\pi)$$\n\n现在，我们将这个展开的 $P(T)$ 形式代回 $PPV$ 的贝叶斯定理表达式中：\n$$PPV(\\pi) = \\frac{s \\cdot \\pi}{s \\cdot \\pi + (1 - c) \\cdot (1 - \\pi)}$$\n这就是以灵敏度（$s$）、特异性（$c$）和患病率（$\\pi$）表示的 $PPV$ 的通用表达式。\n\n**比率 R 的计算**\n我们已知 $s = 0.95$ 和 $c = 0.95$。将这些值代入推导出的公式中：\n$$PPV(\\pi) = \\frac{0.95 \\cdot \\pi}{0.95 \\cdot \\pi + (1 - 0.95) \\cdot (1 - \\pi)} = \\frac{0.95\\pi}{0.95\\pi + 0.05(1 - \\pi)}$$\n\n首先，我们计算患病率为 $\\pi_1 = 0.01$ 时的 $PPV$。\n$$PPV(\\pi=0.01) = \\frac{0.95 \\times 0.01}{0.95 \\times 0.01 + 0.05 \\times (1 - 0.01)}$$\n$$PPV(\\pi=0.01) = \\frac{0.0095}{0.0095 + 0.05 \\times 0.99}$$\n$$PPV(\\pi=0.01) = \\frac{0.0095}{0.0095 + 0.0495} = \\frac{0.0095}{0.059}$$\n\n接下来，我们计算患病率为 $\\pi_2 = 0.50$ 时的 $PPV$。\n$$PPV(\\pi=0.50) = \\frac{0.95 \\times 0.50}{0.95 \\times 0.50 + 0.05 \\times (1 - 0.50)}$$\n$$PPV(\\pi=0.50) = \\frac{0.475}{0.475 + 0.05 \\times 0.50}$$\n$$PPV(\\pi=0.50) = \\frac{0.475}{0.475 + 0.025} = \\frac{0.475}{0.500} = 0.95$$\n\n最后，我们计算比率 $R$：\n$$R = \\frac{PPV(\\pi=0.01)}{PPV(\\pi=0.50)} = \\frac{\\frac{0.0095}{0.059}}{0.95}$$\n$$R = \\frac{0.0095}{0.059 \\times 0.95} = \\frac{0.0095}{0.05605}$$\n$$R \\approx 0.1694915254237$$\n\n根据要求将结果四舍五入到四位有效数字：\n$$R \\approx 0.1695$$\n这个结果表明，尽管该测试具有很高的内在准确性（灵敏度和特异性均为 $95\\%$），但在筛查低患病率人群时，其阳性结果的预测值与高患病率人群相比显著下降。在 $1\\%$ 患病率下的 $PPV$ 仅为 $50\\%$ 患病率下 $PPV$ 的约 $17\\%$。",
            "answer": "$$\\boxed{0.1695}$$"
        },
        {
            "introduction": "在临床实践中，我们常常需要结合多个检验结果来做出最终诊断。本练习将带你进入这一真实场景，学习如何分析两种主要的组合策略——串联检验和并联检验——并计算它们各自的组合灵敏度、特异性及似然比。通过这个练习，你将掌握使用似然比和贝叶斯定理来更新诊断概率的强大工具，从而更精确地评估不同检验策略下的诊断确定性。",
            "id": "4954834",
            "problem": "一位临床医生在同一次就诊中，使用两种独立的诊断测试来评估一位患者的病情。假设在给定真实疾病状态的条件下，这两个测试是独立的。测试 $A$ 的灵敏度为 $Se_{A} = 0.92$，特异度为 $Sp_{A} = 0.88$。测试 $B$ 的灵敏度为 $Se_{B} = 0.80$，特异度为 $Sp_{B} = 0.95$。对于该患者群体，疾病的检验前概率为 $p_{0} = 0.18$。\n\n该临床医生考虑了两种策略来对总体测试结果进行分类：\n- 串联测试：仅当测试 $A$ 和 $B$ 均为阳性时，将总体测试结果分类为阳性；否则，将总体测试结果分类为阴性。\n- 并联测试：如果测试 $A$ 或 $B$ 中任意一个为阳性，则将总体测试结果分类为阳性；仅当两者均为阴性时，才分类为阴性。\n\n仅使用灵敏度、特异度和似然比（LR）的基本定义，以及在给定疾病状态下测试结果的独立性，完成以下任务：\n1. 推导串联策略和并联策略下的组合阳性似然比 $LR^{+}$ 和组合阴性似然比 $LR^{-}$。\n2. 使用优势比形式的贝叶斯定理，将检验前概率 $p_{0}$ 转换为检验前优势比，然后计算在每种策略下，获得总体阳性分类的患者的检验后疾病概率。同时，也计算在每种策略下，获得总体阴性分类的患者的检验后概率。\n3. 最后，报告当总体分类为阳性时，串联策略和并联策略之间检验后概率的绝对差值（以小数形式表示）。\n\n将你的最终答案四舍五入到四位有效数字。将概率表示为小数（不要使用百分号）。",
            "solution": "我们从核心定义开始。灵敏度 $Se$ 是指在患病情况下测试结果为阳性的概率，而特异度 $Sp$ 是指在未患病情况下测试结果为阴性的概率。阳性似然比（LR）定义为 $LR^{+} = \\frac{Se}{1 - Sp}$，阴性似然比定义为 $LR^{-} = \\frac{1 - Se}{Sp}$。在给定疾病状态下测试条件独立的假设下，联合事件的概率可以分解为边际概率的乘积。\n\n定义测试参数：\n- $Se_{A} = 0.92$，$Sp_{A} = 0.88$，\n- $Se_{B} = 0.80$，$Sp_{B} = 0.95$，\n- $p_{0} = 0.18$。\n\n首先，我们推导每种策略下的组合操作特性。\n\n串联策略：\n- 根据串联阳性的定义，仅当两个测试都为阳性时，总体测试结果才为阳性。因此，在患病个体中，总体灵敏度为\n$$Se_{\\text{series}} = Se_{A} \\times Se_{B} = 0.92 \\times 0.80 = 0.736.$$\n- 在未患病个体中，串联测试下的总体假阳性事件是两个测试均为假阳性。在独立性假设下，假阳性率为\n$$FPR_{\\text{series}} = (1 - Sp_{A}) \\times (1 - Sp_{B}) = 0.12 \\times 0.05 = 0.006.$$\n因此，串联策略下的组合阳性似然比为\n$$LR^{+}_{\\text{series}} = \\frac{Se_{\\text{series}}}{FPR_{\\text{series}}} = \\frac{0.736}{0.006} = \\frac{736}{6} = \\frac{368}{3}.$$\n- 对于阴性似然比，我们需要患病和未患病个体中总体结果为阴性的概率。在串联测试中，如果至少有一个测试为阴性，则总体结果为阴性。因此，在患病者中，\n$$FN_{\\text{series}} = 1 - Se_{\\text{series}} = 1 - 0.736 = 0.264.$$\n在未患病者中，总体结果为阴性的概率是1减去两者均为假阳性的概率；等价地，\n$$Sp_{\\text{series}} = 1 - FPR_{\\text{series}} = 1 - 0.006 = 0.994.$$\n因此，\n$$LR^{-}_{\\text{series}} = \\frac{1 - Se_{\\text{series}}}{Sp_{\\text{series}}} = \\frac{0.264}{0.994} = \\frac{264}{994} = \\frac{132}{497}.$$\n\n并联策略：\n- 根据并联阳性的定义，如果任一测试为阳性，则总体测试结果为阳性。在患病个体中，至少有一个测试为阳性的概率是\n$$Se_{\\text{parallel}} = 1 - (1 - Se_{A})(1 - Se_{B}) = 1 - (0.08)(0.20) = 1 - 0.016 = 0.984.$$\n- 在未患病个体中，总体结果为阳性（假阳性）的概率是1减去两者均为真阴性的概率：\n$$FPR_{\\text{parallel}} = 1 - Sp_{A} Sp_{B} = 1 - (0.88)(0.95) = 1 - 0.836 = 0.164.$$\n因此，\n$$LR^{+}_{\\text{parallel}} = \\frac{Se_{\\text{parallel}}}{FPR_{\\text{parallel}}} = \\frac{0.984}{0.164} = 6.$$\n- 对于并联测试中的阴性总体结果，两个测试都必须是阴性。在患病者中，该事件的概率为\n$$(1 - Se_{\\text{parallel}}) = (1 - Se_{A})(1 - Se_{B}) = 0.016.$$\n在未患病者中，两者均为阴性的概率是\n$$Sp_{\\text{parallel}} = Sp_{A} Sp_{B} = 0.836.$$\n因此，\n$$LR^{-}_{\\text{parallel}} = \\frac{1 - Se_{\\text{parallel}}}{Sp_{\\text{parallel}}} = \\frac{0.016}{0.836} = \\frac{16}{836} = \\frac{4}{209}.$$\n\n接下来，我们使用优势比形式的贝叶斯定理，将这些似然比与检验后概率联系起来。设检验前优势比为\n$$\\text{odds}_{0} = \\frac{p_{0}}{1 - p_{0}} = \\frac{0.18}{0.82} = \\frac{18}{82} = \\frac{9}{41}.$$\n阳性分类后的检验后优势比为 $\\text{odds}_{0} \\times LR^{+}$，阴性分类后的检验后优势比为 $\\text{odds}_{0} \\times LR^{-}$。通过以下公式将优势比 $\\text{odds}$ 转换为概率 $p$\n$$p = \\frac{\\text{odds}}{1 + \\text{odds}}.$$\n\n阳性分类：\n- 串联策略：\n$$\\text{odds}_{\\text{series},+} = \\frac{9}{41} \\times \\frac{368}{3} = \\frac{3312}{123},$$\n$$p_{\\text{series},+} = \\frac{\\frac{3312}{123}}{1 + \\frac{3312}{123}} = \\frac{3312}{3312 + 123} = \\frac{3312}{3435} = \\frac{1104}{1145}.$$\n- 并联策略：\n$$\\text{odds}_{\\text{parallel},+} = \\frac{9}{41} \\times 6 = \\frac{54}{41},$$\n$$p_{\\text{parallel},+} = \\frac{\\frac{54}{41}}{1 + \\frac{54}{41}} = \\frac{54}{54 + 41} = \\frac{54}{95}.$$\n\n阴性分类（供比较）：\n- 串联策略：\n$$\\text{odds}_{\\text{series},-} = \\frac{9}{41} \\times \\frac{132}{497} = \\frac{1188}{20377},$$\n$$p_{\\text{series},-} = \\frac{\\frac{1188}{20377}}{1 + \\frac{1188}{20377}} = \\frac{1188}{20377 + 1188} = \\frac{1188}{21565}.$$\n- 并联策略：\n$$\\text{odds}_{\\text{parallel},-} = \\frac{9}{41} \\times \\frac{4}{209} = \\frac{36}{8569},$$\n$$p_{\\text{parallel},-} = \\frac{\\frac{36}{8569}}{1 + \\frac{36}{8569}} = \\frac{36}{8569 + 36} = \\frac{36}{8605}.$$\n\n最后，我们计算串联策略和并联策略在阳性分类后，检验后概率的绝对差值：\n$$\\Delta = \\left|p_{\\text{series},+} - p_{\\text{parallel},+}\\right| = \\left|\\frac{1104}{1145} - \\frac{54}{95}\\right|.$$\n求公分母：\n$$\\frac{1104}{1145} - \\frac{54}{95} = \\frac{1104 \\times 19}{1145 \\times 19} - \\frac{54 \\times 229}{95 \\times 229} = \\frac{20976}{21755} - \\frac{12366}{21755} = \\frac{8610}{21755}.$$\n约去公因数$5$：\n$$\\Delta = \\frac{1722}{4351} \\approx 0.395779\\ldots.$$\n\n四舍五入到四位有效数字并以小数表示，\n$$\\Delta \\approx 0.3958.$$",
            "answer": "$$\\boxed{0.3958}$$"
        }
    ]
}