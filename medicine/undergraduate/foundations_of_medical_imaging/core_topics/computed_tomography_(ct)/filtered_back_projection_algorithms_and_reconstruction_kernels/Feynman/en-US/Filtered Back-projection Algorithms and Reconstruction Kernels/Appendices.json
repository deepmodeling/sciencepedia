{
    "hands_on_practices": [
        {
            "introduction": "A reconstruction kernel is typically defined by its shape in the frequency domain, where filtering is performed via simple multiplication. However, the kernel's practical effect on image sharpness and noise is best understood by its spatial domain counterpart, the impulse response. This practice  provides a direct link between these two representations by asking you to derive a key characteristic of a kernel's impulse response from its frequency-domain definition, offering a deeper insight into filter design.",
            "id": "4884808",
            "problem": "A two-dimensional parallel-beam Computed Tomography (CT) system reconstructs an image using the Filtered Back-Projection (FBP) algorithm. In the FBP pipeline, each projection is filtered along the detector coordinate using a one-dimensional filter whose frequency response is the product of a ramp and an apodization window. Assume the following setup, using the standard one-dimensional Fourier transform pair: the Fourier transform of a function $h(t)$ is $H(\\omega) = \\int_{-\\infty}^{\\infty} h(t)\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t$, and the inverse transform is $h(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega$. The frequency response of the filter is given by\n$$\nH(\\omega) = |\\omega|\\,W(\\omega),\n$$\nwhere $W(\\omega)$ is a raised-cosine (Hann) apodization window defined by\n$$\nW(\\omega) =\n\\begin{cases}\n\\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right), & |\\omega| \\le \\omega_c, \\\\\n0, & |\\omega| > \\omega_c,\n\\end{cases}\n$$\nwith cutoff angular frequency $\\omega_c > 0$. Using only these definitions and the Fourier slice theorem framework (namely, that filtering in frequency corresponds to convolution with the impulse response in the projection domain), derive the exact value of the spatial-domain impulse response $h(t)$ evaluated at $t=0$, expressed purely in terms of $\\omega_c$. Your final answer must be a single closed-form analytic expression. No numerical approximation or rounding is required, and no physical units need be reported in the final answer.",
            "solution": "The user has provided a problem statement that requires the derivation of the value of an impulse response function at time $t = 0$. The problem is set in the context of filtered back-projection for Computed Tomography.\n\n### **Step 1: Problem Validation**\n\nFirst, I will validate the problem statement.\n\n#### **Step 1.1: Extract Givens**\n-   **Methodology**: Filtered Back-Projection (FBP) for a 2D parallel-beam CT system.\n-   **Fourier Transform Pair**:\n    -   Forward: $H(\\omega) = \\int_{-\\infty}^{\\infty} h(t)\\,\\exp(-\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}t$\n    -   Inverse: $h(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega$\n-   **Filter Frequency Response**: $H(\\omega) = |\\omega|\\,W(\\omega)$.\n-   **Apodization Window (Hann Window)**:\n    $$\n    W(\\omega) =\n    \\begin{cases}\n    \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right), & |\\omega| \\le \\omega_c \\\\\n    0, & |\\omega| > \\omega_c\n    \\end{cases}\n    $$\n-   **Parameter**: Cutoff angular frequency $\\omega_c > 0$.\n-   **Objective**: Find the exact value of the spatial-domain impulse response $h(t)$ at $t=0$, i.e., $h(0)$, expressed in terms of $\\omega_c$.\n\n#### **Step 1.2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is well-grounded in the principles of signal processing and medical imaging, specifically in the theory of tomographic reconstruction. The FBP algorithm, the use of a ramp filter ($|\\omega|$), and its apodization with a Hann window are standard, correct, and widely used concepts.\n-   **Well-Posed**: The problem is well-posed. It asks for a specific value, $h(0)$, which can be determined by a definite integral of a well-defined function $H(\\omega)$. All necessary functions and constants are explicitly defined. A unique, meaningful solution exists.\n-   **Objective**: The language is precise, mathematical, and free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the flaws listed in the problem validation checklist. It is scientifically sound, fully specified, and requires a rigorous mathematical derivation.\n\n#### **Step 1.3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\n### **Step 2: Derivation of the Solution**\n\nThe objective is to find the value of the impulse response $h(t)$ at $t=0$. The impulse response $h(t)$ is the inverse Fourier transform of the frequency response $H(\\omega)$. Using the provided definition of the inverse Fourier transform:\n$$\nh(t) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega t)\\,\\mathrm{d}\\omega\n$$\nTo find the value at $t=0$, we set $t=0$ in the expression above:\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\exp(\\mathrm{i}\\,\\omega \\cdot 0)\\,\\mathrm{d}\\omega = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} H(\\omega)\\,\\mathrm{d}\\omega\n$$\nNow, substitute the given expression for the filter's frequency response, $H(\\omega) = |\\omega|\\,W(\\omega)$:\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} |\\omega|\\,W(\\omega)\\,\\mathrm{d}\\omega\n$$\nThe apodization window $W(\\omega)$ is defined to be zero for $|\\omega| > \\omega_c$. This restricts the limits of integration to the interval $[-\\omega_c, \\omega_c]$. Within this interval, we use the non-zero part of the definition of $W(\\omega)$:\n$$\nh(0) = \\frac{1}{2\\pi}\\int_{-\\omega_c}^{\\omega_c} |\\omega| \\left( \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\nThe integrand is an even function of $\\omega$. The term $|\\omega|$ is even, and $\\cos(\\frac{\\pi\\,\\omega}{\\omega_c})$ is also an even function. The product of even functions is even. The integral of an even function over a symmetric interval $[ -a, a ]$ is equal to twice the integral over $[ 0, a ]$.\n$$\nh(0) = \\frac{1}{2\\pi} \\cdot 2 \\int_{0}^{\\omega_c} \\omega \\left( \\frac{1}{2} + \\frac{1}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\nNote that for $\\omega \\ge 0$, we have $|\\omega| = \\omega$. Simplifying the expression:\n$$\nh(0) = \\frac{1}{\\pi} \\int_{0}^{\\omega_c} \\left( \\frac{\\omega}{2} + \\frac{\\omega}{2}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right)\\,\\mathrm{d}\\omega\n$$\nWe can split this into two separate integrals:\n$$\nh(0) = \\frac{1}{2\\pi} \\int_{0}^{\\omega_c} \\omega\\,\\mathrm{d}\\omega + \\frac{1}{2\\pi} \\int_{0}^{\\omega_c} \\omega\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega\n$$\nFirst, we evaluate the first integral:\n$$\n\\int_{0}^{\\omega_c} \\omega\\,\\mathrm{d}\\omega = \\left[ \\frac{\\omega^2}{2} \\right]_{0}^{\\omega_c} = \\frac{\\omega_c^2}{2} - 0 = \\frac{\\omega_c^2}{2}\n$$\nThe first term of $h(0)$ is therefore $\\frac{1}{2\\pi} \\left( \\frac{\\omega_c^2}{2} \\right) = \\frac{\\omega_c^2}{4\\pi}$.\n\nNext, we evaluate the second integral using integration by parts, $\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$.\nLet $u = \\omega$ and $\\mathrm{d}v = \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega$.\nThen $\\mathrm{d}u = \\mathrm{d}\\omega$ and $v = \\int \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)$.\n$$\n\\int_{0}^{\\omega_c} \\omega\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = \\left[ \\omega \\cdot \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} - \\int_{0}^{\\omega_c} \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega\n$$\nEvaluating the first part (the $uv$ term):\n$$\n\\left[ \\frac{\\omega_c \\omega}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} = \\frac{\\omega_c (\\omega_c)}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega_c}{\\omega_c}\\right) - 0 = \\frac{\\omega_c^2}{\\pi}\\sin(\\pi) = 0\n$$\nNow, evaluating the remaining integral part:\n$$\n- \\int_{0}^{\\omega_c} \\frac{\\omega_c}{\\pi}\\sin\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right)\\,\\mathrm{d}\\omega = - \\frac{\\omega_c}{\\pi} \\left[ -\\frac{\\omega_c}{\\pi}\\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c}\n$$\n$$\n= \\frac{\\omega_c^2}{\\pi^2} \\left[ \\cos\\!\\left(\\frac{\\pi\\,\\omega}{\\omega_c}\\right) \\right]_{0}^{\\omega_c} = \\frac{\\omega_c^2}{\\pi^2} \\left( \\cos\\!\\left(\\frac{\\pi\\,\\omega_c}{\\omega_c}\\right) - \\cos(0) \\right)\n$$\n$$\n= \\frac{\\omega_c^2}{\\pi^2} (\\cos(\\pi) - 1) = \\frac{\\omega_c^2}{\\pi^2}(-1 - 1) = -\\frac{2\\omega_c^2}{\\pi^2}\n$$\nThe second term of $h(0)$ is therefore $\\frac{1}{2\\pi} \\left( -\\frac{2\\omega_c^2}{\\pi^2} \\right) = -\\frac{\\omega_c^2}{\\pi^3}$.\n\nFinally, we combine the two terms to find $h(0)$:\n$$\nh(0) = \\frac{\\omega_c^2}{4\\pi} - \\frac{\\omega_c^2}{\\pi^3}\n$$\nTo write this as a single fraction, we find a common denominator, which is $4\\pi^3$:\n$$\nh(0) = \\frac{\\omega_c^2 \\pi^2}{4\\pi^3} - \\frac{4\\omega_c^2}{4\\pi^3} = \\frac{\\omega_c^2\\pi^2 - 4\\omega_c^2}{4\\pi^3}\n$$\nFactoring out $\\omega_c^2$ from the numerator gives the final closed-form expression:\n$$\nh(0) = \\frac{\\omega_c^2 (\\pi^2 - 4)}{4\\pi^3}\n$$\nThis expression is purely in terms of the cutoff angular frequency $\\omega_c$, as required.",
            "answer": "$$\n\\boxed{\\frac{\\omega_c^{2}(\\pi^{2} - 4)}{4\\pi^{3}}}\n$$"
        },
        {
            "introduction": "Theoretical understanding of reconstruction kernels must be paired with the ability to implement them computationally. Modern CT image reconstruction relies on numerical algorithms, where filters are applied using the Discrete Fourier Transform. This exercise  guides you through the process of building and validating the core filtering stage of FBP for several widely-used kernels, moving from mathematical formulas to functional code.",
            "id": "4884813",
            "problem": "You are to design and implement a frequency-domain filtering stage for the filtered back-projection algorithm used in parallel-beam Computed Tomography, starting from first principles. Begin from the Fourier Slice Theorem and the Convolution Theorem, and derive the structure of the one-dimensional filter applied to each projection. Then, implement the filter in the frequency domain and validate it using sinusoidal test inputs.\n\nFoundational base to use:\n- The Radon transform $\\mathcal{R}f(s,\\theta)$ of a function $f(x,y)$ is defined as the integral of $f$ along lines parameterized by detector coordinate $s$ and angle $\\theta$, and satisfies the Fourier Slice Theorem: the one-dimensional Fourier transform in $s$ of $\\mathcal{R}f(s,\\theta)$ equals the restriction of the two-dimensional Fourier transform of $f(x,y)$ to a line through the origin at angle $\\theta$.\n- The Convolution Theorem states that the Fourier transform of a convolution is the product of Fourier transforms, and conversely multiplication in frequency corresponds to convolution in the spatial domain.\n\nYour tasks:\n1. Derive, from the Fourier Slice Theorem and the change of variables underlying the inverse Radon transform, that the frequency-domain filtering applied to each projection has the general form\n   $$H(\\omega) = |\\omega|\\,W(\\omega),$$\n   where $W(\\omega)$ is a window function that enforces band limitation and stabilizes noise amplification. Ensure your derivation explains why the factor $|\\omega|$ appears.\n2. For numerical implementation, consider a uniformly sampled projection $p_n = p(s_n)$ with $s_n = n\\,\\Delta s$ for $n=0,1,\\dots,N-1$. Use the Discrete Fourier Transform (DFT) on $p_n$ and apply a sampled version of $H(\\omega)$ constructed on the discrete angular frequency grid\n   $$\\omega_k = 2\\pi f_k,\\quad f_k = \\mathrm{fftfreq}(N,\\Delta s)\\ \\text{(in cycles per unit length)}.$$\n   The cutoff angular frequency is\n   $$\\omega_c = \\frac{\\pi}{\\Delta s}.$$\n3. Implement three choices for $W(\\omega)$, defined as well-tested window designs with support limited to $|\\omega|\\le \\omega_c$:\n   - Rectangular window (Ram-Lak): \n     $$W_{\\mathrm{RL}}(\\omega) = \\begin{cases}1,&|\\omega|\\le \\omega_c\\\\ 0,&\\text{otherwise}\\end{cases}.$$\n   - Cosine window:\n     $$W_{\\cos}(\\omega) = \\begin{cases}\\cos\\!\\left(\\dfrac{\\pi\\,\\omega}{2\\,\\omega_c}\\right),&|\\omega|\\le \\omega_c\\\\ 0,&\\text{otherwise}\\end{cases}.$$\n   - Shepp–Logan window (using the unnormalized sinc $\\mathrm{sinc}(x)=\\dfrac{\\sin x}{x}$):\n     $$W_{\\mathrm{SL}}(\\omega) = \\begin{cases}\\mathrm{sinc}\\!\\left(\\dfrac{\\omega}{2\\,\\omega_c}\\right),&|\\omega|\\le \\omega_c\\\\ 0,&\\text{otherwise}\\end{cases}.$$\n   In all cases, define $H(\\omega)=|\\omega|\\,W(\\omega)$.\n4. Validate the implementation using sinusoidal test projections of the form\n   $$p(s) = \\cos\\!\\left(2\\pi f_0 s\\right),$$\n   sampled as $p_n = \\cos\\!\\left(2\\pi f_0 n \\Delta s\\right)$, where $f_0$ is chosen to align exactly with a DFT bin. Let $m$ denote the nonnegative integer bin index corresponding to $f_0$ and define $f_0=\\dfrac{m}{N\\,\\Delta s}$, so $m\\in\\{0,1,\\dots,\\lfloor N/2\\rfloor\\}$. Show that after frequency-domain filtering and inversion, the output sinusoid retains its frequency but its amplitude ideally becomes $|H(\\omega_m)|$ where $\\omega_m=2\\pi f_0$. Use the DFT of the filtered signal to measure its amplitude at bin $m$, with the special cases:\n   - If $m=0$ (Direct Current), the amplitude is $$A_{\\mathrm{out}} = \\frac{|\\mathrm{DFT}[m]|}{N}.$$\n   - If $N$ is even and $m=\\dfrac{N}{2}$ (Nyquist), the amplitude is $$A_{\\mathrm{out}} = \\frac{|\\mathrm{DFT}[m]|}{N}.$$\n   - Otherwise, the amplitude is $$A_{\\mathrm{out}} = \\frac{2\\,|\\mathrm{DFT}[m]|}{N}.$$\n5. For each test case, compute the absolute relative error\n   $$\\varepsilon = \\begin{cases}\n   |A_{\\mathrm{out}}-A_{\\mathrm{theory}}|/|A_{\\mathrm{theory}}|,&\\text{if }|A_{\\mathrm{theory}}|>0,\\\\\n   |A_{\\mathrm{out}}|,&\\text{if }A_{\\mathrm{theory}}=0,\n   \\end{cases}$$\n   where $A_{\\mathrm{theory}}=|H(\\omega_m)|$.\n\nAngle units: All angles in the trigonometric functions and angular frequency are in radians. There are no physical units required for the final numeric answers.\n\nTest suite:\n- Case $1$: kernel $=$ Ram-Lak, $N=256$, $\\Delta s=1.0$, $m=8$.\n- Case $2$: kernel $=$ Shepp–Logan, $N=512$, $\\Delta s=1.0$, $m=17$.\n- Case $3$: kernel $=$ Cosine, $N=128$, $\\Delta s=1.0$, $m=64$.\n- Case $4$: kernel $=$ Ram-Lak, $N=300$, $\\Delta s=0.8$, $m=0$.\n- Case $5$: kernel $=$ Shepp–Logan, $N=1024$, $\\Delta s=0.5$, $m=120$.\n\nProgram requirements:\n- Implement the frequency-domain filtering as described.\n- For each test case, generate $p_n$, construct $H(\\omega_k)$ for the specified kernel, filter in the frequency domain, compute the amplitude $A_{\\mathrm{out}}$ at bin $m$, compute $A_{\\mathrm{theory}}=|H(\\omega_m)|$, and return $\\varepsilon$ as a floating-point number.\n- Final Output Format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $$[r_1,r_2,r_3,r_4,r_5]$$), where each $r_i$ is the float $\\varepsilon$ for the corresponding test case.",
            "solution": "The problem requires the derivation and implementation of the frequency-domain filtering stage of the filtered back-projection (FBP) algorithm for parallel-beam Computed Tomography (CT). The process is validated using sinusoidal test data.\n\n### 1. Derivation of the FBP Filtering Kernel\n\nThe reconstruction of a two-dimensional function $f(x,y)$ from its Radon transform (projections) $p_\\theta(s) = \\mathcal{R}f(s,\\theta)$ is achieved via the filtered back-projection algorithm. The derivation begins with the inverse Fourier transform and the Fourier Slice Theorem.\n\nThe 2D inverse Fourier transform of an image's spectrum $F(k_x, k_y)$ is:\n$$f(x,y) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} F(k_x, k_y) e^{i(k_x x + k_y y)} \\,dk_x \\,dk_y$$\nwhere $(k_x, k_y)$ are Cartesian coordinates in the frequency domain. It is often more convenient to work in polar coordinates $(\\omega, \\theta)$, where $k_x = \\omega \\cos\\theta$ and $k_y = \\omega \\sin\\theta$. The differential area element becomes $dk_x\\,dk_y = |\\omega|\\,d\\omega\\,d\\theta$. The inverse transform is rewritten by integrating over each angle $\\theta$ from $0$ to $\\pi$ and radial frequency $\\omega$ from $-\\infty$ to $\\infty$:\n$$f(x,y) = \\int_{0}^{\\pi} \\left[ \\int_{-\\infty}^{\\infty} F(\\omega \\cos\\theta, \\omega \\sin\\theta) \\, e^{i\\omega(x\\cos\\theta + y\\sin\\theta)} \\,|\\omega|\\, d\\omega \\right] d\\theta$$\nThe factor $|\\omega|$ is the Jacobian determinant of the change of variables from Cartesian to polar coordinates in the frequency plane. This factor is crucial and is the origin of the characteristic ramp-like shape of the FBP filter.\n\nThe Fourier Slice Theorem connects the 2D Fourier transform of the image, $F$, to the 1D Fourier transform of its projections, $P_\\theta(\\omega) = \\mathcal{F}\\{p_\\theta(s)\\}$. Specifically, the theorem states that $P_\\theta(\\omega)$ is a slice of $F(k_x, k_y)$ along the line passing through the origin at angle $\\theta$:\n$$P_\\theta(\\omega) = F(\\omega \\cos\\theta, \\omega \\sin\\theta)$$\n\nSubstituting the Fourier Slice Theorem into the reconstruction formula gives:\n$$f(x,y) = \\int_{0}^{\\pi} \\left[ \\int_{-\\infty}^{\\infty} P_\\theta(\\omega) \\, |\\omega| \\, e^{i\\omega s} \\, d\\omega \\right]_{s=x\\cos\\theta + y\\sin\\theta} d\\theta$$\nThis expression can be interpreted as a two-step process:\n\n1.  **Filtering**: The bracketed inner integral represents an inverse Fourier transform. It shows that for each projection angle $\\theta$, the projection's spectrum $P_\\theta(\\omega)$ is multiplied by a filter $H(\\omega) \\propto |\\omega|$.\n    $$P_\\theta^{\\text{filtered}}(\\omega) = P_\\theta(\\omega) \\cdot H(\\omega)$$\n    The result is then transformed back to the spatial domain to get the filtered projection, $p_\\theta^*(s) = \\mathcal{F}^{-1}\\{P_\\theta^{\\text{filtered}}(\\omega)\\}$.\n2.  **Back-projection**: The outer integral sums (integrates) the values of these filtered projections $p_\\theta^*(s)$ over all angles $\\theta$, where $s$ is evaluated at $s=x\\cos\\theta+y\\sin\\theta$. This is the back-projection operation.\n\nThe ideal filter is $H(\\omega)=|\\omega|$. However, this filter amplifies high-frequency noise, making the reconstruction unstable. In practice, the ideal filter is multiplied by a window function $W(\\omega)$ that smoothly tapers the filter response to zero at high frequencies, typically at or before the cutoff frequency $\\omega_c$ determined by the detector sampling interval $\\Delta s$. The general form of the practical filter is thus:\n$$H(\\omega) = |\\omega|\\,W(\\omega)$$\n\n### 2. Discrete Implementation\n\nFor numerical implementation, projections are sampled at discrete points $p_n = p(n\\Delta s)$ for $n=0, 1, \\dots, N-1$. The continuous Fourier transform is replaced by the Discrete Fourier Transform (DFT). The filtering operation becomes a point-wise multiplication in the discrete frequency domain.\n\n1.  **DFT of Projection**: Compute the DFT of the sampled projection $p_n$ to obtain its spectrum $P_k = \\mathrm{DFT}\\{p_n\\}$.\n2.  **Filter Construction**: Construct a discrete version of the filter $H(\\omega)$ on the grid of discrete angular frequencies $\\omega_k = 2\\pi f_k$, where $f_k$ are the frequencies provided by `numpy.fft.fftfreq(N, d=Δs)`. The cutoff angular frequency is $\\omega_c = \\pi/\\Delta s$.\n3.  **Window Functions**: The problem specifies three window functions $W(\\omega)$ for $|\\omega| \\le \\omega_c$:\n    - **Ram-Lak**: $W_{\\mathrm{RL}}(\\omega) = 1$. The filter is $H_k = |\\omega_k|$.\n    - **Cosine**: $W_{\\cos}(\\omega) = \\cos\\left(\\frac{\\pi\\omega}{2\\omega_c}\\right)$. The filter is $H_k = |\\omega_k| \\cos\\left(\\frac{\\pi\\omega_k}{2\\omega_c}\\right)$.\n    - **Shepp–Logan**: $W_{\\mathrm{SL}}(\\omega) = \\mathrm{sinc}\\left(\\frac{\\omega}{2\\omega_c}\\right)$, with $\\mathrm{sinc}(x) = \\frac{\\sin x}{x}$. The filter is $H_k = |\\omega_k| \\mathrm{sinc}\\left(\\frac{\\omega_k}{2\\omega_c}\\right)$.\n\n4.  **Filtering**: Multiply the projection's DFT by the discrete filter: $P_k^{\\text{filtered}} = P_k \\cdot H_k$.\n5.  **Inverse DFT**: Compute the inverse DFT to obtain the filtered projection in the spatial domain: $p_n^* = \\mathrm{IDFT}\\{P_k^{\\text{filtered}}\\}$.\n\n### 3. Validation and Error Analysis\n\nThe implementation is validated by filtering a pure sinusoidal input $p(s) = \\cos(2\\pi f_0 s)$ and comparing the amplitude of the output signal to the theoretical expectation. When the input frequency $f_0$ corresponds exactly to a DFT bin index $m$ ($f_0 = m/(N\\Delta s)$), spectral leakage is avoided, allowing for precise amplitude measurement.\n\nAn ideal linear time-invariant filter, when applied to a sinusoid, produces another sinusoid of the same frequency but with its amplitude scaled by the magnitude of the filter's frequency response at that frequency. Therefore, the filtered projection should ideally be $p^*(s) = |H(\\omega_m)| \\cos(2\\pi f_0 s)$, where $\\omega_m = 2\\pi f_0$.\n\nThe analysis proceeds as follows:\n- The theoretical output amplitude is $A_{\\mathrm{theory}}=|H(\\omega_m)|$.\n- The measured output amplitude, $A_{\\mathrm{out}}$, is determined by taking the DFT of the numerically filtered signal $p_n^*$ and examining the magnitude of the component at bin $m$. The normalization depends on the bin index:\n  $$A_{\\mathrm{out}} = \\begin{cases}\n  |\\mathrm{DFT}[m]|/N, & m=0 \\text{ or (N is even and } m=N/2) \\\\\n  2|\\mathrm{DFT}[m]|/N, & \\text{otherwise}\n  \\end{cases}$$\n- The absolute relative error $\\varepsilon$ quantifies the agreement between theory and implementation:\n  $$\\varepsilon = \\begin{cases}\n  |A_{\\mathrm{out}}-A_{\\mathrm{theory}}|/|A_{\\mathrm{theory}}|,&\\text{if }|A_{\\mathrm{theory}}|>0,\\\\\n  |A_{\\mathrm{out}}|,&\\text{if }A_{\\mathrm{theory}}=0.\n  \\end{cases}$$\nThis procedure is applied to each test case defined in the problem statement to verify the correctness of the implemented filters.",
            "answer": "```python\nimport numpy as np\n\ndef unnormalized_sinc(x):\n    \"\"\"\n    Computes the unnormalized sinc function, sin(x)/x.\n    The problem defines sinc(x) = sin(x)/x, so we implement it directly.\n    np.sinc is the normalized version sin(pi*x)/(pi*x).\n    \"\"\"\n    # Use np.where to handle the x=0 case, where the limit is 1.\n    x = np.asarray(x, dtype=float)\n    return np.where(x == 0, 1.0, np.sin(x) / x)\n\ndef compute_error(kernel_str, N, ds, m):\n    \"\"\"\n    Solves a single test case for the FBP filter validation.\n\n    Args:\n        kernel_str (str): The name of the kernel ('Ram-Lak', 'Cosine', 'Shepp-Logan').\n        N (int): The number of samples in the projection.\n        ds (float): The sampling interval.\n        m (int): The integer bin index for the test sinusoid frequency.\n\n    Returns:\n        float: The absolute relative error epsilon.\n    \"\"\"\n    # 1. Generate discrete frequency grid\n    freqs = np.fft.fftfreq(N, d=ds)\n    omega = 2 * np.pi * freqs\n    omega_c = np.pi / ds\n\n    # 2. Construct the frequency-domain filter H(omega_k)\n    abs_omega = np.abs(omega)\n    \n    if kernel_str == 'Ram-Lak':\n        # W(omega) = 1 for |omega| <= omega_c. All frequencies in fftfreq satisfy this.\n        W = np.ones_like(omega)\n    elif kernel_str == 'Cosine':\n        # W(omega) = cos(pi*omega / (2*omega_c))\n        W = np.cos(np.pi * omega / (2 * omega_c))\n    elif kernel_str == 'Shepp-Logan':\n        # W(omega) = sinc(omega / (2*omega_c))\n        sinc_arg = omega / (2 * omega_c)\n        W = unnormalized_sinc(sinc_arg)\n    else:\n        raise ValueError(f\"Unknown kernel: {kernel_str}\")\n        \n    H = abs_omega * W\n\n    # 3. Generate the test projection p_n\n    f0 = m / (N * ds)\n    n = np.arange(N)\n    p_n = np.cos(2 * np.pi * f0 * n * ds)\n\n    # 4. Filter in the frequency domain\n    # The filtered signal is p_filt = ifft(fft(p) * H).\n    # To measure its amplitude, we take its DFT: fft(p_filt).\n    # Since fft(ifft(X)) = X, this is equivalent to analyzing fft(p) * H directly.\n    P_k = np.fft.fft(p_n)\n    P_k_filtered = P_k * H\n    \n    dft_val_m = P_k_filtered[m]\n\n    # 5. Measure the output amplitude A_out from the DFT of the filtered signal\n    if m == 0:\n        A_out = np.abs(dft_val_m) / N\n    elif N % 2 == 0 and m == N / 2:\n        A_out = np.abs(dft_val_m) / N\n    else:\n        A_out = 2 * np.abs(dft_val_m) / N\n        \n    # 6. Calculate the theoretical amplitude A_theory\n    omega_m = 2 * np.pi * m / (N * ds)\n    abs_omega_m = np.abs(omega_m)\n    A_theory = 0.0 # Default value\n    \n    # The filter is defined to have support up to omega_c.\n    # The test bin m always corresponds to a frequency |omega_m| <= omega_c.\n    if kernel_str == 'Ram-Lak':\n        A_theory = abs_omega_m\n    elif kernel_str == 'Cosine':\n        A_theory = abs_omega_m * np.cos(np.pi * omega_m / (2 * omega_c))\n    elif kernel_str == 'Shepp-Logan':\n        sinc_arg_m = omega_m / (2 * omega_c)\n        A_theory = abs_omega_m * unnormalized_sinc(sinc_arg_m)\n    \n    # 7. Compute the absolute relative error epsilon\n    if np.abs(A_theory) > 1e-15: # Use a tolerance for floating point zero\n        epsilon = np.abs(A_out - A_theory) / np.abs(A_theory)\n    else:\n        epsilon = np.abs(A_out)\n        \n    return epsilon\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (kernel, N, ds, m)\n        ('Ram-Lak', 256, 1.0, 8),\n        ('Shepp-Logan', 512, 1.0, 17),\n        ('Cosine', 128, 1.0, 64),\n        ('Ram-Lak', 300, 0.8, 0),\n        ('Shepp-Logan', 1024, 0.5, 120),\n    ]\n\n    results = []\n    for case in test_cases:\n        kernel_str, N, ds, m = case\n        error = compute_error(kernel_str, N, ds, m)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The quality of a reconstructed image depends not only on the kernel but also on the completeness of the acquired projection data. Real-world scanning scenarios often involve limitations, such as a restricted range of view angles, which can introduce significant artifacts. This practice  delves into this issue by analyzing the system's Point Spread Function (PSF), allowing you to analytically determine how incomplete data affects the final reconstruction of even the simplest object.",
            "id": "4884817",
            "problem": "Consider a two-dimensional parallel-beam computed tomography system using the filtered back-projection algorithm. The unknown object is a point absorber at the isocenter modeled as the Dirac delta distribution, that is, the true object is $f(x,y) = \\delta(x)\\,\\delta(y)$. Projections are acquired with limited angular coverage: the projection angle $\\theta$ is restricted to the interval $\\theta \\in [-\\Theta, \\Theta]$ with $0 < \\Theta \\le \\pi/2$. Each projection is spatially truncated to the detector coordinate interval $s \\in [-S, S]$ with $S > 0$. The reconstruction uses the standard ramp filter whose one-dimensional frequency response is $H(\\omega) = |\\omega|$ for $|\\omega| \\le \\Omega_{c}$ and $H(\\omega) = 0$ for $|\\omega| > \\Omega_{c}$, where $\\Omega_{c} > 0$ is a fixed cutoff frequency. Angles are in radians.\n\nUse the following definitions as the formal starting point:\n- The Radon transform (parallel-beam projection) of $f$ is $p(\\theta, s) = \\displaystyle \\int_{\\mathbb{R}^{2}} f(\\mathbf{x}) \\,\\delta(\\mathbf{x}\\cdot \\mathbf{n}_{\\theta} - s)\\, d\\mathbf{x}$ with $\\mathbf{n}_{\\theta} = (\\cos\\theta, \\sin\\theta)$.\n- The one-dimensional Fourier transform of a function $g(s)$ is $G(\\omega) = \\displaystyle \\int_{-\\infty}^{\\infty} g(s)\\,\\exp(-i \\omega s)\\, ds$, and the inverse transform is $g(s) = \\displaystyle \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} G(\\omega)\\,\\exp(i \\omega s)\\, d\\omega$.\n- The two-dimensional Fourier transform of $f$ is $F(k_{x}, k_{y}) = \\displaystyle \\int_{\\mathbb{R}^{2}} f(x,y)\\,\\exp\\!\\big(-i (k_{x} x + k_{y} y)\\big)\\, dx\\, dy$, and the inverse transform is $f(x,y) = \\displaystyle \\frac{1}{4\\pi^{2}} \\int_{\\mathbb{R}^{2}} F(k_{x}, k_{y})\\, \\exp\\!\\big(i (k_{x} x + k_{y} y)\\big)\\, dk_{x}\\, dk_{y}$.\n\nThe reconstruction is formed by first filtering each projection with the above ramp filter and then back-projecting over the available angle range.\n\nDerive, from these definitions and first principles, a closed-form analytic expression for the reconstructed value at the isocenter, $\\hat{f}(0,0)$, as a function of $\\Theta$ and $\\Omega_{c}$. Your final answer must be a single analytic expression in terms of $\\Theta$ and $\\Omega_{c}$. Angles must be treated in radians. No numerical approximation is required or permitted, and no units should be included in the final expression.",
            "solution": "## PROBLEM VALIDATION\n\n### Step 1: Extract Givens\n- **Object Function:** The true object is a point absorber at the isocenter, modeled as $f(x,y) = \\delta(x)\\,\\delta(y)$.\n- **Angular Coverage:** The projection angle $\\theta$ is restricted to $\\theta \\in [-\\Theta, \\Theta]$, where $0 < \\Theta \\le \\frac{\\pi}{2}$.\n- **Spatial Truncation:** The detector coordinate $s$ is restricted to $s \\in [-S, S]$, where $S > 0$.\n- **Reconstruction Filter:** The filter is a ramp filter with one-dimensional frequency response $H(\\omega) = |\\omega|$ for $|\\omega| \\le \\Omega_{c}$ and $H(\\omega) = 0$ for $|\\omega| > \\Omega_{c}$, with $\\Omega_{c} > 0$.\n- **Reconstruction Point:** The value to be calculated is the reconstructed image at the isocenter, $\\hat{f}(0,0)$.\n- **Formal Definitions:**\n    - Radon Transform: $p(\\theta, s) = \\displaystyle \\int_{\\mathbb{R}^{2}} f(\\mathbf{x}) \\,\\delta(\\mathbf{x}\\cdot \\mathbf{n}_{\\theta} - s)\\, d\\mathbf{x}$ with $\\mathbf{n}_{\\theta} = (\\cos\\theta, \\sin\\theta)$.\n    - 1D Fourier Transform: $G(\\omega) = \\displaystyle \\int_{-\\infty}^{\\infty} g(s)\\,\\exp(-i \\omega s)\\, ds$.\n    - 1D Inverse Fourier Transform: $g(s) = \\displaystyle \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} G(\\omega)\\,\\exp(i \\omega s)\\, d\\omega$.\n    - 2D Fourier Transform: $F(k_{x}, k_{y}) = \\displaystyle \\int_{\\mathbb{R}^{2}} f(x,y)\\,\\exp\\!\\big(-i (k_{x} x + k_{y} y)\\big)\\, dx\\, dy$.\n    - 2D Inverse Fourier Transform: $f(x,y) = \\displaystyle \\frac{1}{4\\pi^{2}} \\int_{\\mathbb{R}^{2}} F(k_{x}, k_{y})\\, \\exp\\!\\big(i (k_{x} x + k_{y} y)\\big)\\, dk_{x}\\, dk_{y}$.\n- **Reconstruction Process:** Filtered back-projection, described as filtering each projection and then back-projecting over the available angle range.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is based on the established mathematical framework of computed tomography, specifically the filtered back-projection (FBP) algorithm. The use of a Dirac delta function to model a point object is a standard technique for analyzing the point spread function (PSF) of an imaging system. The concepts of limited angular coverage and frequency cutoff are fundamental to understanding the limitations and artifacts in practical CT imaging. All definitions are standard in Fourier analysis and medical imaging.\n- **Well-Posed:** The problem is well-defined. It provides a specific object, a clear description of the data acquisition and reconstruction process, and asks for a single, computable value. The parameters ($\\Theta$, $\\Omega_c$) are clearly specified. A unique solution is derivable from the given information.\n- **Objective:** The problem is stated in precise, mathematical language, free from any subjective or ambiguous terms.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist. It is a standard, non-trivial problem in the theory of image reconstruction.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n## SOLUTION\n\nThe problem asks for the reconstructed value at the isocenter, $\\hat{f}(0,0)$, for a point object $f(x,y) = \\delta(x)\\delta(y)$ using a limited-angle filtered back-projection (FBP) algorithm. The derivation will proceed step-by-step from the provided definitions.\n\nThe FBP reconstruction process consists of two stages: filtering the projections and then back-projecting the filtered data. The back-projection step, for an arbitrary point $(x,y)$, is an integral of the filtered projections over the available angular range. For this problem, the angular range is $[-\\Theta, \\Theta]$. The reconstruction $\\hat{f}(x,y)$ is given by:\n$$ \\hat{f}(x,y) = \\int_{-\\Theta}^{\\Theta} q(\\theta, s) \\bigg|_{s = x\\cos\\theta + y\\sin\\theta} \\,d\\theta $$\nwhere $q(\\theta, s)$ is the filtered projection.\n\nThe filtered projection $q(\\theta, s)$ is obtained by filtering the raw projection data $p(\\theta, s)$ with a filter whose impulse response is $h(s)$. In the Fourier domain, this convolution becomes a multiplication. Using the provided definition for the inverse 1D Fourier transform, we can write $q(\\theta, s)$ as:\n$$ q(\\theta, s) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} P(\\theta, \\omega) H(\\omega) \\exp(i\\omega s) \\,d\\omega $$\nHere, $P(\\theta, \\omega)$ is the 1D Fourier transform of $p(\\theta, s)$ with respect to the variable $s$, and $H(\\omega)$ is the frequency response of the reconstruction filter.\n\nOur goal is to compute $\\hat{f}(0,0)$. We set $(x,y)=(0,0)$ in the reconstruction formula:\n$$ \\hat{f}(0,0) = \\int_{-\\Theta}^{\\Theta} q(\\theta, 0\\cos\\theta + 0\\sin\\theta) \\,d\\theta = \\int_{-\\Theta}^{\\Theta} q(\\theta, 0) \\,d\\theta $$\nTo find $q(\\theta, 0)$, we set $s=0$ in its definition:\n$$ q(\\theta, 0) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} P(\\theta, \\omega) H(\\omega) \\exp(i\\omega \\cdot 0) \\,d\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} P(\\theta, \\omega) H(\\omega) \\,d\\omega $$\nSubstituting this into the expression for $\\hat{f}(0,0)$ gives:\n$$ \\hat{f}(0,0) = \\int_{-\\Theta}^{\\Theta} \\left( \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} P(\\theta, \\omega) H(\\omega) \\,d\\omega \\right) d\\theta $$\nThe order of integration can be swapped. Re-arranging gives:\n$$ \\hat{f}(0,0) = \\frac{1}{2\\pi} \\int_{-\\Theta}^{\\Theta} \\int_{-\\infty}^{\\infty} P(\\theta, \\omega) H(\\omega) \\,d\\omega \\,d\\theta $$\nTo evaluate this expression, we must first determine $P(\\theta, \\omega)$.\n\n**1. Calculate the Projection Data**\nThe projection $p(\\theta, s)$ is the Radon transform of the object $f(x,y) = \\delta(x)\\delta(y)$. Using the given definition:\n$$ p(\\theta, s) = \\int_{\\mathbb{R}^2} \\delta(x)\\delta(y) \\delta(x\\cos\\theta + y\\sin\\theta - s) \\,dx\\,dy $$\nBy the sifting property of the Dirac delta functions $\\delta(x)$ and $\\delta(y)$, the integral is evaluated by setting $x=0$ and $y=0$ in the third delta function:\n$$ p(\\theta, s) = \\delta(0\\cos\\theta + 0\\sin\\theta - s) = \\delta(-s) $$\nSince the Dirac delta function is an even function, $\\delta(-s) = \\delta(s)$. Thus, the projection of a point at the isocenter is:\n$$ p(\\theta, s) = \\delta(s) $$\nThis projection is non-zero only at $s=0$. Since the problem states $S>0$, the spatial truncation to $s \\in [-S, S]$ has no effect on the acquired signal for this specific object.\n\n**2. Calculate the Fourier Transform of the Projection**\nNext, we find the 1D Fourier transform of $p(\\theta, s)$ with respect to $s$:\n$$ P(\\theta, \\omega) = \\int_{-\\infty}^{\\infty} p(\\theta, s) \\exp(-i\\omega s) \\,ds = \\int_{-\\infty}^{\\infty} \\delta(s) \\exp(-i\\omega s) \\,ds $$\nAgain, using the sifting property of $\\delta(s)$, we evaluate the exponential at $s=0$:\n$$ P(\\theta, \\omega) = \\exp(-i\\omega \\cdot 0) = 1 $$\nThe Fourier transform of the projection is a constant, equal to $1$, for all frequencies $\\omega$ and angles $\\theta$.\n\n**3. Evaluate the Reconstruction Integral**\nNow we substitute $P(\\theta, \\omega) = 1$ and the definition of the filter $H(\\omega)$ into the expression for $\\hat{f}(0,0)$. The filter is given as $H(\\omega) = |\\omega|$ for $|\\omega| \\le \\Omega_{c}$ and $H(\\omega) = 0$ otherwise. This limits the range of the integral over $\\omega$ to $[-\\Omega_{c}, \\Omega_{c}]$.\n$$ \\hat{f}(0,0) = \\frac{1}{2\\pi} \\int_{-\\Theta}^{\\Theta} \\int_{-\\Omega_{c}}^{\\Omega_{c}} (1) \\cdot |\\omega| \\,d\\omega \\,d\\theta $$\nFirst, we evaluate the inner integral with respect to $\\omega$:\n$$ \\int_{-\\Omega_{c}}^{\\Omega_{c}} |\\omega| \\,d\\omega $$\nSince the integrand $|\\omega|$ is an even function, we can simplify the integral over the symmetric interval $[-\\Omega_{c}, \\Omega_{c}]$:\n$$ \\int_{-\\Omega_{c}}^{\\Omega_{c}} |\\omega| \\,d\\omega = 2 \\int_{0}^{\\Omega_{c}} \\omega \\,d\\omega = 2 \\left[ \\frac{\\omega^2}{2} \\right]_{0}^{\\Omega_{c}} = 2 \\left( \\frac{\\Omega_{c}^2}{2} - 0 \\right) = \\Omega_{c}^2 $$\nNow we substitute this result back into the expression for $\\hat{f}(0,0)$:\n$$ \\hat{f}(0,0) = \\frac{1}{2\\pi} \\int_{-\\Theta}^{\\Theta} \\Omega_{c}^2 \\,d\\theta $$\nThe integrand $\\Omega_{c}^2$ is a constant with respect to the integration variable $\\theta$. Therefore, we can pull it out of the integral:\n$$ \\hat{f}(0,0) = \\frac{\\Omega_{c}^2}{2\\pi} \\int_{-\\Theta}^{\\Theta} 1 \\,d\\theta $$\nEvaluating the final integral gives:\n$$ \\hat{f}(0,0) = \\frac{\\Omega_{c}^2}{2\\pi} [\\theta]_{-\\Theta}^{\\Theta} = \\frac{\\Omega_{c}^2}{2\\pi} (\\Theta - (-\\Theta)) = \\frac{\\Omega_{c}^2}{2\\pi} (2\\Theta) $$\nThis simplifies to the final expression:\n$$ \\hat{f}(0,0) = \\frac{\\Theta \\Omega_{c}^2}{\\pi} $$\nThis result represents the peak value of the point spread function for the described limited-angle, band-limited reconstruction system.",
            "answer": "$$\\boxed{\\frac{\\Theta \\Omega_{c}^{2}}{\\pi}}$$"
        }
    ]
}