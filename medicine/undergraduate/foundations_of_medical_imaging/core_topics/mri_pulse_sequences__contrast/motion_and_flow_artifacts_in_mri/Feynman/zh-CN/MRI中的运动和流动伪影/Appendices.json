{
    "hands_on_practices": [
        {
            "introduction": "相位编码是磁共振成像中最容易受到扫描间运动影响的步骤。本练习将带你回到基本原理，计算在施加相位编码梯度期间，一个微小、恒定的速度所引起的确切相位误差。通过确定最大可容忍的速度，你将具体理解为何MRI对患者的移动如此敏感，而这个计算正是理解鬼影伪影来源的关键。",
            "id": "4901226",
            "problem": "一名正在接受磁共振成像 (MRI) 检查的患者，在施加相位编码梯度期间，沿相位编码轴方向有轻微的非自主头部运动。考虑使用一个恒定幅度和持续时间的矩形相位编码梯度瓣采集的单条相位编码线。假设自旋系综仅在相位编码瓣期间沿相位编码方向以恒定速度 $v$ 运动，并忽略加速度以及梯度瓣之外的任何运动。\n\n从磁场梯度产生的瞬时角频率偏移的基本关系式 $\\omega(t)=\\gamma\\,G(t)\\,x(t)$ 出发，其中 $\\gamma$ 是旋磁比，$G(t)$ 是梯度波形，$x(t)$ 是沿梯度方向的位置，推导在梯度瓣期间由运动引起的累积相位，并由此求出每条线的相位达到指定容差时的速度。将梯度瓣期间的位置建模为 $x(t)=x_{0}+v\\,t$，并设相位编码梯度为在 $0\\le t\\le t_{pe}$ 期间施加的幅度为 $G_{pe}$ 的矩形梯度瓣。\n\n根据要求，在梯度瓣期间由速度引起的累积相位必须严格小于 $\\pi/4$ 弧度，计算在以下参数下的最大允许速度 $v_{\\max}$：$G_{pe}=20$ mT/m，$t_{pe}=2$ ms，以及 $\\gamma=2\\pi\\cdot 42.58$ MHz/T。最终答案以米/秒为单位表示。将您的答案四舍五入到三位有效数字。",
            "solution": "该问题陈述经评估具有科学依据、提法明确、客观且自洽。这是医学成像基础领域的一个有效问题，具体涉及磁共振成像（MRI）中的运动伪影。因此，我们可以进行正式的解答。\n\n在存在磁场梯度的情况下，控制自旋相位累积的基本原理是，梯度会在拉莫尔频率上叠加一个空间相关的频移。对于沿一维梯度 $G(t)$、位于位置 $x(t)$ 的自旋，其瞬时角频率偏移 $\\omega(t)$ 如下所示：\n$$ \\omega(t) = \\gamma \\, G(t) \\, x(t) $$\n这里，$\\gamma$ 是旋磁比。\n\n该问题指定了以下模型：\n1.  沿相位编码轴运动的自旋系综的位置为 $x(t) = x_0 + v \\, t$，其中 $x_0$ 是 $t=0$ 时的初始位置，$v$ 是恒定速度。\n2.  相位编码梯度是一个恒定幅度为 $G_{pe}$、持续时间为 $t_{pe}$ 的矩形梯度瓣。因此，在区间 $0 \\le t \\le t_{pe}$ 内，梯度为 $G(t) = G_{pe}$。\n\n将这些模型代入频率偏移方程，我们得到施加梯度瓣期间的瞬时角频率：\n$$ \\omega(t) = \\gamma \\, G_{pe} \\, (x_0 + v \\, t) \\quad \\text{for } 0 \\le t \\le t_{pe} $$\n\n在此区间内，自旋累积的总相位 $\\phi$ 是角频率的时间积分：\n$$ \\phi = \\int_{0}^{t_{pe}} \\omega(t) \\, dt $$\n代入 $\\omega(t)$ 的表达式：\n$$ \\phi = \\int_{0}^{t_{pe}} \\gamma \\, G_{pe} \\, (x_0 + v \\, t) \\, dt $$\n由于 $\\gamma$、$G_{pe}$、$x_0$ 和 $v$ 相对于积分变量 $t$ 都是常数，我们可以执行积分：\n$$ \\phi = \\gamma \\, G_{pe} \\int_{0}^{t_{pe}} (x_0 + v \\, t) \\, dt $$\n$$ \\phi = \\gamma \\, G_{pe} \\left[ x_0 t + \\frac{1}{2} v t^2 \\right]_{0}^{t_{pe}} $$\n$$ \\phi = \\gamma \\, G_{pe} \\left( (x_0 t_{pe} + \\frac{1}{2} v t_{pe}^2) - (0) \\right) $$\n$$ \\phi = \\gamma \\, G_{pe} \\, x_0 \\, t_{pe} + \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2 $$\n\n这个总相位由两个不同的分量组成：\n1.  $\\phi_{\\text{static}} = \\gamma \\, G_{pe} \\, x_0 \\, t_{pe}$：这是位于位置 $x_0$ 的静止自旋的预期相位编码。它与梯度瓣的面积 $G_{pe} t_{pe}$ 成正比，该面积定义了正在采样的k空间位置。\n2.  $\\phi_{\\text{motion}} = \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2$：这是在施加梯度期间，由自旋运动产生的额外的、不希望有的相位偏移。这一项是运动伪影。\n\n问题要求这个由速度引起的相位误差的绝对值严格小于 $\\frac{\\pi}{4}$ 弧度的容差：\n$$ |\\phi_{\\text{motion}}|  \\frac{\\pi}{4} $$\n代入 $\\phi_{\\text{motion}}$ 的表达式：\n$$ \\left| \\frac{1}{2} \\gamma \\, G_{pe} \\, v \\, t_{pe}^2 \\right|  \\frac{\\pi}{4} $$\n\n为了求得最大允许速度 $v_{\\max}$，我们将相位误差的绝对值设为其极限值：\n$$ \\left| \\frac{1}{2} \\gamma \\, G_{pe} \\, v_{\\max} \\, t_{pe}^2 \\right| = \\frac{\\pi}{4} $$\n求解 $v_{\\max}$（假设 $v_{\\max} > 0$ 且所有其他参数均为正）：\n$$ \\frac{1}{2} \\gamma \\, G_{pe} \\, v_{\\max} \\, t_{pe}^2 = \\frac{\\pi}{4} $$\n$$ v_{\\max} = \\frac{\\pi / 4}{\\frac{1}{2} \\gamma \\, G_{pe} \\, t_{pe}^2} $$\n$$ v_{\\max} = \\frac{\\pi}{2 \\, \\gamma \\, G_{pe} \\, t_{pe}^2} $$\n\n现在，我们将给定的数值代入此表达式。参数如下：\n-   $G_{pe} = 20 \\text{ mT/m} = 20 \\times 10^{-3} \\text{ T/m}$\n-   $t_{pe} = 2 \\text{ ms} = 2 \\times 10^{-3} \\text{ s}$\n-   $\\gamma = 2\\pi \\cdot 42.58 \\text{ MHz/T} = 2\\pi \\cdot 42.58 \\times 10^6 \\text{ rad s}^{-1} \\text{T}^{-1}$\n\n代入这些值：\n$$ v_{\\max} = \\frac{\\pi}{2 \\cdot (2\\pi \\cdot 42.58 \\times 10^6 \\, \\text{rad s}^{-1} \\text{T}^{-1}) \\cdot (20 \\times 10^{-3} \\, \\text{T m}^{-1}) \\cdot (2 \\times 10^{-3} \\, \\text{s})^2} $$\n分子中的因子 $\\pi$ 与旋磁比中的 $\\pi$ 相抵消：\n$$ v_{\\max} = \\frac{1}{2 \\cdot (2 \\cdot 42.58 \\times 10^6) \\cdot (20 \\times 10^{-3}) \\cdot (4 \\times 10^{-6})} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{4 \\cdot 42.58 \\cdot 20 \\cdot 4 \\cdot (10^6 \\cdot 10^{-3} \\cdot 10^{-6})} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{13625.6 \\cdot 10^{-3}} \\, \\text{m/s} $$\n$$ v_{\\max} = \\frac{1}{13.6256} \\, \\text{m/s} $$\n$$ v_{\\max} \\approx 0.0733924 \\, \\text{m/s} $$\n\n问题要求将最终答案四舍五入到三位有效数字。\n$$ v_{\\max} \\approx 0.0734 \\, \\text{m/s} $$",
            "answer": "$$\\boxed{0.0734}$$"
        },
        {
            "introduction": "单个的相位误差已经会造成问题，但跨越k空间的一系列系统性误差模式才是产生相干伪影的根源。本练习将探讨一种在快速成像技术（如EPI）中常见的情景，即运动导致k空间中相邻采集线之间出现交替的相位误差。你将推导出这种误差所对应的“点扩展函数”（PSF），它从数学上描述了物体中的一个点如何被“涂抹”成一个主图像和一个“奈奎斯特鬼影”，从而揭示了伪影的确切来源和位置。",
            "id": "4901233",
            "problem": "考虑沿单个相位编码轴的一维磁共振成像 (MRI)，其笛卡尔采样网格包含 $N$ 条等距的相位编码线，其中 $N$ 为偶数。令 $n \\in \\{0,1,\\dots,N-1\\}$ 为k空间线的索引，$m \\in \\{0,1,\\dots,N-1\\}$ 为图像空间像素的索引。在没有运动的情况下，测量的k空间数据是真实物体的离散傅里叶变换，图像通过离散傅里叶逆变换 (IDFT) 恢复。对于此问题，将运动建模为一次激发间的全局相位误差，该误差在每条采集的线上是恒定的，但可以在两种状态之间切换。具体来说，假设一个简单的双态运动模型，其中连续的线在两种运动状态之间交替，这两种状态为k空间线赋予了相位偏移 $\\phi_1$ 和 $\\phi_2$（以弧度为单位）。也就是说，索引 $n$ 为偶数的线具有相位 $\\phi_1$，索引 $n$ 为奇数的线具有相位 $\\phi_2$。将运动点扩散函数 (PSF) 定义为由k空间中运动引起的乘性相位扰动所产生的图像空间脉冲响应。仅使用图像与k空间之间的基本傅里叶关系以及离散傅里叶逆变换的定义，推导出运动PSF关于 $\\phi_1$ 和 $\\phi_2$ 的闭式表达式。用离散克罗内克δ函数 $\\delta_{m,k}$ 表示您的答案，并且不要引入任何近似。最终表达式中不需要进行数值四舍五入，也无需报告物理单位。",
            "solution": "该问题要求推导一个点扩展函数 (PSF)，它是由k空间中交替的相位误差引起的。这个PSF是k空间相位扰动函数 $P(n)$ 的离散傅里叶逆变换 (IDFT)。\n\n根据问题描述，相位扰动函数 $P(n)$ 为：\n$$ P(n) = \\begin{cases} \\exp(i\\phi_1)  \\text{若 } n \\text{ 为偶数} \\\\ \\exp(i\\phi_2)  \\text{若 } n \\text{ 为奇数} \\end{cases} $$\n我们可以用一个更紧凑的形式来表示 $P(n)$。利用恒等式，我们可以将 $P(n)$ 写成：\n$$ P(n) = \\exp(i\\phi_1) \\left( \\frac{1+(-1)^n}{2} \\right) + \\exp(i\\phi_2) \\left( \\frac{1-(-1)^n}{2} \\right) $$\n重新整理各项：\n$$ P(n) = \\frac{1}{2}(\\exp(i\\phi_1) + \\exp(i\\phi_2)) + \\frac{1}{2}(\\exp(i\\phi_1) - \\exp(i\\phi_2))(-1)^n $$\n运动PSF，即 $psf(m)$，是 $P(n)$ 的IDFT。IDFT具有线性性质，所以我们可以分别对上式中的两项进行变换。\n$$ psf(m) = \\mathcal{F}^{-1}\\{P(n)\\} = \\mathcal{F}^{-1}\\left\\{\\frac{1}{2}(\\exp(i\\phi_1) + \\exp(i\\phi_2))\\right\\} + \\mathcal{F}^{-1}\\left\\{\\frac{1}{2}(\\exp(i\\phi_1) - \\exp(i\\phi_2))(-1)^n\\right\\} $$\n\n第一项是一个常数 $C_1 = \\frac{1}{2}(\\exp(i\\phi_1) + \\exp(i\\phi_2))$。常数的IDFT是一个在原点（$m=0$）处缩放的克罗内克δ函数：\n$$ \\mathcal{F}^{-1}\\{C_1\\} = C_1 \\cdot \\delta_{m,0} = \\frac{1}{2}(\\exp(i\\phi_1) + \\exp(i\\phi_2)) \\delta_{m,0} $$\n\n第二项包含因子 $(-1)^n$。我们可以将其写成复指数形式：$(-1)^n = e^{i\\pi n} = e^{i2\\pi (N/2) n/N}$。这一项对应于一个频率为奈奎斯特频率（$k=N/2$）的复正弦波。根据傅里叶变换的移位性质，一个函数乘以 $e^{i2\\pi k_0 n/N}$ 会使其变换在图像域中发生位移。因此，\n$$ \\mathcal{F}^{-1}\\{C_2 \\cdot (-1)^n\\} = \\mathcal{F}^{-1}\\{C_2 \\cdot e^{i2\\pi (N/2) n/N}\\} = C_2 \\cdot \\delta_{m,N/2} $$\n其中 $C_2 = \\frac{1}{2}(\\exp(i\\phi_1) - \\exp(i\\phi_2))$。所以第二项的IDFT为：\n$$ \\frac{1}{2}(\\exp(i\\phi_1) - \\exp(i\\phi_2)) \\delta_{m,N/2} $$\n\n将两部分组合起来，我们得到最终的运动PSF表达式：\n$$ psf(m) = \\frac{1}{2} \\left( \\exp(i\\phi_1) + \\exp(i\\phi_2) \\right) \\delta_{m,0} + \\frac{1}{2} \\left( \\exp(i\\phi_1) - \\exp(i\\phi_2) \\right) \\delta_{m,N/2} $$\n这个结果表明，一个点源物体将通过这个PSF进行卷积，产生两个图像：一个是在原始位置（$m=0$）的“真实”图像，其强度被两个相位的平均值所调制；另一个是在视野一半处（$m=N/2$）的“鬼影”图像，其强度由两个相位差的一半所决定。这就是所谓的“N/2”或奈奎斯特鬼影。",
            "answer": "$$\n\\boxed{ \\frac{1}{2} \\left( \\exp(i\\phi_1) + \\exp(i\\phi_2) \\right) \\delta_{m,0} + \\frac{1}{2} \\left( \\exp(i\\phi_1) - \\exp(i\\phi_2) \\right) \\delta_{m,N/2} }\n$$"
        },
        {
            "introduction": "并非所有成像序列对运动的敏感度都相同，梯度和回波本身的时序安排起着至关重要的作用。在最后一个练习中，你将研究伪影的幅度如何随回波时间（$TE$）变化。通过推导这个强大的标度律，你将明白为什么最小化$TE$是减少运动和流动伪影的一项基本策略，并体会到MRI序列设计中涉及的权衡。",
            "id": "4901217",
            "problem": "考虑磁共振成像（MRI）中沿 $x$ 轴的一维梯度回波采集。从 $t=0$ 到 $t=TE$ 均匀施加一个幅值为 $G$ 的恒定读出梯度，其中 $TE$ 是回波时间。自旋沿 $x$ 轴进行随机匀速运动，其位置由 $x(t) = x_0 + v t$ 描述，其中 $v$ 是一个方差为 $\\sigma_v^2$ 的零均值随机变量。回波时间点的运动感应相位误差是由自旋在施加的梯度场下的运动引起的。定义伪影幅度由运动感应相位的方差来量化，并假设在一个匀速相位噪声模型中，该方差与所施加波形的一阶梯度矩 $m_1$ 的平方成正比。\n\n在这些条件下，假设 $G$ 和 $\\sigma_v^2$ 保持不变，计算当 $TE$ 从 $30\\,\\mathrm{ms}$ 切换到 $60\\,\\mathrm{ms}$ 时，伪影幅度的倍数变化。请用一个无量纲因子表示你的答案。无需四舍五入。",
            "solution": "用户希望确定在梯度回波 MRI 序列中，当回波时间 $TE$ 改变时，运动伪影幅度的倍数变化。\n\n首先，我们必须根据所提供的信息，建立伪影幅度与回波时间 $TE$ 之间的数学关系。问题陈述伪影幅度（我们用 $A$ 表示）由运动感应相位的方差来量化。该相位误差源于自旋在读出梯度 $G_x(t)$ 下沿 $x$ 轴以恒定速度 $v$ 运动，其位置由 $x(t) = x_0 + v t$ 描述。\n\n自旋累积的相位 $\\phi(t)$ 与其所经历磁场的时间积分成正比。在回波时间 $TE$ 时，由运动引起的相位分量是由于梯度场 $G_x(t) x(t)$ 造成的：\n$$ \\phi_{motion}(TE) = \\int_0^{TE} \\gamma G_x(t) x(t) dt $$\n其中 $\\gamma$ 是旋磁比。代入位置函数 $x(t) = x_0 + v t$，依赖于速度 $v$ 的相位分量为：\n$$ \\phi_v(TE) = \\int_0^{TE} \\gamma G_x(t) (v t) dt $$\n由于 $\\gamma$ 和 $v$ 相对于积分变量 $t$ 是常数，我们可以将它们从积分中提取出来：\n$$ \\phi_v(TE) = \\gamma v \\int_0^{TE} t G_x(t) dt $$\n该积分项是一阶梯度矩 $m_1$ 的定义：\n$$ m_1 = \\int_0^{TE} t G_x(t) dt $$\n因此，与速度相关的相位误差为 $\\phi_v(TE) = \\gamma v m_1$。\n\n问题陈述伪影幅度 $A$ 是该相位的方差，即 $A = \\text{Var}(\\phi_v(TE))$。速度 $v$ 是一个零均值、方差为 $\\sigma_v^2$ 的随机变量。由于对于给定的序列，$\\gamma$ 和 $m_1$ 是确定性量，因此方差为：\n$$ A = \\text{Var}(\\gamma v m_1) = (\\gamma m_1)^2 \\text{Var}(v) = \\gamma^2 \\sigma_v^2 m_1^2 $$\n该表达式证实了问题陈述中提供的模型：伪影幅度 $A$ 与一阶梯度矩的平方 $m_1^2$ 成正比，比例常数为 $k = \\gamma^2 \\sigma_v^2$。\n\n接下来，我们计算指定梯度波形的一阶梯度矩 $m_1$。问题描述了一个从 $t=0$ 到 $t=TE$ 均匀施加的幅值为 $G$ 的恒定读出梯度。因此，$G_x(t) = G$ 对 $t \\in [0, TE]$ 成立。我们计算 $m_1$ 的积分：\n$$ m_1 = \\int_0^{TE} t G dt = G \\int_0^{TE} t dt $$\n计算这个基本积分可得：\n$$ m_1 = G \\left[ \\frac{t^2}{2} \\right]_0^{TE} = G \\left( \\frac{TE^2}{2} - 0 \\right) = \\frac{G \\cdot TE^2}{2} $$\n\n现在我们将 $m_1$ 的这个表达式代入伪影幅度 $A$ 的方程中：\n$$ A = \\gamma^2 \\sigma_v^2 \\left( \\frac{G \\cdot TE^2}{2} \\right)^2 = \\gamma^2 \\sigma_v^2 \\frac{G^2 \\cdot TE^4}{4} $$\n问题陈述 $G$ 和 $\\sigma_v^2$ 保持不变。旋磁比 $\\gamma$ 是一个基本常数。因此，我们可以将伪影幅度表示为 $TE$ 的函数：\n$$ A(TE) = C \\cdot TE^4 $$\n其中 $C = \\frac{\\gamma^2 \\sigma_v^2 G^2}{4}$ 是一个不依赖于 $TE$ 的常数。这个关系表明，伪影幅度与回波时间的四次方成正比。\n\n我们需要计算当 $TE$ 从初始值 $TE_1 = 30\\,\\mathrm{ms}$ 变为最终值 $TE_2 = 60\\,\\mathrm{ms}$ 时，$A$ 的倍数变化。设 $A_1$ 和 $A_2$ 分别是 $TE_1$ 和 $TE_2$ 时的伪影幅度。\n$$ A_1 = C \\cdot (TE_1)^4 $$\n$$ A_2 = C \\cdot (TE_2)^4 $$\n倍数变化是比率 $\\frac{A_2}{A_1}$：\n$$ \\frac{A_2}{A_1} = \\frac{C \\cdot (TE_2)^4}{C \\cdot (TE_1)^4} = \\left( \\frac{TE_2}{TE_1} \\right)^4 $$\n我们代入给定的回波时间数值：\n$$ \\frac{TE_2}{TE_1} = \\frac{60\\,\\mathrm{ms}}{30\\,\\mathrm{ms}} = 2 $$\n因此，倍数因子是：\n$$ \\frac{A_2}{A_1} = (2)^4 = 16 $$\n将回波时间从 $30\\,\\mathrm{ms}$ 增加一倍至 $60\\,\\mathrm{ms}$，会导致匀速运动伪影的幅度增加 16 倍。",
            "answer": "$$\\boxed{16}$$"
        }
    ]
}