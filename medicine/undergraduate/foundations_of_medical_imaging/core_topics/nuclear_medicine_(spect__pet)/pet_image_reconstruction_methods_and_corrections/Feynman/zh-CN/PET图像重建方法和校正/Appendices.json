{
    "hands_on_practices": [
        {
            "introduction": "最大似然期望最大化 (ML-EM) 算法是 PET 图像重建的核心。通过本次实践，您将亲手执行一次 ML-EM 迭代计算，将抽象的数学原理应用于一个简化的成像系统。这个练习旨在揭示迭代重建的内在机制，帮助您直观地理解图像是如何从投影数据中一步步“生长”出来的 。",
            "id": "4907890",
            "problem": "在正电子发射断层扫描（PET）中，假设一个离散正向模型，其中测量的正弦图计数被建模为独立的泊松随机变量，其均值由未知体素活度的线性变换给出。设测量模型为 $y_{i} \\sim \\text{Poisson}(\\lambda_{i})$，其中 $\\lambda_{i} = \\sum_{j} a_{ij} x_{j} + r_{i} + s_{i}$，$x_{j}$ 是未知的体素活度，$a_{ij}$ 是系统矩阵的元素，$r_{i}$ 是随机符合（randoms），$s_{i}$ 是散射符合（scatters）。考虑没有随机符合和散射符合的情况，即对所有 $i$ 都有 $r_{i} = 0$ 和 $s_{i} = 0$。\n\n从该模型下数据的泊松似然和期望最大化（EM）原则出发，推导将 $x^{k}$ 映射到 $x^{k+1}$ 的单次迭代的最大似然期望最大化（ML-EM）不动点更新公式，用 $A$、$y$ 和 $x^{k}$ 表示。然后，应用你推导的表达式，对以下玩具系统从初始估计 $x^{0}$ 计算单次迭代：\n- 系统矩阵 $A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$。\n- 测量计数 $y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$。\n- 随机符合和散射符合 $r = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ 和 $s = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n- 初始活度估计 $x^{0} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n\n将更新后的活度估计 $x^{1}$ 表示为精确数值（不四舍五入），单位为任意单位。以一个二元行向量的形式提供最终答案。最终答案中不要包含单位。",
            "solution": "根据验证标准对用户提供的问题进行评估。\n\n### 问题验证\n**步骤1：提取已知条件**\n-   **模型**：测量的正弦图计数 $y_{i}$ 是独立的泊松随机变量，$y_{i} \\sim \\text{Poisson}(\\lambda_{i})$。\n-   **泊松分布的均值**：$\\lambda_{i} = \\sum_{j} a_{ij} x_{j} + r_{i} + s_{i}$。\n-   **变量**：\n    -   $x_{j}$：未知的体素活度。\n    -   $a_{ij}$：系统矩阵 $A$ 的元素。\n    -   $r_{i}$：随机符合。\n    -   $s_{i}$：散射符合。\n-   **条件**：没有随机符合和散射符合，因此对所有 $i$ 都有 $r_{i} = 0$ 和 $s_{i} = 0$。模型简化为 $\\lambda_{i} = \\sum_{j} a_{ij} x_{j}$。\n-   **任务1**：推导最大似然期望最大化（ML-EM）的单次迭代不动点更新，将估计 $x^{k}$ 映射到 $x^{k+1}$。\n-   **任务2**：应用推导出的表达式，对一个特定的玩具系统计算一次迭代 $x^{1}$。\n-   **玩具系统数据**：\n    -   系统矩阵：$A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$。\n    -   测量计数：$y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$。\n    -   随机符合和散射符合：$r = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$ 和 $s = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n    -   初始活度估计：$x^{0} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n-   **输出要求**：$x^{1}$ 以一个二元行向量的形式表示，数值为精确数。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在根本上是合理的。PET中光子计数事件的泊松模型是统计图像重建的基石。期望最大化算法是寻找该模型最大似然估计的标准方法。该问题在科学上是正确的，并且与医学成像领域相关。\n-   **定义明确**：该问题是定义明确的。ML-EM算法的推导是文献中的标准程序，所提供的数值示例是完整的且内部一致的，保证了单次迭代有唯一解。\n-   **客观性**：该问题使用精确无歧义的数学语言陈述。\n-   **结论**：没有科学或逻辑上的缺陷，没有缺失信息，也没有歧义。\n\n**步骤3：裁定与行动**\n问题是**有效的**。将提供完整解答。\n\n### 解答推导与计算\n\n本题要求推导用于正电子发射断层扫描（PET）的最大似然期望最大化（ML-EM）更新方程，并将其应用于一个玩具问题。\n\n**第一部分：ML-EM更新方程的推导**\n\n在没有随机符合和散射符合的情况下，PET的测量模型由一组独立的泊松随机变量 $y_i$ 给出，其中 $i$ 索引探测器对（响应线，LORs）：\n$$y_i \\sim \\text{Poisson}(\\lambda_i)$$\n平均计数 $\\lambda_i$ 通过系统矩阵 $A$（其元素为 $a_{ij}$）与未知的体素活度 $x_j$（其中 $j$ 索引体素）相关联：\n$$\\lambda_i = \\sum_{j=1}^{N} a_{ij} x_j$$\n此处，$N$ 是体素总数，$M$ 是LORs总数。\n\n在给定活度分布 $x = (x_1, ..., x_N)$ 的情况下，观测到测量向量 $y = (y_1, ..., y_M)$ 的似然是各个泊松概率的乘积：\n$$L(x) = P(y|x) = \\prod_{i=1}^{M} \\frac{\\lambda_i^{y_i} \\exp(-\\lambda_i)}{y_i!} = \\prod_{i=1}^{M} \\frac{\\left(\\sum_{j=1}^{N} a_{ij} x_j\\right)^{y_i} \\exp\\left(-\\sum_{j=1}^{N} a_{ij} x_j\\right)}{y_i!}$$\n对数似然函数 $\\mathcal{L}(x) = \\ln(L(x))$ 为：\n$$\\mathcal{L}(x) = \\sum_{i=1}^{M} \\left( y_i \\ln\\left(\\sum_{j=1}^{N} a_{ij} x_j\\right) - \\sum_{j=1}^{N} a_{ij} x_j \\right) - \\sum_{i=1}^{M} \\ln(y_i!)$$\n由于和的对数存在，直接最大化此对数似然函数是困难的。EM算法通过引入“完整”但未观测到的（隐藏）数据来规避此问题。\n\n设完整数据为 $Z_{ij}$，表示从体素 $j$ 发出并在LOR $i$ 中被探测到的发射次数。这些被建模为独立的泊松变量：\n$$Z_{ij} \\sim \\text{Poisson}(a_{ij} x_j)$$\n观测数据 $y_i$ 是这些隐藏变量对所有体素求和的结果：\n$$y_i = \\sum_{j=1}^{N} Z_{ij}$$\n完整数据 $Z = \\{Z_{ij}\\}$ 的对数似然要简单得多：\n$$\\mathcal{L}_C(x; Z) = \\ln(P(Z|x)) = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( Z_{ij} \\ln(a_{ij} x_j) - a_{ij} x_j - \\ln(Z_{ij}!) \\right)$$\n\nEM算法是一个迭代的两步过程：\n1.  **E步（期望）：** 计算完整数据对数似然的期望值，条件是观测数据 $y$ 和当前参数估计 $x^k$。设此函数为 $Q(x|x^k)$。\n    $$Q(x|x^k) = E[\\mathcal{L}_C(x; Z) | y, x^k]$$\n    这需要找到隐藏数据的条件期望 $\\hat{Z}_{ij}^k = E[Z_{ij} | y, x^k]$。对于固定的LOR $i$，给定总计数 $y_i = \\sum_j Z_{ij}$，$\\{Z_{ij}\\}_{j=1,...,N}$ 的条件分布是多项分布。$Z_{ij}$ 的条件期望是：\n    $$\\hat{Z}_{ij}^k = E[Z_{ij} | y_i, x^k] = y_i \\frac{a_{ij} x_j^k}{\\sum_{l=1}^{N} a_{il} x_l^k}$$\n    将此代入 $Q(x|x^k)$ 的表达式中，并舍去与 $x$ 无关的项：\n    $$Q(x|x^k) = \\sum_{i=1}^{M} \\sum_{j=1}^{N} \\left( \\hat{Z}_{ij}^k \\ln(a_{ij} x_j) - a_{ij} x_j \\right) + \\text{const.}$$\n\n2.  **M步（最大化）：** 找到使 $Q(x|x^k)$ 最大化的新估计 $x^{k+1}$。我们可以通过对每个 $x_j$ 求偏导数并将其设为零来实现。\n    $$\\frac{\\partial Q(x|x^k)}{\\partial x_j} = \\sum_{i=1}^{M} \\left( \\frac{\\hat{Z}_{ij}^k}{x_j} - a_{ij} \\right) = 0$$\n    求解 $x_j$ 得到更新后的估计 $x_j^{k+1}$：\n    $$x_j^{k+1} \\sum_{i=1}^{M} a_{ij} = \\sum_{i=1}^{M} \\hat{Z}_{ij}^k$$\n    $$x_j^{k+1} = \\frac{\\sum_{i=1}^{M} \\hat{Z}_{ij}^k}{\\sum_{i=1}^{M} a_{ij}}$$\n    代入 $\\hat{Z}_{ij}^k$ 的表达式：\n    $$x_j^{k+1} = \\frac{\\sum_{i=1}^{M} y_i \\frac{a_{ij} x_j^k}{\\sum_{l=1}^{N} a_{il} x_l^k}}{\\sum_{i=1}^{M} a_{ij}}$$\n    重新整理这些项，得到最终的ML-EM更新方程：\n    $$x_j^{k+1} = \\frac{x_j^k}{\\sum_{i=1}^{M} a_{ij}} \\sum_{i=1}^{M} \\frac{a_{ij} y_i}{\\sum_{l=1}^{N} a_{il} x_l^k}$$\n这就是所要求的不动点更新表达式。\n\n**第二部分：应用于玩具系统**\n\n我们应用推导出的公式进行一次迭代，从 $x^0$ 计算 $x^1$。\n给定数据如下：\n-   系统矩阵 $A = \\begin{bmatrix} 1  1 \\\\ 0  1 \\end{bmatrix}$\n-   测量计数 $y = \\begin{bmatrix} 10 \\\\ 6 \\end{bmatrix}$\n-   初始估计 $x^0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n\n该系统有 $N=2$ 个体素和 $M=2$ 个LORs。各分量为 $x_1^0 = 1$, $x_2^0 = 1$, $y_1=10$, $y_2=6$，矩阵元素为 $a_{11}=1, a_{12}=1, a_{21}=0, a_{22}=1$。\n\n首先，我们计算更新方程中的分母。\n对于 $i=1, 2$ 的正向投影估计 $\\sum_{l=1}^2 a_{il} x_l^0$：\n-   对于 $i=1$：$\\sum_{l=1}^2 a_{1l} x_l^0 = a_{11} x_1^0 + a_{12} x_2^0 = (1)(1) + (1)(1) = 2$。\n-   对于 $i=2$：$\\sum_{l=1}^2 a_{2l} x_l^0 = a_{21} x_1^0 + a_{22} x_2^0 = (0)(1) + (1)(1) = 1$。\n\n对于 $j=1, 2$ 的灵敏度因子（$A$的列和）$\\sum_{i=1}^2 a_{ij}$：\n-   对于 $j=1$：$\\sum_{i=1}^2 a_{i1} = a_{11} + a_{21} = 1 + 0 = 1$。\n-   对于 $j=2$：$\\sum_{i=1}^2 a_{i2} = a_{12} + a_{22} = 1 + 1 = 2$。\n\n现在，我们计算更新后的体素活度 $x_1^1$ 和 $x_2^1$。\n\n对于体素 $j=1$：\n$$x_1^{1} = \\frac{x_1^0}{\\sum_{i=1}^{2} a_{i1}} \\sum_{i=1}^{2} \\frac{a_{i1} y_i}{\\sum_{l=1}^{2} a_{il} x_l^0} = \\frac{1}{1} \\left( \\frac{a_{11} y_1}{\\sum_{l} a_{1l} x_l^0} + \\frac{a_{21} y_2}{\\sum_{l} a_{2l} x_l^0} \\right)$$\n$$x_1^{1} = 1 \\cdot \\left( \\frac{1 \\cdot 10}{2} + \\frac{0 \\cdot 6}{1} \\right) = \\frac{10}{2} + 0 = 5$$\n\n对于体素 $j=2$：\n$$x_2^{1} = \\frac{x_2^0}{\\sum_{i=1}^{2} a_{i2}} \\sum_{i=1}^{2} \\frac{a_{i2} y_i}{\\sum_{l=1}^{2} a_{il} x_l^0} = \\frac{1}{2} \\left( \\frac{a_{12} y_1}{\\sum_{l} a_{1l} x_l^0} + \\frac{a_{22} y_2}{\\sum_{l} a_{2l} x_l^0} \\right)$$\n$$x_2^{1} = \\frac{1}{2} \\left( \\frac{1 \\cdot 10}{2} + \\frac{1 \\cdot 6}{1} \\right) = \\frac{1}{2} \\left( 5 + 6 \\right) = \\frac{11}{2}$$\n\n一次迭代后更新的活度估计为 $x^1 = \\begin{bmatrix} 5 \\\\ \\frac{11}{2} \\end{bmatrix}$。题目要求以一个二元行向量的形式给出答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5  \\frac{11}{2}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "准确的 PET 定量分析（如标准化摄取值 SUV）严重依赖于精确的物理校正，其中衰减校正是至关重要的一环。本次实践模拟了一个常见的临床情景：CT 图像中的金属伪影导致衰减图谱 ($\\mu$-map) 被高估。通过计算这种误差对重建活度浓度的影响，您将深刻理解衰减校正的偏差如何直接转化为定量结果的偏差，并认识到审视整个成像链的重要性 。",
            "id": "4907936",
            "problem": "一个正电子发射断层扫描（PET）系统使用一个线性衰减系数图（通常称为 $\\mu$-map）进行衰减校正，该图源自计算机断层扫描（CT）并被缩放到 $511\\,\\text{keV}$。考虑一个活性浓度均匀的小球形病灶。所有有助于该病灶重建的响应线（LOR）都穿过 $\\mu$-map 中的一个局部金属伪影区域，在该区域中，线性衰减系数相对于其真实的 $511\\,\\text{keV}$ 值被高估了。沿着每条这样的 LOR，该伪影区域的厚度为 $L_{\\text{art}} = 1.8\\,\\text{cm}$。伪影区域内的真实系数为 $\\mu_{\\text{true}} = 0.18\\,\\text{cm}^{-1}$，而该区域用于衰减校正的 $\\mu$-map 值为 $\\mu_{\\text{est}} = 0.28\\,\\text{cm}^{-1}$。在每条 LOR 的其他所有地方，$\\mu$-map 等于真实系数。\n\n假设以下理想化条件：\n- 湮没光子沿每条 LOR 的传输遵循比尔-朗伯定律。\n- 测量的投影图（sinogram）值通过根据 $\\mu$-map 计算的乘性衰减校正因子进行校正。\n- 归一化、校准、散射、随机事件和死时间校正是完美的。\n- 重建算法相对于校正后的投影图是无偏的且局部线性的，因此沿与病灶相交的 LOR 的衰减校正中的任何乘性误差都会以乘性方式传播到重建的病灶活性浓度中。\n- 标准化摄取值（SUV）定义为 $\\text{SUV} = c/A_{\\text{norm}}$，其中 $c$ 是重建的活性浓度，$A_{\\text{norm}}$ 是按体重归一化的注射活性。在上述假设下，$A_{\\text{norm}}$ 不受伪影影响。\n\n从比尔-朗伯定律和 PET 重建中衰减校正因子的操作定义出发，推导一个由伪影区域中过高估计的 $\\mu$ 值引起的重建病灶活性浓度的乘性偏差因子表达式，并由此确定病灶局部 SUV 的最终分数偏差，以十进制数（无量纲）表示。使用上面提供的数值。将您的最终答案四舍五入到四位有效数字，并以无单位的十进制小数表示。",
            "solution": "该问题要求计算由于 PET 图像重建所用衰减图中的误差导致的病灶标准化摄取值（SUV）的分数偏差。解答从光子衰减和 PET 数据校正的基本原理开始。\n\n假设一条 LOR（响应线）穿过患者。根据比尔-朗伯定律，如果沿此 LOR 发射了 $N_0$ 个光子对，则探测到的光子对数量 $m$（对应于一个投影图值）会因衰减因子 $A_{\\text{true}}$ 而减少。\n真实的衰减因子由真实线性衰减系数 $\\mu_{\\text{true}}(l)$ 沿 LOR 路径 $L$ 的线积分确定：\n$$A_{\\text{true}} = \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)$$\n因此，测量的投影图值 $m$ 与未衰减信号 $p_0$（与活性浓度的线积分成正比）的关系如下：\n$$m = p_0 \\cdot A_{\\text{true}} = p_0 \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)$$\n\n在 PET 重建中，测量数据 $m$ 通过乘以一个衰减校正因子（ACF）来进行衰减校正。ACF 被计算为衰减因子的倒数，但它是使用从 CT 派生的估计衰减图 $\\mu_{\\text{est}}(l)$ 计算的。\n$$\\text{ACF}_{\\text{est}} = \\frac{1}{\\exp\\left(-\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)} = \\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)$$\n校正后的投影图值 $p_{\\text{est}}$，作为重建算法的输入，是测量数据与估计的 ACF 的乘积：\n$$p_{\\text{est}} = m \\cdot \\text{ACF}_{\\text{est}}$$\n代入 $m$ 和 $\\text{ACF}_{\\text{est}}$ 的表达式：\n$$p_{\\text{est}} = \\left[p_0 \\exp\\left(-\\int_L \\mu_{\\text{true}}(l) \\, dl\\right)\\right] \\cdot \\left[\\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl\\right)\\right]$$\n$$p_{\\text{est}} = p_0 \\exp\\left(\\int_L \\mu_{\\text{est}}(l) \\, dl - \\int_L \\mu_{\\text{true}}(l) \\, dl\\right) = p_0 \\exp\\left(\\int_L \\left[\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl\\right)$$\n\n问题陈述，估计的衰减系数 $\\mu_{\\text{est}}$ 仅在厚度为 $L_{\\text{art}}$ 的特定伪影区域内不正确，而在其他地方都是正确的。因此，差值 $\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)$ 在该区域外处处为零。积分简化为仅对伪影区域的积分：\n$$\\int_L \\left[\\mu_{\\text{est}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl = \\int_{\\text{artifact}} (\\mu_{\\text{est}} - \\mu_{\\text{true}}) \\, dl$$\n在这个区域内，系数是恒定的。设其值如给定的 $\\mu_{\\text{est}}$ 和 $\\mu_{\\text{true}}$。积分变为：\n$$\\int_{\\text{artifact}} (\\mu_{\\text{est}} - \\mu_{\\text{true}}) \\, dl = (\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}$$\n所以，校正后的投影图数据为：\n$$p_{\\text{est}} = p_0 \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)$$\n\n理想情况下，如果衰减图是完美的（$\\mu_{\\text{est}}(l) = \\mu_{\\text{true}}(l)$），校正后的数据 $p_{\\text{true}}$ 将是：\n$$p_{\\text{true}} = p_0 \\exp\\left(\\int_L \\left[\\mu_{\\text{true}}(l) - \\mu_{\\text{true}}(l)\\right] \\, dl\\right) = p_0 \\exp(0) = p_0$$\n这证实了完美的校正可以恢复原始的未衰减信号。\n\n校正后投影图数据上的乘性偏差因子 $B$ 是估计的校正数据与理想的校正数据之比：\n$$B = \\frac{p_{\\text{est}}}{p_{\\text{true}}} = \\frac{p_0 \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)}{p_0} = \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right)$$\n\n问题陈述重建算法是线性的，因此投影图数据上的这种乘性偏差直接作为乘性偏差传播到重建的活性浓度 $c$ 上。如果 $c_{\\text{true}}$ 是真实浓度，$c_{\\text{est}}$ 是带有伪影的重建浓度，那么：\n$$c_{\\text{est}} = B \\cdot c_{\\text{true}}$$\nSUV 定义为 $\\text{SUV} = c/A_{\\text{norm}}$。由于 $A_{\\text{norm}}$ 不受影响，SUV 也受到相同的因子偏差：\n$$\\text{SUV}_{\\text{est}} = \\frac{c_{\\text{est}}}{A_{\\text{norm}}} = \\frac{B \\cdot c_{\\text{true}}}{A_{\\text{norm}}} = B \\cdot \\text{SUV}_{\\text{true}}$$\n\nSUV 中的分数偏差 $F$ 定义为相对于真实值的变化：\n$$F = \\frac{\\text{SUV}_{\\text{est}} - \\text{SUV}_{\\text{true}}}{\\text{SUV}_{\\text{true}}} = \\frac{B \\cdot \\text{SUV}_{\\text{true}} - \\text{SUV}_{\\text{true}}}{\\text{SUV}_{\\text{true}}} = B - 1$$\n代入 $B$ 的表达式，分数偏差为：\n$$F = \\exp\\left((\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}}\\right) - 1$$\n\n现在，我们代入提供的数值：\n$L_{\\text{art}} = 1.8\\,\\text{cm}$\n$\\mu_{\\text{true}} = 0.18\\,\\text{cm}^{-1}$\n$\\mu_{\\text{est}} = 0.28\\,\\text{cm}^{-1}$\n\n衰减系数的差值为：\n$$\\Delta\\mu = \\mu_{\\text{est}} - \\mu_{\\text{true}} = 0.28\\,\\text{cm}^{-1} - 0.18\\,\\text{cm}^{-1} = 0.10\\,\\text{cm}^{-1}$$\nF 表达式中的指数为：\n$$(\\mu_{\\text{est}} - \\mu_{\\text{true}}) L_{\\text{art}} = (0.10\\,\\text{cm}^{-1}) \\cdot (1.8\\,\\text{cm}) = 0.18$$\n这个量是无量纲的，正如预期。\n\n分数偏差 $F$ 是：\n$$F = \\exp(0.18) - 1$$\n计算数值：\n$$F \\approx 1.19721736 - 1 = 0.19721736$$\n根据要求四舍五入到四位有效数字，我们得到：\n$$F \\approx 0.1972$$\n这个正值表示 SUV 被高估了约 $19.72\\%$。",
            "answer": "$$\\boxed{0.1972}$$"
        },
        {
            "introduction": "为了改善图像质量并降低噪声，现代 PET 重建常采用包含先验信息的正则化方法。本次实践探讨了一种常见的二次平滑先验，并分析其在降低噪声的同时可能引入的系统性偏差。通过推导这种偏差的解析表达式，您将深入理解在高级重建算法中，图像平滑度（方差减小）与定量准确性（偏倚增加）之间存在的根本性权衡 。",
            "id": "4908131",
            "problem": "考虑一个简化的双区域正电子发射断层扫描（PET）模型，其中一个大的均匀仿体被一个清晰的边界划分为两个相邻的区域。设真实的区域活度为 $x_{A}$ 和 $x_{B}$，在每个区域内为常数。假设处于高计数情况，因此线积分测量的泊松数据模型可以用高斯模型近似，并使用加权最小二乘数据保真项。具体来说，假设重建是通过最小化以下形式的惩罚目标函数来执行的\n$$\nJ(x) = \\frac{1}{2}\\|y - A x\\|_{W}^{2} + \\beta\\,\\phi(x),\n$$\n其中 $y$ 是测量向量，$A$ 是系统矩阵，$W$ 是一个正定对角权重矩阵（近似于测量协方差的逆），而 $\\phi(x)$ 是一个二次平滑先验，仅惩罚跨越边界的差异。设该先验为一阶二次形式，两个区域之间具有单位邻域关系，\n$$\n\\phi(x) = \\frac{1}{2}\\,w\\,(x_{A} - x_{B})^{2},\n$$\n其中 $w$ 是一个已知的非负耦合权重。假设灵敏度矩阵 $S = A^{\\top} W A$ 在区域级别上是对角的，即 $S = \\mathrm{diag}(s_{A}, s_{B})$，其中 $s_{A} > 0$ 和 $s_{B} > 0$ 是已知的。\n\n在这些假设下，推导由于二次先验导致的重建区域均值中的偏差，并将其表示为正则化参数 $\\beta$ 的函数。将偏差向量定义为 $b(\\beta) = \\hat{x}(\\beta) - x_{\\mathrm{true}}$，其中 $\\hat{x}(\\beta)$ 是 $J(x)$ 的最小值点，$x_{\\mathrm{true}} = (x_{A}, x_{B})^{\\top}$。请将您的最终答案表示为两个偏差 $b_{A}(\\beta)$ 和 $b_{B}(\\beta)$ 关于 $\\beta$、$w$、$s_{A}$、$s_{B}$、$x_{A}$ 和 $x_{B}$ 的闭式解析表达式，并使用 $\\mathrm{pmatrix}$ 环境将其写成一个双元素行矩阵。无需四舍五入。无需单位。在您的表达式中只使用上面定义的变量。",
            "solution": "用户希望求解一个正则化PET图像重建问题中的偏差。\n\n### 第一步：问题验证\n\n第一步是验证所提供的问题陈述。\n\n**提取的已知条件：**\n- 一个双区域模型，其真实、恒定的区域活度为 $x_{A}$ 和 $x_{B}$。\n- 重建通过最小化惩罚目标函数来执行：\n$$\nJ(x) = \\frac{1}{2}\\|y - A x\\|_{W}^{2} + \\beta\\,\\phi(x)\n$$\n- $x = (x_{A}, x_{B})^{\\top}$ 是待估计的区域活度向量。\n- $y$ 是测量向量。\n- $A$ 是系统矩阵。\n- $W$ 是一个正定对角权重矩阵。\n- $\\beta$ 是一个非负正则化参数。\n- $\\phi(x)$ 是一个二次平滑先验：\n$$\n\\phi(x) = \\frac{1}{2}\\,w\\,(x_{A} - x_{B})^{2}\n$$\n- $w$ 是一个已知的非负耦合权重。\n- 灵敏度矩阵 $S = A^{\\top} W A$ 在区域级别上是对角的：$S = \\mathrm{diag}(s_{A}, s_{B})$，其中 $s_{A} > 0$ 且 $s_{B} > 0$。\n- 数据模型被近似为高斯模型（高计数情况）。\n- 需要推导的偏差向量是 $b(\\beta) = \\hat{x}(\\beta) - x_{\\mathrm{true}}$，其中 $\\hat{x}(\\beta)$ 是 $J(x)$ 的最小值点，$x_{\\mathrm{true}} = (x_{A}, x_{B})^{\\top}$。\n\n**根据标准进行验证：**\n1.  **科学依据**：该问题是医学图像重建领域内一个标准的、简化的公式。目标函数是惩罚加权最小二乘（PWLS）的一种形式，这是一种广泛使用的方法。二次先验是一种基础但根本的正则化类型。所有概念在计算成像和应用数学中都已成熟。\n2.  **适定性**：目标函数 $J(x)$ 是一个凸函数（加权最小二乘项）和另一个凸函数（二次先验）的和。由于 $s_A > 0$ 和 $s_B > 0$，最小二乘项的海森矩阵是正定的。对于 $\\beta > 0$ 和 $w > 0$，整个目标函数的海森矩阵是严格正定的，保证了存在唯一的最小值点。问题陈述清晰，要求进行具体的解析推导。\n3.  **客观性**：问题以精确的数学术语陈述，没有歧义或主观论断。\n4.  **缺陷清单**：问题没有违反任何指定的无效性标准。它在科学上是合理的，可形式化的，完整的，并且在数学上结构良好。\n\n**结论：** 该问题有效。\n\n### 第二步：求解推导\n\n目标是找到目标函数 $J(x)$ 的最小值点 $\\hat{x}(\\beta)$，然后计算偏差 $b(\\beta) = \\hat{x}(\\beta) - x_{\\mathrm{true}}$。\n\n目标函数为：\n$$\nJ(x) = \\frac{1}{2}\\|y - A x\\|_{W}^{2} + \\beta\\,\\frac{1}{2}\\,w\\,(x_{A} - x_{B})^{2}\n$$\n第一项可以展开：\n$$\n\\|y - A x\\|_{W}^{2} = (y - A x)^{\\top} W (y - A x) = y^{\\top}Wy - 2x^{\\top}A^{\\top}Wy + x^{\\top}A^{\\top}WAx\n$$\n使用给定的定义 $S = A^{\\top}WA$，目标函数变为：\n$$\nJ(x) = \\frac{1}{2}(y^{\\top}Wy - 2x^{\\top}A^{\\top}Wy + x^{\\top}Sx) + \\frac{\\beta w}{2}(x_{A} - x_{B})^{2}\n$$\n为了找到最小值，我们计算 $J(x)$ 相对于 $x = (x_{A}, x_{B})^{\\top}$ 的梯度，并将其设为零。\n$$\n\\nabla_{x} J(x) = -A^{\\top}Wy + Sx + \\beta w \\nabla_{x} \\left( \\frac{1}{2}(x_{A} - x_{B})^{2} \\right) = 0\n$$\n我们来分析先验项的梯度。我们可以将 $(x_{A} - x_{B})^{2}$ 写成矩阵形式 $x^{\\top}Px$，其中 $P$ 是矩阵：\n$$\nP = \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n所以，$\\frac{1}{2}x^{\\top}Px$ 的梯度是 $Px$。目标函数的梯度是：\n$$\n\\nabla_{x} J(x) = -A^{\\top}Wy + Sx + \\beta w Px = 0\n$$\n重新整理各项以求解 $x$，这将是我们的估计量 $\\hat{x}$：\n$$\n(S + \\beta w P) \\hat{x} = A^{\\top}Wy\n$$\n偏差是相对于真实活度值 $x_{\\mathrm{true}}$ 定义的。在高计数和高斯近似的情况下，偏差通常通过考虑估计量的期望值来评估，这对应于分析从无噪声数据进行的重建。对于无噪声数据，测量值为 $y = Ax_{\\mathrm{true}}$。将此代入方程：\n$$\n(S + \\beta w P) \\hat{x} = A^{\\top}W(Ax_{\\mathrm{true}}) = (A^{\\top}WA)x_{\\mathrm{true}} = S x_{\\mathrm{true}}\n$$\n因此，在这些理想条件下，估计量 $\\hat{x}(\\beta)$ 是：\n$$\n\\hat{x}(\\beta) = (S + \\beta w P)^{-1} S x_{\\mathrm{true}}\n$$\n偏差由 $b(\\beta) = \\hat{x}(\\beta) - x_{\\mathrm{true}}$ 给出：\n$$\nb(\\beta) = \\left[ (S + \\beta w P)^{-1} S - I \\right] x_{\\mathrm{true}}\n$$\n其中 $I$ 是单位矩阵。为了继续，我们必须计算矩阵 $(S + \\beta w P)$ 的逆。给定 $S = \\mathrm{diag}(s_{A}, s_{B})$，我们有：\n$$\nS + \\beta w P = \\begin{pmatrix} s_{A}  0 \\\\ 0  s_{B} \\end{pmatrix} + \\beta w \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} s_{A} + \\beta w  -\\beta w \\\\ -\\beta w  s_{B} + \\beta w \\end{pmatrix}\n$$\n该矩阵的行列式是：\n$$\n\\det(S + \\beta w P) = (s_{A} + \\beta w)(s_{B} + \\beta w) - (-\\beta w)(-\\beta w) = s_{A}s_{B} + s_{A}\\beta w + s_{B}\\beta w + (\\beta w)^{2} - (\\beta w)^{2}\n$$\n$$\n\\det(S + \\beta w P) = s_{A}s_{B} + \\beta w (s_{A} + s_{B})\n$$\n逆矩阵是：\n$$\n(S + \\beta w P)^{-1} = \\frac{1}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})} \\begin{pmatrix} s_{B} + \\beta w  \\beta w \\\\ \\beta w  s_{A} + \\beta w \\end{pmatrix}\n$$\n现在，我们可以计算 $\\hat{x}(\\beta) = (S + \\beta w P)^{-1} S x_{\\mathrm{true}}$：\n$$\nS x_{\\mathrm{true}} = \\begin{pmatrix} s_{A}  0 \\\\ 0  s_{B} \\end{pmatrix} \\begin{pmatrix} x_{A} \\\\ x_{B} \\end{pmatrix} = \\begin{pmatrix} s_{A}x_{A} \\\\ s_{B}x_{B} \\end{pmatrix}\n$$\n$$\n\\hat{x}(\\beta) = \\frac{1}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})} \\begin{pmatrix} s_{B} + \\beta w  \\beta w \\\\ \\beta w  s_{A} + \\beta w \\end{pmatrix} \\begin{pmatrix} s_{A}x_{A} \\\\ s_{B}x_{B} \\end{pmatrix}\n$$\n$$\n\\hat{x}(\\beta) = \\frac{1}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})} \\begin{pmatrix} (s_{B} + \\beta w)s_{A}x_{A} + (\\beta w)s_{B}x_{B} \\\\ (\\beta w)s_{A}x_{A} + (s_{A} + \\beta w)s_{B}x_{B} \\end{pmatrix}\n$$\n估计量的分量是：\n$$\n\\hat{x}_{A}(\\beta) = \\frac{s_{A}s_{B}x_{A} + s_{A}\\beta w x_{A} + s_{B}\\beta w x_{B}}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n$$\n\\hat{x}_{B}(\\beta) = \\frac{s_{A}\\beta w x_{A} + s_{A}s_{B}x_{B} + s_{B}\\beta w x_{B}}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n最后，我们计算偏差分量 $b_{A}(\\beta) = \\hat{x}_{A}(\\beta) - x_{A}$ 和 $b_{B}(\\beta) = \\hat{x}_{B}(\\beta) - x_{B}$。\n对于 $b_{A}(\\beta)$：\n$$\nb_{A}(\\beta) = \\frac{s_{A}s_{B}x_{A} + s_{A}\\beta w x_{A} + s_{B}\\beta w x_{B}}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})} - x_{A}\n$$\n$$\nb_{A}(\\beta) = \\frac{s_{A}s_{B}x_{A} + s_{A}\\beta w x_{A} + s_{B}\\beta w x_{B} - x_{A}(s_{A}s_{B} + \\beta w (s_{A} + s_{B}))}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n$$\nb_{A}(\\beta) = \\frac{ (s_{A}s_{B}x_{A} - s_{A}s_{B}x_{A}) + (s_{A}\\beta w x_{A} - s_{A}\\beta w x_{A}) + (s_{B}\\beta w x_{B} - s_{B}\\beta w x_{A}) }{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n$$\nb_{A}(\\beta) = \\frac{\\beta w s_{B} (x_{B} - x_{A})}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n对于 $b_{B}(\\beta)$：\n$$\nb_{B}(\\beta) = \\frac{s_{A}\\beta w x_{A} + s_{A}s_{B}x_{B} + s_{B}\\beta w x_{B}}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})} - x_{B}\n$$\n$$\nb_{B}(\\beta) = \\frac{s_{A}\\beta w x_{A} + s_{A}s_{B}x_{B} + s_{B}\\beta w x_{B} - x_{B}(s_{A}s_{B} + \\beta w (s_{A} + s_{B}))}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n$$\nb_{B}(\\beta) = \\frac{\n(s_{A}\\beta w x_{A} - s_{A}\\beta w x_{B}) + (s_{A}s_{B}x_{B} - s_{A}s_{B}x_{B}) + (s_{B}\\beta w x_{B} - s_{B}\\beta w x_{B})\n}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n$$\nb_{B}(\\beta) = \\frac{\\beta w s_{A} (x_{A} - x_{B})}{s_{A}s_{B} + \\beta w (s_{A} + s_{B})}\n$$\n偏差向量 $b(\\beta)$ 的分量为 $(b_{A}(\\beta), b_{B}(\\beta))$，如上推导。按要求将它们表示为一个行矩阵。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\beta w s_{B} (x_{B} - x_{A})}{s_{A} s_{B} + \\beta w (s_{A} + s_{B})}  \\frac{\\beta w s_{A} (x_{A} - x_{B})}{s_{A} s_{B} + \\beta w (s_{A} + s_{B})}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}