{
    "hands_on_practices": [
        {
            "introduction": "开发3D PET技术的主要动机是其灵敏度的显著提升。本练习将让你通过将扫描仪的接收范围建模为立体角，并计算3D与2D模式下接收光子数的比率，来量化这一增益 。这个练习揭示了3D PET能够捕获更强信号的根本几何原因。",
            "id": "4859419",
            "problem": "考虑使用一个简化的圆柱形扫描仪进行正电子发射断层扫描 (PET) 采集，该扫描仪被建模为一个围绕患者的轴对称探测器。假设在等中心处有一个点源，该点源各向同性地发射湮没光子，因此其发射概率在整个立体角上是均匀的。使用以下基本事实：立体角微分元由 $d\\Omega = \\sin\\theta\\,d\\theta\\,d\\phi$ 给出，整个球面的立体角为 $4\\pi$，并且灵敏度（每个发射的湮没事件探测到的符合率）与采集模式所接受的立体角分数成正比。定义极角 $\\theta$ 是相对于扫描仪的轴向方向的角度，其中 $\\theta = \\frac{\\pi}{2}$ 对应于横向平面。\n\n通过关于横向平面对称的角度接受窗对两种采集模式进行建模：\n- 在二维 (2D) 模式下，平面间的隔板会阻挡倾斜的响应线，因此接受的方向满足 $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha_{2D}$，其中 $\\alpha_{2D} = 7$ 度。\n- 在三维 (3D) 模式下，隔板被收回，接受了更宽范围的倾斜响应线，因此 $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha_{3D}$，其中 $\\alpha_{3D} = 50$ 度。\n\n假设两种模式都具有均匀的方位角接受度，通过对接受的立体角区域进行积分，推导出灵敏度 $S_{2D}$ 和 $S_{3D}$ 的表达式（不考虑共同的比例常数），然后计算比率 $\\frac{S_{3D}}{S_{2D}}$。角度 $\\alpha_{2D}$ 和 $\\alpha_{3D}$ 以度为单位给出；在进行任何三角函数求值时，请将其转换为弧度。将最终的比率四舍五入到四位有效数字。将最终答案表示为一个无量纲数。",
            "solution": "由于源在所有方向上均匀发射，因此在这个简化模型中，灵敏度与接受的立体角成正比。利用轴对称性，对于一个允许极角 $\\theta \\in [\\theta_{\\min}, \\theta_{\\max}]$ 和完整方位角范围 $\\phi \\in [0, 2\\pi]$ 的模式，其接受的立体角为\n$$\n\\Omega_{\\text{acc}} = \\int_{0}^{2\\pi}\\int_{\\theta_{\\min}}^{\\theta_{\\max}} \\sin\\theta\\,d\\theta\\,d\\phi = 2\\pi\\int_{\\theta_{\\min}}^{\\theta_{\\max}} \\sin\\theta\\,d\\theta.\n$$\n因此，灵敏度 $S$ 与 $\\Omega_{\\text{acc}}$ 成正比，并且任何共同的比例常数（如探测器效率和几何缩放因子）在计算比率 $\\frac{S_{3D}}{S_{2D}}$ 时都会被抵消。\n\n两种模式都关于 $\\theta = \\frac{\\pi}{2}$ 对称，其接受范围为 $|\\theta - \\frac{\\pi}{2}| \\leq \\alpha$，因此积分边界为 $\\theta_{\\min} = \\frac{\\pi}{2} - \\alpha$ 和 $\\theta_{\\max} = \\frac{\\pi}{2} + \\alpha$。那么\n$$\n\\Omega_{\\text{acc}}(\\alpha) = 2\\pi\\int_{\\frac{\\pi}{2}-\\alpha}^{\\frac{\\pi}{2}+\\alpha} \\sin\\theta\\,d\\theta = 2\\pi\\left[-\\cos\\theta\\right]_{\\frac{\\pi}{2}-\\alpha}^{\\frac{\\pi}{2}+\\alpha}.\n$$\n计算在边界处的余弦值，\n$$\n-\\cos\\left(\\frac{\\pi}{2}+\\alpha\\right) + \\cos\\left(\\frac{\\pi}{2}-\\alpha\\right) = -(-\\sin\\alpha) + \\sin\\alpha = 2\\sin\\alpha,\n$$\n所以\n$$\n\\Omega_{\\text{acc}}(\\alpha) = 2\\pi\\cdot 2\\sin\\alpha = 4\\pi\\sin\\alpha.\n$$\n因此，在一个共同的比例常数下，\n$$\nS(\\alpha) \\propto 4\\pi\\sin\\alpha.\n$$\n对于这两种模式，\n$$\nS_{2D} \\propto 4\\pi\\sin\\alpha_{2D}, \\quad S_{3D} \\propto 4\\pi\\sin\\alpha_{3D},\n$$\n并且比率为\n$$\n\\frac{S_{3D}}{S_{2D}} = \\frac{\\sin\\alpha_{3D}}{\\sin\\alpha_{2D}}.\n$$\n\n将给定的角度从度转换为弧度。使用 $\\alpha_{2D} = 7$ 度和 $\\alpha_{3D} = 50$ 度，\n$$\n\\alpha_{2D} = \\frac{7\\pi}{180} \\text{ radians}, \\quad \\alpha_{3D} = \\frac{50\\pi}{180} = \\frac{5\\pi}{18} \\text{ radians}.\n$$\n计算正弦值：\n$$\n\\sin\\left(\\frac{5\\pi}{18}\\right) = \\sin(50^\\circ) \\approx 0.7660444431,\n$$\n$$\n\\sin\\left(\\frac{7\\pi}{180}\\right) = \\sin(7^\\circ) \\approx 0.1218693434.\n$$\n因此，\n$$\n\\frac{S_{3D}}{S_{2D}} \\approx \\frac{0.7660444431}{0.1218693434} \\approx 6.285785\\ldots\n$$\n四舍五入到四位有效数字，该比率为\n$$\n6.286.\n$$\n这是一个无量纲数，因为它是灵敏度的比率。",
            "answer": "$$\\boxed{6.286}$$"
        },
        {
            "introduction": "尽管3D模式提高了灵敏度，但它也接收了显著增多的散射光子，这对定量准确性构成了重大挑战。本练习将演示，在散射校正中一个微小的残留误差，如何在3D模式下导致比2D模式大得多的活性测量偏差 。通过解决这个问题，你将理解为什么稳健的散射校正对3D PET至关重要。",
            "id": "4859465",
            "problem": "一个均匀的圆柱形水模体通过正电子发射断层扫描（PET）进行成像。进行了两次采集：一次是带有平面间隔板的二维（2D）模式，另一次是无间隔板的三维（3D）模式。假设在一个均匀的感兴趣区域（ROI）中，真实符合计数与真实活度通过一个校准因子（系统灵敏度）$s$ 呈线性关系，因此真实计数满足 $T = s A$，其中 $A$ 是ROI中的真实活度。设测得的瞬发计数为真实符合计数与散射符合计数之和，$P = T + S$，并假设随机符合已被完美校正，因此在本分析中可以忽略。\n\n定义散射分数 $\\mathrm{SF}$ 为 $\\mathrm{SF} = \\dfrac{S}{T + S}$。在3D采集中，散射分数为 $\\mathrm{SF}_{3\\mathrm{D}} = 0.40$；在2D采集中，散射分数为 $\\mathrm{SF}_{2\\mathrm{D}} = 0.20$。散射校正算法低估了真实散射，其残余分数为 $\\delta = 0.10$，这意味着校正后仍有真实散射的 $\\delta$ 分数未被移除。重建是线性的，校正后的计数通过与真实符合所用的相同灵敏度 $s$ 映射到活度估计值。\n\n从以上定义和线性假设出发，推导每种采集模式下重建活度的分数偏差 $B = \\dfrac{\\hat{A} - A}{A}$，作为 $\\delta$ 和 $\\mathrm{SF}$ 的函数。然后，使用给定的数值，计算比率\n$$R = \\dfrac{B_{3\\mathrm{D}}}{B_{2\\mathrm{D}}}.$$\n将 $R$ 表示为一个纯数（无量纲），并将您的答案四舍五入到四位有效数字。",
            "solution": "重建活度的分数偏差 $B$ 定义为：\n$$B = \\dfrac{\\hat{A} - A}{A}$$\n其中 $A$ 是真实活度，$\\hat{A}$ 是估计活度。\n\n根据问题陈述，真实活度通过系统灵敏度 $s$ 与真实符合计数 $T$ 相关：\n$$A = \\dfrac{T}{s}$$\n类似地，估计活度 $\\hat{A}$ 是从经散射校正的计数（我们记为 $P_c$）中获得的：\n$$\\hat{A} = \\dfrac{P_c}{s}$$\n将这些表达式代入偏差 $B$ 的公式中：\n$$B = \\dfrac{\\frac{P_c}{s} - \\frac{T}{s}}{\\frac{T}{s}} = \\dfrac{P_c - T}{T}$$\n下一步是找到校正后计数 $P_c$ 的表达式。测得的瞬发计数 $P$ 是真实计数 $T$ 和散射计数 $S$ 的和：\n$$P = T + S$$\n散射校正过程涉及从瞬发计数 $P$ 中减去散射计数的估计值，我们称之为 $S_{est}$。问题指明，校正算法低估了真实散射 $S$，其残余分数为 $\\delta$，这意味着真实散射的 $\\delta$ 分数残留在校正后的数据中。因此，校正后的计数为：\n$$P_c = P - S_{est}$$\n被移除的散射量是 $(1-\\delta)S$，所以 $S_{est} = (1-\\delta)S$。因此，我们有：\n$$P_c = (T + S) - (1-\\delta)S = T + S - S + \\delta S = T + \\delta S$$\n现在我们将 $P_c$ 的这个表达式代回我们的偏差 $B$ 方程中：\n$$B = \\dfrac{(T + \\delta S) - T}{T} = \\dfrac{\\delta S}{T}$$\n问题要求将偏差表示为散射分数 $\\mathrm{SF}$ 和残余分数 $\\delta$ 的函数。我们必须用 $\\mathrm{SF}$ 来表示比率 $\\dfrac{S}{T}$。散射分数定义为：\n$$\\mathrm{SF} = \\dfrac{S}{T + S}$$\n我们可以重新整理这个方程来求解 $\\dfrac{S}{T}$：\n$$\\mathrm{SF} (T + S) = S$$\n$$\\mathrm{SF} \\cdot T + \\mathrm{SF} \\cdot S = S$$\n$$\\mathrm{SF} \\cdot T = S - \\mathrm{SF} \\cdot S = S(1 - \\mathrm{SF})$$\n$$\\dfrac{S}{T} = \\dfrac{\\mathrm{SF}}{1 - \\mathrm{SF}}$$\n将这个结果代入偏差 $B$ 的表达式中，我们得到分数偏差的通用公式：\n$$B = \\delta \\left( \\dfrac{\\mathrm{SF}}{1 - \\mathrm{SF}} \\right)$$\n现在，我们可以将此公式应用于2D和3D采集模式。\n对于3D模式，偏差 $B_{3\\mathrm{D}}$ 为：\n$$B_{3\\mathrm{D}} = \\delta \\left( \\dfrac{\\mathrm{SF}_{3\\mathrm{D}}}{1 - \\mathrm{SF}_{3\\mathrm{D}}} \\right)$$\n对于2D模式，偏差 $B_{2\\mathrm{D}}$ 为：\n$$B_{2\\mathrm{D}} = \\delta \\left( \\dfrac{\\mathrm{SF}_{2\\mathrm{D}}}{1 - \\mathrm{SF}_{2\\mathrm{D}}} \\right)$$\n问题要求计算比率 $R = \\dfrac{B_{3\\mathrm{D}}}{B_{2\\mathrm{D}}}$。\n$$R = \\dfrac{\\delta \\left( \\dfrac{\\mathrm{SF}_{3\\mathrm{D}}}{1 - \\mathrm{SF}_{3\\mathrm{D}}} \\right)}{\\delta \\left( \\dfrac{\\mathrm{SF}_{2\\mathrm{D}}}{1 - \\mathrm{SF}_{2\\mathrm{D}}} \\right)} = \\dfrac{\\left( \\dfrac{\\mathrm{SF}_{3\\mathrm{D}}}{1 - \\mathrm{SF}_{3\\mathrm{D}}} \\right)}{\\left( \\dfrac{\\mathrm{SF}_{2\\mathrm{D}}}{1 - \\mathrm{SF}_{2\\mathrm{D}}} \\right)}$$\n我们已知数值 $\\mathrm{SF}_{3\\mathrm{D}} = 0.40$ 和 $\\mathrm{SF}_{2\\mathrm{D}} = 0.20$。注意，残余分数 $\\delta$ 被消掉了。\n$$R = \\dfrac{\\left( \\dfrac{0.40}{1 - 0.40} \\right)}{\\left( \\dfrac{0.20}{1 - 0.20} \\right)} = \\dfrac{\\left( \\dfrac{0.40}{0.60} \\right)}{\\left( \\dfrac{0.20}{0.80} \\right)}$$\n$$R = \\dfrac{\\frac{2}{3}}{\\frac{1}{4}} = \\dfrac{2}{3} \\times 4 = \\dfrac{8}{3}$$\n问题要求答案四舍五入到四位有效数字。\n$$R = \\dfrac{8}{3} \\approx 2.6666...$$\n四舍五入到四位有效数字得到：\n$$R \\approx 2.667$$\n此结果表明，在指定条件下，由于不完美的散射校正，3D采集模式中的分数偏差大约是2D模式中的 $2.667$ 倍。",
            "answer": "$$\\boxed{2.667}$$"
        },
        {
            "introduction": "3D PET中来自倾斜响应线（LOR）的海量数据促进了诸如单层重排（SSRB）等近似重建算法的发展。本练习通过要求你计算SSRB引入的固有轴向定位误差，深入探讨了这类近似方法的利弊权衡 。这一分析突显了3D图像形成中的一个关键挑战：在计算速度与空间准确性之间取得平衡。",
            "id": "4859486",
            "problem": "在正电子发射断层扫描（PET）中，全三维采集允许连接不同轴向环上探测器的斜向响应线。一种常见的近似方法，即单层切片重排（SSRB），将每条斜向响应线分配到两个探测器环位置中点的单个直接横向平面上。考虑一个半径为 $R$ 的圆柱形 PET 扫描仪，其探测器环等间距排列，轴向间距为 $d$。两个方位角相差 $\\pi$ 的相对探测器位于轴向坐标相差 $\\Delta = m d$ 的环上，其中 $m$ 是整数环差。设扫描仪的视野内包含一个半径为 $\\rho$ 的均匀圆柱形物体，该物体以扫描仪轴线为中心。\n\n在笛卡尔坐标系 $(x,y,z)$ 中，将连接两个相对探测器的斜向响应线建模为连接点 $(R \\cos\\phi, R \\sin\\phi, \\Delta/2)$ 和 $(-R \\cos\\phi, -R \\sin\\phi, -\\Delta/2)$ 的直线段，其中 $\\phi$ 是方位角。在SSRB下，此斜向响应线上的所有计数都被分配到 $z=0$ 处的直接横向平面。\n\n将在该斜向响应线上真实轴向坐标 $z_{\\text{true}}$ 处发生的发射事件的轴向错位误差定义为 $e = z_{\\text{true}} - 0$。假设可能的发射位置在此斜线位于圆柱形物体内部（即 $x^{2} + y^{2} \\leq \\rho^{2}$ 内部）的部分上呈均匀分布，请从第一性原理出发，推导出一个关于 $R$, $\\rho$ 和 $\\Delta$ 的均方根（RMS）轴向错位误差的闭式解析表达式。然后，计算当 $R = 40\\,\\text{cm}$，$d = 0.47\\,\\text{cm}$，$m = 24$ 和 $\\rho = 20\\,\\text{cm}$ 时的数值。将最终数值答案四舍五入至三位有效数字，并以毫米表示。最终答案必须是一个实数值。",
            "solution": "目标是推导发生在斜向响应线（LOR）上，随后被重排到中心横向平面的事件的均方根（RMS）轴向错位误差的表达式。\n\n首先，我们建立斜向LOR的参数表示。LOR连接两个探测器点 $P_{1} = (R \\cos\\phi, R \\sin\\phi, \\Delta/2)$ 和 $P_{2} = (-R \\cos\\phi, -R \\sin\\phi, -\\Delta/2)$。位于 $P_{1}$ 和 $P_{2}$ 之间直线段上的点 $P(t)$ 可以使用参数 $t \\in [0, 1]$ 进行参数化，如下所示：\n$$P(t) = (1-t)P_{2} + tP_{1}$$\n$P(t)$ 的笛卡尔坐标 $(x(t), y(t), z(t))$ 为：\n$$x(t) = (1-t)(-R \\cos\\phi) + t(R \\cos\\phi) = R(2t-1)\\cos\\phi$$\n$$y(t) = (1-t)(-R \\sin\\phi) + t(R \\sin\\phi) = R(2t-1)\\sin\\phi$$\n$$z(t) = (1-t)(-\\Delta/2) + t(\\Delta/2) = \\frac{\\Delta}{2}(2t-1)$$\n这里，$t=0$ 对应于 $P_{2}$，$t=1$ 对应于 $P_{1}$。一次发射事件的真实轴向坐标是 $z_{\\text{true}} = z(t)$。\n\n接下来，我们确定此LOR位于均匀圆柱形物体内部的部分。物体由条件 $x^{2} + y^{2} \\leq \\rho^{2}$ 定义。代入 $x(t)$ 和 $y(t)$ 的参数方程：\n$$(R(2t-1)\\cos\\phi)^{2} + (R(2t-1)\\sin\\phi)^{2} \\leq \\rho^{2}$$\n$$R^{2}(2t-1)^{2}(\\cos^{2}\\phi + \\sin^{2}\\phi) \\leq \\rho^{2}$$\n$$R^{2}(2t-1)^{2} \\leq \\rho^{2}$$\n对两边取平方根，并注意 $R > 0$：\n$$|R(2t-1)| \\leq \\rho \\implies |2t-1| \\leq \\frac{\\rho}{R}$$\n这个不等式定义了 LOR 段位于物体内部时参数 $t$ 的范围：\n$$-\\frac{\\rho}{R} \\leq 2t-1 \\leq \\frac{\\rho}{R}$$\n$$1 - \\frac{\\rho}{R} \\leq 2t \\leq 1 + \\frac{\\rho}{R}$$\n$$t \\in \\left[ \\frac{1}{2}\\left(1 - \\frac{\\rho}{R}\\right), \\frac{1}{2}\\left(1 + \\frac{\\rho}{R}\\right) \\right]$$\n令 $t_{\\min} = \\frac{1}{2}(1 - \\frac{\\rho}{R})$ 和 $t_{\\max} = \\frac{1}{2}(1 + \\frac{\\rho}{R})$。\n\n对于在 $z_{\\text{true}}$ 处发生的事件，其轴向错位误差 $e$ 定义为真实轴向坐标与分配坐标（在SSRB下为 $z=0$）之间的差值。\n$$e = z_{\\text{true}} - 0 = z_{\\text{true}}$$\n用我们的参数化表示，误差是 $t$ 的函数：\n$$e(t) = z(t) = \\frac{\\Delta}{2}(2t-1)$$\n\n问题假设发射位置在LOR的活动段上呈均匀分布。这意味着参数 $t$ 在区间 $[t_{\\min}, t_{\\max}]$ 上服从均匀概率分布。RMS误差 $e_{\\text{RMS}}$ 是均方误差 $\\langle e^{2} \\rangle$ 的平方根。\n$$e_{\\text{RMS}} = \\sqrt{\\langle e^{2} \\rangle} = \\sqrt{\\frac{\\int_{t_{\\min}}^{t_{\\max}} e(t)^{2} dt}{\\int_{t_{\\min}}^{t_{\\max}} dt}}$$\n分母是区间的长度：\n$$\\int_{t_{\\min}}^{t_{\\max}} dt = t_{\\max} - t_{\\min} = \\frac{1}{2}\\left(1 + \\frac{\\rho}{R}\\right) - \\frac{1}{2}\\left(1 - \\frac{\\rho}{R}\\right) = \\frac{\\rho}{R}$$\n分子是误差平方的积分：\n$$\\int_{t_{\\min}}^{t_{\\max}} e(t)^{2} dt = \\int_{t_{\\min}}^{t_{\\max}} \\left(\\frac{\\Delta}{2}(2t-1)\\right)^{2} dt = \\frac{\\Delta^{2}}{4} \\int_{t_{\\min}}^{t_{\\max}} (2t-1)^{2} dt$$\n我们进行变量替换。令 $u = 2t-1$，则 $du = 2dt$。积分上下限变为：\n$u_{\\min} = 2t_{\\min}-1 = 2 \\cdot \\frac{1}{2}(1 - \\frac{\\rho}{R}) - 1 = -\\frac{\\rho}{R}$\n$u_{\\max} = 2t_{\\max}-1 = 2 \\cdot \\frac{1}{2}(1 + \\frac{\\rho}{R}) - 1 = +\\frac{\\rho}{R}$\n积分变为：\n$$\\frac{\\Delta^{2}}{4} \\int_{-\\rho/R}^{\\rho/R} u^{2} \\frac{du}{2} = \\frac{\\Delta^{2}}{8} \\left[ \\frac{u^{3}}{3} \\right]_{-\\rho/R}^{\\rho/R} = \\frac{\\Delta^{2}}{24} \\left[ \\left(\\frac{\\rho}{R}\\right)^{3} - \\left(-\\frac{\\rho}{R}\\right)^{3} \\right] = \\frac{\\Delta^{2}}{24} \\left[ 2\\left(\\frac{\\rho}{R}\\right)^{3} \\right] = \\frac{\\Delta^{2}}{12}\\left(\\frac{\\rho}{R}\\right)^{3}$$\n现在，我们计算均方误差：\n$$\\langle e^{2} \\rangle = \\frac{\\frac{\\Delta^{2}}{12}\\left(\\frac{\\rho}{R}\\right)^{3}}{\\frac{\\rho}{R}} = \\frac{\\Delta^{2}}{12}\\left(\\frac{\\rho}{R}\\right)^{2}$$\nRMS误差是该数量的平方根：\n$$e_{\\text{RMS}} = \\sqrt{\\frac{\\Delta^{2}\\rho^{2}}{12R^{2}}} = \\frac{\\Delta \\rho}{\\sqrt{12}R} = \\frac{\\Delta \\rho}{2\\sqrt{3}R}$$\n这就是所求的RMS轴向错位误差关于 $R$, $\\rho$ 和 $\\Delta$ 的闭式解析表达式。\n\n接下来，我们使用所提供的数据计算数值：\n扫描仪半径 $R = 40\\,\\text{cm}$。\n物体半径 $\\rho = 20\\,\\text{cm}$。\n轴向环间距 $d = 0.47\\,\\text{cm}$。\n整数环差 $m = 24$。\n\n首先，计算总轴向分离距离 $\\Delta$：\n$$\\Delta = m d = 24 \\times 0.47\\,\\text{cm} = 11.28\\,\\text{cm}$$\n现在，将数值代入 $e_{\\text{RMS}}$ 的表达式中：\n$$e_{\\text{RMS}} = \\frac{(11.28\\,\\text{cm}) \\times (20\\,\\text{cm})}{2\\sqrt{3} \\times (40\\,\\text{cm})} = \\frac{11.28 \\times 20}{80\\sqrt{3}}\\,\\text{cm} = \\frac{11.28}{4\\sqrt{3}}\\,\\text{cm} = \\frac{2.82}{\\sqrt{3}}\\,\\text{cm}$$\n计算此表达式：\n$$e_{\\text{RMS}} \\approx 1.62812\\,\\text{cm}$$\n题目要求答案以毫米为单位，并四舍五入至三位有效数字。我们进行单位换算：\n$$1.62812\\,\\text{cm} \\times \\frac{10\\,\\text{mm}}{1\\,\\text{cm}} = 16.2812\\,\\text{mm}$$\n四舍五入至三位有效数字得到 $16.3\\,\\text{mm}$。",
            "answer": "$$\\boxed{16.3}$$"
        }
    ]
}