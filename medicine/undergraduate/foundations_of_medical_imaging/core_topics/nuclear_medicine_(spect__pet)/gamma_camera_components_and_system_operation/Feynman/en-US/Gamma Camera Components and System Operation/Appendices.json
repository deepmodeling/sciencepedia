{
    "hands_on_practices": [
        {
            "introduction": "A gamma camera's ability to measure the energy of incoming photons is crucial for rejecting scattered radiation and improving image contrast. This process, however, is governed by statistical fluctuations that ultimately limit the detector's energy resolution. This practice will guide you through the signal chain, from the creation of scintillation photons to the generation of photoelectrons, to understand how these statistical limits arise. By modeling the conversion process, you will derive the energy resolution from first principles and appreciate how fundamental detector physics dictates a key aspect of system performance .",
            "id": "4888105",
            "problem": "A gamma camera based on a sodium iodide activated with thallium scintillator (NaI(Tl)) and a photomultiplier tube (PMT) measures the energy of incident gamma rays by converting scintillation light into an electrical signal. Consider a single $140\\ \\mathrm{keV}$ gamma-ray interaction that produces $N_{ph}=5320$ scintillation photons in the crystal. Each photon is transported to the PMT with a collection efficiency of $0.80$ and, if it reaches the photocathode, has a quantum efficiency of $0.25$ for producing a photoelectron. The PMT multiplication process introduces gain fluctuations characterized by an excess noise factor $F=1.2$. \n\nStarting from (i) the definition of quantum efficiency and collection efficiency as probabilities for photon detection, (ii) Poisson statistics for photoelectron counting, and (iii) the definition of energy resolution as the ratio of the full width at half maximum (FWHM) to the mean of a Gaussian response, derive the expected number of detected photoelectrons $N_{pe}$ and the predicted fractional energy resolution $R_E$ for this event. Express $R_E$ as a dimensionless decimal rounded to four significant figures. Provide the final answer as the ordered pair $\\left(N_{pe}, R_E\\right)$.",
            "solution": "The problem requires the derivation of the expected number of detected photoelectrons, $\\bar{N}_{pe}$, and the fractional energy resolution, $R_E$, for a gamma-ray interaction in a scintillation detector.\n\nFirst, we determine the expected number of photoelectrons, $\\bar{N}_{pe}$.\nThe process begins with a single gamma-ray interaction producing a mean number of scintillation photons, $\\bar{N}_{ph} = 5320$. These photons travel to the photocathode of a photomultiplier tube (PMT). The problem states that the collection efficiency, $\\eta_c = 0.80$, can be interpreted as the probability that a given photon reaches the photocathode. Upon reaching the photocathode, each photon has a probability, given by the quantum efficiency $\\eta_q = 0.25$, of producing a photoelectron.\n\nTherefore, the total probability, $p$, for a single scintillation photon to successfully generate a photoelectron is the product of these independent probabilities:\n$$p = \\eta_c \\times \\eta_q$$\nThe expected number of photoelectrons, $\\bar{N}_{pe}$, generated from the initial $\\bar{N}_{ph}$ photons is given by the product of the number of photons and the probability of conversion for each:\n$$\\bar{N}_{pe} = \\bar{N}_{ph} \\times p = \\bar{N}_{ph} \\eta_c \\eta_q$$\nSubstituting the given values:\n$$\\bar{N}_{pe} = 5320 \\times 0.80 \\times 0.25$$\n$$\\bar{N}_{pe} = 5320 \\times 0.20$$\n$$\\bar{N}_{pe} = 1064$$\nThis is the expected number of photoelectrons produced at the photocathode.\n\nNext, we derive the fractional energy resolution, $R_E$.\nThe energy resolution is defined as the ratio of the full width at half maximum (FWHM) of the detected energy peak to the mean energy, $\\bar{E}$, or equivalently, the mean signal, $\\bar{S}$:\n$$R_E = \\frac{\\text{FWHM}}{\\bar{S}}$$\nThe problem specifies that the detector response is Gaussian. For a Gaussian distribution, the FWHM is related to the standard deviation, $\\sigma_S$, of the distribution by:\n$$\\text{FWHM} = 2\\sqrt{2\\ln 2} \\ \\sigma_S$$\nSubstituting this into the definition of $R_E$:\n$$R_E = 2\\sqrt{2\\ln 2} \\frac{\\sigma_S}{\\bar{S}}$$\nThe quantity $\\frac{\\sigma_S}{\\bar{S}}$ is the fractional standard deviation of the output signal. Our task is to relate this to the statistical fluctuations in the detector.\n\nThe signal generation involves two main statistical processes: the creation of photoelectrons and their subsequent multiplication in the PMT.\n1.  **Photoelectron Statistics**: As instructed, we model the generation of photoelectrons as a Poisson process. For a mean number of photoelectrons $\\bar{N}_{pe}$, the variance is $\\sigma_{N_{pe}}^2 = \\bar{N}_{pe}$. The squared signal-to-noise ratio for the photoelectrons is $(\\text{S/N})^2_{\\text{in}} = \\frac{\\bar{N}_{pe}^2}{\\sigma_{N_{pe}}^2} = \\frac{\\bar{N}_{pe}^2}{\\bar{N}_{pe}} = \\bar{N}_{pe}$.\n\n2.  **PMT Multiplication**: The multiplication process in the PMT is also statistical and introduces additional noise. The excess noise factor, $F$, quantifies this degradation of the signal-to-noise ratio. It is defined as the ratio of the squared signal-to-noise at the input (photocathode) to the squared signal-to-noise at the output (anode):\n$$F = \\frac{(\\text{S/N})^2_{\\text{in}}}{(\\text{S/N})^2_{\\text{out}}}$$\nThe squared signal-to-noise ratio at the output is $(\\text{S/N})^2_{\\text{out}} = \\frac{\\bar{S}^2}{\\sigma_S^2}$.\n\nBy substituting the expressions for the input and output squared signal-to-noise ratios into the definition of $F$, we can solve for the fractional variance of the output signal:\n$$F = \\frac{\\bar{N}_{pe}}{\\bar{S}^2 / \\sigma_S^2} = \\bar{N}_{pe} \\left(\\frac{\\sigma_S}{\\bar{S}}\\right)^2$$\nRearranging this equation gives:\n$$\\left(\\frac{\\sigma_S}{\\bar{S}}\\right)^2 = \\frac{F}{\\bar{N}_{pe}}$$\nThe fractional standard deviation is therefore:\n$$\\frac{\\sigma_S}{\\bar{S}} = \\sqrt{\\frac{F}{\\bar{N}_{pe}}}$$\nNow, we substitute this result back into our expression for the energy resolution $R_E$:\n$$R_E = 2\\sqrt{2\\ln 2} \\sqrt{\\frac{F}{\\bar{N}_{pe}}}$$\nUsing the calculated value $\\bar{N}_{pe} = 1064$ and the given value $F = 1.2$:\n$$R_E = 2\\sqrt{2\\ln 2} \\sqrt{\\frac{1.2}{1064}}$$\n$$R_E \\approx 2.35482 \\sqrt{0.0011278195...}$$\n$$R_E \\approx 2.35482 \\times 0.03358302...$$\n$$R_E \\approx 0.0790803...$$\nThe problem requires the result to be rounded to four significant figures.\n$$R_E \\approx 0.07908$$\n\nThe final answer is the ordered pair $(\\bar{N}_{pe}, R_E)$.\nThe calculated values are $\\bar{N}_{pe} = 1064$ and $R_E = 0.07908$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1064 & 0.07908\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "An imaging system's spatial resolution, its ability to distinguish fine details, is rarely determined by a single component. In a gamma camera, the final resolution is a combination of the detector's intrinsic capabilities and the geometric properties of the collimator. This exercise explores how these two independent sources of blur—the intrinsic detector blur and the collimator blur—combine to form the overall system point spread function ($PSF$). Assuming a common Gaussian model for these blur components, you will practice combining their respective widths in quadrature, a fundamental technique for analyzing the performance of any cascaded imaging system .",
            "id": "4888042",
            "problem": "A gamma camera equipped with a parallel-hole collimator is used to image a point source located at a source-to-collimator distance of $z=10\\ \\mathrm{cm}$. The camera’s measured intrinsic point spread function ($PSF$) is well approximated by a Gaussian with standard deviation $\\sigma_{\\text{int}}=1.5\\ \\mathrm{mm}$. The collimator blur at $z=10\\ \\mathrm{cm}$ is measured to have a full width at half maximum (FWHM) $R_{\\text{col}}=8\\ \\mathrm{mm}$. Under the assumptions that the system is linear and shift-invariant, and that the intrinsic blur and collimator blur are independent and each Gaussian, derive from first principles the expected system $PSF$ width at $z=10\\ \\mathrm{cm}$ expressed as the full width at half maximum. Express your final answer in millimeters and round to four significant figures.",
            "solution": "The fundamental principle for a linear and shift-invariant (LSI) system is that the overall system response is the convolution of the responses of its independent components. In this case, the system point spread function, $PSF_{\\text{sys}}$, is the convolution of the intrinsic point spread function, $PSF_{\\text{int}}$, and the collimator point spread function, $PSF_{\\text{col}}$.\n$$PSF_{\\text{sys}} = PSF_{\\text{int}} * PSF_{\\text{col}}$$\nwhere $*$ denotes the convolution operator.\n\nThe problem states that both $PSF_{\\text{int}}$ and $PSF_{\\text{col}}$ are Gaussian functions. A critical property of Gaussian functions is that the convolution of two Gaussians results in another Gaussian. If the component Gaussians have variances $\\sigma_1^2$ and $\\sigma_2^2$, the resulting convolved Gaussian will have a variance $\\sigma_{\\text{sys}}^2$ that is the sum of the component variances.\n$$\\sigma_{\\text{sys}}^2 = \\sigma_{\\text{int}}^2 + \\sigma_{\\text{col}}^2$$\nThis relationship is the cornerstone of the solution. Our goal is to find the full width at half maximum of the system PSF, $FWHM_{\\text{sys}}$. To do this, we must first establish the relationship between the standard deviation, $\\sigma$, and the FWHM for a Gaussian distribution.\n\nA one-dimensional Gaussian function centered at the origin can be written as:\n$$G(x) = A \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\nwhere $A$ is the maximum amplitude. The FWHM is the distance between the two points $x$ where the function's value is half its maximum, i.e., $G(x) = A/2$.\n$$\\frac{A}{2} = A \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right)$$\nDividing by $A$ and taking the natural logarithm of both sides:\n$$\\ln\\left(\\frac{1}{2}\\right) = -\\frac{x^2}{2\\sigma^2}$$\n$$-\\ln(2) = -\\frac{x^2}{2\\sigma^2}$$\n$$x^2 = 2\\sigma^2\\ln(2)$$\n$$x = \\pm \\sigma \\sqrt{2\\ln(2)}$$\nThe two points are $x_1 = -\\sigma\\sqrt{2\\ln(2)}$ and $x_2 = +\\sigma\\sqrt{2\\ln(2)}$. The FWHM is the difference between these two points:\n$$FWHM = x_2 - x_1 = 2\\sigma\\sqrt{2\\ln(2)} \\approx 2.355\\sigma$$\nThis gives us the conversion factor between $\\sigma$ and FWHM. Squaring this relationship gives:\n$$FWHM^2 = 4\\sigma^2(2\\ln(2)) = 8\\sigma^2\\ln(2)$$\nThis implies $\\sigma^2 = \\frac{FWHM^2}{8\\ln(2)}$.\n\nWe can apply this to our variance addition formula:\n$$\\sigma_{\\text{sys}}^2 = \\sigma_{\\text{int}}^2 + \\sigma_{\\text{col}}^2$$\nSubstituting the FWHM-based expression for each variance term:\n$$\\frac{FWHM_{\\text{sys}}^2}{8\\ln(2)} = \\frac{FWHM_{\\text{int}}^2}{8\\ln(2)} + \\frac{FWHM_{\\text{col}}^2}{8\\ln(2)}$$\nMultiplying the entire equation by $8\\ln(2)$ yields a simplified relationship for combining FWHMs of Gaussian components:\n$$FWHM_{\\text{sys}}^2 = FWHM_{\\text{int}}^2 + FWHM_{\\text{col}}^2$$\nThis demonstrates that the FWHMs of independent Gaussian blur components add in quadrature to give the square of the system FWHM.\n\nNow, we use the given values to calculate $FWHM_{\\text{sys}}$.\nWe are given:\n- The collimator FWHM, $FWHM_{\\text{col}} = R_{\\text{col}} = 8\\ \\mathrm{mm}$.\n- The intrinsic standard deviation, $\\sigma_{\\text{int}} = 1.5\\ \\mathrm{mm}$.\n\nFirst, we must calculate the intrinsic FWHM, $FWHM_{\\text{int}}$, from its standard deviation:\n$$FWHM_{\\text{int}} = \\sigma_{\\text{int}} \\cdot 2\\sqrt{2\\ln(2)} = 1.5 \\cdot 2\\sqrt{2\\ln(2)}\\ \\mathrm{mm} \\approx 3.532\\ \\mathrm{mm}$$\n\nNow we substitute the known FWHM values into the quadrature sum equation:\n$$FWHM_{\\text{sys}}^2 = (FWHM_{\\text{int}})^2 + (FWHM_{\\text{col}})^2$$\n$$FWHM_{\\text{sys}}^2 = (1.5 \\cdot 2\\sqrt{2\\ln(2)})^2 + (8)^2$$\n$$FWHM_{\\text{sys}}^2 = (1.5^2 \\cdot 4 \\cdot 2\\ln(2)) + 64$$\n$$FWHM_{\\text{sys}}^2 = (2.25 \\cdot 8\\ln(2)) + 64$$\n$$FWHM_{\\text{sys}}^2 = 18\\ln(2) + 64$$\nThe system FWHM is the square root of this value:\n$$FWHM_{\\text{sys}} = \\sqrt{18\\ln(2) + 64}$$\nTo obtain a numerical result, we use the value of the natural logarithm of $2$, $\\ln(2) \\approx 0.693147$.\n$$FWHM_{\\text{sys}} \\approx \\sqrt{18(0.693147) + 64}$$\n$$FWHM_{\\text{sys}} \\approx \\sqrt{12.476646 + 64}$$\n$$FWHM_{\\text{sys}} \\approx \\sqrt{76.476646}$$\n$$FWHM_{\\text{sys}} \\approx 8.745092\\ \\mathrm{mm}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$FWHM_{\\text{sys}} \\approx 8.745\\ \\mathrm{mm}$$",
            "answer": "$$\\boxed{8.745}$$"
        },
        {
            "introduction": "For a gamma camera to provide accurate quantitative information, it must correctly account for events it fails to record, a phenomenon known as dead time. At high count rates, the system becomes busy processing an event and is momentarily \"dead\" to subsequent incoming photons. This hands-on coding exercise challenges you to simulate this effect using the two primary dead time models: paralyzable and nonparalyzable. By implementing these models and investigating a scenario where the wrong correction is applied, you will gain practical insight into how dead time impacts quantitative accuracy and why proper system characterization is critical .",
            "id": "4888059",
            "problem": "A gamma camera for planar nuclear medicine imaging consists of a collimator, a scintillation crystal, and an array of Photomultiplier Tubes (PMTs). The electronics pipeline imposes a global recovery time after each registered event known as dead time. Two canonical dead time models are used in system characterization: the paralyzable model and the nonparalyzable model. In planar quantification under a uniform activity distribution, the true photon arrival process at the detector can be treated as a spatially varying set of independent Poisson processes across pixels, aggregated into a single global Poisson process driving the electronics. When a system-wide dead time acts on this global stream, the losses affect all originating pixels proportionally to their contribution to the global flux.\n\nStarting from the fundamental definition of a Poisson arrival process with rate $n$ and the meaning of dead time $\\tau$ as an interval in which the system is unable to register additional events, derive the expected measured global rate for both dead time models, and invert those relations to estimate the true rates from measured rates. Use the following assumptions to construct a deterministic simulation and compute the quantitative bias introduced when planar quantification uses a dead time correction based on the wrong model:\n- The scene is a uniform activity field, but detector element sensitivities vary deterministically across the field of view, producing per-pixel true rates $n_i$ given by $n_i = r_0 s_i$, where $r_0$ is a baseline rate per pixel and $s_i$ is a known dimensionless sensitivity factor in $[s_{\\min}, s_{\\max}]$.\n- The global true rate is $N_{\\text{true}} = \\sum_i n_i$, and the expected measured global rate $M_{\\text{meas}}$ is determined exclusively by the system’s dead time model and parameter $\\tau_{\\text{true}}$, acting on the aggregated process with rate $N_{\\text{true}}$.\n- Because the dead time is global, the expected measured per-pixel rates satisfy $m_i = M_{\\text{meas}} \\frac{n_i}{N_{\\text{true}}}$.\n- Planar quantification estimates a corrected per-pixel true rate $\\hat{n}_i$ by inverting the assumed dead time model using the measured $m_i$ and the assumed parameter $\\tau_{\\text{assumed}}$, then forms the corrected total $N_{\\text{corr}} = \\sum_i \\hat{n}_i$ and corrected counts $C_{\\text{corr}} = N_{\\text{corr}} T$ over acquisition time $T$, while the true counts are $C_{\\text{true}} = N_{\\text{true}} T$.\n- Define the bias as $b = \\frac{C_{\\text{corr}} - C_{\\text{true}}}{C_{\\text{true}}}$ and report it as a decimal (unitless).\n\nExpress all rates in counts per second (cps), all times in seconds ($\\mathrm{s}$), and report $b$ as a decimal. Angles are not used. Your program must implement the above logic deterministically (no random sampling), generate the sensitivity maps as specified below, and compute $b$ for each test case.\n\nSensitivity map construction rules for a detector of $P_x \\times P_y$ pixels with coordinates $(x,y)$ where $x \\in \\{0,1,\\dots,P_x-1\\}$ and $y \\in \\{0,1,\\dots,P_y-1\\}$:\n- Gradient pattern: $s(x,y) = s_{\\min} + (s_{\\max} - s_{\\min}) \\frac{x}{P_x - 1}$.\n- Center-high pattern: Let $x_c = \\frac{P_x - 1}{2}$, $y_c = \\frac{P_y - 1}{2}$, and $\\sigma = 0.35 \\max(P_x, P_y)$. Define $r^2 = (x - x_c)^2 + (y - y_c)^2$ and $g(x,y) = \\exp\\left(-\\frac{r^2}{\\sigma^2}\\right)$. Then $s(x,y) = s_{\\min} + (s_{\\max} - s_{\\min}) g(x,y)$, clipped to $[s_{\\min}, s_{\\max}]$.\n\nTest suite. For each case, compute the bias $b$ with the specified parameters. Use the paralyzable or nonparalyzable model as indicated for the true system, and the opposite for the assumed correction. All numerical values are to be treated in their specified units. The baseline rate $r_0$ is per pixel. The acquisition time is $T$.\n- Case $1$ (happy path, moderate rate): $P_x = 10$, $P_y = 10$, gradient pattern with $s_{\\min} = 0.9$, $s_{\\max} = 1.1$, $r_0 = 3000\\,\\mathrm{cps}$, $T = 10\\,\\mathrm{s}$, true model paralyzable with $\\tau_{\\text{true}} = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, assumed model nonparalyzable with $\\tau_{\\text{assumed}} = 1.0 \\times 10^{-6}\\,\\mathrm{s}$.\n- Case $2$ (low-rate boundary): $P_x = 10$, $P_y = 10$, uniform pattern with $s_{\\min} = 1.0$, $s_{\\max} = 1.0$, $r_0 = 100\\,\\mathrm{cps}$, $T = 10\\,\\mathrm{s}$, true model paralyzable with $\\tau_{\\text{true}} = 2.0 \\times 10^{-6}\\,\\mathrm{s}$, assumed model nonparalyzable with $\\tau_{\\text{assumed}} = 2.0 \\times 10^{-6}\\,\\mathrm{s}$.\n- Case $3$ (high-rate near paralyzable throughput peak but invertible): $P_x = 20$, $P_y = 20$, center-high pattern with $s_{\\min} = 0.7$, $s_{\\max} = 1.3$, $r_0 = 1200\\,\\mathrm{cps}$, $T = 30\\,\\mathrm{s}$, true model paralyzable with $\\tau_{\\text{true}} = 2.0 \\times 10^{-6}\\,\\mathrm{s}$, assumed model nonparalyzable with $\\tau_{\\text{assumed}} = 2.0 \\times 10^{-6}\\,\\mathrm{s}$.\n- Case $4$ (true nonparalyzable, assumed paralyzable): $P_x = 10$, $P_y = 10$, gradient pattern with $s_{\\min} = 0.8$, $s_{\\max} = 1.2$, $r_0 = 10000\\,\\mathrm{cps}$, $T = 5\\,\\mathrm{s}$, true model nonparalyzable with $\\tau_{\\text{true}} = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, assumed model paralyzable with $\\tau_{\\text{assumed}} = 1.0 \\times 10^{-6}\\,\\mathrm{s}$.\n- Case $5$ (mismatch in $\\tau$ values): $P_x = 8$, $P_y = 8$, center-high pattern with $s_{\\min} = 0.85$, $s_{\\max} = 1.25$, $r_0 = 8000\\,\\mathrm{cps}$, $T = 20\\,\\mathrm{s}$, true model paralyzable with $\\tau_{\\text{true}} = 1.5 \\times 10^{-6}\\,\\mathrm{s}$, assumed model nonparalyzable with $\\tau_{\\text{assumed}} = 0.8 \\times 10^{-6}\\,\\mathrm{s}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above, for example, $[b_1,b_2,b_3,b_4,b_5]$. Each $b_k$ must be a floating-point number (decimal), representing the unitless bias defined previously.",
            "solution": "### Principle-Based Solution Derivation\n\nThe solution requires a deterministic simulation of the imaging and quantification process. This involves applying the forward dead time model to calculate the measured rates and then applying the inverse of a potentially different model to estimate the corrected rates.\n\n**1. Dead Time Models**\n\nLet $N$ be the true event rate (in cps) and $\\tau$ be the dead time (in s). The expected measured rate is $M$ (in cps).\n\n*   **Nonparalyzable Model**: In this model, an event arriving during a dead period is simply ignored and does not affect the system state. The system is \"dead\" for a total time of $M\\tau$ per second. The fraction of time the system is \"live\" is $1 - M\\tau$. The measured rate is the true rate multiplied by this live time fraction:\n    $$M = N(1 - M\\tau)$$\n    Solving for $M$ gives the forward relationship:\n    $$M = \\frac{N}{1 + N\\tau}$$\n    Solving for $N$ gives the inverse relationship, used for correction:\n    $$N = \\frac{M}{1 - M\\tau}$$\n    This inversion is valid for $M\\tau < 1$.\n\n*   **Paralyzable Model**: In this model, any event arriving during a dead period (whether detected or not) extends the dead period by another interval $\\tau$. An event is only registered if no other true events occurred in the preceding interval of duration $\\tau$. For a Poisson process with rate $N$, the probability of zero events in an interval $\\tau$ is given by the Poisson probability mass function $P(k=0, \\lambda=N\\tau) = e^{-N\\tau}$. The measured rate is thus the true rate multiplied by this probability:\n    $$M = N e^{-N\\tau}$$\n    Inverting this equation to find $N$ from $M$ is non-algebraic. We can write:\n    $$-M\\tau = (-N\\tau)e^{-N\\tau}$$\n    Letting $z = -N\\tau$, we have $ze^z = -M\\tau$. The solution for $z$ is given by the Lambert W function, $z = W(-M\\tau)$. The physically meaningful solution, corresponding to the lower-rate regime where $N\\tau \\le 1$, is given by the principal branch of the function, $W_0$. Thus, the inverse relationship is:\n    $$N = -\\frac{W_0(-M\\tau)}{\\tau}$$\n    This inversion is unique for $N\\tau \\le 1$, which corresponds to $M\\tau \\le 1/e$.\n\n**2. Simulation Algorithm**\n\nFor each test case, we follow these steps:\n\n1.  **Construct Sensitivity Map**: Generate the $P_y \\times P_x$ sensitivity map, denoted by the matrix $\\mathbf{s}$, according to the specified pattern ('gradient' or 'center-high') and parameters $s_{\\min}, s_{\\max}$. For a uniform pattern, all elements of $\\mathbf{s}$ are equal to $s_{\\min}$. The coordinates are $(x, y)$ where $x \\in \\{0, 1, \\dots, P_x-1\\}$ and $y \\in \\{0, 1, \\dots, P_y-1\\}$.\n\n2.  **Calculate True Rates**: Compute the matrix of true per-pixel rates, $\\mathbf{n}$, using the baseline rate $r_0$:\n    $$\\mathbf{n} = r_0 \\mathbf{s}$$\n    The global true rate, $N_{\\text{true}}$, is the sum of all elements in $\\mathbf{n}$:\n    $$N_{\\text{true}} = \\sum_{i,j} n_{ij}$$\n\n3.  **Simulate Measurement**: Apply the true dead time model (paralyzable or nonparalyzable) with parameter $\\tau_{\\text{true}}$ to the global true rate $N_{\\text{true}}$ to find the expected global measured rate, $M_{\\text{meas}}$.\n    *   If true model is nonparalyzable: $M_{\\text{meas}} = \\frac{N_{\\text{true}}}{1 + N_{\\text{true}} \\tau_{\\text{true}}}$.\n    *   If true model is paralyzable: $M_{\\text{meas}} = N_{\\text{true}} e^{-N_{\\text{true}} \\tau_{\\text{true}}}$.\n\n4.  **Determine Measured Per-Pixel Rates**: Since the dead time loss is a global effect, it reduces the count rate of all pixels proportionally. The matrix of measured per-pixel rates, $\\mathbf{m}$, is:\n    $$\\mathbf{m} = M_{\\text{meas}} \\frac{\\mathbf{n}}{N_{\\text{true}}}$$\n\n5.  **Perform Dead Time Correction**: Apply the inverse of the assumed dead time model with parameter $\\tau_{\\text{assumed}}$ to each element of the measured rate matrix $\\mathbf{m}$ to obtain the matrix of corrected per-pixel rates, $\\hat{\\mathbf{n}}$.\n    *   If assumed model is nonparalyzable: $\\hat{n}_{ij} = \\frac{m_{ij}}{1 - m_{ij} \\tau_{\\text{assumed}}}$.\n    *   If assumed model is paralyzable: $\\hat{n}_{ij} = -\\frac{W_0(-m_{ij} \\tau_{\\text{assumed}})}{\\tau_{\\text{assumed}}}$.\n\n6.  **Calculate Corrected Total Rate**: Sum all elements of the corrected rate matrix $\\hat{\\mathbf{n}}$ to find the total corrected rate, $N_{\\text{corr}}$:\n    $$N_{\\text{corr}} = \\sum_{i,j} \\hat{n}_{ij}$$\n\n7.  **Compute Bias**: The quantitative bias, $b$, is the fractional difference between the corrected and true total counts. Since counts are proportional to rates ($C=NT$), the bias can be calculated directly from the rates:\n    $$b = \\frac{C_{\\text{corr}} - C_{\\text{true}}}{C_{\\text{true}}} = \\frac{N_{\\text{corr}} - N_{\\text{true}}}{N_{\\text{true}}}$$\n\nThis procedure is implemented for each of the five test cases to find the corresponding bias values $b_1, \\dots, b_5$.",
            "answer": "[0.04696160538965934,4.008011746249764e-09,-0.007616149495034608,0.5434782608695652,-0.4042296726155986]"
        }
    ]
}